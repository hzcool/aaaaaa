[
    {
        "content": "[\u53ef\u80fd\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.luogu.com.cn/blog/wangrx/solution-p5907)\n\n\n## \u9898\u76ee\u5927\u610f\n\n\u7ed9\u5b9a $n,a,k$\uff0c\u6c42\n\n$$\\sum_{i=1}^ni^ka^i$$\n\n\u7b54\u6848\u5bf9 $998244353$ \u53d6\u6a21\u3002\n\n$\\texttt{Data Range:} 1\\le k\\le 10^7,1\\le n,a\\le 998244352$\n\n## \u9898\u89e3\n\n\u524d\u7f6e\u829d\u58eb\uff1a[\u6709\u9650\u5fae\u79ef\u5206](https://www.luogu.com.cn/blog/wangrx/finite-calculus)\n\n[\u539f\u505a\u6cd5](https://www.luogu.com.cn/blog/wangrx/solution-p4948) \u56e0\u9700\u6c42\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u6709\u7740 $\\Theta(n\\log n)$ \u7684\u74f6\u9888\uff0c\u8fd9\u4e00\u505a\u6cd5\u4e0d\u518d\u9002\u7528\u3002  \n\n\u4f46\u539f\u505a\u6cd5\u4ecd\u6709\u76f8\u5f53\u7a0b\u5ea6\u7684\u501f\u9274\u6027\uff0c\u5177\u4f53\u5730\uff0c\u8bbe $f(n)=\\displaystyle{\\sum}_0^n{x^ka^x\\delta x}$\uff0c\n\n\u5219 $f(x)=a^xg(x)-a^0g(0),g(x)$ \u4e3a $k$ \u6b21\u51fd\u6570\u3002\u7b54\u6848\u5373 $f(n+1)-f(1)$\u3002\n\n\u82e5\u5df2\u77e5 $g(0),g(1),g(2),\\cdots g(k)$\uff0c\u6211\u4eec\u53ef\u4ee5 $\\Theta(k)$ \u62c9\u683c\u6717\u65e5\u63d2\u503c\u6c42\u51fa $g(n+1)$\u3002\n\n\u8003\u8651\u5982\u4f55\u6c42\u51fa $g(m)\\ (0\\le m\\le k)$\uff0c\u663e\u7136\u7ebf\u6027\u7b5b\u51fa $i^k$  \u540e $f(m)$ \u53ef\u4ee5 $\\Theta(k)$ \u9012\u63a8\uff0c\u4e8e\u662f\n\n$$g(m)=a^{-m}(g(0)+f(m))$$\n\n\u95ee\u9898\u53d8\u6210\u4e86\u5982\u4f55\u6c42\u51fa $g(0)$ \u3002\n\n$g(x)$ \u4e3a $k$ \u6b21\u51fd\u6570\uff0c\u56e0\u6b64\u5176 $(k+1)$ \u9636\u5dee\u5206\u4e3a $0$\uff0c\u4e8e\u662f\n\n$$\\Delta^{k+1}g(0)=\\sum_{i=0}^{k+1}\\dbinom{k+1}{i}(-1)^{k+1-i}\\mathrm{E}^ig(0)=0$$\n\n$$\\sum_{i=0}^{k+1}\\dbinom{k+1}{i}(-1)^{k+1-i}g(i)=0$$\n\n$$\\sum_{i=0}^{k+1}\\dbinom{k+1}{i}(-1)^{k+1-i}a^{-i}(g(0)+f(i))=0$$\n\n$$g(0)(a^{-1}-1)^{k+1}+\\sum_{i=0}^{k+1}\\dbinom{k+1}{i}(-1)^{k+1-i}a^{-i}f(i)=0$$\n\n$$g(0)=-(1-a^{-1})^{-k-1}\\sum_{i=0}^{k+1}\\dbinom{k+1}{i}(-a)^{-i}f(i)$$\n\n\u4ee3\u5165\u5373\u53ef $\\Theta(k)$ \u7b97\u51fa $g(0)$\u3002\n\n\u7279\u522b\u7684\uff0c$a=1$ \u65f6\uff0c$f(x)=g(x),g(x)$\u4e3a $k+1$ \u6b21\u800c\u975e $k$ \u6b21\uff0c\u76f4\u63a5\u63d2\u503c\u5373\u53ef\u3002",
        "postTime": 1635952788,
        "uid": 104726,
        "name": "wangrx",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5907 \u6570\u5217\u6c42\u548c\u52a0\u5f3a\u7248 / SPOJ MOON4"
    },
    {
        "content": "### \u524d\u8a00\n\n\u6211\u53bb\u5199\u4e86\u4e00\u9053\u53eb\u505a[\u793c\u7269](https://www.luogu.com.cn/problem/P5364)\u7684\u6570\u6570\u9898\uff0c\u4e09\u5206\u949f\u63a8\u5b8c\u67ff\u5b50\u76f4\u63a5\u505a\uff0c\u7136\u540e Peter \u8bf4\u6d1b\u8c37\u4e0a\u6709\u4e2a\u52a0\u5f3a\u7248\u3002\n\n\u6211\u611f\u89c9\u5f88 Hard\uff0c\u6240\u4ee5\u8fc7\u6765\u5b66\u4e86\u4e2a\u79d1\u6280\u3002\n\n\u7136\u540e\u53c8\u4e0d\u4f1a\u63d2\u503c\u7684\u60f3\u6cd5\uff0c\u6240\u4ee5\u53bb\u5b66\u4e86\u5b66\u4f20\u8bf4\u4e2d\u7684 EI \u79d1\u6280 [Binomial Sums](https://www.luogu.com.cn/blog/EntropyIncreaser/zai-tan-binomial-sum-duo-xiang-shi-fu-ge-cha-zhi-yu-tai-lei-zhan-kai)\u3002\n\n---\n### \u601d\u8def\n\n\u6211\u4eec\u4ee4 $n\\leftarrow n+1$\u3002\n\n\u7b54\u6848\u5373 $\\sum_0^nx^ka^x\\delta x$\u3002\n\n$$\\sum x^ka^x\\delta x=\nx^k{a^x\\over a-1}\n-{a\\over a-1}\\sum a^x\\Delta x^k\\delta x$$\n\n$$\n\\sum_0^nx^ka^x\\delta x={n^ka^n\\over a-1}+{a\\over1-a}\\sum_{p=0}^{k-1}\\binom kp\\sum_0^na^xx^p\\delta x\n$$\n\n$$\nf_k=\\sum_0^nx^ka^x\\delta x\n$$\n\n\u7b97\u51fa $f$ \u7684 EGF\uff0c\u663e\u7136\u7b54\u6848\u5373\n\n$$\n[{z^k\\over k!}]{1-(ae^z)^n\\over1-ae^z}\n$$\n\n\u6211\u4eec\u8bb0\n\n$$F(z)={1-z^n\\over1-z}$$\n\n\u7b54\u6848\u5373 $[{z^k\\over k!}]F(ae^z)$\u3002\n\n\u8bb0\n\n$$\\mathcal F(z+a)=F(z+a)\\bmod z^{k+1}$$\n\n\u7b54\u6848\u5373 $[{z^k\\over k!}]\\mathcal F(ae^z)$\u3002\n\n\u65e2\u6709\n\n$$(1-z)F'(z)=-nz^{n-1}+F(z)$$\n\n\u4e8e\u662f\n\n$$(1-z-a)F'(z+a)=-n(z+a)^{n-1}+F(z+a)$$\n\n\u53ef\u5f97\n\n$$(1-z-a)\\mathcal F'(z+a)-\\mathcal F(z+a)=-((z+a)^n\\bmod z^{k+1})'-(k+1)z^k[z^k]\\mathcal F(z+a)$$\n\n$$(1-z)\\mathcal F'(z)-\\mathcal F(z)=-(((z+a)^n\\bmod z^{k+1})\\circ(z-a))'-(k+1)(z-a)^k[z^k]\\mathcal F(z)$$\n\n\u800c\n\n$$\\sum_{i=0}^k\\binom nia^{n-i}(z-a)^i=\\sum_{p=0}^k\\binom npz^pa^{n-p}(-1)^{k-p}\\binom{n-p-1}{k-p}$$\n\n\u4e0d\u96be\u60f3\u5230\u63d0\u53d6\u7cfb\u6570\u8f6c\u6210\u9012\u63a8\u3002\n\n---\n\u7136\u540e $[z^0]\\mathcal F$ \u548b\u7b97\uff1f\n\n$$\n[z^0]\\mathcal F=\\sum_{i=0}^k(-a)^i\\sum_{j=i}^{n-1}\\binom jia^{j-i}=1+(-1)^ka\\sum_{j=0}^{n-2}a^j\\binom jk\n$$\n\n${\\rm I}.a\\neq1$\n\n$$g_k=\\sum_0^{n-1}a^x\\binom xk\\delta x$$\n\n$$\n\\sum a^x\\binom xk\\delta x\n={a^x\\binom xk\\over a-1}-{a\\over a-1}\\sum a^x\\binom x{k-1}\\delta x\n$$\n\n$$g_k={a^{n-1}\\binom{n-1}k\\over a-1}-{a\\over a-1}g_{k-1}$$\n\n$g$ \u5f88\u5bb9\u6613\u7ebf\u6027\u9012\u63a8\u3002\n\n${\\rm II}.a=1$\n\n$$[z^0]\\mathcal F=1+(-1)^k\\binom{n-1}{k+1}$$\n\n---\n\u8bb0 $w=[z^k]\\mathcal F(z)$\uff0c\u90a3\u4e48\u63d0\u53d6\u7cfb\u6570\u8f6c\u6210\u9012\u63a8\uff0c\u6bcf\u4e2a\u6570\u53ef\u4ee5\u8868\u793a\u4e3a $kw+b$ \u5f62\u5f0f\uff0c\u6700\u540e\u9ad8\u65af\u6d88\u5143\u89e3\u51fa $w$ \u65e2\u5f97 $\\mathcal F$ \u7cfb\u6570\uff0c\u4e8e\u662f\u7b54\u6848\u5c31\u53ef\u505a\u4e86\u3002\uff08\u6bd4\u8f83\u5947\u602a\u7684\u662f\u6ca1\u6709\u51fa\u73b0\u89e3\u51fa\u65e0\u6570\u591a\u4e2a $w$ \u7684\u60c5\u51b5\uff0c\u4e2a\u4e2d\u7406\u7531\u6211\u4e5f\u4e0d\u5927\u6e05\u695a\uff09\n\n$$h_p=[z^p]\\mathcal F$$\n\n$$\nans=[{z^k\\over k!}]\\mathcal F(ae^z)\n=\\sum_ih_ia^i[{z^k\\over k!}]e^{iz}\n=\\sum_ih_ia^ii^k\n$$\n\n\u7ebf\u6027\u7b5b\u9884\u5904\u7406 $i^k$\uff0c\u603b\u590d\u6742\u5ea6 $O(k+\\log n)$\u3002\n\n---\n### Code\n\n\u4ee3\u7801\u6302\u4e00\u4e0b\u5427\uff0c\u7a0d\u5fae\u5361\u4e86\u5361\u7a7a\u95f4\u5e38\u6570\u3002\n\n```cpp\nconst ullt Mod=998244353,g=3;\ntypedef mod_ullt<Mod>modint;\ntypedef std::vector<modint>modvec;\ntypedef poly_NTT<Mod,g>poly;\ntypedef poly_eval<Mod,g>eval;\ntypedef poly_inter<Mod,g>inter;\ntypedef poly_cpd<Mod,g>cpd;\nmodint A[10000005],B[10000005];\nmodint F1[10000005],F2[10000005];\nbol Ok[10000005];\nint main()\n{\n    A[0]=1;for(uint i=1;i<=10000001;i++)A[i]=A[i-1]*i;\n    B[10000001]=A[10000001].inv();for(uint i=10000001;i;i--)B[i-1]=B[i]*i;\n    uint n,k;modint a;\n    scanf(\"%u\",&n),n++,a.read(),scanf(\"%u\",&k);\n    modint t1=a._power(n),t2=(-a)._power(k),q=a.inv(),w;\n    modint i1=(a-1).inv(),i2=a._power(n-1);\n    if(a==1)\n    {\n        F1[0]=B[k+1];\n        for(uint i=0;i<=k;i++)F1[0]*=n-1-i;\n        F1[0]=1+((k&1)?Mod-1:1)*F1[0];\n    }\n    else{\n        modint now=(i2-1)*i1;w=n-1;\n        for(uint i=1;i<=k;i++)\n        {\n            now=(-a*now+w*i2)*i1,w=w*(n-i-1)*B[i+1]*A[i];\n        }\n        F1[0]=now*a*(k&1?Mod-1:1)+1;\n    }\n    F2[k]=1;for(uint i=k-1;i;i--)F2[i]=F2[i+1]*(n-i-1)*B[k-i]*A[k-i-1];\n    w=1;\n    for(uint i=1;i<=k;i++)\n    {\n        t1*=q,w*=(n-i+1)*B[i]*A[i-1];\n        F1[i]=F1[i-1]-w*t1*(((k-i)&1)?Mod-1:1)*F2[i],F2[i]=F2[i-1]-(k+1)*A[k]*B[i-1]*B[k-i+1]*t2*B[i]*A[i-1];\n        t2*=-q;\n    }\n    w=F1[k]/(1-F2[k]);\n    for(uint i=0;i<=k;i++)F2[i]=F1[i]+F2[i]*w;\n    modint ans;\n    F1[0]=0,F1[1]=1;\n    std::vector<uint>Prime;\n    for(uint i=2;i<=k;i++)\n    {\n        if(!Ok[i])\n        {\n            Prime.push_back(i);\n            w=modint(i)._power(k);\n            for(ullt j=i;j<=k;j*=i)\n            {\n                Ok[j]=true;\n                F1[j]=F1[j/i]*w;\n            }\n        }\n        for(ullt p:Prime)\n            if(i*p<=k&&i%p)\n            {\n                for(ullt t=p;t*i<=k;t*=p)\n                {\n                    Ok[t*i]=true;\n                    F1[t*i]=F1[t]*F1[i];\n                }\n            }\n            else break;\n    }\n    w=1;\n    for(uint i=0;i<=k;i++)\n        ans+=F2[i]*w*F1[i],w*=a;\n    ans.println();\n    return 0;\n}\n```\n",
        "postTime": 1646564438,
        "uid": 105050,
        "name": "myee",
        "ccfLevel": 7,
        "title": "5907"
    },
    {
        "content": "\u672c\u9898\u89e3\u4f7f\u7528 EI \u79d1\u6280 \u8f7d\u8c2d Binomial Sum\u3002\n\n\u7ed9\u5b9a $n,q,k$\uff0c\u6c42 $\\sum_{i=0}^ni^kq^i$\u3002\n\n$G(x)$ \u53d6 $qe^x$\uff0c$F(x)$ \u53d6 $\\frac{1-x^{n+1}}{1-x}$\uff0c\u6211\u4eec\u5df2\u77e5 $\\forall 0\\le i\\le k,[\\frac{x^k}{k!}](qe^x)^i=q^ii^k$\uff0c\u6c42 $\\sum_{i=0}^ni^kq^i=[\\frac{x^k}{k!}]F(G(x))$\u3002\n\n$F(x)$ \u6ee1\u8db3\u7684\u5fae\u5206\u65b9\u7a0b\u662f $F(x)+(x-1)F^{\\prime}(x)=(n+1)x^{n}$\u3002\n\n\u5373 $-nF(x)+((2-n)x+n)F^{\\prime}(x)+(x^2-x)F^{\\prime\\prime}(x)=0$\u200b\u3002\n\n\u8bbe $F_0(x+q)=F(x+q)\\bmod x^{k+1}$\u3002\n\n\u6211\u4eec\u8981\u6c42\u7684\u7b54\u6848\u5c31\u7b49\u4e8e $[\\frac{x^k}{k!}]F_0(G(x))$\uff0c\u8fd9\u662f\u56e0\u4e3a $F_0(x+q)=F(x+q)\\bmod x^{k+1}$\uff0c\u4e14 $G(x)-q$ \u6ca1\u6709\u5e38\u6570\u9879\uff0c\u90a3\u4e48\u5c06 $G(x)-q$ \u4ee3\u5165 $F_0(x+q)$ \u7ed3\u679c\u7684 $k$ \u6b21\u9879\u7cfb\u6570\u5c31\u5e94\u8be5\u7b49\u4e8e\u4ee3\u5165 $F(x+q)$ \u7ed3\u679c\u7684 $k$ \u6b21\u9879\u7cfb\u6570\uff0c\u56e0\u4e3a $(G(x)-q)^i$ \u5728 $i>k$ \u65f6\u65f6\u4e0d\u4f1a\u5bf9 $k$ \u6b21\u9879\u4ea7\u751f\u8d21\u732e\u7684\u3002\n\n$$\n\\begin{aligned}\n-nF(x+q)+((2-n)(x+q)+n)F^{\\prime}(x+q)+((x+q)^2-(x+q))F^{\\prime\\prime}(x+q)&=0\\\\\n-nF(x+q)+((2-n)x+2q-nq+n)F^{\\prime}(x+q)+(x^2+(2q-1)x+q^2-q)F^{\\prime\\prime}(x+q)&=0\\\\\n-nF_0(x+q)+((2-n)x+2q-nq+n)F_0^{\\prime}(x+q)+(x^2+(2q-1)x+q^2-q)F_0^{\\prime\\prime}(x+q)&=ax^k+bx^{k-1}\\\\\n\\end{aligned}\n$$\n\n\u8bbe $c=[x^k]F(x+q),d=[x^{k-1}]F(x+q)$\uff0c\u5219\u4e0a\u5f0f $a,b$ \u5206\u522b\u4e3a\n\n$$\n\\begin{aligned}\na&=-nc+(2-n)kc+k(k-1)c\\\\\nb&=-nd+(2-n)(k-1)d+(2q-nq+n)kc+(k-1)(k-2)d+(2q-1)k(k-1)c\\\\\n\\end{aligned}\n$$\n\n\u8003\u8651\u6c42\u51fa $c,d$\uff0c$c=\\sum_{i=0}^n[x^k] (x+q)^i=\\sum_{i=k}^nq^{i-k}\\binom ik$\u3002\n\n$$\n\\begin{aligned}\nh_k&=\\sum_{i=k}^nq^{i-k}\\binom ik\\\\\n&=\\sum_{i=k}^nq^{i-k}(\\binom {i-1}{k-1}+\\binom{i-1}{k})\\\\\n&=\\sum_{i=k-1}^{n-1}q^{i-(k-1)}\\binom {i}{k-1}+q\\sum_{i=k}^{n-1}q^{i-k}\\binom{i}{k}\\\\\n&=h_{k-1}-q^{n-k+1}\\binom n{k-1}+q(h_k-q^{n-k}\\binom nk)\n\\end{aligned}\n$$\n\n\u9012\u63a8\u5373\u53ef\uff0c\u6ce8\u610f\u7279\u5224 $q=1$\u3002\n\n\u7136\u540e\u6839\u636e\n\n$$\n-nF_0(x)+((2-n)x+n)F_0^{\\prime}(x)+(x^2-x)F_0^{\\prime\\prime}(x)=a(x-q)^k+b(x-q)^{k-1}\n$$\n\n\u6c42\u51fa $F_0$ \u5373\u53ef\uff0c\u8bbe $[x^i]F_0(x)=f_i$\uff0c\u90a3\u4e48\u6709\n\n$$\n-nf_i+(2-n)if_{i}+n(i+1)f_{i+1}+i(i-1)f_i-(i+1)if_{i+1}=a(-q)^{k-i}\\binom ki+b(-q)^{k-1-i}\\binom {k-1}i\n$$\n\n$$\nf_i=\\frac{a(-q)^{k-i}\\binom ki+b(-q)^{k-1-i}\\binom {k-1}i+(i-n)(i+1)f_{i+1}}{(i-n)(i+1)}\n$$\n\n\u6211\u4eec\u5df2\u77e5 $f_{k+1}=0$\uff0c\u5c31\u53ef\u4ee5\u6c42\u51fa $f_{0\\sim k}$ \u4e86\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f $\\sum_{i=0}^ni^kq^i=\\sum_{i=0}^kf_i[\\frac{x^k}{k!}](qe^x)^i=\\sum_{i=0}^kf_iq^ii^k$\u3002\n\n\u6ce8\u610f\uff0c $n\\le k$ \u7684\u65f6\u5019\u6c42\u89e3 $f_i$ \u65f6\u7684 $(i-n)$ \u4f1a\u51fa\u95ee\u9898\uff0c\u66b4\u529b\u5373\u53ef\u3002\n\n```cpp\n#include<iostream>\nusing std::cin;\nusing std::cout;\nint const mod=998244353;\nint n,k,q,p[1000010],pw[10000010],fac[10000010],ifac[10000010],cnt;\nbool b[10000010];\nint pow(int x,int y){\n\tint res=1;\n\twhile(y){\n\t\tif(y&1) res=1ll*res*x%mod;\n\t\tx=1ll*x*x%mod,y>>=1;\n\t}\n\treturn res;\n}\nvoid init(int n){\n\tpw[1]=1;\n\tfor(int i=2;i<=n;i++){\n\t\tif(!b[i]) p[++cnt]=i,pw[i]=pow(i,k);\n\t\tfor(int j=1;j<=cnt&&i*p[j]<=n;j++){\n\t\t\tb[i*p[j]]=1,pw[i*p[j]]=1ll*pw[i]*pw[p[j]]%mod;\n\t\t\tif(i%p[j]==0) break;\n\t\t}\n\t}\n\tfac[0]=1;\n\tfor(int i=1;i<=n;i++) fac[i]=1ll*fac[i-1]*i%mod;\n\tifac[n]=pow(fac[n],mod-2);\n\tfor(int i=n;i;i--) ifac[i-1]=1ll*ifac[i]*i%mod;\n}\nint C(int n,int m){\n\treturn 1ll*fac[n]*ifac[m]%mod*ifac[n-m]%mod;\n}\nint main(){\n\tstd::ios::sync_with_stdio(false),cin.tie(nullptr);\n\tcin>>n>>q>>k;\n\tinit(k);\n\tfor(int i=1,d=q;i<=k;i++,d=1ll*d*q%mod) pw[i]=1ll*pw[i]*d%mod;\n\tif(n<=k){\n\t\tint ans=0;\n\t\tfor(int i=1;i<=n;i++) ans=(ans+pw[i])%mod;\n\t\tcout<<ans<<'\\n';\n\t\treturn 0;\n\t}\n\tint c=1,d=1;\n\tif(q==1){\n\t\td=ifac[k];\n\t\tfor(int i=0;i<k;i++) d=1ll*d*(n+1-i)%mod;\n\t\tc=1ll*d*pow(k+1,mod-2)%mod*(n+1-k)%mod;\n\t}else{\n\t\tstatic int C[10000010];\n\t\tint iv=pow(1-q+mod,mod-2),f=(1ll-pow(q,n+1)+mod)*iv%mod;\n\t\tif(k==1) d=f;\n\t\tC[0]=1;\n\t\tfor(int i=1;i<=k;i++) C[i]=1ll*C[i-1]*(n-i+1)%mod;\n\t\tfor(int i=1;i<=k;i++) C[i]=1ll*C[i]*ifac[i]%mod;\n\t\tfor(int i=k,pw=pow(q,n-k);~i;i--,pw=1ll*pw*q%mod) C[i]=(mod-1ll)*C[i]%mod*pw%mod;\n\t\tfor(int i=1;i<=k;i++){\n\t\t\tf=(f+C[i-1]+1ll*q*C[i])%mod*iv%mod;\n\t\t\tif(i==k) c=f;\n\t\t\tif(i==k-1) d=f;\n\t\t}\n\t}\n\tint a=((mod-1ll)*n%mod*c+(2ll-n+mod)*k%mod*c+1ll*k*(k-1)%mod*c)%mod;\n\tint b=((mod-1ll)*n%mod*d+(2ll-n+mod)*(k-1)%mod*d+((2*q-1ll*n*q+n)%mod+mod)*k%mod*c+(k-1ll)*(k-2)%mod*d+(2*q-1ll+mod)*k%mod*(k-1)%mod*c)%mod;\n\tint f=0,ans=0;\n\tq=mod-q;\n\tstatic int p[10000010],cv[10000010];\n\tp[0]=cv[0]=1;\n\tfor(int i=1;i<=k;i++) p[i]=1ll*p[i-1]*q%mod;\n\tfor(int i=1;i<=k;i++) cv[i]=1ll*cv[i-1]*(i-n+mod)%mod*(i+1)%mod;\n\tint iv=pow(cv[k],mod-2);\n\tfor(int i=k;i;i--){\n\t\tcv[i]=1ll*iv*cv[i-1]%mod;\n\t\tiv=1ll*iv*(i-n+mod)%mod*(i+1)%mod;\n\t}\n\tfor(int i=k;i;i--){\n\t\tf=(f+(1ll*a*p[k-i]%mod*C(k,i)+1ll*b*p[k-i-1]%mod*C(k-1,i))%mod*cv[i])%mod;\n\t\tans=(ans+1ll*f*pw[i])%mod;\n\t}\n\tcout<<ans<<'\\n';\n\treturn 0;\n}\n```",
        "postTime": 1655345179,
        "uid": 55707,
        "name": "gxy001",
        "ccfLevel": 9,
        "title": "P5907 \u6570\u5217\u6c42\u548c\u52a0\u5f3a\u7248 / SPOJ MOON4"
    }
]
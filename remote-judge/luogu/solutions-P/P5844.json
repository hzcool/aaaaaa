[
    {
        "content": "## \u9898\u76ee\u5927\u610f\n\n\u5728\u4e00\u4e2a\u6570\u8f74\u4e0a\uff0c\u6709\u7ed9\u5b9a\u6570\u91cf\u548c\u4f4d\u7f6e\u7684\u70b9\uff08\u53ef\u4ee5\u91cd\u5408\uff0c\u4f4d\u7f6e\u6052\u6b63\u4e14\u4e3a\u6574\u6570\uff09\u3002\u4f60\u7684\u4efb\u52a1\u662f\u9009\u53d6\u5176\u4e2d\u7684\u4e00\u4e2a\u70b9\u4f5c\u4e3a\u6bd4\u8f83\u70b9\u3002\u4e4b\u540e\u5728\u7ed9\u51fa\u7684\u70b9\u4e2d\u9009\u62e9\u4e00\u90e8\u5206\uff0c\u4f7f\u5f97\u9009\u62e9\u7684\u70b9\u7684\u603b\u6570\u5c3d\u53ef\u80fd\u5927\uff0c\u4e14\u5b83\u4eec\u5230\u4f60\u6240\u9009\u62e9\u7684\u6bd4\u8f83\u70b9\u7684\u8ddd\u79bb\u4e4b\u548c\uff08\u8d39\u7528\uff09\u5c0f\u4e8e\u7b49\u4e8e\u9898\u76ee\u7ed9\u51fa\u7684\u4e0a\u9650 $B$\u3002\u4f60\u9700\u8981\u8f93\u51fa\u53ef\u9009\u62e9\u70b9\u7684\u603b\u6570\u7684\u6700\u5927\u503c\uff08\u6536\u83b7\u7684\u519c\u7530\u6570\u76ee\u7684\u6700\u5927\u503c\uff09\u3002\n\n---\n\n## \u9605\u524d\u5fc5\u8bfb\n\n\u4e8b\u5148\u58f0\u660e\uff1a\n1. \u672c\u7bc7\u9898\u89e3\u504f\u65b0\u624b\u5411\uff0c\u5927\u4f6c\u4eec\u53ea\u9700\u9605\u8bfb\u6982\u8981\u90e8\u5206\u5373\u53ef\u3002\n\n2. \u4f5c\u8005\u662f\u4e00\u53ea\u83dc\u83dc\u7684\u6728\u5934\u9171\uff0c\u5982\u6709\u5f02\u8bae/\u9519\u8bef\u6b22\u8fce\u63d0\u51fa/\u6307\u51fa QAQ \u3002\n\n\n\u672c\u7bc7\u9898\u89e3\u63d0\u4f9b\u4ee5\u4e0b\u4e09\u79cd\u505a\u6cd5\uff1a\n1. \u66b4\u529b\u6a21\u62df\u3010\u90fd\u4f1a\u505a\u5427\u2026\u2026\u5148\u4e0d\u8bb2\u4e86\uff0c\u6709\u9700\u8981\u4e0b\u65b9\u7559\u8a00\uff0c\u770b\u5230\u4f1a\u66f4\u65b0\u7684\u3011\n2. \u524d\u7f00\u548c+\u4e8c\u5206\u7b54\u6848\u3010\u65f6\u95f4\u590d\u6742\u5ea6 $O(nlogn)$\u3011 \u3010\u6b63\u89e3\u3011\n3. \u524d\u7f00\u548c+\u53cc\u5411\u6307\u9488\u3010\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$\u3011 \u3010\u7406\u8bba\u6700\u4f18\u89e3\u3011\n\n\u524d\u7f6e\u6570\u5b66\u77e5\u8bc6\uff1a[\u7edd\u5bf9\u503c\u4e0d\u7b49\u5f0f](https://www.luogu.com.cn/paste/4m8tzxcf) \u3001 [\u7edd\u5bf9\u503c\u7684\u51e0\u4f55\u610f\u4e49](https://www.luogu.com.cn/paste/yg0h8dls)\n\n\u7efc\u5408\u96be\u5ea6\u8bc4\u5b9a\uff1a\u666e\u53ca\uff0b/\u63d0\u9ad8 \u4e2d\u8f83\u96be\u7684\u4e00\u7c7b\uff0c\u5982\u679c\u771f\u7684\u8981\u601d\u8003\u7684\u5f88\u900f\u5f7b\u7684\u8bdd\u4e2a\u4eba\u8ba4\u4e3a\u53ef\u4ee5\u591f\u5230\u4e00\u70b9\u70b9\u7701\u9009\u96be\u5ea6\uff08\u7edd\u5bf9\u503c\u4e0d\u7b49\u5f0f\u3010\u4e2d\u4f4d\u6570\u3011 + \u524d\u7f00\u548c + \u4e8c\u5206\u7b54\u6848 + \u539f\u9898\u9762\u82f1\u6587\u7406\u89e3\u56f0\u96be\uff09\n\n---\n\n## \u8be6\u7ec6\u89e3\u7b54\n\n\u672c\u9898\u7684\u5173\u952e\u5728\u4e8e**\u5982\u4f55\u5feb\u901f\u5730\u5728\u9009\u62e9\u4e24\u4e2a\u7ed9\u5b9a\u70b9\u540e\u8ba1\u7b97\u51fa\u8fd9\u4e00\u533a\u95f4\u5185\u6240\u6709\u7ed9\u5b9a\u70b9\u5230\u533a\u95f4\u5185\u4efb\u4e00\u6bd4\u8f83\u70b9\u8ddd\u79bb\u4e4b\u548c\u7684\u6700\u5c0f\u65f6\u7684\u82b1\u8d39**\u3002\u8fd9\u91cc\u5c06\u8fd0\u7528[\u7edd\u5bf9\u503c\u4e0d\u7b49\u5f0f](https://www.luogu.com.cn/paste/4m8tzxcf)\u8fdb\u884c\u8bf4\u660e\u3002\uff08\u94fe\u63a5\u5185\u63d0\u4f9b\u8bf4\u660e\u548c\u8bc1\u660e\uff09\n\n\u5bf9\u4e8e\u5df2\u7ecf\u786e\u5b9a\u7684\u67d0\u4e00\u533a\u95f4\uff0c\u8bbe\u5176\u4e2d\u5305\u542b\u7684\u7ed9\u5b9a\u70b9\u4e3a $a_1,a_2, $ ... $, a_{m-1},a_m$ \uff08 \u5176\u4e2d $a_1\\leq a_2 \\leq ... \\leq a_{m-1} \\leq a_m$ \uff09\n\n\u90a3\u4e48\u5bf9\u4e8e\u9009\u4e2d\u7684\u6bd4\u8f83\u70b9 $a_k$ \uff08$1\\leq k \\leq m$\uff09 \u3002\u5176\u8ddd\u79bb\u4e4b\u548c\uff08\u603b\u82b1\u8d39\uff09\u53ef\u4ee5\u8868\u793a\u4e3a $\\vert a_k-a_1\\vert+\\vert a_k-a_2 \\vert + ... + \\vert a_{m-1}-a_k \\vert + \\vert a_m - a_k\\vert$ \uff08\u53c2\u8003\uff1a[\u7edd\u5bf9\u503c\u7684\u51e0\u4f55\u610f\u4e49](https://www.luogu.com.cn/paste/yg0h8dls)\uff09\n\n\u5f53 $m$ \u4e3a\u5076\u6570\u65f6\uff0c\u6211\u4eec\u5bf9\u5176\u4ece\u9996\u5c3e\u5f00\u59cb\u4e24\u4e24\u5206\u7ec4\uff0c\u5373\uff1a\n\n$(\\vert a_k-a_1\\vert+\\vert a_m-a_k \\vert) + ... + ( \\vert a_k-a_{\\frac{m}{2}} \\vert + \\vert a_{\\frac{m}{2}+1} - a_k\\vert)$  \u2460\n\n\u63a5\u4e0b\u6765\u5bf9\u6bcf\u4e00\u7ec4\u4f7f\u7528\u7edd\u5bf9\u503c\u4e0d\u7b49\u5f0f\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n\n\u2460 $ \\geq( a_m-a_1 ) + ( a_{m-1}-a_2 ) ... + (  a_{\\frac{m}{2}+1} - a_{\\frac{m}{2}} )$ \n\n\u7b49\u53f7\u5f53\u4e14\u4ec5\u5f53\u5728 $(a_k-a_{\\frac{m}{2}}) \\times (a_{\\frac{m}{2}+1} - a_k)\\geq0$ \uff0c\u5373$a_{\\frac{m}{2}}\\leq a_k \\leq a_{\\frac{m}{2}+1}$\u65f6\u6210\u7acb\n\n\uff08\u6ce8\uff1a\u5f53\u53d1\u73b0\u65e0\u6cd5\u628a\u67d0\u4e00\u7ec4\u4e2d\u7684 $a_k$ \u6d88\u6389\u65f6\u8bf4\u660e\u4f60\u6ca1\u6709\u7406\u89e3\u7edd\u5bf9\u503c\u4e0d\u7b49\u5f0f\u7684\u771f\u6b63\u542b\u4e49\uff0c\u89e3\u51b3\u65b9\u6cd5\u53ef\u4ee5\u7b80\u5355\u5730\u628a\u5176\u4e2d\u4e00\u4e2a\u5728\u7edd\u5bf9\u503c\u7b26\u53f7\u5185\u4e58\u4ee5\u8d1f\u4e00\uff09\n\n\u5f53 $m$ \u4e3a\u5947\u6570\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u7b2c m/2+1 \u9879\u5355\u72ec\u63d0\u51fa\uff0c\u4e4b\u540e\u5c31\u80fd\u8fdb\u884c\u7c7b\u4f3c\u7684\u64cd\u4f5c\uff0c\u5f97\u5230 \u603b\u8d39\u7528 $ \\geq( a_m-a_1 ) + ( a_{m-1}-a_2 ) ... + (  a_{m/2+2} - a_{m/2} )$  \uff0c\u6ce8\u610f\u9700\u8981\u5c06\u53d6\u7b49\u6761\u4ef6\u4fee\u6539\u4e3a $a_k=a_{m/2+1}$ \u5373\u53ef\u3002\n\n$\\color{red}\\colorbox{#f8f8f9}{\u7efc\u4e0a\u6240\u8ff0}$\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\uff1a\u5728\u9009\u5b9a\u7684\u4ee5\u4e24\u4e2a\u7ed9\u5b9a\u70b9 $a_1$ \u3001$a_m$ \u4e3a\u7aef\u70b9\u7684\u95ed\u533a\u95f4\u5185\uff0c\u5f53\u6bd4\u8f83\u70b9 $a_k = a_{m/2+1}$ \u65f6\uff0c\u7ed9\u5b9a\u70b9\u7684\u6570\u76ee\u5c06\u4f1a\u53d6\u5230\u6700\u5927\u503c\uff0c\u5176\u503c\u5982\u4e0a\u8ff0\u3002\u53ea\u9700\u8981\u5bf9\u7ed9\u5b9a\u70b9\u7684\u5750\u6807\u4e4b\u548c\u4f7f\u7528[**\u524d\u7f00\u548c\u7ef4\u62a4**](https://www.luogu.com.cn/paste/664z5z95)\uff0c\u5373\u53ef\u505a\u5230 $O(n)$ \u67e5\u8be2\uff08\u6ce8\uff1a\u6211\u8ba4\u4e3a\u5982\u679c\u5230\u6b64\u6b65\u5404\u4f4d\u6ca1\u6709\u7406\u89e3\u56f0\u96be\u7684\u8bdd\u5e94\u8be5\u53ef\u4ee5\u63a8\u51fa\u5229\u7528\u524d\u7f00\u548c\u5feb\u901f\u6c42\u533a\u95f4\u8d39\u7528\u7684\u901a\u5f0fQAQ\uff0c\u6ca1\u4ec0\u4e48\u60f3\u6cd5\u7684\u5148\u628a \u2460 \u518d\u8bfb\u4e00\u8fb9\uff0c\u7136\u540e\u8fd8\u4e0d\u884c\u5c31\u70b9\u94fe\u63a5\uff0c\u6709\u8be6\u7ec6\u8bf4\u660e\uff09\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u5f00\u59cb\u5bfb\u627e\u7b26\u5408\u8981\u6c42\u7684\u533a\u95f4\uff0c\u5982\u679c\u53ea\u6c42\u901a\u8fc7\u7684\u8bdd\uff0c\u53ef\u4ee5\u8fd0\u7528\u4e8c\u5206\u601d\u60f3\u3002\u4f9d\u6b21\u4ece $x_1$ \u5f00\u59cb\u4e00\u76f4\u904d\u5386\u5230 $x_R$ \u67e5\u627e\u533a\u95f4\u7684\u5de6\u7aef\u70b9\uff0c\u4e4b\u540e\u4e8c\u5206\u67e5\u627e\u6bcf\u4e00\u4e2a\u5de6\u7aef\u70b9 $x_i$ \u5bf9\u5e94\u7684\u53f3\u7aef\u70b9 $x_j$ \u4f7f\u5f97\u6536\u83b7\u7684\u519c\u7530\u6700\u591a\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<cstdio>\n#include<cstdlib>\nusing namespace std;\nconst int SIZE=1e5+5;\nlong long R,L,B,ans,mid;\nlong long x[SIZE],sum[SIZE];\ninline long long max(long long a,long long b){\n\tif(a>b) return a;\n\telse return b;\n}\nlong long check(long long l,long long r){\n\tmid=l+r>>1;\n\treturn x[mid]*(mid*2-l-r)+sum[l-1]+sum[r]-sum[mid]-sum[mid-1];\n}\nint main(){\n\tscanf(\"%lld%lld%lld\",&R,&L,&B);\n\tfor(long long i=1;i<=R;i++){\n\t\tscanf(\"%lld\",&x[i]);\n\t\tsum[i]=sum[i-1]+x[i];\n\t}\n\tlong long l,r,mid,k;\n\tfor(long long i=1;i<=R;i++){\n\t\tl=i;r=R;\n\t\twhile(l<=r){\n\t\t\tmid=l+r>>1;\n\t\t\tif(check(i,mid)<=B){\n\t\t\t\tl=mid+1;k=mid;\n\t\t\t}\n\t\t\telse r=mid-1;\n\t\t}\n\t\tans=max(ans,k-i+1);\n\t}\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```\n\n\u9644[\u901a\u8fc7\u8bb0\u5f55](https://www.luogu.com.cn/record/40865413)\n\n\u800c\u5bf9\u4e8e\u53cc\u5411\u6307\u9488\uff0c\u5176\u601d\u60f3\u4e5f\u76f8\u5f53\u7b80\u5355\u3002\u521d\u59cb\u65f6\u9009\u5b9a\u533a\u95f4 $[x[1],x[1]]$\uff08\u6b64\u65f6\u82b1\u8d39\u4e3a0\uff0c\u80af\u5b9a\u6ee1\u8db3\u8981\u6c42\uff09\u3002 \u63a5\u4e0b\u6765\u628a\u7b2c\u4e8c\u4e2a $x[1]$ \u7684\u4e0b\u6807\u53f3\u79fb\uff0c\u6bcf\u53f3\u79fb\u4e00\u6b21\u5224\u65ad\u4e00\u6b21\u3002\u5f53\u603b\u82b1\u8d39\u8d85\u8fc7 $B$ \u65f6\u5219\u5c06\u7b2c\u4e00\u4e2a $x[1]$ \u7684\u4e0b\u6807\u53f3\u79fb\u4e00\uff0c\u7136\u540e\u518d\u5224\u65ad\u603b\u82b1\u8d39\u662f\u5426\u6ee1\u8db3\u8981\u6c42\uff0c\u662f\u5219\u53f3\u79fb\u53f3\u7aef\u70b9\uff0c\u5426\u5219\u53f3\u79fb\u5de6\u7aef\u70b9\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff0c\u5f97\u5230\u7ed3\u679c\u3002\uff08\u5176\u6b63\u786e\u6027\u57fa\u4e8e\u8f93\u5165\u7684 $x_i$ \u5355\u8c03\u9012\u589e\uff0c\u6545\u53f3\u7aef\u70b9\u4e0d\u9700\u8981\u5728\u5de6\u7aef\u70b9\u53f3\u79fb\u540e\u5de6\u79fb\uff09\n\n```cpp\n#include<cstdio>\n#include<cstdlib>\nusing namespace std;\nconst int SIZE=1e5+5;\nlong long R,L,B,ans,mid;\nlong long x[SIZE],sum[SIZE];\ninline long long max(long long a,long long b){\n\tif(a>b) return a;\n\telse return b;\n}\nlong long check(long long l,long long r){\n\tmid=l+r>>1;\n\treturn x[mid]*(mid*2-l-r)+sum[l-1]+sum[r]-sum[mid]-sum[mid-1];\n}\nint main(){\n\tscanf(\"%lld%lld%lld\",&R,&L,&B);\n\tfor(long long i=1;i<=R;i++){\n\t\tscanf(\"%lld\",&x[i]);\n\t\tsum[i]=sum[i-1]+x[i];\n\t}\n\tfor(long long l=1,r=1;l<=R;l++){\n\t\twhile(r<R&&check(l,r+1)<=B) ++r;\n\t\t//\u6b64\u5904r\u5ffd\u7565\u4e86 [x[1],x[1]] \u7684\u533a\u95f4\uff0c\u5e76\u4ee5 r+1 \u548c r<R\u4f5c\u4e3a\u5224\u65ad\u4f9d\u636e\n\t\t//\u662f\u4e3a\u4e86\u4fbf\u4e8e\u8ba1\u7b97ans\n\t\tans=max(ans,r-l+1);\n\t}\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```\n\n\u9644[\u901a\u8fc7\u8bb0\u5f55](https://www.luogu.com.cn/record/40865445)\n\n\u4ee3\u7801\u4e2d\u4e0e\u8be6\u89e3\u4e0d\u540c\u7684\u90e8\u5206\u5df2\u7528\u6ce8\u91ca\u9610\u660e\u3002\u672c\u9898\u7684\u91cd\u96be\u70b9\u5176\u5b9e\u662f\u5728 check \u51fd\u6570\u91cc\uff0c\u8bf7\u5404\u4f4d\u5c0f\u5fc3\uff0c\u4e0d\u8981\u9519\u4f30\u5176\u96be\u5ea6\u6240\u5728\u3002\n\n\u6700\u540e\uff1a\u5982\u6709\u7591\u95ee\u6b22\u8fce\u63d0\u51fa\uff0c\u6728\u5934\u9171\u770b\u5230\u540e\u4f1a\u56de\u590d\u5728\u8bc4\u8bba\u533a\u3002\n\n\u4ee5\u4e0a\uff0c\u5e0c\u671b\u8fd9\u7bc7\u9898\u89e3\u80fd\u591f\u5e2e\u5230\u6ce5\u4eecQWQ",
        "postTime": 1604076371,
        "uid": 52428,
        "name": "Jameswood",
        "ccfLevel": 0,
        "title": "P5844 [IOI2011]ricehub"
    },
    {
        "content": "**[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5844)**\n# \u9898\u610f\u7b80\u660e\n\n\u5728\u6570\u8f74\u4e0a\u6709 $R$ \u4e2a\u6574\u70b9\uff08\u53ef\u91cd\u53e0\uff09\u3002\u73b0\u5728\u6211\u4eec\u8981\u9009\u53d6\u5176\u4e2d\u7684\u4e00\u4e2a\u70b9\u4f5c\u4e3a\u4e2d\u5fc3\u70b9\uff0c\u5e76\u5728\u5176\u4f59\u70b9\u4e2d\u9009\u82e5\u5e72\u4e2a\u3002\u6ee1\u8db3\u4e2d\u5fc3\u70b9\u5230\u5176\u4f59\u70b9\u7684\u8ddd\u79bb\u4e4b\u548c\u5c0f\u4e8e\u7b49\u4e8e $B$\u3002\u4e14\u4f7f\u9009\u51fa\u7684\u70b9\u7684\u6570\u91cf\u5c3d\u91cf\u591a\u3002\u8f93\u51fa\u8fd9\u4e2a\u6700\u5927\u503c\u3002\n\n# \u601d\u8def\u5206\u6790\n\n\u7b2c\u4e00\u773c\u770b\u5230\u8fd9\u4e2a\u9898\u6211\u60f3\u5230\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u6570\u5b66\u7ed3\u8bba\uff08\u6b64\u5904\u4e0d\u4f5c\u8bc1\u660e\uff09\uff1a\n\n\u6570\u8f74\u4e0a\u6709 $n$ \u4e2a\u70b9\uff0c\u5750\u6807\u5206\u522b\u4e3a $ x_1,x_2,\\ldots ,x_n $\uff0c\u4e14 $ x_1 \\le x_2 \\le \\ldots \\le x_n $\u3002\u4efb\u53d6\u4e00\u70b9 $ k $ \u4f7f\u5f97\u8be5\u70b9\u5230\u5176\u4f59\u70b9\u7684\u8ddd\u79bb\u4e4b\u548c\uff0c\u5373 $\\sum\\limits_{i=1}^n\\left\\vert x_i-x_k\\right\\vert$ \u6700\u5c0f\u3002\u5219\u6709\n$ \\begin{cases}\nx_k=x_\\frac{1+n}{2} & n \\equiv 1 \\pmod 2\\\\\nx_k \\in \\left[x_\\frac{n}{2},x_\\frac{n}{2}+1\\right] & n \\equiv 0 \\pmod 2\\\\\n\\end{cases} $\u3002\n\n\u6b64\u65f6\uff0c$sum_\\text{min}=\\sum\\limits_{i=1}^n\\left\\vert x_i-x_k\\right\\vert=\\sum\\limits_{i=1}^{\\left\\lfloor\\frac{n}{2}\\right\\rfloor} \\left\\vert x_i-x_{n-i}\\right\\vert$\uff0c\u53d6\u5230\u6700\u5c0f\u503c\u3002\n\n\u6839\u636e\u4ee5\u4e0a\u7ed3\u8bba\uff0c\u6211\u4eec\u4e0d\u96be\u53d1\u73b0\uff1a\u5728\u533a\u95f4 $ \\left[x_l,x_r\\right] $ \u5185\uff0c\u53d6\u4e2d\u95f4\u70b9 $x_k=x_{\\frac{l+r}{2}}$\u65f6\uff0c$ sum$ \u503c\u6700\u5c0f\u3002\u6b64\u65f6 $ sum= \\sum\\limits_{i=l}^{\\left\\lfloor\\frac{l+r}{2}\\right\\rfloor}  \\left\\vert x_i-x_{n-i}\\right\\vert=(x_r+x_{r-1}+\\cdots+x_{\\left\\lfloor\\frac{l+r}{2}\\right\\rfloor+1})-(x_l+x_{l+1}+\\cdots+x_{\\left\\lfloor\\frac{l+r}{2}\\right\\rfloor}) $\uff0c\u8003\u8651\u4f7f\u7528\u524d\u7f00\u548c\u7ef4\u62a4\u533a\u95f4\u5750\u6807\u4e4b\u548c\u3002\u5177\u4f53\u4ee3\u7801\u5b9e\u73b0\u5982\u4e0b\uff1a\n```cpp\nbool check(ll l,ll r)\n{\n    ll mid=(l+r)/2;\n    return ((sum[r]-sum[mid])-(sum[mid-1]-sum[l-1])-a[mid]*((r-l)&1))<=v;//\u4ee3\u7801\u6838\u5fc3 \n    //\u82e5r-l+1\u4e3a\u5076\u6570\uff0c\u5373r-l\u4e3a\u5947\u6570\u65f6\uff0c\u5c11\u51cf\u4e86a[mid]\u3002 \n}\n```\n\u8fd9\u91cc\u7ed9\u51fa\u53cc\u6307\u9488\u7684\u4ee3\u7801\uff1a\u5de6\u53f3\u6307\u9488 $ i,j $ \u521d\u503c\u4e3a $ 1,0 $\uff0c\u5de6\u6307\u9488\u6bcf\u6b21\u5411\u53f3\u79fb\u52a8\u4e00\u683c\uff0c\u7136\u540e\u53f3\u6307\u9488\u4e0d\u65ad\u5f80\u53f3\u79fb\u3002\u82e5 $\\left[x_i,x_j\\right]$ \u6c42\u51fa\u7684 $ sum_\\text{min} \\le B$\uff0c\u5219\u53d6\u8be5\u533a\u95f4\u7684\u6240\u6709\u70b9\u6ee1\u8db3\u6761\u4ef6\u3002\u76f4\u5230\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u6700\u5927 $j$\uff0c\u66f4\u65b0\u7b54\u6848\u3002\u6700\u540e\u6ce8\u610f\u4e00\u4e0b\u8981\u5f00 $\\text{long long}$ \u7684\u95ee\u9898\u5373\u53ef\u3002\n# \u4ee3\u7801\u5b9e\u73b0\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define ll long long\nll n,m,v,a[100005],sum[100005],ans=-1;\nbool check(ll l,ll r)\n{\n    ll mid=(l+r)/2;\n    return ((sum[r]-sum[mid])-(sum[mid-1]-sum[l-1])-a[mid]*((r-l)&1))<=v;//\u4ee3\u7801\u6838\u5fc3 \n    //\u82e5r-l+1\u4e3a\u5076\u6570\uff0c\u5373r-l\u4e3a\u5947\u6570\u65f6\uff0c\u5c11\u51cf\u4e86a[mid]\u3002 \n}\nint main()\n{\n    scanf(\"%lld%lld%lld\",&n,&m,&v);\n    for(ll i=1;i<=n;i++)\n    {\n        scanf(\"%lld\",&a[i]);\n        sum[i]=sum[i-1]+a[i];\n    }\n    for(ll l=1,r=0;l<=n;l++)\n    {\n        while(r<n&&check(l,r+1))\n            r++;\n        ans=max(ans,r-l+1);\n    }\n    printf(\"%lld\",ans);\n    return 0;\n}\n```\n \u5e0c\u671b\u672c\u7bc7\u9898\u89e3\u53ef\u4ee5\u5e2e\u5230\u5927\u5bb6\uff01\uff01\uff01",
        "postTime": 1666439382,
        "uid": 631576,
        "name": "cyz2010",
        "ccfLevel": 0,
        "title": "P5844\u9898\u89e3"
    },
    {
        "content": "[ricehub \u306e \u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5844)\n\n\u8003\u8651\u4e8c\u5206\u679a\u4e3e\u7a3b\u7530\u6570 $x$\u3002\n\n\u5faa\u73af\u6765\u679a\u4e3e\u60f3\u6536\u5272\u7684 $x$ \u4e2a\u7a3b\u7530\u4e2d\u6700\u5de6\u8fb9\u7684\u90a3\u4e2a\u7a3b\u7530\u4f4d\u7f6e $l$\uff0c\u7136\u540e\u901a\u8fc7 $x$ \u63a8\u51fa $r$ \u548c $mi$\uff08\u6700\u53f3\u8fb9\u7684\u4f4d\u7f6e\u548c\u4e2d\u95f4\u4f4d\u7f6e\uff09\u3002\n\n\u8c37\u4ed3\u5728\u4e2d\u95f4\u65f6\u4e3a\u6700\u4f18\u89e3\uff08\u8fd9\u4e2a\u53bb\u8bd5\u8bd5\u753b\u51fa\u6765\u60f3\uff09\u6240\u4ee5\u8c37\u4ed3\u4f4d\u7f6e\u4e3a $mi$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u679a\u4e3e\u7684\u8fd9\u6bb5\u533a\u95f4\u7684\u8d39\u7528\u662f\u591a\u5c11\u5462\uff1f\u53ef\u4ee5\u5148\u5faa\u73af\u6765\u8ba1\u7b97\uff0c\u4f46\u4e4b\u524d\u7684\u679a\u4e3e\u5df2\u7ecf\u662f $O(n\\log{n})$ \u4e86\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528**\u524d\u7f00\u548c**\u6765\u5b9e\u73b0\u3002\n\n\u9996\u5148\u8bbe\u8d39\u7528\u4e3a $sum$\uff0c$f_i$ \u8868\u793a $1\\sim i$ \u5757\u7a3b\u7530\u7684\u5750\u6807\u548c\uff0c$a$ \u6570\u7ec4\u8868\u793a\u6bcf\u5757\u7a3b\u7530\u7684\u5750\u6807\uff0c\u53d8\u91cf $now$ \u6765\u8868\u793a\u7c73\u4ed3\u7684\u5750\u6807\uff08\u5c31\u662f $a_{now}$\uff09\uff0c\u5219\u516c\u5f0f\u4e3a $sum=now\\times (mi-l)-(f_{mi-1}-f_{l-1})+(f_r-f_{mi})-now\\times (r-mi)$\u3002 \n\n\u56e0\u4e3a\u6211\u4eec\u9700\u8981\u628a\u533a\u95f4\u5206\u6210\u5de6\u53f3\u4e24\u8fb9\u6765\u505a\uff0c\u5de6\u8fb9\u7684\u8d39\u7528\u4e3a $now-a_l+now-a_{l+1}+now-a_{l+2}+\\dots +now-a_{mi-1}$\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5b83\u662f\u6709\u591a\u4e2a $now-a_x$ \u7ec4\u5408\u800c\u6210\uff0c\u5e76\u4e14\u6709 $mi-l$ \u9879\uff0c\u5219\u5f0f\u5b50\u53d8\u4e3a $now\\times (mi-l)-(a_l+a_{l+1}+a_{l+2}+....+a_{mi-1})$\u3002\n\n\u90a3\u4e48 $a_l+\\dots+a_{mi-1}$ \u5373\u4e3a\u7b2c $l$ \u5757\u7a3b\u7530\u5230\u7b2c $mi-1$ \u5757\u7a3b\u7530\u7684\u5750\u6807\u4e4b\u548c\uff0c\u53ef\u4ee5\u76f4\u63a5\u7528\u524d\u7f00\u548c\u76f4\u63a5\u8868\u793a\u4e3a $f_{mi-1}-f_{l-1}$\uff0c\u5de6\u8fb9\u7684\u5f0f\u5b50\u6700\u7ec8\u6210\u4e3a $now\\times (mi-l)-(f_{mi-1}-f_{l-1})$\uff0c\u540c\u7406\u53f3\u8fb9\u7684\u5f0f\u5b50\u4e5f\u53ef\u4ee5\u8fd9\u6837\u63a8\u51fa\u6765\u3002\n\n\u7b97\u51fa $sum$ \u540e\u53ea\u8981\u6bd4 $B$ \u5143\u5c0f\uff0c\u5c31\u6210\u7acb\u4e86\uff0c\u5426\u5219\u4e0d\u6210\u7acb\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\nusing namespace std;\nlong long f[100010],now,k,ans,a[100010],sum,n,l,b,lef,righ,mid;\nbool check(long long x){\n  int i,l,r,mi;\n  for (i=1;i<=n-x+1;++i){\n      l=i;//\u6700\u5de6\u8fb9\u7684\u7a3b\u7530\n\t\tr=i+x-1;//\u6700\u53f3\u8fb9\u7684\u7a3b\u7530\n\t\tmi=(l+r)/2;//\u7c73\u4ed3\n      now=a[mi];//\u7c73\u4ed3\u5750\u6807\n      sum=now*(mi-l)-(f[mi-1]-f[l-1])+(f[r]-f[mi])-now*(r-mi);\n//\u5f0f\u5b50\u7684\u5177\u4f53\u63a8\u6cd5\u5df2\u7ecf\u5199\u5728\u4e0a\u9762\u4e86\n      if (sum<=b) return true;\n  }\n  return false;\n}\nint main(){\n cin>>n>>l>>b;\n for (int i=1;i<=n;++i) cin>>a[i];\n f[0]=0;\n for (int i=1;i<=n;++i) f[i]=f[i-1]+a[i];//\u524di\u4e2a\u7a3b\u7530\u7684\u5750\u6807\u4e4b\u548c\n lef=0;\n righ=n+1;\n ans=0;\n while (lef<=righ) {//\u679a\u4e3e\u6709\u51e0\u5757\u7a3b\u7530\u80fd\u6536\u5272\n     mid=(lef+righ)/2;\n     if (check(mid)==true){\n       lef=mid+1;\n       if (ans<mid) ans=mid;\n     }\n     else righ=mid-1;\n  } \n  cout<<ans<<endl;\n  return 0;\n}\n```",
        "postTime": 1681910518,
        "uid": 688783,
        "name": "NM_ljy",
        "ccfLevel": 0,
        "title": "[IOI2011]ricehub"
    },
    {
        "content": "### [\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5844)\n\uff08\u5982\u679c $\\LaTeX$ \u70b8\u4e86\uff0c\u8bf7\u5230\u535a\u5ba2[\u89c2\u770b](https://www.luogu.com.cn/blog/thats-me/ti-jie-p5844-ioi2011ricehub)\uff09\n\n$\\Large\\mathscr{Part\\,\\,1\\;\\;}\\text{\u57fa\u672c\u601d\u8def}$\n\n\u5176\u5b9e\u770b\u5230\u8fd9\u9898\u4e00\u822c\u4f1a\u60f3\u5230\u4e00\u4e2a\u5c0f\u5b66\u5965\u6570\u7ed3\u8bba\uff1a\n\n\u5bf9\u4e8e\u4efb\u610f\u6709 $n$ \u4e2a\u8282\u70b9\u7684\u7ebf\u6bb5\uff0c\u5176\u5750\u6807\u5206\u522b\u662f $x_1,x_2, \\cdots ,x_n$\uff0c\u4e14 $x_1 \\leq x_2 \\leq \\cdots \\leq x_n$\u3002\u5728\u7ebf\u6bb5\u4e0a\u4efb\u53d6\u4e00\u70b9 $k$\uff0c\u4f7f $S=\\displaystyle\\sum_{i=1}^{n}|x_i-x_k|$ \u53d6\u5230\u6700\u5c0f\u503c\u65f6\uff0c$ \\begin{cases}x_k=x_{\\frac{n+1}{2}},n \\equiv 1\\ (\\bmod 2)\\ ; \\\\x_k \\in [x_{\\frac{n}{2}},x_{\\frac{n}{2}+1}],n \\equiv 0\\ (\\bmod 2).\\end{cases}$\uff0c\u6b64\u65f6 $S_{min}=\\displaystyle\\sum_{i=1}^{\\lfloor\\frac{n}{2}\\rfloor}x_{n-i}-x_i$\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5c06\u5f00\u8bbe\u4ed3\u5e93\u770b\u6210\u5f00\u8bbe\u7a3b\u7530\uff0c\u90a3\u4e48\u6211\u4eec\u80fd\u53d1\u73b0\u9700\u8981\u94b1\u6570\u968f\u7740\u5f00\u8bbe\u7a3b\u7530\u6570\u7684\u589e\u52a0\u800c\u589e\u52a0\uff0c\u800c\u5728\u5f00\u8bbe\u7a3b\u7530\u6570\u4e00\u5b9a\u65f6\u4f7f\u8fd0\u9001\u94b1\u6570\u6700\u5c11\u7684\u65b9\u6cd5\u4e2d\u7a3b\u7530\u90fd\u662f\u8fde\u7eed\u7684\uff0c\u6240\u4ee5\u60f3\u5230\u5bf9\u5f00\u8bbe\u7a3b\u7530\u6570\u8fdb\u884c\u4e8c\u5206\uff0c\u6bcf\u6b21\u5224\u65ad\u5408\u6cd5\u60c5\u51b5\u65f6\u5219\u53d6\u8fde\u7eed\u7684\u5224\u65ad\u7a3b\u7530\u6570\u6c42\u51fa\u94b1\u6570\u3002\n\n\u4f46\u53d1\u73b0\u66b4\u529b\u6c42\u94b1\u6570\u590d\u6742\u5ea6 $\\Theta(n)$\uff0c\u6211\u4eec\u8003\u8651\u5bf9\u5176\u4f18\u5316\u3002\u89c2\u5bdf\u6c42\u5f97 $S_{min}$ \u7684\u516c\u5f0f\uff0c\u53d1\u73b0\u5bf9\u5176\u8fdb\u884c\u8f6c\u79fb\u65f6\u6539\u53d8\u7684\u5750\u6807\u4e0b\u6807\u662f\u4e00\u5b9a\u7684\uff0c\u4ee4 $aim$ \u4e3a\u5224\u65ad\u6570\u91cf\uff0c\u5f53\u524d\u4e0b\u6807\u4e3a $i$\uff0c\u5219 $ans=lastans+x_i-x_{i-\\lfloor \\frac{aim}{2}\\rfloor}+x_{i-aim}-x_{i-\\lfloor \\frac{aim+1}{2}\\rfloor}$\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u6c42\u51fa\u7b2c\u4e00\u6bb5\u6240\u9700\u94b1\u6570\u518d\u4e0d\u65ad\u8fdb\u884c\u8f6c\u79fb\u5373\u53ef\uff0c\u5224\u65ad\u662f\u5426\u5408\u6cd5\u5c31\u4e3a\u5224\u65ad $ans\\leq B$\u3002\n\n$\\Large\\mathscr{Part\\,\\,2\\;\\;}\\text{Code\\qquad}$\n\n```cpp\n#include <cstdio>\nconst int N=1e5+5;\nint r,l,ans,x[N];\nlong long b;\nint max(int x,int y){return (x>y?x:y);}\nbool ck(int aim){\n\tlong long y=0;\n\tfor(int i=1; i<=aim>>1; i++){ // \u5148\u6c42\u51fa\u7b2c\u4e00\u6bb5\u7b54\u6848\n\t\ty+=x[aim-i+1]-x[i];\n\t}\n\tif(y<=b) return true;\n\tfor(int i=aim+1; i<=r; i++){ // \u4e0d\u65ad\u8f6c\u79fb\n\t\ty+=x[i]-x[i-(aim>>1)]+x[i-aim]-x[i-(aim+1>>1)];\n\t\tif(y<=b) return true; // \u5224\u65ad\u5408\u6cd5\n\t}\n\treturn false;\n}\nint bs(int lf,int rt){ // \u4e8c\u5206\u5f00\u8bbe\u7a3b\u7530\u6570\n\tint md=(lf+rt)>>1,res=-1;\n\twhile(lf<=rt){\n\t\tif(ck(md)) res=md,lf=md+1;\n\t\telse rt=md-1;\n\t\tmd=(lf+rt)>>1;\n\t}\n\treturn res;\n}\nint main(){\n\tscanf(\"%d%d%lld\",&r,&l,&b);\n\tfor(int i=1; i<=r; i++) scanf(\"%d\",x+i);\n\tans=bs(1,r);\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n \\log_2 n)$\uff0c\u81ea\u7136 [$\\text\\color{green}{AC}$](https://www.luogu.com.cn/record/43099217)\uff01",
        "postTime": 1603612634,
        "uid": 238421,
        "name": "A_Pikachu",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5844 \u3010[IOI2011]ricehub\u3011"
    },
    {
        "content": "## \u9898\u76ee\u5927\u610f\n\u5728\u6570\u8f74\u4e0a\u6709 $R$ \u4e2a\u6574\u70b9\uff08\u53ef\u91cd\u53e0\uff09\u3002\u73b0\u5728\u6211\u4eec\u8981\u9009\u53d6\u5176\u4e2d\u7684\u4e00\u4e2a\u70b9\u4f5c\u4e3a\u4e2d\u5fc3\u70b9\uff0c\u5e76\u5728\u5176\u4f59\u70b9\u4e2d\u9009\u82e5\u5e72\u4e2a\u3002\u6ee1\u8db3\u4e2d\u5fc3\u70b9\u5230\u5176\u4f59\u70b9\u7684\u8ddd\u79bb\u4e4b\u548c\u5c0f\u4e8e\u7b49\u4e8e $B$\u3002\u4e14\u4f7f\u9009\u51fa\u7684\u70b9\u7684\u6570\u91cf\u5c3d\u91cf\u591a\u3002\u8f93\u51fa\u8fd9\u4e2a\u6700\u5927\u503c\u3002\n## \u4e8c\u5206\u7b54\u6848\n\u6709\u4e00\u4e2a\u7ed3\u8bba $1 \\sim len$ \u6700\u597d\u7684\u7c73\u4ed3\u9009\u5740\u80af\u5b9a\u662f $len \\div 2$\u3002\n\n\u5f53\u9009\u5740 $pos$ \u79fb\u5230 $poss=pos+1$ \u65f6\n $tot$ \u76f8\u5bf9\u4e8e\u539f\u6765\u6709\u5982\u4e0b\u53d8\u5316\uff0c\u5047\u8bbe $l \\sim i$ \u957f\u5ea6\u4e3a $len$\uff0c$i=len+1 \\sim n$\uff0c\u663e\u7136 $l=i-len+1$\u3002\n \n```tot-=a[poss-(len&1)]-a[l-1]```\n\n```tot+=a[i]-a[poss]```\n\n\u8fd9\u4e2a\u53d8\u5316\u662f\u901a\u8fc7\u5947\u5076\u5206\u7c7b\u8ba8\u8bba\u5f97\u5230\uff0c\u53ef\u4ee5\u753b\u4e00\u4e0b\u3002\u7136\u540e\u5c31\u53ef\u4ee5 $O(n)$ \u5224\u65ad\u662f\u5426\u6709 $\\le B$ \u7684\u65b9\u6848\u3002\n\n## \u4ee3\u7801\u5982\u4e0b\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\nconst int N = 1000005;\n\nint n,m,b,a[N],s[N];\n\nint check(int l,int r)\n{\n    int mid=(l+r)/2;\n    return s[r]-s[mid]-(r-mid)*a[mid]-s[mid]+s[l-1]+(mid-l+1)*a[mid];\n}\n\nsigned main()\n{\n    cin>>n>>m>>b;\n    for(int i=1;i<=n;i++) cin>>a[i], s[i]=s[i-1]+a[i];\n    int j=1,ans=0;\n    for(int i=1;i<=n;i++)\n    {\n        while(j<n && check(i,j+1)<=b) ++j;\n        if(check(i,j)<=b) ans=max(ans,j-i+1);\n    }\n    cout<<ans<<endl;\n    return 0;\n}\n\n```\n",
        "postTime": 1668679283,
        "uid": 754311,
        "name": "Hatake_Kakashi",
        "ccfLevel": 0,
        "title": "[IOI2011]ricehub"
    }
]
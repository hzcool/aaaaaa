[
    {
        "content": "\t\u4e00\u7bc7\u4f7f\u7528 \u83ab\u961f+\u5355\u70b9\u4fee\u6539\u7ebf\u6bb5\u6811 \u89e3\u51b3\u7684\u9898\u89e3\n    \n## Solution\uff1a\n\n\u56e0\u4e3a\u662f\u591a\u6b21\u533a\u95f4\u8be2\u95ee\uff0c\u8003\u8651\u4f7f\u7528\u83ab\u961f\u3002\n\n\u53c8\u56e0\u4e3a\u662f\u5339\u914d\uff0c\u53ea\u4e0e\u6743\u503c\u6709\u5173\uff0c\u4e0d\u59a8\u5148\u5c06 $A$ \u6392\u5e8f\u3002\n\n\u5bf9\u4e8e $B_i$\uff0c\u5b83\u6240\u80fd\u5339\u914d\u5230\u7684\u6570\u6784\u6210 $A$ \u7684\u4e00\u4e2a\u524d\u7f00\u3002\u53ea\u8981\u8fd9\u4e2a\u524d\u7f00\u4e2d\u8fd8\u6709\u4e00\u4e2a\u6570\u672a\u5339\u914d\uff0c\u5c31\u53ef\u5c06\u5b83\u4e0e $B_i$ \u5339\u914d\u3002\n\n\u8fd9\u6837\u5c31\u6709\u4e86\u4e00\u4e2a\u83ab\u961f\u589e\u5220\u65f6\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\u6700\u5927\u5339\u914d\u6570\u91cf\u7684\u601d\u8def\uff1a\n\n\u7ebf\u6bb5\u6811\u4ee5 $1\\sim N$ \u4e3a\u4e0b\u6807\uff0c\u533a\u95f4\u5185\u7ef4\u62a4\u4e09\u4e2a\u4fe1\u606f\uff1a$size$\u3001$sum$\u3001$ans$ \u5206\u522b\u8868\u793a \u533a\u95f4\u5927\u5c0f\u3001\u533a\u95f4\u5185\u6570\u7684\u6570\u91cf\uff0c\u533a\u95f4\u5185\u6700\u5927\u5339\u914d\u6570\u91cf\u3002\n\n\u5f53 $C$ \u4e2d\u65b0\u589e\u4e00\u4e2a\u6570 $B_i$ \u65f6\uff0c\u7528\u4e8c\u5206\u627e\u51fa\u5b83\u80fd\u5339\u914d\u5230\u7684\u6700\u5927 $A_i$ \u7684\u4f4d\u7f6e\uff0c\u5982\u679c\u5f53\u524d\u4f4d\u7f6e\u8fd8\u672a\u88ab\u5339\u914d\uff08\u5373 $ans=0$\uff09\uff0c\u5219\u5f53\u524d\u4f4d\u7f6e $sum$ \u4e0e $ans$ \u90fd $+1$\uff0c\u5426\u5219\u53ea\u6709 $sum+1$\u3002\u5220\u6570\u65f6\u7684\u64cd\u4f5c\u7c7b\u4f3c\uff0c\u5f53 $sum$ \u51cf\u81f3 $0$ \u65f6 $ans-1$\u3002\n\n\u5173\u4e8e\u533a\u95f4\u5408\u5e76\uff0c$sum$ \u76f4\u63a5\u76f8\u52a0\u5373\u53ef\uff0c\u800c\u5bf9\u4e8e $ans$\uff0c\u9996\u5148\u4e5f\u5c06\u5de6\u53f3\u533a\u95f4\u7684 $ans$ \u76f8\u52a0\uff0c\u7136\u9700\u8003\u8651\u53f3\u533a\u95f4\u7684 $B$ \u4e0e\u5de6\u533a\u95f4\u7684 $A$ \u5339\u914d\uff0c\u8d21\u732e\u4e3a $min(\\text{\u5de6\u533a\u95f4\u5269\u4f59 }A \\text{ \u7684\u4e2a\u6570},\\text{\u53f3\u533a\u95f4\u591a\u4f59 }B \\text{ \u7684\u4e2a\u6570})$\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a $B_i$\uff0c\u6211\u4eec\u90fd\u80fd\u4fdd\u8bc1\u5b83\u4e0e\u6240\u5bf9\u5e94\u7684 $A$ \u7684\u524d\u7f00\u4e2d\u7684\u6bcf\u4e2a\u6570\u5c1d\u8bd5\u4e86\u5339\u914d\uff0c\u4e14\u4f1a\u4f18\u5148\u4e0e\u6700\u9760\u8fd1\u9650\u5ea6\u7684\u6570\u5339\u914d\uff0c\u56e0\u6b64\u80fd\u4fdd\u8bc1\u5339\u914d\u6570\u6700\u5927\u3002\n\n\u81f3\u6b64\uff0c\u4fbf\u53ef\u7edf\u8ba1\u51fa\u6700\u5927\u5339\u914d\u6570\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(M\\sqrt{M}\\log n)$\u3002\n\n\n## Code:\n```cpp\n#include<bits/stdc++.h>\n#define inl inline\n#define L (p<<1)\n#define R (L|1)\n#define mid ((l+r)>>1)\nusing namespace std;\nconst int N=152505,M=52505;\nstruct node {int l,r,id; }as[M];\nstruct node1 {int si,su,an; }tr[N*4];\t// \u533a\u95f4\u5927\u5c0f\uff0c\u533a\u95f4\u5185\u6240\u6709\u6570\u7684\u6570\u91cf\uff0c\u533a\u95f4\u5185\u5339\u914d\u4e0a\u7684\u6570\u7684\u6570\u91cf \nint n,m,sqm,Z,Q,ans[M],a[N],b[M],bl[M];\ninl bool operator <(node a,node b)\n{\n\tif(bl[a.l]!=bl[b.l]) return a.l<b.l;\n\treturn (bl[a.l]&1)?a.r>b.r:a.r<b.r;\t\t// \u5947\u5076\u4f18\u5316 \n}\ninl int Read()\n{\n\tint s=0; char c;\n\twhile(!isdigit(c=getchar()));\n\tfor(;isdigit(c);c=getchar()) s=s*10+c-'0'; return s;\n}\ninl void Write(int x)\n{\n\tint cnt=0,s[10]; do s[++cnt]=x%10; while(x/=10);\n\twhile(cnt--) putchar(s[cnt+1]+'0');\n}\ninl void Pushup(int p)\n{\n\ttr[p].su=tr[L].su+tr[R].su;\n\ttr[p].an=tr[L].an+tr[R].an;\n\ttr[p].an+=min(max(tr[L].si-tr[L].an,0),tr[R].su-tr[R].an);\n\t\t// max(tr[L].si-tr[L].an,0) \u4e3a\u5de6\u533a\u95f4\u5269\u4f59\u4e2a\u6570\uff0ctr[R].su-tr[R].an \u4e3a\u53f3\u533a\u95f4\u591a\u4f59\u4e2a\u6570 \n}\ninl void Build(int p,int l,int r)\n{\n\ttr[p].si=r-l+1; if(l==r) return;\n\tBuild(L,l,mid); Build(R,mid+1,r);\n}\ninl void Modify(int p,int l,int r,int va,int fl)\n{\n\tif(l==r)\n\t{\n\t\tif(Z-va<a[l]) return;\t// \u65e0\u6cd5\u5339\u914d\uff0c\u6b64\u65f6 l=r=1\n\t\tif(tr[p].su==0) tr[p].an=1;\n\t\ttr[p].su+=fl;\n\t\tif(tr[p].su==0) tr[p].an=0;\n\t\treturn;\n\t}\n\tZ-va<a[mid+1]?Modify(L,l,mid,va,fl):Modify(R,mid+1,r,va,fl);\n\tPushup(p);\n}\nint main()\n{\n\tn=Read(); m=Read(); Z=Read(); sqm=sqrt(m);\n\tfor(int i=1;i<=n;++i) a[i]=Read();\n\tfor(int i=1;i<=m;++i) b[i]=Read(), bl[i]=i/sqm;\n\tsort(a+1,a+n+1); Build(1,1,n);\n\t\n\tQ=Read();\n\tfor(int i=1;i<=Q;++i) as[i]=(node){Read(),Read(),i};\n\tsort(as+1,as+Q+1);\n\tfor(int i=1,l=1,r=0;i<=Q;++i)\n\t{\n\t\twhile(l>as[i].l) Modify(1,1,n,b[--l],1);\n\t\twhile(r<as[i].r) Modify(1,1,n,b[++r],1);\n\t\twhile(l<as[i].l) Modify(1,1,n,b[l++],-1);\n\t\twhile(r>as[i].r) Modify(1,1,n,b[r--],-1);\n\t\tans[as[i].id]=tr[1].an;\n\t}\n\tfor(int i=1;i<=Q;++i) Write(ans[i]), putchar('\\n');\n\treturn 0;\n}\n```\n",
        "postTime": 1647269790,
        "uid": 224693,
        "name": "D_F_S",
        "ccfLevel": 7,
        "title": "P4477 [BJWC2018]\u57fa\u7840\u5339\u914d\u7b97\u6cd5\u7ec3\u4e60\u9898 \u9898\u89e3"
    },
    {
        "content": "## \u4e3b\u8981\u7b97\u6cd5\n\n\u56de\u6eda\u83ab\u961f+\u5e76\u67e5\u96c6\u6309\u79e9\u5408\u5e76\u3002\n\n## \u505a\u6cd5\n\n\u9996\u5148\u5bf9 $a$ \u6392\u5e8f\uff0c\u7136\u540e\u6c42\u51fa\u6570\u7ec4 $bb$ \uff0c $bb_{i}$ \u8868\u793a $b_{i}$ \u80fd\u5339\u914d\u7684\u6700\u5927\u7684 $a$ \u4e2d\u7684\u6570\u7684\u4e0b\u6807\u3002\n\n\u9898\u76ee\u8981\u6c42\u5339\u914d\u6570\u6700\u591a\uff0c\u6211\u4eec\u4e0d\u96be\u5f97\u51fa\u4e00\u4e2a\u57fa\u4e8e\u8d2a\u5fc3\u7684\u505a\u6cd5\uff1a\u5bf9\u4e8e $b$ \u4e2d\u7684\u6bcf\u4e2a\u6570\uff0c\u5728 $a$ \u4e2d\u6ca1\u6709\u88ab\u9009\u62e9\u7684\u6570\u91cc\u9762\u9009\u62e9\u4e00\u4e2a\u80fd\u591f\u5339\u914d\u7684\u5e76\u4e14\u4e0b\u6807\u6700\u5927\u7684\u6570\u8fdb\u884c\u5339\u914d\u3002\n\n\u5bf9\u4e8e\u5bfb\u627e\u5339\u914d\u7684\u8fc7\u7a0b\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5e76\u67e5\u96c6\u5b9e\u73b0\u3002\u5982\u679c $a_{i}$ \u88ab\u9009\u62e9\u8fc7\uff0c\u5c31\u5408\u5e76 $a_{i}$ \u4e0e $a_{i-1}$ \u6240\u5728\u7684\u96c6\u5408\u3002\u8fd9\u6837\u5bf9\u4e8e $b_{i}$ \uff0c\u5b83\u7684\u5339\u914d\u5c31\u662f $bb_{i}$ \u6240\u5728\u96c6\u5408\u4e2d\u7684\u6700\u5c0f\u6570\uff08\u5982\u679c\u65e0\u6cd5\u5339\u914d\u5219\u7ed3\u679c\u662f $0$ \uff09\u3002\n\n\u7136\u540e\u56e0\u4e3a\u8be2\u95ee\u6709\u591a\u7ec4\uff0c\u53ef\u4ee5\u5957\u4e0a\u4e00\u4e2a\u83ab\u961f\u3002\u56e0\u4e3a\u5e76\u67e5\u96c6\u65e0\u6cd5\u8fdb\u884c\u5220\u9664\u64cd\u4f5c\uff0c\u4f46\u53ef\u4ee5\u652f\u6301\u64a4\u9500\uff0c\u6240\u4ee5\u7528\u6309\u79e9\u5408\u5e76\u7684\u5e76\u67e5\u96c6\u548c\u56de\u6eda\u83ab\u961f\u3002\n\n\u590d\u6742\u5ea6 $O(m \\sqrt{m} \\log m)$ \uff0c\u56e0\u4e3a\u5e76\u67e5\u96c6\u5e38\u6570\u5c0f\uff0c\u5b9e\u9645\u4e0a\u8dd1\u5f97\u98de\u5feb\u3002\n\nhttps://www.luogu.com.cn/record/67866628 \uff08\u5438\u4e86\u6c27\u540e\u6700\u6162\u7684\u70b9\u4e5f\u5c31 $200ms$ \uff09\n\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=160000,M=60000;\nint n,m,z,q,sqn,bl[N];\nint a[N],b[N],bb[N],ans[M];\nstruct Ques{\n\tint l,r,ind;\n}qs[M];\nbool cmp(const Ques&x,const Ques&y){\n\tif(bl[x.l]^bl[y.l])return x.l<y.l;\n\treturn x.r<y.r;\n}\nint fa[N],siz[N],LL[N],oldLL[N];\nint stk[N],top;\nint get(int x){\n\treturn fa[x]>-1?get(fa[x]):x;\n}\nvoid merge(int x,int y){\n\tint r1=get(x),r2=get(y);\n\tif(r1!=r2){\n\t\tif(siz[r1]>siz[r2])swap(r1,r2);\n\t\tfa[r1]=r2,siz[r2]+=siz[r1];\n\t\toldLL[r1]=LL[r2];LL[r2]=min(LL[r2],LL[r1]);\n\t\tstk[++top]=r1;\n\t}\n}\nvoid go_back(int x){\n\twhile(top>x){\n\t\tsiz[fa[stk[top]]]-=siz[stk[top]];\n\t\tLL[fa[stk[top]]]=oldLL[stk[top]];\n\t\tfa[stk[top--]]=-1;\n\t}\n}\nint solve(int l,int r){\n\tint res=0;\n\tfor(int i=l;i<=r;i++)\n\t\tif(bb[i]){\n\t\t\tint lst=get(bb[i]);\n\t\t\tif(LL[lst]){\n\t\t\t\tmerge(lst,LL[lst]-1);\n\t\t\t\tres++;\n\t\t\t}\n\t\t}\n\treturn res;\n}\ninline int read()\n{\n\tint f=1,x=0;\n\tchar c=getchar();\n\twhile(c<'0'||c>'9')c=='-'?f=-f,c=getchar():c=getchar();\n\twhile(c>='0'&&c<='9')x=x*10+(c^48),c=getchar();\n\treturn x*f;\n}\nint main(){\n\tn=read(),m=read(),z=read();sqn=sqrt(m);\n\tfor(int i=1;i<=n;i++)a[i]=read();\n\tfor(int i=1;i<=m;i++)b[i]=read();\n\tsort(a+1,a+1+n);\n\tfor(int i=1;i<=m;i++){\n\t\tbb[i]=upper_bound(a+1,a+1+n,z-b[i])-a-1;\n\t\tbl[i]=(i-1)/sqn+1;\n\t}\n\tq=read();\n\tfor(int i=1;i<=q;i++)qs[i].l=read(),qs[i].r=read(),qs[i].ind=i;\n\tsort(qs+1,qs+1+q,cmp);\n\tfor(int i=0;i<=n;i++)siz[i]=1,fa[i]=-1,LL[i]=i;\n\tfor(int i=1;i<=q;){\n\t\twhile(i<=q&&bl[qs[i].l]==bl[qs[i].r]){\n\t\t\tans[qs[i].ind]=solve(qs[i].l,qs[i].r);\n\t\t\tgo_back(0);\n\t\t\t++i;\n\t\t}\n\t\tif(i>q)break;\n\t\tint num=bl[qs[i].l],l=sqn*num+1,r=l-1,res=0;\n\t\twhile(bl[qs[i].l]==num){\n\t\t\tres+=solve(r+1,qs[i].r);r=qs[i].r;\n\t\t\tint nowtop=top;\n\t\t\tint tmp=solve(qs[i].l,l-1);go_back(nowtop);\n\t\t\tans[qs[i].ind]=res+tmp;\n\t\t\t++i;\n\t\t}\n\t\tgo_back(0);\n\t}\n\tfor(int i=1;i<=q;i++)printf(\"%d\\n\",ans[i]);\n}\n```\n",
        "postTime": 1643086846,
        "uid": 292064,
        "name": "xkai",
        "ccfLevel": 7,
        "title": "P4477 [BJWC2018]\u57fa\u7840\u5339\u914d\u7b97\u6cd5\u7ec3\u4e60\u9898 \u9898\u89e3"
    },
    {
        "content": "\u8c14\u8c14\u6211\uff0c\u5199\u4e86\u597d\u4e45\uff0c\u8fd8\u91cd\u6784\u4e86\u4e00\u6b21\uff0c\u4e3b\u8981\u662f\u672c\u4eba\u5bf9\u4e8e\u5e38\u6570\u7684\u4f30\u7b97\u51fa\u4e86\u4e25\u91cd\u7684\u95ee\u9898\u3002\n\n\u770b\u89c1\u6700\u5927\u6d41\uff0c\u80af\u5b9a\u8981\u5148\u641e\u4e2a\u6027\u8d28\u51fa\u6765\u624d\u80fd\u505a\uff08\u5982\u679c\u60a8\u66b4\u529b\u89c1\u56fe\u8dd1\u7f51\u7edc\u6d41\u8fd8\u80fdAC\uff0c\u60a8\u5c31\u5dee\u4e0d\u591a\u4e16\u754c\u95fb\u540d\u4e86qwq\uff09\n\n\u6211\u770b\u5b8c\u989830\u79d2\u5927\u6982\u770b\u51fa\u6765\u8fd9\u6837\u4e00\u4e2a\u4e1c\u897f\uff08\u4ee5\u4e0b\u9ed8\u8ba4\u4eceB\u5f80A\u8fde\u8fb9\uff09\uff1a\u5927\u6743\u503c\u7684\u70b9\u80fd\u8fde\u7684\u70b9\u5c0f\u6743\u503c\u4e00\u5b9a\u4e5f\u8fde\u4e86\uff0c\u5c0f\u6743\u503c\u7684\u70b9\u80fd\u8fde\u7684\u70b9\u5927\u6743\u503c\u4e0d\u4e00\u5b9a\u8fde\uff0c\u6240\u4ee5**\u8ba9\u5c0f\u6743\u503c\u53bb\u8fde\u6743\u503c\u5c3d\u91cf\u5927\u7684\u70b9**\n\n\u8fd9\u4e2a\u8d2a\u5fc3\u663e\u7136\u6ca1\u6bdb\u75c5\uff0c\u800c\u4e14\u633a\u597d\u7528\u7684qwq\n\n### \u4e00\u3001\u590d\u6742\u5ea6\u6b63\u786e\u5e76\u4e14\u5f88\u597d\u60f3\u7684\u7b97\u6cd5\n\nPS\uff1a\u5982\u679c\u8981\u770b\u80fdAC\u7684\u65b9\u6cd5\uff0c\u90a3\u4e48\u8bf7\u770b\u201c\u4e8c\u201d\n\n\u663e\u7136\uff0c\u627e\u5230\u80fd\u8fde\u5e76\u4e14\u6700\u5927\u7684\u70b9\u5c31\u662f\u524d\u9a71\uff0c\u641e\u4e2a\u5e73\u8861\u6811\u3002\n\n\u53e6\u5916\uff0c\u5982\u679c\u533a\u95f4\u7f29\u77ed\uff0c\u653e\u51fa\u6765\u7684\u90a3\u4e9b\u6743\u503c\u8c8c\u4f3c\u4e0d\u662f\u5f88\u597d\u5904\u7406\uff0c\u4f46\u662f\u4f38\u957f\u7684\u65f6\u5019\u53ef\u4ee5\u627e\u5230\u6700\u5927\u7684\u6ca1\u7528\u8fc7\u7684\uff0c\u66f4\u65b0\u7b54\u6848\uff0c\u6240\u4ee5\u56de\u6eda\u4e00\u4e0b\u3002\n\n\u5177\u4f53\u5b9e\u73b0\uff1a\n\n+ \u6bcf $\\sqrt{m}$ \u6b21\u628a $a$ \u63d2\u5165\u4e00\u9897\u521d\u59cb\u7a7a\u7684\u5e73\u8861\u6811\n+ \u533a\u95f4\u4f38\u957f\u7684\u65f6\u5019\u627e\u5230\u5e73\u8861\u6811\u91cc\u6700\u5927\u7684\u6ca1\u7528\u8fc7\u7684\uff0c\u5982\u679c\u627e\u5230\uff0c\u90a3\u4e48\u4ece\u5e73\u8861\u6811\u91cc\u5220\u9664\uff0c$++ans$\u3002\n+ \u6269\u5c55\u5de6\u7aef\u70b9\u7684\u65f6\u5019\u641e\u4e2a\u6570\u7ec4\uff08\u6216 $vector$\uff09 \u8bb0\u5f55\u5220\u53bb\u4e86\u54ea\u4e9b\u8282\u70b9\uff0c\u56de\u6eda\u65f6\u63d2\u56de\u53bb\n\n\u590d\u6742\u5ea6\uff1a\n\n\u63d2\u5165\u8282\u70b9 $\\sqrt{m}\\cdot n \\log n$ \uff0c\u5de6\u53f3\u7aef\u70b9\u6269\u5c55\u5e76\u627e\u524d\u9a71\u66f4\u65b0\u7b54\u6848 $\\sqrt{m} \\cdot n\\log n$ \uff0c\u5de6\u7aef\u70b9\u56de\u6eda\u6700\u591a $\\sqrt{m}\\cdot \\log n$ \uff0c\u603b\u590d\u6742\u5ea6 $\\sqrt{m}\\cdot n\\log n$\n\n~~\u4e8e\u662f\u5c31\u89e3\u51b3\u4e86\u8fd9\u9898~~\n\n\u4ea4\u4e0a\u53bb\u4f1a\u53d1\u73b0 $TLE50pts$ \u3002\u5199\u5047\u4e86\uff1f\uff1f\uff1f\u5e76\u6ca1\u6709\u3002\u672c\u5730\u6781\u9650\u968f\u673a\u6570\u636e\u8dd1\u4e86 $40s$ \uff0c\u4e0d\u65ad\u5220\u53bb\u51fd\u6570\u53d1\u73b0\u4e86\u74f6\u9888\uff1a **$\\sqrt{m}\\cdot n$ \u6b21\u63d2\u5165\u82b1\u4e86 $20s$**\n\n\u5982\u679c\u60a8\u8fd8\u662f\u4e0d\u77e5\u9053\u4e3a\u5565TLE\uff0c\u6211\u5c31\u518d\u8bf4\u7684\u76f4\u767d\u4e00\u70b9\uff1a\u5e73\u8861\u6811\u5e38\u6570\u4e0a\u5929\u4e86\uff01\uff01\uff01\n\n\u4ee3\u7801\u5c31\u4e0d\u653e\u4e86\uff0c\u8981\u7684\u79c1\u4fe1\uff08\u6216\u8005\u60a8AC\u4e86\u770b\u6211\u7684\u63d0\u4ea4\u8bb0\u5f55qwq\uff0c50\u5206\u7684\u90fd\u662f\uff09\n\n\u63a5\u7740\u6211\u91cd\u6784\u4e86/dk\n\n### \u4e8c\u3001\u80fdAC\u7684\u65b9\u6cd5\n\n\u8fd8\u662f\u539f\u6765\u90a3\u4e2a\u7ed3\u8bba\uff1a**\u8ba9\u5c0f\u6743\u503c\u53bb\u8fde\u6743\u503c\u5c3d\u91cf\u5927\u7684\u70b9**\u3002\n\n\u6362\u4e00\u4e2a\u601d\u8def\uff0c\u5982\u679c\u6392\u4e86\u5e8f\uff0c\u90a3\u4e48\u6bcf\u4e2a\u70b9\u80fd\u8fde\u7684\u70b9\u662f\u5de6\u7aef\u70b9\u4e3a $1$ \uff0c\u53f3\u7aef\u70b9\u53ef\u4ee5\u4e8c\u5206\u9884\u5904\u7406\u7684\u4e00\u6bb5\u533a\u95f4\u3002\n\n\u4e8e\u662f\u8003\u8651\u641e\u4e00\u9897\u7ebf\u6bb5\u6811\u7ef4\u62a4\u533a\u95f4\u52a0\u533a\u95f4\u6700\u5c0f\u503c\u3002\u6bcf\u6b21\u52a0\u5165\u4e00\u4e2a\u70b9\u5c31\u533a\u95f4\u52a0\u4e00\uff0c\u5220\u9664\u5219\u533a\u95f4\u51cf\u4e00\uff0c\u6700\u540e\u67e5\u8be2\u5168\u5c40\u6700\u5c0f\u503c\u5373\u53ef\u3002\n\n\u6ce8\u610f\u6bcf\u4e2a\u8282\u70b9\u7684\u521d\u59cb\u503c\u662f\u533a\u95f4\u5de6\u7aef\u70b9\uff0c\u56e0\u4e3a\u5230\u8fd9\u4e2a\u53f6\u5b50\u8282\u70b9\u6700\u591a\u53ea\u80fd\u8fde\u8fd9\u4e2a\u70b9\u4e0b\u6807\u4e2a\u70b9\uff0c\u7136\u540e\u975e\u53f6\u5b50\u8282\u70b9\u53d6min\uff0c\u6700\u7ec8\u5c31\u662f\u5de6\u7aef\u70b9\u3002\n\n```cpp\n#pragma GCC optimize(3)\n#pragma GCC target(\"avx,sse2,sse3,sse4,mmx\")\n#pragma GCC optimize(\"Ofast\")\n#pragma GCC optimize(\"inline\")\n#pragma GCC optimize(\"-fgcse\")\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\n#define rint register int\n#define getchar() (p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\nchar buf[1<<21],*p1=buf,*p2=buf;\ninline int rd() {\n\tint x=0,f=1;char ch=getchar();\n\twhile(!isdigit(ch)) {if(ch=='-')f=-1;ch=getchar();}\n\twhile(isdigit(ch))x=x*10+(ch^48),ch=getchar();\n\treturn x*f;\n}\nconst int N=160000;\nconst int M=60000;\nint n,m,z,q;\nint size,bel[M];\nint a[N],b[M],c[M],ans[M];\nint val[M<<2],tag[M<<2];\nstruct Q {\n\tint l,r,id;\n}que[M];\nbool cmp(const Q &a,const Q &b) {\n\treturn bel[a.l]!=bel[b.l]?bel[a.l]<bel[b.l]:bel[a.l]&1?bel[a.r]<bel[b.r]:bel[a.r]>bel[b.r];\n}\nint min(const int &a,const int &b) {return a<b?a:b;}\nint max(const int &a,const int &b) {return a>b?a:b;}\n#define lc (p<<1)\n#define rc (p<<1|1) \nvoid build(int l,int r,int p) {\n\tval[p]=l;\n\tif(l==r) return;\n\tint mid=(l+r)>>1;\n\tbuild(l,mid,lc),build(mid+1,r,rc);\n}\nvoid pushdown(int p,int l,int r) {\n\tif(!tag[p])return;\n\ttag[lc]+=tag[p];\n\tval[lc]+=tag[p];\n\ttag[rc]+=tag[p];\n\tval[rc]+=tag[p];\n\ttag[p]=0;\n}\nvoid update(int ql,int qr,int l,int r,int p,int k) {\n\tif(ql<=l&&r<=qr) {\n\t\ttag[p]+=k,val[p]+=k;\n\t\treturn;\n\t}\n\tpushdown(p,l,r);\n\tint mid=(l+r)>>1;\n\tif(mid>=ql)update(ql,qr,l,mid,lc,k);\n\tif(mid<qr)update(ql,qr,mid+1,r,rc,k);\n\tval[p]=min(val[lc],val[rc]);\n}\nvoid add(int x) {if(c[x])update(1,c[x],1,m,1,1);}\nvoid pop(int x) {if(c[x])update(1,c[x],1,m,1,-1);}\nsigned main() {\n\tn=rd(),m=rd(),z=rd(),size=n/sqrt(m*3/2);\n\tfor(rint i=1;i<=n;++i)a[i]=rd();sort(a+1,a+n+1);\n\tfor(rint i=1;i<=m;++i)b[i]=rd();\n\tfor(rint i=1;i<=m;++i)c[i]=upper_bound(a+1,a+n+1,z-b[i])-a-1;\n\tfor(rint i=1;i<=m;++i)bel[i]=(i-1)/size+1;\n\tq=rd();build(1,m,1);\n\tfor(rint i=1;i<=q;++i)que[i].l=rd(),que[i].r=rd(),que[i].id=i;\n\tsort(que+1,que+q+1,cmp);\n\tfor(rint i=1,l=1,r=0;i<=q;++i) {\n\t\twhile(l<que[i].l)pop(l++);\n\t\twhile(l>que[i].l)add(--l);\n\t\twhile(r<que[i].r)add(++r);\n\t\twhile(r>que[i].r)pop(r--);\n\t\tans[que[i].id]=val[1]-1;\n\t}\n\tfor(rint i=1;i<=q;++i)printf(\"%d\\n\",ans[i]);\n\treturn 0;\n}\n```\n",
        "postTime": 1589447539,
        "uid": 123384,
        "name": "tommy0221",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4477 \u3010[BJWC2018]\u57fa\u7840\u5339\u914d\u7b97\u6cd5\u7ec3\u4e60\u9898\u3011"
    },
    {
        "content": "~~\u9898\u76ee\u610f\u601d\u6bd4\u8f83\u96be\u63cf\u8ff0\uff0c\u4f46\u662f\u6613\u61c2\u2026~~\n\n\u6211\u4eec\u8003\u8651\u5230\u8fd9\u662f\u4e00\u4e2a\u5339\u914d\u95ee\u9898\uff0c\u8f6c\u6362\u4e00\u4e0b\u3002\n\n\u7531\u4e8e\u9898\u76ee\u8bf4\u4e86\u662f $a_i + c_j \\leq z$ \uff0c $i$ \u548c $j$ \u6709\u4e00\u6761\u8fb9\uff0c\u90a3\u4e48\u53d1\u73b0 $a_i$ \u4e0d\u53d8\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7ed9 $a_i$ \u6392\u5e8f\uff0c\u7136\u540e\u56e0\u4e3a\u6570\u503c\u662f\u6709\u5355\u8c03\u6027\u7684\uff0c\u5982\u679c $a_i + c_j \\leq z$ \uff0c\u90a3\u4e48 $a_k(1 \\leq k\\leq i)+ c_j \\leq z$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u60f3\u4e00\u4e2a\u8fd9\u4e2a\u95ee\u9898\u7684\u8f6c\u5316: \u7ed9\u4f60 $n$ \u4e2a\u4f4d\u7f6e $m$ \u4e2a\u7269\u54c1\uff0c\u6bcf\u4e2a\u4f4d\u7f6e\u4ec5\u4ec5\u80fd\u653e\u4e00\u4e2a\u7269\u54c1\uff0c\u7b2c $i$ \u4e2a\u7269\u54c1\u6709\u4e00\u4e2a\u9650\u5236\uff0c\u53ea\u80fd\u653e\u5230 $[1,p_i]$ \u91cc\u9762\uff0c\u6c42\u6700\u591a\u80fd\u653e\u591a\u5c11\u4e2a\u7269\u54c1\u3002\n\n\u5bb9\u6613\u8bc1\u660e\uff0c\u5982\u679c\u7528 **\u4e0d\u57fa\u4e8e\u6392\u5e8f** \u7684\u505a\u6cd5\u505a\u51fa\u8fd9\u4e2a\u8f6c\u5316\u7248\u95ee\u9898\uff0c\u5c31\u53ef\u4ee5\u5e26\u4e0a\u83ab\u961f\u505a\u51fa\u8fd9\u4e2a\u539f\u95ee\u9898\u3002\n\n\n\u6211\u4eec\u60f3\uff0c\u5047\u8bbe\u4f60\u80fd\u653e $k$ \u4e2a\u7269\u54c1\uff0c\u91c7\u7528\u6700\u4f18\u7b56\u7565\u3002\n\n\u90a3\u4e48\u4f60 $p_i$ \u4e00\u5b9a\u662f\u9009\u524d $k$ \u5927\u7684\uff0c\u4f9d\u6b21\u653e\u5230 $1\u2026k$\u3002\n\n\u7b2c $k$ \u5927\u7684\u653e\u5728\u4f4d\u7f6e $1$\uff0c\u90a3\u4e48\u663e\u7136 $p_k \\geq 1$\n\n\u7b2c $k-1$ \u5927\u7684\u653e\u5728\u4f4d\u7f6e $2$\uff0c\u90a3\u4e48 $p_{k-1}\\geq 2$\n\n\u2026\u2026\n\n\u7b2c $k + x - 1$ \u5927\u7684\u7269\u54c1\u653e\u5728\u4f4d\u7f6e $x$ \uff0c\u90a3\u4e48 $p_{k+x-1}\\geq x$\n\n\u4e5f\u5c31\u662f\u8bf4 $p_x + x - 1 \\geq k$\n\n\u800c $x$ \u6307\u7684\u662f\u533a\u95f4\u7b2c $x$ \u5927\uff0c\u5c31\u662f\u6709\u591a\u5c11\u4e2a\u6570\u6bd4\u4ed6\u8981\u5927\uff0c\u800c\u4f60\u53ef\u4ee5\u901a\u8fc7\u7ebf\u6bb5\u6811\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $p_i$ \uff0c\u533a\u95f4\u52a0 $[1,p_i]$\n\n\u7531\u4e8e $k$ \u8981\u6ee1\u8db3\u6240\u6709\u6761\u4ef6\uff0c\u6240\u4ee5\u8981\u53d6\u6700\u5c0f\u503c\u3002\n\n[code](https://www.cnblogs.com/Isaunoya/p/12459233.html)",
        "postTime": 1583850001,
        "uid": 96580,
        "name": "SXNhdW5veWE",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4477 \u3010[BJWC2018]\u57fa\u7840\u5339\u914d\u7b97\u6cd5\u7ec3\u4e60\u9898\u3011"
    },
    {
        "content": "\u849f\u84bb\u7684\u4e3b\u5e2d\u6811+\u56de\u6eda\u83ab\u961f\u8fa3\u9e21\u505a\u6cd5\n\n\u9996\u5148\uff0c\u628aA\u6570\u7ec4\u6392\u5e8f\uff0c\u8fd9\u6ca1\u4ec0\u4e48\u7591\u95ee\u3002\n\n\u8d2a\u5fc3\u7684\u60f3\uff0c$C_i$\u80fd\u5339\u914dA\u6570\u7ec4\u7684\u533a\u95f4\u662f$[1,x]$\uff0c\u5176\u4e2d$x=max\\{k|a_k+c_i<=Z\\}$\uff0c\u90a3\u4e48\u6211\u4eec\u80af\u5b9a\u8981\u5339\u914dA\u4e2d\u6ca1\u7528\u8fc7\u7684\u7f16\u53f7\u6700\u5927\u7684\u5143\u7d20\u3002\n\n\u5982\u679c\u53ea\u8003\u8651\u533a\u95f4\u4f38\u957f\uff0c\u90a3\u4e48\u53ef\u4ee5\u8003\u8651\u7ed9A\u6570\u7ec4\u5efa\u4e2a\u7ebf\u6bb5\u6811\uff0c\u5c31\u53ef\u4ee5\u65b9\u4fbf\u7684\u627e\u5230$[1,x]$\u4e2d\u6ca1\u7528\u8fc7\u7684\u7f16\u53f7\u6700\u5927\u7684\u5143\u7d20\u3002\u56e0\u6b64\u8003\u8651\u56de\u6eda\u83ab\u961f\u3002\u56de\u6eda\u83ab\u961f\u9700\u8981\u5feb\u901f\u8fd4\u56de\u539f\u6765\u72b6\u6001\uff0c\u90a3\u4e48\u7528\u4e3b\u5e2d\u6811\u4ee3\u66ff\u7ebf\u6bb5\u6811\u3002",
        "postTime": 1586445612,
        "uid": 31381,
        "name": "C3H5ClO",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4477 \u3010[BJWC2018]\u57fa\u7840\u5339\u914d\u7b97\u6cd5\u7ec3\u4e60\u9898\u3011"
    }
]
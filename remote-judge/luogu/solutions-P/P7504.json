[
    {
        "content": "\u524d\u7f6e\u829d\u58eb\uff1a[\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14](https://oi-wiki.org/math/mobius/)\u3001[\u675c\u6559\u7b5b](https://oi-wiki.org/math/number-theory/du/)\n\n\u672c\u9898\u89e3\u7701\u7565\u90e8\u5206\u5206\u505a\u6cd5\u53ca\u5176\u4ee3\u7801\u3002\n\n\u8bbe $solve(n, m) = \\displaystyle\\sum_{i = 1}^n [\\gcd(i, m) = 1] \\sum_{j = 1}^i [\\gcd(i, j) = 1] j$\uff0c\u5219\u539f\u5f0f $= solve(n, k1) solve(n, k2)$\u3002\n\n$solve(n, m) = \\displaystyle\\sum_{i = 1}^n [\\gcd(i, m) = 1] \\sum_{j = 1}^i j \\sum_{d \\mid \\gcd(i, j)} \\mu(d)$\n\n$ = \\displaystyle\\sum_{i = 1}^n [\\gcd(i, m) = 1] \\sum_{d \\mid i} \\mu(d) \\sum_{d \\mid j}^i j$\n\n\u8bbe $S_1(n) = \\displaystyle\\sum_{i = 1}^n i$\uff0c\u5219\uff1a\n\n$solve(n, m) = \\displaystyle\\sum_{i = 1}^n [\\gcd(i, m) = 1] \\sum_{d \\mid i} \\mu(d) d S_1(\\frac{i}{d})$\n\n$ = \\frac{\\displaystyle\\sum_{i = 1}^n [\\gcd(i, m) = 1] i \\sum_{d \\mid i} \\mu(d) (\\frac{i}{d} + 1)}{2}$\n\n$ = \\frac{\\displaystyle\\sum_{i = 1}^n [\\gcd(i, m) = 1] i (\\varphi(i) + \\epsilon(i))}{2}$\n\n$ = \\frac{\\displaystyle\\sum_{i = 1}^n [\\gcd(i, m) = 1] i \\varphi(i)  + 1}{2}$\n\n\u5230\u6b64\u4e3a\u6b62\uff0c\u95ee\u9898\u8f6c\u53d8\u4e3a\u4e86\u5feb\u901f\u6c42\u51fa $f(n) = [\\gcd(n, m) = 1] n \\varphi(n)$ \u7684\u524d\u7f00\u548c\u3002\n\n\u60f3\u5230 $id_2 = id * (id \\cdot \\varphi)$ \u4e14 $\\epsilon(\\gcd)$ \u4e3a\u5b8c\u5168\u79ef\u6027\u51fd\u6570\uff0c\u53d1\u73b0 $\\epsilon(\\gcd) \\cdot id_2 = (\\epsilon(\\gcd) \\cdot id) * (\\epsilon(\\gcd) \\cdot id \\cdot \\varphi)$\uff0c\u8003\u8651\u675c\u6559\u7b5b\u3002\n\n\u663e\u7136 $\\displaystyle\\sum_{i = 1}^n [\\gcd(i, m) = 1] i = \\displaystyle\\sum_{d \\mid m} \\mu(d) d S_1(\\lfloor \\frac{n}{d} \\rfloor)$\uff0c$\\epsilon(\\gcd) \\cdot id_2$ \u7684\u524d\u7f00\u548c\u540c\u7406\u3002\u81f3\u6b64\u53ef\u4ee5\u675c\u6559\u7b5b\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\sqrt{n} (\\tau(k_1) + \\tau(k_2)) + n^{\\frac{2}{3}})$\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <iostream>\n#include <map>\n#include <cmath>\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst int N = 1587401 + 7, M = 1536 + 7, mod = 998244353, inv2 = 499122177, inv6 = 166374059;\nint limit;\nint prime[N], phi[N], divisor[M], mu_list[M];\nll f[N], g[N], h[N], f_sum[N], g_sum[N], h_sum[N];\nbool p[N];\nmap<int, ll> mp1, mp2, mp3;\n\ninline void init1(){\n\tint cnt = 0;\n\tp[0] = p[1] = true;\n\tphi[1] = 1;\n\tfor (register int i = 2; i <= limit; i++){\n\t\tif (!p[i]){\n\t\t\tprime[++cnt] = i;\n\t\t\tphi[i] = i - 1;\n\t\t}\n\t\tfor (register int j = 1; j <= cnt && i * prime[j] <= limit; j++){\n\t\t\tint t = i * prime[j];\n\t\t\tp[t] = true;\n\t\t\tif (i % prime[j] == 0){\n\t\t\t\tphi[t] = phi[i] * prime[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tphi[t] = phi[i] * (prime[j] - 1);\n\t\t}\n\t}\n}\n\ninline int mu(int n){\n\tint ans = 1;\n\tfor (register int i = 2; i * i <= n; i++){\n\t\tif (n % i == 0){\n\t\t\tn /= i;\n\t\t\tif (n % i == 0) return 0;\n\t\t\tans = -ans;\n\t\t}\n\t}\n\tif (n > 1) ans = -ans;\n\treturn ans;\n}\n\ninline int init2(int n){\n\tint prime_cnt = 0, divisor_cnt = 0, t = sqrt(n);\n\tp[0] = p[1] = true;\n\tf[1] = 1;\n\tg[1] = 1;\n\th[1] = 1;\n\tfor (register int i = 2; i <= limit; i++){\n\t\tif (!p[i]){\n\t\t\tprime[++prime_cnt] = i;\n\t\t\tf[i] = n % i == 0 ? 0 : (ll)i * phi[i] % mod;\n\t\t\tg[i] = n % i == 0 ? 0 : (ll)i * i % mod;\n\t\t\th[i] = n % i == 0 ? 0 : i;\n\t\t}\n\t\tfor (register int j = 1; j <= prime_cnt && i * prime[j] <= limit; j++){\n\t\t\tint t = i * prime[j];\n\t\t\tp[t] = true;\n\t\t\tf[t] = f[i] != 0 && n % prime[j] != 0 ? (ll)t * phi[t] % mod : 0;\n\t\t\tg[t] = g[i] * g[prime[j]] % mod;\n\t\t\th[t] = h[i] * h[prime[j]] % mod;\n\t\t\tif (i % prime[j] == 0) break;\n\t\t}\n\t}\n\tfor (register int i = 1; i < N; i++){\n\t\tf_sum[i] = (f_sum[i - 1] + f[i]) % mod;\n\t\tg_sum[i] = (g_sum[i - 1] + g[i]) % mod;\n\t\th_sum[i] = (h_sum[i - 1] + h[i]) % mod;\n\t}\n\tfor (register int i = 1; i <= t; i++){\n\t\tif (n % i == 0){\n\t\t\tdivisor_cnt++;\n\t\t\tdivisor[divisor_cnt] = i;\n\t\t\tmu_list[divisor_cnt] = mu(i);\n\t\t\tif (i * i != n){\n\t\t\t\tint tn = n / i;\n\t\t\t\tdivisor_cnt++;\n\t\t\t\tdivisor[divisor_cnt] = tn;\n\t\t\t\tmu_list[divisor_cnt] = mu(tn);\n\t\t\t}\n\t\t}\n\t}\n\treturn divisor_cnt;\n}\n\ninline ll sum2(int n){\n\treturn (ll)n * (n + 1) % mod * ((ll)n * 2 % mod + 1) % mod * inv6 % mod;\n}\n\ninline ll get_g_sum(int n, int cnt){\n\tif (n <= limit) return g_sum[n];\n\tif (mp2.count(n)) return mp2[n];\n\tll ans = 0;\n\tfor (register int i = 1; i <= cnt; i++){\n\t\tans = ((ans + (ll)mu_list[i] * divisor[i] % mod * divisor[i] % mod * sum2(n / divisor[i]) % mod) % mod + mod) % mod;\n\t}\n\treturn mp2[n] = ans;\n}\n\ninline ll sum1(int n){\n\treturn (ll)n * (n + 1) / 2 % mod;\n}\n\ninline ll get_h_sum(int n, int cnt){\n\tif (n <= limit) return h_sum[n];\n\tif (mp3.count(n)) return mp3[n];\n\tll ans = 0;\n\tfor (register int i = 1; i <= cnt; i++){\n\t\tans = ((ans + mu_list[i] * divisor[i] % mod * sum1(n / divisor[i]) % mod) % mod + mod) % mod;\n\t}\n\treturn mp3[n] = ans;\n}\n\ninline ll get_f_sum(int n, int cnt){\n\tif (n <= limit) return f_sum[n];\n\tif (mp1.count(n)) return mp1[n];\n\tll ans = get_g_sum(n, cnt);\n\tfor (register int i = 2, j; i <= n; i = j + 1){\n\t\tint tn = n / i;\n\t\tj = n / tn;\n\t\tans = ((ans - get_f_sum(tn, cnt) * (get_h_sum(j, cnt) - get_h_sum(i - 1, cnt)) % mod) % mod + mod) % mod;\n\t}\n\treturn mp1[n] = ans;\n}\n\ninline ll solve(int n, int m){\n\tint cnt = init2(m);\n\tmp1.clear();\n\tmp2.clear();\n\tmp3.clear();\n\treturn (get_f_sum(n, cnt) + 1) * inv2 % mod;\n}\n\nint main(){\n\tint n, k1, k2;\n\tcin >> n >> k1 >> k2;\n\tlimit = pow(n, 2.0 / 3.0);\n\tinit1();\n\tcout << solve(n, k1) * solve(n, k2) % mod;\n\treturn 0;\n}\n```",
        "postTime": 1631704803,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P7504 \u3010\u300cHMOI R1\u300d\u53ef\u7231\u7684\u5fb7\u4e3d\u838e\u3011"
    },
    {
        "content": "#### \u6ce8\u610f\uff01\u6b64\u9898\u89e3\u9700\u8981\u6709\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u57fa\u7840\n\n\u8bbe $f(n)=\\sum\\limits_{i=1}^ni[i\\perp n]$\uff0c$g(n,k)=\\sum\\limits_{i=1}^n[k\\perp i]f(i)$\n\n\u975e\u5e38\u5bb9\u6613\u53d1\u73b0\u7b54\u6848\u4e3a $g(n,k1)g(n,k2)$\n\n\u4e8e\u662f\u8003\u8651\u5feb\u901f\u6c42\u51fa $g(n,k)$\n\n\u7136\u540e\u5982\u679c\u4f60\u5148\u5bf9 $f$ \u83ab\u53cd\uff0c\u518d\u5bf9 $g$ \u83ab\u53cd\u5c31\u4f1a\u5199\u51fa\u4e00\u4e2a\u5f88\u8be1\u5f02\u7684\u5f0f\u5b50\uff0c\u65e0\u6cd5\u4f18\u5316\n\n\u6211\u4eec\u8003\u8651\u628a $g$ \u7684 $[k\\perp i]$ \u4fdd\u7559\u4e0b\u6765\uff0c\u5bf9 $f$ \u83ab\u53cd\n\n$$f(n)=\\sum\\limits_{i=1}^ni[i\\perp n]$$\n\n$$=\\sum\\limits_{i=1}^ni\\sum_{d|i,d|n}\\mu(d)$$\n\n$$=\\sum\\limits_{d|n}\\mu(d)\\sum\\limits_{i=1}^{n/d}id$$\n\n\u8bbe $S(n)=\\frac{n\\times (n+1)}{2}$\n\n$$=\\sum\\limits_{d|n}S(n/d)\\mu(d)d$$\n\n\u7ee7\u7eed\u63a8 $g$ \u7684\u5f0f\u5b50\n\n$$g(n,k)=\\sum\\limits_{i=1}^n[k\\perp i]f(i)$$\n\n$$=\\sum\\limits_{T=1}^n[k\\perp T]\\sum\\limits_{d|T}S(d)\\mu(T/d)d$$\n\n$$=\\sum\\limits_{d=1}^nd\\times \\mu(d)\\sum\\limits_{d|T}[k\\perp T]S(T/d)$$\n\n\u8bbe $T=id$\n\n$$=\\sum\\limits_{d=1}^nd\\times \\mu(d)\\sum\\limits_{i=1}^{n/d}[k\\perp id]S(i)$$\n\n\u53d1\u73b0 $[k\\perp id]=[k\\perp i][k\\perp d]$\n\n$$=\\sum\\limits_{d=1}^nd\\times \\mu(d)\\sum\\limits_{i=1}^{n/d}[k\\perp i][k\\perp d]S(i)$$\n\n$$=\\sum\\limits_{d=1}^n[k\\perp d]d\\times \\mu(d)\\sum\\limits_{i=1}^{n/d}[k\\perp i]S(i)$$\n\n\u6570\u8bba\u5206\u5757\u540e\u53d8\u6210\u6c42 $\\sum\\limits_{d=1}^n[k\\perp d]d\\times \\mu(d)$ \u4e0e $\\sum\\limits_{i=1}^{n}[k\\perp i]S(i)$\n\n\u524d\u9762\u662f\u79ef\u6027\u51fd\u6570\u53ef\u4ee5\u7b5b\uff0c\u540e\u9762\u53cd\u6f14\u540e\u53d8\u6210$\\sum\\limits_{d|k}^n\\mu(d)h(d)$\n\n$h(d)$ \u4e3a\u4e0e $d$ \u6709\u5173\u7684\u4f4e\u6b21\u591a\u9879\u5f0f\u4e14\u5df2\u77e5\n\n\u53d1\u73b0\u53ea\u5728 $k$ \u7684\u56e0\u6570\u4e0a\u6709\u503c\uff0c\u628a $k$ \u5206\u89e3\u51fa\u6765\n\n\u56e0\u4e3a $k$ \u7684\u56e0\u6570\u6700\u5927\u503c\u5728 $1500$ \u5de6\u53f3\uff0c\u6240\u4ee5\u662f\u53ef\u8fc7\u7684\n\n\n\n\n\n\n\n\n",
        "postTime": 1617601770,
        "uid": 359952,
        "name": "_lbw_",
        "ccfLevel": 6,
        "title": "HMOI R1 T6 \u9898\u89e3"
    },
    {
        "content": "~~\u597d\u50cf\u88ab\u6211\u63a8\u590d\u6742\u4e86...~~\n\n## \u7b80\u8ff0\u9898\u610f\n\n\u6c42\uff1a\n$$\n\\sum^{n}_{x=1}\\sum^{n}_{y=1}\\sum^{x}_{i=1}i[(x,k_{1})=1][(i,x)=1]\\sum^{y}_{j=1}[(y,k_{2})=1][(y,j)=1]j\n$$\n$n,k_1,k_2\\leq 2\\times 10^9$\u3002\n\n## Solution\n\n\u9996\u5148\u662f\u63a8\u5f0f\u5b50\uff1a\n\n$$\n\\begin{aligned}\nans&=\\sum^{n}_{x=1}\\sum^{x}_{i=1}i[(x,k_{1})=1][(i,x)=1]\\sum^{n}_{y=1}\\sum^{y}_{j=1}[(y,k_{2})=1][(y,j)=1]j\\\\\n\\end{aligned}\n$$\n\n\u6ce8\u610f\u5230\u5de6\u53f3\u4e24\u8fb9\u5f62\u5f0f\u4e00\u6837\uff0c\u8bbe $S(n,k)=\\sum^{n}_{x=1}\\sum^{x}_{i=1}i[(x,k)=1][(i,x)=1]$\u3002\n\n\u90a3\u4e48\u6709\uff1a\n$$\n\\begin{aligned}\nans&=S(n,k_{1})\\times S(n,k_{2})\\\\\n\\\\\nS(n,k)&=\\sum^{n}_{x=1}\\sum^{x}_{i=1}i[(x,k)=1][(i,x)=1]\\\\\n&=\\sum^{n}_{x=1}[(x,k)=1]\\sum^{x}_{i=1}i\\sum_{g|\\gcd(i,x)}\\mu(g)\\\\\n&=\\sum^{n}_{x=1}[(x,k)=1]\\sum^{}_{g|x}\\mu(g)g C_{2}(\\frac{x}{g})\\\\\n&=\\sum^{n}_{x=1}\\sum_{t|\\gcd(x,k_1)}\\mu(t)\\sum^{}_{g|x}\\mu(g)g C_{2}(\\frac{x}{g})\\\\\n&=\\frac{1}{2}\\sum^{}_{t|k_{1}}\\mu(t)\\sum^{\\lfloor\\frac{n}{t}\\rfloor}_{x=1}x\\sum^{}_{g|x}\\mu(g)\\frac{x}{g}+\\mu(g)\\\\\n&=\\frac{1}{2}\\sum^{}_{t|k_{1}}\\mu(t)\\sum^{\\lfloor\\frac{n}{t}\\rfloor}_{x=1}x\\varphi(x)+[x=1]\\\\\n&=1+\\frac{1}{2}\\sum^{}_{t|k_{1}}\\mu(t)\\sum^{\\lfloor\\frac{n}{t}\\rfloor}_{x=1}tx\\varphi(tx))\\\\\n\\end{aligned}\n$$\n\u5982\u679c\u662f\u6c42 $i\\varphi(i)$ \u7684\u524d\u7f00\u548c\uff0c\u53ef\u4ee5\u76f4\u63a5\u4e0a `Min_25` \uff0c\u53ef\u662f\u8fd9\u91cc\u7684\u5f62\u5f0f\u6bd4\u8f83\u8be1\u5f02\uff0c\u4e0d\u80fd\u76f4\u63a5\u6c42\u3002\n\n\u4e0d\u8fc7\u6ce8\u610f\u5230 $\\mu(t)\\not = 0$\uff0c\u5f53\u4e14\u4ec5\u5f53 $t$ \u4e2d\u7684\u6bcf\u4e00\u4e2a\u8d28\u56e0\u5b50\u53ea\u51fa\u73b0\u4e00\u6b21\uff0c\u4f3c\u4e4e\u662f\u53ef\u4ee5\u505a\u4e00\u4e2aDP\u3002\n\n\u6211\u4eec\u4ee4 $p$  \u8868\u793a $t$ \u4e2d\u7684\u67d0\u4e00\u4e2a\u8d28\u56e0\u5b50\uff0c\u540c\u65f6\u5b9a\u4e49\u4e00\u4e2a\u65b0\u7684\u51fd\u6570 $G(n,t)$\u3002\n$$\n\\begin{aligned}\nG(n,t)&=\\sum^{n}_{x=1}x\\varphi(tx)\\\\\n&=\\sum^{n}_{x=1}[\\gcd(x,p)=1]x\\varphi(x\\frac{t}{p})(p-1)+\\sum^{\\lfloor\\frac{n}{p}\\rfloor}_{x=1}xp^2\\varphi(xp\\frac{t}{p})\\\\\n&=\\sum^{n}_{x=1}x\\varphi(x\\frac{t}{p})(p-1)+\\sum^{\\lfloor\\frac{n}{p}\\rfloor}_{x=1}xp\\varphi(xt)\\\\\n&=(p-1)G(n,\\frac{t}{p})+pG(\\lfloor\\frac{n}{p}\\rfloor,t)\\\\\n\\\\\nG(n,1)&=\\sum^{n}_{i=1}i\\varphi(i)=F(n)\\\\\n\\\\\nS(n,k)&=1+\\frac{1}{2}\\sum_{t|k \\And \\mu(t)\\not = 0}t\\mu(t)G(\\lfloor \\frac{n}{t} \\rfloor,t)\n\n\\end{aligned}\n$$\n\u52a0\u4e0a\u8bb0\u5fc6\u5316\u4e4b\u540e\uff0c\u590d\u6742\u5ea6\u4fbf\u6b63\u786e\u4e86\u3002\n\n\u9996\u5148\u662f $G$ \u90e8\u5206\uff0c\u603b\u5171\u72b6\u6001\u4e2a\u6570\u662f $O(k^{\\frac{1}{3}}n^{\\frac{1}{2}})$ \u7684\uff0c\u6bcf\u6b21\u8f6c\u79fb\u662f $O(1)$\u3002\n\n\u7136\u540e\u662f $F$ \u90e8\u5206\uff0c\u53ea\u6709 $O(\\sqrt{n})$ \u4e2a\u53d6\u503c\uff0c\u53ea\u9700\u8981\u5728 `Min_25` \u5185\u52a0\u4e00\u4e2a\u8bb0\u5fc6\u5316\u4e5f\u662f\u53ef\u4ee5\u505a\u5230 $O(n^{\\frac{3}{4}}) $ \u6216\u8005 $O(\\frac{n^{\\frac{3}{4}}}{\\ln n})$ \u3002\n\n\u89c6 $n,k$ \u540c\u9636\uff0c\u90a3\u4e48\u603b\u590d\u6742\u5ea6\u4e3a $O(n^{\\frac{5}{6}})$ \uff0c\u5b9e\u6d4b\u8dd1\u7684\u8fd8\u662f\u6bd4\u8f83\u5feb\u7684\uff0c\u5b8c\u5168\u8dd1\u4e0d\u6ee1\uff0c\u74f6\u9888\u53cd\u800c\u5728 `Min_25` \u5185\u8bb0\u5fc6\u5316\u6240\u4f7f\u7528\u7684 `map` \u4e2d\u3002\n\n## Code\n\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n#include<map>\n#include<unordered_map>\nusing namespace std;\n#define ll long long \n#define ri int\n#define pii pair<int,int>\nconst ll mod=998244353,inv=mod+1>>1,inv3=332748118;\nll add(ll x,ll y){return (x+=y)<mod?x:x-mod;}\nll dec(ll x,ll y){return (x-=y)<0?x+mod:x;}\nll ksm(ll d,ll t){ll res=1;for(;t;t>>=1,d=d*d%mod) if(t&1) res=res*d%mod;return res;}\nconst int MAXN=1e5+7;\nint totcnt=0;\nnamespace Getphi{\n    const int MAXM=1e7+7;\n    int val[MAXM],as[MAXM],nxt[MAXM],mapcnt;\n    struct hmap{\n        static const int P=10007;\n        int hed[P];\n        bool count(int x){\n            int c=hed[x%P];\n            while(c){\n                if(val[c]==x) return 1;\n                c=nxt[c];\n            }return 0;\n        }\n        int& operator [](int x){\n            int c=hed[x%P];\n            while(c){\n                if(val[c]==x) return as[c];\n                c=nxt[c];\n            }\n            ++mapcnt;val[mapcnt]=x;nxt[mapcnt]=hed[x%P];hed[x%P]=mapcnt;\n            return as[mapcnt];\n        }\n        int size(){return mapcnt;}\n    }S[4650];\n    int n,p1[MAXN],p2[MAXN],cnt,N,flag[MAXN],prim[MAXN],w[MAXN];\n    int pos(int x){\n        if(1ll*x*x<=n) return p1[x];\n        else return p2[n/x];\n    }\n    ll g1[MAXN],g2[MAXN];\n    ll C2(ll x){return x*(x+1)/2%mod;}\n    ll C3(ll x){return C2(x)*(x+x+1)%mod*inv3%mod;}\n    void init(int _n){\n        n=_n;\n        N=sqrt(n);\n        for(ri i=2;i<=N;++i){\n            if(!flag[i]) prim[++prim[0]]=i;\n            for(ri j=1;j<=prim[0]&&i*prim[j]<=N;++j){\n                flag[i*prim[j]]=1;\n                if(i%prim[j]==0) break;\n            }\n        }\n        for(ri l=1,r;l<=n;l=r+1){\n            int cur=n/l;r=n/cur;\n            w[++cnt]=cur;\n            if(1ll*cur*cur<=n) p1[cur]=cnt;\n            else p2[n/cur]=cnt;\n            g1[cnt]=C2(cur)-1;\n            g2[cnt]=C3(cur)-1;\n        }\n        for(ri t=1;t<=prim[0];++t){\n            for(ri i=1;i<=cnt&&w[i]>=prim[t]*prim[t];++i){\n                int nxtl=pos(w[i]/prim[t]),nxtr=(t==1?0:pos(prim[t-1]));\n                g1[i]=dec(g1[i],dec(g1[nxtl],g1[nxtr])*prim[t]%mod);\n                g2[i]=dec(g2[i],dec(g2[nxtl],g2[nxtr])*prim[t]%mod*prim[t]%mod);\n            }\n        }\n    }\n    ll getS(int n,int cur){\n        int P=pos(n);\n        if(cur&&prim[cur]>=n) return 0;\n        if(S[cur].count(P)) return S[cur][P];\n        int r=pos(n),l=cur==0?0:pos(prim[cur]);\n        ll ans=dec(dec(g2[r],g2[l]),dec(g1[r],g1[l]));\n        for(ri i=cur+1;i<=prim[0]&&1ll*prim[i]*prim[i]<=n;++i){\n            for(ll e=1,v=prim[i],W=1;v<=n;++e,v*=prim[i],W*=prim[i]){\n                ll res=getS(n/v,i);\n                if(e!=1) ++res;\n                res=res*v%mod*W%mod*(prim[i]-1)%mod;\n                ans=add(ans,res);\n            }\n        }\n        return S[cur][P]=ans;\n    }\n    ll getphi(ll x){\n        ll now=getS(x,0)+1;\n        return now;\n    }\n}\nll ans;\nll sta[64],top;\nint f[64][MAXN];\nll g(ll n,int cur){\n    if(n==0) return 0;\n    int P=Getphi::pos(n);\n    if(~f[cur][P]) return f[cur][P];\n    if(cur==0) return f[cur][P]=Getphi::getphi(n);\n    return f[cur][P]=add((sta[cur]-1)*g(n,cur-1)%mod,sta[cur]*g(n/sta[cur],cur)%mod);\n}\nll S(ll n,ll k){\n    ll res=1;\n    for(ri t=1;t*t<=k;++t){\n        if(k%t) continue;\n        if(t<=n){\n            ll x=t;\n            int now=1;\n            top=0;\n            for(ll i=2;i*i<=t&&i<=x;++i){\n                int cnt=0;\n                while(x%i==0) ++cnt,x/=i;\n                if(cnt>1) goto Nex;\n                if(cnt) sta[++top]=i,now=-now;\n            }\n            if(x>1) now=-now,sta[++top]=x;\n            for(ri i=0;i<=top;++i) for(ri j=0;j<=Getphi::cnt;++j) f[i][j]=-1;\n            if(now== 1) res=add(res,g(n/t,top)*t%mod);\n            if(now==-1) res=dec(res,g(n/t,top)*t%mod);\n            Nex:;\n        }\n        if(t*t!=k&&k/t<=n){\n            ll x=(k/t);\n            int now=1;\n            top=0;\n            for(ll i=2;i*i<=(k/t)&&i<=x;++i){\n                int cnt=0;\n                while(x%i==0) ++cnt,x/=i;\n                if(cnt>1) goto Next;\n                if(cnt) sta[++top]=i,now=-now;\n            }\n            if(x>1) now=-now,sta[++top]=x;\n            for(ri i=0;i<=top;++i) for(ri j=0;j<=Getphi::cnt;++j) f[i][j]=-1;\n            if(now== 1) res=add(res,g(n/(k/t),top)*(k/t)%mod);\n            if(now==-1) res=dec(res,g(n/(k/t),top)*(k/t)%mod);\n            Next:;\n        }\n    }\n    return res*inv%mod;\n}\nll n,k1,k2;\nint main(){\n    // freopen(\"rand.in\",\"r\",stdin);\n    // freopen(\"1.out\",\"w\",stdout);\n    scanf(\"%lld%lld%lld\",&n,&k1,&k2);\n    Getphi::init(n);\n    printf(\"%lld\\n\",S(n,k1)*S(n,k2)%mod);\n}\n```\n\n",
        "postTime": 1635943960,
        "uid": 206998,
        "name": "Krimson",
        "ccfLevel": 0,
        "title": "P7504 \u300cHMOI R1\u300d\u53ef\u7231\u7684\u5fb7\u4e3d\u838e"
    }
]
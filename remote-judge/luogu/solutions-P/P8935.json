[
    {
        "content": "\u76ee\u524d\u5df2\u6539\u6b63\u4e3a $O(n^2)$\uff0c\u6570\u636e\u6709\u53ef\u80fd\u4e4b\u540e\u4f1a\u52a0\u5f3a\u3002\n\n\u5728\u6b63\u89e3\u4e2d\uff0c\u6211\u4eec\u5148\u6c42\u51fa $f_{u,k}$ \u8868\u793a $u$ \u5b50\u6811\u5185\u8fdb\u884c\u4e86 $k$ \u6b21\u64cd\u4f5c\u7684\u65b9\u6848\uff0c\u6811\u5f62\u80cc\u5305\u5373\u53ef\uff0c\u8fd9\u90e8\u5206 $O(n^2)$\u3002\u540c\u65f6\u6211\u4eec\u4e5f\u89e3\u51b3\u4e86 $k=1$ \u6216 $x=1$\u3002  \n\u8003\u8651\u5230\u94a6\u5b9a $x$ \u64cd\u4f5c\u4f4d\u7f6e\u4f1a\u5f71\u54cd\u5176\u6240\u6709\u7956\u5148\u9009\u62e9\uff0c\u53ef\u4ee5\u60f3\u5230\u628a\u7956\u5148\u548c\u4ed6\u4eec\u7684\u5176\u5b83\u5b50\u6811\u5206\u5f00\uff0c\u4f46\u8fd9\u6837\u5177\u6709\u540e\u6548\u6027\uff08\u56e0\u4e3a\u96be\u4ee5\u4fdd\u8bc1 $u$ \u7684\u5b50\u6811\u7684\u64cd\u4f5c\u90fd\u5728 $u$ \u4e4b\u524d\uff09\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u4ece\u6839\u8fdb\u884c\u4e8c\u6b21 dp\u3002  \n\u9996\u5148\uff0c\u6211\u4eec\u628a $1$ \u5230 $x$ \u8fd9\u6761\u94fe\u79f0\u4e3a\u201c\u830e\u201d\uff0c\u548c\u9898\u76ee\u63cf\u8ff0\u4e00\u6837\u3002  \n\u8bbe $g_{u,k}$ \u4e3a\u5f53\u524d\u830e\u4ece\u6839\u9009\u5230\u4e86 $u$\uff0c\u5269\u4f59 $k$ \u64cd\u4f5c\u7ed9\u830e $u$ \u540e\u9762\u7684\u70b9\u7559\u7740\uff0c**\u8fd9\u4e9b\u64cd\u4f5c\u6709\u76f8\u5bf9\u987a\u5e8f\u4f46\u5e76\u672a\u88ab\u5b9e\u9645\u653e\u5728\u64cd\u4f5c\u5e8f\u5217\u7684\u67d0\u4e00\u4e2a\u4f4d\u7f6e\u4e0a**\u3002\u6700\u7ec8\u7b54\u6848\u5c31\u662f $g_{x,k-1}$ \uff08\u5f3a\u5236\u94a6\u5b9a\u5230\u8fbe $x$ \u65f6 $k$ \u8fd9\u4e2a\u4f4d\u7f6e dp \u503c\u4e0d\u80fd\u62f7\u8d1d\u8fc7\u6765\u5373\u53ef\uff09\u3002  \n\u8003\u8651\u8f6c\u79fb\uff0c\u5f53\u4ece $fa$ \u8f6c\u79fb\u5230 $u$ \u65f6\uff0c\u6211\u4eec\u5148\u8003\u8651 $u$ \u9009\u4e0d\u9009\u3002\u5982\u679c\u4e0d\u9009\uff0c\u76f4\u63a5\u62f7\u8d1d\uff0c\u5426\u5219\u8bbe\u5b83\u548c\u7236\u4eb2\u4e4b\u95f4\u586b\u4e86 $p$ \u4e2a\u64cd\u4f5c\uff0c\u4ece $g_{fa,k}$ \u8f6c\u79fb\u8fc7\u6765\u7684\u8bdd\uff0c\u90a3\u4e48\u64cd\u4f5c\u5e8f\u5217\u5c31\u5fc5\u987b\u6309\u987a\u5e8f\u586b $fa$ \u7ed9\u4ed6\u7559\u7684 $p$ \u4e2a\u64cd\u4f5c\u3002\u6240\u4ee5\u8f6c\u79fb\u5230 $g_{u,k-p}$\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u524d\u7f00\u548c\u4f18\u5316\u505a\u5230\u5355\u6b21 $O(n)$\uff0c\u603b\u5171 $O(n^2)$\u3002  \n\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651\u628a $u$ \u4e0d\u5728\u830e\u4e0a\u7684\u5b50\u6811\u7684\u64cd\u4f5c\u586b\u8fdb\u53bb\uff0c\u4e0d\u96be\u53d1\u73b0\u8fd9\u4e9b\u64cd\u4f5c\u90fd\u662f\u7ed9\u540e\u9762\u7559\u7684\uff0c\u4e8e\u662f\u80cc\u5305\u4e00\u4e0b\u5373\u53ef\u3002\u590d\u6742\u5ea6\u5206\u6790\u53ef\u4ee5\u770b\u505a\u4e00\u68f5\u4ee5 $x$ \u4e3a\u6839\u7684\u6811\u505a\u6811\u5f62\u80cc\u5305\uff0c\u590d\u6742\u5ea6 $O(n^2)$\u3002  \n\u7efc\u4e0a\uff0c\u6211\u4eec\u5728 $O(n^2)$ \u7684\u65f6\u95f4\u901a\u8fc7\u4e86\u672c\u9898\u3002  \n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nint read() {\n    int x=0,f=1;\n    char c=getchar();\n    while(c<'0'||c>'9') {\n        if(c=='-')f=-1;\n        c=getchar();\n    }\n    while(c>='0'&&c<='9')x=x*10+c-'0',c=getchar();\n    return x*f;\n}\nnamespace tokidosaya {\n    const int maxn=505,mod=1e9+7;\n    struct edge {\n        int next,to;\n    } e[maxn*2];\n    int h[maxn],cnt,n,k,X,d[maxn],ff[maxn],siz[maxn],now,zc[maxn],o;\n    ll f[maxn][maxn],ans,fac[maxn],inv[maxn],g[2][maxn],w[maxn];\n    void addedge(int x,int y) {\n        e[++cnt].next=h[x],e[cnt].to=y,h[x]=cnt;\n    }\n    ll qpow(ll x,int y) {\n        ll w=1;\n        while(y) {\n            if(y&1)w=w*x%mod;\n            x=x*x%mod,y>>=1;\n        }\n        return w;\n    }\n    ll C(int x,int y) {\n        if(y>x||y<0)return 0;\n        return fac[x]*inv[x-y]%mod*inv[y]%mod;\n    }\n    void dfs(int u,int fa) {\n        ff[u]=fa,f[u][0]=1;\n        for(int i=h[u]; i; i=e[i].next) {\n            int v=e[i].to;\n            if(v==fa)continue;\n            dfs(v,u);\n            for(int j=siz[u]; j>=0; j--)\n                for(int k=siz[v]; k; k--)f[u][j+k]=(f[u][j+k]+f[u][j]*f[v][k]%mod*C(j+k,k))%mod;\n            siz[u]+=siz[v];\n        }\n        for(int i=siz[u]; i>=0; i--)f[u][i+1]=(f[u][i+1]+f[u][i])%mod;\n        siz[u]++;\n    }\n    int getw(int u) {\n        int nc=0;\n        memset(w,0,sizeof(w)),w[0]=1;\n        for(int i=h[u]; i; i=e[i].next) {\n            int v=e[i].to;\n            if(d[v])continue;\n            for(int j=nc; j>=0; j--)\n                for(int k=siz[v]; k; k--)w[j+k]=(w[j+k]+w[j]*f[v][k]%mod*C(j+k,k))%mod;\n            nc+=siz[v];\n        }\n        return nc;\n    }//\u8fd9\u4e2a\u76f8\u5f53\u4e8e\u628a\u4e0d\u5728\u830e\u4e0a\u7684\u5b50\u6811\u5408\u5e76\u8fdb\u53bb\n    int main() {\n        int x,y;\n        n=read(),k=read(),X=read(),fac[0]=1;\n        for(int i=1; i<=n; i++)fac[i]=fac[i-1]*i%mod;\n        inv[n]=qpow(fac[n],mod-2);\n        for(int i=n; i; i--)inv[i-1]=inv[i]*i%mod;\n        for(int i=1; i<n; i++) {\n            x=read(),y=read();\n            addedge(x,y),addedge(y,x);\n        }\n        dfs(1,0),x=X;\n        while(x)d[x]=1,zc[++o]=x,x=ff[x];\n        reverse(zc+1,zc+o+1),getw(1);\n        for(int i=0; i<n; i++)g[1][i]=w[i];\n        for(int i=2; i<=o; i++) {\n            int now=i&1,lst=now^1,u=zc[i],nc=getw(u);\n            memcpy(g[now],g[lst],sizeof(g[now]));\n            ll sum=0;\n            for(int j=n-1; j>=0; j--) {\n                sum=(sum+g[now][j])%mod;\n                if(i==o)g[now][j]=0;\n                g[now][j]=(g[now][j]+sum)%mod;\n            }\n            for(int j=n-1; j>=0; j--)\n                if(g[lst][j])for(int k=nc; k; k--)g[now][j+k]=(g[now][j+k]+g[now][j]*w[k]%mod*C(j+k,k))%mod;\n        }\n        printf(\"%lld\",g[o&1][k-1]);\n        return 0;\n    }\n}\nint main() {\n    return tokidosaya::main();\n}\n\n```",
        "postTime": 1671435273,
        "uid": 104324,
        "name": "abruce",
        "ccfLevel": 7,
        "title": "\u9898\u89e3--\u830e"
    },
    {
        "content": "[$\\text{Link}$](https://www.luogu.com.cn/problem/P8935)\n\n\u8111\u5b50\u77ed\u8def\u3002\n## \u9898\u610f\n\u4f60\u6709\u4e00\u68f5 $n$ \u4e2a\u70b9\u7684\u6839\u8282\u70b9\u4e3a $1$ \u7684\u6709\u6839\u6811\uff0c\u73b0\u5728\u4f60\u8981\u5bf9\u8fd9\u68f5\u6811\u8fdb\u884c\u526a\u679d\uff0c\u6bcf\u6b21\u4f60\u53ef\u4ee5\u9009\u62e9\u4e00\u4e2a\u8fd8\u672a\u88ab\u526a\u6389\u7684\u8282\u70b9 $u$ \u8fdb\u884c\u64cd\u4f5c\uff0c\u7136\u540e\u526a\u6389 $u$ \u7684\u5b50\u6811\u6240\u6709\u70b9\uff08\u5305\u62ec $u$\uff09\u3002\u5f53\u4e14\u4ec5\u5f53\u4f60\u526a\u6389 $1$ \u65f6\uff0c\u64cd\u4f5c\u505c\u6b62\u3002 \n\n\u4f60\u9700\u8981\u5728\u7b2c $k$ \u6b21\u526a\u679d\u65f6\u5bf9 $x$ \u8fdb\u884c\u64cd\u4f5c\uff0c\u800c\u975e\u4ec5\u4ec5\u5c06\u5176\u526a\u6389\uff0c\u5373\u4f60\u4e0d\u80fd\u5728\u7b2c $k$ \u6b21\u5bf9\u5176\u7956\u5148\u8fdb\u884c\u64cd\u4f5c\u4f7f\u5176\u88ab\u8fde\u5e26\u526a\u6389\u3002 \n\n\u6c42\u6709\u591a\u5c11\u79cd\u4e0d\u540c\u7684\u64cd\u4f5c\u5e8f\u5217\uff0c\u4e24\u4e2a\u64cd\u4f5c\u5e8f\u5217\u4e0d\u540c\u5f53\u4e14\u4ec5\u5f53\u957f\u5ea6\u4e0d\u540c\u6216\u5b58\u5728\u4e00\u6b21\u64cd\u4f5c $i$ \u4f7f\u5f97\u4e24\u64cd\u4f5c\u5e8f\u5217\u5728\u7b2c $i$ \u6b21\u65f6\u9009\u62e9\u7684 $u$ \u4e0d\u540c\u3002\u8f93\u51fa\u7b54\u6848\u6a21 $10^9+7$\u3002\n\n$n\\le 500$\u3002\n## \u601d\u8def\n\u8003\u8651\u5148\u7b97 $f_{x,i}$ \u8868\u793a $x$ \u5b50\u6811\u5185\u8fdb\u884c $i$ \u6b21\u64cd\u4f5c\uff0c\u4e0d\u5fc5\u987b\u5220\u5b8c\u7684\u65b9\u6848\u6570\u3002\u5148\u5f97\u5230\u4e0d\u8003\u8651 $x$ \u7684\u65b9\u6848\u6570\uff0c\u8f6c\u79fb\u4e3a $f_{x,0}=1$\uff0c$\\displaystyle\\forall t\\in \\text{sons}(x),f_{x,i+j}=f_{x,i}f_{t,j}\\binom{i+j}{j}$\u3002\u518d\u8003\u8651 $x$\uff0c$f_{x,i}=f_{x,i}+f_{x,i-1}$\u3002\n\n\u4ee4 $x$ \u4e0e\u5176\u7956\u5148\u7ec4\u6210\u7684\u70b9\u96c6\u4e3a $S$\uff0c\u4ece $1$ \u5f00\u59cb\u5411\u4e0b\u5012\u5e8f\u5220\u70b9\u3002\u6211\u4eec\u5b9a\u4e49 $g_{x,i}$ \u8868\u793a\u8003\u8651\u5230 $S$ \u7684\u524d $x$ \u4f4d\uff0c\u6211\u4eec\u5df2\u7ecf\u94a6\u5b9a\u4e86 $S$ \u5728 $x$ \u524d\u7684\u70b9\u7684\u4e0d\u5728 $S$ \u4e2d\u7684\u5b50\u6811\u7684 $i$ \u4e2a\u64cd\u4f5c\u3002\u8fd9\u4e9b\u64cd\u4f5c\u6709\u76f8\u5bf9\u987a\u5e8f\uff0c\u4f46\u8fd8\u672a\u88ab\u653e\u5728\u64cd\u4f5c\u5e8f\u5217\u4e2d\u3002\n\n\u6211\u4eec\u4ee4 $h_{x,i}$ \u8868\u793a $x$ \u4e0d\u5728 $S$ \u5185\u7684\u5b50\u6811\u8fdb\u884c $i$ \u6b21\u64cd\u4f5c\u7684\u65b9\u6848\u6570\u3002$h_{x,0}=1$\uff0c$\\displaystyle\\forall t\\in \\text{sons}(x)\\text{ and }t\\notin S,h_{x,i+j}=h_{x,i}f_{t,j}\\binom{i+j}{j}$\u3002\n\n\u8003\u8651\u4e00\u6b21\u8f6c\u79fb\uff0c\u5f53 $x$ \u4e0d\u88ab\u64cd\u4f5c\u65f6\uff0c$g_{x,i}=g_{x-1,i}$\u3002\u6ce8\u610f\u6700\u540e\u4e00\u4e2a\u70b9\u4e0d\u80fd\u4e0d\u88ab\u64cd\u4f5c\uff0c\u6240\u4ee5\u4e0d\u80fd\u590d\u5236\u3002\u5f53 $x$ \u88ab\u653e\u5728 $p$ \u4f4d\u7f6e\u65f6\uff0c$g_{x-1,p+k}$ \u90fd\u53ef\u4ee5\u8f6c\u79fb\u5230 $g_{x,p}$\u3002\u518d\u5c06 $x$ \u4e0d\u5728 $S$ \u4e2d\u7684\u5b50\u6811\u7684\u64cd\u4f5c\u52a0\u5165\u5230 $j$ \u4e2d\u3002$\\displaystyle g_{x,i+l}=g_{x,i+l}+g_{x,i}h_{x,l}\\binom{i+l}{l}$\u3002\n\n\u6700\u7ec8\u7684\u7b54\u6848\u4e3a $g_{x,k-1}$\u3002\n\n\u8fd9\u65f6\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^3)$\uff0c\u8003\u8651\u4f18\u5316\u3002\u6211\u4eec\u4ee4 $p_{x,i}$ \u8868\u793a $\\displaystyle \\sum_{c\\ge 0}g_{x,i+c}$\u3002\u5219\u4e0a\u8ff0\u8f6c\u79fb\u4e2d\u7684 $g_{x,p}$ \u53ef\u4ee5\u76f4\u63a5\u7531 $p_{x-1,p}$ \u8f6c\u79fb\u5f97\u5230\uff0c\u6b64\u65f6\u65f6\u95f4\u590d\u6742\u5ea6\u4f18\u5316\u5230 $O(n^2)$\uff0c\u5373\u53ef\u901a\u8fc7\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nnamespace IO{//by cyffff\n\t\n}\nconst int N=500+10,mod=1e9+7;\nint n,k,p,fac[N],ifac[N],cnt,head[N];\nstruct Edge{\n\tint to,nxt;\n}a[N<<1];\ninline void add(int u,int v){\n\tcnt++;\n\ta[cnt].to=v;\n\ta[cnt].nxt=head[u];\n\thead[u]=cnt;\n}\ninline int qpow(int x,int y){\n\tint res=1;\n\twhile(y){\n\t\tif(y&1) res=1ll*res*x%mod;\n\t\tx=1ll*x*x%mod;\n\t\ty/=2; \n\t}\n\treturn res;\n}\ninline void Prefix(int n){\n\tfac[0]=1;\n\tfor(int i=1;i<=n;i++)\n\t\tfac[i]=1ll*fac[i-1]*i%mod;\n\tifac[n]=qpow(fac[n],mod-2);\n\tfor(int i=n;i;i--)\n\t\tifac[i-1]=1ll*ifac[i]*i%mod;\n}\ninline int C(int n,int m){\n\treturn n<m?0:1ll*fac[n]*ifac[m]%mod*ifac[n-m]%mod;\n}\nint f[N][N],g[2][N*2],pr[N],tmp[N],fr[N],siz[N],ans;\nbool fl[N];\n//g[i][j][k] i \u53ca i \u7956\u5148\u7684\u5176\u5b83\u5b50\u6811\u5185\u5df2\u7ecf\u9009\u4e86 k \u4e2a \ninline void dfs(int x,int fa){\n\tf[x][0]=1,fr[x]=fa;\n\tfor(int i=head[x];i;i=a[i].nxt){\n\t\tint t=a[i].to;\n\t\tif(t==fa) continue;\n\t\tdfs(t,x);\n\t\tfor(int j=siz[x];j>=0;j--)\n\t\t\tfor(int k=siz[t];k>=1;k--)\n\t\t\t\tf[x][j+k]=(f[x][j+k]+1ll*f[x][j]*f[t][k]%mod*C(j+k,k))%mod;\n\t\tsiz[x]+=siz[t];\n\t}\n\tfor(int i=siz[x];i>=0;i--)\n\t\tf[x][i+1]=(f[x][i+1]+f[x][i])%mod; \n\tsiz[x]++;\n}\ninline void oth(int x){//\u8fd9\u4e2a\u8282\u70b9\u5176\u5b83\u5b50\u6811 i \u6b21\u64cd\u4f5c\u7684\u65b9\u6848\u6570 \n\tint s=0;\n\ttmp[0]=1;\n\tfor(int i=1;i<=n;i++)\n\t\ttmp[i]=0;\n\tfor(int i=head[x];i;i=a[i].nxt){\n\t\tint t=a[i].to;\n\t\tif(t==fr[x]||fl[t]) continue;\n\t\tfor(int j=s;j>=0;j--)\n\t\t\tfor(int k=siz[t];k>=1;k--)\n\t\t\t\ttmp[j+k]=(tmp[j+k]+1ll*tmp[j]*f[t][k]%mod*C(j+k,k))%mod;\n\t\ts+=siz[t];\n\t}\n}\nvector<int>s;\nint main(){\n\tn=read(),k=read(),p=read();\n\tPrefix(n);\n\tfor(int i=1;i<n;i++){\n\t\tint u=read(),v=read();\n\t\tadd(u,v),add(v,u);\n\t}\n\tdfs(1,0);\n\tint t=p;\n\twhile(t){\n\t\ts.push_back(t);\n\t\tfl[t]=1,t=fr[t];\n\t}\n\treverse(s.begin(),s.end());\n\toth(s[0]);\n\tint l=s.size();\n\tfor(int j=0;j<=n;j++)\n\t\tg[0][j]=tmp[j];\n\tfor(int i=1;i<s.size();i++){\n\t\tint c=i&1;\n\t\toth(s[i]);\n\t\tint sz=siz[s[i]];\n\t\tif(i!=l-1) sz-=siz[s[i+1]];\n\t\tfor(int t=0;t<=n;t++)\n\t\t\tg[c][t]=g[!c][t]*(i!=l-1);\n\t\tfor(int t=n;t>=0;t--)\n\t\t\tpr[t]=(pr[t+1]+g[!c][t])%mod;\n\t\tfor(int d=n;d>=0;d--)\n\t\t\tg[c][d]=(g[c][d]+pr[d])%mod;\n\t\tfor(int j=n-1;j>=0;j--)\n\t\t\tfor(int d=sz;d;d--)\n\t\t\t\tg[c][j+d]=(g[c][j+d]+1ll*g[c][j]*tmp[d]%mod*C(j+d,d))%mod;\n\t}\n\twrite(g[l-1&1][k-1]);\n\tflush();\n}\n```\n\u518d\u89c1 qwq~",
        "postTime": 1671753663,
        "uid": 365127,
        "name": "cyffff",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P8935\u3010[JRKSJ R7] \u830e\u3011"
    }
]
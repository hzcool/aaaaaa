[
    {
        "content": "## \u9898\u610f\n\n\u7528\u4e00\u4e2a\u9ab0\u5b50\u5728 $n\\times m$ \u7684\u68cb\u76d8\u4e0a\u6eda\uff0c\u8981\u6c42\u4ece\u5750\u6807 $(1,1)$ \u6eda\u5230\u5750\u6807 $(n,m)$\uff0c\u6bcf\u6b21\u53ef\u4ee5\u5411\u4e0b\u6eda\u6216\u8005\u5411\u53f3\u6eda\uff0c\u6c42\u51fa\u6bcf\u6b21\u6eda\u5230\u7684\u65b9\u683c\u4e0a\u7684\u6570\u548c\u6b64\u65f6\u9ab0\u5b50\u5e95\u9762\u7684\u6570\u5b57\u4e58\u79ef\u4e4b\u548c\u7684\u6700\u5927\u503c\u3002\n\n~~\u65b9\u683c\u53d6\u6570\u8fdb\u9636\u7248~~\n\n## \u601d\u8def\n\n\u663e\u7136\uff0c\u5f53\u786e\u5b9a\u4e86\u4e00\u4e2a\u9ab0\u5b50\u7684\u4e24\u4e2a\u9762\u65f6\uff0c\u5c31\u53ef\u4ee5\u786e\u5b9a\u8fd9\u4e2a\u9ab0\u5b50\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5c06\u66b4\u529b dp \u964d\u7ef4\u3002\n\n\u5b9a\u4e49 $f_{i,j,k,t}$ \u8868\u793a\u5f53\u9ab0\u5b50\u6eda\u5230\u5750\u6807 $(i,j)$ \u65f6\u4e14\u9ab0\u5b50\u6b63\u4e0a\u65b9\u7f16\u53f7\u4e3a $k$\uff0c\u524d\u65b9\u7f16\u53f7\u4e3a $k$ \u65f6\u7684\u6700\u5927\u503c\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u53ea\u9700\u5224\u65ad\u5f53\u524d\u7684\u9ab0\u5b50\u72b6\u6001\u662f\u5426\u786e\u5b9a\uff0c\u5982\u679c\u786e\u5b9a\u4e86\uff0c\u5c31\u53ef\u4ee5\u786e\u5b9a\u5b83\u4e0b\u65b9\u548c\u53f3\u65b9\u7684\u70b9\uff0c\u53cd\u4e4b\u8df3\u8fc7\u3002\n\n\u5b9a\u4e49 $b_i$ \u8868\u793a\u7f16\u53f7\u4e3a $i$ \u7684\u9762\u6240\u5bf9\u7684\u53cd\u9762\uff0c$r_{i,j}$ \u8868\u793a\u5f53\u6b63\u65b9\u4f53\u4e0a\u9762\u4e3a $i$ \uff0c\u524d\u9762\u4e3a $j$ \u65f6\u53f3\u9762\u7684\u7f16\u53f7\uff0c\u4f8b\u5982\uff1a\n\n$\\begin{cases}b_{\\text{Left}}=\\text{Right}\\\\\nr_{\\text{Up,Front}}=\\text{Right}\\end{cases}$\n\n\u6613\u5f97\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5982\u4e0b\uff1a\n\n$\\begin{cases}f_{i+1,j,b_t,k}=\\max\\{f_{i+1,j,b_t,k},f_{i,j,k,t}+w_t\\times a_{i+1,j}\\}\\\\\nf_{i,j+1,b_{r_{k,t}},t}=\\max\\{f_{i,j+1,b_{r_{k,t}},t},f_{i,j,k,t}+w_{r_{k,t}}\\times a_{i,j+1}\\}\\end{cases}$\n\n```cpp\n#include<bits/stdc++.h>\n#define Front 1\n#define Back 2\n#define Left 3\n#define Right 4\n#define Up 5\n#define Down 6 \nusing namespace std;\nconst int N=1e3+5;\nconst int M=7;\nconst int INF=0x3f3f3f3f;\nint a[N][N];\nint f[N][N][M][M];\nint w[M];\nint r[M][M];\nint b[M]={0,2,1,4,3,6,5};\nvoid init(){\n\tr[Front][Left]=Down,r[Front][Right]=Up,r[Front][Up]=Left,r[Front][Down]=Right;\n\tr[Back][Left]=Up,r[Back][Right]=Down,r[Back][Up]=Right,r[Back][Down]=Left;\n\tr[Left][Front]=Up,r[Left][Back]=Down,r[Left][Up]=Back,r[Left][Down]=Front;\t\n\tr[Right][Front]=Down,r[Right][Back]=Up,r[Right][Up]=Front,r[Right][Down]=Back;\n\tr[Up][Front]=Right,r[Up][Back]=Left,r[Up][Left]=Front,r[Up][Right]=Back;\n\tr[Down][Front]=Left,r[Down][Back]=Right,r[Down][Left]=Back,r[Down][Right]=Front;\n}\nint n,m;\nint main(){\n\tcin>>n>>m;\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++)\n\t\t\tcin>>a[i][j];\n\tfor(int i=1;i<=6;i++)\n\t\tcin>>w[i];\n\tmemset(f,-INF,sizeof(f));\n\tinit(); \n\tf[1][1][5][1]=a[1][1]*w[6];\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++)\n\t\t\tfor(int k=1;k<=6;k++)\n\t\t\t\tfor(int t=1;t<=6;t++){\n\t\t\t\t\tif(r[k][t]==0)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tif(f[i][j][k][t]!=-INF){\n\t\t\t\t\t\tf[i+1][j][b[t]][k]=max(f[i+1][j][b[t]][k],f[i][j][k][t]+w[t]*a[i+1][j]);\n\t\t\t\t\t\tf[i][j+1][b[r[k][t]]][t]=max(f[i][j+1][b[r[k][t]]][t],f[i][j][k][t]+w[r[k][t]]*a[i][j+1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\tint num=-INF;\n\tfor(int i=1;i<=6;i++)\n\t\tfor(int j=1;j<=6;j++)\n\t\t\tnum=max(num,f[n][m][i][j]);\n\tcout<<num<<endl;\n\treturn ~~(0^0);\n}\n```",
        "postTime": 1664769252,
        "uid": 600442,
        "name": "Lucas_Long",
        "ccfLevel": 0,
        "title": "P8488\u9898\u89e3"
    },
    {
        "content": "~~\u8b66 \u60d5 \u5927 \u5e38 \u6570 \u9898 \u89e3 \u5165 \u4fb5 \u9898 \u89e3 \u533a\u3002~~\n\n------------\n\u770b\u5230\u8fd9\u9053\u9898\u9ab0\u5b50\u7684\u8fd0\u52a8\u65b9\u5f0f\uff0c\u6211\u4eec\u4f1a\u60f3\u5230\u65b9\u683c\u53d6\u6570\u8fd9\u9053\u9898\u3002\u8003\u8651 dp\u3002\u548c\u65b9\u683c\u53d6\u6570\u4e00\u6837\uff0c\u9ab0\u5b50\u53ea\u80fd\u5411\u4e0b\u8d70\u6216\u8005\u5411\u53f3\u8d70\uff0c\u4e0d\u4f1a\u5f80\u56de\u8d70\uff0c\u6240\u4ee5\u5982\u679c\u5c06\u9ab0\u5b50\u4e0a\u7684\u6570\u5b57\u5168\u90e8\u8bbe\u4e3a $1$ \uff0c\u76f4\u63a5\u8bbe $f_{i,j}$ \u8868\u793a\u6eda\u5230\u70b9 $(i,j)$ \u4e4b\u540e\u6240\u80fd\u83b7\u5f97\u7684\u6700\u5927\u7b54\u6848\u662f\u4e0d\u4f1a\u6709\u540e\u6548\u6027\u7684\u3002\n\n\u4e0d\u8fc7\u8fd9\u9053\u9898\u7684\u7b54\u6848\u8fd8\u548c\u76ee\u524d\u9ab0\u5b50\u7684\u72b6\u6001\u606f\u606f\u76f8\u5173\uff0c\u76f8\u5f53\u6734\u7d20\u7684\u505a\u6cd5\u5c31\u662f\u518d\u7ed9 dp \u6570\u7ec4\u5f00\u516d\u7ef4\uff0c\u5c06\u9ab0\u5b50\u76ee\u524d\u7684\u516d\u4e2a\u65b9\u5411\uff08\u4e5f\u5c31\u662f\u9898\u76ee\u4e2d\u7684 up down front back left right\uff09\u6240\u5bf9\u5e94\u7684\u7f16\u53f7 \uff08\u8fd9\u91cc\u7684\u7f16\u53f7\u5c31\u662f $w$ \u6570\u7ec4\u7684\u4e0b\u6807\uff09 \u8bb0\u5f55\u4e0b\u6765\uff0c\u679a\u4e3e\u72b6\u6001\u7684\u590d\u6742\u5ea6\u4e3a $\\mathop{O(6^6\\times nm)}$\uff0c\u65e0\u6cd5\u901a\u8fc7\u672c\u9898\u3002\n\n\u5176\u5b9e\u5bf9\u4e8e\u672c\u9898\u6765\u8bf4\uff0c\u6211\u4eec\u53ea\u8981\u7ed9 dp \u6570\u7ec4\u518d\u5f00\u4e24\u7ef4\u5373\u53ef\uff0c\u8fd9\u4e24\u7ef4\u5206\u522b\u8bb0\u5f55\u76ee\u524d\u9ab0\u5b50\u4e2d\u7684 front \u548c right \u5bf9\u5e94\u7684\u7f16\u53f7\u662f\u4ec0\u4e48\u3002\u56e0\u4e3a\u6211\u4eec\u4ec5\u6839\u636e\u76ee\u524d front \u548c right \u7684\u7f16\u53f7\u5c31\u80fd\u63a8\u51fa\u76ee\u524d\u6574\u4e2a\u9ab0\u5b50\u662f\u4ec0\u4e48\u72b6\u51b5\u3002\u5bf9\u4e8e\u9898\u76ee\u4e2d\u7684\u4e24\u79cd\u64cd\u4f5c\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u6a21\u62df\u51fa\u8fdb\u884c\u64cd\u4f5c\u4e4b\u540e\u7684\u9ab0\u5b50 front \u548c right \u7684\u72b6\u6001\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathop{O(6^2\\times nm)}$\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n\u7531\u4e8e\u672c\u4eba\u5f88\u83dc\uff0c\u4e0d\u4f1a\u63a8\u4ec0\u4e48\u5389\u5bb3\u7684\u89c4\u5f8b\uff0c\u6240\u4ee5\u76f4\u63a5\u5206\u7c7b\u8ba8\u8bba\u51fa\u4e86\u4e2a ```get_down``` \u51fd\u6570\uff0c\u8868\u793a\u5728\u76ee\u524d front \u548c right \u90fd\u786e\u5b9a\u7684\u60c5\u51b5\u4e0b\u9ab0\u5b50\u5e95\u9762\u7684\u7f16\u53f7\u3002~~\u8bfb\u8005\u670b\u53cb\u4eec\u53ef\u4ee5\u81ea\u884c\u753b\u56fe\u63a8\u4e00\u63a8\u3002~~ \u6ce8\u610f\u7531\u4e8e\u5224\u65ad\u7684\u6b21\u6570\u8f83\u591a\uff0c\u5e38\u6570\u8f83\u5927\uff0c\u6240\u4ee5\u63a8\u8350\u591a\u7528 ```else```\uff0c\u5c3d\u53ef\u80fd\u7684\u964d\u4f4e\u5224\u65ad\u6b21\u6570\u3002\n\n\u6ce8\u610f\u5728\u4ee5\u4e0b\u4ee3\u7801\u4e2d\uff0c\u9ab0\u5b50\u7684\u521d\u59cb\u72b6\u6001\u548c\u9898\u76ee\u63cf\u8ff0\u4e2d\u7684\u4e00\u81f4\uff08\u4e5f\u5c31\u662f front \u5bf9\u5e94 $w_0$\uff0cback \u5bf9\u5e94 $w_1$\uff0cleft \u5bf9\u5e94 $w_2$\uff0cright \u5bf9\u5e94 $w_3$\uff0cup \u5bf9\u5e94 $w_4$\uff0cdown \u5bf9\u5e94 $w_5$\uff09\u3002\n\n### Code\n```cpp\n//Coded by weak_shell\n#include<bits/stdc++.h>\nusing namespace std;\n#define pir pair<int,int>\n#define fs first\n#define sc second\nint read()\n{\n    int x=0,fh=1;\n    char ch=getchar();\n    while(!isdigit(ch))\n\t{\n        if(ch=='-') fh=-1;\n        ch=getchar();\n    }\n    while(isdigit(ch))\n\t{\n        x=(x<<1)+(x<<3)+ch-'0';\n        ch=getchar();\n    }\n    return x*fh;\n}\nint a[1005][1005],f[1005][1005][7][7],w[7],n,m;\nint get_down(int x,int y)//x:front y:right\n{\n\tif(x==0)\n\t{\n\t\tif(y==2)return 4;\n\t\telse if(y==3)return 5;\n\t\telse if(y==4)return 3;\n\t\telse if(y==5)return 2;\n\t}\n\telse if(x==1)\n\t{\n\t\tif(y==2)return 5;\n\t\telse if(y==3)return 4;\n\t\telse if(y==4)return 2;\n\t\telse if(y==5)return 3;\n\t}\n\telse if(x==2)\n\t{\n\t\tif(y==0)return 5;\n\t\telse if(y==1)return 4;\n\t\telse if(y==4)return 0;\n\t\telse if(y==5)return 1;\n\t}\n\telse if(x==3)\n\t{\n\t\tif(y==0)return 4;\n\t\telse if(y==1)return 5;\n\t\telse if(y==4)return 1;\n\t\telse if(y==5)return 0;\n\t}\n\telse if(x==4)\n\t{\n\t\tif(y==0)return 2;\n\t\telse if(y==1)return 3;\n\t\telse if(y==2)return 1;\n\t\telse if(y==3)return 0;\n\t}\n\telse if(x==5)\n\t{\n\t\tif(y==0)return 3;\n\t\telse if(y==1)return 2;\n\t\telse if(y==2)return 0;\n\t\telse if(y==3)return 1;\n\t}\n\treturn 6;//\u8fd9\u91cc return 6 \u5c31\u8868\u793a\u8fd9\u79cd\u72b6\u6001\u4e0d\u5b58\u5728 \n}\nsigned main()\n{\n\tcin>>n>>m;\n\tfor(int i=1;i<=n;i++)for(int j=1;j<=m;j++)a[i][j]=read();\n\tfor(int i=0;i<6;i++)w[i]=read();\n\tmemset(f,-0x3f,sizeof(f));\n\tf[1][1][0][3]=a[1][1]*w[5];\n\tfor(int i=1;i<=n;i++)\n\t for(int j=1;j<=m;j++)\n\t {\n\t \tif(i==1&&j==1)continue;\n\t \tfor(int nx=0;nx<6;nx++)for(int ny=0;ny<6;ny++)//\u8fd9\u91cc\u679a\u4e3e\u9ab0\u5b50\u524d\u4e00\u6b65\u7684\u72b6\u6001\n\t \t{\n\t \t\tif(get_down(nx,ny)==6)continue;\n\t \t\tint tx=nx,ty=-1;//\u8bbetx ty \u8868\u793a\u5f53\u9ab0\u5b50\u7684 front \u548c right \u76ee\u524d\u5206\u522b\u4e3a nx ny \u65f6\uff0c\u8fdb\u884c\u67d0\u79cd\u64cd\u4f5c\u4e4b\u540e front \u548c right \u7684\u72b6\u6001\n\t \t\tif(get_down(nx,ny)==5)ty=4;\n\t \t\tif(get_down(nx,ny)==4)ty=5;\n\t \t\tif(get_down(nx,ny)==3)ty=2;\n\t \t\tif(get_down(nx,ny)==2)ty=3;\n\t \t\tif(get_down(nx,ny)==1)ty=0;\n\t \t\tif(get_down(nx,ny)==0)ty=1;\n\t \t\tint td=get_down(tx,ty);\n\t \t\tf[i][j][tx][ty]=max(f[i][j][tx][ty],f[i][j-1][nx][ny]+a[i][j]*w[td]);//\u5411\u4e0b\u4e00\u884c\u7ffb\u6eda\n\t \t\tty=ny,tx=-1;\n\t \t\tif(get_down(nx,ny)==5)tx=4;\n\t \t\tif(get_down(nx,ny)==4)tx=5;\n\t \t\tif(get_down(nx,ny)==3)tx=2;\n\t \t\tif(get_down(nx,ny)==2)tx=3;\n\t \t\tif(get_down(nx,ny)==1)tx=0;\n\t \t\tif(get_down(nx,ny)==0)tx=1;\n\t \t\ttd=get_down(tx,ty);\n\t \t\tf[i][j][tx][ty]=max(f[i][j][tx][ty],f[i-1][j][nx][ny]+a[i][j]*w[td]);//\u5411\u4e0b\u4e00\u5217\u7ffb\u6eda \n\t\t}\n\t }\n\t int ans=-1e9;\n\t for(int i=0;i<6;i++)for(int j=0;j<6;j++)ans=max(ans,f[n][m][i][j]);\n\t printf(\"%d\",ans);\n}\n```\n\n\u611f\u8c22\u9605\u8bfb\uff01",
        "postTime": 1661266239,
        "uid": 19228,
        "name": "\u849f\u84bb\u7092\u6247\u8d1d",
        "ccfLevel": 6,
        "title": "P8488 \u9898\u89e3"
    },
    {
        "content": "## \u601d\u8def\n\n\u8bbe $f[i][j][?]$ \u8868\u793a\u6b63\u65b9\u4f53\u6eda\u5230 $(i,j)$\uff0c\u4e14\u6b63\u65b9\u4f53\u7684\u72b6\u6001\uff08\u671d\u5411\uff09\u4e3a ? \u7684\u7b54\u6848\u3002\n\n\u5982\u4f55\u8868\u793a\u6b63\u65b9\u4f53\u7684\u72b6\u6001\uff1f\n\n~~\u5c0f\u5b66\u5965\u6570~~\u521d\u4e2d\u6570\u5b66\u6211\u4eec\u5b66\u8fc7\u4e09\u89c6\u56fe\u3002\n\n\u5bf9\u4e8e\u672c\u9898\uff0c\u6211\u4eec\u8bb0\u5f55\u4e09\u4e2a\u65b9\u5411\u5373\u53ef\u3002\n\n\u6211\u7684\u4ee3\u7801\u4e2d\uff1a$[o][p][q]$ \u4e3a\u4e0b\u9762\uff08\u8d34\u7740\u68cb\u76d8\u7684\u90a3\u4e2a\uff09\u662f $o$\uff0c\u6b63\u5bf9\u7740\u4f60\u7684\uff08\u5f80 $(i+1,j)$ \u7ffb\u8f6c\u5c31\u8d34\u7740\u5730\u7684\u90a3\u4e2a\uff09\u662f $p$\uff0c\u53f3\u8fb9\u7684\uff08\u5f80 $(i,j+1)$ \u7ffb\u8f6c\u5c31\u8d34\u7740\u5730\u7684\u90a3\u4e2a\uff09\u662f $q$\u3002\n\n\u5224\u65ad\u72b6\u6001\u5408\u6cd5\uff1a$o,p,q$ \u5fc5\u987b\u662f\u4e0d\u540c\u65b9\u5411\uff0c\u4e5f\u5c31\u662f\u8bf4\u65e2\u4e0d\u80fd\u76f8\u540c\u4e5f\u4e0d\u80fd\u76f8\u5bf9\u3002\n\n\u8c8c\u4f3c\u5361\u7a7a\u95f4\uff1f\u7528\u4e86\u6eda\u52a8\u6570\u7ec4\u3002\n\n## code\n\n```cpp\n#include<stdio.h>\n#include<string.h>\n#define N 1000\ninline char nc()\n{\n\tstatic char buf[99999],*l,*r;\n\treturn l==r&&(r=(l=buf)+fread(buf,1,99999,stdin),l==r)?EOF:*l++;\n}\ninline void read(int&x)\n{\n\tbool t=0;char c=nc();for(;c<'0'||'9'<c;t|=c=='-',c=nc());\n\tfor(x=0;'0'<=c&&c<='9';x=(x<<3)+(x<<1)+(c^48),c=nc());if(t)x=-x;\n}\nint n,m,a[N][N],f[2][N][6][6][6],w[6],ans=-(1<<30);\ninline int max(const int&x,const int&y){return x>y?x:y;}\nmain()\n{\n\tread(n);read(m);\n\tfor(int i=0;i<n;++i)for(int j=0;j<m;read(a[i][j++]));\n\tfor(int i=0;i<6;read(w[i++]));\n\tmemset(f,0xbb,sizeof(f));\n\tf[0][0][5][0][3]=a[0][0]*w[5];\n\tfor(int j=1;j<m;++j)for(int o=0;o<6;++o)for(int p=0;p<6;++p)\n\t\tif((o^p)&&(o^p^1))for(int q=0;q<6;++q)if((o^q)&&(o^q^1))\n\t\t\tif((p^q)&&(p^q^1))\n\t\t\t\tf[0][j][o][p][q]=f[0][j-1][q^1][p][o]+a[0][j]*w[o];//\u7b2c\u4e00\u884c\n\tfor(int i=1;i<n;++i)\n\t{\n\t\tfor(int o=0;o<6;++o)for(int p=0;p<6;++p)\n\t\t\tif((o^p)&&(o^p^1))for(int q=0;q<6;++q)if((o^q)&&(o^q^1))\n\t\t\t\tif((p^q)&&(p^q^1))\n\t\t\t\t\tf[i&1][0][o][p][q]=f[i&1^1][0][p^1][o][q]+a[i][0]*w[o];//\u7b2c\u4e00\u5217\n\t\tfor(int j=1;j<m;++j)for(int o=0;o<6;++o)for(int p=0;p<6;++p)\n\t\t\tif((o^p)&&(o^p^1))for(int q=0;q<6;++q)if((o^q)&&(o^q^1))\n\t\t\t\tif((p^q)&&(p^q^1))\n\t\t\t\t\tf[i&1][j][o][p][q]=max(f[i&1][j-1][q^1][p][o],\n\t\t\t\t\t\tf[i&1^1][j][p^1][o][q])+a[i][j]*w[o];\n\t}\n\tfor(int o=0;o<6;++o)for(int p=0;p<6;++p)if((o^p)&&(o^p^1))\n\t\tfor(int q=0;q<6;++q)if((o^q)&&(o^q^1)&&(p^q)&&(p^q^1))\n\t\t\tans=max(ans,f[n&1^1][m-1][o][p][q]);\n\tprintf(\"%d\",ans);\n}\n```",
        "postTime": 1661253414,
        "uid": 90693,
        "name": "_\u2022\u0301\u3078\u2022\u0301\u256c_",
        "ccfLevel": 7,
        "title": "P8488 \u300cWdoi-(-1)\u300d\u604b\u5f39\u8005\u4eec\u7684\u9ed1\u96c6\u5e02"
    },
    {
        "content": "## \u7b80\u8981\u9898\u610f\n\u6709\u4e00\u4e2a $n\\times m$ \u5927\u5c0f\u7684\u68cb\u76d8\uff0c\u7b2c $i$ \u884c\u7b2c $j$ \u5217\u5199\u6709\u6570\u5b57 $a_{i-1,j-1}$\u3002\n\n\u73b0\u5728\u6709\u4e00\u4e2a\u9ab0\u5b50\uff0c\u516d\u4e2a\u9762\u6309\u7167\u524d\u3001\u540e\u3001\u5de6\u3001\u53f3\u3001\u4e0a\u3001\u4e0b\u7684\u987a\u5e8f\uff0c\u4f9d\u6b21\u5199\u6709\u6570\u5b57 $w_0,w_1,w_2,w_3,w_4,w_5$\u3002\u73b0\u5728\u9ab0\u5b50\u6446\u653e\u5728 $(0,0)$ \u4f4d\u7f6e\uff0c\u9700\u8981\u5c06\u5b83\u6eda\u52a8\u81f3 $(n-1,m-1)$\u3002\n\n\u9ab0\u5b50\u53ea\u6709\u4e24\u79cd\u65b9\u5f0f\u6eda\u52a8\uff1a\u5411\u4e0b\u4e00\u884c\u7ffb\u6eda\u3001\u5411\u4e0b\u4e00\u5217\u7ffb\u6eda\u3002\u6211\u4eec\u8bb0\u4e00\u79cd\u65b9\u6848\u7684\u6743\u503c\u4e3a\uff0c\u6574\u4e2a\u8fc7\u7a0b\u4e2d\uff08\u5305\u62ec\u9ab0\u5b50\u5728\u8d77\u70b9\u548c\u7ec8\u70b9\u65f6\uff09\uff0c\u9ab0\u5b50\u6700\u5e95\u9762\u4e0a\u5199\u7740\u7684\u6570\u5b57\uff0c\u4e0e\u6b64\u65f6\u9ab0\u5b50\u6240\u5728\u683c\u5b50\u4e0a\u5199\u7740\u7684\u6570\u5b57\u7684\u4e58\u79ef\u4e4b\u548c\u3002\n\n\u73b0\u5728\u4f60\u9700\u8981\u6700\u5927\u5316\u8fd9\u4e2a\u4e58\u79ef\u4e4b\u548c\u3002\n## \u601d\u8def\n**\u4e00\u773cdp**\n\n### \u72b6\u6001\n\u7531\u4e8e\u9ab0\u5b50\u7684\u524d\u3001\u540e\u3001\u5de6\u3001\u53f3\u3001\u4e0a\u3001\u4e0b\u4f9d\u6b21\u5199\u6709**\u786e\u5b9a\u7684**\u6570\u5b57 $w_0,w_1,w_2,w_3,w_4,w_5$\u3002\u6240\u4ee5**\u53ea\u8981\u786e\u5b9a\u76ee\u524d\u9ab0\u5b50\u7684\u524d\u9762\u548c\u53f3\u4fa7\u7684\u6570\u5b57\uff0c\u5c31\u53ef\u4ee5\u786e\u5b9a\u6574\u4e2a\u9ab0\u5b50\u7684\u72b6\u6001**\u3002\n\u4e8e\u662f\u5c31\u53ef\u4ee5\u5b9a\u4e0b\u72b6\u6001:  \n$f[i][j][q][y]$ \u8868\u793a\u9ab0\u5b50\u5728\u7b2c $i$ \u884c\u7b2c $j$ \u5217\u524d\u9762\u6570\u5b57\u4e3a $w_q$ \u53f3\u8fb9\u6570\u5b57\u4e3a $w_y$ \u65f6\u6700\u5927\u7684\u4e58\u79ef\u4e4b\u548c\u4e3a\u591a\u5c11\u3002\n\n### \u8f6c\u79fb\u65b9\u7a0b\n\u7136\u540e\u5c31\u662f\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff08\u6211\u7528\u5237\u8868\uff09~~\u8fd9\u5e94\u8be5\u5f88\u7b80\u5355\u5427~~\uff1a \n\n$f[i+1][j][U(q,y)][y]=\\max (f[i+1][j][U(q,y)][y],f[i][j][q][y]+a[i+1][j] \\times w[q])$\n\n$f[i][j+1][q][U(q,y)]=\\max(f[i][j+1][q][U(q,y)],f[i][j][q][y]+a[i][j+1] \\times w[y])$\n\n$U(q,y)$ \u8868\u793a\u524d\u9762\u6570\u5b57\u4e3a $w_q$ \u53f3\u8fb9\u6570\u5b57\u4e3a $w_y$ \u65f6\u4e0a\u9762\u7684\u6570\u5b57\u4e3a $w_{U(q,y)}$\n\n### \u521d\u59cb\u5316\n\u91cd\u8981\u7684\u662f**\u521d\u59cb\u5316**\uff0c\u56e0\u4e3a $f[i][j][q][y]$ (\u4e0d\u4f1a\u7206int)\u53ef\u80fd\u4e3a\u8d1f\u6570\uff0c\u6240\u4ee5\u521d\u59cb\u5316\u4e3a $0xcfcfcfcf$\u3002  \n**\u6700\u5f00\u59cb\u7684\u72b6\u6001** $f[1][1][0][3]$ \u4e3a $a[1][1]\\times w[5]$\u3002\n\n\u5269\u4e0b\u7684\u5c31\u770b\u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nint n, m, a[1005][1005], w[6];\nint f[1005][1005][6][6], ans = 0xcfcfcfcf;\n\nint U(int q, int y) {\n\tif (q == 0) {\n\t\tif (y == 2) return 5;if (y == 3) return 4;\n\t\tif (y == 4) return 2;if (y == 5) return 3;\n\t}\n\tif (q == 1) {\n\t\tif (y == 2) return 4;if (y == 3) return 5;\n\t\tif (y == 4) return 3;if (y == 5) return 2;\n\t}\n\tif (q == 2) {\n\t\tif (y == 0) return 4;if (y == 1) return 5;\n\t\tif (y == 4) return 1;if (y == 5) return 0;\n\t}\n\tif (q == 3) {\n\t\tif (y == 0) return 5;if (y == 1) return 4;\n\t\tif (y == 4) return 0;if (y == 5) return 1;\n\t}\n\tif (q == 4) {\n\t\tif (y == 0) return 3;if (y == 1) return 2;\n\t\tif (y == 2) return 0;if (y == 3) return 1;\n\t}\n\tif (q == 5) {\n\t\tif (y == 0) return 2;if (y == 1) return 3;\n\t\tif (y == 2) return 1;if (y == 3) return 0;\n\t}\n}\n\nint main() {\n\tscanf(\"%d%d\", &n, &m);\n\tfor (int i = 1; i <= n; ++i)\n\t\tfor (int j = 1; j <= m; ++j)\n\t\t\tscanf(\"%d\", &a[i][j]);\n\tscanf(\"%d%d%d%d%d%d\", &w[0], &w[1], &w[2], &w[3], &w[4], &w[5]);\n\tmemset(f, 0xcf, sizeof(f));\n\tf[1][1][0][3] = a[1][1] * w[5];\n\tfor (int i = 1; i <= n; ++i)\n\t\tfor (int j = 1; j <= m; ++j)\n\t\t\tfor (int q = 0; q < 6; ++q)\n\t\t\t\tfor (int y = 0; y < 6; ++y)\n\t\t\t\t\tif (f[i][j][q][y] != 0xcfcfcfcf) {\n\t\t\t\t\t\tf[i + 1][j][U(q, y)][y] = max(f[i + 1][j][U(q, y)][y], f[i][j][q][y] + a[i + 1][j] * w[q]);\n\t\t\t\t\t\tf[i][j + 1][q][U(q, y)] = max(f[i][j + 1][q][U(q, y)], f[i][j][q][y] + a[i][j + 1] * w[y]);\n\t\t\t\t\t}\n\tfor (int q = 0; q < 6; ++q)\n\t\tfor (int y = 0; y < 6; ++y)\n\t\t\tans = max(ans, f[n][m][q][y]);\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n```\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(6^2\\times nm)$\u3002\n",
        "postTime": 1666707635,
        "uid": 367677,
        "name": "lyt_awa",
        "ccfLevel": 5,
        "title": "P8488 \u300cWdoi-(-1)\u300d\u604b\u5f39\u8005\u4eec\u7684\u9ed1\u96c6\u5e02\u9898\u89e3"
    },
    {
        "content": "# \u601d\u8def\n\n\u770b\u5230\u9898\u76ee\u53d1\u73b0\u548c\u65b9\u683c\u53d6\u6570\u975e\u5e38\u76f8\u4f3c\uff0c\u9664\u4e86\u9898\u76ee\u91cc\u591a\u4e86\u4e00\u4e2a\u9ab0\u5b50(\u8fd9\u4e2a\u9ab0\u5b50\u540c\u65f6\u4e5f\u662f\u9898\u76ee\u96be\u70b9)\u3002\n\n~~\u77e5\u5468\u6240\u4f17~~\uff0c\u53ea\u8981\u786e\u5b9a\u9ab0\u5b50\u7684\u4e24\u4e2a\u9762\uff0c\u5c31\u80fd\u786e\u5b9a\u9ab0\u5b50\u7684\u72b6\u6001\u3002\n\n\u6240\u4ee5\u4f7f\u7528\u4e00\u4e2a\u56db\u7ef4\u6570\u7ec4\u6765\u8bb0\u5f55\u3002\n\n**$dp_{i,j,k,q}$ \u8868\u793a\u5728\u5750\u6807\u4e3a $(i,j)$ \u65f6\u9ab0\u5b50\u524d\u9762\u7684\u9762\u4e3a $k$\uff0c\u53f3\u8fb9\u7684\u9762\u4e3a $q$\u3002**\n\n\u6b64\u65f6\u82e5\u5f80\u524d\u8d70\uff0c\u7528\u4e0a\u9762\u7684\u9762\u66ff\u4ee3\u524d\u9762\u7684\u9762\uff0c\u82e5\u5f80\u53f3\u8d70\uff0c\u7528\u4e0a\u9762\u7684\u9762\u66ff\u4ee3\u53f3\u8fb9\u7684\u9762\uff0c\u6240\u4ee5\u53ea\u9700\u786e\u5b9a\u4e0a\u9762\u7684\u9762\u5373\u53ef\u3002\n\n\u7528\u4e00\u4e2a\u6570\u7ec4 $move1_{i,j}$ \u786e\u5b9a\u524d\u9762\u7684\u9762\u4e3a $i$ \u53f3\u9762\u7684\u9762\u4e3a $j$ \u65f6\u4e0a\u9762\u7684\u9762\u4e3a $move1_{i,j}$\u3002\n\n\u4ee5\u4e0b\u4e3a\u9898\u76ee\u91cd\u70b9\uff0c\u5efa\u8bae\u5927\u5bb6\u81ea\u5df1\u63a8\u4e00\u6b21\uff0c~~\u8fd8\u633a\u6709\u610f\u601d\u7684~~\u3002\n```\nint move1[8][8]={0,0,0,0,0,0,0,0,0,0,0,6,5,3,4,0,0,0,0,5,6,4,3,0,0,5,6,0,0,2,1,0,0,6,5,0,0,1,2,0,0,4,3,1,2,0,0,0,0,3,4,2,1};\n```\n\u6240\u4ee5\u76f4\u63a5\u7528 $dp$\uff0c\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u975e\u5e38\u5bb9\u6613\u60f3\u5230\uff1a\n\n$\\begin{cases}\nf_{i+1,j,move1_{k,q},q}=\\max\\left \\{ f_{i+1,j,move1_{k,q},q},f_{i,j,k,q}+w_k*a_{i+1,j} \\right \\}\n \\\\\nf_{i,j+1,k,move1_{k,q}}=\\max\\left \\{ f_{i,j+1,k,move1_{k,q}},f_{i,j,k,q}+w_q*a_{i,j+1} \\right \\} \n\\end{cases}$\n\n# \u4ee3\u7801\n\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1e3+5;\nint n,m,ans=0xcfcfcfcf,w[10],a[N][N],dp[N][N][7][7];\nint move1[8][8]={0,0,0,0,0,0,0,0,0,0,0,6,5,3,4,0,0,0,0,5,6,4,3,0,0,5,6,0,0,2,1,0,0,6,5,0,0,1,2,0,0,4,3,1,2,0,0,0,0,3,4,2,1};\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=1;j<=m;j++){\n\t\t\tscanf(\"%d\",&a[i][j]);\n\t\t}\n\t}\n\tfor(int i=1;i<=6;i++){\n\t\tscanf(\"%d\",&w[i]);\n\t}\n\tmemset(dp,0xcf,sizeof(dp));\n\tdp[1][1][1][4]=w[6]*a[1][1];\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=1;j<=m;j++){\n\t\t\tfor(int k=1;k<=6;k++){\n\t\t\t\tfor(int q=1;q<=6;q++){\n\t\t\t\t\tif(dp[i][j][k][q]!=0xcfcfcfcf){\n\t\t\t\t\t\tif(move1[k][q])dp[i+1][j][move1[k][q]][q]=max(dp[i+1][j][move1[k][q]][q],dp[i][j][k][q]+w[k]*a[i+1][j]);\n\t\t\t\t\t\tif(move1[k][q])dp[i][j+1][k][move1[k][q]]=max(dp[i][j+1][k][move1[k][q]],dp[i][j][k][q]+w[q]*a[i][j+1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=6;i++){\n\t\tfor(int j=1;j<=6;j++){\n\t\t\tans=max(ans,dp[n][m][i][j]);\n\t\t}\n\t}\n\tprintf(\"%d\",ans);\n\treturn 0;\n}\n```\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(6^2\u00d7nm)$ \t~~\u4e1d\u6beb\u4e0d\u614c~~ \u3002",
        "postTime": 1666270921,
        "uid": 698657,
        "name": "free_fall",
        "ccfLevel": 5,
        "title": "P8488 \u300cWdoi-(-1)\u300d\u604b\u5f39\u8005\u4eec\u7684\u9ed1\u96c6\u5e02 \u9898\u89e3"
    },
    {
        "content": "[P8488 \u300cWdoi-(-1)\u300d\u604b\u5f39\u8005\u4eec\u7684\u9ed1\u96c6\u5e02](https://www.luogu.com.cn/problem/P8488)\n\n2022/8/24 upd \uff1a\u66f4\u6539\u90e8\u5206 latex \u3002\n\n\u9898\u76ee\u5927\u610f\uff1a\u7528\u4e00\u4e2a\u9ab0\u5b50\u5728 $n\\times m$ \u7684\u68cb\u76d8\u4e0a\u6eda\uff0c\u4ece $(1,1)$ \u6eda\u5230 $(n,m)$ \uff0c\u6bcf\u6b21\u53ef\u4ee5\u5411\u4e0b\u6eda\u6216\u8005\u5411\u53f3\u6eda\uff0c\u8981\u6c42\u6700\u5927\u5316\u6bcf\u6b21\u6eda\u5230\u7684\u65b9\u683c\u4e0a\u7684\u6570 $\\times$ \u6b64\u65f6\u9ab0\u5b50\u5e95\u9762\u7684\u6743\u503c\u4e4b\u548c\u3002\n\n\u6b64\u9898\u539f\u6765\u662f\u4e00\u7bc7\u9605\u8bfb\u7406\u89e3\uff0c\u6211\u5bf9\u7740\u4ee3\u7801\u4e2d\u90a3\u4e2a\u8be1\u5f02\u7684find_down\u51fd\u6570\u7684\u5f02\u6216\u731c\u4e86\u534a\u4e2a\u5c0f\u65f6~~\u8fd8\u662f\u53d1\u7535\u7684\u6a21\u62df\u4e8610min~~\u540e\u624d\u770b\u51fa\u6765\u8fd9\u4e2a\u9898\u9762\uff0c\u4e3a\u4e86\u7eaa\u5ff5\u4e00\u4e0b\u8fd9\u9053\u9898\u76ee\uff0c\u5199\u7bc7\u9898\u89e3\uff08\u96fe\uff09\u3002\n\n\n\n\u53ef\u4ee5\u53d1\u73b0\u672c\u9898\u5c31\u662f\u65b9\u683c\u53d6\u6570\u7684\u8fdb\u9636\u7248\u672c\uff0c\u90a3\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u8003\u8651\u8bbe\u8ba1\u72b6\u6001\uff1a\n\n\n\n\u8bbe $dp_{i,j,k,t}$ \u7684\u610f\u4e49\u4e3a\u5f53\u9ab0\u5b50\u6eda\u5230 $(i,j)$ \u65f6\u9ab0\u5b50\u7684\u6b63\u4e0a\u65b9\u9762\u7684\u7f16\u53f7\u4e3a $k$ \uff0c\u6b63\u524d\u65b9\u7f16\u53f7\u4e3a $t$ \u7684\u6700\u5927\u503c\u3002\u56e0\u4e3a\u5f53\u4e00\u4e2a\u9ab0\u5b50\u88ab\u786e\u5b9a\u4e24\u9762\u65f6\uff0c\u5b83\u7684\u72b6\u6001\u5c31\u662f\u56fa\u5b9a\u7684\u3002\uff08\u53ef\u4ee5\u81ea\u5df1\u8bd5\u7740\u6a21\u62df\u4e00\u4e0b\uff09\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5df2\u7ecf\u88ab\u786e\u5b9a\u7684 $dp_{i,j,k,t}$ \uff0c\u53bb\u66f4\u65b0\u5b83\u4e0b\u65b9\u4e0e\u53f3\u65b9\u7684\u70b9\u3002\u5bf9\u4e8e\u9ab0\u5b50\u7684\u72b6\u6001\u6211\u4eec\u5219\u53ef\u4ee5~~\u5927 \u529b \u6253 \u8868~~\u8f6c\u79fb\u3002\n\n\n\ndp\u65b9\u7a0b\uff1a\n$$\n\\left\\{\n\\begin{aligned}\ndp_{i+1,j,back(t),k}&=\\max(dp_{i,j,back(t),k},dp_{i,j,k,t}+w_t\\times a_{i+1,j})\\\\\ndp_{i,j+1,back(rightface(k,t)),t}&=\\max(dp_{i,j+1,back(rightface(k,t)),t},dp_{i,j,k,t}+w_{rightface(k,t)}\\times a_{i,j+1})\n\\end{aligned}\n\\right.\n$$\n\u5176\u4e2d $back(t)$ \u8868\u793a\u7f16\u53f7\u4e3a $t$ \u7684\u9762\u7684\u6b63\u65b9\u4f53\u6240\u5bf9\u7684\u53cd\u9762\uff08\u4f8b\u5982 $Front$ \u5bf9\u5e94 $Back$ \uff09\uff0c $rightface(k,t)$ \u8868\u793a\u5f53\u6b63\u65b9\u4f53\u4e0a\u8868\u9762\u4e3a $k$ \uff0c\u524d\u8868\u9762\u4e3a $t$ \u65f6\u53f3\u8868\u9762\u7684\u7f16\u53f7\uff08\u5982 $fightface(Up,Front)$ \u5c31\u5bf9\u5e94 $Right$ \uff09\u3002\n\n\u56e0\u4e3a\u6211\u4ee3\u7801\u5199\u7684\u662f\u9ed8\u8ba4\u4ece $1$ \u5f00\u59cb\uff0c\u8fd9\u91cc\u653e\u5f20\u56fe\u4fbf\u4e8e\u7406\u89e3\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/h9yd2vus.png)\n\n\u603b\u4f53\u65f6\u95f4\u590d\u6742\u5ea6 $O(6^2\\times nm)$ \u3002\u4ee3\u7801\u5199\u7684\u6bd4\u8f83\u7b80\u6d01\uff0c\u56e0\u4e3a\u8003\u573a\u4e0a~~\u6df1\u53d7\u5f02\u6216\u6bd2\u5bb3~~\u3002\n\n\n\nAC code:\n\n```C++\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=1e3+10;\nconst int INF=0x3f3f3f3f;\nint a[maxn][maxn];\nint dp[maxn][maxn][7][7];\nint w[7];\n/*\n\u8bbedp[i][j][k][t]\u4e3a\u6eda\u5230a[i][j]\u65f6\u7acb\u65b9\u4f53\u7684\u4e0a\u8868\u9762\u7f16\u53f7\u4e3ak\uff0c\u524d\u8868\u9762\u7f16\u53f7\u4e3at\u65f6\u7684\u6700\u5927\u6570\u503c \n\u6839\u636e\u56fe\uff0c\u53ef\u77e5\u7acb\u65b9\u4f53\u7684\u521d\u59cb\u653e\u7f6e\u65b9\u5f0f\u4e3aw5\u671d\u4e0a\uff0cw1\u671d\u524d \n\u7531dp[i][j][k][t]\u53ef\u4ee5\u63a8\u51fadp[i+1][j]\u4e0edp[i][j+1]\u7684\u65b0\u503c \n*/\nenum surface\n{\n\tFront=1,Back,Left,Right,Up,Down\n};\nint back[7]={0,2,1,4,3,6,5};\nint rightface[7][7];\nvoid rfinit()\n{\n\trightface[1][6]=4,rightface[1][4]=5,rightface[1][5]=3,rightface[1][3]=6;\n\trightface[2][6]=3,rightface[2][3]=5,rightface[2][5]=4,rightface[2][4]=6;\n\trightface[3][5]=2,rightface[3][2]=6,rightface[3][6]=1,rightface[3][1]=5;\n\trightface[4][5]=1,rightface[4][1]=6,rightface[4][6]=2,rightface[4][2]=5;\n\trightface[5][1]=4,rightface[5][4]=2,rightface[5][2]=3,rightface[5][3]=1;\n\trightface[6][1]=3,rightface[6][3]=2,rightface[6][2]=4,rightface[6][4]=1;\n}\nint main()\n{\n\tios::sync_with_stdio(false);\n\tint n,m;\n\tcin>>n>>m;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=m;j++)\n\t\t{\n\t\t\tcin>>a[i][j];\n\t\t}\n\t}\n\tfor(int i=1;i<=6;i++)\n\t\tcin>>w[i];\n\tmemset(dp,-INF,sizeof(dp));\n\trfinit(); \n\tdp[1][1][5][1]=a[1][1]*w[6];\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=m;j++)\n\t\t{\n\t\t\tfor(int k=1;k<=6;k++)\n\t\t\t{\n\t\t\t\tfor(int t=1;t<=6;t++)\n\t\t\t\t{\n\t\t\t\t\tif(!rightface[k][t])\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tif(dp[i][j][k][t]!=-INF)\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i+1][j][back[t]][k]=max(dp[i+1][j][back[t]][k],dp[i][j][k][t]+w[t]*a[i+1][j]);\n\t\t\t\t\t\tdp[i][j+1][back[rightface[k][t]]][t]=max(dp[i][j+1][back[rightface[k][t]]][t],dp[i][j][k][t]+w[rightface[k][t]]*a[i][j+1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint ans=-INF;\n\tfor(int i=1;i<=6;i++)\n\t\tfor(int j=1;j<=6;j++)\n\t\t\tans=max(ans,dp[n][m][i][j]);\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1661319381,
        "uid": 263414,
        "name": "Sktic",
        "ccfLevel": 6,
        "title": "P8488 \u300cWdoi-(-1)\u300d\u604b\u5f39\u8005\u4eec\u7684\u9ed1\u96c6\u5e02 \u9898\u89e3"
    },
    {
        "content": "\u548b\u4e00\u770b\u600e\u4e48\u50cf\u65b9\u683c\u53d6\u6570\u554a\uff1f\n\n\u8fd9\u9053\u9898\u662f\u6211\u5728\u521d\u8d5b\u6a21\u62df\u4e2d\u505a\u5230\u7684\u4e00\u9053\u9898\u3002\u770b\u5230\u5b83\uff0c\u7279\u522b\u662f\u4e0a\u4e0b\u5de6\u53f3\u524d\u540e\u516d\u4e2a\u65b9\u5411\uff0c\u6211\u60f3\u5230\u4e86\u7acb\u65b9\u4f53\u3002\u679c\u7136\uff0c\u8fd9\u5c31\u662f\u7acb\u65b9\u4f53\u7684\u65cb\u8f6c\u3002\n\n\u6211\u4eec\u8bbe $dp_{i,j,f,r}$ \u4e3a\u7b2c $i$ \u884c\u7b2c $j$ \u5217\uff0c\u9ab0\u5b50\u7684\u524d\u65b9\u4e0e\u53f3\u4fa7\u4e0b\u6807\u5206\u522b\u4e3a $f,r$ \u65f6\u83b7\u5f97\u7684\u6700\u5927\u4ef7\u503c\u3002\u800c\u5e95\u90e8\u7684\u4e0b\u6807\u53ef\u7528\u4e00\u5f20\u4e8c\u7ef4\u8868\u6765\u8868\u793a~~\u6211\u8ba8\u538c\u67af\u71e5\u65e0\u5473\u6d6a\u8d39\u884c\u6570\u7684\u6253\u8868~~\uff0c\u8bb0\u4f5c $d$\u3002\u8fd9\u6837\u6709\u5229\u4e8e\u4fdd\u8bc1\u5176\u5bf9\u79f0\u6027\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u4e00\u4e2a\u72b6\u6001\u53ef\u4ece\u5de6\u65b9\u4e0e\u540e\u65b9\u8f6c\u79fb\u800c\u6765\u3002\u539f\u6765\u5de6\u65b9\u7684 $r$\uff0c\u4ee5\u53ca\u540e\u65b9\u7684 $f$\uff0c\u90fd\u8f6c\u53d8\u6210\u73b0\u5728\u7684 $d$\u3002\u4e8e\u662f\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u51fa\u6765\u4e86\uff1a\n\n$dp_{i,j,f,r}=max\\{dp_{i-1,j,d,r},dp_{i,j-1,f,d}\\}+a_{i,j}\\times w_d$\n\n\u521d\u59cb\u5316\uff0c\u9664\u4e86 $dp_{1,1,0,3}=a_{1,1}\\times w_5$ \u4e4b\u5916\uff0c\u5176\u4f59\u5747\u8d4b\u4e3a $-\\infty$\u3002~~\u6211\u540e\u6765\u624d\u77e5\u9053\u6709\u8d1f\u6570\u2026\u2026~~\n\n\u5148\u5faa\u73af $i,j$\uff0c\u518d\u5faa\u73af $f,r$\uff0c\u6ce8\u610f $f=r$ \uff08\u5bf9\u5e94\u76f8\u7b49\uff09\u4ee5\u53ca $f\\otimes 1=r$ \uff08\u5bf9\u5e94\u76f8\u53cd\uff09\u65f6\u4e0d\u6267\u884c\u3002\n\n\u6700\u540e\u5faa\u73af $f,r$\uff0c\u5bfb\u627e $dp_{n,m,f,r}$ \u7684\u6700\u5927\u503c\u5e76\u8f93\u51fa\u5373\u53ef\u3002\n\n\u4e0a\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1010;\nconst int dw[6][6]={\n{0,0,4,5,3,2},\n{0,0,5,4,2,3},\n{5,4,0,0,0,1},\n{4,5,0,0,1,0},\n{2,3,1,0,0,0},\n{3,2,0,1,0,0}};\n//up=dw^1\ntypedef long long ll;\nint n,m,a[N][N],w[6];\nint f[N][N][6][6];\nsigned main(){\n\tmemset(f,0xc0,sizeof(f));\n\tscanf(\"%d %d\",&n,&m);\n\tfor(int i=1;i<=n;i++)\n\tfor(int j=1;j<=m;j++)\n\tscanf(\"%d\",&a[i][j]);\n\tfor(int i=0;i<6;i++)\n\tscanf(\"%d\",w+i);\n\t//0f 1b 2l 3r 4u 5d\n\t//f[i][j][fr][rt];\n\tf[1][1][0][3]=a[1][1]*w[5];\n\tfor(int i=1;i<=n;i++)\n\tfor(int j=1;j<=m;j++)\n\tfor(int fr=0;fr<6;fr++)\n\tfor(int rt=0;rt<6;rt++){\n\t\tif(fr==rt||(fr^1)==rt||(i==1&&j==1))continue;\n\t\tf[i][j][fr][rt]=max(f[i-1][j][dw[fr][rt]][rt],f[i][j-1][fr][dw[fr][rt]])+w[dw[fr][rt]]*a[i][j];\n\t\t//printf(\"%d \",f[i][j][fr][rt]);\n\t}\n\tint ans=0xc0c0c0c0;\n\tfor(int fr=0;fr<6;fr++)\n\tfor(int rt=0;rt<6;rt++)\n\tans=max(ans,f[n][m][fr][rt]);\n\tprintf(\"%d\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1666625256,
        "uid": 565450,
        "name": "__K2FeO4",
        "ccfLevel": 4,
        "title": "P8488 \u604b\u5f39\u8005\u4eec\u7684\u9ed1\u96c6\u5e02 \u9898\u89e3"
    }
]
[
    {
        "content": "\u663e\u7136\u8fd9\u4e00\u7c7b\u95ee\u9898\u90fd\u6709\u5faa\u73af\u8282\u3002\n\n\u53d1\u73b0\u8fd9\u4e2a\u9898\u76ee\u8ba9\u6211\u4eec\u6c42\u7684\u70b9\u5bf9$(x,y)$\n\n\n$$\\left\\{\\begin{aligned}x\\equiv t+\\lfloor\\frac tB\\rfloor \\pmod {A} \\\\y \\equiv t\\pmod {B} \\end{aligned} \\right.$$\n\n\u6211\u4eec\u8bbe$t_1,t_2$\u4e24\u4e2a\u65f6\u95f4\u70b9\uff0c\u6240\u5f97\u5230\u7684$(x,y)$\u5b8c\u5168\u4e00\u81f4\uff0c\u5373\n\n$$\\left\\{\\begin{aligned}t_1+\\lfloor\\frac {t_1}B\\rfloor \\equiv t_2+\\lfloor\\frac {t_2}B\\rfloor \\pmod {A} \\\\t_1 \\equiv t_2\\pmod {B} \\end{aligned} \\right.$$\n\n\u4e0d\u59a8\u8bbe$t_1<t_2,$\u5219$t_2=t_1+xB(x \\in N^*)$\n\n\u4ee3\u5165\u4e0a\u5f0f\n\n$$t_1+\\lfloor\\frac {t_1}B\\rfloor \\equiv t_1+xB+\\lfloor\\frac {t_1+xB}B\\rfloor \\pmod {A}$$\n\n$$t_1+\\lfloor\\frac {t_1}B\\rfloor \\equiv t_1+xB+\\lfloor x+\\frac {t_1}B\\rfloor \\pmod {A}$$\n\n\u6839\u636e\u9ad8\u65af\u51fd\u6570\u7684\u6027\u8d28\uff0c\u539f\u5f0f\u5316\u4e3a\n\n$$\\lfloor\\frac {t_1}B\\rfloor \\equiv xB+x+\\lfloor\\frac {t_1}B\\rfloor \\pmod {A}$$\n\n$$\\therefore xB+x \\equiv 0 \\pmod {A}$$\n\n$$ A|x(B+1)$$\n\n\u6839\u636e\u6574\u9664\u7684\u6027\u8d28\uff0c\u6216\u8005\u63d0\u53d6\u6700\u5927\u516c\u7ea6\u6570\uff0c\u5f97\n\n$$\\frac {A}{\\gcd(A,B+1)}|x$$\n\n\u6240\u4ee5\u53ea\u8981\u6ee1\u8db3\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u5c31\u53ef\u4ee5\u6ee1\u8db3\u5bf9\u4e8e\u4efb\u610f$t,t+Bx$\u4e0e$t$\u7b49\u4ef7\u3002\n\n\u800c\u4e14\u8fd9\u4e2a\u5f0f\u5b50\u662f**\u5f3a**\u7684\uff0c\u5373\u4e0d\u5b58\u5728\u4e0d\u6ee1\u8db3\u8fd9\u4e2a\u5f0f\u5b50\u4f9d\u65e7\u53ef\u4ee5\u6ee1\u8db3\u6761\u4ef6\u7684$x$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u5f97\u5230\u4e86\u6211\u4eec\u60f3\u8981\u7684\u5faa\u73af\u8282$Bx$\u3002\u663e\u7136$x$\u53d6$\\frac {A}{\\gcd(A,B+1)}$\u6700\u5c0f\u4e14\u6ee1\u8db3\u6761\u4ef6\u3002\n\n\u6b64\u65f6$\\frac {AB}{\\gcd(A,B+1)}$\u5c31\u662f\u6211\u4eec\u8981\u7684\u6700\u5c0f\u5faa\u73af\u8282\u3002\n\n\u8bbe\u6700\u5c0f\u5faa\u73af\u8282\u4e3a$G$\u3002\n\n\u7136\u540e\u6211\u4eec\u5f00\u59cb\u5bf9\u6bcf\u4e00\u4e2a\u7ed9\u5b9a\u7684\u533a\u95f4$[l,r]$\u8fdb\u884c\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n### \u60c5\u51b5$1:$\n\n\u5982\u679c$r-l+1 \\geq G$\uff0c\u5219\u6700\u7ec8\u7b54\u6848\u4e00\u5b9a\u662f$G$\uff0c\u76f4\u63a5\u9000\u51fa\u7a0b\u5e8f\u3002\n\n### \u60c5\u51b5$2:$\n\n\u8bbe$L=l \\bmod G,R=r \\bmod G$\n\n\u5982\u679c$L\\leq R$\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u60c5\u51b5\u4e0d\u5c5e\u4e8e\u60c5\u51b5$1$\uff08\u5df2\u7ecf\u7279\u5224\u6389\u4e86\uff09\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u53d6\u5230\u8fd9$R-L+1$\u4e2a\u70b9\u5bf9\u3002\n\n\u53d1\u73b0\u8fd9\u6b63\u597d\u662f\u4e00\u4e2a**\u6570\u8f74\u7ebf\u6bb5\u8986\u76d6**\u95ee\u9898\u3002\u5982\u679c\u6211\u4eec\u7ed9\u6240\u6709\u70b9\u5bf9\u8fdb\u884c\u7f16\u53f7$(0\\sim (G-1)$,\u5373$t\\in [0,G-1] $\u65f6\u5f97\u5230\u7684\u70b9\u5bf9$)$\uff0c\u5e76\u628a\u7f16\u53f7\u62bd\u8c61\u5230\u6570\u8f74\u4e0a\uff0c\u90a3\u4e48\u6211\u4eec\u5bf9\u7ebf\u6bb5$[L,R]$\u8fdb\u884c\u8986\u76d6\uff0c\u5c31\u8868\u793a\u53ef\u4ee5\u53d6\u5230\u8fd9\u4e9b\u70b9\u3002\n\n### \u60c5\u51b5$3:$\n\n\u5982\u679c$L>R$\uff0c\u6211\u4eec\u8fdb\u884c$[0,R],[L,G-1]$\u7684\u533a\u95f4\u8986\u76d6\u3002\n\n\u6700\u540e\u6574\u4e2a\u6570\u8f74\u88ab\u8986\u76d6\u7684\u957f\u5ea6\u5c31\u662f\u7b54\u6848\u4e86\u3002\n\n### \u5b9e\u73b0\n\n\u5173\u4e8e\u7ebf\u6bb5\u8986\u76d6\uff0c\u6211\u5199\u4e86$3$\u79cd\u7b97\u6cd5\u3002\n\n### \u7b97\u6cd5$1:$\n\n\u52a8\u6001\u5f00\u70b9\u7ebf\u6bb5\u6811\u3002\n\n\u4eb2\u6d4b\u53ea\u6709$20$\u5206 (loj)\uff0c$64000000\\times 3$\u4e2a$\\texttt{long long}$\u4f60\u5bb6\u8bc4\u6d4b\u673a\u5f00\u7684\u4e0b\uff1f\n\n### \u7b97\u6cd5$2:$\n\n\u533a\u95f4\u8986\u76d6...\u73c2\u6735\u8389\u6811...\u5c82\u4e0d\u7f8e\u54c9\uff1f\n\nloj \u4e0a\u8fc7\u4e86\uff08\u8dd1\u4e86\u6700\u540e\u4e00\u9875\uff09\uff0c\u4f46\u662f luogu \u4e0d\u5f00 O2 \u8fc7\u4e0d\u53bb...\n\n### \u7b97\u6cd5$3:$\n\n\u7531\u4e8e\u61d2\u5f97\u5199 set \uff0c\u6211\u60f3\u5230\u4e86\u4e00\u79cd\u7c7b\u4f3c\u8d2a\u5fc3\u7684\u65b9\u6cd5\u3002\n\n\u6240\u6709\u8981\u8986\u76d6\u7684\u7ebf\u6bb5\u6309\u7167\u5de6\u7aef\u70b9\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u7136\u540e\u4ece\u5de6\u5411\u53f3\u626b\uff0c\u627e\u5230\u6bcf\u4e00\u4e2a\u8fde\u901a\u5757\u3002\n\n\u5982\u679c\u5f53\u524d\u53ef\u4ee5\u6269\u5c55\u5230\u7684\u53f3\u7aef\u70b9\u6bd4\u8fd9\u4e2a\u7ebf\u6bb5\u7684\u5de6\u7aef\u70b9\u5c0f\uff0c\u8bf4\u660e\u5df2\u7ecf\u6709\u4e00\u4e2a\u8fde\u901a\u5757\u4e86\uff01\u7b54\u6848\u52a0\u4e0a\u8fde\u901a\u5757\u7684\u957f\u5ea6\u5373\u53ef\u3002\n\n\u8fd9\u6bd4\u4e0a\u9762\u4e24\u4e2a\u5feb\u591a\u4e86\u3002\n\n\u770b\u4e0d\u61c2\u7684\u53ef\u4ee5\u770b\u4ee3\u7801\uff0c\u5305\u770b\u5305\u61c2\uff08\u6ed1\u7a3d\uff09\n\n\u4ee3\u7801\u5982\u4e0b\uff08\u7b97\u6cd5$3$\uff0c\u6709\u6ce8\u91ca\uff09\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define ll long long\nusing namespace std;\n#ifdef Fading\n#define gc getchar\n#endif\n#ifndef Fading\ninline char gc(){\n    static char now[1<<16],*S,*T;\n    if (T==S){T=(S=now)+fread(now,1,1<<16,stdin);if (T==S) return EOF;}\n    return *S++;\n}\n#endif\ninline ll read(){\n    register ll x=0,f=1;char ch=gc();\n    while (!isdigit(ch)){if(ch=='-') f=-1LL;ch=gc();}\n    while (isdigit(ch)){x=(x<<3LL)+(x<<1LL)+ch-'0';ch=gc();}\n    return (f==1LL)?x:-x;\n}\nstruct node{\n    int l,r;\n}g[2000001];\nint tot;\ninline bool cmp(node a,node b){\n\treturn a.l<b.l;\n}\nsigned main(){\n\tint n=read(),A=read(),B=read();\n\tint G=A/__gcd(A,B+1)*B;\n\twhile (n--){\n\t\tint l=read(),r=read();\n\t\tif (r-l+1>=G){\n\t\t\tprintf(\"%lld\\n\",G);return 0;\n\t\t}else{\n\t\t\tl=l%G,r=r%G;\n\t\t\tif (l>r){\n\t\t\t\tg[++tot].l=0;g[tot].r=r;\n\t\t\t\tg[++tot].l=l;g[tot].r=G-1;\n\t\t\t}else{\n\t\t\t\tg[++tot].l=l;g[tot].r=r;\n\t\t\t}\n\t\t}\n\t}\n\tsort(g+1,g+1+tot,cmp);\n\tint ans=0,nowL=g[1].l,nowR=g[1].r;\n\tg[tot+1].l=G+1;//\u65b0\u52a0\u5165\u4e00\u4e2a\u54e8\u5175\u7ebf\u6bb5\uff0c\u628a\u6700\u540e\u4e00\u4e2a\u8fde\u901a\u5757\u7b97\u5165\u603b\u7b54\u6848\u3002\n\tfor (int i=2;i<=tot+1;i++){\n\t\tif (nowR<g[i].l){//\u524d\u9762\u7684\u7ebf\u6bb5\u5df2\u7ecf\u5f62\u6210\u4e86\u8fde\u901a\u5757\n\t\t\tans+=nowR-nowL+1;nowL=g[i].l,nowR=g[i].r;\n\t\t}else{\n\t\t\tnowR=max(g[i].r,nowR);//\u66f4\u65b0\u53ef\u4ee5\u6269\u5c55\u5230\u7684\u53f3\u7aef\u70b9\uff0c\u628a\u8fd9\u4e2a\u7ebf\u6bb5\u52a0\u5165\u8fde\u901a\u5757\u3002\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1562487806,
        "uid": 20309,
        "name": "Fading",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5444 \u3010[APIO2019]\u5947\u602a\u88c5\u7f6e\u3011"
    },
    {
        "content": "\u5148\u6765\u8bc1\u660e\u4e00\u4e2a\u5f15\u7406\u3002    \n$ac \\equiv bc(modp),(c,p)=d$\u5219$a \\equiv b(mod \\frac{p}{d})$         \n$\\because ac \u2261 bc(mod p)$       \n$\\therefore p|ac-bc$     \n$\\therefore p|c(a-b)$                  \n$\\because (c,p)=d$   \n$\\therefore \\frac{p}{d}|\\frac{c}{d}(a-b)$     \n$\\because c,p$\u5df2\u7ecf\u9664\u53bb\u4e86$gcd$\uff0c      \n$\\therefore (\\frac{p}{d},\\frac{c}{d})=1$       \n\u90a3\u4e48\u53c8$\\because$\u6574\u9664    \n$\\therefore \\frac{p}{d}|a-b$        \n\u5373$a \\equiv b(mod \\frac{p}{d})$    \n\u6b63\u6587\u5f00\u59cb\u3002        \n\u6211\u4eec\u60f3\u529e\u6cd5\u8ba1\u7b97\u51fa$x=((t+\\lfloor \\frac{t}{B} \\rfloor)modA)$\u548c$y=(t mod B)$    \n\u5f53$t=k$\u65f6\uff0c\u5047\u8bbe$x=0,y=0$(\u5f53\u524d\u662f\u7b2c\u4e00\u6b21\u5faa\u73af\uff0c\u5faa\u73af\u8282\u5c31\u662f$k$)       \n\u628a$t$\u6362\u6210$k$            \n\u5219$x=((k+\\lfloor \\frac{k}{B} \\rfloor)modA),y=(kmodB)$        \n\u6b64\u65f6\u56e0\u4e3a$y=0$,\u6240\u4ee5$kmodB=0$\uff0c\u5373$k|B$                       \n\u90a3\u4e48$x$\u5f0f\u5b50\u7684\u4e0b\u53d6\u6574\u7b26\u53f7\u5c31\u53ef\u4ee5\u53bb\u6389\u3002        \n\u5373   \n$$0=((k+\\frac{k}{B})modA)$$      \n$$0=(\\frac{k(B+1)}{B}modA)$$     \n\u4e0d\u96be\u60f3\u51fa\u548c$0 \\equiv \\frac{k(B+1)}{B}(modA)$\u662f\u7b49\u4ef7\u7684\u3002    \n**\u8fd9\u65f6\u6839\u636e\u5f15\u7406\uff0c\u628a$\\frac{k}{B}$\u5f53\u6210\u5f15\u7406\u4e2d\u7684$a$\uff0c\u628a$B+1$\u5f53\u6210\u5f15\u7406\u4e2d\u7684$b$\uff0c\u628a$A$\u5f53\u6210\u5f15\u7406\u4e2d\u7684$p$**           \n\u5f97\u5230    \n$$0 \\equiv \\frac{k}{B} (mod \\frac{A}{gcd(A,B+1)})$$         \n$$0 \\equiv k (mod \\frac{AB}{gcd(A,B+1)})$$    \n\u6240\u4ee5\u6700\u5c0f\u5faa\u73af\u8282$k$\u5c31\u662f$\\frac{AB}{gcd(A,B+1)}$\u3002                                                         \n\u505a\u5230\u8fd9\u91cc\u606d\u559c\u4f60\u505a\u5b8c\u4e86\u8fd9\u9053\u9898\u7684\u4e00\u534a\u3002     \n\u6211\u4eec\u8003\u8651\u628a\u8fd9\u9053\u9898\u53d8\u6210\u4e00\u9053\u533a\u95f4\u8986\u76d6\u95ee\u9898\u3002   \n\u5bf9\u533a\u95f4$[l,r]$\u8fdb\u884c\u8003\u8651                  \n\u60c5\u51b51\uff1a\u82e5$r-l+1>=k$      \n\u5219\u8bf4\u660e\u6b64\u533a\u95f4\u7684\u957f\u5ea6\u5df2\u7ecf\u5927\u4e8e\u4e86\u5faa\u73af\u8282\uff0c\u5373\u5faa\u73af\u8282\u7684\u6bcf\u4e00\u4e2a\u6570\u90fd\u80fd\u53d6\u5230\uff0c\u7b54\u6848\u5c31\u662f\u5faa\u73af\u8282\uff0c\u76f4\u63a5\u9000\u51fa\u7a0b\u5e8f\u5373\u53ef\u3002          \n\u60c5\u51b52\uff1a       \n\u5c06$l$\u548c$r$\u90fd\u6a21$k$\uff08\u4e0b\u6587\u7684$l$\u548c$r$\u90fd\u662f\u6a21$k$\u4e4b\u540e\u7684\uff09   \n\u82e5$l <= r$         \n\u8868\u793a\u8fd9\u6bb5\u533a\u95f4\u88ab\u5b8c\u5168\u5305\u542b\u5728\u4e86\u5faa\u73af\u8282\u91cc\u9762\uff0c\u5373\u8fd9\u6761\u7ebf\u6bb5\u90fd\u53ef\u4ee5\u53d6\u5230\u3002   \n\u6211\u4eec\u5728\u6570\u8f74\u4e0a\u753b\u4e00\u6761$l \\sim r$\u7684\u7ebf\u6bb5\u3002       \n\u60c5\u51b5\u4e09\uff1a    \n\u63a5\u7740\u60c5\u51b52\uff0c\u8ba8\u8bba$l > r$\u7684\u60c5\u51b5    \n\u6b64\u65f6\u7684\u60c5\u51b5\u662f$l$\u5230\u67d0\u4e00\u4e2a\u70b9\u521a\u597d\u7ed3\u675f\u4e86\u5faa\u73af\u8282\uff0c\u800c\u8fd9\u4e2a\u70b9\u4e4b\u540e\u53c8\u91cd\u65b0\u5f00\u59cb\u4e86\u4e0b\u4e00\u4e2a\u5faa\u73af\uff0c\u6240\u4ee5\u4f1a\u51fa\u73b0$l>r$\u7684\u60c5\u51b5\u3002                       \n\u6211\u4eec\u5728\u6570\u8f74\u4e0a\u753b$2$\u6761\u7ebf\u6bb5\u3002     \n$[l,k - 1]$\u548c$[0,r]$                                               \n\u6700\u540e\u7684\u7b54\u6848\u5c31\u662f\u6570\u8f74\u88ab\u8986\u76d6\u7684\u957f\u5ea6\u3002    \n\u7b97\u8fd9\u4e2a\u4e1c\u897f\u5c31\u5f88\u7b80\u5355\u4e86\u3002    \n\u628a\u6240\u6709\u7ebf\u6bb5\u6309\u7167\u5de6\u7aef\u70b9\u6392\u5e8f\u3002           \n\u6211\u4eec\u8bbe$nl,nr$\u8868\u793a\u5f53\u524d\u8fde\u901a\u7684\u7ebf\u6bb5\u7684\u5de6\u7aef\u70b9\u548c\u53f3\u7aef\u70b9\u3002   \n\u4e4b\u540e\u679a\u4e3e\u6bcf$1$\u6761\u7ebf\u6bb5\u3002\u8bbe\u5f53\u524d\u679a\u4e3e\u5230\u7684\u7ebf\u6bb5\u4e3a$L$\u3002\n\u82e5$L$\u7684\u5de6\u7aef\u70b9$>nr$\u5219\u8bf4\u660e\u8fd9\u6761\u7ebf\u6bb5\u5df2\u7ecf\u4e0e\u5f53\u524d\u8fde\u901a\u7684\u7ebf\u6bb5\u6240\u65ad\u5f00\u4e86\uff0c\u6211\u4eec\u5c06\u7b54\u6848\u52a0\u4e0a$nr-nl+1$\uff0c\u7136\u540e\u5c06$nl$\u548c$nr$\u66f4\u65b0\u4e3a\u8fd9\u6761\u7ebf\u6bb5\u7684\u5de6\u7aef\u70b9\u548c\u53f3\u7aef\u70b9\u5373\u53ef\u3002        \n\u5426\u5219\u8bf4\u660e\u8fd9\u6761\u7ebf\u6bb5\u4e5f\u53ef\u4ee5\u548c\u5f53\u524d\u5df2\u7ecf\u8fde\u901a\u7684\u7ebf\u6bb5\u76f8\u8fde\u3002                            \n\u6211\u4eec$check \\_ max$\u4e00\u6b21$nr$\u548c\u5f53\u524d\u7ebf\u6bb5\u7684\u53f3\u7aef\u70b9\u5373\u53ef\u3002\uff08\u8fd9\u90e8\u5206\u914d\u5408\u7740\u770b\u6211\u4ee3\u7801\u4f1a\u66f4\u5bb9\u6613\u7406\u89e3\u4e00\u4e9b\uff09                                        \n## \u4ee3\u7801   \n```cpp\n#include <bits/stdc++.h>\n\nconst int maxn = 1e6 + 10;\ntypedef long long ll;\n\ntemplate<class t> inline void read(t& res) {\n\tres = 0;  char ch = getchar();  bool neg = 0;\n\twhile (!isdigit(ch))\n\t\tneg |= ch == '-', ch = getchar();\n\twhile (isdigit(ch))\n\t\tres = (res << 1) + (res << 3) + (ch & 15), ch = getchar();\n\tif (neg)\n\t\tres = -res;\n}\n\nll gcd(ll a, ll b) { return b ? gcd(b, a % b) : a; }\n\nll n, m, i, j, k, A, B, sz, len, nl, nr;  \nll ans;   \nstruct line {\n\tll l, r;     \n\tline() { l = r = 0; }\n\tline(ll _l, ll _r) { l = _l;  r = _r; }\n\tinline friend bool operator < (line a, line b) {\n\t\treturn a.l < b.l;\n\t}\n} l[maxn << 1];\n\nint main() {\n\tread(n);  read(A);  read(B);\n\tlen = A / gcd(A, B + 1) * B;  \n\tfor (int i = 1; i <= n; i++) {\n\t\tll le, ri;  read(le);  read(ri);\n\t\tif (ri - le + 1 >= len) { printf(\"%lld\\n\", len);  return 0; }\n\t\tle %= len;  \n\t\tri %= len;\n\t\tif (le <= ri) \n\t\t\tl[++sz] = line(le, ri);\n\t\telse\n\t\t\tl[++sz] = line(le, len - 1), \n\t\t\tl[++sz] = line(0, ri);\t\n\t}\n\tstd::sort(l + 1, l + sz + 1);     \n\tl[++sz] = line(len + 1, 0);\n\tnl = l[1].l, nr = l[1].r;\n\tfor (int i = 2; i <= sz; i++) {\n\t\tif (nr < l[i].l) {\n\t\t\tans += nr - nl + 1;\n\t\t\tnl = l[i].l;\n\t\t\tnr = l[i].r;\n\t\t} else {\n\t\t\tnr = std::max(nr, l[i].r);\n\t\t}\n\t}\n\tprintf(\"%lld\\n\", ans);\n\treturn 0;   \n} \n```",
        "postTime": 1566286210,
        "uid": 114320,
        "name": "\u843d\u6c50",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5444 \u3010[APIO2019]\u5947\u602a\u88c5\u7f6e\u3011"
    },
    {
        "content": "\u5bb9\u6613\u53d1\u73b0\u6574\u4e2a\u65f6\u95f4\u5e8f\u5217\u662f\u6709\u5468\u671f\u6027\u7684\uff0c\u6211\u4eec\u8bbe\u5468\u671f\u957f\u5ea6\u4e3a $T$\u3002\n\n\u63a5\u4e0b\u6765\u8bb0 $x=f(t)=(t+\\left \\lfloor\\dfrac{t}{B} \\right \\rfloor) \\bmod A$\uff0c$y=g(t)=t \\bmod B$\u3002\n\n\u7531\u5468\u671f\u6027\u7684\u6027\u8d28\u53ef\u5f97\uff0c$f(t)=f(t+T)$\uff0c$g(t)=g(t+T)$\u3002\u5373\uff0c\n\n$$\nt+\\left \\lfloor\\dfrac{t}{B} \\right \\rfloor \\equiv t+T+ \\left \\lfloor\\dfrac{t+T}{B} \\right \\rfloor \\pmod A\n$$\n\n\u4ee5\u53ca\uff0c\n\n$$\nt \\equiv t+T \\pmod B\n$$\n\n\u53d1\u73b0 $g(t)$ \u7684\u7b49\u5f0f\u8f83\u4e3a\u7b80\u5355\uff0c\u6211\u4eec\u5148\u4ece\u5b83\u5165\u624b\u3002\u5bb9\u6613\u5f97\u5230 $T \\equiv 0 \\pmod B$\u3002\n\n\u56e0\u6b64\u6211\u4eec\u4ee4 $T=kB$\u3002\n\n\u56de\u4ee3\u5230 $f(t)$ \u7684\u7b49\u5f0f\u4e2d\uff0c\u5f97\u5230\uff08\u4e2d\u95f4\u63a8\u5bfc\u8fc7\u7a0b\u7565\uff09\uff0c\n\n$$\n(B+1)k \\equiv 0 \\pmod A\n$$\n\n\u8fdb\u4e00\u6b65\u5f97\u5230\uff0c\n\n$$\nk=\\frac{A}{\\gcd(A,B+1)}\n$$\n\n\u4ece\u800c\u5f97\u51fa\uff0c\n\n$$\nT=\\frac{AB}{\\gcd(A,B+1)}\n$$\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u628a\u95ee\u9898\u8f6c\u53d8\u4e3a\u4e86\u4e00\u4e2a\u5728 $[0,T)$ \u533a\u95f4\u4e0a\u6c42\u82e5\u5e72\u6761\u7ebf\u6bb5\u4ea4\u5927\u5c0f\u7684\u95ee\u9898\u3002\n\n```cpp\n// Problem: P5444 [APIO2019]\u5947\u602a\u88c5\u7f6e\n// Contest: Luogu\n// URL: https://www.luogu.com.cn/problem/P5444\n// Memory Limit: 500 MB\n// Time Limit: 4000 ms\n// Powered by CP Editor (https://github.com/cpeditor/cpeditor)\n\n#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\ntypedef pair<long long,long long> pll;\nvector<pll> v;\nlong long gcd(long long x,long long y)\n{\n return y==0?x:gcd(y,x%y);\n}\nint main()\n{\n ios::sync_with_stdio(false);\n long long n,a,b;\n cin>>n>>a>>b;\n long long T=a/gcd(a,b+1);\n if((__int128)T*b>=1e18)\n  T=1e18;\n else\n  T*=b;\n for(int i=1;i<=n;i++)\n {\n  long long l,r;\n  cin>>l>>r;\n  if(r-l+1>=T)\n  {\n   cout<<T<<endl;\n   return 0;\n  }\n  l%=T,r%=T;\n  if(l<=r)\n   v.emplace_back(l,r);\n  else\n   v.emplace_back(l,T-1),v.emplace_back(0,r);\n }\n sort(v.begin(),v.end());\n long long l=v[0].first,r=v[0].second,ans=0;\n for(auto p:v)\n  if(p.first<=r)\n   r=max(r,p.second);\n  else\n  {\n   ans+=r-l+1;\n   l=p.first,r=p.second;\n  }\n ans+=r-l+1;\n cout<<ans<<endl;\n return 0;\n}\n```",
        "postTime": 1596470959,
        "uid": 22030,
        "name": "StudyingFather",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5444 \u3010[APIO2019]\u5947\u602a\u88c5\u7f6e\u3011"
    },
    {
        "content": ">  [\u6d1b\u8c37\u9898\u76ee\u9875\u9762\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5444)\n\n>\u7ed9\u5b9a$n,a,b$\u4ee5\u53ca$n$\u4e2a\u533a\u95f4$[l_i,r_i]$\uff0c\u6c42$\\left|\\bigcup\\limits_{i=1}^n\\left\\{\\left(\\left(x+\\left\\lfloor\\dfrac xb\\right\\rfloor\\right)\\bmod a,x\\bmod b\\right)\\mid x\\in[l_i,r_i]\\right\\}\\right|$\u3002\n\n>$n\\in\\left[1,10^6\\right],a,b\\in\\left[1,10^{18}\\right],0\\leq l_i\\leq r_i\\leq 10^{18}$\u3002\n\n\u9996\u5148\u53ef\u4ee5\u624b\u73a9\u6216\u8005\u5199\u4e2a\u7a0b\u5e8f\u6253\u4e2a\u8868\uff0c\u6478\u6e05\u695a$\\left(\\left(x+\\left\\lfloor\\dfrac xb\\right\\rfloor\\right)\\bmod a,x\\bmod b\\right)$\u8fd9\u4e2a\u4e1c\u897f\u7684\u89c4\u5f8b\u3002\u4e0d\u96be\u53d1\u73b0\uff0c\u968f\u7740$x$\u52a0\u4e00\uff0c\u7b2c\u4e8c\u4e2a\u6570\u80af\u5b9a\u662f\u52a0\u4e00\uff08\u5728$\\bmod b$\u610f\u4e49\u4e0b\uff09\uff0c\u7b2c\u4e00\u4e2a\u6570\u5148\u52a0\u4e0a\u4e2a\u4e00\uff0c\u7136\u540e\u5982\u679c$b\\mid x$\u5c31\u518d\u52a0\u4e2a\u4e00\uff08\u5728$\\bmod a$\u610f\u4e49\u4e0b\uff09\u3002\n\n\u7531\u4e8e\u6bcf\u6b65\u7684\u4e8c\u5143\u7ec4\u503c\u53ea\u8ddf\u4e0a\u4e00\u6b65\u6709\u5173\uff0c\u800c\u4e14\u503c\u57df\u6709\u9650\u5927\uff0c\u6240\u4ee5\u663e\u7136\u662f\u6709\u5faa\u73af\u8282\u7684\u3002\u4e0d\u59a8\u627e\u51fa\u8fd9\u4e2a\u5faa\u73af\u8282\u3002\n\n\u663e\u7136\uff0c\u7b2c\u4e8c\u4e2a\u6ee1\u8db3\u4e8c\u5143\u7ec4\u7b49\u4e8e$(0,0)$\u7684$x$\u5c31\u662f\u5faa\u73af\u8282\u5927\u5c0f\uff08\u7b2c\u4e00\u4e2a$x=0$\uff09\u3002\u6ce8\u610f\u5230\uff0c\u7b2c\u4e00\u4e2a\u6570\u7684\u589e\u91cf\u4e0e\u7b2c\u4e8c\u4e2a\u6570\u6709\u5173\uff0c\u800c\u7b2c\u4e8c\u4e2a\u6570\u81ea\u5df1\u52a0\u81ea\u5df1\u7684\u4e0d\u53d7\u5e72\u6270\uff0c\u6240\u4ee5\u8bbe$x=yb$\uff0c\u5176\u4e2d$y$\u662f\u6574\u6570\u3002\u663e\u7136\uff0c\u5728\u4ece$0$\u5f00\u59cb\u7684\u524d$x$\u6b21\u589e\u52a0\u4e2d\uff0c\u7b2c\u4e00\u4e2a\u6570\u6b63\u5e38\u52a0\u7684\u662f$x$\u6b21\uff0c\u989d\u5916\u589e\u52a0\u4e86$y$\u6b21\u3002\u5728$\\bmod a$\u610f\u4e49\u4e0b\u4e3a$0$\uff0c\u6240\u4ee5\u6ee1\u8db3$a\\mid x+y$\uff0c\u5373$a\\mid y(b+1)$\u3002\u5373$\\dfrac{a}{\\gcd(a,b+1)}\\mid y\\dfrac{b+1}{\\gcd(a,b+1)}$\uff0c\u663e\u7136$y=\\dfrac{a}{\\gcd(a,b+1)}$\u65f6\u53d6\u5f97\u6700\u5c0f\u503c\uff0c\u4e8e\u662f\u5faa\u73af\u8282\u4e3a$x=yb=\\dfrac{a}{\\gcd(a,b+1)}b$\u3002\n\n\u63a5\u4e0b\u6765\uff0c\u628a\u6bcf\u4e2a\u533a\u95f4$l,r$\u90fd\u5f04\u6210$\\bmod x$\u610f\u4e49\u4e0b\u7684\u96c6\u5408\uff0c\u5206\u4e09\u79cd\u60c5\u51b5\uff1a\n\n1. $r-l+1\\geq x$\uff0c\u6b64\u65f6\u663e\u7136\u5b83\u4e00\u4e2a\u4eba\u5c31\u627f\u5305\u4e86\u503c\u57df\u91cc\u7684\u6240\u6709\u5143\u7d20\uff0c\u76f4\u63a5\u8f93\u51fa$x$\u8d70\u4eba\uff1b\n1. \u5426\u5219\uff0c$l\\bmod x>r\\bmod x$\uff0c\u663e\u7136\u662f\u8de8\u8fc7\u4e86\u4e00\u4e2a\u65ad\u70b9\uff0c\u53ef\u4ee5\u5c06\u5b83\u62c6\u6210$[l\\bmod x,x-1],[0,r\\bmod x]$\u4e24\u4e2a\u533a\u95f4\uff1b\n1. \u5426\u5219\uff0c$l\\bmod x\\leq r\\bmod x$\uff0c\u5c31\u53d8\u6210$[l\\bmod x,r\\bmod x]$\u8fd9\u4e00\u4e2a\u533a\u95f4\u3002\n\n\u63a5\u4e0b\u6765\u5c31\u662f\u4e2a\u533a\u95f4\u5e76\u7684\u4e8b\u4e86\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\n#define pb push_back\n#define ppb pop_back\n#define mp make_pair\n#define X first\n#define Y second\nconst int inf=0x3f3f3f3f3f3f3f3f;\nint gcd(int x,int y){return y?gcd(y,x%y):x;}\nint n,a,b;\nvector<pair<int,int> > rg,ans;\nsigned main(){\n\tcin>>n>>a>>b;\n\tint x=a/gcd(a,b+1);\n\tx=x<LLONG_MAX/b?x*b:inf;\n\twhile(n--){\n\t\tint l,r;\n\t\tscanf(\"%lld%lld\",&l,&r);\n\t\tif(r-l+1>=x)return cout<<x,0;\n\t\telse if(l%x>r%x)rg.pb(mp(l%x,x-1)),rg.pb(mp(0,r%x));\n\t\telse rg.pb(mp(l%x,r%x));//\u5206\u4e09\u79cd\u60c5\u51b5 \n\t}\n\tsort(rg.begin(),rg.end());\n\tfor(int i=0;i<rg.size();i++)//\u533a\u95f4\u5e76 \n\t\tif(ans.size()&&rg[i].X<=ans.back().Y)ans.back().Y=max(ans.back().Y,rg[i].Y);\n\t\telse ans.pb(rg[i]);\n//\tfor(int i=0;i<ans.size();i++)printf(\"[%lld,%lld]\\n\",ans[i].X,ans[i].Y);\n\tint ans0=0;\n\tfor(int i=0;i<ans.size();i++)ans0+=ans[i].Y-ans[i].X+1;//\u7edf\u8ba1\u7b54\u6848 \n\tcout<<ans0;\n\treturn 0;\n}\n```",
        "postTime": 1597132550,
        "uid": 138400,
        "name": "chenxia25",
        "ccfLevel": 9,
        "title": "\u6d1b\u8c37 P5444 - \u5947\u602a\u88c5\u7f6e"
    },
    {
        "content": "\u8fd9\u9898\u5f88\u660e\u663e\u6211\u4eec\u8981\u6c42\u5faa\u73af\u8282\uff0c\u90a3\u4e48\u6211\u4eec\u5f00\u59cb\u8bc1\u660e\uff1a\n\n\n# \u8bc1\u660e\uff1a\n### \u8bbe \u5f53\u524d\u65f6\u95f4\u4e3a $t$\uff0c\u90a3\u4e48\uff1a\n\n$x = ((t + \\lfloor \\frac{t}{B} \\rfloor) \\% A)$\n\n$y=(t \\% B)$\n\n### \u8bbe $ a\u00d7B $ \u4e3a\u6700\u5c0f\u7684\u5faa\u73af\u8282 ( $a$ \u4e3a\u975e\u8d1f\u6574\u6570 ) , \u90a3\u4e48\uff1a\n\n\u5bf9\u4e8e $y$ \uff0c\u53ef\u89c1 $a$ \u7684\u53d6\u503c\u6ca1\u6709\u7ea6\u675f:\n\n$y=((t+a\u00d7B) \\% B)$\n\n$0=(a\u00d7B) \\%B $\n\n\u5bf9\u4e8e $x$:\n\n$x = ((t +a\u00d7B+ \\lfloor \\frac{t+a\u00d7B}{B} \\rfloor) \\% A)$\n\n$x=((t+a\u00d7B+ \\lfloor \\frac{t}{B} \\rfloor+a)\\% A)$\n\n\u63d0\u51fa $x = ((t + \\lfloor \\frac{t}{B} \\rfloor) \\% A)$\uff1a\n\n$0=(a\u00d7B+a)\\%A$\n\n$0=(a\u00d7(B+1))\\%  A$\n\n\u53ef\u89c1\u9700\u8981\u6ee1\u8db3 $a\u00d7(B+1)$ \u662f $A$ \u7684\u6574\u6570\u500d\n\n$a \u00d7 (B+1)=n\u00d7A $  (\u5176\u4e2d $ n $ \u4e3a\u6b63\u6574\u6570\uff0c\u8868\u793a\u500d\u6570 )\n\n\u79fb\u9879:\n\n$ a = n \u00d7 \\frac{A}{B+1}$\n\n\u6240\u4ee5\u4e3a\u4f7f\u5f97 $a$ \u6700\u5c0f\u975e\u8d1f\u6574\u6570,\n\n\u7ea6\u5206 $a=n\u00d7 \\frac {\\frac{A}{gcd(A,B+1)}} {\\frac{B+1}{gcd(A,B+1)}}$\n\n\u53ef\u89c1 $n$ \u6700\u5c0f\u4e3a $\\frac{B+1}{gcd(A,B+1)}$\n\n\u6b64\u65f6 $a$ \u6700\u5c0f\uff0c\n$a= \\frac{A}{gcd(A,B+1)}$\n\n\u5219\u6700\u5c0f\u5faa\u73af\u8282\u4e3a $a\u00d7B=\\frac{A\u00d7B}{gcd(A,B+1)}$\n\n\u6ce8 : \u5982\u679c\u4f60\u7684\u5faa\u73af\u8282 $<0$ \u8bf4\u660e\u7206\u4e86 $long long$\uff0c\u76f4\u63a5\u8bbe\u4e3a $1e18+10$\u5c31\u884c\n# \u5904\u7406\u8303\u56f4:\n\n\u6211\u4eec\u73b0\u5728\u6709\u4e86\u5faa\u73af\u8282\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5904\u7406\u4e86\uff0c\n\n\u8bbe \u5faa\u73af\u8282\u4e3a $xhj$\uff0c\u4ee5\u4e0b\u7684\u81ea\u884c\u7406\u89e3\uff0c\u601d\u60f3\u5f88\u7b80\u5355\n\n\u5bf9\u4e8e$l\u00f7xhj==r\u00f7xhj$\uff0c\u6211\u4eec\u628a\u5b83\u6539\u4e3a $L=l\\%xhj,R=r\\%xhj$ \u8fd9\u4e2a\u533a\u95f4\n\n\u5bf9\u4e8e$l\u00f7xhj==r\u00f7xhj-1$, \u6211\u4eec\u628a\u5b83\u5206\u4e3a \n\n$L=0,R=r\\%xhj ------  L=l\\%xhj,R=xhj-1$\n\n\u4e24\u4e2a\u533a\u95f4\n\n\u5bf9\u4e8e $l\u00f7xhj<r\u00f7xhj-1$\uff0c\u5f88\u660e\u663e\u8de8\u4e86\u6574\u4e2a\u533a\u95f4\uff0c\u76f4\u63a5\u8f93\u51fa $xhj$ \u8d70\u4eba\n\n\u63a5\u4e0b\u6765\u5c31\u662f\u7ebf\u6bb5\u8986\u76d6\u6c42\u5e76\u96c6\u95ee\u9898\u4e86\uff0c\u6211\u4eec\u76f4\u63a5\u4ee5 $l$ \u4e3a\u5173\u952e\u5b57\u4ece\u5c0f\u5230\u5927 $sort$ , \u5e76\u4fdd\u5b58\u6700\u8fdc\u7684 $r$ , \u7136\u540e\u6309\u7167\u987a\u5e8f\u8bb0\u5f55\u5230 $ans$ \u5c31\u53ef\u4ee5\n\n# \u4ee3\u7801:\n```cpp\n#include<algorithm>\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\nusing namespace std;\nstruct zxc\n{\n    long long l,r;\n}qaq[3000010];\nlong long gcd(long long a,long long b)\n{\n    if(b==0)return a;\n    return gcd(b,a%b);\n}\nbool cmp(zxc a,zxc b)\n{\n    return a.l<b.l;\n}\ninline long long read()\n{\n    long long a=0;\n    char c=getchar();\n    while(c>'9'||c<'0')c=getchar();\n    while(c<='9'&&c>='0')\n    {\n        a=a*10+c-'0';\n        c=getchar();\n    }\n    return a;\n}\nint main()\n{\n    int n,cnt;long long a,b,xhj;\n    n=read();a=read();b=read();\n    xhj=a/gcd(a,b+1)*b;\n    cnt=n;\n    if(xhj<0)xhj=1e18+10;\n    for(register int i=1;i<=n;++i)\n    {\n        qaq[i].l=read();qaq[i].r=read();\n        long long A=qaq[i].l/xhj,B=qaq[i].r/xhj;\n        if(A==B)\n        {\n            qaq[i].l%=xhj;\n            qaq[i].r%=xhj;\n        }\n        if(A==B-1)\n        {\n            qaq[++cnt].l=0;\n            qaq[cnt].r=qaq[i].r%xhj;\n            qaq[i].l=qaq[i].l%xhj;\n            qaq[i].r=xhj-1;\n        }\n        if(A<B-1)\n        {\n            cout<<xhj;\n            return 0;\n        }\n    }\n    sort(qaq+1,qaq+cnt+1,cmp);\n    long long ans=qaq[1].r-qaq[1].l+1,now=qaq[1].r;\n    for(register int i=2;i<=cnt;++i)\n    {\n        if(qaq[i].r<=now)continue;\n        ans+=qaq[i].r-max(qaq[i].l-1,now);\n        now=qaq[i].r;\n    }\n    cout<<ans;\n}\n```",
        "postTime": 1569243182,
        "uid": 89785,
        "name": "\u7a7a\u306e\u8ecc\u8de1",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5444 \u3010[APIO2019]\u5947\u602a\u88c5\u7f6e\u3011"
    },
    {
        "content": "## \u8868\u793a\u5148\u819cAK APIO2019\u7684\u5927\u4f6c\n\n\u7136\u540e\u8fdb\u5165\u6b63\u9898.\n\n\u8fd9\u9898\u5176\u5b9e\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u7b80\u5355\u7684\u601d\u7ef4\u5b9e\u9a8c\u6765\u76f4\u63a5\u627e\u5230\u89c4\u5f8b, \u4e0d\u9700\u8981\u8bc1\u660e\u4ec0\u4e48\u5f15\u7406\u7684\u8bf4......\n\n$((t+\\frac{t}{b}) mod a,t mod b)$\n\n\u7b2c\u4e00\u773c\u770b\u5230\u8fd9\u4e2a\u5f0f\u5b50\u7684\u65f6\u5019\u6574\u4e2a\u4eba\u5185\u5fc3\u662f\u5d29\u6e83\u7684.\n\n\u4f46\u662f\u770b\u5230\u6570\u636e\u8303\u56f4\u8fd9\u9898\u5c31\u77e5\u9053\u91cc\u9762\u5fc5\u7136\u6709\u7384\u673a, \u597d\u50cf\u6709\u4e00\u4e2a\u5faa\u73af\u8282\u4e00\u6837\u7684\u4e1c\u897f, \u7136\u540e\u5c31\u53ef\u4ee5\u5927\u8389\n\n\u601d\u60f3\u5b9e\u9a8c1: \u8003\u8651$t=ab$\u7684\u60c5\u51b5, \u53d1\u73b0\u548c$t=0$\u662f\u4e00\u6837\u7684, \u8fd9\u73a9\u610f\u513f\u7684\u5faa\u73af\u8282\u957f\u5ea6\u5fc5\u5b9a\u662fab\u7684\u56e0\u6570.\n\n\u601d\u60f3\u5b9e\u9a8c2: \u8003\u8651**\u6bcf\u4e00\u4e2a**$(0,0)$\u7684\u60c5\u51b5, \u53d1\u73b0\u8fd9\u65f6\u5019$t mod b=0$, \u51b5\u4e14$(t+\\frac{t}{b}) mod a=0$\u6210\u7acb.\n\n\u90a3\u4e48\u8fd9\u4e2a\u60c5\u51b5\u4e5f\u548c$t=0$\u65f6\u76f8\u540c, \u51b5\u4e14\u8fd9**\u4e00\u5b9a\u662f\u6700\u5c0f\u5faa\u73af\u8282**. \u63a8\u4e00\u4e0b\u5f0f\u5b50, \u53d1\u73b0\u521a\u597d\u662f$\\frac{ab}{(a,b+1)}$\n\n\u6572\u9ed1\u677f\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u9700\u8981\u8bf4\u660e\u6bcf\u4e00\u4e2a\u5faa\u73af\u8282\u4e4b\u5185\u7684\u6570\u4e0d\u4f1a\u91cd\u590d.\n\n\u6211\u4eec\u518d\u505a\u4e00\u4e2a\u601d\u60f3\u5b9e\u9a8c: \u6211\u4eec\u53d1\u73b0$t mod b=1$\u65f6\u5de6\u8fb9\u4f1a+2, \u5176\u4f59\u65f6\u95f4+1, \u4e5f\u5c31\u662f\u8bf4, \u6bcf\u4e00\u6b21\u5de6\u8fb9+2\u7684\u65f6\u95f4\u662f\u56fa\u5b9a\u7684.\n\n\u90a3\u4e48\u5de6\u8fb9\u51fa\u73b0\u4e00\u4e2a\u786e\u5b9a\u7684\u6570\u5bf9, \u5b83\u5230\u4e0a\u4e00\u4e2a$(0,0)$\u6570\u5bf9\u7684\u65f6\u95f4\u4e00\u5b9a\u662f\u786e\u5b9a\u7684.\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u8bf4\u660e\u6570\u5bf9\u4e0d\u4f1a\u91cd\u590d\u4e86.\n\n\u7136\u540e\u5c31\u662f\u4e00\u9053\u7ebf\u6bb5\u5408\u5e76\u7684\u9898\u76ee\u4e86.\n\n\u5927\u529b\u6392\u4e2a\u5e8f\u7136\u540e\u5408\u5e76\u7b97\u957f\u5ea6\u5c31\u597d\u4e86.\n\n\u9898\u76ee\u96be\u5ea6: \u84dd\u724c\n\n\u653e\u4e00\u4e0b\u4ee3\u7801......\n\n```cpp\n// luogu-judger-enable-o2\n#include<iostream>\n#include<set>\n#include<map>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\nusing namespace std;\nnamespace fio{\n\tstreambuf*in=cin.rdbuf();\n\tchar bb[1000000],*s=bb,*t=bb;\n\t#define gc() (s==t&&(t=(s=bb)+in->sgetn(bb,1000000),s==t)?EOF:*s++)\n\tinline __int128 read(){\n\t\t__int128 x=0;\n\t\tchar ch=gc();\n\t\twhile(ch<48)ch=gc();\n\t\twhile(ch>=48)x=x*10+ch-48,ch=gc();\n\t\treturn x;\n\t}\n}using fio::read;\nint n;__int128 a,b;\ntypedef pair<__int128,__int128>mp;\nmp huaji[5000005];int top;\nmp huaji2[5000005];int top2;\nvoid w(__int128 x){\n\tif(x>=10)w(x/10);\n\tputchar(x%10+48);\n}\n__int128 gcd(__int128 a,__int128 b){return a==0?b:gcd(b%a,a);}\nint main(){\n\tn=read(),a=read(),b=read();\n\t__int128 lcm;\n\tlcm=a*b/gcd(a,b+1);\n\tfor(int i=1;i<=n;i++){\n\t\t__int128 l=read(),r=read();\n\t\tif(r-l+1>=lcm)w(lcm),exit(0);\n\t\tl%=lcm,r%=lcm;\n\t\tif(l<=r)huaji[++top]=mp(l,r);\n\t\telse huaji[++top]=mp(l,lcm-1),huaji[++top]=mp(0,r);\n\t}\n\tsort(huaji+1,huaji+top+1);\n\thuaji2[1]=huaji[1],top2=1;\n\tfor(int i=2;i<=top;i++){\n\t\tif(huaji[i].first<=huaji2[top2].second)huaji2[top2].second=max(huaji2[top2].second,huaji[i].second);\n\t\telse huaji2[++top2]=huaji[i];\n\t}\n\t__int128 ans=0;\n\tfor(int i=1;i<=top2;i++)ans+=huaji2[i].second-huaji2[i].first+1;\n\tw(ans);\n}\n```\n",
        "postTime": 1566478073,
        "uid": 38485,
        "name": "Erina",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5444 \u3010[APIO2019]\u5947\u602a\u88c5\u7f6e\u3011"
    },
    {
        "content": "$$\\href{http://blog.chhokmah.cn/index.php/archives/81/}{\\Large\\texttt{My blog}}$$\n\n\n-----\n## \u9898\u76ee\u6982\u62ec\n\u7ed9\u5b9a $n$ \u4e2a\u4e0d\u76f8\u4ea4\u7684\u533a\u95f4 $[l_i,r_i]$ \u548c $A$ \u548c $B$\u3002\n\n\u5b9a\u4e49\u4e00\u4e2a\u6570 $t$ \u5230\u53e6\u4e00\u4e2a\u4e8c\u5143\u7ec4\u7684\u6620\u5c04\u4e3a $t\\rightarrow ((t+\\lfloor \\frac tB\\rfloor) \\; mod \\; A,t \\; mod \\; B)$\n\n\u95ee\u8fd9\u4e9b\u533a\u95f4\u7684\u5e76\u4e2d\u6240\u6709\u6570\u7684\u6620\u5c04\u4e2d\u4e0d\u540c\u7684\u4e8c\u5143\u7ec4\u6709\u591a\u5c11\u4e2a\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$N\\leq 10^6,A,B,l_i,r_i\\leq 10^{18}$\n\n\n## \u601d\u8def\u8981\u70b9\n\u8003\u8651\u5faa\u73af\u8282\u5927\u5c0f\uff0c\u8bbe\u5faa\u73af\u8282\u957f\u5ea6\u4e3a $S$\uff0c\u4e8c\u5143\u7ec4\u5206\u522b\u4e3a\u4e24\u4e2a\u51fd\u6570\u8868\u793a\n\n$$\nx(t)=(t+\\lfloor \\frac tB\\rfloor) \\; mod \\; A\n$$\n\n$$\ny(t)=t \\; mod \\; B\n$$\n\n$$\nx(t+S)=(t+S+\\lfloor \\frac {t+S}B\\rfloor) \\; mod \\; A\n$$\n\n$$\ny(t+S)=(t+S) \\; mod \\; B\n$$\n\n$$\nt\\equiv t+S \\mod B\n$$\n\n\u663e\u7136\n$$\nS\\mod B=0\n$$\n\u90a3\u4e48\u4ee4$S=kB$\n$$\nx(t+kB)\\equiv (t+\\lfloor \\frac tB\\rfloor+kB+k)\\mod A\n$$\n\n$$\nk(B+1)\\mod A=0\n$$\n\n\u663e\u7136\n$$\nk=\\frac A{\\text{gcd}(B+1,A)}\n$$\n\u5faa\u73af\u8282\u5927\u5c0f\u4e3a\n$$\nB\\cdot \\frac A{\\text{gcd}(B+1,A)}\n$$\n\u7136\u540e\u5c31\u662f\u79bb\u6563\u5316\u540e\u7ebf\u6bb5\u8986\u76d6\u5373\u53ef\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(nlogn)$\n\n## \u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\n#define inf 0x3f3f3f3f\n#define INF 0x3f3f3f3f3f3f3f3f\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\n\nconst int N = 2e6 + 5;\n\nll A, B, cir, ans; \nint n, tot;\npair<ll, ll> sec[N];\n\ntemplate <class T> \nT gcd(T x, T y) {\n  return !y ? x : gcd(y, x % y); \n}\n\nll calc(ll x) {\n  return x % cir ? x % cir : cir; \n}\n\nint main() {\n  scanf(\"%d %lld %lld\", &n, &A, &B);\n  cir = A / gcd(A, B + 1);\n  if (3e18 / cir < B) \n    cir = 3e18;\n  else \n    cir *= B;\n  tot = n;  \n  for (int i = 1; i <= n; i++) {\n    scanf(\"%lld %lld\", &sec[i].first, &sec[i].second);\n    if (sec[i].second - sec[i].first + 1 >= cir) {\n      printf(\"%lld\\n\", cir);\n      return 0;\n    }\n    sec[i] = make_pair(calc(sec[i].first), calc(sec[i].second));\n    if (sec[i].first > sec[i].second) {\n      sec[++tot] = make_pair(sec[i].first, cir);\n      sec[i] = make_pair(1, sec[i].second);\n    }\n  }\n  sec[++tot] = make_pair(cir + 1, cir);\n  sort(sec + 1, sec + 1 + tot);\n  ll left = sec[1].first, right = sec[1].second;\n  for (int i = 2; i <= tot; i++) {\n    if (sec[i].first <= right) {\n      right = max(right, sec[i].second);\n    } else {\n      ans += right - left + 1; \n      left = sec[i].first, right = sec[i].second;\n    }\n  }\n  printf(\"%lld\\n\", ans);\n  return 0;\n}\n```\n\n## \u540e\u8a00\n- \u5bf9\u4e8e\u6570\u636e\u8f83\u5927\uff0c\u8fd9\u9898\u76ee\u53c8\u5b58\u5728\u6a21\u8fd0\u7b97\uff0c\u6240\u4ee5\u9898\u76ee\u7684\u7a81\u7834\u53e3\u4e00\u5b9a\u662f\u627e\u5faa\u73af\u8282\u3002",
        "postTime": 1585747387,
        "uid": 35567,
        "name": "Ayers",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5444 \u3010[APIO2019]\u5947\u602a\u88c5\u7f6e\u3011"
    },
    {
        "content": "#### \u6211\u4e5f\u662f\u5148\u819c\u62dc\u4e00\u4e0b\u53c2\u52a0APIO\u7684\u5927\u4f6c\u4eecorz\uff0c\u6211\u56e0\u4e3aNOIP\u592a\u83dc\u6ca1\u80fd\u53c2\u52a0\u3002\u3002\u3002\n\n~~\u7136\u540e\u6211\u65e0\u610f\u95f4\u770b\u5230\u6b64\u9898~~\uff0c\u795e\u4ed9\u9898\uff01~\n\n\u540e\u6765\u4ed4\u7ec6\u63a8\u4e86\u63a8\uff0c\u53d1\u73b0\u4e0d\u662f\u5f88\u96be\u3002\u3002\u8fc7\u4e86\u4e00\u9053APIO\u7684\u9898\uff0c\u6bd5\u7adf\u673a\u623f\u5927\u4f6c\u5728\u8003\u8bd5\u5f53\u5929\u5c31\u628a\u8fd9\u9898\u5207\u4e86\uff0c\u6240\u4ee5\u83dc\u9e21\u5728\u6b64\u5199\u7bc7\u9898\u89e3\u7eaa\u5ff5\u4e00\u4e0b\u3002\n\n___________\n\n\u8fd9\u9898\u4e0a\u6765\u5c31\u8ba9\u4eba\u5f88\u61f5\uff0c$x$\u548c$y$\u6beb\u65e0\u4f18\u7f8e\u6027\u8d28\uff0c\u6570\u636e\u4e5f\u5f88\u4e0d\u548c\u8c10\uff1a\u66b4\u529b\u53ea\u670915\u5206\u3002\n\n\u5bf9\u5927\u4f6c\u6765\u8bf4\u8fd9\u9898\u4e00\u4e0a\u6765\u5c31\u627e\u5230\u6b63\u89e3\u5207\u4e86\uff0c\u4f46\u672c\u83dc\u9e21\u4e0d\u662f\u4e00\u4e0a\u6765\u5c31\u63a8\u5f0f\u5b50\u7684\u4eba\uff0c\u6240\u4ee5\u6211\u662f\u628a$x$\u548c$y$\u90fd\u5217\u51fa\u6765\u4e86\u3002\u3002\u3002\n\n\u6211\u4eec\u53d1\u73b0x\u8fd9\u4e2a\u6570\u7531\u4e24\u90e8\u5206\u7ec4\u6210\uff0c\u6211\u4eec\u5c06$x$\u5206\u62102\u90e8\u5206\uff0c$x1 + x2$.\n\nx1 = t % A\uff0cx2 = \u230at/B\u230b % A;\n\n\u7136\u540e\u4ed4\u7ec6\u628a\u6837\u4f8b\u6a21\u62df\u4e00\u904d\uff0c\u6bd4\u5982A = 4\uff0cB = 5\u3002\n\n\n```\nt  \uff1a 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 | 15\n\nx1 \uff1a 0  1  2  3  0  1  2  3  0  1  2  3  0  1  2  | 3\nx2 \uff1a 0  0  0  0  0 |1  1  1  1  1 |2  2  2  2  2  | 3\ny  \uff1a 0  1  2  3  4 |0  1  2  3  4 |0  1  2  3  4  | 0\nx  :  0  1  2  3  0 |2  3  0  1  2 |0  1  2  3  0  | 2\n\n```\n\n\u63a5\u4e0b\u6765\u4e0d\u96be\u53d1\u73b0t%B\u548c\u230at/B\u230b\u7684\u6bcf\u4e00\u6bb5\u957f\u5ea6\u90fd\u4e3aB\uff0c\u6211\u4eec\u7528$\"|\"$\u5c06\u5176\u9694\u5f00\u3002\n\n\u6211\u4eec\u4e0d\u96be\u53d1\u73b0\uff1a$x$\u4e2d\u7684\u6bcf\u4e00\u6bb5\uff0c\u53ea\u8981\u7b2c\u4e00\u4e2a\u6570\u786e\u5b9a\uff0c\u540e\u9762\u7684\u6570\u90fd\u662f\u987a\u7740\u4e0b\u6765\uff0c\u4e5f\u662f\u786e\u5b9a\u7684\u3002\u6240\u4ee5\u5bf9\u4e8e\u4e00\u4e2a$t1$\u4e0e$t2$\uff0c\u5176$(x,y)$\u76f8\u7b49\uff0c\u90a3\u4e48$t1+1$\u4e0e$t2+1$\u7684$(x,y)$\u4e5f\u76f8\u7b49\uff0c\u6bd4\u5982\u4e0a\u8868\u4e2d\u76840\u4e0e10\u3002\n\n#### \u6240\u4ee5\u6b64\u9898\u5c31\u662f\u627e\u4e00\u4e2a\u5faa\u73af\u8282\uff1a\u6700\u5c0f\u7684\u5faa\u73af\u8282\u4f7f\u5f97\u4e24\u4e2a\u6570\u7684\uff08x\uff0cy\uff09\u76f8\u7b49\u3002\n\n\u7136\u540e\u5bf9\u4e8e\u8f93\u5165\u7684\u6bcf\u4e00\u6bb5\uff0cmod B\u4e4b\u540e\u5728\u5faa\u73af\u8282\u4e0a\u627e\u76f8\u5e94\u7684\u4f4d\u7f6e\uff0c\u6240\u6709\u7ebf\u6bb5\u7684\u4ea4\u96c6\u7684\u957f\u5ea6\u5c31\u662f\u6570\u5bf9\u7684\u4e2a\u6570\u3002\n\n\u5faa\u73af\u8282\u600e\u4e48\u627e\uff1f \u8fd9\u5c31\u5f88\u7b80\u5355\u4e86\uff1a\u65e2\u7136x\u4e0ey\u90fd\u76f8\u7b49\uff0c\u90a3\u4e48\u9996\u5148y\u80af\u5b9a\u5f97\u76f8\u7b49\u5bf9\u5427\uff0c\u6240\u4ee5\u5faa\u73af\u8282\u957f\u5ea6\u662fB\u7684\u500d\u6570\u3002\n\nx\u7684\u589e\u957f\u89c4\u5f8b\u5f88\u663e\u7136\uff1a\u6bcf\u4e2a\u6570+1\uff0c\u8fc7\u6bcf\u4e00\u6bb5\u518d+1\u3002\n\n\u6211\u4eec\u5047\u8bbek\u6bb5\u540e\u51fa\u73b0\u76f8\u7b49\u7684$x$\uff0c\u5219\n\n$$\\begin{cases}t1+k+k*B=t2\\\\t1+k+k*B\\equiv t1(mod\\ A)\\\\(B+1)*k\\equiv0(mod\\ A)\\end{cases}$$\n\n\u6c42\u4e00\u4e2a\u6700\u5c0f\u7684k\uff0c\u4ed6\u5c31\u662f $gcd(B+1, A)$;$\\ \\ $\u5faa\u73af\u8282\u957f\u5ea6\u5c31\u662f$B*k$\u3002\n\n\u7136\u540e\u5c31\u597d\u529e\u4e86~\uff0c\u8ba1\u7b97\u6bcf\u4e00\u6bb5\u8be2\u95ee\u5728\u5faa\u73af\u8282\u4e0a\u5bf9\u5e94\u7684\u4f4d\u7f6e\uff0c\u505a\u4e00\u904d\u7ebf\u6bb5\u8986\u76d6\u3002\u6309\u5de6\u7aef\u70b9\u6392\u597d\u5e8f\uff0c\u66f4\u65b0\u6700\u53f3\u7aef\u70b9\u7684\u4f4d\u7f6e\uff0c\u6211\u89c9\u5f97\u80af\u5b9a\u90fd\u4f1a\u5427\uff0c\u5177\u4f53\u5728\u4ee3\u7801\u91cc\u3002\n\n#### \u6b64\u9898\u8fd8\u8981\u6ce8\u610f\u4e00\u4e2a\u7ec6\u8282\uff1a\u4f1a\u4e0d\u4f1a\u7206long long\uff1f\n\n#### \u80af\u5b9a\u4e0d\u4f1a\u4e86~\uff0ct\u90fd\u6ca1\u90a3\u4e48\u5927\u600e\u4e48\u4f1a\u7206\uff1f\n\n\u4f46\u662f\u4f60\u8ba1\u7b97\u7684\u5faa\u73af\u8282\u957f\u5ea6\u662f$A*B/gcd(B+1,A)$\u7684\uff0c\u662f\u53ef\u4ee5\u7206\u7684\uff0c\u4e8e\u662f\u7a0d\u5fae\u5904\u7406\u4e00\u4e0b\uff0c\u5982\u679c\u7b97\u51fa\u6765\u7684\u5faa\u73af\u8282\u957f\u662f\u8d1f\u6570\uff0c\u5c31\u628a\u5faa\u73af\u8282\u6539\u6210\u65e0\u9650\u5927\u3002\n\n```cpp\n#include<algorithm>\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<cmath>\n#define QWQ cout<<\"QwQ\"<<endl;\n#define ll long long \n#include<vector>\n#include<queue>\n#include<stack>\n#include<map>\nusing namespace std;\nconst ll N=2001010;\nconst ll qwq=303030;\nconst ll inf=0x3f3f3f3f3f3f3f3f;\nll n,m;\nll H,R;\nll x,y;\nll A,B;\nll ans,cnt;\nstruct E{ ll l,r; } e[N];\n\ninline ll read() {\n\tll sum = 0; char c = getchar();\n\twhile(c<'0' || c>'9') c = getchar();\n\twhile(c>='0'&&c<='9') { sum = sum * 10 + c - '0'; c = getchar(); }\n\treturn sum;\n}\n\nll gcd(ll a,ll b) { return a%b==0 ? b : gcd(b,a%b); }\n\ninline bool cmp(E aa,E bb) { return aa.l < bb.l; }\n\nint main() {\n\tn = read(); A = read(); B = read();\n\tH = A / gcd(B+1,A) * B;\n\tif(H < 0) H = inf;            //\u7206long long\n\tfor(int i=1;i<=n;i++) {\n\t\tx = read(); y = read();\n\t\tif(y-x+1>=H) { e[++cnt] = (E){0,H-1}; break; }                  //\u6574\u4e2a\u533a\u95f4\u90fd\u80fd\u8986\u76d6\u3002\n\t\tx = x % H; y = y % H;\n\t\tif(y>=x) { e[++cnt] = (E){x,y}; }        //x\uff0cy\u5728\u533a\u95f4\u5185\u3002\n\t\telse {                //x\uff0cy\u5728\u533a\u95f4\u4e24\u904d\u3002\n\t\t\te[++cnt] = (E){0,y};\n\t\t\te[++cnt] = (E){x,H-1};\n\t\t}\n\t}\n\tsort(e+1,e+cnt+1,cmp); R = e[1].r;\n\tfor(int i=1;i<=cnt;i++) {\n\t\tans += max((ll)0,e[i].l-R-1);\n\t\tR = max(R,e[i].r);\n\t}\n\tprintf(\"%lld\",H-(H-e[cnt].r)-e[1].l-ans+1);\n\treturn 0;\n}\n\n```",
        "postTime": 1569367284,
        "uid": 102726,
        "name": "Flandre_495",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5444 \u3010[APIO2019]\u5947\u602a\u88c5\u7f6e\u3011"
    },
    {
        "content": "## Analysis\n\n\u663e\u7136\u968f\u7740 $t$ \u7684\u589e\u5927\uff0c$(x,y)$ \u662f\u6709\u5faa\u73af\u8282\u7684\u3002\n\n\u4f46\u662f\u5faa\u73af\u8282\u6709\u591a\u957f\u5462\uff1f\n\n### \u6c42\u6700\u5c0f\u5faa\u73af\u8282\u957f\u5ea6\n\n* * *\n**\u5f15\u7406\uff1a**\n$$\nA\\ |\\ BC\n\\iff\n\\frac{A}{\\gcd(A,B)}\\ |\\ C\n$$\n* * *\n\n\u8fd9\u91cc\u6211\u4eec\u79f0 $(x,y)$ \u76f8\u540c\u7684 $t$ \u7684\u96c6\u5408\u4e3a\u7b49\u4ef7\u7c7b\u3002\n\n$r<s\\ (\\in\\mathbb{N})$ \u4e3a\u4e24\u4e2a\u7b49\u4ef7\u7684\u65f6\u523b\uff0c\u5f53\u4e14\u4ec5\u5f53\n$$\\begin{aligned}\nr+\\left\\lfloor\\frac{r}{B}\\right\\rfloor\n&\\equiv\ns+\\left\\lfloor\\frac{s}{B}\\right\\rfloor\n&\\pmod{A}\n\\quad\n&(1)\n\\\\\nr\n&\\equiv\ns\n&\\pmod{B}\n\\quad\n&(2)\n\\end{aligned}$$\n\u7531 $(2)$ \u8bbe $s=kB+r\\ (k\\in\\mathbb{N}^+)$\uff0c\u5219 $(1)$ \u5f0f\u6539\u4e3a\n\n\uff08\u4ee5\u4e0b\u5168\u90e8\u4e3a $\\pmod{A}$\uff09\n$$\\begin{aligned}\n&\nr+\\left\\lfloor\\frac{r}{B}\\right\\rfloor\n\\equiv\ns+\\left\\lfloor\\frac{s}{B}\\right\\rfloor\n\\\\\n\\iff\\quad&\nr+\\left\\lfloor\\frac{r}{B}\\right\\rfloor\n\\equiv\nkB+r+\\left\\lfloor\\frac{kB+r}{B}\\right\\rfloor\n\\\\\n\\iff\\quad&\nr+\\left\\lfloor\\frac{r}{B}\\right\\rfloor\n\\equiv\nkB+r+\\left\\lfloor\\frac{r}{B}+k\\right\\rfloor\n\\\\\n\\iff\\quad&\nr+\\left\\lfloor\\frac{r}{B}\\right\\rfloor\n\\equiv\nkB+r+\\left\\lfloor\\frac{r}{B}\\right\\rfloor+k\n\\\\\n\\iff\\quad&\nkB+k\n\\equiv\n0\n\\\\\n\\iff\\quad&\nk(B+1)\n\\equiv\n0\n\\\\\n\\iff\\quad&\nA\\ |\\ k(B+1)\n\\\\\n\\iff\\quad&\n\\frac{A}{\\gcd(A,B+1)}\\ |\\ k\n\\end{aligned}$$\n\n\u7531\u4e8e\u6211\u4eec\u8981\u6c42**\u6700\u5c0f**\u5faa\u73af\u8282\u957f\u5ea6 $kB$\uff0c\u6240\u4ee5\u8981 $k$ \u6700\u5c0f\uff0c\u4e3a\n$$\n\\frac{A}{\\gcd(A,B+1)}\n$$\n\u6700\u5c0f\u5faa\u73af\u8282\u4e3a\n$$\n\\frac{AB}{\\gcd(A,B+1)}\n$$\n\n### \u73af\u5f62\u533a\u95f4\u8986\u76d6\u95ee\u9898\n\n\u8bbe\u6211\u4eec\u6c42\u51fa\u7684\u6700\u5c0f\u5faa\u73af\u8282\u4e3a $d$\u3002\n\n\u82e5\u6709\u4e00\u4e2a $r_i-l_i+1\\ge d$\uff0c\u5219\u6240\u6709\u53ef\u80fd\u7684 $(x,y)$ \u5747\u88ab\u53d6\u5230\uff0c\u8f93\u51fa $d$ \u5373\u53ef\u3002\n\n\u5426\u5219\uff0c\u5c31\u662f\u5728\u540c\u4f59\u7cfb\u4e2d\u7684\u533a\u95f4\u8986\u76d6\u95ee\u9898\u4e86\u3002\n\n\u63a5\u4e0b\u6765\u6709\u591a\u79cd\u5199\u6cd5\uff0c\u6211\u8fd9\u91cc\u7528\u6392\u5e8f + \u6c42\u8fde\u7eed\u6bb5\u7684\u65b9\u6cd5\uff0c\u5177\u4f53\u770b\u4ee3\u7801\u3002\n\n## Detail\n\n\u6700\u5c0f\u5faa\u73af\u8282\u53ef\u80fd\u4f1a\u7206 int64\uff0c\u6240\u4ee5\u5efa\u8bae\u7528 long double \u5224\u65ad\u662f\u5426 $>10^{18}$\uff0c\u82e5\u662f\u5219\u8bbe\u4e3a $10^{18}$\u3002\uff08\u56e0\u4e3a\u5faa\u73af\u8282\u592a\u957f\u76f8\u5f53\u4e8e\u6ca1\u5faa\u73af\uff09\n\n## Code\n\n```cpp\n//Said no more counting dollars. We'll be counting stars.\n//#pragma GCC optimize(\"Ofast\")\n//#pragma GCC optimize(\"unroll-loops\")//DONT use rashly,I have suffered\n//#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,avx2,tune=native\")//DONT use rashly,I have suffered\n#include<bits/stdc++.h>\nusing namespace std;\n#define IOS ios::sync_with_stdio(0);cin.tie(0);cout.tie(0)\n#define fir first\n#define sec second\n#define mkp make_pair\n#define pb emplace_back\n#define mem(x,y) memset(x,y,sizeof(x))\n#define For(i,j,k) for(int i=j;i<=k;i++)\n#define Rof(i,j,k) for(int i=j;i>=k;i--)\n#define Fe(x,y) for(int x=head[y];x;x=e[x].nxt)\n#define ckmx(a,b) a=max(a,b)\n#define ckmn(a,b) a=min(a,b)\n#define fin(s) freopen(s,\"r\",stdin)\n#define fout(s) freopen(s,\"w\",stdout)\n#define file(s) fin(s\".in\");fout(s\".out\")\n#define cerr cerr<<'_'\n#define debug cerr<<\"Passed line #\"<<__LINE__<<endl\ntemplate<typename T>T ov(T x){cerr<<\"Value: \"<<x<<endl;return x;}\n#define ll long long\nconst ll mod=1000000007;\ninline ll pw(ll x,ll y){ll r=1;while(y){if(y&1)r=r*x%mod;x=x*x%mod;y>>=1;}return r;}\ninline void mad(ll &a,ll b){a=(a+b)%mod;while(a<0)a+=mod;}\ninline void mmu(ll &a,ll b){a=a*b%mod;while(a<0)a+=mod;}\n#define inv(a) pw(a,mod-2)\n#define int long long\n#define N -1\n\nconst long double Lim=1.1e18;\nint n,A,B;\nlong double mul(int x,int y){\n\tlong double xx=x,yy=y;\n\treturn xx*yy;\n}\nvector<pair<int,int> > v;\nsigned main(){IOS;\n\tcin>>n>>A>>B;\n\tA/=__gcd(A,B+1);\n\tif(mul(A,B)>=Lim) A=Lim;//\u5faa\u73af\u8282 > 1e18\uff0c\u76f8\u5f53\u4e8e\u6ca1\u6709\u5faa\u73af \n\telse A*=B;\n\tint x,y;\n\tFor(i,1,n){\n\t\tcin>>x>>y;\n\t\tif(y-x+1>=A){\n\t\t\tcout<<A<<endl;\n\t\t\treturn 0;\n\t\t}\n\t\tx%=A;\n\t\ty%=A;\n\t\tif(x<=y){\n\t\t\tv.pb(mkp(x,y));\n\t\t}else{\n\t\t\tv.pb(mkp(x,A-1));\n\t\t\tv.pb(mkp(0,y));\n\t\t}\n\t}\n\tsort(v.begin(),v.end());\n\tint lst=-1,now=-2,ans=0;\n\tfor(auto i:v)\n\t\tif(i.fir<=now){\n\t\t\tckmx(now,i.sec);\n\t\t}else{\n\t\t\tans+=now-lst+1;\n\t\t\tlst=i.fir;\n\t\t\tnow=i.sec;\n\t\t}\n\tans+=now-lst+1;\n\tcout<<ans<<endl;\nreturn 0;}\n```",
        "postTime": 1652885572,
        "uid": 101868,
        "name": "I_am_Accepted",
        "ccfLevel": 0,
        "title": "P5444 [APIO2019]\u5947\u602a\u88c5\u7f6e\uff08\u7b49\u4ef7\u7c7b\u5faa\u73af\u8282\u3001\u73af\u5f62\u533a\u95f4\u8986\u76d6\uff09"
    },
    {
        "content": "\u8fd9\u9053\u9898\u8fd8\u662f\u6bd4\u8f83\u6c34\u7684\u3002\n\n\u9996\u5148\u663e\u7136\u6211\u4eec\u4e0d\u80fd\u8003\u8651\u600e\u4e48\u6837\u4f1a\u4e0d\u540c\uff0c\u800c\u662f\u5e94\u8be5\u8003\u8651\u4ec0\u4e48\u60c5\u51b5\u4f1a\u76f8\u540c\u3002\n\n\u4e0d\u59a8\u5047\u8bbe\u5728 $t$ \u548c $t'$ \u7684\u65f6\u95f4\u76f8\u540c\uff0c\u4e0d\u59a8 $t' > t$\u3002\n\n\u90a3\u4e48 $t' \\equiv t (\\mod B)$\u3002\u8bbe $t' = t + Bx$\u3002\n\n\u90a3\u4e48 $t + \\lfloor \\frac{t}{B}\\rfloor \\equiv t + Bx + \\lfloor \\frac{t}{B} \\rfloor + x (\\mod A)$\u3002\n\n\u6240\u4ee5 $bx + x \\equiv 0 (\\mod A)$\u3002\n\n\u6240\u4ee5 $A | (b+1)x \\Rightarrow \\frac{A}{\\gcd(A, B+1)} | x$\u3002\n\n\u56e0\u6b64\u76f8\u7b49\u7684\u5faa\u73af\u8282\u662f $Bx = \\frac{AB}{\\gcd(A, B+1)}$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u8003\u8651\u5728\u8fd9\u4e2a\u5faa\u73af\u8282\u4e2d\u6709\u591a\u5c11\u53ef\u4ee5\u53d6\u5230\uff0c\u4e5f\u5c31\u662f\u7ed9\u51fa\u82e5\u5e72\u6761\u7ebf\u6bb5\u5728 $[0,Bx]$ \u4e4b\u95f4\u7684\u7ebf\u6bb5\uff0c\u6c42\u603b\u8986\u76d6\u957f\u5ea6\u3002\n\n\u8d2a\u5fc3\u5373\u53ef\u3002\n\n[Code](https://www.luogu.com.cn/paste/hgg2z7o4)",
        "postTime": 1597364666,
        "uid": 319914,
        "name": "Aftershock",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5444 \u3010[APIO2019]\u5947\u602a\u88c5\u7f6e\u3011"
    }
]
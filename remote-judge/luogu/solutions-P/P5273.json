[
    {
        "content": "\u524d\u7f6e\u829d\u58eb\uff1a\u591a\u9879\u5f0f $\\exp$\u3001\u591a\u9879\u5f0f $\\ln$\n\n\u63a8\u5f0f\u5b50\n$$B(x)\\equiv A^m(x)(\\mathrm{mod\\:}x^n)$$\n\u540c\u65f6\u53d6\u5bf9\u6570\n$$\\ln B(x)\\equiv m\\ln A(x)(\\mathrm{mod\\:}x^n)$$\n\u6240\u4ee5\u5bf9 $A(x)$ \u53d6 $\\ln$\uff0c\u7cfb\u6570\u4e58\u4e0a $m$\uff0c\u518d $\\exp$ \u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u7136\u800c\u8fd9\u9898\u5e76\u4e0d\u4fdd\u8bc1 $a_0=1$\uff0c\u6240\u4ee5\u53d6 $\\ln$ \u4e4b\u524d\u8981\u5148\u63d0\u53d6\u4e00\u4e2a\u516c\u56e0\u5f0f $b\\times x^k$\uff0c\u5176\u4e2d $k$ \u6ee1\u8db3 $a_k\\ne0,\\text{\u4e14}\\ \\forall\\ 0\\le i< k,a_i=0$, $b$ \u4e3a\u7b2c\u4e00\u4e2a\u975e $0$ \u9879\u7684\u7cfb\u6570(\u5373 $x_k$ \u7684\u7cfb\u6570)\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u6700\u4f4e\u4f4d\u662f $1$ \u4e86\u3002\u6ce8\u610f $k\\times m>n$ \u7684\u7279\u6b8a\u5904\u7406\u3002\n\n\u6700\u65b0\u6570\u636e\u4e2d\u6709\u4e00\u4e2a\u7ec6\u8282\uff1a\u65b0\u7684 $A^m(x)$ \u7684 $m$ \u662f\u5bf9 $p$ \u53d6\u6a21\u7684\uff0c\u800c $b^m$ \u4e2d\u7684 $m$ \u5e94\u8be5\u5bf9 $\\varphi(p)$ \u53d6\u6a21\u3002\n\n\u7136\u540e\u591a\u9879\u5f0f\u5168\u5bb6\u6876\u62c9\u8fc7\u6765\u5c31\u597d\u4e86\u3002\n\n\u7531\u4e8e\u672a\u5bf9\u4ee3\u7801\u8fdb\u884c\u6709\u6548\u5207\u5272\uff08\u76f4\u63a5\u5957\u7528\u4e86\u591a\u9879\u5f0f\u677f\u5b50\uff09\uff0c[\u4ee3\u7801](https://www.luogu.com.cn/paste/1g3n4xrj)\u4ee5\u94fe\u63a5\u5f62\u5f0f\u7ed9\u51fa\u907f\u514d\u6324\u5360\u7248\u9762\u3002",
        "postTime": 1553519097,
        "uid": 29826,
        "name": "SSerxhs",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5273 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5e42\u51fd\u6570 (\u52a0\u5f3a\u7248)\u3011"
    },
    {
        "content": "\u505a\u8fc7[P5245 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5feb\u901f\u5e42](https://www.luogu.org/problemnew/show/P5245)\u7684\u90fd\u77e5\u9053\uff0c\u6c42 $F(x)^k$ \u65f6\uff0c\u82e5 $F(0)=1$\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u7528$\\ln+\\exp$\u6765\u641e\u3002   \n\u4e5f\u5c31\u662f\u8fd9\u4e2a\u5f0f\u5b50\uff1a  \n$$F(x)^k= \\text e^{k\\ln F(x)}$$\n****\n\u53ef\u662f\u73b0\u5728\u4e0d\u4fdd\u8bc1 $F(0)=1 $\u4e86\uff0c\u6211\u4eec\u5c31\u5f97\u60f3\u60f3\u529e\u6cd5\uff0c\u628a $F(0)$ \u641e\u6210$1$\u3002  \n\u53ea\u8981\u628a $F(x)$ \u7684\u6bcf\u4e00\u9879\u90fd\u9664\u4ee5 $F(0)$ \uff0c\u95ee\u9898\u4e0d\u5c31\u89e3\u51b3\u4e86\u4e48\uff1f\n\n$$F(x)^k=\\left(\\frac{F(x)}{F(0)} \\right)^kF(0)^k$$  \n\u4ed4\u7ec6\u4e00\u770b\uff1a\u4e0d\u5bf9\uff0c\u5982\u679c $F(0)=0$ \u7684\u8bdd\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5c31\u6302\u6389\u4e86\u3002    \n\u8fd9\u65f6\uff0c\u53ef\u4ee5\u8003\u8651\u5c06 $F(x)$ \u964d\u6b21\uff0c\u7136\u540e\u518d\u5347\u6b21\u3002  \n\u5177\u4f53\u6765\u8bb2\uff0c\u6211\u4eec\u8981\u627e\u51fa\u6700\u5c0f\u7684 $t$\uff0c\u6ee1\u8db3 $F(x)$ \u7684 $t$ \u6b21\u9879\u4e0d\u4e3a$0$\u3002   \n$$F(x)^k=\\left(\\frac{F(x)}{x^t} \\right)^kx^{tk}$$  \n  \n\n\u7136\u540e\u76f4\u63a5\u6a21\u62df\u8fc7\u7a0b+\u5957\u6a21\u677f\u5373\u53ef\u3002  \n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n\\log n)$\uff0c\u6bd4\u500d\u589e\u6cd5\u4e0d\u77e5\u9ad8\u5230\u54ea\u91cc\u53bb\u4e86\u3002\n \n```cpp\n#pragma GCC optimize (2)\n#pragma GCC optimize (\"unroll-loops\")\n#include<cstdio>\n#include<iostream>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#define N 262147\n#define ll long long\n#define reg register\n#define p 998244353\n#define add(x,y) (x+y>=p?x+y-p:x+y)\n#define dec(x,y) (x<y?x-y+p:x-y)\nusing namespace std;\n\ninline int power(int a,int t){\n\tint res = 1;\n\twhile(t){\n\t\tif(t&1) res = (ll)res*a%p;\n\t\ta = (ll)a*a%p;\n\t\tt >>= 1; \n\t}\n\treturn res;\n}\n\nint rev[N],rt[N],inv[N];\nint siz;\n\nvoid init(int n){\n    int w,lim = 1;\n    while(lim<=n) lim <<= 1,++siz;\n    for(reg int i=1;i!=lim;++i) rev[i] = (rev[i>>1]>>1)|((i&1)<<(siz-1));\n    inv[1] = rt[lim>>1] = 1;\n    w = power(3,(p-1)>>siz);\n    for(reg int i=(lim>>1)+1;i!=lim;++i) rt[i] = (ll)rt[i-1]*w%p;\n    for(reg int i=(lim>>1)-1;i;--i) rt[i] = rt[i<<1];\n    for(reg int i=2;i<=n;++i) inv[i] = (ll)(p-p/i)*inv[p%i]%p;\n}\n\ninline int getlen(int n){\n    return 1<<(32-__builtin_clz(n));\n}\n\ninline void NTT(int *f,int type,int lim){\n    if(type==-1) reverse(f+1,f+lim);\n    static unsigned long long a[N];\n    reg int x,shift = siz-__builtin_ctz(lim);\n    for(reg int i=0;i!=lim;++i) a[rev[i]>>shift] = f[i];\n    for(reg int mid=1;mid!=lim;mid<<=1)\n    for(reg int j=0;j!=lim;j+=(mid<<1))\n    for(reg int k=0;k!=mid;++k){\n        x = a[j|k|mid]*rt[mid|k]%p;\n        a[j|k|mid] = a[j|k]-x+p;\n        a[j|k] += x;\n    } \n    for(reg int i=0;i!=lim;++i) f[i] = a[i]%p;\n    if(type==1) return;\n    x = p-((p-1)>>(siz-shift));\n    for(reg int i=0;i!=lim;++i) f[i] = (ll)f[i]*x%p;\n}\n\ninline void inverse(const int *f,int n,int *R){\n    static int g[N],h[N],s[30];\n    memset(g,0,getlen(n<<1)<<2);\n    int lim = 1,top = 0;\n    while(n){\n        s[++top] = n;\n        n >>= 1;\n    }\n    g[0] = power(f[0],p-2);\n    while(top--){\n        n = s[top+1];\n        while(lim<=(n<<1)) lim <<= 1;\n        memcpy(h,f,(n+1)<<2);\n        memset(h+n+1,0,(lim-n)<<2);\n        NTT(g,1,lim),NTT(h,1,lim);\n        for(reg int i=0;i!=lim;++i) g[i] = g[i]*(2-(ll)g[i]*h[i]%p+p)%p;\n        NTT(g,-1,lim);\n        if(top) memset(g+n+1,0,(lim-n)<<2);\n    }\n    memcpy(R,g,(n+1)<<2);\n}\n\ninline void log(int *f,int n){\n    static int g[N];\n    int lim = getlen(n<<1);\n    inverse(f,n,g);\n    memset(g+n+1,0,(lim-n)<<2);\n    for(reg int i=0;i!=n;++i) f[i] = (ll)f[i+1]*(i+1)%p;\n    f[n] = 0;\n    NTT(f,1,lim),NTT(g,1,lim);\n    for(reg int i=0;i!=lim;++i) f[i] = (ll)f[i]*g[i]%p;\n    NTT(f,-1,lim);\n    for(reg int i=n;i;--i) f[i] = (ll)f[i-1]*inv[i]%p;\n    f[0] = 0;\n    memset(f+n+1,0,(lim-n)<<2);\n}\n\ninline void exp(int *f,int n){\n    static int g[N],h[N],s[30];\n    int lim = 1,top = 0;\n    memset(g,0,getlen(n<<1)<<2);\n    while(n){\n        s[++top] = n;\n        n >>= 1;\n    }\n    g[0] = 1;\n    while(top--){\n        n = s[top+1];\n        while(lim<=(n<<1)) lim <<= 1;\n        memcpy(h,g,(n+1)<<2);\n        memset(h+n+1,0,(lim-n)<<2);\n        log(g,n);\n        for(reg int i=0;i<=n;++i) g[i] = dec(f[i],g[i]);\n        g[0] = add(g[0],1);\n        NTT(g,1,lim),NTT(h,1,lim);\n        for(reg int i=0;i!=lim;++i) g[i] = (ll)g[i]*h[i]%p;\n        NTT(g,-1,lim);\n        memset(g+n+1,0,(lim-n)<<2);\n    }\n    memcpy(f,g,(n+1)<<2);\n}\n\ninline void power(int *f,int n,int k1,int k2){\n    register int u,v,shift = 0;\n    for(reg int i=0;i<=n&&f[i]==0;++i) ++shift;\n    if((ll)shift*k1>n){\n        for(reg int i=0;i<=n;++i) printf(\"0 \");\n        return;\n    }\n    u = power(f[shift],p-2),v = power(f[shift],k2);\n    for(reg int i=0;i<=n;++i) f[i] = (ll)f[i+shift]*u%p;\n    log(f,n);\n    for(reg int i=1;i<=n;++i) f[i] = (ll)f[i]*k1%p;\n    exp(f,n);\n    shift *= k1;\n    for(reg int i=0;i!=shift;++i) printf(\"0 \");\n    for(reg int i=shift;i<=n;++i) printf(\"%lld \",(ll)f[i-shift]*v%p);\n}\n\nint F[N];\nchar str[N];\nint n,k1,k2,k3;\n\nint main(){\n    scanf(\"%d%s\",&n,str);\n    int ln = strlen(str);\n    for(reg int i=0;i!=ln;++i){\n        k1 = (10ll*k1+str[i]-'0')%p;\n        k2 = (10ll*k2+str[i]-'0')%(p-1);\n    }\n    for(reg int i=0;i!=min(6,ln);++i) k3 = 10*k3+str[i]-'0';\n    for(reg int i=0;i!=n;++i) scanf(\"%d\",&F[i]);\n    if(F[0]==0&&k3>=n){\n        for(reg int i=0;i!=n;++i) printf(\"0 \");\n        return 0;\n    }\n    init(n<<1|1);\n    power(F,n-1,k1,k2);\n\treturn 0;\t\n}\n```",
        "postTime": 1553613643,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5273 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5e42\u51fd\u6570 (\u52a0\u5f3a\u7248)\u3011"
    },
    {
        "content": "## ~~\u5e7f\u544a:[\u3010\u591a\u9879\u5f0f\u7684\u64cd\u4f5c\u5927\u8d4f\u3011](https://blog.csdn.net/weixin_43973966/article/details/87864851)~~\n\n$\\ \\ \\ \\ \\ \\ \\ $\u8fd9\u9053\u9898\u554a\uff0c\u76f8\u5bf9\u4e8e\u5e38\u89c4\u7248\u5c11\u4e86\u4e00\u4e2a\u6761\u4ef6\uff1a$a[0]=1$\uff0c\u90a3\u4e48\u8fd9\u9053\u9898\u552f\u4e00\u7684\u75db\u70b9\u5c31\u662f\uff0c\u5982\u4f55\u628a $a[0]$ \u5316\u6210\u5bf9\u4e8e $1$ \u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u4e86\u89e3\u5230\u5462\uff0c\u5f88\u591a\u540c\u5b66\u662f\u5316\u6210\u4e0b\u9762\u7684\u5f0f\u5b50\u6765\u5904\u7406\u7684\uff1a\n\n$$A^k=\\left({\\frac{A}{A_0}}\\right)^k\\times A_0^k$$\n\n$\\ \\ \\ \\ \\ \\ \\ $\u8fd9\u6837\u5b50\u5c31\u53ef\u4ee5\u6210\u529f\u628a $a[0]$ \u5316\u6210\u5bf9\u4e8e $1$ \uff0c\u7136\u540e\u5355\u72ec $a[0]=0$ \u5904\u7406\uff0c\u5269\u4e0b\u7684\u5c31\u662f\u5957$ln$\uff0c$exp$\u677f\u5b50\u4e86\u3002\n\n# $\\ \\ \\ \\ \\ \\ \\ $\u4f46\u662f\u8fd9\u6837\u6709\u6ca1\u6709\u5fc5\u8981\u5462\uff1f\u663e\u7136\u662f\u6ca1\u6709\u5fc5\u8981\u7684\uff1a\n\n$\\ \\ \\ \\ \\ \\ \\ $\u9996\u5148\u8003\u8651\u4e3a\u4ec0\u4e48\u4e00\u5b9a\u8981\u4fdd\u8bc1$a[0]=1$\uff1f\n\n$\\ \\ \\ \\ \\ \\ \\ $\u56e0\u4e3a\u8fd9\u6837\u53ef\u4ee5\u4fdd\u8bc1 $ln(A)_0\\times k=0$ \uff0c\u4ece\u800c\u65b9\u4fbf\u7b97\u51fa$exp$\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u90a3\u4e48\u4e3a\u4ec0\u4e48\uff1f\u5f53 $ln(A)_0\\times k=0$ \u7b49\u4e8e\u5176\u4ed6\u6570\u7684\u65f6\u5019\uff0c\u4e0d\u65b9\u4fbf\u7b97$exp$\u4e86\u5462\uff1f\n\n$\\ \\ \\ \\ \\ \\ \\ $\u6211\u4eec\u5f97\u56de\u5fc6\u4e00\u4e0b$exp$\u662f\u600e\u4e48\u6c42\u7684:\n\n$\\ \\ \\ \\ \\ \\ \\ $\u4ee4\u6211\u4eec\u8981\u6c42\u7684\u662f $A$ \u7684\u6307\u6570\u51fd\u6570 $B$\uff0c\u65e2\u662f\uff1a\n\n$$B=e^A$$\n\n$\\ \\ \\ \\ \\ \\ \\ $\u53d8\u5f62\u5f97\uff1a\n\n$$\\ln(B)-A=0$$\n\n$\\ \\ \\ \\ \\ \\ \\ $\u8bbe$F(B)=\\ln (B)-A$\uff0c\u6211\u4eec\u8981\u6c42\u7684\u5c31\u662f $F$\u7684\u96f6\u70b9\uff0c\u8fd9\u91cc\u662f\u5427\u591a\u9879\u5f0f\u5f53\u505a\u5e38\u91cf\u4e86\uff0c\u725b\u987f\u8fed\u4ee3\u5f97\u5230\u7684\u5f0f\u5b50\uff08\u6ce8\u610f\u8fd9\u91ccB\u540e\u9762\u7684\u62ec\u53f7\u7684\u8fed\u4ee3\u7248\u672c\u7684\u610f\u601d\uff0c\u4e0d\u662f\u591a\u9879\u5f0f\u7684\u9879\uff0c\u4e0b\u6807\u624d\u662f\u8868\u793a\u7684\u9879\uff09\uff1a\n\n$$B(x)=B(x-1)-\\frac{F\\left(B(x-1)\\right)}{F'\\left(B(x-1)\\right)}$$\n\n$\\ \\ \\ \\ \\ \\ \\ $\u7531$F'(B)=\\frac{1}{B}$\uff0c\u5316\u7b80\u725b\u987f\u8fed\u4ee3\u7684\u516c\u5f0f\uff1a\n\n$$\\begin{aligned}B(x)&=B(x-1)-B(x-1)*F\\left(B(x-1)\\right)\\\\&=B(x-1)-B(x-1)*\\ln \\left(B(x-1)\\right)-A\\\\&=B(x-1)* \\left(1-\\ln \\left(B(x-1)\\right)-A \\right)\\end{aligned}$$\n\n$\\ \\ \\ \\ \\ \\ \\ $\u5728\u500d\u589e\u6c42\u89e3\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u53ea\u9700\u8981\u77e5\u9053\u7b2c\u4e00\u4e2a\u7248\u672c\u662f\u591a\u5c11\uff0c\u4e5f\u5c31\u662f $B_0$ \uff0c\u5e38\u6570\u9879\u7684\u503c\u5c31\u77e5\u9053\u4e86\uff1a\n\n$\\ \\ \\ \\ \\ \\ \\ $\u5728\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e2a\u95ee\u9898\u5f88\u663e\u7136\uff0c\u56e0\u4e3a\uff1a$e^0=1$\uff0c\u6240\u4ee5\u8bf4\u5f53$A_0=0$\u7684\u65f6\u5019\uff0c\u4ed6\u7684\u6307\u6570\u51fd\u6570 $B$\uff0c$B_0=1$\uff0c\u7b2c\u4e00\u4e2a\u7248\u672c\u5c31\u786e\u5b9a\u4e86\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u5f53$A_0\\neq0$\u7684\u65f6\u5019\uff0c\u7b2c\u4e00\u4e2a\u7248\u672c\u786e\u5b9e\u4e0d\u597d\u6c42\u3002\n\n# $\\ \\ \\ \\ \\ \\ \\ $\u56de\u5230\u9898\u76ee\uff1a\n\n$\\ \\ \\ \\ \\ \\ \\ $\u597d\u5728\u6211\u4eec\u5f88\u6e05\u695a\u7684\u662f\uff1a\n\n$\\ \\ \\ \\ \\ \\ \\ $\u5bf9\u4e8e\u6c42$B=A^k$\uff0c\u6709\uff1a\n\n$$B=exp(ln(A)\\times k)$$\n\n$\\ \\ \\ \\ \\ \\ \\ $\u597d\u4e86\uff0c\u6211\u4eec\u8981\u6c42\u7684\u7b2c\u4e00\u4e2a\u7248\u672c\u5c31\u662f$exp(ln(A)\\times k)$\u7684\u5e38\u6570\u9879\uff0c\u4e5f\u5c31\u662f$B$\u7684\u5e38\u6570\u9879\uff0c\u90a3\u4e48\u5e38\u6570\u9879\u662f\u591a\u5c11\u5462\uff1f\n\n# $\\ \\ \\ \\ \\ \\ \\ $\u5f53\u7136\u662f$A_0^k$\u554a\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u5230\u6b64\uff0c\u611f\u89c9\u6709\u7406\u6709\u636e\u7684\uff0c\u53ef\u662f\u5b9e\u9645\u64cd\u4f5c\u5199\u4e0b\u6765\uff0c\u600e\u4e48\u53ea\u6709$90$\u5206\u5462\uff1f\n\n$\\ \\ \\ \\ \\ \\ \\ $\u5f53$a[0]=0$\u65f6\uff0c\u7b2c\u4e00\u4e2a\u7248\u672c\u5e94\u8be5\u662f$B_0=0$\uff0c\u53ef\u662f\u2026\u2026\u7248\u672c\u771f\u7684\u53ef\u4ee5\u4e3a$0$\u5417\uff1f\n\n$\\ \\ \\ \\ \\ \\ \\ $\u6211\u4eec\u662f\u8981\u6c42 $F'(B)=\\frac{1}{B}$ \u7684\uff0c\u5206\u6bcd\u5f53\u7136\u4e0d\u80fd\u4e3a $0$ \u4e86\uff0c\u6240\u4ee5\u8bf4\u6211\u4eec\u8fd8\u662f\u8981\u5355\u72ec\u5904\u7406 $a[0]=0$ \u7684\u60c5\u51b5\u7684\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u628a\u4e3a$0$\u7684\u524d\u7f00\u63d0\u51fa\u6765\uff0c\u7136\u540e\u7b97\uff0c\u6700\u540e\u5728\u7b54\u6848\u524d\u9762\u52a0\u4e0a\u63d0\u51fa\u7684\u957f\u5ea6\u4e58\u4e0a$k$\u4e2a$0$\u5373\u53ef\uff0c\u5177\u4f53\u53ef\u4ee5\u770b\u4e11\u964b\u7684\u4ee3\u7801\uff1a\n\n$\\ \\ \\ \\ \\ \\ \\ $\u56e0\u4e3a\u662f\u76f4\u63a5\u8d34\u7684\u8fa3\u9e21\u677f\u5b50\uff0c\u6240\u4ee5\u8bf4\u8dd1\u5f97\u5f88\u6162\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstdlib>\n#include<cstring>\n#include<string>\n#include<queue>\n#include<map>\n#include<set>\n#include<stack>\n#include<cmath>\n#include<cctype>\nusing namespace std;\nconst int inf=0x7fffffff;\nconst double eps=1e-10;\nconst double pi=acos(-1.0);\n//char buf[1<<15],*S=buf,*T=buf;\n//char getch(){return S==T&&(T=(S=buf)+fread(buf,1,1<<15,stdin),S==T)?0:*S++;}\ninline int read(){\n  int x=0,f=1;char ch;ch=getchar();\n  while(ch<'0'||ch>'9'){if(ch=='-') f=0;ch=getchar();}\n  while(ch>='0'&&ch<='9'){x=(x<<1)+(x<<3)+(ch&15);ch=getchar();}\n  if(f)return x;else return -x;\n}\nconst int N=3e6+10;\nconst int mod=998244353,mod_g=3;\nint K;\nint R[N];\nint power(int a,int b){\n  int ans=1;\n  for(;b;b>>=1,a=1ll*a*a%mod)if(b&1)ans=1ll*ans*a%mod;\n  return ans;\n}\n#define Inv(x) power(x,mod-2)\nint Polynomial_init(int n){\n  int len;for(len=1;len<n;len<<=1);\n  return len;\n}\nvoid NTT(int *a,int f,int la){\n  int n=la;\n  for(int i=0;i<n;i++)if(i<R[i])swap(a[i],a[R[i]]);\n  for(int i=1;i<n;i<<=1){\n    int gn=power(mod_g,(mod-1)/(i<<1));\n    for(int j=0;j<n;j+=(i<<1)){\n      int g=1;\n      for(int k=0;k<i;k++,g=1ll*g*gn%mod){\n        int x=a[j+k],y=1ll*g*a[i+j+k]%mod;\n        a[j+k]=(x+y)%mod;a[i+j+k]=(x-y+mod)%mod;\n      }\n    } \n  }\n  if(f==-1){\n    reverse(a+1,a+n);\n    int inv=Inv(n);\n    for(int i=0;i<n;i++)a[i]=1ll*a[i]*inv%mod;\n  }\n}\nint Convolution(int *a,int *b,int la,int lb){\n  int n=la,m=lb;\n  int L=0;for(m+=n,n=1;n<=m;n<<=1)L++;\n  for(int i=0;i<n;i++)R[i]=(R[i>>1]>>1)|((i&1)<<(L-1));\n  NTT(a,1,n);NTT(b,1,n);\n  for(int i=0;i<=n;i++)a[i]=1ll*a[i]*b[i]%mod;\n  NTT(a,-1,n);\n  return m;\n}\nint I[N],J[N];\nint Multiplication(int *a,int *b,int *c,int la,int lb){\n  int n=la,m=lb;\n  int L=0;for(m+=n,n=1;n<=m;n<<=1)L++;\n  for(int i=0;i<n;i++)R[i]=(R[i>>1]>>1)|((i&1)<<(L-1));\n  for(int i=0;i<=la;++i) I[i]=a[i];\n  for(int i=0;i<=lb;++i) J[i]=b[i];\n  NTT(I,1,n);NTT(J,1,n);\n  for(int i=0;i<=n;i++)c[i]=1ll*I[i]*J[i]%mod,I[i]=J[i]=0;\n  NTT(c,-1,n);\n}\nint C[N];\nvoid Inverse(int *a,int *b,int len){\n  if(len==1){b[0]=Inv(a[0]);return;}\n  Inverse(a,b,(len+1)>>1);\n  int L=0,n=1;\n  for(;n<(len<<1);n<<=1)L++;\n  for(int i=1;i<n;i++)R[i]=(R[i>>1]>>1)|((i&1)<<(L-1));\n  for(int i=0;i<len;i++)C[i]=a[i];\n  for(int i=len;i<n;i++)C[i]=0;\n  NTT(C,1,n);NTT(b,1,n);\n  for(int i=0;i<=n;i++)b[i]=1ll*(2ll-1ll*C[i]*b[i]%mod+mod)%mod*b[i]%mod;\n  NTT(b,-1,n);\n  for(int i=len;i<n;i++)b[i]=0;\n}\nint H[N];\nvoid Division(int *a,int *b,int la,int lb,int *Quotient,int *Remainder){\n  int n=la,m=lb;\n  reverse(a,a+1+n),reverse(b,b+1+m);\n  int len=1;while(len<=n-m)len<<=1;\n  memset(C,0,sizeof(C));\n  Inverse(b,H,len);\n  Multiplication(a,H,Quotient,n-m,n-m);\n  reverse(Quotient,Quotient+n-m+1);\n  reverse(a,a+n+1),reverse(b,b+m+1);\n  Multiplication(Quotient,b,Remainder,n-m,m);\n  for(int i=0;i<m;++i)Remainder[i]=(a[i]-Remainder[i]+mod)%mod;\n}\nvoid Derivation(int *a,int *b,int n){\n  for(int i=1;i<n;i++)\n  b[i-1]=1ll*i*a[i]%mod;\n  b[n-1]=0;\n}\nvoid Integral(int *a,int *b,int n){\n  for(int i=1;i<n;i++)\n  b[i]=1ll*Inv(i)*a[i-1]%mod;\n  b[0]=0;\n}\nint ln_a[N],ln_b[N];\nvoid Logarithmic(int *a,int *b,int n){\n  memset(ln_a,0,sizeof(ln_a));\n  memset(ln_b,0,sizeof(ln_b));\n  Derivation(a,ln_a,n);\n  memset(C,0,sizeof(C));\n  Inverse(a,ln_b,n);\n  Convolution(ln_a,ln_b,n,n);\n  Integral(ln_a,b,n);\n}\nint D[N];\nvoid Exponential(int *a,int *b,int len){\n  if(len==1){return;}\n  Exponential(a,b,len>>1),Logarithmic(b,D,len);\n  D[0]=(1ll*a[0]+1ll-D[0]+mod)%mod;\n  for(int i=1;i<len;++i) D[i]=(1ll*a[i]-D[i]+mod)%mod;\n  Convolution(b,D,len<<1,len<<1);\n  for(int i=len;i<(len<<1);++i) b[i]=D[i]=0;\n}\nint p_a[N];\nvoid Power(int *a,int *b,int len){\n  Logarithmic(a,p_a,len);\n  for(int i=1;i<=len;i++)p_a[i]=1ll*p_a[i]*K%mod;\n  b[0]=power(a[0],K%(mod-1));\n  Exponential(p_a,b,len);\n}\nint n,F[N],G[N],low;\nint main()\n{\n  n=read();K=read();\n  for(int i=0;i<n;i++)F[i]=read();\n  for(int i=0;i<=n;++i){if(!F[i])continue;low=i;break;}\n  if(low)for(int i=low;i<n;++i)F[i-low]=F[i],F[i]=0;\n  Power(F,G,Polynomial_init(n));\n  if(low){\n    if(1ll*low*K>n)low=n;\n    else low*=K;\n    for(int i=n-1;i>=0;--i){\n      if(i+low<n)G[i+low]=G[i];\n      G[i]=0;\n    }\n  }\t\n  for(int i=0;i<n;i++)printf(\"%d \",G[i]);\n  return 0;\n}\n\n```\n",
        "postTime": 1553693251,
        "uid": 62758,
        "name": "\u5468\u9053_Althen",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5273 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5e42\u51fd\u6570 (\u52a0\u5f3a\u7248)\u3011"
    },
    {
        "content": "### \u9898\u610f\n\u7ed9\u5b9a$n-1$\u6b21\u591a\u9879\u5f0f$F(x)$\u548c\u6574\u6570$k$\uff0c\u6c42$\\bmod\\ x^n$\u610f\u4e49\u4e0b\u7684$(F(x))^k$\uff0c**\u4e0d\u4fdd\u8bc1$F_0=1$**\u3002\n\n$\\texttt{Data Range:}n\\leq 10^5,0\\leq k,F_i\\leq 998244352$\n### \u9898\u89e3\n\u9996\u5148\uff0c\u611f\u8c22[memset0](https://www.luogu.org/space/show?uid=53495) \uff0c[SSerxhs](https://www.luogu.org/space/show?uid=29826)\uff0c[BackOnTrack](https://www.luogu.org/space/show?uid=2524)\uff0c[Weng_Weijie](https://www.luogu.org/space/show?uid=26127)\u7b49\u805a\u805a\u7684\u5e2e\u52a9\uff01\uff01\uff01\n\n\u7136\u540e\u624d\u662f\u6b63\u9898\u3002\n\n\u9996\u5148\u8003\u8651\u7528[P5245](https://www.luogu.org/problemnew/show/P5245)\u7684\u6b63\u89e3\u6765\u8dd1\u4e00\u904d\uff0c\u53d1\u73b0\u5f53$F_0\\neq 1$\u65f6\u6574\u4e2a\u5f0f\u5b50\u7684\u6bcf\u4e00\u9879\u90fd\u5c11\u4e58\u4e86\u4e00\u4e2a$F_0^k$\uff0c\u4e8e\u662f\u53ef\u4ee5\u8003\u8651\u628a\u5b83\u4e58\u8fc7\u6765\u3002\n\n\u4f46\u662f\uff0c\u5c31\u5728\u4f60\u5174\u51b2\u51b2\u5730\u53bb\u63d0\u4ea4\u7684\u65f6\u5019\uff0c\u4f60\u5c31\u4f1a\u53d1\u73b0\u4f60$\\color{#e74c3c}\\texttt{WA \\#9}$\uff0c\u90a3\u662f\u56e0\u4e3a**\u9898\u76ee\u5e76\u4e0d\u4fdd\u8bc1$F_0\\neq 0$**\u3002\u5982\u679c$F_0$\u7b49\u4e8e$0$\uff0c\u90a3\u4e48\u6309\u7167\u8ba8\u8bba\u533a\u5927\u4f6c\u7684\u601d\u8def\uff0c\u5148\u5de6\u79fb\u5728\u53f3\u79fb\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u4f46\u662f\uff0c\u5982\u679c\u4f60\u8fd8\u662f\u4e0d\u80fd$\\color{#5eb95e}\\texttt{AC}$\uff0c\u800c\u4e14\u8fd8$\\color{#8e44ad}\\texttt{RE \\#8}$\u7684\u8bdd\uff0c\u90a3\u4e48\u5c31\u5e94\u8be5\u662f\u7206$\\texttt{int}$\u4e86\uff0c\u8fd9\u65f6\u5019\u5c31\u5e94\u8be5\u628a\u8bb0\u5f55\u7684$F$\u524d\u9762\u4f60$0$\u7684\u4e2a\u6570\u548c$k$\u7528$\\texttt{long long}$\u4e58\u8d77\u6765\uff0c\u5c31\u53ef\u4ee5$\\color{#5eb95e}\\texttt{AC}$\u5566qwq\u3002\n\n\u5bf9\u4e86\uff0c\u8fd9\u91cc\u8fd8\u9644\u8d60\u4e00\u7ec4\u5bf9\u62cd\u6570\u636e\uff0c\u7ed9\u50cf\u6211\u4e00\u6837$\\color{#8e44ad}\\texttt{RE \\#8}$\u7684\u5c0f\u4f19\u4f34\u4eec\u7684\uff1a\n\n```\nInput:\n\n5 998244352\n0 0 0 1 1\nOutput:\n\n0 0 0 0 0\n```\n### \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef int ll;\ntypedef long long int li;\nconst ll MAXN=4e5+51,MOD=998244353,G=3,INVG=332748118;\nll fd,exponent,k,num,x,flag;\nli zero;\nll f[MAXN],res[MAXN],g[MAXN],rev[MAXN];\ninline ll read()\n{\n    register ll num=0,neg=1;\n    register char ch=getchar();\n    while(!isdigit(ch)&&ch!='-')\n    {\n        ch=getchar();\n    }\n    if(ch=='-')\n    {\n        neg=-1;\n        ch=getchar();\n    }\n    while(isdigit(ch))\n    {\n        num=(num<<3)+(num<<1)+(ch-'0');\n        ch=getchar();\n    }\n    return num*neg;\n}                                 \ninline ll qpow(ll base,ll exponent)\n{\n    li res=1;\n    while(exponent)\n    {\n        if(exponent&1)\n        {\n            res=(li)res*base%MOD;\n        }\n        base=(li)base*base%MOD,exponent>>=1;\n    }\n    return res;\n}\ninline void NTT(ll *cp,ll cnt,ll inv)\n{\n    ll cur=0,res=0,omg=0;\n    for(register int i=0;i<cnt;i++)\n    {\n        if(i<rev[i])\n        {\n            swap(cp[i],cp[rev[i]]);\n        }\n    }\n    for(register int i=2;i<=cnt;i<<=1)\n    {\n        cur=i>>1,res=qpow(inv==1?G:INVG,(MOD-1)/i);\n        for(register ll *p=cp;p!=cp+cnt;p+=i)\n        {\n            omg=1;\n            for(register int j=0;j<cur;j++)\n            {\n                ll t=(li)omg*p[j+cur]%MOD,t2=p[j];\n                p[j+cur]=(t2-t+MOD)%MOD,p[j]=(t2+t)%MOD;\n                omg=(li)omg*res%MOD;\n            }\n        }\n    }\n    if(inv==-1)\n    {\n        ll invl=qpow(cnt,MOD-2);\n        for(register int i=0;i<=cnt;i++)\n        {\n            cp[i]=(li)cp[i]*invl%MOD;\n        }\n    }\n}\ninline void inv(ll fd,ll *f,ll *res)\n{\n    static ll tmp[MAXN];\n    if(fd==1)\n    {\n        res[0]=qpow(f[0],MOD-2);\n        return;\n    }\n    inv((fd+1)>>1,f,res);\n    ll cnt=1,limit=-1;\n    while(cnt<(fd<<1))\n    {\n        cnt<<=1,limit++;\n    }\n    for(register int i=0;i<cnt;i++)\n    {\n        tmp[i]=i<fd?f[i]:0;\n        rev[i]=(rev[i>>1]>>1)|((i&1)<<limit);\n    }\n    NTT(tmp,cnt,1),NTT(res,cnt,1);\n    for(register int i=0;i<cnt;i++)\n    {\n        res[i]=(li)(2-(li)tmp[i]*res[i]%MOD+MOD)%MOD*res[i]%MOD;\n    }\n    NTT(res,cnt,-1);\n    for(register int i=fd;i<cnt;i++)\n    {\n        res[i]=0;\n    }\n}\ninline void ln(ll fd,ll *f,ll *res)\n{\n    static ll pinv[MAXN],der[MAXN];\n    ll cnt=1,limit=-1;\n    while(cnt<(fd<<1))\n    {\n        cnt<<=1,limit++;\n    }\n    inv(fd,f,pinv);\n    for(register int i=1;i<fd;i++)\n    {\n        der[i-1]=(li)f[i]*i%MOD;\n    }\n    der[fd-1]=0;\n    for(register int i=0;i<cnt;i++)\n    {\n        rev[i]=(rev[i>>1]>>1)|((i&1)<<limit);\n    }\n    NTT(pinv,cnt,1),NTT(der,cnt,1);\n    for(register int i=0;i<cnt;i++)\n    {\n        der[i]=(li)der[i]*pinv[i]%MOD;\n    }\n    NTT(der,cnt,-1);\n    for(register int i=1;i<fd;i++)\n    {\n        res[i]=(li)der[i-1]*qpow(i,MOD-2)%MOD;\n    }\n    res[0]=0;\n    for(register int i=0;i<cnt;i++)\n    {\n        der[i]=pinv[i]=0;\n    }\n}\ninline void exp(ll fd,ll *f,ll *res)\n{\n    static ll texp[MAXN];\n    if(fd==1)\n    {\n        res[0]=1;\n        return;\n    }\n    ll cnt=1,limit=-1;\n    while(cnt<(fd<<1))\n    {\n        cnt<<=1,limit++;\n    }\n    exp((fd+1)>>1,f,res),ln(fd,res,texp);\n    for(register int i=0;i<cnt;i++)\n    {\n \t\trev[i]=(rev[i>>1]>>1)|((i&1)<<limit);\n    }\n    texp[0]=(f[0]+1-texp[0]+MOD)%MOD;\n    for(register int i=1;i<fd;i++)\n    {\n        texp[i]=(f[i]-texp[i]+MOD)%MOD;\n    }\n    NTT(texp,cnt,1),NTT(res,cnt,1);\n    for(register int i=0;i<cnt;i++)\n    {\n        res[i]=(li)res[i]*texp[i]%MOD;\n    }\n    NTT(res,cnt,-1);\n    for(register int i=0;i<cnt;i++)\n    {\n        texp[i]=0,res[i]=i<fd?res[i]:0;\n    }\n}\nint main()\n{\n    fd=read(),exponent=read();\n    for(register int i=0;i<fd;i++)\n    {\n        x=read();\n        !(x||flag)?zero++:flag=1,f[i-zero]=x;\n    }\n    if(!flag)\n    {\n        for(register int i=0;i<fd;i++)\n        {\n            putchar('0'),putchar(' ');\n        }\n        return 0;\n    }\n    k=f[0],ln(fd-zero,f,g);\n    for(register int i=0;i<fd-zero;i++)\n    {\n        g[i]=(li)g[i]*exponent%MOD;\n    }\n    exp(fd-zero,g,res),zero=(li)zero*exponent;\n    for(register li i=0;i<min(zero,1ll*fd);i++)\n    {\n        putchar('0'),putchar(' ');\n    }\n    for(register li i=zero;i<fd;i++)\n    {\n        printf(\"%d \",(li)res[i-zero]*qpow(k,exponent)%MOD);\n    }\n}\n```",
        "postTime": 1553663282,
        "uid": 60990,
        "name": "Karry5307",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5273 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5e42\u51fd\u6570 (\u52a0\u5f3a\u7248)\u3011"
    },
    {
        "content": "## \u9898\u610f\n\n\u7ed9\u5b9a\u591a\u9879\u5f0f$A(x)$\uff0c\u6c42\u4e00\u4e2a\u591a\u9879\u5f0f$B(x)$\uff0c\u6ee1\u8db3\n\n$$B(x)\\equiv A^m(x)(\\mathrm{mod\\:}x^n)$$\n\n## \u9898\u89e3\n\n### \u65b9\u6cd5\u4e00\uff1a\u76f4\u63a5\u5feb\u901f\u5e42\n\n\u65e2\u7136\u6570\u53ef\u4ee5\u8fdb\u884c\u5feb\u901f\u5e42\uff0c\u90a3\u4e48\u591a\u9879\u5f0f\u4e3a\u4ec0\u4e48\u5c31\u4e0d\u884c\u5462\u3002\n\n\u6bcf\u6b21\u8ba1\u7b97$A^2(x)$\uff0c\u7136\u540e\u5c06\u6b21\u6570\u5927\u4e8e$n$\u7684\u9879\u5168\u90e8\u53d8\u6210$0$\uff0c\u8fdb\u884c\u500d\u589e\u3002\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\log^2 n)$\uff08\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u5148\u8f6c\u70b9\u503c\u8868\u793a\u6700\u540e\u518d\u8f6c\u56de\u6765\uff1f\u4e2d\u95f4\u8981\u5bf9$x^n$\u53d6\u6a21\u554a\uff09\n\n\u4ee3\u7801\u4e5f\u5c31\u6bd4\u8f83\u65e0\u8111\u4e86\uff1a\n\n```\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n#define ll long long\nusing namespace std;\nconst ll MOD=998244353;\nint limit,l,r[400005];\nll quick_pow(ll x,ll a)\n{\n\tll ans=1;\n\twhile(a)\n\t{\n\t\tif(a&1)ans=ans*x%MOD;\n\t\tx=x*x%MOD;\n\t\ta>>=1;\n\t}\n\treturn ans;\n}\nvoid NTT(ll*A,int type)//nlogn\n{\n\tfor(int i=0;i<limit;i++)\n\t  if(i<r[i])swap(A[i],A[r[i]]);\n\tfor(int mid=1;mid<limit;mid<<=1)\n\t{\n\t\tll Wn=type==1?quick_pow(3,(MOD-1)/(mid<<1)):quick_pow(3,MOD-1-(MOD-1)/(mid<<1));\n\t\tfor(int R=mid<<1,j=0;j<limit;j+=R)\n\t\t{\n\t\t\tll w=1;\n\t\t\tfor(int k=0;k<mid;k++,w=w*Wn%MOD)\n\t\t\t{\n\t\t\t\tll x=A[j+k],y=w*A[j+mid+k]%MOD;\n\t\t\t\tA[j+k]=(x+y)%MOD;\n\t\t\t\tA[j+mid+k]=(x-y+MOD)%MOD;\n\t\t\t}\n\t\t}\n\t}\n\tif(type==-1)\n\t{\n\t\tll inv=quick_pow(limit,MOD-2);\n\t\tfor(int i=0;i<limit;i++)A[i]=A[i]*inv%MOD;\n\t}\n}\nint n,m;\nvoid quick_pow(ll*a,int k,ll*b)\n{\n\tb[0]=1;\n\tlimit=1,l=0;\n\twhile(limit<(n<<1))limit<<=1,l++;\n\tfor(int i=0;i<limit;i++)\n\t  r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\twhile(k)\n\t{\n\t\tNTT(a,1);\n\t\tif(k&1)\n\t\t{\n\t\t\tNTT(b,1);\n\t\t\tfor(int i=0;i<limit;i++)b[i]=a[i]*b[i]%MOD;\n\t\t\tNTT(b,-1);\n\t\t\tfor(int i=n;i<limit;i++)b[i]=0;\n\t\t}\n\t\tfor(int i=0;i<limit;i++)a[i]=a[i]*a[i]%MOD;\n\t\tNTT(a,-1);\n\t\tfor(int i=n;i<limit;i++)a[i]=0;\n\t\tk>>=1;\n\t}\n}\nll a[400005],b[400005],c[400005];\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=0;i<n;i++)scanf(\"%lld\",&a[i]);\n\tquick_pow(a,m,b);\n\tfor(int i=0;i<n;i++)printf(\"%lld \",b[i]);\n\tprintf(\"\\n\");\n\treturn 0;\n}\n```\n\n### \u65b9\u6cd52\uff1a\u591a\u9879\u5f0fln+\u591a\u9879\u5f0fexp\n\n\u9884\u77e5\u8bc6\uff1a\u591a\u9879\u5f0fln\uff0c\u591a\u9879\u5f0fexp\uff0c\u5982\u679c\u4e0d\u4f1a\u7684\u8bf7\u5de6\u8f6c[\u8fd9\u91cc](https://www.luogu.org/problemnew/show/P4725)\u548c[\u8fd9\u91cc](https://www.luogu.org/problemnew/show/P4726)\u3002\n\n\u73b0\u5728\u6211\u4eec\u6765\u5c1d\u8bd5\u63a8\u4e00\u6ce2\u5f0f\u5b50\u3002\n\n\u4f1a\u4e86\u591a\u9879\u5f0fln\u4e3a\u4ec0\u4e48\u4e0d\u7528\u5462\uff0c\u4e24\u8fb9\u540c\u65f6\u6c42\u5bf9\u6570\uff1a\n\n$$\\ln B(x)\\equiv m\\ln A(x)(\\mathrm{mod\\:}x^n)$$\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u5bf9$A$\u6c42\u4e00\u904d\u591a\u9879\u5f0fln\uff0c\u7136\u540e\u6240\u6709\u7684\u7cfb\u6570\u4e58$m$\uff0c\u6700\u540e\u6c42\u4e00\u904d\u591a\u9879\u5f0fexp\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230$B$\u3002\n\n\u5176\u5b9e\u5c31\u662f[\u8fd9\u9053\u9898](https://www.luogu.org/problemnew/show/P5245)\u5566\u3002\n\n\u4f46\u662f\u6211\u4eec\u53d1\u73b0\uff0c\u591a\u9879\u5f0fln\u8981\u6c42$A_0=1$\uff0c\u4f46\u662f\u8fd9\u91cc\u7684$A$\u4e0d\u4e00\u5b9a\u6ee1\u8db3\u6761\u4ef6\uff08\u5e9f\u8bdd\uff0c\u8981\u4e0d\u7136\u600e\u4e48\u53eb\u52a0\u5f3a\u7248\u5462\uff09\u3002\n\n\u6709\u4e00\u53e5\u53e4\u8bdd\uff1a\u6709\u6761\u4ef6\u8981\u4e0a\uff0c\u6ca1\u6709\u6761\u4ef6\u521b\u9020\u6761\u4ef6\u4e5f\u8981\u4e0a\u3002\n\n\u5f53$A_0\\neq 0$\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u4ee5\u5f3a\u884c\u5c06$A_0$\u53d8\u6210$1$\uff1a\n\n$$A^k(x)=\\left(\\dfrac{A(x)}{A_0}\\right)^k\\cdot A_0^k$$\n\n\u5f53$A_0=0$\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u591a\u9879\u5f0f\u6574\u4f53\u79fb\u4f4d\u4e00\u4e0b\u3002\u4ee4$k$\u662f\u8fd9\u4e2a\u591a\u9879\u5f0f\u7b2c\u4e00\u4e2a\u4e0d\u4e3a$0$\u7684\u9879\uff0c\u90a3\u4e48\u4ee4$A_{i}=A_{k+i}$\uff0c\u6700\u540e\u518d\u79fb\u56de\u6765\u5c31\u884c\u4e86\u3002\n\n\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f$O(n\\log n)$\uff0c\u4f46\u662f\u5e38\u6570\u5de8\u5927\u3002\n\n\u65b9\u6cd5\u4e8c\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n#define ll long long\nusing namespace std;\nconst ll MOD=998244353;\nint limit,l,r[400005];\nll ni[400005];\nvoid calc_ni(int n)\n{\n\tni[1]=1;\n\tfor(int i=2;i<=n;i++)\n\t  ni[i]=MOD-(MOD/i)*ni[MOD%i]%MOD;\n}\nll quick_pow(ll x,ll a)\n{\n\tll ans=1;\n\twhile(a)\n\t{\n\t\tif(a&1)ans=ans*x%MOD;\n\t\tx=x*x%MOD;\n\t\ta>>=1;\n\t}\n\treturn ans;\n}\nvoid NTT(ll*A,int type)//nlogn\n{\n\tfor(int i=0;i<limit;i++)\n\t  if(i<r[i])swap(A[i],A[r[i]]);\n\tfor(int mid=1;mid<limit;mid<<=1)\n\t{\n\t\tll Wn=type==1?quick_pow(3,(MOD-1)/(mid<<1)):quick_pow(3,MOD-1-(MOD-1)/(mid<<1));\n\t\tfor(int R=mid<<1,j=0;j<limit;j+=R)\n\t\t{\n\t\t\tll w=1;\n\t\t\tfor(int k=0;k<mid;k++,w=w*Wn%MOD)\n\t\t\t{\n\t\t\t\tll x=A[j+k],y=w*A[j+mid+k]%MOD;\n\t\t\t\tA[j+k]=(x+y)%MOD;\n\t\t\t\tA[j+mid+k]=(x-y+MOD)%MOD;\n\t\t\t}\n\t\t}\n\t}\n\tif(type==-1)\n\t{\n\t\tll inv=quick_pow(limit,MOD-2);\n\t\tfor(int i=0;i<limit;i++)A[i]=A[i]*inv%MOD;\n\t}\n}\nll A[400005];\nvoid Inv(ll*a,ll*b,int n)//6nlogn\n{\n\tif(n==1)\n\t{\n\t\tb[0]=quick_pow(a[0],MOD-2);\n\t\treturn;\n\t}\n\tInv(a,b,(n+1)>>1);\n\tlimit=1,l=0;\n\twhile(limit<(n<<1))limit<<=1,l++;\n\tfor(int i=0;i<limit;i++)\n\t  r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\tfor(int i=0;i<limit;i++)A[i]=i<n?a[i]:0;\n\tfor(int i=(n+1)>>1;i<limit;i++)b[i]=0;\n\tNTT(A,1);\n\tNTT(b,1);\n\tfor(int i=0;i<limit;i++)\n\t  b[i]=b[i]*(2+MOD-A[i]*b[i]%MOD)%MOD;\n\tNTT(b,-1);\n\tfor(int i=n;i<limit;i++)b[i]=0;\n}\nll a2[400005];\nvoid Ln(ll*a,ll*b,int n)//9nlogn\n{\n\tInv(a,b,n);\n\tlimit=1,l=0;\n\twhile(limit<(n<<1))limit<<=1,l++;\n\tfor(int i=0;i<limit;i++)\n\t  r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\tfor(int i=0;i<n-1;i++)a2[i]=a[i+1]*(i+1)%MOD;\n\tfor(int i=n-1;i<limit;i++)a2[i]=0;\n\tNTT(a2,1);\n\tNTT(b,1);\n\tfor(int i=0;i<limit;i++)\n\t  b[i]=b[i]*a2[i]%MOD;\n\tNTT(b,-1);\n\tfor(int i=n-1;i>0;i--)\n\t  b[i]=b[i-1]*ni[i]%MOD;\n\tfor(int i=n;i<limit;i++)b[i]=0;\n\tb[0]=0;\n}\nll lnb[400005];\nvoid Exp(ll*a,ll*b,int n)//24nlogn\n{\n\tif(n==1)\n\t{\n\t\tb[0]=1;\n\t\treturn;\n\t}\n\tExp(a,b,(n+1)>>1);\n\tLn(b,lnb,n);\n\tlimit=1,l=0;\n\twhile(limit<(n<<1))limit<<=1,l++;\n\tfor(int i=0;i<limit;i++)\n\t  r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\tfor(int i=0;i<n;i++)lnb[i]=a[i]>=lnb[i]?a[i]-lnb[i]:a[i]-lnb[i]+MOD;\n\tfor(int i=n;i<limit;i++)lnb[i]=b[i]=0;\n\tlnb[0]++;\n\tNTT(lnb,1);\n\tNTT(b,1);\n\tfor(int i=0;i<limit;i++)b[i]=b[i]*lnb[i]%MOD;\n\tNTT(b,-1);\n\tfor(int i=n;i<limit;i++)b[i]=0;\n}\nint n,m;\nll num,a0,a[400005],b[400005],c[400005];\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=0;i<n;i++)scanf(\"%lld\",&a[i]);\n\tcalc_ni(n);\n\twhile(a[num]==0)num++;\n\tint x=n;\n\tn-=num;\n\tfor(int i=0;i<n;i++)a[i]=a[i+num];\n\ta0=a[0];\n\tll inv=quick_pow(a0,MOD-2);\n\tfor(int i=0;i<n;i++)a[i]=a[i]*inv%MOD;\n\tLn(a,b,n);\n\tfor(int i=0;i<n;i++)b[i]=b[i]*m%MOD;\n\tExp(b,a,n);\n\ta0=quick_pow(a0,m);\n\tfor(int i=0;i<n;i++)a[i]=a[i]*a0%MOD;\n\tn=x;\n\tnum=min(1ll*num*m,1ll*n);\n\tfor(int i=n-1;i>=num;i--)\n\t  a[i]=a[i-num];\n\tfor(int i=num-1;i>=0;i--)a[i]=0;\n\tfor(int i=0;i<n;i++)printf(\"%lld \",a[i]);\n\tprintf(\"\\n\");\n\treturn 0;\n}\n```\n\n## \u4e24\u79cd\u65b9\u6cd5\u7684\u6548\u7387\u5206\u6790\n\n\u5f53\u7136\u662f$O(n\\log n)$\u540a\u6253$O(n\\log^2 n)$\u5566\u3002\n\n$O(n\\log n)$\u505a\u6cd5\u5438\u6c274793ms\uff0c\u4e0d\u5438\u6c27\u6162\u4e00\u500d9573ms\u3002\n\n![](https://cdn.luogu.com.cn/upload/pic/55075.png)\n\n$O(n\\log^2 n)$\u505a\u6cd5\u561b\u2026\u2026\n\n![](https://cdn.luogu.com.cn/upload/pic/55071.png)\n\n\u6211\u7684$O(n\\log^2 n)$\u505a\u6cd5\u65e0\u8bba\u5438\u6c27\u8fd8\u662f\u4e0d\u5438\u6c27\u90fd\u662f20\u5206\uff0c\u4f46\u662f\u4f60\u8c37\u8fd8\u662f\u6709\u5361\u5e38\u795e\u4ed9@mrsrz 8000ms$O(n\\log^2 n)$\uff0corzorzorz\u2026\u2026\n\n![](https://cdn.luogu.com.cn/upload/pic/55079.png)",
        "postTime": 1553599550,
        "uid": 54214,
        "name": "wucstdio",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5273 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5e42\u51fd\u6570 (\u52a0\u5f3a\u7248)\u3011"
    },
    {
        "content": "## [\u9898\u610f](https://www.luogu.com.cn/problem/P5273)\n\n\u4f3c\u4e4e\u66f4\u65b0\u6570\u636e\u540e\u73b0\u5728\u7684\u9898\u89e3\u5f88\u591a\u90fd\u8fc7\u4e0d\u4e86\uff0c\u6211\u6765\u5199\u4e00\u4efd\u4e86\uff0c\u672c\u4eba\u5f88\u849f\uff0c\u51fa\u9519\u8bf7\u6307\u51fa\u3002\n\n\u65e2\u7136\u6765\u505a\u52a0\u5f3a\u7248\u4e86\uff0c\u8bf4\u660e\u666e\u901a\u7684\u5df2\u7ecf\u8fc7\u4e86\uff0c\u5c31\u9ed8\u8ba4\u4f1a$ln+exp$\u7684\u505a\u6cd5\u4e86\u3002\n\n\u8003\u8651\u8fd9\u9898\u548c\u666e\u901a\u7684\u6709\u4ec0\u4e48\u533a\u522b\uff0c\u5373$a_0\\not =1$\uff0c\u8fd9\u4e2a$a_0=1$\u662f\u4fdd\u8bc1\u4f60$exp$\u65f6\u8fb9\u754c$b_0=1$\u7684\uff0c\u6211\u4eec\u8003\u8651\u505a\u4e00\u4e9b\u64cd\u4f5c\uff0c\u4f7f\u5f97$a_0=1$\u3002\n\n\u9996\u5148\u5c06\u524d\u9762\u4e00\u6bb5\u5168\u662f$0$\u7684\u63d0\u51fa\u6765\uff0c\u4f7f\u5f97$a_0\\not =0$\uff0c\u4e3e\u4e2a\u6817\u5b50\uff1a  \n$0x^0+0x^1+1x^2+2x^3->2x^0+2x^1$\u3002  \n\u5047\u8bbe\u6211\u4eec\u63d0\u51fa\u4e86$num$\u9879\uff0c\u90a3\u4e48\u6700\u540e\u7b54\u6848\u524d$num*m$\u9879\u90fd\u662f$0$\uff0c\u4e4b\u540e\u5c31\u548c\u65b0\u7684\u591a\u9879\u5f0f\u7b97\u51fa\u7684\u76f8\u540c\uff0c\u4e8e\u662f\u5c31\u4e0d\u7528\u7ba1\u8fd9\u6bb5$0$\u4e86\u3002\n\n\u4e4b\u540e\u5c31\u597d\u64cd\u4f5c\u4e86\uff0c\u5c06\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u6574\u4f53\u4e58\u4e2a$a_0$\u7684\u9006\u5143\uff0c\u8fd9\u6837\u5c31\u6ee1\u8db3$a_0=1$\uff0c\u7b97\u5b8c\u540e\u518d\u6574\u4f53\u4e58\u4e0a$a_0^m$\u5373\u53ef\u3002\n\n\u6ce8\u610f\u4e8b\u9879\uff1a  \n\u6211\u4eec\u8981\u5b58$3$\u4e2a$m$\uff1a  \n$m$\u662f\u6a21$mod=998244353$\u7684\uff0c\u548c\u666e\u901a\u7684\u7528\u5904\u76f8\u540c\u3002  \n$m1$\u662f\u6a21$mod-1$\u7684\uff0c\u7528\u4e8e\u6b27\u62c9\u5b9a\u7406\u7b97$a_0^m$\u3002  \n$m2$\u662f\u4e0d\u6a21\u7684\uff0c\u8fd9\u662f\u7528\u6765\u7b97\u6700\u7ec8\u7b54\u6848\u524d\u591a\u5c11\u9879\u4e3a$0$\u7684\u3002\u5f53\u7136\u8fd9\u662f\u5b58\u4e0d\u4e0b\u7684\uff0c\u6211\u4eec\u591a\u5b58\u51e0\u4f4d\uff0c\u5982\u679c$num*m2\\geqslant n$\u53ef\uff0c\u6211\u4eec\u5168\u8f93\u51fa$0$\u5373\u53ef\u3002\n\ncode:\n```\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int maxn=4e5+10;\nconst int mod=998244353;\nconst int G=3;\nconst int invG=332748118;\nint n,m,m1,m2;\nint inv[maxn],f[maxn],g[maxn],h[maxn],A[maxn],B[maxn],C[maxn],D[maxn],pos[maxn];\ninline int power(int x,int k)\n{\n    int res=1;\n    while(k)\n    {\n        if(k&1)res=1ll*res*x%mod;\n        x=1ll*x*x%mod;k>>=1;\n    }\n    return res;\n}\ninline void NTT(int* a,int op,int len)\n{\n    int lim=1,cnt=0;\n    while(lim<len)lim<<=1,cnt++;\n    for(int i=0;i<lim;i++)pos[i]=(pos[i>>1]>>1)|((i&1)<<(cnt-1));\n    for(int i=0;i<lim;i++)if(i<pos[i])swap(a[i],a[pos[i]]);\n    for(int l=1;l<lim;l<<=1)\n    {\n        int wn=power(op==1?G:invG,(mod-1)/(l<<1));\n        for(int i=0;i<lim;i+=l<<1)\n        {\n            int w=1;\n            for(int j=0;j<l;j++,w=1ll*w*wn%mod)\n            {\n                int x=a[i+j],y=1ll*w*a[i+l+j]%mod;\n                a[i+j]=(x+y)%mod;a[i+l+j]=(x-y+mod)%mod;\n            }\n        }\n    }\n    if(op==1)return;\n    int inv=power(lim,mod-2);\n    for(int i=0;i<lim;i++)a[i]=1ll*a[i]*inv%mod;\n}\ninline void getinv(int* a,int* b,int len)\n{\n    if(len==1){b[0]=power(a[0],mod-2);return;}\n    getinv(a,b,len>>1);\n    for(int i=0;i<len;i++)D[i]=a[i];\n    NTT(b,1,len<<1);NTT(D,1,len<<1);\n    for(int i=0;i<(len<<1);i++)b[i]=1ll*b[i]*(2ll-1ll*b[i]*D[i]%mod+mod)%mod;\n    NTT(b,-1,len<<1);\n    for(int i=0;i<len;i++)D[i]=0;\n    for(int i=len;i<(len<<1);i++)b[i]=D[i]=0;\n}\ninline void Direv(int* a,int* b,int len)\n{\n    for(int i=1;i<len;i++)b[i-1]=1ll*i*a[i]%mod;\n    b[len-1]=0;\n}\ninline void Inter(int* a,int* b,int len)\n{\n    for(int i=1;i<len;i++)b[i]=1ll*a[i-1]*inv[i]%mod;\n    b[0]=0;\n}\nvoid ln(int* a,int* b,int len)\n{\n    Direv(a,B,len);getinv(a,C,len);\n    NTT(B,1,len<<1);NTT(C,1,len<<1);\n    for(int i=0;i<(len<<1);i++)B[i]=1ll*B[i]*C[i]%mod;\n    NTT(B,-1,len<<1);Inter(B,b,len<<1);\n    for(int i=0;i<(len<<1);i++)B[i]=C[i]=0;\n}\nvoid exp(int* a,int* b,int len)\n{\n    if(len==1){b[0]=1;return;}\n    exp(a,b,len>>1);ln(b,A,len);\n    A[0]=(a[0]+1-A[0]+mod)%mod;\n    for(int i=1;i<len;i++)A[i]=(a[i]-A[i]+mod)%mod;\n    NTT(b,1,len<<1);NTT(A,1,len<<1);\n    for(int i=0;i<(len<<1);i++)b[i]=1ll*b[i]*A[i]%mod;\n    NTT(b,-1,len<<1);\n    for(int i=len;i<(len<<1);i++)b[i]=A[i]=0;\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n    char c=getchar();c=getchar();\n    while(c>='0'&&c<='9')\n\t{\n\t\tm=(1ll*m*10%mod+(c-'0'))%mod;\n\t\tm1=(1ll*m1*10%(mod-1)+(c-'0'))%(mod-1);\n\t\tif((ll)(m2*10+c-'0')<=mod)m2=m2*10+c-'0';\n\t\tc=getchar();\n\t}\n\tfor(int i=0;i<n;i++)scanf(\"%d\",&f[i]);\n\tint num=n;\n\tfor(int i=0;i<n;i++)if(f[i]){num=i;break;}\n\tif(1ll*num*m2>=1ll*n)\n\t{\n\t\tfor(int i=0;i<n;i++)printf(\"%d \",0);\n\t\treturn 0;\n\t}\n\tint tmpn=n;n-=num;\n\tfor(int i=0;i<n;i++)f[i]=f[i+num];\n\tint f0=f[0],invf0=power(f0,mod-2);\n\tfor(int i=0;i<n;i++)f[i]=1ll*f[i]*invf0%mod;\n\t\n\tint lim=1;\n\twhile(lim<n)lim<<=1;\n\tinv[1]=1;for(int i=2;i<lim;i++)inv[i]=1ll*(mod-mod/i)*inv[mod%i]%mod;\n\tln(f,g,lim);\n\tfor(int i=0;i<n;i++)g[i]=1ll*g[i]*m%mod;\n\tfor(int i=n;i<lim;i++)g[i]=0;\n\texp(g,h,lim);\n\t\n\tf0=power(f0,m1);\n\tfor(int i=0;i<n;i++)h[i]=1ll*h[i]*f0%mod;\n\t\n\tn=tmpn;num=min(1ll*num*m2,1ll*n);\n\tfor(int i=n-1;i>=num;i--)h[i]=h[i-num];\n\tfor(int i=num-1;~i;i--)h[i]=0;\n\t\n\tfor(int i=0;i<n;i++)printf(\"%d \",h[i]);\n\treturn 0;\n}\n```\n",
        "postTime": 1590503391,
        "uid": 145441,
        "name": "nofind",
        "ccfLevel": 6,
        "title": "P5273 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5e42\u51fd\u6570 (\u52a0\u5f3a\u7248)"
    },
    {
        "content": "\u672c\u6765\u4ee5\u4e3a\u8fd9\u9053\u9898\u662f\u4efb\u610f\u6a21\u6570\uff1f\u3010\u96fe \uff0c \u540e\u6765\u53d1\u73b0\u8fd9\u9053\u9898\u662f\u6ca1\u6709\u8bf4\u660e $f[0]=1$ ...\n\n# First\n\n\u5982\u679c\u4f60\u662f\u53d1\u73b0\u81ea\u5df1\u4ee3\u7801\u59cb\u7ec8\u8fc7\u4e0d\u6389\u51e0\u4e2a\u70b9\u4e8e\u662f\u6765\u70b9\u9898\u89e3\u7684\uff0c\u7ed9\u4f60\u7684\u4ee3\u7801\u51e0\u4e2a\u7b80\u5355\u4ee3\u7801\u7684 hack \u6570\u636e\uff1a\n\n```\n\ninput:\n2 3\n2 1\n\noutput:\n8 12\n\n\ninput:\n1 0\n0\n\noutput:\n1\n\ninput:\n1 1\n0\n\noutput:\n0\n\ninput:\n10 3\n0 1 5 8 7 4 9 5 7 8\n\noutput:\n0 0 0 1 15 99 386 1014 1968 3116\n\n\n```\n\n\u5982\u679c\u8fd9\u4e9b\u6570\u636e\u90fd\u80fd\u8fc7\u7684\u8bdd...\u5e94\u8be5\u5c31\u7a33\u4e86\u5427\uff1f\uff08\u53ea\u8981\u60a8\u522b\u628a\u6570\u7ec4\u5f00\u5c0f\u54af\u3010\u96fe\uff09\n\n\n# Next\n\n\u51b7\u9759\u5206\u6790...\n\n\u591a\u9879\u5f0f\u9996\u9879\u4e0d\u4e3a 1 ... \u8fd9 tm \u600e\u4e48\u641e Exp / Ln \u554a...\n\nemmm...\n\n\u5148\u8003\u8651\u9996\u9879\u4e0d\u4e3a 0 \u7684\u60c5\u51b5\uff1f\n\n\u6211\u4eec\u53d1\u73b0\u53ef\u4ee5\u8ba9\u6240\u6709\u7684\u7cfb\u6570\u90fd\u9664\u53bb\u9996\u9879\u7cfb\u6570\uff0c\u6700\u540e\u4e58\u56de\u9996\u9879\u7cfb\u6570\u7684 k \u6b21\uff0c\u8fd9\u6837\u5b50\u7684\u7ed3\u679c\u662f\u4e0d\u4f1a\u6709\u95ee\u9898\u7684...\n\n\u90a3\u5982\u679c\u9996\u9879\u662f 0 \u5462\uff1f\n\n\u54b1\u53ef\u4ee5\u628a\u591a\u9879\u5f0f\u5de6\u79fb\uff0c\u76f4\u5230\u9996\u9879\u4e0d\u4e3a 0 \u4e86\uff0c\u90a3\u4e48\u5c31\u53d8\u56de\u4e86\u9996\u9879\u4e0d\u4e3a 0 \u7684\u60c5\u51b5\u3002\u3002\u3002\n\n\u4f46\u662f\u522b\u5fd8\u4e86\u8981\u628a\u6700\u540e\u7684\u591a\u9879\u5f0f\u53f3\u79fb\u56de\u6765\uff0c\u5e76\u4e14\u53f3\u79fb\u7684\u4f4d\u6570\u8981\u4e58 k ...\n\n\n\u6700\u540e\u5c31\u662f\u5957\u4e2a\u677f\u5b50\u7684\u4e8b\u60c5...\n\n\n\u5f53\u7136\u8fd9\u9053\u9898\u8c8c\u4f3c\u53ef\u4ee5\u7528\u771f\u6b63\u610f\u4e49\u4e0a\u7684\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u89e3\u51b3\uff1f\uff08\u590d\u6742\u5ea6 $O(n\\log^2n)$\uff09\u3010\u624b\u52a8\u6ed1\u7a3d\n\n\u542c\u8bf4\u6709\u805a\u805a\u662f\u8fd9\u4e48 A \u6389\u7684\uff0c\u7136\u9e45\u54b1\u662f\u4eba\u5f62\u5927\u5e38\u6570\u81ea\u8d70\u673a...\n\n\n# Code\n\n```cpp\n//by Judge\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#define fp(i,a,b) for(int i=(a),I=(b)+1;i<I;++i)\n#define ll long long\nusing namespace std;\nconst int mod=998244353;\nconst int inv3=332748118;\nconst int M=4e5+3;\ntypedef int arr[M];\n#ifndef Judge\n#define getchar() (p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\n#endif\nchar buf[1<<21],*p1=buf,*p2=buf;\ninline int mul(int x,int y){return 1ll*x*y%mod;}\ninline int dec(int x,int y){return x-y<0?x-y+mod:x-y;}\ninline int inc(int x,int y){return x+y>=mod?x+y-mod:x+y;}\ninline int read(){ int x=0; char c=getchar(); for(;!isdigit(c);c=getchar());\n\tfor(;isdigit(c);c=getchar()) x=x*10+c-48; return x;\n} char sr[1<<21],z[20];int CC=-1,Z; inline void Ot(){fwrite(sr,1,CC+1,stdout),CC=-1;}\ninline void print(int x,char chr=' '){ if(CC>1<<20)Ot();if(x<0)sr[++CC]=45,x=-x;\n    while(z[++Z]=x%10+48,x/=10); while(sr[++CC]=z[Z],--Z);sr[++CC]=chr;\n} int n,k,limit,inv[M<<1]; arr A,B,C,D,F,G,f,g,h,r;\ninline int qpow(int x,int p=mod-2){ int s=1;\n\tfor(;p;p>>=1,x=mul(x,x)) if(p&1) s=mul(s,x); return s;\n}\ninline void NTT(int* a,int tp){\n\tfp(i,0,limit-1) if(i<r[i]) swap(a[i],a[r[i]]);\n\tfor(int mid=1;mid<limit;mid<<=1){\n\t\tint Gn=qpow(tp?3:inv3,(mod-1)/(mid<<1));\n\t\tfor(int j=0,x,y;j<limit;j+=mid<<1)\n\t\t\tfor(int k=0,g=1;k<mid;++k,g=mul(g,Gn))\n\t\t\t\tx=a[j+k],y=mul(g,a[j+k+mid]),\n\t\t\t\ta[j+k]=inc(x,y),a[j+k+mid]=dec(x,y);\n\t} if(tp) return ; int INV=inv[limit];\n\tfp(i,0,limit-1) a[i]=mul(a[i],INV);\n}\nvoid Inv(int* a,int* b,int n){\n\tif(n==1) return b[0]=inv[a[0]],void();\n\tInv(a,b,(n+1)>>1); int len=0;\n\tfor(limit=1;limit<n<<1;limit<<=1) ++len;\n\tfp(i,0,limit-1) r[i]=(r[i>>1]>>1)|((i&1)<<(len-1));\n\tfp(i,0,n-1) C[i]=a[i],D[i]=b[i];\n\tfp(i,n,limit-1) C[i]=D[i]=0; NTT(C,1),NTT(D,1);\n\tfp(i,0,limit-1) C[i]=mul(C[i],mul(D[i],D[i])); NTT(C,0);\n\tfp(i,0,n-1) b[i]=dec(inc(b[i],b[i]),C[i]);\n}\ninline void Direv(int* a,int* b,int n){\n\tfp(i,1,n-1) b[i-1]=mul(a[i],i); b[n-1]=0;\n}\ninline void Inter(int* a,int* b,int n){\n\tfp(i,1,n-1) b[i]=mul(a[i-1],inv[i]); b[0]=0;\n}\ninline void Ln(int* a,int* b,int n){\n\tDirev(a,A,n),Inv(a,B,n); int len=0;\n\tfor(limit=1;limit<n<<1;limit<<=1) ++len;\n\tfp(i,0,limit-1) r[i]=(r[i>>1]>>1)|((i&1)<<(len-1));\n\tNTT(A,1),NTT(B,1);\n\tfp(i,0,limit-1) A[i]=mul(A[i],B[i]);\n\tNTT(A,0),Inter(A,b,limit);\n\tmemset(A,0,limit<<2);\n\tmemset(B,0,limit<<2);\n}\ninline void Exp(int* a,int* b,int n){\n\tif(n==1) return b[0]=1,void();\n\tExp(a,b,(n+1)>>1),Ln(b,F,n); int len=0;\n\tfor(limit=1;limit<n<<1;limit<<=1) ++len;\n\tfp(i,0,limit-1) r[i]=(r[i>>1]>>1)|((i&1)<<(len-1));\n\tF[0]=dec(a[0]+1,F[0]);\n\tfp(i,1,n-1) F[i]=dec(a[i],F[i]); NTT(F,1),NTT(b,1);\n\tfp(i,0,limit-1) b[i]=mul(b[i],F[i]); NTT(b,0);\n\tfp(i,n,limit-1) b[i]=F[0]=0;\n}\ninline int Max(int x,int y){return x>y?x:y;}\ninline int Min(int x,int y){return x<y?x:y;}\nint main(){ n=read(),k=read(); fp(i,0,n-1) f[i]=read();\n\tif(k==0){ print(1); fp(i,1,n-1) print(0); return Ot(),0; }\n\tif(n==1&&f[0]==0) return !printf(\"0\\n\");\n\tint num=0; while(num<n&&!f[num]) ++num; int iv=qpow(f[num]);\n\tfp(i,0,n-num-1) f[i]=mul(f[i+num],iv); fp(i,n-num,n-1) f[i]=0;\n\tiv=qpow(qpow(iv),k),num=1ll*num*k>n?n:num*k;\n\tfor(limit=1;limit<=n<<1;limit<<=1); inv[1]=1;\n\tfp(i,2,limit<<1) inv[i]=1ll*inv[mod%i]*(mod-mod/i)%mod;\n\tLn(f,g,n); fp(i,0,n-1) g[i]=mul(g[i],k);\n\tExp(g,h,n); fp(i,0,num-1) print(0);\n\tfp(i,num,n-1) print(mul(h[i-num],iv)); return Ot(),0;\n}\n```\n\n\n\n\n\n\n\n\n",
        "postTime": 1570436584,
        "uid": 38576,
        "name": "J\u03bcdge",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5273 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5e42\u51fd\u6570 (\u52a0\u5f3a\u7248)\u3011"
    },
    {
        "content": "\u4f3c\u4e4e\u5927\u5bb6\u90fd\u662f\u8be1\u5f02\u7684\u5199\u6cd5\uff0c\u6ca1\u6709\u4eba\u7528$O(n\\log^2 n)$\u53bb\u66b4\u529b\u8279\u8fd9\u9053\u9898\u3002\n\n\u7136\u800c\u4e8b\u5b9e\u4e0a\u662f\u5b8c\u5168\u53ef\u4ee5\u5361\u8fc7\u53bb\u7684\u3002\u6211\u7684\u63d0\u4ea4\u867d\u7136\u52a0\u4e86`-O2`\u548c`#pragma`~~\u663e\u5f97\u5341\u5206\u5f1f\u5f1f~~\uff0c\u4f46\u662f\u5176\u5b9e\u53bb\u6389\u4e4b\u540e\u4e5f\u662f\u5f88\u5feb\u7684\u3002\u4e0d\u5439\uff0c\u7edd\u5bf9\u6bd4\u5927\u90e8\u5206\u7684\u666e\u901a$O(n\\log^2n)$\u7684NTT\u8dd1\u5f97\u5feb\u3002\n\n\u90a3\u4e48\u4ee5\u4e0b\u662f\u51e0\u4e2a\u4f18\u5316\u7684\u63aa\u65bd\uff1a\n\n### $\\#1$\n\n\u9884\u5904\u7406\u539f\u6839\u7684\u6b21\u5e42\u2014\u2014\u5361\u5e38\u5229\u5668\u3002\n\n```cpp\nfor (i = 0 ; i < 19  ;++ i){\n        rr int *rua = gg[i] ; rua[0] = 1 ;\n        rr int gi = rua[1] = expow(3, 998244352/(1 << (i + 1))) ;\n        for (j = 2 ; j < (1 << i) ; ++ j) rua[j] = 1ll * rua[j - 1] * gi % P ;\n    }\n```\n\u7136\u540e\u6bcf\u6b21NTT\u5c31\u4e0d\u9700\u8981\u91cd\u65b0\u518d\u8ba1\u7b97\u4e86\u3002\n\n### $\\#2$\n\n\u505a\u5feb\u901f\u5e42\u7684\u65f6\u5019\u6ce8\u610f\u53ef\u4ee5\u5c11\u51e0\u6b21`NTT`\u3002\u8fd9\u70b9\u5e38\u6570\u4f18\u5316\u4e5f\u662f\u9700\u8981\u7684\u3002\n\n```cpp\nwhile (K){\n        NTT(F, M, 1) ;\n        if (K & 1){\n            NTT(A, M, 1) ;\n            for (i = 0 ; i < M ; ++ i) A[i] = 1ll * A[i] * F[i] % P ;\n            NTT(A, M, -1) ; for (i = N ; i < M ; ++ i) A[i] = 0 ;\n        }\n        for (i = 0 ; i < M ; ++ i)\n            F[i] = 1ll * F[i] * F[i] % P ; NTT(F, M, -1) ;\n        for (i = N ; i < M ; ++ i) F[i] = 0 ; K >>= 1 ;\n    }\n```\n\n### $\\#3$\n\n\u4e0d\u7528`long long`.\n\n\u8fd9\u5176\u5b9e\u4e00\u4e2a\u901a\u7528\u7684\u6280\u5de7\uff0c\u56e0\u4e3along long\u4e00\u822c\u90fd\u6bd4int\u591a\u597d\u591a\u5e38\u6570\u3002\u540c\u65f6\u4e0d\u8981\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\u800c\u9009\u62e9`1ll*`\u8fd9\u79cd\u5f62\u5f0f\u3002\u5b9e\u6d4b\u53ef\u4ee5\u5feb\u8bb8\u591a\u3002\n\n\u795d\u5927\u5bb6\u5361\u5e38\u987a\u5229qwq",
        "postTime": 1564816749,
        "uid": 28313,
        "name": "\u768e\u6708\u534a\u6d12\u82b1",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5273 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5e42\u51fd\u6570 (\u52a0\u5f3a\u7248)\u3011"
    },
    {
        "content": "\u76f4\u63a5 [$\\ln$](https://www.luogu.org/problemnew/show/P4725) \u540e\u7cfb\u6570\u4e58 $k$ \u518d [$\\exp$](https://www.luogu.org/problemnew/show/P4726) \u5373\u53ef\u3002\n\n\u6ce8\u610f\u4f7f\u7528 $\\ln$ \u548c $\\exp$ \u7684\u65f6\u5019\uff0c\u4f1a\u9ed8\u8ba4\u4f60\u7684\u5e38\u6570\u9879\u4e3a $1$ \u3002\u4f46\u662f\u6709\u7684\u65f6\u5019\u5e76\u4e0d\u6ee1\u8db3\u8fd9\u4e2a\u6761\u4ef6\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u8003\u8651\u6574\u4e2a\u591a\u9879\u5f0f\u5148\u9664\u53bb\u5e38\u6570\u9879\uff0c\u8ba1\u7b97\u5b8c\u540e\u518d\u4e58\u56de\u53bb\u3002\n\n\u4f46\u662f\u5e38\u6570\u9879\u53ef\u80fd\u6ca1\u6709???\n\n\u8fd9\u660e\u663e\u4e0d\u662f\u95ee\u9898\u3002\u6211\u4eec\u53ea\u9700\u8981\u8bb0\u4e00\u4e2a\u6700\u4f4e\u9879\u548c\u4ed6\u7684\u7cfb\u6570(\u8bbe\u4e3a $a_tx^t$) \uff0c\u7136\u540e\u6574\u4e2a\u591a\u9879\u5f0f\u9664\u6389\u8fd9\u4e2a\u5355\u9879\u5f0f(\u8fd9\u4e2a\u53ef\u4ee5\u8f7b\u677e\u505a\u5230 $O(1)$) \u3002\u5728\u5feb\u901f\u5e42\u8ba1\u7b97\u5b8c\u6bd5\u540e\uff0c\u6211\u4eec\u518d\u7ed9\u6574\u4e2a\u5f0f\u5b50\u4e58\u4e0a $a_t^m x^{tm}$ \u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6 $O(n\\log n)$ (\u4f46\u662f\u56e0\u4e3a\u6211\u7684 $\\exp$ \u7528\u5206\u6cbb $FFT$ \u6c42\u7684\u5176\u5b9e\u662f $O(n\\log^2n)$ , $O(n\\log n)$ \u7684\u7b97\u6cd5\u53ef\u80fd\u4f1a\u56e0\u4e3a\u5e38\u6570\u95ee\u9898\u66f4\u6162)\u3002\n\n\n\u6709\u4e2a\u5f88\u7b80\u5355\u7684\u5361\u5e38\u6280\u5de7\u3002 \u53ef\u4ee5\u53d1\u73b0\u6211\u4eec\u6c42\u51fa\u6765\u7684\u5f0f\u5b50\u7684\u6700\u540e $x^{tm}$ \u9879\u4f1a\u662f $0$ \uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651\u540e\u9762\u7684 $n-tm$ \u9879\u3002\u505a $\\ln$ \u548c $\\exp$ \u7684\u65f6\u5019\u53ef\u4ee5\u76f4\u63a5\u53ea\u505a\u957f\u5ea6\u4e3a $n-tm$ \u7684\u3002 \u8fd9\u6837\u4f1a\u5feb\u5f88\u591a\u3002\n\n\u6838\u5fc3\u4ee3\u7801:\n\n```cpp\n#define rep(i,a,b) for(int i = (a); i < (b); ++ i)\n#define Rep(i,a,b) for(int i = (a); i <= (b); ++ i)\ninline void write(int x, char ch = '\\n');//\u5feb\u8f93\ninline void Exp(int*u,int*v,int len);//exp\ninline void Ln(int*u,int*v,int len);//ln\ninline int power(int u,int v);//\u5feb\u901f\u5e42\ninline void pow(int *F,int n,int k)\n{\n\tint lst=n;\n\trep(i,0,n)if(F[i]){lst=i;break;}\n\tif((ll)lst*m>=n)\n\t{\n\t\tRep(i,1,n)write(0,' ');flush();\n\t\treturn;\n\t}\n\tint md=n-m*lst,bs=F[lst],iv=power(bs,mod-2);\n\trep(i,lst,n)F[i]=(ll)F[i]*iv%mod;\n\tLn(F+lst,F,md);\n\trep(i,0,md)F[i]=(ll)F[i]*m%mod;\n\tExp(F,F,md);\n\tRep(i,1,lst*m)write(0,' ');\n\tbs=power(bs,m);\n\trep(i,0,md)write((ll)F[i]*bs%mod,' ');\n\tflush();\n}\n```\n\n\u4f60\u4e5f\u53ef\u4ee5\u5199\u4e00\u4e2a\u5feb\u901f\u5e42\uff0c\u7ec3\u4e60\u4e00\u4e0b\u5361\u5e38\u3002 \u8fd9\u6837\u7684\u8bdd\u590d\u6742\u5ea6\u4e3a $O(n\\log n\\log mod)$ \u3002",
        "postTime": 1553505652,
        "uid": 7035,
        "name": "Great_Influence",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5273 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5e42\u51fd\u6570 (\u52a0\u5f3a\u7248)\u3011"
    }
]
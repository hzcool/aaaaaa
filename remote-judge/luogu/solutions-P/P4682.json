[
    {
        "content": "\u8fd9\u9898\u6570\u636e\u8303\u56f4\u5e76\u4e0d\u5927\uff0c\u663e\u7136\u4e0d\u7528\u4ec0\u4e48\u590d\u6742\u7684\u4f18\u5316\uff0c\u6c42\u51fa\u6bcf\u4e2a\u7c92\u5b50\u6bcf\u6bb5\uff08\u8fd9\u91cc\u7b80\u79f0\u67d0\u7c92\u5b50\u4e24\u6b21\u78b0\u649e\u4e4b\u95f4\u7684\u90e8\u5206\u4e3a\u4e00\u6bb5\uff0c\u5305\u62ec\u65f6\u523b0\u5230\u7b2c\u4e00\u6b21\u78b0\u649e\uff09\u7684\u4fe1\u606f\u5c31\u884c\u4e86\uff0c\u901a\u8fc7\u89c2\u5bdf\u53ef\u53d1\u73b0\uff0c\u53ea\u9700\u8981\u5904\u7406\u597d\u4ee5\u4e0b\u4e09\u4e2a\u95ee\u9898\uff08\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u628a\u6240\u6709\u5750\u6807\u5206\u522b\u51cf\u53bb\u5706\u5fc3\u7684\u5750\u6807\uff0c\u518d\u628a\u5706\u5fc3\u7684\u5750\u6807\u6539\u4e3a(0,0)\uff09\uff1a\n\n1\u3001\u67d0\u7c92\u5b50\u5728\u67d0\u6bb5\u4e0e\u5706\u4e0b\u6b21\u78b0\u649e\u7684\u4f4d\u7f6e\n\n2\u3001\u67d0\u7c92\u5b50\u5728\u67d0\u6b21\u78b0\u649e\u540evx,vy\u7684\u53d8\u5316\n\n3\u3001\u7c92\u5b50a\u7684\u67d0\u4e00\u6bb5\u4e0e\u7c92\u5b50b\u7684\u67d0\u4e00\u6bb5\uff08\u4fdd\u8bc1\u67d0\u4e00\u65f6\u523b\u8fd9\u4e24\u6bb5\u540c\u65f6\u5b58\u5728\uff09\u7684\u5386\u53f2\u6700\u8fd1\u8ddd\u79bb\n\n\u5148\u770b\u95ee\u98981\uff0c\u82e5\u6b64\u6bb5\u8d77\u59cb\u70b9\u4e3a(stx,sty)\uff0c\u901f\u5ea6\u4e3a(vx,vy)\uff0c\u8bbe\u78b0\u649e\u65f6\u95f4\u4e3at\uff0c\u5219(stx+vx\u00b7t)\u00b2+(sty+vy\u00b7t)\u00b2=r\u00b2 \u2192 stx\u00b2+vx\u00b2\u00b7t\u00b2+2\u00b7stx\u00b7vx\u00b7t+sty\u00b2+vy\u00b2\u00b7t\u00b2+2\u00b7sty\u00b7vy\u00b7t-r\u00b2=0 \u2192 (vx\u00b2+vy\u00b2)\u00b7t\u00b2+(2\u00b7stx\u00b7vx+2\u00b7sty\u00b7vy)\u00b7t+(stx\u00b2+sty\u00b2-r\u00b2)=0\uff0c\u6211\u4eec\u8bbea=vx\u00b2+vy\u00b2,b=2\u00b7stx\u00b7vx+2\u00b7sty\u00b7vy,c=stx\u00b2+sty\u00b2-r\u00b2\uff0c\u5219t=-b+sqrt(b\u00b2-4ac)/2a\uff08\u820d\u53bb\u5c0f\u89e3\uff0c\u5c0f\u89e3\u4e00\u5b9a\u4e0d\u6210\u7acb\uff09\uff0c\u518d\u901a\u8fc7t\u7b97\u51fa\u4f4d\u7f6e\u5373\u53ef\u3002\n\n\u95ee\u98982\u4e5f\u4e0d\u96be\u60f3\uff0c\u82e5\u4e0e\u5706\u7684\u78b0\u649e\u70b9\u4e3a(x,y)\uff0c\u539f\u901f\u4e3a(x1,x2)\uff0c\u53cd\u5f39\u540e\u4e3a(x2,y2)\uff0c\u4e0d\u96be\u5f97\u51faatan2(x2,y2)-atan2(x,y)=atan2(x,y)-atan2(x1,y1)\uff08\u89d2\u76f8\u7b49\uff09\uff0c\u5373atan2(x2,y2)=2\u00b7atan2(x,y)-atan2(x1,y1)\uff0c\u8bbek=x2/y2\uff0c\u5219k=tan(2\u00b7atan2(x,y)-atan2(x1,y1))\uff0c\u56e0\u4e3a\u901f\u5ea6\u76f8\u540c\uff0c\u6240\u4ee5x1\u00b2+y1\u00b2=x2\u00b2+y2\u00b2\uff0c\u8bbez=x1\u00b2+y1\u00b2\uff0c\u5219y2\u00b2+k\u00b2\u00b7y2\u00b2=z \u2192 (k\u00b2+1)\u00b7y2\u00b2=z \u2192 y2=sqrt(x1\u00b2+y1\u00b2/k\u00b2+1)\uff0c\u7136\u540e\u901a\u8fc7y2\u6c42\u51fax2\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c(-x2,-y2)\u5728\u8fd9\u91cc\u540c\u6837\u6210\u7acb\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5e26\u5165\u4e00\u4e2a\u70b9\u5224\u65ad\u662f\u5426\u5728\u5706\u5185\u6765\u5224\u65ad\u53d6\u54ea\u4e2a\u89e3\u3002\n\n\u95ee\u98983\u7a0d\u5fae\u96be\u4e00\u70b9\uff0c\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u8bbett=max(t1,t2)\uff08t1,t2\u5206\u522b\u4e3a\u4e24\u6bb5\u5f00\u59cb\u7684\u65f6\u523b\uff09\uff0c\u82e5(x1,y1)\uff0c(x2,y2)\u5206\u522b\u4e3att\u65f6\u523b\u4e24\u7c92\u5b50\u7684\u5750\u6807\uff0c(vx1,vy1)\uff0c(vx2,vy2)\u5206\u522b\u4e3a\u4e24\u6bb5\u7684\u901f\u5ea6\uff0cy\u4e3a\u4e24\u7c92\u5b50\u95f4\u8ddd\u79bb\u7684\u5e73\u65b9\uff0cy=((x1+vx1\u00b7t)-(x2+vx2\u00b7t))\u00b2+((y1+vy1\u00b7t)-(y2+vy2\u00b7t))\u00b2 \u2192 y=((x1-x2)+(vx1-vx2)\u00b7t)\u00b2+((y1-y2)+(vy1-vy2)\u00b7t)\u00b2\u6211\u4eec\u8bbexx=x1-x2,yy=y1-y2,vx=vx1-vx2,vy=vy1-vy2\uff0c\u90a3\u4e48y=(xx+vx\u00b7t)\u00b2+(yy+vy\u00b7t)\u00b2 \u2192 y=xx\u00b2+vx\u00b2\u00b7t\u00b2+2\u00b7xx\u00b7vx\u00b7t+yy\u00b2+vy\u00b2\u00b7t\u00b2+2\u00b7yy\u00b7vy\u00b7t \u2192 y=(vx\u00b2+vy\u00b2)\u00b7t\u00b2+(2\u00b7xx\u00b7vx+2\u00b7yy\u00b7vy)\u00b7t+(xx\u00b2+yy\u00b2)\uff0c\u518d\u8bbea=vx\u00b2+vy\u00b2,b=2\u00b7xx\u00b7vx+2\u00b7yy\u00b7vy,c=xx\u00b2+yy\u00b2\uff0c\u7136\u540e\u6c42\u51fa\u6700\u5c0f\u503cy3=4ac-b\u00b2/4a\u5373\u4e3a\u5386\u53f2\u6700\u8fd1\u8ddd\u79bb\uff0c\u7279\u6b8a\u60c5\u51b5\u7279\u5224\u4e00\u4e0b\u5c31\u884c\u4e86\u3002\n\n\u6211\u4eec\u4e00\u5f00\u59cb\u5148\u75281\u30012\u70b9\u5904\u7406\u51fa\u6bcf\u4e2a\u7c92\u5b50\u7684\u6bcf\u4e00\u6bb5\uff0c\u518d\u4e24\u4e2a\u4e24\u4e2a\u7c92\u5b50\u6c42\u5386\u53f2\u6700\u8fd1\u8ddd\u79bb\uff0c\u627e\u6700\u5c0f\u503c\u5373\u4e3a\u7b54\u6848\u3002\n\n**\u4ee3\u7801**\n\n```cpp\n#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <cstdlib>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\ninline int read()\n{\n\tint x=0,w=0;char ch=getchar();\n\twhile(ch<'0'||ch>'9')w|=ch=='-',ch=getchar();\n\twhile(ch>='0'&&ch<='9')x=(x<<1)+(x<<3)+(ch^48),ch=getchar();\n\treturn w?-x:x;\n}\nstruct line{double stx,sty,vx,vy,edt;};\nstruct particle{line f[110];}p[110];\nint n,k;double r,z=0.000000001;\ninline void get_p(int i,int j,double stx,double sty,double vx,double vy)\n{\n\tp[i].f[j].stx=stx,p[i].f[j].sty=sty,p[i].f[j].vx=vx,p[i].f[j].vy=vy;\n\tdouble a=vx*vx+vy*vy,b=2*stx*vx+2*sty*vy,c=stx*stx+sty*sty-r*r;\n\tdouble t=(-b+sqrt(b*b-4*a*c))/(2*a);\n\tp[i].f[j].edt=p[i].f[j-1].edt+t;//\u6c42\u78b0\u649e\u70b9 \n\tif(j<k)\n\t{\n\t\tdouble edx=stx+vx*t,edy=sty+vy*t;\n\t\tdouble kk=tan(atan2(edx,edy)*2-atan2(vx,vy));\n\t\tdouble vy2=sqrt((vx*vx+vy*vy)/(kk*kk+1)),vx2=kk*vy2;\n\t\tdouble tt=sqrt(r)/100000/((vx2+vy2)/2);tt=tt<0?-tt:tt;\n\t\tdouble xx=(edx+vx2*tt),yy=(edy+vy2*tt);\n\t\tif(xx*xx+yy*yy>=r*r)vx2=-vx2,vy2=-vy2;\n\t\tget_p(i,j+1,edx,edy,vx2,vy2);//\u53cd\u5f39 \n\t}\n}\ninline double dis(double x1,double y1,double x2,double y2)\n{\n\tif(x1==x2&&y1==y2)return 0;\n\tdouble x=x1-x2,y=y1-y2;\n\treturn sqrt(x*x+y*y);\n}\nint main()\n{\n\tregister double xx,yy;register int i,j,ii,jj;\n\tscanf(\"%lf%lf%lf\",&xx,&yy,&r);n=read(),k=read();\n\tfor(i=1;i<=n;++i)\n\t{\n\t\tdouble x,y,vx,vy;scanf(\"%lf%lf%lf%lf\",&x,&y,&vx,&vy);\n\t\tx-=xx;y-=yy;p[i].f[0].edt=0;get_p(i,1,x,y,vx,vy);\n\t}\n\tdouble ans=1e50;\n\tfor(i=2;i<=n;++i)\n\t{\n\t\tfor(j=1;j<i;++j)\n\t\t{\n\t\t\tjj=1;\n\t\t\tfor(ii=1;ii<=k;++ii)//\u7b2c\u4e00\u4e2a\u7c92\u5b50\u5904\u4e8e\u7b2cii\u6bb5 \n\t\t\t{\n\t\t\t\t--jj;\n\t\t\t\twhile(p[i].f[ii].edt>p[j].f[jj].edt&&jj<k)//\u5224\u65ad\u4e3a\u4e86\u4f7f\u6709\u67d0\u65f6\u523b\u4e24\u6bb5\uff08ii\uff0cjj+1\uff09\u540c\u65f6\u5b58\u5728\uff0cii\u662f\u5426\u9700\u8981++\n\t\t\t\t{\n\t\t\t\t\t++jj;\n\t\t\t\t\tdouble t1=p[i].f[ii-1].edt,t2=p[j].f[jj-1].edt;\n\t\t\t\t\tdouble x1=p[i].f[ii].stx,x2=p[j].f[jj].stx,y1=p[i].f[ii].sty,y2=p[j].f[jj].sty;\n\t\t\t\t\tdouble vx1=p[i].f[ii].vx,vx2=p[j].f[jj].vx,vy1=p[i].f[ii].vy,vy2=p[j].f[jj].vy;\n\t\t\t\t\tif(vx1==vx2&&vy1==vy2)//\u5982\u679c\u901f\u5ea6\uff0c\u65b9\u5411\u76f8\u7b49\uff0c\u8fdb\u884c\u7279\u6b8a\u5904\u7406 \n\t\t\t\t\t{\n\t\t\t\t\t\tdouble t=max(t1,t2),xx1=x1+vx1*(t-t1),xx2=x2+vx2*(t-t2),yy1=y1+vy1*(t-t1),yy2=y2+vy2*(t-t2);\n\t\t\t\t\t\tans=min(ans,dis(xx1,yy1,xx2,yy2));\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tdouble xx1=x1+vx1*(t1<t2?t2-t1:0),xx2=x2+vx2*(t1>t2?t1-t2:0),yy1=y1+vy1*(t1<t2?t2-t1:0),yy2=y2+vy2*(t1>t2?t1-t2:0);\n\t\t\t\t\t\tdouble vx=vx1-vx2,vy=vy1-vy2;xx=xx1-xx2,yy=yy1-yy2;\n\t\t\t\t\t\tdouble a=vx*vx+vy*vy,b=2*xx*vx+2*yy*vy,c=xx*xx+yy*yy;\n\t\t\t\t\t\tdouble t=-(b/(2*a));\n\t\t\t\t\t\tif(t<0)ans=min(ans,dis(xx1,yy1,xx2,yy2));//\u5982\u679ct<0\uff0c\u53d6\u6700\u8fd1\u7684\u5408\u6cd5\u503c(t=0) \n\t\t\t\t\t\telse if(t+max(t1,t2)>=p[i].f[ii].edt+z||t+max(t1,t2)>=p[j].f[jj].edt+z)//\u5982\u679c\u8be5\u65f6\u523b\u8d85\u51fa\u4efb\u610f\u4e00\u6bb5\u8303\u56f4\uff0c\u53d6\u6700\u8fd1\u7684\u5408\u6cd5\u503c \n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tt=min(p[i].f[ii].edt,p[j].f[jj].edt),xx1=x1+vx1*(t-t1),xx2=x2+vx2*(t-t2),yy1=y1+vy1*(t-t1),yy2=y2+vy2*(t-t2);\n\t\t\t\t\t\t\tans=min(ans,dis(xx1,yy1,xx2,yy2));\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse//\u5426\u5219\u6b63\u5e38\u8ba1\u7b97 \n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdouble d=sqrt((4*a*c-b*b)/(4*a));\n\t\t\t\t\t\t\tans=min(ans,d);\n\t\t\t\t\t\t}\n\t\t\t\t\t}//\u6c42\u8ddd\u79bb \n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%.3lf\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1534230780,
        "uid": 30727,
        "name": "liaohaoping",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4682 \u3010[ZJOI2007]\u7c92\u5b50\u8fd0\u52a8\u3011"
    },
    {
        "content": "## [\u9898\u610f](https://www.luogu.com.cn/problem/P4682)\n\n\u53d1\u73b0\u6570\u636e\u8303\u56f4\u5f88\u5c0f\uff0c\u6211\u4eec\u53ef\u4ee5\u6c42\u51fa\u6bcf\u4e2a\u70b9\u7684\u8f68\u8ff9\u4ee5\u53ca\u5404\u4e2a\u72b6\u6001\u7684\u65f6\u95f4\u6bb5\uff0c\u4e4b\u540e\u679a\u4e3e\u4e24\u4e2a\u70b9\u5224\u65ad\u3002\n\n\u5047\u8bbe\u5f53\u524d\u70b9\u4e3a$A(x_1,y_1)$\uff0c\u901f\u5ea6\u5411\u91cf\u4e3a$AB(v_x,v_y)$\uff0c\u5706\u5fc3\u4e3a$O(x_0,y_0)$\uff0c\u534a\u5f84\u4e3a$R$\uff0c$\\vec{AB}$\u4e0e\u5706\u4ea4\u70b9\u4e3a$C$\u3002\n![](https://cdn.luogu.com.cn/upload/image_hosting/opz6f594.png)\n\u6211\u4eec\u73b0\u5728\u8981\u6c42$C$\uff0c\u5b9e\u9645\u4e0a\u8981\u6c42\u4ece$A$\u8d70\u4e86\u591a\u4e45\u5230$C$\uff0c\u8bbe\u4e3a$t$\u3002  \n$\\vec{OA}+\\vec{AC}=\\vec{OC}$  \n$\\vec{OA}+t\\vec{AB}=\\vec{OC}$  \n$(\\vec{OA}+t\\vec{AB})^2=\\vec{OC}^2$  \n$\\vec{AB}^2t^2+2\\vec{OA}\\vec{AB}t+\\vec{OA}^2=R^2$  \n\u89e3\u51fa$t$\u5373\u53ef\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u77e5\u9053\u6bcf\u4e2a\u7c92\u5b50\u7684\u79fb\u52a8\u8fc7\u7a0b\u3002  \n\n\u6211\u4eec\u679a\u4e3e\u6bcf\u5bf9\u7c92\u5b50$(i,j)$\u8ba1\u7b97\u5b83\u4eec\u4e4b\u95f4\u8ddd\u79bb\u7684\u6700\u5c0f\u503c\u6765\u66f4\u65b0\u7b54\u6848\u3002\n\n\u5047\u8bbe\u5f53\u524d$i$\u5728$a$\uff0c$j$\u5728$b$\uff0c$i$\u7684\u901f\u5ea6\u5411\u91cf\u4e3a$v_1$\uff0c$j$\u7684\u901f\u5ea6\u5411\u91cf\u4e3a$v_2$\u3002\n\n\u6211\u4eec\u5c06$(i,j)$\u7684\u8ddd\u79bb\u8868\u793a\u4e3a\u4e00\u4e2a\u4e8c\u6b21\u51fd\u6570\uff1a$dis(i,j)=dis(a+tv_1,b+tv_2)=\\sqrt{(a+tv_1-(b+tv_2))^2}$  \n\n\u6211\u4eec\u4e8c\u6b21\u51fd\u6570\u6c42\u6700\u503c\u5373\u53ef\u3002\n\ncode:\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=110;\nconst int maxm=110;\nconst double eps=1e-8;\nconst double inf=1e18;\nint n,m;\ndouble R,ans=inf;\ndouble tim[maxn][maxm];\nstruct Point\n{\n    double x,y;\n    inline double len(){return sqrt(x*x+y*y);}\n    Point operator+(const Point a)const{return (Point){x+a.x,y+a.y};}\n    Point operator-(const Point a)const{return (Point){x-a.x,y-a.y};}\n    Point operator*(const double k){return (Point){x*k,y*k};}\n    Point operator/(const double k){return (Point){x/k,y/k};}\n    double operator*(const Point a)const{return x*a.y-y*a.x;}\n    double operator^(const Point a)const{return x*a.x+y*a.y;}\n};\ninline int dcmp(double x)\n{\n    if(fabs(x)<=eps)return 0;\n    return x<0?-1:1;\n} \ninline Point get(Point a,Point b){return b-a;}\nPoint O;\nPoint p[maxn][maxm],v[maxn][maxm];\ninline double calc(double a,double b,double c){return (-b+sqrt(b*b-4*a*c))/a/2.0;}//\u89e3\u4e00\u5143\u4e8c\u6b21\u65b9\u7a0b\u3002 \ninline bool check(Point a,Point b,Point c){return dcmp(get(b,c)*get(b,a))>=0;}//\u5224\u65ada\u662f\u5426\u5728bc\u5de6\u8fb9\u3002 \ninline Point turn(Point a,int op){return (op==1)?(Point){a.y,-a.x}:(Point){-a.y,a.x};}//\u6839\u636ea\u5728bc\u5de6\u53f3\u65cb\u8f6c90\u5ea6\u3002 \ninline Point change(Point a,Point b,Point c)//\u6c42a\u5173\u4e8ebc\u7684\u5bf9\u79f0\u70b9\u3002 \n{\n\tdouble h=fabs(get(a,b)*get(a,c))/get(b,c).len();\n\tPoint dir=check(a,b,c)?turn(get(b,c),1):turn(get(b,c),2);\n\treturn a+dir*(2.0*h/dir.len());\n}\ninline double work(double a,double b,double c,double x){return a*x*x+b*x+c;}\ninline double solve(int i,int j,int now1,int now2,double tl,double tr)\n{\n\tPoint v1=v[i][now1],v2=v[j][now2];\n\tPoint p1=p[i][now1]+v1*(tl-tim[i][now1]),p2=p[j][now2]+v2*(tl-tim[j][now2]);\n\tPoint tp=p1-p2,tv=v1-v2;\n\tdouble a=tv^tv,b=(tv^tp)*2,c=tp^tp,len=tr-tl;\n\tif(!dcmp(a))return b>0?sqrt(work(a,b,c,0)):sqrt(work(a,b,c,len));\n\telse  \n\t{\n\t\tdouble x=max(0.0,min(-b/a/2,len));\n\t\treturn sqrt(work(a,b,c,x));\n\t}\n}\nint main()\n{\n\t//freopen(\"test.in\",\"r\",stdin);\n\t//freopen(\"test.out\",\"w\",stdout);\n\tscanf(\"%lf%lf%lf\",&O.x,&O.y,&R);\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=n;i++)scanf(\"%lf%lf%lf%lf\",&p[i][0].x,&p[i][0].y,&v[i][0].x,&v[i][0].y);\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m+1;j++)\n\t\t{\n\t\t\tPoint tp=p[i][j-1]-O,tv=v[i][j-1];\n\t\t\tdouble t=calc(tv^tv,(tp^tv)*2,(tp^tp)-R*R);\n\t\t\ttim[i][j]=tim[i][j-1]+t;\n\t\t\tp[i][j]=p[i][j-1]+tv*t;\n\t\t\tv[i][j]=get(p[i][j],change(p[i][j-1],O,p[i][j]));\n\t\t\tv[i][j]=(v[i][j]/v[i][j].len())*v[i][j-1].len();\n\t\t}\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=i+1;j<=n;j++)\n\t\t{\n\t\t\tint now1=0,now2=0;\n\t\t\twhile(now1<=m&&now2<=m)\n\t\t\t{\n\t\t\t\tans=min(ans,solve(i,j,now1,now2,max(tim[i][now1],tim[j][now2]),min(tim[i][now1+1],tim[j][now2+1])));\n\t\t\t\tif(dcmp(tim[i][now1+1]-tim[j][now2+1])<0)now1++;\n\t\t\t\telse now2++;\n\t\t\t}\n\t\t}\n\tprintf(\"%.3lf\",ans);\n\treturn 0;\n} \n```\n",
        "postTime": 1579051628,
        "uid": 145441,
        "name": "nofind",
        "ccfLevel": 6,
        "title": "P4682 [ZJOI2007]\u7c92\u5b50\u8fd0\u52a8(\u8ba1\u7b97\u51e0\u4f55)"
    },
    {
        "content": "\u521a\u5b66\u8ba1\u7b97\u51e0\u4f55\uff0c\u6765\u5199\u4e00\u7bc7\u9898\u89e3\u3002\n\n---\n\n\u5148\u8003\u8651\u4e00\u4e2a\u7c92\u5b50\u7684\u8fd0\u52a8\u60c5\u51b5\u3002\n\n\u82e5\u4e0d\u8003\u8651\u78b0\u649e\uff0c\u4e00\u4e2a\u7c92\u5b50\u5c06\u4f1a\u6cbf\u7740\u4e00\u6761\u5c04\u7ebf\u8fd0\u52a8\uff0c\u4e8e\u662f\u53ef\u4ee5\u8bb0\u5f55\u4e24\u4e2a\u91cf\u6765\u8868\u793a\u4e00\u4e2a\u7c92\u5b50\uff1a\u8d77\u59cb\u70b9 $p$ \u548c\u901f\u5ea6 $\\vec{v}$\u3002\u8fd9\u6837\u8868\u793a\u6709\u4e00\u4e2a\u975e\u5e38\u597d\u7528\u7684\u4e1c\u897f\uff1a$t$ \u65f6\u523b\u7c92\u5b50\u6240\u5728\u7684\u4f4d\u7f6e $p'$ \u6240\u8868\u793a\u7684\u5411\u91cf $\\vec{p'}=\\vec{p}+t\\vec{v}$\u3002\n\n\u5f53\u53d1\u751f\u78b0\u649e\u65f6\uff0c\u6709\u4e0b\u9762\u8fd9\u5f20\u56fe\uff1a\n\n![dPwEwV.jpg](https://s1.ax1x.com/2020/08/14/dPwEwV.jpg)\n\n\u6b64\u65f6 $p$ \u5728\u5706\u4e0a\uff0c\u78b0\u649e\u524d\u7684\u901f\u5ea6\u4e3a $v$ \uff0c\u78b0\u649e\u540e\u7684\u901f\u5ea6\u4e3a $v_1$ \uff0c$v_2$ \u7531 $v_1$ \u5e73\u79fb\u800c\u6765\u3002\u6211\u4eec\u9700\u8981\u5c06 $v$ \u65cb\u8f6c $2\\alpha$ \u81f3 $v_2$\u3002$\\alpha$ \u4e0d\u96be\u7531 $v,p$ \u7b97\u51fa\uff1a\n$$\n{\\rm{sin}}\\ \\alpha={\\rm{cos}}\\ \\beta=\\frac{\\vec{p} * \\vec{v}}{|\\vec{p}||\\vec{v}|}\n$$\n$$\n{\\rm{cos}}\\ \\alpha={\\rm{sin}}\\ \\beta=\\frac{\\vec{p} \\times \\vec{v}}{|\\vec{p}||\\vec{v}|}\n$$\n\u7531\u4e09\u89d2\u6052\u7b49\u53d8\u6362\u5f97\uff1a\n$$\n{\\rm{sin}}\\ 2\\alpha=2\\ {\\rm{sin}}\\ \\alpha\\ {\\rm{cos}}\\ \\alpha\n$$\n$$\n{\\rm{cos}}\\ 2\\alpha={\\rm{cos}}^2\\ \\alpha-{\\rm{sin}}^2\\ \\alpha\n$$\n\u5411\u91cf\u65cb\u8f6c\u6709\u516c\u5f0f\uff0c\u76f4\u63a5\u8d34\u4e0a\uff1a\n\n$v=(x,y)$ \u9006\u65f6\u9488\u65cb\u8f6c $\\alpha$ \u5f97\u5230 $v'=(x\\ {\\rm{cos}}\\ \\alpha-y\\ {\\rm{sin}}\\ \\alpha,y\\ {\\rm{cos}}\\ \\alpha+x\\ {\\rm{sin}}\\ \\alpha)$\u3002\n\n---\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u6700\u8fd1\u8ddd\u79bb**\u53ea\u4e0e\u4e24\u4e2a\u7c92\u5b50**\u6709\u5173\uff0c\u4e8e\u662f\u53ef\u4ee5\u679a\u4e3e\u4e24\u4e2a\u7c92\u5b50 $a,b$\uff0c\u5355\u72ec\u8003\u8651\u5b83\u4eec\u7684\u8fd0\u52a8\u60c5\u51b5\u3002\n\n\u8bbe\u7c92\u5b50 $a$ \u7684\u8d77\u59cb\u70b9\u4e3a $p_a$\uff0c\u901f\u5ea6\u4e3a $\\vec{v_a}$ \uff0c\u7c92\u5b50 $b$ \u7684\u8d77\u59cb\u70b9\u4e3a $p_b$\uff0c\u901f\u5ea6\u4e3a $\\vec{v_b}$ \uff0c\u8fd0\u52a8\u65f6\u95f4\u4e3a $t$\uff0c\u7c92\u5b50\u95f4\u8ddd\u79bb\u8868\u793a\u4e3a\u77e2\u91cf $\\vec{dis}$\uff0c\u5219\u6709\uff1a\n$$\n\\vec{dis}=(\\vec{p_a}+t\\vec{v_a})-(\\vec{p_b}+t\\vec{v_b})=(\\vec{p_a}-\\vec{p_b})+t(\\vec{v_a}-\\vec{v_b})=(x_p+tx_v,y_p+ty_v)\n$$\n\u7c92\u5b50\u95f4\u8ddd\u79bb\u5373\u4e3a $|\\vec{dis}|$\uff0c\u6709\uff1a\n$$\n|\\vec{dis}|=\\sqrt{(x_p+tx_v)^2+(y_p+ty_v)^2}=\\sqrt{(x_v^2+y_v^2)t^2+2t(x_px_v+y_py_v)+x_p^2+y_p^2}\n$$\n\u8fd9\u4e2a\u4e8c\u6b21\u51fd\u6570\u5728\u5bf9\u79f0\u8f74\u53d6\u5230\u6700\u5c0f\u503c\uff0c\u5373\uff1a\n$$\nt=-\\frac{x_px_v+y_py_v}{x_v^2+y_v^2}\n$$\n\u4ee3\u5165\u539f\u65b9\u7a0b\uff1a\n$$\n|\\vec{dis}|=\\sqrt{\\frac{(x_px_v+y_py_v)^2}{x_v^2+y_v^2}-\\frac{2(x_px_v+y_py_v)^2}{x_v^2+y_v^2}+x_p^2+y_p^2}\n$$\n$$\n=\\frac{\\sqrt{(x_p^2+y_p^2)(x_v^2+y_v^2)-(x_px_v+y_py_v)^2}}{\\sqrt{x_v^2+y_v^2}}\n$$\n$$\n=\\frac{\\sqrt{x_p^2y_v^2+y_p^2x_v^2-2x_py_px_vy_v}}{\\sqrt{x_v^2+y_v^2}}\n$$\n$$\n=\\frac{x_py_v-y_px_v}{\\sqrt{x_v^2+y_v^2}}\n$$\n$$\n=\\frac{\\vec{p}\\times\\vec{v}}{len(\\vec{v})}\n$$\n\n\u8fd9\u6837\u5c31\u80fd\u591f\u8f7b\u677e\u5730\u6c42\u51fa\u4e24\u4e2a\u7c92\u5b50\u7684\u6700\u5c0f\u8ddd\u79bb\u3002\n\n\u4f46\u662f\u8fd9\u6837\u7b97\u8fd8\u6709\u4e00\u4e2a\u5c0f\u95ee\u9898\uff1a$t$ \u6709\u53d6\u503c\u8303\u56f4\uff0c\u4e0d\u4e00\u5b9a\u80fd\u53d6\u5230\u5bf9\u79f0\u8f74\uff0c\u5373\u4e8c\u6b21\u51fd\u6570\u5728 $t$ \u7684\u53d6\u503c\u8303\u56f4\u4e0a\u662f\u5355\u8c03\u7684\u3002\u8fd9\u4e2a\u95ee\u9898\u4f1a\u5728 $a,b$ \u7684\u8fd0\u52a8\u8f68\u8ff9\u4e0d\u76f8\u4ea4\u65f6\u51fa\u73b0\uff0c\u7279\u5224\u4e00\u4e0b\u8fd9\u79cd\u60c5\u51b5\u5373\u53ef\u3002\n\n---\n\nCode:\n\n```cpp\n#include <iostream>\n#include <cstring>\n#include <cstdio>\n#include <algorithm>\n#include <cmath>\n#define maxn 105\n#define Rint register int\n#define INF 0x3f3f3f3f\nusing namespace std;\ntypedef long long lxl;\nconst double eps=1e-9;\n\ntemplate <typename T>\ninline T read()\n{\n\tT x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9') {if(ch=='-') f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9') {x=(x<<1)+(x<<3)+ch-'0';ch=getchar();}\n\treturn x*f;\n}\n\ninline bool zero(double x) {return fabs(x)<eps;}\n\nstruct Point\n{\n\tdouble x,y;\n\tinline Point(double x=0,double y=0):x(x),y(y){}\n\tinline Point operator + (const Point &T)const// \u52a0\n\t{\n\t\treturn Point(x+T.x,y+T.y);\n\t}\n\tinline Point operator - ()const// \u53d6\u8d1f\n\t{\n\t\treturn Point(-x,-y);\n\t}\n\tinline Point operator - (const Point &T)const// \u51cf\n\t{\n\t\treturn *this+(-T);\n\t}\n\tinline Point operator * (const double &a)const// \u6570\u4e58\n\t{\n\t\treturn Point(x*a,y*a);\n\t}\n\tinline Point operator / (const double &a)const// \u6570\u9664\n\t{\n\t\treturn Point(x/a,y/a);\n\t}\n\tinline double operator * (const Point &T)const// \u70b9\u4e58\n\t{\n\t\treturn x*T.x+y*T.y;\n\t}\n\tinline double operator % (const Point &T)const// \u53c9\u4e58\n\t{\n\t\treturn x*T.y-y*T.x;\n\t}\n\tinline double len() {return sqrt((*this) * (*this));}// \u5411\u91cf\u957f\u5ea6\n\tinline void rotate(double cosa,double sina)// \u5411\u91cf\u65cb\u8f6c a \u89d2\u5ea6\n\t{\n\t\t(*this)=Point(x*cosa-y*sina,x*sina+y*cosa);\n\t}\n\tinline Point unit()// \u540c\u65b9\u5411\u7684\u5355\u4f4d\u5411\u91cf\n\t{\n\t\treturn (*this)/(*this).len();\n\t}\n\tinline void read()\n\t{\n\t\tscanf(\"%lf%lf\",&x,&y);\n\t}\n};\n\ntypedef Point Vec;// \u5411\u91cf\u7684\u5750\u6807\u8868\u793a\n\nstruct node\n{\n\tPoint p;// \u8d77\u59cb\u70b9\n\tVec v;// \u901f\u5ea6\n\tdouble t,T;// t:\u8fd8\u9700\u591a\u4e45\u53d1\u751f\u78b0\u649e T:\u8d70\u8fc7\u8be5\u65b9\u5411\u7684\u5272\u7ebf\u6240\u9700\u65f6\u95f4\n\tint cnt;// \u78b0\u649e\u6b21\u6570\n}A[maxn];\n\nPoint cir;\ndouble R,ans=INF;\nint n,k;\n\ninline void calcu(node &a)\n{\n\tdouble v=a.v.len();// \u901f\u7387\n\tdouble d=fabs(a.p%a.v)/v;// \u5706\u5fc3\u5230\u76f4\u7ebf\u7684\u8ddd\u79bb\n\tdouble m=sqrt(R*R-d*d);// \u5272\u7ebf\u957f\u5ea6\u7684\u4e00\u534a\n\ta.T=2*m/v;\n\ta.t=(m+a.v.unit()*(-a.p))/v;\n}\n\ninline void flip(node &a)// \u78b0\u649e\n{\n\tdouble len=a.p.len()*a.v.len();\n\tdouble sn=a.p*a.v/len,cs=(a.p%a.v)/len;\n\tdouble sina=2*sn*cs,cosa=cs*cs-sn*sn;\n\ta.v.rotate(cosa,sina);\n}\n\ninline void update(Point pa,Point pb,Vec va,Vec vb)\n{\n\tif((pa-pb)*(vb-va)>0&&(pa+va-pb-vb)*(va-vb)>0)// \u7279\u5224\u4e0d\u76f8\u4ea4\n\t\tans=min(ans,fabs((pa-pb)%(vb-va))/(vb-va).len());\n\telse ans=min(ans,min((pa-pb).len(),(pa+va-pb-vb).len()));\n}\n\ninline void solve(node a,node b)\n{\n\tdouble t;\n\tVec v1,v2;\n\twhile(a.cnt<k&&b.cnt<k)\n\t{\n\t\tt=min(a.t,b.t);\n\t\ta.t-=t;b.t-=t;\n\t\tv1=a.v*t,v2=b.v*t;\n\t\tupdate(a.p,b.p,v1,v2);\n\t\ta.p=a.p+v1,b.p=b.p+v2;\n\t\tif(zero(a.t)) flip(a),a.t=a.T,++a.cnt;\n\t\tif(zero(b.t)) flip(b),b.t=b.T,++b.cnt;\n\t}\n}\n\nint main()\n{\n\t// freopen(\"P4682.in\",\"r\",stdin);\n\tcir.read();scanf(\"%lf\",&R);\n\tn=read<int >(),k=read<int >();\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tA[i].p.read(),A[i].v.read();\n\t\tA[i].p=A[i].p-cir;\n\t\tcalcu(A[i]);\n\t}\n\tfor(int i=1;i<=n;++i)\n\t\tfor(int j=i+1;j<=n;++j)\n\t\t\tsolve(A[i],A[j]);\n\tprintf(\"%.3lf\\n\",ans);\n\treturn 0;\n}\n\n```\n\n",
        "postTime": 1597416244,
        "uid": 224236,
        "name": "GoPoux4",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4682 \u3010[ZJOI2007]\u7c92\u5b50\u8fd0\u52a8\u3011"
    }
]
[
    {
        "content": "## \u9898\u76ee\u5927\u610f\n\n\u672c\u9898[\u9898\u9762](https://www.luogu.com.cn/problem/P4796) \u8bb2\u7684\u6bd4\u8f83\u6e05\u695a\u4e86\uff0c\u8fd9\u91cc\u4e0d\u7ec6\u8bf4\u3002\n\n## \u601d\u8def\n\n\u8003\u8651\u72b6\u538b dp\uff0c$ dp_{i,S} $ \u8868\u793a\u8d70\u5230 i \u70b9\uff0c\u5df2\u7528\u989c\u8272\u7684\u72b6\u6001\u662f S \u7684\u65b9\u6848\u6570\u3002\n\n\u521d\u59cb\u5316\uff1a\u5f88\u663e\u7136 $ dp_{i,1<<(a_i-1)} $ \u5e94\u8be5\u521d\u59cb\u5316\u4e3a 1\u3002\n\n\u8f6c\u79fb\uff1a\u5148\u679a\u4e3e\u72b6\u6001\uff0c\u518d\u679a\u4e3e\u70b9\u8fdb\u884c\u8f6c\u79fb\uff0c\u5982\u679c\u6709\u4e24\u4e2a\u70b9\u4ee5\u4e0a\uff08\u5373 S \u4e2d\u6709 2 \u4e2a 1 \u4ee5\u4e0a\uff09\u5c31\u53ef\u4ee5\u7edf\u8ba1\u8fdb\u7b54\u6848\u3002\n\n\u6613\u5f97\u8f6c\u79fb\u65b9\u7a0b\uff1a$ dp_{v,t|(1<<(a_v)-1)} \\gets dp_{v,t|(1<<(a_v)-1)} + dp_{j,t} $\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>//\u795d\u5927\u5bb6\u5b66\u4e60\u6109\u5feb\uff01\n\n#define int long long\n\nusing namespace std;\n\nconst int maxn=3e5+10;\nstruct edge{\n\tint to,nxt;\n}e[maxn<<1];\nint head[maxn],n,m,k,s;\nint dp[maxn][40],a[maxn];\nint dt[maxn],cnt=0,ans=0;\n\nvoid add(int u,int v){\n\te[++cnt].to=v;\n\te[cnt].nxt=head[u];\n\thead[u]=cnt;\n}\n\nint lowbit(int x){\n\treturn x&(-x);\n}\nint num1(int x){\n\tint res=0;\n\twhile(x){\n\t\tres++;\n\t\tx-=lowbit(x);\n\t}\n\treturn res;\n}\n\nbool cmp(int x,int y){\n\treturn num1(x)<num1(y);\n}\n\ninline void init(){\n\ts=(1<<k)-1;\n\tfor(int i=1;i<=s;i++) dt[i]=i;\n\tsort(dt+1,dt+s+1,cmp);\n\tmemset(dp,0,sizeof(dp));\n\tmemset(head,-1,sizeof(head));\n}\nvoid solve(){\n\tfor(int i=1;i<=n;i++) dp[i][1<<(a[i]-1)]=1;\n\tfor(int i=1;i<=s;i++){\n\t\tint tmp=dt[i];\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tif(dp[j][tmp]){\n\t\t\t\tif(num1(tmp)>=2) ans+=dp[j][tmp];\n\t\t\t\tfor(int k=head[j];k!=-1;k=e[k].nxt){\n\t\t\t\t\tint v=e[k].to;\n\t\t\t\t\tif(tmp&(1<<(a[v]-1))) continue;\n\t\t\t\t\tdp[v][tmp|(1<<(a[v]-1))]+=dp[j][tmp];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nsigned main(){\n\t\n\tscanf(\"%lld %lld %lld\",&n,&m,&k);\n\tfor(int i=1;i<=n;i++) scanf(\"%lld\",&a[i]);\n\t\n\tinit();\n\t\n\tfor(int i=1;i<=m;i++){\n\t\tint u,v;\n\t\tscanf(\"%lld %lld\",&u,&v);\n\t\tadd(u,v);\n\t\tadd(v,u);\n\t}\n\t\n\tsolve();\n\t\n\tprintf(\"%lld\\n\",ans);\n\t\n\treturn 0;\n}\n\n\n```\n",
        "postTime": 1641196833,
        "uid": 234469,
        "name": "hxyqwq",
        "ccfLevel": 6,
        "title": "P4796 \u9898\u89e3"
    },
    {
        "content": "### Paths\n\n### \u8def\u5f84\n\n**\u7ffb\u8bd1\u81ea [BalticOI 2018 Day 2 \u9898\u89e3](https://boi2018.progolymp.se/spoiler-day2.pdf)**\n\n#### \u5b50\u4efb\u52a1 1\n\n\u66b4\u529b\u679a\u4e3e\u6240\u6709\u5408\u6cd5\u7684\u8def\u5f84\u5c31\u53ef\u4ee5\u5f97\u5230\u5b50\u4efb\u52a1 1 \u7684\u5206\u6570\uff08\u89c1\u4e0b\u9762\u7684\u7b97\u6cd5\uff0c\u53bb\u6389\u8bb0\u5fc6\u5316\u641c\u7d22\u548c\u52a8\u6001\u89c4\u5212\u90e8\u5206\u4ee5\u8fbe\u5230\u6307\u6570\u7ea7\u590d\u6742\u5ea6\uff09\u3002\n\n#### \u5b50\u4efb\u52a1 2\n\n\u56e0\u4e3a\u989c\u8272\u6570\u6700\u591a\u4e3a $3$\uff0c\u6240\u4ee5\u8def\u5f84\u7684\u957f\u5ea6\u6700\u591a\u4e3a $3$\uff0c\u5373\u8def\u5f84\u7684\u957f\u5ea6\u4e3a $2$ \u6216 $3$\u3002\u957f\u5ea6\u4e3a $2$ \u7684\u8def\u5f84\u6761\u6570\u5bb9\u6613\u8ba1\u7b97\uff1a\u5373\u8d77\u70b9\u548c\u7ec8\u70b9\u989c\u8272\u4e0d\u540c\u7684\u8fb9\u7684\u6761\u6570\u3002\u957f\u5ea6\u4e3a $3$ \u7684\u8def\u5f84\u6761\u6570\u9700\u8981\u66f4\u591a\u7684\u601d\u8003\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u679a\u4e3e\u8def\u5f84\u4e2d\u95f4\u7684\u4e00\u4e2a\u70b9\u662f\u54ea\u4e00\u4e2a\u70b9\u4e0e\u8d77\u70b9\u7ec8\u70b9\u7684\u989c\u8272\u6765\u5904\u7406\u8fd9\u4e2a\u95ee\u9898\u3002\u90a3\u4e48\u4ee5\u8fd9\u4e2a\u70b9\u4e3a\u4e2d\u95f4\u8282\u70b9\u7684\u8def\u5f84\u6761\u6570\u5c31\u662f\u4e0e\u4e2d\u95f4\u70b9\u76f8\u8fde\u7684\u7b2c\u4e00\u4e2a\u989c\u8272\u7684\u70b9\u7684\u4e2a\u6570\u548c\u4e0e\u4e2d\u95f4\u70b9\u76f8\u8fde\u7684\u7b2c\u4e8c\u4e2a\u989c\u8272\u7684\u70b9\u7684\u4e2a\u6570\u7684\u4e58\u79ef\u3002\n\n#### \u5b50\u4efb\u52a1 3\n\n\u5b50\u4efb\u52a1 3 \u662f\u5bf9\u5b50\u4efb\u52a1 2 \u7684\u81ea\u7136\u5ef6\u4f38\u3002\u6211\u4eec\u4e0d\u679a\u4e3e\u4e2d\u95f4\u70b9\u662f\u4ec0\u4e48\uff0c\u800c\u662f\u679a\u4e3e\u4e2d\u95f4\u7684\u4e00\u6761**\u8fb9**\u662f\u4ec0\u4e48\uff0c\u5176\u4f59\u90e8\u5206\u4e0e\u5b50\u4efb\u52a1 2 \u5b8c\u5168\u4e00\u81f4\u3002\n\n#### \u5b50\u4efb\u52a1 4\n\n\u5047\u8bbe\u5b58\u5728\u4e00\u4e2a\u51fd\u6570 $f$ \u8868\u793a\u4ee5\u67d0\u4e2a\u70b9\u4e3a\u8d77\u70b9\u7684\u5408\u6cd5\u8def\u5f84\u6761\u6570\u3002\u90a3\u4e48\u7b54\u6848\u5c31\u662f\u5bf9\u6240\u6709\u70b9\u7684 $f$ \u51fd\u6570\u6c42\u548c\u3002\u5173\u952e\u5728\u4e8e\u56e0\u4e3a\u6570\u636e\u5f88\u5927\uff0c\u5982\u4f55\u9ad8\u6548\u5730\u8ba1\u7b97\u51fd\u6570 $f$ \u7684\u503c\u3002\n\n\u4ee4\u51fd\u6570 $f$ \u6709\u4e24\u4e2a\u53c2\u6570 $c$\uff08\u5f53\u524d\u70b9\uff09\u4e0e $C$ \uff08\u4e00\u4e2a\u8868\u793a\u76ee\u524d\u5df2\u7ecf\u7528\u8fc7\u7684\u989c\u8272\u7684 ``bitset``\uff0c\u521d\u59cb\u4e3a $0$\uff09\u3002\u7531\u4e8e\u4e00\u6761\u8def\u5f84\u4e0a\u7684\u989c\u8272\u4e2a\u6570\u6700\u591a\u4e3a $5$\uff0c\u6240\u4ee5\u8fd9\u6837\u7684 ``bitset`` \u6700\u591a\u6709 $2^5=32$ \u4e2a\u3002\u8fd9\u610f\u5473\u7740\u51fd\u6570 $f(c,\\,C)$ \u7684\u53c2\u6570\u7684\u7ec4\u5408\u6570\u5c0f\u5230\u6211\u4eec\u53ef\u4ee5\u6253\u8868\uff1a\u6211\u4eec\u4f7f\u7528\u52a8\u6001\u89c4\u5212\u7b97\u6cd5\u3002\n\n\u5bf9\u53c2\u6570 $c$ \u548c $C$ \u8fdb\u884c\u8bb0\u5fc6\u5316\u641c\u7d22\uff0c\u6211\u4eec\u9700\u8981\u5bf9\u6240\u6709\u76f8\u90bb $c$ \u548c $C$ \u5c06\u51fd\u6570 $f(c',\\,C')$ \u7684\u503c\u6c42\u548c\uff0c\u5176\u4e2d $C'$ \u4e3a\u4e0e $C$ \u76f8\u540c\u7684 ``bitset``\uff0c\u4f46\u662f\u8868\u793a\u989c\u8272 $c$ \u7684\u4e8c\u8fdb\u5236\u4f4d\u88ab\u6807\u8bb0\u4e86\u3002\u6211\u4eec\u4fdd\u8bc1\u4e0d\u91cd\u590d\u4f7f\u7528\u989c\u8272\uff0c\u5e76\u4e14\u4e0d\u4f1a\u91cd\u590d\u8ba1\u7b97\u4e4b\u524d\u8ba1\u7b97\u8fc7\u7b54\u6848\u7684\u72b6\u6001\u7684\u7b54\u6848\u3002\u5982\u6b64\u4ee5\u6765\uff0c\u95ee\u9898\u7684\u7b54\u6848\u5c31\u662f $\\sum f(i,\\, 0)$ \uff08\u9700\u8981\u4fdd\u8bc1\u4e0d\u8981\u8ba1\u7b97\u957f\u5ea6\u4e3a $1$ \u7684\u8def\u5f84\uff01\uff09\uff0c\u8fd8\u8981\u6ce8\u610f\u4f7f\u7528 $64$ \u4f4d\u6574\u6570\u3002\n\n\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal{O}(2^{K}N)$\u3002\n\n\u6709\u8da3\u7684\u4e00\u4e9b\u4e1c\u897f\uff1a\u8fd9\u4e2a\u95ee\u9898\u5b9e\u8d28\u4e0a\u662f\u5173\u4e8e\u7edf\u8ba1\u6700\u5927\u957f\u5ea6\u4e3a $k$ \u7684\u5404\u70b9\u989c\u8272\u4e0d\u76f8\u540c\u7684\u8def\u5f84\u6761\u6570\u3002\u8fd9\u4e2a\u95ee\u9898\u6bd4\u8ba1\u7b97\u957f\u5ea6\u6700\u5927\u4e3a $k!$ \u7684 **\u6240\u6709** \u8def\u5f84\u6761\u6570\u7b80\u5355\u3002\u540e\u8005\u66b4\u529b\u7b97\u6cd5\u7684\u590d\u6742\u5ea6\u4e3a $n^k$ \u800c\u4e0d\u662f $2^kn$\u3002\u8fd9\u79cd\u601d\u60f3\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u79cd\u901a\u7528\u7b97\u6cd5\u6280\u672f\u63d0\u9ad8\u591a\u79cd\u95ee\u9898\u7684\u6c42\u89e3\u901f\u5ea6\uff1a\u591a\u6b21\u968f\u673a\u9009\u62e9\u989c\u8272\uff08\u4e25\u683c\u7684\u8bf4\uff0c$O((\\log n)^k)$ \u6b21\uff09\uff0c\u7136\u540e\u4f7f\u7528\u4e00\u79cd\u9650\u5236\u5404\u70b9\u989c\u8272\u4e0d\u540c\u7684\u7b97\u6cd5\u3002\n",
        "postTime": 1534206770,
        "uid": 35485,
        "name": "Hatsune_Miku",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4796 \u3010[BalticOI 2018]\u8def\u5f84\u3011"
    },
    {
        "content": "\u672c\u9898\u7684\u6570\u636e\u8303\u56f4\u5df2\u7ecf\u5f88\u660e\u663e\u7684\u63d0\u793a\u4f7f\u7528\u72b6\u538bdp\u4e86\uff0c\u90a3\u4e48\u6211\u4eec\u4ece\u72b6\u538b\u65b9\u5411\u5165\u624b\n\n\u4ee4dp[u][00000]\u4e3a\uff0c\u8d70\u5230u\u70b9\uff0c\u5df2\u7ecf\u8d70\u4e86\u54ea\u4e9b\u989c\u8272\u7684\u65b9\u6848\u6570\n\n\u9884\u5904\u7406\u6b65\u9aa4\uff1a\u5c06dp[u][1<<(col[u]-1)]\u8bbe\u4e3a1\n\n\u6b64\u65f6\u6211\u4eec\u6709\u4e24\u79cd\u65b9\u6848\uff1a\n\n\u4e00\u79cd\u5148\u679a\u4e3e\u70b9\uff0c\u518d\u679a\u4e3e\u72b6\u6001\u8fdb\u884c\u8f6c\u79fb\n\n\u4e00\u79cd\u5148\u679a\u4e3e\u72b6\u6001\uff0c\u518d\u679a\u4e3e\u70b9\u8fdb\u884c\u8f6c\u79fb\n\n\u524d\u8005\u4f1a\u53d1\u73b0\uff0c\u67d0\u4e00\u72b6\u6001\u7684\u70b9\u53ef\u80fd\u4f1a\u56e0\u4e3a\u5176\u5b83\u70b9\u8fd8\u672a\u88ab\u904d\u5386\uff0c\u5bfc\u81f4\u65b9\u6848\u6570\u672a\u7edf\u8ba1\u5b8c\u5168\n\n\u6bd4\u5982\u904d\u5386\u5230\u70b9i\uff0c\u70b9i+1\u53ef\u4ee5\u8f6c\u79fb\u5230i\u70b9\uff0c\u4f46\u70b9i+1\u7684\u72b6\u6001\u8fd8\u6ca1\u5904\u7406\u51fa\u6765\uff0c\u5bfc\u81f4i+1\u7684\u65b9\u6848\u4e0d\u80fd\u7edf\u8ba1\u5230i\u70b9\u4e0a\n\n\u6240\u4ee5\u6211\u4eec\u4f7f\u7528\u540e\u8005\u8fdb\u884c\u72b6\u6001\u8f6c\u79fb\n\n\u72b6\u6001\u8f6c\u79fb\u7684\u4ee3\u7801\u5982\u4e0b\n\n```cpp\nfor(ll i=1;i<=S;i++)\n\t{\n\t\tll t=book[i];//t\u770b\u505a\u72b6\u6001\u5c31\u597d\u4e86\n\t\tfor(ll j=1;j<=n;j++)\n\t\t{\n\t\t\tif(dp[j][t])\n\t\t\t{\n\t\t\t\tif(check(t)>=2)ans+=dp[j][t];\n               \t\t\t//\u9009\u62e92\u4e2a\u70b9\u4ee5\u4e0a\u624d\u7edf\u8ba1\u8fdb\u7b54\u6848\n\t\t\t\tfor(ll k=head[j];k;k=next[k])\n\t\t\t\t{\n\t\t\t\t\tll v=to[k];\n\t\t\t\t\tif(t&(1<<(col[v]-1)))continue;\n\t\t\t\t\tdp[v][t|(1<<(col[v]-1))]+=dp[j][t];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n```\n\n\n\nAC code\n```cpp\n#include<cstdio>\n#include<algorithm>\n#define ll long long\n#define lowbit(i) i&(-i)\nusing namespace std;ll cnt=0;\nll head[300010],next[600010],to[600010];\nvoid add(ll u,ll v)\n{\n\tto[++cnt]=v;\n\tnext[cnt]=head[u];\n\thead[u]=cnt;\n}\nll n,m,k,S,col[300010],dp[300010][32];//\u8d70\u5230u\u70b9\uff0c\u5df2\u7ecf\u7ecf\u8fc7\u4e86\u67d0\u4e9b\u70b9 \nll check(ll x)\n{\n\tll cnt=0;\n\twhile(x)\n\t{\n\t\tx-=lowbit(x);\n\t\tcnt++;\n\t}\n\treturn cnt;\n}\nll book[300010];\nbool cmp(ll a,ll b)\n{\n\treturn check(a)<check(b);\n}\nsigned main()\n{\n\tscanf(\"%lld%lld%lld\",&n,&m,&k);\n\tfor(ll i=1;i<=n;i++)scanf(\"%lld\",&col[i]);\n\tS=(1<<k)-1;\n\tfor(ll i=1;i<=S;i++)book[i]=i;\n\tsort(book+1,book+S+1,cmp);\n\tfor(ll i=1;i<=m;i++)\n\t{\n\t\tll x,y;\n\t\tscanf(\"%lld%lld\",&x,&y);\n\t\tadd(x,y);\n\t\tadd(y,x);\n\t}\n\tfor(ll i=1;i<=n;i++)dp[i][(1<<(col[i]-1))]=1;\n\tll ans=0;\n\tfor(ll i=1;i<=S;i++)\n\t{\n\t\tll t=book[i];\n\t\tfor(ll j=1;j<=n;j++)\n\t\t{\n\t\t\tif(dp[j][t])\n\t\t\t{\n\t\t\t\tif(check(t)>=2)ans+=dp[j][t];\n\t\t\t\tfor(ll k=head[j];k;k=next[k])\n\t\t\t\t{\n\t\t\t\t\tll v=to[k];\n\t\t\t\t\tif(t&(1<<(col[v]-1)))continue;\n\t\t\t\t\tdp[v][t|(1<<(col[v]-1))]+=dp[j][t];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1568776537,
        "uid": 112850,
        "name": "GLZP",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4796 \u3010[BalticOI 2018]\u8def\u5f84\u3011"
    }
]
[
    {
        "content": "#### $Hyperlink$\nhttps://www.luogu.com.cn/problem/P3618\n***\n#### $Description$\n\u6709$T$\u7ec4\u6570\u636e\n\n\u6bcf\u7ec4\u6570\u636e\u7ed9\u5b9a\u4e24\u4e2a\u4e32$a,b$\n\n\u5bf9\u4e8e$a$\u7684\u6bcf\u4e00\u4e2a\u5b50\u4e32$S_a$\uff0c\u82e5$S_a=b$\uff0c\u5219\u53ef\u4ee5\u7528$*$\u66ff\u4ee3\n\n\u95ee\u4e00\u5171\u6709\u591a\u5c11\u79cd\u66ff\u4ee3\u65b9\u6cd5\uff08\u4e0d\u66ff\u4ee3\u4e5f\u7b97\u4e3a\u4e00\u79cd\uff09\n\n\u6570\u636e\u8303\u56f4\uff1a$n\\leq 10^5$\n***\n#### $Solution$\n~~KMP\u5b83\u80fd\u4e0d\u9999\u5417\uff1f~~\n\n\u9996\u5148\u5bf9\u4e8e$a,b$\u4e24\u4e32\uff0c\u6c42\u51fa$b$\u4e32\u5728$a$\u4e32\u4e2d\u7684\u6240\u6709\u5339\u914d\u4f4d\u7f6e\n\n\u521a\u5f00\u59cb\u662f\u60f3\u7740\u7528\u7ec4\u5408\u8ba1\u6570\u7684\u65b9\u6cd5\u7b97\u65b9\u6848\u6570\u3002\u3002\u3002\uff08\u6bd5\u7adf\u770b\u5230\u4e86\u6a21\u6570\uff09\n\n\u7136\u540e~~\u770b\u4e86\u9898\u89e3~~\u53d1\u73b0\u53ef\u4ee5\u7528$dp$\n\n\u5957\u4e0a\u53bb\u5c31\u5207\u4e86\u3002\u3002\u3002\n\n\u8bbe$f[i]$\u8868\u793a\u505a\u5230$i$\u7684\u65b9\u6848\u6570\n\n\u521d\u59cb\u72b6\u6001\uff1a$f[0]=1$\n\n\n\u5982\u679c$i-m+1$\u662f\u4e00\u4e2a\u53ef\u4ee5\u5339\u914d\u7684\u4f4d\u7f6e\uff0c\u5219$f[i]=f[i-1]+f[i-m]$\n\n\u5426\u5219$f[i]=f[i-1]$\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(T(n+m))$\n***\n#### $Code$\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#define N 100010\n#define mod 1000000007\nusing namespace std;char a[N],b[N];\nint n,m,next[N],j,t,nt;\nlong long f[N];\nbool v[N];\nint main()\n{\n\tscanf(\"%d\",&t);\n\twhile(t--)\n\t{\t\n\t    scanf(\"%s%s\",a+1,b+1);\n\t    n=strlen(a+1);m=strlen(b+1);\n\t    memset(next,0,sizeof(next));\n\t    memset(v,0,sizeof(v));\n\t    memset(f,0,sizeof(f));\n\t    j=0;\n\t\tfor(register int i=2;i<=m;i++)\n\t\t{\n\t\t\twhile(j&&b[j+1]!=b[i]) j=next[j];\n\t\t\tif(b[j+1]==b[i]) j++;\n\t\t\tnext[i]=j;\n\t\t}\n\t\tj=0;\n\t\tfor(register int i=1;i<=n;i++)\n\t\t{\n\t\t\twhile(j&&b[j+1]!=a[i]) j=next[j];\n\t\t\tif(b[j+1]==a[i]) j++;\n\t\t\tif(j==m) v[i-m+1]=true;\n\t\t}\n\t    f[0]=1;\n\t    for(register int i=1;i<=n;i++)\n\t    {\n\t    \tif(v[i-m+1]&&i>=m) (f[i]=f[i-m]+f[i-1])%=mod;\n\t    \telse (f[i]=f[i-1])%=mod;\n\t    }\n\t    printf(\"Case #%d: %lld\\n\",++nt,f[n]);\n\t}\n}\n```",
        "postTime": 1575632293,
        "uid": 52915,
        "name": "Ajwallet",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3618 \u3010\u8bef\u4f1a\u3011"
    },
    {
        "content": "\u9898\u610f\u6666\u6da9\u96be\u61c2\uff0c\u4f46\u662f\u6837\u4f8b\u89e3\u91ca\u5341\u5206\u5e73\u6613\u8fd1\u4eba\u3002\n## \u5206\u6790\n\u4e32\u5339\u914d\u95ee\u9898\uff0c\u4f7f\u7528 KMP \u627e\u5230\u6240\u6709\u5339\u914d\u7684\u4f4d\u7f6e\u3002\u7136\u540e\u5c31\u8f6c\u6362\u4e3a\u4e86\u4e00\u4e2a\u8ba1\u6570\u95ee\u9898\u3002\n\n\u76f4\u63a5\u7ec4\u5408\u8ba1\u6570\u663e\u7136\u4e0d\u592a\u884c\uff0cDP \u4e00\u4e0b\u3002\u8bbe $f_i$ \u8868\u793a\u5230\u7b2c $i$ \u4e2a\u5339\u914d\u4f4d\u7f6e\uff0c\u94a6\u5b9a\u7b2c $i$ \u4e2a\u5339\u914d\u4f4d\u7f6e\u66ff\u6362\u6210`*`\u7684\u65b9\u6848\u6570\u3002\u6734\u7d20\u7684\u8f6c\u79fb\u53ef\u4ee5\u679a\u4e3e\u4e0a\u4e00\u6b21\u66ff\u6362\u7684\u4f4d\u7f6e\uff0c\u8f6c\u79fb\u5373\u53ef\u3002\u6ce8\u610f\u66ff\u6362\u4f4d\u7f6e\u4e0d\u80fd\u91cd\u53e0\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2)$\u3002\n\n\u663e\u7136\u8981\u4f18\u5316\uff0c\u53c8\u53d1\u73b0\u53ef\u4ee5\u524d\u7f00\u548c\uff0c\u524d\u7f00\u548c\u5373\u53ef\u3002\n\n~~\u5efa\u8bae\u964d\u7eff~~\n\n## \u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<string>\n#define mod 1000000007\n#define int long long\nusing namespace std;\nstring s,t;\nint T,nxt[100001],len,ap[100001],f[100001],sum[100001],ans;\nsigned main()\n{\n\tscanf(\"%lld\",&T);\n\tfor(int _=1;_<=T;_++)\n\t{\n\t\tcin>>t>>s;\n\t\tlen=0;\n\t\tint jumper=0;\n\t\tfor(int i=1;i<s.size();i++)\n\t\t{\n\t\t\tint jumper=nxt[i-1];\n\t\t\twhile(jumper&&s[jumper]!=s[i])\n\t\t\t{\n\t\t\t\tjumper=nxt[jumper-1];\n\t\t\t}\n\t\t\tnxt[i]=jumper;\n\t\t\tif(s[i]==s[jumper])\n\t\t\t{\n\t\t\t\tnxt[i]++;\n\t\t\t\tjumper++;\n\t\t\t}\n\t\t}\n\t\tjumper=0;\n\t\tfor(int i=0;i<t.size();i++)\n\t\t{\n\t\t\twhile(jumper&&s[jumper]!=t[i])\n\t\t\t{\n\t\t\t\tjumper=nxt[jumper-1];\n\t\t\t}\n\t\t\tif(t[i]==s[jumper])\n\t\t\t{\n\t\t\t\tjumper++;\n\t\t\t}\n\t\t\tif(jumper==s.size())\n\t\t\t{\n\t\t\t\tap[++len]=i-s.size()+2; //\u8bb0\u5f55\u53ef\u66ff\u6362\u4f4d\u7f6e\n\t\t\t\tjumper=nxt[jumper-1];\n\t\t\t}\n\t\t}\n\t\tap[0]=0;\n\t\tsum[0]=1;\n\t\tans=0;\n\t\tint zz=1;\n\t\tfor(int i=1;i<=t.size();i++)\n\t\t{\n\t\t\tsum[i]=0;\n\t\t\tif(zz<=len&&ap[zz]==i) //\u53ef\u4ee5\u66ff\u6362\n\t\t\t{\n\t\t\t\tf[zz]=sum[max(ap[zz]-s.size(),0ll)]; //\u524d\u7f00\u548c\u8f6c\u79fb\n\t\t\t\tsum[i]=f[zz]; //\u524d\u7f00\u548c\u66f4\u65b0\n\t\t\t\tans+=f[zz]; //\u7b54\u6848\u7d2f\u52a0\n\t\t\t\tzz++;\n\t\t\t\tans%=mod;\n\t\t\t}\n\t\t\tsum[i]+=sum[i-1]; //\u524d\u7f00\u548c\n\t\t\tsum[i]%=mod;\n\t\t}\n\t\tcout<<\"Case #\"<<_<<\": \"<<(ans+1)%mod<<endl;\n\t}\n}\n```\n",
        "postTime": 1676534466,
        "uid": 477954,
        "name": "lizhous",
        "ccfLevel": 0,
        "title": "P3618 \u8bef\u4f1a \u9898\u89e3"
    },
    {
        "content": "### \u9898\u610f\u7b80\u8ff0\n\u6709 $T$ \u7ec4\u6570\u636e\u3002\n\n\u6bcf\u7ec4\u6570\u636e\u7ed9\u5b9a\u4e00\u4e2a\u6587\u672c\u4e32 $a$\uff0c\u4e00\u4e2a\u6a21\u5f0f\u4e32 $b$\uff0c\n\n\u4f60\u53ef\u4ee5\u9009\u62e9\u7528 `*` \u6765\u66ff\u6362 $a$ \u91cc\u9762\u51fa\u73b0\u8fc7\u7684 $b$\u3002\n\n\u95ee\u4e00\u5171\u6709\u591a\u5c11\u79cd\u66ff\u4ee3\u65b9\u6cd5\uff08\u4e0d\u66ff\u4ee3\u4e5f\u7b97\u4e3a\u4e00\u79cd\uff09\u3002\n\n**\u6ce8\u610f**\uff1a\u5982\u679c\u51fa\u73b0\u591a\u4e2a $b$ \u91cd\u53e0\u4e86\uff0c\u53ea\u80fd\u66ff\u6362\u6389\u5176\u4e2d\u7684\u4e00\u4e2a\u3002\n\n------------\n\n### \u5206\u6790\n\u770b\u5230\u6a21\u5f0f\u4e32\u5339\u914d\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u60f3\u5230 ~~AC\u81ea\u52a8\u673a~~ **KMP**\uff0c\u901a\u8fc7\u5b83\u6765\u6c42\u51fa\u6240\u6709 $b$ \u5728 $a$ \u4e2d\u51fa\u73b0\u7684\u4f4d\u7f6e\u3002\n\n\u770b\u5230\u7edf\u8ba1\u65b9\u6848\u6570\uff0c\u6211\u4eec\u5c31\u60f3\u5230 DP\u3002\n\n\u5982\u679c\u60a8\u4e0d\u4f1a KMP\uff0c\u8bf7\u79fb\u6b65[P3375 \u3010\u6a21\u677f\u3011KMP\u5b57\u7b26\u4e32\u5339\u914d](https://www.luogu.com.cn/problem/P3375)\uff0c\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u3002\n\n\u8bbe\u8fd9\u4e24\u4e2a\u4e32\u7684\u957f\u5ea6\u4e3a $len_a,len_b$\u3002\n\n\u9996\u5148\u628a\u677f\u5b50\u5957\u4e0a\u53bb\uff0c\u5f97\u5230\u6240\u6709 $b$ \u5728 $a$ \u4e2d\u51fa\u73b0\u7684\u4f4d\u7f6e\u3002\n\n\u63a5\u4e0b\u6765\u5f00\u59cb DP\uff1a\n\n\u8bbe $f[x]$ \u8868\u793a DP \u5230\u7b2c $i$ \u4f4d\u7684\u65f6\u5019\u5408\u6cd5\u7684\u65b9\u6848\u6570\uff0c\u4e5f\u5c31\u662f\u5230\u5f53\u524d\u4e3a\u6b62\u53ef\u4ee5\u6784\u9020\u51fa\u6765\u7684\u4e0d\u540c\u7684\u5b57\u7b26\u4e32\u6570\u3002\n\n\u56e0\u4e3a\u4e0d\u66ff\u4ee3\u4e5f\u7b97\u4e3a\u4e00\u79cd\uff0c\u6240\u4ee5\u6211\u4eec\u8bbe$f[0]=1$\u3002\n\n\u9996\u5148\u5ef6\u7eed\u4e0a\u4e00\u4f4d\u7684\u89e3\uff0c\u8fd9\u4e00\u4f4d\u4e0d\u505a\u4efb\u4f55\u64cd\u4f5c\uff1a$f[i]=f[i-1]$\u3002\n\n\u5047\u5982\u8fd9\u4e00\u4f4d\u5339\u914d\u4e0a\u4e86\uff0c\u5c31\u8bf4\u660e\u5f53\u524d\u8fd9\u4e2a\u4f4d\u7f6e\u5b58\u5728\u4e00\u4e2a\u540e\u7f00\u4e3a $b$\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u6362\u6210`*`\u3002\u5f88\u663e\u7136\uff0c\u66ff\u6362\u540e\u7684\u4e32\u6709 $f[i-len_b]$ \u79cd\u4e0d\u540c\u7684\u65b9\u6848\uff0c\u6211\u4eec\u518d\u7ed9\u7b54\u6848\u52a0\u4e0a\u8fd9\u4e2a\u6570\uff1a$f[i]=f[i]+f[i-len_b]$\u3002\n\n\u6700\u540e\uff0c\u7b54\u6848\u5c31\u662f $f[len_a]$\u3002**\u6ce8\u610f\u6a21\u6570\u3002**\n\n\n\n### Code\uff1a\n\uff08\u6211\u7684 KMP \u91c7\u7528\u7684\u662f OI-wiki \u7684\u5b9e\u73b0\u65b9\u5f0f\uff0c\u5373\u6a21\u5f0f\u4e32+\u5206\u9694\u7b26+\u6587\u672c\u4e32\uff0c\u7136\u540e\u6c42\u4e00\u904d\u524d\u7f00\u51fd\u6570\uff09\n```\n#include<bits/stdc++.h>\n#define nmaespace namespace\n#define itn int\n#define viod void\n#define fro for\n#define mian main\n#define retrun return \n#define whiel while//\u9632\u624b\u6b8b\u706b\u8f66\u5934\n//#pragma warning(disable:4996)\nnamespace CCCP\n{\n\tusing std::vector;\n\tconst int mod = 1000000007;\n\tchar a[100005], b[200005];\n\tint f[100005];\n\tvector<int>Prefix_function(char *s)\n\t{\n\t\tint n = strlen(s);\n\t\tvector<int>pi(n);\n\t\tfor (int i = 1;i < n;i++)\n\t\t{\n\t\t\tint j = pi[i - 1];\n\t\t\twhile (j != 0 && s[i] != s[j])j = pi[j - 1];\n\t\t\tif (s[i] == s[j])j++;\n\t\t\tpi[i] = j;\n\t\t}\n\t\treturn pi;\n\t}\n\n\tvoid work(int t)\n\t{\n\t\tscanf(\"%s%s\", a, b);\n\t\tint lena = strlen(a), lenb = strlen(b);\n\t\tstrcat(strcat(b, \"#\"), a);\n\t\tvector<int>pi = Prefix_function(b);\n\t\tf[0] = 1;\n\t\tfor (int k= lenb + 1;k < lena + lenb + 1;k++)\n\t\t{\n\t\t\tint i = k - lenb;\n\t\t\tf[i] = f[i - 1];\n\t\t\tif (pi[k] == lenb)f[i] += f[i - lenb];\n\t\t\tf[i] %= mod;\n\t\t}\n\t\tprintf(\"Case #%d: %d\\n\", t, f[lena]);\n\t}\n}\n\nint main()\n{\n\tint t;\n\tstd::cin >> t;\n\tfor(int i=1;i<=t;i++)\n\t{\n\t\tCCCP::work(i);\n\t}\n\treturn 0;\n}\n```\n\n\u636e\u8bf4\u8fd9\u9053\u9898\u6b63\u89e3\u662f\u54c8\u5e0c+DP\uff1f",
        "postTime": 1622188396,
        "uid": 400781,
        "name": "Troubadour",
        "ccfLevel": 0,
        "title": "P3618 \u8bef\u4f1a \u9898\u89e3"
    },
    {
        "content": "## \u89e3\u9898\u601d\u8def\n\n$\\mathtt{dp+hash}$\n\n### \u5206\u6790\n\n\u6b63\u89e3\u4e0d\u662f\u5f88\u662f\u96be\u60f3\uff0c\u7531\u4e8e\u662f\u8ba1\u6570\u7c7b\u95ee\u9898\uff0c\u5e94\u8be5\u5c31\u60f3\u5230 $Dp$\uff0c\u53c8\u7531\u4e8e\u5b57\u7b26\u4e32\uff0c\u5373\u53ef\u7528\u5b57\u7b26\u4e32 $hash$ \u89e3\u51b3\n\n\u8bb0\u539f\u53e5\u4e3a $A$ \u4e32\uff0c\u957f\u5ea6\u4e3a $la$\uff1b\u542c\u5230\u7684\u8bdd\u4e3a $B$ \u4e32\uff0c\u957f\u5ea6\u4e3a $lb$\n\n\u8003\u8651\u600e\u4e48\u8f6c\u79fb\uff0c\u5206\u60c5\u51b5\u8ba8\u8bba\uff1a\n\n \u00b7 \u5982\u679c\u5728 $A$ \u4e32\u4f4d\u7f6e $i$ \u80fd\u5339\u914d\u4e0a $B$ \u4e32\uff0c\u663e\u7136\uff0c**\u66ff\u6362**\u662f\u4e00\u79cd\uff0c**\u4e0d\u66ff\u6362**\u4e5f\u662f\u4e00\u79cd\u9009\u62e9\uff0c\u76f4\u63a5\u76f8\u52a0 $\\to$ `f[i]=f[i-lb]+f[i-1]`\n\n \u00b7 \u53cd\u4e4b\uff0c\u4e0d\u80fd\u5339\u914d\uff0c\u6b64\u65f6\u53ea\u6709\u4e0d\u66ff\u6362\u4e00\u79cd\u9009\u62e9\uff0c\u76f4\u63a5\u8f6c\u79fb $\\to$ `f[i]=f[i-1]`\n\n\u5bf9\u4e8e $hash$\uff0c\u4f7f\u7528 $unsigned\\ long\\ long$  \u7684\u81ea\u7136\u6ea2\u51fa\u5373\u53ef\uff0c\uff08\u9ed8\u8ba4\u5b57\u7b26\u4e32 $hash$ \u90fd\u4f1a\n\n### Warning\n\n$f_{0-lb}$ \u90fd\u5e94\u521d\u59cb\u4e3a $1$\n\n## Code\n\n```cpp\n#include<bits/stdc++.h>\n#define rgt register\n#define rint rgt int\n#define LL long long\n#define rll rgt LL\n#define inf 0x7f7f7f7f\n#define ull unsigned LL\n#define N 100003\nusing namespace std;\nconst int base=1000000007;\ntemplate<class K>inline bool cmax(K&a,const K&b){return (a<b)?a=b,1:0;}\ntemplate<class K>inline bool cmin(K&a,const K&b){return (a>b)?a=b,1:0;}\ninline int read() {\n\trint s=0;\n\trgt char c=getchar();\n\twhile(!isdigit(c)) c=getchar();\n\twhile(isdigit(c)) s=(s<<1)+(s<<3)+c-'0',c=getchar();\n\treturn s;\n}\nint n,m,la,lb,t,f[N];\null s[N],sum,bit[N];\nchar a[N],b[N];\ninline int dec(rint x){return(x>=base)?x-base:x;}\nint main()\n{\n\trint i,k;m=read(),bit[0]=1,t=f[0]=1;\n\tfor(k=1;k<=m;k++) {\n\t\tscanf(\"%s%s\",a+1,b+1),la=strlen(a+1),lb=strlen(b+1),sum=0;\n\t\tfor(i=1;i<=la;i++) s[i]=s[i-1]*base+a[i]-'0';//\u5f97\u5230A\u4e32\u7684\u524d\u7f00hash\n\t\twhile(t<=lb) bit[t]=bit[t-1]*base,++t;//base^t\n\t\tfor(i=1;i<=lb;i++) sum=sum*base+b[i]-'0',f[i]=1;//\u8ba1\u7b97B\u4e32\u7684hash\u503c&\u521d\u59cb\u5316\n\t\tfor(i=lb;i<=la;i++) {\n\t\t\tif(sum==s[i]-s[i-lb]*bit[lb]) f[i]=f[i-lb];//\u53ef\u4ee5\u66ff\u6362\n\t\t\telse f[i]=0;f[i]=dec(f[i]+f[i-1]);\n\t\t}\n\t\tprintf(\"Case #%d: %d\\n\",k,f[la]);\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1572588267,
        "uid": 83564,
        "name": "hovny",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3618 \u3010\u8bef\u4f1a\u3011"
    },
    {
        "content": "\u9898\u610f\uff1a\n\n\u672c\u9898\u7ed9\u4e86\u4e24\u4e2a\u5b57\u7b26\u4e32 $a$ \u548c $b$\uff0c\u5982\u679c $a$ \u7684\u4e00\u4e2a\u5b57\u4e32\u4e3a $b$\uff0c\u5219\u53ef\u4ee5\u66ff\u6362\u6389\uff0c\u8bf7\u95ee\u603b\u5171\u6709\u591a\u5c11\u79cd\u66ff\u6362\u65b9\u5f0f\uff08\u4e0d\u66ff\u6362\u4e5f\u7b97\u4e00\u79cd\uff09\u3002\n\n\u9996\u5148\uff0c\u672c\u9898\u8981\u6c42\u5224\u65ad\u4e00\u4e2a\u5b57\u7b26\u4e32\u662f\u5426\u4e3a\u53e6\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u5b57\u4e32\uff0c\u53ef\u4ee5\u7528 **\u5b57\u7b26\u4e32\u54c8\u5e0c** \u505a\u3002\n\n\uff08\u6211\u7528\u7684\u662f unsigned long long \u7684\u81ea\u7136\u6ea2\u51fa\uff0c\u6240\u4ee5\u54c8\u5e0c\u6570\u7ec4\u6ca1\u6709\u53d6\u6a21\u3002\uff09\n\n\u7136\u540e\uff0c\u8003\u8651\u5982\u4f55\u6c42\u89e3\u3002\u8ba1\u6570\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u53bb\u5f80 dp \u7684\u65b9\u5411\u53bb\u601d\u8003\u3002\n\n\u8bbe\u8ba1\u72b6\u6001\uff1a\n\n\u4ee4 $dp_i$ \u8868\u793a\u4ee5 $i$ \u4e3a\u7ed3\u5c3e\u7684\u66ff\u6362\u65b9\u5f0f\u79cd\u6570\u3002\n\n\u5219\u7b54\u6848\u4e3a $dp_n$\u3002\n\n\u8fb9\u754c\uff1a\n\n\u7531\u4e8e $0$ \u5230 $m-1$ \u4e0d\u53ef\u80fd\u6709\u66ff\u6362\u65b9\u5f0f\uff0c\u6240\u4ee5\u5b83\u4eec\u53ea\u80fd\u4e0d\u66ff\u6362\u3002\n\n\u6240\u4ee5\uff0c\u5bf9\u4e8e $i \u2208 [0,m-1]$\uff0c$dp_i = 0$\u3002\n\n\u8f6c\u79fb\u8fc7\u7a0b\uff1a\n\n\u5bf9\u4e8e\u7b2c $i$ \u4e2a\u5b57\u7b26\uff0c\u5982\u679c $i-m+1$ \u5230 $i$ \u8fd9\u4e00\u5b57\u4e32\u53ef\u4ee5\u88ab\u66ff\u6362\uff0c\u5219 $dp_i$ \u53ef\u4ee5\u4ece $dp_{i-m}$ \u53bb\u8f6c\u79fb\uff0c\u540c\u65f6\u4e5f\u53ef\u4ee5\u4e0d\u66ff\u6362\uff0c\u5219\u4ece $dp_{i-1}$ \u53bb\u8f6c\u79fb\u3002\n\n\u591a\u6b21\u6d4b\u8bd5\uff0c\u8bb0\u5f97\u6e05\u7a7a\u6570\u7ec4\u3002\n\ncode\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int unsigned long long\n\nconst int p=1e9+7;\nconst int maxn=1e5+10;\nint base[maxn];\nchar a[maxn],b[maxn];\nint h1[maxn],h2[maxn];\nint dp[maxn];\n\nint get(int op,int l,int r){\n\tif (op==1) return h1[r]-h1[l-1]*base[r-l+1];\n\telse return h2[r]-h2[l-1]*base[r-l+1];\n}\n\nsigned main(){\n\tint t;\n\tscanf(\"%llu\",&t);\n\t\n\tbase[0]=1llu;\n\tfor (int i=1;i<=100000;i++) base[i]=base[i-1]*p;\n\t\n\tfor (int ca=1;ca<=t;ca++){\n\t\tscanf(\"%s\",a+1);\n\t\tscanf(\"%s\",b+1);\n\t\t\n\t\tint n=strlen(a+1),m=strlen(b+1);\n\t\tmemset(h1,0,sizeof(h1)),memset(h2,0,sizeof(h2));\n\t\t\n\t\tfor (int i=1;i<=n;i++) h1[i]=h1[i-1]*p+a[i];\n\t\tfor (int i=1;i<=m;i++) h2[i]=h2[i-1]*p+b[i];\n\t\t\n\t\tmemset(dp,0,sizeof(dp));\n\t\tfor (int i=0;i<m;i++) dp[i]=1llu;\n\t\t\n\t\tfor (int i=m;i<=n;i++){\n\t\t\tif (get(1,i-m+1,i)==get(2,1,m)) dp[i]=(dp[i-1]+dp[i-m])%p;\n\t\t\telse dp[i]=dp[i-1]%p;\n\t\t}\n\t\t\n\t\tprintf(\"Case #%llu: %llu\\n\",ca,dp[n]);\n\t}\n\t\n\treturn 0;\n}\n```\n",
        "postTime": 1682676652,
        "uid": 546301,
        "name": "past_tense",
        "ccfLevel": 0,
        "title": "P3618 \u9898\u89e3"
    },
    {
        "content": "### \u5199\u5728\u524d\u9762\u7684\u5e9f\u8bdd\n\n\u8fd9\u771f\u7684\u662f\u4e00\u9053\u597d\u9898\uff0c\u5c06\u5b57\u7b26\u4e32\u548c $dp$ \u5de7\u5999\u878d\u5408\uff0c\u771f\u7684\u597d\u3002\n\n\n### \u6b63\u9898\n\n\u8bbe $f[i]$ \u4e3a\u539f\u4e32\u524d $i$ \u4f4d\u7684\u65b9\u6848\u6570\n\n\u9996\u5148\u4e0d\u66ff\u6362\uff0c\u5c31\u6709 $f[i]=f[i-1]$,\n\n\u7136\u540e\u518d\u8003\u8651\u66ff\u6362\u7684\u60c5\u51b5\uff0c\u8bbe\u66ff\u6362\u4e32\u957f\u5ea6\u4e3a$m$,\u5219\u5982\u679c$s[i-m+1 \\dots i]$ \u548c\u66ff\u6362\u4e32\u76f8\u7b49 ($s$ \u4e3a\u539f\u4e32)\uff0c\u90a3\u4e48$s[1\\dots i-m]+* $($+$ \u4e3a\u5b57\u7b26\u4e32\u62fc\u63a5)\u4e3a\u4e00\u79cd\u60c5\u51b5\uff0c\u5b83\u5bf9$f[i]$ \u7684\u8d21\u732e\u4e3a$f[i-m]$\n\n\u6240\u4ee5 $f[i]=f[i-1]$,\u5f53$s[i-m+1 \\dots i]$ \u548c\u66ff\u6362\u4e32\u76f8\u7b49\u65f6\uff0c\u518d\u52a0\u4e0a$f[i-w]$\n\n\u5b50\u4e32\u76f8\u7b49\u53ef\u4ee5\u7528 $hash$ \u5224\u65ad\n\n```cpp\n#include<bits/stdc++.h>\n#define int unsigned int   //\u8fd9\u91cc\u5229\u7528unsigned int \u81ea\u7136\u6ea2\u51fa\nusing namespace std;\nconst int Len=1e5+5,mod=1e9+7;\nchar sa[Len],sb[Len];\nint f[Len];\nint h[Len],p[Len],hb;\nconst int b=31;\ninline int hash(int l,int r) //\u83b7\u53d6[l,r]\u7684hash\u503c\n{\n\treturn h[r]-h[l-1]*p[r-l+1];\n}\nint t,cnt=0;\nsigned main()  //\u56e0\u4e3a\u5c06int \u6362\u4e3a\u4e86unsigned int ,\u4e3b\u51fd\u6570\u7684\u5199\u6cd5\u4e5f\u8981\u6362\n{\n\tscanf(\"%d\",&t);\n\tp[0]=1;\n\tfor(int i=1;i<Len;i++)\n\tp[i]=p[i-1]*b;\n\twhile(t--)\n\t{\n\t\tscanf(\"%s%s\",sa+1,sb+1);\n\t\tint n=strlen(sa+1),m=strlen(sb+1);  \n\t\tcnt++;\n\t\tmemset(f,0,sizeof f);\n\t\tmemset(h,0,sizeof h);   //\u8bb0\u5f97\u521d\u59cb\u5316\n\t\thb=0;\n\t\tfor(int i=1;i<=m;i++)\n\t\thb=hb*b+sb[i];  //\u66ff\u6362\u4e32hash\u503c\n\t\tfor(int i=1;i<=n;i++) h[i]=h[i-1]*b+sa[i];\n\t\t\n\t\tf[0]=1;  //\u6ce8\u610f\uff01\uff01\uff01\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tf[i]=f[i-1]%mod;\n\t\t\tif(i>=m&&hash(i-m+1,i)==hb) //\u8bb0\u5f97\u5224\u65adi>=m,\u5426\u5219\u4f1aRE\n\n\t\t\tf[i]+=f[i-m];\n\t\t\tf[i]%=mod;\n\t\t}\n\t\tprintf(\"Case #%u: %u\\n\",cnt,f[n]);  //\u8f93\u51faunsigned \u7c7b\u578b\u6570\u7528%u\n\t}\n}\n```\n\n",
        "postTime": 1604582149,
        "uid": 226435,
        "name": "\u5929\u547d\u4e4b\u8def",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3618 \u3010\u8bef\u4f1a\u3011"
    },
    {
        "content": "$dp+hash$\n\n\n\u8bbe\u5b50\u4e32\u957f\u5ea6\u4e3a$m$\uff0c$f_{i}$\u8868\u793a\u5230\u5b50\u4e32\u672b\u5c3e\u5728\u539f\u53e5\u662f\u7b2c$i$\u4e2a\u4f4d\u7f6e\u6709\u51e0\u79cd\u65b9\u6848\uff0c\u663e\u7136\u5bf9\u4e8e\u6bcf\u4e2a$f_{i}$\u6709\u4e09\u79cd\u60c5\u51b5\uff0c\u5f53\u539f\u53e5\u4ee5$i$\u7ed3\u5c3e\u7684\u957f\u5ea6\u4e3a$m$\u7684\u5b57\u7b26\u4e32\u7b49\u4e8e\u5b50\u4e32$f_{i}=f_{i-1}+f_{i-m}$,\u5373\u9009\u6216\u4e0d\u9009\uff0c\u5426\u5219$f_{i}=f_{i-1}$,\u53ea\u80fd\u4e0d\u9009\uff1b\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\n#define ull unsigned long long\nusing namespace std;\nconst int p=313;\nint v=1,T,n,m,a[2000000];\null power[2000000],sum[2000000],f[200000],t;\nchar s1[200000],s2[200000];\nint main(){\n    scanf(\"%d\",&T);\n    power[0]=1;\n    for (int i=1;i<=100001;i++) power[i]=power[i-1]*p;\n    while (v<=T){\n        scanf(\"%s\\n%s\",s1+1,s2+1);\n        memset(f,0,sizeof(f));\n        n=strlen(s1+1);m=strlen(s2+1);t=0;\n        for (int i=1;i<=n;i++) \n            sum[i]=sum[i-1]*p+s1[i]-96;\n        for (int i=1;i<=m;i++)\n            t=t*p+s2[i]-96;\n        f[0]=1;\n        for (int i=1;i<=n;i++)\n            if (t==sum[i]-sum[i-m]*power[m])\n                f[i]=(f[i-1]+f[i-m])%1000000007;\n            else f[i]=f[i-1];\n        printf(\"Case #%d: %d\\n\",v,f[n]);\n        v++;\n    }\n}\n```",
        "postTime": 1548081517,
        "uid": 54260,
        "name": "tcchyc",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3618 \u3010\u8bef\u4f1a\u3011"
    },
    {
        "content": "### \u7b2c\u4e00\u7bc7Pascal\u9898\u89e3\uff1f\n\n---\n\n\u9996\u5148\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u9053\u9898\u53ef\u4ee5\u7528$dp$\u7684\u65b9\u6cd5\u6765\u505a\u3002\n\n\u5982\u679c$s2=copy(s1,i-len(s2)+1,len(s2))$\n\n\u90a3\u4e48\uff1a$f[i]=f[i-1]+f[i-len(s2)]$\n\n\u5426\u5219\uff1a$f[i]=f[i-1]$\n\n\u53e6\u5916\uff1a$f[0]=1$\n\n\u6211\u4eec\u7528$hash$\u6765\u9884\u5904\u7406$copy$\u51fd\u6570\u7684\u7ed3\u679c\u5c31\u53ef\u4ee5\u4e86\u3002\u4e0d\u4f1a$hash$\u7684\u8bf7\u5de6\u8f6c\u3002\n\n\u8fd9\u9053\u9898\u4e0d\u5361$hash$\uff0c\u6240\u4ee5\u628a$hash$\u6a21\u6570\u4e5f\u8c03\u6210$10^9+7$\u5c31\u884c\u4e86\u3002\n\n```\nconst p=163;//\u76f8\u5f53\u4e8ebase\u503c\n      q=1000000007;//\u6a21\u6570\n      size=100005;\nvar hash,f,a:array[0..size] of int64;\n    s1,s2:ansistring;\n    i,j,k,t:longint;\n    sum:int64;\n    flag:array[0..size] of boolean;\nfunction gethash(l,r:longint):int64;\nbegin\n  exit((hash[r]-(hash[l-1]*a[r-l+1]) mod q+q)mod q);//\u6c42(l,r)\u533a\u95f4\u7684hash\u503c\uff0c\u76f8\u5f53\u4e8ecopy(s,l,r-l+1) \nend;\nbegin\n  a[0]:=1;\n  for i:=1 to size-5 do a[i]:=(a[i-1]*p) mod q;//\u9884\u5904\u7406p^i\n  readln(t);\n  for k:=1 to t do\n  begin\n    readln(s1);\n    readln(s2);\n    fillchar(flag,sizeof(flag),0);\n    sum:=0;\n    for i:=1 to length(s1) do hash[i]:=(hash[i-1]*p+ord(s1[i])-ord('a')+1) mod q;//\u4e3a\u4e86\u5faa\u73afhash\uff0c\u6240\u4ee5\u5148\u9884\u5904\u7406\u51fa(1,i)\u7684hash\u503c\n    for i:=1 to length(s2) do sum:=(sum*p+ord(s2[i])-ord('a')+1) mod q;//\u6c42\u51fa\u6574\u4e2as2\u7684hash\u503c\n    for i:=length(s2) to length(s1) do\n    begin\n      if gethash(i-length(s2)+1,i)=sum then\n        flag[i]:=true;//\u5982\u679c\u6ee1\u8db3s2=copy(s1,i-len(s2)+1,len(s2))\n    end;\n    f[0]:=1;//dp\u521d\u59cb\u5316\n    for i:=1 to length(s1) do\n    begin\n      f[i]:=f[i-1];\n      if flag[i] then\n        f[i]:=(f[i]+f[i-length(s2)]) mod q;//dp\u8f6c\u79fb\u65b9\u7a0b\n    end;\n    writeln('Case #',k,': ',f[length(s1)]);//\u8f93\u51fa\n  end;\nend.\n```\n\n\u7531\u4e8e$pascal$\u4e0d\u80fd\u81ea\u7136\u6ea2\u51fa\uff0c\u6240\u4ee5\u53ea\u80fd\u5199\u6210\u8fd9\u6837\u5e26\u6a21\u6570\u7684\u4e86\uff0c\u671b\u901a\u8fc7$+$\u6307\u6b63",
        "postTime": 1547206335,
        "uid": 107231,
        "name": "zombie462",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3618 \u3010\u8bef\u4f1a\u3011"
    }
]
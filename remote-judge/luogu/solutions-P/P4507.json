[
    {
        "content": "## [\u7334\u5b50\u5927\u6218](https://www.luogu.com.cn/problem/P4507)\n\n\u5982\u679c\u8bbe $f_S$ \u8868\u793a\u624b\u4e2d\u5361\u724c\u72b6\u6001\u4e3a $S$ \u65f6\u7684\u80dc\u7387\uff0c\u6709\uff1a\n\n$f_S= \\sum\\limits_{i\\in S}\\sum\\limits_{j\\in \\overline{S}}p_{i,j}\\times f_{S \\cup \\{j\\}} + (1-p_{i,j})\\times f_{S \\setminus \\{i\\}}$\n\n\u662f\u4e00\u4e2a\u6709\u73af\u7684 dp\uff0c\u5982\u679c\u66b4\u529b\u9ad8\u65af\u6d88\u5143\uff0c\u590d\u6742\u5ea6\u662f $O((2^n)^3)$ \u7684\uff0c\u4e0d\u80fd\u63a5\u53d7\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2a\u7ed3\u8bba\uff1a$f_A + f_B = f_{A \\cup B}$ \u3002\n\n\u8bc1\u660e\u5982\u4e0b\uff1a\n\n\u5047\u5982\u662f\u4e09\u4e2a\u4eba $A,B,C$ \u5728\u73a9\u8fd9\u4e2a\u6e38\u620f\uff0c\u90a3\u4e48\u80af\u5b9a\u6709 $f_A + f_B + f_C = 1$ \uff0c\u56e0\u4e3a\u6700\u540e\u4e00\u5b9a\u6709\u4e00\u4e2a\u4eba\u4f1a\u53d6\u80dc\u3002\n\n\u800c\u5bf9\u4e8e $A$ \u800c\u8a00\uff0c\u8981\u4e48\u662f\u8d62\u8981\u4e48\u662f\u8f93\uff0c\u5219 $f_A + f_{B \\cup C} = 1$\uff0c\u5219 $f_B + f_C = f_{B \\cup C}$ \u3002\n\n\u6709\u8fd9\u4e2a\u7ed3\u8bba\u4e4b\u540e\u53ef\u4ee5\u628a\u7ed9\u51fa\u7684\u6bcf\u4e2a 01 \u4e32\u4e3a 1 \u7684\u4f4d\u7f6e\u7684\u7b54\u6848\u7d2f\u52a0\u8d77\u6765\u5373\u53ef\u3002\n\n\u81f3\u4e8e\u8ba1\u7b97 $f_i$ \uff0c\u6a21\u4eff\u521a\u624d\u7684\u505a\u6cd5\uff0c\u53ef\u4ee5\u5bf9\u4e8e $i$ \u5217\u51fa\uff1a\n\n$f_i = \\sum\\limits_{j \\neq i} \\frac{p_{i,j}\\times (f_i + f_j) + (1-p_{i,j})\\times 0}{n-1}$ \n\n\u4e0a\u9762\u7684 $f_i + f_j$ \u5373\u4e3a $f_{\\{i \\} \\cup \\{j\\}}$,$0$ \u5373\u4e3a $f_{\\{i\\} \\setminus \\{i\\}}$\n\n\u800c\u8fd9 $n$ \u4e2a\u65b9\u7a0b\u53f3\u8fb9\u90fd\u6ca1\u6709\u5e38\u6570\uff0c\u6240\u4ee5\u6709 $n - 1$ \u4e2a\u65b9\u7a0b\u548c\u53e6\u5916\u4e00\u4e2a\u65b9\u7a0b\u672c\u8d28\u76f8\u540c\uff0c\u4f46\u662f\u5c31\u50cf\u6211\u4eec\u521a\u624d\u63a8\u5bfc\u7ed3\u8bba\u65f6\u6240\u8bf4\u7684\uff0c\u4e00\u5b9a\u6709\u4e00\u4e2a\u4eba\u4f1a\u53d6\u80dc\uff0c\u6240\u4ee5 $\\sum\\limits f_i = 1$ \uff0c\u73b0\u5728 $n$ \u4e2a\u65b9\u7a0b \uff0c $n$ \u4e2a\u672a\u77e5\u6570\uff0c\u9ad8\u65af\u6d88\u5143\u5373\u53ef\u3002\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3)$ \u3002",
        "postTime": 1639545015,
        "uid": 385093,
        "name": "uniqueharry",
        "ccfLevel": 0,
        "title": "P4507 [CTSC2013]\u7334\u5b50\u5927\u6218 \u9898\u89e3"
    },
    {
        "content": "# P4507\n\n### \u57fa\u672c\u601d\u60f3\uff1a\n\u6982\u7387\u8ba1\u7b97 + \u6d88\u5143\u6cd5\u65b9\u7a0b\u3002\n\n$ P[i] $ \u8868\u793a\u6709\u7b2c $ i $ \u5f20\u724c\u6982\u7387\u3002\n\n\u8003\u8651\u4e00\u4e2a\u4eba\u624b\u91cc\u6709 $ A $ \u724c\u548c $ B $ \u724c\uff0c\u4f7f\u7528 $ A $ \u724c\u83b7\u80dc\u7684\u6982\u7387\u548c\u7528 $ B $ \u724c\u80dc\u5229\u7684\u6982\u7387\u4e0d\u4f1a\u76f8\u4e92\u5f71\u54cd\u3002\n\n\u65e2\u6ee1\u8db3 $ P[A+B] = P[A] + P[B] $ \u3002\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97\u51fa\u6bcf\u5f20\u724c\u7684\u80dc\u5229\u6982\u7387\uff0c\u6839\u636e\u539f\u724c\u7684\u5f20\u6570\u52a0\u6743\u5e73\u5747\u540e\u7d2f\u52a0,\u5f97\u5230\u76ee\u524d\u72b6\u6001\u62e5\u6709\u7684\u724c\u7684\u80dc\u7387\u3002\n\n#### \u53ef\u5217\u65b9\u7a0b\uff1a\n\n$ f[i] $ \u8868\u793a\u5f53\u524d\u6709 $ i $ \u724c\u8d62\u5f97\u6982\u7387\uff0c$ f[i] $ \u53ef\u4ee5\u8f6c\u79fb\u5230 $ j $ \uff08\u4e0e $ i $ \u4e0d\u540c\u7684\u724c\uff09\u72b6\u6001\uff0c$ P[i][j] $ \u8868\u793a $ i $ \u72b6\u6001\u80fd\u8f6c\u79fb\u5230 $ j $ \u72b6\u6001\u7684\u6982\u7387\uff0c\n$ \\frac{1}{n-1} $ \u8868\u793a\u53e6\u4e00\u4e2a\u4eba\u9009\u62e9 $ j $ \u724c\u6bd4\u8d5b\u7684\u6982\u7387\uff0c$ f[i+j] $ \u8868\u793a $ i $ \u548c $ j $ \u83b7\u80dc\u7684\u6982\u7387\u3002\n\n$ \\displaystyle f[i]=\\sum_{j!=i}\\frac{P[i][j] \\times (f[i+j])}{n-1 }$\n\n\u542b\u4e49\uff1a $ f[i] $ \u83b7\u80dc\u7684\u6982\u7387\uff0c\u7b49\u4e8e $ i $ \u80fd\u8f6c\u79fb\u5230\u72b6\u6001\u7684\u83b7\u80dc\u6982\u7387\uff0c\u52a0\u6743\u540e\u7d2f\u548c\u3002\n\n\u6700\u540e\u6240\u6709\u724c\u90fd\u6709\u7684\u83b7\u80dc\u6982\u7387\u4e3a $ 1 $\u3002\n\n$ \\displaystyle \\sum_{i=1}^nf[i]=1 $\n\n\u5f97\u5230\u6240\u6709\u65b9\u7a0b\uff0c\u91c7\u7528\u9ad8\u65af\u6d88\u5143\u6216\u9ad8\u65af\u7ea6\u65e6\u6c42\u89e3\u3002\n\n#### AC\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h> \nusing namespace std;\ndouble f[11000],k[11000],b[11000];\ndouble a[1100][1100];\ndouble ans,mid;\nint tong[11000];\nint n,m;\nvoid Gauss()//\u9ad8\u65af\u7ea6\u65e6 \n{\n\tfor(int i=1;i<=n;i++)\n\t {\n\t \tint max=i;\n\t \tfor(int j=i+1;j<=n;j++)\n\t \t{\n\t \t\tif(fabs(a[j][i])>fabs(a[max][i]))\n\t \t\t{\n\t \t\t\tmax=j;\n\t \t\t}\n\t \t}\n\t \tfor(int j=1;j<=n+1;j++)\n\t \t{\n\t \t\tswap(a[i][j],a[max][j]);\n\t \t}\n\t \tfor(int j=1;j<=n;j++)\n\t \t{\n\t \t\tif(j!=i)\n\t \t\t{\n\t \t\t\tdouble temp=a[j][i]/a[i][i];\n\t \t\t\tfor(int k=i+1;k<=n+1;k++)\n\t \t\t\t{\n\t \t\t\t\ta[j][k]-=a[i][k]*temp;\n\t \t\t\t}\n\t \t\t}\n\t \t}\n    }\n}\nint main()\n{\n    //freopen(\"b.in\",\"r\",stdin);\n\t//freopen(\"b.out\",\"w\",stdout);\n    cin>>n>>m;\n    for(int i=1;i<n;i++)\n    {\n    \ta[i][i]=1-n;\n    \tfor(int j=1;j<=n;j++)\n    \t{\n    \t\tcin>>mid;\n    \t\tif(i!=j) \n\t\t\t{\n\t\t\t\ta[i][j]=mid;\n\t\t\t\ta[i][i]+=mid;\n\t\t\t}\n     \t}\n    }\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tcin>>mid;\n\t\ta[n][i]=1;//\u6784\u9020\u65b9\u7a0b\u77e9\u9635 \n\t}\n\ta[n][n+1]=1;//\u6700\u540e\u4e00\u4e2a\u65b9\u7a0b \n\tGauss();\n\tfor(int i=1;i<=m;i++)\n\t{\n        mid=0;\n\t\tstring s; \n\t\tcin>>s;\n\t\ts=' '+s;\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tif(s[i]=='1')\n\t\t\tmid+=a[i][n+1]/a[i][i];//\u5c06\u624b\u4e2d\u6709\u7684\u724c\u7d2f\u52a0 \n\t\t}\n\t\tprintf(\"%0.8lf\\n\",mid);\n\t}\n}\n```\n\n",
        "postTime": 1626912152,
        "uid": 250036,
        "name": "Eternal_Battle",
        "ccfLevel": 0,
        "title": "P4507"
    },
    {
        "content": "## \u6982\u7387&\u671f\u671b\n\n[\u535a\u5ba2\u9605\u8bfb](https://www.cnblogs.com/wljss/p/12342864.html)\n\n\u9996\u5148\u9047\u5230\u8fd9\u5230\u9898\u6211\u4eec\u53ef\u4ee5\u60f3\u51fa\u6765\u4e00\u4e2aDP\u7684\u65b9\u6cd5,\u8bbe $f[S]$ \u4e3a\u5f53\u524d\u5c0fQ\u624b\u91cc\u7684\u724c\u7684\u72b6\u6001\u4e3a $S$ \u65f6\uff0c\u5c0fQ\u80fd\u8d62\u7684\u6982\u7387.\n\n\u6211\u4eec\u679a\u4e3e $S$ \u80fd\u8f6c\u79fb\u7684\u5176\u4ed6\u72b6\u6001\uff0c\u5c31\u80fd\u5217\u51fa\u6765\u8f6c\u79fb\u65b9\u7a0b\uff0c\u4e00\u5171\u6709 $2^n$ \u4e2a\u65b9\u7a0b.\n\n\u89e3\u65b9\u7a0b\u6211\u4eec\u9700\u8981\u7528\u5230\u9ad8\u65af\u6d88\u5143\uff0c\u6240\u4ee5\u8fd9\u6837\u505a\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O((2^n)^3)$ .\n\n\u8fd9\u6837\u505a\u80af\u5b9a\u7206\u70b8\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u7528\u5230\u4e00\u4e2a\u7ed3\u8bba:\n\n>\u8bbe $A,B$ \u4e3a\u4e24\u79cd\u724c\u7684\u72b6\u6001,\u82e5 $A\u2229B=\u2205$\uff0c\u5219 $f[A\u222aB]=f[A]+f[B]$\n\n\u8bc1\u660e\uff1a\n\n\u6211\u4eec\u53ef\u4ee5\u60f3\u8c61\u73b0\u5728\u67093\u4e2a\u4eba $a,b,c$ \u5728\u73a9\u8fd9\u4e2a\u6e38\u620f,\u4ed6\u4eec\u624b\u91cc\u7684\u724c\u5206\u522b\u662f $A,B,C$ \uff0c\u6bcf\u6b21\u968f\u673a\u9009\u4e24\u4e2a\u4eba\u8fdb\u884c\u9898\u76ee\u4e2d\u7684\u63cf\u8ff0\u7684\u6b65\u9aa4\u6e38\u620f.\n\n\u663e\u7136\u6b64\u65f6\u6709 $f[A]+f[B]+f[C]=1$ ,\u4e5f\u5c31\u662f $f[A]=1-(f[B]+f[C])$ .\n\n\u5bf9\u4e8e $a$ \u800c\u8a00\uff0c$b,c$ \u53ef\u4ee5\u770b\u6210\u4e00\u4e2a\u6574\u4f53\uff0c\u6b64\u65f6 $f[A]=1-f[B\u222aC]$ .\n\n\u6545\u4e0a\u8ff0\u7ed3\u8bba\u6210\u7acb\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8bbe $f[i]$ \u8868\u793a\u624b\u4e0a\u53ea\u6709\u7b2c $i$ \u5f20\u724c\u65f6\u7684\u80dc\u7387\uff0c\u5bf9\u4e8e\u6bcf\u6b21\u8be2\u95ee\u6211\u4eec\u53ea\u9700\u8981\u5c06\u5c0fQ\u624b\u4e0a\u6709\u7684\u724c\u7684 $f$ \u52a0\u8d77\u6765\u5373\u53ef\u3002\n\n\u6c42f\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528DP\u7684\u65b9\u6cd5\n\n$\\displaystyle f[i]=\\sum_{j!=i}\\frac{P[i][j] \\times (f[i]+f[j])}{n-1}$\n\n\u6240\u4ee5\u65b9\u7a0b\u5c31\u662f\n\n$\\displaystyle ((n-1) - \\sum_{j!=i}P[i][j])\\times f[i]=\\sum_{j!=i}P[i][j] \\times f[j]$\n\n\u9ad8\u65af\u6d88\u5143\u5c31\u80fd\u89e3\u51b3\n\n\u6ce8\u610f\u6700\u540e\u4e00\u4e2a\u65b9\u7a0b\u5e94\u8be5\u662f$\\displaystyle \\sum_{i=1}^nf[i]=1$\n\n\u53e6\u5916\u672c\u9898\u5728\u6d1b\u8c37\u5e76\u4e0d\u80fdAC(\u8c8c\u4f3cSPJ\u51fa\u4e86\u70b9\u95ee\u9898)\uff0c\u5728bzoj\u4e0a\u53ef\u4ee5AC\n\n```cpp\n#include <iostream>\n#include <cstdio>\nusing namespace std;\nint n, m;\nchar s[105];\ndouble tmp, a[105][105];\ndouble Abs(double x){return x > 0 ? x : -x;}\nvoid Gauss()\n{\n\tfor(int i = 1, j, k;i <= n; ++ i)\n\t{\n\t\tfor(k = i, j = i + 1;j <= n;++ j)\n\t\t\tif(Abs(a[j][i]) > Abs(a[k][i]))k = j;\n\t\tswap(a[k], a[i]);\n\t\tfor(j = i + 1;j <= n; ++ j)\n\t\t\tfor(tmp = a[j][i] / a[i][i],k = i;k <= n + 1;++ k)a[j][k] -= a[i][k] * tmp;\n\t}\n\tfor(int i = n; i >= 1; -- i)\n\t{\n\t\tfor(int j = i + 1; j <= n;++ j)a[i][n+1] -= a[i][j] * a[j][n + 1];\n\t\ta[i][n+1] /= a[i][i];\n\t}\n}\nint main()\n{\n\tcin >> n >> m;\n\tfor(int i = 1; i < n; ++ i)\n\t{\n\t\ta[i][i] = 1 - n;\n\t\tfor(int j = 1; j <= n; ++ j)\n\t\t{\n\t\t\tscanf(\"%lf\", &tmp);\n\t\t\tif(i != j)a[i][j] = tmp,a[i][i] += tmp;\n\t\t}\n\t}\n\tfor(int i = 1; i <= n; ++ i)scanf(\"%lf\", &tmp),a[n][i] = 1;\n\ta[n][n + 1] = 1;\n\tGauss();\n\twhile(m--)\n\t{\n\t\tscanf(\"%s\", s+1);tmp = 0;\n\t\tfor(int i = 1; i <= n; ++ i)\n\t\t\tif(s[i] == '1')tmp += a[i][n + 1];\n\t\tprintf(\"%0.8f\\n\", tmp);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1582288656,
        "uid": 153843,
        "name": "wljss",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4507 \u3010[CTSC2013]\u7334\u5b50\u5927\u6218\u3011"
    }
]
[
    {
        "content": "# Solution\n\n### set\u6781\u7b80AC,\u770b\u9898\u89e3\u90a3\u4e48\u591a\u81ea\u5df1\u6253\u7684\u5e73\u8861\u6811,\u5176\u5b9eSTL\u633a\u597d\u7528\u7684\n\n\u73b0\u5728\u78b0\u5230\u5e73\u8861\u6811\u7684\u9898\u76ee\u4e00\u822c\u90fd\u662fvector\u6216\u8005\u662fset\u6c34\u8fc7\u53bb,\n\n\u6bd4\u5982\u8fd9\u9053\u9898....\n\n\u9898\u76ee\u8981\u6c42\u4e0d\u80fd\u91cd\u590d,set\u554a,\u4ec0\u4e48\u90fd\u4e0d\u7528\u5224\u65ad,\u76f4\u63a5\u63d2\u5165,\u65b9\u4fbf\n\n\u53ea\u662f\u8981\u6ce8\u610f\u7684set\u7684end\u51fd\u6570\u548cvector\u4e00\u6837\u662f\u5f00\u533a\u95f4,\u800cset\u7684\u8fed\u4ee3\u5668\u53c8\u53ea\u652f\u6301\n$--$\u548c$++$\u64cd\u4f5c,\u6240\u4ee5\u5728\u5220\u9664\u6700\u5927\u503c\u7684\u65f6\u5019\u8bb0\u5f97\u5c06\u8fed\u4ee3\u5668$--$\n\n- - -\n\n# Code\n```cpp\n#include<bits/stdc++.h>\n#define lol long long\n#define il inline\n#define rg register\n#define Min(a,b) (a)<(b)?(a):(b)\n#define Max(a,b) (a)>(b)?(a):(b)\n\nusing namespace std;\n\nconst int N=1e5+10;\n\nvoid in(lol &ans)\n{\n    ans=0; lol f=1; char i=getchar();\n    while(i<'0' || i>'9') {if(i=='-') f=-1; i=getchar();}\n    while(i>='0' && i<='9') ans=(ans<<1)+(ans<<3)+i-'0', i=getchar();\n    ans*=f;\n}\n\nstruct node {\n    lol x,v;\n    bool operator < (const node & a) const {return v<a.v;}\n};\nset<node>v;\n\nint main()\n{\n    lol op,x,y; node tmp;\n    while(1) {\n        in(op);\n        if(op==1) {\n            in(x),in(y);\n            tmp = (node) {x,y};\n            v.insert(tmp);\n        }\n        else if(op==2) {if(v.size()) v.erase(--v.end());}\n        else if(op==3) {if(v.size()) v.erase(v.begin());}\n        else {\n            lol ans1=0,ans2=0;\n            for(set<node>::iterator it=v.begin();it!=v.end();it++) ans1+=(*it).x,ans2+=(*it).v;\n            printf(\"%lld %lld\\n\",ans1,ans2);\n            return 0;\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1536152484,
        "uid": 45210,
        "name": "kikuss",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "## \u601d\u8def\n\n\u4e3a\u4ec0\u4e48\u6807\u7b7e\u90a3\u4e48\u5413\u4eba\uff0c\u5176\u5b9e\u4f18\u5148\u961f\u5217\u5f3a\u884c\u6a21\u62df\u9898\u610f\u7684\u64cd\u4f5c\u662f\u53ef\u884c\u7684\uff0c\u65f6\u95f4\u6bd4Splay\u6162\uff0c\u4f46\u662f\u4f9d\u7136\u53ea\u6709488ms\u3002\n\n\u6211\u4eec\u8003\u8651\u5f00\u4e24\u4e2a\u961f\u5217\uff0c\u5206\u522b\u7ef4\u62a4\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\uff0c\u540c\u65f6\u7528v\u6570\u7ec4\u5efa\u7acb\u4ef7\u683c\u5230\u7f8e\u4e3d\u503c\u7684\u6620\u5c04\u3002\u6dfb\u52a0\u7684\u65f6\u5019\u76f4\u63a5\u4e24\u4e2a\u961f\u5217\u90fd\u52a0\u4e0a\u5c31\u884c\uff0c\u5e76\u4e14\u66f4\u65b0v\u6570\u7ec4\u3002\n\n\u5220\u9664\u7684\u65f6\u5019\uff0c\u6211\u4eec\u66f4\u65b0\u7f8e\u4e3d\u503c\u603b\u548c\u4ee5\u53ca\u603b\u4ef7\uff0c\u540c\u65f6\u628a\u8fd9\u4e2a\u4ef7\u683c\u5230\u7f8e\u4e3d\u503c\u7684\u6620\u5c04\u53d8\u62100\u3002\u5728\u4ee5\u4e0a\u64cd\u4f5c\u4e4b\u524d\uff0c\u9996\u5148\u628a\u961f\u5217\u4e2d\u5df2\u7ecf\u7531\u4e8e\u53e6\u4e00\u79cd\u64cd\u4f5c\u5220\u9664\u7684\u70b9pop\u6389\uff0c\u68c0\u6d4b\u65b9\u6cd5\u5c31\u662f\u770b\u8fd9\u4e2a\u70b9\u7684\u4ef7\u683c\u5bf9\u5e94\u7684\u7f8e\u4e3d\u503c\u662f\u4e0d\u662f\u5df2\u7ecf\u53d8\u6210\u4e860\uff0c\u5373\u5df2\u7ecf\u88ab\u5220\u9664\u3002\n\n## \u4ee3\u7801\n\n\u5c3d\u91cf\u5199\u5f97\u7b80\u4ecb\u5e76\u4e14\u6ca1\u6709\u538b\u884c\u3002\u6709\u7591\u95ee\u6b22\u8fce\u4ea4\u6d41\u3002\n\n```\n#include <bits/stdc++.h>\n#define maxn 1000001\nusing namespace std;\nint v[maxn];//\u5efa\u7acb\u4ef7\u683c\u5230\u7f8e\u4e3d\u503c\u7684\u6620\u5c04\nlong long tob,top;\npriority_queue<int>qin;\npriority_queue<int,vector<int>,greater<int> >qax;\nvoid Add(){\n\tint x,y;\n    cin>>x>>y;\n    if (v[y]) return;//\u53d1\u73b0\u76f8\u540c\u4ef7\u683c\u5c31\u8fd4\u56de\n    qin.push(y);\n    qax.push(y);\n    v[y]=x;\n    tob+=x,top+=y;\n}\nvoid Delin(){\n    while(!qin.empty()&&!v[qin.top()]) qin.pop();\n    if (!qin.empty()){\n        int te=qin.top();\n        tob-=v[te];\n        top-=te;\n        v[te]=0;\n        qin.pop();\n    }\n}\nvoid Delax(){\n    while(!qax.empty()&&!v[qax.top()]) qax.pop();\n    if (!qax.empty()){\n        int te=qax.top();\n        tob-=v[te];\n        top-=te;\n        v[te]=0;\n        qax.pop();\n    }\n}\nint main(){\n    ios::sync_with_stdio(false);\n    int q;\n    cin>>q;\n    while(q!=-1){\n        if (q==1) Add();\n        if (q==2) Delin();\n        if (q==3) Delax();\n        cin>>q;\n    }\n    cout<<tob<<\" \"<<top;\n    return 0;\n}\n```",
        "postTime": 1519828067,
        "uid": 37158,
        "name": "XG_Zepto",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "## Solution\n$\\mathcal{fhq-Treap}$ \u4e86\u89e3\u4e00\u4e0b  \n$\\mathcal{fhq-Treap}$ \u5165\u95e8\u53ef\u4ee5\u770b\u6211\u7684\u8fd9\u7bc7[\u535a\u5ba2](http://www.cnblogs.com/YoungNeal/p/8977328.html)  \n\u8bb2\u4e00\u4e0b\u8fd9\u9898\u600e\u4e48\u641e  \n\u5bf9\u4e8e\u63d2\u5165\u64cd\u4f5c\uff0c\u5047\u8bbe\u6743\u503c\u4e3a $\\mathcal{k}$\u3002\u6211\u4eec\u6309\u7167\u6743\u503c\u5148 $\\mathcal{split}$ \u51fa\u5c0f\u4e8e\u7b49\u4e8e $\\mathcal{k}$ \u7684\u4e00\u68f5\u6811 $\\mathcal{x}$\uff0c\u518d\u628a $\\mathcal{x}$ $\\mathcal{split}$ \u51fa\u5c0f\u4e8e\u7b49\u4e8e $\\mathcal{k-1}$ \u7684\u4e00\u68f5\u6811 $\\mathcal{y}$\u3002\u5982\u679c $\\mathcal{y}$ \u8fd9\u68f5\u5b50\u6811\u4e0d\u4e3a\u7a7a\uff0c\u4e5f\u5c31\u662f\u8bf4\u5df2\u7ecf\u6709\u4e86\u6743\u503c\u4e3a $\\mathcal{k}$ \u7684\u8282\u70b9\uff0c\u90a3\u4e48\u6211\u4eec\u4e0d\u63d2\u5165\u5373\u53ef\u3002  \n\u5bf9\u4e8e\u5220\u9664\u64cd\u4f5c\uff0c\u6211\u4eec\u53ef\u4ee5\u6309\u7167\u5b50\u6811\u5927\u5c0f $\\mathcal{split}$ \u51fa\u6211\u4eec\u8981\u5220\u9664\u7684\u503c\uff0c\u7136\u540e\u4e0d $\\mathcal{merge}$ \u5373\u53ef\u3002  \n\u6700\u540e $\\mathcal{dfs}$ \u4e00\u904d\u6c42\u51fa\u7b54\u6848\u5373\u53ef\u3002  \n\u6700\u6162\u7684\u70b9 $\\mathcal{30ms}$\uff0c\u6bd4 $\\mathcal{STL}$ \u5feb\u4e86\u4e0d\u77e5\u9053\u591a\u5c11\u3002\n## Code\n```cpp\n#include<cstdio>\n#include<cstdlib>\n#define N 100005\n#define int long long\n\nint tot,Root;\nint ans1,ans2;\nint beauty[N];\nint val[N],sze[N];\nint ch[N][2],prio[N];\n\nvoid pushup(int o){\n  sze[o]=sze[ch[o][0]]+sze[ch[o][1]]+1;\n}\n\nvoid split(int o,int k,int &x,int &y){\n  if(!o) x=y=0;\n  else{\n    if(sze[ch[o][0]]>=k){\n      y=o;\n      split(ch[o][0],k,x,ch[o][0]);\n      pushup(o);\n    }\n    else{\n      x=o;\n      split(ch[o][1],k-sze[ch[o][0]]-1,ch[o][1],y);\n      pushup(o);\n    }\n  }\n}\n\nint merge(int x,int y){\n  if(!x or !y) return x+y;\n  if(prio[x]<prio[y]){\n    ch[x][1]=merge(ch[x][1],y);\n    pushup(x);\n    return x;\n  }\n  else{\n    ch[y][0]=merge(x,ch[y][0]);\n    pushup(y);\n    return y;\n  }\n}\n\nvoid split2(int o,int k,int &x,int &y){\n  if(!o) x=y=0;\n  else{\n    if(val[o]<=k){\n      x=o;\n      split2(ch[o][1],k,ch[o][1],y);\n    } else{\n      y=o;\n      split2(ch[o][0],k,x,ch[o][0]);\n    }\n    pushup(o);\n  }\n}\n\nint newnode(int a,int b){\n  sze[++tot]=1;\n  prio[tot]=rand();\n  beauty[tot]=a;\n  val[tot]=b;\n  return tot;\n}\n\nvoid insert(int o,int a,int b){\n  int x,y,z;\n  split2(Root,b,x,y);\n  split2(x,b-1,x,z);\n  if(sze[z]!=0) \n    Root=merge(x,merge(z,y));\n  else\n    Root=merge(x,merge(newnode(a,b),y));\n}\n\nvoid delex(){\n  int siz=sze[Root];\n  int a;\n  split(Root,siz-1,Root,a);\n}\n\nvoid delch(){\n  int a;\n  split(Root,1,a,Root);\n}\n\nvoid dfs(int now){\n  //printf(\"now=%d\\n\",now);\n  if(!now) return;\n  ans1+=beauty[now];\n  ans2+=val[now];\n  dfs(ch[now][0]);\n  dfs(ch[now][1]);\n}\n\nsigned main(){\n  int opt,a,b;\n  while(scanf(\"%lld\",&opt)){\n    if(opt==-1) break;\n    if(opt==1){\n      scanf(\"%lld%lld\",&a,&b);\n      insert(Root,a,b);\n    }\n    if(opt==2)\n      delex();\n    if(opt==3)\n      delch();\n  }\n  dfs(Root);\n  printf(\"%lld %lld\\n\",ans1,ans2);\n  return 0;\n}\n```",
        "postTime": 1525570759,
        "uid": 56778,
        "name": "YoungNeal",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "\u7b2c\u4e00\u773c\u9898\u9762\uff0c\u60f3\u76f4\u63a5\u7ebf\u6bb5\u6811\u641e\u5c31\u884c\u4e86\uff0c\u7ef4\u62a4\u516d\u4e2a\u4e1c\u897f:\u6700\u5927\u503c\uff0c\u6700\u5c0f\u503c\uff0c\u6700\u5927\u503c\u7684\u4f4d\u7f6e\uff0c\u6700\u5c0f\u503c\u7684\u4f4d\u7f6e\uff0c\u7f8e\u4e3d\u503c\u7684\u603b\u548c\u548c\u603b\u4ef7\u683c\u3002\n\n\u770b\u4e86\u6807\u7b7e:\u7ebf\u6bb5\u6811\uff0c\u5e73\u8861\u6811\uff0c\u8f6c\u5ff5\u4e00\u60f3\u8fd8\u662f\u5199\u4e86 _Splay_ \uff0c\u7136\u540e\u5c31\u8c03\u4e861h\u3002\n\n\u8c8c\u4f3c\u6ca1\u4eba\u53d1 _Splay_ \u8bf6\uff0c\u90a3\u6211\u6765\u8865\u4e00\u53d1\u5427\u3002\n\n\u548c\u6a21\u677f\u5dee\u4e0d\u591a\u5427\u3002\n\n\u67e5\u627e\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\uff1a\u76f4\u63a5\u67e5\u627e\u4e00\u4e2a\u6781\u5927\u503c\u6216\u6781\u5c0f\u503c\u7684\u524d\u9a71\u6216\u540e\u7ee7\u3002\n\n\u5224\u65ad\u662f\u5426\u4e3a\u7a7a\uff1a\u4e00\u5f00\u59cb\u5148\u63d2\u5165\u4e00\u4e2a\u6781\u5927\u503c\u548c\u4e00\u4e2a\u6781\u5c0f\u503c\uff0c\u5982\u679c\u67e5\u627e\u7684\u6781\u5927\u503c\u6216\u6781\u5c0f\u503c\u7684\u524d\u9a71\u6216\u540e\u7ee7=\u53e6\u5916\u4e00\u4e2a\u6781\u503c\uff0c\u5c31\u8bf4\u660e\u4e3a\u7a7a\u3002\n\n\u6ce8\u610f\uff1a\u91cd\u590d\u7684\u8bdd\uff0c\u603b\u548c\u90fd\u4e0d\u7528\u52a0\u4e86\u3002\n\n```\n//by zykykyk\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n#include<string>\n#include<cstring>\n#include<set>\n#include<vector>\n#include<queue>\n#include<map>\n#define For(i,x,y) for (int i=(x);i<=(y);i++)\n#define Dow(i,x,y) for (int i=(x);i>=(y);i--)\n#define cross(i,k) for (int i=first[k];i;i=last[i])\n#define il inline\n#define vd void\n#define ll long long\n#define N 100010\n#define inf 2147483647\nusing namespace std;\nnamespace fast_IO {\n    inline char read() {\n    \treturn getchar();\n        static const int IN_LEN = 1000000;\n        static char buf[IN_LEN], *s, *t;\n        if (s == t) {\n            t = (s = buf) + fread(buf, 1, IN_LEN, stdin);\n            if (s == t) return -1;\n        }\n        return *s++;\n    }\n    template<class T>\n    inline void read(T &x) {\n        static bool iosig;\n        static char c;\n        for (iosig = false, c = read(); !isdigit(c); c = read()) {\n            if (c == '-') iosig = true;\n            if (c == -1) return;\n        }\n        for (x = 0; isdigit(c); c = read())\n            x = ((x + (x << 2)) << 1) + (c ^ '0');\n        if (iosig) x = -x;\n    }\n    const int OUT_LEN = 10000000;\n    char obuf[OUT_LEN], *ooh = obuf;\n    inline void print(char c) {\n        if (ooh == obuf + OUT_LEN) fwrite(obuf, 1, OUT_LEN, stdout), ooh = obuf;\n        *ooh++ = c;\n    }\n    template<class T>\n    inline void print(T x) {\n        static int buf[30], cnt;\n        if (x == 0) {\n            print('0');\n        }\n        else {\n            if (x < 0) print('-'), x = -x;\n            for (cnt = 0; x; x /= 10) buf[++cnt] = x % 10 + 48;\n            while (cnt) print((char)buf[cnt--]);\n        }\n    }\n    inline void flush() {\n        fwrite(obuf, 1, ooh - obuf, stdout);\n    }\n}\nusing namespace fast_IO;\nstruct tree{\n\tint fa,son[2];\n\tll v,bv;\n}t[N];\nint root,tot,k;\nll sum1,sum2,x,y;\nil vd rotate(int x){\n\tint y=t[x].fa,z=t[y].fa,k=t[y].son[0]==x;\n\tt[z].son[t[z].son[1]==y]=x,t[x].fa=z;\n\tt[y].son[k^1]=t[x].son[k],t[t[x].son[k]].fa=y;\n\tt[x].son[k]=y,t[y].fa=x;\n}\nil vd Splay(int x,int go){\n\twhile (t[x].fa!=go){\n\t\tint y=t[x].fa,z=t[y].fa;\n\t\tif (z!=go) (t[z].son[0]==y)==(t[y].son[0]==x)?rotate(y):rotate(x);\n\t\trotate(x);\n\t}\n\tif (!go) root=x;\n}\nil vd insert(ll x,ll y){\n\tint u=root,fa=0;\n\twhile (u&&t[u].v!=x) fa=u,u=t[u].son[x>t[u].v];\n\tif (!u){\n\t\tu=++tot,sum1+=y,sum2+=x;\n\t\tif (fa) t[fa].son[x>t[fa].v]=u;\n\t\tt[u].fa=fa,t[u].v=x,t[u].bv=y;\n\t\tt[u].son[0]=t[u].son[1]=0;\n\t}\n\tSplay(u,0);\n}\nil vd Find(ll x){\n\tint u=root;\n\tif (!u) return;\n\twhile (t[u].son[x>t[u].v]&&x!=t[u].v) u=t[u].son[x>t[u].v];\n\tSplay(u,0);\n}\nil int Next(ll x,int f){\n\tFind(x);\n\tint u=root;\n\tif ((x<t[u].v&&f)||(x>t[u].v&&!f)) return u;\n\tu=t[u].son[f];\n\twhile (t[u].son[f^1]) u=t[u].son[f^1];\n\treturn u;\n}\nil vd Delete(ll x){\n\tint last=Next(x,0),next=Next(x,1);\n\tSplay(last,0),Splay(next,last);\n\tt[next].son[0]=0;\n}\nint main(){\n\tfreopen(\"data.in\",\"r\",stdin);\n\tfreopen(\"m.out\",\"w\",stdout);\n\tinsert(inf,0),insert(-inf,0);\n\twhile (2333){\n\t\tread(k);\n\t\tif (k==-1) break;\n\t\tif (k==1){\n\t\t\tread(x),read(y);\n\t\t\tinsert(y,x);\n\t\t}\n\t\tif (k==2){\n\t\t\tint x=Next(inf,0);\n\t\t\tif (t[x].v!=-inf){\n\t\t\t\tsum1-=t[x].bv,sum2-=t[x].v;\n\t\t\t\tDelete(t[x].v);\n\t\t\t}\n\t\t}\n\t\tif (k==3){\n\t\t\tint x=Next(-inf,1);\n\t\t\tif (t[x].v!=inf){\n\t\t\t\tsum1-=t[x].bv,sum2-=t[x].v;\n\t\t\t\tDelete(t[x].v);\n\t\t\t}\n\t\t}\n\t}\n\tprint(sum1),print(' '),print(sum2);flush();\n}\n```",
        "postTime": 1517919376,
        "uid": 25355,
        "name": "\u590f\u8272\u796d",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "\u8fd9\u91cc\u849f\u84bb\u6765\u4e00\u53d1\u7ebf\u6bb5\u6811\u7684\u9898\u89e3\uff1b\n\n\u7528\u7ebf\u6bb5\u6811\u6765\u505a\u7684\u8bdd\uff0c\u53ef\u4ee5\u79f0\u4e3a\u8f83\u4e3a\u6a21\u677f\u7684\u9898\u5427\uff0c\u53ef\u4ee5\u7ed9\u6211\u4eec\u8fd9\u4e9b\u849f\u84bb\u7ec3\u7ec3\u624b\uff1b\n\n\u56e0\u4e3a\u8981\u8f93\u51faw\u7684\u603b\u548c\uff0cc\u7684\u603b\u548c\uff0c\u6211\u4ee5 1\u2014\u6700\u5927\u7684\u94b1\u4e3a\u533a\u95f4\uff0c\u800c\u6bcf\u6b21\u90fd\u53ef\u4ee5\u770b\u4f5c\u662f\u70b9\u67e5\u8be2\uff1b\n\n\u53c8\u56e0\u4e3a\u8981\u4fee\u6539\u6700\u5c0f\u503c\uff0c\u6700\u5927\u503c\uff0c\u6240\u4ee5\u7ef4\u62a4sumw\uff0csumc\uff0cminn\uff0cmaxx\u5c31\u53ef\u4ee5\u4e86\uff1b\n\n\u53c2\u8003\u4ee3\u7801\uff1a\n\n```cpp\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define ls id<<1\n#define rs id<<1|1\nusing namespace std;\nconst int maxn=1e6+10;\nconst int inf=0x7f7f7f7f;\nint opt; \nbool vis[maxn];//\u7528\u6765\u5224\u91cd\uff1b \nstruct Tree\n{\n    int l,r;\n    int sumw,sumc;\n    int minn,maxx;\n}tr[maxn<<2];\nvoid build(int id,int ll,int rr)\n{\n    tr[id].l=ll,tr[id].r=rr,tr[id].minn=inf; \n    if(ll==rr) return;\n    int m=ll+rr>>1;\n    build(ls,ll,m),build(rs,m+1,rr);\n}\nvoid update(int id,int pos,int val1,int val2,int val3,int val4)\n{\n    if(tr[id].l==pos && tr[id].r==pos) \n    {\n        tr[id].sumc=val1;tr[id].sumw=val2;\n        tr[id].minn=val3;tr[id].maxx=val4;\n        return;\n    }\n    if(tr[ls].r>=pos) update(ls,pos,val1,val2,val3,val4);\n    else update(rs,pos,val1,val2,val3,val4);\n    tr[id].sumc=tr[ls].sumc+tr[rs].sumc;\n    tr[id].sumw=tr[ls].sumw+tr[rs].sumw;\n    tr[id].minn=min(tr[ls].minn,tr[rs].minn);\n    tr[id].maxx=max(tr[ls].maxx,tr[rs].maxx);\n}\nint main()\n{\n    int n=maxn-10;\n    build(1,1,n);\n    while(scanf(\"%d\",&opt)==1 && opt!=-1)\n    {\n        int w,c;\n        if(opt==1) \n        {\n            scanf(\"%d %d\",&w,&c);\n            if(vis[c]) continue;\n            update(1,c,c,w,c,c);vis[c]=true;\n        }\n        if(opt==3)\n        {\n            if(tr[1].minn==inf) continue;//\u6b64\u65f6\u65e0\u82b1\uff0c\u4e0b\u540c\uff1b \n            vis[tr[1].minn]=false,update(1,tr[1].minn,0,0,inf,0);\n        }\n        if(opt==2)\n        {\n            if(tr[1].maxx==0) continue;\n            vis[tr[1].maxx]=false,update(1,tr[1].maxx,0,0,inf,0);\n        }\n    }\n    printf(\"%d %d\",tr[1].sumw,tr[1].sumc);\n}\n```",
        "postTime": 1505740528,
        "uid": 25361,
        "name": "\u4e3f\u738b\u8005\u4e4b\u8def",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "\u5176\u5b9e\u7ebf\u6bb5\u6811\u6211\u4eec\u7ef4\u62a4\u4e24\u4e2a\u6807\u8bb0\u5c31\u53ef\u4ee5\u4e86\n\u8d3c\u6c34\u7684\u4e00\u9053\u9898\n```\n#include<bits/stdc++.h>\n#define maxn 1000005//\u6309\u7167\u8d39\u7528\u5efa\u7ebf\u6bb5\u6811\n#define mid ((zuo+you)>>1)\n#define c1 (o<<1)\n#define c2 (o<<1|1)\nusing namespace std;\nint sumc[maxn<<2],sumw[maxn<<2];\n\n//--//--//\u7ebf\u6bb5\u6811//--//--//\nvoid del(int o,int zuo,int you,int s)//s==1\u8868\u793a\u5220\u9664\u6700\n//\u8d35\u7684\u82b1\uff0c\u4e5f\u5c31\u662f\u7ebf\u6bb5\u6811\u5b58\u5728\u7684\u6700\u53f3\u7684\u53f6\u8282\u70b9\n{\n\tif(zuo==you){\n\t\tsumc[o]=sumw[o]=0;return;\n\t}\n\tif(s&&sumc[c1]&&sumc[c2]) del(c2,mid+1,you,s);\n\telse if(!sumc[c1]) del(c2,mid+1,you,s);\n\telse del(c1,zuo,mid,s);\n\tsumc[o]=sumc[c1]+sumc[c2];\n\tsumw[o]=sumw[c1]+sumw[c2];\n}\n\nvoid update(int o,int zuo,int you,int x,int y,int k)\n{\n\tif(zuo==you){\n\t\tif(sumc[o]) return;\n\t\tsumc[o]=x;sumw[o]=k;\n\t\treturn;\n\t}\n\tif(x<=mid) update(c1,zuo,mid,x,y,k);\n\telse update(c2,mid+1,you,x,y,k);\n\tsumc[o]=sumc[c1]+sumc[c2];\n\tsumw[o]=sumw[c1]+sumw[c2];\n} \n\nint main()\n{\n\tint opt,x,y;\n\twhile(1){\n\t\tscanf(\"%d\",&opt);\n\t\tif(opt==-1) break;\n\t\tif(opt==1){\n\t\t\tscanf(\"%d%d\",&x,&y);\n\t\t\tupdate(1,1,maxn,y,y,x);\n\t\t}\n\t\tif(opt==2){\n\t\t\tif(sumc[1]==0) continue;\n\t\t\tdel(1,1,maxn,1);\n\t\t}\n\t\tif(opt==3){\n\t\t\tif(sumc[1]==0) continue;\n\t\t\tdel(1,1,maxn,0);\n\t\t}\n\t}\n\tcout<<sumw[1]<<\" \"<<sumc[1];\n\treturn 0;\n}\n```",
        "postTime": 1521118356,
        "uid": 29610,
        "name": "SGOI_Aromyase",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "### \u8fd9\u9898\u5176\u5b9e\u53ef\u4ee5\u7528vector\u6c34\u6389\uff01\n\n### \u5b9a\u4e49\uff1a\n\n\u8bb0\u4f4f\u8981\u7528\u7ed3\u6784\u4f53(c\u4e3a\u4ef7\u683c\uff0cx\u4e3a\u7f8e\u4e3d\u503c)\uff01\n\n\u4ee5c\u6392\u5e8f\u3002\n\n```cpp\nstruct Node {\n\tint x,c;\n\tbool operator < (const &Node t) const {\n    \treturn c<t.c;\n    }\n}\nvector <Node> a;\n```\n\n### \u63d2\u5165\uff1a\n\nupper_bound\u7684\u4f5c\u7528\u662f\u5c06\u5f53\u524d\u8282\u70b9\u63d2\u5230\u5408\u9002\u4f4d\u7f6e\uff0c\u4ee5\u8fbe\u5230\u6392\u5e8f\u6548\u679c\u3002\n\n\u8bb0\u4f4f\u4e0d\u80fd\u63d2\u5165\u540c\u6837\u4ef7\u683c\u7684\u82b1\u3002\n\n\u6240\u4ee5\u7528vis[]\u6570\u7ec4\u7edf\u8ba1\u3002\n\n```cpp\nif (vis[c]) continue;\nvis[c]=1;\na.insert(upper_bound(a.begin(),a.end(),(Node){x,c}),(Node){x,c});\n\n```\n\n### \u5220\u9664\uff1a\n\n\u5927\u8282\u70b9\u5c31\u5220\u9664\u6700\u540e\u4e00\u4e2a\uff0c\u8bb0\u4f4f\u8981\u628avis[]\u6e05\u6389\u3002\n\nvector\u533a\u95f4\u662f\u5de6\u95ed\u53f3\u5f00\u7684\uff0c\u6240\u4ee5\u5220\u9664erase(a.end()-1)\u3002\n\n\u5373\uff1a\n\n```cpp\nif (opt==2) vis[a[a.size()-1].c]=0,a.erase(a.end()-1);\n```\n\n\u5c0f\u8282\u70b9\u5c31\u5220\u9664\u7b2c\u4e00\u4e2a\uff0c\u5373\uff1a\n\n```cpp\nif (opt==3) vis[a[0].c]=0,a.erase(a.begin());\n```\n\n### \u4ee3\u7801\uff1a\n\n\u6ce8\u610f\u8981\u5f00long long\uff5e\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef int _int;\n#define int long long\nstruct Node {\n    int x,c;\n    bool operator < (const Node &t) const {\n        return c<t.c;\n    }\n};\nvector <Node> a;\nint ans1,ans2;\nbool vis[1000001];\n_int main()\n{\n    int opt,x,c;\n    while (1) {\n        scanf(\"%lld\",&opt);\n        if (opt==-1) break;\n        if (opt==1) {\n            scanf(\"%lld%lld\",&x,&c);\n            if (vis[c]) continue;\n            vis[c]=1;\n            a.insert(upper_bound(a.begin(),a.end(),(Node){x,c}),(Node){x,c});\n        }\n        if (!a.size()) continue;\n        if (opt==3) vis[a[0].c]=0,a.erase(a.begin());\n        if (opt==2) vis[a[a.size()-1].c]=0,a.erase(a.end()-1);\n    }\n    int len=a.size();\n    for (int i=0;i<len;++i) ans1+=a[i].x,ans2+=a[i].c;\n    cout<<ans1<<' ';\n    cout<<ans2<<endl;\n    return 0;\n}\n```",
        "postTime": 1536152019,
        "uid": 45781,
        "name": "fyfy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "\u8c8c\u4f3c\u6ca1\u6709C++ set\u7684\u9898\u89e3\n\n\u539f\u7406:set\u5224\u91cd&\u6392\u5e8f\n\n\u6ce8\u610f\u7ed3\u6784\u4f53\u8981\u8fd0\u7528\u91cd\u8f7d\u8fd0\u7b97\u7b26\n\n```cpp\n#include<set>\n#include<cstdio>\nusing namespace std;\nstruct flower1  //\u6309\u8d35\u7684\u6392\u5e8f \n{\n    int w,c;\n    bool operator<(const flower1 &fff)const\n    {\n        if (c==fff.c)return 0;  //\u5224\u91cd \n        return c>fff.c;\n    }\n};\nstruct flower2  //\u6309\u4fbf\u5b9c\u7684\u6392\u5e8f \n{\n    int w,c;\n    bool operator<(const flower2 &fff)const\n    {\n        if (c==fff.c)return 0;   //\u5224\u91cd \n        return c<fff.c;\n    }\n};\nset<flower1>s1;\nset<flower2>s2;\nint ans1,ans2;\nint main()\n{\n    int type,w,c;\n    while (scanf(\"%d\",&type)==1&&type>0)\n    {\n        if (type<2) //\u4e5f\u5c31\u662ftype==1\uff0c\u4f46\u662f\u8fd9\u6837\u4ee3\u7801\u77ed \n        {\n            scanf(\"%d%d\",&w,&c);\n            s1.insert((flower1){w,c});\n            s2.insert((flower2){w,c});   //\u6dfb\u52a0\u82b1 \n        }\n        if (type==2)\n        {\n            int dw=s1.begin()->w,dc=s1.begin()->c;\n            s1.erase(*s1.begin());  //\u5148\u628a\u6700\u8d35\u7684\u5220\u6389 \n            s2.erase((flower2){dw,dc}); //\u628as2\u4e2d\u5bf9\u5e94\u6700\u8d35\u7684\u82b1\u5220\u6389 \n            //\u56e0\u4e3aflower1\u548cflower2\u662f\u4e0d\u540c\u7c7b\u578b\u6240\u4ee5\u4e0d\u80fd\u76f4\u63a5s2.erase(*s1.begin());\n        }\n        if (type==3)\n        {\n            //\u540c\u7406\u5220\u6700\u4fbf\u5b9c\u7684 \n            int dw=s2.begin()->w,dc=s2.begin()->c;\n            s1.erase((flower1){dw,dc});\n            s2.erase(*s2.begin());\n        }\n    }\n    for (set<flower1>::iterator i=s1.begin();i!=s1.end();i++)\n        ans1+=i->w,ans2+=i->c;  //\u7d2f\u52a0\u7b54\u6848 \n    printf(\"%d %d\",ans1,ans2);\n    return 0;\n}\n```",
        "postTime": 1508399391,
        "uid": 14374,
        "name": "zhengrunzhe",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "\u6211\u7684[blog](https://blog.csdn.net/A_Comme_Amour/article/details/79775187)\n\n\n\u9898\u76ee\n-\n\n[\u4f20\u9001\u95e8](https://www.luogu.org/problemnew/show/P2073)\n\n\u9898\u89e3\n-\n\n\u5199\u8fd9\u9053\u9898\u662f\u4e3a\u4e86\u5199\u6743\u503c\u7ebf\u6bb5\u6811\n\u770b\u5230c\u7684\u8303\u56f4\u6bd4\u8f83\u5c0f\uff0c\u6309\u7167C\u4e3a\u6743\u503c\u5efa\u7acb\u7ebf\u6bb5\u6811\uff0cc\u7684\u503c\u5c31\u662f\u7ebf\u6bb5\u6811\u7684\u53f6\u5b50\u4f4d\u7f6e\uff1b\n\u7c7b\u4f3c\u4e8e\u5e73\u8861\u6811\u7684\u505a\u6cd5\uff0c\u67e5\u8be2\u6700\u5de6\u6216\u6700\u6709\u7684\u8282\u70b9\u5220\u9664\n\n\u4ee3\u7801\n-\n\n```\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <iostream>\n#include <queue>\n#define lson (rt<<1)\n#define rson (rt<<1|1)\nusing namespace std;\nconst int maxn=1e6+10;\nconst int inf=1e9;\n\nint read(){\n    char ch=getchar(); int now=0,f=1;\n    while (ch<'0'||ch>'9') {if (ch=='-') f=-1; ch=getchar();}\n    while (ch>='0'&&ch<='9') {now=(now<<1)+(now<<3)+ch-'0'; ch=getchar();}\n    return now*f;}\nstruct Node{\n    int w; int c;\n}tree[maxn<<2];\n\nvoid clear(int rt) {tree[rt].w=tree[rt].c=0;}\nvoid pushup(int rt)\n{\n    tree[rt].w=tree[lson].w+tree[rson].w;\n    tree[rt].c=tree[lson].c+tree[rson].c;\n}\nvoid change(int x,int W,int C,int l,int r,int rt)\n{\n    if (l==r)\n\t{\n\t\tif (tree[rt].c) return;\n\t\ttree[rt].w=W; tree[rt].c=C; return;\n\t}\n    int mid=(l+r)>>1;\n    if (x<=mid) change(x,W,C,l,mid,lson);\n    else change(x,W,C,mid+1,r,rson);\n    pushup(rt);\n}\n\nvoid del(int l,int r,int rt,bool flag)//flag\u6807\u8bb0\u662f\u5426\u5220\u9664\u6700\u540e\u4e00\u4e2a\n{\n    if (l==r) {clear(rt); return;}\n    int mid=(l+r)>>1;\n    if (flag && tree[lson].c && tree[rson].c) del(mid+1,r,rson,flag);\n    else if (!tree[lson].c) del(mid+1,r,rson,flag);\n         else del(l,mid,lson,flag);\n    pushup(rt);\n}\n\nint main()\n{\n    int opt;\n    while (opt=read())\n    {\n        if (opt==-1) break;\n        if (opt==1)\n        {\n            int w=read(); int c=read();\n            change(c,w,c,1,maxn,1);\n        }\n        if (opt==3) del(1,maxn,1,0);\n        if (opt==2) del(1,maxn,1,1);\n    }\n    printf(\"%d %d\",tree[1].w,tree[1].c);\n    return 0;\n}\n```\n\n\u603b\u7ed3\n-\n\n\u5584\u7528define",
        "postTime": 1522536602,
        "uid": 48036,
        "name": "\u79cb\u65e5\u79c1\u8bed",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "## \u524d\u94fa\uff1a\n\n\u521a\u5b66\u4e86\u666e\u901a\u5e73\u8861\u6811\u60f3\u6765\u8e6d\u70b9\u7ecf\u9a8c\uff0c\u5199\u7740\u5199\u7740\u8499\u4e86\uff0c\u6765\u5230\u9898\u89e3\u533a\u4e00\u770b\uff0c\u4e3a\u4ec0\u4e48\u90fd\u662f\u5404\u79cd STL \u6216\u53d8\u79cd\u7684\u5e73\u8861\u6811\uff0c\u8ba9\u6211\u8fd9\u4e2a\u53ea\u4f1a\u666e\u901a\u5e73\u8861\u6811\u7684\u4eba\u4e00\u5934\u96fe\u6c34\u3002\u5f85\u6211\u7528\u666e\u901a\u5e73\u8861\u6811\u8c03\u4e86\u534a\u5929\u7ec8\u4e8e AC \u540e\uff0c\u51b3\u5b9a\u5199\u7bc7\u666e\u901a\u5e73\u8861\u6811\u7684\u9898\u89e3\u9020\u798f\u4e00\u4e0b\u522b\u4eba\u3002\n\nPS\uff1a\u672c\u7bc7\u9898\u89e3\u9002\u5408\u521a\u5b66\u666e\u901a\u5e73\u8861\u6811\u6216\u6ca1\u6709\u601d\u8def\u7684\u540c\u5b66\uff0c\u5982\u679c\u4f60\u8fd8\u4e0d\u4f1a\u666e\u901a\u5e73\u8861\u6811\uff0c\u4f60\u53ef\u4ee5\u7528\u522b\u7684\u5927\u4f6c\u7684\u65b9\u6cd5\u6216\u51fa\u95e8\u5de6\u8f6c [luogu P3369](https://www.luogu.com.cn/problem/P3369)\u3002\n\n---\n\n## \u601d\u8def\uff1a\n\n\u4e3a\u4ec0\u4e48\u8981\u7528\u5e73\u8861\u6811\uff1f\u6211\u4eec\u77e5\u9053\u5e73\u8861\u6811\u9002\u7528\u4e8e\u4e00\u6bb5\u5e8f\u5217\u7684\u67e5\u627e\u3001\u6392\u5e8f\u3001\u63d2\u5165\u4ee5\u53ca\u5220\u9664\u3002\u6211\u4eec\u53ef\u4ee5\u5c06\u9898\u9762\u5f53\u4e2d\u7684\u6bcf\u6735\u82b1\u770b\u6210\u662f\u4e00\u4e2a\u6570\uff0c\u7136\u540e\u6211\u4eec\u5c31\u77e5\u9053\u4e86\u6211\u4eec\u4ec5\u987b\u652f\u6301\u63d2\u5165\u548c\u5220\u9664\u64cd\u4f5c\u5373\u53ef\uff08\u4e0d\u9700\u8981 size \uff09\uff0c\u4f46\u5220\u9664\u7684\u662f\u5f53\u524d\u7684\u6700\u5927\u503c\u6216\u6700\u5c0f\u503c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u63d2\u5165\u6570\u540e\uff0c\u7528\u5e73\u8861\u6811\u8fdb\u884c\u5f53\u524d\u82b1\u6735\u7684\u4ef7\u683c\u7684\u6392\u5e8f\u5e76\u627e\u51fa\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\u3002\n\n## \u63d0\u793a\uff1a\n\n\u5982\u679c\u4f60\u5df2\u7ecf\u7528\u5e73\u8861\u6811\u5199\u51fa\u4ee3\u7801\uff0c\u4f46\u8c03\u8bd5\u4e0d\u51fa\u6765\uff0c\u4f60\u4e0d\u59a8\u53ef\u4ee5\u770b\u770b\u4ee5\u4e0b\u51e0\u70b9\u63d0\u793a\uff1a\n\n- \u9898\u9762\u4e2d 2 \u548c 3 \u64cd\u4f5c\u6362\u4e86\u4e0b\u4f4d\u7f6e\u3002\n- \u6dfb\u52a0\u4e00\u6735\u82b1\u8bb0\u5f97\u8fdb\u884c\u6807\u8bb0\u770b\u662f\u5426\u6709\u91cd\u590d\u3002\n- \u5220\u9664\u4e00\u6735\u82b1\u65f6\u8bb0\u5f97\u6807\u8bb0\u8981\u91cd\u7f6e\u3002\n- \u975e\u9012\u5f52\u7684\u5220\u9664\u64cd\u4f5c\u5f88\u4e0d\u53cb\u597d\uff0c**\u5efa\u8bae**\u6539\u6210\u9012\u5f52\u3002\n\n\u4ee5\u4e0a\u5c31\u662f\u6211\u5728\u505a\u9898\u65f6\u9047\u5230\u7684\u4e00\u4e9b\u5751\uff0c\u770b\u770b\u6709\u6ca1\u6709\u4e2d\u62db\u7684\u3002\n\n## \u4ee3\u7801\u51fd\u6570\u8be6\u89e3\uff1a\n\n### add \u65b0\u5efa\u8282\u70b9\uff1a\n\n\u5728\u65b0\u5efa\u8282\u70b9\u65f6\uff0c\u8bb0\u5f97\u5c06\u6c42\u548c\u7684\u53d8\u91cf ```sum_c,sum_w``` \u52a0\u4e0a\u5bf9\u5e94\u503c,\u4ee5\u53ca\u8fdb\u884c\u6807\u8bb0\u5df2\u5728\u82b1\u675f\u4e2d\uff1a\n```cpp\nint add(int w,int c)\n{\n\tt[++tot].c=c,t[tot].w=w,sum_w+=w,sum_c+=c,vis[c]=1;\n\treturn tot; \n}  \n ```\n\n### del \u5220\u9664\u64cd\u4f5c\uff1a\n\n\u8fd9\u9898\u7684\u91cd\u70b9\u5c31\u662f\u5220\u9664\u64cd\u4f5c\uff0c\u9996\u5148\u8981\u660e\u767d\u5982\u4f55\u5728\u4e00\u9897\u5e73\u8861\u6811\u4e2d\u627e\u5230\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\uff0c\u56e0\u4e3a\u4e00\u9897\u5e73\u8861\u6811\u4e5f\u662f\u4e00\u9897\u4e8c\u53c9\u6392\u5e8f\u6811\uff0c\u6240\u4ee5\u5b83\u6ee1\u8db3\u5de6\u5b69\u5b50\u5c0f\u4e8e\u7236\u4eb2\uff0c\u53f3\u5b69\u5b50\u5927\u4e8e\u7236\u4eb2\u7684\u6027\u8d28\u3002\u90a3\u4e48**\u6700\u5927\u503c\u5373\u4e3a\u6700\u6709\u7684\u8282\u70b9\uff0c\u6700\u5c0f\u503c\u5373\u4e3a\u6700\u5de6\u7684\u8282\u70b9\uff08\u89c1\u4e0b\u56fe\uff09**\uff0c\u7136\u540e\u76f4\u63a5\u50cf\u5220\u9664\u53ea\u6709\u4e00\u4e2a\u5b69\u5b50\u7684\u8282\u70b9\u90a3\u6837\uff0c\u8ba9\u5b69\u5b50\u8282\u70b9\u66ff\u4ee3\u7236\u4eb2\u8282\u70b9,\u518d\u51cf\u53bb\u5b83\u7684\u6f02\u4eae\u503c\u4e0e\u4ef7\u683c\uff0c\u91cd\u7f6e\u6807\u8bb0\u3002\n\n![](https://s2.ax1x.com/2020/03/06/3q32nJ.png)\n\n```cpp\nvoid del_min(int &x)\n{\n\tif(t[x].l)\n\t\tdel_min(t[x].l);//\u5982\u679c\u5b83\u8fd8\u6709\u6bd4\u5b83\u5c0f\u7684\u5de6\u513f\u5b50\uff0c\u5219\u627e\u9012\u5f52\u5b83\u7684\u5de6\u5b50\u6811\n\telse \n\t{\n\t\tsum_c-=t[x].c;\n\t\tsum_w-=t[x].w;\n\t\tvis[t[x].c]=0;\n\t    x=t[x].r;\n\t}\n}\n\nvoid del_max(int &x)\n{\n\tif(t[x].r)\n\t\tdel_max(t[x].r);//\u5982\u679c\u5b83\u8fd8\u6709\u6bd4\u5b83\u5927\u7684\u53f3\u513f\u5b50\uff0c\u5219\u627e\u9012\u5f52\u5b83\u7684\u53f3\u5b50\u6811\n\telse \n\t{\n\t\tsum_c-=t[x].c;\n\t\tsum_w-=t[x].w;\n\t\tvis[t[x].c]=0;\n\t\tx=t[x].l;\n\t}\n}\n```\n\n## \u5b8c\u6574\u4ee3\u7801\uff1a\n\n```cpp\n#include<stdio.h>\n#include<algorithm>\n#include<cstdlib>\nusing namespace std;\n\nconst int N=1e5+86; \n\nint n,tot,root,vis[1000001];\nint sum_w,sum_c;\n\nstruct Treap\n{\n\tTreap()\n\t{\n\t\tpri=rand()*rand()%20061124;\n\t\tl=r=0;\n\t}//\u6784\u9020\u51fd\u6570\n\tint l;\n\tint r;\n\tint pri;\n\tint c;\n\tint w;\n}t[N];\n\nint add(int w,int c)//\u65b0\u5efa\u8282\u70b9\n{\n\tt[++tot].c=c,t[tot].w=w,sum_w+=w,sum_c+=c,vis[c]=1;\n\treturn tot; \n}\n\nvoid right_rorate(int &x)//\u53f3\u65cb\n{\n\tint tmp=t[x].l;\n\tt[x].l=t[tmp].r;\n\tt[tmp].r=x;\n\tx=tmp;\n}\n\nvoid left_rorate(int &x)//\u5de6\u65cb\n{\n\tint tmp=t[x].r;\n\tt[x].r=t[tmp].l;\n\tt[tmp].l=x;\n\tx=tmp;\n}\n\nvoid insert(int &x,int w,int c)//\u63d2\u5165\u64cd\u4f5c\n{\n\tif(x==0)\n\t{\n\t\tx=add(w,c);\n\t\treturn;\n\t}\n\tif(c>=t[x].c)\n\t\tinsert(t[x].r,w,c);\n\telse\n\t\tinsert(t[x].l,w,c);\n\tif(t[x].r&&t[t[x].r].pri<t[x].pri)\n\t\tleft_rorate(x);\n\tif(t[x].l&&t[t[x].l].pri<t[x].pri)\n\t\tright_rorate(x);\n}\n\nvoid del_min(int &x)//\u5220\u9664\u5f53\u524d\u6700\u5c0f\u503c\n{\n\tif(t[x].l)\n\t\tdel_min(t[x].l);\n\telse \n\t{\n\t\tsum_c-=t[x].c;\n\t\tsum_w-=t[x].w;\n\t\tvis[t[x].c]=0;\n\t\tx=t[x].r;\n\t}\n}\n\nvoid del_max(int &x)//\u5220\u9664\u5f53\u524d\u6700\u5927\u503c\n{\n\tif(t[x].r)\n\t\tdel_max(t[x].r);\n\telse \n\t{\n\t\tsum_c-=t[x].c;\n\t\tsum_w-=t[x].w;\n\t\tvis[t[x].c]=0;\n\t\tx=t[x].l;\n\t}\n}\n\nint main()\n{\n\tint opt;\n\twhile(scanf(\"%d\",&opt)==1)\n\t{\n\t\tif(opt==-1) break;\n\t\tif(opt==1)\n\t\t{\n\t\t\tint w,c;\n\t\t\tscanf(\"%d%d\",&w,&c);\n\t\t\tif(vis[c]) continue;//\u5982\u679c\u91cd\u590d\u5219\u8df3\u8fc7\u4e0d\u63d2\u5165\n\t\t\tinsert(root,w,c);\n\t\t}\n\t\telse if(opt==3)\n\t\t\tdel_min(root);\n\t\telse if(opt==2)\n\t\t\tdel_max(root);\n\t}            \n\tprintf(\"%d %d\\n\",sum_w,sum_c);\n\treturn 0;\n}\n```\n\n\u611f\u8c22\u5927\u5bb6\u9605\u8bfb\uff0c\u5e0c\u671b\u80fd\u5e2e\u5230\u5927\u5bb6\uff01\n\n ",
        "postTime": 1583476876,
        "uid": 218037,
        "name": "\u9e3f\u6d771001",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "> \u7ec8\u4e8eA\u4e86\uff01\uff01\uff01\n\n5\u4e2a\u5b50\u7a0b\u5e8f\u3002\n\n\u7b97\u6cd5\uff1a\u5e73\u8861\u6811\n\n\u63d2\u5165\u5c31\u662f\u5e73\u8861\u6811\u6392\u5e8f\u6a21\u677f\u505a\u6cd5\u3002\n\n\u5220\u9664\u5c31\u662f\u5f80\u4e0b\u627e\u8282\u70b9\u3002\n\n\u5220\u5c0f\u7684\u548c\u5220\u5927\u7684\u5dee\u4e0d\u591a\uff0c\u4e00\u4e2a\u5f80\u5de6\uff0c\u4e00\u4e2a\u5f80\u53f3\u561b~\n\n\u8fd8\u6709\u4e00\u4e9b\u7ec6\u8282\u6ce8\u610f\u4e00\u4e0b\u5c31\u597d\u4e86\u3002\n\n```\n#include <bits/stdc++.h>\n#define re register\nusing namespace std;\n//\u4ef7\u683c\u5728\u6b64\u533a\u95f4\u7684\u6709\u51e0\u4e2a    \u5de6\u8282\u70b9\u7f16\u53f7    \u53f3\u8282\u70b9\u7f16\u53f7  \u7f16\u53f7\u603b\u6570       \nlong long int a[1000001],al[1000001],ar[1000001],an=1;\n//              \u7f8e\u4e3d\u503c     \u4ef7\u683c       \u7236\u8282\u70b9\u7f16\u53f7 \nlong long int ml[1000001],jg[1000001],f[1000001];\nconst int minn=1,maxn=1000000;\nlong long int answ,ansc;\ninline void pushupp(int k){//\u4ecep\u5f80\u4e0a\u52a0 a[] \n\twhile(k){\n\t\ta[k]++;\n\t\tk=f[k];\n\t}\n\treturn;\n}\ninline void ins(int mlz,int k){//\u63d2\u5165\uff1a\u7f8e\u4e3d\u503c\u3001\u4ef7\u683c \n\tint p=1,pl=minn,pr=maxn;\n\twhile(pl<pr){\n\t\tint mid=(pl+pr)/2;\n\t\tif(k<=mid){\n\t\t\tif(al[p]==0){\n\t\t\t\tan++;\n\t\t\t\tal[an]=0;\n\t\t\t\tar[an]=0;\n\t\t\t\tal[p]=an;\n\t\t\t}\n\t\t\tf[al[p]]=p;p=al[p];pr=mid;\n\t\t}\n\t\telse{\n\t\t\tif(ar[p]==0){\n\t\t\t\tan++;\n\t\t\t\tal[an]=0;\n\t\t\t\tar[an]=0;\n\t\t\t\tar[p]=an;\n\t\t\t}\n\t\t\tf[ar[p]]=p;p=ar[p];pl=mid+1;\n\t\t}\n\t}\n\tif(ml[p]==0){//\u4fdd\u8bc1\u6ca1\u6709\u540c\u4ef7\u94b1\u7684\u82b1\n\t\tpushupp(p);\n\t\tml[p]=mlz;\n\t\tjg[p]=k;\n\t\tansw+=mlz;\n\t\tansc+=k;\n\t}\n\treturn;\n}\ninline void pushup(int p){//\u4ecep\u5f80\u4e0a\u51cf a[]\n\twhile(p){\n\t\ta[p]--;\n\t\tp=f[p];\n\t}\n\treturn;\n}\ninline int del_e(int p){//\u5220\u9664\u8d35\u7684\u82b1 \n\tlong long int ansh=0;\n\twhile(1){\n\t\tif(ml[p])ansh=p;//\u6709\u82b1 \n\t\tif(ar[p]&&a[ar[p]])p=ar[p];//\u8fd8\u6709\u66f4\u8d35\u7684\u82b1 \n\t\telse if(ansh==0&&al[p])p=al[p];//\u6ca1\u82b1 \n\t\tif(ansh&&ar[p]==0)break;//\u6709\u82b1\u4e14\u6ca1\u6709\u66f4\u8d35\u7684\u82b1\u4e86 \n\t}\n\treturn ansh;\n}\ninline int del_c(int p){//\u5220\u9664\u4fbf\u5b9c\u7684\u82b1 \n\tlong long int ansh=0;\n\twhile(1){\n\t\tif(ml[p])ansh=p;//\u6709\u82b1 \n\t\tif(al[p]&&a[al[p]])p=al[p];//\u8fd8\u6709\u66f4\u4fbf\u5b9c\u7684\u82b1 \n\t\telse if(ansh==0&&ar[p])p=ar[p];//\u6ca1\u82b1 \n\t\tif(ansh&&al[p]==0)break;//\u6709\u82b1\u4e14\u6ca1\u6709\u66f4\u4fbf\u5b9c\u7684\u82b1\u4e86 \n\t}\n\treturn ansh;\n}\nint main(void){\n\tlong long int op,w,c;\n\twhile(cin>>op){\n\t\tif(op==-1)break;\n\t\telse if(op==1)cin>>w>>c,ins(w,c);\n\t\t\telse if(op==2&&a[1]){\n\t\t\t\tint ansh;\n\t\t\t\tansh=del_e(1);\n\t\t\t\tif(ansh){\n\t\t\t\t\tansw-=ml[ansh];\n\t\t\t\t\tansc-=jg[ansh];\n\t\t\t\t\tjg[ansh]=0;\n\t\t\t\t\tml[ansh]=0;\n\t\t\t\t\tpushup(ansh);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\telse if(op==3&&a[1]){\n\t\t\t\t\tint ansh;\n\t\t\t\t\tansh=del_c(1);\n\t\t\t\t\tif(ansh){\n\t\t\t\t\t\tansw-=ml[ansh];\n\t\t\t\t\t\tansc-=jg[ansh];\n\t\t\t\t\t\tal[ansh]=0;\n\t\t\t\t\t\tar[ansh]=0;\n\t\t\t\t\t\tjg[ansh]=0;\n\t\t\t\t\t\tml[ansh]=0;\n\t\t\t\t\t\tpushup(ansh);\n\t\t\t\t\t}\n\t\t\t\t}\n\t}\n\tcout<<answ<<\" \"<<ansc<<endl; \n\treturn 0;\n}\n```\n",
        "postTime": 1566220284,
        "uid": 114504,
        "name": "\u68a6\u91cc\u8c03\u97f3",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "## \u770b\u5230\u6ca1\u4eba\u5199\u6307\u9488\u7248FHQTreap\uff0c\u6211\u6765\u5199\u4e00\u53d1\n\n~~***debug\u7684\u65f6\u5019\uff0c\u6307\u9488\u7248\u6570\u636e\u7ed3\u6784\u76f4\u63a5\u6dfb\u52a0\u67e5\u770b\u8fd9\u4e2a\u6307\u9488\u5c31\u628a\u6307\u9488\u6240\u6307\u7ed3\u6784\u4f53\u7684\u6240\u6709\u53d8\u91cf\u5168\u90fd\u663e\u793a\u51fa\u6765\u4e86\uff0c\u4e3a\u4ec0\u4e48\u6ca1\u591a\u5c11\u4eba\u7528\u554a\u3002\u3002***~~\n\n### \u524d\u7f6e\u77e5\u8bc6\uff1a\u65e0\u65cbTreap\uff0c\u53ef\u4ee5\u770b\u6211[\u535a\u5ba2](https://www.cnblogs.com/Juruo1103/p/10281403.html)\n\n### \u9898\u76ee\u8981\u6c42\uff1a\u8d44\u74f7\u63d2\u5165\u8282\u70b9\uff0c\u5220\u9664\u6700\u503c\n\n\u7ef4\u62a4\u4e00\u68f5$FHQTreap$\uff0c\u5e76\u5b58\u50a8$w$\u548c$c$\u7684\u603b\u503c\n\n#### \u63d2\u5165\u8282\u70b9\uff1a\n\n\u5148\u5728\u8fd9\u68f5\u6811\u67e5\u627e$c$\uff0c\u5982\u679c\u6709\u76f4\u63a5\u8fd4\u56de\uff0c\u53d6\u6d88\u63d2\u5165\uff08\u5212\u91cd\u70b9\uff09  \n\u7136\u540e\u5c31\u53ef\u4ee5\u6b63\u5e38\u50cf$FHQTreap$\u4e00\u6837\u67e5\u6392\u540d\u5206\u88c2\u5408\u5e76\u4e86\uff0c\u6ce8\u610f\u66f4\u65b0$total$\u503c\n\n#### \u5220\u9664\u6700\u503c\uff1a\n\n\u6ce8\u610f\u5224\u7a7a\u6839\uff0c\u6ce8\u610f\u66f4\u65b0$total$\u503c\uff0c\u6b63\u5e38\u5206\u88c2\u51fa\u4e00\u4e2a\u8282\u70b9\u5220\u9664\u5373\u53ef\n\n### \u6700\u540e\u653e\u51fa\u5b8c\u6574\u4ee3\u7801\n\n```cpp\n// luogu-judger-enable-o2\n#include <stdio.h>\n\nint Rand() {\n    static int seed = 2333333;\n    return seed = (((seed | 66666) + 19260817ll) * 1433223ll) % 0x7f7f7f7f;\n}\n\nnamespace FHQ{\n    int totw = 0, totc = 0;\n\n    struct Node{\n        int w, c, size, key;\n        Node *child[2];\n        Node(int w, int c):w(w), c(c), size(1), key(Rand()) {child[0] = child[1] = NULL;}\n    };\n\n    Node *root = NULL;\n\n    void Update(Node *now) {\n        now->size = 1;\n        now->size += now->child[0] ? now->child[0]->size : 0;\n        now->size += now->child[1] ? now->child[1]->size : 0;\n    }\n\n    void Split(Node *now, int k, Node *&t1, Node *&t2) {\n        if (!now) {\n            t1 = t2 = NULL; return;\n        }\n        if (k == 0) {\n            t1 = NULL; t2 = now; return;\n        }\n        if (k >= now->size) {\n            t1 = now; t2 = NULL; return;\n        }\n        int ls = now->child[0] ? now->child[0]->size : 0;\n        if (k <= ls) {\n            Node *temp;\n            Split(now->child[0], k, t1, temp); \n            t2 = now; t2->child[0] = temp; Update(t2); return;\n        } else {\n            Node *temp;\n            Split(now->child[1], k - ls - 1, temp, t2);\n            t1 = now; t1->child[1] = temp; Update(t1); return;\n        }\n    }\n\n    Node *Merge(Node *a, Node *b) {\n        if (!a || !b) return a ? a : b;\n        if (b->key > a->key) {\n            a->child[1] = Merge(a->child[1], b);\n            Update(a); return a;\n        } else {\n            b->child[0] = Merge(a, b->child[0]);\n            Update(b); return b;\n        }\n    }\n\n    int Rank(Node *now, int k) {\n        if (!now) return 1;\n        int ls = now->child[0] ? now->child[0]->size : 0;\n        if (k < now->c) return Rank(now->child[0], k);\n        else if (k > now->c) return Rank(now->child[1], k) + ls + 1;\n        else return ls + 1;\n    }\n\n    bool Insert(int w, int c) {\n        if (!root) {\n            root = new Node(w, c);\n            totw += w; totc += c;\n            return true;\n        }\n        if (root) {\n            Node *now = root;\n            while (now) {\n                if (c < now->c) now = now->child[0];\n                else if (c > now->c) now = now->child[1];\n                else return false;\n            }\n        }\n        Node *temp = new Node(w, c);\n        int rank = Rank(root, c);\n        Node *lt, *rt;\n        Split(root, rank - 1, lt, rt);\n        root = Merge(lt, Merge(temp, rt));\n        totw += w; totc += c;\n        return true;\n    }\n\n    void DelMax() {\n        if (!root) return;\n        Node *lt, *rt;\n        Split(root, root->size - 1, lt, rt);\n        root = lt; totw -= rt->w; totc -= rt->c;\n        delete rt; return;\n    }\n\n    void DelMin() {\n        if (!root) return;\n        Node *lt, *rt;\n        Split(root, 1, lt, rt);\n        root = rt; totw -= lt->w; totc -= lt->c;\n        delete lt; return;\n    }\n}\n\nint main() {\n    int opt = 0, w, c;\n    while (scanf(\"%d\", &opt), opt != -1) {\n        switch(opt) {\n            case 1: {\n                scanf(\"%d %d\", &w, &c);\n                FHQ::Insert(w, c);\n                break;\n            }\n            case 2: {\n                FHQ::DelMax();\n                break;\n            }\n            case 3: {\n                FHQ::DelMin();\n                break;\n            }\n        }\n    }\n    printf(\"%d %d\\n\", FHQ::totw, FHQ::totc);\n    return 0;\n}\n/*\n1 1 1\n1 2 5\n2\n1 3 3\n3\n1 5 2\n-1\n*/\n```\n\n\u8f93\u5165$opt$\u90a3\u91cc\u538b\u4e86\u4e00\u4e0b\u884c\uff0c\u56e0\u4e3a$while$\u91cc\u6709\u9017\u53f7\u662f\u8fd4\u56de\u6700\u540e\u4e00\u53e5\u7684$true/false$",
        "postTime": 1548942773,
        "uid": 126376,
        "name": "Irelia\u10e6",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "### [\u66f4\u597d\u7684\u9605\u8bfb](https://www.cnblogs.com/yzhang-rp-inf/p/10017405.html)\n\n### [\u539f\u9898\u4f20\u9001\u95e8](https://www.luogu.org/problemnew/show/P2073)\n\n### \u8fd9\u9898\u9700\u8981\u7528\u5230[Splay](https://www.cnblogs.com/yzhang-rp-inf/p/9957906.html)\n\n\u6211\u4eec\u7528\u4e00\u68f5splay\u7ef4\u62a4\u91d1\u94b1\n\n\u8003\u8651c<=1000000\n\n\u6211\u4eec\u73c2\u4ee5\u628a\u6bcf\u79cd\u4ef7\u683c\u73b0\u5728\u5bf9\u5e94\u7684\u7f8e\u4e3d\u503c\u5b58\u5728\u4e00\u4e2aa\u6570\u7ec4\u4e2d\n\n\u8fd9\u6837\u8bb2\u6709\u73c2\u80fd\u4e0d\u592a\u6e05\u695aqaq\uff0c\u8fd8\u662f\u5bf9\u7740\u64cd\u4f5c\u4e00\u4e2a\u4e00\u4e2a\u8bb2\n\n\u64cd\u4f5c\u4e00\uff1a\n\n\u5148\u5728\u8fd9\u68f5splay\u4e2d\u67e5\u627e\u662f\u5426\u6709\u8fd9\u79cd\u82b1\u7684\u91d1\u94b1\n\n\u5982\u679c\u6709\uff0c\u76f4\u63a5\u8df3\u8fc7\n\n\u5982\u679c\u6ca1\u6709\uff0ca[c]=m\uff0c\u628a\u91d1\u94b1\u4e3ac\u7684\u82b1\u7684\u7f8e\u4e3d\u503c\u5b58\u4e0b\uff0c\u628a\u4e24\u4e2a\u6240\u6c42\u7b54\u6848\u66f4\u65b0\uff0c\u628ac\u63d2\u5165\u5e73\u8861\u6811\n\n\u64cd\u4f5c2,3\uff1a\n\n\u6267\u884c\u6240\u6709\u64cd\u4f5c\u4e4b\u524d\u5148\u628ainf\uff0c-inf\u63d2\u5165\u5e73\u8861\u6811\n\n\u5220\u9664\u6700\u5c0f\u5c31\u662f\u5220\u9664-inf\u7684\u540e\u7ee7\uff0c\u5220\u9664\u6700\u5927\u5c31\u662f\u5220\u9664inf\u7684\u524d\u9a71\n\n\u4f46\u8fd8\u8981\u52a0\u4e0a\u7279\u5224\uff0c\u5728\u540e\u7ee7\uff08\u524d\u9a71\uff09\u4e0d\u7b49\u4e8einf\uff08-inf\uff09\u7684\u60c5\u51b5\u4e0b\uff0c\u66f4\u65b0\u7b54\u6848\uff0ca\u6570\u7ec4\u53d8\u62100\uff0c\u628a\u8be5\u8282\u70b9\u4ece\u5e73\u8861\u6811\u4e2d\u5220\u9664\n\n### \u5b8c\u6574\u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define inf 1000000005\n#define N 100005\n#define root tree[0].ch[1]\nusing namespace std;\ninline char nc(){\n    static char buf[100000],*p1=buf,*p2=buf; \n    return p1==p2&&(p2=(p1=buf)+fread(buf,1,100000,stdin),p1==p2)?EOF:*p1++; \n}\ninline int read()\n{\n    register int x=0,f=1;register char ch=nc();\n    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=nc();}\n    while(ch>='0'&&ch<='9')x=(x<<3)+(x<<1)+ch-'0',ch=nc();\n    return x*f;\n}\ninline void write(register int x)\n{\n    if(!x)putchar('0');if(x<0)x=-x,putchar('-');\n    static int sta[20];register int tot=0;\n    while(x)sta[tot++]=x%10,x/=10;\n    while(tot)putchar(sta[--tot]+48);\n}\nstruct Splay{\n    int v,fa,ch[2],sum;\n}tree[N];\nint tot;\ninline bool findd(register int x)\n{\n    return x==tree[tree[x].fa].ch[0]?0:1;\n}\ninline void connect(register int x,register int fa,register int son)\n{\n    tree[x].fa=fa;\n    tree[fa].ch[son]=x;\n}\ninline void update(register int x)\n{\n    tree[x].sum=tree[tree[x].ch[0]].sum+tree[tree[x].ch[1]].sum+1;\n}\ninline void rotate(register int x)\n{\n    int Y=tree[x].fa;\n    int R=tree[Y].fa;\n    int Yson=findd(x);\n    int Rson=findd(Y);\n    int B=tree[x].ch[Yson^1];\n    connect(B,Y,Yson);\n    connect(Y,x,Yson^1);\n    connect(x,R,Rson);\n    update(Y),update(x);\n}\ninline void splay(register int x,register int to)\n{\n    to=tree[to].fa;\n    while(tree[x].fa!=to)\n    {\n        int y=tree[x].fa;\n        if(tree[y].fa==to)\n            rotate(x);\n        else if(findd(x)==findd(y))\n            rotate(y),rotate(x);\n        else\n            rotate(x),rotate(x);\n    }\n}\ninline int newpoint(register int v,register int fa)\n{\n    tree[++tot].fa=fa;\n    tree[tot].v=v;\n    tree[tot].sum=1;\n    return tot;\n}\ninline void Insert(register int x)\n{\n    int now=root;\n    if(root==0)\n    {\n        newpoint(x,0);\n        root=tot;\n    }\n    else\n    {\n        while(19260817)\n        {\n            ++tree[now].sum;\n            int nxt=x<tree[now].v?0:1;\n            if(!tree[now].ch[nxt])\n            {\n                int p=newpoint(x,now);\n                tree[now].ch[nxt]=p;\n                splay(p,root);\n                return;\n            }\n            now=tree[now].ch[nxt];\n        }\n    }\n}\ninline int find(register int v)\n{\n    int now=root;\n    while(19260817)\n    {\n        if(tree[now].v==v)\n        {\n            splay(now,root);\n            return now;\n        }\n        int nxt=v<tree[now].v?0:1;\n        if(!tree[now].ch[nxt])\n            return 0;\n        now=tree[now].ch[nxt];\n    }\n}\ninline void delet(register int x)\n{\n    int pos=find(x);\n    if(!pos)\n        return;\n    if(!tree[pos].ch[0]&&!tree[pos].ch[1])\n        root=0;\n    else if(!tree[pos].ch[0])\n    {\n        root=tree[pos].ch[1];\n        tree[root].fa=0;\n    }\n    else\n    {\n        int left=tree[pos].ch[0];\n        while(tree[left].ch[1])\n            left=tree[left].ch[1];\n        splay(left,tree[pos].ch[0]);\n        connect(tree[pos].ch[1],left,1);\n        connect(left,0,1);\n        update(left);\n    }\n}\ninline int lower(register int v)\n{\n    int now=root;\n    int ans=-inf;\n    while(now)\n    {\n        if(tree[now].v<v&&tree[now].v>ans)\n            ans=tree[now].v;\n        if(v>tree[now].v)\n            now=tree[now].ch[1];\n        else\n            now=tree[now].ch[0];\n    }\n    return ans;\n}\ninline int upper(register int v)\n{\n    int now=root;\n    int ans=inf;\n    while(now)\n    {\n        if(tree[now].v>v&&tree[now].v<ans)\n            ans=tree[now].v;\n        if(v<tree[now].v)\n            now=tree[now].ch[0];\n        else\n            now=tree[now].ch[1];\n    }\n    return ans;\n}\nint a[1000005];\nint main()\n{\n    Insert(inf);\n    Insert(-inf);\n    int opt=read(),ans1=0,ans2=0;\n    while(opt!=-1)\n    {\n        if(opt==1)\n        {\n            int w=read(),c=read();\n            if(!find(c))\n            {\n                ans1+=w,ans2+=c;\n                a[c]=w;\n                Insert(c);\n            }\n        }\n        else if(opt==2)\n        {\n            int c=lower(inf);\n            if(c!=-inf)\n            {\n                ans1-=a[c],ans2-=c;\n                a[c]=0;\n                delet(c);\n            }\n        }\n        else\n        {\n            int c=upper(-inf);\n            if(c!=inf)\n            {\n                ans1-=a[c],ans2-=c;\n                a[c]=0;\n                delet(c);\n            }\n        }\n        opt=read();\n    }\n    write(ans1),putchar(' '),write(ans2);\n    return 0;\n } \n```",
        "postTime": 1543151020,
        "uid": 37881,
        "name": "yzhang",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "~~\u6bd2\u7624\u9898\u76ee~~\n\n### \u4e3b\u8981\u601d\u8def\uff1a\u7ebf\u6bb5\u6811\uff08\u6743\u503c\u7ebf\u6bb5\u6811\uff09\n\n\u53ef\u80fd\u5f88\u591a\u540c\u5b66\u505a\u9898\u4e4b\u524d\u4f1a\u770b\u4e00\u4e0b\u9898\u76ee\u6807\u7b7e\u3002\n\n\u8fd9\u9898\u7684\u9898\u76ee\u6807\u7b7e\u5c31\u662f**\u7ebf\u6bb5\u6811**\u4e0e**\u5e73\u8861\u6811**\uff0c\u7136\u800c\u5199\u4e0d\u51fa\u6765\u4ee5\u540e\uff0c\u4e00\u770b\u9898\u89e3\u91cc\u5168\u662fSTL\uff0c\u4e00\u8138\u832b\u7136\uff0c\uff0c\uff0c\n\n#### \u6211\u8fd9\u91cc\u662f\u4e00\u7bc7\u6b63\u4e86\u516b\u7ecf\u7684\u7ebf\u6bb5\u6811\u89e3\u6cd5\u3002\n\n\u9996\u5148\u6211\u4eec\u8981\u770b\u6e05\u9898\uff1a\n\n\t1.\u64cd\u4f5c\u7684\u7f16\u53f7\u4e00\u5b9a\u4e0d\u80fd\u770b\u5012\uff0c\u4e0d\u80fd\u7406\u6240\u5f53\u7136\n    \n    2.\u8bb0\u5f97\u662f\u6709\u8fd9\u4e48\u4e00\u53e5\u8bdd\uff1a\u201c\u5982\u679c\u52a0\u5165\u7684\u82b1\u6735\u4ef7\u683c\u5df2\u7ecf\u4e0e\u82b1\u675f\u4e2d\u5df2\u6709\u82b1\u6735\u4ef7\u683c\u91cd\u590d\uff0c\u5219\u8fd9\u4e00\u6735\u82b1\u4e0d\u80fd\u52a0\u5165\u82b1\u675f\u3002\u201d\u4e00\u5b9a\u4e0d\u80fd\u5fd8\u4e86\uff01\uff01\uff01\n    \n\u9996\u5148\u6211\u4eec\u60f3\u4e00\u4e0b\u5982\u4f55\u63d2\u5165\u5220\u9664\u3002\n\n\u6211\u4eec\u770b\u9898\u76ee\u6570\u636e\u8303\u56f4\u53ef\u77e5\uff0cW,C<=1000000\uff0c\u8fd9\u5c31\u5f88\u597d\u4e86\uff0c\u65e2\u7136\u6211\u4eec\u9700\u8981\u6309\u6700\u5927\u6700\u5c0f\u6392\u94b1\u6570\uff0c\u6211\u4eec\u4e0d\u5982\u76f4\u63a5\u7ef4\u62a4\u4e00\u4e2a\u4ee5**\u82b1\u7684\u4ef7\u683c**\u4e3a\u6743\u503c\u7ebf\u6bb5\u6811\u6240\u7ef4\u62a4\u4fe1\u606f\u7684\u5e8f\u5217\u3002\u6ce8\u610f\uff1a\u6743\u503c\u7ebf\u6bb5\u6811\u7ef4\u62a4\u7684\u662f\u82b1\u7684\u4ef7\u683c\uff01\n\n\u7136\u540e\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u533a\u95f4\u91cc\u7684\u6700\u5927\u4ef7\u683c\u4e0e\u6700\u5c0f\u4ef7\u683c\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u65b9\u4fbf2,3\u64cd\u4f5c\u4e86\u3002\u6211\u4eec\u4e0d\u662f\u4e0d\u80fd\u91cd\u590d\u52a0\u5165\u5417\uff1f\u90a3\u6ca1\u5173\u7cfb\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u628a\u6bcf\u4e2a\u7ed3\u70b9\u7684\u533a\u95f4\u5185\u6700\u5927\u4ef7\u683c\u548c\u6700\u5c0f\u4ef7\u683c\u5206\u522b\u8bbe\u4e3a-INF\u548cINF\uff0c\u4f7f\u5f97\u53ea\u8981\u8fd9\u4e2a\u70b9\u4e2d\u6709\u4e00\u4e2a\u6570\u5c31\u53ef\u4ee5\u6539\u53d8\u4e4b\u524d\u521d\u59cb\u5316\uff0c\u90a3\u4e48\u6211\u4eec\u5728\u6bcf\u6b21\u63d2\u5165\u65f6\uff0c\u8bb0\u5f97\u5224\u65ad\u4e00\u4e0b\u533a\u95f4\u6700\u5927\u548c\u533a\u95f4\u6700\u5c0f\u548c\u5176\u4e2d\u7684\u4ef7\u683c\u6743\u503c\u662f\u5426\u662f\u521d\u59cb\u5316\u72b6\u6001\u5c31\u597d\u4e86\uff0c\u5982\u679c\u4e0d\u662f\u521d\u59cb\u5316\u72b6\u6001\uff0c\u5c31\u5e72\u8106\u4e0d\u6539\u4e86\u3002\n\n\u7136\u540e\u5c31\u662f\u2014\u2014\u2014\u2014\n### \u4ee3\u7801\u5b9e\u73b0\uff1a\n```cpp\n#include <algorithm>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <iostream>\n#include <map>\n#include <queue>\n#include <set>\n#include <stack>\n#include <string>\n#include <vector>\nusing namespace std;\n#define go(i, j, n, k) for (int i = j; i <= n; i += k)\n#define fo(i, j, n, k) for (int i = j; i >= n; i -= k)\n#define rep(i, x) for (int i = h[x]; i; i = e[i].nxt)\n#define mn 1000010\n#define inf 2147483647\n#define ll long long\n#define ld long double\n#define fi first\n#define se second\n#define root 1, 1000000, 1\n#define lson l, m, rt << 1\n#define rson m + 1, r, rt << 1 | 1\n#define bson l, r, rt\n//#define LOCAL\n#define mod \n#define Debug(...) fprintf(stderr, __VA_ARGS__)\ninline int read(){\n    int f = 1, x = 0;char ch = getchar();\n    while (ch > '9' || ch < '0'){if (ch == '-')f = -f;ch = getchar();}\n    while (ch >= '0' && ch <= '9'){x = x * 10 + ch - '0';ch = getchar();}\n    return x * f;\n}\n//This is AC head above...\nstruct tree{\n    int minn, maxx, sumw, sumc;\n} z[mn << 2];\ninline void update(int rt){\n    z[rt].minn = min(z[rt << 1].minn, z[rt << 1 | 1].minn);\n    z[rt].maxx = max(z[rt << 1].maxx, z[rt << 1 | 1].maxx);\n    z[rt].sumw = z[rt << 1].sumw + z[rt << 1 | 1].sumw;\n    z[rt].sumc = z[rt << 1].sumc + z[rt << 1 | 1].sumc;\n}\ninline void build(int l,int r,int rt){\n    if(l == r) {\n        z[rt].minn = inf;\n        z[rt].maxx = -inf;\n        z[rt].sumw = z[rt].sumc = 0;\n        return;\n    }\n    int m = (l + r) >> 1;\n    build(lson), build(rson), update(rt);\n}\ninline void modify_add(int l,int r,int rt,int c,int v){\n    if(l == r) {\n        if(z[rt].minn != inf || z[rt].maxx != -inf || z[rt].sumc){\n            return;\n        }\n        z[rt].minn = z[rt].maxx = c;\n        z[rt].sumw = v, z[rt].sumc = c;\n        return;\n    }\n    int m = (l + r) >> 1;\n    if(c <= m)\n        modify_add(lson, c, v);\n    else\n        modify_add(rson, c, v);\n    update(rt);\n}\ninline void modify_del(int l,int r,int rt,int c){\n    if(l == r) {\n        z[rt].minn = inf, z[rt].maxx = -inf;\n        z[rt].sumw = z[rt].sumc = 0;\n        return;\n    }\n    int m = (l + r) >> 1;\n    if(c <= m)\n        modify_del(lson, c);\n    else\n        modify_del(rson, c);\n    update(rt);\n}\nint vis[mn], tot, s;\nint main(){\n    build(root);\n    s = read();\n    while(s != -1){\n        if(s == 1){\n            int x = read(), y = read();\n            modify_add(root, y, x);\n        }else if(s == 2){\n            int maxx = z[1].maxx;\n            modify_del(root, maxx);\n        }else{\n            int minn = z[1].minn;\n            modify_del(root, minn);\n        }\n        s = read();\n    }\n    printf(\"%d %d\\n\", z[1].sumw, z[1].sumc);\n#ifdef LOCAL\n    Debug(\"\\nMy Time: %.3lfms\\n\", (double)clock() / CLOCKS_PER_SEC);\n#endif\n    return 0;\n}\n\n```",
        "postTime": 1538492547,
        "uid": 71168,
        "name": "yizimi\u8fdc\u6b23",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "\u554a\uff0c\u8eab\u4e3a\u53ea\u662f\u62ff\u5230\u4e86\u7701\u4e00\u7684\u849f\u84bb\uff0c\u6211\uff0c\u7ecf\u8fc74\u5929\u7684\u8270\u82e6\u594b\u6218\uff0c\u7ec8\u4e8eA\u4e86\u6b64\u9898\u3002\u3002\u3002\n\n\u6309\u637a\u4e0d\u4f4f\u5185\u5fc3\u559c\u60a6\uff0c\u7ed9\u540e\u6765\u4eba\u4e00\u4e2a\u501f\u9274\n\n\u7ecf\u5178 \u5e73\u8861\u6811 \u95ee\u9898\uff0c\u7528 Treap \u6216 Splay \u90fd\u53ef\u4ee5\u3002\n\n\u7b2c\u4e00\u5929\uff1a\uff08RE 0\uff09\\*4\n\n\u7b2c\u4e8c\u5929\uff1a\uff08RE 0\uff09\\*2+\uff08RE 60\uff09\\*2\n\n\u7b2c\u4e09\u5929\uff1a\uff08WA 0\uff09\\*2+\uff08WA 40\uff09\\*3\n\n\u7b2c\u56db\u5929\uff1a\uff08WA 0\uff09\\*1+\uff08WA 40\uff09\\*1+\uff08AC 100\uff09\\*1\n\n\u5b9e\u5728\u662f\u4e27\u5fc3\u75c5\u72c2\u7684\u9898\u76ee\u3002\u3002\u3002\n\n\u6ce8\u610f\uff1a\n\n1.\u4e0d\u8981\u5c06 \u64cd\u4f5c2 \u4e0e \u64cd\u4f5c3 \u5f04\u53cd\uff0c\u9898\u76ee\u6709\u6bd2\u3002\u3002\u3002\n\n2.\u6bcf\u79cd\u4ef7\u683c\u7684\u82b1\u53ea\u6709\u4e00\u4e2a\u3002\u3002\u3002\n\n\u7ed3\u6784\u4f53\u6307\u9488\u578b Treap ,\u8c8c\u4f3c\u6ca1\u6709\u4eba\u5199\uff0c\u6765\u4e00\u53d1\u3002\u3002\u3002\uff08\u5947\u4e11\u65e0\u6bd4\uff09\n\n\u6bcf\u4e2a\u8282\u70b9\u7ef4\u62a4\uff1a\u672c\u8eab\u7684\u4ef7\u683c\uff0c\u7f8e\u4e3d\u503c\uff0c\u5b50\u6811\u7684\u4ef7\u683c\u548c\u503c\uff0c\u7f8e\u4e3d\u503c\u548c\u503c\uff0c\u4e24\u4e2a\u513f\u5b50\u8282\u70b9\n\n\u4e4b\u540e\u5c31\u662f\u5957\u6a21\u677f\uff0c\u6539\u4e00\u6539\u5c31\u597d\u4e86\u3002\n\n\u9644\u4e0a\u82e6\u5fc3\u6572\u51fa\u7684AC\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\nusing namespace std;\nstruct node{\n    node* son[2];\n    int v,data,sum1,sum2,w;\n    node(){//\u8282\u70b9\u521d\u59cb\u5316\n        son[0]=son[1]=NULL;\n        w=rand();\n        v=data=sum1=sum2=0;\n    }\n};\nnode* rt;\ninline int read(){//\u8bfb\u4f18\u3002\u3002\u3002\n    int date=0,w=1;char c=0;\n    while(c<'0'||c>'9'){if(c=='-')w=-1;c=getchar();}\n    while(c>='0'&&c<='9'){date=date*10+c-'0';c=getchar();}\n    return date*w;\n}\nvoid maintain(node* &u){//\u7ed3\u70b9\u7ef4\u62a4\n    u->sum1=u->v;u->sum2=u->data;\n    if(u->son[0]!=NULL){//\u7b2c\u4e00\u5929\u5fd8\u4e86\u5224\u65ad\uff0cRE \u3002\u3002\u3002\n        u->sum1+=u->son[0]->sum1;\n        u->sum2+=u->son[0]->sum2;\n    }\n    if(u->son[1]!=NULL){\n        u->sum1+=u->son[1]->sum1;\n        u->sum2+=u->son[1]->sum2;\n    }\n}\nvoid turn(node* &u,int f){//\u65cb\u8f6c\n    node* t=u->son[f^1];\n    u->son[f^1]=t->son[f];\n    t->son[f]=u;\n    maintain(u);\n    maintain(t);\n    u=t;\n}\nbool insert(node* &u,int w,int c){//\u63d2\u5165\n    if(u==NULL){\n        u=new node;\n        u->v=c;u->data=w;\n        maintain(u);//\u7b2c\u4e09\u5929\u5fd8\u4e86\u7ef4\u62a4\uff0cWA 40 \u3002\u3002\u3002\n        return true;\n    }\n    else if(u->v==c)return false;//\u5224\u91cd\n    int y=c>u->v?1:0;\n    bool f=insert(u->son[y],w,c);\n    if(u->son[y]->w>u->w)turn(u,y^1);\n    if(u!=NULL)maintain(u);\n    return f;\n}\nvoid remove(node* &u,int x,int y){//\u5220\u9664\n    if(u==NULL)return;\n    if(u->v==x){\n        if(u->son[0]==NULL&&u->son[1]==NULL)u=NULL;\n        else if(u->son[0]!=NULL&&u->son[1]!=NULL){\n            if(u->son[0]->w>u->son[1]->w){\n                turn(u,1);\n                remove(u->son[1],x,y);\n            }\n            else{\n                turn(u,0);\n                remove(u->son[0],x,y);\n            }\n        }\n        else{\n            if(u->son[0]==NULL)u=u->son[1];\n            else u=u->son[0];\n        }\n        if(u!=NULL)maintain(u);\n        return;\n    }\n    u->sum1-=x;u->sum2-=y;\n    if(x<u->v)remove(u->son[0],x,y);\n    else if(x>u->v)remove(u->son[1],x,y);\n    if(u!=NULL)maintain(u);\n}\nvoid find(node* u,int k,int &x,int &y){//\u67e5\u8be2\n    if(k)while(u->son[0]!=NULL)u=u->son[0];\n    else while(u->son[1]!=NULL)u=u->son[1];\n    x=u->v;y=u->data;\n}\nint main(){\n    srand(987);//\u968f\u673a\u79cd\u5b50\n    int x,y,z,m=0;\n    while(1){\n        scanf(\"%d\",&x);\n        if(x==-1)break;\n        if(x==1){\n            scanf(\"%d%d\",&y,&z);\n            if(insert(rt,y,z))m++;\n            continue;//\u611f\u89c9\u8fd9\u6837\u597d\u4f4e\u7aef\uff0c\u7136\u800c\u80fd\u8fc7\u5c31\u884c\u4e86\u3002\u3002\u3002\n        }\n        if(m==0)continue;//\u7b2c\u4e8c\u5929\u6ca1\u6709\u8fd9\u53e5\uff0cWA 60 \u3002\u3002\u3002\n        m--;\n        find(rt,(x==3?1:0),y,z);\n        remove(rt,y,z);\n    }\n    if(rt==NULL)printf(\"0 0\\n\");//\u7b2c\u4e8c\u5929\u4e5f\u5fd8\u4e86\u8fd9\u53e5\uff0cRE 0 \u3002\u3002\u3002\n    else printf(\"%d %d\\n\",rt->sum2,rt->sum1);\n    return 0;//\u7ec8\u4e8e\u6253\u5b8c\u4e86\uff08\u7d2f\u6b7b\u6211\u4e86\u3002\u3002\u3002\uff09\n}\n\n```",
        "postTime": 1512660866,
        "uid": 49998,
        "name": "\u65af\u5fb7\u54e5\u5c14\u6469",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "\u4e00\u756a\u6ce2\u6298\u540e\u7ec8\u4e8eAC\uff0c\u5728\u8fd9\u91cc\u53d1\u4e00\u7bc7\u5e73\u8861\u6811Treap\u7684\u9898\u89e3\n\n\u4e3b\u8981\u662f\u9700\u8981\u7ef4\u62a4\u7f8e\u89c2\u503c\u4ee5\u53ca\u82b1\u8d39\u7684\u548c\n\n\uff081\uff09\u63d2\u5165\u64cd\u4f5c\uff0c \u9047\u5230\u76f8\u540c\u76f4\u63a5return\n\n\uff082\u30013\uff09\u5220\u9664\u6700\u5927\u6700\u5c0f\uff0c\u6211\u7684\u65b9\u6cd5\u662f\u66b4\u529b\u627e\u5230\u8fd9\u4e2a\u7ed3\u70b9\uff0c\u7136\u540e\u4e0a\u5220\u9664\u6a21\u677f\uff0c\u4f3c\u4e4e\u5199\u5f97\u6709\u70b9\u9ebb\u70e6\uff08\u53e6\u5916\u8ba4\u771f\u770b\u6e05\u9898\u76ee\uff0c\u4e0d\u8981\u628a2\u30013\u641e\u53cd\u4e86\uff09\n\n\uff084\uff09\u8be2\u95ee\uff0c\u76f4\u63a5\u8f93\u51fa\u6839\u8282\u70b9\u7684\u7ef4\u62a4\u503c\n\n\u4e0d\u77e5\u9053\u6709\u6ca1\u6709\u70b9\u5c0f\u9898\u5927\u505a\uff0c\u4f46\u81f3\u5c11\u6bd4\u8f83\u5feb\u2026\u2026\n\n\n\n\n\n\n\n\n\n\n\n\n```cpp\n//mon[]\u662f\u7ed3\u70b9\u82b1\u8d39\uff0cvis[]\u662f\u7ed3\u70b9\u7f8e\u89c2\u503c\n//cop[]\u662f\u7ed3\u70b9\u53ca\u4ee5\u4e0b\u82b1\u8d39\u603b\u548c\uff0csum[]\u662f\u7ed3\u70b9\u53ca\u4ee5\u4e0b\u7f8e\u89c2\u503c\u603b\u548c \n#include <iostream>\n#include <cstdio>\n#include <algorithm>\nusing namespace std;\nconst int Maxn = 0x3f3f3f3f;\nconst int N = 1e6 + 5;\nint lc[N], rc[N], pos[N], vis[N], mon[N], sum[N], cop[N];\nint x, rt, T, k;\ninline int get()\n{\n    char ch; bool f = false; int res = 0;\n    while (((ch = getchar()) < '0' || ch > '9') && ch != '-');\n    if (ch == '-') f = true;\n     else res = ch - '0';\n    while ((ch = getchar()) >='0' && ch <= '9')\n        res = (res << 3) + (res << 1) + ch - '0';\n    return f? ~res + 1 : res;\n}\ninline void put(int x)\n{\n    if (x < 0)\n      x = ~x + 1, putchar('-');\n    if (x > 9) put(x / 10);\n    putchar(x % 10 + 48);\n}\ninline void Push(const int x) //\u7ef4\u62a4 \n{\n    sum[x] = sum[lc[x]] + sum[rc[x]] + vis[x];\n    cop[x] = cop[lc[x]] + cop[rc[x]] + mon[x];\n}\ninline void Zig(int &x) \n{\n    int y = lc[x];\n    lc[x] = rc[y], rc[y] = x;\n    Push(x); Push(y);\n    x = y;    \n}\ninline void Zag(int &x)\n{\n    int y = rc[x];\n    rc[x] = lc[y], lc[y] = x;\n    Push(x); Push(y);\n    x = y;\n}\ninline void Ins(int &x, const int mn, const int vi) //\u63d2\u5165 \n{\n    if (!x)\n    {\n        mon[x = ++T] = mn, pos[x] = rand();\n        vis[x] = sum[x] = vi, cop[x] = mn;\n        return ;\n    }\n    if (mn == mon[x]) return ; //\u76f8\u540c\u76f4\u63a5\u8fd4\u56de \n    else if (mn < mon[x])\n    {\n        Ins(lc[x], mn, vi);\n        if (pos[lc[x]] < pos[x]) Zig(x);\n    }\n    else \n    {\n        Ins(rc[x], mn, vi);\n        if (pos[rc[x]] < pos[x]) Zag(x);\n    }\n    Push(x);\n} \ninline void Del(int &x, const int mn, const int vi) //\u5220\u9664 \n{\n    if (mon[x] == mn)\n    {\n        if (!lc[x] || !rc[x]) x = lc[x] + rc[x];\n        else if (pos[lc[x]] < pos[rc[x]]) Zig(x), Del(x, mn, vi);\n         else Zag(x), Del(x, mn, vi); \n        return ;\n    }\n    sum[x] -= vi; cop[x] -= mn;\n    if (mon[x] > mn) Del(lc[x], mn, vi);\n     else Del(rc[x], mn, vi);\n}\ninline int find(const int F) //\u66b4\u529b\u627e\u7ed3\u70b9 \n{\n    int x = rt;\n    if (F) {while (lc[x]) x = lc[x];}\n     else {while (rc[x]) x = rc[x];}\n    return x; \n}\nint main()\n{\n    while (~scanf(\"%d\", &k))\n    {\n        switch(k)\n        {\n            case 1: x = get(); Ins(rt, get(), x); break;\n            case 2: x = find(0); Del(rt, mon[x], vis[x]); break;\n            case 3: x = find(1); Del(rt, mon[x], vis[x]); break;\n            case -1: put(sum[rt]), putchar(' ');\n                     put(cop[rt]), putchar('\\n'); break;\n        }\n    }\n    return 0;\n}\n\n```",
        "postTime": 1491576352,
        "uid": 17952,
        "name": "Log_x",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "# \u5e73\u8861\u4e8c\u53c9\u6811+\u8bb0\u5fc6\u5316\u7248\u526a\u679d\n\u8fd9\u9053\u9898\u5176\u5b9e\u5c31\u662f\u4e09\u4e2a\u64cd\u4f5c\uff1a**\u52a0\u5165\u6570\uff0c\u5220\u9664\u6700\u4fbf\u5b9c\uff0c\u5220\u9664\u6700\u8d35**\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a**\u5e73\u8861\u4e8c\u53c9\u6811**\uff0c\u7528\u4e8e\u50a8\u5b58\u3002\n\n\u4ec0\u4e48\u662f\u5e73\u8861\u4e8c\u53c9\u6811\uff1f\uff1f\n\n\u6839\u636e\u6211\u4e2a\u4eba\u7684\u7406\u89e3\uff0c\u5176\u5b9e\u5c31\u662f\u8fd1\u4f3c\u4e8e\u4e00\u4e2a\u533a\u95f4[0,100001]\uff0c\u4e4b\u540e\u8fdb\u884c\u4e0d\u65ad\u5730\u4e8c\u5206\u67e5\u627e\uff0c\u77e5\u9053\u53d1\u73b0\u533a\u95f4\u7684\u5de6\u53f3\u76f8\u7b49\u4e3a\u6b62\uff0c\u5728\u8fd9\u4e2a\u8282\u70b9\u4e0a\u8bb0\u5f55\u4e00\u6b21\u3002\n\n\u4f8b\u5982\u653e\u51658\uff1a\n| l | r  |\n| -----------: | -----------: |\n| 1| 100 |\n| 1 | 50 |\n| 1 | 25 |\n| 1 | 12 |\n| 7 | 12 |\n| 7 | 9 |\n|7  | 8 |\n| 8 | 8 |\n\u8fd9\u79cd\u4ee5\u533a\u95f4\u4e8c\u5206\u641c\u7d22\u7684\u6811\u5f62\u7ed3\u6784\uff0c\u6211\u4eec\u8ba4\u4e3a\u662f\u5e73\u8861\u4e8c\u53c9\u6811\u3002\u76f8\u5bf9\u4e8e\u666e\u901a\u4e8c\u53c9\u6811\u6765\u8bf4\uff0c\u8fd9\u68f5\u6811\u7684\u6df1\u5ea6\u5dee\u4e0d\u5927\uff0c\u6240\u4ee5\u5728\u9762\u5bf9\u6781\u7aef\u6570\u636e\u65f6\uff0c\u5e73\u8861\u4e8c\u53c9\u6811\u6bd4\u666e\u901a\u4e8c\u53c9\u6811\u7684\u7a33\u5b9a\u6027\u5f3a\u5f88\u591a\uff0c\u66f4\u5e73\u8861\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u4ef7\u683c\u4e3a\u653e\u5165\u503c\uff0c\u6765\u6784\u9020\u4e00\u68f5\u5e73\u8861\u6811\u3002\n```cpp\ninline int inst(ll k,ll c){//k\u4ee3\u8868\u4ef7\u683c\uff0cc\u4ee3\u8868\u7f8e\u4e3d\u503c\n\tll ll=l,rr=r,mid,p=1;\n\twhile(ll<rr){//\u5f00\u59cb\u4e8c\u5206\n\t\tmid=(ll+rr)/2;//\u53d6\u4e2d\u95f4\u503c\n\t\tif(k<=mid){//\u5982\u679c\u5728\u5de6\u5b50\u6811\n\t\t\tif(a[p].lf==0){//\u5e76\u4e14\u5f53\u524d\u4f4d\u7f6e\u7684\u5de6\u5b50\u6811\u4e3a\u7a7a\n\t\t\t\tan++;a[p].lf=an;\n\t\t\t\ta[an].lf=0;a[an].rt=0;a[an].data=0;//\u65b0\u62d3\u5c55\u4e00\u70b9\n\t\t\t}\n\t\t\tp=a[p].lf;rr=mid;//\u904d\u5386\u5de6\u5b50\u6811\n\t\t}\n\t\telse{\n\t\t\tif(a[p].rt==0){//\u5982\u679c\u5728\u53f3\u5b50\u6811\n\t\t\t\tan++;\n\t\t\t\ta[p].rt=an;\n\t\t\t\ta[an].lf=0;a[an].rt=0;a[an].data=0;//\u65b0\u62d3\u5c55\u4e00\u70b9\n\t\t\t}\n\t\t\tp=a[p].rt;ll=mid+1;//\u904d\u5386\u53f3\u5b50\u6811\n\t\t}\n\t\n\tif(a[p].data==0){//\u6ce8\u610f\uff1a\u56e0\u4e3a\u9047\u5230\u4ef7\u683c\u91cd\u590d\u7684\u4e0d\u80fd\u653e\u5165\n    //\u6240\u4ee5\u53ea\u5b58\u5728\u6ca1\u6709\u6216\u53ea\u6709\u4e00\u4e2a\n\t\ta[p].data++;\n\t    sum++;\n\t    sum1+=k;//\u4ef7\u683c\u76f8\u52a0\n\t    sum2+=c;//\u7f8e\u4e3d\u503c\u76f8\u52a0\n\t    a[p].q=c;//\u8bb0\u5f55\n\t}\n}\n\n```\n\u5220\u9664\u6700\u4fbf\u5b9c\u6216\u6700\u8d35\u7684\uff0c\u6211\u4eec\u53ea\u9700\u8981\u62fc\u547d\u904d\u5386\u5de6\u5b50\u6811\u6216\u53f3\u5b50\u6811\u5373\u53ef\uff0c\u5e76\u4e14\u5220\u9664\u4ef7\u683c\u548c\u7f8e\u4e3d\u503c\u3002\n\n\u6700\u540e\u8f93\u51fa\u5269\u4e0b\u7684\u4ef7\u683c\u548c\u7f8e\u4e3d\u503c\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u7b97\u6cd5\u662f\u6ca1\u6709\u95ee\u9898\uff0c\u4f46\u662f\u7531\u4e8e\u8017\u65f6\u592a\u5927\uff0c\u53ea\u80fd\u62ff40\u5206\n![](https://cdn.luogu.com.cn/upload/pic/73622.png )\n\u56e0\u6b64\u6211\u4eec\u5c31\u8981\u60f3\u529e\u6cd5\u6765\u4f18\u5316\u3002\n\n\u6211\u4eec\u77e5\u9053\uff0c\u53ef\u4ee5\u5728\u6bcf\u6b21\u653e\u5165\u6570\u7684\u65f6\u5019\uff0c\u5728\u8d70\u8fc7\u7684\u6bcf\u4e00\u6761\u8def\u4e0a**\u505a\u4e00\u4e2a\u8bb0\u53f7**\uff0c\u53ef\u4ee5\u5728\u5220\u9664\u6570\u65f6\u7528\u6765**\u5224\u65ad\u8fd9\u4e0b\u9762\u8fd8\u6709\u6ca1\u6709\u5b58\u6570**\uff0c\u5982\u679c\u6709\u5b58\u6570\u5c31\u7ee7\u7eed\u67e5\u627e\uff0c\u6ca1\u6709\u76f4\u63a5\u8df3\u51fa\u7a0b\u5e8f\u3002\n\n\u4f46\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff1a**\u5220\u9664\u6570\u540e\u600e\u4e48\u5904\u7406\u539f\u5148\u505a\u7684\u8bb0\u53f7\uff1f**\n\n### \u5220\u6389\u5457\uff01\n\u6211\u4eec\u5728\u5220\u9664\u8fc7\u7a0b\u4e2d\u5bfb\u627e\u8bb0\u53f7\u65f6\uff0c\u987a\u4fbf\u628a\u8bb0\u53f7\u62b9\u6389\uff0c\u8fd9\u6837\u7b49\u5230\u4e0b\u6b21\u6765\u67e5\u627e\u65f6\u4e0d\u4f1a\u6df7\u6dc6\u3002\n\n\u5949\u4e0a\u8017\u65f6\u8bb8\u4e45\u7684AC\u4ee3\u7801\uff1a\n```cpp\n#include <iostream>\n#include <stdlib.h>\n#include <cstdio>\nusing namespace std;\ntypedef long long ll;\nstruct node{\n\tll lf,rt,data,q,num;//num\u8868\u793a\u662f\u5426\u6709\u6570\n}a[10000001];\nll l=0,r=1000001,an=1,sum=0;\nbool boo=0;\nll sum1=0,sum2=0;\nint read(ll &x){//\u65e5\u5e38\u8bfb\u5165\u4f18\u5316\n    int f=1;x=0;char s=getchar();\n    while(s<'0'||s>'9'){if(s=='-')f=-1;s=getchar();}\n    while(s>='0'&&s<='9'){x=x*10+s-'0';s=getchar();}\n    x*=f;\n}\ninline int inst(ll k,ll c){\n\tll ll=l,rr=r,mid,p=1;\n\twhile(ll<rr){\n\t\tmid=(ll+rr)/2;\n\t\ta[p].num++;//\u6807\u5fd7\u8fd9\u4e0b\u9762\u6709\u5b58\u6570\n\t\tif(k<=mid){\n\t\t\tif(a[p].lf==0){\n\t\t\t\tan++;a[p].lf=an;\n\t\t\t\ta[an].lf=0;a[an].rt=0;a[an].data=0;\n\t\t\t}\n\t\t\tp=a[p].lf;rr=mid;\n\t\t}\n\t\telse{\n\t\t\tif(a[p].rt==0){\n\t\t\t\tan++;\n\t\t\t\ta[p].rt=an;\n\t\t\t\ta[an].lf=0;a[an].rt=0;a[an].data=0;\n\t\t\t}\n\t\t\tp=a[p].rt;ll=mid+1;\n\t\t}\n\t}\n\ta[p].num++;//\u8bb0\u4f4f\u6700\u540e\u5728\u53f6\u5b50\u4e0a\u65f6\u4e5f\u8981\u8bb0\u5f55\u4e00\u6b21\uff01\n\tif(a[p].data==0){\n\t\ta[p].data++;\n\t    sum++;\n\t    sum1+=k;\n\t    sum2+=c;\n\t    a[p].q=c;\n\t}\n}\ninline int prt1(ll p,ll l,ll r){\n\tll i;\n\tif(boo==true&&a[p].num>0){//\u7528\u4e8e\u5224\u65ad\u8fd9\u4e2a\u6839\u8282\u70b9\u4e0b\u9762\u662f\u5426\u5b58\u6570\n\t\ta[p].num--;//\u987a\u4fbf\u628a\u8bb0\u53f7\u62b9\u53bb\n\t\tif(p>0){\n\t\t\tif(l==r&&a[p].data>0){\n\t\t\t    a[p].data--,boo=false;\n\t\t\t    sum1-=l;sum2-=a[p].q;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tll mid=(l+r)/2;\n\t\t\t\tprt1(a[p].lf,l,mid);//\u73a9\u547d\u627e\u5de6\u5b50\u6811\n\t\t\t\tprt1(a[p].rt,mid+1,r);\n\t\t\t}\n\t\t}\n\t}\n}\ninline int prt2(ll p,ll l,ll r){\n\tll i;\n\tif(boo==true&&a[p].num>0){//\u540c\u7406\n\t\ta[p].num--;//\u540c\u7406\n\t\tif(p>0){\n\t\t\tif(l==r&&a[p].data>0){\n\t\t\t    a[p].data--,boo=false;\n\t\t\t    sum1-=l;sum2-=a[p].q;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tll mid=(l+r)/2;\n\t\t\t\tprt2(a[p].rt,mid+1,r);//\u73a9\u547d\u627e\u53f3\u5b50\u6811\n\t\t\t\tprt2(a[p].lf,l,mid);\n\t\t\t}\n\t\t}\n\t}\n}\nint main(){\n\tll i,j,k,n;\n\twhile(read(n)){\n\t\tif(n==-1)break;\n\t\tif(n==1){\n\t\t\tll w,c;\n\t\t\tscanf(\"%lld %lld\",&w,&c);\n\t\t\tinst(c,w);\n\t\t}\n\t\tif(n==3&&sum>0){\n\t\t\tboo=true;//bool\u8868\u793a\u5f53\u524d\u662f\u5426\u627e\u5230\u6781\u7aef\u503c\uff0c\u627e\u5230\u7acb\u523b\u9000\u51fa\n\t\t\tprt1(1,l,r);\n\t\t\tsum--;\n\t\t}\n\t\tif(n==2&&sum>0){\n\t\t\tboo=true;\n\t\t\tprt2(1,l,r);\n\t\t\tsum--;\n\t\t}\n\t}\n\tprintf(\"%lld %lld\",sum2,sum1);\n\treturn 0;\n}\n```\n\u52a0\u4e86\u8fd9\u4e2a\u7684\u901f\u5ea6\u8981\u4f18\u4e8e\u539f\u5148\u4ee3\u780130\u500d\u5de6\u53f3\u3002~~\u6211\u597d\u50cf\u641e\u6210\u5806\u4e86~~\n![](https://cdn.luogu.com.cn/upload/pic/73625.png )\n",
        "postTime": 1566305770,
        "uid": 133986,
        "name": "judgejudge",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "# Luogu2073 \u3010\u9001\u82b1\u3011 \u9898\u89e3\n\n---\n\n>\u8c8c\u4f3c\u6ca1\u6709\u4eba\u5199\u8fc7\u66ff\u7f6a\u7f8a\u6811\u7684\u4ee3\u7801\uff0c\u6240\u4ee5\u849f\u84bb\u524d\u6765\u8d21\u732e\u4e00\u53d1\u9898\u89e3\n\n## \u601d\u60f3\n\n\u7528\u66ff\u7f6a\u7f8a\u6811\u7ef4\u62a4\u82b1\u7684\u4ef7\u503c\u548c\u7f8e\u4e3d\u503c\u7684\u5e8f\u5217\uff0c\u628a\u82b1\u7684\u4ef7\u503c\u5f53\u6210\u5173\u952e\u5b57\u5efa\u6811\u5c31\u884c\u4e86\uff0c\u5220\u9664\u6700\u8d35\u7684\u82b1\u90a3\u4e48\u5c31\u5220\u9664\u6811\u7684\u53f3\u5b50\u6811\u7684\u6700\u540e\u4e00\u4e2a\u8282\u70b9\uff0c\u5220\u9664\u6700\u4fbf\u5b9c\u7684\u82b1\u90a3\u4e48\u5c31\u5220\u9664\u6811\u7684\u5de6\u5b50\u6811\u7684\u7b2c\u4e00\u4e2a\u8282\u70b9\u3002ans_w,ans_c\u7684\u503c\u8ddf\u7740\u53d8\u52a8\u5c31\u884c\u4e86\u3002\n\n## \u6ce8\u610f\u70b9\n\n\u8fd9\u9898\u76ee\u7684$3$\u53f7\u64cd\u4f5c\u548c$2$\u53f7\u64cd\u4f5c\u5343\u4e07\u522b\u641e\u53cd\u4e86\uff01\uff01\uff01\n\n\u8fd9\u9898\u64cd\u4f5c$2$\uff0c$3$\u64cd\u4f5c\u662f\u53cd\u7740\u7ed9\u7684\uff01\uff01\uff01\n\n\u5982\u679c\u641e\u53cd\u7684\u8bdd\u90a3\u4e48\u5c31\u53ea\u6709$10$\u5206\uff01\uff01\uff01\n\n## \u4ee3\u7801\n\n```\n#include<cstdio>\n#include<cctype>\n#define LL long long\n#define alpha 0.75\n#define qmid(L,R) (L+((R-L)>>1))\nusing namespace std;\nint n,m,root,sum,cur[1000005],tot;\nbool hsh[1000005];\nLL ans_w,ans_c;\nstruct ypc{\n\tint val,son[2],fa,beu;\n\tdouble size;\n}t[1000005];\ninline bool balance(int id){\n\treturn t[t[id].son[0]].size<=t[id].size*alpha&&t[t[id].son[1]].size<=t[id].size*alpha;\n}\nvoid dfs(int id){\n\tif (!id)return;\n\tdfs(t[id].son[0]);\n\tcur[++sum]=id;\n\tdfs(t[id].son[1]);\n}\nint build(int L,int R){\n\tif (L>R)return 0;\n\tint mid=qmid(L,R),id=cur[mid],ls=build(L,mid-1),rs=build(mid+1,R);\n\tt[ls].fa=t[rs].fa=id;\n\tt[id].son[0]=ls,t[id].son[1]=rs;\n\tt[id].size=t[ls].size+t[rs].size+1;\n\treturn id;\n}\ninline int get_lr(int id){\n\treturn t[t[id].fa].son[1]==id;\n}\ninline void rebuild(int id){\n\tsum=0,dfs(id);\n\tint fa=t[id].fa,opt=get_lr(id),new_son=build(1,sum);\n\tt[fa].son[opt]=new_son,t[new_son].fa=fa;\n\tif (root==id)root=new_son;\n}\ninline void insert(int w,int c){\n\tif (!root){t[root=++tot].val=c,t[root].size=1,t[root].beu=w;return;}\n\tint tmp=root;\n\twhile (tmp){\n\t\tt[tmp].size++;\n\t\tint fa=tmp,opt=(c>=t[tmp].val);tmp=t[tmp].son[opt];\n\t\tif (!tmp){\n\t\t\tt[++tot].val=c,t[tot].fa=fa,t[tot].size=1,t[tot].beu=w,t[fa].son[opt]=tot;\n\t\t\tbreak;\n\t\t}\n\t}\n\tint flg=0;\n\tfor (int i=tot;i;i=t[i].fa)if (!balance(i))flg=i;\n\tif (flg)rebuild(flg);\n}\ninline void erase(int id){\n\tif (t[id].son[0]&&t[id].son[1]){\n\t\tint tmp=t[id].son[0];\n\t\twhile (t[tmp].son[1])tmp=t[tmp].son[1];\n\t\tt[id].val=t[tmp].val,id=tmp;\n\t}\n\tint son=t[id].son[0]?t[id].son[0]:t[id].son[1],opt=get_lr(id),fa=t[id].fa;\n\tt[fa].son[opt]=son,t[son].fa=fa;\n\tif (root==id)root=son;\n}\ninline int get_min(){\n\tint tmp=root;\n\twhile (t[tmp].son[0])tmp=t[tmp].son[0];\n\treturn tmp;\n}\ninline int get_max(){\n\tint tmp=root;\n\twhile (t[tmp].son[1])tmp=t[tmp].son[1];\n\treturn tmp;\n}\ninline int read(){\n\tint ret=0,flg=1;char ch=getchar();\n\twhile (!isdigit(ch)){if (ch=='-')flg=-1;ch=getchar();}\n\twhile (isdigit(ch))ret=ret*10+ch-48,ch=getchar();\n\treturn ret*flg;\n}\nint main(){\n//\tfreopen(\"Luogu2073.in\",\"r\",stdin);\n//\tfreopen(\"Luogu2073.out\",\"w\",stdout);\n\tfor (;;){\n\t\tint tpe=read();\n\t\tif (tpe==-1)break;\n\t\tif (tpe==1){\n\t\t\tint w=read(),c=read();\n\t\t\tif (hsh[c])continue;else hsh[c]=1;\n\t\t\tinsert(w,c),ans_w+=w,ans_c+=c;\n//\t\t\tsum=0,dfs(root);\n//\t\t\tfor (int i=1;i<=sum;i++)printf(\"%d \",cur[i]);\n//\t\t\tprintf(\"\\n\");\n\t\t}\n\t\tif (tpe==2){\n\t\t\tint id=get_max();\n\t\t\tans_w-=t[id].beu,ans_c-=t[id].val,hsh[t[id].val]=0,erase(id);\n\t\t}\n\t\tif (tpe==3){\n\t\t\tint id=get_min();\n\t\t\tans_w-=t[id].beu,ans_c-=t[id].val,hsh[t[id].val]=0,erase(id);\n\t\t}\n\t}\n\tprintf(\"%lld %lld\\n\",ans_w,ans_c);\n\treturn 0;\n}\n```",
        "postTime": 1526096914,
        "uid": 36909,
        "name": "_YPC",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "## splay\u6a21\u677f\u9898\uff0c\u7ec6\u8282\u633a\u591a\u3002\n\n---\n\n\u8fd9\u9053\u9898\u8981\u8ba9\u6211\u4eec\u7ef4\u62a4\u6743\u503c\u4fe1\u606f\uff0c\u9a6c\u4e0a\u60f3\u5230\u4e86splay\u3002\n\n\u8ba9\u6211\u4eec\u7ef4\u62a4\u7684\u64cd\u4f5c\u6709\uff1a\u5355\u70b9\u6dfb\u52a0\u3001\u5220\u9664\u6700\u5c0f\u503c\u548c\u5220\u9664\u6700\u5927\u503c\uff0c\u90fd\u662fsplay\u6a21\u677f\u7684\u7ecf\u5178\u64cd\u4f5c\u3002\n\n\u5f88\u5feb\u5730\u628a\u6a21\u677f\u6572\u51fa\u6765\u4e86\u4e4b\u540e\u5199\u7a0b\u5e8f\u5374**WA\u548cTLE\u4e86**\u3002\u3002\u3002\n\n### \u539f\u56e01\uff1a\u4f60\u5c11\u4e86\u7ec6\u8282\uff1a\n\n- \u64cd\u4f5c3\u548c2\u7684\u987a\u5e8f\u98a0\u5012\u4e86\uff01\n\n- \u64cd\u4f5c\u65f6\u6ca1\u6709\u82b1\u5c31\u8df3\u8fc7\u5220\u9664\u64cd\u4f5c\uff01\n\n\u5982\u679c\u4e0d\u8003\u8651\u8fd9\u4e2a\u4f60\u7684\u7a0b\u5e8f\u4f1a\u6b7b\u5f97\u5f88\u96be\u770b\u3002\n\n### \u539f\u56e02\uff1a\u4f60\u5bf9splay\u5404\u51fd\u6570\u7684\u4f5c\u7528\u6df7\u6dc6\u4e86\uff1a\n\n\u5176\u4e2d**\u4e0b\u6807\u548c\u8282\u70b9\u503c\u4e0d\u53ef\u6df7\u6dc6\uff0c\u5426\u5219WA**\u3002\n\n\u5728\u6211\u7684\u4ee3\u7801\u4e2d\u603b\u5171\u4f7f\u7528\u4e868\u4e2asplay\u7684\u51fd\u6570\u3002\n\n\u6211\u5bf9\u5176\u4e2d\u7684\u6bcf\u4e2a\u64cd\u4f5c\u90fd\u6253\u4e0a\u4e86\u6ce8\u91ca\uff0c\u8fd9\u6837\u624d\u80fd\u907f\u514d\u51fa\u9519\uff01\n\n### \u4ee3\u7801\n\n```cpp\n#include<cstdio>\nusing namespace std;\nconst int maxn = 100005, INF = 19260817;\nstruct Splay\n{\n\tint ch[2], fa, val, val2;\n} s[maxn];\nint root, tot;\nlong long sum, sum2;\nint identify(int x)//x\u662f\u4e0b\u6807\n{\n\treturn s[s[x].fa].ch[1] == x;\n}\nvoid connect(int son, int fa, int k)//son\u548cfa\u90fd\u662f\u4e0b\u6807\n{\n\ts[son].fa = fa;\n\ts[fa].ch[k] = son;\n}\nvoid rotate(int x)//x\u662f\u4e0b\u6807\n{\n\tint y = s[x].fa;\n\tint z = s[y].fa;\n\tint yk = identify(x);\n\tint zk = identify(y);\n\tint b = s[x].ch[yk ^ 1];\n\tconnect(b, y, yk);\n\tconnect(y, x, yk ^ 1);\n\tconnect(x, z, zk);\n}\nvoid splay(int x, int goal)//x\u548cgoal\u90fd\u662f\u4e0b\u6807\n{\n\twhile(s[x].fa != goal)\n\t{\n\t\tint y = s[x].fa;\n\t\tint z = s[y].fa;\n\t\tif(z != goal) identify(x) == identify(y) ? rotate(y) : rotate(x);\n\t\trotate(x);\n\t}\n\tif(goal == 0) root = x;\n}\nvoid insert(int w, int c)\n{\n\tint now = root, fa = 0;\n\twhile(now && s[now].val != c)\n\t{\n\t\tfa = now;\n\t\tnow = s[now].ch[c > s[now].val];\n\t}\n\tif(now == 0)\n\t{\n\t\tnow = ++tot;\n\t\ts[now].ch[0] = s[now].ch[1] = 0;\n\t\ts[now].fa = fa;\n\t\tif(fa) s[fa].ch[c > s[fa].val] = now;\n\t\ts[now].val = c; s[now].val2 = w;\n\t\tsum += c; sum2 += w;//\u603b\u548c\u8981\u5728\u8fd9\u91cc\u9762\u52a0\n\t}\n\tsplay(now, 0);\n}\nvoid find(int x)//\u627e\u5230val == x\u7684\u70b9\u5e76splay\u5230\u6839 \n{\n\tint now = root;\n\tif(now == 0) return;\n\twhile(s[now].ch[x > s[now].val] && s[now].val != x) now = s[now].ch[x > s[now].val];\n\tsplay(now, 0);\n}\nint next(int x, int k)//\u627e\u5230val == x\u7684\u70b9\u7684\u524d\u9a71\u6216\u540e\u7ee7 \n{\n\tfind(x);\n\tint now = root;\n\tif(!k && x > s[now].val) return now;\n\tif(k && x < s[now].val) return now;\n\tnow = s[now].ch[k];\n\twhile(s[now].ch[k ^ 1]) now = s[now].ch[k ^ 1];\n\treturn now;\n}\nvoid Delete(int x)//\u5220\u9664val == x\u7684\u8282\u70b9 \n{\n\tint pre = next(x, 0), post = next(x, 1);\n\tsplay(pre, 0); splay(post, pre);\n\tint del = s[post].ch[0];\n\tsum -= s[del].val;\n\tsum2 -= s[del].val2;\n\ts[post].ch[0] = 0;\n}\nint read()\n{\n\tint ans = 0, s = 1;\n\tchar ch = getchar();\n\twhile(ch > '9' || ch < '0')\n\t{\n\t\tif(ch == '-') s = -1;\n\t\tch = getchar();\n\t}\n\twhile(ch >= '0' && ch <= '9')\n\t{\n\t\tans = ans * 10 + ch - '0';\n\t\tch = getchar();\n\t}\n\treturn s * ans;\n}\nint main()\n{\n\tinsert(0, -INF); insert(0, INF);\n\tint opt, w, c;\n\twhile(2333)\n\t{\n\t\topt = read();\n\t\tif(opt == -1) break;\n\t\tif(opt == 1)\n\t\t{\n\t\t\tw = read(), c = read();\n\t\t\tinsert(w, c);\n\t\t}\n\t\telse if(opt == 2)\n\t\t{\n\t\t\tint del = next(INF, 0);//\u5ffd\u7565\n\t\t\tif(s[del].val != -INF) Delete(s[del].val);\n\t\t}\n\t\telse if(opt == 3)\n\t\t{\n\t\t\tint del = next(-INF, 1);//\u5ffd\u7565\n\t\t\tif(s[del].val != INF) Delete(s[del].val);\n\t\t}\n\t}\n\tprintf(\"%lld %lld\\n\", sum2, sum);\n\treturn 0;\n}\n```",
        "postTime": 1524549628,
        "uid": 51497,
        "name": "Garen",
        "ccfLevel": 0,
        "title": "P2073 \u9001\u82b1"
    },
    {
        "content": "\u8fd9\u9898\u53ea\u8981\u6c42\u52a0\u5165\u548c\u5220\u9664\n\n\u53ef\u4ee5\u76f4\u63a5\u7528map\u505a(stl\u5927\u6cd5\u597d)\n\n\u7a0d\u5fae\u6ce8\u610f\u4e00\u4e0b\u5220\u9664\u64cd\u4f5c\n\n\u522b\u628a2,3\u5f04\u53cd\u5c31\u884c\u4e86\n\n\n\n\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<map>\nusing namespace std;\ntypedef long long ll;\nmap <int,int> Map;\nint op;\nll W,C;\ninline int read()\n{\n    int s=0,f=1;\n    char ch=getchar();\n    while(ch<'0'||ch>'9')\n    {\n        if(ch=='-') f=-1;\n        ch=getchar();\n    }\n    while(ch>='0'&&ch<='9')\n        s=s*10+ch-'0',ch=getchar();\n    return s*f;\n}\nint main()\n{\n    int w,c;\n    map <int,int>::iterator it;\n    while((op=read())!=-1)\n    {\n        if(op==1)\n        {\n            w=read(),c=read();\n            Map.insert(make_pair(c,w));\n        }\n        else\n        {\n            if(Map.empty()) continue;//\u5220\u9664\u524d\u5148\u5224\u65ad\u662f\u5426\u4e3a\u7a7a\n            if(op==2)\n            {\n                it=Map.end();\n                Map.erase(--it);\n            }\n            if(op==3)\n            {\n                it=Map.begin();\n                Map.erase(it);\n            }\n        }\n    }\n    it=Map.begin();\n    while(it!=Map.end())\n    {\n        C+=it->first,W+=it->second;\n        it++;\n    }\n    printf(\"%lld %lld\\n\",W,C);\n    return 0;\n}\n\n```",
        "postTime": 1503241291,
        "uid": 54473,
        "name": "Fortitude",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "## \u5e73\u8861\u6811\uff1f\u4e0d\u5b58\u5728\u7684\u3002\n$ vector $\u662f\u53ef\u4ee5\u6781\u7b80\u5355\u5730\u5b9e\u73b0\u5e73\u8861\u6811\u7684\u3002$ vector , yyds! $\n\n\u5177\u4f53\u53ef\u4ee5\u53c2\u8003\u4e00\u4e0b\u6211\u8c8c\u4f3c\u6ca1\u6709\u53d1\u8868\u51fa\u6765\u7684blog\n[\u5e73 \u8861 \u6811](https://www.luogu.com.cn/blog/wuyihong/solution-p3369-update)\n\n### \u8fdb\u5165\u6b63\u9898\n\u9898\u610f\uff1a\u7ef4\u62a4\u4e00\u4e2a\u5e8f\u5217\u3002\u6bcf\u6b21\u63d2\u5165\u4e00\u4e2a\u5bf9$ (a,b) $\uff0c$ a $\u91cd\u590d\u4e0d\u63d2\uff1b\u5220\u6389$ a $\u6700\u5c0f\u7684\u5bf9\uff1b\u5220\u6389$ a $\u6700\u5927\u7684\u5bf9\uff1b\u4ee5\u53ca\u6700\u540e\u8ba1\u7b97$ \\sum a $\u548c$ \\sum b $\u3002\n#### \u63d2\u5165\n```cpp\nvoid insert(pair<int,int>p) {\n\tif(used[p.first])return;//\u786e\u4fdda\u4e0d\u91cd\u590d\n\tv.insert(lower_bound(v.begin(),v.end(),p),p);\n    //\u2191\u5728\u63d2\u5165\u6bd4\u5143\u7d20\u5c0f\u4e00\u70b9\u7684\u4f4d\u7f6e\u63d2\u5165\n\tused[p.first]++;\n    //\u6ce8\u610f\u662f++\uff0cused\u4e5f\u4e00\u5b9a\u8981int\uff0c\u56e0\u4e3a\u8fd8\u6709\u5220\u9664\u64cd\u4f5c\n}\n```\n#### \u5220\u9664\n```cpp\nvoid del1() {//\u5220\u9996\n\tif(v.size())//\u4e0d\u52a0\u4f1a\u7206\u70b8\n\t\tused[v.begin()->first]--,v.erase(v.begin());\n        //used\u8981\u5148\u5220\uff0c\u4e0d\u7136erase\u540e\u6ca1\u4e86\n}\nvoid del2() {//\u5220\u5c3e\n\tif(v.size())//being without could cause explosion\n\t\tused[(--v.end())->first]--,v.erase(--v.end());\n        //used should be deleted first,or after erasing it,it will disappear\n}\n```\n#### \u7edf\u8ba1\n```cpp\nfor(vector<pair<int,int> >::iterator it=v.begin(); it!=v.end(); it++)\n\t\ta+=it->first,b+=it->second;\n        //\u8fed\u4ee3\u5668\u5199\u6cd5\uff0c\u75280~v.size()-1\u4e5f\u884c\n```\n#### \u8865\u5145C++\u6027\u8d28\n$ pair $\u5143\u7d20\uff1a\u6392\u5e8f\u65f6\u5148\u6392\u7b2c\u4e00\u5143\uff0c\u518d\u6392\u7b2c\u4e8c\u5143\u3002\u7528\u8fd9\u4e2a\u6027\u8d28\u53ef\u4ee5\u907f\u514d\u5f88\u591a\u9ebb\u70e6\u7684$ struct $\u554a\uff0c$ operator $\u554a\u7684\u5199\u6cd5\u3002\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\n#define maxn 100010\n#define int long long\nusing namespace std;\ntemplate<class T>void read(T &__x) {\n\t__x=0;\n\tshort __f=1;\n\tchar __ch=getchar();\n\twhile(__ch<'0'||__ch>'9') {\n\t\tif(__ch=='-')__f=-1;\n\t\t__ch=getchar();\n\t}\n\twhile(__ch>='0'&&__ch<='9') {\n\t\t__x=(__x<<1)+(__x<<3)+(__ch^48);\n\t\t__ch=getchar();\n\t}\n\t__x*=__f;\n}\nint n,op,x,y;\nint used[1000001];\nvector<pair<int,int> >v;\nvoid insert(pair<int,int>p) {\n\tif(used[p.first])return;\n\tv.insert(lower_bound(v.begin(),v.end(),p),p);\n\tused[p.first]++;\n}\nvoid del1() {\n\tif(v.size())\n\t\tused[v.begin()->first]--,v.erase(v.begin());\n}\nvoid del2() {\n\tif(v.size())\n\t\tused[(--v.end())->first]--,v.erase(--v.end());\n}\nint a,b;\nsigned main() {\n#ifndef ONLINE_JUDGE//\u8ddfluogu\u4e0a\u7684julao\u4eec\u5b66\u7684\n\tfreopen(\"P2073_2.in\",\"r\",stdin);\n#endif\n\twhile(read(op),op!=-1) {\n\t\tif(op==1) {\n\t\t\tread(x),read(y);\n\t\t\tinsert(make_pair(y,x));//first->\u94b1,second->\u7f8e\u4e3d\u503c\n\t\t}\n\t\tif(op==2)del2();\n\t\tif(op==3)del1();\n\t}\n\tfor(vector<pair<int,int> >::iterator it=v.begin(); it!=v.end(); it++)\n\t\ta+=it->first,b+=it->second;\n\tprintf(\"%lld %lld\",b,a);\n}\n\n\n```\n",
        "postTime": 1595345692,
        "uid": 100325,
        "name": "peterwuyihong",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "### \u63d0\u4f9b\u4e00\u79cd\u601d\u8def\n~~\u56e0\u4e3a\u6211\u770b\u4e0d\u61c2\u522b\u4eba\u7684~~\n- \u4ee5**\u4ef7\u683c**\u7684\u5927\u5c0f\u5efa\u7ebf\u6bb5\u6811\u3002\n- \u53ef\u4ee5\u52a8\u6001\u5f00\u70b9\u3002 ~~\u597d\u50cf\u6ca1\u5fc5\u8981~~\n- sum\u5b58\u653e\u533a\u95f4\u7f8e\u4e3d\u503c\u548c\u3002\n- \u5220\u9664\u5c31\u6e05\u96f6\u6700\u5de6\uff08\u53f3\uff09\u6709\u503c\u7684\u533a\u95f4\n\n\u770b\u4ee3\u7801\u5c31\u53ef\u4ee5\u660e\u767d\n```cpp\n#pragma GCC optimize(3)\n#pragma GCC optimize(2)\n#include<bits/stdc++.h>\n#define ls (rt<<1)\n#define rs (rt<<1|1)\n#define mid ((l+r)>>1)\nusing namespace std;\ninline int re(){\n\tint x=0;bool f=1;char q=getchar();\n   while(q<'0'||q>'9'){if(q=='-')f=0;q=getchar();}\n\twhile(q>='0'&&q<='9'){x=x*10+q-'0';q=getchar();}\n   return f?x:-x;\n}\nconst int N=1000001;\nint sum[N<<2];//\u53ef\u4ee5\u52a8\u6001\u5f00\u70b9\ninline void add(int rt,int l,int r,int x,int k){\n\tif(l==r){\n\t\tif(!sum[rt])\n\t\t\tsum[rt]=k;\n\t\treturn;\n\t}\n\tif(x<=mid)\n\t\tadd(ls,l,mid,x,k);\n\telse\n\t\tadd(rs,mid+1,r,x,k);\n\tsum[rt]=sum[ls]+sum[rs];\n}\ninline void del_h(int rt,int l,int r){\n\tif(l==r){\n\t\tsum[rt]=0;\n\t\treturn;\n\t}\n\tif(sum[rs])//\u53f3\u533a\u95f4\u4ef7\u683c\u4e00\u5b9a\u9ad8\n\t\tdel_h(rs,mid+1,r);\n\telse if(sum[ls])//\u9632\u6b62\u6ca1\u6709\u70b9\n\t\tdel_h(ls,l,mid);\n\tsum[rt]=sum[ls]+sum[rs];\n}\ninline void del_l(int rt,int l,int r){\n\tif(l==r){\n\t\tsum[rt]=0;\n\t\treturn;\n\t}\n\tif(sum[ls])\n\t\tdel_l(ls,l,mid);\n\telse if(sum[rs])\n\t\tdel_l(rs,mid+1,r);\n\tsum[rt]=sum[ls]+sum[rs];\n}\ninline int query(int rt,int l,int r){\n\t//\u67e5\u8be2\u6240\u6709\u82b1\u4ef7\u683c\u548c\n\tif(sum[rt]==0)\n\t\treturn 0;\n\tif(l==r)\n\t\treturn l;//\u662f\u4ee5\u4ef7\u683c\u7684\u5927\u5c0f\u5efa\u7ebf\u6bb5\u6811\n\treturn query(ls,l,mid)+query(rs,mid+1,r);;\n}\nint main(){\n\tint type=re();\n\twhile(type!=-1){\n\t\tif(type==1)\n\t\t\tadd(1,1,N,re(),re());//\u8fd9\u91cc\u4f1a\u4ece\u5148\u8bfb\u5165\u540e\u9762\u7684\uff0c\u4e5f\u5c31\u662f..,c,w)\n\t\telse if(type==2)\n\t\t\tdel_h(1,1,N);\n\t\telse if(type==3)\n\t\t\tdel_l(1,1,N);\n\t\ttype=re();\n\t}\n   printf(\"%d %d\",sum[1],query(1,1,N));\n   return 0;\n} \n```\n",
        "postTime": 1583038435,
        "uid": 274264,
        "name": "\u00a7\u00a7\u00a7\u00a7\u00a7\u00a7\u00a7\u00a7\u00a7\u00a7",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "## \u5176\u5b9e\u8fd9\u9053\u9898\u53ef\u4ee5\u76f4\u63a5\u4f18\u5148\u961f\u5217\u641e\u3002\n\u56e0\u4e3a\u5728\u82b1\u675f\u4e2d\u540c\u4e00\u4e2a\u4ef7\u94b1\u7684\u82b1\u53ea\u4f1a\u6709\u4e00\u652f\uff0c\u6240\u4ee5\u6bcf\u4e2a\u4ef7\u94b1\u90fd\u4e00\u4e00\u5bf9\u5e94\u7740\u4e00\u4e2a\u4ef7\u94b1\uff0c\u5c31\u62ff\u4e00\u4e2a\u6570\u7ec4\u76f4\u63a5\u5b58\u5c31\u597d\u3002\n\n\u4e24\u4e2a\u5806\uff0c\u4e00\u4e2a\u5927\u6839\u5806\uff0c\u4e00\u4e2a\u5c0f\u6839\u5806\u3002\u7136\u540e\u6bcf\u6b21\u5b58\u7684\u65f6\u5019\u5224\u65ad\u4e0b\u6709\u6ca1\u91cd\u590d\u3002\n\n\u5bf9\u4e8e\u5220\u9664\u64cd\u4f5c\uff0c\u6211\u4eec\u5148\u628a\u4e0d\u5728\u82b1\u675f\u4e2d\u7684\u82b1pop\u6389(\u5177\u4f53\u89c1\u4ee3\u7801)\u7136\u540e\u518d\u5220\u9664\u3002\n\n\u601d\u8def\u7b80\u5355\uff0c\u4ee3\u7801\u4e5f\u5f88\u597d\u7406\u89e3\u3002\n\n\n------------\n```cpp\n#include<iostream>\n#include<queue>\n#include<cstring>\n#include<cstdio>\n#include<deque>\nusing namespace std;\nconst int N=4000006;\nlong long ans_val,ans_cost;\nint f[N];\npriority_queue<int>Qmax,Qmin;\nvoid ADD(){\n\tint w,c;\n\tscanf(\"%d%d\",&w,&c);\n\tif(f[c])return ;\n\tf[c]=w;\n\tans_val+=w;\n\tans_cost+=c;\n\tQmax.push(c);\n\tQmin.push(-c);\n}\nvoid dele_min(){\n\twhile(!Qmin.empty()&&!f[-Qmin.top()])Qmin.pop();\n\tif(!Qmin.empty()){\n\t\tint u=-Qmin.top();\n\t\tans_val-=f[u];\n\t\tans_cost-=u;\n\t\tf[u]=0;\n\t\tQmin.pop();\n\t}\n}\nvoid dele_max(){\n\twhile(!Qmax.empty()&&!f[Qmax.top()])Qmax.pop();\n\tif(!Qmax.empty()){\n\t\tint u=Qmax.top();\n\t\tans_val-=f[u];\n\t\tans_cost-=u;\n\t\tf[u]=0;\n\t\tQmax.pop();\n\t}\n}\nint main(){\n\tint x=0;\n\twhile(1){\n\t\tscanf(\"%d\",&x);\n\t\tif(x==-1)break;\n\t\tif(x==1)ADD();\n\t\tif(x==3)dele_min();\n\t\tif(x==2)dele_max();\n\t}\n\tcout<<ans_val<<\" \"<<ans_cost;\n}\n```\n",
        "postTime": 1570666845,
        "uid": 111290,
        "name": "\u706f\u706b\u8473\u8564",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "#### \u672c\u9898\u4e2d\uff0c\u9700\u8981\u4f7f\u7528\u7ebf\u6bb5\u6811\u7684\u5730\u65b9\u5e76\u4e0d\u662f\u6c42\u548c\uff0c\u800c\u662f\u786e\u5b9a\u4ef7\u503c\u6700\u5927\uff08\u6700\u5c0f\uff09\u7684\u82b1\u7684\u7f16\u53f7\u3002\n\n\u56e0\u4e3a\u9898\u4e2d\u9700\u8981\u6c42\u7684\u548c\u662f\u6240\u6709\u82b1\u7684\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u5b9a\u4e49\u4e24\u4e2a\u53d8\u91cf\uff0c\u63d2\u5165\u82b1\u65f6\u5bf9\u5e94\u76f8\u52a0\uff0c\u5220\u9664\u82b1\u65f6\u5bf9\u5e94\u76f8\u51cf\u5c31\u884c\u4e86\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u5bf9\u6bcf\u4e2a\u63d2\u5165\u7684\u82b1\u8fdb\u884c\u6807\u53f7\u3002\n\n\u4f46\u662f\u6211\u4eec\u53d1\u73b0\uff0c\u603b\u662f\u4f1a\u6709\u5f88\u591a\u82b1\u88ab\u5220\u9664\u540e\u7559\u4e0b\u4e86\u65e0\u7528\u7684\u7a7a\u95f4\u3002\u4e3a\u4e86\u8282\u7701\u7a7a\u95f4\u6211\u4eec\u7528\u4e00\u4e2a\u961f\u5217\u8bb0\u4e0b\u88ab\u5220\u9664\u7684\u82b1\u7684\u7f16\u53f7\uff0c\u7136\u540e\u628a\u5b83\u7ed9\u4e0b\u4e00\u4e2a\u63d2\u5165\u7684\u82b1\u3002\n\n\u4e4b\u540e\u6211\u4eec\u5b9a\u4e49\u6bd4\u8f83\u5927\u5c0f\u7684\u65b9\u6cd5\uff1a\u6839\u636e\u82b1\u7684\u4ef7\u503c\uff0c\u5c06\u4ef7\u503c\u6700\u5927\uff08\u6700\u5c0f\uff09\u7684\u7f16\u53f7\u653e\u5165\u7ebf\u6bb5\u6811\u4e2d\u3002\u7279\u522b\u6ce8\u610f\u7684\u662f\uff0c\u7a7a\u7684\u5355\u4f4d\u4ee5\u53ca\u88ab\u5220\u9664\u7684\u82b1\u7559\u4e0b\u7684\u7a7a\u4f4d\u662f\u4e0d\u80fd\u53c2\u4e0e\u6bd4\u8f83\u7684\u3002\n\n\u4e4b\u540e\u5c31\u7b80\u5355\u591a\u4e86\uff0c\u9700\u8981\u7684\u7ebf\u6bb5\u6811\u7684\u529f\u80fd\u53ea\u6709\u4e00\u4e2a\u4fee\u6539\u3002\u518d\u7528STL\u91cc\u7684map\u5224\u91cd\u5c31\u884c\u4e86\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<cstdio>\n#include<queue>\n#include<map>\n#define CH ch=getchar()\nusing namespace std;\ntypedef long long LL;\nint X,W;char ch;\ninline int read()\n{\n\tX=1,W=0;\n\tCH;\n\twhile(ch<'0'||ch>'9'){if(ch=='-')X=-1;CH;}\n\twhile(ch<='9'&&ch>='0'){W=W*10+ch-48;CH;}\n\treturn X*W;\n}\nstruct node{\n\tint w,c;\n}a[500001];\nstruct tree{\n\tint l,r;\n\tint ma,mi;\n}tr[2000001]; \nqueue <int> zh;\nmap <int,bool> mp;\nLL sumw,sumc;\nint max(int _,int _1)\n{\n\tif(a[_].c==0)return _1;\n\telse if(a[_1].c==0)return _;\n\telse return a[_].c>a[_1].c?_:_1;\n}\nint min(int _,int _1)\n{\n\tif(a[_].c==0)return _1;\n\telse if(a[_1].c==0)return _;\n\telse return a[_].c<a[_1].c?_:_1;\n}\nvoid build(int k)\n{\n\tint mid=(tr[k].l+tr[k].r)>>1;\n\ttr[k<<1].l=tr[k].l;\n\ttr[k<<1|1].l=mid+1;\n\ttr[k<<1].r=mid;\n\ttr[k<<1|1].r=tr[k].r;\n\tif(tr[k<<1].l!=tr[k<<1].r)build(k<<1);\n\tif(tr[k<<1|1].l!=tr[k<<1|1].r)build(k<<1|1);\n\treturn;\n}\nvoid change(int k,int g)\n{\n\tif(tr[k].l==g&&tr[k].r==g){\n\t\ttr[k].ma=tr[k].mi=g;\n\t\treturn;\n\t}\n\tif(g<=tr[k<<1].r)change(k<<1,g);\n\telse change(k<<1|1,g);\n\ttr[k].ma=max(tr[k<<1].ma,tr[k<<1|1].ma);\n\ttr[k].mi=min(tr[k<<1].mi,tr[k<<1|1].mi);\n}\nint main()\n{\n\tint op=read(),cnt=0,b,c,d,v,num=0;\n\ttr[1].r=500000,tr[1].l=1;\n\tbuild(1);\n\twhile(op!=-1){\n\t\tif(op==1){\n\t\t\tb=read(),c=read();\n\t\t\tif(mp[c]==true){\n\t\t\t\top=read();\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tmp[c]=true;\n\t\t\tif(zh.empty()==false)d=zh.front(),zh.pop();\n\t\t\telse d=++cnt;\n\t\t\ta[d].w=b,a[d].c=c;\n\t\t\tsumw+=(LL)b,sumc+=(LL)c;\n\t\t\tchange(1,d);\n\t\t\tnum++;\n\t\t}\n\t\tif(op==2){\n\t\t\tif(num==0){\n\t\t\t\top=read();\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tv=tr[1].ma;\n\t\t\tzh.push(v);\n\t\t\tmp[a[v].c]=false;\n\t\t\tsumw-=(LL)a[v].w;\n\t\t\tsumc-=(LL)a[v].c;\n\t\t\ta[v]=a[0];\n\t\t\tchange(1,v);\n\t\t\tnum--;\n\t\t}\n\t\tif(op==3){\n\t\t\tif(num==0){\n\t\t\t\top=read();\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tv=tr[1].mi;\n\t\t\tzh.push(v);\n\t\t\tmp[a[v].c]=false;\n\t\t\tsumw-=(LL)a[v].w;\n\t\t\tsumc-=(LL)a[v].c;\n\t\t\ta[v]=a[0];\n\t\t\tchange(1,v);\n\t\t\tnum--;\n\t\t}\n\t\top=read();\n\t}\n\tprintf(\"%lld %lld\",sumw,sumc);\n\treturn 0;\n}\n```",
        "postTime": 1547478310,
        "uid": 145240,
        "name": "wasked",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "\u5e73\u8861\u6811\u677f\u5b50\u9898  \n\u6211\u7528\u7684\u662fsplay\uff0c\u8fd9\u91cc\u53ea\u9700\u8981\u6dfb\u52a0\u548c\u5220\u9664\u64cd\u4f5c\u5c31\u884c\u4e86\uff0c\u5728\u6dfb\u52a0\u548c\u5220\u9664\u4e2d\u7edf\u8ba1\u7b54\u6848\uff0c\u6bcf\u4e2a\u8282\u70b9\u8bb0\u5f55\u4e24\u4e2a\u503cw\u548cc\uff0c\u6309c\u6765slay  \n\u6ce8\u610f\u9898\u76ee\u8bf4\uff1a\u5982\u679c\u52a0\u5165\u7684\u82b1\u6735\u4ef7\u683c\u5df2\u7ecf\u4e0e\u82b1\u675f\u4e2d\u5df2\u6709\u82b1\u6735\u4ef7\u683c\u91cd\u590d\uff0c\u5219\u8fd9\u4e00\u6735\u82b1\u4e0d\u80fd\u52a0\u5165\u82b1\u675f\u3002\n```cpp\n#include <bits/stdc++.h>\n#define rg register\n#define inl inline\ntypedef long long ll;\nconst int N = 1e5 + 10;\nusing namespace std;\nnamespace fast_IO {\n\tll read()\n\t{\n\t\trg ll num = 0;\n\t\trg char ch;\n\t\trg bool flag = false;\n\t\twhile ((ch = getchar()) == ' ' || ch == '\\n' || ch == '\\r');\n\t\tif (ch == EOF)return ch; if (ch == '-')flag = true; else num = ch ^ 48;\n\t\twhile ((ch = getchar()) != ' '&&ch != '\\n'&&ch != '\\r'&&~ch)\n\t\t\tnum = (num << 1) + (num << 3) + (ch ^ 48);\n\t\tif (flag)return -num; return num;\n\t}\n\tll max(rg ll a, rg ll b) { if (a > b)return a; return b; }\n\tll min(rg ll a, rg ll b) { if (a < b)return a; return b; }\n\tvoid write(rg long long x) { if (x < 0)putchar('-'), x = -x; if (x >= 10)write(x / 10); putchar(x % 10 ^ 48); }\n};\nint tree[N][2], fa[N], child[N][2], root, tot;\nll ans, ans2;\ninl int _search(rg int x, rg int w)\n{\n\twhile (tree[x][0] != w)\n\t{\n\t\tif (w < tree[x][0])\n\t\t\tif (child[x][0])x = child[x][0];\n\t\t\telse break;\n\t\telse\n\t\t\tif (child[x][1])x = child[x][1];\n\t\t\telse break;\n\t}\n\treturn x;\n}\ninl void _rotate(rg int x)\n{\n\trg int f = fa[x], gf = fa[f];\n\tchild[gf][child[gf][1] == f] = x;\n\tfa[x] = gf;\n\trg int w = x == child[f][1];\n\tchild[f][w] = child[x][w ^ 1];\n\tfa[child[x][w ^ 1]] = f;\n\tchild[x][w ^ 1] = f;\n\tfa[f] = x;\n}\ninl void splay(rg int x)\n{\n\twhile (fa[x])\n\t{\n\t\trg int f = fa[x], gf = fa[f];\n\t\tif (gf)\n\t\t\tif ((child[gf][0] == f) ^ (child[f][0] == x))\n\t\t\t\t_rotate(x);\n\t\t\telse _rotate(f);\n\t\t_rotate(x);\n\t}\n\troot = x;\n}\ninl void _insert(rg int c, rg int w)\n{\n\tif (!tot)\n\t{\n\t\tans2 += tree[tot = root = 1][0] = c;\n\t\tans += tree[1][1] = w; fa[1] = 0;\n\t\treturn;\n\t}\n\trg int k = _search(root, c), node;\n\tif (tree[k][0] == c)return;\n\tans2 += tree[++tot][0] = c, ans += tree[tot][1] = w;\n\tfa[tot] = k; child[k][c > tree[k][0]] = tot;\n\tsplay(k);\n}\ninl void _del(rg int x)\n{\n\tans2 -= tree[x][0], ans -= tree[x][1]; splay(x);\n\tif (child[x][0])\n\t{\n\t\tfa[child[x][0]] = 0;\n\t\trg int k = _search(child[x][0], INT_MAX); splay(k);\n\t\tchild[k][1] = child[x][1];\n\t\tfa[child[x][1]] = k;\n\t\ttree[x][0] = tree[x][1] = child[x][0] = child[x][1] = 0;\n\t}\n\telse\n\t{\n\t\tif (!(root = child[x][1]))tot = 0;\n\t\ttree[x][0] = tree[x][1] = fa[root] = child[x][1] = 0;\n\t}\n}\n\nint main()\n{\n\trg int opt;\n\twhile (~(opt = fast_IO::read()))\n\t\tswitch (opt)\n\t\t{\n\t\tcase 1:_insert(fast_IO::read(), fast_IO::read()); break;\n\t\tcase 2:_del(_search(root, INT_MAX)); break;\n\t\tcase 3:_del(_search(root, INT_MIN)); break;\n\t\t}\n\tfast_IO::write(ans); putchar(' '); fast_IO::write(ans2);\n\treturn 0;\n}\n\n```",
        "postTime": 1546656438,
        "uid": 87283,
        "name": "Zechariah",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "\u8fd9\u5176\u5b9e\u4e0d\u662f\u4e25\u683c\u610f\u4e49\u4e0a\u7684\u9898\u89e3\n\n\u53ea\u662f\u63d0\u9192\u5927\u5bb6\u4e00\u4e2a\u672c\u9898\u5927\u5751\n\n\u770b\u5230\u5f88\u591a\u4eba10\u5206\uff0cwa9\u4e2a\u70b9\uff0c\u8fd9\u91cc\u63d0\u9192\u5927\u5bb6\uff0c\u9898\u76ee\u5148\u5199\u76843\u64cd\u4f5c\uff0c\u540e\u5199\n\n\u76842\u64cd\u4f5c\uff0c\u5927\u5bb6\u770b\u770b\u6539\u5584\u4e00\u4e0b\u8fd9\u4e2a\u662f\u4e0d\u662f\u53ef\u4ee510\u5206\u2014>\u6ee1\u5206\n\n\u4f46\u662f\u4ecd\u7136\u8981\u7c98\u4e00\u4e0b\u7528STL\u7684\u4ee3\u7801\u554a\n\npriority_queue \u548c set\n\n\u91cc\u9762\u6709\u4e00\u5c0f\u70b9\u6ce8\u91ca\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define MAXN 100005\nusing namespace std;\nbool vis[MAXN];\nstruct Node{\n    int w,c,id;\n    Node(int w=0,int c=0,int id=0):w(w),c(c),id(id){}\n    bool operator < (const Node& n1) const{\n        if(n1.c==c) return n1.id<id;\n        return n1.c<c;\n    }\n};//pianyi\nstruct Node1{\n    int w,c,id;\n    Node1(int w=0,int c=0,int id=0):w(w),c(c),id(id){}\n    bool operator < (const Node1& n1) const{\n        if(n1.c==c) return n1.id<id;\n        return n1.c>c;\n    }\n};//gui\npriority_queue<Node> q1;\npriority_queue<Node1> q2;\nset<int> s;\nll answ;\nll ansc;\nint cnt;\nint main(){\n    int opt;\n    while(scanf(\"%d\",&opt)){\n        if(opt==-1) break;\n        if(opt==1){\n            int w,c;\n            scanf(\"%d%d\",&w,&c);\n            if(s.count(c)) continue;\n            else s.insert(c);\n            cnt++;\n            q1.push(Node(w,c,cnt));\n            q2.push(Node1(w,c,cnt));\n            vis[cnt]=1;\n        }\n        else if(opt==3){//shan pian yi\n            while(!q1.empty()&&vis[q1.top().id]==0){\n                q1.pop();\n            }\n            if(!q1.empty()){\n                Node u=q1.top();\n                q1.pop();\n                s.erase(u.c);\n                vis[u.id]=0;\n            }\n        }\n        else{//shan gui\n            while(!q2.empty()&&vis[q2.top().id]==0){\n                q2.pop();\n            }\n            if(!q2.empty()){\n                Node1 u=q2.top();\n                q2.pop();\n                s.erase(u.c);\n                vis[u.id]=0;\n            }\n        }\n    }\n    while(!q1.empty()){\n        Node u=q1.top();\n        q1.pop();\n        if(vis[u.id]==1){\n            ansc+=u.c;\n            answ+=u.w;\n            vis[u.id]=0;\n        }\n    }\n    printf(\"%lld %lld\",answ,ansc);\n    return 0;\n}\n```",
        "postTime": 1539668735,
        "uid": 45696,
        "name": "gogoduan",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "\u53ea\u6709\u8fd9\u4e9b\u64cd\u4f5c\u4e3a\u4ec0\u4e48\u8981\u7528\u5e73\u8861\u6811\u5462\uff1f\n  \n\u76f4\u63a5\u7528set\u5373\u53ef\u3002\u53cd\u5411\u8fed\u4ee3\u5668erase\u8981\u8f6c\u6210\u6b63\u5411\u8fed\u4ee3\u5668\u6709\u70b9\u9ebb\u70e6\uff0c\u76f4\u63a5\u66b4\u529berase ( find )\n\nAC\u4ee3\u7801\uff0c\u5f00O2\u8dd1\u7684\u98de\u5feb\n\n```c\n#include <iostream>\n#include <cstdio>\n#include <set>\n\nusing namespace std;\n\ninline int R()\n{\n    char ch = getchar();\n    int rt = 0;\n    bool isn = false;\n    for ( ; ch > '9' || ch < '0'; ch = getchar() )\n        isn = ch == '-' ? true : isn;\n    for ( ; ch <= '9' && ch >= '0'; ch = getchar() )\n        rt = rt * 10 + ch - '0';\n    return isn ? -rt : rt;\n}\n\nset<int> f;\nint bt[1000003];\nlong long ans, cst;\n\nint main ()\n{\n\tfor ( int op = R(); op != -1; op = R() )\n\t{\n\t\tif ( op == 1 )\n\t\t{\n\t\t\tint w = R(), c = R();\n\t\t\tif ( !bt[c] )\n\t\t\t\tbt[c] = w, f.insert ( c ), ans += w, cst += c;\n\t\t\tcontinue;\n\t\t}\n\t\tif ( op == 3 && !f.empty() )\n\t\t{\n\t\t\tans -= bt[*f.begin()], cst -= *f.begin(), bt[*f.begin()] = 0;\n\t\t\tf.erase ( f.begin() );\n\t\t\tcontinue;\n\t\t}\n\t\tif ( op == 2 && !f.empty() )\n\t\t{\n\t\t\tans -= bt[*f.rbegin()], cst -= *f.rbegin(), bt[*f.rbegin()] = 0;\n\t\t\tf.erase ( f.find ( *f.rbegin() ) );\n\t\t\tcontinue;\n\t\t}\n\t}\n\tprintf ( \"%lld %lld\\n\", ans, cst );\n\treturn 0;\n}\n```",
        "postTime": 1524054565,
        "uid": 13268,
        "name": "nansns",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "### \u601d\u8def\uff1azkw\u6743\u503c\u7ebf\u6bb5\u6811\n\n\u4f60\u53ef\u80fd\u542c\u8fc7zkw\u7ebf\u6bb5\u6811\uff0c\u53ef\u80fd\u542c\u8fc7\u6743\u503c\u7ebf\u6bb5\u6811\uff0c\u4f46\u4f60\u542c\u8fc7zkw\u6743\u503c\u7ebf\u6bb5\u6811\u5417qwq\uff1f\n\n\u6211\u4eec\u77e5\u9053zkw\u7ebf\u6bb5\u6811\u662f\u4e00\u79cd\u6ee1\u4e8c\u53c9\u6811\uff0c\u4f46\u662f\u8ba9\u5b83\u50cf\u4e8c\u53c9\u641c\u7d22\u6811\u4e00\u6837\u6309\u7167k<<1\u9012\u5f52\u6c42\u89e3\u6709\u4e9b\u56f0\u96be\uff0c\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u5c06MAXN\u5f00\u5230**2\u7684\u6574\u6570\u6b21\u5e42-1**\uff0c\u540c\u65f6\u8fd9\u4e5f\u65b9\u4fbf\u4e86\u6211\u4eec\u6700\u540e\u7684\u67e5\u8be2\u3002\n\n\u7136\u540e\u5c31\u662f\u6109\u5feb\u7684\u5355\u70b9\u4fee\u6539\u4e0e\u9012\u5f52\u5220\u9664\u5566\n\n\u4e0a\u4ee3\u7801\u2193\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nconst int MAXN=(1<<17)-1;\n\nbool tree[MAXN+1<<1];\nstruct rpg{\n    int p,x,y,id;\n    int rey;\n    bool fl;\n}a[MAXN];\n\nbool cmp1(rpg a,rpg b){\n\tif(a.p==1&&b.p==1&&a.y==b.y) return a.id<b.id; \n    if(a.p==1&&b.p==1) return a.y<b.y;\n    return a.p<b.p;\n}bool cmp2(rpg a,rpg b){\n    return a.id<b.id;\n}\n\nvoid dfs1(int k){\n    if(k>MAXN){\n        tree[k]=0;\n        return;\n    }if(tree[k<<1|1]) dfs1(k<<1|1);\n    else if(tree[k<<1]) dfs1(k<<1);\n    tree[k]=tree[k<<1]|tree[k<<1|1];\n    return;\n}\n\nvoid dfs2(int k){\n    if(k>MAXN){\n        tree[k]=0;\n        return;\n    }if(tree[k<<1]) dfs2(k<<1);\n    else if(tree[k<<1|1]) dfs2(k<<1|1);\n    tree[k]=tree[k<<1]|tree[k<<1|1];\n    return;\n}\n\nvoid init(){\n    while(scanf(\"%d\",&a[++a[0].p].p)==1&&a[a[0].p].p>0){\n        a[a[0].p].id=a[0].p;\n        if(a[a[0].p].p==1) scanf(\"%d%d\",&a[a[0].p].x,&a[a[0].p].y);\n    }sort(a+1,a+a[0].p,cmp1);\n    a[1].rey=1;\n    for(int i=2;a[i].p==1;++i){\n        if(a[i].y==a[i-1].y) a[i].rey=a[i-1].rey;\n        else a[i].rey=a[i-1].rey+1;\n    }sort(a+1,a+a[0].p,cmp2);\n    return;\n}\n\nvoid solve(){\n    for(int i=1;i<a[0].p;++i){\n        if(a[i].p==1){\n        \tif(tree[MAXN+a[i].rey]){\n        \t\ta[i].fl=1;\n        \t\tcontinue;\n\t\t\t}for(int j=MAXN+a[i].rey;j;j>>=1) tree[j]=1;\n        }else if(a[i].p==2) dfs1(1);\n        else dfs2(1);\n    }return;\n}\n\nvoid write(){\n    long long sum1=0,sum2=0;\n    sort(a+1,a+a[0].p,cmp1);\n    for(int i=1;a[i].p==1;++i){\n        if(tree[MAXN+a[i].rey]&&(!a[i].fl&&(a[i+1].rey!=a[i].rey||a[i+1].fl))){\n            sum1+=a[i].x;\n            sum2+=a[i].y;\n        }\n    }printf(\"%lld %lld\\n\",sum1,sum2);\n    return;\n}\n\nint main(){\n    init();\n    solve();\n    write();\n    return 0;\n}\n```",
        "postTime": 1522491938,
        "uid": 31293,
        "name": "Adove",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "**\u8fd9\u4e0d\u662f\u6a21\u62df\u4e48**\n\n\n\u4e3a\u4ec0\u4e48\u90fd\u7528\u5e73\u8861\u6811\uff0c\u7ebf\u6bb5\u6811\u8fd9\u4e48\u9ad8\u7ea7\u7684\u4e1c\u897f\u3002\u3002\n\n\u6211\u8fd9\u4e48\u849f\u84bb\u65e0\u5730\u81ea\u5bb9\u3002\n\n\n\u4e8e\u662f\u6211\u6478\u6478\u638f\u51fa\u4e86\u4f18\u5148\u961f\u5217\u3010\u4e0d\u5c31\u662f\u8981\u5220\u6700\u5927\u6700\u5c0f\u4e48\uff0c\u4e3a\u4f55\u4e0d\u7528\u4f18\u5148\u961f\u5217\uff0c\u591a\u7b80\u5355\u3011\n\n\u4e8e\u662f\u6211\u5f00\u4e86\u4e24\u4e2a\u4f18\u5148\u961f\u5217\uff0c\u4e00\u4e2a\u9012\u589e\u4e00\u4e2a\u9012\u51cf\uff0c\u6bcf\u6b21\u6a21\u62df\u6dfb\u52a0\u3001\u5220\u9664\u5c31\u597d\u4e86\n\n\n\u5982\u679c\u4f60\u8981\u95ee\uff0c\u82e5\u5728\u9012\u589e\u4e2d\u628a\u6700\u5c0f\u7684\u5220\u4e86\uff0c\u90a3\u9012\u51cf\u7684\u961f\u5217\u4e2d\u600e\u4e48\u628a\u5b83\u5220\u6389\uff1f\n\n**\u4e0d\u7528\u5220\uff01**\u53cd\u6b63\u6bcf\u4e2a\u4ef7\u683c\u7684\u7269\u54c1\u53ea\u80fd\u6709\u4e00\u4e2a\uff0c\u7528\u4e00\u4e2a\u6570\u7ec4\u6807\u8bb0\u6709\u6ca1\u6709\u5c31\u597d\u4e86\uff0c\u987a\u4fbf\u7528\u8fd9\u4e2a\u6570\u7ec4\u50a8\u5b58\u6bcf\u4e2a\u4ef7\u683c\u5bf9\u5e94\u7684\u7f8e\u4e3d\u503c\n\n\u8fd9\u6837\u5c31\u4fdd\u8bc1\u4e86\u552f\u4e00\u6027\uff0c\u7edd\u4e0d\u4f1a\u6709\u91cd\u590d\u7684\u7269\u54c1\n\n\u5728\u6bcf\u6b21\u5220\u9664\u64cd\u4f5c\u65f6\uff0c\u5148\u6e05\u7a7a\u961f\u5217\u524d\u7aef\u5df2\u7ecf\u4e0d\u5b58\u5728\u7684\u7269\u54c1\uff0c\u55ef\u6ca1\u6bdb\u75c5\u3002\u3002\n\n\n\u771f\u7684\u662f\u6a21\u62df\uff1a\n\n\n\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<queue>\n#include<vector>\n#include<algorithm>\nusing namespace std;\nconst int maxn=1000005,INF=2000000000;\nint totb=0,totm=0,v[maxn];  //tot\u50a8\u5b58\u7b54\u6848,v\u662f\u4ef7\u683c\u5bf9\u7f8e\u4e3d\u503c\u5f97\u6620\u5c04,\u6ca1\u6709\u7684\u65f6\u5019\u4e3a0\npriority_queue<int> ql;          //\u9012\u51cf\u961f\u5217\npriority_queue<int,vector<int>,greater<int> > qs;//\u9012\u589e\u5e8f\u5217\nint read()  //\u8bfb\u5165\u4f18\u5316\n{\n    int out=0,flag=1;\n    char c=getchar();\n    while(c<48||c>57) {if(c=='-') flag=-1;c=getchar();}\n    while(c>=48&&c<=57)\n    {\n        out=out*10+c-48;\n        c=getchar();\n    }\n    return out*flag;\n}\nint main()\n{\n    fill(v,v+maxn,0);\n    int cmd,w,c;\n    while(true)\n    {\n        cmd=read();\n        if(cmd==1)\n        {\n            w=read();\n            c=read();\n            if(!v[c]){totb+=w;totm+=c;v[c]=w;ql.push(c);qs.push(c);}\n        }\n        else if(cmd==2)\n        {\n            while(!ql.empty()&&!v[ql.top()]) ql.pop(); //\u5df2\u88ab\u5220\u5c31\u5ffd\u7565\u6389\uff0c\u4e0b\u540c\n            if(!ql.empty()) {c=ql.top();totb-=v[c];totm-=c;v[c]=0;ql.pop();}\n        }\n        else if(cmd==3)\n        {\n            while(!qs.empty()&&!v[qs.top()]) qs.pop();\n            if(!qs.empty()) {c=qs.top();totb-=v[c];totm-=c;v[c]=0;qs.pop();}\n        }\n        else break;\n    }\n    cout<<totb<<' '<<totm<<endl;    //\u5982\u6b64\u7b80\u5355\n    return 0;\n}\n\n```",
        "postTime": 1497756051,
        "uid": 32842,
        "name": "Mychael",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "\u7ebf\u6bb5\u6811\uff0c\u5566\u5566\u5566\u5566\u5566\u5566\u5566\n\n\u52a0\u70b9\u4e48\u76f4\u63a5\u52a0\u597d\u4e86\uff0c\u8bfb\u5165\u4e00\u4e2a\u52a0\u4e00\u4e2a\uff1b\n\n\u5220\u76f4\u63a5\u628a\u90a3\u4e2a\u70b9\u53d8\u5230\u521d\u59cb\u5316\uff1b\n\n\u6bcf\u4e00\u4e2a\u70b9\u7ef4\u62a4\u4e00\u4e2amax\u548cmin\n\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#define Ll long long\nusing namespace std;\nstruct tree{\n    Ll xx,yy,mi,ma,mmi,mma;\n}T[100000*8+1];\nstruct flower{\n    Ll x,y;\n}f[100001];\nbool money[1000001];\nLl n,m,x,y,z,ll,ans,p;\nvoid maketree(int x,int y,int num){\n    T[num].xx=x;T[num].yy=y;T[num].ma=-1e9;T[num].mi=1e9;\n    if(x==y)return;\n    int mid=(x+y)>>1;\n    maketree(x,mid  ,num+num  );\n    maketree(mid+1,y,num+num+1);\n}\nvoid pluss(int x,int num){\n    if(f[x].y>T[num].ma){T[num].ma=f[x].y;T[num].mma=x;}                                                                           \n    if(f[x].y<T[num].mi){T[num].mi=f[x].y,T[num].mmi=x;}\n    if(T[num].xx==T[num].yy)return;\n    num=num<<1;\n    if(x<=T[num  ].yy)pluss(x,num  );\n    if(x>=T[num+1].xx)pluss(x,num+1);\n}\nvoid dec(int x,int num){\n    T[num].ma=-1e9;T[num].mi=1e9;\n    if(T[num].xx==T[num].yy)return;\n    num=num<<1;\n    if(x<=T[num  ].yy)dec(x,num  );\n    if(x>=T[num+1].xx)dec(x,num+1);\n    int k=num>>1;\n    if(T[num  ].ma>T[k].ma){T[k].ma=T[num  ].ma;T[k].mma=T[num  ].mma;}\n    if(T[num+1].ma>T[k].ma){T[k].ma=T[num+1].ma;T[k].mma=T[num+1].mma;}        \n    if(T[num  ].mi<T[k].mi){T[k].mi=T[num  ].mi;T[k].mmi=T[num  ].mmi;}\n    if(T[num+1].mi<T[k].mi){T[k].mi=T[num+1].mi;T[k].mmi=T[num+1].mmi;}    \n}\nint main()\n{\n    maketree(1,1e5,1);\n    while(cin>>x){\n        if(x==-1)break;\n        if(x==1){\n            cin>>x>>y;\n            if(money[y])continue;\n            money[y]=1;\n            ll++;p++;\n            f[ll].x=x;\n            f[ll].y=y;\n            pluss(ll,1);\n        }else if(x==2&&p){\n            x=T[1].mma;\n            money[f[x].y]=0;\n            f[x].x=f[x].y=0;\n            dec(x,1);p--;\n        }else if(x==3&&p){\n            x=T[1].mmi;\n            money[f[x].y]=0;\n            f[x].x=f[x].y=0;\n            dec(x,1);p--;\n        }\n    }\n    for(int i=1;i<=ll;i++)ans+=f[i].x;printf(\"%d \",ans);ans=0;\n    for(int i=1;i<=ll;i++)ans+=f[i].y;printf(\"%d\",ans);\n}\n\n```",
        "postTime": 1487059660,
        "uid": 7442,
        "name": "\u5de8\u578b\u65b9\u5757",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u7684\u89e3\u6cd5\u662f\u771f\u7684\u591a...\n\n1. \u4f18\u5148\u961f\u5217\u6c34\u8fc7(600~700ms)\n2. STL\u5806\u98d8\u8fc7(600~700ms)\n3. splay\u5e73\u8861\u6811\u8eba(\u4e0d)\u8fc7(\u5de8\u5751)\n4. \u61d2\u4ebatreap(\u61d2\u7684\u6253)(\u672a\u77e5)\n\n\n---\n\n\u4f18\u5148\u961f\u5217...\u4e24\u4e2a\u961f\u5217,\u4e00\u4e2a\u5927\u6839\u4e00\u4e2a\u5c0f\u6839,\u7528\u4ef7\u683c\u5f53\u5173\u952e\u503c\n\n\u518d\u5f00\u4e2a\u6570\u7ec4\u8bb0\u5f55\u4ef7\u683c\u5bf9\u5e94\u7684\u82b1\u6735\u4ef7\u503c\n```cpp\n//by Judge(\u4f18\u5148\u961f\u5217)\n#include<iostream>\n#include<cstdio>\n#include<queue>\n#define ll long long\n#define fp freopen\nusing namespace std;\nconst int M=1e6+111;\nconst int inf=1e9+7;\ninline int read(){\n\tint x=0,f=1; char c=getchar();\n\tfor(;!isdigit(c);c=getchar()) if(c=='-') f=-1;\n\tfor(;isdigit(c);c=getchar()) x=x*10+c-'0';\n\treturn x*f;\n}\nint opt; ll val,cos;\npriority_queue<int,vector<int>,greater<int> > qmin;\npriority_queue<int> qmax;\nint v[M],w,c;\ninline void insert(){\n\tw=read(); if(v[c=read()]) return ;\n\tqmin.push(c),qmax.push(c),v[c]=w,val+=w,cos+=c;\n}\ninline void delmax(){\n\twhile(!qmax.empty() && !v[qmax.top()]) qmax.pop();\n\tif(!qmax.empty()) c=qmax.top(),w=v[c],val-=w,cos-=c,v[c]=0;\n}\ninline void delmin(){\n\twhile(!qmin.empty() && !v[qmin.top()]) qmin.pop();\n\tif(!qmin.empty()) c=qmin.top(),w=v[c],val-=w,cos-=c,v[c]=0;\n}\nint main(){\n\twhile((opt=read())!=-1)\n\t\tswitch(opt){\n\t\t\tcase 1: insert(); break;\n\t\t\tcase 2: delmax(); break;\n\t\t\tcase 3: delmin(); break;\n\t\t}\n\tprintf(\"%lld %lld\\n\",val,cos);\n\treturn 0;\n}\n```\n\n\u4e00\u4e2a\u5806,\u4f2a\u4e00\u4e0b\u5e73\u8861\u6811,\u4e00\u68f5\u5927\u7684\u5728\u5de6,\u4e00\u68f5\u5c0f\u7684\u5728\u5de6\n\n\u6700\u540e\u904d\u5386\u6811\u76f4\u63a5\u8f93\u51fa\n\n```cpp\n//by Judge(set)\n#include<iostream>\n#include<cstdio>\n#include<set>\n#define ll long long\n#define fp freopen\nusing namespace std;\nconst int M=1e6+111;\nconst int inf=1e9+7;\ninline int read(){\n\tint x=0,f=1; char c=getchar();\n\tfor(;!isdigit(c);c=getchar()) if(c=='-') f=-1;\n\tfor(;isdigit(c);c=getchar()) x=x*10+c-'0';\n\treturn x*f;\n}\nstruct f1{\n\tint w,c;\n\tfriend bool operator <(const f1& a,const f1& b){ return a.c>b.c; }\n};\nstruct f2{\n\tint w,c;\n\tfriend bool operator <(const f2& a,const f2& b){ return a.c<b.c; }\n};\nint opt; ll val,cos;\nset<f1> smax; set<f2> smin;\ninline void insert(){\n\tint w=read(),c=read();\n\tsmax.insert((f1){ w,c }), smin.insert((f2){ w,c });\n}\ninline void delmax(){\n\tint w=smax.begin()->w,c=smax.begin()->c; \n\tsmax.erase(*smax.begin()), smin.erase((f2){ w,c });\n}\ninline void delmin(){\n\tint w=smin.begin()->w,c=smin.begin()->c; \n\tsmin.erase(*smin.begin()), smax.erase((f1){ w,c });\n}\nint main(){\n\twhile((opt=read())!=-1)\n\t\tswitch(opt){\n\t\t\tcase 1: insert(); break;\n\t\t\tcase 2: delmax(); break;\n\t\t\tcase 3: delmin(); break;\n\t\t}\n\tset<f1>::iterator i;\n\tfor(i=smax.begin();i!=smax.end();++i)\n\t\tval+=i->w, cos+=i->c;\n\tprintf(\"%lld %lld\\n\",val,cos);\n\treturn 0;\n}\n```\n\n\u611f\u89c9\u6ca1\u4ec0\u4e48\u95ee\u9898,\u5c31\u662f\u53ea\u8fc7\u4e865\u4e2a\u70b9~~woc~~\n\n\u6709\u5927\u4f6c\u7684\u8bdd\u5e2e\u5fd9\u770b\u770b\u884c\u5426\uff1f\n\n```cpp\n//by Judge(splay,WA\u4e865\u4e2a\u70b9,\u6c42\u6551)\n#include<iostream>\n#include<cstdio>\n#define ll long long\nusing namespace std;\nconst int M=1e5+111;\nconst int inf=1e9+7;\ninline int read(){\n\tint x=0,f=1; char c=getchar();\n\tfor(;!isdigit(c);c=getchar()) if(c=='-') f=-1;\n\tfor(;isdigit(c);c=getchar()) x=x*10+c-'0';\n\treturn x*f;\n}\nint root,num; ll tot1,tot2;\nint f[M],ch[M][2],key[M],val[M];\ninline int get(int x){ return x==ch[f[x]][1]; }\ninline void rotate(int x){ int y=f[x],z=f[y],sx=get(x),sy=get(y),son=ch[x][sx^1]; f[son]=y,ch[y][sx]=son,f[y]=x,ch[x][sx^1]=y,f[x]=z,ch[z][sy]=x; }\ninline void splay(int x,int to){ for(int fa=f[x];fa!=to;rotate(x),fa=f[x]) if(f[fa]!=to) rotate(get(x)==get(fa)?fa:x); if(!to) root=x; }\ninline int find(int x,int k){\n\tint now=root; while(ch[now][x>key[now]] && key[now]!=x) now=ch[now][x>key[now]]; \n\tsplay(now,0),now=ch[now][k],k^=1; while(ch[now][k]) now=ch[now][k]; return now;\n}\ninline void insert(int w,int c){\n\tint now=root,fa=0; while(now && key[now]!=c) fa=now,now=ch[now][c>key[now]];\n\tif(!now){ ch[++num][0]=ch[num][1]=0,key[num]=c,val[num]=w,f[num]=fa,tot1+=w,tot2+=c; if(fa) ch[fa][c>key[fa]]=num; } splay(num,0);\n}\ninline void delt(int x){ int pre=find(x,0),post=find(x,1); splay(pre,0), splay(post,pre),x=ch[post][0],tot1-=val[x],tot2-=key[x],ch[post][0]=0; }\nint opt,w,c;\nint main(){\n\tinsert(0,-inf),insert(0,inf);\n\twhile((opt=read())!=-1)\n\t\tswitch(opt){\n\t\t\tcase 1: w=read(),c=read(),insert(w,c); break;\n\t\t\tcase 2: c=key[find(inf,0)]; if(c!=-inf) delt(c); break;\n\t\t\tcase 3: c=key[find(-inf,1)]; if(c!=inf) delt(c); break;\n\t\t}\n\tprintf(\"%lld %lld\\n\",tot1,tot2); return 0;\n}\n```\n\n\n~~\u6c34\u5b8c\u4e00\u7bc7\u9898\u89e3~~",
        "postTime": 1533370486,
        "uid": 38576,
        "name": "J\u03bcdge",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "\u4e3a\u4ec0\u4e48\u4e0d\u8003\u8651ZKW\u5462\uff1f\n\n\u5185\u5b58\u663e\u7136\u662f\u53ef\u4ee5\u5b58\u4e0b\u7684\n\n\u4ee5C\uff08\u4ef7\u683c\uff09\u4e3a\u5173\u952e\u5b57\u5efa\u6743\u503cZKW\u7ebf\u6bb5\u6811\n\n\u7136\u540e\u5220\u7684\u65f6\u5019\u76f4\u63a5\u627e\u6700\u5927\u6700\u5c0f\n\n\u6700\u540e\u7d2f\u52a0\u7b54\u6848\u5c31\u53ef\u4ee5\u4e86\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\n\ntemplate< typename Type >inline void Read( Type &In ){\n    In=0;char ch=getchar();Type f = 1;\n    for( ;ch> '9'||ch< '0';ch=getchar() )if( ch=='-' )f = -1;\n    for( ;ch>='0'&&ch<='9';ch=getchar() )In = In*10 + ch-'0';In *= f;\n}\n\nstatic const int MAXN = 1e6 +1;\nstatic const int M    = 1048576;\ntypedef long long LL;\n\nint Opt,W,C,Ct;LL T_c,T_w;\nint d[3][MAXN<<2];//d[0]\u8868\u793a\u6700\u5c0f\u7684\u4ef7\u683c d[1]\u8868\u793a\u6700\u5927\u7684\u4ef7\u683c d[2]\u8868\u793a\u7f8e\u4e3d\u503c\n\nvoid Mf( int x,int k ){\n    x += M;if( d[2][x] )return;Ct++;\n    d[0][x] = d[1][x] = x;d[2][x] = k;\n    for( x>>=1;x;x>>=1 )\n        d[0][x] = min( d[0][x<<1],d[0][x<<1|1] ),\n        d[1][x] = max( d[1][x<<1],d[1][x<<1|1] );\n}\nint Qm(){\n    int Res = 0;\n    for( int s=M,t=M<<1;s^t^1;s>>=1,t>>=1 ){\n        if( ~s&1 )Res = max( Res,d[1][s^1] );\n        if(  t&1 )Res = max( Res,d[1][t^1] );\n    }\n    return Res;\n}\nint Qn(){\n    int Res = 0x7fffffff;\n    for( int s=M,t=M<<1;s^t^1;s>>=1,t>>=1 ){\n        if( ~s&1 )Res = min( Res,d[0][s^1] );\n        if(  t&1 )Res = min( Res,d[0][t^1] );\n    }\n    return Res;\n}\nvoid Del( int x ){\n    d[0][x] = 0x7fffffff;\n    d[1][x] = d[2][x] = 0;\n    for( x>>=1;x;x>>=1 )\n        d[0][x] = min( d[0][x<<1],d[0][x<<1|1] ),\n        d[1][x] = max( d[1][x<<1],d[1][x<<1|1] );\n}\n\nint main(){\n    \n    memset( d[0],0x3f,sizeof d[0] );\n    while( Opt!=-1 ){\n        Read( Opt );\n        switch( Opt ){\n            case 1:Read( W );Read( C );Mf( C,W );break;\n            case 2:if( Ct )Del( Qm() ),Ct--;break;\n            case 3:if( Ct )Del( Qn() ),Ct--;break;\n        }\n    }\n    for( int x=M+1;x<=M<<1;x++ )\n        if( d[2][x] )T_w += d[2][x],T_c += x-M;//\u7d2f\u52a0\n    \n    printf(\"%lld %lld\\n\",T_w,T_c);\n    return 0;\n}\n```\n\n\u5bf9\u4e8e\u8fd9\u9898\u7528STL\u7684\u4eba\uff0c\u6211\u8868\u793a\u5c31\u8fd9\u6837\u628a\u7ec3\u624b\u7684\u9898\u7ed9\u6d6a\u8d39\u4e86\n",
        "postTime": 1493813138,
        "uid": 20116,
        "name": "never_see",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    },
    {
        "content": "\n```cpp\n//\u66b4\u529b\u72c2\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nint cnt=0;\nint x;\nbool flag=0;\nbool xx[1000001]={0};\nusing namespace std;\nstruct node{\n    int w,c;\n}h[100010];\nbool find(int l,int r,int xx)\n{\n    for(int i=l;i<=r;i++)\n      if(h[i].c==xx)\n        return 0;\n    return 1;\n    /*int mid=(l+r)/2;\n    if(h[mid].c==xx)\n      return 0;\n    else if(h[mid].c<xx)\n      find(mid+1,r,xx);\n    else\n      find(l,mid-1,xx);\n    return 1;*/\n}\nint cmp2(const node a,const node b)\n{\n    return a.c>b.c;\n}\nint cmp1(const node a,const node b)//cong xiao dao da\n{\n    return a.c<b.c;\n}\nvoid ex()\n{\n    sort(h+1,h+cnt+1,cmp1);\n    xx[h[cnt].c]=0;\n    cnt--;\n}\nvoid cheap()\n{\n    sort(h+1,h+cnt+1,cmp2);\n    xx[h[cnt].c]=0;\n    cnt--;\n}\nint main()\n{\n    scanf(\"%d\",&x);\n    while(x!=-1)\n    {\n        if(x==1)\n        {\n            int a,b;\n            scanf(\"%d%d\",&a,&b);\n            if(cnt==0)\n            {\n                xx[b]=1;\n                cnt++;\n                h[cnt].w=a;\n                h[cnt].c=b;\n            }\n            else\n            {\n                //sort(h+1,h+cnt+1,cmp1);\n                if(xx[b]==0)\n```\ncnt++,\n```cpp\n                    xx[b]=1,\n                    h[cnt].w=a,\n                    h[cnt].c=b;\n            }\n        }\n        if(x==2)\n          if(cnt>0)\n            ex();\n        if(x==3)\n          if(cnt>0)\n            cheap();\n        scanf(\"%d\",&x);\n    }\n    int ans1=0,ans2=0;\n    for(int i=1;i<=cnt;i++)\n        ans1+=h[i].w,\n        ans2+=h[i].c;\n    printf(\"%d %d\",ans1,ans2);\n    return 0;\n}\n```",
        "postTime": 1471865577,
        "uid": 17257,
        "name": "lemon",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2073 \u3010\u9001\u82b1\u3011"
    }
]
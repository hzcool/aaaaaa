[
    {
        "content": "# Parity Game\n\n\u8fd9\u9898\u9700\u8981\u7528\u5230\uff1a\u79cd\u7c7b\u5e76\u67e5\u96c6\uff08\u4e5f\u53eb\u6269\u5c55\u57df\uff09\uff0c\u79bb\u6563\u5316\u3002\n\n### [\u4e0d\u4e86\u89e3\u5e76\u67e5\u96c6\u7684\u8bf7\u79fb\u6b65](https://www.luogu.com.cn/problem/P3367)\n\n### \u5173\u4e8e\u672c\u9898\u4e3b\u8981\u505a\u6cd5\n\n\u7531\u4e8e\u6570\u5217\u4e2d\u53ea\u6709 $0$ \u6216 $1$\uff0c\u90a3\u4e48\u4f7f\u5148\u5f00\u4e00\u4e2a $s$ \u6570\u7ec4\u8868\u793a\u524d\u7f00\u548c\uff0c\u90a3\u4e48\uff1a\n\n$s[j]-s[i-1]$ \u662f\u5947\u6570\u65f6\uff0c\u5219 $[i..j]$ \u533a\u95f4\u4e2d\u7684 $1$ \u7684\u4e2a\u6570\u4e3a\u5947\u6570\uff0c\u53cd\u4e4b\uff0c\u4e3a\u5076\u6570\u3002\n\n\u533a\u95f4\u7684\u5173\u7cfb\u662f\u5df2\u77e5\u7684\uff0c\u800c $s$ \u662f\u672a\u77e5\u7684\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u7528\u533a\u95f4\u7684\u6761\u4ef6\u6765\u9650\u5b9a\u524d\u7f00\u548c\uff0c\u5982\u679c\u51fa\u73b0\u5947\u5076\u6027\u7684\u77db\u76fe\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u8f93\u51fa\u3002\n\n### \u5173\u4e8e\u79cd\u7c7b\u5e76\u67e5\u96c6\n\n\u6269\u5c55\u57df\uff0c\u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u5c06\u539f\u6765\u5e76\u67e5\u96c6\u6269\u5927\uff0c\u5df2\u8fbe\u5230\u50a8\u5b58\u6bcf\u4e2a\u5143\u7d20\u7684\u591a\u4e2a\u5173\u7cfb\u3002\n\n\u5982\u672c\u9898\u5c31\u8981\u8bb0\u5f55\u4e0e\u81ea\u5df1\u76f8\u540c\u7684\u548c\u4e0e\u81ea\u5df1\u4e0d\u540c\u7684\uff0c\u5c31\u5c06 $f$ \u6570\u7ec4\u5f00\u5927\u5230\u539f\u6765\u7684\u4e24\u500d\uff0c\u7528 $f[i]$ \u8868\u793a\u4e0e\u81ea\u5df1\u5947\u5076\u6027\u76f8\u540c\u7684\u96c6\u5408\uff0c\u7528 $f[i+n]$ \u8868\u793a\u4e0e $i$ \u5947\u5076\u6027\u4e0d\u540c\u7684\u5143\u7d20\u96c6\u5408\u3002\n\n\u4ee3\u7801\u5b9e\u73b0\uff1a\n\n\u5408\u5e76\u76f8\u540c\u7684\u5143\u7d20\uff1a\n\n```cpp\nif(getfather(x)==getfather(y)){//x\u548cy\u4e0d\u540c\uff0c\u77db\u76fe\n\tcout<<i-1;\n\treturn 0;\n}\nelse{\n\thebing(x,y);\n\thebing(x+n,y+n);//\u4e0ex\u4e0d\u540c\u7684\u96c6\u5408\u4e5f\u548cy\u4e0d\u540c\n}\n```\n\u5408\u5e76\u4e0d\u540c\u7684\u5143\u7d20\uff1a\n```cpp\nif(getfather(x)==getfather(y)){//x\u548cy\u76f8\u540c\uff0c\u77db\u76fe\n\tcout<<i-1;\n\treturn 0;\n}\nelse{\n\thebing(x+n,y);\n\thebing(x,y+n);//\u4e0ex\u4e0d\u540c\u7684\u96c6\u5408\u548cy\u76f8\u540c\uff0c\u4e0ey\u4e0d\u540c\u7684\u96c6\u5408\u548cx\u76f8\u540c\n}\n```\n\n### \u5173\u4e8e\u79bb\u6563\u5316\n\n\u8fd9\u662f\u4e00\u4e2a\u6bd4\u8f83\u57fa\u7840\u7684\u7b97\u6cd5\u3002\n\n\u5f53\u6570\u636e\u8303\u56f4\u7279\u522b\u5927\u65f6\u4e14\u771f\u6b63\u7528\u5230\u7684\u6570\u6709\u6bd4\u8f83\u5c11\u7684\u65f6\u5019\uff0c\u5c31\u53ef\u4ee5\u7528\u5f53\u524d\u5143\u7d20\u6392\u5e8f\u540e\u5728\u6570\u7ec4\u4e2d\u7684\u7f16\u53f7\u6765\u4ee3\u66ff\u539f\u6765\u7684\u5143\u7d20\u3002\n\n\u9996\u5148\u9700\u8981\u8ba4\u8bc6\u4e24\u4e2a STL \u51fd\u6570\uff08c \u515a\u7684\u798f\u5229\uff09\u3002\n\nunique\uff1a\u5c06\u6570\u7ec4\u53bb\u91cd\uff0c\u5e76\u8fd4\u56de\u53bb\u91cd\u540e\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u7684\u5730\u5740\u3002\n\nlower_bound\uff1a\u5bf9\u4e00\u4e2a\u6709\u5e8f\u7684\u5e8f\u5217\uff0c\u4e8c\u5206\u67e5\u627e\u7b2c\u4e00\u4e2a\u5927\u4e8e\u7b49\u4e8e\u5f53\u524d\u503c\u7684\u5143\u7d20\u7684\u5730\u5740\u3002\n\n~~\u5f53\u7136\u8fd8\u8981\u7528 sort\u3002~~\n\n\u5177\u4f53\u4ee3\u7801\u5b9e\u73b0\uff1a\n```cpp\nfor(int i=1;i<=n;i++){\n   cin>>a[i];\n   b[i]=a[i];\n}\nsort(b+1,b+n+1);\nl=unique(b+1,b+n+1)-b-1;//l\u8868\u793a\u53bb\u91cd\u540e\u5269\u4e0b\u7684\u5143\u7d20\u4e2a\u6570\nfor(int i=1;i<=n;i++){\n   cout<<lower_bound(b+1,b+l+1,a[i])-b;//\u67e5\u627e\u5e8f\u53f7\u5e76\u8f93\u51fa\n}\n```\n\n## **\u4e0b\u9762\u7ed9\u51faAC\u4ee3\u7801\uff1a**\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nstruct hzy{\n\tint x,y,z;\n}a[200001];\nint f[200001],n,m,b[200001],l;\nint zuxian(int k){//\u5e76\u67e5\u96c6\u51fd\u6570\uff0c\u6ce8\u610f\u8def\u5f84\u538b\u7f29\n\treturn f[k]==k?k:f[k]=zuxian(f[k]);\n}\nvoid hebing(int x,int y){//\u5408\u5e76\u51fd\u6570\n\tint x1=zuxian(x);\n\tint x2=zuxian(y);\n\tif(x1!=x2){\n\t\tf[x1]=x2;\n\t}\n}\nint main() {\n\tcin>>n>>m;\n\tstring ch;\n\tfor(int i=1; i<=m; i++) {\n\t\tcin>>a[i].x>>a[i].y>>ch;\n\t\ta[i].x--;//\u65b9\u4fbf\u540e\u9762\u8fd0\u7b97\uff0c\u8fd9\u91cc\u76f4\u63a5\u51cf1\n\t\tif(ch[0]=='o') {//\u76f8\u540c\u548c\u4e0d\u540c\u8981\u641e\u6e05\u695a\n\t\t\ta[i].z=1;\n\t\t} else {\n\t\t\ta[i].z=0;\n\t\t}\n\t\tb[++l]=a[i].x;\n\t\tb[++l]=a[i].y;\n\t}\n\tsort(b+1,b+l+1);\n\tl=unique(b+1,b+l+1)-b-1;\n\tfor(int i=1;i<=l*2;i++){\n\t\tf[i]=i;\n\t}\n\tfor(int i=1; i<=m; i++) {\n\t\ta[i].x=lower_bound(b+1,b+l+1,a[i].x)-b;//\u79bb\u6563\u5316\n\t\ta[i].y=lower_bound(b+1,b+l+1,a[i].y)-b;\n\t\tif(a[i].z==0){//\u79cd\u7c7b\u5e76\u67e5\u96c6\uff0c\u5206\u76f8\u540c\u548c\u4e0d\u540c\u64cd\u4f5c\n\t\t\tif(zuxian(a[i].x)==zuxian(a[i].y+l)){//\u5982\u679c\u4e24\u4e2a\u6570\u5947\u5076\u6027\u4e0d\u540c\uff0c\u77db\u76fe\uff0c\u8f93\u51fa\n\t\t\t\tcout<<i-1;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\telse{//\u4e0d\u7136\u5c31\u5408\u5e76\u96c6\u5408\n\t\t\t\thebing(a[i].x,a[i].y);\n\t\t\t\thebing(a[i].x+l,a[i].y+l);\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tif(zuxian(a[i].x)==zuxian(a[i].y)){//\u540c\u7406\n\t\t\t\tcout<<i-1;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\telse{\n\t\t\t\thebing(a[i].x,a[i].y+l);\n\t\t\t\thebing(a[i].x+l,a[i].y);\n\t\t\t}\n\t\t}\n\t}\n\tcout<<m;\n\treturn 0;\n}//\u5b8c\u7ed3\u6492\u82b1\n```\n",
        "postTime": 1584192969,
        "uid": 98490,
        "name": "houzhiyuan",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5937 \u3010[CEOI1999]Parity Game\u3011"
    },
    {
        "content": "# P5937 [CEOI1999]Parity Game\n[\u6d1b\u8c37P5937 P5937 [CEOI1999]Parity Game](https://www.luogu.com.cn/problem/P5937)\n\n------------\n#### \u524d\u8a00\uff1a\n\n\u4e2a\u4eba\u611f\u89c9\u8fd9\u9053\u9898\u521d\u770b\u60f3\u4e0d\u5230\u5e76\u67e5\u96c6\u554a\uff01\uff08~~\u8bf4\u5b9e\u8bdd\u6211\u9898\u90fd\u6ca1\u8bfb\u61c2\uff0c\u7b2c\u4e8c\u904d\u624d\u8bfb\u61c2~~\uff09\n\n\u597d\u4e86\uff0c\u8f6c\u5165\u6b63\u9898\uff0c\u8fd9\u9053\u9898\u6211\u4eec\u53ef\u4ee5\u7528\u4e24\u79cd\u65b9\u6cd5A\u6389\uff1a**\u79cd\u7c7b\u5e76\u67e5\u96c6&\u5e26\u6743\u5e76\u67e5\u96c6**\n\n------------\n#### \u9898\u76ee\u7b80\u8ff0\uff1a\n\n\u7ed9\u5b9a01\u5e8f\u5217\u7684\u957f\u5ea6n\uff0c\u8be2\u95ee\u548c\u7b54\u6848\u7684\u4e2a\u6570m\n\n\u5bf9\u4e8e\u6bcf\u884c\u7684\u8be2\u95ee\u548c\u56de\u7b54\u5148\u7ed9\u51fa\u4e24\u4e2a\u6574\u6570\uff0c\u8868\u793a\u8be2\u95ee\u533a\u95f4\uff08\u95ed\u533a\u95f4\uff09\n\n\u518d\u7ed9\u51fa\u4e00\u4e2a\u5b57\u7b26\u4e32\u56de\u7b54\uff1a\u201codd\u201d\u8868\u793a\u533a\u95f4\u6709\u5947\u6570\u4e2a1\uff0c\u201ceven\u201d\u8868\u793a\u533a\u95f4\u6709\u5076\u6570\u4e2a1\n\n\u5982\u679c\u5b58\u5728\u4e00\u4e2a01\u5e8f\u5217\u6ee1\u8db3\u7b2c1\u4e2a\u5230\u7b2cx\u4e2a\u7684\u56de\u7b54\uff0c\u4e0d\u6ee1\u8db3\u7b2cx+1\u4e2a\u56de\u7b54\uff0c\u5219\u8f93\u51fax\uff08\u5982\u679cm\u4e2a\u56de\u7b54\u90fd\u6ee1\u8db3\uff0c\u90a3\u80af\u5b9a\u5c31\u8f93\u51fam\uff09\n\n#### \u6570\u636e\u8303\u56f4\uff1a\n\n\u5bf9\u4e8e100%\u7684\u6570\u636e\uff0c1\u2264N\u226410^9\uff0c1\u2264M\u22645\u00d710^3\n\n\u56e0\u4e3aN\u6709\u70b9\u5927\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u4f7f\u7528\u5230**\u79bb\u6563\u5316\uff01** \u6765\u5c06\u5927\u6570\u636e\u6620\u5c04\u5230\u5c0f\u8303\u56f4\u7684\u5c0f\u6570\u636e\n\n-----------\n#### \u5f15\u5165\uff1a\n\n\u5176\u5b9e\u672c\u9898\u548c[\u7a0b\u5e8f\u81ea\u52a8\u5206\u6790](https://www.luogu.com.cn/problem/P1955)\u8fd9\u9053\u9898\u5f88\u50cf\uff1a\u90fd\u662f\u7ed9\u5b9a\u82e5\u5e72\u4e2a\u53d8\u91cf\u548c\u5173\u7cfb\uff0c\u5224\u65ad\u8fd9\u4e9b\u5173\u7cfb\u7684**\u53ef\u6ee1\u8db3\u6027\u95ee\u9898**\n\n\u4e0d\u8fc7\u6211\u4eec\u8fd9\u9053\u9898\u7684\u4f20\u9012\u5173\u7cfb\u4e0d\u6b62\u4e00\u79cd\uff08\u6d89\u53ca\u5230\u4e86**\u5947\u5076\u6027**\uff09\uff1a\n\n1. \u82e5x1\u4e0ex2\u7684\u5947\u5076\u6027\u76f8\u540c\uff0cx2\u4e0ex3\u7684\u5947\u5076\u6027\u76f8\u540c\uff0c\u90a3\u4e48x1\u4e0ex3\u7684\u5947\u5076\u6027\u76f8\u540c\n\n2. \u82e5x1\u4e0ex2\u7684\u5947\u5076\u6027\u76f8\u540c\uff0cx2\u4e0ex3\u7684\u5947\u5076\u6027\u4e0d\u540c\uff0c\u90a3\u4e48x1\u4e0ex3\u7684\u5947\u5076\u6027\u4e0d\u540c\n\n3. \u82e5x1\u4e0ex2\u7684\u5947\u5076\u6027\u4e0d\u540c\uff0cx2\u4e0ex3\u7684\u5947\u5076\u6027\u4e0d\u540c\uff0c\u90a3\u4e48x1\u4e0ex3\u7684\u5947\u5076\u6027\u4e0d\u540c\n\n------------\n#### \u79cd\u7c7b\u5e76\u67e5\u96c6\uff1a\n\n\uff08\u56e0\u4e3a\u6211\u8ba4\u4e3a\u8fd9\u9053\u9898\u79cd\u7c7b\u5e76\u67e5\u96c6\u6bd4\u8f83\u597d\u60f3\u4e5f\u6bd4\u8f83\u597d\u7406\u89e3\uff0c\u6240\u4ee5\u5148\u8bb2\u79cd\u7c7b\u5e76\u67e5\u96c6\u7684\u505a\u6cd5ovo\uff0c\u4e0b\u9762\u901a\u8fc7\u95ee\u7b54\u7684\u5f62\u5f0f\u7ed9\u51fa\u601d\u8def\uff09\n\n\n- \u4e3a\u4ec0\u4e48\u60f3\u5230\u79cd\u7c7b\u5e76\u67e5\u96c6\uff1f\n\n1. \u672c\u9898\u9700\u8981\u8bb0\u5f55\u4e0e\u81ea\u5df1\u76f8\u540c\u7684\u548c\u4e0d\u540c\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5**\u5c06\u76f8\u540c\u7684\u7406\u89e3\u4e3a\u201c\u670b\u53cb\u201d\uff0c\u5c06\u4e0d\u540c\u7684\u7406\u89e3\u4e3a\u201c\u654c\u4eba\u201d**\n\n2. \u800c\u9898\u76ee\u4e2d\u7684**\u5947\u5076\u6027\u53c8\u5177\u6709\u4f20\u9012\u6027**\uff08\u89c1\u4e0a\u201c\u5f15\u5165\u90e8\u5206\u201d\uff09\uff0c\u6240\u4ee5\u6211\u4eec\u8fd8\u9700\u8981\u7ef4\u62a4\u8fd9\u79cd\u4f20\u9012\u6027\u2014\u2014\u4e8e\u662f\u6211\u4eec\u60f3\u5230\u4e86**\u79cd\u7c7b\u5e76\u67e5\u96c6**\n\n- **\u600e\u4e48\u7ef4\u62a4\u4f20\u9012\u6027&\u600e\u4e48\u5224\u65ad\u56de\u7b54\u662f\u5426\u6b63\u786e\uff1f**\n\n1. \u6bcf\u9047\u5230\u4e00\u4e2a\u56de\u7b54\uff0c\u6211\u4eec\u5148\u5224\u65ad\u5f53\u524d\u4e24\u4e2a\u533a\u95f4\u7aef\u70b9\u7684\u5947\u5076\u6027\uff1a\n\n\u2460\u5bf9\u4e8e\u201ceven\u201d\u56de\u7b54\uff0c\u82e5\u5de6\u7aef\u70b9\u5728\u53f3\u7aef\u70b9\u201c\u654c\u4eba\u201d\u7684\u96c6\u5408\u4e2d\u6216\u53f3\u7aef\u70b9\u5728\u5de6\u7aef\u70b9\u201c\u654c\u4eba\u201d\u7684\u96c6\u5408\u4e2d\uff0c\u5219\u56de\u7b54\u9519\u8bef\n\n\u2461\u5bf9\u4e8e\u201codd\u201d\u56de\u7b54\uff0c\u82e5\u5de6\u7aef\u70b9\u5728\u53f3\u7aef\u70b9\u201c\u670b\u53cb\u201d\u7684\u96c6\u5408\u4e2d\u6216\u53f3\u7aef\u70b9\u5728\u5de6\u7aef\u70b9\u201c\u670b\u53cb\u201d\u7684\u96c6\u5408\u4e2d\uff0c\u5219\u56de\u7b54\u9519\u8bef\n\n2. \u5982\u679c\u56de\u7b54\u662f\u6b63\u786e\u7684\uff0c\u90a3\u6211\u4eec\u5c31\u8fdb\u884c\u5408\u5e76\u64cd\u4f5c\uff1a\n\n\u2460\u5bf9\u4e8e\u201ceven\u201d\uff0c\u6211\u4eec\u5c06\u5de6\u7aef\u70b9\u548c\u53f3\u7aef\u70b9\u7684\u201c\u670b\u53cb\u201d\u3001\u201c\u654c\u4eba\u201d\u96c6\u5408\u5206\u522b\u5408\u5e76\n\n\u2461\u5bf9\u4e8e\u201codd\u201d\uff0c\u6211\u4eec\u5c06\u5de6\u7aef\u70b9\u7684\u201c\u670b\u53cb\u201d\u4e0e\u53f3\u7aef\u70b9\u7684\u201c\u654c\u4eba\u201d\u5408\u5e76\uff0c\u5c06\u5de6\u7aef\u70b9\u7684\u201c\u654c\u4eba\u201d\u4e0e\u53f3\u7aef\u70b9\u7684\u201c\u670b\u53cb\u201d\u5408\u5e76\n\n- \u600e\u4e48\u79bb\u6563\u5316\uff1f\n\n\u53ef\u89c1[\u6d45\u8c08\u79bb\u6563\u5316](https://www.cnblogs.com/Eleven-Qian-Shan/p/13157949.html)\u8fd9\u7bc7\u535a\u5ba2qvq\n\n- \u4e0b\u9762\u7ed9\u51fa\u79cd\u7c7b\u5e76\u67e5\u96c6\u505a\u6cd5\u7684\u5b8c\u6574\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint n,m,tot,res,b[100010],fa[100010];\n\nstruct node {\n\tint u,v;\n\tstring op;\n} a[100010];\n\ninline int find(int x) {\n\tif(fa[x]==x) return x;\n\treturn fa[x]=find(fa[x]);\n}\n\nint main() {\n\tscanf(\"%d%d\",&n,&m);\n\tfor(register int i=1;i<=m;i++) {\n\t\tscanf(\"%d%d\",&a[i].u,&a[i].v);\n\t\tcin>>a[i].op;\n\t\tb[++tot]=a[i].u;\n\t\tb[++tot]=a[i].v;\n\t}\n\tsort(b+1,b+1+tot);\n\tres=unique(b+1,b+1+tot)-(b+1);\n\tfor(register int i=1;i<=m;i++) {  //STL\u5b9e\u73b0\u79bb\u6563\u5316\u7684\u4e09\u90e8\u66f2 \n\t\ta[i].u=lower_bound(b+1,b+1+res,a[i].u-1)-b;\n\t\ta[i].v=lower_bound(b+1,b+1+res,a[i].v)-b;\n\t} \n\tfor(register int i=1;i<=2*res;i++) fa[i]=i;\n\tfor(register int i=1;i<=m;i++) {\n\t\tif(a[i].op==\"even\") {  //\u5982\u679c\u56de\u7b54\u662f\u5076\u6570\u4e2a \n\t\t\tif(find(a[i].u)==find(a[i].v+res)||find(a[i].u+res)==find(a[i].v)) {  //\u5224\u65ad\u5947\u5076\u6027 \n\t\t\t\tprintf(\"%d\",i-1);  //\u6ce8\u610f\u662fi-1\u800c\u4e0d\u662fi \n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tfa[find(a[i].u)]=find(a[i].v);\n\t\t\tfa[find(a[i].u+res)]=find(a[i].v+res);\n\t\t}\n\t\telse {\n\t\t\tif(find(a[i].u)==find(a[i].v)||find(a[i].u+res)==find(a[i].v+res)) {\n\t\t\t\tprintf(\"%d\",i-1);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tfa[find(a[i].u)]=find(a[i].v+res);\n\t\t\tfa[find(a[i].u+res)]=find(a[i].v);\n\t\t}\n\t}\n\tprintf(\"%d\",m);\n\treturn 0;\n} \n```\n\n------------\n#### \u5e26\u6743\u5e76\u67e5\u96c6\uff1a\n\n- \u600e\u4e48\u60f3\u5230\u5e26\u6743\u5e76\u67e5\u96c6\uff1f\n\n\u6211\u4eec\u4e0d\u59a8\u5c06\u533a\u95f4\u8f6c\u6362\u4e3a\u4e00\u68f5\u6811\uff0c\u7136\u540e\u75280/1\u6765\u8868\u793a**\u8fb9\u6743**\uff0c\u5982\u4e0b\u8349\u56fe\uff1a\n\n\n![\u5e26\u6743\u5e76\u67e5\u96c6\u8f6c\u6362\u56fe](https://cdn.luogu.com.cn/upload/image_hosting/smrthqif.png?x-oss-process=image/resize,m_lfit,h_170,w_225)\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u4efb\u610f\u533a\u95f4\u90fd\u53ef\u5728\u5728\u6811\u4e0a\u8868\u793a\u5e76\u6c42\u5f97\u533a\u95f4\u7684\u5947\u5076\u6027\uff080/1\u8fde\u6210\u5b57\u7b26\u4e32\u5c31\u597d\uff09\n\n\n- **\u600e\u4e48\u8f6c\u6362\u4e3a\u7ef4\u62a4\u5e26\u6743\u5e76\u67e5\u96c6\uff1f**\n\n1. \u6211\u4eec\u5c06\u8f93\u5165\u4e2d\u7684\u56de\u7b54\u8f6c\u6362\u4e3a0\u62161\u5b58\u50a8\uff1a\u201ceven\u201d\u6807\u8bb0\u4e3a0\uff0c\u201codd\u201d\u6807\u8bb0\u4e3a1\n\n2. \u6211\u4eec**\u7528dis[x]\u6765\u8bb0\u5f55x\u4e0efa[x]\u7684\u5947\u5076\u6027\u5173\u7cfb**\uff1a\u4e3a0\u5c31\u76f8\u540c\uff0c\u53cd\u4e4b\u4e0d\u540c\n\n3. \u5728\u8def\u5f84\u538b\u7f29\u65f6\uff0c\u5bf9x\u5230\u6839\u8282\u70b9\u8def\u5f84\u4e0a\u7684\u6240\u6709**\u8fb9\u6743\u505a\u5f02\u6216\uff08xor\uff09\u8fd0\u7b97**\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230x\u4e0eroot\u7684\u5947\u5076\u6027\u5173\u7cfb\uff08\u90fd\u662f0/1\uff0c\u6240\u4ee5\u60f3\u5230\u5f02\u6216\uff09\n\n\u5982\u4e0a\u56fe\uff1adis[x]=1 xor 0 xor 1=0\uff0cdis[y]=0 xor 1 xor 1=0\n\n4. \u5bf9\u4e8e\u6bcf\u4e2a\u95ee\u9898\uff0c\u5148\u68c0\u67e5\u5de6\u53f3\u7aef\u70b9\u662f\u5426\u5728\u540c\u4e00\u4e2a\u96c6\u5408\u5185\uff08\u5947\u5076\u6027\u662f\u5426\u5df2\u77e5\uff09\uff1a\n\n\u2460\u5728\u7684\u8bdd\u5c31\u8ba1\u7b97**dis[l] xor dis[r]**\uff08\u5373\u4e24\u7aef\u70b9\u7684\u5947\u5076\u6027\u5173\u7cfb\uff09\uff0c\u82e5\u4e0e\u56de\u7b54\u76f8\u77db\u76fe\uff08dis[l] xor dis[r]\u2260ans\uff09\uff0c\u90a3\u4e48\u56de\u7b54\u9519\u8bef\n\n\u2461\u4e0d\u5728\u7684\u8bdd\u5c31\u8fdb\u884c\u5408\u5e76\u64cd\u4f5c\u3002\u6b64\u65f6\u8bbe\u4e24\u4e2a\u96c6\u5408\u7684\u6811\u6839\u4e3axl\u3001xr\uff0c\u4ee4xl\u4f5c\u4e3axr\u7684\u5b69\u5b50\uff0c\u90a3\u5c31\u8981\u6c42\u51fa**dis[xl]=dis[l] xor dis[r] xor ans**\n\n- \u4e0b\u9762\u7ed9\u51fa\u5e26\u6743\u5e76\u67e5\u96c6\u505a\u6cd5\u7684\u5b8c\u6574\u4ee3\u7801\uff1a\n\n\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nstring s;\nint n,m,tot,res;\nint b[100010],fa[100010],dis[100010];\n\nstruct node {\n\tint u,v,op;\n} a[100010];\n\ninline int find(int x) {\n\tif(fa[x]==x) return x;\n\tint root=find(fa[x]);\n\tdis[x]^=dis[fa[x]];  //\u8def\u5f84\u538b\u7f29\u6c42\u51fax\u4e0e\u6811\u6839\u7684\u5947\u5076\u6027\u5173\u7cfb \n\treturn fa[x]=root;\n}\n\nint main() {\n\tscanf(\"%d%d\",&n,&m);\n\tfor(register int i=1;i<=m;i++) {\n\t\tscanf(\"%d%d\",&a[i].u,&a[i].v);\n\t\tcin>>s;\n\t\tif(s==\"even\") a[i].op=0;  //\u8f6c\u6362\u56de\u7b54 \n\t\telse a[i].op=1;\n\t\tb[++tot]=a[i].u;\n\t\tb[++tot]=a[i].v;\n\t}\n\tsort(b+1,b+1+tot);\n\tres=unique(b+1,b+1+tot)-(b+1);\n\tfor(register int i=1;i<=2*res;i++) fa[i]=i;\n\tfor(register int i=1;i<=m;i++) {\n\t\tint x=lower_bound(b+1,b+1+res,a[i].u-1)-b;  //\u76f4\u63a5\u5224\u65ad\u4e00\u4e2a\u53d6\u4e00\u4e2a\uff0c\u5c31\u4e0d\u7528\u5355\u72ec\u5904\u7406 \n\t\tint y=lower_bound(b+1,b+1+res,a[i].v)-b;\n\t\tint xx=find(x),yy=find(y);\n\t\tif(xx==yy) {  //\u5728\u4e00\u4e2a\u96c6\u5408\u4e2d \n\t\t\tif((dis[x]^dis[y])!=a[i].op) {  //\u5224\u65ad\u56de\u7b54\u662f\u5426\u6b63\u786e \n\t\t\t\tprintf(\"%d\",i-1);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tfa[xx]=yy;\n\t\t\tdis[xx]=dis[x]^dis[y]^a[i].op;  //\u6c42\u5de6\u7aef\u70b9\u6811\u6839\u6210\u4e3a\u53f3\u7aef\u70b9\u6811\u6839\u5b69\u5b50\u540e\u7684\u8fb9\u6743 \n\t\t}\n\t}\n\tprintf(\"%d\",m);\n\treturn 0;\n}\n```\n\n\n------------\n\u7136\u540e\uff0c\u611f\u8c22\u4e00\u4e0b[\u6211\u7684\u540c\u684c](https://www.cnblogs.com/Poetic-Rain/p/13159504.html) \u7ed9\u6211\u7684\u6307\u5bfc\uff08\u518d~~\u65e0\u803b~~\u5ba3\u4f20\u4e00\u4e0b[\u6211\u7684\u535a\u5ba2](https://www.cnblogs.com/Eleven-Qian-Shan/)\uff09\n\n\u6700\u540e\uff0c\u6709\u4ec0\u4e48\u95ee\u9898\u6b22\u8fce\u5404\u4f4ddalao\u4eec\u6307\u51fa\u6765qwq\n\n------------\n\n",
        "postTime": 1592632419,
        "uid": 145205,
        "name": "Eleven\u8c26",
        "ccfLevel": 0,
        "title": "P5937 [CEOI1999]Parity Game   \u9898\u89e3"
    },
    {
        "content": "## \u89e3\u6cd5\uff1a\u6269\u5c55\u57df+\u79bb\u6563\u5316\n\n\u9996\u5148\u89c2\u5bdf\u5230\uff1a\u8fd9\u4e2a01\u5e8f\u5217\u7684\u957f\u5ea6 n \u4e3a$10^9$\n\n\u4e00\u4e2a\u5e76\u67e5\u96c6\u7684 fa \u6570\u7ec4\u52a0\u4e0a\u6269\u5c55\u57df\u5e94\u8be5\u8981\u5f002\u500d\u7a7a\u95f4\uff0c$10^9$\u80af\u5b9a\u662f\u5f00\u4e0d\u4e0b\u7684\n\n\u800c m \u7684\u8303\u56f4\u4ec5\u4ec5\u4e3a$5*10^3$\n\n\u6240\u4ee5\u4f18\u5148\u8003\u8651\u5bf9\u8be2\u95ee\u7684 \u5f00\u59cb\u4f4d\u7f6e\u4e0e\u7ed3\u675f\u4f4d\u7f6e \u8fdb\u884c\u79bb\u6563\u5316\n\n### \u53ef\u4ee5\u5bf9\u9898\u76ee\u6761\u4ef6\u8fdb\u884c\u4e00\u5b9a\u7684\u8f6c\u5316\uff1a\n\n\u533a\u95f4$[i,j]$\u4e2d\u6709\u591a\u5c11\u4e2a1\n\n\u56e0\u4e3a\u8fd9\u662f\u4e00\u4e2a01\u5e8f\u5217\n\n\u6240\u4ee5\u4e0a\u9762\u7684\u95ee\u9898\u7b49\u4ef7\u4e8e\uff1a\n\n\u6c42\u51fa$sum_i-sum_{j-1}$\uff08sum\u8868\u793a\u524d\u7f00\u548c\uff09\n\n\u90a3\u4e48\u9898\u76ee\u4e2d\u7ed9\u51fa\u7684\u5947\u5076\u6027\u4e5f\u5c31\u7b49\u4ef7\u4e8e\uff1a\n\n\u5982\u679c \u533a\u95f4$[i,j]$\u4e3a $odd$\n\n\u53ef\u4ee5\u8f6c\u5316\u4e3a\n\n$sum_i$\u4e0e$sum_{j-1}$\u5947\u5076\u6027\u4e0d\u540c\n\n\u5982\u679c \u533a\u95f4$[i,j]$\u4e3a $even$ \n\n\u5219\n\n$sum_i$\u4e0e$sum_{j-1}$\u5947\u5076\u6027\u76f8\u540c\n\n### \u4e0a\u8ff0\u8f6c\u5316\u5c31\u5f88\u660e\u663e\u5f97\u6697\u793a\u4e86\u8fd9\u662f\u4e00\u4e2a\u5173\u4e8e\u6269\u5c55\u57df\u7684\u5e76\u67e5\u96c6\u7b97\u6cd5\n\n\u4ee3\u78011\u4e5f\u5f88\u5bb9\u6613\n\n#### code:\n\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,m;\nunordered_map<int,int> ha;\nint fa[40005];\nint tot;\nint op[10005];\ninline int get(int x){return fa[x]==x ? x : fa[x]=get(fa[x]);}\ninline void merge(int x,int y){fa[get(x)]=get(y);return;}\nint query1[10005];\nint query2[10005];\nint a[10005];\nint b[10005];\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=m;++i){\n\t\t\n\t\tscanf(\"%d%d\",&query1[i],&query2[i]);\n\t\tchar t[10];\n\t\tscanf(\"%s\",t);\n\t\tquery1[i]-=1;\n\t\tif(t[0]=='e'){op[i]=2;}\n\t\telse{op[i]=1;}\n\t\tif(ha.count(query1[i])==0)\tha[query1[i]]=++tot;\n\t\tif(ha.count(query2[i])==0)\tha[query2[i]]=++tot;\n\t\ta[i]=ha[query1[i]];\n\t\tb[i]=ha[query2[i]];\n\t}\t\t\n\tfor(int i=1;i<=2*tot;++i){\n\t\tfa[i]=i;\n\t}\n\tfor(int i=1;i<=m;++i){\n\t\tint x=a[i];\n\t\tint y=b[i];\n\t\tif(op[i]==2){\n\t\t\tif(get(x+tot)==get(y)||get(x)==get(y+tot)){\n\t\t\t\tprintf(\"%d\\n\",i-1);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\telse{merge(x,y);merge(x+tot,y+tot);}\n\t\t}\n\t\telse{\n\t\t\tif(get(x)==get(y)||get(x+tot)==get(y+tot)){\n\t\t\t\tprintf(\"%d\\n\",i-1);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tmerge(x+tot,y);\n\t\t\tmerge(y+tot,x);\n\t\t}\n\t}\n\tprintf(\"%d\\n\",m);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1595037116,
        "uid": 67621,
        "name": "NuoCarter",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5937 \u3010[CEOI1999]Parity Game\u3011"
    },
    {
        "content": "## \u524d\u8a00\r\n\r\n[\u9898\u76ee\u4f20\u9001\u95e8\uff01](https://www.luogu.com.cn/problem/P5937)\r\n\r\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\uff1f](https://www.cnblogs.com/liangbowen/p/17254846.html)\r\n\r\n\u63d0\u4f9b\u4e00\u79cd\u4e0d\u7528\u5e76\u67e5\u96c6\u7684\uff0c\u975e\u5e38\u597d\u60f3\u7684\u505a\u6cd5\u3002\r\n\r\n## \u601d\u8def\r\n\r\n\u9898\u76ee\u5c31\u662f\u8bf4\u7ed9\u5b9a\u4e00\u5806 $\\sum\\limits_{i=l}^r a_i \\equiv w\\pmod{2}$\uff0c\u5224\u65ad\u54ea\u4e2a\u7b49\u5f0f\u4e0d\u5408\u6cd5\u3002\r\n\r\n\u8fd9\u4e2a\u5f62\u5f0f\u660e\u663e\u53ef\u4ee5\u524d\u7f00\u548c\u4f18\u5316\uff1a$s_r - s_{l-1} \\equiv w \\pmod{2}$\uff0c\u5176\u4e2d $s_x = \\sum\\limits_{i=1}^x a_i$\u3002\r\n\r\n\u53d1\u73b0\u8fd9\u73a9\u610f\u7c7b\u4f3c\u5dee\u5206\u7ea6\u675f\u3002\u4e8e\u662f\u8003\u8651\u5efa\u56fe\u3002\r\n\r\n\u5bf9\u4e8e\u4e0a\u9762\u7684\u5f62\u5f0f\uff0c\u8fde\u8fb9 $(l-1) \\xrightarrow{ \\ w\\ } r$\u3002\r\n\r\n\u5f88\u81ea\u7136\u5730\u60f3\u5230\uff0c\u5982\u679c\u5f53\u524d\u67e5\u8be2\u7684\u4e24\u4e2a\u70b9 $(l - 1, r)$ \u5df2\u7ecf\u8fde\u901a\uff0c\u4ed6\u4eec\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97\u51fa\u7b54\u6848 $ans$\uff1a\u8d70\u6b63\u5411\u8fb9 $ans + w$\uff0c\u8d70\u53cd\u5411\u8fb9 $ans - w$\u3002\r\n\r\n\u8fdb\u4e00\u6b65\u5730\uff0c \u7531\u4e8e $ans$ \u4e0e $w$ \u90fd\u662f $0$ \u6216 $1$\uff0c\u4e0d\u7528\u8003\u8651\u52a0\u51cf\u3002**\u76f4\u63a5\u8fde\u53cc\u5411\u8fb9**\uff0c\u7b54\u6848\u5c31\u662f**\u4e24\u70b9\u7684\u8ddd\u79bb**\u3002\r\n\r\n\u6700\u540e\u5c31\u662f\u5982\u4f55\u8ba1\u7b97\u4e24\u70b9\u7684\u8ddd\u79bb\u4e86\uff1a\r\n\r\n1. \u53ef\u4ee5\u76f4\u63a5 01bfs\u3002\r\n2. \u8fd9\u4e2a\u56fe\u5728 $(u, v)$ \u5df2\u7ecf\u8fde\u901a\u65f6\u4e0d\u4f1a\u518d\u8fde\u8fb9\uff0c\u8bf4\u660e\u5b83\u662f\u4e00\u68f5\u6811\u3002\u76f4\u63a5 dfs \u5373\u53ef\u3002\r\n\r\n\u8bb0\u5f97\u79bb\u6563\u5316\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(m^2)$\uff0c\u7531\u4e8e\u4e0d\u53ef\u80fd\u5efa\u6ee1\u8fb9\uff0c\u6240\u4ee5\u8dd1\u5f97\u6bd4\u9884\u671f\u5feb\u5f88\u591a\u3002\r\n\r\n## \u53e6\u5916\u7684\r\n\r\n\u7531\u4e8e\u662f\u4e00\u4e2a\u6811\uff0c\u5e94\u8be5\u53ef\u4ee5\u500d\u589e lca \u6765\u5b9e\u73b0 $O(\\log m)$ \u52a0\u8fb9\u4e0e\u67e5\u8be2\u3002\r\n\r\n\u9762\u524d\u7684\u5927\u4f6c\u53ef\u4ee5\u5c1d\u8bd5\u5199\u4e00\u4e0b\u3002\r\n\r\n## \u4ee3\u7801\r\n\r\n```cpp\r\n#include <iostream>\r\n#include <cstdio>\r\n#include <unordered_map>\r\n#include <algorithm>\r\nusing namespace std;\r\nconst int N = 10005;\r\nstruct Edge {int now, nxt, w;} e[N << 1];\r\nint head[N], cur;\r\nvoid add(int u, int v, int w)\r\n{\r\n\te[++cur].now = v, e[cur].nxt = head[u], e[cur].w = w;\r\n\thead[u] = cur;\r\n}\r\nstruct Input {int l, r; string op;} input[N];\r\nint tt[N << 1], tot;\r\nint read()\r\n{\r\n\tint x;\r\n\tcin >> x;\r\n\ttt[++tot] = x;\r\n\treturn x;\r\n}\r\nint fin(int x) {return lower_bound(tt + 1, tt + tot + 1, x) - tt;}\r\n\r\nbool vis[N];\r\nint dis[N], emm[N];\r\nvoid dfs(int u, int fa, int tag)\r\n{\r\n\temm[u] = tag;\r\n\tfor (int i = head[u]; i; i = e[i].nxt)\r\n\t{\r\n\t\tint v = e[i].now;\r\n\t\tif (v == fa) continue;\r\n\t\tdis[v] = (dis[u] + e[i].w) % 2, dfs(v, u, tag);\r\n\t}\r\n}\r\nint main()\r\n{\r\n\tios::sync_with_stdio(false);\r\n\tint n, m;\r\n\tcin >> n >> m;\r\n\tfor (int i = 1; i <= m; i++) input[i].l = read(), input[i].r = read(), cin >> input[i].op;\r\n\tsort(tt + 1, tt + tot + 1), tot = unique(tt + 1, tt + tot + 1) - tt - 1;\r\n\tfor (int i = 1; i <= m; i++) input[i].l = fin(input[i].l - 1), input[i].r = fin(input[i].r);\r\n\t\r\n\tfor (int i = 1; i <= m; i++)\r\n\t{\r\n\t\tint u = input[i].l, v = input[i].r, w = (input[i].op == \"even\" ? 0 : 1);\r\n\t\tdis[u] = 0, dfs(u, 0, i);\r\n\t\tif (emm[v] == i) //\u8054\u901a \r\n\t\t{\r\n\t\t\tif (dis[v] != w) return cout << i - 1, 0;\r\n\t\t}\r\n\t\telse add(u, v, w), add(v, u, w), vis[u] = true, vis[v] = true;\r\n\t}\r\n\tcout << m;\r\n\treturn 0;\r\n}\r\n```\r\n\r\n\u5e0c\u671b\u80fd\u5e2e\u52a9\u5230\u5927\u5bb6\uff01",
        "postTime": 1679729744,
        "uid": 367488,
        "name": "liangbowen",
        "ccfLevel": 0,
        "title": "P5937 \u9898\u89e3"
    },
    {
        "content": "\u5c0f\u849f\u84bb\u8fd8\u662f\u592a\u83dc\u4e86\uff0c\u5e76\u4e0d\u4f1a\u6269\u5c55\u57df\u5e76\u67e5\u96c6/\u5e26\u6743\u5e76\u67e5\u96c6\uff0c\u6240\u4ee5\u5728\u8fd9\u91cc\u63d0\u4f9b\u4e00\u79cd\u601d\u8def\u7b80\u5355\u7c97\u66b4\u4f46\u662f\u6548\u7387\u66f4\u5dee\u7684\u505a\u6cd5\u3002\n\n\u5148\u8003\u8651\u4e8c\u5206\u7b54\u6848\uff0c\u8fd9\u6837\u95ee\u9898\u5c31\u8f6c\u6362\u6210\u5bf9\u4e00\u4e32\u7684\u7b54\u6848\u8fdb\u884c\u5224\u65ad\u6b63\u8bef\u4e86\u3002\n\n\u7136\u540e\u5c06\u8fd9\u4e9b\u7b54\u6848\u6309\u5de6\u7aef\u70b9\u4ece\u5c0f\u5230\u5927\u6392\u597d\u5e8f\uff0c\u5982\u679c\u5de6\u7aef\u70b9\u76f8\u540c\u5c31\u6309\u53f3\u7aef\u70b9\u4ece\u5c0f\u5230\u5927\u6392\u597d\u5e8f\uff0c\u4f9d\u6b21\u679a\u4e3e\u6bcf\u4e00\u4e2a\u7b54\u6848 $i$\uff0c\u5728\u8fc7\u7a0b\u4e2d\u7ef4\u62a4\u4e4b\u524d\u7684\u4e00\u4e2a\u5de6\u7aef\u70b9\u6700\u5927\u540c\u65f6\u53f3\u7aef\u70b9\u5c3d\u91cf\u5c0f\u7684\u7b54\u6848 $x$ \uff0c\u90a3\u4e48\u6709\uff1a\n\n- \u5982\u679c $l_x<l_i$ \uff0c\u5f80\u4e0b\u679a\u4e3e\uff0c\u56e0\u4e3a\u5728 $i$ \u4e4b\u524d\u6ca1\u6709\u7b54\u6848\u548c $i$ \u6709\u76f8\u540c\u7684\u5de6\u7aef\u70b9\uff0c\u90a3\u4e48\u65e0\u8bba\u5728 $l_i$ \u4e4b\u540e\u7684\u533a\u95f4\u7684\u5947\u5076\u6027\u5982\u4f55\uff0c\u5728 $l_i$ \u4e4b\u524d\u90fd\u6709\u4e00\u4e2a\u957f\u5ea6\u81f3\u5c11\u4e3a\u4e00\u7684\u533a\u95f4\u53ef\u4ee5\u968f\u610f\u53d8\u6362\u5947\u5076\u6027\uff0c\u90a3\u4e48\u4e4b\u524d\u7684\u7b54\u6848\u4e00\u5b9a\u4f1a\u6ee1\u8db3\u3002\n\n- \u5982\u679c $l_x=l_i$ \u4e14 $r_x<r_i$ \uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u884d\u751f\u51fa\u4e00\u4e2a\u65b0\u7684\u7b54\u6848\u9700\u8981\u5224\u5b9a\uff0c\u5de6\u7aef\u70b9\u4e3a $r_x+1$ \uff0c\u53f3\u7aef\u70b9\u4e3a $r_i$ \uff0c\u5947\u5076\u6027\u4e3a\u4e24\u8005\u76f8\u51cf\u3002\n\n- \u5982\u679c $l_x=l_i$ \u4e14 $r_x=r_i$ \uff0c\u76f4\u63a5\u5224\u65ad\u5947\u5076\u6027\u662f\u5426\u76f8\u540c\uff0c\u76f8\u540c\u5c31\u7ee7\u7eed\u3002\n\n\u5bf9\u4e8e\u8fd9\u4e9b\u64cd\u4f5c\uff0c\u6211\u662f\u76f4\u63a5\u7528\u4f18\u5148\u961f\u5217\u6765\u7ef4\u62a4\uff0c\u4f46\u662f\u53ef\u4ee5\u88ab\u5361\u5230 $\\mathcal{O(n^2\\log^2 n)}$ \uff0c\u5b9e\u9645\u4e0a\u8dd1\u4e0d\u6ee1\u3002\n\n\u6709\u4e00\u4e9b\u4f18\u5316\uff0c\u5bf9\u4e8e\u5de6\u7aef\u70b9\u76f8\u540c\u7684\u7b54\u6848\uff0c\u76f4\u63a5\u6309\u4e0a\u9762\u64cd\u4f5c\u4f1a\u505a\u5e73\u65b9\u7684\u64cd\u4f5c\u6b21\u6570\uff0c\u4f46\u662f\u53ef\u4ee5\u53d1\u73b0\u6bcf\u6b21\u64cd\u4f5c\u5b8c\u5176\u5b9e\u65b0\u884d\u751f\u51fa\u7684\u7b54\u6848\u7684\u5de6\u7aef\u70b9\u8fd8\u662f\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u6309\u53f3\u7aef\u70b9\u6392\u5e8f\u540e\u76f8\u90bb\u4e4b\u95f4\u505a\u5dee\u6765\u884d\u751f\u65b0\u7684\u7b54\u6848\uff0c\u90a3\u4e48\u64cd\u4f5c\u5c31\u662f\u7ebf\u6027\u7684\u4e86\uff0c\u5982\u679c\u4e00\u5f00\u59cb\u7528\u79bb\u6563\u5316\u7aef\u70b9\u8fd8\u53ef\u4ee5\u7701\u53bb\u4e00\u4e2a $\\log$ \u3002\n\n\u4e0b\u9762\u662f $\\mathcal{O(n^2\\log^2 n)}$ \u7684\u5783\u573e\u505a\u6cd5\uff0c\u8981\u5f00 ```O2``` \u624d\u80fd\u8fc7\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\nconst int M=1e4+5;\n\nint read(){\n\tint x=0,y=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9') y=(ch=='-')?-1:1,ch=getchar();\n\twhile(ch>='0'&&ch<='9') x=x*10+ch-'0',ch=getchar();\n\treturn x*y;\n}\n\nstruct Reply{\n\tint l,r,jio;\n\tbool friend operator <(Reply x,Reply y){\n\t\treturn x.l!=y.l?x.l>y.l:x.r>y.r;\n\t}\n}re[M];\npriority_queue<Reply> Q;\n\nbool check(int x){\n\twhile(!Q.empty()) Q.pop();\n\tfor(int i=1;i<=x;i++) Q.push(re[i]);\n\tint nL=0,nR=0,njio=0;\n\twhile(!Q.empty()){\n\t\tReply u=Q.top();Q.pop();\n\t\tif(nL<u.l) nL=u.l,nR=u.r,njio=u.jio;\n\t\telse if(nR<u.r) Q.push((Reply){nR+1,u.r,(njio-u.jio+2)%2});\n\t\telse if(nR==u.r&&njio!=u.jio) return 0;\n\t}\n\treturn 1;\n}\n\nvoid solve(){\n\tint n=read(),m=read();\n\tfor(int i=1;i<=m;i++){\n\t\tint l=read(),r=read();\n\t\tchar JoJo[15];scanf(\"%s\",JoJo);\n\t\tre[i]=(Reply){l,r,(JoJo[0]=='o')};\n\t}\n\tint l=1,r=m,Ans=m;\n\twhile(l<=r){\n\t\tint mid=(l+r)>>1;\n\t\tif(check(mid)) l=mid+1,Ans=mid;\n\t\telse r=mid-1;\n\t}\n\tprintf(\"%d\\n\",Ans);\n}\n\nsigned main(){\n\tsolve();\n}\n```\n",
        "postTime": 1606138038,
        "uid": 116015,
        "name": "bellmanford",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5937 \u3010[CEOI1999]Parity Game\u3011"
    },
    {
        "content": "\u6b64\u9898\u601d\u7ef4\u96be\u5ea6\u8fd8\u662f\u4e0d\u5c0f\u7684\uff0c\u4f46\u5982\u679c\u4f60\u505a\u8fc7\u7a0b\u5e8f\u81ea\u52a8\u5206\u6790\u90a3\u9053\u9898\u4f60\u5c31\u4f1a\u53d1\u73b0\u8fd9\u4fe9\u5f88\u50cf\u3002\n\n\u9996\u5148\uff0c\u600e\u4e48\u60f3\u5230\u7528\u5e76\u67e5\u96c6\uff1f\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u9053\u9898\u662f\u6709\u7ea6\u675f\u6761\u4ef6\u548c\u4f20\u9012\u5173\u7cfb\u7684\uff0c\u548c\u7a0b\u5e8f\n\n\u81ea\u52a8\u5206\u6790\u7684\u90a3\u9053\u9898\u7684\u6761\u4ef6\u4e5f\u5f88\u50cf\uff0c\u6240\u4ee5\u5f88\u81ea\u7136\u60f3\u5230\u4f7f\u7528\u5e76\u67e5\u96c6\u3002\n\n\u663e\u7136\uff0c\u8fd9\u4e2a\u9898\u8981\u4f7f\u7528**\u6269\u5c55\u57df\u7684\u5e76\u67e5\u96c6**\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u9898\u7684\u4f20\u9012\u5173\u7cfb\u4e0d\u50cf\u7a0b\u5e8f\u81ea\u52a8\u5206\u6790\n\n\u90a3\u9053\u9898\u4e00\u6837\u7b80\u5355\uff0c\u4e0d\u4e86\u89e3\u4ec0\u4e48\u662f\u6269\u5c55\u57df\u7684\u5e76\u67e5\u96c6\u7684\u540c\u5b66\u5148\u79fb\u6b65\u98df\u7269\u94fe\u90a3\u9053\u9898\u3002\n\n\u4e0b\u9762\u5206\u6790\u4e00\u4e0b\u8fd9\u9053\u9898\u7684\u4f20\u9012\u548c\u7ea6\u675f\u6761\u4ef6\u3002\uff08\u6211\u4eec\u7528 $sum$ \u6570\u7ec4\u8868\u793a\u5e8f\u5217\u7684\u524d\u7f00\u548c\uff09\n\n$1.$ \u5982\u679c $[l,r]$ \u6709\u5076\u6570\u4e2a $1$ \uff0c\u90a3\u4e48 $sum[l-1]$ \u548c $sum[r]$ \u5947\u5076\u6027\u76f8\u540c\n\n$2.$ \u5982\u679c $[l,r]$ \u6709\u5947\u6570\u4e2a $1$ \uff0c\u90a3\u4e48 $sum[l-1]$ \u548c $sum[r]$ \u5947\u5076\u6027\u76f8\u53cd\n\n\u8fd9\u4e2a\u975e\u5e38\u597d\u8bc1\u660e\uff0c\u6211\u4e0d\u518d\u8d58\u8ff0\u3002\n\n\u6211\u4eec\u8fd9\u91cc\u7684 $sum$ \u6570\u7ec4\u5176\u5b9e\u5e76\u6ca1\u6709\u5728\u7a0b\u5e8f\u4e2d\u4f53\u73b0\u51fa\u6765\u3002\u8fd9\u91cc\u4e00\u5b9a\u8981\u597d\u597d\u7406\u89e3\u4e00\u4e0b\u3002\n\n\u6211\u4eec\u7528\u4e24\u4e2a\u7aef\u70b9+\u5e76\u67e5\u96c6\u7ef4\u62a4\u8fd9\u79cd\u5173\u7cfb\u800c\u4e0d\u662f\u771f\u7684\u628a\u4ed6\u8868\u793a\u51fa\u6765\uff0c\u56e0\u4e3a\u6211\u4eec\u4e0d\u9700\u8981\u8c03\u7528\n\n\u8fd9\u4e2a $sum$ \u6570\u7ec4\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7528\u8fd9\u4e2a\u7ea6\u675f\u6761\u4ef6\u6765\u5224\u65ad\u662f\u5426\u5408\u6cd5\u3002\n\n\u6269\u5c55\u57df\u5e76\u67e5\u96c6\u5927\u4f53\u601d\u8def\u5c31\u662f\u628a\u5e76\u67e5\u96c6\u7a7a\u95f4\u5f00\u5927n\u500d\uff0c\u8868\u793an\u4e2a\u5173\u7cfb\uff0c\u8fd9\u91cc\u53ea\u9700\u8981\u8868\u793a\u6b63\n\n\u9762\u548c\u53cd\u9762\u7684\u5173\u7cfb\u6765\u5224\u65ad\u662f\u5426\u5408\u6cd5\uff0c $a[i]$ \u8868\u793a\u6b63\u9762\uff0c $a[i+n]$ \u8868\u793a\u53cd\u9762\uff0c\u6240\u4ee5\n\n\u53ea\u7528\u5f00\u5927\u4e24\u500d\u3002\u98df\u7269\u94fe\u90a3\u9053\u9898\u9700\u8981\u8868\u793a\u5929\u654c\uff0c\u81ea\u8eab\uff0c\u730e\u7269\u4e09\u4e2a\u5173\u7cfb\uff0c\u6240\u4ee5\u8981\u5f00\u4e09\u500d\u3002\n\n\u5982\u679c $[l,r]$ \u4e2d\u6709\u5947\u6570\u4e2a $1$ \n\n\u90a3\u4e48\u5408\u5e76 $(a[i+n].x,a[i].y)$ \uff0c\u5408\u5e76 $(a[i].x,a[i+n].y)$\n\n\u5982\u679c $[l,r]$ \u4e2d\u6709\u5076\u6570\u4e2a $1$ \n\n\u90a3\u4e48\u5408\u5e76 $(a[i].x,a[i].y)$ \uff0c\u5408\u5e76 $(a[i+n].x,a[i+n].y)$\n\n\u6b64\u9898N\u5f88\u5927\uff0cM\u6bd4N\u5c0f\u5f88\u591a\uff0c\u6240\u4ee5\u6570\u7ec4\u7a7a\u95f4\u4e0d\u53ef\u80fd\u5168\u90e8\u7528\u5230\uff0c\u6211\u4eec\u8fd8\u8981\u79bb\u6563\u5316\u4e00\u4e0b\u3002\n\n\u79bb\u6563\u5316\u7684\u64cd\u4f5c\u8fd9\u91cc\u4e5f\u4e0d\u8d58\u8ff0\u4e86\u3002\n\n\u81ea\u8ba4\u4e3a\u7801\u98ce\u8fd8\u53ef\u4ee5QwQ\n```\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nint fa[100010],b[100010];\nstruct node{\n\tint x,y;\n\tstring op;\n}a[100010];\nint find(int x)\n{\n\tif(x==fa[x]) return x;\n\treturn fa[x]=find(fa[x]);\n}\nvoid unionn(int x,int y)\n{\n\tfa[find(x)]=find(y);\n}\nint tot,n,m;\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tscanf(\"%d%d\",&a[i].x,&a[i].y);\n\t\tcin>>a[i].op;\n\t\ta[i].x--;\n\t\tb[++tot]=a[i].x;\n\t\tb[++tot]=a[i].y;\n\t}\n\tsort(b+1,b+1+tot);\n\tint cnt=unique(b+1,b+1+tot)-b-1;\n\tfor(int i=1;i<=cnt*2;i++)\n\t{\n\t\tfa[i]=i;\n\t}\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\ta[i].x=lower_bound(b+1,b+1+cnt,a[i].x)-b;\n\t\ta[i].y=lower_bound(b+1,b+1+cnt,a[i].y)-b;\n\t}\n\tfor(int i=1;i<=m;i++)//\u79bb\u6563\u5316\u5b8c\u4e86\uff0c\u5f00\u59cb\u6b63\u5e38\u64cd\u4f5c\n\t{\n\t\tif(a[i].op==\"even\")\n\t\t{\n\t\t\tif(find(a[i].x)==find(find(a[i].y+cnt)))\n\t\t\t{\n\t\t\t\tprintf(\"%d\",i-1);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tunionn(a[i].x,a[i].y);\n\t\t\t\tunionn(a[i].x+cnt,a[i].y+cnt);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(find(a[i].x)==find(a[i].y))\n\t\t\t{\n\t\t\t\tprintf(\"%d\",i-1);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tunionn(a[i].x,a[i].y+cnt);\n\t\t\t\tunionn(a[i].x+cnt,a[i].y);\n\t\t\t}\n\t\t}\n\t}\n\tcout<<m;\n\treturn 0;\n}",
        "postTime": 1597128892,
        "uid": 250699,
        "name": "Herkaii",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P5937 \u3010[CEOI1999]Parity Game\u3011"
    },
    {
        "content": "- \u9898\u76ee\u94fe\u63a5\uff1a[P5937 [CEOI1999]Parity Game](https://www.luogu.com.cn/problem/P5937)\n\n~~\u521a\u521a\u5b66\u5b8c\u79bb\u6563\u5316\u8fc7\u6765\u5207\u9898~~\n\n\u8fd9\u9898\u6211\u89c9\u5f97\u51fa\u7684\u975e\u5e38\u597d\uff0c\u8003\u5bdf\u4e86\u79bb\u6563\u5316\uff08\u867d\u7136`map`\u4e5f\u53ef\u4ee5\u6c34\u8fc7\uff09\uff0c\u6269\u5c55\u57df\u5e76\u67e5\u96c6\u7684\u8fd0\u7528\u3002\n\n\u8fd9\u9898\u51e0\u4e4e\u5f88\u5feb\u5c31\u53ef\u4ee5\u770b\u51fa\u6765\u8981\u7528\u5230\u5e76\u67e5\u96c6\uff0c\u56e0\u4e3a\u5177\u6709\u5e76\u67e5\u96c6\u7684\u4f20\u9012\u6027\u3002\n\n\u5e76\u67e5\u96c6\u6a21\u677f\uff1a\n\n\u67e5\u627e\u7956\u5148\uff1a\n\n```cpp\nconst int N=200010;\nint p[N];\nint find(int x){return p[x]==x?p[x]:find(p[x]);}\n```\n\n\u5408\u5e76\uff1a\n\n```cpp\nconst int N=200010;\nint p[N];\nvoid merge(int a,int b)\n{\n    a=find(a),b=find(b);\n    if(a!=b) p[a]=b;\n}\n```\n\u6269\u5c55\u57df\u5e76\u67e5\u96c6\u5b9e\u9645\u4e0a\u5c31\u662f\u5c06\u4e00\u4e2a\u70b9\u62c6\u6210\u4e24\u4e2a\u70b9\uff0c\u5206\u522b\u662f $p_i$ \u548c $p_{2\\times i}$ \u50a8\u5b58\u4e0d\u540c\u7684\u4fe1\u606f\u3002\n\n\u90a3\u79bb\u6563\u5316\u662f\u4ec0\u4e48\u5462\uff1f\n\n\u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u628a\u4e00\u4e2a\u5f88\u5927\u7684\u6570\u6620\u5c04\u5230\u4e00\u4e2a\u5f88\u5c0f\u7684\u6570\u3002\n\n\u6a21\u677f\u9898\uff1a[\u533a\u95f4\u548c](https://www.luogu.com.cn/problem/U116072)\n\n\u81f3\u4e8e\u6620\u5c04\u7684\u51fd\u6570\uff0c\u5f53\u7136\u53ef\u4ee5\u7528STL\u7684\u4e8c\u5206\u51fd\u6570`lower_bound`\uff0c\u6211\u518d\u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e2a\u6a21\u677f\uff1a\n\n```cpp\nint check(int x,int alls[],int lenth)\n{\n    int l=1,r=lenth,mid;\n    while(l<r)\n    {\n        mid=(l+r+1)>>1;\n        if(alls[mid]<=x) l=mid;\n        else r=mid-1;\n    }\n    return l;\n}\n```\n\n\uff08\u5982\u679c\u4e0a\u9762\u7684\u4e0d\u4f1a\uff0c\u8bf7\u767e\u5ea6\u641c\u7d22\u6587\u7ae0\u89e3\u91ca\uff0c\u5efa\u8baeOI-Wiki\uff09\n\n\u4e86\u89e3\u4e0a\u9762\u90a3\u4e9b\uff0c\u90a3\u4e48\u8fd9\u9898\u5c31\u5f88\u7b80\u5355\u4e86\u3002\n\n\u5f88\u5bb9\u6613\u5f97\u5230\u4ee5\u4e0b\u7ed3\u8bba\uff1a\n\n- \u5982\u679c\u533a\u95f4 $l\\rightarrow r$ \u4e3a\u5947\u6570 \uff0c\u533a\u95f4 $l\\rightarrow r$ \u4e0a\u7684\u548c\u4e3a\u5947\u6570\u3002\n\n- \u5982\u679c\u533a\u95f4 $l\\rightarrow r$ \u4e3a\u5076\u6570\uff0c\u533a\u95f4 $l\\rightarrow r$ \u4e0a\u7684\u548c\u4e3a\u5076\u6570\u3002\n\n\u5bf9\u4e8e\u4e0a\u9762\u4e24\u4e2a\u60c5\u51b5\uff0c\u5206\u522b\u8fdb\u884c\u5408\u5e76\u5373\u53ef\u3002\n\n\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=200010;\nstruct node\n{\n    int x,y,opt;\n}a[N];\nint n,m;\nint p[N],h[N],cnt;\nchar op[10];\nint find(int x){return p[x]==x?p[x]:find(p[x]);}\nvoid merge(int a,int b)\n{\n    a=find(a),b=find(b);\n    if(a!=b) p[a]=b;\n}\nint check(int x,int alls[],int lenth)\n{\n    int l=1,r=lenth,mid;\n    while(l<r)\n    {\n        mid=(l+r+1)>>1;\n        if(alls[mid]<=x) l=mid;\n        else r=mid-1;\n    }\n    return l;\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&m);\n    int l,r;\n    for(int i=1;i<=m;i++)\n    {\n        scanf(\"%d%d%s\",&l,&r,op);\n        a[i].x=l-1,a[i].y=r;\n        if(*op=='o') a[i].opt=1;\n        else a[i].opt=0;\n        ++cnt,h[cnt]=a[i].x,++cnt,h[cnt]=a[i].y;\n    }\n    sort(h+1,h+cnt+1);\n    cnt=unique(h+1,h+cnt+1)-h-1;\n    for(int i=1;i<=cnt*2;i++) p[i]=i;\n    for(int i=1;i<=m;i++)\n    {\n        a[i].x=check(a[i].x,h,cnt);\n        a[i].y=check(a[i].y,h,cnt);\n        if((!a[i].opt && find(a[i].x)==find(a[i].y+cnt)) || (a[i].opt && find(a[i].x)==find(a[i].y)))\n        {\n            printf(\"%d\",i-1);\n            return 0;\n        }\n        if(!a[i].opt)\n            merge(a[i].x,a[i].y),merge(a[i].x+cnt,a[i].y+cnt);\n        else\n            merge(a[i].x,a[i].y+cnt),merge(a[i].x+cnt,a[i].y);\n    }\n    printf(\"%d\",m);\n    return 0;\n}\n\n\n```\n\n\u5982\u679c\u6709\u95ee\u9898\u6216\u8005\u6587\u7ae0\u9519\u8bef\u6b22\u8fce\u63d0\u51fa\u3002\n\n\n",
        "postTime": 1588851879,
        "uid": 270120,
        "name": "xhQYm",
        "ccfLevel": 0,
        "title": "Solution P5937"
    },
    {
        "content": "\u8fd9\u9053\u9898\u76f4\u63a5\u7528\u4e00\u4e2a\u5e76\u67e5\u96c6\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u6bcf\u6b21\u67e5\u8be2\u4e00\u4e2a\u533a\u95f4 $[l,r]$\uff0c\u53ef\u4ee5\u628a\u5b83\u8f6c\u6362\u6210 $[1,r]-[1,l-1]$\uff0c\u6240\u4ee5\u628a $r$ \u548c $l-1$ \u5408\u5e76\u5c31\u53ef\u4ee5\u4e86\u3002\u8fd9\u91cc\u56e0\u4e3a\u6570\u636e\u8303\u56f4\u592a\u5927\uff0c\u6240\u4ee5\u6211\u7528 $map$ \u5b9e\u73b0\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<iostream>\n#include<cstring>\n#include<map>\n#include<cstdio>\nusing namespace std;\nmap<int,int>fa;\nmap<int,int>cnt;\nint findfather(int v)\n{\n\tif(fa[v]==0||fa[v]==v)return fa[v]=v;\n\tint pp=findfather(fa[v]);\n\tcnt[v]=cnt[v]+cnt[fa[v]];\n\tcnt[v]&=1;\n\tfa[v]=pp;\n\treturn pp;\n}\nint main()\n{\n\tint x,n;\n\tcin>>x>>n;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint p,q;\n\t\tchar r[15]={0};\n\t\tscanf(\"%d%d%s\",&p,&q,r);\n\t\tq++;\n\t\tint flg=1;\n\t\tif(r[0]=='e')flg=0;\n\t\tint p1=findfather(p),q1=findfather(q);\n\t\tif(p1==q1)\n\t\t{\n\t\t\tif(cnt[p]!=((cnt[q]+flg)&1))printf(\"%d\\n\",i-1);\n\t\t\telse continue;\n\t\t\treturn 0;\n\t\t}else\n\t\t{\n\t\t\tcnt[q1]=(cnt[q]!=flg);\n\t\t\tfa[q1]=p;\n\t\t}\n\t}\n\tprintf(\"%d\\n\",n);\n\treturn 0;\n}\n```\n",
        "postTime": 1581500015,
        "uid": 107484,
        "name": "wmy_goes_to_thu",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P5937 \u3010[CEOI1999]Parity Game\u3011"
    },
    {
        "content": "###### update: 6.24 \u6709\u4e00\u4e2a\u5730\u65b9\u5199\u53cd\u4e86...\u5df2\u7ecf\u4fee\u6b63\uff0c\u8bf7\u7ba1\u7406\u5458\u901a\u8fc7\uff0c\u8c22\u8c22\n## \u4e0d\u4e00\u6837\u7684\u505a\u6cd5\n\u5176\u5b9e\u8fd9\u9053\u9898\u53ef\u4ee5\u4e0d\u9700\u8981\u7ed3\u6784\u4f53\u7684\uff0c\u6211\u4eec\u8fd9\u6837\u60f3\uff1a\n\n- \u5b9a\u4e49\u6570\u7ec4 $sum$\uff0c$sum_i$ \u4ee3\u8868\u7b2c $1\\!\\to\\!i$ \u4e2a\u6570\u5f53\u4e2d\u4e00\u5171\u6709\u591a\u5c11\u4e2a1\u3002\n- \u5982\u679c $[i,j]$ \u662f\u5076\u6570\uff0c\u90a3\u4e48\u628a $i-1$ \u548c $j$\uff08\u4ee3\u8868 $sum_{i-1},sum_j$ \u540c\u4e3a\u5076\u6570\uff09\uff0c$i-1+n$ \u548c $j+n$\uff08\u4ee3\u8868 $sum_{i-1},sum_j$ \u540c\u4e3a\u5947\u6570\uff09\uff0c\u653e\u5230\u4e00\u4e2a\u96c6\u5408\u91cc\u3002\n- \u5982\u679c $[i,j]$ \u662f\u5947\u6570\uff0c\u90a3\u4e48\u628a $i-1$ \u548c $j+n$\uff08\u4ee3\u8868 $sum_{i-1}$ \u4e3a\u5076\u6570\uff0c$sum_j$ \u662f\u5947\u6570\uff09\uff0c$i-1+n$ \u548c $j$\uff08\u4ee3\u8868 $sum_{i-1}$ \u4e3a\u5947\u6570\uff0c$sum_j$ \u4e3a\u5076\u6570\uff09\uff0c\u653e\u5230\u4e00\u4e2a\u96c6\u5408\u91cc\u3002\n- \u653e\u5230\u4e00\u4e2a\u96c6\u5408\u91cc\u7684\u8fc7\u7a0b\u53ef\u4ee5\u7528\u5e76\u67e5\u96c6\u7684 $Union()$ \u5b8c\u6210\uff0c\u8bb0\u5f97\u521d\u59cb\u503c $father_i=i$\u3002\n- \u4ee5\u4e0a\u5728\u540c\u4e00\u4e2a\u5e76\u67e5\u96c6\u4e2d\u5b8c\u6210\u4e0d\u4f1a\u51fa\u73b0\u77db\u76fe\uff0c\u6211\u4eec\u5728\u5224\u65ad Bob \u7684\u56de\u7b54\u662f\u5426\u6210\u7acb\u7684\u65f6\u5019\uff1a\n1. \u5982\u679c\u662f `i j even`\uff0c\u6211\u4eec\u770b\u4e00\u4e0b\u524d\u9762\u662f\u4e0d\u662f\u51fa\u73b0\u8fc7\u4ed6\u4eec\u5176\u5b9e\u662f `odd` \u7684\u60c5\u51b5\uff1a\u5224\u65ad $i-1,j+n$\u3001$i-1+n,j$ \u662f\u5426\u5728\u4e00\u4e2a\u96c6\u5408\u5185\uff0c\u4e24\u70b9\u53ea\u8981\u6709\u4e00\u70b9\u6ee1\u8db3\u53ef\u4ee5\u4ee3\u8868\u53e6\u4e00\u70b9\u6ee1\u8db3\uff0c\u53ef\u4ee5\u7528\u201c\u6216\u201d\u8fde\u63a5\u3002\n2. \u5982\u679c\u662f `i j odd`\uff0c\u6211\u4eec\u770b\u4e00\u4e0b\u524d\u9762\u662f\u4e0d\u662f\u51fa\u73b0\u8fc7\u4ed6\u4eec\u5176\u5b9e\u662f `even` \u7684\u60c5\u51b5\uff1a\u5224\u65ad $i-1,j$\u3001$i-1+n,j+n$ \u662f\u5426\u5728\u4e00\u4e2a\u96c6\u5408\u5185\uff0c\u4e24\u70b9\u53ea\u8981\u6709\u4e00\u70b9\u6ee1\u8db3\u53ef\u4ee5\u4ee3\u8868\u53e6\u4e00\u70b9\u6ee1\u8db3\uff0c\u53ef\u4ee5\u7528\u201c\u6216\u201d\u8fde\u63a5\u3002\n- \u6ce8\u610f\u4e8b\u9879\uff1a\n1. \u5f00 long long\uff0c\u5f53 $j$ \u53d6\u6700\u5927\u503c $n$ \u65f6\u63a5\u8fd1 int \u8fb9\u754c\u3002\n2. \u79bb\u6563\u5316\uff0c\u57fa\u7840\u7684\u6b65\u9aa4\uff1a\u9996\u5148\u628a\u6240\u6709\u9700\u8981\u79bb\u6563\u5316\u7684\u6570\u636e\u585e\u5728\u4e00\u4e2a vector \u91cc\uff0c\u7136\u540e\u5bf9\u8fd9\u4e2a vector \u6392\u5e8f\uff08\u597d\u50cf\u4e5f\u53ef\u4ee5\u4e0d\u7528\u6392\u5e8f\uff1f\uff09\uff1b\u7528\u4e00\u4e2a map $D$ \u6765\u628a\u539f\u59cb\u7684\u6570\u636e $x$ \u66ff\u6362\u6210\u5b83\u5728 vector \u4e2d\u7684\u4e0b\u6807\uff0c\u51fa\u73b0\u8fc7\u591a\u6b21\u7684\u6570\u7edf\u4e00\u7528\u4e00\u4e2a\u4e0b\u6807\u4ee3\u66ff\u3002\u6700\u540e\u6240\u6709\u9700\u8981\u7528\u5230\u8fd9\u4e9b\u6570\u636e\u7684\u5730\u65b9\u6211\u4eec\u90fd\u7528\u4ed6\u7684\u4e0b\u6807\u6765\u4ee3\u66ff\u5b83\u7684\u5b58\u5728\uff0c\u5e73\u5747\u610f\u4e49\u4e0b\u6bcf\u4e2a\u6570\u90fd\u4f1a\u53d8\u5c0f\uff1b\u8c03\u7528\u4e00\u6b21 $D_x$ \u590d\u6742\u5ea6\u662f $\\log$ \u7684\uff0c\u7136\u800c $m\\log n$ \u5e76\u4e0d\u5927\uff0c\u53ef\u4ee5\u63a5\u53d7\u3002\n3. \u5bf9\u4e8e $[i,j]$ \u6211\u4eec\u521a\u624d\u8bf4\u7684\u90a3\u4e2a\u6837\u5b50\uff0c\u6211\u4eec\u660e\u786e\u5730\u77e5\u9053\uff0c$i=1$ \u8c03\u7528\u65f6 $sum_{1-1=0}$ \u4e0d\u53ef\u80fd\u662f\u5947\u6570\uff08\u6570\u90fd\u6ca1\u6709\u80af\u5b9a\u662f $0$ \u5566\uff09\uff0c\u6240\u4ee5\u5728\u63d2\u5165 vector\u3001\u5224\u65ad\u56de\u7b54\u7684\u65f6\u5019\u90fd\u538b\u6839\u4e0d\u9700\u8981\u7ba1\u5b83\u4e86\u3002\n\n\u60f3\u5fc5\u5927\u5bb6\u90fd\u5dee\u4e0d\u591a\u61c2\u4e86\uff0c\u770b\u4ee3\u7801\u5427\u3002\u5206\u6790\u590d\u6742\u5ea6\uff0c\u5e94\u4e3a $O(m\\log n)$\u3002\n\n```\n#include <bits/stdc++.h>\nusing namespace std;\n#define pb push_back \ntypedef long long ll;\nmap <ll,ll> D;\nvector <ll> v;\nll father[20005],l[10005],r[10005];\nstring str[10005];\nll Find(ll x){\n    if(father[x]==x) return x;\n    return father[x]=Find(father[x]);\n}\nvoid Unite(ll x,ll y){\n    ll X=Find(x),Y=Find(y);\n    if(X!=Y) father[X]=Y;\n}\nint main()\n{\n    ll n,Q;\n    cin>>n>>Q;\n    for(ll i=1;i<=Q;i++){\n        cin>>l[i]>>r[i];\n        if(l[i]!=1) v.pb(l[i]-1+n);\n        v.pb(l[i]-1),v.pb(r[i]),v.pb(r[i]+n);\n        cin>>str[i];\n    }\n    sort(v.begin(),v.end());\n    for(ll i=0;i<v.size();i++) D[v[i]]=i+1;\n    for(ll i=1;i<=(1ll*v.size());i++) father[i]=i;\n    for(ll i=1;i<=Q;i++){\n        if(str[i]==\"even\" && (Find(D[l[i]-1])==Find(D[r[i]+n])  || l[i]!=1 && Find(D[l[i]-1+n])==Find(D[r[i]]))) { cout<<i-1<<endl; return 0; }\n        if(str[i]==\"odd\" && (Find(D[l[i]-1])==Find(D[r[i]]) || l[i]!=1 && Find(D[l[i]-1+n])==Find(D[r[i]+n]))) { cout<<i-1<<endl; return 0; }\n        if(str[i]==\"even\"){\n            Unite(D[l[i]-1],D[r[i]]);\n            if(l[i]!=1) Unite(D[l[i]-1+n],D[r[i]+n]);\n        }\n        if(str[i]==\"odd\"){\n            if(l[i]!=1) Unite(D[l[i]-1+n],D[r[i]]);\n            Unite(D[l[i]-1],D[r[i]+n]);\n        }\n    }\n    cout<<Q<<endl;\n    return 0;\n}\n```",
        "postTime": 1592989277,
        "uid": 300078,
        "name": "pengyule",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5937 \u3010[CEOI1999]Parity Game\u3011"
    },
    {
        "content": "[\u4f8b\u9898\uff1aP5937 [CEOI1999]Parity Game](https://www.luogu.com.cn/problem/P5937)\n\n\u8fd9\u9053\u9898\u65e2\u662f\u6269\u5c55\u57df\u7684\u4f8b\u9898\u4e5f\u662f\u8fb9\u5e26\u6743\u7684\u4f8b\u9898\uff0c\u662f\u9053\u4f18\u79c0\u7684\u7ec3\u4e60\u9898\u3002\u4e0b\u9762\u901a\u8fc7\u4e24\u79cd\u4e0d\u540c\u7684\u65b9\u6cd5\u7ed9\u51fa\u89e3\u51b3\u65b9\u6cd5\u3002\n\n## \u6269\u5c55\u57df\u601d\u8def\n\n\u524d\u7f00\u548c\u7684\u601d\u8def\u771f\u7684\u662f\u975e\u5e38\u5999\u554a\n\n\u9996\u5148\u5bf9\u4e8e\u533a\u95f4$[l,r]$\uff0c\u5c06\u5b83\u4eec\u7684\u524d\u7f00\u548c\u4f5c\u4e3a\u4e00\u4e2a\u5143\u7d20\u3002\u90a3\u4e48\u5982\u679c\u8bf4$[l,r]$\u6709\u5947\u6570\u4e2a$1$\uff0c\u90a3\u4e48$sum_{l-1}$\u548c$sum_r$\u7684\u524d\u7f00\u548c\u5947\u5076\u6027\u5fc5\u5b9a\u4e0d\u76f8\u7b49\u3002\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6269\u5c55\u57df\u5e76\u67e5\u96c6\uff0c\u5c06\u4e00\u4e2a\u524d\u7f00\u548c\u8282\u70b9\u62c6\u6210\u4e24\u4e2a\uff0c\u4e00\u4e2a\u5947\u6570\u4e00\u4e2a\u5076\u6570\u3002\n\n\u5bf9\u4e8e$odd$\uff0c\u8bf4\u660e\u5947\u5076\u6027\u4e0d\u76f8\u540c\u3002\u5148\u5224\u4e00\u4e0b\u5947\u5076\u6027\u662f\u5426\u76f8\u540c\uff0c\u76f8\u540c\u5219\u4e0d\u7b26\u5408\u6761\u4ef6\u76f4\u63a5\u8f93\u51fa\u7b54\u6848\u3002\u53cd\u4e4b\u5219\u76f4\u63a5\u5408\u5e76\u5947\u6570\u548c\u5947\u6570\uff0c\u5076\u6570\u548c\u5076\u6570\u3002\n\n\u5bf9\u4e8e$even$\u540c\u7406\uff0c\u7136\u540e\u53ea\u9700\u8981\u518d\u79bb\u6563\u5316\u4e00\u4e0b\uff0c\u8fd9\u9898\u5c31\u89e3\u51b3\u4e86\u3002\n\n## Code\n```\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\n#include<cstring>\n#define ll long long\nusing namespace std;\nconst int N=50005;\nint n,m,sum,tot; \nint fa[2*N],li[2*N];\nstruct Node{\n\tint x,y,op;\n}a[2*N];\nint get(int x){\n\tif(x==fa[x]) return x;\n\telse return fa[x]=get(fa[x]);\n}\nvoid merge(int x,int y){\n\tfa[get(x)]=get(y);\n}\nvoid lisan(){\n\tsort(li+1,li+1+tot);\n\tsum=unique(li+1,li+1+tot)-li;\n}\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=m;i++){\n\t\tstring s;\n\t\tscanf(\"%d%d\",&a[i].x,&a[i].y);\n\t\tcin>>s;\n\t\tif(s==\"odd\"){\n\t\t\ta[i].op=1;\n\t\t}\n\t\telse{\n\t\t\ta[i].op=2;\n\t\t}\n\t\tli[++tot]=a[i].x;\n\t\tli[++tot]=a[i].y;\n\t}\n\tlisan();\n\tfor(int i=1;i<=2*sum+2;i++){\n\t\tfa[i]=i;\n\t}\n\tfor(int i=1;i<=m;i++){\n\t\ta[i].x=lower_bound(li+1,li+1+sum,a[i].x-1)-li;\n\t\ta[i].y=lower_bound(li+1,li+1+sum,a[i].y)-li;\n\t}\n\tfor(int i=1;i<=m;i++){\n\t\tif(a[i].op==1){\n\t\t\tif(get(a[i].x)==get(a[i].y)){\n\t\t\t\tprintf(\"%d\\n\",i-1);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tmerge(a[i].x,a[i].y+sum+1);\n\t\t\tmerge(a[i].x+sum+1,a[i].y);\n\t\t}\n\t\telse{\n\t\t\tif(get(a[i].x)==get(a[i].y+sum+1)){\n\t\t\t\tprintf(\"%d\\n\",i-1);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tmerge(a[i].x,a[i].y);\n\t\t\tmerge(a[i].x+sum+1,a[i].y+sum+1);\n\t\t}\n\t}\n\tprintf(\"%d\\n\",m);\n\treturn 0;\n}\n```\n\n## \u7ec6\u8282\n\n$1.lyd$\u7684\u9ed1\u4e66\u4ee3\u7801\u8c8c\u4f3c\u9505\u4e86\uff1f\u521d\u59cb\u5316$fa$\u6570\u7ec4\u7684\u65f6\u5019\u53ea\u5faa\u73af\u5230\u4e86$2n$\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u5728\u5408\u5e76\u7684\u65f6\u5019\uff0c\u5947\u6570\u548c\u5076\u6570\u5206\u522b\u662f$x$\u548c$x+n$\u3002\u5982\u679c$x$\u6070\u597d\u4e3a$1$\uff0c\u90a3\u4e48$-1$\u4e4b\u540e$x=0$\uff0c$x+n=n$\uff0c\u6b64\u65f6\u5e94\u8be5\u8868\u793a\u4e00\u4e2a$0$\u7684\u5076\u6570\u57df\u3002\u4f46\u662f\u540c\u65f6$n$\u4e5f\u8868\u793a$n$\u7684\u5947\u6570\u57df\uff0c\u6240\u4ee5\u51b2\u7a81\u4e86\u3002\u5728\u521d\u59cb\u5316$fa$\u6570\u7ec4\u65f6\u5e94\u8be5\u5faa\u73af\u5230$2n+1$\uff0c\u7136\u540e\u5728\u5408\u5e76\u7684\u65f6\u5019\u7528$x+n+1$\u6765\u4ee3\u8868\u5076\u6570\u57df\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u907f\u514d\u51b2\u7a81\u3002\u6240\u4ee5\u5982\u679c\u4e66\u4e2d$n$\u4ee3\u8868\u79bb\u6563\u5316\u540e\u7684\u5e8f\u5217\u5143\u7d20\u4e2a\u6570\uff0c\u7684\u786e\u662f\u6709\u95ee\u9898\u7684\u3002\n\n$2.$\u521d\u59cb\u5316\u522b\u5fd8\u4e86\u5faa\u73af\u5230$2n+1$\uff0c\u800c\u4e0d\u662f$n+1$\u3002\n\n## \u8fb9\u5e26\u6743\u601d\u8def\n\n\u6ce8\u610f\u5230\u5947\u5076\u6027\u53ef\u4ee5\u7528\u5f02\u6216\u548c\u6765\u8868\u8fbe\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u7528\u8fb9\u6743\u4e3a$1$\u7684\u8fb9\u6765\u8868\u793a\u4e24\u4e2a\u70b9\u7684\u5947\u5076\u6027\u4e0d\u540c\uff0c\u7528$0$\u6765\u8868\u793a\u5947\u5076\u6027\u76f8\u540c\u3002\n\n\u4e0b\u9762\u5c31\u662f\u8001\u5957\u8def\u4e86\uff0c\u5148\u9012\u5f52\u66f4\u65b0\u7236\u8282\u70b9\uff0c\u7136\u540e\u9010\u4e2a\u66f4\u65b0\u3002\u56e0\u4e3a\u76f8\u5bf9\u5173\u7cfb\u4e0d\u53d8\uff0c\u6240\u4ee5$d_x$$^$$=d_{fa[x]}$\u3002\u5728\u5408\u5e76\u7684\u65f6\u5019\u53ea\u9700\u8981\u624b\u73a9\u4e00\u4e0b\u8ddf\u6839\u8282\u70b9\u7684\u5173\u7cfb\u5373\u53ef\uff0c\u7136\u540e\u518d\u7279\u5224\u4e00\u4e0b\u662f\u5426\u5408\u6cd5\u5c31\u53ef\u4ee5\u4e86\u3002\n\n## Code\n```\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\n#include<cstring>\n#define ll long long\nusing namespace std;\nconst int N=50005;\nint n,m,sum,tot; \nint fa[2*N],li[2*N],d[2*N];\nstruct Node{\n\tint x,y,op;\n}a[2*N];\nint get(int x){\n\tif(x==fa[x]) return x;\n\tint root=get(fa[x]);\n\td[x]^=d[fa[x]];\n\treturn fa[x]=root;\n}\nvoid merge(int x,int y){\n\tfa[get(x)]=get(y);\n}\nvoid lisan(){\n\tsort(li+1,li+1+tot);\n\tsum=unique(li+1,li+1+tot)-li;\n}\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=m;i++){\n\t\tstring s;\n\t\tscanf(\"%d%d\",&a[i].x,&a[i].y);\n\t\tcin>>s;\n\t\tif(s==\"odd\"){\n\t\t\ta[i].op=1;\n\t\t}\n\t\telse{\n\t\t\ta[i].op=2;\n\t\t}\n\t\tli[++tot]=a[i].x;\n\t\tli[++tot]=a[i].y;\n\t}\n\tlisan();\n\tfor(int i=1;i<=sum+2;i++){\n\t\tfa[i]=i;\n\t}\n\tfor(int i=1;i<=m;i++){\n\t\ta[i].x=lower_bound(li+1,li+1+sum,a[i].x-1)-li;\n\t\ta[i].y=lower_bound(li+1,li+1+sum,a[i].y)-li;\n\t}\n\tfor(int i=1;i<=m;i++){\n\t\tif(a[i].op==1){\n\t\t\tint x=a[i].x,y=a[i].y;\n\t\t\tint p=get(x),q=get(y);\n\t\t\tif(p==q){\n\t\t\t\tif(d[x]^d[y]!=1){\n\t\t\t\t\tprintf(\"%d\\n\",i-1);\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif(d[x]!=d[y]){\n\t\t\t\t\td[p]=0;\n\t\t\t\t\tfa[p]=q;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\td[p]=1;\n\t\t\t\t\tfa[p]=q;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tint x=a[i].x,y=a[i].y;\n\t\t\tint p=get(x),q=get(y);\n\t\t\tif(p==q){\n\t\t\t\tif(d[x]^d[y]!=0){\n\t\t\t\t\tprintf(\"%d\\n\",i-1);\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif(d[x]!=d[y]){\n\t\t\t\t\td[p]=1;\n\t\t\t\t\tfa[p]=q;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\td[p]=0;\n\t\t\t\t\tfa[p]=q;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\",m);\n\treturn 0;\n}\n```\n",
        "postTime": 1610248335,
        "uid": 306982,
        "name": "\u4e8cgou\u5b50",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5937 \u3010[CEOI1999]Parity Game\u3011"
    },
    {
        "content": "\u672c\u9898\u4e3a\u5e76\u67e5\u96c6\u5165\u95e8\u8005\u7684\u5fc5\u505a\u597d\u9898\uff0c\u8fc7\u8005\u53ef\u4ee5\u518d\u53bb\u505a\u4e00\u4e0b[P2024 [NOI2001]\u98df\u7269\u94fe](https://www.luogu.com.cn/problem/P2024)\n\n\u5206\u6790\uff1a\n\n\u6211\u4eec\u5728\u5e8f\u5217S\u4e0a\u53ef\u4ee5\u5efa\u7acb\u524d\u7f00\u548c\u6570\u7ec4pre(MaxS)\u3002\n\n\u82e5S(l ~ r)\u6709\u5076\u6570\u4e2a1\uff0c\u5219pre(l - 1)\u4e0epre(r)\u5947\u5076\u6027\u76f8\u540c\uff1b\u53cd\u4e4b\u5219\u76f8\u53cd\u3002\n\n\u800c\u8fd9\u4e9b\u5947\u5076\u6027\u7684\u5173\u7cfb\u662f\u53ef\u4f20\u9012\u7684\uff0c\u5982\u679c\u53d1\u751f\u53c8\u540c\u5947\u5076\u53c8\u5f02\u5947\u5076\u5c31\u80fd\u627e\u5230\u77db\u76fe\u3002\n\n\u6240\u4ee5\u8fd9\u9053\u9898\u6211\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\uff0c\u63d0\u4f9b\u4e24\u79cd\u601d\u8def\u3002\n\nidea 1\uff1a\u6269\u5c55\u57df\u5e76\u67e5\u96c6\n\n\u6211\u4eec\u53ef\u4ee5\u628a\u6bcf\u4e2a\u8282\u70b9$x$\u62c6\u6210$x_{odd}$\u548c$x_{even}$\u3002\n\n\u5982\u679cpre(x)\u4e0epre(y)\u5947\u5076\u6027\u76f8\u540c\u5c31\u5408\u5e76$x_{odd}$\u4e0e$y_{odd}$\uff0c$x_{even}$\u4e0e$y_{even}$\n\n\u53cd\u4e4b\u5219\u76f8\u53cd\u3002\n\n\u5982\u679c\u6761\u4ef6\u8981\u6c42\u540c\u5947\u5076\u4f46$x_{odd} = y_{even}$\uff0c\u6216\u8981\u6c42\u5f02\u5947\u5076\u4f46$x_{odd} = y_{odd}$\uff0c\u5c31\u77db\u76fe\u4e86\uff0c\u8f93\u51fa\u524d\u4e00\u4e2a\u6761\u4ef6\u7684\u7f16\u53f7\u3002\n\n\u4f7f\u7528\u6309\u79e9\u5408\u5e76\u548c\u8def\u5f84\u538b\u7f29\u53ef\u4ee5\u628a\u5e76\u67e5\u96c6\u90e8\u5206\u5355\u6b21\u64cd\u4f5c\u4f18\u5316\u5230$O$($\\alpha$)\uff0c\u4f46\u7531\u4e8e\u8981\u79bb\u6563\u5316\uff0c\u6240\u4ee5\u590d\u6742\u5ea6\u8fd8\u662f\u67091\u4e2alog\uff0c\u74f6\u9888\u5728\u4e8e\u79bb\u6563\u5316\u3002\n\n\ncode: [\u4ee3\u7801\u592a\u957f\u653e\u4e0d\u4e0bqwq\u3002](https://www.luogu.com.cn/paste/7ik4ty0q)\n\n\nidea 2: \u8fb9\u5e26\u6743\u5e76\u67e5\u96c6\n\n\u5927\u4f53\u601d\u8def\u5176\u5b9e\u90fd\u5dee\u4e0d\u591a\uff0c\u8fd9\u91cc\u4f7f\u7528\u8fb9\u6743\u5f02\u6216\u503c\u6765\u7ef4\u62a4\u5947\u5076\u6027\u3002\n\n\u7ef4\u62a4d(Maxm)\u6570\u7ec4\uff0c\u6765\u9610\u8ff0\u6e05\u695a\u8282\u70b9x\u548cgetf(x)\u5947\u5076\u5173\u7cfb\uff0c\u95f4\u63a5\u8868\u73b0\u540c\u96c6\u5408\u5185\u4e24\u70b9\u5947\u5076\u5173\u7cfb\u3002\u5982\u679c\u4e0d\u5728\u540c\u4e00\u96c6\u5408\uff0c\u8fdb\u884c\u5408\u5e76\uff0c\u6539\u53d8\u5e76\u5165\u7684\u90a3\u4e2a\u96c6\u5408\u7684d(root)\u5373\u53ef\u3002\n\n\u5408\u5e76\u51fd\u6570:\n\n```cpp\ninline void unionf(int x, int y, int op) {\n\tint fx = getf(x), fy = getf(y);\n\tif (sze[fx] <= sze[fy]) sze[fy] += sze[fx], f[fx] = fy, d[fx] = d[x] ^ d[y] ^ op;\n\telse sze[fx] += sze[fy], f[fy] = fx, d[fy] = d[x] ^ d[y] ^ op;\n}\n\n```\n\ncode\uff1a\n\n```cpp\nconst int Maxm = 1e4 + 5;\nint n, m, f[Maxm], d[Maxm], sze[Maxm], a[Maxm]; char cmd[15];\n\ninline int getf(int x) {\n\tif (f[x] == x) return x;\n\tint root = getf(f[x]);\n\td[x] ^= d[f[x]];\n\treturn f[x] = root;\n}\n\ninline void unionf(int x, int y, int op) {\n\tint fx = getf(x), fy = getf(y);\n\tif (sze[fx] <= sze[fy]) sze[fy] += sze[fx], f[fx] = fy, d[fx] = d[x] ^ d[y] ^ op;\n\telse sze[fx] += sze[fy], f[fy] = fx, d[fy] = d[x] ^ d[y] ^ op;\n}\n\nstruct State {\n\tint l, r, opt;\n\tState(int _l = 0, int _r = 0, int _op = 0) : l(_l), r(_r), opt(_op) {}\n} que[Maxm / 2];\n\nsigned main(void) {\n//\tfile(\"\");\n\tread(n), read(m);\n\tfor (int i = 1, x, y; i <= m; i++) {\n\t\tread(x), read(y), readstr(cmd);\n\t\tque[i] = State(x, y, cmd[0] == 'o');\n\t\ta[i] = x - 1; a[i + m] = y;\n\t} sort(a + 1, a + (m << 1) + 1);\n\tn = unique(a + 1, a + (m << 1) + 1) - (a + 1);\n\tfor (int i = 1; i <= n << 1; i++) f[i] = i, sze[i] = 1, d[i] = 0;\n\tfor (int i = 1, x, y; i <= m; i++) {\n\t\tx = lower_bound(a + 1, a + n + 1, que[i].l - 1) - a;\n\t\ty = lower_bound(a + 1, a + n + 1, que[i].r) - a;\n\t\tif (getf(x) == getf(y)) {\n\t\t\tif ((d[x] ^ d[y]) != que[i].opt) { writeln(i - 1); return 0; }\n\t\t} else unionf(x, y, que[i].opt);\n\t} writeln(m);\n//\tfwrite(pf, 1, o1 - pf, stdout);\n\treturn 0;\n}\n```\n",
        "postTime": 1590919175,
        "uid": 50925,
        "name": "EternalEpic",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5937 \u3010[CEOI1999]Parity Game\u3011"
    },
    {
        "content": "\u6211\u4eec\u53ef\u4ee5\u5c06\u9898\u76ee\u4e2d\u7684\u6761\u4ef6$(i,j)$\u8f6c\u5316\u4e3a$(1,i)$\u548c$(1,j)$\u7684\u533a\u95f4\u5947\u5076\u6027\u7684\u5f02\u540c\uff1b\u8fd9\u6837\u6709\u5229\u4e8e\u6211\u4eec\u4f7f\u7528\u5e76\u67e5\u96c6\u4f18\u7f8e\u7684\u4f20\u9012\u6027\uff1b\u5176\u5b9e\u5c31\u662f\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u533a\u95f4$(1,i)$\u5f00\u4e24\u79cd\u96c6\u5408\uff1a\u5947\u5076\u6027\u76f8\u540c\u7684\u865a\u62df\u7684\u4e00\u4e2asame\uff0c\u4e0d\u540c\u7684\u865a\u62df\u7684\u4e00\u4e2adiff\uff1b\u7136\u540e\u6269\u5c55\u57df\u5408\u5e76\u5c31\u53ef\u4ee5\u5566\u3002\n\n~~\u6269\u5c55\u57df\u5199\u9519\u4e86\u597d\u51e0\u904d\uff0c\u52a0$m$\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u52a0$n$\u5c31\u4e0d\u884c\u4e86~~\n\n\u8fd9\u4e00\u4e9b\u60f3\u6cd5\u662f\u4ece\u4ee5\u4e0b\u5730\u65b9\u770b\u5230\u7684\uff1a\n//\u8f6c\u8f7d\u81ea$wanghandou$ blog CSDN\n\n\u7531\u4e8e\u9898\u8bbe\u4e2d\u8bf4\u660e\u8fd9\u4e2a\u957f\u5b57\u4e32\u4e0a\u6bcf\u4e00\u4f4d\u4e0d\u662f$0$\u5c31\u662f$1$\uff0c\u6240\u4ee5\u5c31\u5341\u5206\u5bb9\u6613\u5f97\u5230\u4ee5\u4e0b\u7ed3\u8bba\uff1a\n\n                    ->1.\u5f53\u533a\u95f4\uff08i\uff0cj\uff09\u4e3aeven\u65f6\uff0c\u533a\u95f4\uff08i\uff0cj\uff09\u4e0a\u7684\u548c\u4e3a\u5076\u6570\u3002\n                    ->2.\u5f53\u533a\u95f4\uff08i\uff0cj\uff09\u4e3aodd \u65f6\uff0c\u533a\u95f4\uff08i\uff0cj\uff09\u4e0a\u7684\u548c\u4e3a\u5947\u6570\u3002\n\n\u4ece\u800c\u53ef\u4ee5\u5b9a\u4e49\u4ee5\u4e0b\u72b6\u6001$sum(1,i)$\uff0c\u987e\u540d\u601d\u4e49\u5c31\u662f\u524d$i$\u4f4d\u7684\u548c\uff0c\u800c\u4e14\u663e\u7136\u6709$sum(1,i-1)+sum(i,j)=sum(1,j)$\u3002\n\u90a3\u4e48\u5bf9\u4e8e\u60c5\u51b5$1$\uff0c$sum(i,j)$\u4e3a\u5076\uff0c\u5219$sum(1,i-1)$\u4e0e$sum(1,j)$\u76f8\u540c\u6027\u8d28\uff0c\u540c\u5076\u6216\u540c\u5947\u3002\n\u90a3\u4e48\u5bf9\u4e8e\u60c5\u51b5$2$\uff0c$sum(i,j)$\u4e3a\u5947\uff0c\u5219$sum(1,i-1)$\u4e0e$sum(1,j)$\u76f8\u53cd\u6027\u8d28\uff0c\u4e00\u5947\u4e00\u5076\u3002\n\n\u6240\u4ee5\u5c31\u53ef\u4ee5\u8fd9\u6837\u60f3\uff0c\u5bf9\u4e8e\u7b2ci\u4f4d\uff0c\u6709\u4e24\u4e2a\u96c6\u5408\uff1a\u4e0e$sum(1,i-1)$\u76f8\u540c\u5947\u5076\u6027\u7684$SAME$\u96c6\u5408\uff0c\u4ee5\u53ca\u4e0e$sum(1,i-1)$\u76f8\u53cd\u5947\u5076\u6027\u7684$DIFF$\u96c6\u5408\u3002\n\u6bcf\u6b21\u8f93\u5165\u63d0\u793a\u8bed\u53e5\uff0c\u6839\u636e$sum(i,j)$\u7684\u5947\u5076\u6027\u8fdb\u884c\u96c6\u5408\u7684\u5408\u5e76\uff1a\n\n                    ->1.\u5f53\u533a\u95f4\uff08i\uff0cj\uff09\u4e3aeven\u65f6\uff0c\u5408\u5e76SAME[i-1]\u4e0eSAME[j]\uff0c\u5408\u5e76DIFF[i-1]\u4e0eDIFF[j]\u3002\n                    ->2.\u5f53\u533a\u95f4\uff08i\uff0cj\uff09\u4e3aodd\u65f6\uff0c\u5408\u5e76SAME[i-1]\u4e0eDIFF[j]\uff0c\u5408\u5e76DIFF[i-1]\u4e0eSAME[j]\u3002\n                    \n\u53ef\u4ee5\u628a$SAME$\u4e0e$DIFF$\u653e\u5728\u540c\u4e00\u6570\u7ec4$PAR$\u91cc\uff0c\u5206\u6210\u524d\u534a\u90e8\u5206\u548c\u540e\u534a\u90e8\u5206\u5373\u53ef\uff0c\u6ce8\u610f\u6570\u7ec4\u5927\u5c0f\uff0c\u5f00\u5c0f\u4f1aRE\u3002\n\n\u800c\u4ea7\u751f\u77db\u76fe\u7684\u65b9\u6cd5\u4e5f\u5f88\u5bb9\u6613\u60f3\u5230\uff1a\u6bcf\u6b21\u5408\u5e76\u5b8c\u6210\u540e\u67e5\u8be2$SAME[ i - 1 ]$\u4e0e$DIFF[ i - 1 ]$\u662f\u5426\u540c\u6839\u5373\u53ef\uff0c\u5982\u679c\u540c\u6839\u5c31\u8bf4\u660e\u77db\u76fe\u4e86\u3002\n\n```cpp\n#include <cstdio>\n#include <algorithm>\n#define Freopen(x) freopen(#x\".in\",\"r\",stdin),freopen(#x\".out\",\"w\",stdout);\n#define ll long long\n#define M m*2\nusing namespace std;\nvoid solve();\nint n,m,fa[20010];\nint lxh[20010],cnt=0;\nint find(int x){return fa[x]==x?x:fa[x]=find(fa[x]);}\nstruct node {int f,t;char s[6];}seg[10005];\nint main()\n{\n\t//Freopen()\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tscanf(\"%d%d%s\",&seg[i].f,&seg[i].t,seg[i].s);\n\t\tseg[i].f--;\n\t\tlxh[++cnt]=seg[i].f;\n\t\tlxh[++cnt]=seg[i].t;\n\t}\n\tsort(lxh+1,lxh+cnt+1);\n\tcnt=unique(lxh+1,lxh+cnt+1)-lxh-1;\n\t//printf(\"[[]]%d]]\",cnt);\n\tfor(int i=1;i<=cnt+M;i++)fa[i]=i;\n\tsolve();\n\treturn 0;\n}\nvoid solve()\n{\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint f=lower_bound(lxh+1,lxh+cnt+1,seg[i].f)-lxh;\n\t\tint t=lower_bound(lxh+1,lxh+cnt+1,seg[i].t)-lxh;\n\t//\tprintf(\"[%d %d]\\n\",f,t);\n\t\tif(seg[i].s[0]=='o')//odd\n\t\t\tfa[find(f+M)]=find(t),\n\t\t\tfa[find(f)]=find(t+M);\n\t\t//\tprintf(\"union %d-%d %d-%d\",f+M,t,f,t+M);\n\t\telse if(seg[i].s[0]=='e')//even\n\t\t\tfa[find(f)]=find(t),\n\t\t\tfa[find(f+M)]=find(t+M);\n\t\t//\tprintf(\"union %d-%d %d-%d\",f,t,f+M,t+M);\n\t\tif(find(f)==find(f+M))\n\t\t{\n\t\t\tprintf(\"%d\\n\",i-1);\n\t\t\treturn;\n\t\t}\n\t}\n\tprintf(\"%d\\n\",m);\n\treturn;\n}\n```\n",
        "postTime": 1579785204,
        "uid": 38882,
        "name": "Develop",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5937 \u3010[CEOI1999]Parity Game\u3011"
    },
    {
        "content": "\u5199\u4e00\u7bc7\u5e76\u67e5\u96c6\u7684\u9898\u89e3\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651 **\u5bf9\u4e8e\u6bcf\u4e00\u6b21\u7ed9\u51fa** \u7684\u533a\u95f4 $[a,b]$\uff0c**\u628a $b$ \u5e76\u5165\u5230 $a-1$ \u6240\u5c5e\u7684\u96c6\u5408\u4e2d**\u3002\u540c\u65f6\u7ef4\u62a4 $b$ \u5230 $a-1$ **\u96c6\u5408\u6839\u8282\u70b9\u8def\u5f84\u957f\u5ea6\u7684\u5947\u5076\u6027**\u3002\n\n\u5728\u539f\u6765\u7684\u5e76\u67e5\u96c6\u57fa\u7840\u4e0a\u7a0d\u4f5c\u4fee\u6539\uff08$be_i$ \u8868\u793a $i$ \u5230 $i$ \u6240\u5904\u96c6\u5408\u6839\u8282\u70b9\u8def\u5f84\u7684\u5947\u5076\u6027\uff09\uff1a\n\n```cpp\ninline int find(int x){\n\tif(fa[x]==x) return x;\n\tint fn=find(fa[x]);\n\tbe[x]^=be[fa[x]];//\u66f4\u65b0be\u6570\u7ec4\n\treturn fa[x]=fn;//\u8def\u5f84\u538b\u7f29\n}\ninline void merge(int x, int y){\n\tfa[sev]=seu;\n\tbe[sev]=be[v]^be[u]^re;//\u66f4\u65b0be\u6570\u7ec4\n}\n```\n\n\u90a3\u4e48\uff0c\u6211\u4eec\u600e\u4e48\u786e\u5b9a\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u533a\u95f4 $[l,r]$ \u5b83\u662f\u5426\u6210\u7acb\u5462\uff1f\uff1f\uff1f\n\n**\u660e\u663e\uff0c\u6211\u4eec\u53ea\u9700\u8981\u77e5\u9053\u533a\u95f4 $[l,r]$ \u7684\u5947\u5076\u6027\uff0c\u5c31\u53ef\u4ee5\u4e86**\uff0c\u800c\u8fd9\u4e00\u4e2a\u533a\u95f4\u7684\u5947\u5076\u6027\u5c31\u7b49\u4e8e $be_{l-1} \\oplus be_r$\u3002\n\n```\ntmp=be[l-1]^be[r];\nif(tmp!=re) {cout<<i-1;exit(0);}\n```\n\n\u8fd9\u6837\u5b50\u4e00\u6765\uff0c\u5c31\u53ef\u4ee5\u56de\u7b54\u8be2\u95ee\uff0c\u5224\u65ad\u662f\u5426\u548c\u9898\u76ee\u7ed9\u51fa\u7684\u76f8\u7b26\u3002\n\n\u5b8c\u6574\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define RI register int\nusing namespace std;\ntypedef long long ll;\nint n, m, u, v, seu, sev, re;\nstring s;\nmap<int,int>be,fa;\nmap<int,bool>vis;//\u56e0\u4e3a\u6570\u636e\u8303\u56f4\u6bd4\u8f83\u5927\uff0c\u6240\u4ee5\u7528map\u6620\u5c04\ninline int find(int x){\n\tif(fa[x]==x) return x;\n\tint fn=find(fa[x]);\n\tbe[x]^=be[fa[x]];\n\treturn fa[x]=fn;\n}\ninline void und(int x){\n\tif(vis[x]) return ;\n\tvis[x]=1;fa[x]=x;\n\treturn ;\n}\nint main(){\n\tint tmp;\n\tcin>>n>>m;\n\tfor(RI i=1;i<=m;++i){\n\t\tcin>>u>>v>>s;u--;re=(s==\"odd\"?1:0);\n\t\tund(u), und(v);\n\t\tseu=find(u), sev=find(v);\n\t\tif(seu!=sev) {\n\t\t\tfa[sev]=seu;\n\t\t\tbe[sev]=be[v]^be[u]^re;\n\t\t}\n\t\telse{\n\t\t\ttmp=be[u]^be[v];\n\t\t\tif(tmp!=re) {cout<<i-1;exit(0);}\n\t\t}\t\n\t}\n\tcout<<m;\n\treturn 0;\n}\n```",
        "postTime": 1602918170,
        "uid": 261914,
        "name": "Emy_Ycc",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5937 \u3010[CEOI1999]Parity Game\u3011"
    },
    {
        "content": "# Solution\n\u770b\u5230\u9898\u89e3\u533a\u90fd\u4f7f\u7528\u4e86\u6269\u5c55\u57df\u5e76\u67e5\u96c6\uff0c\u6211\u6765\u63d0\u4f9b\u4e00\u4e2a**\u8fb9\u5e26\u6743\u5e76\u67e5\u96c6**\u7684\u505a\u6cd5\u3002\n\n- \u82e5\u533a\u95f4 $[l,r]$ \u4e2d\u6709\u5947\u6570\u4e2a $1$ \uff0c\u5219\u8bf4\u660e\u533a\u95f4 $[1,l]$ \u4e0e\u533a\u95f4 $[1,r]$ \u4e2d $1$ \u7684\u6570\u91cf\u7684\u5947\u5076\u6027\u4e0d\u540c\u3002\n\n- \u82e5\u533a\u95f4 $[l,r]$ \u4e2d\u6709\u5076\u6570\u4e2a $1$ \uff0c\u5219\u8bf4\u660e\u533a\u95f4 $[1,l]$ \u4e0e\u533a\u95f4 $[1,r]$ \u4e2d $1$ \u7684\u6570\u91cf\u7684\u5947\u5076\u6027\u76f8\u540c\u3002\n \n\u4e8e\u662f\u53ef\u4ee5\u7528 $0$ \u8868\u793a\u76f8\u540c\uff0c$1$ \u8868\u793a\u4e0d\u540c\uff0c\u5229\u7528\u5f02\u6216\u8fd0\u7b97\u7ef4\u62a4\u8fb9\u6743\u3002\n\n\u8bbe$fa_i$\u8868\u793a $i$ \u7684\u7956\u5148\u8282\u70b9\uff0c$d_i$\u8868\u793a $i$ \u8282\u70b9\u5230\u7956\u5148\u7684\u8fb9\u6743\u3002\n\n- \u82e5 $x$ \u4e0e $y$ \u7956\u5148\u76f8\u540c\uff0c\u5219\u5224\u65ad $d_x \\oplus d_y$ \u4e0e\u7ed9\u51fa\u7684\u7b54\u6848\u662f\u5426\u76f8\u540c\u3002\n\n- \u82e5 $x$ \u4e0e $y$ \u7956\u5148\u4e0d\u540c\uff0c\u5219\u5408\u5e76\u4e8c\u8005\u6240\u5728\u96c6\u5408\uff0c\u5e76\u5c06 $fa_x$ \u5230 $fa_y$ \u7684\u6743\u503c\u8bbe\u4e3a $d_x \\oplus d_y \\oplus ans_i$\u3002\n\n\u53ef\u4ee5\u5728\u67e5\u627e $fa_i$ \u65f6\u66f4\u65b0 $d_i$ \u3002\u53e6\u5916\u6ce8\u610f\u5230 $n$ \u8f83\u5927\uff0c\u800c $m$ \u8f83\u5c0f\uff0c\u6240\u4ee5\u5bf9\u6570\u636e\u8fdb\u884c\u79bb\u6563\u5316\u3002\n# Code\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\nusing namespace std;\nconst int maxn=2e4+10;\nint n,m,len,a[maxn],b[maxn],fa[maxn],d[maxn],c[maxn>>1][3];\nbool f=false;\nint Gtid(int x){\n\tint l=1,r=len,mid;\n\twhile(l<r){\n\t\tmid=(l+r+1)>>1;\n\t\tif(b[mid]<=x)\n\t\t\tl=mid;\n\t\telse\n\t\t\tr=mid-1;\n\t}\n\treturn l;\n}\nint Gtfa(int x){\n\tif(x==fa[x])\n\t\treturn x;\n\tint y=Gtfa(fa[x]);\n\td[x]^=d[fa[x]];\n\treturn fa[x]=y;\n}\nint main(){\n\tint x,y,fx,fy;\n\tstring s;\n\tcin>>n>>m;\n\tfor(int i=1;i<=m;i++){\n\t\tcin>>c[i][0]>>c[i][1]>>s;\n\t\tif(s==\"even\")\n\t\t\tc[i][2]=0;\n\t\telse\n\t\t\tc[i][2]=1;\n\t\tc[i][0]--;\n\t\ta[i*2-1]=c[i][0];\n\t\ta[i*2]=c[i][1];\n\t}\n\tsort(a+1,a+2*m+1);\n\tfor(int i=1;i<=2*m;i++)\n\t\tif(i==1||a[i]!=a[i-1])\n\t\t\tb[++len]=a[i];\n\tfor(int i=1;i<=len;i++)\n\t\tfa[i]=i;\n\tfor(int i=1;i<=m;i++){\n\t\tx=Gtid(c[i][0]);\n\t\ty=Gtid(c[i][1]);\n\t\tfx=Gtfa(x);\n\t\tfy=Gtfa(y);\n\t\tif(fx==fy){\n\t\t\tif((d[x]^d[y])!=c[i][2]){\n\t\t\t\tcout<<i-1;\n\t\t\t\tf=true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tfa[fx]=fy;\n\t\t\td[fx]=d[x]^d[y]^c[i][2];\n\t\t}\n\t}\n\tif(!f)\n\t\tcout<<m;\n\treturn 0;\n}\n```\n",
        "postTime": 1583742084,
        "uid": 118433,
        "name": "LB_tq",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5937 \u3010[CEOI1999]Parity Game\u3011"
    }
]
[
    {
        "content": "\u8bb0 $|S|$ \u8868\u793a\u96c6\u5408 $S$ \u7684\u5143\u7d20\u4e2a\u6570\uff0c$*$ \u8868\u793a\u5b50\u96c6\u5e76\u5377\u79ef\u8fd0\u7b97\uff0c\u5373 $h_i = \\sum_{j\\cup k = i} f_j \\times g_k$\u3002\n\n\u7b2c\u4e00\u4e2a\u9650\u5236 $i \\cup j=k$ \u5bb9\u6613\u5904\u7406\uff0c\u76f4\u63a5 FWT \u8ba1\u7b97\u5b50\u96c6\u5e76\u5377\u79ef\u5373\u53ef\u3002\n\n\u8003\u8651\u7b2c\u4e8c\u4e2a\u9650\u5236 $ i \\cap j=\\varnothing$\uff0c\u7b49\u4ef7\u4e8e $|i|+|j|=|i\\cup j|$\u3002\u6211\u4eec\u518d\u5f00\u4e00\u7ef4\u8bb0\u5f55\u96c6\u5408\u4e2d\u7684\u5143\u7d20\u4e2a\u6570\u5373\u53ef\u3002\n\n\u5177\u4f53\u5730\uff0c\u4ee4 $f_{i,j} = \\begin{cases}a_j\\,(|j|=i)\\\\0\\end{cases}$\uff0c$g_{i,j} = \\begin{cases}b_j\\,(|j|=i)\\\\0\\end{cases}$\uff0c\u6709 $h_i=\\sum_{k=0}^i f_k * g_{i-k}$\u3002\u6700\u540e\u6211\u4eec\u6240\u6c42\u7684\u7b54\u6848 $c_i = h_{|i|,i}$\u3002\n\n\u590d\u6742\u5ea6 $\\mathcal O(n^2 2^n)$\u3002\u4f9b\u9898\u4eba\u5f00 3s \u4e0d\u77e5\u9053\u662f\u4ec0\u4e48\u5fc3\u6001\uff0c\u4e0d\u660e\u767d\u6a21\u677f\u9898\u5361\u5e38\u6709\u4ec0\u4e48\u610f\u4e49\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\nconst int mod=1e9+9;\nint a[22][1<<21],b[22][1<<21],h[22][1<<21],n,t;\nint ctz(int x){return __builtin_popcount(x);}\n\nvoid fwt(int *a,int n,int flag){\n\tfor(int i=1;i<n;i<<=1)\n\tfor(int len=i<<1,j=0;j<n;j+=len)\n\tfor(int k=0;k<i;++k){\n\t\tif (flag==1)a[j+k+i]=(a[j+k]+a[j+k+i])%mod;\n\t\telse a[j+k+i]=(a[j+k+i]-a[j+k]+mod)%mod;\n\t}\n}\n\n\nint main(){\n\tscanf(\"%d\",&n);\n\tint lim=n;n=1<<n;\n\tfor(int i=0;i<n;++i)\n\t\tscanf(\"%d\",&a[ctz(i)][i]);\n\tfor(int i=0;i<n;++i)\n\t\tscanf(\"%d\",&b[ctz(i)][i]);\n\tfor(int i=0;i<=lim;++i){\n\t\tfwt(a[i],n,1);fwt(b[i],n,1);\n\t}for(int i=0;i<=lim;++i)\n\t\tfor(int j=0;j<=i;++j)\n\t\t\tfor(int k=0;k<n;++k)h[i][k]=(h[i][k]+(ll)a[j][k]*b[i-j][k]%mod)%mod;\n\tfor(int i=0;i<=lim;++i)fwt(h[i],n,-1);\n\tfor(int i=0;i<n;++i)printf(\"%d \",h[ctz(i)][i]);\n\treturn 0;\n}\n\t\n\t\n\t\n\t\n```\n",
        "postTime": 1581699732,
        "uid": 48355,
        "name": "EternalAlexander",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P6097 \u3010\u3010\u6a21\u677f\u3011\u5b50\u96c6\u5377\u79ef\u3011"
    },
    {
        "content": "# \u5b50\u96c6\u5377\u79ef\n\n\u5f53\u7136\u60a8\u4e5f\u53ef\u4ee5\u5230[\u8fd9\u91cc](https://www.cnblogs.com/yijan/p/12387352.html)\u9605\u8bfb\n\n## FMT\n\n\u7ed9\u5b9a\u6570\u5217 $ a_{0\\dots 2^{k}-1} $ \u6c42 $ b $ \u6ee1\u8db3 $ b_{s} = \\sum_{i\\in s} a_i $\n\n\u5b9e\u73b0\u65b9\u6cd5\u5f88\u7b80\u5355\uff0c\n\n```\nfor( i in 0 to n-1 ) \n\tfor( j in 0 to 2^n-1)\n\t\tif( j & ( 1 << i ) ) \n\t\t\ta[j] += a[j ^ ( 1 << i )]\n```\n\n\u7136\u540e\u79f0\u4e3a $ B = \\text{FMT}(A) $ \uff0c\u5feb\u901f\u83ab\u6bd4\u4e4c\u65af\u53d8\u6362\n\n\u60f3\u8981\u8fd8\u539f\u4e5f\u5f88\u7b80\u5355\uff0c\u628a\u4ee3\u7801\u53cd\u7740\u5199\uff1a\n\n```\nfor( i in n-1 downTo 0 ) \n\tfor( j in 2^n - 1 downTo 0)\n\t\tif( j & ( 1 << i ) ) \n\t\t\ta[j] -= a[j ^ ( 1 << i )]\n```\n\n\u5f53\u7136\uff0c $ i $ \u7684\u987a\u5e8f\u53ef\u4ee5\u662f\u539f\u6765\u7684\u987a\u5e8f\uff0c\u56e0\u4e3a\u6309\u7167\u54ea\u4e2a\u987a\u5e8f\u679a\u4e3e\u4f4d\u6839\u672c\u4e0d\u91cd\u8981\n\n\u540c\u65f6\uff0c$ j $ \u7684\u987a\u5e8f\u4e5f\u4e0d\u91cd\u8981\uff0c\u8003\u8651\u5bf9\u4e8e\u4e00\u4e2a\u6570\u5b57\uff0c\u5b83\u53ea\u6709\u5728\u5f53\u524d\u679a\u4e3e\u7684\u4f4d\u6570\u4e3a 1 \u7684\u65f6\u5019\u624d\u88ab\u6267\u884c\uff0c\u6240\u4ee5\u5c31\u7b97\u5df2\u7ecf\u679a\u4e3e\u5230\u8fd9\u4f4d\u662f 0 \u7684\u72b6\u6001\uff0c\u5b83\u4e5f\u4e0d\u4f1a\u88ab\u66f4\u65b0\u3002\n\n\u6240\u4ee5\u751a\u81f3\u53ea\u9700\u8981\u6539\u4e2a\u7b26\u53f7\u5c31\u662f\u9006\u53d8\u6362\u4e86\n\n```\nfor( i in 0 to n-1 ) \n\tfor( j in 0 to 2^n-1)\n\t\tif( j & ( 1 << i ) ) \n\t\t\ta[j] -= a[j ^ ( 1 << i )]\n```\n\n\u8fd9\u6837 $ A = \\text{IFMT}( B ) $\n\nFMT \u53ef\u4ee5\u5199\u6210 FFT \u90a3\u6837\u7684\u5f62\u5f0f\uff0c\u53ef\u4ee5\u79fb\u6b65 FWT \u9898\u89e3\u533a\u6709\u5f88\u591a\uff0c\u5c31\u4e0d\u8d58\u8ff0\u4e86\u3002\n\n## \u6216\u5377\u79ef\n\n\u6216\u5377\u79ef\u5c31\u9700\u8981\u7528\u5230\u8fd9\u4e2a\u4e1c\u897f\u3002\n\n\u6216\u5377\u79ef\u662f\u6307\uff1a\n$$\nC_s = \\sum_{i|j=s} A_i B_j\n$$\n\u6709\u4e00\u4e2a\u7ed3\u8bba\uff0c $ \\text{FMT}(C) = \\text{FMT}(A) \\cdot \\text{FMT}(B) $ \uff0c\u5176\u4e2d $\\cdot$ \u6307\u70b9\u79ef\uff0c\u4e5f\u5c31\u662f\u628a\u6bcf\u4e2a\u4f4d\u7f6e\u7684\u51fd\u6570\u503c\u4e58\u8d77\u6765\u3002\n\n\u539f\u56e0\u662f $(i \\cup j) \\subseteq s$ \u7b49\u4ef7\u4e8e $(i \\subseteq  s)\\land(j \\subseteq s)$ \u3002\u4e8e\u662f\n$$\n\\begin{aligned} \n\\ [x]FMT(C) \n&=\\sum_{s \\subseteq x}C_s\\\\\n&= \\sum_{s \\subseteq x}\\sum_{i|j = s}A_iB_j\\\\\n&= \\sum_{i|j \\subseteq x} A_iB_j\\\\\n&= ( \\sum_{i\\subseteq x} A_i )(\\sum_{j\\subseteq x} B_j)\\\\\n&= [x]FMT(A) \\cdot [x]FMT(B) \n\\end{aligned}\n$$\n\u6240\u4ee5\u6709 $ \\text{FMT}(C) = \\text{FMT}(A) \\cdot \\text{FMT}(B) $ \n\n\u4e8e\u662f\u53ef\u4ee5 $ O(n2^n) $ \u505a\u8fd9\u4e2a\u3002\n\n## \u5b50\u96c6\u5377\u79ef\n\n\u5b50\u96c6\u5377\u79ef\u957f\u8fd9\u6837\uff1a\n$$\nC_s = A\\times_{subset} B = \\sum_{i|j=s,i\\&j = 0} A_i B_j\n$$\n\n\n\u5982\u679c\u8bbe $ p(x) $ \u4e3a $ x $ \u7684 popcount\uff08 1 \u7684\u4e2a\u6570\uff09\uff0c\u90a3\u4e48\uff1a\n\n$$\n(i|j = s) , (i\\&j = 0) \\Leftrightarrow i|j = s , p(i)+p(j) = p(s)\n$$\n$$\nC_s = \\sum_{i|j = s , p(i)+p(j) = p(s)} A_iB_j\n$$\n\u6211\u4eec\u628a $ C $ \u6269\u5c55\u5230\u4e8c\u7ef4\uff0c\u8bbe $ C'_{x,k} $\uff0c\u5b9a\u4e49\u5982\u4e0b\uff1a \n$$\nC'_{x,s} = \\sum_{i|j = s,p(i)+p(j) = x} A_iB_j[p(s) = x]\n$$\n\u628a $ C $ \u6269\u5c55\u5230\u4e8c\u7ef4\u4e86\uff0c$ A $ \u4e5f\u6269\u5c55\u5230\u4e8c\u7ef4\uff0c\u5b9a\u4e49 $ A'_{p,s} $ \n$$\nA'_{x,s} = \\left\\{\\begin{aligned}&0 & {p(s) \\neq x}\\\\&A_{s} & {p(s) = x} \\end{aligned}\\right.\n$$\n\u540c\u7406\u5b9a\u4e49 $ B'_{x,s} $\n\n\u6211\u4eec\u77e5\u9053\n$$\nC'_{x,s} = \\sum_{i|j = s,p(i)+p(j) = x} A'_{p(i),i} B'_{p(j),j}\n$$\n\u89c2\u5bdf\u5230 $ C'_x = \\sum_{i=0}^x A'_{i}\\times_{or} B'_{x-i} $ \uff0c\u800c\u4e14\u9700\u8981\u6700\u540e\u53bb\u6389\u5de6\u8fb9\u7684 $ p(s) \\neq x $ \u7684\u60c5\u51b5\u3002\n\n\u8fd9\u6837\u590d\u6742\u5ea6 $ O(n^3 2^n) $\uff0c\u4e00\u5171\u8981\u5377 $ n^2 $ \u6b21\u3002 \n\n\u6ce8\u610f $ \\text{FMT} , \\text{IFMT} $ \u90fd\u6709\u53ef\u52a0\u6027\uff0c\u6240\u4ee5\u6211\u4eec\u628a\u90a3\u4e2a\u6216\u5377\u79ef\u5199\u6210 $ \\text{FMT} $ \u7684\u5f62\u5f0f\n$$\n\\begin{aligned}C'_{x} &= \\sum_i IFMT(FMT(A'_i) \u00b7 FMT(B'_{x-i}))\\\\&= IFMT( \\sum_i FMT(A_i') \u00b7 FMT(B_{x-i}') )\\end{aligned}\n$$\n\u6211\u4eec\u73b0\u5728\u53ea\u9700\u8981\u5904\u7406\u51fa\u6240\u6709 $ A'_i $ \u548c $ B'_{i} $ \u7684 FMT \uff0c\u6700\u540e\u518d\u8dd1 $ n $ \u6b21\u9006 FMT \uff0c\u6240\u4ee5\u8fd9\u6837\u505a\u5c31\u4f18\u5316\u5230\u4e86 $ O( 2^n n^2 ) $\n\n\u4e0d\u77e5\u9053\u4e3a\u5565 \u5f00O2 TLE \u4e86\u3002\u3002\u3002\u6ce8\u610f\u6a21\u6570\u662f $ 10^9+9 $ \u4e0d\u662f $ 10^9+7 $\u3002\u3002\u3002~~\u76ee\u5bb3\u4e86\u6210\u529fwa\u4e86\u4e24\u53d1~~\n\n```cpp\n#include \"iostream\"\n#include \"algorithm\"\n#include \"cstring\"\n#include \"cstdio\"\nusing namespace std;\n#define P 1000000009\nint rd( ) {\n    char ch = ' '; int ret = 0;\n    while( ch > '9' || ch < '0' ) ch = getchar();\n    while( ch >= '0' && ch <= '9' ) ret = ret * 10 + ch - '0' , ch = getchar();\n    return ret;\n}\n\nint A[1<<21] , B[1<<21] , n , len;\nint a[21][1<<21] , b[21][1<<21] , c[21][1<<21];\n\nvoid FMT( int A[] , int l ) {\n    for( int i = 0 ; i < l ; ++ i )\n        for( int j = 0 ; j < ( 1 << l ) ; ++ j )\n            if( j & ( 1 << i ) ) A[j] = ( A[j] + A[j ^ ( 1 << i )] ) % P;\n}\nvoid IFMT( int A[] , int l ) {\n    for( int i = 0 ; i < l ; ++ i )\n        for( int j = 0 ; j < ( 1 << l ) ; ++ j )\n            if( j & ( 1 << i ) ) A[j] = ( A[j] + P - A[j ^ ( 1 << i )] ) % P;\n}\n\nint main() {\n    cin >> n; len = ( 1 << n );\n    for( int i = 0 ; i < len ; ++ i ) A[i] = rd() , a[__builtin_popcount(i)][i] = A[i];\n    for( int i = 0 ; i < len ; ++ i ) B[i] = rd() , b[__builtin_popcount(i)][i] = B[i];\n    for( int i = 0 ; i <= n ; ++ i ) FMT( a[i] , n ) ,  FMT( b[i] , n );\n    for( int x = 0 ; x <= n ; ++ x ) {\n        for( int i = 0 ; i <= x ; ++ i )\n            for( int j = 0 ; j < ( 1 << n ) ; ++ j )\n                ( c[x][j] += 1ll * a[i][j] * b[x - i][j] % P ) %= P;\n        IFMT( c[x] , n );\n    }\n    for( int i = 0 ; i < len ; ++ i ) printf(\"%d \",c[__builtin_popcount(i)][i]);\n}\n```\n\n",
        "postTime": 1583032513,
        "uid": 63398,
        "name": "yijan",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P6097 \u3010\u3010\u6a21\u677f\u3011\u5b50\u96c6\u5377\u79ef\u3011"
    },
    {
        "content": "\u5b50\u96c6\u5377\u79ef\uff0c\u89e3\u51b3\u7684\u5c31\u662f\u8fd9\u6837\u7684\u95ee\u9898\uff1a\n\n$$h_S=\\sum\\limits_{L\\cup R=S,\\ L\\cap R=\\varnothing}f_Lg_R$$\n\n\u9996\u5148\u6709\u4e2a $O(3^n)$ \u7684\u66b4\u529b\u679a\u4e3e\u5b50\u96c6\u7684\u7b97\u6cd5\uff0c\u4f46\u8fd9\u663e\u7136\u4e0d\u662f\u6211\u4eec\u60f3\u8981\u7684\u3002\n\n\u8bbe $f(i,S)=\\sum\\limits_{T\\in S,\\ |T\n|=i} f(T)$\u3002\n\n\u90a3\u4e48\u521d\u59cb\u6761\u4ef6\u662f $f(|S|,S)=f(S)$\uff0c\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u786e\u5b9a\u7684 $i$\uff0c\u505a\u4e00\u6b21 FWT \u5373\u53ef\u5f97\u5230\u6240\u6709\u7684 $f(i,S)$\uff0c\u8fd9\u91cc\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n^22^n)$\uff0c\u56e0\u4e3a FWT \u7684\u590d\u6742\u5ea6\u662f $O(n2^n)$\u3002\n\n\u4e00\u4e2a\u5f88\u597d\u7684\u6027\u8d28\uff1a\n\n$$h(i,S)=\\sum\\limits_{j=0}^i f(j,S)g(i-j,S)$$\n\n\u8fd9\u662f\u56e0\u4e3a\uff1a\u6839\u636e FWT \u7684\u7406\u8bba\uff0c$h$ \u4e2d\u7684 $S$ \u9879\u5e94\u8be5\u6709 $f,g$ \u7684 $S$ \u9879\u76f8\u4e58\u5f97\u5230\uff0c\u800c\u5982\u679c $L\\cup R=S,\\ L\\cap R=\\varnothing$\uff0c\u5c31\u610f\u5473\u7740 $|L|+|R|=|S|$\u3002\n\n\u6700\u540e\u5bf9\u4e8e\u6240\u6709 $i$\uff0c\u628a $h(i,S)$ \u505a\u4e00\u6b21 IFWT\uff0c\u5c31\u5f97\u5230\u7684\u8981\u6c42\u7684 $h$ \u6570\u7ec4\u3002\n\n\u653e\u4e2a\u4e00\u5f00\u59cb\u5199\u7684\u4e0d\u5361\u5e38\u7684\u4ee3\u7801\uff0c\u8fd9\u4e2a\u662f **\u4e0d\u80fd** AC \u7684\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int MAXN=21,MAXM=1100010,P=1e9+9;\nint n,f[MAXN][MAXM],g[MAXN][MAXM],h[MAXN][MAXM];\nint bitcnt (int x) {\n\tint res=0;\n\twhile (x) {res++,x-=(x&(-x));}\n\treturn res;\n}\nvoid fwtor (int a[],int lim,int type) {\n\tfor (int i=1;i<lim;i<<=1) {\n\t\tfor (int j=0;j<lim;j+=(i<<1)) {\n\t\t\tfor (int k=0;k<i;k++) {\n\t\t\t\ta[j+k+i]=((a[j+k+i]+a[j+k]*type)%P+P)%P;\n\t\t\t}\n\t\t}\n\t}\n\treturn;\n}\nint main () {\n\tscanf(\"%d\",&n);\n\tfor (int i=0;i<(1<<n);i++) {scanf(\"%d\",&f[bitcnt(i)][i]);}\n\tfor (int i=0;i<(1<<n);i++) {scanf(\"%d\",&g[bitcnt(i)][i]);}\n\tfor (int i=0;i<=n;i++) {fwtor(f[i],1<<n,1),fwtor(g[i],1<<n,1);}\n\tfor (int i=0;i<=n;i++) {\n\t\tfor (int j=0;j+i<=n;j++) {\n\t\t\tfor (int s=0;s<(1<<n);s++) {\n\t\t\t\th[i+j][s]=(h[i+j][s]+(1ll*f[i][s]*g[j][s])%P)%P;\n\t\t\t}\n\t\t}\n\t} \n\tfor (int i=0;i<=n;i++) {fwtor(h[i],1<<n,-1);}\n\tfor (int i=0;i<(1<<n)-1;i++) {printf(\"%d \",h[bitcnt(i)][i]);}\n\tprintf(\"%d\\n\",h[n][(1<<n)-1]);\n\treturn 0;\n}\n```\n",
        "postTime": 1581684249,
        "uid": 113546,
        "name": "ix35",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P6097 \u3010\u3010\u6a21\u677f\u3011\u5b50\u96c6\u5377\u79ef\u3011"
    },
    {
        "content": "Update: \u4ee3\u7801\u6302\u4e86\uff0c\u4fee\u590d\u4e00\u4e0b\u3002\n\nUpdate: \u4fee\u6539\u4e86 FWT \u548c FMT \u7684\u540d\u79f0\u95ee\u9898\u3002\n\n\u96c6\u5408\u5e42\u7ea7\u6570\uff0c\u662f\u4e00\u79cd\u5173\u4e8e\u96c6\u5408\u7684\u5f62\u5f0f\u5e42\u7ea7\u6570\u3002\u7ea6\u5b9a $S=\\{1,2,\\cdots,n\\}$ \u4e3a\u5168\u96c6\uff0c\u8bbe $\\mathbb{F}$ \u4e3a\u4e00\u4e2a\u57df\uff0c\u5219\u79f0 $f:2^S\\mapsto\\mathbb{F}$ \u4e3a $\\mathbb{F}$ \u4e0a\u7684\u4e00\u4e2a\u96c6\u5408\u5e42\u7ea7\u6570\uff0c$f$ \u53ef\u4ee5\u8bb0\u4f5c $f=\\sum_{T\\in 2^S}f_Tx^T$\uff0c\u8fd9\u91cc\u7684 $f_T$ \u5373\u8fd9\u4e2a\u96c6\u5408\u5e42\u7ea7\u6570\u7684\u7b2c $T$ \u9879\u7cfb\u6570\u3002\u7528\u4e0d\u592a\u4e25\u8c28\u7684\u8bdd\u8bf4\uff0c\u96c6\u5408\u5e42\u7ea7\u6570\u5c31\u662f\u4e00\u4e2a\u5f62\u5f0f\u5e42\u7ea7\u6570\uff0c\u4e00\u822c\u7684\u5f62\u5f0f\u5e42\u7ea7\u6570\u90fd\u662f\u4ee5\u4e00\u4e2a\u6574\u6570\u4e3a\u4e0b\u6807\uff0c\u800c\u96c6\u5408\u5e42\u7ea7\u6570\u4ee5\u4e00\u4e2a\u96c6\u5408\u4e3a\u4e0b\u6807\uff0c\u8fd9\u4e2a\u96c6\u5408\u5176\u5b9e\u53ef\u4ee5\u5bf9\u5e94\u5230\u4e8c\u8fdb\u5236\u4e2d\uff0c\u56e0\u6b64\u96c6\u5408\u5e42\u7ea7\u6570\u4e5f\u53ef\u4ee5\u5199\u6210\u4e00\u822c\u7684\u5f62\u5f0f\u5e42\u7ea7\u6570\u7684\u5f62\u5f0f\uff0c\u5bf9\u96c6\u5408\u5e42\u7ea7\u6570\u4e0b\u6807\uff08\u96c6\u5408\uff09\u8fdb\u884c\u7684\u8fd0\u7b97\u53ef\u4ee5\u770b\u6210\u5bf9\u5f62\u5f0f\u5e42\u7ea7\u6570\u4e0b\u6807\uff08\u6574\u6570\uff09\u7684\u4f4d\u8fd0\u7b97\u3002\n\n\u800c\u672c\u9898\u6c42\u7684\u5b50\u96c6\u5377\u79ef\u5176\u5b9e\u5c31\u662f\u5bf9\u7ed9\u5b9a\u7684\u4e24\u4e2a\u96c6\u5408\u5e42\u7ea7\u6570 $f$ \u548c $g$ \u6c42\u4e0d\u76f8\u4ea4\u96c6\u5408\u5e76\u5377\u79ef\u7684\u8fc7\u7a0b\uff0c\u5373\u6c42 $h_S=\\sum_{T_1\\cup T_2=S\\land T_1\\cap T_2=\\varnothing}f_{T_1}g_{T_2}$\uff0c\u5c06\u96c6\u5408\u4e0b\u6807\u8f6c\u6362\u4e3a\u6574\u6570\u4e0b\u6807\uff0c\u5176\u5b9e\u5c31\u662f\u9898\u9762\u4e0a\u7684 $h_k=\\sum_{i|j=k \\land i\\&j=0}f_{i}g_{j}$ \uff0c\u5b9a\u4e49 $\\mathtt{popcount(x)}$ \u4e3a $\\mathtt x$ \u4e8c\u8fdb\u5236\u4e0b 1 \u7684\u4e2a\u6570\uff0c\u6211\u4eec\u4e0d\u96be\u77e5\u9053\uff0c\u6ee1\u8db3 $T_1\\cup T_2=S\\land T_1\\cap T_2=\\varnothing$ \u7684\u96c6\u5408 $T_1$ \u548c $T_2$ \u5bf9\u5e94\u7684\u4e0b\u6807 $i$ \u548c $j$ \u6ee1\u8db3 $i|j=k\\land\\mathtt{popcount(}i\\mathtt)+\\mathtt{popcount(}j\\mathtt)=\\mathtt{popcount(}k\\mathtt)$ \u3002\n\n\u5bf9\u4e8e\u524d\u4e00\u4e2a\u6761\u4ef6\u6211\u4eec\u7528 FWT OR \u5377\u79ef\u6216 FMT OR \u5377\u79ef\u89e3\u51b3\uff0c\u540e\u4e00\u4e2a\u6761\u4ef6\u6211\u4eec\u7528\u5360\u4f4d\u591a\u9879\u5f0f\u89e3\u51b3\u3002\n\n**FWT OR \u5377\u79ef**\n\n\u8fd9\u4e2a\u95ee\u9898\u7684\u6a21\u677f\u9898\u662f [\u3010\u6a21\u677f\u3011\u5feb\u901f\u83ab\u6bd4\u4e4c\u65af/\u6c83\u5c14\u4ec0\u53d8\u6362 (FMT/FWT)](https://www.luogu.com.cn/problem/P4717) \u3002\u5176\u5b9e FWT \u7c7b\u4f3c FFT\uff0c\u4e5f\u6709\u8f6c\u79fb\u77e9\u9635\uff0c\u5bf9\u4e8e FWT OR \u7684\u8f6c\u79fb\u77e9\u9635\uff0c\u5176\u5b9e\u5c31\u662f\u505a\u4e86\u4e00\u4e2a\u524d\u7f00\u548c\uff1a\n\n$$A=\\begin{bmatrix}\n1 & 0 & 0 & \\cdots & 0 \\\\\n1 & 1 & 0 & \\cdots & 0 \\\\\n1 & 1 & 1 & \\cdots & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n1 & 1 & 1 & \\cdots & 1\n\\end{bmatrix}$$\n\n\u800c FWT OR \u7684\u9006\u53d8\u6362\u662f\u5dee\u5206\u3002\u7531\u8fd9\u4e2a\u8f6c\u79fb\u77e9\u9635\u6211\u4eec\u53ef\u4ee5\u5199\u51fa FWT OR \u5377\u79ef\u7684\u4ee3\u7801\uff1a\n\n```cpp\nvoid FWTOR(int limit,int *arr,int sign){\n  for(int l=2;l<=limit;l<<=1)\n    for(int cx=0;cx<limit;cx+=l)\n      for(int cy=0;cy<(l>>1);++cy)\n        arr[cx+cy+(l>>1)]=(arr[cx+cy+(l>>1)]+arr[cx+cy]*sign+mod)%mod;\n}\n```\n\n\u4e0a\u9762\u4ee3\u7801\u4e2d `FWTOR` \u7684 `sign` \u4e3a 1 \u65f6\u505a\u7684\u662f FWT OR \u7684\u53d8\u6362\uff0c\u4e3a -1 \u65f6\u505a\u7684\u662f FWT OR \u7684\u9006\u53d8\u6362\uff0c\u5373\u4e3a 1 \u65f6\u505a\u524d\u7f00\u548c\uff0c\u4e3a -1 \u65f6\u505a\u5dee\u5206\u3002\n\n**\u5360\u4f4d\u591a\u9879\u5f0f**\n\n\u5360\u4f4d\u591a\u9879\u5f0f\u5c31\u662f\u4e3a\u4e86\u9002\u5e94\u5b50\u96c6\u5377\u79ef\u7684 $\\mathtt{popcount(}i\\mathtt)+\\mathtt{popcount(}j\\mathtt)=\\mathtt{popcount(}k\\mathtt)$ \u7684\u6761\u4ef6\u800c\u4ea7\u751f\u7684\u3002\u96c6\u5408\u5e42\u7ea7\u6570 $f$ \u7684\u5360\u4f4d\u591a\u9879\u5f0f\u5b9a\u4e49\u5982\u4e0b\uff1a\n\n$$f_{i,j}=\\begin{cases}1,&\\mathtt{popcount(}j\\mathtt)=i\\\\0,&\\mathtt{popcount(}j\\mathtt)\\ne i,\\end{cases}$$\n\n\u53ea\u8981\u6211\u4eec\u8ba9\u6ee1\u8db3 $\\mathtt{popcount(}i\\mathtt)+\\mathtt{popcount(}j\\mathtt)=\\mathtt{popcount(}k\\mathtt)$ \u7684\u591a\u9879\u5f0f\u8fdb\u884c OR \u5377\u79ef\u5c31\u597d\u5566\u3002\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\nfor(int cx=0;cx<=n;++cx)\n    FWTOR(lim,f[cx],1),FWTOR(lim,g[cx],1);\nfor(int cx=0;cx<=n;++cx)\n  for(int cy=0;cx+cy<=n;++cy)\n    for(int p=0,bt=cx+cy;p<lim;++p)\n      c[bt][p]=(c[bt][p]+1LL*f[cx][p]*g[cy][p]%mod)%mod;\nfor(int cx=0;cx<=n;++cx)\n  FWTOR(lim,c[cx],-1);\n```\n\n\u7136\u540e\u636e\u8bf4\u8fd9\u9898\u5361\u5e38\uff0c\u6211\u7684\u7a0b\u5e8f\u8dd1\u5f97\u6700\u6162\u7684\u70b9\u5dee\u4e0d\u591a\u6709 2.0 s\uff0c\u52c9\u5f3a\u80fd\u8fc7\uff0c\u5927\u5bb6\u6ce8\u610f\u4e00\u4e0b\u4ee3\u7801\u5b9e\u73b0\u6709\u4ec0\u4e48\u4f18\u5316\u7684\u5730\u65b9\uff0c\u5c3d\u91cf\u5361\u5361\u5e38\uff0c\u4fdd\u8bc1\u6b63\u786e\u7684\u60c5\u51b5\u4e0b\u80fd\u5c11\u53d6\u6a21\u5c31\u5c11\u53d6\u6a21\u3002\u4e0b\u9762\u662f\u6211\u7684\u5168\u90e8\u4ee3\u7801\uff1a\n\n```cpp\n#include <stdio.h>\n#include <algorithm>\n#define qaq inline\n#define alqaq __attribute__((always_inline)) inline\nusing ll=long long;\nconst ll mod=1e9+9;\nconst int sz=(1<<21|1);\nint lim,n,f[21][sz],g[21][sz],c[21][sz];\nalqaq int popcount(int x){\n  return __builtin_popcount(x);\n}\nqaq void FWTOR(int limit,int *arr,int sign){\n  for(int l=2;l<=limit;l<<=1)\n    for(int cx=0;cx<limit;cx+=l)\n      for(int cy=0;cy<(l>>1);++cy)\n        arr[cx+cy+(l>>1)]=(arr[cx+cy+(l>>1)]+arr[cx+cy]*sign+mod)%mod;\n}\nint main(){\n  scanf(\"%d\",&n);\n  lim=(1<<n);\n  for(int cx=0;cx<lim;++cx)\n    scanf(\"%d\",&f[popcount(cx)][cx]);\n  for(int cx=0;cx<lim;++cx)\n    scanf(\"%d\",&g[popcount(cx)][cx]);\n  for(int cx=0;cx<=n;++cx)\n    FWTOR(lim,f[cx],1),FWTOR(lim,g[cx],1);\n  for(int cx=0;cx<=n;++cx)\n    for(int cy=0;cx+cy<=n;++cy)\n      for(int p=0,bt=cx+cy;p<lim;++p)\n        c[bt][p]=(c[bt][p]+1LL*f[cx][p]*g[cy][p]%mod)%mod;\n  for(int cx=0;cx<=n;++cx)\n    FWTOR(lim,c[cx],-1);\n  for(int cx=0;cx<lim;++cx)\n    printf(\"%d \",c[popcount(cx)][cx]);\n  return 0;\n}\n```",
        "postTime": 1643338572,
        "uid": 496840,
        "name": "SAMSHAWCRAFT",
        "ccfLevel": 0,
        "title": "\u3010\u6a21\u677f\u3011\u5b50\u96c6\u5377\u79ef - \u9898\u89e3"
    },
    {
        "content": "\u840c\u65b0\u7531\u4e8e\u592a\u5f31\u88ab\u5361\u4e86\u5e38\u3002~~\u90a3\u4e00\u5b9a\u662fFMT\u81ea\u8eab\u5e38\u6570\u592a\u5927\u4e86~~\n\n_____\n\n\u5982\u679c\u4e0d\u4f1a FMT \u53ef\u4ee5\u79fb\u6b65\u8c37\u8c37\u7684\u677f\u5b50\u9898\u6216\u8005[\u6211\u7684\u535a\u5ba2](https://www.orchidany.cn/2019/08/26/fmt/)\n\n\u5feb\u901f\u5b50\u96c6\u53d8\u6362(FST)\u662f\u5728 FMT \u57fa\u7840\u4e0a\u7684\u6269\u5c55\uff0c\u89e3\u51b3\u7684\u4e5f\u662f\u5b50\u96c6\u4ea4\u5377\u79ef\uff0c\u4f46\u662f\u9650\u5236\u4e86\u72b6\u6001\u4e0d\u91cd\u590d\uff0c\u5373\n\n$$c_i=\\sum_{\\begin{aligned}~k &\\cup j=i\\\\ k &\\cap j= \\emptyset \\end{aligned}}a_kb_j$$\n\n\u6362\u4e2a\u5199\u6cd5\uff1a\n\n$$\nc_s=\\sum_{t\\subseteq s}a_sb_{s-t}\n$$\n\n\u8fd9\u4e1c\u897f\u5176\u5b9e\u4e5f\u4e0d\u662f\u975e\u8981\u7528 FMT \u6765\u505a\uff0cFWT \u4e5f\u53ef\u4ee5\u3002\n\n\u7136\u540e\u5c31\u662f\u8003\u8651\u5728\u5377\u79ef\u7684\u65f6\u5019\u591a\u589e\u52a0\u4e00\u7ef4\uff0c\u5373 $f_{i,S}$ \u8868\u793a\u96c6\u5408 $S$ \u4e2d\u6709 $i$ \u4e2a\u5143\u7d20\uff0c\u4e8e\u662f\u53d1\u73b0\u53ea\u6709\u5f53\u5143\u7d20\u4e2a\u6570\u76f8\u52a0\u7b26\u5408\u65f6\u624d\u662f\u5bf9\u7684\u3002\n\n\u4e8e\u662f\u4e00\u5f00\u59cb\u5c06 $f_{bct(s),s}$ \u8d4b\u503c\u4e3a $f_s$\uff0c\u5176\u4e2d $bct(s)=\\rm bitcount(s)$\u3002\u7136\u540e\u5bf9\u6bcf\u4e00\u4e2a $f_i$ \u5206\u522b\u505a FMT\uff0c\u4e4b\u540e\u6309\u4f4d\u4e58\u7684\u65f6\u5019\u9700\u8981\n\n$$P_{i, S}=\\sum_{i=0}^{i} f_{j, S} \\times g_{i-j, S}$$\n\n\u8f93\u51fa\u7684\u65f6\u5019\u53ea\u8f93\u51fa $P_{bct(s),s}$ \u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6\u4f3c\u4e4e\u662f\u4e24\u4e2a $\\log$ \u7684\uff1f\u7136\u800c\u5e76\u4e0d\u6ee1\u3002\u63a8\u8350\u53d6\u6a21\u4f18\u5316\u3002\n\n\n```cpp\n#define MAXN 21\n#define MAXM 2000010\n#define Mod 1000000009\n\n#define I inline\n#define LL long long\n\nusing namespace std;\nint bc[MAXM];\nint N, M;\nint A[MAXN][MAXM], B[MAXN][MAXM], C[MAXN][MAXM];\n\nI int read() {\n    int x = 0, f = 1;\n    char ch = getchar();\n    while (ch < '0' || ch > '9') {\n        if (ch == '-')\n            f = -1;\n        ch = getchar();\n    }\n    while (ch >= '0' && ch <= '9') {\n        x = x * 10 + ch - '0';\n        ch = getchar();\n    }\n    return x * f;\n}\nI void reduce(int &x) { x += x >> 31 & Mod; }\nI void Ifmt(int *f) {\n    register int i, j;\n    for (i = 0; i < N; ++i)\n        for (j = 0; j <= M; ++j)\n            if (j >> i & 1)\n                reduce(f[j] -= f[j ^ 1 << i]);\n}\nI void fmt(int *f) {\n    register int i, j;\n    for (i = 0; i < N; ++i)\n        for (j = 0; j <= M; ++j)\n            if (j >> i & 1)\n                reduce(f[j] += f[j ^ 1 << i] - Mod);\n}\nint main() {\n    cin >> N;\n    M = (1 << N) - 1;\n    register int i, j, s;\n    for (i = 1; i <= M; ++i) bc[i] = bc[i - (i & -i)] + 1;\n    for (i = 0; i <= M; ++i) A[bc[i]][i] = read();\n    for (i = 0; i <= M; ++i) B[bc[i]][i] = read();\n    for (i = 0; i <= N; ++i) fmt(A[i]), fmt(B[i]);\n    for (i = 0; i <= N; ++i)\n        for (j = 0; j <= i; ++j)\n            for (s = 0; s <= M; ++s) (C[i][s] += 1ll * A[j][s] * B[i - j][s] % Mod) %= Mod;\n    for (i = 0; i <= N; ++i) Ifmt(C[i]);\n    for (i = 0; i <= M; ++i) printf(\"%d \", C[bc[i]][i]);\n}\n\n```\n",
        "postTime": 1581675877,
        "uid": 28313,
        "name": "\u768e\u6708\u534a\u6d12\u82b1",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P6097 \u3010\u3010\u6a21\u677f\u3011\u5b50\u96c6\u5377\u79ef\u3011"
    },
    {
        "content": "\u89c4\u5b9a\uff08\u90fd\u662f\u6b63\u5e38\u7684\u89c4\u5b9a\uff0c\u53ef\u4ee5\u8df3\u8fc7\uff09\uff1a\n\n\u7528\u4e8c\u8fdb\u5236\u6570 $k$ \u6765\u8868\u793a\u4e00\u4e2a\u96c6\u5408\uff0c\u67d0\u4e00\u4f4d\u4e3a\u4e00\u8868\u793a\u6709\uff0c\u96f6\u8868\u793a\u6ca1\u6709\uff0c$|k|$ \u8868\u793a\u96c6\u5408 $k$ \u7684\u5927\u5c0f\uff0c\u5373\u4e8c\u8fdb\u5236\u8868\u793a\u4e0b $1$ \u7684\u4e2a\u6570\uff0c$x|y$ \u8868\u793a\u96c6\u5408 $x$ \u548c $y$ \u7684\u5e76\u96c6\uff0c\u5373\u6309\u4f4d\u6216\uff0c$x\\&y$ \u8868\u793a\u96c6\u5408 $x$ \u548c $y$ \u7684\u4ea4\u96c6\uff0c\u5373\u6309\u4f4d\u4e0e\uff0c$x\\otimes y$ \u4e3a\u96c6\u5408 $x$ \u548c $y$ \u7684\u5bf9\u79f0\u5dee\uff0c\u5373\u6309\u4f4d\u5f02\u6216\u3002\n\n\u5b50\u96c6\u5377\u79ef\u662f\u4e00\u4e2a\u5c0f\u6e05\u65b0\u7684\u79d1\u6280\uff0c\u53ef\u4ee5\u89e3\u51b3\u4e00\u7c7b\u72b6\u6001\u538b\u7f29\u52a8\u6001\u89c4\u5212\u7684\u95ee\u9898\uff0c\u53ef\u4ee5\u62bd\u8c61\u6210 $h_k=\\sum\\limits_{i\\&k=k}f_kg_{i\\otimes k}$\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u66b4\u529b\u8ba1\u7b97\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(3^n)$\uff0c\u53ef\u4ee5\u901a\u8fc7 $n\\le18$ \u7684\u6570\u636e\uff0c\u672c\u9898\u6070\u597d\u4e0d\u80fd\u901a\u8fc7\uff0c\u6240\u4ee5\u9700\u8981\u8fdb\u884c\u4f18\u5316\u3002\n\n\u8003\u8651\u5c06\u5b50\u96c6\u5927\u5c0f\u76f8\u540c\u7684\u653e\u5728\u4e00\u8d77\uff0c\u4e8e\u662f\u6709 $h_k=\\sum\\limits_{|i|+|j|=|k|,i|j=k}f_ig_j$\u3002\n\n\u53ea\u9700\u8981\u5c06 $f$ \u548c $g$ \u6309\u7167 \u96c6\u5408\u5927\u5c0f\u5212\u5206\u4e3a $n$ \u4e2a\u6570\u7ec4\uff0c\u6216\u8fd0\u7b97\u5377\u79ef\u5957\u4e0a\u66b4\u529b\u52a0\u6cd5\u5377\u79ef\u5373\u53ef\uff0c\u6216\u8fd0\u7b97\u5377\u79ef\u9700\u8981\u4f7f\u7528\u5feb\u901f\u6c83\u5c14\u4ec0\u53d8\u6362\u4f18\u5316\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^22^n)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $O(n2^n)$\uff0c\u6ce8\u610f**\u4e0d\u5f00** `long long`\uff0c\u5728\u8fd0\u7b97\u65f6\u5f3a\u8f6c\u6765\u4f18\u5316\u7a7a\u95f4\u5e38\u6570\u3002\n\n\u5b9e\u9645\u4e0a\u4e0d\u5f00 O2 \u6700\u6162\u70b9\u4e5f\u53ea\u6709 1.82s\uff0c\u4e00\u70b9\u4e5f\u4e0d\u5361\u5e38\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nconst int N=(1<<20)+20,M=1e9+9;\ninline void File(){\n#ifndef ONLINE_JUDGE\n\tfreopen(\"a.in\",\"r\",stdin);\n\tfreopen(\"a.out\",\"w\",stdout);\n#endif\n}\nnamespace fast_rd{\n\tconst int R=1e5+5;\n\tchar buf[R+5],c;\n\tint it,ed,f;\n#define gc (it==ed&&(ed=(it=0)+fread(buf,1,R,stdin),it==ed)?EOF:buf[it++])\n\ttemplate<typename _Tp>\n\tinline void read(_Tp &x){\n\t\tfor(f=0,c=gc;c<48;c=gc)if(c=='-')f=!f;\n\t\tfor(x=0;c>47;x=x*10+(48^c),c=gc);if(f)x=-x;\n\t}\n\ttemplate<typename _Tp,typename..._tps>\n\tinline void read(_Tp &x,_tps&...y){\n\t\tread(x),read(y...);\n\t}\n};\nusing fast_rd::read;\ninline ll qp(ll a,ll x=M-2){\n\tll res=1;for(;x;x>>=1,a=a*a%M)\n\t\tif(x&1)res=res*a%M;return res;\n}\nint k,n,f[22][N],g[22][N],pct[N],h[22][N];\nsigned main(){\n\tFile();\n\tread(k),n=1<<k;int i,j,ln,md,r,p;\n\tfor(i=1;i<n;++i)pct[i]=pct[i>>1]+(i&1);\n\tfor(i=0;i<n;++i)read(f[pct[i]][i]);\n\tfor(i=0;i<n;++i)read(g[pct[i]][i]);\n\tfor(md=1,r=2;md<n;md<<=1,r<<=1)\n\t\tfor(ln=0;ln<n;ln+=r)\n\t\t\tfor(i=0;i<md;++i)\n\t\t\t\tfor(p=0;p<=k;++p){\n\t\t\t\t\tif((f[p][ln|md|i]+=f[p][ln|i])>=M)f[p][ln|md|i]-=M;\n\t\t\t\t\tif((g[p][ln|md|i]+=g[p][ln|i])>=M)g[p][ln|md|i]-=M;\n\t\t\t\t}\n\tfor(i=0;i<=k;++i)\n\t\tfor(j=k-i;~j;--j)\n\t\t\tfor(p=0;p<n;++p)\n\t\t\t\th[i+j][p]=(ll(f[i][p])*g[j][p]+h[i+j][p])%M;\n\tfor(md=1,r=2;md<n;md<<=1,r<<=1)\n\t\tfor(ln=0;ln<n;ln+=r)\n\t\t\tfor(i=0;i<md;++i)\n\t\t\t\tfor(p=0;p<=k;++p)\n\t\t\t\t\tif((h[p][ln|md|i]-=h[p][ln|i])<0)h[p][ln|md|i]+=M;\n\tfor(i=0;i<n;++i)\n\t\tprintf(\"%d \",h[pct[i]][i]);\n\treturn 0;\n}\n```",
        "postTime": 1659439335,
        "uid": 502410,
        "name": "EnofTaiPeople",
        "ccfLevel": 0,
        "title": "\u5c0f\u6e05\u65b0\u5b50\u96c6\u5377\u79ef"
    },
    {
        "content": "\u524d\u7f6e\u77e5\u8bc6\uff1aFMTor \u548c IFMTor\u3002\n\u4ee4\uff1a\n$$A(i,S)=[|S|=i]a_S$$\n$$B(i,S)=[|S|=i]b_S$$\n$$C(i,S)=\\sum_{L\\cup R=S}[|L|+|R|=i]a_Lb_R$$\n\n\u6709\uff1a\n$$A(|S|,S)=a_S$$\n$$B(|S|,S)=b_S$$\n$$C(|S|,S)=\\sum_{L\\cup R=S}[|L|+|R|=|S|]a_Lb_R=c_S$$\n\n\u4ee4\uff1a\n$$A'(i,S)=\\sum_{I\\subset S}A(i,S)$$\n$$B'(i,S)=\\sum_{I\\subset S}B(i,S)$$\n$$C'(i,S)=\\sum_{I\\subset S}C(i,S)$$\n\u6c42 $A'$\uff0c$B'$ \u53ef\u4ee5\u76f4\u63a5 FMT\uff0c\u7136\u540e\u6211\u4eec\u53ea\u8981\u6c42\u51fa $C'$\uff0c\u518d\u505a IFMT \u5c31\u53ef\u4ee5\u5f97\u5230 $C$\uff0c\u7136\u540e\u5f97\u5230\u7b54\u6848\uff0cFMT \u548c IFMT \u505a $n+1$ \u6b21\u90fd\u662f $O(n^22^n)$ \u7684\u3002\n\n\u4e8b\u5b9e\u4e0a\u6709\uff1a\n$$\\begin{aligned}C'(i,S) & = \\sum_{I\\subset S}\\sum_{L\\cup R=I}[|L|+|R|=i]a_Lb_R \\\\ & = \\sum_{|L|+|R|=i}[L\\subset S][R\\subset S]a_Lb_R \\\\ & = \\sum_{k=0}^{i}\\left(\\sum_{L\\subset S}[|L|=k]a_L\\right)\\left(\\sum_{R\\subset S}[|R|=i-k]b_R\\right)\\\\ & = \\sum_{k=0}^{i}A'(k,S)B'(i-k,S)\\end{aligned}$$\n\u8fd9\u90e8\u5206\u4e5f\u53ef\u4ee5 $O(n^22^n)$ \u6c42\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u89e3\u51b3\u4e86\u8fd9\u9053\u9898\u3002\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int mod = 1000000009;\nint n, A[21][1<<20], B[21][1<<20], C[21][1<<20];\nvoid FMT(int a[])\n{\n   for(int i = 0; i < n; ++i)\n      for(int j = 0; j < (1<<n); ++j)\n         if((j>>i)&1)\n            a[j] = (a[j]+a[j^(1<<i)])%mod;\n}\nvoid IFMT(int a[])\n{\n   for(int i = 0; i < n; ++i)\n      for(int j = 0; j < (1<<n); ++j)\n         if((j>>i)&1)\n            a[j] = (a[j]-a[j^(1<<i)])%mod;\n}\nint main()\n{\n   ios::sync_with_stdio(0);\n   cin >> n;\n   for(int i = 0; i < (1<<n); ++i)\n      cin >> A[__builtin_popcount(i)][i];\n   for(int i = 0; i < (1<<n); ++i)\n      cin >> B[__builtin_popcount(i)][i];\n   for(int i = 0; i <= n; ++i)\n   {\n      FMT(A[i]); FMT(B[i]);\n   }\n   for(int i = 0; i <= n; ++i)\n      for(int k = 0; k <= i; ++k)\n         for(int S = 0; S < (1<<n); ++S)\n            C[i][S] = (C[i][S]+1ll*A[k][S]*B[i-k][S]%mod)%mod;\n   for(int i = 0; i <= n; ++i)\n      IFMT(C[i]);\n   for(int i = 0; i < (1<<n); ++i)\n      cout << (C[__builtin_popcount(i)][i]+mod)%mod << ' ';\n   cout << '\\n';\n   return 0;\n}\n```",
        "postTime": 1675479131,
        "uid": 404961,
        "name": "baiABC",
        "ccfLevel": 6,
        "title": "\u5b50\u96c6\u5377\u79ef P6097"
    },
    {
        "content": "### \u524d\u7f6e\u77e5\u8bc6\n\n- FWT/FMT\n\n- \u4f4d\u8fd0\u7b97\n\n### \u601d\u8def\n\n\u9898\u76ee\u4e2d\u6240\u6c42\u7684\u662f\uff1a\n\n$$C_{i}=\\sum_{j\\&k=0\\land j\\mid k=i}a_jb_k$$\n\n\u9996\u5148\u770b\u7b2c\u4e00\u4e2a\u6761\u4ef6\uff1a\n\n$$j|k=i$$\n\n\u5f88\u663e\u7136\u7684\u53ef\u4ee5\u7528 $\\text{FMT}$ \u6c42\u89e3\u51fa\u6765\uff0c\u4e5f\u5c31\u662f:\n\n$$C_i=\\sum_{j|k=i}a_jb_k$$\n\n\u5f53\u7136\u8fd9\u662f\u4e00\u4e2a\u5927\u7684\u8303\u56f4\uff0c\u6211\u4eec\u63a5\u4e0b\u6765\u8981\u6ee1\u8db3\u7b2c\u4e8c\u4e2a\u6761\u4ef6\uff1a\n\n$$j\\&k=0$$\n\n\u53ef\u4ee5\u628a\u6761\u4ef6\u8f6c\u6362\u4e00\u4e0b\uff1a\n\n$$|j|+|k|=|j\\mid k|$$\n\n\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u518d\u5f00\u4e00\u4f4d\u6570\u7ec4\uff0c\u6765\u50a8\u5b58\u6bcf\u4e00\u4e2a\u6570\u7684 $1$ \u7684\u6570\u91cf\uff1a\n\n$$f_{i,j}=\\begin{cases} a_j \\ \\ (i=|j|)\\\\  \\\\ 0\\end{cases}$$\n\n\u7136\u540e $\\text{FWT}$ \u4e00\u904d\u521d\u59cb\u7684 $a_{i,j},b_{i,j}$ \u6570\u7ec4\uff0c\u7528\u4e0b\u5217\u5f62\u5f0f\u5377\u8d77\u6765\uff0c\u5c31\u662f\u7b54\u6848\n\n$$C_{i,k}=\\sum_{i=0}^{len}\\sum_{j=0}^i\\ a_{j,k}b_{i-j,k}$$\n\n\u6700\u540e\u7684 $C_{|i|,i}$ \u5373\u4e3a\u7b2c $i$ \u4f4d\u7684\u7b54\u6848\u3002\n\n### \u4ee3\u7801\u5b9e\u73b0\uff08\u5927\u5e38\u6570\uff09\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<stack>\n#include<algorithm>\nusing namespace std;\nconst int N=1<<21|1;\nconst int mod=1e9+9;\nint a[22][N],b[22][N];\nint n;\nint c[22][N];\nint read()\n{\n\tint f=1,x=0;\n\tchar s=getchar();\n\twhile(s<'0'||s>'9'){if(s=='-')f=-1;s=getchar();}\n\twhile(s>='0'&&s<='9'){x=(x<<1)+(x<<3)+(s^'0');s=getchar();}\n\treturn f*x;\n} \nint lowbit(int x)\n{\n\treturn x&(-x);\n}\nint get(int x)\n{\n\tint cnt=0;\n\twhile(x)\n\t{\n\t\tx-=lowbit(x);\n\t\tcnt++;\n\t}\n\treturn cnt;\n}\nvoid FWT(int *f,int term,int x)\n{\n\tfor(int mid=1;(mid<<1)<=term;mid<<=1)\n\t{\n\t\tint R=mid<<1;\n\t\tfor(int j=0;j<term;j+=R)\n\t\t\tfor(int k=0;k<mid;k++)\n\t\t\t\tf[j+k+mid]=(f[j+k+mid]+1ll*f[j+k]*x%mod+mod)%mod;\n\t}\n}\nint len;\nvoid Juan()\n{\n\tfor(int i=0;i<=len;i++)\n\t\tfor(int j=0;j<=i;j++)\n\t\t\tfor(int k=0;k<n;k++)\n\t\t\t\tc[i][k]=1ll*(1ll*c[i][k]+1ll*a[j][k]*b[i-j][k]%mod)%mod; \n}\nint main()\n{\n\tn=read();\n\tlen=n;\n\tn=1ll<<n;\n\tfor(int i=0;i<n;i++)\n\t\ta[get(i)][i]=read();\n\tfor(int i=0;i<n;i++)\n\t\tb[get(i)][i]=read();\n\tfor(int i=0;i<=len;i++)\n\t{\n\t\tFWT(a[i],n,1);\n\t\tFWT(b[i],n,1);\n\t}\n\tJuan();\n\tfor(int i=0;i<=len;i++)\n\t\tFWT(c[i],n,-1); \n\tfor(int i=0;i<n;i++)\n\t\tprintf(\"%d \",c[get(i)][i]);\n\treturn 0;\n}\n```\n\n\n\n\n",
        "postTime": 1627643652,
        "uid": 230804,
        "name": "Durancer",
        "ccfLevel": 4,
        "title": "\u3010\u9898\u89e3\u3011P6097 \u3010\u6a21\u677f\u3011\u5b50\u96c6\u5377\u79ef"
    },
    {
        "content": "upd 2023/3/16\uff1a\u66f4\u6539\u4e86\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u9519\u8bef\u3002\n\n---\n\n~~\u5176\u5b9e\u662f\u66b4\u529b\u3002~~\n\n\u56e0\u4e3a\u8fd9\u662f\u6a21\u677f\u9898\uff0c\u6240\u4ee5\u6a21\u677f\u7684\u524d\u7f6e\u77e5\u8bc6\u4e5f\u8981\u8bb2\u3002\n\n- \u524d\u7f6e\u77e5\u8bc6\uff1aFWT \u8ba1\u7b97\u6216\u5377\u79ef\u3002\n\n\u8fd9\u91cc\u53ea\u9700\u8981\u638c\u63e1\u5feb\u901f\u8ba1\u7b97\u6216\u5377\u79ef\u7684\u65b9\u6cd5\uff0c\u6240\u4ee5\u5185\u5bb9\u8f83\u5c11\u3002\u5982\u679c\u5411\u4e86\u89e3\u66f4\u591a\uff08\u6bd4\u5982\u5f02\u6216\u5377\u79ef\uff09\u7684\u8bdd\u53ef\u4ee5\u53bb [P4717](https://www.luogu.com.cn/problem/P4717) \u770b\u770b\u3002\n\n> \u4f8b\u9898\uff1a\u7ed9\u5b9a\u957f\u5ea6\u4e3a $2^n$ \u7684\u5e8f\u5217 $a,b$\uff0c\u6c42 $c_k=\\sum\\limits_{i|j=k}a_ib_j$ \u5e8f\u5217\u4e2d\u6bcf\u4e00\u9879\u7684\u503c\u3002\u6211\u4eec\u9700\u8981\u4e00\u4e2a $O(n2^n)$ \u7684\u89e3\u6cd5\u3002\n\n\u8003\u8651\u6839\u636e $a,b$ \u6784\u9020\u4e24\u4e2a\u5e8f\u5217 $A,B$\uff0c\u82e5 $a\\to A,b\\to B$ \u5747\u4e3a $O(n2^n)$ \u5e76\u4e14\u8fd9\u4e2a\u8fc7\u7a0b\u53ef\u9006\uff0c\u4ee4 $C_i=A_i\\times B_i$\uff0c\u82e5 $C$ \u80fd\u8fd8\u539f\u56de $c$\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5 $O(n2^n)$ \u8ba1\u7b97 $c$\u3002\n\n\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u4ee4 $A_i=\\sum\\limits_{j|i=i}a_j$\uff08\u4e5f\u5c31\u662f $j$ \u4e3a $i$ \u7684\u5b50\u96c6\uff09\u3002\u90a3\u4e48\u6709 $C_i=\\sum\\limits_{(j|k)|i=i}a_jb_k$\u3002\n\n\u90a3\u4e48\u6709\uff1a\n\n$$\\begin{aligned}A_i\\times B_i&=\\left(\\sum\\limits_{j|i=i}a_j\\right)\\left(\\sum\\limits_{j|i=i}b_j\\right)\\\\&=\\sum\\limits_{j|i=i,k|i=i}a_jb_k\\\\&=\\sum\\limits_{(j|k)|i=i}a_jb_k\\\\&=C_i\\end{aligned}$$\n\n\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u8bc1\u660e\u4e86\u8fd9\u4e2a $A,B$ \u662f\u7684\u786e\u80fd\u6620\u5c04\u5230\u4e00\u4e2a\u6b63\u786e\u7684 $C$ \u7684\u3002\u73b0\u5728\u8003\u8651\u5982\u4f55\u5feb\u901f\u6c42 $A_i=\\sum\\limits_{j|i}a_j$\u3002\n\n\u663e\u7136\u53ef\u4ee5\u4ece\u4f4e\u5230\u9ad8\u679a\u4e3e\u6bcf\u4e2a\u4e8c\u8fdb\u5236\u4f4d\uff0c\u7136\u540e\u5f53\u524d\u4f4d\u4e3a $0$ \u7684\u662f\u53f3\u8fb9\u5bf9\u5e94\u4f4d\u7f6e\u4e3a $1$ \u7684\u5b50\u96c6\uff0c\u4ece\u5de6\u4f9d\u6b21\u8d21\u732e\u5230\u53f3\u5373\u53ef\u3002\n\n$C\\to c$ \u76f8\u5f53\u4e8e\u6c42\u4e00\u4e2a\u9006\u8fc7\u7a0b\uff0c\u53f3\u8fb9\u4f9d\u6b21\u51cf\u53bb\u5de6\u8fb9\u7684\u8d21\u732e\u5373\u53ef\u3002\n\n\u53c2\u8003\u4e86[\u8fd9\u91cc](https://www.luogu.com.cn/blog/xht37/solution-p4717)\u7684\u4ee3\u7801\u3002\n\n```cpp\nvoid fwt(int *s, int op) {\n\top = (op + mod) % mod;\n\tfor (int o = 2, k = 1; o <= S + 1; o <<= 1, k <<= 1) \n\t\tfor (int i = 0; i <= S; i += o)\n\t\t\tfor (int j = 0; j < k; j++)\n\t\t\t\t(s[i + j + k] += 1ll * s[i + j] * op % mod) %= mod;\n}\n```\n\n- \u56de\u5230\u539f\u9898\n\n\u4f60\u53d1\u73b0\u8fd9\u4e1c\u897f\u5c31\u591a\u52a0\u4e86\u4e00\u4e2a\u9650\u5236 $i\\&j=0$\uff0c\u4e5f\u5c31\u662f\u8bf4 $i,j$ \u65e0\u4ea4\u3002\n\n\u8003\u8651\u4e00\u4e2a\u5145\u8981\u6761\u4ef6\uff0c$i\\&j=0$ \u5e76\u4e14 $i|j=k$ \u5176\u5b9e\u5c31\u76f8\u5f53\u4e8e $|i|+|j|=|k|$ \u5e76\u4e14 $i|j=k$\uff0c$|i|$ \u8868\u793a $i$ \u96c6\u5408\u7684\u5927\u5c0f\uff0c\u5373 $i$ \u4e2d $1$ \u7684\u4e2a\u6570\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u9884\u5904\u7406 $f_{i,j}$ \u8868\u793a\u6ee1\u8db3 $|j|=i$ \u7684 $a_j$ \u7684\u503c\uff0c$g_{i,j}$ \u5bf9 $b$ \u540c\u7406\u3002\n\n\u90a3\u4e48 $c_{k}=\\sum\\limits_{i=0}^n\\sum\\limits_{j=0}^{2^n-1}\\sum\\limits_{j|l=k}f_{i,j}g_{k-i,l}$\u3002\n\n\u4ee4 $h_{i}=\\sum\\limits_{k=0}^nf_{k}*g_{i-k}$\uff0c$*$ \u8868\u793a\u8fdb\u884c\u6216\u5377\u79ef\uff0c\u90a3\u4e48 $c_i=h_{|i|,i}$\u3002\n\nFWT \u9884\u5904\u7406\u6bcf\u4e2a $f_k$ \u548c $g_k$ \u7684\u5b50\u96c6\u548c\uff0c\u679a\u4e3e\u8fd9\u4e2a $i,k$ \u6c42\u51fa $h$ \u7684\u5b50\u96c6\u548c\uff0c\u7136\u540e\u505a\u9006\u7684 FWT \u5c31\u505a\u5b8c\u4e86\u3002\u590d\u6742\u5ea6 $O(n^22^n)$\u3002\n\n```cpp\nconst int maxs = (1 << 20) + 100;\nconst int mod = 1e9 + 9;\nint n, S, a[maxs], b[maxs], c[21][maxs], f[21][maxs], g[21][maxs];\nint p[maxs];\n\nvoid fwt(int *s, int op) {\n\top = (op + mod) % mod;\n\tfor (int o = 2, k = 1; o <= S + 1; o <<= 1, k <<= 1) \n\t\tfor (int i = 0; i <= S; i += o)\n\t\t\tfor (int j = 0; j < k; j++)\n\t\t\t\t(s[i + j + k] += 1ll * s[i + j] * op % mod) %= mod;\n}\n\nint main() {\n\tn = read(), S = (1 << n) - 1;\n\tfor (int i = 1; i <= S; i++) p[i] = p[i >> 1] + (i & 1);\n    for (int i = 0; i <= S; i++) f[p[i]][i] = read();\n    for (int i = 0; i <= S; i++) g[p[i]][i] = read();\n\tfor (int i = 0; i <= n; i++) fwt(f[i], 1), fwt(g[i], 1);\n\tfor (int i = 0; i <= n; i++)\n\t\tfor (int j = 0; j <= i; j++)\n\t\t\tfor (int k = 0; k <= S; k++)\n\t\t\t\t(c[i][k] += 1ll * f[j][k] * g[i - j][k] % mod) %= mod;\n\tfor (int i = 0; i <= n; i++) fwt(c[i], -1);\n\tfor (int i = 0; i <= S; i++) write(c[p[i]][i]), pc(' ');\n\treturn 0;\n}\n```",
        "postTime": 1676969306,
        "uid": 306573,
        "name": "Ender32k",
        "ccfLevel": 0,
        "title": "P6097 \u3010\u6a21\u677f\u3011\u5b50\u96c6\u5377\u79ef"
    },
    {
        "content": "- [\u524d\u7f6e\u77e5\u8bc6](https://www.luogu.com.cn/blog/luo1gu1zui1bang1/gao-wei-qian-zhui-hu)\u3002\n- [\u8fd8\u662f\u524d\u7f6e\u77e5\u8bc6](https://www.luogu.com.cn/blog/luo1gu1zui1bang1/mei-hao-di-xi-ri)\u3002\n\n**\u9898\u610f**\n- [\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/P6097)\u3002\n- \u5b9a\u4e49\u5dee\u96c6\uff1a\n$$P-Q=\\{a|a\\in P,a\\notin Q\\}$$\n- \u6709\u4e24\u4e2a\u96c6\u5408 $U$ \u7684\u5b50\u96c6\u5230\u5b9e\u6570\u7684\u5355\u5c04 $a,b$\uff0c\u5b9a\u4e49\u5355\u5c04 $c$ \u4e3a\uff1a\n$$c(S)=\\sum_{P\\subseteq S}a(P)b(S-P)$$\n- \u6c42\u5355\u5c04 $c$\u3002\n- \u66b4\u529b\u7684\u5b9e\u73b0\u4ecd\u7136\u662f $O(3^{|U|})$ \u7684\u3002\n- ~~\u6211\u5c06\u5e26\u5934\u715e\u7b14\uff0c\u5c14\u7b49\u7d27\u968f\u5176\u540e~~\u4f5c\u8005\u4e0b\u9762\u5c06\u7ed9\u51fa\u4e00\u4e2a\u9519\u8bef\u7684\u793a\u8303\uff1a\n- [\u94fe\u63a5](https://www.luogu.com.cn/paste/klxpy16k)\uff0c\u4e0d\u4f5c\u6b63\u6587\u5185\u5bb9\u9632\u6b62\u8bef\u5bfc\u4ed6\u4eba\uff0c\u4f46\u5e0c\u671b\u5927\u5bb6\u77e5\u9053\u4e3a\u4ec0\u4e48\u9700\u8981\u6b63\u89e3\u8fd9\u6837\u7684\u8f6c\u6362\u3002\n- \u4e0d\u8fc7\u8fd8\u597d\u54b1\u4eec\u53ef\u4ee5\u628a\u4ea4\u96c6\u8fd0\u7b97\u7ed9\u53bb\u6389\uff0c\u6839\u636e\u5bb9\u65a5\u539f\u7406\uff0c\u5982\u679c\u4e24\u4e2a\u96c6\u5408 $P,Q$ \u6ee1\u8db3 $P\\cup Q=S$ \u4e14 $|P|+|Q|=|S|$ \u90a3\u4e48\u5c31\u53ef\u4ee5\u65ad\u5b9a\u4e24\u4e2a\u96c6\u5408\u6ca1\u6709\u4ea4\u3002\n- \u5b9a\u4e49 $h(S,k)$\uff1a\n$$c'(S)=\\sum_{P\\subseteq S,|P|=k}a(P)b(S-P)$$\n- \u5bb9\u6613\u5f97\u5230\uff1a\n$$c(S)=\\sum_{i=0}^{|S|}h(S,i)$$\n- \u7ee7\u7eed\u63a8\u5bfc\uff1a\n$$c'(S,k)=\\sum_{P,Q}[|P|=k][|Q|=|S|-k]\\sum_{R\\subseteq S}(-1)^{|S|-|R|}[P\\subseteq R]a(P)b(Q)$$\n$$c'(S,k)=\\sum_{R\\subseteq S}(-1)^{|S|-|R|}\\sum_{P\\subseteq R}[|P|=k]a(P)\\sum_{Q\\subseteq R}[|Q|=|S|-k]b(Q)$$\n- \u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u5b9a\u4e49\uff1a\n$$a'(S,k)=\\sum_{P\\subseteq S}[|P|=k]a(P)$$\n$$b'(S,k)=\\sum_{P\\subseteq S}[|P|=k]b(P)$$\n- \u5c31\u53ef\u4ee5\u5b8c\u6210\u5168\u90e8\u7684\u8ba1\u7b97\u4e86\u3002\n- \u5229\u7528\u9ad8\u7ef4\u524d\u7f00\u548c\u7684\u5b9e\u73b0\u590d\u6742\u5ea6\u662f $O(|U|^22^{|U|})$ \u7684\u3002\n- [\u4ee3\u7801\u5b9e\u73b0](https://www.luogu.com.cn/paste/fy3d2e8v)\u3002\n- \u5b9e\u73b0\u5730\u5f88\u987a\u5229\uff0c\u4f3c\u4e4e\u5e76\u4e0d\u5361\u5e38\u3002",
        "postTime": 1644140821,
        "uid": 260884,
        "name": "WeLikeStudying",
        "ccfLevel": 0,
        "title": "\u3010\u4ee3\u6570\u3011\u5b50\u96c6\u5377\u79ef"
    }
]
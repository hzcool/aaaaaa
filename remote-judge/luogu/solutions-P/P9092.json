[
    {
        "content": "\u663e\u7136\u6709\u4e00\u4e2a\u590d\u6742\u5ea6\u7684\u6570\u4f4d dp \u66b4\u529b\uff0c\u76f4\u63a5 $2^9$ \u4fdd\u5b58\u6bcf\u4e2a\u6570\u5b57\u662f\u5426\u51fa\u73b0\u8fc7\uff0c\u7136\u540e\u4fdd\u5b58\u6570 $x \\bmod i(2\\le i\\le 9)$ \u7684\u503c\uff0c\u4e0d\u4ec5\u65f6\u95f4\u7206\u70b8\uff0c\u7a7a\u95f4\u4e5f\u7206\u70b8\u3002\n\n\u8003\u8651\u5982\u4f55\u538b\u7f29\u72b6\u6001\uff0c\u53ea\u8981\u72b6\u6001\u538b\u4e0b\u53bb\u4e86\uff0c\u90a3\u4e48\u8fd9\u4e2a\u9898\u4e5f\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u9996\u5148\u8003\u8651\u5982\u4f55\u538b\u7f29\u4fdd\u5b58\u53d6\u6a21\u540e\u7684\u4fe1\u606f\u3002\u601d\u8003\u4e00\u4e0b\uff0c\u5982\u679c\u77e5\u9053 $x\\bmod 4$ \u7684\u503c\uff0c\u90a3\u662f\u4e0d\u662f\u5c31\u77e5\u9053\u4e86 $x\\bmod 2$ \u7684\u503c\uff0c\u540c\u7406\uff0c\u5982\u679c\u77e5\u9053\u4e86 $x\\bmod 8$ \u7684\u503c\uff0c\u5c31\u53ef\u4ee5\u77e5\u9053 $x\\bmod 4$ \u6216\u8005 $x\\bmod 2$ \u7684\u503c\uff0c\u4e8e\u662f\u5224\u65ad $2|x,4|x,8|x$ \u53ea\u9700\u8981\u4fdd\u5b58 $x\\bmod 8$ \u7684\u503c\u5c31\u884c\u3002\u90a3\u4e48\u6309\u7167\u4e0a\u9762\u8fd9\u4e2a\u60f3\u6cd5\uff0c\u628a $3,9$ \u5206\u6210\u4e00\u7ec4\uff0c\u53ea\u4fdd\u5b58 $x\\bmod 9$ \u7684\u4fe1\u606f\u3002\u90a3\u4e48\u5269\u4e0b\u7684\u66b4\u529b\u4fdd\u5b58\u5373\u53ef\uff1f\u5176\u5b9e\u8fd8\u53ef\u4ee5\u4f18\u5316\u4e00\u4e0b\uff0c$6=2\\times 3$\uff0c\u5224\u65ad\u4e00\u4e2a\u6570\u662f\u5426\u6ee1\u8db3 $6|x$\uff0c\u53ea\u9700\u8981\u5224\u65ad $2|x$\uff0c$3|x$ \u5373\u53ef\uff0c\u4e8e\u662f\u4e0d\u9700\u8981\u4fdd\u5b58 $x\\bmod 6$ \u7684\u503c\u3002$5|x$ \u5c31\u53ea\u9700\u8981\u5224\u65ad\u6700\u4f4e\u4f4d\u662f\u4e0d\u662f $5$ \u5c31\u884c\uff0c\u4e0d\u9700\u4fdd\u5b58 $x\\bmod 5$ \u7684\u503c\u3002\u90a3\u4e48\u81f3\u6b64\u53ea\u9700\u8981\u4fdd\u5b58 $x\\bmod 7$\uff0c$x\\bmod 8$\uff0c$x\\bmod 9$ \u7684\u503c\u3002\n\n\u7136\u540e\u6765\u8003\u8651\u5982\u4f55\u538b\u7f29\u6bcf\u4e2a\u6570\u5b57\u662f\u5426\u51fa\u73b0\u8fc7\u7684\u4fe1\u606f\uff0c\u6a21\u4eff\u4e0a\u9762\u7684\u60f3\u6cd5\uff0c\u628a $2,4,8$ \u5206\u6210\u4e00\u7ec4\uff0c$3,9$ \u5206\u6210\u4e00\u7ec4\uff0c$5,6,7$ \u5404\u81ea\u5206\u6210\u4e00\u7ec4\uff0c\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u5206\u5462\uff1f\u56e0\u4e3a\u5982\u679c $4$ \u51fa\u73b0\u4e86\uff0c\u90a3\u4e48 $2$ \u5c31\u7b97\u51fa\u73b0\u4e86\u4e5f\u5c31\u6ca1\u7528\u4e86\uff0c\u56e0\u4e3a $4|x$ \u8fd9\u4e2a\u6761\u4ef6\u6ee1\u8db3\u4e86\u90a3\u4e48\u663e\u7136\u6ee1\u8db3 $2|x$\uff0c\u4e8e\u662f\u8fd9\u91cc\u5c31\u88ab\u538b\u7f29\u5230\u4e86 $4\\times 3\\times 2^3=96$\u3002\n\n\u90a3\u4e48\u63a5\u4e0b\u6765\u5c31\u5f88\u7b80\u5355\u4e86\uff0c\u4ece\u9ad8\u4f4d\u5230\u4f4e\u4f4d\u6216\u8005\u4ece\u4f4e\u4f4d\u5230\u9ad8\u4f4d\u505a\u6570\u4f4d dp \u5c31\u884c\u3002\n\n\u4f5c\u8005\u5b9e\u73b0\u7684\u662f\u4ece\u4f4e\u5230\u9ad8\u7684\u5199\u6cd5\uff0c\u590d\u6742\u5ea6 $\\mathcal{O}(L\\times 96\\times 7\\times 8\\times 9\\times 9)=\\mathcal{O}(435456L)$\u3002\u770b\u4e0a\u53bb\u5f88\u5927\uff0c\u5b9e\u9645\u4e0a\u6839\u672c\u8dd1\u4e0d\u6ee1\u3002\n\n\u6781\u9650\u6570\u636e 120ms\uff0c\u53bb LOJ \u770b\u4e86\u770b\uff0c\u53d1\u73b0 std \u8dd1\u5f97\u975e\u5e38\u6162\uff0c\u603b\u7528\u65f6 33000ms\uff0c\u8fd9\u4e2a\u505a\u6cd5\u603b\u7528\u65f6\u53ea\u6709 5300ms\u3002\n\n```cpp\n#include <cstdio>\n#include <map>\n#include <iostream>\n#include <set>\n#include <algorithm>\n#include <unordered_map>\n#include <bitset>\n#include <queue>\n#include <stack>\n#include <random>\n#include <cstring>\n#include <ctime>\n#include <cmath>\n#include <assert.h> \nusing namespace std;\n#define LL long long\n#define pp pair<int,int>\n#define mp make_pair \n#define ull unsigned long long\nnamespace IO{\n    const int sz=1<<22;\n    char a[sz+5],b[sz+5],*p1=a,*p2=a,*t=b,p[105];\n    inline char gc(){\n\t\treturn getchar();\n   //     return p1==p2?(p2=(p1=a)+fread(a,1,sz,stdin),p1==p2?EOF:*p1++):*p1++;\n    }\n    template<class T> void gi(T& x){\n        x=0; int f=1;char c=gc();\n        if(c=='-')f=-1;\n        for(;c<'0'||c>'9';c=gc())if(c=='-')f=-1;\n        for(;c>='0'&&c<='9';c=gc())\n            x=x*10+(c-'0');\n        x=x*f;\n    }\n    inline void flush(){fwrite(b,1,t-b,stdout),t=b; }\n    inline void pc(char x){*t++=x; if(t-b==sz) flush(); }\n    template<class T> void pi(T x,char c='\\n'){\n        if(x<0)pc('-'),x=-x;\n        if(x==0) pc('0'); int t=0;\n        for(;x;x/=10) p[++t]=x%10+'0';\n        for(;t;--t) pc(p[t]); pc(c);\n    }\n    struct F{~F(){flush();}}f; \n}\nusing IO::gi;\nusing IO::pi;\nusing IO::pc;\nusing IO::gc;\nconst int mod=998244353;\nconst int inv2=(mod+1)>>1;\ninline int add(int x,int y){\n\treturn x+y>=mod?x+y-mod:x+y;\n}\ninline int dec(int x,int y){\n\treturn x-y<0?x-y+mod:x-y;\n}\ninline int qkpow(int a,int b){\n\tint ans=1,base=a;\n\twhile(b){\n\t\tif(b&1)ans=1ll*ans*base%mod;\n\t\tbase=1ll*base*base%mod;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\nint fac[1000005],inv[1000005],Invn[1000005];\ninline int binom(int n,LL m){\n\tif(n<m||m<0)return 0;\n\treturn 1ll*fac[n]*inv[m]%mod*inv[n-m]%mod;\n}\nvoid init_C(int N){\n\tfac[0]=1;\n\tfor(int i=1;i<=N;i++)fac[i]=1ll*fac[i-1]*i%mod; \n\tinv[0]=1;\n\tinv[N]=qkpow(fac[N],mod-2);\n\tfor(int i=N-1;i>=1;i--)inv[i]=1ll*inv[i+1]*(i+1)%mod;\n\tInvn[0]=Invn[1]=1;\n\tfor(int i=2;i<=N;i++)Invn[i]=1ll*inv[i]*fac[i-1]%mod;\n}      \nint trans[100][10],a[19];\nLL l,r,dp[2][19][100][7][8][9][2];\nmap<string,int>H;\nstring sta[100];\nint cnt;\ninline int getid(string S){\n\tif(!H[S]){\n\t\tH[S]=++cnt;\n\t\tsta[cnt]=S;\n\t}\n\treturn H[S];\n}\ninline void dfs(int x){\n\tif(x==6){\n\t\tstring S;\n\t\tfor(int i=1;i<=5;i++)S+=(a[i]+'0');\n\t\ttrans[getid(S)][1]=getid(S);\n\t\tfor(int x=2;x<=9;x++){\n\t\t\tint num=0,pos=0;\n\t\t\tif(x==2)num=1,pos=1;\n\t\t\telse if(x==4)num=2,pos=1;\n\t\t\telse if(x==8)num=3,pos=1;\n\t\t\telse if(x==3)num=1,pos=2;\n\t\t\telse if(x==9)num=2,pos=2;\n\t\t\telse num=1,pos=x-2;\n\t\t\tstring S2;\n\t\t\tfor(int j=1;j<=5;j++){\n\t\t\t\tif(j==pos)S2+=(max(a[j],num)+'0');\n\t\t\t\telse S2+=(a[j]+'0');\n\t\t\t}\n\t\t\ttrans[getid(S)][x]=getid(S2);\n\t\t}\n\t\treturn ;\n\t}\n\tif(x==1){\n\t\tfor(int i=0;i<=3;i++){\n\t\t\ta[x]=i;\n\t\t\tdfs(x+1);\n\t\t}\n\t}else if(x==2){\n\t\tfor(int i=0;i<=2;i++){\n\t\t\ta[x]=i;\n\t\t\tdfs(x+1);\n\t\t}\n\t}else{\n\t\tfor(int i=0;i<=1;i++){\n\t\t\ta[x]=i;\n\t\t\tdfs(x+1);\n\t\t}\n\t}\n}\ninline LL solve(LL n){\n\tif(!n)return 0;\n\tLL x=n;\n\tint len=0;\n\twhile(x){\n\t\ta[++len]=x%10;\n\t\tx/=10;\n\t}\n\tmemset(dp,0,sizeof dp);\n\tfor(int x=1;x<=9;x++)\n\t\tdp[(x==5)][1][trans[1][x]][x%7][x%8][x%9][(x<=a[1])]=1;\n\tLL pw=10;\n\tfor(int i=1;i<len;i++){\n\t\tfor(int l1=0;l1<2;l1++){\n\t\t\tfor(int j=1;j<=96;j++){\n\t\t\t\tfor(int p1=0;p1<7;p1++){\n\t\t\t\t\tfor(int p2=0;p2<8;p2++){\n\t\t\t\t\t\tfor(int p3=0;p3<9;p3++){\n\t\t\t\t\t\t\tfor(int t=0;t<2;t++){\n\t\t\t\t\t\t\t\tif(dp[l1][i][j][p1][p2][p3][t]){\n\t\t\t\t\t\t\t\t\tLL v=dp[l1][i][j][p1][p2][p3][t];\n\t\t\t\t\t\t\t\t\tfor(int p=1;p<=9;p++){\n\t\t\t\t\t\t\t\t\t\tint nt=(p<a[i+1]||(t&&p==a[i+1]));\n\t\t\t\t\t\t\t\t\t\tint np1=((pw*p)%7+p1)%7,np2=((pw*p)%8+p2)%8,np3=((pw*p)%9+p3)%9;\n\t\t\t\t\t\t\t\t\t\tdp[l1][i+1][trans[j][p]][np1][np2][np3][nt]+=v;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tpw*=10ll;\n\t}\n\tLL ans=0;\n\tfor(int l1=0;l1<2;l1++){\n\t\tfor(int p1=0;p1<7;p1++){\n\t\t\tfor(int p2=0;p2<8;p2++){\n\t\t\t\tfor(int p3=0;p3<9;p3++){\n\t\t\t\t\tfor(int j=1;j<=96;j++){\n\t\t\t\t\t\tLL v=0;\n\t\t\t\t\t\tfor(int i=1;i<=len;i++){\n\t\t\t\t\t\t\tv+=dp[l1][i][j][p1][p2][p3][1];\n\t\t\t\t\t\t\tif(i!=len)v+=dp[l1][i][j][p1][p2][p3][0];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(v){\n\t\t\t\t\t\t\tbool f=1;\n\t\t\t\t\t\t\tfor(int p=0;p<5;p++){\n\t\t\t\t\t\t\t\tint num=sta[j][p]-'0';\n\t\t\t\t\t\t\t\tif(!num)continue;\n\t\t\t\t\t\t\t\tif(p==0){\n\t\t\t\t\t\t\t\t\tif(num==1&&p2%2!=0){\n\t\t\t\t\t\t\t\t\t\tf=0;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(num==2&&p2%4!=0){\n\t\t\t\t\t\t\t\t\t\tf=0;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(num==3&&p2%8!=0){\n\t\t\t\t\t\t\t\t\t\tf=0;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(p==1){\n\t\t\t\t\t\t\t\t\tif(num==1&&p3%3!=0){\n\t\t\t\t\t\t\t\t\t\tf=0;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(num==2&&p3%9!=0){\n\t\t\t\t\t\t\t\t\t\tf=0;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(p==2&&!l1){\n\t\t\t\t\t\t\t\t\tf=0;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(p==3&&((p2%2!=0)||(p3%3!=0))){\n\t\t\t\t\t\t\t\t\tf=0;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(p==4&&p1){\n\t\t\t\t\t\t\t\t\tf=0;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(f)ans+=v;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn ans;\n}\nsigned main(){\n\tgi(l),gi(r);\n\tdfs(1);\n\tpi(solve(r)-solve(l-1),'\\n');\n\treturn 0;\n}\n```",
        "postTime": 1677466283,
        "uid": 154560,
        "name": "Silver187",
        "ccfLevel": 7,
        "title": "[PA2020] Liczba Potyczkowa"
    },
    {
        "content": "\u663e\u7136\u7684\u6570\u4f4d $\\mathrm{dp}$\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4f4d\uff0c\u80af\u5b9a\u90fd\u662f $1\\sim 9$\uff0c\u6240\u4ee5\u4e00\u5b9a\u53ea\u6709 $9$ \u79cd\u9664\u6570\uff0c\u53ef\u4ee5\u8003\u8651\u4e00\u4e2a\u72b6\u6001\u538b\u7f29\u7684\u8fc7\u7a0b\uff0c\u8bb0\u5f55\u5f53\u524d\u72b6\u6001\u4e0b\u67d0\u4e00\u4e2a\u6570\u662f\u5426\u5b58\u5728\u8fc7\uff0c\u7136\u540e\u5728\u6700\u540e\u8fdb\u884c\u5224\u5b9a\uff0c\u4f46\u662f\u8fd9\u6837\u4e0b\u6765\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal O(9!2^{10}\\ln n)$\uff0c\u663e\u7136\u662f\u8fc7\u4e0d\u4e86\u7684\uff0c\u6240\u4ee5\u8003\u8651\u4e00\u70b9\u4f18\u5316\u3002\n\n\u5982\u679c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u9664\u6570\u90fd\u8bb0\u5f55\u4e00\u4e2a\u5176\u6a21\u6570\u663e\u7136\u662f\u8d58\u4f59\u7684\uff0c\u56e0\u4e3a\u5982\u679c\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u7684 $\\bmod 9$ \u4e0b\u7684\u4f59\u6570\uff0c\u90a3\u4e48 $\\bmod 3$ \u7684\u4f59\u6570\u663e\u7136\u662f\u4e5f\u77e5\u9053\u4e86\u7684\uff0c\u540c\u7406\uff0c$2,4,8$ \u4e5f\u5b58\u5728\u8fd9\u6837\u7684\u5173\u7cfb\u3002\u6240\u4ee5\uff0c\u5b9e\u9645\u4e0a\u6211\u4eec\u53ef\u4ee5\u4ec5\u4ec5\u901a\u8fc7\u8bb0\u5f55 $\\bmod \\operatorname{lcm}(1\\sim 9)=2520$ \u7684\u4f59\u6570\u5373\u53ef\u77e5\u9053\u6240\u6709\u7684\u6a21\u6570\u3002\u8fd9\u6837\u4e0b\u6765\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6\u53ef\u4ee5\u4f18\u5316\u5230 $\\mathcal O(2520\\times 2^8\\ln n)$\uff0c\u56e0\u4e3a $1$ \u662f\u6ca1\u6709\u5fc5\u8981\u72b6\u538b\u7684\u3002\n\n\u5f53\u7136\uff0c\u56e0\u4e3a $0$ \u53ea\u80fd\u51fa\u73b0\u5728\u524d\u5bfc\u90e8\u5206\uff0c\u6240\u4ee5\u8fd8\u9700\u8981\u52a0\u4e0a $limit$ \u548c\u5224 $0$ \u7684 $\\mathcal O(4)$ \u90e8\u5206\u3002\uff08\u5e38\u6570\u597d\u50cf\u4e0d\u80fd\u5199\u8fdb\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790\u91cc\uff0c\u4f46\u6211\u4e5f\u4e0d\u77e5\u9053\u600e\u4e48\u5199\u4e86\u554aQAQ\uff09\n\n\u552f\u4e00\u90a3\u7bc7\u9898\u89e3\u7684\u65b9\u6cd5\u597d\u5197\u957f\u554a\uff0c\u8fd9\u91cc\u7ed9\u51fa\u7b80\u77ed\u7684\u8bb0\u5fc6\u5316\u641c\u7d22\u5199\u6cd5\uff1a\n\n``` c++\nconst int MAXN=19,MAXS=1<<8|10,MAXNUM=2520;\nconst int Mod=2520;\nll Dp[MAXN][MAXS][MAXNUM][2][2];\nint Nums[20],Len;\nll ql,qr;\n//pos,state(2~9),mod 7,8,9\nint gcd(int a,int b)\n{ return !b?a:gcd(b,a%b); }\ninline int lcm(int a,int b)\n{ return a*b/gcd(a,b); }\nll dfs(int pos,int state,int mod,bool limit,bool _0)\n{\n\tif(!~pos)\n\t{\n\t\tint _lc=1;\n\t\tfor(int i=2;i<=9;++i) if(state>>(i-2)&1) _lc=lcm(_lc,i);\n\t\treturn mod%_lc==0;\n\t}\n\tif(~Dp[pos][state][mod][limit][_0]) return Dp[pos][state][mod][limit][_0];\n\tll ret=0;int st=_0?1:0,num=limit?Nums[pos]:9;\n\tfor(int i=st;i<=num;++i)\n\t{\n\t\tint nxd=(mod*10+i)%Mod,_st=state;\n\t\tif(i>1) _st|=1<<(i-2);\n\t\tret+=dfs(pos-1,_st,nxd,limit&(i==num),_0|(i>0));\n\t}\n\treturn Dp[pos][state][mod][limit][_0]=ret;\n}\ninline ll solve(ll x)\n{\n\tif(!x) return 0;\n\tstd::memset(Dp,-1,sizeof(Dp));\n\tll ret=0;\n\tfor(Len=0;x;x/=10) Nums[Len++]=x%10;\n\tret=dfs(Len-1,0,0,1,0);\n\treturn ret;\n}\nint main()\n{\n\t// freopen(\".in\",\"r\",stdin);\n\t// freopen(\".out\",\"w\",stdout);\n\tread(ql,qr);\n\tint delta=(ql==1);\n\twrite(solve(qr)-solve(ql-1)-delta);\n\treturn 0;\n}\n```",
        "postTime": 1677746104,
        "uid": 444040,
        "name": "_Eternal_",
        "ccfLevel": 0,
        "title": "P9092 [PA2020] Liczba Potyczkowa \u9898\u89e3"
    }
]
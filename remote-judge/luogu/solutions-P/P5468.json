[
    {
        "content": "\u8fd9\u9898\u5c31\u662f[\u8fd9\u9053\u9898](https://loj.ac/problem/6520)\u7684\u52a0\u5f3a\u7248\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u4e0d\u8003\u8651\u4f4d\u7f6e\u7684\u9650\u5236\uff0c\u53ea\u8003\u8651\u8fc7\u7a0b\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u8bbe $dp[i]$ \u8868\u793a\u5728\u65f6\u523b $i$ \u65f6\u7684\u6700\u5c0f\u70e6\u8e81\u503c\u51cf\u53bb $q_{s_k}$  \uff0c\u5219\u6709:\n\n\u5bf9\u4e8e\u4e00\u6761\u8def\u5f84 $(p_r,q_r)$(\u6211\u4eec\u6b64\u65f6\u4e0d\u8003\u8651 $x$ \u548c $y$ ):\n\n$$dp[q_r]=\\min_{j\\le p_r}dp[j]+A(p_r-j)^2+B(p_r-j)+C$$\n\n\u660e\u663e\u53ef\u4ee5\u5229\u7528\u659c\u7387\u4f18\u5316\u52a0\u901f\u8f6c\u79fb\u3002\n\n\u4f46\u662f\u95ee\u9898\u5728\u4e8e\u8def\u5f84\u662f\u4e00\u4e2a\u6301\u7eed\u6027\u7684\u8fc7\u7a0b\uff0c\u5373 $p_i$ \u548c $q_i$ \u4e4b\u95f4\u53ef\u80fd\u76f8\u8ddd\u5f88\u8fdc\u3002\u4e0d\u8fc7\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u5c06 $p_i$ \u548c $q_i$ \u62c6\u6210 **\u4e00\u6b21\u8be2\u95ee** \u548c **\u4e00\u6b21\u5c3e\u90e8\u63d2\u5165** \u4e24\u4e2a\u4e8b\u4ef6\uff0c\u8fd9\u6837\u4e8b\u4ef6\u5c31\u53ef\u4ee5\u901a\u8fc7\u6392\u5e8f\u53d8\u6210\u65f6\u95f4\u5355\u8c03\u9012\u589e\u7684\u4e86\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651 $x$ \u548c $y$ \uff0c\u4e5f\u5c31\u662f\u8d77\u70b9\u548c\u7ec8\u70b9\u3002\u4e0d\u8fc7\u8fd9\u53ef\u4ee5\u7528\u4e0a\u9762\u4e00\u6837\u7684\u65b9\u6cd5\u5904\u7406\uff0c\u4e5f\u5c31\u662f\u5c06\u8d77\u70b9\u548c\u7ec8\u70b9\u62c6\u6210\u4e24\u4e2a\u64cd\u4f5c\u3002\u6211\u4eec\u4f9d\u7136\u7ef4\u62a4\u5355\u8c03\u961f\u5217\uff0c\u4f46\u662f\u56e0\u4e3a\u6bcf\u4e2a\u4e8b\u4ef6\u5bf9\u5e94\u7684\u5730\u70b9\u6709\u533a\u522b\uff0c\u56e0\u6b64\u6211\u4eec\u5bf9\u6bcf\u4e2a\u70b9\u5f00\u4e00\u4e2a $vector$ \uff0c\u5206\u522b\u7ef4\u62a4\u5373\u53ef\u3002\n\n\u8bb0\u5f97\u5728 $1$ \u53f7\u70b9\u9884\u5148\u653e\u4e00\u4e2a $0$ \u65f6\u523b $0$ \u4ee3\u4ef7\u7684\u70b9\u4f5c\u4e3a\u8d77\u70b9\u3002\u7b54\u6848\u53ef\u4ee5\u5728\u8def\u5f84\u7ec8\u70b9\u662f $n$ \u7684\u65f6\u5019\u76f4\u63a5\u7edf\u8ba1\uff0c$n$ \u53f7\u70b9\u5c31\u6ca1\u5fc5\u8981\u518d\u5f00 $vector$ \u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u74f6\u9888\u5728\u6392\u5e8f\u4e0a\u3002\u56e0\u4e3a\u6570\u636e\u8303\u56f4\u7279\u522b\u5c0f\uff0c\u56e0\u6b64\u53ef\u4ee5\u76f4\u63a5\u91c7\u7528\u7edf\u6392\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(M+T)$\uff0c\u5176\u4e2d $T$ \u662f\u65f6\u95f4\u8303\u56f4\u7684\u6700\u5927\u503c\u3002\n\n\u4ee3\u7801\u5c31\u4e0d\u8d34\u4e86\u3002",
        "postTime": 1563260238,
        "uid": 7035,
        "name": "Great_Influence",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5468 \u3010[NOI2019]\u56de\u5bb6\u8def\u7ebf\u3011"
    },
    {
        "content": "[\u539f\u9898\u4f20\u9001\u95e8](https://www.luogu.org/problemnew/show/P5468)\n\n[\u66f4\u597d\u7684\u9605\u8bfb](https://www.cnblogs.com/yzhang-rp-inf/p/11198638.html)\n\n\u524d\u7f6e\u829d\u58eb\uff1a\u659c\u7387\u4f18\u5316 \u4e0d\u4f1a\u7684\u53ef\u4ee5\u53bb[\u675c\u795e\u535a\u5ba2](https://www.luogu.org/blog/top-oier/qian-tan-xie-shuai-you-hua)\u5b66\n\n\u8fd9\u9053\u9898\u6211\u8003\u573a\u4e0a\u53ea\u4f1a\u5dee\u70b9\u8dd1\u6700\u77ed\u8def\u768470pts\u505a\u6cd5\n\n\u540e\u6765\u56de\u5bb6\u540e\u53d1\u73b0\u9519\u8bef\u7684\u7206\u641c\u90fd\u80fd\u62ff\u6ee1\u5206\uff08\u5200\u7247\uff09\n\n\u8fd8\u6709\u5f88\u591a\u4eba$O(mt)$\u8fc7\u7684\uff0c~~\u8fd8\u662f\u8981\u575a\u6301\u5199\u6b63\u89e3\u597d\u4e0d\u597d~~\n\n\u6211\u4eec\u5148\u8003\u8651$O(mt)$\u7684\u66b4\u529bdp\uff0c\u5148\u4e0d\u8003\u8651\u603b\u65f6\u95f4\u5bf9\u70e6\u8e81\u503c\u7684\u5f71\u54cd\uff0c\u8bbe$dp[id]$\u8868\u793a\u8d70\u5b8c\u7b2c$id$\u6761\u8fb9\u6700\u5c0f\u7684\u4ee3\u4ef7\uff1a\n\n$$dp[id]=Min(dp[j]+A(p_{id}-q_j)^2+B(p_{id}-q_j)+C)(id,j \\in [1,m],q_j<=p_{id},v[j]=u[id])$$\n\n\u770b\u7740\u8fd9\u4e2a\u65b9\u7a0b\u6709\u5e73\u65b9\u9879\u8003\u8651\u5c55\u5f00\uff0c\u5c55\u5f00\u540e\u4f1a\u53d1\u73b0\u80fd\u8f6c\u5316\u6210\u659c\u7387\u4f18\u5316\u6807\u51c6\u5f62\u5f0f\n\n$$dp[j]+Aq_j^2-Bq_j=2Ap_iq_j-dp[i]-Ap_i^2-Bp_i-C$$\n\n\u5176\u4e2d$y=dp[j]+Aq_j^2-Bq_j,k=2Ap_i,x=q_j,b=-dp[i]-Ap_i^2-Bp_i-C$\n\n\u6bcf\u6761\u8fb9\u8fdb\u51fa\u4e00\u6b21\u961f\u5217\uff0c\u6240\u4ee5\u590d\u6742\u5ea6\u4e3a$O(m)$\n\n\u5b8c\u6574\u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define N 200005\n#define ll long long\n#define db double\n#define getchar nc\nusing namespace std;\ninline char nc(){\n    static char buf[100000],*p1=buf,*p2=buf;\n    return p1==p2&&(p2=(p1=buf)+fread(buf,1,100000,stdin),p1==p2)?EOF:*p1++;\n}\ninline int read()\n{\n    register int x=0,f=1;register char ch=getchar();\n    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n    while(ch>='0'&&ch<='9')x=(x<<3)+(x<<1)+ch-'0',ch=getchar();\n    return x*f;\n}\ninline void write(register ll x)\n{\n    if(!x)putchar('0');if(x<0)x=-x,putchar('-');\n    static int sta[20];register int tot=0;\n    while(x)sta[tot++]=x%10,x/=10;\n    while(tot)putchar(sta[--tot]+48);\n}\ninline int Max(register int a,register int b)\n{\n    return a>b?a:b;\n}\ninline ll Min(register ll a,register ll b)\n{\n    return a<b?a:b;\n}\nstruct node{\n    ll x,y;\n    int id;\n};\nint n,m,A,B,C,maxT=0;\nint x[N],y[N],p[N],q[N],head[N];\nll ans=1926081700000000ll,dp[N];\nvector<int> d[1005];\nvector<node>que[N];\nqueue<int> res[1005];\ninline db gslope(register node a,register node b)\n{\n    return 1.0*(a.y-b.y)/(1.0*(a.x-b.x));\n}\ninline void ins(register int id)\n{\n    int pos=y[id];\n    node now=(node){q[id],dp[id]+A*q[id]*q[id]-B*q[id],id};\n    while(que[pos].size()-head[pos]>=2)\n    {\n        int len=que[pos].size();\n        if(gslope(que[pos][len-1],que[pos][len-2])<gslope(que[pos][len-2],now))\n            break;\n        que[pos].pop_back();\n    }\n    que[pos].push_back(now);\n}\ninline void del(register db slpe,register int pos)\n{\n    while(que[pos].size()-head[pos]>=2)\n    {\n        if(gslope(que[pos][head[pos]],que[pos][head[pos]+1])>slpe)\n            return;\n        ++head[pos];\n    }\n}\nint main()\n{\n    n=read(),m=read(),A=read(),B=read(),C=read();\n    for(register int i=1;i<=m;++i)\n        x[i]=read(),y[i]=read(),p[i]=read(),q[i]=read(),maxT=Max(maxT,q[i]);\n    for(register int i=1;i<=m;++i)\n        d[p[i]].push_back(i);\n    que[1].push_back((node){0,0,0});\n    for(register int t=0;t<=maxT;++t)\n    {\n        while(!res[t].empty())\n            ins(res[t].front()),res[t].pop();\n        int len=d[t].size();\n        for(register int k=0;k<len;++k)\n        {\n            int id=d[t][k];\n            int pos=x[id];\n            if(que[pos].size()==head[pos])\n                continue;\n            db slpe=2.0*A*p[id];\n            del(slpe,pos);\n            int j=que[pos][head[pos]].id;\n            dp[id]=dp[j]+1ll*A*(p[id]-q[j])*(p[id]-q[j])+1ll*B*(p[id]-q[j])+C;\n            res[q[id]].push(id);\n            if(y[id]==n)\n                ans=Min(ans,dp[id]+q[id]);\n        }\n    }\n    write(ans);\n    return 0;\n}\n```\n",
        "postTime": 1563319815,
        "uid": 37881,
        "name": "yzhang",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5468 \u3010[NOI2019]\u56de\u5bb6\u8def\u7ebf\u3011"
    },
    {
        "content": "### ~~\u5f3a\u70c8\u8c34\u8d23\u51fa\u9898\u4eba\u7528\u811a\u9020\u6570\u636e~~\n\u6211\u5224\u65ad\u659c\u7387\u5927\u4e8e\u5c0f\u4e8e\u53f7\u6253\u53cd\u8fd8\u6012\u8fc7\u5927\u6837\u4f8b...\n\n\u5f3a\u884c\u641e\u4e86\u534a\u5929\u62c6\u70b9\uff0c\u6700\u540e\u8fde\u4e00\u5f00\u59cb\u968f\u624b\u5199\u7684\u66b4\u529b$spfa$\u90fd\u53ea\u8981\u6539\u4e00\u6539\u5c31\u80fd\u8fc7???\n\n\n------------\n\u6b63\u89e3\u5e94\u8be5\u8fd8\u662f\u987a\u5ef6\u4e86\u4e4b\u524d$spfa$\u6216\u8005\u66b4\u529b$dp$\u7684\u601d\u60f3\uff0c\u5bb9\u6613\u60f3\u5230**\u7528$dp[u][i]$\u8868\u793a\u5728$i$\u65f6\u523b\u5230\u8fbe$u$\u70b9\u65f6\u7684\u6700\u5c0f\u70e6\u8e81\u503c**(\u65e0\u6cd5\u5230\u8fbe\u8bbe\u4e3a\u65e0\u7a77\u5927)\uff0c\u8fd9\u6837\u6bcf\u4e00\u73ed\u8f66$(x,y,p,q)$\u90fd\u5bf9\u5e94\u4e86\u4e00\u4e2a\u8f6c\u79fb\uff1a\n\n$$dp[y][q]=\\mathop{min}\\limits_{0\\leq i\\leq p}(dp[x][i]+A(p-i)^2+B(p-i)+C)$$\n\n\u6700\u540e$ans=\\mathop{min}\\limits_{1\\leq i\\leq q_{max}}(dp[n][i]+i).$\n\n\u6211\u4eec\u770b\u5230\u8f6c\u79fb\u65b9\u7a0b\u53f3\u8fb9\u6709\u5e73\u65b9\u548c\u4e00\u5927\u5806\u4e58\u79ef\uff0c\u5bb9\u6613\u60f3\u5230\u53ef\u4ee5\u8bd5\u7740\u8003\u8651**\u659c\u7387\u4f18\u5316**\uff0c\u6211\u4eec\u5148**\u628a$min$\u548c$i\\leq p$\u7684\u9650\u5236\u53bb\u6389**\uff0c\u518d\u628a\u4e58\u79ef\u5c55\u5f00\uff1a\n\n\n$$\\begin{aligned}dp[y][q]&=dp[x][i]+A(p-i)^2+B(p-i)+C\\\\ dp[y][q]&=dp[x][i]+Ap^2-2Api+Ai^2+Bp-Bi+C\\end{aligned}$$\n\n\u5176\u4e2d$x,y,p,q$\u90fd\u662f\u5df2\u77e5\u786e\u5b9a\u7684\uff0c\u800c\u6211\u4eec\u8981\u4f7f$dp[y][q]$\u6700\u5c0f\uff0c\u4e8e\u662f\u53ef\u4ee5\u628a\u5b83\u653e\u5728\u622a\u8ddd\u91cc\uff0c\u518d\u628a$i$\u4f5c\u4e3a\u81ea\u53d8\u91cf\u8fdb\u884c\u659c\u7387\u4f18\u5316\u3002\u610f\u4f1a\u4e00\u4e0b\u5c31\u662f\u8fd9\u6837\uff1a\n\n$$\\mathop{\\underline{(dp[x][i]+Ai^2-Bi)}}\\limits_y =\\mathop{\\underline{(2Ap)}}\\limits_k\\mathop{\\underline{(i)}}\\limits_x+\\mathop{\\underline{(dp[y][q]-Ap^2-Bp-C)}}\\limits_b$$\n\n\u8fd9\u91cc\u6211\u4eec\u628a$(i,dp[x][i]+Ai^2-Bi)$\u89c6\u4e3a\u5e73\u9762\u4e0a\u7684\u4e00\u4e2a\u70b9\uff0c\u622a\u8ddd\u6700\u5c0f\u65f6\uff0c\u76f8\u5f53\u4e8e\u6709\u4e00\u6761\u659c\u7387\u4e3a$2Ap$\u7684\u76f4\u7ebf\u4ece\u5e73\u9762\u4e0b\u65b9\u65e0\u9650\u8fdc\u5904\u5f80\u4e0a\u8e66\uff0c\u649e\u5230\u7b2c\u4e00\u4e2a\u70b9\u65f6\u5f62\u6210\u7684\u8f6c\u79fb\u3002\u90a3\u4e48\u6211\u4eec\u5bf9\u6bcf\u4e2a$x$\u90fd\u7ef4\u62a4\u4e00\u4e2a\u4e0b\u51f8\u5305\uff0c\u5373**\u7ef4\u62a4$n$\u4e2a\u4e0b\u51f8\u5305**\u3002\u8f6c\u79fb\u65f6\u4e8c\u5206\u627e\u5230\u8f6c\u79fb\u70b9(\u5373\u7b2c\u4e00\u4e2a\u78b0\u5230\u7684\u70b9)\uff0c\u52a0\u70b9\u65f6\u540c\u4e00\u822c\u5957\u8def\uff0c\u5728\u6808\u9876\u5f39\u51fa\u5931\u53bb\u8d21\u732e\u7684\u70b9\u540e\u518d\u52a0\u70b9\u5373\u53ef\u3002\n\n\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u6211\u4eec\u53ea\u6ee1\u8db3\u4e86\u4e4b\u524d$min$\u7684\u9650\u5236\uff0c\u8fd8\u6ca1\u6709\u6ee1\u8db3$i\\leq p$\u7684\u9650\u5236\u3002\u6362\u800c\u8a00\u4e4b\uff0c\u76f4\u63a5\u505a\u7684\u8bdd\u51f8\u5305\u540e\u9762\u6709\u5f88\u591a\u4e0d\u6ee1\u8db3\u9650\u5236\u7684\u70b9\u88ab\u63d0\u524d\u52a0\u5165\u4e86\uff0c\u4e0d\u80fd\u591f\u8fdb\u884c\u8f6c\u79fb\u3002\n\n\u6211\u4eec\u8003\u8651\u679a\u4e3e\u56db\u5143\u7ec4$(x,y,p,q)$\u65f6\u7684\u5904\u7406\u65b9\u5f0f\uff0c\u5176\u5b9e\u662f\u5206\u6210\u4e86\u4e24\u4e2a\u64cd\u4f5c\uff1a**\u8ba1\u7b97\u5e76\u66f4\u65b0$dp[y][q]$\u7684\u503c\u3001\u52a0\u5165$(y,dp[y][q]+Aq^2-Bq)$\u8fd9\u4e2a\u70b9**\u3002\u663e\u7136\u8ba1\u7b97$dp[y][q]$\u65f6\u6211\u4eec\u8981\u505a\u5b8c\u6240\u6709$p$\u65f6\u523b\u4e4b\u524d\u7684\u7b54\u6848\uff0c\u5e76\u4e14$p$\u65f6\u523b\u4e4b\u540e\u7684\u7b54\u6848\u90fd\u662f\u65e0\u7528\u7684\u3002\u4e8e\u662f\u8003\u8651\u5c06\u8bfb\u5165\u7684\u56db\u5143\u7ec4\u6309$p$\u6392\u5e8f\uff0c\u6bcf\u6b21\u8ba1\u7b97\u5b8c\u7b54\u6848\u7684\u65f6\u5019\u4e0d\u7acb\u523b\u52a0\u5165\u70b9\uff0c\u800c\u662f\u6682\u5b58\u4e0b\u6765\u3002**\u5728\u679a\u4e3e\u5230$(x,y,p,q)$\u65f6\u6211\u4eec\u5148\u628a\u6682\u5b58\u4e0b\u6765\u7684$\\leq p$\u65f6\u523b\u7684\u70b9\u52a0\u5165\u5404\u81ea\u7684\u51f8\u5305\u4e2d\uff0c\u518d\u8ba1\u7b97$dp[y][q]$\uff0c\u7136\u540e\u6682\u5b58\u4e0b\u65b0\u4e00\u8f6e\u7684\u70b9**\u5373\u53ef\u89e3\u51b3\u95ee\u9898\u3002\n\n\u53e6\u5916\uff0c\u53ef\u4ee5\u53d1\u73b0\u6392\u5e8f\u540e\u76f4\u7ebf\u659c\u7387$2Ap$\u662f\u9012\u589e\u7684\uff0c\u6240\u4ee5\u8f6c\u79fb\u65f6\u53ef\u4ee5\u4e0d\u7528\u4e8c\u5206\uff0c\u76f4\u63a5\u4e0a\u5355\u8c03\u961f\u5217\u3002(\u7136\u9e45\u56e0\u4e3a\u8981\u6392\u5e8f\uff0c\u590d\u6742\u5ea6\u6ca1\u53d8\uff0c\u800c\u4e14\u6211\u5199\u7684$deque$\u6bd4\u4e8c\u5206\u4e0d\u77e5\u9053\u6162\u5230\u54ea\u91cc\u53bb\u4e86...)\n\n\u7b97\u4e00\u4e0b\u590d\u6742\u5ea6\uff1a\u6392\u5e8f$O(mlog_2n)$\uff0c\u6240\u6709\u51f8\u5305\u52a0\u8d77\u6765\u9876\u591a$m$\u4e2a\u70b9\uff0c\u6bcf\u4e2a\u70b9\u6700\u591a\u8fdb\u51fa\u51f8\u5305\u4e00\u6b21$O(m)$\uff0c\u53c8\u7531\u4e8e\u65f6\u523b$p,q\\leq 1000$\uff0c\u6240\u4ee5\u5355\u4e2a\u51f8\u5305\u91cc\u6700\u591a$1000$\u4e2a\u70b9\uff0c\u4e8c\u5206$m$\u6b21\uff0c\u590d\u6742\u5ea6$O(mlog_2q_{max})$\uff0c\u6700\u5927\u4e3a$O(mlog_21000)$\u3002**\u603b\u590d\u6742\u5ea6$O(mlog_2n+mlog_2q_{max})$**\u3002\n\n\u8fd8\u6709\uff0c\u56e0\u4e3a$a^2+b^2<=(a+b)^2$\u4ee5\u53ca\u4e00\u7cfb\u5217\u8ba1\u7b97\u53ef\u4ee5\u77e5\u9053\u6b64\u9898\u7b54\u6848\u5728$int$\u8303\u56f4\u5185\u3002\n\n\u603b\u7ed3\u51e0\u4e2a\u659c\u7387\u4f18\u5316\u7ec6\u8282\u6ce8\u610f\u4e8b\u9879\uff1a\n>1. \u5224\u65ad\u659c\u7387\u5927\u5c0f\u65f6\u5c3d\u91cf\u628a\u9664\u8f6c\u6362\u6210\u4e58\uff0c\u9632\u6b62\u7206\u7cbe\u5ea6\uff1b\n>2. \u52a0\u70b9\u65f6\u8003\u8651\u4e24\u70b9\u6a2a\u5750\u6807\u76f8\u540c\u7684\u60c5\u51b5\uff0c\u6b64\u65f6\u4e0d\u5b58\u5728\u659c\u7387\uff0c\u9700\u7279\u5224\uff1b\n>3. \u51f8\u5305\u91cc\u6709\u81f3\u5c11\u4e24\u4e2a\u70b9\u624d\u53ef\u8fdb\u884c\u4e8c\u5206\uff0c\u6ce8\u610f\u7279\u5224\u51f8\u5305\u4e2d\u6700\u5de6\u70b9\u6216\u6700\u53f3\u70b9\u3002\n\n\n\u6211\u66fe\u7ecf\u51fa\u73b0\u8fc7\u4e00\u4e2a\u9519\u8bef\u7684\u505a\u6cd5\uff1a\n>\u5c06\u56db\u5143\u7ec4$(x,y,p,q)$\u6309$q$\u6392\u5e8f\uff0c\u6bcf\u6b21\u8ba1\u7b97\u65f6\u5148\u4e8c\u5206\u51fa$x$\u7684\u51f8\u5305\u91cc\u65f6\u523b$p$\u4e4b\u524d\u7684\u70b9\uff0c\u518d\u6765\u4e00\u6b21\u4e8c\u5206\u8fdb\u884c\u8f6c\u79fb\uff0c\u52a0\u70b9\u65f6\u4e0d\u7528\u6682\u5b58\uff0c\u76f4\u63a5\u52a0\u5373\u53ef\u3002\n\n\u7136\u540e\u60e8\u70c8\u5730\u88ab\u7b2c$9$\u4e2a\u548c\u7b2c$19$\u4e2a\u6d4b\u8bd5\u70b9\u6253\u7206\u4e86...\n>\u95ee\u9898\u5728\u4e8e\u6211\u4eec\u5728\u505a$(x,y,p,q)$\u7684\u65f6\u5019\u628a\u65f6\u523b$q$\u7684$dp$\u503c\u52a0\u5165\u4e86\u51f8\u5305\uff0c\u6781\u6709\u53ef\u80fd\u4f7f\u5f97\u51f8\u5305\u4e2d\u524d\u9762\u7684\u70b9\u88ab\u5f39\u51fa\uff0c\u4f46\u662f\u540e\u9762\u56db\u5143\u7ec4\u7684$p$\u4e0d\u4e00\u5b9a\u5927\u4e8e\u8fd9\u65f6\u7684$q$\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u628a\u6709\u7528\u7684\u8f6c\u79fb\u70b9\u5f39\u8d70\uff0c\u5bfc\u81f4\u7b54\u6848\u9519\u8bef\u3002\n\n\u597d\u4e86\uff0c\u4e0b\u9762\u662f\u4ee3\u7801\u3002\u7528$vector$\u5b9e\u73b0\u4e86\u6808\u7684\u529f\u80fd\u6765\u7ef4\u62a4\u51f8\u5305\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cctype>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#define il inline\n#define vd void\n#define rg register\n#define mn 100005\n#define mp make_pair\n#define fr first\n#define sd second\n#define rep(i,x,y) for(rg int i=x;i<=y;++i)\n#define drp(i,x,y) for(rg int i=x;i>=y;--i)\nusing namespace std;\nconst int Len=2333333;\nchar buf[Len],*p1=buf,*p2=buf,duf[Len],*q1=duf;\nil char gc(); il int rd(); il vd pc(char c); il vd rt(int x); il vd flush();\ntemplate<class T> il T Max(T a,T b){return a>b?a:b;}\ntemplate<class T> il T Min(T a,T b){return a<b?a:b;}\nint n,m,A,B,C,cry,ans=0x7fffffff;\nvector <pair<int,int> > Q[mn<<1],K[1005];\nil int Wind(int y,int o,int q,int ny){\n    return 1ll*(Q[y][o].sd-Q[y][o-1].sd)*(q-Q[y][o].fr)>=1ll*(ny-Q[y][o].sd)*(Q[y][o].fr-Q[y][o-1].fr);\n}\nil vd Push(int y,int q,int ny){\n    if(!Q[y].empty()&&q==Q[y][Q[y].size()-1].fr){\n        if(ny<Q[y][Q[y].size()-1].sd) Q[y].pop_back(); else return;\n    }\n    while(Q[y].size()>1&&Wind(y,Q[y].size()-1,q,ny)) Q[y].pop_back(); //\u7279\u5224\u6a2a\u5750\u6807\u76f8\u540c\n    Q[y].push_back(mp(q,ny));\n}\nstruct L{\n    int x,y,p,q;\n    il int operator <(const L &pp)const{return p<pp.p;}\n    il vd in(){x=rd(),y=rd(),p=rd(),q=rd();}\n    il int Check(int o){return Q[x][o+1].sd-Q[x][o].sd>=A*p*(Q[x][o+1].fr-Q[x][o].fr)<<1;}\n    il vd Work(){\n        while(cry<p){\n            ++cry;\n            for(rg int i=0;i<(int)K[cry].size();++i) Push(K[cry][i].fr,cry,K[cry][i].sd);\n        } //\u52a0\u70b9\n        if(Q[x].empty()) return;\n        int l=0,r=Q[x].size()-2,ps=r+1,mid;\n        while(l<=r) if(Check(mid=(l+r)>>1)) ps=mid,r=mid-1; else l=mid+1; //\u4e8c\u5206\n        int d=Q[x][ps].sd-(A*p*Q[x][ps].fr<<1)+A*p*p+B*p+C;\n        K[q].push_back(mp(y,d+A*q*q-B*q)); // \u6682\u5b58\u5728\u8be5\u65f6\u523b\u7684vector\u91cc\n        if(y==n) ans=Min(ans,d+q);\n    }\n}l[mn<<1];\nint main(){\n    n=rd(),m=rd(),A=rd(),B=rd(),C=rd();\n    rep(i,1,m) l[i].in();\n    sort(l+1,l+m+1),Q[1].push_back(mp(0,0)); //0\u65f6\u523b\u57281\u53f7\u70b9\n    rep(i,1,m) l[i].Work();\n    rt(ans);\n    return flush(),0;\n}\n\nil char gc(){return p1==p2&&(p2=(p1=buf)+fread(buf,1,Len,stdin),p1==p2)?-1:*p1++;}\nil int rd(){char c;\n    while(!isdigit(c=gc())&&c!='-');\n    int f=c=='-'?c=gc(),1:0,x=c^48;\n    while(isdigit(c=gc())) x=((x+(x<<2))<<1)+(c^48);\n    return f?-x:x;\n}\nil vd pc(char c){q1==duf+Len&&fwrite(q1=duf,1,Len,stdout),*q1++=c;}\nil vd rt(int x){x<0?pc('-'),x=-x:0,pc((x>=10?rt(x/10),x%10:x)+48);}\nil vd flush(){fwrite(duf,1,q1-duf,stdout);}\n```",
        "postTime": 1563344007,
        "uid": 27463,
        "name": "Shallowy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5468 \u3010[NOI2019]\u56de\u5bb6\u8def\u7ebf\u3011"
    },
    {
        "content": "# ~~\u597d\u6c34\u7684\u4e00\u9053NOI\u9898~~\n## \u9898\u76ee\u5927\u610f\uff1a\n\u73b0\u5728\u6709n\u4e2a\u57ce\u5e02\uff0c\u57ce\u5e02\u4e4b\u95f4\u6709m\u6761\u706b\u8f66\u53ef\u4ee5\u5230\u8fbe\u3002\n\n\u7b2ci\u6761\u706b\u8f66\u662f\u4ece\u7b2c$x_i$\u51fa\u53d1\u5e76\u5230\u8fbe$y_i$\uff0c\u662f\u5728$p_i$\u65f6\u95f4\u51fa\u53d1\uff0c\u5e76\u5728$q_i$\u65f6\u95f4\u5230\u8fbe\u3002\n\n\u706b\u8f66\u53ea\u80fd\u591f\u5728\u524d\u4e00\u8f86\u5230\u8fbe\u540e\u624d\u80fd\u4e58\u5750\u3002\n\n\u8bbe\u5171\u4e58\u5750\u4e86k\u8f86\u706b\u8f66\uff0c\u90a3\u4e48\u4ed6\u7684\u4ee3\u4ef7\u662f$(q_{s_{k}}+\\left(A \\times p_{s_{1}}^{2}+B \\times p_{s_{1}}+C\\right)+\\sum_{j=1}^{k-1}\\left(A\\left(p_{s j+1}-q_{s_{j}}\\right)^{2}+B\\left(p_{s_{j+1}}-q_{s_{j}}\\right)+C\\right) $\n\n\u6c42\u6700\u5c0f\u4ee3\u4ef7\u3002\n## \u89e3\u9898\u601d\u8def\uff1a\n\u4e00\u4e2aDP\u9898\u3002\n\n\u6211\u4eec\u5148\u5c06\u706b\u8f66\u6309\u7167\u51fa\u53d1\u65f6\u95f4\u6392\u5e8f\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u8fdb\u884cDP\u4e86\n\n\u6211\u4eec\u7528$f_{i,j}$\u8868\u793a\u65f6\u95f4$j$\u5230\u8fbe\u7ad9\u70b9$i$\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n\u90a3\u6211\u4eec\u6709\u8f6c\u79fb\u4e3a$f_{y_i,q_i}=min(f_{x_i,j}+calc(p_i,j))$\n\n\u5176\u4e2d$calc(x)=Ax^2+Bx+C$\n\n\u7136\u540e\u8f6c\u79fb\u5373\u53ef\u3002\n# Code\uff1a\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\n#define inf 0x3f3f3f3f\nstruct node{\n\tint x,y,p,q;\n\tbool operator<(node a)const{\n\t\treturn p<a.p;\n\t}\n}a[200100];\nint n,m,A,B,C,T,ans;\nint f[100100][1010];\nint calc(int x){\n\treturn x*x*A+x*B+C;\n}\nint main(){\n\tscanf(\"%d%d%d%d%d\",&n,&m,&A,&B,&C);\n\tfor(int i=1;i<=m;i++){\n\t\tscanf(\"%d%d%d%d\",&a[i].x,&a[i].y,&a[i].p,&a[i].q);\n\t\tT=max(T,a[i].q);\n\t}\n\tmemset(f,0x3f,sizeof(f));\n\tf[1][0]=0;\n\tsort(a+1,a+m+1);\n\tfor(int i=1;i<=m;i++)\n\t\tfor(int j=0;j<=a[i].p;j++){\n\t\t\tif(f[a[i].x][j]==inf)continue;\n\t\t\tf[a[i].y][a[i].q]=min(f[a[i].y][a[i].q],f[a[i].x][j]+calc(a[i].p-j));\n\t\t}\n\tint ans=inf;\n\tfor(int i=0;i<=T;i++)\n\t\tans=min(ans,f[n][i]+i);\n\tprintf(\"%d\\n\",ans);\t\n}\n```",
        "postTime": 1563278499,
        "uid": 13237,
        "name": "\u60c5\u975e\u6614\u6bd4",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5468 \u3010[NOI2019]\u56de\u5bb6\u8def\u7ebf\u3011"
    },
    {
        "content": "## NOI\u6570\u636e\u51fa\u9505\u4e86\uff01\uff01\n\n\u6253\u4e86\u4e2a\u7384\u5b66\u66b4\u529b(\u641c\u7d22)\uff0c\u5927\u6837\u4f8b0.1s!\n\n\u5361\u5361\u5e38\uff0c\u60ca\u73b0AC\n\n\u8fd9\u91cc\u8bb2\u4e00\u4e0b\uff1a\n\n[(\u4f18\u79c0\u7684\u66b4\u529b\u4e5f\u662f\u4e00\u79cd\u80fd\u529b)](https://www.luogu.org/recordnew/show/20948227)\n\n\u8dd1\u5f97\u98de\u5feb\uff01\n\nedge\u7528\u4e8e\u5b58\u8fb9\uff0ct\u4e8c\u7ef4\u6570\u7ec4\u7528\u4e8e\u8bb0\u5f55\u7b2cj\u79d2\u8dd1\u5230\u7b2ci\u4e2a\u70b9\u6700\u5c11\u9700\u8981\u7684\u70e6\u8e81\u503c(\u5927\u5c0f\u7ea6\u4e3a1e8\uff0c\u4e0d\u4f1a\u70b8\uff09\n\n\u628a\u56fe\u8dd1\u4e00\u904d\u5c31\u884c\u5566\uff01\uff01\uff08\u597d\u50cf\u662fO(mt)\u7684\uff0c\u4f46\u8dd1\u5f97\u771f\u5feb\uff09\n\n\u4e0a\u4ee3\u7801\uff1a\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n#define N 100010\n#pragma GCC optimize(3)\n#pragma GCC optimize(\"inline\")\nconst int inf=0x3fffffff;\ntypedef long long ll;\n#define re register\ninline int read(){\n\tint x=0,f=1;\n\tchar c=getchar();\n\twhile(c<'0'||c>'9'){\n\t\tif(c=='-')f=-1;\n\t\tc=getchar();\n\t}\n\twhile(c>='0'&&c<='9'){\n\t\tx=(x<<1)+(x<<3)+c-'0';\n\t\tc=getchar();\n\t}\n\treturn x*f;\n}\nint n,m,A,B,C,t[N][1001];\nint ans=inf;\nstruct route{\n\tint to,p,q;\n};\ninline bool cmp(route x,route y){\n\treturn x.p>y.p;\n}\nvector<route> edge[N];\ninline int eva(int x,int y){\n\treturn A*(y-x)*(y-x)+B*(y-x)+C;\n}\nvoid dfs(int u,int tim,int anger){//u\u8bb0\u5f55\u5f53\u524d\u8282\u70b9\uff0ctim\u8bb0\u5f55\u76ee\u524d\u65f6\u95f4\uff0canger\u8bb0\u5f55\u76ee\u524d\u70e6\u8e81\u503c\n\tif(anger>t[u][tim])return;\n\tt[u][tim]=anger;\n\tfor(re int i=0;i<edge[u].size();i++){\n\t\tint v=edge[u][i].to;\n\t\tif(edge[u][i].p<tim)break;//\u526a\u679d\u64cd\u4f5c\n\t\tint an=eva(tim,edge[u][i].p);\n\t\tdfs(v,edge[u][i].q,anger+an);\n\t}\n}\nint main(){\n\tfreopen(\"testdata.in\",\"r\",stdin);\n\tfreopen(\"route.out\",\"w\",stdout);\n\tn=read();m=read();\n\tA=read(),B=read(),C=read();\n\tfor(re int i=1;i<=m;i++){\n\t\tint u=read(),v=read(),p=read(),q=read();\n\t\troute r;\n\t\tr.to=v;\n\t\tr.p=p,r.q=q;\n\t\tedge[u].push_back(r);\n\t}\n\tfor(re int i=1;i<=n;i++){\n\t\tsort(edge[i].begin(),edge[i].end(),cmp);//\u6309p\u503c\u6392\u5e8f\uff0c\u7528\u4e8e\u4ee5\u540e\u7684\u526a\u679d\n\t}\n\tfor(re int i=1;i<=n;i++){\n\t\tfor(re int j=0;j<=1000;j++){\n\t\t\tt[i][j]=inf;\n\t\t}\n\t}\n\tdfs(1,0,0);\n\tfor(int i=0;i<=1000;i++){\n\t\tans=min(ans,t[n][i]+i);\n\t}\n\tcout<<ans<<endl;//\u5feb\u4e50\u7684\u8f93\u51fa\n\treturn 0;\n}\n\n\n```\n\n\u4ee3\u7801\u77ed\u4e86\u4e00\u5339\uff0c\n\n###### \u5475\u5475\u3002\u3002\n\n\u636e\u8bf4\u6b63\u89e3\u662f\u659c\u7387\u4f18\u5316dp\uff0c\u53cd\u6b63\u7a9d\u4e0d\u4f1aqwq\n",
        "postTime": 1563272474,
        "uid": 100285,
        "name": "Froggy",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5468 \u3010[NOI2019]\u56de\u5bb6\u8def\u7ebf\u3011"
    },
    {
        "content": "\n## Solution\n\n\u597d\u50cf\u6b63\u89e3\u662f\u4ee5\u65f6\u95f4\u4e3a\u72b6\u6001DP\u6765\u7740\u2026\u2026\u7136\u800c\u62ff\u5230\u8fd9\u4e2a\u9898\u7684\u7b2c\u4e00\u53cd\u5e94\u662fDP\u6bcf\u6761\u8fb9\u5230 $n$ \u7684\u8d21\u732e\u3002\n\n\u8003\u8651\u8bbe $f_i$ \u662f\u7b2c $i$ \u6761\u8fb9\u5f00\u59cb\u51fa\u53d1\uff0c\u5230\u8fbe $n$ \u53f7\u8282\u70b9\u5bf9\u70e6\u8e81\u503c\u7684\u6700\u5c0f\u8d21\u732e\u3002\u4e8e\u662f\u6709\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$f_i = \\min_{p_j \\geq q_i} ^{x_j = y_i} \\{f_j + A (p_j - q_i)^2 + B(p_j - q_i) + C + p_j - q_i\\} + q_i - p_i$$\n\n\u5373\n\n$$f_i = \\min_{p_j \\geq q_i} ^{x_j = y_i} \\{f_j + A p_j^2 - 2Ap_jq_i + Aq_i^2 + Bp_j - Bq_i + C + p_j - q_i\\} + q_i - p_i$$\n\n\u5c06\u4e0e $j$ \u65e0\u5173\u7684\u9879\u63d0\u51fa\u5927\u62ec\u53f7\uff0c\u5f97\u5230\n\n$$f_i = \\min_{p_j \\geq q_i} ^{x_j = y_i} \\{f_j + A p_j^2 - 2Ap_jq_i  + Bp_j + p_j \\} + q_i - p_i+ Aq_i^2- q_i- Bq_i + C $$\n\n\u6574\u7406\u5f97\n\n$$f_i = \\min_{p_j \\geq q_i} ^{x_j = y_i} \\{f_j + A p_j^2 - 2Ap_jq_i  + (B+1)p_j\\} + Aq_i^2- Bq_i + C- p_i $$\n\n\u8bbe $g_i = A q_i^2 - Bq_i - p_i + C$\uff0c$h_i = Ap_i^2 + (B+1)p_j$\n\n\u4e0a\u5f0f\u5373\u4e3a\n\n$$f_i = f_j + h_j - 2Ap_jq_i + g_i$$\n\n\u79fb\u76f8\u5f97\u5230\n\n$$f_j + h_j = 2Aq_iq_j + f_i - g_i$$\n\n\u6ce8\u610f\u5230 $g_i$ \u662f\u4e00\u4e2a\u4e0e $i$ \u6709\u5173\u7684\u5e38\u6570\uff0c\u90a3\u4e48\u6700\u5c0f\u5316 $f_i$ \u53ea\u9700\u8981\u6700\u5c0f\u5316 $f_i + g_i$\n\n\u5982\u679c\u5c06 $f_j + h_j$ \u770b\u4f5c\u7eb5\u5750\u6807\uff0c $q_j$ \u770b\u4f5c\u6a2a\u5750\u6807\uff0c\u4e0a\u8ff0\u65b9\u7a0b\u53ef\u4ee5\u770b\u6210\u4e00\u6761\u659c\u7387\u4e3a\u5e38\u6570 $2Aq_i$ \u7684\u76f4\u7ebf\uff0c\u5728\u6240\u6709\u6ee1\u8db3\u6761\u4ef6\u7684 $j$ \u4e2d\u9009\u62e9\u4e00\u4e2a\u70b9\uff0c\u4f7f\u5f97\u76f4\u7ebf\u8fc7\u8fd9\u4e2a\u70b9\uff0c\u6700\u5c0f\u5316\u76f4\u7ebf\u5728 $y$ \u8f74\u4e0a\u7684\u622a\u8ddd $f_i + g_i$\u3002\n\n\u90a3\u4e48\u6240\u6709\u6ee1\u8db3\u6761\u4ef6\u7684\u70b9\u663e\u7136\u5728\u4e00\u4e2a\u4e0b\u7a81\u58f3\u4e0a\uff0c\u8bc1\u660e\u4e0a\u53ef\u4ee5\u8003\u8651\u5982\u679c\u4e00\u4e2a\u70b9\u4e0d\u5728\u4e0b\u7a81\u58f3\u4e0a\u90a3\u4e48\u80fd\u627e\u5230\u4e00\u4e2a\u66f4\u4f18\u7684 $j$\u3002\n\n\u7136\u540e\u8003\u8651\u5982\u679c $i$ \u4f1a\u4ece $j$ \u8f6c\u79fb\u8fc7\u6765\uff0c\u90a3\u4e48\u4e00\u5b9a\u6709 $q_i \\leq p_j$\uff0c\u53c8\u56e0\u4e3a $p_j < q_j$\uff0c\u56e0\u6b64 $q_i < q_j$\uff0c\u4e8e\u662f\u6309\u7167 $q$ \u7684\u4e0d\u5347\u5e8f\u8fdb\u884c\u6392\u5e8f\u5373\u53ef\u3002\n\n\u5728\u8f6c\u79fb\u65f6\uff0c\u53ea\u9700\u8981\u5728\u6bcf\u4e2a\u70b9\u7ef4\u62a4\u4e00\u4e2a\u51f8\u58f3\u8868\u793a\u6240\u6709\u53ef\u80fd\u88ab\u9009\u62e9\u7684\u70b9\uff0c\u7136\u540e\u518d\u7ef4\u62a4\u4e00\u4e2a ``set`` \u8bb0\u5f55\u8be5\u70b9\u4e0a\u5df2\u7ecf\u88ab\u8ba1\u7b97\u4f46\u662f\u6ca1\u6709\u63d2\u5165\u51f8\u58f3\u7684\u70b9\u3002``set`` \u5185\u90e8\u6309\u7167 $p$ \u7684\u4e0d\u5347\u5e8f\u6392\u5e8f\uff0c\u6bcf\u6b21\u8981\u8f6c\u79fb\u4e00\u6761\u8fb9 $i$ \u7684\u65f6\u5019\u5148\u5c06\u7ec8\u70b9\u4e2d $p$ \u4e0d\u5c0f\u4e8e $q_i$ \u7684\u8fb9\u63d2\u5165\u51f8\u58f3\uff0c\u7531\u4e8e\u8f6c\u79fb\u662f\u6309\u7167 $q_i$ \u7684\u987a\u5e8f\u8fdb\u884c\u7684\uff0c\u5df2\u7ecf\u88ab\u63d2\u5165\u51f8\u58f3\u7684\u70b9\u4e00\u5b9a\u662f\u5408\u6cd5\u53ef\u4ee5\u8f6c\u79fb\u7684\u3002\n\n\u53e6\u5916\u6ce8\u610f\u5230 $q_i$ \u662f\u5355\u8c03\u4e0d\u5347\u7684\uff0c\u4e8e\u662f\u659c\u7387 $2Aq_i$ \u4e5f\u662f\u5355\u8c03\u5347\u7684\uff0c\u518d\u8003\u8651\u5230\u63d2\u5165\u7684\u6a2a\u8f74 $p_j$ \u4e5f\u662f\u5355\u8c03\u4e0d\u5347\u7684\uff0c\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u6bcf\u4e2a\u70b9\u7684\u51f8\u58f3\u5373\u53ef\u3002\n\n\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u7ec6\u8282\u662f\u51f8\u58f3\u7684\u6a2a\u8f74\u662f\u4ece\u5927\u5230\u5c0f\u63d2\u5165\u7684\uff0c\u5728\u7ef4\u62a4\u7684\u65f6\u5019\u4e0d\u8981\u628a\u5927\u4e8e\u53f7\u5c0f\u4e8e\u53f7\u5199\u53cd\u3002\n\n\u4e00\u5171\u8fdb\u884c\u4e86 $m$ \u6b21\u8f6c\u79fb\uff0c\u6bcf\u6b21\u8f6c\u79fb\u590d\u6742\u5ea6 $O(1)$\uff0c\u56e0\u6b64 DP \u8fc7\u7a0b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(m)$\uff0c\u4f46\u662f\u7531\u4e8e\u8fdb\u884c\u4e86\u6392\u5e8f\uff0c\u4e14\u6bcf\u6761\u8fb9\u63d2\u5165\u5728 ``set`` \u4e2d 1 \u6b21\uff0c\u6240\u4ee5\u6574\u4e2a\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6 $O(m \\log m)$\u3002\n\n## Code\n\n```cpp\n#include <cstdio>\n#include <set>\n#include <queue>\n#include <algorithm>\n\nconst int maxn = 200005;\nconst ll INF = 1ll << 50;\n\nint n, m;\nll A, B, C, ans;\nll frog[maxn], g[maxn], h[maxn];\n\nstruct M {\n  int x, y, p, q;\n\n  inline bool operator<(const M &_others) const {\n    return this->q > _others.q;\n  }\n};\nM MU[maxn];\n\nstruct Cmp {\n  inline bool operator() (const int &_a, const int &_b) {\n    if (MU[_a].p != MU[_b].p) {\n      return MU[_a].p > MU[_b].p;\n    } else {\n      return _a < _b;\n    }\n  }\n};\n\nstd::deque<int>Q[maxn];\nstd::set<int, Cmp>s[maxn];\n\nint query(const int x);\nvoid free(const int x, const int y);\nvoid insert(const int x, const int y);\n\nsigned main() {\n  freopen(\"route.in\", \"r\", stdin);\n  freopen(\"route.out\", \"w\", stdout);\n  qr(n); qr(m); qr(A); qr(B); qr(C);\n  for (int i = 1; i <= m; ++i) {\n    qr(MU[i].x); qr(MU[i].y); qr(MU[i].p); qr(MU[i].q);\n  }\n  frog[m + 1] = 1ll << 50;\n  std::sort(MU + 1, MU + 1 + m);\n  for (int i = 1; i <= m; ++i) {\n    g[i] = A * MU[i].q * MU[i].q - B * MU[i].q -  MU[i].p + C;\n    h[i] = A * MU[i].p * MU[i].p + (B + 1) * MU[i].p;\n  }\n  for (int i = 1; i <= m; ++i) if (MU[i].y == n) {\n    frog[i] = MU[i].q - MU[i].p;\n    s[MU[i].x].insert(i);\n  } else {\n    int y = MU[i].y;\n    free(y, MU[i].q);\n    int j = query(i);\n    if (!j) {\n      frog[i] = INF;\n      continue;\n    }\n    frog[i] = frog[j] + g[i] + h[j] - ((A * MU[i].q * MU[j].p) << 1);\n    s[MU[i].x].insert(i);\n  }\n  ans = 1ll << 50;\n  for (int i = 1; i <= m; ++i) if (MU[i].x == 1) {\n    ans = std::min(frog[i] + A * MU[i].p * MU[i].p + B * MU[i].p + C + MU[i].p, ans);\n  }\n  qw(ans, '\\n', true);\n  return 0;\n}\n\nvoid free(const int x, const int y) {\n  while (!s[x].empty()) {\n    auto u = *s[x].begin();\n    if (MU[u].p >= y) {\n      insert(x, u);\n      s[x].erase(u);\n    } else {\n      break;\n    }\n  }\n}\n\ninline std::pair<ll, ll> calc(const int x) {\n  return std::make_pair(frog[x] + h[x], 1ll * MU[x].p);\n}\n\ninline bool judge(const int x, const int y, const int z) {\n  auto i = calc(x), j = calc(y), k = calc(z);\n  return (k.first <= j.first) && ((i.first - k.first) * (i.second - j.second) < (i.first - j.first) * (i.second - k.second));\n}\n\nvoid insert(const int x, const int y) {\n  while (Q[x].size() > 1) {\n    int i = Q[x].back(); Q[x].pop_back(); int j = Q[x].back();\n    if (judge(j, i, y)) {\n      Q[x].push_back(i); break;\n    }\n  }\n  Q[x].push_back(y);\n}\n\nint query(const int p) {\n  int x = MU[p].y;\n  while (Q[x].size() > 1) {\n    int i = Q[x].front(); Q[x].pop_front(); int j = Q[x].front();\n    auto s = calc(i), t = calc(j); ll k = ((A * MU[p].q) << 1);\n    if ((k * (s.second - t.second)) > (s.first - t.first)) {\n      Q[x].push_front(i);\n      break;\n    }\n  }\n  return Q[x].size () ? Q[x].front() : 0;\n}\n```",
        "postTime": 1563704551,
        "uid": 65363,
        "name": "\u4e00\u6276\u82cf\u4e00",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5468 \u3010[NOI2019]\u56de\u5bb6\u8def\u7ebf\u3011"
    },
    {
        "content": "### \u66b4\u529b\r\n\r\n\u9996\u5148\uff0c\u770b\u5230\u8fd9\u4e2a\u9898\u6211\u4eec\u53ef\u4ee5\u5f88\u8f7b\u677e\u7684\u60f3\u5230\u4e00\u4e2a\u66b4\u529b\u3002\r\n\r\n\u4ee4 $f_i$ \u4e3a\u5982\u679c\u8981\u7ecf\u8fc7\u7b2c $i$ \u6761\u8fb9\u5219\u5728\u6b64\u4e4b\u524d\u9700\u8981\u7684\u82b1\u8d39\u6700\u5c11\u4e3a\u591a\u5c11\u3002\r\n\r\n\u4e00\u4e2a\u663e\u7136\u7684\u65b9\u7a0b\u5f0f\u662f\uff1a\r\n\r\n$$f_i=\\min(f _j+A\\times (p_i-q_j)^2+B\\times (p_i-q_j)+C)$$\r\n\r\n\u5176\u4e2d $j$ \u662f\u6ee1\u8db3 $y_j=x_i$ \u4e14 $q_j\\le p_i$ \u7684\u8fb9\u3002\r\n\r\n\uff08\u8fd9\u8fb9\u7684 $x,y,p,q,A,B,C$ \u53d8\u91cf\u542b\u4e49\u5168\u90e8\u4e0e\u9898\u76ee\u76f8\u540c\uff09\r\n\r\n\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5c06\u4e00\u6761\u8fb9\u5206\u4e3a\u51fa\u548c\u5165\u4e24\u6b65\u6765\u66f4\u65b0\uff0c\u4ece\u800c\u6d88\u9664\u65f6\u95f4\u987a\u5e8f\u7684\u95ee\u9898\u3002\r\n\r\n\u7406\u8bba\u590d\u6742\u5ea6\u4e3a $\\operatorname{O}(m^2)$ \uff0c\u5b9e\u9645\u4e0a\u5361\u4e0d\u6ee1\u3002\r\n\r\n### \u51b3\u7b56\u5355\u8c03\u6027\r\n\r\n\u5f53\u6211\u4eec\u770b\u5230\u8fd9\u6837\u7684\u4e00\u4e2a\u8f6c\u79fb\u65b9\u7a0b\u5f0f\u65f6\uff0c\u6211\u4eec\u4e00\u5b9a\u4f1a\u60f3\u5230\uff1a\u8fd9\u4e2a\u9898\u4e0e\u51b3\u7b56\u5355\u8c03\u6027\u6709\u5173\u3002\r\n\r\n\u4ee4 $w_{q_j,p_i}$ \u4e3a\u4ece $j$ \u8f6c\u79fb\u5230 $i$ \u7684\u8d39\u7528\uff0c\u5373 $A\\times (p_i-q_j)^2+B\\times (p_i-q_j)+C)$\u3002\r\n\r\n\u6211\u4eec\u53ef\u4ee5\u8bc1\u660e\uff0c\u5bf9\u4e8e\u8fb9 $i_1,i_2$ \u5982\u679c\u6709 $x_{i1}=x_{i2}$ \u4e14 $p_{i1}\\le p_{i2}$\uff0c\r\n\r\n\u8bbe\u4e24\u6761\u8fb9\u7684\u6700\u4f18\u51b3\u7b56\u70b9\u5206\u522b\u4e3a $j_1,j_2$\uff0c\u5219 $q_{j1}\\le q_{j2}$\u3002\r\n\r\n\u51b3\u7b56\u5355\u8c03\u6027\u7684\u8bc1\u660e\u4e00\u822c\u4f7f\u7528\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\uff0c\u4f46\u5728\u8003\u573a\u4e0a\u66f4\u591a\u4f7f\u7528\u6253\u8868\u6216\u662f\u76f2\u731c\u7684\u65b9\u6cd5\u3002\r\n\r\n\u5bf9\u4e8e\u4e0d\u77e5\u9053\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\u7684\u540c\u5b66\uff0c\u5efa\u8bae\u9605\u8bfb[\u8fd9\u7bc7\u535a\u5ba2]( https://www.cnblogs.com/a1b3c7d9/p/10984353.html )\u3002\r\n\r\n\u5f53\u7136\u4e5f\u53ef\u4ee5\u9009\u62e9\u76f4\u63a5\u8bb0\u4f4f\u4e00\u4e2a\u7ed3\u8bba\uff1a\r\n\r\n\u82e5\u67d0\u4e2a\u65b9\u7a0b\u5f0f $f_i=\\min(f_j+w_{i,j})$\u7684\u8f6c\u79fb\u8d39\u7528\u6ee1\u8db3 $w_{a,b}+w_{a+1,b+1}\\le w_{a+1,b}+w_{a,b+1}$ \u65f6\uff0c\r\n\r\n\u8be5\u65b9\u7a0b\u7684\u6700\u4f18\u51b3\u7b56\u70b9\uff08\u5373\u6700\u4f73\u7684 $j$\uff09\u968f $i$ \u975e\u4e25\u683c\u5355\u8c03\u9012\u589e\uff0c\u5373\u6ee1\u8db3\u51b3\u7b56\u5355\u8c03\u6027\u3002\r\n\r\n\u90a3\u4e48\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u6765\u8bc1\u660e\u4e00\u4e0b\u8fd9\u4e2a\u9898\u7684\u51b3\u7b56\u5355\u8c03\u6027\u3002\r\n\r\n$$w_{a,b}+w_{a+1,b+1}\\le w_{a+1,b}+w_{a,b+1}$$\r\n\r\n$$\\Leftrightarrow A\\times(a-b)^2+B\\times(a-b)+C+A\\times(a+1-b-1)^2+B\\times(a+1-b-1)+C$$\r\n\r\n$$\\le A\\times (a+1-b)^2+B\\times (a+1-b)+C+a\\times (a-b-1)^2+B\\times (a-b-1)+C$$\r\n\r\n$$\\Leftrightarrow 2\\times A(a-b)^2\\le A\\times (a+1-b)^2+A\\times (a-b-1)^2$$\r\n\r\n\u4ee4 $t=a-b$ \r\n\r\n$$\\Leftrightarrow 2\\times At^2\\le A(t+1)^2+A(t-1)^2$$\r\n\r\n$$RHS=2At^2+2A\\ge 2At^2=LHS$$ \r\n\r\n\u8bc1\u6bd5\u3002\r\n\r\n\u987e\u53ef\u77e5\uff0c\u8fd9\u4e00\u65b9\u7a0b\u6ee1\u8db3\u51b3\u7b56\u5355\u8c03\u6027\uff0c\u5373\u6ee1\u8db3\u5bf9\u4e8e\u8fb9 $i_1,i_2$ \u5982\u679c\u6709 $x_{i1}=x_{i2}$ \u4e14 $p_{i1}\\le p_{i2}$\uff0c\r\n\r\n\u8bbe\u4e24\u6761\u8fb9\u7684\u6700\u4f18\u51b3\u7b56\u70b9\u5206\u522b\u4e3a $j_1,j_2$\uff0c\u5219\u6709 $q_{j1}\\le q_{j2}$\u3002\r\n\r\n### \u659c\u7387\u4f18\u5316\r\n\r\n\u659c\u7387\u4f18\u5316\u662f\u51b3\u7b56\u5355\u8c03\u6027\u7684\u4e00\u4e2a\u9ad8\u7ea7\u5e94\u7528\uff0c\u4e00\u822c\u5728 $f$ \u65b9\u7a0b\u4ec5\u6709\u4e00\u4e2a\u7ef4\u5ea6\u65f6\u6709\u6548\u3002\r\n\r\n\u4e0d\u4f1a\u659c\u7387\u4f18\u5316\u7684\u540c\u5b66\u8fd9\u91cc\u63a8\u8350\u4e00\u4e0b[\u8fb0\u661f\u51cc\u5927\u4f6c\u7684\u535a\u5ba2]( https://www.cnblogs.com/Xing-Ling/p/11210179.html )\u3002\r\n\r\n\u6211\u4eec\u6765\u8003\u8651\u5bf9\u4e8e $ f_i$ \u800c\u8a00\uff0c\u51b3\u7b56\u70b9 $j_1$ \u6bd4 $j_2$ \uff08$q_{j_1}\\ge q_{j_2}$\uff09\u66f4\u4f18\u9700\u8981\u6ee1\u8db3\u4ec0\u4e48\u6761\u4ef6\u3002\r\n\r\n\u5c06\u65b9\u7a0b\u5f0f\u5c55\u5f00\u540e\u79fb\u9879\uff0c\u5f97\u5230\r\n\r\n$$f_i-Ap_i^2-Bp_i-C=f_j+Aq_j^2-2Ap_iq_j-Bq_j$$\r\n\r\n\u8fd9\u6837\u79fb\u9879\u7684\u597d\u5904\u662f\uff0c\u6709\u5173\u4e8e $j$ \u7684\u9879\u5168\u90e8\u88ab\u79fb\u5230\u4e86\u53f3\u8fb9\u3002\r\n\r\n\u7531\u4e8e $i$ \u662f\u6211\u4eec\u5df2\u7ecf\u786e\u5b9a\u7684\uff0c\u6240\u4ee5 $p_i$ \u53ef\u4ee5\u770b\u4f5c\u5e38\u91cf\u3002\r\n\r\n\u6839\u636e\u65b9\u7a0b\u5f0f\u53ef\u77e5\uff0c\u82e5 $j_1$ \u6bd4 $j_2$ \u66f4\u4f18\uff0c\u5219\u9700\u6ee1\u8db3\r\n\r\n$$f_{j_1}+Aq_{j_1}^2-2Ap_iq_{j_1}-Bq_{j_1} \\le f_{j_2}+Aq_{j_2}^2-2Ap_iq_{j_2}-Bq_{j_2}$$\r\n\r\n$$\\Leftrightarrow 2Ap_i(q_{j_1}-q_{j_2})\\ge (f_{j_1}+Aq_{j_1}^2-Bq_{j_1})-(f_{j_2}+Aq_{j_2}^2-Bq_{j_2})$$\r\n\r\n\u4ee4\r\n\r\n$$X(a)=q_a$$\r\n\r\n$$Y(a)=f_{a}+Aq_{a}^2-Bq_{a}$$\r\n\r\n$$K(a)=2\\times A\\times p_i$$\r\n\r\n$$B(a)=f_i-Ap_i^2-Bp_i-C$$\r\n\r\n\u4e8e\u662f\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a\u659c\u7387\u4f18\u5316\u7684\u5f62\u5f0f\u3002\r\n\r\n\u5f53 $i$ \u56fa\u5b9a\u65f6\uff0c\u6211\u4eec $K(i)$ \u4e5f\u5c31\u56fa\u5b9a\u4e86\u3002\r\n\r\n\u800c\u6211\u4eec\u7684\u76ee\u6807\u5c31\u662f\u8ba9  $B(i)$ \u8d8a\u5c0f\u8d8a\u597d\u3002\r\n\r\n\u56e0\u6b64\uff0c\u53ea\u8981 $j_1,j_2 $ \u6ee1\u8db3\r\n\r\n$$K(i)\\ge \\frac{Y(j_1)-Y(j_2)}{X(j_1)-X(j_2)}$$\r\n\r\n\u4e5f\u5c31\u662f $K(i )$ \u5927\u4e8e $(X(j_1),Y(j_1))$ \u4e0e $(X(j_2),Y(j_2))$ \u7ec4\u6210\u7684\u76f4\u7ebf\uff0c\u5219 $j_1$ \u4f18\u4e8e $j_2 $\u3002\r\n\r\n\u8fd9\u5176\u5b9e\u975e\u5e38\u597d\u7406\u89e3\u3002\u5f53 $K(i)<\\frac{Y(j_1)-Y(j_2)}{X(j_1)-X(j_2)}$ \u65f6\uff0c\u8bbe $B$ \u70b9\u4e3a $(X(j_1),Y(j_1))$\uff0c$A$ \u70b9\u4e3a $(X(j_2),Y(j_2))$\uff0c\r\n\r\n\u5219\u6211\u4eec\u753b\u51fa\u6765\u7684\u56fe\u5982\u4e0b\uff1a\r\n\r\n![](https://cdn.luogu.com.cn/upload/image_hosting/xx5epmov.png)\r\n\r\n\u663e\u7136\u6b64\u65f6\u8ba9\u76f4\u7ebf\u7ecf\u8fc7 $A$ \u70b9\u66f4\u4f18\u3002\r\n\r\n\u800c\u5f53 $K(i)\\ge \\frac{Y(j_1)-Y(j_2)}{X(j_1)-X(j_2)}$ \u65f6\uff0c\u56fe\u5982\u4e0b\uff1a\r\n\r\n![](https://cdn.luogu.com.cn/upload/image_hosting/nok4ca8p.png)\r\n\r\n\u663e\u7136\u9009\u62e9 $B$ \u70b9\u66f4\u4f18\u3002\r\n\r\n\u53c8\u7531\u4e8e\u6211\u4eec\u8bc1\u660e\u4e86\u51b3\u7b56\u5355\u8c03\u6027\uff0c\u56e0\u6b64\u4ece\u6b64\u4ee5\u540e $A$ \u70b9\uff08\u4e5f\u5c31\u662f $j_2$\uff09 \u518d\u65e0\u7528\u5904\u3002\r\n\r\n\u5982\u679c\u6211\u4eec\u7528\u4e00\u4e2a\u53cc\u7aef\u961f\u5217\u6765\u7ef4\u62a4\u4e5f\u8bb8\u6709\u6548\u7684\u51b3\u7b56\u70b9\uff0c\u90a3\u4e48\u8fd9\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06 $j_2$ \u51fa\u961f\u3002\r\n\r\n\u63a5\u7740\uff0c\u6211\u4eec\u518d\u6765\u8003\u8651\u4ec0\u4e48\u6837\u7684\u70b9\u9700\u8981\u653e\u5165\u961f\u5217\u4e2d\u3002\r\n\r\n![](https://cdn.luogu.com.cn/upload/image_hosting/dfhsh30p.png)\r\n\r\n\u5bf9\u4e8e\u8fd9\u6837\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u65e0\u8bba\u6240\u6c42\u76f4\u7ebf\u7684 $K(i)$ \u662f\u591a\u5c11\uff0c$B$ \u90fd\u4e0d\u4f1a\u6210\u4e3a\u6700\u4f18\u51b3\u7b56\u70b9\uff0c\r\n\r\n\u56e0\u6b64\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06 $B$ \u51fa\u961f\u3002\r\n\r\n\u51c6\u786e\u7684\u8bf4\uff0c\u5f53 $\\frac{Y(A)-Y(B)}{X(A)-X(B)}\\ge \\frac{Y(A)-Y(C)}{X(A)-X(C)}$ \u65f6\uff0c$B$ \u70b9\u5c31\u4e0d\u4f1a\u6210\u4e3a\u6700\u4f18\u51b3\u7b56\u70b9\uff0c\r\n\r\n\u56e0\u4e3a\u5f53 $K(i)<\\frac{Y(A)-Y(C)}{X(A)-X(C)}$ \u65f6 $A$ \u6bd4 $B$ \u66f4\u4f18\uff0c\u5426\u5219 $C$ \u6bd4 $B$ \u66f4\u4f18\u3002\r\n\r\n\u5176\u5b9e\u5982\u679c\u6211\u4eec\u628a\u961f\u5217\u4e2d\u7684\u6240\u6709\u70b9\u753b\u51fa\u6765\uff0c\u5e94\u8be5\u662f\u8fd9\u6837\u7684\uff1a\r\n\r\n![](https://cdn.luogu.com.cn/upload/image_hosting/fqdq93by.png)\r\n\r\n### Code\r\n\r\n```cpp\r\n#include <bits/stdc++.h>\r\n#define ll long long\r\n#define X(T) (q[T])\r\n#define Y(T) (f[T]+a*q[T]*q[T]-b*q[T])\r\n#define K(T) (2*a*p[T])\r\n#define B(T) (f[T]-a*p[T]*p[T]-b*p[T]-c)\r\n//\u4e00\u4e2a\u597d\u4e60\u60ef\uff0c\u4e5f\u65b9\u4fbf\u76f4\u63a5\u8c03\u7528\r\nusing namespace std;\r\ninline int read(){\r\n\tregister int x=0;\r\n\tregister bool f=0;\r\n\tregister char c=getchar();\r\n\twhile(c<'0'||c>'9'){\r\n\t\tif(c=='-') f=1;\r\n\t\tc=getchar();\r\n\t}\r\n\twhile(c>='0'&&c<='9'){\r\n\t\tx=(x<<3)+(x<<1)+c-48;\r\n\t\tc=getchar();\r\n\t}\r\n\treturn f?-x:x;\r\n}\r\nchar cr[200];int tt;\r\ninline void print(register ll x,register char k='\\n') {\r\n    if(!x) putchar('0');\r\n    if(x < 0) putchar('-'),x=-x;\r\n    while(x) cr[++tt]=x%10+'0',x/=10;\r\n    while(tt) putchar(cr[tt--]);\r\n    putchar(k);\r\n}\r\nconst int maxn=200001;\r\nint n,m,a,b,c,mx;\r\nint p[maxn],q[maxn],u[maxn],v[maxn];\r\nll f[maxn],ans=114514191981000000ll;\r\nint tl,tl2,he,he2,sz;\r\ndeque<int> d[maxn];\r\n//stl \u81ea\u5e26\u53cc\u7aef\u961f\u5217\uff0c\u4e5f\u53ef\u4ee5\u7528 vector \u5b9e\u73b0\r\ndeque<int>::iterator it;\r\nvector<int> st[1001];\r\nvector<int> ed[1001];\r\n//st,ed \u5206\u522b\u4e3a\u67d0\u4e00\u65f6\u523b\u7684\u51fa\u53d1\u4e0e\u5230\u8fbe\u6570\u7ec4\r\ndouble slope(int qa,int qb){\r\n    return (1.0*(Y(qa)-Y(qb)))/(1.0*(X(qa)-X(qb)));\r\n    //\u6c42\u659c\u7387\r\n}\r\nsigned main(){\r\n//\tfreopen(\"route.in\",\"r\",stdin);\r\n//\tfreopen(\"route.out\",\"w\",stdout);\r\n\tn=read();m=read();a=read();b=read();c=read();\r\n\tfor(int i=1;i<=m;++i){\r\n\t\tu[i]=read();v[i]=read();p[i]=read();q[i]=read();\r\n\t\tif(u[i]==n) continue;\r\n\t\tmx=max(mx,q[i]);\r\n\t\tst[p[i]].push_back(i);\r\n\t\tf[i]=1233333333ll;\r\n        //\u521d\u59cb\u5316\r\n\t}\r\n\td[1].push_back(0);\r\n\tf[1]=0;\r\n\tfor(int i=0;i<=mx;i++){\r\n\t\tfor(int j:ed[i]){\r\n            //\u679a\u4e3e\u7b2c i \u65f6\u523b\u5230\u8fbe\u7684\u8fb9\r\n\t\t\tsz=d[v[j]].size();\r\n\t\t\tif(sz==0) {\r\n\t\t\t\td[v[j]].push_back(j);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tit=d[v[j]].end();\r\n\t\t\tit--;\r\n\t\t\ttl=*it;\r\n\t\t\twhile(sz>1){\r\n\t\t\t\tit--;tl2=*it;\r\n                //tl \u4e3a\u961f\u5c3e\uff0ctl2 \u4e3a\u961f\u5c3e\u7b2c\u4e8c\u4e2a\u6570\r\n\t\t\t\tif(slope(tl,tl2)<slope(j,tl2)){\r\n\t\t\t\t\tbreak;\r\n                    //tl2 \u53ef\u80fd\u66f4\u4f18\r\n\t\t\t\t}\r\n                //j \u4e00\u5b9a\u66f4\u4f18\uff0c\u5f39\u51fa tl2\r\n\t\t\t\ttl=tl2;sz--;\r\n\t\t\t\td[v[j]].pop_back();\r\n\t\t\t}\r\n\t\t\td[v[j]].push_back(j);\r\n\t\t}\r\n\t\tfor(int j:st[i]){\r\n            //\u679a\u4e3e\u7b2c i \u65f6\u523b\u51fa\u53d1\u7684\u8fb9\r\n\t\t\tsz=d[u[j]].size();\r\n\t\t\tif(sz==0) continue;\r\n            //\u8fd9\u6761\u8fb9\u51fa\u53d1\u4e4b\u524d\u65e0\u6cd5\u5230\u8fbe\u8be5\u70b9\uff0c\u6545\u8fd9\u6761\u8fb9\u65e0\u6548\r\n\t\t\tit=d[u[j]].begin();he=*it;\r\n\t\t\twhile(sz>1){\r\n\t\t\t\tit++;he2=*it;\r\n                //he \u4e3a\u961f\u9996\uff0che2 \u4e3a\u961f\u9996\u7b2c\u4e8c\u4e2a\u6570\r\n\t\t\t\tif(slope(he2,he)>K(j)){\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n                //\u6bd4\u8f83\u4e00\u4e0b\u90a3\u6761\u8fb9\u66f4\u4f18\uff0c\u5982\u679c he2 \u53ef\u4ee5\u53d6\u4ee3 he \u5219\u51fa\u961f\r\n                //\u6b64\u65f6\u961f\u9996\u5c31\u662f\u6700\u4f18\u51b3\u7b56\u70b9\u4e86\r\n\t\t\t\the=he2;sz--;\r\n\t\t\t\td[u[j]].pop_front();\r\n\t\t\t}\r\n\t\t\tf[j]=f[he]+a*(p[j]-q[he])*(p[j]-q[he])+b*(p[j]-q[he])+c;\r\n            //\u66f4\u65b0 f \u51fd\u6570\r\n\t\t\tif(v[j]==n) ans=min(ans,f[j]+q[j]);\r\n\t\t\ted[q[j]].push_back(j);\r\n\t\t}\r\n\t}\r\n\tprint(ans);\r\n\treturn 0;\r\n}\r\n```\r\n\r\n",
        "postTime": 1585406172,
        "uid": 120074,
        "name": "BFqwq",
        "ccfLevel": 6,
        "title": "\u56de\u5bb6\u8def\u7ebf \u9898\u89e3"
    },
    {
        "content": "**[$NOI2019D1T1$\u56de\u5bb6\u8def\u7ebf](https://www.luogu.org/problem/P5468)**\n\n[\u6b64\u5904\u9605\u8bfb\u4f53\u9a8c\u66f4\u4f73\u54e6](https://www.cnblogs.com/wo-shi-zhen-de-cai/p/11015133.html)\n\n\u636e\u8bf4\u2026\u2026\u8fd9\u9053\u9898\u88ab\u8bb8\u591a\u4eba\u5632\u8bbd\u4e3a\u6c34\u9898\uff0c\u53ef\u6211\u4e0d\u8fd9\u4e48\u60f3\u554a\uff08\u679c\u771f\u662f\u56e0\u4e3a\u6211\u592a\u5f31\u4e86\u5417\u2026\u2026\n\n\u4f46\u8003\u573a\u4e0a\u5c31\u771f\u7684\u8981\u2026\u2026$WOC$\u4f60\u7ed9\u6211\u89e3\u91ca\u4e00\u4e0b$O_{(mt)}$\u90fd\u80fd\u8fc7\u662f\u4ec0\u4e48\u60c5\u51b5\u554a\uff01\uff01\n\n\u4f60\u786e\u5b9a\u4f60\u771f\u7684\u4e0d\u662f\u7528\u811a\u5728\u9020\u6570\u636e\uff1f\uff01\n\n**\u6b63\u89e3**\uff08\u4f60\u522b\u7ed9\u8001\u5b50\u60f3\u4ec0\u4e48\u66b4\u529b\u5361\u5e38\uff09\uff1a\u659c\u7387\u4f18\u5316$DP$\uff0c\u63a8\u65b9\u7a0b\u5b8c\u5168\u4e0d\u96be\uff0c\u8bbe$f[i]$\u4e3a\u6700\u540e\u4e58\u7f16\u53f7\u4e3a$i$\u7684\u8f66\u7684\u6700\u5c0f\u70e6\u8e81\u503c\uff0c\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a$f[i]=min(f[j]+A*(p_i-q_j)^2+B*(p_i-q_j)+C)$\n\n\u51b3\u7b56\u70b9\u4e3a$(q_i,f[j]+A*q_j^2-B*q_j)$\uff0c\u5f53$j$\u6bd4$k$\u66f4\u4f18\u65f6\uff0c\u6ee1\u8db3\uff1a$\\frac{f[j]-f[k]+A*(q_j^2-q_k^2)-B*(q_j-q_k)}{q_j-q_k}<2*A*p_i$\n\n\u4f46\u662f\uff0c\u6211\u4eec\u8f6c\u79fb\u65f6\u8981\u6ee1\u8db3$p_i>=q_j,y_j=x_i$\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u80fd\u50cf\u4ee5\u524d\u4e00\u6837\u7ef4\u62a4\u4e00\u4e2a\u51f8\u5305\uff0c\u4ece\u6240\u6709\u7684\u51b3\u7b56\u4e2d\u8f6c\u79fb\u3002\n\n\u4ed4\u7ec6\u601d\u8003\u4e00\u4e0b\uff0c\u6211\u4eec\u7684\u51b3\u7b56\u6765\u81ea\u90e8\u5206\u6ee1\u8db3\u6761\u4ef6\u7684\u524d\u9762\u5df2\u7ecf\u505a\u51fa\u7684\u51b3\u7b56\uff0c\u4e0d\u59a8\u6211\u4eec\u5bf9\u51b3\u7b56\u6309$i$\u5230\u8fbe\u7684\u4f4d\u7f6e\u5206\u4e2a\u7ec4\u3002\n\n\u5373\u5728\u6bcf\u4e2a\u8282\u70b9\u5904\u7ef4\u62a4\u4e00\u4e2a\u51f8\u5305\uff08\u8fd9\u6837\u4e00\u5b9a\u6ee1\u8db3\u5355\u8c03\u6027\uff0c\u4e0d\u89e3\u91ca\u4e86\uff09\uff0c\u51f8\u5305\u4e2d\u7684\u70b9\u4e3a$f[j]$\uff08$j$\u4e3a\u76ee\u7684\u5730\u4e3a\u8be5\u8282\u70b9\u7684\u5217\u8f66\u7f16\u53f7\uff09\uff0c\u8fd9\u6837\u6211\u4eec\u8f6c\u79fb\u65f6\u5c31\u53ef\u4ee5\u6ee1\u8db3\u7a7a\u95f4\u9650\u5236\u4e86\u3002\n\n\u518d\u8003\u8651\u65f6\u95f4\u9650\u5236\u600e\u4e48\u505a\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u65f6\u95f4\uff0c\u518d\u5f00\u4e00\u4e2a\u7b49\u5f85\u961f\u5217\uff0c\u5b58\u5728$q[i]$\u65f6\u5230\u7684\u5217\u8f66$i$\uff0c\u4f46\u4ed6\u4eec\u4e0d\u80fd\u88ab\u5229\u7528\uff0c\u56e0\u4e3a\u8fd8\u6ca1\u679a\u4e3e\u5230\u4ed6\u4eec\u7684\u5230\u8fbe\u65f6\u95f4\uff0c\u7136\u540e\u679a\u4e3e\u5230\u65f6\u95f4$t$\u65f6\uff0c\u5c06\u7b49\u5f85\u961f\u5217\u4e2d\u6240\u6709\u5230\u8fbe\u65f6\u95f4\u4e3a$t$\u7684\u5217\u8f66\u52a0\u8fdb\u76f8\u5e94\u7684\u51f8\u5305\u4e2d\uff08\u5e76\u7ef4\u62a4\u51f8\u5305\u7684\u5355\u8c03\u6027\uff09\uff0c\u8bf4\u660e\u4ed6\u4eec\u53ef\u4ee5\u88ab\u5229\u7528\u6765\u8f6c\u79fb\u3002\n\n\u6700\u540e\u5728\u6bcf\u6b21\u8f6c\u79fb\u540e\u5c06\u8be5\u6b21\u8f6c\u79fb\u52a0\u5165\u7b49\u5f85\u961f\u5217\u4e2d\uff0c\u5224\u65ad\u662f\u5426\u5230\u8fbe$n$\uff0c\u5982\u679c\u5230\u8fbe\uff0c\u5c31\u66f4\u65b0\u7b54\u6848\uff08\u8bb0\u5f97\u52a0\u4e0a$q_i$\uff09\n\n\u7ed9\u6ce5\u840c\u770b\u6211\u4e11\u964b\u7684\u4ee3\u7801\uff1a\n\n```c++\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\n#define S(x) ((x)*(x))\ninline int read()\n{\n    int f=1,w=0;char x=0;\n    while(x<'0'||x>'9') {if(x=='-') f=-1; x=getchar();}\n    while(x!=EOF&&x>='0'&&x<='9') {w=(w<<3)+(w<<1)+(x^48);x=getchar();}\n    return w*f;\n}\nconst int N=200010,M=1001;\nqueue<int> res[M];\nint n,m,A,B,C,MaxT,ans=1e18;\nvector<int> Tbg[M],Q[N];\nint q[N],p[N],x[N],y[N],head[N],f[N];\ninline double K(int j,int k)\n{\n\treturn (double)(f[j]-f[k]+A*(S(q[j])-S(q[k]))-B*(q[j]-q[k]))/(double)(q[j]-q[k]);\n}\nmain(){\n#ifndef ONLINE_JUDGE\n    //freopen(\"A.in\",\"r\",stdin);//Ans=94;\n\tfreopen(\"B.in\",\"r\",stdin);//Ans=34;\n#endif\n\tn=read(),m=read(),A=read(),B=read(),C=read();\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tx[i]=read(),y[i]=read(),p[i]=read();\n\t\tq[i]=read(),Tbg[p[i]].push_back(i);\n\t\tMaxT=max(MaxT,q[i]);\n\t}\n\tQ[1].push_back(0);\n\tfor(int t=0;t<=MaxT;t++)\n\t{\n\t\twhile(!res[t].empty())\n\t\t{\n\t\t\tint pos=y[res[t].front()];\n\t\t\twhile(Q[pos].size()-head[pos]>=2)\n\t\t\t{\n\t\t\t\tint len=Q[pos].size();\n\t\t\t\tif(K(Q[pos][len-1],Q[pos][len-2])<K(Q[pos][len-2],res[t].front())) break;\n\t\t\t\tQ[pos].pop_back();\n\t\t\t}\n\t\t\tQ[pos].push_back(res[t].front()),res[t].pop();\n\t\t}\n\t\tfor(int i=0;i<(int)Tbg[t].size();i++)\n\t\t\tif((int)Q[x[Tbg[t][i]]].size()>head[x[Tbg[t][i]]])\n\t\t\t{\n\t\t\t\tint id=Tbg[t][i],pos=x[id];\n\t\t\t\twhile((int)Q[pos].size()-head[pos]>=2)\n\t\t\t\t{\n\t\t\t\t\tif(K(Q[pos][head[pos]],Q[pos][head[pos]+1])>2.0*A*p[id]) break ;\n\t\t\t\t\thead[pos]++;\n\t\t\t\t}\n\t\t\t\tint j=Q[pos][head[pos]];\n\t\t\t\tf[id]=f[j]+A*S(p[id]-q[j])+B*(p[id]-q[j])+C;\n\t\t\t\tres[q[id]].push(id);if(y[id]==n) ans=min(ans,f[id]+q[id]);\n\t\t\t}\n\t}\n\tprintf(\"%lld\",ans);\n}\n```\n\n",
        "postTime": 1564058793,
        "uid": 92496,
        "name": "\u6587\u6b66\u6b66\u667a\u969c",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5468 \u3010[NOI2019]\u56de\u5bb6\u8def\u7ebf\u3011"
    },
    {
        "content": "\u521a\u5b66\u63d0\u9ad8\u7ec4\u4e0d\u4e45\u7684\u849f\u84bb~~\u88ab\u903c\u7740~~\u6253\u4e86\u540c\u6b65\u8d5b\uff0c\u53d1\u73b0T1\u7adf\u7136A\u4e86\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nstruct node\n{\n    int from;\n    int to;\n    int from_time;\n    int to_time;\n    node()\n    {\n    }\n    node(int _a,int _b,int _c,int _d)\n    {\n        from=_a,to=_b,from_time=_c,to_time=_d;\n    }\n}q[200005];\nbool cmp(node x,node y)\n{\n    if (x.from_time==y.from_time) return x.to_time<y.to_time;\n    return x.from_time<y.from_time;\n}\nint read()\n{\n    int x=0;\n    bool f=0;\n    char c=getchar();\n    while(!isdigit(c))\n    {\n        if(c=='-')f=1;\n        c=getchar();\n    }\n    while(isdigit(c))\n    {\n        x=x*10+c-'0';\n        c=getchar();\n    }\n    if(f)x=-x;\n    return x;\n}\nlong long n,m,A,B,C,vis[100005][55],sum[100005][55],cnt[100005];\nlong long ans=1e18;\nint main() {\n    //freopen(\"route.in\",\"r\",stdin);\n    //freopen(\"route.out\",\"w\",stdout);\n    memset(vis,0x7fffffffffffffff,sizeof(vis));\n    memset(sum,0x7fffffffffffffff,sizeof(sum));\n    vis[1][1]=0;\n    sum[1][1]=0;\n    cnt[1]=1;//\u521d\u59cb\u5316 \n    n=read(),m=read(),A=read(),B=read(),C=read();\n    for (int i=0;i<m;i++)\n    {\n        int a=read(),b=read(),c=read(),d=read();\n        q[i]=node(a,b,c,d);\n    }\n    sort(q,q+m,cmp);//\u6309\u5230\u8fbe\u65f6\u95f4\u5347\u5e8f\u6392\u5e8f \n    for (int i=0;i<m;i++)\n    {\n        long long minn=0x7fffffffffffffff;\n        for (int j=1;j<=cnt[q[i].from];j++)\n        {\n            if (vis[q[i].from][j]>q[i].from_time) continue;//\u5982\u679c\u4e0a\u4e00\u73ed\u8f66\u5230\u7ad9\u65f6\u95f4\u5df2\u7ecf\u665a\u4e8e\u8fd9\u73ed\u51fa\u53d1\u65f6\u95f4\uff0c\u5c31\u4e0d\u7528\u7ee7\u7eed\u5faa\u73af\u4e86 \n            int y=q[i].from_time-vis[q[i].from][j];\n            minn=min(minn,sum[q[i].from][j]+A*y*y+B*y+C);\n        }\n        if (minn!=0x7fffffffffffffff)\n        {\n            sum[q[i].to][++cnt[q[i].to]]=minn;\n            vis[q[i].to][cnt[q[i].to]]=q[i].to_time;\n        }\n    }\n    for (int i=1;i<=cnt[n];i++)ans=min(ans,sum[n][i]+vis[n][i]);\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```\n\u6700\u6162\u7684\u70b9218ms\uff08~~\u8fd8\u662f\u6570\u636e\u592a\u6c34\u624d\u8fc7\u7684~~\uff09",
        "postTime": 1563360866,
        "uid": 32879,
        "name": "k1saki",
        "ccfLevel": 7,
        "title": "NOI2019D1T1"
    },
    {
        "content": "\u6709\u70b9\u6280\u5de7\u7684\u659c\u7387\u4f18\u5316\u95ee\u9898(\u5e76\u4e48\u6709\u6ca1\u6709\u6a2a\u5750\u6807\u4e0d\u5355\u8c03/\u52a8\u6001\u51f8\u5305qwq...\u6280\u5de7\u4e0d\u662f\u5728\u8ba1\u7b97\u51e0\u4f55\u90a3\u91cc\u7684).  \n\n-----\n*****\n\n$from/to(s)$\u67d0\u6761\u8fb9\u7684\u8d77\u70b9/\u7ec8\u70b9\u4f4d\u7f6e.  \n$S/T(S)$\u53d1\u8f66/\u5230\u7ad9\u65f6\u95f4.  \n$trans(i)$\u67d0\u6761\u8fb9/\u67d0\u4e2a\u8f6c\u79fb.\n\n### \u4e00\u4e2a\u89c2\u5bdf\n> \u9898\u5916\u8bdd,\u5c31\u7b97\u662f\u591a\u4e24\u4e2alog\u4e5f\u662f\u53ef\u4ee5\u8fc7\u7684,\u7384\u5b66\u7684\u590d\u6742\u5ea6\u6709\u9505\u7684\u4e5f\u662f\u53ef\u4ee5AC...\u4f46\u662f\u6211\u4eec\u73b0\u5728\u6bd5\u7adf\u4e0d\u662f\u8d5b\u65f6,\u8fd8\u662f\u5199\u9760\u8c31\u7684\u4e1c\u897f\u5427qwq.\n\n- \u4e58\u5750\u7ebf\u8def\u5e8f\u5217\u4e0d\u4f1a\u6210\u73af,\u5c31\u662f\u6ca1\u6cd5\u627e$(s_1,s_2\\dots s_k)$\u4f7f\u5f97$to(s_k)=from(s_1)$\u5e76\u4e14$S(i)\\geq T(i-1)$.\u539f\u56e0\u5728\u4e8e$S(s)\\lt T(s)$. \u8fd9\u662f\u975e\u5e38\u5bb9\u6613\u89c2\u5bdf\u5230\u7684\u6027\u8d28,\u4e5f\u662f\u6700\u4e3a\u91cd\u8981\u7684\u6027\u8d28,\u5b83\u544a\u8bc9\u6211\u4eec\u5982\u679c\u60f3\u8981\u505a\u6700\u77ed\u8def\u7684\u8bdd,\u8fd9\u4e2a\u56fe\u91cc\u9762\u6ca1\u6709\u73af.\n\n### \u8fd9\u4e2a\u6700\u77ed\u8def\u554a,\u4e5f\u8bb8\u53ef\u4ee5dp\n\u521a\u624d\u7684\u89c2\u5bdf,\u542f\u53d1\u6211\u4eec\u4f7f\u7528\u7684\u8fb9\u662f\u4e00\u4e2a\u4e0d\u4f1a\u91cd\u590d\u51fa\u73b0\u7684\u72b6\u6001,\u4e58\u5750$trans_i$\u4e4b\u540e,\u4e00\u5207\u90fd\u662f\u786e\u5b9a\u7684,\u4f4d\u7f6e,\u65f6\u95f4,\u4ee3\u4ef7.  \n\u6211\u4eec\u5148\u6309\u7167\u53d1\u8f66\u65f6\u95f4\u5bf9\u8fb9\u6392\u5e8f...\n\n\u6211\u4eec\u8003\u8651$dp_i$\u4e3a\u4e58\u5750\u5b8c$trans_i$\u6700\u5c0f\u5316\u7684cost.\u679a\u4e3e\u4ece\u54ea\u4e2a\u8f66\u8f6c\u8fc7\u6765\u7684.\n$$\ndp_i=\\min_{T(j)\\leq S(i),from(i)=to(j)}(dp_j+A(S_i-T_j)^2+B(S_i-T_j)+C)\n$$\n\u4e8e\u662f\u5f97\u5230\u4f18\u79c0\u7684$O(m^2)$\u505a\u6cd5.  \n\n\u968f\u4fbf\u52a0\u4e00\u4e2a$trans(0)=(1,1,0,0)$\u65b9\u4fbf\u7edf\u4e00\u8f6c\u79fb\u65b9\u7a0b...  \ninit:$dp(0)=0$  \nans:$\\min(dp_i+T(i))\\,where\\, to(i)=n$.\n\n\n-----\n\n### \u4e00\u4e9b\u5e38\u89c4\u4f18\u5316\n\u6211\u4eec\u8f6c\u79fb\u7684\u987a\u5e8f\u6309\u7167\u53d1\u8f66\u65f6\u95f4\u987a\u5e8f\u7684\u8bdd,\u4e00\u5b9a\u4e0d\u4f1a\u7528\u5230\u672a\u8ba1\u7b97\u7684\u72b6\u6001.\u5e76\u4e14,\u8003\u8651\u4e00\u4e9b$from$\u76f8\u540c\u7684$trans$,\u5b83\u4eec\u53ef\u7528\u7684\u8f6c\u79fb\u96c6\u5408\u662f\u968f\u7740$S$\u589e\u5927\u800c\u6269\u5927\u7684.  \n\n(\u5f00\u59cb\u5c1d\u8bd5\u8f6c\u5316\u6210\u5b9a\u659c\u7387\u5207\u51f8\u5305\u95ee\u9898)\u5bf9\u4e8e\u8f6c\u79fb\u5f0f\u5b50,\u62c6\u5f00\u5e73\u65b9,\u6309\u7167\u53d8\u91cf\u6570\u91cf\u5206\u7c7b,\u627e\u51e0\u4f55\u610f\u4e49.\n$$\n(dp_j+AT_j^2-BT_j)-(2AS_i)T_j+(C+BS_i+AS_i^2)\n$$\n\n\u4ee4$Y_j=(dp_j+AT_j^2-BT_j)$,  \n$k_i=(2AS_i)$,  \n$X_j=T_j$\n\n\u8f6c\u79fb\u53d8\u6210\u4e86$Y_j-k_i\\times X_j+(QAQ)$\u5c31\u662f\u4e00\u4e2a\u659c\u7387\u786e\u5b9a\u7684\u76f4\u7ebf,\u8fc7\u4e00\u4e9b\u70b9\u5212\u7ebf,\u4f7f\u5f97\u7eb5\u622a\u8ddd\u6700\u5c0f\u5316.  \n\u8fd9\u662f\u4e2a\u7ecf\u5178\u95ee\u9898,\u6211\u4eec\u7ef4\u62a4$(X,Y)$\u70b9\u96c6\u7684\u4e0b\u51f8\u58f3,\u8003\u8651\u76f8\u90bb\u4e24\u70b9\u7684\u8fde\u7ebf\u659c\u7387,\u62ff\u7740$k_i$\u4e0a\u53bb\u4e8c\u5206\u5c31\u884c\u4e86qwq.\u753b\u4e2a\u56fe\u4f1a\u5f88\u6e05\u6670.  \n\n\u7136\u540e\u5c31\u9700\u8981\u5199\u52a8\u6001\u51f8\u5305\u4e86(\u5927\u96fe)\n\n\u6211\u4eec\u662f\u6309\u7167$S_i$\u6392\u5e8f\u8fdb\u884c\u8f6c\u79fb\u7684,\u4f46\u662f\u6a2a\u5750\u6807\u662f$T$\u5e76\u4e0d\u662f\u5355\u8c03\u7684...\u4f46\u662f\u8d77\u59cb\u8fd9\u95ee\u9898\u4e0d\u5b58\u5728...\u8003\u8651\u4e00\u4e2a$(from,to,S,T)$\u5b83\u53ea\u4f1a\u88ab$S(i)=T$\u7684$i$\u7528\u5230,\u628a\u8fd9\u4e9b\u70b9\u5b58\u5728$convex\\_hull(T)$\u5904\u5373\u53ef,\u521a\u521a\u8bf4\u8fc7,\u53ef\u7528\u7684\u8f6c\u79fb\u5bf9\u4e8e\u8d77\u70b9\u786e\u5b9a\u7684\u4e00\u4e9b\u72b6\u6001\u800c\u8a00,\u662f\u4e0d\u65ad\u6269\u5927\u7684,\u6240\u4ee5\u8fd9\u4e2a\u4e1c\u897f\u5e76\u6ca1\u6709\u5220\u9664...  \n\n\n\u5269\u4e0b\u7684\u4e1c\u897f\u5c31\u662f\u5b9e\u73b0\u6280\u5de7\u4e86...think twice,code once,\u628a\u4e1c\u897f\u5c01\u88c5\u597d...\u4e0d\u8981\u6ee1\u5c4f\u5e55\u98de\u7740\u4e0d\u660e\u6240\u4ee5\u7684\u6570\u7ec4\u4e0b\u6807,\u4e0d\u7136\u5f88\u5bb9\u6613\u641e\u51fa`a[b[x]+1],a[b[x+1]]`\u7684\u95ee\u9898...\n\n\n\n\n```cpp\n#include <bits/stdc++.h>\nint read(){\n\tint x=0;char c;\n\tdo{c=getchar();}while(!isdigit(c));\n\tdo{x=x*10+c-'0';c=getchar();}while(isdigit(c));\n\treturn x;\n}\ntypedef long long Int;\nconst int N=200000+10;\nconst Int INF=Int(1e18);\nint n,m,cur[N]; std::vector<int> at[N];\nstruct T{ int x,y,s,t;\n\tbool operator<(const T&rhs)const{return s<rhs.s;}\n}tr[N];\nInt dp[N],A,B,C;\nInt cost(Int t){ return A*t*t+B*t+C; }\nbool cmp_end_time(int a,int b){ return tr[a].t<tr[b].t; }\n\nstruct Vec{ Int x,y; Vec(Int a,Int b):x(a),y(b){} };\nVec operator-(const Vec&a,const Vec&b){ return Vec(a.x-b.x,a.y-b.y); }\nInt cross(const Vec&a,const Vec&b){ return a.x*b.y-a.y*b.x; }\nVec get(int i){Int t=tr[i].t; return Vec(t,dp[i]-B*t+A*t*t); }\n\ntypedef std::vector<int> Con;\nCon q[N];int ql[N],qr[N];\nint size(int pos){ return qr[pos]-ql[pos]; }\nvoid push(int pos,int i){\n\tif(dp[i]>=INF) return;\n\tCon &qq=q[pos]; int &r=qr[pos];\n\twhile(size(pos)>0&&tr[qq[r-1]].t==tr[i].t){\n\t\tif(get(i).y<get(qq[r-1]).y) r--;\n\t\telse return ;\n\t}\n\twhile(size(pos)>1&&cross(get(qq[r-1])-get(qq[r-2]),get(i)-get(qq[r-1]))<=0) r--;\n\tif(qq.size()<=r) qq.push_back(0);\n\tqq[r++]=i;\n}\n\nInt calc(int i,int j){ return dp[j]+cost(tr[i].s-tr[j].t); }\n\nint main(){\n\tfreopen(\"route.in\",\"r\",stdin); freopen(\"route.out\",\"w\",stdout);\n\tn=read();m=read(); A=read();B=read();C=read();\n\ttr[0].x=tr[0].y=1; tr[0].s=tr[0].t=0;\n\tfor(int i=1;i<=m;i++){\n\t\ttr[i].x=read(); tr[i].y=read();\n\t\ttr[i].s=read(); tr[i].t=read();\n\t} std::sort(tr,tr+m+1);\n\tfor(int i=0;i<=m;i++){ at[tr[i].y].push_back(i); dp[i]=INF; }\n\tfor(int i=1;i<=n;i++) std::sort(at[i].begin(),at[i].end(),cmp_end_time);\n\n\tdp[0]=0; for(int id=1;id<=m;id++){\n\t\tint x=tr[id].x,s=tr[id].s;\n\t\tCon &qq=q[x];\n\t\tfor(int &i=cur[x];i<at[x].size()&&tr[at[x][i]].t<=s;i++) push(x,at[x][i]);\n\t\twhile(size(x)>1&&cross(get(qq[ql[x]+1])-get(qq[ql[x]]),Vec(1,2*A*s))>=0) ql[x]++;\n\t\tif(size(x)>0){ int j=qq[ql[x]]; dp[id]=dp[j]+cost(s-tr[j].t); }\n\t}\n\tInt ans=INF;\n\tfor(int i=0;i<at[n].size();i++) ans=std::min(ans,dp[at[n][i]]+tr[at[n][i]].t);\n\tstd::cout<<ans<<std::endl;\n\tstd::cerr<<ans<<std::endl;\n\treturn 0;\n}\n\n```\n\n\n\n",
        "postTime": 1580825087,
        "uid": 15295,
        "name": "hehelego",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5468 \u3010[NOI2019]\u56de\u5bb6\u8def\u7ebf\u3011"
    },
    {
        "content": "# \u9898\u76ee\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[\u70b9\u8fd9\u91cc](https://www.luogu.org/problem/P5468)\u770b\u9898\u76ee\u3002  \n# \u5206\u6790\n### \u66b4\u529b\u65b9\u6cd51  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u7531\u4e8e\u65f6\u95f4\u6bd4\u8f83\u5c0f\uff0c\u6240\u4ee5\u6211\u4eec\u5efa\u5206\u5c42\u56fe\u8dd1$Dijkstra$\uff0c\u4e00\u5c42\u56fe\u5c31\u662f\u65f6\u95f4\u523b\u5ea6\u4e0a\u7684\u4e00\u4e2a\u5256\u9762\u3002\u636e\u8bf4\u5728\u8003\u573a\u4e0a\u53ef\u4ee5\u8fc7\uff08\uff01\uff01\uff01\uff09\uff0c\u4f46\u662f\u6d1b\u8c37.....\u592a\u72e0\u4e86\u3002  \n### \u66b4\u529b\u65b9\u6cd52\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u4e5f\u8bb8\u4f60\u60f3\u5230\u4e86$DP$\uff1f  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u7531\u4e8e\u65f6\u95f4\u6bd4\u8f83\u5c0f\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u5199\u72b6\u6001\uff1a  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$DP(j, i)$\uff1a$j$\u65f6\u523b\u5728$i$\u7ad9\u4e0a\u7684\u6700\u5c0f\u7684\u70e6\u8e81\u503c\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u4e0d\u96be\u770b\u51fa\uff0c\u7531\u4e8e$\\forall i, p_i<q_i$\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u628a\u5217\u8f66\u6309\u7167\u7ec8\u6b62\u65f6\u95f4\u6392\u4e00\u6ce2\u5e8f\uff0c\u8fd9\u6837$DP$\u5c31\u662f\u6709\u5e8f\u7684\u4e86\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u8f6c\u79fb\u65b9\u7a0b\u957f\u8fd9\u4e2a\u6837\u5b50\uff1a  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$\\forall i\\in[1,m],\\forall j\\in[0,p_i], DP(j,x_i)=\\min\\{DP(q_i,y_i)+A(p_i-j)^2+B(p_i-j)+C\\}$  \n### \u53ef\u884c\u7684\u66b4\u529b\u89e3\u6cd5  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u4ea4\u4e0a\u53bb\u4e4b\u540e\u4f60\u5c31\u4f1a\u53d1\u73b0$DP\\ MLE$\u4e86\u3002\u7a7a\u95f4\u590d\u6742\u5ea6\u662f$O(nt)$\u7684\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u7136\u800c\u6211\u4eec\u53d1\u73b0\uff0c$DP$\u4e2d\u5176\u5b9e\u6709\u975e\u5e38\u591a\u7684\u65e0\u7528\u7684\u72b6\u6001\u3002\u8003\u5bdf\u6211\u4eec\u7684$DP$\u65b9\u7a0b\uff0c\u53ea\u6709\u5217\u8f66\u7684\u53d1\u8f66\u65f6\u95f4\u548c\u5230\u7ad9\u65f6\u95f4\u662f\u6709\u7528\u7684\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u5bf9\u8fd9\u4e9b\u65f6\u95f4\u8fdb\u884c$DP$\u5c31\u53ef\u4ee5\u4e86\u3002\u8ba1\u7b97\u4e00\u4e0b\uff0c\u7a7a\u95f4\u964d\u5230\u4e86$O(2m)$......\u5427\u3002~~\u6211\u7b97\u4e0d\u6e05\u695a\u8fd9\u79cd\u4e1c\u897f~~  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u65f6\u95f4\u8fd8\u662f$O(m\\log_2m+mt)$\u3002  \n### \u6b63\u89e3  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$DP$\u65b9\u7a0b\u4e2d\u7684\u82b1\u8d39\u6bd4\u8f83\u7279\u6b8a\uff0c\u662f\u4e8c\u6b21\u7ed3\u6784\uff0c\u6240\u4ee5\u53ef\u4ee5\u8003\u8651\u659c\u7387\u4f18\u5316\u3002\u65f6\u95f4\u662f$O(m\\log_2m)$\uff08\u5168\u662f\u6392\u5e8f\u7684\u65f6\u95f4\uff09\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~~\u4e8e\u662f\u6211\u8fd8\u662f\u5199\u7684\u53ef\u884c\u7684\u66b4\u529b\u3002~~  \n# \u4ee3\u7801\n```cpp\n#include <cstdio>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\ntypedef long long LL;\n\n#ifdef _DEBUG\nconst int MAXN = 15, INF = 1e3;\n#else\nconst int MAXN = 1e5 + 5, INF = 0x3f3f3f3f;\n#endif\nconst int MAXT = 1e3 + 5, MAXM = 2e5 + 5; \n\ntemplate<typename _T>\nvoid read( _T &x )\n{\n\tx = 0;char s = getchar();int f = 1;\n\twhile( s > '9' || s < '0' ){if( s == '-' ) f = -1; s = getchar();}\n\twhile( s >= '0' && s <= '9' ){x = ( x << 3 ) + ( x << 1 ) + ( s - '0' ), s = getchar();}\n\tx *= f;\n}\n\ntemplate<typename _T>\nvoid write( _T x )\n{\n\tif( x < 0 ){ putchar( '-' ); x = ( ~ x ) + 1; }\n\tif( 9 < x ){ write( x / 10 ); }\n\tputchar( x % 10 + '0' );\n}\n\ntemplate<typename _T>\n_T MAX( const _T a, const _T b )\n{\n\treturn a > b ? a : b;\n}\n\ntemplate<typename _T>\n_T MIN( const _T a, const _T b )\n{\n\treturn a < b ? a : b;\n}\n\nvector<int> vec[MAXN], t[MAXN];\n\nvector<int> DP[MAXN];\nint seq[MAXM];\nint x[MAXM], y[MAXM], p[MAXM], q[MAXM];\nint N, M, A, B, C;\n\nbool cmp( const int &x, const int &y ) { return p[x] < p[y]; }\nint f( const int x ) { return 1ll * A * x * x + 1ll * B * x + C; }\n\nint main()\n{\n\tint mx = -1;\n\tread( N ), read( M ), read( A ), read( B ), read( C );\n\tfor( int i = 1 ; i <= M ; i ++ )\n\t\tseq[i] = i, read( x[i] ), read( y[i] ), read( p[i] ), read( q[i] ), mx = MAX( mx, q[i] ), \n\t\tvec[x[i]].push_back( p[i] ), vec[y[i]].push_back( q[i] );\n\tsort( seq + 1, seq + 1 + M, cmp );\n\tvec[1].push_back( 0 );\n\tfor( int i = 1 ; i <= N ; i ++ )\n\t{\n\t\tsort( vec[i].begin(), vec[i].end() );\n\t\tif( vec[i].empty() ) continue;\n\t\tt[i].push_back( vec[i][0] );\n\t\tfor( int j = 1 ; j < vec[i].size() ; j ++ )\n\t\t\tif( vec[i][j] ^ vec[i][j - 1] )\n\t\t\t\tt[i].push_back( vec[i][j] );\n//\t\tfor( int j = 0 ; j < t[i].size() ; j ++ )\n//\t\t\twrite( t[i][j] ), putchar( ' ' );\n//\t\tputs( \"\" );\n\t}\n\tfor( int i = 0 ; i < t[N].size() ; i ++ ) \n\t\tDP[N].push_back( t[N][i] );\n\tfor( int i = 1 ; i < N ; i ++ )\n\t\tfor( int j = 0 ; j < t[i].size() ; j ++ )\n\t\t\tDP[i].push_back( INF );\n\tfor( int i = M, u, z ; i ; i -- )\n\t{\n\t\tu = seq[i];\n\t\tfor( z = 0 ; z < t[y[u]].size() && t[y[u]][z] < q[u] ; z ++ );\n\t\tfor( int j = 0 ; j < t[x[u]].size() && t[x[u]][j] <= p[u] ; j ++ )\n\t\t\tDP[x[u]][j] = MIN( DP[x[u]][j], DP[y[u]][z] + f( p[u] - t[x[u]][j] ) );\n\t}\n\twrite( DP[1][0] ), putchar( '\\n' );\n\treturn 0;\n}\n```",
        "postTime": 1571722201,
        "uid": 123809,
        "name": "crashed",
        "ccfLevel": 0,
        "title": "[NOI2019]\u56de\u5bb6\u8def\u7ebf"
    },
    {
        "content": "\u849f\u84bb\u7adf\u7136\u80fd\u8fc7\u4e00\u9898\uff0c\u53ef\u80fd\u6570\u636e\u6bd4\u8f83\u6c34qwq\n\n\u6211\u4eec\u9009\u62e9dp\n\n$f[i][j]$ \u8868\u793a \u5728 \u65f6\u95f4 $j$ \u5230\u8fbe $i$ \u70b9 \u6700\u5c0f\u7684\u70e6\u8e81\u503c\n\n\u6240\u4ee5$f[edge[i].y][edge[i].q]=min$($f[edge[i].x][j]+val(edge[i].p-j$ ) )\n\n\u8bb0\u5f97\u6309\u7ed3\u675f\u65f6\u95f4\u6392\u5e8f\uff0c\u4e0d\u7136\u4f1a\u51fa\u73b0\u7ee7\u627f\u95ee\u9898\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n#include<queue>\nusing namespace std;\nconst int maxn = 4001;\nconst int INF = 2147483647;\nconst int maxtime = 1001;\n\nstruct node\n{\n\tint from,to,next,st,en;\n}edge[2*maxn];\nint cnt;\nint n,m,a,b,c;\nlong long f[maxn][maxtime];\nint tmax = -INF;\n\nvoid add(int from,int to,int st,int en)\n{\n\tedge[++cnt].to=to;\n\tedge[cnt].from=from;\n\tedge[cnt].st=st;\n\tedge[cnt].en=en;\n}\n\nbool cmp1(node a,node b){return a.en<b.en;}\n\nint val(int x){return a*x*x+b*x+c;}\n\nint main()\n{\n\tscanf(\"%d%d%d%d%d\",&n,&m,&a,&b,&c);\n\tmemset(f,-1,sizeof(f));\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint x,y,st,en;\n\t\tscanf(\"%d%d%d%d\",&x,&y,&st,&en);\n\t\t\n\t\tif(x==1)\n\t\t\tf[y][en]=val(st);\n\t\telse add(x,y,st,en);\n\t\ttmax=max(tmax,en);\n\t}\n\tsort(edge+1,edge+1+cnt,cmp1);\n\t\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\t\n\t\tint from=edge[i].from,to=edge[i].to\uff0cst=edge[i].st\uff0cen=edge[i].en;\n\t\tfor(int j=1;j<=st;j++)\n\t\t{\n\t\t\tif(f[from][j]!=-1)\n\t\t\t{\n\t\t\t\tif(f[to][en]!=-1)f[to][en]=min(f[to][en],f[from][j]+val(st-j));\n\t\t\t\telse f[to][en]=f[from][j]+val(st-j);\n\t\t\t}\n\t\t}\n\t}\n\tint ans=INF;\n\tfor(int i=1;i<=tmax;i++)\n\t{\n\t\tif(f[n][i]!=-1)\n\t\tans=min(ans,f[n][i]+i);\n\t}\n\tcout<<ans;\n}\n```\n",
        "postTime": 1563413312,
        "uid": 44966,
        "name": "zwjdd",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5468 \u3010[NOI2019]\u56de\u5bb6\u8def\u7ebf\u3011"
    },
    {
        "content": "\u611f\u89c9\u6839\u672c\u6ca1\u6709\u5176\u4ed6\u9898\u89e3\u8bf4\u7684\u90a3\u4e48\u590d\u6742\uff0c\u76f4\u63a5\u641c\u5c31\u597d\u4e86\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nstruct node\n{\n    int from;\n    int to;\n    int from_time;\n    int to_time;\n    node()\n    {\n    }\n    node(int _a,int _b,int _c,int _d)\n    {\n        from=_a,to=_b,from_time=_c,to_time=_d;\n    }\n}q[200005];\nbool cmp(node x,node y)\n{\n    if (x.from_time==y.from_time) return x.to_time<y.to_time;\n    return x.from_time<y.from_time;\n}\nint read()\n{\n    int x=0;\n    bool f=0;\n    char c=getchar();\n    while(!isdigit(c))\n    {\n        if(c=='-')f=1;\n        c=getchar();\n    }\n    while(isdigit(c))\n    {\n        x=x*10+c-'0';\n        c=getchar();\n    }\n    if(f)x=-x;\n    return x;\n}\nlong long n,m,A,B,C,vis[100005][55],sum[100005][55],cnt[100005];\nlong long ans=1e18;\nint main() {\n    memset(vis,0x7fffffffffffffff,sizeof(vis));\n    memset(sum,0x7fffffffffffffff,sizeof(sum));\n    vis[1][1]=0;\n    sum[1][1]=0;\n    cnt[1]=1;\n    cin>>n>>m>>A>>B>>C;\n    for (int i=0;i<m;i++)\n    {\n        int a=read(),b=read(),c=read(),d=read();\n        q[i]=node(a,b,c,d);\n    }\n    sort(q,q+m,cmp);\n    for (int i=0;i<m;i++)\n    {\n        long long minn=0x7fffffffffffffff;\n        for (int j=1;j<=cnt[q[i].from];j++)\n        {\n            if (vis[q[i].from][j]>q[i].from_time) continue;\n            int y=q[i].from_time-vis[q[i].from][j];\n            minn=min(minn,(long long)sum[q[i].from][j]+(long long)A*y*y+(long long)B*y+C);\n        }   \n        if (minn!=(long long)0x7fffffffffffffff)\n        {\n            sum[q[i].to][++cnt[q[i].to]]=minn;\n            vis[q[i].to][cnt[q[i].to]]=q[i].to_time;\n        }\n    }\n    for (int i=1;i<=cnt[n];i++)\n    {\n        ans=min(ans,sum[n][i]+vis[n][i]);\n    }\n    cout<<ans<<endl;\n    return 0;\n}\n```\n",
        "postTime": 1563409852,
        "uid": 68030,
        "name": "serverkiller",
        "ccfLevel": 0,
        "title": "QwQ"
    },
    {
        "content": "\u540c\u6b65\u8d5b\u65f6\u770b\u5230$m \\leq 2\\times 10 ^ 5, q_i \\leq 1000$\u7684\u6211\u7075\u5149\u4e00\u95ea\uff0c\u4ea4\u4e86\u4e2a$\\mathrm{O}(mt)$\u7684\u5927\u66b4\u529b\u7136\u540e$\\mathrm{AC}$\u6b64\u9898\n\n\u8bbe$f[i][j]$\u8868\u793a\u5f53\u524d\u5728\u7b2c$i$\u4e2a\u7ad9\u70b9\uff0c\u65f6\u523b\u4e3a$j$\u7684\u6700\u5c0f\u70e6\u8e81\u5ea6\uff0c$F(x) = Ax^2 + Bx + C$\u3002\n\n\u7136\u540e\u679a\u4e3e\u6bcf\u4e00\u6761\u8fb9$i$\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a$f[y_i][j] = \\min\\{f[x_i][p_i] + F(j - q_i)\\}$\u3002\n\n\u76f4\u63a5$\\mathrm{DP}$\u5373\u53ef\u3002\n\n```cpp\n#include <cstdio>\n#include <algorithm>\n\ninline int read()\n{\n\tint data = 0, w = 1; char ch = getchar();\n\twhile (ch != '-' && (ch < '0' || ch > '9')) ch = getchar();\n\tif (ch == '-') w = -1, ch = getchar();\n\twhile (ch >= '0' && ch <= '9') data = data * 10 + (ch ^ 48), ch = getchar();\n\treturn data * w;\n}\n\nconst int maxn(1e5 + 10), maxm(2e5 + 10), T(1010), INF(0x3f3f3f3f);\nint n, m, A, B, C, maxQ, f[maxn][T];\nstruct node { int x, y, p, q; } L[maxm];\ninline int operator < (const node &lhs, const node &rhs) { return lhs.q < rhs.q; }\ninline int F(int x) { return x * x * A + x * B + C; }\n\nvoid solve()\n{\n\tfor (int i = 1; i <= n; i++)\n\t\tfor (int j = 1; j <= maxQ; j++) f[i][j] = INF;\n\tfor (int j = 0; j <= maxQ; j++) f[1][j] = F(j);\n\tfor (int i = 1; i <= m; i++)\n\t{\n\t\tint x = L[i].y;\n\t\tfor (int j = L[i].q; j <= maxQ; j++)\n\t\t\tf[x][j] = std::min(f[x][j], f[L[i].x][L[i].p] + F(j - L[i].q));\n\t}\n\tint ans = INF;\n\tfor (int j = 1; j <= maxQ; j++)\n\t\tans = std::min(ans, f[n][j] + j - C);\n\tprintf(\"%d\\n\", ans);\n}\n\nint main()\n{\n\tn = read(), m = read(), A = read(), B = read(), C = read();\n\tfor (int i = 1; i <= m; i++) L[i] = (node) {read(), read(), read(), read()};\n\tfor (int i = 1; i <= m; i++) maxQ = std::max(maxQ, L[i].q);\n\tstd::sort(L + 1, L + m + 1), solve();\n\treturn 0;\n}\n```",
        "postTime": 1563369269,
        "uid": 46800,
        "name": "xgzc",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5468 \u3010[NOI2019]\u56de\u5bb6\u8def\u7ebf\u3011"
    },
    {
        "content": "\u5f53\u65f6\u6253\u540c\u6b65\u8d5b\u65f6\u7528\u7684\u66b4\u529bdfs\uff0c\u624d95\u5206\uff0cWA\u63891\u4e2a\u70b9\u3002\u540e\u6765\u60f3\u4e86\u60f3\uff0c\u8fd9\u9898\u53ef\u4ee5\u7528SPFA\u6700\u77ed\u8def\u8fc7\u3002\n\n\u8bbe$dis[x][y]$\u8868\u793a\u5728$x$\u65f6\u95f4\uff0c\u4ece$1$\u7ad9\u70b9\u5230$y$\u7ad9\u70b9\u7684\u6700\u5c0f\u70e6\u8e81\u503c\uff0c\u5c31\u53ef\u4ee5\u7528SPFA\u6765\u505a\u5566~\n\n\u5177\u4f53\u5206\u6790\u770b\u4ee3\u7801\uff1a\n\n---\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<queue>\n#include<cstring>\nusing namespace std;\nint n,m,aa,bb,cc;\nint anss=999999999;\nstruct T{\n\tint u;\n\tint v;\n\tint st;\n\tint ed;//st\u662f\u5f00\u59cb\u65f6\u95f4\uff0ced\u662f\u5230\u8fbe\u65f6\u95f4\n\tbool operator <(const T& a) const {\n\t\treturn u<a.u;\n\t}//\u66b4\u529b\u65f6\u7528\u7684\uff0c\u61d2\u5f97\u5220\u6389\u3002\n}tr[200010];\nint nxt[200010],fst[100010];\nbool bo[1001][100001];//\u6807\u8bb0\u65f6\u95f4x\uff0c\u7ad9\u70b9y\u6709\u6ca1\u6709\u5230\u8fbe\u8fc7\u3002\nint dis[1001][100001];//\nqueue<int>q;//spfa\u961f\u5217\uff0c\u5b58\u70b9\nqueue<int>tim;//\u5b58\u65f6\u95f4\ninline int hs(int x){\n\treturn aa*x*x+bb*x+cc;\n}//\u7b97\u70e6\u8e81\u503c\nint main() {\n\tmemset(dis,0x7f,sizeof(dis));\n\tscanf(\"%d%d%d%d%d\",&n,&m,&aa,&bb,&cc);\n\tfor(int i=1;i<=m;i++){\n\t\tscanf(\"%d%d%d%d\",&tr[i].u,&tr[i].v,&tr[i].st,&tr[i].ed);\n\t\tnxt[i]=fst[tr[i].u];\n\t\tfst[tr[i].u]=i;//\u90bb\u63a5\u8868\u5b58\u56fe\n\t}\n\tq.push(1);\n\ttim.push(0);\n\tbo[0][1]=1;\n\tdis[0][1]=0;//\u521d\u59cb\u5316\n\twhile(!q.empty()){\n\t\tint x=q.front();\n\t\tint ti=tim.front();\n\t\tq.pop();\n\t\ttim.pop();\n\t\tbo[ti][x]=0;\n\t\tfor(int k=fst[x];k;k=nxt[k]){\n\t\t\tif(tr[k].st<ti) continue;\n\t\t\tif(tr[k].v==n){//\u5224\u65ad\u4e00\u4e0b\uff0c\u5982\u679c\u5230\u8fben\u7ad9\u70b9\u8fd8\u8981\u52a0\u4e0a\u5f53\u524d\u65f6\u95f4\n\t\t\t\tif(dis[tr[k].ed][tr[k].v]>dis[ti][x]+hs(tr[k].st-ti)+tr[k].ed){\n\t\t\t\t\tdis[tr[k].ed][tr[k].v]=dis[ti][x]+hs(tr[k].st-ti)+tr[k].ed;\n\t\t\t\t\tif(!bo[tr[k].ed][tr[k].v]){\n\t\t\t\t\t\tbo[tr[k].ed][tr[k].v]=1;\n\t\t\t\t\t\tq.push(tr[k].v);\n\t\t\t\t\t\ttim.push(tr[k].ed);\n\t\t\t\t\t}\n\t\t\t\t} \n\t\t\t}\n\t\t\telse {\n\t\t\t\tif(dis[tr[k].ed][tr[k].v]>dis[ti][x]+hs(tr[k].st-ti)){//\u5982\u679c\u5728\u5f53\u524d\u706b\u8f66\u5230\u8fbe\u7684\u65f6\u95f4\u5230tr[k].v\u7ad9\u70b9\u7684\u6700\u5c0f\u70e6\u8e81\u503c\u5927\u4e8e\u5f53\u524d\u7ad9\u70b9\u7684\u70e6\u8e81\u503c\uff0c\u5c31\u53ef\u4ee5\u677e\u5f1b\u3002\n\t\t\t\t\tdis[tr[k].ed][tr[k].v]=dis[ti][x]+hs(tr[k].st-ti);\n\t\t\t\t\tif(!bo[tr[k].ed][tr[k].v]){\n\t\t\t\t\t\tbo[tr[k].ed][tr[k].v]=1;\n\t\t\t\t\t\tq.push(tr[k].v);\n\t\t\t\t\t\ttim.push(tr[k].ed);\n\t\t\t\t\t}\n\t\t\t\t} \t\n\t\t\t}\n\t\t}\n\t}\n\tanss=999999999;\n\tfor(int k=1;k<=m;k++){\n\t\tif(tr[k].v==n){\n\t\t\tanss=min(anss,dis[tr[k].ed][n]);\n\t\t}//\u5224\u65ad\u4e00\u4e0b\uff0c\u56e0\u4e3a\u53ef\u80fd\u6709\u5f88\u591a\u4e2a\u65f6\u523b\u90fd\u53ef\u4ee5\u5230\u8fbe\u7ec8\u70b9\uff0c\u9700\u8981\u53d6\u6700\u5c0f\u503c\u3002\n\t}\n\tcout<<anss;//\u8f93\u51fa\n\treturn 0;\n}\n\n```\n\n---",
        "postTime": 1563279247,
        "uid": 56565,
        "name": "Stella_Yan",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P5468 \u3010[NOI2019]\u56de\u5bb6\u8def\u7ebf\u3011"
    },
    {
        "content": "\u5b89\u5229\u4e00\u4e0b\u535a\u5ba2:[\u6233\u6211](http://ljf-cnyali.cn/2019/07/16/NOI2019%E5%9B%9E%E5%AE%B6%E8%B7%AF%E7%BA%BF-DP/)\n\n### \u601d\u8def\u5386\u7a0b\n\n* \u9996\u5148\u770b\u5230\u9898\u76ee\u7acb\u523b\u60f3\u5230\u6700\u77ed\u8def\uff0c\u53ef\u4ee5\u5efa\u8fb9\u7136\u540e\u5728\u6b63\u5e38\u7684\u6700\u77ed\u8def\u4e0a\u52a0\u4e00\u7ef4$dis[i][j]$\u8868\u793a\u5230\u8fbe\u7ad9\u70b9$i$\u65f6\u95f4\u4e3a$j$\u7684\u6700\u5c0f\u70e6\u8e81\u503c\uff0c\u7136\u540e\u60f3\u4e86\u4e00\u4e0b\u5efa\u8fb9\u6700\u5dee$m^2$\uff0c\u518d\u52a0\u4e0a\u4e00\u4e2a\u6700\u77ed\u8def\u4f1a\u8dd1\u5f97\u5f88\u6162\u4e00\u70b9\u90fd\u4e0d\u7a33\u5b9a(\u6211\u4eec\u673a\u623f\u6709\u4eba\u5199\u4e86~~85~~\u6216~~95~~\uff0c\u4e00\u8138\u5fe7\u90c1)\n* \u63a5\u4e0b\u6765\u53d1\u73b0DFS\u53ef\u80fd\u5f88\u4f18\u79c0...(\u8c01\u77e5\u9053\u53ef\u4ee5\u8dd1~~\u6ee1\u5206~~)\uff0c\u4f46\u662f\u56e0\u4e3a\u590d\u6742\u5ea6\u592a\u7384\u5b66\u4e0d\u6562\u4e71\u641e\n\n* \u8003\u8651DP\uff0c\u6211\u4eec\u4ee4$dp[i][j]$\u540c\u6837\u8868\u793a\u7ad9\u70b9$i$\u65f6\u95f4\u4e3a$j$\u7684\u6700\u5c0f\u70e6\u8e81\u503c\uff0c\u7136\u540e\u8003\u8651\u679a\u4e3e$i$\u4ece$[1,m]$\uff0c$j$\u4ece$[0,a[i].p)$\uff0c\u7136\u540e\u5bf9\u4e8e\u6709\u65b9\u7a0b$dp[a[i].y][a[i].q]=min(dp[a[i].x][j]+js(j,a[i].p))$\u5176\u4e2d$js$\u4e3a\u9898\u76ee\u4e2d\u7684\u65b9\u7a0b\n* \u53d1\u73b0\u8fd9\u4e2a\u7b97\u6cd5\u663e\u7136\u662f\u6709\u540e\u6548\u6027\u7684\uff0c\u56e0\u4e3a\u53ef\u4ee5\u4ece\u540e\u9762\u7684\u7ad9\u70b9\u79fb\u52a8\u5230\u524d\u9762\u7684\u7ad9\u70b9\uff0c\u5373$a[i].x>a[i].y$\n* \u53ef\u4ee5\u601d\u8003\u4ee5$a[i].q$\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u6709\u540e\u6548\u6027\u7684\u95ee\u9898\uff0c\u56e0\u4e3a\u524d\u9762\u7684\u65f6\u95f4\u4e0d\u4f1a\u5bf9\u540e\u9762\u7684\u9020\u6210\u5f71\u54cd\uff0c\u65f6\u7a7a\u590d\u6742\u5ea6\u5747\u4e3a$O(mt)$\uff0c\u8fd9\u6837\u5c31\u5b8c\u7f8e\u7684\u83b7\u5f9770\u5206\u7684\u597d\u6210\u7ee9\n* \u8003\u8651\u7b97\u6cd5\u74f6\u9888\u5728\u4e8e\u7a7a\u95f4\u590d\u6742\u5ea6\u8fc7\u9ad8\uff0c\u5f00$long long$\u4f1a\u5bfc\u81f4$800MB$\u7684\u7a7a\u95f4\uff0c\u6211\u4eec\u9700\u8981\u4f18\u5316\u7a7a\u95f4\u590d\u6742\u5ea6\n* \u56e0\u4e3a\u53d1\u73b0\u4f1a\u6709\u5f88\u591a\u65e0\u6548\u7684\u7a7a\u95f4\u635f\u8017($dp$\u6570\u7ec4\u4e2d\u6709\u5f88\u591a\u70b9\u662f$INF$\u7684)\uff0c\u5219\u4f7f\u7528$vector$\u8fdb\u884c\u6570\u7ec4\u4f18\u5316\uff0c\u6211\u4eec\u5f00\u4e00\u4e2a$10^5$\u7684$vector$\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$vector$\u5b58\u4e24\u4e2a\u503c$pos$\u548c$val$\uff0c$pos$\u8868\u793a\u539f$dp[i][j]$\u4e2d\u7684$j$\uff0c\u800c$val$\u8868\u793a\u539f$dp[i][j]$\u7684\u503c\uff0c\u5728\u679a\u4e3e$j$\u4ece$[p,a[i].p)$\u7684\u65f6\u5019\u4fee\u6539\u4e3a\u679a\u4e3e$dp[i].size()$\uff0c\u7136\u540e\u8fdb\u884c\u4fee\u6539\u5373\u53ef\n\n\u63a5\u4e0b\u6765\u55b7\u4e00\u4e0b\u8fd9\u9053\u9898\uff0c\u521a\u521a\u53d1\u73b0\u8fd9\u9053\u9898\u4e0d\u4f1a\u7206$int$\uff0c\u6240\u4ee570\u5206\u7b97\u6cd5\u5c31\u662f\u6b63\u89e3\u4e86\uff0c\u7136\u540e\u518d\u6b21\u53d1\u73b0dijsktra\u5b83\u6b7b\u4e86\uff0cspfa\u5b83\u6d3b\u4e86(dijkstra\u7206\u6808\u4ec0\u4e48\u9b3c)\uff0c\u518d\u7136\u540e\u6211\u4e5f\u4e0d\u77e5\u9053\u653eDFS\u8fc7\u4ec0\u4e48\u9b3c\uff0c\u83ca\u82b1\u56fe\u4e0d\u4f1a\u9020\uff1f\u4eca\u5e74NOI\u771f\u7684\u592a\u4ee4\u4eba\u5931\u671b\u4e86\uff0c\u771f\u7684\u9b3c\u755c...\n\n### \u4ee3\u7801\n\n```cpp\n// luogu-judger-enable-o2\n/***************************************************************\n    File name: route.cpp\n    Author: ljfcnyali\n    Create time: 2019\u5e7407\u670816\u65e5 \u661f\u671f\u4e8c 08\u65f646\u520617\u79d2\n***************************************************************/\n#include<bits/stdc++.h>\n\nusing namespace std;\n\n#define REP(i, a, b) for ( register LL i = (a), _end_ = (b); i <= _end_; ++ i ) \n#define mem(a) memset ( (a), 0, sizeof ( a ) ) \n#define str(a) strlen ( a ) \ntypedef long long LL;\n\nconst int maxn = 100010;\nconst LL INF = 10000000000000;\n\nLL n, m, A, B, C, s, t, Max, ans;\n\nstruct node\n{\n    LL x, y, p, q;\n    bool operator < (const node &a) const { return q < a.q; }\n} a[maxn << 1];\n\nstruct Node\n{\n    LL pos, val;\n} p1, p2;\n\nvector<Node> dp[maxn];\n\ninline LL js(LL x, LL y) { LL t = y - x; return t * t * A + t * B + C; }\n\nint main()\n{\n#ifndef ONLINE_JUDGE\n    freopen(\"route.in\", \"r\", stdin);\n    freopen(\"route.out\", \"w\", stdout);\n#endif\n    scanf(\"%lld%lld%lld%lld%lld\", &n, &m, &A, &B, &C);\n    REP(i, 1, m) { scanf(\"%lld%lld%lld%lld\", &a[i].x, &a[i].y, &a[i].p, &a[i].q); Max = max(Max, a[i].q); }\n    sort(a + 1, a + m + 1);\n    REP(i, 1, m) \n        if ( a[i].x == 1 ) \n        {\n            bool flag = false;\n            REP(j, 0, dp[a[i].y].size() - 1)\n            {\n                p1 = dp[a[i].y][j];\n                if ( p1.pos == a[i].q ) \n                {\n                    p1.val = min(p1.val, a[i].p * a[i].p * A + a[i].p * B + C);\n                    dp[a[i].y][j] = p1;\n                    flag = true;\n                    break ;\n                }\n            }\n            if ( flag == false ) \n            {\n                p1.pos = a[i].q; p1.val = a[i].p * a[i].p *A + a[i].p * B + C;\n                dp[a[i].y].push_back(p1);\n            }\n        }\n    REP(i, 1, m)\n    {\n        if ( a[i].x == 1 ) continue ;\n        bool flag = false;\n        REP(j, 0, dp[a[i].y].size() - 1)\n        {\n            p1 = dp[a[i].y][j];\n            if ( p1.pos == a[i].q ) \n            {\n                REP(k, 0, dp[a[i].x].size() - 1)\n                {\n                    p2 = dp[a[i].x][k];\n                    if ( p2.pos > a[i].p ) continue ;\n                    p1.val = min(p1.val, p2.val + js(p2.pos, a[i].p));\n                }\n                dp[a[i].y][j] = p1;\n                flag = true; break ;\n            }\n        }\n        if ( flag == false ) \n        {\n            p1.pos = a[i].q; p1.val = INF;\n            REP(k, 0, dp[a[i].x].size() - 1) \n            {\n                p2 = dp[a[i].x][k];\n                if ( p2.pos > a[i].p ) continue ;\n                p1.val = min(p1.val, p2.val + js(p2.pos, a[i].p));\n            }\n            dp[a[i].y].push_back(p1);\n        }\n        // dp[a[i].y][a[i].q] = min(dp[a[i].y][a[i].q], dp[a[i].x][j] + js(j, a[i].p));\n    }\n    ans = INF;\n    REP(i, 0, dp[n].size() - 1) ans = min(ans, dp[n][i].val + dp[n][i].pos);\n    printf(\"%lld\\n\", ans);\n    return 0;\n}\n```\n",
        "postTime": 1563278265,
        "uid": 8618,
        "name": "\u6c34\u5e93\u4e2d\u7684\u6c34\u5e93",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5468 \u3010[NOI2019]\u56de\u5bb6\u8def\u7ebf\u3011"
    },
    {
        "content": "\u66b4\u529b\u3002\n\n\u56e0\u4e3a\u7a7a\u95f4\u9650\u5236\u6539\u5c0f\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $O(mt)$ \u7684\u66b4\u529b\u662f\u4e0d\u80fd AC \u7684\u3002\u4f46\u662f\uff0cdp \u6570\u7ec4\u91cc\u9762\u5b58\u7684\u4e8c\u5143\u7ec4 $(\\text{\u4f4d\u7f6e\uff0c\u5230\u8fbe\u65f6\u95f4})$ \u53c8\u53ea\u6709 $O(m)$ \u79cd\u3002\u56e0\u6b64\uff0c\u5c06 dp \u6570\u7ec4\u6309\u7167\u67d0\u79cd\u65b9\u5f0f\u91cd\u7f16\u53f7\uff0c\u5f97\u5230\u7684\u7f16\u53f7\u6700\u591a\u53ea\u6709 $O(m)$ \u79cd\u3002\u8fd9\u6837\u6211\u4eec\u5c31\u628a\u7a7a\u95f4\u590d\u6742\u5ea6\u4f18\u5316\u5230\u4e86 $O(m)$\u3002\n\n\u4f46\u662f\u9700\u8981\u6ce8\u610f\uff0c\u6bcf\u4e2a\u70b9\u7684\u5230\u8fbe\u5217\u8f66\u53ef\u80fd\u8fdc\u8d85\u8fc7 $t$ \u6b21\uff0c\u56e0\u6b64\u9700\u8981\u53bb\u91cd\u3002\u4e0d\u53bb\u91cd\u7684\u8bdd\u5c31\u53ea\u80fd\u5f97\u5230 $70$ \u5206\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(nm)$\u3002\u53bb\u4e86\u91cd\uff0c\u590d\u6742\u5ea6\u5373\u4e3a $O(mt)$\u3002\n\n\u4e0d\u662f\u5f88\u61c2\u4e3a\u4ec0\u4e48\u8981\u5361\u66b4\u529b\u2026\u2026\u65e2\u7136\u9898\u76ee\u4e0a\u8bf4\u4e86 $m\\le 2\\times 10^5,t\\le 10^3$ \u5e76\u4e14\u7a7a\u95f4 512MB \u5c31\u76f8\u5f53\u4e8e\u544a\u8bc9\u6211\u4eec\u66b4\u529b\u672c\u6765\u5c31 **\u5e94\u8be5** \u8fc7\u8fd9\u9053\u9898\u3002\u90a3\u518d\u53bb\u65e0\u8c13\u5730\u5361\u7a7a\u95f4\uff08\u800c\u4e14\u4e5f\u8d77\u4e0d\u5230\u5e94\u6709\u7684\u4e0d\u8ba9\u66b4\u529b\u901a\u8fc7\u7684\u4f5c\u7528\uff09\u6709\u4f55\u610f\u4e49\u5462\uff1f\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<vector>\nusing namespace std;\nint n,m,A,B,C,cnt=0;\nstruct Thing{\n\tint x,y,p,q;\n\tbool operator <(const Thing yy) const {\n\t\treturn p<yy.p;\n\t}\n}a[200005];\nvector<int> rl[200005],id[200005];\nlong long f[200005],ans=0x3f3f3f3f3f3f3f3fll;\nint F(int x){\n\treturn A*x*x+B*x+C;\n}\nint main() {\n\tcin>>n>>m>>A>>B>>C;\n\tfor(int i=1;i<=m;i++){\n\t\tscanf(\"%d%d%d%d\",&a[i].x,&a[i].y,&a[i].p,&a[i].q);\n\t\trl[a[i].y].push_back(a[i].q);\n\t}\n\trl[1].push_back(0);\n\tfor(int i=1;i<=n;i++){\n\t\tsort(rl[i].begin(),rl[i].end());\n\t\tint tmp=unique(rl[i].begin(),rl[i].end())-rl[i].begin();\n\t\trl[i].resize(tmp);\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=0;j<rl[i].size();j++){\n\t\t\tid[i].push_back(++cnt);\n\t\t}\n\t}\n\tmemset(f,0x3f,sizeof(f));\n\tf[1]=0;\n\tsort(a+1,a+m+1);\n\tfor(int i=1;i<=m;i++){\n\t\tint fr=a[i].x,to=a[i].y,now;\n\t\tfor(int j=0;j<rl[to].size();j++)if(rl[to][j]==a[i].q)now=id[to][j];\n\t\tfor(int j=0;j<rl[fr].size();j++){\n\t\t\tif(rl[fr][j]>a[i].p)break;\n\t\t\tint ps=id[fr][j];\n\t\t\tf[now]=min(f[now],f[ps]+F(a[i].p-rl[fr][j]));\n\t\t}\n\t}\n\tfor(int i=0;i<rl[n].size();i++){\n\t\tans=min(ans,f[id[n][i]]+rl[n][i]);\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1582958728,
        "uid": 42156,
        "name": "feecle6418",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5468 \u3010[NOI2019]\u56de\u5bb6\u8def\u7ebf\u3011"
    },
    {
        "content": "$f_i$\u8868\u793a\u5230\u7b2c$i$\u4e2a\u70b9\u7684\u6700\u5c0f\u82b1\u8d39\u3002\u663e\u7136\u4ece$q_i=n$\u7684\u70b9\u7531$p_i$\u8fd9\u4e2a\u4f4d\u7f6e\u4e0a\u7684\u70b9\u5f00\u59cb\u8f6c\u79fb\uff1b\u56e0\u4e3a$p_i$\u3001$q_i$\uff0c\u8d70\u4e00\u5708\u540e\uff0c\u662f\u76f8\u5bf9\u9012\u589e\u7684\uff0c\u4e5f\u5c31\u662f\u4fdd\u8bc1\u4e86\u65f6\u95f4\u4e0a\uff0c\u8f6c\u79fb\u662f\u6ca1\u6709\u73af\u7684\uff0c\u56e0\u6b64\u8bb0\u5fc6\u5316\u4e00\u4e0b\u5c31\u53ef\u4ee5\u8fc7\u4e86\u3002\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u9898\u76ee\u91cc\u7684\u8d21\u732e\u5f0f\u5b50\u53ef\u4ee5\u8f6c\u5316\u4e00\u4e0b\uff1a\n$$q_{s_k}=\\sum_{j=1}^{k-1}(p_{j+1}-p_j)+ q_k-p_k$$\n\u539f\u9898\u8d21\u732e\u53ef\u4ee5\u53d8\u6210\uff1a\n$$(A\\times p_{s_1}^2+B\\times p_{s_1}+C)+\\sum_{j=1}^{k-1}(A(p_{s_{j+1}}-q_{s_j})^2+B(p_{s_{j+1}}-q_{s_j})+C+p_{s_{j+1}}-p_{s_j})+q_k-p_k$$\n\u72b6\u6001\u6570\u662f$O(M)$\u7684\uff0c\u5b9e\u9645\u4e0a\u8dd1\u6709\u70b9\u6162\uff0c\u4f46\u4f30\u8ba1\u8f6c\u79fb\u590d\u6742\u5ea6\u4e0d\u592a\u5bf9\uff0c~~\u4f46\u662f\u80fd\u8fc7\u5c31\u597d~~\u3002\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nusing namespace std;\ninline char gc(){\n    static char buf[1000000],*p1=buf,*p2=buf;\n    return p1==p2&&(p2=(p1=buf)+fread(buf,1,1000000,stdin),p1==p2)?EOF:*p1++;\n}\n#define getchar gc\ninline ll read() {ll x = 0;char ch = getchar(), w = 1;while(ch < '0' || ch > '9') {\nif(ch == '-') w = -1;ch = getchar();}while(ch >= '0' && ch <= '9') {x = x * 10 + ch - '0';ch = getchar();\n}return x * w;}\nvoid write(ll x) {if(x < 0) putchar('-'), x = -x;if(x > 9) write(x / 10);putchar(x % 10 + '0');}\ninline void writeln(ll x) {write(x);puts(\"\");}\nvoid setIO() {\n\tfreopen(\"route.in\",\"r\",stdin);\n\tfreopen(\"route.out\",\"w\",stdout);\n}\nconst int N = 3e5;\nint n, m;\nll A, B, C;\nstruct TT {\n\tll x, y, p, q, i;\n}a[N];\nvector<TT> pos[N];\n#define pb push_back\nll f[N];\nll cal(TT &x, TT &y) {\n\tll tim = y.p - x.q;\n\treturn A * tim * tim + B * tim + C + y.p - x.p;\n}\nconst ll inf = 1e16;\nbool vis[N];\nll dfs(TT &x) {\n\tif(x.i == 0) return 0;\n\tif(vis[x.i]) return f[x.i];\n\tvis[x.i] = 1;\n\tfor(int i = 0; i < pos[x.x].size(); ++i) {\n\t\tTT &y = pos[x.x][i];\n\t\tif(y.q <= x.p) {\n\t\t\tf[x.i] = min(f[x.i], dfs(y) + cal(y, x));\n\t\t}\n\t}\n\treturn f[x.i];\n}\nint main() {\n\tscanf(\"%d%d%d%d%d\",&n,&m,&A,&B,&C);\n\tfor(int i = 1; i <= m; ++i) {\n\t\ta[i].x = read();\n\t\ta[i].y = read();\n\t\ta[i].p = read();\n\t\ta[i].q = read();\n\t\ta[i].i = i;\n\t\tpos[a[i].y].pb(a[i]);\n\t}\n\tpos[1].pb(a[0]);\n\tfor(int i = 1; i <= m; ++i) f[i] = 1e16;\n\tll ans = 1e18;\n\tfor(int i = 0; i < pos[n].size(); ++i)\n\t\tans = min(ans, dfs(pos[n][i]) + pos[n][i].q - pos[n][i].p);\n\twriteln(ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1563321786,
        "uid": 22150,
        "name": "\u548c\u5176\u6b63",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5468 \u3010[NOI2019]\u56de\u5bb6\u8def\u7ebf\u3011"
    },
    {
        "content": "\u7b2c\u4e00\u7bc7NOI\u9898\u89e3,\u601d\u8def\u8bb2\u7684\u5f88\u660e\u767d,\u6c42\u8fc7\u4e86~\n------------\n\u9898\u610f\uff1ahttps://www.luogu.org/problemnew/show/P5468\n\n\u505a\u6cd5\u5206\u5c42\u56fe\u6700\u77ed\u8def\n\n\u9996\u5148\u5982\u679c\u6ca1\u6709\u8fd9\u53e5\u5c31\u53ef\u4ee5\u76f4\u63a5spfa\uff1a\u82e5\u5c0f\u732b\u6700\u7ec8\u5728\u65f6\u523bz\u5230\u8fben\u53f7\u7ad9\u70b9\uff0c\u5219\u70e6\u8e81\u503c\u5c06\u518d\u589e\u52a0z\n\n\u7136\u800c\u6709\u4e86\u8fd9\u53e5\u8bdd\u6211\u4eec\u7684\u7b54\u6848\u5c31\u548c\u5230\u8fbe\u65f6\u95f4T\u548c\u8def\u4e0a\u70e6\u8e81\u503c\u548cW\u4e24\u4e2a\u53d8\u91cf\u76f8\u5173,\u4f7f\u5f97\u95ee\u9898\u65e0\u6cd5\u5904\u7406\n\n\u8fd9\u65f6\u6211\u60f3\u5230\u4e86\u4e00\u9053\u8003\u8bd5DP\u9898,\u4e5f\u662f\u7b54\u6848\u548c\u4e24\u4e2a\u53d8\u91cf\u76f8\u5173,\u505a\u6cd5\u662f\u628a\u7b2c\u4e8c\u4e2a\u53d8\u91cf\u7684\u53d6\u503c\u53e6\u5f00\u4e00\u7ef4\u8bb0\u5f55\u4e0b\u6765,\u6700\u540e\u679a\u4e3e\u7b2c\u4e8c\u4e2a\u53d8\u91cf\u7684\u53d6\u503c\u66f4\u65b0\u7b54\u6848\n\n\u6211\u4eec\u5e94\u7528\u5230\u8fd9\u9053\u9898\u4e0a\uff1a\n\n\u5c06dis\u6570\u7ec4\u6269\u5c55\uff1adis[i][j]\u8868\u793a\u4ece1\u5230i,\u7528\u4e86j\u65f6\u95f4\u7684\u6700\u5c0f\u70e6\u8e81\u503c,\u6700\u540e\u5c06\u8fde\u5411n\u7684\u8fb9\u679a\u4e3e,ans=min(ans,dis[n][e[i].q]+e[i].q)\n\n\u8f6c\u79fb\u5c31\u662f\u6b63\u5e38\u7684\u677e\u5f1b\u64cd\u4f5c,\u6ce8\u610f\u5224\u4e00\u4e0b\u5f00\u8f66\u65f6\u95f4\u4e0e\u5f53\u524d\u65f6\u95f4\u7684\u5927\u5c0f,\u5982\u679c\u5230\u4e4b\u524d\u5c31\u5f00\u8f66\u4e86\u5c31continue\n\n\u8fd9\u5176\u5b9e\u662f\u5206\u5c42\u56fe\u6700\u77ed\u8def,\u53ef\u7406\u89e3\u4e3a\u5c06\u6700\u77ed\u6269\u5c55\u5230\u4e8c\u7ef4,\u8fd9\u65f6dis[i][j]\u6570\u7ec4\u5c31\u8bb0\u5f55\u4e86\u5230\u7b2cj\u5c42\u7b2ci\u70b9\u7684\u6700\u77ed\u8def\n\n\u5206\u5c42\u56fe\u6700\u77ed\u8def\u4f8b\u9898\uff1aP4568 [JLOI2011]\u98de\u884c\u8def\u7ebf\n\n\u8fd9\u4e2a\u65f6\u95f4\u590d\u6742\u5ea6\u5e94\u8be5\u662f\uff08kNL\uff09\u56e0\u4e3aN<=1e5,L(\u6700\u5927\u7684q)<=1e3\uff0c\u603b\u7684\u6700\u5927\u4e3aK* 1e8 \u5927\u529b\u5361\u4e86\u5e38 \u6700\u6162 949ms\u8fc7\u4e86\u8fd9\u9053\u9898\n\nps:\u6b63\u89e3\u659c\u7387\u4f18\u5316DP\uff0c\u5feb\u7684\u98de\u8d77\n\ncode:\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define pii pair<int,int>\n#define F first \n#define S second\n#define mp make_pair\nconst int maxn=1e5+10;\nconst int maxm=2*1e5+10;\nstruct Edge\n{\n\tint u,v,p,q;\n\tint nxt;\n}e[maxm];\nint n,m,A,B,C,ans=482302323;\nint head[maxn];\nint dis[maxn][1010];\nbool vis[maxn][1010];\ninline int read()\n{\n\tchar c=getchar();int res=0,f=1;\n\twhile(c<'0'||c>'9'){if(c=='-') f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9') res=res*10+c-'0',c=getchar();\n\treturn res*f;\n}\ninline int calc(int x){return A*x*x+B*x+C;}\nvoid spfa()\n{\n\tmemset(dis,0x3f,sizeof(dis));\n\tqueue<pii> q;\n\tdis[1][0]=0;q.push(mp(1,0));vis[1][0]=1;\n\twhile(!q.empty())\n\t{\n\t\tint x=q.front().F,w=q.front().S;\n\t\tq.pop();vis[x][w]=0;\n\t\tfor(int i=head[x];i;i=e[i].nxt)\n\t\t{\n\t\t\tif(e[i].p<w) continue;\n\t\t\tint y=e[i].v;\n\t\t\tif(dis[y][e[i].q]>dis[x][w]+calc(e[i].p-w))\n\t\t\t{\n\t\t\t\tdis[y][e[i].q]=dis[x][w]+calc(e[i].p-w);\n\t\t\t\tif(!vis[y][e[i].q]) vis[y][e[i].q]=1,q.push(mp(y,e[i].q));\n\t\t\t}\n\t\t}\n\t}\n}\nint main()\n{\n\tn=read();m=read();A=read();B=read();C=read();\n\tfor(register int i=1;i<=m;i++)\n\t{\n\t\te[i].u=read();e[i].v=read();e[i].p=read();e[i].q=read();\n\t\te[i].nxt=head[e[i].u];head[e[i].u]=i;\n\t}\n\tspfa();\n\t/*for(int i=0;i<=maxq;i++) printf(\"%d \",dis[n][i]+i);\n\tputs(\"\");*/\n\tfor(register int i=1;i<=m;i++)\n\t{\n\t\tif(e[i].v==n) ans=min(ans,dis[n][e[i].q]+e[i].q);\n\t}\n\tprintf(\"%d\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1563287016,
        "uid": 145441,
        "name": "nofind",
        "ccfLevel": 6,
        "title": "P5468 [NOI2019]\u56de\u5bb6\u8def\u7ebf(\u5206\u5c42\u56fe\u6700\u77ed\u8def)"
    },
    {
        "content": "~~\u51fa\u9898\u4eba\u592a\u61d2\u4e86~~\n\n## \u975e\u6b63\u89e3\u505a\u6cd5\n\u867d\u7136\u6253\u7684\u662f\u540c\u6b65\u8d5b\uff0c\u4f46\u662f\u5fc3\u6001\u4f9d\u7136\u5f88\u8e66\u3002\u770b\u4e86\u4e09\u9053\u9898\u540e\u89c9\u5f97\u8fd9\u9053\u9898\u662f\u6700\u7b80\u5355\u7684\uff0c\u7136\u540e\u5c31\u521a\u4e0a\u4e86\u3002\n\n\n\u524d\u4e94\u5341\u5206\u5f88\u597d\u6253\uff0c\u6ca1\u6709\u73af\u7684\u8bdd\u5c31\u662f\u4e2a$\\ DAG$\uff0c\u62d3\u6251\u4e00\u4e0b\u968f\u4fbf\u5199\u3002\n$\\ f_{i,j}$\u4ee3\u8868$\\ j$\u65f6\u523b\u8dd1\u5230$\\ i$\u7684\u6700\u5c0f\u70e6\u8e81\u503c\u3002\n\n$\\ f_{to,p_{k}}=\\min(f_{from,p_{j}}+At^{2}+Bt+C)$\n\n\n\n\u6211\u4eec\u89c2\u5bdf\u53d1\u73b0\u5982\u679c\u6211\u4eec\u628a\u8fb9\u62c6\u70b9\u7684\u8bdd\uff0c\u662f\u51e0\u4e4e\u4e0d\u4f1a\u51fa\u73b0\u73af\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8bb0\u5fc6\u5316\u641c\u7d22\u3002\uff08\u4e0d\u7136\u5c31\u8d85\u8fc7\u65f6\u95f4\u4e86\uff09\n\n\u590d\u6742\u5ea6\u7684\u4e0a\u754c\u662f$\\ O(m^{2})$\uff0c\u83ca\u82b1\u56fe\u53ef\u4ee5\u76f4\u63a5\u5361\u6389\u3002\u8ba8\u8bba\u4e2d\u7684\u5927\u4f6c\u9020\u7684\u6570\u636e\u5df2\u7ecf\u76f4\u63a5\u5361\u6389\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,m;\nlong long aa,bb,cc;\nstruct node\n{\n\tlong long x,y,p,q,i;\n}a[300300];\nvector<node> to[300300];\nlong long f[300300];\nlong long sum(node &x,node &y)\n{\n\tlong long t=y.p-x.q;\n\treturn aa*t*t+bb*t+cc+y.p-x.p;\n}\ninline int read()\n{\n    int s=0,w=1;char ch=getchar();\n    while(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n    while(ch>='0'&&ch<='9'){s=s*10+ch-'0';ch=getchar();}\n    return s*w;\n}\nbool vis[300300];\nlong long dfs(node &x)\n{\n\tif(x.i==0) return 0;\n\tif(vis[x.i]) return f[x.i];\n\tvis[x.i]=1;\n\tint i=0;\n\twhile(i<to[x.x].size())\n\t{\n\t\tnode &y=to[x.x][i];\n\t\tif(y.q<=x.p) f[x.i]=min(f[x.i],dfs(y)+sum(y,x));\n\t\t++i;\n\t}\n\treturn f[x.i];\n}\nint main()\n{\n// \tfreopen(\"route.in\",\"r\",stdin);\n// \tfreopen(\"route.out\",\"w\",stdout);\n\tn=read();\n\tm=read();\n\taa=read();\n\tbb=read();\n\tcc=read();\n\tint i=1;\n\twhile(i<=m)\n\t{\n\t\ta[i].x=read();\n\t\ta[i].y=read();\n\t\ta[i].p=read();\n\t\ta[i].q=read();\n\t\ta[i].i=i;\n\t\tto[a[i].y].push_back(a[i]);\n\t\t++i;\n\t}\n\tto[1].push_back(a[0]);\n\tmemset(f,63,sizeof(f));\n\tf[0]=0;\n\tlong long ans=1e18;\n\ti=0;\n\twhile(i<to[n].size())\n\t{\n\t\tans=min(ans,dfs(to[n][i])+to[n][i].q-to[n][i].p);\n\t\t++i;\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1563350502,
        "uid": 138391,
        "name": "orecic",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5468 \u3010[NOI2019]\u56de\u5bb6\u8def\u7ebf\u3011"
    },
    {
        "content": "**\u53ea\u4f1a$O(mt)$\u7684\u83dc\u9e21\u524d\u6765\u641e\u4e8b**\n\n\u9996\u5148\u8fd9\u4e2a\u9898\u6709\u70b9\uff0c\u6709\u65f6\u95f4\uff0c\u4fbf\u5957\u8def\u5730\u60f3\u5230\u62c6\u70b9 ~~\uff08\u6216\u8bb8\u6211\u7f51\u7edc\u6d41\u505a\u591a\u4e86\uff09~~ \uff0c\u8bbe\u6700\u5927\u65f6\u95f4\u4e3a$t$\uff0c\u90a3\u4e48\u628a\u6bcf\u4e2a\u70b9\u62c6\u6210$t$\u4e2a\uff0c\u8fde\u4e0a\u539f\u56fe\u7684\u8fb9\u548c\u7b49\u5f85\u5373\u53ef\u3002\n\n**\u606d\u559c\u62ff\u5230$70pts$**\n\n\u5728\u8fd9\u4e2a\u601d\uff08bao\uff09\u8def\uff08li\uff09\u7684\u57fa\u7840\u4e0a\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u6bcf\u4e2a\u70b9\u62c6\u6210$t$\u4e2a\u662f\u6beb\u65e0\u610f\u4e49\u7684\uff0c\u53ea\u8981\u4fdd\u7559\u6240\u6709\u8fdb\u51fa\u7684\u65f6\u95f4\u70b9\u5c31\u53ef\u4ee5\u4e86\uff0c\u4e8e\u662f\u603b\u70b9\u6570\u4ece$nt$\u4e0b\u964d\u4e3a$2m$\uff0c\u7528$dijkstra$\u590d\u6742\u5ea6\u4e0b\u964d\u5230$O(m(t+logn))$\uff0c\u5927\u7ea6$2 \\times 10^8$\uff0c\u8f7b\u677e\u8dd1\u8fc7\u4e00\u70b9\u90fd\u4e0d\u865a233\n\n~~\u4f60\u4eec\u8bf4dij\u6b7b\u4e86\u6211\u504f\u8981\u7528dij~~\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<vector>\n#include<queue>\nusing namespace std;\ntypedef long long ll;\nconst int N=100050;\nchar rB[1<<21],*S,*T;\ninline char gc(){return S==T&&(T=(S=rB)+fread(rB,1,1<<21,stdin),S==T)?EOF:*S++;}\ninline int rd(){\n    char c=gc();\n    while(c<48||c>57)c=gc();\n    int x=c&15;\n    for(c=gc();c>=48&&c<=57;c=gc())x=(x<<3)+(x<<1)+(c&15);\n    return x;\n}\nint G[N],p[N<<1],q[N<<1],to[N<<1],nxt[N<<1],n,m,A,B,C;\nstruct node{\n\tint p,t;\n\tll d;\n\tbool go;  //\u4e0a\u4e00\u6b65\u662f\u5750\u8f66\u5219\u4e3a1\uff0c\u7b49\u5f85\u5219\u4e3a0\n\tnode(){}\n\tnode(int p,int t,ll d,bool go):p(p),t(t),d(d),go(go){}\n\tinline bool operator <(const node &b)const{return d>b.d;}\n};\npriority_queue<node> Q;\nvector<int> tim[N],tmp;  //tim\u5bf9\u65f6\u523b\u79bb\u6563\u5316\nvector<vector<int> > id[N];  //\u8bb0\u5f55u\u7ed3\u70b9t\u65f6\u523b\u51fa\u53d1\u7684\u8fb9\u7684\u7f16\u53f7\nvector<ll> d[2][N];\nint main(){\n\tint i,u;\n\tnode h;\n\tll ans=0x3f3f3f3f3f3f3f3f;\n\tn=rd();m=rd();A=rd();B=rd();C=rd();\n\tfor(i=1;i<=m;++i){\n\t\tu=rd();to[i]=rd();p[i]=rd();q[i]=rd();\n\t\tnxt[i]=G[u];G[u]=i;\n\t}\n\ttim[1].push_back(0);\n\tfor(u=1;u<=n;++u)\n\t\tfor(i=G[u];i;i=nxt[i]){\n\t\t\ttim[u].push_back(p[i]);\n\t\t\ttim[to[i]].push_back(q[i]);\n\t\t}\n\tfor(u=1;u<=n;++u){\n\t\tsort(tim[u].begin(),tim[u].end());\n\t\tvector<int>::iterator it=unique(tim[u].begin(),tim[u].end());\n\t\ttim[u].erase(it,tim[u].end());  //\u53bb\u91cd\n\t\tfor(i=0;i<tim[u].size();++i){\n\t\t\tid[u].push_back(tmp);\n\t\t\td[0][u].push_back(ans);d[1][u].push_back(ans);\n\t\t}\n\t}\n\tfor(u=1;u<=n;++u)\n\t\tfor(i=G[u];i;i=nxt[i]){\n\t\t\tid[u][p[i]=lower_bound(tim[u].begin(),tim[u].end(),p[i])-tim[u].begin()].push_back(i);\n\t\t\tq[i]=lower_bound(tim[to[i]].begin(),tim[to[i]].end(),q[i])-tim[to[i]].begin();\n\t\t}\n\tQ.push(node(1,0,d[1][1][0]=0ll,1));\n\twhile(!Q.empty()){\n\t\th=Q.top();Q.pop();\n\t\tif(d[h.go][u=h.p][h.t]!=h.d)continue;\n\t\tif(h.d>ans)break;  //\u526a\u679d\n\t\tif(u==n&&h.d+tim[n][h.t]<ans)ans=h.d+tim[n][h.t];\n\t\tif(h.go)for(i=h.t;i<tim[u].size();++i)if(h.d+A*(tim[u][i]-tim[u][h.t])*(tim[u][i]-tim[u][h.t])+B*(tim[u][i]-tim[u][h.t])+C<d[0][u][i])Q.push(node(u,i,d[0][u][i]=h.d+A*(tim[u][i]-tim[u][h.t])*(tim[u][i]-tim[u][h.t])+B*(tim[u][i]-tim[u][h.t])+C,0));  //\u7b49\u5f85\n        else;\n        else for(i=0;i<id[u][h.t].size();++i)if(h.d<d[1][to[id[u][h.t][i]]][q[id[u][h.t][i]]])Q.push(node(to[id[u][h.t][i]],q[id[u][h.t][i]],d[1][to[id[u][h.t][i]]][q[id[u][h.t][i]]]=h.d,1));  //\u5750\u8f66\n\t}\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1563344115,
        "uid": 57926,
        "name": "Thinking",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5468 \u3010[NOI2019]\u56de\u5bb6\u8def\u7ebf\u3011"
    },
    {
        "content": "# P5468 [NOI2019]\u56de\u5bb6\u8def\u7ebf    \n\n## $solution$\n\u76f4\u63a5\u7206\u641c $95$ ,\u4fe1\u4ef0\u7684\u52a0\u4e0a\u4f18\u5316 \uff0c\u6211\u4eec\u7384\u5b66\u679a\u4e3e\u4e0b\u7ebf $limit$ .   \n\u5c31\u53ef\u4ee5\u4e86 \u3002   \n\u867d\u7136\u5361\u8d77\u6765\u5f88\u5bb9\u6613 \uff0c \u4f46\u662f\u8981\u76f8\u4fe1\u51fa\u9898\u4eba\u603b\u662f\u61d2\u5f97 $qwq$\n\n* $code$   \n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long \nusing namespace std;\n\nconst ll maxn=3e6+10;\n\nstruct Node\n{\n\tll x,y,p,q;\n}t[maxn];\n\nll n,m,A,B,C;\nvector<ll> v1[maxn],v2[maxn];\nll ans=1e16;\nint limit;\nvoid dfs(ll wz,ll ti,ll w) {\n\tif(w+ti>limit) return ;\n\tif(w+ti>=ans) return ;\n\tif(wz==n) {\n\t\tans=w+ti;return ;\n\t}\n\tfor(ll i=0;i<v1[wz].size();++i) {\n\t\tNode v=t[v1[wz][i]];\n\t\tif(v.p>=ti){\n\t\t\tll T=v.p-ti;\n\t\t\tdfs(v.y,v.q,w+A*T*T+B*T+C);\n\t\t}\n\t}\n}\n\nint main() \n{\n\t//freopen(\"a.in\",\"r\",stdin);\n\t//freopen(\"a.out\",\"w\",stdout);\n\tscanf(\"%lld%lld%lld%lld%lld\",&n,&m,&A,&B,&C);//cout<<\"2333\";\n\tfor(ll i=1;i<=m;++i) {\n\t\tscanf(\"%lld%lld%lld%lld\",&t[i].x,&t[i].y,&t[i].p,&t[i].q);\n\t}\n\tfor(ll i=1;i<=m;++i) {\n\t\tv1[t[i].x].push_back(i);v2[t[i].y].push_back(i);\n\t}dfs(1,0,0);\n\tfor(limit=1;limit<=10000000;limit<<=1){\n\t\tdfs(1,0,0);\n\t}\n\tcout<<ans<<\"\\n\";\n\treturn 0;\n}\n\n\n```",
        "postTime": 1563281736,
        "uid": 102786,
        "name": "Sym_Je",
        "ccfLevel": 0,
        "title": "P5468 [NOI2019]\u56de\u5bb6\u8def\u7ebf"
    },
    {
        "content": "\u4f5c\u4e3a\u65b0\u521d\u4e8c\u7684OIer\uff0c\u7b2c\u4e00\u6b21\u53c2\u52a0NOI\u540c\u6b65\u8d5b\u3002\u4ee5\u524d\u53ea\u542c\u8fc7\u522b\u4eba\u8bf4NOI\u6709\u591a\u7d27\u5f20\uff0c\u7ed3\u679c\u6211\u4eec\u5b66\u6821\u5c31\u51e0\u4e2a\u53c2\u52a0\u540c\u6b65\u8d5b\u7684\uff0c\u6211\u548c\u540c\u5b66\u8fd8\u5e26\u96f6\u98df\u8fdb\u673a\u623f\uff0c\u673a\u623f\u5c31\u8ddf\u7f8e\u98df\u8857\u4e00\u6837\u3002\u6ca1\u9519\uff0c\u4e00\u70b9\u90fd\u4e0d\u7d27\u5f20\uff01\n\nT1\uff0c\u771f\u662f\u5230\u597d\u9898\uff01\u6211\u770b\u5b8c\u5168\u90e8\u9898\u76ee\uff0c\u518d\u770b\u4e00\u904dT1\uff0c\u4e0d\u5c31\u662fdij\u5417\uff01\n\n\u4f60\u53ef\u80fd\u4f1a\u95ee\u6211\u4e3a\u4ec0\u4e48\u6ca1\u60f3\u5230\u659c\u7387\uff1f\n\n\u56e0\u4e3a\u6211\u6ca1\u5b66\u8fc7\uff01\n\n------------\n\n\u6211\u4eec\u8003\u8651\u4e00\u4e0b\u4ee5\u7126\u8e81\u503c\u4f5c\u4e3a\u8fb9\u6743\u7684\u6700\u77ed\u8def\u3002\n\n\u4f46\u662f\u7126\u8e81\u503c\u662f\u5728\u7b49\u8f66\u7684\u65f6\u5019\u624d\u4f1a\u4ea7\u751f\u7684\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u60f3\u5230\u5c06\u8fb9\u770b\u6210\u70b9\uff0c\u4ee5\u70b9\u8fde\u8fb9\u3002\n\n\u4f46\u662f\u4e0d\u7528\u60f3\u90fd\u77e5\u9053\uff0c\u4e00\u4e2a\u70b9\u5f88\u53ef\u80fd\u4e0d\u6b62\u4e00\u6761\u8fb9\u76f8\u8fde\uff08\u539f\u9898\u4e2d\u7684\u70b9\u548c\u8fb9\uff09\uff0c\u8fd9\u6837\uff0c\u8fde\u7684\u8fb9\u6570\u5c31\u4f1a\u53d8\u6210\u8fd1\u4f3c $m^2$ \u4e86\u3002\n\n\u4e2d\u95f4\u90e8\u5206\u5c31\u4e0d\u8bb2\u4e86\uff0c\u770b\u4e0b\u8fb9\u3002\n\n\u4e0d\u7528\u7ba1\u8fd9\u4e48\u591a\uff0c\u80fd\u62ff\u5206\u5c31\u662f\uff01\u4e8e\u662f\u672c\u849f\u84bb\u5c31\u771f\u8fd9\u6837\u6253\u4e86\uff0c\u7b2c\u4e09\u4e2a\u5927\u6837\u4f8b\u5c31T\u4e86\uff08\u4e25\u91cd\u6000\u7591\u662f\u6253\u9519\u4e86\uff0c\u590d\u6742\u5ea6\u4e0d\u53ef\u80fd\u90a3\u4e48\u9ad8\u7684\uff09\n\n### \u5927\u6982\u5f97\u5206\uff1a20\n\n------------\n\n\u90a3\u4e48\uff0c\u80fd\u4e0d\u80fd\u4e0d\u628a\u8fb9\u770b\u6210\u70b9\u5462\uff1f\n\n\u5f53\u7136\u53ef\u4ee5\u3002\u4ee5\u539f\u9898\u4e2d\u7684\u706b\u8f66\u4e3a\u8fb9\uff0cdij\u7684\u65f6\u5019\u679a\u4e3e\u4e00\u4e2a\u70b9\u8fde\u51fa\u53bb\u7684\u8fb9\u3002dij\u7684\u65f6\u5019\u53ef\u4ee5\u4f20\u4e00\u4e2a\u5230\u8fbe\u7684\u65f6\u95f4\u5230\u4e0b\u4e00\u4e2a\u70b9\uff0c\u4ee5\u4f20\u8fc7\u6765\u7684\u65f6\u95f4\u6765\u5224\u65ad**\u4ece\u4e0a\u4e00\u6761\u8fb9\u5230\u8fbe\u8be5\u70b9\uff08\u706b\u8f66\u5230\u7ad9\uff09** \u5230 **\u4e0b\u8f86\u8f66\u5230\u8fbe\u4e0b\u4e00\u4e2a\u70b9**\u8fd9\u6bb5\u8def\u7a0b\u7d2f\u8ba1\u7684\u7126\u8e81\u503c\uff0c\u4e5f\u5c31\u662f\u8fb9\u6743\u3002\n\n\u5177\u4f53\u4e00\u70b9\uff08\u4e5f\u5c31\u662f20\u5206\u89e3\u6cd5\u7684\u4e2d\u95f4\u90e8\u5206\uff09\n\n\u6837\u4f8b1\u4e2d\uff0c\u57502\u53f7\u8f66\u4ece1\u52302\uff0c\u518d\u57504\u53f7\u8f66\u4ece2\u52303\n\n\u6211\u4eec\u770b \u4ece2\u52303\uff0c\u8fd9\u91cc\u6709\u51e0\u4e2a\u53c2\u6570\uff1a\n\n1. \u4ec0\u4e48\u65f6\u5019\u52302\u53f7\u70b9\u7684\n2. \u57282\u53f7\u70b9\u7b49\u4e86\u591a\u4e45\n3. \u4ec0\u4e48\u65f6\u5019\u52303\u53f7\u70b9\n\n\u4ee4\u4e0a\u97621\u4e3at1\uff0c2\u4e3at2\uff0c3\u4e3at3\n\n\u57282\u53f7\u70b9\u7b49\u7684\u65f6\u95f4\u8981\u5957\u4e00\u4e2a\u4e8c\u6b21\u51fd\u6570\uff1a$A*t2^2+B*t2+C$\n\n\u4e3a\u4e86\u6c42\u6700\u7ec8\u5230\u8fbe\u7684\u65f6\u95f4\uff08\u9898\u76ee\u91cc\u9762\u7126\u8e81\u503c\u8fd8\u8981\u52a0\u4e0a\u603b\u7528\u65f6\uff09\uff0c\u6211\u4eec\u5fc5\u987b\u628a\u603b\u7528\u65f6\u653e\u5230\u6bcf\u4e00\u6b65\u4e0a\u3002\u4e8e\u662f\u8fd8\u8981\u52a0\u4e0a\uff1a $t3-t1$\n\n\u518d\u52a0\u4e00\u70b9\u9884\u5904\u7406\u5c31\u884c\u4e86\u3002\u7edf\u8ba1\u7b54\u6848\u4e5f\u6bd4\u8f83\u7b80\u5355\u3002\n\n\u770b\u5230\u8fd9\u91cc\uff0c\u6709\u6ca1\u6709\u4ec0\u4e48\u4e0d\u5bf9\u52b2\u7684\uff1f\n\n$$\n\n$$\n\n$$\n\n$$\n\n\u6ca1\u9519\uff0cdij\u7684\u65f6\u5019\u4e0d\u80fd\u6709\u9644\u52a0\u72b6\u6001\uff01\n\n\u5c31\u662f\u8bf4\uff0cdij\u7684\u65f6\u5019\uff0c\u65e2\u7136\u662f\u5355\u5143\u6700\u77ed\u8def\uff0c\u5c31\u4e0d\u5e94\u8be5\u6709\u9644\u52a0\u7684**\u5230\u8fbe\u65f6\u95f4**\n\n\u7136\u800c\uff0c\u672c\u849f\u84bb\u8fd9\u6837\u6253\uff0c\u8fc7\u4e86\u51e0\u4e2a\u5927\u6837\u4f8b\u5427\uff0c\u540e\u6765\u604d\u7136\u5927\u609f\uff5e\n\n#### \u8fd9\u5206\u660e\u662f\u51fa\u9898\u4eba\u60f3\u5751\u6211\u554a\n\n\u8fd9\u79cd\u4e1c\u897f\u5f88\u53ef\u80fd\u4f1aWA\u5f97\uff08\u81ea\u884c\u8111\u8865\uff09\n\n------------\n\n\u89c9\u9192\u5427\uff0c\u5c11\u5e74\uff01\n\n\u8fd9\u65f6\u7684\u6211\u5df2\u7ecf\u8017\u4e862.5\u5c0f\u65f6\u4e86\uff08\u5df2\u7ecf\u8fc7\u53bb3.5\u5c0f\u65f6\u4e86\uff09\n\n\u4e24\u6b21\u5f04\u9519\u4e86\uff0cA\u9898\u4f3c\u4e4e\u5df2\u7ecf\u65e0\u671b\uff08\u4e0d\u662f\u8fd8\u67091.5h\u5417\uff09\n\n\u4f46\u662f\uff0c\u5931\u8d25\u4e43\u6210\u529f\u4e4b\u6bcd\n\n\u6211\u5df2\u7ecf\u770b\u900f\u8fd9\u9898\uff08\u768450\u5206\uff09\u4e86\uff01\n\n\u4e0d\u80fd\u52a0\u9644\u52a0\u72b6\u6001\uff0c\u90a3\u5c31\u628a\u6bcf\u4e2a\u72b6\u6001\u90fd\u5f04\u51fa\u6765\u561b\uff01\n\n\u4e00\u770b\uff0cp\u3001q\u90fd\u662f1e3\u4ee5\u5185\n\n\u4e8e\u662f\uff0c50\u5206\u5e94\u8be5\u662f\u5230\u624b\u7684\u4e86\n\n\u641c\u7684\u65f6\u5019\u8fd8\u662f\u4ee5\u70b9\u641c\uff0c\u4f46\u8fd9\u4e2a\u65f6\u5019\u7684\u5230\u8fbe\u65f6\u95f4\u5c31\u4e0d\u662f\u9644\u52a0\u6761\u4ef6\u4e86\u3002\u6700\u77ed\u8def\u4e0d\u662f\u4ee5\u70b9\u4e3a\u5355\u4f4d\uff0c\u800c\u662f\u6bcf\u4e2a\u70b9\u5bf9\u5e941000\u4e2a\u72b6\u6001\uff0c\u4ee5\u8fd9\u4e9b\u72b6\u6001\u8dd1\u6700\u77ed\u8def\u3002\n\n\u5728\u521a\u624d\u7684\u7a0b\u5e8f\u4e0a\u6539\u4e00\u70b9\u5c31\u597d\u4e86\u3002\n\n### \u5f97\u5206\uff1a50\n\n------------\n\n\u6211\u5e73\u65f6\u5c31\u6253spfa\uff0cdij\u5acc\u90a3priority_queue\u4e0d\u597d\u91cd\u8f7d\uff0c\u8981\u91cd\u8f7d\u8fd8\u8981\u5f04\u7ed3\u6784\u4f53\u3002\u770b\u770b\u4eba\u5bb6sort\uff0c\u76f4\u63a5\u5199\u4e00\u4e2a\u6bd4\u8f83\u51fd\u6570\u540d\u5c31\u597d\u4e86\u3002\n\n\u8fd9\u5c31\u5bfc\u81f4\u6211\u5728\u4ee3\u7801\u65b9\u9762\u82b1\u7684\u65f6\u95f4\u592a\u591a\uff0c\u672c\u6765\u6539\u4e00\u70b9\u5c31\u597d\u4e86\uff0c\u5374\u6539\u4e8640\u5206\u949f\u3002\u8fd9\u4e5f\u8ddf\u524d\u9762\u4e8b\u500d\u529f\u534a\u6709\u5173\u3002\u5fc3\u60c5\u8fd8\u662f\u5f88\u91cd\u8981\uff01\u4e0d\u80fd\u592a\u574f\uff0c\u4e5f\u4e0d\u80fd\u592a\u597d\uff01\n\n------------\n\n\u6700\u540e\u534a\u5c0f\u65f6\uff0c\u7ec8\u4e8e\u5f00\u59cb\u6253T3\u7684\u66b4\u529b\u4e86\u3002\n\n\u6253\u66b4\u529b\u4e4b\u524d\uff0c\u6211\u7ec8\u4e8e\u770b\u900fT1\u4e86\n\n\u8fd9\u4e48\u591a\u72b6\u6001\uff0c\u5176\u5b9e\u4e5f\u5c31 \u8fb9\u6570*2 \u4e2a\u72b6\u6001\u662f\u6709\u7528\u7684\n\n\u56e0\u4e3a\u6bcf\u6761\u8fb9\u90fd\u53ea\u4f1a\u8fde\u63a5\u4e24\u4e2a\u72b6\u6001\n\n\u4f60\u53ef\u80fd\u4f1a\u95ee\uff0c\u5c31\u7b97\u4e24\u4e2a\u72b6\u6001\u5728\u540c\u4e00\u4e2a\u70b9\u4e0a\uff0c\u90a3\u5b83\u4eec\u4e5f\u8981\u8fde\u8fb9\u554a\n\n\u6211\u5c31\u6b7b\u5728\u8fd9\u4e86\n\nT1\u5df2\u7ecf\u7ed9\u6211\u7559\u4e0b\u4e86\u5fc3\u7406\u9634\u5f71\uff0c\u6211\u73b0\u5728\u53ef\u4e0d\u6562\u8f7b\u4e3e\u5984\u52a8\n\n\u8fd8\u662f\u4e56\u4e56\u5730\u56de\u53bb\u6253\u66b4\u529b\u5427\n\n------------\n\n\u603b\u7b97\u8fdb\u5165\u6b63\u89e3\u4e86\uff01\n\n\u5982\u679c\u4e24\u4e2a\u72b6\u6001\u5728\u540c\u4e00\u4e2a\u70b9\u4e0a\uff0c\u90a3\u4e48\u76f4\u63a5\u641c\u5c31\u597d\u4e86\u554a\uff01\u5b83\u4eec\u4e4b\u95f4\u7684\u8fb9\u6743\u662f\u56fa\u5b9a\u7684\uff0c\u76f4\u63a5\u6c42\u5c31\u597d\u4e86\u3002\u5c31\u5f53\u662f\u6bcf\u6b21O(1)\u7b97\u8fb9\u6743\u3002\n\n\u6211\u4eec\u7528\u4e00\u4e2amap\u6765\u5b58\u6240\u6709\u51fa\u73b0\u8fc7\u7684\u72b6\u6001\uff0c\u521d\u59cb\u5316\u7684\u65f6\u5019\uff0cmap\u91cc\u9762\u5b58\u7684\u662f\u538b\u7f29\u524d\u7684\u72b6\u6001\uff0c\u7528\u4e00\u4e2a\u6570\u7ec4\u6765\u5b58\u538b\u7f29\u540e\u7684\u72b6\u6001\u3002\n\n\u8fd8\u6709\u4e00\u4e9b\u4f18\u5316\uff0c\u81ea\u884c\u8111\u8865\u5427\u3002\n\n# \u5f97\u5206\uff1a$\\color{green}{AC}$\n\n------------\n\n\n\u597d\u4e86\uff0c\u90a3\u8fd8\u53ebdij\u5417\uff08\u771f\u7684\u4e0d\u662fdij\u554a\uff09\n\n\u5f53\u7136\u4e0d\u662f\uff0c\u4f46\u662f\u8fd9\u9898\u5c31\u662f\u8fd9\u4e48\u795e\u5947\uff0c\u4e0d\u5982\u5f04\u4e2a\u7b97\u6cd5\u53ebhoming\uff08\u56de\u5bb6\uff09\n\n\u6709\u4e9b\u4e1c\u897f\u8bb2\u5f97\u4e0d\u6e05\u695a\uff0c\u770b\u4ee3\u7801\u66f4\u597d\u7406\u89e3\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<map>\n#include<queue>\nusing namespace std;\ntypedef long long ll;\ninline ll minn(ll a,ll b){\n\tif(a<b) return a;\n\treturn b;\n}\ninline void swp(int &x,int &y){\n\tint t=x;\n\tx=y,y=t;\n}\nconst int MAXN=1e5+5,MAXM=2e5+5;\nconst ll INF=0x7fffffffffffffff;\nint n,m,a,b,c;\nint cnte,h[MAXN],nx[MAXM],to[MAXM],p[MAXM],q[MAXM],nd[MAXM];\ninline void adde(int u,int v,int x,int y,int z){\n\tcnte++;\n\tnx[cnte]=h[u];\n\tto[cnte]=v;\n\tp[cnte]=x;\n\tq[cnte]=y;\n\tnd[cnte]=z;\t//\u4f18\u5316 \n\th[u]=cnte;\n}\nint dx,indx[MAXM<<1];\t//\u88ab\u4e24\u6b21\u538b\u7f29\u7684\u72b6\u6001 \nmap<int,int> mp;\t\t//\u88ab\u4e00\u6b21\u538b\u7f29\u7684\u72b6\u6001 \nll dis[MAXM<<1];\t//\u4e0b\u6807\u5747\u4e3a\u88ab\u4e24\u6b21\u538b\u7f29\u7684\u6570 \nll ans;\nstruct priorityq{\t//\u81ea\u5b9a\u4e49\u5806 \n\tint len,a[1000000];\n\tinline void Init(){\n\t\tlen=0;\n\t\tmemset(a,0,sizeof(a));\n\t}\n\tvoid push(int x){\n\t\ta[++len]=x;\n\t\tint w=len;\n\t\twhile(w>1){\n\t\t\tif(dis[a[w>>1]]<=dis[a[w]]) break;\n\t\t\tswp(a[w>>1],a[w]);\n\t\t\tw>>=1;\n\t\t}\n\t\treturn ;\n\t}\n\tvoid pop(){\n\t\tif(len==1){\n\t\t\ta[1]=0;\n\t\t\tlen=0;\n\t\t\treturn ;\n\t\t}\n\t\ta[1]=a[len--];\n\t\tint w=1;\n\t\twhile(w<=len){\n\t\t\tif(w<<1>len) break;\n\t\t\tif((w<<1|1)>len){\n\t\t\t\tif(dis[a[w<<1|1]]<dis[a[w]]) swp(a[w],a[w<<1|1]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tint &x=a[w<<1],&y=a[w<<1|1];\n\t\t\tif(dis[x]<dis[y]) swp(x,a[w]),w=w<<1;\n\t\t\telse swp(y,a[w]),w=w<<1|1;\n\t\t}\n\t\treturn ;\n\t}\n\tinline int top(){\n\t\treturn a[1];\n\t}\n}que;\nvoid dij(){\n\tans=INF;\n\tmemset(dis,0x3f,sizeof(dis));\n\tdis[1]=0;\n\tque.Init();\n\tque.push(1);\n\t//\u521d\u59cb\u5316\u5b8c\u6bd5 \n\twhile(que.len){\n\t\tint hd=que.top();\t//head\u662f\u88ab\u4e24\u6b21\u538b\u7f29\u7684 \n\t\tque.pop();\n\t\tint u=indx[hd]/1001,tm=indx[hd]%1001;\t//\u5f97\u5230\u5f53\u524d\u7684\u70b9\u548c\u65f6\u95f4 \n\t\tfor(int i=h[u];i;i=nx[i]){\t//\u770b\u8fd9\u91cc\uff0c\u8fd9\u662fdij\u5417 \n\t\t\tif(p[i]<tm) continue;\n\t\t\tint t=p[i]-tm;\n\t\t\tint x=a*t*t+b*t+c+q[i]-tm;\t//\u65b0\u589e\u7684\u7126\u8e81\u503c \n\t\t\tint v=nd[i];\t//\u4f18\u5316\uff0c\u4e0d\u7528\u6bcf\u6b21\u5728map\u91cc\u627e \n\t\t\tif(dis[v]>dis[hd]+x){\n\t\t\t\tdis[v]=dis[hd]+x;\n\t\t\t\tque.push(v);\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=m;i++)\n\t\tif(to[i]==n) ans=minn(ans,dis[nd[i]]);\t//\u7edf\u8ba1\u7b54\u6848 \n\treturn ;\n}\nint main(){\n//\tfreopen(\"route5.in\",\"r\",stdin);\n\tscanf(\"%d%d%d%d%d\",&n,&m,&a,&b,&c);\n\tindx[dx=1]=1001;\n\t//indx[]\u91cc\u5b58\u7684\u662f\u5bf9\u5e94\u7684\u72b6\u6001\n\t//\u5982\u679c\u4e00\u4e2a\u72b6\u6001\u7684\u70b9\u4e3a u\uff0c\u65f6\u95f4\u4e3a tm,\u90a3\u4e48\u538b\u7f29\u540e\u5c31\u662f u*1001+tm \n\tfor(int i=1;i<=m;i++){\n\t\tint u,v,p,q;\n\t\tscanf(\"%d%d%d%d\",&u,&v,&p,&q);\n\t\tint t1=u*1001+p,t2=v*1001+q,t3;\t//\u5f97\u5230\u4e24\u4e2a\u72b6\u6001\uff0ct3\u662f\u4e00\u70b9\u4f18\u5316 \n\t\tif(!mp.count(t1)) indx[++dx]=t1,mp[t1]=dx;\n\t\tif(!mp.count(t2)) indx[++dx]=t2,t3=mp[t2]=dx;\n\t\telse t3=mp[t2];\n\t\tadde(u,v,p,q,t3);\n\t}\n\tdij();\n\tprintf(\"%lld\\n\",ans);\n//\tfclose(stdin);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1563280844,
        "uid": 116116,
        "name": "LZDQ",
        "ccfLevel": 0,
        "title": "NOI2019D1T1\u56de\u5bb6\u8def\u7ebf"
    }
]
[
    {
        "content": "$ans=\\sum_{k=1}^nk*f[k]$\n\n$f[k]$\u8868\u793a$gcd(i,j)=k$\u7684\u4e2a\u6570 \n\n$g[k]$\u8868$k|gcd(i,j)$\u7684\u4e2a\u6570\n\n\u663e\u7136$g[k]=f[k]+f[2k]+...+f[mk]$\n\n\u800c$g[k]=\\lfloor\\frac nk\\rfloor^2$($i$\u6709$\\lfloor\\frac nk\\rfloor$\u79cd\u9009\u62e9$j$\u4e00\u6837\u6240\u4ee5\u76f8\u4e58\u5c31\u662f$\\lfloor\\frac nk\\rfloor^2$)\n\n\u6240\u4ee5$f[k]=\\lfloor\\frac nk\\rfloor^2-(f[2k]+f[3k]+....)$\n\n\u590d\u6742\u5ea6\u662f$n*(1+\\frac12+\\frac13+...+\\frac1n)$\n\n\n\u6240\u4ee5\u603b\u590d\u6742\u7684\u4e3a$O(nH(n)),H(n)$\u4e3a\u8c03\u548c\u7ea7\u6570\n\n\u56e0\u4e3a$n$\u4e0d\u5927,\u8fd9\u4e2a\u7b97\u6cd5\u5e38\u6570\u5c0f,\u6240\u4ee5\u5c31\u6bd4\u7b97$\\sum_{d=1}^n\\phi(d)*\\lfloor\\frac nd\\rfloor^2$\u8981\u5feb\u4e00\u4e9b\n\n\u4ec0\u4e48\u4f60\u8bf4\u675c\u6559\u7b5b?\u90a3\u73a9\u610f\u5e38\u6570\u66f4\u5927.\u505a\u675c\u6559\u7b5b\u4e0d\u5982\u53bb\u505a[\u8fd9\u4e2a](https://www.luogu.org/problemnew/show/P4213)\n\n```cpp\n#include<cstdio>\n#define re register int\nlong long n,ans,f[100010];\nint main(){\n    scanf(\"%lld\",&n);\n    for(re i=n;i;--i){\n        f[i]=n/i*(n/i);\n        for(re j=i<<1;j<=n;j+=i)f[i]-=f[j];\n        ans+=f[i]*i;\n    }\n    printf(\"%lld\",ans);\nreturn 0;\n}\n```",
        "postTime": 1501564139,
        "uid": 20156,
        "name": "Kelin",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "\u8d34\u4e00\u7bc7\u4e0d\u9700\u8981\u53cd\u6f14\u7684\u9898\u89e3\u3002\n\n\u76f4\u63a5\u8ba1\u7b97\u590d\u6742\u5ea6\u8fc7\u9ad8\u65e0\u6cd5\u63a5\u53d7\n\n\u8003\u8651\u679a\u4e3e\u6240\u6709$gcd$\u503c\u8ba1\u7b97\n\n\u82e5$gcd=k$\n\n\u5bf9\u4e8e\u6240\u6709$gcd\\left ( x,y \\right )=1$\uff0c\u6709$gcd\\left ( xk,yk \\right )=k\\left ( xk\\leq n,yk\\leq n \\right )$\n\n\u6240\u4ee5$gcd=k$\u7684\u4e2a\u6570\u4e3a\n$$2*\\sum_{i=1}^{\\left \\lfloor \\frac{n}{k} \\right \\rfloor}\\varphi \\left ( i \\right )-1$$\n$\\left ( x,y \\right )$\u4e0e$\\left ( y,x \\right )$\u5747\u53ef\u884c\uff0c\u4f46$\\left ( 1,1 \\right )$\u53ea\u80fd\u8ba1\u7b97\u4e00\u6b21\n\n\u7ebf\u6027\u7b5b\u4e00\u904d\u6b27\u62c9\u51fd\u6570\uff0c\u7136\u540e\u6c42\u524d\u7f00\u548c\n\n\u590d\u6742\u5ea6$O\\left ( n \\right )$\n\n```cpp\n#include<cstdio>\n#define LL long long\nconst int N=100050;\nint prime[N],cnt=0,phi[N];\nLL n,sum[N],ans=0;\nvoid init()\n{\n    phi[1]=1;\n    for(int i=2;i<=n;i++)\n    {\n        if (!phi[i]) prime[++cnt]=i,phi[i]=i-1;\n        for(int j=1;j<=cnt;j++)\n        {\n            if (prime[j]*i>n) break;\n            if (i%prime[j]==0)\n            {\n                phi[i*prime[j]]=phi[i]*prime[j];\n                break;\n            }\n            else phi[i*prime[j]]=phi[i]*(prime[j]-1);\n        }\t\t\n    }\n    for(int i=1;i<=n;i++) sum[i]=sum[i-1]+phi[i];\n}\nint main()\n{\n    scanf(\"%lld\",&n);\n    init();\n    for(LL i=1;i<=n;i++) \n        ans+=(sum[n/i]*2-1)*i;\n    printf(\"%lld\",ans);\n    return 0;\n}\n```",
        "postTime": 1531653568,
        "uid": 31383,
        "name": "\u9b4d\u9b49\u00b0",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "## \u9898\u76ee\u5927\u610f\n\n\u7ed9\u5b9a\u6b63\u6574\u6570$n$\uff0c\u6c42\n$$\\sum_{i = 1}^n\\sum_{j = 1}^n\\gcd(i,j)\\quad(0)$$\n\n## \u524d\u7f6e\u77e5\u8bc6\n\n\u6b27\u62c9\u51fd\u6570\uff1a\u5b9a\u4e49\u6570\u8bba\u51fd\u6570$\\phi$\uff08\u6570\u8bba\u51fd\u6570\u6307\u5b9a\u4e49\u57df\u4e3a\u6b63\u6574\u6570\uff0c\u503c\u57df\u4e3a\u5177\u6709\u7279\u5b9a\u610f\u4e49\u7684\u6570\u96c6\u7684\u4e00\u7c7b\u51fd\u6570\uff09\uff0c\u6709\n$$\\phi(n)=\\begin{cases}1\\quad (n=1) \\\\ \\text{1\u5230n-1\u5185\u4e0en\u4e92\u8d28\u7684\u6570\u7684\u4e2a\u6570}\\quad otherwise\\end{cases}$$\n\u6b27\u62c9\u51fd\u6570\u6709\u4e00\u4e2a\u5947\u602a\u7684\u6027\u8d28\n$$\\sum_{d|n}\\phi(d)=n$$\n\u4e0b\u9762\u6211\u4eec\u7b80\u5355\u8bc1\u660e\u4e00\u4e0b\n\n$\\text{proof}$:\n\n\u82e5$p$\u662f\u7d20\u6570\uff0c\u663e\u7136\u6709\n$$\\phi(p)=p-1$$\n\u90a3\u4e48\uff0c\u5bf9\u4e8e\u6b63\u6574\u6570$kp$\uff0c\u4e0e\u5176\u4e0d\u4e92\u8d28\u7684\u6570\u53ea\u6709$1,p,2p,3p\\dots, kp$\uff0c\u6545\n$$\\phi(kp)=k(p-1) \\quad(1)$$\n\u5bf9\u4e8e\u7d20\u6570\u5e42$p^k$\uff0c\u7531$(1)$\u53ef\u77e5\n$$\\phi(p^k)=p^{k-1}(p-1)=p^k-p^{k-1}$$\n\u5bf9\u4e8e\n$$\\sum_{d|p^k}\\phi(d) \\quad(2)$$\n\u663e\u7136\uff0c$d$\u53ea\u80fd\u53d6$1,p,p^2,p^3\\dots,p^k$\u3002\u90a3\u4e48\u6709\n$$\\begin{aligned}&(2)\\\\&=(\\sum_{d=1}^k\\phi(p^d))+1\\\\&=(\\sum_{d=1}^kp^d-p^{d-1})+1\\\\&=p^k-p^{k-1} +p^{k-1}-p^{k-2}+\\dots -p+p-1+1\\\\&=p^k\\end{aligned}$$\n\u56e0\u4e3a$\\phi$\u662f\u79ef\u6027\u51fd\u6570\uff0c\u5373\u82e5$n\\perp m$\uff0c$\\phi(nm)=\\phi(n)\\phi(m)$\uff0c\u7531\u6b63\u6574\u6570\u552f\u4e00\u5206\u89e3\u5b9a\u7406\u53ef\u77e5$\\sum_{d|n}\\phi(d)=n$\u3002\n\nQ.E.D.\n\n~~\u8fd9\u4e2a\u8bc1\u660e\u7a9d\u81ea\u5df1\u641e\u51fa\u6765\u7684\uff0c\u563f\u563f~~\n\n\u90a3\u4e48\u56de\u5230\u672c\u9898\uff0c\u6709\n$$\\begin{aligned}&(0)\\\\&=\\sum_{i = 1}^n\\sum_{j = 1}^n\\sum_{d|\\gcd(i,j)}\\phi(d)\\\\&=\\sum_{i = 1}^n\\sum_{j = 1}^n\\sum_{d|i,d|j}\\phi(d) \\quad\\text{d|gcd(i,j)\u53ef\u4ee5\u5199\u6210d|i,d|j\uff0c\u4e0d\u96be\u7406\u89e3\u5427}\\\\&=\\sum_{i = 1}^n\\sum_{j = 1}^n\\sum_{d=1}^n\\phi(d)[d|i][d|j] \\quad\\text{[P]\u4e2d\u82e5P\u4e3a\u771f\u5219[P]=1\uff0c\u5426\u5219[P]=0}\\\\&=\\sum_{d=1}^n\\phi(d)\\sum_{i=1}^n\\sum_{j=1}^n[d|i][d|j]\\\\&=\\sum_{d=1}^n\\phi(d)\\lfloor\\dfrac{n}{d}\\rfloor^2 \\end{aligned}$$\n\u81f3\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u7ebf\u6027\u7b5b\u51fa$1$\u5230$n$\u4e2d\u7684$\\phi$\uff0c\u7136\u540e\u628a\u6700\u540e\u7684\u67ff\u5b50for\u4e00\u904d\u5c31\u884c\u5566\uff08\u5f53\u7136\u7528\u6574\u9664\u5206\u5757\u66f4\u597d\uff0c\u4f46\u6b64\u9898\u91cc$n$\u7684\u8303\u56f4\u592a\u5c0f\uff0c\u76f4\u63a5\u641e\u4e5f\u53ef\u4ee5\uff09\n\n## \u4ee3\u7801\n\n```cpp\n#include <cstdio>\n#include <cstring>\n\nconst int MAXN = 100010;\n\nint prime[MAXN], v[MAXN], phi[MAXN], sumPhi[MAXN], cnt, n;\n\nvoid eular(int n) {//\u7ebf\u6027\u7b5b\u7b5b\u6b27\u62c9\u51fd\u6570\n    memset(v, 0, sizeof(v));\n    sumPhi[1] = phi[1] = 1;\n\n    for (int i = 2; i <= n; i++) {\n        if (!v[i]) {\n            prime[++cnt] = v[i] = i;\n            phi[i] = i - 1;\n        }\n        for (int j = 1; j <= cnt; j++) {\n            if (prime[j] > v[i] || i * prime[j] > n) break;\n            v[i * prime[j]] = prime[j];\n            phi[i * prime[j]] = phi[i] * (i % prime[j] ? prime[j] - 1 : prime[j]);\n        }\n        sumPhi[i] = sumPhi[i - 1] + phi[i];//\u6c42\u6b27\u62c9\u51fd\u6570\u7684\u524d\u7f00\u548c\uff0c\u5982\u679c\u6574\u9664\u5206\u5757\u7684\u8bdd\u5c31\u8981\u7528\n    }\n}\n\nint main() {\n    scanf(\"%d\", &n);\n    eular(n);\n\n    long long ans = 0;\n    for (int l = 1, r; l <= n; l = r + 1) {//\u8fd9\u91cc\u662f\u6574\u9664\u5206\u5757\u5199\u6cd5\uff0c\u5982\u679c\u4e0d\u61c2\u53ef\u4ee5\u76f4\u63a5for 1 to n\n        r = n / (n / l);\n        ans += (long long) (sumPhi[r] - sumPhi[l - 1]) * (n / l) * (n / l);\n    }\n    printf(\"%lld\\n\", ans);\n    return 0;\n}\n```\n\n\u8c22\u8c22\u5927\u5bb6\u89c2\u770b\u8d44\u74f7\uff01\n\n20191022 update:\u4fee\u590d\u9898\u89e3\u533amarkdown\u8f69\u7136",
        "postTime": 1571670804,
        "uid": 86409,
        "name": "Night_star",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "\u4e00\u9053\u975e\u5e38\u4e0d\u9519\u7684\u6b27\u62c9\u51fd\u6570\u9898\uff0c\u5de7\u5999\u5730\u8fd0\u7528\u4e86\u6b27\u62c9\u51fd\u6570\u7684\u6027\u8d28\n\n\u672c\u4eba\u9898\u89e3\u5199\u5f97\u5c11\uff0c\u98ce\u683c\u4e0d\u592a\u597d\u770b\u9ebb\u70e6\u8c05\u89e3\u4e00\u4e0b\n\n\u9898\u76ee\u5927\u610f\uff1a\n\n\u6c42\u89e3  \n\n$ \\sum_{i=1}^{n} \\sum_{j=1}^{n} gcd(i,j)$\n\n\n\n\u6211\u4eec\u5316\u7b80\u4e00\u4e0b\u8fd9\u4e2a\u5f0f\u5b50\uff1a\n\n $ \\sum_{i=1}^{n} \\sum_{j=1}^{n} gcd(i,j)$\n \n\n\n$ = \\sum_{i=1}^{n} \\sum_{j=1}^{n}\\sum_{d|gcd(i,j)}\u03c6(d)$\n \n\n\n\uff08\u4ee5\u4e0a\u7684\u8f6c\u6362\u7528\u5230\u4e86\u4e00\u4e2a\u77e5\u8bc6\u70b9\uff1a\u4e00\u4e2a\u6570\u7b49\u4e8e\u5b83\u7684\u56e0\u5b50\u7684\u6b27\u62c9\u51fd\u6570\u4e4b\u548c\uff09\n \n\n\n$ = \\sum_{i=1}^{n} \\sum_{j=1}^{n} \\sum_{d|i,j}\u03c6(d)$\n \n\n\n\uff08\u4ee5\u4e0a\u7684\u8f6c\u6362\u662f\u56e0\u4e3a\uff1a\u5982\u679c\u8fd9\u4e2a\u6570\u662f$i$\u548c$j$\u7684\u6700\u5927\u516c\u7ea6\u6570\u7684\u56e0\u5b50\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6570\u4e00\u5b9a\u65e2\u662f$i$\u7684\u56e0\u5b50\uff0c\u53c8\u662f$j$\u7684\u56e0\u5b50\uff09\n \n\n\n$ = \\sum_{d=1}^{n}\u03c6(d)*(n/i)*(n/i)$\n \n\n\n\uff08\u6211\u4eec\u8f6c\u53d8\u4e00\u4e0b\uff0c\u4ece\u679a\u4e3e$i$\u548c$j$\u4f20\u4e3a\u679a\u4e3e$\u03c6(d)$\uff0c\u76f4\u63a5\u7edf\u8ba1\u6bcf\u4e2a$\u03c6(d)$\u5bf9\u7b54\u6848\u6709\u591a\u5c11\u6b21\u7684\u8d21\u732e\uff09\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n\n ```cpp\n#include<iostream>\n#include<cstdio>\n\nusing namespace std;\n\nconst int maxn = 100005;\n\nint n, cnt;\n\nlong long ans;\nlong long phi[maxn], prime[maxn], sum[maxn]; // \u6570\u636e\u6bd4\u8f83\u5927\uff0c\u8981\u5f00longlong \n\nbool check[maxn];\n\nvoid Euler_Phi(int num) //\u9884\u5904\u7406\u51fa\u67651 ~ n\u7684\u6b27\u62c9\u51fd\u6570\u7684\u503c \n{\n\tcheck[1] = true;\n\tphi[1] = 1;\n\tfor(register int i = 2; i <= num; i++)\n\t{\n\t\tif(!check[i])\n\t\t{\n\t\t\tprime[++cnt] = i;\n\t\t\tphi[i] = i - 1;\n\t\t}\n\t\tfor(register int j = 1; j <= cnt && i * prime[j] <= num; j++)\n\t\t{\n\t\t\tcheck[i * prime[j]] = true;\n\t\t\tif(i % prime[j] != 0) phi[i * prime[j]] = phi[i] * (prime[j] - 1);    //\u5982\u679c\u5bf9\u6b27\u62c9\u51fd\u6570\u7684\u7ebf\u6027\u9012\u63a8\u6709\u7591\u95ee\u7684\u8bdd\uff0c\u53ef\u4ee5\u6309\u7167\u6b27\u62c9\u51fd\u6570\u7684\u516c\u5f0f\u81ea\u5df1\u624b\u52a8\u6a21\u62df\u4e00\u4e0b \n\t\t\telse {\n\t\t\t\tphi[i * prime[j]] = phi[i] * prime[j]; \n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tfor(register int i = 1; i <= num; i++) sum[i] = sum[i - 1] + phi[i]; // \u7528\u4e8e\u4e3b\u51fd\u6570\u91cc\u6570\u8bba\u5206\u5757\u7684\u4f18\u5316\uff0c\u4e0d\u7528\u6570\u8bba\u5206\u5757\u4f18\u5316\u7684\u8bdd\u53ef\u4ee5\u5ffd\u7565 \n}\n\nint main()\n{\n\tcin >> n;\n\tEuler_Phi(n);\n\tregister int l, r;  // \u4ee5\u4e0b\u7684\u8fd9\u4e2a\u5faa\u73af\u4e3a\u6570\u8bba\u5206\u5757\uff0c\u7528\u6765\u4f18\u5316\u65f6\u95f4\uff0c\u5982\u679c\u770b\u4e0d\u61c2\u4e0b\u9762\u7684\u8fd9\u4e2a\u5faa\u73af\u76f4\u63a5\u6362\u4e3a\u6309\u7167\u63a8\u51fa\u6765\u7684\u6700\u7ec8\u5f0f\u5b50\u6765\u679a\u4e3e \n\tfor(l = 1; l <= n; l = r + 1) \n\t{\n\t\tr = n / (n / l);\n\t\tans += (sum[r] - sum[l - 1]) * (n / l) * (n / l);\n\t}\n\tcout << ans << '\\n';\n\treturn 0;\n}\n```\n\n\u5bf9\u672c\u9898\u6709\u4ec0\u4e48\u7591\u95ee\u7684\u8bdd\u76f4\u63a5\u5728\u8ba8\u8bba\u533a\u53d1\u6216\u8005\u6d1b\u8c37\u79c1\u4fe1\u90fd\u53ef\u4ee5\uff0c\u672c\u4eba\u770b\u5230\u540e\u53ca\u65f6\u56de\u590d\u3002\n\n\u8c22\u8c22\u9605\u8bfb\u3002",
        "postTime": 1568123560,
        "uid": 162864,
        "name": "\u5c0f\u5fc3\u6f02\u4eae\u5973\u4eba",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2398 GCD SUM"
    },
    {
        "content": "\u9996\u5148\u5c06\u9898\u76ee\u5316\u7b80\u4e3a\n\n$\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\gcd(i,j)$;\n\n\u6211\u4eec\u679a\u4e3ei\uff0cj\u7ea6\u6570d\n\n$\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\sum_{d|i,j}\\gcd(i,j)==d$;\n\n\u518d\u8fdb\u884c\u53d8\u6362\u5f97$\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\sum_{d|i,j}d*\\gcd(i/d,j/d)==1$\n\n\u5c06\u7ea6\u6570\u7684\u679a\u4e3e\u63d0\u524d$\\sum_{d=1}^{n}d\\sum_{i=1}^{\\frac{n}{d}}\\sum_{j=1}^{\\frac{n}{d}}\\gcd(i,j)==1$\n\n\u5c06\u6700\u540e\u4e00\u4e2asum\u53d8\u6362$\\sum_{d=1}^{n}d(\\sum_{i=1}^{\\frac{n}{d}}{(2*\\sum_{j=1}^{i}\\gcd(i,j)==1)}-1)$\n\n\u53d1\u73b0\u6700\u540e\u4e00\u4e2asum\u5c31\u662f\u6b27\u62c9\u51fd\u6570$\\phi(i)$\n\n\u6700\u540e\u4e00\u6b65\u53d8\u6362\u5f97$\\sum_{d=1}^{n}d(2*\\sum_{i=1}^{\\frac{n}{d}}{\\phi(i)}-1)$\n\n\u5bf9\u6b27\u62c9\u51fd\u6570\u8fdb\u884c\u7ebf\u6027\u7b5b\u5e76\u6c42\u524d\u7f00\u548c\u65b9\u4fbf\u67e5\u8be2\n\n\u65f6\u95f4\u590d\u6742\u5ea6O(n)\n\n\u7136\u540e\u5c31\u53ef\u4ee5AC \u8fd9\u9053\u9898\u4e86\n\n\u5b8c\u6574\u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#define LL long long\nusing namespace std;\nconst int maxn=1e5+5;\nint n,cnt;\nLL ans;\nint phi[maxn],pri[maxn],vis[maxn];\nLL sum[maxn];\ninline void get_phi(int x){\n\tphi[1]=1;\n\tfor(int i=2;i<=x;++i){\n\t\tif(!vis[i]){\n\t\t\tpri[++cnt]=i;\n\t\t\tphi[i]=i-1;\n\t\t}\n\t\tfor(int j=1;j<=cnt&&pri[j]*i<=x;++j){\n\t\t\tvis[i*pri[j]]=1;\n\t\t\tif(i%pri[j]==0){\n\t\t\t\tphi[i*pri[j]]=phi[i]*pri[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tphi[i*pri[j]]=phi[i]*(pri[j]-1);\n\t\t}\n\t}\n\tfor(int i=1;i<=x;++i)sum[i]=sum[i-1]+phi[i];\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tget_phi(n);\n\tfor(int i=1;i<=n;++i)\n\t\tans+=(2*sum[n/i]-1)*i;\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1568603391,
        "uid": 151768,
        "name": "\u6d41\u901d\u4e36",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "\u697c\u4e0b\u7684\u9898\u89e3\u5df2\u7ecf\u5f88\u597d\u4e86\uff0c\uff0c\u4f46\u662f\u6211\u6709(~~\u770b\u5230\u4e86~~)\u66f4\u597d\u7684\u505a\u6cd5(\u771f\u7684\u662f\u770b\u5230\uff0c\u4e0d\u662f\u627e\u7684\u3002\u3002)\u3002\u3002\u3002\u3002\n\n[dalao\u7684blog](http://www.cnblogs.com/candy99/p/mobius.html)    \u6b22\u8fce\u5927\u5bb6\u6210\u4e3adalao\u7684\u7b2c100\u4e2a\u7c89\n\n\u4e0d\u591a\u8bf4\u4e86\uff0c\u76f4\u63a5\u4e0a\u56fe\n\n ![](https://cdn.luogu.com.cn/upload/pic/9222.png) \n\n\u7136\u540e\u6709\u4e00\u70b9\u5f88\u91cd\u8981\u554a\u3002\u3002\n\n\u5173\u4e8e\u5982\u4f55O(n)\u6c42\u6b27\u62c9\u51fd\u6570\uff0c\u8fd8\u53ef\u4ee5\u540c\u65f6\u628a\u6b27\u62c9\u7b5b\u505a\u6389\uff0c\u8fd9\u6837\u624d\u53ef\u4ee5O\uff08n\uff09\u89e3\u51b3\u6b64\u95ee\u9898\u3002\n\n\u8bc1\u660e\u4ec0\u4e48\u7684\u3002\u3002\u81ea\u5df1\u53bbdalao\u7684blog\u91cc\u7ffb\u7ffb\u8fd8\u662f\u627e\u5f97\u5230\u7684\u3002\u3002\uff08\u6211\u597d\u61d2\u554a\u3002\u3002\u4e0d\u60f3\u627e\u3002\u3002\uff09\n\n\u7136\u540e\u8fd8\u662f\u627e\u51fa\u6765\u4e86\u554a\u3002\u3002[\u6b27\u62c9\u51fd\u6570](http://www.cnblogs.com/candy99/p/6200660.html)\n\n\u6838\u5fc3\u4ee3\u7801\uff1a\n\n```cpp\nint p[N],n;ll phi[N];bool notp[N];\nvoid seive(int n){\n    phi[1] = 1;\n    for(int i=2;i<=n;++i) {\n        if(!notp[i]) p[++p[0]] = i, phi[i] = i-1;\n        for(int j=1;j<=p[0] && i*p[j]<=n;++j) {\n            notp[i*p[j]] = 1;\n            if(i%p[j]==0){phi[i*p[j]]=phi[i]*p[j];break;}\n            phi[i*p[j]] = phi[i]*(p[j]-1);\n        }\n    }\n    for(int i=1;i<=n;++i) phi[i] += phi[i-1];                   // \u6700\u540e\u6c42\u4e86\u4e00\u4e0b\u524d\u7f00\u548c\u3002\u3002\n}\nll cal(int n,int m){\n    ll ans = 0;int r;\n    for(int i=1;i<=n;i=r+1) {\n        r = min(n/(n/i), m/(m/i));\n        ans += (phi[r]-phi[i-1]) * (n/i) * (m/i);\n    }\n    return ans;\n}\n```\n\u5176\u4ed6\u7684\uff0c\uff0c\u597d\u50cf\u6ca1\u4e86\u5427\u3002\u3002\u3002\u90a3\u5c31\u8fd9\u6837\u5427\u3002\u3002\u590d\u6742\u5ea6 O(n) \u54e6\u3002\u3002\n",
        "postTime": 1508246694,
        "uid": 48991,
        "name": "\u9752\u886b\u767d\u53d9",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "### \u4e00\u7bc7~~\u968f\u610f\u53e3\u80e1\u778e\u63a8\u5f0f\u5b50~~\u7684\u9898\u89e3\n\n\u542c\u673a\u623f\u7684\u5927\u4f6c\u4eec\u8bf4\u8fd9\u4e2a\u63a8\u5f0f\u5b50\u7684\u65b9\u5f0f\u53eb\u6b27\u62c9\u53cd\u6f14\uff1f~~qwq\u539f\u6765\u6211\u4f1a\u8fd9\u4e1c\u897f~~\n\n\n\n------------\n\n\n- **\u524d\u5907\u77e5\u8bc6**\n\n$$\\sum_{d|n}\\varphi(d)=n$$\n\n~~\uff08\u8be6\u89c1\u6b27\u62c9\u51fd\u6570\u7684\u6027\u8d28qwq\uff09~~\n\n\n\n------------\n\n\n- **\u8fdb\u5165\u6b63\u9898**\n\n\u9898\u76ee\u8981\u6c42\u7684\u4e1c\u897f\u662f\n$$\\sum_{i=1}^{n} \\sum_{j=1}^{n}gcd(i,j)$$\n\n\u7531\u90a3\u4e2a\u524d\u5907\u77e5\u8bc6\u53ef\u4ee5\u5f97\u5230\n$$gcd(i,j)=\\sum_{d|gcd(i,j)}\\varphi(d)$$\n\n\u90a3\u4e48\u6211\u4eec\u6211\u4eec\u9614\u4ee5\u628a\u8981\u6c42\u7684\u5f0f\u5b50\u5316\u4e3a\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\sum_{d|gcd(i,j)}\\varphi(d)$$\n\n$d|gcd(i,j)$\u663e\u7136\u53c8\u53ef\u4ee5\u5199\u6210$d|i\\ and\\ d|j$\u5373$d|i,j$\n\n\u5219\n\n$$\\text{\u539f\u5f0f}=\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\sum_{d|i,j}\\varphi(d)\\qquad\\qquad\\qquad$$\n\n$$=\\sum_{d=1}^{n}\\varphi(d)\\sum_{i=1}^{n}\\sum_{j=1}^{n}[d|i][d|j]$$\n\n$$=\\sum_{d=1}^{n}\\varphi(d)\\sum_{i=1}^{n}[d|i]\\sum_{j=1}^{n}[d|j]$$\n\n$$=\\sum_{d=1}^{n}\\varphi(d)\\lfloor\\frac{n}{d}\\rfloor\\lfloor\\frac{n}{d}\\rfloor\\qquad\\quad$$\n\n$$=\\sum_{d=1}^{n}\\varphi(d)\\lfloor\\frac{n}{d}\\rfloor^{2}\\qquad\\qquad$$\n\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(n)$\n\n\n\n------------\n\n\n\n~~\u653e\u4e0a\u4e11\u964b\u7684\u4ee3\u7801qwq~~\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#define int long long\nusing namespace std;\n\ninline int read() {\n\tint op = 1, a = 0; char c = getchar();\n\tfor (; c < '0' || c > '9'; c = getchar()) if (c == '-') op = -1;\n\tfor (; c >= '0' && c <= '9'; c = getchar()) a = a * 10 + c - '0';\n\treturn op * a;\n}\n\nconst int maxn = 2000003;\n\nint cnt;\nint phi[maxn];\nint prime[maxn];\n\nvoid Euler() {\n\tphi[1] = 1;\n\tfor (int i = 2; i <= maxn - 3; i++) {\n\t\tif (!phi[i]) prime[++cnt] = i, phi[i] = i - 1;\n\t\tfor (int j = 1; j <= cnt && i * prime[j] <= maxn - 3; j++) {\n\t\t\tif (i % prime[j] == 0) {\n\t\t\t\tphi[i * prime[j]] = phi[i] * prime[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse phi[i * prime[j]] = phi[i] * phi[prime[j]];\n\t\t}\n\t}\n}\n\nint n, ans;\n\nsigned main() {\n\tn = read();\n\tEuler(); \n\tfor (int i = 1; i <= n; i++)\n\t\tans += phi[i] * (n / i) * (n / i);\n\tcout << ans << '\\n';\n\treturn 0;\n}\n```\n\n\n\n------------\n\n\n\u8fd9\u4e2a\u4e1c\u897f\u8fd8\u53ef\u4ee5\u7a0d\u5fae\u6269\u5c55\u4e00\u4e0b\uff0c\u628a\u5176\u4e2d\u4e00\u4e2a$n$\u6362\u6210$m$\n\n$$\\sum_{i=1}^{n} \\sum_{j=1}^{m}gcd(i,j)\\qquad$$\n\n$$=\\sum_{i=1}^{n}\\sum_{j=1}^{m}\\sum_{d|i,j}\\varphi(d)\\qquad\\quad$$\n\n$$\\qquad=\\sum_{d=1}^{min(n,m)}\\varphi(d)\\sum_{i=1}^{n}\\sum_{j=1}^{m}[d|i][d|j]$$\n\n$$\\qquad=\\sum_{d=1}^{min(n,m)}\\varphi(d)\\sum_{i=1}^{n}[d|i]\\sum_{j=1}^{m}[d|j]$$\n\n$$=\\sum_{d=1}^{min(n,m)}\\varphi(d)\\lfloor\\frac{n}{d}\\rfloor\\lfloor\\frac{m}{d}\\rfloor\\quad$$\n",
        "postTime": 1568122272,
        "uid": 162865,
        "name": "NxtEcho",
        "ccfLevel": 0,
        "title": "P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "## \u4e00\u9053\u6570\u5b66\u9898\n\n$\\sum_{i=1}^{n}$\n$\\sum_{j=1}^{n}$\n$gcd(i,j)$\n\n### \u66b4\u529b\u4ee3\u780130\u5206...\n```cpp\nfor(register int i=1;i<=n;++i)\n    for(register int j=1;j<=n;++j)\n        sum+=gcd(i,j);\n```\n\n### \u4e8e\u662f\u5f00\u59cb\u63a8\u5f0f\u5b50\n\n$\\sum_{d=1}^{n}d \\sum_{i=1}^{n} \\sum_{j=1}^{n}$ $[gcd(i,j)==d]$\n\n$\\sum_{d=1}^{n}d \\sum_{i=1}^{n/d} \\sum_{j=1}^{n/d}$ $[gcd(i,j)==1]$\n\n### \u901a\u8fc7\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5f97\n\n$\\sum_{d=1}^{n}d \\sum_{i=1}^{n }[i$ $mod$ $d==0] \\mu(\\frac{i}{d}) [\\frac{n}{i}]^2$  \n\n$\\sum_{d=1}^{n}d \\sum_{d|i} \\mu(\\frac{i}{d}) [\\frac{n}{i}]^2$  \n\n$\\sum_{i=1}^{n} \\sum_{d|i} d\\mu(\\frac{i}{d})[\\frac{n}{i}]^2$  \n\n### \u51fa\u73b0\u4e86\uff0c\u6b27\u62c9\u51fd\u6570\uff01\n\n$\\sum_{i=1}^{n}\\varphi(i)[\\frac{n}{i}]^2$ \n\n\n#### \u7136\u540e\u56e0\u4e3a\u6570\u636e\u592a\u6c34\uff0c\u76f4\u63a5\u5199\u6b27\u62c9\u51fd\u6570\u5361\u8fc7\u4e86^_^\uff01\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll sum,ans,n;\ninline ll gcd(ll a,ll b){return b==0?a:gcd(b,a%b);}\ninline ll euler(ll n)\n{\n    ll tmp=n;\n    for(register ll i=2;i*i<=n;++i)\n    {\n        if(n%i) continue;\n        tmp=tmp-tmp/i;\n        do n/=i;\n        while(n%i==0);\n    }\n    if(n>1) tmp=tmp-tmp/n;\n    return tmp;\n}\nint main()\n{\n    scanf(\"%lld\",&n);\n    for(register ll i=1;i<=n;++i) \n    \tsum+=euler(i)*(n/i)*(n/i);\n    cout<<sum<<endl;\n}\n\n```\n",
        "postTime": 1567696806,
        "uid": 212902,
        "name": "\u5fa1\u5742\u7f8e\u74340502",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "\u8bb0f(n)=gcd(1,n)+gcd(2,n)+...+gcd(n-1,n)\n\n\u5219\u7b54\u6848\u4e3a2\\*[f(2)+f(3)+..+f(n)]+gcd(1,1)+gcd(2,2)+...+gcd(n,n)\n\n=2\\*[f(2)+f(3)+..+f(n)]+(1+n)\\*n/2\n\n\u6ce8\u610f\u5230\u6240\u6709\u7684gcd(x,n)\u7684\u503c\u90fd\u662fn\u7684\u7ea6\u6570\uff0c\u53ef\u4ee5\u628a\u8fd9\u4e9b\u7ea6\u6570\u5206\u7c7b,\u8bbeg(n,i)\u8868\u793a\u6ee1\u8db3\u6761\u4ef6\u4e3agcd(x,n)=i\u4e14x\u4e3a\u6b63\u6574\u6570\u7684x\u7684\u4e2a\u6570\n\n\u5219f(n)=sigma{i\\*g(n,i),i\u4e3an\u7684\u7ea6\u6570}\n\n\u56e0\u4e3agcd(x,n)=i\u7684\u5145\u8981\u6761\u4ef6\u4e3agcd(x/i,n/i)=1\uff0c\u56e0\u6b64\u6ee1\u8db3\u6761\u4ef6\u7684x/i\u6709\n\nphi(n/i)\u4e2a(phi\u4e3a\u6b27\u62c9\u51fd\u6570),\u6240\u4ee5g(n,i)=phi(n/i)\n\n\u518d\u7528\u524d\u7f00\u548c\u9012\u63a8\u51fas[n]=f(2)+f(3)+...+f(n)\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long //\u8fd8\u662f\u81ea\u89c9\u6362long long \u66f4\u597d\u5427\nconst int maxn=100000+5;\nint phi[maxn];\nint f[maxn];\nint s[maxn];\nvoid phi_table(int n)\n{\n for(int i=2;i<=n;i++) phi[i]=0;\n phi[1]=1;\n for(int i=2;i<=n;i++) if(!phi[i]) \n  for(int j=i;j<=n;j+=i)\n  {\n   if(!phi[j]) phi[j]=j;\n   phi[j]=phi[j]/i*(i-1);\n  }\n} \n main()\n{\n int n;\n cin>>n;\n phi_table(n);\n for(int i=1;i<=n;i++)\n  for(int j=i*2;j<=n;j+=i)\n  f[j]+=i*phi[j/i];\n for(int i=1;i<=n;i++) s[i]=s[i-1]+f[i];\n cout<<s[n]*2+(1+n)*n/2;\n return 0;\n}\n\n```",
        "postTime": 1515742441,
        "uid": 27114,
        "name": "BlueArc",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "\u8981\u6c42\n$$\\sum_{i=1}^n\\sum_{j=1}^ngcd(i,j)$$\n\u679a\u4e3e$gcd(i,j)=x$\uff0c\u5373\n$$\\sum_{i=1}^n\\sum_{j=1}^n\\sum_{x=1}^n[gcd(i,j)=x]\\times x$$\n$$=\\sum_{i=1}^n\\sum_{j=1}^n\\sum_{x=1}^n[gcd(i/x,j/x)=1]\\times x$$\n\u53d8\u6362\u987a\u5e8f\u5f97\n$$\\sum_{x=1}^nx\\times \\sum_{i=1}^n\\sum_{j=1}^n[gcd(i/x,j/x)=1]$$\n\u7531\u6b27\u62c9\u51fd\u6570\u5b9a\u4e49\uff0c$\\varphi(n)=\\sum_{i=1}^n[gcd(i,n)=1]$\n\u539f\u5f0f\u5316\u4e3a\n$$\\sum_{x=1}^nx\\times ((\\sum_{i=1}^{n/x}2\\varphi(i))-1)\\text{  \u6709\u5e8f\u5bf9\u6240\u4ee5\u4e582\uff0c\u4f46(x,x)\u53ea\u6709\u4e00\u6b21}$$\n\n\u8003\u8651\u5148$O(n)$\u7b5b\u6cd5\u6c42$\\varphi,sum(n)=\\sum_{i=1}^n\\varphi(i)=sum(n-1)+\\varphi(n)$  \n\u6700\u540e\u5c31\u662f\n$$\\sum_{x=1}^nx\\times (2sum(n/x)-1)$$\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n)$\n```cpp\n/**********/\n#define MAXN 1000011\nll phi[MAXN],sum[MAXN],p[MAXN],cnt=0;\nbool vis[MAXN];\nvoid sieve(ll n)\n{\n\tvis[1]=1;\n\tphi[1]=1;\n\tfor(ll i=2;i<=n;++i)\n\t{\n\t\tif(!vis[i])\n\t\t{\n\t\t\tphi[i]=i-1;\n\t\t\tp[++cnt]=i;\n\t\t}\n\t\tfor(ll j=1;j<=cnt&&i*p[j]<=n;++j)\n\t\t{\n\t\t\tvis[i*p[j]]=1;\n\t\t\tphi[i*p[j]]=phi[i]*(p[j]-1);\n\t\t\tif(i%p[j]==0)\n\t\t\t{\n\t\t\t\tphi[i*p[j]]=phi[i]*p[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tfor(ll i=1;i<=n;++i)sum[i]=sum[i-1]+phi[i];\n}\nint main()\n{\n\tll n=read(),ans=0;\n\tsieve(n);\n\tfor(ll i=1;i<=n;++i)\n\t\tans+=i*sum[n/i]*2-i;\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```\n\nExt:  \n\u5982\u679c\u6709\u5f88\u591a\u7ec4(\u59821e5\uff09\u8be2\u95ee\u5462\uff1f",
        "postTime": 1579525074,
        "uid": 73142,
        "name": "\u4e07\u5f18",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n\n\u8fd9\u9053\u9898\u5c31\u662f\u8ba9\u4f60\u6c42$\\sum_{d=1}^n\\sum_{i=1}^{n}\\sum_{j=1}^n(gcd(i,j)=d)$\n\n\u628a\u5f0f\u5b50\u6539\u4e3a$\\sum_{d=1}^n\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor} \\sum_{j=1}^{\\lfloor \\frac{n}{d} \\rfloor}(gcd(i,j)=1) $\uff0c\u6c42\u548c\u7684\u65f6\u5019\u6211\u4eec\u4e58\u4e0a$d$\u5373\u53ef\n\n\u7136\u540e\u5c31\u662f\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u57fa\u672c\u5957\u8def\uff0c\u540e\u9762\u90a3\u4e00\u622a$\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor} \\sum_{j=1}^{\\lfloor \\frac{n}{d} \\rfloor}(gcd(i,j)=1)$\u5c31\u76f8\u5f53\u4e8e$\\sum_{k=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\mu(k)\\lfloor\\frac{n}{id}\\rfloor\\lfloor\\frac{n}{jd}\\rfloor$\n\n\u7136\u540e\u679a\u4e3e$n$\uff0c\u540e\u9762\u6574\u9664\u5206\u5757\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5927\u6982\u662f$O(n\\sqrt n)$\uff1f\n\nqwq\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint mu[2000010],prime[400020],cnt,vis[2000010],n,m;\nvoid shai()\n{\n    mu[1]=1;\n    for(int i=2;i<=n;i++)\n    {\n        if(!vis[i])\n        {\n            prime[++cnt]=i;\n            mu[i]=-1;\n        }\n        for(int j=1;j<=cnt&&i*prime[j]<=n;j++)\n        {\n            vis[i*prime[j]]=1;\n            if(i%prime[j]==0)\n            {\n                break;\n            }\n            mu[i*prime[j]]=-mu[i];\n        }\n        mu[i]+=mu[i-1];\n    }\n}\nint main()\n{\n    cin>>n;\n    shai();\n    m=n;\n    unsigned long long ans=0;\n    for(int i=1;i<=m;i++)\n    {\n        n=m;\n        n/=i;\n        unsigned long long perans=0;\n        for(int j=1;j<=n;j++)\n        {\n            int l=(n/(n/j));\n            perans+=(unsigned long long)(mu[l]-mu[j-1])*(unsigned long long)(n/j)*(unsigned long long)(n/j);\n            j=l;\n        } \n        perans*=(unsigned long long)i;\n        ans+=perans;\n    }\n    cout<<ans;\n}\n```",
        "postTime": 1543676265,
        "uid": 48265,
        "name": "decoqwq",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "## \u9898\u610f\n\n\u6c42$\\sum_{i=1}^{n}\\sum_{j=1}^{n} gcd(i,j)$\uff0c$n<=10^5$\n\n## \u9898\u89e3\n\n\u63a8\u4e00\u4e0b\u5f0f\u5b50\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u662f\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u7ecf\u5178\u5957\u8def\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{n} gcd(i,j)$$\n\n$$=\\sum_{d=1}^{n}\\sum_{i=1}^{n}\\sum_{j=1}^{n} [gcd(i,j) = d]$$\n\n$$=\\sum_{d=1}^{n}d\\sum_{i'=1}^{\\lfloor \\frac{n}{d}\\rfloor}\\sum_{j'=1}^{\\lfloor \\frac{n}{d}\\rfloor} [gcd(i',j') = 1]$$\n\n$$=\\sum_{d=1}^{n}d\\sum_{i'=1}^{\\lfloor \\frac{n}{d}\\rfloor}\\sum_{j'=1}^{\\lfloor \\frac{n}{d}\\rfloor} e(gcd(i',j'))$$\n\n\u7528\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u5c55\u5f00$e$\u51fd\u6570\uff1a\n\n$$=\\sum_{d=1}^{n}d\\sum_{i'=1}^{\\lfloor \\frac{n}{d}\\rfloor}\\sum_{j'=1}^{\\lfloor \\frac{n}{d}\\rfloor} \\sum_{d'|gcd(i',j')}\\mu(d')$$\n\n$$=\\sum_{d=1}^{n}d\\sum_{i'=1}^{\\lfloor \\frac{n}{d}\\rfloor}\\sum_{j'=1}^{\\lfloor \\frac{n}{d}\\rfloor} \\sum_{d'|i',d'|j'}\\mu(d')$$\n\n\u53d8\u6362\u679a\u4e3e\u987a\u5e8f\uff0c\u628a$d'$\u63d0\u524d:\n\n$$=\\sum_{d=1}^{n} d\\sum_{d'=1}^{n}\\mu(d') \\sum_{i'=1,d'|i'}^{\\lfloor \\frac{n}{d}\\rfloor}\\sum_{j'=1,d'|j'}^{\\lfloor \\frac{n}{d}\\rfloor} 1$$\n\n$$=\\sum_{d=1}^{n} d\\sum_{d'=1}^{n}\\mu(d') \\sum_{i'=1}^{\\lfloor \\frac{n}{dd'}\\rfloor}\\sum_{j'=1}^{\\lfloor \\frac{n}{dd'}\\rfloor} 1$$\n\n$$=\\sum_{d=1}^{n} \\sum_{d'=1}^{n}id(d)\\mu(d') \\lfloor \\frac{n}{dd'}\\rfloor \\lfloor \\frac{n}{dd'}\\rfloor$$\n\n\u679a\u4e3e$k=dd'$\uff1a\n\n$$=\\sum_{k=1}^{n}\\sum_{d=1}^{n}id(d)\\mu(\\lfloor \\frac{k}{d}\\rfloor) \\lfloor \\frac{n}{k}\\rfloor \\lfloor \\frac{n}{k}\\rfloor$$\n\n$$=\\sum_{k=1}^{n}(id*\\mu)(k) \\lfloor \\frac{n}{k}\\rfloor \\lfloor \\frac{n}{k}\\rfloor$$\n\n\u6ce8\u610f\u72c4\u5229\u514b\u96f7\u5377\u79ef\u7684\u6027\u8d28\uff1a$id*\\mu=\\phi$\n\n$$=\\sum_{k=1}^{n}\\phi(k) \\lfloor \\frac{n}{k}\\rfloor \\lfloor \\frac{n}{k}\\rfloor$$\n\n\u4e8e\u662f\u53ef\u4ee5\u7ebf\u6027\u7b5b$O(n)$\u9884\u5904\u7406$\\phi$\uff0c\u7136\u540e\u901a\u8fc7\u6570\u8bba\u5206\u5757$O(\\sqrt n)$\u8ba1\u7b97\u7b54\u6848.\n\n```cpp\n#include <iostream>\n#include <cstring>\n#include <cstdio>\nusing namespace std;\n\ntypedef long long LL;\n\nconst int MAXN = 100100;\n\nbool tag[MAXN];\nint n, pr[MAXN], cnt, phi[MAXN];\nLL phis[MAXN], ans;\n\nvoid sieve(int n) { //\u7ebf\u6027\u7b5b\u6a21\u7248 \n\tmemset(tag, 1, sizeof tag); tag[1] = false;\n\tphi[1] = phis[1] = 1;\n\tfor(int i = 2; i <= n; i ++) {\n\t\tif(tag[i]) {\n\t\t\tpr[++ cnt] = i;\n\t\t\tphi[i] = i - 1;\n\t\t}\n\t\tfor(int j = 1; j <= cnt && i * pr[j] <= n; j ++) {\n\t\t\ttag[i * pr[j]] = false;\n\t\t\tif(i % pr[j] == 0) {\n\t\t\t\tphi[i * pr[j]] = phi[i] * pr[j];\n\t\t\t\tbreak ;\n\t\t\t}\n\t\t\tphi[i * pr[j]] = phi[i] * (pr[j] - 1);\n\t\t}\n\t\tphis[i] = phis[i - 1] + phi[i]; //phis\u4e3a\u6b27\u62c9\u51fd\u6570\u7684\u524d\u7f00\u548c. \n\t}\n}\n\nint main() {\n\tscanf(\"%d\", &n);\n\tsieve(n);\n\tfor(int i = 1, j; i <= n; i = j + 1) {\n\t\tj = n / (n / i); //j\u4e3a\u5f53\u524d\u5757\u7684\u53f3\u7aef\u70b9\uff0ci\u4e3a\u5de6\u7aef\u70b9 \n\t\tans += (n / i) * 1ll * (n / i) * (phis[j] - phis[i - 1]);\n\t}\n\tprintf(\"%lld\\n\", ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1535004823,
        "uid": 20375,
        "name": "hongzy",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "## \u524d\u7f6e\u829d\u58eb\n\n- \u6570\u8bba\u5206\u5757\uff0c\u4e00\u70b9\u70b9\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n\n## \u6b63\u6587\n\u9898\u76ee\u8981\u6c42\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{n}gcd(i,j)$$\n\n\u7136\u540e\u518d\u53bb\u91cd\u3002\n\n\u53ef\u4ee5\u60f3\u5230\u679a\u4e3e$n$\u4ee5\u5185\u7684$p$\uff0c\u628a\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u6539\u6210$p\\times gcd(i,j)=p$\u7684\u6570\u7684\u4e2a\u6570\n\n$$\\sum_{p=1}^{n}p\\sum_{i=1}^{n}\\sum_{j=1}^{n}[gcd(i,j)=p]$$\n\n\u5316\u7b80\u5f0f\u5b50\n\n$$\\sum_{p=1}^{n}p\\sum_{i=1}^{\\left \\lfloor \\frac{n}{p} \\right \\rfloor }\\sum_{j=1}^{\\left \\lfloor \\frac{n}{p} \\right \\rfloor }[gcd(i,j)=1]$$\n\n\u56e0\u4e3a$[gcd(i,j)=1]$\u53ea\u6709$gcd(i,j)=1$\u6709$1$\u7684\u8d21\u732e\uff0c\u5426\u5219\u6ca1\u6709\uff0c\u6240\u4ee5\u53ef\u4ee5\u66ff\u6362\u4e3a$\\varepsilon(gcd(i,j))$\n\n$\\varepsilon(x)$\u5373\u4e3a\u5f53$x=1$\u65f6\u5bf9\u7b54\u6848\u8d21\u732e\u4e3a$1$\uff0c\u5426\u5219\u4e3a$0$\n\n\u6240\u4ee5\u73b0\u5728\u8f6c\u5316\u4e3a\u4e86\n\n$$\\sum_{p=1}^{n}p\\sum_{i=1}^{\\left \\lfloor \\frac{n}{p} \\right \\rfloor }\\sum_{j=1}^{\\left \\lfloor \\frac{n}{p} \\right \\rfloor }\\varepsilon(gcd(i,j))$$\n\n\u7531$Dirichlet$\u5377\u79ef\u5f97\n\n$\\varepsilon =\\mu*1 \\Leftrightarrow    \\varepsilon(n)=\\sum_{d|n}\\mu(d)$\n\n\u6240\u4ee5\u539f\u5f0f\u8f6c\u5316\u4e3a\n$$\\sum_{p=1}^{n}p\\sum_{i=1}^{\\left \\lfloor \\frac{n}{p} \\right \\rfloor }\\sum_{j=1}^{\\left \\lfloor \\frac{n}{p} \\right \\rfloor }\\sum_{d|gcd(i,j)}\\mu(d)$$\n\n\u8f6c\u5316\u4e00\u4e0b\u6c42\u548c\u987a\u5e8f\n\n$$\\sum_{p=1}^{n}p\\sum_{d=1}{\\mu(d)}\\sum_{i=1}^{\\left \\lfloor \\frac{n}{p} \\right \\rfloor }[d\\ |\\ i]\\sum_{j=1}^{\\left \\lfloor \\frac{n}{p} \\right \\rfloor}[d\\ | \\ j]$$\n\n\u540e\u9762\u4e24\u4e2a\u5373\u4e3a\u6c42$\\left \\lfloor \\frac{n}{p} \\right \\rfloor$\u4e2d$d$\u7684\u500d\u6570\uff0c\u6613\u77e5\u5176\u7b54\u6848\u4e3a$\\left \\lfloor \\frac{n}{pd} \\right \\rfloor$\n\n\u6240\u4ee5\u7b54\u6848\u8f6c\u5316\u4e3a\n\n$$ans=\\sum_{p=1}^{n}p\\sum_{d=1}\\mu(d)\\left \\lfloor \\frac{n}{pd} \\right \\rfloor\\left \\lfloor \\frac{n}{pd} \\right \\rfloor$$\n\n\u540e\u9762\u90a3\u73a9\u610f\u7528\u6570\u8bba\u5206\u5757\u548c\u524d\u7f00\u548c\u5373\u53ef\u3002\n\n$Code\uff1a$\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\nusing namespace std;\n#define int long long \ninline int read(){\n\tregister int x=0,f=0,ch=getchar();\n\twhile('0'>ch||ch>'9')f^=ch=='-',ch=getchar();\n\twhile('0'<=ch&&ch<='9')x=(x<<1)+(x<<3)+(ch^'0'),ch=getchar();\n\treturn f?-x:x;\n}\nconst int MAX=100005;\nint n,tot,p[MAX],f[MAX],mu[MAX];\ninline void Gmu(){\n\tmu[1]=1;tot=0;\n\tfor(register int i=2;i<=n;++i){\n\t\tif(!f[i]){\n\t\t\tp[++tot]=i;\n\t\t\tmu[i]=-1;\n\t\t}\n\t\tfor(register int j=1;j<=tot&&i*p[j]<=n;++j){\n\t\t\tf[i*p[j]]=1;\n\t\t\tif(i%p[j]==0){\n\t\t\t\tmu[i*p[j]]=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmu[i*p[j]]=-mu[i];\n\t\t}\n\t}\n\tfor(register int i=1;i<=n;++i)mu[i]+=mu[i-1]; \n} \nint res,ans;\ninline void solve(int n,int p){\n\tres=0;\n\tfor(register int l=1,r;l<=n;l=r+1){\n\t\tr=n/(n/l);\n\t\tres+=(mu[r]-mu[l-1])*(n/l)*(n/l);\n\t}\n\tans+=res*p;\n}\nsigned main(){\n\tn=read();\n\tGmu();\n\tfor(register int p=1;p<=n;++p)solve(n/p,p);\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n\u5199\u5f97\u6709\u4ec0\u4e48\u95ee\u9898\u9ebb\u70e6\u79c1\u4fe1\u7b14\u8005\uff0c\u8c22\u8c22",
        "postTime": 1584669023,
        "uid": 119062,
        "name": "Lates",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "\u9898\u610f\uff1a\n\n\u6c42\n\n$$\\sum\\limits^n_{i=1}\\sum\\limits^n_{j=1} \\text{gcd}(i,j)$$\n\n---\n\n\u8003\u8651 $\\text{gcd}(i,j)$ \u7684\u503c\u6709\u54ea\u4e9b\u3002\n\n\u539f\u5f0f\u7b49\u4e8e\n\n$$\\sum\\limits_S\\sum\\limits^n_{i=1}\\sum\\limits^n_{j=1} S \\cdot [\\text{gcd}(i,j)=S]$$\n\n$$\\sum\\limits_S\\sum\\limits_{Si \\leq n}\\sum\\limits_{Sj \\leq n} S \\cdot [\\text{gcd}(i,j)=1]$$\n\n**\u4e0d\u59a8\u5148\u8003\u8651 $j\\leq i$ \u65f6**\uff0c\u90a3\u4e48\u82e5 $\\text{gcd}(i,j)=1$ \uff0c $j$ \u7684\u53d6\u503c\u663e\u7136\u5c31\u6709 $\\varphi (i)$ \u79cd\u3002\n\n\u90a3\u4e48\u539f\u5f0f\u5c31\u8f6c\u5316\u4e3a\n\n$$\\sum\\limits_S\\sum\\limits_{Si \\leq n} S\\ \\cdot\\ \\varphi(i)$$\n\n$$\\sum\\limits_S\\sum\\limits_{i=1}^{\\left\\lfloor\\frac{n}{S}\\right\\rfloor} S\\ \\cdot\\ \\varphi(i)$$\n\n\u524d\u7f00\u548c\u4f18\u5316\u5373\u53ef\u3002\n\n\u53e6\u5916\u8fd9\u79cd\u65b9\u6cd5\u53ea\u8ba1\u7b97\u4e86 $i\\leq j$ \u7684\u7b54\u6848\uff0c\u6700\u540e\u7b54\u6848\u8fd8\u8981\u7279\u6b8a\u5904\u7406\uff0c\u8fd9\u91cc\u4e0d\u8d58\u8ff0\u3002\n\n\u7b97\u7b26\u590d\u6742\u5ea6 $O(n)$ \uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\ninline int read(){\n\tchar c=getchar();int x=0,f=1;\n    while(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n    while(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\n    return x*f;\n}\nconst int maxn=100010;\nint i,j,k,n,m;\nint prime[maxn],is_prime[maxn],num,phi[maxn];\nll Sum[maxn];\nint main(){\n\tcin>>n;\n\tphi[1]=1;\n\tfor(i=2;i<=n;i++)is_prime[i]=1;\n\tfor(i=2;i<=n;i++){\n\t\tif(is_prime[i]){\n\t\t\tprime[++num]=i;\n\t\t\tphi[i]=i-1;\n\t\t}\n\t\tfor(j=1;j<=num && prime[j]*i<=n;j++){\n\t\t\tis_prime[prime[j]*i]=0;\n\t\t\tphi[prime[j]*i]=phi[i]*(prime[j]-1);\n\t\t\tif(i%prime[j]==0){\n\t\t\t\tphi[prime[j]*i]=phi[i]*prime[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tfor(i=1;i<=n;i++)Sum[i]=Sum[i-1]+phi[i];\n\tll ans=0;\n\tfor(int S=1;S<=n;S++)\n\t\tans+=(ll)S*(Sum[n/S]*2-1);\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1583156414,
        "uid": 35891,
        "name": "huangzirui",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "## \u6253\u8868\u51fa\u5947\u8ff9\n\n~~\u7ed9\u4f60\u4e00\u4e2a\u6570\u8ba9\u4f60\u8f93\u51fa\u4e00\u4e2a\u6570\u4f60\u4e0d\u6253\u8868\u4f60\u96be\u9053\u8981\u60f3\u6b63\u89e3\u5417\uff1f~~\n\n~~\u8bdd\u8bf4\u56de\u6765\u641e\u51fa\u8fd9\u5f20\u8868\u6765\u8fd8\u771f\u662f\u9ebb\u70e6\uff0c\u9694\u58c1\\*\\*\\*\u90fdarc\u4e86\u6211\u7684\u8868\u624d\u6253\u5b8c\u3002\u3002\u3002~~\n\n## \u5206\u6bb5\u6253\u8868\n\n\u9996\u5148\u5c31\u662f\u8ba9\u4f60\u6c42\u4e00\u4e2an\\*n\u7684\u77e9\u9635\u7684\u524d\u7f00\u548c\uff0c\u90a3\u4e48\u60f3\u5230\u9012\u63a8\uff1a\n```cpp\nf[i] = f[i-1] + 2 * calc(i) - i\n```\n\u5176\u4e2d`calc(i)`\u8868\u793a$\\sum\\limits_{k\\in [1,i]}(i,k)$\uff0c\u4e5f\u5c31\u662f\u8fd9\u4e2an\\*n\u7684\u65b0\u77e9\u9635\u6bd4\u539f\u6765n-1\\*n-1\u7684\u77e9\u9635\u591a\u51fa\u6765\u7684\u4e00\u884c\u548c\u4e00\u5217\u7684\u503c\uff0c\u7136\u540e\u518d\u51cf\u6389(i,i) = i\uff0c\u56e0\u4e3a\u5143\u7d20(i,i)\u88ab\u7b97\u4e86\u4e24\u904d\u3002\n\n\u4e0b\u9762\u662fgenerator:\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<string>\n#include<map>\nusing namespace std;\n\n#define LL long long\n\nconst LL N = 1e5;\nconst LL SEQ = 1e2; // \u6bcf\u4e00\u6bb5\u7684\u957f\u5ea6\n\nLL f[N * 2];\nLL gcd(LL a,LL b) {return b ? gcd(b, a%b) : a;}\nLL calc(LL n){\n\tLL cnt = 0;\n\tfor(int i=1;i<=n;i++) cnt += 2 * gcd(i,n);\n\treturn cnt;\n}\n\nint main()\n{\n\tfreopen(\"p2398.data\",\"w\",stdout);\n\tprintf(\"%lld,\",f[1] = 1);\n\tfor(LL i=2;i<=N;i++){\n\t    f[i] = f[i-1] + calc(i) - i; \n\t\tif(!(i % SEQ)) printf(\"%lld,\",f[i]);\t\t\n\t}\n}\n```\n\n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\uff1f\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<string>\n#include<map>\nusing namespace std;\n\n#define LL long long\n\nconst int CN = 1e5+5;\n\nconst LL SEQ = 1e2;\nconst LL F[CN] = {1,31080,139848,336784,.../* \u7701\u7565\uff0c\u81ea\u5df1\u53bb\u8dd1generator */};\n\nint n; LL ans;\nLL gcd(LL a,LL b) {return b ? gcd(b, a%b) : a;}\nLL calc(LL k){\n\tLL cnt = 0;\n\tfor(int i=1;i<=k;i++) cnt += 2 * gcd(i,k);\n\treturn cnt;\n}\n\nint main()\n{\n    scanf(\"%d\",&n);\n\n    if(n < SEQ){\n    \tans = F[0]; // ans_1 = f[ 1 ]\n    \tfor(int i=2;i<=n;i++) ans = ans + calc(i) - i;\n\t}\n\telse{\n\t\tint p = n / SEQ; \n\t\tans = F[p]; // ans_1 = f[ p * SEQ ]\n\t\tp *= SEQ; // \u521d\u59cb\u4f4d\u7f6e\n\t\tfor(int i=p+1;i<=n;i++) ans = ans + calc(i) - i; //\u63a8\u51fa\u6765\n\t}\n    \n    printf(\"%lld\",ans);\n\n    return 0;\n}\n```",
        "postTime": 1571747575,
        "uid": 70177,
        "name": "big_news",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "\u8fd9\u4e2a\u9898 \u4e3b\u8981\u662f \u7528\u6765\u6559\u5927\u5bb62\u4e2a\u601d\u60f3\u3002\n\n\n\u66b4\u529b\u768430\u5206\u5c31\u4e0d\u8bf4\u4e86\u3002\n\n\u670940\u5206\u662f 7000-7100 \u8003\u8651\u6253\u8868\u3002 \u5728\u81ea\u5df1\u7535\u8111\u4e0a \u66b4\u529b\u8dd1\u51fa7000-7100\u7684\u7b54\u6848(\u5927\u6982\u89815\u5206\u949f),\u7136\u540e\u8f93\u51fa\u6765 \u5b58\u5230\u7a0b\u5e8f\u91cc,\u76f4\u63a5\u8f93\u51fa\u5373\u53ef\u3002\n\n\u8fd9\u79cd\u6280\u5de7\u9002\u7528\u4e8e \u6570\u636e\u6bd4\u8f83\u5c11\u7684\u60c5\u51b5,\u8981\u7efc\u5408\u8003\u8651\u4ee3\u7801\u957f\u5ea6(\u8868\u592a\u5927\u4e86 cpp\u6587\u4ef6\u4f1a\u592a\u5927)\u548c\u6253\u8868\u7684\u65f6\u95f4\u3002\n\n\n\n\n\n```cpp\n    for (int n=7000;n<=7100;n++)\n    {\n        ll ans=0;\n        for (int i=1;i<=n;i++)\n        {\n            for (int j=i+1;j<=n;j++)\n                ans+=gcd(i,j)*2;\n            ans+=i;\n        }\n        printf(\"f[%d]=%I64d;\\n\",n,ans);\n    }\nf[7000]=275797760;\nf[7001]=275818761;\nf[7002]=275909661;\nf[7003]=275957900;\nf[7004]=276059136;\nf[7005]=276136101;\nf[7006]=276211445;\nf[7007]=276344088;\nf[7008]=276499480;\nf[7009]=276547721;\nf[7010]=276616365;\nf[7011]=276735228;\nf[7012]=276784296;\nf[7013]=276805333;\nf[7014]=276928189;\nf[7015]=277019184;\nf[7016]=277082288;\nf[7017]=277122041;\nf[7018]=277231645;\nf[7019]=277252700;\nf[7020]=277537280;\nf[7021]=277630645;\nf[7022]=277665749;\nf[7023]=277705536;\nf[7024]=277782704;\nf[7025]=277848609;\nf[7026]=277911813;\nf[7027]=277932892;\nf[7028]=278030072;\nf[7029]=278147405;\nf[7030]=278286229;\nf[7031]=278334776;\nf[7032]=278444744;\nf[7033]=278491761;\nf[7034]=278526925;\nf[7035]=278675500;\nf[7036]=278724736;\nf[7037]=278772965;\nf[7038]=278953037;\nf[7039]=278974152;\nf[7040]=279184840;\nf[7041]=279224729;\nf[7042]=279296077;\nf[7043]=279317204;\nf[7044]=279404000;\nf[7045]=279447661;\nf[7046]=279521765;\nf[7047]=279634760;\nf[7048]=279698152;\nf[7049]=279792113;\nf[7050]=279966413;\nf[7051]=280013164;\nf[7052]=280116272;\nf[7053]=280156229;\nf[7054]=280191493;\nf[7055]=280282448;\nf[7056]=280543520;\nf[7057]=280564689;\nf[7058]=280599973;\nf[7059]=280683164;\nf[7060]=280777624;\nf[7061]=280825733;\nf[7062]=280952861;\nf[7063]=280998240;\nf[7064]=281061776;\nf[7065]=281173025;\nf[7066]=281208349;\nf[7067]=281256908;\nf[7068]=281430400;\nf[7069]=281451605;\nf[7070]=281585637;\nf[7071]=281625696;\nf[7072]=281803424;\nf[7073]=281850321;\nf[7074]=281970093;\nf[7075]=282036468;\nf[7076]=282139744;\nf[7077]=282220157;\nf[7078]=282255541;\nf[7079]=282276776;\nf[7080]=282480296;\nf[7081]=282529185;\nf[7082]=282564589;\nf[7083]=282623572;\nf[7084]=282813048;\nf[7085]=282903613;\nf[7086]=282967357;\nf[7087]=283015400;\nf[7088]=283093272;\nf[7089]=283177593;\nf[7090]=283247021;\nf[7091]=283292580;\nf[7092]=283417536;\nf[7093]=283466333;\nf[7094]=283501797;\nf[7095]=283655352;\nf[7096]=283719176;\nf[7097]=283768065;\nf[7098]=283948557;\nf[7099]=283997212;\nf[7100]=284136752;\n```\n\u4e0b\u9762\u662f\u6b63\u89e3\uff1a\nf[d]\u8868\u793agcd=d\u7684(i,j)\u6709\u591a\u5c11\u5bf9.   \u90a3\u4e48sum(f[d]\\*d)\u5c31\u662f\u7b54\u6848\u3002 \u6240\u4ee5\u5982\u4f55\u6c42f[d]\u662f\u5173\u952e\u3002\n\n\u76f4\u63a5\u6c42f[d]\u6709\u56f0\u96be,\u6211\u4eec\u53ef\u4ee5\u7528g[d]\u8868\u793agcd\u662fd\u7684\u500d\u6570\u7684(i,j)\u6709\u591a\u5c11\u5bf9,\u5982\u4f55\u51cf\u53bbf[2\\*d],f[3\\*d],f[4\\*d],f[5\\*d]...\n\ng[d]=(n/d)\\*(n/d). \u53ef\u4ee5\u6309n,n-1,n-2...1\u7684\u987a\u5e8f\u6765\u6c42f[d].\n\n\u6240\u4ee5\u603b\u65f6\u95f4\u5e94\u8be5\u662fn/1+n/2+n/3+n/4+...n/n.  \u8fd9\u4e2a\u4e1c\u897f \u6b27\u62c9\u5f53\u5e74\u7814\u7a76\u8fc7\u7684,\u6709\u5174\u8da3\u7684\u53ef\u4ee5\u767e\u5ea6\u4e00\u4e0b,\u53ea\u8981\u8bb0\u4f4f\u5b83\u662fnlogn\u7ea7\u522b\u7684\u5c31\u597d(\u60f3\u4e00\u60f3\u7b5b\u6cd5)\u3002\u8fd9\u4e2a\u7ed3\u8bba\u5f88\u5e38\u7528,\u8bf7\u5927\u5bb6\u8bb0\u4f4f\u3002\n\n\n```cpp\n    for (int d=n;d>=1;d--)\n    {\n        f[d]=1ll*(1ll*n/d) * 1ll*(n/d);\n        for (int i=d+d;i<=n;i+=d) f[d]-=f[i];\n        ans+=f[d]*d;\n    }\n    printf(\"%I64d\\n\",ans);\n\n```",
        "postTime": 1436512342,
        "uid": 7672,
        "name": "laphets",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "# $Description$\n\n\u6c42$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^n gcd(i,j)$\n\n# $Solution$\n\n> \u8fd9\u79cd$gcd$\u8ba1\u6570\u7684\u9898\u4e00\u822c\u601d\u60f3\u662f\u679a\u4e3e$gcd$\u3002\n\n\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u6709\u4e00\u4e0b\u51e0\u79cd\u505a\u6cd5\uff0c\u5faa\u5e8f\u6e10\u8fdb\n\n### \u66b4\u529b\uff1a$O(n^2logn)$\n\n\u5c31\u662f\u66b4\u529b\u679a\u4e3e\u6240\u6709\u6570\u6c42$gcd$\uff0c\u671f\u671b\u5f97\u5206\u4e0d\u6e05\u695a\uff0c\u5927\u6982$20pts$\n\n\u53ef\u4ee5\u4f18\u5316$gcd$\u51fd\u6570\uff0c\u8bb0\u5fc6\u5316\u4e00\u4e0b\u3002\n\n\u753b\u4e2a\u77e9\u9635\u53d1\u73b0\u53ef\u4ee5\u53ea\u6c42\u4e0b\u4e09\u89d2\uff0c\u5373\u53ea\u6c42$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^{j<i}gcd(i,j)$\uff0c\u5c06\u7b54\u6848$*2$\u540e\u518d\u5355\u72ec\u7528\u7b49\u5dee\u6570\u5217\u6c42\u548c\u516c\u5f0f\u5904\u7406\u5bf9\u89d2\u7ebf\u4e0a\u7684\u60c5\u51b5$(i==j)$\uff0c\u4e00\u987f\u64cd\u4f5c\u731b\u5982\u864e\uff0c\u4f46\u56e0\u4e3a\u4f1a$MLE$\u4ecd\u7136\u65e0\u6cd5\u901a\u8fc7$70pts$\n\n### \u79bb\u6b63\u89e3\u53ea\u5dee\u4e00\u6b65\u7684\u66b4\u529b:$O(n\\sqrt n)$\n\n\u679a\u4e3e\u6240\u6709\u6570$i$\uff0c\u8bbe\u7ec4\u6210\u6570\u5bf9\u7684\u53e6\u4e00\u4e2a\u6570\u4e3a$j$\uff0c\u4ecd\u662f\u53ea\u8003\u8651$i<j$\u7684\u60c5\u51b5\u3002\u8bbe$gcd(i,j)=k$\uff0c\u5219$gcd(\\frac{i}{k} ,\\frac{j}{k})=1$\uff0c\u7b26\u5408\u8fd9\u6837\u7684\u6570$\\frac{j}{k}$\u7684\u4e2a\u6570\u5c31\u5e94\u8be5\u662f$\\phi(\\frac{i}{k})$\uff0c\u6240\u4ee5$O(\\sqrt n)$\u679a\u4e3e$i$\u7684\u6240\u6709\u56e0\u6570\u4e3a$gcd$\uff0c$ans+=gcd\\cdot \\phi(\\frac{i}{gcd})$\u3002\u603b\u590d\u6742\u5ea6$O(n\\sqrt n)$\u3002\n\n\n\n$70pts$\u80af\u5b9a\u662f\u7a33\u8fc7\u7684\uff0c\u81f3\u6b64\u79bb\u6b63\u89e3\u53ea\u5dee\u4e00\u6b65\u3002\n\n### \u6b63\u89e3$O(nln n)$\n\n\u4e0a\u9762\u679a\u4e3e\u56e0\u5b50$O(\\sqrt n)$\u663e\u7136\u662f\u53ef\u4ee5\u4f18\u5316\u7684\uff0c\u53ef\u4ee5\u5148\u679a\u4e3e$gcd$\uff0c\u518d\u679a\u4e3e\u53e6\u4e00\u4e2a\u56e0\u5b50\u5f97\u51fa$i=gcd*x$\uff0c\u548c\u4e0a\u9762\u65b9\u6cd5\u662f\u7b49\u6548\u7684\uff0c\u8c03\u548c\u7ea7\u6570$O(ln n)$\u603b\u590d\u6742\u5ea6$O(n ln n)$\n\n# $Code$\n\n```c++\nint n,prime[maxn],pcnt,is_not_prime[maxn];\nint phi[maxn];\nll ans;\nvoid Get_Phi(int x)\n{\n\tis_not_prime[1]=1;\n\tfor(re int i=2;i<=x;++i)\n\t{\n\t\tif(!is_not_prime[i]) prime[++pcnt]=i,phi[i]=i-1;\n\t\tfor(re int j=1;j<=pcnt;++j)\n\t\t{\n\t\t\tif(i*prime[j]>x) break;\n\t\t\tis_not_prime[i*prime[j]]=1;\n\t\t\tif(!(i%prime[j]))\n\t\t\t{\n\t\t\t\tphi[i*prime[j]]=phi[i]*prime[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse phi[i*prime[j]]=phi[i]*phi[prime[j]];\n\t\t}\n\t}\n}\nint vis[maxn];\nint main()\n{\n    n=read();\n    Get_Phi(n);\n    for(re int i=1;i<=n;++i)//\u679a\u4e3egcd\n\t\tfor(re int j=2;j*i<=n;++j)//\u679a\u4e3e\u6570\u5bf9\u4e2d\u8f83\u5927\u7684\u6570/gcd\u7684\u7ed3\u679c\uff0c\u4ece2\u679a\u4e3e\u662f\u4e3a\u4e86\u4e0d\u8003\u8651\u5bf9\u89d2\u7ebf \n\t\t{\n\t\t\tans+=(ll)phi[j]*i;\n\t\t}\n\tans*=2;//\u4e0a\u4e09\u89d2\u4e0b\u4e09\u89d2 \n\tans+=(ll)(1+n)*n/2;//\u7edf\u8ba1\u5bf9\u89d2\u7ebf \n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n\n\n\n\n\n\n\n\n\n",
        "postTime": 1573629605,
        "uid": 127018,
        "name": "ZORO",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "\u770b\u8fd9\u9898\u4e4b\u524d \u5148\u6765\u51e0\u9053\u7c7b\u4f3c\u7684\n\n# [GCD SUM](<https://www.luogu.org/problem/P2398>)\n\n\u9898\u610f\u7b80\u5355\u660e\u4e86 \u5341\u5206\u53cb\u5584\n\n\u5982\u679c\u7528\u6b27\u62c9\u51fd\u6570\u7684\u65b9\u6cd5\u505a\u53ef\u4ee5\u5f88\u8f7b\u677e\u7684\u8fc7\u6389 \n\n\u8be6\u60c5\u8bf7\u770b[\u4eea\u4ed7\u961f](<https://www.luogu.org/problem/P2158>)\n\n![img](https://cdn.luogu.com.cn/upload/pic/1149.png)\n\n```cpp\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\n#include<cstring>\n#include<iostream>\nusing namespace std;\nint p[1000000],phi[1000000],vis[1010101];\nlong long ans;\nint  main(){\n\t\n    int n;\n    scanf(\"%d\",&n);\n    if(n==1){\n    \tcout<<0;\n    \treturn 0;\n\t}\n    phi[1]=1;\n    for(int i=2;i<=n;i++)\n    {\n    \tif(!vis[i])\n    \tp[++p[0]]=i,phi[i]=i-1;\n    \tfor(int j=1;j<=p[0]&&i*p[j]<=n;j++)\n    \t{\n    \t\tvis[i*p[j]]=1;\n    \t\tif(i%p[j]==0)\n    \t\t{\n    \t\t\tphi[i*p[j]]=phi[i]*p[j];\n    \t\t\tbreak;\n\t\t\t}\n\t\t\telse phi[i*p[j]]=phi[i]*(p[j]-1);\n\t\t}\n\t\t//ans+=phi[i];\n\t}\n\tn--;\n    ans=0;\n    for(int i=1;i<=n;i++)\n    {\n    \tans+=phi[i];\n\t}\n    cout<<ans*2+1;\n    return 0;\n}\n```\n\n\u4ee3\u7801\u4f1a\u53ca\u5176\u5197\u957f\n\n\u4f46\u662f\u5982\u679c\u6362\u4e2a\u601d\u8def\n\n![img](D:\\OneDrive - langlangago\\Pictures\\2608.png)\n\n\u89c2\u5bdf\u8fd9\u5f20\u56fe\u7247 \u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u51e0\u4e2a\u6027\u8d28\n\n1.\u76f8\u540c\u70b9\u7684\u6807\u53f7\u7b49\u4e8e\u4ed6\u4eec\u7684GCD\n\n2.\u8bbe\u4e00\u4e2a\u70b9\u5750\u6807\u4e3ax,y  \u4ee5gcd(x,y)\u4e3agcd\u7684\u4e2a\u6570\u7b49\u4e8e$(n/x)*(m/x)$\n\n3.\u8003\u8651\u5bf9\u7b2c\u4e8c\u6b65\u4ece\u53f3\u4e0a\u5230\u5de6\u4e0b\u5bb9\u65a5 \n\n![](http://101.200.56.58/wp-content/uploads/2019/10/%E5%9B%BE%E7%89%87.png)\n\n\u8fd9\u6837 \u6211\u4eec\u53ea\u9700\u8981\u679a\u4e3egcd\u5373\u53ef\n\n# p2398\n\n```cpp\n#include<cstdio>\nint main()\n{\n\tlong long n,m,a[100000],ans=0;\n\tscanf(\"%lld\",&n);m=n;\n\tfor(int i=1;i<=n;i++) a[i]=(n/i)*(m/i);\n\tfor(int i=n;i>=1;i--) {\n\t\tfor(int j=2;j<=n/i;j++)\n\t\t\ta[i]-=a[j*i];ans+=(a[i]*i);\n\t}\tprintf(\"%lld\",ans);\n}\n```\n\n# p1447\n\n```cpp\n#include<cstdio>\nint main()\n{\n\tlong long n,m,a[100000],ans=0;\n\tscanf(\"%lld%lld\",&n,&m);\n\tfor(int i=1;i<=n;i++) a[i]=(n/i)*(m/i);\n\tfor(int i=n;i>=1;i--) {\n\t\tfor(int j=2;j<=n/i;j++)\n\t\t\ta[i]-=a[j*i];ans+=(a[i]*(i*2-1));\n\t}\tprintf(\"%lld\",ans);\n}\n```\n\n",
        "postTime": 1572357484,
        "uid": 58064,
        "name": "COUPDETAT",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "\u6211\u4eec\u77e5\u9053\uff1a\n$$\\sum_{d|n}\\varphi(d)=n$$\n\u6240\u4ee5\uff1a\n\n\u539f\u5f0f\n$$=\\sum_{i=1}^N\\sum_{j=1}^N\\sum_{d|gcd(i,j)}\\varphi(d)$$\n\u628a$d$\u63d0\u51fa\u6765\n$$=\\sum_{i=1}^{\\lfloor \\frac{N}{d} \\rfloor} \\sum_{j=1}^{\\lfloor \\frac{N}{d} \\rfloor} \\sum_{d=1}^N\\varphi(d)$$\n$$=\\sum_{d=1}^{N}\\varphi(d)\\lfloor \\frac{N}{d} \\rfloor\\lfloor \\frac{N}{d} \\rfloor$$\n\u4e8e\u662f\u7b5b $\\varphi$ \u7684\u524d\u7f00\u548c\uff0c\u518d\u6574\u9664\u5206\u5757\u5c31\u597d\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define R register int\nusing namespace std;\nnamespace Luitaryi {\nconst int N=100010;\nint n,p[N/2],cnt; ll ans;\nll phi[N]; bool v[N];\ninline void PRE() { v[1]=phi[1]=1;\n  for(R i=2;i<=n;++i) {\n    if(!v[i]) p[++cnt]=i,phi[i]=i-1;\n    for(R j=1;j<=cnt&&i*p[j]<=n;++j) { R tmp=i*p[j];\n      v[tmp]=true; if(i%p[j]==0) {\n        phi[tmp]=phi[i]*p[j]; break;\n      } phi[tmp]=phi[i]*(p[j]-1);\n    }\n  } for(R i=1;i<=n;++i) phi[i]+=phi[i-1];\n}\ninline void main() {\n  scanf(\"%d\",&n); PRE();\n  for(R l=1,r;l<=n;l=r+1) r=n/(n/l),ans+=(phi[r]-phi[l-1])*(n/l)*(n/l);\n  printf(\"%lld\\n\",ans);\n}\n} signed main() {Luitaryi::main(); return 0;}\n```\n",
        "postTime": 1567578665,
        "uid": 115086,
        "name": "Tari",
        "ccfLevel": 7,
        "title": "Jack's \u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "# \u9898\u76ee\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[\u70b9\u8fd9\u91cc](https://www.luogu.org/problem/P2398)\u770b\u9898\u76ee\u3002\n# \u5206\u6790\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u6bd4\u8f83\u7b80\u5355\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u6839\u636e\u9898\u610f\uff0c\u6211\u4eec\u8981\u6c42\u8fd9\u6837\u4e00\u4e2a\u4e1c\u897f\uff1a  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$\\displaystyle\\sum_{i=1}^n\\sum_{j=1}^n\\gcd(i,j)$  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u770b\u5230$\\gcd$\u4e4b\u7c7b\u7684\u4e1c\u897f\uff0c\u6211\u4eec\u5f88\u81ea\u7136\u5730\u60f3\u5230\u4e86\u679a\u4e3e\u5b83\uff0c\u5f0f\u5b50\u5c31\u53d8\u6210\u4e86\uff1a  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$\\displaystyle\\sum_{d=1}^nd\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}[\\gcd(i,j)=1]$  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u5176\u4e2d\u65b9\u62ec\u53f7\u8fd4\u56de\u547d\u9898\u4e3a\u771f\u4e3a$1$\uff0c\u5426\u5219\u4e3a$0$\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u4ee4$p=\\lfloor\\frac{n}{d}\\rfloor$,\u5219\u6709\uff1a  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$\\displaystyle\\sum_{d=1}^nd\\sum_{i=1}^p\\sum_{j=1}^p[\\gcd(i,j)=1]$     \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u8fd9\u4e2a\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u6c42\u533a\u95f4$[1,p]$\u4e2d\u7684\u4e92\u8d28\u6570\u5bf9\u6570\u7684\u95ee\u9898\uff0c\u53ef\u4ee5\u7528$\\phi$\u51fd\u6570\u89e3\u51b3\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$\\phi(n)$\u8868\u793a\u5c0f\u4e8e$n$\u4e14\u4e0e$n$\u4e92\u8d28\u7684\u6570\u7684\u4e2a\u6570\u3002\u5219$\\sum_{i=1}^p\\phi(i)$\u4e3a$[1,p]$\u4e2d\u6ee1\u8db3$j<i$\u7684\u4e92\u8d28\u6570\u5bf9$(i,j)$\u7684\u4e2a\u6570\uff0c\u518d\u4e58\u4ee5$2$\u5c31\u662f\u7b54\u6848\uff08\u53ef\u80fd\u9700\u8981\u7279\u5224$(1,1)$\u6f0f\u7b97\u6216\u8005\u7b97\u91cd\u7684\u60c5\u51b5\uff09\n# \u4ee3\u7801\n```cpp\n#include <cstdio>\n\ntypedef long long LL;\n\nconst int MAXN = 1e5 + 5;\n\ntemplate<typename _T>\nvoid read( _T &x )\n{\n\tx = 0;char s = getchar(); int f = 1;\n\twhile( s < '0' || '9' < s ){ f = 1; if( s == '-' ) f = -1; s = getchar(); }\n\twhile( '0' <= s && s <= '9' ){ x = ( x << 3 ) + ( x << 1 ) + s - '0', s = getchar(); }\n\tx *= f;\n}\n\ntemplate<typename _T>\nvoid write( _T x )\n{\n\tif( x < 0 ){ putchar( '-' ), x = -x; }\n\tif( 9 < x ){ write( x / 10 ); }\n\tputchar( x % 10 + '0' );\n}\n\nint prime[MAXN], pn;\nLL phi[MAXN], pp[MAXN];\nint N;\nbool isPrime[MAXN];\n\nvoid EulerSieve( const int siz )\n{\n\tisPrime[1] = true, phi[1] = 0;\n\tfor( int i = 2 ; i <= siz ; i ++ )\n\t{\n\t\tif( ! isPrime[i] ) prime[++pn] = i, phi[i] = i - 1;\n\t\tfor( int j = 1 ; j <= pn && 1ll * i * prime[j] <= siz ; j ++ )\n\t\t{\n\t\t\tisPrime[i * prime[j]] = true;\n\t\t\tif( ! ( i % prime[j] ) )\n\t\t\t{\n\t\t\t\tphi[i * prime[j]] = phi[i] * prime[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tphi[i * prime[j]] = phi[i] * ( prime[j] - 1 );\n\t\t}\n\t\tpp[i] = phi[i] + pp[i - 1];\n\t}\n}\n\nint main()\n{\n\tread( N );\n\tEulerSieve( N );\n\tLL res = 0;\n\tfor( int d = 1 ; d <= N ; d ++ )\n\t\tres += 1ll * d * ( 2ll * pp[N / d] + 1 );\n\twrite( res ), putchar( '\\n' );\n\treturn 0;\n}\n```",
        "postTime": 1566968435,
        "uid": 123809,
        "name": "crashed",
        "ccfLevel": 0,
        "title": "[P2398]GCD SUM"
    },
    {
        "content": "#### Solution\n![](https://cdn.luogu.com.cn/upload/pic/21263.png)\n\n\u8fd9\u4e2a\u505a\u6cd5\u662f\u6211\u7c7b\u6bd4[YY\u7684GCD](https://www.luogu.org/problemnew/show/P2257)\u5f97\u5230\u7684.\n\n\u7136\u540e\u8fd9\u4e2a$h(t)$\u53ef\u4ee5**\u7ebf\u6027\u7b5b**\u4e5f\u53ef\u4ee5\u76f4\u63a5**\u679a\u4e3e\u56e0\u5b50**.\n\n\u4e0d\u8fc7\u6211\u771f\u7684\u6ca1\u6709\u6ce8\u610f\u5230\u8fd9\u4e2a\u73a9\u610f\u5c31\u662f\u6b27\u62c9\u51fd\u6570.\n\n\u548c\u8fd9\u4e2a\u9898\u975e\u5e38\u7c7b\u4f3c\u7684\u4e00\u9053\u9898: [\u80fd\u91cf\u91c7\u96c6](https://www.luogu.org/problemnew/show/P1447).\n\n\u53d1\u73b0\u73b0\u5728\u7684\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u9898\u5f88\u591a\u90fd\u662f\u5957\u8def.\n\u4ec0\u4e48\u9664\u6cd5\u5206\u5757, \u6362\u5143(\u66f4\u6539\u679a\u4e3e\u987a\u5e8f)\u2026\u2026\n\n\n\u6ce8\u610f: \u6211\u4e00\u5f00\u59cb\u6c42$h(i)$\u662f\u679a\u4e3e$i$\u7684\u6bcf\u4e00\u4e2a\u56e0\u5b50, \u9519\u4e86.\n\u540e\u6765\u5229\u7528\u4e00\u4e2a\u6570\u53bb\u66f4\u65b0\u5b83\u7684\u500d\u6570, \u5bf9\u4e86.\n\n#### Code\n```c++\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#define N 100005\nusing namespace std;\n\ntypedef long long ll;\n\nint tot;\nint mu[N];\nint sum[N];\nbool mark[N];\nint prime[N];\nll number[N];\n\nvoid getmu(int n){\n    mu[1]=1;\n    for(int i=2;i<=n;i++){\n    \tif(!mark[i]){\n    \t\tprime[++tot]=i;\n    \t\tmu[i]=-1;\n    \t}\n        for(int j=1;prime[j]*i<=n;j++){\n            if(prime[j]*i>=n)break;\n            mark[prime[j]*i]=1;\n            if(i%prime[j]==0){\n    \t\t\tmu[prime[j]*i]=0;\n    \t\t\tbreak;\n    \t\t}\n            mu[prime[j]*i]=-mu[i];\n        }\n    }\n    for(int i=1;i<=n;++i)\n        for(int j=i;j<=n;j+=i)\n            number[j]+=i*mu[j/i];\n    // for(int i=1;i<=n;++i){\n    // \tfor(int d=2;d<=sqrt(i);++d)\n    // \t\tif(i%d==0)\n    // \t\t\tnumber[i]+=(ll)d*mu[i/d]+(ll)(i/d)*mu[d];\n        // if(number[i]>0)\n        // printf(\"%d %d\\n\",i,number[i]);\n    // }\n    for(int i=1;i<=n;++i)\n    sum[i]=sum[i-1]+number[i];\n}    \nll query(int n){\n    int last;\n    ll ans=0;\n    for(ll i=1;i<=n;i=last+1){\n        last=n/(n/i);\n        ans+=(n/i)*(n/i)*(sum[last]-sum[i-1]);\n    }\n    return ans;\n}\n\nint main(){\n    getmu(100000);\n    int n,T=1;\n    while(T--){\n        scanf(\"%d\",&n);\n        printf(\"%lld\\n\",query(n));\n    }\n    return 0;\n}\n```",
        "postTime": 1529221446,
        "uid": 39067,
        "name": "aiyougege",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "\u63d0\u4f9b\u53e6\u5916\u4e00\u79cdO(n)\u7684\u505a\u6cd5\uff0c\u5177\u4f53\u8bc1\u660e\u7565(bu)\u53bb(hui)\uff0c\u4ee5\u4e0b\u7b80\u5355\u63a8\u5f0f\u5b50\u3002\u5c1d\u8bd5\u7740\u7528LateX ,\u5e0c\u671b\u4e0d\u8981\u6709\u4ec0\u4e48\u8bef\u5dee\u2026\u2026\n\n\u7b2c\u4e00\u6b65\u8f6c\u5316\u548c\u4e0b\u9762On\u505a\u6cd5\u7684\u9898\u89e3\u76f8\u540c\n\n$\\sum_{i=1}^{n}\\sum_{j=1}^{n} gcd(i,j)$\n\n$=\\sum_{d=1}^{n}d\\sum_{i=1}^{n}\\sum_{j=1}^{n} [gcd(i,j) = d]$\n\n$=\\sum_{d=1}^{n}d\\sum_{i=1}^{n/d}\\sum_{j=1}^{n/d}[gcd(i,j) = 1]$\n\n\u5c06\u4e0a\u5f0f\u5173\u4e8ei,j\u7684\u6c42\u548c\u7b80\u5316:\n\n\u539f\u5f0f  $=\\sum_{d=1}^{n}d*(2*\\sum_{i=1}^{n/d}\\sum_{j=1}^{i}[gcd(i,j) = 1]-\\sum_{i=1}^{n/d}[gcd(i,i) = 1])$\n\n$=\\sum_{d=1}^{n}d*(2*\\sum_{i=1}^{n/d}\\sum_{j=1}^{i}[gcd(i,j) = 1]-1)$\n\n$=\\sum_{d=1}^{n}2*d*\\sum_{i=1}^{n/d}\u03c6(i) - d$\n\n\u5230\u8fd9\u91cc\u5f0f\u5b50\u5c31\u63a8\u5b8c\u4e86\uff0c\u5b9e\u9645\u5b9e\u73b0\u65f6\u6c42\u4e00\u4e0bphi\u51fd\u6570\u4ee5\u53ca\u524d\u7f00\u548c\u518d\u6c42\u89e3\uff0c\u8fc7\u7a0b\u90fd\u662f\u7ebf\u6027\u7684\u3002\n\ntip : phi\u51fd\u6570\u6c42\u524d\u7f00\u548c\u8bb0\u5f97\u5f00long long\uff0c\u4e0d\u7136\u6700\u540e\u4e00\u4e2a\u70b9\u4f1a\u70b8\u2026\u2026\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n\n\n```cpp\n#include <cstdio>\n#include <iostream>\nusing namespace std;\ntypedef long long ll;\nconst int mxn = 100007;\nint n,pri[mxn];\nbool not_pri[mxn];\nlong long ans,phi[mxn];\ninline void gt_phi()\n{\n    phi[1] = 1;\n    for(int i = 2;i <= n;i++)\n    {\n        if(!not_pri[i]) pri[++pri[0]] = i,phi[i] = i-1;\n        for(int j = 1;j <= pri[0]&&i*pri[j] <= n;j++)\n        {\n            not_pri[i*pri[j]] = 1;\n            if(i%pri[j] == 0) {phi[i*pri[j]] = phi[i]*pri[j];break;}\n            phi[i*pri[j]] = phi[i]*(pri[j]-1);\n        }\n    }\n}\nint main()\n{\n    scanf(\"%d\",&n);\n    gt_phi();\n    for(int i = 1;i <= n;i++) phi[i]+=phi[i-1];\n    for(int i = 1;i <= n;i++) ans += (ll)2*i*phi[n/i]-i;\n    cout<<ans;\n    return 0;\n}\n```",
        "postTime": 1509117863,
        "uid": 27165,
        "name": "Dijkspfa",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    },
    {
        "content": "\u6b64\u9898\u5229\u7528dp\u7684\u601d\u60f3\uff0c\u5206\u4e3a\u4e24\u4e2a\u6570\u7ec4\uff0c\u4ee3\u8868\u7684\u610f\u4e49\u5206\u522b\u662f\uff1a\n\n\u4e00\u3001gcd\u503c\u4e3ad\u7684\u6570\u5bf9\u4e2a\u6570\uff08\u6682\u8bbe\u4e3af\u6570\u7ec4\uff09\n\n\u4e8c\u3001gcd\u503c\u4e3ad\u7684\u500d\u6570\u7684\u6570\u5bf9\u4e2a\u6570\uff08\u6682\u8bbe\u4e3aa\u6570\u7ec4\uff09\n\n\u5176\u4e2d\u4e00\u53ef\u4ee5\u7528\u516c\u5f0f\u63a8\u5bfc\u51fa\u7b54\u6848\uff0c\u4e8c\u53ef\u4ee5\u7528\u6570\u5b66\u65b9\u6cd5\u63a8\u5f97\n\n\u7136\u540e\u5173\u4e8e\u4e00\u4e0e\u4e8c\u7684\u5173\u7cfb\uff0c\u53ef\u4ee5\u7528dp\u7684\u601d\u60f3\u63a8\u5bfc\u51fa\uff1a\n\nf[i]\uff1a=a[i]-f[i\\*2]-```-f[i\\*\uff08n div i\uff09]\uff1b\n\u56e0\u4e3aa[i]\u76f4\u63a5\u7531\u6731\u5b66\u516c\u5f0f\u63a8\u5f97\uff0c\u5e76\u4e14\u4e0d\u5f71\u54cd\u4e4b\u540e\u7684\u7ed3\u679c\uff0c\u6240\u4ee5\u5728\u7a0b\u5e8f\u91cc\u4e0d\u7528\u5f00\u6570\u7ec4\u4e86\nP.S.\u5173\u4e8e\u9519\u8bef30\u5206\u7684\u540c\u5b66\uff0c\u6ce8\u610f\u8f93\u5165\u7684n\u4e5f\u8981\u662fint64\uff01\uff01\uff01\n\u56e0\u4e3aa[i]\u7684\u6570\u5b66\u516c\u5f0f\u91cc\u6700\u574f\u60c5\u51b5\u662fn*n\u8981\u8d85longint\uff0c\u800c\u8ba1\u7b97\u673a\u8fd0\u884c\u7684\u65f6\u5019\u4e58\u6cd5\u662f\u628an\u503c\u7d2f\u52a0\u5230\u7b2c\u4e00\u4e2an\u53d8\u91cf\u91cc\u7136\u540e\u518d\u9644\u503c\u7ed9a[i]\n\n```delphi\n\n\n\n\n\n```cpp\n```\nvar i,j:longint;\n  f:array[1..100000]of int64;\n  n,z:int64;\nbegin\n  readln(z);n:=0;\n  for i:=z downto 1 do\n  begin\n    f[i]:=(z div i)*(z div i);\n    for j:=2 to z div i do\n      f[i]:=f[i]-f[j*i];\n    n:=n+f[i]*i;\n  end;\n  writeln(n);\nend.\nbzoj2005\u662f\u7c7b\u4f3c\u9898\uff08\u52a0\u5f3a\u7248\uff09\u4f46\u5982\u679c\u7406\u89e3\u8fd9\u4e2a\u60f3\u6cd5\u540e\u4e5f\u90fd\u53d8\u7b80\u5355\u4e86```cpp\n```",
        "postTime": 1440126272,
        "uid": 8060,
        "name": "a18071114",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2398 \u3010GCD SUM\u3011"
    }
]
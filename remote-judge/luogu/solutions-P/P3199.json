[
    {
        "content": "\u5bf9\u4e8e\u8fd9\u4e2a\u4e1c\u897f\uff0c\u6709\u4e00\u4e2a\u7ed3\u8bba\uff08Karp1977\u5e74\u7684\u8bba\u6587\uff09\uff1a\n\n\u6211\u4eec\u65b0\u5efa\u4e00\u4e2a\u8282\u70b9\uff0c\u4ece\u5b83\u5230\u6bcf\u4e2a\u70b9\u8fde\u4e00\u6761\u6743\u503c\u4efb\u610f\u7684\u8fb9\uff08\u6bd4\u5982\u90fd\u662f0\uff09\uff0c\u518d\u4ee4$F_j(i)$\u8868\u793a\u4ece\u65b0\u5efa\u7684\u70b9\u5230$i$\u70b9\u6070\u597d\u7ecf\u8fc7$j$\u6761\u8fb9\u7684\u6700\u77ed\u8def\uff0c\u90a3\u4e48\u6709\n\n$$ans=\\min_{1\\leq i\\leq n, F_{n+1}(i)\\neq\\infty}\\max_{j=1}^{n}\\left[\\frac{F_{n+1}(v)-F_k(v)}{n+1-k}\\right]$$\n\n\u5177\u4f53\u8bc1\u660e\u8bf7\u770b[\u6211\u7684\u535a\u5ba2](http://www.cnblogs.com/y-clever/p/7043553.html)\n\n\u867d\u7136\u4ee3\u7801\u4e0d\u662f\u8dd1\u7684\u6700\u5feb\u7684\u4f46\u662f\u7406\u8bba\u590d\u6742\u5ea6\u4f4e\uff08\u6ca1\u529e\u6cd5\uff0c\u6570\u636e\u4e0d\u5361SPFA\uff09\uff0c\u662f$O(nm)$\u7684\uff08\u800c\u4e14\u4ee3\u7801\u4e5f\u662f\u6700\u77ed\u7684\uff0c\u53ea\u67090.71KB\uff0c\u4e0d\u6bd4Dijkstra\u96be\u5199\uff09\n\n```cpp\n#include <algorithm>\n#include <cstdio>\nconst int N = 3050;\nconst int M = 10050;\nconst double INF = 1e12;\ndouble F[N][N], w[M];\nint u[M], v[M];\nint main() {\n  int n, m, i, j;\n  scanf(\"%d%d\", &n, &m);\n  for (i = 0; i < m; ++i)\n    scanf(\"%d%d%lf\", &u[i], &v[i], &w[i]);\n  for (i = 0; i <= n; ++i)\n    for (j = 1; j <= n; ++j)\n      F[i][j] = i ? INF : 0;\n  for (i = 0; i < n; ++i)\n    for (j = 0; j < m; ++j)\n      F[i + 1][v[j]] = std::min(F[i + 1][v[j]], F[i][u[j]] + w[j]);\n  double ans = 1e7, ans1;\n  for (i = 1; i <= n; ++i) if (F[n][i] < 1e11) {\n    ans1 = -INF;\n    for (j = 0; j < n; ++j)\n      ans1 = std::max(ans1, (F[n][i] - F[j][i]) / (n - j));\n    ans = std::min(ans, ans1);\n  }\n  printf(\"%.8lf\\n\", ans);\n  return 0;\n}\n\n```\n\u4e0b\u9762\u8fd8\u6709\u4e00\u4e2a\u7a7a\u95f4\u590d\u6742\u5ea6\u6781\u4f4e\uff0870MB->1.9MB\uff09\uff0c\u7a0d\u957f\u4e00\u70b9\uff080.71KB->0.98KB\uff09\uff0c\u7a0d\u6162\u4e00\u70b9\uff083936ms->4468ms\uff09\u7684\u5b9e\u73b0\uff0c\u7b97\u4e86\u4e24\u904d\uff0c\u6eda\u52a8\u6570\u7ec4\uff08\u5b9e\u9645\u4e0a\uff0c\u4e0a\u9762\u7684\u4ee3\u7801\u5728BZOJ\u4e0aMLE\uff0c\u56e0\u4e3aBZOJ\u8fd9\u9898\u7a7a\u95f464M\uff09\n\n```cpp\n#include <algorithm>\n#include <cstdio>\nconst int N = 3050;\nconst int M = 10050;\nconst double INF = 1e12;\ndouble _F[2][N], Fn[N], w[M], maxv[N];\nint u[M], v[M];\nint main() {\n  int n, m, i, j;\n  scanf(\"%d%d\", &n, &m);\n  for (i = 0; i < m; ++i)\n    scanf(\"%d%d%lf\", &u[i], &v[i], &w[i]);\n  double *F = _F[0], *G = _F[1];\n  for (i = 1; i <= n; ++i)\n    G[i] = 0;\n  for (i = 0; i < n; ++i, std::swap(F, G)) {\n    for (j = 1; j <= n; ++j) F[j] = INF;\n    for (j = 0; j < m; ++j)\n      F[v[j]] = std::min(F[v[j]], G[u[j]] + w[j]);\n  }\n  for (i = 1; i <= n; ++i) Fn[i] = G[i];\n  double ans = 1e7;\n  for (i = 1; i <= n; ++i)\n    maxv[i] = Fn[i] / n, G[i] = 0;\n  for (i = 0; i < n; ++i, std::swap(F, G)) {\n    for (j = 1; j <= n; ++j) F[j] = INF;\n    for (j = 0; j < m; ++j)\n      F[v[j]] = std::min(F[v[j]], G[u[j]] + w[j]);\n    for (j = 1; j <= n; ++j) maxv[j] = std::max(maxv[j], (Fn[j] - F[j]) / (n - i - 1));\n  }\n  for (i = 1; i <= n; ++i) if (Fn[i] < 1e11) ans = std::min(ans, maxv[i]);\n  printf(\"%.8lf\\n\", ans);\n  return 0;\n}\n```",
        "postTime": 1514019031,
        "uid": 7868,
        "name": "_rqy",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P3199 \u3010[HNOI2009]\u6700\u5c0f\u5708\u3011"
    },
    {
        "content": "\u9898\u76ee\u8bf4\u7684\u901a\u4fd7\u70b9\u5c31\u662f\uff0c\n\u5728\u56fe\u4e2d\u627e\u4e00\u4e2a\u73af\uff0c\u4f7f\u5f97\u73af\u4e0a\u8fb9\u6743\u4e4b\u548c\u9664\u4ee5\u8282\u70b9\u4e2a\u6570\u6700\u5c0f\uff0c\u6c42\u8fd9\u4e2a\u6700\u5c0f\u5e73\u5747\u503c\n\n\u4e5f\u7b97\u6bd4\u8f83\u88f8\u76840/1\u5206\u6570\u89c4\u5212\u4e86\uff0c\u548cPOJ - 3621 Sightseeing Cows\u6709\u70b9\u50cf\n\n\u4e3a\u65b9\u4fbf\u63cf\u8ff0\uff0c\u8bb0\u73af$S=(\\{v_i\\},\\{e_i\\})$\uff0c\n\u5176\u4e2d$\\{v_i\\}$\u4e3a\u73af\u4e0a\u7ed3\u70b9\u7684\u96c6\u5408\uff0c$\\{e_i\\}$\u4e3a\u73af\u4e0a\u7684\u8fb9\u7684\u96c6\u5408\n\u8bb0\u6bcf\u6761\u8fb9\u8fb9\u6743\u4e3a$a[e_i]$,\u6bcf\u4e2a\u8282\u70b9\u70b9\u6743$b[v_i]$\n\u5e76\u4ee4**\u6240\u6709\u70b9\u6743\u4e3a1**\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a0/1\u5206\u6570\u89c4\u5212\u6a21\u578b\n###[0/1\u5206\u6570\u89c4\u5212 \u8be6\u89e3](https://blog.csdn.net/niiick/article/details/80925267)\n\n\u4e8c\u5206\u4e00\u4e2amid\u7136\u540e\u5224\u5b9a\u56fe\u4e0a**\u662f\u5426\u5b58\u5728\u4e00\u4e2a\u73afS**\n\n\u4f7f\u5f97$\\frac{\\sum_{i=1}^ta[e_i]}{\\sum_{i=1}^tb[v_i]}<mid$\n\n\u5373\u8be5\u73af\u662f\u5426\u6ee1\u8db3$\\sum_{i=1}^t(a[e_i]-mid*b[v_i])<0$\n\n\u56e0\u4e3a$b[v_i]=1$,\u6240\u4ee5\u518d\u5316\u7b80\u5f97$\\sum_{i=1}^t(a[e_i]-mid)<0$\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u628a\u95ee\u9898\u8f6c\u5316\u6210\u4e86\u5224\u5b9a\u56fe\u4e2d**\u662f\u5426\u5b58\u5728\u8d1f\u73af**\n\n\u6211\u4eec\u628a\u6bcf\u6761\u8fb9\u5f97\u8fb9\u6743\u770b\u4f5c$a[e_i]-mid$\uff0c\n\u7136\u540e\u5728\u56fe\u4e0a\u5224\u8d1f\u73af\uff0c\u82e5\u6709\u8d1f\u73af\u5219$R=mid$\uff0c\u5426\u5219$L=mid$\uff0c\n\u76f4\u5230\u8fbe\u5230\u7cbe\u5ea6\u8981\u6c42\n***************\n\n```\n#include<iostream>\n#include<map>\n#include<algorithm>\n#include<queue>\n#include<cstring>\n#include<cstdio>\nusing namespace std;\ntypedef double dd;\n \nint read()\n{\n    int f=1,x=0;\n    char ss=getchar();\n    while(ss<'0'||ss>'9'){if(ss=='-')f=-1;ss=getchar();}\n    while(ss>='0'&&ss<='9'){x=x*10+ss-'0';ss=getchar();}\n    return f*x;\n}\n \nconst int maxn=3010;\nint n,m;\nint a[maxn];\nstruct node{int v,nxt; dd dis;}E[20010];\nint head[maxn],tot;\nint vis[maxn],judge;\ndd d[maxn]; \n \nvoid add(int u,int v,dd dis)\n{\n    E[++tot].nxt=head[u];\n    E[tot].v=v; E[tot].dis=dis;\n    head[u]=tot;\n}\n \nvoid check(int u,dd x)\n{\n    vis[u]=1;\n    for(int i=head[u];i;i=E[i].nxt)\n    {\n        int v=E[i].v; dd dis=E[i].dis;\n        if(d[v]>d[u]+dis-x)//\u8fb9\u6743a[e_i]-mid\n        {\n            if(vis[v]||judge){judge=1;break;}\n            d[v]=d[u]+dis-x;\n            check(v,x);\n        }\n    }\n    vis[u]=0;\n}\n \nint main()\n{\n    n=read();m=read();\n    for(int i=1;i<=m;++i)\n    {\n        int u=read(),v=read();\n        dd dis; scanf(\"%lf\",&dis);\n        add(u,v,dis);\n    }\n    dd L=-1e6,R=1e6,mid;\n    while(R-L>1e-10)\n    {\n        mid=(L+R)/2;\n        memset(d,0,sizeof(d)); judge=0;\n        memset(vis,0,sizeof(vis));\n        for(int i=1;i<=n;++i)\n        {\n            check(i,mid);\n            if(judge) break;\n        }\n        if(judge)R=mid;\n        else L=mid;\n    }\n    printf(\"%.8lf\",L);\n    return 0;\n}\n```",
        "postTime": 1530934892,
        "uid": 60885,
        "name": "niiick",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3199 \u3010[HNOI2009]\u6700\u5c0f\u5708\u3011"
    },
    {
        "content": "\u8d1f\u73af + \u5206\u6570\u89c4\u5212\u3002\u8fd9\u9053\u9898\u7684\u505a\u6cd5\u548c [`P3288 [SCOI2014]\u65b9\u4f2f\u4f2f\u8fd0\u6930\u5b50`](https://www.luogu.org/problemnew/show/P3199) \u6bd4\u8f83\u76f8\u4f3c\uff0c\u6240\u4ee5\u505a\u7740\u6bd4\u8f83\u5feb\u3002\u6211\u4eec\u4f9d\u7136\u8981\u6c42\u6700\u5c0f\u7684 $C=\\frac{\\sum_{i=1}^{k}a'[i]}{\\sum_{i=1}^{k}b'[i]}, b[i]=1$\uff0c\u4e5f\u5c31\u662f\u6700\u4f18\u6bd4\u7387\u73af\uff0c\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u5206\u6570\u89c4\u5212\u6a21\u578b\uff0c\u5316\u4e00\u4e0b\u53ef\u4ee5\u5f97\u5230 $\\sum_{i=1}^{k}a'[i]-C\\sum_{i=1}^{k}b'[i]=0$\uff0c\u56e0\u4e3a $b'[i]=1$\uff0c\u5f97\u5230 $\\sum_{i=1}^{k}a'[i]-C=0$\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u6240\u6709\u8fb9\u6743 $-C$\uff0c\u6700\u540e\u5224\u4e00\u4e0b\u662f\u5426\u6709\u8d1f\u73af\u5373\u53ef\u3002\n\n\u672c\u6587\u540c\u6b65\u53d1\u8868\u4e8e\u7b14\u8005\u7684\u535a\u5ba2\uff1a[\u9898\u89e3 P3199 [HNOI2009]\u6700\u5c0f\u5708](https://venusnero.github.io/2019/01/25/solution_p3199/)\n\n```cpp\n#include<bits/stdc++.h>\n#define MAXN 3005\n#define MAXM 10005\n#define eps 1e-12\nusing namespace std;\nint cnt,fst[MAXN],nxt[MAXM],to[MAXM];\nint n,m;\ndouble dis[MAXN],w[MAXM];\nbool vis[MAXN];\nvoid AddEdge(int u,int v,double c)\n{\n\tto[++cnt]=v;\n\tnxt[cnt]=fst[u];\n\tfst[u]=cnt;\n\tw[cnt]=c;\n}\nbool Spfa(int u,double mid)\n{\n\tvis[u]=1;\n\tfor(int i=fst[u];i;i=nxt[i])\n\t{\n\t\tint v=to[i];\n\t\tif(dis[v]>dis[u]+w[i]-mid)\n\t\t{\n\t\t\tdis[v]=dis[u]+w[i]-mid;\n\t\t\tif(vis[v] || Spfa(v,mid)) return 1;\n\t\t}\n\t}\n\tvis[u]=0;\n\treturn 0;\n}\nbool Check(double mid)\n{\n\tfor(int i=1;i<=n;i++) dis[i]=0;\n\tmemset(vis,0,sizeof(vis));\n\tfor(int i=1;i<=n;i++) if(Spfa(i,mid)) return 1;\n\treturn 0;\n}\nint main()\n{\n\tscanf(\"%d %d\",&n,&m);\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint x,y;\n\t\tdouble z;\n\t\tscanf(\"%d %d %lf\",&x,&y,&z);\n\t\tAddEdge(x,y,z);\n\t}\n\tdouble l=-1e7,r=1e7;\n\twhile(r-l>eps)\n\t{\n\t\tdouble mid=(l+r)/2.0;\n\t\tif(Check(mid)) r=mid;\n\t\telse l=mid;\n\t}\n\tprintf(\"%.8lf\\n\",r);\n\treturn 0;\n}\n```",
        "postTime": 1548417731,
        "uid": 23243,
        "name": "VenusM1nT",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3199 \u3010[HNOI2009]\u6700\u5c0f\u5708\u3011"
    },
    {
        "content": "Karp \u7b97\u6cd5\u3002  \n\u81f3\u4e8e\u56fe\u4e0d\u8054\u901a\u7684\u95ee\u9898\uff0c  \n\u53ef\u4ee5\u53c2\u7167[rqy\u795e\u7287\u7684blog](http://www.cnblogs.com/y-clever/p/7043553.html),   \n\u6dfb\u52a0\u4e00\u4e2a\u65b0\u70b9\u548cn\u6761\u8fb9\u518dDP\u3002  \nO(nm)\uff0c\u8981\u5361\u5361\u5e38\uff0c\u4e0d\u7136\u8fc7\u4e0d\u53bb\u3002\n\n\u4ee3\u7801\u5f88\u77ed\uff0c\u5f88\u597d\u5199\u3002\n```cpp\n#include <bits/stdc++.h>\n#define db double\nusing namespace std;\ninline int read(){\n    int x = 0,f = 1; char c = getchar();\n    while (c != EOF && !isdigit(c)) {if (c == '-') f = -1;c = getchar();}\n    while (c != EOF && isdigit(c)) {x = x * 10 + c - '0';c = getchar();}\n    return x * f;\n}\nconst int N = 3050,M = 10050 + N;\nconst db INF = 1e11;\nint n,m,u[M],v[M]; db w[M];\ndb F[N],G[N],Fn[N],Mx[N],ans;\nint main(){\n\tregister int i,j;\n\tn = read(),m = read();\n\tfor (i = 1; i <= m; ++i) scanf(\"%d%d%lf\",&u[i],&v[i],&w[i]);\n\t++n;\n\tfor (i = 1; i < n; ++i) ++m,u[m] = n,v[m] = i,w[m] = 0;\n\t\n\tfor (i = 1; i < n; ++i) F[i] = INF; F[n] = 0;\n\tfor (i = 1; i <= n; ++i){\n\t\tfor (j = 1; j <= n; ++j) G[j] = INF;\n\t\tfor (j = 1; j <= m; ++j) G[v[j]] = min(G[v[j]],F[u[j]] + w[j]);\n\t\tfor (j = 1; j <= n; ++j) F[j] = G[j];\n\t}\n\tfor (i = 1; i <= n; ++i) Fn[i] = F[i];\n\t\n\tfor (i = 1; i <= n; ++i) Mx[i] = -INF;\n\tfor (i = 1; i < n; ++i) F[i] = INF; F[n] = 0;\n\tfor (i = 1; i < n; ++i){\n\t\tfor (j = 1; j <= n; ++j) G[j] = INF;\n\t\tfor (j = 1; j <= m; ++j) G[v[j]] = min(G[v[j]],F[u[j]] + w[j]);\n\t\tfor (j = 1; j <= n; ++j) F[j] = G[j],Mx[j] = max(Mx[j],(Fn[j] - F[j]) / (n - i));\n\t}\n\tans = INF;\n\tfor (i = 1; i <= n; ++i) if (Fn[i] < 1e10) ans = min(ans,Mx[i]);\n\tprintf(\"%.8lf\\n\",ans); \n    return 0;\n}\n```",
        "postTime": 1551617520,
        "uid": 52518,
        "name": "s_r_f",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P3199 \u3010[HNOI2009]\u6700\u5c0f\u5708\u3011"
    },
    {
        "content": "\u677f\u5b50\u9898\uff0c\u6700\u5c0f\u5747\u503c\u73af\uff0c\u975e\u5e38 $\\text{Naive}$ \u7684 $0/1$ \u5206\u6570\u89c4\u5212\u9898\u3002\n\n\u6839\u636e $0/1$ \u5206\u6570\u89c4\u5212\u7684\u5957\u8def\uff0c\u672c\u9898\u4ee4 $\\frac{\\sum a_i\\times w_i}{\\sum b_i\\times w_i}$ \u6700\u5c0f\uff0c\u5e76\u4e8c\u5206\u6c42\u89e3\uff0c\u5224\u5b9a\u662f\u5426\u5b58\u5728\u4e00\u7ec4 $w_i\\in\\{0,1\\}$ \u6ee1\u8db3 $\\sum a_iw_i-mid\\times \\sum w_i<0$ \u5373\u53ef\u3002\u5728\u672c\u9898\u7684\u5224\u5b9a\u4e2d\uff0c\u5c06\u6bcf\u6761\u8fb9\u7684\u8fb9\u6743\u53d8\u4e3a $a_i-mid$ \u540e\u6211\u4eec\u76f4\u63a5\u6c42\u8d1f\u73af\u5373\u53ef\u3002\n\n\u6c42\u8d1f\u73af\u4f7f\u7528\u6700\u7b80\u5355\u7684 $\\text{dfs-SPFA}$\uff0c\u975e\u5e38\u597d\u5199\u3002\n\n\u5f53\u7136\u4e5f\u6709\u975e\u5e38\u4f18\u79c0\u7684 $O(nm)$ \u505a\u6cd5\uff0c\u8fd9\u91cc\u5c31\u4e0d\u4ecb\u7ecd\u4e86\uff08\n\n**Show the Code**\n\n```cpp\n#include<cstdio>\n#include<queue>\nconst double inf=1e18;\nint cnt=0;\nint vis[3005],f[3005];\ndouble dis[3005],w[20005];\nint h[3005],to[20005],ver[20005];\ninline void add(int x,int y,double z) {\n\tto[++cnt]=y;\n\tver[cnt]=h[x];\n\tw[cnt]=z;\n\th[x]=cnt;\n}\ninline bool spfa(int x,double val) {\n\tvis[x]=1;\n\tfor(register int i=h[x];i;i=ver[i]) {\n\t\tint y=to[i];\n\t\tif(dis[y]>dis[x]+w[i]-val) {\n\t\t\tdis[y]=dis[x]+w[i]-val;\n\t\t\tif(vis[y]||spfa(y,val)) return 1;\n\t\t}\n\t}\n\tvis[x]=0;\n\treturn 0;\n}\ninline bool check(int n,double val) {\n\tfor(register int i=1;i<=n;++i) vis[i]=dis[i]=0;\n\tfor(register int i=1;i<=n;++i) if(spfa(i,val)) return 1;\n\treturn 0;\n}\nint main() {\n\tint n,m; scanf(\"%d%d\",&n,&m);\n\tfor(register int i=1;i<=m;++i) {int x,y; double z; scanf(\"%d%d%lf\",&x,&y,&z); add(x,y,z);}\n\tdouble L=-1e7+5,R=1e7+5;\n\twhile(R-L>=1e-9) {\n\t\tdouble mid=(L+R)/2.00;\n\t\tif(check(n,mid)) R=mid;\n\t\telse L=mid;\n\t}\n\tprintf(\"%.8lf\",L);\n\treturn 0;\n}\n```\n",
        "postTime": 1602042410,
        "uid": 95244,
        "name": "tommymio",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3199 \u3010[HNOI2009]\u6700\u5c0f\u5708\u3011"
    },
    {
        "content": "&emsp;&emsp;\u611f\u8c22 18Michael \u7684\u6307\u6b63\uff0c\u4e8c\u5206\u7684\u7cbe\u5ea6\u8fb9\u754c\u6709\u70b9\u95ee\u9898\uff0c\u5df2\u66f4\u6b63\u3002\n# \u9898\u76ee\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[\u70b9\u8fd9\u91cc](https://www.luogu.com.cn/problem/P3199)\u770b\u9898\u76ee\u3002  \n# \u5206\u6790\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u7ecf\u5178\u7684\u6700\u5c0f\u5e73\u5747\u503c\u95ee\u9898\uff0c\u4e0d\u96be\u60f3\u5230\u4e8c\u5206\u7b54\u6848\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u4e8c\u5206\u51fa\u6765\u7b54\u6848$v$\u4e4b\u540e\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u6761\u8fb9$(u,v)$\uff0c\u5b83\u7684\u65b0\u8fb9\u6743\u5c31\u662f$w_{u,v}-v$\u3002\u4e00\u4e2a\u73af\u7684$\\mu$\u5c31\u662f$\\frac {\\sum_{i=1}^k (w_{c_i,c_{i+1}}-v)} k=\\frac{\\sum_{i=1}^k (w_{c_i,c_{i+1}})} k -v$\u3002\u8003\u8651\u539f\u56fe\u4e2d\u5982\u679c\u73b0\u5728\u8fd8\u5b58\u5728\u4e00\u4e2a\u8d1f\u73af\uff0c\u5c31\u8bf4\u660e\u8fd9\u4e2a\u56fe\u4e2d\u5b58\u5728\u4e00\u4e2a$\\mu<0$\u7684\u73af\u3002\u6211\u4eec\u5c31\u77e5\u9053\u4e86\u4e0b\u4e00\u6b65\u4e8c\u5206\u7684\u8303\u56f4\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u5982\u4f55\u5224\u8d1f\u73af\uff1f\u4f60\u5f53\u7136\u53ef\u4ee5\u7528$SPFA$\u3002\u8fd9\u91cc\u5efa\u8bae\u4f7f\u7528$DFS$\u7248\u672c\u800c\u4e0d\u662f$BFS$\u7248\u672c\u3002\u7406\u8bba\u65f6\u95f4\u662f$O(nm\\log_{2}V)$\uff08$V$\u662f\u503c\u57df\uff09\uff0c\u4f46\u662f\u7531\u4e8e$DFS+SPFA$\u7684\u9ad8\u6548\uff0c\u5b9e\u9645\u8fd0\u884c\u5b8c\u5168\u4e0d\u4f1a\u8d85\u65f6\u3002  \n# \u4ee3\u7801\n```cpp\n#include <queue>\n#include <cstdio>\nusing namespace std;\n\ntypedef long long LL;\n\nconst double INF = 1e7, eps = 1e-10;\nconst double inf = 0x3f3f3f3f3f3f3f3f;\nconst int MAXN = 3005, MAXM = 10005;\n\ntemplate<typename _T>\nvoid read( _T &x )\n{\n    x = 0;char s = getchar();int f = 1;\n    while( s > '9' || s < '0' ){if( s == '-' ) f = -1; s = getchar();}\n    while( s >= '0' && s <= '9' ){x = ( x << 3 ) + ( x << 1 ) + ( s - '0' ), s = getchar();}\n    x *= f;\n}\n\ntemplate<typename _T>\nvoid write( _T x )\n{\n    if( x < 0 ){ putchar( '-' ); x = ( ~ x ) + 1; }\n    if( 9 < x ){ write( x / 10 ); }\n    putchar( x % 10 + '0' );\n}\n\ntemplate<typename _T>\n_T MIN( const _T a, const _T b )\n{\n    return a < b ? a : b;\n}\n\ntemplate<typename _T>\n_T MAX( const _T a, const _T b )\n{\n    return a > b ? a : b;\n}\n\nstruct edge\n{\n    int to, nxt; double w;\n}Graph[MAXM];\n\nqueue<int> q;\n\ndouble dist[MAXN];\nint head[MAXN];\nint N, M, cnt, S;\nbool inSta[MAXN];\n\nvoid addEdge( const int from, const int to, const double w = 0 )\n{\n    cnt ++;\n    Graph[cnt].w = w, Graph[cnt].to = to, Graph[cnt].nxt = head[from];\n    head[from] = cnt;\n}\n\nbool SPFA( const int u, const double negt )\n{\n    double w;\n    inSta[u] = true;\n    for( int i = head[u], v ; i ; i = Graph[i].nxt )\n    {\n        v = Graph[i].to, w = Graph[i].w;\n        if( dist[v] > dist[u] + w - negt )\n        {\n            dist[v] = dist[u] + w - negt;\n            if( inSta[v] || SPFA( v, negt ) ) return true;\n        }\n    }\n    inSta[u] = false;\n    return false;\n}\n\nbool chk( const double val )\n{\n    for( int i = 1 ; i <= N ; i ++ ) dist[i] = 0, inSta[i] = 0;\n    for( int i = 1 ; i <= N ; i ++ )\n        if( SPFA( i, val ) ) return true;\n    return false;\n}\n\nint main()\n{\n    double l = 0, r = 0, mid, w;\n    read( N ), read( M );\n    for( int i = 1, u, v ; i <= M ; i ++ ) \n        scanf( \"%d %d %lf\", &u, &v, &w ), \n        l = MIN( l, l + w ), r = MAX( r, r + w ), addEdge( v, u, w );\n    while( r - l > eps )\n    {\n        mid = ( l + r ) / 2;\n        if( chk( mid ) ) r = mid;\n        else l = mid;\n    }\n    printf( \"%.8f\\n\", l );\n    return 0;\n}\n```",
        "postTime": 1576203402,
        "uid": 123809,
        "name": "crashed",
        "ccfLevel": 0,
        "title": "[HNOI2009]\u6700\u5c0f\u5708"
    },
    {
        "content": "~~\u7591\u4f3c\u4e09\u500d\u7ecf\u9a8c~~\n\n\u56e0\u4e3a\u548c\u673a\u623f\u4e00\u4e9b\u5927\u4f6c\u4e00\u8d77\u505a\u7684\u8fd9\u9053\u9898\uff0c\u6240\u4ee5emmm\u4ed6\u4eec\u8c8c\u4f3c\u4e5f\u5199\u4e86\u9898\u89e3\uff0c\u5728\u505a\u8fd9\u9053\u9898\u7684\u65f6\u5019\u4e5f\u53c2\u7167\u4e86\u5176\u4ed6\u5927\u4f6c\u5199\u7684\u4e00\u4e9b\u9898\u89e3\uff0c\u6240\u4ee5\u5982\u679c\u7a0b\u5e8f\u6709\u96f7\u540c\u8bf7\u89c1\u8c05\uff08\u624b\u52a8\u97a0\u8eac\uff09\n\n\n\n------------\n\n\u9898\u76ee\u4e5f\u662f\u83ab\u540d\u5176\u5999\u5730\u7ed9\u4e86\u4e00\u5927\u4e32\u6570\u5b66\u5f0f\uff0c\u7b80\u6d01\u5730\u91cd\u65b0\u8bf4\u4e00\u4e0b\u9898\u76ee\n\n\u7ed9\u4f60\u4e00\u5f20\u56fe\uff0c\u56fe\u4e2d\u6709\u73af\uff0c\u5b9a\u4e49**\u4e00\u4e2a\u73af\u7684\u5e73\u5747\u503c\u4e3a\u73af\u7684\u8fb9\u6743\u548c\u00f7\u73af\u4e2d\u70b9\u7684\u4e2a\u6570**\uff0c\u90a3\u4e48\u5c31\u5e94\u8be5\u6709\u4e86\u4e00\u4e2d\u975e\u5e38\u66b4\u529b\u7684\u601d\u8def\n\n- \u60f3\u529e\u6cd5\u627e\u51fa\u6765\u56fe\u4e2d\u6240\u6709\u7684\u73af\u5e76\u6c42\u51fa\u5176\u5e73\u5747\u503c\uff0c\u518d\u6bd4\u8f83\u51fa\u6700\u5c0f\u503c\n\n\u8fd9\u4e2a\u65b9\u6cd5\u786e\u5b9e\u600e\u4e48\u60f3\u90fd\u5f88\u66b4\u529b\uff0c\u4f46\u662f\u4e00\u70b9\u4e5f\u4e0d\u597d\u5b9e\u73b0\uff0c\u53ef\u80fd\u662f\u6211\u592a\u5f31\uff0c\u6211\u5b9e\u5728\u60f3\u4e0d\u592a\u51fa\u6765\u6709\u4ec0\u4e48\u7b97\u6cd5\u53ef\u4ee5\u627e\u51fa\u6765\u6240\u6709\u7684\u73af\uff0c\u6240\u4ee5\u8fd9\u79cd\u601d\u8def\u5148\u7ed9\u6211PASS\u6389\n\n\u800c\u6b63\u89e3\u5462\uff1f\u5e94\u8be5\u662f\u4e8c\u5206\u7b54\u6848\u3002\u4e3a\u4ec0\u4e48\uff1f\n\n- \u65e2\u7136\u6211\u4eec\u627e\u4e0d\u51fa\u6765\u73af\uff0c\u6211\u4eec\u9006\u5411\u601d\u7ef4\uff0c\u76f4\u63a5\u679a\u4e3e\u5e73\u5747\u503c\uff0c\u770b\u662f\u5426\u4f1a\u6709\u4e00\u4e2a\u73af\u7b26\u5408\u6761\u4ef6\uff0c\u90a3\u4e48\u8fd9\u9053\u9898\u5c31\u53d8\u6210\u4e86\uff1a**\u4e8c\u5206\u679a\u4e3e\u5e73\u5747\u503c\uff0c\u627e\u5230\u662f\u5426\u6709\u73af\u7b26\u5408\u6761\u4ef6**\n\n\u82e5\u6211\u4eec\u6b64\u65f6\u679a\u4e3e\u7684\u5e73\u5747\u503c\u4e3a$ans$\uff0c\u6709$k$\u4e2a\u5b57\u7b26\u4e32\uff0c\u90a3\u4e48\u5c31\u6709\n\n$ans * k = len1 + len2 + len3  + ... + lenk$\n\n\u90a3\u9053\u8fd9\u4e2a\u5f0f\u5b50\u4e4b\u540e\uff0c\u6211\u4eec\u5bf9\u5b83\u8fdb\u884c\u79fb\u9879\n\n$0=len1-ans+len2-ans+len3-ans+...+lenk-ans$\n\n\u90a3\u4e48\u5bf9\u4e8e\u6ee1\u8db3\u4ee5\u4e0b\u5f0f\u5b50\uff0c\u5c31\u53ef\u4ee5\u5224\u65ad\u662f\u73af\u4e86\uff0c\u6240\u4ee5\u5728\u8dd1$SPFA$\u66f4\u65b0\u8ddd\u79bb\u7684\u65f6\u5019\uff0c\u5c31\u5e94\u8be5\u50cf\u4e0b\u9762\u8fd9\u6837\n\n$0 \\leq len1-ans+len2-ans+len3-ans+...+lenk-ans$\n\n\u6240\u4ee5\u8fd9\u91cc\u5c31\u76f4\u63a5\u7ed9\u7a0b\u5e8f\u4e86\uff08\u4e09\u9053\u9898\u7684\uff09\n\n[SP2885 WORDRING - Word Rings](https://www.cnblogs.com/Poetic-Rain/p/13368559.html)\n\nP3199 [HNOI2009]\u6700\u5c0f\u5708\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int MAXN=30000000+51;\nconst double INF=(1e5)*1.0;\nconst double eqs=1e-9;\nint n,m;\nstruct node {\n\tint net,to;\n\tdouble z;\n} e[MAXN];\nint head[MAXN],tot;\nvoid add(int x,int y,double z) {\n\te[++tot].net=head[x];\n\te[tot].to=y;\n\te[tot].z=z;\n\thead[x]=tot;\n}\n\ndouble d[MAXN];\nbool v[MAXN],flag;\nbool spfa(int x,double k) {\n\tv[x]=true;\n\tfor(register int i=head[x]; i; i=e[i].net) {\n\t\tint y=e[i].to;\n\t\tdouble z=e[i].z;\n\t\tif(d[y]>d[x]+z-k) {\n\t\t\td[y]=d[x]+z-k;\n\t\t\tif(v[y]==true||spfa(y,k)==true) return true;\n\t\t}\n\t}\n\tv[x]=false;\n\treturn false;\n}\nbool check(double x) {\n\tfor(register int i=1; i<=n; i++) {\n\t\td[i]=20040915;\n\t\tv[i]=false;\n\t}\n\tfor(register int i=1; i<=n; i++) {\n\t\tif(spfa(i,x)==true) return true;\n\t}\n\treturn false;\n}\nint main() {\n\tscanf(\"%d%d\",&n,&m);\n\tfor(register int i=1; i<=m; i++) {\n\t\tint x,y;\n\t\tdouble z;\n\t\tscanf(\"%d%d%lf\",&x,&y,&z);\n\t\tadd(x,y,z);\n\t}\n\tdouble l=-INF,r=INF;\n\twhile(r-l>eqs) {\n\t\tdouble mid=(l+r)/2;\n\t\tif(check(mid)==true) r=mid;\n\t\telse l=mid;\n\t}\n\tprintf(\"%.8lf\",l);\n\treturn 0;\n}\n```\n\n[UVA11090 Going in Cycle!!](https://www.luogu.com.cn/problem/UVA11090)\n\n\n```\n#include <bits/stdc++.h>\nusing namespace std;\nint T,n,m,u,v,w,tot;\ndouble dis[520010];\nint vis[520010],head[520010];\n\nstruct node {\n\tint to,net;\n\tdouble val;\n} e[520010];\n\ninline void add(int u,int v,double w) {\n\te[++tot].to=v;\n\te[tot].val=w;\n\te[tot].net=head[u];\n\thead[u]=tot;\n}\n\ninline bool dfs(int now,double x) {\n\tvis[now]=1;\n\tfor(register int i=head[now];i;i=e[i].net) {\n\t\tint v=e[i].to;\n\t\tif(dis[v]>dis[now]+e[i].val-x) {\n\t\t\tdis[v]=dis[now]+e[i].val-x;\n\t\t\tif(vis[v]==1||dfs(v,x)==true) return true;\n\t\t}\n\t}\n\tvis[now]=0;\n\treturn false;\n}\n\ninline bool check(double x) {\n\tfor(register int i=1;i<=n;i++) {\n\t\tvis[i]=0;\n\t\tdis[i]=20050206;\n\t}\n\tfor(register int i=1;i<=n;i++) {\n\t\tif(dfs(i,x)==true) return true;\n\t}\n\treturn false;\n}\n\nint main() {\n\tscanf(\"%d\",&T);\n\tfor(register int k=1;k<=T;k++) {\n\t\ttot=0;\n\t\tfor(register int i=1;i<=n;i++) head[i]=0;\n\t\tscanf(\"%d%d\",&n,&m);\n\t\tfor(register int i=1;i<=m;i++) {\n\t\t\tscanf(\"%d%d%d\",&u,&v,&w);\n\t\t\tadd(u,v,w);\n\t\t}\n\t\tdouble l=-10000000,r=10000000;\n\t\twhile(r-l>1e-10) {\n\t\t\tdouble mid=(l+r)/2;\n\t\t\tif(check(mid)==true) r=mid;\n\t\t\telse l=mid;\n\t\t}\n\t\tprintf(\"Case #%d: \",k);\n\t\tif(l==10000000) puts(\"No cycle found.\");\n\t\telse printf(\"%.2lf\\n\",l);\n\t}\n\treturn 0;\n}\n\n```\n",
        "postTime": 1595768390,
        "uid": 113537,
        "name": "Poetic_Rain",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3199 \u3010[HNOI2009]\u6700\u5c0f\u5708\u3011"
    },
    {
        "content": "## \u4e00\u9053\u5751\u5566\u6211\u5f88\u4e45\u5f88\u4e45\u7684\u597d\u9898\uff01\n### \u4e3b\u8981\u7528\u5230\u7684\u7b97\u6cd5\u4e0e\u601d\u60f3\uff1a$01$\u5206\u6570\u89c4\u5212$+spfa$\u5224\u73af$+$\u7384\u5b66\u51cf\u679d\n### \u5bf9\u4e8e$01$\u5206\u6570\u89c4\u5212\u4e0d\u6e05\u695a\u7684\u53f3\u62d0\u5148\u53bb\u5b66\u4e60\u4e00\u4e0b\uff1a[P1570 KC\u559d\u5496\u5561](https://www.luogu.org/problemnew/show/P1570)\n### \u61c2\u5f97\u5566\u4ec0\u4e48\u662f\u5206\u6570\u89c4\u5212\u540e\u8fd9\u9053\u9898\u76ee\u5c31\u53d8\u5f97\u5f88\u7b80\u5355\u5566\uff0c\u4f60\u4f1a\u5224\u8d1f\u73af\u5417\uff1f\u4ec0\u4e48\u65b9\u6cd5\u90fd\u53ef\u4ee5\u7684\uff0c\u5982\u679c\u4f60\u771f\u7684\u4e0d\u4f1a\u5224\u8d1f\u73af\u53f3\u62d0[P3385 \u3010\u6a21\u677f\u3011\u8d1f\u73af](https://www.luogu.org/problemnew/show/P3385)\n### \u5f53\u4f60\u638c\u63e1\u5566\u4ee5\u4e0a\u4e24\u79cd\u524d\u7f6e\u77e5\u8bc6\u540e\u8fd9\u9053\u9898\u76ee\u5c31\u662f\u4e00\u9898\u88f8\u5954\u5728\u5206\u949f\u7684\u7701\u9009\u9898\u5566\n### \u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0b\u5224\u8d1f\u73af\u7684\u4ee3\u7801\uff08\u5728\u5224\u65ad\u8d1f\u73af\u7684\u8fc7\u7a0b\u4e2d\u4e00\u4e2a\u7384\u5b66\u7684\u526a\u6761\uff0c\u5c31\u662f\u5f53\u4f60\u505a\u5230\u4e86\u4e00\u5b9a\u7684\u6b21\u6570\u540e\u53ef\u4ee5$return$\u4e86\uff0c\u6211\u662f\u5f53$(num[u]>25$ \u6216\u8005 $num[v]>25)$\u65f6\u7ed3\u675f$spfa$\n```cpp\ninline bool spfa(double x)\n{\n\tqueue<int>q;\n\tfor ( register int i=1;i<=n;i++ ) dis[i]=123456789;\n\tmemset(vis,0,sizeof(vis));\n\tmemset(num,0,sizeof(num));\n\tq.push(1);\n\tvis[1]=1;\n\tdis[1]=0;//\u521d\u59cb\u5316\n\twhile(!q.empty())\n\t{\n\t\tint u=q.front();\n\t\tq.pop();\n\t\tvis[u]=0;\n\t\tif(num[u]>25) return true;//\u505a\u5230\u4e00\u5b9a\u7684\u6b21\u6570\u7ed3\u675f\u5faa\u73af\n\t\tfor ( register int i=head[u];i;i=e[i].nex )\n\t\t{\n\t\t\tint v=e[i].to;\n\t\t\tif(dis[v]>dis[u]+e[i].w-x)\n\t\t\t{\n\t\t\t\tdis[v]=dis[u]+e[i].w-x;//01\u5206\u6570\u89c4\u5212+spfa\n\t\t\t\tif(!vis[v])\n\t\t\t\t{\n\t\t\t\t    q.push(v);\n\t\t\t\t\tvis[v]=1;\n\t\t\t\t\tnum[v]++;\n\t\t\t\t\tif(num[v]>=25) return true;//\u505a\u5230\u4e00\u5b9a\u7684\u6b21\u6570\u7ed3\u675f\u5faa\u73af\uff08\u5224\u73af\uff09\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n```\n### \u5b8c\u6574\u7684\u4ee3\u7801\u5c31\u4e0d\u653e\u5566\uff0c\u53ea\u8981\u52a0\u4e2a\u4e8c\u5206\u5c31\u6492\u82b1\u5566\uff01\u4e8c\u5206\u65f6\u53ea\u6709\u5f53$r-l<=eps(1e-8)$\u65f6$break$\u6389\uff08\u603b\u4e4b\u5c31\u662f\u8981\u6ce8\u610f\u7cbe\u5ea6\u95ee\u9898\uff09\uff01\uff01\u3001\n\n### \u603b\u7ed3\uff1a\u5176\u5b9e\u8fd9\u9053\u9898\u76ee\u53ea\u8981\u638c\u63e1$01$\u5206\u6570\u89c4\u5212$+spfa$\u5224\u73af\u5c31\u53ef\u4ee5\u6c34\u8fc7\u8fd9\u9053\u9898\u76ee\uff0c\u4e0e\u8fd9\u9053\u9898\u76ee\u76f8\u7c7b\u4f3c\u7684\u8fd8\u6709\u4e0d\u5c11\uff0c\u90fd\u662f\u8fd0\u7528\u8fd9\u79cd\u601d\u60f3\uff0c\u6bd4\u5982\uff1a\n#### [P1768 \u5929\u8def](https://www.luogu.org/problemnew/show/P1768)\n#### [P2868 \u89c2\u5149\u5976\u725bSightseeing Cows](https://www.luogu.org/recordnew/show/19467871)\n### \u6700\u540e[\u6233\u8fd9\u91cc](https://www.luogu.org/team/show?teamid=15177)\u5230\u6b64\u4e00\u6e38\n",
        "postTime": 1559137998,
        "uid": 172612,
        "name": "\u7c73\u5947\u5947\u7c73",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3199 \u3010[HNOI2009]\u6700\u5c0f\u5708\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u9898\u76ee\u5f88\u590d\u6742\uff0c\u5176\u5b9e\u4e00\u53e5\u8bdd\u9898\u610f\uff1a\u6c42\u8be5\u56fe\u7684\u6700\u5c0f\u7684\u73af\u7684\u8fb9\u6743\u5e73\u5747\u503c\uff08\u4e0d\u5305\u62ec\u81ea\u73af\uff09\n\n\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5b83\u7684\u89e3\u5177\u6709\u5355\u8c03\u6027\uff0c\u5373\n\n$aver_i>ans$\u4e14$aver_j>aver_i$\u5219$aver_j>ans$\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528\u4e8c\u5206\u7b54\u6848$aver_i$\uff0c\u56e0\u4e3a\u6709\u8d1f\u73af\u6240\u4ee5\u8fb9\u754c\u662f\u6b63\u8d1f\u65e0\u7a77\u5927\n\n\u5219\u5bf9\u4e8e\u4e00\u4e2a\u53ef\u4ee5\u7684\u73af\u4e00\u5b9a\u6ee1\u8db3$(w_i-aver)+...+(w_j-aver)\\ge0$\n\n\u5224\u5b9a\u73af\u7528spfa\u5373\u53ef\uff0c\u53e6\u5916dfs\u7684spfa\u4f1a\u6bd4bfs\u66f4\u4f18\n\n```cpp\n// luogu-judger-enable-o2\n/***************************************************************\n    File name: C.cpp\n    Author: ljfcnyali\n    Create time: 2019\u5e7405\u670817\u65e5 \u661f\u671f\u4e94 09\u65f638\u520608\u79d2\n***************************************************************/\n#include<bits/stdc++.h>\n\nusing namespace std;\n\n#define REP(i, a, b) for ( int i = (a), _end_ = (b); i <= _end_; ++ i ) \n#define mem(a) memset ( (a), 0, sizeof ( a ) ) \n#define str(a) strlen ( a ) \n\nconst int maxm = 2000010;\nconst int maxn = 10010;\nconst double eps = 0.000000001;\n\nint Begin[maxm], Next[maxm], To[maxm], e;\nint n, m, vis[maxn];\ndouble aver, ans = 0x3f3f3f3f3f3f, dis[maxn], W[maxn], Max = -0x3f3f3f3f3f3f, Min = 0x3f3f3f3f3f3f;\nbool flag;\n\ninline void add(int u, int v, double w)\n{\n    To[++ e] = v;\n    Next[e] = Begin[u];\n    Begin[u] = e;\n    W[e] = w;\n}\n\ninline void spfa(int u, int x)\n{\n    if ( flag == true ) return ;\n    vis[u] = x;\n    for ( int i = Begin[u]; i; i = Next[i] ) \n    {\n        int v = To[i];\n        if ( (double) dis[v] > (double) dis[u] + W[i] - aver ) \n        {\n            dis[v] = (double) dis[u] + W[i] - aver;\n            if ( !vis[v] ) spfa(v, x);\n//\t\t\tif ( dis[v] > Max * n ) { flag = true; return ; } \n            if ( vis[v] == x ) { flag = true; return ; }\n        }\n    }\n    vis[u] = 0;\n}\n\ninline bool solve() \n{\n    mem(vis); mem(dis);\n    flag = false;\n    REP(i, 1, n) \n    {\n        spfa(i, i);\n        if ( flag == true ) return true;\n    }\n    return false;\n}\n\nint main()\n{\n#ifndef ONLINE_JUDGE\n    freopen(\"input.txt\", \"r\", stdin);\n    freopen(\"output.txt\", \"w\", stdout);\n#endif\n    scanf(\"%d%d\", &n, &m);\n    REP(i, 1, m)\n    {\n        int u, v; double w;\n        scanf(\"%d%d%lf\", &u, &v, &w);\n        add(u, v, w);\n        Max = max(Max, w);\n        Min = min(Min, w);\n    }\n    double L = Min, R = Max;\n    while ( L <= R ) \n    {\n        aver = (L + R) / 2;\n        if ( solve() ) { ans = min(ans, aver); R = aver - eps; }\n        else L = aver + eps;\n    }\n    printf(\"%.8lf\\n\", ans);\n    return 0;\n}\n```",
        "postTime": 1558060099,
        "uid": 8618,
        "name": "\u6c34\u5e93\u4e2d\u7684\u6c34\u5e93",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P3199 \u3010[HNOI2009]\u6700\u5c0f\u5708\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u4e0d\u5bb9\u6613\u6c42\u51fa\u6700\u5c0f\u503c\uff0c\u4f46\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u5316\u4e3a\u5224\u65ad\u53ef\u884c\u6027\u95ee\u9898\uff0c\u5c31\u662f\u4e8c\u5206\u6700\u5c0f\u503c\uff0c\u7528spfa\u5224\u65ad\u8d1f\u73af\n\n\u6ce8\u610f\u6bcf\u6b21spfa\u8981\u5c06vis\u548cdis\u521d\u59cb\u5316\u4e3a0\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\nusing namespace std;\nconst double eps=(1e-9);\nint head[10000],n,m,cnt;\nbool vis[10000],flag;\ndouble dis[10000];\nstruct node\n{\n    int to,w,next;\n } edge[10000];\nvoid add(int u,int v,int w)//\u52a0\u8fb9\n{\n    cnt++;\n    edge[cnt].w=w;\n    edge[cnt].to=v;\n    edge[cnt].next=head[u];\n    head[u]=cnt;\n}\nvoid spfa(int u,double mid)//dfs\u7248\u7684spfa\n{\n    vis[u]=1;\n    for(int i=head[u];i;i=edge[i].next)\n    {\n        int v=edge[i].to;\n        if(dis[v]>dis[u]+edge[i].w - mid)\n        {\n            if(vis[v]==1)\n            {\n                flag=false;    \n                return;\n            }\n            dis[v]=dis[u]+edge[i].w - mid;\n            spfa(v,mid);\n            if(flag == false) {\n                return;\n            }\n        }\n    }\n    vis[u]=0;\n}\nbool judge(double now)//\u5224\u65ad\n{\n    memset(dis,0,sizeof(dis));\n    memset(vis,0,sizeof(vis));\n    for(int i=1;i<=n;i++)\n    {\n        if(vis[i]) continue;\n        flag=true;\n        spfa(i,now);\n        if(flag==false)\n        return false;\n    }\n    return true;\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=m;i++)\n    {\n        int u,v,w;\n        scanf(\"%d%d%d\",&u,&v,&w);\n        add(u,v,w);\n    }\n    double l=0.000000,r=100000.0,mid;\n    double result=-1;\n    while(l-r<=eps)\n    {\n        mid=(l+r)/2;\n        if(judge(mid)==true) \n        {\n            l=mid+eps;    \n            result=max(result,mid);\n        }\n        else r=mid-eps;\n    }\n    printf(\"%.8f\",mid);\n    return 0;\n}\n\n```",
        "postTime": 1508990802,
        "uid": 26396,
        "name": "std__unsigned",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3199 \u3010[HNOI2009]\u6700\u5c0f\u5708\u3011"
    },
    {
        "content": "\u770b\u5230\u201c\u5e73\u5747\u503c\u201d\uff0c\u53ef\u4ee5\u60f3\u5230\u5148\u4e8c\u5206\u5708\u7684\u5e73\u5747\u503c\u7684\u6700\u5c0f\u503c\uff0c\u8bb0\u5f53\u524d\u7b54\u6848\u4e3a$mid$\u3002\n\n\u8fd9\u65f6\u5019\uff0c\u628a\u6240\u6709\u7684\u8fb9\u6743\u90fd\u51cf\u6389$mid$\uff0c\u8fd9\u6837\u5224\u65ad\u539f\u56fe\u4e2d\u662f\u5426\u5305\u542b\u6709\u5e73\u5747\u503c\u5c0f\u4e8e\u7b49\u4e8e$mid$\u7684\u5708\uff0c\u5c31\u8f6c\u5316\u6210\u4e86\u5224\u65ad\u65b0\u56fe\u4e2d\u662f\u5426\u5305\u542b\u6709\u8d1f\u73af\u3002\u7528SPFA\u6216DFS\u5224\u65ad\u8d1f\u73af\u5373\u53ef\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\ninline int read() {\n    int res = 0; bool bo = 0; char c;\n    while (((c = getchar()) < '0' || c > '9') && c != '-');\n    if (c == '-') bo = 1; else res = c - 48;\n    while ((c = getchar()) >= '0' && c <= '9')\n        res = (res << 3) + (res << 1) + (c - 48);\n    return bo ? ~res + 1 : res;\n}\nconst int N = 3005, M = 1e4 + 5; const double eps = 1e-9;\nint n, m, ecnt, nxt[M], adj[N], go[M], w[M]; double val[M], dis[N];\nbool Flag, vis[N];\nvoid add_edge(int u, int v, int x) {\n    nxt[++ecnt] = adj[u]; adj[u] = ecnt; go[ecnt] = v; w[ecnt] = x;\n}\nvoid dfs(int u) {\n    vis[u] = 1;\n    for (int e = adj[u], v; e; e = nxt[e])\n        if (dis[u] + val[e] < dis[v = go[e]]) {\n            if (vis[v]) return (void) (Flag = 1);\n            else {\n                dis[v] = dis[u] + val[e];\n                dfs(v);\n            }\n        }\n    vis[u] = 0;\n}\nbool check(double x) {\n    int i; memset(vis, 0, sizeof(vis));\n    for (i = 1; i <= ecnt; i++) val[i] = 1.0 * w[i] - x;\n    memset(dis, 0, sizeof(dis));\n    for (i = 1; i <= n; i++) {\n        Flag = 0;\n        if (dfs(i), Flag) return 1;\n    }\n    return 0;\n}\ndouble solve() {\n    double l = -1e5, r = 1e5;\n    while (fabs(r - l) > eps) {\n        double mid = (l + r) / 2;\n        if (check(mid)) r = mid;\n        else l = mid;\n    }\n    return l;\n}\nint main() {\n    int i, x, y, z; n = read(); m = read();\n    for (i = 1; i <= m; i++) x = read(), y = read(),\n        z = read(), add_edge(x, y, z);\n    printf(\"%.8lf\\n\", solve());\n    return 0;\n}\n```",
        "postTime": 1508641222,
        "uid": 29936,
        "name": "xyz32768",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3199 \u3010[HNOI2009]\u6700\u5c0f\u5708\u3011"
    },
    {
        "content": "# \u6700\u5c0f\u5708\n\n### Preface \u524d\u8a00\n\n\u53cc\uff08\u4e09\uff09\u500d\u7ecf\u9a8c\uff01\n\n- [P3199 [HNOI2009]\u6700\u5c0f\u5708](https://www.luogu.com.cn/problem/P3199)\n\n- [UVA11090 Going in Cycle!!](https://www.luogu.com.cn/problem/UVA11090)\n\n- [SP2885 WORDRING - Word Rings](https://www.luogu.com.cn/problem/SP2885)\n\n\u6240\u4ee5\uff0c\u4f60\u4eec\u53ef\u80fd\u4f1a\u5728 [UVA11090 Going in Cycle!!](https://www.luogu.com.cn/problem/UVA11090) \u8fd9\u7bc7\u9898\u89e3\u4e2d\u53c8\u770b\u5230\u6211qwq\n\n\n------------\n### Problem model \u95ee\u9898\u6a21\u578b\n\n\u8fd9\u4e09\u9053\u9898\u90fd\u662f\u7ed9\u5b9a\u4e00\u5f20\u6709\u5411\u56fe\uff0c\u9996\u5148\u5224\u65ad\u662f\u5426\u6709\u73af\n\n\u5982\u679c\u6709\u73af\u5c31\u6c42\u51fa\u6700\u5927\u73af\u6216\u6700\u5c0f\u73af\u7684\u5e73\u5747\u503c\n\n\u89e3\u51b3\u8fd9\u79cd\u9898\uff0c\u6211\u4eec\u901a\u5e38\u90fd\u662f\u4f7f\u7528 **\u4e8c\u5206\u7b54\u6848 & SPFA** \u5224\u73af\u6c42\u6700\u77ed\uff08\u957f\uff09\u8def\n\n### Train of thought \u601d\u8def\u70b9\u62e8\n\n- \u4e3a\u4ec0\u4e48\u4f1a\u60f3\u5230**\u4e8c\u5206\u7b54\u6848**\u5462\uff1f\n\n\u56e0\u4e3a\u5728\u627e\u6700\u5927\uff08\u5c0f\uff09\u73af\u7684\u65f6\u5019\u6211\u4eec\u4e00\u822c\u4f1a\u60f3\u5230\uff1a\n\n\u904d\u5386\u6574\u4e2a\u56fe\uff0c\u627e\u5230\u6bcf\u4e00\u4e2a\u73af\uff0c\u7136\u540e\u7b97\u51fa\u5b83\u4eec\u7684\u5e73\u5747\u503c\uff0c\u6700\u540e\u6bd4\u8f83\u51fa\u6700\u5927\uff08\u5c0f\uff09\u503c\n\n\u4f46\u662f\u9898\u76ee\u53ef\u80fd\u662f\u591a\u7ec4\u6570\u636e\uff0c\u8fd8\u4e0d\u8bf4\u56fe\u7684\u5927\u5c0f\uff0c\u6240\u4ee5\u8fd9\u79cd\u601d\u8def\u5927\u6982\u7387\u4f1a $T$ \u98de\u7684\n\n- \u90a3\u600e\u4e48\u505a\uff1f\n\n\u2014\u2014\u4e0d\u80fd\u627e\u73af\uff0c\u90a3\u6211\u4eec\u5c31\u76f4\u63a5\u627e\u7b54\u6848\u554a\uff01\uff08\u8fd9\u91cc\u8981\u8f6c\u6362\u4e00\u4e0b\u601d\u60f3\uff09\n\n\u56e0\u4e3a\u627e\u7b54\u6848 $=$ \u679a\u4e3e\u7b54\u6848\uff0c\u800c\u679a\u4e3e\u7b54\u6848\u4e00\u822c\u4f7f\u7528\u8f83\u9ad8\u6548\u7684**\u4e8c\u5206\u7b54\u6848**\uff01\n\n- \u518d\u6765\u8f6c\u6362\u4e00\u4e0b\u5173\u952e\u5f0f\u5b50\n\n\u6211\u4eec\u80fd\u5c06\u6c42\u7b54\u6848$ans$\u7684\u5f0f\u5b50\u8868\u793a\u5982\u4e0b\uff1a\n\n$ans=(len_1+len_2+len_3+\u00b7\u00b7\u00b7+len_k)/K$\n\n\u6570\u5b66\u8f6c\u6362\u4e00\u4e0b\uff1a\n\n$ans*K=len_1+len_2+len_3+\u00b7\u00b7\u00b7+len_k$\n\n\u79fb\u9879\u4e00\u4e0b\uff1a\n\n$(len_1+len_2+len_3+\u00b7\u00b7\u00b7+len_k)-ans*K=0$\n\n\u6700\u540e\u6211\u4eec\u53ef\u5f97\uff1a\n\n$(len_1-ans)+(len_2-ans)+(len_3-ans)+\u00b7\u00b7\u00b7+(len_k-ans)\u22650$\n\n\uff08\u56e0\u4e3a\u6700\u5f00\u59cb\u7684\u5f0f\u5b50\u662f\u6574\u9664\uff0c\u4f1a\u6709\u7cbe\u5ea6\u95ee\u9898\uff0c\u6240\u4ee5\u662f $\u2265$ \uff09\n\n- \u7ecf\u8fc7\u4e0a\u8ff0\u8f6c\u6362\u4e4b\u540e\uff0c$SPFA$ \u4e2d**\u66f4\u65b0\u8def\u5f84\u957f\u5ea6**\u7684\u5199\u6cd5\u5c31\u5e94\u8be5\u5982\u4e0b\uff1a\n\n```dis[v]>dis[now]+e[i].val-mid``` \u6216 ```dis[v]<dis[now]+e[i].val-mid```\n\n\u5219 ```dis[v]=dis[now]+e[i].val-mid```\n\n\u5176\u4e2d $mid$ \u662f\u6211\u4eec\u5f53\u524d\u679a\u4e3e\u7684\u7b54\u6848\uff08\u7b2c\u4e00\u53e5\u662f\u6700\u5c0f\u73af\uff0c\u7b2c\u4e8c\u53e5\u662f\u6700\u5927\u73af\uff09\n\n- $check$ \u51fd\u6570\u7684\u5199\u6cd5\u4e5f\u53d8\u5f97\u663e\u800c\u6613\u89c1\uff1a\n\n**\u6bcf\u6b21\u679a\u4e3e\u4e86 $ans$\uff0c\u5c31\u8dd1 $SPFA$ \uff0c\u5982\u679c\u5b58\u5728\u73af\u5219\u8bf4\u660e\u5f53\u524d\u679a\u4e3e\u7684 $ans$ \u662f\u5408\u6cd5\u7684\uff0c\u53cd\u4e4b\u4e0d\u5408\u6cd5**\n\n------------\n#### Code \u4ee3\u7801\n\n\u6ce8\uff1a\u8fd9\u4e09\u9053\u9898\u6211\u90fd\u5199\u7684 $dfs$ \u7248\u7684 $SPFA$\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint n,m,u,v,tot;\ndouble w,dis[520010];\nint vis[520010],head[520010];\n\nstruct node {\n    int to,net;\n    double val;\n} e[520010];\n\ninline void add(int u,int v,double w) {\n    e[++tot].to=v;\n    e[tot].val=w;\n    e[tot].net=head[u];\n    head[u]=tot;\n}\n\ninline bool dfs(int now,double x) {\n    vis[now]=1;\n    for(register int i=head[now];i;i=e[i].net) {\n        int v=e[i].to;\n        if(dis[v]>dis[now]+e[i].val-x) {\n            dis[v]=dis[now]+e[i].val-x;\n            if(vis[v]==1||dfs(v,x)==true) return true;\n        }\n    }\n    vis[now]=0;\n    return false;\n}\n\ninline bool check(double x) {\n    for(register int i=1;i<=n;i++) {\n        vis[i]=0;\n        dis[i]=20050206;\n    }\n    for(register int i=1;i<=n;i++) {\n        if(dfs(i,x)==true) return true;\n    }\n    return false;\n}\n\nint main() {\n    scanf(\"%d%d\",&n,&m);\n    for(register int i=1;i<=m;i++) {\n        scanf(\"%d%d%lf\",&u,&v,&w);\n        add(u,v,w);\n    }\n    double l=-10000000,r=10000000;\n    while(r-l>1e-10) {\n        double mid=(l+r)/2;\n        if(check(mid)==true) r=mid;\n        else l=mid;\n    }\n    printf(\"%.8lf\",l);\n    return 0;\n}\n```\n\n------------\n### Epilogue \u5c3e\u58f0\n\n\u6700\u540e\uff0c\u5982\u679c\u8fd9\u7bc7\u9898\u89e3\u6709\u4efb\u4f55\u95ee\u9898\u6216\u4e0d\u61c2\u7684\u5730\u65b9\uff0c\u6b22\u8fce\u7559\u8a00\u533a\u8bc4\u8bba\n\n\u6211\u4e00\u5b9a\u4f1a\u53ca\u65f6\u56de\u590d\u3001\u6539\u6b63\uff0c\u8c22\u8c22\u5404\u4f4ddalao\u5440\uff01orz\n\n------------\n\n\n\n\n\n",
        "postTime": 1595768396,
        "uid": 145205,
        "name": "Eleven\u8c26",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3199 \u3010[HNOI2009]\u6700\u5c0f\u5708\u3011"
    },
    {
        "content": "\u4e8c\u5206\u7b54\u6848+dfs spfa\u5224\u8d1f\u73af\n\n\n\u4e8c\u5206\u51fa\u4e00\u4e2a\u7b54\u6848mid\uff0c\u5bf9\u4e8e\u6bcf\u6761\u8fb9\u7684\u6743\u503c\u51cf\u53bbmid\uff0c\u5229\u7528spfa\u627e\u8d1f\u73af\uff0c\u5982\u679c\u627e\u5230\u7684\u8bdd\uff0c\u8bf4\u660emid\u53ef\u4f5c\u4e3a\u6700\u5c0f\u5708\u7684\u5e73\u5747\u503c\n\n\u5bf9\u4e8e\u5224\u8d1f\u73af\uff0cdfs\u7684spfa\u6bd4bfs\u7684\u5feb\u5f88\u591a\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#define maxn 3005\n#define maxe 10005\nusing namespace std;\nstruct Edge\n{\n    int v;\n    double w;\n    int next;\n}e[maxe];\nint head[maxn],cnts=0,n,m;\ndouble eps=1e-9,dis[maxn];\nbool vis[maxn],flag;\ninline void addedge(int u,int v,double w)\n{\n    cnts++;\n    e[cnts].v=v;\n    e[cnts].w=w;\n    e[cnts].next=head[u];\n    head[u]=cnts;\n}\nvoid spfa(int x,double mid)\n{\n    vis[x]=1;\n    for(int i=head[x];i!=0;i=e[i].next)\n    {\n        int v=e[i].v;\n        if(dis[v]>dis[x]+e[i].w-mid)\n        {\n            if(vis[v])\n            {\n                flag=1;\n                return;\n            }\n            dis[v]=dis[x]+e[i].w-mid;\n            spfa(v,mid);\n        }\n    }\n    vis[x]=0;\n}\ninline bool check(double mid)\n{\n    memset(vis,0,sizeof(vis));\n    memset(dis,0,sizeof(dis));\n    for(int i=1;i<=n;i++)\n    {\n        flag=0;\n        spfa(i,mid);\n        if(flag) return 1;\n    }\n    return 0;\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1,u,v;i<=m;i++)\n    {\n        double w;\n        scanf(\"%d%d%lf\",&u,&v,&w);\n        addedge(u,v,w);\n    }\n    double l=-1e5,r=1e5,mid;\n    while(r-l>eps)\n    {\n        mid=(l+r)/2;\n        if(check(mid)) r=mid;\n        else l=mid;\n    }\n    printf(\"%.8lf\",mid);\n}\n```",
        "postTime": 1500706995,
        "uid": 38096,
        "name": "Position",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3199 \u3010[HNOI2009]\u6700\u5c0f\u5708\u3011"
    },
    {
        "content": "\u770b\u5230\u8fd9\u9053\u9898\uff0c\u9996\u5148\u60f3\u52302\u5206\uff0c\u5f53\u7136\u8fd9\u9053\u9898\u8fd8\u53ef\u4ee5\u7ed9\u6210\u591a\u79cd\u5f62\u5f0f\uff0c\u6bd4\u5982\u8bf4\u5c0f\u6570\u70b9\u4f4d\u6570\uff0c\u6240\u4ee5\u4e00\u5b9a\u8981\u786e\u5b9a\u503c\u7684\u8303\u56f4\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define maxn 3005\n#define fr(i,a,b); for(i=a;i<=b;i++)\nusing namespace std;\ntypedef long long ll;\nconst double ding=1e5;\nconst double eps=1e-9;\nstruct poi\n{\n    int x;\n    double y,z;\n    poi *nex;\n} *a[maxn];\nint i,n,m,x,y;\ndouble z,mn,mx,l,r,mid,tot,dis[maxn];\nbool cai,kan[maxn];\nvoid link(int x,int y,long double z)\n{\n    poi *p=new poi;\n    p->x=y;\n    p->y=z;\n    p->nex=a[x];\n    a[x]=p;\n    return;\n}\nvoid dfs(int x)\n{\n    kan[x]=1;\n    poi *p=new poi;\n    for(p=a[x];p;p=p->nex)\n        if (dis[p->x]>dis[x]+p->y-mid)\n        {\n            dis[p->x]=dis[x]+p->y-mid;\n            if (!kan[p->x]) dfs(p->x);\n            else cai=1;\n            if (cai) return;\n        }\n    kan[x]=0;\n    return;\n}\nbool check( double x)\n{\n    cai=0;\n    fr(i,1,n)\n    {\n        memset(kan,0,sizeof(kan));\n        memset(dis,0,sizeof(dis));\n        dfs(i);\n        if (cai) return 1;\n    }\n    return 0;\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&m);\n    mn=ding,mx=-ding\nfr(i,1,m)\n    {\n        scanf(\"%d%d%lf\",&x,&y,&z);\n        link(x,y,z);\n        mn=min(mn,z),mx=max(mx,z);\n    }\n    l=mn,r=mx;\n    while (r-l>eps)\n    {\n        mid=(l+r)/2;\n        if (check(mid)) r=mid;\n        else l=mid;\n    }\n    printf(\"%.8f\\n\",l);\n    return 0;\n}\n\n\n```\n\n",
        "postTime": 1538472999,
        "uid": 124407,
        "name": "stevewen",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3199"
    }
]
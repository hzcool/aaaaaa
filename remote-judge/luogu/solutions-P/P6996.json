[
    {
        "content": "\u8003\u8651\u66b4\u641c\u6bcf\u4e2a\u4f4d\u7f6e\u653e\u54ea\u4e2a\u62fc\u56fe\uff0c\u7136\u540e $\\mathcal O(wh)$ Check\uff0c\u6ce8\u610f\u5230\u7531\u4e8e\u9898\u76ee\u7684\u9650\u5236\uff0c\u89d2\u843d\u4e0a\u7684\u62fc\u56fe\u7684\u4f4d\u7f6e\u662f\u786e\u5b9a\u7684\uff1b\u800c\u8fb9\u754c\u4e0a\u7684\u62fc\u56fe\u88ab\u786e\u5b9a\u5728 $n-2$ \u4e2a\u4f4d\u7f6e\u91cc\uff0c\u53ef\u4ee5\u5728\u5185\u90e8\u679a\u4e3e\u9009\u62e9\u65b9\u6848\uff1b\u5269\u4e0b\u7684\u4f4d\u7f6e\u518d\u66b4\u641c\u3002\u8fd9\u6837\u60c5\u51b5\u5c31\u53ea\u5269\u4e0b\u4e86 $(n-2)!^4((n-2)^2)!$ \u79cd\uff0c\u975e\u5e38\u4e4b\u5c11\uff0c\u968f\u4fbf\u5b9e\u73b0\u5c31\u53ef\u4ee5\u8fc7\u4e86\u3002\n\n```cpp\nconst int N = 50;\n\nint k, w, h, n, W, H;\nchar str[N][N][N], ans[N][N];\n\nvoid Output() {\n\tprintf(\"%d %d\\n\", W, H);\n\tfor(int i = 1; i <= H; ++i)\n\t\tprintf(\"%s\\n\", ans[i] + 1);\n}\n\nbool Repl(int id, int pos_x, int pos_y, char c_bg, char c_ed) {\n\tstd::vector <pii> vaild_pos;\n\tint mov_x = -h + (pos_x - 1) * h + 1, mov_y = -w + (pos_y - 1) * w + 1;\n\tbool up_b = true, dn_b = true, lf_b = true, ri_b = true;\n\tfor(int y = w; y <= 2 * w - 1; ++y) {\n\t\tif(str[id][h - 1][y] != '.' || str[id][h][y] == '.') up_b = false;\n\t\tif(str[id][2 * h][y] != '.' || str[id][2 * h - 1][y] == '.') dn_b = false;\n\t}\n\tfor(int x = h; x <= 2 * h - 1; ++x) {\n\t\tif(str[id][x][w - 1] != '.' || str[id][x][w] == '.') lf_b = false;\n\t\tif(str[id][x][2 * w] != '.' || str[id][x][2 * w - 1] == '.') ri_b = false;\n\t}\n\tif((up_b && pos_x != 1) || (dn_b && pos_x != n) ||\n\t\t(lf_b && pos_y != 1) || (ri_b && pos_y != n)) return false;\n\tfor(int x = 1; x <= h * 3 - 2; ++x)\n\t\tfor(int y = 1; y <= w * 3 - 2; ++y) {\n\t\t\tint nx = x + mov_x, ny = y + mov_y;\n\t\t\tif(str[id][x][y] != '.') {\n\t\t\t\tif(nx <= 0 || ny <= 0 || nx > H || ny > W || ans[nx][ny] != c_bg)\n\t\t\t\t\treturn false;\n\t\t\t\tvaild_pos.push_back(mkp(nx, ny));\n\t\t\t}\n\t\t}\n\tfor(pii i : vaild_pos) {\n\t\tint x = i.fi, y = i.se;\n\t\tans[x][y] = c_ed;\n\t}\n\treturn true;\n}\n\nbool vis[N];\nvoid Dfs(int cur_pos_x, int cur_pos_y) {\n\tif(cur_pos_x == n + 1) { Output(); exit(0); }\n\tfor(int i = 1; i <= k; ++i) {\n\t\tif(!vis[i] && Repl(i, cur_pos_x, cur_pos_y, '.', i - 1 + 'A')) {\n\t\t\tvis[i] = true;\n\t\t\tDfs(cur_pos_x + (cur_pos_y == n), cur_pos_y % n + 1);\n\t\t\tRepl(i, cur_pos_x, cur_pos_y, i - 1 + 'A', '.');\n\t\t\tvis[i] = false;\n\t\t}\n\t}\n}\n\nint main() {\n\trd(k, w, h);\n\tn = lround(floor(sqrt(k)));\n\tW = w * n; H = h * n;\n\tfor(int i = 1; i <= H; ++i)\n\t\tfor(int j = 1; j <= W; ++j) ans[i][j] = '.';\n\tfor(int i = 1; i <= k; ++i)\n\t\tfor(int j = 1; j <= h * 3 - 2; ++j)\n\t\t\tscanf(\"%s\", str[i][j] + 1);\n\tDfs(1, 1);\n\treturn 0;\n}\n```",
        "postTime": 1641981937,
        "uid": 34238,
        "name": "zhylj",
        "ccfLevel": 9,
        "title": "P6996"
    }
]
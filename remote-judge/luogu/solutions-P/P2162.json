[
    {
        "content": "[\u535a\u5ba2\u98df\u7528\u66f4\u4f73](http://39.105.95.125/index.php/archives/416/)\n\n**\u4f20\u9001\u95e8**\uff1a[P2162](https://www.luogu.org/problem/P2162)\n\n**Description**\n\n\u7ed9\u51fa\u4e00\u4e2a\u6709 $n$ \u4e2a\u70b9\u7684\u5706\u73af\uff0c\u73b0\u5728\u8981\u7528 $17$ \u79cd\u4e0d\u540c\u7684\u989c\u8272\u586b\u5145\u5b83\u3002\n\u82e5\u4e24\u79cd\u586b\u8272\u65b9\u6848\u7ecf\u8fc7\u65cb\u8f6c\u540e\u53ef\u4ee5\u91cd\u5408\uff0c\u5219\u89c6\u8fd9\u4e24\u79cd\u586b\u8272\u65b9\u6848\u4e3a\u540c\u4e00\u79cd\u586b\u8272\u65b9\u6848\u3002\n\u4fdd\u8bc1 $17$ \u79cd\u989c\u8272\u901a\u5fc5\u987b\u7528\u4e0a\u3002\n\u6c42\u65b9\u6848\u6570\uff0c\u7b54\u6848\u4fdd\u7559\u6700\u540e $120$ \u4f4d\uff0c\u4e0d\u591f\u7684\u7528 $0$ \u8865\u9f50\u3002\n\n**\u524d\u8a00**  \n\n\u7ba1\u7406\u5458\u5927\u5927\u8bf7\u628a\u8fd9\u4e2a\u9898\u6539\u4e3a\u9ed1\u9898\u3002  \n\u8fd9\u4e2a\u9898\u770b\u8d77\u6765\u597d\u96be\u554a\uff0c~~\u4e8e\u662f\u6211\u4eec\u4e0a\u7f51\u641c\u7d22\u9898\u89e3~~\u3002  \n\u6ca1\u60f3\u5230\u5b83\u6d89\u53ca\u7fa4\u8bba\uff0c\u5bb9\u65a5\uff0c\u9ad8\u7cbe\u3002~~\u4e3a\u4ec0\u4e48\u662f\u84dd\u9898\u554a~~  \n\u90a3\u6211\u4eec\u5c31\u6765\u7814\u7a76\u4e00\u4e0b\u8fd9\u9053\u9898\u5427\n\n**Solution**\n\n\u7531\u4e8e $n$ \u4e2a\u70b9\u7ec4\u6210\u7684\u5708\u53ef\u4ee5\u5f62\u6210 $n$ \u4e2a\u7f6e\u6362\uff0c\u663e\u7136\u6709\u5faa\u73af\u8282\u6570\u4e3a $\\gcd (i,n)$ \uff0c\u5355\u4e2a\u5faa\u73af\u8282\u957f\u5ea6\u4e3a $\\frac{n}{\\gcd (i,n)}$ \n\n\u8bbe\u4ec5\u7528 $m$ \u79cd\u989c\u8272\u67d3\u8272\u7684\u65b9\u6848\u4e3a $f(m)$\u3002\n\n\u7531Burnside\u5f15\u7406\u548cPolya\u5b9a\u7406\u53ef\u5f97 \n$$f(m)=\\frac{\\sum_{i=1}^{n} m^{\\gcd (i,n)} }{n}$$  \n\n\u628a $n$ \u79fb\u8fc7\u6765\uff0c\u5c06 $\\gcd$ \u79fb\u51fa\u6765\uff0c\u4e5f\u5c31\u662f\u679a\u4e3e $\\gcd$ \uff1a\n$$f(m) \\times n = \\sum_{i|n} m^i \\times \\sum_{j=1}^n [\\gcd (n,j)==i] $$\n\n$$f(m) \\times n = \\sum_{i|n} m^i \\times \\sum_{j=1}^{\\frac{n}{i}} [\\gcd (n,i \\times j)==i] $$\n\n$$f(m) \\times n = \\sum_{i|n} m^i \\times \\sum_{j=1}^{\\frac{n}{i}} [\\gcd (\\frac{n}{i}, j)==1] $$\n\n$$f(m) \\times n = \\sum_{i|n} m^i \\times \u03c6 (\\frac{n}{i}) $$\n\n\u8003\u8651 $n<=10^9$ \u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u5206\u89e3\uff0c\u679a\u4e3e\u8d28\u56e0\u6570\u3002\u8bb0\u5f97\u5199\u9ad8\u7cbe\u3002\n\n\u56e0\u4e3a17\u79cd\u989c\u8272\u90fd\u8981\u7528\u5230\uff0c\u7528\u5bb9\u65a5\uff1a\n$$ Ans=\\sum_{m=1}^{17} (-1)^{m+1} \\times f(m) \\times C_{17}^m $$\n\n\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u662f\uff0c\u8981\u6c42\u51fa $f(m)$ \uff0c\u6211\u4eec\u8981\u505a\u4e00\u4e2a\u9ad8\u7cbe\u9664\u6cd5\u3002\u53ef\u4ee5\u628a\u6bcf\u4e00\u4e2a\u9ad8\u7cbe\u5ea6\u6570\u4fdd\u5b58\u4e3a $q\\times n+p$ \u7684\u5f62\u5f0f\u3002\n\n\u6362\u8a00\u4e4b\uff0c\u5c31\u662f\u628a\u6700\u540e\u4e00\u4f4d\u7684\u5341\u8fdb\u5236\u6539\u6210 $n$ \u8fdb\u5236\uff0c\u6700\u540e\u7b54\u6848\u76f4\u63a5\u8f93\u51fa $q$ \u5373\u53ef\u3002\n\n\u9ad8\u7cbe\u8fd8\u8981\u538b\u4f4d\uff0c\u4e0d\u7136\u4f1a\u88ab\u5361\u5e38\u3002\n\n\u6240\u4ee5\u8fd9\u662f\u4e00\u9053\u7fa4\u8bba\u88f8\u9898\uff0c\u4f46\u662f\u6bd2\u7624\u51fa\u9898\u4eba\u641e\u51fa\u4e86\u4e00\u5806\u6076\u5fc3\u64cd\u4f5c\u3002\n\n\u4ee3\u7801\u5c31\u81ea\u5df1\u5199\u5427 ~~\uff08\u4f60\u90fd\u80fd\u770b\u5b8c\u8fd9\u7bc7\u9898\u89e3\u4e86\u5f53\u7136\u80fd\u5199\u4ee3\u7801\u4e86\u5427~~",
        "postTime": 1570582533,
        "uid": 145596,
        "name": "AquaRio",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2162 \u3010[SHOI2007]\u5b9d\u77f3\u7eaa\u5ff5\u5e01\u3011"
    }
]
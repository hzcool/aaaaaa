[
    {
        "content": "[\u4e0d\u77e5\u9053\u66f4\u597d\u8fd8\u662f\u66f4\u574f\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/Illusory-dimes/p/15510405.html)\n\n\u590d\u76d8 pb \u8bb2\u7684\u9898\uff0c\u6765\u5199\u7bc7\u9898\u89e3~~\u9020\u798f\u793e\u4f1a~~\u3002\n\n## Description\n\n\u6709 $n$ \u4e2a\u7ea2\u8272\u7684\u70b9\uff0c\u5750\u6807\u4e3a $r_i$ \u548c $m$ \u4e2a\u84dd\u8272\u7684\u70b9 $b_i$ \uff0c\u95ee\u5728\u6240\u6709\u70b9\u90fd\u81f3\u5c11\u4e0e\u4e00\u4e2a\u5f02\u8272\u7684\u70b9\u8fde\u8fb9\u7684\u60c5\u51b5\u4e0b\uff0c\u6700\u5c0f\u82b1\u8d39\uff0c\u5176\u4e2d\u82b1\u8d39\u6307\u4e24\u70b9\u5750\u6807\u5dee\u3002\n\n$n,\\ m \\leq 10 ^ 5\\ ,\\ \\ r_i,\\ b_i \\leq 10 ^ 9$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3eehzk10.png)\n\n## Analysis\n\n\u975e\u5e38\u70e6\uff0c\u56e0\u4e3a\u5e76\u4e0d\u77e5\u9053\u5230\u5e95\u600e\u4e48\u6837\u624d\u662f\u6700\u5c0f\u82b1\u8d39\u3002\n\n\u8fd9\u79cd\u4e24\u4e24\u914d\u5bf9\u7684\u8fd9\u79cd\uff0c\u5176\u5b9e\u5e94\u8be5\u662f\u80fd\u60f3\u5230\u7f51\u7edc\u6d41\u7684\uff0c\u4f46\u662f\u56e0\u4e3a\u6211\u6c34\u5e73\u4e25\u91cd\u4e0d\u591f\uff0c\u60f3\u4e0d\u51fa\u6765\u600e\u4e48\u505a\uff0c\u5c31\u76f4\u63a5\u653e\u5f03\u4e86\u3002\u3002\n\n\u4e8e\u662f\u6765\u89c2\u5bdf\u90e8\u5206\u5206\u6709\u4ec0\u4e48\u7c7b\u578b\uff0c\u6ce8\u610f\u5230 13 \u5206\u90a3\u4e2a\u7ea6\u675f\u6761\u4ef6\uff0c\u5c31\u76f8\u5f53\u4e8e\u6574\u4e2a\u6570\u8f74\u4e0a\u53ea\u6709\u4e24\u4e2a\u989c\u8272\u5757\u3002\n\n\u5757\uff0c\u90a3\u662f\u4e0d\u662f\u5bf9\u4e8e\u5176\u4ed6\u60c5\u51b5\u90fd\u53ef\u4ee5\u8fd9\u4e48\u60f3\uff0c\u90a3\u5bf9\u4e8e\u4efb\u4f55\u4e00\u4e2a\u4f8b\u5b50\uff0c\u90fd\u53ef\u4ee5\u753b\u6210\u8fd9\u4e2a\u6837\u5b50\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ps9x7q6i.png)\n\n\u6b63\u597d\u6bcf\u4e2a\u70b9\u8fde\u7684\u8fb9\u7684\u6570\u91cf\u6ca1\u6709\u9650\u5236\uff0c\u53ea\u662f\u8981\u6709\u8fb9\u5c31\u884c\uff0c\u8fd9\u6837\u5b50\u770b\u95ee\u9898\u5c31\u611f\u89c9\u6e05\u6670\u591a\u4e86\u3002\n\n## Solution\n\n\u63a5\u7740 Analysis \u4e2d\u7684\u56fe\uff0c\u5f88\u5feb\u5e94\u8be5\u5c31\u80fd\u53d1\u73b0\uff0c\u4e00\u4e2a\u989c\u8272\u5757\u91cc\u9762\u7684\u70b9\u9876\u591a\u4f1a\u8ddf\u65c1\u8fb9\u4e24\u4e2a\u5f02\u8272\u5757\u91cc\u9762\u7684\u70b9\u8fde\u8fb9\u3002\n\n\u56e0\u4e3a\u518d\u5f80\u5916\u7684\u8bdd\u80af\u5b9a\u5c31\u4f1a\u5148\u7ecf\u8fc7\u4e00\u4e9b\u540c\u8272\u70b9\uff0c\u8ba9\u90a3\u4e9b\u70b9\u53bb\u8fde\u66f4\u5916\u5c42\u7684\u5f02\u8272\u70b9\u663e\u7136\u4f1a\u66f4\u4f18\u3002\n\n\u90a3\u4e48\u95ee\u9898\u9010\u6e10\u7b80\u6d01\u4e86\u8d77\u6765\uff0c\u597d\u6781\u4e86\uff01\uff011\n\n\u90a3\u4e48\u5bf9\u4e8e\u4e24\u4e2a\u989c\u8272\u5757\uff0c\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u786e\u5b9a\u4e86\u91cc\u9762\u7684\u70b9\u8981\u76f8\u4e92\u8fde\u8fb9\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/d76ckifk.png)\n\n\n\u80af\u5b9a\u6bcf\u4e2a\u70b9\u90fd\u8981\u4f38\u51fa\u53bb\u4e00\u4e2a\u8fb9\uff0c\u7136\u540e\u4e00\u5171\u4f1a\u8fde $\\max(n,\\ m)$ \u6761\uff0c\u70b9\u591a\u7684\u90a3\u8fb9\u5c31\u80af\u5b9a\u4f1a\u8d2a\u5fc3\u7684\u628a\u591a\u51fa\u6765\u7684\u70b9\u8fde\u5411\u6700\u9760\u8fd1\u81ea\u5df1\u7684\u5f02\u8272\u70b9\uff0c\u6240\u4ee5\u5bf9\u4e8e\u8fd9\u4e2a\u6837\u5b50\u7684\u56fe\uff0c\u82b1\u8d39\u5c31\u662f\uff1a\n\n$$\n\\sum_{i = 1}^{cnt1}(b_{cnt1} - b_i) + \\sum_{i = 1}^{cnt2}(r_i - r_{cnt2}) + \\max(n,\\ m) \\cdot (r_{cnt2} - b_{cnt1})\n$$\n\n\u8fd9\u73a9\u610f\u80fd\u5728\u505a\u524d\u7f00\u548c\u5148\u7b97\u597d\uff0c\u95ee\u9898\u4e0d\u5927\u3002\n\n\u90a3\u4e9b\u5728\u5c31\u76f8\u5f53\u4e8e\u6211\u4eec\u53ea\u8981\u77e5\u9053\u5728\u6ee1\u8db3\u6761\u4ef6\u7684\u60c5\u51b5\uff0c\u4e00\u4e2a\u533a\u95f4\u662f\u628a\u591a\u5c11\u4e2a\u70b9\u8fde\u5411\u524d\u9762\uff08\u5269\u4e0b\u7684\u5c31\u8fde\u5411\u540e\u9762\uff09\u82b1\u8d39\u6700\u5c0f\u3002\n\n\u8003\u8651 DP \uff0c $f_i$ \u8868\u793a\u5728\u524d $i$ \u4e2a\u70b9\u7684\u6700\u5c0f\u82b1\u8d39\u3002\n\n\u8f6c\u79fb\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u628a\u6240\u6709\u70b9\u5212\u5206\u6210\u82e5\u5e72\u7ec4\u524d\u9762\u4e00\u6bb5\u7ea2\u540e\u9762\u4e00\u6bb5\u84dd\u7684\u6837\u5b50\u3002\n\n\u7136\u540e\u53ef\u4ee5\u76f4\u63a5\u679a\u4e3e\u5728\u54ea\u4e2a\u5730\u65b9\u65ad\u5f00\uff0c\u524d\u534a\u90e8\u5206\u5411\u524d\u8fde\u8fb9\uff0c\u540e\u534a\u90e8\u5206\u5411\u540e\u8fde\u8fb9\u3002\n\n\u7136\u540e\u628a\u524d\u9762\u90a3\u4e00\u6bb5\u770b\u4ece\u54ea\u91cc\u65ad\u51fa\u6765\u4e00\u90e8\u5206\u70b9\u5411\u540e\u8fde\u8fb9\u66f4\u4f18\uff0c\u8fd9\u4e9b\u662f\u53ef\u4ee5\u63d0\u524d\u9884\u5904\u7406\u597d\u7684\uff08\u5c31\u662f\u5957\u4e0a\u9762\u7684\u516c\u5f0f\uff09\uff0c\u5c31\u8981\u6ce8\u610f\u4e00\u4e0b\u4e24\u4e2a\u533a\u95f4\u5206\u51fa\u6765\u7684\u4e24\u90e8\u5206\u7684\u957f\u5ea6\u5173\u7cfb\u5c31\u53ef\u4ee5\u4e86\u3002\n\n## Code\n\n```cpp\n/*\n\n*/\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N = 1e6 + 10;\nconst ll INF = 1e16;\nll col[N], s[N], cnt, lt[N], rt[N], tot;\nll f[N], pre[N], sum[N], mn[N];\n\nll min_total_length(std::vector<int> R, std::vector<int> B) {\n\tll n = R.size(), r = 0, m = B.size(), b = 0;\n\twhile (r < n && b < m) {\n\t\tif (R[r] < B[b]) {\n\t\t\ts[++cnt] = R[r++];\n\t\t\tcol[cnt] = 1;\n\t\t}\n\t\telse {\n\t\t\ts[++cnt] = B[b++];\n\t\t\tcol[cnt] = 2;\n\t\t}\n\t}\n\twhile (r < n) s[++cnt] = R[r++], col[cnt] = 1;\n\twhile (b < m) s[++cnt] = B[b++], col[cnt] = 2;\n\tfor (r = 1; r <= cnt; r = b) {\n\t\tfor (b = r; b <= cnt && col[r] == col[b]; ++b);\n\t\tlt[++tot] = r; rt[tot] = b - 1;\n\t}\n\tfor (int i = lt[1]; i <= rt[1]; ++i) f[i] = INF;\n\tfor (int i = 2; i <= tot; ++i) {\n\t\tll invl = s[lt[i]] - s[rt[i - 1]], S = 0;\n\t\tll lth = rt[i - 1] - lt[i - 1], now = 1;\n\t\tfor (int j = rt[i - 1]; j >= lt[i - 1] - 1; --j) {\n\t\t\tsum[j] = sum[j + 1] + s[rt[i - 1]] - s[j];\n\t\t\tpre[j] = f[j] + sum[j + 1];\n\t\t\tmn[j] = pre[j] + invl * (rt[i - 1] - j);\n\t\t}\n\t\tfor (int j = rt[i - 1]; j >= lt[i - 1]; --j) pre[j - 1] = min(pre[j - 1], pre[j]);\n\t\tfor (int j = lt[i - 1]; j <= rt[i - 1]; ++j) mn[j] = min(mn[j], mn[j - 1]);\n\t\tfor (int j = lt[i]; j <= rt[i]; ++j) {\n\t\t\tS += s[j] - s[lt[i]];\n\t\t\tif (now <= lth) {\n\t\t\t\tll lef = rt[i - 1] - now + 1;\n\t\t\t\tf[j] = S + min(mn[lef - 1], pre[lef] + now * invl);\n\t\t\t}\n\t\t\telse f[j] = S + pre[lt[i - 1] - 1] + now * invl;\n\t\t\t++now;\n\t\t}\n\t}\n\treturn f[cnt];\n}\n```",
        "postTime": 1636031428,
        "uid": 206024,
        "name": "Illusory_dimes",
        "ccfLevel": 7,
        "title": "P3837 [IOI2017]Wiring \u63a5\u7ebf \u9898\u89e3"
    },
    {
        "content": "\u8003\u8651\u6a21\u62df\u8d39\u7528\u6d41\uff0c\u7ea2\u70b9\u4e0e\u84dd\u70b9\u4e4b\u95f4\u8fde $(|x_i-y_j|,1)$ \u7684\u8fb9\uff0c\u6e90\u70b9\u4e0e\u7ea2\u70b9\u4e4b\u95f4\u8fde\u4e24\u6761\u8fb9 $(\\operatorname{-inf},1),(0,\\inf)$\uff0c\u84dd\u70b9\u548c\u6c47\u70b9\u4e4b\u95f4\u540c\u7406\u3002\n\n\u63a5\u4e0b\u6765\u7684\u6b65\u9aa4\u540c [UOJ455 \u96ea\u707e\u4e0e\u5916\u5356](https://uoj.ac/problem/455)\uff0c\u8003\u8651\u600e\u4e48\u9000\u6d41\u5373\u53ef\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define fi first\n#define se second\ntypedef long long ll;\nconst int N=1e5+5;\nconst ll inf=2e9;\nll ans;\nstruct node{\n    ll c,flow;\n    bool operator < (const node & b) const {\n        return c < b.c;\n    }\n};\npriority_queue<node> red,blue;\nvoid add_red(int x){\n    if(!blue.empty()){\n        auto u=blue.top();blue.pop();\n        ans+=x-u.c;red.push({x+x-u.c,1ll});\n        u.flow--;if(u.flow>0) blue.push(u);\n    }\n    else ans+=inf,red.push({inf+x,1});\n    while(!blue.empty()){\n        if(x-blue.top().c>=0) break;\n        auto u=blue.top();blue.pop();\n        ans+=x-u.c;blue.push({x,1});\n        u.flow--;if(u.flow>0) blue.push(u);\n    }\n    red.push({x,inf});\n}\nvoid add_blue(int x){\n    swap(red,blue);\n    if(!blue.empty()){\n        auto u=blue.top();blue.pop();\n        ans+=x-u.c;red.push({x+x-u.c,1ll});\n        u.flow--;if(u.flow>0) blue.push(u);\n    }\n    else ans+=inf,red.push({inf+x,1});\n    while(!blue.empty()){\n        if(x-blue.top().c>=0) break;\n        auto u=blue.top();blue.pop();\n        ans+=x-u.c;blue.push({x,1});\n        u.flow--;if(u.flow>0) blue.push(u);\n    }\n    red.push({x,inf});\n    swap(red,blue);\n}\nll min_total_length(vector<int> r,vector<int> b){\n    ans=0;\n    int n=r.size(),m=b.size();\n    for(int i=0,j=0;i<n||j<m;){\n        if(i<n && (j==m || r[i]<b[j])) add_red(r[i]),++i;\n        else add_blue(b[j]),++j;\n    }\n    return ans;\n}\n```\n",
        "postTime": 1617089861,
        "uid": 344016,
        "name": "wurzang",
        "ccfLevel": 7,
        "title": "P3837 \u9898\u89e3"
    },
    {
        "content": "## \u9898\u76ee\u5927\u610f\n\n\u7ed9\u5b9a\u4e00\u5b8c\u5168\u4e8c\u5206\u56fe\uff0c\u5de6\u90e8\u70b9\u6570\u4e3a $n$\uff0c\u53f3\u90e8\u70b9\u6570\u4e3a $m$\uff08$1 \\le n,m \\le 10^5$\uff09\uff0e\u70b9\u6709\u70b9\u6743\u5de6\u53f3\u4fa7\u5206\u522b\u8bb0\u4e3a $a_i,b_i$\uff08$0 \\le a_i,b_i \\le 10^9$\uff09\uff0e\u5de6\u53f3\u90e8\u5206\u6bcf\u4e24\u4e2a\u70b9\u4e4b\u95f4\u90fd\u6709\u8fde\u8fb9\uff0c\u7b2c $x$ \u4e2a\u5de6\u90e8\u70b9\u548c\u7b2c $y$ \u4e2a\u53f3\u90e8\u70b9\u4e4b\u95f4\u7684\u8fb9\u6743\u4e3a $|a_x-b_y|$\uff0e\u6c42\u51fa\u8fd9\u4e2a\u56fe\u7684\u8fb9\u6743\u548c\u6700\u5c0f\u7684\u4e14\u6ee1\u8db3\u56fe\u4e2d\u6bcf\u4e2a\u70b9\u7684\u5ea6\u6570\u81f3\u5c11\u4e3a $1$ \u7684\u751f\u6210\u5b50\u56fe\uff0e\u8f93\u51fa\u8be5\u751f\u6210\u5b50\u56fe\u7684\u8fb9\u6743\u548c\uff0e\n\n## \u505a\u6cd5\u7b80\u8ff0\n\n\u5148\u8003\u8651 $13$ \u5206\u7684\u5b50\u4efb\u52a1\u5e94\u8be5\u600e\u4e48\u505a\uff0c\u8003\u8651\u8d2a\u5fc3\uff0e\u628a\u5de6\u53f3\u4e24\u90e8\u5206\u70b9\u4e00\u8d77\u653e\u5728\u6570\u8f74\u4e0a\uff0c\u4ece\u5de6\u5230\u53f3\u7ed9\u6bcf\u4e2a\u70b9\u7f16\u53f7 $1\\sim n+m$\uff0e\u9996\u5148\u663e\u7136\u6bcf\u4e2a\u5de6\u90e8\u70b9\u90fd\u8981\u5411\u6570\u8f74\u7684\u6b63\u65b9\u5411\u8fde\u51fa\u4e00\u6761\u8fb9\uff0c\u6bcf\u4e2a\u53f3\u90e8\u70b9\u53c8\u8981\u5411\u6570\u8f74\u7684\u8d1f\u65b9\u5411\u8fde\u51fa\u4e00\u6761\u8fb9\uff0c\u5219\u6700\u53f3\u4fa7\u7684\u5de6\u90e8\u70b9\u548c\u6700\u5de6\u4fa7\u7684\u53f3\u90e8\u70b9\u4e4b\u95f4\u4e00\u5b9a\u6709 $\\max\\{n,m\\}$ \u6761\u8fb9\u7ecf\u8fc7\uff0e\u5373\u7b54\u6848\u4e3a\uff1a\n\n$$\n(\\max\\{n,m\\}) \\cdot (b_1-a_n) + (\\sum_{i=1}^n a_n - a_i) + (\\sum_{i=1}^m b_i - b_1).\n$$\n\n\u7ee7\u7eed\u8003\u8651\u4e00\u822c\u60c5\u51b5\uff0e\u53d1\u73b0\u6211\u4eec\u53ef\u4ee5\u5c06\u6574\u4e2a\u6570\u8f74\u5212\u5206\u4e3a\u82e5\u5e72\u4e2a\u540c\u7c7b\u6bb5\uff0c\u6bcf\u4e2a\u540c\u7c7b\u6bb5\u91cc\u4ec5\u5305\u542b\u5de6\u90e8\u70b9\u6216\u8005\u53f3\u90e8\u70b9\uff0e\u7136\u540e\u628a\u6bcf\u4e2a\u540c\u7c7b\u6bb5\u4ece\u4e2d\u95f4\u5207\u5f00\uff0c\u5de6\u4e00\u534a\u548c\u4e0a\u4e00\u4e2a\u7684\u540c\u7c7b\u6bb5\u7684\u53f3\u8fb9\u62fc\u4e00\u5757\uff0c\u5c31\u53ef\u4ee5\u6309\u7167\u4e0a\u9762\u7684\u65b9\u6cd5\u505a\u4e86\uff0e\u8003\u8651 DP\uff0c\u8bbe $\\operatorname{dp}(i)$ \u4ec5\u8003\u8651\u6570\u8f74\u4e0a\u4ece\u5de6\u5411\u53f3\u6570\u524d $i$ \u4e2a\u70b9\u7684\u7b54\u6848\uff0e\u5219\u6709\u4ee5\u4e0b\u8f6c\u79fb\uff1a\n\n$$\n\\operatorname{dp}(i) \\gets \\min_{j \\in \\textsf{\u4e0a\u4e00\u4e2a\u540c\u7c7b\u6bb5}} \\{\\operatorname{dp}(j-1) + \\operatorname{F}(i,j)\\}.\n$$\n\n\u5176\u4e2d $\\operatorname{F}(i,j)$ \u8868\u793a\u5c06\u6570\u8f74\u4e0a\u4ece\u5de6\u5230\u53f3\u7b2c $i$ \u4e2a\u70b9\u5230\u7b2c $j$ \u4e2a\u70b9\u8fde\u8d77\u6765\u7684\u4ee3\u4ef7\uff0e\n\n\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a $O((n+m)^2)$ \u7684\u505a\u6cd5\uff0c\u4f46\u8fd8\u65e0\u6cd5\u901a\u8fc7\u672c\u9898\uff0e\u8003\u8651\u4f18\u5316\u4e0a\u8ff0 DP\uff0e\u5c06 $\\operatorname F$ \u62c6\u5206\u4e3a\u4e24\u90e8\u5206\uff1a\n\n$$\n\\def\\st{\\operatorname{start}}\n\\def\\ed{\\operatorname{end}}\n\\def\\pos{\\operatorname{pos}}\n\\def\\dp{\\operatorname{dp}}\n\\begin{aligned}\n\\dp(i) \\gets \\min_{j \\in \\textsf{\u4e0a\u4e00\u4e2a\u540c\u7c7b\u6bb5}} \\{\n& {\\color{darkred} \\dp(j-1) + (\\sum_{k=j}^{\\ed(j)} \\pos(\\st(i)) - \\pos(k))} \\\\\n{} + {} & {\\color{darkblue} (\\sum_{k=\\st(i)}^i \\pos(i) - \\pos(\\st(i)))} \\\\\n{} + {} & {\\color{darkgreen} \\max\\{0, (i - \\st(i)) - (\\ed(j) - j)\\} \\cdot (\\pos(\\st(i)) - \\pos(\\ed(j))) }\n\\}.\n\\end{aligned}\n$$\n\n\u5176\u4e2d $\\operatorname{start}(x)$ \u8868\u793a $x$ \u6240\u5728\u7684\u540c\u7c7b\u6bb5\u7684\u5f00\u5934\u70b9\u7684\u7f16\u53f7\uff0c$\\operatorname{end}(x)$ \u8868\u793a $x$ \u6240\u5728\u7684\u540c\u7c7b\u6bb5\u7684\u7ed3\u5c3e\u70b9\u7684\u7f16\u53f7\uff0c$\\operatorname{pos}(x)$ \u8868\u793a\u7f16\u53f7\u4e3a $x$ \u7684\u70b9\u7684\u4f4d\u7f6e\uff0e\n\n\u53d1\u73b0\u4e0a\u8ff0\u516c\u5f0f\u4e2d\u7684\u7ea2\u8272\u90e8\u5206\u4e0e $i$ \u65e0\u5173\uff0c\u84dd\u8272\u90e8\u5206\u4e0e $j$ \u65e0\u5173\uff0c\u7eff\u8272\u90e8\u5206\u4e0e\u4e24\u8005\u90fd\u76f8\u5173\uff0e\u8003\u8651\u4f7f\u7528\u7ebf\u6bb5\u6811\u5bf9\u4e8e\u4e0a\u4e00\u4e2a\u540c\u7c7b\u6bb5\u7ef4\u62a4\u516c\u5f0f\u4e2d\u7684\u7ea2\u8272\u90e8\u5206\uff0c\u679a\u4e3e $i$ \u7684\u65f6\u5019\u5728\u7ebf\u6bb5\u6811\u4e0a\u4f7f\u7528\u540e\u7f00\u52a0\u64cd\u4f5c\u4fee\u6539\u7eff\u8272\u90e8\u5206\uff0e\u8f6c\u79fb\u65f6\u53ea\u9700\u67e5\u8be2\u7ebf\u6bb5\u6811\u5168\u5c40 $\\min$ \u5373\u53ef\uff0e\n\n\u6ce8\u610f\u9700\u8981\u5bf9\u4e8e\u540c\u7c7b\u6bb5\u5927\u5c0f\u4e3a $1$ \u7684\u60c5\u51b5\u8fdb\u884c\u7279\u6b8a\u5904\u7406\uff0e\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n \\log n)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\uff0e\n\n## \u4ee3\u7801\u53c2\u8003\n\n```cpp\nint len;\nll dp[N], buf[N];\npair<int, bool> c[N];\n\nstruct Seg {\n  // \u7ebf\u6bb5\u6811\u7701\u7565\n} seg;\n\nlong long min_total_length(std::vector<int> r, std::vector<int> b) {\n  each (x, r) c[++len] = {x, 0};\n  each (x, b) c[++len] = {x, 1};\n  sort(c + 1, c + len + 1);\n  vector<int> lst, now;\n  ll sum = 0;\n  bool col = c[1].second;\n  memset(dp, 0x3f, sizeof dp);\n  dp[0] = 0;\n  re (i, len) {\n    if (c[i].second != col) {\n      lst = now, now.clear();\n      ll sum2 = 0;\n      per (j, lst.size() - 1, 0) {\n        sum2 += c[i].first - lst[j];\n        buf[j] = min(dp[i - lst.size() - 1 + j], dp[i - lst.size() + j]) + sum2;\n      }\n      seg.Build(1, 0, lst.size() - 1, buf);\n      col = c[i].second;\n      sum = 0;\n    }\n    now.push_back(c[i].first);\n    sum += c[i].first - now[0];\n    if (lst.empty()) continue;\n    int l = lst.size() - now.size() + 1;\n    up(l, 0);\n    if (l <= (int)lst.size() - 1)\n      seg.Add(l, lst.size() - 1, now[0] - lst.back(), 1, 0, lst.size() - 1);\n    dp[i] = seg.d[1].mn + sum;\n  }\n  return dp[len];\n}\n```\n",
        "postTime": 1669106350,
        "uid": 207996,
        "name": "yzy1",
        "ccfLevel": 9,
        "title": "P3837 \u9898\u89e3"
    }
]
[
    {
        "content": "\u54c7\u585e\uff01\u6211\u53ef\u4ee5\u8bf4\u8fd9\u662f\u53cc\u500d\u7ecf\u9a8c\u5417\uff1f\n\n\u548c**P4099HEOI2014SAO**\u662f\u91cd\u9898\uff0c\u800c\u4e14\u5f31\u5316\u4e86!!!\n\n\u6211\u4e5f\u662f\u4e0d\u60f3\u8bf4\u5565\u4e86\u2026\u2026\u660e\u660e\u6709O(n^2)\u7684\u590d\u6742\u5ea6\u554a\u2026\u2026\n\n\u6211\u53ef\u4ee5\u8d34\u4e00\u53d1\u6211\u7684\u9898\u89e3\u94fe\u63a5\u561b\u2026\u2026\n\nhttps://www.luogu.org/blog/ShadowassIIXVIIIIV/solution-p4099\n\n\u90a3\u4e48\u6211\u4eec\u53d1\u73b0\u5bf9\u6bd4HEOI2014\u6765\u8bb2\uff0c\u8fd9\u9053\u9898\u552f\u4e00\u7684\u95ee\u9898\u662f\uff0c\u6ca1\u6709\u6811QAQ\n\n\u4f46\u662f\u5982\u679c\u4f60\u5bf9\u4e8c\u53c9\u6811\u7684\u8868\u793a\u76f8\u5f53\u719f\u7ec3\u7684\u8bdd\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u5176\u5b9e\u7ebf\u6bb5\u6811\u4ec0\u4e48\u7684\u554a\uff0c\u4e8c\u53c9\u5806\u4ec0\u4e48\u7684\u554a\uff0c\u90fd\u662f\u75282\\*i\uff0c2\\*i+1\u6765\u8868\u793a\u7236\u5b50\u5173\u7cfb\u7684i/2\u5c31\u662fi\u7684\u7236\u4eb2\uff0c\u6240\u4ee5\u6811\u4ec0\u4e48\u7684\u662f\u53ef\u4ee5\u5efa\u51fa\u6765\u7684\uff0c\u8fd8\u662f\u4e00\u53ea\u5b8c\u5168\u4e8c\u53c9\u6811\uff0c\n\n\u5982\u679c\u6211\u4eec\u628a\u5b83\u7684\u62d3\u6251\u5e8f\u6392\u540d\u4f5c\u4e3a\u5168\u6392\u5217\u91cc\u7684\u4f4d\u7f6e\uff0c\u90a3\u4e48\u4e00\u4e2a\u62d3\u6251\u5e8f\u4e00\u4e00\u5bf9\u5e94\u4e00\u4e2a\u5168\u6392\u5217\n\n\u6240\u4ee5\u662f\u7ed9\u5b9a\u4e8c\u53c9\u6811\u578b\u56fe\uff0c\u6c42\u6240\u6709\u5408\u6cd5\u62d3\u6251\u5e8f\u65b9\u6848\uff0c\u8fd8\u53ea\u8981\u6c42O(N^3)\u7b97\u6cd5\uff01\n\n\u8fd8\u6709\u5c31\u662f\u8fd9\u9053\u9898\u8fde\u5c0f\u4e8e\u5927\u4e8e\u53f7\u90fd\u7ed9\u4f60\u4e86\u2026\u2026\uff0c\u4f60\u751a\u81f3\u4e0d\u5fc5\u6539HEOI\u90a3\u9053\u9898\u7684\u4ee3\u7801\n\n\u5f53\u7136\u6211\u5c31\u53ea\u5199O(N^3)\u7684\u4ee3\u7801\u54af~\uff0c\u6bd5\u7adf\u524d\u7f00\u548c\u5565\u7684\u8fd8\u5f97\u518d\u7ef4\u62a4\uff0c\u591a\u9ebb\u70e6\uff0c\u51fa\u9898\u4eba\u4e0d\u4e3a\u96be\u4f60\u5c31\u4e0d\u5199\u4e86\u554a\uff0c\u5199O(N^2)\u7684\u53bb\u4ea44099\n\n\u4f46\u662f\u8fd8\u6709\u4e00\u4e2a\u81f3\u5173\u91cd\u8981\u7684\u9ebb\u70e6\uff0c\u8f6c\u79fb\u65b9\u7a0b\u91cc\uff0c\u8981\u6c424\u4e2a1e9\u4e58\u4e00\u8d77\uff0c\u663e\u7136\u7206longlong\u2026\u2026\n\u6240\u4ee5\u5206\u5f00\u4e58\uff0c\u819c3\u904d\u5373\u53ef\n\n\u4e0a\u4ee3\u7801~\n\n```C\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\ntypedef unsigned long long ll;\nll mod=1e9+7;const int N=110;\nll dp[N][N];ll c[N][N];\nll siz[N];int n;ll res;\nchar mde[N];\ninline void dfs(int x)\n{\n\tfor(int v=2*x;v<=min(n,2*x+1);v++)\n\t{\n\t\tdfs(v);\n\t\tif(mde[v]=='>')//O(N^3)\u56e0\u4e3a\u6211\u61d2\u5f97\u6253\u524d\u7f00\u548c\n\t\t{\n\t\t\tfor(int k=siz[x]+siz[v];k>=1;k--)//\u679a\u4e3e\u6392\u540d\n\t\t\t{\n\t\t\t\tll sum=0;\n\t\t\t\tfor(int i=1;i<=min(siz[x],(ll)k);i++)//\u4fdd\u8bc1\u5408\u6cd5\u6027\u7684\u533a\u95f4\n\t\t\t\t{\n\t\t\t\t\tfor(int j=k-i+1;j<=siz[v];j++)//\u4fdd\u8bc1\u5408\u6cd5\u6027\n\t\t\t\t\t{\n\t\t\t\t\t\tll a=(dp[x][i]*dp[v][j])%mod;ll b=(c[i-1][k-1]*c[siz[x]-i][siz[x]+siz[v]-k])%mod;\n\t\t\t\t\t\ta=(a*b)%mod;sum=(sum+a)%mod;//\u4e24\u4e2a\u5e8f\u5217\u7684\u53ef\u80fd\u53d6\u503c\u60c5\u51b5*x\u524d\u5e8f\u5217\u7ec4\u5408*x\u540e\u5e8f\u5217\u7ec4\u5408\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdp[x][k]=sum;\n\t\t\t}\n\t\t}\n\t\telse//\u540c\u4e0a,\u53ea\u662f\u679a\u4e3e\u533a\u95f4\u53d8\u4e86,\u8f6c\u79fb\u65b9\u7a0b\u662f\u4e00\u6837\u7684\n\t\t{\n\t\t\tfor(int k=siz[x]+siz[v];k>=1;k--)\n\t\t\t{\n\t\t\t\tll sum=0;\n\t\t\t\tfor(int i=1;i<=min(siz[x],(ll)k);i++)\n\t\t\t\t{\n\t\t\t\t\tfor(int j=1;j<=min((ll)k-i,siz[v]);j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tll a=(dp[x][i]*dp[v][j])%mod;ll b=(c[i-1][k-1]*c[siz[x]-i][siz[x]+siz[v]-k])%mod;\n\t\t\t\t\t\ta=(a*b)%mod;sum=(sum+a)%mod;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdp[x][k]=sum;\n\t\t\t}\n\t\t}\n\t\tsiz[x]+=siz[v];//\u522b\u5fd8\u4e86siz\n\t}\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tc[0][0]=1;//\u6253\u8868\u7ec4\u5408\u6570\u5907\u7528\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tc[0][i]=1;c[i][i]=1;\n\t\tfor(int j=1;j<i;j++){c[j][i]=(c[j][i-1]+c[j-1][i-1])%mod;}\n\t}\n\tscanf(\"%s\",mde+2);//\u6ce8\u610f\u4ece2\u5f00\u59cb\n\tfor(int i=1;i<=n;i++){dp[i][1]=1;siz[i]=1;}//\u521d\u59cb\u5316\n\tdfs(1);\n\tfor(int i=1;i<=n;i++){res=(res+dp[1][i])%mod;}\n\tprintf(\"%lld\",res);return 0;//\u62dc\u62dc\u7a0b\u5e8f~\n}\n```\n\n",
        "postTime": 1519480120,
        "uid": 56384,
        "name": "shadowice1984",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3757 \u3010[CQOI2017]\u8001C\u7684\u952e\u76d8\u3011"
    },
    {
        "content": "\u53d1\u73b0\u9898\u76ee\u7ed9\u7684\u5f88\u50cf\u4e00\u68f5\u6811\u3002\u3002\u3002\n\n\u5c31\u628a\u8fd9\u68f5\u6811\u5efa\u51fa\u6765\u3002\n\n\u53d1\u73b0\u5982\u679c\u628a\u5927\u4e8e\u5c0f\u4e8e\u53f7\u5206\u522b\u770b\u6210\u4e00\u6761\u6709\u5411\u8fb9\uff0c \u53d1\u73b0\u8fd9\u4e2a\u9898\u76ee\u5c31\u662f\u6c42\u8fd9\u4e2a\u56fe\u6709\u591a\u5c11\u4e2a\u62d3\u6251\u5e8f\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u62d3\u6251\u5e8f\uff0c \u76f4\u63a5$$12345$$\u8fd9\u6837\u6807\u53f7\u5c31\u53ef\u4ee5\u5f97\u5230\u6ee1\u8db3\u9898\u76ee\u8981\u6c42\u7684\u5e8f\u5217\u3002\n\n\u8003\u8651\u6811$dp$, \u8bbe$f(i, j)$\u4e3a$i$\u8fd9\u4e2a\u70b9\u5728\u8fd9\u4e2a\u5b50\u6811\u6240\u5f62\u6210\u7684\u62d3\u6251\u5e8f\u5217\u4e2d\u5728\u7b2c$j$\u4f4d\u7684\u65b9\u6848\u6570\u3002\n\n\u8f6c\u79fb\u7684\u65f6\u5019\u5b9e\u9645\u4e0a\u5c31\u662f\u5408\u5e76\u4e24\u4e2a\u5e8f\u5217\u3002\n\n\u7528$x$\u8868\u793a\u5f53\u524d\u70b9,$y$\u8868\u793a\u513f\u5b50\u3002\n\n+ \u5f53$x > y$\u65f6\uff0c\n\n  $f(x,k) = \\sum C(k - 1, i - 1) \\times C(sz[x]+sz[y] -k, sz[x] -i) * f(x, i) * f(y, j)$\n\n  \u8fd9\u91cc\u7684$k$\u4ece$i + j$\u679a\u4e3e\u5230$i + sz[y]$\u3002\n\n  \u610f\u601d\u5c31\u662f\uff0c \u6ce8\u610f\u5230\u6211\u4eec\u5b9a\u4e49\u7684\u72b6\u6001\u662f\u53ea\u5173\u5fc3\u5176\u4ed6\u7684\u70b9\u548c\u5f53\u524d\u70b9\u7684\u76f8\u5bf9\u5927\u5c0f\u7684\uff0c \u6240\u4ee5\u5c31\u53ef\u4ee5\u8fd9\u6837\u7b97\u3002\n\n  \u76f8\u5f53\u4e8e\u524d$k - 1$\u4e2a\u4f4d\u7f6e\u91cc\u9762\u6709$i - 1$\u4e2a\u5728$x$\u539f\u672c\u6240\u5c5e\u4e8e\u7684\u6570\u5217\u91cc\u9762\uff0c \u5269\u4e0b\u7684\u662f$y$\u91cc\u9762\u7684\u3002\n\n  \u7136\u540e\u540e$sz[x] + sz[y] - k$\u4e2a\u4f4d\u7f6e\u91cc\u9762\u6709$sz[x] - i$\u4e2a\u662f\u539f\u672c\u5c5e\u4e8e$x$\u90a3\u4e2a\u6570\u5217\u7684\uff0c \u5269\u4e0b\u7684\u662f$y$\u91cc\u9762\u7684\u3002\n\n  \u7531\u4e8e\u6211\u4eec\u53ea\u5173\u5fc3\u76f8\u5bf9\u5927\u5c0f\u4ee5\u53ca\u6bcf\u4e2a\u6570\u662f\u6765\u81ea\u4e8e\u54ea\u4e00\u4e2a\u6570\u5217\uff0c \u6240\u4ee5\u8fd9\u91cc\u53ea\u8981\u4e58\u4e0a\u7ec4\u5408\u6570\u5c31\u53ef\u4ee5\u4e86\u3002\n\n+ \u5f53$x < y$\u65f6\n\n  \u8f6c\u79fb\u4e00\u6837\u7684\uff0c $k$\u4ece$i$\u5230$i + j - 1$\u3002\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <vector>\n#include <cstring>\n#include <algorithm>\n#include <iostream>\n\nusing namespace std;\n\n#define R register\nconst int N = 100 + 5;\nconst int P = 1e9 + 7;\n\ninline int read() {\n\tint x = 0, f = 1; char a = getchar();\n\tfor(; a >= '0' && a <= '9'; a = getchar()) x = x * 10 + a - '0';\n\treturn x * f;\n}\n\nint C[N][N]\t;\ninline void init() {\n\tfor(R int i = 0; i < N; i ++) {\n\t\tC[i][0] = 1;\n\t\tfor(R int j = 1; j <= i; j ++) \n\t\t\tC[i][j] = (C[i - 1][j] + C[i - 1][j - 1]) % P;\n\t}\n}\n\nint dp[N][N];\nint g[N][N];\n\nint n;\nchar s[N];\nint sz[N];\n\ninline void dfs(int x) {\n\tsz[x] = 1; dp[x][1] = 1;\n\tfor(R int p = 0; p <= 1; p ++) {\n\t\tint y = x * 2 + p;\n\t\tif(y > n) break;\n\t\tdfs(y); \n\t\tfor(R int i = 1; i <= sz[x]; i ++) g[x][i] = dp[x][i]; \n\t\tmemset(dp[x], 0, sizeof(dp[x]));\n\t\tfor(R int i = sz[x]; i >= 1; i --) \n\t\t\tfor(R int j = sz[y]; j >= 1; j --) {\n\t\t\t\tif(s[y] == '>') {\n\t\t\t\t\tfor(R int k = i + sz[y]; k >= i + j; k --) \n\t\t\t\t\t\tdp[x][k] = \n\t\t\t\t\t(dp[x][k] + 1LL * C[k - 1][i - 1] * C[sz[x] + sz[y] - k][sz[x] - i] % P * g[x][i] % P * dp[y][j] % P) % P;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tfor(R int k = i + j - 1; k >= i; k --)\n\t\t\t\t\t\tdp[x][k] = \n\t\t\t\t\t(dp[x][k] + 1LL * C[k - 1][i - 1] * C[sz[x] + sz[y] - k][sz[x] - i] % P * g[x][i] % P * dp[y][j] % P) % P;\n\t\t\t\t}\n\t\t\t}\n\t\tsz[x] += sz[y];\n\t}\n}\n\nint main() {\n\t#ifdef IN\n\tfreopen(\"a.in\", \"r\", stdin);\n\t//freopen(\".out\", \"w\", stdout);\n\t#endif\n\tinit();\n\tn = read(); scanf(\"%s\", s + 2);\n\tdfs(1);\n\tint ans = 0;\n\tfor(R int i = 1; i <= n; i ++) ans = (ans + dp[1][i]) % P;\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1602752653,
        "uid": 139012,
        "name": "______OvO______",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3757 \u3010[CQOI2017]\u8001C\u7684\u952e\u76d8\u3011"
    },
    {
        "content": "\u7528f[x][i]\u8868\u793a\u7b2cx\u4e2a\u8282\u70b9\u5728\u5f53\u524d\u5b50\u6811\u7684\u6392\u5217\u91cc\u6392\u5728\u7b2ci\u4e2a \u7684\u89e3\u6570\u3002\n\n\u90a3\u4e48\u4ece\u5f53\u524d\u5b50\u6811\u8282\u70b9\u4e2d\u5f04k\u4e2a\u51fa\u6765\u653e\u5728\u6839\u8282\u70b9\u524d\u9762\uff0c\u5176\u4ed6\u5b50\u6811\u4e2d\u5f04j-1\u4e2a\u51fa\u6765\uff0c \u5219\u6839\u8282\u70b9\u6392\u5728k+j\u4e2a\u3002\n\n\u7136\u540e\uff0c\u5982\u679c\u4e0d\u770b\u6b64\u5b50\u6811\uff0c\u5219\u6839\u8282\u70b9\u6392\u5728\u7b2c j\u4e2a\uff0c\u5c31\u662ff[x][j]\u79cd\u3002\u5982\u679c\u53ea\u770b\u5b50\u6811\uff0c\u5b50\u6811\u6839\u8282\u70b9\u7684\u6392\u5217\u662f\u4e00\u4e2a\u8fde\u7eed\u533a\u95f4\u7528\u524d\u7f00\u548c\u505a\n\n\u5408\u5e76\u7684\u6392\u5217\u5219\u662f\uff1a\u5bf9\u4e8e\u6839\u8282\u70b9\u524d\u9762\u7684\uff0c\u9009\u51faj-1\u4e2a\u4f5c\u4e3a\u975e\u6b64\u5b50\u6811\u5f04\u51fa\u6765\u7684\n\n\u5bf9\u4e8e\u540e\u9762\u7684\uff0c\u9009\u51fasum[x]-j\u4e2a\u4f5c\u4e3a\u975e\u6b64\u5b50\u6811\u4e2d\u5f04\u51fa\u6765\u7684\n\n\u5b83\u4eec\u7684\u987a\u5e8f\u662f\u6ca1\u6709\u5173\u7cfb\u7684\uff0c\u6240\u4ee5\u7528\u7ec4\u5408\u6570\u5373\u53ef\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<climits>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\nusing namespace std;\n#define ll long long\nll mod=1000000007;\nint n,tot;\nchar ss[105];\nll f[105][105],g[105][105],tmp[105],c[105][105];\nint h[105],to[105],ne[105],sum[105];\nvoid add(int x,int y){tot++;to[tot]=y;ne[tot]=h[x];h[x]=tot;}\nvoid dfs(int x){\n    int l=x<<1,r=l|1;\n    if(l<=n)add(x,l);\n    if(r<=n)add(x,r);\n    int i,j,k;\n    g[x][1]=f[x][1]=sum[x]=1;\n    for(i=h[x];i;i=ne[i]){\n        dfs(to[i]);\n        for(j=1;j<=sum[x]+sum[to[i]];j++)tmp[j]=0;//\u4e34\u65f6\u6570\u7ec4\n        for(j=1;j<=sum[x];j++)\n            for(k=0;k<=sum[to[i]];k++){\n            if(ss[to[i]]=='>')\n            tmp[j+k]+=f[x][j]*g[to[i]][k]%mod\n            *c[j+k-1][j-1]%mod*c[sum[x]+sum[to[i]]-j-k][sum[x]-j]%mod;\n            else tmp[j+k]+=f[x][j]*(g[to[i]][sum[to[i]]]-g[to[i]][k]+mod)%mod\n            *c[j+k-1][j-1]%mod*c[sum[x]+sum[to[i]]-j-k][sum[x]-j]%mod;\n        }\n        sum[x]+=sum[to[i]];\n        for(j=1;j<=sum[x];j++)//\u524d\u7f00\u548c\n        f[x][j]=tmp[j]%mod,g[x][j]=(g[x][j-1]+f[x][j])%mod;\n    }\n}\nint main()\n{\n    int i,j,x=0,bj=2;\n    scanf(\"%d%s\",&n,ss+2);\n    c[0][0]=1;\n    for(i=1;i<=n;i++){//\u7ec4\u5408\u6570\n        c[i][0]=1;\n        for(j=1;j<=i;j++)\n            c[i][j]=(c[i-1][j]+c[i-1][j-1])%mod;\n    }\n    dfs(1);printf(\"%lld\",g[1][sum[1]]);\n    return 0;\n}\n```",
        "postTime": 1497498311,
        "uid": 20604,
        "name": "litble",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P3757 \u3010[CQOI2017]\u8001C\u7684\u952e\u76d8\u3011"
    }
]
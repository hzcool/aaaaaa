[
    {
        "content": "## \u9898\u610f\u8f6c\u5316\n\n\u672c\u9898\u7684\u8f6c\u5316\u975e\u5e38\u5999\u5999\uff01\n\n\u5bf9\u4e8e\u4efb\u4f55\u4e00\u4e2a\u732a\u732a\u4e3e\u724c\u7684\u65b9\u6848\uff0c\u90fd\u53ef\u4ee5\u770b\u505a $9$ \u4e2a\u4ee5\u5185\u7684**\u82e5\u5e72 \u201c$1$ \u7684\u540e\u7f00\u201d\u76f8\u52a0\u800c\u6210**\uff01\n\n\u611f\u6027\u7406\u89e3\u5982\u4e0b\u56fe\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2j96qblu.png)\n\n\u4e8e\u662f\u6211\u4eec\u628a\u4e00\u4e2a\u65b9\u6848\u62c6\u6210\u4e86\u82e5\u5e72\u7684\u5f62\u5982 $00000...11111$ \u7684\u6570\u5b57\u76f8\u52a0\uff01\n\n-----\n\n\u9898\u76ee\u4e2d\u8ba9\u6211\u4eec\u6c42 $\\mod p$ \u610f\u4e49\u4e0b\u4e3a $0$ \u7684\u65b9\u6848\u6570\u3002\n\n\u60f3\u60f3\u600e\u4e48\u505a\uff1f\n\n\u6211\u4eec\u53ef\u4ee5\u628a\u4e00\u4e2a\u6570\u5206\u5272\u6210\u82e5\u5e72\u4e2a $000000...11111$ \u7684\u548c\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97\u51fa $n$ \u4e2a \u201c$1$ \u7684\u540e\u7f00\u201d\u5728 $\\mod p$ \u610f\u4e49\u4e0b \u7684\u503c\u3002\n\n\u56e0\u4e3a\u53ef\u4ee5\u9009\u81f3\u591a $9$ \u79cd\u540e\u7f00\uff0c\u6240\u4ee5\u5c31\u53ef\u4ee5\u8dd1 $O(n^9)$ \u66b4\u529b\uff01\n\n~~\u7136\u800c\u8fd9\u4e00\u4e2a\u70b9\u90fd\u8fc7\u4e0d\u53bb\u554a~~\n\n\u5176\u5b9e\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u628a $\\mod p$ \u610f\u4e49\u4e0b\u6709\u76f8\u540c\u6570\u503c\u7684\u540e\u7f00\u770b\u6210\u540c\u4e00\u7c7b\n\n\u6bd4\u5982 $11$ \u548c $1$ \u5728 $\\mod 5$ \u610f\u4e49\u4e0b\u662f\u540c\u4e00\u7c7b\u3002\n\n**\u4e0d\u59a8\u8bb0 $g[i]$ \u4e3a $\\mod p$ \u610f\u4e49\u4e0b[\u4f59\u6570\u662f $i$ \u7684\u201c$1$ \u7684\u540e\u7f00\u201d]\u7684\u6570\u91cf\u3002**\n\n(\u6700\u540e\u518d\u8bb2 $g[i]$ \u7684\u6c42\u6cd5\uff0c\u60f3\u770b\u53ef\u4ee5\u76f4\u63a5\u8df3)\n\n\u6211\u4eec\u5c31\u53ef\u4ee5\u4e0d\u7528\u66b4\u529b\n\n\u800c\u662f\u505a\u4e00\u4e2a\u80cc\u5305\u7684\u8f6c\u79fb\u5c31\u597d\u4e86\uff01\n\n## \u80cc\u5305\n\n\u8bbe $dp[i][j][s]$ \u8868\u793a\u5f53\u524d\u8003\u8651\u5230\u4f59\u6570\u4e3a $i$ \u7684 \u201c$1$ \u7684\u540e\u7f00\u201d\uff0c\u6b64\u524d\u5df2\u7ecf\u653e\u4e0a\u4e86 $j$ \u4e2a\u201c$1$ \u7684\u540e\u7f00\u201d\uff0c\u6b64\u65f6\u6784\u6210\u7684\u6570\u5b57\u7684 $\\mod p$ \u7684\u4f59\u6570\u662f $s$ \u7684\u65b9\u6848\u6570\u3002\n\n\u679a\u4e3e\u201c$1$ \u7684\u540e\u7f00\u201d$\\mod p$ \u610f\u4e49\u4e0b\u7684\u4f59\u6570 $O(p)$\uff0c\u8bb0\u4e3a $i$\u3002\n\n\u679a\u4e3e\u5f53\u524d\u5df2\u7ecf\u94fa\u4e86\u51e0\u4e2a\u201c$1$ \u7684\u540e\u7f00\u201d\u3002$O(9)$\uff0c\u8bb0\u4e3a $j$\u3002\n\n\u4e3a\u4ec0\u4e48\u662f $O(9)$\uff0c\u56e0\u4e3a\u6700\u5de6\u8fb9\u7684\u732a\u662f\u4e0d\u80fd\u51fa\u4ef7\u4e3a $0$ \u7684\uff0c**\u6240\u4ee5\u6700\u521d\u8981\u5f3a\u5236\u94fa\u4e00\u5c42\u5168 **$1$\u3002\n\n\u679a\u4e3e\u5f53\u524d\u8fd9\u79cd \u201c$1$ \u7684\u540e\u7f00\u201d\u94fa\u4e86\u51e0\u4e2a\u3002$O(9)$\uff0c\u8bb0\u4e3a $s$\u3002\n\n\u679a\u4e3e\u8f6c\u79fb\u8fc7\u6765\u7684\u72b6\u6001$\\mod p$ \u610f\u4e49\u4e0b\u7684\u4f59\u6570\u3002$O(p)$\uff0c\u8bb0\u4e3a $d$\u3002\n\n\u5219\u8f6c\u79fb\u65b9\u7a0b\u662f\uff1a\n\n$$dp[p][s+j][(d+s*i+p)\\%p]+=\\sum\\limits \\dbinom{g[i]+s-1}{s}dp[p-1][j][d]$$\n\n\u8fd9\u4e2a $\\dbinom{g[i]+s-1}{s}$ \u662f\u4ec0\u4e48\u5462\uff1f\n\n\u5c31\u662f\u5728 $g[i]$ \u4e2d\u9009 $s$ \u4e2a\u540c\u79cd \u201c$1$ \u7684\u540e\u7f00\u201d\u6709\u591a\u5c11\u79cd\u4e0d\u540c\u7684\u65b9\u6cd5\uff01\n\n\u8bc1\u660e\u5373\u9694\u677f\u6cd5\u3002\n\n\u590d\u6742\u5ea6\u5373 $O(81p^2)$\n\n\u81f3\u4e8e\u600e\u4e48\u8ba1\u7b97\u8fd9\u4e2a\u7ec4\u5408\u6570\uff0c\u76f4\u63a5\u6309\u5b9a\u4e49\u8ba1\u7b97\u5c31\u597d\u3002\n\n----\n\n## \u5faa\u73af\u8282\u7684\u8ba1\u7b97\n\n\u90a3\u4e48\u600e\u4e48\u8ba1\u7b97 $g[]$ \u6570\u7ec4\u5462\uff1f\n\n~~\u666e\u53ca\u7ec4\u77e5\u8bc6\uff1f~~\n\n\u5b9a\u4e49 $s_i$ \u8868\u793a $i$ \u4e2a $1$ \u8fde\u8d77\u6765\u5f62\u6210\u7684\u6570, $f_i$ \u4e3a\u5b83\u5728 $\\mod p$ \u610f\u4e49\u4e0b\u7684\u503c\u3002\n\n\u5982 $s_5=11111$\n\n$f_3=1\\mod 5$\n\n\u5219\u663e\u7136\u6709 $f_i=(10\\times f_{i-1}+1)\\%p$\n\n\u663e\u7136\u8fd9\u67ff\u5b50\u5728 $2p$ \u6b21\u8fed\u4ee3\u5185\u5fc5\u7136\u4f1a\u51fa\u73b0\u5faa\u73af\u3002\n\n\u53ef\u4ee5\u628a $f_i$ \u5206\u6210\u4e09\u6bb5\uff1a\n\n- \u672a\u8fdb\u5165\u5faa\u73af\u6bb5\n\n- \u5faa\u73af\u6bb5\n\n- \u4e0d\u5b8c\u6574\u5faa\u73af\u6bb5\n\n\u66b4\u529b\u7edf\u8ba1 \u672a\u8fdb\u5165\u548c\u4e0d\u5b8c\u6574 \u7684\uff0c\u7528\u5faa\u73af\u8282\u641e\u5b9a\u5faa\u73af\u7684\u5c31\u597d\u4e86\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include <cstring>\n#include <iostream>\nusing namespace std;\n\n#define mod (999911659LL)\n#define MX (500 + 5)\n#define LL long long\n\nLL qpow(LL x ,LL y ,LL P){\n\tif(!y)\treturn 1;\n\tif(y == 1)\treturn x;\n\tLL t = qpow(x ,y >> 1 ,P);\n\tif(y & 1)\treturn t * t % P * x % P;\n\treturn t * t % P;\n}\nLL g[MX] ,n ,p ,cycLen ,cycstNum;\nint cycle[MX * MX] ,first[MX];\nLL dp[MX][11][MX];\nLL C(LL n ,LL m){\n\tif(m < 0)\treturn 0;\n\tLL fz = 1 ,fm = 1;\n\tfor(int i = 0 ; i < m; ++i){\n\t\t(fz *= n - i) %= mod;\n\t\t(fm *= m - i) %= mod;\n\t}\n\treturn fz * qpow(fm ,mod - 2 ,mod) % mod;\n}\n\nint main(){\n\t// cout << C(10 ,7);\n\tmemset(first ,-1 ,sizeof first);\n\tcin >> n >> p;\n\tcycle[0] = 1 % p;\n\tfirst[1 % p] = 0;\n\tLL addition = 0;\n    // first \u662f\u8be5\u6570\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\n    // cycle \u662f\u6309\u987a\u5e8f\u51fa\u73b0\u7684\u6570 %p\n\tfor(int i = 1 ; ; ++i){\n\t\tcycle[i] = (cycle[i - 1] * 10 + 1) % p;\n\t\tif(~first[cycle[i]]){\n\t\t\tfor(int j = 0 ; j < i && j < n; ++j)\n\t\t\t\tg[cycle[j]]++ ,addition = cycle[j];\n\t\t\tn -= i;\n\t\t\tcycstNum = cycle[i];\n\t\t\tcycLen = i - first[cycle[i]];\n\t\t\tbreak;\n\t\t}\n\t\tfirst[cycle[i]] = i;\n\t}\n\tn = max(n ,0LL);\n\tLL times = n / cycLen;\n\tfor(int i = 0 ; i < cycLen ; ++i)\n\t\tg[cycle[i + first[cycstNum]]] += times;\n\tLL nn = n % cycLen;\n\tfor(int i = 0 ; i < nn ; ++i)\n\t\tg[cycle[i + first[cycstNum]]]++ ,addition = cycle[i + first[cycstNum]];\n\tfor(int i = 0 ; i < p ; ++i)\tg[i] %= mod;\n    \n    // \u56e0\u4e3a\u6211\u5f88\u61d2\uff0c\u6309\u7167\u4e0a\u6587\u535a\u5ba2\n    // \u5728\u8ba1\u7b97 dp[0][][] \u7684\u65f6\u5019\u4f1a\u8c03\u7528 dp[-1][][] \u5bfc\u81f4 RE\n    // \u6240\u4ee5\u6211\u662f\u5012\u7740\u6765\u7684\uff0c\u628a dp[0] \u53d8\u6210 dp[p] \uff0cdp[1] \u53d8\u6210 dp[p - 1]...\n\tdp[p + 1][0][addition] = 1;\n    // \u6b64\u5904 addition \u662f\u5f3a\u5236\u8981\u6c42\u9009\u62e9\u4e00\u6b21\u5168 111111... \u9020\u6210\u7684\u4ee3\u4ef7\n\tfor(int i = 0 ; i < p ; ++i){\t// \u679a\u4e3e\u4f7f\u7528\u7684 0000...1111 %p \u610f\u4e49\u7684\u503c  \n\t\tfor(int j = 0 ; j < 9 ; ++j){\t// \u679a\u4e3e\u5df2\u7ecf\u4f7f\u7528\u6b21\u6570 \n\t\t\tfor(int s = 0 ; s + j < 9 ; ++s){\t// \u679a\u4e3e\u5f53\u524d\u4f7f\u7528\u6b21\u6570 \n\t\t\t\tLL multi = C(g[i] + s - 1 ,s);\n\t\t\t\tfor(int d = 0 ; d < p ; ++d){\t// \u679a\u4e3e\u5df2\u7ecf\u7684\u4f59\u6570 \n\t\t\t\t\t// if(dp[p - i + 1][j][d]){printf(\"dp[%lld][%d][%lld] += multi(%lld) * dp[%lld][%d][%d](%lld);\\n\" ,p - i ,s + j ,(d + s * i) % p ,multi ,p - i + 1 ,j ,d ,dp[p - i + 1][j][d]);}\n\t\t\t\t\t(dp[p - i][s + j][(d + s * i) % p] += multi * dp[p - i + 1][j][d]) %= mod;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tLL Ans = 0;\n\t\n\tfor(int i = 0 ; i < 9 ; ++i){\n\t\t(Ans += dp[1][i][0]) %= mod;\n\t}\n\n\tcout << Ans << endl;\n\treturn 0;\n}\n\n\u200b```\n```",
        "postTime": 1578924410,
        "uid": 47863,
        "name": "Imakf",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2481 \u3010[SDOI2010]\u4ee3\u7801\u62cd\u5356\u4f1a\u3011"
    },
    {
        "content": "## $ solution: $ \n\n\u8fd9\u9053\u9898\u8c03\u4e86\u597d\u4e45\u597d\u4e45\uff0c\u4e45\u5230\u90fd\u8981\u653e\u5f03\u4e86\u3002\u6d1b\u8c37\u7684\u7b2c\u4e94\u4e2a\u70b9\u662f\u771f\u7684\u5f3a\uff0c\u7b80\u7b80\u5355\u5355\u4e00\u4e2a1\uff0c\u8c03\u4e86\u5feb4\u4e2a\u5c0f\u65f6\uff01\n\n\u8fd9\u9053\u9898\u7b2c\u4e00\u773c\u600e\u4e48\u90fd\u662f\u6570\u4f4dDP\uff0c\u5948\u4f55\u6570\u636e\u8303\u56f4\u592a\u5927\uff0c\u53ea\u80fd\u627e\u6027\u8d28\u3002\u800c\u8fd9\u9053\u9898\u6700\u91cd\u8981\u7684\u4e00\u4e2a\u6027\u8d28\u4e5f\u5f88\u5957\u8def\uff08\u6572\u96be\u60f3\uff09\uff0c\u56e0\u4e3a\u6211\u4eec\u6240\u6709\u7684\u65b9\u6848\u90fd\u662f $ 111112223333 $ \u8fd9\u6837\u7684\u6570\uff0c\u6211\u4eec\u8981\u6c42\u7684\u662f\u5b83\u7684\u5927\u5c0f\u6a21 $ p $ \uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u5c06\u5b83\u7528\u52a0\u6cd5\u62c6\u89e3\u3002\u4e8e\u662f\u6211\u4eec\u60ca\u5947\u7684\u53d1\u73b0\u5b83\u53ef\u4ee5\u8f6c\u5316\u6210\uff08\u4ee5\u4e0a\u9762\u90a3\u4e2a\u6570\u4e3a\u4f8b\uff09 $ 111111111111+1111111+1111=111112223333 $ \u3002\u6b63\u56e0\u4e3a\u6570\u4f4d\u4e0a\u7684\u6570\u5b57\u5355\u8c03\u4e0d\u964d\uff0c\u6240\u4ee5\u5b83\u53ef\u4ee5\u8868\u793a\u4e3a\u4e0d\u8d85\u8fc79\u4e2a\u5f62\u4f3c $ 111...111 $ \u7684\u6570\u7684\u548c\uff01   \n\n\u800c\u8fd9\u79cd\u5f62\u4f3c $ 1111...1111 $ \u7684\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u6211\u4eec\u4f9d\u6b21\u679a\u4e3e\u5b83\u7684\u957f\u5ea6\uff08 $ 1,11,111,1111...... $ \uff09\u8fd9\u4e9b\u6570\u5728\u6a21 $ p $ \u610f\u4e49\u4e0b\u4e00\u5b9a\u4f1a\u4ea7\u751f\u5faa\u73af\u8282\u3002\u4e8e\u662f\u6211\u4eec\u5c06\u5728\u6a21 $ p $ \u610f\u4e49\u4e0b\u540c\u4f59\u7684\u8fd9\u7c7b\u6570\u5f52\u5230\u4e00\u8d77\uff0c\u7136\u540e**\u7528\u4e00\u4e2a\u6570\u7ec4 $ g[i] $ \u8bb0\u5f55\u6a21 $ p $ \u610f\u4e49\u4e0b\u4e3a $ i $ \u7684\u5f62\u5982 $ 11111...111 $ \u7684\u6570\u7684\u4e2a\u6570**\u3002\uff08\u56e0\u4e3a $ p $ \u4e0d\u5927\uff0c\u6240\u4ee5\u4e0d\u7528\u679a\u4e3e\u591a\u4e45\u5c31\u80fd\u627e\u5230\u5faa\u73af\u8282\uff09\n\n\u4e8e\u662f\u9898\u76ee\u7684\u610f\u601d\u5c31\u88ab\u8f6c\u6362\u6210\uff1a\u4ece\u6240\u6709\u7684 $ g[i] $ \u4e2d\u627e\u51fa\uff08\u4e0d\u8d85\u8fc7\uff09\u4e5d\u4e2a\u6570\uff0c\u4f7f\u5f97\u5b83\u4eec\u7684**\u4e0b\u6807\u4e4b\u548c**\u80fd\u88ab $ p $ \u6574\u9664\uff01\uff08\u4e3a\u4ec0\u4e48\u662f\u4e0b\u6807\u4e4b\u548c\uff1f\u56e0\u4e3a\u4e0a\u9762\u8bf4\u4e86 $ g[i] $ \u4e2d\u6240\u6709\u7684\u5f62\u5982 $ 1111...111 $ \u7684\u6570\u5728\u6a21 $ p $ \u610f\u4e49\u4e0b\u4e3a $ i $ \uff01\uff09\n\n\u6240\u4ee5\u8fd9\u9053\u9898\u5c31\u53d8\u6210\u4e86\u4e00\u9053\u8ba1\u6570\u7c7bDP\uff0c\u6211\u4eec\u8bbe $ f[i][j][o] $ \u8868\u793a\uff1a**\u5df2\u7ecf\u9009\u5b8c\u4e86\u4e0b\u6807\u4e3a $ [0,i-1] $ \u7684\u6570\uff0c\u4ece\u4e2d\u9009\u4e86 $ o $ \u4e2a\u5f62\u5982 $ 1111...11 $ \u7684\u6570\uff0c\u5b83\u4eec\u7684\u548c\u6a21 $ p $ \u7b49\u4e8e $ j $ \u7684\u65b9\u6848\u6570**\u3002 \u8003\u8651\u5b83\u7684\u8f6c\u79fb\uff0c\u5982\u679c\u6211\u4eec\u8981\u4ece\u4e0b\u6807\u4e3a $ i $ \u7684\u6570\u91cc\u9009\u51fa $ k $ \u4e2a\u6570\uff0c\u663e\u7136\u8fd9 $ k $ \u4e2a\u6570\u662f\u53ef\u4ee5\u91cd\u590d\u7684\uff0c\u4ed6\u4eec\u7684\u8d21\u732e\u90fd\u4e3a $ i $ \uff0c\u6240\u4ee5\u76f8\u5f53\u6211\u4eec\u4ece $ g[i] $  \u4e2a\u6570\u91cc\u53ef\u91cd\u590d\u7684\u9009\u51fa $ k $ \u4e2a\u6570\uff08\u4e0d\u8bba\u600e\u4e48\u9009\u4ed6\u4eec\u7684\u548c\u90fd\u4e3a $ k*i $ \uff09\uff0c\u6839\u636e\u7ec4\u5408\u8ba1\u6570\u539f\u7406\u8fd9\u6837\u7684\u65b9\u6848\u6709 $ C_{g[i]+k-1}^{~~~~~k} $  \u79cd\u3002\u4e3a\u4e86\u65b9\u4fbf\u535a\u4e3b\u4ee3\u7801\u91cc\u4f1a\u7528 $ C[i][k] $ \u4ee3\u66ff $ C[~g[i]+k-1~][k] $ \u3002\n\n#### $ f[i+1][~(j+k*i)~mod~p~][o+k]=f[i][j][o]*C[i][k] $ \n\n\n\n------\n\n------\n\n\n\n## $ code: $ \n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<iomanip>\n#include<algorithm>\n#include<cstring>\n#include<cstdlib>\n#include<ctime>\n#include<cmath>\n#include<vector>\n#include<queue>\n#include<map>\n#include<set>\n\n#define ll long long\n#define db double\n#define rg register int\n\nusing namespace std;\n\nconst int mod=999911659; //\u7b54\u6848\u7684\u6a21\u6570\n\nll n;\nll g[505]; //\u8bb0\u5f55\u4f59\u6570\u4e3ai\u7684\u5f62\u598211111\u7684\u6570\u7684\u4e2a\u6570\nint p,vn,ans; //\u5faa\u73af\u8282\u957f\u5ea6\uff0c\u5c0f\u6a21\u6570\nint a[505]; //\u8bb0\u5f55\u4f59\u6570\u4e0a\u4e00\u6b21\u7684\u4f4d\u7f6e\uff08\u627e\u5faa\u73af\u8282\u7528\uff09\nint inv[11]; //\u9006\u5143\nint c[505][11]; //\u7ec4\u5408\u6570\nint f[505][505][11]; //\u8ba1\u6570\u7c7bDP\n\ninline int qr(){\n\tregister char ch; register bool sign=0; rg res=0;\n\twhile(!isdigit(ch=getchar()))if(ch=='-')sign=1;\n\twhile(isdigit(ch))res=res*10+(ch^48),ch=getchar();\n\tif(sign)return -res; else return res;\n}\n\nint main(){\n\t//freopen(\".in\",\"r\",stdin);\n\t//freopen(\".out\",\"w\",stdout);\n\tscanf(\"%lld%d\",&n,&p); inv[1]=1;\n\tif(n<=p) for(rg i=1;i<=n;++i) vn=(vn*10+1)%p,++g[vn];\n\telse{ rg tot=1%p,m,l;\n\t\tfor(rg i=1;i<=p+1;++i){\n\t\t\tif(a[tot]){ l=a[tot]; m=i-l; break;} //\u627e\u5230\u5faa\u73af\u8282\uff0c\u8ba1\u7b97\u5faa\u73af\u8282\u957f\u5ea6\n\t\t\ta[tot]=i; ++g[tot]; tot=(tot*10+1)%p; //\u8bb0\u5f55\u5f53\u524d\u4f59\u6570\u51fa\u73b0\u4f4d\u7f6e\uff0c\u7ee7\u7eed\u5bfb\u627e\n\t\t}\n\t\tfor(rg i=0;i<p;++i)\n\t\t\tif(a[i]&&a[i]>=l){\n\t\t\t\tg[i]+=(n-a[i])/m%mod; //\u8bb0\u5f55\u6240\u6709\u4f59\u6570\u4e3ai\u7684\u5f62\u598211111\u7684\u6570\u7684\u4e2a\u6570\n\t\t\t\tif((a[i]-l+1)%m==(n-l+1)%m) vn=i; //\u8bb0\u5f55\u957f\u5ea6\u4e3a n \u7684\u5f62\u59821111\u7684\u6570\u7684\u4f59\u6570\uff0c\u540e\u9762\u521d\u59cbDP\u65f6\u6709\u7528\n\t\t\t}\n\t}\n\tfor(rg i=2;i<9;++i) inv[i]=(ll)(mod-mod/i)*inv[mod%i]%mod; //\u7ebf\u6027\u9012\u63a8\u6c42\u9006\u5143\n\tfor(rg i=0;i<p;++i){ c[i][0]=1; if(!g[i])continue;\n\t\tfor(rg j=1;j<9;++j,g[i]=(g[i]+1)%mod) //\u6ce8\u610f\u6700\u540e\u8fd8\u6709\u4e2a++g[i]\uff01\uff01\uff01\n\t\t\tc[i][j]=(ll)c[i][j-1]*g[i]%mod*inv[j]%mod; //\u7528\u6027\u8d28\u6c42i\u8f83\u5927,j\u8f83\u5c0f\u7684\u9006\u5143\n\t}\n\tf[0][vn][0]=1; //\u6700\u5f00\u59cb\u6709\u4e00\u4e2a\u957f\u5ea6\u4e3an\u7684\u5f62\u59821111111111\u7684\u6570\n\tfor(rg i=0;i<p;++i)\n\t\tfor(rg j=0;j<p;++j)\n\t\t\tfor(rg o=0;o<9;++o)\n\t\t\t\tfor(rg k=0;k<9-o;++k) //\u679a\u4e3e\u53d6\u51fa\u591a\u5c11\u4e2a\u4f59\u6570\u4e3ai\u7684\u5f62\u5982\u768411111111\u7684\u6570\n\t\t\t\t\t(f[i+1][(j+k*i)%p][k+o]+=(ll)f[i][j][o]*c[i][k]%mod)%=mod;\n\tfor(rg i=0;i<9;++i) ans=(ans+f[p][0][i])%mod; //\u8ba1\u7b97\u7b54\u6848\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n\n```",
        "postTime": 1564839402,
        "uid": 111334,
        "name": "\u706f\u82af\u7cd5",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2481 \u3010[SDOI2010]\u4ee3\u7801\u62cd\u5356\u4f1a\u3011"
    },
    {
        "content": "$flag\\times 1$\uff1a\u8fd9\u4e0d\u662fSB\u9898\u5417\uff0c\u968f\u4fbf\u4e00\u4e2a\u6570\u4f4dDP\u5c31\u884c\u4e86\n\n\u8fd9\u4e2a\u62c6\u5206\u7684$trick$\u597d\u5999\u554a\n\n$flag\\times 2$\uff1a\u8fd9\u4e2a\u4e0d\u5c31\u662f\u7b80\u5355\u7684\u80cc\u5305\u5417\n\n\u600e\u4e48\u91cd\u590d\u8ba1\u7b97\u4e86\u5440\uff01\n\n-----\u4ee5\u4e0a\u4e3a\u4e2a\u4eba\u5410\u69fd-------\n\n\u9898\u610f\uff1a\u6c42$n$\u4f4d\u7684\u6570\u5b57\u4e2d\uff0c\u6709\u591a\u5c11\u4e2a\u6570\u5b57\u6ee1\u8db3\u5355\u8c03\u4e0d\u51cf\u4e14\u80fd\u591f\u88ab$p$\u6574\u9664\n\n$n\\leq 10^{18}\\quad p\\leq 500$\n\n\u56e0\u4e3a\u8981\u6570\u4f4d\u5355\u8c03\u4e0d\u51cf\uff0c\u90a3\u4e48\u53ef\u4ee5\u628a\u4e00\u4e2a\u6570\u5b57\u62c6\u5206\u6210\u4e00\u5927\u5806\u540e\u7f00$1$\u76f8\u52a0\u800c\u6210\n\n\u8981\u4f7f\u6574\u4e2a\u6570\u5b57\u53ef\u4ee5\u88ab$p$\u6574\u9664\uff0c\u4e5f\u5c31\u662f\u8fd9\u4e9b\u540e\u7f00$1$\u76f8\u52a0\u80fd\u591f\u88ab$p$\u6574\u9664\n\n\u5230\u8fd9\u91cc\u5c31\u6709\u4e00\u4e2a\u5927\u81f4\u7684\u601d\u8def\u4e86\uff0c\u9996\u5148\u8ba1\u7b97\u51fa\u5728\u6a21$p$\u610f\u4e49\u4e0b\u7684\u6bcf\u4e00\u4e2a\u4f59\u6570\u6709\u591a\u5c11\u4e2a\u540e\u7f00$1$\uff0c\u7136\u540e\u8ba1\u7b97\u628a\u8fd9\u4e9b\u540e\u7f00$1$\u62fc\u63a5\u8d77\u6765\u7684\u65b9\u6848\u6570\n\n- \u8ba1\u7b97\u540e\u7f00$1$\u7684\u4e2a\u6570\n\n\u4e0d\u59a8\u8bbe$g[i]$\u8868\u793a\u6a21$p$\u4e3a$i$\u7684\u540e\u7f00$1$\u4e2a\u6570\n\n\u60f3\u50cf\u4e00\u4e0b\u8fd9\u4e2a\u8fc7\u7a0b\u5c31\u884c\u4e86\uff1a\n\n\u4e00\u5f00\u59cb\u4e3a$0$\uff0c\u7136\u540e\u4e0d\u65ad\u5f80\u5de6\u8fb9\u63d2\u5165\u4e00\u4e2a$1$\uff0c\u8fd9\u4e2a\u4f59\u6570\u4e5f\u4e0d\u65ad\u5728\u53d8\u5316\n\n\u5f53\u67d0\u4e2a\u4f59\u6570\u5728\u524d\u9762\u51fa\u73b0\u8fc7\u65f6\uff0c\u540e\u9762\u7684\u5c31\u548c\u524d\u9762\u7684\u4e00\u6837\u4e86\uff0c\u4e5f\u5c31\u662f\u6709\u5faa\u73af\u8282\u4e86\n\n\u6240\u4ee5\u76f4\u63a5\u626b\u4e00\u904d\u627e\u5230\u5faa\u73af\u8282\uff0c\u7d2f\u52a0\u7b54\u6848\u5c31\u884c\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$O(p)$\n\n```cpp\nmemset(vis,-1,sizeof(vis)),vis[0]=0;\nfor(int i=1;i<=p;i++)\n{\n\t(now=now*10+1)%=p;\n\tif(vis[now]==-1) vis[now]=i,g[now]++;\n\telse{ pos=i; break; }\n}\nif(pos)\n{\n\tint len=pos-vis[now],maxn;\n\tll rest=n-(pos-1),cnt;\n\tcnt=rest/len,maxn=rest%len;\n\tfor(int i=pos;i<=pos+len-1;i++)\n\t{\n\t\tg[now]+=cnt+(i-pos+1<=maxn);\n\t\t(now=now*10+1)%=p;\n\t}\n}\n```\n\n- \u8ba1\u7b97\u62fc\u63a5\u65b9\u6848\n\n\u8ba1\u7b97\u5b8c$g[i]$\u540e\uff0c\u8981\u628a\u8fd9\u4e9b\u540e\u7f00\u62fc\u63a5\u8d77\u6765\uff0c\u8981\u6ee1\u8db3\u7684\u9650\u5236\u6709\u4e09\u4e2a\uff1a\n\n1.  \u6700\u540e\u957f\u5ea6\u4e3a$n$\n\n2. \u52a0\u8d77\u6765\u6a21$p$\u4e3a$0$\n\n3. \u6bcf\u4e00\u4f4d\u4e0d\u8d85\u8fc7$9$\uff08\u975e\u5e38\u5bb9\u6613\u5ffd\u7565\u7684\u9650\u5236\uff09\n\n\u9996\u5148\u53ef\u4ee5\u5f88\u5bb9\u6613\u5148\u53bb\u6389\u7b2c\u4e00\u4e2a\u9650\u5236\uff0c\u56e0\u4e3a\u957f\u5ea6\u4e3a$n$\uff0c\u6240\u4ee5\u6700\u9ad8\u4f4d\u80af\u5b9a\u8981\u653e\u4e00\u4e2a\uff0c\u8fd9\u6837\u5c31\u628a\u7b2c\u4e00\u4e2a\u9650\u5236\u53bb\u6389\u4e86\uff0c\u4e0d\u59a8\u8bbe\u6700\u9ad8\u4f4d\u7684\u540e\u7f00$1$\u6a21$p$\u4e3a$q_1$\n\n\u90a3\u4e48\u95ee\u9898\u5c31\u8f6c\u53d8\u4e3a\uff0c\u5728\u4e00\u5806\u540e\u7f00$1$\u4e2d\u9009\u6700\u591a$8$\u4e2a\uff0c\u5e76\u4e14\u52a0\u8d77\u6765\u6a21$p$\u4e3a$p-q1$\u7684\u65b9\u6848\u6570\n\n\u8fd9\u6837\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a\u5f88\u7b80\u5355\u7684\u95ee\u9898\u4e86\uff0c\u76f4\u63a5\u505a\u4e2a\u80cc\u5305\u5c31\u884c\u4e86\n\n\u8bbe$f[i][j]$\u8868\u793a\u9009\u4e86$i$\u4e2a\u540e\u7f00\uff0c\u4e14\u52a0\u8d77\u6765\u6a21\u6570\u4e3a$j$\u7684\u65b9\u6848\u6570\n\n$f[i+1][j+k]+=f[i][j]\\times g[k]$\n\n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\uff1f\uff1f\uff1f\u8fd9\u6837\u8ba1\u7b97\u662f\u4f1a\u91cd\u590d\u8ba1\u7b97\u7684\uff01\n\n\u8fd9\u6837\u8ba1\u7b97\u5b9e\u9645\u4e0a\u662f\u8ba1\u7b97\u51fa\u4e86\u4e00\u4e2a\u201c\u6392\u5217\u201d\uff0c\u4e5f\u5c31\u662f\u6bcf\u4e2a\u540e\u7f00$1$\u5148\u540e\u653e\u8fdb\u6765\u7684\u987a\u5e8f\u5bf9\u7b54\u6848\u662f\u4f1a\u6709\u5f71\u54cd\u7684\n\n\u4f46\u5b9e\u9645\u4e0a\u6211\u4eec\u9700\u8981\u7684\u7b54\u6848\u662f\u4e00\u4e2a\u201c\u7ec4\u5408\u201d\n\n\u601d\u8003\u91cd\u590d\u8ba1\u7b97\u4e86\u54ea\u4e9b\u90e8\u5206\uff1f\u5373\u5bf9\u4e8e\u6a21$p$\u76f8\u540c\u7684\uff0c\u4e0a\u9762\u7684\u8ba1\u7b97\u8fc7\u7a0b\u8003\u8651\u5b83\u4eec\u7684\u987a\u5e8f\u95ee\u9898\n\n\u65e2\u7136\u5982\u6b64\uff0c\u90a3\u5c31\u5f3a\u5236\u6309\u7167\u4e00\u4e2a\u4e00\u4e2a\u4f59\u6570\u6765\u8f6c\u79fb\uff0c\u6bcf\u4e2a\u4f59\u6570\u5185\u90e8\u76f4\u63a5\u7b97\n\n\u8bbe$f[i][j][k]$\u8868\u793a\u8003\u8651\u4e86\u524d$i$\u4e2a\u4f59\u6570\uff0c\u9009\u4e86$j$\u4e2a\uff0c\u52a0\u8d77\u6765\u6a21$p$\u4e3a$k$\u7684\u65b9\u6848\u6570\n\n\u8f6c\u79fb\u7684\u65f6\u5019\uff0c\u679a\u4e3e\u5f53\u524d\u8fd9\u4e2a\u4f59\u6570\u9009\u4e86\u591a\u5c11\u4e2a\u6765\u8f6c\u79fb\u5c31\u597d\u4e86\n\n\u6ce8\u610f\u5728\u540c\u4e00\u4e2a\u4f59\u6570\u4e2d\uff0c\u662f\u6709$g[i]$\u4e2d\u540e\u7f00$1$\uff0c\u6bcf\u79cd\u540e\u7f00$1$\u662f\u6709\u65e0\u6570\u4e2a\uff08\u5373\u6ca1\u6709\u4e2a\u6570\u4e0a\u9650\uff09\u7684\n\n\u6240\u4ee5\u5185\u90e8\u8f6c\u79fb\u7684\u65b9\u6848\u6570\u5e94\u8be5\u662f\uff1a$\\displaystyle \\binom{g[i]+t-1}{t}$\n\n\u56e0\u4e3a$g$\u5f88\u5927\uff0c\u6240\u4ee5\u8fd9\u4e2a\u7ec4\u5408\u6570\u76f4\u63a5\u5957\u5b9a\u4e49\u6765\u7b97\u5c31\u597d\u4e86\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(9^2p^2)$\n\n\u6ce8\u610f\u7279\u5224$p=1$\u7684\u6076\u5fc3\u60c5\u51b5\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <string>\n#define ll long long\nusing namespace std;\nconst ll mod=999911659;\nconst int N=510;\nint vis[N];\nll inv[10],g[N],f[N][10][N];\ninline ll C(ll x,ll y)\n{\n\tll ans=1;\n\tfor(ll i=x-y+1;i<=x;i++) ans=ans*i%mod;\n\tfor(ll i=1;i<=y;i++) ans=ans*inv[i]%mod;\n\treturn ans;\n}\nint main()\n{\n\tinv[1]=1; for(int i=2;i<=8;i++) inv[i]=(mod-mod/i)*inv[mod%i]%mod;\n\tint p,now=0,pos=0,q1; ll n,ans=0;\n\tscanf(\"%lld%d\",&n,&p);\n\tmemset(vis,-1,sizeof(vis)),vis[0]=0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tnow=(now*10+1)%p;\n\t\tif(vis[now]==-1) vis[now]=i,g[now]++;\n\t\telse{ pos=i; break; }\n\t}\n\tif(pos)\n\t{\n\t\tint len=pos-vis[now],maxn;\n\t\tll rest=n-(pos-1),cnt;\n\t\tcnt=rest/len,maxn=rest%len;\n\t\tfor(int i=pos;i<=pos+len-1;i++)\n\t\t{\n\t\t\tif((i-pos+1)%len==maxn) q1=now;\n\t\t\t(g[now]+=cnt+(i-pos+1<=maxn))%=mod;\n\t\t\tnow=(now*10+1)%p;\n\t\t}\n\t}\n\tf[0][0][0]=1;//\u53d6\u7b2ci+1\u4e2a\u4f59\u6570\uff0c\u5373i \n\tfor(int i=0;i<p;i++)\n\t\tfor(int j=0;j<=8;j++)\n\t\t\tfor(int k=0;k<p;k++)\n\t\t\t\tfor(int t=0;t<=8-j;t++)\n\t\t\t\t\t(f[i+1][j+t][(k+(t*i))%p]+=f[i][j][k]*C(g[i]+t-1,t)%mod)%=mod;\n\tfor(int i=0;i<=8;i++)\n\t\tans=(ans+f[p][i][p==1?0:p-q1])%mod;\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1603336752,
        "uid": 81238,
        "name": "MCAdam",
        "ccfLevel": 7,
        "title": "P2481 [SDOI2010]\u4ee3\u7801\u62cd\u5356\u4f1a"
    },
    {
        "content": "\u6253\u5e7f\u544a->[\u8fd9\u91cc](https://www.cnblogs.com/bztMinamoto/p/9542722.html)\n\n\u3000\u3000\u8fd9\u9898\u592a\u795e\u4ed9\u4e86\u2026\u2026\u9898\u89e3\u770b\u90fd\u770b\u4e0d\u61c2\u2026\u2026\u6700\u540e\u57fa\u672c\u53ea\u80fd\u786c\u751f\u751f\u7684\u7406\u89e3\u4e86\u2026\u2026\n\n\u3000\u3000\u9996\u5148\uff0c\u6211\u4eec\u8003\u8651\u6570\u5217\uff0c\u539f\u6570\u5217\u662f\u4e00\u4e2a\u4e0d\u964d\u7684\u5e8f\u5217\n\n\u3000\u3000\u8003\u8651\u5982\u4e0b\u6570\u5217\uff0c$1,1,2,3,4$\n\n\u3000\u3000\u8fd9\u6837\u6211\u4eec\u662f\u76f8\u5f53\u4e8e\u7ad6\u7740\u5206\u5272\u7684\n\n\u3000\u3000\u90a3\u4e48\u600e\u4e48\u8f6c\u6362\u4e3a\u6a2a\u7740\u5206\u5272\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u8bb0\u5f55\u5927\u4e8e\u7b49\u4e8e$1$\u7684\u6570\u7684\u4e2a\u6570\uff0c\u4e3a$5$\uff0c\u5927\u4e8e\u7b49\u4e8e$2$\u7684\u6570\u7684\u4e2a\u6570\uff0c\u4e3a$3$\u2026\u2026\n\n\u3000\u3000\u90a3\u4e48\u6700\u540e\u539f\u6570\u5217\u53ef\u4ee5\u8f6c\u5316\u4e3a$11111,111,11,1$\uff08\u6bcf\u4e2a\u6570\u7528\u76f8\u540c\u4e2a\u6570\u7684$1$\u8868\u793a\uff09\uff0c\u7136\u540e\u6211\u4eec\u60ca\u5947\u7684\u53d1\u73b0\u4ed6\u4eec\u7684\u548c\u548c\u539f\u6765\u7684$n$\u4f4d\u6570\u662f\u4e00\u6837\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4ed6\u4eec\u6784\u6210\u7684\u6574\u6570\u53d6\u6a21\u4e4b\u540e\u4e5f\u662f\u4e00\u6837\u7684\uff01\n\n\u3000\u3000\u8fd9\u5c31\u76f8\u5f53\u4e8e\u5728\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\u653e\u76f8\u5f53\u4e8e\u6743\u503c\u5927\u5c0f\u7684\u77f3\u5934\uff0c\u6211\u4eec\u4e00\u5f00\u59cb\u662f\u7ad6\u7740\u5206\uff0c\u800c\u7b2c\u4e8c\u79cd\u65b9\u6cd5\u662f\u6a2a\u7740\u5206\u5272\n\n\u3000\u3000\u5982\u679c\u7ad6\u7740\u5206\u5272\uff0c\u603b\u5171\u6709$n$\u4e2a\u6570\uff0c\u5982\u679c\u6a2a\u7740\u5272\uff0c\u628a\u6240\u6709\u6a21$p$\u540c\u4f59\u7684\u770b\u6210\u4e00\u7c7b\uff0c\u90a3\u4e48\u603b\u5171\u53ea\u6709$p$\u4e2a\u6570\uff08\u56e0\u4e3a0,1,11,111\u8fd9\u6837\u4e0b\u53bb\u6a21$p$\u7684\u503c\u80af\u5b9a\u80fd\u6784\u6210\u4e00\u4e2a\u5faa\u73af\u8282\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u8ba1\u7b97$p$\u6b21\uff0c\u5269\u4e0b\u7684\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97\uff09\n\n\u3000\u3000\u90a3\u4e48\u6211\u4eec\u4e3a\u4ec0\u4e48\u4e0d\u8f6c\u5316\u4e3a\u6a2a\u7740\u5206\u5272\u5462\uff1f\u8bbe$cnt[i]$\u8868\u793a\u6a21$p$\u4e3a$i$\u7684\u6570\u7684\u4e2a\u6570\uff0c\u90a3\u4e48\u9898\u76ee\u5c31\u53d8\u6210\u4ece$cnt[i]$\u4e2d\u53d6$9$\u4e2a\u4f7f\u4e0b\u6807\u4e4b\u548c\u88ab$p$\u6574\u9664\n\n\u3000\u3000\u90a3\u4e48\u5c31\u53ef\u4ee5\u8f6c\u5316\u4e3adp\u4e86\uff0c\u8bbe$f[i][j][k]$\u8868\u793a\u8003\u8651\u5230\u7b2c$i$\u4e2a\u6570\uff0c\u9009\u4e86$k$\u4e2a\uff0c\u4ed6\u4eec\u7684\u548c\u6a21$p$\u4e3a$j$\uff0c\u90a3\u4e48\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5c31\u662f$f[i+1][(j+l*i)\\%mod][k+l]=(f[i][j][k]*C_{cnt_i}^l+f[i+1][(j+l*i)\\%mod][k+l])\\%mod$\n\n\u3000\u3000\u7136\u540e\u8981\u5148\u8003\u8651\u52a0\u4e0a\u4e00\u4e2a$11111$\uff08$n$\u4e2a$1$\uff09\uff0c\u56e0\u4e3a\u6211\u4eecdp\u7684\u65f6\u5019\u662f\u5141\u8bb8\u6709\u524d\u5bfc$0$\u7684\uff0c\u6240\u4ee5\u5f97\u5148\u5f3a\u5236\u81f3\u5c11\u4e3a$1$\u624d\u884c\n\n\u3000\u3000\u7ec6\u8282\u6709\u70b9\u591a\uff0c\u90fd\u5199\u5728\u6ce8\u89e3\u91cc\u4e86\n  \n```\n//minamoto\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define ll long long\nusing namespace std;\nconst int mod=999911659;\nll ans,n,p,cnt[505],beg,len,pos[505],A[11],c[505][11],f[505][505][11],a;\nint main(){\n\tscanf(\"%lld%d\",&n,&p);\n\tll sum=0;\n\tif(n<=p){\n\t\t//\u76f4\u63a5\u628a\u5faa\u73af\u8282\u8dd1\u51fa\u6765 \n\t\tfor(int i=1;i<=n;++i) sum=(sum*10+1)%p,++cnt[sum];\n\t\ta=sum;\n\t}else{\n\t\t//\u5426\u5219\u53bb\u627e\u5faa\u73af\u8282\uff0c\u6570\u51fa\u6bcf\u4e00\u4e2a\u4f59\u6570\u7684\u51fa\u73b0\u6b21\u6570 \n\t\tfor(int i=1;i<=p+1;++i){\n\t\t\tsum=(sum*10+1)%p;\n\t\t\tif(cnt[sum]){\n\t\t\t\tbeg=pos[sum],len=i-pos[sum];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t++cnt[sum],pos[sum]=i;\n\t\t}\n\t\tfor(int i=0;i<p;++i)\n\t\tif(cnt[i]&&pos[i]>=beg){\n\t\t\tcnt[i]=(n-beg+1)/len;\n\t\t\tif(pos[i]-beg+1<=(n-beg+1)%len) ++cnt[i];\n\t\t\tif((pos[i]-beg+1)%len==(n-beg+1)%len) a=i;\n\t\t}\n\t}\n\tA[1]=1,A[0]=0;\n\tfor(int i=2;i<=8;++i)\n\tA[i]=(mod-mod/i)*A[mod%i]%mod;\n\tfor(int i=0;i<p;++i){\n\t\tc[i][0]=1;\n\t\tif(cnt[i])\n\t\tfor(int j=1;j<=8;++j){\n\t\t\tc[i][j]=cnt[i]*c[i][j-1]%mod*A[j]%mod;\n\t\t\tcnt[i]=(cnt[i]+1)%mod;\n\t\t\t//C(n,m-1)->C(n,m)\n\t\t\t//C(n,m-1)/m*(n-m+1)=C(n,m)\n\t\t\t//cnt[i]=n-m+1\n\t\t}\n\t}\n\tf[0][a][0]=1;\n\t//\u9ed8\u8ba4\u52a0n\u4e2a1\uff0c\u56e0\u4e3adp\u7684\u65f6\u5019\u53ef\u4ee5\u6709\u524d\u7f000 \n\tfor(int i=0;i<p;++i)\n\tfor(int j=0;j<p;++j)\n\tfor(int k=0;k<9;++k)\n\tfor(int l=0;l<=k;++l)\n\t(f[i+1][j][k]+=f[i][(j-(l*i%p)+p)%p][k-l]*c[i][l]%mod)%mod;\n\tfor(int i=0;i<=8;++i) (ans+=f[p][0][i])%=mod;\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1535356809,
        "uid": 41781,
        "name": "bztMinamoto",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2481 \u3010[SDOI2010]\u4ee3\u7801\u62cd\u5356\u4f1a\u3011"
    },
    {
        "content": "\u770b\u4e0a\u53bb\u662f\u4e00\u4e2a\u663e\u7136\u7684\u6570\u4f4d dp \uff0c\u4f46\u662f\u770b\u5230 $N\\le 10^{18}$ \u7684\u6570\u636e\u8303\u56f4\u5c31\u53d1\u73b0\u4e0d\u662f\u90a3\u4e48\u5bb9\u6613\u4e86\u3002\n\n\u672c\u9898\u7684\u601d\u8def\u6700\u5de8\u4e4b\u5904\u5c31\u5728\u4e8e\uff1a\n\n**\u5c06 1111111...222222...333333...44444...5555... \u5f0f\u7684\u6570\u62c6\u6210\u4e0d\u5230 9 \u4e2a\u5f62\u5982 11111111111 \u7684\u6570\u4e4b\u548c\uff0c\u5e76\u4e14\u81f3\u5c11\u8981\u6709\u4e00\u4e2a 111111111111111111111111111...111( N \u4e2a 1 ) \u3002**\n\n\u53c8\u7531\u4e8e $11111111111111111...111$ \u5f62\u5f0f\u7684\u6570\u5bf9 $P$ \u53d6\u6a21\u7684\u503c\u968f $1$ \u7684\u4e2a\u6570\u6ee1\u8db3\u5468\u671f\u6027\u53d8\u5316\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a\u6570\u7ec4 $cnt[]$ \uff0c\u50a8\u5b58\uff1a\n\n$cnt[i]$ \u8868\u793a $111111111111111111...11111$ \uff08 $1\\le1$ \u7684\u4e2a\u6570 $\\le N$\uff09\u5f62\u5f0f\u7684\u6570\u6709\u591a\u5c11\u4e2a\u3002\u53ef\u4ee5\u5229\u7528\u5468\u671f\u6027\u9884\u5904\u7406\u51fa\u3002\n\n\u4ece\u5c0f\u5230\u5927\u8003\u8651 $11111111111111111...11$ \u5f62\u5f0f\u7684\u6570\uff0c\u53ef\u4ee5 dp \u8fa3\uff01\n\n$f[i][j][k]$ \u8868\u793a\u8003\u8651\u5230 $cnt[i]$ \uff0c \u4f7f\u7528 $k$ \u4e2a $11111...111$ \u5f62\u5f0f\u7684\u6570\uff0c\u5b83\u4eec\u4e4b\u548c\u6a21 $P$ \u7684\u503c\u4e3a $j$ \u7684\u65b9\u6848\u6570\n\n\uff08\u6ce8\u610f $k$ \u7684\u4e0a\u754c\u662f $8$ \u4e0d\u662f $9$ \uff0c\u6700\u540e\u6211\u4eec\u8fd8\u8981\u52a0\u4e0a $111111111111111...111$ \uff08 $N$ \u4e2a $1$\uff09\uff09\n\n\u524d\u7f6e\u516c\u5f0f\uff1a $n$ \u79cd\u5143\u7d20\uff0c\u6bcf\u79cd\u5143\u7d20\u6709\u65e0\u7a77\u591a\u4e2a\uff0c\u4ece\u4e2d\u53d6\u51fa $m$ \u4e2a\u5143\u7d20\u7684\u4e0d\u540c\u65b9\u6848\u6570\u4e3a $\\binom{n+m-1}m$ \u3002\n\n\u8fb9\u754c\uff1a\n\n$$f[0][0][k]=\\binom{cnt[0]+k-1}k$$\n\n\u6ce8\u610f\u5230 $cnt$ \u7684\u503c\u5f88\u5927\u4f46 $k$ \u7684\u503c\u5f88\u5c0f\uff0c\u7ec4\u5408\u6570\u53ef\u4ee5\u9884\u5904\u7406\u3002\n\n\u679a\u4e3e\u4f7f\u7528\u7684\u6a21 $P$ \u4e3a $i$ \u7684 $1111111111111111111...111$ \u7684\u4e2a\u6570 $h$ \uff08 $0\\le h\\le k$ \uff09 \uff0c\u5c31\u80fd\u5b9e\u73b0\u8f6c\u79fb\u3002\n\n$$f[i][j][k]=\\sum_{h=0}^k\\binom{cnt[i]+h-1}hf[i-1][(j-ih\\bmod P+P)\\bmod P][k-h]$$\n\n\u7b54\u6848\uff1a\n\n$$\\sum_{k=0}^8f[P-1][(P-(111...111(N\u4e2a1)))\\bmod P][k]$$\n\n\u8fd9\u79cd\u62c6\u5206\u6210 $111111111111111111111111111111111111...111$ \u7684\u601d\u8def\u771f\u7684\u5f88\u96be\u60f3\u5230\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\n#define For(i, a, b) for (i = a; i <= b; i++)\n#define Rof(i, a, b) for (i = a; i >= b; i--)\ntypedef long long ll; using namespace std;\nconst int N = 505, M = 1e5 + 5, E = 11, PYZ = 999911659;\nint CYX, b[M], f[N][N][E], dalao, orz[N], fac[N], inv[N], otz[N][N];\nll n, cnt[N];\nint qpow(int a, int b) {\n\tint res = 1; while (b)  b & 1 ? res = 1ll * res * a % PYZ : 0,\n\t\ta = 1ll * a * a % PYZ, b >>= 1; return res;\n}\nint main() {\n\tint i, j, k, h, rep, len, gap, ans = 0;\n\tcin >> n >> CYX; For (i, 1, 2147483647) {\n\t\tb[i] = (b[i - 1] * 10 + 1) % CYX;\n\t\tif (orz[b[i]]) {rep = orz[b[i]]; len = i; break;}\n\t\torz[b[i]] = i;\n\t}\n\tFor (i, 1, min(1ll * rep - 1, n)) cnt[b[i]]++;\n\tgap = len - rep; if (rep <= n) For (i, rep, len - 1) {\n\t\tcnt[b[i]] += (n / gap + (i % gap <= n % gap))\n\t\t\t- ((rep - 1) / gap + (i % gap <= (rep - 1) % gap));\n\t\tif (n % gap == i % gap) dalao = b[i];\n\t}\n\tfac[0] = 1; For (i, 1, 20) fac[i] = 1ll * fac[i - 1] * i % PYZ;\n\tinv[20] = qpow(fac[20], PYZ - 2); Rof (i, 19, 0)\n\t\tinv[i] = 1ll * inv[i + 1] * (i + 1) % PYZ;\n\tFor (i, 0, CYX - 1) {\n\t\tif (!cnt[i]) {\n\t\t\totz[i][0] = 1; For (j, 1, 20) otz[i][j] = 0; continue;\n\t\t}\n\t\totz[i][0] = 1; For (j, 1, 20) otz[i][j] = 1ll * otz[i][j - 1]\n\t\t\t* ((cnt[i] + j - 1) % PYZ) % PYZ;\n\t\tFor (j, 1, 20) otz[i][j] = 1ll * otz[i][j] * inv[j] % PYZ;\n\t}\n\tFor (i, 0, 8) f[0][0][i] = otz[0][i];\n\tFor (i, 1, CYX - 1) For (j, 0, CYX - 1) For (k, 0, 8) For (h, 0, k)\n\t\tf[i][j][k] = (f[i][j][k] + 1ll * f[i - 1]\n\t\t\t[(j - i * h % CYX + CYX) % CYX][k - h] * otz[i][h] % PYZ) % PYZ;\n\tFor (i, 0, 8) ans = (ans + f[CYX - 1][(CYX - dalao) % CYX][i]) % PYZ;\n\tcout << ans << endl; return 0;\n}\n```",
        "postTime": 1531700976,
        "uid": 29936,
        "name": "xyz32768",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2481 \u3010[SDOI2010]\u4ee3\u7801\u62cd\u5356\u4f1a\u3011"
    },
    {
        "content": "\u5176\u5b9e\u611f\u89c9\u8fd9\u9898\u6b63\u89e3\u4e0d\u592a\u7b97\u6570\u4f4d dp\uff08\u4eceUltiMadow \u7684\u9898\u5355\u6765\u5230\u8fd9\u91ccqaq\uff09...\u6bd5\u7adf\u6ca1\u6709\u7ecf\u5178\u7684\u6309\u6570\u4f4d\u7edf\u8ba1\u7b54\u6848\u7684\u90e8\u5206\uff0c\u751a\u81f3\u4e5f\u548c\u6570\u4f4d\u642d\u4e0d\u4e0a\u8fb9\u3002\u4e0d\u8fc7\u5982\u679c\u8003\u8651\u90e8\u5206\u5206\u7684\u8bdd\u8fd8\u662f\u6709\u6570\u4f4d dp \u6210\u5206\u7684X\n\n## \u89e3\u6790\n\n\u5982\u679c $n$ \u8f83\u5c0f\uff0c\u5176\u5b9e\u6709\u4e00\u79cd\u5f88\u7b80\u5355\u6570\u4f4d dp \u601d\u8def\uff1a\u8bbe $dp(i, k, r)$ \u4e3a\u653e\u5230\u7b2c $i$ \u4e3a\uff0c\u8be5\u4f4d\u4e3a $k$\uff0c\u5df2\u653e\u7684\u6570\u4f4d\u5e26\u6743\uff08\u6570\u4f4d\u6743\uff0c\u4f8b\u5982\u4ece\u4f4e\u5230\u9ad8\u7b2c $1$ \u4f4d\u5e26\u6743 $10^0$\uff09\u548c\u6a21 $p$ \u7684\u4f59\u6570\uff1b\u518d\u9884\u5904\u7406\u4e0b\u6570\u4f4d\u6743\u6a21 $p$ \u7684\u503c\uff08\u56e0\u4e3a\u662f\u4f1a\u5faa\u73af\u7684\uff09\uff0c\u5c31\u53ef\u4ee5\u505a\u5230 $O(1)$ \u8f6c\u79fb\uff1b\u603b\u590d\u6742\u5ea6 $O(n)$\n\n\u7136\u800c $n\\leq 10^{18}$\uff0c\u663e\u7136\u4e0d\u80fd\u8fd9\u6837\u505a\n\n&nbsp;\n\n\u9996\u5148\u8981\u60f3\u51fa\u4e00\u4e2a\u5bf9\u8fd9\u9898\u5f88\u91cd\u8981\u7684\u63a8\u8bba\uff08\u8fd9\u4e2a\u65b9\u5411\u60f3\u5bf9\u4e86\u8fd9\u9898\u5c31\u505a\u51fa\u4e00\u534a\u4e86\uff09\n\n\u5148\u8bbe $f(x)=\\sum\\limits_{i=0}^{x-1}10^i$\u3002$f(x)$ \u7684\u503c\u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u4e2a\u957f\u5ea6\u4e3a $x$\uff0c\u5404\u6570\u4f4d\u90fd\u662f $1$ \u7684\u6570\u5b57\n\n\u8003\u8651\u8fd9\u6837\u4e00\u4e2a\u6570\u5b57\uff1a\u5b83\u7531 $f(n)$ \u548c\u4e0d\u8d85\u8fc7\u516b\u4e2a\u7684 $f(x), 0\\leq x\\leq n$ \u76f8\u52a0\u800c\u5f97\n\n\u5f88\u663e\u7136\u4e0d\u8d85\u8fc7\u516b\u4e2a\u662f\u4e3a\u4e86\u907f\u514d\u8fdb\u4f4d\u3002\u53ea\u8981 yy \u4e00\u4e0b\u5c31\u53ef\u4ee5\u53d1\u73b0\u8fd9\u6837\u7684\u6570\u5b57\u662f\u4e00\u5b9a\u7b26\u5408\u9898\u76ee\u8981\u6c42\u7684\uff08\u8bc1\u660e\u5e94\u8be5\u53ef\u4ee5\u8003\u8651\u5f52\u7eb3X\uff09\n\n\u63a5\u7740\u6211\u4eec\u53c8\u6709\u4e00\u4e2a\u5f88\u663e\u7136\u7684\u9012\u63a8\u5f0f\uff1a$f(x)=10\\cdot f(x-1)+1$\uff08\u601d\u8003\u4e0b $f(x)$ \u7684\u5b9a\u4e49\u5f88\u5feb\u5c31\u80fd\u63a8\u51fa\u6765\u4e86\uff09\n\n\u7531\u4e8e\u6211\u4eec\u53ea\u5173\u5fc3\u6700\u540e\u7684\u548c\u80fd\u5426\u88ab $p$ \u6574\u9664\uff0c\u4e8e\u662f\u76f8\u52a0\u7684\u6bcf\u4e2a $f(x)$ \u5728\u76f8\u52a0\u524d\u90fd\u53ef\u4ee5\u5148\u6a21 $p$\uff0c\u521a\u624d\u90a3\u4e2a\u9012\u63a8\u5f0f\u4e5f\u53ef\u4ee5\u5728**\u6a21\u610f\u4e49\u4e0b**\u8fdb\u884c\uff1b\u800c\u8be5\u9012\u63a8\u5f0f\u7684\u540e\u4e00\u9879\u53ea\u53d6\u51b3\u4e8e\u524d\u4e00\u9879\uff0c\u4e8e\u662f\u4e00\u65e6\u5b83\u5728\u67d0\u4e00\u523b\u53d6\u503c\u91cd\u590d\uff0c\u63a5\u4e0b\u6765\u7684\u53d6\u503c\u5c31\u4f1a\u9677\u5165**\u5faa\u73af**\u3002\u663e\u7136\u6700\u591a\u5728\u9012\u63a8 $p$ \u6b21\u540e\u5b83\u4e00\u5b9a\u5c31\u4f1a\u53d6\u503c\u91cd\u590d\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u66b4\u529b\u6a21\u62df\u5730\u627e\u5faa\u73af\u8282\u3002\u627e\u5230\u5faa\u73af\u8282\u540e\uff0c\u6211\u4eec\u5c31\u80fd\u9884\u5904\u7406\u51fa\u6a21 $p$ \u4e3a $r, 0\\leq r < p$ \u7684 $f(x)$ \u7684\u6570\u91cf\n\n\u8fd9\u6837\uff0c\u9898\u76ee\u5c31\u88ab\u8f6c\u5316\u4e3a\uff1a\u4ece\u503c\u4e3a $[0, p-1]$ \u7684\u4e00\u4e9b\u5143\u7d20\u4e2d\u53d6 $9$ \u4e2a\u5143\u7d20\uff0c\u6709\u4e00\u4e2a\u6307\u5b9a\u7684\u5143\u7d20\u5fc5\u987b\u53d6\uff08$f(n)$\uff09\uff0c\u4e14\u8981\u6c42\u53d6\u7684\u5143\u7d20\u7684\u503c\u7684\u548c\u6a21 $p$ \u4e3a $0$\uff0c\u95ee\u6709\u591a\u5c11\u79cd\u65b9\u6848\n\n&nbsp;\n\n\u63a5\u4e0b\u6765\u518d\u8003\u8651\u5982\u4f55\u89e3\u51b3\u8f6c\u5316\u540e\u7684\u95ee\u9898\n\n\u5176\u4e2d\u6307\u5b9a\u53d6\u7684\u5143\u7d20\u5176\u5b9e\u662f\u4e0d\u7528\u7ba1\u7684\uff1b\u6211\u4eec\u53ea\u9700\u77e5\u9053\u8be5\u5143\u7d20\u7684\u503c $r$\uff0c\u5e76\u5c06\u8981\u6c42\u7684\u65b9\u6848\u7684\u6761\u4ef6\u53d8\u4e3a \u201c\u548c\u6a21 $p$ \u4e3a $p-r$\u201d \u5373\u53ef\n\n\u9996\u5148\u53ef\u4ee5\u7c7b\u63a8\u80cc\u5305\u60f3\u5230\u4e00\u79cd dp \u7684\u601d\u8def\uff1a\u8bbe $dp(k, r)$ \u8868\u793a\u5df2\u7ecf\u9009\u4e86 $k$ \u4e2a\u5143\u7d20\uff0c\u5176\u548c\u4e3a $r$ \u7684\u65b9\u6848\u6570\u3002\u4f46\u5728\u8003\u8651\u8f6c\u79fb\u65f6\uff0c\u7531\u4e8e\u6211\u4eec\u5e76\u4e0d\u6e05\u695a\u67d0\u4e00\u72b6\u6001\u91cc\u7a76\u7adf\u9009\u4e86\u54ea\u4e9b $f(x)$\uff0c\u56e0\u6b64\u6ca1\u6cd5\u8ba1\u7b97\u51fa\u8f6c\u79fb\u540e\u7684\u65b9\u6848\n\n\u4e00\u79cd\u4f8b\u5b50\u662f\uff1a$dp(k, 2r\\mod p)$ \u7684\u65b9\u6848\u5305\u542b\u4e24\u79cd\u65b9\u6848 $\\{f(a), f(b)\\}, \\{f(a), f(a)\\}$\uff0c\u5176\u4e2d $f(a)=f(b)=r\\pmod p$\uff0c\u5f53\u6211\u4eec\u8f6c\u79fb\u81f3 $dp(k+1, 3r\\mod p)$ \u65f6\uff0c\u518d\u5f80\u7b2c\u4e00\u79cd\u65b9\u6848\u52a0\u5165\u4e00\u4e2a $f(a)$ \u548c\u518d\u5f80\u7b2c\u4e8c\u79cd\u65b9\u6848\u52a0\u5165\u4e00\u4e2a $f(b)$ \u5f97\u51fa\u7684\u65b9\u6848\u5b9e\u9645\u4e0a\u662f\u4e00\u6837\u7684\uff0c\u800c\u6211\u4eec\u5728\u53ea\u8bb0\u5f55\u65b9\u6848\u6570\u7684\u60c5\u51b5\u4e0b\u4e0d\u53ef\u80fd\u5f97\u77e5\u8fd9\u70b9\n\n\u4e8e\u662f\u6211\u4eec\u8fd8\u9700\u518d\u52a0\u4e00\u7ef4\u9650\u5236\u9009\u53d6\u7684\u5143\u7d20\u96c6\u5408\u3002\u8bbe $dp(k, r, m)$ \u8868\u793a\u5df2\u7ecf\u9009\u4e86 $k$ \u4e2a\u5143\u7d20\uff0c\u5176\u548c\u4e3a $r$\uff0c\u9009\u7684\u5143\u7d20\u7684**\u79cd\u7c7b\u7f16\u53f7**\u5728 $[1, m]$ \u8303\u56f4\u5185\u7684\u65b9\u6848\u6570\u3002\u8fd9\u91cc\u7684\u79cd\u7c7b\u7f16\u53f7\u662f\u5bf9\u6bcf\u6a21 $p$ \u7684\u4f59\u6570 $r$ \u76f8\u540c\u7684\u4e00\u7ec4 \u201c\u53d1\u653e\u201d \u4e00\u4e2a\uff08\u56e0\u4e3a\u5728\u8f6c\u79fb\u65f6\u6211\u4eec\u53ea\u5173\u5fc3\u52a0\u5165\u7684\u5143\u7d20\u5bf9\u548c\u7684\u5f71\u54cd\uff09\uff0c\u987a\u5e8f\u968f\u610f\uff0c\u4ece $1$ \u5f00\u59cb\u7f16\u53f7\n\n\u8fd9\u6837\u6211\u4eec\u7684\u8f6c\u79fb\u65b9\u7a0b\u5c31\u4e3a $dp(k, r, m)=\\sum\\limits_{k'=0}^k\\binom{cnt(m)+(k-k')-1}{cnt(m)-1}\\cdot dp(k', (r-val(m)+p)\\mod p, m-1)$\n\n\u5176\u4e2d $cnt(m)$ \u6307\u7f16\u53f7\u4e3a $m$ \u7684\u5143\u7d20\u7684\u4e2a\u6570\uff0c$val(m)$ \u6307\u7f16\u53f7\u4e3a $m$ \u7684\u5143\u7d20\u6a21 $p$ \u7684\u503c\uff08\u5728\u5b9a\u4e49\u7f16\u53f7\u65f6\uff0c\u6211\u4eec\u5df2\u7ecf\u8981\u6c42\u6a21 $p$ \u7684\u503c\u76f8\u540c\u7684\u5143\u7d20\u624d\u80fd\u5206\u5230\u4e00\u79cd\u7f16\u53f7\uff09\n\n\u5176\u4e2d $\\binom{cnt(m)+(k-k')-1}{cnt(m)-1}$ \u7684\u7ec4\u5408\u610f\u4e49\u4e3a\uff1a\u4ece $cnt(m)$ \u79cd\u6bcf\u79cd\u65e0\u7a77\u591a\u7684\u5143\u7d20\u4e2d\u9009 $(k-k')$ \u4e2a\uff0c\u95ee\u4e0d\u540c\u7684\u9009\u53d6\u65b9\u6848\u6570\u3002\u8bc1\u660e\u53ef\u4ee5\u8003\u8651\u9694\u677f\u6cd5\uff1a\u6211\u4eec\u6709 $(cnt(m)+(k-k')-1)$ \u4e2a\u5c0f\u7403\uff0c\u7528 $cnt(m)-1$ \u4e2a\u9694\u677f\u6210\u975e\u7a7a\u7684 $cnt(m)$ \u6bb5\uff0c\u7b2c $i$ \u6bb5\u7684\u4e2a\u6570 $x$ \u5373\u4ee3\u8868\u7b2c $i$ \u79cd\u5c0f\u7403\u9009\u4e86 $x-1$ \u4e2a\n\n## CODE\n\n\u6ce8\u610f\u5728\u521d\u59cb\u5316\u65f6\u53ea\u9700\u8bbe `dp[0][0][0] =1`\n\n\u6211\u5728\u4e00\u5f00\u59cb\u8fd8\u53e6\u5916\u5c06\u6700\u540e\u4e00\u7ef4\uff08$m$\uff09\u4e3a\u6bcf\u79cd\u53ef\u80fd\u7684\u7f16\u53f7\u53d6\u503c\u7684 `dp` \u6570\u7ec4\u90fd\u8bbe\u4e3a\u4e86 `1`\uff0c\u5c31\u50cf\u8fd9\u6837\uff1a\n\n```cpp\nfor(int m =0; m <= tot; ++m)/*tot \u5c31\u662f\u7f16\u53f7\u603b\u6570*/\n\tdp[0][0][m] =1;\n```\n\n\u7136\u800c\u5bf9\u4e8e `dp[0][0][m]`\uff0c$m\\in[1, tot]$ \u7684\u8fd9\u4e9b\u72b6\u6001\uff0c\u5b83\u4eec\u5728 dp \u65f6\u5b9e\u9645\u4e0a\u53c8\u4f1a\u88ab `dp[0][0][0]` \u518d\u8f6c\u79fb\u4e00\u6b21\uff0c\u5bfc\u81f4\u8d21\u732e\u91cd\u590d\n\n\u5f53\u7136\u4e5f\u4e0d\u80fd\u8bbe $m$ \u8fd9\u7ef4\u8868\u793a \u201c...\u4e14\u6bcf\u79cd\u81f3\u5c11\u4e00\u4e2a\u201d\uff0c\u90a3\u6837\u7684\u8bdd\u7b54\u6848\u5c31\u9519\u4e86\uff08\u53ef\u80fd\u6709\u65b9\u6848\u6ca1\u9009\u5230\u67d0\u79cd\u6807\u53f7\uff09\u3002\u8fd9\u91cc\u4e3b\u8981\u7684\u9519\u8bef\u8fd8\u662f**\u521d\u59cb\u5316\u4e86\u5728 dp \u8fc7\u7a0b\u4e2d\u4f1a\u88ab\u9012\u63a8\u51fa\u7684\u65b9\u6848**\uff08\u4e14\u50cf\u8fd9\u9053\u9898\uff0c\u9012\u63a8\u65f6\u4e0d\u662f\u8986\u76d6\u800c\u662f**\u76f8\u52a0**\uff09\n\n```cpp\n#include <cstdio>\n#define ll long long\n\nconst int M =999911659;\n\n/*------------------------------Val------------------------------*/\n\nll n, p;\nint val[501], tot;\nll cnt[501];/*\u6a21 p \u4e3a r \u7684 f(x) \u6709\u591a\u5c11*/\n\n/*------------------------------C------------------------------*/\n\nint inv[9];\nint c_[501][9];\n\nvoid pre(){\n\tinv[1] =1;\n\tfor(int i =2; i <= 8; ++i)\n\t\tinv[i] =1ll*(M-M/i)*inv[M%i]%M;\n\tfor(int m =1; m <= tot; ++m){\n\t\tc_[m][0] =1;\n\t\tfor(int k =1; k <= 8; ++k){\n\t\t\tint tmp =1;\n\t\t\tfor(int i =0; i < k; ++i)\n\t\t\t\ttmp =1ll*tmp*(cnt[m]%M+k-1-i)%M;\n\t\t\tfor(int i =1; i <= k; ++i)\n\t\t\t\ttmp =1ll*tmp*inv[i]%M;\n\t\t\tc_[m][k] =tmp;\n\t\t}\n\t}\n}\n\n/*\u8fd9\u91cc\u4e3a\u4e86\u8c03\u7528\u65b9\u4fbf\uff0cm, k \u4e0d\u662f\u539f\u6765\u7684\u542b\u4e49\u3002\u539f\u6765\u7684\u542b\u4e49\u89c1\u4e0b\u884c*/\n/*C(cnt[m]+k-1, k)*/\ninline int C_(int m, int k){\n\treturn c_[m][k];\n}\n\n/*------------------------------Main------------------------------*/\n\nbool vis[500];\nint pos[500];\n\n/*\u5df2\u9009 k \u4e2a f(x)\uff0c\u5b83\u4eec\u7684\u548c\u6a21 p \u4e3a r\uff0c\u5f53\u524d\u9009\u4e86\u6807\u53f7\u4e3a [1, m] \u7684 f(x)\uff0c\u7684\u65b9\u6848*/\nint dp[9][500][501];\n\nint main(){\n\tscanf(\"%lld%lld\", &n, &p);\n\tint rep =0, ii =1;\n\tfor(int nw =1%p /*p == 1*/; !vis[nw] && ii <= n; nw =(nw*10+1)%p, ++ii, rep =nw){\n\t\tvis[nw] =1;\n\t\tpos[nw] =ii;\n\t\tval[++tot] =nw;\n\t}\n\t/*\u5faa\u73af\u8282\u5c0f\u4e8e n \u65f6\uff0c\u8fd9\u4e00\u6bb5\u7b97\u51fa\u6765\u4e5f\u662f\u5bf9\u7684 ( \u8fd9\u65f6\u7b97\u6cd5\u5c31\u76f8\u5f53\u4e8e\u8ba4\u4e3a\u7b49\u4e8e n \u4e86 X )*/\n\tint res =0;/*\"1...1\" ( n \u4e2a 1 ) \u6a21 p \u662f\u591a\u5c11\uff0c\u6700\u540e\u7edf\u8ba1\u7b54\u6848\u9700\u8981\u5b83 ( \u56e0\u4e3a\u8fd9\u4e2a\u4e32\u8981\u5f3a\u5236\u9009 )*/\n\tif(ii > n){\n\t\tfor(int i =1; i <= n; ++i)\n\t\t\tcnt[i] =1;\n\t\tres =val[tot];\n\t}\n\telse{\n\t\tres =val[tot];\n\t\trep =pos[rep];\n\t\tfor(int i =1; i <= rep-1; ++i)\n\t\t\tcnt[i] =1;\n\t\tfor(int i =rep; i <= tot; ++i)\n\t\t\tcnt[i] =(n-(rep-1))/(tot-rep+1);\n\t\tfor(int i =rep; i <= (n-(rep-1))%(tot-rep+1); ++i)\n\t\t\t++cnt[i], res =val[i];\n\t}\n\t\n\tpre();\n//\tfor(int m =0; m <= tot; ++m)\n//\t\tdp[0][0][m] =1;\n\tdp[0][0][0] =1;\n\t/*\u4e3a\u4e86\u65b9\u4fbf\uff0c\u8fd9\u91cc\u7684\u8f6c\u79fb\u662f\u5012\u7740\u5199\u7684X*/\n\tfor(int k =0; k <= 8; ++k)\n\t\tfor(int m =0; m < tot; ++m)\n\t\t\tfor(int r =0; r < p; ++r)\n\t\t\t\tfor(int knet =k; knet <= 8; ++knet)\n\t\t\t\t\t(dp[knet][(r+val[m+1]*(knet-k))%p][m+1] +=1ll*C_(m+1, knet-k)*dp[k][r][m]%M) %=M;\n\t\n\tint ans =0;\n\tfor(int i =0; i <= 8; ++i)\n\t\t(ans +=dp[i][(0-res+p)%p][tot]) %=M;\n\tprintf(\"%d\", ans);\n}\n```",
        "postTime": 1600044796,
        "uid": 105254,
        "name": "Piwry",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2481 \u3010[SDOI2010]\u4ee3\u7801\u62cd\u5356\u4f1a\u3011"
    },
    {
        "content": "### \u611f\u8c22\u6765\u81ea\u697c\u4e0a\u5927\u4f6c ***bztMinamoto*** \u7684\u8bb2\u89e3\n\n\n>\u5bf9\u4e8e\u4e00\u4e2a\u5404\u6570\u4f4d\u975e\u9012\u51cf\u7684\u6570\n\n>>\u59821222333\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u5206\u6210$$1111111+111111+111$$\n\n>>\u5176\u4e2d\uff0c\u6bcf\u4e00\u9879 1 \u7684\u4e2a\u6570\u4e3a \u5927\u4e8e\u7b49\u4e8e\u5f53\u524d\u6570\u5b57\u7684\u4e2a\u6570\uff08\u5982\u22651\u7684\u67097\u4e2a\uff0c\u22652\u7684\u67096\u4e2a\uff09\n\n>>\u800c\u8fd9\u6837\u5212\u5206\u7684\u597d\u5904\u5c31\u5728\u4e8e\uff0c11...11 mod P \u7684\u503c\u7684\u4e2a\u6570\u2264P\n\n>>\u82e5\u6211\u4eec\u4ee5 Cnt[i] \u6765\u8bb0\u5f55\u6ee1\u8db3 mod P == i \u7684 11...11\u7684\u4e2a\u6570\uff0c\u90a3\u4e48\u6700\u7ec8\u7684\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a \u4ece\u8fd9\u4e9b Cnt \u503c\u4e2d \u9009\u51fa\u4e0d\u591a\u4e8e 9\u4e2a\u503c \u6765\u7ec4\u6210\u6570\u5217\uff08**\u6ce8\u610f**\uff1a\u5fc5\u987b\u9009\u53d6\u542b\u6709N\u4e2a1\u76841....1\u6765\u4f5c\u4e3a\u6570\u4f4d\u7684\u7b2c\u4e00\u9879\uff09\n\n>>\u5bf9\u4e8eCnt\u7684\u6c42\u89e3\u672c\u849f\u84bb\u4e00\u76f4\u5199\u6302\uff08\u4e00\u5f00\u59cb\u5199\u5f97\u6781\u590d\u6742\uff09\uff0c\u6700\u7ec8\u91c7\u7528\u4e86\u5927\u4f6c ***bztMinamoto*** \u7684\u5199\u6cd5\u3002\u3002\u3002\n\n\n>\u5bf9\u4e8e\u8fd9\u4e2a\u65b0\u95ee\u9898\uff0c\u6211\u4eec\u4f7f\u7528\u52a8\u6001\u89c4\u5212\u6765\u89e3\u51b3\n\n>>\u4ee4 Dist[i][j][k] \u4e3a \u5728\u524d i \u4e2a cnt[i] \u4e2d\u9009 k \u4e2a\u503c \u6784\u6210\u7684 \u548c mod P == j \u7684\u65b9\u6848\u6570\n\n>>$Dist[i+1][j][k]=\\sum_{l=1}^k Dist[i][(P+ j-(i*l))modP][k-l]*C_{Cnt[i]+l-1}^l$\n\n>>>\u5176\u4e2d $C_{Cnt[i]+l-1}^l$ \u6307\u7684\u5c31\u662f\u4eceCnt[i]\u4e2a\u6570\u4e2d\u53ef\u91cd\u590d\u5730\u9009\u53d6 l \u4e2a\u7684\u65b9\u6848\u6570\uff0c\u8bc1\u660e\u5982\u4e0b\uff1a\n>>>>\u4ece x \u4e2a\u6570\u4e2d\u53ef\u91cd\u590d\u9009\u53d6 i \u4e2a\u6570\u76f8\u5f53\u4e8e \u5f80 i \u4e2a\u683c\u5b50\u91cc\u653e x \u4e2a\u7403\n\n>>>>\u91c7\u7528\u9694\u677f\u6cd5\uff0c\u53c8\u56e0\u4e3a\u5141\u8bb8\u653e\u96f6\u4e2a\u7403\u7684\u4e2a\u5b50\uff0c\u6240\u4ee5\u65b9\u6848\u6570\u4e3a$C_{x+i-1}^i$\n\n>>>\u4e3a\u4e86\u65b9\u4fbf\u6211\u4eec\u7528C[i][j]\u6765\u8868\u793a$C_{Cnt[i]+j-1}^j$\n\n\n## \u6700\u540e\u4ee3\u7801\u5982\u4e0b\n```cpp\n#include<queue>\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\ntypedef unsigned long long ll;\nconst ll Mod=999911659;\nconst int Nn=502; const int Kn=12;\nll i,j,k,l,N,P,Fri,Ans,Beg,Sum,Len,Cnt[Nn],Pos[Nn],Inv[Kn],C[Nn][Kn],Dist[2][Nn][Kn];\n//\tCnt \u6570\u7ec4\u6c42\u89e3 \n//\t\n//\tPos \u8bb0\u5f55 \u6bcf\u4e2a 111...111 mod P \u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\n//\tFri \u8bb0\u5f55 N\u4e2a1 \u7ec4\u6210\u7684 111...111 mod P \u7684\u503c \n//\tBeg \u8bb0\u5f55 \u5faa\u73af\u8282\u5934\u90e8\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e   \n//\tLen \u8bb0\u5f55 \u5faa\u73af\u8282\u4e2a\u6570 \nvoid Prepare_Cnt() {\n\tSum=0;\n\tif(N<=P){for(i=1;i<=N;i++) {Sum=(Sum*10+1)%P; Cnt[Sum]++; } Fri=Sum; } //\u6709\u22641\u7684\u5faa\u73af\u8282 \n\telse {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   //\u6709len\u4e2a\u5faa\u73af\u8282 \n\t\tfor(i=1;i<=P+1;i++){\n\t\t\tSum=(Sum*10+1)%P;\n\t\t\tif(Cnt[Sum]) {Beg=Pos[Sum]; Len=i-Beg; break;}  \n\t\t\tCnt[Sum]++; Pos[Sum]=i;\n\t\t}\n\t\tfor(i=0;i<P;i++) if(Cnt[i] && Pos[i]>=Beg){\n\t\t\tCnt[i]=(N-Beg+1)/Len;\n\t\t\tif(Pos[i]-Beg+1<=(N-Beg+1)%Len) Cnt[i]++;\t\t\t\t\t   //\u5728Beg\u524d\u591a\u51fa\u7684\u90e8\u5206 \n\t\t\tif((Pos[i]-Beg+1)%Len==(N-Beg+1)%Len) Fri=i; \n\t\t}\n\t}\n}\n// C \u6570\u7ec4\u6c42\u6cd5 \nvoid Prepare_C() {\n\tfor(i=0;i<P;i++){\n\t\tC[i][0]=1;\n\t\tif(Cnt[i]) for(j=1;j<9;j++) (C[i][j]=(C[i][j-1]*Cnt[i]%Mod)*Inv[j]%Mod)%=Mod,(Cnt[i]+=1)%=Mod;\n\t}\n}\nvoid Prepare_Inv() {Inv[1]=1; for(i=2;i<=9;i++) Inv[i]=(Inv[Mod%i]*((Mod-Mod/i)%Mod))%Mod;}\nvoid NowBeginDp(){\n\tDist[0][Fri][0]=1; Beg=0;\n\tfor(i=0;i<P;i++,Beg^=1)\n\tfor(j=0;j<P;j++)\n\tfor(k=0;k<9;k++){\n\t\tDist[Beg^1][j][k]=0;\n\t\tfor(l=0;l<=k;l++)\n\t\tif(Dist[Beg][(P+j-(l*i%P))%P][k-l])\n\t \t  (Dist[Beg^1][j][k]+=Dist[Beg][(P+j-(l*i%P))%P][k-l]*C[i][l]%Mod)%=Mod;\n\t}\n}\nvoid NowSolveAns(){\n\tAns=0;\n\tfor(i=0;i<9;i++)\n\t (Ans+=Dist[Beg][0][i])%=Mod;\n\tcout<<Ans<<endl;\n}\nint main(){\n\tios::sync_with_stdio(false);\n\tcin>>N>>P;\n\tPrepare_Cnt(); Prepare_Inv(); Prepare_C();\n\tNowBeginDp(); NowSolveAns();\n\treturn 0;\n}\n\n```\n\n\n\n",
        "postTime": 1535533854,
        "uid": 125924,
        "name": "Kitahara_Haruki",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2481 \u3010[SDOI2010]\u4ee3\u7801\u62cd\u5356\u4f1a\u3011"
    },
    {
        "content": "\u795e\u4ed9\u9898\uff0c\u800c\u4e14\u7ec6\u8282\u5f88\u591a\u3002\n\n- \u5c06\u9012\u589e\u6570\u5217\u8f6c\u5316\u4e3a\u4e0d\u8d85\u8fc7 $9$ \u4e2a\u5168 $1$ \u540e\u7f00\u4e4b\u548c\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u8981\u9009\u62e9\u4e0d\u8d85\u8fc7 $9$ \u4e2a\u5168 $1$ \u540e\u7f00\uff0c\u4f7f\u5f97\u548c\u6574\u9664 $P$\u3002\u4e3a\u4e86\u6ee1\u8db3\u9898\u76ee\u8981\u6c42\u7684 $n$ \u4f4d\u6570\uff0c\u6211\u4eec\u5148\u94a6\u5b9a\u4e00\u4e2a\u957f\u4e3a $n$ \u7684\u5168 $1$ \u540e\u7f00\uff0c\u5bf9\u5269\u4e0b $8$ \u4e2a\u8ba1\u6570\u3002\n\n- $\\{p_i\\},p_i=\\Big(\\sum\\limits_{j=0}^{i-1}10^j\\Big)\\bmod P$ \u5177\u6709\u957f\u5ea6\u4e0d\u8d85\u8fc7 $p$ \u7684\u5faa\u73af\u8282\u3002\uff08$p_i$ \u6307\u5411 $p_{i+1}$ \u4e14\u5927\u5c0f\u90fd\u5c0f\u4e8e $P$\uff0c\u5728 $2P$ \u957f\u5ea6\u5185\u4e00\u5b9a\u4f1a\u51fa\u73b0\u5faa\u73af\u8282\uff09\n\n\n- \u5faa\u73af\u8282\u7684\u5904\u7406\uff0c\u53ef\u80fd\u5728\u5faa\u73af\u8282\u4e4b\u524d\u8fd8\u6709\u4e00\u6bb5\u6570\uff0c\u9700\u8981\u7279\u6b8a\u5904\u7406\u3002\u5982\u679c $n$ \u4ee5\u5185\u6ca1\u6709\u627e\u5230\u5faa\u73af\u8282\uff0c\u90a3\u5c31\u8bbe\u4e3a $n$\u3002\n\n\u73b0\u5728\u8bb0 $g[i]$ \u4e3a\u5168 $1$ \u540e\u7f00\u6a21 $P$ \u4e3a $i$ \u7684\u540e\u7f00\u4e2a\u6570\uff0c\u8003\u8651 $f[i][j][k]$ \u4e3a\u5728\u524d $i$ \u4e2a\u540e\u7f00\u4e2d\uff0c\u9009\u4e86 $j$ \u4e2a\uff0c\u548c\u6a21 $P$ \u7b49\u4e8e $k$\u3002\u8fd9\u91cc\u7684\u524d $i$ \u4e2a\u6307\u7684\u662f $0\\sim i-1$\uff0c\u5426\u5219\u65e0\u6cd5\u8bbe\u5b9a\u8fb9\u754c\u3002\n\n\u5bf9\u4e8e\u8f6c\u79fb\uff0c\u6b63\u5411\u8003\u8651 $f[i][j][k]$ \u5bf9\u5176\u4ed6\u503c\u7684\u8d21\u732e\uff0c\u679a\u4e3e\u7b2c $i+1$ \u7c7b\u540e\u7f00\uff08\u6a21 $P$ \u4e3a $i+1$ \u7684\uff09\u9009 $num$ \u4e2a\uff1a\n\n$$\nf[i+1][j+num][(k+num\\times(i+1))\\bmod P]=\\sum {num+g[i]-1\\choose num}\\times f[i][j][k]\n$$\n\n\u8fd9\u4e2a\u8f6c\u79fb\u7cfb\u6570 ${num+g[i]-1\\choose num}$ \u6765\u6e90\u4e8e\u9694\u677f\u6cd5\uff1a\u4f59\u6570\u4e3a $i+1$ \u7684\u540e\u7f00\u6709 $g[i]$ \u4e2a\uff0c\u800c\u8981\u4ece\u91cc\u9762\u9009 $num$ \u4e2a\uff0c\u6bcf\u4e2a\u540e\u7f00\u88ab\u9009\u6b21\u6570\u4e0d\u9650\u3002\n\n\u6362\u4e2a\u65b9\u5f0f\u7406\u89e3\uff1a\u6709 $g[i]$ \u4e2a\u7bb1\u5b50\uff0c\u6709 $num$ \u4e2a\u7403\uff0c\u8981\u5c06\u8fd9\u4e9b\u7403\u653e\u8fdb\u7bb1\u5b50\u91cc\uff0c\u5141\u8bb8\u7a7a\u3002\u7b54\u6848\u5373\u4e3a ${num+g[i]-1\\choose g[i]-1}$\uff0c\u800c $g[i]$ \u592a\u5927\uff0c\u8f6c\u5316\u4e3a ${num+g[i]-1\\choose num}$ \u66f4\u5229\u4e8e\u8ba1\u7b97\u3002 \n\n\u7ec4\u5408\u6570\u7684\u8ba1\u7b97\u65b9\u5f0f\u4e5f\u9700\u8981\u6ce8\u610f\u3002\u7531\u4e8e $num+g[i]-1$ \u592a\u5927\uff0c\u65e0\u6cd5\u9884\u5904\u7406\uff0c\u6240\u4ee5\u6211\u4eec\u91c7\u7528 $O(num)$ \u7684\u65b9\u5f0f\u76f4\u63a5\u8ba1\u7b97\u3002\n\n```cpp\nint C(int nn,int mm){\n\tif(mm==0ll)return 1ll;\n\tint ans1=1ll,ans2=1ll;\n\tfor(int i=0;i<mm;++i){\n\t\tans1=(ans1*(nn-i))%mod;\n\t\tans2=(ans2*(mm-i))%mod;\n\t}\n\treturn ans1*qpow(ans2,mod-2ll)%mod;\n}\n```\n\n\u8bb0 $C=8$\uff0c\u5219\u5728\u8f6c\u79fb\u4e2d\u8ba1\u7b97\u590d\u6742\u5ea6\u4e3a $O(C^2P^2\\log P)$\uff0c$C^2P^2$ \u6765\u6e90\u4e8e\u679a\u4e3e\uff0c$\\log P$ \u6765\u6e90\u4e8e\u5feb\u901f\u5e42\u3002\u5f88\u96be\u901a\u8fc7\uff0c\u53ea\u6709 $50$ \u5206\u3002\u53d1\u73b0\u8f6c\u79fb\u7cfb\u6570 ${num+g[i]-1\\choose num}$ \u4e0e $k$ \u65e0\u5173\uff08\u4e0e $i,j$ \u6709\u5173\uff0c\u56e0\u4e3a $num\\leq 8-j$\uff09\uff0c\u8003\u8651\u5148\u8ba1\u7b97\u518d\u679a\u4e3e $k$\uff0c\u590d\u6742\u5ea6 $O(C^2P^2)$\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\ninline int read(){\n\tint x=0,f=1;\n\tchar c=getchar();\n\twhile(c<'0'||c>'9'){\n\t\tif(c=='-')f=-1;\n\t\tc=getchar();\n\t}\n\twhile(c<='9'&&c>='0'){\n\t\tx=(x<<1)+(x<<3)+(c^48);\n\t\tc=getchar();\n\t}\n\treturn x*f;\n}\n\nvoid print(int x){\n\tif(x<0)putchar('-'),x=-x;\n\tif(x>9)print(x/10);\n\tputchar(x%10^48);\n}\n\nconst int mod=999911659;\nconst int N=510;\nint n,p,be,len,a[N],t[N],g[N],f[N][10][N],lst[N];\n\nvoid init(){\n\tint tmp=1%p;\n\tfor(int i=1;;++i){\n\t\ta[i]=tmp;\n\t\tif(lst[tmp]){\n\t\t\tlen=i-lst[tmp];\n\t\t\tbe=lst[tmp]-1;\n\t\t\tbreak;\n\t\t}else lst[tmp]=i;\n\t\ttmp=(tmp*10+1)%p;\n\t}\n\tif(len>=n)len=n;\n\tfor(int i=1;i<=be;++i){\n\t\tg[a[i]]++;\n\t}\n\tfor(int i=be+1;i<=be+len;++i){\n\t\tg[a[i]]=(g[a[i]]+(n-i)/len+1)%mod;\n\t}\n}\n\nint qpow(int A,int B){\n\tint ans=1ll;\n\twhile(B){\n\t\tif(B&1)ans=ans*A%mod;\n\t\tA=A*A%mod;\n\t\tB>>=1ll;\n\t}\n\treturn ans;\n}\n\nint C(int nn,int mm){\n\tif(mm==0ll)return 1ll;\n\tint ans1=1ll,ans2=1ll;\n\tfor(int i=0;i<mm;++i){\n\t\tans1=(ans1*(nn-i))%mod;\n\t\tans2=(ans2*(mm-i))%mod;\n\t}\n\treturn ans1*qpow(ans2,mod-2ll)%mod;\n}\n\nsigned main(){\n\tn=read(),p=read();\n\tinit();\n\tf[0][0][0]=1ll;\n\tfor(int i=0;i<=p-1;++i){\n\t\tfor(int j=0;j<=8;++j){\n\t\t\tfor(int num=0;num<=8-j;++num){\n\t\t\t\tint tmp=C(num+g[i]-1,num);\n\t\t\t\tfor(int k=0;k<p;++k){\n\t\t\t\t\tf[i+1][j+num][(k+num*i)%p]=(f[i+1][j+num][(k+num*i)%p]+tmp*f[i][j][k]%mod)%mod;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint ans=0,tmp=(n-be)%len;\n\tif(!tmp)tmp=len;\n\ttmp+=be;\n\ttmp=(p-a[tmp])%p;\n\tfor(int j=0;j<=8;++j){\n\t\tans=(ans+f[p][j][tmp])%mod;\n\t}\n\tprint(ans);\n\treturn 0;\n}\n```\n\u611f\u89c9\u6709\u5e2e\u52a9\u5c31\u70b9\u4e2a\u8d5e\u5427\u3002",
        "postTime": 1667737276,
        "uid": 271736,
        "name": "Daidly",
        "ccfLevel": 6,
        "title": "P2481 [SDOI2010]\u4ee3\u7801\u62cd\u5356\u4f1a \u9898\u89e3"
    },
    {
        "content": "\u4e00\u4e2a\u6570 $A$\uff0c\u53ef\u4ee5\u62c6\u6210 $9$ \u4e2a\u8fde\u7eed\u7684 $1$ \u7684\u6570\u5b57\u3002  \n\u8bbe\u5176\u5206\u522b\u4e3a $a_i$\uff0c\u90a3\u4e48 $a$ \u6ee1\u8db3 $\\sum_{i=1}^9 a_i = A$\u3002   \n\ne.g:  \n$A=111122223344556888$ \u53ef\u4ee5\u5206\u6210\uff1a  \n$a_1=111111111111111111,\\\\\na_2=11111111111111,\\\\\na_3=1111111111,\\\\\na_4=11111111,\\\\\na_5=111111,\\\\\na_6=1111,\\\\\na_7=111,\\\\\na_8=111,\\\\\na_9=0$   \n\n\u56e0\u6b64,\u6211\u4eec\u53ea\u8981\u5148\u9009\u957f\u4e3a $n$ \u7684\u8fd9\u79cd\u6570\u5b57 $a_1$\uff08\u5c5e\u4e8e $1$\uff09\uff0c\u7136\u540e\u518d\u9009\u53d6\u957f\u5ea6 $\\leq n$ \u7684 $8$ \u4e2a\u8fd9\u79cd\u6570\u5b57 $a_i(2\\leq i\\leq 9)$\uff0c\u4f7f\u5176\u548c $\\sum_{i=1}^9 a_i \\equiv 0 \\pmod{p}$ \u5373\u53ef\u3002   \n\u5f53\u6211\u4eec\u5df2\u7ecf\u9009\u53d6\u4e86\u4e00\u7ec4\u6570 $a$\uff0c\u4e0d\u5fc5\u8981\u6c42 $a$ \u91cc\u9762\u7684\u6570\u5b57\u4ece\u5927\u5230\u5c0f\u6392\u597d\u5e8f\u3002\u56e0\u4e3a\u6211\u4eec\u5728\u9009\u597d\u540e\u518d\u8fdb\u884c\u6392\u5e8f\uff0c\u4e5f\u80fd\u786e\u5b9a\u8fd9\u7ec4\u6570\u5bf9\u5e94\u7684\u552f\u4e00\u4e00\u4e2a\u6570\u3002\uff08\u6216\u8005\u76f4\u63a5\u628a $a_i$ \u76f8\u52a0\u4e5f\u53ef\u4ee5\u3002\uff09  \n\u7531\u4e8e\u548c\u8981\u4fdd\u8bc1 $\\sum_{i=1}^9 a_i \\equiv 0 \\pmod{p}$\uff0c\u56e0\u6b64\u9009\u7684\u6570\u8981\u786e\u8ba4\u5176\u4f59\u6570\u7684\u503c\u3002  \n\u4e8e\u662f\u4fbf\u60f3\u5230\u679a\u4e3e\u4f59\u6570\uff0c\u4f7f\u7528 dp \u8fdb\u884c\u8f6c\u79fb\u8ba1\u7b97\u3002  \n\u7531\u4e8e\u6613\u77e5 $\\{0,1,11,111,1111,11111,111111...\\}$ \u8fd9\u4e9b\u6570 $\\bmod \\,p$ \u7684\u4f59\u6570\u4f1a\u51fa\u73b0\u5faa\u73af\u8282\uff0c\u6240\u4ee5\u5bb9\u6613\u8ba1\u7b97\u51fa\u6709\u591a\u5c11\u4e2a\u6570\u7684\u4f59\u6570\u5bf9\u5e94 $\\left[0,p-1\\right]$ \u4e2d\u7684\u6bcf\u4e00\u4e2a\u6570\u3002  \n\u8981\u6ce8\u610f\u4e0d\u80fd\u5148\u679a\u4e3e $i(1\\leq i\\leq 9)$\uff0c\u518d\u679a\u4e3e $a_i\\bmod p$ \u7684\u503c\uff0c\u8fd9\u6837\u4f1a\u91cd\u590d\u3002  \n\u5982\uff1a \n\n1. $a=\\{1,1,2,3,5,3\\}$ \u548c $a=\\{1,1,2,3,3,5\\}$ \u91cd\u590d\uff08\u8fd9\u91cc $a_i$ \u662f\u4f59\u6570\uff09\uff08\u5bf9\u5e94\u53bb\u91cd\u65b9\u6cd5\u4e00\uff09\u3002   \n2. $p=100$ \u65f6\uff0c$a=\\{1,1,11,111\\}$ \u548c $a=\\{1,1,111,11\\}$ \u91cd\u590d\uff08\u8fd9\u91cc $a_i$ \u662f\u539f\u6570\uff09\uff08\u5bf9\u5e94\u53bb\u91cd\u65b9\u6cd5\u4e8c\uff09\u3002   \n\n\u4e3a\u4e86\u4e0d\u91cd\u590d\uff0c\u4e00\u662f\u5728\u6700\u5916\u9762\u679a\u4e3e\u4f59\u6570\uff1b\u4e8c\u662f\u679a\u4e3e\u6709\u51e0\u4e2a\u6570\u662f\u8fd9\u4e2a\u4f59\u6570\uff0c\u518d\u7528\u4e0a\u7ec4\u5408\u6570\u786e\u4fdd\u60c5\u51b5\u4e0d\u4f1a\u91cd\u590d\u5c31\u53ef\u4ee5\u4e86\u3002  \n - \u7ec4\u5408\u6570\u600e\u4e48\u7b97\uff1a\u82e5\u679a\u4e3e $x$ \u4e2a\u6570\u662f\u8fd9\u4e2a\u4f59\u6570\uff0c\u603b\u5171\u6709 $y$ \u4e2a\u6570\u7684\u4f59\u6570\u4e3a\u8fd9\u4e2a\u6570\uff0c\u90a3\u4e48\u4fbf\u662f $C_{x+y-1}^{x}$\u3002    \n\n$dp[i][j][k]$ \u6709\u4e09\u4e2a\u72b6\u6001\u8981\u8bb0\u5f55\uff0c\u5206\u522b\u5bf9\u5e94\u505a\u5b8c\u4e86\u4f59\u6570\u4e3a $i$ \u7684\u60c5\u51b5\uff0c\u5df2\u7ecf\u7528\u4e86 $j$ \u4e2a\u6570\uff0c\u73b0\u5728\u4f59\u6570\u4e3a $k$\u3002   \n\u7b54\u6848\u5c31\u662f $dp[p-1][9][0]$\u3002\uff08\u53ef\u4ee5\u5f00\u6eda\u52a8\u6570\u7ec4\u4f18\u5316\uff09  \n\n## Code\uff1a\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=500;\nconst long long mod=999911659;\nint p,a[N+5],pos,far;\nint mark[N+5],sum;\nlong long n,c[N+5],inv[10];\nlong long dp[2][10][N+5];\n#define Mod_(x) (x>=p?x-p:x)\n#define MOD_(x) (x>=p?(x)%p:x)\n#define Mod(x) (x>=mod?x-mod:x)\n#define MOD(x) (x>=mod?(x)%mod:x)\nlong long Pow(long long x,long long d){\n\tif(!d)return 1;\n\tlong long res=Pow(x,d>>1);\n\tif(d&1)return MOD(MOD(res*res)*x);\n\treturn MOD(res*res);\n}\ninline void init(){\n\tmemset(mark,-1,sizeof(mark));\n\tmark[0]=a[0]=0;\n\tfor(int i=1;i<=p;i++){//\u6700\u591a\u4f1a\u6709p-1\u79cd\u4f59\u6570 \n\t\ta[i]=(a[i-1]*10+1)%p;\n\t\tif(mark[a[i]]!=-1){\n\t\t\tpos=mark[a[i]];//\u5faa\u73af\u8282\u7684\u5f00\u5934 \n\t\t\tbreak;\n\t\t}\n\t\tmark[a[i]]=far=i;//\u5faa\u73af\u8282\u7684\u672b\u7aef \n\t}\n\tfor(int i=0;i<pos&&i<=n;i++)c[a[i]]++;//\u4e0d\u5728\u5faa\u73af\u8282\u4e2d\u7684\u6570\u7684\u4e2a\u6570 \n\tint len=far-pos+1,k=pos;\n\t//len\u5faa\u73af\u8282\u7684\u957f\u5ea6\uff0ck\u4e0d\u5728\u5faa\u73af\u8282\u4e2d\u7684\u4e2a\u6570 \n\tfor(int i=pos;i<=far&&i<=n;i++){//\u8ba1\u7b97\u5728\u5faa\u73af\u8282\u4e2d\u7684\u6570\u7684\u4e2a\u6570 \n\t\tc[a[i]]=(n+1-k)/len;\n\t\tif(i-pos+1<=(n+1-k)%len)c[a[i]]++;\n\t}\n\t\n\tfor(int i=1;i<=9;i++)inv[i]=Pow(i,mod-2);//1-9\u7684\u9006\u5143 \n\t\n\tif(n<=far)sum=a[n];//\u9898\u89e3\u4e2d\u7684a1\u7684\u503c \n\telse sum=a[(n+1-k-1)%len+pos];\n}\ninline long long C(long long x,long long y){//\u7ec4\u5408\u6570 \n\tif(y==0)return 1;\n\tif(x<y)return 0;\n\tif(x-y<y)y=x-y;\n\tlong long res=1;\n\tfor(long long i=x-y+1;i<=x;i++)res=MOD(res*MOD(i));\n\tfor(int i=1;i<=y;i++)res=MOD(res*inv[i]);\n\treturn res;\n}\nint main(){\n\tfreopen(\"auction.in\",\"r\",stdin);\n\tfreopen(\"auction.out\",\"w\",stdout);\n\tint la,is=1,now;\n\tscanf(\"%lld%d\",&n,&p);\n\tinit();\n\tdp[1][1][sum]=1;\n\tfor(int i=0;i<p;i++){//\u679a\u4e3e\u4f59\u6570\u4e3ai \n\t\tla=is,is^=1;\n\t\tmemset(dp[is],0,sizeof(dp[is]));\n\t\tfor(int j=9;j>=1;j--){//\u679a\u4e3e\u5df2\u7ecf\u7528\u4e86j\u4e2a\u6570 \n\t\t\tfor(int k=j;k>=1;k--){//\u679a\u4e3e\u4e4b\u524d\u7528\u4e86k\u4e2a\u6570 \n\t\t\t\tnow=MOD_((j-k)*i-1+p);//\u73b0\u5728\u6240\u9009\u7684\u6570\u52a0\u4e0a\u4e4b\u524d\u9009\u7684\u6570\u7684\u603b\u548c\u7684\u4f59\u6570 \n\t\t\t\tfor(int g=0;g<p;g++){//\u679a\u4e3e\u4e4b\u524d\u603b\u548c\u7684\u4f59\u6570 \n\t\t\t\t\tnow=Mod_(now+1);//\u8fd9\u6837\u5199\u51cf\u5c0f\u5e38\u6570 \n\t\t\t\t\tdp[is][j][now]+=dp[la][k][g]*C(c[i]+j-k-1,j-k);\n\t\t\t\t\tdp[is][j][now]=MOD(dp[is][j][now]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%lld\",dp[is][9][0]);\n\tfclose(stdin);\n\tfclose(stdout);\n\treturn 0;\n}\n```",
        "postTime": 1663248843,
        "uid": 422362,
        "name": "XXX1234",
        "ccfLevel": 7,
        "title": "[SDOI2010]\u4ee3\u7801\u62cd\u5356\u4f1a"
    },
    {
        "content": "### Solution\n\n\u8fd9\u9898\u770b\u8d77\u6765\u65e0\u4ece\u4e0b\u624b\uff0c\u4f46\u4ece\u201c\u6570\u4f4d\u975e\u4e25\u683c\u5355\u8c03\u9012\u589e\u201d\u8fd9\u4e2a\u6761\u4ef6\uff0c\u6211\u4eec\u80fd\u770b\u51fa\uff1a\n\u3010\u4f8b\u3011\n```cpp\n11222333334789999999999999=:\n11111111111111111111111111\n  111111111111111111111111\n     111111111111111111111\n          1111111111111111\n           111111111111111\n           111111111111111\n           111111111111111\n            11111111111111\n             1111111111111\n```\n\u5c31\u662f\u53ef\u4ee5\u628a\u6570\u62c6\u6210\u81f3\u591a $9$ \u4e2a $111 \\cdots 1$ \u7684\u6570\uff08\u8bb0\u4f5c $a_i$\uff09\u3002\n\u7136\u540e $n \\le 10^{18}$\uff0c\u600e\u4e48\u529e\u5462\uff1f\u603b\u4e0d\u80fd\u679a\u4e3e $1$ \u7684\u4e2a\u6570\u5427\u3002\n\u6ce8\u610f\u5230 $p \\le 500$\uff0c\u53c8\u6839\u636e [ABC258E](https://atcoder.jp/contests/abc258/tasks/abc258_e)\n\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e00\u5806\u6570\u7684\u4f59\u6570\u662f\u5faa\u73af\u7684\uff08$a_i = 10a_{i-1} + 1$\uff09\n\u8fd9\u6837\u6211\u4eec\u66b4\u529b\uff08\u628a $\\texttt{floyd}$ \u5224\u5708\u7b97\u6cd5\u6254\u5230\u4e86\u706b\u661f\u4e0a\u4e5f\u80fd\u8fc7\uff09\u627e\u5230\u5faa\u73af\u8282\uff0c\n\u5c31\u80fd\u628a\u6240\u6709\u7684 $a_i$ \u5206\u6210\u7ec4\u4e86\u3002\u7136\u540e\u2026\u2026\u5c31\u5230\u4e86\u6700\u5f00\u5fc3\u7684 $\\texttt{dp}$ \u73af\u8282\u5566\uff01\n`dp[i][j][k] := \u4f59\u6570\u5c0f\u4e8e\u7b49\u4e8e i\uff0c\u9009\u4e86 j \u4e2a\uff08\u6ce8\u610f\u59cb\u7ec8 j<=9\uff09\uff0c\u4e00\u5171\u7684\u548c\u662f k \u7684\u65b9\u6848\u6570\u3002`\n\u4e8e\u662f\u5237\u8868\uff0c\u679a\u4e3e\u4e0b\u4e00\u4e2a\u4f59\u6570\u8981\u51e0\u6b21\u5c31\u884c\u4e86\u3002\n\n\u6ce8\u610f\u6bcf\u6b21\u9009\u4f59\u6570\u7684\u65f6\u5019\u53ef\u80fd\u4f1a\u6709\u5f88\u591a $a_i$\uff0c\u6240\u4ee5\u95ee\u9898\u53d8\u6210\u4e86\uff1a\n\n\u6709 $x$ \u4e2a\u6570\uff0c\u91cc\u9762\u9009 $y$ \u4e2a\uff0c\u53ef\u4ee5\u4e0d\u9009\uff0c\u6c42\u65b9\u6848\u6570\u3002\n\n\u8fd9\u4e0d\u5c31\u5f88\u660e\u663e\u7684\u63d2\u677f\u5417\uff1f\u6bcf\u8fb9\u591a\u653e\u4e00\u4e2a\uff0c\u7b54\u6848\u4e3a $C^{x+y-1}_y$\uff0c\u6240\u4ee5\u8f6c\u79fb\u5f0f\u5b50\u51fa\u6765\u4e86\uff1a\n\n`dp[i+1][j1+j][k+j1*(i+1)%p] += dp[i][j][k] * C(cnt[i+1]+j1-1, j1)`\uff0c\u6ce8\u610f\u522b\u5fd8\u53d6\u6a21\u3002\n\n\u4ee3\u7801\u6709\u70b9\u4e11\uff0c\u5c06\u5c31\u7740\u770b\u4e0b\u5427\u3002\u56e0\u4e3a\u6709\u53ef\u80fd\u6709 $0$ \u4e2a\u9009 $0$ \u4e2a\u7684\u60c5\u51b5\u7b49\uff0c\u6240\u4ee5\u4e0d\u80fd\u9884\u5904\u7406\u6240\u6709\u7684\u9636\u4e58\u9006\u5143\uff0c\u4f46\u6bcf\u6b21\u66b4\u529b\u7b97\u7684\u590d\u6742\u5ea6\u8db3\u591f\u4e86\u3002\n\n[Code Link](/paste/1kj62kh4)",
        "postTime": 1659842144,
        "uid": 380730,
        "name": "LKX_Wata",
        "ccfLevel": 7,
        "title": "P2481 \u9898\u89e3"
    },
    {
        "content": "$DP$\u65b9\u6cd5\uff1a\n\n\u7528$f[i][j][k]$\u8868\u793a\u679a\u4e3e\u5230$cnt[i]$\uff0c\u76ee\u524d%$p$\u4f59\u6570\u662f$j$\uff0c\u5df2\u7ecf\u7528\u4e86$k$\u4e2a\u5f62\u4e3a$111\u2026111$\u7684\u6570\uff0c\u4f46\u662f\u6ce8\u610f\u5230\u8fd9\u6837\u7a7a\u95f4\u590d\u6742\u5ea6\u53ef\u80fd\u65e0\u6cd5\u627f\u53d7\uff0c\u800ci\u5bf9\u4ee5\u540e\u7684\u9012\u63a8\u5e76\u65e0\u5f71\u54cd\uff0c\u6240\u4ee5\u6211\u4eec\u628ai\u8fd9\u4e00\u7ef4\u6362\u6210\u6eda\u52a8\u7684\uff0c\u53d8\u6210$f[kkz][j][k]$\u3002\n\n\u6240\u4ee5\u66f4\u65b0\u65b9\u6cd5\u5c31\u662f$[kkz]$[$(j+i\u00d7z)$%$p$][$k+z$]$=$($f[kkz]$[$(j+i\u00d7z)$%$p$]$[k+z]+1ll\u00d7f[kkz^1][j][k]\u00d7c[i][z])$%$modd$\uff0c\u5176\u4e2d$c[i][z]$\u8868\u793a\u4ece$cnt[i]$\u4e2d\u9009$z$\u4e2a\u7684\u79cd\u7c7b\u6570\uff08\u53ef\u91cd\u590d\uff09\uff0c\u679a\u4e3e$z$\u5373\u53ef\u3002\n\n\u51e0\u4e2a\u6ce8\u610f\u70b9\uff1a\n\n1. \u8981\u4e58$1ll$($1LL$\u540c\u4e49)\uff1b\n\n1. $cnt[i]$\u8981\u5f00$long long$\uff1b\n\n1. \u4f4d\u8fd0\u7b97\u8981\u52a0\u62ec\u53f7\uff01\u4f4d\u8fd0\u7b97\u8981\u52a0\u62ec\u53f7\uff01\u4f4d\u8fd0\u7b97\u8981\u52a0\u62ec\u53f7\uff01\n\n1. $k==0?tot=i:1$\u548c$tot=k==0?i:1$\u662f\u6709\u5f88\u5927\u5dee\u522b\u7684\u3002\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#define ll long long\n#define modd 999911659\nusing namespace std;\nint p,f[2][500][10],i,j,k,z,tot,b[501],c[501][9],len,kkz,ans,inv[501];\nll n,cnt[501];\nint getc(ll u,int v)\n{\n\tint totn=inv[v];\n\tfor(u%=modd;v--;totn=1ll*totn*u%modd,u--);\n\treturn totn;\n}\nint main()\n{\n\tscanf(\"%lld%d\",&n,&p);\n\tif(n<=p)\n\t{\n\t\tfor(i=j=1;j<n;j++,i=(i*10+1)%p) cnt[i]++;cnt[tot=i]++;\n\t} \n\telse\n\t{\n\t\tfor(b[i=1%p]=len=1;!b[i=(i*10+1)%p];b[i]=++len);\n\t\tk=len;len-=b[i]-1;\n\t\tfor(i=1%p,j=1;j<=k;i=(i*10+1)%p,j++) cnt[i]=1;\n\t\tfor(;j<=n&&j<=k+len;j++,i=(i*10+1)%p)\n\t\t{\n\t\t\tcnt[i]+=(n-j+1)/len+((n-j+1)%len!=0);\n\t\t\t(n-j)%len==0?tot=i:1;\n\t\t}\n\t}\n\ttot=(p-tot)%p;\n\tfor(inv[0]=inv[1]=1,i=2;i<=15;i++) inv[i]=1ll*(modd-modd/i)*inv[modd%i]%modd;\n\tfor(i=2;i<=15;i++) inv[i]=1ll*inv[i]*inv[i-1]%modd;\n\tfor(i=0;i<p;i++)\n\t  \tif(cnt[i])\n\t    \tfor(j=0;j<9;j++) c[i][j]=getc(cnt[i]+j-1,j);\n\tf[0][0][0]=1;\n\tif(cnt[0]) for(i=1;i<9;i++) f[0][0][i]=c[0][i];\n\tfor(i=1;i<p;i++)\n\t  \tif(cnt[i])\n\t  \t{\n\t\t\tkkz^=1;\n\t\t\tmemset(f[kkz],0,sizeof(f[kkz]));\n\t\t\tfor(j=0;j<p;j++)\n\t\t  \t\tfor(k=0;k<9;k++)\n\t\t    \t\tif(f[kkz^1][j][k])\n\t\t    \t\t\tfor(z=0;k+z<9;z++)\n\t\t    \t\t\t\tf[kkz][(j+i*z)%p][k+z]=(f[kkz][(j+i*z)%p][k+z]+1ll*f[kkz^1][j][k]*c[i][z])%modd;\n\t\t}\n\tfor(int i=0;i<9;i++) ans=(ans+f[kkz][tot][i])%modd;\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1544362617,
        "uid": 98954,
        "name": "\u4e0d\u5b58\u5728\u4e4b\u4eba",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2481 \u3010[SDOI2010]\u4ee3\u7801\u62cd\u5356\u4f1a\u3011"
    }
]
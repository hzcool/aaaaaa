[
    {
        "content": "# \u8403\u9999\u7684\u65b0\u5e74\u5bb4\u4f1a\u7b2c\u4e8c\u9898\u9898\u89e3#2\u5c01\u517d\u9d7a\u7684\u6fc0\u5149\u6e38\u620f\n## by Wy12121212\n\n[\u9898\u76ee\u94fe\u63a5](https://www.luogu.org/problemnew/show/P4278)\n\n\u9898\u610f:\u5e73\u9762\u4e0a\u6709\u4e00\u4e9b\u51f8\u591a\u8fb9\u5f62(\u4e0d\u8d85\u8fc710\u4e2a)\uff0c\u51f8\u8fb9\u5f62\u7684\u8fb9\u6570\u5747\u4e0d\u8d85\u8fc7\u4e94\u6761\uff0c\u4e14\u5f00\u59cb\u65f6\u6bcf\u4e2a\u591a\u8fb9\u5f62\u4f1a\u7ed5\u91cd\u5fc3\u987a\u65f6\u9488\u65cb\u8f6c90k\u00b0\uff0c\u73b0\u5728\u4f60\u53ef\u4ee5\u4ece\u67d0\u4e00\u7ed9\u5b9a\u70b9\u5904\u5f15\u4e00\u6761\u5c04\u7ebf\uff0c\u5c04\u7ebf\u78b0\u5230\u591a\u8fb9\u5f62\u4e00\u8fb9\u65f6\u4fbf\u4f1a\u53d1\u751f\u53cd\u5c04\u5e76\u5220\u9664\u8fd9\u6761\u8fb9\u3002\n\n\u73b0\u5728\uff0c\u4f60\u9700\u8981\u6c42\u51fa\u4f7f\u53cd\u5c04\u603b\u6b21\u6570\u6700\u63a5\u8fd1k\u7684\u6700\u5c0f\u51fa\u5c04\u89d2\u5ea6(x\u8f74\u6b63\u65b9\u5411\u4e3a0\u00b0\uff0cy\u8f74\u6b63\u65b9\u5411\u4e3a90\u00b0)\n\n\u672c\u9898\u505a\u9898\u96be\u5ea6: \u7701\u9009\uff1f\n\n\u672c\u9898\u601d\u8003\u96be\u5ea6: \u666e\u53ca+/\u63d0\u9ad8-\n\n\u8003\u67e5\u77e5\u8bc6\u70b9:\u8ba1\u7b97\u51e0\u4f55\uff0c\u7801\u529b\uff0c\u7ec6\u8282\u5904\u7406\n\n### \u6211\u5148\u8bf4\u4e00\u4e0b\u5427\uff0c\u8fd9\u9053\u9898\u786e\u5b9e\u633a\u795e\u4ed9\u7684\uff0c\u5982\u679c\u4f60\u5b9e\u5728\u4e0d\u60f3\u5199copy\u6211\u7684\u4ee3\u7801\u6211\u4e5f\u4e0d\u53cd\u5bf9\uff0c\u5f53\u7136\u5982\u679c\u4f60\u6267\u610f\u8981\u5199\u6211\u4e5f\u5f88\u8d5e\u6210qwq\n\n\u770b\u5230\u8fd9\u9053\u9898\u65f6\u4f60\u53ef\u80fd\u4f1a\u8499\u4f4f\uff0c\u6240\u4ee5\u8ba9\u6211\u4eec\u4e00\u6b65\u4e00\u6b65\u6765\u5206\u6790\u5427\n\n1.\u6c42\u91cd\u5fc3\uff1a\n\n\u5f88\u7b80\u5355\u7684\u7b2c\u4e00\u6b65\uff0c\u53ea\u8981\u628a\u591a\u8fb9\u5f62\u5212\u5206\u6210\u5f88\u591a\u4e2a\u4e09\u89d2\u5f62\u9010\u4e2a\u6c42\u5c31\u53ef\u4ee5\u4e86(\u5177\u4f53\u8be6\u89e3\u8bf7\u767e\u5ea6\uff0c\u8fd9\u91cc\u4e0d\u4f1a\u6d6a\u8d39\u592a\u591a\u7bc7\u5e45)\n\n\u8fd9\u91cc\u5c31\u662f\u7b2c\u4e00\u6b65\u7684\u4ee3\u7801\u5566:\n\n```cpp\n//\u6c42\u91cd\u5fc3\nstruct Point\n{\n    double x,y;\n    Point(double x = 0, double y = 0) : x(x),y(y) {};\n    void read()\n    {\n        scanf(\"%lf %lf\",&x,&y);\n    }\n    Point operator - (const Point &a) const\n    {\n        return Point(a.x - x, a.y - y);\n    }\n}a[1010][10],g[1010],yuanxin[1010];\n\ndouble cross(Point A, Point B)\n{\n    return A.x * B.y - A.y * B.x;\n}\n\ndouble area(Point a, Point b, Point c)\n{\n    Point A,B;\n    A=b-a;\n    B=c-a;\n    return cross(A,B);\n}\n\nfor(int _=1;_<=n;_++)\n    {\n        scanf(\"%d\",&m);\n        if(m==0)\n        {\n        \tyuanxin[_].read();\n        \tscanf(\"%lf\",&r[_]);\n        }\n        Point p0,p1,p2;\n        double sum_x,sum_y,sum_area;\n        p0.read();\n        a[_][0].x=m;\n        a[_][1]=p0;\n        p1.read();\n        a[_][2]=p1;\n        sum_x=sum_y=sum_area=0.0;\n        for(int i=2;i<m;i++)\n        {\n            p2.read();\n            a[_][i+1]=p2;\n            double tp=area(p0,p1,p2);\n            sum_x+=(p0.x+p1.x+p2.x)*tp;\n            sum_y+=(p0.y+p1.y+p2.y)*tp;\n            sum_area+=tp;\n            p1=p2;\n        }\n        Point G(sum_x/sum_area/3.0,sum_y/sum_area/3.0);\n        g[_]=G;\n    }\n```\n\n2.\u65cb\u8f6c:\n\n\u597d\u7684\u6211\u4eec\u73b0\u5728\u6709\u4e86\u6bcf\u4e2a\u591a\u8fb9\u5f62\u7684\u91cd\u5fc3g[i]\uff0c\u600e\u4e48\u5c06\u591a\u8fb9\u5f62\u65cb\u8f6c90k\u00b0\u5462\uff1f\u5176\u5b9e\u7528\u521d\u4e2d\u5168\u7b49\u4e4b\u65f6\u4fbf\u53ef\u4ee5\u8f7b\u677e\u89e3\u51b3\n\n\u7b2c\u4e8c\u6b65\u7684\u4ee3\u7801:\n```cpp\nfor(int i=1;i<=k;i++)\n{\n   double delx=a[_][j].x-g[_].x;\n   double dely=a[_][j].y-g[_].y;\n   a[_][j].x=g[_].x+dely;\n   a[_][j].y=g[_].y-delx;\n}\n```\n\n3.\u5b58\u50a8\u6bcf\u6761\u7ebf\u6bb5:\n\n\u76f4\u63a5\u5f53\u6210\u76f4\u7ebf\u5b58\u4e0b\u6765\u5c31\u53ef\u4ee5\u4e86\uff0c\u6ce8\u610f\u8fd9\u91ccx,y,x1,y1\u662f\u7aef\u70b9\uff0ca,b,c\u662f\u89e3\u6790\u53c2\u6570\n\n```cpp\nstruct lazer\n{\n    double x,y;\n    double a,b,c;\n    double x1,y1;\n    lazer(double a=0, double b=0,double c=0,double x=0,double y=0) : a(a),b(b),c(c),x(x),y(y) {};\n};\n\n            \nif(j==a[_][0].x)\n{\n    xianduan[++cnt].x=a[_][j].x;\n    xianduan[cnt].y=a[_][j].y;\n    xianduan[cnt].x1=a[_][1].x;\n    xianduan[cnt].y1=a[_][1].y;\t\t\t\t\n    xianduan[cnt].a=a[_][j].y-a[_][1].y;\n    xianduan[cnt].b=-1*(a[_][j].x-a[_][1].x);\n    xianduan[cnt].c=((a[_][j].x-a[_][1].x)*a[_][1].y)-(a[_][j].y-a[_][1].y)*a[_][1].x;\t\t\t\n}\nelse\n{\n    xianduan[++cnt].x=a[_][j].x;\n    xianduan[cnt].y=a[_][j].y;\n    xianduan[cnt].x1=a[_][j+1].x;\n    xianduan[cnt].y1=a[_][j+1].y;\t\n    xianduan[cnt].a=a[_][j].y-a[_][j+1].y;\n    xianduan[cnt].b=-1*(a[_][j].x-a[_][j+1].x);\n    xianduan[cnt].c=((a[_][j].x-a[_][j+1].x)*a[_][j+1].y)-(a[_][j].y-a[_][j+1].y)*a[_][j+1].x;\t\n}\n```\n\n4.\u5f00\u59cb\u679a\u4e3e\u6bcf\u4e2a\u89d2\u5ea6\u5c04\u51fa\u6fc0\u5149:\n\n\u7528\u4e09\u89d2\u51fd\u6570\u7b97\u51fa\u659c\u7387\u548c\u622a\u8ddd\u5c31\u53ef\u4ee5\u4e86\uff0c**\u8fd9\u91cc\u6211\u4eec\u91c7\u7528\u7aef\u70b9-\u4efb\u4e00\u70b9\u7684\u65b9\u5f0f\u5b58\u50a8\u5c04\u7ebf**\uff0c\u4f46\u662f\u6709\u4e24\u70b9\u9700\u8981\u6ce8\u610f:\n\n1.\u8c03\u7528tan\u65f6\u8981\u7528i%180\uff0c\u4e0d\u7136\u4f1a\u4e25\u91cd\u4e22\u7cbe\n\n2.\u659c\u7387\u4e0d\u5b58\u5728\u7684\u65f6\u5019\u8981\u7279\u5224(\u5199\u6cd5\u8f83\u52a3)\n\n```cpp\n    for(double i=0;i<=360.0;i+=0.01)\n    {\n    \tmemset(shoot,0,sizeof(shoot));\n        lazer st;\n        st.x=x;\n        st.y=y;\n        double u=i;\n        if(u>180)u-=180;\n        if(u!=90&&u!=270)\n        st.a=tan((u)*Pi/180),st.b=-1,st.c=(y-x*tan((u)*Pi/180));\n        else\n        {\n            st.a=1;\n            st.b=0;\n            st.c=-1*x;\n        }\n        if(i==90||i==270)\n        {\n            if(i==90)st.x1=x,st.y1=y+10;\n            else st.x1=x,st.y1=y-10;\n        }\n        else\n        {\n            if((i>=0&&i<=90)||(i>=270&&i<=360))\n            st.x1=x+10,\n            st.y1=(-st.c-st.a*st.x1)/(st.b);\n            else\n            st.x1=x-10,\n            st.y1=(-st.c-st.a*st.x1)/(st.b);\n        }\n    }\n```\n\n\n5.\u5224\u65ad\u5c04\u7ebf\u4e0e\u7ebf\u6bb5\u76f8\u4ea4\uff1a\n\n**\u91cd\u5934\u620f**\uff0c\u5f53\u7ebf\u6bb5\u4e24\u4e2a\u7aef\u70b9\u5728\u5c04\u7ebf\u5f02\u4fa7\uff0c\u4e14\u5c04\u7ebf\u7aef\u70b9\u4e0d\u4f4d\u4e8e\u4ea4\u70b9\u4e0e\u4efb\u4e00\u70b9\u4e4b\u95f4\u7684\u65f6\u5019\u5224\u65ad\u76f8\u4ea4\n\n```cpp\nPoint inter(lazer a,lazer b)\n{\n    double y=((a.a*b.c-b.a*a.c)/(b.a*a.b-a.a*b.b));\n    double x;\n    if(a.a!=0)x=(-1*a.b*y-a.c)/a.a;\n    else x=(-1*b.b*y-b.c)/b.a;\n    Point intersp(x,y);\n    return intersp;\n}\n\n\nbool updown(lazer a,Point b)\n{\n    if((-1*a.c-a.a*b.x)/a.b>b.y)return 1;\n    if((-1*a.c-a.a*b.x)/a.b<b.y)return 0;\n    return 2;\n}\n\nbool isinter(lazer a,lazer xd)\n{\n    Point tmp1(xd.x,xd.y);\n    Point tmp2(xd.x1,xd.y1);\n    if((updown(a,tmp1)^updown(a,tmp2))!=1)return 0;\n    Point tmp3=inter(a,xd);\n    if((a.x>=tmp3.x&&a.x<=a.x1)||(a.x<=tmp3.x&&a.x>=a.x1))return 0;\n    //cout<<\" \"<<tmp3.x<<\" \"<<a.x<<\" \"<<a.x1<<endl;\n    return 1;\n}\n\n```\n\n6.\u76f4\u7ebf\u53cd\u5c04\uff1a\n\n\u53d6\u5c04\u7ebf\u5173\u4e8e\u6cd5\u7ebf\u7684\u5bf9\u79f0\u70b9\uff0c\u7136\u540e\u5c06\u4ea4\u70b9\u8bbe\u4e3a\u65b0\u7684\u7aef\u70b9\uff0c\u5bf9\u79f0\u70b9\u8bbe\u4e3a\u65b0\u7684\u4efb\u4e00\u70b9\u5373\u53ef\n\n\u81f3\u4e8e\u5982\u4f55\u5bf9\u79f0\u53ca\u53cd\u5c04\u540e\u76f4\u7ebf\u7684\u65b9\u7a0b\u6700\u597d\u624b\u63a8\u4e00\u904d\u516c\u5f0f\uff0c\u4ee3\u5165\u5c31\u53ef\u4ee5\u4e86\n\n```cpp\n\nPoint sym(Point a,lazer b)\n{\n    if(b.a==0)\n    {\n        Point tmp(a.x,(-1*b.c/b.b)-(a.y-(-1*b.c/b.b)));\n        return tmp;\n    }\n    if(b.b==0)\n    {\n        Point tmp((-1*b.c/b.a)-(a.x-(-1*b.c/b.a)),a.y);\n        return tmp;\n    }\n    lazer nl(b.b,-1*b.a,b.a*a.y-b.b*a.x);\n    Point tmpp=inter(nl,b);\n    double tmpx=2*tmpp.x-a.x;\n    double tmpy=2*tmpp.y-a.y;\n    Point tmp(tmpx,tmpy);\n    return tmp;\n}\n\nlazer bounce(lazer a,lazer b)\n{\n    Point tmp1=inter(a,b);\n    if((-1*a.a/a.b)*(-1*b.a/b.b)==-1)\n    {\n        lazer nl(a.a,a.b,a.c,tmp1.x,tmp1.y);\n        return nl;\n    }\n    Point tmp2;\n    tmp2.x=a.x,tmp2.y=a.y;\n    Point tmp3;\n    if(b.a!=0&&b.b!=0)\n    {\n        lazer c(b.b/b.a,-1,tmp1.y-b.b*tmp1.x/b.a);\n        tmp3=sym(tmp2,c);\n    }\n    else \n    {\n        if(b.a==0)\n        {\n            lazer c(1,0,-1*tmp1.x);\n            tmp3=sym(tmp2,c);\n        }\n        else\n        {\n            lazer c(0,1,-1*tmp1.y);\n            tmp3=sym(tmp2,c);\n        }\n    }\n    lazer newlazer(tmp3.y-tmp1.y,-1*(tmp3.x-tmp1.x),((tmp3.x-tmp1.x)*tmp1.y)-(tmp3.y-tmp1.y)*tmp1.x,tmp1.x,tmp1.y);\n    newlazer.x1=tmp3.x;\n    newlazer.y1=tmp3.y;\n    return newlazer;\n}\n\n```\n\n7.\u6109\u5feb\u5730\u8bb0\u5f55\u7b54\u6848\uff0c\u8f93\u51fa\uff0c\u63d0\u4ea4\uff0c\u7136\u540eac\n\n\u7136\u540e\u8fd9\u662f\u5b8c\u6574\u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\nusing namespace std;\ndouble Pi=3.141592653589793238462;\nint n,m;\nint w,E;\ndouble x,y;\nint cnt;\ndouble ans;\nint res=-1;\nbool shoot[10010];\nstruct Point\n{\n    double x,y;\n    Point(double x = 0, double y = 0) : x(x),y(y) {};\n    void read()\n    {\n        scanf(\"%lf %lf\",&x,&y);\n    }\n    Point operator - (const Point &a) const\n    {\n        return Point(a.x - x, a.y - y);\n    }\n}a[1010][10],g[1010],yuanxin[1010];\n\nstruct lazer\n{\n    double x,y;\n    double a,b,c;\n    double x1,y1;\n    lazer(double a=0, double b=0,double c=0,double x=0,double y=0) : a(a),b(b),c(c),x(x),y(y) {};\n};\nlazer lastlazer;\nlazer xianduan[10010];\ndouble r[1010];\n\nPoint xianduana[10100],xianduanb[10100];\n\nPoint inter(lazer a,lazer b)\n{\n    double y=((a.a*b.c-b.a*a.c)/(b.a*a.b-a.a*b.b));\n    double x;\n    if(a.a!=0)x=(-1*a.b*y-a.c)/a.a;\n    else x=(-1*b.b*y-b.c)/b.a;\n    Point intersp(x,y);\n    return intersp;\n}\n\nPoint sym(Point a,lazer b)\n{\n    if(b.a==0)\n    {\n        Point tmp(a.x,(-1*b.c/b.b)-(a.y-(-1*b.c/b.b)));\n        return tmp;\n    }\n    if(b.b==0)\n    {\n        Point tmp((-1*b.c/b.a)-(a.x-(-1*b.c/b.a)),a.y);\n        return tmp;\n    }\n    lazer nl(b.b,-1*b.a,b.a*a.y-b.b*a.x);\n    Point tmpp=inter(nl,b);\n    double tmpx=2*tmpp.x-a.x;\n    double tmpy=2*tmpp.y-a.y;\n//\tcout<<tmpx<<\" \"<<tmpy<<endl;\n    Point tmp(tmpx,tmpy);\n    return tmp;\n}\n\nlazer bounce(lazer a,lazer b)\n{\n    Point tmp1=inter(a,b);\n//\tcout<<tmp1.x<<\" \"<<tmp1.y<<endl;\n    if((-1*a.a/a.b)*(-1*b.a/b.b)==-1)\n    {\n        lazer nl(a.a,a.b,a.c,tmp1.x,tmp1.y);\n        return nl;\n    }\n    Point tmp2;\n    tmp2.x=a.x,tmp2.y=a.y;\n    Point tmp3;\n    if(b.a!=0&&b.b!=0)\n    {\n        lazer c(b.b/b.a,-1,tmp1.y-b.b*tmp1.x/b.a);\n        tmp3=sym(tmp2,c);\n    }\n    else \n    {\n        if(b.a==0)\n        {\n            lazer c(1,0,-1*tmp1.x);\n            tmp3=sym(tmp2,c);\n        }\n        else\n        {\n            lazer c(0,1,-1*tmp1.y);\n            tmp3=sym(tmp2,c);\n        }\n    }\n    //if(a.a!=0)tmp2.x=(-1*a.b*(tmp1.y-1)-a.c)/a.a,tmp2.y=tmp1.y-1;\n    //else tmp2.y=-1*a.c/a.b,tmp2.x=tmp1.x-1;\n\n//\t\tcout<<tmp3.x<<\" \"<<tmp3.y<<endl;\n    lazer newlazer(tmp3.y-tmp1.y,-1*(tmp3.x-tmp1.x),((tmp3.x-tmp1.x)*tmp1.y)-(tmp3.y-tmp1.y)*tmp1.x,tmp1.x,tmp1.y);\n    newlazer.x1=tmp3.x;\n    newlazer.y1=tmp3.y;\n    return newlazer;\n}\n\ndouble cross(Point A, Point B)\n{\n    return A.x * B.y - A.y * B.x;\n}\n\ndouble area(Point a, Point b, Point c)\n{\n    Point A,B;\n    A=b-a;\n    B=c-a;\n    return cross(A,B);\n}\n\ndouble dist(double x1,double y1,double x2,double y2)\n{\n    return sqrt((y2-y1)*(y2-y1)+(x2-x1)*(x2-x1));\n}\n\nbool updown(lazer a,Point b)\n{\n    if((-1*a.c-a.a*b.x)/a.b>b.y)return 1;\n    if((-1*a.c-a.a*b.x)/a.b<b.y)return 0;\n    return 2;\n}\n\nbool isinter(lazer a,lazer xd)\n{\n    Point tmp1(xd.x,xd.y);\n    Point tmp2(xd.x1,xd.y1);\n    if((updown(a,tmp1)^updown(a,tmp2))!=1)return 0;\n    Point tmp3=inter(a,xd);\n    if((a.x>=tmp3.x&&a.x<=a.x1)||(a.x<=tmp3.x&&a.x>=a.x1))return 0;\n    //cout<<\" \"<<tmp3.x<<\" \"<<a.x<<\" \"<<a.x1<<endl;\n    return 1;\n}\n\nint main()\n{\n    /*double xx1,yy1,xx2,yy2;\n    double a1,b1,c1;\n    cin>>a1>>b1>>c1;\n    cin>>xx1>>yy1>>xx2>>yy2;\t\n    lazer xx(a1,b1,c1,xx1,yy1);\n    xx.x1=xx2;\n    xx.y1=yy2;\n    cin>>a1>>b1>>c1;\n    cin>>xx1>>yy1>>xx2>>yy2;\n    lazer yy(a1,b1,c1,xx1,yy1);\n    yy.x1=xx2;\n    yy.y1=yy2;\n    cout<<isinter(xx,yy);*/\n    scanf(\"%d\",&n);\n    for(int _=1;_<=n;_++)\n    {\n        scanf(\"%d\",&m);\n        if(m==0)\n        {\n        \tyuanxin[_].read();\n        \tscanf(\"%lf\",&r[_]);\n        }\n        Point p0,p1,p2;\n        double sum_x,sum_y,sum_area;\n        p0.read();\n        a[_][0].x=m;\n        a[_][1]=p0;\n        p1.read();\n        a[_][2]=p1;\n        sum_x=sum_y=sum_area=0.0;\n        for(int i=2;i<m;i++)\n        {\n            p2.read();\n            a[_][i+1]=p2;\n            double tp=area(p0,p1,p2);\n            sum_x+=(p0.x+p1.x+p2.x)*tp;\n            sum_y+=(p0.y+p1.y+p2.y)*tp;\n            sum_area+=tp;\n            p1=p2;\n        }\n        Point G(sum_x/sum_area/3.0,sum_y/sum_area/3.0);\n        g[_]=G;\n    }\n    for(int _=1;_<=n;_++)\n    {\n    \tint k;\n    \tscanf(\"%d\",&k);\n    \tif(r[_]!=0)continue;\n        for(int j=1;j<=a[_][0].x;j++) \t\n    \t{\n    \t\tfor(int i=1;i<=k;i++)\n    \t\t{\n    \t\t\tdouble delx=a[_][j].x-g[_].x;\n            \tdouble dely=a[_][j].y-g[_].y;\n            \ta[_][j].x=g[_].x+dely;\n            \ta[_][j].y=g[_].y-delx;\n            }\n            //cout<<a[_][j].x<<\" \"<<a[_][j].y<<endl;\n            if(j==a[_][0].x)\n            {\n                xianduan[++cnt].x=a[_][j].x;\n                xianduan[cnt].y=a[_][j].y;\n                xianduan[cnt].x1=a[_][1].x;\n                xianduan[cnt].y1=a[_][1].y;\t\t\t\t\n                xianduan[cnt].a=a[_][j].y-a[_][1].y;\n                xianduan[cnt].b=-1*(a[_][j].x-a[_][1].x);\n                xianduan[cnt].c=((a[_][j].x-a[_][1].x)*a[_][1].y)-(a[_][j].y-a[_][1].y)*a[_][1].x;\t\t\t\n            }\n            else\n            {\n                xianduan[++cnt].x=a[_][j].x;\n                xianduan[cnt].y=a[_][j].y;\n                xianduan[cnt].x1=a[_][j+1].x;\n                xianduan[cnt].y1=a[_][j+1].y;\t\n                xianduan[cnt].a=a[_][j].y-a[_][j+1].y;\n                xianduan[cnt].b=-1*(a[_][j].x-a[_][j+1].x);\n                xianduan[cnt].c=((a[_][j].x-a[_][j+1].x)*a[_][j+1].y)-(a[_][j].y-a[_][j+1].y)*a[_][j+1].x;\t\n            }\n                //xianduan[j]\n        }\n    }\n    scanf(\"%d%d\",&w,&E);\n    scanf(\"%lf%lf\",&x,&y);\n    for(double i=0;i<=360.0;i+=0.01)\n    {\n    \tmemset(shoot,0,sizeof(shoot));\n        lazer st;\n        st.x=x;\n        st.y=y;\n        double u=i;\n        if(u>180)u-=180;\n        if(u!=90&&u!=270)\n        st.a=tan((u)*Pi/180),st.b=-1,st.c=(y-x*tan((u)*Pi/180));\n        else\n        {\n            st.a=1;\n            st.b=0;\n            st.c=-1*x;\n        }\n        if(i==90||i==270)\n        {\n            if(i==90)st.x1=x,st.y1=y+10;\n            else st.x1=x,st.y1=y-10;\n        }\n        else\n        {\n            if((i>=0&&i<=90)||(i>=270&&i<=360))\n            st.x1=x+10,\n            st.y1=(-st.c-st.a*st.x1)/(st.b);\n            else\n            st.x1=x-10,\n            st.y1=(-st.c-st.a*st.x1)/(st.b);\n        }\n        bool flag=0;\n        int cntt=0;\n        do\n        {\n            flag=0;\n            double minx=100000000;\n            int hehe=1;\n            for(int j=1;j<=cnt;j++)\n            {\n                if(!shoot[j]&&isinter(st,xianduan[j]))\n                {\n                    flag=1;\n                    Point tmmp=inter(st,xianduan[j]);\n                    if(minx>dist(tmmp.x,tmmp.y,st.x,st.y))\n                    {\n                        minx=dist(tmmp.x,tmmp.y,st.x,st.y);\n                        hehe=j;\n                    }\n                }\t\t\t\t\n            }\t\n            if(flag==0)break;\n            shoot[hehe]=1;\n            cntt++;\n            st=bounce(st,xianduan[hehe]);\n            //cout<<hehe<<\" \"<<endl;\n            //cout<<st.a<<\" \"<<st.b<<\" \"<<st.c<<endl; \n            //cout<<st.x<<\" \"<<st.y<<\" \"<<st.x1<<\" \"<<st.y1<<endl;\n        }\n        while(1);\n        if(abs(w*cntt-E)<res||res==-1)\n        {\n        \tres=abs(w*cntt-E);\n        \tans=i;\n    \t}\n        //if(cntt!=0)cout<<i<<\" \"<<cntt<<endl,getchar();\n    }\n    printf(\"%.2lf\\n\",ans);\n    return 0;\n}\n/*\n2\n4\n0 0\n0 4\n4 4\n4 0\n3\n8 0\n12 4\n12 0\n0 0\n1 2\n5 5\n*/\n\n```\n\n\u5982\u679c\u4f60\u6709\u4efb\u4f55\u95ee\u9898\uff0c\u8bf7\u52a0\u5165**\u6211\u7684\u56e2\u961f**\u53d1\u5e16\u63d0\u95ee\u6216\u8005\u52a0\u6211\u7684qq\uff0c\u79c1\u4fe1\u6211\u53ef\u80fd\u770b\u4e0d\u89c1",
        "postTime": 1520681401,
        "uid": 49662,
        "name": "Wy12121212",
        "ccfLevel": 0,
        "title": "\u8403\u9999\u7684\u65b0\u5e74\u5bb4\u4f1a\u7b2c\u4e8c\u9898\u9898\u89e3#2\u5c01\u517d\u9d7a\u7684\u6fc0\u5149\u6e38\u620f"
    },
    {
        "content": "\u672c\u9898\u7684\u5927\u90e8\u5206\u5185\u5bb9\u5728 [@Wy12121212](https://www.luogu.com.cn/user/49662#main) \u7684\u53e6\u4e00\u7bc7\u9898\u89e3\u4e2d\u5df2\u7ecf\u89e3\u6790\u5f97\u5f88\u6e05\u695a\u4e86\u3002\n\n\u6545\u672c\u9898\u89e3\u4ec5\u5bf9\u53e6\u4e00\u7bc7\u9898\u89e3\u7684\u7b2c 5\u30016 \u90e8\u5206\u4f5c\u66f4\u8fdb\u4e00\u6b65\u7684\u8ba8\u8bba\u3002\n\n# \u6b63\u6587\n\n\u8003\u8651\u5230\u4ee3\u7801\u7684\u7b80\u6d01\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u50a8\u5b58\u4ece\u5c04\u7ebf\u7aef\u70b9\u5230\u5c04\u7ebf\u4e0a\u53e6\u4e00\u70b9\u7684\u5411\u91cf\uff0c\u4ee5\u6b64\u6765\u50a8\u5b58\u6fc0\u5149\u5c04\u7ebf\uff0c\u5e76\u5229\u7528\u5411\u91cf\u7684\u76f8\u5173\u8ba1\u7b97\u6a21\u62df\u5149\u7ebf\u88ab\u53cd\u5c04\u7684\u8fc7\u7a0b\u3002\n\n### 5. \u5224\u65ad\u6fc0\u5149\u5c04\u7ebf\u4e0e\u7ebf\u6bb5\u7684\u76f8\u4ea4\uff1a\n\n\u8003\u8651\u4ece\u5c04\u7ebf\u7aef\u70b9\u5411\u7ebf\u6bb5\u7684\u4e24\u4e2a\u7aef\u70b9\u5206\u522b\u4f5c\u4e24\u4e2a\u65b0\u5411\u91cf\uff08\u4ee5\u4e0b\u5206\u522b\u79f0 $\\overrightarrow{v_1}$ \u548c $\\overrightarrow{v_2}$\uff09\uff0c\u5e76\u5c1d\u8bd5\u5c06\u6fc0\u5149\u7684\u65b9\u5411\u5411\u91cf\uff08\u4e0a\u6587\u8bf4\u7684\u50a8\u5b58\u65b9\u5f0f\uff0c\u4ee5\u4e0b\u79f0 $\\overrightarrow{L}$\uff09\u5c1d\u8bd5\u5206\u89e3\u4e3a\u4e24\u4e2a\u4e0e $\\overrightarrow{v_1}$\u3001$\\overrightarrow{v_2}$ \u5206\u522b\u5171\u7ebf\u7684\u5411\u91cf\uff0c\u4e5f\u5c31\u662f\u8ba1\u7b97 $k_1\\overrightarrow{v_1}+k_2\\overrightarrow{v_2}=\\overrightarrow{L}$\u3002\n\n\u663e\u7136\uff0c\u6839\u636e\u5411\u91cf\u52a0\u6cd5\u7684\u5e73\u884c\u56db\u8fb9\u5f62\u6cd5\u5219\uff0c$\\overrightarrow{L}$ \u5fc5\u5b9a\u5904\u4e8e $k_1\\overrightarrow{v_1}$ \u4e0e $k_2\\overrightarrow{v_2}$ \u4e4b\u95f4\u3002\n\n\u6240\u4ee5\u82e5 $k_1>0$ \u4e14 $k_2>0$\uff0c\u5c31\u610f\u5473\u7740\u6fc0\u5149\u5c04\u7ebf\u4e0e\u8be5\u7ebf\u6bb5\u6709\u4ea4\u70b9\u3002\n\n\u5229\u7528\u5411\u91cf\u7684\u5750\u6807\u8868\u793a\uff0c\u95ee\u9898\u53d8\u6210\u4e86\u8ba1\u7b97 $k_1$\u3001$k_2$\uff0c\u4f7f\u5176\u6ee1\u8db3\uff1a\n\n$$\\begin{cases}k_1x_1+k_2x_2=x_L\\\\k_1y_1+k_2y_2=y_L\\end{cases}$$\n\n\u6613\u5f97\uff1a\n\n$$\\begin{cases}k_1=\\dfrac{x_Ly_2-y_Lx_2}{x_1y_2-y_1x_2}=\\dfrac{\\overrightarrow{L} \\times\\overrightarrow{v_2}}{\\overrightarrow{v_1}\\times\\overrightarrow{v_2}}\\\\k_2=\\dfrac{x_Ly_1-y_Lx_1}{x_2y_1-y_2x_1}=\\dfrac{\\overrightarrow{L} \\times\\overrightarrow{v_1}}{\\overrightarrow{v_2}\\times\\overrightarrow{v_1}}\\end{cases}$$\n\n\u53c8\u56e0\u4e3a\u5bf9\u4e8e\u540c\u4e00\u76f4\u7ebf\u4e0a\u4efb\u610f\u4e09\u70b9 $a$\u3001$b$\u3001$c$ \u548c\u76f4\u7ebf\u5916\u4e00\u70b9 $O$ \u6709\uff1a\n\n$$\\lambda\\overrightarrow{Oa}+(1-\\lambda)\\overrightarrow{Oc}=\\overrightarrow{Ob}$$\n\n\u6240\u4ee5\u5c06\u5f97\u5230\u7684 $k_1\\overrightarrow{v_1}+k_2\\overrightarrow{v_2}=\\overrightarrow{L}$\uff0c\u7b49\u5f0f\u4e24\u8fb9\u540c\u65f6\u4e58 $\\frac{1}{k_1+k_2}$\uff0c\u8f6c\u5316\u6210\u4e0a\u9762\u7684\u5f62\u5f0f\uff0c\u5f97\u5230\u7684\u5411\u91cf $\\frac{1}{k_1+k_2}\\overrightarrow{L}$ \u5c31\u662f\u4ece\u5c04\u7ebf\u7aef\u70b9\u6307\u5411\u4ea4\u53c9\u70b9\u7684\u5411\u91cf\u4e86\u3002\n\n\u800c\u5728\u6709\u591a\u6761\u7ebf\u6bb5\u53ef\u80fd\u4e0e\u6fc0\u5149\u5c04\u7ebf\u76f8\u4ea4\u7684\u65f6\u5019\uff0c\u5f88\u660e\u663e\uff0c$k_1+k_2$ \u6700\u5927\u7684\uff0c\u624d\u662f**\u5b9e\u9645\u4e0a**\u4ea7\u751f\u4ea4\u70b9\u7684\u90a3\u6761\u7ebf\u6bb5\u3002\n\n### 6. \u8ba1\u7b97\u53cd\u5c04\n\n\u6211\u4eec\u5df2\u7ecf\u6c42\u51fa\u4e86\u4ece\u5c04\u7ebf\u7aef\u70b9\u5230\u4ea4\u53c9\u70b9\u7684\u5411\u91cf\uff08\u5373\u5165\u5c04\u5411\u91cf\uff0c\u4ee5\u4e0b\u79f0 $\\vec{i}$\uff09,\u8fd9\u4e4b\u540e\u6211\u4eec\u5c31\u8981\u6c42\u51fa\u5b83\u5173\u4e8e\u4ea7\u751f\u4ea4\u70b9\u7684\u7ebf\u6bb5\u5bf9\u79f0\u7684\u53cd\u5c04\u5411\u91cf\uff08\u4ee5\u4e0b\u5206\u522b\u79f0 $\\vec{m}$ \u548c $\\vec{r}$\uff09\uff0c\u6211\u4eec\u628a\u7ebf\u6bb5\u4e5f\u7528\u5411\u91cf\u8868\u793a\uff0c\u5c3d\u7ba1\u5b83\u4eec\u7684\u65b9\u5411\u6ca1\u6709\u4efb\u4f55\u610f\u4e49\u3002\n\n\u753b\u4e00\u4e0b\u56fe\u4ed4\u7ec6\u89c2\u5bdf\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5165\u5c04\u5411\u91cf\u4e0e\u53cd\u5c04\u5411\u91cf\u7684\u4e24\u4e2a\u6027\u8d28\uff1a\n\n1. \u4e24\u5411\u91cf\u7684\u957f\u5ea6\u76f8\u7b49\u3002\n2. \u5165\u5c04\u5411\u91cf\u8d77\u70b9\u5230\u53cd\u5c04\u5411\u91cf\u7ec8\u70b9\u7684\u8fde\u7ebf\u4e0e $\\overrightarrow{M}$ \u5e73\u884c\u3002\n\n\u5373\uff1a\n\n$$\\begin{cases}\\left|\\overrightarrow{r}\\right|=\\left|\\overrightarrow{i}\\right|\\\\(\\overrightarrow{i}+\\overrightarrow{r})\\times\\overrightarrow{m}=0\\end{cases}$$\n\n\u7528\u5411\u91cf\u7684\u5750\u6807\u8868\u793a\u5c31\u662f\uff1a\n\n$$\\begin{cases}\\sqrt{r^2_x+r^2_y}=\\sqrt{i^2_x+i^2_y}\\\\x_iy_m-y_ix_m+x_ry_m-y_rx_m=0\\end{cases}$$\n\n\u4e0b\u9762\u5927\u6982\u8bf4\u4e00\u4e0b\u8fc7\u7a0b\uff1a\n\n\u9996\u5148\uff0c\u5728\u4e24\u5f0f\u4e2d\u5206\u522b\u8868\u793a\u51fa $y_r$\uff0c\u8fd9\u6837\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$\\sqrt{x^2_i+y^2_i-x^2_r}=\\frac{y_m}{x_m}(x_i+x_r)-y_i$$\n\n\u4e24\u8fb9\u5e73\u65b9\uff0c\u5f97\uff1a\n\n$$x^2_i-x^2_r+y^2_i=\\frac{y^2_m}{x^2_m}(x_i+x_r)^2-2\\frac{y_m}{x^m}(x_i+x_r)y_i+y^2_i$$\n\n\u5316\u7b80\uff0c\u5f97\uff1a\n\n$$x_i-x_r=\\frac{y^2_m}{x^2_m}(x_i+x_r)-2\\frac{y_m}{x_m}y_i$$\n\n\u5de6\u53f3\u4e24\u8fb9\u540c\u65f6\u4e58 $x^2_m$ \u5f97\uff1a\n\n$$x^2_mx_i-x^2_mx_r=y^2_mx_i+y^2_mx_r-2x_my_my_i$$\n\n\u6574\u7406\uff0c\u5f97\uff1a\n\n$$x_r=\\dfrac{(x^2_m-y^2_m)x_i+2x_my_my_i}{x^2_m+y^2_m}$$\n\n$y_r$ \u53ef\u4ee5\u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\u8ba1\u7b97\u51fa\uff0c\u6700\u7ec8\u5f97\uff1a\n\n$$\\begin{cases}x_r=\\dfrac{(x^2_m-y^2_m)x_i+2x_my_my_i}{x^2_m+y^2_m}\\\\y_r=\\dfrac{(y^2_m-x^2_m)y_i+2x_my_mx_i}{x^2_m+y^2_m}\\end{cases}$$\n\n\u6240\u4ee5\uff0c\u53cd\u5c04\u5411\u91cf\u7684\u8d77\u70b9\u5c31\u662f\u4ea4\u53c9\u70b9\uff0c\u7ec8\u70b9\u5219\u7531\u4ea4\u53c9\u70b9\u7684 $x$\u3001$y$ \u5750\u6807\u5206\u522b\u52a0\u4e0a $x_r$ \u548c $y_r$ \u5f97\u5230\n\n#### \u5b8c\n\n\u6700\u540e\u8d34\u4e00\u4e0b\u6211\u5173\u4e8e\u8fd9\u4e24\u4e2a\u90e8\u5206\u5b9e\u73b0\u7684\u4ee3\u7801\uff1a\n```cpp\nstruct node{\n\tdouble x,y;\n\tnode(){}\n\tnode(double a,double b){\n\t\tx=a;\n\t\ty=b;\n\t}\n\tnode operator = (node obj){\n\t\tx=obj.x;\n\t\ty=obj.y;\n\t\treturn *this;\n\t}\n\tbool operator != (node obj){\n\t\treturn x!=obj.x||y!=obj.y;\n\t}\n};\nstruct vect{\n\tnode from,to;\n\tvect(){}\n\tvect(node a,node b){\n\t\tfrom=a;\n\t\tto=b;\n\t}\n\tvect(double fx,double fy,double tx,double ty){\n\t\tfrom=node(fx,fy);\n\t\tto=node(tx,ty);\n\t}\n\tinline double len_x(){\n\t\treturn to.x-from.x;\n\t}\n\tinline double len_y(){\n\t\treturn to.y-from.y;\n\t}\n\tinline vect operator / (double lamda){\n\t\treturn vect(from,node(len_x()/lambda+from.x,len_y()/lambda+from.y));\n\t}\n\tinline double operator ^ (vect obj){\n\t\treturn len_x()*obj.len_y()-len_y()*obj.len_x();\n\t}\n\tpair<node,double> cross_point(vect obj){\n\t\tvect v1(from,obj.from),v2(from,obj.to);\n\t\tif((v1^v2)==0)return make_pair(from,0.0);\n\t\tdouble k1=(*this^v2)/(v1^v2),k2=(*this^v1)/(v2^v1);\n\t\tif(k1>0.0&&k2>0.0)return make_pair((*this/(k1+k2)).to,k1+k2);\n\t\treturn make_pair(from,0.0);\n\t}\n\tvect specular(vect obj){\n\t\tdouble x_f=(obj.len_x()*obj.len_x()-obj.len_y()*obj.len_y())*len_x()+2*obj.len_x()*obj.len_y()*len_y();\n\t\tx_f/=(obj.len_x()*obj.len_x()+obj.len_y()*obj.len_y());\n\t\tdouble y_f=(obj.len_y()*obj.len_y()-obj.len_x()*obj.len_x())*len_y()+2*obj.len_x()*obj.len_y()*len_x();\n\t\ty_f/=(obj.len_x()*obj.len_x()+obj.len_y()*obj.len_y());\n\t\treturn vect(to,node(to.x+x_f,to.y+y_f));\n\t}\n}now,line[70];\n```\n\u4ee5\u53ca\u4e3b\u51fd\u6570\u4e2d\u7684\n```cpp\nbool flag=false;\ndouble maxx=0.0;\nnode minod;\nint minpos;\nwhile(!flag){\n\tflag=true;\n\tmaxx=0.0;\n\tfor(int i=1;i<=cnt;i++){\n\t\tif(!vis[i]){\n\t\t\tT=now.cross_point(line[i]);\n\t\t\tif(T.first!=now.from&&T.second>maxx)minod=T.first,maxx=T.second,minpos=i,flag=false;\n\t\t}\n\t}\n\tif(!flag){\n\t\tvis[minpos]=1;\n\t\tnow=vect(now.from,minod).specular(line[minpos]);\n\t\tendd++;\n\t}\n}\nif(abs(E-w*endd)<abs(E-w*nearliest))nearliest=endd,ans=sta;\n```\n\n",
        "postTime": 1684491031,
        "uid": 185183,
        "name": "\u5fa1\u574217379\u53f7",
        "ccfLevel": 0,
        "title": "P4276"
    }
]
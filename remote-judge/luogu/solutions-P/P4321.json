[
    {
        "content": "## [\u9898\u610f](https://blog.csdn.net/benoble_/article/details/79794581)\n\n\u7ed9\u4f60\u4e00\u5e45\u56fe,\u6bcf\u6b21\u7ed9\u4f60\u4e00\u4e2a\u70b9$u$\u548c\u4e00\u4e2a\u70b9\u96c6$S$\n\n\u95ee\u4ece$u$\u51fa\u53d1\u8d70\u5b8c$S$\u96c6\u5408(\u5373$S$\u5185\u70b9\u90fd\u81f3\u5c11\u7ecf\u8fc7\u4e00\u6b21)\u7684\u671f\u671b\u6b65\u6570\t\n\n\u4e00\u4e2a\u70b9$u$\u4f1a\u7b49\u6982\u7387\u5730\u8d70\u5411\u5176\u76f8\u90bb\u7684\u70b9\n\n--- \n\n## \u9898\u89e3\n\n\u8fd9\u73a9\u610f\u662f$PKUWC2018D2T3$\u968f\u673a\u6e38\u8d70\u7684\u52a0\u5f3a\u7248\n\n\u601d\u8def\u548c[[HNOI2013]\u6e38\u8d70](https://blog.csdn.net/benoble_/article/details/79755665)\u7c7b\u4f3c,\u4e5f\u662f\u901a\u8fc7\u9ad8\u65af\u6d88\u5143\u6765$DP$\n\n\u8003\u8651\u8bbe$f[S][i]$\u8868\u793a\u8d70\u5b8c$S$\u96c6\u5408,\u5f53\u524d\u5728\u70b9$i$,\u7136\u540e\u8981\u628a\u5269\u4e0b\u7684\u6240\u6709\u70b9\u90fd\u8d70\u5b8c\u7684\u671f\u671b\u6b65\u6570\n\n\u53ef\u4ee5\u53d1\u73b0,\u5982\u679c\u8be2\u95ee\u7684\u662f$u,S$\u90a3\u4e48\u5bf9\u5e94\u7684$f$\u503c\u5c31\u662f$f[all-S][u]$\n\n\u5c31\u662f\u76f8\u5f53\u4e8e\u628a$S$\u7684\u8865\u96c6\u90fd\u8d70\u5b8c\u4e86,\u7136\u540e\u73b0\u5728\u518d\u4ece$u$\u628a$S$\u8d70\u5b8c\u7684\u671f\u671b\n\n\u8fd9\u6837\u5982\u679c\u9884\u5904\u7406\u51fa$f,$\u6bcf\u4e2a\u8be2\u95ee\u5c31\u53ef\u4ee5$O(1)$\u56de\u7b54\u4e86\n\n>\u8fd9\u91cc\u6709\u4e2a\u5c0f$trick$\u5c31\u662f\u5982\u679c$u\\in S$\u8fd9\u6837\u5c31\u9519\u4e86,\u56e0\u4e3a$u\\notin all-S$\n\n>\u6240\u4ee5\u5bf9\u5e94\u8981\u6c42\u7684\u7b54\u6848\u5e94\u8be5\u662f$f[(all-S)|u][u]$\n\n\u8003\u8651\u600e\u4e48\u6c42\u51fa$f[S][u]$,\u521d\u503c$f[all]=0$\n\n>$flag:$\u6240\u4ee5\u8fd9\u73a9\u610f\u6015\u4e0d\u662f\u8981\u5012\u63a8\n\n\u548c\u6e38\u8d70\u4e00\u6837\u5217\u5f0f,$d_u$\u8868\u793a$u$\u7684\u70b9\u5ea6\n\n$$f[S][u]=\\frac1{d_u}\\sum_{u\\to v\\in E}f[S|v][v]+1$$\n\n\u8003\u8651\u66b4\u529b\u7684\u8bdd\u5c31\u662f\u7528\u9ad8\u65af\u6d88\u5143\u89e3\u8fd9$n2^n$\u4e2a\u65b9\u7a0b$,$\u590d\u6742\u5ea6$O((n2^n)^3)$\n\n\u8fd9\u6837\u663e\u7136\u662f\u4e0d\u884c\u7684\n\n\u8003\u8651\u5230\u8981\u4e48$S\\subset S|v,$\u8981\u4e48$S=S|v,$\u5373$v\\in S$\n\n\u6211\u4eec\u628a\u65b9\u7a0b\u5206\u5f00\u4e00\u4e0b\n\n$$f[S][u]=\\frac1{d_u}[\\sum_{u\\to v\\in E,v\\in S}f[S][v]+\\sum_{u\\to v\\in E,v\\notin S}f[S|v][v]]+1$$\n\n$$f[S][u]-\\frac1{d_u}\\sum_{u\\to v\\in E,v\\in S}f[S][v]=\\frac1{d_u}\\sum_{u\\to v\\in E,v\\notin S}f[S|v][v]+1$$\n\n\u4e5f\u5c31\u662f\u8bf4,\u5982\u679c\u6211\u4eec\u77e5\u9053$f[S|v]$\u7684$DP$\u503c\u90a3\u4e48\u6211\u4eec\u6bcf\u4e2a\u72b6\u6001\u5c31\u53ea\u8981\u5217$n$\u4e2a\u65b9\u7a0b\n\n\u6240\u4ee5\u6309\u7167\u96c6\u5408\u5927\u5c0f\u5012\u63a8,\u7136\u540e\u6bcf\u4e2a\u72b6\u6001\u5217$n$\u4e2a\u65b9\u7a0b\u5373\u53ef\n\n\u590d\u6742\u5ea6$O(n^32^n+\\sum n_i)$\n\n```\n#include<bits/stdc++.h>\n#define fp(i,a,b) for(register int i=a,I=b+1;i<I;++i)\n#define fd(i,a,b) for(register int i=a,I=b-1;i>I;--i)\n#define go(u) for(register int i=fi[u],v=e[i].to;i;v=e[i=e[i].nx].to)\n#define file(s) freopen(s\".in\",\"r\",stdin),freopen(s\".out\",\"w\",stdout)\ntemplate<class T>inline bool cmax(T&a,const T&b){return a<b?a=b,1:0;}\ntemplate<class T>inline bool cmin(T&a,const T&b){return a>b?a=b,1:0;}\nusing namespace std;\nchar ss[1<<17],*A=ss,*B=ss;\ninline char gc(){return A==B&&(B=(A=ss)+fread(ss,1,1<<17,stdin),A==B)?-1:*A++;}\ntemplate<class T>inline void sd(T&x){\n    char c;T y=1;while(c=gc(),(c<48||57<c)&&c!=-1)if(c==45)y=-1;x=c-48;\n    while(c=gc(),47<c&&c<58)x=x*10+c-48;x*=y;\n}\nchar sr[1<<21],z[20];int C=-1,Z;\ninline void Ot(){fwrite(sr,1,C+1,stdout),C=-1;}\ntemplate<class T>inline void we(T x){\n    if(C>1<<20)Ot();if(x<0)sr[++C]=45,x=-x;\n    while(z[++Z]=x%10+48,x/=10);\n    while(sr[++C]=z[Z],--Z);sr[++C]='\\n';\n}\nconst int N=19,S=1<<N,P=998244353;\ntypedef int arr[N];\ntypedef long long ll;\nint n,m,all,f[S][N];arr e,dg,id,pos,inv,ans,Mi,G[N];\ninline int fpm(int a,int b){int x=1;for(;b;b>>=1,a=(ll)a*a%P)if(b&1)x=(ll)x*a%P;return x;}\ninline int pls(int a,int b){return a+=b,a<P?a:a-P;}\ninline int sub(int a,int b){return a-=b,a<0?a+P:a;}\ninline void Gauss(int n){\n    int mx,t,x;\n    fp(i,1,n)fp(j,1,n)G[i][j]=pls(G[i][j],P);\n    fp(i,1,n){mx=i;\n        fp(j,i,n)if(G[mx][i]<G[j][i])mx=j;\n        if(mx^i)fp(j,i,n+1)swap(G[mx][j],G[i][j]);\n        x=fpm(G[i][i],P-2);\n        fp(j,i+1,n){\n            t=(ll)x*G[j][i]%P;\n            fp(k,i,n+1)G[j][k]=sub(G[j][k],(ll)t*G[i][k]%P);\n        }\n    }\n    fd(i,n,1){\n        fp(j,i+1,n)G[i][n+1]=sub(G[i][n+1],(ll)ans[j]*G[i][j]%P);\n        ans[i]=(ll)G[i][n+1]*fpm(G[i][i],P-2)%P;\n    }\n}\nint main(){\n    #ifndef ONLINE_JUDGE\n        file(\"s\");\n    #endif\n    sd(n),sd(m);all=(1<<n)-1;int u,v;\n    Mi[1]=1;fp(i,2,n)Mi[i]=Mi[i-1]<<1;\n    inv[1]=1;fp(i,2,n)inv[i]=(ll)(P-P/i)*inv[P%i]%P;\n    while(m--)sd(u),sd(v),e[u]|=Mi[v],e[v]|=Mi[u],++dg[u],++dg[v];\n    fd(s,all-1,1){\n        int Cnt=0,x,p;\n        fp(i,1,n)if(s&Mi[i])id[pos[i]=++Cnt]=i;\n        fp(i,1,Cnt){fp(j,1,Cnt)G[i][j]=0;ans[i]=0;}\n        fp(i,1,n)if(s&Mi[i]){\n            x=inv[dg[i]],p=pos[i];G[p][p]=1,G[p][Cnt+1]=1;\n            fp(j,1,n)if(e[i]&Mi[j]){\n                if(s&Mi[j])G[p][pos[j]]-=x;\n                else G[p][Cnt+1]=pls(G[p][Cnt+1],(ll)x*f[s|Mi[j]][j]%P);\n            }\n        }\n        Gauss(Cnt);\n        fp(i,1,Cnt)f[s][id[i]]=ans[i];\n    }\n    sd(m);\n    while(m--){\n        static int s;sd(s);u=0;\n        while(s--)sd(v),u|=Mi[v];sd(v);\n        we(f[(all^u)|Mi[v]][v]);\n    }\nreturn Ot(),0;\n}\n```",
        "postTime": 1522672005,
        "uid": 20156,
        "name": "Kelin",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P4321 \u3010\u968f\u673a\u6f2b\u6e38\u3011"
    },
    {
        "content": "**\u9898\u76ee\u5206\u6790**\n\n\u8fd9\u662f\u4e00\u9053\u6c42\u671f\u671b\u7684\u9898\uff0c\u76f4\u63a5\u8003\u8651\u4ece $x$ \u51fa\u53d1\u8d70\u5b8c\u70b9\u96c6 $S$ \u671f\u671b\u7684\u6b65\u6570\u4f3c\u4e4e\u4e0d\u592a\u597d\u8f6c\u79fb\uff08\u4e5f\u53ef\u80fd\u662f\u6211\u592a\u5f31qwq\uff09\u3002\n\n\u8003\u8651\u9006\u5411\u8bbe\u8ba1\u72b6\u6001\u3002\u8bbe $f_{S,x}$ \u8868\u793a**\u5df2\u7ecf\u904d\u5386\u8fc7\u4e86 $S$ \u96c6\u5408\uff0c\u5f53\u524d\u5728\u70b9 $x$ \u65f6\u8981\u904d\u5386\u5b8c\u6574\u4e2a\u56fe\u671f\u671b\u8d70\u7684\u6b65\u6570**\u3002\u90a3\u4e48\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\u7684\u70b9\u96c6\uff0c\u6211\u4eec\u8bbe\u5b83\u7684\u8865\u96c6\u4e3a $A$\uff0c$f_{A|s,s}$ \u5c31\u662f\u6211\u4eec\u6240\u6c42\u7684\u7b54\u6848\uff0c\u56e0\u4e3a\u6211\u4eec\u4ece $A$ \u96c6\u5408\u5230\u5168\u90e8\u8d70\u5b8c\u521a\u597d\u628a\u8be2\u95ee\u7684\u70b9\u5168\u90e8\u8d70\u4e86\u4e00\u6b21\u3002\n\n\u8fd9\u4e2a\u72b6\u6001\u7684\u8f6c\u79fb\u65b9\u7a0b\u8fd8\u662f\u5f88\u597d\u60f3\u7684\uff0c\u5982\u679c\u5f53\u524d\u5728\u70b9 $x$\uff0c\u8017\u8d39\u4e00\u6b65\u8d70\u5230 $v$ \u540e\u5c31\u662f\u4ece $v$ \u5f00\u59cb\u8d70\u5b8c\u6574\u4e2a\u56fe\u7684\u671f\u671b\u6b65\u6570\u4e86\uff0c\u4e8e\u662f\u53ef\u4ee5\u5217\u51fa\u4e0b\u5217\u65b9\u7a0b\uff1a\n\n$$\nf_{S,x}=\\frac{1}{deg_x}\\times\\sum\\limits_{(u,v)\\in G}f_{S|v,v}+1\n$$\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u72b6\u6001\u7684\u8f6c\u79fb\u6210\u73af\u4e86\uff0c\u867d\u7136\u9ad8\u65af\u6d88\u5143\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u4f46\u662f\u5982\u679c\u76f4\u63a5\u5bf9**\u6240\u6709\u72b6\u6001**\u8fdb\u884c\u9ad8\u65af\u6d88\u5143\uff0c\u590d\u6742\u5ea6 $O((n\\times2^n)^3)$\uff0c\u660e\u663e\u4f1a T \u98de\uff0c\u9700\u8981\u8003\u8651\u4f18\u5316\u3002\n\n\u8fdb\u4e00\u6b65\u89c2\u5bdf\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u53ef\u4ee5\u53d1\u73b0 $S$ \u4e00\u5b9a\u662f\u88ab\u5305\u542b\u5728 $S|v$ \u91cc\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u4e00\u4e2a\u72b6\u6001\u53ea\u80fd\u7531\u4e00\u4e2a\u70b9\u96c6\u4e0d\u5c0f\u4e8e\u8be5\u72b6\u6001\u7684\u72b6\u6001\u8f6c\u79fb\u800c\u6765\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5bf9\u72b6\u6001\u8fdb\u884c\u5206\u5c42\uff0c\u4ece\u5927\u5230\u5c0f\u5728**\u6bcf\u4e2a\u70b9\u96c6\u5185\u90e8**\u5206\u522b\u8fdb\u884c\u9ad8\u65af\u6d88\u5143\uff0c\u590d\u6742\u5ea6 $O(2^n\\times n^3)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\n\n**\u4ee3\u7801**\n\n```cpp\n#include<cstdio>\n#include<iostream>\n\nconst int N=21,M=N*(N-1)*2,mod=998244353;\n\ninline int read()\n{\n    int v=0;char ch=getchar();\n    while('0'>ch||ch>'9') ch=getchar();\n    while('0'<=ch&&ch<='9') v=v*10+(ch^48),ch=getchar();\n    return v;\n}\n\ninline int get(int x) {return 1<<(x-1);}\ninline int Add(int x,int y) {return x+=y-mod,x+=(x>>31)&mod,x;}\ninline int Mul(int x,int y) {return 1ll*x*y%mod;}\n\ninline int qp(int a,int k)\n{\n    int base=1;\n    while(k)\n    {\n        if(k&1) base=Mul(base,a);\n        a=Mul(a,a),k>>=1;\n    }\n    return base;\n}\n\nint n,m,q,all;\n\nint cnt,deg[N],first[N],nxt[M<<1],to[M<<1];\ninline void add(int u,int v)\n{\n    deg[u]++,deg[v]++;\n    to[++cnt]=v,nxt[cnt]=first[u],first[u]=cnt;\n    to[++cnt]=u,nxt[cnt]=first[v],first[v]=cnt;\n}\n\nint f[1<<N][N],mat[N][N];\nint dfn[N],idf[N];\n\ninline void gauss(int n,int S)\n{\n    for(int i=1;i<=n;i++)\n    {\n        int u=i;for(int j=i+1;j<=n;j++) u=mat[j][i]>mat[u][i]? j:u;\n        for(int j=1;j<=n+1;j++) std::swap(mat[i][j],mat[u][j]);\n\n        for(int j=1;j<=n;j++) if(i^j)\n        {\n            int t=Mul(mat[j][i],qp(mat[i][i],mod-2));\n            for(int k=i+1;k<=n+1;k++) mat[j][k]=Add(mat[j][k],mod-Mul(t,mat[i][k]));\n        }\n    }\n\n    for(int i=1;i<=n;i++) f[S][idf[i]]=Mul(mat[i][n+1],qp(mat[i][i],mod-2));\n}\n\n//\u8fd9\u4e2adfs\u7684\u76ee\u7684\u662f\u4ece\u5927\u5230\u5c0f\u5904\u7406\u51fa\u6240\u6709\u70b9\u96c6\ninline void dfs(int limit,int S=0,int level=1,int lst=0)\n{\n    if(level>limit)\n    {\n        for(int i=1;i<=limit;i++)\n            for(int j=1;j<=limit+1;j++)\n                mat[i][j]=0;\n\n        int tot=0;for(int i=1;i<=n;i++)\n        if(S&get(i)) dfn[i]=++tot,idf[tot]=i;\n\n        for(int x=1;x<=limit;x++)\n        {\n            mat[x][x]=mat[x][limit+1]=mod-1;\n            int mu=qp(deg[idf[x]],mod-2);\n\n            for(int j=first[idf[x]];j;j=nxt[j])\n            {\n                int v=to[j];\n                if(S&get(v)) mat[x][dfn[v]]=mu;//\u5982\u679cv\u88ab\u5305\u542b\u5728S\u4e2d\uff0c\u5c31\u8bbe\u4e3a\u672a\u77e5\u6570\n                else mat[x][limit+1]=Add(mat[x][limit+1],mod-Mul(f[S|get(v)][v],mu));\n                //\u5426\u5219\uff0cS|v\u8fd9\u4e2a\u70b9\u96c6\u6211\u4eec\u5df2\u7ecf\u7b97\u597d\u4e86\uff0c\u76f4\u63a5\u53d8\u6210\u5e38\u6570\u6254\u8fc7\u53bb\n            }\n        }\n\n        return gauss(limit,S);\n    }\n\n    for(int i=lst+1;i<=n;i++) dfs(limit,S^get(i),level+1,i);\n}\n\nint main()\n{\n    n=read(),m=read(),all=get(n+1)-1;\n    for(int i=1;i<=m;i++) add(read(),read());\n\n    for(int level=n-1;level>0;level--) dfs(level);\n\n    q=read();\n    while(q--)\n    {\n        int k=read(),count=0;\n        while(k--) count|=get(read());\n        int s=read();printf(\"%d\\n\",f[all^count|get(s)][s]);\n    }\n}\n```",
        "postTime": 1665905476,
        "uid": 363730,
        "name": "Mr_Avalon",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4321 \u3010\u968f\u673a\u6f2b\u6e38\u3011"
    },
    {
        "content": "## \u9898\u76ee\u94fe\u63a5\uff1a[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4321)\n\n## \u601d\u8def\uff1a\n\n\u9996\u5148\u5c06\u95ee\u9898\u8f6c\u6362\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8be2\u95ee\uff0c\u8bbe\u96c6\u5408 $S_c\\{c_1,c_2 \\dots c_n\\}$ \u8868\u793a\u6bcf\u6b21\u9700\u8981\u5bfb\u627e\u7684\u70b9\u96c6\u3002\u8bbe $\\text{Path}^\\prime$ \u8868\u793a\u4ece\u8d77\u70b9\u51fa\u53d1\u7ecf\u8fc7\u8be5\u70b9\u96c6\u6240\u6709\u70b9\u7684\u4efb\u610f\u4e00\u6761\u8def\u5f84\uff0c$S$ \u8868\u793a\u5728\u8def\u5f84 $\\text{Path}^\\prime$\u4e2d\uff0c**\u5230\u8fbe\u70b9\u96c6 $S_c$ \u4e2d\u6240\u6709\u70b9\u7684\u6b65\u6570\u7684\u96c6\u5408**\u3002\u663e\u7136\uff0c $\\max(S)$ \u5373\u662f\u5230\u8fbe $\\text{Path}^\\prime$ \u7ec8\u70b9\u7684\u6b65\u6570\uff0c\u800c $\\min(T),T \\subseteq S$ \u5373\u662f\u5728\u8def\u5f84 $\\text{Path}^\\prime$ \u4e2d\u7b2c\u4e00\u6b21\u5230\u8fbe $S_c$ \u4e2d\u7684\u70b9\u65f6\u7684\u6b65\u6570\u3002\n\n\u6839\u636e $\\min - \\max$ \u5bb9\u65a5\u5b9a\u7406\uff0c\u6709\uff1a\n\n$$\\max(S)=\\sum_{T \\subseteq S} (-1)^{|T|+1}\\min(T)$$\n\n\u800c $\\min - \\max$ \u5bb9\u65a5\u5b9a\u7406\u5728\u671f\u671b\u610f\u4e49\u4e0b\u4e5f\u6210\u7acb\uff0c\u7531\u4e8e $\\text{Path}^\\prime$ \u662f\u4e2a**\u968f\u673a\u53d8\u91cf**\u4e14\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a $\\text{Path}^\\prime$ \u5bf9\u5e94\u7684 $S$ \u662f\u552f\u4e00\u7684\uff0c\u6545\u4e0a\u5f0f\u5728\u671f\u671b\u610f\u4e49\u4e0b\u4e5f\u6210\u7acb\uff1a\n\n$$E(\\max(S))=\\sum_{T \\subseteq S} (-1)^{|T|+1}E(\\min(T))$$\n\n\u663e\u7136\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a$\\text{Path}^\\prime$\uff0c$E(\\max(S))$\u8868\u793a\u7ecf\u8fc7 $S_c$ \u4e2d\u6240\u6709\u70b9\u7684\u6b65\u6570\u7684\u671f\u671b\uff0c$E(\\min(T))$ \u8868\u793a\u5728\u8def\u5f84 $\\text{Path}^\\prime$ \u4e2d\u7b2c\u4e00\u6b21\u5230\u8fbe $S_c$ \u4e2d\u7684\u70b9\u65f6\u7684\u6b65\u6570\u7684\u671f\u671b\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u7ed9\u5b9a\u7684 $S_c$ \uff0c\u8003\u8651\u8fd9\u6837\u7684 dp \uff1a\n\n$$E(x) =\\sum_{(x,y)} \\dfrac{E(y)}{deg_x}+1,x\\notin S_c$$\n\n $E(x)$ \u8868\u793a $x$ \u7b2c\u4e00\u6b21\u5230 $S_c$ \u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u8282\u70b9\u7684\u671f\u671b\uff0c $deg_x$ \u8868\u793a\u8282\u70b9 $x$ \u7684\u5ea6\u6570\uff0c\u5219\u8d77\u70b9\u7684\u6240\u6c42\u5f97\u7684\u671f\u671b\u5373\u4e3a $E(\\min(T))$ \u3002\n\n\u8be5\u65b9\u7a0b\u53ef\u4ee5\u4f7f\u7528**\u9ad8\u65af\u6d88\u5143**\u6765\u6c42\u89e3\uff0c\u901a\u8fc7 $\\min - \\max$ \u5bb9\u65a5\u5b9a\u7406\u6c42\u51fa $E(\\max(S))$ \uff0c\u800c\u5bf9\u4e8e\u679a\u4e3e $T \\subseteq S$ \u7531\u4e8e\u6211\u4eec\u53ea\u5173\u5fc3 $|T|$ \uff0c\u6240\u4ee5\u679a\u4e3e $S_c$ \u5b50\u96c6\u4e2d\u70b9\u7684\u4e2a\u6570\u662f\u7b49\u4ef7\u4e8e\u679a\u4e3e $|T|$ \u7684\u3002\n\n\u663e\u7136\u6211\u4eec\u4e0d\u80fd\u5bf9\u6bcf\u4e2a\u8be2\u95ee\u679a\u4e3e $S_c$ \u7684\u5b50\u96c6\u6765\u6c42\u89e3\uff0c\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\mathcal{O(Mn^3 2^n )}$ \u7ea7\u522b\u7684\u3002\n\n\u8003\u8651\u679a\u4e3e\u6240\u6709\u70b9\u6784\u6210\u7684\u70b9\u96c6\u7684\u5b50\u96c6\u5e76\u7528\u9ad8\u65af\u6d88\u5143\u7b97\u51fa\u6240\u6709\u7684 $E(\\min(T))$ \uff0c\u7136\u540e\u7528\u9ad8\u7ef4\u524d\u7f00\u548c\u7ef4\u62a4 $\\sum_{T \\subseteq S} (-1)^{|T|+1}E(\\min(T))$ \uff0c\u9884\u5904\u7406\u4e4b\u540e\u5373\u53ef $\\mathcal{O(1)}$ \u67e5\u8be2 $\\sum_{T \\subseteq S} (-1)^{|T|+1}E(\\min(T))$ \u3002\n\n\u7531\u4e8e\u9ad8\u7ef4\u524d\u7f00\u548c\u4e0d\u662f\u672c\u7ae0\u8ba8\u8bba\u7684\u91cd\u70b9\uff0c\u60f3\u4e86\u89e3\u7684\u53ef\u4ee5\u770b\uff1a[\u9ad8\u7ef4\u524d\u7f00\u548c by heyuhhh](https://www.cnblogs.com/heyuhhh/p/11585358.html)\n\n\u5f53\u7136\u4e5f\u53ef\u4ee5\u7528\u4f4d\u8fd0\u7b97\u5377\u79ef\u6765\u679a\u4e3e $|T|$ \uff0c\u4e22\u4e2a\u94fe\u63a5\uff1a[\u4f4d\u8fd0\u7b97\u5377\u79ef by command-block](https://www.luogu.com.cn/blog/command-block/wei-yun-suan-juan-ji-yu-ji-kuo-zhan)\n\n## \u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790/\u4f18\u5316\uff1a\n\n\u8003\u8651\u4ee5\u4e0b\u4e24\u4e2a\u4f18\u5316\uff1a\n\n+ \u7531\u4e8e\u8981\u8fdb\u884c\u6709\u7406\u6570\u53d6\u6a21\uff0c\u82e5\u5728 dp \u5904\u7406\u77e9\u9635\u7cfb\u6570\u65f6\u8ba1\u7b97 $deg_x^{-1}$ \uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4f1a\u8fbe\u5230 $\\mathcal{O(N^22^N+2^N((N+E)\\log k+\\dfrac{1}{3}N^3))}$ \u96be\u4ee5\u901a\u8fc7\uff0c\u82e5\u9884\u5904\u7406\u6240\u6709\u7684 $deg_x^{-1}$ \uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u964d\u4e3a $\\mathcal{O(N^22^N+2^N((N+E)+\\dfrac{1}{3}N^3))}$ \u3002\n\n+ \u8003\u8651\u5bf9\u9ad8\u65af\u6d88\u5143\u8fdb\u884c\u4f18\u5316\uff0c\u82e5\u4efb\u610f\u4e00\u70b9\u5728\u88ab\u679a\u4e3e\u7684\u70b9\u7684\u70b9\u96c6\u5185\uff0c\u663e\u7136\u8be5\u70b9\u7684\u671f\u671b\u4e3a $0$ \uff0c\u6d88\u5143\u65f6\u76f4\u63a5\u8df3\u8fc7\uff0c\u5219\u679a\u4e3e\u70b9\u96c6\u5e76\u8fdb\u884c\u9ad8\u65af\u6d88\u5143\u7684\u590d\u6742\u5ea6\u4e3a\uff1a\n$$\\sum_{k=0}^N \\binom{N}{N-k}(N-k)^3 \\approx 2^{N-3}N^3$$ \n\n\u7ecf\u8fc7\u4f18\u5316\u540e\uff0c\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u7ea6\u4e3a\uff1a\n\n$$\\mathcal{O(N^22^N+ 2^{N-3}N^3)}$$\n\n\u5bf9\u4e8e\u56db\u79d2\u7684\u65f6\u9650\u5df2\u7ecf\u8db3\u591f\u3002\n\n## \u4ee3 \u7801 \u653e \u9001\uff1a\n\n\u65e2\u7136\u4f60\u80fd\u627e\u5230\u8fd9\u9898\uff0c\u6211\u76f8\u4fe1\u4f60\u80fd\u77ac\u95f4\u505a\u51fa\u6765\u7684\u3002\n\n$Code:$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst long long N=20,M=1010,lpw=998244353;\nlong long head[N],ver[M],Next[M],tot;\nlong long a[N][N],deg[N],f[N],s[1<<N][N],fac[1<<N];\ninline long long read(){\n    char c=getchar();long long x=0,f=1;\n    while(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n    while(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\n    return x*f;\n}\ninline long long Qpow(long long x,long long k){\n\tlong long res=1;\n\twhile(k){\n\t\tif(k&1)res=(res*x)%lpw;\n\t\tk>>=1;x=(x*x)%lpw;\n\t}\n\treturn res;\n}\ninline long long inv(long long a){\n\treturn Qpow(a,lpw-2)%lpw;\n}\ninline void add(long long x,long long y){\n\tver[++tot]=y,Next[tot]=head[x],head[x]=tot;\n}\ninline void gauss(long long n,long long m,long long S){\n\tfor(register long long i=1;i<=n;++i){\n\t\tbool ins=(S>>(i-1)&1);\n\t\tif(ins)\n\t\t\tfor(register long long k=1;k<=n;++k)\n\t\t\t\tif(k!=i)a[k][i]=0;\n\t}\n\tfor(register long long i=1,j=1;i<=n&&j<=m;++j){\n\t\tlong long i1=i;\n\t\tbool ins=(S>>(i-1)&1);\n\t\tif(ins){i++;continue;}\n\t\twhile(!a[i1][j]&&i1<=n)i1++;\n\t\tif(a[i1][j]==0)continue;\n\t\tswap(a[i1],a[i]);\n\t\tfor(register long long k=m+1;k>=j;--k)a[i][k]=(a[i][k]%lpw*inv(a[i][j])%lpw)%lpw;\n\t\tfor(register long long k=i+1;k<=n;++k)\n\t\t\tif(a[k][j]!=0)\n\t\t\t\tfor(register long long e=m+1;e>=j;--e)a[k][e]=(a[k][e]-a[i][e]*a[k][j]%lpw+lpw)%lpw;\n\t\ti++;\n\t}\n\tfor(register long long i=n;i>=1;--i)\n\t\tfor(register long long j=i-1;j>=1;--j){\n\t\t\ta[j][m+1]=(a[j][m+1]-a[j][i]*a[i][m+1]%lpw+lpw)%lpw;\n\t\t\ta[j][i]=(a[j][i]-a[j][i]*a[i][i]%lpw+lpw)%lpw;\n\t\t}\n\tfor(register long long i=1;i<=n;++i)\n\t\tf[i]=a[i][m+1]%lpw;\n}\nlong long n,m,Q;\ninline void pre(long long S){\n\tfor(register long long x=1;x<=n;++x){\n\t\tbool ins=(S>>(x-1)&1);\n\t\tif(ins){a[x][x]=1;continue;}\n\t\ta[x][x]=(-1+lpw)%lpw;\n\t\tfor(register long long i=head[x];i;i=Next[i]){\n\t\t\tlong long y=ver[i];\n\t\t\ta[x][y]=deg[x]%lpw;\n\t\t}\n\t\ta[x][n+1]=(-1+lpw)%lpw;\n\t}\n}\nint main(){\n\tn=read();m=read();\n\tfor(register long long i=1;i<=m;++i){\n\t\tlong long x,y;\n\t\tx=read();y=read();\n\t\tadd(x,y),add(y,x);\n\t\t++deg[x],++deg[y];\n\t}\n\tfor(register long long i=1;i<=n;++i)\n\t\tdeg[i]=inv(deg[i]);\n\tfac[0]=-1;\n\tfor(register long long i=1;i<1<<n;++i){\n\t\tmemset(a,0,sizeof(a));\n\t\tfac[i]=fac[i>>1]*((i&1)?-1:1);\n\t\tpre(i);\n\t\tgauss(n,n,i);\n\t\tfor(register long long k=1;k<=n;++k)\n\t\t\ts[i][k]=(f[k]*fac[i]%lpw+lpw)%lpw;\n\t}\n\tfor(register long long k=1;k<=n;++k)\n\t\tfor(register long long i=0;i<n;++i)\n\t\t\tfor(register long long j=1;j<1<<n;++j)\n\t\t\t\tif(j>>i&1)s[j][k]=(s[j][k]+s[j^(1<<i)][k]);\n\tQ=read();\n\twhile(Q--){\n\t\tlong long ques,st,S=0;\n\t\tques=read();\n\t\tfor(register long long i=1;i<=ques;++i)\n\t\t\tS|=(1<<(read()-1));\n\t\tst=read();\n\t\tprintf(\"%lld\\n\",s[S][st]%lpw);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1604413310,
        "uid": 137242,
        "name": "Dia\u043esi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4321 \u3010\u968f\u673a\u6f2b\u6e38\u3011"
    },
    {
        "content": "\u5f88\u6709\u610f\u601d\u7684\u4e00\u9053\u9898\u76ee\u3002\r\n\r\n\u7528f(x,S)\u8868\u793a\u4ecex\u51fa\u53d1\uff0c\u5df2\u7ecf\u8d70\u8fc7\u4e86\u70b9\u96c6S,\u8d70\u904d\u5168\u56fe\u7684\u671f\u671b\u3002\r\n\r\n\u8fd9\u4e00\u7c7b\u671f\u671b\u9898\u53ef\u4ee5\u8003\u8651\u9ad8\u65af\u6d88\u5143\uff0c\u6784\u9020\u65b9\u7a0b\u5982\u4e0b\uff1a\r\n\r\n$$ f(x,S) = \\frac{1}{du(x)} (f(y,S) \\times [ y \\in S ]+ f(y,S \\cup j ) \\times [ y \\not\\in S ]; )$$\r\n\r\n\u76f4\u63a5\u8fdb\u884c\u9ad8\u65af\u6d88\u5143\u7684\u8bdd\uff0c\u590d\u6742\u5ea6\u80af\u5b9a\u53d7\u4e0d\u4e86\uff0c\u8003\u8651\u4e00\u4e0b\u8be5\u65b9\u7a0b\u7684\u7279\u6b8a\u6027\u8d28\u3002\r\n\r\n\u7531\u4e8e\u6bcf\u6b21\u8d70\u4e00\u4e2a\u65b0\u7684\u70b9\uff0c\u5df2\u7ecf\u8d70\u8fc7\u7684\u70b9\u96c6\u53ea\u53ef\u80fd\u6269\u5927\u4e0d\u53ef\u80fd\u7f29\u5c0f\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u6027\u8d28\u8fdb\u884c\u5206\u5c42\uff0c\u6bcf\u6b21\u5bf9\u4e8e\u4e00\u4e2aS\u8fdb\u884c\u9ad8\u65af\u6d88\u5143\uff0c\u6c42\u51fa\u4e00\u4e9b\u4fe1\u606f\u540e\uff0c\u5229\u7528\u8fd9\u4e9b\u4fe1\u606f\uff0c\u7ee7\u7eed\u8fdb\u884c\u4e0b\u4e00\u5c42\u7684\u9ad8\u65af\u6d88\u5143\u3002\u8fd9\u6837\u6bcf\u6b21\u9ad8\u65af\u6d88\u5143\u65f6\uff0c\u590d\u6742\u5ea6\u5927\u5927\u964d\u4f4e\u3002\r\n\r\n\u590d\u6742\u5ea6$O(n^32^n+Q)$",
        "postTime": 1521353651,
        "uid": 20604,
        "name": "litble",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P4321 \u3010\u968f\u673a\u6f2b\u6e38\u3011"
    }
]
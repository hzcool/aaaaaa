[
    {
        "content": "> [P8101 [USACO22JAN] Multiple Choice Test P](https://www.luogu.com.cn/problem/P8101)\n\n\u5bf9\u4e8e\u6ca1\u89c1\u8fc7\u5957\u8def\u7684\u65b0\u624b\uff0c\u662f\u597d\u9898\uff1b\u5bf9\u4e8e\u89c1\u591a\u8bc6\u5e7f\u7684\u9ad8\u624b\uff0c\u662f\u5957\u8def\u9898\u3002\n\n\u5173\u952e\u7ed3\u8bba\uff1a\u53ef\u80fd\u6210\u4e3a\u7b54\u6848\u7684\u70b9\u4e00\u5b9a\u5728\u51f8\u5305\u4e0a\u3002\u6839\u636e $x ^ 2$ \u7684\u51f8\u6027\u5bb9\u6613\u8bc1\u660e\u3002\u63a5\u4e0b\u6765\u5c31\u597d\u505a\u4e86\u3002\u8003\u8651\u5bf9\u6bcf\u7ec4\u5411\u91cf\u5747\u5efa\u51fa\u51f8\u5305\uff0c\u6c42\u51fa\u8fd9 $n$ \u4e2a\u51f8\u5305\u7684\u95f5\u53ef\u592b\u65af\u57fa\u548c\uff0c\u6700\u540e\u7528\u5927\u51f8\u5305\u4e0a\u7684\u70b9\u66f4\u65b0\u7b54\u6848\u3002\n\n\u5927\u5c0f\u4e3a $a$ \u548c\u5927\u5c0f\u4e3a $b$ \u7684\u51f8\u5305\u7684\u95f5\u53ef\u592b\u65af\u57fa\u548c\u9700\u8981 $\\mathcal{O}(a + b)$ \u65f6\u95f4\u8ba1\u7b97\uff0c\u56e0\u6b64\u8003\u8651\u542f\u53d1\u5f0f\u5408\u5e76\u3002\u89c6\u5411\u91cf\u603b\u6570\u4e0e $n$ \u540c\u7ea7\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal{O}(n\\log n)$\u3002\n\n\u66f4\u4e3a\u5389\u5bb3\u7684\u505a\u6cd5\uff1a\u8003\u8651\u6211\u4eec\u5bf9\u4e24\u4e2a\u51f8\u5305\u505a\u95f5\u53ef\u592b\u65af\u57fa\u548c\u7684\u8fc7\u7a0b\uff0c\u5c31\u662f\u628a\u6240\u6709\u8fb9\u62ff\u51fa\u6765\u5f52\u5e76\u6392\u5e8f\uff0c\u518d\u585e\u56de\u53bb\uff0c\u8fd9\u4e2a\u8fc7\u7a0b **\u4e0d\u6539\u53d8\u8fb9\u672c\u8eab**\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u76f4\u63a5\u628a\u6240\u6709\u51f8\u5305\u7684\u6240\u6709\u8fb9\u62ff\u51fa\u6765\uff0c**\u6781\u89d2\u6392\u5e8f**\uff0c\u518d\u585e\u56de\u53bb\uff0c\u5c31\u4e0d\u9700\u8981\u542f\u53d1\u5f0f\u5408\u5e76\u7684\u8fc7\u7a0b\u4e86\uff0c\u76f8\u5f53\u4e8e\u540c\u65f6\u6c42\u591a\u4e2a\u51f8\u5305\u7684\u95f5\u53ef\u592b\u65af\u57fa\u548c\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u662f\u7ebf\u6027\u5bf9\u6570\uff0c\u4f46\u662f\u6bd4\u4e0a\u4e2a\u505a\u6cd5\u9ad8\u5999\u591a\u4e86\u3002\n\n\u4ee3\u7801\u5206\u522b\u662f\u542f\u53d1\u5f0f\u5408\u5e76\u548c\u76f4\u63a5\u5bf9\u8fb9\u6392\u5e8f\uff0c\u540e\u8005\u501f\u9274\u4e86 Benq \u5728\u6781\u89d2\u6392\u5e8f\u4e0a\u7684\u5904\u7406\u3002\n\n- upd\uff1a\u5bf9\u9519\u8bef\u4ee3\u7801\u8fdb\u884c\u66f4\u65b0\uff0c\u8be6\u89c1 https://www.luogu.com.cn/discuss/417389\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define ll long long\nconst int N = 2e5 + 5;\n\nstruct Pt {\n\tint x, y;\n\tbool operator < (const Pt &rhs) {return x != rhs.x ? x < rhs.x : y < rhs.y;}\n\tPt operator + (const Pt &rhs) {return {x + rhs.x, y + rhs.y};}\n\tPt operator - (const Pt &rhs) {return {x - rhs.x, y - rhs.y};}\n\tll norm() {return 1ll * x * x + 1ll * y * y;}\n\tll cross(const Pt &rhs) {return 1ll * x * rhs.y - 1ll * y * rhs.x;}\n\tvoid print(string info = \"\") {cout << info << \" \" << x << \" \" << y << endl;}\n};\n\nvoid print(vector <Pt> &v, string info) {\n\tcout << \"print convex hull : \" << info << \"\\n\";\n\tfor(auto it : v) cout << it.x << \" \" << it.y << \"\\n\";\n\tcout << \"finished.\\n\";\n}\n\nll n, ans;\nvector <Pt> c[N]; Pt cen;\nset <pair <int, int>> s;\nbool cmp(Pt x, Pt y) {\n\tll res = (x - cen).cross(y - cen);\n\tif(res) return res > 0;\n\treturn (x - cen).norm() > (y - cen).norm();\n}\nvoid ConvexHull(vector <Pt> &v) {\n\tstatic Pt stc[N]; int top = 0;\n\tfor(int i = 1; i < v.size(); i++) if(v[i] < v[0]) swap(v[i], v[0]);\n\tcen = stc[top = 1] = v[0], sort(v.begin() + 1, v.end(), cmp);\n\tfor(int i = 1; i < v.size(); i++) {\n\t\twhile(top >= 2 && (stc[top] - stc[top - 1]).cross(v[i] - stc[top]) < 0) top--;\n\t\tstc[++top] = v[i];\n\t} v.clear(), assert(v.size() == 0);\n\tfor(int i = 1; i <= top; i++) v.push_back(stc[i]);\n}\n\nvector <Pt> operator + (vector <Pt> &lhs, vector <Pt> &rhs) {\n\tvector <Pt> ret; ret.push_back(lhs[0] + rhs[0]);\n\tstatic Pt sl[N], sr[N]; int pl = 0, pr = 0, L = lhs.size(), R = rhs.size();\n\tfor(int i = 0; i < L; i++) sl[i] = lhs[(i + 1) % L] - lhs[i];\n\tfor(int i = 0; i < R; i++) sr[i] = rhs[(i + 1) % R] - rhs[i];\n\twhile(pl < L && pr < R) ret.push_back(ret.back() + (sl[pl].cross(sr[pr]) > 0 || sl[pl].cross(sr[pr]) == 0 && sl[pl].x > sr[pr].x ? sl[pl++] : sr[pr++]));\n\twhile(pl < L) ret.push_back(ret.back() + sl[pl++]);\n\twhile(pr < R) ret.push_back(ret.back() + sr[pr++]);\n\treturn ret.pop_back(), ret;\n}\n\nint main() {\n\tcin >> n;\n\tfor(int i = 1, k, x, y; i <= n; i++) {\n\t\tscanf(\"%d\", &k);\n\t\twhile(k--) cin >> x >> y, c[i].push_back({x, y});\n\t\tConvexHull(c[i]), s.insert({c[i].size(), i});\n\t} while(s.size() > 1) {\n\t\tint a = s.begin() -> second, b = (++s.begin()) -> second;\n\t\ts.erase(s.begin()), s.erase(s.begin());\n\t\tc[a] = c[a] + c[b], s.insert({c[a].size(), a});\n\t} for(auto it : c[s.begin() -> second]) ans = max(ans, it.norm());\n\tassert(c[s.begin() -> second].size() <= 2e5);\n\tcout << ans << endl;\n\treturn 0;\n}\n```\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define ll long long\nconst int N = 2e5 + 5;\n\nstruct Pt {\n\tint x, y;\n\tbool operator < (const Pt &rhs) {return x != rhs.x ? x < rhs.x : y < rhs.y;}\n\tPt operator + (const Pt &rhs) {return {x + rhs.x, y + rhs.y};}\n\tPt operator - (const Pt &rhs) {return {x - rhs.x, y - rhs.y};}\n\tll norm() {return 1ll * x * x + 1ll * y * y;}\n\tll cross(const Pt &rhs) {return 1ll * x * rhs.y - 1ll * y * rhs.x;}\n\tbool dir() {return x > 0 || (x == 0 && y > 0);}\n} off[N];\n\nll n, cnt, ans;\nvector <Pt> c; Pt cen, start;\nbool cmp(Pt x, Pt y) {\n\tll res = (x - cen).cross(y - cen);\n\tif(res) return res > 0;\n\treturn (x - cen).norm() > (y - cen).norm();\n}\nvoid ConvexHull(vector <Pt> &v) {\n\tstatic Pt stc[N]; int top = 0;\n\tfor(int i = 1; i < v.size(); i++) if(v[i] < v[0]) swap(v[i], v[0]);\n\tcen = stc[top = 1] = v[0], sort(v.begin() + 1, v.end(), cmp);\n\tfor(int i = 1; i < v.size(); i++) {\n\t\twhile(top >= 2 && (stc[top] - stc[top - 1]).cross(v[i] - stc[top]) < 0) top--;\n\t\tstc[++top] = v[i];\n\t} for(int i = (v.clear(), 1); i <= top; i++) v.push_back(stc[i]);\n}\n\nint main() {\n\tcin >> n;\n\tfor(int i = 1, k, x, y; i <= n; i++) {\n\t\tscanf(\"%d\", &k), c.clear();\n\t\twhile(k--) cin >> x >> y, c.push_back({x, y});\n\t\tConvexHull(c), start = start + c[0];\n\t\tfor(int i = 1; i <= c.size(); i++) off[++cnt] = c[i % c.size()] - c[i - 1];\n\t}\n\tsort(off + 1, off + cnt + 1, [&](Pt x, Pt y) {return x.dir() != y.dir() ? x.dir() : x.cross(y) > 0;});\n\tfor(int i = 1; i <= cnt; i++) ans = max(ans, start.norm()), start = start + off[i];\n\tcout << ans << endl;\n\treturn 0;\n}\n```",
        "postTime": 1644026043,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "P8101 [USACO22JAN] Multiple Choice Test P"
    },
    {
        "content": "\u9898\u610f\uff1a\u7ed9\u5b9a $n$ \u7ec4\u5411\u91cf\uff0c\u6c42\u6bcf\u4e00\u7ec4\u4e2d\u9009\u51fa\u4e00\u4e2a\u5411\u91cf\uff0c\u52a0\u8d77\u6765\u540e\u6700\u5927\u7684\u957f\u5ea6\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a\u5411\u91cf\u6570\u4e0d\u8d85\u8fc7 $10^5$ \uff0c$|x|,|y|\\le \\frac{10^9}{N}$ \u3002\n\n\u6211\u4eec\u7ef4\u62a4\u5f53\u524d\u6240\u6709\u53ef\u80fd\u7b54\u6848\u6784\u6210\u7684\u70b9\u96c6\uff0c\u6709\n\n\u6027\u8d281\uff1a\u5982\u679c\u4e00\u4e2a\u70b9\u4e0d\u5728\u8be5\u70b9\u96c6\u7684\u51f8\u5305\u4e0a\uff0c\u90a3\u4e48\u8fd9\u4e2a\u70b9\u79bb\u539f\u70b9\u7684\u8ddd\u79bb\u4e0d\u662f\u6700\u5927\u7684\u3002\n\n\u5bf9\u6bcf\u4e00\u7ec4\u5411\u91cf\u6211\u4eec\u90fd\u53ef\u4ee5\u6c42\u51fa\u5b83\u7684\u51f8\u5305\u3002\u5bf9\u4e8e\u7b2c $i$ \u7ec4\u5411\u91cf\uff0c\u6211\u4eec\u5c06\u5b83\u7684\u51f8\u5305\u4e0e\u524d $i-1$ \u7ec4\u5f97\u5230\u7684\u7b54\u6848\u51f8\u5305\u5408\u5e76\uff0c\u7528 Minkowski \u548c\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(N\\log N)$ \u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\n#define Vector Point\nusing namespace std;\nstruct Point {\n    int x, y;\n    friend Point operator + (Point a, Point b) {return {a.x+b.x,a.y+b.y};}\n    friend Point operator - (Point a, Point b) {return {a.x-b.x,a.y-b.y};}\n    friend int operator * (Point a, Point b) {return (a.x*b.y-a.y*b.x);}\n};\nconst int inf = 1e15;\nint Abs (Point a) {return (a.x*a.x+a.y*a.y);}\nPoint Inv (Point a) {return {-a.x,-a.y};}\nint Pos (Vector X) {return (bool)((X.y)>0||(X.y==0&&X.x>0));}\nconst int maxn = 1e6+5;\nint cmp (Vector a, Vector b) {\n    if (a.y!=b.y) return a.y<b.y;\n    return a.x<b.x;\n}\nint n;\nint stk[maxn],h[maxn],used[maxn];\nvector<Vector> ans;\nVector start;\nvector<Vector> Convex (vector<Vector> p) {\n    vector<Vector> ret,q;\n    int l = p.size();\n    int tp = 0;          \n    sort(p.begin(),p.end(),cmp);\n    stk[++tp] = 0;\n    for (int i=0;i<=l;i++) used[i] = 0;\n    for (int i=1;i<l;i++) {\n        while (tp>=2&&(p[stk[tp]]-p[stk[tp-1]])*(p[i]-p[stk[tp]])<=0) {\n            used[stk[tp--]] = 0;\n        }\n        used[i] = 1;  \n        stk[++tp] = i;\n    }\n    int tmp = tp;  \n    for (int i=l-2;i>=0;i--) if (!used[i]) {\n        while (tp>tmp&&(p[stk[tp]]-p[stk[tp-1]])*(p[i]-p[stk[tp]])<=0) {\n            used[stk[tp--]] = 0;\n        }\n        used[i] = 1;\n        stk[++tp] = i;\n    }\n    for (int i=1;i<=tp;i++) ret.push_back(p[stk[i]]);\n    return ret;\n}\nint rad (Vector a, Vector b) {   \n    int A = Pos(a);\n    int B = Pos(b);\n    if (A!=B) return A>B;\n    return a*b>0;\n}\nint Minkowski () {\n    int res = 0;\n    sort(ans.begin(),ans.end(),rad);\n    for (int i=0;i<ans.size();i++) {\n        res = max(res,Abs(start));\n        start = start+ans[i];\n    }\n    res = max(res,Abs(start));\n    return res;\n}\nsigned main () {\n    int T;cin>>T;\n    while (T--) {\n        cin>>n;\n        vector<Vector> v;\n        for (int i=1;i<=n;i++) {\n            int x, y;\n            cin>>x>>y;\n            v.push_back({x,y});\n        }    \n        vector<Vector> res = Convex(v); \n        if (res[res.size()-1].x==res[0].x && res[res.size()-1].y==res[0].y) res.pop_back();\n        for (int i=1;i<res.size();i++) ans.push_back(res[i]-res[i-1]);\n        ans.push_back(res[0]-res[res.size()-1]);\n        start = start+res[0];\n    }\n    int fans = Minkowski();\n    cout<<fans<<endl;\n    return 0;\n}\n```\n\n",
        "postTime": 1643753331,
        "uid": 218501,
        "name": "ETHANK",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 [USACO22JAN] Multiple Choice Test P"
    }
]
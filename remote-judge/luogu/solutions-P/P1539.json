[
    {
        "content": "## P1539\u9898\u89e3\n### 1.\u5206\u6790\n\u6570\u636e\u8303\u56f4: $n\\times m\\le225$\u3002\n\n\u5219 $\\min(m,n)\\le15$\u3002\u6211\u4eec\u53ef\u4ee5\u5c06\u8f83\u5c0f\u503c\u4f5c\u4e3a\u7684\u5217\u6570\uff0c\u518d\u5bf9\u6bcf\u4e00\u884c\u8fdb\u884c\u72b6\u538b\uff0c\u7528 $c$ \u6570\u7ec4\u50a8\u5b58\u6bcf\u884c\u65b9\u6848\uff0cdp \u6c42\u89e3\u3002  \n\n\u6211\u4eec\u7b97\u4e00\u4e0b\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u7531\u4e8e\u76f8\u90bb\u4e0d\u80fd\u540c\u65f6\u4e3a 1\uff0c\u6240\u4ee5\u5f88\u591a\u60c5\u51b5\u90fd\u88ab\u820d\u6389\uff0c\u6240\u4ee5\u5f53 $m=15$ \u65f6\uff0c\u6bcf\u4e00\u884c\u53ea\u6709 1597 \u79cd\u60c5\u51b5\uff0c\u4e0d\u4f1a\u8d85\u65f6\u3002\n\n\u4f46\u9898\u76ee\u7ed9\u51fa\u7684\u77e9\u9635\u6709\u4e9b\u6570\u5df2\u7ecf\u586b\u597d\uff0c\u65e0\u6cd5\u6539\u53d8\uff0c\u8fd9\u600e\u4e48\u5904\u7406\u5462\uff1f\n\n\u8bbe $s_i$ \u4e3a\u7b2c $i$ \u884c\u5df2\u586b\u6570\u5b57 1 \u7684\u5206\u5e03\u60c5\u51b5\uff0c$t_i$ \u4e3a\u7b2c $i$ \u884c\u5df2\u586b\u6570\u5b57 0 \u7684\u5206\u5e03\u60c5\u51b5\u3002\u5982\u679c\u7b2c $i$ \u884c\u4e2d\u65b9\u6848 $c_k$ \u6ee1\u8db3 $(t_i\\;and\\;c_k)=t_i$ \u4e14 $s_i\\;and\\;(not\\;c_k)=s_i$\uff0c\u5219\u65b9\u6848 $k$ \u4e0d\u4e0e\u5df2\u586b\u6570\u5b57\u51b2\u7a81\u3002\n\n\u6700\u540e\u7684 dp \u5c31\u6bd4\u8f83\u7b80\u5355\u4e86\uff0c\u8bbe $f[i][j]$ \u4e3a\u7b2c $i$ \u884c\u4f7f\u7528\u7b2c $j$ \u79cd\u65b9\u6848\u7684\u65b9\u6cd5\u6570\uff0c$d$ \u6bcf\u884c\u5408\u6cd5\u65b9\u6848\u79cd\u6570\u3002\n\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a$f[i][j]=\\sum\\limits_{k=1}^df[i-1][k](c[j]\\;and\\;c[k]=0)$\u3002\n\n\u6700\u7ec8\u7b54\u6848\uff1a$ans=\\sum\\limits_{i=1}^df[n][i]$\u3002\n\n\u521d\u59cb\u5316\uff1a$f[0][1]=0$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$\\mathcal O(nd^2)$\u3002\n### 2.Code\n```\n#include<cstdio>\n#include<cstring>\n#include<iostream>\nusing namespace std;\nconst int mod=10007;\nint n,m=15,ans,t[230],s[230],c[1600],f[230][1600];\nchar a[230][230],b[230][230];\nint main() {\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=n;i++)scanf(\"%s\",a[i]+1);\n\t//\u5982\u679cn<m,\u5c06\u77e9\u9635\u987a\u65f6\u9488\u65cb\u8f6c90\u5ea6,\u4ee5\u4fdd\u8bc1\u5217\u6570m<=15 \n\tif(n<m) {\n\t\tswap(n,m);\n\t\tmemcpy(b,a,sizeof(b));\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tfor(int j=1;j<=m;j++)a[i][j]=b[m-j+1][i];\t\t\n\t}\n\t//\u9884\u5904\u7406s,t\u6570\u7ec4 \n\tfor(int i=1;i<=n;i++) {\n\t\tfor(int j=1;j<=m;j++) {\n\t\t\tif(a[i][j]=='1')s[i]+=1<<m-j;\n\t\t\tif(a[i][j]=='0')t[i]+=1<<m-j;\n\t\t}\n\t}\t\n\t//\u9884\u5904\u7406\u6bcf\u884c\u65b9\u6848,\u5b58\u5165\u6570\u7ec4c \n\tfor(int i=0;i<1<<m;i++) \n\t\tif(!(i>>1&i))c[++c[0]]=i;\n\tf[0][1]=1;\n\tfor(int i=1;i<=n;i++) {\n\t\tfor(int j=1;j<=c[0];j++) {\n\t\t\t//\u5224\u65ad\u65b9\u6848\u662f\u5426\u5408\u6cd5 \n\t\t\tif((s[i]&c[j])!=s[i])continue;\n\t\t\tif((t[i]&(~c[j]))!=t[i])continue;\n\t\t\tfor(int k=1;k<=c[0];k++) \n\t\t\t\tif(!(c[j]&c[k]))f[i][j]=(f[i][j]+f[i-1][k])%mod;\n\t\t}\n\t}\n\tfor(int i=1;i<=c[0];i++)ans=(ans+f[n][i])%mod;\n\tprintf(\"%d\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1631797189,
        "uid": 452511,
        "name": "zwh2008",
        "ccfLevel": 0,
        "title": "P1539\u9898\u89e3"
    },
    {
        "content": "\u8fd9\u662f\u76ee\u524d\u4e3a\u6b62 $(\\verb!2021.4.1!)$ \u7684[\u6700\u4f18\u89e3](https://www.luogu.com.cn/record/48812915)\u3002\u5c3d\u7ba1\u8fd9\u91cc\u6709\u4e00\u5806\u6709\u4e9b\u96be\u5199\u7684\u4f18\u5316\uff0c\u4f46\u6211\u5e0c\u671b\u8fd9\u7bc7\u6587\u7ae0\u80fd\u5bf9\u4f60\u6709\u6240\u5e2e\u52a9\u3002\n\n## \u9898\u89e3\n\n\u89c2\u5bdf\u5230 $n\\cdot m\\le 225$ \uff0c\u53ef\u5f97 $\\min(n,m)\\le 15$ \uff08\u5426\u5219\uff0c\u4e24\u8005\u7684\u4e58\u79ef\u5fc5\u5b9a\u5927\u4e8e $225$ \uff09\u3002\u4e8e\u662f\u8003\u8651\u4f7f\u7528\u72b6\u538b $dp$ \u3002\n\n\u6211\u4eec\u5148\u4f7f $n\\ge m$ \u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53 $n<m$ \u65f6\uff0c\u6211\u4eec\u6309\u7167\u659c\u7ebf\u65b9\u5411\u7ffb\u6298\u8fd9\u4e2a\u77e9\u5f62\uff0c\u7136\u540e\u4ea4\u6362 $n,m$ \u3002\u5f88\u663e\u7136\uff0c\u8fd9\u6837\u5e76\u4e0d\u4f1a\u5bf9\u7b54\u6848\u9020\u6210\u4efb\u4f55\u5f71\u54cd\u3002\n\n\u6700\u6734\u7d20\u7684\u72b6\u538b $dp$ \u662f\uff0c\u4ece\u4e0a\u5230\u4e0b\u679a\u4e3e\u6bcf\u4e00\u884c\u7684\u72b6\u6001\u3002\u8f6c\u79fb\u65f6\uff0c\u679a\u4e3e\u4e0a\u4e00\u884c\u7684\u72b6\u6001\u3002\u8fd9\u4e48\u505a\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\mathcal O(n\\times 2^m\\times 2^m)$ \uff0c\u663e\u7136\u662f\u4f1a\u8d85\u65f6\u7684\u3002\u5f53\u7136\uff0c\u7531\u4e8e\u6bcf\u4e00\u5c42\u7684\u5408\u6cd5\u72b6\u6001\u6570\u91cf\u5f88\u5c11\uff0c\u4e8e\u662f\u6211\u4eec\u53ea\u9700\u8981\u679a\u4e3e\u5408\u6cd5\u72b6\u6001\u5c31\u884c\u4e86\u3002\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\mathcal O(n\\times k^2)$ \uff0c\u5176\u4e2d $k$ \u662f\u6bcf\u4e00\u884c\u5408\u6cd5\u72b6\u6001\u6570\u3002\u5c3d\u7ba1\u4f60\u53ef\u4ee5\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u5361\u8fc7\u53bb\uff0c\u4f46\u662f\u6211\u4eec\u5e0c\u671b\u83b7\u5f97\u4e00\u4e2a\u66f4\u597d\u7684\u505a\u6cd5\u3002\n\n\u8003\u8651\u4f7f\u7528\u7c7b\u4f3c\u8f6e\u5ed3\u7ebf\u4e00\u6837\u7684 $dp$ \u3002\u5177\u4f53\u800c\u8a00\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7ef4\u62a4\u4ee5\u4e0b\u5185\u5bb9\uff1a\n\n$$\\def{\\arraystretch}{1.5}\\begin{array}{|c|c|c|c|c|}\\hline\n& & & & \\cr\\hline\n& & 2 & 3 & 4 \\cr\\hline\n0 & 1 \\cr\\hline\n& & & & \\cr\\hline\n\\end{array}$$\n\n\u91cc\u9762\u7684\u6570\u5b57\u8868\u793a\u5b83\u5728\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u72b6\u6001 $s$ \u7684\u7b2c\u51e0\u4f4d\uff0c $dp_s$ \u5b58\u50a8\u8f6e\u5ed3\u7ebf\u4e3a\u8fd9\u79cd\u72b6\u6001\u65f6\uff0c\u4e00\u5171\u6709\u591a\u5c11\u79cd\u65b9\u6848\u3002\u5176\u4e2d $1$ \u662f\u6211\u4eec\u5f53\u524d\u4f4d\u7f6e $(i,j)$ \u3002 $1$ \u53f3\u8fb9\u7684\u683c\u5b50 $(i,j+1)$ \u662f\u6211\u4eec\u4e0b\u4e00\u4e2a\u8981\u66f4\u65b0\u7684\u5730\u65b9\u3002\u6211\u4eec\u66f4\u65b0\u65f6\uff0c\u76f8\u5f53\u4e8e\u5c06\u8fd9\u4e2a\u8f6e\u5ed3\u7ebf\u5728 $(i,j+1)$ \u5904\u5411\u4e0b\u63a8\u4e00\u683c\uff1a\n\n$$\\def{\\arraystretch}{1.5}\\begin{array}{|c|c|c|c|c|}\\hline\n& & & & \\cr\\hline\n& & & 3 & 4 \\cr\\hline\n0 & 1 & 2 \\cr\\hline\n& & & & \\cr\\hline\n\\end{array}$$\n\n\u6211\u4eec\u679a\u4e3e\u6240\u6709 $(i,j)$ \u5904\u5408\u6cd5\u7684 $s$ \uff0c\u518d\u8ba8\u8bba $(i,j+1)$ \u5904\u653e\u7f6e\u4ec0\u4e48\u4e1c\u897f\uff08 $0$ \u6216\u8005 $1$ \uff09\uff0c\u5c31\u53ef\u4ee5\u7528 $(i,j)$ \u5904\u7684 $dp$ \u503c\u63a8\u5411 $(i,j+1)$ \u3002\u7279\u522b\u5730\uff0c \u5728 $(i,1)$ \u5904\u653e\u7f6e\u6570\u5b57 $1$ \u4e0d\u9700\u8981\u8003\u8651\u5b83\u5de6\u4fa7\u683c\u5b50\u662f\u5426\u662f $1$ \uff0c\u53ef\u4ee5\u53c2\u8003\u4e0b\u6587\u7684\u4ee3\u7801\u3002\n\n\u8fd9\u79cd\u505a\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\mathcal O(\\min(n,m)\\times k)$ \uff0c\u5176\u4e2d $k$ \u8868\u793a\u6bcf\u884c\u5408\u6cd5\u72b6\u6001\u6570\u7684\u4e2a\u6570\u3002\u56e0\u4e3a\u5e38\u6570\u6bd4\u8f83\u5c0f\uff0c\u6240\u4ee5\u8dd1\u8d77\u6765\u633a\u5feb\u7684\u3002\n\n## \u53c2\u8003\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define debug(x) (printf(\"The value of [%s] in fuction[%s] is %d.\\n\",#x,__FUNCTION__,x))\n#define up(l,r,i) for(register int i=l,END##i=r;i<=END##i;++i)\n#define dn(r,l,i) for(register int i=r,END##i=l;i>=END##i;--i)\nusing namespace std;\ntypedef long long LL;\nconst int INF =2147483647;\nint qread(){\n\tint w=1,c,r=0;\n\twhile((c=getchar())> '9'||c< '0') w=(c=='-'?-1:1); r=c-'0';\n\twhile((c=getchar())>='0'&&c<='9') r=r*10+c-'0';\n\treturn r*w;\n}\nconst int MAXN =225+3,MOD=1e4+7,MAXM=(1<<15)+3;\nint n,m,t,x,y,F[MAXM],G[MAXM],B1[MAXM],B2[MAXM],c1,c2,ans;\nchar S[MAXN][MAXN]; bool A[MAXM];\nvoid add(int &a,int b){a+=b; if(a>=MOD) a-=MOD;}\nint main(){\n\tn=qread(),m=qread(); up(0,n-1,i) scanf(\"%s\",S[i]);\n\tif(n<m){\n\t\tup(0,n-1,i) up(i,m-1,j) swap(S[i][j],S[j][i]); swap(n,m);\n\t}\n\tF[0]=1,c1=1,B1[1]=0; up(0,n-1,i){\n\t\tup(0,m-1,j){\n\t\t\tif(S[i][j]=='.'||S[i][j]=='1') up(1,c1,k){\n\t\t\t\tx=B1[k],y=x| (1<<j); if((!j||!(x&(1<<j-1)))&&!(x&(1<<j))){\n\t\t\t\t\tif(!A[y]) A[y]=true,B2[++c2]=y; add(G[y],F[x]);\n\t\t\t\t}\n\t\t\t} \n\t\t\tif(S[i][j]=='.'||S[i][j]=='0') up(1,c1,k){\n\t\t\t\tx=B1[k],y=x&~(1<<j);\n\t\t\t\tif(!A[y]) A[y]=true,B2[++c2]=y; add(G[y],F[x]);\n\t\t\t} \n\t\t\tup(1,c1,j) F[B1[j]]=0; c1=c2;\n\t\t\tup(1,c2,j) F[B2[j]]=G[B2[j]],B1[j]=B2[j],B2[j]=G[B2[j]]=A[B2[j]]=0; c2=0;\n\t\t}\n\t}\n\tup(1,c1,i) add(ans,F[B1[i]]); printf(\"%d\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1617281349,
        "uid": 330759,
        "name": "\u56e7\u4ed9",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1539 \u3010[TJOI2011]01\u77e9\u9635\u3011"
    },
    {
        "content": "$wtcl$, \u4e0d\u77e5\u9053\u5565\u662f\u8f6e\u5ed3\u7ebf$dp$,\u3000\u5199\u4e86\u4e00\u53d1$FWT$;  \n\u6613\u5f97\uff0c$min(n,m) \\leq 15$ \uff0c\u53ef\u4ee5\u8bbe$dp[i][s]$\u4e3a\u7b2c$i$\u884c\uff0c\u586b\u7684\u72b6\u6001\u4e3a$S$\u7684\n\u65b9\u6848\u6570\uff0c\u3000\u679a\u4e3e\u4e0a\u4e00\u884c\u7684\u72b6\u6001\u53ef\u4ee5\u66b4\u529b\u8f6c\u79fb\uff0c\u3000\u590d\u6742\u5ea6\u662f$nm(2^m)^2$\u7684\uff0c\u3000\u4f46\u662f\u9650\u5236\u6bd4\u8f83\u591a\uff0c\u8bf4\u4e0d\u5b9a\u80fd\u5361\u8fc7\u3002\u3000\u89c2\u5bdf\u4ec0\u4e48\u6837\u7684\u7684\u72b6\u6001\u53ef\u4ee5\u8f6c\u79fb\u5230$S$, \u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u67d0\u4e00\u4f4d\u586b\uff11\uff0c\u4e0a\u4e00\u884c\u7684\u8fd9\u4e00\u4f4d\u586b\u5fc5\u987b\u586b\uff10\uff0c\u800c\u5982\u679c\u8fd9\u4e00\u4f4d\u586b$0$\uff0c\u4e0a\u4e00\u884c\u53ef\u4ee5\u586b\uff11\u4e5f\u53ef\u4ee5\u586b\uff10\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u3000\u8f6c\u79fb\u8fc7\u6765\u7684\u72b6\u6001\u662f$S$\u53d6\u53cd\u540e\u7684\u5b50\u96c6\uff0c\u3000\u90a3\u4e48\u53ef\u4ee5\u505a\u4e00\u4e2a\u5b50\u96c6\u548c\u8fbe\u5230\u4f18\u5316\u7684\u76ee\u7684\uff0c\u3000\u7528$FWT$ \u6216\u3000$FMT$\u5c31\u53ef\u4ee5\u5b9e\u73b0\u4e86\u3002\n```cpp\n#include<bits/stdc++.h>\n#define mod 10007\n#define int long long\nint n, m, A[21][1000001], ans, d[111111]; \nchar p[1111][1111], s[1111][1111];\n\nusing namespace std;\nvoid FMT(int *f){\n    for(int i = 0; i <= m; i++)\n        for(int j = 0; j < (1 << m); j++)\n            if(j & (1 << i)) (f[j] += f[j ^ (1 << i)]) %= mod;\n}\nbool check(int x, int y){\n    for(int i = 0; i <= m; i++){\n        int w = y & (1 << i); if(w) w = 1;\n        if(p[x][i + 1] == '0' && w == 1) return false;\n        if(p[x][i + 1] == '1' && w == 0) return false; \n    }\n    return true;\n}\nbool find(int x){\n    for(int j = 1; j < m; j++){\n        int p = x & (1 << j - 1);\n        int q = x & (1 << j);\n        if(p && q) return true; \n    }\n    return false;\n}\nsigned main(){\n    cin >> n >> m;\n    for(int i = 1; i <= n; i++)\n    scanf(\"%s\", s[i] + 1);\n    if(n >= m){\n        for(int i = 1; i <= n; i++)\n            for(int j = 1; j <= m; j++) \n                p[i][j] = s[i][j];\n    }\n    if(n < m){\n        swap(n, m);\n        for(int i = 1; i <= n; i++)\n            for(int j = 1; j <= m; j++)\n            p[i][j] = s[j][i];\n    }\n    for(int i = 1; i < (1 << m); i++) d[i] = find(i);\n    A[0][0] = 1;\n    for(int i = 1; i <= n; i++){\n        FMT(A[i - 1]);\n        for(int j = 0; j < (1 << m); j++){\n            if(!check(i, j) || d[j]) continue;\n            A[i][j] = A[i - 1][j ^ ((1 << m) - 1)];\n        }\n    }\n    for(int j = 0; j < (1 << m); j++) (ans += A[n][j]) %= mod;\n    cout << ans << endl; return 0;\n}\n```\n",
        "postTime": 1585469726,
        "uid": 97783,
        "name": "yyxmy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1539 \u3010[TJOI2011]01\u77e9\u9635\u3011"
    },
    {
        "content": "~~\u539f\u672c\u4ee5\u4e3a\u8fd9\u9053\u9898\u5f88\u96be\u7684\uff0c\u6ca1\u60f3\u5230\u8fd9\u4e48\u6c34~~\n\n\u7531\u4e8e\u77e9\u9635\u8f6c\u7f6e\u4e0d\u5f71\u54cd\u7b54\u6848\uff0c\u56e0\u6b64\u4e0d\u59a8\u5047\u8bbe$n>m$\n\n\u9996\u5148\u770b\u6570\u636e\u8303\u56f4$nm\\le 225$\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c$m\\le 15$\uff0c\u56e0\u6b64\u6211\u4eec\u5f88\u53ef\u80fd\u9700\u8981\u4e00\u4e2a$O(2^m n m)$\u7684\u7b97\u6cd5\n\n~~\u201c\u770b\u6570\u636e\u8303\u56f4\u77e5\u65f6\u95f4\u590d\u6742\u5ea6\u201d\u6280\u80fd get\u221a~~\n\n\u7136\u540e\u60f3\u590d\u6742\u5ea6\u7684\u6bcf\u4e00\u9879\u4ee3\u8868\u4ec0\u4e48\uff0c\u601d\u8003\u518d\u4e09\uff0c\u53d1\u73b0$nm$\u662f\u77e9\u9635\u5927\u5c0f\uff0c$2^m$\u662f\u6bcf\u4e00\u884c\u7684\u53ef\u80fd\u65b9\u6848\u6570\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u8981\u679a\u4e3e\u77e9\u9635\u7684\u6bcf\u4e00\u4e2a\u683c\u5b50\uff0c\u4ee5\u53ca\u6bcf\u4e2a\u683c\u5b50\u586b\u5b8c\u540e\u6700\u540e\u4e00\u884c\u7684\u6837\u5b50\n\n\u4e3a\u4ec0\u4e48\u662f\u6700\u540e\u4e00\u884c\u5462\uff1f\u56e0\u4e3a\u9694\u4e86\u4e00\u884c\uff0c\u4e24\u4e2a\u683c\u5b50\u5c31\u4e0d\u5f71\u54cd\u4e86\u554a\n\n~~\u770b\u4e0a\u53bb\u597d\u50cf[\u63d2\u5934DP](luogu.com.cn/blog/interestingLSY/cha-tou-dp-zong-jie)\u554a~~\n\n\u7efc\u5408\u4e00\u4e0b\uff0c\u6211\u4eec\u5b9a\u4e49\u8fd9\u6837\u4e00\u4e2aDP\u72b6\u6001\uff1a$f_{p,S}$\uff08\u5176\u4e2d$p=(i-1)m+j$\uff09\u4ee3\u8868\u8003\u8651\u5230\u683c\u5b50$(i,j)$\u65f6\uff0c\u6bcf\u4e00\u5217\u6700\u540e\u4e00\u4e2a\u4f4d\u7f6e\u7684\u72b6\u6001\uff0c\u4ed4\u7ec6\u601d\u8003\uff0c\u5b83\u7684\u8f6c\u79fb\u72b6\u6001\u5e94\u8be5\u662f\u8fd9\u6837\u7684\uff1a\n\n- $S_j=0$\uff0c\u8bf4\u660e$(i,j)$\u4e0a\u9762\u586b\u7684\u662f$0$\uff0c\u90a3\u4e48$(i-1,j)$\u586b\u4ec0\u4e48\u90fd\u53ef\u4ee5\uff0c\u5373$f_{p,S}=f_{p-1,S}+f_{p-1,S+\\{j\\}}$\n- $S_j=1$\uff0c\u8bf4\u660e$(i,j)$\u4e0a\u9762\u586b\u7684\u662f$1$\uff0c\u90a3\u4e48\u8981\u6c42$(i-1,j),(i,j-1)$\u586b\u7684\u90fd\u662f$0$\uff0c\u5373$f_{p,S}=[S_{j-1}=0]f_{p-1,S-\\{j\\}}$\uff08\u8fd9\u91cc\u8ba4\u4e3a$S_0\\equiv 0$\uff0c\u8fd9\u6837\u5c31\u4e0d\u7528\u7279\u5224$j=1$\u4e86\uff09\n\n\u6700\u540e$ans=\\sum_{S}f_{nm,S}$\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int mods = 10007;\nint col[250][250];\nint las[1 << 15], nxt[1 << 15];\nsigned main() {\n\tios::sync_with_stdio(false);\n\tint n = 0, m = 0; cin >> n >> m;\n\tfor(int i = 1; i <= n; i++) {\n\t\tchar str[250]; cin >> (str + 1);\n\t\tfor(int j = 1; j <= m; j++) {\n\t\t\tcol[i][j] = (str[j] == '.'? 3: str[j] - '0' + 1);\n\t\t} //\u6709\u4f4d1\uff1a\u53ef\u4ee5\u586b0\uff1b\u6709\u4f4d2\uff1a\u53ef\u4ee5\u586b1\n\t} \n\tif(n < m) {\n\t\tfor(int i = 1; i <= n; i++) {\n\t\t\tfor(int j = i + 1; j <= m; j++) {\n\t\t\t\tswap(col[i][j], col[j][i]);\n\t\t\t}\n\t\t}\n\t\tswap(n, m);\n\t} //\u8c03\u6574\u77e9\u9635\uff0c\u4f7f\u5f97n >= m\n\tlas[0] = 1;\n\tfor(int i = 1; i <= n; i++) {\n\t\tfor(int j = 1; j <= m; j++) {\n\t\t\tfor(int k = 0; k < (1 << m); k++) {\n\t\t\t\tif((col[i][j] & 1) and !(k & (1 << (j - 1)))) {\n\t\t\t\t\tnxt[k] = (nxt[k] + las[k]) % mods;\n\t\t\t\t\tnxt[k] = (nxt[k] + las[k ^ (1 << (j - 1))]) % mods;\n\t\t\t\t} // \u586b0\n\t\t\t\tif((col[i][j] & 2) and (k & (1 << (j - 1)))) {\n\t\t\t\t\tif(!(k & (1 << (j - 2)))) {\n\t\t\t\t\t\tnxt[k] = (nxt[k] + las[k ^ (1 << (j - 1))]) % mods;\n\t\t\t\t\t}\n\t\t\t\t} //\u586b1\n\t\t\t}\n\t\t\tfor(int k = 0; k < (1 << m); k++) {\n\t\t\t\tlas[k] = nxt[k], nxt[k] = 0;\n\t\t\t}\n\t\t}\n\t}\n\tint ans = 0;\n\tfor(int k = 0; k < (1 << m); k++) {\n\t\tans = (ans + las[k]) % mods;\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}\n```\n~~\u6211\u597d\u83dc\u554a~~\n\n![](https://i.loli.net/2020/03/25/fUcRYXCEhilVBgb.jpg)",
        "postTime": 1585145575,
        "uid": 34883,
        "name": "\u543e\u4e43\u4f1a\u864e",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1539 \u3010[TJOI2011]01\u77e9\u9635\u3011"
    },
    {
        "content": "\u8fd9\u91cc\u7ed9\u51fa\u4e00\u4e2a\u72b6\u538b\u7684\u51c6\u786e\u590d\u6742\u5ea6\u5206\u6790\n\n\u8bbe $k$ \u4e3a $m$ \u4e2a 01\u683c\u5b50 \u6392\u6210\u4e00\u6392\u6ca1\u6709\u4e24\u4e2a 1 \u76f8\u90bb\u7684\u65b9\u6848\u6570\n\nUM \u7528\u7206\u641c\u8bc1\u660e\u4e86\u5f53 $m=15$ \u65f6 $k=1597$\n\n~~\u4f46\u662f\u4f60\u8fd9\u4e2a\u4e0d\u4e25\u8c28\u554a~~ \u6211\u4eec\u9700\u8981\u9610\u660e $k$ \u4e0e $m$ \u7684\u5173\u7cfb\n\n\u8bbe $f_{i,j}$ \u4e3a\u4ece\u5de6\u5f80\u53f3\u6446\u4e86 j \u4e2a\u683c\u5b50\uff0c\u6700\u540e\u4e00\u4e2a\u6446\u4e86 i \u7684\u65b9\u6848\u6570\n\n\u5f97\u9012\u63a8\u5f0f\n\n$$ f_{0,i}=f_{0,i-1}+f_{1,i-1} $$\n\n$$ f_{1,i}=f_{0,i-1} $$\n\n\u8fb9\u754c\u503c\n\n$$ f_{0,1}=f_{1,1}=f_{1,2}=1 $$\n\n$$ f_{0,2}=2 $$\n\n\u5219 $ k=f_{0,m}+f_{1,m} $\n\n\u628a $ f_{1,i}=f_{0,i-1} $ \u4ee3\u5165 $ f_{0,i}=f_{0,i-1}+f_{1,i-1} $ \u5f97\n\n$$ f_{0,i}=f_{0,i-1}+f_{0,i-2} $$\n\n\u6613\u5f97\n\n$$ f_{0,i}=F_{i+1} $$\n\n$$ f_{1,i}=F_{i} $$\n\n\u5176\u4e2d $F$ \u4e3a\u6590\u6ce2\u90a3\u5951\u6570\u5217\n\n\u5f97\u51fa\n\n$$ k=F_{m+2} $$\n\n\u90a3\u4e48\u72b6\u538b\u7684\u590d\u6742\u5ea6\u5c31\u4e3a\n\n$$ O(nF_{m+2}^2) $$\n\n\u53ef\u4ee5\u770b\u5230\uff0c$ 1597=F_{15+2} $",
        "postTime": 1602846464,
        "uid": 54591,
        "name": "Seauy",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P1539 \u3010[TJOI2011]01\u77e9\u9635\u3011"
    },
    {
        "content": "\u9996\u5148\uff0c\u6b64\u9898\u66b4\u529b\u72b6\u538b\u53ef\u8fc7\n\n\u4e3a\u5565\u634f\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u6bcf\u884c\u6240\u6709\u7684\u5408\u6cd5\u72b6\u6001\uff0c\u4e5f\u5c31\u662f\u6ca1\u6709\u8fde\u7eed\u7684\u4e24\u4e2a 1 \u7684\u72b6\u6001\u6570\uff0c\u8bb0\u4e3a $k$\uff0c\u90a3\u4e48\u65f6\u95f4\u590d\u6742\u5ea6\u5373\u4e3a $\\Theta(nk^2)$\n\n\u53d1\u73b0 $m=15$ \u65f6\u8fd9\u4e2a $k$ \u4e0d\u4f1a\u5f88\u591a\n\n\u4e3a\u5565\uff0c\u6211\u4eec\u5199\u4e00\u4e2a\u7206\u641c\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint cnt;\nvoid dfs(int n,int s)\n{\n\tif(n>15){cnt++;return;}\n\tif(s&1)dfs(n+1,s<<1);//\u586b0\n\telse dfs(n+1,s<<1),dfs(n+1,s<<1|1);//\u586b1\u6216\u586b0\n}\nint main()\n{\n\tdfs(1,0);\n\tprintf(\"%d\",cnt);\n\treturn 0;\n}\n```\n\u641c\u51fa\u6765 $k=1597$\n\n\u4e0d\u7b97\u5f88\u5927\uff0c\u5982\u679c\u4f60\u5e38\u6570\u5f88\u5c0f\u7684\u8bdd\u662f\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u9898\u7684\n\n\u4f46\u662f\u7a9d\u770b\u8fc7\u8fd9\u4e48\u5199\u7684\u4ee3\u7801\uff0c\u7801\u91cf\u5947\u5927\u65e0\u6bd4\uff08\u751a\u81f3\u6bd4\u7a9d\u7684\u8f6e\u5ed3\u7ebfdp\u8fd8\u957f\n\n\u5f53\u7136\u5566\uff0c\u6211\u4eec\u8fd9\u9053\u9898\u5982\u679c $n\\cdot m\\le 400$\uff0c\u4e5f\u5c31\u662f $m\\le 20$ \u5c31\u53ef\u4ee5\u5361\u6389\u66b4\u529b\u5566\uff08\u5f53\u7136\u8fd9\u4e5f\u628a\u666e\u901a\u7684\u8f6e\u5ed3\u7ebfdp\u5361\u6389\u4e86\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u8fdb\u5165\u6b63\u9898\n\n\u8fd9\u9898\u6211\u4eec\u91c7\u7528\u53e6\u4e00\u79cd\u59ff\u52bf\u7684\u8f6e\u5ed3\u7ebfdp\n\n\u6211\u4eec\u8bbe $f_{i,j,k}$ \u8868\u793a\u5f53\u524d\u679a\u4e3e\u5230 $(i,j)$ \u8fd9\u4e2a\u683c\u5b50\uff0c\u8f6e\u5ed3\u7ebf\u4e0a\u768401\u72b6\u6001\u4e3a $k$ \u7684\u60c5\u51b5\u6709\u591a\u5c11\u79cd\u653e\u7f6e\u65b9\u6cd5\n\n\u8fd9\u91cc\u5462\uff0c\u6211\u81ea\u5df1\u5728\u505a\u8fd9\u4e2a\u9898\u7684\u65f6\u5019\u501f\u52a9\u4e86\u4e00\u70b9\u63d2\u5934dp\u7684\u601d\u60f3\uff0c\u4f46\u662f\u6574\u4f53\u4e0d\u7b97\u662f\u4e00\u4e2a\u63d2\u5934dp\n\n\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4f4d\u8fd0\u7b97\u63d0\u53d6\u51fa\u53f3\u8fb9\u7684\u683c\u5b50\u548c\u4e0a\u9762\u683c\u5b50\u586b\u7684\u662f0\u8fd8\u662f1\n\n~~\u6309\u7167\u5267\u60c5~~\uff0c\u63a5\u4e0b\u6765\u5c31\u662f\u5927\u529b\u5206\u7c7b\u8ba8\u8bba\u65f6\u95f4\u5566\n\n1\u3001\u5f53\u524d\u683c\u5b50\u5fc5\u987b\u586b 0\uff0c\u76f4\u63a5\u8f6c\u79fb\u5373\u53ef  \n2\u3001\u5f53\u524d\u683c\u5b50\u5fc5\u987b\u586b 1\uff0c\u5219\u5728\u53f3\u3001\u4e0a\u683c\u5b50\u586b\u7684\u90fd\u662f0\u624d\u53ef\u8f6c\u79fb  \n3\u3001\u5f53\u524d\u683c\u5b50 0,1 \u90fd\u53ef\u4ee5\u586b\uff0c\u4e14\u53f3\u3001\u4e0a\u683c\u5b50\u586b\u7684\u90fd\u662f0\uff0c\u5219\u5f53\u524d\u683c\u5b50\u53ef\u4ee5\u586b0\u6216\u80051  \n4\u3001\u5f53\u524d\u683c\u5b50 0,1 \u90fd\u53ef\u4ee5\u586b\uff0c\u4e14\u53f3\u3001\u4e0a\u683c\u5b50\u586b\u7684\u6570\u4e2d\u6709**\u81f3\u5c11\u4e00\u4e2a** 1\uff0c\u5219\u5f53\u524d\u683c\u5b50\u5fc5\u987b\u586b 0\n\n\u5f88\u597d\u7406\u89e3\u5427\uff08\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u5199\u7684\u4ee3\u7801\u4e2d\u6709\u51e0\u4e2a\u7ec6\u8282\uff0c\u5728\u4ee3\u7801\u4e2d\u8bb2\u5427qwq\n```cpp\n#include<bits/stdc++.h>\n#define MAXN 240\n#define p 10007\nusing namespace std;\nint n,m;\nchar c[MAXN],ma[MAXN][MAXN];\nint f[2][1<<17],now,pre;//\u6eda\u52a8\u6570\u7ec4\nvoid modify(int& x,int y){x+=y;if(x>p)x-=p;}//\u5361\u5e38\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u7528\u819c\u8fd0\u7b97\u66ff\u4ee3\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\tif(n>=m)\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tscanf(\"%s\",c+1);\n\t\t\tfor(int j=1;j<=m;j++)\n\t\t\t\tma[i][j]=c[j];\n\t\t}\n\telse\n\t{\n\t\tswap(n,m);\n\t\tfor(int j=m;j>=1;j--)\n\t\t{\n\t\t\tscanf(\"%s\",c+1);\n\t\t\tfor(int i=1;i<=n;i++)\n\t\t\t\tma[i][j]=c[i];\n\t\t}\n\t}//\u7ec6\u82821\uff0c\u4f7fm<=n\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++)\n\t\t{\n\t\t\tif(ma[i][j]=='1')ma[i][j]='0';\n\t\t\telse if(ma[i][j]=='0')ma[i][j]='1';\n\t\t}//\u7ec6\u82822,01\u4e92\u6362\uff0c\u53ef\u4ee5\u65b9\u4fbf\u4f4d\u8fd0\u7b97\n\tint max_state=(1<<m);\n\tf[0][max_state-1]=1;//\u7ec6\u82823\uff0c\u8bfb\u8005\u81ea\u884c\u601d\u8003\u521d\u59cb\u72b6\u6001\u4e3a\u4f55\u4e3a\u51681\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=m;j++)\n\t\t{\n\t\t\tpre=now;now^=1;\n\t\t\tmemset(f[now],0,sizeof(f[now]));\n\t\t\tfor(int k=0;k<max_state;k++)\n\t\t\t{\n\t\t\t\tint val=f[pre][k];\n\t\t\t\tif(!val)continue;\n\t\t\t\tint pl1;//right\n\t\t\t\tif(j>1)pl1=(k>>j-2)&1;\n\t\t\t\telse pl1=1;\n\t\t\t\tint pl2=(k>>j-1)&1;//up\n\t\t\t\tif(ma[i][j]=='1')modify(f[now][k|(1<<j-1)],val);\n\t\t\t\telse if(ma[i][j]=='0'){if(pl1&&pl2)modify(f[now][k^(1<<j-1)],val);}\n\t\t\t\telse if(pl1&&pl2)\n\t\t\t\t{\n\t\t\t\t\tmodify(f[now][k],val);\n\t\t\t\t\tmodify(f[now][k^(1<<j-1)],val);\n\t\t\t\t}\n\t\t\t\telse modify(f[now][k|(1<<j-1)],val);\n\t\t\t}\n\t\t}\n\t}\n\tint ans=0;\n\tfor(int i=0;i<max_state;i++)modify(ans,f[now][i]);//\u7edf\u8ba1\u7b54\u6848\n\tprintf(\"%d\",ans%p);\n\treturn 0;\n}\n```\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u4f18\u5316\u8fd9\u4e2a\u4ee3\u7801\n\n\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u4ee3\u7801\u6709\u5f88\u591a\u7684\u5197\u4f59\u72b6\u6001\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u54c8\u5e0c\u8868\u6765\u5b58\u50a8\uff0c\u8282\u7701\u65f6\u95f4&\u7a7a\u95f4\n\n~~\uff08\u7531\u4e8eum\u592a\u61d2\u4e86\u6240\u4ee5\u4e0d\u60f3\u5199\u4e86\uff09~~\n\n\u81f3\u6b64\uff0c\u6211\u4eec\u5c31\u628a\u8fd9\u4e2a\u95ee\u9898\u5728\u5927\u7ea6 $\\Theta(nmk)$ \u7684\u65f6\u95f4\u5185\u505a\u5b8c\u5566\n\n\u8fd9\u91cc\uff0c$k\\approx 3025$\uff0c\u81f3\u4e8e\u4e3a\u5565\uff0c~~\u7559\u4f5c\u4e60\u9898\u81ea\u5df1\u601d\u8003\u5427~~",
        "postTime": 1585187039,
        "uid": 65681,
        "name": "UltiMadow",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1539 \u3010[TJOI2011]01\u77e9\u9635\u3011"
    },
    {
        "content": "### \u3010Analysis\u3011\n\u57fa\u7840\u8f6e\u5ed3\u7ebfdp\uff0c\u56e0\u4e3a\u7528\u666e\u901a\u72b6\u538b\u53ef\u80fd\u8fc7\u4e0d\u53bb\uff0c\u7528\u8f6e\u5ed3\u7ebf\u7684\u590d\u6742\u5ea6\u662f\u53ef\u80fd\u8fc7\u7684\u3002\n\n\u666e\u901a\u72b6\u538b\u9884\u5148\u5904\u7406\u4e00\u4e0b\u6bcf\u884c\u7684\u53ef\u884c\u72b6\u6001\uff0c\u53ef\u80fd\u4e5f\u662f\u53ef\u4ee5\u8fc7\u7684\u3002\n\n\u4e0d\u4f1a\u8f6e\u5ed3\u7ebf\u7684\u53ef\u4ee5\u770b\u770b[P3272 [SCOI2011]\u5730\u677f](https://www.luogu.com.cn/problem/P3272)\u6216[P2595 [ZJOI2009]\u591a\u7c73\u8bfa\u9aa8\u724c](https://www.luogu.com.cn/problem/P2595)\u3002\n\n\u8003\u8651\u9010\u683c\u8f6c\u79fb\uff0c\u4e0a\u9762\u6216\u53f3\u8fb9\u53ea\u8981\u6709\u4e00\u4e2a\u683c\u5b50\u662f$1$\uff0c\u90a3\u4e48\u8fd9\u4e2a\u683c\u5b50\u53ea\u80fd\u653e$0$,\u6216\u662f\u5df2\u7ecf\u586b\u597d\u4e86\u3002\n\u5bf9\u4e8e$n<m$\u7684\u65f6\u5019\u53ef\u4ee5\u628a\u77e9\u9635\u7ffb\u8f6c\u8fc7\u6765\u3002\n\n\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$1.dp_{t,s}=dp_{t,s}+dp_{t-1,(s>>1)}$$\n$$2.dp_{t,s}=dp_{t,s}+dp_{t-1,(s>>1)|(1<<m-1)}$$\n\n1. \u5f53\u524d\u53ef\u4ee5\u653e$0$\u3002\n\n2. \u5f53\u524d\u53ef\u4ee5\u653e$1$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\times m \\times 2^{min(n,m)})$\u3002\n\n### \u3010Code\u3011\uff08\u61d2\u5f97\u6eda\u52a8\u6570\u7ec4\u4e86\uff09\n```cpp\n#include <iostream>\n#include <functional>\n#include <algorithm>\n#include <cstring>\n#include <vector>\nusing namespace std;\n\ntypedef long long int64;\nconst int P = 1e4 + 7;\nconst int MAXS = 1 << 15 | 1;\nconst int MAXN = 230;\nint dp[MAXN][MAXS];\nint g[MAXN][MAXN];\nint tmp[MAXN][MAXN];\nint n, m;\n\ninline void incr(int& x, int y) { x += y; x -= x >= P ? P : 0; }\n\nvoid OUT()\n{\n\tfor (int i = 1;i <= n; ++i)\n\t\tfor (int j = 1;j <= m; ++j)\n\t\t\tcerr << g[i][j] << \" \\n\"[j==m];\n}\n\nint main(void)\n{\n\tcin >> n >> m;\n\tstring cc;\n\tfor (int i = 1; i <= n; ++i)\n\t{\n\t\tcin >> cc;\n\t\tfor (int j = 1; j <= m; ++j)\n\t\t{\n\t\t\tif (cc[j-1] == '.')\n\t\t\t\tg[i][j] = -1;\n\t\t\telse\n\t\t\t\tg[i][j] = cc[j-1] - '0';\n\t\t}\n\t}\n\n\tfunction <bool(int, int, int)> check = [&](int x, int y, int s)\n\t{\n\t\tint k = m - y + 1;\n\t\tfor (int i = 2; i < y; ++i)\n\t\t\tif (((s >> i + k) & 1) == ((s >> i - 1 + k) & 1) && (((s>>i+k) & 1)))\n\t\t\t\treturn false;\n\t\tfor (int i = 1; i < k; ++i)\n\t\t\tif (((s >> i) & 1) == ((s >> i - 1) & 1) && ((s>>i) & 1))\n\t\t\t\treturn false;\n\t\tfor (int i = 1; i < y; ++i)\n\t\t\tif (g[x][i] != -1 && ((s >> i + k - 1) & 1) != g[x][i])\n\t\t\t\treturn false;\n\t\tfor (int i = 0; i < k; ++i)\n\t\t\tif ((g[x - 1][y + i] != -1) && (((s >> i) & 1) != g[x - 1][y + i]))\n\t\t\t\treturn false;\n\t\treturn true;\n\t};\n\n\tif (n < m)\n\t{\n\t\tfor (int i = 1; i <= n; ++i)\n\t\t\tfor (int j = 1; j <= m; ++j)\n\t\t\t\ttmp[j][i] = g[i][j];\n\t\tswap(n, m);\n\t\tfor (int i = 1; i <= n; ++i)\n\t\t\tfor (int j = 1; j <= m; ++j)\n\t\t\t\tg[i][j] = tmp[i][j];\n\t}\n\t\n\t//OUT();\n\tfor (int i = 1;i <= m; ++i)\n\t\tg[0][i] = 0;\n\n\tint all = 1 << m;\n\tint now = 0, pre = 1;\n\tint tot = 0;\n\t\n\tdp[0][0] = 1;\n\tfor (int i = 1; i <= n; ++i)\n\t{\n\t\tfor (int j = 1; j <= m; ++j)\n\t\t{\n\t\t\t++tot;\n\t\t\tfor (int s = 0; s < all; ++s)\n\t\t\t{\n\t\t\t\tif (!check(i, j, s))\n\t\t\t\t\tcontinue;\n\t\t\t\tif (j == 1)\n\t\t\t\t{\n\t\t\t\t\tbool two = (s & 1) ^ 1;\n\t\t\t\t\t\n\t\t\t\t\tif (g[i][j] == -1)\n\t\t\t\t\t{\n\t\t\t\t\t\tincr(dp[tot][(s>>1)], dp[tot - 1][s]);\n\t\t\t\t\t\tif (two)\n\t\t\t\t\t\t\tincr(dp[tot][(s>>1)|(1<<m-1)], dp[tot - 1][s]);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif (g[i][j] == 0)\n\t\t\t\t\t\t\tincr(dp[tot][(s>>1)], dp[tot-1][s]);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tif (two)\n\t\t\t\t\t\t\t\tincr(dp[tot][(s>>1) | (1<<m-1)], dp[tot - 1][s]);\n\t\t\t\t\t}\n\t\t\t\t\t\n//\t\t\t\t\tcerr << \"dp : \" << i << \" \" << j << \" \" << dp[tot][(s>>1)|(1<<m-1)] << '\\n';\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tbool up = s & 1, left = (s >> m - 1) & 1;\n\t\t\t\tbool two = (up ^ 1) & (left ^ 1);\n\t\t\t\t\t\n\t\t\t\tif (g[i][j] == -1)\n\t\t\t\t{\n\t\t\t\t\tincr(dp[tot][(s>>1)], dp[tot - 1][s]);\n\t\t\t\t\tif (two)\n\t\t\t\t\t\tincr(dp[tot][(s>>1) | (1<<m-1)], dp[tot - 1][s]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (g[i][j] == 0)\n\t\t\t\t\t\tincr(dp[tot][(s>>1)], dp[tot - 1][s]);\n\t\t\t\t\telse\n\t\t\t\t\t\tif (two)\n\t\t\t\t\t\t\tincr(dp[tot][(s>>1) | (1<<m-1)], dp[tot - 1][s]);\n\t\t\t\t}\n\t\t\t\t\n//\t\t\t\tcerr << \"dp : \" << i << \" \" << j << \" \" << dp[tot][s>>1 | (1<<m-1)] << '\\n';\n\t\t\t}\n\t\t}\n\t}\n\tint ans = 0;\n\tfor (int s = 0; s < all; ++s)\n\t\tincr(ans, dp[tot][s]);\n\tcout << ans << '\\n';\n\treturn 0;\n}\n```",
        "postTime": 1585135440,
        "uid": 75093,
        "name": "Awdrgysxc",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1539 \u3010[TJOI2011]01\u77e9\u9635\u3011"
    },
    {
        "content": "### \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a\u77e9\u9635\uff0c\u4e2d\u95f4\u7684\u65b9\u683c\u6709\u82e5\u5e72\u5df2\u7ecf\u586b\u597d\u7684\u6570\u5b57\uff0c\u8981\u6c42\u5728\u672a\u586b\u7684\u683c\u5b50\u4e2d\u586b\u5165\u6570\u5b57\uff0c\u8be2\u95ee\u6709\u591a\u5c11\u4e2a\u65b9\u6848\u4f7f\u5f97\u76f8\u90bb\u7684\u683c\u5b50\u4e0d\u90fd\u4e3a $1$\u3002\n\n### \u601d\u8def\n\n\u9996\u5148\u89c2\u5bdf\u6570\u636e\u8303\u56f4\uff0c$n\\times m \\leq 225$\uff0c\u53ef\u4ee5\u8bc1\u660e\uff0c$n$ \u548c $m$ \u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u6570\u4e0d\u5927\u4e8e $15$ \uff0c\u53ef\u4ee5\u53cd\u8bc1\uff0c\u5982\u679c\u90fd\u5927\u4e8e $15$\uff0c\u90a3\u4e48\u4e58\u79ef\u5fc5\u5b9a\u5927\u4e8e $225$\u3002\n\n\u5047\u8bbe$n\\geq m$\uff08\u5982\u679c$n< m$ \uff0c\u5219\u5c06\u77e9\u9635\u6cbf $45^\\circ$ \u89d2\u7ffb\u8f6c\uff0c\u4fdd\u8bc1 $n\\geq m$\uff09\u4e5f\u5c31\u662f $m\\leq 15$ \uff0c\u5bf9\u4e8e\u8fd9\u7c7b\u5f88\u5c0f\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u8003\u8651\u641c\u7d22\u6216\u8005\u72b6\u538b$\\texttt{dp}$\u3002\n\n\u90a3\u4e48\u8fd9\u7bc7\u9898\u89e3\u91c7\u7528\u72b6\u538b$\\texttt{dp}$\u3002\n\n - \u600e\u6837\u72b6\u538b\uff1a\u5bf9\u6bcf\u4e00\u884c\u7684\u72b6\u6001\u8fdb\u884c\u538b\u7f29\uff0c\u5982\u679c\u54ea\u4e00\u4f4d\u662f $1$ \uff0c\u5219\u4e8c\u8fdb\u5236\u8868\u793a\u7684\u8fd9\u4e00\u4f4d\u5c31\u4e3a $1$\uff0c\u4f8b\u5982\u7b2c $1,3$ \u4f4d\u4e3a $1$ \uff0c\u800c\u5176\u4ed6\u4f4d\u4e3a $0$ \uff0c\u5c31\u8868\u793a\u4e3a $000101$\uff0c\u5341\u8fdb\u5236\u8868\u793a\u5c31\u662f $5$\u3002\n - \u7528$f_{i,S}$\u8868\u793a\u7b2c$i$\u884c\u72b6\u6001\u4e3a $S$ \u65f6\u7684\u65b9\u6848\u6570\u3002\u90a3\u4e48\u6709\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff08\u5176\u4e2d $K$ \u8868\u793a\u4e0a\u4e00\u884c\u80fd\u591f\u8f6c\u79fb\u7684\u72b6\u6001\uff0c\u6ee1\u8db3$S\\ \\&K=0$\u4ee5\u53ca $S$ \u548c $K$ \u4e2d\u90fd\u4e0d\u5b58\u5728\u76f8\u90bb\u7684 $1$\uff09\uff1a\n \n $$ f_{i,S}=f_{i,S}+f_{i-1,K}$$\n\n### \u4ee3\u7801\n\n\u51e0\u4e2a\u53d8\u91cf\uff1a\n\n$ch$:\u8f93\u5165\u7684\u5b57\u7b26\u3002\n\n$n,m$:\u77e9\u9635\u7684\u957f\u548c\u5bbd\u3002\n\n$a_{i,j}$:\u77e9\u9635\u7b2c $i$ \u884c\u7b2c $j$ \u5217\u662f\u5426\u6709\u56fa\u5b9a\u7684\u503c\uff08\u6709\u5219\u4e3a\u8be5\u503c\uff0c\u6ca1\u6709\u5219\u4e3a $-1$\uff09\u3002\n\n$numone_i,numzero_i$:\u9884\u5904\u7406\u6570\u7ec4\uff0c\u8868\u793a\u7b2c $i$ \u884c\u54ea\u4e9b\u4f4d\u6709\u56fa\u5b9a\u503c\uff08 $0$ \u6216 $1$ \uff09\u3002\n\n$cando_i$:\u9884\u5904\u7406\u6570\u7ec4\uff0c\u8868\u793a\u7b2c $i$ \u4e2a\u6ee1\u8db3\u8981\u6c42\u7684\u72b6\u6001\uff08\u4e0d\u5b58\u5728\u76f8\u90bb\u7684 $1$\uff09\u3002\n\n$cnt$:\u8868\u793a $cando$ \u6570\u7ec4\u7684\u4e2a\u6570\u3002\n\n$f_{i,S}$:\u8868\u793a\u7b2c$i$\u884c\u72b6\u6001\u4e3a $S$ \u65f6\u7684\u65b9\u6848\u6570\u3002\n\n```cpp\nchar ch;\nint n,m;\nint a[N][N];\nint numone[N],numzero[N],cando[1<<15],cnt;\nint f[N][1<<15];\n```\n\n\n\n\u5982\u679c$n< m$ \uff0c\u5219\u5c06\u77e9\u9635\u6cbf $45^\\circ$ \u89d2\u7ffb\u8f6c\uff08\u538b\u884c\u7684\u5199\u6cd5\uff09\uff1a\n\n```cpp\ncin>>n>>m;\nfor(int i=1;i<=n;i++){\n\tfor(int j=1;j<=m;j++){\n\t\tcin>>ch;\n\t\ta[i*(n>=m)+j*(n<m)][j*(n>=m)+i*(n<m)]=\n\t\t   (ch=='1'||ch=='0')?ch-'0':-1;\n\t}\n}\nif(n<m)swap(n,m);\n```\n\n\u9884\u5904\u7406\u6bcf\u4e00\u884c\u54ea\u4e9b\u4f4d\u7684\u503c\u5df2\u88ab\u56fa\u5b9a\uff08\u5f53\u540e\u9762\u679a\u4e3e\u7b2ci\u884c\u7684\u72b6\u6001 $S$ \u65f6\uff0c\u5fc5\u987b\u6ee1\u8db3 $S\\ \\&\\ numone_i=numone_i$\u53ca$S\\ \\&\\ numzero_i=0$\uff09\uff1a\n\n```cpp\nfor(int i=1;i<=n;i++){\n\tfor(int j=1;j<=m;j++){\n\t\tif(a[i][j]==1)numone[i]+=1<<(m-j);\n\t\tif(a[i][j]==0)numzero[i]+=1<<(m-j);\n\t}\n}\n```\n\u7b80\u5355\u9884\u5904\u7406\u4e00\u4e0b\u54ea\u4e9b\u72b6\u6001\u7b26\u5408\u8981\u6c42\uff08\u4e0d\u5b58\u5728\u76f8\u90bb\u7684 $1$ \uff09\uff1a\n\n```cpp\nfor(int i=0;i<(1<<m);i++){\n\tif((i&(i<<1))||(i&(i>>1)))continue;\n\tcando[++cnt]=i;\n}\n```\n\u72b6\u538b$\\texttt{dp}$\u4e3b\u8981\u4ee3\u7801\uff1a\n\n - \u521d\u59cb\u5316\uff1a\n \n ```cpp\nf[0][0]=1;\n```\n - \u72b6\u6001\u8f6c\u79fb\uff1a\n ```cpp\nfor(int i=1;i<=n;i++){\n\tfor(int j=1;j<=cnt;j++){\n\t\tif((cando[j]&(numone[i]))!=numone[i])continue;\n\t\tif(((cando[j])&(numzero[i])))continue;\n\t\tfor(int k=1;k<=cnt;k++){\n\t\t\tif(cando[k]&cando[j])continue;\n\t\t\tf[i][cando[j]]=(f[i][cando[j]]+f[i-1][cando[k]])%mod;\n\t\t}\n\t}\n}\n```\n\u7edf\u8ba1\u7b54\u6848\uff1a\n\n```cpp\nint ans=0;\nfor(int j=1;j<=cnt;j++){\n\tans=(ans+f[n][cando[j]])%mod;\n}\ncout<<(ans%mod+mod)%mod<<endl;\n```\n\u7ed3\u675f\uff1a\n```cpp\nreturn 0;\n```\n\u8fde\u8d77\u6765\u5c31\u662f\u5b8c\u6574\u7684\u4ee3\u7801\u5566\uff01\n \n\n",
        "postTime": 1605968573,
        "uid": 148195,
        "name": "gcwixsxr",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1539 \u3010[TJOI2011]01\u77e9\u9635\u3011"
    },
    {
        "content": "## \u9898\u76ee\u5927\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a\u77e9\u9635\uff0c\u5176\u4e2d\u90e8\u5206\u4f4d\u7f6e\u5df2\u7ecf\u88ab\u586b\u4e0a $0$ \u6216 $1$\uff0c\u6c42\u4f7f $1$ \u4e92\u4e0d\u76f8\u90bb\u7684\u7528 $0$ \u6216\u8005$1$ \u586b\u6ee1\u6574\u4e2a\u77e9\u9635\u7684\u586b\u6cd5\u3002\n\n## \u601d\u8def\u53ca\u505a\u6cd5\n\n\u9996\u5148\u770b\u6570\u636e\u8303\u56f4 $n \\ast m \\le 225$\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u8fd9\u4e2a\u77e9\u9635\u5728\u4e0d\u540c\u60c5\u51b5\u4e0b\u6700\u77ed\u8fb9\u7684\u6700\u5927\u503c\u662f $15$\uff0c\u800c\u8fd9\u6b63\u597d\u53ef\u4ee5\u72b6\u538bdp\u3002\n\n(\u4e0b\u6587\u7ea6\u5b9a $n \\le m$\uff0c\u5982\u679c\u51fa\u73b0 $n \\gt m$ \u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4ea4\u6362\u5b83\u4eec\u5e76\u8f6c\u7f6e\u77e9\u9635)\n\n\u4f46\u662f\u679a\u4e3e $2^{n}$ \u662f\u4e0d\u73b0\u5b9e\u7684\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u4f60\u7684\u590d\u6742\u5ea6\u53d8\u4e3a $O(n \\cdot 2^{2n})$ \uff08\u5f53 $n=15$ \u7684\u65f6\u5019\u5c31\u76f4\u63a5\u590d\u6742\u5ea6\u7206\u70b8\uff09\n\n\u56e0\u4e3a\u9898\u76ee\u7684\u4e00\u4e9b\u9650\u5236\uff0c\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u5e76\u4e0d\u662f\u6bcf\u4e2a\u72b6\u6001\u90fd\u80fd\u7528\u4e0a\uff0c\u4e5f\u5c31\u662f\u72b6\u538b\u540e\u4e24\u4e2a1\u76f8\u90bb\u7684\u60c5\u51b5\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u8bb0\u5f55\u6bcf\u4e2a\u53ef\u7528\u72b6\u6001\u3002\u6700\u540e\u53d1\u73b0\u53ef\u7528\u72b6\u6001\u6570\uff08\u8bb0\u4e3a $cnt$\uff09$cnt \\le 1600$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u8fdb\u884c\u72b6\u538bdp\uff0c\u590d\u6742\u5ea6 $O(n \\cdot cnt^2)$\u3002\n\n\u4ee5\u4e0a\u5c31\u662f\u8fd9\u4e2a\u9898\u7684\u601d\u8def\uff0c\u5269\u4e0b\u5c31\u662f\u5b9e\u73b0\u7684\u95ee\u9898\u4e86\u3002\n\n\u6ce8\u610f\u4e00\u70b9\uff0c\u8f6c\u79fb\u7684\u65f6\u5019\u5f53\u4e14\u4ec5\u5f53\u4f60\u5f53\u524d\u7684\u72b6\u6001\u80fd\u548c\u5f53\u524d\u884c\u5df2\u6709\u7684\u72b6\u6001\u5339\u914d\u5230\u7684\u65f6\u5019\uff08$0$ \u7684\u5730\u65b9\u540c\u4e3a $0$\uff0c$1$ \u7684\u5730\u65b9\u540c\u4e3a $1$\uff0c \u5269\u4f59\u5730\u65b9\u968f\u610f\uff09\u624d\u80fd\u5229\u7528\u8fd9\u4e2a\u72b6\u6001\u8f6c\u79fb\u3002\u6240\u4ee5\u9700\u8981\u4e00\u70b9\u5904\u7406\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include <iostream>\n#include <cstring>\n#include <cstdio>\n\nusing namespace std;\n\ntypedef int ll;\nconst ll MAXN = 1e6+10, MOD = 10007;\n\nll N, M, zt[MAXN], cnt, num[230], f[2][2000], num2[230]; // zt[]\uff1a\u8bb0\u5f55\u6709\u7528\u72b6\u6001\nchar g[230][230], g2[230][230]; // g2[][]\uff1a\u6700\u7ec8\u4f7f\u7528\u7684\u77e9\u9635\n\nbool check(ll);\n\nint main() {\n    ios::sync_with_stdio(false);\n    cin >> N >> M;\n    for (ll i = 1; i <= N; i++)\n        for (ll j = 1; j <= M; j++)\n            cin >> g[i][j];\n    if (N < M) {\n        for (ll i = 1; i <= N; i++)\n            for (ll j = 1; j <= M; j++)\n                g2[j][i] = g[i][j];\n        swap(N, M);\n    } else {\n    \tfor (ll i = 1; i <= N; i++) \n\t\t\tfor (ll j = 1; j <= M; j++)\n\t\t\t\tg2[i][j] = g[i][j];\t\n    }\n    for (ll i = 0; i < (1LL << M); i++)\n        if (check(i)) zt[++cnt] = i;\n    for (ll i = 1; i <= N; i++)\n    \tfor (ll j = 1; j <= M; j++) {\n\t\t\tif (g2[i][j] == '1') num[i] += (1LL << (j - 1));\n\t\t\tif (g2[i][j] == '0') num2[i] += (1LL << (j - 1)); // \u8003\u8651\u8fd9\u4e24\u4e2a\u5904\u7406\u4ee5\u53ca\u5728\u4e0b\u9762\u7684\u4f7f\u7528\uff0c\u662f\u4fdd\u8bc1\u6b63\u786e\u6027\u7684\u5173\u952e\u3002\n\t\t}\n\tfor (ll i = 1; i <= cnt; i++)\n\t\tif (((num[1] & zt[i]) == num[1]) && ((num2[1] & (~zt[i])) == num2[1])) f[1][i] = 1;\n\tfor (ll i = 2; i <= N; i++) {\n\t\tfor (ll j = 1; j <= cnt; j++) {\n\t\t\tf[i&1][j] = 0;\n\t\t\tfor (ll k = 1; k <= cnt; k++) {\n\t\t\t\tif (!(zt[j] & zt[k]) && ((num[i] & zt[j]) == num[i]) && ((num2[i] & (~zt[j])) == num2[i])) {\n\t\t\t\t\tf[i&1][j] = (f[i&1][j] + f[(i-1)&1][k]) > MOD ? (f[i&1][j] + f[(i-1)&1][k] - MOD) : (f[i&1][j] + f[(i-1)&1][k]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tll ans = 0;\n\tfor (ll i = 1; i <= cnt; i++) \n\t\tans = (ans + f[N&1][i] > MOD) ? (ans + f[N&1][i] - MOD) : (ans + f[N&1][i]);\n\tcout << ((ans > MOD) ? ans - MOD : ans);\n    return 0;\n}\n\nbool check(ll a) {\n    if (a & (a << 1)) return false;\n    if (a & (a >> 1)) return false;\n    return true;\n}\n```",
        "postTime": 1602689958,
        "uid": 249294,
        "name": "\u4e03\u8272\u4e36\u4eba\u5076\u4f7f",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1539 \u3010[TJOI2011]01\u77e9\u9635\u3011"
    }
]
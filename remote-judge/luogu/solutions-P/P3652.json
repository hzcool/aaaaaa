[
    {
        "content": "### \u7b80\u8ff0\u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u4e9b\u8d27\u6e90\u5730\uff0c\u4e00\u4e9b\u4e2d\u8f6c\u5c9b\uff0c\u4ee5\u53ca\u4e00\u4e2a\u7ec8\u70b9\u2014\u2014\u519b\u4e8b\u57fa\u5730\u3002\n\n\u8d27\u6e90\u5730\u5206\u4e3a\u4e24\u79cd\uff0c\u666e\u901a\u8d27\u548c\u7279\u6b8a\u8d27\u3002\n\n\u5bf9\u4e8e\u4e2d\u8f6c\u5c9b $i$ \uff0c\u6700\u591a\u53ef\u4ee5\u4e2d\u8f6c $w_i$ \u4ef6\u8d27\u7269\uff0c\u4e2d\u8f6c\u5c9b\u53d1\u5411\u53e6\u4e00\u4e2a\u4e2d\u8f6c\u5c9b\u6216\u519b\u4e8b\u57fa\u5730\u7684\u8d27\u7269\u5206\u522b\u4e0d\u80fd\u8d85\u8fc7 $d_i$ \u3002\n\n\u4e0a\u9762\u8d27\u7269\u7686\u6307\u666e\u901a\u8d27\u7269\uff0c\u7279\u6b8a\u8d27\u7269\u4e0d\u4f1a\u53d7\u5230\u9650\u5236\u3002\n\n\u4e2d\u8f6c\u5c9b\u4e4b\u95f4\u6709 $e$ \u6761\u822a\u9053\uff0c\u822a\u9053 $i$ \u6709\u8fb9\u6743\u3002\u5f00\u8f9f\u822a\u7ebf $u-v$ \u7684\u4ee3\u4ef7\u662f $u$ \u548c $v$ \u4e4b\u95f4\u7684\u6700\u77ed\u8def\u3002\n\n\u6700\u540e\u5168\u5c40\u7684\u4ee3\u4ef7\u662f\u822a\u7ebf\u4ee3\u4ef7\u7684\u6700\u5927\u503c\u3002\n\n\u8981\u6c42\u5728\u6240\u6709\u8d27\u7269\u90fd\u80fd\u591f\u5230\u8fbe\u519b\u4e8b\u57fa\u5730\u7684\u524d\u63d0\u4e0b\uff0c\u6700\u5c0f\u4ee3\u4ef7\u662f\u591a\u5c11\u3002\n\n### \u89e3\u9898\u601d\u8def\n\n\u770b\u5230\u4ee3\u4ef7\u662f\u6700\u5927\u503c\uff0c\u8981\u6c42\u5176\u6700\u5c0f\uff0c\u8003\u8651\u53ef\u4ee5\u4e8c\u5206\u3002\u5c06\u4ee3\u4ef7\u5c0f\u4e8e\u7b49\u4e8e\u4e8c\u5206\u7b54\u6848 $\\text{mid}$ \u7684\u822a\u7ebf\u5168\u90fd\u52a0\u8fdb\u53bb\uff0c\u770b\u662f\u5426\u80fd\u5c06\u6240\u6709\u8d27\u7269\u90fd\u9001\u8fbe\u519b\u4e8b\u57fa\u5730\u3002\u4e8c\u5206\u6b63\u786e\u6027\u663e\u7136\u3002\n\n\u5206\u522b\u8003\u8651\u7279\u6b8a\u8d27\u7269\u548c\u666e\u901a\u8d27\u7269\u3002\n\n\u9996\u5148\u8003\u8651\u7279\u6b8a\u8d27\u7269\uff0c\u53ea\u8981\u8d27\u6e90\u5730\u548c\u519b\u4e8b\u57fa\u5730\u76f8\u8fde\uff0c\u5373\u53ef\u5168\u90e8\u8fd0\u5f80\u519b\u4e8b\u57fa\u5730\u3002\u6211\u4eec\u5c06\u6240\u6709\u822a\u7ebf\u5168\u90e8\u8fde\u4e0a\uff0c\u5e76\u8fde\u53cd\u8fb9\uff08\u57fa\u5730\u8fde\u5411\u4e2d\u8f6c\u5c9b\uff0c\u4e2d\u8f6c\u5c9b\u8fde\u5411\u8d27\u6e90\u5730\uff09\u3002\u4e2d\u8f6c\u5c9b\u95f4\u8fb9\u6743\u8bbe\u4e3a\u822a\u7ebf\u5f00\u8f9f\u4ee3\u4ef7\u3002\u4ece\u519b\u4e8b\u57fa\u5730\u5f00\u59cb\u4f7f\u7528\u6700\u77ed\u8def\u7b97\u6cd5\uff0c\u6700\u5c0f\u5316\u5230\u5404\u4e2a\u8d27\u6e90\u5730\u7684\u8def\u5f84\u4e0a\u7684\u6700\u5927\u8fb9\u6743\u3002\u53ef\u4ee5\u53d1\u73b0\u5c06\u6240\u6709\u7279\u6b8a\u8d27\u6e90\u5730\u7684\u7b54\u6848\u53d6 $\\text{max}$ \u662f\u4e8c\u5206\u4e0b\u754c\u3002\n\n\u81f3\u4e8e\u5982\u4f55\u6c42\u51fa\u4e24\u5c9b\u95f4\u822a\u7ebf\u4ee3\u4ef7\uff0c\u4f7f\u7528 $n^3$ \u7684\u6700\u77ed\u8def\u5373\u53ef\u3002\n\n\u7136\u540e\u8003\u8651\u5982\u4f55\u6c42\u662f\u5426\u6240\u6709\u666e\u901a\u8d27\u7269\u90fd\u53ef\u5230\u8fbe\u519b\u4e8b\u57fa\u5730\u3002\n\n\u4f7f\u7528\u7f51\u7edc\u6d41\u6c42\u6700\u5927\u6d41\u3002\u8d27\u6e90\u5730\u8fde\u4e2d\u8f6c\u5c9b\u5bb9\u91cf\u4e3a $\\text{inf}$ \uff0c\u4e2d\u8f6c\u5c9b\u4e4b\u95f4\u548c\u4e2d\u8f6c\u5c9b\u5230\u519b\u4e8b\u57fa\u5730\u7684\u8fb9\u5bb9\u91cf\u4e3a $d$ \uff0c\u5c06\u4e2d\u8f6c\u5c9b\u62c6\u70b9\u63a7\u5236\u7ecf\u8fc7\u5c9b\u7684\u6d41\u91cf\u4e0d\u8d85\u8fc7 $w$ \u3002\n\n\u968f\u540e\u8dd1\u6700\u5927\u6d41\u5c31\u597d\u4e86\uff0c\u6b64\u9898\u89e3\u51b3\u3002\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <vector>\n#include <queue>\n\n#define int long long\n#define Mp make_pair\n#define val lim\n#define pb push_back\nusing namespace std;\n\nint read()\n{\n\tint a = 0,x = 1;char ch = getchar();\n\twhile(ch > '9' || ch < '0') {if(ch == '-') x = -1;ch = getchar();}\n\twhile(ch >= '0' && ch <= '9') {a = a*10 + ch-'0';ch = getchar();}\n\treturn a*x;\n}\nconst int N=1e6+7,inf = 1e9+7;\nint n,m,X,E,a[N],w[N],d[N],b[N],M,s,t;\nvector<int>g[307];\nint mp[500][500],dis[N],vis[N];\nint head[N],go[N],nxt[N],cnt,lim[N],cur[N];\nvoid add(int u,int v,int w)\n{\n\tgo[++cnt] = v;\n\tnxt[cnt] = head[u];\n\thead[u] = cnt;\n\tlim[cnt] = w;\n}\nstruct node{int u,v,w;}edge[N];\nvoid dij(int pos)\n{\n\tpriority_queue<pair<int,int> >q;\n\tq.push(Mp(0,pos));\n\twhile(!q.empty()) {\n\t\tint u = q.top().second;\n\t\tif(vis[u]) {q.pop();continue;}\n\t\tdis[u] = -q.top().first;q.pop();vis[u] = 1;\n\t\tfor(int e = head[u];e;e = nxt[e]) {\n\t\t\tint v = go[e];if(dis[v]) continue;\n\t\t\tq.push(Mp(min(-dis[u],-lim[e]),v));\n\t\t}\n\t}\n}\n\nbool BFS()\n{\n\tfor(int i = s;i <= t;i ++) dis[i] = 0;\n\tqueue<int>q;q.push(s);dis[s] = 1;\n\twhile(!q.empty()) {\n\t\tint u = q.front();q.pop();\n\t\tfor(int e = head[u];e;e = nxt[e]) {\n\t\t\tint v = go[e];\n\t\t\tif(dis[v] || !lim[e]) continue;\n\t\t\tdis[v] = dis[u] + 1;q.push(v);\n\t\t}\n\t}\n\treturn dis[t];\n}\n\nint DFS(int u,int limit)\n{\n\tif(u == t || !limit) return limit;\n\tint ret = 0;\n\tfor(int &e = head[u];e; e= nxt[e]) {\n\t\tint v = go[e];if(dis[v] != dis[u] + 1|| !lim[e]) continue;\n\t\tint tmp = DFS(v,min(lim[e],limit));\n\t\tlim[e] -= tmp,lim[e^1] += tmp;\n\t\tlimit -= tmp,ret += tmp;\n\t\tif(!limit) break;\n\t}\n\treturn ret;\n}\n\nbool check(int limit)\n{\n\tfor(int i = s;i <= t;i ++) head[i] = 0;cnt = 1;int sum = 0;\n\tfor(int i = 1;i <= n;i ++) add(s,i,a[i]),add(i,s,0),sum += a[i];\n    //\u8d27\u6e90\u5730\u548c\u4e2d\u8f6c\u5c9b\n\tfor(int i = 1;i <= m;i ++) {\n\t\tif(b[i]) add(i+n+m,t,d[i]),add(t,i+n+m,0);\n        //\u4e2d\u8f6c\u5c9b\u548c\u519b\u4e8b\u57fa\u5730\n\t\tadd(i+n,i+n+m,w[i]);add(i+n+m,i+n,0);\n        //\u62c6\u70b9\u90e8\u5206\n\t\tfor(auto it = g[i].begin();it != g[i].end();++ it) {\n\t\t\tif(*it <= n) add(*it,i+n,inf),add(i+n,*it,0);\n            //\u53ea\u8fde\u666e\u901a\u8d27\u6e90\u5730\uff0c\u7279\u6b8a\u8d27\u6e90\u5730\u4e0d\u5fc5\u7406\u4f1a\n\t\t}\n\t}\n\tfor(int i = 1;i <= M && edge[i].w <= limit;i ++) {\n\t\tadd(edge[i].u+n+m,edge[i].v+n,d[edge[i].u]);add(edge[i].v+n,edge[i].u+n+m,0);\n\t\tadd(edge[i].v+n+m,edge[i].u+n,d[edge[i].v]);add(edge[i].u+n,edge[i].v+n+m,0);\n        //\u8fde\u4e0a\u53ef\u4ee5\u8fde\u7684\u8fb9\n\t}\n//\tputs(\"!\");printf(\"sum=%d\\n\",sum);\n\tfor(int i = s;i <= t;i ++) cur[i] = head[i];\n\twhile(BFS()) {sum -= DFS(s,inf);for(int i = s;i <= t;i ++) head[i] = cur[i];}\n\treturn !sum;//sum=0\u8bf4\u660e\u6240\u6709\u8d27\u7269\u90fd\u53ef\u4ee5\u9001\u5230\u519b\u4e8b\u57fa\u5730\n}\nbool cmp(node a,node b) {return a.w < b.w;}\nsigned main()\n{\n//\tfreopen(\"in.in\",\"r\",stdin);\n\tn = read(),m = read(),X = read(),E = read();\n\tfor(int i = 1;i <= n+X;i ++) a[i] = read();\n\tfor(int i = 1;i <= m;i ++) w[i] = read();\n\tfor(int i = 1;i <= m;i ++) d[i] = read();\n\tfor(int i = 1;i <= m;i ++) {\n\t\tint k = read();\n\t\tfor(int j = 1;j <= k;j ++) {\n\t\t\tint u = read();g[i].pb(u);\n\t\t\tadd(n+X+i,u,0);\n\t\t}\n\t\tb[i] = read();if(b[i]) add(n+X+m+1,n+X+i,0); \n\t}\n\tfor(int i = 1;i <= E;i ++) {\n\t\tint u = read(),v = read(),w = read();\n\t\tmp[u][v] += w,mp[v][u] += w;//\u8fd9\u91cc\u662f\u770b\u8ba8\u8bba\u533a\u63d0\u5230\u7684\uff0c\u6211\u5c31\u8fd9\u4e48\u5199\u4e86\n\t}\n\tfor(int i = 1;i <= m;i ++) for(int j = 1;j <= m;j ++) if(!mp[i][j]) mp[i][j] = inf; else if(i!=j) add(n+X+i,n+X+j,mp[i][j]);\n   \t//\u8fb9\u5148\u8fde\u4e0a\uff0c\u4e3a\u5904\u7406\u7279\u6b8a\u8d27\u7269\u505a\u51c6\u5907\uff0c\u663e\u7136\u4e0d\u9700\u8981\u8fde\u90a3\u4e9b\u672c\u6765\u6ca1\u6709\u76f4\u63a5\u8fde\u8fb9\u7684\u822a\u7ebf\u3002\u8fde\u63a5\u4ed6\u4eec\u4e0d\u4f1a\u4f7f\u7b54\u6848\u66f4\u4f18\u3002\n\tfor(int k = 1;k <= m;k ++) for(int i = 1;i <= m;i ++) for(int j = 1;j <= m;j ++) mp[i][j] = min(mp[i][j],mp[i][k]+mp[k][j]);\n\tdij(n+m+X+1);int l = 0,r,mid;//\u8dd1\u6700\u77ed\u8def\n\tfor(int i = n+1;i <= n+X;i ++) l = max(l,dis[i]);//\u8d4b\u503c\u4e0b\u754c\n\tmemset(head,0,sizeof(head)); cnt = 1;s = 0,t = n+2*m+1;\n\tfor(int i = 1;i <= m;i ++) for(int j = i+1;j <= m;j ++) if(mp[i][j] < inf) edge[++M] = (node){i,j,mp[i][j]};\n    //\u628a\u6240\u6709\u822a\u7ebf\u62ff\u51fa\u6765\u6392\u5e8f\n\tsort(edge+1,edge+1+M,cmp);r = inf;\n\twhile(l<r) {//\u4e8c\u5206\u7b54\u6848\n\t\tmid = l+r>>1;\n\t\tif(check(mid)) r = mid;\n\t\telse l = mid + 1;\n\t//\tprintf(\"mid=%d\\n\",mid); \n\t} \n\tif(l != inf) printf(\"%lld\",l);\n\telse printf(\"-1\");\n}\n```",
        "postTime": 1621583176,
        "uid": 305911,
        "name": "\u5fd8\u6000\u661f",
        "ccfLevel": 0,
        "title": "P3652\u9898\u89e3"
    },
    {
        "content": "\u7ed9\u5b9a\u4e00\u4e9b\u8d27\u6e90\u5730\uff0c\u4e00\u4e9b\u4e2d\u8f6c\u5c9b\uff0c\u4ee5\u53ca\u4e00\u4e2a\u7ec8\u70b9\u3002\n\n\u8d27\u6e90\u5730\u5206\u4e3a\u4e24\u79cd\uff0c\u666e\u901a\u8d27\u548c\u7279\u6b8a\u8d27\u3002\n\n\u5bf9\u4e8e\u4e2d\u8f6c\u5c9b $i$ \uff0c\u6700\u591a\u53ef\u4ee5\u4e2d\u8f6c $w_i$ \u4ef6\u8d27\u7269\uff0c\u4e2d\u8f6c\u5c9b\u53d1\u5411\u53e6\u4e00\u4e2a\u4e2d\u8f6c\u5c9b\u6216\u519b\u4e8b\u57fa\u5730\u7684\u8d27\u7269\u5206\u522b\u4e0d\u80fd\u8d85\u8fc7 $d_i$\u3002\n\n\u4e0a\u9762\u8d27\u7269\u7686\u6307\u666e\u901a\u8d27\u7269\uff0c\u7279\u6b8a\u8d27\u7269\u4e0d\u4f1a\u53d7\u5230\u9650\u5236\u3002\n\n\u4e2d\u8f6c\u5c9b\u4e4b\u95f4\u6709 $e$ \u6761\u822a\u9053\uff0c\u822a\u9053 $i$ \u6709\u8fb9\u6743\uff0c\u5f00\u8f9f\u822a\u7ebf $u-v$ \u7684\u4ee3\u4ef7\u662f $u$ \u548c $v$ \u4e4b\u95f4\u7684\u6700\u77ed\u8def\u3002\n\n\u6700\u540e\u5168\u5c40\u7684\u4ee3\u4ef7\u662f\u822a\u7ebf\u4ee3\u4ef7\u7684\u6700\u5927\u503c\u3002\n\n\u8981\u6c42\u5728\u6240\u6709\u8d27\u7269\u90fd\u80fd\u591f\u5230\u8fbe\u519b\u4e8b\u57fa\u5730\u7684\u524d\u63d0\u4e0b\uff0c\u6700\u5c0f\u4ee3\u4ef7\u662f\u591a\u5c11\u3002\n\n#### std\n\n\u9996\u5148\u8003\u8651\u4e8c\u5206\u6700\u5c0f\u4ee3\u4ef7 $g$\uff0c\u5c06\u4ee3\u4ef7 $\\leq g$ \u7684\u822a\u7ebf\u52a0\u5165\u56fe\u4e2d\uff0c\u5224\u65ad\u662f\u5426\u80fd\u5c06\u6240\u6709\u8d27\u7269\u90fd\u9001\u8fbe\u519b\u4e8b\u57fa\u5730\u5373\u53ef\u3002\n\n\u7136\u540e\u8003\u8651\u7279\u6b8a\u8d27\u7269\uff0c\u53ea\u9700\u8981\u5148\u7528 `dij` \u6c42\u51fa\u6bcf\u4e2a\u7279\u6b8a\u8d27\u6e90\u5730\u5230\u7ec8\u70b9\u7684\u6700\u77ed\u8def\uff0c\u7136\u540e\u4e8c\u5206\u4e0b\u754c\u5373\u662f\u6bcf\u4e2a\u7279\u6b8a\u8d27\u6e90\u5730\u5230\u7ec8\u70b9\u7684\u6700\u77ed\u8def\u7684\u6700\u5927\u503c\u3002\n\n\u518d\u8003\u8651\u666e\u901a\u8d27\u7269\uff0c\u5148 $\\mathcal O(n^3)$ \u6c42\u51fa\u4e24\u70b9\u4e4b\u95f4\u6700\u77ed\u8def\uff0c\u7136\u540e\u5efa\u56fe\u8dd1\u7f51\u7edc\u6d41\u5373\u53ef\u3002\n\n$\\text{1.19s / 26.07MB / 4.13KB C++20 O2}$\u3002\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ninline int read()\n{\n\tint x = 0, f = 1;\n\tchar c = getchar();\n\twhile (c < '0' || c > '9')\n\t{\n\t\tif (c == '-')\n\t\t\tf = -1;\n\t\tc = getchar();\n\t}\n\twhile (c >= '0' && c <= '9')\n\t{\n\t\tx = x * 10 + c - '0';\n\t\tc = getchar();\n\t}\n\treturn x * f;\n}\n\ninline void write(int x)\n{\n\tif (x < 0)\n\t{\n\t\tputchar('-');\n\t\tx = -x;\n\t}\n\tif (x > 9)\n\t\twrite(x / 10);\n\tputchar(x % 10 + '0');\n}\n\ntypedef int tp;\n\nconst int _ = 5e5 + 10, inf = 1e9 + 7;\n\nint n, m, s, t, lv[_], cur[_];\n\nint tot = 1, head[_], to[_ << 1], nxt[_ << 1];\n\ntp w[_ << 1];\n\ninline void add(int u, int v, tp lv)\n{\n\tto[++tot] = v;\n\tnxt[tot] = head[u];\n\tw[tot] = lv;\n\thead[u] = tot;\n}\n\ninline void Add(int u, int v, tp lv)\n{\n\tadd(u, v, lv);\n\tadd(v, u, 0);\n}\n\ninline bool bfs()\n{\n\tmemset(lv, -1, sizeof(lv));\n\tlv[s] = 0;\n\tmemcpy(cur, head, sizeof(head));\n\tqueue<int> q;\n\tq.push(s);\n\twhile (!q.empty())\n\t{\n\t\tint p = q.front();\n\t\tq.pop();\n\t\tfor (int eg = head[p]; eg; eg = nxt[eg])\n\t\t{\n\t\t\tint v = to[eg];\n\t\t\ttp vol = w[eg];\n\t\t\tif (vol > 0 && lv[v] == -1)\n\t\t\t\tlv[v] = lv[p] + 1, q.push(v);\n\t\t}\n\t}\n\treturn lv[t] != -1;\n}\n\ntp dfs(int p = s, tp flow = inf)\n{\n\tif (p == t)\n\t\treturn flow;\n\ttp rmn = flow;\n\tfor (int eg = cur[p]; eg && rmn; eg = nxt[eg])\n\t{\n\t\tcur[p] = eg;\n\t\tint v = to[eg];\n\t\ttp vol = w[eg];\n\t\tif (vol > 0 && lv[v] == lv[p] + 1)\n\t\t{\n\t\t\ttp c = dfs(v, min(vol, rmn));\n\t\t\trmn -= c;\n\t\t\tw[eg] -= c;\n\t\t\tw[eg ^ 1] += c;\n\t\t}\n\t}\n\treturn flow - rmn;\n}\n\ninline tp dinic()\n{\n\ttp ans = 0;\n\twhile (bfs())\n\t\tans += dfs();\n\treturn ans;\n}\n\nstruct node\n{\n\tint u, v, w;\n} ed[_];\n\nbool cmp(node a, node b)\n{\n\treturn a.w < b.w;\n}\n\nint X, E, M, a[_], ww[_], b[_], d[_], dis[_], mp[507][507];\n\nvector<int> g[307];\n\nbool check(int lit)\n{\n\ttot = 1;\n\tmemset(head, 0, sizeof head);\n\tint sum = 0;\n\tfor (int i = 1; i <= n; i++)\n\t\tAdd(s, i, a[i]), sum += a[i];\n\tfor (int i = 1; i <= m; i++)\n\t{\n\t\tif (b[i])\n\t\t\tAdd(i + n + m, t, d[i]);\n\t\tAdd(i + n, i + n + m, ww[i]);\n\t\tfor (auto j : g[i])\n\t\t\tif (j <= n)\n\t\t\t\tAdd(j, i + n, inf);\n\t}\n\tfor (int i = 1; i <= M && ed[i].w <= lit; i++)\n\t{\n\t\tAdd(ed[i].u + n + m, ed[i].v + n, d[ed[i].u]);\n\t\tAdd(ed[i].v + n + m, ed[i].u + n, d[ed[i].v]);\n\t}\n\treturn !(sum - dinic());\n}\n\nstruct abc\n{\n\tint u, val;\n\tbool operator < (const abc tmp) const\n\t{\n\t\treturn tmp.val < val;\n\t}\n};\n\nvoid dij(int u)\n{\n\tpriority_queue<abc> q;\n\tq.push({u, 0});\n\tfor(int i = 0; i < _; ++i) dis[i] = inf, lv[i] = 0;\n\tdis[u] = 0;\n\twhile(!q.empty())\n\t{\n\t\tabc tmp = q.top();\n\t\tint now = tmp.u;\n\t\tq.pop();\n\t\tif(lv[now]) continue;\n\t\tlv[now] = 1;\n\t\tfor(int i = head[now]; i; i = nxt[i])\n\t\t{\n\t\t\tint v = to[i];\n\t\t\tif(dis[v] > dis[now] + w[i])\n\t\t\t{\n\t\t\t\tdis[v] = dis[now] + w[i];\n\t\t\t\tif(!lv[v]) q.push({v, dis[v]});\n\t\t\t}\n\t\t}\n\t}\n}\n\nsigned main()\n{\n\tint x, y, z;\n\tn = read(), m = read(), X = read(), E = read();\n\tfor (int i = 1; i <= n + X; i++)\n\t\ta[i] = read();\n\tfor (int i = 1; i <= m; i++)\n\t\tww[i] = read();\n\tfor (int i = 1; i <= m; i++)\n\t\td[i] = read();\n\tfor (int i = 1; i <= m; i++)\n\t{\n\t\tx = read();\n\t\tfor (int j = 1; j <= x; j++)\n\t\t{\n\t\t\ty = read();\n\t\t\tg[i].push_back(y);\n\t\t\tadd(n + X + i, y, 0);\n\t\t}\n\t\tb[i] = read();\n\t\tif (b[i])\n\t\t\tadd(n + X + m + 1, n + X + i, 0);\n\t}\n\tfor (int i = 1; i <= E; i++)\n\t{\n\t\tx = read(), y = read(), z = read();\n\t\tmp[x][y] += z, mp[y][x] += z;\n\t}\n\tfor (int i = 1; i <= m; i++)\n\t\tfor (int j = 1; j <= m; j++)\n\t\t\tif (!mp[i][j])\n\t\t\t\tmp[i][j] = inf;\n\t\t\telse if (i != j)\n\t\t\t\tadd(n + X + i, n + X + j, mp[i][j]);\n\tfor (int k = 1; k <= m; k++)\n\t\tfor (int i = 1; i <= m; i++)\n\t\t\tfor (int j = 1; j <= m; j++)\n\t\t\t\tmp[i][j] = min(mp[i][j], mp[i][k] + mp[k][j]);\n\tdij(n + m + X + 1);\n\ts = 0, t = _ - 1;\n\tfor (int i = 1; i <= m; i++)\n\t\tfor (int j = i + 1; j <= m; j++)\n\t\t\tif (mp[i][j] < inf)\n\t\t\t\ted[++M] = (node){i, j, mp[i][j]};\n\tsort(ed + 1, ed + M + 1, cmp);\n\tint l = 0, r = inf, mid;\n\tfor (int i = n + 1; i <= n + X; i++)\n\t\tl = max(l, lv[i]);\n\twhile (l <= r)\n\t{\n\t\tmid = l + r >> 1;\n\t\tif (check(mid))\n\t\t\tr = mid - 1;\n\t\telse\n\t\t\tl = mid + 1;\n\t}\n\tif (r != inf)\n\t\twrite(r + 1);\n\telse\n\t\twrite(-1);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1645769670,
        "uid": 257146,
        "name": "orz_z",
        "ccfLevel": 0,
        "title": "P3652 csh\u548czzy\u7684\u6218\u4e89"
    }
]
[
    {
        "content": "### \u5199\u5728\u524d\u9762\n\n- OI \u751f\u6daf\u4e2d AC \u7684\u9996\u9053\u7ec4\u5408\u6570\u5b66\u5e94\u7528\u9898\u3002\n\n- \u5f00\u9898 5min \u53d1\u73b0\u89c4\u5f8b\uff0c\u5199\u4e86\u534a\u4e0b\u5348\u4ee3\u7801\uff0c\u8c03\u4e86\u4e24\u5929\uff0c\u7136\u800c\u751a\u81f3\u6ca1\u8fc7\u6837\u4f8b\uff0c\u5fc3\u6001\u5d29\u4e86\u3002\u51e0\u5929\u4e4b\u540e\u91cd\u65b0\u5199\u4e86\u4e00\u4efd\u4ee3\u7801\u624d AC\u3002\n\n- \u867d\u7136\u601d\u7ef4\u96be\u5ea6\u4e0d\u5927\uff0c\u4f46\u6bd5\u7adf\u662f\u8054\u8d5b\u9898\uff0c\u9898\u76ee\u8d28\u91cf\u8fd8\u662f\u5f88\u9ad8\u7684\u3002\u6d89\u53ca\u5230\u4e86\u5f88\u591a\u7ec4\u5408\u6570\u5b66\u7684\u57fa\u7840\u7b97\u6cd5\uff0c\u5199\u5b8c\u4e4b\u540e\u611f\u89c9\u5b66\u5230\u4e86\u5f88\u591a\u3002\u611f\u89c9\u8fd9\u9053\u9898\u662f\u9053\u4e0d\u9519\u7684\u7ec4\u5408\u6570\u5b66\u5165\u95e8\u9898\u3002\u63a5\u4e0b\u6765\u6211\u5c06\u4f1a\u5c3d\u91cf\u8be6\u7ec6\u5730\u8fdb\u884c\u8bb2\u89e3\u3002\n\n### \u6570\u636e\u7ed3\u6784\n\n\u53ea\u6709\u6839\u8282\u70b9\u7684\u7b54\u6848\u6709\u7528\u3002\u4efb\u4f55\u4e00\u4e2a\u8282\u70b9\u5728\u66f4\u65b0\u5b8c\u5176\u7236\u4eb2\u7ed3\u70b9\u7684\u503c\u540e\uff0c\u5176\u672c\u8eab\u7684\u4efb\u4f55\u503c\u5c06\u4e0d\u4f1a\u518d\u6709\u4efb\u4f55\u6539\u52a8\u6216\u8d21\u732e\uff0c\u56e0\u6b64\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u5373\u53ef\uff0c\u8bb0\u5f97\u8def\u5f84\u538b\u7f29\u3002\n\n### \u7b97\u6cd5\u601d\u8def\n\n\u89e3\u51b3\u8fd9\u9053\u9898\u7684\u5173\u952e\uff0c\u5728\u4e8e\u8fde\u63a5\u4e24\u4e2a\u8282\u70b9\u65f6\u7b54\u6848\u7684\u66f4\u65b0\u548c\u4e0e\u7b54\u6848\u76f8\u5173\u7684\u503c\u7684\u7ef4\u62a4\u3002\n\n\u8bbe $a_i$ \u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\u7684\u586b\u6570\u65b9\u6848\u603b\u6570\u3002\n\n\u5047\u8bbe\u5f53\u524d\u8fde\u63a5\u7684\u4e24\u4e2a\u8282\u70b9\u7684\u7f16\u53f7\u5206\u522b\u662f $u,v$\uff08\u4fdd\u8bc1\u4e24\u4e2a\u8282\u70b9\u90fd\u662f\u6839\u8282\u70b9\uff09\uff0c\u4e14\u672c\u6b21\u64cd\u4f5c\u9700\u8981\u4ece $u$ \u63a5\u5230 $v$ \u4e0a\u53bb\u3002\n\n\u6bd4\u8f83\u663e\u800c\u6613\u89c1\u7684\u4e00\u70b9\u662f\uff0c\u66f4\u65b0\u7b54\u6848\u65f6\uff0c\u8282\u70b9 $v$ \u6240\u5904\u7684\u4f4d\u7f6e\uff0c\u4e00\u5b9a\u53ea\u80fd\u586b $0$\u3002\n\n\u7ef4\u62a4 $w_i$ \u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u7684\u6811\u7684\u91cd\u91cf\uff0c\u5373\u8282\u70b9\u6570\u3002\u5c06 $u$ \u8fde\u63a5\u5230 $v$ \u4e0a\u65f6\uff0c\u5c06 $w_v$ \u7684\u503c\u52a0\u4e0a $w_u$\u3002\n\n\u90a3\u4e48\u586b\u5165\u539f\u6765\u7684 $u$ \u5b50\u6811\u4e2d\u7684\u6570\u5b57\u5c31\u6709 $w_v - 1$ \u9009 $w_u$ \u79cd\u4e0d\u540c\u7684\u9009\u62e9\u65b9\u6848\u3002\u5269\u4e0b\u7684\u6570\u5b57\u586b\u5165\u539f\u6765\u7684 $v$ \u5b50\u6811\u4e2d\u3002\u53c8\u539f\u672c $u,v$ \u5b50\u6811\u4e2d\u7684\u586b\u6570\u603b\u65b9\u6848\u6570\u5206\u522b\u4e3a $a_u,a_v$\u3002\u90a3\u4e48\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c\u5c31\u53ef\u4ee5\u5c06 $a_v$ \u66f4\u65b0\u4e3a $a_v \\times a_u \\times \\binom{n}{m}$\n\n### \u7ec4\u5408\u6570\u6c42\u6cd5\n\n1. \u6768\u8f89\u4e09\u89d2\uff0c\u52a0\u6cd5\uff0c\u53ef\u4ee5\u53d6\u6a21\u3002\u4f46\u662f\u8fd9\u662f [P2822](https://www.luogu.com.cn/problem/P2822) \u7684\u7ec4\u5408\u6570\u6c42\u6cd5\uff0c\u9700\u8981\u7528\u5230\u4e8c\u7ef4\u6570\u7ec4\uff0c\u6570\u7ec4\u5927\u5c0f\u5f00\u4e0d\u4e0b\uff0c\u53ea\u80fd\u8fc7 50% \u7684\u6570\u636e\u3002\n\n1. \u76f4\u63a5\u6839\u636e\u7ec4\u5408\u6570\u8ba1\u7b97\u516c\u5f0f\uff1a\n\n$$\\binom{n}{m} = \\frac{n!}{m!(n - m)!} $$\n\n\u76f4\u63a5\u7528\u8ba1\u7b97\u5f0f\u6765\u6c42\u7ec4\u5408\u6570\u3002\u9884\u5904\u7406\u51fa\u9636\u4e58\u3002\u7b49\u4e0b\uff0c\u6a21\u610f\u4e49\u4e0b\u7684\u4e58\u6cd5\u2026\u2026\u8981\u6c42\u9006\u5143\u554a\u3002\u7ebf\u6027\u9012\u63a8\u6c42\u9006\u5143\u53ef\u4ee5\u53c2\u8003 [P3811](https://www.luogu.com.cn/problem/P3811) \u7684\u9898\u89e3\u3002\n\n\u8fd9\u9053\u9898\u7684\u9664\u6570\u662f\u53ef\u4ee5\u5927\u5230 $10^9 + 7$ \u7684\uff0c\u56e0\u6b64\u4e0d\u80fd\u76f4\u63a5\u9012\u63a8\u9884\u5904\u7406\u9006\u5143\uff0c\u4f46\u662f\u53ea\u4f1a\u7528\u5230\u9636\u4e58\u7684\u9006\u5143\uff0c\u9884\u5904\u7406\u8fd9\u4e2a\u5373\u53ef\u3002\n\n\u90a3\u4e48\u600e\u4e48\u7ebf\u6027\u9012\u63a8\u5462\uff1f\u770b\u8fd9\u91cc\uff1a\uff08\u4e3a\u4e86\u66f4\u597d\u4f53\u73b0\u9006\u5143\u7684\u5f62\u5f0f\uff0c\u5f0f\u5b50\u4e2d\u4fdd\u8bc1\u4e86\u5206\u6570\u5206\u5b50\u4e0a\u90fd\u662f $1$\uff09\n\n$$\\frac{1}{i!} = \\frac{1}{i\\cdot(i - 1)!} = \\frac{1}{i}\\cdot\\frac{1}{(i - 1)!}$$\n$$\\frac{1}{(i - 1)!} = i\\cdot\\frac{1}{i!}$$\n\n\u56e0\u6b64\uff0c\u9996\u5148\u6839\u636e\u8d39\u9a6c\u5c0f\u5b9a\u7406\u63a8\u8bba\u7528\u5feb\u901f\u5e42\u7b97\u51fa $\\frac{1}{n!}$ \u968f\u540e\u5012\u5e8f\u679a\u4e3e\u9884\u5904\u7406\u5373\u53ef\u3002\n\n### Tips\n\n- \u8282\u70b9\u7f16\u53f7\u662f\u4ece $0$ \u5f00\u59cb\u7684\uff0c\u8bb0\u5f97\u521d\u59cb\u5316\u7684\u65f6\u5019\u628a $a_0,w_0$ \u4e5f\u4e00\u5e76\u8bbe\u4e3a $1$\u3002\uff08\u6211\u5361\u4e86\u51e0\u5929\u5c31\u662f\u56e0\u4e3a\u8fd9\u4e2a\uff09\n- \u6ce8\u610f\u8f93\u5165\u683c\u5f0f\uff0c\u522b\u5fd8\u4e86\u5f3a\u5236\u5728\u7ebf\u3002\n- \u5904\u7406\u9636\u4e58\u7684\u9006\u5143\u8bb0\u5f97\u8981\u679a\u4e3e\u5230 $0$\uff0c\u4e0d\u7136 $m = 0$ \u7684\u65f6\u5019 $\\binom{n}{m}$ \u7684\u503c\u662f\u9519\u7684\u3002\n\n### Code\n\n\u4ee3\u7801\u53ef\u8bfb\u6027\u8fd8\u662f\u5f88\u9ad8\u7684\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define LL long long\n\nusing namespace std;\n\nconst int Maxn = 3e5 + 5;\nconst LL Mod = 1e9 + 7;\n\nint n, q, opt, x, y;\nint Ans;\nLL a[Maxn] = {1};\nint w[Maxn] = {1}; \n\n/*\u5feb\u901f\u5e42*/ \ninline LL qpow(LL b, LL p)\n{\n\tif(p == 0) return 1;\n\tLL x = 1;\n\tfor(; p;b *= b, b %= Mod,p >>= 1) if(p & 1) x *= b, x %= Mod;\n\treturn x;\n}\n\n/*\u5e76\u67e5\u96c6*/\nint fa[Maxn];\n\nint find(int t)\n{\n\treturn fa[t] == t ? t : fa[t] = find(fa[t]);\n}\n\n/*\u6570\u5b66*/\nLL fac[Maxn] = {1};\nLL invf[Maxn];\n\nLL C(int N, int M)\n{\n\treturn 1ll * fac[N] % Mod * invf[M] % Mod * invf[N - M] % Mod;\n}\n\n/*\u9884\u5904\u7406*/ \nvoid Setup()\n{\n\tfor(register int i = 1; i <= n; ++i)\n\t{\n\t\tfa[i] = i;\n\t\tw[i] = a[i] = 1;\n\t\tfac[i] = fac[i - 1] * i;\n\t\tfac[i] %= Mod;\n\t}\n\tinvf[n] = qpow(fac[n], Mod - 2);\n\tfor(register int i = n - 1; i >= 0; --i)\n\t{\n\t\tinvf[i] = invf[i + 1] * (i + 1);\n\t\tinvf[i] %= Mod;\n\t}\n}\n\n/*\u94fe\u63a5 \u5904\u7406\u7b54\u6848*/\nvoid line(int u, int v)\n{\n\tw[v] += w[u];\n\ta[v] = a[v] * a[u] % Mod * C(w[v] - 1, w[u]) % Mod;\n\tfa[u] = v;\n}\n\n/*\u8f93\u51fa\u7b54\u6848 \u66f4\u65b0\u5f3a\u5236\u5728\u7ebf\u503c*/\nvoid print(int t)\n{\n\tAns = (int)a[t];\n\tprintf(\"%d\\n\", Ans);\n} \n\n/*\u5feb\u901f\u8bfb\u5165*/ \ninline int read()\n{\n\tint f = 1, w = 0; char ch = getchar();\n\tfor(; (ch < '0') || (ch > '9'); ch = getchar()) if(ch == '-') f = -1;\n\tfor(; (ch >= '0') && (ch <= '9'); ch = getchar()) w = (w << 3) + (w << 1) + (int)(ch ^ '0');\n\treturn f * w;\n}\n\nint main()\n{\n\tn = read(); q = read();\n\tSetup();\n\twhile(q--)\n\t{\n\t\topt = read();\n\t\tif(opt == 1)\n\t\t{\n\t\t\tx = (read() + Ans) % n;\n\t\t\ty = (read() + Ans) % n;\n\t\t\tx = find(x); y = find(y);\n\t\t\tline(x, y); \n\t\t}\n\t\telse\n\t\t{\n\t\t\tx = (read() + Ans) % n;\n\t\t\tx = find(x);\n\t\t\tprint(x);\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1600593945,
        "uid": 118196,
        "name": "zimujun",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5689 \u3010[CSP-SJX2019]\u591a\u53c9\u5806\u3011"
    },
    {
        "content": "$S_u$\u8868\u793a\u4ee5$u$\u4e3a\u6839\u7684\u5b50\u6811\u7684\u5927\u5c0f\u3002\n\n$F_u$\u8868\u793a\u4ee5$u$\u4e3a\u6839\u7684\u5b50\u6811\u7684\u7b54\u6848\u3002\n\n\u5c06\u70b9$v$\u8fde\u63a5\u5728\u70b9$u$\u4e4b\u4e0b\u65f6\uff0c\n$F_u'=F_u\\times F_v\\times C_{S_u'-1}^{S_v}$\u3002\u5176\u4e2d$S_u'=S_u+S_v$\uff0c\u5373\u5305\u542b$v$\u5b50\u6811\u7684$u$\u5b50\u6811\u5927\u5c0f\u3002\n\n\u5e76\u67e5\u96c6\u7ef4\u62a4\u5b50\u6811\u6839\uff0c\u9884\u5904\u7406\u9636\u4e58\u53ca\u9006\u5143\u6c42\u7ec4\u5408\u6570\u3002\n\n``` c\n#include <stdio.h>\n\nint n, m;\n\n/// Union-Find-Set ///\n#define MAX_N 300005\n\nint fat[MAX_N];\nint siz[MAX_N];\n\nvoid init_ufs(int n) {\n    for (int i = 0; i < n; ++i) {\n        fat[i] = i;\n        siz[i] = 1;\n    }\n}\n\nint find(int u) {\n    if (fat[u] == u)\n        return u;\n    else\n        return fat[u] = find(fat[u]);\n}\n\nvoid merge(int s, int f) { // s: son, f: father\n    siz[f] += siz[s];\n    fat[s] = f;\n}\n\n/// Combination ///\n#define P 1000000007\n#define MOD_P(x) ((x)%P)\n#define MUL_P(x,y) MOD_P(1LL*(x)*(y))\n\nint pow_p(int x, int y) { // return x^y mod P\n    int r = 1;\n    for (; y; y >>= 1, x = MUL_P(x, x))\n        if (y & 1)\n            r = MUL_P(r, x);\n    return r;\n}\n\nint inv_p(int x) { // return 1/x mod P\n    return pow_p(x, P - 2);\n}\n\nint fac[MAX_N]; // i!\nint inf[MAX_N]; // 1/(i!)\n\nvoid init_fac(int n) {\n    fac[0] = 1;\n    for (int i = 1; i <= n; ++i)\n        fac[i] = MUL_P(fac[i - 1], i);\n    inf[n] = inv_p(fac[n]);\n    for (int i = n; i >= 1; --i)\n        inf[i - 1] = MUL_P(inf[i], i);\n}\n\nint comb(int a, int b) { // return C(a,b) = (a!)/(b!(a-b)!)\n    return r = MUL_P(fac[a], MUL_P(inf[b], inf[a - b]));\n}\n\n/// CALC ANS ///\nint ans[MAX_N];\n\nvoid init_ans(int n) {\n    for (int i = 0; i < n; ++i)\n        ans[i] = 1;\n}\n\nvoid modify(int x, int y) {\n    x = find(x);\n    y = find(y);\n    merge(x, y);\n    ans[y] = MUL_P(ans[y], ans[x]);\n    ans[y] = MUL_P(ans[y], comb(siz[y] - 1, siz[x]));\n}\n\n/// MAIN FUNC ///\nint main() {\n    scanf(\"%d%d\", &n, &m);\n    init_ufs(n);\n    init_fac(n);\n    init_ans(n);\n    int last_ans = 0;\n    for (int i = 0; i < m; ++i) {\n        int opt;\n        scanf(\"%d\", &opt);\n        if (opt == 1) {\n            int x, y;\n            scanf(\"%d%d\", &x, &y);\n            x = (x + last_ans) % n;\n            y = (y + last_ans) % n;\n            modify(x, y);\n        } else {\n            int x;\n            scanf(\"%d\", &x);\n            x = (x + last_ans) % n;\n            x = find(x);\n            printf(\"%d\\n\", last_ans = ans[x]);\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1580973976,
        "uid": 18756,
        "name": "YOUSIKI",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5689 \u3010[CSP-SJX2019]\u591a\u53c9\u5806\u3011"
    },
    {
        "content": "\u4eca\u5929\u8fd9\u7bc7\u9898\u89e3\u662f\u6211\u7684\u7b2c\u5341\u7bc7\u9898\u89e3\uff08\u8fd9\u662f[\u6211\u7684\u535a\u5ba2](https://www.luogu.com.cn/blog/53022/)\uff0c\u6b22\u8fce\u5927\u5bb6\u53bb\u5eb7\uff08diao\uff09\u5eb7\uff08da\uff09\uff09\r\n\r\n\u8001\u89c4\u77e9\uff0c\u5148\u653e\u4e00\u4e2a[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5689)\u3002\r\n\r\n\u6839\u636e\u9898\u76ee\u8981\u6c42\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u5c31\u80fd\u60f3\u5230\u8fd9\u662f\u4e00\u9053**\u5e76\u67e5\u96c6 + \u7ec4\u5408\u6570**\u7684\u9898\uff0c\u56e0\u4e3a\u64cd\u4f5c\u4e00\u662f\u5c06\u8282\u70b9 $x$ \u8fde\u5230 $y$ \u4e0b\u8fb9\uff0c\u5f88\u50cf\u4e00\u4e2a\u5e76\u67e5\u96c6\u3002\u8fd8\u8981\u6c42\u7ec4\u5408\u6570\uff0c\u6240\u4ee5\u8fd8\u662f\u4e2a\u5e26\u6743\u5e76\u67e5\u96c6\u3002\r\n\r\n\u6211\u4eec\u7528 $S_x$ \u6765\u8868\u793a\u4ee5 $x$ \u4e3a\u6839\u7684\u5b50\u6811\u5927\u5c0f\uff08\u8282\u70b9\u4e2a\u6570\uff09\uff0c$A_x$ \u6765\u8868\u793a\u4ee5 $x$ \u4e3a\u6839\u7684\u5b50\u6811\u7684\u7ec4\u5408\u6570\uff0c\u5728\u64cd\u4f5c\u4e00\u8fde\u63a5 $x$ \u5728 $y$ \u4e0b\u8fb9\u65f6\uff0c$S_y'=S_y+S_x$\uff0c$A_y'=A_y\u00d7A_x\u00d7C_{S_y'-1}^{S_x}$\uff08\u8fd9\u91cc\u8fd0\u7528\u5230\u4e86\u4e58\u6cd5\u539f\u7406\uff09\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a$C$ \u4e0b\u8fb9\u662f $S_y'-1$\uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u6c42\u7ec4\u5408\u6570\u65f6\uff0c\u5b50\u6811\u6839\u7684\u4f4d\u7f6e\u662f\u4e0d\u6539\u53d8\u7684\uff0c\u6240\u4ee5\u8981 $-1$\u3002\r\n\r\n\u4e3a\u4e86\u6c42\u7ec4\u5408\u6570 $C$\uff0c\u6211\u4eec\u8981\u5148\u9884\u5904\u7406\u9636\u4e58\u4ee5\u53ca\u9636\u4e58\u6240\u5bf9\u5e94\u7684\u9006\u5143\u3002\r\n\r\n\uff08\u5173\u4e8e\u9006\u5143\uff0c\u4e0d\u4f1a\u7684\u670b\u53cb\u4e0d\u59a8\u5148\u53bb\u770b\u770b [P3811 \u4e58\u6cd5\u9006\u5143](https://www.luogu.com.cn/problem/P3811)\uff09\r\n\r\n\u4f17\u6240\u5468\u77e5\uff0c\u6c42\u9006\u5143\u6709\u4e09\u79cd\u65b9\u6cd5\uff08**exgcd**\uff0c**\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff08\u5feb\u901f\u5e42\uff09**\uff0c**\u7ebf\u6027\u7b97\u6cd5**\uff09\u3002\u8fd9\u9053\u9898\u6211\u5206\u522b\u7528\u5230\u4e86\u5176\u4e2d\u7684\u4e24\u79cd\uff08\u8d39\u9a6c\u5c0f\u5b9a\u7406\u548c\u7ebf\u6027\u7b97\u6cd5\uff09\r\n\r\n**\u7b2c\u4e00\u79cd\uff1a\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff08\u5feb\u901f\u5e42\uff09**\r\n\r\n```cpp\r\nint qpow(int a,int b)\r\n{\r\n    int c=1;\r\n    while (b)\r\n    {\r\n        if (b&1)\r\n            c=c*a%mod;\r\n        a=a*a%mod;\r\n        b>>=1;\r\n    }\r\n    return c;\r\n}\r\nvoid init()\r\n{\r\n    fac[0]=1;//fac\u662f\u9636\u4e58\r\n    for (int i=1;i<=n;i++)\r\n    {\r\n        f[i]=i;\r\n        s[i]=a[i]=1;\r\n        fac[i]=fac[i-1]*i%mod;\r\n    }\r\n    inf[n]=qpow(fac[n],mod-2);//fac[n]\u7684\u9006\u5143\r\n    for (int i=n;i>=1;i--)//\u5012\u5e8f\u9636\u4e58\u9006\u5143\r\n        inf[i-1]=(inf[i]*i)%mod;\r\n}\r\n```\r\n\r\n**\u7b2c\u4e8c\u79cd\uff1a\u7ebf\u6027\u7b97\u6cd5**\r\n\r\n```cpp\r\nvoid init()\r\n{\r\n    fac[0]=1;//fac\u662f\u9636\u4e58\r\n    for (int i=1;i<=n;i++)\r\n    {\r\n        f[i]=i;\r\n        s[i]=a[i]=1;\r\n        fac[i]=fac[i-1]*i%mod;\r\n    }\r\n    inv[1]=1;//inv\u662f\u9006\u5143\r\n    for (int i=2;i<=n;i++)//\u7ebf\u6027\u6c42\u9006\u5143\r\n        inv[i]=(mod-mod/i)*inv[mod%i]%mod;\r\n    inf[0]=1;//inf\u662f\u9006\u5143\u7684\u9636\u4e58\r\n    for (int i=1;i<=n;i++)\r\n        inf[i]=inf[i-1]*inv[i]%mod;\r\n}\r\n```\r\n\uff08\u4e24\u79cd\u65b9\u6cd5\u90fd\u53ef\u4ee5\u8fc7\uff0c\u4e8c\u9009\u4e00\u5373\u53ef\uff09\r\n\r\n**\u8fd9\u9053\u9898\u7684\u65b9\u6cd5\u6211\u4eec\u5dee\u4e0d\u591a\u4e5f\u8bf4\u5b8c\u4e86\uff0c\u76f4\u63a5\u4e0a\u4ee3\u7801\u5427\uff1a**\r\n\r\n```cpp\r\n#include<bits/stdc++.h>\r\n#define int long long//\u4e0d\u5f00long long\u89c1\u7956\u5b97QwQ\r\nusing namespace std;\r\nconst int mod=1e9+7;\r\nint n,m,ans;\r\nint f[300010],a[300010],s[300010],fac[300010],inv[300010],inf[300010];\r\nint find(int x)//\u5e76\u67e5\u96c6\u5bfb\u627e\u7236\u4eb2\r\n{\r\n    return (f[x]==x)?x:f[x]=find(f[x]);\r\n}\r\nint qpow(int a,int b)//\u6c42\u5feb\u901f\u5e42\r\n{\r\n    int c=1;\r\n    while (b)\r\n    {\r\n        if (b&1)\r\n            c=c*a%mod;\r\n        a=a*a%mod;\r\n        b>>=1;\r\n    }\r\n    return c;\r\n}\r\nvoid init()//\u9884\u5904\u7406\r\n{\r\n    fac[0]=1;//fac\u662f\u9636\u4e58\r\n    for (int i=1;i<=n;i++)\r\n    {\r\n        f[i]=i;//\u521d\u59cb\u5316\u7236\u4eb2\r\n        s[i]=a[i]=1;//\u5b50\u6811\u5927\u5c0f\u548c\u7ec4\u5408\u6570\u521d\u59cb\u5316\u90fd\u4e3a1\r\n        fac[i]=fac[i-1]*i%mod;\r\n    }\r\n    inf[n]=qpow(fac[n],mod-2);//fac[n]\u7684\u9006\u5143\r\n    for (int i=n;i>=1;i--)//\u5012\u5e8f\u6c42\u9636\u4e58\u9006\u5143\r\n        inf[i-1]=(inf[i]*i)%mod;\r\n    //inv[1]=1;//inv\u662f\u9006\u5143\r\n    //for (int i=2;i<=n;i++)//\u7ebf\u6027\u6c42\u9006\u5143\r\n        //inv[i]=(mod-mod/i)*inv[mod%i]%mod;\r\n    //inf[0]=1;//inf\u662f\u9006\u5143\u7684\u9636\u4e58\r\n    //for (int i=1;i<=n;i++)\r\n        //inf[i]=inf[i-1]*inv[i]%mod;\r\n}\r\nint C(int n,int m)//C\u6c42\u7ec4\u5408\u6570\r\n{\r\n    return fac[n]*inf[m]%mod*inf[n-m]%mod;\r\n}\r\nvoid merge(int x,int y)//\u8fde\u63a5\u64cd\u4f5c\uff1a\u5c06x\u8fde\u5728y\u4e0b\r\n{\r\n    x=find(x),y=find(y);\r\n    s[y]+=s[x];//\u66f4\u65b0\u5b50\u6811\u5927\u5c0f\r\n    a[y]=a[y]*a[x]%mod*C(s[y]-1,s[x])%mod;//\u66f4\u65b0\u5b50\u6811\u7ec4\u5408\u6570\r\n    f[x]=y;//\u66f4\u65b0\u7236\u4eb2\r\n}\r\nsigned main()\r\n{\r\n    scanf(\"%lld%lld\",&n,&m);\r\n    init();\r\n    while (m--)\r\n    {\r\n        int op,x,y;\r\n        scanf(\"%lld%lld\",&op,&x);\r\n        if (op==1)\r\n        {\r\n            scanf(\"%lld\",&y);\r\n            x=(x+ans)%n+1,y=(y+ans)%n+1;//+1\u7684\u539f\u56e0\u662f\u9898\u76ee\u8f93\u5165\u7684\u662f0~n-1\uff0c\u6211\u4eec\u628a\u5b83\u53d8\u4e3a1~n\u65b9\u4fbf\u9884\u5904\u7406\r\n            merge(x,y);\r\n        }\r\n        else\r\n        {\r\n            x=(x+ans)%n+1;//+1\u540c\u4e0a\r\n            printf(\"%lld\\n\",ans=a[find(x)]);//\u8f93\u51fax\u6240\u5728\u6811\u7684\u7ec4\u5408\u6570\r\n        }\r\n    }\r\n    return 0;\r\n}\r\n```\r\n\u4eca\u5929\u7684\u9898\u89e3\u5c31\u5230\u8fd9\u513f\u4e86\uff0c\u4f60\u7684\u70b9\u8d5e\u662f\u5bf9\u6211\u6700\u5927\u7684\u652f\u6301\u3002",
        "postTime": 1628771640,
        "uid": 53022,
        "name": "\u94f6\u6749\u6c34\u6749\u79c3\u6749",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5689\u3010[CSP-S2019 \u6c5f\u897f] \u591a\u53c9\u5806\u3011"
    },
    {
        "content": "\u9996\u5148\u8003\u8651\u4e0d\u5f3a\u5236\u5728\u7ebf\n\n\u7531\u4e8e\u53ea\u6709\u8fde\u8fb9\u64cd\u4f5c\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5148\u5c06\u6240\u6709\u7684\u8fb9\u8fde\u8d77\u6765\uff0c\u5f97\u5230\u6811\u7684\u6700\u7ec8\u5f62\u6001\uff0c\u7136\u540e\u4ece\u6839\u8282\u70b9\u5f00\u59cb\u8dd1\u6811\u5f62$DP$\n\n\u5b9a\u4e49$f[i]$\u8868\u793a\u4ee5$i$\u8282\u70b9\u4e3a\u6839\u7684\u591a\u63d2\u5806\u5206\u522b\u586b\u5165$0--(sz[i]-1)$\u6709\u591a\u5c11\u4e0d\u540c\u7684\u65b9\u6848\n\n\u663e\u7136$i$\u8282\u70b9\u81ea\u8eab\u53ea\u80fd\u586b$0$\n\n\u5bf9\u4e8e\u5b83\u7684\u4e00\u68f5\u5b50\u6811$j$\uff0c\u53ea\u7528\u4ece\u5269\u4e0b\u7684$sz[i]-1$\u4e2a\u6570\u4e2d\u9009\u51fa$sz[j]$\u4e2a\u6570\u586b\u5165\u5b50\u6811$j$\uff0c\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e3a$f[j]*C_{sz[i]-1}^{sz[j]}$\n\n\u6240\u4ee5\u8f6c\u79fb\u65b9\u7a0b$f[i]=\\prod\\limits_{j\\in son(i)}(f[j]*C_{sz[i]-1}^{sz[j]})$\n\n\n\u8003\u8651\u5f3a\u5236\u5728\u7ebf\uff0c\u6211\u4eec\u53d1\u73b0\u76f4\u63a5\u5728\u8fde\u8fb9\u7684\u65f6\u5019\u5c06$f[j]*C_{sz[i]-1}^{sz[j]}$\u4e58\u5230$f[i]$\u91cc\u53bb\u5373\u53ef\n\n\n\u6c42\u6240\u5728\u8282\u70b9\u7684\u6839\u76f4\u63a5\u5e76\u67e5\u96c6\u5373\u53ef\uff0c$P=10^9+7$\uff0c\u6240\u4ee5\u7ec4\u5408\u6570\u76f4\u63a5\u9884\u5904\u7406\u9636\u4e58\u5373\u53ef\n\n\n$Code:NlogN$\n\n```cpp\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<=b;i++)\n#define N 300005\n#define P 1000000007ll\nusing namespace std;\ntypedef long long ll;\nint n,m,fa[N];\nint get(int x){\n\treturn fa[x]==x?x:fa[x]=get(fa[x]);\n}\nll fac[N],f[N],sz[N];\nll Pow(ll x,ll y){\n\tll mul=1;\n\tfor(;y;y>>=1,x=(x*x)%P)if(y&1)mul=(mul*x)%P;\n\treturn mul;\n}\nvoid init(){\n    rep(i,1,n)f[i]=sz[i]=1,fa[i]=i;\n\tfac[0]=fac[1]=1;\n\trep(i,2,n)fac[i]=(fac[i-1]*i)%P;\n}\nll C(int x,int y){\n\t// x=n // y=m\n\t//cout<<x<<\" \"<<y<<endl;\n\treturn fac[x]*Pow(fac[y],P-2)%P*Pow(fac[x-y],P-2)%P;\n}\nvoid link(int x,int y){\n\tint xx=get(x),yy=get(y);\n\tf[yy]=(f[yy]*C(sz[xx]+sz[yy]-1,sz[xx])%P*f[xx])%P;\n\tfa[xx]=yy;sz[yy]+=sz[xx];\n}\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\tinit();//cout<<C(2,1)<<endl;\n\tll ans=0,x,y,op;\n\trep(i,1,m){\n\t\tscanf(\"%lld%lld\",&op,&x);\n\t\tif(op==1){\n\t\t\tscanf(\"%lld\",&y);\n\t\t\tx=(x+ans)%n+1,y=(y+ans)%n+1;\n\t\t\tlink(x,y);\n\t\t\t//cout<<x<<\" \"<<y<<\" \"<<f[get(y)]<<\" \"<<sz[get(y)]<<endl;\n\t\t}\n\t\telse{\n\t\t\tx=(x+ans)%n+1;\n\t\t\tprintf(\"%lld\\n\",ans=f[get(x)]);\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1580830270,
        "uid": 119261,
        "name": "7KByte",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5689 \u3010[CSP-SJX2019]\u591a\u53c9\u5806\u3011"
    },
    {
        "content": "\u4e3a\u5565\u4f1a\u7528\u5230\u7ec4\u5408\u6570\u554a/kk\n\n\u4e0d\u662f\u6709\u7ecf\u5178\u7ed3\u8bba\u7684\u5417/kk\n\n\u6211\u4eec\u53ef\u4ee5\u628a\u6bcf\u6761\u8fb9\u5b9a\u5411\u4e3a\u4ece\u513f\u5b50\u6307\u5411\u7236\u4eb2\n\n\u7136\u540e\u9898\u76ee\u5c31\u662f\u8981\u6c42\u5f97\u5230\u7684\u6811\u5f62\u56fe\uff08\u6709\u5411\u6811\uff09\u62d3\u6251\u5e8f\u7684\u6570\u91cf\n\n\u6211\u4eec\u77e5\u9053\u4e00\u822c DAG \u7684\u62d3\u6251\u5e8f\u8ba1\u6570\u53ea\u80fd $O(2^{|V|})$ \u72b6\u538bDP\n\n\u4f46\u662f\u6709\u4e00\u4e2a\u7ecf\u5178\u7ed3\u8bba\u8bf4\u6811\u5f62\u56fe\u7684\u62d3\u6251\u5e8f\u6570\u91cf\u662f $n!\\prod_{i=1}^n\\frac{1}{sz[i]}$\uff0c\u5176\u4e2d $sz[i]$ \u662f\u5b50\u6811 $i$ \u7684\u5927\u5c0f\n\n\u8fd9\u662f\u4e3a\u4ec0\u4e48\u5462\uff0c\u6211\u4eec\u5148\u628a\u6392\u5217\u5168\u8003\u8651\u4e0a\u53bb\uff0c\u65b9\u6848\u6709 $n!$ \u79cd\n\n\u6211\u4eec\u5bf9\u6bcf\u4e2a\u8282\u70b9\u8003\u8651\uff0c\u5176\u5e94\u5f53\u51fa\u73b0\u5728\u5b83\u7684\u6240\u6709\u5b50\u5b59\u4e4b\u524d\uff0c\u8fd9\u6837\u7684\u6982\u7387\u662f $\\frac{1}{sz[i]}$\n\n\u6211\u4eec\u6ce8\u610f\u5230\u8282\u70b9\u4e4b\u95f4\u7684\u6982\u7387\u662f\u76f8\u4e92\u72ec\u7acb\u7684\uff0c\u56e0\u4e3a\u4e00\u4e2a\u8282\u70b9\u4e0d\u53ef\u80fd\u6709\u4e24\u4e2a\u6df1\u5ea6\u76f8\u540c\u7684\u7956\u5148\n\n\u6240\u4ee5\u76f4\u63a5\u4e58\u8d77\u6765\u5c31\u597d\u4e86\n\n\u5269\u4e0b\u53ea\u9700\u8981\u7ef4\u62a4\u4e2a\u5e76\u67e5\u96c6\n\n\u542c\u8bf4\u8def\u5f84\u538b\u7f29\u5e76\u67e5\u96c6\u4e0d\u662f $O(\\alpha(n))$ \u800c\u662f $O(\\log n)$ \u7684\n\n\u6240\u4ee5\u590d\u6742\u5ea6 $O(n\\log n)$\uff0c\u4f46\u662f\u611f\u89c9\u8dd1\u8d77\u6765\u8981\u5feb\u5f88\u591a\uff0c\u5438\u4e2a\u6c27\u641e\u4e86\u4e2a\u6700\u4f18\u89e3\u7b2c\u4e8c/jk\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int P = 1e9 + 7;\nconst int CN = 3e5 + 50;\nint n, q, inv[CN], sz[CN], ans[CN], fac[CN], lstans = 0;\nclass DSU {\npublic: int fa[CN];\n  DSU() {for(int i = 1; i <= 300000; i++) ans[i] = sz[i] = 1, fa[i] = i;}\n  int fd(int x) {return fa[x] ^ x ? fa[x] = fd(fa[x]) : x;}\n} D;\nint main() {\n  n = read(), q = read(), inv[1] = fac[0] = fac[1] = 1; \n  for(int i = 2; i <= n; i++) fac[i] = 1ll * fac[i - 1] * i % P, inv[i] = 1ll * inv[P % i] * (P - (P / i)) % P;\n  while(q--){\n    int tp = read(), x = read(), y; x = (x + lstans) % n;\n    if(tp == 1)\n      y = read(), y = (y + lstans) % n, x = D.fd(x + 1), y = D.fd(y + 1), D.fa[x] = y,\n      ans[y] = 1ll * ans[y] * sz[y] % P, sz[y] += sz[x], ans[y] = 1ll * ans[y] * inv[sz[y]] % P, ans[y] = 1ll * ans[y] * ans[x] % P;\n    else x = D.fd(x + 1), lstans = 1ll * ans[x] * fac[sz[x]] % P, printf(\"%d\", lstans), puts(\"\");\n  }\n  return 0;\n}\n\n```",
        "postTime": 1603106080,
        "uid": 70177,
        "name": "big_news",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5689 \u3010[CSP-SJX2019]\u591a\u53c9\u5806\u3011"
    },
    {
        "content": "```\n\u6c42\u6c42\u5404\u4f4d\u7ba1\u7406\u5feb\u70b9\u9020\u6570\u636e\u5427\u2026\u2026\n```\n\n\u9996\u5148\u8003\u8651\u4e00\u4e0b\uff0c\u5bf9\u4e8e\u4e00\u68f5\u7ed9\u5b9a\u7684\u6811$T=(V,E)$\uff0c\u600e\u4e48\u6c42\u51fa\u586b\u6cd5\u7684\u603b\u6570\u3002\n\n\u8bb0$T$\u7684\u6839\u8282\u70b9\u4e3a$rt$\uff0c\u5bf9\u4e8e\u6811\u4e2d\u8282\u70b9$u$\uff0c\u8bb0$son(u)$\u4e3a$u$\u7684\u5b50\u8282\u70b9\u96c6\u5408\uff0c$sz_u$\u8868\u793a\u4ee5$u$\u4e3a\u6839\u7684\u5b50\u6811\u7684\u8282\u70b9\u4e2a\u6570\uff0c$ans_u$\u8868\u793a\u4ee5$u$\u4e3a\u6839\u7684\u5b50\u6811\u7684\u586b\u6cd5\u6570\u3002\n\n\u6839\u8282\u70b9\u4e00\u5b9a\u586b\u6700\u5c0f\u503c\uff0c\u8003\u8651\u6bcf\u4e2a\u5b50\u6811\u7684\u6570\u96c6\u7684\u9009\u6cd5\uff08\u76f8\u4e92\u72ec\u7acb\uff09\uff0c\u518d\u4e58\u4e0a\u6811\u5185\u7684\u9009\u6cd5\uff0c\u90a3\u4e48\u6709\uff1a\n\n$ans_u=\\prod_{v\\in son(u)}ans_v\\times\\frac{(sz_u-1)!}{\\prod_{v\\in son(u)}sz_v!}$\n\n\u5176\u4e2d\u540e\u9762\u90a3\u4e2a\u5f0f\u5b50\u662f\u591a\u91cd\u96c6\u7684\u6392\u5217\u6570\uff0c\u53ef\u4ee5\u53c2\u89c1$\\text{CSPJX2019PJT4}$\u7684\u9898\u89e3\u3002\u6700\u540e\u7684\u7b54\u6848\u5373\u4e3a$ans_{rt}$\u3002\n\n\u63a5\u7740\u8003\u8651\u539f\u9898\u3002\u5f88\u5bb9\u6613\u60f3\u5230\u7ef4\u62a4\u4e00\u4e2a\u5e76\u67e5\u96c6\uff0c\u5982\u679c\u52a0\u4e0a\u8def\u5f84\u538b\u7f29\u548c\u6309\u79e9\u5408\u5e76\uff0c\u53ef\u4ee5\u5728$O(\\alpha(n))$\u7684\u65f6\u95f4\u5185\u6c42\u51fa\u70b9$x$\u5728\u7684\u6839\u3002\u8bb0$x$\u6240\u5728\u7684\u6570\u7684\u6839\u4e3a$root_x$\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u4fee\u6539$(x,y)$\uff0c\u8bb0$dx=root_x,dy=root_y$\uff0c\u6211\u4eec\u8981\u5c06$dx$\u5e76\u5230$dy$\u4e0b\uff0c\u53d1\u73b0\u6b64\u65f6\u53ea\u6709$sz_{dy}$\u548c$ans_{dy}$\u9700\u8981\u5904\u7406\uff0c\u5f88\u5bb9\u6613\u5199\u51fa\uff1a\n\n$sz'_{dy}=sz_{dy}+sz_{dx}$\n\n$ans'_{dy}=ans_{dy}\\times \\frac{\\prod_{i=sz_{dy}}^{sz_{dy}+sz_{dv}-1}i}{sz_v!}\\times ans_{dx}$\n\n\u5176\u4e2d\u4e2d\u95f4\u7684\u5f0f\u5b50\u5176\u5b9e\u5c31\u662f\u7ec4\u5408\u6570\uff0c\u53ef\u4ee5$O(n+\\text{log MOD})$\u63d0\u524d\u9884\u5904\u7406\u51fa\u6765\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5$O(1)$\u5408\u5e76\u4e86\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\uff0c\u76f4\u63a5\u8f93\u51fa$ans_{dx}$\u5373\u53ef\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\alpha(n)+\\text{log MOD})$\u3002",
        "postTime": 1575124033,
        "uid": 112794,
        "name": "\u5468\u5b50\u8861",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5689 \u3010\u591a\u53c9\u5806\u3011"
    },
    {
        "content": "\u7b2c\u4e00\u6b21~~\u53e3\u80e1~~\u79d2\u6389 D2T2\uff0c\u4ee5\u8be5\u9898\u89e3\u4f5c\u7eaa\u5ff5\u3002\n\n\u7531\u4e8e\u53ea\u6709\u6839\u7684\u4fe1\u606f\u6709\u7528\uff0c\u663e\u7136\u53ef\u4ee5\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u3002\n\n$size_x$ \u8868\u793a $x$ \u7684\u5b50\u6811\u7684\u5927\u5c0f\uff0c$cnt_x$ \u8868\u793a $x$ \u7684\u5b50\u6811\u7684\u586b\u5145\u65b9\u6848\u6570\u3002\n\n\uff08\u4e0b\u5217\u5f0f\u5b50\u4e2d\uff0c$rtx$ \u8868\u793a $x$ \u5f53\u524d\u6240\u5728\u5b50\u6811\u7684\u6839\uff09\n\n\u5f53 $x$ \u5408\u5e76\u5230 $y$ \u65f6\uff0c\u663e\u7136\u6709 $cnt_{rty}=cnt_{rtx}\\times cnt_{rty}\\times C_{size_{rtx}+size_{rty}-1}^{size_{rtx}}$\n\n\u4e8e\u662f\u9884\u5904\u7406\u9636\u4e58\u4ee5\u53ca\u9006\u5143\uff0c\u8fd9\u9053\u9898\u5c31\u88ab\u89e3\u51b3\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(q\\alpha(n))$\u3002\n\nP.S\uff1a\u4ee3\u7801\u4e2d\u662f\u5148\u5408\u5e76 $size$ \u518d\u5408\u5e76 $cnt$\uff0c\u6240\u4ee5\u539f\u5f0f\u4e2d\u7684 $size_{rtx}+size_{rty}-1$ \u88ab\u66ff\u6362\u6210\u4e86 $size_{rtx}$\u3002\n\nCode:\n\n```cpp\n#include <cstdio>\nusing namespace std ;\nconst int MAXN = 3e5 + 10 , mod = 1e9 + 7 ;\ntypedef long long ll ;\nll fac[MAXN] , inv[MAXN] , cnt[MAXN] , ans ; \nint size[MAXN] , fa[MAXN] ;\nint n , q ;\nll qpow (ll x , int p = mod - 2) {\n\tll ret = 1 ;\n\tfor (; p ; p >>= 1 , x = x * x % mod)\n\t\tif (p & 1) ret = ret * x % mod ;\n\treturn ret ;\n}\nll C (int x , int y) {\n\treturn 1LL * fac[x] * inv[y] % mod * inv[x - y] % mod ;\n}\nint find (int x) {\n\treturn fa[x] == x ? x : fa[x] = find (fa[x]) ;\n}\nvoid merge (int x , int y) {\n\tint fx = find (x) , fy = find (y) ;\n\tfa[fx] = fy ;\n\tsize[fy] += size[fx] ;\n\tcnt[fy] = 1LL * cnt[fy] * cnt[fx] % mod * C (size[fy] - 1 , size[fx]) % mod ;\n}\nint main () {\n\tscanf (\"%d %d\" , &n , &q) ;\n\tfac[0] = 1 ;\n\tfor (int i = 1 ; i <= n ; i++)\n\t\tfac[i] = fac[i - 1] * i % mod ;\n\tfor (int i = 0 ; i < n ; i++)\n\t\tsize[i] = cnt[i] = 1 , fa[i] = i ;\n\tinv[n] = qpow (fac[n]) ;\n\tfor (int i = n - 1 ; i >= 0 ; i--)\n\t\tinv[i] = inv[i + 1] * (i + 1) % mod ; \n\twhile (q--) {\n\t\tint opt , x , y ;\n\t\tscanf (\"%d\" , &opt) ;\n\t\tif (opt == 1) {\n\t\t\tscanf (\"%d %d\" , &x , &y) ;\n\t\t\tx = 1LL * (x + ans) % n ;\n\t\t\ty = 1LL * (y + ans) % n ;\n\t\t\tmerge (x , y) ;\n\t\t}\n\t\tif (opt == 2) {\n\t\t\tscanf (\"%d\" , &x) ;\n\t\t\tx = 1LL * (x + ans) % n ;\n\t\t\tint fx = find (x) ;\n\t\t\tans = cnt[fx] ;\n\t\t\tprintf (\"%lld\\n\" , ans) ;\n\t\t}\n\t}\n\treturn 0 ;\n}\n```",
        "postTime": 1587389754,
        "uid": 122641,
        "name": "GIFBMP",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5689 \u3010[CSP-SJX2019]\u591a\u53c9\u5806\u3011"
    },
    {
        "content": "\u7531\u4e8e\u6709\u52a0\u8fb9\u64cd\u4f5c\uff0c\u5148\u8003\u8651\u6811\u4e3a\u9759\u6001\u65f6\u7684\u505a\u6cd5\u3002\n\n\u5b9a\u4e49 $f_{i}$ \u4e3a $i$ \u5b50\u6811\u5185\uff0c\u5c06 $0$ ~ $siz_{i}-1$ \u586b\u5230 $i$ \u7684\u5b50\u6811\uff0c\u5e76\u4e14\u6ee1\u8db3\u9898\u610f\u7684\u65b9\u6848\u6570\u3002\u5bf9\u4e8e $i$\uff0c\u8003\u8651\u5c06\u5b83\u7684\u4e00\u4e2a\u513f\u5b50 $j$ \u5408\u5e76\u5230 $i$ \u4e0a\u4e4b\u540e\u7684\u65b9\u6848\u6570\u3002\u56e0\u4e3a $i$ \u4e0e $j$ \u662f\u4e92\u76f8\u72ec\u7acb\u7684\uff0c\u6240\u4ee5\u76f4\u63a5\u76f8\u4e58\uff1b\u53c8\u56e0\u4e3a\u6709\u4e00\u4e2a **\u5206\u914d\u6807\u53f7** \u7684\u8fc7\u7a0b\uff0c\u518d\u4e58\u4e0a\u7ec4\u5408\u6570\u3002\u5f62\u5f0f\u5316\u7684\u8bf4\uff0c\u5c31\u662f\n\n$$\nf^\\prime_i={size_i+size_j-1\\choose size_j}f_if_j\n$$\n\n\u5176\u4e2d $f'_{i}$ \u662f\u5408\u5e76\u5b8c\u540e $i$ \u5b50\u6811\u7684\u7b54\u6848\uff0c$size_i$ \u662f\u5408\u5e76\u524d $i$ \u5b50\u6811\u7684\u7b54\u6848\uff0c\u56e0\u4e3a $i$ \u7684\u6743\u503c\u662f\u56fa\u5b9a\u7684\uff08\u56fa\u5b9a\u4e3a $0$\uff09\uff0c\u6240\u4ee5\u8981\u51cf\u4e00\u3002\u6700\u7ec8\u6839\u8282\u70b9\u7684 $f$ \u503c\u5c31\u662f\u8fd9\u4e2a\u6811\u7684\u7b54\u6848\u3002\n\n---\n\n\u73b0\u5728\u8003\u8651\u52a8\u6001\u7684\u505a\u6cd5\u3002\n\n\u6ce8\u610f\u5230\u9898\u76ee\u4e2d\u5408\u5e76\u7684\u65b9\u6cd5\uff0c\u662f\u5c06\u4e24\u4e2a\u6811\u7684\u6839\u8282\u70b9\u5408\u5e76\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u76f4\u63a5\u7ef4\u62a4\u6839\u8282\u70b9\u4fe1\u606f\u3002\u8bb0 $dp_i$ \u4e3a\u6811 $i$ \u7684\u7b54\u6848\uff0c\u90a3\u4e48\u5408\u5e76\u6839\u8282\u70b9\u65f6\u6309\u7167\u4e0a\u8ff0\u65b9\u6cd5\u5408\u5e76\u3002\u6b64\u65f6\u9700\u8981\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u80fd\u591f\u627e\u5230\u8fd9\u4e2a\u70b9\u6240\u5728\u6811\u7684\u6839\uff0c\u5e76\u67e5\u96c6\u53ef\u4ee5\u80dc\u4efb\uff08\u5f53\u7136\uff0c\u60f3\u5199 LCT \u4e5f\u6ca1\u4eba\u62e6\uff09\u3002\n\n\u6545\uff0c\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u6bcf\u4e2a\u70b9\u6240\u5728\u6811\u7684\u6839\uff0c\u540c\u65f6\u4e3a\u4e86\u5408\u5e76\uff0c\u9700\u8981\u7ef4\u62a4\u5e76\u67e5\u96c6\u7684\u5927\u5c0f\uff0c\u5408\u5e76\u65f6\u6309\u7167\u4e0a\u8ff0\u5f0f\u5b50\u5408\u5e76\uff0c\u7b54\u6848\u5c31\u662f\u6839\u7684 $dp$ \u503c\u3002\u7ec4\u5408\u6570\uff0c\u9884\u5904\u7406\u9636\u4e58\u3001\u9636\u4e58\u9006\u5143\u76f4\u63a5\u7b97\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n---\n\n\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ninline char getch(){\n\tstatic char buf[10000],*p1=buf,*p2=buf;\n\treturn p1==p2&&(p2=(p1=buf)+fread(buf,1,10000,stdin),p1==p2)?EOF:*p1++;\n}\n#define Getc getch\ninline ll read(){\n\tll s=0,f=1;char ch=Getc();\n\twhile(ch<'0'||ch>'9')f=(ch=='-'?-1:1),ch=Getc();\n\twhile(ch>='0'&&ch<='9')s=s*10+ch-'0',ch=Getc();\n\treturn s*f;\n}\n#define filename \"filename\"\nvoid File(){\n\tfreopen(filename\".in\",\"r\",stdin);\n\tfreopen(filename\".out\",\"w\",stdout);\n}\nconst int MaxN=3e5+5;\nconst int Mod=1e9+7;\nint f[MaxN],siz[MaxN];\nint dp[MaxN],n,Q,lastans;\nll fac[MaxN],inv[MaxN],ifac[MaxN];\nint getf(int x){\n\treturn f[x]==x?x:f[x]=getf(f[x]);\n}\nll C(int n,int m){\n\treturn fac[n]*ifac[m]%Mod*ifac[n-m]%Mod;\n}\nint main(){\n\tn=read(),Q=read();\n\tfor(int i=1;i<=n;i++){\n\t\tf[i]=i;siz[i]=dp[i]=1;\n\t}\n\tfac[0]=fac[1]=inv[0]=inv[1]=ifac[0]=ifac[1]=1;\n\tfor(int i=2;i<=n;i++){\n\t\tfac[i]=fac[i-1]*i%Mod;\n\t\tinv[i]=Mod-Mod/i*inv[Mod%i]%Mod;\n\t\tifac[i]=ifac[i-1]*inv[i]%Mod;\n\t}\n\tfor(int i=1;i<=Q;i++){\n\t\tint op,x,y;\n\t\top=read();\n\t\tif(op==1){\n\t\t\tx=read(),y=read();\n\t\t\tx=(x+lastans)%n+1;\n\t\t\ty=(y+lastans)%n+1;\n\t\t\tx=getf(x);y=getf(y);\n\t\t\tf[x]=y;\n\t\t\tsiz[y]+=siz[x];\n\t\t\tdp[y]=C(siz[y]-1,siz[x])*dp[x]%Mod*dp[y]%Mod;\n\t\t}\n\t\tif(op==2){\n\t\t\tx=read();\n\t\t\tx=(x+lastans)%n+1;\n\t\t\tcout<<(lastans=dp[getf(x)])<<\"\\n\";\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n\u4ee3\u7801\u4e2d\u51fa\u4e8e\u4e60\u60ef\u95ee\u9898\uff0c\u5c06\u70b9\u7684\u6807\u53f7\u4ece $1$ \u5f00\u59cb\u3002",
        "postTime": 1606139818,
        "uid": 82805,
        "name": "Drawing_Yang",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5689 \u3010[CSP-SJX2019]\u591a\u53c9\u5806\u3011"
    },
    {
        "content": "\u4e00\u6574\u68f5\u6811\u7684\u7b54\u6848\u5f88\u663e\u7136\u662f\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5e76\u67e5\u96c6\u7ef4\u62a4\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u7528 $size_i$ \u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\u5927\u5c0f\u3002\u6ce8\u610f\u8fd9\u91cc\uff0c\u5982\u679c $i$ \u5df2\u7ecf\u662f\u4e00\u68f5\u6811\u4e0a\u7684\u8282\u70b9\uff0c\u90a3\u4e48\u5c31\u4e0d\u7528\u7ef4\u62a4\u4e86\u3002\u8fd9\u4e2a\u663e\u7136\u53ef\u4ee5\u7ef4\u62a4\uff1a\u5728\u5408\u5e76\u7684\u65f6\u5019\u76f8\u52a0\u5373\u53ef\u3002\n\n\u518d\u7528 $ans_i$ \u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u7684\u7b54\u6848\u3002\u8003\u8651\u5f53\u628a\u4ee5 $y$ \u4e3a\u6839\u7684\u6811\u63a5\u5728\u4ee5 $x$ \u4e3a\u6839\u7684\u6811\u4e0b\uff0c\u5219 $ans_x=ans_x*ans_y*C_{size_x+size_y-1}^{size_y}$\u3002\u8fd9\u4e2a\u5f88\u597d\u7406\u89e3\uff0c\u5c31\u662f\u56e0\u4e3a $1$\u8fd9\u4e2a\u6570\u53ea\u80fd\u653e\u5728\u6839\u4e0a\uff0c\u5176\u4ed6 $size_x+size_y-1$ \u4e2a\u6570\u4efb\u9009\u51fa $size_y$ \u4e2a\u6570\u6446\u5728\u4ee5 $y$ \u4e3a\u6839\u7684\u6811\u4e0a\uff0c\u5176\u5b83\u6570\u6446\u5728\u4ee5 $x$ \u4e3a\u6839\u7684\u6811\u4e0a\uff0c\u4e24\u4e2a\u65b9\u6848\u76f8\u4e58\u5373\u53ef\u3002\n\n\u81f3\u4e8e\u7ec4\u5408\u6570\u600e\u4e48\u6c42\uff0c\u9884\u5904\u7406\u4e00\u4e0b\u9636\u4e58\u548c\u9636\u4e58\u7684\u9006\u5143\u5c31\u884c\u4e86\u3002\n\n\u7ed3\u5408\u4ee3\u7801\u7406\u89e3\u4e0b\uff08\u4e0d\u8981\u5728\u610f\u5947\u602a\u7684\u53d8\u91cf\u540d\u6bd4\u5982 $jc$ \u662f\u9636\u4e58\u7684\u610f\u601d\uff09\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,m;\nint fa[300501];\nint size[300001];\nlong long ans[300001];\nconst long long mod=1e9+7;\nlong long jc[300001],njc[300001];\ninline long long read()\n{\n\tchar C;\n\tlong long F=1,ANS=0;\n\twhile (C<'0'||C>'9')\n\t{\n\t\tif (C=='-') F=-1;\n\t\tC=getchar();\n\t}\n\twhile (C>='0'&&C<='9')\n\t{\n\t\tANS=ANS*10+C-'0';\n\t\tC=getchar();\n\t}\n\treturn F*ANS;\n} \nlong long ksm(long long x,int y)\n{\n\tif (y==0) return 1;\n\tlong long res=ksm(x,y/2);\n\tres=(res*res)%mod;\n\tif (y%2==0) return res;\n\treturn (res*x)%mod;\n}\ninline long long C(int x,int y)\n{\n\treturn ((jc[x]*njc[y])%mod)*njc[x-y]%mod;\n}\ninline int find(int x)\n{\n\tif (x==fa[x]) return x;\n\treturn fa[x]=find(fa[x]);\n}\nint main()\n{\n\tn=read(),m=read();\n    for (int i=0;i<n;i++) fa[i]=i,size[i]=1,ans[i]=1;\n\tjc[0]=1;\n\tfor (int i=1;i<=n;i++) jc[i]=(jc[i-1]*i)%mod;\n\tnjc[n]=ksm(jc[n],mod-2);\n\tfor (int i=n-1;i>=0;i--) njc[i]=(njc[i+1]*(i+1))%mod;\n    long long lastans=0;\n    for (int i=1;i<=m;i++)\n    {\n    \tint x,y,t;\n    \tt=read(),x=read();\n    \tx=(x+lastans)%n;\n    \tif (t==1) \n\t\t{\n\t\t\ty=read();\n\t\t\ty=(y+lastans)%n;\n\t\t\tint x1=find(x),y1=find(y);\n\t\t\tans[y1]=((ans[y1]*ans[x1])%mod*C(size[x1]+size[y1]-1,size[x1]))%mod;\n\t\t\tsize[y1]+=size[x1];\n\t\t\tfa[x1]=y1;\n\t\t}\n    \telse\n    \t{\n    \t\tlastans=ans[find(x)];\n    \t\tprintf(\"%lld\\n\",lastans);\n\t\t}\n\t}\n    return 0;\n}\n```\n",
        "postTime": 1598189993,
        "uid": 151475,
        "name": "Little09",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P5689 \u3010[CSP-SJX2019]\u591a\u53c9\u5806\u3011"
    },
    {
        "content": "\u5728\u8fd9\u91cc\u6211\u4eec\u8bbe $size_i$ \u4e3a\u4ee5 $i$ \u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\u5927\u5c0f\u3002 $ans_i$ \u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\u7684\u7b54\u6848\u3002\n\n\u5f53\u6211\u4eec\u5c06\u70b9 $y$ \u8fde\u63a5\u5230\u70b9 $x$ \u4e4b\u4e0b\u65f6\uff0c$ans_x'=ans_x*ans_y*C_{size_x'-1}^{size_y}$\u3002\u53c8\u56e0\u4e3a\u70b9 $y$ \u662f\u8fde\u63a5\u5230\u70b9 $x$ \u4e4b\u4e0b\u7684\uff0c\u6240\u4ee5 $size_x'=size_x+size_y$\u3002\n\n\u4e4b\u540e\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u5b50\u6811\u7684\u6839\uff0c\u518d\u9884\u5904\u7406\u7ec4\u5408\u6570\u5373\u53ef\u3002\n\n\u7528\u4e8e\u524d\u9762\u601d\u8def\u5df2\u7ecf\u8bb2\u5f97\u5f88\u6e05\u695a\u4e86\uff0c\u4ee3\u7801\u5269\u4e0b\u7684\u90fd\u662f\u6700\u57fa\u7840\u7684\u201c**\u9884\u5904\u7406\u9636\u4e58\u53ca\u9006\u5143\u6c42\u7ec4\u5408\u6570**\u201d\uff0c\u6240\u4ee5\u4ee3\u7801\u5c31\u4e0d\u505a\u6ce8\u91ca\u4e86\u3002\uff08\u82e5\u4e0d\u4f1a\u9006\u5143\uff0c\u8bf7\u70b9[\u8fd9](https://www.luogu.com.cn/problem/P3811)\u8fd8\u6709[\u8fd9](https://www.luogu.com.cn/problem/P5431)\uff09\n\n#### \u4e0a\u83dc\n\n```\n#include<bits/stdc++.h>\n#define mod 1000000007\nusing namespace std;\ninline int read()\n{\tint x=0;\n\tbool f=0;\n\tchar c=getchar();\n\twhile(!isdigit(c))f|=(c=='-'),c=getchar();\n\twhile(isdigit(c))x=x*10+(c&15),c=getchar();\n\treturn f?-x:x;\n}\nlong long fac[300005],inv[300005],cnt[300005],ans;\nint size[300005],fa[300005];\nint n,q;\nlong long ksm(long long x,int y)\n{\tlong long res=1;\n\twhile(y)\n\t{\tif(y&1)res=res*x%mod;\n\t\tx=x*x%mod;\n\t\ty>>=1;\n\t}\n\treturn res;\n}\nlong long C(int x,int y)\n{\treturn 1LL*fac[x]*inv[y]%mod*inv[x-y]%mod;\n}\nint find(int x)\n{\treturn fa[x]==x?x:fa[x]=find(fa[x]);\n}\nvoid swap(int x,int y)\n{\tint fx=find(x),fy=find(y);\n\tfa[fx]=fy;\n\tsize[fy]+=size[fx];\n\tcnt[fy]=1LL*cnt[fy]*cnt[fx]%mod*C(size[fy]-1,size[fx])%mod;\n}\nint main()\n{\tn=read(),q=read();\n\tfac[0]=1;\n\tfor(register int i=1;i<=n;++i)fac[i]=fac[i-1]*i%mod;\n\tfor(register int i=0;i<n;++i)size[i]=cnt[i]=1,fa[i]=i;\n\tinv[n]=ksm(fac[n],mod-2);\n\tfor(register int i=n-1;i>=0;--i)inv[i]=inv[i+1]*(i+1)%mod; \n\twhile(q--)\n\t{\tint opt=read(),x,y;\n\t\tif(opt==1)\n\t\t{\tx=read(),y=read(); \n\t\t\tx=1LL*(x+ans)%n;\n\t\t\ty=1LL*(y+ans)%n;\n\t\t\tswap(x,y);\n\t\t}\n\t\tif(opt==2)\n\t\t{\tx=read();\n\t\t\tx=1LL*(x+ans)%n;\n\t\t\tans=cnt[find(x)];\n\t\t\tprintf(\"%lld\\n\",ans);\n\t\t}\n\t}\n\treturn 0 ;\n}\n```\n",
        "postTime": 1597164520,
        "uid": 127036,
        "name": "woshiSB",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5689 \u3010[CSP-SJX2019]\u591a\u53c9\u5806\u3011"
    },
    {
        "content": "\u8fd8\u662f\u4e00\u9053\u633a\u88f8\u7684\u8ba1\u6570\u9898\u7684..\n\n\u8fd9\u79cd\u9898\u76ee\u901a\u5e38\u8003\u8651\u6811\u4e0a $dfs$ \u4ece\u4e0b\u5f80\u4e0a\u66f4\u65b0\uff08\u9759\u6001\u7684\u6811\uff09\n\n\u4f46\u662f\u8fd9\u9898\u662f\u6709\u5408\u5e76\u7684\u64cd\u4f5c\u4e14\u6bcf\u6b21\u53ea\u4f1a\u67e5\u8be2\u6839\u7684\u7b54\u6848\uff0c\u90a3\u4e48\u5c31\u8003\u8651\u53ea\u7ef4\u62a4\u6bcf\u4e2a\u6839\u7684 $ans$\uff0c\u5408\u5e76\u65f6\u66f4\u65b0\u5373\u53ef\u3002\n\n\u8003\u8651\u9759\u6001\u65f6\u4e00\u4e2a\u6839\u7684\u7b54\u6848\uff0c\u8981\u6ee1\u8db3\u5c0f\u6839\u5806\u7684\u6027\u8d28\u6240\u4ee5\u5b83\u81ea\u5df1\u7684\u7b54\u6848\u662f\u786e\u5b9a\u7684\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f\u5b50\u6811\u7684\u7b54\u6848\u76f8\u4e58\u518d\u4e58\u4e0a\u4e0d\u540c\u5b50\u6811\u4e4b\u95f4\u9009\u6570\u7684\u65b9\u6848\u6570\n\n\u5373$ans_u$ $=$ $\\prod\\limits_{v\\in{son_u}}ans_v$ $*$ $\\frac{(size_u-1)!}{\\prod\\limits_{v\\in{son_u}}size_v!}$\n\n\u4e58\u53f7\u5de6\u8fb9\u662f\u5b50\u6811\u7b54\u6848\u79ef\uff0c\u53f3\u8fb9\u662f\u5b50\u6811\u95f4\u7684\u9009\u6570\u65b9\u6848\u6570\uff08\u4e5f\u53eb\u505a\u591a\u91cd\u96c6\u6392\u5217\u6570\uff09\n\n\u8003\u8651\u5982\u4f55\u63a8\u51fa\u4e58\u53f7\u53f3\u8fb9\u7684\u67ff\u5b50\uff1a\u6839\u9009\u4e86\u6700\u5c0f\u6570\u4e4b\u540e\uff0c\u5b50\u6811\u6709 $(size_u-1)$ \u4e2a\u6570\u53ef\u9009\n\n\u5206\u522b\u8bb0\u6bcf\u9897\u5b50\u6811\u7684\u5927\u5c0f\u4e3a $size_{v1}$ , $size_{v2}$ , $\u2026$ , $size_{vk}$\n\n\u5219\u9009\u6570\u7684\u65b9\u6848\u662f $C_{size_u-1}^{size_{v1}}$ $*$ $C_{size_u-size_{v1}-1}^{size_{v2}}$ $*$ $\u2026$\n\n\u5316\u51fa\u6765\u5c31\u53ef\u4ee5\u53d1\u73b0\u65b9\u6848\u6570\u4e3a $\\frac{(size_u-1)!}{\\prod\\limits_{v\\in{son_u}}size_v!}$ \uff08\u5efa\u8bae\u624b\u63a8\u4e00\u6b21\uff09\n\n\u90a3\u4e48\u5f53\u4e00\u4e2a\u6839 $v$ \u63d2\u5230\u6839 $u$ \u4e0b\u9762\u7684\u65f6\u5019\uff0c $size_u$ \u53d1\u751f\u4e86\u53d8\u5316\uff0c$ans_u$ \u5c31\u4f1a\u53d8\u6210 $\\frac{ans_uans_v(size_u+size_v-1)!}{(size_v-1)!size_u!}$ ( \u540c\u6837\u5efa\u8bae\u624b\u63a8\uff09\n\n\u73b0\u5728\u95ee\u9898\u88ab\u6211\u4eec\u7b80\u5316\u6210\u5bf9\u4e8e\u6bcf\u6b21\u64cd\u4f5c $1$\uff0c\u66f4\u65b0\u7b54\u6848\u5e76\u8fdb\u884c\u7ef4\u62a4\uff1b\u5bf9\u4e8e\u6bcf\u6b21\u64cd\u4f5c $2$\uff0c\u8f93\u51fa\u7b54\u6848\u5373\u53ef\u3002\n\n\u5bb9\u6613\u60f3\u5230\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\uff0c\u7531\u4e8e\u9650\u5b9a\u4e86\u8c01\u5728\u8c01\u7684\u4e0b\u9762\uff0c\u6240\u4ee5\u4e0d\u80fd\u6309\u79e9\u5408\u5e76\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f$O(nlogn)$ \n\n\u672c\u9898\u7684\u5927\u81f4\u601d\u8def\u5c31\u662f\u8fd9\u6837\uff0c\u53e6\u5916\u6b64\u9898\u9700\u8981\u9884\u5904\u7406\u9636\u4e58\uff0c\u9006\u5143\uff0c\u8fd8\u9700\u521d\u59cb\u5316\u5e76\u67e5\u96c6\u548c\u7b54\u6848\u6570\u7ec4\uff0c\u9700\u6ce8\u610f\u3002\n\n\u6838\u5fc3\u90e8\u5206code\uff08\u6ca1\u6709\u8fdb\u884c\u89e3\u5bc6\uff0c\u53f3\u8f6c\u9c7c\u9c7c\u7684\u672a\u89e3\u5bc6\u7248\u672c\uff09\uff1a\n```cpp\n//\u6b64\u5904\u7684inv[i]\u6307\u7684\u662fi\u7684\u9636\u4e58\u7684\u9006\u5143\n\twhile(q--)\n\t{\n\t\tint op=read(),x,y;\n\t\tif(op==1)\n\t\t{\n\t\t\tx = read() \uff0c y = read();\n\t\t\tx = get_fa(x) \uff0c y = get_fa(y);\n\t\t\tf[x] = y;//\u5e76\u67e5\u96c6\u7ef4\u62a4 \n\t\t\tans[y] = ans[x] * ans[y] % p * fac[siz[x]+siz[y]-1] % p * inv[siz[y]-1] % p * inv[siz[x]] % p;//\u66f4\u65b0\u7b54\u6848  \n\t\t\tsiz[y] += siz[x];//\u66f4\u65b0size \n\t\t}\n\t\telse\n\t\t{\n\t\t\tx = read()\uff1b\n\t\t\tprintf(\"%lld\\n\",ans[get_fa(x)]);//\u8f93\u51fax\u7684\u6839\u7684\u7b54\u6848 \n\t\t}\n\t}\n\treturn 0\uff1b\n}\n```\n",
        "postTime": 1580808660,
        "uid": 135839,
        "name": "Fairicle",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5689 \u3010[CSP-SJX2019]\u591a\u53c9\u5806\u3010\u5f81\u96c6\u6570\u636e\u3011\u3011"
    },
    {
        "content": "> \u9000\u5f79oier\u6c34\u9898\u89e3\n\n> \u770b\u89c1\u53ea\u6709\u79bb\u7ebf\u505a\u6cd5\u7684\u9898\u89e3\u3002\u3002\u4e22\u4e00\u4e2a\u5728\u7ebf\u7684\u4e0a\u6765\n>\n> \u4e0d\u8fc7\u6ca1\u770b\u61c2\u90a3\u4e2a\u79bb\u7ebf\u7684\u89e3\u6cd5 wtcl\n\n\u5148\u8003\u8651\u66b4\u529b\u600e\u4e48\u505a\u5427\u3002\u3002\n\n> \u5176\u5b9e\u6211\u89c9\u5f97\u6b63\u89e3\u6bd4\u66b4\u529b\u597d\u6253\n\n\u636e\u9898\u610f\u6a21\u62df\u3002\u3002\u5efa\u6811\n\n\u7136\u540e\u6bcf\u6b21\u6811\u5f62dp (?)\n\n\u5bf9\u4e8e\u4e00\u68f5\u5b50\u6811\u53ef\u4ee5\u53d1\u73b0\n\n\u5b83\u7684\u6839\u8282\u70b9\u662f\u53ef\u4ee5\u786e\u5b9a\u7684\uff08\u6b64\u65f6\u6700\u5c0f\u7684\u4e00\u4e2a\u6570\n\n$res_i$ \u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\u7ec4\u5408\u603b\u6570\n\n$siz_i$ \u8868\u793a\u5b50\u6811\u5927\u5c0f\n\n\u4e8e\u662f\u5b83\u7684\u7ec4\u5408\u60c5\u51b5\u5c31\u662f\n\n$res_i = res_i \\times res_j \\times  C_{siz_i-1}^{siz_j}$\n\n(\u4ee5\u53ca\u4e00\u5927\u5768)\n\n$\\dots\\dots$\n\nemmm \u4f3c\u4e4e\u6709\u70b9\u4e0d\u597d\u5f62\u5bb9\n\n\u53cd\u6b63\u6211\u89c9\u5f97\u8fd9\u6837\u6811\u5f62dp\u5f88\u9ebb\u70e6\n\n\n\n\u987a\u7740\u8fd9\u4e2a\u65b9\u5411\n\n\u6211\u4eec\u5176\u5b9e\u53ef\u4ee5\u53d1\u73b0\u4e0d\u662f\u6839\u8282\u70b9\u7684\u70b9\u7684 $res$ \u503c\u662f\u4e0d\u4f1a\u66f4\u65b0\u7684\n\n\u5408\u5e76\u7684\u53ea\u6709\u6839\u8282\u70b9\n\n\u6240\u4ee5\u7528\u4e00\u4e2a\u5e76\u67e5\u96c6\u7ef4\u62a4\u6839\n\n\u6bcf\u6b21\u5408\u5e76\u66f4\u65b0\u65b0\u7684\u6839\u8282\u70b9\u7684\u503c\n\n\u8be2\u95ee\u76f4\u63a5\u8f93\u51fa $res[findf(x)]$ \u5c31\u597d\u4e86\n\n\u611f\u89c9\u96be\u5ea6\u548c t3 \u5dee\u4e0d\u591a\u7684\u3002\u3002(\u7ed3\u679ct3\u70b8\u4e86)\n\n\u4ee3\u7801\u3002\u3002\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\n\ninline void io(){\n}\n\ninline int read(){\n}\n\nconst ll mod = (ll)1e9+7;\nconst int N = (int)3e5+9;\nint n,q;\nint fa[N],siz[N];\nll fac[N],inv[N];\nll res[N];\nll ans=0;\n\ninline ll fpow(ll x,ll p){\n}\n\ninline int findf(int x){\n}\n\ninline ll C(int a,int b){\n}\n\nint main(){\n\t//io();\n    cout<<\"\u6002\u4e86\uff0c\u4ee5\u540e\u518d\u653e\";\n\treturn 0;\n}\n```\n\n---\n\n$fin$\n\n",
        "postTime": 1575387768,
        "uid": 148352,
        "name": "WNico",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5689 \u3010[CSP-SJX2019]\u591a\u53c9\u5806\u3011"
    }
]
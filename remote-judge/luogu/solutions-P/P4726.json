[
    {
        "content": "orz\u8fd9\u9898\u592a\u73c2\u6015\u4e86\u2026\u2026\u4f3c\u4e4e\u90fd\u627e\u4e0d\u5230\u51e0\u4e2a\u677f\u5b50\u53c2(lai)\u8003(chao)\u2026\u2026\u524d\u7f6e\u829d\u58eb\u53c8\u7279\u522b\u591a\u2026\u2026\u800c\u4e14\u6211\u5199\u7684\u65f6\u5019\u725b\u987f\u8fed\u4ee3\u90a3\u91ccNTT\u6570\u7ec4\u957f\u5ea6\u5199\u9519\u4e86\u8c03\u4e86\u534a\u5929\u2026\u2026\u7136\u540e\u5404\u79cd\u5730\u65b9\u591a\u9879\u5f0f\u6ca1\u6e05\u96f6\u53c8\u8c03\u4e86\u534a\u5929\u2026\u2026\u53ef\u80fd\u662f\u56e0\u4e3a\u5e73\u65f6\u90fd\u6284\u677f\u5b50\u7684\u7f18\u6545\u6ca1\u6ce8\u610f\u8fd9\u95ee\u9898\u2026\u2026\n\n\u524d\u7f6e\u829d\u58eb\uff1a\u591a\u9879\u5f0f\u5bf9\u6570\u51fd\u6570\uff08[\u8fd9\u91cc](https://www.cnblogs.com/bztMinamoto/p/9747968.html)\uff09\uff0c\u6cf0\u52d2\u5c55\u5f00\uff08\u53ef\u4ee5\u770b\u770b[\u8fd9\u91cc](https://www.zhihu.com/question/25627482)\u7b2c\u4e00\u4e2a\u56de\u7b54\uff0c\u975e\u5e38\u2026\u2026\u751f\u52a8\u5f62\u8c61\uff09\uff0c\u725b\u987f\u8fed\u4ee3\u6cd5\uff08[\u8fd9\u91cc](http://blog.miskcoo.com/2015/06/polynomial-with-newton-method)\uff09\n\n### \u6cf0\u52d2\u5c55\u5f00\n\n\u7b80\u5355\u6765\u8bf4\u7684\u8bdd\uff0c\u5c31\u662f\u8981\u6c42\u4e00\u4e2a\u51fd\u6570$f(x)$\u67d0\u4e00\u70b9\u4e0a\u7684\u503c\uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u51fd\u6570$g(x)$\uff0c\u90a3\u4e48\u5bf9\u4e8e$x$\u70b9\u7684\u503c\uff0c\u6709$$f(x)\\approx g(x)=g(0)+\\frac{f^1(0)}{1!}x+\\frac{f^2(0)}{2!}x^2+\u2026\u2026+\\frac{f^n(0)}{n!}x^n$$\n\n\u5176\u4e2d$f^n(0)$\u8868\u793a\u5bf9\u539f\u51fd\u6570\u56fe\u50cf\u4e0a$0$\u8fd9\u4e2a\u70b9\u8fdb\u884c$n$\u9636\u6c42\u5bfc\n\n### \u725b\u987f\u8fed\u4ee3\n\n\u725b\u987f\u8fed\u4ee3\u53ef\u4ee5\u7528\u6765\u6c42\u4e00\u4e2a\u51fd\u6570\u7684\u96f6\u70b9\uff0c\u591a\u9879\u5f0f\u725b\u987f\u8fed\u4ee3\u81ea\u7136\u662f\u7528\u6765\u6c42\u591a\u9879\u5f0f\u7684\u96f6\u70b9\u7684\uff0c\u5373\u5bf9\u4e8e\u4e00\u4e2a\u51fd\u6570$G(x)$\uff0c\u6c42\u6ee1\u8db3\u6761\u4ef6$G(F(z)) \\equiv 0 \\pmod {z^n}$\u7684\u591a\u9879\u5f0f$F(z)$\n\nmiskcoo\u5927\u4f6c\u662f\u8fd9\u4e48\u8bf4\u7684\n\n![](https://i.loli.net/2018/10/07/5bb95f11da48a.png)\n\n### \u626f\u8fdc\u4e86\n\n\u7136\u540e\u73b0\u5728\u5c31\u662f\u8981\u8ba1\u7b97$$F(x)=e^{A(x)}$$\n\n\u90a3\u4e48\u53d8\u5f62\u4e00\u4e0b\u5f97$$\\ln F(x)-A(x)=0$$\n\n\u6211\u4eec\u8bbe$G(F(x))=\\ln F(x)-A(x)$\uff0c\u90a3\u4e48\u5c31\u662f\u8981\u6c42\u8fd9\u4e00\u4e2a\u51fd\u6570\u7684\u96f6\u70b9\u3002\u90a3\u4e48\u6211\u4eec\u628a$F(x)$\u770b\u505a\u53d8\u91cf\uff0c$A(x)$\u770b\u505a\u5e38\u6570\uff08\u6211\u4e5f\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u80fd\u8fd9\u6837\uff09\uff0c\u5bf9\u8fd9\u4e2a\u8fdb\u884c\u6c42\u5bfc\uff0c\u5f97$G'(F(x))=\\frac{1}{F(x)}$\n\n\u90a3\u4e48\u4ee3\u5165\u4e0a\u9762\u725b\u987f\u8fed\u4ee3\u7684\u516c\u5f0f\u5f97$$F(x)\\equiv F_0(x)-\\frac{G(F_0(x))}{G'(F_0(x))}\\pmod{x^n}$$\n$$F(x)\\equiv F_0(x)(1-\\ln F_0(x)+A(x))\\pmod{x^n}$$\n\n\u7136\u540e\u56e0\u4e3a$A(0)=0$\uff0c\u6240\u4ee5$F(x)$\u7684\u5e38\u6570\u9879\u4e3a1\n\nps\uff1a\u8fd9\u91cc\u7684$F_0(x)$\u6307\u7684\u662f\u5728\u6a21$x^{n\\over 2}$\u610f\u4e49\u4e0b\u7684\u7b54\u6848\n\n\u7136\u540e\u5de6\u8f6c\u628a\u5404\u79cd\u677f\u5b50\u590d\u5236\u8fc7\u6765\u5c31\u597d\u4e86\n```\n//minamoto\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#define swap(x,y) (x^=y,y^=x,x^=y)\n#define mul(x,y) (1ll*x*y%P)\n#define add(x,y) (x+y>=P?x+y-P:x+y)\n#define dec(x,y) (x-y<0?x-y+P:x-y)\nusing namespace std;\n#define getc() (p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\nchar buf[1<<21],*p1=buf,*p2=buf;\ninline int read(){\n    #define num ch-'0'\n    char ch;bool flag=0;int res;\n    while(!isdigit(ch=getc()))\n    (ch=='-')&&(flag=true);\n    for(res=num;isdigit(ch=getc());res=res*10+num);\n    (flag)&&(res=-res);\n    #undef num\n    return res;\n}\nchar sr[1<<21],z[20];int K=-1,Z;\ninline void Ot(){fwrite(sr,1,K+1,stdout),K=-1;}\ninline void print(int x){\n    if(K>1<<20)Ot();if(x<0)sr[++K]=45,x=-x;\n    while(z[++Z]=x%10+48,x/=10);\n    while(sr[++K]=z[Z],--Z);sr[++K]=' ';\n}\nconst int N=500005,P=998244353;\ninline int ksm(int a,int b){\n    int res=1;\n    while(b){\n        if(b&1) res=mul(res,a);\n        a=mul(a,a),b>>=1;\n    }\n    return res;\n}\nint n,r[N],A[N],B[N],C[N],D[N],F[N],G[N],O[N],f[N],g[N],inv[N];\nvoid init(int limit){\n    for(int i=0,l=limit<<1;i<=l;++i) inv[i]=ksm(i,P-2);\n}\nvoid NTT(int *A,int type,int len){\n    int limit=1,l=0;\n    while(limit<len) limit<<=1,++l;\n    for(int i=0;i<limit;++i)\n    r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n    for(int i=0;i<limit;++i)\n    if(i<r[i]) swap(A[i],A[r[i]]);\n    for(int mid=1;mid<limit;mid<<=1){\n        int R=mid<<1,Wn=ksm(3,(P-1)/R);O[0]=1;\n        for(int j=1;j<mid;++j) O[j]=mul(O[j-1],Wn);\n        for(int j=0;j<limit;j+=R){\n            for(int k=0;k<mid;++k){\n                int x=A[j+k],y=mul(O[k],A[j+k+mid]);\n                A[j+k]=add(x,y),A[j+k+mid]=dec(x,y);\n            }\n        }\n    }\n    if(type==-1){\n        reverse(A+1,A+limit);\n        for(int i=0,invl=inv[limit];i<limit;++i)\n        A[i]=mul(A[i],invl);\n    }\n}\nvoid Inv(int *a,int *b,int len){\n    if(len==1) return (void)(b[0]=inv[a[0]]);\n    Inv(a,b,len>>1);\n    for(int i=0;i<len;++i) C[i]=a[i],D[i]=b[i];\n    NTT(C,1,len<<1),NTT(D,1,len<<1);\n    for(int i=0,l=(len<<1);i<l;++i) C[i]=mul(mul(C[i],D[i]),D[i]);\n    NTT(C,-1,len<<1);\n    for(int i=0;i<len;++i) b[i]=dec(add(b[i],b[i]),C[i]);\n    for(int i=0,l=(len<<1);i<l;++i) C[i]=D[i]=0;\n}\nvoid Direv(int *A,int *B,int len){\n    for(int i=1;i<len;++i) B[i-1]=mul(A[i],i);B[len-1]=0; \n}\nvoid Inter(int *A,int *B,int len){\n    for(int i=1;i<len;++i) B[i]=mul(A[i-1],inv[i]);B[0]=0; \n}\nvoid Ln(int *a,int *b,int len){\n    Direv(a,A,len),Inv(a,B,len);\n    NTT(A,1,len<<1),NTT(B,1,len<<1);\n    for(int i=0,l=len<<1;i<l;++i) A[i]=mul(A[i],B[i]);\n    NTT(A,-1,len<<1),Inter(A,b,len<<1);\n    for(int i=0,l=len<<1;i<l;++i) A[i]=B[i]=0;\n}\nvoid Exp(int *a,int *b,int len){\n    if(len==1) return (void)(b[0]=1);\n    Exp(a,b,len>>1),Ln(b,F,len);\n    F[0]=dec(a[0]+1,F[0]);\n    for(int i=1;i<len;++i) F[i]=dec(a[i],F[i]);\n    NTT(F,1,len<<1),NTT(b,1,len<<1);\n    for(int i=0,l=len<<1;i<l;++i) b[i]=mul(b[i],F[i]);\n    NTT(b,-1,len<<1);\n    for(int i=len,l=(len<<1);i<l;++i) b[i]=F[i]=0;\n}\nint main(){\n//\tfreopen(\"testdata.in\",\"r\",stdin);\n    n=read();\n    for(int i=0;i<n;++i) f[i]=read();\n    int len;for(len=1;len<=n;len<<=1);init(len);\n    Exp(f,g,len);\n    for(int i=0;i<n;++i) print(g[i]);\n    Ot();\n    return 0;\n}\n```",
        "postTime": 1538875959,
        "uid": 41781,
        "name": "bztMinamoto",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4726 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u6307\u6570\u51fd\u6570\u3011"
    },
    {
        "content": "## \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a\u591a\u9879\u5f0f$A(x)$\uff0c\u6c42\u4e00\u4e2a\u591a\u9879\u5f0f$B(x)$\uff0c\u6ee1\u8db3\n\n$$B(x)\\equiv e^{A(x)}(\\bmod{\\:x^n}) $$\n\n## \u9898\u89e3\n\n\u9ed8\u8ba4\u5927\u5bb6\u90fd\u4f1a\u591a\u9879\u5f0f\u6c42\u9006\u548c\u591a\u9879\u5f0f\u6c42ln\uff0c\u4e0d\u4f1a\u7684\u8bf7\u5de6\u8f6c[\u8fd9\u91cc](https://www.luogu.org/problemnew/show/P4238)\u548c[\u8fd9\u91cc](https://www.luogu.org/problemnew/show/P4725)\n\n### \u9884\u77e5\u8bc61\uff1a\u725b\u987f\u8fed\u4ee3\n\n\u5148\u770b\u4e00\u9053\u5c0f\u95ee\u9898\uff1a\u624b\u7b97\uff0c\u5982\u4f55\u5bf9\u4e00\u4e2a$10^9$\u5927\u5c0f\u7684\u6570$a$\u5f00\u65b9\uff1f\n\n\u5982\u679c\u4f60\u4e8c\u5206\uff0c\u90a3\u4e48\u9884\u8ba1\u8981\u4e8c\u520630\u6b21\u5de6\u53f3\uff0c\u6bcf\u4e00\u6b21\u8981\u7b97\u4e00\u4e2a5\u4f4d\u6570\u7684\u5e73\u65b9\u3002\n\n\u4e8e\u662f\u725b\u987f\u6cd5\u4ea7\u751f\u4e86\u3002\n\n\u6211\u4eec\u672c\u8d28\u4e0a\u662f\u8981\u6c42$f(x)=x^2-a$\u7cbe\u786e\u5230\u6574\u6570\u7684\u96f6\u70b9\u3002\n\n\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u6c42\u5f97\u4e86\u4e00\u4e2a\u8fd1\u4f3c\u503c$x_0$\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u8fc7$(x_0,f(x_0))$\u8fd9\u4e2a\u70b9\u4f5c\u8fd9\u4e2a\u51fd\u6570\u56fe\u50cf\u7684\u5207\u7ebf\uff0c\u53d6\u5207\u7ebf\u4e0e$x$\u8f74\u7684\u4ea4\u70b9\u4f5c\u4e3a\u65b0\u7684$x_0$\u3002\n\n\u4e22\u4e00\u5f20\u56fe\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/55084.png)\n\n\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u6837\u6bcf\u6b21\u6c42\u5207\u7ebf\uff0c\u8fd1\u4f3c\u503c\u4f1a\u8fc5\u901f\u903c\u8fd1\u7cbe\u786e\u503c\uff0c\u8fd9\u6837\u53ef\u4ee5\u5927\u5927\u51cf\u5c11\u5de5\u4f5c\u91cf\u3002\u5b9e\u8df5\u8bc1\u660e\u5bf9$201723039$\uff08\u6211\u7684\u8003\u53f7\uff0c\u8fd9\u662f\u8003\u6570\u5b66\u7684\u65f6\u5019\u53d1\u751f\u7684\u4e00\u4e2a\u771f\u5b9e\u7684\u6545\u4e8b\uff09\u5f00\u65b9\u521d\u503c\u53d6\u5230$40000$\u53ea\u9700\u8981\u8fed\u4ee3\u56db\u6b21\u5c31\u53ef\u4ee5\u7cbe\u786e\u5230\u6574\u6570\u3002\n\n\u5047\u8bbe\u6211\u4eec\u8981\u6c42\u4e00\u4e2a\u51fd\u6570$f(x)$\u7684\u96f6\u70b9\uff0c\u521d\u59cb\u8fd1\u4f3c\u503c\u662f$x_0$\u3002\n\n\u5219\u5207\u7ebf\u65b9\u7a0b\u4e3a\n\n$$y=f'(x_0)(x-x_0)+f(x_0)$$\n\n\uff08\u4e0d\u4f1a\u7684\u597d\u597d\u770b\u770b\u9ad8\u4e2d\u6570\u5b66\u9009\u4fee2-2\uff09\n\n\u4ee4$y=0$\uff0c\u5f97\u5230$x=x_0-\\dfrac{f(x_0)}{f'(x_0)}$\u3002\n\n\u653e\u5230\u591a\u9879\u5f0f\u4e0a\u4e5f\u662f\u540c\u7406\u7684\u3002\n\n\u5047\u8bbe\u6211\u4eec\u8981\u6c42\u4e00\u4e2a\u51fd\u6570$G(x)$\uff0c\u6ee1\u8db3$F(G(x))\\equiv 0$\u3002\n\n\u5229\u7528\u4e0a\u9762\u7684\u5f0f\u5b50\uff0c\u6211\u4eec\u53ef\u4ee5\u6bcf\u4e00\u6b21\u4ee4\n\n$$G(x)=G_0(x)-\\dfrac{F(G_0(x))}{F'(G_0(x))}$$\n\n\u8fd9\u6837\u5b83\u53ef\u4ee5\u8fc5\u901f\u903c\u8fd1\u771f\u5b9e\u503c\u3002\n\n\u672c\u8d28\u4e0a\uff0c\u8fed\u4ee3\u4e00\u6b21\u7cbe\u5ea6\u5c31\u53ef\u4ee5\u7ffb\u500d\u3002\u5982\u679c$F(G_0(x))\\equiv 0(\\bmod{\\:x^{n\\over 2}})$\uff0c\u90a3\u4e48$F(G(x))\\equiv 0(\\bmod{\\:x^{n}})$\uff0c\u8bc1\u660e\u6211\u4e5f\u4e0d\u4f1a\uff0c\u53ea\u80fd\u611f\u6027\u7406\u89e3\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u6bcf\u6b21\u5c06$n$\u9664\u4ee5$2$\uff0c\u9012\u5f52\u8fdb\u53bb\u505a\uff0c\u7136\u540e\u7528\u4e0a\u9762\u90a3\u4e2a\u725b\u987f\u8fed\u4ee3\u7684\u5f0f\u5b50\u53bb\u505a\u3002\n\n### \u7528\u725b\u987f\u8fed\u4ee3\u63a8\u591a\u9879\u5f0fexp\n\n$$B(x)\\equiv e^{A(x)}(\\bmod{\\:x^n}) $$\n\n$$\\ln B(x)-A(x)\\equiv 0(\\bmod{\\:x^n}) $$\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u4f7f\u5f97$F(G(x))=\\ln G(x)-A(x)\\equiv 0$\u3002\n\n$$\\Big(F\\big(G_0(x)\\big)\\Big)'=\\dfrac{G_0'(x)}{G_0(x)}$$\n\n\uff08\u590d\u5408\u51fd\u6570\u6c42\u5bfc\u6cd5\u5219\u4e0d\u80fd\u5fd8\u554a\uff09\n\n\u5e26\u5165\u4e0a\u9762\u90a3\u4e2a\u5f0f\u5b50\u5f97\u5230\uff1a\n\n$$G(x)=G_0(x)-\\dfrac{\\ln G_0(x)-A(x)}{\\dfrac{G_0'(x)}{G_0(x)}}=\\dfrac{G_0(x)(1-\\ln G_0(x)+A(x))}{G_0'(x)}$$\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6bcf\u6b21\u8fed\u4ee3\u505a\u4e00\u904d\u591a\u9879\u5f0f\u6c42\u9006\uff0c\u518d\u505a\u4e00\u904d\u591a\u9879\u5f0f\u6c42ln\uff0c\u7136\u540e\u518d\u505a\u4e00\u904d\u591a\u9879\u5f0f\u4e58\u6cd5\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u7b54\u6848\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a\n\n$$T(n)=T\\left(n\\over 2\\right)+O(n\\log n)=O(n\\log n)$$\n\n\u6ca1\u9519\uff0c\u600e\u4e48\u725b\u987f\u8fed\u4ee3\u90fd\u662f$O(n\\log n)$\uff01\n\n\u4e0b\u9762\u662f\u4ee3\u7801\uff1a\n\n```\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n#define ll long long\nusing namespace std;\nconst ll MOD=998244353,inv2=499122177;\nint limit,l,r[400005];\nll ni[400005];\nvoid calc_ni(int n)\n{\n\tni[1]=1;\n\tfor(int i=2;i<=n;i++)\n\t  ni[i]=MOD-(MOD/i)*ni[MOD%i]%MOD;\n}\nll quick_pow(ll x,ll a)\n{\n\tll ans=1;\n\twhile(a)\n\t{\n\t\tif(a&1)ans=ans*x%MOD;\n\t\tx=x*x%MOD;\n\t\ta>>=1;\n\t}\n\treturn ans;\n}\nvoid NTT(ll*A,int type)\n{\n\tfor(int i=0;i<limit;i++)\n\t  if(i<r[i])swap(A[i],A[r[i]]);\n\tfor(int mid=1;mid<limit;mid<<=1)\n\t{\n\t\tll Wn=type==1?quick_pow(3,(MOD-1)/(mid<<1)):quick_pow(3,MOD-1-(MOD-1)/(mid<<1));\n\t\tfor(int R=mid<<1,j=0;j<limit;j+=R)\n\t\t{\n\t\t\tll w=1;\n\t\t\tfor(int k=0;k<mid;k++,w=w*Wn%MOD)\n\t\t\t{\n\t\t\t\tll x=A[j+k],y=w*A[j+mid+k]%MOD;\n\t\t\t\tA[j+k]=(x+y)%MOD;\n\t\t\t\tA[j+mid+k]=(x-y+MOD)%MOD;\n\t\t\t}\n\t\t}\n\t}\n\tif(type==-1)\n\t{\n\t\tll inv=quick_pow(limit,MOD-2);\n\t\tfor(int i=0;i<limit;i++)A[i]=A[i]*inv%MOD;\n\t}\n}\nll A[400005];\nvoid Inv(ll*a,ll*b,int n)\n{\n\tif(n==1)\n\t{\n\t\tb[0]=quick_pow(a[0],MOD-2);\n\t\treturn;\n\t}\n\tInv(a,b,(n+1)>>1);\n\tlimit=1,l=0;\n\twhile(limit<(n<<1))limit<<=1,l++;\n\tfor(int i=0;i<limit;i++)\n\t  r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\tfor(int i=0;i<limit;i++)A[i]=i<n?a[i]:0;\n\tNTT(A,1);\n\tNTT(b,1);\n\tfor(int i=0;i<limit;i++)\n\t  b[i]=b[i]*(2+MOD-A[i]*b[i]%MOD)%MOD;\n\tNTT(b,-1);\n\tfor(int i=n;i<limit;i++)b[i]=0;\n}\nll a2[400005];\nvoid Ln(ll*a,ll*b,int n)\n{\n\tfor(int i=0;i<(n<<2);i++)b[i]=0;\n\tInv(a,b,n);\n\tlimit=1,l=0;\n\twhile(limit<(n<<1))limit<<=1,l++;\n\tfor(int i=0;i<limit;i++)\n\t  r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\tfor(int i=0;i<n-1;i++)a2[i]=a[i+1]*(i+1)%MOD;\n\tfor(int i=n-1;i<limit;i++)a2[i]=0;\n\tNTT(a2,1);\n\tNTT(b,1);\n\tfor(int i=0;i<limit;i++)\n\t  b[i]=b[i]*a2[i]%MOD;\n\tNTT(b,-1);\n\tfor(int i=n-1;i>0;i--)\n\t  b[i]=b[i-1]*ni[i]%MOD;\n\tfor(int i=n;i<limit;i++)b[i]=0;\n\tb[0]=0;\n}\nll lnb[400005];\nvoid Exp(ll*a,ll*b,int n)\n{\n\tif(n==1)\n\t{\n\t\tb[0]=1;\n\t\treturn;\n\t}\n\tExp(a,b,(n+1)>>1);\n\tLn(b,lnb,n);\n\tlimit=1,l=0;\n\twhile(limit<(n<<1))limit<<=1,l++;\n\tfor(int i=0;i<limit;i++)\n\t  r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\tfor(int i=0;i<n;i++)lnb[i]=a[i]>=lnb[i]?a[i]-lnb[i]:a[i]-lnb[i]+MOD;\n\tfor(int i=n;i<limit;i++)lnb[i]=b[i]=0;\n\tlnb[0]++;\n\tNTT(lnb,1);\n\tNTT(b,1);\n\tfor(int i=0;i<limit;i++)b[i]=b[i]*lnb[i]%MOD;\n\tNTT(b,-1);\n\tfor(int i=n;i<limit;i++)b[i]=0;\n}\nint n;\nll f[400005],g[400005];\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=0;i<n;i++)scanf(\"%lld\",&f[i]);\n\tcalc_ni(n);\n\tExp(f,g,n);\n\tfor(int i=0;i<n;i++)printf(\"%lld \",g[i]);\n\tprintf(\"\\n\");\n\treturn 0;\n}\n```\n\n\u5e38\u6570\u5de8\u5927\uff0c\u614e\u7528\n\nupd: BUG \u4fee\u590d",
        "postTime": 1553604765,
        "uid": 54214,
        "name": "wucstdio",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P4726 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u6307\u6570\u51fd\u6570\u3011"
    },
    {
        "content": "\u53d1\u4e00\u4e2a\u5206\u6cbbNTT\u7684\u9898\u89e3\u3002\u5982\u679c\u60f3\u8981\u770b\u4e00\u4e2alog\u7684\u6b63\u89e3\u8bf7\u53c2\u8003\u5176\u4ed6dalao\u7684\u4ee3\u7801\u3002\n\n\u9898\u76ee\u8981\u6c42\u7684\u662f$$B(x)=e^{A(x)}$$\n\u4e24\u8fb9\u540c\u65f6\u6c42\u5bfc\u5f97\u5230$$B'(x)=A'(x)e^{A(x)}$$\n\u5373$$B'(x)=A'(x)B(x)$$\n\u540c\u65f6\u79ef\u5206\u5f97\u5230$$B(x)=\\int{A'(x)B(x)}$$\n\u53c8\u56e0\u4e3a\u5c06$x=0$\u4ee3\u5165$A$\u548c$B$\u4e2d\u53ef\u4ee5\u5f97\u5230$B(0)=1$\uff0c\u53ef\u4ee5\u4ee5\u6b64\u4e3a\u521d\u59cb\u503c\u8fdb\u884c\u5206\u6cbbFFT\uff0c\u6bcf\u6b21\u628a$A'$\u548c$B$\u7684\u5377\u79ef\u5e73\u79fb\u4e00\u9879\u540e\u52a0\u5230$B$\u81ea\u8eab\u4e0a\u3002\u505a\u591a\u9879\u5f0f\u79ef\u5206\u65f6\u7b2cn\u9879\u4f1a\u4ea7\u751f$\\frac{1}{n}$\u7684\u5e38\u6570\uff0c\u53ef\u4ee5\u5728\u9012\u5f52\u8fb9\u754c\u65f6\u4e58\u4e0a\u53bb\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\log^2{n})$\uff0c\u4f46\u56e0\u4e3a\u5e38\u6570\u8f83\u5c0f\uff0c\u5b9e\u9645\u4e0a\u53ea\u6bd4\u725b\u987f\u8fed\u4ee3\u6162\u4e00\u500d\u4ee5\u5185\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff08\u6211\u7684NTT\u5199\u6cd5\u6bd4\u8f83\u77ed\uff09\uff1a\n```cpp\n// luogu-judger-enable-o2\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst ll lg=18,N=1<<lg,mod=998244353;\nint n;\nll f[N],g[N],rev[N],w[N],c[N],d[N];\nll po(ll a,ll b){\n    ll r=1;for(;b;b>>=1,(a*=a)%=mod)if(b&1)(r*=a)%=mod;\n    return r;\n}\nvoid FFT(ll *a,int lg){\n    for(int i=0;i<(1<<lg);i++)if(i<rev[i])swap(a[i],a[rev[i]]);\n    for(int i=0;i<lg;i++)\n        for(int j=0;j<(1<<lg);j++)if(j&1<<i){\n            ll x=j^1<<i,l=a[x],r=a[j]*w[(j&(1<<i)-1)<<lg-1-i]%mod;\n            a[x]=(l+r)%mod,a[j]=(l+mod-r)%mod;\n        }\n}\nvoid work(int l,int r){ //\u6b64\u5904\u662f\u5de6\u95ed\u53f3\u5f00\u533a\u95f4[l,r)\n    if(l+1==r){\n        if(l)(f[l]*=po(l,mod-2))%=mod;else f[l]=1;\n        return;\n    }\n    int mid=l+r>>1,_lg,n;\n    work(l,mid);\n    for(_lg=0;1<<_lg<r-l-1;_lg++);\n    n=1<<_lg;\n    for(int i=0;i<n;i++)\n        c[i]=d[i]=0,w[i]=po(3,1ll*(mod-1)*i/n),\n        rev[i]=rev[i/2]/2|(i&1)<<_lg-1;\n    for(int i=0;i<mid-l;i++)c[i]=f[i+l];\n    for(int i=0;i<r-l-1;i++)d[i]=g[i];\n    FFT(c,_lg),FFT(d,_lg);\n    for(int i=0;i<n;i++)(c[i]*=d[i])%=mod,w[i]=po(w[i],mod-2);\n    FFT(c,_lg);\n    for(int i=mid-1-l;i<r-l-1;i++)(f[i+l+1]+=c[i]*po(n,mod-2)%mod)%=mod;\n    work(mid,r);\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=0;i<n;i++)scanf(\"%lld\",g+i);\n    for(int i=1;i<n;i++)g[i-1]=g[i]*i%mod;g[n-1]=0;\n    work(0,n);\n    for(int i=0;i<n;i++)printf(\"%lld%c\",f[i],i==n-1?'\\n':' ');\n    return 0;\n}\n```",
        "postTime": 1547640214,
        "uid": 30093,
        "name": "cosmicAC",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4726 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u6307\u6570\u51fd\u6570\u3011"
    },
    {
        "content": "$\\text{upd 20.7.20}:$ \u6dfb\u52a0\u725b\u987f\u8fed\u4ee3\u7684\u8bc1\u660e\u90e8\u5206\u3002\n\n\u6709\u4e00\u4e2a\u7ed3\u8bba\uff1a\u5982\u679c\u5c06\u591a\u9879\u5f0f\u7684\u65b9\u7a0b\u8fdb\u884c\u725b\u987f\u8fed\u4ee3\uff0c\u6bcf\u6b21\u7684\u903c\u8fd1\u4f4d\u6570\u4f1a\u7ffb\u500d\u3002\u6362\u800c\u8a00\u4e4b\uff1a\n\n\u5982\u679c\u65b9\u7a0b\u5f62\u5982\n\n$$F(G(x))\\equiv 0\\pmod{x^n}$$\n\n\u800c\u5df2\u7ecf\u5f97\u77e5\n\n$$F(G_0(x))\\equiv 0\\pmod{x^{\\lceil \\frac n2\\rceil}}$$\n\n\u5219\u7ecf\u8fc7\u4e00\u6b21\u725b\u987f\u8fed\u4ee3\u540e\u53ef\u63a8\u77e5\u4e0a\u5f0f\u3002\n\n\u53ef\u4ee5\u8003\u8651\u901a\u8fc7\u5982\u4e0b\u65b9\u5f0f\u8bc1\u660e\u3002\n\n\u5c06 $F(G(x))$ \u5728 $G_0(x)$ \u5904\u6cf0\u52d2\u5c55\u5f00\uff1a\n\n$$F(G(x))=\\sum_{n=0}^{\\infty}\\frac{F^{(n)}(G_0(x))}{n!}(G(x)-G_0(x))^n\\equiv 0\\pmod{x^n}$$\n\n\u6839\u636e $G_0\\equiv G\\pmod{x^{\\lceil\\frac n2\\rceil}}$\uff0c\u5f97\u5230 $G_0^2\\equiv G^2\\pmod{x^n}$\uff08\u8fed\u4ee3\u540e\u5df2\u6c42\u7684\u7cfb\u6570\u4e0d\u4f1a\u6539\u53d8\uff09\n\n\u53c8\u6709 $(a-b)^n\\equiv a^n-b^n\\pmod n$[\u53c2\u8003\u6587\u7ae0](https://www.luogu.com.cn/blog/void-basic-learner/polygon-square-root-enhanced)\uff0c\u591a\u9879\u5f0f\u5373 $(F-G)^n\\equiv F^n-G^n\\pmod{x^n}$\u3002\n\n\u56e0\u6b64\u6cf0\u52d2\u5c55\u5f00\u5f0f\u7b2c\u4e09\u9879\u53ca\u4ee5\u540e\u7684\u9879\u90fd\u5728 $\\pmod{x^n}$ \u4e0b\u4e3a $0$\u3002\n\n$$ F(G_0(x))+F'(G_0(x))(G(x)-G_0(x))\\equiv 0\\pmod{x^n}$$\n\n\u5f97\u5230\u8fed\u4ee3\u516c\u5f0f\uff1a\n\n$$G(x)\\equiv G_0(x)-\\frac{F(G_0(x))}{F'(G_0(x))}\\pmod{x^n}$$\n\n\u5219\u53ef\u4ee5\u5c1d\u8bd5\u9012\u5f52\u5730\u5e94\u7528\u5230\u672c\u9898\u3002\n\n---\n\n\u672c\u9898\u4e2d\u6c42\n\n$$G(x)\\equiv e^{A(x)}\\pmod{x^n}$$\n\n\u5373\n\n$$\\ln G(x)-A(x)\\equiv 0\\pmod{x^n}$$\n\n\u5c31\u662f\u8fd9\u6837\u4e00\u4e2a\u65b9\u7a0b\u3002\u8fed\u4ee3\u7684\u51fd\u6570\u81ea\u7136\u662f\n\n$$F(G(x))=\\ln G(x) - A(x)$$\n\n\u8003\u8651\u8fb9\u754c\u60c5\u51b5\u4e0b\uff0c $n=1$\u3002\u9898\u76ee\u4e2d\u7ed9\u51fa\u4e86 $a_0=0$\uff0c\u5219\u6709 $\\ln g_0-0=0$\uff0c\u5e38\u6570\u9879\u8d4b\u4e3a $1$ \u5373\u53ef\u3002\n\n\u5426\u5219\u8fd0\u7528\u8fed\u4ee3\u516c\u5f0f\u3002\u5176\u4e2d\u6709 $F'(G(x))=1/G(x)$\uff1a\n\n$$\\begin{aligned}\nG(x)&\\equiv G_0(x)-\\frac{\\ln G_0(x)-A(x)}{\\frac 1 {G_0(x)}}\\pmod{x^n} \\\\\n&\\equiv G_0(x)-G_0(\\ln G_0(x)-A(x))\\pmod{x^n} \\\\\n&\\equiv G_0(x)(1-\\ln G_0(x)+A(x))\\pmod{x^n}\n\\end{aligned}$$\n\n\u4e8e\u662f\u6bcf\u6b21\u9012\u5f52\u4e2d\u6c42\u4e00\u904d $\\ln$\uff0c\u4e00\u904d\u52a0\u51cf\uff0c\u518d\u4e00\u904d\u4e58\u6cd5\uff0c\u4e00\u5171 $O(n\\log n)$\uff0c\u603b\u5171\u4e5f\u662f $O(n\\log n)$ \u7684\u3002\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n#include <cmath>\n#include <algorithm>\n\ntypedef long long ll;\nconst int MAXN = 400001;\nconst int p = 998244353;\n\ninline int read() {\n    int x = 0,f = 1; char ch = getchar();\n    while(ch > '9' || ch < '0') { if(ch == '-') f = -1; ch = getchar(); }\n    do x = x * 10 + ch - 48, ch = getchar(); while(ch >= '0' && ch <= '9');\n    return x * f;\n}\n\nll fastpow(ll a,int b) {\n    ll res = 1; a %= p;\n    while(b) {\n        if(b & 1) res = res * a % p;\n        a = a * a % p;\n        b >>= 1;\n    }\n    return res;\n}\n\nint n,r[MAXN];\nll a[MAXN],b[MAXN],f[MAXN],g[MAXN];\n\nvoid NTT(ll *a,int N) {\n    for(int i = 0;i < N;i++) if(i < r[i]) std::swap(a[i],a[r[i]]);\n    for(int n = 2, m = 1;n <= N;m = n, n <<= 1) {\n        ll g1 = fastpow(3,(p - 1) / n),t1,t2;\n        for(int l = 0;l < N;l += n) {\n            ll g = 1;\n            for(int i = l;i < l + m;i++) {\n                t1 = a[i], t2 = g * a[i + m] % p;\n                a[i] = (t1 + t2) % p;\n                a[i + m] = (t1 + p - t2) % p;\n                g = g * g1 % p;\n            }\n        }\n    }\n    return;\n}\n\nvoid INTT(ll *a,int N) {\n    NTT(a,N);\n    std::reverse(a + 1,a + N);\n    ll invN = fastpow(N,p - 2);\n    for(int i = 0;i < N;i++) a[i] = a[i] * invN % p;\n    return;\n}\n\nvoid Dervt(ll *a,ll *b,int n) {\n    for(int i = 0;i < n;i++) b[i] = a[i + 1] * (i + 1) % p;\n    b[n - 1] = 0;\n    return;\n}\n\nvoid Integ(ll *a,ll *b,int n) {\n    for(int i = 0;i < n;i++) b[i + 1] = a[i] * fastpow(i + 1,p - 2) % p;\n    b[0] = 0;\n    return;\n}\n\nll a1[MAXN];\n\nvoid Inv(ll *a,ll *b,int n) {\n    if(n == 1) return void(b[0] = fastpow(a[0],p - 2));\n    Inv(a,b,(n + 1) >> 1);\n    int N = 1, l = -1; while(N <= n << 1) N <<= 1, l++;\n    for(int i = 1;i < N;i++) r[i] = (r[i >> 1] >> 1) | ((i & 1) << l);\n    for(int i = 0;i < n;i++) a1[i] = a[i];\n    for(int i = n;i < N;i++) a1[i] = 0;\n    NTT(a1,N); NTT(b,N);\n    for(int i = 0;i < N;i++) b[i] = ((b[i] << 1) % p + p - a1[i] * b[i] % p * b[i] % p) % p;\n    INTT(b,N);\n    for(int i = n;i < N;i++) b[i] = 0;\n    return;\n}\n\nvoid Ln(ll *a,ll *b,int n) {\n    memset(g,0,sizeof(g));\n    Dervt(a,f,n); Inv(a,g,n);\n    int N = 1, l = -1; while(N <= n << 1) N <<= 1, l++;\n    for(int i = 1;i < N;i++) r[i] = (r[i >> 1] >> 1) | ((i & 1) << l);\n    NTT(f,N); NTT(g,N);\n    for(int i = 0;i < N;i++) f[i] = f[i] * g[i] % p;\n    INTT(f,N); Integ(f,b,n);\n    return;\n}\n\nll lnb[MAXN];\n\nvoid Exp(ll *a,ll *b,int n) {\n    if(n == 1) return void(b[0] = 1);\n    Exp(a,b,(n + 1) >> 1);\n    Ln(b,lnb,n);\n    int N = 1, l = -1; while(N <= n << 1) N <<= 1, l++;\n    for(int i = 1;i < N;i++) r[i] = (r[i >> 1] >> 1) | ((i & 1) << l);\n    for(int i = 0;i < n;i++) a1[i] = a[i];\n    for(int i = n;i < N;i++) lnb[i] = a1[i] = 0;\n    for(int i = 0;i < N;i++) a1[i] = ((a1[i] - lnb[i]) % p + p) % p;\n    a1[0]++;\n    NTT(b,N); NTT(a1,N);\n    for(int i = 0;i < N;i++) b[i] = b[i] * a1[i] % p;\n    INTT(b,N);\n    for(int i = n;i < N;i++) b[i] = 0;\n    return;\n}\n\nint main() {\n    n = read();\n    for(int i = 0;i < n;i++) a[i] = read();\n    Exp(a,b,n);\n    for(int i = 0;i < n;i++) std::printf(\"%lld \",b[i]);\n    return 0;\n}\n```",
        "postTime": 1594088044,
        "uid": 219595,
        "name": "Vocalise",
        "ccfLevel": 9,
        "title": "\u591a\u9879\u5f0fexp--\u9898\u89e3 P4726 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u6307\u6570\u51fd\u6570\uff08\u591a\u9879\u5f0f exp\uff09\u3011"
    },
    {
        "content": "\u5148\u4ece\u725b\u987f\u8fed\u4ee3\u8bb2\u8d77\u3002\n\n\u5df2\u77e5\u591a\u9879\u5f0f\u51fd\u6570$G(z)$\uff0c\u6c42\u591a\u9879\u5f0f\u51fd\u6570$F(x)$\u6ee1\u8db3\n$$G(F(x))\\equiv0 \\pmod{x^n}$$\n\u8003\u8651\u7528\u8fed\u4ee3\u6c42\u89e3\uff0c\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u6c42\u5f97$F_0(x)$\u6ee1\u8db3\n$$G(F_0(x))\\equiv0\\pmod{x^{\\left\\lceil\\frac{n}{2}\\right\\rceil}}$$\n\u5c06\u51fd\u6570$G$\u5728$z=F_0(x)$\u5904\u8fdb\u884c\u6cf0\u52d2\u5c55\u5f00\n$$G(F(x))=\\sum_{i=1}^{\\infty}\\frac{G^i(F_0(x))}{i!}(F(x)-F_0(x))^i$$\n\u5176\u4e2d$G^i$\u4e3a$G$\u7684$i$\u9636\u5bfc\u51fd\u6570.\n\n\u53d6\u524d\u4e24\u9879\n$$G(F(x))\\equiv G(F_0(x))+G'(F_0(x))(F(x)-F_0(x))\\pmod{x^n}$$\n\u8003\u8651\u5230$G(F(x))\\equiv 0\\pmod{x^n}$\n$$F(x)\\equiv F_0(x)-\\frac{G(F_0(x))}{G'(F_0(x))}\\pmod{x^n}$$\n\u8fb9\u754c\u6761\u4ef6\u5373$f[0]=1$\uff0c\u5411\u4e0a\u8fed\u4ee3\u5373\u53ef.\n\n\u56de\u5230\u672c\u9898\uff0c\u8003\u8651\u5230\n$$B(x)\\equiv e^{A(x)}\\pmod{x^n}$$\n\u5373\n$$\\ln B(x)-A(x)\\equiv0\\pmod{x^n}$$\n\u4e8e\u662f\u4ee4\n$$G(B(x))\\equiv\\ln B(x)-A(x)\\pmod{x^n}$$\n\u7531\u4e8e$A(x)$\u4e3a\u5e38\u6570\n$$G'(B(x))=B^{-1}(x)$$\n\u5957\u725b\u987f\u8fed\u4ee3\n$$B(x)\\equiv B_0(x)(1-\\ln B_0(x)+A(x))\\pmod{x^n}$$\n\u8fd9\u5c31\u5f88\u597d\u6c42\u4e86\uff0c\u4ee3\u7801\u5982\u4e0b\n```cpp\n#include <bits/stdc++.h>\n#define re register\n\nusing namespace std;\ntypedef long long ll;\nconst int N = 1<<20;\n\nint read() {\n\tint x = 0, f = 1; char c = getchar();\n\twhile(c < '0' || c > '9') {if(c == '-') f = -1; c = getchar();}\n\twhile(c >= '0' && c <= '9') x = (x<<1) + (x<<3) + c - '0', c = getchar();\n\treturn x * f;\n}\n\ninline void write(int a,char ed='\\n')\n{\n    static short s[13],tp;\n    if(!a){putchar('0'),putchar(ed);return;}\n    for(tp=0;a;a/=10)s[++tp]=a%10;\n    for(;tp;putchar(s[tp--]^48));\n    putchar(ed);\n}\nnamespace Polynomial\n{\n\tconst ll P = 998244353, g = 3, gi = 332748118;\n\tstatic int rev[N];\n\tint lim, bit;\n\tint add(int a, int b)\n\t{\n\t\treturn (a += b) >= P ? a - P : a;\n\t}\n\tint qpow(int a, int b) \n\t{\n\t\tint prod = 1;\n\t\twhile(b)\n\t\t{\n\t\t\tif(b & 1) prod = (ll)prod * a % P;\n\t\t\ta = (ll)a * a % P;\n\t\t\tb >>= 1;\n\t\t}\n\t\treturn (prod + P) % P;\n\t}\n\tvoid calrev() {\n\t\tfor(re int i = 1; i < lim; ++i)\n\t\t\trev[i] = (rev[i >> 1] >> 1) | ((i & 1) << (bit - 1));\n\t}\n\tvoid NTT(int *A, int inv) \n\t{\n\t\tfor(re int i = 0; i < lim; ++i)\n\t\t\tif(i < rev[i]) swap(A[i], A[rev[i]]);\n\t\tfor(re int mid = 1; mid < lim; mid <<= 1) \n\t\t{\n\t\t\tint tmp = qpow(inv == 1 ? g : gi, (P - 1) / (mid << 1));\n\t\t\tfor(re int j = 0; j < lim; j += (mid << 1)) \n\t\t\t{\n\t\t\t\tint omega = 1;\n\t\t\t\tfor(re int k = 0; k < mid; ++k, omega = (ll)omega * tmp % P) \n\t\t\t\t{\n\t\t\t\t\tint x = A[j + k], y = (ll)omega * A[j + k + mid] % P;\n\t\t\t\t\tA[j + k] = (x + y) % P;\n\t\t\t\t\tA[j + k + mid] = (ll)(x - y + P) % P;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(inv == 1) return;\n\t\tint invn = qpow(lim, P - 2);\n\t\tfor(re int i = 0; i < lim; ++i)\n\t\t\tA[i] = (ll)A[i] * invn % P;\n\t}\n\tstatic int x[N], y[N];\n\tvoid mul(int *a, int *b)\n\t{\n\t\tmemset(x, 0, sizeof x);\n\t\tmemset(y, 0, sizeof y);\n\t\tfor(re int i = 0; i < (lim >> 1); ++i)\n\t\t\tx[i] = a[i], y[i] = b[i];\n\t\tNTT(x, 1), NTT(y, 1);\n\t\tfor(re int i = 0; i < lim; ++i)\n\t\t\tx[i] = (ll)x[i] * y[i] % P;\n\t\tNTT(x, -1);\n\t\tfor(re int i = 0; i < lim; ++i)\n\t\t\ta[i] = x[i];\n\t}\n\tstatic int c[2][N];\n\tvoid Inv(int *a, int n) \n\t{\n\t\tint p = 0;\n\t\tmemset(c, 0, sizeof c);\n\t\tc[0][0] = qpow(a[0], P - 2);\n\t\tlim = 2, bit = 1;\n\t\twhile(lim <= (n << 1))\n\t\t{\n\t\t\tlim <<= 1, bit++;\n\t\t\tcalrev();\n\t\t\tp ^= 1;\n\t\t\tmemset(c[p], 0, sizeof c[p]);\n\t\t\tfor(re int i = 0; i <= lim; ++i)\n\t\t\t\tc[p][i] = add(c[p^1][i], c[p^1][i]);\n\t\t\tmul(c[p^1], c[p^1]);\n\t\t\tmul(c[p^1], a);\n\t\t\tfor(re int i = 0; i <= lim; ++i)\n\t\t\t\tc[p][i] = add(c[p][i], P - c[p^1][i]);\n\t\t}\n\t\tfor(re int i = 0; i < lim; ++i)\n\t\t\ta[i] = c[p][i];\n\t}\n\tvoid derivative(int *a, int n)\n\t{\n\t\tfor(re int i = 1; i <= n; ++i)\n\t\t\ta[i - 1] = (ll)a[i] * i % P;\n\t\ta[n] = 0;\n\t}\n\tvoid inter(int *a, int n)\n\t{\n\t\tfor(re int i = n; i >= 1; --i)\n\t\t\ta[i] = (ll)a[i - 1] * qpow(i, P - 2) % P;\n\t\ta[0] = 0;\n\t}\n\tstatic int b[N], T[N], K[N];\n\tvoid ln(int *a, int n) \n\t{\n\t\tmemcpy(b, a, sizeof b);\n\t\tInv(b, n), derivative(a, n);\n\t\twhile(lim <= (n << 2)) lim <<= 1, bit++;\n\t\tcalrev();\n\t\tmul(a, b);\n\t\tinter(a, n);\n\t\tfor(re int i = n + 1; i <= lim; ++i)\n\t\t\ta[i] = 0;\n\t}\n\tvoid exp(int *a, int n)\n\t{\n\t\tint z, d;\n\t\tz = lim = 2, d = bit = 1;\n\t\tmemset(K, 0, sizeof K);\n\t\tK[0] = 1;\n\t\twhile(z <= (n<<1))\n\t\t{\n\t\t\tz <<= 1, d++;\n\t\t\tfor(re int i = 0; i < (z>>1); ++i) \n\t\t\t\tT[i] = K[i];\n\t\t\tln(T, (z>>1) - 1);\n\t\t\tfor(re int i = 0; i < (z>>1); ++i)\n\t\t\t\tT[i] = add(a[i] + (i == 0), P - T[i]);\n\t\t\tlim = z, bit = d;\n\t\t\tcalrev();\n\t\t\tmul(K, T);\n\t\t\tfor(re int i = z; i <= (z<<1); ++i)\n\t\t\t\tK[i] = T[i] = 0;\n\t\t}\n\t\tfor(re int i = 0; i <= n; ++i)\n\t\t\ta[i] = K[i];\n\t}\n}\nusing namespace Polynomial;\nint n;\nint F[N];\nint main()\n{\n\tn = read();\n\tfor(re int i = 0; i < n; ++i)\n\t\tF[i] = read();\n\texp(F, n);\n\tfor(re int i = 0; i < n; ++i)\n\t\twrite(F[i], ' ');\n\treturn 0;\n}\n```\n",
        "postTime": 1558604489,
        "uid": 139340,
        "name": "Gauss0320",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4726 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u6307\u6570\u51fd\u6570\uff08\u591a\u9879\u5f0f exp\uff09"
    },
    {
        "content": "\u672c\u6587\u6536\u5f55\u4e8e\uff1a[\u591a\u9879\u5f0f\u7b97\u6cd5\u5b66\u4e60\u7b14\u8bb0](https://venusnero.github.io/2019/03/19/poly_algorithm_note/)\u3002\n\n\u795e\u4ed9\u65b9\u6cd5\u2026\u2026\u9700\u8981\u5148\u5b66\u6cf0\u52d2\u5c55\u5f00\uff0c\u7136\u540e\u501f\u52a9\u6cf0\u52d2\u5c55\u5f00\u5b66\u4f1a\u725b\u987f\u8fed\u4ee3\uff0c\u7136\u540e\u624d\u80fd\u505a\u2026\u2026\n\n\uff08Orz \u9694\u58c1\u7684 bzt\uff09\n\n\u6cf0\u52d2\u5c55\u5f00\u5c31\u4e0d\u8bb2\u4e86\uff0c\u725b\u987f\u8fed\u4ee3\u53ef\u4ee5\u89c1[\u8fd9\u91cc](http://blog.miskcoo.com/2015/06/polynomial-with-newton-method)\uff0c\u53cd\u6b63\u6700\u540e\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$F(z)\\equiv F_0(z)-{G(F_0(z))\\over G'(F_0(z))}\\ (\\text{mod}\\ \\ z^n)$$\n\n\u6240\u4ee5\u6211\u4eec\u8003\u8651\u6c42 $G(x)$ \u4f7f $G(x)=e^{F(x)}$\uff0c\u76f4\u63a5\u6c42\u663e\u7136\u662f\u4e0d\u73b0\u5b9e\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u56e0\u4e3a\u521a\u521a\u5b66\u4e86\u5bf9\u6570\u51fd\u6570\uff0c\u800c\u5bf9\u6570\u548c\u6307\u6570\u662f\u9006\u8fd0\u7b97\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u628a\u5b83\u8f6c\u5316\u6210\u6307\u6570\uff1a\n\n$$\\ln G(x)-F(x)=0$$\n\n\u51fa\u73b0\u4e86 $0$\uff0c\u90a3\u4e48\u6211\u4eec\u521a\u521a\u5b66\u725b\u987f\u8fed\u4ee3\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u7528\u5b83\u6765\u6c42\u96f6\u70b9\uff0c\u4ee4 $f(G(x))=\\ln G(x)-F(x)$\uff0c\u73c2\u4ee5\u628a $F(x)$ \u770b\u6210\u5e38\u6570\u9879\uff0c\u6240\u4ee5\u6c42\u5bfc\u51fa\u6765\u662f\uff1a$f'(G(x))={1\\over G(x)}$\uff0c\u628a\u8fd9\u4e24\u4e2a\u4ee3\u8fdb\u725b\u987f\u8fed\u4ee3\u7684\u5f0f\u5b50\uff0c\u73c2\u4ee5\u5f97\u5230\uff1a\n\n$$G(x)\\equiv G_0(x)-{\\ln G_0(x)-F(x) \\over {1\\over G_0(x)}} \\ (\\text{mod}\\ \\ x^n)$$\n\n$$G(x)\\equiv G_0(x)-(\\ln G_0(x)-F(x) )\\times G_0(x) \\ (\\text{mod}\\ \\ x^n)$$\n\n$$G(x)\\equiv G_0(x)(1-\\ln G_0(x)+F(x)) \\ (\\text{mod}\\ \\ x^n)$$\n\n\u4f9d\u7136\u9012\u5f52\u6c42\u89e3\u5373\u53ef\u3002\n\n\uff08\u6c42 $\\ln$ \u7684\u65f6\u5019\u8bb0\u5f97\u6e05\u7a7a a \u6570\u7ec4\u2026\u2026\uff09\n\n```cpp\nvoid GetExp(int *f,int *g,int len)\n{\n    if(len==1)\n    {\n        g[0]=1;\n        return;\n    }\n    GetExp(f,g,len+1>>1);\n    lim=1;\n    m=0;\n    while(lim<(len<<1))\n    {\n        lim<<=1;\n        m++;\n    }\n    for(int i=1;i<lim;i++) rev[i]=(rev[i>>1]>>1)|((i&1)<<(m-1));\n    for(int i=0;i<(len<<1);i++) d[i]=e[i]=0;\n    GetLn(g,d,len);\n    for(int i=0;i<len;i++) e[i]=f[i];\n    NTT(g,1);\n    NTT(d,1);\n    NTT(e,1);\n    for(int i=0;i<lim;i++) g[i]=(1ll-d[i]+e[i]+Mod)*g[i]%Mod;\n    NTT(g,-1);\n    for(int i=len;i<lim;i++) g[i]=0;\n}\n```",
        "postTime": 1553087357,
        "uid": 23243,
        "name": "VenusM1nT",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4726 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u6307\u6570\u51fd\u6570\u3011"
    },
    {
        "content": "## P4726 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u6307\u6570\u51fd\u6570\uff08\u591a\u9879\u5f0f exp\uff09\n### \u9898\u610f\n\u7ed9\u51fa $n-1$ \u6b21\u591a\u9879\u5f0f $A(z)$\uff0c\u6c42\u4e00\u4e2a $\\bmod{\\:z^n}$ \u4e0b\u7684\u591a\u9879\u5f0f $B(z)$\uff0c\u6ee1\u8db3 $B(z) \\equiv \\text e^{A(z)}$\u3002\u7cfb\u6570\u5bf9 $998244353$ \u53d6\u6a21\u3002($1\\le n\\le 10^5$)\n### \u9898\u89e3\n\u770b\u5230\u9898\u89e3\u533a\u4e00\u6c34\u7684\u725b\u987f\u8fed\u4ee3\u6c42 $\\exp$\uff0c\u552f\u4e00\u7684\u534a\u5728\u7ebf\u5377\u79ef\u6c42\u6cd5\u7684 $\\LaTeX$ \u8fd8\u6302\u4e86\uff0c\u6240\u4ee5\u6765\u6c34\u4e00\u7bc7\u534a\u5728\u7ebf\u5377\u79ef\u6c42 $\\exp$ \u7684\u89e3\u6cd5\u3002\uff08ps. \u4e2a\u4eba\u89c9\u5f97\u53ea\u8981\u9898\u4e0a\u4e0d\u7528\u6c42 $\\ln$\uff0c\u6ca1\u5fc5\u8981\u8d39\u52b2\u5199\u90a3\u7801\u91cf\u5de8\u5927\u7684\u725b\u987f\u8fed\u4ee3 $\\exp$\uff0c\u4e0d\u5982\u5199\u7801\u91cf\u5c0f\u5e38\u6570\u5c0f\u7684\u534a\u5728\u7ebf\u5377\u79ef\uff09\n\n\u9996\u5148 $B(z)$ \u5b58\u5728\uff0c\u5f53\u4e14\u4ec5\u5f53 $[z^0]A(z)=0$\uff0c\u5426\u5219 $B(z)$ \u5e38\u6570\u9879\u4e0d\u6536\u655b\u3002\u63a5\u4e0b\u6765\u7531\u4e8e $\\exp$ \u5e76\u4e0d\u597d\u5904\u7406\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u6c42\u5bfc\uff1a\n$$B'(z)=\\mathrm{e}^{A(z)}A'(z)$$\n\u5373\n$$B'(z)=B(z)A'(z)$$\n\u4e24\u8fb9\u540c\u65f6\u79ef\u5206\u53ef\u4ee5\u5f97\u5230\uff1a\n$$B(z)=\\int B(z)A'(z)$$\n\u5373\uff1a\n$$[z^n]B(z)=[z^n]\\int B(z)A'(z)=\\dfrac{1}{n}[z^{n-1}]B(z)A'(z)$$\n\u73b0\u5728\u8fd9\u4e2a\u5f62\u5f0f\u5c31\u53ef\u4ee5\u7528\u534a\u5728\u7ebf\u5377\u79ef\u6c42\u89e3\u4e86\u3002\u9996\u5148\u7ed9 $A(z)$ \u6c42\u4e2a\u5bfc\uff0c\u8bbe\u8fd9\u4e2a\u7cfb\u6570\u4e3a $g_i$\uff0c$B(z)$ \u7684\u7cfb\u6570\u4e3a $f_i$\uff0c\u5219\u6211\u4eec\u7684\u5f0f\u5b50\u4e3a\uff1a\n$$f_n=\\dfrac{1}{n}\\sum_{i=0}^{n-1}f_ig_{n-1-i}$$\n\u7136\u540e\u5229\u7528\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u5de6\u534a\u8fb9\u5bf9\u53f3\u534a\u8fb9\u505a\u8d21\u732e\uff0c\u5916\u5c42\u7684\u5e38\u6570\u53ef\u4ee5\u5728\u5206\u6cbb\u8fb9\u4e58\u4e0a\uff1a\n$$f_{l..mid}\\times g_{0..r-l}\\rightarrow f_{mid,r}$$\n\u6ce8\u610f\u505a\u8d21\u732e\u7684\u65f6\u5019\u8981\u5e73\u79fb\u3002\u522b\u7684\u5c31\u662f\u677f\u5b50\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n\\log ^2n)$\uff0c\u771f\u7684\u5f88\u597d\u5199\u3002\n```cpp\n#include <cstdio>\n#include <algorithm>\nconst int N = 1e6 + 10, mod = 998244353; typedef long long ll;\ninline int ksm(int a, int b)\n{\n    int ret = 1;\n    while (b)\n    {\n        if (b & 1) ret = (ll)ret * a % mod;\n        a = (ll)a * a % mod; b >>= 1;\n    }\n    return ret;\n}\nint F[N], G[N], A[N], B[N], rev[N], lim, m, n;\ninline void init(int n)\n{\n    lim = 1; m = 0; while (lim <= n) lim <<= 1, ++m;\n    for (int i = 0; i < lim; ++i) rev[i] = (rev[i >> 1] >> 1) | ((i & 1) << (m - 1));\n}\ninline void NTT(int* f, int len, int on)\n{\n    for (int i = 0; i < len; ++i) if (i < rev[i]) std::swap(f[i], f[rev[i]]);\n    for (int h = 2; h <= len; h <<= 1)\n    {\n        int gn = ksm(3, (ll)(mod - 1) / h * on % (mod - 1));\n        for (int j = 0; j < len; j += h)\n            for (int k = j, g = 1; k < j + h / 2; ++k, g = (ll)g * gn % mod)\n            {\n                int u = f[k], t = (ll)g * f[k + h / 2] % mod;\n                f[k] = (u + t) % mod; f[k + h / 2] = ((u - t) % mod + mod) % mod;\n            }\n    }\n    if (on == mod - 2) for (int i = 0, inv = ksm(len, on); i < len; ++i) f[i] = (ll)f[i] * inv % mod;\n}\nvoid cdq(int l, int r)\n{\n    if (l + 1 == r) return F[l] = l ? (ll)F[l] * ksm(l, mod - 2) % mod : 1, void();\n    int mid = (l + r) >> 1; cdq(l, mid); init(r - l);\n    for (int i = 0; i < mid - l; ++i) A[i] = F[i + l];\n    for (int i = 0; i < r - l - 1; ++i) B[i] = G[i];\n    for (int i = mid - l; i < lim; ++i) A[i] = 0;\n    for (int i = r - l; i < lim; ++i) B[i] = 0;\n    NTT(A, lim, 1); NTT(B, lim, 1);\n    for (int i = 0; i < lim; ++i) A[i] = (ll)A[i] * B[i] % mod;\n    NTT(A, lim, mod - 2);\n    for (int i = mid - l - 1; i < r - l - 1; ++i) (F[i + l + 1] += A[i]) %= mod;\n    cdq(mid, r);\n}\nint main()\n{\n    scanf(\"%d\", &n);\n    for (int i = 0; i < n; ++i) scanf(\"%d\", &G[i]);\n    for (int i = 1; i < n; ++i) G[i - 1] = (ll)i * G[i] % mod;\n    G[n - 1] = 0;\n    cdq(0, n); for (int i = 0; i < n; ++i) printf(\"%d \", F[i]); \n    puts(\"\"); return 0;\n}\n```",
        "postTime": 1645750808,
        "uid": 137603,
        "name": "zhiyangfan",
        "ccfLevel": 9,
        "title": "P4726 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u6307\u6570\u51fd\u6570\uff08\u591a\u9879\u5f0f exp\uff09\u9898\u89e3"
    },
    {
        "content": "\u6211\u95f2\u7684\u6ca1\u4e8b\u5199\u4e86\u4e00\u53d1\u4efb\u610f\u6a21\u6570 exp\uff0c\uff0c\uff0c\n\n\u5e38\u6570\u6781\u5927\u5c31\u662f\u4e86\u3002\u9700\u8981\u7528 myy \u8bba\u6587\u91cc\u9762\u7684 $4$ \u6b21 FFT \u9ed1\u79d1\u6280\u624d\u80fd\u52c9\u5f3a\u5361\u65f6\u9650 AC\u3002\n\n\u5047\u5982\u4e0d\u4f1a\uff0c\u63a8\u8350\u53bb\u4efb\u610f\u6a21\u6570 NTT \u9898\u89e3\u53bb\u5b66\u4e60\u3002\u591a\u9879\u5f0f exp \u7684\u8fc7\u7a0b\u8bf7\u53bb\u5176\u4ed6\u9898\u89e3\u5b66\u4e60\u3002\n\n<https://www.luogu.com.cn/problem/T128649> \u8fd9\u91cc\u6709\u4e00\u9053\u6a21\u677f\u9898\uff08\u7a9d\u771f\u7684\u662f\u592a\u95f2\u4e86\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<vector>\n#include<complex>\nusing namespace std;\ntypedef complex<double> comp;\ntypedef long long ll;\nconst int B=32768;\nint n,tr[550005],mod,f[550005]={1},g[550005],miu[550005],prime[550005],vst[550005];\ncomp wk[550005],a0[550005],a1[550005],b0[550005],b1[550005],p[550005],q[550005];\nint Power(int x,int y,int mod) {\n\tint ret=1;\n\twhile(y) {\n\t\tif(y&1)ret=1ll*ret*x%mod;\n\t\tx=1ll*x*x%mod,y>>=1;\n\t}\n\treturn ret;\n}\nvoid GetTr(int l) {\n\tfor(int i=0; i<l; i++)tr[i]=(tr[i>>1]>>1)|((i&1)?(l>>1):0);\n}\nvoid FFT(comp a[],int n,int flag){\n\tfor(int i=0;i<n;i++)if(tr[i]<i)swap(a[i],a[tr[i]]);\n\tfor(int i=1;i<n;i<<=1){\n\t\tfor(int j=0;j<n;j+=(i<<1)){\n\t\t\tfor(int k=0;k<i;k++){\n\t\t\t\tcomp t;\n\t\t\t\tif(flag==1)t=a[i+j+k]*wk[262144/i*k];\n\t\t\t\telse t=a[i+j+k]/wk[262144/i*k];\n\t\t\t\ta[i+j+k]=a[j+k]-t,a[j+k]+=t;\n\t\t\t}\n\t\t}\n\t}\n\tif(flag==-1)for(int i=0;i<n;i++)a[i]/=n;\n}\nconst comp I=comp(0,1);\nvoid Mul(int a[],int b[],int l){\n\tfor(int i=0;i<l;i++)a0[i]=comp(a[i]/B,a[i]%B),b0[i]=comp(b[i]/B,b[i]%B);\n\tFFT(a0,l,1);\n\tfor(int i=0;i<l;i++)a1[i]=conj(a0[i?l-i:0]);\n\tfor(int i=0;i<l;i++){\n\t\tcomp p=a0[i],q=a1[i];\n\t\ta0[i]=(p+q)/2.0,a1[i]=I*(q-p)/2.0;\n\t}\n\tFFT(b0,l,1);\n\tfor(int i=0;i<l;i++)b1[i]=conj(b0[i?l-i:0]);\n\tfor(int i=0;i<l;i++){\n\t\tcomp p=b0[i],q=b1[i];\n\t\tb0[i]=(p+q)/2.0,b1[i]=I*(q-p)/2.0;\n\t}\n\tfor(int i=0;i<l;i++)p[i]=a0[i]*b0[i]+I*a1[i]*b0[i],q[i]=a0[i]*b1[i]+I*a1[i]*b1[i];\n\tFFT(p,l,-1),FFT(q,l,-1);\n\tfor(int i=0;i<l;i++){\n\t\tll a1b1=(ll)(p[i].real()+0.5),a3b3=(ll)(p[i].imag()+q[i].real()+0.5),a2b2=(ll)(q[i].imag()+0.5);\n\t\ta[i]=(a1b1%mod*B%mod*B+a3b3%mod*B+a2b2)%mod;\n\t}\n}\nvoid Calcinv(int a[],int b[],int l){\n\tif(l==1){\n\t\tb[0]=Power(a[0],mod-2,mod);\n\t\treturn ;\n\t}\n\tCalcinv(a,b,(l+1)/2);\n\tint len=1;\n\twhile(len<l*2)len<<=1;\n\tGetTr(len);\n\tstatic int tmp[550005]={0};\n\tmemcpy(tmp,a,sizeof(int)*l);\n\tfor(int i=l;i<len;i++)tmp[i]=0;\n\tMul(tmp,b,len);\n\tMul(tmp,b,len);\n\tfor(int i=0;i<l;i++)b[i]=(2ll*b[i]-tmp[i]+mod)%mod;\n}\nvoid Calcln(int a[],int b[],int l){\n\tstatic int tmp[550005]={0};\n\tmemcpy(tmp,a,sizeof(int)*l);\n\tfor(int i=1;i<l;i++)tmp[i-1]=1ll*tmp[i]*i%mod;\n\ttmp[l-1]=0;\n\tCalcinv(a,b,l);\n\tint len=1;\n\twhile(len<l*2)len<<=1;\n\tGetTr(len);\n\tfor(int i=l;i<len;i++)tmp[i]=0;\n\tMul(b,tmp,len);\n\tfor(int i=l;i<len;i++)b[i]=0;\n\tfor(int i=l-1;i>0;i--)b[i]=1ll*b[i-1]*Power(i,mod-2,mod)%mod;\n\tb[0]=0;\n}\nvoid Calcexp(int a[],int b[],int l){\n\tif(l==1){\n\t\tb[0]=1;\n\t\treturn ;\n\t}\n\tstatic int tmp[400005]={0},ln[400005]={0};\n\tCalcexp(a,b,(l+1)/2);\n\tCalcln(b,ln,l);\n\tmemcpy(tmp,a,sizeof(int)*l);\n\tint len=1;\n\twhile(len<=l*1.5)len<<=1;\n\tGetTr(len);\n\ttmp[0]=(1-ln[0]+tmp[0]+mod)%mod;\n\tfor(int i=1;i<len;i++)tmp[i]=(tmp[i]-ln[i]+mod)%mod;\n\tMul(b,tmp,len);\n\tfill(b+l,b+len,0);\n\tfill(tmp,tmp+len,0);\n\tfill(ln,ln+len,0);\n}\nint main() {\n\tdouble pi=acos(-1);\n\tfor(int i=1;i<262144;i++)wk[i]=exp(comp(0,pi/262144*i));\n\tscanf(\"%d\",&n),wk[0]=1,mod=998244353;\n\tfor(int i=0;i<n;i++)scanf(\"%d\",&f[i]);\n\tCalcexp(f,g,n);\n\tfor(int i=0;i<n;i++)printf(\"%d \",g[i]);\n}\n```",
        "postTime": 1586174996,
        "uid": 41171,
        "name": "gayh20",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4726 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u6307\u6570\u51fd\u6570\uff08\u591a\u9879\u5f0f exp\uff09\u3011"
    },
    {
        "content": "# \u524d\u8a00\n\n\u5173\u4e8e\u600e\u4e48\u5b9e\u73b0\u697c\u4e0a\u7684\u5927\u4f6c\u4eec\u5df2\u7ecf\u8bb2\u5f97\u5f88\u6e05\u695a\u4e86 \u53ea\u662f\u84bb\u7b14\u8005\u5728\u5b66\u4e60\u65f6\u9047\u5230\u4e86\u8bb8\u591a\u56f0\u60d1\n\n\u4e00\u4e2a\u6700\u4e3b\u8981\u7684\u95ee\u9898\uff1a\u63a8\u5230 $F(x)=F_0(x)-\\dfrac{G(F(x))}{G'(F(x))}$ \u65f6 \u8fd9\u4e2a $G'(F(x))$ \u662f\u4ec0\u4e48 \n\n\u5177\u4f53\u5230 exp \u7684\u5b9e\u73b0\u4e0a\u4e3a\u4ec0\u4e48 $G(B(x))=\\ln B(x)-A(x)$ \u5bf9 $G$ \u6c42\u5bfc\u4e4b\u540e\u6ca1\u6709 $A(x)$ \u4e86\uff1f\uff1f\n\n\u8fd9\u4e2a\u95ee\u9898\u5df2\u6709\u7684\u9898\u89e3\u533a\u5e76\u6ca1\u6709\u5f88\u597d\u7684\u89e3\u7b54 \u5e76\u4e14\u6e05\u6708\u5927\u4f6c\u7684\u9898\u89e3\u4f3c\u4e4e\u662f\u6709\u4e00\u4e9b\u7406\u89e3\u4e0a\u7684\u9519\u8bef\u7684\uff08\u4e0d\u662f\u4e00\u4e2a\u590d\u5408\u51fd\u6570 \u5426\u5219\u4e0d\u4f1a\u6c42\u5bfc\u4e4b\u540e\u6ca1\u6709$A(x)$ \uff09 \n\n\u5bf9\u7b14\u8005\u9020\u6210\u4e86\u4e00\u4e9b\u7406\u89e3\u4e0a\u7684\u8bef\u5bfc \u770b\u5230\u8fd9\u7bc7 [\u535a\u5ba2](https://blog.csdn.net/qq_35950004/article/details/106469316) \u7684\u7b2c\u4e00\u90e8\u5206 \u624d\u8c41\u7136\u5f00\u6717 \n\n\u672c\u6587\u5c06\u5bf9\u4ee5\u4e0a\u95ee\u9898\u505a\u4ee5\u7b14\u8005\u7406\u89e3\u7684\u89e3\u7b54 \u5f53\u7136\u672c\u6587\u4e5f\u4f1a\u5b8c\u6574\u4ecb\u7ecd\u591a\u9879\u5f0f\u725b\u987f\u8fed\u4ee3\u548cexp\u7684\u7406\u89e3\u4e0e\u5b9e\u73b0\n\n# \u6570\u57df\n\n\u9996\u5148\u660e\u786e\u4e00\u70b9 \u6211\u4eec\u8ba8\u8bba\u7684**\u6570\u57df** \u8fd9\u4e5f\u662f\u6700\u8ff7\u60d1\u7684\u90e8\u5206\n\n\u6211\u4eec\u662f\u7ed9\u5b9a\u4e00\u4e2a\u5b9a\u591a\u9879\u5f0f \u6c42\u51fa\u4e00\u4e2a\u65b0\u7684\u591a\u9879\u5f0f\n\n\u5f62\u5f0f\u5316\u5730 \u8bbe $S$ \u4e3a\u591a\u9879\u5f0f\u6570\u57df \u5219\u6211\u4eec\u9700\u8981\u5b8c\u6210\u7684\u662f $G:S\\rightarrow S$\n\n\u5373**\u6211\u4eec\u7684\u53d8\u91cf\u662f\u4e00\u4e2a\u591a\u9879\u5f0f \u6240\u6709\u786e\u5b9a\u7684\u591a\u9879\u5f0f\u90fd\u662f\u5e38\u6570**\n\n$x$ \u548c $x^2+x^3+x^4$ \u90fd\u662f\u5e38\u6570\n\n# \u591a\u9879\u5f0f\u725b\u987f\u8fed\u4ee3\n\n\u8003\u8651\u6b63\u5e38\u7684\u725b\u987f\u8fed\u4ee3 \u662f\u4e00\u79cd\u53ef\u4ee5\u5feb\u901f\u6c42\u51fa\u4f7f $f(a)=0$ \u6ee1\u8db3\u7684 $a$ \u7684\u65b9\u6cd5 \n\n\u6211\u4eec\u8fc1\u79fb\u5230\u591a\u9879\u5f0f\u57df\u4e0b \u8bbe $X$ \u4e3a\u591a\u9879\u5f0f\u53d8\u91cf \n\n\u6ce8\u610f\uff1a**$X$ \u662f\u4e00\u4e2a\u591a\u9879\u5f0f** \u4e3a\u4e86\u907f\u514d\u6df7\u6dc6 \u4e0d\u5199\u6210 $f(x)$ \u7684\u5f62\u5f0f\n\n$G(X)\\equiv0\\pmod {x^n}$\n\n\u8bbe $m=\\lceil \\dfrac{n}{2}\\rceil$\n\n\u7531\u4e8e\u725b\u987f\u8fed\u4ee3\u662f\u901a\u8fc7\u9012\u5f52\u500d\u589e\u5b9e\u73b0 \u5047\u8bbe\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u6c42\u5f97\u4e86$X_0$ \u4f7f\u5f97$G(X_0)\\equiv0\\pmod{x^m}$\n\n\u6ce8\u610f \u73b0\u5728 $X_0$ \u5df2\u7ecf\u4e3a\u786e\u5b9a\u7684\u591a\u9879\u5f0f\n\n\u6211\u4eec\u5728\u591a\u9879\u5f0f\u57df\u4e0b\u505a\u6cf0\u52d2\u5c55\u5f00\n\n$G(X)=\\sum_{i=0}^{+\\infty}\\dfrac{G^{(i)}(X_0)}{i!}(X-X_0)^i$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u80fd\u5f15\u53d1\u4ee5\u4e0b\u7591\u95ee\uff1a\n\n**\u4e00\u4e2a $S\\rightarrow S$ \u7684\u51fd\u6570\u7684\u5bfc\u51fd\u6570\u662f\u4ec0\u4e48\u4e1c\u897f\uff1f\u8be5\u600e\u4e48\u6c42\uff1f**\n\n\u7531\u4e8e\u6c42\u5bfc\u516c\u5f0f\u662f\u53ef\u4ee5\u9488\u5bf9\u4efb\u610f\u57df\u7684 \u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u6309\u7167\u6c42\u5bfc\u7684\u516c\u5f0f\u548c\u8fd0\u7b97\u6cd5\u5219\u76f4\u63a5\u6c42\n\n\u800c\u4e00\u4e2a $S\\rightarrow S$ \u7684\u51fd\u6570\u7684\u5bfc\u51fd\u6570\u8fd8\u662f $S\\rightarrow S$ \u7684 \n\n\u653e\u5728\u6a21 $x^n$ \u610f\u4e49\u4e0b \n\n$G(X)=G(X_0)+G'(X_0)(X-X_0)\\equiv0\\pmod {x^n}$\n\n\u518d\u660e\u786e\u4e00\u4e0b\u8fd9\u91cc\u7684\u53d6\u6a21 \u4e00\u4e2a\u76f4\u63a5\u7684\u610f\u601d\u5c31\u662f\u4fdd\u7559\u591a\u9879\u5f0f\u7684\u524d\u591a\u5c11\u4f4d \u5269\u4e0b\u7684\u4e0d\u8981\u4e86\n\n\u800c\u4e3a\u4ec0\u4e48\u8981\u53d6\u8fd9\u4e2a\u6a21\u5462\uff1f\u6bd4\u5982 $\\ln X$ \u4e00\u4e2a\u591a\u9879\u5f0f\u7684\u5bf9\u6570 \u5f88\u62bd\u8c61 \u5b9e\u9645\u7684\u542b\u4e49\u5f88\u96be\u53bb\u53d9\u8ff0 \u4f46\u4e3b\u8981\u5e94\u7528\u4e0a\u57fa\u672c\u4e0a\u90fd\u662f $\\ln$ \u8fc7\u53bb $\\exp$ \u56de\u6765 \u8d77\u5230\u4e00\u4e2a\u52a0\u901f\u7684\u4f5c\u7528\n\n\u800c\u9700\u8981\u8fd9\u4e2a\u8fc7\u7a0b\u4e4b\u540e\u6211\u4eec\u7684\u591a\u9879\u5f0f\u8fd8\u662f\u5bf9\u7684 \u81f3\u5c11\u662f\u6211\u4eec\u9700\u8981\u7684\u90a3\u4e9b\u90e8\u5206\u662f\u5bf9\u7684 \u6240\u4ee5\u9700\u8981\u8fdb\u884c\u53d6\u6a21 \u53ea\u4fdd\u7559\u8fd1\u4f3c\u7684\u591a\u9879\u5f0f\u7684\u524d\u4e00\u4e9b\u9879 \n\n\u597d \u6211\u4eec\u7ee7\u7eed\u63a8\u901d\u5b50\n\n$X\\equiv X_0-\\dfrac{G(X_0)}{G'(X_0)}\\pmod{x^n}$\n\n\u9012\u63a8\u7684\u5f0f\u5b50\u6709\u4e86 \u8003\u8651\u8fb9\u754c\n\n\u6211\u4eec\u9700\u8981\u5355\u72ec\u6c42\u51fa $G(X)\\equiv0\\pmod{x}$ \u7684\u89e3 \u53ea\u8981\u7ed9\u5b9a $G$ \u6216\u901a\u8fc7\u8f6c\u5316 \u6211\u4eec\u6613\u4e8e\u5f97\u51fa\u8fd9\u4e00\u89e3\n\n\u603b\u7ed3\uff1a\n\n\u591a\u9879\u5f0f\u725b\u987f\u8fed\u4ee3\u7684\u9002\u7528\u6761\u4ef6\n\n1. \u5bf9\u4e8e\u786e\u5b9a\u591a\u9879\u5f0f $P$ \u9700\u8981\u6709 $\\dfrac{G(P)}{G'(P)}$ \u5316\u7b80\u540e\u6613\u4e8e\u6c42\u89e3\u6216\u8005 $G(P)$ \u548c $G'(P)$ \u90fd\u6613\u4e8e\u6c42\u89e3\n\n2. $G(X)\\equiv0\\pmod{x}$ \u7684\u89e3 $X_c$\uff08\u4e00\u4e2a0\u6b21\u591a\u9879\u5f0f\uff09 \u6613\u4e8e\u6c42\u89e3\n\n# \u591a\u9879\u5f0f exp\n\n _\u8fd9\u90e8\u5206\u8bb2\u7684\u6bd4\u8f83\u7b80\u7565 \u56e0\u4e3a\u8fd9\u90e8\u5206\u5176\u4ed6\u9898\u89e3\u5df2\u7ecf\u8bb2\u5f97\u5f88\u6e05\u695a\u4e86_ \n\n\u4ee5 $\\exp$ \u4e3a\u4f8b \u7ed9\u5b9a $A(x)$\n\n\u6c42 $B(x)$ \u4f7f\u5f97 $B(x)\\equiv e^{A(x)}\\pmod{x^n}$\n\n\u82e5\u4ee4 $G(X)=X-e^A$ \u5219\u4e0d\u6ee1\u8db3\u4f7f\u7528\u6761\u4ef6 1\n\n\u8003\u8651\u53d6\u5bf9\u6570\n\n$\\ln B(x)\\equiv A(x)\\pmod{x^n}$\n\n\u4ee4 $G(X)=\\ln X-A$ \n\n\u7531\u4e8e $B=e^A$ \u6240\u4ee5\u591a\u9879\u5f0f\u5e38\u6570\u9879\u53ea\u80fd\u662f $1 $ \n\n\u6545 $X_c=1$ \n\n\u9012\u63a8\u5f0f $X=X_0-\\dfrac{G(X_0)}{G'(X_0)}=X_0-\\dfrac{\\ln X_0-A}{\\frac{1}{X_0}}=X_0(A+1-\\ln X_0)$\n\n\u7136\u540e\u5c31\u53ef\u505a\u4e86 \u5316\u6210\u5e38\u89c1\u7684\u591a\u9879\u5f0f\u5f62\u5f0f\u5373\u662f $B(x)=B_0(x)(A(x)-\\ln B_0(x)+1)\\pmod{x^n}$\n\n\u6211\u5199\u7684\u4ee3\u7801\u5e38\u6570\u4e0d\u592a\u597d \u6bd4\u8f83\u61d2 \u5199\u7684\u8fed\u4ee3\u7248\u672c\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ninline int read(){int x=0;char c=getchar();while(c<'0'||c>'9')c=getchar();while(c<='9'&&c>='0')x=(x<<1)+(x<<3)+(c^48),c=getchar();return x;}\n#define mod 998244353\n#define g 3\n#define ig 332748118\n#define ll long long\ninline int add(int x,int y){int res=x+y;return res<mod?res:res-mod;}\ninline int mul(int x,int y){return (ll)x*y%mod;}\ninline int qpow(int a,int b){int res=1;while(b){if(b&1)res=mul(res,a);a=mul(a,a),b>>=1;}return res;}\nconst int N=1e5+3;\nstruct poly\n{\n\tint lth,f[N<<2];\n\tinline void init(int x){lth=ceil(log2(x));lth=1<<lth;}\n\tinline void clear(){memset(f,0,sizeof(f));}\n\tinline void fft(int len,bool tp)\n\t{\n\t\tif(!len)len=lth;\n\t\tfor(int i=0,j=0;i<len;i++){if(i<j)swap(f[i],f[j]);for(int x=len>>1;(j^=x)<x;x>>=1);}\n\t\tfor(int l=2;l<=len;l<<=1)\n\t\t{\n\t\t\tint wn=qpow(tp?ig:g,(mod-1)/l),d=l>>1;\n\t\t\tfor(int k=0;k<len;k+=l)\n\t\t\tfor(int i=0,w=1;i<d;i++,w=mul(w,wn))\n\t\t\t{\n\t\t\t\tint x=f[i+k],y=mul(f[i+k+d],w);\n\t\t\t\tf[i+k]=add(x,y),f[i+k+d]=add(x,mod-y);\n\t\t\t}\n\t\t}\n\t\tif(tp){int il=qpow(len,mod-2);for(int i=0;i<len;i++)f[i]=mul(f[i],il);}\n\t}\n}a,b,c,tmp,tmp1;\ninline void inv(const poly &a,poly &ia)\n{\n\tint lenall=a.lth;tmp1.clear();\n\tia.f[0]=qpow(a.f[0],mod-2);\n\tfor(int l=2;l<=lenall;l<<=1)\n\t{\n\t\tint d=l<<1;\n\t\tfor(int i=0;i<l;i++)tmp1.f[i]=a.f[i];\n\t\tia.fft(d,0),tmp1.fft(d,0);\n\t\tfor(int i=0;i<d;i++)ia.f[i]=mul(ia.f[i],add(2,mod-mul(tmp1.f[i],ia.f[i])));\n\t\tia.fft(d,1);for(int i=l;i<d;i++)ia.f[i]=0;\n\t}\n}\ninline void ln(poly a,poly &b)\n{\n\tinv(a,b);\n\tfor(int i=1;i<a.lth;i++)a.f[i-1]=mul(a.f[i],i);\n\ta.f[a.lth-1]=0;a.lth=b.lth=a.lth<<1;\n\ta.fft(0,0),b.fft(0,0);\n\tfor(int i=0;i<a.lth;i++)b.f[i]=mul(b.f[i],a.f[i]);\n\tb.fft(0,1);b.lth=a.lth>>1;\n\tfor(int i=b.lth-1;~i;i--)b.f[i]=mul(b.f[i-1],qpow(i,mod-2));\n\tb.f[0]=0;for(int i=b.lth;i<a.lth;i++)b.f[i]=0;\n}\ninline void exp(const poly &a,poly &b)\n{\n\tint lenall=a.lth;\n\tb.f[0]=1;tmp.clear();\n\tfor(int l=2;l<=lenall;l<<=1)\n\t{\n\t\tint d=l<<1;b.lth=l;c.clear(),ln(b,c);\n\t\tfor(int i=0;i<l;i++)tmp.f[i]=a.f[i];\n\t\tb.fft(d,0),c.fft(d,0),tmp.fft(d,0);\n\t\tfor(int i=0;i<d;i++)b.f[i]=mul(b.f[i],add(tmp.f[i],add(1,mod-c.f[i])));\n\t\tb.fft(d,1);for(int i=l;i<d;i++)b.f[i]=0;\n\t}\n}\nsigned main()\n{\n\tint n=read();\n\tfor(int i=0;i<n;i++)a.f[i]=read();\n\ta.init(n);exp(a,b);\n\tfor(int i=0;i<n;i++)printf(\"%d \",b.f[i]);\n\treturn 0;\n}\n```\n",
        "postTime": 1652786465,
        "uid": 223560,
        "name": "_HL_",
        "ccfLevel": 0,
        "title": "\u591a\u9879\u5f0f\u725b\u987f\u8fed\u4ee3+\u591a\u9879\u5f0fexp"
    },
    {
        "content": "[\u53ef\u80fd\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.luogu.com.cn/blog/happydef-blog/duo-xiang-shi-quan-jia-tong-xue-xi-bi-ji)\n\n\u524d\u7f6e\u829d\u58eb\uff1a\u591a\u9879\u5f0f\u6c42\u9006\uff0c\u591a\u9879\u5f0f$\\ln$\uff0c\u6cf0\u52d2\u5c55\u5f00\u3002\n\n\u9996\u5148\u6211\u4eec\u6765\u4e86\u89e3\u4e00\u4e0b\u591a\u9879\u5f0f\u725b\u987f\u8fed\u4ee3\uff1a\n\n\u82e5\n$$G(F(x))\\equiv 0\\pmod {x^n}$$\n$$G(F_0(x))\\equiv 0\\pmod {x^{\\lceil\\frac{n}{2}\\rceil}}$$\n\u5219\u6839\u636e\u6cf0\u52d2\u5c55\u5f00\uff1a\n$$G(F)=G(F_0)+G'(F_0)(F-F_0)+G''(F_0)(F-F_0)^2+\\cdots$$\n\u56e0\u4e3a\n$$F\\equiv F_0 \\pmod {x^{\\lceil\\frac{n}{2}\\rceil}}$$\n\u6240\u4ee5\n$$F^2\\equiv F_0^2\\pmod {x^n}$$\n\u6240\u4ee5\n$$0\\equiv G(F)\\equiv G(F_0)+G'(F_0)(F-F_0) \\pmod {x^n}$$\n$$F\\equiv F_0-\\frac{G(F_0)}{G'(F_0)}\\pmod{x^n}$$\n\u8fd9\u5c31\u662f\u725b\u987f\u8fed\u4ee3\u7684\u5f0f\u5b50\u5566\uff0c\u4e0b\u9762\u6211\u4eec\u6765\u7528\u8fd9\u4e2a\u5f0f\u5b50\u63a8\u4e00\u4e0b$\\exp$\u7684\u505a\u6cd5\n$$G(x)\\equiv e^{F(x)}\\pmod {x^n}$$\n$$\\ln G-F\\equiv 0 \\pmod {x^n}$$\n\u8bbe\n$$y=\\ln G-F$$\n\u5219\n$$dy=d(\\ln G-F)$$\n$$dy=\\frac{dG}{G}$$\n$$\\frac{dy}{dG}=\\frac{1}{G}$$\n\u8bbe\n$$\\ln G_0-F\\equiv 0 \\pmod {x^{\\lceil\\frac{n}{2}\\rceil}}$$\n\u5219\u6839\u636e\u725b\u987f\u8fed\u4ee3\u516c\u5f0f\uff1a\n$$G\\equiv G_0-\\frac{\\ln G_0-F}{\\frac{1}{G_0}}\\equiv G_0(1-\\ln G_0+F)\\pmod{x^n}$$\n\u4e8e\u662f\u9012\u5f52\u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6$T(n)=T(\\frac{n}{2})+O(n\\log n)$\uff0c\u6839\u636e\u4e3b\u5b9a\u7406\u53ef\u77e5$T(n)=O(n\\log n)$\u3002\n\n\u4e0d\u8fc7\u4f17\u6240\u5468\u77e5\u591a\u9879\u5f0f$\\exp$\u6781\u5176\u96be\u8c03\u56e0\u6b64\u8fd9\u91cc\u7ed9\u51fa\u4e86\u6211\u7684\u6838\u5fc3\u4ee3\u7801\u5b9e\u73b0\uff1a\uff08\u5e38\u6570\u5de8\u5927\uff0c\u52ff\u6284\uff09\n```cpp\nvoid getexp(ll*f,ll*g,ll len){\n   if(len==1){g[0]=1;return;}\n   getexp(f,g,len+1>>1);\n   init(len<<1);\n   for(ll i=0;i<(len<<1);i++)d[i]=e[i]=0;\n   getln(g,d,len);\n   for(ll i=0;i<len;i++)e[i]=f[i];\n   NTT(g,lmt,1),NTT(d,lmt,1),NTT(e,lmt,1);\n   for(ll i=0;i<lmt;i++)g[i]=(1-d[i]+e[i]+P)*g[i]%P;\n   NTT(g,lmt,-1);\n   for(ll i=len;i<lmt;i++)g[i]=0; \n   clear(d),clear(e);\n}\n```\n\u4e0b\u9762\u662f\u5b8c\u6574\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll; \nconst ll N=100005*3;\nll n,f[N],g[N];\nnamespace Poly{\n\tconst ll P=998244353,G=3;\n\tll lmt,rev[N],a[N],b[N],c[N],d[N],e[N];\n\tinline ll qpow(ll a,ll k){\n\t\tll ret=1;\n\t\twhile(k){\n\t\t\tif(k&1)ret=ret*a%P;\n\t\t\ta=(a*a)%P;\n\t\t\tk>>=1;\n\t\t}\n\t\treturn ret%P;\n\t}\n\tinline void init(ll n){\n\t\tlmt=1;ll t=0;\n\t\twhile(lmt<n)lmt<<=1,t++;\n\t\tfor(ll i=1;i<lmt;i++)rev[i]=(rev[i>>1]>>1)|(i&1)<<(t-1);\n\t}\n\tinline void NTT(ll *A,ll lmt,ll tp){\n\t\tfor(ll i=0;i<lmt;i++)if(i<rev[i])swap(A[i],A[rev[i]]);\n\t\tfor(ll m=1;m<lmt;m<<=1)\n\t\t\tfor(ll j=0,Wn=qpow(G,(P-1)/(m<<1));j<lmt;j+=m<<1)\n\t\t\t\tfor(ll k=0,w=1,x,y;k<m;k++,w=w*Wn%P)\n\t\t\t\t\tx=A[j+k],y=w*A[j+k+m]%P,A[j+k]=(x+y)%P,A[j+k+m]=(x-y+P)%P;\n\t\tif(tp==1)return;\n\t\treverse(A+1,A+lmt);\n\t\tfor(ll i=0,inv=qpow(lmt,P-2);i<=lmt;i++)A[i]=A[i]*inv%P;\n\t} \n\tinline void mul(ll *f,ll *g,ll len){\n\t\tinit(len);\n\t\tNTT(f,lmt,1);NTT(g,lmt,1);\n\t\tfor(ll i=0;i<lmt;i++)f[i]=(f[i]*g[i])%P;\n\t\tNTT(f,lmt,-1);\n\t} \n\tvoid getinv(ll*f,ll*g,ll len){\n\t\tif(len==1){g[0]=qpow(f[0],P-2);return;}\n\t\tgetinv(f,g,len+1>>1);\n\t\tinit(len<<1);\n\t\tfor(ll i=0;i<len;i++)c[i]=f[i];\n\t\tfor(ll i=len;i<lmt;i++)c[i]=0;\n\t\tNTT(c,lmt,1),NTT(g,lmt,1);\n\t\tfor(ll i=0;i<lmt;i++)g[i]=(2LL-g[i]*c[i]%P+P)%P*g[i]%P;\n\t\tNTT(g,lmt,-1);\n\t\tfor(ll i=len;i<lmt;i++)g[i]=0; \n\t}\n\tvoid getdev(ll*f,ll*g,ll len){\n\t\tfor(ll i=1;i<len;i++)g[i-1]=i*f[i]%P;\n\t\tg[len-1]=0;\n\t}\n\tvoid getinvdev(ll*f,ll*g,ll len){\n\t\tfor(ll i=1;i<len;i++)g[i]=f[i-1]*qpow(i,P-2)%P;\n\t\tg[0]=0;\n\t}\n\tvoid getln(ll*f,ll*g,ll len){\n\t\tmemset(a,0,sizeof(a));\n\t\tmemset(b,0,sizeof(b));\n\t\tgetdev(f,a,len);\n\t\tgetinv(f,b,len);\n\t\tmul(a,b,len<<1);\n\t\tgetinvdev(a,g,len);\n\t}\n\tvoid getexp(ll*f,ll*g,ll len){\n\t\tif(len==1){g[0]=1;return;}\n\t\tgetexp(f,g,len+1>>1);\n\t\tinit(len<<1);\n\t\tfor(ll i=0;i<(len<<1);i++)d[i]=e[i]=0;\n\t\tgetln(g,d,len);\n\t\tfor(ll i=0;i<len;i++)e[i]=f[i];\n\t    NTT(g,lmt,1),NTT(d,lmt,1),NTT(e,lmt,1);\n    \tfor(ll i=0;i<lmt;i++)g[i]=(1-d[i]+e[i]+P)*g[i]%P;\n    \tNTT(g,lmt,-1);\n    \tfor(ll i=len;i<lmt;i++)g[i]=0; \n\t}\n}\nusing Poly::getexp;\nint main(){\n\tscanf(\"%lld\",&n);\n\tfor(ll i=0;i<n;i++)scanf(\"%lld\",&f[i]);\n\tgetexp(f,g,n);\n\tfor(ll i=0;i<n;i++)printf(\"%lld \",g[i]);\n\treturn 0;\n}\n```",
        "postTime": 1594909798,
        "uid": 121027,
        "name": "Spasmodic",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4726 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u6307\u6570\u51fd\u6570\uff08\u591a\u9879\u5f0f exp\uff09\u3011"
    },
    {
        "content": "### \u9898\u76ee\u5927\u610f\n\u7ed9\u5b9a $n-1$ \u6b21\u591a\u9879\u5f0f $g(x)$ \uff0c\u6c42\u591a\u9879\u5f0f $f(x)$ \u6ee1\u8db3\uff1a\n\n$f(x)\\equiv\\exp^{g(x)}$ $(mod$ $x^n)$\n\n\u7cfb\u6570\u5bf9 $998244353$ \u53d6\u6a21\u3002\n\n\u6570\u636e\u8303\u56f4 $n\\leq 10^5$ \u3002\n\n### \u524d\u7f6e\u829d\u58eb\uff1a\n\u591a\u9879\u5f0f $\\ln$ \uff0c~~\u975e\u5e38\u5165\u95e8\u7684~~\u6c42\u5bfc\uff0c\u79ef\u5206\u548c\u6076\u4fd7\u7684\u725b\u987f\u8fed\u4ee3\u3002\n\n\u7b2c\u4e00\u4e2a\u4e0d\u4f1a\u51fa\u95e8\u5de6\u62d0\uff0c\u6700\u540e\u4e24\u4e2a\u7684\u8bdd\uff0c\u8fd9\u91cc\u53ea\u8981\uff1a\n\n\u6c42\u5bfc\u516c\u5f0f $\\mathrm{d}$ $x^{a}=ax^{a-1}$ \u3002\n\n\u6c42\u5bfc\u6cd5\u5219 $\\mathrm{d}$ $f[g(x)]=f^{'}[g(x)]\\cdot g^{'}(x)$ \u3002\n\n\u79ef\u5206\u516c\u5f0f $\\int x^a=\\frac{1}{a+1}x^{a+1}$ \u3002\n\n\u725b\u987f\u8fed\u4ee3\u7684\u8bdd\uff0c\u73c2\u4ee5\u770b\u770b[\u6211\u7684\u6587\u7ae0](https://www.luogu.com.cn/blog/ngzzgzz/yi-ge-niu-dun-die-dai-hao-xiang-bi-jiao-neng-dong-di-li-xie)\uff08\u867d\u7136\u4e0d\u548b\u5730\u3002\u3002\uff09\uff0c\u5927\u6982\u4e86\u89e3\u4e00\u4e0b\u539f\u7406\u5c31\u597d\n\n### solution\n\u5bf9\u4e8e\u591a\u9879\u5f0f\u521a\u521a\u6760\u5230\u8fd9\u9898\u7684\u6211\u4eec\u6765\u8bf4\uff0c $\\exp$ \u5b9e\u5728\u6709\u70b9\u964c\u751f\uff0c\u4f46 $\\ln$ \u80af\u5b9a\u5df2\u7ecf\u89c1\u8fc7\u4e86\u3002\n\n\u6240\u4ee5\u806a\u660e\u7684\u4f60\u4e00\u5b9a\u6ce8\u610f\u5230\u4e86 $\\exp^{g(x)}$ \u53d6 $\\ln$ \u540e $\\Longrightarrow g(x)$ \u3002\n\n\u6f02\u4eae\uff0c\n\n$f(x)\\equiv\\exp^{g(x)}$ $(mod$ $x^n)$\n\n\u4e24\u8fb9\u540c\u65f6\u53d6\u4e2a $\\ln$ \uff1a\n\n$\\ln_{}{f(x)}\\equiv g(x)$ $(mod$ $x^n)$\n\n\u8bbe $\\varphi(f(x))=\\ln_{}{f(x)}-g(x)\\equiv0$ $(mod$ $x^n)$\n\n\u7528\u4e00\u4e0b\u4e0a\u9762\u63d0\u5230\u7684\u725b\u987f\u8fed\u4ee3\u7684\u516c\u5f0f\n\n$f(x)\\equiv f_0(x)-\\Large\\frac{\\ln f_0(x)-g(x)}{\\frac{1}{f_0(x)}}$\n\n\u5316\u7b80\u4e00\u4e0b\uff1a\n\n$f(x)\\equiv f_0(x)\\cdot(1+g(x)-\\ln f_0(x))$\n\n\u5b8c\u4e86\uff0c\n\n\u7528\u4e00\u4e0b $\\ln$ \u7684\u6c42\u6cd5\u5c31\u884c\u4e86\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log_{2}{n})$ \u3002\n\n\u4eba\u50bb\u5e38\u719f\u5927 wtcl \u3002\u3002\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N=4e5+10;\ntypedef ll arr[N];\nconst int mod=998244353;\nconst int inv3=332748118;\nint n,inv,lim=1,fre,id[N];\narr f,g,ans,tmp,ln;\ninline ll inc(ll x,ll y){return x+y>=mod?x+y-mod:x+y;}\ninline ll dec(ll x,ll y){return x-y<0?x-y+mod:x-y;}\ninline ll mul(ll x,ll y){return 1ll*x*y%mod;}\ninline int read()\n{\n\tint s=0,w=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9') s=s*10+ch-'0',ch=getchar();\n\treturn s*w;\n}\ninline int ksm(int a,int b)\n{\n\tint tmp=1;\n\twhile(b)\n\t{\n\t\tif(b&1)tmp=(1ll*tmp*a)%mod;\n\t\tb>>=1,a=(1ll*a*a)%mod;\n\t}\n\treturn tmp;\n}\ninline void Never_Tell_TLE(ll* NTT,int sign)\n{\n\tfor(int i=0;i<=lim;++i)if(i<id[i])\n\t{\n\t\tll NTt=NTT[i];\n\t\tNTT[i]=NTT[id[i]];\n\t\tNTT[id[i]]=NTt;\n\t}\n\tfor(int mid=1;mid<lim;mid<<=1)\n\t{\n\t\tint Unit_root;\n\t\tif(sign==1)Unit_root=ksm(3,(mod-1)/(mid<<1));\n\t\telse Unit_root=ksm(inv3,(mod-1)/(mid<<1));\n\t\tfor(int R=mid<<1,r=0;r<lim;r+=R)\n\t\t{\n\t\t\tint pw=1;\n\t\t\tfor(int l=0;l<mid;++l,pw=(1ll*pw*Unit_root)%mod)\n\t\t\t{\n\t\t\t\tint butt=NTT[l+r],rfly=(1ll*pw*NTT[l+r+mid])%mod;\n\t\t\t\tNTT[l+r]=inc(butt,rfly);\n\t\t\t\tNTT[l+r+mid]=dec(butt,rfly);\n\t\t\t}\n\t\t}\n\t}\n\tif(sign==-1)\n\t{\n\t\tint inv_lim=ksm(lim,mod-2);\n\t\tfor(int i=0;i<=lim;++i)NTT[i]=(1ll*NTT[i]*inv_lim)%mod;\n\t}\n}\ninline void Derivation(ll* F,ll* G,int nm)\n{\n\tfor(int i=1;i<nm;++i)\n\tG[i-1]=mul(1ll*i,F[i]);\n\tG[nm-1]=0;\n}\ninline void Inv(ll* F,ll* G,int nm)\n{\n\tif(nm==1)\n\t{\n\t\tG[0]=ksm(F[0],mod-2);\n\t\treturn;\n\t}\n\tInv(F,G,(nm+1)>>1);\n\tlim=1,fre=0;\n\tfor(;lim<(nm<<1);lim<<=1)++fre;\n\tfor(int i=0;i<=lim;++i)id[i]=(id[i>>1]>>1)|((i&1)<<(fre-1));\n\tfor(int i=0;i<nm;++i)ans[i]=F[i];\n\tfor(int i=nm;i<=lim;++i)ans[i]=0;\n\tNever_Tell_TLE(ans,1),Never_Tell_TLE(G,1);\n\tfor(int i=0;i<=lim;++i)G[i]=mul(inc(2ll,-mul(ans[i],G[i])+mod),G[i]);\n\tNever_Tell_TLE(G,-1);\n\tfor(int i=nm;i<=lim;++i)G[i]=0;\n}\ninline void Mul(ll* F,ll* G,int nm)\n{\n\tlim=1,fre=0;\n\tfor(;lim<(nm<<1);lim<<=1)++fre;\n\tfor(int i=0;i<=lim;++i)id[i]=(id[i>>1]>>1)|((i&1)<<(fre-1));\n\tint inv_lim=ksm(lim,mod-2);\n\tNever_Tell_TLE(G,1),Never_Tell_TLE(F,1);\n\tfor(int i=0;i<=lim;++i)G[i]=mul(F[i],G[i]);\n\tNever_Tell_TLE(G,-1);\n}\ninline void Integral(ll* F,ll* G,int nm)\n{\n\tfor(int i=1;i<nm;++i)\n\tG[i]=mul(F[i-1],ksm(i,mod-2));\n\tG[0]=0;\n}\ninline void Ln(ll* F,ll* G,int nm)\n{\n\tInv(F,tmp,nm);\n\tfor(int i=0;i<=lim;++i)ans[i]=0;\n\tDerivation(F,ans,nm);\n\tMul(tmp,ans,nm);\n\tIntegral(ans,G,nm);\n\tfor(int i=0;i<=lim;++i)ans[i]=tmp[i]=0;\n}\ninline void solve(ll* F,ll* G,int nm)\n{\n\tif(nm==1)\n\t{\n\t\tG[0]=1;\n\t\treturn;\n\t}\n\tsolve(F,G,(nm+1)>>1);\n\tlim=1,fre=0;\n\tfor(;lim<(nm<<1);lim<<=1)++fre;\n\tfor(int i=0;i<=lim;++i)id[i]=(id[i>>1]>>1)|((i&1)<<(fre-1));\n\tfor(int i=0;i<=lim;++i)ln[i]=0;\n\tLn(G,ln,nm);\n\tfor(int i=0;i<nm;++i)ans[i]=F[i];\n\tfor(int i=nm;i<=lim;++i)ans[i]=0;\n\tNever_Tell_TLE(ans,1),Never_Tell_TLE(G,1),Never_Tell_TLE(ln,1);\n\tfor(int i=0;i<=lim;++i)G[i]=mul(inc(1ll,inc(ans[i],-ln[i]+mod)),G[i]);\n\tNever_Tell_TLE(G,-1);\n\tfor(int i=nm;i<=lim;++i)G[i]=0;\n}\nint main()\n{\n\tn=read();\n\tfor(int i=0;i<n;++i)f[i]=read();\n\tsolve(f,g,n);\n\tfor(int i=0;i<n;++i)printf(\"%d \",g[i]);\n\treturn 0;\n}\n```\n\u53ea\u6c42\u80fd\u5e2e\u52a9\u5230\u51e0\u4e2a\u4eba\u7f62\u3002\u3002",
        "postTime": 1617186326,
        "uid": 206024,
        "name": "Illusory_dimes",
        "ccfLevel": 7,
        "title": "\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u6307\u6570\u51fd\u6570\uff08\u591a\u9879\u5f0f exp\uff09 \u9898\u89e3"
    },
    {
        "content": "\u524d\u9762\u5df2\u7ecf\u6709\u4e00\u4e2a\u4eba\u7ed9\u51fa\u4e86`\u4efb\u610f\u6a21\u6570\u591a\u9879\u5f0fExp`\u4e86\uff0c\u4f46\u662f\u8dd1\u5f97\u6bd4\u8f83\u6162\uff0c\u8fd9\u91cc\u7ed9\u51fa\u4e00\u4efd\u7801\u98ce\u76f8\u5bf9\u9c9c\u660e\u5e76\u4e14\u901f\u5ea6\u5927\u6982\u5728 4s \u5de6\u53f3\u7684\u4ee3\u7801\u3002\n\n\u5176\u5b9e\u4efb\u610f\u6a21\u6570XXX \u5728\u9762\u5411\u5bf9\u8c61\u5c01\u88c5\u597d\u4e4b\u540e\uff0c\u90fd\u662f\u5f88\u597d\u5199\u7684\uff0c\u590d\u7528\u6027\u5f88\u9ad8\u3002\n\n\u4e0d\u6d6a\u8d39\u7248\u9762\uff0c\u4ee3\u7801\u5728[\u8fd9\u91cc](https://www.luogu.com.cn/paste/vgqacuxr)",
        "postTime": 1595461348,
        "uid": 20522,
        "name": "ccviolett",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4726 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u6307\u6570\u51fd\u6570\uff08\u591a\u9879\u5f0f exp\uff09\u3011"
    },
    {
        "content": "\u8fd9\u91cc\u6709\u51e0\u4e2a\u524d\u7f6e\u77e5\u8bc6\n#### \u524d\u7f6e1\u3001\u6cf0\u52d2\u5c55\u5f00\u4e0e\u9ea6\u514b\u52b3\u6797\u7ea7\u6570\n\u6cf0\u52d2\u5c55\u5f00\u5c31\u662f\u7528\u591a\u9879\u5f0f\u53bb\u8fd1\u4f3c\u8868\u8fbe\u4e00\u4e9b\u6bd4\u8f83\u70e6\u7684\u66f2\u7ebf\uff0c\u6bd4\u5982\u8bf4$sin,cos,e^x$\u4e4b\u7c7b\u7684\u66f2\u7ebf   \n\u8fd9\u4e9b\u66f2\u7ebf\u6709\u7740\u4f18\u70b9\uff0c\u6bd4\u5982\u8bf4\u4ed6\u4eec\u53ef\u4ee5\u65e0\u9650\u6c42\u5bfc  \n$sin'(x)=cos(x),cos'(x)=-sin(x)$  \n$sin''(x)=-sin(x),sin'''(x)=-cos(x),sin''''(x)=sin(x)$  \n$cos''(x)=-cos(x),cos'''(x)=sin(x),cos''''(x)=cos(x)$  \n$(e^x)'=e^x,(e^x)''=e^x......$  \n\u6211\u4eec\u8981\u6c42\u8fd1\u4f3c\uff0c\u90a3\u4e48\u5c31\u8981\u505a\u5230\u8fd9\u4e24\u4e2a\u51fd\u6570\u5c3d\u53ef\u80fd\u4e00\u6837  \n\u4ec0\u4e48\u53eb\u4e00\u6837\uff1f  \n\u6211\u4eec\u8981\u6c42\u5b83\u8981\u6ee1\u8db3$f(x)=g(x)$\u3001$f'(x)=g'(x)$\u3001$f''(x)=g''(x)$\u2026\u2026  \n\u90a3\u4e48\u6211\u4eec\u6765\u770b\u591a\u9879\u5f0f\u957f\u5565\u6837\u5427  \n\u5047\u8bbe$f(x)=a_0+a_1x+a_2x^2+......+a_nx^n$  \n$g(x)=e^x$  \n\u6211\u4eec\u8981\u6ee1\u8db3  \n$f(x)=g(x),a_1+2a_2+...na_n=e^x,2a_2+6a_3+...n(n-1)a_n=e^x......$  \n\u55ef\uff0c\u81ea\u95ed\u4e86\uff0c\u8fd9\u6837\u7b97\u4e0b\u53bb\u7b97\u4e0d\u51fa\u6765\u7684\uff0c\u6211\u4eec\u76f4\u63a5\u6c42n\u9636\u5bfc\u770b\u770b  \n$n!a_n=e^x$   \n\u6211\u4eec\u4ee4$x=0$\uff0c\u6b64\u65f6$a_n=\\frac{1}{n!}$    \n\u4ee3\u5165$\\frac{(n-1)!}{2}a_{n-1}x^{n-1}+\\frac{n!}{2}a_nx^n=e^x$  \n\u5219$a_{n-1}=\\frac{1}{(n-1)!}$  \n\u6240\u4ee5\u4ee5\u6b64\u7c7b\u63a8$a_i=\\frac{1}{i!}$  \n\u6211\u4eec\u53ef\u4ee5\u5f97\u51fa$g(x)=e^x$\u7684\u8fd1\u4f3c\u591a\u9879\u5f0f   \n$f(x)=\\sum_{i=0}^n\\frac{x^i}{i!}$  \n\u90a3\u4e48\u663e\u7136\u53ef\u4ee5\u8fd9\u4e2a\u6c42n\u9636\u5bfc\u7684\u601d\u8def\u662f\u666e\u9002\u7684   \n\u6211\u4eec\u53ef\u4ee5\u63a8\u5e7f\u51fa\u4e00\u4e2a\u901a\u5f0f  \n$g(x)=1+\\sum_{i=1}^{n}\\frac{f^{(i)}(0)}{i!}x^i$  \n\u8fd9\u662f\u6cf0\u52d2\u5c55\u5f00\u7684\u4e00\u4e2a\u7279\u6b8a\u5f62\u5f0f(x=0)\uff0c\u4e5f\u53eb\u4f5c\u9ea6\u514b\u52b3\u6797\u7ea7\u6570 \n\u771f\u6b63\u7684\u6cf0\u52d2\u5c55\u5f00\u957f\u8fd9\u6837  \n$g(x)=f(x)+\\sum_{i=1}^{n}\\frac{f^{(i)}(x')}{i!}(x-x')^i$\n\u518d\u7ed9\u51fa\u51e0\u4e2a\u5e38\u89c1\u7684\u9ea6\u514b\u52b3\u6797\u7ea7\u6570  \n![](https://gss3.bdstatic.com/-Po3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D226/sign=79c147be10d5ad6eaef963e8b7ca39a3/eac4b74543a982266426575d8182b9014b90ebe1.jpg)  \n  ![](https://gss1.bdstatic.com/-vo3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D396/sign=57e085b615178a82ca3c79a9c002737f/562c11dfa9ec8a13b6e1289afc03918fa1ecc0d5.jpg)\n    \n![](https://gss0.bdstatic.com/94o3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D374/sign=6cc500b1f0edab6470724bc7c337af81/e824b899a9014c08a6cc56df017b02087af4f4d1.jpg)\n![](https://gss0.bdstatic.com/-4o3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D375/sign=f6079ce807f431adb8d2453e7e37ac0f/e1fe9925bc315c607018129586b1cb134954773e.jpg  )  \n![](https://gss0.bdstatic.com/-4o3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D487/sign=20e43ea4edcd7b89ed6c3b8b38254291/a8773912b31bb0510cfa8d463d7adab44bede086.jpg)   \n$o()$\u662f\u76ae\u4e9a\u8bfa\u4f59\u9879\uff0c\u53cd\u6b63\u5c31\u662f$n+1->\\infty$\u7684\u90e8\u5206\n\n#### \u524d\u7f6e2\u3001\u725b\u987f\u8fed\u4ee3\n\u666e\u901a\u725b\u987f\u8fed\u4ee3\u591a\u7528\u4e8e\u6c42\u51fd\u6570\u7684\u96f6\u70b9\uff0c\u5047\u8bbe\u6709\u4e00\u4e2a\u51fd\u6570$f(x)$\uff0c\u6211\u4eec\u5df2\u7ecf\u968f\u4fbf\u9009\u4e86\u4e00\u4e2a\u70b9x\u2019  \n\u663e\u7136\u6839\u636e\u6cf0\u52d2\u5c55\u5f00\uff0c$f(x)=f(x')+f'(x')(x-x')+\\frac{f''(x')(x-x')^2}{2}+...$  \nemmm\uff0c\u8fd9\u73a9\u610f\u4e0d\u4e00\u5b9a\u652f\u6301\u8fde\u7eed\u6c42\u5bfc\uff0c\u800c\u4e14\u975e\u7ebf\u6027\u4e0d\u597d\u62c6\uff0c\u6211\u4eec\u5c31\u628a\u524d\u4e24\u4e2a\u62ff\u4e0b\u6765\u5c31\u884c\u4e86  \n$f(x)=f(x')+f'(x')(x-x')+o(2)$   \n\u6211\u4eec\u8981\u627e\u96f6\u70b9  \n$f(x')+f(x')(x-x')=0$  \n$x=x'-\\frac{f(x)}{f'(x)}$  \n\u56e0\u4e3a\u6cf0\u52d2\u5c55\u5f00\u662f\u6e10\u8fdb\u7684\uff0c\u6240\u4ee5\u80af\u5b9a\u8fd9\u4e2ax\u4f1a\u4e0d\u65ad\u903c\u8fd1\u6b63\u89e3  \n  \n\u591a\u9879\u5f0f\u725b\u987f\u8fed\u4ee3\u9762\u5bf9\u7684\u95ee\u9898\u4e5f\u5dee\u4e0d\u591a   \n\u6211\u4eec\u8981\u6c42\u591a\u9879\u5f0f\u590d\u5408\u51fd\u6570\u7684\u96f6\u70b9$g(f(x))\\equiv0(mod x^n)$  \n\u8bbe$g(f(x'))\\equiv0(modx^{\\left[ \\frac{n}{2}\\right]})$  \n\u6211\u4eec\u5bf9\u590d\u5408\u51fd\u6570\u6cf0\u52d2\u5c55\u5f00    \n$g(f(x))=g(f(x'))+g'(f(x'))(f(x)-f(x'))+\\frac{g''(f(x'))  (f(x)-f(x'))^2}{2!}+o(3)$  \n\u6765\u770b\u4e00\u4e0b\u8fd9\u6837\u5b50\u4fdd\u7559\u7684\u7cbe\u5ea6   \n\u9996\u5148\u6839\u636e\u6cf0\u52d2\u5c55\u5f00\u7684\u6027\u8d28\uff0c\u6211\u4eec\u641e\u51fa\u6765\u7684$f(x)$\u80af\u5b9a\u6bd4$f(x')$\u7cbe\u5ea6\u9ad8    \n\u6240\u4ee5$f(x)\\equiv0(modx^{\\left[ \\frac{n}{2}\\right]})$     \n\u6240\u4ee5$(f(x)-f(x'))\\equiv0(modx^{\\left[ \\frac{n}{2}\\right]})$     \n\u6240\u4ee5$(f(x)-f(x'))^2\\equiv0(modx^n)$     \n\u663e\u7136\u4e4b\u540e\u7684\u66f4\u9ad8\u6b21\u90fd\u662f\u540c\u7406\uff0c\u5bf9n\u9879\u4ee5\u5185\u4ea7\u751f\u4e0d\u4e86\u8d21\u732e\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u53ef\u4ee5\u7528\u4fdd\u7559\u524d\u4e24\u9879\u7684\u5f0f\u5b50\u83b7\u5f97\u53cc\u500d\u7684~~\u5feb\u4e50~~\u7cbe\u5ea6   \n\u4e5f\u5c31\u662f\u53ef\u4ee5\u500d\u589e\u4e86  \n$g(f(x))=g(f(x'))+g'(f(x'))(f(x)-f(x'))\\equiv0(modx^n)$\n$f(x)=f(x')-\\frac{g(f(x'))}{g'(f(x'))}$  \n\n## \u6b63\u6587\n\u524d\u7f6e\u77e5\u8bc6\u8bb2\u5b8c\u4e86\uff0c\u6211\u4eec\u89e3\u51b3\u4e00\u4e0b\u591a\u9879\u5f0fexp  \n$g(x)=e^{f(x)}$\uff0c\u4e24\u8fb9\u6c42\u4e2aln  \n$ln(g(x))=f(x)$  \n$h(x)=ln(g(x))-f(x)=0$  \n\u561b\uff0c\u6c42\u96f6\u70b9\u7684\u8bdd\u725b\u987f\u8fed\u4ee3\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86  \n\u5047\u8bbe\u6211\u4eec\u6c42\u51fa\u4e86$g(x')=e^{f(x)}(modx^{[\\frac{n}{2}]})$  \n\u6211\u4eec\u6765\u5957\u516c\u5f0f    \n$g(x)=g(x')-\\frac{h(g(x'))}{h'(g(x'))}$  \n$g(x)=g(x')-\\frac{ln(g(x'))-f(x')}{\\frac{1}{g(x')}}$    \uff08\u56e0\u4e3ah(x)\u968f\u7740g(x)\u53d8\u5316\uff0c\u548cf(x)\u65e0\u5173\uff1f\uff09  \n$g(x)=g(x'){(1-ln(g(x'))+f(x'))}$  \n\n\u6839\u636e\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u53ef\u4ee5\u6c42exp\u4e86  \n\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define mod 998244353\n#define gg 3\nusing namespace std;\n\nint r[400040],n;\nlong long inv[400040],tmp1[400040],tmp2[400040],tmp3[400040],ln[400040],f[400040],de[400040],in[400040],ex[400040]; \n\nlong long kasumi(long long a,long long b)\n{\n    long long ans=1;\n    while(b)\n    {\n        if(b&1) ans=ans*a%mod;\n        a=a*a%mod;\n        b>>=1; \n    }\n    return ans;\n}\n\nvoid NTT(long long *a,int kd,int cnt)\n{\n    int lim=1<<cnt;\n    for(int i=0;i<lim;i++)\n    {\n        if(i<r[i]) swap(a[i],a[r[i]]);\n    }\n    for(int mid=1;mid<lim;mid<<=1)\n    {\n        long long wn=kasumi(gg,(mod-1)/(mid<<1));\n        if(kd) wn=kasumi(wn,mod-2);\n        for(int i=0;i<lim;i+=(mid<<1))\n        {\n            long long w=1;\n            for(int j=0;j<mid;j++,w=w*wn%mod)\n            {\n                long long x=a[i+j];\n                long long y=a[i+j+mid]*w%mod;\n                a[i+j]=(x+y)%mod;\n                a[i+j+mid]=(x-y+mod)%mod;\n            }\n        }\n    }\n    if(kd)\n    {\n        long long invl=kasumi(lim,mod-2);\n        for(int i=0;i<lim;i++)\n        {\n            a[i]=a[i]*invl%mod; \n        }\n    }\n}\n\nvoid rev(int cnt)\n{\n    int lim=1<<cnt;\n    for(int i=0;i<lim;i++)\n    {\n        r[i]=(r[i>>1]>>1)|((i&1)<<(cnt-1));\n    }\n}\n\nvoid der(const long long *a,int cnt)\n{\n    int lim=1<<cnt;\n    for(int i=0;i<lim;i++)\n    {\n        de[i]=a[i+1]*(i+1)%mod;\n    } \n}\n\nvoid inte(const long long *a,int cnt)\n{\n    int lim=1<<cnt;\n    for(int i=lim-1;i>=1;i--)\n    {\n        in[i]=a[i-1]*kasumi(i,mod-2)%mod;\n    }\n}\n\nvoid get_inv(const long long *a,int len)\n{\n\n    int cnt=0;\n    for(int i=0;i<len;i++) tmp1[i]=tmp2[i]=inv[i]=0;\n    inv[0]=kasumi(a[0],mod-2);\n    int lim=1;\n    while(lim<len)\n    {\n        cnt++;\n        rev(cnt);\n        lim<<=1;\n        for(int i=0;i<lim>>1;i++)\n        {\n            tmp1[i]=inv[i];\n            tmp2[i]=a[i];\n        }\n        NTT(tmp1,0,cnt);NTT(tmp2,0,cnt);\n        for(int i=0;i<lim;i++)\n        {\n            tmp1[i]=(tmp1[i]*2ll%mod-tmp2[i]*tmp1[i]%mod*tmp1[i]%mod+mod)%mod;\n        }\n        NTT(tmp1,1,cnt);\n        for(int i=0;i<lim>>1;i++)\n        {\n            inv[i]=tmp1[i];\n        }\n    }\n}\n\nvoid get_ln(const long long *a,int len)\n{\n    int lim=1,cnt=0;\n    while(lim<len) lim<<=1,cnt++;\n    get_inv(a,lim);\n    der(a,cnt);\n    NTT(inv,0,cnt); NTT(de,0,cnt);\n    for(int i=0;i<lim;i++) ln[i]=inv[i]*de[i]%mod;\n    NTT(ln,1,cnt);\n    inte(ln,cnt);\n}\n\nvoid get_exp(const long long *a,int len)\n{\n    int cnt=1,lim=2;\n    ex[0]=1;\n    while(lim<len)\n    {\n        cnt++;\n        lim<<=1;    \n        get_ln(ex,lim);\n        in[0]=0;\n        in[0]=(in[0]-1+mod)%mod;\n        for(int i=0;i<lim>>1;i++)\n        {\n            tmp1[i]=a[i];\n            tmp2[i]=mod-in[i];\n            tmp3[i]=ex[i];\n        }\n        for(int i=lim>>1;i<lim;i++) tmp1[i]=tmp2[i]=tmp3[i]=0;\n        NTT(tmp3,0,cnt);NTT(tmp1,0,cnt);NTT(tmp2,0,cnt);\n        for(int i=0;i<lim;i++)\n        {   \n            tmp3[i]=tmp3[i]*((tmp2[i]+tmp1[i])%mod)%mod;\n        }\n        NTT(tmp3,1,cnt);\n        for(int i=0;i<lim>>1;i++)\n        {\n            ex[i]=tmp3[i];\n        }\n    }\n}\n\nint main()\n{\n    scanf(\"%d\",&n);\n    for(int i=0;i<n;i++)\n    {\n        scanf(\"%lld\",&f[i]);\n    } \n    get_exp(f,n*2);\n    for(int i=0;i<n;i++) printf(\"%lld \",ex[i]);\n}\n```\n\n\u8bdd\u8bf4\u8fd9\u9898\u4e3a\u4ec0\u4e48\u8981\u5361\u5e38\u6570\u554a\u2026\u2026\u611f\u89c9\u65f6\u95f4\u5f88\u5bbd\u88d5\u7684\u8bf4",
        "postTime": 1552820463,
        "uid": 185441,
        "name": "\u30cb\u30d2\u30eb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4726 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u6307\u6570\u51fd\u6570\u3011"
    },
    {
        "content": "\u591a\u9879\u5f0f$Exp$\u6a21\u677f\u9898\u3002\n\n\u60f3\u505a\u8fd9\u9053\u9898\u5148\u8981\u77e5\u9053[\u591a\u9879\u5f0fLn](https://www.luogu.org/problemnew/show/P4725)\u600e\u4e48\u5199\u3002\n\n\u4f60\u53ef\u4ee5\u770b\u770b[\u8fd9\u4e2a](https://www.luogu.org/blog/user7035/duo-xiang-shi-zong-jie)\u3002\n\n\u8bbe$G(x)\\equiv e^{F(x)}\\pmod{x^n}$\uff0c$G_1(x)\\equiv e^{F(x)}\\pmod{x^{\\lceil\\frac{n}{2}\\rceil}}$\n\n\n\u5229\u7528\u725b\u987f\u8fed\u4ee3\u516c\u5f0f\u53ef\u5f97\n\n$$G=G_1(1-LnG_1+F)$$\n\n\u500d\u589e\u6c42\u5373\u53ef\u3002\u6ce8\u610f\u500d\u589e\u7528\u7684\u53d8\u91cf\u4e0d\u80fd\u91cd\u590d\u3002\n\n\u4ee3\u7801:\n\n```cpp\n#include<bits/stdc++.h>\n#include<ext/pb_ds/assoc_container.hpp>\n#include<ext/pb_ds/priority_queue.hpp>\n#define For(i,a,b) for(i=(a);i<=(b);++i)\n#define Forward(i,a,b) for(i=(a);i>=(b);--i)\n#define Rep(i,a,b) for(register int i=(a),i##end=(b);i<=i##end;++i)\n#define Repe(i,a,b) for(register int i=(a),i##end=(b);i>=i##end;--i)\nusing namespace std;\ninline void read(int &x)\n{\n    static const int BUFSIZE = 1048576;\n    static char buf[BUFSIZE];\n    static char *bufnow = buf;\n    static char *bufmax = buf;\n    if (bufnow == bufmax) {\n        bufmax = buf + fread(buf, 1, BUFSIZE, stdin);\n        bufnow = buf;\n    }\n    static int c;\n    c = *bufnow++;\n    for (;!isdigit(c);c = *bufnow++) {\n            if (bufnow == bufmax) {\n            bufmax = buf + fread(buf, 1, BUFSIZE, stdin);\n            bufnow = buf;\n        }\n    }\n    x = 0;\n    for (;isdigit(c);c = *bufnow++) {\n        x = (x << 1) + (x << 3) + c - 48;\n        if (bufnow == bufmax) {\n            bufmax = buf + fread(buf, 1, BUFSIZE, stdin);\n            bufnow = buf;\n        }\n    }\n}\n\ninline void write(int a,char ed='\\n')\n{\n    static short s[13],tp;\n    if(!a){putchar('0'),putchar(ed);return;}\n    for(tp=0;a;a/=10)s[++tp]=a%10;\n    for(;tp;putchar(s[tp--]^48));\n    putchar(ed);\n}\n\nvoid file(void){\n    freopen(\"polynomial.in\",\"r\",stdin);\n    freopen(\"polynomial.out\",\"w\",stdout);\n}\nconst int MAXN=1<<22;\n\ntypedef long long ll;\n\nnamespace polynomial \n{\n    static int mod=998244353,gen=3,g[21],rev[MAXN],Len;\n\n    inline int ad(int a,int b){return (a+=b)>=mod?a-mod:a;}\n\n    inline int power(int a,int b)\n    {\n        static int sum;\n        for(sum=1;b;b>>=1,a=(ll)a*a%mod)if(b&1)\n            sum=(ll)sum*a%mod;\n        return sum;\n    }\n\n    inline void predone()\n    {\n        static int i,j;\n        for(i=1,j=2;i<=20;++i,j<<=1)g[i]=power(gen,(mod-1)/j);\n    }\n\n    inline void calrev(int Len)\n    {\n        static int Logl;Logl=(int)floor(log(Len)/log(2)+0.3)-1;\n        Rep(i,1,Len-1)rev[i]=(rev[i>>1]>>1)|((i&1)<<Logl);\n    }\n\n    inline void NTT(int X[],int typ)\n    {\n        Rep(i,1,Len-1)if(i<rev[i])swap(X[i],X[rev[i]]);\n        static int i,j,k,kk,w,t,wn,r;\n        for(k=2,kk=1,r=1;k<=Len;k<<=1,kk<<=1,++r)\n        {\n            wn=g[r];\n            for(i=0;i<Len;i+=k)for(j=0,w=1;j<kk;++j,w=(ll)w*wn%mod)\n            {\n                t=(ll)w*X[i+j+kk]%mod;\n                X[i+j+kk]=ad(X[i+j],mod-t);\n                X[i+j]=ad(X[i+j],t);\n            }\n        }\n        if(typ==-1)\n        {\n            reverse(X+1,X+Len);\n            static int invn;invn=power(Len,mod-2);\n            Rep(i,0,Len-1)X[i]=(ll)X[i]*invn%mod;\n        }\n    }\n\n    static int x[MAXN],y[MAXN];\n    inline void mul(int a[],int b[])\n    {\n        memset(x,0,sizeof x);memset(y,0,sizeof y);\n        Rep(i,0,(Len>>1)-1)x[i]=a[i],y[i]=b[i];\n        NTT(x,1);NTT(y,1);\n        Rep(i,0,Len-1)x[i]=(ll)x[i]*y[i]%mod;\n        NTT(x,-1);\n        Rep(i,0,Len-1)a[i]=x[i];\n    }\n    \n    static int c[2][MAXN];\n    \n    static int A[MAXN],B[MAXN];\n\n    void Inv(int *a,int *b,int n)\n    {\n        if(n==1){b[0]=power(a[0],mod-2);return;}\n        Inv(a,b,n>>1);\n        Len=n<<1;\n        calrev(Len);\n        Rep(i,0,(Len>>1)-1)A[i]=a[i],B[i]=b[i];\n        NTT(A,1);NTT(B,1);\n        Rep(i,0,Len-1)B[i]=(ll)B[i]*B[i]%mod*A[i]%mod;\n        NTT(B,-1);\n        Rep(i,0,(Len>>1)-1)b[i]=ad(b[i],ad(b[i],mod-B[i]));\n        Rep(i,0,Len)A[i]=B[i]=0;\n    }\n    \n    inline void Direv(int *a,int n)\n    {Rep(i,1,n)a[i-1]=(ll)a[i]*i%mod;a[n]=0;}\n    \n    inline void Inter(int *a,int n)\n    {Repe(i,n,1)a[i]=(ll)a[i-1]*power(i,mod-2)%mod;a[0]=0;}\n\n    static int X[MAXN];\n    \n    inline void Ln(int *a,int n)\n    {\n        Len=2;\n        memset(X,0,sizeof X);\n        while(Len<=n)Len<<=1;\n        Inv(a,X,Len);\n        Direv(a,n);\n        while(Len<=(n<<2))Len<<=1;\n        calrev(Len);\n        mul(a,X);\n        Inter(a,n);\n        Rep(i,n+1,Len)a[i]=0;\n    }\n\n    static int T[MAXN],K[MAXN];\n\n    inline void Exp(int *a,int n)\n    {\n        static int t,z;t=0;\n        memset(K,0,sizeof K);K[0]=1;\n        Len=z=2;\n        while(z<=(n<<1))\n        {\n            z<<=1;t^=1;\n            Rep(i,0,(z>>1)-1)T[i]=K[i];\n            Ln(T,(z>>1)-1);\n            Rep(i,0,(z>>1)-1)T[i]=ad(a[i]+(i==0),mod-T[i]);\n            calrev(Len=z);\n            mul(K,T);\n            Rep(i,z,z<<1)K[i]=T[i]=0;\n        }\n        Rep(i,0,n)a[i]=K[i];\n    }\n}\nusing namespace polynomial;\n\nstatic int n,F[MAXN];\n\nint main(void){\n//    file();\n    predone();\n    read(n);\n    Rep(i,0,n-1)read(F[i]);\n    Exp(F,n);\n    Rep(i,0,n-1)write(F[i],' ');\n//    cerr<<1.0*clock()/CLOCKS_PER_SEC<<endl;\n    return 0;\n}\n```\n~~(\u56e0\u4e3a\u5e38\u6570\u95ee\u9898\u5361\u4e86\u4e0b\u5e38\uff0c\u987a\u4fbf\u4e00\u8bf4\u9012\u5f52\u5f0f\u6bd4\u975e\u9012\u5f52\u5f0f\u8981\u5feb)~~",
        "postTime": 1530622465,
        "uid": 7035,
        "name": "Great_Influence",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4726 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u6307\u6570\u51fd\u6570\u3011"
    },
    {
        "content": "\u591a\u9879\u5f0f\u6307\u6570\u51fd\u6570\uff08$\\exp$\uff09\u6a21\u677f\u3002\n\n## \u524d\u7f6e\u77e5\u8bc6\n[\u591a\u9879\u5f0f $\\ln$](https://www.luogu.com.cn/problem/P4725)\u3001[\u591a\u9879\u5f0f\u4e58\u6cd5\u9006](https://www.luogu.com.cn/problem/P4238)\u3001\u725b\u987f\u8fed\u4ee3\u3002\n\n\u8fd9\u91cc\u4e5f\u7b80\u8981\u8bb2\u4e00\u8bb2\u8fd9\u4e9b\u3002\n\n### 1. \u591a\u9879\u5f0f $\\ln$\n\n\u5b9a\u4e49\u7565\u3002\u8bb2\u8bb2\u6c42\u6cd5\u3002\n\n\u6211\u4eec\u77e5\u9053\uff0c$\\ln x$ \u7684\u5bfc\u6570\u662f $\\dfrac 1x$\uff0c\u5373 $\\dfrac{\\text d}{\\text dx}\\ln x=\\dfrac 1x$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u7531\u590d\u5408\u51fd\u6570\u6c42\u5bfc\u6cd5\u5219\uff08$\\dfrac{\\text df}{\\text dx}=\\dfrac{\\text df}{\\text du}\\cdot \\dfrac{\\text du}{\\text dx}$\uff09\u5f97\u5230\uff1a\n\n$\\dfrac{\\text d}{\\text dx}\\ln A(x)=\\dfrac 1{A(x)}\\cdot\\dfrac{\\text d}{\\text dx}A(x)={A^\\prime(x)}\\cdot{A^{-1}(x)}$\u3002\n\n\u6240\u4ee5\u5bf9\u4e8e\u6c42 $\\ln$\uff0c\u53ea\u9700\u8981\u4e00\u4e2a\u6c42\u5bfc\u3001\u4e00\u4e2a\u6c42\u9006\u3001\u4e00\u4e2a\u79ef\u5206\u5c31\u597d\u4e86\u3002\n\n### 2. \u591a\u9879\u5f0f\u4e58\u6cd5\u9006\n\n\u4e00\u822c\u4f7f\u7528\u500d\u589e\u3002\u8fd9\u91cc\u76f4\u63a5\u7ed9\u51fa\u500d\u589e\u5f0f\uff08\u63a8\u5bfc\u8fc7\u7a0b\u53bb\u6a21\u677f\u9898\u9898\u89e3\u533a\uff0c\u8bbe $F(x)\\cdot G(x)\\equiv1\\pmod {\\text{\u7ed9\u5b9a\u6a21\u6570}}$\uff09\uff1a\n\n$$G(x)=2G^\\ast(x)-F(x)\\cdot {G^\\ast}^2(x)$$\n\n\u5176\u4e2d $G^\\ast(x)$ \u4e3a\u5df2\u7ecf\u63a8\u51fa\u7684\u5f0f\u5b50\u524d $n$ \u9879\uff0c\u4e14 $G$ \u7684\u5e38\u6570\u9879\u4e3a $F$ \u5e38\u6570\u9879\u7684\u9006\u5143\u3002\n\n### 3. \u725b\u987f\u8fed\u4ee3\n\n\u5bf9\u4e8e\u4e00\u4e2a\u65b9\u7a0b $f(x)=0$\uff0c\u4e3a\u4e86\u6c42\u5f97\u4e00\u4e2a\u6839\uff0c\u53ef\u4ee5\u4ece\u4e00\u4e2a\u521d\u59cb\u70b9 $(x_0,f(x_0))$ \u5f00\u59cb\uff0c\u6bcf\u6b21\u4f5c\u8fc7\u8fd9\u4e2a\u70b9\u7684\u5207\u7ebf\uff0c\u53d6\u5207\u7ebf\u4e0e $x$ \u8f74\u4ea4\u70b9\u7684 $x$ \u4e3a\u4e0b\u4e00\u6b21\u8fed\u4ee3\u7684 $x_0$\uff0c\u5c31\u53ef\u4ee5\u4e0d\u65ad\u903c\u8fd1\u6240\u6c42\u7684\u6839\u3002\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u63a8\u5bfc\u51fa\u8fed\u4ee3\u5f0f\uff1a\n\n$$x_{n+1}=x_n-\\dfrac{f(x_n)}{f^\\prime(x_n)}$$\n\n\u8fd9\u6837\u4ece $x_0$ \u5f00\u59cb\uff0c\u7ecf\u8fc7\u4e00\u5b9a\u6b21\u6570\u7684\u8fed\u4ee3\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u6ee1\u8db3\u8981\u6c42\u7cbe\u5ea6\u7684\u6839\u3002\u8fd9\u79cd\u65b9\u6cd5\u5c31\u53eb\u725b\u987f\u8fed\u4ee3\u3002\n\n\u540c\u6837\u7684\uff0c\u5bf9\u4e8e\u591a\u9879\u5f0f\u6211\u4eec\u4e5f\u53ef\u4ee5\u8fdb\u884c\u8fd9\u6837\u7684\u8fed\u4ee3\u3002\u82e5\u8981\u6c42\u89e3\u65b9\u7a0b $G(F(x))=0$\uff0c\u5219\u6709\u8fed\u4ee3\u5f0f\uff1a\n\n$$F_{n+1}(x)=F_n(x)-\\dfrac{G(F(x))}{G^\\prime(F(x))}$$\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u4ece\u4e00\u4e2a\u521d\u503c $F_0(x)$ \u5f00\u59cb\uff0c\u4e00\u6b21\u6b21\u8fed\u4ee3\u5c31\u80fd\u5f97\u5230\u6211\u4eec\u6240\u9700\u8981\u7684 $F(x)$\u3002\u53ef\u4ee5\u8bc1\u660e\u4e00\u6b21\u8fed\u4ee3\u540e\u7cbe\u5ea6\u4f1a\u7ffb\u500d\uff0c\u6240\u4ee5\u6839\u636e\u8fd9\u6761\u500d\u589e\u5373\u53ef\u3002\n\n## \u591a\u9879\u5f0f $\\exp$\n\n### \u63a8\u5bfc\uff1a\n\n\u6211\u4eec\u77e5\u9053\uff0c$\\exp$ \u548c $\\ln$ \u4e92\u4e3a\u9006\u8fd0\u7b97\u3002\u8bbe $B(x)=\\exp(A(x))=e^{A(x)}$\uff0c\u90a3\u4e48\u53ef\u4ee5\u5217\u51fa\u65b9\u7a0b\uff1a\n\n$$\\ln B(x)-A(x)=0$$\n\n\u4ee4 $G(F(x))=\\ln F(x)-A(x)$\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u725b\u987f\u8fed\u4ee3\u5f97\u51fa\u500d\u589e\u5f0f\uff1a\n\n$$\n\\begin{array}{ll}\nB_{n+1}(x)&=B_n(x)-\\dfrac{G(B_n(x))}{G^\\prime(B_n(x))}\\\\\n&=B_n(x)-\\dfrac{\\ln B_n(x)-A(x)}{\\dfrac 1{B_n(x)}}\\\\\n&=B_n(x)\\cdot(1-\\ln B_n(x)+A(x))\n\\end{array}\n$$\n\n\u4ee3\u5165\u521d\u503c $B_0(x)=e^{A_0}$\uff08\u5176\u4e2d $A_0$ \u4e3a $A$ \u7684\u5e38\u6570\u9879\uff09\u5373\u53ef\u3002\u7531\u4e8e\u9898\u76ee\u4fdd\u8bc1 $A_0=0$\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4ee4 $B_0(x)=1$\u3002\u5f53\u7136\uff0c\u5e76\u4e0d\u662f\u8bf4 $A_0\\neq 0$ \u5c31\u4e0d\u5b58\u5728 $\\exp$\uff0c\u800c\u662f\u56e0\u4e3a\u6211\u4eec\u5728\u6a21\u610f\u4e49\u4e0b\u4e0d\u5bb9\u6613\u627e\u5230\u8fd9\u4e48\u4e00\u4e2a $e^{A_0}$\u3002\n\n\u65e2\u7136\u4e0a\u9762\u7684\u521d\u503c\u548c\u500d\u589e\u5f0f\u90fd\u786e\u5b9a\u4e86\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u6309\u7167\u4e0a\u9762\u7684\u500d\u589e\u3002\u5de6\u8f6c\u53f3\u8f6c\u628a $\\ln$ \u548c NTT/FFT \u7684\u6a21\u677f\u6252\u8fc7\u6765\u5c31\u53ef\u4ee5\u4e86\u3002\u6ce8\u610f\u6e05\u96f6\uff01\n\n### \u4ee3\u7801\n\n\u8fd9\u91cc\u7ed9\u51fa NTT \u8fed\u4ee3\u7684\u3002\n\n```cpp\n#include <iostream>\n#include <cstring>\nconst int MAXN = 100010;\nconst int MOD = 998244353, G = 3, InvG = 332748118; // \u6a21\u6570\uff0c\u539f\u6839\uff0c\u539f\u6839\u9006\u5143\nusing ll = long long;\nll inv[MAXN << 2]; // \u9884\u5904\u7406\u9006\u5143\u8868\nll qpow(ll b, ll p = MOD - 2) // \u5feb\u901f\u5e42\n{\n    ll ans = 1;\n    while (p)\n    {\n        if (p & 1)\n            (ans *= b) %= MOD;\n        (b *= b) %= MOD;\n        p >>= 1;\n    }\n    return ans;\n}\nvoid NTT(ll *f, int n, bool inv = false) // \u8fed\u4ee3 NTT\n{\n    static int tr[MAXN << 2] = {0};\n    for (int i = 0; i < n; i++)\n        tr[i] = (tr[i >> 1] >> 1) | (i & 1 ? n >> 1 : 0);\n    for (int i = 0; i < n; i++)\n        if (i < tr[i])\n            std::swap(f[i], f[tr[i]]);\n    for (int l = 2; l <= n; l <<= 1)\n    {\n        ll root = qpow(inv ? InvG : G, (MOD - 1) / l);\n        for (int k = 0; k < n; k += l)\n        {\n            ll cur = 1;\n            for (int i = k; i < k + (l >> 1); i++)\n            {\n                ll qwq = f[i + (l >> 1)] * cur % MOD;\n                f[i + (l >> 1)] = f[i] - qwq;\n                if (f[i + (l >> 1)] < 0)\n                    f[i + (l >> 1)] += MOD;\n                f[i] += qwq;\n                if (f[i] >= MOD)\n                    f[i] -= MOD;\n                (cur *= root) %= MOD;\n            }\n        }\n    }\n    if (inv)\n    {\n        ll invn = qpow(n);\n        for (int i = 0; i < n; i++)\n            (f[i] *= invn) %= MOD;\n    }\n}\nvoid Inv(ll *f, ll *r, int n) // \u591a\u9879\u5f0f\u9006\n{\n    static ll tmp[MAXN << 2], tmpf[MAXN << 2];\n    memset(tmp, 0, sizeof(tmp));\n    memset(tmpf, 0, sizeof(tmpf));\n    r[0] = qpow(f[0]);\n    for (int l = 2; l <= n; l <<= 1)\n    {\n        for (int i = 0; i < l; i++)\n            tmp[i] = r[i], tmpf[i] = f[i];\n        for (int i = l; i < l << 1; i++)\n            tmp[i] = tmpf[i] = 0;\n        NTT(tmp, l << 1);\n        NTT(tmpf, l << 1);\n        for (int i = 0; i < l << 1; i++)\n            tmp[i] = (2 - tmp[i] * tmpf[i] % MOD + MOD) % MOD * tmp[i] % MOD;\n        NTT(tmp, l << 1, 1);\n        for (int i = 0; i < l; i++)\n            r[i] = tmp[i];\n    }\n}\nvoid Directive(ll *f, int n) // \u6c42\u5bfc\n{\n    for (int i = 1; i < n; i++)\n        f[i - 1] = f[i] * i % MOD;\n    f[n - 1] = 0;\n}\nvoid Intergral(ll *f, int n) // \u79ef\u5206\n{\n    for (int i = n; i; i--)\n        f[i] = f[i - 1] * inv[i] % MOD;\n    f[0] = 0;\n}\nvoid Ln(ll *f, int n) // \u591a\u9879\u5f0f ln\n{\n    static ll res[MAXN << 2];\n    memset(res, 0, sizeof(res));\n    Inv(f, res, n);\n    Directive(f, n);\n    NTT(f, n << 1);\n    NTT(res, n << 1);\n    for (int i = 0; i < n << 1; i++)\n        (f[i] *= res[i]) %= MOD;\n    NTT(f, n << 1, 1);\n    Intergral(f, n << 1);\n    for (int i = n; i < n << 1; i++)\n        f[i] = 0; // \u6ce8\u610f\u6e05\u96f6\uff01\n}\nvoid pExp(ll *f, ll *res, int n) // exp\n{\n    static ll tmpf[MAXN << 2], tmpln[MAXN << 2], tmpr[MAXN << 2];\n    res[0] = 1; // \u76f4\u63a5\u4ee4\u5e38\u6570\u9879\u4e3a 1\n    for (int l = 2; l <= n; l <<= 1)\n    {\n        for (int i = 0; i < l; i++)\n            tmpf[i] = f[i], tmpln[i] = tmpr[i] = res[i];\n        for (int i = l; i < l << 1; i++)\n            tmpf[i] = tmpln[i] = tmpr[i] = 0;\n        Ln(tmpln, l); // \u6c42 ln\u3002\u6ce8\u610f\u957f\u5ea6\uff01\uff08\u56e0\u4e3a\u8fd9\u4e2a\u6211\u5361\u4e86\u4e24\u5929 w\uff09\n        NTT(tmpln, l << 1);\n        NTT(tmpf, l << 1);\n        NTT(tmpr, l << 1);\n        // \u500d\u589e\uff0cB = B * (1 - ln(B) + A(x))\n        for (int i = 0; i < l << 1; i++)\n            (tmpr[i] *= (1 - tmpln[i] % MOD + MOD + tmpf[i] % MOD) % MOD) %= MOD; \n        NTT(tmpr, l << 1, true);\n        for (int i = 0; i < l; i++)\n            res[i] = tmpr[i];\n        for (int i = l; i < l << 1; i++)\n            res[i] = 0; // \u6ce8\u610f\u6e05\u96f6\uff01\n    }\n}\nll f[MAXN << 2], res[MAXN << 2];\nint main()\n{\n    int n;\n    std::cin >> n;\n    for (int i = 0; i < n; i++)\n        std::cin >> f[i];\n    int lim = 1;\n    while (lim < n)\n        lim <<= 1;\n    inv[1] = 1;\n    for (int i = 2; i <= n; i++)\n        inv[i] = MOD - ((MOD / i) * inv[MOD % i]) % MOD;\n    pExp(f, res, lim);\n    for (int i = 0; i < n; i++)\n        std::cout << res[i] << \" \";\n    std::cout << std::endl; // \u7ed3\u5c3e\u6362\u884c\u597d\u4e60\u60ef\uff08\n    return 0;\n}\n```\n\n1.6s\uff0c\u4e0d\u7b97\u5f88\u5feb\uff0c\u4f46\u662f\u4e5f\u8fd8\u80fd\u8bf4\u5f97\u8fc7\u53bb\u3002",
        "postTime": 1632891231,
        "uid": 134519,
        "name": "qwq\u81ea\u52a8\u673a",
        "ccfLevel": 0,
        "title": "P4726 \u9898\u89e3"
    }
]
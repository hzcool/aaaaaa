[
    {
        "content": "# **\u7b97\u6cd5\uff1a\u8ba1\u7b97\u51e0\u4f55+\u53cc\u6307\u9488**\n\n **\u9996\u5148\uff0c\u770b\u6570\u636e\u8303\u56f4\u53ef\u77e5\uff0c\u4e0d\u80fd\u591f\u53bb\u679a\u4e3e\u6bcf\u4e00\u6761\u7ebf\u6bb5\uff0c\u4e24\u4e24\u5224\u65ad\u662f\u5426\u76f8\u4ea4\u3002\u4f46\u662f\uff0c\u672c\u9898\u8f83\u4e3a\u7279\u6b8a\u7684\u662f\uff0c\u6ee1\u8db3\u6240\u6709\u654c\u4eba\u5728x\u8f74\u4e0a\u65b9\uff0c\u6240\u6709\u53d1\u5c04\u6e90\u548c\u6fc0\u5149\u5854\u5728x\u8f74\u4e0b\u65b9\u3002\u4e8e\u662f**\n \n- \u5206\u522b\u5bf9\u6bcf\u4e2a\u53d1\u5c04\u6e90\u8fdb\u884c\u5904\u7406\n- \u5bf9\u4e8e\u5f53\u524d\u53d1\u5c04\u6e90S\uff0c\u628aS\u5230\u6240\u6709Di\u3001Ti\u7684\u5411\u91cf\u6309\u7167\u6781\u89d2\u6392\u5e8f\n- \u7b54\u6848\u5c31\u662f\u6ee1\u8db3T1\u3001T2\u5939\u89d2\u5c0f\u4e8e180\u5ea6\u7684\uff08T1\uff0cD\uff0cT2\uff09\u4e09\u5143\u7ec4\u7684\u6570\u91cf\u3002\u53ef\u7528Two Pointers\u601d\u60f3\u6c42\u89e3\u3002\u6838\u5fc3\u601d\u60f3\u5373\u4e3a\uff1a\u5bf9\u6bcf\u4e00\u4e2a\u5de6\u7aef\u70b9\uff0c\u627e\u51fa\u53ef\u884c\u533a\u95f4\u7684\u53f3\u7aef\u70b9\u3002\u5229\u7528\u524d\u7f00\u548c\u8ba1\u7b97\u51faT1\u4e3a\u5f53\u524d\u5de6\u7aef\u70b9\uff0cT2\u5728\u5f53\u524d\u533a\u95f4\u5185\u7684\u65b9\u6848\u6570\uff08\u4ece\u5934\u5230\u533a\u95f4\u5185\u6bcf\u4e2aT\u95f4D\u4e2a\u6570\u7684\u7d2f\u79ef\u548c-\u4ece\u5934\u5230\u5de6\u7aef\u70b9D\u7684\u4e2a\u6570\u7d2f\u79ef\u548c*\u533a\u95f4\u5185T\u7684\u4e2a\u6570\uff09\n- \u6ce8\u610f\u5934\u5c3e\u53ef\u80fd\u76f8\u63a5\u6784\u6210\u65b9\u6848\uff0c\u6545\u53ef\u590d\u5236\u4e00\u500d\u505a\u73af\u72b6\u5904\u7406\n\n **\u6700\u540e\uff0c\u7ed9\u51fa\u6211\u4e2a\u4eba\u7684\u4ee3\u7801\u4f9b\u5927\u5bb6\u53c2\u8003**\n \n```cpp\n#include<bits/stdc++.h>\nconst double pi=3.1415926535;\nusing namespace std;\nvoid read(int &x)\n{\n\tchar c=getchar();x=0;int f=1;\n\twhile(!isdigit(c))f=c=='-'?-f:f,c=getchar();\n\twhile(isdigit(c))x=x*10+c-'0',c=getchar();x*=f;\n}\nvoid read(long long &x)\n{\n\tchar c=getchar();x=0;int f=1;\n\twhile(!isdigit(c))f=c=='-'?-f:f,c=getchar();\n\twhile(isdigit(c))x=x*10+c-'0',c=getchar();x*=f;\n}\nconst int N=1005;\nint D,S,T;\nstruct point\n{\n\tlong long x,y;\n\tdouble angle;\n\tpoint(){}\n\tpoint(long long x0,long long y0){x=x0;y=y0;angle=atan2(y,x);};\n\tvoid init(){read(x);read(y);angle=atan2(y,x);}\n\tpoint operator-(const point &a)const{return point(x-a.x,y-a.y);}\n}d[N],s[N],t[N];\ntypedef point vec;\nlong long cross(vec a,vec b){return a.x*b.y-a.y*b.x;}\nconst int onseg=0,onl=1,onr=-1;\nint ccw(vec a,vec b)\n{\n\tif(cross(a,b)>(long long)0)return onl;\n\telse if(cross(a,b)<(long long)0)return onr;\n\telse return onseg;\n}\nbool operator<(vec a,vec b){return a.angle>b.angle;}\nlong long ans;\nstruct ray\n{\n\tvec vc;\n\tbool type;\n}v[N<<2];\nbool sign(long long x){return x>=0;}\nbool cmp(ray a,ray b){return a.vc<b.vc;}\nint sd[N<<2],st[N<<2],sum[N<<2];\nvoid solve(point p)\n{\n\tfor(int i=1;i<=D;i++)v[i]={d[i]-p,0};\n\tfor(int i=1;i<=T;i++)v[D+i]={t[i]-p,1};\n\tsort(v+1,v+1+D+T,cmp);\n\tfor(int i=1;i<=D+T;i++)v[i+D+T]=v[i];\n\tfor(int i=1;i<=(D+T)*2;i++)\n\t{\n\t\tst[i]=st[i-1];\n\t\tsd[i]=sd[i-1];\n\t\tsum[i]=sum[i-1];\n\t\tif(v[i].type)\n\t\t{\n\t\t\tst[i]++;\n\t\t\tsum[i]+=sd[i];\n\t\t}\n\t\telse sd[i]++;\n\t}\n\tfor(int i=1,j=1;i<=D+T;i++)if(v[i].type)\n\t{\n\t\tj=max(j,i);\n\t\twhile(j+1<i+D+T&&ccw(v[i].vc,v[j+1].vc)<=0)j++;\n\t\tans+=sum[j]-sum[i]-sd[i]*(st[j]-st[i]);\n\t}\n}\nint main(){\n\tread(D);\n\tfor(int i=1;i<=D;i++)d[i].init();\n\tread(S);\n\tfor(int i=1;i<=S;i++)s[i].init();\n\tread(T);\n\tfor(int i=1;i<=T;i++)t[i].init();\n\tfor(int i=1;i<=S;i++)solve(s[i]);\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```\n\n**\u6211\u5199\u8fd9\u9053\u9898\u65f6\uff0c\u56e0\u4e3a\u627e\u4e0d\u5230\u8bb2\u7684\u6bd4\u8f83\u8be6\u7ec6\u7684\u9898\u89e3\u800c\u8d70\u4e86\u8bb8\u591a\u5f2f\u8def\uff0c\u82b1\u4e86\u4e24\u5929\u624d\u60f3\u51fa\u7edf\u8ba1\u7b54\u6848\u7684\u529e\u6cd5\uff0c\u5e0c\u671b\u8fd9\u7bc7\u9898\u89e3\u80fd\u5bf9\u8bfb\u8005\u6709\u5e2e\u52a9\u3002**\n\n\n",
        "postTime": 1575537275,
        "uid": 68203,
        "name": "wyt2357",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5545 \u3010[JSOI2016]\u70b8\u5f39\u653b\u51fb2\u3011"
    },
    {
        "content": "# [Portal](https://www.luogu.com.cn/problem/P5545)\n\n\u76f4\u63a5\u7edf\u8ba1\u663e\u7136\u662f\u4e0d\u884c\u7684\uff08$n^4$\uff09\uff0c\u6211\u4eec\u5fc5\u987b\u5f97\u56fa\u5b9a\u4e00\u4e2a\u91cf\uff0c\u6c42\u51fa\u6ee1\u8db3\u9650\u5236\u7684\u5176\u5b83\u4e09\u5143\u7ec4\u7684\u4e2a\u6570\u3002\u6211\u9009\u62e9\u56fa\u5b9a\u53d1\u5c04\u6e90\uff0c\u5e76\u4e14\u5c06\u6240\u6709\u654c\u4eba\u4e0e\u6fc0\u5149\u5854\u6309\u7167\u4e0e\u5f53\u524d\u53d1\u5c04\u6e90\uff08\u4e4b\u540e\u79f0\u5176\u4e3a\u6e90\u70b9\uff09\u7684\u5411\u91cf\u7684\u503e\u89d2\u6392\u5e8f\u3002\n\n\u6211\u4eec\u8003\u8651\u7b26\u5408\u6761\u4ef6\u7684\u4e09\u5143\u7ec4\u4e2a\u6570\u3002\u663e\u7136\uff0c\u56e0\u4e3a\u6fc0\u5149\u5854\u5168\u5728 $x$ \u8f74\u4e0b\u65b9\uff0c\u654c\u4eba\u5168\u5728 $x$ \u8f74\u4e0a\u65b9\uff0c\u6545\u5728\u5c04\u7ebf $(\\text{\u6e90\u70b9},\\text{\u654c\u4eba})$ \u4e24\u4fa7\u7684\u6240\u6709\u6fc0\u5149\u5854\u5bf9\u90fd\u53ef\u4ee5\u4e0e\u8be5\u654c\u4eba\u6784\u6210\u5408\u6cd5\u4e09\u5143\u7ec4\u3002\n\n\u4f46\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5f53\u6fc0\u5149\u5854\u5bf9\u4e0e\u8be5\u5c04\u7ebf\u65e0\u4ea4\u70b9\u65f6\uff0c\u8fd9\u4e2a\u4e09\u5143\u7ec4\u662f\u4e0d\u5408\u6cd5\u7684\uff1b\u7a0d\u52a0\u89c2\u5bdf\u5373\u53ef\u53d1\u73b0\uff0c\u6709\u4ea4\u70b9\u7684\u5145\u8981\u6761\u4ef6\u662f\u4e24\u6fc0\u5149\u5854\u7684\u5411\u91cf\u5939\u89d2 $<\\pi$\u3002\uff08\u6ce8\u610f\u5230\u5b83\u5f3a\u8c03\u4e86\u6ca1\u6709\u4e09\u70b9\u5171\u7ebf\u7684\u60c5\u51b5\uff0c\u8fd9\u5c31\u4f7f\u5f97\u5f88\u591a\u8fb9\u754c\u60c5\u51b5\u4e0d\u7528\u5904\u7406\u3002\u60f3\u8981\u7814\u7a76\u5982\u4f55\u5904\u7406\u8fb9\u754c\u60c5\u51b5\u7684\uff0c\u63a8\u8350[\u8fd9\u9053\u9898](https://www.luogu.com.cn/problem/P3476)\uff0c\u5c3d\u7ba1\u6b64\u79cd\u65b9\u6cd5\u4f1a\u5728\u8be5\u9898\u4e2d\u56e0\u4e3a\u5e38\u6570\u8fc7\u5927\u800cT\u6389\uff09\u3002\n\n\u4e8e\u662f\u6211\u4eec\u8003\u8651\u518d\u56fa\u5b9a\u4e00\u4e2a\u6fc0\u5149\u5854 $j$\uff0c\u5219\u6240\u6709\u5728\u5176\u524d\u65b9 $\\pi$ \u8303\u56f4\u5185\u7684\u5176\u5b83\u6fc0\u5149\u5854\u90fd\u662f\u5408\u6cd5\u7684\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 two-pointers \u6c42\u51fa\u5176\u524d\u65b9\u6700\u540e\u4e00\u4e2a\u5408\u6cd5\u6fc0\u5149\u5854 $k$\u3002\n\n\u5728 two-pointers \u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u8bb0\u5f55\u4ee5\u5f53\u524d\u8282\u70b9\u4e3a\u7aef\u70b9\u65f6\u7684\u7b54\u6848 $sum$\u3001\u5408\u6cd5\u533a\u95f4\u4e2d\u7684\u6fc0\u5149\u5854\u6570 $st$\u3001\u5408\u6cd5\u533a\u95f4\u4e2d\u7684\u654c\u4eba\u6570 $se$\u3002\n\n\u5f53\u4e00\u4e2a\u6fc0\u5149\u5854\u8fdb\u5165\u533a\u95f4\u65f6\uff0c$st$ \u589e\u52a0\uff0c\u540c\u65f6 $sum$ \u589e\u52a0 $se$\uff08\u8be5\u6fc0\u5149\u5854\u3001$j$\u3001$se$ \u4e2d\u6bcf\u4e2a\u654c\u4eba\uff0c\u5747\u6784\u6210\u4e00\u4e2a\u4e09\u5143\u7ec4\uff09\u3002\u5f53\u4e00\u4e2a\u654c\u4eba\u8fdb\u5165\u533a\u95f4\u65f6\uff0c$se$ \u589e\u52a0\u3002\u5f53\u4e00\u4e2a\u6fc0\u5149\u5854\u79bb\u5f00\u533a\u95f4\u65f6\uff0c$st$ \u51cf\u5c11\u3002\u5f53\u4e00\u4e2a\u654c\u4eba\u79bb\u5f00\u533a\u95f4\u65f6\uff0c$se$ \u51cf\u5c11\uff0c\u5e76\u4e14 $sum$ \u51cf\u5c11 $st$\uff08\u7406\u7531\u540c\u4e0a\uff09\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O\\Big(S(D+T)\\log (D+T)\\Big)$\uff0c\u74f6\u9888\u5728\u4e8e\u6392\u5e8f\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst double pi=acos(-1);\nint E,T,B;\nll res;\nstruct Vector{\n\tint x,y;\n\tVector(int X=0,int Y=0){x=X,y=Y;}\n\tfriend Vector operator +(const Vector &u,const Vector &v){return Vector(u.x+v.x,u.y+v.y);}\n\tfriend Vector operator -(const Vector &u,const Vector &v){return Vector(u.x-v.x,u.y-v.y);}\n\tfriend Vector operator *(const Vector &u,const int &v){return Vector(u.x*v,u.y*v);}\n\tfriend Vector operator /(const Vector &u,const int &v){return Vector(u.x/v,u.y/v);}\n\tfriend ll operator &(const Vector &u,const Vector &v){return 1ll*u.x*v.y-1ll*u.y*v.x;}//cross times\n\tfriend ll operator |(const Vector &u,const Vector &v){return 1ll*u.x*v.x+1ll*u.y*v.y;}//point times\n\tdouble operator !()const{return atan2(y,x);}\n\tfriend bool operator <(const Vector &u,const Vector &v){return !u<!v;}\n\tvoid read(){scanf(\"%d%d\",&x,&y);}\n\tvoid print(){printf(\"(%d,%d)\",x,y);}\n}ene[810],tow[810],bea[810];\npair<Vector,bool>p[1610];\nint main(){\n\tscanf(\"%d\",&E);\n\tfor(int i=1;i<=E;i++)ene[i].read();\n\tscanf(\"%d\",&B);\n\tfor(int i=1;i<=B;i++)bea[i].read();\n\tscanf(\"%d\",&T);\n\tfor(int i=1;i<=T;i++)tow[i].read();\n\tfor(int o=1;o<=B;o++){\n\t\tint m=0;\n\t\tfor(int i=1;i<=T;i++)p[m++]=make_pair(tow[i]-bea[o],0);\n\t\tfor(int i=1;i<=E;i++)p[m++]=make_pair(ene[i]-bea[o],1);\n\t\tsort(p,p+m);\n\t\tint sum=0,se=0,st=0,len=0;\n\t\tfor(int j=0,k=0;j<m;){\n\t\t\twhile(len<m&&(p[j].first&p[k].first)>=0){\n\t\t\t\tif(p[k].second==1)se++;\n\t\t\t\telse sum+=se,st++;\n\t\t\t\tlen++,k=(k+1)%m;\n\t\t\t} \n\t\t\tif(p[j].second==0)res+=sum;\n\t\t\tif(p[j].second==0)st--;\n\t\t\telse sum-=st,se--;\n\t\t\tj++,len--;\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",res);\n\treturn 0;\n}\n```",
        "postTime": 1604364054,
        "uid": 123369,
        "name": "xtx1092515503",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5545 \u3010[JSOI2016]\u70b8\u5f39\u653b\u51fb2\u3011"
    }
]
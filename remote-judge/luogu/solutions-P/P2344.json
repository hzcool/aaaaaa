[
    {
        "content": "### [\u6b22\u8fce\u8e29\u8e29\u6211\u7684\u535a\u5ba2](https://www.cnblogs.com/mzg1805/p/11387673.html)\n\n[${\\color{cyan}{>>Question}}$](https://www.luogu.org/problem/P2344)\n\n\u4e8c\u7ef4\u504f\u5e8f$dp$\n\n\u65b9\u7a0b\u5f88\u7b80\u5355\n\n\u4ee4$f[i]$\u8868\u793a\u5230$i$\u7684\u65b9\u6848\u6570\n\n\u6709\n$$f[i] = \\sum f[j],\\sum_{k = j+1}^i a[k] \\geq 0$$\n\n\u5199\u6210\u524d\u7f00\u548c\u7684\u5f62\u5f0f\u4fbf\u662f\n$$f[i] = \\sum f[j],sum[i]-sum[j]\\geq 0$$\n\n\u66b4\u529b\u662f$O(n^2)$(~~\u8bdd\u8bf4\u5c45\u7136\u670970pts~~),\u8003\u8651\u4f18\u5316\n\n\u89c2\u5bdf\u53ef\u77e5$i$\u7531$j$\u8f6c\u79fb\u6765\u6709\u4e24\u4e2a\u6761\u4ef6\n\n$1.$ $j < i$\n\n$2.$ $sum[j] <= sum[i]$\n\n\u90a3\u53ef\u628a$i$\u770b\u6210$(i,sum[i])$\u7684\u70b9,\u5c31\u6210\u4e86\u4e00\u4e2a\u4e8c\u7ef4\u504f\u5e8f\u95ee\u9898\n\n\u4e0d\u4e86\u89e3\u4e8c\u7ef4\u504f\u5e8f\u7684\u53ef\u4ee5\u5eb7\u5eb7[\u8fd9\u7bc7\u535a\u5ba2](https://blog.csdn.net/u012972031/article/details/91049130)(\u5176\u5b9e\u9006\u5e8f\u5bf9\u5c31\u662f\u6700\u7ecf\u5178\u7684\u4e8c\u7ef4\u504f\u5e8f(\u52a8\u6001\u9006\u5e8f\u5bf9\u5c31\u662f\u4e09\u7ef4\u504f\u5e8f)\n)\n\n\u53ef\u4ee5\u79bb\u6563\u5316,\u4e5f\u53ef\u4ee5\u4e0d\u79bb\u6563\u5316\n\n\u79bb\u6563\u5316\u5c31\u79bb\u6563$sum[i]$,$i$\u5929\u7136\u6709\u5e8f\n\n\u4e0d\u79bb\u6563\u5316\u5c31\u4ee5$sum[i]$\u4e3a\u7b2c\u4e00\u5173\u952e\u5b57,$i$\u4e3a\u7b2c\u4e8c\u5173\u952e\u5b57\u6392\u5e8f\n\n\u5916\u9762\u90fd\u5957\u4e2a\u6811\u72b6\u6570\u7ec4\u5373\u53ef\n\n\u4f46\u6211\u592a\u83dc\u4e86,\u7b2c\u4e00\u6b21\u5904\u7406\u6811\u72b6\u6570\u7ec4$0$\u57fa\u51c6\u7684\u60c5\u51b5($f[0] = 1$),\u72af\u4e86\u5f88\u591a\u9519\u624d\u8c03\u51fa\u6765,\u5177\u4f53\u770b\u4ee3\u7801\u5427\n\n\n\u79bb\u6563\u5316\u7248\n\n```cpp\n#include <iostream>\n#include <algorithm>\n#include <cstdio>\n#include <cstring>\n#include <queue>\n#define ll long long\nusing namespace std; \n\ntemplate <typename T> void in(T &x) {\n    x = 0; T f = 1; char ch = getchar();\n    while(!isdigit(ch)) {if(ch == '-') f = -1; ch = getchar();}\n    while( isdigit(ch)) {x = 10 * x + ch - 48; ch = getchar();}\n    x *= f;\n}\n\ntemplate <typename T> void out(T x) {\n    if(x < 0) x = -x , putchar('-');\n    if(x > 9) out(x/10);\n    putchar(x%10 + 48);\n}\n//-------------------------------------------------------\n\nconst int N = 1e5+7,mod = 1e9+9;\nint n;\nll b[N],ans;\n\nstruct node {\n\tint pos;ll sum;\n}p[N];\n\nstruct map {\n\tint pos;ll sum;\n\tbool operator < (const map &x) const {\n\t\treturn sum == x.sum ? pos < x.pos : sum < x.sum;//sum < x.sum;\n\t}\n}a[N];\n\nvoid A(int pos,ll k) {\n\tfor(int i = pos;i <= n;i += i&-i) b[i] = (b[i]+k)%mod;\n}\n\nll Q(int pos) {\n\tll res = 0;\n\tfor(int i = pos;i;i -= i&-i) res = (res + b[i])%mod;\n\treturn res;\n}\n\nint main() {\n\t//freopen(\"0.in\",\"r\",stdin);\n\t//freopen(\"my.out\",\"w\",stdout);\n\tint i; ll x;\n\tin(n);\n\ta[0].pos = a[0].sum = 0;\n\tfor(i = 1;i <= n; ++i) p[i].pos = i,in(x),p[i].sum = p[i-1].sum + x,a[i].pos = i,a[i].sum = p[i].sum;\n\tsort(a,a+n+1);//debug a[0]\n\tp[a[0].pos].sum = 1; int _id = 1;\n\tfor(i = 1;i <= n; ++i) {\n\t\tif(a[i].sum != a[i-1].sum) ++_id;//debug i-1\u8d8a\u754c \n\t\tp[a[i].pos].sum = _id;\n\t}\n\t//for(i = 1;i <= n; ++i) cout << p[i].sum << endl;\n\tA(p[0].sum,1);\n\tfor(i = 1;i <= n; ++i) {\n\t\tans = Q(p[i].sum);\n\t\tA(p[i].sum,ans);\n\t\tif(i == n) out(ans);\n\t\t//out(ans),putchar('\\n');\n\t}\n\t//out(ans);\n\treturn 0;\n}\n```\n\n\u4e0d\u79bb\u6563\u5316\u7248\n```cpp\n#include <iostream>\n#include <algorithm>\n#include <cstdio>\n#include <cstring>\n#include <queue>\n#define ll long long\nusing namespace std; \n\ntemplate <typename T> void in(T &x) {\n    x = 0; T f = 1; char ch = getchar();\n    while(!isdigit(ch)) {if(ch == '-') f = -1; ch = getchar();}\n    while( isdigit(ch)) {x = 10 * x + ch - 48; ch = getchar();}\n    x *= f;\n}\n\ntemplate <typename T> void out(T x) {\n    if(x < 0) x = -x , putchar('-');\n    if(x > 9) out(x/10);\n    putchar(x%10 + 48);\n}\n//-------------------------------------------------------\n\nconst int N = 1e5+7,mod = 1e9+9;\nint n;\nll b[N],ans;\nll f[N];\n\nstruct node {\n\tint pos;ll sum;\n\tbool operator < (const node &x) const {\n\t\treturn sum == x.sum ? pos < x.pos : sum < x.sum;\n\t}\n}p[N];\n\nvoid A(int pos,ll k) {\n\tfor(int i = pos;i <= n+1;i += i&-i) b[i] = (b[i]+k)%mod;//debug n+1 -> n\n}\n\nll Q(int pos) {\n\tll res = 0;\n\tfor(int i = pos;i;i -= i&-i) res = (res + b[i])%mod;\n\treturn res;\n}\n\nint main() {\n\t//freopen(\"0.in\",\"r\",stdin);\n\tint i; ll x;\n\tin(n);\n\tp[0].pos = 1,p[0].sum = 0;\n\tfor(i = 1;i <= n; ++i) p[i].pos = i+1,in(x),p[i].sum = p[i-1].sum + x;\n\tsort(p,p+n+1);\n\tfor(i = 0;i <= n; ++i) {\n\t\tif(p[i].pos == 1) A(p[i].pos,1);\n\t\tf[p[i].pos-1] = Q(p[i].pos);\n\t\tll x = f[p[i].pos-1];\n\t\t//if(p[i].pos == 1) A(p[i].pos,1);//debug//debug \n\t\tif(p[i].pos == 1) continue;\n\t\tA(p[i].pos,x);\n\t}\n\tout(f[n]);\n\t//for(i = 1;i <= n; ++i) cout << f[i] << endl;\n\treturn 0;\n}\n```\n\n\u8c22\u8c22\u5404\u4f4d\u770b\u5b98\u8001\u7237\u652f\u6301,\u5982\u679c\u89c9\u5f97\u8fd8\u770b\u5f97\u4e0b\u53bb\u7684\u8bdd,\u4e0d\u59a8\u70b9\u4e2a\u8d5e,\n~~\u6295\u4e2a\u5e01~~\uff08\u3065\uffe33\uffe3\uff09\u3065\u256d\u2764\uff5e\n\n\u53e6\u5916\u6709\u610f\u613f\u7684\u5927\u4f6c\u4eec\u53ef\u4ee5\u53bb\u5207\u4e00\u4e0b[\u8fd9\u9053\u9898](https://www.luogu.org/problem/P3431),\u4e00\u6837\u7684\u601d\u8def",
        "postTime": 1566358302,
        "uid": 109407,
        "name": "MZ_CXQ",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2344 \u3010\u5976\u725b\u6297\u8bae\u3011"
    },
    {
        "content": "~~\u4eca\u5929\u8003\u8bd5\u8003\u4e86,\u6211\u9009\u62e9BFS~~\n\n\u4ee3\u7801\u89e3\u91ca\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint n,lie[100001],zt[100001];//zt\u5b58\u5f53\u524d\u957f\u5ea6\u6709\u591a\u5c11\u79cd\u4e86\nbool ale[100001];//\u786e\u8ba4\u4e00\u4e0b\u5f53\u524d\u957f\u5ea6\u5728\u4e0d\u5728\u961f\u5217\u91cc\nlong long ans;\npriority_queue<int,vector<int>,greater<int> > e;\nvoid bfs(int now){\n\tlong long k=0;\n\tfor(int i=now+1;i<=n;i++){\n\t\tk+=lie[i];//\u4ece\u54ea\u6765\u7684\u52a0\u90a3\u4e2a\n\t\tif(k>=0){\n\t\t\tzt[i]+=zt[now];\n\t\t\tzt[i]%=1000000009;\n\t\t\tif(!ale[i]){\n\t\t\t\te.push(i);\n\t\t\t\tale[i]=1;//\u5728\u961f\u5217\u91cc\u5c31\u4e0d\u7528\u518d\u52a0\u4e86\n\t\t\t}\n\t\t}\n\t}\n}\nint main(){\n\tzt[0]=1;\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%d\",&lie[i]);\n\t}\n\te.push(0);//\u4ece0\u5f00\u59cb\u641c\u7d22\n\twhile(!e.empty()){\n\t\tbfs(e.top());e.pop();//\u5982\u679c\u961f\u5217\u91cc\u6709\u5c31\u641c,\u4ee5\u77ed\u7684\u4f18\u5148\n\t}\n\tcout<<zt[n];\n}\n\n```\n\n",
        "postTime": 1538638993,
        "uid": 59630,
        "name": "NTG_Adiord",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2344 \u3010\u5976\u725b\u6297\u8bae\u3011"
    },
    {
        "content": "[[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.org/problem/P2344)]\n\n\u8fd9\u9053\u9898\u672c\u849f\u84bb\u611f\u89c9\u4e0d\u592a\u597d\u60f3\uff0c\u4e8e\u662f\u4e4e\u5c31\u53d1\u7bc7\u535a\u5ba2\u52a0\u6df1\u4e00\u4e0b\u8bb0\u5fc6\uff0c\u4e5f\u65b9\u4fbf\u4ee5\u540e\u67e5\u770b\n\n\u9996\u5148\u56e0\u4e3a\u9898\u76ee\u4e2d\u8bf4\u5fc5\u987b\u662f\u8fde\u7eed\u7684\u4e00\u6bb5\uff0c\u5f88\u5bb9\u6613\u60f3\u5230\u8981\u7528\u524d\u7f00\u548c\uff0c\u5e76\u4e14\u770b\u8fc7\u6570\u636e\u8303\u56f4\u540e\u8981\u79bb\u6563\u5316\u4e00\u4e0b\n\n\u7136\u540e\u4f1a\u6709\u4e00\u4e2adp\u7684\u601d\u60f3\n\n\u5177\u4f53\u8bb2\u4e00\u4e0b\n```cpp\nadd(s[0], 1);//\u56e0\u4e3a s[0] \u6b64\u65f6\u8bb0\u5f55\u7684\u662f\u76f8\u5bf9\u5927\u5c0f\uff0c\u5373\u8868\u793a\u7406\u667a\u5ea6\u521a\u597d\u4e3a0\u65f6\uff0c\u65b9\u6848\u6570\u4e3a1\uff0c\u5148\u52a0\u5165\u6811\u72b6\u6570\u7ec4 \nfor (int i = 1; i <= n; i++) {\n\tans = query(s[i]);//\u67e5\u8be2\u524d\u9762\u6bd4\u81ea\u5df1\u5c0f\u7684\u524d\u7f00\u548c\n\tadd(s[i], ans);//\u7d2f\u52a0\u4e0a\u65b9\u6848\u6570 \n}\n```\n\u5f88\u591a\u4eba\u53ef\u80fd\u4f1a\u6709\u7591\u95ee\uff0c\u4e3a\u4ec0\u4e48\u8fd9\u91cc\u53ea\u67e5\u8be2\u6bd4\u81ea\u5df1\u5c0f\u7684\u5c31\u884c\u4e86\uff1f\u96be\u9053\u4e0d\u4f1a\u6709\u8d1f\u503c\u7684\u60c5\u51b5\u5417\uff1f\n\n\u8bf7\u770b\u8fd9\u4e00\u53e5\uff1a\n```cpp\nadd(s[0], 1);\n```\n\u56e0\u4e3a\u4f60\u79bb\u6563\u5316\u4e4b\u540e s[0] \u5c31\u53d8\u6210\u4e86\u76f8\u5bf9\u5927\u5c0f\uff0c\u5373\u8bb0\u5f55\u4e0b\u4e86\u7406\u667a\u5ea6\u4e3a0\u65f6\u7684\u76f8\u5bf9\u5927\u5c0f\uff0c\u6b64\u65f6\u65b9\u6848\u6570\u4e3a1\u3002\u5728\u6b64\u540e\u5982\u679c\u4f60\u52a0\u5165\u6bd4\u5b83\u5c0f\u7684\u503c\uff0c\u4e5f\u5c31\u662f\u7406\u667a\u5ea6\u5c0f\u4e8e0\u7684\u4e00\u6bb5\u65f6\uff0c\u5176\u65b9\u6848\u6570\u4f9d\u7136\u4e3a0\uff0c\u5e76\u4e0d\u4f1a\u5f71\u54cd\u4e0a\u9762\u7684\u503c\u3002\u6240\u4ee5\u5faa\u73af\u78b0\u5230 s[i] < 0 \u65f6\uff0cans = 0,\u5728\u52a0\u5165\u65f6\u589e\u52a0\u4f9d\u7136\u4e3a0\u3002\n\n\u597d\u6211\u4eec\u6765\u89e3\u51b3\u4e3a\u4ec0\u4e48\u52a0 \u6bd4\u81ea\u5df1\u5c0f\u7684\u503c \u7684\u95ee\u9898\n\n\u5c31\u662f\u8bf4\uff0c\u56e0\u4e3a\u8981dp\u5c06\u524d\u9762\u5206\u6210\u597d\u51e0\u6bb5\u6765\u7d2f\u52a0\uff0c\u6240\u4ee5\u5f53\u524d\u4e00\u4e2a\u503c\u5927\u4e8e\u81ea\u5df1\u65f6\uff0c\u4ee3\u8868\u8fd9\u4e4b\u95f4\u4e00\u5b9a\u51fa\u73b0\u4e86\u8d1f\u503c\uff0c\u518d\u8fdb\u884c\u7d2f\u52a0\u5c31\u4e0d\u6b63\u786e\u4e86\uff0c\u6240\u4ee5\u52a0\u6bd4\u81ea\u5df1\u5c0f\u7684\u503c\u3002\n\n\u53e6\u5916\u56e0\u4e3a\u662fdp\u6240\u4ee5\u5c06\u5f53\u524d\u65b9\u6848\u6570\u52a0\u5230\u5f53\u524d\u503c\u4e0a\uff0c\u7136\u540e\u52a0\u5165\u6811\u72b6\u6570\u7ec4\n\n\u597d\u4e86\u597d\u4e86\uff0c\u770b\u770b\u4ee3\u7801\u5c31\u6e05\u695a\u4e86\n\n~~\u5176\u5b9e\u81ea\u5df1\u8bb2\u7684\u5565\u90fd\u4e0d\u662fqwq~~\n\n**code:**\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int p = 1000000009;\nint n, ans;\nint c[100021], a[100021], s[100021];\nvoid add(int x, int v) {//\u6811\u72b6\u6570\u7ec4\u7528\u6765\u7ef4\u62a4\u65b9\u6848\u6570 \n\tfor (int i = x; i <= n + 1; i += i & -i) {\n\t\tc[i] += v;\n\t\tc[i] %= p;\n\t}\n}\nint query(int x) {\n\tint re = 0;\n\tfor (int i = x; i > 0; i -= i & -i) {\n\t\tre += c[i];\n\t\tre %= p;\n\t}\n\treturn re;\n}\nint main () {\n\tscanf(\"%d\", &n);\n\tfor (int i = 1; i <= n; i++) {\n\t\tscanf(\"%d\", &s[i]);\n\t\ts[i] += s[i - 1];//\u8bb0\u5f55\u524d\u7f00\u548c \n\t\ta[i] = s[i];//\u53e6\u5f00\u4e00\u4e2a\u6570\u7ec4\u7528\u4e8e\u79bb\u6563\u5316 \n\t}\n\tsort(a, a + 1 + n);//\u6392\u5e8f \n\tfor (int i = 0; i <= n; i++) {//\u79bb\u6563\u5316 \n\t\ts[i] = lower_bound(a, a + 1 + n, s[i]) - a + 1;\n\t}\n\tadd(s[0], 1);//\u56e0\u4e3a s[0] \u6b64\u65f6\u8bb0\u5f55\u7684\u662f\u76f8\u5bf9\u5927\u5c0f\uff0c\u5373\u8868\u793a\u7406\u667a\u5ea6\u521a\u597d\u4e3a0\u65f6\uff0c\u65b9\u6848\u6570\u4e3a1\uff0c\u5148\u52a0\u5165\u6811\u72b6\u6570\u7ec4 \n\tfor (int i = 1; i <= n; i++) {\n\t\tans = query(s[i]);//\u67e5\u8be2\u524d\u9762\u6bd4\u81ea\u5df1\u5c0f\u7684\u524d\u7f00\u548c\n\t\tadd(s[i], ans);//\u7d2f\u52a0\u4e0a\u65b9\u6848\u6570 \n\t}\n\tprintf(\"%d\\n\", ans % p);\n\treturn 0;\n}\n```\n",
        "postTime": 1569643065,
        "uid": 155944,
        "name": "Sundial",
        "ccfLevel": 0,
        "title": "LuoguP2344\u5976\u725b\u6297\u8bae"
    },
    {
        "content": "\u8fd9\u9053\u9898\u76ee\uff0c\u662f\u4e00\u9053\u6709\u70b9\u523a\u6fc0\u7684\u6570\u636e\u7ed3\u6784\u4f18\u5316 $dp$ \u9898\u3002\r\n\r\n#### \u5982\u4f55\u60f3\u5230 $dp$:\r\n\r\n\u6211\u4eec\u770b\u5230\uff0c\u8fd9\u9053\u9898\u662f\u4e00\u4e2a\u6c42\u65b9\u6848\u6570\u91cf\u7684\u9898\u76ee\uff0c\u90a3\u4e48\u53ea\u6709\u9012\u63a8\uff08\u4e5f\u5c31\u662f\u7b80\u5355 $dp$\uff09\u548c\u641c\u7d22\u8fd9\u4e24\u79cd\u65b9\u5f0f\uff0c\u800c\u6211\u4e0d\u559c\u6b22\u6253\u641c\u7d22\uff0c\u5c31\u7528 $dp$ \u4e86\u3002\r\n\r\n#### \u5982\u4f55\u8bbe\u8ba1 $dp$:\r\n\r\n\u6211\u4eec\u77e5\u9053\uff0c\u9898\u76ee\u4e2d\u8981\u6c42\u5bf9\u5e8f\u5217\u8fdb\u884c\u5206\u7ec4\uff0c\u90a3\u4e48\u5c31\u662f\u4e00\u9053\u6709\u5173\u5b50\u5e8f\u5217\u7684\u95ee\u9898\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u60f3\u5230\uff0c\u4e00\u6bb5\u5b50\u5e8f\u5217\u662f\u4e24\u4e2a\u5b50\u5e8f\u5217\u7684\u5dee\u96c6\uff0c\u5373$[l,r]$ \u662f $[1,r]$ \u548c $[1,l]$ \u7684\u5dee\u96c6\uff0c\u6240\u4ee5\u53ef\u4ee5\u8bbe\u8ba1\u5173\u4e8e\u524d\u7f00\u7684 $dp$ \uff08\u8fd9\u6bb5\u8bdd\u9002\u7528\u4e8e\u5927\u591a\u6570\u5b50\u5e8f\u5217\u7684\u9898\u76ee\uff09\r\n\r\n\u6240\u4ee5\uff0c\u8bbe $f[i]$\u8868\u793a\u5c06$a_{1 \\dots i}$ \u5206\u7ec4\u7684\u65b9\u6848\u6570\u3002\r\n\r\n\u90a3\u4e48\uff0c\u6211\u4eec\u53ea\u8981\u627e\u5230\u4e00\u4e2a$[1,i]$\u7684\u540e\u7f00$[k+1,i]$\uff0c\u6ee1\u8db3\u5176\u4e2d\u6240\u6709\u6570\u4e4b\u548c\u4e0d\u5c0f\u4e8e0\uff0c\u90a3\u4e48\u5728\u5408\u6cd5\u7684\u5206\u7ec4\u65b9\u6848\u4e2d\uff0c\u4e00\u5b9a\u6709\u8fd9\u4e00\u6bb5\u88ab\u4f5c\u4e3a\u6700\u540e\u4e00\u7ec4\u7684\u60c5\u51b5\u3002\r\n\r\n\u90a3\u4e00\u5171\u6709\u591a\u5c11\u8fd9\u79cd\u65b9\u6848\u5462\uff1f\r\n\r\n\u5728\u8fd9\u79cd\u65b9\u6848\u4e0b\uff0c\u6211\u4eec\u8981\u8ba9$[1,k]$ \u4e5f\u7b26\u5408\u8981\u6c42\uff0c\u56e0\u4e3a\u5728\u8fd9\u91cc\u540e\u7f00\u662f\u56fa\u5b9a\u7684\uff0c\u6240\u4ee5\u60c5\u51b5\u6570\u5c31\u662f\u8ba9$[1,k]$\u7b26\u5408\u8981\u6c42\u7684\u65b9\u6848\u6570\u3002\r\n\r\n\u5c31\u662f$f[k]$\r\n\r\n\u6240\u4ee5\uff0c\u6211\u4eec\u7684\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5c31\u5199\u51fa\u6765\u4e86\u3002\r\n\r\n$$f[i]=\\sum\\limits_{a_{k+1}+a_{k+2}+\\dots+a_i\\ge 0,k \\le i}f[k]$$\r\n\r\n\uff08\u5176\u5b9e\u4e0a\u9762\u5570\u55e6\u4e00\u5927\u5806\uff0c\u662f\u4e3a\u4e86\u8ba9\u5404\u4f4d\u770b\u5b98\u83b7\u5f97\u4e00\u4e2a\u666e\u9002\u5316\u7684\u601d\u7ef4\u65b9\u5f0f\uff09\r\n\r\n\u7b80\u5316\u4e00\u4e0b\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff0c\u4ee4 $sum[i]=\\sum\\limits_{j=1}^i a[j]$\uff0c\u5219\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u53ef\u4ee5\u5199\u6210\uff1a\r\n$$f[0]=1,f[i]=\\sum\\limits_{sum[i] \\ge sum[k],k \\le i}f[k]$$\r\n\r\n\u66b4\u529b\u679a\u4e3e $i,k$ \u7684\u8bdd\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\Theta(n^2)$\r\n\r\n\u7136\u800c\uff0c\u8981\u662f $n$ \u518d\u5c0f\u70b9\u5c31\u597d\u4e86.......\r\n\r\n$n \\le 2\\times 10^5$\r\n\r\n\u770b\u5230\u8fd9\u4e2a\u8303\u56f4\uff0c\u4f60\u624d\u77e5\u9053\u8fd9\u4e3a\u4ec0\u4e48\u662f\u84dd\u9898\u3002\r\n\r\n\r\n---\r\n\r\n#### \u5982\u4f55\u4f18\u5316\u65f6\u95f4\uff1a\r\n\r\n\u6211\u4eec\u53ef\u4ee5\u65b0\u5efa\u4e00\u4e2a\u5e8f\u5217$q$ \u5176\u4e2d$q[sum[i]]=f[i],i\\in[0,n]$\r\n\r\n\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u4e0b\u6807$i$,\u4ece\u5de6\u5230\u53f3\u626b\u63cf\u3002\uff08\u8fd9\u6837\u5c31\u5929\u7136\u6ee1\u8db3\u4e86\u65b9\u7a0b\u4e2d$k \\le i$\u8fd9\u4e00\u6761\u4ef6\uff09\r\n\r\n\u90a3\u4e48\u5bf9\u4e8e$f[i]$\u800c\u8a00\uff0c\u6211\u4eec\u53ea\u8981\u6c42$\\sum\\limits_{j=\\min\\{sum[k]\\}}^{sum[i]}q[j]$,\u6c42\u5b8c\u4e4b\u540e\u518d\u8ba9$q[sum[i]]\\leftarrow f[i]$.(\u5176\u4e2d$\\min\\{sum[k]\\}$\u662f\u6307\u6240\u6709$sum$\u4e2d\u7684\u6700\u5c0f\u503c\uff09\r\n\r\n\u90a3\u4e48\uff0c\u8fd9\u5c31\u662f\u4e2a\u5355\u70b9\u4fee\u6539\uff0c\u8be2\u95ee\u524d\u7f00\u548c\u7684\u9898\u76ee\uff0c\u53ef\u4ee5\u7528\u6811\u72b6\u6570\u7ec4\u6c42\u89e3.\r\n\r\n\u4f46\u662f\uff0c\u6211\u4eec\u53d1\u73b0\uff0c$-10^9\\le sum[i]\\le 10^9,i \\in[1,n]$\uff0c\u662f\u5b8c\u5168\u6ca1\u6cd5\u7528\u666e\u901a\u6570\u7ec4\u505a\u7684\u3002\r\n\r\n\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a\u6570\u7684\u6392\u540d\u4ee3\u66ff\u8fd9\u4e2a\u6570\uff08\u6392\u540d\u5b9a\u4e49\u4e3a\u6bd4\u5b83\u5c0f\u7684\u4e2a\u6570\u52a01\uff09\r\n\r\n\u6211\u4eec\u77e5\u9053\uff0c\u8fd9\u6837\u5b50\u7684\u8bdd\uff0c\u5728\u67d0\u4e2a\u6570\u524d\u9762\u7684\u6570\u8fd8\u662f\u5728\u67d0\u4e2a\u6570\u524d\u9762\uff0c\u7ed3\u679c\u4e0d\u4f1a\u6709\u6539\u53d8\u3002\r\n\r\n\u5176\u5b9e\u8fd9\u4e2a\u8fc7\u7a0b\u5c31\u662f\u79bb\u6563\u5316\uff08\u5c06\u65e0\u9650\u7a7a\u95f4\u91cc\u7684\u6709\u9650\u4e2a\u4f53\u6620\u5c04\u5230\u6709\u9650\u7a7a\u95f4\u4e2d\uff09\r\n\r\n\u8fd9\u79cd\u4ee3\u66ff\u65b9\u5f0f\u6700\u4e3a\u5e38\u7528\uff0c\u4e5f\u597d\u5199\u3002\r\n\r\n\u4f46\u662f\uff0c\u6211\u4eec\u6620\u5c04\u7684\u65f6\u5019\u8981\u52a0\u4e0a0\u53f7\u7ed3\u70b9\uff0c\u56e0\u4e3a\u6709\u4e00\u70b9:$f[0]=1$\r\n\r\n\u5982\u4f55\u6c42\u4e00\u4e2a\u6570\u7684\u6392\u540d\uff1f\r\n\r\n\u6392\u5e8f\u4e4b\u540e\u770b\u5b83\u7684\u4e0b\u6807\uff0c\u53ef\u4ee5\u7528\u4e8c\u5206\u67e5\u627e\uff0c\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u3002\r\n\r\n---\r\n#### \u4ee3\u7801\uff1a\r\n\r\n\u5404\u4f4d\u770b\u5b98\uff0c\u968f\u6211\u6765\uff01\r\n\r\n```cpp\r\n#include<bits/stdc++.h>\r\nusing namespace std;\r\nconst int N=1e5+5;\r\nint a[N],sum[N],vals[N],n,b[N],mod=1e9+9;\r\n/*\r\n\ta\u4e3a\u539f\u5e8f\u5217\r\n    sum \u4e3a\u524d\u7f00\u548c\r\n    vals\u4e3a\u4e00\u4e2a\u9644\u52a0\u7a7a\u95f4\uff0c\u7528\u6765\u5b58\u6392\u5e8f\u4e4b\u540e\u7684sum\r\n    b \u4e3a\u79bb\u6563\u5316\u540e\u7684\u5e8f\u5217\r\n*/\r\nint f[N];\r\n#define lowbit(x) (x&(-x))\r\nint tr[N];\r\n//\r\ninline void update(int pos,int num)   //\u6811\u72b6\u6570\u7ec4\u5355\u70b9\u4fee\u6539\r\n{\r\n\tint x=pos;\r\n\twhile(x<=n)\r\n\t{\r\n\t\ttr[x]+=num;\r\n\t\ttr[x]%=mod;\r\n\t\tx+=lowbit(x);\r\n\t}\r\n}\r\ninline int _sum(int pos)   //\u6811\u72b6\u6570\u7ec4\u6c42\u524d\u7f00\u548c\r\n{\r\n\tint res=0,x=pos;\r\n\twhile(x)\r\n\t{\r\n\t\t(res+=tr[x])%=mod;\r\n\t\tx-=lowbit(x);\r\n\t}\r\n\treturn res;\r\n}\r\nint tot=0;\r\nint main()\r\n{\r\n\tscanf(\"%d\",&n);\r\n\tfor(int i=1;i<=n;i++)\r\n\t{\r\n\t\tscanf(\"%d\",&a[i]);\r\n\t\tsum[i]=sum[i-1]+a[i];\r\n\t}\r\n//------------------\u8bfb\u5165\uff0c\u9884\u5904\u7406--------------------\r\n\tfor(int i=0;i<=n;i++)  //\u8bb0\u5f97\u52a0\u4e0a0\r\n\tvals[++tot]=sum[i];     \r\n\tsort(vals+1,vals+tot+1);  //\u6392\u5e8f\r\n\ttot=unique(vals+1,vals+tot+1)-vals-1;  //\u53bb\u91cd\uff0c\u5426\u5219\u76f8\u540c\u7684\u6570\u6392\u540d\u4e0d\u540c\r\n\tfor(int i=0;i<=n;i++)\r\n\tb[i]=lower_bound(vals+1,vals+tot+1,sum[i])-vals;  //\u4e8c\u5206\u67e5\u627e\r\n//------------------\u79bb\u6563\u5316----------------------------\r\n\tupdate(b[0],f[0]=1);   //\u52a0\u51650\u53f7\u7ed3\u70b9\r\n\tfor(int i=1;i<=n;i++)\r\n\t{\r\n\t\tf[i]=_sum(b[i]);   //\u6c42\u51fa q \u5e8f\u5217\u4e2d\u7684\u524d\u7f00\u548c\r\n\t\tupdate(b[i],f[i]);   //\u4ee4q[b[i]]=f[i]\r\n\t}\r\n\tcout<<f[n]<<endl;   //\u8f93\u51fa\u7b54\u6848\r\n    return 2147483647;\r\n}\r\n```\r\n\r\n\u6709\u95ee\u9898\u8bf7\u8bc4\u8bba\uff0c\u4e0d\u559c\u52ff\u55b7\u3002",
        "postTime": 1597841062,
        "uid": 226435,
        "name": "\u5929\u547d\u4e4b\u8def",
        "ccfLevel": 0,
        "title": "P2344 [USACO11FEB]Generic Cow Protests G \u9898\u89e3"
    },
    {
        "content": "### \u5927\u5bb6\u597d\uff0c\u6211\u559c\u6b22\u679a\u4e3e\uff0c\u6211\u7528n^2\u66b4\u529b\uff08\u6c34\uff09\u8fc7\u4e86\u6b64\u9898.\n[\u8bc4\u6d4b\u8bb0\u5f55](https://www.luogu.org/recordnew/show/20679692)\n\n\u8fd9\u662f\u4e00\u9053dp\uff0cf[i]\u8868\u793a\u524di\u5934\u5976\u725b\u5206\u7ec4\u7684\u65b9\u6848\u6570\n\n\u663e\u7136f[i] = sum f[j] (s[j] < s[i])(s\u662f\u524d\u7f00\u548c)\n\n\u4e0b\u9762\u8bf4\u6b63\u89e3\n\n\u6211\u4eec\u53d1\u73b0\u53ef\u4ee5\u7528\u6743\u503c\u7ebf\u6bb5\u6811\u6bcf\u6b21\u7edf\u8ba1\u5c0f\u4e8es[i]\u7684f[j]\u7684\u548c\u3002\n\n\u53ef\u4ee5\u7528\u6811\u72b6\u6570\u7ec4\u5b9e\u73b0\uff08\u522b\u5fd8\u4e86\u79bb\u6563\u5316\uff09\n\n## code\n### \u66b4\u529b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define R register int\n#define For(i , x , y) for(i = x ; i <= y ; ++ i)\nconst int N = 1e5 + 5 , P = 1000000009;\ninline ll read() {\n    ll s = 0 , w = 1; char ch = getchar();\n    while(ch < 48 || ch > 57) {if(ch == '-') w = -1; ch = getchar();}\n    while(ch >= 48 && ch <= 57) s = (s << 1) + (s << 3) + (ch ^ 48) , ch = getchar();\n    return s * w;\n}\nll n , f[N] , a[N] , s[N] , c[N];\nint main() {\n    R i , j ;\n    n = read();\n    For(i , 1 , n) a[i] = read() , s[i] = s[i - 1] + a[i];\n    f[0] = 1;\n    For(i , 1 , n)\n        if(s[i] >= 0) \n            For(j , 0 , i - 1)\n                if(s[j] >= 0 && s[i] - s[j] >= 0) (f[i] += f[j])%=P;\n    cout << f[n] << endl;\n    return 0;\n}\n```\n\n### \u6b63\u89e3\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define R register int\n#define For(i , x , y) for(i = x ; i <= y ; ++ i)\n#define lowbit(x) x & -x\nconst int N = 2e5 + 5 , P = 1000000009 ;\ninline ll read() {\n    ll s = 0 , w = 1; char ch = getchar();\n    while(ch < 48 || ch > 57) {if(ch == '-') w = -1; ch = getchar();}\n    while(ch >= 48 && ch <= 57) s = (s << 1) + (s << 3) + (ch ^ 48) , ch = getchar();\n    return s * w;\n}\nll n , f[N] , a[N] , b[N] , s[N] , c[N];\ninline void update(ll x , ll val) {\n    while(x <= n) (c[x] += val)%=P , x += lowbit(x);\n}\ninline ll query(ll x) {\n    ll ans = 0;\n    while(x) (ans += c[x])%=P , x -=lowbit(x);\n    return ans%P;\n}\n\nint main() {\n    R i , j ;\n    n = read();\n    For(i , 1 , n) b[i] = s[i] = s[i - 1] + read();\n    sort(b + 1 , b + n + 1);\n    ll cnt = unique(b + 1 , b + n + 1) - b - 1;\n    For(i , 1 , n) a[i] = lower_bound(b + 1 , b + cnt + 1 , s[i]) - b; \n    f[0] = 1;\n    For(i , 1 , n) \n        if(s[i] >= 0){\n            f[i] = 1; update(a[i] , f[i]);++ i;break;\n        }\n    \n    while(i <= n) {\n        if(s[i] >= 0) {\n            f[i] = (query(a[i]) + 1)%P;\n             update(a[i] , f[i]);\n        }\n        ++ i;\n    }\n    cout << f[n] << endl;\n    return 0;\n}\n\n```\n",
        "postTime": 1562919447,
        "uid": 80852,
        "name": "\u7a0b\u5c31\u672a\u6765",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2344 \u3010\u5976\u725b\u6297\u8bae\u3011"
    },
    {
        "content": "```cpp\n**\u8865\u4e00\u53d1\u6811\u72b6\u6570\u7ec4\u7684\u9898\u89e3**\n**~~\u6458\u81ea\u673a\u623f\u5341\u7ea7\u7237~~**\n//\u7c7b\u4f3c\u4e8edp\u601d\u60f3  \uff0csum[i]\u8868\u793a\u4ee5i\u7ed3\u5c3e\u7684\u8bdd \uff0c\u5f53\u524dans\u7684\u65b9\u6848\u6570 \n/*\u6211\u4eec\u8003\u8651\u4e00\u4e0b\u8fd9\u4e2a\u95ee\u9898 \uff0c\u7531\u4e8e\u9898\u76ee\u4e2d\u8bf4\u4e86 \uff0c \u53ea\u80fd\u662f\u8fde\u7eed\u7684\u4e00\u6bb5 \uff0c \u6240\u4ee5\u6211\u4eec\u5f88\u81ea\u7136\u7684\u60f3\u5230\u4e86 \n\u524d\u7f00\u548c\u7684\u5f62\u5f0f \uff0c\u7531\u4e8e\u6570\u636e\u592a\u5927 \uff0c\u6240\u4ee5\u91c7\u7528\u79bb\u6563\u5316 \uff0c \u5bf9\u4e8e\u6bcf\u4e00\u79cd\u5206\u6cd5 \uff0c \u4e5f\u5c31\u662fsum[i]\u6709\u4e24\u79cd\u53ef\u80fd \uff0c\n\u4e3a\u6b63\u6216\u4e3a\u8d1f \uff0c \u7531\u4e8e\u6211\u4eec\u79bb\u6563\u5316\u4e86\uff0c \u6240\u4ee5\u4e3a\u8d1f\u7684\u70b9 \u5728sum\u30100\u3011\u7684\u5de6\u8fb9 \uff0c \u4e3a\u6b63\u7684\u70b9\u5728sum\u30100\u3011\u53f3\u8fb9 \u3002\n\u6240\u4ee5\u5728\u53f3\u8fb9\u7684 \uff0c \u53ef\u4ee5\u5bf9\u7b54\u6848\u505a\u51fa\u8d21\u732e \uff0c \u6240\u4ee5\u628a sum\u30100\u3011 \u521d\u59cb\u5316\u4e3a 1 \uff1b\n//sum[0] \u5de6\u8fb9 \uff0c \u4e3a\u8d1f \uff0c \u524d\u7f00\u548c\u4e3a\u96f6 \uff0c \u6240\u4ee5\u4ed6\u7684ans\u6bcf\u6b21\u90fd\u4e3a\u96f6 \uff0c \u5982\u679c\u8fd9\u4e2a\u5e8f\u5217\u6700\u540e\u76f8\u52a0\u5c0f\u4e8e\u96f6 \uff08sum[n])\u5c0f\u4e8e\n\u96f6\u7684\u8bdd \uff0c \u7b54\u6848\u5c31\u662f\u96f6 \uff0c \u5982\u679c\u6700\u540e\u4e3a\u6b63 \uff0c\u90a3\u4e48\u5bf9\u4e8e\u4ee5\u540e\u7684\u4e5f\u6ca1\u6709\u4ec0\u4e48\u5f71\u54cd...\uff08\u56e0\u4e3a\u524d\u7f00\u548c\u76f8\u52a00\uff09 \n\u5728sum\u30100\u3011\u53f3\u8fb9 \uff0c\u90a3\u4e48\u5c31\u4e3a\u6b63 \uff0c\u6bcf\u6b21\u52a0\u4e0a\u524d\u7f00\u548c\uff0c\u4e3a\u4ec0\u4e48\u662f\u524d\u7f00\u548c \n\u5c31\u6bd4\u5982\u4e0b\u9762 \nsum[1] = 1  ans = 1; \nsum[2] = 0  ans = 0;\nsum[3] = 5  ans = 2;\n\u56e0\u4e3a\u5728sum[3]\u7684\u65f6\u5019 2 + \uff13\u4e5f\u662f\u53ef\u4ee5\u6784\u6210\u5355\u72ec\u7684\u4e00\u7ec4\uff0c\u6240\u4ee5\u65b9\u6848\u6570\u9700\u8981\u7d2f\u52a0 \n\n \n```\n```cpp\n#include<bits/stdc++.h>\nusing namespace s td;\nint a[100020] , sum[100020];\nconst int p = 1000000009;\nint n ;\nint c[100020];\nvoid add(int x ,int y){\n\tfor(int i = x; i <= n + 1; i += (i & (-i))){\n\t\tc[i] += y;\n\t\tc[i] %= p;\n\t}\n}\nint Sum(int x){\n\tint re = 0;\n\tfor(int i = x ; i > 0 ; i -= (i & (-i))){\n\t\tre =(re + c[i]) % p;\n\t}\n\treturn re % p;\n}\nlong long  ans;\nint main () {\n\tscanf(\"%d\" , &n);\n\tfor(int i = 1 ; i <= n ; i++){\n\t   scanf(\"%d\",&sum[i]);\n\t   sum[i] += sum[i - 1];\n \t   a[i] = sum[i];\n\t}\n     int m = n;\n\t sort(a  , a + 1 + m);\n\t m = unique(a , a + m + 1 )  - a; \n\t for(int i = 0 ;i <= n;i++){\n\t \tsum[i] = lower_bound(a , a + m+1 , sum[i]) -  a + 1;\n\t }\t\n\t add(sum[0] , 1);\n\t for(int i = 1 ; i <= n ; i++){\n\t \tans = Sum(sum[i]);\n\t \tadd(sum[i] , ans);\n\t }\n\t cout << ans % p << endl;\n}\n```\n",
        "postTime": 1569641987,
        "uid": 155958,
        "name": "wmjlzw1314",
        "ccfLevel": 3,
        "title": "P2344 \u5976\u725b\u6297\u8bae -\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4dp"
    },
    {
        "content": "~~USACO\u7684\u9898\u592a\u731b\u4e86~~\n\n~~\u8ba9\u672c\u849f\u84bb\u628a\u6811\u72b6\u6570\u7ec4\u505a\u6cd5\u518d\u8bb2\u8be6\u7ec6\u4e00\u70b9\u5427~~\n\n\u9996\u5148\u5bb9\u6613\u60f3\u5230$DP$\uff0c\u8bbe$f[i]$\u8868\u793a\u4e3a\u5728\u7b2c$i$\u4f4d\u65f6\u65b9\u6848\u6570\uff0c\u8f6c\u79fb\u65b9\u7a0b\uff1a\n$$\nf[i]=\\sum f[j]\\;(j< i,sum[i]-sum[j]\\ge0)\n$$\n$O(n^2)$\u8fc7\u4e0d\u4e86\uff0c\u8003\u8651\u4f18\u5316\n\n\u79fb\u9879\u5f97\uff1a\n$$\nf[i]=\\sum f[j]\\;(j< i,sum[i]\\ge sum[j])\n$$\n\u8fd9\u65f6\u5019\u6211\u4eec\u53d1\u73b0\u76f8\u5f53\u4e8e\u6c42\u5728$i$\u524d\u9762\u5e76\u4e14\u524d\u7f00\u548c\u5c0f\u4e8e$sum[i]$\u7684\u6240\u6709$f[i]$\u548c\uff0c\u8fd9\u5c31\u53ef\u4ee5\u7528\u4e00\u4e2a\u6811\u72b6\u6570\u7ec4\u4f18\u5316\u4e86\uff0c\u5728\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u4e0b\u6807\u4e3a$sum[i]$\uff0c$f[i]$\u7684\u524d\u7f00\u548c\u3002\u5bf9\u4e8e\u6bcf\u4e2a$f[i]$\u5373\u4e3a\u6811\u72b6\u6570\u7ec4\u4e0a$sum[i]$\u7684\u524d\u7f00\u548c\u3002\n\n\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\u524d\u7f00\u548c\u53ef\u80fd\u4e3a\u8d1f\uff0c\u800c\u6811\u72b6\u6570\u7ec4\u4e0b\u6807\u4e0d\u80fd\u4e3a\u8d1f\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u79bb\u6563\u5316\u4e00\u4e0b\u3002\n\n```cpp\n#include <cstdio>\n#include <algorithm>\nusing namespace std;\n#define MAXN 100010\n#define lowbit(x) ((x)&(-(x)))\n#define MOD 1000000009\nint n,sum[MAXN],s;\nint sum_sort[MAXN+1];\nint tre[MAXN+1];\ninline void add(int x, int val){\n    while(x<=s){\n        tre[x]=(tre[x]+val)%MOD;\n        x+=lowbit(x);\n    }\n}\ninline int get_sum(int x){\n    int res=0;\n    while(x>0){\n        res=(res+tre[x])%MOD;\n        x-=lowbit(x);\n    }\n    return res;\n}\nint main(){\n    scanf(\"%d\", &n);\n    for(int i=1;i<=n;++i)\n        scanf(\"%d\", &sum[i]),sum[i]+=sum[i-1];\n    for(int i=1;i<=n;++i) sum_sort[i]=sum[i];\n    sort(sum_sort, sum_sort+1+n);\n    s=unique(sum_sort, sum_sort+1+n)-sum_sort;\n    for(int i=0;i<=n;++i) sum[i]=lower_bound(sum_sort, sum_sort+s, sum[i])-sum_sort+1;\n    add(sum[0], 1); // f[0]=1 \u8ba1\u6570dp\u521d\u59cb\u5316\n    int ans=0;\n    for(int i=1;i<=n;++i){\n        ans=get_sum(sum[i]); // \u83b7\u5f97f[i]\n        add(sum[i], ans); // \u7ef4\u62a4\u6811\u72b6\u6570\u7ec4\n    }\n    printf(\"%d\\n\", ans);\n    return 0;\n}\n```\n\n\n\n\n",
        "postTime": 1573558789,
        "uid": 63896,
        "name": "Santiego",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2344 \u3010\u5976\u725b\u6297\u8bae\u3011"
    },
    {
        "content": "## \u3010\u9898\u76ee\u80cc\u666f\u3011\n\nGeneric Cow Protests, 2011 Feb\n\n## \u3010\u9898\u76ee\u63cf\u8ff0\u3011\n\n\u7ea6\u7ff0\u5bb6\u7684N \u5934\u5976\u725b\u6b63\u5728\u6392\u961f\u6e38\u884c\u6297\u8bae\u3002\u4e00\u4e9b\u5976\u725b\u60c5\u7eea\u6fc0\u52a8\uff0c\u7ea6\u7ff0\u6d4b\u7b97\u4e0b\u6765\uff0c\u6392\u5728\u7b2ci \u4f4d\u7684\u5976\u725b\u7684\u7406\u667a\u5ea6\u4e3aAi\uff0c\u6570\u5b57\u53ef\u6b63\u53ef\u8d1f\u3002\n\n\u7ea6\u7ff0\u5e0c\u671b\u5976\u725b\u5728\u6297\u8bae\u65f6\u4fdd\u6301\u7406\u6027\uff0c\u4e3a\u6b64\uff0c\u4ed6\u6253\u7b97\u5c06\u8fd9\u6761\u961f\u4f0d\u5206\u5272\u6210\u51e0\u4e2a\u5c0f\u7ec4\uff0c\u6bcf\u4e2a\u6297\u8bae\u5c0f\u7ec4\u7684\u7406\u667a\u5ea6\u4e4b\u548c\u5fc5\u987b\u5927\u4e8e\u6216\u7b49\u4e8e\u96f6\u3002\u5976\u725b\u7684\u961f\u4f0d\u5df2\u7ecf\u56fa\u5b9a\u4e86\u524d\u540e\u987a\u5e8f\uff0c\u6240\u4ee5\u4e0d\u80fd\u4ea4\u6362\u5b83\u4eec\u7684\u4f4d\u7f6e\uff0c\u6240\u4ee5\u5206\u5728\u4e00\u4e2a\u5c0f\u7ec4\u91cc\u7684\u5976\u725b\u5fc5\u987b\u662f\u8fde\u7eed\u4f4d\u7f6e\u7684\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u5206\u7ec4\u591a\u5c11\u7ec4\uff0c\u6bcf\u7ec4\u5206\u591a\u5c11\u5976\u725b\uff0c\u90fd\u6ca1\u6709\u9650\u5236\u3002\n\n\u7ea6\u7ff0\u60f3\u77e5\u9053\u6709\u591a\u5c11\u79cd\u5206\u7ec4\u7684\u65b9\u6848\uff0c\u7531\u4e8e\u7b54\u6848\u53ef\u80fd\u5f88\u5927\uff0c\u53ea\u8981\u8f93\u51fa\u7b54\u6848\u9664\u4ee51000000009\n\n \u7684\u4f59\u6570\u5373\u53ef\u3002\n\n**\u3010\u8f93\u5165\u683c\u5f0f\u3011**\n\n\u2022 \u7b2c\u4e00\u884c\uff1a\u5355\u4e2a\u6574\u6570N\uff0c1\u2264*N*\u2264100000\n\n\n\n\u2022 \u7b2c\u4e8c\u884c\u5230\u7b2cN + 1 \u884c\uff1a\u7b2ci + 1 \u884c\u6709\u4e00\u4e2a\u6574\u6570Ai\uff0c\u2212105\u2264*A**i*\u2264105\n\n\n\n**\u3010\u8f93\u51fa\u683c\u5f0f\u3011**\n\n\u5355\u4e2a\u6574\u6570\uff1a\u8868\u793a\u5206\u7ec4\u65b9\u6848\u6570\u6a211000000009\n\n \u7684\u4f59\u6570\n\n**\u3010\u8f93\u5165\u6837\u4f8b\u3011**\n\n```\n4\n2\n3\n-3\n1\n```\n\n**\u3010\u8f93\u51fa\u6837\u4f8b\u3011** \n\n```\n4  \n```\n\n## \u8bf4\u660e\uff1a\n\n\u89e3\u91ca:\u5982\u679c\u5206\u4e24\u7ec4\uff0c\u53ef\u4ee5\u628a\u524d\u4e09\u5934\u5206\u5728\u4e00\u7ec4\uff0c\u6216\u628a\u540e\u4e09\u5934\u5206\u5728\u4e00\u7ec4\uff1b\u5982\u679c\u5206\u4e09\u7ec4\uff0c\u53ef\u4ee5\u628a\u4e2d\u95f4\u4e24\u5934\u5206\u5728\u4e00\u7ec4\uff0c\u7b2c\u4e00\u548c\u6700\u540e\u4e00\u5934\u5976\u725b\u81ea\u6210\u4e00\u7ec4\uff1b\u6700\u540e\u4e00\u79cd\u5206\u6cd5\u662f\u628a\u56db\u5934\u5976\u725b\u5206\u5728\u540c\u4e00\u7ec4\u91cc\u3002\n\n**\u9898\u89e3\uff1a**\n\n\u8bb0\u5f55\u524d\u7f00\u7406\u667a\u548csum[i]\uff0cl ~ r \u53ef\u5206\u6210\u4e00\u7ec4 \u5f53\u4e14\u4ec5\u5f53sum[r] >= sum[l-1]\uff1b\n\n\u4ee4dp[i]\u8868\u793a\u4ee5i\u4f5c\u4e3a\u67d0\u4e00\u6bb5\u7684\u7ed3\u5c3e\u7684\u5206\u7ec4\u65b9\u5f0f\u3002dp[n]\u5c31\u662f\u8981\u6c42\u7684\u7b54\u6848\n\ndp[i]=\u2211dp[j] \u2026\u2026j<i\u4e14sum[j]<=sum[i]\uff1b\n\n<=sum[i]\u7684dp[j]\u7684\u548c\u53ef\u4ee5\u4f7f\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u3002\n\n\u56e0\u6b64\uff0c\u5148\u4ee5sum[i]\u79bb\u6563\u5316\uff0c\u6bcf\u6b21\u52a8\u6001\u67e5\u8be2\uff0c\u52a8\u6001\u4fee\u6539\n\n\u7279\u522b\u7684 \uff1a dp[0] = 1,\u4f18\u5148\u63d2\u5165\uff1b\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\nusing namespace std;\nconst int N = 5e5 + 5, mod = 1e9 + 9;\ntypedef long long LL;\nint n, k = -1, sum[N], b[N], c[N];\nint lowbit(int x) { return x & -x; }\nvoid add(int x, int k) {\n    for( ;x <= n + 5; x += lowbit(x)) (c[x] += k) %= mod;\n}\nint getsum(int x) {\n    int res = 0;\n    for( ; x ;x -= lowbit(x)) (res += c[x]) %= mod;\n    return res;\n}\nint main () {\n    cin >> n;\n    for(int i = 1;i <= n;i ++) \n        cin >> sum[i], sum[i] += sum[i-1], b[i] = sum[i];\n    sort(b + 1, b + n + 1);\n    for(int i = 0;i <= n;i ++) \n        sum[i] = lower_bound(b+1, b+n+1, sum[i]) - b + 2; \n    LL ans = 0;\n    add(sum[0], 1);\n    for(int i = 1;i <= n;i ++) {\n        ans = getsum(sum[i]);\n        add(sum[i], ans);\n    }\n    cout << ans << endl;\n    return 0;\n}\n```",
        "postTime": 1565571501,
        "uid": 151852,
        "name": "Paranoid\u4e36\u79bb\u6b87",
        "ccfLevel": 6,
        "title": "P2344 \u5976\u725b\u6297\u8bae \u79bb\u6563\u5316+\u524d\u7f00\u548c+\u52a8\u6001\u89c4\u5212+\u6811\u72b6\u6570\u7ec4"
    },
    {
        "content": "\u8bb0\u5f55\u524d\u7f00\u7406\u667a\u548csi\u3002l,l+1,l+2,\u2026,r-1,r\u80fd\u591f\u5206\u6210\u4e00\u7ec4\uff0ciff s[r]>=s[l-1]\n\n\u4ee4dp[i]\u8868\u793a\u4ee5i\u4f5c\u4e3a\u67d0\u4e00\u6bb5\u7684\u7ed3\u5c3e\u7684\u5206\u7ec4\u65b9\u5f0f\u3002dp[n]\u5c31\u662f\u8981\u6c42\u7684\u7b54\u6848\n\ndp[i]=\u2211dp[j] \u2026\u2026j<i\u4e14s[j]<=s[i]\n\n<=s[i]\u7684dp[j]\u7684\u548c\u53ef\u4ee5\u4f7f\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u3002\n\n\u56e0\u6b64\uff0c\u5148\u4ee5s[i]\u79bb\u6563\u5316\uff0c\u6bcf\u6b21\u52a8\u6001\u67e5\u8be2\uff0c\u52a8\u6001\u4fee\u6539\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#define f(i,l,r) for(i=(l);i<=(r);i++)\nusing namespace std;\nconst int MAXN=100005,MOD=1000000009;\nstruct Node{\n    int v,id,Hash;\n    bool operator < (const Node& x)const{\n        return v<x.v;\n    }\n}sum[MAXN];\nint n,a[MAXN],Tree[MAXN],Hash[MAXN],sz;\nbool cmp(Node a,Node b)\n{\n    return a.id<b.id;\n}\nvoid Add(int x,int d)\n{\n    while(x<=sz){\n        Tree[x]=(Tree[x]+d)%MOD;\n        x+=x&(-x);\n    }\n}\nint Query(int x)\n{\n    int res=0;\n    while(x>0){\n        res=(res+Tree[x])%MOD;\n        x-=x&(-x);\n    }\n    return res;\n}\nint main()\n{\n    int i,j=1,tot=0,pos,ans;\n    scanf(\"%d\",&n);\n    sum[0].v=sum[0].id=0;          //dp\u8fb9\u754c\u4e3adp[0]=1,\u56e0\u6b64\u8981\u63d2\u5165\u4e00\u4e2a0\n    f(i,1,n){\n        scanf(\"%d\",&a[i]);\n        sum[i].v=sum[i-1].v+a[i];\n        sum[i].id=i;\n    }\n    sort(sum,sum+1+n);\n    sum[0].Hash=1;\n    f(i,1,n){                                   //\u53bb\u91cd+\u79bb\u6563\u5316\n        if(sum[i].v!=sum[i-1].v){\n            sum[i].Hash=++j;\n        }\n        else sum[i].Hash=j;\n    }\n    sz=j;\n    sort(sum,sum+1+n,cmp);\n    Add(sum[0].Hash,1);                       //dp\u8fb9\u754c\n    f(i,1,n){\n        ans=Query(sum[i].Hash);\n        Add(sum[i].Hash,ans);\n    }\n    printf(\"%d\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1501922003,
        "uid": 18601,
        "name": "\u6770\u68ee\u7684\u4f2f\u6069",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2344 \u3010\u5976\u725b\u6297\u8bae\u3011"
    },
    {
        "content": "# \u9898\u76ee\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[\u70b9\u8fd9\u91cc](https://www.luogu.org/problem/P2344)\n# \u5206\u6790\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u8981\u5199$DP$\u7684\u8bdd\uff0c\u5f88\u5bb9\u6613\u770b\u51fa\u6765\uff1a  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$DP(i)$\uff1a\u524d$i$\u5934\u725b\u7684\u5206\u7ec4\u65b9\u6848\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u8bbe$S(i)=\\sum_{j=1}^ia_j$\uff0c\u5219\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u53ef\u63cf\u8ff0\u5982\u4e0b\uff1a  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$\\displaystyle DP(i)=\\sum_{j=0}^{i-1}[S_i-S_j\\ge0]\\times DP(j)$  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u5176\u4e2d\u65b9\u62ec\u53f7\u7684\u503c\u7531\u547d\u9898\u7684\u771f\u4f2a\u51b3\u5b9a\uff08\u6a21\u62df$if$\u8bed\u53e5\uff09\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u7136\u540e\u4f60\u628a\u66b4\u529b\u7a0b\u5e8f\u4ea4\u4e0a\u53bb\uff0c\u4f60\u5c31\u53ef\u4ee5\u5f97\u5230\u2014\u2014\u60ca\u4eba\u7684$90$\u5206\uff01  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~~\u6240\u4ee5\u6570\u636e\u8fd9\u4e48\u6c34\uff0c\u5982\u679c\u4f60\u8003\u8bd5\u7684\u65f6\u5019\u9047\u5230\u4e86\u5e72\u561b\u8fd8\u60f3\u4f18\u5316\u5462\uff1f\u76f4\u63a5\u53bb\u5207\u4e0b\u4e00\u9898\u5427\uff01~~  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u518d\u5f04\u4e00\u4e0b\u663e\u800c\u6613\u89c1\u7684\u79fb\u9879\u2014\u2014  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$\\displaystyle DP(i)=\\sum_{j=0}^{i-1}[S_i\\ge S_j]\\times DP(j)$  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u7531\u4e8e\u6211\u592a\u849f\u4e86\uff0c\u6240\u4ee5\u770b\u5230\u8fd9\u4e2a\u4e1c\u897f\u8ba4\u4e0d\u5f97\u5b83\u662f\u4e8c\u7ef4\u504f\u5e8f\u3002\u4e0d\u8fc7\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5982\u679c\u628a$j$\u7528\u65f6\u95f4\u8fd9\u4e00\u7ef4\u6765\u4ee3\u66ff\u7684\u8bdd\uff0c\u8fd9\u4e2a\u5b9e\u9645\u4e0a\u662f\u5728\u4e00\u4e2a\u51b3\u7b56\u70b9\u96c6\u5408\u4e2d\u8fdb\u884c\u4e8c\u5206\uff0c\u6240\u6709$S_j$\u6bd4$S_i$\u5c0f\u7684$j$\u90fd\u4f1a\u88ab\u52a0\u5230$DP(i)$\u91cc\u9762\u3002\u7136\u540e\u6211\u4eec\u5c31\u60f3\u5230\u4e86\u2014\u2014  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u6811\u72b6\u6570\u7ec4\uff0c~~\u6743\u503c\u7ebf\u6bb5\u6811\uff0c01Trie~~\uff0c\u5e73\u8861\u6811\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u7531\u4e8e\u8fd9\u4e2a$S$\u6700\u591a\u53ef\u4ee5\u964d\u5230$N\\times \\min\\{a\\}$\uff0c\u4e5f\u5c31\u662f$-10^{10}$\uff0c\u6240\u4ee5\u76f4\u63a5\u5957\u6811\u72b6\u6570\u7ec4\u662f\u4e0d\u592a\u73b0\u5b9e\u7684\uff08\u6216\u8005\uff0c\u56e0\u4e3a\u6211\u5b9e\u5728\u662f\u592a\u849f\u4e86\uff09\uff0c\u6240\u4ee5\u6211\u5199\u4e86\u4e00\u68f5\u5e73\u8861\u6811$Splay$\uff0c\u5e38\u6570\u5927\u5230\u8d77\u98de\uff0c\u4f46\u662f\u786e\u5b9e\u53ef\u4ee5\u8fc7\u3002~~\u4f60\u53ef\u4ee5\u5728rank\u699c\u7684\u672b\u5c3e\u770b\u89c1\u6211~~  \n# \u4ee3\u7801\n```cpp\n#include <cstdio>\n\nconst int mod = 1000000009;\nconst int MAXN = 100005;\n\ntemplate<typename _T>\nvoid read( _T &x )\n{\n\tx = 0;char s = getchar(); int f = 1;\n\twhile( s < '0' || '9' < s ){ f = 1; if( s == '-' ) f = -1; s = getchar(); }\n\twhile( '0' <= s && s <= '9' ){ x = ( x << 3 ) + ( x << 1 ) + s - '0', s = getchar(); }\n\tx *= f;\n}\n\ntemplate<typename _T>\nvoid write( _T x )\n{\n\tif( x < 0 ){ putchar( '-' ), x = -x; }\n\tif( 9 < x ){ write( x / 10 ); }\n\tputchar( x % 10 + '0' );\n}\n\nint ch[MAXN][2], par[MAXN], key[MAXN], val[MAXN], s[MAXN];\nint DP[MAXN];\nint S[MAXN];\nint N, rt, len;\n\nbool chk( const int x )\n{\n\treturn ch[par[x]][1] == x;\n}\n\nvoid pushup( const int x )\n{\n\ts[x] = ( ( s[ch[x][0]] + s[ch[x][1]] ) % mod + val[x] ) % mod;\n}\n\nvoid rotate( const int x )\n{\n\tif( ! x ) return;\n\tint y = par[x], z = par[y], sx = chk( x ), sy = chk( y ), son = ch[x][! sx];\n\tif( z ) ch[z][sy] = x;\n\tif( y ) par[y] = x, ch[y][sx] = son;\n\tch[x][! sx] = y, par[x] = z;\n\tif( son ) par[son] = y;\n\tpushup( y ), pushup( x ), pushup( z );\n}\n\nvoid splay( const int x, const int tar = 0 )\n{\n\tint y, z;\n\twhile( ( y = par[x] ) ^ tar )\n\t{\n\t\tz = par[y];\n\t\tif( z ^ tar )\n\t\t{\n\t\t\tif( chk( y ) == chk( x ) ) rotate( y );\n\t\t\telse rotate( x );\n\t\t}\n\t\trotate( x );\n\t}\n\tif( ! tar ) rt = x;\n}\n\nvoid insert( const int nKey, const int nVal )\n{\n\tint p = rt, fa = 0;\n\twhile( p && nKey ^ key[p] ) fa = p, p = ch[p][nKey > key[p]];\n\tif( p ) val[p] = ( val[p] + nVal ) % mod;\n\telse\n\t{\n\t\tp = ++len;\n\t\tif( len == 1 ) rt = p;\n\t\tif( fa ) par[p] = fa, ch[fa][nKey > key[fa]] = p;\n\t\tval[p] = nVal, key[p] = nKey, ch[p][0] = ch[p][1] = 0;\n\t}\n\tpushup( p );\n\tsplay( p );\n}\n\nvoid find( const int nKey )\n{\n\tif( ! rt ) return;\n\tint p = rt;\n\twhile( ch[p][nKey > key[p]] && key[p] ^ nKey ) p = ch[p][nKey > key[p]];\n\tsplay( p );\n}\n\nint succ( const int nKey )\n{\n\tfind( nKey );\n\tif( key[rt] > nKey ) return rt;\n\tint p = ch[rt][1];\n\twhile( ch[p][0] ) p = ch[p][0];\n\treturn p;\n}\n\nint main()\n{\n\tread( N );\n\tfor( int i = 1 ; i <= N ; i ++ ) read( S[i] ), S[i] += S[i - 1];\n\tinsert( -0x3f3f3f3f, 0 );\n\tinsert( 0x3f3f3f3f, 0 );\n\tinsert( S[0], 1 );\n\tfor( int i = 1 ; i <= N ; i ++ )\n\t{\n\t\tint p = succ( S[i] );\n\t\tsplay( p );\n\t\tDP[i] = s[ch[rt][0]] % mod;\n\t\tinsert( S[i], DP[i] );\n\t}\n\twrite( DP[N] ), putchar( '\\n' );\n\treturn 0;\n}\n```",
        "postTime": 1566991862,
        "uid": 123809,
        "name": "crashed",
        "ccfLevel": 0,
        "title": "[LG P2344][USACO]\u5976\u725b\u6297\u8bae"
    },
    {
        "content": "### \u601d\u8def\n\n\u6211\u4eec\u4ee4$f[i]$\u8868\u793a\u8003\u8651\u5230\u7b2c$i$\u4e2a\u5976\u725b\u7684\u65b9\u6848\u6570\uff0c$s[i]$\u8868\u793a\u524d\u7f00\u548c\uff0c\u663e\u7136\u6709\n\n$f[i]=\\sum_{1\\le j \\le i ,s[j] < s[i] }  f[j]$ \u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u4e2a\u95ee\u9898\u6f14\u53d8\u6210\u7c7b\u987a\u5e8f\u5bf9\u7684\u95ee\u9898\uff0c\u6211\u4eec\u4f7f\u7528\u6811\u72b6\u6570\u7ec4\u89e3\u51b3\u3002\n\n\u7ec6\u8282\u4e0d\u518d\u8d58\u8ff0\uff0c\u56e0\u4e3a\u548c\u9006\u5e8f\u5bf9\u662f\u76f8\u4f3c\u7684\uff0c\u5177\u4f53\u53ef\u4ee5\u53c2\u7167https://www.cnblogs.com/xiongmao-cpp/p/5043340.html\n\n### \u8bc4\u6d4b\u8bb0\u5f55\n\n\u7528\u65f6: 52ms / \u5185\u5b58: 2914KB\n\n### \u4ee3\u7801\u5b9e\u73b0\n\n```cpp\n    #include<bits/stdc++.h>\n    using namespace std;\n    int n,sum[100001],tree[100001],a[100001];\n    int MOD=1e9+9;\n    //\u4ee5\u4e0b\u6811\u72b6\u6570\u7ec4\n    void Add(int i,int j)\n    {for(;i<=n+5;i+=(i&-i))tree[i]+=j,tree[i]%=MOD;}\n    int Sum(int i)\n    {int res=0;for(;i;i-=(i&-i))res+=tree[i],res%=MOD;return res;}\n    int main() {\n        scanf(\"%d\",&n);\n        for (int i=1;i<=n;i++) \n        {scanf(\"%d\",&sum[i]);sum[i]+=sum[i-1];a[i]=sum[i];}\n        sort(a,a+n+1);\n        for (int i=0;i<=n;i++) \n        sum[i]=lower_bound(a,a+n+1,sum[i])-a+2;//\u79bb\u6563\u5316\n        Add(sum[0],1);int ans=0;\n        for(int i=1;i<=n;i++) {ans=Sum(sum[i]);Add(sum[i],ans);}\n        //\u6811\u72b6\u6570\u7ec4\u6c42\u987a\u5e8f\u5bf9\n        printf(\"%d\\n\",ans);\n        return 0;\n}\n```",
        "postTime": 1515746390,
        "uid": 37158,
        "name": "XG_Zepto",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P2344 \u3010\u5976\u725b\u6297\u8bae\u3011"
    },
    {
        "content": "\u3010\u601d\u8def\u3011\n\n\u7ebf\u6027DP+BIT\u52a0\u901f+\u79bb\u6563\u5316\u3002\n\n\u8bbed[i]\u8868\u793a\u524di\u5934\u5976\u725b\u7684\u5206\u6cd5\uff0c\u5219\u6709\u8f6c\u79fb\u65b9\u7a0b\u5f0f\u5982\u4e0b\uff1a\n\n     d[i]=sigma{ d[j]( j<i && S(j+1,i)>=0 ) }\n\n\u5176\u4e2dsigma\u8868\u793a\u6c42\u548c\u3001S\u4ee3\u8868\u533a\u95f4\u548c\u3002\n\n\u5982\u679c\u4ee4sum[]\u8868\u793a\u524d\u7f00\u548c\uff0c\u5219\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5f97\u51fa\u8f6c\u79fb\u6761\u4ef6\uff1a\u5b58\u5728j<i\u4e14sum[j]<=sum[i]\n\nBIT\u52a0\u901f\uff1a\u5982\u679cDP\u679a\u4e3e\u5230i\uff0c\u4ee4C[x]\u8868\u793ai\u4e4b\u524dsum==x\u7684\u6240\u6709d\u4e4b\u548c\uff0c\u5219d[i]\u4e3a\u5c0f\u4e8esum[i]\u7684\u6240\u6709d\u4e4b\u548c\uff0c\u53ef\u4ee5\u7528BIT\u6c42\u51fa\u5c0f\u4e8esum[i]\u7684\u533a\u95f4\u548c\u3002\n\n\u79bb\u6563\u5316\uff1asum\u7684\u60c5\u51b5\u6700\u591a\u6709n+1\u79cd\u800c\u5176\u8303\u56f4\u53ef\u80fd\u5f88\u5927\uff0c\u6240\u4ee5\u8003\u8651\u5bf9sum\u8fdb\u884c\u79bb\u6563\u5316\u3002\n\n  \n\u53e6\u5916\u67090\u7684\u60c5\u51b5\u53ef\u4ee5\u8003\u8651\u5c06BIT\u4e0b\u6807\u8fdb\u884c\u504f\u79fb\u6216hash\u5230\u5176\u4ed6\u8303\u56f4\u3002\n\n\u3010\u4ee3\u7801\u3011\n\n```cpp\n\n#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#define FOR(a,b,c) for(int a=(b);a<=(c);a++)\nusing namespace std;\n\nconst int maxn = 100000+10;\nconst int MOD=1000000009;\n\nint sum[maxn],a[maxn];\nint hash[maxn],cnt;\nint n;\n\nint C[maxn],Max;\nint lowbit(int x) { return x&(-x); }\nint Sum(int x) {\n    x++;\n    int res=0;\n    while(x>0) {\n        res = (res+C[x])%MOD;\n        x-=lowbit(x);\n    }\n    return res;\n}\nvoid Add(int x,int v) {\n    x++;\n    while(x<=Max+1) {\n        C[x] = (C[x]+v)%MOD;\n        x+=lowbit(x);\n    }\n}\n\nint find(int x) {\n    return lower_bound(hash,hash+cnt+1,x)-hash;\n}\n\nint main() {\n    scanf(\"%d\",&n);\n    FOR(i,1,n) {\n        scanf(\"%d\",&a[i]);\n        sum[i]=sum[i-1]+a[i];\n        Max=max(Max,sum[i]);\n    }\n    sort(sum,sum+n+1);         //\u5c060\u8ba1\u5165 \n    hash[0]=sum[0];\n    FOR(i,1,n) if(sum[i]!=sum[i-1]) {\n        hash[++cnt]=sum[i];\n    }\n    Add(find(0),1);\n    int tot=0,ans=0;\n    FOR(i,1,n) {\n        tot += a[i];\n        ans = Sum(find(tot))%MOD;\n        Add(find(tot),ans);\n    }\n    printf(\"%d\\n\",ans);\n    return 0;\n}\n\n```",
        "postTime": 1446206289,
        "uid": 3482,
        "name": "hahalidaxin2",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2344 \u3010\u5976\u725b\u6297\u8bae\u3011"
    }
]
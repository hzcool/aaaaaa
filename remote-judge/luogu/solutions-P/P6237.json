[
    {
        "content": "[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/P6237)\n\n## \u9898\u76ee\u5927\u610f\n\n- $n$ \u4e2a\u70b9\u7684\u591a\u8fb9\u5f62\uff0c\u6c42\u51fa\u6240\u6709\u4e0e\u539f\u70b9\u8fde\u7ebf\u6bb5\u8ddf\u591a\u8fb9\u5f62\u4ea4\u70b9\u4e0d\u8d85\u8fc7 $2$ \u7684\u9876\u70b9\u3002\n\n- $n \\leq 2\\times 10^5$\uff0c\u5750\u6807\u4e3a\u4e0d\u8d85\u8fc7 $10^6$ \u7684\u81ea\u7136\u6570\u3002\n\n# Solution\n\n\u8003\u8651\u6c42\u51fa $O$ \u4e0e\u9876\u70b9 $i$ \u7684\u8fde\u7ebf\u6bb5\u4e0e\u591a\u8fb9\u5f62\u6709\u4ea4\u70b9\u7684\u8fb9\u4e2d\uff0c\u4ea4\u70b9\u6a21\u957f\u6700\u5c0f\u7684\u90a3\u4e2a\u3002\n\n\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u76f4\u63a5\u4e0a\u6781\u5750\u6807\u674e\u8d85\u7ebf\u6bb5\u6811\uff0c\u4f46\u6ce8\u610f\u5230\u6bcf\u6761\u8fb9\u4e24\u7aef\u70b9\u7684\u6781\u89d2\u5f62\u6210\u533a\u95f4 $[\\theta_L,\\theta _R]$\uff0c\u6211\u4eec\u6309\u6781\u89d2\u505a\u626b\u63cf\u7ebf\uff0c$\\theta_L$ \u5904\u63d2\u5165\u7ebf\u6bb5 $\\theta_R$ \u5904\u518d\u5220\u9664\uff0c\u53d1\u73b0\u5bf9\u4e8e\u540c\u65f6\u5b58\u5728\u7684\u4e24\u6761\u7ebf\u6bb5\uff0c\u4ed6\u4eec\u7684\u4e0e\u8fc7 $  O$ \u4e14\u503e\u659c\u89d2\u4e3a $\\theta$ \u7684\u76f4\u7ebf\u4ea4\u70b9\uff0c\u5230 $O$ \u7684\u8ddd\u79bb\u76f8\u5bf9\u5927\u5c0f\u4e0d\u53d8\u3002\n\n\u56e0\u6b64\u6309\u6781\u89d2\u79bb\u6563\u5316\u540e\u7528\u5806\u7ef4\u62a4\u626b\u63cf\u7ebf\u5373\u53ef\uff0c\u590d\u6742\u5ea6 $O(n \\log n)$\u3002\n\n# Code\n\n```cpp\n#include<bits/stdc++.h>\n#define Lson (now<<1)\n#define Rson (now<<1|1)\nusing namespace std;\n\ntypedef long long ll;\ntypedef long double ld;\n\nconst int MAXN=2e5;\n\ninline int Read()\n{\n\tint res;char c;\n\twhile(1) {c=getchar();if('0'<=c && c<='9') {res=c-'0';break;}}\n\twhile(1) {c=getchar();if('0'<=c && c<='9') res=res*10+c-'0';else break;}\n\treturn res;\n}\n\ninline ld Mold(ld x,ld y) {return sqrt(x*x+y*y);}\n\nstruct Point\n{\n\tld x,y,rho,dis;\n\tint ID,loc;\n\tinline void Scan() {x=Read(),y=Read(),rho=y/x,dis=Mold(x,y);}\n}ver[MAXN+5];\nbool cmp(Point a,Point b)\n{return a.loc==b.loc ? a.dis<b.dis : a.loc<b.loc;}\n\nint n;ld K;//\u5f53\u524d\u659c\u7387\nld dsc[MAXN+5];int dnum;\nvector<int> ope[MAXN+5];\nint ans[MAXN+5],tot;\n\ninline int Search(ld x)\n{\n\tfor(int L=1,R=dnum,mid;1;)\n\t{\n\t\tmid=(L+R)>>1;\n\t\tif(x==dsc[mid]) return mid;\n\t\tif(dsc[mid]<x) L=mid+1;\n\t\telse R=mid-1;\n\t}\n\treturn 0;\n}\n\nstruct Segment\n{\n\tld k,b,cls;\n\tinline ld dis()\n\t{\n\t\tld x,y;\n\t\tif(k<0 && b<0) x=-k,y=K*x;\n\t\telse {if(k==K) return cls; x=b/(K-k),y=K*x;}\n\t\treturn Mold(x,y);\n\t}\n}seg[MAXN+5];\n\n//------------- Heap -------------\nint data[MAXN+5],Tail,inv[MAXN+5];\ninline void Insert(int x)\n{\n\tld v=seg[x].dis();\n\tint now=++Tail; data[now]=x,inv[x]=now;\n\tfor(;now>1;now>>=1)\n\t\tif(v<seg[data[now>>1]].dis())\n\t\t{\n\t\t\tswap(data[now],data[now>>1]);\n\t\t\tswap(inv[data[now]],inv[data[now>>1]]); \n\t\t}\n\t\telse break;\n}\ninline void Delete(int x)\n{\n\tint now=inv[x];\n\tdata[now]=data[Tail];\n\tinv[data[Tail]]=now;\n\tdata[Tail--]=0;\n\twhile(Lson<=Tail)\n\t\tif(Rson<=Tail)\n\t\t{\n\t\t\tif(seg[data[Lson]].dis()<seg[data[Rson]].dis())\n\t\t\t{\n\t\t\t\tswap(data[now],data[Lson]);\n\t\t\t\tswap(inv[data[now]],inv[data[Lson]]);\n\t\t\t\tnow=Lson;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tswap(data[now],data[Rson]);\n\t\t\t\tswap(inv[data[now]],inv[data[Rson]]);\n\t\t\t\tnow=Rson;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tswap(data[now],data[Lson]);\n\t\t\tswap(inv[data[now]],inv[data[Lson]]);\n\t\t\tnow=Lson;\n\t\t}\n}\n\ninline bool Judge(int a,int b)\n{\n\tif(!b) return 1;\n\treturn ver[a].dis<seg[b].dis();\n}\n\nint main()\n{\n\t//freopen(\"3.in\",\"r\",stdin);\n\t//freopen(\"mine.txt\",\"w\",stdout);\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tver[i].Scan();\n\t\tdsc[++dnum]=ver[i].rho;\n\t\tver[i].ID=i;\n\t}\n\tsort(dsc+1,dsc+dnum+1),dnum=unique(dsc+1,dsc+dnum+1)-dsc-1;\n\tfor(int i=1;i<=n;i++) ver[i].loc=Search(ver[i].rho);\n\tver[n+1]=ver[1];\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(ver[i].x==ver[i+1].x) seg[i]=Segment{-ver[i].x,-1};\n\t\telse\n\t\t{\n\t\t\tseg[i].k=(ver[i].y-ver[i+1].y)/(ver[i].x-ver[i+1].x);\n\t\t\tseg[i].b=ver[i].y-seg[i].k*ver[i].x;\n\t\t}\n\t\tseg[i].cls=min(ver[i].dis,ver[i+1].dis);//\u83b7\u53d6\u6bcf\u6761\u7ebf\u6bb5 \n\t\tint L=ver[i].loc,R=ver[i+1].loc; if(L>R) swap(L,R);\n\t\tif(L==R) continue;\n\t\tope[L+1].push_back(i);\n\t\tope[R].push_back(-i);\n\t}\n\tsort(ver+1,ver+n+1,cmp);\n\t\n\tfor(int i=1,j=1;i<=dnum && j<=n;i++)\n\t{\n\t\tK=dsc[i];\n\t\tfor(int k=0;k<ope[i].size();k++)\n\t\t\tif(ope[i][k]>0) Insert(ope[i][k]);\n\t\t\telse Delete(-ope[i][k]);\n\t\tif(Judge(j,data[1])) ans[++tot]=ver[j].ID;\n\t\twhile(ver[j].loc==i && j<=n) ++j;\n\t}\n\tsort(ans+1,ans+tot+1);\n\tprintf(\"%d\\n\",tot);\n\tfor(int i=1;i<=tot;i++) printf(\"%d \",ans[i]);\n\treturn 0;\n}\n```\n",
        "postTime": 1663852755,
        "uid": 54591,
        "name": "Seauy",
        "ccfLevel": 9,
        "title": "[CEOI2012] Printed Circuit Board \u7684\u9898\u89e3"
    }
]
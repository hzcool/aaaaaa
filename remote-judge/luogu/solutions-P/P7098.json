[
    {
        "content": "### E\n\n#### Algorithm 1\n\n\u8003\u8651\u679a\u4e3e\u6240\u6709\u7684\u60c5\u51b5\uff0c\u5373\u6bcf\u6761\u7ebf\u8def\u7ecf\u8fc7\u54ea\u4e00\u5c42\uff0c\u6bcf\u6761\u7ebf\u8def\u90fd\u6709 $n$ \u79cd\u53ef\u80fd\uff0c\u7206\u641c\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^n)$\u3002\u8fd9\u91cc\u7701\u7565\u4e86\u4e0e $m$ \u6709\u5173\u7684\u9879\u3002\u671f\u671b\u5f97\u5206 $35$ \u5206\u3002\n\n#### Algorithm 2\n\n\u6ce8\u610f\u5230\u6570\u636e\u8303\u56f4\u660e\u793a\u72b6\u538b dp\u3002\u8003\u8651\u8bbe\u8ba1\u72b6\u6001\uff1a$f_{i, S}$ \u8868\u793a\u8003\u8651\u4e86\u653e\u5728\u6df1\u5ea6\u4e3a\u524d $i$ \u5c42\u7684\u5730\u94c1\uff0c\u5df2\u7ecf\u8003\u8651\u4e86\u96c6\u5408 $S$ \u4e2d\u7684\u6240\u6709\u8def\u7ebf\u7684\u6700\u5c0f\u82b1\u8d39\uff0c\u8f6c\u79fb\u663e\u7136\uff1a\n\n$$f_{i, S} = \\min_{s \\subseteq S} f_{i - 1, s} + val(i, S - s)$$\n\n\u5176\u4e2d $s$ \u662f $S$ \u7684\u5b50\u96c6\uff0c$val(S - s)$ \u8868\u793a $s$ \u5728 $S$ \u4e2d\u7684\u8865\u96c6\u4e2d\u7684\u5143\u7d20\u90fd\u653e\u5230\u7b2c $i$ \u5c42\u65f6\u7684\u82b1\u8d39\u3002$val$ \u662f\u53ef\u4ee5\u9884\u5904\u7406\u7684\u3002\u5177\u4f53\u53ef\u4ee5\u53c2\u8003 std~~\u548c\u5c06\u6765\u4f1a\u6709\u7684\u6c11\u95f4\u9898\u89e3~~\u3002\n\n\u66b4\u529b\u679a\u4e3e $s$ \u5e76\u5224\u65ad $s$ \u662f\u4e0d\u662f $S$ \u7684\u5b50\u96c6\u6765\u8f6c\u79fb\uff0c\u5171\u6709 $O(n 2^n)$ \u4e2a\u72b6\u6001\uff0c\u5355\u6b21\u8f6c\u79fb\u590d\u6742\u5ea6 $O(2^n)$\uff0c\u603b\u590d\u6742\u5ea6 $O(n 4^n + m)$\uff0c\u671f\u671b\u5f97\u5206 $70$ \u5206\u3002\n\n#### Algorithm 3\n\n\u8003\u8651\u4f18\u5316\u7b97\u6cd5\u4e8c\u4e2d\u7684\u5b50\u96c6\u679a\u4e3e\u65b9\u5f0f\u3002\u6309\u7167\u5982\u4e0b\u65b9\u5f0f\u679a\u4e3e\u5b50\u96c6\u663e\u7136\u53ef\u4ee5\u7cbe\u786e\u679a\u4e3e $S$ \u7684\u6bcf\u4e2a\u5b50\u96c6\u800c\u4e0d\u4f1a\u65e0\u7528\u679a\u4e3e\uff1a\n\n```cpp\nfor (int s = S; s; s = (s - 1) & S) \n```\n\n\u8fd9\u6837\u8f6c\u79fb\u7684\u590d\u6742\u5ea6\u5c31\u53d8\u6210\u4e86 $O(2^k)$\uff0c\u5176\u4e2d $k$ \u8868\u793a $S$ \u4e8c\u8fdb\u5236\u4e3a $1$ \u7684\u4f4d\u6570\u3002\u8003\u8651\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(m + n \\times \\sum\\limits_{k = 0}^n C_{n}^k \\times 2^k)$\u3002\u5176\u4e2d $C_{n}^k$ \u8868\u793a\u4e8c\u8fdb\u5236\u5171\u6709 $k$ \u4f4d\u4e3a $1$ \u7684\u6570\u7684\u4e2a\u6570\u3002\u6839\u636e\u4e8c\u9879\u5f0f\u5b9a\u7406\uff0c$\\sum\\limits_{k = 0}^n C_{n}^k \\times 2^k = \\sum\\limits_{k = 0}^n C_{n}^k \\times 2^k \\times 1^{n - k} = (2 + 1)^n = 3^n$\uff0c\u56e0\u6b64\u603b\u590d\u6742\u5ea6\u4e3a $O(m + n \\times 3^n)$\u3002\u671f\u671b\u5f97\u5206 $100$ \u5206\u3002\n\n\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u4e3a\u4e86\u5bf9\u6807\u300cNOIp2017 \u5b9d\u85cf\u300d\u7684\u771f\u5b9e\u60c5\u51b5\uff0c\u672c\u9898\u6ca1\u6709\u52a0\u6346\u7ed1\u6d4b\u8bd5\uff0c\u4e5f\u6ca1\u6709\u5bf9\u7740\u7206\u641c\u52a0\u526a\u679d\u5361\uff08\u4e8b\u5b9e\u4e0a\u6570\u636e\u91cf\u8fd9\u4e48\u5c0f\u6839\u672c\u5c31\u6ca1\u6cd5\u5361\uff09\u3002\u56e0\u6b64\u7206\u641c\u52a0\u526a\u679d\u53ef\u80fd\u53ef\u4ee5\u83b7\u5f97\u6bd4\u8f83\u53ef\u89c2\u7684\u5206\u6570\u3002\n\n```cpp\n#include <cctype>\n#include <cstdio>\n#include <algorithm>\n\ntypedef long long int ll;\n\nconst int maxn = 15;\nconst int maxm = 100005;\nconst int maxt = 1 << maxn;\nconst ll INF = 1000000000000000000ll;\n\ntemplate <typename T>\ninline void qr(T &x) {\n  char ch = getchar();\n  while (!isdigit(ch)) ch = getchar();\n  while (isdigit(ch)) x = x * 10 + ch - 48, ch = getchar();\n}\n\nint n, m, upc;\nint a[maxn][maxm], b[maxn][maxm], tmp[maxn];\nll fee[maxn][maxn], g[maxn][maxt], f[maxn][maxt];\nbool ac[maxn][maxn];\n\nint main() {\n  qr(n); qr(m);\n  upc = 1 << n;\n  for (int i = 0; i < n; ++i) {\n    for (int j = 1; j <= m; ++j) {\n      qr(a[i][j]);\n    }\n  }\n  for (int i = 0; i < n; ++i) {\n    qr(b[i][0]);\n    for (int j = 1; j <= b[i][0]; ++j) {\n      qr(b[i][j]);\n    }\n    std::sort(b[i] + 1, b[i] + 1 + b[i][0]);\n    for (int j = 0; j < n; ++j) {\n      for (int k = 1; k <= b[i][0]; ++k) {\n        fee[i][j] += a[j][b[i][k]];\n   //     printf(\"Aa%d %d %d %d %d %d\\n\", i, j, k, b[i][k], a[j][b[i][k]], fee[i][j]);\n      }\n  //    printf(\"ovO%d %d %d\\n\", i, j, fee[i][j]);\n    }\n  }\n  \n  for (int i = 0; i < n; ++i) {\n    for (int j = i + 1; j < n; ++j) {\n      ac[i][j] = ac[j][i] = true;\n      int u = 1, v = 1;\n      while ((u <= b[i][0]) && (v <= b[j][0])) {\n        if (b[i][u] == b[j][v]) {\n          ac[j][i] = ac[i][j] = false; break;\n        }\n        if (b[i][u] < b[j][v]) ++u;\n        else ++v;\n      }\n    }\n  }\n  for (int s = 1; s < upc; ++s) {\n    int cnt = 0;\n    for (int i = 0; i < n; ++i) if (s & (1 << i)) {\n      tmp[++cnt] = i;\n      for (int j = 1; j < cnt; ++j) if (ac[tmp[j]][i] == false) {\n        for (int k = 0; k < n; ++k) {\n          g[k][s] = INF;\n        }\n        break;\n      }\n      if (g[0][s] == INF) break;\n      for (int k = 0; k < n; ++k) {\n        g[k][s] += fee[i][k];\n      }\n    }\n  }\n  for (int s = 1; s < upc; ++s) {\n    f[0][s] = g[0][s];\n  }\n  for (int i = 1; i < n; ++i) {\n    for (int s = 0; s < upc; ++s) {\n      f[i][s] = f[i - 1][s];\n      for (int t = s; t; t = (t - 1) & s) {\n        f[i][s] = std::min(f[i][s], f[i - 1][s ^ t] + g[i][t]);\n      }\n     // printf(\"%d %d %lld\\n\", i, s, f[i][s]);\n    }\n  }\n  printf(\"%lld\\n\", f[n - 1][upc - 1]);\n}\n```\n\n",
        "postTime": 1606017861,
        "uid": 65363,
        "name": "\u4e00\u6276\u82cf\u4e00",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P7098 \u3010[yLOI2020] \u51c9\u51c9\u3011"
    },
    {
        "content": "### \u524d\u8a00\n\n\u9884\u5904\u7406\u5de8\u591a\u7684\u72b6\u538b\u597d\u9898\n\n### \u601d\u8def\n\n~~\u6211\u4e0d\u4f1a\u7206\u641c\u554a\uff0c\u592a\u9ebb\u70e6\u4e86~~\u3002\n\n\u76f4\u63a5\u5c06 $\\text{DP}$ \u600e\u4e48\u505a\u3002\n\n\u9996\u5148\u9700\u8981\u5f88\u591a\u7684\u9884\u5904\u7406\uff1a\n\n1\u3001\u5904\u7406\u5728\u6bcf\u4e00\u4e2a\u6df1\u5ea6 $j$ \u5efa\u7acb\u67d0\u4e00\u4e2a\u94c1\u8def\u7ebf $i$ \u82b1\u8d39\u7684\u4ef7\u683c $\\text{cost}_{i,j}$\u3002\n\n2\u3001\u5904\u7406\u51fa\u94c1\u8def\u7ebf $i$ \u548c\u94c1\u8def\u7ebf $j$ \u80fd\u5426\u5728\u540c\u4e00\u4e2a\u6df1\u5ea6\u5efa\u7acb\u7ebf\u8def $vis_{i,j}$\u3002\n\n3\u3001\u5904\u7406\u51fa\u5728\u6df1\u5ea6\u4e3a $i$ \u7684\u65f6\u5019\uff0c\u5728\u8fd9\u4e00\u5c42\u6df1\u5ea6\u4fee\u5efa\u7684\u94c1\u8def\u7ebf\u7684\u72b6\u6001\u4e3a $S$ \u4ef7\u94b1 $g_{i,S}$\u3002\n\n~~\u5904\u7406\u5b8c\u8fd9\u4e9b\u5c31\u53ef\u4ee5\u8fdb\u884c\u975e\u5e38\u77ed\u7684 $\\text{DP}$ \u8fc7\u7a0b\u4e86\u3002~~\n\n\u9650\u5236\u6211\u4eec\u8ba1\u7b97\u4ef7\u94b1\u7684\u91cf\u4e3a\u6df1\u5ea6 $\\text{dep}$ \uff0c\u4ee5\u53ca\u72b6\u6001 $S$, \u90a3\u4e48\u5c31\u8003\u8651\u8bbe\u7f6e\u4e24\u7ef4 $\\text{DP}$\u3002\n\n\u8bbe\u7f6e $f_{i,S}$ \u5df2\u7ecf\u5f04\u5b8c\u4e86\u524d $i$ \u6df1\u5ea6\u7684\u94c1\u8def\u7ebf\uff0c\u73b0\u5728\u5efa\u7acb\u5b8c\u7684\u94c1\u8def\u7ebf\u7f16\u53f7\u7684\u72b6\u6001\u4e3a $S$ \u7684\u6700\u77ed\u4ef7\u683c\u3002\n\n\u65e2\u7136\u6211\u4eec\u9884\u5904\u7406\u5b8c\u4e86\uff0c\u90a3\u4e48\u5f88\u663e\u7136\u7684\u72b6\u6001\u8f6c\u79fb\u5c31\u662f\uff1a\n\n$$f_{i,S}=\\min_{s\\in S} \\{ f_{i-1,S\\oplus s}+g_{i,s}\\}$$\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u679a\u4e3e\u5b50\u96c6\u7684\u65b9\u6cd5\u907f\u514d\u66b4\u529b\u679a\u4e3e\u72b6\u6001\u5224\u65ad\u3002\n\n\u5947\u602a\u7684\u590d\u6742\u5ea6\u5927\u7ea6\u4e3a \uff1a$O(n^2+2^{14}n^2+2^{14}+2^{14}n)$\u3002(\u679a\u4e3e\u5b50\u96c6\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e0d\u4f1a\u7b97/kk)\n\n\u53ef\u4ee5\u975e\u5e38\u5b8c\u7f8e\u7684\u901a\u8fc7\u6b64\u9898\u3002\n\n### \u4ee3\u7801\u5b9e\u73b0\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<vector>\n#include<algorithm>\n#include<map>\nusing namespace std;\nconst int N=15;\nconst int M=1e5+9;\nconst int K=(1<<15);\nconst long long int INF=1e18+9;//\u8981\u5f00\u5927\u4e00\u70b9/cg \nint dep[N][M];//\u6df1\u5ea6\u4e3a i \u7684\u5730\u94c1\u7ecf\u8fc7\u4e86\u5730\u94c1\u7ad9 j \uff0c\u7684\u82b1\u8d39\nint cnt[N];//\u8868\u793a\u7b2c i \u6761\u5730\u94c1\u7ecf\u8fc7\u7684\u7ad9\u70b9\u4e2a\u6570 \nint sub[N][M];//\u7b2c i \u6761\u5730\u94c1\u7ecf\u8fc7\u7684\u7ad9\u70b9\u7f16\u53f7\u3002\nint n,m;\nlong long int f[N][K];//\u660e\u663e\u8ddf\u6df1\u5ea6\u6709\u5173\uff0c\u6240\u4ee5\u5c31\u8bbe\u524di\u6df1\u5ea6\uff0c\u4fee\u5efa\u7684\u94c1\u8def\u7ebf\u72b6\u6001\u4e3aj\u7684\u6700\u5c0f\u82b1\u8d39\nlong long int g[N][K];//\u5728\u6df1\u5ea6\u4e3ai\u65f6\uff0c\u8be5\u5c42\u4fee\u5efa\u72b6\u6001\u4e3aj\u7684\u82b1\u8d39 \nlong long int cost[N][N];//\u7b2ci\u6761\u94c1\u8def\u5728\u6df1\u5ea6\u4e3aj\u4fee\u5efa\u65f6\u7684\u82b1\u8d39 \nbool vis[N][N];//\u8be2\u95ee\u7b2ci\u6761\u94c1\u8def\u548c\u7b2cj\u6761\u94c1\u8def\u80fd\u5426\u4fee\u5efa\u5728\u4e00\u4e2a\u9053\u8def\u4e0a \nint stk[N],top;\nint read()\n{\n\tint f=1,x=0;\n\tchar s=getchar();\n\twhile(s<'0'||s>'9'){if(s=='-')f=-1;s=getchar();}\n\twhile(s>='0'&&s<='9'){x=(x<<1)+(x<<3)+(s^'0');s=getchar();}\n\treturn f*x;\n} \nvoid Prepare()\n{\n\tfor(int i=1;i<=n;i++)\n\t\tsort(sub[i]+1,sub[i]+1+cnt[i]);//\u6392\u5e8f\uff0c\u4fbf\u4e8e\u67e5\u627e \n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=i+1;j<=n;j++)\n\t\t{\n\t\t\tvis[i][j]=vis[j][i]=true;\n\t\t\tint x=1,y=1;//\u4e00\u79cd\u7701\u65f6\u95f4\u7684\u65b9\u6cd5\uff0c\u5e8f\u53f7\u6392\u597d\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0d\u65ad\u6bd4\u8f83\u7f16\u53f7\u5927\u5c0f\uff0c\u6162\u6162\u9012\u589e\u5bfb\u627e\u76f8\u540c\u70b9\n\t\t\twhile(x<=cnt[i] and y<=cnt[j])\n\t\t\t{\n\t\t\t\tif(sub[i][x]==sub[j][y])\n\t\t\t\t{\n\t\t\t\t\tvis[i][j]=vis[j][i]=false;\t\n\t\t\t\t\tbreak;//\u4e0d\u80fd\u5728\u540c\u4e00\u6761\u7ebf\u8def\u4e0a \n\t\t\t\t}\t\n\t\t\t\tif(sub[i][x]<sub[j][y]) x++;\n\t\t\t\telse if(sub[i][x]>sub[j][y]) y++;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int s=1;s<(1<<n);s++)//\u679a\u4e3e\u6240\u6709\u72b6\u6001 \n\t{\n\t\ttop=0;\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tif(s&(1<<(i-1)))//\u6709\u620f\n\t\t\t{\n\t\t\t\tstk[++top]=i;\n\t\t\t\tfor(int j=1;j<top;j++)\n\t\t\t\t\tif(!vis[i][stk[j]])//\u770b\u6765\u6ca1\u620f\u4e86/kk\n\t\t\t\t\t{\n\t\t\t\t\t\tfor(int k=1;k<=n;k++)//\u628a\u6240\u6709\u90fd\u53d8\u4e3a\u6781\u5927\u503c\n\t\t\t\t\t\t\tg[k][s]=INF;\n\t\t\t\t\t}\n\t\t\t\tif(f[1][s]==INF)//\u6ca1\u6551\u4e86\uff0c\u8d4b\u4e3a\u6781\u5927\u503c\n\t\t\t\t\tbreak;\n\t\t\t\tfor(int j=1;j<=n;j++)\n\t\t\t\t\tg[j][s]+=cost[i][j];\n\t\t\t\t//\u6df1\u5ea6\u4e3aj\u65f6\u4fee\u5efa\u72b6\u6001\u4e3as\u7684\u94c1\u8def\uff0c\u52a0\u4e0a\u7b2ci\u6761\u94c1\u8def\u5728j\u6df1\u5ea6\u4fee\u5efa\u65f6\u7684\u603b\u4ef7\u94b1\u3002 \n\t\t\t}\n\t}\n\tfor(int s=1;s<(1<<n);s++)\n\t\tf[1][s]=g[1][s];//\u521d\u59cb\u5316\u7b2c\u4e00\u884c \n\treturn;\n}\nint main()\n{\n\tn=read();\n\tm=read();\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++) \n\t\t\tdep[i][j]=read();\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tcnt[i]=read();//\u8f93\u5165\u4e2a\u6570\n\t\tfor(int j=1;j<=cnt[i];j++)\n\t\t\tsub[i][j]=read();\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tfor(int k=1;k<=cnt[i];k++)\n\t\t\t\tcost[i][j]+=dep[j][sub[i][k]];\n\t}\n\tPrepare();\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tfor(int S=0;S<(1<<n);S++)\n\t\t{\n\t\t\tf[i][S]=f[i-1][S];//\u521d\u59cb\u5316,\u52a0\u5165\u8fd9\u4e2a\u4e0d\u9009 \n\t\t\tfor(int s=S;s;s=(s-1)&S)\n\t\t\t\tf[i][S]=min(f[i][S],f[i-1][S^s]+g[i][s]);\n\t\t}\t\n\t} \n\tcout<<f[n][(1<<n)-1]<<endl;\n\treturn 0;\n}\n```\n",
        "postTime": 1623401285,
        "uid": 230804,
        "name": "Durancer",
        "ccfLevel": 4,
        "title": "\u3010\u9898\u89e3\u3011P7098 [yLOI2020] \u51c9\u51c9"
    },
    {
        "content": "~~\u6bd4\u5b8c\u8d5b\u597d\u51e0\u5929\u4e86\u5c45\u7136\u6ca1\u4eba\u53d1\u9898\u89e3~~\n\n## \u5fc3\u8def\u5386\u7a0b\n\n\u9996\u5148\u8003\u8651\u8d2a\u5fc3\uff0c~~\u76f4\u89c9+\u751f\u6d3b\u7ecf\u9a8c~~\u544a\u8bc9\u6211\u4eec\u8d8a\u6d45\u7684\u8d8a\u4fbf\u5b9c\uff0c\u4f46\u662f\u4ed4\u7ec6\u770b\u4e86\u4e00\u4e0b\u9898\u76ee\uff0c\u5e76\u6ca1\u6709\u8bf4\u660e\uff1b\n\n\u4e8e\u662f\u95ee\u4e86\u51fa\u9898\u4eba\u2026\u2026\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tlpptymy.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8r97f1ih.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/e953yzts.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/uf4cf1l7.png)\n\n\u597d\u5427fAKe\u4e86\u2026\u2026\n\n\u4e8e\u662f\u518d\u770b\u4e00\u773c\u6570\u636e\u8303\u56f4\uff1an<=14\n\n\u8fd9\u4e0d\u662f\u8d64\u88f8\u88f8\u7684\u72b6\u538b\u5417\uff08\n\n\u5148\u770b\u770b\u90e8\u5206\u5206\uff1a\n\n5\u5206\u4eba\u53e3\u666e\u67e5\uff1a\u53ea\u6709\u4e00\u5217\u8f66\uff0c\u679a\u4e3e\u6240\u5728\u5c42\u6570\u53d6min\u5373\u53ef\n\n35\u5206\u65e0\u8111\u5206\uff1a$O(N^N)$\u7206\u641c\u5373\u53ef\u62ff\u4e0b$N<=6$\u768435pts\n\n\u663e\u7136\u5982\u679c\u5728\u7206\u641c\u8fc7\u7a0b\u4e2d\u679a\u4e3e\u7ecf\u8fc7\u7684\u7ad9\u70b9\u7684\u8bdd\u4f1aT\u98de\uff08\u5927\u6982\n\n\u6240\u4ee5\u8003\u8651\u9884\u5904\u7406\u4e00\u4e2aval\u6570\u7ec4,$val[i][j]$\u8868\u793a$j$\u8f66\u5728$i$\u5c42\u7684\u82b1\u8d39\uff0c\u4e00\u8fb9\u8bfb\u5165\u4e00\u8fb9\u5904\u7406\u5c31\u884c\n\n\u5269\u4e0b\u768470\u5206\u548c100\u5206\u5176\u5b9e**\u770b\u8d77\u6765**\u5dee\u522b\u4e0d\u592a\u5927\uff0c\u611f\u89c9\u90fd\u662f\u72b6\u538b\u4e00\u7c7b\n\n--------\n\n5\u5206\u7684\u90e8\u5206\u5206\u53ea\u662f\u7528\u6765\u9a8c\u8bc1\u6211\u4eec\u8bfb\u9898\u662f\u5426\u6b63\u786e\u7684\uff0c\u5bf9\u4e8e\u89e3\u9898\u6ca1\u4ec0\u4e48\u5e2e\u52a9\uff08\n\n\u8003\u8651\u5c0635\u5206\u7684val\u6570\u7ec4\u63a8\u5e7f\uff0c\u8ba9\u7b2c\u4e8c\u7ef4j\u8868\u793a\u7684\u4e0d\u4ec5\u4ec5\u662f\u67d0\u4e2a\u8f66\u800c\u662f\u67d0\u4e2a\u72b6\u6001\n\n\u7a0d\u5fae\u60f3\u4e00\u4e0b\uff0c\u8c8c\u4f3c\u53ef\u884c\uff1a\n\n\u4ece$0$\u81f3$(1<<n)-1$\u679a\u4e3ej\uff0c\u5224\u65ad\u72b6\u6001\u662f\u5426\u5408\u6cd5\uff0c\u82e5\u5408\u6cd5\u5219$O(logN)$\u679a\u4e3ej\u72b6\u6001\u4e0b\u54ea\u4e9b\u8f66\u88ab\u9009\u4e2d\u5e76\u52a0\u548c\uff1b\u4e0d\u5408\u6cd5\u5219\u7f6e\u4e3a$inf$\u3002\n\n\u81f3\u4e8e\u5224\u65ad\u662f\u5426\u5408\u6cd5\uff0c\u5728\u8f93\u5165\u65f6\u5c06\u6240\u6709\u7ecf\u8fc7\u7684\u8f66\u7ad9\u538b\u5165bitset\u91cc\uff0c\u5224\u65ad\u65f6\u628a\u6240\u6709\u8f66\u62ff\u51fa\u6765$N^2$\u6328\u4e2a\u53d6\u6216\uff0c\u5982\u679c\u4e0d\u4e3a\u96f6\u5219\u8bf4\u660e\u6709\u91cd\u53e0\u90e8\u5206\uff0c\u4e0d\u5408\u6cd5\u3002\n\n\u8bbe$f[i][st]$\u8868\u793a\u524di\u5c42\u5b89\u653e$st$\u72b6\u6001\u7684\u8f66\u8f86\u7684\u6700\u5c0f\u82b1\u8d39\uff0c\u518d\u7ed3\u5408\u521a\u521a\u7684val\u6570\u7ec4\uff0c\u8f6c\u79fb\u65b9\u7a0b\u5c31\u5f88\u5bb9\u6613\u5217\u51fa\u6765\uff1a\n\n$ f[i][st] = min{f[i-1][k] + val[i][st-k]},(st | k = st) $\n\n\u5176\u4e2d\uff0c$st|k=st$\u8868\u793ak\u72b6\u6001\u662fst\u72b6\u6001\u7684\u5b50\u96c6\n\n## code#1\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nbitset<100001>y[20];\nint z[20][20];\nint f[20][1<<20];\nint val[20][1<<20];\nint W[20][100001];\nbool pd(int st)//\u5224\u65ad\u72b6\u6001st\u662f\u5426\u5408\u6cd5\n{\n\tint now = 1;\n\tint qwq[20];\n\tint tot = 0;\n\twhile(st)\n\t{\n\t\tif(st & 1)\n\t\t{\n\t\t\tqwq[++tot] = now;//\u6709\u5f53\u524d\u7684\u72b6\u6001\uff0c\u8bb0\u5f55\n\t\t}\n\t\tst >>= 1;\n\t\tnow++;\n\t}\n\tfor(int i = 1; i <= tot; i++)\n\t{\n\t\tfor(int j = 1; j < i; j++)\n\t\t{\n\t\t\tbitset<100001> ls;\n\t\t\tls = y[qwq[i]] & y[qwq[j]];\n\t\t\tif(ls.count()) return 1;//\u4e0d\u5408\u6cd5\n\t\t}\n\t}\n\treturn 0;\n}\nsigned main()\n{\n\t// freopen(\"cold.in\", \"r\", stdin);\n\tmemset(f, 0x3f, sizeof(f));\n\tint n, m;\n\tcin >> n >> m;\n\tfor(int i = 1; i <= n; i++)\n\t{\n\t\tfor(int j = 1; j <= m; j++)\n\t\t{\n\t\t\tcin >> W[i][j];\n\t\t}\n\t}\n\tfor(int i = 1; i <= n; i++)\n\t{\n\t\tint x;\n\t\tcin >> x;\n\t\tfor(int j = 1; j <= x; j++)\n\t\t{\n\t\t\tint qwq;\n\t\t\tcin >> qwq;\n\t\t\ty[i][qwq] = 1;\n\t\t\tfor(int k = 1; k <= n; k++)\n\t\t\t{\n\t\t\t\tz[i][k] += W[k][qwq];\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i = 1; i <= n; i++)\n\t{\n\t\tfor(int st = 0; st <= (1 << n) - 1; st++)\n\t\t{\n\t\t\tif(pd(st)) val[i][st] = 0x3fffffffffffffff;\n\t\t\telse\n\t\t\t{\n\t\t\t\tint qwq = st;\n\t\t\t\tint now = 1;\n\t\t\t\twhile(qwq)\n\t\t\t\t{\n\t\t\t\t\tif(qwq & 1) val[i][st] += z[now][i];\n\t\t\t\t\tqwq >>= 1;\n\t\t\t\t\tnow++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tf[0][0] = 0;\n\tfor(int i = 1; i <= n; i++)\n\t{\n\t\tfor(int j = 0; j <= (1 << n) - 1; j++)\n\t\t{\n\t\t\tfor(int s = 0; s <= (1 << n) - 1; s++)\n\t\t\t{\n\t\t\t\tif((j | s) != j) continue;\n\t\t\t\tf[i][j] = min(f[i][j], f[i - 1][s] + val[i][j - s]);\n\t\t\t}\n\t\t}\n\t}\n\tcout << f[n][(1 << n) - 1] << endl;\n}\n```\n\u63d0\u4ea4\u4e0a\u53bb\u53d1\u73b0\u62ff\u5230\u4e8670\u5206\u7684\u597d\u6210\u7ee9\uff0c\u5269\u4e0b\u7684T\u4e86\n\n\u7136\u540e\u53d1\u73b0\u6211\u4eec\u5728\u679a\u4e3ej\u7684\u5b50\u96c6\u8f6c\u79fb\u65f6\uff0c\u662f\u76f4\u63a5\u66b4\u529b$2^N$\u679a\u4e3e\uff0c\u5bfc\u81f4\u591a\u679a\u4e3e\u4e86\u5f88\u591a\u6ca1\u6709\u7528\u7684\u72b6\u6001\n\n\u4e8e\u662f\u8981\u8003\u8651\u67d0\u4e9b~~\u5947\u6280\u6deb\u5de7~~\u66f4\u4f18\u79c0\u7684\u679a\u4e3e\u65b9\u6cd5\uff1a\n\n```cpp\nfor(int s = j; s; s = j & (s - 1))\n```\n\n\u8fd9\u6837\u53ef\u4ee5\u4fdd\u8bc1\u6bcf\u4e2as\u90fd\u662fj\u7684\u5b50\u96c6\u5e76\u4e14\u4e0d\u4f1a\u591a\u679a\u4e3e\u5176\u4ed6\u7684\u4e1c\u897f\n\n\u4e8e\u662f\u4f18\u5316\u6389\u4e86\u4e00\u4e2a$2^N$\uff0c~~\u597d\u8036~~\n\n\u4f46\u662f\u6ce8\u610f\u5230\u4e00\u4e2a\u95ee\u9898\uff1a\u8fd9\u4e2a\u65b9\u6cd5\u65e0\u6cd5\u679a\u4e3e\u52300\uff0c\u9700\u8981\u7279\u5224\u4e00\u4e0b\uff0c\u5426\u5219\u65e0\u6cd5\u66f4\u65b0\u7b54\u6848\n\n\u5269\u4e0b\u7684\u5c31\u662f\u4f18\u5316\u4f18\u5316\u8bfb\u5165\u4ec0\u4e48\u7684\u5c31\u8fc7\u4e86\uff08\n\n~~\u56e0\u4e3a\u592a\u61d2\u5c31\u76f4\u63a5sync_with_stdio(false)\u4e86\uff0c\u7ed3\u679c\u6210\u529f\u8dd1\u5230\u6700\u4f18\u89e3\u5012\u6570\u7b2c\u4e00~~\n\n## code#2\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nbitset<100001>y[20];\nint z[20][20];\nint f[20][1<<20];\nint val[20][1<<20];\nint W[20][100001];\nbool pd(int st)\n{\n\tint now = 1;\n\tint qwq[20];\n\tint tot = 0;\n\twhile(st)\n\t{\n\t\tif(st & 1)\n\t\t{\n\t\t\tqwq[++tot] = now;\n\t\t}\n\t\tst >>= 1;\n\t\tnow++;\n\t}\n\tfor(int i = 1; i <= tot; i++)\n\t{\n\t\tfor(int j = 1; j < i; j++)\n\t\t{\n\t\t\tbitset<100001> ls;\n\t\t\tls = y[qwq[i]] & y[qwq[j]];\n\t\t\tif(ls.count()) return 1;\n\t\t}\n\t}\n\treturn 0;\n}\nsigned main()\n{\n\tios::sync_with_stdio(false);\n\tmemset(f, 0x3f, sizeof(f));\n\tint n, m;\n\tcin >> n >> m;\n\tfor(int i = 1; i <= n; i++)\n\t{\n\t\tfor(int j = 1; j <= m; j++)\n\t\t{\n\t\t\tcin >> W[i][j];\n\t\t}\n\t}\n\tfor(int i = 1; i <= n; i++)\n\t{\n\t\tint x;\n\t\tcin >> x;\n\t\tfor(int j = 1; j <= x; j++)\n\t\t{\n\t\t\tint qwq;\n\t\t\tcin >> qwq;\n\t\t\ty[i][qwq] = 1;\n\t\t\tfor(int k = 1; k <= n; k++)\n\t\t\t{\n\t\t\t\tz[i][k] += W[k][qwq];\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i = 1; i <= n; i++)\n\t{\n\t\tfor(int st = 0; st <= (1 << n) - 1; st++)\n\t\t{\n\t\t\tif(pd(st)) val[i][st] = 0x3fffffffffffffff;\n\t\t\telse\n\t\t\t{\n\t\t\t\tint qwq = st;\n\t\t\t\tint now = 1;\n\t\t\t\twhile(qwq)\n\t\t\t\t{\n\t\t\t\t\tif(qwq & 1) val[i][st] += z[now][i];\n\t\t\t\t\tqwq >>= 1;\n\t\t\t\t\tnow++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tf[0][0] = 0;\n\tfor(int i = 1; i <= n; i++)\n\t{\n\t\tfor(int j = 0; j <= (1 << n) - 1; j++)\n\t\t{\n\t\t\tfor(int s = j; s; s = j & (s - 1))\n\t\t\t{\n\t\t\t\tf[i][j] = min(f[i][j], f[i - 1][s] + val[i][j - s]);\n\t\t\t}\n\t\t\tint s = 0;\n\t\t\tf[i][j] = min(f[i][j], f[i - 1][s] + val[i][j - s]);\n\t\t}\n\t}\n\tcout << f[n][(1 << n) - 1] << endl;\n\treturn 0;\n}\n\n```",
        "postTime": 1606218793,
        "uid": 75954,
        "name": "AuCloud",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P7098 \u3010[yLOI2020] \u51c9\u51c9\u3011"
    },
    {
        "content": "\u770b\u4e00\u4e0b\u6570\u636e\u8303\u56f4\u5c31\u53ef\u4ee5\u8003\u8651\u72b6\u538b\u4e86\u3002\u4e00\u9053\u597d\u9898\uff0c\u4e0d\u7b97\u5f88\u96be\uff0c\u8010\u5fc3\u63a8\u4e00\u63a8\u8fd8\u662f\u597d\u505a\u7684\u3002\uff08\u6700\u7ec8\u7684 dp \u8f6c\u79fb\u5c31\u5341\u51e0\u884c\uff0c\u4f46\u662f\u9884\u5904\u7406\u5de8\u591a\u65e0\u6bd4\uff01\uff09\n\n\u8fd9\u4e2a $n$ \u5f88\u5c0f\uff0c\u8003\u8651\u72b6\u538b\uff0c\u5373\u8003\u8651\u4e00\u4e2a\u72b6\u6001\u96c6\u5408\u5185\u90e8\u7684\u6240\u6709\u7ebf\u8def\u90fd\u8fd0\u884c\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\u4f46\u662f\u8fd9\u6837\u8fd8\u662f\u4e0d\u597d\u8f6c\u79fb\uff0c\u56e0\u4e3a\u7ebf\u8def\u6df1\u5ea6\u4e5f\u662f\u5f88\u91cd\u8981\u7684\u4e00\u4e2a\u56e0\u7d20\uff0c\u6211\u4eec\u628a\u8fd9\u4e00\u8981\u7d20\u4e5f\u8bbe\u5230\u72b6\u6001\u4e2d\uff1a$f_{S,j}$ \u8868\u793a\u96c6\u5408 $S$ \u5185\u7684\u6240\u6709\u7ebf\u8def\u5728\u6df1\u5ea6\u4e0d\u8d85\u8fc7 $j$ \u7684\u60c5\u51b5\u4e0b\u8fd0\u884c\u7684\u6700\u5c0f\u82b1\u8d39\u3002\u8f6c\u79fb\u5f88\u81ea\u7136\uff08\u679a\u4e3e\u4e00\u4e2a\u5b50\u96c6\uff0c\u4f7f\u8fd9\u4e2a\u5b50\u96c6\u4e2d\u7684\u7ebf\u8def\u5728\u66f4\u6d45\u7684\u5730\u65b9\u8fd0\u884c\uff0c\u8865\u96c6\u5728\u5f53\u524d\u6df1\u5ea6\u8fd0\u884c\uff09\uff1a\n\n$$\nf_{S,j}=\\min_{s\\subseteq S,can_{\\complement_Ss}}(f_{s,j-1}+v_{\\complement_Ss,j})\n$$\n\n\u6700\u7ec8\u7b54\u6848\u4e3a $f_{2^n-1,n}$\u3002\n\n\u5b9a\u4e49 $v_{S,j}$ \u6307\u96c6\u5408 $S$ \u4e2d\u6240\u6709\u7ebf\u8def\u90fd\u5728\u6df1\u5ea6 $j$ \u8fd0\u884c\u7684\u82b1\u8d39\u3002$can_{S}$ \u8bb0\u5f55\u96c6\u5408 $S$ \u4e2d\u7684\u6240\u6709\u7ebf\u8def\u80fd\u5426\u5728\u540c\u4e00\u6df1\u5ea6\u8fd0\u884c\u3002\u8fd9\u4e24\u4e2a\u4e1c\u897f\u53ef\u4ee5\u9884\u5904\u7406\u3002\n\n\u8003\u8651 $v$ \u7684\u8ba1\u7b97\u3002\u7531\u4e8e\u6bcf\u6761\u7ebf\u8def\u9014\u5f84\u7684\u70b9\u6570\u53ef\u4ee5\u5f88\u591a\uff0c\u6211\u4eec\u679a\u4e3e\u6240\u6709\u96c6\u5408\uff0c\u7136\u540e\u679a\u4e3e\u96c6\u5408\u4e2d\u7684\u6bcf\u6761\u7ebf\u8def\uff0c\u518d\u679a\u4e3e\u6bcf\u6761\u7ebf\u8def\u7ecf\u8fc7\u7684\u70b9\u662f\u4e0d\u73b0\u5b9e\u7684\u3002\u6211\u4eec\u8003\u8651\u518d\u9884\u5904\u7406\u4e00\u4e2a $cost_{i,j}$\uff0c\u8868\u793a\u7ebf\u8def $i$ \u5728\u6df1\u5ea6 $j$ \u8fd0\u884c\u7684\u82b1\u8d39\uff0c\u8fd9\u4e2a\u5341\u5206\u5bb9\u6613\u3002\u540c\u65f6 $v$ \u7684\u8ba1\u7b97\u4e2d\u7701\u6389\u4e86\u679a\u4e3e\u9014\u5f84\u70b9\u7684\u8fc7\u7a0b\uff0c\u8fd9\u6837\u5c31\u5f88\u9ad8\u6548\u4e86\u3002\u8ba1\u7b97 $cost$ \u662f $O(n^2m)$ \u7684\uff0c\u8ba1\u7b97 $v$ \u662f $O(2^n n^2)$ \u7684\u3002\n\n\u518d\u8003\u8651 $can$ \u7684\u9884\u5904\u7406\u3002\u7ed9\u6211\u4eec\u82e5\u5e72\u7ebf\u8def\uff0c\u5224\u65ad\u6709/\u65e0\u4ea4\uff0c\u5e76\u4e0d\u597d\u76f4\u63a5\u505a\u3002\u4f46\u662f\u6211\u4eec\u53d1\u73b0\uff1a\u8fd9\u4e9b\u7ebf\u8def\u4e24\u4e24\u65e0\u4ea4\uff0c\u7b49\u4ef7\u4e8e\u653e\u5728\u4e00\u8d77\u65e0\u4ea4\u3002\u5bf9\u4e8e\u4e00\u4e2a\u96c6\u5408\uff0c\u4e24\u4e24\u679a\u4e3e\u5176\u5305\u542b\u7684\u7ebf\u8def\uff0c\u67e5\u770b\u662f\u5426\u6709\u4ea4\u5373\u53ef\uff0c\u90fd\u65e0\u4ea4\u5219\u65e0\u4ea4\u3002\u90a3\u4e48\u600e\u4e48\u5224\u65ad\u4e24\u4e2a\u7ebf\u8def\u662f\u5426\u6709\u4ea4\uff1f\u9884\u5904\u7406 $valid_{i,j}$ \u8868\u793a $i$ \u548c $j$ \u7ebf\u8def\u53ef\u4ee5\u5728\u540c\u4e00\u6df1\u5ea6\u8fd0\u884c\uff0c\u8fd9\u4e2a\u501f\u52a9\u6876\u53ef\u4ee5\u5728 $O(n^2m)$ \u7684\u65f6\u95f4\u4e2d\u8ba1\u7b97\u51fa\u6765\u3002\u7136\u540e $can$ \u5c31\u53ef\u4ee5 $2^nn^2$ \u6c42\u51fa\u4e86\u3002\n\n\u5514\uff0c\u597d\u9ebb\u70e6\u7684\u9884\u5904\u7406\u5230\u6b64\u5c31\u7ed3\u675f\u4e86\uff01\n\n\u8fd8\u6709\u5c31\u662f $f$ \u8981\u521d\u59cb\u5316\u4e3a $\\inf$\u3002$f_{0,i}$ \u8981\u521d\u59cb\u4e3a $0$\u3002\n\n\u5c31\u8fd9\u6837\u4e86\uff0c\u653e\u4e2a\u4ee3\u7801\u5427 qwq\u3002\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nconst int N=15,M=100010;\nint a[N][M];//a[i][j]:\u6df1\u5ea6\u4e3ai\u7ecf\u8fc7j\u7ad9\u70b9\u7684\u8d39\u7528 \nint cost[N][N];//cost[i][j]:\u7b2ci\u6761\u7ebf\u8def\u5728\u6df1\u5ea6j\u8fd0\u884c\u7684\u8d39\u7528\nint f[1<<N][N];//f[i][j]:\u72b6\u6001\u4e3ai\u7684\u7ebf\u8def\u5728\u5c0f\u4e8e\u7b49\u4e8ej\u7684\u6df1\u5ea6\u8fd0\u884c\u7684\u8d39\u7528\nint n,m;\nbool valid[N][N];//valid[i][j]:i\u548cj\u7ebf\u8def\u80fd\u5426\u5728\u540c\u4e00\u6df1\u5ea6\u8fd0\u884c\nbool can[1<<N];//can[i]:\u72b6\u6001\u4e3ai\u7684\u7ebf\u8def\u80fd\u5426\u5728\u540c\u4e00\u6df1\u5ea6\u8fd0\u884c \nint p[N][M],sz[N];\nbool bin[M];\nint stk[N],top;\nint v[1<<N][N];//v[i][j]:\u72b6\u6001\u4e3ai\u7684\u7ebf\u8def\u5728\u6df1\u5ea6j\u8fd0\u884c\u7684\u8d39\u7528 \nsigned main(){\n\tcin>>n>>m;\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++)\n\t\t\tcin>>a[i][j];\n\tfor(int i=1;i<=n;i++){\n\t\tcin>>sz[i];\n\t\tfor(int j=1;j<=sz[i];j++)\n\t\t\tcin>>p[i][j];\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=1;j<=sz[i];j++)\n\t\t\tbin[p[i][j]]=1;\n\t\tfor(int j=i+1;j<=n;j++){\n\t\t\tvalid[i][j]=valid[j][i]=1;\n\t\t\tfor(int k=1;k<=sz[j];k++){\n\t\t\t\tif(bin[p[j][k]]){\n\t\t\t\t\tvalid[i][j]=valid[j][i]=0;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int j=1;j<=sz[i];j++)\n\t\t\tbin[p[i][j]]=0;\n\t}\n\tfor(int i=0;i<(1<<n);i++){\n\t\tcan[i]=1;\n\t\ttop=0;\n\t\tfor(int j=0;j<n;j++){\n\t\t\tif((i>>j)&1){\n\t\t\t\ttop++;\n\t\t\t\tstk[top]=j+1;\n\t\t\t}\n\t\t}\n\t\tfor(int j=1;j<=top;j++){\n\t\t\tif(!can[i])\n\t\t\t\tbreak;\n\t\t\tfor(int k=j+1;k<=top;k++){\n\t\t\t\tif(!can[i])\n\t\t\t\t\tbreak;\n\t\t\t\tif(!valid[stk[j]][stk[k]])\n\t\t\t\t\tcan[i]=0;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tfor(int k=1;k<=sz[i];k++)\n\t\t\t\tcost[i][j]+=a[j][p[i][k]];\n\tfor(int i=1;i<(1<<n);i++)\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tfor(int k=0;k<n;k++)\n\t\t\t\tif((i>>k)&1)\n\t\t\t\t\tv[i][j]+=cost[k+1][j];\n\tmemset(f,0x3f,sizeof(f));\n\tfor(int i=0;i<=n;i++)\n\t\tf[0][i]=0;\n\tfor(int S=1;S<(1<<n);S++){\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tfor(int s=S;;s=((s-1)&S)){//\u679a\u4e3e\u5b50\u96c6\uff0c\u72b6\u538b\u9898\u5e38\u89c4\u6280\u5de7 \n\t\t\t\tint x=S^s;\n\t\t\t\tif(!can[x]){\n\t\t\t\t\tif(!s)\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tf[S][j]=min(f[S][j],f[s][j-1]+v[x][j]);\n\t\t\t\tif(!s)\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tcout<<f[(1<<n)-1][n];\n\treturn 0;\n}\n```",
        "postTime": 1663295391,
        "uid": 140360,
        "name": "LKawaii",
        "ccfLevel": 0,
        "title": "P7098 \u9898\u89e3"
    },
    {
        "content": "[P7098 [yLOI2020] \u51c9\u51c9](https://www.luogu.com.cn/problem/P7098)\n\n\u8003\u524d\u590d\u4e60\u72b6\u538bDP\u3002\n\n## \u3010\u9898\u610f\u3011\n\n\u5730\u4e0b\u6709 $n$ \u5c42\uff0c\u9700\u8981\u5efa\u8bbe $n$ \u6761\u7ebf\u8def\uff0c\u4e00\u6761\u7ebf\u8def\u53ea\u80fd\u5728\u4e00\u4e2a\u6df1\u5ea6\uff0c\u6bcf\u6761\u7ebf\u8def\u4f1a\u7ecf\u8fc7\u82e5\u5e72\u7ad9\u70b9\uff0c\u5171\u6709 $m$ \u4e2a\u7ad9\u70b9\uff0c\u5728\u7b2c $i$ \u5c42\u7ecf\u8fc7\u7ad9\u70b9 $j$ \u9700\u8981\u4ee3\u4ef7 $a_{i,j}$\uff0c \u7ecf\u8fc7\u540c\u4e00\u4e2a\u7ad9\u70b9\u7684\u4e24\u6761\u7ebf\u8def\u4e0d\u80fd\u5728\u540c\u4e00\u5c42\uff0c\u6c42\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n## \u3010\u5206\u6790\u3011\n\n\u6ce8\u610f\u5230 $n \\leqslant 14$\uff0c\u8003\u8651\u72b6\u538bDP\u3002\n\n### \u8bbe\u8ba1\u72b6\u6001\n\n\u5b9a\u4e49 $f_{i,S}$ \u8868\u793a\u524d $i$ \u5c42\uff0c\u5df2\u5efa\u8bbe\u7684\u7ebf\u8def\u72b6\u6001\u4e3a $S$ \u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n### \u8003\u8651\u8f6c\u79fb\n\n\u8f6c\u79fb\u5c31\u662f $f_{i,S}=\\min(f_{i-1,S-T}+V_T),T \\subseteq S$\u3002\n\n$T$ \u662f\u5728\u7b2c $i$ \u5c42\u5efa\u7684\u7ebf\u8def\u96c6\u5408\uff0c$V_T$ \u5373\u76f8\u5e94\u7684\u4ee3\u4ef7\u3002\n\n\u590d\u6742\u5ea6 $O(n\\cdot3^n)$\u3002\n\n### \u8ba1\u7b97 $V_S$\n\n\u9996\u5148\u8981\u77e5\u9053 $S$ \u8fd9\u4e2a\u72b6\u6001\u5728\u540c\u4e00\u5c42\u662f\u5426\u5408\u6cd5\u3002\n\n\u5982\u679c\u5408\u6cd5\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u5c42\uff0c\u5bf9\u9700\u8981\u7684\u7ad9\u70b9\u7684\u4ee3\u4ef7\u6c42\u548c\u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6 $O( 2^n\\cdot n^2)$\u3002\n\n### \u5224\u65ad $S$ \u7684\u5408\u6cd5\u6027\n\n$S$ \u5408\u6cd5\uff0c\u5373 $S$ \u4e2d\u7684\u4efb\u610f\u4e24\u6761\u7ebf\u8def\u90fd\u4e0d\u51b2\u7a81\u3002\n\n\u679a\u4e3e\u4e24\u6761\u7ebf\u8def\uff0c\u518d\u679a\u4e3e\u7ad9\u70b9\uff0c\u9010\u4e00\u5224\u65ad\uff08\u8fd9\u91cc\u4f3c\u4e4e\u53ef\u4ee5\u7528bitset\u4f18\u5316\u5e38\u6570\uff09\u3002\n\n\u590d\u6742\u5ea6 $O(n^2\\cdot m)$\u3002\n\n\u518d\u679a\u4e3e $S$\uff0c\u679a\u4e3e $S$ \u4e2d\u7684\u4e24\u6761\u7ebf\u8def\u3002\n\u590d\u6742\u5ea6 $O(2^n\\cdot n^2)$\u3002\n\n------------\n\n\u6bcf\u4e00\u90e8\u5206\u7684\u590d\u6742\u5ea6\u90fd\u662f\u5408\u7406\u7684\u3002\n\n\u6839\u636e\u4ee5\u4e0a\u601d\u8def\u5373\u53ef\u901a\u8fc7\u6b64\u9898\u3002\n\n## \u3010\u89e3\u6cd5\u3011\n\n\u72b6\u538bDP\n\n## \u3010\u4ee3\u7801\u3011\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nchar gc(){\n    static char buf[100000],*p1=buf,*p2=buf;\n    return p1==p2&&(p2=(p1=buf)+fread(buf,1,100000,stdin),p1==p2)?EOF:*p1++;\n}\n#define getchar gc\nint read(){\n    int ret=0,f=1;char ch=getchar();\n    while(ch>'9'||ch<'0'){if(ch=='-')f=-f;ch=getchar();}\n    while(ch>='0'&&ch<='9') ret=ret*10+ch-'0',ch=getchar();\n    return ret*f;\n}\n#define LL long long\nconst int maxn=16,maxm=1e5+5,maxs=(1<<14)+5;\nconst LL INF=1ll<<62;\nint n,m;\nLL a[maxn][maxm],v[maxs],c[maxn][maxn],f[maxn][maxs];\nbool p[maxn][maxm],pe[maxn][maxn],vis[maxs];\nint s[maxs];\nint cnt(int S){\n\tint ret=0;\n\twhile(S) S-=S&-S,ret++;\n\treturn ret; \n}\nbool check(int i,int j){\n\tfor(int k=1;k<=m;k++) if(p[i][k]&p[j][k]) return 0;\n\treturn 1;\n}\nint main(){\n\t#ifndef ONLINE_JUDGE\n\tfreopen(\"P7098.in\",\"r\",stdin);\n\tfreopen(\"P7098.out\",\"w\",stdout);\n\t#endif\n\tn=read(),m=read();\n\tfor(int i=1;i<=n;i++)\n\tfor(int j=1;j<=m;j++) a[i][j]=read();\n\tfor(int i=0;i<n;i++){\n\t\tint z=read();\n\t\twhile(z--){\n\t\t\tint x=read();\n\t\t\tfor(int j=1;j<=n;j++) c[j][i]+=a[j][x];\n\t\t\tp[i][x]=1;\n\t\t}\n\t\tvis[1<<i]=1;\n\t}\n\tfor(int i=0;i<n;i++)\n\tfor(int j=i+1;j<n;j++) pe[i][j]=check(i,j);\n\tfor(int S=3,eS=1<<n;S<eS;S++) if(!vis[S]){\n\t\tvis[S]=1;\n\t\tfor(int j=0;j<n&&vis[S];j++) if((S>>j)&1)\n\t\tfor(int k=j+1;k<n&&vis[S];k++) if((S>>k)&1) vis[S]&=pe[j][k]; \n\t}\n\tfor(int S=1,eS=1<<n;S<eS;S++) f[0][S]=INF;\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int S=1,eS=1<<n;S<eS;S++) if(vis[S]){\n\t\t\tv[S]=0;\n\t\t\tfor(int j=0;j<n;j++) if((S>>j)&1) v[S]+=c[i][j];\n\t\t}\n\t\tfor(int S=0,eS=1<<n;S<eS;S++){\n\t\t\tf[i][S]=f[i-1][S];\n\t\t\tfor(int T=S;T;T=S&(T-1)) if(vis[T]) f[i][S]=min(f[i][S],f[i-1][S^T]+v[T]);\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",f[n][(1<<n)-1]);\n\treturn 0;\n}\n```\n",
        "postTime": 1637067023,
        "uid": 116251,
        "name": "\u7834\u5fc6",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P7098 \u3010[yLOI2020] \u51c9\u51c9\u3011"
    },
    {
        "content": "\u7ec8\u4e8e\u5199\u5b8c\u4eca\u5e74 yLOI \u4e86 qwq\n\n~~\u94f6\u4e34\u5973\u795e\u652f\u6301\u6211\u5199\u9898~~\n\n\u8fd9\u9898\u770b\u5230\u6570\u636e\u8303\u56f4 $n\\le 14$ \u660e\u793a\u72b6\u538b\uff0c\u4f46\u662f\u72b6\u538b\u72b6\u6001\u5374\u76f8\u5bf9\u96be\u5206\u6790\u4e00\u70b9\uff0c\u56e0\u4e3a\u5728\u601d\u8003\u7206\u641c\u7b56\u7565\u65f6\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u4e0d\u4ec5\u4ec5\u9700\u8981\u5173\u5fc3\u67d0\u4e00\u6761\u7ebf\u8def\u6216\u8005\u67d0\u4e00\u4e2a\u6df1\u5ea6\u662f\u5426\u88ab\u9009\u62e9\uff0c\u540c\u6837\u4e5f\u8981\u5173\u5fc3\u54ea\u6761\u7ebf\u8def\u9009\u62e9\u4e86\u54ea\u4e2a\u6df1\u5ea6\uff0c\u4ee5\u4fbf\u4e8e\u4e0d\u540c\u7ebf\u8def\u4e4b\u95f4**\u5408\u5e76**\u7684\u8fdb\u884c\u3002\n\n\u7136\u800c\uff0c\u6211\u4eec\u4e0d\u59a8\u8003\u8651\u5bf9\u963b\u788d\u72b6\u538b\u7684\u56e0\u7d20\uff1a\u5408\u5e76\uff0c\u8fdb\u884c\u9884\u5904\u7406\uff0c\u5c06\u5168\u90e8\u53ef\u4ee5\u5408\u5e76\u7684\u7ebf\u8def\uff08\u5373\u653e\u5728\u540c\u4e00\u5c42\u4e0d\u4f1a\u53d1\u751f\u51b2\u7a81\uff09\u63d0\u524d\u5408\u5e76\uff0c\u90a3\u4e48\u5c31\u53d8\u6210\u4e86\u4e24\u4e2a\u5206\u522b\u5904\u7406\u7684\u57fa\u7840\u72b6\u538b $dp$ \u95ee\u9898\u4e86\u3002\n\n\u5408\u5e76\u7684\u601d\u8def\uff1a\n\n\u4ee4 $d_{i,set}$ \u8868\u793a $set$ \u96c6\u5408\u5185\u7684\u6240\u6709\u5217\u8f66\u653e\u5728\u7b2c $i$ \u5c42\u6240\u9700\u7684\u8d39\u7528\uff0c\u5bb9\u6613\u5f97\u5230\u72b6\u538b\u7b56\u7565\uff1a\n\n\u82e5\u65b0\u52a0\u5165\u7684\u5217\u8f66 $j$ \u4e0e\u539f\u96c6\u5408 $set$ \u4e0d\u51b2\u7a81\uff0c\u5373\u53ef\u8fdb\u884c\u72b6\u6001\u8f6c\u79fb\uff1a\n\n $d_{i,set\\bigcup\\{j\\}}=min\\{d_{i,set\\bigcup\\{j\\}},d_{i,set}+sum_{j,i}\\}$\n \n\u72b6\u538b $dp$ \u7684\u601d\u8def\uff1a\n\n\u4ee4 $f_{i,set}$ \u8868\u793a $set$ \u96c6\u5408\u5185\u6240\u6709\u5217\u8f66\u653e\u5728\u524d $i$ \u5c42\u6240\u9700\u7684\u8d39\u7528\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u679a\u4e3e\u5b50\u96c6\u6765\u505a\u4e86\uff1a\n\n\u5bf9\u4e8e\u7b2c$i$\u5c42\u6bcf\u4e2a\u53ef\u9009\u7684\u5217\u8f66\u96c6\u5408 $j$\uff0c\u679a\u4e3e\u5b83\u7684\u5b50\u96c6 $k$\uff0c\u4ee4 $l=\\complement_jk$\uff0c\u5219\u53ef\u4ee5\u8fdb\u884c\u72b6\u6001\u8f6c\u79fb\uff1a\n\n$f_{i,j} = min\\{f_{i,j}, f_{i-1,l} + d[i][k]\\}$\n\n\u6700\u540e$ans=f_{i,U}$\n\n\u5f53\u7136\uff0c\u7531\u4e8e\u72b6\u538b $dp$ \u4e2d $4^n$ \u7684\u590d\u6742\u5ea6\u4ecd\u7136\u65e0\u6cd5\u63a5\u53d7\uff0c\u6240\u4ee5\u8fd8\u8981\u7528\u4e2a\u679a\u4e3e\u5b50\u96c6\u7684 trick\n\n```cpp\nfor (int k = j; k; k = j & (k - 1))\n```\n\n\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u4f1a\u964d\u4e3a $n \\times \\Sigma_{i=0}^{n} C_n^i\\times 2^i\\times 1^{n-i}=n\\times 3^n$ \u4e86\n\n\u5b8c\u6574\u4ee3\u7801\uff1a\n\n\uff08\u8bb0\u5f97\u5f00long long\uff09\n\n```cpp\n#include <bits/stdc++.h>\n\n#define int long long\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst int MAXN = 16;\nconst int MAXS = 1 << 16;\nconst int MAXM = 1e5 + 5;\n\nint n, m;\nint siz[MAXN];\nbitset<MAXM> sta[MAXN];\nint price[MAXN][MAXM], data[MAXN][MAXM];\n\n// sum[i][j] refer to the price of constructing all the stations for train j at the height i\nint sum[MAXN][MAXN];\n// d[i][j] refer to the price of constructing all the stations for trains in set(j) at the height i\nint d[MAXN][MAXS];\n// f[i][j] refer to the price of constructing all the stations for trains in set(j) beyond or at height i\nint f[MAXN][MAXS];\n\nsigned main()\n{\n    memset(d, 0x3f, sizeof(d));\n    memset(f, 0x3f, sizeof(f));\n    scanf(\"%lld%lld\", &n, &m);\n    for (int i = 1; i <= n; i++)\n    {\n        d[i][0] = 0;\n        for (int j = 1; j <= m; j++)\n            scanf(\"%lld\", &price[i][j]);\n    }\n    for (int i = 0; i < n; i++)\n    {\n        scanf(\"%lld\", &siz[i]);\n        for (int j = 1; j <= siz[i]; j++)\n        {\n            scanf(\"%lld\", &data[i][j]);\n            sta[i].set(data[i][j]);\n        }\n        for (int j = 1; j <= n; j++)\n        {\n            for (int k = 1; k <= siz[i]; k++)\n                sum[j][i] += price[j][data[i][k]];\n        }\n    }\n    int maxt = 1 << n;\n    for (int i = 1; i <= n; i++)\n    {\n        for (int j = 0; j < maxt; j++)\n        {\n            if (d[i][j] > 1e15)\n                continue;\n            bitset<MAXM> now;\n            now.reset();\n            for (int k = 0; k < n; k++)\n                if ((j >> k) & 1)\n                    now |= sta[k];\n            for (int k = 0; k < n; k++)\n            {\n                if (!((j >> k) & 1) && !(now & sta[k]).count())\n                {\n                    int nex = j | (1 << k);\n                    d[i][nex] = min(d[i][nex], d[i][j] + sum[i][k]);\n                }\n            }\n        }\n    }\n    f[0][0] = 0;\n    for (int i = 1; i <= n; i++)\n    {\n        for (int j = 0; j < maxt; j++)\n        {\n            f[i][j] = f[i - 1][j];\n            for (int k = j; k; k = j & (k - 1))\n            {\n                int res = j ^ k;\n                f[i][j] = min(f[i][j], f[i - 1][res] + d[i][k]);\n            }\n        }\n    }\n    printf(\"%lld\", f[n][maxt - 1]);\n    return 0;\n}\n```",
        "postTime": 1606734192,
        "uid": 58826,
        "name": "Conless",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P7098 \u3010[yLOI2020] \u51c9\u51c9\u3011"
    }
]
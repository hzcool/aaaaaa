[
    {
        "content": "\u56e0\u4e3a\u4e94\u54e5 APIO \u83b7\u5f97\u4e86 221.36 \u5206\u7684\u9ad8\u5206\uff0c\u4f4d\u5c45\u4e2d\u56fd\u56fd\u9645\u91d1\u724c\u5916 rk2\uff0c\u6240\u4ee5\u6709\u4e86\u8fd9\u7bc7\u9898\u89e3\u3002\n\n\u663e\u7136\u5982\u679c $y^x=x^z$\uff0c\u90a3\u4e48\u4e00\u5b9a\u6709 $x=p^a,y=p^b$\u3002\n\n\u8003\u8651\u4fdd\u8bc1 $(a,b)=1$\uff0c\u628a\u8fd9\u73a9\u610f\u4ee3\u5165\u8fdb\u53bb\u3002\n\n$$(p^b)^{p^a}=(p^a)^z$$\n\n$$p^{bp^a}=p^{az}$$\n\n$$bp^a=az$$\n\n$$p^a=\\dfrac a b z$$\n\n\u5148\u7279\u5224\u6389 $p=1$ \u7684\u60c5\u51b5\u4e4b\u540e\u554a\uff0c\u8fd9\u4e2a $p\\ge 2$\uff0c\u6240\u4ee5 $a,b$ \u4e5f\u5c31 $<\\log V$\u4e86\u3002\n\n\u7136\u540e\u679a\u4e3e\u8fd9\u4e2a $a,b$\uff0c\u8003\u8651\u600e\u4e48\u5feb\u901f\u53bb\u8ba1\u7b97\u6709\u591a\u5c11 $p,z$ \u4f7f\u5f97 $p^a=\\dfrac a b z$\u3002\n\n\u90a3\u5de6\u8fb9\u662f\u4e2a $a$ \u6b21\u65b9\u6570\uff0c\u53f3\u8fb9\u4e5f\u662f $a$ \u6b21\u65b9\u6570\uff0c\u800c $(a,b)=1$ \u6240\u4ee5 $z$ \u5f97\u662f $b$ \u7684\u500d\u6570\u3002\u8bb0 $z'=\\dfrac z b$\uff0c\u5219 $p^a=az'$\uff0c$z'\\le \\dfrac C b$\u3002\n\n\u7136\u540e\u53c8\u53ef\u4ee5\u628a\u53f3\u8fb9\u8868\u793a\u6210 $af_az''$\uff0c\u5176\u4e2d $f_a$ \u662f\u6ee1\u8db3 $af_a$ \u662f $a$ \u6b21\u65b9\u6570\u7684\u6700\u5c0f\u6b63\u6574\u6570\u3002\u8fd9\u73a9\u610f\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u6765\u3002\u8fd9\u6837\u53ea\u8981 $z''$ \u662f $a$ \u6b21\u65b9\u6570\u5e76\u4e14 $\\sqrt[a]{af(a)}|p$ \u5c31\u884c\u4e86\u3002\n\n\u90a3\u8fd9\u73a9\u610f\u6700\u540e\u5c31\u662f\u6c42 $\\sqrt[a]{r}$ \u8fd9\u6837\u7684\u4e1c\u897f\u4e0b\u53d6\u6574\uff0c\u76f4\u63a5 pow \u4e4b\u7c7b\u6709\u7cbe\u5ea6\u635f\u5931\uff0c\u624b\u5199\u4e2a\u4e8c\u5206\u5c31\u80fd\u8fc7\u4e86\u3002\n",
        "postTime": 1654668877,
        "uid": 735057,
        "name": "wghyt1314",
        "ccfLevel": 0,
        "title": "wghyt1314"
    },
    {
        "content": "\u6b64\u9898\u89e3\u4e3a\u5b98\u65b9\u9898\u89e3\n\n\u8003\u8651\u8bbe $y^x=x^z=d^{[x,z]}$\uff0c\u7136\u540e\u679a\u4e3e $g=(x,z)$\uff0c\u518d\u5c06 $x$ \u9664\u6389 $g$\u3002\n\n\u7136\u540e\u53ef\u4ee5\u5f97\u5230 $y^{gx}=(gx)^z=d^{xz}$\uff0c\u5373 $d=\\sqrt[x]{gx}$\uff0c\u540c\u65f6\u6709 $y=d^{\\frac{z}{g}}$\u3002\u540c\u65f6\u6211\u4eec\u8981\u6c42 $g|z$ \u4e14 $z/g\\perp x$\u3002\n\n\u7136\u540e\u6539\u5199\u5f0f\u5b50\u3002\n\n$$\\sum_{z=1}^C\\sum_{g|z}\\sum_{x=1}^{\\lfloor\\frac{A}{g}\\rfloor}[\\sqrt[x]{gx}\\in\\mathbb Z][(\\sqrt[x]{gx})^{\\frac{z}{g}}\\leq B][z/g\\perp x]$$\n\n$$\\sum_{g=1}^{\\min\\{A,C\\}}\\sum_{x=1}^{\\lfloor\\frac{A}{g}\\rfloor}\\sum_{z=1}^{\\lfloor\\frac{C}{g}\\rfloor}[\\sqrt[x]{gx}\\in\\mathbb Z][(\\sqrt[x]{gx})^{z}\\leq B][z\\perp x]$$\n\n$$\\sum_{g=1}^{\\min\\{A,C\\}}\\sum_{z=1}^{\\lfloor\\frac{C}{g}\\rfloor}[g\\in\\mathbb Z][g^{z}\\leq B][z\\perp 1]+\\sum_{g=1}^{\\min\\{A,C\\}}\\sum_{x=2}^{\\lfloor\\frac{A}{g}\\rfloor}\\sum_{z=1}^{\\lfloor\\frac{C}{g}\\rfloor}[\\sqrt[x]{gx}\\in\\mathbb Z][(\\sqrt[x]{gx})^{z}\\leq B][z\\perp x]$$\n\n$$\\sum_{g=1}^{\\min\\{A,C\\}}\\sum_{z=1}^{\\lfloor\\frac{C}{g}\\rfloor}[g^{z}\\leq B]+\\sum_{g=1}^{\\min\\{A,C\\}}\\sum_{x=2}^{\\lfloor\\frac{A}{g}\\rfloor}\\sum_{z=1}^{\\lfloor\\frac{C}{g}\\rfloor}[\\sqrt[x]{gx}\\in\\mathbb Z][(\\sqrt[x]{gx})^{z}\\leq B][z\\perp x]$$\n\n$$\\sum_{g=1}^{\\min\\{A,C\\}}\\min\\{\\lfloor\\log_gB\\rfloor,\\lfloor C/g\\rfloor\\}+\\sum_{g=1}^{\\min\\{A,C\\}}\\sum_{x=2}^{\\lfloor\\frac{A}{g}\\rfloor}\\sum_{z=1}^{\\lfloor\\frac{C}{g}\\rfloor}[\\sqrt[x]{gx}\\in\\mathbb Z][(\\sqrt[x]{gx})^{z}\\leq B][z\\perp x]$$\n\n\u5de6\u8fb9\u53ea\u6709 $\\log$ \u6bb5\uff0c\u4e8c\u5206\u51fa\u6bcf\u4e00\u6bb5\u7136\u540e\u76f4\u63a5\u7b97 $O(\\log^2n)$\uff08$n=\\max A,B,C$\uff09\uff0c\u8003\u8651\u5982\u4f55\u8ba1\u7b97\u53f3\u8fb9\u3002\n\n\u6362\u5e8f\u6c42\u548c\uff1a\n\n$$\\sum_{x=2}^{A}\\sum_{z=1}^{C}[z\\perp x]\\sum_{g=1}^{+\\infty}[gx\\leq A][gz\\leq C][\\sqrt[x]{gx}\\in\\mathbb Z][(\\sqrt[x]{gx})^{z}\\leq B]$$\n\n\u8003\u8651\u6c42\u51fa\u4e00\u4e2a\u6700\u5c0f\u7684 $f(x)$ \u4f7f\u5f97 $\\sqrt[x]{xf(x)}$ \u80fd\u5f00\u51fa\u6765\uff0c\u7136\u540e\u6240\u6709\u7684 $g$ \u90fd\u53ef\u4ee5\u88ab\u8868\u793a\u6210 $k^xf(x)$\uff0c\u5176\u4e2d $k$ \u662f\u6b63\u6574\u6570\u3002\u56e0\u4e3a $xf(x)\\geq 2^x$\uff0c\u6240\u4ee5 $f(x)\\leq A$ \u7684 $x$ \u6700\u591a\u662f $\\log $ \u91cf\u7ea7\u7684\u3002\n\n$$\\sum_{x=2}^{A}\\sum_{z=1}^{C}[z\\perp x]\\sum_{k=1}^{+\\infty}[k^xxf(x)\\leq A][k^xzf(x)\\leq C][k^z(\\sqrt[x]{xf(x)})^{z}\\leq B]$$\n\n$$\\sum_{x=2}^{A}[xf(x)\\leq A]\\sum_{z=1}^{C}[(\\sqrt[x]{xf(x)})^{z}\\leq B][z\\perp x]\\sum_{k=1}^{+\\infty}[k^xxf(x)\\leq A][k^xzf(x)\\leq C][k^z(\\sqrt[x]{xf(x)})^{z}\\leq B]$$\n\n\u8fd9\u6837\u524d\u4e24\u4e2a\u6c42\u548c\u90fd\u53ef\u4ee5\u66b4\u529b\uff0c\u7b2c\u4e09\u4e2a\u6c42\u548c\u53ef\u4ee5\u5bf9\u4e0a\u754c\u8fdb\u884c\u4e8c\u5206\u3002\u770b\u8d77\u6765\u662f\u4e00\u4e2a 3log \u505a\u6cd5\uff1f\n\n\u8003\u8651\u5230 $x$ \u5f88\u5c0f\u7684\u65f6\u5019\uff0c$f(x)$ \u5927\u591a\u7b49\u4e8e $x^{x-1}$\uff0c\u6240\u4ee5\u7b2c\u4e00\u4e2a\u6c42\u548c\u53ef\u4ee5\u89c6\u4f5c\u662f $\\dfrac{\\log n}{\\log\\log n}$ \u7684\u3002\n\n\u800c\u6700\u540e\u7684\u4e8c\u5206\u4e0a\u754c\u5728\u6700\u574f\u60c5\u51b5\u4e0b\u4f9d\u6b21\u662f $n,n^{1/2},n^{1/3},\\cdots$\uff0c\u6240\u4ee5\u540e\u9762\u4e24\u4e2a\u6c42\u548c\u53f7\u7684\u590d\u6742\u5ea6\u662f $\\sum_{i=1}^{\\log n}\\log n^{1/i}=\\sum_{i=1}^n\\frac{1}{i}\\log n=\\log n\\log\\log n$ \u7684\u3002\n\n\u6240\u4ee5\u8fd9\u4e00\u90e8\u5206\u7684\u590d\u6742\u5ea6\u662f $\\dfrac{\\log n}{\\log\\log n}\\times\\log n\\log\\log n=\\log^2n$ \u7684\u3002\n\n\u4e8e\u662f\u505a\u5b8c\u4e86\u3002\u603b\u590d\u6742\u5ea6 $O(T\\log^2n)$\u3002\n\n\n## \u4ee3\u7801\n```cpp\n\n#include <bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int N=70,M=59;\nconst ll P=1e9+7,MX=1e18;\nll t,a,b,c,ans,sja[N],sjb[N],sj[N],f[N],cp[N][N];\nll gcd (ll a,ll b) {return (b==0?a:gcd(b,a%b));}\nll qpow (ll a,ll b) {\n\tll res=1;\n\twhile (b) {\n\t\tif (b&1) {\n\t\t\tif (res>MX/a) {return MX+1;}\n\t\t\tres*=a;\n\t\t\tif(b==1)break;\n\t\t}\n\t\tif (a>MX/a) {return MX+1;}\n\t\ta*=a,b>>=1;\n\t}\n\treturn res;\n}\nll gt (ll a,ll b) {\n\tll l=1,r=sj[b];\n\twhile (l<r) {\n\t\tll mid=(l+r+1)>>1;\n\t\tif (qpow(mid,b)<=a) {l=mid;}\n\t\telse {r=mid-1;}\n\t}\n\treturn l;\n}\nll calc (ll x) {\n\tll res=1,cpx=x;\n\tfor (int i=2;i<=x;i++) {\n\t\tif (x%i==0) {\n\t\t\tll cnt=0;\n\t\t\twhile (x%i==0) {cnt++,x/=i;}\n\t\t\tcnt=(cnt+cpx-1)/cpx;\n\t\t\tfor (int j=1;j<=cnt;j++) {res*=i;}\n\t\t}\n\t}\n\treturn res;\n}\nint main () {\n\tfor (int i=1;i<=M;i++) {\n\t\tsj[i]=MX;\n\t\tsj[i]=gt(MX,i),f[i]=calc(i);\n\t\tfor (int j=1;j<=M;j++) {cp[i][j]=(gcd(i,j)==1);}\n\t}\n\tscanf(\"%lld\",&t);\n\tfor (int i=1;i<=t;i++) {\n\t\tscanf(\"%lld%lld%lld\",&a,&b,&c);\n\t\tans=c%P;\n\t\tfor (int i=1;i<=M;i++) {sja[i]=gt(a,i),sjb[i]=gt(b,i);}\n\t\tfor (int i=1;i<=M;i++) {\n\t\t\tfor (int j=1;j<=M;j++) {\n\t\t\t\tif (!cp[i][j]) {continue;}\n\t\t\t\tll l=0,r=min(sja[i],sjb[j])/f[i];\n\t\t\t\twhile (l<r) {\n\t\t\t\t\tll mid=(l+r+1)>>1;\n\t\t\t\t\tif (qpow(mid*f[i],i)/i<=c/j) {l=mid;}\n\t\t\t\t\telse {r=mid-1;}\n\t\t\t\t}\n\t\t\t\tans=(ans+l)%P;\n\t\t\t\tif (f[i]==1&&j/i<=c) {ans=(ans+P-1)%P;}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1651799895,
        "uid": 557737,
        "name": "gyc18",
        "ccfLevel": 0,
        "title": "P8380"
    }
]
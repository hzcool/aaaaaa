[
    {
        "content": "# \u6c34\u9898\u4e3a\u4ec0\u4e48\u6ca1\u4eba\u505a???\n\n\u95ee\u9898\u663e\u7136\u53ef\u4ee5\u8f6c\u5316\u6210\u5e26\u4fee\u5730\u67e5\u8be2\u533a\u95f4\u5185\u524d\u7f00\u5f02\u6216\u548c\u4e3a\u7ed9\u5b9a\u6570\u7684\u6570\u91cf\n\n\u6839\u636e\u9898\u9762\u6765\u770b,\u628a\u6240\u6709\u6309\u94ae\u90fd\u53d6\u53cd\u8ddf\u539f\u6765\u662f\u4e00\u6837\uff0c\u4e5f\u5c31\u662f2^4=16\u79cd\u72b6\u6001\n\n\u533a\u95f4\u4fee\u6539\u4e3a\u67d0\u4e2a\u6570\u7684\u5f71\u54cd\u6700\u591a\u53ea\u67091\u6b21\uff08\u4e24\u4e24\u62b5\u6d88\uff09\n\n\u7ebf\u6bb5\u6811\u4e0a\u6253\u6253\u6807\u8bb0\u5c31\u53ef\u4ee5\u4e86...\n\n\u987a\u4fbf\u732e\u4e0a\u6211\u7684blog:https://www.luogu.org/blog/Root-std-admin/\n\n\u53ea\u7ed9\u4f2a\u4ee3\u7801\u4e86\u55f7:\n```cpp\nvoid build(int &p,int l,int r) {\n\tif (p==0) p=++num,t[p].l=t[p].r=t[p].sum=t[p].y=0,t[p].a=-1;\n\tt[p].c[N[0]]=((r-l)>>1)+(!(l&1)||!(r&1));\n\tt[p].c[N[o[0]]]=((r-l)>>1)+((l&1)||(r&1));\n\tt[p].sum=((((r-l)>>1)+((l&1)||(r&1)))&1)*o[0];\n\tif (l==r) return;\n\tint mid=l+r>>1;\n\tbuild(t[p].l,l,mid);\n\tbuild(t[p].r,mid+1,r);\n}\nvoid pd(int p,int l,int r) {\n\tif (t[p].a!=-1) {\n\t\tif (t[p].l) t[t[p].l].a=t[p].a,t[t[p].l].V=t[p].V,t[t[p].l].Q=t[p].Q,t[t[p].l].y=0;\n\t\tif (t[p].r) t[t[p].r].a=t[p].a,t[t[p].r].V=t[p].V,t[t[p].r].Q=t[p].Q,t[t[p].r].y=0;\n\t\tmemset(t[p].c,0,sizeof(t[p].c));\n\t\tt[p].c[N[t[p].V]]=((r-l)>>1)+(!(l-t[p].Q&1)||!(r-t[p].Q&1));\n\t\tt[p].c[N[t[p].a^t[p].V]]=((r-l)>>1)+((l-t[p].Q&1)||(r-t[p].Q&1));\n\t\tt[p].sum=((((r-l)>>1)+((l-t[p].Q&1)||(r-t[p].Q&1)))&1)*t[p].a^((r-l+1&1)*t[p].V);\n\t\tt[p].a=-1;\n\t}\n}\nvoid up(int p,int l,int r) {\n\tint mid=l+r>>1;\n\tpd(t[p].l,l,mid);\n\tpd(t[p].r,mid+1,r);\n\tt[p].sum=t[t[p].l].sum^t[t[p].r].sum^(((mid-l+1)&1)*t[t[p].l].y)^(((r-mid)&1)*t[t[p].r].y);\n\tfor (int i=0; i<16; i++) t[p].c[i]=t[t[p].l].c[N[s[i]^t[t[p].l].y]]+t[t[p].r].c[N[s[i]^t[t[p].r].y]];\n}\nvoid cg(int p,int l,int r,int po,int v) {\n\tif (po<=l) t[p].y^=v;\n\telse {\n\t\tpd(p,l,r);\n\t\tint mid=l+r>>1;\n\t\tcg(t[p].r,mid+1,r,po,v);\n\t\tif (mid>=po) cg(t[p].l,l,mid,po,v);\n\t\tup(p,l,r);\n\t}\n}\nint ask(int p,int l,int r,int po) {\n\tif (t[p].a!=-1) return (t[p].a*(po-t[p].Q&1))^t[p].V^t[p].y;\n\tif (l==r) return t[p].sum^t[p].y;\n\tint mid=l+r>>1;\n\tif (po<=mid) return ask(t[p].l,l,mid,po)^t[p].y;\n\telse return ask(t[p].r,mid+1,r,po)^t[p].y;\n}\nint que(int p,int l,int r,int L,int R,int v) {\n\tpd(p,l,r);\n\tv^=t[p].y;\n\tif (L==l&&R==r) return t[p].c[N[v]];\n\tint mid=l+r>>1;\n\tif (R<=mid) return que(t[p].l,l,mid,L,R,v);\n\telse if (L>mid) return que(t[p].r,mid+1,r,L,R,v);\n\telse\n\t\treturn que(t[p].l,l,mid,L,mid,v)+que(t[p].r,mid+1,r,mid+1,R,v);\n}\nvoid ca(int p,int l,int r,int L,int R,int v,int V,int Q) {\n\tif (L==l&&R==r) {\n\t\tt[p].a=v;\n\t\tt[p].V=V;\n\t\tt[p].y=0;\n\t\tt[p].Q=Q;\n\t\tt[p].c[N[V]]=((r-l)>>1)+(!(l-Q&1)||!(r-Q&1));\n\t\tt[p].c[N[v^V]]=((r-l)>>1)+((l-Q&1)||(r-Q&1));\n\t\tt[p].sum=(((((r-l)>>1)+((l-Q&1)||(r-Q&1)))&1)*v)^((r-l+1&1)*V);\n\t} else {\n\t\tpd(p,l,r);\n\t\tV^=t[p].y;\n\t\tint mid=l+r>>1;\n\t\tif (R<=mid) ca(t[p].l,l,mid,L,R,v,V,Q);\n\t\telse if (L>mid) ca(t[p].r,mid+1,r,L,R,v,V,Q);\n\t\telse\n\t\t\tca(t[p].l,l,mid,L,mid,v,V,Q),ca(t[p].r,mid+1,r,mid+1,R,v,V,Q);\n\t\tup(p,l,r);\n\t}\n}\nint main() {\n\tios_base::sync_with_stdio(false);\n\tregister int i,j;\n\trx=read();\n\try=read();\n\tn=0;\n\tfor (i=0; i<rx; i++)\n\t\tfor (j=0; j<ry; j++) o[i]^=1<<(i*ry+j),o[j+rx]^=1<<(i*ry+j),q^=read()<<(i*ry+j);\n\tn=read();\n\tm=read();\n\ts[bo=num=0]=0;\n\tfor(; bo<=num;) {\n\t\tfor (i=0; i<rx+ry; i++) {\n\t\t\tfor (j=0; j<=num; j++)\n\t\t\t\tif (s[j]==(s[bo]^o[i])) break;\n\t\t\tif (j>num) s[++num]=s[bo]^o[i];\n\t\t\tto[bo][i]=j;\n\t\t}\n\t\tbo++;\n\t}\n\tfor (i=0; i<64; i++) N[i]=-1;\n\tfor (i=0; i<=num; i++) N[s[i]]=i;\n\tnum=0;\n\tbuild(ro,1,n);\n\twhile (m--) {\n\t\tbo=read();\n\t\tif (bo==0) bo=read(),cg(ro,1,n,bo,o[read()-1]^ask(ro,1,n,bo)^(bo==1?0:ask(ro,1,n,bo-1)));\n\t\telse if (bo==1) if (bo=read(),x=read(),N[q]==-1) puts(\"0\");\n\t\t\telse printf(\"%d\\n\",que(ro,1,n,bo,x,q));\n\t\telse if (rx=read(),ry=read(),x=o[read()-1],cg(ro,1,n,ry+1,ask(ro,1,n,ry)^(((ry-rx+1)&1)*x)),ca(ro,1,n,rx,ry,x,0,rx-1),rx-1) cg(ro,1,n,rx,ask(ro,1,n,rx-1));\n\t}\n\treturn 0;\n}\n```\n\u54e6\u5bf9,MN\u770b\u6570\u636e\u8303\u56f4,\u597d\u50cf\u662f1e6\u5427...\n\n\u771f\u5fc3\u611f\u8c22\u5927\u5bb6\u89c2\u770b,\u8c22\u8c22!!!",
        "postTime": 1567778724,
        "uid": 182231,
        "name": "\u9f99\u884c\u9f98\u9f98",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5232 \u3010[JSOI2012]\u667a\u8005\u7684\u8003\u9a8c\u3011"
    }
]
[
    {
        "content": "\u770b\u5230\u65b0\u6a21\u677f\uff0c\u8fc7\u6765\u505a\u4e00\u4e0b\u3002\n\n### \u524d\u7f6e\u77e5\u8bc6\uff1a\u591a\u9879\u5f0f\u6c42\u9006 + $NTT$\n\n\u8bbe $H^2(x)\\equiv F(x)(mod\\ x^{\\lceil\\frac n2 \\rceil})$\n\n$G(x)\\equiv H(x)(mod\\ x^{\\lceil\\frac n2 \\rceil})$\n\n$G(x)-H(x)\\equiv 0(mod\\ x^{\\lceil\\frac n2 \\rceil})$\n\n$(G(x)-H(x))^2\\equiv 0(mod\\ x^{\\lceil\\frac n2 \\rceil})$\n\n$G^2(x)-2H(x)*G(x)+H^2(x)\\equiv 0(mod\\ x^n)$\n\n$F(x)-2H(x)*G(x)+H^2(x)\\equiv 0(mod\\ x^n)$\n\n$G(x)=\\Large \\frac {F(x)+H^2(x)}{2H(x)}$\n\n\u5bf9\u4e0a\u8ff0\u5f0f\u5b50\u8fdb\u884c\u591a\u9879\u5f0f\u6c42\u9006 + $NTT$ \u5373\u53ef\n\n$Code\\ Below:$\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int maxn=400000+10;\nconst int mod=998244353;\nconst int inv2=499122177;\nint n,f[maxn],g[maxn],A[maxn],B[maxn],C[maxn],D[maxn],r[maxn];\n\ninline int read(){\n\tregister int x=0,f=1;char ch=getchar();\n\twhile(!isdigit(ch)){if(ch=='-')f=-1;ch=getchar();}\n\twhile(isdigit(ch)){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\n\treturn (f==1)?x:-x;\n}\n\nint fpow(int a,int b){\n\tint ret=1;\n\tfor(;b;b>>=1,a=1ll*a*a%mod)\n\t\tif(b&1) ret=1ll*ret*a%mod;\n\treturn ret;\n}\n\nvoid NTT(int *f,int n,int op){\n\tfor(int i=0;i<n;i++)\n\t\tif(i<r[i]) swap(f[i],f[r[i]]);\n\tint buf,tmp,x,y;\n\tfor(int len=1;len<n;len<<=1){\n\t\ttmp=fpow(3,(mod-1)/(len<<1));\n\t\tif(op==-1) tmp=fpow(tmp,mod-2);\n\t\tfor(int i=0;i<n;i+=len<<1){\n\t\t\tbuf=1;\n\t\t\tfor(int j=0;j<len;j++){\n\t\t\t\tx=f[i+j];y=1ll*buf*f[i+j+len]%mod;\n\t\t\t\tf[i+j]=(x+y)%mod;f[i+j+len]=(x-y+mod)%mod;\n\t\t\t\tbuf=1ll*buf*tmp%mod;\n\t\t\t}\n\t\t}\n\t}\n\tif(op==1) return ;\n\tint inv=fpow(n,mod-2);\n\tfor(int i=0;i<n;i++) f[i]=1ll*f[i]*inv%mod;\n}\n\nvoid Inv(int *a,int *b,int n){\n\tb[0]=fpow(a[0],mod-2);\n\tint len,lim;\n\tfor(len=1;len<(n<<1);len<<=1){\n\t\tlim=len<<1;\n\t\tfor(int i=0;i<len;i++) A[i]=a[i],B[i]=b[i];\n\t\tfor(int i=0;i<lim;i++) r[i]=(r[i>>1]>>1)|((i&1)?len:0);\n\t\tNTT(A,lim,1);NTT(B,lim,1);\n\t\tfor(int i=0;i<lim;i++) b[i]=((2ll-1ll*A[i]*B[i]%mod)*B[i]%mod+mod)%mod;\n\t\tNTT(b,lim,-1);\n\t\tfor(int i=len;i<lim;i++) b[i]=0;\n\t}\n\tfor(int i=0;i<len;i++) A[i]=B[i]=0;\n\tfor(int i=n;i<len;i++) b[i]=0;\n}\n\nvoid Sqrt(int *a,int *b,int n){\n\tb[0]=1;\n\tint *A=C,*B=D,len,lim;\n\tfor(len=1;len<(n<<1);len<<=1){\n\t\tlim=len<<1;\n\t\tfor(int i=0;i<len;i++) A[i]=a[i];\n\t\tInv(b,B,lim>>1);\n\t\tfor(int i=0;i<lim;i++) r[i]=(r[i>>1]>>1)|((i&1)?len:0);\n\t\tNTT(A,lim,1);NTT(B,lim,1);\n\t\tfor(int i=0;i<lim;i++) A[i]=1ll*A[i]*B[i]%mod;\n\t\tNTT(A,lim,-1);\n\t\tfor(int i=0;i<len;i++) b[i]=1ll*(b[i]+A[i])%mod*inv2%mod;\n\t\tfor(int i=len;i<lim;i++) b[i]=0;\n\t}\n\tfor(int i=0;i<len;i++) A[i]=B[i]=0;\n\tfor(int i=n;i<len;i++) b[i]=0;\n}\n\nint main()\n{\n\tn=read();\n\tfor(int i=0;i<n;i++) f[i]=read();\n\tSqrt(f,g,n);\n\tfor(int i=0;i<n;i++) printf(\"%d \",g[i]);\n\tprintf(\"\\n\");\n\treturn 0;\n}\n```",
        "postTime": 1548744856,
        "uid": 35069,
        "name": "Owen_codeisking",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5205 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5f00\u6839\u3011"
    },
    {
        "content": "# \u524d\u7f6e\u77e5\u8bc6\n\n[NTT](https://oi.men.ci/fft-to-ntt/)(\u4f46\u662f\u5982\u679c\u4f60\u4e0b\u51b3\u5fc3\u8981\u5199\u8fd9\u9053\u9898\u7684\u8bddNTT\u662f\u4e0d\u53ef\u80fd\u4e0d\u4f1a\u7684\u3002\u3002)\n\n# \u5c0f\u5fc3\u63a8\u5bfc\n\n\u9996\u5148\u6211\u4eec\u9700\u8981\u6784\u9020\u4e00\u4e2a\u51fd\u6570$G(f)=f^2-F(x)$\uff0c\u90a3\u4e48\u4ee4$G(f) \\equiv 0\\ (\\bmod\\ x^n)$\u6210\u7acb\u7684\u89e3$f$\u4e5f\u6ee1\u8db3\uff1a$f \\equiv \\sqrt{F(x)}\\ (\\bmod\\ x^n)$\n\n\u7136\u540e\u8003\u8651\u600e\u4e48\u6c42\u8fd9\u4e2a$f$\u3002\n\n\u8fd9\u91cc\u5c31\u9700\u8981\u4f7f\u7528\u591a\u9879\u5f0f\u590d\u5408\u4e86\u3002\u3002\n\n## \u591a\u9879\u5f0f\u590d\u5408\n\n> \u9996\u5148\u6211\u4eec\u9700\u8981\u77e5\u9053\u6cf0\u52d2\u5c55\u5f00\u3002\n>\n> > \u5df2\u77e5\u591a\u9879\u5f0f$F(x)$\uff0c\u4ee5\u53ca\u5176\u5728$x_0$\u7684\u503c\uff0c\u5219\u8be5\u591a\u9879\u5f0f\u5728$x$\u7684\u53d6\u503c\u53ef\u8868\u793a\u4e3a\uff1a\n> >\n> > $$F(x) = G(x_0) + \\sum_{i=1}^{\\infty}\\frac{G^{(i)}(x_0)}{i!}(x-x_0)^i$$\n> >\n> > \u5176\u4e2d$G^{(i)}(x_0)$\u8868\u793a\u5bf9$G(x_0)$\u6c42$i$\u9636\u5bfc\u6570\n> \n> \u90a3\u4e48\u8fd9\u91cc\u6709\u4ec0\u4e48\u7528\u5462\u3002\u3002\n> \n> \u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86\u4e00\u4e2a\u591a\u9879\u5f0f$f_{t-1}$\u4f7f\u5f97$G(f_{t-1}) \\equiv 0\\ (mod\\ x^{2^{t-1}})$\uff0c\u7136\u540e\u73b0\u5728\u7684\u95ee\u9898\u662f\u6c42\u4e00\u4e2a\u591a\u9879\u5f0f$f_t$\u4f7f\u5f97$G(f_t) \\equiv 0\\ (mod\\ x^{2^t})$\n\n> \u8fd9\u6837\u7684\u8bdd\u3002\u3002\u6211\u4eec\u5c1d\u8bd5\u5bf9$G(f_t)$\u505a\u4e2a\u6cf0\u52d2\u5c55\u5f00\uff1a\n\n> $$G(f_t) \\equiv G(f_{t-1}) + \\sum_{i=1}^{\\infty}\\frac{G^{(i)}(f_{t-1})}{i!} \\ast (f_t-f_{t-1})^i\\ (mod\\ x^{2^t})$$\n\n> \u7136\u540e\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50\u597d\u50cf\u5e76\u4e0d\u662f\u5f88\u53ef\u505a\u7684\u6837\u5b50\u554a\u3002\u3002\n\n> \u90a3\u4e48\u51b7\u9759\u5206\u6790\u4e00\u4e0b\uff0c\u53d1\u73b0\u7531\u4e8e\u6709\uff1a\n\n> $$G(f_{t}) \\equiv 0\\ (mod\\ x^{2^{t}})$$\n\n> \u5219\u8bf4\u660e$G(f_t)$\u9664\u5e38\u6570\u9879\u5916\u7cfb\u6570\u4e0d\u4e3a$0$\u7684\u9879\u6b21\u6570\u5927\u4e8e$t$\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u6709\uff1a\n\n> $$G(f_{t}) \\equiv 0\\ (mod\\ x^{2^{t-1}})$$\n\n> \u53c8\u56e0\u4e3a\uff1a\n\n> $$G(f_{t-1}) \\equiv 0\\ (mod\\ x^{2^{t-1}})$$\n\n> \u5219\u53ef\u4ee5\u5f97\u77e5\uff1a\n\n> $f_t-f_{t-1}$\u7684\u524d$2^{t-1}$\u9879\u5747\u4e3a$0$\uff0c\u81ea\u7136\u800c\u7136\u7684\uff0c$(f_t-f_{t-1})^2$\u7684\u524d$2^t$\u9879\u5747\u4e3a$0$...\u7136\u540e\u8303\u56f4\u4e0d\u65ad\u6269\u5927\u3002\n\n> \u7136\u540e\u56de\u5230\u4e0a\u9762\u7684\u5f0f\u5b50\uff0c\u53d1\u73b0\u662f\u5728\u6a21$x^{2^t}$\u7684\u610f\u4e49\u4e0b\u3002\u90a3\u4e48\u663e\u7136\u7684\u662f\uff0c\u5305\u542b\u4e86$(f_t-f_{t-1})^x\\ (x > 1)$\u7684\u9879\u90fd\u4e3a$0$\u4e86\u3002\n\n> \u7136\u540e\u6211\u4eec\u518d\u628a\u4e0a\u9762\u7684\u5f0f\u5b50\u5316\u7b80\u4e00\u4e0b\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\uff1a\n\n> $$G(f_t) \\equiv G(f_{t-1}) + G'(f_{t-1}) \\ast (f_t-f_{t-1})\\ (mod\\ x^{2^t})$$\n\n> \u7b80\u5355\u591a\u4e86\u3002\u3002\n\n> \u7136\u540e\u7531\u6211\u4eec\u8981\u6c42\u7684\u5f0f\u5b50\uff1a\n\n> $$G(f_t) \\equiv 0\\ (mod\\ x^{2^t})$$\n\n> \u6240\u4ee5\u6709\uff1a\n\n> $$G(f_{t-1}) + G'(f_{t-1}) \\ast (f_t-f_{t-1})\\ \\equiv 0\\ (mod\\ x^{2^t})$$\n\n> \u6211\u4eec\u518d\u53d8\u5f62\u4e00\u4e0b\uff1a\n\n> $$f_t=f_{t-1}-\\frac{G(f_{t-1})}{G'(f_{t-1})}$$\n\n> \u8fd9\u6837\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a\u500d\u589e\u7684\u505a\u6cd5\u4e86\u3002\n\n> \u590d\u6742\u5ea6$O(nlogn)$\n\n\u4ee5\u4e0a\u5185\u5bb9\u6458\u81ea[\u6d45\u8c08\u591a\u9879\u5f0f](https://cyjian.blog.luogu.org/duoxiangshi)\n\n\u597d\u7684\u3002\u3002\u73b0\u5728\u6211\u4eec\u5c06\u5f53\u524d\u8fd9\u4e2a$G(f)$\u5e26\u5165\u5c31\u53ef\u4ee5\u5f97\u5230\u8fd9\u6837\u7684\u4e00\u4e2a\u5f0f\u5b50\uff1a\n\n$$f_t=f_{t-1}-\\frac{f_{t-1}^2-F(x)}{2f_{t-1}}=\\frac{f_{t-1}}{2}+\\frac{F(x)}{2f_{t-1}}$$\n\n\u7136\u540e\u53ea\u9700\u8981\u4e00\u4e2a\u591a\u9879\u5f0f\u6c42\u9006\u5c31\u597d\u4e86\u3002(\u5982\u679c\u4e0d\u4f1a\u591a\u9879\u5f0f\u6c42\u9006\u7684\u8bdd\u53ef\u4ee5\u770b\u4e0a\u9762\u7684\u6d45\u8c08\u591a\u9879\u5f0f\u3002)\n\n\u4ee3\u7801\uff1a\n\n```\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define reg register\n#define ge getchar()\n#define Re read()\n#define FI \"Sqrt.in\"\n#define FO \"Sqrt.out\"\n#define G 3\n#define MAXN 262145\n#define mod 998244353\n#define Inv 499122177\n\ninline int read() {\n\treg int x = 0, ch;\n\twhile(!isdigit(ch = ge)) ;\n\twhile(isdigit(ch)) x = (x << 1) + (x << 3) + (ch ^ 48), ch = ge;\n\treturn x;\n}\n\ninline void init(reg int);\ninline int ksm(reg int, reg int);\ninline void NTT(reg int[], reg int);\ninline void Mul(reg int[], reg int[], reg int[], reg int, reg int);\ninline void GetNi(reg int[], reg int[], reg int);\ninline void Sqrt(reg int[], reg int[], reg int);\n\nint N;\nint p[MAXN + 1];\nint A[MAXN + 1];\nint B[MAXN + 1];\nint tA[MAXN + 1];\nint tB[MAXN + 1];\nint tC[MAXN + 1];\nint tp[MAXN + 1];\nint tq[MAXN + 1];\n\nint main() {\n#ifndef ONLINE_JUDGE\n\tfreopen(FI, \"r\", stdin);\n\tfreopen(FO, \"w\", stdout);\n#endif\n\treg int n = Re;\n\tfor(reg int i = 0; i < n; i++) A[i] = Re;\n\tSqrt(A, B, n);\n\tfor(reg int i = 0; i < n; i++) printf(\"%d%c\", B[i], \" \\n\"[i == n - 1]);\n\treturn 0;\n}\n\ninline void init(reg int n) {\n\tN = 1; while(N <= (n << 1)) N <<= 1;\n\tfor(reg int i = 0; i < N; i++) p[i] = (p[i >> 1] >> 1) | (i & 1 ? N >> 1 : 0);\n}\n\ninline int ksm(reg int a, reg int k) {\n\treg int s = 1;\n\twhile(k) {\n\t\tif(k & 1) s = 1LL * s * a % mod;\n\t\ta = 1LL * a * a % mod;\n\t\tk >>= 1;\n\t}\n\treturn s;\n}\n\ninline void NTT(reg int a[], reg int k) {\n\tfor(reg int i = 0; i < N; i++)\n\t\tif(i < p[i]) swap(a[i], a[p[i]]);\n\tfor(reg int l = 2; l <= N; l <<= 1) {\n\t\treg int len = l >> 1;\n\t\treg int delta = ksm(G, (mod - 1) / l);\n\t\tfor(reg int i = 0; i < N; i += l) {\n\t\t\treg int g = 1;\n\t\t\tfor(reg int j = i; j < i + len; j++) {\n\t\t\t\treg int tmp = 1LL * a[j + len] * g % mod;\n\t\t\t\ta[j + len] = (a[j] - tmp + mod) % mod;\n\t\t\t\ta[j] = (a[j] + tmp) % mod;\n\t\t\t\tg = 1LL * g * delta % mod;\n\t\t\t}\n\t\t}\n\t}\n\tif(k) return ;\n\treg int prd = ksm(N, mod - 2); reverse(a + 1, a + N);\n\tfor(reg int i = 0; i < N; i++) a[i] = 1LL * a[i] * prd % mod;\n}\n\ninline void Mul(reg int A[], reg int B[], reg int C[], reg int n, reg int m) {\n\tinit(max(n, m));\n\tmemcpy(tp, A, 4 * n), fill(tp + n, tp + N, 0); NTT(tp, 1);\n\tmemcpy(tq, B, 4 * m), fill(tq + m, tq + N, 0); NTT(tq, 1);\n\tfor(reg int i = 0; i < N; i++) C[i] = 1LL * tp[i] * tq[i] % mod; NTT(C, 0);\n}\n\ninline void GetNi(reg int A[], reg int B[], reg int n) {\n\tif(n == 1) { B[0] = ksm(A[0], mod - 2); return ; }\n\tGetNi(A, B, (n + 1) >> 1); init(n);\n\tmemcpy(tA, A, n * 4); fill(tA + n, tA + N, 0);\n\tNTT(tA, 1), NTT(B, 1);\n\tfor(reg int i = 0; i < N; i++) B[i] = 1LL * (2LL - 1LL * tA[i] * B[i] % mod + mod) * B[i] % mod;\n\tNTT(B, 0); fill(B + n, B + N, 0);\n}\n\ninline void Sqrt(reg int A[], reg int B[], reg int n) {\n\tif(n == 1) { B[0] = 1; return ; }\n\tSqrt(A, B, (n + 1) >> 1); memset(tB, 0, n * 4); GetNi(B, tB, n); Mul(A, tB, tB, n, n);\n\tfor(reg int i = 0; i < n; i++) B[i] = 1LL * (B[i] + tB[i]) * Inv% mod;\n}\n```",
        "postTime": 1548675085,
        "uid": 20782,
        "name": "CYJian",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5205 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5f00\u6839\u3011"
    },
    {
        "content": "\u9700\u8981\u7528\u5230\u7684\u5404\u79cd\u524d\u7f6e\u77e5\u8bc6\u548c\u63a8\u5bfc\u8fc7\u7a0b\u5404\u4f4d\u5927\u795e\u90fd\u5df2\u7ecf\u5199\u597d\u4e86\u3002\u4e0d\u8fc7\u6211\u6ca1\u6709\u770b\u5230\u9012\u5f52\u7248\u7684\u5199\u6cd5\uff0c\u6765\u53d1\u4e00\u7bc7\u9012\u5f52\u7684\u3002  \n\n\u5177\u4f53\u64cd\u4f5c\u5c31\u662f\u5148\u9012\u5f52\u5f00\u6839\uff0c\u8fd4\u56de\u7684\u65f6\u5019\u8fdb\u884c\u6c42\u9006\u3002\n\n\u7136\u540e\u4e00\u5b9a\u8981\u6ce8\u610f\u8fb9\u754c\u95ee\u9898\u3002\u8fd9\u4e2a\u6a21\u677f\u6211\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\uff0c\u5982\u679c\u76f4\u63a5\u628a\u9006\u5143\u81ea\u4e58\u8d77\u6765\uff0c\u6211\u597d\u50cf\u56e0\u4e3a\u4e00\u4e9b\u539f\u56e0\u4e00\u76f4\u662f\u9519\u7684\u2026\u2026\uff08~~\u73b0\u5728\u56de\u60f3\u8d77\u6765\u597d\u50cf\u662f\u6570\u7ec4\u7528\u91cd\u4e86~~\uff09\u4e8e\u662f\u6211\u5148\u7ea6\u4e86\u4e00\u4e0b\u5206\uff0c\u4e4b\u540e\u624d\u80fd\u8fc7\u3002\n\n\u6ce8\u610f\u6bcf\u6b21\u6c42\u9006\u5143\u4e4b\u524d\u4e00\u5b9a\u8981\u6e05\u96f6\u3002\u5426\u5219\u5bf9\u4e8e\u6211\u8fd9\u79cd\u5199\u6cd5\u4f1a\u628a\u4f60\u4e0a\u4e00\u6b21\u6c42\u7684\u9006\u5143\u5e26\u7740\u7b97\u2026\u2026\u4f1a\u9519\u7684\u4e71\u4e03\u516b\u7cdf\u3002\n\nupdate:\u9006\u5143\u81ea\u4e58\u5199\u6cd5\u53ef\u8fc7\u2026\u2026\u539f\u56e0\u662f\u6211\u5728\u52a0\u7684\u65f6\u5019\u52a0\u591a\u4e86\u2026\u2026\u6ce8\u610f\u5728\u505a\u52a0\u6cd5\u7684\u65f6\u5019\u52a0\u5230len-1\u5373\u53ef\uff0c\u52a0\u591a\u4e86\u4f1a\u9519\u8bef\u3002\u4ee3\u7801\u8d34\u5728\u6ce8\u91ca\u90a3\u90e8\u5206\u3002\n\n\u4ee3\u7801\u6709\u538b\u884c\u2026\u2026\n\n```cpp\n#include<bits/stdc++.h>\n#define rep(i,a,n) for(int i = a;i <= n;i++)\n#define per(i,n,a) for(int i = n;i >= a;i--)\n#define enter putchar('\\n')\n#define I inline\n\nusing namespace std;\ntypedef long long ll;\nconst int M = 800005;\nconst int mod = 998244353;\nconst int G = 3;\nconst int invG = 332748118;\n\nint read()\n{\n   int ans = 0,op = 1;char ch = getchar();\n   while(ch < '0' || ch > '9') {if(ch == '-') op = -1;ch = getchar();}\n   while(ch >= '0' && ch <= '9') ans = ans * 10 + ch - '0',ch = getchar();\n   return ans * op;\n}\n\nint rev[M],A[M],B[M],C[M],D[M],F[M],n,inv2;\n\nint inc(int a,int b){return (a+b) % mod;}\nint mul(int a,int b){return 1ll * a * b % mod;}\n\nint qpow(int a,int b)\n{\n   int p = 1;\n   while(b)\n   {\n      if(b & 1) p = mul(p,a);\n      a = mul(a,a),b >>= 1;\n   }\n   return p;\n}\n\nvoid getrev(int l,int L) {rep(i,0,l-1) rev[i] = (rev[i>>1] >> 1) | ((i&1) << (L-1));}\n\nvoid NTT(int *a,int n,int f)\n{\n   rep(i,0,n-1) if(i < rev[i]) swap(a[i],a[rev[i]]);\n   for(int i = 1;i < n;i <<= 1)\n   {\n      int w1 = qpow(f ? G : invG,(mod-1) / (i<<1));\n      for(int j = 0;j < n;j += (i<<1))\n      {\n\t int w = 1;\n\t rep(k,0,i-1)\n\t {\n\t    int kx = a[k+j],ky = mul(a[k+j+i],w);\n\t    a[k+j] = inc(kx,ky),a[k+j+i] = inc(kx,mod-ky),w = mul(w,w1);\n\t }\n      }\n   }\n   if(!f)\n   {\n      int inv = qpow(n,mod-2);\n      rep(i,0,n-1) a[i] = mul(a[i],inv);\n   }\n}\n\nvoid getinv(int *a,int *b,int len)\n{\n   if(len == 1) {b[0] = qpow(a[0],mod-2);return;}\n   getinv(a,b,(len+1) >> 1);\n   int l = 1,L = 0;\n   while(l < (len<<1)) l <<= 1,L++;\n   getrev(l,L);\n   rep(i,0,len-1) C[i] = a[i];\n   rep(i,len,l-1) C[i] = 0;\n   NTT(C,l,1),NTT(b,l,1);\n   rep(i,0,l-1) b[i] = mul(inc(2,mod-mul(C[i],b[i])),b[i]);\n   NTT(b,l,0);\n   rep(i,len,l-1) b[i] = 0;\n}\n\nvoid getsqrt(int *a,int *b,int len)\n{\n   if(len == 1) {b[0] = 1;return;}\n   getsqrt(a,b,(len+1)>>1);\n   rep(i,0,len<<1) F[i] = 0;\n   getinv(b,F,len);\n   int l = 1,L = 0;\n   while(l < len << 1) l <<= 1,L++;\n   getrev(l,L);\n   rep(i,0,len-1) D[i] = a[i];\n   rep(i,len,l-1) D[i] = 0;\n   NTT(D,l,1),NTT(b,l,1),NTT(F,l,1);\n   rep(i,0,l-1) b[i] = mul(inc(b[i],mul(D[i],F[i])),inv2);\n   NTT(b,l,0);\n   rep(i,len,l-1) b[i] = 0;\n}\n/*\nvoid getsqrt(int *a,int *b,int len)\n{\n   if(len == 1) {b[0] = 1;return;}\n   getsqrt(a,b,(len+1)>>1);\n   rep(i,0,len<<1) F[i] = 0;\n   getinv(b,F,len);\n   int l = 1,L = 0;\n   while(l < len<<1) l <<= 1,L++;\n   getrev(l,L);\n   NTT(b,l,1);\n   rep(i,0,l-1) b[i] = mul(b[i],b[i]);\n   NTT(b,l,0);\n   rep(i,0,len-1) b[i] = inc(b[i],a[i]);\n   NTT(b,l,1),NTT(F,l,1);\n   rep(i,0,l-1) b[i] = mul(mul(b[i],F[i]),inv2);\n   NTT(b,l,0);\n   rep(i,len,l-1) b[i] = 0;\n}\n*/\nint main()\n{\n   n = read(),inv2 = qpow(2,mod-2);\n   rep(i,0,n-1) A[i] = read();\n   getsqrt(A,B,n);\n   rep(i,0,n-1) printf(\"%d \",B[i]);enter;\n   return 0;\n}\n\n```",
        "postTime": 1549165263,
        "uid": 67695,
        "name": "Captain1",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5205 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5f00\u6839\u3011"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://blog.csdn.net/ezoixx118/article/details/86763688)  \n\u5373\u7ed9\u591a\u9879\u5f0f$A(x)$\uff0c\u6c42$B(x)$\u4f7f$B^2(x)\\equiv A(x) \\pmod{x^n}$  \n\u8003\u8651\u500d\u589e\uff0c\u82e5\u6c42\u5f97$B'^2(x)\\equiv A(x)\\pmod{x^{\\lceil \\frac{n}{2} \\rceil}}$\uff0c  \n\u5e76\u5df2\u77e5$B^2(x)\\equiv A(x)\\pmod{x^{\\lceil \\frac{n}{2} \\rceil}}$\n$$\\therefore B^2(x)-B'^2(x)\\equiv 0\\pmod{x^{\\lceil \\frac{n}{2} \\rceil}}$$\n$$\\therefore B^4(x)+B'^4(x)-2B^2(x)B'^2(x)\\equiv 0\\pmod{x^n}$$\n$$\\therefore B^4(x)+B'^4(x)+2B^2(x)B'^2(x)\\equiv 4B^2(x)B'^2(x)\\pmod{x^n}$$\n$$\\therefore B^2(x)+B'^2(x)\\equiv 2B(x)B'(x)\\pmod{x^n}$$\n$$\\therefore A(x)+B'^2(x)\\equiv 2B(x)B'(x)\\pmod{x^n}$$\n$$\\therefore B(x)\\equiv \\frac{A(x)+B'^2(x)}{2B'(x)}\\pmod{x^n}$$\n\u518d\u7528\u591a\u9879\u5f0f\u6c42\u9006\u5373\u53ef\u3002  \n\u8fb9\u754c\uff1a$B_0=\\sqrt{A_0}=1$(\u4e8c\u6b21\u5269\u4f59)  \n\u4ee3\u7801\uff1a  \n```cpp\n//#pragma GCC optimize(3)\n#include<iostream>\n#include<iomanip>\n#include<stack>\n#include<queue>\n#include<list>\n#include<vector>\n#include<set>\n#include<string>\n#include<algorithm>\n#include<complex>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#define ull unsigned long long\n#define ll long long\n#define db long double\n#define inf 400002\n#define infm 1000009\n#define INF (int)1e9\n//#define mod 100000007LL\n#define pi acos(-1)\n#define rd(n) {n=0;char ch;int f=0;do{ch=getchar();if(ch=='-'){f=1;}}while(ch<'0'||ch>'9');while('0'<=ch&&ch<='9'){n=(n<<1)+(n<<3)+ch-48;ch=getchar();}if(f)n=-n;}\nusing namespace std;\n\nconst ll mod=998244353,G=3;\nll invG;\n\nll Qpow(ll x,ll k){\n    ll ans=1LL;\n    while (k){\n        if (k&1){\n            ans=ans*x%mod;\n        }\n        x=x*x%mod;\n        k/=2;\n    }\n    return ans;\n}\n\nll getinv(ll x){\n    return Qpow(x,mod-2);\n}\n\nint N,bit;\nint rev[inf];\n\nvoid FFT(ll a[],int f){\n    for (int i=0;i<N;i++){\n        if (rev[i]>i){\n            swap(a[i],a[rev[i]]);\n        }\n    }\n    for (int i=1;i<N;i*=2){\n        ll wn=Qpow(f==1?G:invG,(mod-1)/i/2);\n        for (int j=0;j<N;j+=i*2){\n            ll w=1;\n            for (int k=0;k<i;k++){\n                ll x=a[j+k],y=a[i+j+k]*w%mod;\n                a[j+k]=(x+y)%mod;\n                a[i+j+k]=(x-y+mod)%mod;\n                w=w*wn%mod;\n            }\n        }\n    }\n    if (f==-1){\n        ll invn=getinv(N);\n        for (int i=0;i<N;i++){\n            a[i]=a[i]*invn%mod;\n        }\n    }\n    return;\n}\n\nvoid Poly_mul(ll A[],ll B[],int n){\n    N=1,bit=0;\n    while (N<=n){\n        N*=2;\n        bit++;\n    }\n    for (int i=0;i<N;i++){\n        rev[i]=(rev[i/2]/2)|((i&1)<<(bit-1));\n    }\n    FFT(A,1);\n    FFT(B,1);\n    for (int i=0;i<=N;i++){\n        A[i]=A[i]*B[i]%mod;\n    }\n    FFT(A,-1);\n    for (int i=n;i<=N;i++){\n    \tA[i]=0;\n    }\n    return;\n}\n\nvoid Poly_cal(ll A[],ll B[],int n){\n    N=1,bit=0;\n    while (N<n*2){\n        N*=2;\n        bit++;\n    }\n    for (int i=0;i<N;i++){\n        rev[i]=(rev[i/2]/2)|((i&1)<<(bit-1));\n    }\n    FFT(A,1);\n    FFT(B,1);\n    for (int i=0;i<=N;i++){\n        B[i]=B[i]*(2-A[i]*B[i]%mod+mod)%mod;\n    }\n    FFT(B,-1);\n    for (int i=n;i<=N;i++){\n    \tB[i]=0;\n    }\n    return;\n}\n\nll tmp[inf];\n\nvoid Poly_inv(ll A[],ll ans[],int n){\n    if (n==1){\n        ans[0]=getinv(A[0]);\n        return;\n    }\n    Poly_inv(A,ans,(n+1)/2);\n    memset(tmp,0,sizeof(tmp));\n    for (int i=0;i<n;i++){\n        tmp[i]=A[i];\n    }\n    Poly_cal(tmp,ans,n);\n    return;\n}\n\nll C[inf],B[inf],D[inf];\n\nvoid Poly_sqrt(ll A[],ll ans[],int n){\n    if (n==1){\n        ans[0]=1;\n        return;\n    }\n    memset(B,0,sizeof(B));\n    memset(C,0,sizeof(C));\n    memset(D,0,sizeof(D));\n    Poly_sqrt(A,ans,(n+1)/2);\n    for (int i=0;i<n;i++){\n        C[i]=ans[i]*2%mod;\n        D[i]=ans[i];\n        B[i]=0;\n    }\n    Poly_inv(C,B,n);\n    Poly_mul(ans,D,n);\n    for (int i=0;i<n;i++){\n        ans[i]=(ans[i]+A[i])%mod;\n    }\n    Poly_mul(ans,B,n);\n    return;\n}\n\nint n;\nll A[inf],ans[inf];\n\nint main(){\n    invG=getinv(G);\n    rd(n)\n    for (int i=0;i<n;i++){\n        rd(A[i])\n    }\n    int cnt=1;\n    while (cnt<=n){\n        cnt*=2;\n    }\n    Poly_sqrt(A,ans,cnt);\n    for (int i=0;i<n;i++){\n        printf(\"%lld \",ans[i]);\n    }\n    puts(\"\");\n    return 0;\n}\n```",
        "postTime": 1549276403,
        "uid": 30541,
        "name": "ezoixx118",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5205 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5f00\u6839\u3011"
    },
    {
        "content": "[\u6233\u8fd9\u9605\u8bfb\u6548\u679c\u66f4\u4f73\u54df](https://blog.csdn.net/qq_42886072/article/details/104684552)\n# \u524d\u8a00\n\u81ea\u5df1\u505a\u51fa\u4e00\u9053\u591a\u9879\u5f0f\u9898\uff0c\u867d\u8c03\u8bd5\u8270\u8f9b\uff0c\u4f46\u662fAC\u540e\u81ea\u8c6a\u611f\u7206\u68da\u3002\n\n# \u601d\u8def\uff1a\n[\u9898\u76ee](https://www.luogu.com.cn/problem/P5205)\n\n> $B^2(x)=A(x)(mod~~ x^n),$\u5df2\u77e5$A(x)$,\u6c42$B(x)$\n\n\u9996\u5148\uff0c\u7ed9\u51fa\u4e00\u4e2a\u725b\u987f\u8fed\u4ee3\u516c\u5f0f$x=x_0-\\dfrac{f(x_0)}{f'(x)}$($x$\u4e3a\u51fd\u6570\u96f6\u70b9\uff0c$x_0$\u4e3a\u5df2\u77e5\u70b9)\n\n\u8bbe$f(B(x))=B^2(x)-A(x),$\n\n\u5219$f'(B(x))=2*B(x)$\n\n\u7531\u4e8e\u4e0a\u9762\u7684\u5b9a\u4e49\uff0c\u6240\u4ee5\u6211\u4eec\u73b0\u5728\u6c42\u7684\u5c31\u662f$f(x)$\u7684\u96f6\u70b9\u3002\n\n\u8bbe\u5df2\u77e5$f(B^*(x))=(B^*)^2(x)-A(x)$,$(B^*)$\u4e3a$mod~x^{n/2}$\u65f6\u7684\u591a\u9879\u5f0f\u89e3\n\u90a3\u4e48\u6839\u636e\u4e0a\u9762\u7ed9\u51fa\u7684\u725b\u8fed\u516c\u5f0f\u53ef\u5f97:$B(x)=(B^*)(x)-\\dfrac{(B^*)^2(x)-A(x)}{2*(B^*)(x)}=\\dfrac{(B^*)(x)}{2}+\\dfrac{A(x)}{2(B^*)(x)}$\n\n\u7efc\u4e0a\uff1a$NTT$\u6c42\u9006\u5143$*\\log(n)$ \u6b21\u8fed\u4ee3$B(x)$\u5373\u53ef\uff0c\u590d\u6742\u5ea6:$O(n*\\log n)$\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio\n#include<cctype>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\ntypedef long long ll;\nconst int N=1<<18|10,mod=998244353;\nconst int g=3,G=332748118,inv2=499122177;//\u539f\u68393,3\u30012\u7684\u9006\u5143 \ntemplate<class o>void qr(o&x) {\n\tchar c=getchar();int f=1;x=0;\n\twhile(!isdigit(c)){if(c=='-')f=-1;c=getchar();}\n\twhile(isdigit(c))x=x*10+c-'0',c=getchar();\n\tx*=f;\n}\ntemplate<class o>void qw(o x) {\n\tif(x/10)qw(x/10);\n\tputchar(x%10+'0');\n}\ntemplate<class o> void pr1(o x) {\n\tif(x<0)x=-x,putchar('-');\n\tqw(x); putchar(' ');\n}\n\nll power(ll a,ll b=mod-2) {\n\tll c=1;\n\twhile(b) {\n\t\tif(b&1) c=c*a%mod;\n\t\ta=a*a%mod; b=b>>1;\n\t}\n\treturn c;\n}\nint m,tr[N];\nll a[N],f[N],A[N],B[N],tmp[N];\n//B(x)=(B*)(x)/2 + A(x)/(2*(B*(x))) \n//a\u4e3a\u539f\u9898\u4e2d\u7684A,f\u7528\u4e8e\u5b582(B*),B\u7528\u4e8e\u89e3\u9006\u5143,tmp\u4e3a\u4e34\u65f6\u6570\u7ec4 \n\nvoid NTT(ll *f,int e,int n) {\n\tfor(int i=1;i<n;i++)\n\t\tif(i<tr[i]) swap(f[i],f[tr[i]]);\n\tfor(int p=2,len;p<=n;p<<=1) {\n\t\tlen=p>>1;\n\t\tll tg=power(e,(mod-1)/p),buf,t;\n\t\tfor(int k=0;k<n;k+=p) {\n\t\t\tbuf=1;\n\t\t\tfor(int l=k;l<k+len;l++) {\n\t\t\t\tt=f[l+len]*buf%mod;\n\t\t\t\tf[l+len]=(f[l]-t+mod)%mod;\n\t\t\t\tf[l]=(f[l]+t)%mod;\n\t\t\t\tbuf=buf*tg%mod;\n\t\t\t}\n\t\t}\n\t}\n}\n\nvoid mult(ll *a,ll *b,int n) {//\u4e24\u4e2a\u591a\u9879\u5f0f\u5927\u5c0f\u5747\u4e3an\u2014\u20142\u7684\u6b21\u5e42\n\tfor(int i=0;i<n;i++) tmp[i]=b[i];\n\tfor(int i=n;i<2*n;i++) tmp[i]=0;\n\tn<<=1;\n\tfor(int i=1;i<n;i++) tr[i]=(tr[i>>1]>>1)|(i&1?n>>1:0);\n\tNTT(a,g,n); NTT(tmp,g,n); \t for(int i=0;i<n;i++) a[i]=a[i]*tmp[i]%mod;\n\tNTT(a,G,n); ll Inv=power(n); for(int i=0;i<n;i++) a[i]=a[i]*Inv %mod;\n}\n\nvoid inv(int n) {//\u6c42f\u7684\u9006\u5143\u2014\u2014\u6700\u540e\u5b58\u5230B\u4e2d \n\tB[0]=inv2;\n\tfor(int i=1;i<n;i++) B[i]=0;\n\tfor(int p=2,len;p<=n;p<<=1) {\n\t\tlen=p>>1;\n\t\tfor(int i=0;i<len;i++)\n\t\t\tA[i]=2*B[i]%mod;\n\t\tmult(B,B,len); mult(B,f,p);\n\t\tfor(int i=0;i<p;i++) B[i]=(A[i]-B[i]+mod)%mod;\n\t\tfor(int i=p;i<2*p;i++) B[i]=0;\n\t}\n\tfor(int i=0;i<n;i++) A[i]=0;\n}\n\nvoid Sqrt() {\n\tf[0]=2;//(B*)(x)=1\n\tint n; for(n=1;n<=m;n<<=1);\n\tfor(int p=2;p<=n;p<<=1) {\n\t\tinv(p);\n\t\tmult(B,a,p);\n\t\tfor(int i=0;i<p;i++)\n\t\t\tf[i]=(f[i]*inv2+2LL*B[i])%mod;\n\t}\n\tfor(int i=0;i<=m;i++) pr1(f[i]*inv2%mod);\n\tputs(\"\");\n}\n\nint main() {\n\tqr(m); m--;\n\tfor(int i=0,x;i<=m;i++) \n\t\tqr(x),a[i]=x;\n\tSqrt(); return 0;\n}\n```\n",
        "postTime": 1583415826,
        "uid": 118826,
        "name": "2018LZY",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5205 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5f00\u6839\u3011"
    },
    {
        "content": "\u5df2\u77e5$A(x)$,\u6c42$B(x)$\u6ee1\u8db3\n$$B^2(x)\\equiv A(x)\\pmod{x^n}$$\n\u6613\u5f97\n$$B^2(x)-A(x)\\equiv0\\pmod{x^n}$$\n\u8bbe\n$$G(B(x))\\equiv B^2(x)-A(x)\\pmod{x^n}$$\n\u8003\u8651\u5230$A(x)$\u4e3a\u5e38\u6570\n$$G'(B(x))=2B(x)$$\n\u4e8e\u662f\u8fdb\u884c\u725b\u987f\u8fed\u4ee3\n$$B(x)\\equiv B_0(x)-\\frac{G(B_0(x))}{G'(B_0(x)}\\pmod{x^n}$$\n\u5316\u7b80\u4e00\u4e0b\u6709\n$$B(x)\\equiv \\frac{A(x)+B_0^2(x)}{2B_0(x)}\\pmod{x^n}$$\n\u4ee3\u7801\u5982\u4e0b\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\nconst int N = 1<<20;\n\nconst int inv2 = 499122177, P = 998244353, g = 3, gi = 332748118;\nint rev[N], F[N], G[N], A[N], B[N], C[N], D[N];\n\nint read() {\n\tint x = 0, f = 1; char c = getchar();\n\twhile(c < '0' || c > '9') {if(c == '-') f = -1; c = getchar();}\n\twhile(c >= '0' && c <= '9') x = (x<<1) + (x<<3) + c - '0', c = getchar();\n\treturn x * f;\n}\nint add(int a, int b) {\n\treturn (a += b) >= P ? a - P : a;\n}\nint qpow(int a, int b) \n{\n\tint prod = 1;\n\twhile(b)\n\t{\n\t\tif(b & 1) prod = 1LL * prod * a % P;\n\t\ta = 1LL * a * a % P;\n\t\tb >>= 1;\n\t}\n\treturn (prod + P) % P;\n}\nvoid NTT(int *A, int n, int inv) \n{\n\tfor(int i = 0; i < n; ++i)\n\t\tif(i < rev[i]) swap(A[i], A[rev[i]]);\n\tfor(int mid = 1; mid < n; mid <<= 1) \n\t{\n\t\tint tmp = qpow(inv == 1 ? g : gi, (P - 1) / (mid << 1));\n\t\tfor(int j = 0; j < n; j += (mid << 1)) \n\t\t{\n\t\t\tint omega = 1;\n\t\t\tfor(int k = 0; k < mid; ++k, omega = 1LL * omega * tmp % P) \n\t\t\t{\n\t\t\t\tint x = A[j + k], y = 1LL * omega * A[j + k + mid] % P;\n\t\t\t\tA[j + k] = (x + y) % P;\n\t\t\t\tA[j + k + mid] = (ll)(x - y + P) % P;\n\t\t\t}\n\t\t}\n\t}\n\tif(inv == 1) return;\n\tint invn = qpow(n, P - 2);\n\tfor(int i = 0; i < n; ++i)\n\t\tA[i] = 1LL * A[i] * invn % P;\n}\nvoid Inv(int *a, int *b, int n) \n{\n\tb[0] = qpow(a[0], P - 2);\n\tint len, lim;\n\tfor(len = 1; len < (n << 1); len <<= 1)\n\t{\n\t\tlim = len << 1;\n\t\tfor(int i = 0; i < len; i++)\n\t\t\tA[i] = a[i], B[i] = b[i];\n\t\tfor(int i = 0; i < lim; i++)\n\t\t\trev[i] = (rev[i >> 1] >> 1) | ((i & 1) ? len : 0);\n\t\tNTT(A, lim, 1), NTT(B, lim, 1);\n\t\tfor(int i = 0; i < lim; i++)\n\t\t\tb[i] = ((2LL - 1LL * A[i] * B[i] % P) * B[i] % P + P) % P;\n\t\tNTT(b, lim, -1);\n\t\tfor(int i = len; i < lim; i++)\n\t\t\tb[i] = 0;\n\t}\n\tfor(int i = 0; i < len; i++) \n\t\tA[i] = B[i] = 0;\n\tfor(int i = n; i < len; i++)\n\t\tb[i] = 0;\n}\nvoid Sqrt(int *a, int *b, int n)\n{\n\tb[0] = 1;\n\tint *A = C, *B = D, len, lim;\n\tfor(len = 1; len < (n<<1); len <<= 1)\n\t{\n\t\tlim = len << 1;\n\t\tfor(int i = 0; i < len; i++)\n\t\t\tA[i] = a[i];\n\t\tInv(b, B, len);\n\t\tfor(int i = 0; i < lim; i++)\n\t\t\trev[i] = (rev[i >> 1] >> 1) | ((i & 1) ? len : 0);\n\t\tNTT(A, lim, 1), NTT(B, lim, 1);\n\t\tfor(int i = 0; i < lim; i++)\n\t\t\tA[i] = 1LL * A[i] * B[i] % P;\n\t\tNTT(A, lim, -1);\n\t\tfor(int i = 0; i < len; i++)\n\t\t\tb[i] = 1LL * (b[i] + A[i]) % P * inv2 % P;\n\t\tfor(int i = len; i < lim; i++)\n\t\t\tb[i] = 0;\n\t}\n\tfor(int i = 0; i < len; i++)\n\t\tA[i] = B[i] = 0;\n\tfor(int i = n; i < len; i++)\n\t\tb[i] = 0;\n}\nint main()\n{\n\tint n = read();\n\tfor(int i = 0; i < n; ++i)\n\t\tF[i] = read();\n\tSqrt(F, G, n);\n\tfor(int i = 0; i < n; ++i)\n\t\tprintf(\"%d \", G[i]);\n\treturn 0;\n}\n```\n",
        "postTime": 1558698831,
        "uid": 139340,
        "name": "Gauss0320",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5205\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5f00\u6839"
    }
]
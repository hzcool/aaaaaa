[
    {
        "content": "\u8003\u8651\u5148\u94a6\u5b9a\u4e00\u4e2a $k$ \u8ba1\u7b97\u7b54\u6848\u3002\n\n\u6b64\u65f6\u6709\u4e00\u4e2a\u663e\u7136\u7684 dp\uff1a\u8bb0 $f_{u,0/1}$ \u4e3a\u4ee5 $u$ \u4e3a\u6839\u7684\u5b50\u6811\uff0c$u$ \u4e0d\u5728/\u5728\u67d0\u4e00\u4e2a\u8fde\u901a\u5757\u4e2d\u7684\u6700\u4f18\u89e3\uff0c\u8f6c\u79fb\u663e\u7136\u3002\n\n\u5982\u679c\u5bf9\u4e8e\u6bcf\u4e2a $k$ \u66b4\u529b\u8fdb\u884c\u4e00\u6b21 dp\uff0c\u590d\u6742\u5ea6\u662f $\\mathcal O(n^2)$ \u7684\uff0c\u9700\u8981\u4f18\u5316\u3002\n\n\u8bb0 $g_i$ \u8868\u793a $k=i$ \u65f6\u53d6\u5230\u6700\u4f18\u89e3\u7684\u6700\u5c0f\u8fde\u901a\u5757\u6570\uff0c\u4e0d\u96be\u53d1\u73b0 $g_i$ \u5355\u8c03\u4e0d\u589e\u3002\n\n\u82e5\u5bf9\u4e00\u4e2a\u533a\u95f4 $[l,r]$ \u6709 $g_l=g_r$\uff0c\u90a3\u4e48 $\\forall i\\in[l,r]$ \u6709 $g_i=g_l$\uff0c\u6b64\u65f6\u6211\u4eec\u53ea\u9700\u8981\u5bf9 $k=l$ \u8fdb\u884c\u4e00\u6b21 dp \u4e4b\u540e\u4fbf\u53ef\u4ee5 $\\mathcal O(r-l)$ \u6c42\u51fa\u6240\u6709 $[l,r]$ \u4e2d\u7684\u7b54\u6848\u3002\n\n\u81ea\u7136\u60f3\u5230\u5206\u6cbb\uff0c\u8bb0\u72b6\u6001 $(l,r,ql,qr)$ \u8868\u793a\u5f53\u524d\u5904\u7406 $[l,r]$ \u533a\u95f4\uff0c\u4e4b\u524d\u5df2\u7ecf\u6c42\u51fa $g_{l-1}=ql,g_{r+1}=qr$\u3002\n\n\u53d6\u5206\u6cbb\u4e2d\u5fc3 $mid=\\lfloor\\frac{l+r}2\\rfloor$ \u5e76\u5bf9 $k=mid$ \u8fdb\u884c\u4e00\u6b21 dp \u6c42\u51fa $g_{mid}$\uff0c\u82e5 $g_{mid}=ql$ \u5219\u4e0d\u9700\u8981\u7ee7\u7eed\u5904\u7406\u5de6\u4fa7\u533a\u95f4\uff1b\u53f3\u4fa7\u533a\u95f4\u540c\u7406\u3002\n\n\u8003\u8651\u5206\u6790\u8fd9\u4e2a\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u5bf9\u4e8e $k$\uff0c\u4e0d\u96be\u53d1\u73b0\u6240\u6709\u8ddd\u79bb $\\le k$ \u7684\u5173\u952e\u70b9\u5bf9\u4e00\u5b9a\u5728\u540c\u4e00\u8fde\u901a\u5757\u4e2d\uff0c\u4e8e\u662f\u8003\u8651\u628a\u8fd9\u4e9b\u70b9\u7f29\u8d77\u6765\uff0c\u6b64\u65f6\u6240\u6709\u5173\u952e\u70b9\u5bf9\u4e4b\u95f4\u7684\u8ddd\u79bb\u5747 $> k$\u3002\n\n\u8bb0 $cnt$ \u4e3a\u5173\u952e\u70b9\u4e2a\u6570 $dis(u,v)$ \u8868\u793a\u5173\u952e\u70b9 $u$ \u4e0e\u5173\u952e\u70b9 $v$ \u4e4b\u95f4\u7684\u8ddd\u79bb\uff0c\u5e8f\u5217 $u_i$ \u8868\u793a\u6240\u6709\u5173\u952e\u70b9\u6309 dfs \u5e8f\u6392\u5e8f\u4e4b\u540e\u7684\u7ed3\u679c\uff0c$u_{cnt+1}=u_1$\u3002\n\n\u90a3\u4e48\u6709 $2n\\ge \\sum_idis(u_i,u_{i+1})\\ge k\\cdot cnt\\Rightarrow cnt\\le \\frac {2n}{k}$\uff08\u6b64\u65f6\u76f4\u63a5\u5728\u5173\u952e\u70b9\u7ec4\u6210\u7684\u865a\u6811\u4e0a\u8fdb\u884c dp \u5373\u53ef\u5f97\u5230\u4e00\u4e2a $\\mathcal O(n\\ln n)$ \u7684\u89e3\u6cd5\uff0c\u4f46\u662f\u611f\u89c9\u4e0d\u592a\u597d\u5199\uff09\uff0c\u5373 $g_k\\le \\frac {2n}k$\n\n\u8003\u8651 $k\\le\\sqrt{2n}$ \u65f6\uff0c\u53ea\u9700\u8fdb\u884c $\\mathcal O(\\sqrt n)$ \u6b21 dp\uff1b$k\\ge \\sqrt{2n}$ \u65f6\uff0c\u6709 $g_k\\le \\sqrt {2n}$\uff0c\u5373\u6700\u591a\u53ea\u6709 $\\mathcal O(\\sqrt n)$ \u79cd\u4e0d\u540c\u7684\u8fde\u901a\u5757\u4e2a\u6570\uff0c\u800c\u5206\u6cbb\u76f8\u5f53\u4e8e\u4e0d\u65ad\u4e8c\u5206\u627e\u5230\u8fd9 $\\mathcal O(\\sqrt n)$ \u4e2a\u65ad\u70b9\uff0c\u603b\u590d\u6742\u5ea6\u5373\u4e3a $\\mathcal O(n\\sqrt n\\log n)$\u3002\n\n\uff08\u5b98\u65b9\u9898\u89e3\u8bf4\u8fd9\u79cd\u7b97\u6cd5\u662f $\\mathcal O(n\\sqrt n)$ \u7684\uff0c\u4e0d\u662f\u5f88\u7406\u89e3\uff08\n\n\u4ee3\u7801\u9700\u8981\u4e00\u5b9a\u5361\u5e38\uff0c\u4f8b\u5982\u628a\u6bcf\u6b21 dp \u653e\u5728 dfs \u5e8f\u4e0a\u3002\n\ncode:\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define MAXN 200010\nusing namespace std;\nconst int inf=0x3f3f3f3f3f3f3f3f;\nint n,ans[MAXN];\nchar c[MAXN];\nstruct Node{int to,nxt;}Edge[MAXN<<1];\nint Head[MAXN],cnt_Edge;\nvoid Add_Edge(int u,int v){\n\tEdge[++cnt_Edge]=(Node){v,Head[u]};\n\tHead[u]=cnt_Edge;\n}\nint dfn[MAXN],pre[MAXN],id[MAXN],tot;\nvoid dfs(int u,int fa){\n\tdfn[u]=++tot;id[tot]=u;pre[tot]=dfn[fa];\n\tfor(int i=Head[u];i;i=Edge[i].nxt){\n\t\tint v=Edge[i].to;if(v==fa)continue;\n\t\tdfs(v,u);\n\t}\n}\nint f[MAXN][2],cnt[MAXN][2];\nvoid dp(int val){\n\tfor(int i=1;i<=n;i++)f[i][0]=(c[id[i]]=='0'?0:inf),f[i][1]=1,cnt[i][0]=cnt[i][1]=0;\n\tfor(int v=n;v>1;v--){\n\t\tint u=pre[v];\n\t\tif(f[v][0]<f[v][1]+val||(f[v][0]==f[v][1]+val&&cnt[v][0]<cnt[v][1]+1))\n\t\t\tf[u][0]+=f[v][0],cnt[u][0]+=cnt[v][0];\n\t\telse f[u][0]+=f[v][1]+val,cnt[u][0]+=cnt[v][1]+1;\n\t\tif(f[v][0]<f[v][1]||(f[v][0]==f[v][1]&&cnt[v][0]<cnt[v][1]))\n\t\t\tf[u][1]+=f[v][0],cnt[u][1]+=cnt[v][0];\n\t\telse f[u][1]+=f[v][1],cnt[u][1]+=cnt[v][1];\n\t}\n}\nvoid solve(int l,int r,int ql,int qr){\n\tif(l>r)return;\n\tint mid=(l+r)>>1;dp(mid);\n\tint res=0,sum=0;\n\tif(f[1][0]<f[1][1]+mid||(f[1][0]==f[1][1]+mid&&cnt[1][0]<cnt[1][1]+1))\n\t\tres=f[1][0],sum=cnt[1][0];\n\telse res=f[1][1]+mid,sum=cnt[1][1]+1;\n\tans[mid]=res;res-=mid*sum;\n\tif(ql==sum)\n\t\tfor(int i=l;i<mid;i++)ans[i]=res+i*sum;\n\telse solve(l,mid-1,ql,sum);\n\tif(qr==sum)\n\t\tfor(int i=mid+1;i<=r;i++)ans[i]=res+i*sum;\n\telse solve(mid+1,r,sum,qr);\n}\nsigned main(){\n\tscanf(\"%lld%s\",&n,c+1);\n\tfor(int i=1;i<n;i++){\n\t\tint u,v;scanf(\"%lld%lld\",&u,&v);\n\t\tAdd_Edge(u,v);Add_Edge(v,u);\n\t}dfs(1,0);\n\tsolve(1,n,n,1);\n\tfor(int i=1;i<=n;i++)printf(\"%lld\\n\",ans[i]);\n\treturn 0;\n}\n```",
        "postTime": 1678543358,
        "uid": 65681,
        "name": "UltiMadow",
        "ccfLevel": 7,
        "title": "[\u9898\u89e3] [USACO23FEB] Watching Cowflix P"
    },
    {
        "content": "\u5176\u5b9e\u6211\u6700\u5148\u6ce8\u610f\u5230\u7684\u662f\u5982\u679c\u4e24\u4e2a\u5173\u952e\u70b9\u8ddd\u79bb $\\leq k$\uff0c\u90a3\u4e48\u4ed6\u4eec\u53ef\u4ee5\u76f4\u63a5\u88ab\u5408\u5e76\u3002\u8fd9\u6837\u5408\u5e76\u5b8c\u4e4b\u540e\u6700\u591a\u53ea\u6709 $\\mathcal{O}(\\frac{n}{k})$ \u4e2a\u5173\u952e\u70b9\u3002\u7136\u540e\u53d1\u73b0\u597d\u50cf\u8fd8\u6ca1\u6700\u4f18\u5462\uff0c\u8fd8\u53ef\u80fd\u5728\u5173\u952e\u70b9\u7684\u865a\u6811\u4e0a\u7684\u67d0\u4e2a\u975e\u5173\u952e\u70b9\u5904\u53d1\u751f\u5408\u5e76\uff0c\u90a3\u6211\u4eec\u5c31\u6c42\u51fa\u865a\u6811\uff0c\u7136\u540e\u6811\u5f62 DP \u4e00\u4e0b\uff0c\u5c31\u505a\u5b8c\u4e86\u3002\u56e0\u4e3a\u53ea\u6709 $\\mathcal{O}(\\frac{n}{k})$ \u4e2a\u5173\u952e\u70b9\uff0c\u6240\u4ee5\u865a\u6811\u4e0a\u6700\u591a\u4e5f\u53ea\u6709 $\\mathcal{O}(\\frac{n}{k})$ \u4e2a\u70b9\uff0c\u6839\u636e\u8c03\u548c\u7ea7\u6570\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n \\log n)$\u3002\n\n\u8fd9\u6837\u8bf4\u8d77\u6765\u662f\u5f88\u7b80\u5355\uff0c\u4f46\u5199\u8d77\u6765\u8fd8\u662f\u6709\u4e0d\u5c11\u7ec6\u8282\u3002\u4ee3\u7801\u4e2d\u7684\u5b9e\u73b0\u65b9\u6cd5\u662f\u8fd9\u6837\u7684\uff1a\u6211\u4eec\u5148\u6c42\u51fa\u865a\u6811\uff0c\u7136\u540e\u9884\u5904\u7406\u51fa\u6bcf\u4e2a\u70b9\u53ca\u6bcf\u6761\u8fb9\u88ab\u5408\u5e76\u7684\u65f6\u95f4\uff0c\u4ee5\u53ca\u6bcf\u4e2a\u70b9\u88ab\u67d0\u4e2a\u8054\u901a\u5757\u5b8c\u5168\u5305\u88f9\u5728\u5185\u90e8\u7684\u65f6\u95f4\u3002\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u6c42\u51fa\u6bcf\u4e2a\u65f6\u523b DP \u524d\u7684\u8fde\u901a\u5757\u4f1a\u65b0\u589e\u591a\u5c11\u4e2a\u70b9\uff0c\u591a\u5c11\u6761\u8fb9\u3002\u7528 ```set``` \u7ef4\u62a4\u5f53\u524d\u5269\u4e0b\u7684\u70b9\u7684 DFS \u5e8f\u4ee5\u51cf\u5c0f DP \u7684\u5e38\u6570\uff0c\u5f53\u4e00\u4e2a\u70b9\u88ab\u67d0\u4e2a\u8fde\u901a\u5757\u5b8c\u5168\u5305\u88f9\u5728\u5185\u90e8\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u628a\u5b83\u5220\u6389\u4e86\u3002\u5177\u4f53\u7684\u7ec6\u8282\u53c2\u89c1\u4ee3\u7801\u3002\n\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N = 5e5 + 5, inf = 2e9;\nint n, par[N], val[N], dep[N]; bool key[N], era[N];\nset <int> e[N];\nvoid remove(int u) {\n\tfor (auto v : e[u]) {\n\t\tpar[v] = u, val[v] = 1, dep[v] = dep[u] + 1;\n\t\te[v].erase(e[v].find(u)), remove(v);\n\t}\n\tif (!key[u]) {\n\t\tbool ok = 1;\n\t\tfor (auto v : e[u]) ok &= era[v];\n\t\tif (ok) era[u] = 1;\n\t}\n}\nint dis[N], _dis[N], tim[N], _tim[N], c[N], d[N], f[N][2], ans[N];\nvector <int> buk[N];\nstruct dat {\n\tint i;\n\tbool operator < (const dat &p) const {\n\t\treturn dep[i] != dep[p.i] ? dep[i] > dep[p.i] : i > p.i;\n\t}\n};\nset <dat> cur; \nvoid dfs(int u) {\n\tdis[u] = _dis[u] = (key[u] ? 0 : inf);\n\tfor (int v : e[u]) {\n\t\tdfs(v);\n\t\tint L = dis[v] + val[v];\n\t\tif (L < dis[u]) _dis[u] = dis[u], dis[u] = L;\n\t\telse if (L < _dis[u]) _dis[u] = L;\n\t}\n}\nvoid calc(int u, int L) {\n\t_tim[u] = dis[u] + L;\n\tfor (int v : e[u]) {\n\t\tint _L = (dis[v] + val[v] == dis[u]) ? _dis[u] : dis[u];\n\t\tcalc(v, min(_L, L) + val[v]);\n\t}\n}\nsigned main() {  \n    ios :: sync_with_stdio(false);\n    cin.tie(nullptr);\n    string s;\n\tcin >> n >> s;\n\tint root = -1;\n\tfor (int i = 1; i <= n; i++) if (s[i - 1] == '1') key[i] = 1, root = i;\n\tfor (int i = 1, x, y; i < n; i++) {\n\t\tcin >> x >> y;\n\t\te[x].insert(y), e[y].insert(x);\n\t}\n\tremove(root);\n\tfor (int i = 1; i <= n; i++) if (era[i]) e[par[i]].erase(e[par[i]].find(i))\n\tfor (int i = 1; i <= n; i++) {\n\t\tif (!era[i] && !key[i] && e[i].size() == 1) { int u = i, v = -1; \n\t\t\tfor (auto z : e[u]) v = z;\n\t\t\tassert(v > 0);\n\t\t\tpar[v] = par[u], val[v] += val[u], e[par[u]].erase(e[par[u]].find(u)), e[par[u]].insert(v);\n\t\t\tera[u] = 1;\n\t\t}\n\t}\n\tdfs(root), calc(root, 0);\n\tfor (int i = 1; i <= n; i++) if (!era[i]) {\n\t\tcur.insert((dat){ i });\n\t\ttim[i] = key[i] ? 0 : _tim[i];\n\t\tint t = _tim[i];\n\t\tfor (auto v : e[i]) tim[i] = min(tim[i], _tim[v]), t = max(t, _tim[v]);\n\t\tbuk[t].push_back(i);\n\t\tc[tim[i]]++;\n\t\tif (dep[i] != 0) c[_tim[i]] += val[i] - 1, d[_tim[i]] += val[i];\n\t} \n\tint C = c[0], D = 0;\n\tfor (int k = 1; k <= n; k++) {\n\t\tfor (int i : buk[k]) {\n\t\t\tauto it = cur.find((dat){ i });\n\t\t\tassert(it != cur.end());\n\t\t\tcur.erase(it);\n\t\t}\n\t\tC += c[k], D += d[k];\n\t\tans[k] = k * (C - D) + C;\n\t\tfor (auto z : cur) {\n\t\t\tint v = z.i;\n\t\t\tif (tim[v] <= k) f[v][0] = inf;\n\t\t\telse f[v][1] += k + 1;\n\t\t\tif (_tim[v] <= k) ans[k] += f[v][1];\n\t\t\telse {\n\t\t\t\tint u = par[v];\n\t\t\t\tf[u][0] += min(f[v][0], f[v][1]);\n\t\t\t\tf[u][1] += min(f[v][0], min(f[v][1], f[v][1] - k + (val[v] - 1)));\n\t\t\t}\n\t\t\tf[v][0] = f[v][1] = 0;\n\t\t}\n\t}\n\tfor (int i = 1; i <= n; i++) cout << ans[i] << \"\\n\";\n    return 0; \n}\n```",
        "postTime": 1679146588,
        "uid": 246019,
        "name": "_came11ia_",
        "ccfLevel": 7,
        "title": "P9132 [USACO23FEB] Watching Cowflix P"
    },
    {
        "content": "\u6709\u4e00\u79cd\u663e\u7136\u7684\u5408\u6cd5\u65b9\u6848\u662f\u6bcf\u4e2a\u70b9\u5efa\u4e00\u4e2a\u8fde\u901a\u5757\uff0c\u53e6\u4e00\u79cd\u662f\u6240\u6709\u70b9\u5728\u4e00\u4e2a\u8fde\u901a\u5757\uff0c\u5176\u4ed6\u65b9\u6848\u4ecb\u4e8e\u8fd9\u4e24\u79cd\u65b9\u6848\u4e4b\u95f4\u3002\n\n\u8003\u8651\u4e00\u4e2a\u5927\u529b\u505a\u6cd5\uff1a\u6309 $k$ \u4ece\u5c0f\u5230\u5927\u626b\u63cf\uff0c\u5efa\u51fa\u8be2\u95ee\u70b9\u4e4b\u95f4\u7684\u865a\u6811\uff0c\u8fb9\u6743\u4e3a\u4e24\u70b9\u95f4\u7684\u70b9\u6570\uff0c\u8dd1\u6811 DP \u4ee5\u51b3\u7b56\u662f\u5426\u5728\u5f53\u70b9\u5408\u5e76\u8fde\u901a\u5757\u6216\u65b0\u5efa\u8fde\u901a\u5757\u3002\n\n\u8fd9\u6837 DP \u7684\u7ed3\u679c\u5c31\u662f\uff0c\u82e5\u51b3\u7b56\u51fa\u4e24\u70b9\u4e0d\u5c5e\u540c\u4e00\u8fde\u901a\u5757\uff0c\u5219\u4e24\u70b9\u4e4b\u95f4\u8ddd\u79bb $\\ge k$\uff0c\u5426\u5219\u5408\u5e76\u8d77\u6765\u4e00\u5b9a\u4e0d\u52a3\u3002\u7b49\u4ef7\u5730\uff0c\u6709\u4efb\u610f\u4e24\u51b3\u7b56\u51fa\u7684\u8fde\u901a\u5757\u95f4\u8ddd\u79bb $\\ge k$\u3002\n\n\u56e0\u6b64\uff0c\u628a\u5c5e\u540c\u4e00\u4e2a\u8fde\u901a\u5757\u7684\u70b9\u7f29\u8d77\u6765\uff0c\u8fd9\u6837\u5bf9\u4e8e\u6bcf\u4e2a $k$ \u53ea\u4f1a\u6709 $O(n/k)$ \u4e2a\u70b9\u5728\u865a\u6811\u4e0a\u3002\u590d\u6742\u5ea6 $O(n \\log n)$\u3002\n\n[\u6700\u4f18\u89e3](https://www.luogu.com.cn/record/104349713)\u3002\n\n```cpp\nconst int N = 200005, INF = 0x3f3f3f3f;\n// \u8054\u901a\u4e4b\u540e\u76f4\u63a5\u7f29\u70b9\n// \u672a\u88ab\u8054\u901a\u7684\u8fb9\u90fd >=k\n// \u6240\u4ee5\u5757\u6570 <= n/k\n// O(nlogn)\n\nint n; char key[N];\nlist<pair<int, int>> g[N];\nint root, siz[N], k;\n\nvoid init() {\n\tBS<int> tr[N];\n\trd(n); scanf(\"%s\", key + 1); U (i, 1, n) key[i] -= '0';\n\tU (i, 2, n) {\n\t\tint u, v; rd(u, v);\n\t\ttr[u] += v; tr[v] += u;\n\t}\n\tint beg[N], st[20][N * 2], ptr, mp[N * 2], Lg[N * 2] {-1}, dep[N] {};\n\tfunction<void(int, int)> dfs = [&](int u, int f) {\n\t\tbeg[u] = ++ptr; mp[ptr] = u; st[0][ptr] = beg[u]; dep[u] = dep[f] + 1;\n\t\tfor (int v : tr[u]) if (v != f) {\n\t\t\tdfs(v, u);\n\t\t\tst[0][++ptr] = beg[u];\n\t\t}\n\t};\n\tdfs(1, 0);\n\tU (i, 1, n * 2 - 1) Lg[i] = Lg[i >> 1] + 1;\n\tfor (int k = 1; (1 << k) <= 2 * n - 1; ++k)\n\t\tU (i, 1, (n * 2 - 1) - (1 << k) + 1)\n\t\t\tst[k][i] = min(st[k - 1][i], st[k - 1][i + (1 << (k - 1))]);\n\tauto lca = [&](int u, int v) {\n\t\tu = beg[u]; v = beg[v]; if (u > v) swap(u, v);\n\t\tint g = Lg[v - u + 1];\n\t\treturn mp[min(st[g][u], st[g][v - (1 << g) + 1])];\n\t};\n\t\n\tvector<int> pt(1, 1);\n\tU (i, 1, n) if (key[i]) pt.push_back(i);\n\tsort(pt.begin(), pt.end(), [&](int u, int v) {\n\t\treturn beg[u] < beg[v]; });\n\t\n\tU (i, 0, pt.size() - 2)\n\t\tpt.push_back(lca(pt[i], pt[i + 1]));\n\tsort(pt.begin(), pt.end(), [&](int u, int v) {\n\t\treturn beg[u] < beg[v]; });\n\tpt.erase(unique(pt.begin(), pt.end()), pt.end());\n\t\n\tU (i, 0, pt.size() - 2) {\n\t\tint l = lca(pt[i], pt[i + 1]);\n\t\tg[l].push_back({pt[i + 1], dep[pt[i + 1]] - dep[l] - 1});\n\t}\n\tfor (int u : pt) siz[u] = 1;\n\t\n\troot = (g[1].size() > 1 || key[1]) ? 1 : g[1].begin()->first;\n}\n\nint f[N][2]; // f(0/1) \u5f53\u524d\u70b9\u662f\u5426\u6709\u8fde\u901a\u5757\uff0c\u8981\u8003\u8651 lca \u7684\u60c5\u51b5\nvoid dp(int u) {\n\tfor (auto [v, w] : g[u])\n\t\tdp(v);\n\t\n\tf[u][1] = siz[u] + k;\n\tfor (auto [v, w] : g[u])\n\t\tf[u][1] += min({f[v][0], f[v][1], f[v][1] + w - k});\n\tif (key[u]) { // \u5fc5\u7136\u8981\u5efa\u4e00\u4e2a\u8fde\u901a\u5757\n\t\tf[u][0] = INF;\n\t} else {\n\t\tf[u][0] = 0;\n\t\tfor (auto [v, w] : g[u])\n\t\t\tf[u][0] += min({f[v][0], f[v][1]});\n\t}\n}\nvoid cons(int u, int t) { // \u9009\u62e9 f(u)\n\tif (t) {\n\t\tlist<pair<int, int>> tmp;\n\t\tfor (auto it = g[u].begin(); it != g[u].end(); ) {\n\t\t\tauto [v, w] = *it;\n\t\t\tif (f[v][1] + w - k <= min(f[v][0], f[v][1])) {\n\t\t\t\tcons(v, 1);\n\t\t\t\tsiz[u] += siz[v] + w; siz[v] = 0;\n\t\t\t\tkey[u] |= key[v];\n\t\t\t\ttmp.splice(tmp.end(), g[v]);\n\t\t\t\tg[u].erase(it++);\n\t\t\t} else if (f[v][0] < min(f[v][1] + w - k, f[v][1])) {\n\t\t\t\tcons(v, 0);\n\t\t\t\t++it;\n\t\t\t} else {\n\t\t\t\tcons(v, 1);\n\t\t\t\t++it;\n\t\t\t}\n\t\t}\n\t\tg[u].splice(g[u].end(), tmp);\n\t} else {\n\t\tfor (auto [v, w] : g[u])\n\t\t\tif (f[v][1] < f[v][0])\n\t\t\t\tcons(v, 1);\n\t\t\telse\n\t\t\t\tcons(v, 0);\n\t}\n}\n\nint main() {\n\tinit();\n\t\n\tfor (k = 1; k <= n; ++k) {\n\t\tdp(root);\n\t\tcons(root, f[root][1] <= f[root][0]);\n\t\tprintf(\"%d\\n\", min(f[root][0], f[root][1]));\n\t}\n}\n```",
        "postTime": 1678519153,
        "uid": 120324,
        "name": "Yansuan_HCl",
        "ccfLevel": 7,
        "title": "[\u9898\u89e3] P9132 [USACO23FEB] Watching Cowflix P"
    }
]
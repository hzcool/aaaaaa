[
    {
        "content": "\u770b\u5230\u9898\u9762\uff0c\u7ed9\u4e86\u6211\u4eec\u4e00\u4e2a\u6709\u7455\u75b5\u7684\u7a0b\u5e8f\uff0c\u4f46\u662f\u6bd2\u7624\u7684\u662f\uff0c\u522b\u7684\u7a0b\u5e8f TLE\uff0c~~\u8dd1\u4e2a1\u5e74\u5de6\u53f3~~\u6700\u540e\u8fd8\u662f\u4f1a\u51fa\u6b63\u786e\u7b54\u6848\u7684\uff0c\u7136\u800c\u8fd9\u7a0b\u5e8f T \u4e86\u5012\u662f\u544a\u8bc9\u4f60  `invalid input\uff01` \n\n\u600e\u4e48\u529e\u5462\uff0c\u80af\u5b9a\u662f\u8981\u4ece\u5206\u6790\u8fd9\u4e2a\u7a0b\u5e8f\u5165\u624b\u3002\u5982\u4f55\u5206\u6790\u8fd9\u4e2a\u7a0b\u5e8f\u5462\uff1f\u9996\u5148\uff0c\u4f60\u53ef\u80fd\u6253\u4e0d\u5f00\u5b83\uff0c\u4f1a\u63d0\u793a\u5c11 `libgcc_s_dw2-1.dll` \u548c `libstdc++-6.dll` \u8fd9\u4e24\u4e2a\u6587\u4ef6\uff0c\u89e3\u51b3\u65b9\u6848\uff0c\u4e0b\u8f7d\u5b83\u4eec\uff0c\u628a\u4ed6\u4eec\u548c `lost.exe` \u7a0b\u5e8f\u653e\u5728\u4e00\u8d77\n\n[\u4e0b\u8f7d\u5730\u5740](https://pan.baidu.com/s/1MSI9ldn2VuMAzCiVo2WzoQ) \u63d0\u53d6\u7801\uff1a8d21\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u6109\u5feb\u7684\u5206\u6790\u5b83\u4e86\uff0c\u5176\u4ed6\u5927\u4f6c\u90fd\u662f\u8bd5\u6570\u636e\u770b\u8f93\u51fa\u77e5\u7b97\u6cd5\uff0c\u4f46\u662f\u6211\u8fd9\u4e2a\u849f\u84bb\u6bdb\u90fd\u770b\u4e0d\u51fa\u6765\uff0c\u4e8e\u662f\u53ea\u597d\u5bf9\u5b83\u8fdb\u884c\u53cd\u7f16\u8bd1\u3002\n\n\u7528 IDA \u6253\u5f00\u5b83\u8fdb\u884c\u5206\u6790\u3002\u9996\u5148\uff0c\u5728\u51fd\u6570\u7a97\u53e3\u91cc\u627e\u5230 `_main` \u51fd\u6570\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/59623.png)\n\n\uff08\u5176\u5b9e\u6839\u636e\u8fd9\u4e9b\u51fd\u6570\u540d\u90fd\u53ef\u4ee5\u63a8\u6d4b\u51fa\u4e00\u4e9b\u4e1c\u897f\u4e86\uff09\u53cc\u51fb `_main` \u6253\u5f00 IDA \u89c6\u56fe\u7a97\u53e3\uff0c\u5728\u8fd9\u4e2a\u7a97\u53e3\u91cc IDA \u4f1a\u5e2e\u4f60\u753b\u51fa\u7a0b\u5e8f\u7684\u6d41\u7a0b\u56fe\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/59617.png)\n\n\u53d1\u73b0\u5b83\u9996\u5148\u8c03\u7528(`call`)\u4e86\u4e00\u4e2a\u6ca1\u6709\u4efb\u4f55\u5375\u7528\u7684 `__main` \u51fd\u6570\uff0c\u7136\u540e `scanf` \u8bfb\u5165\u4e86\u4e24\u4e2a `int` (\u6211\u4eec\u59d1\u4e14\u79f0\u5b83\u4eec\u4e3a $n$ \u548c $m$\uff0c$n$ \u4e3a\u8981\u6267\u884c\u7684\u5b50\u4efb\u52a1\u7c7b\u578b\uff0c$m$ \u4e3a\u6570\u636e\u7ec4\u6570)\u2026\u2026\u7136\u540e\u5faa\u73af\u8c03\u7528 `Do` \u51fd\u6570 $m$ \u6b21\uff0c\u6700\u540e `return`\u3002\u90a3\u6211\u4eec\u7ee7\u7eed\u8ffd\u8e2a `Do` \u51fd\u6570\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/59618.png)\n\n\u53d1\u73b0\u5b83\u6839\u636e $n$ \u4e3a $0 \\sim 10$ \u8c03\u7528\u547d\u540d\u7a7a\u95f4 `A` $\\sim$ `K` \u7684 `Do` \u51fd\u6570\uff0c\u4e8e\u662f\u6211\u4eec\u5c31\u8981\u5206\u522b\u5206\u6790\u6bcf\u4e2a `Do` \u51fd\u6570\u3002`A` \u547d\u540d\u7a7a\u95f4\u7684 `Do` \u51fd\u6570\u6839\u636e\u9898\u610f\u662f A+B Problem \u5c31\u4e0d\u7ba1\u4e86\u3002\u6211\u4eec\u4ece `namespace C` \u5f00\u59cb\u5206\u6790\u3002`B` \u653e\u5728\u6700\u540e\uff0c\u56e0\u4e3a\u6d1b\u8c37\u4e0d\u80fd\u4ea4\u592a\u957f\u7684\u4ee3\u7801\uff0c\u6240\u4ee5 `namespace B` \u5b9e\u9645\u4e0a\u662f\u6700\u96be\u5206\u6790\u7684(\u5176\u5b9e\u4e5f\u6ca1\u96be\u5230\u54ea\u91cc\u53bb)\u3002\n\n# Namespace C\n\n![](https://cdn.luogu.com.cn/upload/pic/59619.png)\n\n\u4e0d\u61c2\u6c47\u7f16\u770b\u4e0d\u61c2\uff1f\u6ca1\u5173\u7cfb\uff0c~~\u6211\u4e5f\u770b\u4e0d\u61c2~~\u6d41\u7a0b\u56fe\u80fd\u770b\u61c2\u5c31\u884c\uff0c\u8d6b\u7136\u5165\u76ee\u7684\u662f\u6700\u5de6\u9762\u7684\u7ed3\u6784\u4e2d\u7684\u4e00\u4e2a\u5b57\u7b26\u4e32 `invalid input!` \u6211\u4eec\u8ffd\u6839\u6eaf\u6e90\uff0c\u53d1\u73b0\u5e26\u9886\u6211\u4eec\u8fdb\u5165\u8fd9\u5e72\u6270\u6211\u4eec\u5207\u9898\u7684\u6bd2\u7624\u6076\u9b54\u7684\u4e00\u53e5\u8bdd\u662f\u6700\u4e0a\u9762\u7684\u6846\u6846\u91cc\u7684\u6700\u540e\u4e00\u53e5\u8bdd\uff1a\n\n```\njz      short loc_4014C3\n```\n\n\u89e3\u91ca\u4e00\u4e0b\u8fd9\u53e5\u8bdd\uff0c`jz` \u662f jump if zero \u7684\u7f29\u5199\uff0c\u5373\u96f6\u6807\u5fd7\u4e3a $1$ \u5c31\u8df3\u8f6c\u5230 `0x004014C3` \u8fd9\u4e2a\u4f4d\u7f6e\u7ee7\u7eed\u6267\u884c\uff0c\u66f4\u8be6\u7ec6\u4ecb\u7ecd\u7684\u9650\u4e8e\u7bc7\u5e45\u539f\u56e0\u4e0d\u5c55\u5f00\u4e86\uff0c\u60f3\u4e86\u89e3\u7684\u53ef\u4ee5\u81ea\u884c\u641c\u7d22\u3002`short` \u8868\u793a\u8fd9\u6b21\u8f6c\u79fb\u662f\u4e00\u6b21\u77ed\u8f6c\u79fb\uff0c\u5373\u8fd9\u6b21\u8df3\u8f6c\u7684\u4f4d\u7f6e\u7684\u5730\u5740\u8ddd\u79bb\u5f53\u524d\u4f4d\u7f6e\u7684\u5730\u5740\u5dee\u503c\u5728 $(-128,127)$ \u8303\u56f4\u4e4b\u5185\u3002\n\n\u6839\u636e\u6d41\u7a0b\u56fe\uff0c\u6211\u4eec\u8981\u7684\u662f\u8ba9\u4ed6\u8df3\u8f6c\uff0c\u8fd9\u6837\u6211\u4eec\u624d\u80fd\u6267\u884c\u53f3\u4e0b\u65b9\u7684\u4e3b\u8981\u90e8\u5206\u5f97\u51fa\u7ed3\u679c\uff0c\u800c\u4e0d\u662f\u8ba9\u7a0b\u5e8f\u4e0d\u8df3\u8f6c\u800c\u662f\u7ee7\u7eed\u6267\u884c\u5230 `invalid input!` \u5904\u3002\u6c47\u7f16\u8bed\u8a00\u7684\u65e0\u6761\u4ef6\u8df3\u8f6c\u8bed\u53e5\u662f `jmp`\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ea\u8981\u628a `jz` \u4fee\u6539\u6210 `jmp`\uff0c\u8fd9\u4e2a\u7a0b\u5e8f\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a\u5b8c\u6574\u7684\u7a0b\u5e8f\u3002\n\n\u5728 `jz` \u4e0a\u53f3\u952e->\u540c\u6b65\u5230->$16$ \u8fdb\u5236\u89c6\u56fe\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u53e5\u8bdd\u7684\u771f\u9762\u76ee\u662f\u8fd9\u6837\u7684\uff1a\n\n```\n004014A0  C0 74 20 8B 45 C4 85 C0  78 08 8B 45 C4 83 F8 14\n```\n\n\u7a0b\u5e8f\u4f7f\u7528 $16$ \u8fdb\u5236\u6765\u50a8\u5b58\u6c47\u7f16\u547d\u4ee4\uff0c\u6211\u4eec\u7684 `jz` \u6307\u4ee4\u5bf9\u5e94\u7684\u673a\u5668\u7801\u4e3a `74`\uff0c\u4e5f\u5c31\u662f\u8bf4\u963b\u6321\u6211\u4eec\u7684\u6307\u4ee4\u7684\u771f\u6b63\u9762\u76ee\u5176\u5b9e\u5c31\u662f `74 20`\uff01\n\n`jmp` \u6307\u4ee4\u7684\u673a\u5668\u7801\u4e3a `eb`\uff0c\u6211\u4eec\u53ea\u8981\u628a `74` \u6539\u6210 `eb` \u5c31 OK \u4e86\u3002\u7528\u652f\u6301 $16$ \u8fdb\u5236\u7684\u7f16\u8f91\u5668\u6253\u5f00 `lost.exe`\uff08\u6211\u7528\u7684\u662f sublime\uff09\uff0cCtrl+F \u67e5\u627e\u8fd9\u4e00\u884c\u3002\u6ce8\u610f\uff0c\u5728 sublime \u91cc\uff0c\u8981 $4$ \u4e2a\u5b57\u7b26\u4e00\u7ec4\uff0c\u800c\u4e14\u5927\u5199\u5b57\u6bcd\u8981\u53d8\u6210\u5c0f\u5199\u5b57\u6bcd\uff0c\u4e5f\u5c31\u662f\u8bf4\u4f60\u9700\u8981\u5728\u67e5\u627e\u6846\u5185\u8f93\u5165\u7684\u5e94\u8be5\u662f\uff1a\n\n```\nc074 208b 45c4 85c0 7808 8b45 c483 f814\n```\n\n![](https://cdn.luogu.com.cn/upload/pic/59627.png)\n\n\u627e\u5230\u540e\uff0c\u628a `74` \u6539\u6210 `eb`\uff0c\u4fdd\u5b58\uff0c\u518d\u6267\u884c\uff0c\u4f60\u4f1a\u53d1\u73b0\u2026\u2026\u6b63\u89e3\u51fa\u6765\u4e86\u2026\u2026\n\n\u5982\u6cd5\u70ae\u5236 D~K:\n\n# Namespace D\n\n![](https://cdn.luogu.com.cn/upload/pic/59621.png)\n\n\u8fd9\u4e0d\u8ddf\u521a\u624d\u7684\u4e00\u6837\u561b\uff0c\u540c\u6837\u7684\u64cd\u4f5c\u628a\u7b2c\u4e00\u4e2a `jz` \u6539\u6210 `jmp`\uff0c\u4e5f\u5c31\u662f `74` \u6539\u6210 `eb`\u3002\n\n# Namespace E\n\n![](https://cdn.luogu.com.cn/upload/pic/59622.png)\n\n\u8fd9\u4e2a\u6709\u70b9\u590d\u6742\uff0c\u653e\u5927\u4e86\u80fd\u770b\u6e05\u4ee3\u7801\u4f46\u662f\u770b\u4e0d\u5230\u6574\u4f53\uff0c\u7f29\u5c0f\u4e86\u80fd\u770b\u5230\u6574\u4f53\u4f46\u662f\u770b\u4e0d\u5230\u4ee3\u7801\u5c31\u5f88\u5c34\u5c2c\u2026\u2026\u7b80\u5355\u8bf4\u4e0b\uff0c\u5de6\u4e0b\u89d2\u7bad\u5934\u6307\u5411\u7684\u6846\u6846\u91cc\u5199\u7740 `invalid input!` \uff0c\u987a\u85e4\u6478\u74dc\u5f80\u4e0a\u627e\u5bfb\u4e07\u6076\u4e4b\u6e90\uff0c\u53d1\u73b0\u6e90\u5934\u662f\u4e0a\u65b9\u7bad\u5934\u6240\u6307\u7684\u6846\uff0c\u6846\u7684\u6700\u540e\u4e00\u53e5\u8bdd\u8fd8\u662f `jz short` \u4ec0\u4e48\u4ec0\u4e48\uff0c\u4e8e\u662f\u540c\u6837\u64cd\u4f5c\uff0c`74` \u6539 `eb`\u3002\n\n# Namespace F\n\n![](https://cdn.luogu.com.cn/upload/pic/59624.png)\n\n\u8fd9\u56de\u4e0d\u592a\u4e00\u6837\uff0c`Do` \u51fd\u6570\u91cc\u8c03\u7528\u4e86\u4e24\u4e2a\u51fd\u6570\u3002\u5148\u8c03\u7528\u7684\u662f `GetData` \u51fd\u6570\uff0c\u8bfb\u5165\u6570\u636e\u7528\u7684\uff0c\u80af\u5b9a\u8ddf\u6211\u4eec\u7684\u76ee\u7684\u65e0\u5173\uff0c\u4e0d\u53bb\u7ba1\u5b83\u3002\u4e8e\u662f\u6211\u4eec\u7ee7\u7eed\u5206\u6790 `DoIt` \u51fd\u6570\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/59625.png)\n\n\u627e\u5230\u4e86\u5de6\u4e0b\u65b9\u6846\u6846\u91cc\u7684 `invalid input!`\uff0c\u91cd\u590d\u4ee5\u4e0a\u6b65\u9aa4\u4e0d\u518d\u8d58\u8ff0\uff0c\u4e07\u6076\u4e4b\u6e90\u4f4d\u7f6e\u4e3a\u7b2c\u4e8c\u884c\u53f3\u4fa7\u7684\u6846\u6846\u91cc\u7684 `jz`\u3002\n\n# Namespace G\n\n`G::Do()` \u51fd\u6570\u8ddf `F::Do()` \u51fd\u6570\u51e0\u4e4e\u4e00\u6837\uff0c\u5148\u8c03\u7528\u4e00\u4e2a `GetData` \u518d\u8c03\u7528\u4e00\u4e2a `DoIt`\uff0c\u5c31\u4e0d\u653e\u56fe\u4e86\uff0c\u76f4\u63a5\u5206\u6790 `DoIt`\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/59626.png)\n\n# Namespace H\n\n![](https://cdn.luogu.com.cn/upload/pic/59628.png)\n\n# Namespace I\n\n\u8fd8\u662f\u6309\u7167\u4ee5\u4e0a\u505a\u6cd5\u53bb\u505a\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/59629.png)\n\n\u4e0d\u8fc7\u8fd9\u6837\u505a\u7b54\u6848\u4f1a\u6709\u4e24\u4e2a\u4e0d\u5bf9\u3002\n\n\u6b63\u786e\u7b54\u6848\uff1a\n\n```\n51 108 153 4929 124260 498810 12491602 49971923 2739460784 499996516402\n```\n\n\u5982\u6b64\u505a\u7684\u7b54\u6848\uff1a\n\n```\n51 108 152 4929 124260 498810 12491601 49971923 2739460784 499996516402\n```\n\n\u7b2c $3$ \u4e2a\u548c\u7b2c $7$ \u4e2a\u871c\u6c41\u5c11 $1$\uff0c\u8eab\u4e3a\u849f\u84bb\u7684\u6211\u641e\u4e0d\u61c2\u4e3a\u4ec0\u4e48\uff0c\u53ea\u597d\u7279\u522b\u5bb3\u6015\u5730\u770b\u4e86\u4e00\u773c\u9898\u89e3\u5927\u4f6c\u7684\u7b54\u6848\uff0c\u5206\u6570 90->100\u2026\u2026\n\n\u5e94\u8be5\u662f\u51fa\u9898\u5927\u4f6c\u7684\u66b4\u529b\u5199\u70b8\u4e86\uff1f\n\n# Namespace J\n\n![](https://cdn.luogu.com.cn/upload/pic/59630.png)\n\n# Namespace K\n\n![](https://cdn.luogu.com.cn/upload/pic/59631.png)\n\n\u5199\u7684\u5f88\u6e05\u695a\uff0c`puts(\"invalid input!\");`\n\n\u4e0d\u7ba1\u4f60\u8f93\u5165\u5565\u90fd\u662f\u65e0\u6548\u3002\n\n# Namespace B\n\n![](https://cdn.luogu.com.cn/upload/pic/59632.png)\n\n\u6309\u7167\u4e4b\u524d\u7684\u65b9\u6cd5\u505a\u8fd8\u662f\u53ef\u4ee5\u5f97\u5230\u6b63\u786e\u7b54\u6848\u7684\uff0c\u4f46\u662f\uff0c\u8f93\u51fa\u7684\u4e1c\u897f\u975e\u5e38\u4e4b\u591a\uff0c\u4ee5\u81f3\u4e8e\u4e0d\u7ba1\u662f\u63d0\u4ea4\u7b54\u6848\u8fd8\u662f\u63d0\u4ea4 zip \u8fd8\u662f\u63d0\u4ea4\u6253\u8868\u4ee3\u7801\u6d1b\u8c37\u90fd\u4f1a\u63d0\u793a\u4ee3\u7801\u592a\u957f\u3002\u6211\u4eec\u53ea\u597d\u6df1\u7a76\u5b83\u7684\u7b97\u6cd5\u4e86\u3002\n\n![](https://cdn.luogu.com.cn/upload/pic/59633.png)\n\n\u8fd9\u662f `jz` \u5f80\u53f3\u8df3\u4e0b\u65b9\u7684\u7b97\u6cd5\u4e3b\u8981\u90e8\u5206\uff0c\u53ef\u4ee5\u770b\u5230\u662f\u4e00\u4e2a\u5faa\u73af\u7ed3\u6784\u3002\u6211\u4eec\u7b80\u5355\u770b\u4e0b\u5faa\u73af\u4f53\u5185\u7684\u5185\u5bb9\uff0c\u5927\u81f4\u610f\u601d\u5c31\u662f\u7528 `dr` \u6570\u7ec4\u5185\u7684\u6240\u6709\u5143\u7d20\u51cf\u53bb\u5b57\u7b26 `a` \uff08`61h`\uff0c\u4e00\u4e2a\u6570\u52a0 `h`\uff08hex\uff09\u4ee3\u8868\u8fd9\u4e2a\u6570\u662f $16$ \u8fdb\u5236\uff0c\u800c ASCII \u7801 `0x61` \u5c31\u662f `a`\uff09\uff0c\u7136\u540e `putchar` \u8f93\u51fa\u5bf9\u5e94\u7684 `point` \u6570\u7ec4\u4e0b\u6807\u5185\u7684\u503c\u3002\u6211\u4eec\u53cc\u51fb `B::dr` \u67e5\u770b\u8fd9\u662f\u4e2a\u4ec0\u4e48\u73a9\u610f\uff0c\u53d1\u73b0\uff1a\n\n```\n.bss:0040A040 __ZN1B2drE      db    ? ;               ; DATA XREF: B::Do(void)+58\u2191o\n.bss:0040A041 ; char byte_40A041[104999]\n```\n\n\u770b\u5230\u4e86 `char`\uff0c\u770b\u5230\u4e86 `[104999]`\u3002\u6240\u4ee5 `dr` \u6570\u7ec4\u5176\u5b9e\u5c31\u662f\uff1a\n\n```cpp\nchar dr[105000];\n```\n\n\u8fd9\u4e2a\u6570\u7ec4\u5f00\u8fd9\u4e48\u5927\uff0c\u5e94\u8be5\u662f\u88c5\u8f93\u5165\u7684\u5b57\u7b26\u4e32\u7684\uff0c\u800c\u4e14\u6700\u4e0a\u9762\u7684\u6846\u6846\u91cc\u4e00\u5f00\u59cb\u5c31\u6267\u884c\u4e86`scanf(\"%s\",dr);`\n\n\u7136\u540e\u6211\u4eec\u518d\u770b\u4e00\u4e0b `point` \u6570\u7ec4\uff1a\n\n```\n.rdata:004070F0 __ZN1BL5pointE  db 79h                  ; DATA XREF: B::Do(void)+65\u2191r\n.rdata:004070F1 aFrbkgimujvphat db 'frbkgimujvphatdsnelozcxwq',0\n```\n\n\u8fd9\u4e2a\u6570\u7ec4\u7684\u9996\u4f4d\u662f\u4e00\u4e2a ASCII \u7801\u4e3a `0x79` \u7684\u5b57\u7b26\u4e5f\u5c31\u662f `y`\uff0c`y` \u540e\u9762\u662f\u7b2c\u4e8c\u884c\u5f15\u53f7\u62ec\u8d77\u6765\u7684\u90a3\u4e00\u4e32\uff0c\u4e5f\u5c31\u662f\uff1a\n\n```cpp\nchar point[] = {\"yfrbkgimujvphatdsnelozcxwq\"};\n```\n\n\u5b57\u7b26\u6620\u5c04\uff0c\u5199\u4e0b\u4ee3\u7801\u5c31\u597d\u4e86\uff1a\n\n```cpp\nint m; \nscanf(\"%d\",&m);\nwhile(m--)\n{\n  scanf(\"%s\",dr);\n  for(int i=0;dr[i]!='\\0';i++)\n  \tputchar(point[dr[i]-'a']);\n}\n```\n\n# \u5c3e\u58f0 #\n\u81f3\u6b64\uff0c~~\u6211\u4eec\u53ea\u7528\u4e86\u534a\u5c0f\u65f6\u65f6\u95f4\u5c31\u5207\u4e86\u4e00\u9053\u9ed1\u9898~~\uff0c\u4ee3\u7801\u5c31\u4e0d\u653e\u4e86\uff0c\u53c2\u8003\u5176\u4ed6\u5927\u4f6c\u3002\u7ecf\u8fc7\u4fee\u6539\u7684\u80fd\u51fa\u6b63\u786e\u7b54\u6848\uff08\u9664\u4e86 #8\uff09\u7684\u7a0b\u5e8f\u4e5f\u5728\u6587\u7ae0\u5f00\u5934\u7684\u7f51\u76d8\u94fe\u63a5\u91cc `newlost.exe`\u3002\n\n\u81f3\u4e8e\u6211\u8fd9\u4e2a\u9898\u89e3\u5230\u5e95\u7b97\u4e0d\u7b97\u662f\u4e2a\u9898\u89e3\uff0c\u6211\u89c9\u5f97\u65e2\u7136\u201c\u65e0\u6570\u7528\u6237\u53ef\u4ee5\u4ece\u6d1b\u8c37\u63d0\u5347\u81ea\u5df1\u7684\u8ba1\u7b97\u673a\u79d1\u5b66\u80fd\u529b\u201d\uff0c\u90a3\u4e48\u6211\u8fd9\u7bc7\u6587\u7ae0\u5e94\u8be5\u4e5f\u80fd\u7b97\u662f\u8fd9\u4e2a\u8303\u56f4\u5185\u5427\u3002\u9898\u89e3\u9898\u89e3\uff0c\u89e3\u4e86\u9898\u7684\u65b9\u6cd5\u5c31\u662f\u9898\u89e3\u3002",
        "postTime": 1558975477,
        "uid": 109757,
        "name": "AgOH",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P5246 \u3010[\u96c6\u8bad\u961f\u4e92\u6d4b2016] \u6d88\u5931\u7684\u6e90\u4ee3\u7801\u3011"
    },
    {
        "content": "[\u5728\u535a\u5ba2\u67e5\u770b](https://www.cnblogs.com/chenxiaoran666/p/Luogu5246.html)\n\n**\u5927\u81f4\u9898\u610f\uff1a** \u5171$10$\u4e2a$Subtask$\uff0c\u6bcf\u4e2a$Subtask$\u7ed9\u4f60\u4e00\u4e2a\u4e0d\u5b8c\u7f8e\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\u548c\u4e00\u4e2a\u8f93\u5165\u6587\u4ef6\uff0c\u8ba9\u4f60\u6c42\u51fa\u8f93\u51fa\u6587\u4ef6\u3002\n\n### \u5b50\u4efb\u52a1$1$\n\n\u7b80\u5355\u5206\u6790\uff0c\u53ef\u4ee5\u53d1\u73b0\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u7684\u5b57\u7b26\uff0c\u4f60\u8981\u8f93\u51fa\u4e00\u4e2a\u4e0e\u5176\u5bf9\u5e94\u7684\u5b57\u7b26\u3002\n\n\u5219\u53ef\u901a\u8fc7\u6253\u8868\u5f97\u5230\u6bcf\u4e2a\u5b57\u7b26\u6240\u5bf9\u5e94\u7684\u5b57\u7b26\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define Tp template<typename Ty>\n#define Ts template<typename Ty,typename... Ar>\n#define Reg register\n#define RI Reg int\n#define Con const\n#define CI Con int&\n#define I inline\n#define W while\nusing namespace std;\nint v[27]={0,'y','f','r','b','k','g','i','m','u','j','v','p','h','a','t','d','s','n','e','l','o','z','c','x','w','q'};//\u6253\u5f97\u7684\u8868\nclass FastIO\n{\n    private:\n        #define FS 100000\n        #define tc() (A==B&&(B=(A=FI)+fread(FI,1,FS,stdin),A==B)?EOF:*A++)\n        #define tn(x) (x<<3)+(x<<1)\n        #define D isdigit(c=tc())\n        char c,*A,*B,FI[FS];\n    public:\n        I FastIO() {A=B=FI;}\n        Tp I void read(Ty& x) {x=0;W(!D);W(x=tn(x)+(c&15),D);}\n        Ts I void read(Ty& x,Ar&... y) {read(x),read(y...);}\n        I void reads(string& x) {x=\"\";W(isspace(c=tc()));W(x+=c,!isspace(c=tc())&&~c);}\n}F;\nint main()\n{\n\tfreopen(\"input1.txt\",\"r\",stdin),freopen(\"output1.txt\",\"w\",stdout);\n\tRI Tpos,Ttot,i,len;Reg char c;Reg string s;\n\tF.read(Tpos,Ttot);W(Ttot--)\n\t{\n\t\tfor(F.reads(s),len=s.length(),i=0;i^len;++i) putchar(v[s[i]&31]);//\u8f93\u51fa\u5bf9\u5e94\u5b57\u7b26\n\t\tputchar('\\n');//\u6362\u884c\n\t}return 0;\n}\n```\n\n### \u5b50\u4efb\u52a1$2$\n\n\u5148\u6253\u8868\u5f97\u5230$n=1\\sim5$\u7684\u8f93\u51fa\u7ed3\u679c\u5206\u522b\u4e3a$2030,8082,18166,32282,50430$\u3002\n\n\u8003\u8651\u5176\u6bcf\u6b21\u589e\u52a0\u7684\u503c\u5206\u522b\u4e3a$6052,10084,14116,18148$\uff0c\u800c\u589e\u52a0\u7684\u503c\u6240\u76f8\u5dee\u7684\u503c\u90fd\u4e3a$4032$\uff01\n\n\u8bbe\u7b2c$i$\u4e2a\u6570\u4e3a$f_i$\uff0c\u5219\u4e0d\u96be\u5f97\u5230\uff1a\n\n$$f_i=2030+6052(i-1)+4032\\frac{(i-2)(i-1)}2=2016i^2+4i+10$$\n\n\u8c8c\u4f3c\u505a\u5b8c\u4e86\uff1f\n\n\u7b49\u7b49\uff0c\u8fd9\u79cd\u5f0f\u5b50\u80af\u5b9a\u9700\u8981\u53d6\u6a21\uff01\n\n\u6211\u4eec\u7ee7\u7eed\u6253\u8868\uff0c\u53ef\u4ee5\u53d1\u73b0\u5728$n=10$\u65f6\uff0c$ans=201650$\uff0c\u4f46$n=11$\u65f6\uff0c$ans$\u5c31\u53d8\u6210\u4e86$10657$\u3002\n\n\u800c$f_{11}=243990$\uff0c\u4e0e$10657$\u521a\u597d\u76f8\u5dee$233333$\u3002\n\n\u6240\u4ee5\u6a21\u6570\u5fc5\u4e3a$233333$\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define Tp template<typename Ty>\n#define Ts template<typename Ty,typename... Ar>\n#define Reg register\n#define RI Reg int\n#define Con const\n#define CI Con int&\n#define I inline\n#define W while\n#define X 233333\nusing namespace std;\nclass FastIO\n{\n    private:\n        #define FS 100000\n        #define tc() (A==B&&(B=(A=FI)+fread(FI,1,FS,stdin),A==B)?EOF:*A++)\n        #define pc(c) (C^FS?FO[C++]=c:(fwrite(FO,1,C,stdout),FO[(C=0)++]=c))\n        #define tn(x) (x<<3)+(x<<1)\n        #define D isdigit(c=tc())\n        int T,C;char c,*A,*B,FI[FS],FO[FS],S[FS];\n    public:\n        I FastIO() {A=B=FI;}\n        Tp I void read(Ty& x) {x=0;W(!D);W(x=tn(x)+(c&15),D);}\n        Ts I void read(Ty& x,Ar&... y) {read(x),read(y...);}\n        Tp I void write(Ty x) {W(S[++T]=x%10+48,x/=10);W(T) pc(S[T--]);}\n        Tp I void writeln(Con Ty& x) {write(x),pc('\\n');}\n        I void clear() {fwrite(FO,1,C,stdout),C=0;}\n}F;\nint main()\n{\n\tfreopen(\"input2.txt\",\"r\",stdin),freopen(\"output2.txt\",\"w\",stdout);\n\tRI Tpos,Ttot,x;F.read(Tpos,Ttot);W(Ttot--) F.read(x),F.writeln((1LL*2016*x%X*x%X+4LL*x+10)%X);//\u8ba1\u7b97\u5e76\u8f93\u51fa\u7b54\u6848\n\treturn F.clear(),0;\n}\n```\n\n### \u5b50\u4efb\u52a1$3$\n\n\u540c\u6837\u662f\u8003\u8651\u6253\u8868\uff0c\u53d1\u73b0\u8fd9\u6b21\u5f97\u5230\u7684\u5f0f\u5b50\u589e\u957f\u901f\u5ea6\u7279\u522b\u6162\u3002\n\n\u4e0e$hl666$\u795e\u4ed9\u4e00\u8d77\u60f3\u4e86\u534a\u5929\u6ca1\u60f3\u51fa\u6765\uff0c\u6700\u540e\u653e\u5230$OEIS$\u4e0a\uff0c\u53d1\u73b0\u662f\u8fd9\u6837\u4e00\u4e2a\u5f0f\u5b50\uff1a\n\n$$\\lfloor\\sqrt{\\frac i\\pi}\\rfloor$$\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define Tp template<typename Ty>\n#define Ts template<typename Ty,typename... Ar>\n#define Reg register\n#define RI Reg int\n#define Con const\n#define CI Con int&\n#define I inline\n#define W while\nusing namespace std;\nconst double Pi=acos(-1);\nclass FastIO\n{\n    private:\n        #define FS 100000\n        #define tc() (A==B&&(B=(A=FI)+fread(FI,1,FS,stdin),A==B)?EOF:*A++)\n        #define pc(c) (C^FS?FO[C++]=c:(fwrite(FO,1,C,stdout),FO[(C=0)++]=c))\n        #define tn(x) (x<<3)+(x<<1)\n        #define D isdigit(c=tc())\n        int T,C;char c,*A,*B,FI[FS],FO[FS],S[FS];\n    public:\n        I FastIO() {A=B=FI;}\n        Tp I void read(Ty& x) {x=0;W(!D);W(x=tn(x)+(c&15),D);}\n        Ts I void read(Ty& x,Ar&... y) {read(x),read(y...);}\n        Tp I void write(Ty x) {W(S[++T]=x%10+48,x/=10);W(T) pc(S[T--]);}\n        Tp I void writeln(Con Ty& x) {write(x),pc('\\n');}\n        I void clear() {fwrite(FO,1,C,stdout),C=0;}\n}F;\nint main()\n{\n\tfreopen(\"input3.txt\",\"r\",stdin),freopen(\"output3.txt\",\"w\",stdout);\n\tRI Tpos,Ttot,x;F.read(Tpos,Ttot);W(Ttot--) F.read(x),F.writeln((int)floor(sqrt(x/Pi)));//\u8ba1\u7b97\u5e76\u8f93\u51fa\u7b54\u6848\n\treturn F.clear(),0;\n}\n```\n\n### \u5b50\u4efb\u52a1$4$\n\n\u89c2\u5bdf\u6570\u636e\u5f62\u5f0f\uff0c\u6613\u5f97\uff1a\u8f93\u5165\u7b2c\u4e00\u884c\u4e24\u4e2a\u6570\u6570$n,m$\uff0c\u5206\u522b\u8868\u793a\u8282\u70b9\u4e2a\u6570\u548c\u8fb9\u6570\u3002\u5176\u540e$m$\u884c\uff0c\u6bcf\u884c\u4e24\u4e2a\u6570\u8868\u793a\u4e00\u6761\u8fb9\u3002\n\n\u89c2\u5bdf\u6837\u4f8b\uff0c\u53ef\u53d1\u73b0\u7b54\u6848\u5c31\u662f**\u5404\u8fde\u901a\u5757\u5927\u5c0f\u7684\u5e73\u65b9\u548c**\u3002\n\n\u53ef\u4ee5\u7528**\u5e76\u67e5\u96c6**\u7ef4\u62a4\u8fde\u901a\u6027\uff0c\u6700\u540e\u518d\u7edf\u8ba1\u7b54\u6848\u5373\u53ef\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define Tp template<typename Ty>\n#define Ts template<typename Ty,typename... Ar>\n#define Reg register\n#define RI Reg int\n#define Con const\n#define CI Con int&\n#define I inline\n#define W while\n#define N 100000\n#define LL long long\nusing namespace std;\nint n,m;\nclass FastIO\n{\n    private:\n        #define FS 100000\n        #define tc() (A==B&&(B=(A=FI)+fread(FI,1,FS,stdin),A==B)?EOF:*A++)\n        #define pc(c) (C^FS?FO[C++]=c:(fwrite(FO,1,C,stdout),FO[(C=0)++]=c))\n        #define tn(x) (x<<3)+(x<<1)\n        #define D isdigit(c=tc())\n        int T,C;char c,*A,*B,FI[FS],FO[FS],S[FS];\n    public:\n        I FastIO() {A=B=FI;}\n        Tp I void read(Ty& x) {x=0;W(!D);W(x=tn(x)+(c&15),D);}\n        Ts I void read(Ty& x,Ar&... y) {read(x),read(y...);}\n        Tp I void write(Ty x) {W(S[++T]=x%10+48,x/=10);W(T) pc(S[T--]);}\n        Tp I void writeln(Con Ty& x) {write(x),pc('\\n');}\n        I void clear() {fwrite(FO,1,C,stdout),C=0;}\n}F;\nclass UnionFindSet//\u5e76\u67e5\u96c6\n{\n\tprivate:\n\t\tstatic const int SZ=N;int fa[SZ+5],cnt[SZ+5];\n\t\tI int getfa(CI x) {return fa[x]^x?fa[x]=getfa(fa[x]):x;}//\u627e\u7956\u5148\n\tpublic:\n\t\tI void Init(CI n) {for(RI i=1;i<=n;++i) cnt[fa[i]=i]=0;}//\u521d\u59cb\u5316\n\t\tI void Union(RI x,RI y)\t{(x=getfa(x))^(y=getfa(y))&&(fa[y]=x);}//\u5408\u5e76\u4e24\u4e2a\u8282\u70b9\n\t\tI LL Query(CI n)//\u8be2\u95ee\n\t\t{\n\t\t\tRI i;Reg LL ans=0;for(i=1;i<=n;++i) ++cnt[getfa(i)];//\u7edf\u8ba1\n\t\t\tfor(i=1;i<=n;++i) ans+=1LL*cnt[i]*cnt[i];return ans;//\u8ba1\u7b97\u7b54\u6848\n\t\t}\n}U;\nint main()\n{\n\tfreopen(\"input4.txt\",\"r\",stdin),freopen(\"output4.txt\",\"w\",stdout);\n\tRI Tpos,Ttot,i,x,y;F.read(Tpos,Ttot);W(Ttot--) \n\t{\n\t\tfor(F.read(n,m),U.Init(n),i=1;i<=m;++i) F.read(x,y),U.Union(x,y);//\u5bf9\u6bcf\u6761\u8fb9\u4f9d\u6b21\u5408\u5e76\u8fde\u901a\u5757\n\t\tF.writeln(U.Query(n));//\u8f93\u51fa\u7b54\u6848\n\t}return F.clear(),0;\n}\n```\n\n### \u5b50\u4efb\u52a1$5$\n\n\u89c2\u5bdf\u6570\u636e\u5f62\u5f0f\uff0c\u6613\u5f97\uff1a\u8f93\u5165\u7b2c\u4e00\u884c\u4e24\u4e2a\u6570$n,Q$\uff0c\u5206\u522b\u8868\u793a\u8282\u70b9\u4e2a\u6570\u548c\u8be2\u95ee\u4e2a\u6570\u3002\u5176\u540e$n-1$\u884c\uff0c\u6bcf\u884c\u4e24\u4e2a\u6570\u8868\u793a\u4e00\u6761\u8fb9\uff08\u53ef\u89c1\u8fd9\u662f\u4e00\u68f5\u6811\uff09\u3002\u518d\u7136\u540e\u662f$Q$\u884c\uff0c\u6bcf\u884c\u4e24\u4e2a\u6570\uff0c\u8868\u793a\u4e00\u4e2a\u8be2\u95ee\u3002\n\n\u624b\u9020\u5c0f\u6570\u636e\u5bb9\u6613\u5f97\u51fa\uff0c\u6bcf\u6b21\u8be2\u95ee\u7684\u662f\u6811\u4e0a\u4e24\u70b9\u95f4\u7684\u8ddd\u79bb\uff0c\u6700\u540e\u8981\u8f93\u51fa\u7b54\u6848\u7684\u5f02\u6216\u548c\u3002\n\n\u8fd9\u7528**\u6811\u4e0a\u500d\u589e**\u5373\u53ef\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define Tp template<typename Ty>\n#define Ts template<typename Ty,typename... Ar>\n#define Reg register\n#define RI Reg int\n#define Con const\n#define CI Con int&\n#define I inline\n#define W while\n#define N 100000\n#define LogN 17\n#define LL long long\n#define swap(x,y) (x^=y^=x^=y)\n#define add(x,y,v) (e[++ee].nxt=lnk[x],e[lnk[x]=ee].to=y,e[ee].val=v)\nusing namespace std;\nint n,m,ee,lnk[N+5];struct edge {int to,nxt,val;}e[N<<1];\nclass FastIO\n{\n    private:\n        #define FS 100000\n        #define tc() (A==B&&(B=(A=FI)+fread(FI,1,FS,stdin),A==B)?EOF:*A++)\n        #define pc(c) (C^FS?FO[C++]=c:(fwrite(FO,1,C,stdout),FO[(C=0)++]=c))\n        #define tn(x) (x<<3)+(x<<1)\n        #define D isdigit(c=tc())\n        int T,C;char c,*A,*B,FI[FS],FO[FS],S[FS];\n    public:\n        I FastIO() {A=B=FI;}\n        Tp I void read(Ty& x) {x=0;W(!D);W(x=tn(x)+(c&15),D);}\n        Ts I void read(Ty& x,Ar&... y) {read(x),read(y...);}\n        Tp I void write(Ty x) {W(S[++T]=x%10+48,x/=10);W(T) pc(S[T--]);}\n        Tp I void writeln(Con Ty& x) {write(x),pc('\\n');}\n        I void clear() {fwrite(FO,1,C,stdout),C=0;}\n        #undef D\n}F;\nclass TreeSolver//\u6811\u4e0a\u500d\u589e\n{\n\tprivate:\n\t\tint D[N+5],F[N+5][LogN+5];LL Dis[N+5][LogN+5];\n\tpublic:\n\t\tI void dfs(CI x,CI lst)//DFS\u9884\u5904\u7406\n\t\t{\n\t\t\tRI i;for(i=1;i<=LogN;++i) F[x][i]=F[F[x][i-1]][i-1],Dis[x][i]=Dis[x][i-1]+Dis[F[x][i-1]][i-1];//\u6c42\u51faF\u6570\u7ec4\u548cDis\u6570\u7ec4\n\t\t\tfor(i=lnk[x];i;i=e[i].nxt) e[i].to^lst&&(D[e[i].to]=D[F[e[i].to][0]=x]+1,Dis[e[i].to][0]=e[i].val,dfs(e[i].to,x),0);//\u904d\u5386\u5b50\u6811\n\t\t}\n\t\tI LL GetDis(RI x,RI y)//\u6c42\u51fa\u6811\u4e0a\u4e24\u70b9\u95f4\u7684\u8ddd\u79bb\n\t\t{\n\t\t\tRI i;Reg LL t=0;for(D[x]<D[y]&&swap(x,y),i=0;D[x]^D[y];++i) (D[x]^D[y])&(1<<i)&&(t+=Dis[x][i],x=F[x][i]);\n\t\t\tif(!(x^y)) return t;for(i=LogN;~i;--i) F[x][i]^F[y][i]&&(t+=Dis[x][i]+Dis[y][i],x=F[x][i],y=F[y][i]);\n\t\t\treturn t+Dis[x][0]+Dis[y][0];\n\t\t}\n}T;\nint main()\n{\n\tfreopen(\"input5.txt\",\"r\",stdin),freopen(\"output5.txt\",\"w\",stdout);\n\tRI Tpos,Ttot,i,x,y,v;Reg LL ans;F.read(Tpos,Ttot);W(Ttot--)\n\t{\n\t\tfor(F.read(n,m),ee=0,i=1;i<=n;++i) lnk[i]=0;for(i=1;i^n;++i) F.read(x,y,v),add(x,y,v),add(y,x,v);//\u6e05\u7a7a\u6570\u7ec4+\u8bfb\u5165+\u8fde\u8fb9\n\t\tfor(T.dfs(1,0),ans=0,i=1;i<=m;++i) F.read(x,y),ans^=T.GetDis(x,y);F.writeln(ans);//\u6c42\u89e3\u7b54\u6848\n\t}return F.clear(),0;\n}\n```\n\n### \u5b50\u4efb\u52a1$6$\n\n\u4e0e\u5b50\u4efb\u52a1$5$\u5dee\u4e0d\u591a\uff0c\u53ea\u4e0d\u8fc7\u8be2\u95ee\u7684\u53d8\u6210\u4e86\u6811\u4e0a\u4e24\u70b9\u95f4\u7684\u6700\u5c0f\u8fb9\u6743\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8be2\u95ee\u540c\u4e00\u4e2a\u70b9\u95f4\u7684\u6700\u5c0f\u8fb9\u6743\uff0c\u6765\u6c42\u51fa\u5176$ans$\u521d\u59cb\u5316\u4e3a$1987654321$\u3002\n\n\u7136\u540e\u540c\u6837\u7528**\u6811\u4e0a\u500d\u589e**\u5373\u53ef\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define Tp template<typename Ty>\n#define Ts template<typename Ty,typename... Ar>\n#define Reg register\n#define RI Reg int\n#define Con const\n#define CI Con int&\n#define I inline\n#define W while\n#define N 100000\n#define LogN 17\n#define min(x,y) ((x)<(y)?(x):(y))\n#define Gmin(x,y) ((x)>(y)&&(x=(y)))\n#define swap(x,y) (x^=y^=x^=y)\n#define add(x,y,v) (e[++ee].nxt=lnk[x],e[lnk[x]=ee].to=y,e[ee].val=v)\nusing namespace std;\nint n,m,ee,lnk[N+5];struct edge {int to,nxt,val;}e[N<<1];\nclass FastIO\n{\n    private:\n        #define FS 100000\n        #define tc() (A==B&&(B=(A=FI)+fread(FI,1,FS,stdin),A==B)?EOF:*A++)\n        #define pc(c) (C^FS?FO[C++]=c:(fwrite(FO,1,C,stdout),FO[(C=0)++]=c))\n        #define tn(x) (x<<3)+(x<<1)\n        #define D isdigit(c=tc())\n        int T,C;char c,*A,*B,FI[FS],FO[FS],S[FS];\n    public:\n        I FastIO() {A=B=FI;}\n        Tp I void read(Ty& x) {x=0;W(!D);W(x=tn(x)+(c&15),D);}\n        Ts I void read(Ty& x,Ar&... y) {read(x),read(y...);}\n        Tp I void write(Ty x) {W(S[++T]=x%10+48,x/=10);W(T) pc(S[T--]);}\n        Tp I void writeln(Con Ty& x) {write(x),pc('\\n');}\n        I void clear() {fwrite(FO,1,C,stdout),C=0;}\n        #undef D\n}F;\nclass TreeSolver//\u6811\u4e0a\u500d\u589e\n{\n\tprivate:\n\t\t#define P 1987654321//ans\u521d\u59cb\u503c\n\t\tint D[N+5],F[N+5][LogN+5],M[N+5][LogN+5];\n\tpublic:\n\t\tI void dfs(CI x,CI lst)//DFS\u9884\u5904\u7406\n\t\t{\n\t\t\tRI i;for(i=1;i<=LogN;++i) F[x][i]=F[F[x][i-1]][i-1],M[x][i]=min(M[x][i-1],M[F[x][i-1]][i-1]);//\u6c42\u51faF\u6570\u7ec4\u548cM\u6570\u7ec4\n\t\t\tfor(i=lnk[x];i;i=e[i].nxt) e[i].to^lst&&(D[e[i].to]=D[F[e[i].to][0]=x]+1,M[e[i].to][0]=e[i].val,dfs(e[i].to,x),0);//\u904d\u5386\u5b50\u6811\n\t\t}\n\t\tI int GetMin(RI x,RI y)//\u6c42\u51fa\u6811\u4e0a\u4e24\u70b9\u95f4\u7684\u6700\u5c0f\u8fb9\u6743\n\t\t{\n\t\t\tRI i,t=P;for(D[x]<D[y]&&swap(x,y),i=0;D[x]^D[y];++i) (D[x]^D[y])&(1<<i)&&(Gmin(t,M[x][i]),x=F[x][i]);\n\t\t\tif(!(x^y)) return t;for(i=LogN;~i;--i) F[x][i]^F[y][i]&&(Gmin(t,M[x][i]),Gmin(t,M[y][i]),x=F[x][i],y=F[y][i]);\n\t\t\treturn min(t,min(M[x][0],M[y][0]));\n\t\t}\n}T;\nint main()\n{\n\tfreopen(\"input6.txt\",\"r\",stdin),freopen(\"output6.txt\",\"w\",stdout);\n\tRI Tpos,Ttot,i,x,y,v,ans;F.read(Tpos,Ttot);W(Ttot--)\n\t{\n\t\tfor(F.read(n,m),ee=0,i=1;i<=n;++i) lnk[i]=0;for(i=1;i^n;++i) F.read(x,y,v),add(x,y,v),add(y,x,v);//\u6e05\u7a7a\u6570\u7ec4+\u8bfb\u5165+\u8fde\u8fb9\n\t\tfor(T.dfs(1,0),ans=0,i=1;i<=m;++i) F.read(x,y),ans^=T.GetMin(x,y);F.writeln(ans);//\u6c42\u89e3\u7b54\u6848\n\t}return F.clear(),0;\n}\n```\n\n### \u5b50\u4efb\u52a1$7$\n\n\u6570\u636e\u7ed9\u4f60\u7684\u662f\u4e24\u4e2a\u6570$n$\u548c$m$\u3002\n\n\u901a\u8fc7\u5927\u91cf\u6d4b\u8bd5\u548c\u731c\u6d4b\u53ef\u5f97\u6211\u4eec\u8981\u6c42\u7684\u5f0f\u5b50\u4e3a\uff1a\n\n$$\\sum_{i=1}^n\\sum_{j=1}^mgcd(i,j)$$\n\n\u89c2\u5bdf$input.txt$\uff0c\u53ef\u4ee5\u53d1\u73b0\u9664\u4e86\u4e00\u7ec4$100\\ 1000$\u7684\u6570\u636e\u5916\uff0c\u5176\u4f59\u7684\u6570\u636e\u90fd\u6ee1\u8db3$n=m$\u3002\n\n\u800c$100\\ 1000$\u7684\u6570\u636e\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u66b4\u529b\u6c42\u89e3\u3002\n\n\u5426\u5219\uff0c\u6211\u4eec\u5c06$n=m$\u4ee3\u5165\u5f97\u5230\uff1a\n\n$$\\sum_{i=1}^n\\sum_{j=1}^ngcd(i,j)$$\n\n\u8fd9\u5e94\u8be5\u662f\u6bd4\u8f83\u7ecf\u5178\u7684\u5f0f\u5b50\uff0c\u6211\u4eec\u679a\u4e3e$gcd$\u5f97\uff1a\n\n$$\\sum_{d=1}^n\\sum_{i=1}^{\\lfloor\\frac nd\\rfloor}\\sum_{j=1}^{\\lfloor\\frac nd\\rfloor}d[gcd(i,j)==1]$$\n\n\u5c06$d$\u63d0\u524d\u5f97\uff1a\n\n$$\\sum_{d=1}^nd\\sum_{i=1}^{\\lfloor\\frac nd\\rfloor}\\sum_{j=1}^{\\lfloor\\frac nd\\rfloor}[gcd(i,j)==1]$$\n\n\u800c\u540e\u534a\u90e8\u5206\u53ef\u4ee5\u8fd0\u7528$\\phi$\u7684\u5b9a\u4e49\u8f6c\u5316\uff0c\u4e8e\u662f\u5f97\u5230\u8fd9\u6837\u4e00\u4e2a\u5f0f\u5b50\uff1a\n\n$$\\sum_{d=1}^nd(2\\sum_{i=1}^{\\lfloor\\frac nd\\rfloor}\\phi(i)-1)$$\n\n$n$\u4e0d\u5927\uff0c\u53ef\u4ee5\u76f4\u63a5**\u7ebf\u6027\u7b5b**\u7b5b\u51fa$\\phi$\u7684\u524d\u7f00\u548c\uff0c\u7136\u540e\u679a\u4e3e$d$\u6c42\u89e3\u5373\u53ef\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define Tp template<typename Ty>\n#define Ts template<typename Ty,typename... Ar>\n#define Reg register\n#define RI Reg int\n#define Con const\n#define CI Con int&\n#define I inline\n#define W while\n#define LL long long\nusing namespace std;\nint n,m;\nclass FastIO\n{\n    private:\n        #define FS 100000\n        #define tc() (A==B&&(B=(A=FI)+fread(FI,1,FS,stdin),A==B)?EOF:*A++)\n        #define pc(c) (C^FS?FO[C++]=c:(fwrite(FO,1,C,stdout),FO[(C=0)++]=c))\n        #define tn(x) (x<<3)+(x<<1)\n        #define D isdigit(c=tc())\n        int T,C;char c,*A,*B,FI[FS],FO[FS],S[FS];\n    public:\n        I FastIO() {A=B=FI;}\n        Tp I void read(Ty& x) {x=0;W(!D);W(x=tn(x)+(c&15),D);}\n        Ts I void read(Ty& x,Ar&... y) {read(x),read(y...);}\n        Tp I void write(Ty x) {W(S[++T]=x%10+48,x/=10);W(T) pc(S[T--]);}\n        Tp I void writeln(Con Ty& x) {write(x),pc('\\n');}\n        I void clear() {fwrite(FO,1,C,stdout),C=0;}\n}F;\nclass BruteForceSolver//\u66b4\u529b\u6c42\u89e3n!=m\u7684\u60c5\u51b5\n{\n\tprivate:\n\t\tI int gcd(CI x,CI y) {return y?gcd(y,x%y):x;}//\u6c42\u89e3gcd\n\tpublic:\n\t\tI void Solve()\n\t\t{\n\t\t\tRI i,j;Reg LL ans=0;\n\t\t\tfor(i=1;i<=n;++i) for(j=1;j<=m;++j) ans+=gcd(i,j);//\u5927\u66b4\u529b\u7edf\u8ba1\u7b54\u6848\n\t\t\tF.writeln(ans);//\u8f93\u51fa\u7b54\u6848\n\t\t}\n}B;\nclass MathSolver//\u7528\u6570\u5b66\u65b9\u6cd5\u6c42\u89e3n=m\u7684\u60c5\u51b5\n{\n\tprivate:\n\t\tclass LineSiever//\u7ebf\u6027\u7b5b\u7b5b\u51fa\u03c6\u7684\u524d\u7f00\u548c\n\t\t{\n\t\t\tprivate:\n\t\t\t\tstatic const int SZ=1000000;int Pcnt,P[SZ+5],phi[SZ+5];\n\t\t\tpublic:\n\t\t\t\tLL Sphi[SZ+5];\n\t\t\t\tI LineSiever()\n\t\t\t\t{\n\t\t\t\t\tRI i,j;for(phi[1]=1,i=2;i<=SZ;++i) for(!P[i]&&(phi[P[++Pcnt]=i]=i-1),j=1;1LL*i*P[j]<=SZ;++j)\n\t\t\t\t\t\tif(P[i*P[j]]=1,i%P[j]) phi[i*P[j]]=phi[i]*(P[j]-1);else {phi[i*P[j]]=phi[i]*P[j];break;}\n\t\t\t\t\tfor(i=1;i<=SZ;++i) Sphi[i]=Sphi[i-1]+phi[i];//\u7edf\u8ba1\u524d\u7f00\u548c\n\t\t\t\t}\n\t\t}S;\n\tpublic:\n\t\tI void Solve()\n\t\t{\n\t\t\tRI i;Reg LL ans=0;\n\t\t\tfor(i=1;i<=n;++i) ans+=1LL*i*(2*S.Sphi[n/i]-1);//\u7edf\u8ba1\u7b54\u6848\n\t\t\tF.writeln(ans);//\u8f93\u51fa\u7b54\u6848\n\t\t}\n}M;\nint main()\n{\n\tfreopen(\"input7.txt\",\"r\",stdin),freopen(\"output7.txt\",\"w\",stdout);\n\tRI Tpos,Ttot;F.read(Tpos,Ttot);W(Ttot--) F.read(n,m),n^m?B.Solve():M.Solve();//\u5206\u60c5\u51b5\u9009\u62e9\u89e3\u51b3\u65b9\u6848\n\treturn F.clear(),0;\n}\n```\n\n### \u5b50\u4efb\u52a1$8$\n\n\u624b\u9020\u51e0\u7ec4\u5c0f\u6570\u636e\uff0c\u53ef\u53d1\u73b0\u8fd9\u9898\u6c42\u7684\u662f\u7ed9\u5b9a\u5e8f\u5217\u672c\u8d28\u4e0d\u540c\u7684\u5b50\u4e32\u4e2a\u6570\u3002\n\n**\u540e\u7f00\u6570\u7ec4**\u88f8\u9898\uff0c\u7b54\u6848\u5c31\u662f\uff1a\n\n$$\\frac{n(n+1)}2-\\sum_{i=1}^nHeight_i$$\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define Tp template<typename Ty>\n#define Ts template<typename Ty,typename... Ar>\n#define Reg register\n#define RI Reg int\n#define Con const\n#define CI Con int&\n#define I inline\n#define W while\n#define N 1000000\n#define LL long long\nusing namespace std;\nint n,a[N+5];\nclass FastIO\n{\n    private:\n        #define FS 100000\n        #define tc() (A==B&&(B=(A=FI)+fread(FI,1,FS,stdin),A==B)?EOF:*A++)\n        #define pc(c) (C^FS?FO[C++]=c:(fwrite(FO,1,C,stdout),FO[(C=0)++]=c))\n        #define tn(x) (x<<3)+(x<<1)\n        #define D isdigit(c=tc())\n        int T,C;char c,*A,*B,FI[FS],FO[FS],S[FS];\n    public:\n        I FastIO() {A=B=FI;}\n        Tp I void read(Ty& x) {x=0;W(!D);W(x=tn(x)+(c&15),D);}\n        Ts I void read(Ty& x,Ar&... y) {read(x),read(y...);}\n        Tp I void write(Ty x) {W(S[++T]=x%10+48,x/=10);W(T) pc(S[T--]);}\n        Tp I void writeln(Con Ty& x) {write(x),pc('\\n');}\n        I void clear() {fwrite(FO,1,C,stdout),C=0;}\n}F;\nclass SuffixArray//\u540e\u7f00\u6570\u7ec4\n{\n\tprivate:\n\t\tstatic const int SZ=N;int n,SA[SZ+5],H[SZ+5],R[SZ+5],P[SZ+5],T[SZ+5];\n\t\tI void Rsort(CI S)//\u57fa\u6570\u6392\u5e8f\n\t\t{\n\t\t\tRI i;for(i=0;i<=S;++i) T[i]=0;for(i=1;i<=n;++i) ++T[R[i]];\n\t\t\tfor(i=1;i<=S;++i) T[i]+=T[i-1];for(i=n;i;--i) SA[T[R[P[i]]]--]=P[i];\n\t\t}\n\t\tI void GetSA(int* s)//\u6c42\u51faSA\u6570\u7ec4\n\t\t{\n\t\t\tRI i,k,S=N,t=0;for(i=1;i<=n;++i) R[P[i]=i]=s[i];\n\t\t\tfor(Rsort(S),k=1;t^n;k<<=1)\n\t\t\t{\n\t\t\t\tfor(S=t,t=0,i=1;i<=k;++i) P[++t]=n-k+i;\t\n\t\t\t\tfor(i=1;i<=n;++i) SA[i]>k&&(P[++t]=SA[i]-k);\n\t\t\t\tfor(Rsort(S),i=1;i<=n;++i) P[i]=R[i];\n\t\t\t\tfor(R[SA[1]]=t=1,i=2;i<=n;++i) R[SA[i]]=(P[SA[i-1]]^P[SA[i]]||P[SA[i-1]+k]^P[SA[i]+k])?++t:t;\n\t\t\t}\n\t\t}\n\t\tI void GetHeight(int* s)//\u6c42\u51faHeight\u6570\u7ec4\n\t\t{\n\t\t\tRI i,j,k=0;for(i=1;i<=n;++i) R[SA[i]]=i;\n\t\t\tfor(i=1;i<=n;++i)\n\t\t\t{\n\t\t\t\tif(k&&--k,!(R[i]^1)) continue;j=SA[R[i]-1];\n\t\t\t\tW(i+k<=n&&j+k<=n&&!(s[i+k]^s[j+k])) ++k;H[R[i]]=k;\n\t\t\t}\n\t\t}\n\tpublic:\n\t\tI void Init(CI len,int* s) {n=len,GetSA(s),GetHeight(s);}//\u521d\u59cb\u5316\n\t\tI LL GetAns() {Reg LL t=1LL*n*(n+1)>>1;for(RI i=1;i<=n;++i) t-=H[i];return t;}//\u8ba1\u7b97\u7b54\u6848\n}S;\nint main()\n{\n\tfreopen(\"input8.txt\",\"r\",stdin),freopen(\"output8.txt\",\"w\",stdout);\n\tRI Tpos,Ttot,i;F.read(Tpos,Ttot);W(Ttot--) \n\t{\n\t\tfor(F.read(n),i=1;i<=n;++i) F.read(a[i]);//\u8bfb\u5165\n\t\tS.Init(n,a),F.writeln(S.GetAns());//\u6c42\u89e3\n\t}return F.clear(),0;\n}\n```\n\n### \u5b50\u4efb\u52a1$9$\n\n\u540c\u6837\u662f\u901a\u8fc7\u9020\u5c0f\u6570\u636e\uff0c\u53ef\u53d1\u73b0\u8fd9\u9898\u5c31\u662f\u6c42**\u5e73\u9762\u6700\u8fd1\u70b9\u5bf9**\u3002\n\n\u7528**\u8ba1\u7b97\u51e0\u4f55**\u505a\u5373\u53ef\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define Tp template<typename Ty>\n#define Ts template<typename Ty,typename... Ar>\n#define Reg register\n#define RI Reg int\n#define Con const\n#define CI Con int&\n#define I inline\n#define W while\n#define N 1000000\n#define DB double\n#define INF 1e9\n#define dis(A,B) sqrt((A.x-B.x)*(A.x-B.x)+(A.y-B.y)*(A.y-B.y))\n#define min(x,y) ((x)<(y)?(x):(y))\n#define Gmin(x,y) (x>(y)&&(x=(y)))\nusing namespace std;\nint n,s[N+5];\nstruct Point//\u5b58\u50a8\u70b9\n{\n\tDB x,y;\n\tI friend bool operator < (Con Point& x,Con Point& y) {return x.x==y.x?x.y<y.y:x.x<y.x;}//\u6309x\u5750\u6807\u6392\u5e8f\n}p[N+5];\nclass FastIO\n{\n    private:\n        #define FS 100000\n        #define tc() (A==B&&(B=(A=FI)+fread(FI,1,FS,stdin),A==B)?EOF:*A++)\n        #define tn(x) (x<<3)+(x<<1)\n        #define D isdigit(c=tc())\n        char c,*A,*B,FI[FS];\n    public:\n        I FastIO() {A=B=FI;}\n        Tp I void read(Ty& x) {x=0;W(!D);W(x=tn(x)+(c&15),D);}\n        Ts I void read(Ty& x,Ar&... y) {read(x),read(y...);}\n}F;\nI bool cmp(CI x,CI y) {return p[x].y<p[y].y;}//\u6309y\u5750\u6807\u6392\u5e8f\nI double Solve(CI l,CI r)//\u5206\u6cbb\n{\n\tif(!(l^r)) return INF;if(r-l==1) return dis(p[l],p[r]);RI i,j,t=0,mid=l+r>>1;//\u5224\u65ad\u8fb9\u754c\u60c5\u51b5\n\tReg DB d1=Solve(l,mid),d2=Solve(mid+1,r),d3,d=min(d1,d2);//\u5206\u6cbb\u4e24\u4e2a\u533a\u95f4\uff0c\u6c42\u7b54\u6848\n\tfor(i=l;i<=r;++i) fabs(p[mid].x-p[i].x)<=d&&(s[++t]=i);//\u5c06\u53ef\u80fd\u7b26\u5408\u6761\u4ef6\u7684\u70b9\u7684\u7f16\u53f7\u52a0\u5165\u6570\u7ec4\n\tfor(sort(s+1,s+t+1,cmp),i=1;i<=t;++i) for(j=i+1;j<=t&&p[s[j]].y-p[s[i]].y<=d;++j) d3=dis(p[s[i]],p[s[j]]),Gmin(d,d3);//\u6392\u5e8f\u540e\u7528\u53ef\u80fd\u7b26\u5408\u6761\u4ef6\u7684\u70b9\u5bf9\u66f4\u65b0\u7b54\u6848\n\treturn d;//\u8fd4\u56de\u7b54\u6848\n}\nint main()\n{\n\tfreopen(\"input9.txt\",\"r\",stdin),freopen(\"output9.txt\",\"w\",stdout);\n\tRI Tpos,Ttot,i,x,y;F.read(Tpos,Ttot);W(Ttot--) \n\t{\n\t\tfor(F.read(n),i=1;i<=n;++i) F.read(x,y),p[i].x=x,p[i].y=y;//\u8bfb\u5165\u6570\u636e\n\t\tsort(p+1,p+n+1),printf(\"%.3lf\\n\",Solve(1,n));//\u6392\u5e8f\uff0c\u7136\u540e\u5206\u6cbb\u8f93\u51fa\u7b54\u6848\n\t}return 0;\n}\n```\n\n### \u5b50\u4efb\u52a1$10$\n\n\u6700\u795e\u5947\u7684\u4e00\u4e2a\u5b50\u4efb\u52a1\u3002\n\n\u8fd9\u9898\u7684\u7a0b\u5e8f\u8fde\u7b2c\u4e00\u4e2a\u8f93\u5165\u90fd\u4f1a\u8f93\u51fa\u201c$invalid\\ input!$\u201d\n\n\u8fd9\u65f6\u6211\u4fbf\u5927\u80c6\u731c\u60f3\uff1a\u8fd9\u9898\u5c31\u662f\u8f93\u51fa$10$\u4e2a\u201c$invalid\\ input!$\u201d\n\n\u7ed3\u679c\u771f\u8fc7\u4e86\u3002\n\n### \u4ee3\u7801\n\n\u4ee5\u4e0a\u4fbf\u662f\u8fd9\u9053\u9898\u7684\u5168\u90e8\u89e3\u6cd5\u3002\n\n\u4f46\u53ef\u60dc\u6d1b\u8c37\u4e0a\u4ea4\u4e0d\u4e86\u8fd9\u4e48\u5927\u7684\u6587\u4ef6\uff0c\u7ed3\u679c\u53ea\u80fd\u5199\u6210\u4ee3\u7801\uff0c\u5c06\u7b2c\u4e00\u4e2a\u5b50\u4efb\u52a1\u76f4\u63a5\u641e\uff0c\u5176\u4f59\u5b50\u4efb\u52a1\u6253\u8868\u8f93\u51fa\u7b54\u6848\u3002\n\n$AC$\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define Tp template<typename Ty>\n#define Ts template<typename Ty,typename... Ar>\n#define Reg register\n#define RI Reg int\n#define Con const\n#define CI Con int&\n#define I inline\n#define W while\nusing namespace std;\nclass Subtask1Solver//\u5904\u7406\u7b2c\u4e00\u4e2a\u5b50\u4efb\u52a1\n{\n\tprivate:\n\t\tint v[27]={0,'y','f','r','b','k','g','i','m','u','j','v','p','h','a','t','d','s','n','e','l','o','z','c','x','w','q'};\n\tpublic:\n\t\tI void Solve()\n\t\t{\n\t\t\tRI Ttot,i,len;Reg char c;Reg string s;scanf(\"%d\",&Ttot);W(Ttot--)\n\t\t\t{\n\t\t\t\tfor(cin>>s,len=s.length(),i=0;i^len;++i) putchar(v[s[i]&31]);\n\t\t\t\tputchar('\\n');\n\t\t\t}\n\t\t}\n}S;\n//\u4ee5\u4e0b\u4e3a\u6253\u8868\u4ee3\u7801\nI void Print2() {puts(\"106491\\n189151\\n42510\\n93772\\n32326\\n6890\\n94677\\n168190\\n66840\\n93722\");}\nI void Print3() {puts(\"126\\n126\\n178\\n252\\n252\\n626\\n1982\\n6268\\n14567\\n17730\\n\");}\nI void Print4() {puts(\"68\\n132\\n171\\n138\\n225\\n6592\\n621318\\n64147302\\n1588039630\\n6348298844\");}\nI void Print5() {puts(\"531842264\\n3996089551\\n1217487770\\n13846806112\\n2258552000\\n12273908750\\n31068785149\\n453868136017\\n7989258282893\\n3571890382468\");}\nI void Print6() {puts(\"1159833908\\n380176501\\n1615846343\\n1005775280\\n1900756444\\n139818805\\n2130798985\\n1503185154\\n433569593\\n988651389\");}\nI void Print7() {puts(\"880\\n31080\\n325200\\n4449880\\n135637352\\n584509280\\n72434344904\\n306591086320\\n2055466926488\\n8643257847824\");}\nI void Print8() {puts(\"51\\n108\\n153\\n4929\\n124260\\n498810\\n12491602\\n49971923\\n2739460784\\n499996516402\");}\nI void Print9() {puts(\"2.236\\n69.527\\n8.944\\n10.440\\n10.198\\n1.414\\n57.489\\n10.770\\n5.000\\n8.544\");}\nI void Print10() {for(RI i=1;i<=10;++i) puts(\"invalid input!\");}\nint main()\n{\n\tRI Tpos;switch(scanf(\"%d\",&Tpos),Tpos)\n\t{\n\t\tcase 1:S.Solve();break;case 2:Print2();break;\n\t\tcase 3:Print3();break;case 4:Print4();break;\n\t\tcase 5:Print5();break;case 6:Print6();break;\n\t\tcase 7:Print7();break;case 8:Print8();break;\n\t\tcase 9:Print9();break;case 10:Print10();break;\n\t}return 0;\n}\n```",
        "postTime": 1552211882,
        "uid": 28382,
        "name": "TheLostWeak",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5246 \u3010[\u96c6\u8bad\u961f\u4e92\u6d4b2016] \u6d88\u5931\u7684\u6e90\u4ee3\u7801\u3011"
    },
    {
        "content": "\u5b89\u88c5 [GNU binutils](https://www.gnu.org/software/binutils) \u540e\uff0c\u8fd0\u884c `objdump -hd lost.exe` \u53cd\u6c47\u7f16\uff08[\u7ed3\u679c](https://paste.ubuntu.com/p/nN9MgFdvS2)\uff09\uff0c\u53d1\u73b0 `B::Do()`\u3001`C::Do()` \u7b49\u51fd\u6570\u5728\u8f93\u51fa `invalid input.` \u4e4b\u524d\u90fd\u4f1a\u68c0\u67e5\u4f4d\u4e8e `0x406000` \u7684\u503c\u3002\u4ee5 `B::Do()` \u4e3a\u4f8b\uff1a\n\n```plain\n  401404:       c7 04 24 41 a0 40 00    movl   $0x40a041,(%esp)\n  40140b:       e8 f0 29 00 00          call   403e00 <_strlen>\n  401410:       89 45 f0                mov    %eax,-0x10(%ebp)\n  # if (*(bool*) 0x406000) {\n  401413:       a0 00 60 40 00          mov    0x406000,%al\n  401418:       84 c0                   test   %al,%al\n  40141a:       74 1a                   je     401436 <__ZN1B2DoEv+0x4c>\n  #   if (n <= 0 || n > 10) {\n  40141c:       83 7d f0 00             cmpl   $0x0,-0x10(%ebp)\n  401420:       7e 06                   jle    401428 <__ZN1B2DoEv+0x3e>\n  401422:       83 7d f0 0a             cmpl   $0xa,-0x10(%ebp)\n  401426:       7e 0e                   jle    401436 <__ZN1B2DoEv+0x4c>\n  #     puts(\"invalid input.\");\n  401428:       c7 04 24 7c 70 40 00    movl   $0x40707c,(%esp)\n  40142f:       e8 c4 29 00 00          call   403df8 <_puts>\n  401434:       eb 46                   jmp    40147c <__ZN1B2DoEv+0x92>\n  #   }\n  # }\n  401436:       c7 45 f4 01 00 00 00    movl   $0x1,-0xc(%ebp)\n  40143d:       eb 24                   jmp    401463 <__ZN1B2DoEv+0x79>\n  40143f:       8b 45 f4                mov    -0xc(%ebp),%eax\n\n$ // \u89e3\u51b3\u4f60\u8c37\u535a\u5ba2\u7684\u7279\u6027\n```\n\n\u67e5\u8868\u53ef\u77e5\uff0c`0x406000` \u5728 `.data` \u6bb5\u4e2d\uff1a\n\n```plain\nIdx Name          Size      VMA       LMA       File off  Algn\n  0 .text         0000456c  00401000  00401000  00000400  2**4\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE, DATA\n  1 .data         00000014  00406000  00406000  00004a00  2**2\n                  CONTENTS, ALLOC, LOAD, DATA\n  2 .rdata        00000268  00407000  00407000  00004c00  2**4\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n```\n\n\u8fd0\u884c\u65f6\u7684 `0x406000` \u5bf9\u5e94\u7684\u5c31\u662f\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u7684 `0x4a00`\uff1a\n\n$$ \\mathrm{406000}_{16}-\\text{VMA}_\\texttt{.data}+\\text{File off}_\\texttt{.data}=\\mathrm{4a00}_{16} $$\n\n\uff08VMA \u6307\u6bb5\u5728\u865a\u62df\u5185\u5b58\u4e2d\u7684\u4f4d\u7f6e\uff0cFile off \u6307\u6bb5\u5728\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u7684\u4f4d\u7f6e\uff09\n\n\u6240\u4ee5\u53ea\u8981\u628a lost.exe \u4e2d\u4f4d\u4e8e `0x4a00` \u7684\u5b57\u8282\u7684\u503c\u6539\u4e3a 0 \u5c31\u53ef\u4ee5\u5f97\u5230\u6b63\u89e3\u4e86\u3002\uff08\u5bf9\u7b2c 1 \u548c\u7b2c 8 \u4e2a\u6d4b\u8bd5\u70b9\u7684\u7279\u6b8a\u5904\u7406\u53ef\u53c2\u8003\u5176\u4ed6\u9898\u89e3\uff09\n",
        "postTime": 1567405400,
        "uid": 206953,
        "name": "ud2_",
        "ccfLevel": 0,
        "title": "P5246 [\u96c6\u8bad\u961f\u4e92\u6d4b2016] \u6d88\u5931\u7684\u6e90\u4ee3\u7801"
    },
    {
        "content": "\u65e2\u7136\u6e90\u4ee3\u7801\u6ca1\u4e86\uff0c\u8ba9\u6211\u4eec\u5c31\u6765\u60f3\u529e\u6cd5\u7834\u89e3\u53ef\u6267\u884c\u6587\u4ef6\u3002\n\n\u4f7f\u7528 `IDA Pro` \u8fdb\u884c\u7834\u89e3\uff0c\u7528 `32` \u4f4d\u4ee5 `PE` \u683c\u5f0f\u6253\u5f00\u53ef\u6267\u884c\u6587\u4ef6\uff1a \n\n![image-20210125210900859](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210125210900859.png) \n\n![image-20210126110646925](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126110646925.png)\n\n `IDA` \u4f1a\u81ea\u52a8\u751f\u6210\u7a0b\u5e8f\u7684\u6d41\u7a0b\u56fe\uff0c\u4ee5\u6c47\u7f16\u5c55\u793a\u7a0b\u5e8f\u3002\n\n\u770b\u4e0d\u61c2\u6c47\u7f16\uff1f\u6ca1\u5173\u7cfb\uff0c`IDA` \u6709\u4e00\u4e2a\u975e\u5e38\u5f3a\u5927\u7684\u529f\u80fd\u2014\u2014\u81ea\u52a8\u751f\u6210\u4f2a\u4ee3\u7801\u3002\n\n\u867d\u8bf4\u662f\u4f2a\u4ee3\u7801\uff0c\u4f46\u5176\u5b9e\u5df2\u7ecf\u975e\u5e38\u7c7b\u4f3c `C/C++` \u8bed\u8a00\u4e86\u3002\n\n\u5de6\u8fb9\u51fd\u6570\u9009\u62e9\u6846\u91cc\u627e\u5230 `main` \u51fd\u6570\u8fdb\u5165\uff0c\u6309 `F5` \u5373\u53ef\u663e\u793a\u4f2a\u4ee3\u7801\u3002\n\n![image-20210126110738975](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126110738975.png)\n\n```cpp\nint __cdecl main(int argc, const char **argv, const char **envp)\n{\n  __main();\n  scanf(\"%d%d\", &type, &Case);\n  while ( Case-- != 0 )\n    Do(type);\n  return 0;\n}\n```\n\n\u8fd9\u91cc\u662f\u4e3b\u51fd\u6570\uff0c\u5f88\u660e\u663e\u662f\u5728\u8bfb\u5165\u6570\u636e\u7c7b\u578b\u548c\u6570\u636e\u7ec4\u6570\u3002\n\n\u53cc\u51fb `Do` \u51fd\u6570\u5373\u53ef\u8fdb\u5165\uff0c\u53d1\u73b0\u4ee5\u4e0b\u4f2a\u4ee3\u7801\u3002\n\n```cpp\nint __cdecl Do(int a1)\n{\n  int result; // eax\n  A *v2; // [esp+0h] [ebp-8h]\n\n  if ( !a1 )\n    result = A::Do(v2);\n  if ( a1 == 1 )\n    result = B::Do(v2);\n  if ( a1 == 2 )\n    result = C::Do(v2);\n  if ( a1 == 3 )\n    result = D::Do(v2);\n  if ( a1 == 4 )\n    result = E::Do(v2);\n  if ( a1 == 5 )\n    result = F::Do(v2);\n  if ( a1 == 6 )\n    result = G::Do(v2);\n  if ( a1 == 7 )\n    result = H::Do(v2);\n  if ( a1 == 8 )\n    result = I::Do(v2);\n  if ( a1 == 9 )\n    result = J::Do(v2);\n  if ( a1 == 10 )\n    result = K::Do(v2);\n  return result;\n}\n```\n\n\u5f88\u660e\u663e\u8fd9\u662f\u5728\u5224\u65ad\u6d4b\u8bd5\u70b9\u7f16\u53f7\uff0c\u8ba9\u6211\u4eec\u4ece\u7b2c\u4e00\u4e2a\u5f00\u59cb\u5206\u6790\u3002\n\n### Task A\n\n```cpp\nint A::Do()\n{\n  int v1; // [esp+18h] [ebp-10h] BYREF\n  int v2[3]; // [esp+1Ch] [ebp-Ch] BYREF\n  scanf(\"%d%d\", v2, &v1);\n  return printf(\"%d\\n\", v2[0] + v1);\n}\n```\n\n `A + B Problem` \u6ca1\u4ec0\u4e48\u8bf4\u7684\uff0c\u800c\u4e14\u6b63\u5f0f\u6d4b\u8bd5\u70b9\u4e5f\u6ca1\u6709 $type=0$ \u7684\u6570\u636e\uff0c\u5ffd\u7565\u3002\n\n\u9644\u4e0a\u51fa\u9898\u4eba\u516c\u5e03\u7684\u6e90\u4ee3\u7801\u4f9b\u4e0e\u4f2a\u4ee3\u7801\u5bf9\u6bd4\uff1a\n\n```cpp\nnamespace A\n{\n\tvoid Do()\n\t{\n\t\tint a,b;\n\t\tscanf(\"%d%d\",&a,&b);\n\t\tprintf(\"%d\\n\",a+b);\n\t}\n}\n```\n\n ### Task B\n\n```cpp\nint B::Do()\n{\n  signed int v1; // [esp+18h] [ebp-10h]\n  int i; // [esp+1Ch] [ebp-Ch]\n\n  scanf(\"%s\", Str);\n  v1 = strlen(Str);\n  if ( pre && (v1 <= 0 || v1 > 10) )\n    return puts(\"invalid input.\");\n  for ( i = 1; i <= v1; ++i )\n    putchar(B::point[*((char *)&B::dr + i) - 97]);\n  return putchar(10);\n}\n```\n\n $97$ \u5373\u662f `a` \u5bf9\u5e94\u7684 `ascii` \u7801\uff0c\u8fd9\u662f\u5c06\u8f93\u5165\u5b57\u7b26\u4e32\u8fdb\u884c\u6620\u5c04\u53d8\u6362\uff0c\u53d8\u6362\u6cd5\u5219\u663e\u7136\u5c31\u662f `point` \u6570\u7ec4\uff0c\u6211\u4eec\u53cc\u51fb\u8fdb\u5165\uff0c\u5f97\u5230\uff1a\n\n```cpp\n.rdata:004070F0 __ZN1BL5pointE  db 79h                  ; DATA XREF: B::Do(void)+65\u2191r\n.rdata:004070F1 aFrbkgimujvphat db 'frbkgimujvphatdsnelozcxwq',0\n```\n\n\u8fd9\u4e2a\u6570\u7ec4\u7b2c\u4e00\u4f4d\u662f `0x79` \uff0c\u5373 `y` \uff0c\u540e\u9762\u4e3a `frbkgimujvphatdsnelozcxwq`\uff0c\u8fde\u8d77\u6765\u5c31\u662f `yfrbkgimujvphatdsnelozcxwq`\u3002\n\n\u51fa\u9898\u4eba\u516c\u5e03\u7684\u6e90\u4ee3\u7801\uff1a\n\n```cpp\nnamespace B\n{\n\tconst char point[]=\"yfrbkgimujvphatdsnelozcxwq\";\n\tchar dr[105000];\n\tvoid Do()\n\t{\n\t\tint i;\n\t\tscanf(\"%s\",dr+1);\n\t\tint n=strlen(dr+1);\n\t\tif(pre)\n\t\t{\n\t\t\tif(n<1 || n>10)\n\t\t\t{\n\t\t\t\tprintf(\"invalid input.\\n\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tfor(i=1;i<=n;i++)\n\t\t\tputchar(point[dr[i]-'a']);\n\t\tprintf(\"\\n\");\n\t}\n}\n```\n\n### Task C\n\n```cpp\nint C::Do()\n{\n  signed __int64 v1; // rax\n  int v2; // eax\n  int Format; // [esp+8h] [ebp-58h]\n  int v4; // [esp+24h] [ebp-3Ch] BYREF\n  __int64 v5; // [esp+28h] [ebp-38h]\n  __int64 v6; // [esp+30h] [ebp-30h]\n  __int64 v7; // [esp+38h] [ebp-28h]\n  __int64 v8; // [esp+40h] [ebp-20h]\n  scanf(\"%d\", &v4);\n  if ( pre && (v4 < 0 || v4 > 20) )\n    return puts(\"invalid input.\");\n  v1 = (unsigned int)v4 * (unsigned __int64)(unsigned int)v4;\n  HIDWORD(v1) += 2 * (v4 >> 31) * v4;\n  Format = v4 * v4;\n  v8 = 2016 * (v1 % 233333) % 233333;\n  v7 = 4i64 * v4 % 233333;\n  v6 = 10i64;\n  v5 = (v7 + v8 + 10) % 233333;\n  v2 = std::ostream::operator<<(&std::cout, v5, HIDWORD(v5));\n  return std::ostream::operator<<(v2, &std::endl<char,std::char_traits<char>>, Format);\n}\n```\n\n\u4e4b\u540e\u6211\u4eec\u5c31\u6362\u4e00\u79cd\u89e3\u51b3\u65b9\u6cd5\uff0c\u770b\u5230\u90a3\u4e2a\u4e07\u6076\u7684 `puts(\"invalid input.\");` \u4e86\u5417\uff0c\u6211\u4eec\u8981\u8ba9\u7a0b\u5e8f\u4e0d\u6267\u884c\u5b83\u3002\n\n\u56de\u5230\u6d41\u7a0b\u56fe\uff0c\u627e\u5230\u8fd9\u4e00\u6bb5\u4ee3\u7801\u7247\u6bb5\n\n![image-20210125221351617](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210125221351617.png)\n\n\u6211\u4eec\u8981\u7ed5\u5f00\u5206\u652f\u5224\u5b9a\uff0c\u76f4\u63a5\u8fd0\u884c\u4e3b\u7a0b\u5e8f\uff08\u5373\u5f3a\u5236\u6309\u622a\u56fe\u7ed8\u5236\u7684\u7ea2\u8272\u7bad\u5934\u6267\u884c\uff0c\u4e0b\u540c\uff09\u3002\n\n\u79d1\u666e\u4e00\u70b9\u70b9\u6c47\u7f16\u8df3\u8f6c\u6307\u4ee4\u7684\u77e5\u8bc6\u3002\n\n```cpp\nJMP  //\u65e0\u6761\u4ef6\u8df3\u8f6c\n    \nJE   //\u7b49\u4e8e\u5219\u8df3\u8f6c\t\u540cJZ\nJNE  //\u4e0d\u7b49\u4e8e\u5219\u8df3\u8f6c\t\u540cJNZ\n\nJA   //\u65e0\u7b26\u53f7\u5927\u4e8e\u5219\u8df3\u8f6c\nJNA  //\u65e0\u7b26\u53f7\u4e0d\u5927\u4e8e\u5219\u8df3\u8f6c\nJAE  //\u65e0\u7b26\u53f7\u5927\u4e8e\u7b49\u4e8e\u5219\u8df3\u8f6c\t\u540cJNB\nJNAE //\u65e0\u7b26\u53f7\u4e0d\u5927\u4e8e\u7b49\u4e8e\u5219\u8df3\u8f6c\t\u540cJB\n\nJB   //\u65e0\u7b26\u53f7\u5c0f\u4e8e\u5219\u8df3\u8f6c\nJNB  //\u65e0\u7b26\u53f7\u4e0d\u5c0f\u4e8e\u5219\u8df3\u8f6c\nJBE  //\u65e0\u7b26\u53f7\u5c0f\u4e8e\u7b49\u4e8e\u5219\u8df3\u8f6c \u540cJNA\nJNBE //\u65e0\u7b26\u53f7\u4e0d\u5c0f\u4e8e\u7b49\u4e8e\u5219\u8df3\u8f6c\t\u540cJA\n\nJG   //\u6709\u7b26\u53f7\u5927\u4e8e\u5219\u8df3\u8f6c\nJNG  //\u6709\u7b26\u53f7\u4e0d\u5927\u4e8e\u5219\u8df3\u8f6c\nJGE  //\u6709\u7b26\u53f7\u5927\u4e8e\u7b49\u4e8e\u5219\u8df3\u8f6c\t\t\u540cJNL\nJNGE //\u6709\u7b26\u53f7\u4e0d\u5927\u4e8e\u7b49\u4e8e\u5219\u8df3\u8f6c\t\u540cJL\n\nJL   //\u6709\u7b26\u53f7\u5c0f\u4e8e\u5219\u8df3\u8f6c\nJNL  //\u6709\u7b26\u53f7\u4e0d\u5c0f\u4e8e\u5219\u8df3\u8f6c\nJLE  //\u6709\u7b26\u53f7\u5c0f\u4e8e\u7b49\u4e8e\u5219\u8df3\u8f6c\t\t\u540cJNG\nJNLE //\u6709\u7b26\u53f7\u4e0d\u5c0f\u4e8e\u7b49\u4e8e\u5219\u8df3\u8f6c\t\u540cJG\n\nJZ   //\u4e3a\u96f6\u5219\u8df3\u8f6c\nJNZ  //\u4e0d\u4e3a\u96f6\u5219\u8df3\u8f6c\n\nJS   //\u4e3a\u8d1f\u5219\u8df3\u8f6c\nJNS  //\u4e0d\u4e3a\u8d1f\u5219\u8df3\u8f6c\n\nJC   //\u8fdb\u4f4d\u5219\u8df3\u8f6c\nJNC  //\u4e0d\u8fdb\u4f4d\u5219\u8df3\u8f6c\n\nJO   //\u6ea2\u51fa\u5219\u8df3\u8f6c\nJNO  //\u4e0d\u6ea2\u51fa\u5219\u8df3\u8f6c\n\nJP   //\u4e3a\u5076\u5219\u8df3\u8f6c\nJNP  //\u4e0d\u4e3a\u5076\u5219\u8df3\u8f6c\nJPE  //\u5947\u5076\u4f4d\u7f6e\u4f4d\u5219\u8df3\u8f6c\t\t\u540cJP\nJPO  //\u5947\u5076\u4f4d\u590d\u4f4d\u5219\u8df3\u8f6c\t\t\u540cJNP\n```\n\n\u6211\u4eec\u9700\u8981\u5c06\u6b64\u5904\u7684 `jz` \u8df3\u8f6c\u8f6c\u6210 `jmp` \u65e0\u6761\u4ef6\u8df3\u8f6c\u3002\n\n\u70b9\u51fb\u9009\u4e2d\u8fd9\u4e00\u884c\uff0c`Edit->Patch program->Assemble` \u5373\u53ef\u4fee\u6539\n\n![image-20210126110818137](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126110818137.png)\n\n![image-20210126003406597](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126003406597.png)\n\n\u73b0\u5728\u5c31\u53d8\u6210\u76f4\u63a5\u8fd0\u884c\u4e3b\u7a0b\u5e8f\uff0c\u6c38\u8fdc\u4e0d\u4f1a\u8fdb\u5165\u5206\u652f\u5224\u65ad\u4e86\u3002\n\n![image-20210126003739158](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126003739158.png)\n\n\u6309 `F5` \u518d\u68c0\u67e5\u4e00\u4e0b\u4f2a\u4ee3\u7801\uff0c\u53d1\u73b0\u6761\u4ef6\u5224\u65ad\u786e\u5b9e\u6ca1\u4e86\u3002\n\n```cpp\nint C::Do()\n{\n  signed __int64 v0; // rax\n  int v1; // eax\n  int Format; // [esp+8h] [ebp-58h]\n  int v4; // [esp+24h] [ebp-3Ch] BYREF\n  __int64 v5; // [esp+28h] [ebp-38h]\n  __int64 v6; // [esp+30h] [ebp-30h]\n  __int64 v7; // [esp+38h] [ebp-28h]\n  __int64 v8; // [esp+40h] [ebp-20h]\n  scanf(\"%d\", &v4);\n  v0 = (unsigned int)v4 * (unsigned __int64)(unsigned int)v4;\n  HIDWORD(v0) += 2 * (v4 >> 31) * v4;\n  Format = v4 * v4;\n  v8 = 2016 * (v0 % 233333) % 233333;\n  v7 = 4i64 * v4 % 233333;\n  v6 = 10i64;\n  v5 = (v7 + v8 + 10) % 233333;\n  v1 = std::ostream::operator<<(&std::cout, v5, HIDWORD(v5));\n  return std::ostream::operator<<(v1, &std::endl<char,std::char_traits<char>>, Format);\n}\n```\n\n\u51fa\u9898\u4eba\u516c\u5e03\u7684\u6e90\u4ee3\u7801\uff1a\n\n```cpp\nnamespace C\n{\n\tconst int mo=233333;\n\tvoid Do()\n\t{\n\t\tint n;\n\t\tscanf(\"%d\",&n);\n\t\tif(pre)\n\t\t{\n\t\t\tif(n<0 || n>20)\n\t\t\t{\n\t\t\t\tprintf(\"invalid input.\\n\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tlong long a=n;\n\t\ta*=n;\n\t\ta%=mo;\n\t\ta*=2016;\n\t\ta%=mo;\n\t\tlong long b=n;\n\t\tb*=4;\n\t\tb%=mo;\n\t\tlong long c=10;\n\t\tlong long ans=a+b+c;\n\t\tans%=mo;\n\t\tcout<<ans<<endl;\n\t}\n}\n```\n\n### Task D\n\n\u540c\u7406\uff0c\u4f2a\u4ee3\u7801\uff1a\n\n```cpp\nint D::Do()\n{\n  int v1; // [esp+28h] [ebp-20h] BYREF\n  int v2; // [esp+2Ch] [ebp-1Ch]\n  _TBYTE v3; // [esp+30h] [ebp-18h]\n  scanf(\"%d\", &v1);\n  if ( pre && (v1 <= 0 || v1 > 50000) )\n    return puts(\"invalid input.\");\n  *(double *)&v3 = sqrtl((double)v1 / -8.87960937049345e43);\n  v2 = (int)floorl(*(long double *)&v3);\n  return printf(\"%d\\n\", v2);\n}\n```\n\n\u6d41\u7a0b\u56fe\uff1a\n\n![image-20210126004209306](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126004209306.png)\n\n\u4fee\u6539\u8df3\u8f6c\uff1a\n\n![image-20210126004238766](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126004238766.png)\n\n\u4fee\u6539\u540e\u4f2a\u4ee3\u7801\uff1a\n\n```cpp\nint D::Do()\n{\n  int v1; // [esp+28h] [ebp-20h] BYREF\n  int v2; // [esp+2Ch] [ebp-1Ch]\n  _TBYTE v3; // [esp+30h] [ebp-18h]\n  scanf(\"%d\", &v1);\n  *(double *)&v3 = sqrtl((double)v1 / -8.87960937049345e43);\n  v2 = (int)floorl(*(long double *)&v3);\n  return printf(\"%d\\n\", v2);\n}\n```\n\n\u51fa\u9898\u4eba\u516c\u5e03\u7684\u6e90\u4ee3\u7801\uff1a\n\n```cpp\nnamespace D\n{\n\tconst long double pi=4.0l*atanl(1.0);\n\tvoid Do()\n\t{\n\t\tint n;\n\t\tscanf(\"%d\",&n);\n\t\tif(pre)\n\t\t{\n\t\t\tif(n<1 || n>50000)\n\t\t\t{\n\t\t\t\tprintf(\"invalid input.\\n\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tlong double ans=n;\n\t\tans/=pi;\n\t\tans=sqrtl(ans);\n\t\tint ansx=floorl(ans);\n\t\tprintf(\"%d\\n\",ansx);\n\t}\n}\n```\n\n### Task E\n\n\u4f2a\u4ee3\u7801\uff1a\n\n```cpp\nint __cdecl E::getf(E *this)\n{\n  int v2; // [esp+4h] [ebp-14h]\n\n  if ( *(&E::fa + (_DWORD)this) != this )\n    *(&E::fa + (_DWORD)this) = (E *)E::getf(*(&E::fa + (_DWORD)this), v2);\n  return (int)*(&E::fa + (_DWORD)this);\n}\n\nint E::Do()\n{\n  int v2; // eax\n  __int64 v3; // rax\n  int v4; // ecx\n  unsigned __int64 v5; // rax\n  int v6; // eax\n  int Format; // [esp+8h] [ebp-38h]\n  E *v8; // [esp+18h] [ebp-28h] BYREF\n  E *v9; // [esp+1Ch] [ebp-24h] BYREF\n  unsigned __int64 v10; // [esp+20h] [ebp-20h]\n  __int64 v11; // [esp+28h] [ebp-18h]\n  E *i; // [esp+34h] [ebp-Ch]\n  scanf(\"%d%d\", &E::n, &E::m);\n  for ( i = (E *)1; (int)i <= E::n; i = (E *)((char *)i + 1) )\n    *(&E::fa + (_DWORD)i) = i;\n  memset(E::cc, 0, 0x62250u);\n  while ( E::m-- != 0 )\n  {\n    scanf(\"%d%d\", &v9, &v8);\n    v9 = (E *)E::getf(v9);\n    v8 = (E *)E::getf(v8);\n    if ( v9 != v8 )\n      *(&E::fa + (_DWORD)v9) = v8;\n  }\n  if ( pre && (E::n > 10 || E::m > 10) )\n    return puts(\"invalid input.\");\n  for ( i = (E *)1; (int)i <= E::n; i = (E *)((char *)i + 1) )\n  {\n    v2 = E::getf(i);\n    ++E::cc[v2];\n  }\n  v11 = 0i64;\n  for ( i = (E *)1; (int)i <= E::n; i = (E *)((char *)i + 1) )\n  {\n    v10 = E::cc[(_DWORD)i];\n    v3 = E::cc[(_DWORD)i];\n    v4 = v3 * HIDWORD(v10) + HIDWORD(v3) * v10;\n    v5 = (unsigned int)v10 * (unsigned __int64)(unsigned int)v3;\n    HIDWORD(v5) += v4;\n    v10 = v5;\n    v11 += v5;\n  }\n  v6 = std::ostream::operator<<(&std::cout, v11, HIDWORD(v11));\n  return std::ostream::operator<<(v6, &std::endl<char,std::char_traits<char>>, Format);\n}\n```\n\n\uff08\u5176\u5b9e\u7ed3\u5408\u6570\u636e\u5927\u6982\u4e5f\u80fd\u770b\u51fa\u6765\uff0c\u8fd9\u662f\u5728\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u5404\u8fde\u901a\u5757\u5927\u5c0f\u7684\u5e73\u65b9\u548c\uff09\n\n\u8fd9\u4e2a\u6d41\u7a0b\u56fe\u7a0d\u5fae\u6709\u70b9\u590d\u6742\uff0c\u4e0d\u8fc7\u7ed3\u5408\u4f2a\u4ee3\u7801\u8fd8\u662f\u6bd4\u8f83\u5bb9\u6613\u7406\u89e3\u7684\n\n![image-20210126005236095](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126005236095.png)\n\n\n\n\u4fee\u6539\u6b64\u5904\uff0c\u8ba9\u5b83\u76f4\u63a5\u8df3\u8f6c\n\n![image-20210126005443482](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126005443482.png)\n\n\u4fee\u6539\u540e\u6d41\u7a0b\u56fe\uff1a\n\n![image-20210126005403183](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126005403183.png)\n\n\u4fee\u6539\u540e\u4f2a\u4ee3\u7801\uff1a\n\n```cpp\nint E::Do()\n{\n  int v1; // eax\n  __int64 v2; // rax\n  int v3; // ecx\n  unsigned __int64 v4; // rax\n  int v5; // eax\n  int Format; // [esp+8h] [ebp-38h]\n  E *v8; // [esp+18h] [ebp-28h] BYREF\n  E *v9; // [esp+1Ch] [ebp-24h] BYREF\n  unsigned __int64 v10; // [esp+20h] [ebp-20h]\n  __int64 v11; // [esp+28h] [ebp-18h]\n  E *i; // [esp+34h] [ebp-Ch]\n  scanf(\"%d%d\", &E::n, &E::m);\n  for ( i = (E *)1; (int)i <= E::n; i = (E *)((char *)i + 1) )\n    *(&E::fa + (_DWORD)i) = i;\n  memset(E::cc, 0, 0x62250u);\n  while ( E::m-- != 0 )\n  {\n    scanf(\"%d%d\", &v9, &v8);\n    v9 = (E *)E::getf(v9);\n    v8 = (E *)E::getf(v8);\n    if ( v9 != v8 )\n      *(&E::fa + (_DWORD)v9) = v8;\n  }\n  for ( i = (E *)1; (int)i <= E::n; i = (E *)((char *)i + 1) )\n  {\n    v1 = E::getf(i);\n    ++E::cc[v1];\n  }\n  v11 = 0i64;\n  for ( i = (E *)1; (int)i <= E::n; i = (E *)((char *)i + 1) )\n  {\n    v10 = E::cc[(_DWORD)i];\n    v2 = E::cc[(_DWORD)i];\n    v3 = v2 * HIDWORD(v10) + HIDWORD(v2) * v10;\n    v4 = (unsigned int)v10 * (unsigned __int64)(unsigned int)v2;\n    HIDWORD(v4) += v3;\n    v10 = v4;\n    v11 += v4;\n  }\n  v5 = std::ostream::operator<<(&std::cout, v11, HIDWORD(v11));\n  return std::ostream::operator<<(v5, &std::endl<char,std::char_traits<char>>, Format);\n}\n```\n\n\u51fa\u9898\u516c\u5e03\u7684\u6e90\u4ee3\u7801\uff1a\n\n```cpp\nnamespace E\n{\n\tconst int N = 100500;\n\tint n,m;\n\tint fa[N];\n\tint cc[N];\n\tint getf(int x)\n\t{\n\t\tif(fa[x]!=x)\n\t\t\tfa[x]=getf(fa[x]);\n\t\treturn fa[x];\n\t}\n\tvoid Do()\n\t{\n\t\tint i;\n\t\tscanf(\"%d%d\",&n,&m);\n\t\tfor(i=1;i<=n;i++)\n\t\t\tfa[i]=i;\n\t\tmemset(cc,0,sizeof cc);\n\t\twhile(m--)\n\t\t{\n\t\t\tint a,b;\n\t\t\tscanf(\"%d%d\",&a,&b);\n\t\t\ta=getf(a);\n\t\t\tb=getf(b);\n\t\t\tif(a!=b)\n\t\t\t\tfa[a]=b;\n\t\t}\n\t\tif(pre)\n\t\t{\n\t\t\tif(n>10 || m>10)\n\t\t\t{\n\t\t\t\tprintf(\"invalid input.\\n\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tfor(i=1;i<=n;i++)\n\t\t\tcc[getf(i)]++;\n\t\tlong long ans=0;\n\t\tfor(i=1;i<=n;i++)\n\t\t{\n\t\t\tlong long now=cc[i];\n\t\t\tnow*=cc[i];\n\t\t\tans+=now;\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}\n```\n\n### Task F\n\n\u4f2a\u4ee3\u7801\uff1a\n\n```cpp\nint __cdecl F::AddEdge(F *this, int a2, int a3)\n{\n  int result; // eax\n\n  F::next[++F::cc] = F::point[(_DWORD)this];\n  F::point[(_DWORD)this] = F::cc;\n  F::to[F::cc] = a2;\n  result = F::cc;\n  F::len[F::cc] = a3;\n  return result;\n}\n\nbool __cdecl F::GetFa(F *this)\n{\n  bool result; // al\n  int v2; // [esp+4h] [ebp-24h]\n  F *v3; // [esp+18h] [ebp-10h]\n  int i; // [esp+1Ch] [ebp-Ch]\n\n  F::depth[(_DWORD)this] = F::depth[F::fa[(_DWORD)this]] + 1;\n  F::tot[(_DWORD)this] = 1;\n  for ( i = F::point[(_DWORD)this]; ; i = F::next[i] )\n  {\n    result = i != 0;\n    if ( !i )\n      break;\n    v3 = (F *)F::to[i];\n    if ( (F *)F::fa[(_DWORD)this] != v3 )\n    {\n      F::fa[(_DWORD)v3] = (int)this;\n      F::falen[(_DWORD)v3] = F::len[i];\n      F::GetFa(v3, v2);\n      F::tot[(_DWORD)this] += F::tot[(_DWORD)v3];\n    }\n  }\n  return result;\n}\n\nbool __cdecl F::GetNum(F *this, int a2, int a3)\n{\n  bool result; // al\n  int v4; // [esp+Ch] [ebp-1Ch]\n  int v5; // [esp+Ch] [ebp-1Ch]\n  int v6; // [esp+10h] [ebp-18h]\n  int v7; // [esp+14h] [ebp-14h]\n  F *v8; // [esp+18h] [ebp-10h]\n  int v9; // [esp+1Ch] [ebp-Ch]\n  int i; // [esp+1Ch] [ebp-Ch]\n  int v11; // [esp+38h] [ebp+10h]\n  int v12; // [esp+38h] [ebp+10h]\n\n  F::num[(_DWORD)this] = a3;\n  F::numx[a3] = (int)this;\n  F::top[(_DWORD)this] = a2;\n  v11 = a3 + 1;\n  v9 = F::point[(_DWORD)this];\n  v8 = 0;\n  while ( 1 )\n  {\n    result = v9 != 0;\n    if ( !v9 )\n      break;\n    v7 = F::to[v9];\n    if ( F::fa[(_DWORD)this] != v7 && F::tot[v7] > F::tot[(_DWORD)v8] )\n      v8 = (F *)F::to[v9];\n    v9 = F::next[v9];\n  }\n  if ( v8 )\n  {\n    F::GetNum(v8, a2, v11, v4);\n    v12 = F::tot[(_DWORD)v8] + v11;\n    for ( i = F::point[(_DWORD)this]; ; i = F::next[i] )\n    {\n      result = i != 0;\n      if ( !i )\n        break;\n      v6 = F::to[i];\n      if ( F::fa[(_DWORD)this] != v6 && (F *)v6 != v8 )\n      {\n        F::GetNum((F *)v6, v6, v12, v5);\n        v12 += F::tot[v6];\n      }\n    }\n  }\n  return result;\n}\n\nbool F::GetData()\n{\n  __int64 v0; // rax\n  int v1; // ecx\n  __int64 v2; // rcx\n  __int64 v3; // rax\n  __int64 v4; // rax\n  bool result; // al\n  int Val; // [esp+4h] [ebp-24h]\n  int v7; // [esp+Ch] [ebp-1Ch]\n  int v8; // [esp+Ch] [ebp-1Ch]\n  int v9; // [esp+Ch] [ebp-1Ch]\n  int v10; // [esp+10h] [ebp-18h] BYREF\n  F *v11; // [esp+14h] [ebp-14h] BYREF\n  F *v12; // [esp+18h] [ebp-10h] BYREF\n  int i; // [esp+1Ch] [ebp-Ch]\n\n  scanf(\"%d%d\", &F::n, &F::m);\n  memset(&F::point, 0, 0x62250u);\n  F::cc = 0;\n  for ( i = 1; i < F::n; ++i )\n  {\n    scanf(\"%d%d%d\", &v12, &v11, &v10);\n    F::AddEdge(v12, (int)v11, v10, v8);\n    F::AddEdge(v11, (int)v12, v10, v9);\n  }\n  F::GetFa((F *)1, Val);\n  F::GetNum((F *)1, 1, 1, v7);\n  for ( i = 1; i <= F::n; ++i )\n  {\n    v0 = F::falen[F::numx[i]];\n    v1 = i;\n    F::qz[2 * i] = v0;\n    dword_B102A4[2 * v1] = HIDWORD(v0);\n  }\n  for ( i = 1; ; ++i )\n  {\n    result = i <= F::n;\n    if ( i > F::n )\n      break;\n    LODWORD(v2) = F::qz[2 * i];\n    HIDWORD(v2) = dword_B102A4[2 * i];\n    HIDWORD(v3) = dword_B102A4[2 * i - 2];\n    LODWORD(v3) = F::qz[2 * i - 2];\n    v4 = v2 + v3;\n    LODWORD(v2) = i;\n    F::qz[2 * i] = v4;\n    dword_B102A4[2 * (_DWORD)v2] = HIDWORD(v4);\n  }\n  return result;\n}\n\n__int64 __cdecl F::Find(F *this, int a2)\n{\n  int v2; // eax\n  __int64 v3; // rax\n  int v4; // ecx\n  __int64 v5; // rcx\n  int v6; // eax\n  __int64 v7; // rax\n  int v8; // ecx\n  __int64 v9; // rcx\n  int v10; // eax\n  __int64 v11; // rax\n  int v12; // ecx\n  __int64 v13; // rcx\n  int v14; // eax\n  __int64 v16; // [esp+8h] [ebp-10h]\n\n  v16 = 0i64;\n  while ( F::top[(_DWORD)this] != F::top[a2] )\n  {\n    if ( F::depth[F::top[(_DWORD)this]] <= F::depth[F::top[a2]] )\n    {\n      v6 = F::num[a2];\n      HIDWORD(v7) = dword_B102A4[2 * v6];\n      LODWORD(v7) = F::qz[2 * v6];\n      v8 = F::num[F::top[a2]] - 1;\n      HIDWORD(v9) = dword_B102A4[2 * v8];\n      LODWORD(v9) = F::qz[2 * v8];\n      v16 += v7 - v9;\n      a2 = F::fa[F::top[a2]];\n    }\n    else\n    {\n      v2 = F::num[(_DWORD)this];\n      HIDWORD(v3) = dword_B102A4[2 * v2];\n      LODWORD(v3) = F::qz[2 * v2];\n      v4 = F::num[F::top[(_DWORD)this]] - 1;\n      HIDWORD(v5) = dword_B102A4[2 * v4];\n      LODWORD(v5) = F::qz[2 * v4];\n      v16 += v3 - v5;\n      this = (F *)F::fa[F::top[(_DWORD)this]];\n    }\n  }\n  if ( F::depth[(_DWORD)this] >= F::depth[a2] )\n  {\n    v14 = F::num[(_DWORD)this];\n    HIDWORD(v11) = dword_B102A4[2 * v14];\n    LODWORD(v11) = F::qz[2 * v14];\n    v12 = F::num[a2];\n  }\n  else\n  {\n    v10 = F::num[a2];\n    HIDWORD(v11) = dword_B102A4[2 * v10];\n    LODWORD(v11) = F::qz[2 * v10];\n    v12 = F::num[(_DWORD)this];\n  }\n  HIDWORD(v13) = dword_B102A4[2 * v12];\n  LODWORD(v13) = F::qz[2 * v12];\n  return v11 - v13 + v16;\n}\n\nint F::DoIt()\n{\n  __int64 v0; // rax\n  int v3; // eax\n  char *Format; // [esp+8h] [ebp-28h]\n  int v5; // [esp+18h] [ebp-18h] BYREF\n  F *v6; // [esp+1Ch] [ebp-14h] BYREF\n  __int64 i; // [esp+20h] [ebp-10h]\n\n  for ( i = 0i64; F::m-- != 0; i ^= v0 )\n  {\n    scanf(\"%d%d\", &v6, &v5);\n    v0 = F::Find(v6, v5);\n  }\n  if ( pre && (F::n > 10 || F::m > 10) )\n    return puts(\"invalid input.\");\n  v3 = std::ostream::operator<<(&std::cout, i, HIDWORD(i));\n  return std::ostream::operator<<(v3, &std::endl<char,std::char_traits<char>>, Format);\n}\n\nint F::Do()\n{\n  F *v1; // [esp+0h] [ebp-8h]\n  F *v2; // [esp+0h] [ebp-8h]\n\n  F::GetData(v1);\n  return F::DoIt(v2);\n}\n```\n\n\u53d1\u73b0 `invalid input.` \u5728 `DoIt()` \u51fd\u6570\u91cc\uff0c\u4fee\u6539\u5373\u53ef\u3002\n\n![image-20210126010024425](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126010024425.png)\n\n\u4fee\u6539\u540e\u6d41\u7a0b\u56fe\uff1a\n\n![image-20210126010100218](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126010100218.png)\n\n\u4fee\u6539\u540e\u4f2a\u4ee3\u7801\uff1a\n\n```cpp\nint F::DoIt()\n{\n  __int64 v0; // rax\n  int v2; // eax\n  int Format; // [esp+8h] [ebp-28h]\n  int v5; // [esp+18h] [ebp-18h] BYREF\n  F *v6; // [esp+1Ch] [ebp-14h] BYREF\n  __int64 i; // [esp+20h] [ebp-10h]\n\n  for ( i = 0i64; F::m-- != 0; i ^= v0 )\n  {\n    scanf(\"%d%d\", &v6, &v5);\n    v0 = F::Find(v6, v5);\n  }\n  v2 = std::ostream::operator<<(&std::cout, i, HIDWORD(i));\n  return std::ostream::operator<<(v2, &std::endl<char,std::char_traits<char>>, Format);\n}\n```\n\n\u51fa\u9898\u4eba\u516c\u5e03\u7684\u6e90\u4ee3\u7801\uff1a\n\n```cpp\nnamespace F\n{\n\tconst int N = 100500;\n\tconst int M = 270000;\n\tint point[N],to[M],next[M],len[M],cc;\n\tint fa[N],falen[N],tot[N],depth[N];\n\tint num[N],top[N],numx[N];\n\tint n,m;\n\tlong long qz[N];\n\tvoid AddEdge(int x,int y,int z)\n\t{\n\t\tcc++;\n\t\tnext[cc]=point[x];\n\t\tpoint[x]=cc;\n\t\tto[cc]=y;\n\t\tlen[cc]=z;\n\t}\n\tvoid GetFa(int x)\n\t{\n\t\tdepth[x]=depth[fa[x]]+1;\n\t\ttot[x]=1;\n\t\tint now=point[x];\n\t\twhile(now)\n\t\t{\n\t\t\tint tox=to[now];\n\t\t\tif(tox!=fa[x])\n\t\t\t{\n\t\t\t\tfa[tox]=x;\n\t\t\t\tfalen[tox]=len[now];\n\t\t\t\tGetFa(tox);\n\t\t\t\ttot[x]+=tot[tox];\n\t\t\t}\n\t\t\tnow=next[now];\n\t\t}\n\t}\n\tvoid GetNum(int x,int grand,int v)\n\t{\n\t\tnum[x]=v;\n\t\tnumx[v]=x;\n\t\ttop[x]=grand;\n\t\tv++;\n\t\tint now=point[x];\n\t\tint prefer=0;\n\t\twhile(now)\n\t\t{\n\t\t\tint tox=to[now];\n\t\t\tif(tox!=fa[x] && tot[tox]>tot[prefer])\n\t\t\t\tprefer=tox;\n\t\t\tnow=next[now];\n\t\t}\n\t\tif(!prefer)\n\t\t\treturn;\n\t\tGetNum(prefer,grand,v);\n\t\tv+=tot[prefer];\n\t\tnow=point[x];\n\t\twhile(now)\n\t\t{\n\t\t\tint tox=to[now];\n\t\t\tif(tox!=fa[x] && tox!=prefer)\n\t\t\t{\n\t\t\t\tGetNum(tox,tox,v);\n\t\t\t\tv+=tot[tox];\n\t\t\t}\n\t\t\tnow=next[now];\n\t\t}\n\t}\n\tvoid GetData()\n\t{\n\t\tint i;\n\t\tscanf(\"%d%d\",&n,&m);\n\t\tmemset(point,0,sizeof point);\n\t\tcc=0;\n\t\tfor(i=1;i<n;i++)\n\t\t{\n\t\t\tint a,b,c;\n\t\t\tscanf(\"%d%d%d\",&a,&b,&c);\n\t\t\tAddEdge(a,b,c);\n\t\t\tAddEdge(b,a,c);\n\t\t}\n\t\tGetFa(1);\n\t\tGetNum(1,1,1);\n\t\tfor(i=1;i<=n;i++)\n\t\t\tqz[i]=falen[numx[i]];\n\t\tfor(i=1;i<=n;i++)\n\t\t\tqz[i]+=qz[i-1];\n\t}\n\tlong long Find(int x,int y)\n\t{\n\t\tlong long res=0;\n\t\twhile(top[x]!=top[y])\n\t\t{\n\t\t\tif(depth[top[x]]>depth[top[y]])\n\t\t\t{\n\t\t\t\tres+=(qz[num[x]]-qz[num[top[x]]-1]);\n\t\t\t\tx=fa[top[x]];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tres+=(qz[num[y]]-qz[num[top[y]]-1]);\n\t\t\t\ty=fa[top[y]];\n\t\t\t}\n\t\t}\n\t\tif(depth[x]<depth[y])\n\t\t\tres+=(qz[num[y]]-qz[num[x]]);\n\t\telse\n\t\t\tres+=(qz[num[x]]-qz[num[y]]);\n\t\treturn res;\n\t}\n\tvoid DoIt()\n\t{\n\t\tlong long ans=0;\n\t\twhile(m--)\n\t\t{\n\t\t\tint a,b;\n\t\t\tscanf(\"%d%d\",&a,&b);\n\t\t\tans^=Find(a,b);\n\t\t}\n\t\tif(pre)\n\t\t{\n\t\t\tif(n>10 || m>10)\n\t\t\t{\n\t\t\t\tprintf(\"invalid input.\\n\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\tvoid Do()\n\t{\n\t\tGetData();\n\t\tDoIt();\n\t}\n}\n```\n\n### Task G\n\n\u4f2a\u4ee3\u7801\uff1a\n\n```cpp\nint __cdecl G::AddEdge(G *this, int a2, int a3)\n{\n  int result; // eax\n\n  G::next[++G::cc] = G::point[(_DWORD)this];\n  G::point[(_DWORD)this] = G::cc;\n  G::to[G::cc] = a2;\n  result = G::cc;\n  G::len[G::cc] = a3;\n  return result;\n}\nbool __cdecl G::GetFa(G *this)\n{\n  bool result; // al\n  int v2; // [esp+4h] [ebp-24h]\n  G *v3; // [esp+18h] [ebp-10h]\n  int i; // [esp+1Ch] [ebp-Ch]\n\n  G::depth[(_DWORD)this] = G::depth[G::fa[(_DWORD)this]] + 1;\n  G::tot[(_DWORD)this] = 1;\n  for ( i = G::point[(_DWORD)this]; ; i = G::next[i] )\n  {\n    result = i != 0;\n    if ( !i )\n      break;\n    v3 = (G *)G::to[i];\n    if ( (G *)G::fa[(_DWORD)this] != v3 )\n    {\n      G::fa[(_DWORD)v3] = (int)this;\n      G::falen[(_DWORD)v3] = G::len[i];\n      G::GetFa(v3, v2);\n      G::tot[(_DWORD)this] += G::tot[(_DWORD)v3];\n    }\n  }\n  return result;\n}\nbool __cdecl G::GetNum(G *this, int a2, int a3)\n{\n  bool result; // al\n  int v4; // [esp+Ch] [ebp-1Ch]\n  int v5; // [esp+Ch] [ebp-1Ch]\n  int v6; // [esp+10h] [ebp-18h]\n  int v7; // [esp+14h] [ebp-14h]\n  G *v8; // [esp+18h] [ebp-10h]\n  int v9; // [esp+1Ch] [ebp-Ch]\n  int i; // [esp+1Ch] [ebp-Ch]\n  int v11; // [esp+38h] [ebp+10h]\n  int v12; // [esp+38h] [ebp+10h]\n\n  *(&G::num + (_DWORD)this) = (G *)a3;\n  G::numx[a3] = (int)this;\n  G::top[(_DWORD)this] = a2;\n  v11 = a3 + 1;\n  v9 = G::point[(_DWORD)this];\n  v8 = 0;\n  while ( 1 )\n  {\n    result = v9 != 0;\n    if ( !v9 )\n      break;\n    v7 = G::to[v9];\n    if ( G::fa[(_DWORD)this] != v7 && G::tot[v7] > G::tot[(_DWORD)v8] )\n      v8 = (G *)G::to[v9];\n    v9 = G::next[v9];\n  }\n  if ( v8 )\n  {\n    G::GetNum(v8, a2, v11, v4);\n    v12 = G::tot[(_DWORD)v8] + v11;\n    for ( i = G::point[(_DWORD)this]; ; i = G::next[i] )\n    {\n      result = i != 0;\n      if ( !i )\n        break;\n      v6 = G::to[i];\n      if ( G::fa[(_DWORD)this] != v6 && (G *)v6 != v8 )\n      {\n        G::GetNum((G *)v6, v6, v12, v5);\n        v12 += G::tot[v6];\n      }\n    }\n  }\n  return result;\n}\nbool G::GetData()\n{\n  int v0; // edx\n  bool result; // al\n  int v2; // [esp+10h] [ebp-18h] BYREF\n  G *v3; // [esp+14h] [ebp-14h] BYREF\n  G *v4; // [esp+18h] [ebp-10h] BYREF\n  int i; // [esp+1Ch] [ebp-Ch]\n\n  scanf(\"%d%d\", &G::n, &G::m);\n  memset(G::point, 0, 0x62250u);\n  G::cc = 0;\n  for ( i = 1; i < G::n; ++i )\n  {\n    scanf(\"%d%d%d\", &v4, &v3, &v2);\n    G::AddEdge(v4, (int)v3, v2);\n    G::AddEdge(v3, (int)v4, v2);\n  }\n  G::GetFa((G *)1);\n  G::GetNum((G *)1, 1, 1);\n  for ( i = 1; i <= G::n; ++i )\n    G::tree[i + 0x20000] = G::falen[G::numx[i]];\n  for ( i = 0x1FFFF; ; --i )\n  {\n    result = i > 0;\n    if ( i <= 0 )\n      break;\n    v0 = *(_DWORD *)std::min<int>(&G::tree[2 * i], &G::tree[2 * i + 1]);\n    G::tree[i] = v0;\n  }\n  return result;\n}\nint __cdecl G::MinV(G *this, int a2)\n{\n  int v3[3]; // [esp+1Ch] [ebp-Ch] BYREF\n  int thisa; // [esp+30h] [ebp+8h]\n  int v5; // [esp+34h] [ebp+Ch]\n\n  thisa = (int)this + 0x1FFFF;\n  v5 = a2 + 131073;\n  v3[0] = 1987654321;\n  while ( (thisa ^ v5) != 1 )\n  {\n    if ( (thisa & 1) == 0 )\n      v3[0] = *(_DWORD *)std::min<int>(v3, &G::tree[thisa ^ 1]);\n    if ( v5 % 2 == 1 )\n      v3[0] = *(_DWORD *)std::min<int>(v3, &G::tree[v5 ^ 1]);\n    thisa >>= 1;\n    v5 >>= 1;\n  }\n  return v3[0];\n}\nint __cdecl G::Find(G *this, int a2)\n{\n  int v3; // [esp+1Ch] [ebp-1Ch] BYREF\n  int v4; // [esp+20h] [ebp-18h] BYREF\n  int v5; // [esp+24h] [ebp-14h] BYREF\n  int v6; // [esp+28h] [ebp-10h] BYREF\n  int v7[3]; // [esp+2Ch] [ebp-Ch] BYREF\n\n  v3 = 1987654321;\n  while ( G::top[(_DWORD)this] != G::top[a2] )\n  {\n    if ( G::depth[G::top[(_DWORD)this]] <= G::depth[G::top[a2]] )\n    {\n      v5 = G::MinV(*(&G::num + G::top[a2]), (int)*(&G::num + a2));\n      v3 = *(_DWORD *)std::min<int>(&v3, &v5);\n      a2 = G::fa[G::top[a2]];\n    }\n    else\n    {\n      v4 = G::MinV(*(&G::num + G::top[(_DWORD)this]), (int)*(&G::num + (_DWORD)this));\n      v3 = *(_DWORD *)std::min<int>(&v3, &v4);\n      this = (G *)G::fa[G::top[(_DWORD)this]];\n    }\n  }\n  if ( G::depth[(_DWORD)this] >= G::depth[a2] )\n  {\n    if ( G::depth[(_DWORD)this] > G::depth[a2] )\n    {\n      v7[0] = G::MinV((G *)((char *)*(&G::num + a2) + 1), (int)*(&G::num + (_DWORD)this));\n      v3 = *(_DWORD *)std::min<int>(&v3, v7);\n    }\n  }\n  else\n  {\n    v6 = G::MinV((G *)((char *)*(&G::num + (_DWORD)this) + 1), (int)*(&G::num + a2));\n    v3 = *(_DWORD *)std::min<int>(&v3, &v6);\n  }\n  return v3;\n}\nint G::DoIt()\n{\n  int v0; // eax\n  int v3; // eax\n  int v4; // [esp+8h] [ebp-24h]\n  int v5; // [esp+18h] [ebp-14h] BYREF\n  G *v6; // [esp+1Ch] [ebp-10h] BYREF\n  int i; // [esp+20h] [ebp-Ch]\n\n  for ( i = 0; G::m-- != 0; i ^= v0 )\n  {\n    scanf(\"%d%d\", &v6, &v5);\n    v0 = G::Find(v6, v5);\n  }\n  if ( pre && (G::n > 10 || G::m > 10) )\n    return puts(\"invalid input.\");\n  v3 = std::ostream::operator<<(&std::cout, i);\n  return std::ostream::operator<<(v3, &std::endl<char,std::char_traits<char>>, v4);\n}\nint G::Do()\n{\n  G *v1; // [esp+0h] [ebp-8h]\n  G *v2; // [esp+0h] [ebp-8h]\n\n  G::GetData(v1);\n  return G::DoIt(v2);\n}\n```\n\n\u540c\u7406\uff0c\u53d1\u73b0 `invalid input.` \u5728 `DoIt()` \u51fd\u6570\u91cc\uff0c\u6539\u5b83\uff01\n\n![image-20210126015116318](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126015116318.png)\n\n\u4fee\u6539\u540e\u6d41\u7a0b\u56fe\uff1a\n\n![image-20210126015202289](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126015202289.png)\n\n\u4fee\u6539\u540e\u4f2a\u4ee3\u7801\uff1a\n\n```cpp\nint G::DoIt()\n{\n  int v0; // eax\n  int v2; // eax\n  int v4; // [esp+8h] [ebp-24h]\n  int v5; // [esp+18h] [ebp-14h] BYREF\n  G *v6; // [esp+1Ch] [ebp-10h] BYREF\n  int i; // [esp+20h] [ebp-Ch]\n\n  for ( i = 0; G::m-- != 0; i ^= v0 )\n  {\n    scanf(\"%d%d\", &v6, &v5);\n    v0 = G::Find(v6, v5);\n  }\n  v2 = std::ostream::operator<<(&std::cout, i);\n  return std::ostream::operator<<(v2, &std::endl<char,std::char_traits<char>>, v4);\n}\n```\n\n\u51fa\u9898\u4eba\u516c\u5e03\u7684\u6e90\u4ee3\u7801\uff1a\n\n```cpp\nnamespace G\n{\n\tconst int N = 100500;\n\tconst int M = 270000;\n\tconst int T = 131072;\n\tconst int inf = 1987654321;\n\tint point[N],to[M],next[M],len[M],cc;\n\tint fa[N],falen[N],tot[N],depth[N];\n\tint num[N],top[N],numx[N];\n\tint n,m;\n\tint tree[M];\n\tvoid AddEdge(int x,int y,int z)\n\t{\n\t\tcc++;\n\t\tnext[cc]=point[x];\n\t\tpoint[x]=cc;\n\t\tto[cc]=y;\n\t\tlen[cc]=z;\n\t}\n\tvoid GetFa(int x)\n\t{\n\t\tdepth[x]=depth[fa[x]]+1;\n\t\ttot[x]=1;\n\t\tint now=point[x];\n\t\twhile(now)\n\t\t{\n\t\t\tint tox=to[now];\n\t\t\tif(tox!=fa[x])\n\t\t\t{\n\t\t\t\tfa[tox]=x;\n\t\t\t\tfalen[tox]=len[now];\n\t\t\t\tGetFa(tox);\n\t\t\t\ttot[x]+=tot[tox];\n\t\t\t}\n\t\t\tnow=next[now];\n\t\t}\n\t}\n\tvoid GetNum(int x,int grand,int v)\n\t{\n\t\tnum[x]=v;\n\t\tnumx[v]=x;\n\t\ttop[x]=grand;\n\t\tv++;\n\t\tint now=point[x];\n\t\tint prefer=0;\n\t\twhile(now)\n\t\t{\n\t\t\tint tox=to[now];\n\t\t\tif(tox!=fa[x] && tot[tox]>tot[prefer])\n\t\t\t\tprefer=tox;\n\t\t\tnow=next[now];\n\t\t}\n\t\tif(!prefer)\n\t\t\treturn;\n\t\tGetNum(prefer,grand,v);\n\t\tv+=tot[prefer];\n\t\tnow=point[x];\n\t\twhile(now)\n\t\t{\n\t\t\tint tox=to[now];\n\t\t\tif(tox!=fa[x] && tox!=prefer)\n\t\t\t{\n\t\t\t\tGetNum(tox,tox,v);\n\t\t\t\tv+=tot[tox];\n\t\t\t}\n\t\t\tnow=next[now];\n\t\t}\n\t}\n\tvoid GetData()\n\t{\n\t\tint i;\n\t\tscanf(\"%d%d\",&n,&m);\n\t\tmemset(point,0,sizeof point);\n\t\tcc=0;\n\t\tfor(i=1;i<n;i++)\n\t\t{\n\t\t\tint a,b,c;\n\t\t\tscanf(\"%d%d%d\",&a,&b,&c);\n\t\t\tAddEdge(a,b,c);\n\t\t\tAddEdge(b,a,c);\n\t\t}\n\t\tGetFa(1);\n\t\tGetNum(1,1,1);\n\t\tfor(i=1;i<=n;i++)\n\t\t\ttree[i+T]=falen[numx[i]];\n\t\tfor(i=T-1;i>=1;i--)\n\t\t\ttree[i]=min(tree[i*2],tree[i*2+1]);\n\t}\n\tint MinV(int l,int r)\n\t{\n\t\tl+=T-1;\n\t\tr+=T+1;\n\t\tint res=inf;\n\t\twhile(l^r^1)\n\t\t{\n\t\t\tif(l%2==0)\n\t\t\t\tres=min(res,tree[l^1]);\n\t\t\tif(r%2==1)\n\t\t\t\tres=min(res,tree[r^1]);\n\t\t\tl>>=1;\n\t\t\tr>>=1;\n\t\t}\n\t\treturn res;\n\t}\n\tint Find(int x,int y)\n\t{\n\t\tint res=inf;\n\t\twhile(top[x]!=top[y])\n\t\t{\n\t\t\tif(depth[top[x]]>depth[top[y]])\n\t\t\t{\n\t\t\t\tres=min(res,MinV(num[top[x]],num[x]));\n\t\t\t\tx=fa[top[x]];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tres=min(res,MinV(num[top[y]],num[y]));\n\t\t\t\ty=fa[top[y]];\n\t\t\t}\n\t\t}\n\t\tif(depth[x]<depth[y])\n\t\t\tres=min(res,MinV(num[x]+1,num[y]));\n\t\telse if(depth[x]>depth[y])\n\t\t\tres=min(res,MinV(num[y]+1,num[x]));\n\t\treturn res;\n\t}\n\tvoid DoIt()\n\t{\n\t\tint ans=0;\n\t\twhile(m--)\n\t\t{\n\t\t\tint a,b;\n\t\t\tscanf(\"%d%d\",&a,&b);\n\t\t\tans^=Find(a,b);\n\t\t}\n\t\tif(pre)\n\t\t{\n\t\t\tif(n>10 || m>10)\n\t\t\t{\n\t\t\t\tprintf(\"invalid input.\\n\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\tvoid Do()\n\t{\n\t\tGetData();\n\t\tDoIt();\n\t}\n}\n```\n\n### Task H\n\n\u4f2a\u4ee3\u7801\uff1a\n\n```cpp\nint H::Do()\n{\n  __int64 v1; // rax\n  int v2; // ecx\n  unsigned __int64 v3; // rax\n  __int64 v4; // rax\n  int v5; // ecx\n  unsigned __int64 v6; // rax\n  int v7; // eax\n  int Format; // [esp+8h] [ebp-38h]\n  int v9; // [esp+18h] [ebp-28h] BYREF\n  int v10; // [esp+1Ch] [ebp-24h] BYREF\n  unsigned __int64 v11; // [esp+20h] [ebp-20h]\n  __int64 v12; // [esp+28h] [ebp-18h]\n  int j; // [esp+30h] [ebp-10h]\n  int i; // [esp+34h] [ebp-Ch]\n\n  scanf(\"%d%d\", &v10, &v9);\n  if ( pre && (v10 > 20 || v9 > 20) )\n    return puts(\"invalid input.\");\n  for ( i = 1; i <= v10; ++i )\n    H::val[i] = i;\n  for ( i = 1; i <= v10; ++i )\n  {\n    for ( j = 2 * i; j <= v10; j += i )\n      H::val[j] -= H::val[i];\n  }\n  v12 = 0i64;\n  for ( i = 1; i <= v10; ++i )\n  {\n    v11 = H::val[i];\n    v1 = v10 / i;\n    v2 = v1 * HIDWORD(v11) + HIDWORD(v1) * v11;\n    v3 = (unsigned int)v11 * (unsigned __int64)(unsigned int)v1;\n    LODWORD(v11) = v3;\n    HIDWORD(v11) = HIDWORD(v3) + v2;\n    v4 = v9 / i;\n    v5 = v4 * HIDWORD(v11) + HIDWORD(v4) * v11;\n    v6 = (unsigned int)v11 * (unsigned __int64)(unsigned int)v4;\n    HIDWORD(v6) += v5;\n    v11 = v6;\n    v12 += v6;\n  }\n  v7 = std::ostream::operator<<(&std::cout, v12, HIDWORD(v12));\n  return std::ostream::operator<<(v7, &std::endl<char,std::char_traits<char>>, Format);\n}\n```\n\n\u5728\u6d41\u7a0b\u56fe\u4e2d\u6b64\u5206\u652f\u8f83\u5206\u6563\uff0c\u4e0d\u592a\u597d\u627e\uff0c\u4e0d\u8fc7\u627e\u5230\u9000\u51fa\u4ee3\u7801\u540e\u5f80\u4e0a\u53cd\u63a8\u4e5f\u80fd\u5f88\u5bb9\u6613\u627e\u5230\n\n![image-20210126020200902](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126020200902.png)\n\n\u4fee\u6539\u540e\u6d41\u7a0b\u56fe\uff1a\n\n![image-20210126020254049](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126020254049.png)\n\n\u4fee\u6539\u540e\u4f2a\u4ee3\u7801\u5c31\u4e0d\u653e\u4e86\uff0c\u5c31\u662f\u628a `invalid input.` \u53bb\u4e86\u3002\n\n\u51fa\u9898\u4eba\u516c\u5e03\u7684\u6e90\u4ee3\u7801\uff1a\n\n```cpp\nnamespace H\n{\n\tconst int N = 1005000;\n\tint val[N];\n\tvoid Do()\n\t{\n\t\tint n,m,i,j;\n\t\tscanf(\"%d%d\",&n,&m);\n\t\tif(pre)\n\t\t{\n\t\t\tif(n>20 || m>20)\n\t\t\t{\n\t\t\t\tprintf(\"invalid input.\\n\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tfor(i=1;i<=n;i++)\n\t\t\tval[i]=i;\n\t\tfor(i=1;i<=n;i++)\n\t\t{\n\t\t\tfor(j=i+i;j<=n;j+=i)\n\t\t\t\tval[j]-=val[i];\n\t\t}\n\t\tlong long ans=0;\n\t\tfor(i=1;i<=n;i++)\n\t\t{\n\t\t\tlong long now=val[i];\n\t\t\tnow*=(n/i);\n\t\t\tnow*=(m/i);\n\t\t\tans+=now;\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}\n```\n\n### Task I\n\n```cpp\nbool __cdecl I::cmp(I *this, int a2)\n{\n  return I::xu[(_DWORD)this] < I::xu[a2];\n}\n\nint I::Do()\n{\n  int *v2; // ecx\n  int v3; // eax\n  int *v4; // ecx\n  int v5; // eax\n  int *v7; // eax\n  int v8; // eax\n  int Format; // [esp+8h] [ebp-38h]\n  int v10; // [esp+18h] [ebp-28h] BYREF\n  int v11; // [esp+1Ch] [ebp-24h] BYREF\n  __int64 v12; // [esp+20h] [ebp-20h]\n  int v13; // [esp+2Ch] [ebp-14h]\n  int v14; // [esp+30h] [ebp-10h]\n  int i; // [esp+34h] [ebp-Ch]\n\n  scanf(\"%d\", &I::n);\n  for ( i = 1; i <= I::n; ++i )\n    scanf(\"%d\", &I::xu[i]);\n  I::xu[I::n + 1] = 0;\n  if ( pre && (I::n <= 0 || I::n > 10) )\n    return puts(\"invalid input.\");\n  for ( i = 1; i <= I::n; ++i )\n    I::sa[i] = i;\n  std::sort<int *,bool (*)(int,int)>(&unk_1AAAD84, &I::sa[I::n + 1], I::cmp);\n  v13 = 0;\n  for ( i = 1; i <= I::n; ++i )\n  {\n    for ( I::rank[I::sa[i]] = ++v13; i < I::n && I::xu[I::sa[i]] == I::xu[I::sa[i + 1]]; I::rank[I::sa[i]] = v13 )\n      ++i;\n  }\n  v14 = 1;\n  while ( v13 < I::n )\n  {\n    for ( i = 1; i <= I::n; ++i )\n      ++I::cc[I::rank[i + v14]];\n    for ( i = 1; i <= v13; ++i )\n      I::cc[i] += I::cc[i - 1];\n    for ( i = 1; i <= I::n; ++i )\n    {\n      v2 = &I::cc[I::rank[i + v14]];\n      v3 = *v2;\n      I::sec[v3] = i;\n      *v2 = v3 - 1;\n    }\n    for ( i = 0; i <= v13; ++i )\n      I::cc[i] = 0;\n    for ( i = 1; i <= I::n; ++i )\n      ++I::cc[I::rank[i]];\n    for ( i = 1; i <= v13; ++i )\n      I::cc[i] += I::cc[i - 1];\n    for ( i = I::n; i > 0; --i )\n    {\n      v4 = &I::cc[I::rank[I::sec[i]]];\n      v5 = *v4;\n      I::sa[v5] = I::sec[i];\n      *v4 = v5 - 1;\n    }\n    for ( i = 0; i <= v13; ++i )\n      I::cc[i] = 0;\n    v13 = 0;\n    for ( i = 1; i <= I::n; ++i )\n    {\n      for ( I::sec[I::sa[i]] = ++v13;\n            i < I::n\n         && I::rank[I::sa[i]] == I::rank[I::sa[i + 1]]\n         && I::rank[I::sa[i] + v14] == I::rank[I::sa[i + 1] + v14];\n            I::sec[I::sa[i]] = v13 )\n      {\n        ++i;\n      }\n    }\n    for ( i = 1; i <= I::n; ++i )\n      I::rank[i] = I::sec[i];\n    v14 *= 2;\n  }\n  for ( i = 1; i <= I::n; ++i )\n  {\n    if ( I::rank[i] != 1 )\n    {\n      v10 = I::h[i - 1] - 1;\n      v11 = 0;\n      v7 = (int *)std::max<int>(&v11, &v10);\n      for ( I::h[i] = *v7; I::xu[I::h[i] + i] == I::xu[I::sa[I::rank[i] - 1] + I::h[i]]; ++I::h[i] )\n        ;\n    }\n  }\n  v12 = 0i64;\n  for ( i = 1; i <= I::n; ++i )\n    v12 += i;\n  for ( i = 1; i <= I::n; ++i )\n    v12 -= I::h[i];\n  v8 = std::ostream::operator<<(&std::cout, v12, HIDWORD(v12));\n  return std::ostream::operator<<(v8, &std::endl<char,std::char_traits<char>>, Format);\n}\n```\n\n![image-20210126100737392](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126100737392.png)\n\n\u4fee\u6539\u540e\u6d41\u7a0b\u56fe\uff1a\n\n![image-20210126100854559](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126100854559.png)\n\n\u51fa\u9898\u4eba\u516c\u5e03\u7684\u6e90\u4ee3\u7801\uff1a\n\n```cpp\nnamespace I\n{\n\tconst int N = 1000500;\n\tconst int M = 2000500;\n\tint n;\n\tint xu[N];\n\tint sa[N],rank[M],sec[N],cc[N];\n\tint h[N];\n\tbool cmp(int x,int y)\n\t{\n\t\treturn(xu[x]<xu[y]);\n\t}\n\tvoid Do()\n\t{\n\t\tint i,j;\n\t\tint p;\n\t\tscanf(\"%d\",&n);\n\t\tfor(i=1;i<=n;i++)\n\t\t\tscanf(\"%d\",&xu[i]);\n\t\txu[n+1]=0;\n\t\tmemset(h,0,sizeof h);\n\t\tmemset(sec,0,sizeof sec);\n\t\tmemset(rank,0,sizeof rank);\n\t\tmemset(sa,0,sizeof sa);\n\t\tif(pre)\n\t\t{\n\t\t\tif(n<1 || n>10)\n\t\t\t{\n\t\t\t\tprintf(\"invalid input.\\n\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tfor(i=1;i<=n;i++)\n\t\t\tsa[i]=i;\n\t\tsort(sa+1,sa+n+1,cmp);\n\t\tp=0;\n\t\tfor(i=1;i<=n;i++)\n\t\t{\n\t\t\tp++;\n\t\t\trank[sa[i]]=p;\n\t\t\twhile(i<n && xu[sa[i]]==xu[sa[i+1]])\n\t\t\t{\n\t\t\t\ti++;\n\t\t\t\trank[sa[i]]=p;\n\t\t\t}\n\t\t}\n\t\tfor(j=1;p<n;j<<=1)\n\t\t{\n\t\t\tfor(i=1;i<=n;i++)\n\t\t\t\tcc[rank[i+j]]++;\n\t\t\tfor(i=1;i<=p;i++)\n\t\t\t\tcc[i]+=cc[i-1];\n\t\t\tfor(i=1;i<=n;i++)\n\t\t\t\tsec[cc[rank[i+j]]--]=i;\n\t\t\tfor(i=0;i<=p;i++)\n\t\t\t\tcc[i]=0;\n\t\t\tfor(i=1;i<=n;i++)\n\t\t\t\tcc[rank[i]]++;\n\t\t\tfor(i=1;i<=p;i++)\n\t\t\t\tcc[i]+=cc[i-1];\n\t\t\tfor(i=n;i>=1;i--)\n\t\t\t\tsa[cc[rank[sec[i]]]--]=sec[i];\n\t\t\tfor(i=0;i<=p;i++)\n\t\t\t\tcc[i]=0;\n\t\t\tp=0;\n\t\t\tfor(i=1;i<=n;i++)\n\t\t\t{\n\t\t\t\tp++;\n\t\t\t\tsec[sa[i]]=p;\n\t\t\t\twhile(i<n && rank[sa[i]]==rank[sa[i+1]] && rank[sa[i]+j]==rank[sa[i+1]+j])\n\t\t\t\t{\n\t\t\t\t\ti++;\n\t\t\t\t\tsec[sa[i]]=p;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(i=1;i<=n;i++)\n\t\t\t\trank[i]=sec[i];\n\t\t}\n\t\tfor(i=1;i<=n;i++)\n\t\t{\n\t\t\tif(rank[i]==1)\n\t\t\t\tcontinue;\n\t\t\th[i]=max(0,h[i-1]-1);\n\t\t\twhile(xu[i+h[i]]==xu[sa[rank[i]-1]+h[i]])\n\t\t\t\th[i]++;\n\t\t}\n\t\tlong long ans=0;\n\t\tfor(i=1;i<=n;i++)\n\t\t\tans+=i;\n\t\tfor(i=1;i<=n;i++)\n\t\t\tans-=h[i];\n\t\tcout<<ans<<endl;\n\t}\n}\n```\n\n### Task J\n\n\u4f2a\u4ee3\u7801\uff1a\n\n```cpp\nbool J::cmpx(J *this, Node a2, Node a3, int a4, ...)\n{\n  double v5[2]; // [esp+0h] [ebp-30h] BYREF\n  double v6[2]; // [esp+10h] [ebp-20h] BYREF\n  __int128 v7; // [esp+48h] [ebp+18h] BYREF\n  va_list va; // [esp+48h] [ebp+18h]\n  va_list va1; // [esp+58h] [ebp+28h] BYREF\n\n  va_start(va1, a4);\n  va_start(va, a4);\n  v7 = va_arg(va1, _OWORD);\n  qmemcpy(v6, &this, sizeof(v6));\n  qmemcpy(v5, va, sizeof(v5));\n  return v5[0] > v6[0];\n}\n\nbool J::cmpy(J *this, Node a2, Node a3, int a4, ...)\n{\n  double v5[2]; // [esp+0h] [ebp-30h] BYREF\n  double v6[2]; // [esp+10h] [ebp-20h] BYREF\n  __int128 v7; // [esp+48h] [ebp+18h] BYREF\n  va_list va; // [esp+48h] [ebp+18h]\n  va_list va1; // [esp+58h] [ebp+28h] BYREF\n\n  va_start(va1, a4);\n  va_start(va, a4);\n  v7 = va_arg(va1, _OWORD);\n  qmemcpy(v6, &this, sizeof(v6));\n  qmemcpy(v5, va, sizeof(v5));\n  return v5[1] > v6[1];\n}\n\ndouble J::dis(J *this, Node a2, Node a3, int a4, ...)\n{\n  double v5[2]; // [esp+20h] [ebp-48h] BYREF\n  double v6[2]; // [esp+30h] [ebp-38h] BYREF\n  double X; // [esp+48h] [ebp-20h]\n  __int128 v8; // [esp+80h] [ebp+18h] BYREF\n  va_list va; // [esp+80h] [ebp+18h]\n  va_list va1; // [esp+90h] [ebp+28h] BYREF\n\n  va_start(va1, a4);\n  va_start(va, a4);\n  v8 = va_arg(va1, _OWORD);\n  qmemcpy(v6, &this, sizeof(v6));\n  qmemcpy(v5, va, sizeof(v5));\n  X = (v6[0] - v5[0]) * (v6[0] - v5[0]) + (v6[1] - v5[1]) * (v6[1] - v5[1]);\n  return sqrt(X);\n}\n//Solve\u548cDo\u51fd\u6570\u7531\u4e8e\u51fd\u6570\u53c2\u6570\u65e0\u6cd5\u8bc6\u522b\uff0c\u51fd\u6570\u751f\u6210\u4f2a\u4ee3\u7801\u5931\u8d25\n```\n\n\u6ca1\u4e8b\uff0c\u6709\u6d41\u7a0b\u56fe\u4e5f\u591f\u4e86\n\n![image-20210126102657100](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126102657100.png)\n\n\u4fee\u6539\u540e\u6d41\u7a0b\u56fe\uff1a\n\n![image-20210126102731925](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126102731925.png)\n\n\u51fa\u9898\u4eba\u516c\u5e03\u7684\u6e90\u4ee3\u7801\uff1a\n\n```cpp\nnamespace J\n{\n\tconst int N = 1005000;\n\tstruct Node\n\t{\n\t\tdouble zx,zy;\n\t}xu[N],zhan[N],jie[N];\n\tint top;\n\tint n;\n\tdouble ans;\n\tbool cmpx(struct Node x,struct Node y)\n\t{\n\t\treturn (x.zx<y.zx);\n\t}\n\tbool cmpy(struct Node x,struct Node y)\n\t{\n\t\treturn x.zy<y.zy;\n\t}\n\tdouble dis(struct Node x,struct Node y)\n\t{\n\t\tdouble res=(x.zx-y.zx)*(x.zx-y.zx)+(x.zy-y.zy)*(x.zy-y.zy);\n\t\tres=sqrt(res);\n\t\treturn res;\n\t}\n\tvoid Solve(int l,int r)\n\t{\n\t\tif(l==r)\n\t\t\treturn;\n\t\tint mid=(l+r)>>1;\n\t\tdouble zhong=xu[mid].zx;\n\t\tSolve(l,mid);\n\t\tSolve(mid+1,r);\n\t\ttop=0;\n\t\tint i=l,j=mid+1,k=l;\n\t\twhile(i<=mid && j<=r)\n\t\t{\n\t\t\tif(xu[i].zy<xu[j].zy)\n\t\t\t{\n\t\t\t\tjie[k++]=xu[i];\n\t\t\t\tif(zhong-xu[i].zx<ans)\n\t\t\t\t\tzhan[++top]=xu[i];\n\t\t\t\ti++;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tjie[k++]=xu[j];\n\t\t\t\tif(xu[j].zx-zhong<ans)\n\t\t\t\t\tzhan[++top]=xu[j];\n\t\t\t\tj++;\n\t\t\t}\n\t\t}\n\t\twhile(i<=mid)\n\t\t{\n\t\t\tjie[k++]=xu[i];\n\t\t\tif(zhong-xu[i].zx<ans)\n\t\t\t\tzhan[++top]=xu[i];\n\t\t\ti++;\n\t\t}\n\t\twhile(j<=r)\n\t\t{\n\t\t\tjie[k++]=xu[j];\n\t\t\tif(xu[j].zx-zhong<ans)\n\t\t\t\tzhan[++top]=xu[j];\n\t\t\tj++;\n\t\t}\n\t\tfor(i=l;i<=r;i++)\n\t\t\txu[i]=jie[i];\n\t\tfor(i=1;i<=top;i++)\n\t\t{\n\t\t\tfor(j=i+1;j<=i+5 && j<=top;j++)\n\t\t\t{\n\t\t\t\tdouble now=dis(zhan[i],zhan[j]);\n\t\t\t\tif(now<ans)\n\t\t\t\t\tans=now;\n\t\t\t}\n\t\t}\n\t}\n\tvoid Do()\n\t{\n\t\tint i;\n\t\tscanf(\"%d\",&n);\n\t\tfor(i=1;i<=n;i++)\n\t\t\tscanf(\"%lf%lf\",&xu[i].zx,&xu[i].zy);\n\t\tif(pre)\n\t\t{\n\t\t\tif(n<2 || n>10)\n\t\t\t{\n\t\t\t\tprintf(\"invalid input.\\n\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tsort(xu+1,xu+n+1,cmpx);\n\t\tans=dis(xu[1],xu[2]);\n\t\tSolve(1,n);\n\t\tprintf(\"%.3f\\n\",ans);\n\t}\n}\n```\n\n### Task K\n\n\u4f2a\u4ee3\u7801\uff1a\n\n```cpp\nint K::Do()\n{\n  return puts(\"invalid input!\");\n}\n```\n\n\u4e0d\u7528\u770b\u6d41\u7a0b\u56fe\u4e86\uff0c \u7b54\u6848\u5c31\u662f `puts(\"invalid input!\");`\u3002\n\n\u51fa\u9898\u4eba\u516c\u5e03\u7684\u6e90\u4ee3\u7801\uff1a\n\n```cpp\nnamespace K\n{\n\tvoid Do()\n\t{\n\t\tprintf(\"invalid input!\\n\");\n\t}\n}\n```\n\n---------------------\n\n\u7a0b\u5e8f\u4fee\u6539\u5b8c\u6210\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u9700\u8981\u5bfc\u51fa\u7834\u89e3\u540e\u7684\u7a0b\u5e8f\u3002\n\n![image-20210126110916930](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126110916930.png)\n\n`Edit->Patch program->Apply patches to input file`\n\n\u4f1a\u8986\u76d6\u6e90\u7a0b\u5e8f\uff0c\u5efa\u8bae\u52fe\u9009\u751f\u6210\u5907\u4efd\u6587\u4ef6\n\n![image-20210126103138179](https://gitee.com/tuxiaobei/oi/raw/master/images/image-20210126103138179.png)\n\n\u70b9\u51fb `OK` \u5373\u53ef\u3002\n\n\u751f\u6210\u7b54\u6848\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nchar s[256];\nint main()\n{\n\tfor (int i = 1; i <= 10; i++) {\n\t\tsprintf(s, \"lost.exe < input%d.txt > output%d.txt\", i , i);\n\t\tsystem(s);\n\t}\n}\n```\n\n\u4e0d\u8fc7\u8fd9\u6837\u63d0\u4ea4\u5728 `#8` \u4f1a\u6709\u4e24\u4e2a\u6570\u636e\u7b54\u6848\u9519\u8bef\uff0c\u53ea\u80fd\u5f97\u5230 $98$ \u5206\uff08\u5e94\u8be5\u662f\u51fa\u9898\u4eba\u7684\u7a0b\u5e8f\u51fa\u9505\u4e86\n\n~~10 \u5206\u949f\u5207\u9ed1\u9898\u6210\u4e3a\u53ef\u80fd~~\n\n\u5b8c\u7ed3\u6492\u82b1\uff01",
        "postTime": 1611630256,
        "uid": 148050,
        "name": "tuxiaobei",
        "ccfLevel": 7,
        "title": "[\u96c6\u8bad\u961f\u4e92\u6d4b2016] \u6d88\u5931\u7684\u6e90\u4ee3\u7801 - \u9898\u89e3"
    },
    {
        "content": "## Point 1\uff1a\n\n\u5b57\u7b26\u4e32\u6620\u5c04\u3002\n\n```cpp\n//\u6620\u5c04\n#include<bits/stdc++.h>\nchar a[233],s[2333333];\nint main(){\n\tfreopen(\"input1.txt\",\"r\",stdin);\n\tfreopen(\"output1.txt\",\"w\",stdout);\n\ta['a']='y';\n\ta['b']='f';\n\ta['c']='r';\n\ta['d']='b';\n\ta['e']='k';\n\ta['f']='g';\n\ta['g']='i';\n\ta['h']='m';\n\ta['i']='u';\n\ta['j']='j';\n\ta['k']='v';\n\ta['l']='p';\n\ta['m']='h';\n\ta['n']='a';\n\ta['o']='t';\n\ta['p']='d';\n\ta['q']='s';\n\ta['r']='n';\n\ta['s']='e';\n\ta['t']='l';\n\ta['u']='o';\n\ta['v']='z';\n\ta['w']='c';\n\ta['x']='x';\n\ta['y']='w';\n\ta['z']='q';\n\tint T;\n\tscanf(\"%*d%d\",&T);\n\twhile(T--){\n\t\tscanf(\"%s\",s);\n\t\tfor(int i=0;s[i];++i)s[i]=a[s[i]];\n\t\tputs(s);\n\t}\n\treturn 0;\n}\n```\n\n## Point 2\uff1a\n\n\u662f\u4e2a\u4e8c\u6b21\u591a\u9879\u5f0f\uff0c\u5e26\u53d6\u6a21\u3002\u9012\u63a8\u5f0f\u89c1\u4ee3\u7801\u6ce8\u91ca\u3002\n\n```cpp\n//a0=10,a1=10+2020 a2=a1+4032+2020 a3=a2+4032*2+2020 ...(mod 233333)\n#include<cstdio>\nint main(){\n\tfreopen(\"input2.txt\",\"r\",stdin);\n\tfreopen(\"output2.txt\",\"w\",stdout);\n\tint T;\n\tscanf(\"%*d%d\",&T);\n\twhile(T--){\n\t\tint n;\n\t\tscanf(\"%d\",&n);\n\t\tlong long ans=n*2020LL+10;\n\t\tans+=(n-1LL)*n/2%233333*4032;\n\t\tprintf(\"%d\\n\",ans%233333);\n\t}\n\treturn 0;\n}\n```\n\n## Point 3\uff1a\n\n$$\\lfloor\\sqrt{\\frac{n}{\\pi}}\\rfloor$$\n\n```cpp\n//sqrt(n/pi)\n#include<cmath>\n#include<cstdio>\nconst double pi=acos(-1);\nint main(){\n\tfreopen(\"input3.txt\",\"r\",stdin);\n\tfreopen(\"output3.txt\",\"w\",stdout);\n\tint T;scanf(\"%*d%d\",&T);\n\twhile(T--){\n\t\tint a;scanf(\"%d\",&a);\n\t\tprintf(\"%d\\n\",(int)sqrt(a/pi));\n\t}\n\treturn 0;\n}\n```\n\n## Point 4\uff1a\n\n\u6c42\u6bcf\u4e2a\u8fde\u901a\u5757\u5927\u5c0f\u7684\u5e73\u65b9\u7684\u548c\u3002\n\n```cpp\n#include<cstdio>\nint fa[233333],n,m,sz[233333];\nint find(int x){return x==fa[x]?x:fa[x]=find(fa[x]);}\nint main(){\n\tfreopen(\"input4.txt\",\"r\",stdin);\n\tfreopen(\"output4.txt\",\"w\",stdout);\n\tint T;\n\tscanf(\"%*d%d\",&T);\n\twhile(T--){\n\t\tscanf(\"%d%d\",&n,&m);\n\t\tfor(int i=1;i<=n;++i)sz[i]=1,fa[i]=i;\n\t\twhile(m--){\n\t\t\tint x,y;scanf(\"%d%d\",&x,&y);\n\t\t\tif(find(x)!=find(y)){\n\t\t\t\tsz[find(y)]+=sz[find(x)];\n\t\t\t\tfa[find(x)]=find(y);\n\t\t\t}\n\t\t}\n\t\tlong long ans=0;\n\t\tfor(int i=1;i<=n;++i)if(i==find(i))\n\t\tans+=1LL*sz[i]*sz[i];\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n\n## Point 5\uff1a\n\n\u6bcf\u6b21\u8be2\u95ee\u5e26\u6743\u6811\u4e0a\u4e24\u70b9\u95f4\u8def\u5f84\u6743\u548c\u3002\u6bcf\u4e2a\u70b9\u7684\u7b54\u6848\u4e3a\u6240\u6709\u8be2\u95ee\u7684\u5f02\u6216\u548c\u3002\n\nLCA\u641e\u641e\u5c31\u597d\u4e86\u3002\n\n```cpp\n#include<cstdio>\n#include<cstring>\nconst int N=100005;\nint fa[N],sz[N],son[N],dep[N],head[N],top[N];\nlong long dis[N];\nstruct edge{\n\tint to,nxt,w;\n}e[N<<1];\nint cnt,n,m;\nvoid dfs(int now){\n\tsz[now]=1;son[now]=0;\n\tfor(int i=head[now];i;i=e[i].nxt)\n\tif(!dep[e[i].to]){\n\t\tdep[e[i].to]=dep[now]+1;\n\t\tfa[e[i].to]=now;\n\t\tdis[e[i].to]=dis[now]+e[i].w;\n\t\tdfs(e[i].to);\n\t\tsz[now]+=sz[e[i].to];\n\t\tif(!son[now]||sz[e[i].to]>sz[son[now]])son[now]=e[i].to;\n\t}\n}\nvoid dfs2(int now){\n\tif(son[now])top[son[now]]=top[now],dfs2(son[now]);\n\tfor(int i=head[now];i;i=e[i].nxt)\n\tif(dep[now]<dep[e[i].to]&&e[i].to!=son[now])\n\tdfs2(top[e[i].to]=e[i].to);\n}\ninline int LCA(int x,int y){\n\twhile(top[x]!=top[y])\n\tif(dep[top[x]]>dep[top[y]])x=fa[top[x]];else y=fa[top[y]];\n\treturn dep[x]<dep[y]?x:y; \n}\nint main(){\n\tfreopen(\"input5.txt\",\"r\",stdin);\n\tfreopen(\"output5.txt\",\"w\",stdout);\n\tint T;scanf(\"%*d%d\",&T);\n\twhile(T--){\n\t\tcnt=0;memset(head,0,sizeof head);\n\t\tscanf(\"%d%d\",&n,&m);\n\t\tlong long ans=0;\n\t\tfor(int i=1;i<n;++i){\n\t\t\tint u,v,w;scanf(\"%d%d%d\",&u,&v,&w);\n\t\t\te[++cnt]=(edge){v,head[u],w};\n\t\t\thead[u]=cnt;\n\t\t\te[++cnt]=(edge){u,head[v],w};\n\t\t\thead[v]=cnt;\n\t\t}\n\t\tmemset(dep,0,sizeof dep);\n\t\tdfs(dep[1]=1);dfs2(1);\n\t\twhile(m--){\n\t\t\tint x,y;\n\t\t\tscanf(\"%d%d\",&x,&y);\n\t\t\tans^=dis[x]+dis[y]-(dis[LCA(x,y)]<<1);\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n\n## Point 6\uff1a\n\n\u6bcf\u6b21\u8be2\u95ee\u4e24\u70b9\u6811\u4e0a\u8def\u5f84\u4e2d\u6700\u77ed\u7684\u8fb9\u6743\u957f\u5ea6\u3002\u82e5\u7ed9\u51fa\u4e24\u70b9\u4e3a\u540c\u4e00\u70b9\uff0c\u5219\u7b54\u6848\u4e3a1987654321\u3002\u6bcf\u4e2a\u70b9\u7684\u7b54\u6848\u4e3a\u6240\u6709\u8be2\u95ee\u7684\u5f02\u6216\u548c\u3002\n\n\u500d\u589e\u5373\u53ef\u3002\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nconst int N=200005;\nint fa[N],dep[N],head[N],mn[20][N],F[20][N];\nstruct edge{\n\tint to,nxt,w;\n}e[N<<1];\nint cnt,n,m;\nvoid dfs(int now){\n\tfor(int i=head[now];i;i=e[i].nxt)\n\tif(!dep[e[i].to]){\n\t\tdep[e[i].to]=dep[now]+1;\n\t\tfa[e[i].to]=now;\n\t\tF[0][e[i].to]=now;\n\t\tmn[0][e[i].to]=e[i].w;\n\t\tdfs(e[i].to);\n\t}\n}\ninline int ask(int x,int y){\n\tint ans=1987654321;\n\tif(dep[x]<dep[y])x^=y^=x^=y;\n\tfor(int i=19;~i;--i)\n\tif(dep[F[i][x]]>=dep[y])ans=std::min(ans,mn[i][x]),x=F[i][x];\n\tif(x==y)return ans;\n\tfor(int i=19;~i;--i)\n\tif(F[i][x]!=F[i][y])ans=std::min(ans,std::min(mn[i][x],mn[i][y])),x=F[i][x],y=F[i][y];\n\tans=std::min(ans,std::min(mn[0][x],mn[0][y]));\n\treturn ans;\n}\nint main(){\n\tfreopen(\"input6.txt\",\"r\",stdin);\n\tfreopen(\"output6.txt\",\"w\",stdout);\n\tint T;scanf(\"%*d%d\",&T);\n\twhile(T--){\n\t\tcnt=0;memset(head,0,sizeof head);\n\t\tscanf(\"%d%d\",&n,&m);\n\t\tlong long ans=0;\n\t\tfor(int i=1;i<n;++i){\n\t\t\tint u,v,w;scanf(\"%d%d%d\",&u,&v,&w);\n\t\t\te[++cnt]=(edge){v,head[u],w};\n\t\t\thead[u]=cnt;\n\t\t\te[++cnt]=(edge){u,head[v],w};\n\t\t\thead[v]=cnt;\n\t\t}\n\t\tmemset(F,0,sizeof F);\n\t\tmemset(mn,0,sizeof mn);\n\t\tmemset(dep,0,sizeof dep);\n\t\tdfs(dep[1]=1);\n\t\tfor(int i=1;i<20;++i)\n\t\tfor(int j=1;j<=n;++j)\n\t\tF[i][j]=F[i-1][F[i-1][j]],\n\t\tmn[i][j]=std::min(mn[i-1][j],mn[i-1][F[i-1][j]]);\n\t\twhile(m--){\n\t\t\tint x,y;\n\t\t\tscanf(\"%d%d\",&x,&y);\n\t\t\tans^=ask(x,y);\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n\n## Point 7\uff1a\n\n\u7ed9\u5b9a$n,m$\uff0c\u6c42$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m(i,j)$\u3002\n\n\u8f6c\u5316\u5f0f\u5b50\u4e3a\n\n$$\\sum_{d=1}^nd\\sum_{i=1}^{\\lfloor\\frac n d\\rfloor}\\sum_{j=1}^{\\lfloor\\frac m d\\rfloor}[(i,j)=1]$$\n\n\u5f53$n=m$\u65f6\uff0c\u539f\u5f0f\u7b49\u4e8e\n\n$$\\sum_{d=1}^nd(2(\\sum_{i=1}^{\\lfloor\\frac n d\\rfloor}\\varphi(i))-1)$$\n\n$n\\neq m$\u53ea\u6709\u4e00\u4e2a\u5f88\u5c0f\u7684\u70b9\uff0c\u66b4\u529b\u5373\u53ef\u3002\n\n\uff08\u5f53\u7136\u4e5f\u53ef\u4ee5\u53cd\u6f14\u4e86\u4e8b\uff09\n\n```cpp\n#include<cstdio>\n#include<algorithm>\ntypedef long long LL;\nint pri[1000005],isp[1000005],tot=0;\nLL phi[1000005];\nvoid sieve(){\n\tphi[1]=1;\n\tfor(int i=2;i<=1000005;++i){\n\t\tif(!isp[i])phi[pri[++tot]=i]=i-1;\n\t\tfor(int j=1;j<=tot&&i*pri[j]<=1000005;++j){\n\t\t\tisp[i*pri[j]]=1;\n\t\t\tif(i%pri[j])phi[i*pri[j]]=phi[i]*(pri[j]-1);else{\n\t\t\t\tphi[i*pri[j]]=phi[i]*pri[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=1000005;++i)phi[i]+=phi[i-1];\n}\nint main(){\n\tfreopen(\"input7.txt\",\"r\",stdin);\n\tfreopen(\"output7.txt\",\"w\",stdout);\n\tsieve();\n\tint T;\n\tscanf(\"%*d%d\",&T);\n\twhile(T--){\n\t\tint n,m;scanf(\"%d%d\",&n,&m);\n\t\tLL ans=0;\n\t\tif(n!=m){\n\t\t\tfor(int d=1;d<=n&&d<=m;++d)\n\t\t\tfor(int i=1;i<=n/d;++i)\n\t\t\tfor(int j=1;j<=m/d;++j)\n\t\t\tif(std::__gcd(i,j)==1)ans+=d;\n\t\t\tprintf(\"%lld\\n\",ans);\n\t\t\tcontinue;\n\t\t}\n\t\tfor(int d=1;d<=n;++d)\n\t\tans+=d*(2*phi[n/d]-1);\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n\n## Point 8\uff1a\n\n\u6709\u70b9\u96be\u89c2\u5bdfQAQ\n\n\u662f\u6c42\u672c\u8d28\u4e0d\u540c\u7684\u5b50\u4e32\u4e2a\u6570\u3002\n\nSA\u5373\u53ef\u3002\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nconst int N=1e6+7;\nint s[N],c[N],x[N],y[N],sa[N],height[N];\nint n;\nvoid sort(){\n\tint m=200;\n\tfor(int i=0;i<=m;++i)c[i]=0;\n\tfor(int i=1;i<=n;++i)++c[x[i]=s[i]];\n\tfor(int i=1;i<=m;++i)c[i]+=c[i-1];\n\tfor(int i=n;i;--i)sa[c[x[i]]--]=i;\n\tfor(int k=1;k<=n;k<<=1){\n\t\tint p=0;\n\t\tfor(int i=n-k+1;i<=n;++i)y[++p]=i;\n\t\tfor(int i=1;i<=n;++i)if(sa[i]>k)y[++p]=sa[i]-k;\n\t\tfor(int i=0;i<=m;++i)c[i]=0;\n\t\tfor(int i=1;i<=n;++i)++c[x[i]];\n\t\tfor(int i=1;i<=m;++i)c[i]+=c[i-1];\n\t\tfor(int i=n;i;--i)sa[c[x[y[i]]]--]=y[i];\n\t\tstd::swap(x,y);\n\t\tx[sa[1]]=p=1;\n\t\tfor(int i=2;i<=n;++i)\n\t\tx[sa[i]]=y[sa[i]]==y[sa[i-1]]&&y[sa[i]+k]==y[sa[i-1]+k]?p:++p;\n\t\tif(p==n)break;\n\t\tm=p;\n\t}\n\tfor(int i=1,k=0;i<=n;++i)\n\tif(x[i]>1){\n\t\tk-=!!k;\n\t\tint j=sa[x[i]-1];\n\t\twhile(s[i+k]==s[j+k])++k;\n\t\theight[x[i]]=k;\n\t}\n}\nint main(){\n\tfreopen(\"input8.txt\",\"r\",stdin);\n\tfreopen(\"output8.txt\",\"w\",stdout);\n\tint T;\n\tscanf(\"%*d%d\",&T);\n\twhile(T--){\n\t\tscanf(\"%d\",&n);\n\t\tfor(int i=1;i<=n;++i)scanf(\"%d\",s+i);\n\t\tsort();\n\t\tlong long ans=0;\n\t\tfor(int i=1;i<=n;++i)\n\t\tans+=std::max(n-sa[i]+1-height[i],0);\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n\n## Point 9\uff1a\n\n\u6c42\u5e73\u9762\u6700\u8fd1\u4e24\u70b9\u5bf9\u95f4\u8ddd\u79bb\u3002\n\n\u4eba\u7c7b\u667a\u6167\u6cd5\uff0c\u6392\u5e8f\u540e\u53ea\u8003\u8651\u5176\u540e\u9762500\u4e2a\u70b9\u7684\u8fde\u7ebf\u5373\u53ef\u3002\n\n```cpp\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\ntypedef long long LL;\nLL ans;\nstruct point{\n\tint x,y;\n\tinline bool operator<(const point&rhs)const{return x!=rhs.x?x<rhs.x:y<rhs.y;} \n}p[1000005];\ninline LL calc(int x,int y,int xx,int yy){return (x-xx)*(LL)(x-xx)+(y-yy)*(LL)(y-yy);}\nint main(){\n\tfreopen(\"input9.txt\",\"r\",stdin);\n\tfreopen(\"output9.txt\",\"w\",stdout);\n\tint T;scanf(\"%*d%d\",&T);\n\tfor(int t=1;t<=T;++t){\n\t\tans=1e18;\n\t\tint n;scanf(\"%d\",&n);\n\t\tfor(int i=1;i<=n;++i)\n\t\tscanf(\"%d%d\",&p[i].x,&p[i].y);\n\t\tstd::sort(p+1,p+n+1);\n\t\tfor(int i=1;i<=n;++i)\n\t\tfor(int j=i+1;j<=i+500;++j)\n\t\tans=std::min(ans,calc(p[i].x,p[i].y,p[j].x,p[j].y));\n\t\tprintf(\"%.3f\\n\",sqrt(ans));\n\t\tfprintf(stderr,\"OK: %d\\n\",t);\n\t}\n\treturn 0;\n}\n```\n\n## Point 10\uff1a\n\n...\n\n```cpp\n#include<cstdio>\nint main(){freopen(\"output10.txt\",\"w\",stdout);for(int i=1;i<11;++i)puts(\"invalid input!\");}\n```",
        "postTime": 1552023029,
        "uid": 6813,
        "name": "mrsrz",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5246 \u3010[\u96c6\u8bad\u961f\u4e92\u6d4b2016] \u6d88\u5931\u7684\u6e90\u4ee3\u7801\u3011"
    },
    {
        "content": "**\u58f0\u660e\uff1a\u7535\u8111\u4e3a Windows 10 \u7cfb\u7edf\uff0cIDA \u7248\u672c\u4e3a 7.5.201028\uff0c\u4e14\u4ee5\u4e0b\u5747\u4ee5 `lost.exe` \u4e3a\u4f8b\u3002**\n\n\u9996\u5148\u7528 [ExeinfoPE](https://down.52pojie.cn/?query=ExeinfoPe) \u6253\u5f00\uff1a\n\n![ExeinfoPE](https://cdn.luogu.com.cn/upload/image_hosting/d52kikxt.png)\n\n\u6ca1\u6709\u52a0\u58f3\uff0c\u5e76\u4e14\u662f 32 \u4f4d\u5e94\u7528\u7a0b\u5e8f\uff0c\u6240\u4ee5\u7528 32 \u4f4d [IDA](https://down.52pojie.cn/Tools/Disassemblers/) (ida.exe) \u6253\u5f00\uff1a\n\n![IDA](https://cdn.luogu.com.cn/upload/image_hosting/9hc7pngq.png)\n\n\u6309 $\\texttt{F5}$ \u8fdb\u5165\u4f2a\u4ee3\u7801\u6a21\u5f0f\uff1a\n\n![\u4f2a\u4ee3\u7801](https://cdn.luogu.com.cn/upload/image_hosting/tuhm2xa9.png)\n\n\u53ef\u4ee5\u770b\u5230\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u5faa\u73af\u3002\u8fdb\u5165 `Do` \u51fd\u6570\uff1a\n\n![Do](https://cdn.luogu.com.cn/upload/image_hosting/nshdhbcg.png)\n\n\u73b0\u5728\u5f00\u59cb\u5224\u65ad\u7c7b\u578b\u4e86\u3002\u8ba9\u6211\u4eec\u5206\u522b\u8fdb\u5165\u67e5\u770b\u3002\n\n# A::Do\n![A::Do](https://cdn.luogu.com.cn/upload/image_hosting/k7jww608.png)\n\n\u6700\u7b80\u5355\u7684 $\\text{A+B Problem}$\uff0c\u751a\u81f3\u6ca1\u6709 `invalid input` \u8f93\u51fa\u3002\u65e0\u9700\u4fee\u6539\u3002\n\n# B::Do\n![B::Do](https://cdn.luogu.com.cn/upload/image_hosting/6c9x2oi9.png)\n\n\u8fd9\u91cc\u51fa\u73b0 `invalid input.` \u4e86\u3002\u5355\u72ec\u6253\u5f00\u4e00\u4e2a\u4f2a\u4ee3\u7801\u7a97\u53e3\uff0c\u5355\u51fb\u53f3\u952e\uff0c\u70b9\u51fb $\\texttt{Syncronize with - IDA View-A, Hex View-1}$\uff0c\u9009\u62e9 `if ( pre && (v1 <= 0 || v1 > 10) )` \u8fd9\u4e00\u884c\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/v6xlfn3q.png)\n\n\u8fd9\u65f6\u53d8\u7eff\u7684\u5c31\u662f\u6761\u4ef6\u8bed\u53e5\u3002\u663e\u7136\uff0c\u53ea\u9700\u8981\u628a `test al, al` \u4e0b\u4e00\u884c\u7684 `jz` \u6539\u6210 `jmp` \u5c31\u884c\u4e86\uff08\u628a `test` \u6539\u6210 `xor` \u4e5f\u53ef\u4ee5\uff0c\u4e0b\u9762\u4e0d\u6f14\u793a\uff09\u3002\n\n\u5149\u6807\u79fb\u5230\u90a3\u4e00\u884c\uff0c\u70b9\u51fb $\\texttt{Edit - Patch program - Assemble...}$\uff0c\u628a `jz` \u6539\u6210 `jmp`\uff0c\u7136\u540e\u70b9\u51fb $\\texttt{OK}$\uff0c\u65b0\u5f39\u51fa\u7684\u7a97\u53e3\u70b9\u51fb $\\texttt{Cancel}$\u3002\n\n![\u6c47\u7f16](https://cdn.luogu.com.cn/upload/image_hosting/9jvvgjr1.png)\n\n\u4fee\u6539\u6210\u529f\u3002**C, D, E, H, I, J \u5747\u6309\u7167\u540c\u79cd\u65b9\u6cd5\u5904\u7406\u3002**\n\n# F::Do\n![F::Do](https://cdn.luogu.com.cn/upload/image_hosting/2ej1zume.png)\n\n\u8fd9\u6b21\u5206\u4e3a\u4e86\u4e24\u4e2a\u51fd\u6570\u8c03\u7528\u3002`GetData` \u4e2d\u5e76\u6ca1\u6709\u6761\u4ef6\u8bed\u53e5\uff0c\u6240\u4ee5\u8fdb\u5165 `DoIt` \u51fd\u6570\u3002\n\n![F::DoIt](https://cdn.luogu.com.cn/upload/image_hosting/pywfmbm4.png)\n\n\u73b0\u5728\u6309\u7167 B, C, D, E, H, I, J \u540c\u79cd\u65b9\u6cd5\u6765\u5904\u7406\u5c31\u884c\u4e86\u3002 **G \u6309\u7167\u540c\u79cd\u65b9\u6cd5\u5904\u7406\u3002**\n\n# K::Do\n![K::Do](https://cdn.luogu.com.cn/upload/image_hosting/gm0a2iqu.png)\n\n\u53ea\u6709\u8f93\u51fa\u4e00\u884c `invalid input!`\u3002\u6ce8\u610f\uff0c\u8fd9\u91cc\u4ece\u53e5\u53f7\u53d8\u6210\u4e86\u611f\u53f9\u53f7\u3002\u6839\u636e\u9898\u76ee\uff1a\n\n* \u5f53\u6570\u636e\u89c4\u6a21\u8f83\u5927\u65f6\uff0c\u5b83\u6216\u8bb8\u4e0d\u80fd\u6210\u529f\u8fd0\u884c\uff0c\u6b64\u65f6\u4f1a\u76f4\u63a5\u8f93\u51fa `invalid input.` **\uff08\u8fd9\u91cc\u662f\u53e5\u53f7\uff09**\n\n* \u53ea\u6709\u6570\u636e\u7ec4\u6570\u4e0d\u8d85\u8fc7\u4e00\u7ec4\u65f6\uff0c**\u4fdd\u8bc1** $\\texttt{lost}$ \u7684\u8f93\u51fa\u6b63\u786e\u3002\n\n\u6240\u4ee5\u7b54\u6848\u5c31\u662f\u8f93\u51fa `invalid input!`\uff0c\u4e0d\u7528\u4fee\u6539\u3002\n\n---\n\n\u4fee\u6539\u5b8c\u6bd5\uff0c\u70b9\u51fb $\\texttt{Edit - Patch program - Apply patches to input file...}$\u3002\n\n![Apply patches to input file](https://cdn.luogu.com.cn/upload/image_hosting/u7xvf6en.png)\n\n\u5176\u4ed6\u4e0d\u7528\u7ba1\uff0c\u4f46\u662f\u5efa\u8bae\u628a $\\texttt{Create backup}$ \u52fe\u4e0a\uff0c\u7136\u540e\u70b9\u51fb $\\texttt{OK}$\u3002\n\n---\n\n\u4fee\u6539\u5b8c\u6bd5\uff0c\u6267\u884c\u540e\u63d0\u4ea4\u8f93\u51fa\uff0c\u7136\u540e\uff1a\n\n![\u559c\u63d0 90pts](https://cdn.luogu.com.cn/upload/image_hosting/it8xdzgg.png)\n\n\u4e00\u770b\u8f93\u51fa\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ojg3q3cp.png)\n\n\u4e8e\u662f\u624b\u52a8\u6d4b\u4e00\u904d\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9a7vpg5v.png)\n\n\u8fd9\u4e0b\u57fa\u672c\u53ef\u4ee5\u786e\u5b9a\u662f\u591a\u7ec4\u6570\u636e\u7684\u521d\u59cb\u5316\u95ee\u9898\u4e86\u3002\u73b0\u5728\u7684\u89e3\u51b3\u65b9\u6848\u6709\uff1a\n\n1. \u4fee\u6539\u4ee3\u7801\uff0c\u52a0\u5165\u521d\u59cb\u5316\uff1b\n\n2. \u5c06\u6570\u636e\u62c6\u5206\u6210\u591a\u7ec4\u3002\n\n\u663e\u7136\u65b9\u6848 2 \u8981\u66f4\u7b80\u5355\u3002\u6211\u4eec\u5199\u4e00\u4e2a\u4ee3\u7801\uff1a\n\n```cpp\n#include <stdio.h>\n\nint main(){\n    freopen(\"input8.txt\", \"r\", stdin);\n    int T, n, x;\n    char buf[1024];\n    scanf(\"%d\", &T); scanf(\"%d\", &T);\n    for (int i = 1; i <= T; ++i){\n        sprintf(buf, \"input8-%d.txt\", i);\n        freopen(buf, \"w\", stdout);\n        scanf(\"%d\", &n); printf(\"8\\n1\\n%d\\n\", n);\n        for (; n; --n){\n            scanf(\"%d\", &x); printf(\"%d \", x);\n        }\n        fclose(stdout);\n    }\n    \n    \n    return 0;\n}\n```\n\n\u63a5\u7740\u6267\u884c cmd \u547d\u4ee4\uff1a\n\n```\ncopy /y nul output8.txt > nul && for /l %i in (1,1,10) do @lost < input8-%i.txt >> output8.txt\n```\n\n\u518d\u6b21\u63d0\u4ea4\uff0c\u5b8c\u7f8e AC\u3002\u8fd9\u6837\u6211\u4eec\u4e0d\u7528\u4efb\u4f55\u7b97\u6cd5\u5c31 AC \u4e86\u4e00\u9053\u9ed1\u9898\u3002",
        "postTime": 1644485715,
        "uid": 370281,
        "name": "m256i",
        "ccfLevel": 0,
        "title": "[\u9898\u89e3] P5246 [\u96c6\u8bad\u961f\u4e92\u6d4b 2016] \u6d88\u5931\u7684\u6e90\u4ee3\u7801"
    },
    {
        "content": "\u5927\u6982\u81ea\u5df1\u505a\u51fa\u4e86\u4e00\u534a\u5de6\u53f3\uff0c\u5199\u7bc7\u9898\u89e3\u6765\u8bb0\u5f55\u4e0b\u3002\n\n## subtask1\n\n\u53d1\u73b0\u6574\u4e2a\u8fc7\u7a0b\u8ddf\u5b57\u7b26\u4e32\u52a0\u5bc6\u5dee\u4e0d\u591a\uff0c\u4e00\u4e2a\u4e2a\u6253\u8868\u53ef\u4ee5\u53d1\u73b0\u662f\u8fd9\u6837\u4e00\u79cd\u5bf9\u5e94\u5173\u7cfb\uff1a\n\n`string str = \"yfrbkgimujvphatdsnelozcxwq\";`\n\n\u628a\u8f93\u5165\u7684\u4e00\u4f4d\u4f4d\u66ff\u6362\u5c31\u884c\u4e86\u3002\n\n## subtask2\n\n\u6253\u51fa\u524d $10$ \u4f4d\u7684\u8868\uff0c\u627e\u4e0d\u5230\u89c4\u5f8b\uff0c\u90a3\u5c31\u5dee\u5206\u3002\u8fd8\u662f\u627e\u4e0d\u5230\u89c4\u5f8b\uff0c\u518d\u5dee\u5206\uff0c\u53d1\u73b0\u5f97\u5230\u7684\u7ed3\u679c\u90fd\u662f $4032$\u3002\n\n\u731c\u60f3\u7b54\u6848\u662f\u5173\u4e8e $n$ \u7684\u591a\u9879\u5f0f\uff0c\u6709 $2016n(n-1)$ \u8fd9\u4e00\u9879\uff0c\u8fdb\u800c\u89e3\u5f97 $f(n)  =2016n(n-1) + 2020n+10$\u3002\n\n\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u62c9\u683c\u6717\u65e5\u63d2\u503c\u786c\u641e\u3002\n\n\u7136\u540e\u53d1\u73b0\u7b2c $11$ \u9879\u6bd4 $f(11)$ \u8981\u5c0f $233333$\uff0c\u4e8e\u662f\u731c\u6d4b\u6a21\u6570\u5c31\u662f $233333$ \u9a8c\u8bc1\u4e00\u4e0b\u53d1\u73b0\u662f\u5bf9\u7684\u3002\n\n## subtask3\n\n\u6bd4\u8f83\u795e\u79d8\u3002\n\n\u6253\u8868\u6253\u51fa\u524d $30$ \u9879\uff0c\u6254\u8fdb oeis \u91cc\uff0c\u4ed6\u4f1a\u544a\u8bc9\u4f60\u8f93\u51fa $\\sqrt{\\dfrac{n}{\\pi}}$ \u7684\u6574\u6570\u90e8\u5206\u3002\n\n## subtask4\n\n\u63a5\u4e0b\u6765\u8fd9 $3$ \u4e2a\u6bd4\u8f83\u7b80\u5355\u3002\n\n\u901a\u8fc7\u5c0f\u6570\u636e\u6d4b\u8bd5\u53d1\u73b0\u7b54\u6848\u662f\u56fe\u4e0a\u8fde\u901a\u5757\u5927\u5c0f\u7684\u5e73\u65b9\u548c\u3002\n\n## subtask5\n\n\u89c2\u5bdf\u8f93\u5165\u53d1\u73b0\u5927\u6982\u662f\u8fd9\u6837\u7684\u3002\n\n$n$ \u4e2a\u70b9\u7684\u6811\uff0c\u8fb9\u6709\u8fb9\u6743\uff0c$m$ \u6b21\u8be2\u95ee\u3002\n\n\u901a\u8fc7 $m=1$ \u7684\u5c1d\u8bd5\u53d1\u73b0\u8282\u70b9\u8ddd\u79bb\u4e3a\u8def\u5f84\u4e0a\u7684\u8fb9\u6743\u548c\u3002\u6269\u5927 $m$ \u53d1\u73b0\u8981\u628a $m$ \u6b21\u7684\u7ed3\u679c\u5f02\u6216\u8d77\u6765\u8f93\u51fa\u3002\n\n## subtask6\n\n\u8ddf\u4e0a\u9762\u4e00\u4e2a\u5dee\u4e0d\u591a\uff0c\u8282\u70b9\u8ddd\u79bb\u4e3a\u8def\u5f84\u4e0a\u7684\u8fb9\u6743\u6700\u5c0f\u503c\u3002\n\n\u7136\u540e\u6709\u4e00\u4e2a\u5f88\u6076\u5fc3\u7684\u5730\u65b9\u5c31\u662f\u81ea\u5df1\u8ddf\u81ea\u5df1\u7684\u8ddd\u79bb\u662f $1987654321$\u3002\n\n## subtask7\n\n\u6253\u51fa $10 \\times 10$ \u7684\u8868\uff0c\u6bcf\u884c oeis \u65e0\u679c\uff0c\u53d1\u73b0\u8f93\u5165\u5927\u591a\u662f $n=m$ \u5c31\u628a\u5bf9\u89d2\u7ebf\u4e0a\u7684\u6570\u6254\u8fdb oeis\uff0c\u53d1\u73b0\u662f\u5728\u6c42 $\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m gcd(i,j)$\u3002\n\n\u4ee3\u7801\u53c2\u8003 [P1390](https://www.luogu.com.cn/problem/P1390)\u3002\n\n## subtask8\n\n\u4e0d\u4f1a\u505a\uff0c\u662f\u8ba9\u4f60\u6c42\u4e0d\u540c\u5b50\u4e32\u4e2a\u6570\u3002\n\n\u4ee3\u7801\u53c2\u8003 [P2408](https://www.luogu.com.cn/problem/P2408)\u3002\n\n## subtask9\n\n\u8f93\u5165\u4e86\u4e00\u5806\u4e8c\u5143\u7ec4\uff0c\u7ecf\u8fc7\u5c0f\u6837\u4f8b\u7684\u4e0d\u65ad\u5c1d\u8bd5\u53d1\u73b0\u662f\u6c42\u5e73\u9762\u6700\u8fd1\u70b9\u5bf9\u3002\n\n\u4ee3\u7801\u53c2\u8003 [P1429](https://www.luogu.com.cn/problem/P1429)\u3002\n\n## subtask10\n\n\u56e0\u4e3a\u6211\u5728\u5199\u7684\u65f6\u5019\u6ca1\u505a\u51fa\u6765\u7684\u70b9\u90fd\u7528 `invalid input!` \u5360\u4f4d\uff0c\u7136\u540e\u53d1\u73b0\u8fc7\u4e86\u3002\n\n\u90a3\u4e48\u5c31\u662f\u8f93\u51fa $10$ \u4e2a `invalid input!`\u3002",
        "postTime": 1683182578,
        "uid": 302636,
        "name": "zhaoyp",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5246 \u3010[\u96c6\u8bad\u961f\u4e92\u6d4b 2016] \u6d88\u5931\u7684\u6e90\u4ee3\u7801\u3011"
    },
    {
        "content": "\u96c6\u8bad\u961f\u7684\u4eba\u5f97\u6709\u591a\u7b0b\u554a\uff0c\u5c71\u4e0a\u7684\u7b0b\u90fd\u7ed9\u4ed6\u4eec\u593a\u5149\u4e86\u3002  \n\u95f2\u8bdd\u5c11\u8bf4\uff0c\u5207\u5165\u6b63\u9898\u2014\u2014  \n\n---\n## Subtask1\n\u968f\u4fbf\u8f93\u5165\u51e0\u4e2a\u5b57\u7b26\u4e32\u5c31\u53ef\u4ee5\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u5b57\u7b26\u4e4b\u95f4\u7684\u6620\u5c04\u5173\u7cfb\u3002  \n\u6620\u5c04\u8868\u5982\u4e0b\uff1a  \n```\n\u539f\uff1aabcdefghijklmnopqrstuvwxyz\n\u6620\uff1ayfrbkgimujvphatdsnelozcxwq\n```\n\u4ee3\u7801\u4e5f\u5f88\u597d\u5199\uff1a  \n```cpp\n#include <iostream>\n#include <string>\n#include <cstdio>\nusing namespace std;\nstring key = \"yfrbkgimujvphatdsnelozcxwq\";\nint main() {\n\tfreopen(\"input1.txt\", \"r\", stdin);\n\tfreopen(\"output1.txt\", \"w\", stdout);\n\tstring str;\n\tint pika, n; cin >> pika >> n;\n\tfor(int p = 1; p <= n; p++) {\n\t\tcin >> str;\n\t\tfor(int i = 0; i < str.size(); i++)\n\t\t\tcout << key[str[i] - 'a'];\n\t\tcout << endl;\n\t}\n}\n```\n\n---\n## Subtask2\n\u770b\u5230\u6bcf\u884c\u53ea\u6709\u4e00\u4e2a\u6570\u5b57\uff0c\u5927\u7ea6\u662f\u4e2a\u6570\u5b66\u9898\u3002  \n\u8f93\u5165 $0 \\sim 10$ \u7684\u7ed3\u679c\u5982\u4e0b\uff1a \n```\n2030\n8082\n18166\n32282\n50430\n72610\n98822\n129066\n163342\n201650\n```\n\u5728 oeis \u4e0a\u627e\u4e0d\u5230\u8fd9\u4e2a\u6570\u5217\uff0c\u6240\u4ee5\u8981\u81ea\u5df1\u624b\u63a8\u89c4\u5f8b\uff08\u5927\u60b2   \n\u5bb9\u6613\u53d1\u73b0\u90bb\u9879\u4e4b\u5dee\u5206\u522b\u662f  \n$8082 - 2030 = 6052$  \n$18166 - 8082 = 10084$  \n$32282 - 18166 = 14116$   \n$50430 - 32282 = 18148$  \n\u73b0\u5728\u8c8c\u4f3c\u6ca1\u6709\u4ec0\u4e48\u89c4\u5f8b\u53ef\u8a00\uff0c\u4f46\u662f\u5dee\u4e0e\u5dee\u4e4b\u95f4\u5dee\u4e0d\u591a\u90fd\u76f8\u5dee $4000$ \u5de6\u53f3\uff0c\u53ea\u8981\u6211\u4eec\u5bf9\u5dee\u4e5f\u8fdb\u884c\u8fd9\u6837\u7684\u64cd\u4f5c\uff1a  \n$6052 - 2020 = 4032$  \n$10084 - 6052 = 4032$  \n$14116 - 10084 = 4032$    \n$18148 - 14116 = 4032$  \n\u6211\u4eec\u5c31\u4f1a\u53d1\u73b0\u4e8b\u5b9e\u4e0a\u8fd9\u662f\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\uff01  \n\u6545\u800c\u53ef\u4ee5\u5f97\u5230\u8ba1\u7b97\u5f0f\uff1a  \n$f_i = \\dfrac{(i-1)[12104 + 4032(i-2)]}{2} + 2030$  \n\u7b49\u7b49\uff0c\u8fd9\u4e48\u5927\u7684\u6570\u5b57\uff0c\u80af\u5b9a\u8981\u53d6\u4f59\u7684\uff01    \n\u6a21\u6570\u662f\u591a\u5c11\u5462\uff1f   \n\u6211\u4eec\u518d\u6765\u770b\u770b\u7b2c $11$ \u9879\uff1a  \n```\n10657\n```\n\u6bd4\u7b2c $10$ \u9879\u5c0f\uff0c\u53d6\u4f59\u4e86\u3002  \n\u6211\u4eec\u53ef\u4ee5\u7528\u8ba1\u7b97\u5668\u7b97\u51fa $f_{11} = 243990$\uff0c\u5bb9\u6613\u53d1\u73b0\u6a21\u6570\u662f $233333$\u3002  \n\u6211\u4eec\u7684\u516c\u5f0f\u4e5f\u8981\u6539\u4e00\u4e0b\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u5f0f\u5b50\u4e0d\u592a\u5bb9\u6613\u53d6\u4f59\u3002  \n$f_i = 6052(i - 1) + 2016(i - 1)(i - 2) + 2030$  \n```cpp\n#include <iostream>\n#include <cstdio>\n#define Mod 233333\nusing namespace std;\nint main() {\n\tfreopen(\"input2.txt\", \"r\", stdin);\n\tfreopen(\"output2.txt\", \"w\", stdout);\n\tint pika; cin >> pika;\n\tint T;\n\tcin >> T;\n\tunsigned long long i;\n\twhile(T--) {\n\t\tcin >> i;\n\t\tunsigned long long rest = (2030 + 6052 * (i - 1) % Mod + 2016 * ((i - 1) % Mod) % Mod * ((i - 2) % Mod) % Mod) % Mod;\n\t\tcout << rest << endl;\n\t}\n}\n```\n\n---\n## Subtask3\n\u770b\u4e0a\u53bb\u8fd8\u662f\u6570\u5b66\u9898\uff0c\u4f46\u662f\u8f93\u51fa\u6bd4\u8f83\u5c0f\u3002  \n\u8001\u89c4\u77e9\uff0c\u6253\u8868\u627e\u89c4\u5f8b\uff0c\u7136\u540e\u5148\u6254\u5230 OEIS \u4e0a\u627e\u627e\u3002  \n\u7ed3\u679c\u51fa\u4eba\u610f\u6599\uff0c\u8fd8\u771f\u771f\u662f\u80fd\u627e\u5230\u7684 [link](http://oeis.org/search?q=0+0+0+1+1+1+1+1+1+1+1+1+2+2+2+2+2+2+2+2+2+2+2+2+2+2+2+2+3+3+3+3+3+3+3+3+3+3+3+3+3+3+3+3+3+3+3+3+3+3&sort=&language=&go=Search)\u3002  \n\u5f97\u5230\u5341\u5206\u795e\u4ed9\u7684\u516c\u5f0f\uff1a$f_i = \\left\\lfloor \\sqrt{\\dfrac{i}{\\pi}}\\right\\rfloor$\u3002  \n\u4ee3\u7801\uff1a  \n```cpp\n#include <iostream>\n#include <cmath> \n#define MAXN 100000\n#define QWQ cout << \"QWQ\" << endl;\nusing namespace std;\nint main() {\n\tdouble pi = 3.1415926;\n\tint pika, T, x; cin >> pika >> T;\n\twhile(T--) {\n\t\tcin >> x;\n\t\tcout << floor(sqrt(((double)(x) / pi))) << endl;\n\t}\n}\n```\n\n---\n## Subtask 4\n\u5982\u679c\u8bf4\u6bcf\u884c\u4e24\u4e2a\u6570\u5b57\uff0c\u90a3\u4e48\u5f88\u53ef\u80fd\u662f DS \u6216\u8005\u662f\u56fe\u8bba\u9898\u3002  \n\u8fd9\u91cc\u9762\u6ca1\u6709\u539f\u5e8f\u5217\uff0c\u800c\u4e14\u6570\u5b57\u8f83\u5927\uff0c\u4e0d\u592a\u50cf\u6709 $opt$ \u7684\u6837\u5b50\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u76f2\u731c\u662f\u4e2a\u56fe\u8bba\u9898\u3002  \n\u81ea\u6d4b\u7b2c\u4e00\u7ec4\u6570\u636e\u548c\u4e00\u4e9b\u5c0f\u6570\u636e\uff0c\u5f88\u5bb9\u6613\u53d1\u73b0\u7b54\u6848\u662f\u56fe\u7684\u8fde\u901a\u5757\u5927\u5c0f\u5e73\u65b9\u548c\u3002  \n\u5e76\u67e5\u96c6\u968f\u4fbf\u7ef4\u62a4\u8fde\u901a\u6027\u5c31\u597d\u4e86\u3002  \n```cpp\n#include <iostream> \n#include <cstring>\n#include <cstdio>\n#define MAXN 100000\n#define QWQ cout << \"QWQ\" << endl;\nusing namespace std;\nstruct node {\n\tint to, next;\n} gra[MAXN * 2 + 10];\nint head[MAXN + 10], cl = 1, tot = 0;\nint t[MAXN + 10];\nvoid link(int x, int y) {\n\tgra[++tot].to = y, gra[tot].next = head[x], head[x] = tot;\n\tgra[++tot].to = x, gra[tot].next = head[y], head[y] = tot;\n}\nint fa[MAXN + 10];\nint Find(int x) {\n\tif(x == fa[x]) return x;\n\telse return fa[x] = Find(fa[x]);\n}\nvoid Union(int u, int v) {\n\tint U = Find(u), V = Find(v);\n\tif(U != V) fa[V] = U;\n}\n//\u5e76\u67e5\u96c6\u57fa\u64cd\nint main() {\n\tfreopen(\"input4.txt\", \"r\", stdin);\n\tfreopen(\"output4.txt\", \"w\", stdout);\n\tint pika; cin >> pika;\n\tint T; cin >> T;\n\twhile(T--) {\n\t\tmemset(t, 0, sizeof(t));//\u591a\u6d4b\u4e0d\u6e05\u7a7a\u89c1\u7956\u5b97\n\t\tint n, m; cin >> n >> m;\n\t\tfor(int p = 1; p <= n; p++)\n\t\t\tfa[p] = p;\n\t\tfor(int p = 1, x, y; p <= m; p++) {\n\t\t\tcin >> x >> y;\n\t\t\tUnion(x, y);//\u5408\u5e76\n\t\t}\n\t\tfor(int p = 1; p <= n; p++)\n\t\t\tt[Find(p)]++;//\u8ba1\u7b97\u6bcf\u4e2a\u8054\u901a\u5feb\u7684\u5927\u5c0f\n\t\tlong long ans = 0;\n\t\tfor(int p = 1; p <= n; p++)//\u6c42\u548c\uff0c\u4e0d\u5f00 long long \u89c1\u7956\u5b97\n\t\t\tans += (1ll * t[p] * 1ll * t[p]);\n\t\tcout << ans << endl;\n\t}\n}\n```\n\n---\n## Subtask 5\n\u8fd9\u73a9\u610f\u513f\u4e00\u5f00\u59cb\u6211\u771f\u6ca1\u770b\u51fa\u6765\u662f\u4ec0\u4e48\u73a9\u610f\u513f\u3002  \n\u53ea\u8981\u4f60\u628a\u6570\u636e\u7684\u7b2c\u4e00\u884c\u7684\u7b2c\u4e8c\u4e2a\u6570\u5b57\u8bbe\u4e3a $1$\uff0c\u4f60\u5c31\u80fd\u53d1\u73b0\u5176\u4e2d\u7684\u5965\u79d8\uff1a  \n- \u7b2c\u4e00\u4e2a\u6570\u5b57 $n$ \u662f\u8282\u70b9\u6570\uff0c\u540e\u9762\u7684\u662f\u67e5\u8be2\u7684\u6b21\u6570 $m$\u3002  \n- \u4e0b\u9762 $n - 1$ \u884c\u8f93\u5165\u4e00\u4e2a\u5e26\u6743\u6811\uff0c\u59cb\u7ec8\u662f\u4ee5 $1$ \u4e3a\u6839\u8282\u70b9\u7684\u3002  \n- \u7136\u540e\u4e0b\u9762 $m$ \u884c\u8f93\u5165\u4e24\u4e2a\u6570 $x,y$\uff0c\u67e5\u8be2\u6811\u4e0a\u8def\u5f84 $x$ \u5230 $y$ \u6743\u503c\u548c\u3002  \n\n\u4f46\u662f\u7b54\u6848\u4ec5\u4ec5\u8f93\u51fa\u4e00\u4e2a\uff0c\u80af\u5b9a\u662f\u5bf9\u67e5\u8be2\u7684\u4e1c\u897f\u8fdb\u884c\u4e86\u4e00\u4e9b\u64cd\u4f5c\uff0c\u56db\u5219\u8fd0\u7b97\u53d6\u4f59\u4f4d\u8fd0\u7b97\u5168\u505a\u4e00\u904d\u4f1a\u53d1\u73b0\u6700\u540e\u7684\u7b54\u6848\u662f\u67e5\u8be2\u7684\u5f02\u6216\u548c\u3002  \n\u7136\u540e\u5c31\u53ef\u4ee5\u8ba1\u7b97\u4e24\u70b9\u95f4\u7684\u8ddd\u79bb\u3002  \n\u8fd9\u4e2a\u5927\u5bb6\u5e94\u8be5\u90fd\u4f1a\u5427\uff0c$dis_x + dis_y - dis_{\\operatorname{lca(x, y)}}$\uff0c$dis_u$ \u4ee3\u8868 $u$ \u5230\u6839\u8282\u70b9\u7684\u8ddd\u79bb\u3002  \n\u4ee3\u7801\uff1a  \n```cpp\n#include <iostream>\n#include <cstring>\n#include <cstdio>\n#define QWQ cout << \"qwq\" << endl;\n#define MAXN 100000\nusing namespace std;//afdsadsfadsfDF\nstruct node {\n\tint to, next, val;\n} gra[MAXN * 2 + 10];\nint head[MAXN + 10], tot = 0;\nvoid link(int x, int y, int z) {\n\tgra[++tot].to = y, gra[tot].val = z;\n\tgra[tot].next = head[x], head[x] = tot;\n\tgra[++tot].to = x, gra[tot].val = 0;\n\tgra[tot].next = head[y], head[y] = tot;\n}\nvoid swap(int &x, int &y) {x ^= y ^= x ^= y;}\nlong long dis[MAXN + 10];\nint fa[MAXN + 10], son[MAXN + 10], de[MAXN + 10], ind[MAXN + 10], siz[MAXN + 10], top[MAXN + 10], cnt = 0;\nvoid dfs1(int u, int fat) {\n\tsiz[u] = 1, fa[u] = fat;\n\tint maxn = 0;\n\tfor(int p = head[u]; p; p = gra[p].next) {\n\t\tint v = gra[p].to, w = gra[p].val;\n\t\tif(v != fat) {\n\t\t\tde[v] = de[u] + 1;\n\t\t\tdis[v] = dis[u] + w;\n\t\t\tfa[v] = u;\n\t\t\tdfs1(v, u);\n\t\t\tsiz[u] += siz[v];\n\t\t\tif(dis[v] > maxn)\n\t\t\t\tmaxn = dis[v], son[u] = v;\n\t\t}\n\t}\n} \nvoid dfs2(int u, int T) {\n\tind[u] = ++cnt, top[u] = T;\n\tif(son[u]) dfs2(son[u], T);\n\telse return ;\n\tfor(int p = head[u]; p; p = gra[p].next) {\n\t\tint v = gra[p].to;\n\t\tif(v != fa[u] && v != son[u])\n\t\t\tdfs2(v, v);\n\t}\n}\nint get_lca(int x, int y) {\n\twhile(top[x] != top[y]) {\n\t\tif(de[top[x]] < de[top[y]]) swap(x, y);\n\t\tx = fa[top[x]];\n\t}\n\tif(de[x] > de[y]) swap(x, y);\n\treturn x;\n}\nlong long dist(int x, int y) {\n\treturn dis[x] + dis[y] - 2 * dis[get_lca(x, y)];\n}\nsigned main() {\n\tfreopen(\"input5.txt\", \"r\", stdin);\n\tfreopen(\"output5.txt\", \"w\", stdout);\n\tint pika, T; cin >> pika >> T; \n\twhile(T--) {\n\t\tmemset(head, 0, sizeof(head));\n\t\tmemset(dis, 0, sizeof(dis));\n\t\tmemset(ind, 0, sizeof(ind));\n\t\tmemset(fa, 0, sizeof(fa));\n\t\tmemset(son, 0, sizeof(son));\n\t\tmemset(siz, 0, sizeof(siz));\n\t\tmemset(top, 0, sizeof(top));\n\t\tcnt = 0;\n\t\tmemset(de, 0, sizeof(de));\n\t\tfor(int p = 1; p <= tot; p++)\n\t\t\tgra[p].next = gra[p].to = gra[p].val = 0;\n\t\ttot = 0;\n\t\tint n, m;\n\t\tscanf(\"%d%d\", &n, &m);\n\t\tfor(int p = 1, x, y, z; p < n; p++) {\n\t\t\tscanf(\"%d%d%d\", &x, &y, &z);\n\t\t\tlink(x, y, z);\n\t\t}\n\t\tde[1] = 1;\n\t\tdfs1(1, 0);\n\t\tdfs2(1, 0);\n\t\tlong long ans = 0;\n\t\tfor(int p = 1, x, y; p <= m; p++) {\n\t\t\tscanf(\"%d%d\", &x, &y);\n\t\t\tans ^= dist(x, y);\n\t\t}\n\t\tprintf(\"%lld\\n\", ans);\n\t}\n} \n```\n\n---\n## Subtask 6\n\u770b\u5230\u8fd9\u4e2a\u8f93\u5165\u6570\u636e\u548c Subtask 5 \u5f88\u76f8\u4f3c\uff0c\u5e94\u8be5\u662f\u6811\u4e0a\u70b9\u5bf9\u7684\u5176\u4ed6\u7684\u4e71\u641e\u3002  \n\u4ed4\u7ec6\u89c2\u5bdf\u53ef\u4ee5\u53d1\u73b0\u67e5\u8be2\u7684\u5e94\u8be5\u662f\u4e24\u70b9\u8def\u5f84\u4e2d\u6700\u5c0f\u7684\u4e00\u6761\u8fb9\u6743\uff0c\u7b54\u6848\u662f\u6240\u6709\u67e5\u8be2\u7684\u5f02\u6216\u548c\u3002  \n\u7136\u540e\u53ef\u4ee5\u6811\u4e0a\u500d\u589e\u4e71\u641e\u3002     \n\u6ce8\u610f\uff0c\u5982\u679c\u67e5\u8be2\u7684\u4e24\u4e2a\u70b9\u662f\u4e00\u6837\u7684\uff0c\u90a3\u4e48\u67e5\u8be2\u7684\u7ed3\u679c\u662f $1987654321$\u3002\n```cpp\n#include <iostream>\n#include <cstring>\n#define MAXN 100000\nusing namespace std;\nlong long min(long long x, long long y) {return ((x < y) ? (x) : (y));}\nvoid swap(int &x, int &y) {x ^= y ^= x ^= y;} \nstruct node {\n\tint to, next, val;\n} gra[MAXN * 2 + 10];\nlong long mi[MAXN + 10][30];\nint tot = 0, head[MAXN + 10], jump[MAXN + 10][30], de[MAXN + 10];\nvoid link(int x, int y, int z) {\n\tgra[++tot].to = y, gra[tot].val = z, gra[tot].next = head[x], head[x] = tot;\n\tgra[++tot].to = x, gra[tot].val = z, gra[tot].next = head[y], head[y] = tot; \n}\nvoid dfs(int u,int fa) {//dfs \u9884\u5904\u7406\n    de[u] = de[fa] + 1;\n    jump[u][0] = fa;\n    for(int p = 1; p <= 20; p++)\n        jump[u][p] = jump[jump[u][p - 1]][p - 1];\n    for(int p = head[u]; p; p = gra[p].next) {\n        int v = gra[p].to;\n        if(v != fa)\n            mi[v][0] = gra[p].val, dfs(v, u);\n    }\n}\nlong long get_mi(int a, int b) {//\u6c42\u8def\u5f84\u6700\u5c0f\n\tlong long fucking = 1987654321;\n    if(a == b) return fucking;\n    if(de[a] < de[b]) swap(a,b);\n    for(int p = 20; p >= 0; p--)\n        if(de[b] <= de[jump[a][p]])\n            fucking = min(mi[a][p], fucking), a = jump[a][p];\n    if(a == b) return fucking;\n    for(int p = 20; p >= 0; p--)\n        if(jump[a][p] != jump[b][p])\n            fucking = min(fucking, min(mi[a][p], mi[b][p])), a = jump[a][p], b = jump[b][p];\n    return min(fucking, min(mi[a][0], mi[b][0]));\n}\nint main() {\n\tfreopen(\"input6.txt\", \"r\", stdin);\n\tfreopen(\"output6.txt\", \"w\", stdout);\n\tint pika, T; cin >> pika >> T;\n\twhile(T--) {\n\t\tfor(int p = 1; p <= tot; p++)\n\t\t\tgra[p].next = gra[p].to = gra[p].val = 0;\n\t\ttot = 0;\n\t\tmemset(mi, 0, sizeof(mi));\n\t\tmemset(head, 0, sizeof(head));\n\t\tmemset(jump, 0, sizeof(jump));\n\t\tmemset(de, 0, sizeof(de));\n\t\tint n, m;\n\t\tcin >> n >> m;\n\t\tfor(int p = 1, x, y, z; p < n; p++) {\n\t\t\tcin >> x >> y >> z;\n\t\t\tlink(x, y, z);\n\t\t}\t\n\t\tde[1] = 1, dfs(1, 0);\n\t\tlong long ans = 0;\n\t\tfor(int i = 1; i <= 20; i++)//\u9884\u5904\u7406\u6700\u5c0f\u503c\u7684\u500d\u589e\u6570\u7ec4\u3002\n\t\t\tfor(int p = 1; p <= n; p++)\n\t\t\t\tmi[p][i] = min(mi[p][i - 1], mi[jump[p][i - 1]][i - 1]);\n\t\tfor(int p = 1, x, y; p <= m; p++) {\n\t\t\tcin >> x >> y;\n\t\t\tans ^= get_mi(x, y);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}\n```\n\n---\n## Subtask 7\n\u5168\u662f\u4e8c\u5143\u7ec4\uff0c\u5f7c\u6b64\u4e4b\u95f4\u4e5f\u6ca1\u6709\u4ec0\u4e48\u5173\u7cfb\uff0c\u5927\u6982\u662f\u4e2a\u6570\u5b66\u9898\u3002  \n\u901a\u8fc7~~OIer \u5929\u751f\u7684\u76f4\u89c9~~\u76f2\u731c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u8981\u89e3\u7684\u5f0f\u5b50\u662f\uff1a$\\sum\\limits_{i = 1}^{n}\\sum\\limits_{j = 1}^{m}\\gcd(i,j)$\u3002  \n~~\u56e0\u4e3a\u6211\u6302\u673a\u8bd5\u4e86\u8bd5\uff0c\u8dd1\u4e86\u4e00\u5929\u90fd\u6ca1\u8dd1\u51fa\u6765~~\u56e0\u4e3a\u8fd9\u4e2a\u5f0f\u5b50\u5f88\u5927\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u7528\u6570\u5b66\u65b9\u6cd5\u6765\u89e3\u3002  \n\u6211\u4eec\u4f1a\u53d1\u73b0 $n\\not= m$ \u53ea\u6709\u4e00\u4e2a\u70b9\uff0c\u4e5f\u5c31\u662f\u8bf4\u5f0f\u5b50\u53ef\u4ee5\u5199\u6210 $\\sum\\limits_{i = 1}^{n}\\sum\\limits_{j = 1}^{n}\\gcd(i, j)$\u3002  \n\u679a\u4e3e\u6bcf\u4e2a\u53ef\u80fd\u7684 $\\gcd$\uff0c\u6211\u4eec\u7528 $G$ \u6765\u8868\u793a\uff0c\u90a3\u4e48\u5c31\u662f  \n$\\sum\\limits_{G = 1}^{n}G\\sum\\limits_{i = 1}^{\\left\\lfloor\\frac{n}{G}\\right\\rfloor}\\sum\\limits_{j = 1}^{\\left\\lfloor\\frac{n}{G}\\right\\rfloor}[\\gcd(i, j) = 1]$\u3002  \n\u5f88\u5bb9\u6613\u6539\u5199\u6210\uff1a  \n$\\sum\\limits_{G = 1}^{n}G[2{\\sum\\limits_{i = 1}^{\\left\\lfloor\\frac{n}{G}\\right\\rfloor}(\\varphi(i) - 1)}]$    \n\n\u53ea\u8981\u6211\u4eec\u9884\u5904\u7406\u4e00\u4e0b $\\varphi$ \u7684\u53bb\u524d\u7f00\u548c\u5c31\u597d\u4e86\u3002  \n\n```cpp\n#include <iostream>\n#include <cstdio>\n#define int long long\n#define MAXN 1000000\nusing namespace std;\nint phi[MAXN + 10];\nint gcd(int n, int m) {\n\tif(!m) return n;\n\telse return gcd(m, n % m);\n}\nvoid init() {//\u6b27\u62c9\u51fd\u6570\u9884\u5904\u7406\n\tfor(int p = 1; p <= MAXN; p++) phi[p] = p;\n    for(int p = 2; p <= MAXN; p++)\n        if(phi[p] == p)\n            for(int i = p; i <= MAXN; i += p)\n                phi[i] = phi[i] / p * (p - 1);\n\tfor(int p = 2; p <= MAXN; p++)\n\t\tphi[p] += phi[p - 1];\n}\nint solve(int n) {//\u6839\u636e\u4e0a\u9762\u7684\u5f0f\u5b50\u6c42\u89e3\n\tint ans = 0;\n\tfor(int G = 1; G <= n; G++) ans = (2 * phi[n / G] - 1) * G + ans;\n\treturn ans;\n}\nsigned main() {\n\tfreopen(\"input7.txt\", \"r\", stdin);\n\tfreopen(\"output7.txt\", \"w\", stdout);\n\tint pika, T;\n\tcin >> pika >> T;\n\tinit();\n\twhile(T--) {\n\t\tint n, m;\n\t\tlong long ans = 0;\n\t\tcin >> n >> m;\n\t\tif(n != m) {\n\t\t\tfor(int p = 1; p <= n; p++)\n\t\t\t\tfor(int i = 1; i <= m; i++)\n\t\t\t\t\tans += gcd(p, i);\n\t\t\tcout << ans << endl;\n\t\t}\n\t\telse cout << solve(n) << endl;\n\t}\n}\n```\n\n---\n## Subtask 8\n\u901a\u8fc7\u5927\u91cf\u7684\u89c2\u5bdf\u6211\u4eec\u4f1a\u53d1\u73b0\u8fd9\u662f\u6c42\u8fd9\u4e2a\u4e32\u7684\u4e0d\u540c\u5b57\u4e32\u6570\u91cf\u3002  \n\u4f17\u6240\u5468\u77e5\uff0c\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u4e32\u4e0d\u540c\u5b50\u4e32\u7684\u6570\u91cf\u4e3a $\\dfrac{(n + 1)n}{2} - \\sum\\limits_{i = 2}^{n}height_i$\uff08$height$ \u662f SA \u91cc\u9762\u7684\u4e1c\u897f\uff09  \n\u7136\u540e\u53ea\u8981\u4f60\u8dd1 SA \u5c31\u884c\u4e86\u3002  \n```cpp\n#include <iostream>\n#include <algorithm>\n#include <cstring>\n#define MAXN 2000000\n#define QWQ cout << \"QWQ\" << endl;\nusing namespace std;\nlong long SM = 122;\nlong long sa[MAXN + 10], rk[MAXN + 10], tmp[MAXN + 10], t[MAXN + 10], n, str[MAXN + 10];\nlong long height[MAXN + 10];\nvoid SXSRT() {\n\tfor(int p = 0; p <= SM; p++) t[p] = 0;\n\tfor(int p = 1; p <= n; p++) t[rk[p]]++;\n\tfor(int p = 1; p <= SM; p++) t[p] += t[p - 1];\n\tfor(int p = n; p >= 1; p--) sa[t[rk[tmp[p]]]--] = tmp[p];\n}\nvoid solve() {//\u6c42 sa \u6570\u7ec4\n\tfor(int p = 1; p <= n; p++) tmp[p] = p, rk[p] = int(str[p]);\n\tSXSRT();\n\tfor(int p = 0, w = 1; p < n; SM = p, w <<= 1) {\n\t\tp = 0;\n\t\tfor(int i = 1; i <= w; i++) tmp[++p] = n - w + i;\n\t\tfor(int i = 1; i <= n; i++) if(sa[i] > w) tmp[++p] = sa[i] - w;\n\t\tSXSRT(), swap(tmp, rk), rk[sa[1]] = p = 1;\n\t\tfor(int i = 2; i <= n; i++) rk[sa[i]] = ((tmp[sa[i - 1]] == tmp[sa[i]] && tmp[sa[i - 1] + w] == tmp[sa[i] + w]) ? (p) : (++p));\n\t}\n}\nvoid GHT() {//\u6c42 height\n\tlong long k = 0;\n\tfor(int p = 1; p <= n; p++) {\n\t\tif(k) k--;\n\t\twhile(str[p + k] == str[sa[rk[p] - 1] + k]) k++;\n\t\theight[rk[p]] = k;\n\t}\n}\nlong long get_ans() {\n\tlong long ans = (n + 1) * n / 2; \n\tfor(int p = 2; p <= n; p++) \n\t\tans -= height[p];\n\treturn ans;\n}\nsigned main() {\n\tfreopen(\"input8.txt\", \"r\", stdin);\n\tfreopen(\"output8.txt\", \"w\", stdout);\n\tint pika, T; cin >> pika >> T;\n\twhile(T--) {\n\t\tmemset(sa, 0, sizeof(sa));\n\t\tmemset(height, 0, sizeof(height));\n\t\tcin >> n;\n\t\tfor(int p = 1; p <= n; p++) cin >> str[p];\n\t\tsolve();\n\t\tGHT();//\u83b7\u5f97 height\n\t\tcout << get_ans() << endl;\n\t}\n}\n```\n\n## Subtask 9\n\u53d1\u73b0\u6240\u6709\u7684\u8f93\u5165\u6570\u636e\u90fd\u662f\u4e8c\u5143\u7ec4\uff0c\u800c\u4e14\u6bcf\u4e2a\u6570\u5b57\u90fd\u5f88\u5927\uff0c\u8d85\u8fc7\u4e86\u7b2c\u4e00\u884c\u8f93\u5165\u7684\u6570\u636e $n$\u3002\u968f\u4fbf\u8f93\u5165\u4e00\u7ec4\u6570\u636e\u53d1\u73b0\u8f93\u51fa\u4e86\u5c0f\u6570\uff0c\u8bf4\u660e\u4e0d\u662f\u6570\u8bba\u9898\uff0c\u770b\u4e0a\u53bb\u8f93\u5165\u7684\u50cf\u5e73\u9762\u76f4\u89d2\u5750\u6807\u7cfb\u7684\u6bcf\u4e00\u4e2a\u70b9\u5750\u6807\uff0c\u7136\u540e\u6700\u540e\u8f93\u51fa\u7684\u5927\u6982\u662f\u4e2a\u8ddd\u79bb\u3002    \n\u7ecf\u8fc7\u4e0d\u61c8\u7684\u5c1d\u8bd5\u6211\u4eec\u4f1a\u53d1\u73b0\u8fd9\u9053\u9898\u8ba9\u6211\u4eec\u6c42\u7684\u662f\u5e73\u9762\u6700\u8fd1\u70b9\u5bf9\u8ddd\u79bb\u3002  \n\u6211\u4eec\u90fd\u77e5\u9053\uff0c\u5e73\u9762\u6700\u8fd1\u70b9\u5bf9\u8ddd\u79bb\u53ef\u4ee5\u7528\u5206\u6cbb\u7b97\u6cd5\u6c42\uff0c\u628a\u6bcf\u4e2a\u70b9\u6309 $x$ \u8f74\u4e3a\u7b2c\u4e00\u5173\u952e\u5b57\uff0c$y$ \u8f74\u4e3a\u7b2c\u4e8c\u5173\u952e\u5b57\u964d\u5e8f\u6392\u5e8f\u3002\u5c06\u8981\u5904\u7406\u7684\u70b9\u5bf9\u5206\u6210 $[l, mid]$ \u4e0e $[mid + 1, r]$\uff0c\u5206\u522b\u6c42\u89e3\uff0c\u5f97\u5230\u4e92\u4e0d\u76f8\u4ea4\u7684\u4e24\u4e2a\u533a\u57df\u7684\u6700\u5c0f\u89e3 $\\min\\{\\operatorname{calc}(l, mid),\\operatorname{calc}(mid + 1, r)\\}$  \n\u8fd9\u91cc\u9762\u4e0d\u5305\u542b $mid$ \u53f7\u70b9\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u679a\u4e3e\u6bcf\u4e2a\u522b\u7684\u70b9\u7136\u540e\u627e\u51fa\u6700\u5c0f\u8ddd\u79bb\u4e0e\u4e0a\u9762\u7684\u5224\u65ad\u3002  \n\u5177\u4f53\u7ec6\u8282\u8be6\u89c1\u4ee3\u7801\uff1a  \n```cpp\n#include <iostream>\n#include <cmath>\n#include <iomanip>\n#include <algorithm>\n#include <cstdio>\n#define MAXN 2000000\nusing namespace std;\nstruct point {\n\tdouble x, y;\n} P[MAXN + 10];\nbool cmp(point x, point y) {\n\tif(x.x != y.x) return x.x < y.x;\n\telse return x.y < y.y;\n}\nbool Cmp(int x, int y) {\n\treturn P[x].y < P[y].y;\n}\ndouble dist(int a, int b) {\n\tdouble x1 = P[a].x, x2 = P[b].x;\n\tdouble y1 = P[a].y, y2 = P[b].y;\n\treturn double(sqrt(double(fabs(x1 - x2) * fabs(x1 - x2)) + double(fabs(y1 - y2) * fabs(y1 - y2))));\n}\nint rest[MAXN + 10];\ndouble calc(int l, int r) {//\u7b97\u51fa\u5e73\u9762\u6700\u8fd1\u70b9\u5bf9\u8ddd\u79bb\n\tdouble qwq = 0x7f7f7f7f;\n\tif(l == r) return qwq;\n\tif(l + 1 == r) return dist(l, r);//\u7b97\u4e0d\u4e0b\u53bb\u4e86\u5c31\u8fd4\u56de\n\tint mid = (l + r) >> 1, S = 0;\n\tqwq = min(calc(l, mid), calc(mid + 1, r));//\u8ba1\u7b97\u4e0d\u7b97 mid \u53f7\u70b9\u7684\u6700\u5c0f\n\tfor(int p = l; p <= r; p++)//\u8ba1\u7b97 mid \u53f7\u70b9\n\t\tif(fabs(P[p].x - P[mid].x) < qwq)//\u5982\u679c\u90fd\u5927\u4e8e\u7b49\u4e8e qwq \u4e86\u5c31\u6ca1\u6709\u5fc5\u8981\u7b97\u4e0b\u53bb\u4e86\n\t\t\trest[++S] = p;\n\tsort(rest + 1, rest + S + 1, Cmp);//\u6309\u7167 y \u8f74\u964d\u5e8f\u6392\u5e8f\u65b9\u4fbf\u540e\u9762\u7684\u5904\u7406\n\tfor(int p = 1; p <= S; p++)\n\t\tfor(int i = p + 1; i <= S && P[rest[i]].y - P[rest[p]].y < qwq; i++)\n\t\t\tqwq = min(qwq, dist(rest[p], rest[i]));\n\treturn qwq;\n}\nint main() {\n\tfreopen(\"input9.txt\", \"r\", stdin);\n\tfreopen(\"output9.txt\", \"w\", stdout);\n\tint pika, T; cin >> pika >> T;\n\twhile(T--) {\n\t\tint n;\n\t\tcin >> n;\n\t\tfor(int p = 1; p <= n; p++) \n\t\t\tcin >> P[p].x >> P[p].y;\n\t\tsort(P + 1, P + n + 1, cmp);\n\t\tcout << fixed << setprecision(3) << calc(1, n) << endl;\n\t}\n}\n```\n\n---\n## Subtask 10\n\u7ec8\u4e8e\u6765\u5230\u4e86\u6700\u540e\u4e00\u4e2a Subtask\uff01  \n\u8fd9\u4e2a Subtask \u91cc\u9762\u662f\u4e00\u4e9b\u5b57\u7b26\u4e32\uff0c\u731c\u6d4b\u662f\u795e\u4ed9\u5b57\u7b26\u4e32\u9898\u3002  \n\u968f\u4fbf\u5199\u4e00\u4e2a\u5c0f\u6570\u636e\u90fd\u4f1a\u53d1\u73b0 lost \u8f93\u51fa\u4e86 $T$ \u4e2a ```invalid input!```   \n\u5c31\u7b97\u662f\u8f93\u5165\u7b2c\u4e00\u4e2a\u6570\u636e\uff08\u9898\u76ee\u8bf4\u4e86\u6570\u636e\u89c4\u6a21\u4e0d\u8d85\u8fc7\u7b2c\u4e00\u7ec4\u6570\u636e\u4fdd\u8bc1\u80fd\u6b63\u5e38\u8fd0\u884c\uff09\uff0c\u4e5f\u4f1a\u8f93\u51fa ```invalid input!```\u3002  \n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5927\u80c6\u731c\u6d4b\uff0c\u8fd9\u91cc\u8981\u8f93\u51fa T \u4e2a ```invalid input!```\u3002  \n\u4ee3\u7801\uff1a  \n```cpp\n#include <iostream>\nusing namespace std;\nint main() {\n\tfreopen(\"input10.txt\", \"r\", stdin);\n\tfreopen(\"output10.txt\", \"w\", stdout); \n\tint pika, T;\n\tcin >> pika >> T;\n\twhile(T--) cout << \"invalid input!\" << endl; \n}\n```\n\n---\n\u8fd9\u9053\u9898\u5c31\u8fd9\u6837\u505a\u51fa\u6765\u5566~  \n\u4ece 7 \u6708 15 \u53f7\u5f00\u59cb\u83bd\uff0c7 \u6708 18 \u53f7\u5b8c\u5de5\uff0c\u4e5f\u5b66\u4f1a\u4e86\u4e0d\u5c11\u4e1c\u897f\uff0c\u6bd4\u5982\u8bf4\u500d\u589e LCA \u7ef4\u62a4\u65b0\u4e1c\u897f\uff08\u4e4b\u524d\u53ea\u4f1a\u677f\u5b50\uff08\u6342\u8138\uff09\uff09\uff0c\u6b27\u62c9\u51fd\u6570\u5728\u5f0f\u5b50\u91cc\u600e\u4e48\u63a8\uff08\u4e4b\u524d\u4e5f\u53ea\u4f1a\u6982\u5ff5\uff08\u6342\u8138\uff09\uff09\uff0cSA \u57fa\u64cd\uff08\u4e4b\u524d\u538b\u6839\u4e0d\u4f1a\uff08\u6342\u8138\uff09\uff09\u3002  \n\u771f\u662f\u6709\u8da3\u7684\u4e00\u9053\u9898\u5462\uff01  \n\u5b8c\u7ed3\u6492\u82b1~",
        "postTime": 1626328278,
        "uid": 298549,
        "name": "SIXIANG32",
        "ccfLevel": 5,
        "title": "\u9898\u89e3\u3010[\u96c6\u8bad\u961f\u4e92\u6d4b 2016] \u6d88\u5931\u7684\u6e90\u4ee3\u7801\u3011"
    },
    {
        "content": "\u975e\u5e38\u641e\u7684\u4e00\u9053\u9898\uff0c\u82b1\u4e86\u4e00\u4e2a\u4e0b\u5348\u52a0\u665a\u4e0a\u624d\u89e3\u51b3\u6389\u3002\u8fd9\u7bc7\u9898\u89e3\u4f1a\u89e3\u91ca\u5982\u4f55\u6839\u636e\u6570\u636e\u63a8\u51fa\u9898\u9762\uff0c\u4e5f\u662f\u672c\u4eba\u505a\u9898\u7684\u5fc3\u8def\u5386\u7a0b\u3002\n\n### Sub0\n\n\u9996\u5148\u4f60\u4e0b\u8f7d\u4e86\u6e90\u6587\u4ef6\uff0c\u53d1\u73b0\u7a0b\u5e8f\u8fd0\u884c\u4e0d\u4e86\u3002\u4f60\u9700\u8981\u5c06\u4e24\u4e2a\u7f3a\u5931\u7684 .dll \u6587\u4ef6\u4e0b\u8f7d\u5230\u4e0e `lost.exe` \u540c\u4e00\u76ee\u5f55\u4e0b\u3002\u9898\u89e3\u7b2c\u4e00\u7bc7\u7ed9\u51fa\u4e86\u4e0b\u8f7d\u94fe\u63a5\uff0c\u5982\u679c\u4f60\u4e0d\u65b9\u4fbf\u4f7f\u7528\u7f51\u76d8\uff0c\u53ef\u4ee5\u5728[\u8fd9\u4e2a\u94fe\u63a5](https://www.luogu.com.cn/problem/U239318)\u4e2d\u4e0b\u8f7d\u3002\n\n### Sub1\n\n\u5173\u6ce8\u5230\u7b2c 2,3 \u7ec4\u6570\u636e\u5168\u4e3a `a`\uff0c\u4e0d\u59a8\u8f93\u5165\u4e00\u4e9b `a`\uff0c\u53d1\u73b0\u8f93\u51fa\u5168\u4e3a `y`\u3002\u5927\u80c6\u731c\u6d4b\uff1a\u6bcf\u4e2a\u5b57\u6bcd\u6709\u552f\u4e00\u5bf9\u5e94\u7684\u6620\u5c04\u3002\u968f\u673a\u8f93\u5165\u4e00\u4e9b\u77ed\u5b57\u7b26\u4e32\uff0c\u6839\u636e\u8f93\u51fa\u5373\u53ef\u8bc1\u660e\u6b63\u786e\u3002\n\n\u6240\u4ee5\u53ea\u9700\u8981\u77e5\u9053 $a$ \u5230 $z$ \u6bcf\u4e2a\u5b57\u7b26\u7684\u6620\u5c04\u5373\u53ef\uff0c\u5206\u4e09\u6b21\u8be2\u95ee `a-j`\uff0c`k-t`\uff0c`u-z` \u7684\u7ed3\u679c\u5373\u53ef\u3002\n\n### Sub2\n\n\u8f93\u5165\u53ea\u6709\u4e00\u4e2a\u6570\u5b57\uff0c\u663e\u7136\u8981\u627e\u5f0f\u5b50\u3002\u6c42\u51fa $f(0\\dots 20)$ \u6253\u8868\uff0c\u4e0a oeis \u641c\u524d\u4e09\u9879\u53d1\u73b0\u6ca1\u6709\u5f0f\u5b50\uff0c\u56e0\u6b64\u731c\u6d4b\u8981\u6c42\u4e00\u4e2a\u591a\u9879\u5f0f\u3002\n\n\u4e24\u6b21\u5dee\u5206\u540e\u53d1\u73b0\u524d\u9762\u51e0\u4e2a\u6570\u5747\u76f8\u7b49\u3002\u6240\u4ee5\u662f\u4e00\u4e2a\u4e8c\u6b21\u51fd\u6570,\u5e76\u4e14\u540e\u9762\u5b58\u5728\u53d6\u6a21\u64cd\u4f5c\u3002\u6839\u636e $f(0,1,2)$ \u5f85\u5b9a\u7cfb\u6570\u89e3\u65b9\u7a0b\u7ec4\u53ef\u5f97\u51fd\u6570\u89e3\u6790\u5f0f\u4e3a $f(x)=2016x^2+4x+10$\u3002\n\n$f(11)=243990$\uff0c\u4e0e\u771f\u5b9e\u503c\u76f8\u5dee $233333$\u3002\u6a21\u6570\u5e94\u8be5 $>f(10)$ \u4e14\u4e3a\u5dee\u503c\u7684\u7ea6\u6570\uff0c\u56e0\u6b64\u6a21\u6570\u5373\u4e3a\u8be5\u6570\u3002\u539f\u9898\u5373\u6c42 $2016x^2+4x+10\\pmod {233333}$\n\n### Sub3\n\n\u8f93\u5165\u4f9d\u7136\u53ea\u6709\u4e00\u4e2a\u6570\u5b57\u3002\u7a0d\u5fae\u6253\u4e0b\u8868\u53d1\u73b0\u51fd\u6570\u589e\u957f\u8d8b\u52bf\u63a5\u8fd1\u4e8e $f(x)=\\sqrt{x}$\u3002\u4e0a oeis \u641c\u7d22\uff0c\u53ef\u77e5\u6240\u6c42\u5373\u4e3a $\\lfloor\\sqrt{\\frac n{\\pi}}\\rfloor$\u3002\u76f4\u63a5\u8ba1\u7b97\u5373\u53ef\u3002\n\n\u5982\u679c\u4e0d\u7528 oeis \u7684\u8bdd\uff0c\u6839\u636e\u589e\u957f\u8d8b\u52bf\u548c $f(50000)=126$ \u731c\u6d4b $f(x)=\\frac{\\sqrt n}{k}$ \u4ee5\u67d0\u79cd\u5f62\u5f0f\u53d6\u6574\uff0c\u7136\u540e\u5bf9\u56db\u820d\u4e94\u5165\u3001\u4e0b\u53d6\u6574\u548c\u4e0a\u53d6\u6574\u4e09\u79cd\u5f62\u5f0f\u5206\u522b\u8ba1\u7b97\u3002\u6bcf\u6b21\u9009\u4e00\u4e9b\u70b9\u6c42\u51fa $k$ \u7684\u53d6\u503c\u8303\u56f4\uff0c\u5f53\u8303\u56f4\u5c0f\u4e8e `eps` \u540e\u8df3\u51fa\u3002\u53d1\u73b0\u53ea\u6709\u4e0b\u53d6\u6574\u5b58\u5728 $k$\u3002\u6c42\u51fa $k$ \u540e\u5229\u7528\u8f83\u5f3a\u7684\u6570\u611f\u770b\u51fa $k$ \u7ea6\u7b49\u4e8e $\\sqrt \\pi$\uff0c\u6216\u8005\u76f4\u63a5\u5c06\u7cbe\u5ea6\u8f83\u9ad8\u7684 $k$ \u4f5c\u4e3a\u5e38\u91cf\u9664\u5728\u4e0b\u9762\u5373\u53ef\u3002\n\n### Sub4\n\n\u5f88\u6709\u8ff7\u60d1\u6027\u7684\u4e00\u4e2a\u70b9\uff0c\u89c2\u5bdf\u6570\u636e\u53ef\u4ee5\u731c\u51fa\u7ed9\u4e86\u4e00\u5f20\u56fe\u3002\u4f7f\u7528 $n$ \u5f88\u5c0f\u7684\u6811\u3001\u8fde\u901a\u56fe\u8bd5\u9a8c\u53d1\u73b0\u7ed3\u679c\u5747\u4e3a $n^2$\u3002\u5173\u6ce8\u5230\u7b2c\u4e8c\u4e2a\u70b9\u56fe\u4e0d\u8fde\u901a\uff0c\u5c1d\u8bd5\u6784\u9020\u4e0d\u8fde\u901a\u56fe\uff0c\u53d1\u73b0\u7ed3\u679c\u5373\u4e3a\u6bcf\u4e2a\u8fde\u901a\u5757\u5927\u5c0f\u7684\u5e73\u65b9\u548c\uff0c\u5e76\u67e5\u96c6\u7ef4\u62a4\u5373\u53ef\u3002\n\n### Sub5\n\n\u9996\u5148\u770b\u5230\u5de8\u5927\u7684\u6570\u53ef\u4ee5\u731c\u662f\u6743\u503c\u3002\u53c8\u6070\u597d\u6709 9 \u4e2a\u6743\u6240\u4ee5\u731c\u662f $n$ \u4e2a\u8282\u70b9\u7684\u6811\u7684\u8fb9\u6743\u3002\u90a3\u4e48\u540e\u9762\u7684\u5c31\u662f\u8be2\u95ee\uff0c\u5220\u53bb `5 5` \u540e\u53d1\u73b0\u7b54\u6848\u6ca1\u53d8\uff0c\u5355\u72ec\u8be2\u95ee\u67d0\u5bf9\u70b9\u7b54\u6848\u7b49\u4e8e\u8def\u5f84\u957f\u5ea6\u3002\u56e0\u6b64\u6bcf\u4e2a\u8be2\u95ee\u5c31\u662f\u4e24\u70b9\u8ddd\u79bb\u3002\n\n\u53d1\u73b0\u6709 $2$ \u6b21 `2 10` \u8be2\u95ee\uff0c\u5220\u53bb\u4e00\u4e2a\u540e\u7b54\u6848\u6539\u53d8\uff0c\u4e24\u4e2a\u90fd\u5220\u53bb\u540e\u7b54\u6848\u548c\u5220\u4e4b\u524d\u4e00\u6837\u3002\u6240\u4ee5\u8f93\u51fa\u4e3a\u6240\u6709\u8be2\u95ee\u7ed3\u679c\u7684\u5f02\u6216\u548c\u3002\n\n### Sub6\n\n\u8f93\u5165\u683c\u5f0f\u8f93\u51fa\u683c\u5f0f\u548c\u4e0a\u4e00\u95ee\u76f8\u540c\uff0c\u56e0\u6b64\u731c\u6d4b\u8fd8\u662f\u6811\u4e0a\u8be2\u95ee+\u5f02\u6216\u8f93\u51fa\u3002\n\n\u6784\u9020\u51fa\u8f83\u5c0f\u7684\u6811\uff0c\u5355\u72ec\u8be2\u95ee\u4e00\u5bf9\u70b9\uff0c\u591a\u6b21\u6d4b\u8bd5\u53d1\u73b0\u8fd4\u56de\u7684\u662f\u8def\u5f84\u4e0a\u8fb9\u6743 $\\min$\u3002\u4e0d\u5b58\u5728\u8fb9\u5219\u8fd4\u56de `1987654321`\u3002\n\n\u8fd9\u4e24\u95ee\u539f\u5219\u4e0a\u5e94\u4f7f\u7528\u500d\u589e\u3001\u6811\u5256\u89e3\u51b3\uff0c\u4f46\u53d1\u73b0\u6811\u7684\u6df1\u5ea6\u5e76\u4e0d\u5927\uff08$<2\\times10^4$\uff09\uff0c\u6240\u4ee5\u66b4\u529b\u8df3\u7236\u8282\u70b9\u627e lca \u5373\u53ef\uff0c\u8fd8\u53ef\u4ee5\u987a\u5e26\u7edf\u8ba1\u7b54\u6848\u3002\n\n### Sub7\n\n\u6700\u641e\u7684\u70b9\u3002\n\n\u9996\u5148\u6570\u636e\u53ea\u7ed9\u4e86 `n,m`\uff0c\u7b80\u5355\u5b9e\u9a8c\u540e\u53d1\u73b0\u987a\u5e8f\u65e0\u5173\u3002\u5408\u7406\u63a8\u6d4b\u53ef\u80fd\u662f\u63a8\u5f0f\u5b50\u6216\u5728\u7f51\u683c\u4e0a\u8ba1\u6570\uff0c\u7b80\u5355\u6d4b\u8bd5\u5c0f\u7684\u6570\u636e\u70b9\u540e\u653e\u5f03\u4e86\u7f51\u683c\u4e0a\u8ba1\u6570\u7684\u60f3\u6cd5\u3002\n\n\u5c1d\u8bd5\u56fa\u5b9a $n$\uff0c\u589e\u5927 $m$ \u6253\u8868\uff0c\u53d1\u73b0\u5176\u5dee\u5206\u5b58\u5728\u5faa\u73af\u8282\uff1a\n\n```cpp\nn=1: 1\nn=2: 2 3\nn=3: 3 4 5 4 3 6\nn=4: 4 6 6 8 4 8 4 8 6 6 4 10\n```\n\u6709\u5982\u4e0b\u89c4\u5f8b\uff1a\n1. \u5faa\u73af\u8282\u957f\u5ea6\u4e3a $\\operatorname{lcm}(1\\dots n)$\u3002\n2. \u4e0b\u6807\u4e3a $1$ \u6216\u5927\u4e8e $n$ \u7684\u8d28\u6570\u65f6\uff0c\u5dee\u5206\u7b49\u4e8e $n$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8981\u6c42\u7684\u5f0f\u5b50\u5e94\u8be5\u5f62\u5982$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^mf(i,j)$\u3002\n\n\u7531\u4e8e\u5faa\u73af\u8282\u53ef\u80fd\u5f88\u957f\uff0c\u4f46\u4e0d\u5927\u4e8e $n$ \u7684\u8d28\u6570\u5f88\u5c11\uff0c\u6240\u4ee5\u6211\u4eec\u653e\u5927 $n$\uff0c\u627e\u4e00\u4e9b\u8d28\u6570\u6c42\u4e00\u4e0b\uff0c\u4f1a\u53d1\u73b0\u89c4\u5f8b $3$\uff1a\u4e0b\u6807\u4e3a\u4e0d\u5927\u4e8e $n$ \u7684\u8d28\u6570 $p$ \u65f6\uff0c\u5dee\u5206\u7b49\u4e8e $n-\\lfloor\\frac np\\rfloor+p\\lfloor\\frac np\\rfloor$\u3002\n\n\u89c4\u5f8b $1$ \u5b58\u5728 $\\operatorname{lcm}$\uff0c\u56e0\u6b64\u662f\u548c\u7ea6\u6570\u6216\u6a21\u6570\u7684\u7814\u7a76\u6709\u5173\u3002\u901a\u8fc7\u89c4\u5f8b $2$ \u5408\u7406\u63a8\u6d4b\u548c $\\gcd$ \u76f8\u5173\u3002\u5728\u6b64\u57fa\u7840\u4e0a\u53d1\u73b0\u89c4\u5f8b $3$ \u7b49\u4ef7\u4e8e $\\sum\\limits_{i=1}^n\\gcd(p,i)$\uff0c\u56e0\u6b64\u731c\u6d4b\u6240\u6c42\u5373\u4e3a $\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m\\gcd(i,j)$\uff0c\u5e26\u56de\u9a8c\u8bc1\u6210\u7acb\uff0c\u83ab\u53cd\u63a8\u5f0f\u5b50\u5373\u53ef\u3002~~\u6709\u5174\u8da3\u53ef\u4ee5\u6253\u675c\u6559\u7b5b\u7ee7\u7eed\u4f18\u5316\u3002~~\n\n### Sub8\n\n\u4e5f\u5f88\u641e\u5c31\u662f\u4e86\u3002\n\n\u7ed9\u5b9a\u957f\u4e3a $n$ \u7684\u5e8f\u5217\uff0c\u8981\u8f93\u51fa\u4ec0\u4e48\u4e1c\u897f\u3002\n\n\u968f\u4fbf\u8f93\u5165\u4e00\u4e9b\u6570\u636e\uff0c\u8c03\u6574\u5e8f\u5217\u4e2d\u6570\u5b57\u5927\u5c0f\u548c\u4f4d\u7f6e\u4f1a\u53d1\u73b0\u5982\u4e0b\u89c4\u5f8b\uff1a\n\n1. \u6570\u5b57\u7684\u76f8\u5bf9\u5927\u5c0f\u5bf9\u7b54\u6848\u6ca1\u6709\u5f71\u54cd\u3002\u6570\u5b57\u76f8\u7b49\u5bf9\u7b54\u6848\u6709\u5f71\u54cd\u3002\n2. \u6570\u5b57\u7684\u987a\u5e8f\u5bf9\u7b54\u6848\u6709\u4e00\u5b9a\u7a0b\u5ea6\u7684\u5f71\u54cd\u3002\uff08`1 2 2 2` \u548c `2 1 2 2`\uff09 \n3. \u8f93\u5165\u7684\u6570\u4e92\u4e0d\u76f8\u540c\u65f6\uff0c\u4efb\u610f\u987a\u5e8f\u4e0b\u7b54\u6848\u90fd\u4e3a $\\frac12n(n+1)$\u3002\u5176\u4f59\u60c5\u51b5\u4e0b\u7b54\u6848\u53ea\u4f1a\u6bd4\u5176\u5c0f\u3002\n\n\u7b2c\u4e00\u6761\u53ef\u4ee5\u5426\u51b3\u8ddf\u6570\u503c\u5927\u5c0f\u6709\u5173\u7684\u7b97\u6cd5\uff0c\u7b2c\u4e8c\u6761\u53ef\u4ee5\u5426\u51b3\u8ddf\u6bcf\u7c7b\u6570\u5b57\u4e2a\u6570\u6709\u5173\u7684\u7b97\u6cd5\u3002\u4f46\u4ecd\u7136\u4e0d\u77e5\u9053\u662f\u4ec0\u4e48\u3002\n\n\u6253\u5f00\u6570\u636e\uff0c\u53d1\u73b0\u5373\u4f7f\u662f\u6700\u5927\u7684\u70b9\uff0c\u5e8f\u5217\u4e2d\u6bcf\u4e2a\u6570\u4e5f $\\le 20$\u3002\u8fd9\u5e76\u4e0d\u6b63\u5e38\uff0c\u56e0\u4e3a\u6211\u4eec\u5df2\u7ecf\u53d1\u73b0\u6570\u5b57\u5927\u5c0f\u8ddf\u7b54\u6848\u65e0\u5173\u3002\u6362\u800c\u8a00\u4e4b\uff0c\u6570\u5b57\u7684\u4f5c\u7528\u53ef\u80fd\u5e76\u975e\u6570\u503c\u3002\u90a3\u4e48\u7b2c\u4e00\u53cd\u5e94\u662f\u5b57\u7b26\u4e32\u7684 $26$\u3002\u5c1d\u8bd5\u5c06\u5e8f\u5217\u8f6c\u5316\u4e3a\u5b57\u7b26\u4e32\u3002\n\n\u7b2c\u4e09\u6761\u7684 $\\frac12n(n+1)$ \u5c31\u662f\u6574\u4e2a\u5b57\u7b26\u4e32\u7684\u5b50\u4e32\u4e2a\u6570\uff0c\u518d\u6839\u636e\u7b2c\u4e00\u6761\uff0c\u4e0d\u96be\u731c\u6d4b\u51cf\u53bb\u7684\u5e94\u8be5\u662f\u76f8\u7b49\u5b50\u4e32\u4e2a\u6570\u3002\u6240\u4ee5\u6240\u6c42\u5373\u4e3a\u672c\u8d28\u4e0d\u540c\u5b50\u4e32\u4e2a\u6570\uff0c\u540e\u7f00\u6570\u7ec4\u677f\u5b50\u9898\u3002\n\n\u7136\u540e\u8fd9\u4e00\u95ee\u6700\u5927\u7684\u70b9\u662f $10^6$ \u800c\u975e $10^5$\uff0c\u6570\u7ec4\u522b\u5f00\u5c0f\u4e86\u3002\n\n### Sub9\n\n\u5c0f\u6e05\u65b0\u3002\n\n\u8f93\u51fa\u6837\u4f8b\u548c\u624b\u9020\u4e00\u4e9b\u6837\u4f8b\uff0c\u53d1\u73b0\u8f93\u51fa\u5747\u4e3a\u5c0f\u6570\u3002\u8003\u8651\u5230\u8f93\u5165\u683c\u5f0f\u4e3a $n$\uff0c\u7136\u540e $n$ \u4e2a\u6210\u5bf9\u7684\u4e1c\u897f\u3002\u9996\u5148\u8003\u8651\u5206\u6570\u89c4\u5212\uff0c\u6d4b\u8bd5 $n=1$ \u8f93\u5165\u4e0d\u5408\u6cd5\uff0c$n=2$\uff0c$a_1=b_1=1,a_2=b_2=2$ \u8f93\u51fa $1.414$ \u800c\u975e $1$\uff0c\u56e0\u6b64\u4e0d\u662f\u5206\u6570\u89c4\u5212\u3002\n\n\u5173\u6ce8\u5230\u6837\u4f8b\u8f93\u51fa\u7684\u662f $2.236$\uff0c\u548c\u4e0a\u9762\u7684\u6570\u636e\u4e00\u8d77\u770b\uff0c\u5206\u522b\u662f $\\sqrt{2}$ \u548c $\\sqrt{5}$\u3002\u6240\u4ee5\u57fa\u672c\u786e\u5b9a\u8f93\u5165\u7684\u662f\u5e73\u9762\u4e0a\u70b9\u7684\u5750\u6807\uff0c\u8981\u6c42\u7684\u662f\u70b9\u5bf9\u8ddd\u79bb\u3002\u624b\u52a8\u89c2\u6d4b\u7b2c\u4e00\u4e2a\u6570\u636e\u70b9\u53d1\u73b0 $\\sqrt5$ \u662f\u6700\u8fd1\u4e24\u70b9\u8ddd\u79bb\u3002\u56e0\u6b64\u6240\u6c42\u5373\u4e3a\u5e73\u9762\u6700\u8fd1\u70b9\u5bf9\uff0c\u5206\u6cbb\u5904\u7406\u6216\u8005[\u4eba\u7c7b\u667a\u6167](https://www.luogu.com.cn/blog/user12655/solution-p1429)\u5373\u53ef\u3002\n\n### Sub10\n\n\u8bed\u6587\u9898\u3002\n\n\u8f93\u51fa\u6837\u4f8b\u548c\u66f4\u5c0f\u7684\u624b\u9020\u6837\u4f8b\u53d1\u73b0\u90fd\u8f93\u51fa\u7684\u4e3a `invalid input!`\uff0c\u770b\u8d77\u6765\u975e\u5e38\u6bd2\u7624\u3002\u4f46\u9898\u9762\u662f\u6709\u8fd9\u6837\u4e24\u53e5\u8bdd\u7684\uff1a\n\n> \u5f53\u6570\u636e\u89c4\u6a21\u4e0d\u8d85\u8fc7\u7b2c\u4e00\u7ec4\u6570\u636e\u65f6\uff0c\u4fdd\u8bc1 $\\texttt{lost}$ \u80fd\u591f\u6b63\u5e38\u8fd0\u884c\u3002\n\n> \u53ea\u6709\u6570\u636e\u7ec4\u6570\u4e0d\u8d85\u8fc7\u4e00\u7ec4\u65f6\uff0c\u4fdd\u8bc1 $\\texttt{lost}$ \u7684\u8f93\u51fa\u6b63\u786e\u3002\n\n\u6240\u4ee5\u5bf9\u4e8e\u7b2c\u4e00\u7ec4\u6570\u636e\uff0c\u6807\u7b97**\u6b63\u5e38\u8fd0\u884c\u4e14\u7ed9\u51fa\u4e86\u6b63\u786e\u7b54\u6848**\u3002\n\n\u6240\u4ee5\u7b54\u6848\u5373\u4e3a `invalid input!`\u3002",
        "postTime": 1660704267,
        "uid": 128606,
        "name": "2018ljw",
        "ccfLevel": 7,
        "title": "P5246 \u9898\u89e3"
    },
    {
        "content": "\n\u5f88\u4f69\u670d\u80fd\u628a\u7b2c\u516b\u4e2a\u70b9\u505a\u51fa\u6765\u7684\u4eba\uff0c\u6211\u770b\u9898\u89e3\u624d\u77e5\u9053\u7684\u3002\n\n## \u9898\u610f\n\n\u9898\u76ee\u4f20\u9001\u95e8\uff1a[Link to Luogu](https://www.luogu.com.cn/problem/P5246)\u3002\n\n> \u7ed9\u5b9a\u5341\u4e2a\u95ee\u9898\u7684\u8f93\u5165\u6570\u636e\uff0c\u8fd8\u6709\u5176\u53ef\u6267\u884c\u6587\u4ef6\u3002\u53ef\u6267\u884c\u6587\u4ef6\u4e0d\u80fd\u8fd0\u884c\u8f83\u5927\u7684\u6570\u636e\uff0c\u4f60\u53ef\u4ee5\u8fd0\u884c\u6d4b\u8bd5\u53ef\u6267\u884c\u6587\u4ef6\u3002\u4f60\u9700\u8981\u731c\u51fa\u6bcf\u4e2a\u95ee\u9898\u7684\u9898\u9762\uff0c\u5e76\u5f97\u5230\u5176\u8f93\u51fa\u6570\u636e\u3002\n>\n> \u5982\u679c\u8f93\u5165\u6570\u636e\u8f83\u5927\u6216\u4e0d\u5408\u6cd5\uff0c\u53ef\u6267\u884c\u6587\u4ef6\u5c06\u5e76\u8f93\u51fa $\\texttt{invalid input.}$ \u4e14\u4e0d\u4f1a\u6267\u884c\u4f60\u7684\u6570\u636e\u3002\n\n\u662f\u4e00\u4e2a\u63d0\u4ea4\u7b54\u6848\u9898\u3002\n\n## \u9898\u89e3\n\nLinux \u8fd0\u884c\u5b83\u7ed9\u7684\u53ef\u6267\u884c\u6587\u4ef6\u8981\u5148 `chmod` \u4e00\u4e0b\u4e0d\u7136\u6ca1\u6743\u9650\u8fd0\u884c\u4e0d\u4e86\u3002\n\n### case 1\n\n\u8f93\u5165\u662f\u4e2a\u5b57\u7b26\u4e32\uff0c\u7ecf\u8fc7\u6d4b\u8bd5\u53d1\u73b0\u8fd9\u4e2a\u4e1c\u897f\u4e0d\u80fd\u8dd1\u957f\u5ea6 $>10$ \u7684\u4e32\u3002\n\n\u8f93\u51fa\u4e5f\u662f\u5b57\u7b26\u4e32\uff0c\u957f\u5ea6\u4e0e\u8f93\u5165\u76f8\u7b49\uff0c\u4e0d\u96be\u53d1\u73b0\u5176\u5b57\u7b26\u662f\u4e00\u4e00\u5bf9\u5e94\u7684\u3002\n\n\u4e8e\u662f\u6d4b\u8bd5\u4e00\u4e0b\u6bcf\u4e2a\u5b57\u7b26\u4f1a\u53d8\u6210\u4ec0\u4e48\u5c31\u884c\u3002\n\n```cpp\nnamespace Type1{\n    char turn[27]=\"yfrbkgimujvphatdsnelozcxwq\";\n    string a;\n    inline void sol(){\n        for(register int T=read();T>0;--T){\n            cin>>a;\n            int n=a.size();\n            for(register int i=0;i<n;++i)\n                cout<<turn[a[i]-'a'];\n            cout<<\"\\n\";\n        }\n    }\n}\n```\n\n### case 2\n\n\u8f93\u5165\u4e00\u4e2a\u6570\u5b57\u3002\u9996\u5148\u53d1\u73b0\u4f9d\u6b21\u8f93\u5165 $1,2,3,\\ldots$\uff0c\u5b83\u662f\u9012\u589e\u7684\uff0c\u4f46\u662f\u5927\u7ea6\u5728 $2\\times 10^5$ \u8fd9\u4e2a\u4f4d\u7f6e\u5f80\u540e\u4e00\u70b9\uff0c\u5b83\u53d8\u5c0f\u4e86\u3002\u6211\u4eec\u63a8\u6d4b\u8fd9\u662f\u5bf9\u4e00\u4e2a\u6570\u53d6\u6a21\u4e86\u3002\n\n\u628a\u5f97\u5230\u7684 $2030,8082,18166,32282,50430,72610$ \u4f5c\u4e00\u6b21\u5dee\u5206\u5f97\u5230 $6052,10084,14116,18148,22180$\u3002\u518d\u4f5c\u4e00\u6b21\u5dee\u5206\u5c31\u53d8\u6210\u4e86 $4032,4032,4032,4032,\\ldots$\u3002\n\n\u6240\u4ee5\u5e8f\u5217\u7684\u5dee\u5206\u662f\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\uff0c\u90a3\u4e48\u5176\u5dee\u5206\u7684\u901a\u9879\u516c\u5f0f\u4e3a $6052+4032(n-1)$\u3002\u56e0\u6b64\u539f\u5e8f\u5217\u7684\u901a\u9879\u516c\u5f0f\u4e3a\uff1a\n$$\na_n = 2030 + 2020(n-1) + 2016n(n-1)\n$$\n\u5bf9\u4ec0\u4e48\u6570\u53d6\u6a21\uff1f\u6211\u4eec\u53d1\u73b0\u539f\u672c\u7684 $a_{11} = 243990$\uff0c\u800c\u5b9e\u9645\u7684 $a_{11} = 10657$\uff0c\u56e0\u6b64\u6a21\u6570\u4e3a $233333$\u3002\n\n```cpp\nnamespace Type2{\n    int mod=233333;\n    inline void sol(){\n        for(register int T=read();T>0;--T){\n            long long n=read();\n            write((2030+2020LL*(n-1)%mod+2016LL*n%mod*(n-1)%mod)%mod),putchar('\\n');\n        }\n    }\n}\n```\n\n### case 3\n\n\u4e5f\u662f\u8f93\u5165\u4e00\u4e2a\u6570\uff0c\u6211\u4eec\u53d1\u73b0 $[1,3]$ \u7684\u6570\u8f93\u51fa $0$\uff1b$[4,12]$ \u4e4b\u5185\u8f93\u51fa $1$\uff1b$[13,28]$ \u8f93\u51fa $2$\uff1b$[29,50]$ \u8f93\u51fa $3$\uff1b$[51,78]$ \u8f93\u51fa $4$\u2026\u2026\n\n\u770b\u4e86\u5f88\u4e45\u6ca1\u627e\u5230\u89c4\u5f8b\uff0c\u628a\u6570\u5217\u4e22\u5230 OEIS \u4e0a\u5f97\u5230\uff1a\n$$\na_n = \\left\\lfloor \\sqrt{\\frac{n}{\\pi}} \\right\\rfloor\n$$\n\n```cpp\nnamespace Type3{\n    const double Pi=acos(-1);\n    inline void sol(){\n        for(register int T=read();T>0;--T){\n            int n=read();\n            write(floor(sqrt(1.0*n/Pi))),putchar('\\n');\n        }\n    }\n}\n```\n\n### case 4\n\n\u8f93\u5165\u6570\u636e\u975e\u5e38\u56fe\u8bba\uff0c\u6211\u4eec\u4e22\u5230 graph editor \u4e0a\uff0c\u9996\u5148\u53ef\u4ee5\u786e\u5b9a\u56fe\u662f\u53ef\u4ee5\u4e0d\u8fde\u901a\u7684\uff0c\u4e14\u5982\u679c\u5b83\u662f\u6709\u5411\u56fe\uff0c\u90a3\u4e48\u4e5f\u4e0d\u4e00\u5b9a\u8981\u662f DAG\u3002\n\n\u56fe\u8bba\u7684\u8bdd\u53ef\u4ee5\u5148\u8bd5\u8bd5\u4e00\u68f5\u6811\uff0c\u4e0d\u96be\u53d1\u73b0\u90fd\u8f93\u51fa $n^2$\uff0c\u7136\u540e\u5c1d\u8bd5\u52a0\u4e00\u6761\u8fb9\uff0c\u53d1\u73b0\u4ecd\u7136\u662f $n^2$\uff0c\u8fdb\u4e00\u6b65\u6d4b\u8bd5\uff0c\u611f\u89c9\u5728\u6811\u4e0a\u4efb\u610f\u52a0\u8fb9\u90fd\u8f93\u51fa $n^2$\uff0c\u800c\u4e14\u901a\u8fc7\u8c03\u6362\u8fb9\u7684\u987a\u5e8f\u548c\u65b9\u5411\u7b54\u6848\u4e0d\u53d8\uff0c\u731c\u60f3\u8f93\u5165\u56fe\u662f\u65e0\u5411\u56fe\u3002\n\n\u7ed3\u5408\u7b2c\u4e00\u4e2a\u6570\u636e\uff0c\u8003\u8651\u4e0d\u8fde\u901a\u56fe\uff0c\u5c31\u4e0d\u96be\u5f97\u5230\u7b54\u6848\u4e3a\u6bcf\u4e2a\u8fde\u901a\u5757\u5927\u5c0f\u7684\u5e73\u65b9\u548c\u4e86\u3002\n\n```cpp\nnamespace Type4{\n    bool vis[100005];\n    int n,m,cnt,sz[100005],ans;\n    inline void dfs(int u){\n        vis[u]=1;\n        ++sz[cnt];\n        for(register int i=e.hd[u];i;i=e.nx[i]){\n            int v=e.to[i];\n            if(!vis[v]) dfs(v);\n        }\n    }\n    inline void sol(){\n        for(register int T=read();T>0;--T){\n            n=read(),m=read(),ans=cnt=0;\n            e.clear(),memset(vis,0,sizeof(vis));\n            for(register int i=1;i<=m;++i){\n                int u=read(),v=read();\n                e.add(u,v),e.add(v,u);\n            }\n            for(register int i=1;i<=n;++i) if(!vis[i]){\n                sz[++cnt]=0;\n                dfs(i);\n                ans+=sz[cnt]*sz[cnt];\n            }\n            write(ans),putchar('\\n');\n        }\n    }\n}\n```\n\n### case 5\n\n\u672c\u6765\u4ee5\u4e3a\u662f\u4e00\u68f5\u6709\u8fb9\u6743\u7684\u6811\uff0c\u52a0\u4e86\u5f88\u591a\u589e\u8865\u8fb9\uff0c\u7136\u540e\u6c42\u4e00\u4e9b\u5947\u602a\u7684\u4e1c\u897f\u6bd4\u5982\u751f\u6210\u6811\u4e4b\u7c7b\u7684\u2026\u2026\n\n\u5176\u5b9e\u540e\u9762\u90a3\u4e9b\u201c\u6ca1\u6709\u8fb9\u6743\u7684\u8fb9\u201d\u662f\u201c\u8be2\u95ee\u4e24\u4e2a\u70b9\u201d\u2026\u2026\n\n\u660e\u786e\u4e86\u8fd9\u4e00\u70b9\u5c31\u5f88\u7b80\u5355\u4e86\uff0c\u6d4b\u8bd5\u7684\u65f6\u5019\u8003\u8651\u53ea\u653e\u4e00\u7ec4\u8be2\u95ee\uff0c\u7136\u540e\u770b\u8f93\u51fa\u7b54\u6848\u662f\u4ec0\u4e48\uff0c\u518d\u8bd5\u8bd5\u591a\u7ec4\u8be2\u95ee\u7684\u60c5\u51b5\u3002\u5c31\u53ef\u4ee5\u53d1\u73b0\u5176\u5b9e\u662f\u67e5\u5bfb\u6811\u4e0a\u4e24\u70b9\u8ddd\u79bb\uff0c\u8f93\u51fa\u6240\u6709\u8be2\u95ee\u7b54\u6848\u7684\u5f02\u6216\u548c\u3002\n\n```cpp\nnamespace Type5{\n    int fa[100005][22],dis[100005][22],dep[100005];\n    int n,Q,ans;\n    inline void dfs(int u,int f){\n        fa[u][0]=f,dep[u]=dep[f]+1;\n        for(register int i=1;i<=20;++i){\n            fa[u][i]=fa[fa[u][i-1]][i-1],\n            dis[u][i]=dis[u][i-1]+dis[fa[u][i-1]][i-1];\n        }\n        for(register int i=e.hd[u];i;i=e.nx[i]){\n            int v=e.to[i];\n            if(v==f) continue;\n            dis[v][0]=e.ln[i];\n            dfs(v,u);\n        }\n    }\n    inline int dist(int x,int y){\n        if(x==y) return 0;\n        if(dep[x]<dep[y]) swap(x,y);\n        int res=0;\n        for(register int i=20;i>=0;--i)\n            if(dep[fa[x][i]]>=dep[y]){\n                res+=dis[x][i],\n                x=fa[x][i];\n            }\n        if(x==y) return res;\n        for(register int i=20;i>=0;--i)\n            if(fa[x][i]!=fa[y][i]){\n                res+=dis[x][i]+dis[y][i];\n                x=fa[x][i],y=fa[y][i];\n            }\n        return res+dis[x][0]+dis[y][0];\n    }\n    inline void sol(){\n        for(register int T=read();T>0;--T){\n            n=read(),Q=read(),ans=0;\n            e.clear();\n            for(register int i=1;i<n;++i){\n                int u=read(),v=read(),w=read();\n                e.add(u,v,w),e.add(v,u,w);\n            }\n            dfs(1,0);\n            while(Q--){\n                int x=read(),y=read();\n                ans^=dist(x,y);\n            }\n            write(ans),putchar('\\n');\n        }\n    }\n}\n```\n\n### case 6\n\n\u548c\u4e0a\u4e00\u4e2a\u6d4b\u8bd5\u70b9\u975e\u5e38\u50cf\u3002\u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\u4e0d\u96be\u5f97\u5230\u5176\u5b9e\u5c31\u662f\u628a\u67e5\u5bfb\u4e24\u70b9\u8ddd\u79bb\u6539\u6210\u4e86\u67e5\u5bfb\u4e24\u70b9\u8def\u5f84\u8fb9\u6743\u6700\u5c0f\u503c\u3002\n\n\u4e0d\u8fc7\u5e94\u8be5\u6ce8\u610f\u7684\u662f\uff0c\u8be2\u95ee\u4e24\u4e2a\u76f8\u540c\u7684\u70b9\u65f6\u7b54\u6848\u662f\u591a\u5c11\u3002\u76f4\u63a5\u968f\u4fbf\u4e22\u4e00\u4e2a\u6811\uff0c\u7136\u540e\u53ea\u67e5\u4e00\u4e2a\u8be2\u95ee\uff0c\u67e5\u5bfb\u4e00\u4e2a\u70b9\u5230\u5b83\u81ea\u5df1\uff0c\u53ef\u4ee5\u5f97\u5230\u82e5\u4e24\u70b9\u76f8\u540c\uff0c\u5219\u7b54\u6848\u4e3a $1987654321$\u3002\n\n```cpp\nnamespace Type6{\n    int fa[100005][22],dis[100005][22],dep[100005];\n    int n,Q,ans;\n    const int inf=1000000000000000LL;\n    inline void dfs(int u,int f){\n        fa[u][0]=f,dep[u]=dep[f]+1;\n        for(register int i=1;i<=20;++i){\n            fa[u][i]=fa[fa[u][i-1]][i-1],\n            dis[u][i]=min(dis[u][i-1],dis[fa[u][i-1]][i-1]);\n        }\n        for(register int i=e.hd[u];i;i=e.nx[i]){\n            int v=e.to[i];\n            if(v==f) continue;\n            dis[v][0]=e.ln[i];\n            dfs(v,u);\n        }\n    }\n    inline int dist(int x,int y){\n        if(x==y) return 1987654321;\n        if(dep[x]<dep[y]) swap(x,y);\n        int res=inf;\n        for(register int i=20;i>=0;--i)\n            if(dep[fa[x][i]]>=dep[y]){\n                res=min(res,dis[x][i]),\n                x=fa[x][i];\n            }\n        if(x==y) return res;\n        for(register int i=20;i>=0;--i)\n            if(fa[x][i]!=fa[y][i]){\n                res=min(res,min(dis[x][i],dis[y][i])),\n                x=fa[x][i],y=fa[y][i];\n            }\n        return min(res,min(dis[x][0],dis[y][0]));\n    }\n    inline void sol(){\n        for(register int T=read();T>0;--T){\n            n=read(),Q=read(),ans=0;\n            e.clear(),memset(dis,0x3f,sizeof(dis));\n            for(register int i=1;i<n;++i){\n                int u=read(),v=read(),w=read();\n                e.add(u,v,w),e.add(v,u,w);\n            }\n            dfs(1,0);\n            while(Q--){\n                int x=read(),y=read();\n                ans^=dist(x,y);\n            }\n            write(ans),putchar('\\n');\n        }\n    }\n}\n```\n\n### case 7\n\n\u7b2c\u4e8c\u96be\u627e\u5230\u89c4\u5f8b\u7684\u70b9\u3002\n\n\u4ea4\u6362\u4efb\u610f\u4e24\u4e2a\u6570\uff0c\u7b54\u6848\u4e0d\u53d8\uff0c\u56e0\u6b64\u6570\u5bf9\u662f\u65e0\u5e8f\u7684\u3002\n\n\u627e\u89c4\u5f8b\u53d1\u73b0\u5bf9\u4e8e\u540c\u4e00\u4e2a $x$\uff0c$(3,x)-(2,x)$ \u7684\u5dee\u548c\u4f59\u6570\u6709\u5173\u3002\u63a8\u6d4b\u5b83\u662f\u4e00\u4e2a\u6570\u8bba\u51fd\u6570\u3002\n\n\u4f46\u662f $(2,2)=5$\uff0c\u56e0\u6b64\u5b83\u4e0d\u5e94\u8be5\u662f\u4efb\u4f55\u5355\u5143\u6570\u8bba\u51fd\u6570\u76f8\u52a0\u6216\u76f8\u4e58\uff1f\n\n\u4e8c\u5143\uff1f\n\n\u6700\u540e\u5f97\u5230\u7b54\u6848\u4e3a\uff1a\n$$\n\\sum_{i=1}^a \\sum_{j=1}^b \\gcd(i,j)\n$$\n\u679a\u4e3e $\\gcd$\uff0c\u8003\u8651\u83ab\u53cd\uff1a\n$$\n\\sum_{d=1}^{\\min(a,b)} d \\sum_{x=1}^{\\left\\lfloor\\frac{\\min(a,b)}{d}\\right\\rfloor} \\mu(x) \\left\\lfloor\\frac{a}{dx}\\right\\rfloor \\left\\lfloor\\frac{b}{dx}\\right\\rfloor\n$$\n\u6362\u5143\uff1a\n$$\n\\sum_{t=1}^{\\min(a,b)} \\left\\lfloor\\frac{a}{t}\\right\\rfloor \\left\\lfloor\\frac{b}{t}\\right\\rfloor \\sum_{x\\mid t} \\frac{t}{x} \\mu(x)\n$$\n\u540e\u9762\u662f $\\mu\\ast\\mathrm{id}=\\varphi$\uff1a\n$$\n\\sum_{t=1}^{\\min(a,b)} \\varphi(t) \\left\\lfloor\\frac{a}{t}\\right\\rfloor \\left\\lfloor\\frac{b}{t}\\right\\rfloor\n$$\n\u9884\u5904\u7406\u6b27\u62c9\u51fd\u6570\u7684\u524d\u7f00\u548c\uff0c\u6574\u9664\u5206\u5757\u53ef\u4ee5\u505a\u5230 $\\mathcal O(\\sqrt{n})$\u3002\u5f53\u7136\u5bf9\u4e8e\u672c\u9898\u800c\u8a00\uff0c$\\mathcal O(n)$ \u8dd1\u4e00\u904d\u4e5f\u53ef\u4ee5\u3002\n\n```cpp\nnamespace Type7{\n    int pr[1000006],cntp,phi[1000006];\n    bool isp[1000006];\n    inline void getpr(int n){\n        memset(isp,1,sizeof(isp));isp[1]=0;\n        phi[1]=1;\n        for(register int i=2;i<=n;++i){\n            if(isp[i]){\n                pr[++cntp]=i,\n                phi[i]=i-1;\n            }\n            for(register int j=1;j<=cntp && i*pr[j]<=n;++j){\n                isp[i*pr[j]]=0;\n                if(i%pr[j]==0){\n                    phi[i*pr[j]]=phi[i]*pr[j];\n                    break;\n                }\n                phi[i*pr[j]]=phi[i]*phi[pr[j]];\n            }\n        }\n        for(register int i=1;i<=n;++i)\n            phi[i]+=phi[i-1];\n    }\n    inline void sol(){\n        getpr(1000000);\n        for(register int T=read();T>0;--T){\n            int a=read(),b=read(),up=min(a,b),ans=0;\n            for(register int l=1,r;l<=up;l=r+1){\n                r=min(a/(a/l),b/(b/l));\n                ans+=(a/l)*(b/l)*(phi[r]-phi[l-1]);\n            }\n            write(ans),putchar('\\n');\n        }\n    }\n}\n```\n\n### case 8\n\n\u5f88\u4f69\u670d\u80fd\u770b\u51fa\u89c4\u5f8b\u7684\u4eba\u3002\n\n\u627e\u4e86\u5f88\u4e45\u6ca1\u627e\u5230\u89c4\u5f8b\uff0c\u5f00\u9898\u89e3\uff0c\u9898\u89e3\u8bf4\u662f\u6c42\u672c\u8d28\u4e0d\u540c\u5b50\u4e32\u4e2a\u6570\u2026\u2026\n\n\u7136\u540e\u5c31\u53d8\u6210\u540e\u7f00\u6570\u7ec4\u677f\u5b50\u4e86\u2026\u2026\n\n```cpp\nnamespace Type8{\n    struct SA{\n        int sm[1000006],rk[1000006],sa[1000006],tp[1000006],ht[1000006],m,n;\n        SA(){m=300;memset(sa,0,sizeof(sa));}\n\n        inline void sort(){\n            memset(sm,0,sizeof(sm));\n            for(register int i=1;i<=n;++i)\n                ++sm[rk[i]];\n            for(register int i=1;i<=m;++i)\n                sm[i]+=sm[i-1];\n            for(register int i=n;i>=1;--i){\n                sa[sm[rk[tp[i]]]]=tp[i],\n                --sm[rk[tp[i]]];\n            }\n        }\n        inline void build(int a[]){\n            for(register int i=1;i<=n;++i){\n                rk[i]=a[i],\n                tp[i]=i;\n            }\n            sort();\n            int len=1;\n            while(1){\n                int cnt=0;\n                for(register int i=1;i<=len;++i)\n                    tp[++cnt]=n-len+i;\n                for(register int i=1;i<=n;++i)\n                    if(sa[i]>len)\n                        tp[++cnt]=sa[i]-len;\n                sort(),\n                memcpy(tp,rk,sizeof(rk));\n                rk[sa[1]]=cnt=1;\n                for(register int i=2;i<=n;++i){\n                    if(tp[sa[i]]==tp[sa[i-1]] && tp[sa[i]+len]==tp[sa[i-1]+len])\n                        rk[sa[i]]=cnt;\n                    else\n                        rk[sa[i]]=++cnt;\n                }\n                m=cnt,len<<=1;\n                if(cnt>=n) break;\n            }\n            for(register int i=1,j=0;i<=n;++i){\n                if(j) --j;\n                int k=sa[rk[i]-1];\n                while(a[i+j]==a[j+k])\n                    ++j;\n                ht[rk[i]]=j;\n            }\n        }\n    }sa;\n    int n,a[1000006];\n    inline void sol(){\n        for(register int T=read();T>0;--T){\n            n=sa.n=read();\n            for(register int i=1;i<=n;++i)\n                a[i]=read();\n            sa.build(a);\n            int ans=n*(n+1)/2;\n            for(register int i=1;i<=n;++i)\n                ans-=sa.ht[i];\n            write(ans),putchar('\\n');\n        }\n    }\n}\n```\n\n### case 9\n\n\u8f93\u5165\u4e86 $n$ \u4e2a\u6570\u5bf9\uff1f\u8003\u8651 $n=2$ \u7684\u60c5\u51b5\uff0c\u53d1\u73b0\u5b83\u8f93\u51fa\u7684\u5c31\u662f\u4e24\u70b9\u8ddd\u79bb\u3002\n\n\u8fd9\u4e2a\u65f6\u5019\u4e00\u822c\u6709\u51e0\u79cd\u60c5\u51b5\uff1a\u51f8\u5305\u3001\u5e73\u9762\u6700\u8fd1\u70b9\u5bf9\u3001\u5e73\u9762\u6700\u8fdc\u70b9\u5bf9\u3001\u67d0\u70b9\u5230\u5176\u5b83\u6240\u6709\u70b9\u7684\u8ddd\u79bb\u548c\u3002\n\n\u7136\u800c\u8fd9\u4e9b\u60c5\u51b5\u90fd\u53ef\u4ee5\u7528\u4e00\u4e2a\u6b63\u65b9\u5f62\u5224\u65ad\u51fa\u6765\uff0c\u8f93\u5165\u4e00\u4e2a $(1,1),(1,2),(2,1),(2,2)$ \u7684\u6b63\u65b9\u5f62\uff0c\u5b83\u8f93\u51fa $1$\u3002\u8fdb\u4e00\u6b65\u5730\u6d4b\u8bd5\uff0c\u4e0d\u96be\u5f97\u5230\u5176\u5b9e\u5c31\u662f\u5728\u7b97\u5e73\u9762\u6700\u8fd1\u70b9\u5bf9\u3002\n\n\u7136\u800c\u6211\u5e73\u9762\u6700\u8fd1\u70b9\u5bf9\u4e00\u76f4\u90fd\u662f K-DTree \u6c34\u8fc7\u53bb\u7684\uff08\u4e0d\u4f1a\u5206\u6cbb.jpg\uff09\uff0c\u4f46 $10^6$ \u663e\u7136\u8dd1\u4e0d\u52a8\u3002\n\n\u5e73\u9762\u6700\u8fd1\u70b9\u5bf9\u52a0\u5f3a\u7248\u7684\u9898\u89e3\u4e2d\uff0c\u6700\u9ad8\u8d5e\u9898\u89e3\u662f\u8fd9\u4e48\u5199\u7684\uff1a\n\n> \u6211\u4eec\u5145\u5206\u53d1\u626c\u4eba\u7c7b\u667a\u6167\uff1a\n>\n> \u5c06\u6240\u6709\u70b9\u5168\u90e8\u7ed5\u539f\u70b9\u65cb\u8f6c\u540c\u4e00\u4e2a\u89d2\u5ea6\uff0c\u7136\u540e\u6309\u6a2a\u5750\u6807\u6392\u5e8f\u3002\n>\n> \u6839\u636e\u6570\u5b66\u76f4\u89c9\uff0c\u5728\u968f\u673a\u65cb\u8f6c\u540e\uff0c\u7b54\u6848\u4e2d\u7684\u4e24\u4e2a\u70b9\u5728\u6570\u7ec4\u4e2d\u80af\u5b9a\u4e0d\u4f1a\u79bb\u5f97\u592a\u8fdc\u3002\n>\n> \u6240\u4ee5\u6211\u4eec\u53ea\u53d6\u6bcf\u4e2a\u70b9\u5411\u540e\u7684 $5$ \u4e2a\u70b9\u6765\u8ba1\u7b97\u3002\n\n\uff08\u2014\u2014[3A17K](https://www.luogu.com.cn/user/12655)\uff09\n\n\u53ef\u4ee5\u901a\u8fc7\u3002\n\n```cpp\nnamespace Type9{\n    struct dot{\n        double x,y;\n        bool operator < (const dot &b) const{\n            dot a=*this;\n            return a.x<b.x;\n        }\n    }a[1000006];\n    int n;\n    double res;\n    const double Pi=acos(-1);\n    inline double dist(dot a,dot b){\n        return sqrt((a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y));\n    }\n    inline void calc(double ang){\n        ang=ang/180.0*Pi;\n        for(register int i=1;i<=n;++i){\n            double x=a[i].x,y=a[i].y;\n            a[i].x=x*cos(ang)-y*sin(ang),\n            a[i].y=x*sin(ang)+y*cos(ang);\n        }\n        sort(a+1,a+1+n);\n        for(register int i=1;i<=n;++i)\n            for(register int j=1;j<=5 && i+j<=n;++j)\n                res=min(res,dist(a[i],a[i+j]));\n    }\n    inline void sol(){\n        srand(time(0));\n        for(register int T=read();T>0;--T){\n            n=read(),res=1e15;\n            for(register int i=1;i<=n;++i)\n                a[i].x=read(),a[i].y=read();\n            calc(rand()%360);\n            printf(\"%.3lf\\n\",res);\n        }\n    }\n}\n```\n\n### case 10\n\n\u65e0\u8bba\u600e\u4e48\u8f93\u5165\u90fd\u8f93\u51fa $\\texttt{invalid input!}$ \u662f\u4e3a\u4ec0\u4e48\u5462\uff1f\n\n\u5c1d\u8bd5\u7684\u5b57\u7b26\u4e32\u90fd\u4e0d\u5408\u6cd5\u5417\uff1f\n\n\u4e0d\u5408\u6cd5\uff1f\n\n\u5efa\u8bae\u56de\u5230\u539f\u9898\u770b\u4e00\u4e0b\uff0c\u4e0d\u5408\u6cd5\u7684\u65f6\u5019\u8f93\u51fa $\\texttt{invalid input.}$\uff08\u672b\u5c3e\u662f\u4e2a\u53e5\u53f7\uff09\uff0c\u800c\u8fd9\u91cc\u8f93\u51fa\u7684\u672b\u5c3e\u662f\u611f\u53f9\u53f7\u3002\n\n\u56e0\u6b64\u8fd9\u4e2a\u70b9\u5c31\u662f\u968f\u4fbf\u600e\u4e48\u8f93\u5165\uff0c\u53cd\u6b63\u5c31\u8f93\u51fa $\\texttt{invalid input!}$ \u5373\u53ef\u3002\n\n```cpp\nnamespace Type10{\n    inline void sol(){\n        for(register int T=read();T>0;--T)\n            puts(\"invalid input!\");\n    }\n}\n```\n\n## \u9644\u8bb0\n\n\u4e0a\u9762\u7684\u4ee3\u7801\u51d1\u8d77\u6765\u5c31\u662f\u8fd9\u9898\u7684\u4e3b\u8981\u4ee3\u7801\u4e86\u3002\n\n\u56e0\u4e3a\u8fd9\u4e2a\u9898\u662f\u63d0\u4ea4\u7b54\u6848\u9898\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u4ea4\u4ee3\u7801\uff0c\u53ea\u8981\u8fd0\u884c\u4e00\u4e0b\u8dd1\u51fa\u6bcf\u4e2a\u70b9\u5c31\u884c\u4e86\u3002\n\n\uff08\u800c\u4e14\u4f60\u4eec\u771f\u7684\u4f1a\u60f3\u53bb\u770b\u4e00\u4e2a 10k \u7684\u4ee3\u7801\u5417\u2026\u2026\uff09",
        "postTime": 1645853953,
        "uid": 181776,
        "name": "_Arahc_",
        "ccfLevel": 7,
        "title": "P5246 \u6d88\u5931\u7684\u6e90\u4ee3\u7801"
    }
]
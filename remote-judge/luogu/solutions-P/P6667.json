[
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/zkyJuruo/p/14320571.html)\n\n\u4f17\u6240\u5468\u77e5\u8fd9\u9898\u53ef\u4ee5\u7528\u65af\u7279\u6797\u6570 $m^2$ \u6c42\uff0c\u4f46\u662f\u8981\u5feb\u901f\u63d2\u503c\u65af\u7279\u6797\u6570\u7b49\u4e00\u5806\u4e1c\u897f\u4f30\u8ba1\u8fc7\u4e0d\u4e86\u3002\n\n\u4ee4 $f(x) = \\sum\\limits_{i = 0}^{m} \\binom{x}{i} s_i$\u3002$\\binom{x}{i}$ \u662f $i$ \u6b21\u591a\u9879\u5f0f\uff0c\u56e0\u6b64\u5b58\u5728\u8fd9\u6837\u7684 $s$ \u3002\n\n\u4e8c\u9879\u5f0f\u53cd\u6f14\uff1a$f(x) = \\sum\\limits_{i = 0}^{x} \\binom{x}{i} s_i \\Leftrightarrow s_x = \\sum\\limits_{i = 0}^{x} \\binom{x}{i} (-1)^{x - i} f(i)$\n\n\u901a\u8fc7\u5377\u79ef\u53ef\u4ee5\u5feb\u901f\u5f97\u5230 $s$ \u6570\u7ec4\u3002\n\n\u901a\u8fc7\u8fd9\u4e2a\u6211\u4eec\u53ef\u4ee5\u5feb\u901f\u5f97\u5230\u4e00\u4e2a\u70b9\u7684\u70b9\u503c\u3002\n\n\uff08\u77e5\u9053\u8fd9\u4e2a\u8fd9\u9898\u5c31\u4e0d\u96be\u4e86\uff09\n\n\u63a8\u5f0f\u5b50\uff1a\n\n$$\\sum\\limits_{k = 0}^{n} \\sum\\limits_{i = 0}^{m}s_i  \\binom{k}{i} \\binom{n}{k} x^k (1 - x)^{n - k}$$\n\n$$\\sum\\limits_{k = 0}^{n} \\sum\\limits_{i = 0}^{m}s_i  \\binom{k}{i} \\binom{n}{k} x^k (1 - x)^{n - k}$$\n\n$$\\sum\\limits_{k = 0}^{n} \\sum\\limits_{i = 0}^{m} s_i \\binom{n}{i} \\binom{n - i}{k - i} x^k (1 - x)^{n - k}$$\n\n$$\\sum\\limits_{i = 0}^{m} s_i \\binom{n}{i} \\sum\\limits_{k = i}^{n} \\binom{n - i}{k - i} x^k (1 - x)^{n - k}$$\n\n$$\\sum\\limits_{i = 0}^{m} s_i \\binom{n}{i} \\sum\\limits_{k = 0}^{n - i} \\binom{n - i}{k} x^{k + i} (1 - x)^{n - k - i}$$\n\n$$\\sum\\limits_{i = 0}^{m} s_i \\binom{n}{i} x^i \\sum\\limits_{k = 0}^{n - i} \\binom{n - i}{k} x^{k} (1 - x)^{n - i - k}$$\n\n$$\\sum\\limits_{i = 0}^{m} s_i \\binom{n}{i} x^i (x + 1 - x)^{n - i}$$\n\n$$\\sum\\limits_{i = 0}^{m} s_i \\binom{n}{i} x^i$$\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u505a\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(m \\log m)$\n\n\u4ee3\u7801\uff1a\n\n```cpp\nint fac[N], ifac[N];\nvoid minit(int x) {\n\tfac[0] = 1;\n\tL(i, 1, x) fac[i] = (ll) fac[i - 1] * i % mod;\n\tifac[x] = qpow(fac[x]);\n\tR(i, x, 1) ifac[i - 1] = (ll) ifac[i] * i % mod;\n}\nint fpow(int x) {\n\treturn x % 2 == 0 ? 1 : mod - 1;\n}\nint n, m, x, f[N], g[N], s[N], ans;\nint main() {\n\tn = read(), m = read(), x = read();\n\tminit(m), init(m << 1);\n\tL(i, 0, m) f[i] = (ll) ifac[i] * fpow(i) % mod;\n\tL(i, 0, m) g[i] = (ll) ifac[i] * read() % mod;\n\tMul(f, g, s, m + 1, m + 1);\n\tL(i, 0, m) s[i] = (ll) s[i] * fac[i] % mod;\n\tint now = 1;\n\tL(i, 0, m) (ans += (ll) now * s[i] % mod * ifac[i] % mod) %= mod, now = (ll) now * x % mod * (n - i) % mod;\n\tcout << ans << endl;\n\treturn 0;\n}\n```\n\n**\u795d\u5927\u5bb6\u5b66\u4e60\u6109\u5feb\uff01**",
        "postTime": 1611469630,
        "uid": 173660,
        "name": "zhoukangyang",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6667 \u3010[\u6e05\u534e\u96c6\u8bad2016] \u5982\u4f55\u4f18\u96c5\u5730\u6c42\u548c\u3011"
    },
    {
        "content": "## \u9898\u610f\n\n\u7ed9\u4e00\u4e2a\u591a\u9879\u5f0f $f(x)$ \u7684 \u524d $m$ \u4e2a\u6b63\u6574\u6570\u5904\u7684\u70b9\u503c \u6c42:\n$$\n\\sum_{i=0}^{n}f(i){n\\choose i}x^i(1-x)^{n-i}\n$$\n\n## solution\n\n\u4e4b\u524d\u63a8\u4e86\u4e2a $\\mathcal O(n\\log n)$ \u7684\u505a\u6cd5 \u770b\u5230 EI \u5728 uoj \u4e0a 0ms \u70b9\u8fdb\u4ee3\u7801\u53d1\u73b0 $\\mathcal O(n)$ \u7684 \u4e8e\u662f\u5c1d\u8bd5\u81ea\u5df1\u63a8\u4e86\u4e00\u4e0b \u5c31\u6709\u4e86\u8fd9\u7bc7\u9898\u89e3\n\n\u5f53\u7136 \u73b0\u5728\u6700\u4f18\u89e3\u90fd\u662f\u6211\u7684\u5566\n\n\u9996\u5148\u6211\u4eec\u8003\u8651 $\\mathcal O(n\\log n)$ \u7684\u7b97\u6cd5\u662f\u600e\u4e48\u505a\u7684 \u8bbe: $f(x)=\\sum_{i=0}^mf_i x^{\\underline i}$\n$$\n\\begin{aligned}\n\\sum_{i=0}^{n}f(i){n\\choose i}x^i(1-x)^{n-i}&=\\sum_{j=0}^mf_j\\sum_{i=0}^n i^{\\underline j}{n\\choose i}x^i(1-x)^{n-i}\\\\\n&=\\sum_{j=0}^mf_jn^{\\underline j}\\sum_{i=j}^n {n - j\\choose i - j}x^{j}(1-x)^{n-i-j}\\\\\n&=\\sum_{j=0}^mf_jn^{\\underline j}x^j\n\\end{aligned}\n$$\n\u6211\u4eec\u8003\u8651\u600e\u4e48\u6c42 $f_i$:\n$$\n\\begin{aligned}\n\\sum_{i=0}^m\\frac{f(i)}{i!}x^i&=\\sum_{i=0}^m \\frac{x^i}{i!}\\sum_{j=0}^m f_j x^{j}\\\\\n&=e^x \\sum_{j=0}^m f_j x^{j}\n\\end{aligned}\n$$\n\u6240\u4ee5\u5bf9\u4e8e $\\mathcal O(n\\log n)$ \u7684\u505a\u6cd5\u76f4\u63a5\u5377\u5c31\u53ef\u4ee5\u6c42\u51fa $f_j$ \u518d\u53cd\u4ee3\u56de\u53bb\u5c31\u53ef\u4ee5\u4e86\n\n\u4f46\u6211\u4eec\u4e0d\u8fd9\u4e48\u60f3 \u6211\u4eec\u8003\u8651\u6c42\u51fa $f(i)$ \u7684\u8d21\u732e \u9996\u5148\u5bf9\u4e8e $f_j$ \u7684\u8d21\u732e\u662f:\n$$\n\\frac{f(i)}{i!}x^ie^{-x}=\\frac{f(i)}{i!}\\sum_{j=0}^{m-i}\\frac{(-1)^j}{j!}x^{i+j}\n$$\n\u4ee3\u56de\u5230\u4e00\u5f00\u59cb\u7684\u5f0f\u5b50:\n$$\n\\frac{1}{i!}\\sum_{j=i}^m \\frac{(-1)^{j-i}}{(j-i)!} n^{\\underline {j}}x^j=\\frac{n^{\\underline i}}{i!}\\sum_{j=0}^{m-i} (-1)^{j} {n - i\\choose j}x^{i+j}\n$$\n\u6211\u4eec\u628a\u540e\u9762\u90a3\u4e2a\u4e1c\u897f\u5355\u72ec\u90a3\u51fa\u6765 \u8bbe $g_i=\\sum_{j=0}^{m-i} (-1)^{j} {n - i\\choose j}x^{i+j}$\n$$\n\\begin{aligned}\ng_i&=\\sum_{j=0}^{m-i} (-1)^{j} {n - i\\choose j}x^{i+j}\\\\\n&=\\sum_{j=0}^{m-i}(-1)^{j}{n - i - 1\\choose j}x^{i+j}+\\sum_{j=0}^{m-i}(-1)^{j}{n - i - 1\\choose j - 1}x^{i+j}\\\\\n&=(-1)^{m-i}{n - i - 1\\choose m - i}x^m+\\frac{1}{x}g_{i+1}-g_{i+1}\n\\end{aligned}\n$$\n\u7279\u5224 $x=1$ \u7136\u540e\u76f4\u63a5 $\\mathcal O(n)$ \u9012\u63a8\u5373\u53ef \u5728 uoj \u5982\u679c\u4f60 rand \u4e2d\u4e86 0ms \u673a\u5b50\u4f60\u5c31\u80fd 0ms \u5566\n\n\u7ed9\u4e2a\u7cbe\u7ec6\u5b9e\u73b0\u7684\u4ee3\u7801:\n\n```cpp\n// EI \u8001\u5e08\u6c42\u653e\u8fc7/dk\n#include <bits/stdc++.h>\n#define N 20005\n#define mod 998244353\n#define ull long long\nusing namespace std;\n\nstruct IO_Tp {\n  constexpr static int _I_Buffer_Size = 1 << 18;\n  char _I_Buffer[_I_Buffer_Size], *_I_pos = _I_Buffer;\n\n  constexpr static int _O_Buffer_Size = 10;\n  char _O_Buffer[_O_Buffer_Size], *_O_pos = _O_Buffer;\n\n  IO_Tp() {\n    fread(_I_Buffer, 1, _I_Buffer_Size, stdin);\n  }\n\n  ~IO_Tp() {\n    fwrite(_O_Buffer, 1, _O_pos - _O_Buffer, stdout);\n  }\n\n  inline IO_Tp &operator>>(int &res) {\n    while (!isdigit(*_I_pos)) ++_I_pos;\n    res = *_I_pos++ & 15;\n    while (isdigit(*_I_pos)) res = res * 10 + (*_I_pos++ & 15);\n    return *this;\n  }\n\n  inline IO_Tp &operator<<(int n) {\n    static char _buf[10];\n    char *_pos = _buf;\n    do\n      *_pos++ = '0' + n % 10;\n    while (n /= 10);\n    while (_pos != _buf) *_O_pos++ = *--_pos;\n    return *this;\n  }\n\n  inline IO_Tp &operator<<(char ch) {\n    *_O_pos++ = ch;\n    return *this;\n  }\n} IO;\n\nint n,m,x,f[N],inv[N],ifac[N];\nint i;\n\ninline int ksm(int a,int b)\n{\n\tint res = 1;\n\twhile (b)\n\t{\n\t\tif (b & 1) res = (ull) res * a % mod;\n\t\ta = (ull) a * a % mod;\n\t\tb >>= 1;\n\t}\n\treturn res;\n}\n\ninline void add(int &x,int y)\n{\n\tx += y;\n\tif (x > mod) x -= mod;\n}\n\ninline void sub(int &x,int y)\n{\n\tx -= y;\n\tif (x < 0) x += mod;\n}\n\nsigned main()\n{\n\tIO >> n >> m >> x;\n\tinv[1] = 1;\n\tfor (i = 2; i <= m; i++) inv[i] = (ull) (mod - mod / i) * inv[mod % i] % mod;\n\tifac[0] = 1;\n\tfor (i = 1; i <= m; i++) ifac[i] = (ull) ifac[i - 1] * inv[i] % mod;\n\tif (x == 1 && n <= m) f[n] = 1;\n\telse if (x == 1)\n\t{\n\t\tint qaq = 1;\n\t\tfor (i = 0; i <= m; i++)\n\t\t\tqaq = (ull) qaq * (n - i) % mod;\n\t\tfor (i = 0; i <= m; i++)\n\t\t\tf[i] = (m - i) & 1 ? mod - qaq : qaq;\n\t\tinv[0] = 1;\n\t\tfor (i = 1; i <= m; i++) inv[i] = (ull) inv[i - 1] * (n - i + 1) % mod;\n\t\tqaq = ksm((ull) inv[m] * (n - m) % mod,mod - 2);\n\t\tfor (i = m; i >= 0; i--)\n\t\t{\n\t\t\tinv[i] = (ull) inv[i] * qaq % mod;\n\t\t\tqaq = (ull) qaq * (n - i) % mod;\n\t\t}\n\t\tfor (i = 0; i <= m; i++)\n\t\t\tf[i] = (ull) f[i] * ifac[i] % mod * ifac[m - i] % mod * inv[i] % mod;\n\t}\n\telse\n\t{\n\t\tint qaq = 1;\n\t\tfor (i = 0; i <= m; i++)\n\t\t{\n\t\t\tif (i & 1) sub(f[0],(ull) qaq * ifac[i] % mod);\n\t\t\telse add(f[0],(ull) qaq * ifac[i] % mod);\n\t\t\tqaq = (ull) qaq * x % mod * (n - i) % mod;\n\t\t}\n\t\tint qwq = ksm(x - 1,mod - 2);\n\t\tfor (i = 1; i <= m; i++)\n\t\t\tf[i] = mod - (ull) qwq * inv[i] % mod * (((ull) (n - i + 1) * x % mod * f[i - 1] + (ull) ifac[i - 1] * ifac[m - i + 1] % mod * ((m - i) & 1 ? mod - qaq : qaq)) % mod) % mod;\n\t}\n\tint ans = 0;\n\tfor (i = 0; i <= m; i++)\n\t{\n\t\tint x;\n\t\tIO >> x;\n\t\tans = (ans + (ull) x * f[i]) % mod;\n\t}\n\tIO << ans;\n\treturn 0;\n}\n```\n\n\n\n",
        "postTime": 1616503358,
        "uid": 68030,
        "name": "serverkiller",
        "ccfLevel": 0,
        "title": "\u5982\u4f55\u4f18\u96c5\u5730\u6c42\u548c\u2014\u2014\u65e0 fft \u76f8\u5173"
    },
    {
        "content": "### \u9898\u9762\n\n\u7ed9\u5b9a $n,x$ \u548c\u591a\u9879\u5f0f $F(x)$ \u5728 $0,1,\\cdots,m$ \u7684\u70b9\u503c $a_i$\uff0c\u6c42\n\n$$\\sum\\limits_{k=0}^{n}F(k)\\binom{n}{k}x^{k}(1-x)^{n-k}$$\n\n\u7b54\u6848\u5bf9 $998244353$ \u53d6\u6a21\u3002\n\n$\\texttt{Data Range:}n\\leq 10^9,m\\leq 2\\times 10^4,0\\leq a_i,x\\lt 998244353$\n\n### \u9898\u89e3\n\n\u76ee\u524d\u662f\u672c\u9898\u6700\u4f18\u89e3\u3002\uff08\u867d\u7136\u5f88\u5feb\u4e0d\u662f\u4e86\uff09\n\n\u5148\u5410\u69fd\u4e00\u53e5\uff1a\u8fd9\u4e2a\u6bd2\u7624 $\\texttt{F\\color{red}ee\\_cle6418}$ \u548b\u6837\u4f8b\u8f93\u51fa\u90fd\u80fd\u6253\u9519\u554a\uff0c\u4e25\u91cd\u5f71\u54cd\u505a\u9898\u4f53\u9a8c\u3002\n\n\u4e0d\u77e5\u9053\u5927\u5bb6\u6709\u6ca1\u6709\u505a\u8fc7 A \u5377\u7684\u7ec4\u5408\u6570\u95ee\u9898\uff0c\u6ca1\u770b\u8fc7\u7684\u53ef\u4ee5\u5148\u53bb\u770b[\u6211\u7684\u9898\u89e3](https://www.luogu.com.cn/blog/Karry5307/solution-p6620)\u3002~~\u9ebb\u70e6\u4e86\u9ebb\u70e6\u4e86\u7ed9\u6211\u70b9\u4e2a\u8d5e\u6367\u4e2a\u573a\u5427~~\n\n\u540c\u6837\uff0c\u6211\u4eec\u8fd8\u662f\u8981\u5bf9\u8fd9\u4e2a\u5f0f\u5b50\u8fdb\u884c\u964d\u7ef4\u6253\u51fb\u3002\u6709\u4e86\u4e0a\u4e00\u9898\u7684\u7ecf\u9a8c\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8003\u8651\u5148\u62c6\u4e0b\u964d\u5e42\u3002\u5047\u8bbe $F(x)=\\sum\\limits_{k=0}^{m}f_kx^{\\underline k}$\uff0c\u90a3\u4e48\u539f\u5f0f\u53ef\u4ee5\u5199\u6210\n\n$$\\sum\\limits_{k=0}^{n}\\binom{n}{k}x^{k}(1-x)^{n-k}\\sum\\limits_{i=0}^{\\min(m,k)}f_i\\frac{k!}{(k-i)!}$$\n\n\u63a5\u4e0b\u6765\u6765\u4e00\u6ce2\u4ea4\u6362\u6c42\u548c\u987a\u5e8f\uff0c\u987a\u624b\u62c6\u6389\u4e8c\u9879\u5f0f\u7cfb\u6570\uff0c\u7ea6\u4e00\u4e0b\u5206\uff1a\n\n$$\\sum\\limits_{i=0}^{m}\\sum\\limits_{k=i}^{n}x^{k}(1-x)^{n-k}f_i\\frac{n!}{(n-k)!(k-i)!}$$\n\n\u5982\u679c\u5206\u5b50\u662f $(n-i)!$ \u90a3\u5c31\u66f4\u597d\u4e86\uff0c\u4e8e\u662f\u53ef\u4ee5\u8003\u8651\u51d1\u4e00\u4e2a\u51fa\u6765\uff1a\n\n$$\\sum\\limits_{i=0}^{m}\\sum\\limits_{k=i}^{n}x^{k}(1-x)^{n-k}f_i\\binom{n-i}{k-i}\\frac{n!}{(n-i)!}$$\n\n\u63a5\u4e0b\u6765\u6709\u4e00\u4e2a\u5f88\u7edd\u5999\u7684\u64cd\u4f5c\uff1a\u4e8c\u9879\u5f0f\u4e2d\u6709\u4e00\u4e2a\u5206\u6bcd\u662f $k-i$\uff0c\u53e6\u4e00\u4e2a\u662f $n-k$\uff0c\u800c $1-x$ \u7684\u6b21\u6570\u662f $n-k$\uff0c\u6240\u4ee5\u6211\u4eec\u4e5f\u60f3\u51d1\u4e00\u4e2a $x$ \u7684\u6b21\u6570\u4e3a $k-i$\uff08\u5176\u5b9e\u8fd9\u4e2a\u64cd\u4f5c\u66fe\u7ecf\u51fa\u73b0\u5728 P6073\uff0c\u4f46\u662f\u90a3\u4e2a\u9898\u4e0d\u4ec5\u62c6\u4e86\u5e42\u6765\u51d1\u5f62\u5f0f\u4e5f\u62c6\u4e86\u4e8c\u9879\u5f0f\u6765\u51d1\u5377\u79ef\uff09\uff0c\u4e8e\u662f\u63d0\u53d6\u4e00\u4e0b\u4e0e $k$ \u65e0\u5173\u7684\u4e1c\u897f\uff0c\u5e76\u51d1 $x$ \u7684\u6307\u6570\uff0c\u5f97\u5230\n\n$$\\sum\\limits_{i=0}^{m}f_ix^i\\frac{n!}{(n-i)!}\\sum\\limits_{k=i}^{n}x^{k-i}(1-x)^{n-k}\\binom{n-i}{k-i}$$\n\n\u63a5\u4e0b\u6765\u5982\u679c\u5bf9\u63a8\u67ff\u5b50\u6709\u611f\u89c9\u7684\u53ef\u4ee5\u76f4\u63a5\u770b\u51fa\u662f\u4e8c\u9879\u5f0f\u5b9a\u7406\uff0c\u5982\u679c\u6ca1\u611f\u89c9\u7684\u8bdd\u53ef\u4ee5\u505a $k\\gets k-i$ \u7684\u4ee3\u6362\uff08\u5c31\u662f\u65b0\u7684 $k$ \u4ee3\u8868\u539f\u6765\u7684 $k-i$\uff09\uff0c\u4ee5\u53ca\u8bbe $p=n-i$\uff1a\n\n$$\\sum\\limits_{i=0}^{m}f_ix^i\\frac{n!}{(n-i)!}\\sum\\limits_{k=0}^{n-i}x^{k}(1-x)^{p-k}\\binom{p}{k}$$\n\n\u6240\u4ee5\u53f3\u8fb9\u7684\u6c42\u548c\u9879\u5c31\u662f $(x+1-x)^{p+1}=1$\uff0c\u4e8e\u662f\u5c31\u5f97\u5230\u6700\u7ec8\u5f0f\u5b50\n\n$$\\sum\\limits_{i=0}^{m}f_ix^i\\frac{n!}{(n-i)!}$$\n\n\u63a5\u4e0b\u6765\u8003\u8651\u600e\u4e48\u6c42\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u3002\n\n\u5148\u8003\u8651\u4e0b\u964d\u5e42\u5355\u9879\u5f0f\u5982\u4f55\u8f6c\u6362\u6210\u666e\u901a\u591a\u9879\u5f0f\uff0c\u8003\u8651 $x^{\\underline n}$ \u7684 $\\texttt{EGF}$\uff0c\u8bbe\u4e3a $F_0(x)$\u3002\uff08\u56e0\u4e3a $k\\geq n$ \u7684\u65f6\u5019\u4e0b\u964d\u5e42\u624d\u6709\u975e\u96f6\u503c\uff09\n\n$$F_0(x)=\\sum\\limits_{k=n}^{\\infty}\\frac{k^{\\underline n}}{k!}x^k$$\n\n\u6839\u636e\u5b9a\u4e49\u5f0f\u62c6\u6389\u4e0b\u964d\u5e42\u5e76\u63d0\u51fa $x^n$\u7ea6\u5206\u5f97\u5230\n\n$$F_0(x)=x^n\\sum\\limits_{k=n}^{\\infty}\\frac{x^{k-n}}{(k-n)!}$$\n\n\u505a $k\\gets k-n$ \u7684\u4ee3\u6362\n\n$$F_0(x)=x^n\\sum\\limits_{k=0}^{\\infty}\\frac{x^k}{k!}$$\n\n\u4e8e\u662f\u5f97\u5230\n\n$$F_0(x)=x^ne^x$$\n\n\u63a5\u4e0b\u6765\u8bbe $F(x)$ \u4e3a\u67d0\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u70b9\u503c\u7684 $\\texttt{EGF}$\uff0c$G(x)$ \u4e3a\u5176\u7cfb\u6570\u7684 $\\texttt{OGF}$\uff08\u6ce8\u610f\uff01\u8fd9\u91cc\u4e0d\u662f $\\texttt{EGF}$\uff01\uff09\uff0c$f$ \u4e3a\u8be5\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u5e8f\u5217\uff0c\u5f97\u5230\n\n$$F(x)=\\sum\\limits_{k=0}^{\\infty}f_kx^{\\underline k}=e^x\\sum\\limits_{k=0}^{\\infty}f_kx^k=e^xG(x)$$\n\n\u6240\u4ee5 $G(x)=e^{-x}F(x)$\u3002\n\n\u9898\u9762\u4e2d\u7ed9\u6211\u4eec\u7684\u662f $F(x)$\uff0c\u6240\u4ee5\u53ef\u4ee5\u6c42\u51fa $G(x)$ \u5e76\u5f97\u5230\u7b54\u6848\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(m\\log m)$\u3002\n\n$\\texttt{Q\\color{red}iuly}$ \u8bf4\u80fd\u7528 $\\texttt{Q\\color{red}iuls}$ \u591a\u9879\u5f0f\u505a\uff1f\u62ed\u76ee\u4ee5\u5f85\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<cctype>\n#include<cmath>\n#include<algorithm>\n#pragma GCC optimize(\"Ofast,unroll-loops\")\nusing namespace std;\ntypedef int ll;\ntypedef long long int li;\ntypedef unsigned long long int ull;\nconst ll MAXN=65537,MOD=998244353,G=3,INVG=332748118;\nll n,m,x,res,binom=1,pw=1; \nll rev[MAXN],omgs[MAXN],invo[MAXN],f[MAXN],expn[MAXN],fact[20005],finv[20005];\ninline ll read()\n{\n    register ll num=0;\n    register char ch=getchar();\n    while(!isdigit(ch)&&ch!='-')\n    {\n        ch=getchar();\n    }\n    while(isdigit(ch))\n    {\n        num=(num<<3)+(num<<1)+(ch-'0');\n        ch=getchar();\n    }\n    return num;\n}\ninline ll qpow(ll base,ll exponent)\n{\n    ll res=1;\n    while(exponent)\n    {\n        if(exponent&1)\n        {\n            res=(li)res*base%MOD;\n        }\n        base=(li)base*base%MOD,exponent>>=1;\n    }\n    return res;\n}\ninline void setup(ll cnt)\n{\n    fact[0]=fact[1]=finv[0]=1;\n    for(register int i=1;i<=cnt;i++)\n    {\n        fact[i]=(li)fact[i-1]*i%MOD;\n    }\n    finv[cnt]=qpow(fact[cnt],MOD-2);\n    for(register int i=cnt-1;i;i--)\n    {\n        finv[i]=(li)finv[i+1]*(i+1)%MOD;\n    }\n}\ninline void setupOmg(ll cnt)\n{\n    ll limit=log2(cnt)-1,omg;\n    omg=qpow(G,(MOD-1)>>(limit+1)),omgs[cnt>>1]=1;\n    for(register int i=(cnt>>1|1);i!=cnt;i++)\n    {\n        omgs[i]=(li)omgs[i-1]*omg%MOD;\n    }\n    for(register int i=(cnt>>1)-1;i;i--)\n    {\n        omgs[i]=omgs[i<<1]; \n    }\n}\ninline void NTT(ll *cp,ll cnt,ll inv)\n{\n    static ull tcp[MAXN];\n    register ll cur=0,x,shift=log2(cnt)-__builtin_ctz(cnt);\n    if(inv==-1)\n    {\n        reverse(cp+1,cp+cnt);\n    }\n    for(register int i=0;i<cnt;i++)\n    {\n        tcp[rev[i]>>shift]=cp[i];\n    }\n    for(register int i=2;i<=cnt;i<<=1)\n    {\n        cur=i>>1;\n        for(register int j=0;j<cnt;j+=i)\n        {\n            for(register int k=0;k<cur;k++)\n            {\n                x=tcp[j|k|cur]*omgs[k|cur]%MOD;\n                tcp[j|k|cur]=tcp[j|k]+MOD-x,tcp[j|k]+=x;\n            }\n        }\n    }\n    for(register int i=0;i<cnt;i++)\n    {\n        cp[i]=tcp[i]%MOD;\n    }\n    if(inv==1)\n    {\n        return;\n    }\n    x=MOD-(MOD-1)/cnt;\n    for(register int i=0;i<cnt;i++)\n    {\n        cp[i]=(li)cp[i]*x%MOD;\n    }\n}\ninline void conv(ll fd,ll *f,ll *g,ll *res)\n{\n    static ll tmpf[MAXN],tmpg[MAXN];\n    ll cnt=1,limit=-1;\n    while(cnt<(fd<<1))\n    {\n        cnt<<=1,limit++;\n    }\n    memcpy(tmpf,f,fd<<2),memcpy(tmpg,g,fd<<2);\n    for(register int i=0;i<cnt;i++)\n    {\n        rev[i]=(rev[i>>1]>>1)|((i&1)<<limit);\n    }\n    NTT(tmpf,cnt,1),NTT(tmpg,cnt,1);\n    for(register int i=0;i<cnt;i++)\n    {\n        tmpf[i]=(li)tmpf[i]*tmpg[i]%MOD;\n    }\n    NTT(tmpf,cnt,-1),memcpy(res,tmpf,fd<<2);\n}\nint main()\n{\n    n=read(),m=read(),x=read(),setupOmg(65536),setup(m+1);\n    for(register int i=0;i<=m;i++)\n    {\n        f[i]=(li)read()*finv[i]%MOD,expn[i]=i&1?MOD-finv[i]:finv[i];\n    }\n    conv(m+1,f,expn,f);\n    for(register int i=0;i<=m;i++)\n    {\n        res=(res+(li)f[i]*binom%MOD*pw)%MOD;\n        binom=(li)binom*(n-i)%MOD,pw=(li)pw*x%MOD;\n    }\n    printf(\"%d\\n\",res);\n}\n```",
        "postTime": 1595752768,
        "uid": 60990,
        "name": "Karry5307",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P6667 \u3010[\u6e05\u534e\u96c6\u8bad2016] \u5982\u4f55\u4f18\u96c5\u5730\u6c42\u548c\u3011"
    },
    {
        "content": "\u770b\u5230\u7ec4\u5408\u6570\u4e0e\u591a\u9879\u5f0f\u7684\u7ec4\u5408\uff0c\u8003\u8651\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u3002\n\n$$Q(f,n,x)=\\sum\\limits _{k=0}^{n}f(k)\\binom nk x^k(1-x)^{n-k}$$\n\n$$=\\sum\\limits _{k=0}^{n}\\binom nk x^k(1-x)^{n-k}\\sum_{i=0}^{\\min(m,k)} b_i \\dfrac{k!}{(k-i)!}$$\n\n$$=\\sum_{i=0}^{m} b_i \\sum\\limits _{k=i}^{n}\\dfrac{n!}{k!(n-k)!} x^k(1-x)^{n-k}\\dfrac{k!}{(k-i)!}$$\n\n$$=\\sum_{i=0}^{m} b_i\\sum\\limits _{k=i}^{n}\\dfrac{n!}{(n-k)!(k-i)!} x^k(1-x)^{n-k}$$\n$$=\\sum_{i=0}^{m} b_i\\dfrac{n!}{(n-i)!}x^i\\sum\\limits _{k=i}^{n}\\dfrac{(n-i)!}{(n-k)!(k-i)!} x^{k-i}(1-x)^{n-k}$$\n$$=\\sum_{i=0}^{m} b_i\\dfrac{n!}{(n-i)!}x^i$$\n\n\u5176\u4e2d $f=\\sum b_i x^{\\underline{i}}$\u3002\n\n\u5982\u4f55\u7531\u70b9\u503c\u6c42\u5f97 $f$\uff1fhttps://www.luogu.com.cn/blog/feecle6418/solution-p5394 \u4e2d\u6709\u8be6\u7ec6\u63cf\u8ff0\uff0c\u8fd9\u91cc\u4e0d\u590d\u5236\u8fc7\u6765\u4e86\u3002\n\n\u4ee3\u7801\u9700\u8981\u8005\u79c1\u4fe1\u3002",
        "postTime": 1595318444,
        "uid": 42156,
        "name": "feecle6418",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6667 \u3010[\u6e05\u534e\u96c6\u8bad2016] \u5982\u4f55\u4f18\u96c5\u5730\u6c42\u548c\u3011"
    },
    {
        "content": "\u5199\u4e00\u4e2a\u81ea\u5df1\u7528\u65af\u7279\u6797\u6570\u63a8\u7684\u9898\u89e3\u3002  \n\u9996\u5148\uff0c\u8bbe $f(x)=\\sum\\limits_if_ix^i$\uff0c\u8003\u8651\u5bf9\u4e8e\u6bcf\u4e00\u9879\u5206\u5f00\u5904\u7406\uff0c\u5219\u8fd9\u4e00\u9879\u7684\u7b54\u6848\u4e3a $\\sum\\limits_{k=0}^nf_ik^i\\binom{n}{m}x^k(1-x)^{n-k}$\u3002  \n\u8003\u8651\u7528\u65af\u7279\u6797\u6570\u5c55\u5f00 $k^i$,\u539f\u5f0f\u5373\u4e3a\u3002  \n$\\begin{aligned}\\sum\\limits_{k=0}^nf_ik^i\\binom{n}{m}x^k(1-x)^{n-k}&=f_i\\sum\\limits_{k=0}^n\\binom{n}{k}x^k(1-x)^{n-k}\\sum\\limits_{j=0}^i\\begin{Bmatrix}i\\\\j\\end{Bmatrix}k^{\\underline j}\\\\&=f_i\\sum\\limits_{j=0}^i\\begin{Bmatrix}i\\\\j\\end{Bmatrix}\\sum\\limits_{k=0}^n\\binom{n}{k}x^k(1-x)^{n-k}k^{\\underline j}\\\\&=f_ix^n\\sum\\limits_{j=0}^i\\begin{Bmatrix}i\\\\j\\end{Bmatrix}\\sum\\limits_{k=0}^n\\dfrac{n!}{(n-k)!(k-j)!}\\left(\\dfrac{1-x}{x}\\right)^{n-k}\\\\&=f_ix^n\\sum\\limits_{j=0}^i\\begin{Bmatrix}i\\\\j\\end{Bmatrix}n^{\\underline j}\\sum\\limits_{k=0}^n\\binom{n-j}{n-k}\\left(\\dfrac{1-x}{x}\\right)^{n-k}\\\\&=f_i\\sum\\limits_{j=0}^i\\begin{Bmatrix}i\\\\j\\end{Bmatrix}n^{\\underline j}x^j\\end{aligned}$  \n\u8003\u8651\u6bcf\u4e2a $n^{\\underline j}x^j$ \u5bf9\u7b54\u6848\u4ea7\u751f\u7684\u8d21\u732e\uff0c\u53d1\u73b0\u662f $\\sum\\limits_{i=j}^mf_i\\begin{Bmatrix}i\\\\j\\end{Bmatrix}$\uff0c\u8003\u8651\u6c42\u8fd9\u4e2a\u4e1c\u897f\uff0c\u8bbe\u5b83\u4e3a $b_j$\u3002  \n\u6211\u4eec\u77e5\u9053 $\\sum\\limits_{i=0}^mf_ix^i=a_x$\uff0c\u7ee7\u7eed\u7528\u65af\u7279\u6797\u6570\u5c55\u5f00\u3002  \n$\\begin{aligned}\\sum\\limits_{i=0}^mf_ix^i&=\\sum\\limits_{i=0}^mf_i\\sum\\limits_{j=0}^i\\begin{Bmatrix}i\\\\j\\end{Bmatrix}x^{\\underline j}\\\\&=\\sum\\limits_{j=0}^mx^{\\underline j}\\sum\\limits_{i=j}^mf_i\\begin{Bmatrix}i\\\\j\\end{Bmatrix}\\\\&=\\sum\\limits_{j=0}^mx^{\\underline j}b_j\\\\&=x!\\sum\\limits_{j=0}^m\\dfrac{b_j}{(x-j)!}\\end{aligned}$  \n\u628a $x!$ \u79fb\u5230 $a_x$ \u90a3\u91cc\u53bb\uff0c\u539f\u5f0f\u53d8\u4e3a $\\sum\\limits_{j=0}^m\\dfrac{b_j}{(x-j)!}=\\dfrac{a_x}{x!}$\uff0c\u5c06 $a,b$ \u89c6\u4f5c\u5f62\u5f0f\u5e42\u7ea7\u6570\uff0c\u90a3\u4e48 $B(x)e^x=A^{\\left(e\\right)}(x)$\uff0c\u628a $e^x$ \u79fb\u5230\u53f3\u8fb9\uff0c\u5377\u79ef\u5373\u53ef\u3002  \n```cpp\n#include<bits/stdc++.h>\n#define lc id<<1\n#define rc id<<1|1\n#define fi first\n#define sc second\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\nchar __buf[1<<20],*__p1,*__p2;\n//#define getchar() (__p1==__p2?(__p2=__buf+fread(__p1=__buf,1,1<<20,stdin),__p1==__p2?EOF:*__p1++):*__p1++)\ninline int read() {\n\tint x=0,f=1;\n\tchar c=getchar();\n\twhile(c<'0'||c>'9') {\n\t\tif(c=='-')f=-1;\n\t\tc=getchar();\n\t}\n\twhile(c>='0'&&c<='9')x=x*10+c-'0',c=getchar();\n\treturn x*f;\n}\ninline char pc(char ch,bool bj) {\n\tstatic char buf[1<<16],*p1=buf,*p2=buf+(1<<16);\n\treturn ((bj)||(*p1++=ch)&&p1==p2)&&fwrite(p1=buf,1,p1-buf,stdout),0;\n}\nvoid prt(int x) {\n\tif(x<0)pc('-',0),x=-x;\n\tif(x>9)prt(x/10);\n\tpc(x%10^48,0);\n}\ninline void print(int x,int ch) {\n\tprt(x),pc(ch,0);\n}\nconst int lim=16,maxn=(1<<lim)+5,mod=998244353,ig=332748118;\ntypedef vector<int> pl;\ntypedef pair<pl,pl> pi;\nll qpow(ll x,int y) {\n\tll w=1;\n\twhile(y) {\n\t\tif(y&1)w=w*x%mod;\n\t\tx=x*x%mod,y>>=1;\n\t}\n\treturn w;\n}\nvoid prt(pl x) {\n\tfor(int i=0; i<x.size(); i++)cout<<x[i]<<\" \\n\"[i==x.size()-1];\n}\nnamespace poly {\n\tll inv[maxn],*pw[lim][2],on[maxn];\n\tull x[maxn],y[maxn];\n\tpl zc[maxn],t[maxn*4];\n\tint rev[maxn],las=-1,liv=1;\n\tint geto(int n) {\n\t\tfor(int i=lim-1; ~i; i--)\n\t\t\tif(n>>i&1)return 1<<i+(n!=1<<i);\n\t\treturn 1;\n\t}\n\tvoid clr(ull *a,int l,int r) {\n\t\tmemset(a+l,0,(r-l)*8);\n\t}\n\tvoid copy(ull *a,ll *b,int r) {\n\t\tmemcpy(a,b,r*8);\n\t}\n\tvoid NTT(ull *a,int n,bool pd) {\n\t\tif(n!=las)for(int i=0; i<n; i++)rev[i]=(rev[i>>1]>>1)|(i&1?n>>1:0),las=n;\n\t\tfor(int i=0; i<n; i++)if(i<rev[i])swap(a[i],a[rev[i]]);\n\t\tfor(int m=1,k=0; m<n; m<<=1,k++) {\n\t\t\tconst ll* p=pw[k][pd];\n\t\t\tfor(int i=0; i<n; i+=m<<1)\n\t\t\t\tfor(int j=0; j<m; j++) {\n\t\t\t\t\tll y=p[j]*a[i+j+m]%mod;\n\t\t\t\t\ta[i+j+m]=a[i+j]-y+mod,a[i+j]+=y;\n\t\t\t\t}\n\t\t\tif(k==18||m*2>=n)for(int i=0; i<n; i++)a[i]%=mod;\n\t\t}\n\t}\n\tvoid init() {\n\t\tinv[1]=1;\n\t\tfor(int j=1; j<=(1<<lim); j++) {\n\t\t\tfor(int i=lim; i>=0; i--)\n\t\t\t\tif(j>>i&1) {\n\t\t\t\t\ton[j]=1<<i+(j!=1<<i);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t}\n\t\tfor(int i=0,m=1; i<lim; i++,m<<=1) {\n\t\t\tconst ll b1=qpow(3,(mod-1)/m/2),b0=qpow(ig,(mod-1)/m/2);\n\t\t\tll *p0=pw[i][0]=new ll[m],*p1=pw[i][1]=new ll[m];\n\t\t\t*p0=*p1=1;\n\t\t\tfor(int j=1; j<m; j++)p1[j]=p1[j-1]*b1%mod,p0[j]=p0[j-1]*b0%mod;\n\t\t}\n\t}\n\tpl mul(pl a,const pl b,int k=114514810) {\n\t\tint n=a.size(),m=b.size(),o=on[n+m-1];\n\t\tfor(int i=0; i<n; i++)x[i]=a[i];\n\t\tfor(int i=0; i<m; i++)y[i]=b[i];\n\t\tclr(x,n,o),clr(y,m,o),NTT(x,o,1),NTT(y,o,1);\n\t\tfor(int i=0; i<o; i++)x[i]=x[i]*y[i]%mod;\n\t\tNTT(x,o,0);\n\t\tconst int lim=min(n+m-1,k),invn=qpow(o,mod-2);\n\t\ta.resize(lim);\n\t\tfor(int i=0; i<lim; i++)a[i]=x[i]*invn%mod;\n\t\treturn a;\n\t}\n\tpl mulc(pl a,ll y) {\n\t\tint n=a.size();\n\t\tfor(int i=0; i<n; i++)a[i]=a[i]*y%mod;\n\t\treturn a;\n\t}\n\tpl pre(pl a,int n) {\n\t\tint m=a.size();\n\t\ta.resize(n);\n\t\tif(m<n)for(int i=m; i<n; i++)a[i]=0;\n\t\treturn a;\n\t}\n\tpl add(pl a,pl b) {\n\t\tif(b.size()>a.size())swap(a,b);\n\t\tfor(int i=0; i<b.size(); i++)a[i]=(a[i]+b[i])%mod;\n\t\treturn a;\n\t}\n\tpl del(pl a,pl b) {\n\t\tif(b.size()>a.size())return add(a,mulc(b,mod-1));\n\t\tfor(int i=0; i<b.size(); i++)a[i]=(a[i]-b[i]+mod)%mod;\n\t\treturn a;\n\t}\n\tpl inverse(pl a) {\n\t\tint n=a.size(),o=geto(n)*2;\n\t\tpl f;\n\t\tassert(a[0]),f.push_back(qpow(a[0],mod-2));\n\t\tclr(x,0,o),clr(y,0,o);\n\t\tfor(int m=1; m<n; m<<=1) {\n\t\t\tf=pre(f,2*m);\n\t\t\tfor(int i=0; i<2*m; i++)x[i]=f[i],y[i]=i>=n?0:a[i];\n\t\t\tNTT(x,4*m,1),NTT(y,4*m,1);\n\t\t\tfor(int i=0; i<4*m; i++)x[i]=x[i]*(2-y[i]*x[i]%mod+mod)%mod;\n\t\t\tNTT(x,4*m,0);\n\t\t\tconst int invn=qpow(4*m,mod-2);\n\t\t\tfor(int i=0; i<2*m; i++)f[i]=x[i]*invn%mod;\n\t\t}\n\t\treturn pre(f,n);\n\t}\n\tpl sqrt(pl a) {\n\t\tint n=a.size();\n\t\tpl f;\n\t\tassert(a[0]==1),f.push_back(1);\n\t\tconst int inv2=qpow(2,mod-2);\n\t\tfor(int m=1; m<n; m<<=1)f=pre(f,2*m),f=add(f,mul(inverse(f),pre(a,2*m),2*m)),f=mulc(f,inv2);\n\t\treturn pre(f,n);\n\t}\n\tpl divide(int l,int r) {\n\t\tif(l==r)return zc[l];\n\t\tint mid=l+r>>1;\n\t\tpl f=divide(l,mid);\n\t\tmul(f,divide(mid+1,r));\n\t\treturn f;\n\t}\n\tpl derivative(pl a) {\n\t\tint n=a.size();\n\t\tfor(int i=0; i<n-1; i++)a[i]=1ll*(i+1)*a[i+1]%mod;\n\t\treturn a.resize(n-1),a;\n\t}\n\tpl integral(pl a) {\n\t\tint n=a.size();\n\t\tif(n>liv) {\n\t\t\tfor(int i=liv+1; i<=n; i++)inv[i]=mod-(mod/i)*inv[mod%i]%mod;\n\t\t\tliv=n;\n\t\t}\n\t\ta.resize(n+1);\n\t\tfor(int i=n; i; i--)a[i]=a[i-1]*inv[i]%mod;\n\t\treturn a[0]=0,a;\n\t}\n\tpl ln(pl a) {\n\t\tint n=a.size();\n\t\tassert(a[0]==1);\n\t\ta=mul(inverse(a),derivative(a),n-1);\n\t\treturn integral(a);\n\t}\n\tpl exp(pl a) {\n\t\tint n=a.size();\n\t\tpl f,g;\n\t\tassert(!a[0]),f.push_back(1);\n\t\tfor(int m=1; m<n; m<<=1) {\n\t\t\tg=mulc(ln(f=pre(f,2*m)),mod-1),g[0]++;\n\t\t\tfor(int i=0; i<min(2*m,n); i++)g[i]=(g[i]+a[i])%mod;\n\t\t\tf=mul(f,g);\n\t\t}\n\t\treturn pre(f,n);\n\t}\n\tpl pow(pl a,int y) {\n\t\tif(a[0]!=1) {\n\t\t\tint p=0,n=a.size();\n\t\t\twhile(!a[p]&&p<n)p++;\n\t\t\tint m=n-p;\n\t\t\tpl f;\n\t\t\tif(!m)return pre(f,n);\n\t\t\tf=pre(f,m);\n\t\t\tif(p) {\n\t\t\t\tif(1ll*p*y>n)return pre(f,n);\n\t\t\t\tfor(int i=0; i<m; i++)f[i]=a[i+p];\n\t\t\t} else for(int i=0; i<m; i++)f[i]=a[i];\n\t\t\tconst ll b0=qpow(f[0],y),inv0=qpow(f[0],mod-2);\n\t\t\tf=exp(mulc(ln(mulc(f,inv0)),y));\n\t\t\tfor(int i=0; i<p*y; i++)a[i]=0;\n\t\t\tfor(int i=p*y; i<n; i++)a[i]=f[i-p*y]*b0%mod;\n\t\t\treturn a;\n\t\t}\n\t\treturn exp(mulc(ln(a),y));\n\t}\n\tpi div(pl a,pl b) {\n\t\tint n=a.size(),m=b.size(),l=n-m+1;\n\t\tpl c,d;\n\t\tif(n<m)return c.push_back(0),pi(c,a);\n\t\treverse(a.begin(),a.end()),reverse(b.begin(),b.end());\n\t\tc=pre(mul(pre(a,l),inverse(pre(b,l))),l),d=pre(del(a,mul(b,c)),n);\n\t\treverse(c.begin(),c.end()),reverse(d.begin(),d.end());\n\t\treturn pi(c,pre(d,m-1));\n\t}\n\tvoid build(int id,int l,int r,ll *a) {\n\t\tif(l==r)return t[id].push_back(mod-a[l]),t[id].push_back(1),void();\n\t\tint mid=l+r>>1;\n\t\tbuild(lc,l,mid,a),build(rc,mid+1,r,a),t[id]=mul(t[lc],t[rc]);\n\t}\n\tvoid gpvalue(int id,int l,int r,pl f,ll *ans) {\n\t\tif(l==r)return ans[l]=f[0],void();\n\t\tint mid=l+r>>1;\n\t\tgpvalue(lc,l,mid,div(f,t[lc]).sc,ans),gpvalue(rc,mid+1,r,div(f,t[rc]).sc,ans);\n\t}\n\tpl getpix(int id,int l,int r,ll *ans) {\n\t\tpl f;\n\t\tif(l==r)return f.push_back(ans[l]),f;\n\t\tint mid=l+r>>1;\n\t\treturn add(mul(getpix(lc,l,mid,ans),t[rc]),mul(getpix(rc,mid+1,r,ans),t[lc]));\n\t}\n\tpl langrange(ll *a,ll *b,int n,ll *ans) {\n\t\tbuild(1,1,n,a-1);\n\t\tpl f=derivative(t[1]);\n\t\tgpvalue(1,1,n,f,ans);\n\t\tfor(int i=1; i<=n; i++)ans[i]=b[i-1]*qpow(ans[i],mod-2)%mod;\n\t\treturn getpix(1,1,n,ans);\n\t}\n\tpl qpow(pl y,int n) {\n\t\tpl w,x;\n\t\tw.push_back(1),x.push_back(0),x.push_back(1);\n\t\twhile(n) {\n\t\t\tif(n&1)w=div(mul(w,x),y).sc;\n\t\t\tx=div(mul(x,x),y).sc,n>>=1;\n\t\t}\n\t\treturn w;\n\t}\n}\nll fac[maxn],inv[maxn],ans;\nint n,k,x;\npl f,g;\nint main() {\n\tn=read(),k=read(),x=read(),fac[0]=1,f.resize(k+1),g.resize(k+1),poly::init();\n\tfor(int i=1; i<=k; i++)fac[i]=fac[i-1]*i%mod;\n\tinv[k]=qpow(fac[k],mod-2);\n\tfor(int i=k; i; i--)inv[i-1]=inv[i]*i%mod;\n\tfor(int i=0; i<=k; i++)f[i]=read()*inv[i]%mod,g[i]=i&1?mod-inv[i]:inv[i];\n\tf=poly::mul(f,g,k+1);\n\tll now=1,pw=1;\n\tfor(int i=0; i<=k; i++)ans=(ans+now*pw%mod*f[i])%mod,now=now*(n-i)%mod,pw=pw*x%mod;\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1658402054,
        "uid": 104324,
        "name": "abruce",
        "ccfLevel": 7,
        "title": "\u9898\u89e3--P6667 [\u6e05\u534e\u96c6\u8bad2016] \u5982\u4f55\u4f18\u96c5\u5730\u6c42\u548c"
    },
    {
        "content": "## Tag\n\n\u591a\u9879\u5f0f\uff0c\u63a8\u5f0f\u5b50\u3002\n\n## Preface\n\nupd1\uff1a\u66f4\u65b0\u4e86\u673a\u68b0\u5316\u6c42\u89e3\u7684\u7ebf\u6027\u505a\u6cd5\u3002\n\nupd2\uff1a\u4fee\u6539\u4e86\u90e8\u5206\u5185\u5bb9\u8ba9\u6587\u7ae0\u4e0d\u90a3\u4e48\u5177\u6709\u9519\u8bef\u5f15\u5bfc\u6027\u3002\n\n## Description\n\n\u6709\u4e00\u4e2a\u591a\u9879\u5f0f\u51fd\u6570 $f(x)$\uff0c\u6700\u9ad8\u6b21\u9879\u4e3a $x^m$\uff0c\u5b9a\u4e49\u53d8\u6362 $Q$:\n\n$$\nQ(f,n,x) = \\sum_{k=0}^nf(k)\\dbinom nk x^k (1-x)^{n-k}\n$$\n\n\u73b0\u5728\u7ed9\u5b9a $f$ \u548c $n,x$\uff0c\u6c42 $Q(f,n,x)\\bmod 998244353$\u3002\n\n\u5176\u4e2d $f(x)$ \u7531\u70b9\u503c\u5f62\u5f0f\u7ed9\u51fa\uff0c\u5373\u7ed9\u51fa $f(0),f(1),f(2),\\cdots,f(m)$ \u4e00\u5171 $m+1$ \u4e2a\u6570\u3002\n\n$\\texttt{data range:} n \\leq 10^9, m \\leq 2\\times 10^4$\n\n## Solution\n\n\u5bf9\u4e8e\u70b9\u503c\u6211\u4eec\u6709\u4e00\u4e2a\u975e\u5e38\u597d\u7684\u6027\u8d28\uff0c\u5c31\u662f\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u70b9\u503c\u76f4\u63a5\u6c42\u51fa\u8fd9\u4e2a\u591a\u9879\u5f0f\u7684\u4e0b\u964d\u5e42\u5f62\u5f0f\u5404\u9879\u7cfb\u6570\u3002\u8f6c\u79fb\u7684\u65b9\u6cd5\u975e\u5e38\u7b80\u5355\uff0c\u76f4\u63a5\u5199\u6210 EGF \u7136\u540e\u5377\u4e0a\u4e00\u4e2a $e^{-x}$ \u5c31\u53ef\u4ee5\u4e86\uff0c\u5177\u4f53\u7684\u8bc1\u660e\u8be6\u89c1\u591a\u9879\u5f0f\u8f6c\u4e0b\u964d\u5e42\u3002\n\n\u8003\u8651\u5c06 $f(x)$ \u8f6c\u6362\u4e3a\u4e0b\u964d\u5e42\u7684\u5f62\u5f0f\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$\n\\begin{aligned}\nQ(f,n,x) &= \\sum_{k=0}^nf(k)\\dbinom nk x^k(1-x)^{n-k}\\\\\n&=\\sum_{k=0}^n\\sum_{i=0}^m b_i k^{\\underline{i}} \\dbinom nk x^k(1-x)^{n-k}\n\\end{aligned}\n$$\n\n\u8fd9\u91cc $b_i$ \u662f\u8f6c\u6210\u4e0b\u964d\u5e42\u4e4b\u540e\u7684\u5404\u9879\u7cfb\u6570\u3002\n\n\u6211\u4eec\u6709\u4e00\u4e2a trick\uff0c\u90a3\u5c31\u662f $\\dbinom nk k^{\\underline{i}}=n^{\\underline{i}}\\dbinom{n-i}{k-i}$\u3002\n\n\u4ee3\u5165\u539f\u5f0f\u4e2d\u6709\uff1a\n\n$$\n\\begin{aligned}\n\\sum_{k=0}^n\\sum_{i=0}^mb_i \\dbinom{n-i}{k-i} n^{\\underline{k}}x^k(1-x)^{n-k} &= \\sum_{i=0}^mb_in^{\\underline{i}}x^i\\sum_{k=i}^n\\dbinom{n-i}{k-i}x^{k-i}(1-x)^{n-k}\\\\\n&=\\sum_{i=0}^mb_in^{\\underline{i}}x^i\n\\end{aligned}\n$$\n\n\u53ef\u4ee5\u5728 $O(m\\lg m)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u5b8c\u6210\u3002\n\n## More\n\n\u65f6\u8fc7\u6570\u6708\uff0c\u8865\u4e00\u4e0b\u7ebf\u6027\u7684\u505a\u6cd5\u3002\n\n\u5728 EI \u7684[\u535a\u5ba2](https://www.luogu.com.cn/blog/EntropyIncreaser/zai-tan-binomial-sum-duo-xiang-shi-fu-ge-cha-zhi-yu-tai-lei-zhan-kai)\u4e2d\u63d0\u5230\u4e86\u4e00\u79cd\u89e3\u51b3\u7531\u7ebf\u6027\u63d2\u503c\u63a8\u5e7f\u51fa\u6765\u7684\u6c42\u503c\u65b9\u6cd5\uff0c\u4f46\u662f\u8c8c\u4f3c luogu \u7684\u9898\u89e3\u533a\u5185\u9664\u4e86\u4e00\u697c\u7684\u8001\u54e5\u4e4b\u5916\u5e76\u6ca1\u6709\u4eba\u5199\u8fd9\u79cd\u505a\u6cd5\uff0c\u5e76\u4e14\u4e00\u697c\u7684\u8001\u54e5\u7ed9\u7684\u662f\u4e00\u4e2a\u975e\u5e38\u5389\u5bb3\u7684\u63a8\u5f0f\u5b50\u505a\u6cd5\uff0c\u8fd9\u91cc\u7528\u66f4\u52a0\u666e\u9002\u5316\u7684\u65b9\u6cd5\u5bf9\u8fd9\u4e2a\u9898\u8fdb\u884c\u63a8\u5bfc\u3002\n\n\u901a\u5e38\u7684\uff0c\u6211\u4eec\u8bbe $G(z) = e^z$ \u6765\u8fdb\u884c\u64cd\u4f5c\uff0c\u8bbe\u539f\u51fd\u6570 $f(z) = \\sum\\limits_{i=0}^m\\dfrac{a_i}{i!}z^i$\u3002\n\n\u7531\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\uff1a\n$$\\sum_{i=0}^ma_i[z^i](e^z)^k = \\sum_{i=0}^m\\dfrac{a_i}{i!}k^i = f(k)$$\n\n\u8fd9\u91cc\u6211\u4eec\u8bc1\u660e\u4e86 \n$$\\sum_{i=0}^ma_i[z^i]G(z)^k = f(k)$$ \n\n\u8fd9\u4e00\u7ed3\u8bba\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86\u5bf9\u4e8e $k\\in[0, m]$ \u6240\u6709\u4e0a\u5f0f\u7684\u503c\u3002\n\n\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u539f\u6587\u4e2d\u5199\u5230\u7684\u5957\u8def\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u4e86\u3002\n\n\u6211\u4eec\u60f3\u529e\u6cd5~~\u51d1\u51fa~~\u5f97\u51fa\u7b54\u6848\u7684\u5f0f\u5b50\uff0c\u4ee4 \n$$F(z) = \\sum\\limits_{i=0}^n\\dbinom ni x^iz^i(1-x)^{n-i}$$\n\n\n\u5982\u679c\u89c9\u5f97\u8fd9\u4e2a $x$ \u6bd4\u8f83\u9b3c\u755c\u7684\u8bdd\u53ef\u4ee5\u4ee4\u4ed6\u4e3a $\\alpha$\u3002\n\n\u4e8c\u9879\u5f0f\u5b9a\u7406\u5408\u5e76\u8d77\u6765\u53ef\u4ee5\u5f97\u5230 $F(z) = (xz+1-x)^n$\u3002\n\n\u6211\u4eec\u4ee3\u5165\u5f0f\u5b50\u4e2d\u5f97\u5230\uff1a\n\n$$\n\\begin{aligned}\n\\sum_{i=0}^ma_i[z^i]F(G(z))&=\\sum_{i=0}^ma_i[z^i]\\sum_{k=0}^n\\dbinom{n}{k}x^kG(z)^k(1-x)^{n-k}\\\\\n&=\\sum_{k=0}^n\\dbinom nk x^k(1-x)^{n-k}\\sum_{i=0}^ma_{i}[z^i]G(z)^k\\\\\n&=\\sum_{k=0}^n\\dbinom nk x^k(1-x)^{n-k}f(k) = Q(f,n,x)\n\\end{aligned}\n$$\n\n\u6211\u4eec\u6784\u9020\u51fa\u7684 $F(z)$ \u53ef\u4ee5\u5b8c\u7f8e\u9002\u5408\u6211\u4eec\u6240\u9700\u8981\u5904\u7406\u7684\u5f0f\u5b50\uff0c\u6240\u4ee5\u76f4\u63a5\u64cd\u4f5c\u8fd9\u4e2a $F(z)$ \u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u6211\u4eec\u5bb9\u6613\u6c42\u51fa $F(z)$ \u7684\u4e00\u4e2a\u5fae\u5206\u65b9\u7a0b\uff1a\n\n$$(xz+1-x)F'(z)-nF(z) = 0$$\n\n\u5728 $G(0)$ \u5904\u5c55\u5f00 $F(z)$\uff08\u8fd9\u4e00\u6b65\u662f\u53ef\u6709\u53ef\u65e0\u7684\uff09\uff0c\u4e4b\u540e\u4ee4 $\\mathscr{F}(z+G(0))\\equiv F(z+G(0)) \\pmod{z^{m+1}}$\n\n\u66f4\u65b0\uff1a\u795e\u4ed6\u5988\u53ef\u6709\u53ef\u65e0\u7684\uff0c\u5bf9\u4e8e\u6211\u4eec\u7684\u8ba1\u7b97\u800c\u8a00\u8fd9\u7684\u786e\u662f\u53ef\u6709\u53ef\u65e0\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u53ef\u4ee5\u5f88\u5feb\u7684\u5199\u51fa\u540e\u9762\u7684\u622a\u53d6\u5f0f\uff0c\u4f46\u662f\u5bf9\u4e8e\u672c\u8d28\u7684\u4e86\u89e3\uff0c\u6211\u4eec\u662f\u9700\u8981\u8fd9\u4e2a\u5f0f\u5b50\u7684\u3002\n\n\u5bf9 $F(z)$ \u5728 $G(0)$ \u5904\u5c55\u5f00\u4e4b\u540e\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$\nF(z) = \\sum_{i\\ge 0} \\dfrac{F^{(i)}(G(0))}{i!}(G(z)-G(0))^i\n$$\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0 $z | G(z)-G(0)$\uff0c\u7531\u4e8e\u6211\u4eec\u9700\u8981\u6c42\u7684\u662f \n$$\\sum_{i=0}^ma_i[z^i]F(G(z))$$ \n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u5904\u7406\u5230\u7b2c $m$ \u9879\u5373\u53ef\u3002\n\n\u56de\u5230\u6b63\u9898\u3002\n\n\u8fd9\u91cc\u7684 $G(0) = 1$\u3002\n\n\u6839\u636e\u5e73\u79fb\u4e0d\u53d8\u6027\u6709 \n$$(xz+2-x)F(z+1)-nF(z+1) = 0$$\n\n\u63a5\u7740\u76f4\u63a5\u5217\u51fa $\\mathscr F(z+1)$ \u7684\u5fae\u5206\u65b9\u7a0b\u5f0f\uff1a\n\n$$(xz+2-x)\\mathscr F'(z+1)-n\\mathscr F(z+1) = D(z)$$\n\n\u8fd9\u91cc\u7684 $D(z)$ \u662f\u6270\u52a8\u9879\u3002\n\n\u6211\u4eec\u624b\u7b97\u540e\u53ef\u4ee5\u5f97\u5230 \n$$D(z) = (m-n)\\dbinom{n}{m}x^m(2-x)^{n-m}z^m$$\n\n\u5177\u4f53\u600e\u4e48\u624b\u7b97\uff0c\u4f60\u53ef\u4ee5\u76f4\u63a5\u628a $F(z)$ \u7684 $m$ \u6b21\u9879\u63d0\u51fa\u6765\u7136\u540e\u524d\u9762\u4e58\u4e0a\u4e00\u4e2a $m-n$ \u5c31\u53ef\u4ee5\u4e86\u2026\u2026\n\n\u5f53\u7136\u8fd9\u662f\u4e0d\u4e25\u8c28\u7684\uff0c\u4f46\u662f\u5927\u591a\u65f6\u5019\u662f\u6b63\u786e\u7684\u3002\n\n\u7136\u540e\u628a\u6574\u4f53\u7684\u5f0f\u5b50\u5e73\u79fb\u56de\u53bb\uff1a\n\n$$(xz+1-x)\\mathscr F'(z) - n\\mathscr F(z) = D(z-1)$$\n\n\u6211\u4eec\u4ee4 $\\mathscr F(z) =\\sum\\limits_{i=0}^m f_iz^i$\u3002\n\n\u6839\u636e\u4e0a\u9762\u7684\u5fae\u5206\u65b9\u7a0b\u63d0\u53d6\u4e00\u4e0b $z^i$  \u7684\u7cfb\u6570\uff0c\u4f1a\u53d1\u73b0\u4f1a\u6784\u6210\u4e00\u4e2a $f_i$ \u548c $f_{i+1}$ \u7684\u9012\u63a8\u5f0f\uff0c\u5f62\u5982 $f_{i+1} = p(i)f_i$\u3002\n\n\u6211\u4eec\u73b0\u5728\u9700\u8981\u505a\u7684\u5c31\u662f\u4e00\u4e9b ~~dirty work~~ \u63a8\u5f0f\u5b50\u7684\u5de5\u4f5c\u4e86\uff0c\u4e5f\u5c31\u662f\u6c42\u51fa $p(i)$\uff0c\u60f3\u5fc5\u5404\u4f4d\u770b\u5230\u8fd9\u91cc\u90fd\u6ca1\u6709\u653e\u5f03\u7684\u8bdd\uff0c\u8fd9\u4e00\u70b9\u5de5\u4f5c\u5bf9\u4f60\u4eec\u6765\u8bf4\u4e00\u70b9\u90fd\u4e0d\u56f0\u96be\uff0c\u6240\u4ee5\u7b14\u8005\u5c31\u4e0d\u5199\u4e86\u3002\n\n\u4f46\u662f\u95ee\u9898\u51fa\u73b0\u4e86\uff0c$x=1$ \u600e\u4e48\u529e\u2026\u2026\n\n\u4f60\u4ed4\u7ec6\u770b\u4e00\u773c\u5f0f\u5b50\uff0c\u53d1\u73b0\u53ea\u6709\u5f53 $k=n$ \u7684\u65f6\u5019\u624d\u4f1a\u5bf9\u539f\u5f0f\u5b50\u9020\u6210\u8d21\u732e\uff0c\u5f53 $n\\leq m$ \u7684\u65f6\u5019\u76f4\u63a5\u8f93\u51fa $f(n)$ \u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u4e0d\u7136\u7684\u8bdd\u6211\u4eec\u56de\u5230\u4e00\u5f00\u59cb\u7684\u5fae\u5206\u65b9\u7a0b\uff1a\n\n$$zF'(z)-nF(z)=0$$\n\n\u6b64\u65f6 $F(z) = z^n$\u3002\n\n\u60f3\u5fc5\u4f60\u53d1\u73b0\u4e86\u4e00\u4e9b\u4e1c\u897f\uff0c\u6ca1\u9519\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u662f\u63d2\u503c\u7684\u60c5\u51b5\uff0c\u8fd9\u91cc\u4e5f\u63ed\u793a\u4e86\u672c\u9898\u4e0e\u7ebf\u6027\u63d2\u503c\u4e4b\u95f4\u7684\u67d0\u4e9b\u5173\u7cfb\uff0c\u5728\u8fd9\u91cc\u5c31\u53ef\u4ee5\u7528\u7ebf\u6027\u63d2\u503c\u7684\u65b9\u6cd5\u505a\u6216\u8005\u7528\u7b14\u8005\u63a5\u4e0b\u6765\u8981\u4ecb\u7ecd\u7684\u65b9\u6cd5\u3002\n\n\u540c\u6837\u7684\u6211\u4eec\u8003\u8651\u7528\u4e0a\u9762\u65b9\u6cd5\u505a**\u7ebf\u6027\u63d2\u503c**\u3002\n\n~~\u540c\u6837\u7684\u5c55\u5f00\uff0c\u540c\u6837\u7684\u5e73\u79fb\uff0c\u540c\u6837\u7684\u5473\u9053\uff1a~~\n\n$$\n\\begin{aligned}\n(z+1)F(z+1) - nF(z+1) &= 0\\\\\n\\mathscr F(z+1) &\\equiv F(z+1) \\pmod{z^{m+1}}\\\\\n(z+1)\\mathscr F(z+1) - n\\mathscr F(z+1) &= D(z)\\\\\nD(z)&=(m-n)\\dbinom nm z^m\\\\\nz\\mathscr F(z) - nF(z) &= D(z-1)\n\\end{aligned}\n$$\n\n\u5230\u8fd9\u91cc\u6211\u4eec\u53d1\u73b0\u600e\u4e48\u6700\u540e\u4e00\u4e2a\u5f0f\u5b50\u7b97\u51fa\u6765\u662f\u4e00\u4e2a\u9f50\u6b21\u7684\uff1f\n\n~~\u9f50\u6b21\u5c31\u9f50\u6b21\u5457\uff0c\u9f50\u6b21\u96be\u9053\u4e0d\u9999\u5417\u3002~~\n\n\u9f50\u6b21\u5c31\u4ee3\u8868\u7740\u6211\u4eec\u6ca1\u6709\u5fc5\u8981\u9012\u63a8\u4e86\uff0c\u6240\u4ee5\u76f4\u63a5\u63d0\u53d6\u7cfb\u6570\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u8fd8\u6ca1\u6709\u8bf4\u600e\u4e48\u5f97\u5230\u6700\u540e\u7684\u7b54\u6848\u5462\uff0c\u6b64\u65f6\u6211\u4eec\u6c42\u51fa $\\{f_i\\}_ {i=0}^m$ \u7684\u503c\uff0c\u6211\u4eec\u4ee3\u5165\u539f\u5f0f\u5b50\u4e2d\u6c42\u4e00\u4e0b\u7b54\u6848\u3002\n\n$$\n\\begin{aligned}\nQ(f,n,x) &= \\sum_{i=0}^ma_i[z^i]F(G(z))\\\\\n&=\\sum_{i=0}^ma_i[z^i]\\left(\\sum_{k=0}^n([z^k]F(z))G(z)^k\\right)\\\\\n&= \\sum_{i=0}^ma_i[z^i]\\left(\\sum_{k=0}^m([z^k]\\mathscr F(z))G(z)^k\\right)\\\\\n&=\\sum_{k=0}^mf_k\\sum_{i=0}^ma_i[z^i]G(z)^k\\\\\n&=\\sum_{k=0}^mf_kf(k)\n\\end{aligned}\n$$\n\n\u7531\u6b64\u5f97\u5230\u7b54\u6848\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(m)$\u3002",
        "postTime": 1639785542,
        "uid": 366935,
        "name": "KAMIYA_KINA",
        "ccfLevel": 7,
        "title": "P6667 [\u6e05\u534e\u96c6\u8bad2016] \u5982\u4f55\u4f18\u96c5\u5730\u6c42\u548c \u9898\u89e3"
    },
    {
        "content": "# \u9898\u89e3 P6667 \u3010[\u6e05\u534e\u96c6\u8bad2016]\u5982\u4f55\u4f18\u96c5\u5730\u6c42\u548c\u3011\n[$\\mathfrak{View\\space it\\space on\\space my\\space Blog}$](https://blog.seniorious.cc/2020/luogu-6667/)\n\n\u63d0\u4f9b\u4e00\u79cd\u6982\u7387\u751f\u6210\u51fd\u6570\u7684\u505a\u6cd5\n\n\u9996\u5148\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0b\u6982\u7387\u751f\u6210\u51fd\u6570\uff1a\n\n\u6982\u7387\u751f\u6210\u51fd\u6570\u662f\u4e00\u7c7b\u7528\u4e8e\u89e3\u51b3\u3001\u5206\u6790\u5728\u81ea\u7136\u6570\u57df\u4e0a\u7684\u79bb\u6563\u968f\u673a\u53d8\u91cf\u76f8\u5173\u95ee\u9898\u7684\u666e\u901a\u751f\u6210\u51fd\u6570\uff0c\u5176\u5f62\u5f0f\u4e3a $F(x)=\\sum\\limits_{i=0}^\\infty\\operatorname{P}(X=i)x^i$\n\n\u6709\u5982\u4e0b\u516c\u5f0f\uff1a\n\n$\\operatorname{E}(X)=F^\\prime(1)$\n\n$\\operatorname{E}(X^{\\underline{n}})=F^{(n)}(1)$\n\n\u5bf9\u4e8e\u6210\u529f\u6982\u7387\u4e3a $p$\uff0c\u91cd\u590d\u8bd5\u9a8c $n$ \u6b21\u7684\u4e8c\u9879\u5206\u5e03\uff0c\u6982\u7387\u751f\u6210\u51fd\u6570\u4e3a $(1-p+px)^n$\n\n\u4e0b\u9762\u662f\u8fd9\u9898\u7684\u505a\u6cd5\n\n## \u601d\u8def\n\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50\u5f88\u50cf\u4e8c\u9879\u5206\u5e03\uff0c\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u9053\u9898\u5c31\u662f\u5bf9\u4e8e\u6210\u529f\u6982\u7387 $p$\uff0c\u91cd\u590d\u8bd5\u9a8c $n$ \u6b21\u7684\u4e8c\u9879\u5206\u5e03\u6210\u529f\u6b21\u6570 $X$\uff0c\u6c42 $\\operatorname{E}[f(X)]$\n\n\u6839\u636e\u671f\u671b\u7684\u7ebf\u6027\u6027\uff0c\u53ef\u4ee5\u62c6\u5f00\uff0c\u53c8\u6709 $\\operatorname{E}(X^{\\underline{k}})=F^{(k)}(1)=p^kn^{\\underline{k}}$\uff08\u624b\u52a8\u6c42\u5bfc\u53ef\u5f97\uff09\uff0c\u5176\u4e2d $F(x)$ \u662f\u8be5\u4e8c\u9879\u5206\u5e03\u7684\u6982\u7387\u751f\u6210\u51fd\u6570\n\n\u8003\u8651\u5c06 $f(x)$ \u8f6c\u4e3a\u4e0b\u964d\u5e42\u591a\u9879\u5f0f $g(x)=\\sum_{i=0}^mg_ix^{\\underline{i}}$\uff0c\u7b54\u6848\u5373\u4e3a $\\sum_{i=0}^mg_ip^in^{\\underline{i}}$\n\n\u7531\u4e8e\u5df2\u7ecf\u7ed9\u51fa\u4e86 $0\\sim m$ \u5904\u7684\u70b9\u503c\uff0c\u76f4\u63a5\u5c06 $\\sum\\frac{f(i)}{i!}$ \u548c $\\sum\\frac{(-1)^i}{i!}$ \u5377\u79ef\u7684 $i$ \u6b21\u9879\u5373\u4e3a $g_i$\uff08\u4e0d\u4f1a\u7684\u53ef\u4ee5\u5148\u770b[\u8fd9\u9053\u6a21\u677f\u9898](https://www.luogu.com.cn/problem/P5383)\uff09\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\operatorname{O}(m\\log m)$\n\n## \u4ee3\u7801\n```cpp\nconst int N = 20005;\nconst int M = 100005;\nconst int Mod = 998244353, g = 3;\n\nclass Poly {\npublic:\n  int *a;\n  Poly() {\n    a = new int[M];\n    memset(a, 0, sizeof(int) * M);\n  }\n  void NTT(int lim, bool opt);\n};\nint r[M];\n\nint pow(int a, int b, int m);\n\nint pw[N], dw[N], fac[N], ifac[N];\nint f[N];\nint n, m, p;\n\nint main () {\n  read(n), read(m), read(p);\n  int lim = 1;\n  while (lim <= (m << 1)) {\n    lim <<= 1;\n  }\n  for (int i = 1; i < lim; ++i) {\n    r[i] = (r[i >> 1] >> 1) | ((i & 1) * (lim >> 1));\n  }\n  pw[0] = 1;\n  dw[0] = 1;\n  fac[0] = 1;\n  for (int i = 1; i <= m; ++i) {\n    pw[i] = pw[i - 1] * 1ll * p % Mod;\n    dw[i] = dw[i - 1] * 1ll * (n - i + 1) % Mod;\n    fac[i] = fac[i - 1] * 1ll * i % Mod;\n  }\n  ifac[m] = pow(fac[m], Mod - 2, Mod);\n  for (int i = m - 1; i >= 0; --i) {\n    ifac[i] = ifac[i + 1] * 1ll * (i + 1) % Mod;\n  }\n  for (int i = 0; i <= m; ++i) {\n    read(f[i]);\n  }\n  Poly F, G;\n  for (int i = 0; i <= m; ++i) {\n    F.a[i] = f[i] * 1ll * ifac[i] % Mod;\n    G.a[i] = ((i & 1) ? (Mod - ifac[i]) : ifac[i]);\n  }\n  F.NTT(lim, false), G.NTT(lim, false);\n  for (int i = 0; i < lim; ++i) {\n    F.a[i] = F.a[i] * 1ll * G.a[i] % Mod;\n  }\n  F.NTT(lim, true);\n  int ans = 0;\n  for (int i = 0; i <= m; ++i) {\n    ans = (ans + F.a[i] * 1ll * pw[i] % Mod * dw[i] % Mod) % Mod;\n  }\n  write(ans), EL;\n  return 0;\n}\n\nint pow(int a, int b, int m) {\n  int ans = 1, now = a;\n  while (b) {\n    if (b & 1) {\n      ans = ans * 1ll * now % m;\n    }\n    now = now * 1ll * now % m;\n    b >>= 1;\n  }\n  return ans;\n}\nvoid Poly::NTT(int lim, bool opt) {\n  for (int i = 0; i < lim; ++i) {\n    if (i < r[i]) {\n      std::swap(a[i], a[r[i]]);\n    }\n  }\n  for (int l = 1; l < lim; l <<= 1) {\n    int gn = pow(g, (Mod - 1) / (l << 1), Mod);\n    for (int i = 0; i < lim; i += (l << 1)) {\n      for (int j = 0, gw = 1; j < l; ++j, gw = gw * 1ll * gn % Mod) {\n        int x = a[i + j], y = a[i + j + l] * 1ll * gw % Mod;\n        a[i + j] = (x + y) % Mod;\n        a[i + j + l] = (x - y + Mod) % Mod;\n      }\n    }\n  }\n  if (opt) {\n    std::reverse(a + 1, a + lim);\n    int iv = pow(lim, Mod - 2, Mod);\n    for (int i = 0; i < lim; ++i) {\n      a[i] = a[i] * 1ll * iv % Mod;\n    }\n  }\n}\n```\n",
        "postTime": 1602774999,
        "uid": 25251,
        "name": "moongazer",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P6667 \u3010[\u6e05\u534e\u96c6\u8bad2016] \u5982\u4f55\u4f18\u96c5\u5730\u6c42\u548c\u3011"
    },
    {
        "content": "\u7531\u4e8e\u6211\u6682\u65f6\u4e0d\u4f1a\u4e0b\u964d\u5e42\uff0c\u5c31\u7528\u4e86\u62c9\u683c\u6717\u65e5\u63d2\u503c\u505a\u8fd9\u9898\u3002\n\n\u7ed3\u8bba\uff1a\u5176\u4ed6\u4e1c\u897f\u56fa\u5b9a\u65f6\u7b54\u6848\u4e3a\u5173\u4e8e $n$ \u7684 $m$ \u6b21\u591a\u9879\u5f0f\u3002\n\n\u8bc1\u660e\u5982\u4e0b\uff1a\u6211\u4eec\u5047\u8bbe\u9898\u76ee\u4e2d\u7ed9\u7684\u591a\u9879\u5f0f $[x^k]$ \u7684\u7cfb\u6570\u4e3a $b_k$\uff0c\u8981\u6c42\u7684\u662f\n\n$$Ans=\\sum_{k=0}^m b_k\\sum_{i=0}^n i^k\\dbinom{n}{i}p^i(1-p)^{n-i}$$\n\n\u4ee4 $f(n,k)=\\sum_{i=0}^n i^k\\dbinom{n}{i}p^i(1-p)^{n-i}$\u3002\u5f53 $k=0$ \u65f6 $f(n,k)=1$\u3002\u5426\u5219\uff0c\n\n$$\\begin{aligned} f(n,k) & =\\sum_{i=0}^n i^k\\dbinom nip^i(1-p)^{n-i} \\\\ & = n\\sum_{i=1}^n i^{k-1}\\dbinom{n-1}{i-1}p^i(1-p)^{n-i} \\\\ & = np\\sum_{i=0}^{n-1}(i+1)^{k-1}\\dbinom{n-1}{i}p^i(1-p)^{n-1-i} \\\\ & =np\\sum_{j=0}^{k-1}\\dbinom{k-1}j \\sum_{i=0}^{n-1}i^j\\dbinom{n-1}ip^i(1-p)^{n-1-i} \\\\ & = np\\sum_{j=0}^{k-1}\\dbinom{k-1}jf(n-1,j)\\end{aligned}$$\n\n\u6240\u4ee5 $f(n,k)$ \u662f\u5173\u4e8e $n$ \u7684 $k$ \u6b21\u591a\u9879\u5f0f\u3002\u7136\u540e\u7b54\u6848\u4e5f\u662f\u591a\u9879\u5f0f\u3002\n\n\u90a3\u4e48\u95ee\u9898\u5728\u4e8e\u6c42 $n\\in[0,m]$ \u7684\u7b54\u6848\u3002\u4e0d\u96be\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u4e8c\u9879\u5377\u79ef\uff0c\u6240\u4ee5\u76f4\u63a5 NTT \u5c31\u884c\u4e86\u3002\n\n~~\u505a\u5b8c\u624d\u660e\u767d\u4e3a\u4ec0\u4e48\u6709\u4eba 20KB~~\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\ntypedef long long ll;\nusing namespace std;\nconst int MAXN=2e4+5,mod=998244353,G=3,invG=(mod+1)/3;\nll Fstpw(ll a,int b){\n\tll res=1;\n\twhile(b){\n\t\tif(b&1) res=res*a%mod;\n\t\tb>>=1;\n\t\ta=a*a%mod;\n\t}\n\treturn res;\n}\nvoid ntt(int *a,int n,int tp){\n\tint bit=0;\n\twhile(1<<bit<n) bit++;\n\tstatic int rev[MAXN<<2];\n\tfor(int i=1; i<n; i++){\n\t\trev[i]=rev[i>>1]>>1|((i&1)<<bit-1);\n\t\tif(i<rev[i]) swap(a[i],a[rev[i]]);\n\t}\n\tfor(int mid=1; mid<n; mid<<=1){\n\t\tll w=1,w1=Fstpw(tp==1?G:invG,(mod-1)/mid/2);\n\t\tfor(int j=0; j<mid; j++,w=w*w1%mod)\n\t\t\tfor(int i=0; i<n; i+=mid*2){\n\t\t\t\tint x=a[i+j],y=w*a[i+j+mid]%mod;\n\t\t\t\ta[i+j]=(x+y)%mod;\n\t\t\t\ta[i+j+mid]=(x-y+mod)%mod;\n\t\t\t}\n\t}\n\tif(tp==-1){\n\t\tll t=Fstpw(n,mod-2);\n\t\tfor(int i=0; i<n; i++)\n\t\t\ta[i]=a[i]*t%mod;\n\t}\n\treturn ;\n}\nvoid NTT(int *a,int n,int *b,int m,int *res,int k){\n\tint siz=1;\n\twhile(siz<=n+m) siz<<=1;\n\tstatic int f[MAXN<<2],g[MAXN<<2];\n\tfor(int i=0; i<siz; i++){\n\t\tf[i]=i<=n?a[i]:0;\n\t\tg[i]=i<=m?b[i]:0;\n\t}\n\tntt(f,siz,1);\n\tntt(g,siz,1);\n\tfor(int i=0; i<siz; i++)\n\t\tf[i]=1ll*f[i]*g[i]%mod;\n\tntt(f,siz,-1);\n\tfor(int i=0; i<=k; i++)\n\t\tres[i]=f[i];\n\treturn ;\n}\nint n,m,x,a[MAXN],b[MAXN];\nll fac[MAXN],inv[MAXN];\nll f[MAXN],g[MAXN];\nint y[MAXN];\nint ans;\nint main(){\n\tscanf(\"%d%d%d\",&n,&m,&x);\n\tfac[0]=1;\n\tfor(int i=1; i<=m; i++)\n\t\tfac[i]=fac[i-1]*i%mod;\n\tinv[m]=Fstpw(fac[m],mod-2);\n\tfor(int i=m; i; i--)\n\t\tinv[i-1]=inv[i]*i%mod;\n\tfor(int i=0; i<=m; i++){\n\t\tscanf(\"%d\",a+i);\n\t\ta[i]=a[i]*Fstpw(x,i)%mod*inv[i]%mod;\n\t\tb[i]=Fstpw(1-x+mod,i)*inv[i]%mod;\n\t}\n\tNTT(a,m,b,m,a,m);\n\tf[0]=n%mod;\n\tfor(int i=1; i<=m; i++)\n\t\tf[i]=f[i-1]*(n-i+mod)%mod;\n\tg[m]=(n-m+mod)%mod;\n\tfor(int i=m-1; ~i; i--)\n\t\tg[i]=g[i+1]*(n-i+mod)%mod;\n\tfor(int i=0; i<=m; i++){\n\t\tint y=a[i]*fac[i]%mod;\n\t\tif(i) y=y*f[i-1]%mod;\n\t\tif(i<m) y=y*g[i+1]%mod;\n\t\ty=y*inv[i]%mod*inv[m-i]%mod*(m-i&1?mod-1:1)%mod;\n\t\tans=(ans+y)%mod;\n\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1648728372,
        "uid": 116116,
        "name": "LZDQ",
        "ccfLevel": 0,
        "title": "\u5982\u4f55\u4f18\u96c5\u5730\u6c42\u548c"
    },
    {
        "content": "[\u9898\u9762\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P6667)\n\n>wjz\uff1a\u300a\u5982\u4f55\u4f18\u96c5\u5730 AK NOI\u300b\n\n~~\u6211\uff1a\u5982\u4f55\u4f18\u96c5\u5730\u7206\u96f6~~\n\n\u9996\u5148\uff0c\u6309\u7167[\u8fd9\u9898](https://www.luogu.com.cn/problem/P6620)\u603b\u7ed3\u51fa\u6765\u7684\u4e00\u4e2a\u5c0f\u5957\u8def\uff0c\u770b\u5230\u591a\u9879\u5f0f\u4e0e\u7ec4\u5408\u6570\u7ed3\u5408\u7684\u9898\uff0c\u53ef\u4ee5\u8003\u8651\u5c06**\u666e\u901a\u591a\u9879\u5f0f\u8f6c\u4e3a\u4e0b\u964d\u5e42\u591a\u9879\u5f0f**\uff0c\u56e0\u4e3a\u4e0b\u964d\u5e42\u548c\u7ec4\u5408\u6570\u90fd\u53ef\u4ee5\u7528\u9636\u4e58\u76f8\u9664\u7684\u5f62\u5f0f\u8868\u793a\uff0c\u800c\u5bf9\u4e8e\u4e24\u4e2a\u7ec4\u5408\u6570\u76f8\u4e58\u6211\u4eec\u6709\u6052\u7b49\u5f0f $\\dbinom{n}{m}\\dbinom{m}{k}=\\dbinom{n}{k}\\dbinom{n-k}{m-k}$\uff0c\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u5c06\u539f\u5f0f\u4e2d\u5f85\u679a\u4e3e\u53d8\u91cf $m$ \u4ece\u4e24\u4e2a\u7ec4\u5408\u6570\u4e2d\u8f6c\u79fb\u5230\u4e00\u4e2a\u7ec4\u5408\u6570\uff08$\\dbinom{n-k}{m-k}$\uff09\u4e2d\uff0c\u4e5f\u5c31\u8fdb\u800c\u53ef\u4ee5\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\u7b49\u516c\u5f0f\u5316\u7b80\u4e86\u3002\n\n\u56e0\u6b64\u6b64\u9898\u6211\u4eec\u4e5f\u53ef\u4ee5\u8003\u8651\u8bbe $f(x)=\\sum\\limits_{i=0}^mb_ix^{\\underline{i}}$\uff0c\u4e0b\u9762\u5f00\u59cb\u63a8\u5f0f\u5b50\uff1a\n$$\n\\begin{aligned}\nans&=\\sum\\limits_{k=0}^mf(k)\\dbinom{n}{k}x^k(1-x)^{n-k}\\\\\n&=\\sum\\limits_{k=0}^n\\sum\\limits_{j=0}^mb_jk^{\\underline{j}}\\dbinom{n}{k}x^k(1-x)^{n-k}\\\\\n&=\\sum\\limits_{j=0}^mb_jj!\\sum\\limits_{k=j}^n\\dbinom{k}{j}\\dbinom{n}{k}x^k(1-x)^{n-k}\\\\\n&=\\sum\\limits_{j=0}^mb_jj!\\dbinom{n}{j}\\sum\\limits_{k=j}^n\\dbinom{n-j}{k-j}x^k(1-x)^{n-k}\\\\\n&=\\sum\\limits_{j=0}^mb_jj!\\dbinom{n}{j}\\sum\\limits_{k=0}^{n-j}\\dbinom{n-j}{k}x^{k+j}(1-x)^{n-k-j}\\\\\n&=\\sum\\limits_{j=0}^mb_jj!\\dbinom{n}{j}x^j(1-x+x)^{n-j}\\\\\n&=\\sum\\limits_{j=0}^mb_jj!\\dbinom{n}{j}x^j\n\\end{aligned}\n$$\n\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u6c42\u51fa $b_j$ \u5373\u53ef\u5728\u7ebf\u6027\u7684\u65f6\u95f4\u5185\u8ba1\u7b97\u51fa $ans$\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u7684\u4efb\u52a1\u662f\u600e\u6837\u7531 $f(x)$ \u7684\u70b9\u503c\u8ba1\u7b97\u51fa $b_i$\uff0c\u8003\u8651 $f(x)$ \u7684 $\\text{EGF}$\uff0c\u90a3\u4e48\u6709\n$$\n\\begin{aligned}\n\\sum\\limits_{n}\\dfrac{f(n)x^n}{n!}&=\\sum\\limits_{n}\\sum\\limits_{j=0}^mb_jn^{\\underline{j}}\\dfrac{x^n}{n!}\\\\\n&=\\sum\\limits_{j=0}^mb_j\\sum\\limits_{n}\\dfrac{x^n}{(n-j)!}\\\\\n&=\\sum\\limits_{j=0}^mb_jx^j\\sum\\limits_{n}\\dfrac{x^{n-j}}{(n-j)!}\n\\end{aligned}\n$$\n\u8bb0 $A=\\sum\\limits_{j=0}^mb_jx^j,B=\\sum\\limits_{j}\\dfrac{x^j}{j!}=e^x$\uff0c\u90a3\u4e48 $\\sum\\limits_{n}\\dfrac{f(n)x^n}{n!}=A\\times B$\u3002\n\n\u6545 $A=(\\sum\\limits_{n}\\dfrac{f(n)x^n}{n!})\\times e^{-x}$\uff0cNTT \u4e00\u4e0b\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $n\\log n$\u3002\n\n```cpp\nconst int pr=3;\nconst int MOD=998244353;\nconst int ipr=(MOD+1)/3;\nconst int MAXP=1<<16;\nint qpow(int x,int e){\n\tint ret=1;\n\tfor(;e;e>>=1,x=1ll*x*x%MOD) if(e&1) ret=1ll*ret*x%MOD;\n\treturn ret;\n}\nint rev[MAXP+5];\nvoid NTT(vector<int> &a,int len,int type){\n\tint lg=31-__builtin_clz(len);\n\tfor(int i=0;i<len;i++) rev[i]=(rev[i>>1]>>1)|((i&1)<<lg-1);\n\tfor(int i=0;i<len;i++) if((i-rev[i])>>31) swap(a[i],a[rev[i]]);\n\tfor(int i=2;i<=len;i<<=1){\n\t\tint W=qpow((type<0)?ipr:pr,(MOD-1)/i);\n\t\tfor(int j=0;j<len;j+=i){\n\t\t\tfor(int k=0,w=1;k<(i>>1);k++,w=1ll*w*W%MOD){\n\t\t\t\tint X=a[j+k],Y=1ll*w*a[(i>>1)+j+k]%MOD;\n\t\t\t\ta[j+k]=(X+Y)%MOD;a[(i>>1)+j+k]=(X-Y+MOD)%MOD;\n\t\t\t}\n\t\t}\n\t} if(!~type) for(int j=0,ivn=qpow(len,MOD-2);j<len;j++) a[j]=1ll*a[j]*ivn%MOD;\n}\nvector<int> conv(vector<int> a,vector<int> b){\n\tint LEN=1;while(LEN<a.size()+b.size()) LEN<<=1;a.resize(LEN,0);b.resize(LEN,0);\n\tNTT(a,LEN,1);NTT(b,LEN,1);for(int i=0;i<LEN;i++) a[i]=1ll*a[i]*b[i]%MOD;\n\tNTT(a,LEN,-1);return a;\n}\nint n,m,x,fac[MAXP+5],ifac[MAXP+5];\nvoid init_fac(int n){\n\tfor(int i=(fac[0]=ifac[0]=ifac[1]=1)+1;i<=n;i++) ifac[i]=1ll*ifac[MOD%i]*(MOD-MOD/i)%MOD;\n\tfor(int i=1;i<=n;i++) fac[i]=1ll*fac[i-1]*i%MOD,ifac[i]=1ll*ifac[i]*ifac[i-1]%MOD;\n}\nint main(){\n\tscanf(\"%d%d%d\",&n,&m,&x);vector<int> a(m+1),b(m+1);init_fac(m);\n\tfor(int i=0;i<=m;i++) scanf(\"%d\",&a[i]),a[i]=1ll*a[i]*ifac[i]%MOD;\n\tfor(int i=0;i<=m;i++) b[i]=((~i&1)?ifac[i]:(MOD-ifac[i]));a=conv(a,b);\n\tint ans=0,cur=1;for(int i=0;i<=m;i++) ans=(ans+1ll*a[i]*cur%MOD*qpow(x,i))%MOD,cur=1ll*cur*(n-i)%MOD;\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1624514923,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P6667 [\u6e05\u534e\u96c6\u8bad2016] \u5982\u4f55\u4f18\u96c5\u5730\u6c42\u548c"
    },
    {
        "content": "### \u7b80\u5316\u9898\u9762\n\n\u5df2\u77e5 $m$ \u6b21\u591a\u9879\u5f0f\u51fd\u6570 $f$ \u5728 $0,1\\dots,m$ \u5904\u7684\u53d6\u503c$f(0),f(1),\\dots,f(m)$\uff0c\u7ed9\u5b9a$n,x$\uff0c\u6c42\n\n$$\\sum\\limits_{k=0}^{n}f(k)\\binom{n}{k}x^{k}(1-x)^{n-k}$$\n\n\u7b54\u6848\u5bf9$998244353$\u53d6\u6a21\n\n### \u89e3\u9898\u601d\u8def\n\n\u770b\u8d77\u6765\u5f88\u4e0d\u597d\u6c42\uff0c\u6211\u4eec\u53ef\u4ee5\u628a$f$\u8f6c\u6210\u4e0b\u964d\u5e42$f(x)=\\sum_{i=0}^{m}f_i\\times x(i)$\n\n\u5176\u4e2d\u6211\u4eec\u6709$x(i)=\\prod_{k=0}^{i-1}(x-k)=\\frac{x!}{(x-k)!}$\n\n\u90a3\u4e48\u539f\u67ff\u5b50\u53ef\u4ee5\u5199\u6210\n\n$$\\sum\\limits_{k=0}^{n}f(k)\\binom{n}{k}x^{k}(1-x)^{n-k}$$\n\n$$=\\sum_{i=0}^{m}f_i\\sum_{k=i}^{n}\\frac{n!}{k!(n-k)!} \\frac{k!}{(k-i)!}x^k\\ (1-x)^{n-k}$$\n\n$$=\\sum_{i=0}^{m}f_in(i)x^i\\sum_{k=i}^{n}\\binom{n-i}{k-i}x^{k-i}(1-x)^{n-k}$$\n\n\u7136\u540e\u4f60\u770b\u5230\u540e\u9762\u90a3\u4e00\u5768$k$\u662f\u4ece$i$\u5f00\u59cb\u7684\uff0c\u8f6c\u53d8\u679a\u4e3e\u8303\u56f4\u540e\u9762\u5c31\u53d8\u6210\u4e86\n\n$$\\sum_{k=0}^{n-i}\\binom{n-i}{k}x^k(1-k)^{n-k-i}$$\n\n\u8fd9\u4e0d\u662f\u4e8c\u9879\u5f0f\u5b9a\u7406\u5417= =\uff0c\u7136\u540e\u53ef\u4ee5\u6c42\u5f97\u540e\u9762\u90a3\u4e00\u5806\u67ff\u5b50\u6052\u7b49\u4e8e$(1-k+k)^{n-i}=1$\n\n\u90a3\u4e48\u6211\u4eec\u7684\u67ff\u5b50\u5c31\u53d8\u6210\u4e86\n\n$$\\sum_{i=0}^{m}f_in(i)x^i$$\n\n\u90a3\u4e48\u6211\u4eec\u8003\u8651\u600e\u4e48\u6c42$f_i$\n\n\u6211\u4eec\u6709\n\n$$\\sum_{n}f(n)\\frac{x^n}{n!}$$\n\n$$=\\sum_{i=0}^mf_i\\sum_{n=i}\\frac{x^n}{(n-i)!}$$\n\n$$=\\sum_{i=0}^mf_ix^i\\sum_{n=i}\\frac{1}{(n-i)!}$$\n\n$$=(\\sum_{i=0}^mf_ix^i)e^x$$\n\n\u90a3\u4e48\u6211\u4eec\u7684$f_i$\u5c31\u662f$\\sum_{n}f(n)\\frac{x^n}{n!}$\u4e0e$e^{-x}$\u7684\u5377\u79ef\u4e86\n\n\u76f4\u63a5\u5927\u529b$NTT$\u5373\u53ef\uff0c\u590d\u6742\u5ea6$O(nlogn)$\n\n### $\\mathcal{Code}$\n\n```cpp\n// Author: Ame__\n#include<bits/stdc++.h>\n#define _ 0\n#define qwq double\n#define AME__DEBUG\n#define LL long long\n#define bomb exit(0)\n#define LOG(FMT...) fprintf(stderr , FMT)\n#define TOWA(FMT...) fprintf(stdout , FMT)\nusing namespace std;\n/*Grievous Lady*/\n    \nconst int BUF_SIZE = 1 << 12;\n    \nchar buf[BUF_SIZE] , *buf_s = buf , *buf_t = buf + 1;\n    \n#define PTR_NEXT() \\\n{ \\\n    buf_s ++; \\\n    if(buf_s == buf_t) \\\n    { \\\n        buf_s = buf; \\\n        buf_t = buf + fread(buf , 1 , BUF_SIZE , stdin); \\\n    } \\\n}\n    \n#define mians(_s_) \\\n{ \\\n    while(!isgraph(*buf_s)) PTR_NEXT();\\\n    char register *_ptr_ = (_s_); \\\n    while(isgraph(*buf_s) || *buf_s == '-') \\\n    { \\\n        *(_ptr_ ++) = *buf_s; \\\n        PTR_NEXT(); \\\n    } \\\n    (*_ptr_) = '\\0'; \\\n}\n    \ntemplate <typename _n_> void mian(_n_ & _x_){\n    while(*buf_s != '-' && !isdigit(*buf_s)) PTR_NEXT();\n    bool register _nega_ = false; if(*buf_s == '-'){ _nega_ = true; PTR_NEXT(); }\n    _x_ = 0; while(isdigit(*buf_s)){ _x_ = _x_ * 10 + *buf_s - '0'; PTR_NEXT(); } if(_nega_) _x_ = -_x_;\n}\n    \n#define mod 998244353\n\nconst int kato = 4e6 + 10;\n\ntemplate <typename _n_> bool cmax(_n_ &a , const _n_ &b){ return a < b ? a = b , 1 : 0; }\n    \ntemplate <typename _n_> bool cmin(_n_ &a , const _n_ &b){ return a > b ? a = b , 1 : 0; }\n    \nint n , m , x , qaq , ans , len = 1;\n\nint A[kato] , B[kato] , fac[kato] , inv[kato] , fac_inv[kato];\n\ninline int quick_pow(int a , int b){\n    int res = 1;\n    for(; b ; b >>= 1 , a = 1LL * a * a % mod){\n        if(b & 1){\n            res = 1LL * res * a % mod;\n        }\n    }\n    return res;\n}\n\ninline void NTT(int *y , int len , int opt){\n    int *rev = new int[len];\n    rev[0] = 0;\n    for(int i = 1;i < len;i ++) rev[i] = (rev[i >> 1] >> 1) | ((i & 1) * (len >> 1));\n    for(int i = 0;i < len;i ++) if(rev[i] > i) swap(y[rev[i]] , y[i]);\n    for(int i = 1;i < len;i <<= 1){\n        int G1 = quick_pow(3 , (mod - 1) / (i << 1));\n        for(int j = 0;j < len;j += (i << 1)){\n            for(int k = 0 , g = 1;k < i;k ++ , g = 1LL * g * G1 % mod){\n                int res = 1LL * y[i + j + k] * g % mod;\n                y[i + j + k] = ((y[j + k] - res) % mod + mod) % mod;\n                y[j + k] = (y[j + k] + res) % mod;\n            }\n        }\n    }\n    if(opt == -1){\n        reverse(y + 1 , y + len);\n        for(int i = 0 , inv = quick_pow(len , mod - 2);i < len;i ++) y[i] = 1LL * y[i] * inv % mod;\n    }\n    delete []rev; rev = 0x0;\n}\n\n#define init() \\\n{ \\\n    fac[0] = fac[1] = inv[0] = inv[1] = fac_inv[0] = fac_inv[1] = 1; \\\n    for(int i = 2;i <= m;i ++) \\\n    { \\\n        fac[i] = 1LL * fac[i - 1] * i % mod; \\\n        inv[i] = 1LL * (mod - mod / i) * inv[mod % i] % mod; \\\n        fac_inv[i] = 1LL * fac_inv[i - 1] * inv[i] % mod; \\\n    } \\\n}\n\ninline int Ame_(){\n#ifdef AME__\n    freopen(\".in\" , \"r\" , stdin); freopen(\".out\" , \"w\" , stdout); int nol_cl = clock();\n#endif\n    mian(n) , mian(m) , mian(x); m ++; init();\n    for(int i = 0;i < m;i ++){ \n        mian(qaq);\n        A[i] = 1LL * qaq * fac_inv[i] % mod;\n        B[i] = (i & 1) ? -fac_inv[i] : fac_inv[i];\n    }\n    for(len = 1 ; len <= 2 * m ; len <<= 1);\n    NTT(A , len , 1); NTT(B , len , 1);\n    for(int i = 0;i < len;i ++) A[i] = 1LL * A[i] * B[i] % mod;\n    NTT(A , len , -1);\n    int res = 1;\n    for(int i = 0;i < m;i ++){\n        ans = (ans + 1LL * A[i] * res % mod) % mod;\n        res = ((1LL * res * x % mod * (n - i) % mod) + mod) % mod;\n    }\n    TOWA(\"%d\\n\" , ans);\n#ifdef AME__TIME\n    LOG(\"Time: %dms\\n\", int((clock() - nol_cl) / (qwq)CLOCKS_PER_SEC * 1000));\n#endif\n    return ~~(0^_^0); /*\u3055\u3088\u3046\u306a\u3089\u30d7\u30ed\u30b0\u30e9\u30e0*/\n}\n    \nint Ame__ = Ame_();\n    \nint main(){;}\n```\n",
        "postTime": 1611026381,
        "uid": 245875,
        "name": "Ame__",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6667 \u3010[\u6e05\u534e\u96c6\u8bad2016] \u5982\u4f55\u4f18\u96c5\u5730\u6c42\u548c\u3011"
    },
    {
        "content": "## P6667 [\u6e05\u534e\u96c6\u8bad2016] \u5982\u4f55\u4f18\u96c5\u5730\u6c42\u548c\n\u611f\u89c9\u7ec4\u5408\u6570\u95ee\u9898\u90a3\u9053\u9898\u5c31\u662f\u8fd9\u9053\u9898\u628a\u591a\u9879\u5f0f\u53bb\u6389\u4e4b\u540e\u7684\u73a9\u610f\u3002\n### \u9898\u610f\n\u7ed9\u51fa\u4e00\u4e2a $m$ \u6b21\u591a\u9879\u5f0f\u51fd\u6570 $f(x)$ \u548c $n,x$ \u6c42\u4e0b\u5217\u5f0f\u5b50\u7684\u503c\uff1a\n$$\\sum_{k=0}^nf(k)\\dbinom{n}{k}x^k(1-x)^{n-k}\\bmod{998,244,353}$$\n\u5176\u4e2d $f(x)$ \u4ee5\u70b9\u503c\u5f62\u5f0f\u7ed9\u51fa\uff0c\u7ed9\u51fa $a_0,a_1,\\cdots,a_m$\uff0c\u6ee1\u8db3 $f(i)=a_i$\u3002($1\\le n\\le 10^9,1\\le m\\le 2\\times10^4$)\n### \u9898\u89e3\n\u6ce8\u610f\u5230\u7ec4\u5408\u6570\u662f\u80fd\u62c6\u6210\u4e0b\u964d\u5e42\u548c\u9636\u4e58\u7684\u5f62\u5f0f\u7684\uff0c\u800c\u8fd9\u4e2a\u5f62\u5f0f\u5bf9\u4e8e\u80fd\u6539\u53d8\u4e3a\u9636\u4e58\u5f62\u5f0f\u7684\u4e0b\u964d\u5e42\u5c24\u5176\u53cb\u597d\uff0c\u800c\u5bf9\u4e8e\u666e\u901a\u5e42\u5374\u5341\u5206\u4e0d\u4fbf\u3002\u6240\u4ee5\u6211\u4eec\u8003\u8651\u628a $f$ \u770b\u505a\u4e00\u4e2a\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u51fd\u6570\uff0c\u8fd9\u6837\u539f\u5f0f\u5b50\u5c31\u53ef\u4ee5\u5316\u4e3a\uff1a\n$$\\begin{aligned}&\\sum_{k=0}^n\\sum_{i=0}^mb_ik^{\\underline{i}}\\dbinom{n}{k}x^k(1-x)^{n-k}\\\\=&\\sum_{i=0}^mb_i\\sum_{k=0}^n\\dfrac{k!}{(k-i)!}\\dfrac{n!}{(n-k)!k!}x^k(1-x)^{n-k}\\\\=&\\sum_{i=0}^mb_i\\sum_{k=0}^n\\dfrac{(n-i)^{\\underline{k-i}}}{(k-i)!(n-k)!}n^{\\underline{i}}x^k(1-x)^{n-k}\\\\=&\\sum_{i=0}^mb_in^{\\underline{i}}\\sum_{k=0}^n\\dbinom{n-i}{k-i}x^k(1-x)^{n-k}\\end{aligned}$$\n\u5230\u8fd9\u4e00\u6b65\u4e4b\u540e\uff0c\u6211\u4eec\u53d1\u73b0\u95ee\u9898\u96c6\u4e2d\u5728\u4e86 $k$ \u76f8\u5173\u7684\u90a3\u4e2a\u548c\u5f0f\uff0c\u8003\u8651\u679a\u4e3e $k-i$\uff0c\u5e76\u820d\u5f03\u6389\u6ca1\u7528\u7684\u8d1f\u6570\uff1a\n$$\\sum_{i=0}^mb_in^{\\underline{i}}x^i\\sum_{k=0}^{n-i}\\dbinom{n-i}{k}x^{k}(1-x)^{n-i-k}$$\n\u800c\u540e\u9762\u5f88\u660e\u663e\u5730\u51fa\u73b0\u4e86\u4e8c\u9879\u5f0f\u5b9a\u7406\u7684\u5f62\u5f0f\uff0c\u6240\u4ee5\u539f\u5f0f\u4e3a\uff1a\n$$\\sum_{i=0}^mb_in^{\\underline{i}}x^i(x+1-x)^{n-i}=\\sum_{i=0}^mb_in^{\\underline{i}}x^i$$\n\u73b0\u5728\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u975e\u5e38\u8212\u670d\u4e86\uff0c\u53ea\u8981\u6211\u4eec\u6c42\u51fa $b_i$\uff0c\u5373 $f$ \u8fd9\u4e2a\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u51fd\u6570\u7684\u7cfb\u6570\uff0c\u5c31\u80fd\u505a\u5230 $\\mathcal{O}(m)$ \u6c42\u89e3\u7b54\u6848\u4e86\u3002\n\n\u60f3\u77e5\u9053\u600e\u4e48\u628a\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u51fd\u6570\u7684\u7cfb\u6570\u627e\u51fa\u6765\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u628a\u8fd9\u4e2a\u4e0b\u964d\u5e42\u8f6c\u5316\u4e3a\u666e\u901a\u5e42\uff0c\u8fd9\u6837\u6211\u4eec\u4e5f\u5c31\u77e5\u9053\u4e86\u7cfb\u6570\u7684 $\\rm OGF$\u3002\u521a\u521a\u8bf4\u4e86\uff0c\u4e0b\u964d\u5e42\u548c\u9636\u4e58\u5f88\u642d\uff0c\u6240\u4ee5\u8003\u8651\u4e0b\u964d\u5e42\u7684 $\\rm EGF$\uff1a\n$$\\begin{aligned}\\hat{U}_k(z)&=\\sum_{n\\ge k}\\dfrac{n^{\\underline{k}}z^n}{n!}\\\\&=\\sum_{n\\ge k}\\dfrac{\\frac{n!}{(n-k)!}z^n}{n!}\\\\&=\\sum_{n\\ge k}\\dfrac{z^n}{(n-k)!}\\\\&=z^k\\sum_{n\\ge 0}\\dfrac{z^n}{n!}=z^ke^z\\end{aligned}$$\n\u7136\u540e\u6211\u4eec\u56de\u5230\u9898\u76ee\u91cc\u7ed9\u51fa\u7684\u70b9\u503c\uff0c\u8003\u8651\u5b83\u7684 $\\rm EGF$\uff1a\n$$\\begin{aligned}\\sum_{n\\ge 0}\\dfrac{f(n)z^n}{n!}&=\\sum_{n\\ge 0}\\dfrac{z^n}{n!}\\sum_{j=0}^mf_jn^{\\underline{j}}\\\\&=\\sum_{j=0}^mf_j\\sum_{n\\ge 0}\\dfrac{n^{\\underline{j}}z^n}{n!}\\\\&=\\sum_{j=0}^mf_j\\hat{U}_j(z)\\\\&=e^z\\sum_{j=0}f_jz^j\\end{aligned}$$\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u6211\u4eec\u8bbe\u70b9\u503c\u7684 $\\rm EGF$ \u4e3a $\\hat{A}(z)$\uff0c\u7cfb\u6570\u7684 $\\rm OGF$ \u4e3a $B(z)$\uff0c\u5219\u5b83\u4eec\u6ee1\u8db3\uff1a\n$$\\hat{A}(z)=e^zB(z)$$\n\u5373\uff1a\n$$B(z)=e^{-z}\\hat{A}(z)$$\n$\\hat{A}(z)$ \u662f\u5df2\u77e5\u7684\uff0c\u7528\u5b83\u548c $e^{-z}$ \u5377\u8d77\u6765\u5373\u5f97 $b_i$ \u7cfb\u6570\u3002\u5f97\u5230\u4e4b\u540e\uff0c$\\mathcal{O}(m)$ \u76f4\u63a5\u8ba1\u7b97\u5373\u53ef\u3002\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(m\\log m)$\u3002\n```cpp\n#include <cstdio>\n#include <algorithm>\nconst int N = 1e6 + 10, mod = 998244353; typedef long long ll;\ninline int ksm(int a, int b)\n{\n    int ret = 1;\n    while (b)\n    {\n        if (b & 1) ret = (ll)ret * a % mod;\n        a = (ll)a * a % mod; b >>= 1;\n    }\n    return ret;\n}\nint rev[N], lim, m, n;\ninline void init(int n)\n{\n    lim = 1; m = 0; while (lim <= n) lim <<= 1, ++m;\n    for (int i = 0; i < lim; ++i) rev[i] = (rev[i >> 1] >> 1) | ((i & 1) << (m - 1));\n}\ninline void NTT(int* f, int len, int on)\n{\n    for (int i = 0; i < len; ++i) if (i < rev[i]) std::swap(f[i], f[rev[i]]);\n    for (int h = 2; h <= len; h <<= 1)\n    {\n        int gn = ksm(3, (ll)(mod - 1) / h * on % (mod - 1));\n        for (int j = 0; j < len; j += h)\n            for (int k = j, g = 1; k < j + h / 2; ++k, g = (ll)g * gn % mod)\n            {\n                int u = f[k], t = (ll)g * f[k + h / 2] % mod;\n                f[k] = (u + t) % mod; f[k + h / 2] = ((u - t) % mod + mod) % mod;\n            }\n    }\n    if (on == mod - 2) for (int i = 0, inv = ksm(len, on); i < len; ++i) f[i] = (ll)f[i] * inv % mod;\n}\nint fac[N], ifac[N], F[N], G[N];\nint main()\n{\n    int n, m, x; scanf(\"%d%d%d\", &n, &m, &x); fac[0] = ifac[0] = 1;\n    for (int i = 1; i <= m; ++i) fac[i] = (ll)fac[i - 1] * i % mod;\n    ifac[m] = ksm(fac[m], mod - 2);\n    for (int i = m - 1; i >= 1; --i) ifac[i] = (ll)ifac[i + 1] * (i + 1) % mod;\n    for (int i = 0; i <= m; ++i)\n    {\n        scanf(\"%d\", &F[i]); F[i] = (ll)F[i] * ifac[i] % mod;\n        G[i] = ((i & 1) ? mod - ifac[i] : ifac[i]);\n    }\n    init(m << 1); NTT(F, lim, 1); NTT(G, lim, 1);\n    for (int i = 0; i < lim; ++i) F[i] = (ll)F[i] * G[i] % mod;\n    NTT(F, lim, mod - 2); int ni = 1, xi = 1, ans = 0;\n    for (int i = 0; i <= m; xi = (ll)xi * x % mod, ni = (ll)ni * (n - i) % mod, ++i) \n        (ans += (ll)F[i] * ni % mod * xi % mod) %= mod;\n    printf(\"%d\\n\", ans); return 0;\n}\n```",
        "postTime": 1645712998,
        "uid": 137603,
        "name": "zhiyangfan",
        "ccfLevel": 9,
        "title": "P6667 [\u6e05\u534e\u96c6\u8bad2016] \u5982\u4f55\u4f18\u96c5\u5730\u6c42\u548c \u9898\u89e3"
    },
    {
        "content": "\u65e2\u7136\u770b\u5230\u4e86\u8fd9\u9053\u201c\u677f\u5b50\u201d\uff0c\u90a3\u8fd8\u662f\u6765\u5199\u4e00\u4e0b\u9898\u89e3\u5427\u3002\u3002\u3002\n\n\u5982\u679c\u6709\u673a\u4f1a\u5e0c\u671b\u80fd\u63a8\u4e00\u4e0b \u8f7d\u8c08binominial sum \u7684\u505a\u6cd5\u3002\n$$ \\sum_{k=0}^nf(k)\\binom n kx^k(1-x)^{n-k} $$\n\u770b\u5230\u7ec4\u5408\u6570\u548c\u591a\u9879\u5f0f\u6c42\u503c\u5c31\u53bb\u60f3\u4e0b\u964d\u5e42\u5427\uff0c\u56e0\u4e3a\u6ca1\u4ec0\u4e48\u522b\u7684\u597d\u529e\u6cd5\u4e86\u3002\u3002\u3002\n\n\u8bbe\u4e0b\u964d\u5e42\u591a\u9879\u5f0f $ g(x)=f(x) $\u3002\n$$ \\sum_{i=0}^m g_i\\sum_{k=0}^n\\binom n k k^{\\underline i} x^k(1-x)^{n-k} $$\n\u81ea\u4ece\u8054\u5408\u7701\u9009 2020 \u4e4b\u540e\u5168\u4e16\u754c\u90fd\u77e5\u9053\u4e86 $ \\binom n m m^{\\underline k}=\\binom {n-k} {m-k} n^{\\underline k} $\u3002\n$$ \\sum_{i=0}^mg_i\\sum_{k=i}^n\\binom {n-i} {k-i} n^{\\underline i}x^k(1-x)^{n-k} $$\n$$ \\sum_{i=0}^m g_i n^{\\underline i} x^i\\sum_{k=0}^{n-i}\\binom {n-i} kx^k(1-x)^{n-i-k} $$\n\u540e\u9762\u6839\u636e\u4e8c\u9879\u5f0f\u5b9a\u7406\u5f97\u5230\u662f $ 1 $\u3002\n$$ \\sum_{i=0}^m g_i n^{\\underline i} x^i $$\n\u7136\u540e\u628a\u70b9\u503c\u4e58\u4e0a $ e^{-x} $ \u5c31\u662f\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u4e86\u3002\n```cpp\n#include<cstring>\n#include<cstdio>\n#include<cctype>\n#define IMP(lim,anw) for(i=0;i^(lim);++i)anw\ntypedef unsigned ui;\nconst ui M=1e5+5,mod=998244353;\nui buf[M<<2];ui *now=buf,*w[23];\nui n,m,x,f[M],g[M];\ninline void swap(ui&a,ui&b){\n\tui c=a;a=b;b=c;\n}\ninline ui Add(const ui&a,const ui&b){\n\treturn a+b>=mod?a+b-mod:a+b;\n}\ninline ui Del(const ui&a,const ui&b){\n\treturn b>a?a-b+mod:a-b;\n}\ninline void px(ui*f,ui*g,const ui&len){\n\tfor(ui i=0;i^len;++i)f[i]=1ull*f[i]*g[i]%mod;\n}\ninline ui pow(ui a,ui b=mod-2){\n\tui ans=1;\n\tfor(;b;b>>=1,a=1ull*a*a%mod)if(b&1)ans=1ull*ans*a%mod;\n\treturn ans;\n}\ninline void NTT_init(const ui&m){\n\tui i,j,n,lim(0);while((1<<lim)<m)++lim;n=1<<lim++;\n\tw[lim]=now;now+=1<<lim-1;\n\tw[lim][0]=1;w[lim][1]=pow(3,(mod-1>>1)/n);\n\tfor(i=2;i<(1<<lim-1);++i)w[lim][i]=1ull*w[lim][i-1]*w[lim][1]%mod;\n\tfor(j=lim-1;j>=1;--j){\n\t\tw[j]=now;now+=1<<j;\n\t\tIMP(1<<j,w[j][i]=w[j+1][i<<1]);\n\t}\n}\ninline void DFT(ui*f,const ui&n,const ui&M){\n\tui i,k,d,x,y,*W,*fl,*fr,len;\n\tfor(len=n>>1,d=M-1;len^0;len>>=1,--d){\n\t\tW=w[d];\n\t\tfor(k=0;k^n;k+=len<<1){\n\t\t\tfl=f+(k);fr=f+(k|len);\n\t\t\tIMP(len,(x=fl[i],y=fr[i])),fl[i]=Add(x,y),fr[i]=1ull*Del(x,y)*W[i]%mod;\n\t\t}\n\t}\n}\ninline void IDFT(ui*f,const ui&n,const ui&M){\n\tui i,k,d,x,y,*W,*fl,*fr,len;\n\tfor(len=1,d=1;len^n;len<<=1,++d){\n\t\tW=w[d];\n\t\tfor(k=0;k^n;k+=len<<1){\n\t\t\tfl=f+(k);fr=f+(k|len);\n\t\t\tIMP(len,(x=fl[i],y=1ull*fr[i]*W[i]%mod)),fl[i]=Add(x,y),fr[i]=Del(x,y);\n\t\t}\n\t}\n\tk=pow(n);IMP(n,f[i]=1ull*f[i]*k%mod);\n\tfor(i=1;(i<<1)<n;++i)swap(f[i],f[n-i]);\n}\nsigned main(){\n\tui i,n,a(1),b(1),ans(0),len(0);\n\tscanf(\"%u%u%u\",&n,&m,&x);++m;NTT_init(m<<1);g[0]=1;\n\tfor(i=0;i<m;++i)scanf(\"%u\",f+i);while((1<<len)<(m<<1))++len;\n\tfor(i=1;i<m;++i)g[i]=1ull*g[i-1]*i%mod;g[m-1]=pow(g[m-1],mod-2);\n\tfor(i=m-2;i>=1;--i)g[i]=g[i+1]*(i+1ull)%mod;\n\tfor(i=0;i<m;++i)f[i]=1ull*f[i]*g[i]%mod;for(i=1;i<m;i+=2)g[i]=mod-g[i];\n\tDFT(f,1<<len,len+1);DFT(g,1<<len,len+1);px(f,g,1<<len);IDFT(f,1<<len,len+1);\n\tfor(i=0;i<m;++i)ans=(ans+1ull*f[i]*a%mod*b)%mod,a=1ull*a*(n-i)%mod,b=1ull*b*x%mod;printf(\"%u\",ans);\n}\n```",
        "postTime": 1637905640,
        "uid": 160839,
        "name": "Prean",
        "ccfLevel": 7,
        "title": "\u4e0b\u964d\u5e42\u591a\u9879\u5f0f P6667\u9898\u89e3"
    }
]
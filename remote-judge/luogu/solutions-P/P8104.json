[
    {
        "content": "\u629b\u7816\u5f15\u7389\u7684\u4e00\u4e2a\u9898\uff0c\u5176\u5b9e\u662f\u4eba\u83dc\uff0c\u60f3\u4e0d\u5230\u522b\u7684\u89e3\u6cd5\n\n\u7ed9\u4e00\u4e2a[\u539f\u9898\u9762](https://www.luogu.com.cn/problem/U185079)\uff0c\u6211\u89c9\u5f97\u6211\u5199\u7684\u5f88\u597d\u554a\n\n\u9898\u610f\uff1a\u5bf9\u4e8e $k=0,1,2,3,4,5,6,7$\uff0c\u6c42\u51fa\uff1a\n\n$$\\sum_{i=1}^n[\\omega(i)\\equiv k(\\bmod 8)]3^{\\omega(i)}$$\n\n\u5176\u4e2d $\\omega(i)$ \u8868\u793a $i$ \u542b\u6709**\u51e0\u79cd\u8d28\u56e0\u5b50**\u3002\n\n\u9898\u89e3\uff1a\n\n$n\\le 100:$ \u7559\u7ed9\u6b63\u5b97 $O(n\\sqrt n\\log n)$ \u505a\u6cd5\u3002\n\n$n\\le 10^5:$ \u7559\u7ed9 $O(n\\log n)$ \u7b5b\u6cd5\u505a\u6cd5\u3002\n\n$n\\le 3\\times10^7:$ \u7559\u7ed9 $O(n)$ \u7ebf\u6027\u7b5b\u505a\u6cd5\u3002\n\n$n\\le 10^9:$ \u7559\u7ed9\u5927\u5e38\u6570\u548c\u795e\u79d8\u505a\u6cd5\u3002\n\n$n\\le 10^{10}:$ \u770b\u5230\u53d6\u6a21\uff0c\u4f7f\u7528\u5355\u4f4d\u6839\u53cd\u6f14\uff0c\u4f46\u662f\u6a21\u6570\u4e0d\u4e00\u5b9a\u662f $998244353$ \u4e4b\u7c7b\u7684\u6a21\u6570\uff0c\u53ef\u4ee5\u8003\u8651\u9009\u7528\u4e00\u4e2a\u5de8\u5927 $\\text{NTT}$ \u6a21\u6570\u6216\u8005\u7528\u4e09\u6a21 $\\text{NTT}$ \u539f\u7406\uff0c\u7528 $\\text{(ex)CRT}$ \u5927\u529b\u5408\u5e76\u3002\n\n\u5148\u653e\u4e00\u4e2a\u5355\u4f4d\u6839\u53cd\u6f14\u57fa\u672c\u5f62\u5f0f\n\n$$[n|k]=\\frac 1 n\\sum_{i=0}^{n-1}\\omega_n^{ik}$$\n\n$$\\sum_{i=1}^n[8|(\\omega(i)-k)]3^{\\omega(i)}=\\frac1 8\\sum_{i=1}^n3^{\\omega(i)}\\sum_{j=0}^7\\omega_{8}^{j(\\omega(i)-k)}$$\n\n$$=\\frac 1 8\\sum_{j=0}^7\\omega_8^{-jk}\\sum_{i=1}^n3^{\\omega(i)}\\omega_8^{j\\omega(i)}=\\frac 1 8\\sum_{j=0}^7\\omega_8^{-jk}\\sum_{i=1}^n{(3\\omega_8^j)}^{\\omega(i)}$$\n\n\u6700\u540e\u4e00\u4e2a\u67ff\u5b50\u6709 $8$ \u4e2a\u672c\u8d28\u4e0d\u540c\u7684\u5e95\u6570\uff0c\u4e8e\u662f\u505a $8$ \u6b21 $\\text{Min-25}$ \u7b5b\uff0c\u7136\u540e\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u6765\u70b9\u89c2\u770b\u6bd4\u8d5b\u5fc3\u8def\u5386\u7a0b\n\n\u6211\uff1a\u6211\u8349\uff0c\u8fd9\u662f\u4ec0\u4e48\u725b\u903c\u505a\u6cd5\u554a\n\n\u6211\uff1a\u597d\u50cf\u786e\u5b9e\u53ef\u4ee5\u5faa\u73af\u5377\u79ef\u6a21\u62df\uff0c\u9ebb\u4e86\n\n\u6211\uff1a\u5927E\u4e86\u5927E\u4e86\u548b\u6574\u554a\u6211\u8349\n\n\u6211\uff1a\u5206\u6bb5\u6253\u8868\u662f\u4ec0\u4e48\u73a9\u610f\u513f\uff1f\uff1f\uff1f\uff1f\n\n\u6211\uff1a\u5bc4\u4e86\uff0c\u53ea\u6c42\u4e0d\u6210\u4e3a\u4e0b\u4e00\u4e2ayz\n\n\u5e0c\u671b @Silver187 \u548c @Remake \u53ef\u4ee5\u8d21\u732e\u4ed6\u4eec\u7684\u89e3\u6cd5",
        "postTime": 1634529601,
        "uid": 100325,
        "name": "peterwuyihong",
        "ccfLevel": 7,
        "title": "P8104 \u300cLCOI2021\u300d Cow Function \u8bb0\u5f55"
    },
    {
        "content": "\u524d\u7f6e\u829d\u58eb\uff1a[Min_25 \u7b5b](https://oi-wiki.org/math/number-theory/min-25/)\n\n\u8003\u8651\u7b97\u8d21\u732e\u3002\u5bf9\u4e8e $g(m) > 0$\uff0c\u6c42\u51fa $g(m) = \\displaystyle\\sum_{i = 0}^n [\\omega(i) = m]$ \u540e\u53ef\u5f97 $ans_i = \\displaystyle\\sum_{i \\equiv j \\pmod 8} 3^j g(j)$\u3002\n\n\u8003\u8651\u5148\u6267\u884c Min_25 \u7b5b\u7b2c\u4e00\u90e8\u5206\u6c42\u51fa $\\pi$ \u7684\u5757\u7b5b\uff0c\u518d\u6267\u884c\u7c7b\u4f3c\u4e8e Min_25 \u7b5b\u7b2c\u4e8c\u90e8\u5206\u7684\u9650\u5236\u8d28\u56e0\u6570\u5e42\u6b21\u7684 dfs\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e0d\u4f1a\u7b97\uff08\n\n\u5177\u4f53\u7ec6\u8282\u89c1\u4ee3\u7801\u6ce8\u91ca\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <stdio.h>\n#include <math.h>\n\ntypedef long long ll;\n\nconst int N = 1e5 + 7, M = 2e5 + 7, K = 8;\nll sqrt_n;\nint max_prime_cnt[M], id1[N], id2[N];\nll prime[N], number[M], g[M], ans[K + 7];\nbool p[N];\n\ninline ll sqrt(ll n){\n\tll ans = sqrt((double)n);\n\twhile (ans * ans <= n) ans++;\n\treturn ans - 1;\n}\n\ninline ll max(ll a, ll b){\n\treturn a > b ? a : b;\n}\n\ninline int get_id(ll n, ll m){\n\treturn n <= sqrt_n ? id1[n] : id2[m / n];\n}\n\ninline int init(ll n){\n\tint cnt = 0, sqrt_cnt, id = 0;\n\tll limit;\n\tsqrt_n = sqrt(n);\n\tif (sqrt_n == 1) sqrt_cnt = 0;\n\tlimit = max(sqrt_n, 3);\n\tp[0] = p[1] = true;\n\tfor (register ll i = 2; i <= limit; i++){\n\t\tif (!p[i]) prime[++cnt] = i;\n\t\tif (i == sqrt_n) sqrt_cnt = cnt;\n\t\tfor (register int j = 1; j <= cnt && i * prime[j] <= limit; j++){\n\t\t\tp[i * prime[j]] = true;\n\t\t\tif (i % prime[j] == 0) break;\n\t\t}\n\t}\n\tfor (register ll i = 1, j; i <= n; i = j + 1){\n\t\tll tn = n / i;\n\t\tj = n / tn;\n\t\tid++;\n\t\tnumber[id] = tn;\n\t\tg[id] = tn - 1;\n\t\tif (tn <= sqrt_n){\n\t\t\tid1[tn] = id;\n\t\t} else {\n\t\t\tid2[j] = id;\n\t\t}\n\t}\n\tfor (register int i = 1; i <= sqrt_cnt; i++){\n\t\tll t = prime[i] * prime[i];\n\t\tfor (register int j = 1; j <= id && number[j] >= t; j++){\n\t\t\tg[j] -= g[get_id(number[j] / prime[i], n)] - (i - 1);\n\t\t}\n\t}\n\treturn cnt;\n}\n\ninline int get_max_prime_cnt(ll n, int cnt){\n    int ans = 0;\n    for (register ll i = 1; i <= n && ans <= cnt; i *= prime[ans]) ans++;\n    return ans - 1;\n}\n\ninline ll quick_pow(ll x, ll p){\n\tll ans = 1;\n\twhile (p){\n\t\tif (p & 1) ans *= x;\n\t\tx *= x;\n\t\tp >>= 1;\n\t}\n\treturn ans;\n}\n\ninline ll log(ll n, ll m){\n\tll ans = log2(n) / log2(m);\n\twhile (quick_pow(m, ans) <= n) ans++;\n\treturn ans - 1;\n}\n\nll solve(ll n, int m, int k, ll x, int cnt){\n\tif (m == 0) return 1;\n\tif (quick_pow(prime[k], m) > n) return 0; // \u526a\u679d\n\tif (m == 1){\n\t\tll ans = g[get_id(n, x)] - k;\n\t\tfor (register int i = k + 1; i <= cnt && prime[i] * prime[i] <= n; i++){\n\t\t\tans += log(n, prime[i]) - 1; // \u8d28\u6570\u7684 > 1 \u6b21\u5e42\n\t\t}\n\t\treturn ans;\n\t}\n\tint md = m - 1;\n\tll ans = 0;\n\tfor (register int i = k + 1; i <= cnt && prime[i] * prime[i] <= n; i++){\n\t\tfor (register ll j = prime[i]; j <= n; j *= prime[i]){\n\t\t\tans += solve(n / j, md, i, x, cnt);\n\t\t}\n\t}\n\treturn ans;\n}\n\nint main(){\n\tint cnt, m;\n\tll n;\n\tscanf(\"%lld\", &n);\n\tcnt = init(n);\n\tm = get_max_prime_cnt(n, cnt);\n\tfor (register int i = 0, j = 0, k = 1; i <= m; i++, j = (j + 1) % K, k *= 3){\n\t\tans[j] += k * solve(n, i, 0, n, cnt);\n\t}\n\tfor (register int i = 0; i < K; i++){\n\t\tprintf(\"%lld\\n\", ans[i]);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1644210354,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P8104 \u3010\u300cLCOI2021\u300dCow Function\u3011"
    },
    {
        "content": "## \u601d\u8def\n### $\\mathbf{\\mathsf{10}}$ \u5206\n\n\u5c31\u662f\u9898\u76ee\u4e2d Bessie \u6700\u5f00\u59cb\u60f3\u5230\u7684 $\\Theta(n\\sqrt n\\log_2 n)$ \u505a\u6cd5\u3002\n\n### $\\mathbf{\\mathsf{30}}$ \u5206\n\n$\\Theta(n\\log n)$ \u7b5b\u6cd5\u3002\n\n### $\\mathbf{\\mathsf{50}}$ \u5206\n\n$\\Theta(n)$ \u7ebf\u6027\u7b5b\u6cd5\u3002\n\n### $\\mathbf{\\mathsf{70}}$ \u5206\n\n\u7559\u7ed9\u5e38\u6570\u8f83\u5927\u7684\u505a\u6cd5\u3002\n\n### $\\mathbf{\\mathsf{100}}$ \u5206\n\u770b\u5230\u53d6\u6a21\uff0c\u4f7f\u7528\u5355\u4f4d\u6839\u53cd\u6f14\uff0c\u4f46\u662f\u6a21\u6570\u4e0d\u4e00\u5b9a\u662f $998244353$ \u4e4b\u7c7b\u7684\u6a21\u6570\uff0c\u53ef\u4ee5\u8003\u8651\u9009\u7528\u4e00\u4e2a\u5de8\u5927 $\\text{NTT}$ \u6a21\u6570\u6216\u8005\u7528\u4e09\u6a21 $\\text{NTT}$ \u539f\u7406\uff0c\u7528 $\\text{(ex)CRT}$ \u5927\u529b\u5408\u5e76\u3002\n\n\u5148\u653e\u4e00\u4e2a\u5355\u4f4d\u6839\u53cd\u6f14\u57fa\u672c\u5f62\u5f0f\n\n$$[n|k]=\\frac 1 n\\sum_{i=0}^{n-1}\\omega_n^{ik}$$\n\n$$\n\\color{white}\n\\begin{cases}\n\\color{black}\\ \\ \\ \\ \\sum_{i=1}^n[8|(\\omega(i)-k)]3^{\\omega(i)}\\\\\n\\color{black}=\\frac1 8\\sum_{i=1}^n3^{\\omega(i)}\\sum_{j=0}^7\\omega_{8}^{j(\\omega(i)-k)}\\\\\n\\color{black}=\\frac 1 8\\sum_{j=0}^7\\omega_8^{-jk}\\sum_{i=1}^n3^{\\omega(i)}\\omega_8^{j\\omega(i)}\\\\\n\\color{black}=\\frac 1 8\\sum_{j=0}^7\\omega_8^{-jk}\\sum_{i=1}^n{(3\\omega_8^j)}^{\\omega(i)}\n\\end{cases}\n$$\n\n\u6700\u540e\u4e00\u4e2a\u67ff\u5b50\u6709 $8$ \u4e2a\u672c\u8d28\u4e0d\u540c\u7684\u5e95\u6570\uff0c\u4e8e\u662f\u505a $8$ \u6b21 $\\text{Min-25}$ \u7b5b\u5c31\u505a\u5b8c\u4e86\u3002\n## code\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define all(x) x.begin(),x.end()\n#define debug(x) cerr<<#x<<' '<<x<<endl\n#define rep(i,j,k) for(int i=(j);i<=(k);i++)\n#define per(i,j,k) for(int i=(j);i>=(k);i--)\n#define maxn 202100\n#define int long long\nconst int p=1231453023109121;\ntemplate<class _Tp>void add(_Tp&x,const _Tp& y){((x+=y)>=p)&&(x-=p);}template<class _Tp>_Tp Add(_Tp x,const _Tp y){add(x,y);return x;}\ntemplate<class _Tp>void sub(_Tp&x,const _Tp&y){((x-=y)<0)&&(x+=p);}template<class _Tp>_Tp Sub(_Tp x,const _Tp y){sub(x,y);return x;}\ntemplate<class _Tp>void mul(_Tp&x,const _Tp&y){x=(__int128)x*y%p;}template<class _Tp>_Tp Mul(const _Tp x,const _Tp y){return (__int128)x*y%p;}\ntemplate<class _Tp>_Tp ksm(_Tp a,_Tp b){_Tp ans(1);for(;b;b>>=1,mul(a,a))if(b&1)mul(ans,a);return ans;} \ntemplate<class _Tp>_Tp div2(_Tp a){if(a&1)a+=p;return a>>1;}\nconst int inv8=(p*7+1)/8;\nint lim,N;\nint pri[maxn],lpf[maxn],pcnt;\nvoid shai(int n){\n\tfor(int i=2;i<=n;i++){\n\t\tif(lpf[i]==0)pri[lpf[i]=++pcnt]=i;\n\t\tfor(int j=1;j<=lpf[i]&&i*pri[j]<=n;j++)lpf[i*pri[j]]=j;\n\t}\n}\n#define id(x) ((x)<=lim?le[(x)]:ge[N/(x)])\nint ge[maxn],le[maxn];\nint G[maxn],Fprime[maxn][8];\nint li[maxn],tot;\nint W[8],w[8];\nconst int wn=ksm(3ll,(p-1)/8);\ntemplate <typename T> inline void read(T& x) {\n\tx=0;T f=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9') {if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9')x=(x<<1)+(x<<3)+(ch^48),ch=getchar();\n\tx=x*f;\n\treturn;\n}\ntemplate <typename T,typename ...Arg>void read(T& x,Arg& ...arg){\n\tread(x);\n\tread(arg...);\n}\ntemplate <typename T>inline void write(T x) {\n\tif(x<0)putchar('-'),x=-x;\n\tif(x<10)putchar(x+'0');\n\telse write(x/10),putchar(x%10+'0');\n}\ntemplate <typename T,typename ...Arg>void write(T& x,Arg& ...arg){\n\twrite(x);\n\tputchar(' ');\n\twrite(arg...);\n}\nvoid init(int n){\n\tfor(int i=1,j;i<=n;i=n/j+1){\n\t\tj=n/i;\n\t\tli[++tot]=j;\n\t\tid(j)=tot;\n\t\tG[tot]=j-1;\n\t}\n\tw[0]=1;\n\tfor(int i=1;i<8;i++)w[i]=Mul(w[i-1],wn);\n\tfor(int i=0;i<8;i++)W[i]=Mul(w[i],3ll);\n}\nvoid calcFprime(){\n\tfor(int k=1;k<=pcnt;k++)\n\tfor(int i=1;li[i]>=pri[k]*pri[k];i++)\n\t\tsub(G[i],G[id(li[i]/pri[k])]-k+1);\n\tfor(int j=0;j<8;j++)\n\tfor(int i=1;i<=tot;i++)Fprime[i][j]=Mul(W[j],G[i]);\n}\nint K;\nint F(int k,int x){\n\tif(x<pri[k]||x<=1)return 0;\n\tint d=id(x);\n\tint ans=Sub(Fprime[d][K],Mul(W[K],k-1));\n\tfor(int i=k;i<=pcnt&&pri[i]*pri[i]<=x;i++){\n\t\tint pw=pri[i],pw2=pri[i]*pri[i];\n\t\tfor(;pw2<=x;pw=pw2,pw2*=pri[i])add(ans,Mul(F(i+1,x/pw)+1,W[K]));\n\t}\n\treturn ans;\n}\nint D[8],ans;\nsigned main(){\n\tread(N);\n\tlim=sqrt((long long)N);\n\tshai(lim+1000);\n\tinit(N);\n\tcalcFprime();\n\tfor(K=0;K<8;K++)D[K]=(F(1,N)+1)%p;\n\tfor(K=0;K<8;K++){\n\t\tans=0;\n\t\tfor(int j=0;j<8;j++)add(ans,Mul(w[(114512-j*K)%8],D[j]));\n\t\twrite(Mul(ans,inv8));\n\t\tputs(\"\");\n\t}\n}\n```      ",
        "postTime": 1643973178,
        "uid": 357311,
        "name": "little_cindy",
        "ccfLevel": 6,
        "title": "P8104 [LCOI RI]Cow Function \u9898\u89e3"
    }
]
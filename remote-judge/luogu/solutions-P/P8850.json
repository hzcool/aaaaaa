[
    {
        "content": "\u9996\u5148\u7b80\u5355\u8f6c\u5316\u4e00\u4e0b\u9898\u610f\uff0c\u6bcf\u4e2a\u4f4d\u7f6e\u6709 $a_i$ \u4e2a\u68cb\u5b50\uff0c\u6bcf\u6b21\u64cd\u4f5c\u9009\u62e9\u4e00\u4e2a\u68cb\u5b50\uff0c\u5c06\u5176\u968f\u673a\u5411\u76f8\u90bb\u4f4d\u7f6e\u79fb\u52a8\u3002\u7136\u540e\u8981\u9009\u62e9\u4e00\u4e2a\u76ee\u6807\u70b9\uff0c\u4f7f\u5f97\u671f\u671b\u64cd\u4f5c\u6b21\u6570\u6700\u5c11\u3002\n\n\u8bbe\u4e00\u4e2a\u68cb\u5b50\u5728\u76ee\u6807\u7684\u987a\u65f6\u9488 $i$ \u683c\uff08\u4e5f\u5c31\u662f\u9006\u65f6\u9488 $n-i$ \u683c\uff09\u7684\u4f4d\u7f6e\uff0c\u79fb\u5230\u76ee\u6807\u7684\u671f\u671b\u6b21\u6570\u4e3a $f_i$\uff0c\u5219\uff1a\n\n$$f_i=1+\\frac 12 (f_{i-1}+f_{i+1}) \\  \\ (i\\in[1,n-1])$$\n\u8fd9\u4e2a\u7ebf\u6027\u65b9\u7a0b\u7ec4\u53ef\u4ee5\u7528\u5e38\u7cfb\u6570\u7ebf\u6027\u9012\u63a8\u7684\u65b9\u6cd5\u6765\u89e3\uff1a\n$$F(x)=2xF(x)-x^2F(x)-\\frac{2x}{1-x}+(f_1+2)x$$\n$$f_i=i(f_1-i+1)$$\n\u7531\u4e8e $f_n=0$\uff0c\u89e3\u5f97 $f_i=i(n-i)$\u3002\n\n\u9898\u76ee\u8981\u6211\u4eec\u6c42\u51fa\u671f\u671b\u6700\u5c0f\u7684\u76ee\u6807\u70b9\uff0c\u4e0d\u59a8\u76f4\u63a5\u628a\u6240\u6709\u76ee\u6807\u7684\u60c5\u51b5\uff0c\u5168\u90fd\u6c42\u51fa\u7b54\u6848\u6765\u3002\n\n$$s_d=\\sum_{i=1}^n a_i |i-d|(n-|i-d|)$$\n\u8fd9\u91cc\u6709\u4e2a\u7edd\u5bf9\u503c\u5f88\u70e6\uff0c\u8003\u8651\u62c6\u4e3a\uff1a\n$$b_d=\\sum_{i=1}^{d-1}a_i(d-i)(n-d+i) \\ , \\ c_d=\\sum_{i=d+1}^na_i(i-d)(n-i+d)$$\n\u518d\u628a\u548c\u5f0f\u4e2d\u7684\u4e58\u79ef\u5c55\u5f00\uff0c\u53ef\u4ee5\u5f97\u5230\uff08\u8fd9\u91cc\u4ee5 $b$ \u4e3a\u4f8b\uff0c\u5bf9 $c$ \u4e5f\u662f\u7c7b\u4f3c\u7684\uff09\uff1a\n$$b_d=-\\left(\\sum_{i=1}^{d-1}i^2a_i \\right)+(2d-n)\\left(\\sum_{i=1}^{d-1}ia_i \\right)+d(n-d)\\left(\\sum_{i=1}^{d-1}a_i\\right)$$\n\u8fd9\u6837\u7ef4\u62a4\u4e09\u4e2a\u524d\u7f00\u548c\u5373\u53ef\uff0c\u5bf9\u4e8e $c$ \u4e5f\u5c31\u662f\u4e09\u4e2a\u540e\u7f00\u548c\uff0c\u505a\u6cd5\u662f\u4e00\u81f4\u7684\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n)$\u3002\n\n\u6ce8\u610f\u503c\u57df\u8f83\u5927\uff0c\u9700\u8981 int128\u3002",
        "postTime": 1668247234,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "[JRKSJ R5] Jalapeno and Garlic"
    },
    {
        "content": "\u9898\u610f\u9898\u9762\u9648\u8ff0\u5f88\u6e05\u695a\u4e86\u3002\u4f46\u662f\u8fd9\u4e2a\u5927\u849c\u65e0\u70ae\u771f\u7684\u5f88\u5f3a\uff08\uff1f\uff09\n\n---\n\nTag : \u63a8\u5f0f\u5b50 \u89e3\u65b9\u7a0b \u6700\u4f18\u5316\u95ee\u9898\n\n\u4e00\u822c\u6700\u4f18\u5316\u95ee\u9898\u8981\u6c42\u7b54\u6848\u53d6\u6a21\u6709\u4ee5\u4e0b\u4e24\u79cd\u60c5\u51b5\uff1a\n\n1.\u6709\u901a\u7528\u7684\uff0c\u56fa\u5b9a\u7684\u6700\u4f18\u65b9\u6848\u7ed3\u8bba\u3002\n\n2.\u7b54\u6848\u53ef\u4ee5\u7528\u80fd\u591f\u50a8\u5b58\u7684\u5b9e\u6570\u8868\u793a\u51fa\u6765\uff08\u5206\u6bcd\u5206\u5b50\u4e0d\u542b\u6709\u8f83\u5927\u7ec4\u5408\u6570\u6216\u9636\u4e58\uff09\u3002\n\n\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u56e0\u4e3a\u6ca1\u6709\u4e00\u79cd\u663e\u7136\u7684\u6700\u4f18\u7b56\u7565\uff0c\u6240\u4ee5\u6211\u4eec\u731c\u6d4b\u540e\u8005\u3002\n\n---\n\n### \u8003\u8651\u5982\u4f55\u8ba1\u7b97\u4e00\u4e2a\u70b9\u5230\u53e6\u4e00\u4e2a\u70b9\u7684\u671f\u671b\u6b21\u6570\n\n\uff08\u611f\u89c9\u8fd9\u4e2a\u95ee\u9898\u83ab\u540d\u7684\u5178\uff0c\u4f46\u6211\u597d\u50cf\u53c8\u6ca1\u505a\u8fc7\uff09\n\n\u4ee4\u4e00\u4e2a \u957f $n$ \u7684\u73af\u4e0a\u4e00\u5bf9\u76f8\u9694 $i$ \u4e2a\u70b9\u7684\u70b9\u7684\u671f\u671b\u64cd\u4f5c\u6b21\u6570\u4e3a $f(i)  ,i\\in[0,n]$\n\n\u663e\u7136\u6709\u4ee5\u4e0b\u7ed3\u8bba\n\n$$f(0) = 0$$\n\n$$f(i) = f(n-i) $$ \n\n\n\u62c6\u5f00\n$$f(i) = \\frac{f(i-1)+f(i+1)}{2} +1$$\n\n\u4e0a\u5f0f\u53ef\u8f6c\u5316\u4e3a\n\n$$f(i+1)=2f(i)-f(i-1)-2$$\n\n$$f(i) = 2f(i-1)-f(i-2)-2   \\ \\ (i>1)$$\n\n\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u73af\u5f62\u7684\u65b9\u7a0b\u7ec4\uff0c\u4ee4 $$f(1) = x$$\n\n\u5219 \n\n$$f(2) = 2f(1) -f(0) - 2 = 2x - 2$$\n\n$$f(3) = 2f(2) - f(1) - 2= 3x - 6$$\n\n$$f(4) = 2f(3) - f(2) - 2 =4x - 12$$\n\n$$\\dots$$\n\n$$f(k) = kx - k^2+k$$\n\n---\n\n\u5982\u679c\u4f60\u4e0d\u60f3\u77e5\u9053\u6211\u662f\u600e\u4e48\u53d1\u73b0\u8fd9\u4e2a\u89c4\u5f8b\u7684\uff0c\u8bf7\u8df3\u8fc7\u8fd9\u51e0\u884c\u3002\n\n\u5176\u5b9e\u662f\u8fd9\u6837\u7684\uff1a\n\n$$\n\n\\begin{bmatrix}\nf(i) & f(i-1) & 1\n\\end{bmatrix}\n=\\begin{bmatrix}\nf(i - 1) & f(i-2) & 1\n\\end{bmatrix} \\times\n\n\\begin{bmatrix}\n2&1&0\\\\\n-1&0&0\\\\\n2&0&1\\\\\n\\end{bmatrix}\n\n$$\n\n\u5728\u8111\u888b\u4e2d\u8fd0\u884c Brain++ \u8bed\u8a00\uff0c\u53d1\u73b0\u8fd9\u4e2a\u77e9\u9635\u7684 $k - 1$ \u6b21\u65b9\u7b49\u4e8e\n\n$$\n\\begin{bmatrix}\nf(k) & f(k-1) & 1\n\\end{bmatrix}\n\n=\n\\begin{bmatrix}\nf(1) & f(0) & 1\n\\end{bmatrix} \\times\n\n\n\\begin{bmatrix}\nk&1&0\\\\\n-k+1&-k+2&0\\\\\nk^2-k&k^2-3k+2&1\\\\\n\\end{bmatrix}\n\n$$\n\n\u5176\u5b9e\u6709\u65f6\u5019\u7528\u77e9\u9635\u6253\u8868\u627e\u89c4\u5f8b\u5f88\u65b9\u4fbf\u3002\n\n---\n\n\u4ee3\u5165\u6700\u5f00\u59cb\u7684\u7b49\u5f0f\n\n$$f(n-1)=(n-1)x-(n-1)(n-2) = f(1)=x$$\n\n$$x = n - 1$$\n\n$$f(i) = i (n-i)$$\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u8fd9\u4e2a\u4f18\u7f8e\u7684\uff0c\u6ca1\u6709\u5206\u6570\u7684\u7ed3\u8bba\u3002\n\n---\n\n### \u5982\u4f55\u9009\u62e9\u4f7f\u5f97\u7b54\u6848\u6700\u4f18\uff1f\n\n\u4ee4 $ans(p)$ \u4e3a\u9009 $p$ \u505a\u7ec8\u70b9\u884c\u65f6\u7684\u7b54\u6848\u3002\n\n$$ans(p) = \\sum_{i=1}^n f(\\left|p - i\\right|)\\times ai $$\n\n\u62c6\u5f00\u7edd\u5bf9\u503c\u548c $f$ \u5f97\u5230\n\n$$ans(p)=\\sum_{i=1}^p i^2\\times  a_i  +(2p-n)\\sum_{i=1}^p i\\times a_i +(pn -p^2)\\sum_{i=1}^pa_i + \\sum_{i=p+1}^n  i^2\\times  a_i  +(2p+n)\\sum_{i=p+1}^n  i\\times a_i -(pn +p^2)\\sum_{i=p+1}^n a_i $$\n\n\n\n\u7528 int128 \u7ef4\u62a4 $a_i , a_i\\times i,a_i\\times i^2$ \u7684\u524d\u7f00\u548c\u5373\u53ef\u89e3\u51b3\u3002\n\n\n\u5168\u90e8\u53d6 min \u540e\u518d\u53d6\u6a21\u3002\n\n\n\n---\n\n[code](https://www.luogu.com.cn/paste/j5oos237)\n\n\n\u4e0d\u662f\u5f88\u7406\u89e3\u8003\u573a\u4e0a\u4e3a\u5565\u505a\u51fa\u6765\u7684\u4eba\u8fd9\u4e48\u5c11\u3002\n\n~~\u867d\u7136\u6211\u5e76\u6ca1\u6709\u6253~~\n\n",
        "postTime": 1668516813,
        "uid": 161697,
        "name": "\u10e6\ua9bf\u0fd0",
        "ccfLevel": 7,
        "title": "\u3010\u9898\u89e3\u3011P8850 [JRKSJ R5] Jalapeno and Garlic"
    },
    {
        "content": "2022.12 upd\uff1a\u539f\u5148\u4ee3\u7801\u9505\u4e86\uff0c\u91cd\u5199\u4e86\u4e00\u4efd\u3002\n\n\u770b\u4e0a\u53bb\u662f\u6bd4\u8f83\u5e38\u89c4\u7684\u9898\uff0c\u5e94\u5f53\u9700\u8981\u66f4\u7075\u654f\u7684\u76f4\u89c9\u548c\u66f4\u5feb\u7684\u901f\u5ea6\u89e3\u51b3\u8fd9\u9053\u9898\u3002\n\n\u9996\u5148\u8003\u8651\u82e5\u5df2\u7ecf\u786e\u5b9a\u4e00\u4e2a $x$\uff0c\u90a3\u4e48\u8d2a\u5fc3\u4fee\u6539\u7b56\u7565\u5c31\u662f\u968f\u4fbf\u627e\u4e00\u4e2a\u975e $0$ \u7684\u4f4d\u7f6e\u64cd\u4f5c\uff0c\u56e0\u4e3a\u65e9\u64cd\u4f5c\u665a\u64cd\u4f5c\u8fd9\u4e2a\u5730\u65b9\u90fd\u8981\u64cd\u4f5c\u3002\n\n\u4e4b\u540e\u5c31\u8003\u8651\u4e00\u4e2a\u8ddd\u79bb $x$ \u4e3a $i$ \u6709\u4e00\u4e2a $1$\uff0c\u90a3\u4e48\u8fd9\u4e2a $1$ \u5bf9 $x$ \u5904\u7684\u7b54\u6848 $ans_x$ \u7684\u8d21\u732e\u7cfb\u6570\u662f\u786e\u5b9a\u7684\uff0c\u8bbe\u5176\u4e3a $E(i)$\uff0e\n\n\u8003\u8651\u89e3\u51fa\u8fd9\u4e2a $E(i)$\uff0c\u5176\u5b9e\u9645\u610f\u4e49\u662f\u6709\u4e00\u4e2a\u6a21 $n$ \u610f\u4e49\u4e0b\u7684\u53d8\u91cf $x$\uff0c\u6bcf\u6b21\u6709 $\\frac{1}{2}$ \u7684\u6982\u7387 $+1$ \u6216\u8005 $-1$\uff0c\u6c42 $x$ \u53d8\u4e3a $0$ \u6b65\u6570\u7684\u671f\u671b\u3002\u5219\u53ef\u4ee5\u5217\u51fa\u65b9\u7a0b $E(i)=\\frac{1}{2}(E(i-1)+E(i+1))+1$ \u5373 $E(i+1)=2E(i)-E(i-1)-2$\uff0c\u5f53\u7136\u5185\u90e8\u7684 $i,i-1,i+1$ \u90fd\u662f\u6a21 $n$ \u610f\u4e49\u4e0b\u7684\u3002\n\n\u8fb9\u754c\u60c5\u51b5\u662f $E(0)=0$\uff0c\u91c7\u7528\u4e3b\u5143\u6cd5\u89e3\u8fd9\u4e2a\u65b9\u7a0b\uff0c\u8bbe $E(1)=x$\uff0c\u5219\u901a\u8fc7 $E(2)=2E(1)-E(0)-2$ \u53ef\u5f97 $E(2)$ \u662f\u5173\u4e8e $x$ \u7684\u4e00\u6b21\u591a\u9879\u5f0f\uff0c\u7c7b\u4f3c\u5730\u80fd\u7ee7\u7eed\u5f80\u540e\u89e3\u51fa $E(n)$ \u662f\u5173\u4e8e $x$ \u7684\u4e00\u6b21\u591a\u9879\u5f0f\uff0c\u6700\u7ec8 $E(n)=E(0)=0$ \u89e3\u51fa $x$\uff0c\u518d\u5f80\u56de\u4ee3\u5165\u6c42\u51fa\u5176\u4ed6\u6240\u6709 $E$ \u5373\u53ef\u3002\n\n\u6253\u8868\u89c2\u5bdf $E(i)$\uff0c\u5bb9\u6613\u53d1\u73b0\u5728\u524d\u534a\u90e8\u5206 $E(i)$ \u662f\u5173\u4e8e $i$ \u7684\u4e8c\u6b21\u51fd\u6570\uff08\u5177\u4f53\u5730\uff0c$E(i)-E(i-1)=n-(2i-1)$\uff09\uff0c\u540e\u534a\u90e8\u5206\u662f\u5bf9\u79f0\u7684\u3002\u8fd9\u4e2a\u65f6\u5019\u53ef\u4ee5\u53d1\u73b0\u9898\u9762\u4e2d\u7684\u53d6\u6a21\u5b9e\u9645\u4e0a\u662f\u5047\u7684\uff0c\u56e0\u4e3a\u7b54\u6848\u6700\u5927\u662f $\\mathcal{O}(n^3a)$ \u7ea7\u522b\u7684\uff0c`__int128` \u8db3\u591f\u5b58\u4e0b\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u8003\u8651\u8ba1\u7b97\u51fa\u6240\u6709 $ans_x$\uff0c\u4ee5\u4e00\u4e2a $a_y$ \u8003\u8651\u5176\u5bf9\u6240\u6709 $ans_x$ \u7684\u8d21\u732e\uff0c\u5219\u4e3a\u5411\u5de6\u5411\u53f3\u5404\u4e00\u4e2a\u533a\u95f4\u4e8c\u6b21\u51fd\u6570\u52a0\u3002\u5229\u7528\u4e09\u9636\u5dee\u5206\u5316\u4e3a\u5355\u70b9\u52a0\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u7ebf\u6027\u3002\n\n```cpp\n#include<cstdio>\n#include<vector>\n#include<queue>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\n#include<ctime>\n#include<random>\n#include<assert.h>\n#define pb emplace_back\n#define mp make_pair\n#define fi first\n#define se second\n#define dbg(x) cerr<<\"In Line \"<< __LINE__<<\" the \"<<#x<<\" = \"<<x<<'\\n'\n#define dpi(x,y) cerr<<\"In Line \"<<__LINE__<<\" the \"<<#x<<\" = \"<<x<<\" ; \"<<\"the \"<<#y<<\" = \"<<y<<'\\n'\n#define ll i128\nusing namespace std;\n//typedef long long ll;\ntypedef __int128 i128;\ntypedef unsigned long long ull;\ntypedef pair<int,int>pii;\ntypedef pair<ll,int>pli;\ntypedef pair<ll,ll>pll;\ntypedef pair<int,ll>pil;\ntypedef vector<int>vi;\ntypedef vector<ll>vll;\ntypedef vector<pii>vpii;\ntypedef vector<pil>vpil;\ntemplate<typename T>T cmax(T &x, T y){return x=x>y?x:y;}\ntemplate<typename T>T cmin(T &x, T y){return x=x<y?x:y;}\ntemplate<typename T>\nT &read(T &r){\n    r=0;bool w=0;char ch=getchar();\n    while(ch<'0'||ch>'9')w=ch=='-'?1:0,ch=getchar();\n    while(ch>='0'&&ch<='9')r=r*10+(ch^48),ch=getchar();\n    return r=w?-r:r;\n}\ntemplate<typename T1,typename... T2>\nvoid read(T1 &x,T2& ...y){read(x);read(y...);}\nconst int mod=1004535809;\ninline void cadd(int &x,int y){x=(x+y>=mod)?(x+y-mod):(x+y);}\ninline void cdel(int &x,int y){x=(x-y<0)?(x-y+mod):(x-y);}\ninline int add(int x,int y){return (x+y>=mod)?(x+y-mod):(x+y);}\ninline int del(int x,int y){return (x-y<0)?(x-y+mod):(x-y);}\nint qpow(int x,int y){\n    int s=1;\n    while(y){\n        if(y&1)s=1ll*s*x%mod;\n        x=1ll*x*x%mod;\n        y>>=1;\n    }\n    return s;\n}\nmt19937 rnd(time(NULL)^(ull)(new char));\ninline int rd(int a,int b){\n    return a+rnd()%(b-a+1);\n}\n#define Win do{puts(\"Yes\");return ;}while(0)\n#define Lose do{puts(\"No\");return ;}while(0)\n#define Alice do{puts(\"Alice\");return ;}while(0)\n#define Bob do{puts(\"Bob\");return ;}while(0)\n#define Fuyi do{puts(\"-1\");return ;}while(0)\n#define Line cerr << \"----------\\n\"\nchar outc[201];\nint outct;\nvoid print(i128 x){\n    do{\n        outc[++outct]=x%10+'0';\n        x/=10;\n    }while(x);\n    while(outct)putchar(outc[outct--]);\n}\nconst int N=1000010;\nint n;\nll f[N],w[N];\nll s[N*2];\nvoid calc(int rev){\n\tfor(int i=1;i<=2*n+3;i++)s[i]+=s[i-1];\n\tfor(int i=1;i<=2*n+3;i++)s[i]+=s[i-1];\n\tfor(int i=1;i<=2*n+3;i++)s[i]+=s[i-1];\n\tfor(int i=1;i<=2*n+3;i++){\n\t\tint id=(i-1)%n+1;\n\t\tif(rev)id=n-id+1;\n\t\tf[id]+=s[i];\n\t\ts[i]=0;\n\t} \n}\nsigned main(){\n    #ifdef do_while_true\n//      assert(freopen(\"data.in\",\"r\",stdin));\n//      assert(freopen(\"data.out\",\"w\",stdout));\n    #endif\n    read(n);\n    for(int i=1;i<=n;i++)read(w[i]);\n    if(n&1){\n    \ti128 sum=(ll)(n+1)*(n/2)/2;\n    \tfor(int i=1;i<=n;i++){\n    \t\ts[i+1]+=(n-1)*w[i];\n    \t\ts[i+2]+=(-n-1)*w[i];\n    \t\ts[i+n/2+1]+=-sum*w[i];\n    \t\ts[i+n/2+2]+=(2*sum+2)*w[i];\n    \t\ts[i+n/2+3]+=-sum*w[i];\n\t\t}\n\t\tcalc(0);\n    \tfor(int i=1;i<=n;i++){\n    \t\ts[i+1]+=(n-1)*w[n-i+1];\n    \t\ts[i+2]+=(-n-1)*w[n-i+1];\n    \t\ts[i+n/2+1]+=-sum*w[n-i+1];\n    \t\ts[i+n/2+2]+=(2*sum+2)*w[n-i+1];\n    \t\ts[i+n/2+3]+=-sum*w[n-i+1];\n\t\t}\n\t\tcalc(1);\n\t}\n\telse{\n    \ti128 sum=(ll)n*(n/2)/2;\n    \tfor(int i=1;i<=n;i++){\n    \t\ts[i+1]+=(n-1)*w[i];\n    \t\ts[i+2]+=(-n-1)*w[i];\n    \t\ts[i+n/2+1]+=(-sum+1)*w[i];\n    \t\ts[i+n/2+2]+=(2*sum+1)*w[i];\n    \t\ts[i+n/2+3]+=-sum*w[i];\n\t\t}\n\t\tcalc(0);\n    \tfor(int i=1;i<=n;i++){\n    \t\ts[i+1]+=(n-1)*w[n-i+1];\n    \t\ts[i+2]+=(-n-1)*w[n-i+1];\n    \t\ts[i+n/2+1]+=(-sum+1)*w[n-i+1];\n    \t\ts[i+n/2+2]+=(2*sum+1)*w[n-i+1];\n    \t\ts[i+n/2+3]+=-sum*w[n-i+1];\n\t\t}\n\t\tcalc(1);\n\t\tfor(int i=1;i<=n;i++)f[(i+n/2-1)%n+1]-=w[i]*sum;\n\t}\n    ll mx=f[1];\n    for(int i=2;i<=n;i++)mx=min(mx,f[i]);\n    print(mx%mod);\n    #ifdef do_while_true\n        cerr<<'\\n'<<\"Time:\"<<1.0*clock()/CLOCKS_PER_SEC*1000<<\" ms\"<<'\\n';\n    #endif\n    return 0;\n}\n```",
        "postTime": 1668297606,
        "uid": 223298,
        "name": "do_while_true",
        "ccfLevel": 8,
        "title": "\u300c\u9898\u89e3\u300d\u6d1b\u8c37 P8850 [JRKSJ R5] Jalapeno and Garlic"
    },
    {
        "content": "## Analysis\n\n\u6839\u636e\u671f\u671b\u7684\u7ebf\u6027\u6027\uff0c\u6211\u4eec\u5728\u94a6\u5b9a\u6700\u540e\u4e00\u4e2a\u4e0d\u4e3a $0$ \u7684\u5143\u7d20\u540e\uff0c\u9898\u76ee\u9700\u8981\u8ba1\u7b97\u7684\u6b65\u6570\u7b49\u4e8e\u6bcf\u4e2a $1$ \u79fb\u5230\u76ee\u6807\u4f4d\u7f6e\u7684\u671f\u671b\u6b65\u6570\u4e4b\u548c\u3002\n\n\u8003\u8651\u8ba1\u7b97\u8fd9\u4e2a\u671f\u671b\u6b65\u6570\uff0c\u5047\u8bbe\u76ee\u6807\u4f4d\u7f6e\u662f $1$\uff0c\u7531 $i$ \u53f7\u4f4d\u7f6e\u8f6c\u79fb\u5230\u76ee\u6807\u4f4d\u7f6e\u7684\u671f\u671b\u6b65\u6570\u662f $f_i$\u3002\u53ef\u4ee5\u5217\u51fa\u8f6c\u79fb\u65b9\u7a0b\u5982\u4e0b\uff1a\n\n$$\n\\begin{cases}\nf_1=0\\\\\nf_{i}=\\frac{1}{2}(f_{i-1}+f_{i+1})+1\\ (2\\le i<n)\\\\\nf_n=\\frac{1}{2}f_{n-1}+1\n\\end{cases}\n$$\n\n\u6211\u4eec\u53ef\u4ee5\u9ad8\u65af\u6d88\u5143 $O(n^3)$ \u6c42\u51fa\u6bcf\u4e2a $f_i$ \u7684\u503c\uff0c\u4e0d\u96be\u53d1\u73b0\u89c4\u5f8b\uff1a\n\n$$\nf_i=(i-1)\\cdot (n-i+1)\n$$\n\n\u8fd9\u6837\u5c31\u4e0d\u7528\u9ad8\u65af\u6d88\u5143\u4e86\uff0c\u53ef\u4ee5\u76f4\u63a5\u6c42\u51fa\u3002\n\n\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u53d1\u73b0\u8fd9\u4e2a\u77e9\u9635\u662f\u4e00\u4e2a\u4e09\u5bf9\u89d2\u77e9\u9635\uff0c\u4e8e\u662f\u53ef\u4ee5 $O(n)$ \u6c42\u51fa\u6240\u6709\u7684 $f_i$\uff0c\u5177\u4f53\u53ef\u4ee5\u53c2\u8003 [CF24D Broken robot](https://www.luogu.com.cn/problem/CF24D)\u3002\n\n\u77e5\u9053 $f_i$ \u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u6700\u7ec8\u4e0d\u4e3a $0$ \u7684\u70b9\uff0c\u8bbe\u4e3a $i$\uff0c\u7136\u540e\u5217\u51fa\u7b54\u6848\u7684\u5f0f\u5b50\uff1a\n\n$$\n\\sum_{j=1}^{i-1}(i-j)\\cdot(n-i+j)\\cdot a_j+\\sum_{j=i+1}^n(j-i)\\cdot(n-j+i)\\cdot a_j\n$$\n\n\u7136\u540e\u628a\u62ec\u53f7\u62c6\u5f00\uff0c\u53d1\u73b0\u53ea\u4e0e\u6240\u6709 $a_j$\uff0c$a_j\\cdot j$ \u4e0e $a_j\\cdot j^2$ \u6709\u5173\u3002\u4e8e\u662f\u9884\u5904\u7406\u8fd9\u4e09\u4e2a\u4e1c\u897f\u7684\u524d\u540e\u7f00\u548c\u5373\u53ef\u3002\n\n\u53e6\u4e00\u4e2a trick \u662f\uff0c\u671f\u671b\u4e00\u5b9a\u662f\u6574\u6570\uff0c\u603b\u7684\u671f\u671b\u4e0a\u9650\u662f $O(Vn^2)$\uff0c\u6240\u4ee5\u76f4\u63a5\u7528 `__int128` \u5b58\u50a8\u5373\u53ef\u3002\n\n## Code\n\n```cpp\n#define int long long\nusing i128=__int128;\nconst int N=1000010;\nconst i128 mod=1004535809;\nint n,b[N];\ni128 a[N],p0[N],p1[N],p2[N],s0[N],s1[N],s2[N];\nsigned main(){\n  cin>>n;\n  rep(i,1,n) cin>>b[i],a[i]=(i128)b[i];\n  rep(i,1,n){\n    p0[i]=p0[i-1]+a[i];\n    p1[i]=p1[i-1]+a[i]*i;\n    p2[i]=p2[i-1]+a[i]*i*i;\n  }\n  per(i,n,1){\n    s0[i]=s0[i+1]+a[i];\n    s1[i]=s1[i+1]+a[i]*i;\n    s2[i]=s2[i+1]+a[i]*i*i;\n  }\n  i128 ans=(i128)3e38;\n  rep(i,1,n){\n    i128 pre=p0[i-1]*(n*i-i*i)+p1[i-1]*(2*i-n)-p2[i-1];\n    i128 suf=-s0[i+1]*(n*i+i*i)+s1[i+1]*(2*i+n)-s2[i+1];\n    ans=min(ans,pre+suf);\n  }\n  cout<<(int)(ans%mod);\n}\n```",
        "postTime": 1668507955,
        "uid": 169574,
        "name": "Enucai",
        "ccfLevel": 7,
        "title": "P8850 [JRKSJ R5] Jalapeno and Garlic"
    },
    {
        "content": "\u8fd9\u4e2a\u9898\u76ee\u662f\u6570\u5b66\u9898\u3002\u56e0\u4e3a\u51fa\u9898\u4eba\u4e0d\u4f1a\u6570\u5b66\uff0c\u6240\u4ee5\u9898\u76ee\u5f88\u7b80\u5355\u3002\n\n\u9898\u76ee\u80cc\u666f\u5df2\u7ecf\u63d0\u793a\uff0c\u64cd\u4f5c\u987a\u5e8f\u65e0\u5173\u3002\u6240\u4ee5\u8003\u8651\u5206\u522b\u5c06\u6bcf\u4e2a $1$ \u79fb\u52a8\u5230\u76ee\u6807\u3002\n\n\u8bbe $f_i$ \u4e3a\u4ece\u70b9 $i$  \u79fb\u52a8\u5230\u70b9 $1$ \u671f\u671b\u64cd\u4f5c\u6b21\u6570\u3002\u8003\u8651\u6c42\u51fa\u8fd9\u4e2a\u3002\n\n\u53ef\u4ee5\u5217\u51fa\u65b9\u7a0b\uff1a\n\n$$f_1=0$$\n\n$$f_i=1+\\dfrac  1 2(f_{i-1}+f_{i+1})(i\\in[2,n-1])$$\n\n$$f_n=1+\\dfrac  1 2(f_{1}+f_{n-1})$$\n\n\u8003\u5bdf $f$ \u7684\u4e00\u4e9b\u6027\u8d28\u3002\n\n$f$ \u663e\u7136\u5177\u6709\u5bf9\u79f0\u6027\uff0c\u5373 $f_i=f_{n-i+2}$\u3002\n\n\u8bbe\u6211\u4eec\u5df2\u7ecf\u6c42\u51fa\u4e86 $f_{2\\dots k},f_{n-k+2,n}$\uff0c\u8003\u8651\u6c42\u51fa $f_{k+1}$ \u5373 $f_{n-k+1}$\u3002\n\n\u6709\uff1a\n\n$$f_{k+1}=1+\\dfrac  1 2(f_k+f_{k+2})$$\n\n$$\\dots$$\n\n$$f_{n-k+1}=1+\\dfrac  1 2(f_{n-k}+f_{n-k+2})$$\n\n\u4e24\u8fb9\u6c42\u548c\uff1a\n\n$$S=\\sum_{i=k+1}^{n-k+1}  f_i$$\n\n$$=n-2k+1+\\dfrac 1 2( \\sum_{i=k}^{n-k} f_i+\\sum_{i=k+2}^{n-k+2} f_i)$$\n\n$$=n-2k+1+\\dfrac 1 2(S+f_k-f_{n-k+1}+S-f_{k+1}+f_{n-k+2})$$\n\n$$=n-2k+1+S+f_k-f_{k+1}$$\n\n\u6240\u4ee5\u6709\u9012\u63a8\u5f0f $f_{k+1}=f_k+n-2k+1$\u3002\n\n\u73b0\u5728\u95ee\u9898\u5373\u5c06 $a$ \u65cb\u8f6c\uff0c\u6700\u5c0f\u5316 $\\sum_{i=1}^n a_if_i$\u3002\n\n~~\u597d\u4e86\u8fd9\u91cc\u663e\u7136\u662f\u4e2a\u5377\u79ef\u5f62\u5f0f\uff0c\u8dd1\u5377\u79ef\u5c31\u884c\u4e86~~\n\n~~\u7136\u800c\u867d\u7136\u6a21\u6570\u662f NTT \u6a21\u6570\u4f46\u662f\u6839\u672c\u6ca1\u7528\u597d\u5427~~\n\n\u8003\u8651\u65cb\u8f6c\u6b21\u6570 $k$\u3002\n\n$$\\sum_{i=1}^{n-k} a_i f_{i+k}+\\sum_{i=n-k+1}^na_if_{k-n+i}$$\n\n$k\\to k+1$\uff1a\n\n$$\\sum_{i=1}^{n-k-1} a_i f_{i+k+1}+\\sum_{i=n-k}^na_if_{k-n+i+1}$$\n\n\u589e\u91cf\u4e3a\uff1a\n\n$$\\sum_{i=1}^{n-k-1} a_i (n-2(i+k)+1)+\\sum_{i=n-k+1}^na_i(n-2(k-n+i)+1)-a_{n-k}(n-1)$$\n\n\u62c6\u5f00\u540e\u5bb9\u6613\u7ef4\u62a4\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u7ebf\u6027\u3002",
        "postTime": 1643886085,
        "uid": 203623,
        "name": "Ntokisq",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 Jalapeno and Garlic"
    },
    {
        "content": "# P8850 \u9898\u89e3\n\u60f3\u4e86\u4e00\u8282\u8bed\u6587\u8bfe\uff08\u5bf9\u4e0d\u8d77\u8bed\u6587\u8001\u5e08\uff09\uff0c\u7ec8\u4e8e\u63a8\u51fa\u6765\u4e86\uff01\n\u611f\u89c9\u81ea\u5df1\u89e3\u6cd5\u4e0d\u592a\u4e00\u6837\uff1f\n\nupd:noip\u8003\u5b8c\u9000\u5f79\u4e86\n\n\n------------\n\n\n\u663e\u7136\uff0c\u5982\u679c\u6211\u4eec\u786e\u5b9a\u4e86\u8d77\u70b9 $x$ \u7684\u4f4d\u7f6e\uff0c\u5c31\u80fd\u7ebf\u6027\u7b97\u7b54\u6848\u3002\u6211\u4eec\u8003\u8651\u73af\u4e0a\u79bb\u8d77\u70b9\u8ddd\u79bb\u4e3a $i$ \u7684\u70b9\u4e2d\uff0c\u8f6c\u79fb\u6743\u503c $1$ \u5230\u8d77\u70b9\u7684\u671f\u671b\uff08\u6ce8\u610f\u8fd9\u91cc  $i$ \u7684\u5b9a\u4e49\u6709\u53d8\u5316\uff09\uff0c\u4e0d\u59a8\u8bbe\u5176\u4e3a $E_i$ \uff0c\u8003\u8651\u5bf9\u5176\u4ed6\u671f\u671b\u7684\u8d21\u732e\u53ca\u73af\u672c\u8eab\u7684\u5bf9\u79f0\u6027\uff0c\u5219\u6709\uff1a\n\n$$E_0 = 0$$\n\n$$E_i = E_{n-i}$$\n\n$$2E_i = E_{i-1}+E_{i+1} + 2$$\n\n\u8f6c\u6362\u4e00\u4e0b\uff1a\n\n$$E_{i+1}-E_i =  E_i - E_{i-1}-2  $$ \n\n\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\uff0c\u5bf9\u524d $n-1$ \u9879\u6c42\u548c\uff0c\u53ef\u4ee5\u7531\u4e0a\u8ff0\u5f0f\u5b50\u5f97\u5230:\n\n$$E_1 = n-1$$\n\n\u5bf9\u524d $i-1$ \u9879\u505a\u524d\u7f00\u548c\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$E_i = (n-i) i$$\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\u6bcf\u4e2a $1$ \u8f6c\u79fb\u5230\u8d77\u70b9\u7684\u671f\u671b\u4e86\u3002\u66b4\u529b\u7684\u8bdd\u5c31\u662f\u679a\u4e3e\u6bcf\u4e2a\u8d77\u70b9\u7b97\u7b54\u6848\u3002\n\n\u8003\u8651\u4f18\u5316\uff0c\u53d1\u73b0\u8fd9\u662f\u4e2a\u4e8c\u6b21\u51fd\u6570\uff0c\u5176\u76f8\u90bb\u6574\u70b9\u51fd\u6570\u503c\u7684\u5dee\u7684\u5dee\u5206\u4e3a\u5b9a\u503c  $2$ \u6216 $-2$\uff0c\u800c\u5728\u672c\u9898\u4e2d\uff0c\u4ee4\u8d77\u70b9\u4ece\u5de6\u5411\u53f3\u79fb\u4e00\u4e2a\u5355\u4f4d\uff0c\u9664\u8d77\u70b9\u5916\u7684\u6240\u6709\u70b9\u5728\u51fd\u6570\u4e0a\u5de6\u79fb\u4e00\u4e2a\u5355\u4f4d\uff08\u76f8\u5f53\u4e8e\u5411\u53f3\u79fb\u52a8\u8d77\u70b9\u6bcf\u4e2a\u70b9\u79bb\u8d77\u70b9\u7684\u8ddd\u79bb $-1$ \uff09\uff0c\u539f\u8d77\u70b9\u52a0\u5230\u6240\u6709\u70b9\u6700\u540e\uff0c\u90a3\u4e48\u9664\u539f\u8d77\u70b9\u4ee5\u5916\u7684\u70b9\u7684\u671f\u671b\u503c\u7684\u589e\u91cf\u5fc5\u4e3a $-2$ .\n\n\u5355\u72ec\u8003\u8651\u524d\u8d77\u70b9$i$\uff0c\u5176\u671f\u671b\u503c\u589e\u91cf\u7531\u6700\u540e\u7684 $-(n-1)$ \uff0c\u53d8\u4e3a $(n-1)$ \uff0c\u589e\u91cf\u4e3a $2n-2$\uff08\u4ee5\u4e0a\u7686\u4e3a\u6743\u503c$1$\u7684\u589e\u91cf\uff0c\u8ba1\u7b97\u65f6\u53ea\u9700\u4e58\u4e0a\u5bf9\u5e94\u7684 $a_i$ \uff09\u3002\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u65b9\u4fbf\u7684\u7ef4\u62a4\u589e\u91cf\u3002\u8003\u8651\u79fb\u52a8\u8d77\u70b9\uff0c\u5219\u8d77\u70b9\u4ece$i$\u5230$i+1$\u589e\u91cf\u7684\u53d8\u5316\u91cf\u4e3a:\n\n$$2na_i-2\\sum_{j=1}^{j\\leq n} a_{j}$$\n\n\u521d\u59cb\u589e\u91cf\u4e3a:\n\n$$(n-1)a_1-\\sum_{j=2}^{j\\leq n} a_{j}(E_{j-1}-E_{j-2})$$\n\n\u540e\u8005\u662f\u6734\u7d20\u7684\u524d\u7f00\u548c\uff0c\u6bcf\u4e2a\u70b9\u7684\u589e\u91cf\u53ef\u4ee5\u5e38\u6570\u7ea7\u522b\u7ef4\u62a4\uff0c\u4e8e\u662f\u505a\u5b8c\u4e86\u3002\u552f\u4e00\u8981\u6ce8\u610f\u7684\u662f\u6570\u636e\u8303\u56f4\u4f1a\u7206 long long\u3002\u4ee3\u7801\u5982\u4e0b:\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint T,n;\nlong long a[1000005];\n__int128 ans=1e36,sum,add,p = 1004535809,b[1000005],E[1000005];\n//sum\u8868\u793a\u73b0\u5728\u7684\u7b54\u6848\uff0cadd\u8868\u793a\u589e\u91cf\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i = 1; i <= n; i++){\n\t\tscanf(\"%lld\",&a[i]);\n        b[i]=b[i-1]+a[i];//\u53ef\u4ee5\u76f4\u63a5\u7528\u4e00\u4e2a\u53d8\u91cf\u7ef4\u62a4\uff0c\u61d2\u5f97\u6539\u4e86\n        E[i-1] = (__int128)1ll*(n+1-i)*(i-1);/\u8ba1\u7b97\u521d\u59cb\u671f\u671b\n        sum+=E[i-1]*(__int128)a[i];//\u8ba1\u7b97\u521d\u59cb\u7b54\u6848\n        if(i>1)add+=(E[i-2]-E[i-1])*(__int128)a[i];//\u7ef4\u62a4\u521d\u59cb\u589e\u91cf\n\t}\n    add+=(n-1)*a[1];\n    ans=sum;\n    for(int i = 2;i <=n;i++){\n        sum+=add;\n        add-=b[n]*2;\n        add+=2*n*a[i];//\u6839\u636e\u4e0a\u8ff0\u5f0f\u5b50\u8ba1\u7b97\u65b0\u7684\u589e\u91cf\n        ans=min(ans,sum);\n    }\n    cout << (long long)(ans%(__int128)1004535809);\n\treturn 0;\n}\n```\n\n\n",
        "postTime": 1669371887,
        "uid": 523219,
        "name": "BobL",
        "ccfLevel": 7,
        "title": "P8850"
    }
]
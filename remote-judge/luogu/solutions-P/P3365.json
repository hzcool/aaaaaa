[
    {
        "content": "\u975e\u5e38\u5999\u7684\u4e00\u9053\u9898\n\n\u9996\u5148\u5982\u679c\u770b\u5230\u8fd9\u662f\u4e00\u68f5\u6811\u5c31\u5f80\u6811\u5f62$dp$\u4e0a\u60f3\u90a3\u80af\u5b9a\u5c31\u60f3\u4e0d\u51fa\u6765\u4e86\n\n\u6ce8\u610f\u8fd9\u662f\u4e00\u68f5\u4e8c\u53c9\u641c\u7d22\u6811\uff0c\u6240\u4ee5\u6709\u4e00\u4e9b\u975e\u5e38\u5947\u5999\u7684\u6027\u8d28\n\n\u719f\u6089\u5e73\u8861\u6811\u7684\u4eba\u5e94\u8be5\u77e5\u9053\uff0c\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u4e2d\u6839\u904d\u5386\u662f\u4e25\u683c\u4e0a\u5347\u7684\n\n\u6240\u4ee5\u6211\u4eec\u5c06\u4e2d\u6839\u904d\u5386\u6c42\u51fa\u6765\u5c31\u597d\u4e86\n\n\u73b0\u5728\u7684\u95ee\u9898\u53d8\u6210\u6700\u5c11\u4fee\u6539\u4e00\u4e2a\u5e8f\u5217\u4e0a\u7684\u4e00\u4e9b\u6570\uff0c\u4f7f\u5f97\u5176\u4e25\u683c\u4e0a\u5347\n\n\u9996\u5148\u76f4\u63a5\u6c42\u51fa$LIS$\u7684\u957f\u5ea6\u518d\u7528$n$\u4e00\u51cf\u80af\u5b9a\u662f\u9519\u7684\n\n\u6211\u4eec\u8003\u8651\u4e00\u4e0b\u53cd\u7740\u505a\n\n\u6211\u4eec\u8bbe$f_i$\u8868\u793a\u524d$i$\u4e2a\u6570\u91cc\u6700\u591a\u6709\u591a\u5c11\u4e2a\u4e0d\u7528\u4fee\u6539\n\n\u5bf9\u4e8e$i$\u4f4d\u7f6e\u4e0a\u7684\u6570$a_i$\u5982\u679c\u524d\u9762\u6709\u4e00\u4e2a\u4f4d\u7f6e$j$\u6ee1\u8db3$a_i-a_j>=i-j$\u7684\u8bdd\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628a$(i,j)$\u4e0a\u7684\u6570\u5168\u90e8\u4fee\u6539\u800c\u4e14\u80fd\u4f7f\u5f97\u5176\u4e25\u683c\u9012\u589e\n\n\u4e8e\u662f\u5c31\u6709\u8fd9\u6837\u4e00\u4e2a\u65b9\u7a0b\n\n$f_i=max(f_j+1)[a_i-a_j>=i-j]$\n\n\u4e5f\u5c31\u662f$a_i-i>=a_j-j$\n\n\u90a3\u5c31\u662f\u6240\u6709\u7684\u6570\u51cf\u6389\u4e0b\u6807\u4e4b\u540e\u6c42\u4e00\u4e2a\u6700\u957f\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\u554a\uff0c\u6700\u540e\u62ff$n$\u51cf\u53bb\u8fd9\u4e2a\u957f\u5ea6\u5c31\u597d\u4e86\n\n$O(nlogn)$\u5c31\u53ef\u4ee5\u6c42\u51fa\u4e86\n\n\u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#define re register\n#define maxn 100005\n#define max(a,b) ((a)>(b)?(a):(b))\ninline int read()\n{\n    char c=getchar();\n    int x=0;\n    while(c<'0'||c>'9') c=getchar();\n    while(c>='0'&&c<='9')\n        x=(x<<3)+(x<<1)+c-48,c=getchar();\n    return x;\n}\nint ch[maxn][2],a[maxn],n,now,key[maxn];\nvoid dfs(int x)\n{\n    if(ch[x][0]) dfs(ch[x][0]);\n    a[++now]=key[x];\n    if(ch[x][1]) dfs(ch[x][1]);\n}\nint f[maxn],d[maxn],len;\ninline int find(int x)\n{\n    int l=1,r=len,ans=0;\n    while(l<=r)\n    {\n        int mid=l+r>>1;\n        if(d[mid]<=x) ans=mid,l=mid+1;\n            else r=mid-1;\n    }\n    return ans;\n}\nint main()\n{\n    n=read();\n    for(re int i=1;i<=n;i++)\n        key[i]=read();\n    int x,fa;\n    for(re int i=2;i<=n;i++)\n        fa=read(),x=read(),ch[fa][x]=i;\n    dfs(1);\n    for(re int i=1;i<=n;i++)\n        a[i]-=i;\n    for(re int i=1;i<=n;i++)\n    {\n        f[i]=find(a[i])+1;\n        d[f[i]]=a[i];\n        len=max(len,f[i]);\n    }\n    printf(\"%d\\n\",n-len);\n    return 0;\n}\n```",
        "postTime": 1540363404,
        "uid": 35178,
        "name": "asuldb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3365 \u3010\u6539\u9020\u4e8c\u53c9\u6811\u3011"
    },
    {
        "content": "\u770b\u5230\u8fd9\u9053\u9898\uff0c\u6211\u4eec\u5e94\u8be5\u6709\u79cd\u51b2\u52a8\u5427\u2014\u2014\u5982\u679c\u4f60\u6ca1\u6709\uff0c\u90a3\u4e48\u6211\u4eec\u4e00\u8d77\u6765\u770b\n\n\u6392\u5e8f\u4e8c\u53c9\u6811\u6700\u5927\u7684\u7279\u70b9\u662f\u4ec0\u4e48\u2014\u2014\u6ca1\u9519\uff0c\u5c31\u662f\u6392\u5e8f\uff0c\u66f4\u4e25\u8c28\u6765\u8bf4\uff0c\u662f\u5b83\u7684\u4e2d\u5e8f\u904d\u5386\u6210\u5347\u5e8f\uff08\u65e0\u91cd\u590d\u5143\u7d20\u524d\u63d0\u4e0b\uff09 \uff0c\u800c\u5bf9\u4e00\u68f5\u4e8c\u53c9\u6811\uff0c\u5b83\u7684\u4e2d\u5e8f\u904d\u5386\u7684\u987a\u5e8f\u662f\u4e0d\u4f1a\u53d8\u5316\u7684\uff0c\u56e0\u6b64\u73b0\u5728\u7684a[i]\u53ea\u4f1a\u662fa[i]\u4e0d\u53d8\u5316/\u53d8\u5316\u540e\u5f97\u5230\u7684\u7ed3\u679c\n\n\u6211\u4eec\u53c8\u60f3\u8ba9\u4fee\u6539\u6b21\u6570\u6700\u5c11\uff0c\u53c8\u60f3\u4ee4\u5176\u4fdd\u6301\u5347\u5e8f\uff0c\u56e0\u6b64\u6211\u4eec\u76f4\u63a5\u627e\u51fa\u5176\u4e2d\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u4e0d\u52a8\uff0c\u5176\u4f59\u4fee\u6539\uff08\u7231\u548b\u548b\u5730\uff09\u4e0d\u662f\n\n\u6d41\u7a0b\u5982\u4e0b\uff1a\n\n1.\t\u8bfb\u5165\uff0c\u6c42\u6811\u7684\u4e2d\u5e8f\u904d\u5386\uff0c\u8ba1\u5165s[]\u6570\u7ec4\n2.\tLIS\u4e00\u904d\u6c42\u51falen\uff0cans=n-len\n\n\u540c\u65f6\uff0c\u8fd9\u9053\u9898n<=100000,$n^2$\u7684\u8001\u5e74LIS\u7b97\u6cd5\u662f\u4e0d\u884c\u7684\uff0c\u5927\u5bb6\u53ef\u4ee5\u53bb\u770b\u5927\u795e\u7684\u535a\u5ba2\uff0c\u5efa\u8bae\u5199\u6cd5\uff1a\n\n```cpp\nmemset(dp,INF,sizeof dp);\ngo(i,1,n)dp[lower_bound(dp+1,dp+n+1,s[i])-dp]=s[i];\n\treintlen=(lower_bound(dp+1,dp+n+1,INF)-dp)-1;\n\n```\n    \n\u4f46\u5343\u4e07\u522b\u5f00\u5fc3\u8fc7\u5934\u4e86\n\u6765\u770b\u770b\u6211\u8003\u573a\u4e0a\u5199\u7684\u6837\u4f8b\n\n![](https://cdn.luogu.com.cn/upload/pic/41030.png)\n\nHow to \u5b8c\u5584\u6211\u4eec\u7684\u65b9\u6848\uff1f\n\u501f\u7528\u4e00\u53e5\u8bdd\uff1a\u4e0d\u4e25\u8c28\u7684\u771f\u7406\u5f80\u5f80\u662f\u901a\u5f80\u771f\u7406\u7684\u94a5\u5319\u3002\n\n\n\u4ece\u9519\u8bef\u5165\u624b\uff0c\u5206\u6790\u9519\u8bef\u539f\u56e0\uff1a\n\u8003\u8651\u4e8c\u53c9\u6392\u5e8f\u6811\u7684\u5b9a\u4e49\uff1a\n\n _\u8bbekey[p]\u8868\u793a\u7ed3\u70b9p \u4e0a\u7684\u6570\u503c\uff0c\u5bf9\u4e8e\u5176\u4e2d\u7684\u6bcf\u4e2a\u7ed3\u70b9p\uff0c\u82e5\u5176\u5b58\u5728\u5de6\u5b69\u5b50lch\uff0c\u5219key[p]>key[lch]\uff1b\u82e5\u5176\u5b58\u5728\u53f3\u5b69\u5b50rch\uff0c\u5219key[p]<key[rch]\u3002\u6ce8\u610f\uff0c\u5e94\u8be5\u662f\u6240\u6709\u5de6\u5b50\u6811\u4e2d\u7684key \u5c0f\u4e8e\u5f53\u524dkey\uff0c\u6240\u6709\u53f3\u5b50\u6811\u4e2d\u7684key \u5927\u4e8e\u5f53\u524dkey\u3002_ \n\n\u5176\u4e2d\u552f\u4e00\u4e14\u6700\u5927\u7684\u9650\u5236\u5c31\u5728\u4e8e\u6839\u548c\u513f\u5b50\u7684\u5927\u5c0f\u7ea6\u675f\u5173\u7cfb\uff1a\u800c\u8fd9\u79cd\u5173\u7cfb\u4f53\u73b0\u5728\u4ec0\u4e48\uff0c\u662f\u4e2d\u5e8f\u904d\u5386\u7684\u7f16\u53f7\uff01\n\n![](https://cdn.luogu.com.cn/upload/pic/41031.png)\n\n\u518d\u770b\u6b64\u56fe\uff0c5\u5728\u4e2d\u5e8f\u662f4,3\u5728\u4e2d\u5e8f\u662f7\n\n\u65453\u548c5\u7684\u5173\u7cfb\u7275\u626f\u52303\u5c42\uff08\u7b2c\u4e00\u6b21\u6211\u4eec\u5c06\u5176\u5217\u51fa\uff1a1\u6bd43\u5c0f\uff0c2\u6bd41\u5c0f\uff0c5\u6bd42\u5927\uff09\uff0c\u7b80\u5355\u6765\u8bf4\uff0c\u7531\u4e8e\u8fd9\u91cc\u4e0d\u53ef\u53d6\u7b49\uff0c3\u548c5\u5c31\u81f3\u5c11\u76f8\u5dee\u4e09\u2014\u2014\u4e0d\u4fe1\u7684\u8bdd\u4f60\u8fd8\u662f\u5c1d\u8bd5\u53bb\u9020\u7b2c\u4e8c\u4e2a\u56fe\n\u5728\u7a0b\u5e8f\u5b9e\u73b0\u4e2d\u5373\u5bf9\u6bcf\u5bf9i\uff0cj,|va[i]-va[j]|>=|\u5176\u4e2d\u5e8f\u904d\u5386\u4e4b\u5dee|\n\n\u8fd9\u4e2a\u4e1c\u897f\u5f88\u9ebb\u70e6\uff0c\u800c\u4e2d\u5e8f\u904d\u5386\u65f6\u6211\u4eec\u5176\u5b9e\u53ef\u4ee5\u76f4\u63a5\u4fdd\u5b58va[i]-(i\u7684\u4e2d\u5e8f\u904d\u5386\u7f16\u53f7)\u4e4b\u540e\u5c31\u6c42\u4e00\u4e2a\u4e0d\u4e0b\u964d\u5e8f\u5217\u5373\u53ef\n\n\u5177\u4f53\u7684\u5b9e\u73b0\u5982\u4e0b\uff1a\n\n\u4e2d\u5e8f\uff1a\n```cpp\nvoid zx(re int rt)\n{\n\tif(t[rt].lc) zx(t[rt].lc);\n\ts[++s[0]]=t[rt].va-s[0];\n\tif(t[rt].rc) zx(t[rt].rc);\n}\n```\n\u4e0d\u964dlis\uff08\u8fd9\u91cc\u6ca1\u529e\u6cd5stl\u76f4\u63a5\u5199\uff09\uff1a\n```cpp\ndp[len=1]=s[1];\ngo(i,2,n)\n\tif(s[i]>=dp[len]) \n\t\tdp[++len]=s[i]; \n\telse{      \t\t\n        \tre int j=upper_bound(dp+1,dp+len+1,s[i])-dp;\n            dp[j]=s[i];\n\t\t}\n//ans=n-len\n```\n\n\n\n",
        "postTime": 1540954840,
        "uid": 40629,
        "name": "zzw4257",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3365 \u3010\u6539\u9020\u4e8c\u53c9\u6811\u3011"
    },
    {
        "content": "## \u9898\u76ee\u5927\u610f\n\n\u7ed9\u51fa\u4e00\u9897\u4e8c\u53c9\u6811\u53ca\u5176NN\u4e2a\u8282\u70b9\u7684\u6743\u503c\uff0c\u6bcf\u4e2a\u8282\u70b9\u6743\u503c\u6700\u591a\u4fee\u6539\u4e00\u6b21\uff0c\u4e14\u53ea\u80fd\u4fee\u6539\u6210\u6574\u6570\u3002\u6c42\u6700\u5c0f\u7684\u4fee\u6539\u6b21\u6570\uff0c\u4f7f\u8fd9\u68f5\u4e8c\u53c9\u6811\u6210\u4e3a\u6392\u5e8f\u4e8c\u53c9\u6811\u3002\n\nN<=100000N<=100000\n## \u9898\u76ee\u5206\u6790\n\u9996\u5148\uff0c\u6392\u5e8f\u4e8c\u53c9\u6811\u662f\u4e00\u79cd\u5de6\u513f\u5b50\u6743\u503c\u4e25\u683c\u5c0f\u4e8e\u7236\u4eb2\uff0c\u53f3\u513f\u5b50\u6743\u503c\u4e25\u683c\u5927\u4e8e\u7236\u4eb2\u7684\u4e8c\u53c9\u6811\uff08BSTBST\uff09\u3002\u6240\u8c13\u201c\u6392\u5e8f\u201d\uff0c\u5c31\u662f\u4e2d\u5e8f\u904d\u5386\u6392\u5e8f\u4e8c\u53c9\u6811\uff0c\u5f97\u5230\u7684\u662f\u4e00\u4e2a\u4e25\u683c\u9012\u589e\u7684\u5e8f\u5217\u3002\n\n\u90a3\u4e48\u6211\u4eec\u663e\u7136\u8981\u5148\u4e2d\u5e8f\u904d\u5386\u4e00\u8d9f\uff0c\u6784\u9020\u51fainord\u6570\u7ec4\uff0c\u90a3\u4e48\u9898\u76ee\u5c31\u53d8\u6210\u6c42\u4f7f\u4e00\u4e2a\u5e8f\u5217\u53d8\u4e3a\u4e25\u683c\u9012\u589e\u6240\u9700\u7684\u6700\u5c11\u4fee\u6539\u6b21\u6570 \n\u6240\u4ee5\u7b54\u6848\u5c31\u4e3aN\u2212LIS(\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217)\n\n#### \u4f46\u662f\uff0c\n\n\u9898\u76ee\u8981\u6c42\u6bcf\u4e2a\u8282\u70b9\u7684\u6743\u503c\u53ea\u80fd\u6539\u4e3a\u6574\u6570\uff01\u53ea\u8981\u6709\u201c\u5361\u6b7b\u201d\u7684\u91cd\u590d\u5143\u7d20\uff0c\u5c31\u5b8c\u86cb\u4e86 \n\n\u5982\u8fd9\u4e2a\u6837\u4f8b\u5c31\u5d29\u6e83\u4e86\uff1a \n\nN=4\u3000\n\nA:1\u3000\u30002\u3000\u30002\u3000\u30003\n\nLIS=3\u3000\u3000\nWrong Answer=1 \uff0c\nWright  Answer=2\n\n\n\n\u6211\u4eec\u518d\u601d\u8003\u4e00\u4e0b\uff1a\n\n\u4fee\u6539\u5b8c\u540e\uff0c\u663e\u7136 \n\nA[1]<A[2]<...<A[i]<A[i+1]<...<A[N]\n\n\u5373\n\nA[1]+1<=A[2],A[2]+1<=A[3],...,A[i]+1<=A[i+1],...,A[N-1]+1<=A[N]\n\n\u53c8\u5bf9\u4e8ei<=j,A[j]-A[i]>=j-i,\u5373A[j]-j>=A[i]-i\n\n\u5219A[1]-1<=A[2]-2<=A[3]-3......\n\n\n\u6b64\u65f6\uff0c\u5c31\u6ca1\u6709\u91cd\u590d\u7684\u5143\u7d20\u5f71\u54cd\u4e86\n\n\u53ea\u8981O(N\u2217logN)\u6c42\u4e00\u8d9f\u6700\u957f\u4e0d\u964d\u5b50\u5e8f\u5217\u5c31OK\u4e86\n\n\n\n### \u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n;//\u4e8c\u53c9\u6811\u8282\u70b9\u6570\nstruct tree//\u4e8c\u53c9\u6811 \n{\n\tint fa;//\u7236\u4eb2\u8282\u70b9 \n\tint l;//\u5de6\u5b69\u5b50 \n\tint r;//\u53f3\u5b69\u5b50 \n}tr[100005];\nint w[100005];//\u7ed3\u70b9\u7684\u6570\u503c \nint inord[100005];//\u4e2d\u5e8f\u904d\u5386 \nint k;\nint lis[100005];//\u6700\u957f\u4e0d\u964d\u5b50\u5e8f\u5217\nvoid inorder(int root)//\u4e2d\u5e8f\u904d\u5386 \n{\n\tif(tr[root].l)//\u5982\u679c\u5de6\u513f\u5b50\u4e0d\u4e3a\u7a7a \n\t\tinorder(tr[root].l);//\u641c\u7d22\u5de6\u513f\u5b50 \n\tinord[++k]=w[root]-k;\n\tif(tr[root].r)//\u5982\u679c\u53f3\u513f\u5b50\u4e0d\u4e3a\u7a7a \n\t\tinorder(tr[root].r);//\u641c\u7d22\u53f3\u513f\u5b50 \n}\nint main()\n{\n\tcin>>n;//\u8f93\u5165n\u4e2a\u7ed3\u70b9 \n\tfor(int i=1;i<=n;i++)\n\t\tcin>>w[i];//\u8f93\u5165\u6bcf\u4e2a\u4eba\u7ed3\u70b9\u7684\u6570\u503c \n\ttr[1].fa=0;//1\u53f7\u70b9\u7684\u7236\u4eb2\u4e3a\u7a7a \n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tint t;//\u5de6/\u53f3\u513f\u5b50 \n\t\tcin>>tr[i].fa>>t;//\u8f93\u5165\u7236\u4eb2\u7ed3\u70b9 \n\t\tif(t==0) \n\t\t\ttr[tr[i].fa].l=i;//\u8fd9\u4e2a\u70b9\u662f\u4ed6\u7236\u4eb2\u7684\u5de6\u513f\u5b50 \n\t\telse\n\t\t\ttr[tr[i].fa].r=i;//\u8fd9\u4e2a\u70b9\u662f\u4ed6\u7236\u4eb2\u7684\u53f3\u513f\u5b50 \n\t}\n\tinorder(1);//\u5bf9\u8fd9\u68f5\u6811\u8fdb\u884c\u4e2d\u5e8f\u904d\u5386 \n\tlis[1]=inord[1];//\u6c42\u6700\u957f\u4e0d\u4e0b\u964d\u5e8f\u5217 \n\tint cnt=1;//\u6700\u957f\u4e0d\u4e0b\u964d\u5e8f\u5217\u957f\u5ea6 \n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tif(inord[i]>=lis[cnt])\n\t\t\tlis[++cnt]=inord[i];\n\t\telse\n\t\t{\n\t\t\tint j=lower_bound(lis+1,lis+1+cnt,inord[i])-lis;//lower_bound\u8fd4\u56de\u7684\u662f\u5728lis\u76841~1+cnt\u7684\u8303\u56f4\u5185\u7b2c\u4e00\u4e2a\u5927\u4e8e\u7b49\u4e8einord[i]\u7684\u6570\u7684\u4f4d\u7f6e \n\t\t\tlis[j]=inord[i]; \n\t\t}\t\n\t} \n\tcout<<n-cnt;//\u603b\u4e2a\u6570-\u6700\u957f\u4e0d\u4e0b\u964d\u5e8f\u5217\u957f\u5ea6\uff0c\u5c31\u662f\u8981\u4fee\u6539\u7684\u4e2a\u6570 \n}\n```",
        "postTime": 1541128048,
        "uid": 59097,
        "name": "\u5f20\u4ea6\u5f1b",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3365 \u3010\u6539\u9020\u4e8c\u53c9\u6811\u3011"
    },
    {
        "content": "\u5feb\u8bfb+\u4e2d\u5e8f\u904d\u5386+\u4e0d\u51cfLIS\n\n\u6d1b\u8c37\u6700\u4f18\u89e3\u7f8e\u6ecb\u6ecb\n```\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\nstruct Binary{\n\tint lch,rch,data;\n}tr[500010];\nint spray[500010],d[500010],k,n;\ninline long long read()\n{\n    long long ans=0,f=1;\n    char ch=getchar();\n    while(ch<'0'||ch>'9') {if(ch=='-') f=-1;ch=getchar();}\n    while(ch>='0'&&ch<='9') {ans=ans*10+ch-'0';ch=getchar();}\n    return ans*f;\n}\nvoid MiddleOrder(int now){\n\tif(tr[now].lch) MiddleOrder(tr[now].lch);\n\tspray[++k]=tr[now].data-k;\n\tif(tr[now].rch) MiddleOrder(tr[now].rch);\n}\nint main()\n{\n\tn=read();\n\tfor(int i=1;i<=n;i++)\n\t\ttr[i].data=read();\n\tfor(int i=1,fa,ch;i<=n-1;i++)\n\t{\n\t\tfa=read();ch=read();\n\t\tif(!ch) tr[fa].lch=i+1;\n\t\t else tr[fa].rch=i+1;\n\t}\n\tMiddleOrder(1);\n\tint head=1;\n    d[1]=spray[1];\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tif(spray[i]>=d[head]) d[++head]=spray[i];\n\t\t else{\n\t\t \tint j=lower_bound(d+1,d+head+1,spray[i])-d;\n\t\t \td[j]=spray[i];\n\t\t }\n\t}\n\tprintf(\"%d\",n-head);\n\treturn 0;\n}\n```",
        "postTime": 1520759550,
        "uid": 51744,
        "name": "Horrigue_\u8881\u56db\u7237",
        "ccfLevel": 0,
        "title": "P3365 \u6539\u9020\u4e8c\u53c9\u6811"
    },
    {
        "content": "\u9898\u9762\u597d\u6076\u5fc3\u7684\u8bf4\u3002\n\n\u6839\u636e\u9898\u9762\uff0c\u6211\u4eec\u770b\u4e0d\u51fa\u4ed6\u5728\u8bf4\u4ec0\u4e48\uff0c\u4ed4\u7ec6\u770b\uff0c\u8fd8\u662f\u770b\u4e0d\u61c2\u3002\u3002\u3002\u3002\u7136\u540e\uff0c\u770b\u61c2\u4e86------\n\n\u53ef\u4ee5\u5148\u6c42\u51fa\u6811\u7684\u4e2d\u5e8f\u904d\u5386\uff0c\u7136\u540e\u505a\u4e00\u904d\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\uff1f\uff1f\uff1f\u4f46\u662f\u7531\u4e8e\u6574\u6570\u9650\u5236\uff0c\u8fd9\u6837\u4f1aWA\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e8e\u6570di\u505a\u4e00\u4e2a\u6620\u5c04\uff0cdi=di-i\uff0c\u7136\u540e\u505a\u4e00\u904d\u6700\u957f\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\u5c31\u53ef\u4ee5\u5f97\u51fa\u6b63\u786e\u7684\u7b54\u6848\u3002\n\n\u6c42\u904d\u5386\u7684\u65b9\u6cd5\u548cLIS\u7684\u65b9\u6cd5\u4e0d\u7ec6\u8bf4\u4e86\u3002\n\n\n\n\n\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <cmath>\n#include <algorithm>\nusing namespace std;\nconst int maxn=100000+20;\nint n,p[maxn],lch[maxn],rch[maxn];\nint order[maxn],tot=0;\nint f[maxn],ans;\ninline void read(int& n){\n    n=0;\n    char ch=getchar();\n    while(ch<'0' || ch>'9') ch=getchar();\n    do{\n        n=n*10+ch-'0';\n        ch=getchar();\n    }while(ch>='0' && ch<='9');\n    return;\n}\nvoid init(){\n    memset(lch,-1,sizeof(lch));\n    memset(rch,-1,sizeof(rch));\n    read(n);\n    for(int i=1;i<=n;i++) read(p[i]);\n    for(int i=2;i<=n;i++){\n        int fa,ff;\n        read(fa);\n        read(ff);\n        if(ff==0) lch[fa]=i;\n        else rch[fa]=i;\n    }\n    return;\n}\nvoid dfs(int node){\n    if(node==-1) return;\n    dfs(lch[node]);\n    ++tot;\n    order[tot]=p[node]-tot;\n    dfs(rch[node]);\n    return;\n}\nvoid solve(){\n    dfs(1);\n    for(int i=1;i<=tot;i++){\n        f[i]=2100000000;\n    }\n    f[1]=order[1];ans=1;\n    for(int i=2;i<=tot;i++){\n        if(order[i]>=f[ans])\n            f[++ans]=order[i];\n        else{\n            int l = 1,r = ans;\n            while (l <= r) {\n                int mid = l + r >> 1;\n                if (f[mid] <= order[i]) l = mid + 1;\n                else     r = mid - 1;\n            }\n            f[l] = order[i];\n        }\n    }\n    ans=n-ans;\n    printf(\"%d\",ans);\n    return;\n}\nint main(){\n    init();\n    solve();\n    return 0;\n}\n\n```",
        "postTime": 1476247812,
        "uid": 8874,
        "name": "Kwork",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3365 \u3010\u6539\u9020\u4e8c\u53c9\u6811\u3011"
    },
    {
        "content": "# [P3365 \u6539\u9020\u4e8c\u53c9\u6811](https://www.luogu.org/problem/P3365)\n\n> ## \u9898\u610f\n\n### \u9898\u76ee\u80cc\u666f\n```\n\u52e4\u594b\u53c8\u5584\u4e8e\u601d\u8003\u7684\u5c0fL\u63a5\u89e6\u4e86\u4fe1\u606f\u5b66\u7ade\u8d5b\uff0c\u5f00\u59cb\u7684\u5b66\u4e60\u5341\u5206\u987a\u5229\u3002\u4f46\u662f\uff0c\u5c0fL\u5bf9\u6570\u636e\u7ed3\u6784\n\u7684\u638c\u63e1\u5b9e\u5728\u5341\u5206\u6e23\u6e23\u3002\n\n\u6240\u4ee5\uff0c\u5c0fL\u5f53\u65f6\u5361\u5728\u4e86\u4e8c\u53c9\u6811\u3002\n```\n\n### \u9898\u76ee\u63cf\u8ff0\n```\n\u5728\u8ba1\u7b97\u673a\u79d1\u5b66\u4e2d\uff0c\u4e8c\u53c9\u6811\u662f\u6bcf\u4e2a\u7ed3\u70b9\u6700\u591a\u6709\u4e24\u4e2a\u5b50\u7ed3\u70b9\u7684\u6709\u5e8f\u6811\u3002\u901a\u5e38\u5b50\u7ed3\u70b9\u88ab\u79f0\u4f5c\n\u201c\u5de6\u5b69\u5b50\u201d\u548c\u201c\u53f3\u5b69\u5b50\u201d\u3002\u4e8c\u53c9\u6811\u88ab\u7528\u4f5c\u4e8c\u53c9\u641c\u7d22\u6811\u548c\u4e8c\u53c9\u5806\u3002\u968f\u540e\u4ed6\u53c8\u548c\u4ed6\u4eba\u8ba8\u8bba\u8d77\n\u4e86\u4e8c\u53c9\u641c\u7d22\u6811\u3002\u4ec0\u4e48\u662f\u4e8c\u53c9\u641c\u7d22\u6811\u5462\uff1f\u4e8c\u53c9\u641c\u7d22\u6811\u9996\u5148\u662f\u4e00\u68f5\u4e8c\u53c9\u6811\u3002\u8bbekey[p]\u8868\u793a\u7ed3\n\u70b9p\u4e0a\u7684\u6570\u503c\u3002\u5bf9\u4e8e\u5176\u4e2d\u7684\u6bcf\u4e2a\u7ed3\u70b9p\uff0c\u82e5\u5176\u5b58\u5728\u5de6\u5b69\u5b50lch\uff0c\u5219key[p]>key[lch]\uff1b\u82e5\u5176\n\u5b58\u5728\u53f3\u5b69\u5b50rch\uff0c\u5219key[p]<key[rch]\uff1b\u6ce8\u610f\uff0c\u672c\u9898\u4e2d\u7684\u4e8c\u53c9\u641c\u7d22\u6811\u5e94\u6ee1\u8db3\u5bf9\u4e8e\u6240\u6709\u7ed3\n\u70b9\uff0c\u5176\u5de6\u5b50\u6811\u4e2d\u7684key\u5c0f\u4e8e\u5f53\u524d\u7ed3\u70b9\u7684key\uff0c\u5176\u53f3\u5b50\u6811\u4e2d\u7684key\u5927\u4e8e\u5f53\u524d\u7ed3\u70b9\u7684key\u3002\uff08\u56e0\n\u4e3a\u5c0fL\u5341\u5206\u559c\u6b22\u88c5xx\uff0c\u6240\u4ee5\u8fd9\u91cc\u4ed6\u5341\u5206\u88c5xx\u7684\u7ed9\u5927\u5bb6\u4ecb\u7ecd\u4e86\u4ec0\u4e48\u662f\u4e8c\u53c9\u6811\u548c\u4e8c\u53c9\u641c\u7d22\n\u6811\uff09\u3002\n\n\u53ef\u662f\u5584\u4e8e\u601d\u8003\u7684\u5c0fL\u4e0d\u7518\u4e8e\u53ea\u5b66\u4e60\u8fd9\u4e9b\u57fa\u7840\u7684\u4e1c\u897f\u3002\u4ed6\u601d\u8003\u4e86\u8fd9\u6837\u4e00\u4e2a\u95ee\u9898\uff1a\u73b0\u5728\u7ed9\u5b9a\n\u4e00\u68f5\u4e8c\u53c9\u6811\uff0c\u53ef\u4ee5\u4efb\u610f\u4fee\u6539\u7ed3\u70b9\u7684\u6570\u503c\u3002\u4fee\u6539\u4e00\u4e2a\u7ed3\u70b9\u7684\u6570\u503c\u7b97\u4f5c\u4e00\u6b21\u4fee\u6539\uff0c\u4e14\u8fd9\u4e2a\u7ed3\n\u70b9\u4e0d\u80fd\u518d\u88ab\u4fee\u6539\u3002\u82e5\u8981\u5c06\u5176\u53d8\u6210\u4e00\u68f5\u4e8c\u53c9\u641c\u7d22\u6811\uff0c\u4e14\u4efb\u610f\u65f6\u523b\u7ed3\u70b9\u7684\u6570\u503c\u5fc5\u987b\u662f\u6574\u6570\n\uff08\u53ef\u4ee5\u662f\u8d1f\u6574\u6570\u62160\uff09\uff0c\u6240\u8981\u7684\u6700\u5c11\u4fee\u6539\u6b21\u6570\u3002\n\n\u8fd9\u4e00\u5b9a\u96be\u4e0d\u5012\u806a\u660e\u7684\u4f60\u5427\uff01\u5982\u679c\u4f60\u80fd\u5e2e\u5c0fL\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u4e5f\u8bb8\u4ed6\u4f1a\u628a\u6700\u540e\u7684\u8d44\u4ea7\u5206\u7ed9\n\u4f601/16\u54e6\uff01\n```\n\n### \u8f93\u5165\u683c\u5f0f\n```\n\u7b2c\u4e00\u884c\u4e00\u4e2a\u6b63\u6574\u6570n\u8868\u793a\u4e8c\u53c9\u6811\u8282\u70b9\u6570\u3002\n\n\u7b2c\u4e8c\u884cn\u4e2a\u6b63\u6574\u6570\u7528\u7a7a\u683c\u5206\u9694\u5f00\uff0c\u7b2ci\u4e2a\u6570ai\u8868\u793a\u7ed3\u70b9i\u7684\u539f\u59cb\u6570\u503c\u3002\n\n\u6b64\u540en - 1\u884c\u6bcf\u884c\u4e24\u4e2a\u975e\u8d1f\u6574\u6570fa, ch\uff0c\u7b2ci + 2\u884c\u63cf\u8ff0\u7ed3\u70b9i + 1\u7684\u7236\u4eb2\u7f16\u53f7fa\uff0c\u4ee5\u53ca\n\u7236\u5b50\u5173\u7cfbch\uff0c(ch = 0 \u8868\u793ai + 1\u4e3a\u5de6\u513f\u5b50\uff0cch = 1\u8868\u793ai + 1\u4e3a\u53f3\u513f\u5b50)\u3002\n\n\u4e3a\u4e86\u8ba9\u4f60\u7a0d\u5fae\u51cf\u8f7b\u4e9b\u8d1f\u62c5\uff0c\u5c0fL\u89c4\u5b9a\uff1a\u7ed3\u70b91\u4e00\u5b9a\u662f\u4e8c\u53c9\u6811\u7684\u6839\u54e6\uff01\n```\n\n### \u8f93\u51fa\u683c\u5f0f\n```\n\u4ec5\u4e00\u884c\u5305\u542b\u4e00\u4e2a\u6574\u6570\uff0c\u8868\u793a\u6700\u5c11\u7684\u4fee\u6539\u6b21\u6570\n```\n\n### \u8f93\u5165\u6837\u4f8b\n```cpp\n3\n2 2 2\n1 0\n1 1\n```\n\n### \u8f93\u51fa\u6837\u4f8b\n```cpp\n2\n```\n\n### \u8bf4\u660e/\u63d0\u793a\n```\n20 % \uff1an <= 10 , ai <= 100.\n40 % \uff1an <= 100 , ai <= 200\n60 % \uff1an <= 2000 .\n100 % \uff1an <= 10 ^ 5 ,  ai < 2 ^ 31.\n```\n\n### \u9898\u610f\u7b80\u8ff0\n```\n\u7ed9\u5b9a\u4e00\u68f5\u4e8c\u53c9\u6811\u4ee5\u53ca\u4e66\u4e0a\u6bcf\u4e2a\u70b9\u7684\u70b9\u6743\uff0c\u4f60\u6bcf\u6b21\u53ef\u4ee5\u5c06\u4e00\u4e2a\u70b9\u7684\u70b9\u6743\u6539\u4e3a\u4efb\u610f\u503c\uff0c\u8981\n\u6c42\u6700\u540e\u7684\u6811\u662f\u4e00\u68f5\u4e8c\u53c9\u641c\u7d22\u6811\n```\n\u6ce8\uff1a\u4e0d\u77e5\u9053\u4e8c\u53c9\u641c\u7d22\u6811\u662f\u5565\u7684\u6233[\u8fd9\u91cc](https://oi-wiki.org/ds/bst/)\n\n> ## \u89e3\u9898\n~~\u7b2c\u4e00\u773c\u4ee5\u4e3a\u8fd9\u662f\u4e00\u4e2a\u6811\u5f62DP\u7684\u4e3e\u8d77\u4f60\u4eec\u7684\u722a\u5b50~~\n\n\u867d\u7136\u9898\u76ee\u662f\u7528\u6811\u7684\u5f62\u5f0f\u7ed9\u51fa\u7684\n\n\u4f46\u662f\u5982\u679c\u4f60\u4f7f\u7528\u6811\u5f62DP\u5b9e\u9645\u64cd\u4f5c\u65f6\u5374\u5f88\u56f0\u96be\n\n\u56e0\u4e3a\uff1a\n```\n1.\u5982\u4f55DP\uff1f\u6216\u8005\u8bf4\uff1a\u5982\u4f55\u8f6c\u79fb\uff1f\n2.\u6700\u540e\u7684\u7b54\u6848\u5982\u4f55\u7edf\u8ba1\n```\n\n\u53cd\u6b63\u5f53\u6211\u505a\u7684\u65f6\u5019\u8fde\u7b2c\u4e00\u70b9\u90fd\u89e3\u51b3\u4e0d\u4e86~~\u6240\u4ee5\u8bf4\u6211\u662f\u771f\u7684\u84bb\u554a~~\n\n\u518d\u770b\u770b\u9898\u76ee\uff0c\u5c31\u662f\u8981\u6c42\u6700\u5c0f\u7684\u4fee\u6539\u6b21\u6570\u4f7f\u5f97\u7ed9\u5b9a\u7684\u6811\u53d8\u6210\u4e8c\u53c9\u641c\u7d22\u6811\n\n\u600e\u4e48\u529e\u5462\uff1f\n\n\u8fd9\u4e2a\u65f6\u5019\u5c31\u8981\u5229\u7528\u5230\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u4e00\u4e2a\u91cd\u8981\u6027\u8d28\u4e86\uff1a\n\n**\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u4e2d\u5e8f\u904d\u5386\u662f\u6709\u5e8f\u7684**\n\n\u4e8e\u662f\u9898\u76ee\u5c31\u53d8\u6210\u4e86\n```\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3an\u7684\u5e8f\u5217(\u662f\u5e8f\u5217\u4e0d\u662f\u6392\u5217)\uff0c\u6c42\u6700\u5c11\u7684\u4fee\u6539\u6b21\u6570\u4f7f\u5f97\u8fd9\u4e2a\u5e8f\u5217\u53d8\u4e3a\u5355\u8c03\n\u4e0a\u5347\u5e8f\u5217\n```\n\n\u6240\u4ee5\u6211\u4eec\u518d\u6765\u601d\u8003\u4e0a\u9762\u8fd9\u4e2a\u95ee\u9898\n\n\u8981\u4fee\u6539\u5c3d\u91cf\u5c11\u7684\u6b21\u6570\u548c\u4fdd\u7559\u5c3d\u91cf\u591a\u7684\u539f\u6570\u662f\u7b49\u4ef7\u7684\n\n\u6211\u4eec\u5c31\u6c42\u51fa\u80fd\u4fdd\u7559\u7684\u6700\u591a\u4e2a\u6570\n\n\u5176\u5b9e\u5c31\u662f[LIS](https://baike.baidu.com/item/LIS/16018280?fr=aladdin)\u5566\n\n\u7b80\u5355\u8bc1\u660e\u4e00\u4e0b\n```\n\u4e0d\u53ef\u80fd\u627e\u51fa\u6bd4LIS\u66f4\u957f\u7684\u4fdd\u7559\u5e8f\u5217\n\u56e0\u4e3a\u7ed3\u679c\u5fc5\u987b\u6709\u5e8f\n\u6240\u4ee5\u4fdd\u7559\u7684\u90e8\u5206\u5fc5\u987b\u6709\u5e8f\n```\n\u4f46\u662f\u4e8b\u60c5\u8fdc\u6ca1\u6709\u8fd9\u4e48\u7b80\u5355\n\n\u5728\u4fdd\u7559\u503c\u7684\u540c\u65f6\uff0c\u8fd9\u4e2a\u6570\u7684\u4f4d\u7f6e\u4e5f\u5fc5\u987b\u4fdd\u7559\n\n\u6bd4\u5982\n```cpp\n10\n1 9 8 2 3 4 5 6 7 8\n```\n\u6309\u7167\u521a\u521a\u7684\u60f3\u6cd5\uff0c\u5e94\u6c42\u51falen_of_LIS=8\n\n\u6240\u4ee5\u7b54\u6848\u662f10-8=2\n\n\u7136\u800c\uff0c\u539f\u9898\u76ee\u8981\u6c42\u5e8f\u5217\u4e25\u683c\u5347\u5e8f\uff0c1\u4e0e2\u4e4b\u95f4\u7684\u4e24\u4e2a\u6570\u65e0\u8bba\u5982\u4f55\u4e5f\u65e0\u6cd5\u585e\u57281\u548c2\u7684\u4e2d\u95f4\n\n\u5c31\u662f\u8bf4\uff0c\u6700\u540e\u6c42\u51fa\u7684LIS\u8fd8\u9700\u6ee1\u8db3\n\n**\u8bb0d[i]\u8868\u793aLIS\u4e2d\u7684\u7b2ci\u4e2a\u6570\uff0c\u90a3\u4e48\u5bf9\u4e8e\u4efb\u610fi!=j\uff0c\u6709d[i]-d[j]>=i-j**\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e24\u4e2a\u6570\u4e4b\u95f4\u5fc5\u987b\u8981\u7ed9\u5f85\u4fee\u6539\u7684\u6570\u7559\u7a7a\u95f4\n\n\u5f88\u591a\u4eba\u5c31mengbi\u4e86\uff1aLIS\u4e5f\u6ca1\u8fd9\u73a9\u6cd5\u5440\uff1f\n\n\u5176\u5b9e\u6211\u628a\u521a\u521a\u7684\u6761\u4ef6\u53d8\u5f62\u4e00\u4e0b\u5c31\u5f88\u7b80\u5355\u4e86\n\n$\\boxed{d[i]-i>=d[j]-j}$\n\n\u600e\u4e48\u6837\uff0c\u662f\u4e0d\u662f\u5f88\u795e\u5947\uff1f\n\n\u6240\u4ee5\u6211\u4eec\u6700\u540e\u53ea\u9700\u8981\u628ad[i]\u6620\u5c04\u6210d[i]-i\u5c31\u884c\u4e86\uff0c\u6700\u540e\u518d\u6c42**\u6700\u957f\u4e0d\u964d\u5b50\u5e8f\u5217**(\u4e0d\u662fLIS!!!)\n\n\u603b\u7ed3\u4e00\u4e0b\uff0c\u603b\u5171\u5c31\u662f\u4ee5\u4e0b\u51e0\u6b65\n```\n1.\u8bfb\u5165\u3001\u5efa\u6811\n2.\u4e2d\u5e8f\u904d\u5386\uff0c\u83b7\u5f97\u5e8f\u5217\n3.\u6620\u5c04\u5e76\u6c42\u89e3\n```\n\n> ## \u4ee3\u7801\n### $\\color{red}{FBI}$&nbsp;&nbsp;&nbsp;&nbsp;$\\color{red}{WARNING}$\n### \u5982\u679c\u4f60\u4ecd\u672a\u638c\u63e1\u6b64\u9898\uff0c\u8bf7\u4e0d\u8981\u89c2\u770b\u4ee3\u7801\u90e8\u5206\uff0c\u9664\u975e\u662f\u90e8\u5206\u7ec6\u8282\u4e0d\u7406\u89e3\n\n```cpp\n#include <cctype>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <algorithm>\n#define N 100001\n#define rnt register int\nusing namespace std;\nint n,x,y,cnt,len,d[N],dp[N];\nstruct node{int val,ch[2],fa;}tree[N];\ninline char my_getchar(){\n    static char buf[2048];\n    static int size=0,pos=0;\n    if(size==pos){\n        pos=0;\n        size=fread(buf,1,2048,stdin);\n        if(!size) return EOF;\n        else return buf[pos++];\n    }\n    else return buf[pos++];\n}\ninline int FR(){//fast_read\n    int ans=0,fh=0;\n    char c=my_getchar();\n    while(!isdigit(c)){\n        fh|=c=='-';\n        c=my_getchar();\n    }\n    while(isdigit(c)) ans=(ans<<1)+(ans<<3)+(c^48),c=my_getchar();\n    return fh?-ans:ans;\n}\ninline void init(){\n\tn=FR();memset(dp,0x3f,sizeof(dp));d[0]=-0x3fffffff;dp[0]=0;\n\tfor(rnt i=1;i<=n;i=-~i) tree[i].val=FR();\n\tfor(rnt i=2;i<=n;i=-~i){\n\t\tx=FR(),y=FR();\n\t\ttree[i].fa=x;\n\t\ttree[x].ch[y]=i;\n\t}\n}\nvoid inorder_traversal(int x){\n    if(tree[x].ch[0]) inorder_traversal(tree[x].ch[0]);\n    d[++cnt]=tree[x].val;\n    if(tree[x].ch[1]) inorder_traversal(tree[x].ch[1]);\n}\ninline void solve(){\n\tfor(rnt i=1;i<=n;i=-~i) d[i]-=i;\n\tdp[1]=d[1];len=1;\n\tfor(rnt i=2;i<=n;i=-~i){\n\t\tif(d[i]>=dp[len]) dp[++len]=d[i];\n\t\telse *upper_bound(dp+1,dp+len+1,d[i])=d[i];\n\t}\n\tprintf(\"%d\",n-len);\n}\nint main(){\n\t/*1*/init();\n\t/*2*/inorder_traversal(1);\n\t/*3*/solve();\n\treturn 0;\n}\n```",
        "postTime": 1567573306,
        "uid": 118382,
        "name": "torque",
        "ccfLevel": 6,
        "title": "\u6539\u9020\u4e8c\u53c9\u6811"
    },
    {
        "content": "### \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u9897\u6811\uff0c\u6bcf\u6b21\u64cd\u505a\u53ef\u4ee5\u4fee\u6539\u4e00\u4e2a\u70b9\u7684\u6743\u503c\uff0c\u6c42\u6700\u5c11\u51e0\u6b65\u53ef\u4ee5\u53d8\u6210\u4e8c\u53c9\u641c\u7d22\u6811\uff08\u53ca\u6bcf\u4e2a\u5de6\u8fb9\u513f\u5b50\u7684\u6743\u503c\u90fd\u5c0f\u4e8e\u4e2d\u95f4\u513f\u5b50,\u6bcf\u4e2a\u53f3\u8fb9\u513f\u5b50\u90fd\u5927\u4e8e\u4e2d\u95f4\u513f\u5b50\uff09\n\n### \u601d\u8def\n\n\u7531\u4e8e\u9898\u76ee\u8981\u6c42\u8981\u53d8\u6210\u4e8c\u53c9\u641c\u7d22\u6811\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\uff1a\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u4e2d\u6839\u904d\u5386\u662f\u4e25\u683c\u4e0a\u5347\u7684\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u6c42\u5176\u4e2d\u5e8f\u904d\u5386\uff0c\u518d\u6c42\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\n\n\u4f46\u662f\u8fd9\u4e2a\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u662f\u6709\u9650\u5236\u7684\uff0c\u8bbe\u6211\u4eec\u8bbe $dp_i$ \u8868\u793a\u524d $i$ \u4e2a\u6570\u91cc\u6700\u591a\u6709\u591a\u5c11\u4e2a\u6570\u662f\u4e0d\u7528\u4fee\u6539\u5c31\u80fd\u6ee1\u8db3\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u3002\u4e3a\u4e86\u6ee1\u8db3\u4ed6\u4eec\u95f4\u7684\u90e8\u5206\u80fd\u653e\u5f97\u4e0b\u90a3\u4e9b\u4e2d\u95f4\u7684\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u6ee1\u8db3\u4ee5\u4e0b\u5f0f\u5b50\uff1a $a_i-a_j>=i-j$ \n\n\u63a5\u4e0b\u6765\u6211\u4eec\u4fbf\u53ef\u5f97\u5230\u4ee5\u4e0b\u5f0f\u5b50\uff1a $dp_i=\\max(dp_j+1)[a_i-a_j>=i-j]$ ,\u4e5f\u5c31\u53ef\u4ee5\u5316\u4e3a $dp_i=\\max(dp_j+1)[a_i-i>=a_j-j]$ \u3002\u90a3\u4e5f\u5c31\u662f\u628a\u6240\u6709\u7684\u6570\u90fd\u51cf\u6389\u4e0b\u6807\u4e4b\u540e\uff08\u5373\u5f0f\u5b50\u4e2d\u7684 $a_i-i$ \u548c $a_j-j$ \uff09\u518d\u6c42\u4e00\u4e2a\u6700\u957f\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\uff0c\u6700\u540e\u62ff $n$ \u51cf\u53bb\u8fd9\u4e2a\u957f\u5ea6 $len$ \u5c31\u597d\u4e86\uff08\u7b49\u91cf\u5173\u7cfb\u4e3a\uff1a\u603b\u6570 $-$ \u4e0d\u8981\u4fee\u6539\u7684\u6570\u7684\u4e2a\u6570 $=$ \u8981\u4fee\u6539\u7684\u4e2a\u6570\uff09\n\n### \u8bc1\u660e\n\n\u8fd9\u91cc\u8fdb\u884c\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217 $O(nlogn)$ \u89e3\u6cd5\u7684\u8bc1\u660e\uff08\u5982\u679c\u4e0d\u7406\u89e3\u4ee3\u7801\u53ef\u4ee5\u6765\u770b\u6b64\u8bc1\u660e\uff09\u3002\u81f3\u4e8e\u53ef\u4ee5\u8bc1\u660e\u4ec0\u4e48\uff0c\u5176\u4ed6\u5730\u65b9\u597d\u7406\u89e3\uff0c\u5c31\u8bc1\u660e\u4ee3\u7801\u91cc\u7684 $val$ \u6570\u7ec4\u600e\u4e48\u4fdd\u8bc1\u6709\u5e8f\u3002\u6211\u4eec\u5047\u8bbe\u5148\u524d\u7684 $val$ \u6570\u7ec4\u662f\u6709\u5e8f\u7684\uff0c\u90a3\u6211\u4eec\u7684\u957f\u5ea6 $len$ \u5982\u679c\u8981\u53d8\u5927\uff0c\u90a3 $find$ \u51fd\u6570\u5c31\u5fc5\u987b\u8fd4\u56de\u5148\u524d\u7684\u6700\u5927\u503c\uff08\u5373 $len$ \u53d8\u91cf\uff09\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4fdd\u8bc1\uff0c\u6240\u6709\u7684 $val$ \u6570\u7ec4\u91cc\u7684\u5143\u7d20\u90fd\u5c0f\u4e8e\u7b49\u4e8e\u5f53\u524d\u6570\uff0c\u90a3\u4e48\u5728\u66f4\u65b0\u65b0\u7684 $val[dp[i]]$ \u4e5f\u5c31\u662f $val[len+1]$ \u65f6\uff0c\u5c31\u80fd\u4fdd\u8bc1\u524d\u9762\u7684 $val$ \u6570\u7ec4\u7684\u6570\u90fd\u5c0f\u4e8e\u5f53\u524d\u7684\u6570\u4e86\u3002\n\n### \u65f6\u95f4\u590d\u6742\u5ea6\n\n\u65f6\u95f4\uff1a\u4e2d\u5e8f\u904d\u5386\u4e3a $O(n)$ \uff0c\u6c42\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u4e3a $O(n \\log n)$ \uff0c\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684\u904d\u5386\u6570\u7ec4\u4e3a $O(n)$ \uff0c\u4e8c\u5206\u4e3a $O(\\log n)$ \uff0c\u603b\u4e3a $O(n \\times \\log n)=O(n \\log n)$ \u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N=1e5+10;\nint n,a[N],son[N][2],val[N],c[N],dp[N],tot,ll;\nvoid dfs(int x){\n\tif(son[x][0])dfs(son[x][0]);\n\tc[++tot]=a[x];\n\tif(son[x][1])dfs(son[x][1]);\n}\nint find(int x){\n\tint l=1,r=ll,ans=0;\n\twhile(l<=r){\n\t\tint mid=(l+r)/2;\n\t\tif(val[mid]<=x) l=mid+1,ans=mid;\n\t\telse r=mid-1;\n\t}\n\treturn ans;\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;i++)\n        scanf(\"%d\",&a[i]);\n    for(int i=2,fa,lr;i<=n;i++){\n    \tscanf(\"%d%d\",&fa,&lr);\n    \tson[fa][lr]=i;\n\t}\n\tdfs(1);\n\tfor(int i=1;i<=n;i++)\n\t\tc[i]-=i;\n\tfor(int i=1;i<=n;i++){\n\t\tdp[i]=find(c[i])+1;\n\t\tll=max(ll,dp[i]);\n\t\tval[dp[i]]=c[i];\n\t}\n\tcout<<n-ll<<endl;\n    return 0;\n}\n```",
        "postTime": 1655530663,
        "uid": 341946,
        "name": "zac2010",
        "ccfLevel": 7,
        "title": "P3365 \u6539\u9020\u4e8c\u53c9\u6811 \u9898\u89e3"
    },
    {
        "content": "# \u9898\u610f\n\u6c42\u4f7f\u4e00\u4e2a\u4e8c\u53c9\u6811\u901a\u8fc7\u4fee\u6539\u70b9\u6743\u7684\u65b9\u5f0f\u6210\u4e3a\u4e8c\u53c9\u641c\u7d22\uff08\u6392\u5e8f\uff09\u6811\u7684\u6700\u5c11\u4fee\u6539\u6b21\u6570\u3002\n\n\u4e8c\u53c9\u641c\u7d22\u6811\u6307\u5bf9\u4e8e\u4efb\u610f\u8282\u70b9 $u$ \u4ee5\u53ca\u5176\u5de6\u53f3\u513f\u5b50 $v_1,v_2$\uff0c\u6ee1\u8db3 $val(v_1)<val(u)<val(v_2)$\u3002\n\n\u5bf9\u5e73\u8861\u6811\u6709\u4e00\u5b9a\u4e86\u89e3\u7684\u8bdd\uff0c\u5c31\u77e5\u9053\u5e73\u8861\u6811\u5b9e\u9645\u662f\u5728\u7ef4\u62a4\u4e00\u4e2a**\u4e2d\u5e8f\u904d\u5386**\u4e0d\u53d8\u7684\uff0c\u6df1\u5ea6\u63a5\u8fd1 $\\log n$ \u7684\u4e8c\u53c9\u641c\u7d22\u6811\u3002\n\n# \u5206\u6790\n\u56e0\u6b64\uff0c\u672c\u9898\u8981\u6c42\u7684\u662f\uff0c\u4e00\u4e2a\u6570\u5217 $A$ (\u6307\u8fd9\u68f5\u4e8c\u53c9\u6811\u7684\u4e2d\u5e8f\u904d\u5386\uff09\uff0c\u4fee\u6539\u6210\u4e00\u4e2a\u5355\u8c03\u4e0a\u5347\u5e8f\u5217\u7684\u6700\u5c11\u6b21\u6570\u3002\n\n\u663e\u7136\u76f4\u63a5\u6c42 $\\operatorname{LIS}$ \u518d\u8fdb\u884c\u4e00\u7cfb\u5217\u64cd\u4f5c\u65f6\u9519\u8bef\u7684\uff0c\u4f8b\u5982 $A=\\{3,5,4\\}$ \u65f6\uff0c\u663e\u7136\u4e0d\u80fd\u53ea\u4fee\u6539 $5$\u3002\u62bd\u8c61\u7684\u8bb2\uff0c\u5c31\u662f\u6620\u5c04\u6210\u7684 $A$ \u6570\u5217\u7684\u6bcf\u4e2a\u533a\u95f4\u4e0d\u4fdd\u8bc1\u503c\u57df\u5927\u4e8e\u7b49\u4e8e\u5b9a\u4e49\u57df\u3002\n\n\u8bbe $f_i$ \u8868\u793a\u524d $i$ \u4f4d\u65e0\u9700\u6539\u53d8\u7684\u6570\u91cf\uff0c\u53d1\u73b0\u5f53\u4e14\u4ec5\u5f53 $ val_i-val_j\\ge i-j$ \u65f6\uff0c$f_i$ \u53ef\u4ee5\u7531 $f_j$ \u8f6c\u79fb\u3002\n\n\u628a\u8fd9\u4e2a\u6761\u4ef6\u79fb\u9879\uff0c\u5c31\u6709 $val_i-i\\ge val_j-j$\uff0c\u4e8e\u662f\u5904\u7406\u51fa\u4e00\u4e2a\u6570\u7ec4\u8868\u793a $val_i-i$\uff0c\u56e0\u4e3a\u8f6c\u79fb\u6b21\u6570\u7b49\u4e8e\u6700\u540e\u7684\u7ed3\u679c\uff0c\u6240\u4ee5\u8981\u8fd9\u4e2a\u8f6c\u79fb\u6b21\u6570\u6700\u5927\uff0c\u4e5f\u5c31\u662f\u8fd9\u4e2a\u6570\u7ec4\u7684\u6700\u957f\u4e0d\u964d\u5b50\u5e8f\u5217\uff0c\u5f53\u7136\u4e0d\u8981\u5fd8\u4e86\u7ed3\u679c\u7528 $n$ \u51cf\u53bb\u3002\n\n# \u5b9e\u73b0\n\u8fd9\u91cc\u4e0d\u80fd\u7528\u6734\u7d20\u7684\u6c42 $\\operatorname{LIS}$\uff0c\u9700\u8981\u5e26\u4e8c\u5206\u7684 $O(n\\log n)$ \u7b97\u6cd5\uff08\u7528 $\\operatorname{STL}$ \u4e2d\u81ea\u5e26\u7684\u67e5\u627e\u4e5f\u53ef\uff09\u3002\n```cpp\nint n,len;\nint val[maxn],a[maxn],tot;\nint tr[maxn][2];\ninline void dfs(int u){\n\tif(tr[u][0]) dfs(tr[u][0]);\n\ta[++tot]=val[u];\n\tif(tr[u][1]) dfs(tr[u][1]);\n}\nint f[maxn],g[maxn];\ninline int get(int x){\n\tint l=1,r=len;\n\tint res=0;\n\twhile(l<=r){\n\t\tint mid=(l+r)>>1;\n\t\tif(g[mid]<=x){\n\t\t\tres=mid;\n\t\t\tl=mid+1;\n\t\t}\n\t\telse{\n\t\t\tr=mid-1;\n\t\t}\n\t}\n\treturn res;\n}\nint main(){\n\tn=read();\n\tfor(int i=1;i<=n;i++){\n\t\tval[i]=read();\n\t}\n\tfor(int i=2;i<=n;i++){\n\t\tint fa=read(),ch=read();\n\t\ttr[fa][ch]=i;\n\t}\n\tdfs(1);\n\tfor(int i=1;i<=n;i++){\n\t\ta[i]-=i;\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tf[i]=get(a[i])+1;\n\t\tg[f[i]]=a[i];\n\t\tlen=max(len,f[i]);\n\t}\n\tprintf(\"%d\\n\",n-len);\n\treturn 0;\n}\n```",
        "postTime": 1644288921,
        "uid": 321177,
        "name": "SoyTony",
        "ccfLevel": 6,
        "title": "\u9898\u89e3\u2014\u2014P3365 \u6539\u9020\u4e8c\u53c9\u6811"
    },
    {
        "content": "\u641c\u7d22\u4e8c\u53c9\u6811\u7684\u4e2d\u5e8f\u904d\u5386\u662f\u4e00\u4e2a**\u5b8c\u7f8e\u7684**\u4e0a\u5347\u5e8f\u5217\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u540c\u6837\u7684\u65b9\u6253\u5370\u51fa\u9898\u4e2d\u4e8c\u53c9\u6811\u7684\u751f\u6210\u6570\u7ec4\uff08\u8fd9\u4e1c\u897f\u521d\u8d5b\u5c31\u5b66\u4e86\u5427\u3002\uff09\n\n\u90a3\u4e48\u95ee\u9898\u5c31\u8f6c\u6210\u4e86\uff1a\u7ed9\u51fa\u4e00\u4e2a\u6574\u6570\u5e8f\u5217\uff0c\u95ee\u591a\u5c11\u6b21\u4fee\u6539\u80fd\u4f7f\u5f97\u8be5\u5e8f\u5217\u6210\u4e3a\u4e00\u4e2a\u6700\u957f\u4e0a\u5347\u5e8f\u5217\uff0c\u8fd9\u662f\u4e00\u4e2a\u5341\u5206\u7ecf\u5178\u7684 dp \u3002\n\n\u8003\u8651\u6c42\u51fa\u6709\u591a\u5c11\u4e2a\u4e0d\u7528\u6539\uff0c\u8bbe\u4e0d\u7528\u4fee\u6539\u7684\u5750\u6807\u4e3a $b_1, b_2..., b_m$\uff0c\u5219\u6211\u4eec\u5e94\u6ee1\u8db3\u8fd9\u4e0b\u9762\u4e24\u4e2a\u67ff\u5b50\uff1a\n\n$$a_{b_1}<a_{b_2}<...<a_{b_m}$$\n\n\u539f\u610f\u5982\u6b64\uff0c\u4e0d\u518d\u89e3\u91ca\u3002\n\n$$\\text{\u5bf9\u4e8e} \\forall i<m, \\text{\u6ee1\u8db3} a_{b_{i+1}}-a_{b_i} \\ge b_{i+1}-b_i$$\n\n\u79fb\u9879\u540e\u5f97 \n\n$$ a_{b_{i+1}}-b_{i+1} \\ge a_{b_i}-b_i $$\n\n\u4ee4 $c_i=a_i-i$ \u5f97\n\n$$c_{b_{i+1}} \\ge c_{b_i}$$\n\n\u8fd9\u6070\u597d\u662f\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\u7684\u5b9a\u4e49\u3002\n\n\u800c\u6211\u4eec\u5bf9\u4e8e\u6700\u957f\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\u7684\u6c42\u6cd5\uff0c\u5df2\u7ecf\u6709 $O(nlogn)$ \u7684\u89e3\u6cd5\uff0c\u81f3\u6b64\uff0c\u672c\u9898\u5f97\u5230\u5b8c\u7f8e\u89e3\u51b3\u3002\n\n### Code\n\n```cpp\n#include <stdio.h>\n#include <algorithm>\n#include <vector>\n#define N 100005\nusing namespace std;\ninline int read(){\n\tchar ch;int x=0, f=1;ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-') f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\n\treturn x*f;\n}\nint G[N][2];\nint tot, n, s[N], a[N];\nvoid dfs(int pos){\n\tif(!pos) return ;\n\tdfs(G[pos][0]);\n\ta[++tot]=s[pos];\n\tdfs(G[pos][1]);\n}\nint d[N];\nint main(){\n\tn=read();\n\tfor(int i=1; i<=n; i++) s[i]=read();\n\tfor(int i=2; i<=n; i++) G[read()][read()]=i;\n\tdfs(1);\n\tfor(int i=1; i<=n; i++) a[i]-=i;\n\tint len=1;d[1]=a[1];\n\tfor(int i=2, j; i<=n; i++){\n\t\tif(a[i]>=d[len]) d[++len]=a[i];\n\t\telse\n\t\t\tj=(upper_bound(d+1, d+len+1, a[i])-d), d[j]=min(d[j], a[i]);\n\t}\n\tprintf(\"%d\", n-len);\n\treturn 0;\n}\n```\n",
        "postTime": 1617873212,
        "uid": 341102,
        "name": "ReKoJ",
        "ccfLevel": 0,
        "title": "[\u968f\u673a\u9898\u76ee\u8bb0\u60f3 1] P3365"
    },
    {
        "content": "\u9996\u5148\u6211\u4eec\u624b\u819c\u4e00\u904d\u53ef\u4ee5\u53d1\u73b0\uff0c\u6811\u7684\u7ed3\u6784\u4e0e\u7b54\u6848\u65e0\u5173\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u904d\u5386\u51fa\u4e00\u4e2a\u6570\u7ec4\u6765\u7b97\u3002\u770b\u4e86\u770b\u9898\u9762\uff0c\u53d1\u73b0\u5b83\u8981\u6c42\u7684\u662f\u4e2d\u5e8f\u904d\u5386\uff08\u4e8c\u53c9\u6392\u5e8f\u6811\u597d\u8bc4\uff09\u3002\n\n\u7136\u540e\u6211\u4eec\u4e2d\u5e8f\u904d\u5386\uff1a\n\n```cpp\nstruct node{\n\tint c[2],val;\t\t//\u4e24\u4e2a\u513f\u5b50\u548c\u81ea\u5df1\u7684\u503c\n}a[100010];\nstruct nd{\n\tint val,num,z;\n\tbool operator < (nd x)const{\n\t\treturn val<x.val;\n\t}\n}b[100010];\ninline void dfs(int now)\n{\n\tif(a[now].c[0]!=0)dfs(a[now].c[0]);\n\tb[++len].val=a[now].val;\n\tb[len].num=len;\t\t//\u8bb0\u5f55\u7f16\u53f7\uff0c\u540e\u9762\u6709\u7528\n\tif(a[now].c[1]!=0)dfs(a[now].c[1]);\n}\n```\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u5f97\u5230b\u6570\u7ec4\uff0c\u53d1\u73b0\u662f\u6c42\u6700\u5c0f\u4fee\u6539\u6b21\u6570\u4f7f\u5e8f\u5217\u5347\u5e8f\uff0c\u90a3\u5c31\u662fn-\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u957f\uff1f\n\n\u6211\u4e0d\u4f1a\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\uff0c\u4e8e\u662f\u624b\u819c\u5427\u3002\n\n\u79bb\u6563+\u7ebf\u6bb5\u6811\u8d70\u8d77\u6765\uff0c\u8be6\u89c1\u4ee3\u7801\uff1a\n\n```\n//\u849f\u84bb\u7684\u505a\u6cd5\ninline int maxs(int a,int b)\n{\n\treturn a>b?a:b;\n}\nint c[400010];\ninline void pt(int now,int l,int r,int lr,int xt)\n{\n\tif(l==r){\n\t\tc[now]=maxs(c[now],xt);\n\t\treturn;\n\t}\n\tint lc=now<<1,md=l+r>>1;\n\tif(lr<=md)pt(lc,l,md,lr,xt);\n\telse pt(lc+1,md+1,r,lr,xt);\n\tc[now]=maxs(c[lc],c[lc+1]);\n}\ninline int gt(int now,int l,int r,int ll,int rr)\n{\n\tif(rr<ll)return 0;\n\tif(l==ll&&r==rr)return c[now];\n\tint lc=now<<1,md=l+r>>1;\n\tif(rr<=md)return gt(lc,l,md,ll,rr);\n\tif(md<ll)return gt(lc+1,md+1,r,ll,rr);\n\treturn maxs(gt(lc,l,md,ll,md),gt(lc+1,md+1,r,md+1,rr));\n}\n//...\nstruct nd{\n\tint val,num,z;\n\tbool operator < (nd x)const{\n\t\treturn val<x.val;\n\t}\n}b[100010];\nint d[100010];\n//...\nint main()\n{\n    //...\n\tsort(b+1,b+1+n);\t\t//\u8bb0\u5f97\u8c03\u7528algorithm\n\tb[1].z=u1=1;\n\tfor(i=2;i<=n;i++)\n\t{\n\t\tif(b[i].val!=b[i-1].val)u1++;\n\t\tb[i].z=u1;\n\t}\n\tfor(i=1;i<=n;i++)\n\td[b[i].num]=b[i].z;\n    //\u4e8e\u662f\u6211\u4eec\u628a\u79bb\u6563\u540e\u7684\u503c\u5b58\u5728\u4e86d\u91cc\uff0c\u6700\u5927\u503c\u4e3au1\n    for(i=1;i<=n;i++)\n\t{\n\t\tu2=gt(1,1,u1,1,d[i]-1)+1;\t//\u5f97\u5230\u6bd4d[i]\u5c0f\u7684\u503c\u4e2d \u5df2\u6709\u5e8f\u5217\u957f\u5ea6\u6700\u957f \u7684\u503c\n       \t//\u7136\u540e\u52a0\u4e0a\u81ea\u5df1\u76841\n\t\tif(ans<u2)ans=u2;\n\t\tpt(1,1,u1,d[i],u2);\t\t\t//\u66f4\u65b0ans\uff0c\u628a\u81ea\u5df1\u653e\u8fdb\u7ebf\u6bb5\u6811\u91cc\n\t}\n    //...\n```\n\n\u7136\u540e\u6211\u4eec\u628a\u4ee3\u7801\u641e\u51fa\u6765\u662f\u957f\u8fd9\u6837\u7684\uff1a\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\ninline int maxs(int a,int b)\n{\n\treturn a>b?a:b;\n}\nint c[400010];\ninline void pt(int now,int l,int r,int lr,int xt)\n{\n\tif(l==r){\n\t\tc[now]=maxs(c[now],xt);\n\t\treturn;\n\t}\n\tint lc=now<<1,md=l+r>>1;\n\tif(lr<=md)pt(lc,l,md,lr,xt);\n\telse pt(lc+1,md+1,r,lr,xt);\n\tc[now]=maxs(c[lc],c[lc+1]);\n}\ninline int gt(int now,int l,int r,int ll,int rr)\n{\n\tif(rr<ll)return 0;\n\tif(l==ll&&r==rr)return c[now];\n\tint lc=now<<1,md=l+r>>1;\n\tif(rr<=md)return gt(lc,l,md,ll,rr);\n\tif(md<ll)return gt(lc+1,md+1,r,ll,rr);\n\treturn maxs(gt(lc,l,md,ll,md),gt(lc+1,md+1,r,md+1,rr));\n}\nstruct node{\n\tint c[2],val;\n}a[100010];\nstruct nd{\n\tint val,num,z;\n\tbool operator < (nd x)const{\n\t\treturn val<x.val;\n\t}\n}b[100010];\nint n,i,u1,u2,len,d[100010],ans;\ninline void dfs(int now)\n{\n\tif(a[now].c[0]!=0)dfs(a[now].c[0]);\n\tb[++len].val=a[now].val;\n\tb[len].num=len;\n\tif(a[now].c[1]!=0)dfs(a[now].c[1]);\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(i=1;i<=n;i++)scanf(\"%d\",&a[i].val);\n\tfor(i=2;i<=n;i++)\n\t{\n\t\tscanf(\"%d%d\",&u1,&u2);\n\t\ta[u1].c[u2]=i;\n\t}\n\tdfs(1);\n\tsort(b+1,b+1+n);\n\tb[1].z=u1=1;\n\tfor(i=2;i<=n;i++)\n\t{\n\t\tif(b[i].val!=b[i-1].val)u1++;\n\t\tb[i].z=u1;\n\t}\n\tfor(i=1;i<=n;i++)\n\td[b[i].num]=b[i].z;\n\tfor(i=1;i<=n;i++)\n\t{\n\t\tu2=gt(1,1,u1,1,d[i]-1)+1;\n\t\tif(ans<u2)ans=u2;\n\t\tpt(1,1,u1,d[i],u2);\n\t}\n\tprintf(\"%d\",n-ans);\n\treturn 0;\n}\n```\n\n\u81ea\u4fe1\u63d0\u4ea4\uff0c\u53d1\u73b0WA\u4e86\u3002\n\n\u6211\u4eec\u770b\u770b\u53d1\u751f\u4e86\u4ec0\u4e48\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6vfm6dsp.png)\n\n\u6211\u4eec\u53d1\u73b0\u90a3\u4e2a\u84dd\u5708\u91cc\u76843\u65e0\u6cd5\u901a\u8fc71\u6b21\u4fee\u6539\u4f7f\u81ea\u5df1\u80fd\u591f\u653e\u57283\u548c4\u4e2d\u95f4\u3002\n\n\u601d\u8003\u826f\u4e45\uff0c\u53d1\u73b0\u6211\u628a\u6bcf\u4e00\u4e2a\u503c\u90fd\u51cf\u53bb\u81ea\u5df1\u7684\u4e0b\u6807\uff0c\u7136\u540e\u518d\u7b97\u6700\u957f\u4e0d\u964d\u5b50\u5e8f\u5217\u597d\u50cf\u5c31\u53ef\u4ee5\u4e86\uff0c\u8bb0\u5f97\u8981\u5728\u79bb\u6563\u524d\u51cf\u54e6\u3002\n\nP.S.:\u6211\u628a\u6700\u957f\u4e0d\u964d\u5b50\u5e8f\u5217\u6539\u6210\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u4e5fAC\u4e86\uff0c\u8fd9\u662f\u4e3a\u4ec0\u4e48\uff1f\uff08\u6570\u636e\u592a\u6c34\uff1f\uff09\n\n\u9644\u4e0a\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\ninline int maxs(int a,int b)\n{\n\treturn a>b?a:b;\n}\nint c[400010];\ninline void pt(int now,int l,int r,int lr,int xt)\n{\n\tif(l==r){\n\t\tc[now]=maxs(c[now],xt);\n\t\treturn;\n\t}\n\tint lc=now<<1,md=l+r>>1;\n\tif(lr<=md)pt(lc,l,md,lr,xt);\n\telse pt(lc+1,md+1,r,lr,xt);\n\tc[now]=maxs(c[lc],c[lc+1]);\n}\ninline int gt(int now,int l,int r,int ll,int rr)\n{\n\tif(rr<ll)return 0;\n\tif(l==ll&&r==rr)return c[now];\n\tint lc=now<<1,md=l+r>>1;\n\tif(rr<=md)return gt(lc,l,md,ll,rr);\n\tif(md<ll)return gt(lc+1,md+1,r,ll,rr);\n\treturn maxs(gt(lc,l,md,ll,md),gt(lc+1,md+1,r,md+1,rr));\n}\nstruct node{\n\tint c[2],val;\n}a[100010];\nstruct nd{\n\tint val,num,z;\n\tbool operator < (nd x)const{\n\t\treturn val<x.val;\n\t}\n}b[100010];\nint n,i,u1,u2,len,d[100010],ans;\ninline void dfs(int now)\n{\n\tif(a[now].c[0]!=0)dfs(a[now].c[0]);\n\tb[++len].val=a[now].val-len;\n\tb[len].num=len;\n\tif(a[now].c[1]!=0)dfs(a[now].c[1]);\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(i=1;i<=n;i++)scanf(\"%d\",&a[i].val);\n\tfor(i=2;i<=n;i++)\n\t{\n\t\tscanf(\"%d%d\",&u1,&u2);\n\t\ta[u1].c[u2]=i;\n\t}\n\tdfs(1);\n\tsort(b+1,b+1+n);\n\tb[1].z=u1=1;\n\tfor(i=2;i<=n;i++)\n\t{\n\t\tif(b[i].val!=b[i-1].val)u1++;\n\t\tb[i].z=u1;\n\t}\n\tfor(i=1;i<=n;i++)\n\td[b[i].num]=b[i].z;\n\tfor(i=1;i<=n;i++)\n\t{\n\t\tu2=gt(1,1,u1,1,d[i])+1;\n\t\tif(ans<u2)ans=u2;\n\t\tpt(1,1,u1,d[i],u2);\n\t}\n\tprintf(\"%d\",n-ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1575703419,
        "uid": 90473,
        "name": "abc123_abc123",
        "ccfLevel": 7,
        "title": "P3365 \u3010\u6539\u9020\u4e8c\u53c9\u6811\u3011"
    },
    {
        "content": "```\n20191013\u4fee\u6539\uff1a\u4e2a\u4eba\u535a\u5ba2\u7f51\u5740\u53d8\u66f4\n```\n\n\n\u540c\u6837\u6b22\u8fce\u6765\u5230[\u6211\u7684\u4e2a\u4eba\u535a\u5ba2\u67e5\u770b](https://officerbonin.home.blog/2019/08/19/%e3%80%90%e4%bf%a1%e7%ab%9e%e3%80%91luogup3365-%e6%94%b9%e9%80%a0%e4%ba%8c%e5%8f%89%e6%a0%91/)\n\n\u672c\u9898\u88ab\u6559\u7ec3\u9009\u4f5c\u4e86\u6a21\u62df\u8d5b\u7684\u7b2c\u4e00\u9898\uff0c~~\u7ed3\u679c\u6211\u53bb\u6b7b\u78d5\u6811\u5f62DP,\u5657....~~\n\n\u8003\u540e[\u4e00\u4f4d\u5927\u4f6c](https://www.luogu.org/space/show?uid=88268)\u7ed9\u6211\u8bb2\u4e86\u672c\u9898\u7684\u89e3\u6cd5\u3002\n\n\u601d\u60f3\u7b49\u540c\u4e8e\u672c\u9898[\u5f20\u4ea6\u5f1b\u7ed9\u51fa\u7684\u9898\u89e3](https://www.luogu.org/blog/1557114139--com/solution-p3365)\u3002\n\n\u6211\u53d1\u8fd9\u7bc7\u9898\u89e3\uff0c\u56e0\u4e3a\u6211\u4f7f\u7528\u7684\u7ebf\u6bb5\u6811\u4f18\u5316\u7684\u65b9\u5f0f\uff0c\u4f46\u77a7\u89c1\u5176\u4ed6\u9898\u89e3\u90fd\u662f\u4e8c\u5206\u4f18\u5316\u7684\uff0c\u6ca1\u6709\u9898\u89e3\u7528\u8fd9\u4e2a\u65b9\u5f0f\u3002\n\n\u4fee\u6539\u540e\u4ea4\u9898\u89e3\u6ca1\u8fc7\uff0c\u90a3\u5c31\u52a0\u70b9\u89e3\u91ca\u5427\uff0c\u89c1\u4ee3\u7801.\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<climits>\n#include<cmath>\n#include<algorithm>\n#include<map>\n#include<vector>\n#define maxn 100005\nusing namespace std;\nint n;\nstruct node\n{\n\tint lc,rc,fa;\n} pot[maxn];\nint a[maxn],b[maxn];\nmap<int,int>yst;\nint qa[maxn],f[maxn];\n\nstruct segmenttree\n{\n\tint l,r;\n\tint data;\n} tr[100005*4];\n\nvoid zsbl(int now)//\u4e2d\u5e8f\u904d\u5386\n{\n//\tcout<<now<<endl;\n\tif(pot[now].lc)\n\t{\n\t\tzsbl(pot[now].lc);\n\t}\n//\tcout<<now;\n\tqa[++qa[0]]=a[now];\n\tif(pot[now].rc)\n\t{\n\t\tzsbl(pot[now].rc);\n\t}\n\treturn;\n}\n\nvoid build(int l,int r,int k)\n{\n\ttr[k].l=l;\n\ttr[k].r=r;\n\tif(l==r)\n\t{\n\t\ttr[k].data=0;\n\t\treturn;\n\t}\n\tint mid=(l+r)/2;\n\tbuild(l,mid,k*2);\n\tbuild(mid+1,r,k*2+1);\n}\nint ask(int l,int r,int k)\n{\n\tif(!r)return 0;\n\tif(l<=tr[k].l&&tr[k].r<=r)return tr[k].data;\n\tif(r<tr[k].l||tr[k].r<l)return 0;\n\treturn max(ask(l,r,k*2),ask(l,r,k*2+1));\n}\nvoid update(int x,int k,int id)\n{\n\tif(tr[k].l==tr[k].r)\n\t{\n\t\ttr[k].data=max(tr[k].data,id);\n\t\treturn;\n\t}\n\tint mid=(tr[k].l+tr[k].r)/2;\n\tif(x<=mid)update(x,k*2,id);\n\telse update(x,k*2+1,id);\n\ttr[k].data=max(tr[k*2].data,tr[k*2+1].data);\n}\n\nint main()\n{\n\tint n;\n\tcin>>n;\n\tfor(int i = 1; i <= n; i++)\n\t{\n\t\tscanf(\"%d\",&a[i]);\n\t}\n\tint x,y;\n\tfor(int i = 2; i <= n; i++)\n\t{\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tpot[i].fa=x;\n\t\tif(!y)\n\t\t\tpot[x].lc=i;\n\t\telse\n\t\t\tpot[x].rc=i;\n\t}\n\tzsbl(1);//\u4e2d\u5e8f\u904d\u5386\n\tfor(int i = 1; i <= n; i++)\n\t{\n\t\tqa[i]-=i;\n\t\tb[i]=qa[i];\n\t}\n\tsort(b+1,b+n+1);\n\tint cntb=unique(b+1,b+n+1)-b-1;\n\tfor(int i = 1; i <= cntb; i++)\n\t\tyst[b[i]]=i;\n\tfor(int i = 1; i <= n; i++)\n\t\tqa[i]=yst[qa[i]];\n//\u4e0a\u5934\u90fd\u5728\u8bfb\u5165\u548c\u79bb\u6563\u5316\n\tint maxx=0;\n\tbuild(1,n,1);\n/*\n\u6570\u7ec4qa\u662f\u4e8c\u53c9\u641c\u7d22\u6811\u4e2d\u5e8f\u904d\u5386\u5c55\u5f00\u5e76\u79bb\u6563\u5316\u540e\u5f97\u5230\u7684\u5e8f\u5217\uff0c\u4e0b\u7b80\u79f0q.\n\nf\u7684\u542b\u4e49\u7a0d\u6709\u4e0d\u540c\uff0cf[i]\u4e3a\u4ee5\u7b2cq[i]\u4e2a\u6570\u7ed3\u5c3e\uff0c\u524d\u5934\u90fd\u585e\u5c0f\u4e8e\u7b49\u4e8eq[i]\u7684\u6570\uff08\u4fdd\u8bc1\u5e8f\u5217\u5355\u8c03\u9012\u589e\uff09\u65f6\u6700\u591a\u80fd\u4fdd\u7559\u591a\u5c11\u4e2a\u6570\uff08\u5c31\u662f\u80fd\u6709\u591a\u5c11\u4e2a\u6570\u4e0d\u53d8\u3002\n\n\u6240\u4ee5,f[i]\u7684\u6700\u4f73\u503c\u5f53\u7136\u662f1~q[i]\u4e2d\u6700\u5927\u7684+1.\u5b9e\u73b0\u67e5\u627e\u533a\u95f4\u5185\u6700\u5927\u7684\u5e76\u8fdb\u884c\u5355\u70b9\u4fee\u6539\uff0c\u5f53\u7136\u7ebf\u6bb5\u6811\u5341\u5206\u597d\u7528\n*/\n\tfor(int it = 1; it <= n; it++)\n\t{\n\t\tf[it]=ask(1,qa[it],1)+1;\n\t\tupdate(qa[it],1,f[it]);\n\t\tmaxx=max(maxx,f[it]);\n\t}\n\tcout<<n-maxx;\n}\n\n```\n",
        "postTime": 1566117983,
        "uid": 170162,
        "name": "Boeing737_MAX_8",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3365 \u3010\u6539\u9020\u4e8c\u53c9\u6811\u3011"
    },
    {
        "content": "\u9898\u76ee\u6c42\u7684\u662f\u4e00\u9897\u4e8c\u53c9\u6811\u6539\u4e3a\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u6700\u5c11\u6b65\u9aa4\n\n\n\u56e0\u4e3a\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u4e2d\u5e8f\u904d\u5386\u4e00\u5b9a\u662f\u4e00\u4e2a\u7531\u5c0f\u5230\u5927\u7684\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\n\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u4e2d\u5e8f\u904d\u5386\u8fd9\u9897\u4e8c\u53c9\u6811\n\n\n\u5c06\u4ed6\u7684\u4e2d\u5e8f\u904d\u5386\u51fa\u7684\u7ed3\u70b9\u4f9d\u6b21\u653e\u5165\u4e00\u4e2a\u6570\u7ec4\n\n\n\u7136\u540e\u6c42\u4e00\u904d\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684\u957f\u5ea6\uff0c\u7528\u603b\u4e2a\u6570\u51cf\u53bb\u8fd9\u4e2a\u6ee1\u8db3\u8981\u6c42\u7684\u957f\u5ea6\uff0c\u5c31\u5f97\u5230\u4e86\u8981\u4fee\u6539\u7684\u70b9\u6570\n\n\n\u4f46\u662f\u7531\u4e8e\u9898\u76ee\u4e2d\u6574\u6570\u7684\u9650\u5236\uff0c\u6240\u4ee5\u6c42\u6700\u957f\u4e0d\u964d\u800c\u4e0d\u662f\u4e0a\u5347\n\n\n\u63d0\u4e00\u70b9\uff0c\u6700\u957f\u4e0d\u4e0b\u964d\u7528lower\u2014\u2014bound\n\n\u6700\u957f\u4e0a\u5347\u7528upper\u2014\u2014bound \n\n\u51cf\u7684\u662fd\u7684\u957f\u5ea6\u54e6\n\n\u6700\u540e\u5982\u679c\u6709\u7ae5\u978b\u4e0d\u4f1a\u6c42lis\uff08\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\uff09\uff0c\u7ed9\u4f60\u770b\u4e00\u4e2a\u5927\u795e\u535a\u5ba2\u54e6\uff0c\u4ed6\u8bb2\u7684\u5f88\u6e05\u695a\u3002\u4f60\u53ef\u4ee5\u5148\u770b\u4e86\uff0c\u624d\u77e5\u9053\u4e3a\u4ec0\u4e48\u540e\u9762\u7684\u90a3\u4e2afor\u5faa\u73af\u8981\u8fd9\u6837\u5199\u7684\u54e6\uff01\n\n[\u6c42\u6700\u957f\u4e0a\u5347\u3001\u4e0d\u964d\u5b50\u5e8f\u5217](https://www.cnblogs.com/itlqs/p/5743114.html)\n\n\u7f8e\u7f8e\u54d2\u4ee3\u7801\u9001\u7ed9\u4f60\uff0c\u8bf7\u63a5\u6536\uff01\n\n```cpp\n#include <iostream>\n#include <cstdio>\nconst int maxn=500100;\nusing namespace std;\nstruct NODE{\n\tint key,lc,rc;\n}node[maxn];\nint shuzu[maxn],d[maxn];\nint n,a,b,k;\nvoid midsearch(int u){\n\tif(node[u].lc)midsearch(node[u].lc);\n\t//\u8fd9\u4e00\u6b65\u662f\u4e3a\u4ec0\u4e48\uff1f\n\t//\u56e0\u4e3a\u5f53i\u5230j\u662f\u9012\u589e\uff0c\u4ed6\u4eec\u503c\u4e5f\u662f\u9012\u589e\u7684\u60c5\u51b5\u65f6\uff0c\u56e0\u4e3ai\u5230j\u7684\u503c\u5dee\u4e00\u5b9a\u8981\u5927\u4e8e\u7b49\u4e8ei\u5230j\u7684\u4e0b\u6807\u5dee\uff0c\u4e0d\u7136\u600e\u4e48\u9012\u589e\u554a\uff1f\u5373aj-ai>=j-i,\u5373aj-j>=ai-i\uff0c\n\t//\u8fd9\u6837\u6211\u4eec\u518d\u53bb\u6c42lis \n\tshuzu[++k]=node[u].key-k;//k\u662f\u70b9\u4f9d\u6b21\u8fdb\u5165\u6570\u7ec4\u7684\u7f16\u53f7\uff0c\u4e2d\u5e8f\u904d\u5386\u7684\u987a\u5e8f \n\tif(node[u].rc)midsearch(node[u].rc);\n}\nint main() {\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%d\",&node[i].key);\n\t}\n\tfor(int i=2;i<=n;i++){//\u5927\u5bb6\u8f93\u5165\u641e\u5bf9\u4e86\u561b\uff1f\u7b2c\u4e00\u4e2a\u6570\u662f\u8282\u70b9\uff0c\u540e\u4e00\u4e2a\u6570\u662f\u8bf4i\u662f\u4ed6\u7684\u4ec0\u4e48\u513f\u5b50\uff0c\u6240\u4ee5i\u4ece2\u5f00\u59cb\u597d\u4e9b \n\t\tscanf(\"%d%d\",&a,&b);\n\t\tif(b){\n\t\t\tnode[a].rc=i;\n\t\t}\n\t\telse node[a].lc=i;\n\t}\n\tmidsearch(1);\n\td[1]=shuzu[1];\n\tint len=1;\n\tfor(int i=2;i<=n;i++){\n\t\tif(shuzu[i]>=d[len]){\n\t\t\td[++len]=shuzu[i];\n\t\t}\n\t\telse{\n\t\t\tint j=lower_bound(d+1,d+1+len,shuzu[i])-d;//\u51cf\u53bbd\u7684\u957f\u5ea6\u4f60\u51cf\u4e86\u5417\uff1f \n\t\t\td[j]=shuzu[i]; \n\t\t}\n\t}\n\tprintf(\"%d\",n-len);\n\treturn 0;\n}\n```\n",
        "postTime": 1541088584,
        "uid": 119161,
        "name": "SSSF",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3365 \u3010\u6539\u9020\u4e8c\u53c9\u6811\u3011"
    },
    {
        "content": "[\u539f\u9898\u94fe\u63a5](https://www.luogu.com.cn/problem/P3365 \"\u539f\u9898\u94fe\u63a5\")\n\n## \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u9897\u4e8c\u53c9\u6811\uff0c\u6bcf\u6b21\u64cd\u4f5c\u53ef\u4ee5\u4fee\u6539\u4e00\u4e2a\u70b9\u7684\u6743\u503c\u4e3a\u4efb\u610f**\u6574\u6570**\uff0c\u6c42\u5c06\u539f\u6811\u53d8\u4e3a\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u6700\u5c0f\u64cd\u4f5c\u6b21\u6570\u3002\n\n\u6ce8\u610f\uff1a\u672c\u9898\u4e2d\u7684\u4e8c\u53c9\u641c\u7d22\u6811\u5b9a\u4e49\u4e3a\uff1a\u6bcf\u4e2a\u5de6\u8fb9\u513f\u5b50\u7684\u6743\u503c\u90fd**\u4e25\u683c\u5c0f\u4e8e**\u4e2d\u95f4\u513f\u5b50,\u6bcf\u4e2a\u53f3\u8fb9\u513f\u5b50\u7684\u6743\u503c\u90fd**\u4e25\u683c\u5927\u4e8e**\u4e2d\u95f4\u513f\u5b50\u3002\n\n$1 \\leq n \\leq 10^5$\u3002\n\n## \u601d\u8def\uff1a\n\n\u5728\u672c\u9898\u4e2d\uff0c\u4e00\u68f5\u4e8c\u53c9\u6811\u4e3a\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u5145\u8981\u6761\u4ef6\u4e3a\uff1a\u8be5\u4e8c\u53c9\u6811\u7684\u4e2d\u5e8f\u904d\u5386\u6743\u503c**\u4e25\u683c\u5355\u8c03\u9012\u589e**\u3002\n\n\u5148\u6c42\u51fa\u8fd9\u68f5\u6811\u7684\u4e2d\u5e8f\u904d\u5386\u3002\u7531\u4e8e\u70b9\u7684\u6743\u503c\u53ea\u80fd\u4fee\u6539\u4e3a\u6574\u6570\uff0c\u76f4\u63a5\u6c42 $\\mathrm{LIS} $ \u65e0\u6cd5\u89e3\u51b3\u6709\u8fde\u7eed\u82e5\u5e72\u4e2a\u76f8\u540c\u6574\u6570\u7684\u60c5\u51b5\u3002\n\n\u8bbe\u4e2d\u5e8f\u904d\u5386\u7684\u7b2c $i$ \u4e2a\u70b9\u6743\u503c\u4e3a $w_i$\u3002\u4ee4 $w_i \\longleftarrow w_i-i$\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5c06\u4e25\u683c\u5355\u8c03\u9012\u589e\u8f6c\u5316\u4e3a\u975e\u4e25\u683c\u5355\u8c03\u9012\u589e\uff0c\u4e8e\u662f\u6700\u7ec8\u7684\u7b54\u6848\u5c31\u662f $n-\\mathrm{LIS} (a)$\u3002\n\n## code\uff1a\n\n```\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nconst int N=1e5+10;\nint a[N],ch[N][2],q[N],tot,n,f[N],len;\nvoid dfs(int u)\n{\n\tif(!u) return ;dfs(ch[u][0]);tot++;q[tot]=a[u]-tot;dfs(ch[u][1]);\n}\nint main()\n{\n\tscanf(\"%d\",&n);for(int i=1;i<=n;i++) scanf(\"%d\",&a[i]);\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tint fa,op;scanf(\"%d%d\",&fa,&op);ch[fa][op]=i;\n\t}\n\tdfs(1);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(q[i]>f[len]) f[++len]=q[i];\n\t\telse\n\t\t{\n\t\t\tint k=upper_bound(f+1,f+len+1,q[i])-f;\n\t\t\tf[k]=q[i];\n\t\t}\n\t}\n\tprintf(\"%d\\n\",n-len);\n\treturn 0;\n}\n```",
        "postTime": 1678416200,
        "uid": 288192,
        "name": "ListenSnow",
        "ccfLevel": 7,
        "title": "P3365 \u6539\u9020\u4e8c\u53c9\u6811"
    },
    {
        "content": "## \u524d\u8a00\n\n[\u9898\u76ee\u4f20\u9001\u95e8\uff01](https://www.luogu.com.cn/problem/P3365)\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\uff1f](https://www.cnblogs.com/liangbowen/p/17083677.html)\n\n\u4e00\u9053\u4e2a\u4eba\u611f\u89c9\u975e\u5e38\u5999\u7684\u9898\u76ee\uff0c\u60f3\u4e86\u534a\u5929\u90fd\u60f3\u4e0d\u5230\uff0c\u4f46\u662f\u542c\u8001\u5e08\u4e00\u53e5\u8bdd\u5c31\u609f\u4e86\uff01\n\n## \u601d\u8def\n\n**\u672c\u9898\u5173\u952e\uff1a\u4e8c\u53c9\u641c\u7d22\u6811\uff0c\u7b49\u4ef7\u4e8e\u8fd9\u68f5\u6811\u4e2d\u5e8f\u904d\u5386\u4e0b** $a_i$ **\u5355\u8c03\u4e0d\u964d**\u3002\n\n\u90a3\u4e48\u8fd9\u9898\u4e0d\u5c31\u505a\u5b8c\u4e86\u5417\u3002\u9996\u5148\u8dd1\u4e2d\u5e8f\u904d\u5386\uff0c\u628a\u4e00\u6574\u4e2a $a_i$ \u6c42\u51fa\u6765\u3002\n\n\u7136\u540e\u7528\u4e00\u4e2a\u5e38\u89c1\u7684 trick\uff1a$a_i \\leftarrow a_i - i$ \u5c31\u80fd\u628a\u5355\u8c03\u4e0d\u964d\u8f6c\u5316\u4e3a\u4e25\u683c\u5355\u8c03\u4e0a\u5347\uff08$\\le$ \u53d8\u6210 $<$\uff09\u3002\n\n\u6700\u540e\u6839\u636e P3902 \u7684\u7ed3\u8bba\uff0c\u4fee\u6539\u7684\u6b21\u6570\u7b49\u4e8e $n - \\operatorname{LIS}(a)$\u3002\n\n\u6240\u4ee5\u76f4\u63a5\u4e0a $O(n \\log n)$ \u6c42 LIS \u7684\u6709\u5173\u7b97\u6cd5\u5373\u53ef\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <algorithm>\nusing namespace std;\nconst int N = 1e5 + 5;\nint val[N], l[N], r[N], a[N], cur;\nvoid dfs(int x) //\u6c42\u4e2d\u5e8f\u904d\u5386\n{\n\tif (!x) return;\n\tdfs(l[x]), cur++, a[cur] = val[x] - cur, dfs(r[x]);\n}\nint main()\n{\n\tint n;\n\tscanf(\"%d\", &n);\n\tfor (int i = 1; i <= n; i++) scanf(\"%d\", &val[i]);\n\tfor (int i = 2; i <= n; i++)\n\t{\n\t\tint fa, ch;\n\t\tscanf(\"%d%d\", &fa, &ch);\n\t\tif (!fa) continue;\n\t\tif (ch == 0) l[fa] = i; else r[fa] = i; //\u6309\u7167\u9898\u76ee\u602a\u5f02\u7684\u8bfb\u5165\u65b9\u5f0f\u5b58\u8fb9\n\t}\n\tdfs(1);\n\t\n\tvector <int> dp; //n log n \u6c42 LIS\n\tfor (int i = 1; i <= n; i++)\n\t\tif (i == 1) dp.push_back(a[i]);\n\t\telse\n\t\t{\n\t\t\tint pos = lower_bound(dp.begin(), dp.end(), a[i]) - dp.begin();\n\t\t\tif (pos >= (int)dp.size()) dp.push_back(a[i]); else dp[pos] = a[i];\n\t\t}\n\tcout << n - (int)dp.size(); //\u7b54\u6848\u5373\u4e3a n - LIS\n\treturn 0;\n}\n```",
        "postTime": 1675244628,
        "uid": 367488,
        "name": "liangbowen",
        "ccfLevel": 0,
        "title": "P3365 \u9898\u89e3"
    },
    {
        "content": "[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/P3365)\n\n# \u96f6.\u524d\u8bb0\n\u677f\u5b50\u5199\u4ec0\u4e48\u51fd\u6570\u540d\u9898\u76ee\u4e2d\u5c31\u5199\u4ec0\u4e48\u51fd\u6570\u540d\n\n~~\u4e00\u4e2a\u5c0f\u7ec6\u8282\u5199\u9519\u51fd\u6570\u540d\u5361\u4e86\u534a\u5c0f\u65f6\u5c31\u79bb\u8c31~~\n\n# \u4e00.\u5927\u4f53\u601d\u8def\n\u5927\u5bb6\u5bf9\u4e8c\u53c9\u67e5\u627e\u6811\u591a\u591a\u5c11\u5c11\u90fd\u6709\u6240\u4e86\u89e3\uff08\u6211\u662f\u5728\u5b66\u53ef\u5e76\u5806\u7684\u65f6\u5019\u5b66\u7684\n\n\u5176\u5b9e\u8bf4\u767d\u4e86\u5c31\u662f\u4e00\u4e2a\u70b9$i$\u6ee1\u8db3$:$\n\n$1.$\u5de6\u5b50\u6811\u4e0a\u6bcf\u4e2a\u70b9$j$\u90fd\u6ee1\u8db3$a_i>a_j$\n\n$2.$\u53f3\u5b50\u6811\u4e0a\u6bcf\u4e2a\u70b9$j$\u90fd\u6ee1\u8db3$a_i<a_j$\n\n\u56e0\u6b64\u53ef\u4ee5\u77e5\u9053\u4e00\u4e2a\u4e8c\u53c9\u67e5\u627e\u6811\u7684\u4e2d\u5e8f\u904d\u5386\u662f\u5355\u8c03\u9012\u589e\u7684\n\n\u6362\u8a00\u4e4b\u6211\u4eec\u628a\u9898\u76ee\u7ed9\u7684\u4e8c\u53c9\u67e5\u627e\u6811\u4e2d\u5e8f\u904d\u5386\u540e\n\n\u8981\u6c42\u7684\u5c31\u662f\u628a\u5e8f\u5217\u6539\u6210\u5355\u8c03\u9012\u589e\u7684\u6700\u5c0f\u6b21\u6570\n\n\u65e2\u7136\u5982\u6b64\u6211\u4eec\u5c31\u53ef\u4ee5\u60f3\u5230\u5927\u4f53\u505a\u6cd5\u5c31\u662f$LIS$\n\n# \u4e8c.\u5b9e\u73b0\u7ec6\u8282\n\n### \u9884\u5904\u7406\n\n\u9898\u76ee\u4e2d\u5f3a\u5236\u4fee\u6539\u540e\u7684\u6570\u4e3a\u6574\u6570\n\n\u5373\u4efb\u610f$i,j\\in[1,n],i<j$\u6ee1\u8db3$a_i-a_j>=i-j$\n\n\u5426\u5219\u91cc\u9762\u5c31\u88c5\u4e0d\u4e0b\u561b\n\n\u56e0\u6b64\u79fb\u4e00\u4e0b\u9879$:$\n\n\u4efb\u610f$a_i-i>=a_j-j$\n\n**\u6240\u4ee5\u6700\u7ec8\u7684\u7ed3\u679c\u5c31\u662f\u5e8f\u5217\u6ee1\u8db3$a_i-i$\u5355\u8c03\u4e0d\u4e0b\u964d**\n\n\u6ce8\u610f\u662f\u4e0d\u4e0b\u964d\u800c\u4e0d\u662f\u4e0a\u5347\n\n\u628a$a_i-i$\u4e0e\u5904\u7406\u4e00\u4e0b\u5c31\u53ef\u4ee5\u505a\u4e86\n\n**code**\n```\ninline void search(int now){//\u4e2d\u5e8f\u904d\u5386 \n\tif(son[now][0]) search(son[now][0]);\n\ta[++zz]=b[now];\n\tif(son[now][1]) search(son[now][1]);\n\treturn ;\n}\n```\n\n\n### \u6c42$LIS$\n\n\u8fd9\u9898\u5982\u679c\u7528$n^2dp$\u7684\u65b9\u6cd5\u6c42$LIS$\u80af\u5b9a\u4f1a\u70b8\n\n\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u7528$n log n$\u7684\u4e8c\u5206\u505a\u6cd5\n\n\u5f53\u7136\u6211\u4eec\u7528$STL$\u5077\u4e00\u4e0b\u61d2\n\n\u4e0d\u8fc7\u5728\u6bd4\u8d5b\u573a\u4e0a \u8fd8\u662f\u628a\u5361\u5e38\u89c6\u4f5c\u751f\u547d\n\n# \u4e09.\u4ee3\u7801\n```\n#include<cstdio>\n#include<cctype>\nconst int maxn=100005;\ninline int R(){\n\tint r=0;char c=getchar();\n\twhile(!isdigit(c)) c=getchar();\n\twhile(isdigit(c)) r=(r<<1)+(r<<3)+(c^48),c=getchar();\n\treturn r;\n}\nint n,a[maxn],son[maxn][2],b[maxn],zz,low[maxn],ans=1;\ninline void search(int now){//\u4e2d\u5e8f\u904d\u5386 \n\tif(son[now][0]) search(son[now][0]);\n\ta[++zz]=b[now];\n\tif(son[now][1]) search(son[now][1]);\n\treturn ;\n}\ninline int g(int x){//\u4e8c\u5206x \n\tint l=1,r=ans;\n\twhile(l<r){\n\t\tint mid=(l+r)>>1;\n\t\tif(low[mid]<=x) l=mid+1;\n\t\telse r=mid;\n\t}\n\treturn l-1;\n}\nint main(){\n\tn=R();\n\tfor(register int i=1;i<=n;i++) b[i]=R();\n\tfor(register int i=2;i<=n;i++){\n\t\tint fa=R(),opt=R();\n\t\tson[fa][opt]=i;\n\t}\n\tsearch(1);\n\tfor(register int i=1;i<=n;i++) a[i]-=i;//\u6bcf\u4e2a\u70b9-i\u6ee1\u8db3\u6574\u6570\u6761\u4ef6 \n\tlow[1]=a[1];\n\tfor(register int i=2;i<=n;i++){//\u6c42LIS \n\t\tif(low[ans]<=a[i]) low[++ans]=a[i];//\u6ce8\u610f\u6c42\u7684\u662f\u4e0d\u4e0b\u964d\u5e8f\u5217 \n\t\telse{\n\t\t\tint u=g(a[i]);\n\t\t\tlow[u+1]=a[i];\n\t\t}\n\t}\n\tprintf(\"%d\\n\",n-ans);//ans\u4e3a\u6700\u957f\u957f\u5ea6 \u5269\u4e0b\u7684\u5c31\u662f\u8981\u4fee\u6539\u7684 \n\treturn 0;\n}\n```\n# \u56db.\u540e\u8bb0\n\u5f53\u9898\u76ee\u51fa\u73b0\u6574\u6570\u8981\u6c42\u7684\u65f6\u5019\n\n\u6211\u4eec\u8981\u60f3\u529e\u6cd5\u600e\u4e48\u628a\u8fd9\u4e2a\u8981\u6c42\u7ed9\u5e72\u6389\n\n\u50cf\u8fd9\u9053\u9898\u5f53\u4e2d\u628a\u6761\u4ef6\u6539\u6210$a_i-a_j<=i-j$\n\n\u4ece\u800c\u901a\u8fc7\u6539\u53d8\u6570\u7ec4\u628a\u6761\u4ef6\u53bb\u6389\n\n\u5f53\u7136\u6539\u53d8\u7684\u65f6\u5019\u6ce8\u610f\u4e00\u4e0b\u8fb9\u754c\u6761\u4ef6 \u8981\u4e0d\u8981\u53d6\u7b49\n\nFinally\uff0c\u8c22\u8c22\u5927\u5bb6\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.luogu.com.cn/blog/HongseFox/solution-p3365)",
        "postTime": 1604472216,
        "uid": 93838,
        "name": "Hongse_Fox",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3365 \u3010\u6539\u9020\u4e8c\u53c9\u6811\u3011"
    },
    {
        "content": "\u4e8c\u53c9\u641c\u7d22\u6811\u6700\u91cd\u8981\u7684\u6027\u8d28\u5c31\u662f\u5b83\u7684\u4e2d\u5e8f\u904d\u5386\u7ed3\u679c\u662f\u4e00\u4e2a\u9012\u589e\u6570\u5217\u3002  \n\u73b0\u5728\u8bbe\u5df2\u7ecf\u751f\u6210\u7684\u4e2d\u5e8f\u904d\u5386\u6570\u5217\u4e3a$\\{a_n\\}(\\forall i\\in \\mathbb{N^*,a_i<a_{i+1}})$\u3002  \n\u9898\u76ee\u4e2d\u6709\u8fd9\u4e48\u4e00\u53e5\u8bdd\uff1a\n\n\t\u4efb\u610f\u65f6\u523b\u7ed3\u70b9\u7684\u6570\u503c\u5fc5\u987b\u662f\u6574\u6570\n\n\u8981\u80fd\u6784\u9020\u51fa\u4e00\u4e2a\u5168\u662f\u6574\u6570\u7684\u9012\u589e\u6570\u5217\uff0c\u8be5\u6570\u5217\u4e00\u5b9a\u6ee1\u8db3\u8be5\u6027\u8d28\uff1a\u5bf9\u4e8e\u4efb\u610f\u7684$i,j\\in \\mathbb{N^*}$\u4e14$i<j$\uff0c\u90fd\u6709$a_i+(j-i)\\leq a_j$\uff0c\u5373$a_i-i\\leq a_j-j$\u3002  \n\u53ef\u4ee5\u8fd9\u4e48\u7406\u89e3\uff0c\u4e24\u4e2a\u6570\u7684\u5dee\u81f3\u5c11\u80fd\u591f\u88ab\u4f4d\u7f6e\u5dee\u5f25\u8865\u8d77\u6765\u3002  \n\u6bd4\u5982\u6709\u8fd9\u4e48\u4e2a\u6570\u5217$\\{1,7,8,4,9,5\\}$\uff0c\u5bf9\u4e8e\u7b2c1\u9879\u548c\u7b2c4\u9879\u6765\u8bf4\uff0c\u4e2d\u95f4\u7684\u7b2c2\u9879\u548c\u7b2c3\u9879\u6709\u4f4d\u7f6e\u7528\u6765\u586b2\u548c3\uff0c\u4f46\u5bf9\u4e8e\u7b2c4\u9879\u548c\u7b2c6\u9879\u6765\u8bf4\uff0c\u5dee\u503c\u4e3a1\uff0c\u4f4d\u7f6e\u5dee\u4e3a2\uff0c\u4e2d\u95f4\u6ca1\u6709\u53ef\u4ee5\u586b\u7684\u6570\u3002  \n\u6240\u4ee5\u4ee4$b_n=a_n-n$\uff0c$\\{b_n\\}$\u5c31\u662f\u4e00\u4e2a\u975e\u964d\u5e8f\u5217\uff0c\u7528\u5e38\u89c4\u65b9\u6cd5\u505a\u6700\u957f\u975e\u964d\u5b50\u5e8f\u5217\u5373\u53ef\u3002  \n\u5e0c\u671b\u80fd\u5bf9\u4e0d\u7406\u89e3\u5176\u4ed6\u9898\u89e3\u7684\u540c\u5b66\u6709\u4e00\u70b9\u5e2e\u52a9\u3002",
        "postTime": 1569576962,
        "uid": 118402,
        "name": "Gerald_Chen",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3365 \u3010\u6539\u9020\u4e8c\u53c9\u6811\u3011"
    },
    {
        "content": "[\u535a\u5ba2\u98df\u7528](https://hackblogs.home.blog/2019/08/19/\u9898\u89e3-p3365-\u3010\u6539\u9020\u4e8c\u53c9\u6811\u3011/)\n\n\n\u8fd9\u9053\u989830\u5206\u7684\u66b4\u529b\u662f\u76f4\u63a5\u679a\u4e3ei\u548cj\uff0c\u8fd9\u6837\u4f1a\u591a\u4e00\u7ef4\u3002\n\n\u4f46\u6211\u4eec\u53ef\u4ee5\u964d\u7ef4\uff0c\u6539\u4e3a\u679a\u4e3ek\uff0c\u5bf9\u4e8e\u6bcf\u6b21\u679a\u4e3e\uff0c\u4ecek\u4f4d\u7f6e\u524d\u540e\u5ef6\u4f38\uff0c\u627e\u5230\u524d\u9762\u6700\n\n\u5148 \u4e0d \u80fd \u6574 \u9664 \u7684\u5730\u65b9\uff0c\u548c\u540e\u9762 \u4e0d \u80fd \u6574 \u9664 \u7684\u5730\u65b9\uff0c\u90a3\u8fd9\u6837\u4e00\u4e2a\u5e8f\u5217\u4e00\u5b9a\u662f\u5408\u6cd5\u7684\uff0c\n\n\u6240\u4ee5\u76f4\u63a5\u66f4\u65b0\u7b54\u6848\u5373\u53ef\u3002\n\n\u4ee3\u7801\uff1a\n\n\n```\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#define ll long long\n#define re register\nusing namespace std;\nll n,tot;\nll ans;\nll a[100005];\nstruct Tree\n{\n\tll lc,rc;\n\tll fa;\n\tll val;\n}t[200005];\nll dfn[1000005];\nll v[1000005];\nll dp[1000005];\nll cnt,len;\nll x,ch;\ninline void dfs(ll x)\n{\n\tif(!x)return;\n\tif(t[x].lc)dfs(t[x].lc);\n\tdfn[++tot]=a[x];\n\tif(t[x].rc)dfs(t[x].rc);\n}\ninline ll find(ll x)\n{\n\tll l=1,r=len,ans=0;\n\twhile(l<=r)\n\t{\n\t\tll mid=(l+r)>>1;\n\t\tif(v[mid]<=x)\n\t\t{\n\t\t\tans=mid;\n\t\t\tl=mid+1;\n\t\t}\n\t\telse r=mid-1;\n\t}\n\treturn ans;\n}\nint main()\n{\n\tscanf(\"%lld\",&n);\n\tfor(re ll i=1;i<=n;++i)scanf(\"%lld\",&a[i]);\n\tt[1].val=a[1];\n\tfor(re ll i=2;i<=n;++i)\n\t{\n\t\tscanf(\"%lld%lld\",&x,&ch);\n\t\tt[i].fa=x;\n\t\tif(ch==0)t[x].lc=i;\n\t\telse t[x].rc=i;\n\t\tt[i].val=a[i];\n\t}\n\tdfs(1);\n\tfor(ll i=1;i<=n;++i)dfn[i]-=i;\n\tfor(ll i=1;i<=n;++i)\n\t{\n\t\tdp[i]=find(dfn[i])+1;\n\t\tv[dp[i]]=dfn[i];\n\t\tlen=max(len,dp[i]);\n\t}\n\tcout<<n-len;\n\treturn 0;\n}\n```\n**\u63d0\u540e\u58f0\u660e**\uff1a\n\n\u8fd9\u662f\u6211\u5728\u7f51\u4e0a\u53d1\u73b0\u7684\u4e00\u4e2a\u6781\u5176\u9b3c\u755c\u7684\u65b9\u6cd5\uff0c _\u4ec5\u4f9b\u5a31\u4e50_ \uff08\u590d\u6742\u5ea6O(n^2),\u4e0d\u7528\u5361\u5e38...\uff09\u3002\n\n\n\uff08\u5949\u529d\u5927\u5bb6\u4e00\u53e5\uff1a\u8fd8\u662f\u8981\u5b66\u4e60\u4e00\u4e0b\u6b63\u89e3\uff0c\u592a\u591a\u6b6a\u95e8\u90aa\u9053\u5bf9oj\u6c34\u5e73\u662f\u6ca1\u6709\u63d0\u5347\u7684...\uff09",
        "postTime": 1566175672,
        "uid": 89490,
        "name": "AmadeusSG",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3365 \u3010\u6539\u9020\u4e8c\u53c9\u6811\u3011"
    },
    {
        "content": "## \u8f6c\u8f7d\u4e00\u4e2a\u6211\u4eec\u6559\u7ec3\u7684\u9898\u89e3\n\n![](https://s2.ax1x.com/2019/08/19/mlwpef.png)\n![](https://s2.ax1x.com/2019/08/19/mlw9w8.png)\n\n---\n\u9644\u4e0a\u672c\u4eba\u4e11\u964bcode:\n```cpp\n// luogu-judger-enable-o2\n// luogu-judger-enable-o2\n#include<bits/stdc++.h>\n#define reg register\n#define ll long long\n#define inf 0x3f3f3f3f\n#define iinf 0x3f3f3f3f3f3f3f3fll\n#define y1 liuyifan_y1\n#define next liuyifan_next\nusing namespace std;\nll n,i,j,k,ans,cnt,son[500005][2],a[500005],b[500005],d[500005],len,fa,ch;\nvoid dfs(reg ll x)\n{\n\tif(x==0)return;\n\tdfs(son[x][0]);\n\tb[++cnt]=a[x];\n\tdfs(son[x][1]);\n\treturn ;\n}//\u6c42\u4e2d\u5e8f\u904d\u5386\ninline ll find(reg ll x)\n{\n\tll l=1,r=len,mid=0;\n\twhile(l<=r)\n\t{\n\t\tmid=(l+r)/2;\n\t\td[mid]>x?r=mid-1:l=mid+1;\n\t}\n\treturn l;\n}//\u4e8c\u5206\ninline void lis()\n{\n\td[1]=b[1];\n\tlen=1;\n\tfor(reg ll i=2;i<=n;++i)\n\t{\n\t\tif(b[i]>=d[len])d[++len]=b[i];\n\t\telse\n\t\t{\n\t\t\treg ll k=find(b[i]);\n\t\t\td[k]=min(d[k],b[i]);\n\t\t}\n\t}\n}//\u4e8c\u5206\u6c42LIS\nint main()\n{\n\tscanf(\"%lld\",&n);\n\tfor(reg ll i=1;i<=n;++i)scanf(\"%lld\",&a[i]);\n\tfor(reg ll i=2;i<=n;++i)\n\t{\n\t\tscanf(\"%lld%lld\",&fa,&ch);\n\t\tson[fa][ch]=i;\n\t}\n\tdfs(1);\n\tfor(reg ll i=1;i<=n;++i)b[i]-=i;//\u4e00\u79cd\u5f88\u597d\u7684\u5904\u7406\u65b9\u5f0f,\u503c\u5f97\u501f\u9274\n\tlis();\n\tprintf(\"%lld\\n\",n-len);\n\treturn 0;\n}\n/*\n3\n2 2 2\n1 0\n1 1\n*/\n/*\n7\n4 2 6 1 3 5 7\n1 0\n1 1\n2 0\n2 1\n3 0\n3 1\n*/\n```\n",
        "postTime": 1566174738,
        "uid": 48993,
        "name": "liuyifan",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3365 \u3010\u6539\u9020\u4e8c\u53c9\u6811\u3011"
    }
]
[
    {
        "content": "\u5f88\u660e\u663e\uff0c\u8fd9\u4e2a\u9898\u76ee\u53ea\u8981\u786e\u5b9a\u4e86\u6bcf\u4e00\u884c\u7684\u7b2c\u4e00\u4e2a\u6570\uff0c\u8be5\u884c\u6240\u6709\u7684\u6570\u5c31\u90fd\u786e\u5b9a\u4e86\u3002\n\u5728\u6570\u5b66\u4e0a\uff0c\u6bcf\u4e2a\u6b63\u6574\u6570\u90fd\u53ef\u4ee5\u5199\u6210\u82e5\u5e72\u4e2a\u4e0d\u91cd\u590d\u7684\u6590\u6ce2\u90a3\u5951\u6570\u4e4b\u548c\u3002\u4e3a\u4e86\u8bc1\u660e\u8fd9\u4e2a\u7ed3\u8bba\uff0c\u5148\u8bc1\u660e\u5f15\u7406\u4e00\u3002\n\n**\u5f15\u7406\u4e00\uff1a**\n\u5982\u679c\u5df2\u77e5\u67d0\u4e2a\u6590\u6ce2\u90a3\u5951\u6570\u4e3a $F_n$\uff0c\u4e0b\u4e00\u4e2a\u6590\u6ce2\u90a3\u5951\u6570\u4e3a $F_{n+1}$\uff0c\u90a3\u4e48 $F_n < F_{n+1} < 2*F_n$ \n\n\u8bc1\u660e\uff1a\n\n$F_n < F_n + F_{n-1} = F_{n+1} $\uff0c(1)\n\n$F_{n+1} = F_n + F_{n-1} < F_n + F_n = 2*F_n$\uff0c(2)\n\n\u7ed3\u5408\uff081\uff09\uff082\uff09\u5f97\u8bc1\u3002\n\n**\u5b9a\u7406\uff1a\u6bcf\u4e2a\u6b63\u6574\u6570\u90fd\u53ef\u4ee5\u5199\u6210\u82e5\u5e72\u4e2a\u4e0d\u91cd\u590d\u7684\u6590\u6ce2\u90a3\u5951\u6570\u4e4b\u548c\u3002**\n\n\u53ef\u4ee5\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bc1\u660e\uff1a\n\n\uff081\uff09\u5f53 $N=1$ \u65f6\uff0c$1 = 1$ \u663e\u7136\u6210\u7acb\u3002\n\n\uff082\uff09\u5f53 $N > 1$\u65f6\uff0c\u5047\u8bbe\u5bf9\u4e8e\u6240\u6709\u5c0f\u4e8e $N$ \u7684\u6b63\u6574\u6570\uff0c\u90fd\u6210\u7acb\u3002\n\n\u5982\u679c $N$ \u672c\u8eab\u5c31\u662f\u6590\u6ce2\u90a3\u5951\u6570\uff0c\u90a3\u4e48\u663e\u7136 $N = N$ \u6210\u7acb\u3002\n\n\u5982\u679c $N$ \u4e0d\u662f\u6590\u6ce2\u90a3\u5951\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u627e\u5230\u5c0f\u4e8e $N$ \u7684\u6700\u5927\u6590\u6ce2\u90a3\u5951\u6570 $K$\u3002\u7531\u5f52\u7eb3\u5047\u8bbe\u53ef\u77e5 $N - K$ \u53ef\u4ee5\u5199\u6210\u82e5\u5e72\u4e0d\u91cd\u590d\u7684\u6590\u6ce2\u90a3\u5951\u6570\u4e4b\u548c\u3002\u7531\u5f15\u7406\u4e00\u53ef\u77e5\uff0c\u5728 $K$ \u548c $2*K$ \u4e4b\u95f4\u5fc5\u7136\u5b58\u5728\u53e6\u5916\u4e00\u4e2a\u6590\u6ce2\u90a3\u5951\u6570\u3002\u65e2\u7136 $K$ \u662f\u5c0f\u4e8e $N$ \u7684\u6700\u5927\u6590\u6ce2\u90a3\u5951\u6570\uff0c$N$ \u548c $K$ \u5fc5\u7136\u6ee1\u8db3\u5173\u7cfb\uff1a$ N < 2*K$ \uff0c\u56e0\u6b64 $ N-K < K$\u3002\u800c $N = K + (N - K)$\uff0c\u6240\u4ee5 $N$ \u4e5f\u53ef\u4ee5\u5199\u6210\u82e5\u5e72\u4e0d\u91cd\u590d\u7684\u6590\u6ce2\u90a3\u5951\u6570\u4e4b\u548c\u3002\n\n\u7efc\u5408(1),(2)\u5f97\u8bc1\u3002\n\n\u518d\u52a0\u4e0a\u96f6\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u6bcf\u4e2a\u6574\u6570\u5199\u6210\u6590\u6ce2\u90a3\u5951\u8fdb\u5236\u3002\u5177\u4f53\u7684\u505a\u6cd5\u662f\u5c06\u6574\u6570 $N$ \u5199\u6210\u82e5\u5e72\u6590\u6ce2\u90a3\u5951\u6570\u4e4b\u548c\uff0c\u628a\u5bf9\u5e94\u6590\u6ce2\u90a3\u5951\u6570\u7684\u4f4d\u7f6e\u586b $1$ \uff0c\u5176\u4ed6\u4f4d\u7f6e\u586b $0$\u3002\u5982\u4ee5\u4e0b\u5217\u8868\uff1a\n\n$0 = 0$\n\n$1 = 1$\n\n$2 = 10$\n\n$3 = 100$\n\n$4 = 3 + 1 = 101$\n\n$5 = 1000$\n\n$6 = 5 + 1 = 1001$\n\n$7 = 5 + 2 = 1010$\n\n$8 = 10000$\n\n$9 = 8 + 1 = 10001$\n\n$...$\n\n\u5982\u679c\u9650\u5b9a\u6ca1\u6709\u76f8\u90bb\u7684 $1$ \uff0c\u8fd9\u79cd\u8868\u793a\u6cd5\u662f\u552f\u4e00\u7684\u3002\n\n\u65e2\u7136\u9898\u76ee\u4e2d\u7ed9\u51fa\u7684\u8868\u548c\u6590\u6ce2\u90a3\u5951\u6570\u6709\u5173\uff0c\u5982\u679c\u6211\u4eec\u628a\u8868\u4e2d\u6bcf\u4e2a\u6574\u6570\u8f6c\u6362\u6210\u6590\u6ce2\u90a3\u5951\u8fdb\u5236\uff0c\u8bf4\u4e0d\u5b9a\u4f1a\u6709\u4ec0\u4e48\u53d1\u73b0\u3002\u8f6c\u6362\u4e4b\u540e\u5982\u4e0b\n\n|\u884c\u53f7|\u7b2c\u4e00\u5217|\u7b2c\u4e8c\u5217|\u7b2c\u4e09\u5217|\u7b2c\u56db\u5217|\u7b2c\u4e94\u5217|\n| ---: | -----------: | -----------: | -----------: | -----------: |-----------: |\n|1|        001|         10|        100|       1000|      10000|\n|2|        101|       1010|      10100|     101000|    1010000|\n|3|       1001|      10010|     100100|    1001000|   10010000|\n|4|      10001|     100010|    1000100|   10001000|  100010000|\n|5|      10101|     101010|    1010100|   10101000|  101010000|\n|6|     100001|    1000010|   10000100|  100001000| 1000010000|\n|7|     100101|    1001010|   10010100|  100101000| 1001010000|\n|8|     101001|    1010010|   10100100|  101001000| 1010010000|\n|9|    1000001|   10000010|  100000100| 1000001000|10000010000|\n|10|    1000101|   10001010|  100010100| 1000101000|10001010000|\n|11|    1001001|   10010010|  100100100| 1001001000|10010010000|\n\n\u5148\u89c2\u5bdf\u6bcf\u4e00\u884c\uff0c\u53ef\u4ee5\u53d1\u73b0\uff0c\u6bcf\u884c\u7b2c\u4e00\u5217\u7684\u6700\u672b\u4f4d\u90fd\u662f $1$\u3002\u5c06\u7b2c\u4e00\u5217\u7684\u6570\u5b57\u5de6\u79fb\u4e00\u4f4d\u540e\u5f97\u5230\u7b2c\u4e8c\u5217\uff0c\u5de6\u79fb\u4e24\u4f4d\u540e\u5f97\u5230\u7b2c\u4e09\u5217\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\n\n\u518d\u89c2\u5bdf\u7b2c\u4e00\u5217\uff0c\u56e0\u4e3a\u6700\u672b\u4f4d\u662f $1$\uff0c\u800c\u6590\u6ce2\u90a3\u5951\u8fdb\u5236\u8981\u6c42\u4e0d\u80fd\u6709\u8fde\u7eed\u76841\uff0c\u6240\u4ee5\u7b2c\u4e00\u5217\u7684\u6570\u5b57\u5f62\u5f0f\u4e3a $------01$\uff0c\u8fd9\u4e3a\u6211\u4eec\u8ba1\u7b97\u7b2c\u4e00\u5217\u7684\u6570\u63d0\u4f9b\u4e86\u65b9\u4fbf\u3002\u53c8\u7531\u4e8e\u7b2c\u4e00\u5217\u7684\u6570\u662f\u6700\u5c0f\u7684\u4e4b\u524d\u4ece\u672a\u51fa\u73b0\u8fc7\u7684\u6570\uff0c\u6240\u4ee5\u628a\u884c\u53f7\u51cf\u4e00\u8f6c\u6362\u6210\u6590\u6ce2\u90a3\u5951\u6570\u8fdb\u5236\u5373\u53ef\u3002\n\n\u6bd4\u5982\u8981\u6c42\u7b2c $10$ \u884c\u7684\u7b2c\u4e00\u4e2a\u6570\uff0c\u53ef\u4ee5\u5c06 $9$ \u8f6c\u6362\u4e3a\u6590\u6ce2\u90a3\u5951\u8fdb\u5236\u4e3a\uff1a$10001$\uff0c\u540e\u9762\u518d\u8865\u4e00\u4e2a $01$ \u5373\u4e3a\uff1a$1000101$\n\n\u8fd9\u6837\u5c31\u6c42\u5f97\u4e86\u7b2c $i$ \u884c\u7684\u7b2c\u4e00\u4e2a\u6570\uff0c\u7136\u540e\u518d\u901a\u8fc7\u5de6\u79fb $j-1$ \u6b21\uff0c\u53ef\u4ee5\u5f97\u5230\u7b2c $i$ \u884c\uff0c\u7b2c $j$ \u5217\u7684\u6570\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include <stdio.h>\n#define MAX 1000000000\n#define SIZE 256\n\nint bits[SIZE];\nint fib[SIZE] = {1, 1, 2};\nint fib_len;\nint shifted[SIZE];\n\nstruct Matrix {\n    int m[2][2];\n    Matrix() {\n        m[0][0] = 1; m[0][1] = 1;\n        m[1][0] = 1; m[1][1] = 0;\n    }\n};\n\nint find_lower(int value) {\n    int low = 0;\n    int high = fib_len - 1;\n    int mid;\n    while (low <= high) {\n        mid = (low + high) / 2;\n        if (fib[mid] <= value) {\n            low = mid + 1;\n        } else {\n            high = mid - 1;\n        }\n    }\n    return low - 1;\n}\n\nint fill_bits(int value) {\n    bits[0] = 1;\n    bits[1] = 0;\n    value--;\n    int len = find_lower(value);\n    int k = len;\n    while (k > 0 && value > 0) {\n        if (value >= fib[k]) {\n            bits[k+1] = 1; \n            value -= fib[k];\n        }\n        k--;\n    }\n    return len + 2;\n}\n\nMatrix matrix_mul(const Matrix* a, const Matrix* b, int M) {\n    Matrix c;\n    c.m[0][0] = (a->m[0][0] * b->m[0][0] + a->m[0][1] * b->m[1][0]) % M;\n    c.m[0][1] = (a->m[0][0] * b->m[0][1] + a->m[0][1] * b->m[1][1]) % M;\n    c.m[1][0] = (a->m[1][0] * b->m[0][0] + a->m[1][1] * b->m[1][0]) % M;\n    c.m[1][1] = (a->m[1][0] * b->m[0][1] + a->m[1][1] * b->m[1][1]) % M;\n    return c;\n}\n\nMatrix matrix_pow(const Matrix* matrix, int n, int M) {\n    if (n == 1) {\n        return {};\n    }\n    Matrix t = matrix_pow(matrix, n/2, M);\n    t = matrix_mul(&t, &t, M);\n    if (n & 1) {\n        return matrix_mul(&t, matrix, M);\n    }\n    return t;\n}\n\nvoid get_shifted_fib(int j, int k, int M) {\n    if (j == 0) {\n        shifted[0] = 1 % M;\n        shifted[1] = 2 % M;\n    } else {\n        Matrix c;\n        c = matrix_pow(&c, j, M);\n        shifted[0] = (c.m[1][0] * 2 + c.m[1][1]) % M;\n        shifted[1] = (c.m[0][0] * 2 + c.m[0][1]) % M;\n    }\n    for (int i = 2; i <= k; i++ ) {\n        shifted[i] = (shifted[i-1] + shifted[i-2]) % M;\n    }\n}\n\nint main() {\n    int i, j, m, k;\n    for (k = 2; fib[k-1] < MAX; k++) {\n        fib[k] = fib[k-1] + fib[k-2];\n    }\n    fib_len = k - 1;\n\n    scanf(\"%d%d%d\", &i, &j, &m);\n    k = fill_bits(i); // \u8ba1\u7b97\u7b2c i \u884c\uff0c\u7b2c\u4e00\u5217\u7684\u6570\n    get_shifted_fib(j-1, k, m);  // \u5de6\u79fb j-1 \u4f4d\n    int ans = 0;\n    for (i = 0; i <= k; i++) {\n        if (bits[i]) { // \u6309\u4f4d\u8ba1\u7b97\n            ans = (ans + shifted[i]) % m; \n        }\n    }\n    printf(\"%d\\n\", ans);\n    return 0;\n}\n```\n",
        "postTime": 1588396401,
        "uid": 51452,
        "name": "IsoTTL",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2544 \u3010[AHOI2004]\u6570\u5b57\u8ff7\u9635\u3011"
    },
    {
        "content": "\u5148\u63a8\u51fa\u7b2c\u4e00\u5217\u7684\u516c\u5f0f\uff0c\u7136\u540e\u518d\u8ddf\u636e\u7b2c\u4e00\u5217\u5f97\u51fa\u7b2c\u4e8c\u5217\uff0c\u6700\u540e\u7b2ci\u884c\u7b2cj\u5217\u4f7f\u7528\u77e9\u9635\u5feb\u901f\u5e42\u5f97\u51fa\u3002\n```cpp\n\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n\ntypedef long long ll;\n\nconst int N=2;\n\nll MOD;\n\nstruct node{\n    ll a[10][10];\n}tmp,ans,t;\n\n\nnode matrix(node x,node y ){\n    node q;\n    for(int i=1;i<=N;i++){\n        for(int j=1;j<=N;j++){\n            q.a[i][j]=0;\n            for(int k=1;k<=N;k++){\n                q.a[i][j]=(q.a[i][j]+x.a[i][k]*y.a[k][j]+MOD)%MOD;\n            }\n        }\n    }\n    return q;\n}\n\nvoid quick_ma(ll n){\n    for(int i=1;i<=N;i++){\n        for(int j=1;j<=N;j++){\n            ans.a[i][j]=0;\n        }\n    }\n    for(int i=1;i<=N;i++) ans.a[i][i]=1;\n    t=tmp;\n    while(n){\n        if(n&1) ans=matrix(ans,t);\n        n>>=1;\n        t=matrix(t,t);\n    }\n}\n\nint main(){\n\n    ll c2,c1;\n    ll x,y;\n    scanf(\"%lld%lld%lld\",&x,&y,&MOD);\n    c1=((ll)(x*(1+sqrt(5)))/2+x-1)%MOD;\n    c2=((c1*2-x+1)%MOD+MOD)%MOD;\n//    printf(\"%lld  %lld\\n\",x,c0);\n    tmp.a[1][1]=1;\n    tmp.a[1][2]=1;\n    tmp.a[2][1]=1;\n    tmp.a[2][2]=0;\n//    printf(\"%lld  %lld\\n\",c1,c2);\n    if(y>2){\n        quick_ma(y-2);\n        printf(\"%lld\\n\",(c2*ans.a[1][1]%MOD+c1*ans.a[1][2]%MOD)%MOD);\n    }else{\n        if(y==1)\n            printf(\"%lld\\n\",c1);\n        else printf(\"%lld\\n\",c2);\n    }\n    return 0;\n}\n```",
        "postTime": 1536156192,
        "uid": 124597,
        "name": "yaozhuojiang",
        "ccfLevel": 0,
        "title": "P2544 [AHOI2004]\u6570\u5b57\u8ff7\u9635 \u9898\u89e3"
    },
    {
        "content": "[\u9898\u9762\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P2544)\n\n### 1.\u524d\u7f6e\u8981\u6c42\n- \u77e9\u9635\u57fa\u7840&\u4e58\u6cd5&\u5feb\u901f\u5e42\n- [P1962 \u6590\u6ce2\u90a3\u5951\u6570\u5217\n](https://www.luogu.com.cn/problem/P1962)\n\n\u4e0d\u4f1a\u8bf7\u53f3\u8f6c\uff0c\u672c\u9898\u9700\u8981\u5176\u719f\u6089\u8fd0\u7528\n### 2.\u9898\u9762\u5206\u6790\n\u6211\u4eec\u53ef\u4ee5\u5206\u6790\u5f97\u5230\uff0c\u7b2cn\u884c\u7684\u6570\u90fd\u4e0e\u672c\u884c\u7b2c1\u4e2a\u6570\u76f8\u5173\n\n\u4e5f\u5c31\u662f\u7b2c\u4e00\u4e2a\u6570\u53ef\u4ee5\u63a8\u5bfc\u51fa\u540e\u9762\u7684\u6240\u6709\u6570\n\n\u6240\u4ee5\u6211\u4eec\u7684\u7b2c\u4e00\u6b65\u662f\u6c42\u7b2c1\u4e2a\u6570\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u6765\u601d\u8003\u600e\u4e48\u6c42\u7b2cm\u4e2a\u6570\u4e86\n#### 2.1\u6c42\u7b2c\u4e00\u4e2a\u6570\n\u6211\u4eec\u6765\u628a\u6bcf\u884c\u7b2c\u4e00\u4e2a\u6570\u90fd\u62ff\u8d77\u6765\u770b\n\n\t1 4 6 9 12 14 17 19 \u2026\n\n\u5982\u679c\u627e\u4e0d\u5230\u5173\u7cfb\uff0c\u5c31\u4e24\u9879\u76f8\u51cf ~~\uff08\u67d0\u795e\u4ed9\u5b9a\u7406\uff09~~\n\n\u7136\u540e\u53d1\u73b0\u5dee\u503c\u662f2\u62163\n\n\u90a3\u4e48\u53c8\u6709\u4ec0\u4e48\u7279\u5f81\u5462\uff1f\n\n~~\u56e0\u4e3a\u9898\u9762\u6d89\u53ca\u5230\u6590\u6ce2\u90a3\u5951\uff0c\u6240\u4ee5\u5c31\u662f\u6590\u6ce2\u90a3\u5951\u4e86~~\n\n~~\u4e00\u901a\u4e71\u641e~~\n\n\u6574\u7406\u4e4b\u540e\u5dee\u503c\u53ef\u4ee5\u6392\u5217\u4e3a\n\n\t3 \n    2 3 \n    3  2 3 \n    2 3  3 2 3 \n    3 2 3  2 3 3 2 3\n\u53d1\u73b0\u4e86\u5417\uff1f\u8fd9\u4e0d\u5c31\u662f\u59a5\u59a5\u7684\u6590\u6ce2\u90a3\u5951\u53d8\u5f62\uff1f\n\n\u63cf\u8ff0\u5c31\u662f:\u6bcf\u4e00\u6b21\u5f80\u540e\u63a8\u7684\u9879\u6570\u6ee1\u8db3\u6590\u6ce2\u90a3\u5951\u6570\u5217\uff0c\u4e14\u5c31\u662f\u524d\u9762\u4e24\u6b21\u7684\u90a3\u4e9b\u9879\u8fde\u63a5\u8d77\u6765\n    \n\u7136\u540e\u5c31\u662f\u4e00\u4e2a\u7ed3\u8bba ~~\uff08\u849f\u84bb\u4e0d\u4f1a\u6c42qwq\uff09~~\n\n\u5bf9\u4e8e\u4e0a\u9762\u7684\u5f0f\u5b50$f[i]=trunc(i\\times t+i-1)$\uff0c\u5176\u4e2d$t=(1+\\sqrt 5)/2$\uff0c$\\text{trunc}$ \u8868\u793a\u53d6\u6574\n\n\u4f46\u662f\u5728\u8003\u573a\u4e0a\u6709\u53ef\u80fd\u5199\u51fa\u6765\u5417\uff1f\n\n\u849f\u84bb\u4e0d\u77e5\u9053\uff0c\u53ef\u662f\u6211\u4eec\u53ef\u4ee5\u4ece\u53e6\u5916\u4e00\u4e2a\u89d2\u5ea6\u770b\u8fd9\u4e2a\u95ee\u9898\n\n\u663e\u7136\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2a\u6570\u53ef\u4ee5\u62c6\u5206\u6210\u82e5\u5e72\u4e2a\u6590\u6ce2\u90a3\u5951\u6570\u4e4b\u548c\uff0c\u53c8\u56e0\u4e3a\u6709\u4ee5\u4e0a\u6761\u4ef6\uff0c\u53ef\u4ee5\u5f97\u51fa\uff1a\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u6590\u6ce2\u90a3\u5951\u6570$f[i]$\uff0c3\u7684\u4e2a\u6570\u4e3a$f[i-1]$\uff0c2\u7684\u4e2a\u6570\u4e3a$f[i-2]$\n\n\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u505a\uff1a\n\n\u628a\u76ee\u6807\u62c6\u5206\u4e3a\u82e5\u5e72\u6590\u6ce2\u90a3\u5951\u6570\uff0c\u518d\u6839\u636e\u4e0a\u9762\u7684\u7ed3\u8bba\u8fdb\u884c\u7edf\u8ba1\u5373\u53ef\n\n\u56e0\u4e3a\u6590\u6ce2\u90a3\u5951\u7684\u589e\u957f\u901f\u5ea6\u5f88\u5feb\uff08\u8bb0\u5f9730\u4e2a\u4ee5\u5185\u5c31\u8d85int\u4e86\uff09\uff0c\u6240\u4ee5\u590d\u6742\u5ea6\u548c\u7cbe\u5ea6\u6ca1\u6709\u95ee\u9898\u7684\n\n#### 2.2\u6c42\u7b2cm\u4e2a\u6570\n\n\u6839\u636e\u9898\u9762\u7684\u516c\u5f0f\uff0c\u8fd8\u6709\u4e0a\u6587\u63d0\u51fa\u7684\u65b9\u5f0f\uff0c\u518d\u6839\u636e\u6590\u6ce2\u90a3\u5951\u6570\u5217\u9012\u63a8\u516c\u5f0f\u5c31\u53ef\u4ee5\u6c42\u4e86\n\n\u7b49\u7b49\uff0c$\\text{O}(10^9)$\u600e\u4e48\u8fc7\u5f97\u53bb\u5462\n\n\u8fd9\u5c31\u8981\u8fd0\u7528\u5230\u6211\u4eec\u7684\u524d\u7f6e\u9898\u76ee\u4e86\n\n- [\u56e0\u4e3a\u8fd9\u91cc\u9ed8\u8ba4\u5404\u4f4d\u5927\u4f6c\u90fd\u4f1a\uff0c\u6240\u4ee5\u5c31\u4e0d\u5c55\u5f00\uff0c\u5982\u679c\u4e0d\u4f1a\u53ef\u80fd\u4f1a\u5f71\u54cd\u4e0b\u6587\u9605\u8bfb](https://www.luogu.com.cn/problem/P1962)\n\n\u8003\u8651\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316\uff08\u4e0d\u61c2\u8bf7\u53f3\u8f6c\uff09\n\n\u56e0\u4e3a\u6211\u4eec\u7684\u76ee\u6807\u884c\u4e0e\u666e\u901a\u6590\u6ce2\u90a3\u5951\u6570\u5217\u4e0d\u540c\u7684\u5c31\u662f\u524d\u4e24\u9879\u4e0d\u540c\n\n\u800c\u6839\u636e\u77e9\u9635\u5feb\u901f\u5e42\u7684\u4f18\u5316\u65b9\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u628a\u8f6c\u79fb\u7684\u8f85\u52a9\u77e9\u9635\u5904\u7406\u8d77\u6765\uff0c\u7136\u540e\u518d\u628a\u524d\u4e24\u9879\u7684\u503c\u53d6\u76f8\u5e94\u7684\u503c\u5373\u53ef\n\n\u5728\u672c\u9898\u4e2d\u7684\u516c\u5f0f\u4e3a\uff1a\n\n$$ \\left[\\begin{array}{ccc}F_{n-1} & F_{n-2}\\end{array}\\right] \\times \\left[\\begin{array}{ccc} 1 & 1 \\\\ 1 & 0 \\end{array}\\right]^{m-1} = \\left[ \\begin{array}{ccc}F_n & F_{n-1} \\end{array}\\right]$$\n\n\u6ce8\uff1a[\u53c2\u8003\u6587\u7ae0](https://anguei.blog.luogu.org/solution-p1962)\n\n#### 2.3\u590d\u6742\u5ea6\u5206\u6790\n\uff08\u849f\u84bb\u7b80\u5355\u6765\u5206\u6790\u4e00\u4e0b\uff09\n\n\u663e\u7136\u7a7a\u95f4\u590d\u6742\u5ea6\u662f\u6bd4\u8f83\u5c0f\u7684\uff0c\u6211\u4eec\u751a\u81f3\u4e0d\u9700\u8981\u4e00\u4e2a\u5927\u6570\u7ec4\n\n\u90a3\u4e48\u65f6\u95f4\u590d\u6742\u5ea6\u5462\uff1f\n\n\u6c42\u7b2c1\u4e2a\u6570\uff1a$O(1)$\n\n\u5feb\u901f\u5e42\uff1a$O(log\\space m)$\n\n\u67e5\u8be2:$O(1)$\n\n\u6545\u65f6\u95f4\u590d\u6742\u5ea6\u7ea6\u4e3a$O(log\\space m)$\n### 3.\u4ee3\u7801\u798f\u5229\u65f6\u95f4\n~~\u8be6\u7ec6\u6ce8\u91ca\uff0c\u65b9\u4fbf\u98df\u7528~~\n\n\u6ce8\u610f\u7cbe\u5ea6\u7684\u7ec6\u8282\u5904\u7406\n```cpp\n#include<cmath>\n#include<cstdio>\n#define ll long long\nint n,m,mod,k1,k2;\nstruct MA{\n\tint a[3][3];\n}ans,anss;\nMA operator *(const MA x,const MA y)//\u91cd\u8f7d\u8fd0\u7b97\u7b26\uff0c\u65b9\u4fbf\u5feb\u6377\uff0c5\u661f\u597d\u8bc4\uff08\u5199\u6210\u51fd\u6570\u4e5f\u968f\u4fbf\u4f60\u54af\uff09\n{\n\tMA z;\n\tfor(int i=1;i<3;i++)\n\t\tfor(int j=1;j<3;j++)\n\t\t\tz.a[i][j]=0;\n\tfor(int i=1;i<3;i++)\n\t\tfor(int j=1;j<3;j++)\n\t\t\tfor(int k=1;k<3;k++)\n\t\t\t\tz.a[i][j]=(z.a[i][j]+(ll)x.a[i][k]*y.a[k][j])%mod;\n\treturn z;\n}\nint main()\n{\n\tscanf(\"%d%d%d\",&n,&m,&mod);\n\tk1=((ll)(n*(1+sqrt(5))/2+n-1))%mod;//\u8fd9\u91cc\u662f\u516c\u5f0f\u6cd5\n    \t/*\u4ee5\u4e0b\u662f\u8003\u573a\u5e38\u89c4\u5199\u6cd5\n   \tfib[1] = fib[2] = 1;\n    \tint i,a=0,b=0;\n     \tfor (i=3;fib[i-1]<=n;i++) fib[i]=fib[i-1]+fib[i-2];\n     \twhile(i--)\n            if(fib[i]<=n) n-=fib[i],a=(a+3*fib[i-1])%mod,b=(b+2*fib[i-2])%mod;\n     \tk1=(a+b+1)%mod;\n\t*/\n\tk2=((2*k1-n+1)%mod+mod)%mod;//\u5957\u516c\u5f0f\n\tif(m<=2) //\u7279\u6b8a\u5904\u7406\n\t{\n\t\tprintf(\"%d\",m==1?k1:k2);\n\t\treturn 0;\n\t } \n\tm--;//\u8fd9\u91cc\u662f\u56e0\u4e3a\u5feb\u901f\u5e42\u5b9e\u9645\u53ea\u9700\u8981m-1\u6b21\u5e42\uff08\u611f\u6027\u7406\u89e3\uff09\n\tans.a[1][1]=ans.a[2][2]=1;//\u5355\u4f4d\u77e9\u9635\u76f8\u5f53\u4e8e\u8d4b\u503c1\n\tanss.a[1][1]=anss.a[1][2]=anss.a[2][1]=1;//\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u5e38\u89c4\u8f6c\u79fb\u77e9\u9635\n\twhile(m)//\u5feb\u901f\u5e42\u6a21\u677f\n\t{\n\t\tif(m&1) ans=ans*anss;\n\t\tm>>=1;\n\t\tanss=anss*anss;\n\t}\n\tprintf(\"%lld\",((ll)k1*ans.a[2][2]+(ll)k2*ans.a[2][1])%mod);//\u91cd\u65b0\u8d4b\u521d\u503c\uff0c\u5f97\u5230\u7b54\u6848\n\treturn 0;\n}\n```\n\n\n\n\n\n",
        "postTime": 1591192942,
        "uid": 144523,
        "name": "JohnJoeZhu",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2544 \u3010[AHOI2004]\u6570\u5b57\u8ff7\u9635\u3011"
    },
    {
        "content": "### \u77e9\u9635\u5feb\u901f\u5e42 + \u6590\u6ce2\u90a3\u5951\u6570\u5217\u901a\u9879\u516c\u5f0f## \n\n\u7b2c\u4e00\u5217\u7684\u901a\u9879\u516c\u5f0f\n\n**f[i]=trunc(i*t+t-1) , t=(1+sqrt(5))/2 trunc\u4e3a\u53d6\u6574**\n\n\u6c42\u51fa\u7b2c\u4e00\u5217\u7684\u6570 \u518d\u7528\u7b2c\u4e00\u5217\u548c\u7b2c\u4e8c\u5217\u7684\u5173\u7cfb \u6c42\u51fa\u7b2c\u4e8c\u5217\u7684\u6570\n\n\u8fd9\u91cc\u7684\u65f6\u5019\u8981\u5224\u65ad\u4e00\u4e0b **\u8f93\u5165\u7684 j \u82e5 <=2 \u5c31\u8f93\u51fa\u5373\u53ef \u6ce8\u610f\uff1a\u8f93\u51fa\u7684\u65f6\u5019\u4e5f\u8981\u53d6\u6a21**\n\n\u7136\u540e\u5c31\u662f\u77e9\u9635\u5feb\u901f\u5e42\n\n**\u56db\u683c\u77e9\u9635\uff1a**x1,x2,x3,x4 \u4e3a\u77e9\u9635\u4ece\u4e0a\u5230\u4e0b\u4ece\u5de6\u5230\u53f3\u7684\u56db\u4e2a\u6570 \n\n**\u4e24\u683c\u77e9\u9635\uff1a**x,y \u4e3a\u4ece\u4e0a\u5230\u4e0b\u7684\u4e24\u4e2a\u6570\n\n\u7136\u540e\u5e94\u7528**\u77e9\u9635\u5feb\u901f\u5e42**\u548c **\u77e9\u9635\u4e58\u6cd5** \u6c42\u51fa\u7ed3\u679c\u5c31\u53ef\u4ee5\u4e86\n\n**\u6ce8\u610f\uff1a\u5feb\u901f\u5e42\u7684\u7ec8\u6b62\u6761\u4ef6\u4e3a\uff1a\u5355\u4f4d\u77e9\u9635 \u89c1\u4e0b\u56fe**\n\n![](https://cdn.luogu.com.cn/upload/pic/16729.png)\n\n\n\n------------\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<cstring>\n#include<algorithm>\n#include<queue> \n#define MAXN 1000005\n#define LL long long\n#define MOD 100000007\nusing namespace std;\nstruct juzhen{\n\tLL int x,y;\n};\nstruct jz{\n\tLL int x1,x2,x3,x4;\n};\nLL int a,b,m,d1,d2;\njuzhen t,ans;\njz n,q;\njz mul(jz x,jz y)\n{\n\tjz tt;\n\ttt.x1=(x.x1*y.x1%m+x.x2*y.x3%m)%m;\n\ttt.x2=(x.x1*y.x2%m+x.x2*y.x4%m)%m;\n\ttt.x3=(x.x3*y.x1%m+x.x4*y.x3%m)%m;\n\ttt.x4=(x.x3*y.x2%m+x.x4*y.x4%m)%m;\n\treturn tt;\n}\njuzhen mull(jz x,juzhen y)\n{\n\tjuzhen tt;\n\ttt.x=(x.x1*y.x%m+x.x2*y.y%m)%m;\n\ttt.y=(x.x3*y.x%m+x.x4*y.y%m)%m;\n\treturn tt;\n}\njz fast(jz x,int p)\n{\n\tif(p==0)\n\t\treturn q;\n\tjz l=fast(x,p/2);\n\tif(p%2==0)\n\t\treturn mul(l,l);\n\treturn mul(mul(l,l),n);\n}\nint main()\n{\n\tn.x1=n.x2=n.x3=1;\n\tn.x4=0;\n\tq.x1=q.x4=1;\n\tq.x2=q.x3=0;\n\tscanf(\"%lld%lld%lld\",&a,&b,&m);\n\td1=(a*((1+sqrt(5))/2)+a-1);\n\td2=2*d1-a+1;\n\tif(b==1)\n\t{\n\t\tprintf(\"%lld\",d1%m);\n\t\treturn 0;\n\t}\n\tif(b==2)\n\t{\n\t\tprintf(\"%lld\",d2%m);\n\t\treturn 0;\n\t}\n\tt.x=d2;t.y=d1;\n\tans=mull(fast(n,b-2),t);\n\tprintf(\"%lld\",ans.x);\n\treturn 0;\n}\n```",
        "postTime": 1522825427,
        "uid": 37427,
        "name": "\u66f9\u8001\u5e08",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2544 \u3010[AHOI2004]\u6570\u5b57\u8ff7\u9635\u3011"
    },
    {
        "content": "\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u5224\u65ad\u51fa\u6bcf\u884c\u90fd\u662fFibonacci\u6570\u5217 ~~\uff08\u5e9f\u8bdd\uff09~~\u3002\n\n\u6211\u4eec\u53c8\u53ef\u4ee5\u53d1\u73b0\uff0c $A[i,2] = 2A[i,1] - (i - 1)$,\u6240\u4ee5\uff0c $A[i,j]$ \u53ea\u548c\u7b2c $i$ \u884c\u7684\u7b2c\u4e00\u4e2a\u6570\u5b57\u6709\u5173\u3002\u90a3\u4e48\u600e\u4e48\u6c42 $A[i,1]$ \u5462\uff1f\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u5f00\u59cb\u627e\u89c4\u5f8b\uff1a\n\n\u7b2c\u4e00\u884c\u589e\u52a0\u4e86\u503c\u662f $2$ \u6216 $3$\uff0c\u540e\u9762\u4f1a\u4e0d\u4f1a\u6709\u89c4\u5f8b\u5462\uff1f\u6211\u4eec\u518d\u4ed4\u7ec6\u770b\u4e00\u4e0b\uff0c\u7b2c $2$ \u884c\u52a0\u4e86 $3$\uff0c\u7b2c $3$ , $4$ \u884c\u5206\u522b\u52a0\u4e86 $2$ \u548c $3$\uff0c\u5728\u540e\u9762 $5$ \u5230 $7$ \u884c\uff0c\u662f\u524d\u4e24\u6b21\u7684\u52a0\u7684\u9879\u8fde\u63a5\u8d77\u6765\uff0c\u5c31\u662f $3$\uff0c$2$\uff0c$3$\uff01\n\n\u5176\u5b9e\u8fd9\u4e00\u4e2a\u7ed3\u8bba\u662f\u6709\u4e00\u4e2a\u901a\u9879\uff1a $f[i] = \\left[i \\times t + i - 1\\right] $ \u4e14 $t = (1 + \\sqrt5) \\div 2$\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u7528 $O(1)$ \u7684\u65f6\u95f4\u5c31\u53ef\u4ee5\u6c42\u51fa $A[i,1]$ \u4e86\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u4ee5\u7b2c\u4e00\u884c\u4e3a\u4f8b\uff0c\u6c42\u51fa Fibonacci \u6570\u5217\uff1a\n\n\u4ee4 $f(0) = 1$\uff0c $f(1) = 1$\uff0c $a = 1$\uff0c $b = 1$, \u5f97\u5230\uff1a\n\n$m = \\frac{1 + \\sqrt5}{2}$\uff0c $k = \\frac{1 - \\sqrt5}{2}$\n\n\u6240\u4ee5\uff0c $f(n) = \\frac{k^n(1-m)-m^n(1-k)}{k-m}$\n\n\u5316\u7b80\u4e00\u4e0b\uff0c\u5f97\u5230\uff1a $f(n) = \\frac{m^{n_+1}-k^{n+1}}{\\sqrt5}$\n\n\u8fd9\u5c31\u662f Fibonacci \u7684\u901a\u9879\u516c\u5f0f\u3002\u53ea\u662f\u6bcf\u4e00\u884c\u7684 $f(0)$ \u548c $f(1)$ \u4e0d\u4e00\u6837\u800c\u5df2\u3002\n\n## AC\u4ee3\u7801\n```cpp\n#include<iostream>\n#include<cmath>\n#include<algorithm>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\ntypedef long long LL;\nconst int MAXN = 1e5 + 10;\nconst int INF = 0x3f;\nint n, m, p, x[100][3][3], y[3][3], z[3][3], a[100], k1, k2, ans;\nint main()\n{\n\tint i;\n\tcin >> n >> m >> p;\n\tm--;\n\tx[0][1][2] = x[0][2][1] = x[0][2][2] = 1;\n\ta[0] = 1;\n\tfor(i = 1;a[i - 1] * 2 <= m; i++){\n\t\ta[i] = a[i - 1] * 2;\n\t\tfor(int j = 1;j <= 2; j++){\n\t\t\tfor(int k = 1;k <= 2;k++){\n\t\t\t\tfor(int l = 1;l <= 2; l++){\n\t\t\t\t\tx[i][j][k] = (x[i][j][k] + (LL)x[i - 1][j][l] * x[i - 1][l][k]) % p;\n\t\t\t\t}\n\t\t\t}\n\t\t} \n\t}\n\ty[1][1] = y[2][2] = 1;\n\tfor(i--;i >= 0;i--){\n\t\tif(a[i] <= m){\n\t\t\tm -= a[i];\n\t\t\tfor(int j = 1;j <= 2; j++){\n\t\t\t\tfor(int k = 1;k <= 2;k++){\n\t\t\t\t\tfor(int l = 1;l <= 2; l++){\n\t\t\t\t\t\tz[j][k] = (z[j][k] + (LL)x[i][j][l] * y[l][k]) % p;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int j = 1;j <= 2;j++){\n\t\t\t\tfor(int k = 1;k <= 2; k++){\n\t\t\t\t\ty[j][k] = z[j][k];\n\t\t\t\t\tz[j][k] = 0; \n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tk1 = ((LL)(n * (1 + sqrt(5)) / 2 + n - 1)) % p;\n\tk2 = ((2 * k1 - n + 1) % p + p) % p;\n\tans = ((LL)k1 * y[1][1] + (LL)k2 * y[1][2]) % p;\n\tcout << ans << endl;\n    return 0;\n}\n```",
        "postTime": 1645847409,
        "uid": 341036,
        "name": "\u8521\u7ae3\u51ef",
        "ccfLevel": 4,
        "title": "P2544 [AHOI2004]\u6570\u5b57\u8ff7\u9635 \u9898\u89e3"
    },
    {
        "content": "**\u5173\u952e\u601d\u8def\uff1a\u6c42\u51fa\u7b2c$i$\u884c\u7b2c\u4e00\u5217\u6570\u540e\u76f4\u63a5\u77e9\u9635\u5feb\u901f\u5e42\u641e\u5b83\uff0c\u65e0\u89c6\u7b2c\u4e00\u5217\u6570\u7684\u8bdd\u5176\u5b9e\u5c31\u662f\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u6c42\u6cd5**\n\n\u95ee\u9898\u6765\u4e86\uff0c\u7b2c\u4e00\u5217\u6570\u600e\u4e48\u6c42\u5462\uff1f\n\n* ### \u7b2c\u4e00\u6b65\uff1a\u89c2\u5bdf\n   \n   \u5148\u6253\u4e2a\u8868\uff1a\n   $1, 4, 6, 9, 12, 14, 17, 19, 22, 25, 27, 30, 33, 35, 38, 40, 43, 46, 48, 51, 53, 56, 59, 61, 64, 67, 69, 72, 74, 77, 80, 82, 85, 88, 90, 93$\n   \u8c8c\u4f3c\u6ca1\u5565\u89c4\u5f8b\uff0c\u518d\u5eb7\u5eb7\u5dee\u503c\uff1a\n   \n   $3$ $2$\n  \n   $3$ $3$ $2$\n   \n   $3$ $2$ $3$ $3$ $2$\n\t\n    $3$ $3$ $2$ $3$ $2$ $3$ $3$ $2$ \n    \n    \u8c8c\u4f3c\u6709\u4e2a\u89c4\u5f8b\u8bf6\uff0c\u7b2c$i$\u884c\u7684\u5dee\u503c\u7b49\u4e8e\u7b2c$i-1$\u884c\u7684\u5dee\u503c\u4e0e$i-2$\u884c\u5408\u5e76\n    \n    \u7136\u540e\u3002\u3002\u3002\n   \n* ### \u7b2c\u4e8c\u6b65\uff1a\u627e\u89c4\u5f8b\n\n\t\u600e\u4e48\u627e\u89c4\u5f8b\u5462\uff1f\u5728\u5199\u4e86\u4e00\u4e24\u4e2a\u5c0f\u65f6\u548c\u8be2\u95ee\u8001\u5e08\u540e\uff0c\u4ecd\u7136\u6ca1\u5f97\u51fa\u67ff\u5b50\u6765\n    \n\t\u5173\u952e\u6765\u4e86\uff1a~~\u6253\u5f00OEIS~~\n    \n    ![](https://cdn.luogu.com.cn/upload/image_hosting/d2ilimvl.png)\n    \n    \u518d\u5f80\u4e0b\u770b\u770b\n    \n    ![](https://cdn.luogu.com.cn/upload/image_hosting/2uy9lth1.png)\n    \n    \uff1f\uff1f\uff1f\u4ec0\u4e48\u8bc1\u660e\n    \n    \u8fd9\u8bc1\u660e\uff0c\u54b3\u54b3\uff0c~~\u770b\u6765\u76f4\u63a5\u7528\u5c31\u5b8c\u4e8b\u4e86~~\n    \n    (\u63d2\u4e00\u5634\uff0c\u5927\u90e8\u5206\u9898\u89e3\u90fd\u662f\u76f4\u63a5\u7ed9\u51fa\u4e00\u4e2a\u7c7b\u4f3c\u6768\u8f89\u4e09\u89d2\u7684\u89c4\u5f8b\u7136\u540e\u76f4\u63a5\u6446\u67ff\u5b50\u7684\uff0c\u5e76\u6ca1\u6709\u7ed9\u8bc1\u660e\uff0c\u7136\u800c\u8fd9\u67ff\u5b50\u53ef\u80fd\u6254\u7ed9\u6570\u5b66\u7cfb\u5927\u5b66\u751f\u624d\u80fd\u8bc1\u3002\u4f46\u662f\u6211\u770b\u9898\u89e3\u91cc\u6709\u7528\u4e8c\u8fdb\u5236\u505a\u5f97\uff0c\u63a8\u6d4b\u51fa\u9898\u4eba\u672c\u610f\u662f\u8ba9\u6211\u4eec\u7528\u4e8c\u8fdb\u5236\u63a8\u800c\u975e\u627e\u8fd9\u6837\u7684\u67ff\u5b50)\n    \n# \u4ee3\u7801\uff1a\n\n\uff08\u60f3\u4e86\u60f3\uff0c\u8fd8\u662f\u6446\u4e0a\u4e3a\u597d\uff09\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nll n,m,mol,now1,now2;\nstruct Matrix{\n    ll a[3][3];\n    Matrix(){memset(a,0,sizeof(a));}\n    Matrix operator *(const Matrix &b)const{\n        Matrix C;\n        for(int i=1;i<=2;i++){\n            for(int j=1;j<=2;j++){\n                for(int k=1;k<=2;k++){\n                    C.a[i][j]=(C.a[i][j]+a[i][k]*b.a[k][j]%mol)%mol;\n                }\n            }\n        }\n        return C;\n    }\n}ans,base;\nvoid Init(){\n    ans.a[1][1]=now2;ans.a[1][2]=now1;\n    base.a[1][1]=base.a[1][2]=base.a[2][1]=1;\n}\nvoid qpow(ll x){\n    while(x){\n        if(x&1)ans=ans*base;\n        base=base*base;\n        x>>=1;\n    }\n}\nint main(){\n\tcin>>n>>m>>mol;\n\tnow1=(ll)(n*(1+sqrt(5))/2+n-1)%mol;\n    now2=((2*now1-n+1)%mol+mol)%mol;\n    Init();\n    if(m==1)cout<<now1;//\u6ce8\u610f\u4e00\u822c\u77e9\u9635\u5feb\u901f\u5e42\u90fd\u8981\u5904\u7406\u524d\u51e0\u4e2a\u6570\n    else if(m==2)cout<<now2;\n    else{\n        qpow(m-2);\n        cout<<ans.a[1][1];\n        return 0;\n    }\n}\n```\n",
        "postTime": 1595128693,
        "uid": 295335,
        "name": "aakennes",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2544 \u3010[AHOI2004]\u6570\u5b57\u8ff7\u9635\u3011"
    },
    {
        "content": "\u901f\u5ea6\u697c\u4e0b\u51e0\u5341\u500d\n\n\n\u7528\u4ec0\u4e48\u901a\u5411\u516c\u5f0f\uff08\u4ec0\u4e48\u903b\u8f91\uff09\n\n\n\u7528\u4e2a\u77e9\u9635\u4e58\u4e0d\u4e45\u597d\u4e86\u5417\uff1f\uff1f\uff1f\uff1f\uff1f\n\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n\ntypedef long long LL;\n\nLL x,y,MOD; LL A[2],B[2],S[2][2],C[2][2];\n\nvoid Mul(){ memcpy(C,S,sizeof C);memset(S,0,sizeof S); for(int i=0;i<2;i++)for(int j=0;j<2;j++) for(int k=0;k<2;k++)(S[i][j] += C[i][k]*C[k][j]%MOD)%=MOD; }\n\nvoid Work(LL n){ S[0][1]=S[1][1]=S[1][0]=1;\n\nfor(--n;n;n>>=1,Mul())\n    if(n&1){\n        B[0] = ( A[0]*S[0][0]%MOD + A[1]*S[0][1]%MOD )%MOD;\n        B[1] = ( A[0]*S[1][0]%MOD + A[1]*S[1][1]%MOD )%MOD;\n        memcpy(A,B,sizeof A);\n    }\n\n}\n\nint main(){\n\nscanf(\"%lld%lld%lld\",&x,&y,&MOD);\n\nA[0]=((LL)(x*(1+sqrt(5)))/2+x-1)%MOD;\nA[1]=((A[0]*2-x+1)%MOD+MOD)%MOD;\nWork(y);\n\nprintf(\"%lld\\n\",A[0]);\nreturn 0;\n\n}\n```",
        "postTime": 1493618855,
        "uid": 20116,
        "name": "never_see",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2544 \u3010[AHOI2004]\u6570\u5b57\u8ff7\u9635\u3011"
    },
    {
        "content": "\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u5224\u65ad\u51fa\u6bcf\u884c\u90fd\u662f\u53d8\u5f62\u7684\u6590\u6ce2\u90a3\u5951\u6570\u5217,\u53c8\u56e0\u4e3aa[i][2]=2a[i][1]-(i-1),\u6240\u4ee5\u672c\u8d28\u4e0aa[i][j]\u53ea\u4e0e\u7b2ci\u884c\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u6709\u5173,\u90a3\u4e48\u5173\u952e\u6c42a[i][1]\n\n\u6211\u4eec\u53d1\u73b0\u7b2c\u4e00\u5217\u589e\u52a0\u7684\u503c\u4e3a2\u62163,\u5176\u5b9e\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u7b2c\u4e00\u6b21(\u7b2c\u4e8c\u884c)+3,\u540e\u9762\u4e24\u6b21(3,4\u884c)\u5206\u522b+2-3,\u518d\u540e\u9762\u76843\u6b21\u662f\u524d\u4e24\u6b21\u7684\u5e8f\u5217\u548c,\u53733-2-3......\n\n\u6bcf\u4e00\u6b21\u5f80\u540e\u63a8\u7684\u9879\u6570\u6ee1\u8db3\u6590\u6ce2\u90a3\u5951\u6570\u5217,\u4e14\u5c31\u662f\u524d\u9762\u4e24\u6b21\u7684\u90a3\u4e9b\u9879\u8fde\u8d77\u6765.\u5373\u7b2c\u4e00\u5217\u901a\u9879\u4e3af[i]=trunc(i\\*t+t-1),\u5176\u4e2dt=(1+sqrt(5))/2\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528O(1)\u7684\u65f6\u95f4\u6c42a[i][1],\u4f46\u662f\u9700\u8981O(N)\u7684\u65f6\u95f4\u6c42a[i][j],\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4ee4f[0]=1,f[1]=1,a=1,b=1,\u5219\n\nm=(1+sqrt(5))/2,k=(1-sqrt(5))/2,f[n]=((k^n)\\*(1-m)-(m^n)\\*(1-k))/(k-m)\n\n**\u5373f[n]=(m^(n+1)-k^(n+1))/sqrt(5);**\n\n\u5176\u5b9e\u5c31\u662f\u6590\u6ce2\u90a3\u5951\u6570\u5217\u901a\u9879\u516c\u5f0f\n\n\u5176\u4ed6\u884c\u5c31\u662f\u521d\u503c\u4e0d\u4e00\u6837\u800c\u5df2,\u4ee3\u7801\u4e0d\u60f3\u5199\u6ce8\u91ca,\u81ea\u5df1\u90fd\u89c9\u5f97\u5947\u4e11\u65e0\u6bd4......\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <cmath>\nusing namespace std;\n\ntypedef long long LL;\nint n,m,p;\nint x[101][3][3],y[3][3],z[3][3],a[101],k1,k2,ans;\nint i,j,k,l;\n\nint main() {\n    scanf(\"%d%d%d\",&n,&m,&p);\n    m--;\n    x[0][1][2]=x[0][2][1]=x[0][2][2]=1;\n    a[0]=1;\n    for(i=1;a[i-1]*2<=m;i++) {\n        a[i]=a[i-1]*2;\n        for(j=1;j<=2;j++)\n            for(k=1;k<=2;k++) \n                for(l=1;l<=2;l++)\n                    x[i][j][k]=(x[i][j][k]+(LL)x[i-1][j][l]*x[i-1][l][k])%p;\n    }\n    y[1][1]=y[2][2]=1;\n    for(i--;i>=0;i--) {\n        if(a[i]<=m) {\n            m-=a[i];\n            for(j=1;j<=2;j++) \n                for(k=1;k<=2;k++)\n                    for(l=1;l<=2;l++) \n                        z[j][k]=(z[j][k]+(LL)x[i][j][l]*y[l][k])%p;\n            for(j=1;j<=2;j++) \n                for(k=1;k<=2;k++) {\n                    y[j][k]=z[j][k];\n                    z[j][k]=0;\n                }\n        }\n    }\n    k1=((LL)(n*(1+sqrt(5))/2+n-1))%p;\n    k2=((2*k1-n+1)%p+p)%p;\n    ans=((LL)k1*y[1][1]+(LL)k2*y[1][2])%p;\n    printf(\"%d\\n\",ans);\n    return 0;\n}\n\n```",
        "postTime": 1487401306,
        "uid": 15304,
        "name": "zyg20010121",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2544 \u3010[AHOI2004]\u6570\u5b57\u8ff7\u9635\u3011"
    }
]
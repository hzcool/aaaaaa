[
    {
        "content": "**\u6837\u4f8b\u8bf4\u660e\uff1a**\n\n![](http://img.blog.csdn.net/20180225095401231?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzYyODg5NzY=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)\n\n**\u9898\u610f\u89e3\u6790\uff1a**\n\u82e5\u5728I\u653e\u7f6e\u4e00\u4e2a\u62bd\u6c34\u673a\uff0c\u4e14J\u4e0eI\u4e4b\u95f4\u5b58\u5728\u4e00\u6761\u8def\u5f84\u4f7f\u5f97max(H)<=H[j]\uff0c\u90a3\u4e48J\u7684\u6c34\u53ef\u4ee5\u88ab\u62bd\u5e72\u3002\n\n**\u7b97\u6cd5\uff1a\u5e76\u67e5\u96c6**\n\n1. \u5148\u5c06\u6240\u6709\u70b9\u6309\u9ad8\u5ea6\u6392\u5e8f\u3002\n2. \u679a\u4e3e\u6bcf\u4e2a\u70b9\uff0c\u5e76\u5c06\u5b83 \u76f8\u90bb\u7684\u70b9\u4e14\u9ad8\u5ea6<=\u8fd9\u4e2a\u70b9\u7684\u9ad8\u5ea6 \u7684\u70b9\u4e0e\u5b83\u5408\u5e76\u3002\u5047\u8bbe\uff1a\u8fd9\u4e2a\u70b9\u662fa[i], \u6709\u4e00\u4e2a\u6ee1\u8db3 \u76f8\u90bb\u7684\u70b9\u4e14\u9ad8\u5ea6<=\u8fd9\u4e2a\u70b9\u7684\u9ad8\u5ea6 \u8fd9\u4e00\u6761\u4ef6\u7684\u70b9a[j]\uff0c\u5f88\u660e\u663ea[i]\u7684\u6c34\u53ef\u4ee5\u6d41\u5411a[j]\uff0c \u6240\u4ee5\u5982\u679ca[j]\u7684\u6c34\u5df2\u7ecf\u88ab\u62bd\u6c34\u673a\u62bd\u5b8c\u4e86\uff0c\u90a3\u4e48a[i]\u7684\u6c34\u4e5f\u4f1a\u88ab\u62bd\u5b8c\u3002\n3. \u5224\u65ad\u8be5\u70b9\u662f\u5426\u4e3a\u57ce\u5e02\u3002\u5982\u679c\u4e0d\u4e3a\u57ce\u5e02\uff0c\u5219\u4e0d\u9700\u8981\u62bd\u6c34\u673a\u3002\u5982\u679c\u4e3a\u57ce\u5e02\u4e14\u8be5\u8054\u901a\u5757\u5185\u6ca1\u6709\u62bd\u6c34\u673a\uff0c\u5219\u5728\u8be5\u57ce\u5e02\u653e\u4e00\u4e2a\u62bd\u6c34\u673a\u3002\uff08\u6ce8\u610f\uff1a\u8fd9\u91cc\u5fc5\u987b\u5148\u5c06\u540c\u4e00\u9ad8\u5ea6\u7684\u70b9\u90fd\u5408\u5e76\u4e86\u624d\u80fd\u5224\u65ad\uff09\n\n**\u4e3a\u4ec0\u4e48\u5fc5\u987b\u5148\u5c06\u540c\u4e00\u9ad8\u5ea6\u7684\u70b9\u90fd\u5408\u5e76\u4e86\u624d\u80fd\u5224\u65ad\u5462\uff1f**\n\n\u4f8b\u5982\u6570\u636e\uff1a\n1 4\n3 3 2 1\n\n\u5f88\u660e\u663e\u7b54\u6848\u662f1\n\u6211\u4eec\u6765\u6a21\u62df\u4e00\u4e0b\uff0c\u6392\u5b8c\u5e8f\u540e\uff0c\u6570\u636e\u53ef\u80fd\u4f1a\u53d8\u4e3a\n1 2 3 3\uff08\u7b2c3\u4e2a \u20183\u2019\u4e3a \u539f\u6765\u5e8f\u5217\u7684\u7b2c1\u4e2a\uff09\n\u90a3\u4e48\u8fb9\u505a\u65f6\u8fb9\u5224\u65ad\u662f\u5426\u6709\u62bd\u6c34\u673a\n\u5230\u7b2c3\u4e2a3\u65f6 \u8054\u901a\u5757\u4e3a\uff1a 1-2 3 \u5c31\u8981\u7528\u4e24\u4e2a\u62bd\u6c34\u673a\u4e86\n\n[\u5b8c\u6574\u4ee3\u7801](http://blog.csdn.net/qq_36288976/article/details/79367178)",
        "postTime": 1519525317,
        "uid": 8952,
        "name": "M_se\u0430",
        "ccfLevel": 0,
        "title": "\u6d1b\u8c37P3457 [POI2007]POW-The Flood"
    },
    {
        "content": "\u4e00\u9053\u8d2a\u5fc3\u597d\u9898\u3002\n\n\u9996\u5148\u6211\u4eec\u53d1\u73b0\u5982\u679c\u5728\u4ed6\u5468\u56f4\u6bd4\u4ed6\u4f4e\u7684\u70b9\u6709\u62bd\u6c34\u673a\uff0c\u90a3\u4e48\u4ed6\u80af\u5b9a\u4e0d\u7528\u518d\u653e\u62bd\u6c34\u673a\u4e86\u3002\n\n\u5f88\u81ea\u7136\u7684\u5f97\u5230\u4e00\u4e2a\u60f3\u6cd5\uff0c\u5c31\u662f\u628a\u6240\u6709\u70b9\u6309\u9ad8\u5ea6\u6392\u5e8f\u3002\u4f9d\u6b21\u5224\u65ad\u8981\u62bd\u6c34\u7684\u70b9\u56db\u5468\u80fd\u8fde\u51fa\u53bb\u7684\u70b9\u4e2d\u662f\u5426\u6709\u62bd\u6c34\u673a\u3002\n\n\u8fd9\u4e2a\u64cd\u4f5c\u53ef\u4ee5\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\uff0c\u628a\u9ad8\u7684\u70b9\u653e\u5165\u56db\u5468\u4f4e\u7684\u70b9\u7684\u5e76\u67e5\u96c6\u4e2d\uff0c\u6bcf\u6b21\u67e5\u8be2\u4ed6\u6240\u5728\u5e76\u67e5\u96c6\u6709\u6ca1\u6709\u62bd\u6c34\u673a\uff0c\u6ca1\u6709\u5c31\u52a0\u4e0a\u3002\n\n\u53ef\u4ee5\u8bc1\u660e\u8fd9\u6837\u64cd\u4f5c\u80fd\u4f7f\u7b54\u6848\u6700\u4f18\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O( nm \\log{nm}) $ \u3002\n\n\n\n------------\n\u4ee3\u7801\u5982\u4e0b\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n//static char buf[1000000],*p1=buf,*p2=buf;\n//#define getchar() p1==p2&&(p2=(p1=buf)+fread(buf,1,1000000,stdin),p1==p2)?EOF:*p1++\n#define re register\nconst int maxn=1e3+5;\ninline int read()\n{\n\tchar ch=getchar();bool f=0;int x=0;\n\tfor(;!isdigit(ch);ch=getchar())if(ch=='-')f=1;\n\tfor(;isdigit(ch);ch=getchar())x=(x<<1)+(x<<3)+(ch^48);\n\tif(f==1)x=-x;return x;\n}\nvoid print(int x)\n{\n    if(x<0) putchar('-'),x=-x;\n    if(x>9) print(x/10);\n    putchar(x%10+'0');\n}\nint n,m,a[maxn][maxn],f[maxn][maxn],dx[4]={0,0,1,-1},dy[4]={1,-1,0,0},fa[maxn*maxn],s[maxn*maxn],ans=0;\nstruct node\n{\n\tint x,y,num;\n}b[1000005];\nbool cmp(node a,node b){return a.num<b.num;}\nint getf(int x){if(fa[x]==x)return x;fa[x]=getf(fa[x]);return fa[x];}\nvoid gett(int x,int y)\n{\n\tx=getf(x),y=getf(y);if(x==y)return ;\n\tfa[x]=y;s[y]|=s[x];\n}\nint id(int x,int y){return (x-1)*m+y;}\nsigned main()\n{\n\t//freopen(\".in\",\"r\",stdin);\n\t//freopen(\".out\",\"w\",stdout);\n\tn=read(),m=read();memset(a,0x3f,sizeof a);\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++)\n\t\t{\n\t\t\ta[i][j]=read();\n\t\t\tif(a[i][j]<0)a[i][j]=abs(a[i][j]);\n\t\t\telse f[i][j]=1;\n\t\t\tb[id(i,j)]=(node){i,j,a[i][j]};\n\t\t\tfa[id(i,j)]=id(i,j);\n\t\t}\n\tsort(b+1,b+id(n,m)+1,cmp);\n\n\tfor(int i=1;i<=n*m;i++)\n\t{\n\t\tfor(int j=0;j<4;j++)\n\t\t{\n\t\t\tint tx=b[i].x+dx[j],ty=b[i].y+dy[j];\n\t\t\tif(a[tx][ty]<=b[i].num)gett(id(tx,ty),id(b[i].x,b[i].y));\n\t\t}\n\t\tif(b[i].num!=b[i+1].num)\n\t\t{\n\t\t\tfor(int j=i;;j--)\n\t\t\t{\n\t\t\t\tif(b[j].num!=b[i].num)break;\n\t\t\t\tif(f[b[j].x][b[j].y])\n\t\t\t\t{\n\t\t\t\t\tint h=getf(id(b[j].x,b[j].y));\n\t\t\t\t\tif(!s[h])s[h]=1,ans++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcout<<ans;\n \treturn 0;\n}\n\n```\n\u5982\u6709\u5e2e\u5230\u4f60\uff0c\u8bf7\u70b9\u8d5e\u652f\u6301\uff0c\u8c22\u8c22\u3002",
        "postTime": 1629946542,
        "uid": 343748,
        "name": "louhao088",
        "ccfLevel": 9,
        "title": "\u9898\u89e3P3457 [POI2007]POW-The Flood"
    },
    {
        "content": "# \u6d1b\u8c37P3457 [POI2007]POW-The Flood\u7ed3\u9898\u62a5\u544a\n\n[\u9898\u76ee\u94fe\u63a5\u6233\u8fd9\u91cc](https://www.luogu.org/problemnew/show/P3457)\n\n~~\u8fd9\u9053\u9898\u7684\u9898\u76ee\u63cf\u8ff0\u662f\u771f\u7684\u6709\u6bd2~~\n\n## \u9898\u9762\u89e3\u91ca:\n\n\u5bf9\u4e8e\u5e03\u7f6e\u6709\u62bd\u6c34\u673a\u7684\u70b9$i$\u548c\u5e0c\u671b\u88ab\u62bd\u5e72\u7684\u67d0\u4e00\u70b9$j$,\u4fdd\u8bc1$j$\u7684\u9ad8\u5ea6\u6bd4$i$\u9ad8,\u5982\u679c\u5b58\u5728\u4e00\u6761\u4ece$i$\u5230$j$\u7684\u8def\u5f84\u4f7f\u8be5\u8def\u5f84\u4e0a\u6700\u9ad8\u70b9\u7684\u9ad8\u5ea6\u4e0d\u8d85\u8fc7$j$,\u5219$j$\u8282\u70b9\u53ef\u4ee5\u88ab\u62bd\u5e72(\u8fd9\u91cc\u9700\u8981\u4e00\u70b9\u7a7a\u95f4\u60f3\u8c61\u80fd\u529b)\n\n## \u603b\u4f53\u601d\u8def:BFS~~(\u8c8c\u4f3c\u767e\u5ea6\u4e0a\u8fd8\u6ca1\u6709BFS\u7684\u9898\u89e3)~~\n\n## \u5177\u4f53\u5b9e\u73b0:\n\n\u663e\u7136\u53ea\u6709\u5f53\u62bd\u6c34\u673a\u5efa\u5728\u8f83\u4f4e\u7684\"\u5c71\u8c37\"\u4e2d\u65f6\u624d\u80fd\u591f\u4fdd\u8bc1\u6bcf\u4e00\u53f0\u62bd\u6c34\u673a\u80fd\u62bd\u5e72\u7684\u8303\u56f4\u5c3d\u53ef\u80fd\u5927\u4ece\u800c\u51cf\u5c11\u62bd\u6c34\u673a\u7684\u6570\u91cf.\n\n\u6211\u4eec\u7528$w[i][j]$\u8868\u793a\u4f4d\u7f6e$(i,j)$\u5904\u5f53\u524d\u80fd\u4f7f\u6c34\u4f4d\u4e0b\u964d\u5230\u7684\u6700\u4f4e\u9ad8\u5ea6.\u5c06\u57ce\u5e02\u4e2d\u7684\u6240\u6709\u4f4d\u7f6e\u6309\u7167\u6d77\u62a5\u9ad8\u5ea6\u9012\u589e\u6392\u5e8f\u5e76\u4f9d\u6b21\u679a\u4e3e,\u5982\u679c$w[i][j]>h[i][j]$\u8bf4\u660e\u5728\u5f53\u524d\u6761\u4ef6\u4e0b\u7684\u62bd\u6c34\u673a\u65e0\u6cd5\u5c06\u8fd9\u4e00\u70b9\u62bd\u5e72,\u5219\u8003\u8651\u5728\u8be5\u5e03\u7f6e\u62bd\u6c34\u673a\u5e76\u66f4\u65b0$w$\n\n\u5bf9\u4e8e\u70b9$(x_0, y_0)$\u4e0a\u4e0b\u5de6\u53f3\u7684\u4e00\u70b9$(x_1, y_1)$\u5bf9$w[x_0][y_0]$\u7684\u53ef\u80fd\u8d21\u732e\u4e3a$max(w[x_1][y_1], h[x_0][y_0])$,\u5bf9$w[x_0][y_0]$\u53d6\u6700\u5c0f\u503c\u5373\u53ef,\u6211\u4eec\u8003\u8651\u501f\u7528$SPFA$\u7684\u601d\u8def\u66f4\u65b0\u65f6\u5c06\u5f53\u524d\u4e0d\u5728\u961f\u5217\u4e2d\u7684\u70b9\u52a0\u5165\u961f\u5217\u4e2d,\u6bcf\u6b21\u4ece\u961f\u5217\u9996\u53d6\u51fa\u5143\u7d20\u8fdb\u884c\u66f4\u65b0.\n\n\u4ee3\u7801\u7247\u6bb5\u5982\u4e0b\n\n```cpp\nvoid floodfill(int stx, int sty) {\n    ans++; q.push((POINT){stx, sty}); inqueue[stx][sty]=true; w[stx][sty]=sq[stx][sty];\n    while (!q.empty()) {\n        POINT p=q.front(); q.pop();\n        int nx=p.x, ny=p.y;\n        for (int i=0; i<=3; i++) {\n            int tx=nx+dx[i], ty=ny+dy[i];\n            if (tx<1 || tx>n || ty<1 || ty>m) continue;\n            int height=max(w[nx][ny], abs(sq[tx][ty]));\n            if (height<w[tx][ty]) {\n                w[tx][ty]=height;\n                if (!inqueue[tx][ty]) {q.push((POINT){tx, ty}); inqueue[tx][ty]=true;}\n            }\n        }\n        inqueue[nx][ny]=false;\n    }\n}\n```\n\n\u505a\u5b8c\u4e86\u5417?\u5e76\u6ca1\u6709,\u6211\u4eec\u6109\u5feb\u7684**\u8d85\u65f6**\u4e86\n\n\u539f\u56e0\u4f55\u5728?\u6ce8\u610f\u5230$SPFA$\u5b58\u5728\u91cd\u590d\u5165\u961f\u4e0e\u66f4\u65b0\u7684\u60c5\u51b5,\u56e0\u6b64\u4e3a\u4e86\u5c3d\u91cf\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\u6211\u4eec\u66f4\u65b0\u65f6\u4f18\u5148\u4ece\u5f53\u524d\u6700\u4f4e\u6c34\u4f4d\u66f4\u4f4e\u7684\u70b9\u5f00\u59cb\u66f4\u65b0\u5c3d\u91cf\u4fdd\u8bc1\u5230\u6bcf\u4e00\u70b9\u65f6\u90fd\u83b7\u5f97\u6700\u4f4e\u6c34\u4f4d\u9ad8\u5ea6.\u5177\u4f53\u5b9e\u73b0\u53ea\u9700\u8981\u5c06\u9ad8\u5ea6\u66f4\u4f4e\u7684\u70b9\u5c3d\u91cf\u5411\u961f\u9996\u65b9\u5411\u52a0\u5165\u5373\u53ef.\u7136\u540e\u8fd9\u91cc\u5728\u961f\u5217\u90e8\u5206\u7528\u7684\u662f\u5faa\u73af\u961f\u5217(\u5176\u5b9e\u7406\u8bba\u4e0a\u6765\u8bf4\u8fd9\u91cc\u7528\u4f18\u5148\u961f\u5217\u5e94\u8be5\u4e5f\u53ef\u4ee5,\u4f46\u662f\u6211\u53cd\u6b63$TLE$\u4e86,\u6709\u54ea\u4f4d\u5927\u4f6c\u5199\u51fa\u6765\u4ee5\u540e\u501f\u6211\u770b\u4e00\u770bQAQ)\n\n\u9644\u4e0a\u4ee3\u7801\u7247\u6bb5:\n\n```cpp\nvoid floodfill(int stx, int sty) {\n\tint l=0, r=0; ans++; \n\tq[l].x=stx; q[l].y=sty; inqueue[stx][sty]=true; w[stx][sty]=sq[stx][sty];\n\twhile (l!=r+1) {\n\t\tint nx=q[l].x, ny=q[l].y; l=(l+1)%maxl;\n\t\tfor (int i=0; i<=3; i++) {\n\t\t\tint tx=nx+dx[i], ty=ny+dy[i];\n\t\t\tif (tx<1 || tx>n || ty<1 || ty>m) continue;\n\t\t\t//if (sq[tx][ty]>0 && w[nx][ny]>sq[tx][ty]) continue;\n\t\t\tint height=max(w[nx][ny], abs(sq[tx][ty]));\n\t\t\tif (height<w[tx][ty]) {\n\t\t\t\tw[tx][ty]=height;\n\t\t\t\tif (!inqueue[tx][ty]) {//\u6b64\u65f6\u6211\u4eec\u4f18\u5148\u8bbf\u95ee\u62bd\u6c34\u9ad8\u5ea6\u66f4\u4f4e\u7684 \n\t\t\t\t\tinqueue[tx][ty]=true;\n\t\t\t\t\tif (w[tx][ty]<=w[q[l].x][q[l].y]) {\n                      \tl--; if (l<0) l=maxl-1;q[l].x=tx; q[l].y=ty;} \n\t\t\t\t\telse {r=(r+1)%maxl; q[r].x=tx; q[r].y=ty;}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tinqueue[nx][ny]=false;\n\t}\n}\n```\n\n\u7136\u540e\u5c31AC\u5566!!!\n\n\u9644\u4e0a\u5b8c\u6574AC\u4ee3\u7801:\n\n```cpp\n/*\u5c1d\u8bd5\u4f18\u5316SPFA*/ \n#include <bits/stdc++.h>\nusing namespace std;\nconst int maxn=1100, maxp=maxn*maxn, maxl=1000000;\nconst int dx[]={-1, 0, 0, 1}, dy[]={0, -1, 1, 0};\nstruct POINT {int x, y, h;}point[maxp], q[maxl];\nint n, m, ans=0, cnt=0, sq[maxn][maxn], w[maxn][maxn];\nbool inqueue[maxn][maxn];\n \nint read() {\n\tint x=0, f=1; char ch=getchar();\n\twhile (ch>'9' || ch<'0') {if (ch=='-') f=-1; ch=getchar();}\n\twhile (ch>='0' && ch<='9') {x=x*10+ch-'0'; ch=getchar();}\n\treturn x*f;\n}\nbool cmp(POINT a, POINT b) {return a.h<b.h;}\nvoid init() {\n\tn=read(), m=read();\n\tfor (int i=1; i<=n; i++) \n\t\tfor (int j=1; j<=m; j++) {\n\t\t\tsq[i][j]=read();\n\t\t\tif (sq[i][j]>0) {point[++cnt].x=i; point[cnt].y=j; point[cnt].h=sq[i][j];}\n\t\t}\n\tsort(point+1, point+1+cnt, cmp);\n}\nvoid floodfill(int stx, int sty) {\n\tint l=0, r=0; ans++; \n\tq[l].x=stx; q[l].y=sty; inqueue[stx][sty]=true; w[stx][sty]=sq[stx][sty];\n\twhile (l!=r+1) {\n\t\tint nx=q[l].x, ny=q[l].y; l=(l+1)%maxl;\n\t\tfor (int i=0; i<=3; i++) {\n\t\t\tint tx=nx+dx[i], ty=ny+dy[i];\n\t\t\tif (tx<1 || tx>n || ty<1 || ty>m) continue;\n\t\t\tif (sq[tx][ty]>0 && w[nx][ny]>sq[tx][ty]) continue;\n\t\t\tint height=max(w[nx][ny], abs(sq[tx][ty]));\n\t\t\tif (height<w[tx][ty]) {\n\t\t\t\tw[tx][ty]=height;\n\t\t\t\tif (!inqueue[tx][ty]) {//\u6b64\u65f6\u6211\u4eec\u4f18\u5148\u8bbf\u95ee\u62bd\u6c34\u9ad8\u5ea6\u66f4\u4f4e\u7684 \n\t\t\t\t\tinqueue[tx][ty]=true;\n\t\t\t\t\tif (w[tx][ty]<=w[q[l].x][q[l].y]) {\n\t\t\t\t\t\tl--; if (l<0) l=maxl-1;\n\t\t\t\t\t\tq[l].x=tx; q[l].y=ty;} \n\t\t\t\t\telse {r=(r+1)%maxl; q[r].x=tx; q[r].y=ty;}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tinqueue[nx][ny]=false;\n\t}\n}\nvoid work() {\n\tmemset(w, 0x3f, sizeof(w));//w[i][j]\u8868\u793a\u5f53\u524d\u70b9(i,j)\u5904\u80fd\u4f7f\u6d2a\u6c34\u964d\u4f4e\u5230\u7684\u6700\u4f4e\u9ad8\u5ea6 \n\tfor (int i=1; i<=cnt; i++) \n\t\tif (w[point[i].x][point[i].y]>sq[point[i].x][point[i].y]) floodfill(point[i].x, point[i].y);\n\t/*for (int i=1; i<=n; i++) {\n\t\tfor (int j=1; j<=m; j++) \n\t\t\tprintf(\"%d \", w[i][j]);\n\t\tcout << endl;\n\t}*/\n\tprintf(\"%d\\n\", ans);\n}\nint main() {\n\tinit();\n\twork();\n\treturn 0;\n}\n```\n\n",
        "postTime": 1541579605,
        "uid": 26242,
        "name": "AuSquare",
        "ccfLevel": 0,
        "title": "\u6d1b\u8c37P3457 [POI2007]POW-The Flood\u7ed3\u9898\u62a5\u544a"
    }
]
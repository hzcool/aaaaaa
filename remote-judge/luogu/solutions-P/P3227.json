[
    {
        "content": "## \u6ce8\u610f\uff1a\u672c\u6587\u4e0d\u662f\u9898\u89e3\uff0c\u800c\u662f\u6b63\u786e\u6027\u8bc1\u660e\u3002\n\u4e4b\u524d\u60f3\u8fc7\u8fd9\u4e2a\u95ee\u9898\uff0c\u770b\u5230\u786e\u5b9e\u6709\u5f88\u591a\u4eba\u50cf\u6211\u4e00\u6837\u7684\u5bf9\u6b63\u786e\u6027\u6709\u7591\u95ee\uff0c\u5c31\u5199\u4e00\u4e2a\u8be6\u7ec6\u7684\u8bc1\u660e\u5427\u3002\n\n\u5927\u591a\u6570\u672c\u9898\u89e3\u6cd5\u7ed9\u51fa\u4e86\u8fd9\u6837\u4e00\u4e2a\u5efa\u56fe\u65b9\u5f0f\uff1a\u5efa\u4e00\u6761\u6761\u94fe\uff0c\u5177\u4f53\uff0c\u4ee4 $(a,b)$ \u4e3a\u7b2c $a$ \u6761\u94fe\u7b2c $b$ \u4e2a\u70b9\uff0c\u5efa\u6709\u5411\u8fb9\uff1a\n\n1. $((a,b),(a,b+1),cost_{a,b})$\n2. $ (S,(a,1),\\infty)$\n3. $((a,m),T,\\infty)$\n4. $\\forall x,y,z$ \uff0c$x,y$ \u76f8\u90bb\uff0c$((x,z),(y,z-D),\\infty)$\n\n\u8dd1\u6700\u5c0f\u5272\uff0c\u4ee4\u7b2c $a$ \u4e2a\u70b9\u9009\u4e86\u7b2c $b$ \u4e2a\u4f4d\u7f6e\u8868\u73b0\u4e3a\u5272\u4e86\u8fb9 $((a,b),(a,b+1))$\uff0c\u90a3\u4e48\u7531\u4e8e\u7b2c 4 \u7c7b\u8fb9\uff0c\u4e00\u7ec4\u5408\u6cd5\u7684\u5272\u5fc5\u7136\u6ee1\u8db3 $|a_i-a_j|\\leq D$\uff0c\u6240\u4ee5\u6700\u5c0f\u5272\u5c31\u662f\u7b54\u6848\u3002\n\n\u6ce8\u610f\u5230\u4e86\u5565\uff1f**\u4e0d\u52a0\u8bc1\u660e\u7684\u58f0\u79f0\u4e86\u4e00\u6761\u94fe\u6700\u591a\u5272\u4e00\u6761\u8fb9\u3002** \u4e3a\u5565\u662f\u5bf9\u7684\uff1f\n\n## 1. \u6211\u4eec\u6539\u4e2a\u5efa\u56fe\u5427\uff01\n\u52a0\u7b2c\u4e94\u7c7b\u8fb9\uff1a $((a,b),(a,b-1),\\infty)$ \u5373\u53ef\u3002\u663e\u7136\uff0c\u5728\u4e00\u6761\u94fe\u53ea\u5272\u4e00\u6761\u8fb9\u7684\u60c5\u51b5\u4e0b\uff0c\u52a0\u4e86\u8fd9\u6761\u8fb9\u540e\u539f\u6765\u7684\u5272\u4f9d\u7136\u662f\u5272\u3002\n\n\u6ce8\u610f\u5230\u8fd9\u4e5f\u662f\u9898\u76ee [P6054](https://www.luogu.com.cn/problem/P6054) \u7684\u5904\u7406\u65b9\u5f0f\u3002\n\n\u90a3\u9053\u9898\u7684\u9650\u5236\u7684\u79cd\u7c7b\u66f4\u52a0\u4e30\u5bcc\uff1a\u7ed9 $n$ \u4e2a\u53d8\u91cf $a_i$\uff0c\u7b2c $i$ \u4e2a\u9009 $j$ \u4ee3\u4ef7 $c_{i,j}$ \u4e14\u6709\u82e5\u5e72\u4e2a $a_{v_i}\\geq a_{u_i}+k_i$ \u7684\u9650\u5236\u3002\n\n\u5176\u5b9e\uff0c\u90a3\u8fd9\u9053\u9898\u4e2d\uff0c\u82e5\u4e0d\u5b58\u5728\u6211\u4eec\u65b0\u52a0\u7684\u7b2c\u4e94\u7c7b\u8fb9\uff0c\u5219\u771f\u7684\u6709\u53ef\u80fd\u6700\u4f18\u65b9\u6848\u5272\u4e86\u4e24\u6761\u8fb9\u3002\n\n\u4e3a\u5565\u662f\u5bf9\u7684\uff0c\u9996\u5148\u8003\u8651\u4e00\u4e2a\u5f15\u7406\uff1a\n\n**\u5f15\u7406**\uff1a\u5728\u5272\u53bb\u6700\u5c0f\u5272\u540e\uff0c\u6700\u5c0f\u5272\u7684\u5272\u8fb9 $(u,v)$ \u5fc5\u987b\u6ee1\u8db3 $S\\to u,v\\to T$\uff0c\u5176\u4e2d $\\to$ \u8868\u793a\u53ef\u4ee5\u5230\u8fbe\u3002\n\n**\u8bc1**\uff1a\u82e5 $S\\to u$ \uff0c$v\\to T$ \u4efb\u610f\u4e00\u4e2a\u4e0d\u6210\u7acb\uff0c\u4e0d\u5272\u8fd9\u6761\u8fb9\u4e00\u5b9a\u8fd8\u662f\u4e2a\u5272\uff0c\u4e14\u66f4\u4f18\u3002\n\n\u63a5\u4e0b\u6765\u5c31\u7b80\u5355\u4e86\uff0c\u5047\u8bbe\u6700\u5c0f\u5272\u6709\u4e00\u6761\u94fe\uff0c\u4e0a\u9762\u88ab\u5272\u4e86$\\geq2$ \u6761\u8fb9\uff0c\u90a3\u4e48\u8003\u8651\u76f8\u90bb\u7684\u4e24\u4e2a\u5272\u8fb9\uff0c\u7531\u4e8e\u5f15\u7406\uff0c\u7b2c\u4e00\u4e2a\u5272\u8fb9\u53f3\u8fb9\u53ef\u4ee5\u5230 $T$ \u3001\u7b2c\u4e8c\u4e2a\u5de6\u8fb9\u53ef\u4ee5\u5230 $S$ \uff0c\u90a3\u4e48\u7531\u4e8e\u6709\u7b2c\u4e94\u7c7b\u8fb9\uff0c\u90a3\u4e48\u65e0\u8bba\u600e\u6837\uff0c$S\\to T$\uff0c\u4e0e\u662f\u4e2a\u5272\u77db\u76fe\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6sces8dw.png)\n\n## 2. \u672c\u9898\u7684\u7279\u6b8a\u6027\n\n\u4f46\u672c\u9898\u76f8\u6bd4\u4e8e [P6054](https://www.luogu.com.cn/problem/P6054) \u6709\u4e2a\u7279\u6b8a\u7684\u70b9\uff1a$D\\geq 0$\n\n\n\u82e5\u5b58\u5728\u4e00\u6761\u94fe\u88ab\u5272\u4e24\u6b21\u4ee5\u4e0a\u3002\u73b0\u57fa\u4e8e\u5272\u6389\u6700\u5c0f\u5272\u540e\u7684\u56fe\u5efa\u4e00\u4e2a\u65b0\u56fe\uff1a\n\n\u5bf9\u4e8e\u6bcf\u6761\u94fe\uff0c\u82e5\u5272\u4e86\u82e5\u5e72\u6761\u8fb9\uff1a$((a,k_1),(a,k_1+1)),((a,k_2),(a,k_2+1)),\\cdots((a,k_t),(a,k_t+1)),$\n\n\u90a3\u4e48\uff0c\u5efa $t+1$ \u4e2a\u65b0\u70b9 $[a,1],[a,2],\\cdots [a,t+1]$\uff0c\u4ee3\u8868\u88ab\u5272\u5f00\u7684\u4e00\u6bb5\u4e00\u6bb5\u7684\u94fe\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1z5q0qh9.png)\n\n\u5176\u4e2d\uff0c\u6839\u636e\u524d\u9762\u6240\u8bf4\u7684\u5f15\u7406\uff0c $[a,2]\\cdots,[a,t]$ \u91cc\u9762\u90fd\u5b58\u5728\u70b9\u53ef\u4ee5\u4ece $S$ \u5230\u8fbe\uff0c\u4e5f\u5b58\u5728\u70b9\u53ef\u4ee5\u5230\u8fbe $T$\u3002\n\n\u6240\u4ee5\u5bf9\u4e8e  $[a,2]\\cdots,[a,t]$  \u8fd9\u4e9b\u65b0\u70b9\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u65b0\u70b9 $[a,k]$\uff0c\u8003\u8651\u5b83\u4ee3\u8868\u7684\u70b9\u7684\u533a\u95f4\u6240\u6709\u70b9 $(a,c)$\uff0c\u82e5\u5b58\u5728\u8fb9 $((b,c+D),(a,c),\\infty)$\uff0c\u4e14 $S\\to (b,c+D)$\u3002 \u4e14 $(b,c+D)$ \u5728 $[b,k']$ \u91cc\u9762\uff0c\u90a3\u4e48\u4ece $[b,k']$ \u5411 $[a,k]$ \u8fde\u4e00\u6761\u8fb9\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/45xas4t2.png)\n\uff08\u4f8b\u5982\u672c\u56fe\u4e2d\uff0c\u5047\u8bbe $S\\to$ $[b,2]$ \u7684\u6700\u540e\u4e00\u4e2a\u70b9\uff0c\u90a3\u4e48$[b,2]$ \u5411 $[a,2]$ \u8fde\u4e00\u6761\u8fb9\uff09\n\n\u7531\u4e8e $S$ \u53ef\u4ee5\u5230\u8fbe $[a,i]$ \uff08$2\\leq i\\leq t_a$\uff09\uff0c\u90a3\u4e48\u5bf9\u4e8e\u65b0\u56fe\uff0c\u5fc5\u7136\u5b58\u5728\u8fb9 $([a,1],[b,i])$ \uff08$2\\leq i\\leq t_b$\uff09\u3002\u56e0\u4e3a\u82e5\u4e0d\u5b58\u5728\u8fd9\u6837\u7684\u8fb9\uff0c\u5fc5\u7136\u6240\u6709\u70b9\u90fd\u65e0\u6cd5\u4ece $S$ \u5230\u8fbe\u3002\n\n\u90a3\u4e48\uff0c\u8003\u8651  $([a,1],[b,i])$ \u8fd9\u6761\u8fb9\u5b58\u5728\u5bfc\u81f4\u7684\u95ee\u9898\u5427\u3002\n\n\u7531\u4e8e $D\\geq 0$\uff0c\u6240\u4ee5\u8fb9\u90fd\u662f\u5411\u6e90\u70b9\u65b9\u5411\u8fde\u7684\uff0c\u6240\u4ee5 $[b,i]$ \u91cc\u7b2c\u4e00\u4e2a\u53ef\u4ee5\u88ab $[a,1]$ \u5230\u8fbe\u7684\u70b9\u5fc5\u7136\u4e3a\u6700\u5de6\u7aef\u70b9\u3002\u800c\u53ef\u4ee5\u5230\u8fbe\u6700\u5de6\u7aef\u70b9\u5219\u610f\u5473\u7740\u53ef\u4ee5\u5230\u8fbe\u6240\u6709\u70b9\uff0c\u800c\u56de\u987e\u4e4b\u524d\u6211\u4eec\u8bf4\u7684\u4e00\u5b9a\u5b58\u5728\u4e00\u4e2a\u70b9\u53ef\u4ee5\u5230\u8fbe $T$\uff0c\u8fd9\u610f\u5473\u7740 $S\\to T$\uff0c\u77db\u76fe\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/w9zbopy2.png)\n\n\u7efc\u4e0a\uff0c\u4e00\u5b9a\u4e0d\u5b58\u5728\u70b9 $[a,i]$ \uff08$2\\leq i\\leq t_a$\uff09\uff0c\u4e5f\u5c31\u662f\u6bcf\u6761\u94fe\u5fc5\u7136\u5272\u4e00\u6761\u8fb9\u3002\u5f97\u8bc1\u3002\n\n\u81f3\u4e8e\u95ee\u6211\u4e3a\u5565 $D<0$ \u8fd9\u4e2a\u8bc1\u660e\u5c31\u4e0d\u884c\u4e86\uff0c\u8003\u8651\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0usfl1n2.png)\n\n\u5de6\u8fb9\u7684\u90a3\u6761\u865a\u7ebf\u8fb9\u4e0d\u5b58\u5728\u3002\u6240\u4ee5\u8bc1\u660e\u65e0\u6cd5\u8fdb\u884c\u4e0b\u53bb\u3002\u5c31\u771f\u7684\u6709\u53ef\u80fd\u51fa\u73b0\u4e24\u4e2a\u5272\u8fb9\u4e4b\u95f4\uff0c\u524d\u9762\u4e00\u6bb5\u53ef\u4ee5\u5230 $T$ \u540e\u9762\u4e00\u6bb5\u53ef\u4ee5\u4ece $S$ \u5230\u8fbe\u7684\u5408\u6cd5\u7684\u4e24\u4e2a\u5272\u8fb9\u7684\u60c5\u51b5\u4e86\u3002\n\n\u5176\u5b9e\u6839\u636e\u8fd9\u4e2a\u8bc1\u660e\u4e0d\u96be\u60f3\u5230\u53e6\u4e00\u79cd\u89e3\u51b3 [P6054](https://www.luogu.com.cn/problem/P6054) \u7684\u65b9\u5f0f\uff1a\u624b\u52a8\u628a\u7f3a\u7684\u90a3\u4e9b\u8fb9\u8865\u4e0a\u5c31\u597d\u3002\u5bf9\u4e8e $a_{v_i}\\geq a_{u_i}+k_i$ \u7684\u9650\u5236\uff0c\u82e5 $k_i>0$ \u90a3\u4e48\u4ece $S$ \u5f00\u59cb\u5411 $(v_i,1),\\cdots (v_i,k_i)$ \u8fde $\\infty$ \u8fb9\uff0c\u628a\u90a3\u4e9b\u7f3a\u5c11\u7684\u8fb9\u8865\u4e0a\u5c31\u597d\u3002",
        "postTime": 1620311142,
        "uid": 62598,
        "name": "dengyaotriangle",
        "ccfLevel": 10,
        "title": "P3227 [HNOI2013]\u5207\u7cd5 \u5efa\u56fe\u8bc1\u660e"
    },
    {
        "content": "# \u300c\u9898\u89e3\u300d\u300cHNOI2013\u300d\u5207\u7cd5\n\n## \u9898\u76ee\u63cf\u8ff0\n\n[\u70b9\u8fd9\u91cc](https://www.luogu.com.cn/problem/P3227)\n\n## \u601d\u8def\u5206\u6790\u53ca\u4ee3\u7801\n\n### \u9898\u76ee\u5206\u6790\n\n\u8fd9\u9053\u9898\u7684\u9898\u76ee\u53ef\u4ee5\u8bf4\u5f97\u4e0a\u662f\u53f2\u4e0a\u6700\u96be\u770b\u61c2\u7684\u9898\u76ee\u4e4b\u4e00\u4e86...\n\n\u9996\u5148\u628a\u9898\u76ee\u91cd\u65b0\u53d9\u8ff0\u4e00\u904d\u3002\n\n\u9898\u76ee\u5927\u81f4\u5728\u8bf4\uff0c\u4f60\u6709\u4e00\u4e2a $P\\times Q\\times R$ \u7684\u86cb\u7cd5\uff0c\u6bcf\u4e2a\u70b9\u6709\u4e00\u4e2a\u4e0d\u5ba2\u89c2\u5ea6 $v[i][j][k]$ \uff0c\u73b0\u5728\u4f60\u8981\u628a\u8fd9\u4e2a\u86cb\u7cd5\u5207\u5f00\u3002\n\n\u5207\u86cb\u7cd5\u7684\u89c4\u5219\u662f\u4ec0\u4e48\u5462\uff1f\n\n\u9996\u5148\u6211\u4eec\u89e3\u91ca\u4e00\u4e0b\uff1a\n\n\u5bf9\u4e8e\u6bcf\u4e00\u7ad6\u5217\uff0c\u8fd9\u4e2a\u7ad6\u5217\u7684\u5750\u6807\u7528 $(x,y)$ \u8868\u793a\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9\u4e2a\u7ad6\u5217\u4e0a\u7684\u70b9\u7684\u5750\u6807\u53ef\u4ee5\u8868\u793a\u4e3a $(x,y,i)|i\\in [1,R]$ \u3002\n\n\u90a3\u4e48\uff0c\u89c4\u5219\u5f88\u597d\u63cf\u8ff0\uff1a\n\n\u6211\u4eec\u8981\u5728\u6240\u6709\u7684 $P\\times Q$ \u4e2a\u7ad6\u5217\u4e2d\uff0c\u6bcf\u4e2a\u7ad6\u5217\u9009**\u4e00\u4e2a**\u70b9\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u7ad6\u5217 $(x,y)$ \u4e2d\uff0c\u628a\u6211\u4eec\u9009\u7684\u70b9\u7684\u9ad8\u8868\u793a\u4e3a $f(x,y)$ \u3002\n\n\u90a3\u4e48\u5f88\u597d\u6709 $1\\le f(x,y)\\le R$ \u3002\n\n\u800c\u6211\u4eec\u9009\u7684\u70b9\u7684\u5750\u6807\u5c31\u662f $(x,y,f(x,y))$ \u3002\n\n>\u7ad6\u5217\u76f8\u90bb\uff1a\u5bf9\u4e8e\u4e00\u4e2a\u5750\u6807\u4e3a $(x,y)$ \u7684\u7ad6\u5217\uff0c\u76f8\u90bb\u5373\u6307\u5750\u6807\u4e3a $(i+1,j)\u3001(i-1,j)\u3001(i,j+1)\u3001(i,j-1)$ \u7684\u7ad6\u5217\u3002\n\n\u4f46\u662f\u6709\u4e00\u4e2a\u9650\u5236\uff0c\u5bf9\u4e8e**\u76f8\u90bb**\u7684\u7ad6\u5217\uff0c\u5728\u4ed6\u4eec\u4e0a\u6240\u9009\u62e9\u7684\u70b9\u7684\u9ad8\u5ea6\u5dee\u4e0d\u8d85\u8fc7 $D$ \uff0c\u5373\uff1a\n\n$$|f(x,y)-f(x,y\\pm1)|\\le D\\space, \\space |f(x,y)-f(x\\pm 1,y)|\\le D$$\n\n\u800c\u73b0\u5728\u6211\u4eec\u7684\u76ee\u7684\u662f\uff0c\u5bf9\u4e8e\u6211\u4eec\u6240\u6709\u9009\u51fa\u7684\u70b9\uff0c\u4f7f\u5f97 $\\sum v[i][j][f(i,j)]$ \u6700\u5c0f\u3002\n\n### \u9898\u89e3\u53ca\u4ee3\u7801\n\n\u8fd9\u9053\u9898\u600e\u4e48\u601d\u8003\uff1f\n\n\u9996\u5148\uff0c\u6211\u4eec\u8003\u8651\uff1a\u5982\u679c\u6ca1\u6709\u8fd9\u4e2a $D$ \uff0c\u6211\u4eec\u5e94\u8be5\u600e\u4e48\u505a\uff1f\n\n\u8fd9\u4e2a\u9898\u5c31\u8f6c\u5316\u4e3a\uff1a\u6c42\u6bcf\u4e00\u7ad6\u5217\u7684\u6700\u77ed\u8fb9\u4e4b\u548c\u3002\n\n\u8fd9\u6837\u7684\u95ee\u9898\uff0c\u4f3c\u4e4e\u51e0\u4e2a\u5faa\u73af\u5c31\u53ef\u4ee5\u89e3\u51b3\u3002\n\n\u4f46\u662f\uff0c\u8fd9\u6837\u7684\u9898\u662f\u5426\u6709\u4e9b\u50cf**\u6700\u5c0f\u5272\u95ee\u9898**\uff1f\n\n\u90a3\u4e48\uff0c\u6b64\u9898\u7684\u65b9\u6cd5\u547c\u4e4b\u6b32\u51fa\uff1a\u7f51\u7edc\u6d41\u6700\u5927\u6d41\u6700\u5c0f\u5272\u95ee\u9898\u3002\n\n\u5982\u679c\u89e3\u51b3 `\u6bcf\u4e00\u7ad6\u5217\u7684\u6700\u77ed\u8fb9\u4e4b\u548c` \u8fd9\u6837\u7684\u95ee\u9898\u7528\u7f51\u7edc\u6d41\uff0c\u5efa\u56fe\u65b9\u6cd5\u5f88\u7b80\u5355\uff1a\n\n\u5efa\u7acb\u7b2c $0$ \u5c42\u4e0e\u7b2c $R+1$ \u5c42\uff0c\u7136\u540e\u6709\u8fd9\u6837\u7684\u8fde\u8fb9\u5173\u7cfb\uff1a\n\n>$S->(i,j,1),flow=INF$\n>\n>$(i,j,k)->(i,j,k+1),flow=v[i][j][k]|k\\in [1,R)$\n>\n>$(i,j,r)->T,flow=v[i][j][r]$\n\n\u4f46\u662f\u5bf9\u4e8e\u6b64\u9898\uff0c\u6211\u4eec\u8fd8\u6709 $D$ \u7684\u9650\u5236\u3002\n\n\u73b0\u5728\u8003\u8651\u600e\u4e48\u628a\u8fd9\u6837\u7684\u9650\u5236\u8003\u8651\u8fdb\u6211\u4eec\u7684\u7f51\u7edc\u6d41\u3002\n\n\u5047\u8bbe\u6211\u4eec\u6709\u8fd9\u6837\u4e00\u4e2a\u56fe\uff1a\n\n![graph.png](https://i.postimg.cc/FFkMrF2j/graph-3.png)\n\n\u5176\u4e2d\uff0c $A=\\{p1,p2,p3,p4\\}$ \u4ee3\u8868\u7b2c $a$ \u5217\uff0c $B=\\{p5,p6,p7,p8\\}$ \u4ee3\u8868\u7b2c $b$ \u5217\u3002\n\n\u65ad\u8a00\uff0c\u73b0\u5728\u7684 $D$ \u7684\u503c\u4e3a $1$ \u3002\n\n\u90a3\u4e48\uff0c\u4ece\u9898\u76ee\u7684\u8868\u793a\u6765\u8bf4\uff0c\u5047\u8bbe\u6211\u4eec\u5728 $A$ \u4e2d\u9009\u62e9\u4e86 $p3$ \uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ea\u80fd\u5728 $B$ \u4e2d\u9009\u62e9 $p6,p7,p8$ \u3002\n\n\u73b0\u5728\uff0c\u6211\u4eec\u505a\u4e00\u4e2a\u5c1d\u8bd5\uff0c\u8fde\u63a5\u4e00\u6761\u8fb9 $edge\\{p3,p6\\}$ \u3002\n\n![](https://i.postimg.cc/44c0CL9P/graph-2.png)\n\n\u90a3\u4e48\uff0c\u5982\u679c\u6211\u4eec\u518d\u8dd1\u6700\u5927\u6d41\u65f6\uff0c\u5982\u679c\u6211\u4eec\u5c06 $edge\\{p5,p6\\}$ \u5220\u6389\uff0c\u5bf9 $path\\{S,p1,p2,p3,p6,p7,p8\\}$ \u4f3c\u4e4e\u6ca1\u6709\u5f71\u54cd\u3002\n\n\u4f46\u662f\u53c8\u6709\u4e00\u4e2a\u95ee\u9898\uff1a\u5982\u679c\u6211\u4eec\u9009\u7684\u70b9\u6bd4 $p3$ \u9ad8**\u51fa**\u4e86 $D$ \u5462\uff1f\n\n\u5176\u5b9e\u8fd9\u4e2a\u95ee\u9898\u662f\u4e00\u6837\u7684\uff1a\u6211\u4eec\u8fde\u63a5 $edge\\{p8,p3\\}$ \uff0c\u90a3\u4e48\u5c31\u6709\u8fd9\u4e2a\u56fe\uff1a\n\n![](https://i.postimg.cc/7YYQCxRs/graph-4.png)\n\n\u90a3\u4e48\u95ee\u9898\u5c31\u89e3\u51b3\u4e86\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u89e3\u51b3 $D$ \u5bf9\u4e8e\u6211\u4eec\u7684\u9650\u5236\uff0c\u5c31\u662f\u518d\u6dfb\u52a0\u51e0\u6761\u8fb9\u6761\u8fb9\uff1a\n\n> $(i,j,k)->(i\\pm 1,j,k-d)$\n>\n> $(i,j,k)->(i,j\\pm 1,k-d)$\n>\n> \u5bf9\u4e8e $k$ \uff0c\u6ee1\u8db3 $k>d$\n\n\u90a3\u4e48\uff0c\u8fd9\u4e2a\u9898\u5c31\u7b97\u662f\u89e3\u51b3\u4e86\u3002\n\n\u63a5\u4e0b\u6765\u662f\u4ee3\u7801\u3002\n\n```cpp\n#include<cstdio>\n#include<queue>\nusing namespace std;\n\n#define rep(i,__l,__r) for(int i=__l,i##_end_=__r;i<=i##_end_;++i)\n#define fep(i,__l,__r) for(int i=__l,i##_end_=__r;i>=i##_end_;--i)\n#define writc(a,b) fwrit(a),putchar(b)\n#define mp(a,b) make_pair(a,b)\n#define ft first\n#define sd second\n#define LL long long\n#define ull unsigned long long\n#define pii pair<int,int>\n#define Endl putchar('\\n')\n// #define FILEOI\n// #define int long long\n\n#ifdef FILEOI\n    #define MAXBUFFERSIZE 500000\n    inline char fgetc(){\n        static char buf[MAXBUFFERSIZE+5],*p1=buf,*p2=buf;\n        return p1==p2&&(p2=(p1=buf)+fread(buf,1,MAXBUFFERSIZE,stdin),p1==p2)?EOF:*p1++;\n    }\n    #undef MAXBUFFERSIZE\n    #define cg (c=fgetc())\n#else\n    #define cg (c=getchar())\n#endif\ntemplate<class T>inline void qread(T& x){\n    char c;bool f=0;\n    while(cg<'0'||'9'<c)f|=(c=='-');\n    for(x=(c^48);'0'<=cg&&c<='9';x=(x<<1)+(x<<3)+(c^48));\n    if(f)x=-x;\n}\ninline int qread(){\n    int x=0;char c;bool f=0;\n    while(cg<'0'||'9'<c)f|=(c=='-');\n    for(x=(c^48);'0'<=cg&&c<='9';x=(x<<1)+(x<<3)+(c^48));\n    return f?-x:x;\n}\ntemplate<class T,class... Args>inline void qread(T& x,Args&... args){qread(x),qread(args...);}\ntemplate<class T>inline T Max(const T x,const T y){return x>y?x:y;}\ntemplate<class T>inline T Min(const T x,const T y){return x<y?x:y;}\ntemplate<class T>inline T fab(const T x){return x>0?x:-x;}\ninline int gcd(const int a,const int b){return b?gcd(b,a%b):a;}\ninline void getInv(int inv[],const int lim,const int MOD){\n    inv[0]=inv[1]=1;for(int i=2;i<=lim;++i)inv[i]=1ll*inv[MOD%i]*(MOD-MOD/i)%MOD;\n}\ntemplate<class T>void fwrit(const T x){\n    if(x<0)return (void)(putchar('-'),fwrit(-x));\n    if(x>9)fwrit(x/10);putchar(x%10^48);\n}\ninline LL mulMod(const LL a,const LL b,const LL mod){//long long multiplie_mod\n    return ((a*b-(LL)((long double)a/mod*b+1e-8)*mod)%mod+mod)%mod;\n}\n\nconst int MAXP=40;\nconst int INF=(1<<30)-1;\n\nint p,q,r,d,S,T;\nint v[MAXP+5][MAXP+5][MAXP+5];\n\nstruct edge{\n    int to,nxt,w;\n    edge(){}\n    edge(const int T,const int N,const int W):to(T),nxt(N),w(W){}\n}e[(MAXP*MAXP*MAXP*10)+5];\nint tail[MAXP*MAXP*MAXP*MAXP+5],ecnt;\nint cur[MAXP*MAXP*MAXP*MAXP+5];\ninline void add_edge(const int u,const int v,const int w){\n    // printf(\"add_edge:>u == %d, v == %d, w == %d\\n\",u,v,w);\n    e[++ecnt]=edge(v,tail[u],w);tail[u]=ecnt;\n}\n\ninline int id(const int x,const int y,const int z){return x*40*40+y*40+z;}\n\ninline bool inside(const int x,const int y,const int z){\n    return 0<x && x<=p && 0<y && y<=q && 0<z && z<=r;\n}\n\nint dis[MAXP*MAXP*MAXP*MAXP+5];\ninline bool bfs(){\n    rep(i,0,id(p,q,r)+1)dis[i]=-1;\n    dis[S]=0;\n    queue<int>Q;Q.push(S);\n    while(!Q.empty()){\n        int u=Q.front();Q.pop();\n        for(int i=tail[u],v;i;i=e[i].nxt){\n            v=e[i].to;\n            if(dis[v]!=-1 || e[i].w<=0)continue;\n            dis[v]=dis[u]+1;\n            Q.push(v);\n        }\n    }\n    return dis[T]!=-1;\n}\n\nint dfs(const int u,int inflow){\n    if(u==T)return inflow;\n    int sum=0,tmp,v;\n    for(int& i=cur[u];i;i=e[i].nxt){\n        v=e[i].to;\n        if(dis[v]!=dis[u]+1 || e[i].w<=0)continue;\n        tmp=dfs(v,Min(inflow-sum,e[i].w));\n        e[i].w-=tmp,e[i^1].w+=tmp;\n        if((sum+=tmp)>=inflow)break;\n    }\n    return sum;\n}\n\ninline int dinic(){\n    int max_flow=0;\n    while(bfs()){\n        rep(i,0,id(p,q,r)+1)cur[i]=tail[i];\n        max_flow+=dfs(S,INF);\n    }\n    return max_flow;\n}\n\nsigned main(){\n#ifdef FILEOI\n    freopen(\"file.in\",\"r\",stdin);\n    freopen(\"file.out\",\"w\",stdout);\n#endif\n    ecnt=1;\n    qread(p,q,r,d);\n    S=0,T=id(p,q,r)+1;\n    // printf(\"S == %d, T == %d\\n\",S,T);\n    rep(k,1,r)rep(i,1,p)rep(j,1,q)qread(v[i][j][k]);\n    rep(i,1,p)rep(j,1,q){\n        add_edge(S,id(i,j,1),INF);\n        add_edge(id(i,j,1),S,0);\n    }\n    rep(k,1,r-1)rep(i,1,p)rep(j,1,q){\n        add_edge(id(i,j,k),id(i,j,k+1),v[i][j][k]);\n        add_edge(id(i,j,k+1),id(i,j,k),0);\n        if(k<=d)continue;\n        // puts(\"the special edge:\");\n        if(inside(i+1,j,k-d)){\n            add_edge(id(i,j,k),id(i+1,j,k-d),INF);\n            add_edge(id(i+1,j,k-d),id(i,j,k),0);\n        }\n        if(inside(i-1,j,k-d)){\n            add_edge(id(i,j,k),id(i-1,j,k-d),INF);\n            add_edge(id(i-1,j,k-d),id(i,j,k),0);\n        }\n        if(inside(i,j+1,k-d)){\n            add_edge(id(i,j,k),id(i,j+1,k-d),INF);\n            add_edge(id(i,j+1,k-d),id(i,j,k),0);\n        }\n        if(inside(i,j-1,k-d)){\n            add_edge(id(i,j,k),id(i,j-1,k-d),INF);\n            add_edge(id(i,j-1,k-d),id(i,j,k),0);\n        }\n        // puts(\"-------------end-------------\");\n    }\n    rep(i,1,p)rep(j,1,q){\n        add_edge(id(i,j,r),T,v[i][j][r]);\n        add_edge(T,id(i,j,r),0);\n        if(r<=d)continue;\n        // puts(\"the special edge:\");\n        if(inside(i+1,j,r-d)){\n            add_edge(id(i,j,r),id(i+1,j,r-d),INF);\n            add_edge(id(i+1,j,r-d),id(i,j,r),0);\n        }\n        if(inside(i-1,j,r-d)){\n            add_edge(id(i,j,r),id(i-1,j,r-d),INF);\n            add_edge(id(i-1,j,r-d),id(i,j,r),0);\n        }\n        if(inside(i,j+1,r-d)){\n            add_edge(id(i,j,r),id(i,j+1,r-d),INF);\n            add_edge(id(i,j+1,r-d),id(i,j,r),0);\n        }\n        if(inside(i,j-1,r-d)){\n            add_edge(id(i,j,r),id(i,j-1,r-d),INF);\n            add_edge(id(i,j-1,r-d),id(i,j,r),0);\n        }\n        // puts(\"-------------end-------------\");\n    }\n    int ret=dinic();\n    writc(ret,'\\n');\n    return 0;\n}\n```\n\n**\u4e00\u9053\u5341\u5206\u597d\u7684\u9898**\u3002",
        "postTime": 1576065343,
        "uid": 125355,
        "name": "Vladilena",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3227 \u3010[HNOI2013]\u5207\u7cd5\u3011"
    },
    {
        "content": "\u628a\u5207\u70b9\u770b\u4f5c\u5272\u8fb9\u3002\u65b0\u5efa\u4e00\u4e2a\u865a\u62df\u7684\u5c42$R+1$\uff0c\u5efa\u7acb\u6e90\u70b9$S,T$\u3002\n\n\u5148\u4e0d\u8003\u8651\u5149\u6ed1\u9650\u5236\u3002\u5148\u7531\u6e90\u70b9$S$\u5411\u7b2c$1$\u5c42\u7684\u6bcf\u4e00\u4e2a\u70b9\u8fde\u4e00\u6761\u8fb9\uff0c\u518d\u7531\u7b2c$R+1$\u5c42\u7684\u6bcf\u4e00\u4e2a\u70b9\u5411\u6c47\u70b9$T$\u8fde\u4e00\u6761\u8fb9\uff0c\u8fd9\u4e9b\u8fb9\u662f\u5272\u4e0d\u6389\u7684\uff0c\u6240\u4ee5\u5bb9\u91cf\u90fd\u4e3a$INF$\u3002\n\n\u7136\u540e\u5bf9\u4e8e\u4efb\u4f55\u4e00\u4e2a$1\\leq i\\leq P,1\\leq j\\leq Q,1\\leq k\\leq R$\uff0c\u7531$(i,j,k)$\u5411$(i,j,k+1)$\u8fde\u4e00\u6761\u5bb9\u91cf\u4e3a$(i,j,k)$\u7684\u4e0d\u548c\u8c10\u503c\u7684\u8fb9\u3002\n\n\u663e\u7136\uff0c\u5bf9\u4e8e\u4efb\u4f55\u4e00\u4e2a$1\\leq i\\leq P,1\\leq j\\leq Q$\uff0c\u4ece$(i,j,1)$\u5230$(i,j,R+1)$\u7684\u8def\u5f84\u4e0a\u9700\u8981\u4e14\u53ea\u9700\u8981\u5272\u6389\u4e00\u6761\u8fb9\u3002\n\n\u518d\u8003\u8651\u5149\u6ed1\u9650\u5236\u3002\u53ef\u4ee5\u53d1\u73b0\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u5728\u540c\u4e00\u5e73\u9762\u4e0a\u8ddd\u79bb\u4e3a$1$\u7684\u4e24\u4e2a\u70b9\u5bf9$(i,j),(x,y)$\uff0c\u5176\u5b9e\u53ea\u8981\u9650\u5236$f(i,j)-f(x,y)\\leq D$\u5c31\u53ef\u4ee5\u4e86\uff08\u56e0\u4e3a\u5982\u679c\u6709\u5b58\u5728$f(i,j)-f(x,y)<-D$\uff0c\u90a3\u4e48\u4e00\u5b9a\u6709$f(x,y)-f(i,j)>D$\uff0c\u81ea\u7136\u4e0d\u7b26\u5408\u6761\u4ef6\uff09\u3002\n\n\u600e\u6837\u9650\u5236\u8fd9\u4e2a\u6761\u4ef6\u5462\uff1f\u53ef\u4ee5\u53d1\u73b0\uff0c\u6211\u4eec\u7684\u76ee\u6807\u5176\u5b9e\u5c31\u662f\u8ba9$f(i,j)-f(x,y)>D$\u65f6\uff0c$S$\u4ecd\u7136\u53ef\u4ee5\u5230\u8fbe$T$\u3002\u4e5f\u5c31\u662f\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u5728\u540c\u4e00\u5e73\u9762\u4e0a\u8ddd\u79bb\u4e3a$1$\u7684\u4e24\u4e2a\u70b9\u5bf9$(i,j),(x,y)$\uff0c\u5bf9\u4e8e\u4efb\u4f55\u4e00\u4e2a$D+1\\leq k\\leq R+1$\uff0c\u7531$(i,j,k)$\u5411$(x,y,k-D)$\u8fde\u4e00\u6761\u5bb9\u91cf\u4e3a$INF$\uff08\u5272\u4e0d\u6389\uff09\u7684\u8fb9\u3002\n\n\u6700\u540e\u6c42\u6700\u5c0f\u5272\uff08\u6700\u5927\u6d41\uff09\u5373\u4e3a\u7b54\u6848\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\ninline int read() {\n    int res = 0; bool bo = 0; char c;\n    while (((c = getchar()) < '0' || c > '9') && c != '-');\n    if (c == '-') bo = 1; else res = c - 48;\n    while ((c = getchar()) >= '0' && c <= '9')\n        res = (res << 3) + (res << 1) + (c - 48);\n    return bo ? ~res + 1 : res;\n}\nconst int W = 45, N = 3e5 + 5, INF = 0x3f3f3f3f;\nint P, Q, R, D, S, T, val[W][W][W], ecnt = 1, nxt[N], adj[N], go[N], cap[N],\nlev[N], len, que[N], dx[] = {-1, 1, 0, 0}, dy[] = {0, 0, -1, 1};\nvoid add_edge(int u, int v, int w) {\n    nxt[++ecnt] = adj[u]; adj[u] = ecnt; go[ecnt] = v; cap[ecnt] = w;\n    nxt[++ecnt] = adj[v]; adj[v] = ecnt; go[ecnt] = u; cap[ecnt] = 0;\n}\nbool bfs() {\n    int i; memset(lev, -1, sizeof(lev));\n    lev[que[len = 1] = S] = 0;\n    for (i = 1; i <= len; i++) {\n        int u = que[i];\n        for (int e = adj[u], v; e; e = nxt[e])\n            if (cap[e] > 0 && lev[v = go[e]] == -1) {\n                lev[que[++len] = v] = lev[u] + 1;\n                if (v == T) return 1;\n            }\n    }\n    return 0;\n}\nint dinic(int u, int flow) {\n    if (u == T) return flow;\n    int res = 0, delta;\n    for (int e = adj[u], v; e; e = nxt[e])\n        if (cap[e] > 0 && lev[u] < lev[v = go[e]]) {\n            delta = dinic(v, min(cap[e], flow - res));\n            if (delta) {\n                cap[e] -= delta; cap[e ^ 1] += delta;\n                res += delta; if (res == flow) break;\n            }\n        }\n    if (res != flow) lev[u] = -1;\n    return res;\n}\nint solve() {\n    int ans = 0;\n    while (bfs()) ans += dinic(S, INF);\n    return ans;\n}\nint main() {\n    int i, j, k, h; P = read(); Q = read();\n    R = read(); D = read(); S = 1; T = P * Q * (R + 1) + 2;\n    for (k = 1; k <= R; k++) for (i = 1; i <= P; i++)\n    for (j = 1; j <= Q; j++) val[i][j][k] = read();\n    for (i = 1; i <= P; i++) for (j = 1; j <= Q; j++) {\n        int x = (i - 1) * Q + j + 1;\n        add_edge(S, x, INF); for (k = 1; k <= R; k++)\n        add_edge(P * Q * (k - 1) + x, P * Q * k + x, val[i][j][k]);\n        add_edge(P * Q * R + x, T, INF);\n    }\n    for (i = 1; i <= P; i++) for (j = 1; j <= Q; j++)\n    for (h = 0; h < 4; h++) {\n        int x = i + dx[h], y = j + dy[h];\n        if (x < 1 || x > P || y < 1 || y > Q) continue;\n        for (k = D + 1; k <= R + 1; k++)\n            add_edge(P * Q * (k - 1) + (i - 1) * Q + j + 1,\n            P * Q * (k - D - 1) + (x - 1) * Q + y + 1, INF);\n    }\n    printf(\"%d\\n\", solve());\n    return 0;\n}\n```",
        "postTime": 1508640913,
        "uid": 29936,
        "name": "xyz32768",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3227 \u3010[HNOI2013]\u5207\u7cd5\u3011"
    },
    {
        "content": "## \u5e7f\u4e49\u5207\u7cd5\u6a21\u578b\u4e4b\u6700\u5c0f\u5272\u79bb\u6563\u53d8\u91cf\u6a21\u578b\n### Preface\n2016 \u5e74\u7684\u5019\u9009\u961f\u8bba\u6587\u300a\u7f51\u7edc\u6d41\u7684\u4e00\u4e9b\u5efa\u6a21\u65b9\u6cd5\u300b\uff08\u59dc\u5fd7\u8c6a\uff09\u7ed9\u51fa\u4e86\u4e00\u79cd\u6700\u5c0f\u5272\u5efa\u6a21\u65b9\u6cd5\u2014\u2014\u6700\u5c0f\u5272\u79bb\u6563\u53d8\u91cf\u6a21\u578b .\n\n\u4ee5\u4e0b $\\infty$ \u5747\u4e3a**\u6b63**\u65e0\u7a77 .\n\n### Solution\n\n> **\u6700\u5c0f\u5272\u79bb\u6563\u53d8\u91cf\u6a21\u578b**\n>\n> $n$ \u4e2a\u53d8\u91cf $\\{x_n\\}$\uff0c\u6bcf\u4e2a\u53d8\u91cf\u7684\u53d6\u503c\u8303\u56f4\u4e3a $x_i\\in[1,m_i]\\cap\\mathbb Z$\uff0c\u6bcf\u4e24\u4e2a\u53d8\u91cf\u4e4b\u95f4\u4f1a\u5bf9\u7b54\u6848\u4ea7\u751f\u8d21\u732e\uff08\u4e00\u822c\u548c\u4e24\u53d8\u91cf\u5dee\u6709\u5173\uff09\uff0c\u6211\u4eec\u8981\u6700\u5927\u5316 / \u6700\u5c0f\u5316\u8fd9\u4e2a\u8d21\u732e .\n>\n> \u5efa\u56fe\u65b9\u5f0f\u4e00\u822c\u5c31\u662f\u5bf9\u6bcf\u4e2a\u53d8\u91cf $x_i$ \u62c6\u6210 $m_i+1$ \u4e2a\u70b9\u4e32\u6210\u4e00\u4e2a\u6e90\u70b9 $s$ \u5230\u6c47\u70b9 $t$ \u7684\u94fe\uff0c\u5272\u54ea\u6761\u8fb9\u5c31\u4ee3\u8868\u53d6\u90a3\u4e2a\u503c\uff0c\u8d21\u732e\u7528\u4e24\u6761\u94fe\u76f4\u63a5\u7684\u8fde\u8fb9\u8868\u8fbe\uff0c\u4e8e\u662f\u5c31\u53d8\u6210\u6700\u5c0f\u5272\u5f62\u5f0f\u4e86 .\n\n\u5bf9\u4e8e\u8fd9\u4e2a\u9898\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u70b9 $(i,j)$\uff0c\u5176\u4e2d $1\\le i\\le P,1\\le j\\le Q$\uff0c\u5c31\u76f8\u5f53\u4e8e\u6709\u4e00\u4e2a\u53d8\u91cf $x_{i,j}$\uff0c\u53d6\u503c\u4e3a\u5bf9\u4e8e $1\\le k\\le R$ \u7684\u4e0d\u548c\u8c10\u503c $v(i,j,k)$ .\n\n\u6ce8\u610f\u5230\u6709\u4e00\u4e2a\u5149\u6ed1\u5ea6\u9650\u5236\uff0c\u6ce8\u610f\u5230\u6700\u5c0f\u5272\u4e2d $\\infty$ \u8fb9\u4e0d\u53ef\u80fd\u88ab\u9009\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u501f\u52a9\u4e00\u6761 $\\infty$ \u8fb9 $u\\overset{\\infty}{\\to} v$\uff0c\u6765\u9650\u5236 $s,u$ \u548c $v,t$ \u4e0d\u540c\u65f6\u8fde\u901a .\n\n\u4e8e\u662f\u6211\u4eec\u5bf9\u6bcf\u4e2a\u70b9\u5411\u5468\u56f4\u80fd\u8fde\u7684\u6700\u8fdc\u70b9\u8fde\u4e00\u6761 $\\infty$ \u8fb9\u5c31\u53ef\u4ee5\u89e3\u51b3\u95ee\u9898\u4e86\uff0c\u53ef\u4ee5\u753b\u4e00\u4e0b\u8fd9\u4e2a\u56fe\u7684\u6837\u5b50\uff0c\u4e00\u4e2a\u53ef\u884c\u7684\u6700\u5c0f\u5272\u5fc5\u7136\u5bf9\u5e94\u4e00\u7ec4\u53ef\u884c\u6700\u4f18\u89e3 .\n\n\u5efa\u56fe\u5efa\u597d\u4e86\u76f4\u63a5\u8dd1\u6700\u5c0f\u5272\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f\u6700\u5c0f\u5272\u590d\u6742\u5ea6 .\n\n[\u300c\u5f00\u95e8\u5927\u5409\u300d](https://www.luogu.com.cn/problem/P6054)\u4e00\u9898\u7ed9\u51fa\u4e86\u4e00\u4e2a\u66f4\u4e00\u822c\u7684\u95ee\u9898\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u505a\u4e00\u4e0b .\n\n### Code\n```cpp\ndinic F;\nint p, q, r, d, v[L][L][L];\ninline int node(int i, int j, int k){return i * 1600 + j * 40 + k;}\nint main()\n{\n\tscanf(\"%d%d%d%d\", &p, &q, &r, &d); int s = 1, t = 2;\n\tfor (int k=1; k<=r; k++)\n\t\tfor (int i=1; i<=p; i++)\n\t\t\tfor (int j=1; j<=q; j++) scanf(\"%d\", v[i][j] + k);\n\tfor (int i=1; i<=p; i++)\n\t\tfor (int j=1; j<=q; j++)\n\t\t{\n\t\t\tF.addedge(s, node(i, j, 1), v[i][j][1]); F.addedge(node(i, j, r), t, INF);\n\t\t\tfor (int k=2; k<=r; k++) F.addedge(node(i, j, k-1), node(i, j, k), v[i][j][k]);\n\t\t}\n\tfor (int i=1; i<=p; i++)\n\t\tfor (int j=1; j<=q; j++)\n\t\t\tfor (int k=1; k<=r-d; k++)\n\t\t\t{\n\t\t\t\tif (inrange(i+1, 1, p)) F.addedge(node(i+1, j, k+d), node(i, j, k), INF);\n\t\t\t\tif (inrange(i-1, 1, p)) F.addedge(node(i-1, j, k+d), node(i, j, k), INF);\n\t\t\t\tif (inrange(j+1, 1, q)) F.addedge(node(i, j+1, k+d), node(i, j, k), INF);\n\t\t\t\tif (inrange(j-1, 1, q)) F.addedge(node(i, j-1, k+d), node(i, j, k), INF);\n\t\t\t}\n\tprintf(\"%lld\\n\", F.maxflow(s, t));\n\treturn 0;\n}\n```",
        "postTime": 1662811559,
        "uid": 227514,
        "name": "jijidawang",
        "ccfLevel": 0,
        "title": "P3227"
    },
    {
        "content": "[P3227 [HNOI2013]\u5207\u7cd5](https://www.luogu.com.cn/problem/P3227)\n\n\u7b2c\u4e00\u4e2a\u9650\u5236\u6bd4\u8f83\u597d\u5904\u7406\uff0c\u76f8\u5f53\u4e8e\u6bcf\u4e2a\u7eb5\u8f74\u4e0a\u9009\u4e00\u4e2a\u70b9\uff0c\u6211\u4eec\u628a\u70b9\u6743\u538b\u5230\u8fb9\u4e0a\uff0c\u5c31\u76f8\u5f53\u4e8e\u6700\u5c0f\u5272\u3002\u8fde\u8fb9 $S\\to(x,y,1)$\uff0c\u6d41\u91cf\u4e3a INF\uff1b\u8fde\u8fb9 $(x,y,z)\\to(x,y,z+1),z\\in[1,r]$\uff0c\u6d41\u91cf\u4e3a\u70b9\u6743\uff1b\u8fde\u8fb9 $(x,y,z+1)\\to T$\uff0c\u6d41\u91cf\u4e3a INF\u3002\n\n\u7b2c\u4e8c\u4e2a\u9650\u5236\u7684\u5904\u7406\u5c31\u6bd4\u8f83\u5de7\u5999\u4e86\u3002\u539f\u5f0f\u76f8\u5f53\u4e8e\u82e5\u76f8\u90bb\u7eb5\u8f74\u4e0a\u7684\u5207\u5272\u70b9 $f(x,y)-f(x',y')>D$\uff0c\u5219\u4e0d\u80fd\u540c\u65f6\u9009 $f(x,y)$ \u548c $f(x',y')$\u3002**\u5904\u7406\u65b9\u6cd5\u662f\uff0c\u4f7f\u5f97\u5f53 $f(i,j)-f(x,y)>D$ \u65f6\uff0c\u5373\u4f7f\u540c\u65f6\u5272\u6389\u8fd9\u4e24\u4e2a\u70b9\uff0c$S$ \u4ecd\u7136\u53ef\u4ee5\u5230\u8fbe $T$**\u3002\u5177\u4f53\u5730\uff0c\u5efa\u8fb9 $(x,y,z)\\to(x',y',z-D)$\uff0c\u8fb9\u6743\u4e3a INF\u3002\u5982\u4e0b\u56fe\uff0c\u5904\u7406\u5b8c\u7b2c\u4e00\u4e2a\u9650\u5236\u7684\u6a21\u578b\u5927\u6982\u957f\u4e0a\u9762\u90a3\u6837\u3002\u82e5 $D=2$ \uff0c\u8fde\u8fb9 $4'\\to 2$ \u540e\uff0c\u5373\u4f7f\u540c\u65f6\u5272\u6389 $1,4'$ \u7684\u8fb9\uff0c$S$ \u4ecd\u7136\u53ef\u4ee5\u5230\u8fbe $T$\u3002\u800c\u5272\u6389\u8fb9\u6743\u4e3a INF \u7684\u8fb9\u663e\u7136\u662f\u4e0d\u4f18\u7684\uff0c\u6700\u5c0f\u5272\u4e0d\u4f1a\u8fd9\u6837\u505a\u3002\u6240\u4ee5\u8fd9\u6837\u5efa\u6a21\u5c31\u53ef\u4ee5\u5904\u7406\u6389\u7b2c\u4e8c\u4e2a\u9650\u5236\u4e86\u3002\n\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/24rby9fk.png)\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nnamespace FGF\n{\n\tint n,m,r,K;\n\tconst int INF=0x3f3f3f3f,N=1e5+5,M=5e5+5;;\n\tstruct edg{\n\t\tint to,nxt,w;\n\t}e[M<<1];\n\tint cnt=1,head[N],ans,dep[N],S,T,num,cur[N];\n\tconst int dx[4]={0,1,0,-1};\n\tconst int dy[4]={1,0,-1,0};\n\tvoid add(int u,int v,int w)\n\t{\n\t\tcnt++;\n\t\te[cnt].to=v;\n\t\te[cnt].nxt=head[u];\n\t\thead[u]=cnt;\n\t\te[cnt].w=w;\n\t}\n\tvoid Add(int u,int v,int w){add(u,v,w),add(v,u,0);}\n\tqueue<int> q;\n\tbool bfs()\n\t{\n\t\tmemset(dep,-1,sizeof(dep));\n\t\tdep[S]=0;q.push(S);\n\t\twhile(q.size())\n\t\t{\n\t\t\tint u=q.front();q.pop();\n\t\t\tfor(int i=head[u];i;i=e[i].nxt)\n\t\t\t\tif(e[i].w&&dep[e[i].to]==-1)dep[e[i].to]=dep[u]+1,q.push(e[i].to);\n\t\t}\n\t\treturn dep[T]!=-1;\n\t}\n\tint dfs(int u,int f)\n\t{\n\t\tif(u==T)return f;\n\t\tint w=0,usd=0;\n\t\tfor(int& i=cur[u];i;i=e[i].nxt)\n\t\t\tif(e[i].w&&dep[e[i].to]==dep[u]+1)\n\t\t\t{\n\t\t\t\tw=dfs(e[i].to,min(e[i].w,f-usd));\n\t\t\t\tusd+=w,e[i].w-=w,e[i^1].w+=w;\n\t\t\t\tif(usd==f)return usd;\n\t\t\t}\n\t\tif(!usd)dep[u]=-1;\n\t\treturn usd;\n\t}\n\tint id(int x,int y,int z)\n\t{\n\t\treturn (x-1)*n*m+(y-1)*m+z;\n\t}\n\tvoid work()\n\t{\n\t\tscanf(\"%d%d%d%d\",&n,&m,&r,&K);\n\t\tT=n*m*(r+1)+1;\n\t\tfor(int i=1;i<=r;i++)\n\t\t\tfor(int j=1;j<=n;j++)\n\t\t\t\tfor(int k=1,x;k<=m;k++)\n\t\t\t\t\tscanf(\"%d\",&x),Add(id(i,j,k),id(i+1,j,k),x);\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tfor(int k=1;k<=m;k++)\n\t\t\t\tAdd(S,id(1,j,k),INF),Add(id(r+1,j,k),T,INF);\n\t\tfor(int i=K+1;i<=r+1;i++)\n\t\t\tfor(int j=1;j<=n;j++)\n\t\t\t\tfor(int k=1;k<=m;k++)\n\t\t\t\t\tfor(int o=0;o<4;o++)\n\t\t\t\t\t\tif(j+dx[o]<=n&&j+dx[o]>=1&&k+dy[o]<=m&&k+dy[o]>=1)Add(id(i,j,k),id(i-K,j+dx[o],k+dy[o]),INF);\n\t\twhile(bfs())memcpy(cur,head,sizeof(int[T+1])),ans+=dfs(S,INF);\n\t\tprintf(\"%d\\n\",ans);\n\t}\t\n}\nint main()\n{\n\tFGF::work();\n\treturn 0;\n}\n```",
        "postTime": 1610778827,
        "uid": 224403,
        "name": "\u6728xx\u6728\u5927",
        "ccfLevel": 9,
        "title": "P3227 [HNOI2013]\u5207\u7cd5\uff08\u6700\u5c0f\u5272\uff09"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u79cd\uff08\u53ef\u80fd\uff09\u66f4\u52a0\u81ea\u7136\u7684\u7406\u89e3\u3002\n\n\u9898\u76ee\u8981\u6c42\u6211\u4eec\u9009\u4e00\u4e9b\u70b9\uff0c\u53ef\u4ee5\u5199\u51fa\u5982\u4e0b\u9650\u5236\uff1a\n\n* \u5bf9\u4e8e\u6bcf\u4e2a $(x,y)$\uff0c\u53ea\u80fd\u9009\u4e00\u4e2a\u70b9\u3002\n* $|f(x,y)-f(x',y')|\\leq D$\u3002\n\n\u5bf9\u7b2c\u4e8c\u4e2a\u6761\u4ef6\u8fdb\u884c\u7b80\u5316\uff1a$-D\\leq f(x,y)-f(x',y')\\leq D$\u3002\u5bb9\u6613\u53d1\u73b0\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651 $\\leq D$ \u7684\u9650\u5236\uff0c\u56e0\u4e3a\u4e0d\u7b49\u5f0f\u4e58\u4e0a $-1$ \u4e4b\u540e\u53ef\u4ee5\u5f97\u5230\u53e6\u4e00\u4e2a\u5bf9\u79f0\u7684\u9650\u5236\u3002\n\n\u8003\u8651\u6700\u5c0f\u5272\uff0c\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u9650\u5236\uff0c\u663e\u7136\u53ef\u4ee5\u6309\u7167\u5957\u8def\u5efa\u4e00\u6761 $1\\sim R$ \u7684\u94fe\uff0c\u7136\u540e $(x,y,i)$ \u5411 $(x,y,i+1)$ \u8fde\u8fb9\u3002\u4e3a\u4e86\u4fdd\u8bc1\u6211\u4eec\u5efa\u6a21\u6709\u7740\u81ea\u7136\u7684\u5b9e\u9645\u610f\u4e49\uff0c\u5b9a\u4e49 $V_S$ \u4e3a\u6b8b\u91cf\u7f51\u7edc\u4e0a\u4e0e $S$ \u8054\u901a\u7684\u70b9\u96c6\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u94a6\u5b9a\uff1a$(x,y)$ \u9009\u7684\u70b9\u4e3a $V_S$ **\u5728\u8fd9\u6761\u94fe\u4e0a\u6700\u9760\u540e\u7684\u70b9**\u3002\u4e8b\u5b9e\u4e0a\u5b83\u7684\u540e\u7ee7\u8fb9\u7684\u96c6\u5408\u5c31\u662f\u5272\u8fb9\u96c6\u3002\n\nupd\uff1a\u4e8b\u5b9e\u4e0a\u8fd9\u91cc\u662f\u4e0d\u592a\u4e25\u8c28\u7684\uff0c\u56e0\u4e3a\u4e00\u6761\u94fe\u6709\u6700\u591a\u5272\u4e00\u6761\u7684\u9650\u5236\uff0c\u6240\u4ee5\u5fc5\u987b\u8981\u4fdd\u8bc1\u8fde\u901a\u7684\u4e00\u5b9a\u662f\u4e00\u4e2a\u524d\u7f00\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u9009\u62e9\u7684\u6761\u4ef6\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u201c\u82e5 $i$ \u8fde\u901a\u4e14 $j$ \u4e0d\u8fde\u901a\uff0c\u5219\u82b1\u8d39\u4e3a $c$\u201d\u7684\u9650\u5236\u3002\u6240\u4ee5\u9700\u8981 $(x,y,i+1)$ \u5411 $(x,y,i)$ \u8fde\u4e00\u6761 $\\inf$ \u8fb9\u3002\u4e0d\u8fc7\u6839\u636e dengyaotriangle \u7684\u8bc1\u660e\u4e5f\u662f\u5bf9\u7684\uff0c\u6240\u4ee5\u4e0d\u7ba1\u4e86\uff08\n\n\u90a3\u4e48\u5bf9\u4e8e\u76f8\u90bb\u7684\u9650\u5236\uff0c\u5728\u6a21\u578b\u4e0a\u6709\u5982\u4e0b\u7406\u89e3\uff1a\u82e5 $S$ \u4e0e $(x',y',t')$ \u8054\u901a\uff0c\u5219\u5b58\u5728 $t\\geq t'-d$\uff0c\u4f7f\u5f97 $(x,y,t)$ \u4e0e $S$ \u8054\u901a\uff0c\u90a3\u4e48\u5bf9\u4e8e $(x',y',t')$ \u5411 $(x,y,t'-d)$ \u8fde $\\inf$ \u8fb9\u7684\u601d\u8def\u5c31\u76f8\u5f53\u81ea\u7136\u4e86\u3002\n\n\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define ull unsigned long long\n#define db double\n#define ldb long double\n#define pb push_back\n#define mp make_pair\n#define pii pair<int, int>\nusing namespace std;\ninline int read() {\n    int x = 0; bool op = 0;\n    char c = getchar();\n    while(!isdigit(c))op |= (c == '-'), c = getchar();\n    while(isdigit(c))x = (x << 1) + (x << 3) + (c ^ 48), c = getchar();\n    return op ? -x : x;\n}\nconst int N = 50;\nconst int MAXN = 1e6 + 10;\nconst int INF = 1e9;\ntemplate<int N> struct MFL {\n    int n, etot, S, T, head[N], to[N], nxt[N], flow[N];\n    void addedge(int u, int v, int w) { \n        to[++etot] = v; flow[etot] = w; nxt[etot] = head[u]; head[u] = etot;\n    }\n    void add(int u, int v, int w) {\n        addedge(u, v, w); addedge(v, u, 0);\n        return ;\n    }\n    void init(int nn, int ns, int nt) {\n        n = nn; S = ns; T = nt; etot = 1;\n        memset(head, 0, sizeof(head));\n        return ;\n    }\n    int lev[N], cur[N];\n    bool bfs() {\n        for(int i = 0; i <= n; i++)cur[i] = head[i], lev[i] = 0;\n        queue<int> q;\n        q.push(S); lev[S] = 1;\n        while(q.empty() == false) {\n            int u = q.front(); q.pop();\n            for(int i = head[u]; i; i = nxt[i]) {\n                if(lev[to[i]] || flow[i] == 0)continue;\n                lev[to[i]] = lev[u] + 1;\n                if(to[i] == T)return true;\n                q.push(to[i]);\n            }\n        }\n        return false;\n    }\n    int dinic(int u, int fl) {\n        if(u == T)return fl;\n        int rest = fl;\n        for(int i = cur[u]; i && rest; i = nxt[i]) {\n            cur[u] = i;\n            if(lev[to[i]] ^ (lev[u] + 1) || flow[i] == 0)continue;\n            int inc = dinic(to[i], min(flow[i], rest));\n            if(inc == 0)lev[to[i]] = 0;\n            flow[i] -= inc; flow[i ^ 1] += inc; rest -= inc;\n        }\n        return fl - rest;\n    }\n    int query() {\n        int mxfl = 0, fl = 0;\n        while(bfs()) {\n            while(fl = dinic(S, INF))mxfl += fl;\n        }\n        return mxfl;\n    }\n};\nMFL<MAXN> mf;\nconst int dx[4] = {0, 0, 1, -1};\nconst int dy[4] = {1, -1, 0, 0};\nint p, q, r, d, tot;\nint a[N][N][N], id[N][N][N];\nint main() {\n    p = read(); q = read(); r = read(); d = read();\n    for(int i = 1; i <= r; i++) {\n        for(int j = 1; j <= p; j++) {\n            for(int k = 1; k <= q; k++) {\n                a[j][k][i] = read();\n                id[j][k][i] = ++tot;\n            }\n        }\n    }\n    mf.init(tot + 1, 0, tot + 1);\n    for(int i = 1; i <= p; i++) {\n        for(int j = 1; j <= q; j++) {\n            mf.add(mf.S, id[i][j][1], INF); mf.add(id[i][j][1], mf.S, INF);\n            for(int k = 1; k < r; k++) {\n                mf.add(id[i][j][k], id[i][j][k + 1], a[i][j][k]);\n                mf.add(id[i][j][k + 1], id[i][j][k], INF);\n            }\n            mf.add(id[i][j][r], mf.T, a[i][j][r]); mf.add(mf.T, id[i][j][r], INF);\n        }\n    }\n    for(int i = 1; i <= p; i++) {\n        for(int j = 1; j <= q; j++) {\n            for(int o = 0; o < 4; o++) {\n                int nx = i + dx[o], ny = j + dy[o];\n                if(nx < 1 || nx > p || ny < 1 || ny > q)continue;\n                for(int k = 1; k + d <= r; k++) {\n                    mf.add(id[nx][ny][k + d], id[i][j][k], INF);\n                }\n            }\n        }\n    }\n    printf(\"%d\\n\", mf.query());\n    return 0;\n}\n```\n",
        "postTime": 1650703667,
        "uid": 682934,
        "name": "yllcm",
        "ccfLevel": 0,
        "title": "Solution-P3227"
    },
    {
        "content": "\u6700\u5c0f\u5272\u7ecf\u5178\u95ee\u9898\u3002\n\n\n------------\n\u9996\u5148\u9047\u5230\u8fd9\u4e2a\u95ee\u9898\uff0c\u53d1\u73b0\u5e76\u4e0d\u600e\u4e48\u663e\u7136\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u8f6c\u6362\n\n\u6211\u4eec\u628a\u6bcf\u4e2a\u7eb5\u67f1\u7684\u9ad8\u5ea6\u5206\u522b\u4f9d\u6b21\u8fde\u8fb9\uff0c\u8fb9\u6743\u5373\u4e3a\u5176\u4e0d\u548c\u8c10\u503c\uff0c\u5373 $(x,y,k)  \\xrightarrow{val(x,y,k+1)}(x,y,k+1)$\uff0c\u518d\u628a\u4e24\u7aef\u5206\u522b\u5411\u8d77\u70b9\uff0c\u7ec8\u70b9\u8fde\u8fb9\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u6bcf\u4e2a\u7eb5\u5217\u9009\u4e00\u4e2a\u9ad8\u5ea6\u8f6c\u6362\u4e3a\u6c42\u6700\u5c0f\u5272\u3002\n\n\u90a3\u4e48\u5982\u4f55\u628a\u76f8\u90bb\u9ad8\u5ea6\u5dee\u8fd9\u4e2a\u6761\u4ef6\u8f6c\u6362\u5462\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6bcf\u4e2a\u70b9\u7684\u7b2c $k$ \u4e2a\u9ad8\u5ea6\uff0c\u5411\u5176\u5468\u56f4\u7684\u70b9\u7684\u7b2c $k-D$ \u4e2a\u9ad8\u5ea6\u8fde $\\infty  $ \u7684\u8fb9\uff0c\u5373  $(x,y,k)  \\xrightarrow{\\infty}(x\\pm1,y\\pm1,k-D)$\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u4f7f\u9009\u5b9a\u76f8\u90bb\u9ad8\u5ea6\u5dee\u5c0f\u4e8e D\u3002\u56e0\u4e3a\u5982\u679c\u9009\u4e86\u4e0d\u5408\u6cd5\u7684\u65b9\u6848\uff0c\u90a3\u4e48\u5fc5\u7136\u4ed6\u8fd8\u80fd\u901a\u8fc7\u8fd9\u6761  $\\infty  $ \u7684\u8fb9\uff0c\u8fd9\u5fc5\u7136\u4e0d\u662f\u6700\u5c0f\u5272\u3002\n\n\u6211\u4eec\u5efa\u8fb9\u540e\u5c31\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u6d41\u6c42\u89e3\u4e86\uff0c\u56e0\u4e3a\u6700\u5c0f\u5272\u7b49\u4e8e\u6700\u5927\u6d41\uff0c\u53ea\u8981\u6c42\u51fa\u6700\u5927\u6d41\u4e86\u3002\n\n\n\n------------\n\u4ee3\u7801\u5982\u4e0b\n\n```cpp\n// Problem: P3227 [HNOI2013]\u5207\u7cd5\n// Contest: Luogu\n// URL: https://www.luogu.com.cn/problem/P3227\n// Memory Limit: 125 MB\n// Time Limit: 1000 ms\n// 2022-02-13 09:11:43\n// Author : louhao088\n// \n\n#include<bits/stdc++.h>\nusing namespace std;\n//static char buf[1000000],*p1=buf,*p2=buf;\n//#define getchar() p1==p2&&(p2=(p1=buf)+fread(buf,1,1000000,stdin),p1==p2)?EOF:*p1++\n#define pi pair<int,int>\n#define mp make_pair\n#define fi first\n#define se second\n#define pb push_back\n#define ls (rt<<1)\n#define rs (rt<<1|1)\n#define mid (l+r>>1)\n#define lowbit (x&-x)\nconst int maxn=1e5+5,M=34005,inf=1e9;\ninline int read()\n{\n\tchar ch=getchar();bool f=0;int x=0;\n\tfor(;!isdigit(ch);ch=getchar())if(ch=='-')f=1;\n\tfor(;isdigit(ch);ch=getchar())x=(x<<1)+(x<<3)+(ch^48);\n\tif(f==1)x=-x;return x;\n}\ninline void print(int x)\n{\n    static int a[55];int top=0;\n    if(x<0) putchar('-'),x=-x;\n    do{a[top++]=x%10,x/=10;}while(x);\n    while(top) putchar(a[--top]+48);\n}\nint n,m,h,d,x,y,id[45][45][45],tot=0,v[45][45][45],dx[4]={0,0,1,-1},dy[4]={1,-1,0,0};\nstruct node\n{\n\tint head[maxn],to[maxn*4],nex[maxn*4],w[maxn*4],cnt,s,t,maxflow,dis[maxn],cur[maxn];\n\tvoid add(int x,int y,int z){to[++cnt]=y,w[cnt]=z,nex[cnt]=head[x],head[x]=cnt;\n\tto[++cnt]=x,w[cnt]=0,nex[cnt]=head[y],head[y]=cnt;}\n\tvoid clear(){memset(head,0,sizeof head),memset(cur,0,sizeof cur),cnt=1,maxflow=0;}\n\tbool bfs()\n\t{\n\t\tmemset(dis,-1,sizeof dis);queue<int>q;\n\t\tq.push(s);cur[s]=head[s];dis[s]=0;\t\t\n\t\twhile(!q.empty())\n\t\t{\n\t\t\tint x=q.front();q.pop();\n\t\t\tfor(int i=head[x];i;i=nex[i])\n\t\t\t\tif(dis[to[i]]==-1&&w[i])\n\t\t\t\t\tdis[to[i]]=dis[x]+1,q.push(to[i]),cur[to[i]]=head[to[i]];\n\t\t}\n\t\treturn dis[t]!=-1;\n\t}\n\tint dfs(int x,int flow)\n\t{\n\t\tif(x==t)return flow;\n\t\tint sum=0;\n\t\tfor(int i=cur[x];i&&flow;i=nex[i])\n\t\t{\n\t\t\tcur[x]=i;\n\t\t\tif(w[i]&&dis[to[i]]==dis[x]+1)\n\t\t\t{\n\t\t\t\tint k=dfs(to[i],min(flow,w[i]));\n\t\t\t\tflow-=k,sum+=k;w[i]-=k,w[i^1]+=k;\n\t\t\t}\n\t\t}return sum;\n\t}\n\tvoid work()\n\t{\n\t\twhile(bfs())maxflow+=dfs(s,inf);\n\t}\n}G;\nsigned main()\n{\n\t//freopen(\".in\",\"r\",stdin);\n\t//freopen(\".out\",\"w\",stdout);\n\tn=read(),m=read(),h=read(),d=read();G.clear();\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++)\n\t\t\tfor(int k=0;k<=h;k++)id[i][j][k]=++tot;\n\tfor(int k=1;k<=h;k++)\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tfor(int j=1;j<=m;j++)\n\t\t\t{\n\t\t\t\tv[i][j][k]=read(),G.add(id[i][j][k-1],id[i][j][k],v[i][j][k]);\n\t\t\t\tif(k>=d)\n\t\t\t\t{\n\t\t\t\t\tfor(int l=0;l<4;l++)\n\t\t\t\t\t{\n\t\t\t\t\t\tint tx=i+dx[l],ty=j+dy[l];\n\t\t\t\t\t\tif(tx<=n&&tx>=1&&ty<=m&&ty>=1)G.add(id[i][j][k],id[tx][ty][k-d],inf);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\tint s=++tot,t=++tot;\n\tG.s=s,G.t=t;\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++)\n\t\t\tG.add(s,id[i][j][0],inf),G.add(id[i][j][h],t,inf);\n\tG.work();cout<<G.maxflow<<endl;\n \treturn 0;\n}\n\n\n```\n",
        "postTime": 1644718035,
        "uid": 343748,
        "name": "louhao088",
        "ccfLevel": 9,
        "title": "\u9898\u89e3P3227 [HNOI2013]\u5207\u7cd5"
    },
    {
        "content": "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**\u5206\u6790\u4e0e\u9898\u89e3\uff1a**\u5bf9\u4e8e\u6b64\u9898\uff0c\u6211\u4eec\u89c2\u5bdf\u5bf9\u4e8e\u70b9\u7684\u5206\u5272\u4e0d\u592a\u597d\u64cd\u4f5c\uff0c\u6211\u4eec\u8003\u8651\u8f6c\u5316\u6a21\u578b\u3002\u7531\u4e8e\u6211\u4eec\u662f\u8981\u62e6\u8170\u5207\u6210\u4e24\u534a\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u9ad8\u4e0a\u5165\u624b\uff0c\u6211\u4eec\u5c06\u9ad8\u7684$r$\u5c42\u591a\u52a0\u4e00\u5c42\uff0c\u5c06\u70b9\u8f6c\u5316\u4e3a\u8fb9\uff0c\u7b2c\u4e00\u5c42\u7684\u70b9\u5c31\u76f8\u5f53\u4e8e\u8fde\u63a5\u8f6c\u5316\u540e\u7684\u7b2c\u4e00\u5c42\u548c\u7b2c\u4e8c\u5c42\u7684\u8fb9\uff0c\u7b2c\u4e8c\u5c42\u7684\u70b9\u5c31\u76f8\u5f53\u4e8e\u8fde\u63a5\u8f6c\u5316\u540e\u7684\u7b2c\u4e8c\u5c42\u548c\u7b2c\u4e09\u5c42\u7684\u8fb9\u2026\u2026\u7b2c$r$\u5c42\u7684\u70b9\u5c31\u76f8\u5f53\u4e8e\u8fde\u63a5\u8f6c\u5316\u540e\u7684\u7b2c$r$\u5c42\u548c\u7b2c$r+1$\u5c42\u7684\u8fb9\u3002\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u5982\u679c\u4e0d\u8003\u8651$D$\u8fd9\u9053\u9898\u73b0\u5728\u5c31\u89e3\u51b3\u4e86\u3002\u5bf9\u4e8e$D$\u7684\u9650\u5236\uff0c\u6211\u4eec\u53d1\u73b0\u4e0d\u6210\u7acb\u53ea\u9700\u8981\u8003\u8651$f(x\uff0cy)-f(x'\uff0cy')\\gt D$\u7684\u60c5\u51b5\uff0c\u56e0\u4e3a$f(x\uff0cy)-f(x'\uff0cy')\\lt -D$\u7684\u60c5\u51b5\u5728\u8003\u8651\u70b9$(x'\uff0cy'\uff0cf(x'\uff0cy'))$\u7684\u65f6\u5019\u5c31\u8f6c\u5316\u4e3a\u4e0a\u8ff0\u5f62\u5f0f\u3002\u6211\u4eec\u73b0\u5728\u8981\u5c06$(x\uff0cy\uff0cz)$\u5411$(x'\uff0cy'\uff0cz\u2019-k)\uff0ck\\in[D+1,R+1]$\u8fde\u8fb9\uff0c\u8fb9\u6743\u4e3a$inf$\uff0c\u8fd9\u6837\u5728\u4e0d\u5408\u6cd5\u7684\u65f6\u5019\uff0c\u6211\u4eec\u4f9d\u65e7\u80fd\u4f7f$S$\u548c$T$\u8054\u901a\u3002\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u5efa\u56fe\u5efa\u5b8c\uff0c\u76f4\u63a5\u7528$Dinic$\u8dd1\u6700\u5c0f\u5272\u5c31\u53ef\u4ee5\u4e86\u3002\n\n```c++\n// luogu-judger-enable-o2\n#include <queue>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\n#define N 200000\n#define inf 1000000000\nint p,q,r,D,s,t,dis[N],ans,num[60][60][60];\nint cur[N],head[N],to[N<<3],nxt[N<<3],val[N<<3],idx=1;\nvoid add(int a,int b,int c)\n    {nxt[++idx]=head[a],to[idx]=b,val[idx]=c,head[a]=idx;}\nbool bfs() \n{\n    memset(dis,-1,sizeof dis);\n    queue <int> q;q.push(s),dis[s]=0;\n    while(!q.empty())\n    {\n        int p=q.front();q.pop();\n        if(p==t) return true;\n        for(int i=head[p];i;i=nxt[i])\n            if(val[i]>0&&dis[to[i]]==-1)\n                dis[to[i]]=dis[p]+1,q.push(to[i]);\n    } return false;\n}\nint dfs(int p,int flow)\n{\n    int now,temp=flow;\n    if(p==t) return flow;\n    for(int i=cur[p];i;i=nxt[i])\n        if(val[i]>0&&dis[to[i]]==dis[p]+1)\n        {\n            now=dfs(to[i],min(val[i],temp));\n            if(!now) dis[to[i]]=-1;\n            temp-=now,val[i]-=now,val[i^1]+=now;\n            if(val[i]) cur[p]=i;\n            if(!temp) break;\n        } return flow-temp;\n}\nvoid dinic() {while(bfs()) memcpy(cur,head,sizeof head),ans+=dfs(s,inf);}\nint pla(int x,int y,int z) {return (z-1)*p*q+(x-1)*q+y;}\nint main()\n{\n    scanf(\"%d%d%d%d\",&p,&q,&r,&D),s=p*q*(r+1)+1,t=p*q*(r+1)+2;\n    for(int i=1;i<=r;i++) for(int j=1;j<=p;j++) for(int k=1;k<=q;k++)\n        scanf(\"%d\",&num[j][k][i]);r++;\n    for(int i=1;i<=p;i++) for(int j=1;j<=q;j++)\n        add(s,pla(i,j,1),inf),add(pla(i,j,1),s,0);\n    for(int i=1;i<=p;i++) for(int j=1;j<=q;j++)\n        add(pla(i,j,r),t,inf),add(t,pla(i,j,r),0);\n    for(int i=1;i<=p;i++) for(int j=1;j<=q;j++) for(int k=1;k<r;k++)\n        add(pla(i,j,k),pla(i,j,k+1),num[i][j][k]),add(pla(i,j,k+1),pla(i,j,k),0);\n    for(int i=1;i<p;i++) for(int j=1;j<=q;j++) for(int t=D+1;t<=r;t++)\n            add(pla(i,j,t),pla(i+1,j,t-D),inf),add(pla(i+1,j,t-D),pla(i,j,t),0);\n    for(int i=1;i<=p;i++) for(int j=1;j<q;j++) for(int t=D+1;t<=r;t++)\n            add(pla(i,j,t),pla(i,j+1,t-D),inf),add(pla(i,j+1,t-D),pla(i,j,t),0);\n    for(int i=2;i<=p;i++) for(int j=1;j<=q;j++) for(int t=D+1;t<=r;t++)\n            add(pla(i,j,t),pla(i-1,j,t-D),inf),add(pla(i-1,j,t-D),pla(i,j,t),0);\n    for(int i=1;i<=p;i++) for(int j=2;j<=q;j++) for(int t=D+1;t<=r;t++)\n            add(pla(i,j,t),pla(i,j-1,t-D),inf),add(pla(i,j-1,t-D),pla(i,j,t),0);\n    dinic(),printf(\"%d\\n\",ans);\n}\n```",
        "postTime": 1545618690,
        "uid": 52851,
        "name": "ysy20021208",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3227 \u3010[HNOI2013]\u5207\u7cd5\u3011"
    },
    {
        "content": "#### \u7b80\u8ff0\n>\u7ed9\u4e00\u4e2a$n*m*h$\u7684\u7acb\u4f53\u56fe,\u5bf9$\\forall(x,y)(1\\le x\\le n\\vee1\\le y\\le m)$\u8981\u6c42\u9009\u51fa$1\\le f_{x,y}\\le h$\u4f7f\u5f97$|f_{x,y}-f_{x',y'}|\\le D(|x-x'+y-y'|=1)$,\u6700\u5c0f\u5316$\\sum v_{x,y,f_{x,y}}$\n\n#### Solution\n\u9996\u5148\u5bf9\u6bcf\u4e2a\u79bb\u6563\u53d8\u91cf$f_{x,y}$,\u6211\u4eec\u62c6\u51fa$h$\u4e2a\u70b9$\\{1,2,\\cdots,h\\}$\n\n\u7136\u540e\u8fde\u8fb9\n\n$(S,(x,y,1),v_{x,y,1})$\u8868\u793a$f_{x,y}=1$\n\n$((x,y,i),(x,y,i+1),v_{x,y,i+1})(i\\in[1,h))$\u8868\u793a$f_{x,y}=i+1$\n\n$((x,y,h),T,INF)$\u8868\u793a\u4e0d\u80fd**\u4e0d\u9009**\n\n\u7136\u540e\u8003\u8651\u53d8\u91cf\u95f4\u9650\u5236\n$f_{x,y}-f_{x',y'}\\le D\\vee f_{x,y}-f_{x',y'}\\le -D(|x-x'+y-y'|=1)$\n\n\u8fd9\u91cc\u6211\u4eec\u9700\u8981\u6ce8\u610f\u5230\u5272\u7684\u6027\u8d28:\u662f\u8ba9$S,T$\u5206\u79bb\u7684\u8fb9\n\n\u6211\u4eec\u4e0d\u80fd\u660e\u786e\u7528\u5272\u7684\u5bb9\u91cf\u53bb\u8868\u793a\u5408\u6cd5\u60c5\u51b5\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u53cd\u5176\u9053\u800c\u884c\u7528$INF$\u8fd9\u4e2a\u7279\u6b8a\u7684\u5bb9\u91cf\u53bb\u7981\u6b62\u9009\u4e00\u4e9b\u60c5\u51b5\n\n\u6211\u4eec\u8ba9$(x,y,f_{x,y})$$\\in S$\u5219$k\\le f_{x,y}$,\u53cd\u4e4b$k>f_{x,y}$\n\n\u5148\u7ed9\u51fa\u7ed3\u8bba\n\n$((x,y,k),(x',y',k-D),INF)(|x-x'+y-y'|=1)$\n\n\u4ec0\u4e48\u610f\u601d,\u9996\u5148\u6211\u4eec\u77e5\u9053\u6211\u4eec\u4e0d\u80fd\u5272\u8fd9\u4e2a\u8fb9\n\n\u5982\u679c\u4f60\u5230\u8fbe\u4e86$(x,y,k)$,\u4f60\u8981\u8de8\u8d8a$(x,y)$\u5230$(x',y')$\u5e76\u4e14\u9009\u4e86$f_{x',y'}<k-D$\n\n\u90a3\u4e48\u7531\u4e8e\u8fb9$((x,y,k),(x',y',k-D),INF)$\n\n\u59b3\u5272\u4e86$((x',y',f_{x',y'}),(x',y',f_{x',y'}-1))$\u4f46$(S,T)$\u5c31\u8054\u901a\uff0c\u53c8\u56e0\u4e3a\u4f60\u4e0d\u53ef\u4ee5\u5272\u8fd9\u6761\u8fb9\uff0c\u6240\u4ee5\u8fd9\u4e2a\u975e\u6cd5\u60c5\u51b5\u4e0d\u662f\u5272\n\n\u6211\u4eec\u5b9e\u9645\u4e0a\u6ee1\u8db3\u4e86$f_{x,y}-f_{x',y'}\\le D$\n\n\u4f46~~\u5f88\u597d~~\u7406\u89e3$(x,y),(x',y')$\u7684\u5173\u7cfb\u6709\u7ffb\u8f6c\u7684\u4e00\u5929\uff0c\u4e5f\u4f1a\u6ee1\u8db3\u6ee1\u8db3\u4e86$f_{x,y}-f_{x',y'}\\le -D$\n\n#### Code\n\n```cpp\ninline void Read(void){\n\tre int i,j,k,last,dir,tx,ty;\n\tn=read(),m=read(),H=read(),lim=read(),S=0,T=n*m*H+1,P=T+1;\n\tfor(k=1;k<=H;++k)\n\t\tfor(i=1;i<=n;++i)\n\t\t\tfor(j=1;j<=m;++j)a[i][j][k]=read();\n\tfor(i=1;i<=n;++i)\n\t\tfor(j=1;j<=m;++j){\n\t\t\tlast=S;\n\t\t\tfor(k=1;k<=H;++k)AddEdge(last,pos(i,j,k),a[i][j][k]),last=pos(i,j,k);\n\t\t\tAddEdge(last,T,INF);\n\t\t}\n\t//\u540c\u4e00\u4e2a\u4f4d\u7f6e\u4e0d\u540c\u5c42\u53ef\u4ee5\u4ece\u4e0b\u5f80\u4e0a\u4f20\n\tfor(i=1;i<=n;++i)\n\t\tfor(j=1;j<=m;++j)\n\t\t\tfor(k=1;k<=H-lim;++k){\n\t\t\t\tfor(dir=0;dir<4;++dir){\n\t\t\t\t\ttx=i+dx[dir],ty=j+dy[dir];\n\t\t\t\t\tif(tx>n||!tx||!ty||ty>m)continue;\n\t\t\t\t\tAddEdge(pos(tx,ty,k+lim),pos(i,j,k),INF);//\u4ece\u4e0a\u5230\u4e0b\uff0c\u53ea\u8981\u9ad8\u4e8e\u8fd9\u4e2a\u5c31\u5fc5\u987b\u5272INF\n\t\t\t\t\t//\u4e8b\u5b9e\u4e0a(i,j)\u4e5f\u4f1a\u88ab\u8fde\u4e00\u4e2a\u6765\u9650\u5236\u4e0b\u754c \n\t\t\t\t}\n\t\t\t}\n}\n```",
        "postTime": 1577773953,
        "uid": 40629,
        "name": "zzw4257",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3227 \u3010[HNOI2013]\u5207\u7cd5\u3011"
    },
    {
        "content": "### \u9898\u76ee\u94fe\u63a5\n[\u6233\u6211](https://www.luogu.org/problemnew/show/P3227)\n### $Solution$\n\n\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u6211\u4eec\u9996\u5148\u6765\u770b\u770b\u6ca1\u6709$D$\u8fd9\u4e2a\u7ea6\u675f\u7684\u8be5\u5982\u4f55\u505a\u3002\n\n\u6211\u4eec\u8003\u8651\u6784\u9020\u6700\u5c0f\u5272\u6a21\u578b\u3002  \n~~\u5176\u5b9e\u76f4\u63a5\u8d2a\u5fc3\u5c31\u597d\u4e86,\u9009\u51fa\u6bcf\u6761\u8def\u5f84\u4e0a\u7684\u6700\u5c0f\u503c\u5c31\u597d\u4e86(\u8def\u5f84\u5c31\u662f\u5c06\u6bcf\u5c42\u7684\u540c\u4e00\u4e2a\u70b9\u8fde\u8d77\u6765)~~  \n\u4f46\u662f\u56e0\u4e3a\u8fd9\u9898\u4e0d\u4ec5\u4ec5\u662f\u8fd9\u6837,\u8fd8\u6709\u4e00\u4e9b\u7ea6\u675f\u6761\u4ef6\u9700\u8981\u6ee1\u8db3\u3002\u6240\u4ee5\u8fd8\u662f\u770b\u770b\u5982\u4f55\u5efa\u6a21\u5427\u3002\n\n\u5176\u5b9e\u548c\u8d2a\u5fc3\u5f88\u50cf\u554a\u3002  \n\u9996\u5148\u5982\u4e0a\u9762\u6240\u8bf4\u8fde\u6210\u4e00\u6761\u6761\u8def\u5f84\uff0c\u5728\u5c06\u7b2c\u4e00\u5c42\u548c$S$\u76f8\u8fde,\u6700\u540e\u4e00\u5c42\u548c$T$\u8fde\u63a5\u3002\u8dd1\u4e00\u904d\u6700\u5c0f\u5272\u5c31\u597d\u4e86\u3002\u81f3\u4e8e\u6d41\u91cf\uff0c\u8fd9\u4e2a\u81ea\u5df1\u5e94\u8be5\u77e5\u9053\u5427,\u5982\u679c\u4e0d\u77e5\u9053\u6765\u770b\u770b\u56fe\uff0c\u66f4\u52a0\u6df1\u523b\u7684\u7406\u89e3\u3002(\u8fd9\u91cc\u53ea\u9009\u4e86\u5c40\u90e8\u56fe,~~\u6709\u70b9\u4e11~~)\n\u9996\u5148\u6211\u4eec\u5c06\u7b2c$k$\u5c42\u7b2c$i$\u884c,\u7b2c$j$\u5217\u7684\u6570\u7684\u503c\u8bbe\u4e3a$V[k][i][j]$\n\n![](https://s2.ax1x.com/2019/01/18/k9ryzn.png)\n\n\u73b0\u5728\u8003\u8651\u4e00\u4e0b$D$\u7684\u7ea6\u675f\u6761\u4ef6  \n\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e8e\u4e00\u4e2a\u70b9\uff0c\u4ee4\u4ed6\u4e3a$(k,x,y)$\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u70b9x\u8fde\u5411$k-D$\u5c42\u4e2d\u4e0e$(x,y)$\u76f8\u90bb\u7684\u70b9,\u6d41\u91cf\u4e3a$inf$,\u8fd9\u6837\u5c31\u53ef\u4ee5\u6ee1\u8db3\u6761\u4ef6\u4e86\uff0c\u81f3\u4e8e\u95ee\u4ec0\u4e48\u6765\u501f\u52a9\u56fe\u6765\u770b\u4e00\u4e0b\u5427\u3002  \n\u5047\u8bbe\u73b0\u5728$D=1$,\u5982\u56fe:\n![](https://s2.ax1x.com/2019/01/19/k9IU9P.png)\n\n\u6211\u4eec\u5c06$i$\u70b9\u5230$j$\u70b9\u7684\u8fb9\u8868\u793a\u4e3a$f[i][j]$  \n\u6211\u4eec\u9996\u5148\u7684\u601d\u8003\u4e00\u4e0b\uff0c\u6bcf\u4e00\u6761\u94fe\u53ea\u80fd\u5272\u4e00\u6761\u8fb9\uff0c\u56e0\u4e3a\u5982\u679c\u5272\u591a\u6761\u660e\u663e\u4e0d\u4f1a\u6700\u4f18\u3002\u5047\u8bbe\u6211\u4eec\u73b0\u5728\u5272\u7684\u662f$f[6][8]$\u8fd9\u4e00\u6761\u8fb9,\u90a3\u4e48\u6211\u4eec\u5c31\u4e0d\u80fd\u5272$f[S][1]$,\u6211\u4eec\u5c06$(6,1)$\u8fde\u4e00\u6761\u4e3a$inf$\u7684\u8fb9\u6211\u8fd9\u6837\u5f53\u6211\u4eec\u5272\u6389\u662f$f[6][8]$\uff0c\u5219\u8fd9\u4e00\u6761\u9053\u8def\u8d70\u4e0d\u901a\u6211\u4eec\u5c31\u4f1a\u8d70$f[6][1]$\u56e0\u4e3a\u8981\u6ee1\u8db3\u6700\u4f18\uff0c\u6240\u4ee5\u6211\u4eec\u4e00\u5b9a\u4e0d\u4f1a\u5272$f[S][1]$,\u5176\u4ed6\u7684\u540c\u7406\u3002\n\n### $Code$\n\n\u89c1[\u535a\u5ba2](https://www.cnblogs.com/hbxblog/p/10290453.html)",
        "postTime": 1547859947,
        "uid": 19805,
        "name": "\u64a4\u4e91",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3227 \u3010[HNOI2013]\u5207\u7cd5\u3011"
    },
    {
        "content": "[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3227)\n\n\u4e3a\u5565\u4e00\u5b9a\u8981\u5efa\u865a\u62df\u5c42\uff0c\u5272\u8fb9\u8f6c\u5272\u70b9\u4e5f\u662f\u53ef\u505a\u7684\u3002\n\n\u540c\u6837\u8003\u8651\u6ca1\u6709 $D$ \u7684\u9650\u5236\u3002\u6bcf\u4e2a\u70b9\u548c\u5b83\u4e0a\u65b9\u7684\u70b9\u8fde\u8fb9\u5bb9\u91cf INF\uff0c$S$ \u548c\u7b2c\u4e00\u5c42\u7684\u70b9\u8fde\u8fb9\u540c\u6837\u5bb9\u91cf $INF$\uff0c\u6700\u4e0a\u9762\u4e00\u5c42\u548c $T$ \u8fde\u8fb9\u4f9d\u65e7\u5bb9\u91cf INF\u3002\u7136\u540e\u62c6\u70b9\u6210 $X_i$ \u548c $Y_i$\uff0c\u5728 $X_i->Y_i$ \u4e4b\u95f4\u8fde\u5bb9\u91cf\u4e3a $v$ \u7684\u8fb9\u3002\u6b64\u65f6\u6700\u5c0f\u5272\u5c31\u662f\u7b54\u6848\u3002\n\n\u7136\u540e\u8003\u8651\u52a0\u5165 $D$ \u7684\u9650\u5236\u3002\u4ece\u9898\u76ee\u51fa\u53d1\u6709\u4e24\u79cd\u53ef\u80fd\u505a\u6cd5\uff1a\n\n- \u5272\u4e00\u4e2a\u70b9\u540e\u67d0\u4e9b\u70b9\u4e0d\u80fd\u518d\u5272\n\n- \u5272\u4e00\u4e2a\u70b9\u540e\u5fc5\u987b\u5728\u67d0\u4e9b\u70b9\u91cc\u9762\u5272\u4e00\u4e2a\n\n\u5176\u5b9e\u56e0\u4e3a\u62c6\u4e86\u70b9\u5b8c\u5168\u53ef\u4ee5\u628a\u70b9\u5f53\u6210\u8fb9\u6765\u8003\u8651\uff0c\u4e24\u8005\u6ca1\u6709\u592a\u5927\u5dee\u522b\u3002\u5982\u679c $(x,y)$ \u548c $(x',y')$ \u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u4e3a1\uff08\u5176\u5b9e\u5c31\u662f\u4e0a\u4e0b\u5de6\u53f3\uff09\uff0c\u90a3\u4e48\u9009 $(x,y,k)$ \u610f\u5473\u7740\u8981\u5728 $(x',y',k-d) ...(x',y',k+d)$ \u4e4b\u95f4\u9009\u70b9\u3002\u7136\u540e\u5c31\u6709\u4e00\u4e2a\u795e\u5947\u7684\u505a\u6cd5\uff1a\u8fde\u8fb9 $X_{(x,y,k)}->X_{(x',y',k-d)},Y_{(x',y',k+d)}->Y_{(x,y,k)}$\uff0c\u5bb9\u91cf\u7686\u4e3aINF\uff08\u4ee3\u8868\u4e0d\u80fd\u5272\uff09\uff0c\u5c31\u6ee1\u8db3\u4e86\u9650\u5236\u3002\u5982\u679c\u5272\u7684\u8fb9\u4e0d\u662f $X_i->Y_i$ \u8fd9\u4e00\u6761\u90a3\u4e48\u4e0d\u4f1a\u5272\u4efb\u4f55\u5176\u5b83\u7684\u8fb9\uff1b\u5982\u679c\u5272\u7684\u5c31\u662f $X_i->Y_i$ \u8fd9\u4e00\u6761\u90a3\u4e48\u5728 $X_{(x',y',k-d)}...Y_{(x',y',k+d)}$ \u4e4b\u95f4\u5fc5\u987b\u5272\u6389\u67d0\u6761\u8fb9\uff0c\u5426\u5219 $S->X_i->T$ \u4ecd\u53ef\u884c\u4e0d\u662f\u6700\u5c0f\u5272\u3002\n\n\u5982\u679c\u6ca1\u770b\u61c2\u7684\u8bdd\u770b\u770b\u4ee3\u7801\u600e\u4e48\u5efa\u56fe\u5c31\u53ef\u4ee5\u4e86\u3002\n\n```cpp\n//HNOI,2013\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<queue>\n#define op(x) x+((x&1)?1:-1)\n#define out(x) x+p*q*r\n#define next Cry_For_theMoon\nusing namespace std;\ntypedef long long ll;\nconst int MAXN=2e5+10,MAXM=5e6+10,INF=2e9,pv[4][2]={{1,0},{0,1},{-1,0},{0,-1}};\nstruct Edge{\n\tint u,v,cap,flow;\n}edge[MAXM];\nint first[MAXN],next[MAXM],tot;\nint p,q,r,d,s,t;\nint dis[MAXN],vis[MAXN],cur[MAXN];\nvoid addedge(int u,int v,int cap){\n\tedge[++tot].u=u;edge[tot].v=v;edge[tot].cap=cap;\n\tnext[tot]=first[u];first[u]=tot;\n}\ninline int Hash(int x,int y,int z){\n\treturn (z-1)*(p*q) + (x-1)*q + y;\n}\nint bfs(){\n\tmemset(dis,0,sizeof dis);memset(vis,0,sizeof vis);\n\tqueue<int>q;q.push(s);vis[s]=1;\n\twhile(!q.empty()){\n\t\tint u=q.front();q.pop();\n\t\tfor(int j=first[u];j;j=next[j]){\n\t\t\tint v=edge[j].v;\n\t\t\tif(vis[v] || edge[j].cap==edge[j].flow)continue;\n\t\t\tvis[v]=dis[v]=dis[u]+1;\n\t\t\tq.push(v);\n\t\t}\n\t}\n\treturn vis[t];\n}\nint dfs(int u,int a){\n\tif(u==t||!a)return a;\n\tint flow=0,val;\n\tfor(int& j=cur[u];j;j=next[j]){\n\t\tint v=edge[j].v;\n\t\tif(dis[v]!=dis[u]+1)continue;\n\t\tval=dfs(v,min(a,edge[j].cap-edge[j].flow));\n\t\tif(val){\n\t\t\tflow+=val;a-=val;\n\t\t\tedge[j].flow+=val;edge[op(j)].flow-=val;\n\t\t}\n\t\tif(!a)break;\n\t}\n\treturn flow;\n}\nint dinic(){\n\tint flow=0;\n\twhile(bfs()){\n\t\tfor(int i=1;i<=t;i++){cur[i]=first[i];}\n\t\tflow+=dfs(s,INF);\n\t}\n\treturn flow;\n}\nint main(){\n\tscanf(\"%d%d%d%d\",&p,&q,&r,&d);\n\ts=2*p*q*r+1,t=s+1; \n\tfor(int i=1;i<=r;i++){\n\t\tfor(int j=1;j<=p;j++){\n\t\t\tfor(int k=1,v;k<=q;k++){\n\t\t\t\tscanf(\"%d\",&v);\n\t\t\t\taddedge(Hash(j,k,i),out(Hash(j,k,i)),v);addedge(out(Hash(j,k,i)),Hash(j,k,i),0);\n\t\t\t}\n\t\t} \n\t}\n\tfor(int i=1;i<=r;i++){\n\t\tfor(int j=1;j<=p;j++){\n\t\t\tfor(int k=1;k<=q;k++){ \n\t\t\t\tif(i==1){\n\t\t\t\t\taddedge(s,Hash(j,k,i),INF);addedge(Hash(j,k,i),s,0);\n\t\t\t\t}\n\t\t\t\tif(i==r){\n\t\t\t\t\taddedge(out(Hash(j,k,i)),t,INF);addedge(t,out(Hash(j,k,i)),0);\n\t\t\t\t}else{ \n\t\t\t\t\taddedge(out(Hash(j,k,i)),Hash(j,k,i+1),INF);addedge(Hash(j,k,i+1),out(Hash(j,k,i)),0); \n\t\t\t\t}\n\t\t\t\tint lr=max(1,i-d),rr=min(r,i+d);\n\t\t\t\tfor(int idx=0;idx<4;idx++){\n\t\t\t\t\tint x=j+pv[idx][0],y=k+pv[idx][1];\n\t\t\t\t\tif(x<1 || x>p || y<1 || y>q)continue;\n\t\t\t\t\taddedge(Hash(j,k,i),Hash(x,y,lr),INF);addedge(Hash(x,y,lr),Hash(j,k,i),0);\n\t\t\t\t\taddedge(out(Hash(x,y,rr)),out(Hash(j,k,i)),INF);addedge(out(Hash(j,k,i)),out(Hash(x,y,rr)),0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\",dinic());\n\treturn 0;\n}\n```\n",
        "postTime": 1610114023,
        "uid": 340632,
        "name": "Cry_For_theMoon",
        "ccfLevel": 8,
        "title": "\u3010HNOI2013\u3011\u5207\u7cd5"
    },
    {
        "content": "\u8fd8\u662f\u5f88\u5de7\u5999\u7684\uff0c\u5982\u679c\u5728\u573a\u4e0a\u6211 $100\\%$ \u60f3\u4e0d\u5230\u7528\u7f51\u7edc\u6d41\u3002\n\n\u9898\u76ee\u4e00\u5806\u6587\u5b57\u90fd\u662f\u5728\u89e3\u91ca**\u62e6\u8170\u5207**\uff0c\u5982\u679c\u660e\u767d\u8fd9\u4e00\u70b9\u5bf9\u505a\u9898\u6bd4\u8f83\u6709\u5e2e\u52a9\u3002\n\n\u73b0\u5728\u95ee\u9898\u8f6c\u6362\u4e3a\uff1a\u6709\u4e00\u4e2a $p\\times q$ \u7684\u77e9\u9635\uff0c\u6bcf\u4e2a\u5143\u7d20\u53c8\u662f\u4e00\u4e2a\u957f\u5ea6\u4e3a $r$ \u7684\u6570\u5217\u3002\u5b9a\u4e49\u77e9\u9635\u4e2d\u4efb\u610f\u4e24\u4e2a\u5143\u7d20\u76f8\u90bb\u5f53\u4e14\u4ec5\u5f53\u4e24\u4e2a\u5143\u7d20\u7684\u884c\u6216\u5217\u5dee1\uff0c\u540c\u65f6\u53e6\u4e00\u4e2a\u76f8\u7b49\uff0c\u73b0\u5728\u5e0c\u671b\u5728 $p\\times q$ \u4e2a\u6570\u5217\u4e2d\u5404\u53d6\u4e00\u4e2a\u6570\uff0c\u6ee1\u8db3\u76f8\u90bb\u7684\u6570\u5217\u4e2d\u53d6\u51fa\u7684\u6570\u5728\u539f\u6570\u5217\u7684\u4f4d\u7f6e\u7684\u5dee\u4e0d\u5927\u4e8e $d$\u3002\u6c42\u8fd9 $p\\times $ q\u4e2a\u6570\u548c\u7684\u6700\u5c0f\u503c\u3002\n\n\u5982\u679c\u77e5\u9053\u4e86\u7528\u7f51\u7edc\u6d41\u89e3\u51b3\uff0c\u53ef\u4ee5\u81ea\u7136\u800c\u7136(?)\u5730\u60f3\u5230\u6700\u5c0f\u5272\u3002\n\n\u5bf9\u4e8e $(i,j,k)$ \uff0c\u8fde\u4e0a $(i,j,k+1),(i,j+1,k-d),(i,j-1,k-d),(i+1,j,k-d),(i-1,j,k-d)$\uff0c\u518d\u7528Dinic\u8fdb\u884c\u6700\u5c0f\u5272\u5373\u53ef\u3002\n\n\u6ce8\u610f\u5904\u7406\u8fb9\u754c\u6761\u4ef6\u3002\n\n## \u5c0f\u7ed3\uff1a\n\u4e0d\u77e5\u4e3a\u4f55\uff0c\u6709\u70b9\u60f3\u5230\u5206\u5c42\u56fe\u3002\n\n\u6bd5\u7adf\u662f\u7701\u9009\u9898\uff0c\u4e5f\u5e94\u8be5\u5f80\u7f51\u7edc\u6d41\u4e4b\u7c7b\u9ad8\u5927\u4e0a\u7b97\u6cd5\u53bb\u9760\u3002\n\n\u7f51\u7edc\u6d41\u8fd9\u79cd\u5c5e\u4e8e\u53d8\u5316\u6bd4\u8f83\u591a\uff0c\u4ee3\u7801\u6bd4\u8f83\u7b80\u5355\u7684\uff0c\u5982\u679c\u60f3\u5230\u4e86\u5c31\u547c\u4e4b\u6b32\u51fa\u3002\n\n\u611f\u89c9\u53ea\u8981\u51fa\u73b0\u6bd4\u8f83\u590d\u6742\u7684\u8f6c\u79fb\u4ee5\u53ca\u6700\u503c\u5c31\u53ef\u4ee5\u8003\u8651\u4e00\u4e0b\u7f51\u7edc\u6d41\u3002\n\n\u6700\u540e\u662f\u559c\u95fb\u4e50\u89c1\u7684\u4ee3\u7801\uff08EK\u7f51\u7edc\u6d41\uff09\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\ninline int read()\n{\n\tint x=0,flag=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9')\n\t{\n\t\tif(ch=='-')\n\t\t\tflag=0;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0'&&ch<='9')\n\t{\n\t\tx=(x<<3)+(x<<1)+ch-'0';\n\t\tch=getchar();\n\t}\n\tif(flag)\n\t\treturn x;\n\telse\n\t\treturn ~(x-1);\n}\nstruct node{\n\tint to,val,next;\n} edge[128002];\nstruct Pre{\n\tint from,pre;\n} P[128002];\nint fx[4]={0,1,0,-1};\nint fy[4]={1,0,-1,0};\nint cnt=1,p,q,r,d,s,t,inque[64001],head[6401],v[110][110][100];\ninline int id(int x,int y,int z)\n{\n\treturn p*q*(z-1)+y+(x-1)*q;\n}\ninline bool in(int x,int y)\n{\n\treturn x>=1&&x<=p&&y>=1&&y<=q;\n}\ninline void add(int x,int y,int z)\n{\n\tedge[++cnt].to=y;\n\tedge[cnt].val=z;\n\tedge[cnt].next=head[x];\n\thead[x]=cnt;\n}\ninline bool bfs()\n{\n\tqueue<int> q;\n\tmemset(inque,0,sizeof(inque));\n\tinque[s]=1;\n\tq.push(s);\n\twhile(!q.empty())\n\t{\n\t\tint f=q.front();\n\t\tq.pop();\n\t\tfor(int i=head[f];i;i=edge[i].next)\n\t\t\tif(edge[i].val&&inque[edge[i].to]==0)\n\t\t\t{\n\t\t\t\tP[edge[i].to].from=f;\n\t\t\t\tP[edge[i].to].pre=i;\n\t\t\t\tif(edge[i].to==t)\n\t\t\t\t\treturn 1;\n\t\t\t\tinque[edge[i].to]=1;\n\t\t\t\tq.push(edge[i].to);\n\t\t\t}\n\t}\n\treturn 0;\n}\ninline int EK()\n{\n\tint ans=0;\n\twhile(bfs())\n\t{\n\t\tint minn=114514114514114514;\n\t\tfor(int i=t;i!=s;i=P[i].from)\n\t\t\tminn=min(minn,edge[P[i].pre].val);\n\t\tfor(int i=t;i!=s;i=P[i].from)\n\t\t{\n\t\t\tedge[P[i].pre].val-=minn;\n\t\t\tedge[P[i].pre^1].val+=minn;\n\t\t}\n\t\tans+=minn;\n\t}\n\treturn ans;\n}\nsigned main()\n{\n\tp=read();\n\tq=read();\n\tr=read();\n\td=read();\n\ts=p*q*(r+1)+1;\n\tt=p*q*(r+1)+2;\n\tfor(int k=1;k<=r;k++)\n\t\tfor(int i=1;i<=p;i++)\n\t\t\tfor(int l=1;l<=q;l++)\n\t\t\t\tv[i][l][k]=read();\n\tfor(int i=1;i<=p;i++)\n\t\tfor(int l=1;l<=q;l++)\n\t\t{\n\t\t\tadd(s,id(i,l,1),114514114514114514);\n\t\t\tadd(id(i,l,1),s,0);\n\t\t\tfor(int k=1;k<=r;k++)\n\t\t\t{\n\t\t\t\tadd(id(i,l,k),id(i,l,k+1),v[i][l][k]);\n\t\t\t\tadd(id(i,l,k+1),id(i,l,k),0);\n\t\t\t}\n\t\t\tadd(id(i,l,r+1),t,114514114514114514);\n\t\t\tadd(t,id(i,l,r+1),0);\n\t\t}\n\tfor(int i=1;i<=p;++i)\n\t\tfor(int j=1;j<=q;++j)\n\t\t\tfor(int k=0;k<4;++k)\n\t\t\t{\n\t\t\t\tint x=i+fx[k],y=j+fy[k];\n\t\t\t\tif(!in(x,y)) \n\t\t\t\t\tcontinue;\n\t\t\t\tfor(int l=d+1;l<=r+1;++l) \n\t\t\t\t{\n\t\t\t\t\tadd(id(i,j,l),id(x,y,l-d),114514114514114514);\n\t\t\t\t\tadd(id(x,y,l-d),id(i,j,l),0);\n\t\t\t\t}\n\t\t\t}\n\tcout<<EK();\n\treturn 0;\t\n} \n```\n",
        "postTime": 1601901499,
        "uid": 240812,
        "name": "45dino",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3227 \u3010[HNOI2013]\u5207\u7cd5\u3011"
    },
    {
        "content": "\u6765\u6e90\uff1a[http://ozem.pw/archives/1201][1]\n\n![\u5982\u56fe](http://i1.piimg.com/567571/9e191d3050ae3c10.png)\n\n\u6211\u4eec\u5c06\u70b9\u8f6c\u5316\u6210\u8fb9\uff0c\u90a3\u4e48\u9009\u70b9\u5c31\u7b49\u4e8e\u5272\u8fb9\uff0c\u7b2c\u4e00\u4e2a\u6761\u4ef6\u6ee1\u8db3\n\n\u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u6761\u4ef6\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e9binf\u7684\u8fb9\u6765\"\u5c4f\u853d\"\u90a3\u4e9b\u4e0d\u80fd\u5272\u7684\u8fb9\uff0c\u4ecez\u5411\"\u76f8\u90bb\u7684\"\u8def\u5f84\u7684z-d\u53f7\u70b9\u8fdeinf\u7684\u8fb9\uff08\u5982\u4e0a\u56fe\uff09\u8fd9\u6837\u505a\u4e4b\u540e\uff0c\u5982\u679c\u5220\u4e86\u8fd9\u6761\u8fb9\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e9b\u6865\u6881\uff0c\u4ece\u76f8\u90bb\u7684\u8def\u5f84\u7684\u4e00\u6bb5[z-d,z+d]\u7ed5\u8fc7\uff0c\u6240\u4ee5\u5272\u90a3\u4e9b\u8fb9\u5c31\u6ca1\u6709\u610f\u4e49\u4e86\n\n\u4ece\u800c\u5b9e\u73b0\u5fc5\u987b\u5272[z-d,z+d]\u7684\u76ee\u7684\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<queue>\n#define MAXN 200000\n#define inf 0x3f3f3f3f\nstruct Edge {\n    int u;\n    int v;\n    int cap;\n    int nxt;\n    Edge() {}\n    Edge(int _u,int _v,int _cap,int _nxt):u(_u),v(_v),cap(_cap),nxt(_nxt) {}\n} edge[MAXN*10+1];\nint head[MAXN+1];\ninline int min(int a,int b) {\n    if(a<b) return a;\n    return b;\n}\n\nstruct Dicnic {\n    int tot,dis[MAXN+1],cur[MAXN+1];\n    void init() {\n        tot=0;memset(head,-1,sizeof(head));memset(cur,-1,sizeof(cur));\n    }\n    void AddEdge(int u,int v,int c) {\n        edge[tot]=Edge(u,v,c,head[u]);\n        head[u]=tot++;\n        edge[tot]=Edge(v,u,0,head[v]);\n        head[v]=tot++;\n    }\n    void BFS(int s) {\n        memset(dis,-1,sizeof(dis));\n        std::queue<int> q;\n        dis[s]=0;\n        q.push(s);\n        while(!q.empty()) {\n            int v=q.front();q.pop();\n            for(int i=head[v]; i!=-1; i=edge[i].nxt) {\n                Edge e=edge[i];\n                if(e.cap>0&&dis[e.v]==-1) {\n                    dis[e.v]=dis[v]+1;\n                    q.push(e.v);\n                }\n            }\n        }\n    }\n    int DFS(int v,int t,int low) {\n        if(v==t) return low;\n        for(int &i=cur[v]; i!=-1; i=edge[i].nxt) {\n            Edge &e=edge[i],&reve=edge[i^1];\n            if(e.cap>0&&dis[e.v]>dis[v]) {\n                int d=DFS(e.v,t,min(low,e.cap));\n                if(d>0){\n                    e.cap-=d;\n                    reve.cap+=d;\n                    return d;\n                }\n            }\n        }\n        return 0;\n    }\n    int Max_Flow(int s,int t) {\n        int flow=0,f=0;\n        while(1) {\n            BFS(s);\n            if(dis[t]==-1) return flow;\n            memcpy(cur,head,sizeof(cur));\n            while((f=DFS(s,t,inf))>0) flow+=f;\n        }\n    }\n} net;\nint g[50][50][50];\nconst int dir[4][2]={{1,0},{-1,0},{0,1},{0,-1}};\nint main() {\n    int P,Q,R,D,cnt=0;\n    net.init();\n    scanf(\"%d%d%d%d\",&P,&Q,&R,&D);\n    for(int i=1; i<=R+1; i++) {\n        for(int j=1; j<=P; j++) {\n            for(int k=1; k<=Q; k++) {\n                g[i][j][k]=++cnt;\n            }\n        }\n    }\n    const int s=0,t=cnt+1;\n    int v;\n    for(int i=1;i<=P;i++)\n        for(int j=1;j<=Q;j++){\n            net.AddEdge(s,g[1][i][j],inf);\n            net.AddEdge(g[R+1][i][j],t,inf);\n    }\n    for(int i=1; i<=R; i++) \n        for(int j=1; j<=P; j++) \n            for(int k=1; k<=Q; k++) {\n                scanf(\"%d\",&v);\n                net.AddEdge(g[i][j][k],g[i+1][j][k],v);//\u5411\u4e0a\u8fde\u8fb9 \n            }\n    for(int i=D+1;i<=R;i++)\n        for(int j=1;j<=P;j++)\n            for(int k=1;k<=Q;k++){\n                for(int m=0;m<4;m++){\n                    if(g[i-D][j+dir[m][0]][k+dir[m][2]]>0){\n                        net.AddEdge(g[i][j][k],g[i-D][j+dir[m][0]][k+dir[m][3]],inf);\n                    }\n                }\n            }\n    printf(\"%d\\n\",net.Max_Flow(s,t));\n    return 0;\n}\n```\n\n\n[1]: http://ozem.pw/archives/1201\n",
        "postTime": 1488453905,
        "uid": 16225,
        "name": "EkiXu",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3227 \u3010[HNOI2013]\u5207\u7cd5\u3011"
    },
    {
        "content": "\u5c31\u662f\u66b4\u529b\u628a\u6240\u6709\u70b9\u90fd\u5efa\u51fa\u6765\uff1a\n\nP\\*Q\\*R\u4e2a\u70b9\uff0c\u4eceP\\*Q\u4e2aR-1\u5c42\u5230R\u5c42\u7684\u70b9\u8fde\u8fb9\u4ee3\u8868\u9009\u62e9\u8fd9\u4e00\u5c42\u7684\u6743\u503c\uff1b\n\n\u52a0\u4e00\u4e2a0\u5c42\uff0cS\u52300\u5c42\u8fdeINF\uff0cR\u5c42\u5230T\u8fdeINF\uff0c\u76f8\u90bb\u76f8\u5dee\u8d85\u8fc7D\u7684\u5c42\u8fdeINF\n\n\u8fd9\u6837\u6700\u5c0f\u5272\uff08=\u6700\u5927\u6d41\uff09\u5c31\u4ee3\u8868\u6bcf\u4e2a\u65b9\u683c\u5fc5\u987b\u9009\u4e00\u4e2a\u5c42\uff0c\u76f8\u90bb\u65b9\u683c\u5dee\u4e0d\u8d85\u8fc7D\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n\n\n\n\n\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\n#define MAXN 100000\n#define MAXM 500000\n#define INF 0x3f3f3f3f\n#define v(x,y,z) (~-(x)*2000+~-(y)*50+(z))\n#define gc() getchar()\ninline int read(int ans = 0, int sgn = ' ', int ch = gc())\n{\n    for(;ch < '0' || ch > '9'; sgn=ch,ch=gc());\n    for(;ch >='0' && ch <='9'; (ans*=10)+=ch-'0',ch=gc());\n    return sgn-'-' ? ans : -ans;\n}\nstruct Edge\n{\n    int to,nex;\n    int c;\n    Edge(int _to=0, int _nex=0, int _c=0):to(_to),nex(_nex),c(_c){}\n}e[MAXM+5];\nint first[MAXN+5], q[MAXN+5], level[MAXN+5], cur[MAXN+5], c[MAXN+5], tot, P, Q, R, D, N, S, T;\nint mx[4][2] = {{1,0},{-1,0},{0,1},{0,-1}};\ninline void Add(int a, int b, int c)\n{\n    e[tot] = Edge(b,first[a],c), first[a] = tot++;\n    e[tot] = Edge(a,first[b],0), first[b] = tot++;\n    return;\n}\ninline bool BFS()\n{\n    memset(level,0,sizeof(level)), q[0] = S, level[S] = 1;\n    for(register int head = 0, tail = 1, t, u, v; head-tail; )\n        for(t = q[head++], head %= MAXN, u = first[t]; u+1; u = e[u].nex)\n            if(e[u].c > 0 && !level[v=e[u].to])\n            {\n                level[v] = level[t]+1, q[tail++] = v, tail %= MAXN;\n                if(v == T)\n                    return true;\n            }\n    return false;\n}\nint DFS(int p, int f, int tag = 0, int del = 0)\n{\n    if(p == T)\n        return f;\n    for(register int &u = cur[p], v; u+1; u = e[u].nex)\n        if(e[u].c > 0 && level[v=e[u].to] == level[p]+1)\n        {\n            del = DFS(v,min(e[u].c,f-tag)), e[u].c -= del, e[u^1].c += del, tag += del;\n            if(f == tag)\n                return tag;\n        }\n    return tag;\n}\ninline int Dinic(int ans = 0)\n{\n    for(register int i; BFS(); ans += DFS(S,INF))\n        for(i = 0; i <= N; cur[i] = first[i], i++);\n    return ans;\n}\nint main()\n{\n    P = read(), Q = read(), R = read(), D = read(), memset(first,-1,sizeof(first)), S = 0, N = T = v(P,Q,R+1);\n    for(register int z = 1, x, y; z <= R; z++)\n        for(x = 1; x <= P; x++)\n            for(y = 1; y <= Q; y++)\n                Add(v(x,y,z-1),v(x,y,z),read());\n    for(register int x = 1, y, k, nx, ny, z; x <= P; x++)\n        for(y = 1; y <= Q; y++)\n            for(Add(S,v(x,y,0),INF), Add(v(x,y,R),T,INF), k = 0; k < 4; k++)\n            {\n                nx = x+mx[k][0], ny = y+mx[k][1];\n                if(nx < 1 || nx > P || ny < 1 || ny > Q)\n                    continue;\n                for(z = D+1; z <= R; Add(v(x,y,z),v(nx,ny,z-D),INF), z++);\n            }\n    printf(\"%d\\n\",Dinic());\n    return 0;\n}\n```",
        "postTime": 1486814480,
        "uid": 16528,
        "name": "magolor",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3227 \u3010[HNOI2013]\u5207\u7cd5\u3011"
    },
    {
        "content": "\u5206\u6790\uff1a\n\n\u5148\u8003\u8651\u6ca1\u6709D\u7684\u9650\u5236\uff0c\u5f53\u7136\u662f\u6bcf\u6839\u7eb5\u8f74\u90fd\u53d6\u6700\u5c0f\u503c\u3002\n\n\u5efa\u7acb\u7f51\u7edc\u6d41\u6a21\u578b\uff0c\u5c31\u662f(i,j,k)\u5411(i,j,k+1)\u8fde\u4e00\u6761\u5bb9\u91cf\u4e3a1\u7684\u8fb9\u3002\n\n\u5efa\u7acbS\u548cT\uff0cS\u5411(i,j,1)\u8fde\u4e00\u6761\u5bb9\u91cf\u4e3a1\u7684\u8fb9\uff0c(i,j,R)\u5411T\u8fde\u5bb9\u91cf\u4e3a1\u7684\u8fb9\u3002\n\n\u7b54\u6848\u5c31\u662f\u6700\u5c0f\u5272\u3002\n\n\u90a3\u4e48\u73b0\u5728\u52a0\u4e0a\tD\u7684\u9650\u5236\u600e\u4e48\u529e\u5462\uff1f\n\n\u60f3\u529e\u6cd5\u5728\u539f\u57fa\u7840\u4e0a\u4f7f\u5272\u6389\u4e0d\u5408\u6cd5\u7684\u8fb9\u540eS\u548cT\u8fde\u901a\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u6211\u4eec\u53d1\u73b0(i,j,k)\u5411(i,j,k-D)\u8fde\u4e00\u6761\u5bb9\u91cf\u4e3ainf\u7684\u8fb9\u5c31\u53ef\u4ee5\u8fbe\u6210\u8981\u6c42\u4e86\u3002\n\n\n\u4ee3\u7801\uff1a\n```cpp\n\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n\nusing namespace std;\n\nconst int inf=1e9;\n\nint to[1000001],w[1000001],next[1000001],first[1000001],cur[1000001],now,ans=0;\nint P,Q,R,D,S,T,v[50][50][50],d[1000001],e[1000001],f[1000001],mi=inf,e1;\n\nint idx(int x,int y,int z){return (x-1)*P*Q+(y-1)*Q+z;}\n\nvoid insert(int o,int p,int q)\n{\n    to[e1]=p;w[e1]=q;next[e1]=first[o];first[o]=e1++;\n    to[e1]=o;w[e1]=0;next[e1]=first[p];first[p]=e1++;\n}\n\nint main()\n{\n    memset(first,-1,sizeof(first));\n    scanf(\"%d%d%d%d\",&P,&Q,&R,&D);\n    S=P*Q*R+1;T=S+1;\n    for(int i=1;i<=R;i++)\n        for(int j=1;j<=P;j++)\n            for(int k=1;k<=Q;k++)\n            {\n                scanf(\"%d\",&v[i][j][k]);\n                if(i==1) insert(S,idx(i,j,k),inf);\n                if(i!=R) insert(idx(i,j,k),idx(i+1,j,k),v[i][j][k]);else\n                insert(idx(i,j,k),T,v[i][j][k]);\n                if(i>D)\n                {\n                    if(j>1) insert(idx(i,j,k),idx(i-D,j-1,k),inf);\n                    if(j<P) insert(idx(i,j,k),idx(i-D,j+1,k),inf);\n                    if(k>1) insert(idx(i,j,k),idx(i-D,j,k-1),inf);\n                    if(k<Q) insert(idx(i,j,k),idx(i-D,j,k+1),inf);\n                }\n            }\n    memset(e,-1,sizeof(e));\n    memset(d,0,sizeof(d));\n    memset(f,0,sizeof(f));\n    for(int i=0;i<=T;i++) cur[i]=first[i];\n    now=e[S]=S;f[0]=T;\n    while(d[S]<T)\n    {\n        bool bo=false;\n        if(now==-1) break;\n        for(int i=cur[now];i!=-1;i=next[i])\n            if((w[i]>0)&&(d[now]==(d[to[i]]+1)))\n            {\n                cur[now]=i;\n                mi=min(mi,w[i]);\n                e[to[i]]=now;\n                now=to[i];\n                bo=true;\n                if(now==T)\n                {\n                    ans+=mi;\n                    while(now!=S)\n                    {\n                        w[cur[e[now]]]-=mi;\n                        w[cur[e[now]]^1]+=mi;\n                        now=e[now];\n                    }\n                    mi=inf;\n                }\n                break;\n            }\n        if(bo) continue;int mmi=T;\n        for(int i=first[now];i!=-1;i=next[i])\n            if((w[i]>0)&&(mmi>d[to[i]])){mmi=d[to[i]];cur[now]=i;}\n        if(!(--f[d[now]])) break;\n        f[d[now]=(mmi+1)]++;\n        now=e[now];\n    }\n    cout<<ans<<endl;\n    return 0;\n}\n```",
        "postTime": 1527644027,
        "uid": 79044,
        "name": "\u7834\u58c1\u4eba",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3227 \u3010[HNOI2013]\u5207\u7cd5\u3011"
    }
]
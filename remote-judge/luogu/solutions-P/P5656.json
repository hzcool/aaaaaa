[
    {
        "content": "\u672c\u9898\u7684\u51fa\u9898\u4eba\u6765\u653e\u4e00\u4e2a\u9898\u89e3~\n\n\u4ee5\u8fd9\u9053\u9898\u4e3a\u6a21\u677f\uff0c\u6d1b\u8c37\u4e0a\u6240\u6709$\\text{exgcd}$\u7684\u9898\u76f4\u63a5\u6539\u6539\u90fd\u80fd\u8fc7\uff08\n\n$$ax+by=c$$\n\n\u663e\u7136\u6709 $\\gcd(a,b)|(ax+by)$ \uff0c\u6545\u82e5 $c$ \u4e0d\u662f $\\gcd(a,b)$ \u7684\u500d\u6570\u76f4\u63a5\u65e0\u89e3\n\n\n\u6211\u4eec\u5df2\u77e5$\\text{exgcd}$\u53ef\u4ee5\u6c42\u51fa\n\n$$ax+by=\\gcd(a,b)$$\n\n\u7684\u4e00\u7ec4\u6574\u6570\u7279\u89e3\uff0c\u6211\u4eec\u8bb0\u4e3a $x_0$ \u4e0e $y_0$\n\n\u5219\u6709\n\n$$ax_0+by_0=\\gcd(a,b)$$\n\n$$a\\frac{x_0c}{\\gcd(a,b)}+b\\frac{y_0c}{\\gcd(a,b)}=c$$\n\n\u6545\u6211\u4eec\u5df2\u7ecf\u627e\u5230\u4e86\u539f\u65b9\u7a0b\u7684\u4e00\u7ec4\u6574\u6570\u7279\u89e3\uff0c\u8bb0\u4e3a $x_1$ \u548c $y_1$\n\n$$x_1=\\frac{x_0c}{\\gcd(a,b)}, y_1=\\frac{y_0c}{\\gcd(a,b)}$$\n\n\u90a3\u4e48\u6211\u4eec\u8003\u8651\u6784\u9020\u539f\u65b9\u7a0b\u6574\u6570\u901a\u89e3\u5f62\u5f0f\n\n\u6211\u4eec\u8bbe\u4efb\u610f $d \\in \\mathbb{Q}$ \uff0c\u90a3\u4e48\u5fc5\u6709\n\n$$a(x_1+db)+b(y_1-da)=c$$\n\n\uff08\u81ea\u884c\u62c6\u62ec\u53f7\uff0c\u76f4\u63a5\u6d88\u6389\uff09\n\n\u540c\u65f6\uff0c\u901a\u89e3\u9700\u8981\u4fdd\u8bc1 $x_1+db$ \u4e0e $y_1-da$ \u5747\u4e3a\u6574\u6570\n\n\u56e0\u4e3a $x_1$ , $y_1$ \u4e3a\u6574\u6570\uff0c\u6211\u4eec\u53ea\u9700\u8981\u4fdd\u8bc1\n\n$db \\in \\mathbb{Z} $\uff0c$da \\in \\mathbb{Z} $\n\n\u4ee4\u5f53 $d$ \u53d6\u5230\u6700\u5c0f\u7684\u53ef\u80fd\u7684\u6b63\u503c\u65f6\u7684 $d_x=db$\uff0c$d_y=da$ \uff0c\u90a3\u4e48\u4efb\u610f\u89e3\u4e2d\u8fd9\u4e24\u4e2a\u53d8\u91cf\u4e0e $x_1$ $y_1$ \u7684\u504f\u5dee\u4e00\u5b9a\u5206\u522b\u662f $d_x$ \u4e0e $d_y$ \u7684\u500d\u6570\n\n\u663e\u7136\u6700\u5c0f\u65f6 $d_x=\\frac{b}{\\gcd(a,b)}$ \uff0c $d_y=\\frac{a}{\\gcd(a,b)}$\uff0c\u5728$d=\\frac{1}{\\gcd(a,b)}$ \u65f6\u53d6\u5230\n\n\u90a3\u4e48\u901a\u89e3\u5f62\u5f0f\u5c31\u51fa\u6765\u4e86\uff0c\n\n$$x=x_1+sd_x$$\n$$y=y_1-sd_y$$\n\n\u5176\u4e2d\uff0c$s$ \u662f\u4efb\u610f\u6574\u6570\n\n\u800c\u4e14\uff0c\u968f\u7740 $x$ \u589e\u5927 $y$ \u51cf\u5c0f \uff08\u5e9f\u8bdd\uff0c\u5b83\u4eec\u7684\u548c\u4e00\u5b9a\uff09\n\n\u800c\u4e14\uff0c$s$ \u8d8a\u5927\uff0c$x$ \u8d8a\u5927\uff0c$y$ \u8d8a\u5c0f\uff0c\u53cd\u4e4b\u4ea6\u7136\uff08\u91cd\u70b9\uff09\n\n\u6545\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u89e3\u9898\uff1a\n\n\u82e5\u6211\u4eec\u9650\u5236 $x>0$\uff0c\u6709$x_1+sd_x>0$\uff0c$s>-\\frac{x_1}{d_x}$\n\n\u82e5\u6211\u4eec\u9650\u5236 $y>0$\uff0c\u6709$y_1-sd_y>0$\uff0c$s<\\frac{y_1}{d_y}$\n\n\u90a3\u4e48\u6211\u4eec\u6709 $-\\frac{x_1}{d_x}<s<\\frac{y_1}{d_y}$\n\n\u56e0\u4e3a $s$ \u662f\u6574\u6570\uff0c\u6545\u6709\n\n$$\\lceil\\frac{-x_1+1}{d_x}\\rceil\\leq s\\leq\\lfloor\\frac{y_1-1}{d_y}\\rfloor$$\n\n\u82e5 $\\lceil\\frac{-x_1+1}{d_x}\\rceil> \\lfloor\\frac{y_1-1}{d_y}\\rfloor$\uff0c\u90a3\u4e48\u663e\u7136\u4e0d\u53ef\u80fd\u8ba9\u4e24\u4e2a\u90fd\u662f\u6b63\u6574\u6570\uff08\u56e0\u4e3a\u6ca1\u6709\u5408\u6cd5\u7684 $s$\uff09\n\n\u6b64\u65f6\uff0c\u7b54\u6848\u5373\u4e3a\u6ca1\u6709\u6b63\u6574\u6570\u89e3\u4f46\u6709\u6574\u6570\u89e3\uff0c$x$ \u6700\u5c0f\u5373\u4e3a$s=\\lceil\\frac{-x_1+1}{d_x}\\rceil$\u65f6 $x$ \u7684\u503c\uff0c$y$ \u6700\u5c0f\u5373\u4e3a$s=\\lfloor\\frac{y_1-1}{d_y}\\rfloor$\u65f6 $y$ \u7684\u503c\n\n\u5426\u5219\uff0c\u5c31\u6709\u6b63\u6574\u6570\u89e3\uff0c\u6b63\u6574\u6570\u89e3\u4e2a\u6570\u5373\u4e3a $s$ \u7684\u5408\u6cd5\u6574\u6570\u53d6\u503c\u4e2a\u6570\uff0c\u7b97\u597d\u4e0a\u4e0b\u754c\u76f4\u63a5\u505a\u3002\n\n\u800c\u6700\u5927\u6700\u5c0f\u503c\u4ec0\u4e48\u7684\uff0c$x$ \u7684\u6700\u5927\u503c\u548c $y$ \u7684\u6700\u5c0f\u503c\u90fd\u662f\u5728 $s$ \u6700\u5927\u65f6\u53d6\u5230\uff0c\u800c  $x$ \u7684\u6700\u5c0f\u503c\u548c $y$ \u7684\u6700\u5927\u503c\u90fd\u662f\u5728 $s$ \u6700\u5c0f\u65f6\u53d6\u5230\uff0c\u76f4\u63a5\u8ba1\u7b97\u5373\u53ef\u3002\n\n\u5176\u5b9e\u8fd9\u4e9b\u73a9\u610f\u662f\u53ef\u4ee5\u5316\u7b80\u4e3a\u66f4\u7b80\u5355\u7684\u5f62\u5f0f\u7684\uff08\u8be6\u89c1\u5176\u4ed6\u9898\u89e3\uff09\uff0c\u4f46\u6211\u8ba4\u4e3a\u8fd9\u4e2a\u89e3\u9898\u601d\u8def\u6700\u5bb9\u6613\u8ba9\u521d\u5b66\u8005\u7406\u89e3\u3002\n\n\u4ee3\u7801\u5c31\u4e0d\u653e\u4e86\uff0c\u4e11\u6b7b\u4e86\uff0c\u7167\u7740\u9898\u89e3\u91cc\u516c\u5f0f\u6572\u4e00\u904d\u5c31\u5b8c\u4e8b\u4e86\u3002\n\n\u5173\u4e8e\u5751\u70b9\uff1a\n\n\u5f00long long\u3002",
        "postTime": 1574085401,
        "uid": 62598,
        "name": "dengyaotriangle",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5656 \u3010\u3010\u6a21\u677f\u3011\u4e8c\u5143\u4e00\u6b21\u4e0d\u5b9a\u65b9\u7a0b(exgcd)\u3011"
    },
    {
        "content": "## \u9898\u76ee\u7b80\u8ff0\n\n$T(T\\leq2 *10^5)$\u7ec4\u6570\u636e,\u6bcf\u7ec4\u7ed9\u51fa$a,b,c$,\u8be2\u95ee\u4f7f\u5f97$ax+by=c$\u6210\u7acb\u7684\u89e3.$a,b,c\\in[1,10^9]$\n\n\u82e5\u6709\u6b63\u6574\u6570\u89e3,\u8f93\u51fa:\n\n- **\u6b63\u6574\u6570\u89e3**\u7684\u4e2a\u6570\n- **\u6b63\u6574\u6570\u89e3**\u4e2d,\u6700\u5c0f\u7684$x$\u4e0e\u6700\u5c0f\u7684$y$\n- **\u6b63\u6574\u6570\u89e3**\u4e2d,\u6700\u5927\u7684$x$\u4e0e\u6700\u5927\u7684$y$\n\n\u5426\u5219,\u82e5\u6709\u6574\u6570\u89e3,\u8f93\u51fa:\n\n- \u6240\u6709**\u6574\u6570\u89e3**\u4e2d $x$ \u7684\u6700\u5c0f\u6b63\u6574\u6570\u503c\uff0c $y$ \u7684\u6700\u5c0f\u6b63\u6574\u6570\u503c\n\n\u5426\u5219,\u8f93\u51fa$-1$.\n\n---\n\n## \u9898\u89e3\n\n\u7531**\u88f4\u8700\u5b9a\u7406**\u53ef\u77e5,$a,b$\u53ef\u4ee5\u7ec4\u6210\u6240\u6709\u7684$\\gcd(a,b)$\u7684\u500d\u6570.\u56e0\u6b64,\u6211\u4eec\u53ea\u9700\u8981\u5224\u65ad$c$\u662f\u5426\u4e3a$\\gcd(a,b)$\u7684\u500d\u6570,\u5373\u53ef\u5224\u65ad\u662f\u5426\u6709\u89e3.\n\n\u5982\u679c\u6709\u89e3\u6211\u4eec\u53ef\u4ee5\u7528**\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5**\u6c42\u51fa\u4e00\u7ec4\u7279\u89e3$x',y'$,\u4f7f\u5f97$ax'+by'=\\gcd(a,b)$.\u6211\u4eec\u8bbe$d=\\gcd(a,b)$.\n\n$\\text{exgcd}($\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5$)$\u8be6\u60c5\u53ef~~\u4e0a\u767e\u5ea6~~[\u53c2\u8003OI-WIKI](https://oi-wiki.org/math/gcd/),\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0.\n\n\n\u6211\u4eec\u9700\u8981\u6c42\u51fa\u4f7f\u5f97$ax_0+by_0=c$\u7684\u89e3.\u8fd9\u65f6\u5019,\u6211\u4eec\u53ea\u9700\u8981\u5c06$a,b$\u5206\u522b\u4e58\u4e0a$\\frac{c}{d}$\u5373\u53ef\u83b7\u5f97$x_0,y_0$.**\u63a5\u4e0b\u6765\u7684\u7b97\u6cd5\u5c06\u4f1a\u5927\u91cf\u8fd0\u7528\u8fd9\u7ec4\u7279\u89e3.**\n\n\u867d\u7136\u83b7\u5f97\u4e86\u4e00\u7ec4\u89e3,\u4f46\u662f\u4ed6\u5374$\\text{too simple}$.\u8fd9\u5f88\u663e\u7136\u5bf9\u6211\u4eec\u7684\u89e3\u9898\u5e2e\u52a9\u4e0d\u5927.\u56e0\u6b64\u6211\u4eec\u9700\u8981\u53d8\u6362\u4e00\u4e0b$x_0,y_0$.\n\n\u5047\u8bbe\u6211\u4eec\u8981\u5c06$x_0$\u6269\u5927,\u5373\u53d8\u6210$x_0+p$.~~\u89c2\u5bdf\u53ef\u5f97~~\u6211\u4eec\u9700\u8981\u5c06$y_0$\u7f29\u5c0f,\u5373$y_0$\u9700\u8981\u53d8\u6210$y_0-q$.\n\n$$\\begin{cases}a*(x_0+p)+b*(y_0-q)=c\\\\a*x_0+b*y_0=c\\end{cases}$$\n\n\u89e3\u5f97$p=\\frac{b*q}{a}$.\u6211\u4eec\u9700\u8981\u83b7\u5f97\u5c3d\u53ef\u80fd\u5c0f\u7684**\u6b63\u6574\u6570**$p,q$.\u90a3\u4e48\u5c31\u6709$a|b*q,b|b*q$.\u5373$b*q$\u7684\u6700\u5c0f\u503c\u4e3a$\\text{lcm}(a,b)=\\frac{a*b}{gcd(a,b)}$.\u5f97\u51fa:\n\n$$\\begin{cases}p_{min}=\\frac{b}{d}\\\\q_{min}=\\frac{a}{d}\\end{cases}$$\n\n### \u4e0b\u9762\u662f\u6700\u5173\u952e\u7684\u64cd\u4f5c\n\n\u6211\u4eec\u9700\u8981\u5c06$x_0$\u8c03\u81f3\u6700\u5c0f\u6b63\u6574\u6570,\u540c\u65f6\u6539\u53d8$y_0$\u7684\u503c.\n\n\u5177\u4f53\u64cd\u4f5c,\u5c31\u662f\u6211\u4eec\u6c42\u6700\u5c0f\u7684$k$,\u4f7f\u5f97$x_0+k*p\\geq1$.\u79fb\u9879,\u53ef\u5f97\n$$k>\\lceil\\frac{1-x_0}{p}\\rceil$$\n\n\u63a5\u7740,\u6211\u4eec\u5c31\u53ef\u4ee5$x_0+=p*k,y_0+=q*k$,\u6765\u6784\u9020\u51fa\u4e00\u7ec4\u8239\u65b0\u7684\u7279\u89e3,\u4f7f\u5f97$x_0$\u4e3a**\u6700\u5c0f\u6b63\u6574\u6570**.\n\n\u56de\u5230\u9898\u76ee.~~\u8fd9\u6761\u9898\u76ee\u8981\u6c42\u662f\u771f\u2122\u591a~~\n\n\u9996\u5148\u5224\u65ad\u6709\u89e3.\u7136\u540e\u5224\u65ad$y_0$\u662f\u5426\u5927\u4e8e$0($\u56e0\u4e3a\u6211\u4eec\u5df2\u7ecf\u4fdd\u8bc1\u4e86$x_0>0)$\u6765\u5904\u7406\u662f\u5426\u6709\u6b63\u6574\u6570\u89e3.\n\n\u6709\u6574\u6570\u89e3,\u90a3\u4e48\u6211\u4eec\u8981\u8f93\u51fa$5$\u4e2a\u6570\u5b57.\u8ba9\u6211\u4eec\u5206\u522b\u5904\u7406:\n\n### \u6709\u6b63\u6574\u6570\u89e3\n\n\u6ce8:\u4e0b\u8ff0\u60c5\u51b5\u5747\u4e3a\u6b63\u6574\u6570\u89e3\u7684\u60c5\u51b5.\n\n1.**\u89e3\u7684\u4e2a\u6570**.\u5f88\u663e\u7136,\u6211\u4eec\u53ea\u9700\u8981\u4e0d\u65ad\u5c06$y_0$\u51cf\u53bb$q$,\u540c\u65f6$x_0$\u52a0\u4e0a$p$\u5373\u53ef\u6784\u9020\u51fa\u6240\u6709\u53ef\u884c\u89e3.\u89e3\u7684\u603b\u4e2a\u6570\u4e3a$\\lfloor (y-1)/q\\rfloor +1$\n\n2.**$x$\u7684\u6700\u5c0f\u6b63\u6574\u6570\u503c**.\u8fd9\u5c31\u662f\u6211\u4eec\u6c42\u51fa\u7684$x_0$,\u8f93\u51fa\u5373\u53ef.\n\n3.**$y$\u7684\u6700\u5c0f\u6b63\u6574\u6570\u503c**.\u6211\u4eec\u53ea\u9700\u8981\u5c06$y_0$\u4e0d\u65ad\u51cf\u53bb$q($\u56e0\u4e3a$x_0$\u6700\u5c0f\u65f6,$y_0$\u4e00\u5b9a\u6700\u5927$)$,\u5373\u7b54\u6848\u4e3a$(y-1)\\%q+1$.\u9700\u8981\u7279\u6b8a\u6ce8\u610f\u4e00\u4e0b$0$\u7684\u60c5\u51b5.\n\n4.**$x$\u7684\u6700\u5927\u6b63\u6574\u6570\u503c**.\u6211\u4eec\u9700\u8981\u5c06$x_0$\u52a0\u4e0a\u5c3d\u53ef\u80fd\u591a\u7684$p$,\u4e5f\u5c31\u662f$y_0$\u8981\u51cf\u53bb\u5c3d\u53ef\u80fd\u591a\u7684$q$.\u7b54\u6848\u4e3a$x+\\lfloor(y-1)/q\\rfloor*p$\n\n5.**$y$\u7684\u6700\u5927\u6b63\u6574\u6570\u503c**.$x_0$\u4e3a\u6700\u5c0f\u6b63\u6574\u6570\u65f6,$y_0$\u81ea\u7136\u6700\u5927,\u8f93\u51fa\u5373\u53ef.\n\n### \u65e0\u6b63\u6574\u6570\u89e3\n\n1.**$x$\u7684\u6700\u5c0f\u6b63\u6574\u6570\u503c**,\u540c\u4e0a,\u5f53\u524d\u7684$x_0$\u5373\u4e3a\u6700\u5c0f\u7684\u6b63\u6574\u6570\u503c.\n\n2.**$y$\u7684\u6700\u5c0f\u6b63\u6574\u6570\u503c**.\u5f88\u663e\u7136,\u5f53\u524d$y_0\\leq 0($\u4e0d\u7136\u5c31\u5b58\u5728\u6b63\u6574\u6570\u89e3\u4e86$)$.\u6211\u4eec\u9700\u8981\u6267\u884c\u6784\u9020$x_0$\u7684\u65b9\u6cd5,\u5373$y_0+q*\\lceil((1.0-y)/q)\\rceil$\n\n### \u6700\u540e\u8981\u6ce8\u610f\u7684\n\n1. \u4e00\u5b9a\u8981\u5f00$\\text{long long}$,\u4e0d\u7136\u4f1a\u7206~~\u8840\u7684\u6559\u8bad~~\n\n2. \u8be5\u9898\u7ec6\u8282\u8d85\u591a,\u6bd4\u5982\u4e0a\u53d6\u6574,\u4e0b\u53d6\u6574\u8fd9\u4e9b\u4e1c\u897f\u90fd\u8981\u6d89\u53ca\u4e00\u5b9a\u7c7b\u578b\u8f6c\u6362\n\n## \u53c2\u8003\u7a0b\u5e8f\n\n```cpp\n#include<bits/stdc++.h>\n#define debug(x) printf(\"In function [%s],the value of [\"#x\"] is %d\\n\",__FUNCTION__,x)\n#define up(l,r,i) for(register int i=l;i<=r;++i)\n#define dn(r,l,i) for(register int i=r;i>=l;--i)\nusing namespace std;\ntypedef long long LL;\nconst int INF =2147483647;\nint qread(){\n\tint w=1,c,ret=0;\n\twhile((c=getchar())> '9'||c< '0')\n\tw=(c=='-'?-1:1); ret=c-'0';\n\twhile((c=getchar())>='0'&&c<='9')\n\tret=ret*10+c-'0';\n\treturn ret*w;\n}\nvoid qwrite(int x){\n\tif(x<0) x=-x,putchar('-');\n\tif(x>9) qwrite(x/10);\n\tputchar('0'+x%10);\n}\nLL exgcd(LL a,LL b,LL &x,LL &y){\n\tLL d=a; if(b==0) x=1,y=0; else{\n\t\td=exgcd(b,a%b,y,x),y-=a/b*x;\n\t}\n\treturn d;\n}\nint main(){\n\tdn(qread(),1,T){\n\t\tLL a=qread(),b=qread(),c=qread(),x,y;\n\t\tLL d=exgcd(a,b,x,y);\n\t\tif(c%d!=0) puts(\"-1\"); else{\n\t\t\tx*=c/d,y*=c/d; LL p=b/d,q=a/d,k;\n\t\t\tif(x<0) k=ceil((1.0-x)/p),x+=p*k,y-=q*k; else\t//\u5c06x\u63d0\u9ad8\u5230\u6700\u5c0f\u6b63\u6574\u6570 \n\t\t\tif(x>=0)k=(x-1)/p ,x-=p*k,y+=q*k;\t\t//\u5c06x\u964d\u4f4e\u5230\u6700\u5c0f\u6b63\u6574\u6570 \n\t\t\tif(y>0){\t//\u6709\u6b63\u6574\u6570\u89e3 \n\t\t\t\tprintf(\"%lld \",(y-1)/q+1);\t//\u5c06y\u51cf\u52301\u7684\u65b9\u6848\u6570\u5373\u4e3a\u89e3\u7684\u4e2a\u6570 \n\t\t\t\tprintf(\"%lld \",x);\t\t\t//\u5f53\u524d\u7684x\u5373\u4e3a\u6700\u5c0f\u6b63\u6574\u6570x\n\t\t\t\tprintf(\"%lld \",(y-1)%q+1); \t//\u5c06y\u53d6\u5230\u6700\u5c0f\u6b63\u6574\u6570 \n\t\t\t\tprintf(\"%lld \",x+(y-1)/q*p);\t//\u5c06x\u63d0\u5347\u5230\u6700\u5927 \n\t\t\t\tprintf(\"%lld \",y);\t\t\t//\u7279\u89e3\u5373\u4e3ay\u6700\u5927\u503c \n\t\t\t} else{\t\t//\u65e0\u6574\u6570\u89e3 \n\t\t\t\tprintf(\"%lld \" ,x);\t\t\t//\u5f53\u524d\u7684x\u5373\u4e3a\u6700\u5c0f\u7684\u6b63\u6574\u6570x \n\t\t\t\tprintf(\"%lld\",y+q*(LL)ceil((1.0-y)/q)); //\u5c06y\u63d0\u9ad8\u5230\u6b63\u6574\u6570 \n\t\t\t}\n\t\t\tputs(\"\");\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n---\n\n$\\rm upd 2020.3.21:$ \u53d1\u73b0\u597d\u50cf$\\rm exgcd$\u5e76\u4e0d\u9700\u8981\u6ee1\u8db3$a>b$\u2026\u2026\u5df2\u66f4\u6539\u3002",
        "postTime": 1574562905,
        "uid": 68344,
        "name": "\u79bb\u6563\u5c0f\u6ce2\u53d8\u6362\u00b0",
        "ccfLevel": 9,
        "title": "\u3010\u9898\u89e3\u3011\u3010P5656-\u3010\u6a21\u677f\u3011\u4e8c\u5143\u4e00\u6b21\u4e0d\u5b9a\u65b9\u7a0b(exgcd)\u3011"
    },
    {
        "content": "### **2020/1/25 UPD:\u66f4\u6b63\u4e86\u8bc1\u660e\u8fc7\u7a0b\u4e2d\u7b26\u53f7\u7684\u95ee\u9898\u3002\uff08By [weapon_zipper](https://www.luogu.com.cn/user/88207)\uff09**\n### **2019/12/11 UPD:\u66f4\u6b63\u4e86\u5728\u9898\u89e3\u9875\u9762Latex\u4ee3\u7801\u6f0f\u51fa\u7684\u95ee\u9898\u3002**\n\n------------\n## \u8be5\u9898\u89e3\u4e3b\u8981\u7531\u4ee5\u4e0b\u5185\u5bb9\u7ec4\u6210\uff1a\n- **\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\uff08exgcd\uff09**\n- **\u6c42\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b/\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\u7279\u89e3**\n- **\u6c42\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b/\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\u901a\u89e3**\n- **\u66b4\u529b\u89e3\u51b3\u672c\u9898**\n- **\u5bf9\u66b4\u529b\u8fdb\u884c\u4f18\u5316**\n\n------------\n\n\n------------\n\n\n------------\n\n### **\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\uff08exgcd\uff09**\n\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\uff1a\u7528\u4e8e\u6c42\u89e3\u5f62\u5982ax+by=gcd(a,b)\u7684\u4e0d\u5b9a\u65b9\u7a0b\u7279\u89e3\u3002\n\n**\u6c42\u89e3\u65b9\u6cd5&\u8bc1\u660e\uff1a** \u5f53b=0\u65f6\uff0c\u53ef\u4ee5\u770b\u51fagcd(a,b)=a\uff0c\u800c\n\n$$\\left\\{\\begin{aligned}x & = 1\\\\y & = 0\\\\\\end{aligned}\\right.$$\n\n\u662f\u65b9\u7a0b\u7684\u4e00\u7ec4\u7279\u89e3\u3002\n\n\u5f53b$\\neq$0\u65f6\uff0c\u9012\u5f52\u6c42\u89e3exgcd(b,a%b,x,y)\uff0c\u8bbe\n\n$$\\left\\{\\begin{aligned}a' & = b\\\\b' & = a\\%b\\\\\\end{aligned}\\right.$$\n\n\u53ef\u4ee5\u6c42\u5f97a'x'+b'y'=gcd(a,b)\u7684\u4e00\u7ec4\u7279\u89e3\uff0c\u5373x',y'\u3002\n\n\u56e0\u4e3aa'x'+b'y'\u7b49\u4ef7\u4e8ebx'+(a%b)y'\uff0c\u518d\u6839\u636e\u6a21\u8fd0\u7b97\u7684\u5b9a\u4e49\u53ef\u5f97bx'+(a-a/b*b)y'\n\nbx'+ay'-(a/b*b)y'\n\nay'+b(x'-a/b*y')\n\n\u6b64\u65f6\u5c31\u5f97\u5230\u4e86\n\n$$\\left\\{\\begin{aligned}x & = y'\\\\y & = x'-a/b*y'\\\\\\end{aligned}\\right.$$\n\n**\u4ee3\u7801\uff1a**\n```cpp\n\nvoid exgcd(int a,int b,int &x,int &y)\n{\n\tif(!b)\n\t{\n\t\tx=1;\n\t\ty=0;\n\t\treturn;\n\t}\n\tint p;\n\texgcd(b,a%b,x,y);\n\tp=x;\n\tx=y;\n\ty=p-(a/b)*y;\n\treturn;\n}\n```\n\n------------\n### **\u6c42\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b/\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\u7279\u89e3**\n**\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\uff1a**\n\u5bf9\u4e8e\u5f62\u5982ax+by=c\u7684\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\uff0c\u6839\u636e\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u7684\u5b9a\u4e49\u53ef\u5f97\uff0c\u5f53\u4e14\u4ec5\u5f53gcd(a,b)|c(|\u4e3a\u6574\u9664)\u65f6\uff0c\u5b58\u5728\u6574\u6570\u89e3\u3002\n\n\u8bbeg=gcd(a,b),a'=a/g,b'=b/g,c'=c/g,\u5219ax+by=c$\\Leftrightarrow$a'x+b'y=c'\uff0c\n\n\u6b64\u65f6gcd(a',b')=1,\u53ef\u4ee5\u5229\u7528exgcd\u6c42\u51faa'x'+b'y'=1\u7684\u4e00\u7ec4\u7279\u89e3\uff0c\u7ee7\u800c\u5f97\u51fa\n\n$$\\left\\{\\begin{aligned}x_0 & = c'x'\\\\y_0 & = c'y'\\\\\\end{aligned}\\right.$$\n\n\u6211\u4eec\u4fbf\u6c42\u5f97\u4e86ax+by=c\u7684\u4e00\u7ec4\u7279\u89e3\u3002\n\n**\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\uff1a**\n\u5bf9\u4e8e\u5f62\u5982ax$\\equiv$c(mod b)\u7684\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\uff0c\u6839\u636e\u6a21\u8fd0\u7b97\u7684\u5b9a\u4e49\uff0c\u5728\u65b9\u7a0b\u5de6\u4fa7\u6dfb\u52a0\u4e00\u4e2aby\u4e0d\u4f1a\u5bf9\u7ed3\u679c\u9020\u6210\u5f71\u54cd\uff0c\u5176\u5b9e\u8d28\u5c31\u7b49\u4ef7\u4e8eax+by=c\u7684\u4e0d\u5b9a\u65b9\u7a0b\uff0c\u5229\u7528\u4e0a\u8ff0\u65b9\u6cd5\u6c42\u89e3\u4fbf\u53ef\u3002\n\n------------\n### **\u6c42\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b/\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\u901a\u89e3**\n**\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\uff1a**\n\u5bf9\u4e8e\u5f62\u5982ax+by=c\u7684\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\uff0c\u6574\u6570\u89e3\u901a\u89e3\u4e3a\n\n$$\\left\\{\\begin{aligned}x_t & = x_0+b't\\\\y_t & = y_0-a't\\\\\\end{aligned}\\right.$$\n(t$\\in\\mathbb{Z}$)\n\n\u5bf9\u5176\u8fdb\u884c\u8bc1\u660e\uff1aa$x_{t}$+b$y_{t}$\n\na($x_{0}$+b't)+b($y_{0}$-a't)\n\na$x_{0}$+ab't+b$y_{0}$+a'bt\n\na$x_{0}$+b$y_{0}$+at$*$\n$\\displaystyle\\frac{b}{g}$-bt$*$\n$\\displaystyle\\frac{a}{g}$\n\na$x_{0}$+b$y_{0}$+$\\displaystyle\\frac{abt}{g}$-$\\displaystyle\\frac{abt}{g}$\n\na$x_{0}$+b$y_{0}$\n\n\u56e0\u4e3alcm(a,b)=$\\displaystyle\\frac{ab}{g}$\uff0cx,y\u7684\u7cfb\u6570\u5206\u522b\u4e3aa,b\uff0c\u6240\u4ee5x,y\u7684\u6700\u5c0f\u589e\u51cf\u5e45\u5ea6\u5206\u522b\u4e3a$\\displaystyle\\frac{b}{g}$\uff0c$\\displaystyle\\frac{a}{g}$\u5373b',a'\u3002\n\n**\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\uff1a**\n\u540c\u7406\u4e8e\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\u3002\n\n------------\n### **\u66b4\u529b\u89e3\u51b3\u672c\u9898**\n\u89c2\u5bdf\u672c\u9898\uff0c\u53d1\u73b0\u5bf9\u4e8e\u7ed9\u51fa\u7684\u6761\u4ef6\u6709\u4e09\u79cd\u60c5\u51b5\uff1a\u65e0\u6574\u6570\u89e3\u3001\u65e0\u6b63\u6574\u6570\u89e3\u4f46\u6709\u6574\u6570\u89e3\u3001\u6709\u6b63\u6574\u6570\u89e3\u3002\n\n**\u65e0\u6574\u6570\u89e3\uff1a**\n\u8981\u6c42\u8f93\u51fa-1\u3002\u6839\u636e\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u7684\u5b9a\u4e49\u53ef\u5f97\uff0c\u5f53c%gcd(a,b)$\\ne$0\u65f6\u65b9\u7a0b\u65e0\u6574\u6570\u89e3\uff0c\u8f93\u51fa-1\u5373\u53ef\u3002\n\n**\u5224\u65ad\u6709\u65e0\u6b63\u6574\u6570\u89e3\uff1a**\n\u6839\u636e\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\u7684\u901a\u89e3\u53ef\u5f97\uff0cx,y\u7684\u589e\u51cf\u6027\u76f8\u53cd\uff0c\u6240\u4ee5\u82e5\u5b58\u5728\u6b63\u6574\u6570\u89e3\uff0c\u5219\u5f53x\u53d6\u5f97\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u65f6\uff0cy\u53d6\u5f97\u6700\u5927\u6b63\u6574\u6570\u89e3\uff0c\u82e5\u6b64\u65f6y$\\le$0,\u5219\u8bf4\u660e\u8be5\u65b9\u7a0b\u65e0\u6b63\u6574\u6570\u89e3\u3002\n\n**\u65e0\u6b63\u6574\u6570\u89e3\u4f46\u6709\u6574\u6570\u89e3\uff1a**\n\u8981\u6c42\u8f93\u51fax,y\u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u3002\u901a\u8fc7\u6574\u9664\u8fd0\u7b97\u8ba1\u7b97\u51fax\u53d6\u5f97\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u65f6\u7684k\u503c\uff0c\u7ee7\u800c\u6c42\u51fax\u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3\uff0c\u540c\u7406\u53ef\u4ee5\u6c42\u51fay\u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u3002\n\n**\u6709\u6574\u6570\u89e3\uff1a**\n\u6b64\u65f6\u8981\u6c42\u6700\u590d\u6742\uff0c\u8981\u6c42\u8f93\u51fa\u6b63\u6574\u6570\u89e3\u7684\u6570\u91cf\u3001x,y\u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u3001x,y\u7684\u6700\u5927\u6b63\u6574\u6570\u89e3\u3002\u56e0\u4e3a\u5f53x\u53d6\u5f97\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u65f6\uff0cy\u53d6\u5f97\u6700\u5927\u6b63\u6574\u6570\u89e3\uff0c\u53ef\u4ee5\u5229\u7528\u4e0a\u8ff0\u65b9\u6cd5\u6c42\u51fax\u53d6\u5f97\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u65f6\u7684k\u503c\uff0cx\u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u4e0ey\u7684\u6700\u5927\u6b63\u6574\u6570\u89e3\uff0c\u8be5\u65b9\u6cd5\u540c\u6837\u53ef\u4ee5\u7528\u4e8e\u6c42\u89e3x\u7684\u6700\u5927\u6b63\u6574\u6570\u89e3\u4e0ey\u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u3002\u6b63\u6574\u6570\u89e3\u7684\u6570\u91cf=$\\displaystyle\\frac{x_{max}-x_{min}}{b'}$+1\u6216$\\displaystyle\\frac{y_{max}-y_{min}}{a'}$+1\u3002\n\n**\u4ee3\u7801:**\n```cpp\n#include<cstdio>\nusing namespace std;\nint read()\n{\n\tint res=0;\n\tchar c;\n\tc=getchar();\n\twhile(c<'0'||c>'9')\n\tc=getchar();\n\twhile(c>='0'&&c<='9')\n\t{\n\t\tres=res*10+c-48;\n\t\tc=getchar();\n\t}\n\treturn res;\n}//\u56e0\u4e3a\u9898\u76ee\u63cf\u8ff0\u201c\u8bfb\u5165\u8f93\u51fa\u91cf\u8f83\u5927\uff0c\u6ce8\u610f\u4f7f\u7528\u8f83\u5feb\u7684\u8bfb\u5165\u8f93\u51fa\u65b9\u5f0f\u201d\uff0c\u6240\u4ee5\u4f7f\u7528\u5feb\u8bfb\uff0c\u5b9e\u9645\u4e0a\u4e0d\u7528\u4e5f\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002 \nlong long gcd(long long n,long long m)\n{\n\treturn (n%m==0)?m:gcd(m,n%m);\n}//gcd\uff0c\u4e0d\u505a\u8bf4\u660e\u3002 \nvoid exgcd(long long a,long long b,long long &x,long long &y)\n{\n\tif(!b)\n\t{\n\t\tx=1;\n\t\ty=0;\n\t\treturn;\n\t}\n\tlong long p;\n\texgcd(b,a%b,x,y);\n\tp=x;\n\tx=y;\n\ty=p-(a/b)*y;\n\treturn;\n}//exgcd\uff0c\u672c\u9898\u6838\u5fc3\u4ee3\u7801\uff0c\u5728\u4e0a\u8ff0\u5185\u5bb9\u4e2d\u5df2\u505a\u8bf4\u660e \u3002 \nint t;\nint main()\n{\n\tt=read();\n\twhile(t--)\n\t{\n\t\tlong long x=0,y=0,a,b,c,g,xin,yin,xax,yax,npa=0,k;//t,x,y,a,b,c,g\u540c\u5148\u524d\u63cf\u8ff0\uff0cxin,yin\u4e3ax,y\u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3,xax,yax\u4e3ax,y\u7684\u6700\u5927\u6b63\u6574\u6570\u89e3\uff0cnpa\u4e3a\u6b63\u6574\u6570\u89e3\u6570\u3002 \n\t\ta=read();\n\t\tb=read();\n\t\tc=read();//\u8bfb\u5165\u90e8\u5206\u3002 \n\t\tg=gcd(a,b);\n\t\tif(c%g!=0)\n\t\tprintf(\"-1\\n\");//\u5224\u65ad\u6709\u65e0\u6574\u6570\u89e3\u3002 \n\t\telse\n\t\t{\n\t\t\ta/=g;\n\t\t\tb/=g;\n\t\t\tc/=g;\n\t\t\texgcd(a,b,x,y);\n\t\t\tx*=c;\n\t\t\ty*=c;//\u6c42\u51fa\u4e00\u7ec4\u7279\u89e3\u3002 \n\t\t\tfor(int i=1;i<=2;i++)//\u56e0\u4e3a\u5728\u6c42\u89e3y\u53d6\u5f97\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u65f6\u7684k\u503c\u53ef\u80fd\u4f7fx\u7684\u503c\u5c0f\u4e8e\u7b49\u4e8e0\uff0c\u6240\u4ee5\u8981\u518d\u6c42\u89e3\u4e00\u904d\u4ee5\u6c42\u51fax\u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u4e0ey\u7684\u6700\u5927\u6b63\u6574\u6570\u89e3\u3002 \n\t\t\tif(x<=0)\n\t\t\t{\n\t\t\t\tk=-(x/b)+1;\n\t\t\t\tx+=k*b;\n\t\t\t\ty-=k*a;\n\t\t\t\txin=x;\n\t\t\t\tyax=y;\n\t\t\t}//\u6c42\u51fax\u53d6\u5f97\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u65f6\u7684k\u503c\uff0cx\u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u4e0ey\u7684\u6700\u5927\u6b63\u6574\u6570\u89e3\u3002 \n\t\t\telse if(y<=0)\n\t\t\t{\n\t\t\t\tk=-(y/a)+1;\n\t\t\t\tx-=k*b;\n\t\t\t\ty+=k*a;\n\t\t\t\tyin=y;\n\t\t\t\txax=x;\n\t\t\t}//\u6c42\u51fay\u53d6\u5f97\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u65f6\u7684k\u503c\uff0cx\u7684\u6700\u5927\u6b63\u6574\u6570\u89e3\u4e0ey\u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u3002 \n\t\t\tif(x>0&&y>0)//\u5224\u65ad\u65b9\u7a0b\u6709\u65e0\u6b63\u6574\u6570\u89e3\u3002 \n\t\t\t{\n\t\t\t\tif(x%b!=0)\n\t\t\t\t{\n\t\t\t\t\txin=x%b;\n\t\t\t\t\tyax=y+a*(x/b);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\txin=x%b+b;\n\t\t\t\t\tyax=y+a*(x/b-1);\n\t\t\t\t}\n\t\t\t\tif(y%a!=0)\n\t\t\t\t{\n\t\t\t\t\tyin=y%a;\n\t\t\t\t\txax=x+b*(y/a);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tyin=y%a+a;\n\t\t\t\t\txax=x+b*(y/a-1);\n\t\t\t\t}//\u7528\u4e8e\u6c42\u89e3x,y\u5747\u5927\u4e8e\u7b49\u4e8e0\u65f6x,y\u7684\u6700\u5c0f\u6700\u5927\u6b63\u6574\u6570\u89e3\u3002 \n\t\t\t\tnpa=(xax-xin)/b+1;//\u6c42\u51fa\u6b63\u6574\u6570\u89e3\u7684\u6570\u91cf\u3002 \n\t\t\t}\n\t\t\tif(!npa)\n\t\t\tprintf(\"%lld %lld\\n\",xin,yin);\n\t\t\telse printf(\"%lld %lld %lld %lld %lld\\n\",npa,xin,yin,xax,yax);//\u8f93\u51fa\u90e8\u5206\u3002 \n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n------------\n\n### **\u5bf9\u66b4\u529b\u8fdb\u884c\u4f18\u5316**\n\u7531\u4e8e\u4ee5\u4e0a\u4ee3\u7801\u4e0d\u4f18\u5316\u663e\u5f97\u53c8\u957f\u53c8\u6162\u5e38\u6570\u5de8\u5927~~\u800c\u4e14\u663e\u5f97\u4e11~~\uff0c\u6240\u4ee5\u5c1d\u8bd5\u5bf9\u66b4\u529b\u8fdb\u884c\u4f18\u5316\u3002\n\n\u8fd0\u7528\u5927\u773c\u89c2\u5bdf\u6cd5\uff0c\u53ef\u4ee5\u53d1\u73b0\u6211\u4eec\u80fd\u7528\u6a21\u8fd0\u7b97\u76f4\u63a5\u6c42\u51fax,y\u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u800c\u4e0d\u7528\u6c42k\u503c\uff0c\u5bf9\u4e8ex,y\u7684\u6700\u5927\u6b63\u6574\u6570\u89e3\u5219\u53ef\u4ee5\u76f4\u63a5\u4ee3\u5165\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\u6c42\u89e3\uff0c\u5373\n\n$$\\left\\{\\begin{aligned}x_{max}=\\displaystyle\\frac{c-x_{min}}{a}\\\\y_{max}=\\displaystyle\\frac{c-y_{min}}{b}\\\\\\end{aligned}\\right.$$\n\n**\u4ee3\u7801\uff1a**\n```cpp\n#include<cstdio>\nusing namespace std;\nint read()\n{\n\tint res=0;\n\tchar c;\n\tc=getchar();\n\twhile(c<'0'||c>'9')\n\tc=getchar();\n\twhile(c>='0'&&c<='9')\n\t{\n\t\tres=res*10+c-48;\n\t\tc=getchar();\n\t}\n\treturn res;\n}\nlong long gcd(long long n,long long m)\n{\n\treturn (n%m==0)?m:gcd(m,n%m);\n}\nvoid exgcd(long long a,long long b,long long &x,long long &y)\n{\n\tif(!b)\n\t{\n\t\tx=1;\n\t\ty=0;\n\t\treturn;\n\t}\n\tlong long p;\n\texgcd(b,a%b,x,y);\n\tp=x;\n\tx=y;\n\ty=p-(a/b)*y;\n\treturn;\n}\nint t;\nint main()\n{\n\tt=read();\n\twhile(t--)\n\t{\n\t\tlong long x=0,y=0,a,b,c,g,xin,yin,xax,yax,npa=0,k;\n\t\ta=read();\n\t\tb=read();\n\t\tc=read();\n\t\tg=gcd(a,b);\n\t\tif(c%g!=0)\n\t\tprintf(\"-1\\n\");\n\t\telse\n\t\t{\n\t\t\ta/=g;\n\t\t\tb/=g;\n\t\t\tc/=g;\n\t\t\texgcd(a,b,x,y);\n\t\t\tx*=c;\n\t\t\ty*=c;\n\t\t\txin=x>0&&x%b!=0?x%b:x%b+b;//\u82e5x>0\u4e14x%b!=0\uff0cx\u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u5c31\u7b49\u4e8ex%b\uff0c\u5426\u5219\u5219\u9700\u8981\u5728x%b\u7684\u57fa\u7840\u4e0a\u52a0b\u3002 \n\t\t\tyax=(c-xin*a)/b;//\u6c42\u51fa\u5bf9\u5e94\u7684y\u7684\u6700\u5927\u6b63\u6574\u6570\u89e3\u3002 \n\t\t\tyin=y>0&&y%a!=0?y%a:y%a+a;\n\t\t\txax=(c-yin*b)/a;//\u540c\u7406\u4e8ex\u3002 \n\t\t\tif(xax>0)//\u5224\u65ad\u6709\u65e0\u6b63\u6574\u6570\u89e3\u3002 \n\t\t\tnpa=(xax-xin)/b+1;//\u6c42\u51fa\u6b63\u6574\u6570\u89e3\u7684\u6570\u91cf\u3002 \n\t\t\tif(!npa)\n\t\t\tprintf(\"%lld %lld\\n\",xin,yin);\n\t\t\telse printf(\"%lld %lld %lld %lld %lld\\n\",npa,xin,yin,xax,yax);\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\u518d\u5f00\u4e2aO2\uff0c\u4ea4\u4e00\u53d1\u4e0a\u53bb\uff0c\u53d1\u73b0\u8dd1\u5f97\u8fd8\u633a\u5feb\uff0c\u80fd\u62ff[rank6](https://cdn.luogu.com.cn/upload/pic/1024.png)(\u4e3b\u8981\u662f\u56e0\u4e3a\u4eba\u5c11)\u3002\n![](https://cdn.luogu.com.cn/upload/image_hosting/44m0pjiv.png?x-oss-process=image/resize,m_lfit,h_1000,w_2500)\n\u6700\u540e\u4e00\u70b9\uff1a**\u8bb0\u5f00long long**\u3002\n\n~~\u4e3a\u4ec0\u4e48\u6211\u4f1a\u8fd9\u4e48\u4e0d\u719f......~~\n\n",
        "postTime": 1575977637,
        "uid": 22649,
        "name": "linponess",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5656 \u3010\u3010\u6a21\u677f\u3011\u4e8c\u5143\u4e00\u6b21\u4e0d\u5b9a\u65b9\u7a0b(exgcd)\u3011"
    },
    {
        "content": "$Exgcd$\u7684\u6a21\u677f\u60f3\u5fc5\u5927\u5bb6\u90fd\u5f88\u719f\u6089\u4e86\uff0c~~\u4e0d\u7136\u600e\u4e48\u4f1a\u6765\u505a\u8fd9\u9053\u9898~~\n\n\u90a3\u4e48\u6211\u5c31\u6765\u559c\u95fb\u4e50\u89c1\u7684\u8bb2\u4e00\u8bb2\u5982\u4f55\u5904\u7406\u7ec6\u8282\u5427qwq\n\n* \u5feb\u8bfb\u548c\u5feb\u5199\u3002\u6839\u636e\u51fa\u9898\u4eba\u7684**\u6e29 \u99a8 \u63d0 \u793a**\uff1a\u201c\u8bfb\u5165\u8f93\u51fa\u91cf\u8f83\u5927\uff0c\u6ce8\u610f\u4f7f\u7528\u8f83\u5feb\u7684\u8bfb\u5165\u8f93\u51fa\u65b9\u5f0f\u201d\uff0c\u6240\u4ee5\u5feb\u8bfb\u548c\u5feb\u5199\u662f\u5fc5\u8981\u7684\u3002\u5feb\u8bfb\u5feb\u5199\u7684\u539f\u7406\u5176\u5b9e\u5c31\u662f\u727a\u7272\u4e86C++\u6807\u51c6\u8f93\u5165\u8f93\u51fa\u7684\u666e\u9002\u6027\u6765\u6362\u53d6\u65f6\u95f4\u3002\n\n* \u65e0\u89e3\u7684\u60c5\u51b5\u53ea\u6709\u4e00\u79cd\u60c5\u51b5\uff0c\u90a3\u5c31\u662f\u4e0d\u5b9a\u65b9\u7a0b$ax+by=c$\u4e2d\uff0c$c\\nmid\\gcd(a,b)$\u65f6\u624d\u65e0\u89e3\uff0c\u53ea\u8981\u7b97\u51fa\u6765\u4e24\u4e2a\u6570\u7684\u6700\u5927\u516c\u7ea6\u6570\u5c31OK\u4e86\u3002\u7136\u540e\u6211\u4eec\u77e5\u9053\u6709\u4e2a\u51fd\u6570\u53eb\u505a__gcd\uff08\u6ed1\u7a3d\u6ed1\u7a3d\n\n* \u6b63\u6574\u6570\u6307\u7684\u662f\u5927\u4e8e0\u7684\u6574\u6570\u3002\u5c3d\u7ba1\u8fd9\u5f88\u7b80\u5355\uff0c\uff0c\uff0c\u4f46\u662f\uff0c\uff0c\uff0c\u5728\u5224\u65ad\u4e0d\u5b9a\u65b9\u7a0b\u7684\u6700\u5927/\u5c0f\u6b63\u6574\u6570\u89e3\u7684\u65f6\u5019\u8981\u52a0\u7279\u5224\n\n* \u5904\u7406\u8d1f\u6570\u7684\u6a21\u6570\uff0c\u7528$x\\% Mod+Mod$\uff08\u8c03\u8bd5\u7684\u65f6\u5019\u4e00\u76f4\u9519\uff0c\u540e\u6765\u624d\u53d1\u73b0\u8fd9\u6837\u624d\u80fd\u5bf9\uff08\u6342\u8138\n\n* \u989d\uff0c\uff0c\uff0c\u5269\u4e0b\u7684\u5c31\u662f\u5c0f\u5b66\u6570\u5b66\u4e86\uff0c\uff0c\uff0c\uff08\u8fd9\u8bf4\u660e\u5c0f\u5b66\u6570\u5b66\u633a\u91cd\u8981\u7684\uff0c\uff0c\uff0c\uff0c\uff0c\uff0c\n\nCode\uff08\u55ef\uff0c\uff0c\uff0c\u6ca1\u6709\u8fc7\u5ea6\u538b\u884c\uff0c\uff0c\uff0c\n\n```cpp\n\n#include<bits/stdc++.h> \nusing namespace std;\ninline long long read()\n{\n    long long s=0,f=1;        \n    char ch=getchar();        \n    while(!isdigit(ch)) {if(ch=='-') f=-1;ch=getchar();}        \n    while(isdigit(ch)) {s=s*10+ch-'0'; ch=getchar(); }        \n    return s*f;        \n}//\u5feb\u8bfb\ninline void write(long long x)        \n{        \n    if(x<0) {putchar('-');x=-x;}\n\tif(x>9) write(x/10);        \n    putchar(x%10+'0');        \n    return;        \n}//\u5feb\u5199 \ninline void exgcd(long long a,long long b,long long &x,long long &y)\n{\n\tif(b==0) x=1,y=0; \n\telse  \n\t{\n\t\texgcd(b,a%b,x,y);\n\t\tlong long d=x;\n\t\tx=y,y=d-a/b*y;\n\t}\n}//Exgcd\u677f\u5b50       \nint main()\n{\n\tint T=0;\n\tT=read();\n\tfor(register int i=0;i<T;i++)\n\t{\n\t\tlong long a=read(),b=read(),c=read(),x,y,g=__gcd(a,b);\n\t\tif(c%g!=0) { printf(\"-1\\n\");continue;}//\u65e0\u89e3\n\t\ta/=g,b/=g,c/=g; exgcd(a,b,x,y); x*=c,y*=c;\n\t\tif(x<=0)\n\t\t{\n\t\t\tlong long t;\n\t\t\tt=abs(x)/b; t++; x=x%b+b; y-=t*a;\n\t\t\tif(y<=0) {write(x),printf(\" \"),write(y%a+a),printf(\"\\n\");continue;}\n\t\t}//\u6c42\u51fa\u6765\u7684\u7279\u89e3\u662fx<=0\u65f6\n\t\tif(y<=0)\n\t\t{\n\t\t\tlong long t;\n\t\t\tt=abs(y)/a; t++; y=y%a+a; x-=t*b;\n\t\t\tif(x<=0) {write(x%b+b),printf(\" \"),write(y),printf(\"\\n\");continue;}\n\t\t}//\u6c42\u51fa\u6765\u7684\u7279\u89e3\u662fy<=0\u65f6\n\t\tlong long maxx,minx,maxy,miny;\n\t\tlong long p,q;\n\t\tp=x/b; x%=b; if(!x) x+=b,p--; y+=p*a; minx=x,maxy=y;//\u8ba1\u7b97x\u7684\u6700\u5c0f\u503c\uff0cy\u7684\u6700\u5927\u503c\n\t\tq=y/a; y%=a; if(!y) y+=a,q--; x+=q*b; miny=y,maxx=x;//\u8ba1\u7b97x\u7684\u6700\u5927\u503c\uff0cy\u7684\u6700\u5c0f\u503c\n\t\twrite((maxx-minx)/b+1),printf(\" \"),write(minx),printf(\" \"),write(miny),printf(\" \"),write(maxx),printf(\" \"),write(maxy),printf(\"\\n\");\n\t}//\u89e3\u7684\u6570\u91cf\u5c31\u662fx\u6216y\u7684\u6700\u5927\u6700\u5c0f\u503c\u4e4b\u5dee\u76f8\u51cf\u7136\u540e\u9664\u6389\u4e00\u4e2ab\u6216\u8005a\uff08\u8fd9\u4e2a\u5c31\u662f\u4e0d\u5b9a\u65b9\u7a0b\u7684\u901a\u89e3\u7684\u6027\u8d28\n\treturn 0;\n}\n```\n\n~~\u5feb\u8bfb\u5feb\u5199\u4e00\u5f04\uff0c\u53d1\u73b0\u7801\u91cf\u5c31\u4e00\u4e0b\u5b50\u4e0a\u53bb\u4e86~~\n\n\u8fd9\u6837\u5b50\u5c31OK\u4e86\u55b5\u0b90\u0669(\u0e51\u00b4\u1d55`)\u06f6\u0b90",
        "postTime": 1596081175,
        "uid": 231169,
        "name": "Laser_Crystal",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5656 \u3010\u3010\u6a21\u677f\u3011\u4e8c\u5143\u4e00\u6b21\u4e0d\u5b9a\u65b9\u7a0b(exgcd)\u3011"
    },
    {
        "content": "UPD:2020/5/4 \u66f4\u6b63\u4e86\u4e00\u4e9b$\\LaTeX$\n\n~~\u6570\u5b66\u6a21\u677f\u9898\u8fd9\u4e48\u70b9\u9898\u89e3\uff1f\u90a3\u6211\u5c31\u6765\u53d1\u4e00\u7bc7\u5427\u3002~~\n\n\u5f53$\\gcd(a,b)\\nmid c$\u65f6\uff0c\u663e\u7136\u7b49\u5f0f\u4e0d\u53ef\u80fd\u6210\u7acb\uff0c\u8f93\u51fa-1\u3002\n\n\u5426\u5219\uff0c\u53ef\u4ee5\u5c06$a,b,c$\u90fd\u9664\u4ee5$\\gcd(a,b)$\uff0c\u53ea\u8981\u8fd9\u4e2a\u7b49\u5f0f\u6210\u7acb\uff0c\u539f\u7b49\u5f0f\u4e00\u5b9a\u6210\u7acb\uff0c\u8fd9\u6837\u4e5f\u5c31\u4f7f\u5f97$\\gcd(a,b)=1$\u4e86\u3002\n\n\u7136\u540e\u7528$\\operatorname{exgcd}$\u6c42\u51fa\u4f7f\u5f97$a\\times x+b\\times y=1$\u6210\u7acb\u7684$x$\u548c$y$\uff0c\u518d\u5c06$x$\u548c$y$\u90fd\u4e58$c$\uff0c\u8fd9\u6837\u5c31\u6ee1\u8db3$a\\times x+b\\times y=c$\u4e86\u3002$\\operatorname{exgcd}$\u600e\u4e48\u7528\u770b[\u8fd9\u91cc](https://www.luogu.com.cn/blog/fufufu/exgcd-di-yong-fa)\u3002\n\n\u7136\u540e\u8003\u8651\u662f\u5426\u6709\u6b63\u6574\u6570\u89e3\u3002\u663e\u7136\u5f53$x$\u8d8a\u5c0f\u65f6$y$\u8d8a\u5927\uff0c\u90a3\u5c31\u8ba9$x$\u53d6\u6700\u5c0f\u6b63\u6574\u6570\uff0c\u5982\u679c\u8fd9\u65f6$y>0$\uff0c\u5219\u6709\u6b63\u6574\u6570\u89e3\uff0c\u5426\u5219\u6ca1\u6709\u3002\n\n\u90a3$x$\u5982\u4f55\u53d6\u6700\u5c0f\u6b63\u6574\u6570\u5462\uff1f\u6211\u4eec\u5df2\u77e5\u4e00\u7ec4\u6574\u6570\u89e3\u4e86\uff0c\u8bbe\u4e3a$x_1$\u548c$y_1$\uff0c$a\\times x_1+b\\times y_1=c$\uff0c\u518d\u8bbex\u53d6\u6700\u5c0f\u6b63\u6574\u6570\u65f6$x$\u548c$y$\u4e3a$x_2$\u548c$y_2$\u3002\u5373$a\\times x_2+b\\times y_2=c$\u3002\n\n\u5219$(x_1-x_2)\\times a+(y_1-y_2)\\times b=0$\uff0c\u56e0\u4e3a$\\gcd(a,b)=1$\uff0c\u6240\u4ee5$x_1-x_2=k\\times b$\uff0c$y_1-y_2=-k\\times b$\uff0c\u5176\u4e2d$k\\in Z$\u3002\u6240\u4ee5$x_2=x_1 \\bmod b$\uff0c\u7279\u522b\u7684\uff0c\u5f53$x_1 \\bmod b=0$\u65f6\uff0c$x_2=b$\u3002\u7136\u540e\u7b97\u51fa\u6765$y_2=\\dfrac{c-a\\times x_2}{b}$\u3002\u7136\u540e\u5206\u60c5\u51b5\u8ba8\u8bba\uff1a\n\n+ \u5f53$y_2>0$\u65f6\uff0c\u518d\u540c\u7406\u6c42\u4e00\u4e0b$y$\u4e3a\u6700\u5c0f\u6b63\u6574\u6570\u4e0b$x$\u548c$y$\u7684\u503c\u3002\u8fd9\u5c31\u6709\u56db\u4e2a\u7b54\u6848\u4e86\u3002\u8fd8\u8981\u6c42\u6709\u591a\u5c11\u7ec4\u6b63\u6574\u6570\u89e3\uff0c\u56e0\u4e3a$x$\u6700\u5927\u503c\u4e0e\u6700\u5c0f\u503c\u4e4b\u95f4\u6bcf\u9694$b$\u4e2a\u6570\u5c31\u6709\u4e00\u4e2a\u89e3\uff0c\u6240\u4ee5\u4e2a\u6570\u4e3a$\\dfrac{x_{max}-x_{min}}{b}+1$\uff0c\u5f53\u7136\u540c\u7406$\\dfrac{y_{max}-y_{min}}{a}+1$\u4e5f\u662f\u53ef\u4ee5\u7684\u3002\n\n+ \u5f53$y_2\\le0$\u65f6\uff0c\u6c42\u4e00\u4e0b$y$\u7684\u6700\u5c0f\u6b63\u6574\u6570\u503c\u5c31\u884c\u4e86\u3002\n\n\u6700\u540e\u518d\u63d0\u4e00\u53e5\uff1a\u5341\u5e74OI\u4e00\u573a\u7a7a\uff0c\u4e0d\u5f00long long\u89c1\u7956\u5b97\uff01\n\nOK\uff0c\u90a3\u5c31\u4e0a\u4ee3\u7801\u5427\uff1a\n```cpp\n#include<stdio.h>\nusing namespace std;\nvoid read(int &x)\n{\n\tx=0;\n\tint bei=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9')\n\t{\n\t\tif(ch=='-')\n\t\t\tbei=-1;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0'&&ch<='9')\n\t{\n\t\tx=x*10+ch-'0';\n\t\tch=getchar();\n\t}\n\tx*=bei;\n}\nint gcd(int a,int b)\n{\n\treturn b==0?a:gcd(b,a%b);\n}\nvoid exgcd(int a,int b,long long &x,long long &y)\n{\n\tif(b==0)\n\t{\n\t\tx=1,y=0;\n\t\treturn;\n\t}\n\texgcd(b,a%b,x,y);\n\tlong long t=x;\n\tx=y;\n\ty=t-a/b*y;\n}\nint main()\n{\n\tint t;\n\tread(t);\n\tint a,b,c,gong;\n\tlong long x,y;\n\twhile(t--)\n\t{\n\t\tread(a),read(b),read(c);\n\t\tgong=gcd(a,b);\n\t\tif(c%gong)\n\t\t{\n\t\t\tputs(\"-1\");\n\t\t\tcontinue;\n\t\t}\n\t\ta/=gong,b/=gong,c/=gong;\n\t\texgcd(a,b,x,y);\n\t\tx*=c;\n\t\ty*=c;\n\t\tx=(x%b+b)%b;\n\t\tx=x==0?b:x;\n\t\ty=(c-a*x)/b;\n\t\tif(y>0)\n\t\t{\n\t\t\tlong long xmin,xmax,ymin,ymax;\n\t\t\txmin=x,ymax=y;\n\t\t\ty%=a;\n\t\t\ty=y==0?a:y;\n\t\t\tx=(c-b*y)/a;\n\t\t\txmax=x,ymin=y;\n\t\t\tprintf(\"%lld %lld %lld %lld %lld\\n\",(xmax-xmin)/b+1,xmin,ymin,xmax,ymax);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlong long xmin,ymin;\n\t\t\txmin=x;\n\t\t\ty=y%a+a;\n\t\t\tymin=y;\n\t\t\tprintf(\"%lld %lld\\n\",xmin,ymin);\n\t\t}\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1588470381,
        "uid": 173840,
        "name": "\u5c0f\u6050",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5656 \u3010\u3010\u6a21\u677f\u3011\u4e8c\u5143\u4e00\u6b21\u4e0d\u5b9a\u65b9\u7a0b(exgcd)\u3011"
    },
    {
        "content": "\u505a\u6cd5\uff1a**exgcd+\u5206\u7c7b\u8ba8\u8bba**\u3002\n\n### exgcd\n\n\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\uff08exgcd\uff09\uff1a\u7528\u4e8e\u6c42\u89e3\u5f62\u5982 $ax+by=\\gcd(a,b)$ \u7684\u4e0d\u5b9a\u65b9\u7a0b\u7279\u89e3\u3002\n\nexgcd code:\n```cpp\nint x,y;\nvoid exgcd(int a,int b)\n{\n\tif(b==0)\n\t{\n\t\tx=1;\n\t\ty=0;\n\t\treturn;\n\t}\n\texgcd(b,a%b);\n\tint t=x;\n\tx=y;\n\ty=t-a/b*y;      \n}\n```\n\u6c42\u51fa\u7684x\uff0cy\u5c31\u662f\u89e3\u3002\n\n### \u5206\u7c7b\u8ba8\u8bba\n\n1.\u65e0\u89e3\n\n\u5f53c\u4e0d\u662f $\\gcd(a,b)$ \u7684\u500d\u6570\u65f6\uff0c\u663e\u7136\u65e0\u89e3\u3002\n\n2.\u65e0\u6b63\u6574\u6570\u89e3\n\n\u5f53 $x$ \u53d8\u5316\u4e3a\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u65f6\uff0c$y$ \u6700\u5927\uff0c\u82e5 $y$ \u4f9d\u7136\u5c0f\u4e8e0\uff0c\u5219\u6ca1\u6709\u6b63\u6574\u6570\u89e3\u3002\n\n\u5f53 $y$ \u53d8\u5316\u4e3a\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u65f6\uff0c$x$ \u6700\u5927\uff0c\u82e5 $x$ \u4f9d\u7136\u5c0f\u4e8e0\uff0c\u5219\u6ca1\u6709\u6b63\u6574\u6570\u89e3\u3002\n\n3.\u6709\u6b63\u6574\u6570\u89e3\n\n$x$ \u6700\u5c0f\u65f6 $y$ \u6700\u5927\uff0c\u53cd\u4e4b\u4ea6\u7136\u540c\u7406\u3002\n\n\u89e3\u7684\u4e2a\u6570\u662f\u6700\u5927 $x$ \u6700\u5c0f $x$ \u7684\u5dee\u9664\u4ee5\u6a21\u6570 $b$ \u518d\u52a0\u4e0a1\u3002\n\n**\u6ce8\u610f\uff1a\u8981\u5f00longlong**\uff0c\u6211\u8fd9\u91cc define int long long \u4e86\u3002\n\nAC\u4ee3\u7801\uff1a\n```cpp\n#include<iostream>\n#include<cstdio>\n#define int long long \nusing namespace std;\nint inline read()\n{\n\tint ans=0,f=1;\n\tchar ch=getchar();\n\twhile(!isdigit(ch))\n\t{\n\t\tif(ch=='-')\n\t\tf=-1;\n\t\tch=getchar();\n\t}\n\twhile(isdigit(ch))\n\t{\n\t\tans=ans*10+ch-'0';\n\t\tch=getchar();\n\t}\n\treturn ans*f;\n}\nvoid write(int i)\n{\n\tif(i<0)\n\t{\n\t\tputchar('-');\n\t\ti=-i;\n\t}\n\tif(i/10) write(i/10);\n\tputchar('0'+(i%10)); \n}\nint x,y;\nvoid exgcd(int a,int b)\n{\n\tif(b==0)\n\t{\n\t\tx=1;\n\t\ty=0;\n\t\treturn;\n\t}\n\texgcd(b,a%b);\n\tint t=x;\n\tx=y;\n\ty=t-a/b*y;      \n}\nint gcd(int a,int b)\n{\n\tif(b==0) return a;\n\treturn gcd(b,a%b);\n}\nsigned main()\n{\n\tint T=read();\n\twhile(T--)\n\t{\n\t\tint a=read(),b=read(),c=read(),d=gcd(a,b),t;\n\t\tif(c%d!=0)//\u65e0\u89e3\u3002\n\t\t{\n\t\t\twrite(-1);\n\t\t\tputchar('\\n');\n\t\t\tcontinue;\n\t\t}\n\t\ta/=d;b/=d;c/=d;\n\t\texgcd(a,b);\n\t\tx*=c;y*=c;\n\t\tif(x<=0)\n\t\t{\n\t\t\tint t=-x/b+1;\n\t\t\tx=x%b+b;\n\t\t\ty=y-t*a;\n\t\t\tif(y<=0)//\u65e0\u6b63\u6574\u6570\u89e3\n\t\t\t{\n\t\t\t\twrite(x);\n\t\t\t\tputchar(' ');\n\t\t\t\twrite((y%a)+a);\n\t\t\t\tputchar('\\n');\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tif(y<=0)\n\t\t{\n\t\t\tint t=-y/a+1;\n\t\t\ty=y%a+a;\n\t\t\tx=x-t*b;\n\t\t\tif(x<=0)//\u540c\u4e0a\n\t\t\t{\n\t\t\t\twrite((x%b)+b);\n\t\t\t\tputchar(' ');\n\t\t\t\twrite(y);\n\t\t\t\tputchar('\\n');\n\t\t\t\tcontinue;\n\t\t\t}\t\t\t\n\t\t}\n\t\tt=x/b;//\u6709\u6b63\u6574\u6570\u89e3\n\t\tx%=b;\n\t\tif(x==0)\n\t\t{\n\t\t\tx+=b;\n\t\t\tt--;\n\t\t}\n\t\ty+=t*a;\n\t\tint minx=x,maxy=y;//\u6700\u5c0fx\u6700\u5927y\n\t\tt=y/a;\n\t\ty%=a;\n\t\tif(y==0)\n\t\t{\n\t\t\ty+=a;\n\t\t\tt--;\n\t\t}\n\t\tx+=t*b;//\u73b0\u5728x\uff0cy\u662f\u6700\u5927x\u6700\u5c0fy\n\t\twrite((x-minx)/b+1);//\u89e3\u7684\u4e2a\u6570\uff0c\u6700\u5927\u51cf\u53bb\u6700\u5c0f\n\t\tputchar(' ');\n\t\twrite(minx);\n\t\tputchar(' ');\n\t\twrite(y);\n\t\tputchar(' ');\n\t\twrite(x);\n\t\tputchar(' ');\n\t\twrite(maxy);\n\t\tputchar('\\n');\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1583206743,
        "uid": 196899,
        "name": "lndjy",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5656 \u3010\u3010\u6a21\u677f\u3011\u4e8c\u5143\u4e00\u6b21\u4e0d\u5b9a\u65b9\u7a0b(exgcd)\u3011"
    },
    {
        "content": "**11.24:\u4fee\u6539\u4e86:**\n\n**\u4e24\u4e2a$\\pm$\u5e94\u8be5\u6539\u4e3a\u4e00\u4e2a$\\pm$\u53e6\u4e00\u4e2a$\\mp$,\u56e0\u4e3a\u5176\u7b26\u53f7\u662f\u76f8\u53cd\u7684**\n\n**\u611f\u8c22** @ [A_M](https://www.luogu.org/user/260738)\n\n## \u5982\u4f55\u6c42\u51fa\u4e00\u7ec4\u89e3\n\n\u4e00\u4e0b\u7ed9\u51fa\u601d\u8def\uff1a\n\n\u539f\u65b9\u7a0b$ax+by=c$\n\n\u6211\u4eec\u5bf9\u5b83\u6574\u4f53\u5bf9$b$\u53d6\u6a21\n\n$ax\\,\\equiv\\, c ( mod\\,b)$\n\n\u8fd9\u6837\u5c31\u53d8\u6210\u719f\u6089\u7684\u4e00\u9053\u9898\n\n[ \u540c\u4f59\u65b9\u7a0b](https://www.luogu.org/problem/P1082)\n\n\u53ea\u9700\u89e3$ax\\,\\equiv1(mod\\,b)$\n\n\u518d$x*=c$\u5373\u53ef\n\n----\n\n## \u5173\u4e8e\u65e0\u89e3\n- \u5f53 $a$ \u662f $b$ \u7684\u500d\u6570\u65f6\uff0c$ax \\mod b = 0$\u3002\n\n\t- \u5982\u679c $c$ \u4e5f\u662f $b$ \u7684\u500d\u6570\uff0c\u5219 $c \\mod b = 0$\uff0c\u6240\u4ee5 $ax \\equiv c \\pmod b$\u6052\u6210\u7acb\uff08\u6709\u65e0\u6570\u89e3\uff09\u3002\n\n\t- \u5982\u679c $c$ \u4e0d\u662f $b$ \u7684\u500d\u6570\uff0c\u5219 $c\\mod b \u2260 0$\uff0c\u6545\u4e0a\u9762\u8fd9\u4e2a\u65b9\u7a0b\u4e0d\u53ef\u80fd\u6210\u7acb\u3002\n\n- \u82e5 a \u4e0d\u662f b \u7684\u500d\u6570\uff0c\u90a3\u4e48\u56e0\u4e3a\u6a21\u6570\u662f\u4e00\u4e2a\u8d28\u6570\uff0c\u6240\u4ee5 a \u4e0e b \u4e92\u8d28\uff0c\u90a3\u4e48 $bx_1 \\equiv 1 \\pmod p$\u4e00\u5b9a\u6709\u89e3,\u6545\u4e00\u5b9a\u6709\u7b26\u5408\u6761\u4ef6\u7684 $x = c\u00d7 x_1$\n\n**\u4ee5\u4e0a\u6765\u81ea\u67d0\u9898\u89e3\uff0c\u9009\u7f16\u65f6\u6709\u6539\u52a8**\uff08\n\n----\n## \u5173\u4e8e\u89e3\u7684\u6570\u91cf\u4e0e\u6700\u5c0f\uff0c\u5927\u503c\n\n\u5982\u679c\u6211\u4eec\u89e3\u51fa\u4e00\u7ec4\u89e3\uff1a\n\n$ax_{1}+by_1=c$\n\n\u6839\u636e~~\u5927\u773c\u89c2\u5bdf\u6cd5~~\n\n\u53ef\u5f97\uff1a\n\n$a(x_1\\pm bk)+b(y_1\\mp ak)=c$\n\n\u4e5f\u662f\u53e6\u4e00\u5806\u89e3\uff0c\u53ea\u662f\u6709\u4e9b\u4e3a\u8d1f\n\n\u4e8e\u662f\u5c31\u80fd\u987a\u5229\u89e3\u51b3\u4e86\n\n-----\n\n\n### \u5230\u6b64\u5927\u6982\u7684\u601d\u8def\u8bb2\u5b8c\u4e86\uff0c\u8c22\u8c22\u7ba1\u7406\u5458\u7684\u5ba1\u6838",
        "postTime": 1573802139,
        "uid": 115359,
        "name": "phigy",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P5656 \u3010\u3010\u6a21\u677f\u3011\u4e8c\u5143\u4e00\u6b21\u4e0d\u5b9a\u65b9\u7a0b(exgcd)\u3011"
    },
    {
        "content": "\u6269\u6b27\uff0c\u6ce8\u610f\u5206\u7c7b\u8ba8\u8bba\u548c\u7ec6\u8282\u5904\u7406\n\n```cpp\n#include<cmath>\n#include<cstdio>\n#include<iostream>\n#define ll long long\nusing namespace std;\nll gcd(ll a,ll b)\n{\n\tif(!b)return a;\n\treturn gcd(b,a%b);\n}\nvoid exgcd(ll a,ll b,ll &x,ll &y)\n{\n\tif(!b){x=1,y=0;return;}\n\texgcd(b,a%b,x,y);\n\tll t=x;\n\tx=y,y=t-a/b*y;\n}//\u6269\u6b27\u6a21\u677f\nint main()\n{\n\tint T;\n\tscanf(\"%d\",&T);\n\twhile(T--)\n\t{\n\t\tll a,b,c,x,y,t;\n\t\tscanf(\"%lld%lld%lld\",&a,&b,&c);\n\t\tll d=gcd(a,b);\n\t\tif(c%d!=0)\n\t\t{\n\t\t\tprintf(\"-1\\n\");\n\t\t\tcontinue;\n\t\t}//\u65b9\u7a0b\u6709\u6574\u6570\u89e3\u7b49\u4ef7\u4e8egcd(a,b)|c\n\t\ta/=d,b/=d,c/=d;//\u540c\u9664\u516c\u7ea6\u6570\uff0c\u4e0d\u7136\u904d\u5386\u901a\u89e3\u4f1a\u6709\u9057\u6f0f\n\t\texgcd(a,b,x,y);//\u5f97\u5230ax+by=1\u7684\u4e00\u7ec4\u89e3\n\t\tx*=c,y*=c;//\u5f97\u5230ax+by=c\u7684\u4e00\u7ec4\u89e3\n\t\tif(x<=0)\n\t\t{\n\t\t\tt=abs(x)/b+1;\n\t\t\tx=x%b+b;//\u8d1f\u6570\u53d6\u6a21\u8f83\u7279\u6b8a\n\t\t\ty-=t*a;\n\t\t\tif(y<=0)//\u5f53x\u53d8\u5316\u4e3a\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u65f6\uff0cy\u6700\u5927\uff0c\u82e5y\u4f9d\u7136\u5c0f\u4e8e0\uff0c\u5219\u6ca1\u6709\u6b63\u6574\u6570\u89e3\n\t\t\t{\n\t\t\t\tprintf(\"%lld %lld\\n\",x,y%a+a);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tif(y<=0)//\u8fd9\u51e0\u884c\u4e0e\u4e0a\u51e0\u884c\u540c\u7406\n\t\t{\n\t\t\tt=abs(y)/a+1;\n\t\t\ty=y%a+a;\n\t\t\tx-=t*b;\n\t\t\tif(x<=0)\n\t\t\t{\n\t\t\t\tprintf(\"%lld %lld\\n\",x%b+b,y);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}//\u6b64\u65f6\uff0cx>0,y>0\n\t\tt=x/b;\n\t\tx-=t*b;//\u7b49\u4ef7\u5199\u6cd5\uff1a x%=b\n\t\tif(!x)x+=b,t--;//\u7ec6\u8282\uff0c\u7279\u5224\n\t\ty+=t*a;//\u6b64\u65f6\uff0cx\u6700\u5c0f\uff0c\u5bf9\u5e94\u7684\uff0cy\u6700\u5927\n\t\tll xmin=x,ymax=y;\n\t\tt=y/a;\n\t\ty-=t*a;\n\t\tif(!y)y+=a,t--;\n\t\tx+=t*b;\n\t\tll ymin=y,xmax=x;//\u8fd9\u51e0\u884c\u4e0e\u524d\u51e0\u884c\u540c\u7406\n\t\tprintf(\"%lld %lld %lld %lld %lld\\n\",(xmax-xmin)/b+1,xmin,ymin,xmax,ymax);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1573822699,
        "uid": 111739,
        "name": "thoq",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P5656 \u3010\u3010\u6a21\u677f\u3011\u4e8c\u5143\u4e00\u6b21\u4e0d\u5b9a\u65b9\u7a0b(exgcd)\u3011"
    },
    {
        "content": "\u5148\u8bf4\u4e24\u53e5\uff1a\n1. \u672c\u9898\u89e3\u5b66\u4e60\u4e86\u7f16\u7a0b&$\\LaTeX$\u795e\u4ed9 $\\color{black}{\\text{\u79bb}}\\color{red}\\text{\u6563\u5c0f\u6ce2\u53d8\u6362\\degree}$ \u7684\u601d\u8def\uff0c\u8ba9\u6211\u4eec\u4e00\u8d77%ta\uff01~~\uff08\u7ba1\u7406\u5458\uff1a\u9898\u89e3\u6284\u88ad\u9898\u89e3\uff0c\u68d5\u4e86\uff01\uff09~~\n2. \u5728\u9605\u8bfb\u672c\u6587\u4e4b\u524d\uff0c\u5982\u679c\u4f60\u5df2\u7ecf\u5b66\u4f1a\u4e86exgcd\u7684\u57fa\u7840\u7528\u6cd5\uff0c\u5e76\u4e14AC  [P1082 \u540c\u4f59\u65b9\u7a0b](https://www.luogu.com.cn/problem/P1082)\uff0c\u90a3\u5c31\u66f4\u597d\u5566\uff01\n\n\u6ca1\u6709\u505a\u5230\u4e5f\u6ca1\u5173\u7cfb\uff0c\u8ba9\u6211\u4eec\u5148\u6765\u4e86\u89e3\u4e00\u4e0bexgcd\u7684\u57fa\u7840\u7528\u6cd5\uff1a\n\nexgcd\u7b97\u6cd5\uff0c\u542c\u540d\u5b57\u5c31\u77e5\u9053\u8ddf\u8f97\u8f6c\u76f8\u9664\u6cd5\u6c42$\\gcd$\u6709\u5173\uff0c\u6211\u4eec\u7528\u7684\u5c31\u662f\u8f97\u8f6c\u76f8\u9664\u6cd5\u7684\u6838\u5fc3\u5f0f\u5b50\uff1a\n\n$\\gcd(a,b)=\\gcd(b,a\\bmod b)$\n\nexgcd\uff1a\u6c42$ax+by=\\gcd(a,b)$\u7684\u6574\u6570\u89e3\n\n\u8bbe$\\gcd(a,b)=d$\n\n\u5219$ax+by=d$\n\n\u6211\u4eec\u8bbe\u5df2\u7ecf\u627e\u5230\u4e86\u4e00\u7ec4\u89e3$x',y'$\uff0c\u4f7f$bx'+(a \\bmod b)y'=\\gcd(a,b)$\n\n$bx'+(a \\bmod b)y'=d$\n\n\u7531\u4e8e\u5546$\\times$\u9664\u6570+\u4f59\u6570=\u88ab\u9664\u6570\uff0c$a\\bmod b$\u53ef\u4ee5\u8fd9\u4e48\u8868\u793a\uff1a\n\n$bx'+(a-\\lfloor\\dfrac{a}{b}\\rfloor\\times b)y'=d$\n\n\u7ed9\u5b83\u7a0d\u5fae\u53d8\u4e2a\u5f62\uff1a\n\n$bx'+ay'-\\lfloor\\dfrac{a}{b}\\rfloor\\times by'=d$\n\n$ay'+b(x'-\\lfloor\\dfrac{a}{b}\\rfloor\\times y')=d$\n\n\u548c\u539f\u5f0f\u5bf9\u6bd4\u4e00\u4e0b\uff0c\u4f60\u4f1a\u60ca\u5947\u5730\u53d1\u73b0\uff1a\n\n$\\begin{cases}x=y'\\\\y=x'-\\lfloor\\dfrac{a}{b}\\rfloor\\times y'\\end{cases}$\n\n\u7531\u4e8e$b=0$\u65f6$\\begin{cases}x=1\\\\y=0\\end{cases}$\uff0c\u6240\u4ee5\u9012\u5f52\u6c42\u89e3\u5373\u53ef\n\n```cpp\n#include<iostream>\n#include<cstdio>\nusing namespace std;\ntypedef long long ll;\nll x,y; \nvoid exgcd(ll a,ll b){\n\tif(b==0){\n\t\tx=1;\n\t\ty=0;\n\t\treturn;\n\t}\n\texgcd(b,a%b);\n\tll t=x;\n\tx=y;\n\ty=t-a/b*y;\n}\nint main(){\n\tll a,b;\n\tcin>>a>>b;\n\texgcd(a,b);\n\tcout<<(x%b+b)%b;\n}\n```\n\u4ee5\u4e0a\u5c31\u662f\u6700\u57fa\u7840\u7684exgcd\u5566\uff01\u4f46\u662f\u6211\u4eec\u80af\u5b9a\u4e0d\u80fd\u53ea\u6ee1\u8db3\u4e8e\u8fd9\u4e9b\uff0c\u63a5\u4e0b\u6765\n\n\u6b63 \u7247 \u5f00 \u59cb\n\n\n\u2026\u2026\u9898\u76ee\u770b\u6837\u5b50\u597d\u96be\u9e2d\u2026\u2026\n\n\u6ca1\u5173\u7cfb\uff0c\u54b1\u4eec\u4e00\u4e2a\u4e00\u4e2a\u6765\u770b\uff01\n\n>\u82e5\u8be5\u65b9\u7a0b\u65e0\u6574\u6570\u89e3\uff0c\u8f93\u51fa $-1$\n\n\u8fd9\u4e2a\u5f88\u597d\u529e\uff0c\u6839\u636e**\u88f4\u8700\u5b9a\u7406**\uff0c\u5982\u679c$c$\u4e0d\u662f$gcd(a,b)$\u7684\u500d\u6570\uff0c\u65b9\u7a0b\u5fc5\u5b9a\u65e0\u89e3\n\n\uff08\u4e0d\u4e86\u89e3\u88f4\u8700\u5b9a\u7406\u7684\u5c0f\u4f19\u4f34[\u6233\u8fd9](https://www.luogu.com.cn/blog/ravenclawyangrunze/ma-ma-wo-jing-ran-zheng-chu-liao-pei-shu-ding-li-post)\uff0c\u672c\u6587\u6709\u5f88\u591a\u5730\u65b9\u4e5fcv\u81ea\u8fd9\u7bc7\u6587\u7ae0\uff09\n\n\u63a5\u4e0b\u6765\uff0c\u7528exgcd\u6c42\u51fa$ax+by=\\gcd(a,b)$\u7684\u6574\u6570\u89e3\u4e4b\u540e\uff0c\u5c31\u662f\u5404\u79cd\u6574\u6570\u89e3\u7684\u8ba8\u8bba\u5566\uff01\n\n\u628a\u5927\u8c61\u5173\u8fdb\u51b0\u7bb1\u91cc\u8981\u5206\u4e09\u6b65\uff0c\u90a3\u4e48\u8981\u89e3\u4e00\u4e2a\u4e8c\u5143\u4e00\u6b21\u4e0d\u5b9a\u65b9\u7a0b\u8981\u5206\u51e0\u6b65\u5462\uff1f\u4e5f\u662f\u4e09\u6b65\n\n\u9996\u5148\uff0c\u54b1\u4eec\u6765\u60f3\u8fd9\u6837\u4e00\u4e2a\u95ee\u9898\uff0c\n\n> step 1.\u7528$ax+by=\\gcd(a,b)$\u7684\u6574\u6570\u89e3\u6765**\u6c42$ax+by=c$\u7684\u6574\u6570\u89e3**\n\n\u8fd9\u5c31\u975e\u5e38\u7b80\u5355\u4e86\uff0c\u54b1\u8fd8\u662f\u8bbe $\\gcd(a,b)=d$\n\n\u7531\u4e8e$d$\u662f$a$\u548c$b$\u7684\u6700\u5927\u516c\u56e0\u6570\uff0c\u6240\u4ee5$d$\u80af\u5b9a\u80fd\u88ab\u4ed6\u4fe9\u6574\u9664\n\n\u4ece\u521a\u624d\u7684\u5f97\u5230\u7684\u7ed3\u8bba\u51fa\u53d1\uff0c\u6211\u4eec\u8bbe\u5df2\u77e5$ax'+by'=d$\uff0c$d\\times q=c$\n\n\u4e24\u8fb9\u540c\u65f6\u4e58$q$\uff0c\u8fd9\u6837\u7684\u8bdd\u5c31\u53ef\u4ee5\u53d1\u73b0$ax'\\times q+by'\\times q=d\\times q$\uff0c\u5373$ax'\\times q+by'\\times q=c$\n\n$\\begin{cases}x=x'\\times q\\\\y=y'\\times q\\end{cases}$\u5c31\u662f\u65b9\u7a0b\u7684\u4e00\u7ec4\u89e3\u5566\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9\u7ec4\u89e3\u5c31\u662f $\\begin{cases}x_0=x'\\times \\dfrac{c}{d}\\\\y_0=y'\\times \\dfrac{c}{d}\\end{cases}$\n\n> step 2.\u7528\u8fd9\u7ec4\u89e3$x_0,y_0$\u627e\u51fa\u65b9\u7a0b\u6240\u6709\u7684\u89e3\n\n\u54b1\u4eec\u8fd8\u662f\u5148\u4ece\u8fd9\u7ec4\u89e3$x_0,y_0$\u51fa\u53d1\uff0c\u8bbe$a(x_0+m)+b(y_0+n)=c$\n\n\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa$m$\u548c$n$\u5c31\u597d\u5566\n\n\u4ece\u8fd9\u4e2a\u5f0f\u5b50\u51fa\u53d1\uff1a$a(x_0+m)+b(y_0+n)=c$\n\n\u5c55\u5f00\u5b83\uff1a$ax_0+am+by_0+bn=c$\n\n\u90a3\u53ea\u8981\u8ba9$am+bn=0$\uff0c\u90a3\u5c31\u6ca1\u95ee\u9898\u5566\uff01\n\n\u7ee7\u7eed\u8bbe$\\gcd(a,b)=d$\uff0c\u6211\u4eec\u8ba9$\\begin{cases}m=t\\times \\dfrac{b}{d}\\\\n=-t\\times \\dfrac{a}{d}\\end{cases}$\n\n\u5e26\u8fdb\u53bb\u7b97\u4e00\u4e0b$am+bn$\u5f97\u5230$\\dfrac{ab}{d}-\\dfrac{ab}{d}$\uff0c\u679c\u7136\u662f$0$\uff01\n\n\u4efb\u53d6\u4e00\u4e2a$t$\uff0c\u5c31\u53ef\u4ee5\u7b97\u51fa\u76f8\u5e94\u7684$m$\uff0c$n$\uff0c\u8fdb\u800c\u63a8\u51fa$x$\u548c$y$\uff0c\u901a\u89e3get\uff01\n\n> step 3\uff1a\u8003\u8651\u6700\u5927/\u6700\u5c0f\u503c\n\n\u8fd9\u4e00\u6b65\u662f\u91cd\u96be\u70b9\uff0c\u7ad6\u8d77\u8033\u6735\u8ba4\u771f\u542c\u54df\uff01\n\n\u9996\u5148\uff0c$\\begin{cases}x=x_0+t\\times \\dfrac{b}{d}\\\\y=y_0-t\\times \\dfrac{a}{d}\\end{cases}$\n\n\u53ef\u4ee5\u770b\u51fa\uff0c**\u5f53$t$\u589e\u5927\u7684\u65f6\u5019\uff0c$x$\u8d8a\u6765\u8d8a\u5927\uff0c$y$\u8d8a\u6765\u8d8a\u5c0f**\n\n\u7531\u4e8e\u589e\u52a0/\u51cf\u5c11\u7684\u503c\u592a\u96be\u5199\u4e86\uff0c\u63a5\u4e0b\u6765\u8bbe$t\\times \\dfrac{b}{d}$\u4e3a$t_x$\uff0c$-t\\times \\dfrac{a}{d}$\u4e3a$t_y$\uff0c\u4e5f\u5c31\u662f$\\begin{cases}x=x_0+t_x\\\\y=y_0+t_y\\end{cases}$\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u9700\u8981\u627e\u51fa$x$\u7684\u6700\u5c0f\u6574\u6570\u89e3$x_{\\min}$\uff0c\u53ea\u9700\u8981\u628a$x_0$\u51cf\u53bb\u597d\u591a\u597d\u591a\u4e2a$t$\u5c31\u597d\n\n\u90a3\u5230\u5e95\u51cf\u591a\u5c11\u5462\uff1f\n\n\u65e2\u7136\u662f\u6b63\u6574\u6570\uff0c\u90a3\u5c31\u8981\u6c42$x_{\\min}\\geq 1$\uff0c\u8bbe\u51cf\u53bb$k$\u4e2a$t$\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$x_0+kt_x\\geq1$\n\n\u63a5\u4e0b\u6765\u5c31\u662f\u89e3\u4e00\u5143\u4e00\u6b21\u4e0d\u7b49\u5f0f\u5566\uff01\n\n$kt_x\\geq1-x_0$\n\n\u4e24\u8fb9\u540c\u65f6\u9664\u4ee5$t$\uff0c\u56e0\u4e3a\u8fd9\u91cc\u8981\u6c42$x$\u8d8a\u6765\u8d8a\u5c0f\uff0c\u6240\u4ee5$t$\u8981\u5c0f\u4e8e$0$\uff0c\u6ce8\u610f\u8981\u53d8\u53f7\u54df\uff01\n\n$k\\geq\\lceil\\dfrac{1-x_0}{t_x}\\rceil$\n\n\u56e0\u4e3a\u8fd9\u8fb9\u5fc5\u987b\u5927\u4e8e\u8fd9\u4e2a\u503c\uff0c\u6240\u4ee5\u8981\u53d6\u4e0a\u6574\n\n\u8fd9\u6837\u7684\u8bdd\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230$x_{\\min}$\uff0c\u4e5f\u5c31\u662f$x_0-\\lceil\\dfrac{1-x_0}{t_x}\\rceil$\u5566\uff01\n\n\u901a\u8fc7\u521a\u624d\u7684\u5206\u6790\u5462\uff0c$x_{\\min}$\u5bf9\u5e94\u7684$y$\u503c\u6b63\u597d\u662f$y_{\\max}$\uff0c\u5982\u679c$y_{\\max}<0$\u5462\uff0c\u90a3\u5c31\u6ca1\u6709\u6b63\u6574\u6570\u89e3\u5566\uff01\n\n\uff08\u6ca1\u6709\u6574\u6570\u89e3\u7684\u8bdd\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u628a$y_{\\min}$\u6c42\u51fa\u6765\uff0c\u8fd9\u4e2a\u5c31\u548c\u521a\u624d\u5904\u7406$x_{\\min}$\u7684\u65b9\u6cd5\u4e00\u6837\u4e86\uff0c$y_{\\min}=y_0-\\lceil\\dfrac{1-y_0}{t_y}\\rceil$\uff09\n\n\n\u641e\u5b9a\u4e86\u4e24\u4e2a\u89e3\uff0c\u63a5\u4e0b\u6765\u54b1\u4eec\u5728\u641e\u5269\u4e0b\u7684\u4e24\u4e2a\uff1a$x_{\\max}$\u548c$y_{\\min}$\n\n\u5148\u6765\u770b$y_{\\min}$\uff1a\u6211\u4eec\u9700\u8981\u5c06$y_{\\max}$\u51cf\u53bb\u5c3d\u53ef\u80fd\u591a\u7684$t_y$\uff0c\u4f7f\u5176\u4e3a\u6b63\u6574\u6570\n\n\u6709\u6ca1\u6709\u53d1\u73b0\u4e00\u4e2a\u795e\u5947\u7684\u4e8b\u60c5\uff1f\u6211\u4eec\u8981\u6c42\u7684$y_{\\min}$\uff0c\u6b63\u597d\u5c31\u662f$y_{\\max}\\bmod t_y$\uff01\u4e0d\u8fc7\u4e3a\u4e86\u9632\u6b62$0$\u4e4b\u7c7b\u7684\u7279\u6b8a\u60c5\u51b5\uff0c\u6211\u4eec\u8fd8\u662f\u628a\u5b83\u5199\u6210$(y_{\\max}-1)\\bmod t_y+1$\n\n\u90a3\u6211\u4eec\u7684$x_{\\max}$\u5462\uff1f\u5f88\u7b80\u5355\uff0c\u53ea\u8981\u52a0\u4e0a\u548c$y_{\\max}$\u51cf\u53bb\u7684\u76f8\u540c\u7684$t_x$\u5c31\u884c\u60f9\uff0c\u4e5f\u5c31\u662f$x_{\\min}+\\lfloor \\dfrac{y_{\\max}-1}{t_y}\\rfloor\\times t_x$\n\n\u6700\u540e\u8fd8\u5269\u4e0b\u4e00\u4e2a\u89e3\u7684\u4e2a\u6570\uff0c\u8fd8\u662f\u770b$y_{\\max}$\u51cf\u5230$y_{\\min}$\u7684\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u6709$\\lfloor \\dfrac{y_{\\max}-1}{t_y}\\rfloor+1$\u4e2a\u89e3\n\n\u603b\u7ed3\u4e00\u4e0b\u5c31\u662f\u8fd9\u6837\u7684\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/o3cf069m.png)\n\n\u653e\u7801\u8fc7\u6765\u5440\uff01\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\nusing namespace std;\ntypedef long long ll;//\u5341\u5e74OI\u4e00\u573a\u7a7a\uff0c\u4e0d\u5f00long long\u89c1\u7956\u5b97\nll x,y;\ninline ll read(){//\u5361\u5e38\u5361\u5f97\u597d\uff0c\u5feb\u8bfb\u4e0d\u80fd\u5c11\n\tchar c=getchar();\n\tint f=1;\n\tll x=0;\n\twhile(c<'0'||c>'9'){\n\t\tif(c=='-')\n\t\t\tf=-1;\n\t\tc=getchar();\n\t}\n\twhile(c>='0'&&c<='9'){\n\t\tx=(x<<1)+(x<<3)+(c^'0');\n\t\tc=getchar();\n\t}\n\treturn x*f;\n} \ninline ll exgcd(ll a,ll b){//\u6765\u4e00\u4efd\u840c\u840c\u54d2exgcd\n\tif(b==0){\n\t\tx=1;\n\t\ty=0;\n\t\treturn a;\n\t}\n\tll d=exgcd(b,a%b);\n\tll t=x;\n\tx=y;\n\ty=t-a/b*y;\n\treturn d;//\u987a\u4fbf\u628a\u6700\u5927\u516c\u56e0\u6570\u4e5f\u7ed9\u6c42\u51fa\u6765\u4e86\u5462\uff01\n}\nint main(){\n\tll t=read();\n\twhile(t--){\n\t\tll a=read(),b=read(),c=read();\n\t\tll d=exgcd(a,b);//\u6c42\u51fad\n\t\tif(c%d){//\u4e0d\u6ee1\u8db3\u88f4\u8700\u5b9a\u7406\uff0c\u76f4\u63a5\u8f93\u51fa-1\n\t\t\tprintf(\"-1\\n\");\n\t\t\tcontinue;\n\t\t}\n\t\tx=x*c/d,y=y*c/d;//\u6c42\u51fax0\u548cy0\uff0ctx\u548cty\n\t\tll tx=b/d,ty=a/d;\n\t\tll k=ceil((1.0-x)/tx);//\u6c42\u51fak\n\t\tx+=tx*k;\n\t\ty-=ty*k;\t\n\t\tif(y<=0){//\u5982\u679c\u6ca1\u6709\u6b63\u6574\u6570\u89e3\uff0c\u7b97\u51faymin\u4e4b\u540e\u8f93\u51fa\n\t\t\tll ymin=y+ty*1ll*ceil((1.0-y)/ty);\n\t\t\tprintf(\"%lld %lld\\n\",x,ymin);\n\t\t}\n\t\telse{//\u6309\u7167\u521a\u624d\u8bf4\u7684\u5904\u7406\n\t\t\tprintf(\"%lld \",(y-1)/ty+1);\n\t\t\tprintf(\"%lld \",x);\n\t\t\tprintf(\"%lld \",(y-1)%ty+1);\n\t\t\tprintf(\"%lld \",x+(y-1)/ty*tx);\n\t\t\tprintf(\"%lld\\n\",y);\n\t\t}\n\t}\n\treturn 0;\n}\n```\nThe end",
        "postTime": 1585050346,
        "uid": 239405,
        "name": "yangrunze",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5656 \u3010\u3010\u6a21\u677f\u3011\u4e8c\u5143\u4e00\u6b21\u4e0d\u5b9a\u65b9\u7a0b(exgcd)\u3011"
    }
]
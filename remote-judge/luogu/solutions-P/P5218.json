[
    {
        "content": "\u6b64\u6587\u540c\u6b65\u53d1\u8868\u4e8e\u6211\u7684\u535a\u5ba2\uff1ahttps://www.alpha1022.me/articles/lg-5218.htm\n\n\u9996\u5148\uff0c\u5bb9\u6613\u8bc1\u660e\u88f4\u8700\u5b9a\u7406\u53ef\u4ee5\u5e94\u7528\u4e8e $3$ \u4e2a\u53ca\u4ee5\u4e0a\u7684\u6574\u6570\u95f4\u3002  \n\u6240\u4ee5\u95ee\u9898\u8f6c\u5316\u4e3a\u6709\u591a\u5c11\u79cd\u9009\u6570\u7684\u65b9\u6848\u4f7f\u5f97\u9009\u51fa\u7684\u6570\u7684 $\\gcd = 1$\u3002\n\n\u8bbe $f(x)$ \u8868\u793a\u4f7f\u5f97\u9009\u51fa\u7684\u6570\u7684 $\\gcd = x$ \u7684\u65b9\u6848\u6570\uff0c$F(x) = \\sum\\limits_{x | d} f(d)$\u3002  \n$F(x)$ \u5176\u5b9e\u5c31\u662f\u9009\u51fa\u7684\u6570\u90fd\u662f $x$ \u7684\u500d\u6570\u7684\u65b9\u6848\u6570\uff0c\u663e\u7136 $n$ \u4ee5\u5185 $x$ \u7684\u500d\u6570\u6709 $\\lfloor \\frac n x \\rfloor$ \u4e2a\u3002  \n\u7531\u4e8e $\\sum\\limits_{i = 0}^n C_n^i = 2^n$\uff0c\u6709 $F(x) = 2^{\\lfloor \\frac n x \\rfloor} - 1$\u3002  \n\u51cf\u4e00\u662f\u4e3a\u4e86\u5254\u9664\u4e0d\u9009\u7684\u60c5\u51b5\u3002\n\n\u4e8e\u662f\u6709\n$$\\begin{aligned} & f(1) \\\\ = & \\sum\\limits_{i = 1}^n \\mu(i) F(i) \\\\ = & \\sum\\limits_{i = 1}^n \\mu(i) (2^{\\lfloor \\frac n i \\rfloor} - 1)\\end{aligned}$$\n\n\u5bf9\u4e8e\u6307\u6570\u505a\u6570\u8bba\u5206\u5757\uff0c\u5bf9\u4e8e $\\mu$ \u675c\u6559\u7b5b\u5c31\u597d\u4e86\u3002  \n\u6211\u7684\u675c\u6559\u7b5b\u6bd4\u8f83\u5077\u61d2\u76f4\u63a5\u4e0a\u4e86 unordered_map\uff08\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <cstdio>\n#include <tr1/unordered_map>\nusing namespace std;\nusing namespace tr1;\nconst long long N = 1e11;\nconst int CNT = 1e7;\nconst long long mod = 1e9 + 7;\nlong long n;\nint vis[CNT + 5],prime[CNT + 5],cnt,mu[CNT + 5];\nunordered_map<int,long long> w;\nlong long ans;\nlong long fpow(long long a,long long b)\n{\n    a %= mod,b %= mod - 1;\n    long long ret = 1;\n    for(;b;b >>= 1)\n        (b & 1) && (ret = ret * a % mod),a = a * a % mod;\n    return ret;\n}\nlong long calc(long long n)\n{\n    if(n <= CNT)\n        return mu[n];\n    if(w.count(n))\n        return w[n];\n    long long ret = 1;\n    for(register long long l = 2,r;l <= n;l = r + 1)\n    {\n        r = n / (n / l);\n        ret = (ret - (r - l + 1) % mod * calc(n / l) % mod + mod) % mod;\n    }\n    return w[n] = ret;\n}\nint main()\n{\n    mu[1] = 1;\n    for(register int i = 2;i <= CNT;++i)\n    {\n        if(!vis[i])\n            mu[prime[++cnt] = i] = -1;\n        for(register int j = 1;j <= cnt && i * prime[j] <= CNT;++j)\n        {\n            vis[i * prime[j]] = 1;\n            if(!(i % prime[j]))\n                break;\n            else\n                mu[i * prime[j]] = -mu[i];\n        }\n    }\n    for(register int i = 1;i <= CNT;++i)\n        mu[i] = (mu[i] + mu[i - 1] + mod) % mod;\n    scanf(\"%lld\",&n);\n    for(register long long l = 1,r;l <= n;l = r + 1)\n    {\n        r = n / (n / l);\n        ans = (ans + (calc(r) - calc(l - 1) + mod) * (fpow(2,n / l) - 1) % mod) % mod;\n    }\n    printf(\"%lld\\n\",(ans + mod) % mod);\n}\n```",
        "postTime": 1557497745,
        "uid": 75840,
        "name": "deserter",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5218 \u3010\u65e0\u804a\u7684\u6c34\u9898 II\u3011"
    },
    {
        "content": "\u524d\u7f6e\u829d\u58eb\uff1a[\u88f4\u8700\u5b9a\u7406](https://baike.baidu.com/item/%E8%A3%B4%E8%9C%80%E5%AE%9A%E7%90%86/)\u3001[\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14](https://oi-wiki.org/math/mobius/)\u3001[\u675c\u6559\u7b5b](https://oi-wiki.org/math/du/)\n\n\u7531\u4e8e\u6590\u8700\u5b9a\u7406\u53ef\u4ee5\u7528\u4e8e\u4efb\u610f\u6b63\u6574\u6570\u4e2a\u6570\u7684\u6b63\u6574\u6570\u95f4\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u7edf\u8ba1\u6709\u591a\u5c11\u79cd\u9009\u6570\u7684\u65b9\u6848\u4f7f\u5f97\u9009\u51fa\u7684\u6570\u7684\u6700\u5927\u516c\u7ea6\u6570\u4e3a $1$\u3002\n\n\u8003\u8651\u6240\u6c42\u7b54\u6848\u7684\u500d\u6570\u7684\u7b54\u6848\u548c\u3002\u8bbe $f(n)$ \u8868\u793a\u6240\u9009\u6570\u7684\u6700\u5927\u516c\u7ea6\u6570\u4e3a $n$ \u7684\u65b9\u6848\u6570\uff0c$g(n, m) = \\displaystyle\\sum_{n\\ |\\ d}^m f(d)$\uff0c\u5219 $g(n)$ \u8868\u793a\u9009\u51fa\u6570\u7684\u6700\u5927\u516c\u7ea6\u6570\u4e3a $n$ \u7684\u500d\u6570\u7684\u65b9\u6848\u6570\u3002\u663e\u7136\uff0c$g(n, m) = 2^{\\lfloor \\frac{m}{n} \\rfloor} - 1$\u3002\n\n\u7531\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u516c\u5f0f\u53ef\u5f97\uff1a\n\n\u539f\u5f0f $= f(1)$\n\n$ = \\displaystyle\\sum_{i = 1}^n \\mu(i) F(i, n)$\n\n$ = \\displaystyle\\sum_{i = 1}^n \\mu(i) (2^{\\lfloor \\frac{n}{i} \\rfloor} - 1)$\n\n\u4f7f\u7528\u6570\u8bba\u5206\u5757\u548c\u675c\u6559\u7b5b\u8ba1\u7b97\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^{\\frac{2}{3}} \\log n)$\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <iostream>\n#include <map>\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst int N = 3e7 + 7, mod = 1e9 + 7;\nint prime[N], mu[N], sum[N];\nbool p[N];\nmap<ll, int> mp;\n\ninline void init(){\n\tint cnt = 0;\n\tp[0] = p[1] = true;\n\tmu[1] = 1;\n\tfor (register int i = 2; i < N; i++){\n\t\tif (!p[i]){\n\t\t\tprime[++cnt] = i;\n\t\t\tmu[i] = -1;\n\t\t}\n\t\tfor (register int j = 1; j <= cnt && i * prime[j] < N; j++){\n\t\t\tint t = i * prime[j];\n\t\t\tp[t] = true;\n\t\t\tif (i % prime[j] == 0){\n\t\t\t\tmu[t] = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmu[t] = -mu[i];\n\t\t}\n\t}\n\tfor (register int i = 1; i < N; i++){\n\t\tsum[i] = sum[i - 1] + mu[i];\n\t}\n}\n\ninline ll quick_pow(ll x, ll p, ll mod){\n\tll ans = 1;\n\twhile (p){\n\t\tif (p & 1) ans = ans * x % mod;\n\t\tx = x * x % mod;\n\t\tp >>= 1;\n\t}\n\treturn ans;\n}\n\ninline int get_mu_sum(ll n){\n\tif (n < N) return sum[n];\n\tif (mp.count(n)) return mp[n];\n\tint ans = 1;\n\tfor (register ll i = 2, j; i <= n; i = j + 1){\n\t\tll tn = n / i;\n\t\tj = n / tn;\n\t\tans -= get_mu_sum(tn) * (j - i + 1);\n\t}\n\treturn mp[n] = ans;\n}\n\nint main(){\n\tll n, ans = 0;\n\tcin >> n;\n\tinit();\n\tfor (register ll i = 1, j; i <= n; i = j + 1){\n\t\tll tn = n / i;\n\t\tj = n / tn;\n\t\tans = ((ans + (quick_pow(2, tn, mod) - 1) * (get_mu_sum(j) - get_mu_sum(i - 1)) % mod) % mod + mod) % mod;\n\t}\n\tcout << ans;\n\treturn 0;\n}\n```",
        "postTime": 1614681305,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P5218 \u3010\u65e0\u804a\u7684\u6c34\u9898 II\u3011"
    },
    {
        "content": "\u6839\u636e\u88f4\u8700\u5b9a\u7406\uff0c\u9898\u76ee\u4e2d\u7684\u6761\u4ef6\u7b49\u4ef7\u4e8e\u9009\u62e9\u51fa\u6765\u7684\u6240\u6709\u5143\u7d20gcd=1\u3002\u6ce8\uff1a\u4ee5\u4e0b\u5f0f\u5b50\u5982\u65e0\u7279\u6b8a\u8bf4\u660e\"/\"\u5747\u4ee3\u8868\u4e0b\u53d6\u6574\u6574\u9664\n\n\u53cd\u6f14\u4e00\u4e0b\u53ef\u4ee5\u5f97\u5230ans=(2^(n/i)-1)*f(i)\uff0c\u5176\u4e2df\u662f\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\uff0c2^(n/i)\u610f\u4e49\u4e3ai\u7684\u6240\u6709\u500d\u6570\u90fd\u6709\u9009\u6216\u4e0d\u9009\u4e24\u79cd\u53ef\u80fd,-1\u4e3a\u6392\u9664\u7a7a\u96c6\u60c5\u51b5\u3002\u6309\u7167\u53cd\u6f14\u9898\u7684\u5957\u8def\u6574\u9664\u5206\u5757\uff0c\u5e76\u675c\u6559\u7b5b\u5373\u53ef\u3002\n\n```cpp\n#include <stdio.h>\n#include <string.h>\n#include <map>\nusing namespace std;\ntypedef long long ll;\nmap<ll,int> s;\nconst int N=1e7+2,p=1e9+7;\nll n,x;\nint m,i,j,y,z,mu[N],ss[N],gs,ans;\nbool ed[N];\ninline int ksm(int y)\n{\n    int x=2,r=1;\n    while (y)\n    {\n        if (y&1) r=(ll)r*x%p;\n        y>>=1;\n        x=(ll)x*x%p;\n    }\n    return r-1;\n}\ninline int S(ll n)\n{\n    ll i;\n    if (n<=m) return mu[n];\n    if (i=s[n]) return i;\n    ll j,k;\n    int ans=0;\n    for (i=2;i<=n;i=j+1)\n    {\n        j=n/(k=n/i);\n        ans=(ans+(ll)S(k)*((j-i+1)%p))%p;\n    }\n    ans=1-ans;\n    if (ans<0) ans+=p;\n    return s[n]=ans;\n}\nint main()\n{\n    scanf(\"%lld\",&n);\n    m=min((ll)(N-2),n);//m=2;\n    mu[1]=1;\n    for (i=2;i<=m;i++)\n    {\n        if (!ed[i]) mu[ss[++gs]=i]=-1;\n        for (j=1;(j<=gs)&&(i*ss[j]<=m);j++)\n        {\n            ed[i*ss[j]]=1;\n            if (i%ss[j]==0) break;\n            mu[i*ss[j]]=-mu[i];\n        }\n        mu[i]+=mu[i-1];\n    }\n    ll i,j;\n    for (i=1;i<=n;i=j+1)\n    {\n        j=n/(x=(n/i));\n        ans=(ans+(ll)ksm(x%(p-1))*((z=S(j))-y))%p;\n        y=z;\n    }\n    if (ans<0) ans+=p;\n    printf(\"%d\",ans);\n}\n```",
        "postTime": 1549710107,
        "uid": 29826,
        "name": "SSerxhs",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5218 \u3010\u65e0\u804a\u7684\u6c34\u9898 II\u3011"
    }
]
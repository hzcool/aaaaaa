[
    {
        "content": "\u867d\u7136\u6708\u8d5b\u9898\u6709\u5b98\u65b9\u9898\u89e3\u4f46\u662f\u7a7a\u8361\u8361\u7684\u4e0d\u662f\u5f88\u96be\u770b\u5417\u3002\u3002\u3002\n\n\u8fd9\u4e2a\u9898\u663e\u7136\u662f\u6709\u89c4\u5f8b\u7684\u5566\u2026.\u867d\u7136\u6211\u7684\u65b9\u6cd5\u5e76\u4e0d\u662f\u5f88\u597d\n\n\n\u9996\u5148\u6211\u4eec\u6765\u770b\u770b\n\n\n ![](https://cdn.luogu.com.cn/upload/pic/8131.png) \n\n\u5bf9\u4e8e5\u53bb\u6389\u4e00\u6761\u8fb9\uff0c\u6211\u4eec\u80fd\u591f\u53d1\u73b0\uff0c\u8fd9\u662f\u4e00\u4e2a\u56db\u4e2a\u70b9\u7684\u5b8c\u5168\u56fe\u52a0\u4e0a\u4e00\u4e2a\u70b9\u5f15\u51fa\u4e09\n\n\u6761\u8fb9\n\n\u90a3\u4e48\uff0c\u56db\u4e2a\u70b9\u7684\u5b8c\u5168\u56fe\u6709\u7684\u73af\uff0c\u8fd9\u4e2a\u56fe\u4e5f\u4e00\u5b9a\u6709\uff1b\u800c\u8fd9\u4e2a\u56fe\u6bd44\u70b9\u5b8c\u5168\u56fe\u591a\u51fa\u6765\n\n\n\u7684\u73af\uff0c\u4e00\u5b9a\u8981\u7ecf\u8fc7\u7b2c\u4e94\u4e2a\u70b9\uff08\u7ea2\u7684\u90a3\u4e2a\uff09\u3002\n\n\n\u4e3a\u4e86\u5f62\u6210\u73af\uff0c\u80af\u5b9a\u662f\u4e00\u8fb9\u8fdb\uff0c\u4e00\u8fb9\u51fa\uff0c\u9009\u62e9\u6709C(3,2)\u79cd\uff0c\u800c\u4efb\u610f\u4e00\u79cd\u9009\u62e9\uff0c\u80af\u5b9a\u8981\u843d\u57284\u70b9\u5b8c\u5168\u56fe\u7684\u4e24\u4e2a\u70b9\u4e0a\uff0c\u6240\u4ee5\u6211\u4eec\u8fd8\u8981\u77e5\u9053\u56db\u4e2a\u70b9\u7684\u5b8c\u5168\u56fe\u4e2d\u4ece\u4efb\u610fA\u5f00\u59cb\u5230\u4efb\u610fB\u6709\u51e0\u79cd\u65b9\u6848\n\n\n\u53ef\u4ee5\u6570\u51fa\u6765\uff0c\u662f5\n\n\n\u7528it[i]\uff0c\u8868\u793ai\u4e2a\u70b9\u7684\u5b8c\u5168\u56fe\uff0c\u4efb\u53d6A\u3001B\uff0cA->B\u7684\u65b9\u6848\u6570\u6709\u591a\u5c11\n\n\nlast[i]\uff0c\u8868\u793ai\u4e2a\u70b9\u7684\u5b8c\u5168\u56fe\uff0c\u6709\u591a\u5c11\u4e2a\u73af\n\n\n\u90a3\u4e48 ans[n]=c(n-2,2)\\*it[n-1]+last[n-1]\n\n\n\u5230\u8fd9\u91cc\uff0c60%\u5df2\u7ecf\u53ef\u4ee5\u89e3\u51b3\u4e86\n\n\n\u63a5\u4e0b\u6765\u662fAC\n\n\n\u7528\u8ba1\u7b97\u5668\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2a\u4e8b\u60c5\uff0c\u5269\u4e0b\u768440%\u53ea\u6709100W\u7684\u8303\u56f4\n\n\n\u6240\u4ee5\u2026\u6211\u4eec\u53ef\u4ee5\u9884\uff08\u6253\uff09\u5904\uff08\u8868\uff09\u7406\u4e00\u4e0b\n\n\n\u7136\u540e\u2026\u5c31\u53ef\u4ee5A\u4e86\u2026\n\n\u5173\u4e8eit\u4ee5\u53calast\u7684\u63a8\u5bfc\u5173\u7cfb\u3002\u3002\u3002\u6211\u5e76\u4e0d\u4f1a\u8bc1\u660e\uff0c\u4f46\u662f\u901a\u8fc7\u6837\u4f8b\u53ef\u4ee5\u63a8\u51fa\u6765\u4e00\u4e2a\u4e0d\u77e5\u5bf9\u9519\u7684\u5f0f\u5b50\uff0c\u8fd9\u65f6\u5019\u5c31\u8981\u770b\u80c6\u5b50\u4e862333333\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#define mod 998244353\n#define M 999000000-2\n#define ll long long\nusing namespace std;\nll T,n;\nll c[100021],it[100021];\nll last[100021];\nvoid get_c()\n{\n    c[2]=1;\n    for(ll i=3;i<=100020;i++)\n    {\n        c[i]=(i-1)*i/2;\n        c[i]%=mod;\n    }\n    it[3]=2;\n    for(ll i=4;i<=100020;++i)\n    {\n        it[i]=it[i-1]*(i-2)+1;\n        it[i]%=mod;\n    }\n    last[3]=1;\n    for(ll i=4;i<=100020;++i)\n    {\n        last[i]=c[i-1]*it[i-1]+last[i-1];\n        last[i]%=mod;\n    }\n}\nll cb[1000010],lastb[1000010],itb[1000010];\nvoid get_b()\n{\n    cb[0]=1420232,lastb[0]=876466444,itb[0]=141309211;\n    ll to=1000005;\n    for(ll i=1;i<=1000005;++i)\n    {\n        ll num=i+M;\n        cb[i]=cb[i-1]+num-1;\n        cb[i]%=mod;\n        lastb[i]=cb[i-1]*itb[i-1]+lastb[i-1];\n        lastb[i]%=mod;\n        itb[i]=itb[i-1]*(num-2)+1;\n        itb[i]%=mod;\n    }\n}\nint main()\n{\n    scanf(\"%lld\",&T);\n    get_c();\n    get_b();\n    while(T--)\n    {\n        scanf(\"%lld\",&n);\n        if(n>M)\n        {\n            n%=M;\n            ll ans=cb[n-2]*itb[n-1]+lastb[n-1];\n            ans%=mod;\n            printf(\"%lld\\n\",ans);\n            continue;\n        }\n        ll ans=c[n-2]*it[n-1]+last[n-1];\n        ans%=mod;\n        printf(\"%lld\\n\",ans);\n    }\n}\n//\u4eca\u5929\u4e5f\u4f9d\u65e7\u6ca1\u6709\u635e\u523047\u5c9b\u98ce\u538c\u6218\u5462\n```",
        "postTime": 1505992218,
        "uid": 35718,
        "name": "MloVtry",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3862 \u30108\u6708\u6708\u8d5bB\u3011"
    },
    {
        "content": "\u9898\u610f\uff1a\u6c42 $n$ \u4e2a\u70b9\u7684\u65e0\u5411\u5b8c\u5168\u56fe\u5220\u53bb\u4e00\u6761\u8fb9\u4e4b\u540e\u5708\u7684\u4e2a\u6570\u3002\n\n\u6838\u5fc3\u601d\u60f3\uff1a\u9012\u63a8\n\n\u89e3\uff1a\n\n\u51fa\u4e8e\u4e2a\u4eba\u80fd\u529b\u9650\u5236\uff0c\u672c\u9898\u89e3\u5728\u5c11\u6570\u4f4d\u7f6e\u4f7f\u7528\u4e86OEIS\u3002\u5e0c\u671b\u4e25\u8c28\u6570\u5b66\u8bc1\u660e\u7684\u89c2\u8005\u9ebb\u70e6\u79fb\u6b65[\u8be5\u5904](https://oeis.org/search?q=1%2C+7%2C+37%2C+197&sort=&language=english&go=Search)\u3002\n\n\u6240\u6c42\u7b49\u4e8e\u5b8c\u5168\u56fe\u4e2d\u73af\u7684\u603b\u6570\u51cf\u53bb\u4efb\u610f\u4e00\u6761\u8fb9\u6240\u5728\u7684\u73af\u6570\uff08\u6bcf\u6761\u8fb9\u662f\u7b49\u4ef7\u7684\uff09\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a $n$ \u70b9\u7684\u5b8c\u5168\u56fe\uff0c$i$ \u4e2a\u70b9\u6784\u6210\u7684\u73af\u6709 $\\frac{(i-1)!}{2}C_n^i$ \u4e2a\uff08\u9009\u70b9\u6709 $C_n^i$ \u79cd\u65b9\u6cd5\uff0c\u6392\u5217\u8fd9\u4e9b\u70b9\u6709 $(n-1)!$ \u79cd\u65b9\u6cd5\uff0c\u987a\u9006\u76f8\u540c\u6545\u518d\u9664\u4ee5 $2$\uff09\uff0c\u5171\u6709 $\\frac{i!}{2}C_n^i$ \u6761\u8fb9\uff0c\u6545\u6bcf\u6761\u8fb9\u5728 $\\frac{\\frac{i!}{2}C_n^i}{\\frac{n(n-1)}{2}}=\\frac{n!}{n(n-1)(n-i)!}=\\frac{(n-2)!}{(n-i)!}$ \u4e2a\u73af\u4e0a\u3002\n\n\u56e0\u6b64\u6240\u6c42\u5373\u4e3a $\\sum^n_{i=3}\\frac{(i-1)!}{2}C_n^i-\\sum^n_{i=3}\\frac{(n-2)!}{(n-i)!}$\u3002\u5bf9\u4e8e\u53f3\u8fb9\u4e00\u9879\u6709 $\\sum^n_{i=3}\\frac{(n-2)!}{(n-i)!}=\\sum^n_{i=4}\\frac{(n-2)!}{(n-i)!}+n-2=(n-2)(\\sum_{i=3}^{n-1}\\frac{(n-3)!}{(n-i-1)!}+1)$\uff0c\u56e0\u6b64\u53ef\u4ee5\u9012\u63a8\u3002\u5de6\u8fb9\u4e00\u9879\u6784\u6210\u6570\u5217A002807\u5e76\u5177\u6709\u9012\u63a8\u5f0f $a_n=\\frac{(n-1)(n-2)}{2}+na_{n-1}-(n-1)a_{n-2}$\uff0c\u56e0\u6b64\u4e5f\u53ef\u4ee5\u9012\u63a8\u3002\n\n\u6ce8\u610f\u5230 $10^9$ \u7684\u6570\u636e\u8303\u56f4\u5bb9\u6613\u8ba9 $O(n)$ \u7684\u9012\u63a8\u8d85\u65f6\uff08\u4f18\u5316\u4e00\u4e0b\u5e94\u53ef\u907f\u514d\uff09\uff0c\u5148\u6253\u8868\u6253\u51fa $10^6|n$ \u65f6\u7684\u5de6\u9879\u548c\u53f3\u9879\uff0c\u4e4b\u540e\u5206\u522b\u9012\u63a8\u5e76\u76f8\u51cf\u5373\u53ef\u3002\n\n\u4ee3\u7801\uff1a\n```\n#include <bits/stdc++.h>\nusing namespace std;\nconst long long mod=998244353;\nlong long preb[1001]=//\u6253\u8868\u53f3\u9879\nlong long prea[1001]=\nlong long prpa[1001]=//\u6253\u8868\u5de6\u9879\u53ca\u5176\u6b21\u9879\uff08\u56e0\u4e3a\u5de6\u9879\u662f\u4e8c\u9636\u9012\u63a8\uff09\nlong long t, n, a[3], b;\nint main()\n{\n\tcin>>t;\n\tfor(int j=1; j<=t; j++)\n\t{\n\t\tcin>>n;\n\t\tif(n%1000000==0)//\u7279\u5224\n\t\t\tcout<<(prea[n/1000000]-preb[n/1000000]+mod)%mod<<endl;\n\t\telse if(n%1000000==1)//\u7279\u5224\n\t\t\tcout<<(prea[n/1000000]-(n-2)*(preb[n/1000000]+1)+mod)%mod<<endl;\n\t\telse if(n<1000000)//n\u5c0f\u4e8e1000000\u65f6\u9012\u63a8\u59cb\u70b9\u4e0e\u5927\u4e8e\u65f6\u4e0d\u540c\uff0c\u56e0\u6b64\u4e5f\u9700\u7279\u5224\n\t\t{\n\t\t\tfor(int i=0; i<=2; i++)\n\t\t\t\ta[i]=0;\n\t\t\tb=0;//\u521d\u59cb\u5316\n\t\t\tfor(long long i=3; i<=n; i++)\n\t\t\t{\n\t\t\t\ta[i%3]=((i-1)*(i-2)/2%mod+i*a[(i+2)%3]%mod-(i-1)*a[(i+1)%3]%mod+mod)%mod;\n\t\t\t\tb=(i-2)*(b+1)%mod;\n\t\t\t}//\u8fd0\u7b97\n\t\t\tcout<<(a[n%3]-b+mod)%mod<<endl;//\u8f93\u51fa\n\t\t}\n\t\telse//\u9012\u63a8\n\t\t{\n\t\t\tb=preb[n/1000000];\n\t\t\ta[n/1000000*1000000%3]=prea[n/1000000];\n\t\t\ta[(n/1000000*1000000+1)%3]=prpa[n/1000000];\n\t\t\ta[(n/1000000*1000000+2)%3]=0;//\u521d\u59cb\u5316\n\t\t\tfor(long long i=n/1000000*1000000+1; i<=n; i++)\n\t\t\t\tb=(i-2)*(b+1)%mod;\n\t\t\tfor(long long i=n/1000000*1000000+2; i<=n; i++)\n\t\t\t\ta[i%3]=((i-1)*(i-2)/2%mod+i*a[(i+2)%3]%mod-(i-1)*a[(i+1)%3]%mod+mod)%mod;//\u8fd0\u7b97\n\t\t\tcout<<(a[n%3]-b+mod)%mod<<endl;//\u8f93\u51fa\n\t\t}\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1666970774,
        "uid": 191387,
        "name": "\u03a6\u03c1\u03b1\u03bd\u03ba",
        "ccfLevel": 0,
        "title": "P3862 \u6570\u5708 \u9898\u89e3"
    }
]
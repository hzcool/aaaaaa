[
    {
        "content": "# P2565 [SCOI2009]\u9ab0\u5b50\u7684\u5b66\u95ee\n\n## \u9898\u9762\u89e3\u6790\n\n\u9898\u9762 link : [P2565](https://www.luogu.com.cn/problem/P2565)\n\n\u7ed9\u5b9a\u4e00\u4e2a\u5927\u5c0f\u4e3a $n$ \u7684\u6570\u7ec4 $\\{ a_i \\}$ \uff0c\u4f60\u8981\u7528\u6574\u6570 $1$ \u5230 $n \\times m$ \u586b $n$ \u4e2a $m$ \u9762\u7684\u9ab0\u5b50\uff0c\u5b9d\u6210\u6bcf\u4e2a\u6570\u5b57\u53ea\u51fa\u73b0\u4e00\u6b21\uff0c\u4f7f\u5f97\u7b2c $i$ \u4e2a\u9ab0\u5b50\u5927\u4e8e\u7b2c $a_i$ \u4e2a\u9ab0\u5b50\uff0c\u4e14\u5bf9\u4e8e\u6bcf\u4e2a\u9ab0\u5b50\u63b7\u51fa\u4efb\u610f\u4e00\u4e2a\u9762\u7684\u6982\u7387\u76f8\u7b49\u3002\n\n\u5bf9\u4e8e\u9ab0\u5b50 $x$ \u5927\u4e8e\u9ab0\u5b50 $y$ \u7684\u5b9a\u4e49\uff0c\u5f53\u4e14\u4ec5\u5f53\u9ab0\u5b50 $x$ \u63b7\u51fa\u7684\u70b9\u6570\u5927\u4e8e\u9ab0\u5b50 $y$ \u63b7\u51fa\u7684\u70b9\u6570\u7684\u6982\u7387\u5927\u4e8e $\\frac{1}{2}$\u3002\n\n\u8be5\u9898\u7684\u5168\u90e8\u6837\u4f8b\u5982\u4e0b\uff08\u5bf9\u89e3\u9898\u6709\u6240\u5e2e\u52a9\uff09\uff1a\n\n![](https://pic.imgdb.cn/item/617fdcb92ab3f51d91a915bb.jpg)\n\n## \u7b97\u6cd5\u5206\u6790\n\n\u5c06\u9ab0\u5b50\u6309\u7167\u9ab0\u5b50 $x$ \u5927\u4e8e\u9ab0\u5b50 $y$ \u7684\u5173\u7cfb\u5efa\u7acb\u6709\u5411\u56fe\u3002\u800c\u8fd9\u5f20\u56fe\uff0c\u5c31\u6784\u6210\u4e86\u4e00\u4e2a\u57fa\u73af\u5185\u5411\u6811\u68ee\u6797\u3002\n\n\u6b64\u65f6\u6574\u5f20\u56fe\u53ef\u4ee5\u88ab\u62c6\u5206\u6210\u4e3a\u4e24\u4e2a\u90e8\u5206\uff0c\u5206\u522b\u662f\u73af\u5185\u4e0e\u73af\u5916\u3002\u5bf9\u4e8e\u4efb\u610f\u7684\u5904\u4e8e\u73af\u5916\u7684\u70b9\uff0c\u5b83\u5e94\u5f53\u4fdd\u8bc1\u6240\u6709\u7684\u7236\u4eb2\u5747\u5927\u4e8e\u5b83\u3002\u90a3\u4e48\u53ef\u4ee5\u5f62\u6210\u4e00\u79cd\u5728\u73af\u5916\u7684\u6784\u9020\u65b9\u6cd5\uff1a\n\n\u5bf9\u4e8e\u73af\u5916\u7684\u6bcf\u4e00\u4e2a\u70b9\uff0c\u4fdd\u8bc1\u4fdd\u8bc1\u5b83\u7684\u7236\u4eb2\u7684\u6bcf\u4e00\u9762\u7684\u70b9\u6570\u90fd\u6bd4\u5b83\u7684\u6700\u5927\u70b9\u6570\u5927\u3002\u663e\u7136\u73af\u5916\u7684\u9ab0\u5b50\u76f4\u63a5\u5206\u914d\u6781\u5927\u503c\u5c31\u884c\u4e86\u3002\n\n\u8fd9\u6837\u95ee\u9898\u5c31\u7f29\u5c0f\u6210\u4e86\u8fd0\u7528 $q \\times m$ \u4e2a\u6570\u586b\u51fa\u4e00\u4e2a\u5408\u6cd5\u7684\u73af\u3002 \u5f88\u660e\u663e\u6b64\u65f6\u6ee1\u8db3 $q > 2, m > 2$\n\n\u800c\u5bf9\u4e8e\u5728\u73af\u5185\u7684\u9ab0\u5b50\u3002\u9009\u62e9\u4e00\u4e2a\uff0c\u5411\u7236\u4eb2\u65b9\u5411\u4f9d\u6b21\u653e\u4e0b $(1,n)$ \u7684\u503c\uff0c\u518d\u9009\u62e9\u4e00\u4e2a\uff0c\u5411\u7236\u4eb2\u65b9\u5411\u4f9d\u6b21\u653e\u4e0b $(n+1,2n)$ \u3002\u5982\u6b64\u91cd\u590d\u76f4\u5230\u586b\u6ee1\u3002\n\n\u8bc1\u660e\uff1a\n\n\u4e24\u4e2a\u9ab0\u5b50\u53ef\u4ee5\u7b49\u6982\u7387\u7684\u6295\u51fa $m^2$ \u79cd\u7ec4\u5408\u3002\u56e0\u6b64\u5bf9\u4e8e\u4e00\u4e2a\u5408\u6cd5\u7684\u586b\u6cd5\uff0c\u4efb\u610f\u4e00\u4e2a\u70b9\u4e0e\u5b83\u7684\u540e\u7ee7\u5f62\u6210\u7684\u7ec4\u5408\u4e2d\u5e94\u81f3\u5c11\u6709 $\\left \\lceil \\frac{m^2 + 1}{2}  \\right \\rceil $ \u79cd\u6ee1\u8db3\u524d\u8005\u8f83\u5927\u3002\n\n\u5bf9\u4e8e\u4efb\u610f\u7684 $i > j$ \uff0c\u5728\u8fd9\u79cd\u6784\u9020\u4e0b\u90fd\u6ee1\u8db3\u4e86\u4efb\u4f55\u4e00\u4e2a\u9ab0\u5b50\u7684\u7b2c $i$ \u9762\u4e00\u5b9a\u6bd4\u53e6\u4e00\u4e2a\u9ab0\u5b50\u7684\u7b2c $j$ \u9762\u5927\uff0c\u6240\u4ee5\u76f8\u90bb\u7684\u9ab0\u5b50\u4e00\u5b9a\u5b58\u5728 $\\frac{m \\cdot (m- 1)}{2}$ \u79cd\u60c5\u51b5\u662f\u4fdd\u8bc1\u4e86\u524d\u9a71\u5927\u4e8e\u540e\u7ee7\u7684\u3002\n\n\u5bf9\u4e8e\u586b\u5728\u7b2c $i$ \u4e2a\u9ab0\u5b50\u4e0a\u7684 $q$ \u4e2a\u6570\u9664\u4e86\u6700\u5927\u7684\u4e00\u4e2a\u6570\u6240\u5728\u7684\u9ab0\u5b50\u7684\u524d\u9a71\uff0c\u6240\u6709\u7684\u6570\u90fd\u5927\u4e8e\u81ea\u5df1\u7684\u540e\u7ee7\u3002\u90a3\u4e48\u5b9e\u9645\u4e0a\u5c31\u76f8\u5f53\u4e8e\u7ed9\u6bcf\u4e2a\u9ab0\u5b50\u90fd\u589e\u52a0\u7684 $m$ \u79cd\u53ef\u884c\u60c5\u51b5\u3002\u800c\u540c\u65f6\u4f1a\u8fdb\u884c $m$ \u6b21\u9009\u62e9\uff0c\u9009\u62e9\u54ea\u4e00\u4e2a\u9ab0\u5b50\u4e3a\u8d77\u70b9\u3002\u6bcf\u6b21\u9009\u62e9\u4f1a\u5c06\u8fd9\u4e2a\u9ab0\u5b50\u5927\u4e8e\u540e\u7ee7\u7684\u6570\u91cf\u51cf\u4e00\u3002\n\n\u800c\u5bf9\u4e8e\u4efb\u610f\u7684\u4e00\u4e2a\u9ab0\u5b50\uff0c\u88ab\u9009\u51fa\u7684\u6b21\u6570\u6700\u591a\u5e94\u8be5\u4e3a $\\frac{m \\cdot (m+1)}{2} - \\left \\lceil \\frac{m^2 + 1}{2}  \\right \\rceil $ \uff0c\u800c\u603b\u9009\u62e9\u6b21\u6570\u5e94\u8be5\u4e58\u4ee5\u4e00\u4e2a $q$ \n\n1.  $m$ \u4e3a\u5947\u6570\uff0c\u603b\u9009\u62e9\u6b21\u6570\u53ef\u8868\u793a\u4e3a $\\frac{qm-q}{2}$ \uff0c \u5f53 $\\frac{q(m-1)}{2} \\geq m$ \u662f\u6210\u7acb\u3002\u6545\u6ee1\u8db3 $(q - 2) (m - 1) \\geq 2$  \uff0c\u8be5\u7b49\u5f0f\u548c\u6210\u7acb\n2.   $m$ \u4e3a\u5947\u5076\u6570\uff0c\u603b\u9009\u62e9\u6b21\u6570\u53ef\u8868\u793a\u4e3a $\\frac{qm-2q}{2}$ \uff0c \u5f53 $\\frac{qm-2q}{2} \\geq m$ \u662f\u6210\u7acb\u3002\u6545\u6ee1\u8db3 $(q - 2) (m - 2) \\geq 4$  \uff0c\u5f53\u4e14\u53ea\u6709\u4e00\u7ec4\u60c5\u51b5\u4e0d\u5408\u6cd5\uff0c\u5373 $\\left\\{\\begin{matrix}\n    q = 3 & \\\\\n    m = 4 &\n   \\end{matrix}\\right.$\n\n\u51fa\u73b0\u7684\u4e0d\u5408\u6cd5\u60c5\u51b5\u7279\u5224\u5373\u53ef\u3002\n\n## \u7b97\u6cd5\u5b9e\u73b0\n\n\u4e3a\u4e86\u65b9\u4fbf\u5b9e\u73b0\u53ef\u5c06\u539f\u6709\u73af\u5185\u64cd\u4f5c\u4fee\u6539\u4e3a\u5982\u4e0b\uff1a\n\n\u9009\u62e9\u4e00\u4e2a\u70b9\uff0c\u5411\u7236\u4eb2\u65b9\u5411\u4f9d\u6b21\u653e\u4e0b $(1,n)$ \u7684\u503c\uff0c\u518d\u9009\u62e9\u5b83\u7684\u7236\u4eb2\uff0c\u5411\u7236\u4eb2\u65b9\u5411\u4f9d\u6b21\u653e\u4e0b $(n+1,2n)$ \u3002\u5982\u6b64\u91cd\u590d\u76f4\u5230\u586b\u6ee1\u3002\n\n\u8fd9\u6837\u663e\u7136\u4e0e\u539f\u6709\u7ed3\u8bba\u5e76\u4e0d\u77db\u76fe\uff0c\u540c\u65f6\u53c8\u65b9\u4fbf\u5b9e\u8df5\u3002\n\n\u6700\u540e\u62d3\u6251\u6392\u5e8f\u5373\u53ef\n\n## code\n\n```cpp\n#include <bits/stdc++.h>\nconst int SIZE = (int)2e2 + 50;\nconst int Sample[4][5] = {{},{0,1,3,10,11},{0,2,7,8,9},{0,4,5,6,12}};\nint n,m,tot,head,tail;\nint son[SIZE],indegree[SIZE],que[SIZE];\nint ans[SIZE][SIZE];\ninline void toposort()\n{\n\tfor (int i = 1; i <= n; ++i) if (!indegree[i]) que[++tail] = i;\n\twhile (head <= tail)\n\t{\n\t\tint u = que[head++]; --indegree[son[u]];\n\t\tfor (int i = 1; i <= m; ++i) ans[u][i] = tot--;\n\t\tif (!indegree[son[u]]) que[++tail] = son[u];\n\t}\n\tfor (int i = 1; i <= n; ++i)\n\t{\n\t\tif (!indegree[i]) continue; tail = 0;\n\t\tfor (int u = i; indegree[u]; u = son[u]) indegree[que[++tail] = u] = 0;\n\t\tif (tail < 3) {printf(\"0\\n\"); exit(0);}\n\t\ttot -= tail * m;\n\t\tif (tail == 3 && m == 4)\n\t\t{\n\t\t\tans[que[1]][1] = Sample[1][1] + tot; ans[que[1]][2] = Sample[1][2] + tot;\n\t\t\tans[que[1]][3] = Sample[1][3] + tot; ans[que[1]][4] = Sample[1][4] + tot;\n\t\t\tans[que[2]][1] = Sample[2][1] + tot; ans[que[2]][2] = Sample[2][2] + tot;\n\t\t\tans[que[2]][3] = Sample[2][3] + tot; ans[que[2]][4] = Sample[2][4] + tot;\n\t\t\tans[que[3]][1] = Sample[3][1] + tot; ans[que[3]][2] = Sample[3][2] + tot;\n\t\t\tans[que[3]][3] = Sample[3][3] + tot; ans[que[3]][4] = Sample[3][4] + tot;\n\t\t\tcontinue;\n\t\t}\n\t\tfor (int j = 1,now = 1; now <= m; j = (j == 1 ?  tail : j - 1), ++now)\n\t\t{\n\t\t\tans[que[j]][now] = ++tot;\n\t\t\tfor (int k = (j == 1 ? tail : j - 1); k ^ j; k = (k == 1 ?  tail : k - 1)) \n\t\t\t\tans[que[k]][now] = ++tot;\n\t\t}\n\t\ttot -= tail * m;\n\t}\n}\nsigned main()\n{\n\tcin >> n >> m; tot = n * m; head = 1;\n\tfor (int i = 1; i <= n; ++i) cin >> son[i],indegree[son[i]]++;\n\tfor (int i = 1; i <= n; ++i) if (son[i] == i) return printf(\"0\\n\"),0;\n\ttoposort();\n\tfor (int i = 1; i <= n; ++i,printf(\"\\n\"))\n\t\tfor (int j = 1; j <= m; ++j)\n\t\t\tprintf(\"%d \",ans[i][j]);\n\treturn 0;\n}\n\n```\n\n",
        "postTime": 1635816417,
        "uid": 415231,
        "name": "nomonick",
        "ccfLevel": 0,
        "title": "P2565 [SCOI2009]\u9ab0\u5b50\u7684\u5b66\u95ee"
    }
]
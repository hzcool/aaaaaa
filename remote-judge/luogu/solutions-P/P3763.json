[
    {
        "content": "\u9898\u610f\uff1a\n\n\u7ed9\u51fa\u4e24\u4e2a\u957f\u5ea6\u5c0f\u4e8e $10^5$ \u7684\u5b57\u7b26\u4e32 $S$ \u548c $T$\uff0c\u6c42 $S$ \u4e2d\u6709\u591a\u5c11\u4e2a\u8fde\u7eed\u5b50\u4e32\u5728\u4e0d\u6539\u53d8\u8d85\u8fc7 $3$ \u4e2a\u5b57\u7b26\u540e\u53ef\u4ee5\u548c $T$ \u5339\u914d\u3002\u591a\u7ec4\u6570\u636e\uff0c\u5b57\u7b26\u96c6\u5927\u5c0f\u4e3a $4$\u3002\n\n---\n\n\u8bbe $S$ \u7684\u957f\u5ea6\u4e3a $n$\uff0c $T$ \u7684\u957f\u5ea6\u4e3a $m$\u3002\n\n\u5b57\u7b26\u96c6\u5927\u5c0f\u4e3a $4$\uff0c\u8003\u8651\u5bf9\u6bcf\u4e2a\u5b57\u7b26\u5206\u5f00\u8003\u8651\u3002\n\n\u6837\u4f8b\uff1a\n\n$\nS:\\ \\texttt{ATCGCCCTA}\n$\n\n$\nT:\\ \\texttt{CTTCA}\n$\n\n\u4e0d\u59a8\u5148\u5bf9\u5b57\u7b26 $\\texttt{C}$ \u8fdb\u884c\u5904\u7406\u3002\u5c06 $S$ \u548c $T$ \u4e2d\u4e3a $\\texttt{C}$ \u7684\u4f4d\u7f6e\u53d8\u4e3a $1$ \uff0c\u4e0d\u4e3a $\\texttt{C}$ \u7684\u4f4d\u7f6e\u53d8\u4e3a $0$ \u518d\u8fdb\u884c\u5339\u914d\u3002\n\n$\nS:\\ \\texttt{001011100}\n$\n\n$\nT:\\ \\texttt{10010}\n$\n\n\u90a3\u4e48\u5bf9\u4e8e\u67d0\u4e2a\u4f4d\u7f6e $k$\uff0c $S[k\\ ...\\ k+m-1]$ \u548c $T[0\\ ...\\ m-1]$ \u7684\u5339\u914d\u4e2a\u6570\u53ef\u4ee5\u5199\u4e3a\uff1a\n\n$$\\sum\\limits_{i=0}^{m-1}S[i+k]T[i]$$\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50\u7279\u522b\u50cf FFT\uff0c\u4e8e\u662f\u8fdb\u884c\u4e00\u756a\u5904\u7406\uff1a\n\n\u8bbe $A[m-i-1] = T[i]$\n\n\u4e0a\u5f0f\u53d8\u4e3a\uff1a\n\n$$\\sum\\limits_{i=0}^{m-1}S[i+k]A[m-i-1]$$\n\n$$\\sum\\limits_{i+j=m-k-1}S[i]A[j]$$\n\n\u7136\u540e\u8dd1 FFT \u5c31\u53ef\u4ee5\u5feb\u901f\u6c42\u51fa\u4e0a\u5f0f\u3002\n\n\u6700\u540e\u4f4d\u7f6e $S[k\\ ...\\ k+m-1]$ \u548c $T[0\\ ...\\ m-1]$ \u7684\u5339\u914d\u4e2a\u6570\u5c31\u662f\u8fd9\u56db\u6b21 FFT \u7ed3\u679c\u76f8\u52a0\u3002\n\n\u56e0\u4e3a\u53ef\u4ee5\u4fee\u6539\u4e09\u4e2a\u4f4d\u7f6e\uff0c\u6700\u540e\u5224\u65ad\u662f\u5426\u5339\u914d\u53ef\u4ee5\u6709 $3$ \u7684\u8bef\u5dee\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\ninline int read(){\n\tchar c=getchar();int x=0,f=1;\n    while(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n    while(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\n    return x*f;\n}\nconst int maxn=100010*4;\nstruct Complex{\n\tdouble x,y;\n};\nComplex operator +(Complex a,Complex b){return (Complex){a.x+b.x,a.y+b.y};}\nComplex operator -(Complex a,Complex b){return (Complex){a.x-b.x,a.y-b.y};}\nComplex operator *(Complex a,Complex b){return (Complex){a.x*b.x-a.y*b.y,a.x*b.y+a.y*b.x};}\nconst double Pi=acos(-1.0);\nComplex get_w(int k,int len,bool op){\n\tint T=1;if(!op)T=-1;\n\treturn (Complex){cos(2.0*k*Pi/len),T*sin(2.0*k*Pi/len)};\n}\nComplex A[maxn],B[maxn];\nint i,j,k,n,m;\nint R[maxn];\nchar C[4]={'A','T','C','G'};\nvoid FFT(int len,Complex *a,bool op){\n\tfor(int i=0;i<len;i++)\n\t\tif(i<R[i])swap(a[i],a[R[i]]);\n\tfor(int i=1;i<len;i=i*2){\n\t\tComplex w,Wn=get_w(1,i*2,op);\n\t\tfor(int j=0;j<len;j+=i*2){\n\t\t\tw=(Complex){1,0};\n\t\t\tfor(int k=0;k<i;k++,w=w*Wn){\n\t\t\t\tint K=k+j;\n\t\t\t\tComplex S1=a[K],S2=w*a[K+i];\n\t\t\t\ta[K]=S1+S2;\n\t\t\t\ta[K+i]=S1-S2;\n\t\t\t}\n\t\t}\n\t}\n}\nint Ans[maxn],ans;\nint main(){\n\tint T;\n\tcin>>T;\n\tstring None_;\n\tgetline(cin,None_);\n\twhile(T--){\n\t\tmemset(Ans,0,sizeof(Ans));ans=0;\n\t\tstring S,T;\n\t\tcin>>S>>T;\n\t\tn=S.size();\n\t\tm=T.size();\n\t\tfor(i=0;i<4;i++){\n\t\t\tfor(j=0;j<n;j++)\n\t\t\t\tA[j]=(Complex){(S[j]==C[i]),0};\n\t\t\tfor(j=0;j<m;j++)\n\t\t\t\tB[m-j-1]=(Complex){(T[j]==C[i]),0};\n\t\t\tint len=1,L=0;\n\t\t\twhile(len<=n+m)len*=2,++L;\n\t\t\tfor(j=0;j<len;j++)\n\t\t\t\tR[j]=R[j/2]/2+(j%2)*(1<<L-1);\n\t\t\tFFT(len,A,true);FFT(len,B,true);\n\t\t\tfor(j=0;j<len;j++)A[j]=A[j]*B[j];\n\t\t\tFFT(len,A,false);\n\t\t\tfor(j=m-1;j<=m+n-1;j++)\n\t\t\t\tAns[j-(m-1)]+=((int)(A[j].x/len+0.5));\n\t\t\tfor(j=0;j<len;j++)A[j]=B[j]=(Complex){0,0};\n\t\t}\n\t\tfor(i=0;i<n-m+1;i++)\n\t\t\tif(Ans[i]+3>=m)++ans;\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1582966794,
        "uid": 35891,
        "name": "huangzirui",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3763 \u3010[TJOI2017]DNA\u3011"
    },
    {
        "content": "\u4e1d\u6beb\u6ca1\u6709\u7f9e\u803b\u4e4b\u5fc3\u5730\u53d1\u4e00\u6ce2\u8dd1\u4e862300+s\u7684~~\u72d7\u5c4e~~\u4ee3\u7801\n\n# \u7528\u7684\u5b57\u7b26\u4e32\u54c8\u5e0c\n\n\u8bf4\u771f\u7684\u4ee5\u524d\u6ca1\u6709\u63a5\u89e6\u8fc7\u54c8\u5e0c\u8fd9\u73a9\u610f\u513f\n\nClaris~~\uff08\u662f\u7684\u672c\u5468\u6211\u7b2c\u4e09\u6b21cue\u4ed6\u4e86\uff09~~\u4eca\u5929\u8bb2\u4e86\u51e0\u5206\u949f\u54c8\u5e0c\u5c31\u62ff\u51fa\u4e86\u8fd9\u9053\u4f8b\u9898\n\n~~\u849f\u84bb\u745f\u745f\u53d1\u6296~~\n\n\u6709\u4e9b\u4e1c\u897f\u771f\u7684\u8bb2\u4e0d\u592a\u6e05\uff0c\u8bf7\u89c1\u8c05\n\n```cpp\n//hash(l,r)=hash(1,r)-hash(1,l-1)*seed^(r-l+1)\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef unsigned long long ULL;//\u81ea\u7136\u6ea2\u51fa\uff0c\u8fd9\u9053\u9898\u6ca1\u88ab\u5361\u54c7\u54c8\u54c8\nconst int N=100000+3,D=233;\nint n,m,T,ans;\nchar a[N],b[N];\nULL p[N],f[N],g[N];\ninline ULL ask(ULL*f,int l,int r){//[l,r]\u7684\u54c8\u5e0c\u503c \n\treturn f[r]-f[l-1]*p[r-l+1]; \n}\ninline int lcp(int x,int y,int r){\n\tint l=1,mid,t=0;\n\twhile(l<=r){//\u4e8c\u5206\u67e5\u627e\uff08\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u8ba9\u4e00\u4e2a\u673a\u623f\u7684\u4eba\u5435\u8d77\u6765\uff09\n\t\tmid=(l+r)>>1;\n\t\tif(ask(f,x,x+mid-1)==ask(g,y,y+mid-1)){//\u5982\u679c\u8fd9\u4e00\u6bb5\u662f\u76f8\u7b49\u7684 \n\t\t\tt=mid;//\u6807\u8bb0\u957f\u5ea6 \n\t\t\tl=mid+1;//l\u53f3\u79fb \n\t\t}\n\t\telse r=mid-1;//\u4e0d\u76f8\u7b49\u5c31\u5de6\u79fb \n\t}\n\treturn t;//\u8fd4\u56de\u957f\u5ea6 \n}\ninline bool check(int x){\n\tint r=x+m-1,y=1;//r\uff1aS0\u7684\u5c3e\uff1by:S\u7684\u5934\n\tfor(int i=0;i<3;++i){//3\u6b21\u5bb9\u9519 \n\t\tint t=lcp(x,y,m-y+1);//\u76f8\u540c\u7684\u957f\u5ea6 \n\t\t// m-y+1\n\t\tx+=t+1;//\u4e0d\u76f8\u7b49\u7684\u90a3\u4e2a\u8981\u8df3\u8fc7 \n\t\ty+=t+1;\n\t\tif(y>m)return 1;//\u5982\u679c\u6700\u7ec8\u957f\u5ea6\u80fd>m,\u5c31\u5339\u914d\u6210\u529f \n\t}\n\treturn ask(f,x,r)==ask(g,y,m);\n}\nint main(){\n\tscanf(\"%d\",&T);\n\twhile(T--){\n\t\tscanf(\"%s%s\",a+1,b+1);\n\t\tn=strlen(a+1);\n\t\tm=strlen(b+1);\n\t\tif(n<m){//\u4e0d\u89e3\u91ca\n\t\t\tprintf(\"0\\n\");\n\t\t\tcontinue;\n\t\t}\n\t\tp[0]=1;\n\t\tfor(int i=1;i<=n;++i)p[i]=p[i-1]*D;//\u9884\u5904\u7406\n\t\tfor(int i=1;i<=n;++i)f[i]=f[i-1]*D+a[i];//\u54c8\u5e0c\u503c \n\t\tfor(int i=1;i<=m;++i)g[i]=g[i-1]*D+b[i];\n\t\tans=0;\n\t\tfor(int i=1;i+m-1<=n;++i)//\u679a\u4e3e\u76f8\u540c\u5b57\u7b26\u4e32\u7684\u5934 \n\t\t\tif(check(i))ans++;\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n\n\u6211\u771f\u7684\u89c9\u5f97\u8fd9\u4e2a\u8dd1\u5f97\u597d\u6162\u554aQAQ\n\n~~\u53ef\u662f\u522b\u7684\u6211\u4e5f\u4e0d\u4f1a\u5199\u4e86QWQ~~",
        "postTime": 1538789081,
        "uid": 106960,
        "name": "\u5b51\u601d",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3763 \u3010[TJOI2017]DNA\u3011"
    },
    {
        "content": "\u5929\u6d25\u4eca\u5e74\u7684\u7701\u9009\u9898\u5f88\u6709\u8d28\u91cf\u554a\uff0c\u6d4b\u8bd5\u6570\u636e\u4e5f\u975e\u5e38\u597d\uff0c\u4e0d\u50cf\u5f80\u5e74\u5199\u5199\u66b4\u529b\u5c31\u80fd\u8fc7\u4e0d\u5c11\uff0c\u4e8e\u662f \u4eca\u5e74\u5c31\u5dee\u70b9\u72060\u4e86 \u00a0 ORZ\n\n\u4e00\u9053\u540e\u7f00\u6570\u7ec4\u52a0\u66b4\u529b\u7684\u9898 \u671f\u671b\u590d\u6742\u5ea6\u5728nlogn+n\u5427\u00a0 \u53ef\u80fd\u4f1a\u7b97\u9519\uff0c\u4e0d\u592a\u4f1a\u7b97(\u3002\u30fb\u2200\u30fb)\u30ce\u5e0c\u671b\u6307\u6b63\n\n\u6211\u81ea\u5df1\u5728bzoj\u4e0a\u4f3c\u4e4e\u88ab\u5361\u5e38\u4e86\uff0c\u56e0\u4e3a\u7528\u7684\u662f\u4f55\u7426\u7684sa??\u9ed1\u4eba\u95ee\u53f7\uff0c\u7701\u9009\u7684\u65f6\u5019lzh&&leoly\u5b66\u957f\u5f53\u573a\u5199\u8fc7\uff0c\u770b\u4e86\u770b\u4ed6\u7684\u7a0b\u5e8f\u4f3c\u4e4e\u662f\u7528\u4e86\u574a\u95f4\u4f20\u8bf4\u7684da\u7b97\u6cd5\u3002\u6211\u4eec\u7701\u9009\u662f\u5f00o2\u4f18\u5316\u7684\uff0c\u4e8e\u662f\u5728\u6d1b\u8c37\u4e0a \u5927\u725b\u6a21\u5f0f\uff08\u6709o2\u4f18\u5316\uff09 \u6211\u5c31\u4ea4\u8fc7\u4e86\n\nleoly\u7528\u7684\u662fsam\u8dd1\u7684\u8d3c\u5feb\uff0c\u7136\u800c\u6211\u4e0d\u592a\u4f1a\u5199\uff0c\u770b\u4e86\u770b\u5927\u5bb6\u7684\u63d0\u4ea4\u8bb0\u5f55\u6709\u5b57\u7b26\u4e32hash \u7684\u636e\u8bf4\u4e5f\u662f\u5341\u5206\u7384\u5b66\uff0c\u4e0d\u662f\u5f88\u61c2\n\n\u7a0b\u5e8f\u633a\u957f\u7684 \u5927\u6982\u56e0\u4e3a\u6211\u4e00\u5f00\u59cb\u603b\u662f\u8fc7\u4e0d\u53bb\u52a0\u7684\u8c03\u8bd5\u592a\u591a \u524d\u9762rmq+sa\u6c42lcp\u53ef\u4ee5\u770b\u4e0b\u6211\u4e4b\u524d\u7684\u6587\u7ae0\n\nSA\uff1ahttp://www.elijahqi.win/2017/07/12/poj-2774/\n\nRMQ\uff1ahttp://www.elijahqi.win/2017/07/13/%e3%80%90luogu2880%e3%80%91usaco07jan%e5%b9%b3%e8%a1%a1%e7%9a%84%e9%98%b5%e5%ae%b9balanced-lineup/\n\nSA+RMQ\u6c42lcp:\n\nhttp://www.elijahqi.win/2017/07/15/ural1297/\n\n\u00a0\n\u5927\u6982\u8bf4\u4e00\u4e0b\u66b4\u529b\u90e8\u5206\u5982\u4f55\u53bb\u6c42\uff0c\u7531\u4e8e\u8bf4\u6211\u4eec\u53ef\u4ee5nlogn\u6c42lcp\u7136\u540eo1\u7684\u65f6\u95f4\u67e5\u8be2\n\n\u6211\u4eec\u679a\u4e3e\u539f\u4e32\u7684\u6bcf\u4e00\u4e2a\u5b57\u7b26\u4f5c\u4e3a\u8d77\u70b9\uff0c\u5982\u679c\u76f8\u540c\u5c31\u7528lcp\u6c42\uff0c\u4e0d\u76f8\u540c\u5c31\u7ed9\u8bb0\u5f55\u4e0d\u76f8\u540c\u7684\u8ba1\u6570\u5668++\n\n\u4fdd\u8bc1\u4e0d\u76f8\u540c\u7684\u8ba1\u6570\u5668\u4e0d\u8d85\u8fc73 \u5982\u679c\u57283\u4ee5\u5185\u6211\u4eec\u5c31\u7edf\u8ba1\u7b54\u6848\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#define N 220000\nint T,n,n1,m,count[N],tmp[N],rank[N<<1],rank1[N],sa[N],height[N],k,fmin1[N][18];\nchar a[N];\ninline void swap(int &a,int &b){\n    int t=a;a=b;b=t;\n}\ninline int min(int x,int y){\n    return x<y?x:y;\n}\ninline int lcp(int l,int r){\n    int a=rank[l],b=rank[r];\n    if (a>b) swap(a,b);a++;\n    int k=0;k=(int)log2(b-a+1);//while ((1<<(k+1))<=(b-a+1))++k;\n    return min(fmin1[a][k],fmin1[b-(1<<k)+1][k]);\n}\nint main(){\n    //freopen(\"3763.in\",\"r\",stdin);\n//    freopen(\"3763.out\",\"w\",stdout);\n    scanf(\"%d\",&T);\n    while (T--){\n    /*    char ch=getchar();n1=0;\n        while (ch<'A'||ch>'Z') ch=getchar();\n        while (ch<='Z'&&ch>='A') {\n            a[++n1]=ch;ch=getchar();    \n        }*/\n        scanf(\"%s\",a+1);n1=strlen(a+1);\n        a[++n1]='#';\n        scanf(\"%s\",a+n1+1);\n        n=strlen(a+1); \n    /*    n=n1;\n        while (ch<'A'||ch>'Z') ch=getchar();\n        while (ch<='Z'&&ch>='A') {\n            a[++n]=ch;ch=getchar();    \n        }\n        n=strlen(a+1);*/\n        //n1=n-n1;\n        m=5;\n        //printf(\"%d \",n1);\n    //    for (int i=1;i<=n;++i) printf(\"%c\",a[i]);\n        for (int i=1;i<=255;++i) count[i]=0;\n        memset(rank,0,sizeof(rank));\n        for (int i=1;i<=n;++i) count[a[i]]=1;\n        for (int i=1;i<=255;++i) count[i]+=count[i-1];\n        for (int i=1;i<=n;++i) rank[i]=count[a[i]];\n        \n        k=0;\n        for (int p=1;k!=n;p<<=1,m=k){\n            for (int i=1;i<=m;++i) count[i]=0;\n            for (int i=1;i<=n;++i) count[rank[i+p]]++;\n            for (int i=1;i<=m;++i) count[i]+=count[i-1];\n            for (int i=n;i>=1;--i) tmp[count[rank[i+p]]--]=i;\n            for (int i=1;i<=m;++i) count[i]=0;\n            for (int i=1;i<=n;++i) count[rank[i]]++;\n            for (int i=1;i<=m;++i) count[i]+=count[i-1];\n            for (int i=n;i>=1;--i) sa[count[rank[tmp[i]]]--]=tmp[i];\n            memcpy(rank1,rank,sizeof(rank)>>1);\n            rank[sa[1]]=k=1;\n            for (int i=2;i<=n;++i){\n                if (rank1[sa[i-1]]!=rank1[sa[i]]||rank1[sa[i-1]+p]!=rank1[sa[i]+p])++k;\n                rank[sa[i]]=k;\n            }\n        }\n    /*    for (int i=1;i<=n;++i){\n            for (int j=sa[i];j<=n;++j) printf(\"%c\",a[j]);printf(\"\\n\");\n        }*/\n        k=0;\n        for (int i=1;i<=n;++i){\n            if (rank[i]==0){\n                height[1]=0;continue;\n            }\n            k=k==0?0:k-1;\n            while (a[i+k]==a[sa[rank[i]-1]+k])++k; \n            height[rank[i]]=k;\n        }\n        //for (int i=1;i<=n;++i) printf(\"%d \",height[i]);\n    //    memset(fmin1,0x7f,sizeof(fmin1));\n        for (int i=1;i<=n;++i) fmin1[i][0]=height[i];\n        for (int j=1;(1<<j)<=n;++j){\n            for (int i=1;i+(1<<j)-1<=n;++i){\n                fmin1[i][j]=min(fmin1[i][j-1],fmin1[i+(1<<(j-1))][j-1]);\n                //printf(\"%d \",fmin[i][j]);\n            }\n        //    printf(\"\\n\");\n        }\n    /*    int d=n1;int ans=0;\n        for (int i=1;i<=n;++i){\n            if (height[i]>=n1-3){\n                if ((sa[i]/d)^(sa[i-1]/d)) ans++;\n            }\n        }*/\n        int na=n1,nb=n-n1,ans=0;\n        for (int i=1;i<=na-nb;i++){\n            int tot=0;\n            for (int j=1;j<=nb&&tot<=3;)\n                if (a[i+j-1]!=a[na+j]) {\n                    tot++,j++;if (tot>3) break;\n                }\n                else j+=lcp(i+j-1,na+j);\n            if (tot<=3) ans++;\n        //    if (tot>3) continue;\n        }\n        printf(\"%d\\n\",ans);\n    }\n    return 0;\n}\n```\n\u00a0",
        "postTime": 1500624828,
        "uid": 5037,
        "name": "elijahqi",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3763 \u3010[TJOI2017]DNA\u3011"
    },
    {
        "content": "\u597d\u50cf\u7528SAM\u5199\u7684\u5f88\u5c11\u8bf6\u2026\u2026\n\n\u5176\u5b9e\u6211\u4e00\u5f00\u59cb\u4e5f\u6ca1\u60f3\u5230\u8981\u7528SAM\u7684\u2026\u2026\u4e3b\u8981\u662f\u6ca1\u6709\u60f3\u5230\u627e\u7684\u65f6\u5019\u53ef\u4ee5dfs\u2026\u2026\n\n\u9996\u5148\u5efa\u4e00\u4e2aSAM\uff0c\u7136\u540e\u8dd1\u4e00\u904ddfs\uff0c\u679a\u4e3e\u4e00\u4e0b\u4e0b\u4e00\u4f4d\uff0c\u5982\u679c\u76f8\u540c\u76f4\u63a5\u7ee7\u7eed\uff0c\u5426\u5219\u5c31\u82b1\u8d39\u4e00\u6b21\u6b21\u6570\u6765\u6539\u53d8\u5b83\uff0c\u4fdd\u8bc1\u6539\u53d8\u6b21\u6570\u5c0f\u4e8e\u7b49\u4e8e3\u5c31\u884c\u4e86\n```\n// luogu-judger-enable-o2\n//minamoto\n#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\nconst int N=1e6+5;\nint cnt[N<<1],fa[N<<1],ch[N<<1][4],l[N<<1],last,tot;\nchar s[N];int c[N],a[N],ans,m,val[N];\nvoid ins(int c){\n    int p=last,np=++tot;last=np,l[np]=l[p]+1,cnt[np]=1;\n    for(;p&&!ch[p][c];p=fa[p]) ch[p][c]=np;\n    if(!p) fa[np]=1;\n    else{\n        int q=ch[p][c];\n        if(l[q]==l[p]+1) fa[np]=q;\n        else{\n            int nq=++tot;l[nq]=l[p]+1;\n            memcpy(ch[nq],ch[q],sizeof(ch[q]));\n            fa[nq]=fa[q],fa[q]=fa[np]=nq;\n            for(;ch[p][c]==q;p=fa[p]) ch[p][c]=nq;\n        }\n    }\n}\ninline void calc(){\n    memset(c,0,sizeof(c));\n    for(int i=1;i<=tot;++i) ++c[l[i]];\n    for(int i=1;i<=tot;++i) c[i]+=c[i-1];\n    for(int i=1;i<=tot;++i) a[c[l[i]]--]=i;\n    for(int i=tot,p;i;--i)\n    p=a[i],cnt[fa[p]]+=cnt[p];\n}\nvoid dfs(int p,int len,int j){\n    if(len>m) return (void)(ans+=cnt[p]);\n    for(int i=0;i<4;++i){\n        if(!ch[p][i]) continue;\n//\t\tval[s[len]]==i?dfs(ch[p][i],len+1,j):j<3?dfs(ch[p][i],len+1,j+1):(void)(1);\n        if(val[s[len]]==i) dfs(ch[p][i],len+1,j);\n        else if(j<3) dfs(ch[p][i],len+1,j+1);\n    }\n}\nint main(){\n//\tfreopen(\"testdata.in\",\"r\",stdin);\n    val['T']=0,val['A']=1,val['C']=2,val['G']=3;\n    int T;scanf(\"%d\",&T);\n    while(T--){\n        memset(ch,0,sizeof(ch)),memset(cnt,0,sizeof(cnt));\n        last=tot=1,ans=0;\n        scanf(\"%s\",s+1);int len=strlen(s+1);\n        for(int i=1;i<=len;++i) ins(val[s[i]]);\n        calc();\n        scanf(\"%s\",s+1),m=strlen(s+1);\n        dfs(1,1,0);printf(\"%d\\n\",ans);\n    }\n    return 0;\n}\n```",
        "postTime": 1536844678,
        "uid": 41781,
        "name": "bztMinamoto",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3763 \u3010[TJOI2017]DNA\u3011"
    },
    {
        "content": "[\u9898\u76ee](https://www.luogu.com.cn/problem/P3763)\n\n\u5bf9\u4e8e\u4e00\u4e2a\u4e0d\u4f1a$SAM$\uff0c\u4e0d\u60f3\u63a8$FFT$\u5f0f\u5b50\u7684\u849f\u84bb\u6765\u8bf4\uff0c\u540e\u7f00\u6811\u7ec4\u662f\u6700\u540e\u7684\u9009\u62e9\uff01\uff01\uff01\n\n\u4ece\u6700\u66b4\u529b\u7684\u5f00\u59cb\u8003\u8651\uff0c\u679a\u4e3e$S_0$\u7684\u5f00\u5934\uff0c\u7136\u540e\u548c$S$\u4e00\u4f4d\u4e00\u4f4d\u5339\u914d\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(n^2)$\u3002\n\n\u4f46\u8fd9\u4e2a\u66b4\u529b\u5176\u5b9e\u662f\u633a\u4f18\u79c0\u7684\uff0c\u4e3a\u4ec0\u4e48\u5462\uff1f\u56e0\u4e3a\u6211\u4eec\u4e00\u4f4d\u4e00\u4f4d\u5339\u914d\uff0c\u53ea\u8981\u627e\u5230$4$\u4e2a\u4e0d\u540c\u7684\uff0c\u90a3\u4e48\u5f53\u524d\u8fd9\u4e2a\u5f00\u5934\u80af\u5b9a\u5c31\u4e0d\u80fd\u6ee1\u8db3\uff0c\u8fd9\u662f\u6700\u4f18\u7684\u60c5\u51b5\u3002\u90a3\u6700\u52a3\u7684\u60c5\u51b5\u5462\uff1f\u5c31\u662f\u524d\u9762\u4e00\u5927\u5806\u90fd\u662f\u76f8\u540c\u7684\uff0c\u4e0d\u76f8\u540c\u7684\u90fd\u6392\u5728\u540e\u9762\u3002\n\n\u4ece\u8fd9\u4e2a\u89d2\u5ea6\u8fdb\u884c\u4f18\u5316\uff0c\u5982\u679c\u6211\u4eec\u80fd\u77e5\u9053\u5f53\u524d\u5f00\u5934\u7684\u5b57\u7b26\u4e32\u548c$S$\u516c\u5171\u7684\u524d\u7f00\uff0c\u90a3\u5c31\u53ef\u4ee5\u76f4\u63a5\u8df3\u5230\u524d\u7f00\u7684\u4e0b\u4e00\u4f4d\u8fdb\u884c\u6bd4\u8f83\u8fa3\uff01\u5982\u679c\u5f53\u524d\u4f4d\u4e0d\u76f8\u540c\uff0c\u8ba1\u6570\u5668\u52a0\u52a0\uff0c\u5982\u679c\u76f8\u540c\u5c31\u76f4\u63a5\u8df3\u5230$LCP$\u7684\u4e0b\u4e00\u4f4d\u3002\n\n\u770b\u5230\u524d\u7f00\uff0c\u5c31\u60f3\u5230\u7684\u540e\u7f00\u6811\u7ec4\u4e2d\u7684$height$\u8fa3\uff01\u4f46\u662f$S_0$\u548c$S$\u4e0d\u5728\u4e00\u4e2a\u5b57\u7b26\u4e32\u4e2d\uff1f\u90a3\u5c31\u628a$S$\u63d2\u5230$S_0$\u540e\u9762\u53bb\u5c31\u597d\u8fa3\u3002$S_0$\u5728\u6700\u540e\u9762\uff0c\u516c\u5171\u524d\u7f00\u6700\u591a\u4e5f\u5c31\u662f$len$\u3002\n\n\u8ba1\u7b97\u51fa$height$\u540e\uff0c\u9884\u5904\u7406$ST$\u8868.\n\n\u8c8c\u4f3c\u5b57\u7b26\u96c6\u53ea\u6709$\\{'A','C',T','G'\\}$\uff08\u5927\u96fe\n\n\u672c\u6765\u4e0d\u60f3\u5f00$O_2$\uff0c\u4f46\u4e00\u76f4\u88ab\u5361\u4e24\u4e2a\u70b9\uff0c\u8fd8\u4e0d\u65ad\u53d8\u5316\uff0c\u6211\u592a\u96be\u4e86QWQ\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <string>\nusing namespace std;\nconst int N=1e5+10,M=2e5+10;\nchar s1[N],s2[N];\nint s[M],SA[M],rk[M],tmp[M],height[M],cnt[M],f[M][20],log2[M],pow[20];\nint turn[30];\nint len,size;\ninline void binsort()\n{\n\tfor(register int i=0;i<=size;++i) cnt[i]=0;\n\tfor(register int i=1;i<=len;++i) cnt[rk[i]]++;\n\tfor(register int i=1;i<=size;++i) cnt[i]+=cnt[i-1];\n\tfor(register int i=len;i>=1;--i) SA[cnt[rk[tmp[i]]]--]=tmp[i];\n}\ninline void get_SA()\n{\n\tsize=4;\n\tfor(register int i=1;i<=len;++i)\n\t\trk[i]=s[i],tmp[i]=i;\n\tbinsort();\n\tfor(register int l=1;l<=len;l<<=1)\n\t{\n\t\tint p=0;\n\t\tfor(register int i=len-l+1;i<=len;++i)\n\t\t\ttmp[++p]=i;\n\t\tfor(register int i=1;i<=len;++i)\n\t\t\tif(SA[i]>l) tmp[++p]=SA[i]-l;\n\t\tbinsort(),swap(rk,tmp);\n\t\trk[SA[1]]=p=1;\n\t\tfor(register int i=2;i<=len;++i)\n\t\t\trk[SA[i]]=(tmp[SA[i]]==tmp[SA[i-1]]&&tmp[SA[i]+l]==tmp[SA[i-1]+l])?p:++p;\n\t\tif(p==len) break; size=p;\n\t}\n}\ninline void get_height()\n{\n\tint pre=1;\n\tfor(register int i=1;i<=len;++i)\n\t{\n\t\tif(pre) pre--;\n\t\twhile(s[i+pre]==s[SA[rk[i]-1]+pre]) pre++;\n\t\theight[rk[i]]=pre;\n\t}\n\tfor(register int i=1;i<=len;++i)\n\t\tf[i][0]=height[i];\n\tfor(register int l=1;l<=log2[len];++l)\n\t\tfor(register int i=1;i<=len-pow[l]+1;++i)\n\t\t\tf[i][l]=min(f[i][l-1],f[i+pow[l-1]][l-1]);\n}\ninline int query(int l,int r)\n{\n\tint k=log2[r-l+1];\n\treturn min(f[l][k],f[r-pow[k]+1][k]);\n}\nint main()\n{\n\tint T;\n\tscanf(\"%d\",&T);\n\tlog2[1]=0,pow[0]=1;\n\tfor(register int i=2;i<=2e5;++i)\n\t\tlog2[i]=log2[i>>1]+1;\n\tfor(register int i=1;i<=18;i++)\n\t\tpow[i]=pow[i-1]<<1;\n\tturn[0]=1,turn[2]=2,turn[6]=3,turn[19]=4;\n\twhile(T--)\n\t{\n\t\tint len1,len2,ans=0;\n\t\tscanf(\"%s\",s1+1),len1=strlen(s1+1);\n\t\tscanf(\"%s\",s2+1),len2=strlen(s2+1);\n\t\tlen=len1+len2;\n\t\tfor(register int i=1;i<=len;++i)\n\t\t{\n\t\t\tif(i<=len1) s[i]=turn[s1[i]-'A'];\n\t\t\telse s[i]=turn[s2[i-len1]-'A'];\n\t\t}\n\t\tget_SA(),get_height();\n\t\tfor(register int i=1;i<=len1-len2+1;++i)\n\t\t{\n\t\t\tint p=i,q=len1+1,tot=0;\n\t\t\twhile(p<=len1&&q<=len&&tot<=3)\n\t\t\t{\n\t\t\t\tif(s[p]!=s[q]) tot++,p++,q++;\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tint a=rk[p],b=rk[q],lcp;\n\t\t\t\t\tif(a>b) swap(a,b);\n\t\t\t\t\tlcp=query(a+1,b);\n\t\t\t\t\tp+=lcp,q+=lcp;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(p<=len1+1&&q==len+1&&tot<=3) ans++;\n\t\t}\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1587377488,
        "uid": 81238,
        "name": "MCAdam",
        "ccfLevel": 7,
        "title": "P3763 [TJOI2017]DNA"
    },
    {
        "content": "\u9274\u4e8e\u81ea\u5df1\u505a\u9898\u65f6\u7684\u50bb\u5b50\u64cd\u4f5c\uff0c\u5411\u5927\u5bb6\u63d0\u4f9b\u53ef\u80fd\u66f4\u6613\u61c2\u7684\u54c8\u5e0c+\u4e8c\u5206\u7b97\u6cd5\n\n\n------------\n\n### \u4e8c\u5206\u51fa\u6765\u7684\u662f**LCP\u957f\u5ea6$+1$\uff0c**\n\n### \u5373\u6bcf\u4e00\u6b21\u4e8c\u5206\u51fa\u6765\u7684**\u6700\u540e\u4e00\u4e2a\u70b9\u90fd\u662f\u5931\u914d\u7684**\uff0c\n\n\u800c\u5c31\u7b97\u5931\u914d\u4e5f\u4f1a\u8df3\u8fc7\u8fd9\u4e2a\u70b9\uff1b\n\n\u6240\u4ee5\u5f53$k<=3$\uff08$k$\u662f\u4e8c\u5206\u6b21\u6570\uff09\u4e14\u6a21\u5f0f\u4e32$s2$\u7684\u6307\u9488$>len2$\u65f6\uff0c\u5373\u8df3\u8fc7\u4e86$<=3$\u4e2a\u70b9\u4e14\u6307\u9488$\\geq len2+1$\u65f6\uff0c\u90fd\u662f\u53ef\u884c\u7684\uff1b\u5f53$k==4$\u4e14\u6a21\u5f0f\u4e32$s2$\u7684\u6307\u9488$\\geq len2+2$\u65f6\uff0c\u5373\u8df3\u8fc7\u4e86$<=4$\u4e2a\u70b9\u7684\u4f4d\u7f6e$\\geq len2+2$\u65f6\uff0c\u662f\u53ef\u884c\u7684\u3002\u6ce8\u610f\u5230\u662f$len2+2$\uff0c\u539f\u56e0\u662f\u591a\u5931\u914d\u4e86\u4e00\u4e2a\u56db\u53f7\u70b9\u3002\n\n\u4e0d\u61c2\u770b\u56fe\uff1a![](https://cdn.luogu.com.cn/upload/pic/60597.png)\n\n![](https://cdn.luogu.com.cn/upload/pic/60598.png)\n\u6240\u4ee5\u6307\u9488\u81f3\u5c11\u5927$2$\n\n\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n#include<cctype>\n#include<cstdlib>\n#include<vector>\n#include<queue>\n#include<map>\n#include<set>\n#define ll unsigned long long\n#define R register int\nusing namespace std;\nnamespace Fread {\n    //static char B[1<<15],*S=B,*D=B;\n    //#define getchar() (S==D&&(D=(S=B)+fread(B,1,1<<15,stdin),S==D)?EOF:*S++)\n    inline int g() {\n        R ret=0,fix=1; register char ch; while(!isdigit(ch=getchar())) fix=ch=='-'?-1:fix;\n        do ret=ret*10+(ch^48); while(isdigit(ch=getchar())); return ret*fix;\n    }\n}using Fread::g;\nconst int N=100010,B=131;\nll h1[N],h2[N],p[N]; int n,l1,l2,t;\nchar s1[N],s2[N];\ninline ll H1(int l,int r) {return h1[r]-h1[l-1]*p[r-l+1];}\ninline ll H2(int l,int r) {return h2[r]-h2[l-1]*p[r-l+1];}\ninline int ck(int x) {\n    R i=x,j=1; R l=0,r=l2+1;\n    for(R k=1;k<=4;++k) {\n        while(l<r) { R md=l+r>>1; \n            if(H1(i,i+md-1)==H2(j,j+md-1)) l=md+1; else r=md;\n        } i+=l,j+=l;\n        l=0,r=l2-j+2;\n        if(k==4) {if(j-2>=l2) return 1;}\n        else if(j-1>=l2) return 1; \n    } return 0;\n}\nsigned main() {\n#ifdef JACK\n    freopen(\"NOIPAK++.in\",\"r\",stdin);\n#endif\n    p[0]=1; for(R i=1;i<=N-10;++i) p[i]=p[i-1]*B;\n    t=g(); while(t--) { R ans=0;\n        scanf(\"%s%s\",s1+1,s2+1); l1=strlen(s1+1),l2=strlen(s2+1);\n        if(l1<l2) {printf(\"0\\n\"); continue;}\n        for(R i=1;i<=l1;++i) h1[i]=h1[i-1]*B+s1[i];\n        for(R i=1;i<=l2;++i) h2[i]=h2[i-1]*B+s2[i];\n        for(R i=1;i<=l1-l2+1;++i) ans+=ck(i); printf(\"%d\\n\",ans);\n    }\n}\n\n```\n\n",
        "postTime": 1560184996,
        "uid": 115086,
        "name": "Tari",
        "ccfLevel": 7,
        "title": "Jack's \u9898\u89e3 P3763 \u3010[TJOI2017]DNA\u3011"
    },
    {
        "content": "\u548ccodeforce528d\u4e00\u6837\uff0c\u7528FFT\u8fdb\u884c\u5b57\u7b26\u4e32\u5339\u914d\n\n\u628a\u4e24\u4e2a\u4e32\u4e2d\u7684\u4e00\u4e2a\u7ffb\u8f6c\uff0c\u5377\u79ef\u7684\u7ed3\u679c\u5c31\u662f\u5728\u6587\u672c\u4e32\u6bcf\u4e00\u4f4d\u7f6e\u5339\u914d\u7684\u7ed3\u679c\n\nACTG\u5206\u5f00\u7b97\uff0c\u4ee5A\u4e3a\u4f8b\uff0c\u8ba9\u4e00\u4e2a\u4e32\u4e2d\u6709A\u7684\u4f4d\u7f6e\u4e3a1\uff0c\u65e0A\u7684\u4f4d\u7f6e\u4e3a0\uff0c\u53e6\u4e00\u4e2a\u4e32\u76f8\u53cd\u3002\u8fd9\u6837\u4e24\u4e32\u5b57\u7b26\u4e0d\u540c\u5904\u4f1a\u4e3a\u7ed3\u679c\u7684\u503c\u8d21\u732e1 \u3002<=3\u7684\u7ed3\u679c\u4e2a\u6570\u548c\u4e3a\u7b54\u6848\n\n\u3002\u3002\u7ecf\u8fc7\u4e00\u6ce2\u52aa\u529b\u7684\u5361\u5e38\uff0c\u4ee57000+ms\u901a\u8fc7\u4e86\u8fd9\u9898\n```\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef complex<double> Com;\nconst int N=400005;\nconst double Pi=acos(-1);\nconst char Ch[4]={'A','C','G','T'};\nint R[N],L=1;\nvoid DFT(Com *A,int d) {\n  for (int i=0;i<L;++i) if (i<R[i]) swap(A[i],A[R[i]]);\n  for (int i=1;i<L;i<<=1) {\n    Com Wn(cos(Pi/i),d*sin(Pi/i));\n    for (int j=0;j<L;j+=(i<<1)) {\n      Com W(1,0);\n      for (int k=0;k<i;++k,W*=Wn) {\n        Com T=W*A[i+j+k];\n        A[i+j+k]=A[j+k]-T;\n        A[j+k]+=T;\n      }\n    }\n  }\n  if (d==-1) for (int i=0;i<L;++i) A[i]/=L;\n}\nCom a[N],b[N];\nchar s1[N],s2[N];\nint cas,ans,l1,l2,s[N];\nint main() {\n  scanf(\"%d\",&cas);\n  while (cas--) {\n    scanf(\"%s%s\",s1,s2);\n    l1=strlen(s1); l2=strlen(s2); ans=0;\n    memset(s,0,sizeof s);\n    for (int i=0;i<(l2>>1);++i) swap(s2[i],s2[l2-i-1]);\n    while (L<l1+l2) L<<=1;\n    for (int i=0;i<L;++i) R[i]=((i&1) ? R[i^1]+(L>>1) : R[i>>1]>>1);\n    for (int cc=0;cc<4;++cc) {\n      memset(a,0,sizeof(Com)*L);\n      memset(b,0,sizeof(Com)*L);\n      for (int i=0;i<l1;++i) a[i]=(s1[i]!=Ch[cc]);\n      for (int i=0;i<l2;++i) b[i]=(s2[i]==Ch[cc]);\n      DFT(a,1),DFT(b,1);\n      for (int i=0;i<L;++i) a[i]=a[i]*b[i];\n      DFT(a,-1);\n      for (int i=l2-1;i<l1;++i) s[i]+=(int)(a[i].real()+0.5);\n    }\n    for (int i=l2-1;i<l1;++i) ans+=(s[i]<=3);\n    printf(\"%d\\n\",ans);\n  }\n}\n```",
        "postTime": 1530869061,
        "uid": 49920,
        "name": "\u8e72\u5728\u4e1b\u4e2d\u7b11",
        "ccfLevel": 0,
        "title": "[TJOI2017]DNA"
    },
    {
        "content": "\u5199\u4e00\u4e2a\u6bd4\u5927\u90e8\u5206\u505a\u6cd5\u8dd1\u5f97\u5feb\u7684\u54c8\u5e0c\uff08\u6700\u4f18\u89e3 rk3\uff09\u3002\n\n\u679a\u4e3e $S_0$ \u5b50\u4e32\u7684\u5f00\u5934\uff0c\u4e8c\u5206\u627e\u5931\u914d\u4f4d\u7f6e\uff0c\u5728\u5931\u914d\u4f4d\u7f6e\u540e\u4e8c\u5206\u627e\u4e0b\u4e00\u4e2a\u5931\u914d\u4f4d\u7f6e\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\n\n\u5982\u679c\u7b2c $4$ \u4e2a\u5931\u914d\u4f4d\u7f6e\u5728\u5b50\u4e32\u5916\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5b50\u4e32\u7b26\u5408\u8981\u6c42\u3002\n\n\u8003\u8651\u5b57\u7b26\u96c6\u5927\u5c0f\u53ea\u6709 $4$\uff0c$\\text{base}$ \u53d6 $5$ \u5373\u53ef\u3002\n\n\u76f4\u63a5\u81ea\u7136\u6ea2\u51fa\u5565\u4e8b\u6ca1\u6709\u3002\n```cpp\n#include <stdio.h>\n#include <string.h>\nint T, n, m, l, q;\nchar a[100050], b[100050];\nunsigned p[100050], f[100050], g[100050];\nint main()\n{\n    p[0] = 1;\n    scanf(\"%d\", &T);\n    while (T--)\n    {\n        scanf(\"%s%s\", a + 1, b + 1);\n        n = strlen(a + 1);\n        m = strlen(b + 1);\n        for (int k = m; l < k; ++l, p[l] = p[l - 1] * 5)\n            ;\n        for (int i = 1; i <= n; ++i)\n        {\n            f[i] = f[i - 1] * 5;\n            switch (a[i])\n            {\n            case 'T':\n                f[i] += 1;\n                break;\n            case 'C':\n                f[i] += 2;\n                break;\n            case 'G':\n                f[i] += 3;\n                break;\n            }\n        }\n        for (int i = 1; i <= m; ++i)\n        {\n            g[i] = g[i - 1] * 5;\n            switch (b[i])\n            {\n            case 'T':\n                g[i] += 1;\n                break;\n            case 'C':\n                g[i] += 2;\n                break;\n            case 'G':\n                g[i] += 3;\n                break;\n            }\n        }\n        q = 0;\n        for (int i = 1; i + m - 1 <= n; ++i)\n            for (int j = 0, x = 0, l, r = 0; j < 4; ++j)\n            {\n                l = 0;\n                x += r + 1;\n                r = m - x + 1;\n                while (l <= r)\n                {\n                    int m = l + r >> 1;\n                    unsigned u = p[m];\n                    if (f[i + x + m - 2] - f[i + x - 2] * u == g[x + m - 1] - g[x - 1] * u)\n                        l = m + 1;\n                    else\n                        r = m - 1;\n                }\n                if (r == m - x + 1)\n                {\n                    ++q;\n                    break;\n                }\n            }\n        printf(\"%d\\n\", q);\n    }\n    return 0;\n}\n```\n",
        "postTime": 1670751792,
        "uid": 388651,
        "name": "5k_sync_closer",
        "ccfLevel": 7,
        "title": "P3763 [TJOI2017]DNA \u9898\u89e3"
    },
    {
        "content": "\u8003\u8651 $FFT$ \u3002        \n\n\u6211\u4eec\u770b\u8fd9\u5b57\u7b26\u96c6\u5927\u5c0f\u53ea\u6709 $4$ \uff0c\u6211\u4eec\u8003\u8651\u5355\u72ec\u64cd\u4f5c\u6bcf\u4e2a\u5b57\u7b26\u7136\u540e\u7d2f\u52a0\u7b54\u6848\u3002            \n\n\u679a\u4e3e\u56db\u4e2a\u5b57\u7b26 $C_1 , C_2 , C_3 , C_4$ \u3002        \n\n\u5982\u679c\u5f53\u524d\u5b57\u7b26\u662f\u679a\u4e3e\u5b57\u7b26\u8d4b\u503c\u6211\u4eec\u7684\u6bcf\u9879\u7cfb\u6570\u4e3a $1$ \uff0c\u5426\u5219\u4e3a $0$ \u3002 \u60f3\u8981\u8868\u8fbe\u5f53\u524d\u5b57\u7b26\u4e32\u662f\u5426\u5339\u914d\u5c31\u76f4\u63a5\u4e24\u9879\u76f8\u4e58\u5373\u53ef\uff0c\u6700\u540e\u628a\u6240\u6709\u60c5\u51b5\u7d2f\u52a0\u5728\u4e00\u8d77\u5c31\u53ef\u4ee5\u6c42\u5f97\u603b\u7684\u5339\u914d\u6570\u91cf\u3002           \n\n\u4ee4 $P(k)$ \u4e3a\u4ee5 $k$ \u7ed3\u5c3e\u65f6\u7684\u4e00\u6bb5\u5339\u914d\u7684\u5339\u914d\u6570\u91cf\uff0cm \u4e3a A \u6a21\u5f0f\u4e32\u957f\u5ea6\uff0cn \u4e3a B \u6587\u672c\u4e32\u957f\u5ea6\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u5f0f\u5b50\uff1a\n\n$P(k) = \\sum_{i = 0} ^ m A(i) \\times B(k - m + i + 1)$         \n\n\u4f60\u770b\u8fd9 $A_i$ \u5c31\u5f88\u4e0d\u987a\u773c\uff0c\u8001\u5957\u8def\u5012\u7f6e\u4e00\u4e0b\uff1a         \n\n$S(m - i - 1) = A(i)$         \n\n$P(k) = \\sum_{i = 0} ^ m S(m - i - 1) \\times B(k - m + i + 1)$     \n\n$P(k) = \\sum_{i + j == k} S(i) \\times B(j)$ \n\n\u81f3\u6b64\u6211\u4eec\u628a\u6211\u4eec\u7684\u6240\u6c42\u5199\u6210\u4e86\u5377\u79ef\u5f62\u5f0f\uff0c $FFT$ \u4e00\u4e0b\u540e\u770b\u4e00\u4e0b\u603b\u7684\u5339\u914d\u6570\u91cf\u52a0\u4e0a 3 \u540e\u53ef\u4e0d\u53ef\u4ee5\u5927\u4e8e\u7b49\u4e8e m \u5373\u53ef\u3002           \n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\nusing namespace std;\nconst int Len = 1e5 + 5;\nconst double Pi = acos(-1);\nint n,m;\nstruct CP\n{\n\tdouble x,y;\n\tCP(double xx = 0.0 , double yy = 0.0){x = xx , y = yy;}\n\tCP operator + (const CP &B) const\n\t{return CP(x + B.x , y + B.y);}\n\tCP operator - (const CP &B) const\n\t{return CP(x - B.x , y - B.y);}\n\tCP operator * (const CP &B) const\n\t{return CP(x * B.x - y * B.y , x * B.y + y * B.x);}\n\tCP operator / (const double &B) const\n\t{return CP(x / B , y / B);}\n\tinline void clear(){x = 0.0 , y = 0.0;} \n\t\n}f[Len << 1] , g[Len << 1] , P[Len << 1];\nint Ans[Len << 1];\nint Rd[Len << 1] , Lens = 1 , cnt = 0;\nchar s[Len] , ss[Len] , Chosen[6] = {'A' , 'T' , 'C' , 'G'};\nbool flag[35];\ninline void Init(char c)\n{\n\tfor(int i = 0 ; i < Lens ; i ++) f[i].clear() , g[i].clear();\n\tfor(int i = 0 ; i < m ; i ++) f[i].x = (ss[i] == c);\n\tfor(int i = 0 ; i < n ; i ++) g[i].x = (s[i] == c);\n\treverse(f , f + m);\n}\ninline void FFT(CP *f , int lens , bool flag)\n{\n\tfor(int i = 0 ; i < lens ; i ++) if(i < Rd[i]) swap(f[i] , f[Rd[i]]);\n\tfor(int p = 2 ; p <= lens ; p <<= 1)\n\t{\n\t\tint len = p >> 1;\n\t\tCP mul(cos(2 * Pi / p) , sin(2 * Pi / p));\n\t\tif(flag) mul.y *= -1;\n\t\tfor(int k = 0 ; k < lens ; k += p)\n\t\t{\n\t\t\tCP buf(1 , 0);\n\t\t\tfor(int l = k ; l < k + len ; l ++)\n\t\t\t{\n\t\t\t\tCP tt = buf * f[len + l];\n\t\t\t\tf[len + l] = f[l] - tt;\n\t\t\t\tf[l] = f[l] + tt;\n\t\t\t\tbuf = buf * mul;\n\t\t\t}\n\t\t}\n\t}\n\tif(flag) for(int i = 0 ; i < lens ; i ++) f[i] = f[i] / (1.0 * lens);\n}\nint main()\n{\n\tint t;scanf(\"%d\",&t);\n\twhile(t --)\n\t{\n\t\tscanf(\"%s\",s);scanf(\"%s\",ss);\n\t\tn = strlen(s) , m = strlen(ss);\n\t\tLens = 1 , cnt = 0;\n\t\twhile(Lens <= n + m) Lens <<= 1;\n\t\tfor(int i = 0 ; i < Lens ; i ++) Ans[i] = 0 , P[i].clear() , Rd[i] = (Rd[i >> 1] >> 1) | ((i & 1) ? Lens >> 1 : 0);\n\t\tfor(int i = 0 ; i < 4 ; i ++)\n\t\t{\n\t\t\tInit(Chosen[i]);\n\t\t\tFFT(f , Lens , 0) , FFT(g , Lens , 0);\n\t\t\tfor(int i = 0 ; i < Lens ; i ++) P[i] = f[i] * g[i];\n\t\t\tFFT(P , Lens , 1);\n\t\t\tfor(int i = m - 1 ; i < Lens ; i ++) Ans[i] += (int)(P[i].x + 0.5); \n\t\t} \n\t\tint ans = 0;\n\t\tfor(int i = m - 1 ; i < n ; i ++) \n\t\t\tif(Ans[i] + 3 >= m) ans ++;\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1615471683,
        "uid": 132533,
        "name": "Hakuoro",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 [TJOI2017]DNA"
    },
    {
        "content": "\u597d\u50cf\u7528$SAM$\u505a\u7684\u90fd\u662f$dfs$\u554a\n\n~~\u5176\u5b9e\u8fd9\u91cc\u4e5f\u662f\u641c\u7d22~~\n\n\u5982\u679c\u7528$SAM$\u6765\u505a\u975e\u5e38\u597d\u7406\u89e3\uff0c\u5c31\u662f\u4ece$SAM$\u4e0a\u5339\u914d\u8fd9\u4e2a\u5b57\u7b26\u4e32\uff0c\u5141\u8bb8\u6709\u4e0d\u8d85\u8fc7\u4e09\u6761\u8f6c\u79fb\u8fb9\u4e0d\u4e00\u6837\n\n\u4e8e\u662f$dfs$\u505a\u6cd5\u975e\u5e38\u663e\u7136\u4e86\uff0c\u5c31\u662f\u7206\u641c\u8fd9\u4e09\u6761\u4e0d\u4e00\u6837\u7684\u8f6c\u79fb\u8fb9\u5728\u54ea\u91cc\uff0c\u4f46\u662f\u590d\u6742\u5ea6\u770b\u8d77\u6765\u597d\u50cf\u5f88\u8ff7\uff0c\u53ef\u80fd\u662f$\\binom{n}{3}$\u4e5f\u5c31\u662f$O(n^3)$\u7ea7\u522b\n\n\u4f46\u662f\u7531\u4e8e\u5f88\u591a\u60c5\u51b5\u4e0b\u9009\u62e9\u67d0\u4e00\u6761\u8f6c\u79fb\u751a\u81f3\u90fd\u65e0\u6cd5\u5728$SAM$\u4e0a\u6709\u4e00\u4e2a\u957f\u5ea6\u4e3a$n$\u7684\u5339\u914d\uff0c\u6240\u4ee5$dfs$\u975e\u5e38\u7684\u5feb\n\n\u8fd9\u91cc\u5199\u7684\u662f\u4e00\u4e2a$bfs$\uff0c\u4f46\u662f\u957f\u5f97\u548c$dp$\u6709\u70b9\u50cf\uff1f\n\n\u8bbe$f[i][j][k]$\u8868\u793a\u5728$SAM$\u4e0a\u8dd1\u4e86$i$\u4f4d\u8dd1\u5230\u4e86$j$\u8fd9\u4e2a\u8282\u70b9\uff0c$k$\u6b21\u4e2a\u4f4d\u7f6e\u4e0d\u4e00\u6837\u662f\u5426\u53ef\u884c\uff0c\u663e\u7136\u7684\u8f6c\u79fb\u5c31\u662f\u679a\u4e3e\u4e0b\u4e00\u4e2a\u662f\u8d70$A,C,G,T$\n\n\u53d1\u73b0\u8fd9\u4e2a\u6570\u7ec4\u53ef\u4ee5\u6eda\u52a8\uff0c\u4e4b\u540e\u5c31\u6eda\u52a8\u597d\u4e86\n\n\u6eda\u52a8\u7684\u540c\u65f6\u8fd8\u9700\u8981\u6eda\u52a8\u4e24\u4e2a\u6808\uff0c\u7528\u6765\u5b58\u50a8\u6709\u7528\u7684\u72b6\u6001\uff0c\u5176\u5b9e\u5c31\u662f\u5e7f\u641c\u91cc\u7684\u961f\u5217\u4e86\n\n\u8fd8\u6709\u4e00\u4e2a\u5c0f\u526a\u679d\uff0c\u6211\u4eec\u63d0\u524d\u5904\u7406\u51fa\u6bcf\u4e00\u4e2a\u8282\u70b9\u5f80\u4e0b\u8dd1\u51fa\u6765\u7684\u6700\u957f\u8def\uff0c\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u8fd9\u4e2a\u5feb\u901f\u5224\u65ad\u51fa\u4e00\u4e2a\u72b6\u6001\u662f\u5426\u53ef\u884c\n\n\u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#define maxn 200005\n#define re register\n#define LL long long\n#define max(a,b) ((a)>(b)?(a):(b))\nint Test,lst,cnt,num,n,top[2],tot,o;\nstruct St {int a,b;} st[2][maxn];\nstruct E{int v,nxt;} e[maxn<<1];\nchar S[maxn>>1],T[maxn>>1];\nint son[maxn][4],fa[maxn],sz[maxn],len[maxn],head[maxn],mx[maxn],q[maxn],r[maxn],f[maxn][4];\ninline void add(int x,int y) {e[++num].v=y;e[num].nxt=head[x];head[x]=num;}\nvoid dfs(int x) {for(re int i=head[x];i;i=e[i].nxt) dfs(e[i].v),sz[x]+=sz[e[i].v];}\ninline int solve(char c) {if(c=='A') return 0;if(c=='C') return 1;if(c=='G') return 2;return 3;}\ninline void ins(int c)\n{\n\tint f=lst,p=++cnt; lst=p;\n\tlen[p]=len[f]+1,sz[p]=1;\n\twhile(f&&!son[f][c]) son[f][c]=p,f=fa[f];\n\tif(!f) {fa[p]=1;return;}\n\tint x=son[f][c];\n\tif(len[f]+1==len[x]) {fa[p]=x;return;}\n\tint y=++cnt;\n\tlen[y]=len[f]+1,fa[y]=fa[x],fa[x]=fa[p]=y;\n\tfor(re int i=0;i<4;i++) son[y][i]=son[x][i];\n\twhile(f&&son[f][c]==x) son[f][c]=y,f=fa[f];\n}\nint main()\n{\n\tscanf(\"%d\",&Test);\n\twhile(Test--)\n\t{\n\t\tscanf(\"%s\",S+1);scanf(\"%s\",T+1);\n\t\tfor(re int i=1;i<=cnt;i++) \n\t\t\tr[i]=head[i]=mx[i]=len[i]=fa[i]=sz[i]=son[i][0]=son[i][1]=son[i][2]=son[i][3]=0;\n\t\ttop[0]=top[1]=0;\n\t\tlst=cnt=1,num=0;\n\t\tn=strlen(S+1);\n\t\tfor(re int i=1;i<=n;i++) S[i]=solve(S[i]),ins(S[i]);\n\t\tfor(re int i=2;i<=cnt;i++) add(fa[i],i); dfs(1);\n\t\tnum=tot=o=0; \n\t\tfor(re int i=1;i<=cnt;i++) head[i]=0;\n\t\tfor(re int i=1;i<=cnt;i++)\n\t\t\tfor(re int j=0;j<4;j++) if(son[i][j]) add(son[i][j],i),r[i]++;\n\t\tfor(re int i=1;i<=cnt;i++) if(!r[i]) q[++tot]=i;\n\t\tfor(re int i=1;i<=tot;i++)\n\t\t\tfor(re int j=head[q[i]];j;j=e[j].nxt) \n\t\t\t{r[e[j].v]--; mx[e[j].v]=max(mx[e[j].v],mx[q[i]]+1);if(!r[e[j].v]) q[++tot]=e[j].v;}\n\t\tn=strlen(T+1);\n\t\tfor(re int i=1;i<=n;i++) T[i]=solve(T[i]);\n\t\tmemset(f,0,sizeof(f));\n\t\tst[0][++top[0]]=(St){1,0};\n\t\tfor(re int i=1;i<=n;i++,o^=1)\n\t\t{\n\t\t\tfor(re int j=1;j<=top[o];j++)\n\t\t\t\tf[st[o][j].a][st[o][j].b]=0;\n\t\t\ttop[o^1]=0;\n\t\t\tfor(re int j=1;j<=top[o];j++)\n\t\t\t{\n\t\t\t\tint x=st[o][j].a,y=st[o][j].b;\n\t\t\t\tfor(re int k=0;k<4;k++) \n\t\t\t\tif(son[x][k]&&k!=T[i]&&y<3) \n\t\t\t\t{\n\t\t\t\t\tif(mx[son[x][k]]+i<n) continue;\n\t\t\t\t\tif(!f[son[x][k]][y+1]) st[o^1][++top[o^1]]=(St){son[x][k],y+1},f[son[x][k]][y+1]=1;\n\t\t\t\t}\n\t\t\t\tint k=T[i];\n\t\t\t\tif(!son[x][k]||mx[son[x][k]]+i<n) continue;\n\t\t\t\tif(!f[son[x][k]][y]) st[o^1][++top[o^1]]=(St){son[x][k],y},f[son[x][k]][y]=1;\n\t\t\t}\n\t\t}\n\t\tint ans=0;\n\t\tfor(re int i=2;i<=cnt;i++) if(f[i][0]||f[i][1]||f[i][2]||f[i][3]) ans+=sz[i];\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1547444914,
        "uid": 35178,
        "name": "asuldb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3763 \u3010[TJOI2017]DNA\u3011"
    },
    {
        "content": "- \u9898\u76ee\u94fe\u63a5\uff1a\n\n   https://www.luogu.org/problemnew/show/P3763\n\n- \u601d\u8def\uff1a\n\n   \u9996\u5148\u6211\u4eec\u8981\u7528\u5230Rabin-Karp\u54c8\u5e0c\uff0c\u5176\u5b9e\u5c31\u662f\u8fd9\u4e2a:\n   \n    - \u82e5$w_{str}$=($a_0$ $p^{n-1}$+$a_1$ $p^{n-2}$+...+$a_{n-1}$ $p^0$) \n \n      \u6240\u4ee5$w_{pre_{i-1}}$ $=($ $a_0$ $p^{i-1}$+$a_1$ $p^{i-2}$+...+$a_{i-1}$ $p^0$) \n   \n      $w_{pre_{j}}$ $=($ $a_0$ $p^{j}$+$a_1$ $p^{j-1}$+...+$a_{j}$ $p^0$) \n \n      \u6240\u4ee5 $w_{str_{i,j}}$ \n   \n       $=($ $a_i$ $p^{j-i}$+$a_{i+1}$ $p^{j-i-1}$+...+$a_{j}$ $p^0$)\n   \n       $=$ $w_{pre_{j}}$ $-$ $w_{pre_{i-1}}$ $p^{j-i+1}$\n    \n      \u6ce8\u610f\u4e86\uff0c\u6211\u8fd9\u91cc\u5e76\u6ca1\u6709\u53d6\u6a21\uff0c\u800c\u662f\u76f4\u63a5\u76f4\u63a5\u7528unsigned long long \u81ea\u7136\u6ea2\u51fa\uff0c\u8fd9\u6837\u66f4\u5feb\n    \n  \u7136\u800c\uff0c\u4e00\u822c\u4eba\u90fd\u662f\u7528\u4e8c\u5206\u786e\u5b9a\u53f3\u7aef\u70b9\uff0c\u6211\u81ea\u5df1\u6478\u7d22\u51fa\u4e86\u4e00\u4e2a\u9a9a\u64cd\u4f5c\uff08\u597d\u50cf\u53c8\u5728\u54ea\u91cc\u542c\u8fc7\uff09----\u7528**\u500d\u589e**\u3002\n  \n  \u56e0\u4e3a\u5728\u8fd9\u9053\u9898\u4e2d\u6211\u89c9\u5f97\u4e8c\u5206\u7684\u4e0a\u4e0b\u754c\u53ef\u80fd\u76f8\u5dee\u6bd4\u8f83\u5927\uff0c\u867d\u7136\u7406\u8bba\u4e0a\u4e8c\u5206\u5e73\u5747\u60c5\u51b5\u4e0b\u66f4\u597d\uff0c\u4f46\u5728\u8fd9\u9053\u9898\u4e2d\u5b9e\u9645\u6d4b\u51fa\u6765\u7528\u500d\u589e\u66f4\u5feb\uff08\u5982\u679c\u4e4b\u540e\u6709\u4eba\u7528\u4e8c\u5206\u8dd1\u5f97\u8fd8\u6bd4\u6211\u5feb\u5c31\u65e0\u89c6\u6211\u8fd9\u53e5\u8bdd\uff09\u3002\n  \n  \u601d\u8def\u5c31\u662f\u8fd9\u6837\uff0c\u5176\u4ed6\u4e00\u4e9b\u7ec6\u8282\u5c31\u89c1\u4ee3\u7801\u5427.\n  \n- \u4ee3\u7801\uff1a\n\n```\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <algorithm>\n#include <iostream>\n#define ri int \nconst int maxn=100005;\ntypedef long long   ll;\ntypedef unsigned long long ull;\nchar a[maxn],b[maxn];\null q[maxn],aht[maxn],bht[maxn];\nint cnt=0,lena,lenb;\ninline void Hash(){\n    ll x=0;\n    for(ri i=0;a[i];i++){\n        x=x*131+a[i]-31;\n        aht[i]=x;\n    //\tcout<<x<<i<<endl;\n    }x=0;\n    for(ri i=0;b[i];i++){\n        x=x*131+b[i]-31;\n        bht[i]=x;\n    }x=0;\n    return ;\n}\ninline int solve(int x,int y){\n    int k=0,p=1;\n    x++,y++;\n  \twhile(p!=0){  \n        if((aht[x+k+p-1]-aht[x-1-1]*q[k+p+1])==(bht[y+k+p-1]-bht[y-1-1]*q[k+p+1]))k+=p,p*=2;\n        else p=p/2;//cout<<l<<'*'<<r<<'*'<<mid<<endl;\n        while(x+k+p>lena||y+k+p>lenb)p=p/2;\n    }\n    if(a[x-1]==b[y-1])k++;\n    return k;\n}\ninline bool ok(int i){\n      int la=0,k;\n      for(ri j=1;j<=3;j++){\n           k=solve(i,la);\n           i+=k+1,la+=k+1;\n           if(la>=lenb){return 1;}//cout<<i<<' '<<la<<endl;\n      }\n         k=solve(i,la); \n         i+=k;la+=k;\n      //   cout<<i<<' '<<la<<endl;\n         if(la>=lenb) return 1;\n         return 0;\n}\nint main()\n{\n    int t;\n    scanf(\"%d\",&t);\n    q[0]=1;\n    for(ri i=1;i<=100001;i++)\n        q[i]=(ull)q[i-1]*131;\n  //\u9884\u5904\u7406\u5e42\uff0c\u8fd9\u4e2a\u6280\u5de7\u6765\u81eahttps://www.cnblogs.com/sineagle/p/8490655.html\n    while(t--){\n       int cnt=0;\n       scanf(\"%s\",a);\n       scanf(\"%s\",b);\n       lena=strlen(a),lenb=strlen(b);\n       if(lena<lenb){printf(\"0\\n\");continue;}\n       Hash();\n       for(ri i=0;i<lena-lenb+1;i++){\n         if(ok(i))cnt++;\n       }\n       printf(\"%d\\n\",cnt);\n       memset(aht,0,sizeof(aht));\n       memset(bht,0,sizeof(bht));\n    }\n    return 0;\n}\n```\n- \u540e\u8bb0\uff1a\n\n  luogu\u4e0a\u6700\u5feb\u7684\u4e00\u6b21\u8dd1\u4e86240ms,\u7136\u800c\u8fd8\u662f\u6bd4\u4e0d\u8fc7BZOJ\u7684dalao",
        "postTime": 1524385527,
        "uid": 61382,
        "name": "Rye_Catcher",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3763 \u3010[TJOI2017]DNA\u3011"
    },
    {
        "content": "### \u5206\u6790\uff1a\n\u8bbe\u8ba1\u5339\u914d\u51fd\u6570\uff0c\u5e76\u4f7f\u7528 FFT \u8fdb\u884c\u8ba1\u7b97\u3002\n### \u5339\u914d\u51fd\u6570\uff1a\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u5bf9\u4e8e\u4f4d\u7f6e k \uff0c $S_{k...k+m-1}$ \u4e0e $T_{0,m-1}$ \u53ef\u4ee5\u5339\u914d\u7684\u4e2a\u6570\u4e3a $\\sum\\limits_{i=0}^{m-1}S_{i+k}T_i$  \uff0c\u4f46\u8fd9\u8fd8\u4e0d\u662f\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u65e0\u6cd5\u76f4\u63a5\u4f7f\u7528 FFT \u8fdb\u884c\u8ba1\u7b97\u3002\u5229\u7528 FFT \u4e00\u4e2a\u60ef\u7528\u7684 trick \uff0c\u5c06\u5b57\u7b26\u4e32 $T$ \u5012\u7f6e\uff0c\u5373\u4ea4\u6362 $T_i$ \u548c $T_{m-1-i}$ , \u8fd9\u65f6\u5f0f\u5b50\u53d8\u4e3a $\\sum\\limits_{i=0}^{m-1}S_{i+k}T_{m-1-i} \\iff \\sum\\limits_{i+j=m+k-1}S_iT_j$ \uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 FFT \u8fdb\u884c\u8ba1\u7b97\u3002\n### \u5177\u4f53\u5b9e\u73b0\uff1a\n\u8fdb\u884c\u56db\u8f6e FFT ,\u6bcf\u8f6e\u5bf9\u4e8e\u5b57\u7b26 $C_i$ \u5c06\u6240\u6709\u7b49\u4e8e $C_i$ \u7684\u4f4d\u7f6e\u8d4b\u503c\u4e3a 1 \uff0c\u5426\u5219\u8d4b\u503c\u4e3a 0 \u3002\n### Code:\uff08\u5e38\u6570\u8f83\u5927\uff09\n```cpp\n#include<bits/stdc++.h>\n#define N (int)(4e5+1)\n#define M 5001\n#define R register\n#define x first\n#define y second\n#define ll long long\n#define db double\n#define mp make_pair\n#define pb push_back\n#define lb(x) (x&-x)\n#define mod 998244353\n#define wt(x) write(x),puts(\"\")\n#define ot(x) write(x),putchar(' ')\n#define INF 0x7fffffff\n#define F(i,start,end) for(R int (i)=(start);(i)<=(end);i++)\n#define T(i,end,start) for(R int (i)=(start);(i)>=(end);i--)\nconst db pi=acos(-1.00);\nusing namespace std;\ntemplate<typename T> void read(T &x)\n{\n\tint f=1;\n\tx=0;\n\tchar c=getchar();\n\twhile(!isdigit(c))\n\t{\n\t\tif(c=='-')\n\t\t\tf=-1;\n\t\tc=getchar();\n\t}\n\twhile(isdigit(c))\n\t{\n\t\tx=(x<<3)+(x<<1)+c-'0';\n\t\tc=getchar();\n\t}\n\tx*=f;\n\treturn;\n}\nvoid write(R int x)\n{\n\tif(x<0)\n\t{\n\t\tx=~x+1;\n\t\tputchar('-');\n \t}\n\tif(x>9)\n\t\twrite(x/10);\n\tputchar(x%10+'0');\n\treturn;\n}\nint t,n,m,bit,lim,tot,inv[N],ans[N];\nchar s1[N],s2[N];\nchar c[]={'A','T','C','G'};\nstruct complex_\n{\n\tdb real,y;\n\tcomplex_ (db real_=0,db y_=0)\n\t{\n\t\treal=real_;\n\t\ty=y_;\n\t\treturn;\n\t}\n}a[N],b[N];\ncomplex_ operator + (complex_ a,complex_ b)\n{\n\treturn complex_(a.real+b.real,a.y+b.y);\n}\ncomplex_ operator - (complex_ a,complex_ b)\n{\n\treturn complex_(a.real-b.real,a.y-b.y);\n}\ncomplex_ operator * (complex_ a,complex_ b)\n{\n\treturn complex_(a.real*b.real-a.y*b.y,a.real*b.y+a.y*b.real);\n}\nvoid fft(complex_ *a,int f)\n{\n\tF(i,0,lim-1)\n\t\tif(i<inv[i])\n\t\t\tswap(a[i],a[inv[i]]);\n\tfor(int mid=1;mid<lim;mid<<=1)\n\t{\n\t\tcomplex_ wn(cos(pi/mid),sin(pi/mid)*f);\n\t\tfor(int size=mid<<1,j=0;j<lim;j+=size)\n\t\t{\n\t\t\tcomplex_ w(1,0);\n\t\t\tfor(int k=0;k<mid;k++,w=w*wn)\n\t\t\t{\n\t\t\t\tcomplex_ a0=a[j+k],a1=w*a[j+k+mid];\n\t\t\t\ta[j+k]=a0+a1;\n\t\t\t\ta[j+k+mid]=a0-a1;\n\t\t\t}\n\t\t}\n\t}\n\tif(f==-1)\t\n\t\tF(i,0,lim-1)\n\t\t\ta[i].real=a[i].real/lim;\n\treturn;\n}\nvoid solve()\n{\n\tscanf(\"%s%s\",&s1,&s2);\n\ttot=0;\n\tn=strlen(s1),m=strlen(s2);\n\tfor(bit=0,lim=1;lim<=n+m;lim<<=1,bit++);\n\tF(i,0,lim)\n\t\tinv[i]=(inv[i>>1]>>1)|((i&1)<<bit-1),ans[i]=0;\n\tF(i,0,3)\n\t{\n \t\tF(j,0,n-1)\n\t\t\ta[j]=(complex_){s1[j]==c[i],0};\n\t\tF(j,0,m-1)\n\t\t\tb[m-j-1]=(complex_){s2[j]==c[i],0};\n\t\tfft(a,1),fft(b,1);\n\t\tF(j,0,lim)\n\t\t\ta[j]=a[j]*b[j];\n\t\tfft(a,-1);\n\t\tF(j,m-1,n-1)\n\t\t\tans[j-m+1]+=((int)(a[j].real+0.5));\n\t\tF(j,0,lim-1)\n\t\t\ta[j]=b[j]=(complex_)(0,0);\n\t}\n\tF(i,0,n-m)\n\t\tif(ans[i]+3>=m)\n\t\t\ttot++;\n\twt(tot);\n\treturn;\n}\nint main()\n{\n\tread(t);\n\twhile(t--)\n\t\tsolve();\n\treturn 0;\n}\n```\n",
        "postTime": 1627384419,
        "uid": 219402,
        "name": "FANTASTlC",
        "ccfLevel": 0,
        "title": "\u9898\u89e3P3763"
    }
]
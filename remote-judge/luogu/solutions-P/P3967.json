[
    {
        "content": "# \u9898\u89e3\n\u9898\u610f\u5f88\u660e\u786e  \n### \u7b2c\u4e00\u95ee\n$\\quad \\ \\ $\u6c42\u5e26\u6743\u4e8c\u5206\u56fe\u7684\u6700\u4f73\u5b8c\u7f8e\u5339\u914d\uff0c\u7136\u800c\u5e76\u4e0d\u4f1a\u5199\u5e26\u6743\u5339\u914d\u256e(\u256f\u25bd\u2570)\u256d\uff0c\u4e8e\u662f\u5199\u4e86\u6700\u5927\u8d39\u7528\u6700\u5927\u6d41\u3002   \n\u5efa\u56fe\uff1a$\\ \\ \\ \\ $\u8d85\u7ea7\u6e90 $\\ \\ \\ \\ \\ \\to \\ \\ \\ \\ \\ $ \u7537\u751f$(i)$ $\\qquad\\ $\u5bb9\u91cf\u4e3a1\uff0c\u8d39\u7528\u4e3a0  \n$\\ \\ \\ \\ $ $\\qquad\\ $\u7537\u751f$(i)$ $ \\ \\ \\ \\ \\to\\  $ \u5973\u751f$(j+n)\\ $\u5bb9\u91cf\u4e3a1\uff0c\u8d39\u7528\u4e3a\u5e78\u798f\u503c  \n$\\quad\\ \\ \\ \\ $\u5973\u751f$(j+n)$$$\\ \\ \\ \\to\\ \\ \\ \\ \\ $\u8d85\u7ea7\u6c47$\\qquad\\ \\ \\ \\ $\u5bb9\u91cf\u4e3a1\uff0c\u8d39\u7528\u4e3a0\n### \u7b2c\u4e8c\u95ee\n$\\quad \\ \\ $\u6c42\u51fa\u6240\u6709\u5b8c\u7f8e\u5339\u914d\u4e2d\u90fd\u6709\u7684\u8fb9  \n$\\quad \\ \\ $\u901a\u8fc7\u7b2c\u4e00\u95ee\uff0c\u6211\u4eec\u77e5\u9053\u4e86\u4e00\u4e2a\u5b8c\u7f8e\u5339\u914d\u7684\u65b9\u6848\uff0c\u4ee5\u53ca\u5b8c\u7f8e\u5339\u914d\u4e0b\u7684\u6700\u5927\u5e78\u798f\u503c\u3002  \n$\\quad \\ \\ $\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u8fd9\u4e2a\u5b8c\u7f8e\u5339\u914d\u4e2d\u7684\u6bcf\u4e00\u6761\u8fb9\uff0c\u5c06\u5b83\u5220\u6389\uff0c\u518d\u6b21\u8dd1\u5b8c\u7f8e\u5339\u914d\uff0c\u5982\u679c\u8fd9\u6b21\u7684\u6700\u5927\u8d39\u7528\u6bd4\u6ca1\u6709\u5220\u6389\u5b83\u4e4b\u524d\u7684\u7b54\u6848\u5c0f\u4e86\uff0c\u90a3\u4e48\u8bf4\u660e\u8fd9\u6761\u8fb9\u4e00\u5b9a\u5728\u5b8c\u7f8e\u5339\u914d\u4e2d   \n**\u6ce8\uff1a\u5982\u679c\u5199\u8d39\u7528\u6d41\u7684\u8bdd\uff0c\u5220\u8fb9\u65f6\u8bb0\u7684\u5c06\u8fd9\u6761\u8fb9\u5bf9\u5e94\u7684\u53cd\u5411\u8fb9\u4e00\u8d77\u5220\u6389\uff0c\u4e0d\u7136\u7684\u8bdd\u4f60\u5927\u6982\u4f1a\u6b7b\u5faa\u73af\u3002\u3002\u3002**\n# \u4ee3\u7801\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<queue>\nusing namespace std;\n#define N 500\n\nint n,S,T;\nbool in[N][N];\nbool check[N*N];\n\ninline int read() {\n\tint tmp=0,w=1;\n\tchar ch=0;\n\twhile(!isdigit(ch)) {if(ch=='-') w=-1;ch=getchar();}\n\twhile(isdigit(ch)) tmp=(tmp<<1)+(tmp<<3)+ch-'0',ch=getchar();\n\treturn tmp*w;\n}\n\nstruct node {\n\tint u,v,c,f,nex;\n}e[N*N],ee[N*N];\nint tot=1,h[N],use[N];\nvoid add(int u,int v,int c,int f) {\n\te[++tot].u=u,e[tot].v=v,e[tot].c=c,e[tot].f= f,e[tot].nex=h[u],h[u]=tot;\n\te[++tot].u=v,e[tot].v=u,e[tot].c=0,e[tot].f=-f,e[tot].nex=h[v],h[v]=tot;\n}\n\nint dis[N];\nbool vis[N];\nbool donot[N*N];\ndeque<int>q;\nbool spfa() {\n\tfor(int i=S;i<=T;++i) dis[i]=-1e9,vis[i]=0;\n\tq.push_back(T);\n\tdis[T]=0;\n\tint x,xx;\n\twhile(!q.empty()) {\n\t\tx=q.front();\n\t\tq.pop_front();\n\t\tvis[x]=0;\n\t\tfor(int i=h[x];i;i=e[i].nex) {\n\t\t\txx=e[i].v;\n\t\t\tif(donot[i]) continue;\n\t\t\tif(e[i^1].c&&dis[xx]<dis[x]-e[i].f) {\n\t\t\t\tdis[xx]=dis[x]-e[i].f;\n\t\t\t\tif(!vis[xx]) {\n\t\t\t\t\tvis[xx]=1;\n\t\t\t\t\tif(q.empty()||dis[xx]<dis[q.front()]) q.push_back(xx);\n\t\t\t\t\telse q.push_front(xx);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn dis[S]>-1e9;\n}\nbool mark[N];\nint dfs(int x,int want) {\n\tmark[x]=1;\n\tif(x==T||!want) return want;\n\tint f=0,get=0,xx=0;\n\tfor(int i=use[x];i;i=e[i].nex) {\n\t\tif(donot[i]) continue;\n\t\txx=e[i].v;\n\t\tif(e[i].c&&!mark[xx]&&dis[xx]==dis[x]-e[i].f) {\n\t\t\tf=dfs(xx,min(want,e[i].c));\n\t\t\tif(!f) continue;\n\t\t\te[i].c-=f;\n\t\t\te[i^1].c+=f;\n\t\t\tget+=f;\n\t\t\twant-=f;\n\t\t\tuse[x]=i;\n\t\t\tif(!want) break;\n\t\t}\n\t}\n\treturn get;\n}\n\nint mfmc() {\n\tint res=0;\n\twhile(spfa()) {\n\t\tmark[T]=1;\n\t\twhile(mark[T]) {\n\t\t\tfor(int i=S;i<=T;++i) use[i]=h[i],mark[i]=0;\n\t\t\tres+=dis[S]*dfs(S,1e9);\n\t\t}\n\t}\n\treturn res;\n}\n\nint main()\n{\n\tscanf(\"%d\",&n);\n\tS=0,T=n+n+1;\n\tint x;\n\tfor(int i=1;i<=n;++i) {\n\t\tfor(int j=1;j<=n;++j) {\n\t\t\tx=read();\n\t\t\tadd(i,j+n,1,x);\n\t\t} \n\t}\n\tint cut=tot;\n\tfor(int i=1;i<=n;++i) add(S,i,1,0),add(i+n,T,1,0);\n\tmemcpy(ee,e,sizeof(e));\n\tint ans=mfmc();\n\tfor(int i=2;i<=cut;i+=2) if(!e[i].c) check[i]=1;\n\tprintf(\"%d\\n\",ans);\n\tfor(int i=2;i<=cut;i+=2) {\n\t\tif(check[i]) {\n\t\t\tdonot[i]=1,donot[i^1]=1;\n\t\t\tmemcpy(e,ee,sizeof(ee));\t\n\t\t\tx=mfmc();\n\t\t\tif(x<ans) in[e[i].u][e[i].v]=1;\n\t\t\tdonot[i]=0,donot[i^1]=0;\n\t\t}\n\t}\n\tfor(int i=1;i<=n;++i) {\n\t\tfor(int j=1;j<=n;++j) {\n\t\t\tif(in[i][j+n]) printf(\"%d %d\\n\",i,j);\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1520169108,
        "uid": 36728,
        "name": "\u96e8\u5b63",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3967 \u3010[TJOI2014]\u5339\u914d\u3011"
    },
    {
        "content": "KM \u677f\u9898\uff0c\n\n\u5177\u4f53\u5c31\u662f\u7528\u5308\u7259\u5229\u7b97\u6cd5\u627e\u589e\u5e7f\u8def\uff0c\u7136\u540e\u5339\u914d\u3002\u7531\u4e8e\u9898\u76ee\u4fdd\u8bc1\u4e00\u5b9a\u6709\u5b8c\u7f8e\u5339\u914d\uff0c\u56fa\u53ea\u8981\u53bb\u5339\u914d\u5373\u53ef\u3002\n\n\u4e0e\u4f20\u7edf\u6df1\u641c\u4e0d\u4e00\u6837\uff0c\u8fd9\u91cc\u6211\u4eec\u7528\u5e7f\u641c\u3002\n\n\u6211\u4eec\u6309 $x$ \u4e00\u4e2a\u5143\u7d20\u4e00\u4e2a\u5143\u7d20\u53bb\u5339\u914d\u3002\u6bcf\u6b21\u5339\u914d\u6e05\u7a7a $vis$ \u6570\u7ec4\uff08\u8bb0\u5f55\u4e00\u4e2a $y$ \u6709\u6ca1\u6709\u88ab\u5339\u914d\u8fc7\uff09\u3002\n\n\u6839\u636e\u67d0\u5b9a\u7406\uff0c\u5f53\u4e00\u4e2a\u5339\u914d\u4e24\u70b9\u7684\u9876\u6807\u4e4b\u548c\u4e0e\u4e24\u70b9\u7684\u4ef7\u503c\u4e00\u81f4\uff0c\u5c31\u80fd\u540e\u6700\u5927\u5339\u914d\uff0c\u56fa\u6211\u4eec\u6bcf\u6b21\u8d2a\u5fc3\u627e\u5dee\u503c\u6700\u5c0f\u7684\u70b9\u4e0e\u53d8\u5c0f\u7684\u70b9\u8bb0\u5f55\u4e0b\u6765\u3002\u5bf9\u4e8e\u4e00\u4e2a $y$ \u4e0e\u8be5 $x$ \u5339\u914d\u503c\u53d8\u5c0f\uff0c\u6211\u4eec\u5c31\u66f4\u6539\u5339\u914d\u3002\u5bf9\u4e8e\u6700\u5c0f\u503c\u6211\u4eec\u6bcf\u6b21\u66f4\u6539\u9876\u6807\uff0c\u4f7f\u5176\u4e0e\u4e24\u70b9\u4ef7\u503c\u66f4\u63a5\u8fd1\uff0c\u53ef\u4ee5\u8bc1\u660e\uff0c\u5982\u679c\u6709\u6700\u5927\u5339\u914d\uff0c\u8fd9\u6837\u603b\u80fd\u5f97\u5230\u89e3\u3002\n\n\u628a\u4e24\u4e24\u52a0\u548c\u5f97\u5230\u7b54\u6848\u8f93\u51fa\u5373\u53ef\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e8c\u95ee\uff0c\u5c06\u8fb9\u6309\u7167 $x$ \u6392\u5e8f\uff0c~~\u6700\u5f00\u59cb\u56e0\u4e3a\u8fd9\u4e2a\u9519\u4e86\u597d\u591a\u6b21~~\u3002\n\n\u6bcf\u6b21\u5bf9\u4e8e\u4e00\u5bf9\u5339\u914d\u5224\u65ad\u662f\u4e0d\u662f\u5fc5\u8981\u7684\u3002\n\n\u4e00\u5bf9\u5339\u914d\u662f\u5fc5\u8981\u7684 $\\iff$ \u628a\u8fd9\u5bf9\u5339\u914d\u5220\u9664\u540e\uff0c\u6700\u5927\u5339\u914d\u4f1a\u53d8\u5c0f\u3002\n\n\u6211\u4eec\u53ea\u8981\u66b4\u529b\u5220\u9664\u6bcf\u4e00\u5bf9\u5339\u914d\uff0c\u5224\u65ad\u662f\u5426\u53d8\u5c0f\u5373\u53ef\uff0c\u53d8\u5c0f\u5c31\u8f93\u51fa\n\n\u6bcf\u6b21 KM \u590d\u6742\u5ea6 $n^3$ ,\u5171\u8fdb\u884c$n$\u6b21\u56fa\u603b\u590d\u6742\u5ea6 $n^4$ \u3002\n\n\n------------\n\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n//static char buf[1000000],*p1=buf,*p2=buf;\n//#define getchar() p1==p2&&(p2=(p1=buf)+fread(buf,1,1000000,stdin),p1==p2)?EOF:*p1++\n#define re register\nconst int maxn=505;\ninline int read()\n{\n\tchar ch=getchar();bool f=0;int x=0;\n\tfor(;!isdigit(ch);ch=getchar())if(ch=='-')f=1;\n\tfor(;isdigit(ch);ch=getchar())x=(x<<1)+(x<<3)+(ch^48);\n\tif(f==1)x=-x;return x;\n}\nvoid print(int x)\n{\n    if(x<0) putchar('-'),x=-x;\n    if(x>9) print(x/10);\n    putchar(x%10+'0');\n}\nint n,m,vis[maxn],dx[maxn],dy[maxn],Min[maxn],num,mat[maxn],pre[maxn],d[maxn][maxn],ans;\nvoid match(int x)\n{\n\tint y=0,num,id;\n\tmemset(pre,0,sizeof pre);mat[y]=x;memset(Min,0x3f,sizeof Min);\n\twhile(1)\n\t{\n\t\tx=mat[y];vis[y]=1;num=0x3f3f3f3f;\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tif(vis[i])continue;\n\t\t\tif(Min[i]>dx[x]+dy[i]-d[x][i])\n\t\t\t\tMin[i]=dx[x]+dy[i]-d[x][i],pre[i]=y;\n\t\t\tif(Min[i]<num)num=Min[i],id=i;\n\t\t}\n\t\tfor(int i=0;i<=n;i++)\n\t\t{\n\t\t\tif(vis[i])dx[mat[i]]-=num,dy[i]+=num;\n\t\t\telse Min[i]-=num;\n\t\t}y=id;if(mat[y]==-1)break;\n\t}\n\twhile(y)mat[y]=mat[pre[y]],y=pre[y];\n}\nint KM()\n{\n\tmemset(dx,0,sizeof dx),memset(dy,0,sizeof dy),memset(mat,-1,sizeof mat);\n\tfor(int i=1;i<=n;i++)\n\t\tmemset(vis,0,sizeof vis),match(i);\n\tint res=0;\n\tfor(int i=1;i<=n;i++)if(mat[i]!=-1)res=res+d[mat[i]][i];//,cout<<d[mat[i]][i]<<endl;\n\treturn res;\n}\nbool check(int x,int y)\n{\n\tint g=d[x][y];d[x][y]=-1e8;\n\tint res=KM();d[x][y]=g;\n\tif(res==ans)return false;\n\treturn true;\n}\nstruct node\n{\n\tint l,r;\n}q[maxn];\nbool cmp(node a,node b){return a.l<b.l;\n}\nsigned main()\n{\n\t//freopen(\".in\",\"r\",stdin);\n\t//freopen(\".out\",\"w\",stdout);\n\tn=read();//cout<<\"A\";\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=n;j++)\n\t\t\td[i][j]=read();\n\tans=KM();\n\tcout<<ans<<endl;\n\tfor(int i=1;i<=n;i++)q[i].l=mat[i],q[i].r=i;\n\tsort(q+1,q+n+1,cmp);\n\tfor(int i=1;i<=n;i++)if(check(q[i].l,q[i].r))cout<<q[i].l<<\" \"<<q[i].r<<endl;\n\treturn 0;\n}\n\n\n```\n\uff08\u672c\u4eba\u4ee3\u7801\u662f\u5b66\u7740\u5927\u4f6c\u5199\u7684\uff0c\u53ef\u80fd\u6709\u4e9b\u76f8\u4f3c\uff0c\u8bf7\u591a\u4f53\u8c05\uff09\n",
        "postTime": 1626740556,
        "uid": 343748,
        "name": "louhao088",
        "ccfLevel": 9,
        "title": "P3967 [TJOI2014]\u5339\u914d\u9898\u89e3"
    },
    {
        "content": "KM \u7b97\u6cd5\u662f\u4e00\u79cd\u7528\u6765\u6c42\u89e3\u5e26\u6743\u4e8c\u5206\u56fe\u5339\u914d\u7684\u7b97\u6cd5\u3002\n\n\u76f8\u8f83\u4e8e\u8d39\u7528\u6d41\uff0cKM \u4e00\u822c\u5728\u7a20\u5bc6\u56fe\u4e0a\u6709\u7740\u66f4\u5feb\u7684\u901f\u5ea6\uff0c\u5e76\u4e14\u66f4\u597d\u5199\u3002\n\n\u4f46\u662f\u5b83\u6709\u5f88\u5927\u7684\u5c40\u9650\u6027\uff1a\u4e8c\u5206\u56fe\u7684\u6700\u5927\u5339\u914d\u5fc5\u987b\u4e3a\u5b8c\u5907\u5339\u914d\u3002\n\n\u800c\u8fd9\u9898\u6b63\u597d\u6ee1\u8db3\u8fd9\u4e2a\u6761\u4ef6\uff0c\u4e3a\u4f55\u4e0d\u7528 KM \u5462\uff1f\n\n### \u601d\u8def\n\u5bf9\u4e8e\u7b2c\u4e00\u95ee\uff0c\u76f4\u63a5\u8dd1\u4e00\u904d KM \u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e8c\u95ee\uff0c\u6211\u4eec\u5206 n \u6b21\u66b4\u529b\u65ad\u6389\u5728\u7b2c\u4e00\u95ee\u4e2d\u627e\u5230\u7684\u5339\u914d\u8fb9\uff0c\u8dd1 n \u904d KM \uff0c\u82e5\u7ed3\u679c\u53d8\u5c0f\uff0c\u90a3\u4e48\u8fd9\u6761\u65ad\u6389\u7684\u8fb9\u4e00\u5b9a\u5fc5\u987b\u9009\u3002\n\n\u7136\u540e\u5c31\u662f\u6ce8\u610f\u6392\u5e8f\uff0c\u8981\u6309\u539f\u5339\u914d\u8fb9\u7684\u987a\u5e8f\u8fdb\u884c\u6392\u5e8f\u3002\n\ndfs \u5199\u6cd5\u7684 KM \u7b97\u6cd5\u9762\u5bf9\u968f\u673a\u6570\u636e\u65f6\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^3)$ \uff0c\u9762\u5bf9\u7279\u6b8a\u6784\u9020\u7684\u6570\u636e\u662f $O(n^4)$\u3002\n\n\u597d\u5728\u8fd9\u9898\u6570\u636e\u4e0d~~\u6bd2\u7624~~\uff0cdfs \u5199\u6cd5\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u5e94\u8be5\u662f $O(n^4)$ \u5de6\u53f3\uff0c\u53ef\u4ee5\u8fc7\u3002\n\n```cpp\n//KM\u7b97\u6cd5\u57fa\u672c\u7684\u601d\u60f3\u662f\u6784\u9020\u51fa\u4e00\u4e2a\u5b58\u5728\u5b8c\u5907\u5339\u914d\u7684\u76f8\u7b49\u5b50\u56fe\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#define inf 1<<30//\u6700\u5927\u503c\nusing namespace std;\ninline int rd() {//\u5feb\u8bfb\n\tregister int x=0,f=1;\n\tregister char c=getchar();\n\twhile(c<'0'||c>'9') {\n\t\tif(c=='-')f=-1;\n\t\tc=getchar();\n\t}\n\twhile(c<='9'&&c>='0')\n\t\tx=(x<<3)+(x<<1)+c-48,c=getchar();\n\treturn x*f;\n}\nint n,w[105][105];//n\u548c\u8fb9\u6743\nint la[105],lb[105];//\u9876\u6807\nbool va[105],vb[105];//\u5de6\u53f3\u8bbf\u95ee\u6807\u8bb0\nint match[105];\nint delta,upd[105];\nstruct node {\n\tint x,y;\n}tmatch[105];\nbool cmp(const node &a,const node &b)\n{\n\treturn a.x<b.x;\n}\nbool dfs(int x) {//\u5308\u7259\u5229\u7b97\u6cd5\n\tva[x]=1;\n\tfor(int y=1; y<=n; y++)\n\t\tif(!vb[y])\n\t\t\tif(la[x]+lb[y]==w[x][y]) {\n\t\t\t\tvb[y]=1;\n\t\t\t\tif(!match[y]||dfs(match[y])) {\n\t\t\t\t\tmatch[y]=x;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else upd[y]=min(upd[y],la[x]+lb[y]-w[x][y]);\n\treturn false;\n}\nint KM() {//KM\u7b97\u6cd5\n\tmemset(match,0,sizeof(match));//\u521d\u59cb\u5316\n\tfor(int i=1; i<=n; i++) {\n\t\tla[i]=-inf;\n\t\tlb[i]=0;\n\t\tfor(int j=1; j<=n; j++)\n\t\t\tla[i]=max(la[i],w[i][j]);\n\t}\n\tfor(int i=1; i<=n; i++)//\u6784\u9020\u7b26\u5408\u6761\u4ef6\u7684\u76f8\u7b49\u5b50\u56fe\n\t\twhile(true) {\n\t\t\tmemset(va,0,sizeof(va));//\u6e05\u7a7a\u8bbf\u95ee\u6570\u7ec4\n\t\t\tmemset(vb,0,sizeof(vb));\n\t\t\tfor(int j=1; j<=n; j++)upd[j]=inf;\n\t\t\tif(dfs(i))break;\n\t\t\tdelta=1<<30;\n\t\t\tfor(int j=1; j<=n; j++)\n\t\t\t\tif(!vb[j])delta=min(delta,upd[j]);\n\t\t\tfor(int j=1; j<=n; j++) {//\u4fee\u6539\u9876\u6807\n\t\t\t\tif(va[j])la[j]-=delta;\n\t\t\t\tif(vb[j])lb[j]+=delta;\n\t\t\t}\n\t\t}\n\tint ans=0;\n\tfor(int i=1; i<=n; i++)//\u5f97\u5230\u7b54\u6848\n\t\tans+=w[match[i]][i];\n\treturn ans;\n}\nint main() {\n\tscanf(\"%d\",&n);\n\tfor(int i=1; i<=n; i++)\n\t\tfor(int j=1; j<=n; j++)\n\t\t\tscanf(\"%d\",&w[i][j]);\n    int tans=KM();\n\tprintf(\"%d\\n\",tans);\n    for(int i=1;i<=n;i++)\n    tmatch[i].x=match[i],tmatch[i].y=i;\n    sort(tmatch+1,tmatch+1+n,cmp);//\u6392\u5e8f\n\tfor(int i=1; i<=n; i++)\n        {\n            int t=w[tmatch[i].x][tmatch[i].y];\n            w[tmatch[i].x][tmatch[i].y]=-inf;\n            if(KM()<tans)printf(\"%d %d\\n\",tmatch[i].x,tmatch[i].y);\n            w[tmatch[i].x][tmatch[i].y]=t;\n        }\n\treturn 0;\n}\n```\n",
        "postTime": 1635906795,
        "uid": 482082,
        "name": "Mortis_Vampire",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P3967 [TJOI2014]\u5339\u914d"
    },
    {
        "content": "\u6211\u89c9\u5f97\u8d39\u7528\u6d41\u7684\u90a3\u7bc7\u9898\u89e3\u5df2\u7ecf\u628a\u9898\u610f\u8bf4\u6e05\u695a\u4e86\uff0c\u6240\u4ee5\u6211\u5c31\u7279\u6765\u8d21\u732e\u4e00\u4e0b\u4e8c\u5206\u56fe\u6700\u4f73\u5b8c\u7f8e\u5339\u914d\u7684KM\u5199\u6cd5\u3002  \n\n\u5177\u4f53\u7406\u8bba\u4e00\u4e9b\u7684\u4e1c\u897f\u4f60\u4eec\u53ef\u4ee5\u53bb\u770b\u6211\u5728$P4014$\u5199\u7684\u9898\u89e3\uff0c\u91cc\u9762\u8bf4\u7684\u6bd4\u8f83\u591a\u8fd9\u91cc\u5c31\u4e0d\u5728\u5199\u4e86\u3002\n\n\u8981\u7279\u522b\u6ce8\u610f\u7684\u662f\u867d\u7136\u6211\u7528\u7684\u662f$n^3$\u4f18\u5316\u8fc7\u7684KM\uff08\u6211\u90a3\u7bc7\u9898\u89e3\u91cc\u7528\u7684\u662f$n^4$\u7684\uff0c\u6211\u4f1a\u5728\u4ee3\u7801\u91cc\u7528\u6ce8\u91ca\u7b80\u5355\u8bf4\u4e00\u4e0b$n^3$\u4f18\u5316\uff0c\u5176\u5b9e\u5c31\u662f\u52a0\u4e86\u4e2a\u677e\u5f1b\u91cfslack\uff09\uff0c\u4f46\u8fd8\u662f\u5728\u52a0\u4e0a$n^2$\u679a\u4e3e\u5220\u8fb9\u540e\u534e\u4e3d\u4e3d\u5730TLE\u4e863\u4e2a\u70b9\u3002  \n\u6240\u4ee5\u9700\u8981\u5728\u679a\u4e3e\u65f6\u5224\u4e00\u4e0b\u8fd9\u6761\u8fb9\u6709\u6ca1\u6709\u53ef\u80fd\u6210\u4e3a\u7b54\u6848\uff08\u5177\u4f53\u770b\u4ee3\u7801\u5427\uff09\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<cstdlib>\n#include<string>\n#include<queue>\n#include<map>\n#include<vector>\n#include<ctime>\n\n#define ll long long\n#define R register\n#define IL inline\n#define Rf(a,b,c) for(R int (a)=(b);(a)<=(c);++(a))\n#define Tf(a,b,c) for(R int (a)=(b);(a)>=(c);--(a))\n#define MP make_pair\n#define PA pair<int,int>\n#define MES(a,b) memset((a),(b),sizeof((a)))\n#define MEC(a,b) memcpy((a),(b),sizeof((b)))\n#define D double\n\nusing namespace std;\n\nconst int N=105;\n\nint n,m,lx[N],ly[N],link[N],w[N][N],sl[N],sum,Ans,Link[N];\nbool S[N],T[N];\n\nIL int read() {\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch>'9'||ch<'0'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x*=10;x+=(ch-'0');ch=getchar();}\n\treturn x*f;\n}\nIL void write(int x) {\n    if(x<0) putchar('-'),x=-x;\n    if(x>9) write(x/10);\n    putchar(x%10+'0');\n}\n\nbool dfs(int x) {//\u4e8c\u5206\u56fe\u5339\u914d\u8fc7\u7a0b\n\tS[x]=true;\n\tRf(i,1,n) \n\t\tif(lx[x]+ly[i]==w[x][i]) {\n\t\t\tif(!T[i]) {\n\t\t\t\tT[i]=true;\n\t\t\t\tif(!link[i]||dfs(link[i])) {\n\t\t\t\t\tlink[i]=x;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {//\u7528\u4e0d\u80fd\u8fdb\u5165\u76f8\u7b49\u5b50\u56fe\u7684\u8fb9\u66f4\u65b0\u4e00\u4e0b\u677e\u5f1b\u91cfsl\n\t\t\tsl[i]=min(sl[i],lx[x]+ly[i]-w[x][i]);\n\t\t}\n\treturn false;\n}\n\nIL void update() {\n\tR int a=1e9;\n\tRf(j,1,n) if(!T[j]) //\u5728\u677e\u5f1b\u91cf\u4e2d\u627e\uff0c\u800c\u4e0d\u662f\u518dn^2\u679a\u4e3e\uff0c\u4f18\u5316\u5728\u6b64\n\t\ta=min(a,sl[j]); \n\tRf(i,1,n) {\n\t\tif(S[i]) lx[i]-=a;\n\t\tif(T[i]) ly[i]+=a;\n\t\tsl[i]-=a;\n\t}\n}\n\nIL void KM() {\n\tRf(i,1,n) {\n\t\tlink[i]=lx[i]=ly[i]=0;\n\t\tRf(j,1,n) lx[i]=max(lx[i],w[i][j]);\n\t}\n\tRf(i,1,n) while(true) {\n\t\tRf(j,1,n) {\n\t\t\tS[j]=T[j]=false;sl[j]=1e9;\n\t\t}\n\t\tif(dfs(i)) break;\n\t\telse update();\n\t}\n} \n\n\nsigned main()\n{\n\tn=read();\n\tRf(i,1,n) Rf(j,1,n) w[i][j]=read();\n\tKM();\n\tRf(i,1,n) sum+=lx[i]+ly[i];\n\twrite(sum);putchar('\\n');\n\tAns=sum;MEC(Link,link);//\u5148\u8bb0\u5f55\u4e00\u4e2a\u6700\u4f73\u5b8c\u7f8e\u5339\u914d\n\tRf(k,1,n) Rf(j,1,n) {//\u679a\u4e3e\u5220\u8fb9\n\t\tif(w[k][j]<w[Link[j]][j]) continue;\n   //\u5982\u679c\u8fd9\u6761\u8fb9\u6bd4j\u5728\u4e00\u4e2a\u6700\u4f73\u5b8c\u7f8e\u5339\u914d\u4e2d\u5339\u914d\u7684\u8fb9\u7684\u8fb9\u6743\u8981\u5c0f\uff0c\u90a3\u4e48\u8fd9\u6761\u8fb9\u4e00\u5b9a\u4e0d\u4f1a\u5728\u4efb\u610f\u4e00\u4e2a\u6700\u4f73\u5b8c\u7f8e\u5339\u914d\u4e2d\uff0c\u5c31\u6ca1\u5fc5\u8981\u5c1d\u8bd5\u5220\u5b83\u3002\n\t\tR int tmp=w[k][j];\n\t\tw[k][j]=-1e7;\n\t\tsum=0;\n\t\tKM();\n\t\tRf(i,1,n) sum+=lx[i]+ly[i];\n\t\tw[k][j]=tmp;\n\t\tif(sum!=Ans) {\n\t\t\tprintf(\"%d %d\\n\",k,j);\n\t\t}\n\t}\n\t\n\treturn 0;\n}\n```\n\u5566\u5566\u5566\uff0cKM\u8dd1\u5f97\u98de\u5feb",
        "postTime": 1520407505,
        "uid": 35700,
        "name": "Khassar",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3967 \u3010[TJOI2014]\u5339\u914d\u3011"
    },
    {
        "content": "### solution\uff1a\n\u5148\u8003\u8651\u7b2c\u4e00\u95ee\uff0c\u6c42\u6700\u5927\u5e78\u798f\u503c\uff0c\u663e\u7136\u662f\u4e8c\u5206\u56fe\u5e26\u6743\u6700\u5927\u5339\u6a21\u677f\u3002\u76f4\u63a5\u7528**KM**\u7b97\u6cd5\u3002\u90a3\u4e48\u5982\u4f55\u89e3\u51b3\u6700\u5927\u5339\u914d\u540e\u4e8c\u5206\u56fe\u7684\u4ea4\u96c6\u5462\uff1f\n\n1. \u9996\u5148\uff0c\u6211\u662f\u8fd9\u6837\u60f3\u7684\uff1a\u5982\u679c\u5b58\u5728\u591a\u4e2a\u6700\u5927\u4e8c\u5206\u56fe\u5e26\u6743\u5339\u914d\uff0c\u90a3\u4e48\u5bf9\u4e8e\u5904\u4e8e\u4ea4\u96c6\u4e2d\u7684\u7537\u670b\u53cb\u4ed6\u8fde\u5411\u5973\u670b\u53cb\u7684\u90a3\u4e00\u6761\u8fb9\u4e00\u5b9a\u662f\u72ec\u4e00\u65e0\u4e8c\u7684\uff0c\u4e0d\u7136\u4ed6\u5c31\u80fd\u591f\u9009\u62e9\u53e6\u4e00\u6761\u6743\u503c\u4e00\u6837\u7684\u8fb9\u8fde\u5411\u53e6\u4e00\u4e2a\u5973\u670b\u53cb\uff0c\u8fd9\u6837\u5c31\u4e0d\u5728\u4ea4\u96c6\u4e2d\u4e86\u3002\u663e\u7136\u8fd9\u4e2a\u60f3\u6cd5\u662f\u7247\u9762\u7684\uff0c\u4f46\u662f\u8ddf\u6b63\u89e3\u642d\u4e0a\u8fb9\u4e86\u3002\n2. \u5bf9\u4e8e\u4e00\u5bf9\u5728\u4ea4\u96c6\u4e2d\u7684\u7537\u5973\u670b\u53cb\uff0c\u867d\u7136\u6700\u5927\u5339\u914d\u6709\u591a\u4e2a\uff0c\u4f46\u8fd9\u4e00\u5bf9\u7537\u5973\u670b\u53cb\u662f\u4f1a\u53d8\u7684\uff0c\u8bf4\u660e\u8fd9\u4e00\u5bf9\u7537\u5973\u670b\u53cb\u5728\u5339\u914d\u4e2d\u59cb\u7ec8\u662f\u6700\u4f18\u89e3\uff0c\u90a3\u4e48\u5982\u679c\u628a\u8fd9\u4e00\u5bf9\u7537\u5973\u670b\u53cb\u7684\u8fb9\u6743\u503c\u6539\u4e3a0\uff0c\u90a3\u4e48\u6700\u5927\u5339\u914d\u7684\u6743\u503c\u548c\u4e00\u5b9a\u4f1a\u53d8\u3002\u5728\u770b\u6570\u636e\u8303\u56f4N<=80,N^4\u7684\u590d\u6742\u5ea6\u80fd\u591f\u63a5\u53d7\u3002\u6240\u4ee5\u6211\u4eec\u4fbf\u60f3\u5230\u5148KM\u4e00\u904d\u7b97\u51fa\u6700\u5927\u5339\u914d\u503c\uff0c\u518d\u5bf9\u6bcf\u4e00\u4e2a\u7537\u670b\u53cb\u8be2\u95ee\u4ed6\u8ddf\u54ea\u4e00\u4e2a\u5973\u670b\u53cb\u7275\u7ea2\u7ebf\uff0c\u5c06\u8fd9\u6761\u8fb9\u6743\u6539\u4e3a0\uff0c\uff08\u4e0d\u5fc5\u5bf9\u6bcf\u4e00\u6761\u8fb9\u90fd\u4fee\u6539\uff0c\u5e94\u4e3a\u90a3\u4e9b\u8fb9\u4e0d\u90fd\u662f\u6700\u4f18\u7684\u8fb9\uff09\uff0c\u770b\u6700\u540e\u7684\u6700\u5927\u5339\u914d\u503c\u662f\u5426\u53d8\u5c0f\uff0c\u82e5\u4e0d\u53d8\uff0c\u5219\u8fd9\u5bf9\u7537\u5973\u670b\u53cb\u4e0d\u5728\u4ea4\u96c6\u4e2d\uff0c\u53cd\u4e4b\uff0c\u5219\u5728\u3002\n3. ****\u7ec6\u8282\u6ce8\u610f****\uff1a \u89c1\u4ee3\u7801\u3002\n### code\uff1a\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define RN register int \ninline int read()\n{\n\tint k=1,x=0;\n\tchar ch;\n\tch=getchar();\n\twhile(ch<'0'||ch>'9'&&ch!='-')\n\t\tch=getchar();\n\twhile(ch=='-')\n\t\tk=-1,ch=getchar();\n\twhile(ch>='0'&&ch<='9')\n\t\tx=(x<<3)+(x<<1)+ch-'0',ch=getchar();\n\treturn x*k;\n}\nint n;\nint la[500],lb[500],va[500],vb[500];\nint match[500],match2[500],w[100][100],data;\nint sum=-1;\nstruct P{\n\tint l;\n\tint r;\n}h[500];\ninline int cmp(P x,P y)\n{\n\treturn x.l<y.l;\n}\ninline bool dfs(int x)\n{\n\tva[x]=1;\n\tfor(RN  y=1;y<=n;y++)\n\t{\n\t\tif(!vb[y])\n\t\t\tif(la[x]+lb[y]-w[x][y]==0)\n\t\t\t{\n\t\t\t\tvb[y]=1;\n\t\t\t\tif(!match[y]||dfs(match[y]))\n\t\t\t\t{\n\t\t\t\t\tmatch[y]=x;\n\t\t\t\t\treturn true;\t\t\n\t\t\t\t}\t\t\t\n\t\t\t}\n\t\t\telse data=min(data,la[x]+lb[y]-w[x][y]);\n\t}\n\treturn false;\n}\ninline int km()//\u7528\u6765\u6c42\u4fee\u6539\u4e4b\u524d\u7684\u5339\u914d\u6700\u5927\u6743\u503c\uff0c\u5373\u7b2c\u4e00\u95ee\u7b54\u6848\u3002\n{\n\tfor(RN i=1;i<=n;i++)\n\t{\n\t\tla[i]=-(1<<30);\n\t\tlb[i]=0;\n\t\tfor(RN j=1;j<=n;j++)\n\t\t\tla[i]=max(la[i],w[i][j]);\n\t}\n\tfor(RN k=1;k<=n;k++)\n\t{\n\t\twhile(233)\n\t\t{\n\t\t\tmemset(va,0,sizeof(va));\n\t\t\tmemset(vb,0,sizeof(vb));\n\t\t\tdata=1<<30;\n\t\t\tif(dfs(k))\n\t\t\t\tbreak;\n\t\t/*\tfor(RN j=1;j<=n;j++)\n\t\t\t\tif(!vb[j])\n\t\t\t\t\tdata=min(data,la[k]+lb[j]-w[k][j]);*/\n\t\t\tfor(RN i=1;i<=n;i++)\n\t\t\t{\n\t\t\t\tif(va[i])\n\t\t\t\t\tla[i]-=data;\n\t\t\t\tif(vb[i])\n\t\t\t\t\tlb[i]+=data;\n\t\t\t}\n\t\t}\n\t}\n\tint ans=0;\n\tfor(RN i=1;i<=n;i++)\n\t\tans+=w[match[i]][i];\n\treturn ans;\n}\ninline bool dfs2(int x)\n{\n\tva[x]=1;\n\tfor(RN y=1;y<=n;y++)\n\t{\n\t\tif(!vb[y])\n\t\t\tif(la[x]+lb[y]-w[x][y]==0)\n\t\t\t{\n\t\t\t\tvb[y]=1;\n\t\t\t\tif(!match2[y]||dfs2(match2[y]))\n\t\t\t\t{\n\t\t\t\t\tmatch2[y]=x;\n\t\t\t\t\treturn true;\t\t\n\t\t\t\t}\t\n\t\t\t}\n\t\t\telse\n\t\t\tdata=min(data,la[x]+lb[y]-w[x][y]);\n\t}\n\treturn false;\n}\ninline int km2()//\u5904\u7406\u4fee\u6539\u540e\u7684\u5339\u914d\u6700\u5927\u503c\u3002\n{\n\tfor(RN i=1;i<=n;i++)\n\t{\n\t\tla[i]=-(1<<30);\n\t\tlb[i]=0;\n\t\tfor(RN j=1;j<=n;j++)\n\t\t\tla[i]=max(la[i],w[i][j]);\n\t}\n\tfor(RN k=1;k<=n;k++)\n\t{\n\t\twhile(233)\n\t\t{\n\t\t\tmemset(va,0,sizeof(va));\n\t\t\tmemset(vb,0,sizeof(vb));\n\t\t\tdata=1<<30;\n\t\t\tif(dfs2(k))\n\t\t\t\tbreak;\n\t\t/*\tfor(RN j=1;j<=n;j++)\n\t\t\t\tif(!vb[j])\n\t\t\t\t\tdata=min(data,la[k]+lb[j]-w[k][j]);\n\t\t\t*/for(RN i=1;i<=n;i++)\n\t\t\t{\n\t\t\t\tif(va[i])\n\t\t\t\t\tla[i]-=data;\n\t\t\t\tif(vb[i])\n\t\t\t\t\tlb[i]+=data;\n\t\t\t}\n\t\t}\n\t}\n\tint ans2=0;\n\tfor(RN i=1;i<=n;i++)\n\t\tans2+=w[match2[i]][i];\n\treturn ans2;\n}\nint main()\n{\n//\tfreopen(\"1.out\",\"r\",stdin);\n//\tfreopen(\"ans.out\",\"w\",stdout);\n\tn=read();\n\tfor(RN i=1;i<=n;i++)\n\t\tfor(RN j=1;j<=n;j++)\n\t\t\tw[i][j]=read();\n\t//for(RN i=1;i<=5000;i++)\n\t//\th[i].val=0;\n\tint sum=km();\n\tcout<<sum<<endl;\n\tint tot=0;\n\tfor(RN i=1;i<=n;i++)\n\t{\n\t\tint tmp=w[match[i]][i];//\u4fee\u6539\u8fd9\u4e2a\u7537\u670b\u53cb\u5230\u5973\u670b\u53cb\u7684\u8fb9\u6743\u503c\n\t\tw[match[i]][i]=0;\n\t\tmemset(match2,0,sizeof(match2));//\u6ce8\u610f\u5339\u914d\u5bf9\u8c61\u8981\u6e05\u96f6\n\t\tif(km2()<sum)//\u4fee\u6539\u540e\u53d1\u73b0\u7b54\u6848\u53d8\u5c0f\u4e86\uff0c\u8bf4\u660e\u8fd9\u5bf9\u7537\u5973\u5728\u4ea4\u96c6\u4e2d\n\t\t\th[++tot].r=i,h[tot].l=match[i];\n\t\tw[match[i]][i]=tmp;\n\t}\n\tsort(h+1,h+tot+1,cmp);\n\tfor(RN i=1;i<=tot;i++)\n\t\tcout<<h[i].l<<\" \"<<h[i].r<<endl;\n\treturn 0;\n}",
        "postTime": 1569327353,
        "uid": 111487,
        "name": "\u9f99\u7fd4\u51e4\u7fe5",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3967 \u3010[TJOI2014]\u5339\u914d\u3011"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3967)\n\n### \u9898\u610f\u5206\u6790\uff1a\n\n\u770b\u5230\u8fd9\u4e2a\u9898\u9762\uff0c\u5f88\u5bb9\u6613\u60f3\u5230\u662f\u6c42\u4e8c\u5206\u56fe\u6700\u5927\u6743\u5b8c\u7f8e\u5339\u914d\u3002\n\n\u5efa\u56fe\u7684\u8bdd\u7528\u90bb\u63a5\u77e9\u9635\u6216\u8005\u94fe\u5f0f\u524d\u5411\u661f\u90fd\u5f88\u5bb9\u6613\uff0c\u4ee5\u53ca\u6c42\u6700\u5927\u6743\u4e5f\u5f88\u7b80\u5355\u3002\n\u4f46\u96be\u5c31\u96be\u5728\u7b2c\u4e8c\u4e2a\u64cd\u4f5c\u3002\n\n\u7b2c\u4e8c\u4e2a\u64cd\u4f5c\u7684\u5185\u5bb9\uff1a **\u7ecf\u5178\u7684\u95ee\u9898\u662f\u8ba1\u7b97\u5e78\u798f\u503c\u6700\u5927\u7684\u5339\u914d\uff0c\u5373\u5b8c\u7f8e\u5339\u914d\u3002\u7136\u800c\u5b8c\u7f8e\u5339\u914d\u6709\u65f6\u5019\u5e76\u4e0d\u552f\u4e00\uff0c\u4f60\u9700\u8981\u8ba1\u7b97\u5bf9\u4e8e\u6240\u6709\u7684\u5b8c\u7f8e\u5339\u914d\uff0c\u5176\u4ea4\u96c6\u662f\u4ec0\u4e48\u3002**\n\n\u8fd0\u7528 KM \u6216\u8005 Dinic \u90fd\u5f88\u5bb9\u6613\u6c42\u5f97\u5b8c\u7f8e\u5339\u914d\u7684\u5e78\u798f\u6570\uff0c\u4f46\u662f\u9898\u76ee\u4e2d\u53ef\u80fd\u51fa\u73b0\u591a\u79cd\u5b8c\u7f8e\u5339\u914d\uff0c\u7528\u9898\u76ee\u4e2d\u7684\u6837\u4f8b\u6765\u4e3e\u4f8b\u3002\n\n```\n3\n1 1 1\n2 1 1\n1 1 1\n\n```\n1. $1 \\rightarrow 2 \\quad 2 \\rightarrow 1 \\quad 3 \\rightarrow 1$\n2. $1 \\rightarrow 3 \\quad 2 \\rightarrow 1 \\quad 3 \\rightarrow 1$\n3. $1 \\rightarrow 2 \\quad 2 \\rightarrow 1 \\quad 3 \\rightarrow 2$\n4. $1 \\rightarrow 3 \\quad 2 \\rightarrow 1 \\quad 3 \\rightarrow 2$\n\n\n\u5bf9\u4e8e\u6837\u4f8b\uff0c\u4f1a\u6709\u4ee5\u4e0a\u56db\u79cd\u5b8c\u7f8e\u5339\u914d\uff0c\u90a3\u4e48\u9898\u76ee\u4e2d\u7684\u4ea4\u96c6\u662f\u4ec0\u4e48\u5462\uff1f\n\n\u5c31\u662f\u7b2c\u4e8c\u4e2a\u7537\u540c\u5b66\u9009\u62e9\u7b2c\u4e00\u4e2a\u5973\u540c\u5b66\uff0c\u56e0\u4e3a\u53ea\u6709\u8fd9\u6837\u624d\u80fd\u662f\u5e78\u798f\u4e4b\u6700\u5927\u7684\u5339\u914d\u3002\n\n\u4e5f\u5c31\u662f\u6837\u4f8b\u8f93\u51fa\u7684\uff1a\n```\n\u6700\u5927\u5e78\u798f\u503c\uff1a 4\n\u4ea4\u96c6\uff1a       2 1\n```\n\u6240\u4ee5\u8fd9\u4e2a\u9898\u76ee\u4e2d\u6240\u8c13\u7684\u4ea4\u96c6\uff0c**\u5c31\u662f\u4e3a\u4e86\u6784\u6210\u6700\u5927\u5e78\u798f\u503c\u6240\u5fc5\u987b\u9009\u62e9\u7684\u4e00\u4e9b\u642d\u914d** \u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u660e\u663e\u7684\u53d1\u73b0\u4e00\u4e2a\u6027\u8d28\uff1a\u5982\u679c\u8fd9\u4e9b\u642d\u914d\u4e2d\u6709\u4e00\u4e2a\u4f1a\u4e0d\u9009\uff0c\u90a3\u4e48\u6700\u5927\u5e78\u798f\u503c\u5c31\u4f1a\u53d8\u5c0f\u3002\n\n\u4f46\u662f\u8fd8\u6709\u4e00\u4e2a\u65b9\u9762\u9700\u8981\u5927\u5bb6\u6ce8\u610f\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff1a\n\n```\n3\n1 1 1\n2 2 1\n1 1 1\n```\n\n\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u7684\u4ea4\u96c6\u662f\u4ec0\u4e48\u5462\uff1f\n\n\u4f60\u4f1a\u53d1\u73b0\u5b83 **\u6ca1\u6709\u4ea4\u96c6** \uff0c\u56e0\u4e3a\u5b83\u6ca1\u6709\u5fc5\u987b\u9009\u7684\uff0c\u90a3\u4f60\u53ef\u4ee5\u6709\u7591\u95ee\uff0c\u90a3\u4e2a\u7b2c\u4e8c\u4e2a\u7537\u751f\u4e0e\u7b2c\u4e00\u4e2a\u5973\u751f\u6216\u8005\u7b2c\u4e8c\u4e2a\u5973\u751f\u6240\u4ea7\u751f\u7684\u5e78\u798f\u503c\u4e00\u6837\u554a\uff0c\u90a3\u4e0d\u5f97\u4e24\u4e2a\u9009\u4e00\u4e2a\uff0c\u8fd9\u4e0d\u80af\u5b9a\u6709\u4ea4\u96c6\u4e86\u5417\uff1f\n\n\u4e0d\u8981\u5fd8\u4e86\u5728\u6570\u5b66\u4e0a\u96c6\u5408\u7684\u5b9a\u4e49\u662f\uff1a**\u8bbe $A$ \uff0c $B$ \u662f\u4e24\u4e2a\u96c6\u5408\uff0c\u7531\u6240\u6709\u5c5e\u4e8e\u96c6\u5408 $A$ \u4e14\u5c5e\u4e8e\u96c6\u5408 $B$ \u7684\u5143\u7d20\u6240\u7ec4\u6210\u7684\u96c6\u5408\uff0c\u53eb\u505a\u96c6\u5408 $A$ \u4e0e\u96c6\u5408 $B$ \u7684\u4ea4\u96c6** \u3002\n\n\u6240\u4ee5\u5f97\u662f\u6784\u6210\u6bcf\u4e2a\u6700\u5927\u5e78\u798f\u503c\u6240\u5fc5\u9009\u7684\uff0c\u6bcf\u4e2a\u6700\u5927\u5e78\u798f\u503c\u90fd\u9700\u8981\u8fd9\u4e00\u4e9b\u642d\u914d\u7684\u624d\u662f\u4ea4\u96c6\u3002\n\n\u6240\u4ee5\u8fd0\u7528\u6240\u5fc5\u987b\u7684\u642d\u914d\u4e00\u5b9a\u4f1a\u5f71\u54cd\u6700\u5927\u5e78\u798f\u503c\u8fd9\u4e00\u6027\u8d28\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u89e3\u51b3\u9898\u76ee\u5566\u3002\n\n\u81f3\u6b64\uff0c\u9898\u76ee\u7406\u89e3\u7ed3\u675f\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<cstring>\n#include<cstdio>\n#include<cmath>\n#include<map>\n#include<queue>\n#define int long long\nusing namespace std;\nstruct node{\n\tint x,y;\n}p[1010];\nbool cmp(node a,node b){\n\treturn a.x<b.x;\n}\nconst int INF=0x3f3f3f3f3f;\nconst int N=550;\nint n,m,match[N],pri[N];//\u6570\u7ec4\u5b9a\u4e49\u770b\u6587\u672b\nbool vis2[N];\nlong long fav[N][N],val1[N],val2[N],sla[N];\n\nvoid bfs(int k){//\u6b63\u5e38\u7684BFS\u6c42\u4e8c\u5206\u56fe\u6700\u5927\u6743\u5b8c\u7f8e\u5339\u914d\u5566\n\tint x,y=0,z=0;\n\tmemset(pri,0,sizeof(pri));\n\tmemset(sla,INF,sizeof(sla));\n \tmatch[0]=k;\n\tdo{\n\t\tint d=INF;\n\t\tx=match[y];\n\t\tvis2[y]=true;\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tif(vis2[i]){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(sla[i]>val1[x]+val2[i]-fav[x][i]){\n\t\t\t\tsla[i]=val1[x]+val2[i]-fav[x][i];\n\t\t\t\tpri[i]=y;\n\t\t\t}\n\t\t\tif(sla[i]<d){\n\t\t\t\td=sla[i];\n\t\t\t\tz=i;\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<=n;i++){\n\t\t\tif(vis2[i]){\n\t\t\t\tval1[match[i]]-=d;val2[i]+=d;\n\t\t\t}else{\n\t\t\t\tsla[i]-=d;\n\t\t\t}\n\t\t}\n\t\ty=z;\n\t}while(match[y]);\n\twhile(y){\n\t\tmatch[y]=match[pri[y]];\n\t\ty=pri[y];\n\t}\n}\nint KM(){\n\tmemset(match,0,sizeof(match));\n\tmemset(val1,0,sizeof(val1));\n\tmemset(val2,0,sizeof(val2));\n\tfor(int i=1;i<=n;i++){\n\t\tmemset(vis2,false,sizeof(vis2));\n\t\tbfs(i);\n\t}\n\tint res=0;\n\tfor(int i=1;i<=n;i++){\n\t\tres+=fav[match[i]][i];\n\t}\n\treturn res;\n}\nsigned main(){\n\tcin>>n;\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tcin>>fav[i][j];\n\t\t}\n\t}\n\tint ans=KM();\n\tcout<<ans<<endl;\n\tfor(int i=1;i<=n;i++){\n\t\tp[i].x=match[i],p[i].y=i;\n\t}\n\tsort(p+1,p+n+1,cmp);\n\tfor(int i =1;i<=n;i++){\n\t\tint k=fav[p[i].x][p[i].y];\n\t\tfav[p[i].x][p[i].y]=-INF;//\u65ad\u5f00\u67d0\u4e00\u6761\u8fb9\n\t\tif(KM()<ans){//\u91cd\u65b0\u8dd1\u4e00\u6b21KM\uff0c\u5224\u65ad\u6700\u5927\u503c\u662f\u5426\u6709\u53d8\u5316\n\t\t\tcout<<p[i].x<<\" \"<<p[i].y<<endl;\n\t\t} \n\t\tfav[p[i].x][p[i].y]=k;\n\t}\n}\n/*\n\u8bbe\u7f6e\u6700\u5927\u671f\u671b\u503c\n\u5229\u7528\u5308\u7259\u5229\u7b97\u6cd5\u627e\u589e\u5e7f\u8def\n\u627e\u5230\u589e\u5e7f\u8def\uff0c\u5339\u914d\u6210\u529f\uff0c\u9000\u51fa\n\u627e\u4e0d\u5230\uff0c\u6700\u5c0f\u7a0b\u5ea6\u964d\u4f4e\u7537\u751f\u671f\u671b\uff0c\u63d0\u5347\u5973\u751f\u671f\u671b\n\u7ee7\u7eed\u56de\u5230(2)\u5f00\u59cb\u91cd\u590d\n*/\n\n/*val1[N]/val2[N]\u5206\u522b\u8bb0\u5f55U\u96c6\u4e0eV\u96c6\u70b9\u7684\u70b9\u6743\uff08\u5339\u914d\u671f\u671b\u503c\uff09\n\nvis1[N]/vis2[N]\u5206\u522b\u8bb0\u5f55\u6bcf\u6b21\u5bfb\u627e\u589e\u5e7f\u8def\u8fc7\u7a0b\u4e2dU\u96c6\u4e0eV\u96c6\u70b9\u7684\u8bbf\u95ee\u60c5\u51b5\n\nmatch[N]\u8bb0\u5f55\u6700\u7ec8V\u96c6\u5185\u70b9\u5339\u914d\u5230\u7684\u5728U\u96c6\u5185\u70b9\u7684\u7f16\u53f7\n\nslack[N]\u8bb0\u5f55\u5339\u914d\u8fc7\u7a0b\u4e2d\uff0cU\u96c6\u5185\u4efb\u610f\u70b9\u80fd\u591f\u9009\u62e9V\u96c6\u5185\u4efb\u610f\u70b9\u4f5c\u4e3a\u5339\u914d\u5bf9\u8c61\u6240\u9700\u8981\u964d\u4f4eval\uff08\u671f\u671b\u503c\uff09\u7684\u6700\u5c0f\u503c\n*/\n\n```\n\u611f\u8c22\u9605\u8bfb\uff01\n",
        "postTime": 1663765389,
        "uid": 376347,
        "name": "\u4f4f\u5728\u9694\u58c1\u5c0f\u8398",
        "ccfLevel": 0,
        "title": "P3967 [TJOI2014]\u5339\u914d"
    },
    {
        "content": "## \u9898\u610f\n\u6709 $n$ \u4e2a\u7537\u751f\u548c $n$ \u4e2a\u5973\u751f\uff0c\u7537\u751f $i$ \u548c\u5973\u751f $j$ \u914d\u5bf9\u7684\u5e78\u798f\u503c\u662f $H _{i,j}$\uff0c\u6c42\u5c06\u6240\u6709\u7537\u751f\u548c\u6240\u6709\u5973\u751f\u914d\u5bf9\u540e\u5e78\u798f\u503c\u4e4b\u548c\u7684\u6700\u5927\u503c\uff0c\u5e76\u4e14\u6c42\u51fa\u6709\u54ea\u51e0\u5bf9\u7537\u5973\u5728\u5e78\u798f\u503c\u4e4b\u548c\u6700\u5927\u7684\u60c5\u51b5\u4e0b\u5fc5\u987b\u914d\u5bf9\uff0c\u6309\u7167\u7537\u751f\u7684\u7f16\u53f7\u4ece\u5c0f\u5230\u5927\u8f93\u51fa\u3002\n## Solution\n\u770b\u5230\u5339\u914d\uff0c\u5f88\u81ea\u7136\u5730\u4f1a\u60f3\u5230\u7f51\u7edc\u6d41\uff0c\u53c8\u56e0\u4e3a\u8fd9\u91cc\u7684\u8d21\u732e\u662f\u4e0d\u76f8\u7b49\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528\u6d41\u91cf\u6765\u9650\u5236\u914d\u5bf9\uff0c\u7528\u8d39\u7528\u6765\u8ba1\u7b97\u8d21\u732e\u3002\n\n\u5177\u4f53\u8fde\u8fb9\u65b9\u5f0f\u5982\u4e0b\uff0c\u7070\u5e38\u5730\u7b80\u5355\uff1a\n- \u539f\u70b9\u8fde\u5411\u7537\u751f\uff0c\u6d41\u91cf\u4e3a 1\uff0c\u8d39\u7528\u4e3a 0\u3002\n- \u7537\u751f\u8fde\u5411\u5973\u751f\uff0c\u6d41\u91cf\u4e3a 1\uff0c\u8d39\u7528\u4e3a $h[i][j]$\u3002\n- \u5973\u751f\u8fde\u5411\u6c47\u70b9\uff0c\u6d41\u91cf\u4e3a 1\uff0c\u8d39\u7528\u4e3a 0\u3002\n\n\u53c8\u56e0\u4e3a\u9898\u76ee\u8981\u6c42\u603b\u8d21\u732e\u6700\u5927\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a\u8fb9\u6743\u53d6\u53cd\uff0c\u7136\u540e\u8dd1\u4e00\u904d\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\uff0c\u518d\u5c06\u7b54\u6848\u53d6\u53cd\u3002\n\n\u7136\u540e\u6c42\u5fc5\u987b\u914d\u5bf9\u7684\u4e5f\u5f88\u7b80\u5355\uff0c\u6211\u4eec\u8bb0\u5f55\u4e00\u4e0b\u5728\u7b2c\u4e00\u904d\u8d39\u7528\u6d41\u7684\u65f6\u5019\u6709\u54ea\u4e9b\u7537\u5973\u751f\u4e4b\u95f4\u8fb9\u88ab\u6d41\u8fc7\u4e86\uff0c\u7136\u540e\u6bcf\u6b21\u5220\u6389\u5176\u4e2d\u4e00\u6761\u518d\u8dd1\u4e00\u904d\u8d39\u7528\u6d41\u770b\u770b\u8fd8\u7b49\u4e0d\u7b49\u4e8e\u6700\u5927\u8d21\u732e\u5373\u53ef\u3002\u8bc1\u660e\u663e\u7136\u3002\n## CODE\n```cpp\n#include<bits/stdc++.h>\n#define N 105\n#define INF 0x3f3f3f3f\nusing namespace std;\nstruct G {\n\tint nxt, to, w, c;\n}e[N * N * 10], ee[N * N * 10];\nint n, S, T, cnt, ans1, ans, lst[N * N], last[N * N], d[N * N * N], cost[N * N], flow[N * N], head[N * N], num[N][3];\nbool bz[N * N];\nvoid add(int u, int v, int w, int c) {\n\tee[++cnt].to = v; ee[cnt].w = w; ee[cnt].c = c; ee[cnt].nxt = head[u]; head[u] = cnt;\n}\nbool spfa(int k1, int k2)\n{\n\tfor (int i = S; i <= T; ++i)\n\t\tbz[i] = 0, flow[i] = INF, cost[i] = INF;\n\tint h = 0, t = 1; d[S] = 1; bz[S] = 1; cost[S] = 0; lst[T] = -1;\n\tfor (; h < t; ) {\n\t\tint u = d[++h]; bz[u] = 0;\n\t\tfor (int i = head[u]; ~i; i = e[i].nxt) {\n\t\t\tif (i == k1 || i == k2) continue; int v = e[i].to;\n\t\t\tif (e[i].w && cost[v] > cost[u] + e[i].c) {\n\t\t\t\tcost[v] = cost[u] + e[i].c; lst[v] = u; last[v] = i; flow[v] = min(flow[u], e[i].w);\n\t\t\t\tif (!bz[v]) d[++t] = v, bz[v] = 1;\n\t\t\t}\n\t\t}\n\t} return lst[T] != -1;\t\n}//SPFA\u6c42\u8d39\u7528\u6d41\nvoid mxf(int k1, int k2)\n{\n\tfor (; spfa(k1, k2); ) {\n\t\tint now = T; ans1 += flow[T] * cost[T];\n\t\tfor (; now != S; ) e[last[now]].w -= flow[n], e[last[now] ^ 1].w += flow[n], now = lst[now];\n\t}\n}\nint main() {\n\tfreopen(\"match.in\", \"r\", stdin); freopen(\"match.out\", \"w\", stdout);\n\tscanf(\"%d\", &n); S = 0; T = n * 2 + 1; cnt = -1;\n\tfor (int i = S; i <= T; ++i) head[i] = -1;\n\tfor (int i = 1; i <= n; ++i)\n\t\tadd(S, i, 1, 0), add(i, S, 0, 0), add(i + n, T, 1, 0), add(T, i + n, 0, 0);\n\tfor (int i = 1; i <= n; ++i)\n\t\tfor (int x, j = 1; j <= n; ++j) {\n\t\t\tscanf(\"%d\", &x); add(i, j + n, 1, -x); add(j + n, i, 0, x);\n\t\t}\n\tfor (int i = 0; i <= cnt; ++i) e[i] = ee[i];\n\tmxf(INF, INF); ans = -ans1; printf(\"%d\\n\", ans); int tot = 0;\n\tfor (int u = 1; u <= n; ++u) {\n\t\tfor (int i = head[u]; ~i; i = e[i].nxt) {\n\t\t\tif (e[i].to > n && e[i].to <= n * 2 && !e[i].w) {\n\t\t\t\tnum[++tot][0] = i; num[tot][1] = u; num[tot][2] = e[i].to - n;\n\t\t\t}\n\t\t}\n\t}//\u7edf\u8ba1\u54ea\u6761\u8fb9\u88ab\u6d41\u8fc7\u4e86\n\tfor (int i = 1; i <= tot; ++i) {\n\t\tfor (int k = 0; k <= cnt; ++k) e[k] = ee[k];\n\t\tans1 = 0; mxf(num[i][0], num[i][0] + 1);\n\t\tif (-ans1 != ans) printf(\"%d %d\\n\", num[i][1], num[i][2]);\n\t}\n\treturn 0;\n} \n```\n",
        "postTime": 1642302181,
        "uid": 37885,
        "name": "\u51b7\u7b11\u53f9\u79cb\u8427",
        "ccfLevel": 0,
        "title": "P3967 [TJOI2014]\u5339\u914d \u9898\u89e3"
    },
    {
        "content": "\u8fd9\u9898\u7b2c\u4e00\u95ee\u5f88\u663e\u7136\u662f KM \u7684\u6a21\u677f\u9898\uff0c\u6211\u4eec\u8003\u8651\u5982\u4f55\u89e3\u51b3\u7b2c\u4e8c\u95ee\u3002\n\n\u505a\u6cd5\uff1a\u5148\u6c42\u51fa\u4efb\u610f\u4e00\u7ec4\u6700\u5927\u6743\u5b8c\u7f8e\u5339\u914d\uff0c\u7136\u540e\u5bf9\u4e8e\u5339\u914d\u91cc\u7684\u4e00\u6761\u8fb9\uff0c\u5982\u679c\u5220\u53bb\u8fd9\u6761\u8fb9\u540e\u7684\u6700\u5927\u6743\u5b8c\u7f8e\u5339\u914d\u548c\u539f\u6765\u76f8\u540c\uff0c\u90a3\u4e48\u663e\u7136\u8fd9\u6761\u8fb9\u4e0d\u662f\u5fc5\u987b\u8981\u9009\u7684\u3002\u5426\u5219\u8fd9\u6761\u8fb9\u4e00\u5b9a\u662f\u8981\u9009\u7684\uff0c\u56e0\u4e3a\u4e0d\u9009\u8fd9\u6761\u8fb9\u4f1a\u4f7f\u7ed3\u679c\u53d8\u5f97\u66f4\u52a3\u3002\u6700\u540e\u8f93\u51fa\u6240\u6709\u5fc5\u987b\u9009\u7684\u8fb9\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a\u4e00\u5171\u8fd0\u884c $O(n)$ \u6b21 KM\uff0c\u4e00\u6b21 KM \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^3)$\uff0c\u6240\u4ee5\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^4)$\u3002\n\n**PS\uff1a\u8fd9\u9898\u6570\u636e\u6bd4\u8f83\u5f31\uff0c$O(n^5)$ \u7684 dfs \u505a\u6cd5\u53ef\u4ee5\u901a\u8fc7\u3002**\n\n\u4ee3\u7801:\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define N 90\nusing namespace std;\nint n,ans;\nint e[N][N],id[N][N],lx[N],ly[N],slack[N],px[N],py[N],prv[N],u[N*N],v[N*N],w[N*N],p[N];\nbool vx[N],vy[N];\nqueue<int> q;\nvoid match(int x){\n\tint tmp;\n\twhile(x){\n\t\ttmp=px[prv[x]];\n\t\tpx[prv[x]]=x;\n\t\tpy[x]=prv[x];\n\t\tx=tmp;\n\t}\n}\nvoid bfs(int x){\n\tmemset(vx,0,sizeof(vx));\n\tmemset(vy,0,sizeof(vy));\n\tmemset(slack,63,sizeof(slack));\n\twhile(!q.empty())q.pop();\n\tq.push(x);\n\twhile(1){\n\t\twhile(!q.empty()){\n\t\t\tint u=q.front();\n\t\t\tq.pop();\n\t\t\tvx[u]=1;\n\t\t\tfor(int i=1;i<=n;++i)\n\t\t\t\tif(!vy[i]){\n\t\t\t\t\tif(lx[u]+ly[i]-e[u][i]<slack[i]){\n\t\t\t\t\t\tslack[i]=lx[u]+ly[i]-e[u][i];\n\t\t\t\t\t\tprv[i]=u;\n\t\t\t\t\t\tif(slack[i]==0){\n\t\t\t\t\t\t\tvy[i]=1;\n\t\t\t\t\t\t\tif(!py[i]){\n\t\t\t\t\t\t\t\tmatch(i);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}else q.push(py[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\t\tint d=1e18;\n\t\tfor(int i=1;i<=n;++i)\n\t\t\tif(!vy[i]) d=min(d,slack[i]);\n\t\tfor(int i=1;i<=n;++i){\n\t\t\tif(vx[i])lx[i]-=d;\n\t\t\tif(vy[i])ly[i]+=d;\n\t\t\telse slack[i]-=d;\n\t\t}\n\t\tfor(int i=1;i<=n;++i)\n\t\t\tif(!vy[i]){\n\t\t\t\tif(slack[i]==0){\n\t\t\t\t\tvy[i]=1;\n\t\t\t\t\tif(!py[i]){\n\t\t\t\t\t\tmatch(i);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}else q.push(py[i]);\n\t\t\t\t}\n\t\t\t}\n\t}\n}\nint KM(){\n\tmemset(prv,0,sizeof(prv));\n\tmemset(lx,0,sizeof(lx));\n\tmemset(ly,0,sizeof(ly));\n\tmemset(px,0,sizeof(px));\n\tmemset(py,0,sizeof(py));\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=n;j++) lx[i]=max(lx[i],e[i][j]);\n\tfor(int i=1;i<=n;i++) bfs(i);\n\tint ans=0;\n\tfor(int i=1;i<=n;i++) ans+=e[py[i]][i];\n\treturn ans;\n}\nsigned main(){\n\tscanf(\"%lld\",&n);\n\tfor(int i=1;i<=n;i++) \n\t\tfor(int j=1;j<=n;j++) scanf(\"%lld\",&e[i][j]);\n\tint ans=KM();\n\tprintf(\"%lld\\n\",ans);\n\tfor(int i=1;i<=n;i++) p[i]=px[i];\n\tfor(int i=1;i<=n;i++){\n\t\tint tmp=e[i][p[i]];\n\t\te[i][p[i]]=-1e18;\n\t\tif(KM()!=ans) printf(\"%lld %lld\\n\",i,p[i]);\n\t\te[i][p[i]]=tmp;\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1631190890,
        "uid": 213870,
        "name": "Yudanjun",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3967 [TJOI2014]\u5339\u914d"
    },
    {
        "content": "### \u524d\u8a00\n\n\u5bf9\u4e8e\u6d89\u53ca\u5230\u4e8c\u5206\u56fe\u6700\u5927\u6743\u5b8c\u7f8e\u5339\u914d\u7684\u9898\uff0c\u6211\u4eec\u4e00\u5171\u6709\u4e24\u79cd\u601d\u8def\uff1a\u8d39\u7528\u6d41\u4ee5\u53ca KM \u7b97\u6cd5\u3002\u4e0d\u8fc7\u6211\u4eec\u5f97\u660e\u786e\u4e00\u4e2a\u4e8b\u5b9e\uff0c\u5728\u7a20\u5bc6\u4e8c\u5206\u56fe\u4e2d\uff0cKM \u7b97\u6cd5\u7684\u8fd0\u884c\u6548\u7387\u8981\u4f18\u4e8e\u8d39\u7528\u6d41\uff0c\u5e76\u4e14 KM \u7684\u4ee3\u7801\u76f8\u8f83\u4e8e\u8d39\u7528\u6d41\u8981\u66f4\u52a0\u7684\u597d\u5199\u3002\n\n\u6240\u4ee5\u672c\u9898\u4e2d\uff0c\u672c\u4eba\u4f7f\u7528\u7684\u662f KM \u7b97\u6cd5\u3002\n\n### \u601d\u8def\n\n\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u95ee\u9898\uff0c\u53ea\u9700\u8981\u8dd1\u4e00\u904d\u4e8c\u5206\u56fe\u6700\u5927\u6743\u5b8c\u7f8e\u5339\u914d\u5c31\u884c\u4e86\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u95ee\u9898\uff0c\u66b4\u529b\u7684\u601d\u8def\u662f\u679a\u4e3e\u6bcf\u4e00\u6761\u8fb9\uff0c\u770b\u5220\u9664\u4e4b\u540e\u662f\u5426\u4f1a\u8ba9\u5b8c\u7f8e\u5339\u914d\u7684\u503c\u53d8\u5c0f\uff0c\u5982\u679c\u53d8\u5c0f\u4e86\u5219\u8fdb\u884c\u8f93\u51fa\u3002\n\u65f6\u95f4\u590d\u6742\u5ea6\u8fbe\u5230\u4e86 $O(n^5)$\uff0c\u663e\u7136\u7206\u6389\u3002\n\n\u7ecf\u8fc7~~\u7b80\u5355\u7684~~\u601d\u8003\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u5176\u5b9e\u53ea\u9700\u8981\u679a\u4e3e\u6700\u5f00\u59cb\u7684 $n$ \u4e2a\u5339\u914d\u5c31\u884c\u4e86\uff0c\u56e0\u4e3a\u53ea\u6709\u66f4\u6539\u4e86\u8fd9 $n$ \u6761\u8fb9\u4e2d\u7684\u67d0\u4e00\u6761\u8fb9\uff0c\u5b8c\u7f8e\u5339\u914d\u7684\u503c\u624d\u6709\u53ef\u80fd\u88ab\u66f4\u6539\u3002\n\n\u4e8e\u662f\u7b97\u4e0a KM \u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3)$\uff0c\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n^4)$\uff0c\u53ef\u4ee5\u8fc7\u6389\u6b64\u9898\u3002\n\n### \u4e00\u4e9b\u7ec6\u8282\n\n1. \u7b2c\u4e8c\u95ee\u8981\u6c42\u4ee5 $i$ \u7684\u9012\u589e\u987a\u5e8f\u8f93\u51fa\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5c06\u7b2c\u4e00\u6b21\u5339\u914d\u7684\u8fb9\u8fdb\u884c\u6392\u5e8f\u540e\u518d\u8fdb\u884c\u679a\u4e3e\u3002\n\n2. KM \u7b97\u6cd5\u5728\u6b63\u5e38\u60c5\u51b5\u4e0b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^3)$\uff0c\u4e0d\u8fc7\u6709\u4e00\u4e9b\u6784\u9020\u7684\u6570\u636e\u53ef\u4ee5\u5c06\u7b97\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6\u5361\u5230 $O(n^4)$\uff0c\u6b64\u65f6\u9700\u8981\u4f7f\u7528 BFS \u7248\u672c\u7684 KM \u7b97\u6cd5\uff0c\u4e0d\u8fc7\u4e00\u822c\u90fd\u4e0d\u4f1a\u5361\uff0c\u56e0\u4e3a\u8fd9\u57fa\u672c\u4e0a\u6beb\u65e0\u610f\u4e49\u3002\n\nCode\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ninline int read(){\n\tint sss=0;\n\tchar chh=getchar();\n\twhile(chh<'0'||chh>'9') chh=getchar();\n\twhile(chh>='0'&&chh<='9'){\n\t\tsss=sss*10+chh-'0';\n\t\tchh=getchar();\n\t}\n\treturn sss;\n}\nint n;\nint edge[85][85];\nbool visx[85],visy[85];\nint lx[85],ly[85];\nint matched[85],slack[85];\nstruct node{\n\tint x,y;\n}e[85];\nbool cmp(const node& x,const node& y){\n\treturn x.x<y.x;\n}\nbool find(int now){\n\tvisx[now]=true;\n\tfor(register int i=1;i<=n;i++){\n\t\tif(!visy[i]){\n\t\t\tif(lx[now]+ly[i]-edge[now][i]==0){\n\t\t\t\tvisy[i]=true;\n\t\t\t\tif(!matched[i]||find(matched[i])){\n\t\t\t\t\tmatched[i]=now;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse slack[i]=min(slack[i],lx[now]+ly[i]-edge[now][i]);\n\t\t}\n\t}\n\treturn false;\n}\nint KM(){\n\tmemset(matched,0,sizeof matched);\n\tfor(register int i=1;i<=n;i++){\n\t\tlx[i]=-0x3f,ly[i]=0;\n\t\tfor(register int j=1;j<=n;j++){\n\t\t\tlx[i]=max(lx[i],edge[i][j]);\n\t\t}\n\t}\n\tfor(register int i=1;i<=n;i++){\n\t\twhile(true){\n\t\t\tmemset(visx,false,sizeof visx);\n\t\t\tmemset(visy,false,sizeof visy);\n\t\t\tmemset(slack,0x3f,sizeof slack);\n\t\t\tif(find(i)) break;\n\t\t\tint delta=1e9;\n\t\t\tfor(register int j=1;j<=n;j++){\n\t\t\t\tif(!visy[j]) delta=min(delta,slack[j]);\n\t\t\t}\n\t\t\tfor(register int j=1;j<=n;j++){\n\t\t\t\tif(visx[j]) lx[j]-=delta;\n\t\t\t\tif(visy[j]) ly[j]+=delta;\n\t\t\t}\n\t\t}\n\t}\n\tint ans=0;\n\tfor(register int i=1;i<=n;i++)\n\t\tans+=edge[matched[i]][i];\n\treturn ans;\n}\nint main(){\n\tn=read();\n\tfor(register int i=1;i<=n;i++){\n\t\tfor(register int j=1;j<=n;j++){\n\t\t\tedge[i][j]=read();\n\t\t}\n\t}\n\tint ans=KM();\n\tprintf(\"%d\\n\",ans);\n\tfor(register int i=1;i<=n;i++){\n\t\te[i].x=matched[i],e[i].y=i;\n\t}\n\tsort(e+1,e+n+1,cmp);//no spj \n\tfor(register int i=1;i<=n;i++){\n\t\tint tmp=edge[e[i].x][e[i].y];\n\t\tedge[e[i].x][e[i].y]=0;\n\t\tif(KM()<ans) printf(\"%d %d\\n\",e[i].x,e[i].y);\n\t\tedge[e[i].x][e[i].y]=tmp;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1645089616,
        "uid": 367316,
        "name": "Foreverxxx",
        "ccfLevel": 0,
        "title": "P3967 [TJOI2014]\u5339\u914d \u9898\u89e3"
    },
    {
        "content": "\u5199\u7bc7\u9898\u89e3\u9020\u798f\u793e\u4f1a\u3002\n\n\u7b2c\u4e00\u95ee\u6c42\u5e26\u6743\u4e8c\u5206\u56fe\u7684\u6700\u5927\u5339\u914d\u3002\n\n\u6a21\u677f\u9898\uff0c\u76f4\u63a5\u8dd1``KM\u7b97\u6cd5``\u6216\u8005``\u8d39\u7528\u6d41``\u3002\n\n\u7b80\u8ff0\u4e00\u4e0b\u8d39\u7528\u6d41\u505a\u6cd5\uff1a\u6211\u4eec\u7528\u8282\u70b9$i$\u8868\u793a\u7537\u751f$i$\uff0c\u7528\u8282\u70b9$n+i$\u8868\u793a\u5973\u751f$i$\uff0c\u7136\u540e\u4ece\u8282\u70b9$i$\u5411\u8282\u70b9$n+j$\u8fde\u4e00\u6761\u5bb9\u91cf\u4e3a$1$\uff0c\u8d39\u7528\u4e3a$H_{i,j}$\u7684\u8fb9\u3002\u5efa\u7acb\u8d85\u7ea7\u6e90\u70b9\u548c\u8d85\u7ea7\u6c47\u70b9\uff0c\u539f\u70b9\u5411\u7537\u751f\u8fde\u8fb9\uff0c\u5973\u751f\u5411\u6c47\u70b9\u8fde\u8fb9\u3002\u6700\u540e\u8dd1\u6700\u5927\u8d39\u7528\u6700\u5927\u6d41\uff0c\u603b\u7684\u82b1\u8d39\u5373\u4e3a\u7b2c\u4e00\u95ee\u7684\u7b54\u6848\u3002\n\n\n\u7b2c\u4e8c\u4f4d\u6c42\u6700\u5927\u8d39\u7528\u6700\u5927\u6d41\u7684\u5fc5\u7ecf\u8fb9\u3002\n\n\u4e00\u4e2a\u6bd4\u8f83\u5957\u8def\u7684\u5224\u65ad\u5fc5\u7ecf\u8fb9\u7684\u505a\u6cd5\u662f\uff1a\u5c06\u8be5\u8fb9\u5220\u9664\uff0c\u91cd\u65b0\u8dd1\u8d39\u7528\u6d41\uff0c\u5982\u679c\u7b54\u6848\u53d1\u751f\u6539\u53d8\uff0c\u8bf4\u660e\u8be5\u8fb9\u662f\u5fc5\u7ecf\u8fb9\u3002\n\n\u4f46\u5982\u679c\u6211\u4eec\u76f4\u63a5\u679a\u4e3e\u6bcf\u6761\u8fb9\u5220\u9664\u518d\u8dd1\u8d39\u7528\u6d41\uff0c\u5e76\u4e0d\u80fd\u518d\u89c4\u5b9a\u65f6\u95f4\u5185\u8dd1\u5b8c\u3002\u7ecf\u8fc7\u89c2\u5bdf\u6211\u4eec\u53d1\u73b0\uff0c\u8dd1\u7b2c\u4e00\u95ee\u7684\u8d39\u7528\u6d41\u65f6\uff0c\u4e00\u5171\u53ea\u6709$n$\u6761\u7537\u751f\u5230\u5973\u751f\u7684\u8fb9\u6709\u6d41\u91cf\u3002\u6240\u4ee5\u5176\u4ed6\u7684\u7537\u751f\u5230\u5973\u751f\u7684\u8fb9\u663e\u7136\u4e0d\u53ef\u80fd\u4e3a\u5fc5\u7ecf\u8fb9\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u7528\u679a\u4e3e\u5220\u9664\u8fd9$n$\u6761\u6709\u6d41\u91cf\u7684\u8fb9\u5373\u53ef\n\n\u6700\u540e\u8d34\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<=b;i++)\n#define N 200\n#define M 20005\nusing namespace std;\nint n,m,s,t,h[N],tot=1,l[N][N],cutx,cuty;\nstruct edge{\n\tint to,nxt,cap,val;\n}e[M<<1],ee[M<<1];\nvoid add(int x,int y,int z,int cost){\n\te[++tot].nxt=h[x];h[x]=tot;e[tot].to=y;e[tot].cap=z;e[tot].val=cost;ee[tot]=e[tot];\n\te[++tot].nxt=h[y];h[y]=tot;e[tot].to=x;e[tot].cap=0;e[tot].val=-cost;ee[tot]=e[tot];\n}\nqueue<int>q;\nint v[N],d[N],pre[N],flow[N];\nbool spfa(){\n\tmemset(v,0,sizeof(v));\n\tmemset(d,0xcf,sizeof(d));\n\tmemset(pre,0,sizeof(pre));\n\tmemset(flow,0,sizeof(flow));\n\twhile(!q.empty())q.pop();\n\tq.push(s);v[s]=1;flow[s]=0x7fffffff;d[s]=0;\n\twhile(!q.empty()){\n\t\tint x=q.front();q.pop();\n\t\tv[x]=0;\n\t\tfor(int i=h[x];i;i=e[i].nxt)if(i^cutx&&i^cuty)if(e[i].cap&&d[x]+e[i].val>d[e[i].to]){\n\t\t\td[e[i].to]=d[x]+e[i].val,flow[e[i].to]=min(flow[x],e[i].cap),pre[e[i].to]=i;\n\t\t\tif(!v[e[i].to])q.push(e[i].to),v[e[i].to]=1;\n\t\t}\n\t}\n\t//cout<<d[t]<<endl;\n\tif(d[t]^0xcfcfcfcf)return true;\n\treturn false;\n}\nint sum,ans;\nvoid updata(){\n\tint now=t;\n\tsum+=flow[now];\n\tans+=flow[now]*d[now];\n\twhile(now){\n\t\te[pre[now]].cap-=flow[t];\n\t\te[pre[now]^1].cap+=flow[t];\n\t\tnow=e[pre[now]^1].to;\n\t}\n}\nsigned main(){\n\tscanf(\"%d\",&n);\n\ts=n+n+1;t=s+1;\n\trep(i,1,n)rep(j,1,n){\n\t\tint x;scanf(\"%d\",&x);\n\t\tadd(i,n+j,1,x);\n\t\tl[i][j]=tot;\n\t}\n\trep(i,1,n)add(s,i,1,0),add(n+i,t,1,0);\n\twhile(spfa())updata();\n\tint last;\n\tprintf(\"%d\\n\",last=ans);\n\trep(i,1,n)rep(j,1,n)if(!e[l[i][j]].cap)l[i][j]=0;\n\trep(i,1,n)rep(j,1,n){\n\t\tif(!l[i][j])continue;\n\t\tcutx=l[i][j];\n\t\tcuty=l[i][j]^1;\n\t\tsum=0;ans=0;\n\t\trep(r,1,tot)e[r]=ee[r];\n\t\twhile(spfa())updata();\n\t\t//cout<<i<<\" \"<<j<<\" \"<<l[i][j]<<\" \"<<sum<<\" \"<<ans<<endl;\n\t\tif(ans<last){printf(\"%d %d\\n\",i,j);break;}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1592124957,
        "uid": 119261,
        "name": "7KByte",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3967 \u3010[TJOI2014]\u5339\u914d\u3011"
    }
]
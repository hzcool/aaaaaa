[
    {
        "content": "\u5199\u4e2a\u6bd4\u8f83\u597d\u61c2\u7684\u9898\u89e3\uff0c\u770b\u5b98\u65b9\u9898\u89e3\u7406\u89e3\u4e86\u534a\u5929\u3002\u3002\u3002\u3002\n\n\u5148\u5199\u4e00\u4e0b\u600e\u4e48\u63a8\u7684\u67ff\u5b50\u3002\uff08\u4e0d\u60f3\u770b\u7684\u53ef\u4ee5\u8df3\u8fc7\uff09\n\n$$\n\\sum_{i=1}^n\\sum_{j=1}^nf(\\gcd(i,j))\n$$\n\n$$\n\\sum_{d=1}^nf(d)\\sum_{i=1}^n\\sum_{j=1}^n[\\gcd(i,j)=d]\n$$\n\n$$\n\\sum_{d=1}^nf(d)\\sum_{i=1}^{\\frac{n}{d}}\\sum_{j=1}^{\\frac{n}{d}}[\\gcd(i,j)=1]\n$$\n\n$$\n\\sum_{d=1}^nf(d)\\sum_{i=1}^{\\frac{n}{d}}\\sum_{j=1}^{\\frac{n}{d}}[\\gcd(i,j)=1]\n$$\n\n$$\n\\sum_{i=1}^{\\frac{n}{d}}\\sum_{j=1}^{\\frac{n}{d}}[\\gcd(i,j)=1]\n$$\n\u8fd9\u4e00\u5768\u6307\u6570\u5f88\u7ecf\u5178\uff0c\u5c31\u662f\u4eea\u4ed7\u961f\u3002\n\n\u6240\u4ee5\u7b54\u6848\u4e3a\n$$\n\\sum_{d=1}^nf(d)(2\\sum_{i=1}^{\\frac{n}{d}}\\varphi(i)-1)\n$$\n\n\u53f3\u8fb9\u8fd9\u4e00\u5768\u76f4\u63a5\u6574\u9664\u5206\u5757\u5957\u675c\u6559\u7b5b\u5373\u53ef\uff0c\u8003\u8651\u600e\u4e48\u5904\u7406 $f$ \u51fd\u6570\u7684\u524d\u7f00\u548c\u3002\n\n\u8fd9\u91cc\u8bb2\u4e24\u4e2a\u601d\u8def\u3002\n\n### Way-1\n\n$f(n) = \\max(m-g(n)+1,0) n^k$ \u4e2d\u8fd9\u5768 $\\max(m-g(n)+1,0)$ \u6307\u6570\u5f88\u6076\u5fc3\uff0c\u8ba9\u4eba\u65e0\u4ece\u4e0b\u624b\uff0c\u4f46\u53d1\u73b0 $g(n)$ \u7684\u6700\u5927\u503c\u6700\u591a\u53ea\u4e3a $\\log_2(n)$\uff0c\u4e8e\u662f\u8003\u8651\u679a\u4e3e $g(n)$ \u7684\u503c $u$\u3002\n\n\u95ee\u9898\u4f20\u5316\u4e3a\u600e\u4e48\u5feb\u901f\u6c42\n\n$$\n\\sum_{i=1}^n[g(i)=u]i^k\n$$\n\n\u8fd9\u4e1c\u897f\u4e0d\u597d\u6c42\uff0c\u8003\u8651\u8f6c\u5316\u3002\n\n$$\n\\sum_{i=1}^n[g(i)=u]i^k=\\sum_{i=1}^n[g(i)\\le u]i^k-\\sum_{i=1}^n[g(i)\\lt u]i^k\n$$\n\n\u8fd9\u4e1c\u897f\u8003\u8651\u7528 min_25 \u76f4\u63a5\u6c42\uff0c\u7b80\u76f4\u5c31\u662f min_25 \u677f\u5b50\u9898\uff0c\u76f4\u63a5\u6539\u4e00\u6539 S \u6c42\u548c\u51fd\u6570\u91cc\u7684\u9650\u5236\u6761\u4ef6\u5c31\u884c\uff0c\u7136\u540e\u5dee\u5206\u76f4\u63a5\u4e58\u4e0a\u7cfb\u6570\u7b54\u6848\u5c31\u51fa\u6765\u4e86\uff0c**\u7406\u8bba\u65f6\u95f4\u590d\u6742\u5ea6** $\\mathcal{O}(\\sqrt{n}+kn+n^{\\frac{3}{4}}+n^{\\frac{2}{3}})$\u3002\n\n\u4f46\u662f\uff0c\u8fd9\u4e2a\u4e1c\u897f\u6211\u5199\u4e86\u4e00\u4e0b\uff0c\u8dd1 $2\\times 10^9$ \u672c\u5730\u90fd\u8981\u8dd1 15S \u5de6\u53f3\uff0c$10^{10}$ \u76f4\u63a5 T \u7206\uff0c\u53cd\u6b63\u6211\u7684\u4ee3\u7801\u662f\u8fc7\u4e0d\u4e86\u7684 ~~\uff08\u53ef\u80fd\u662f\u6211\u5199\u7684\u592a\u4e11\u4e86\uff09~~\uff0c~~\u6709\u5174\u8da3\u7684\u540c\u5b66\u53ef\u4ee5\u53bb\u5199\u4e00\u5199\uff0c\u8981\u662f\u8fc7\u4e86 @ \u6211\u4e00\u4e0b~~\u3002\n\n\u4e0d\u8fc7\u8fd9\u73a9\u610f\u4e0d\u77e5\u9053\u80fd\u4e0d\u80fd\u7528\u65b0\u7248\u7684 min_25 \u7b5b\u53bb\u641e\uff0c\u8981\u662f\u80fd\u884c\u7684\u8bdd\u5e94\u8be5\u80fd\u8fc7\uff0c\u53cd\u6b63\u6211\u6ca1\u8bd5\u8fc7\uff0c\u7406\u8bba\u590d\u6742\u5ea6\u5e94\u8be5\u4f1a\u53d8\u4e3a $\\mathcal{O(n^{\\frac{2}{3}}}\\log n)$\u3002\n\n### Way-2\n\n~~\u8fd8\u662f\u4e0d\u8981\u641e\u7740\u8fd9\u4e9b\u6b6a\u95e8\u90aa\u9053\uff0c\u8981\u60f3\u6b63\u89e3\uff0c\u8fd9\u9898\u600e\u4e48\u53ef\u80fd\u8fd9\u4e48\u7b80\u5355\u3002~~\n\n\u540c\u6837\u7684\u8ddf\u4e0a\u9762\u7684\u601d\u8def\u4e00\u6837\uff0c\u679a\u4e3e $g(n)$ \u7684\u503c $u$\u3002\n\n\u5c06 $f(n)$ \u7684\u7cfb\u6570\u641e\u4e00\u4e0b\u4e8b\u60c5\uff0c$f(n)$ \u53d8\u4e3a $\\max((m+1)-g(n),0)n^k$\u3002\n\n\u8fd9\u542f\u53d1\u6211\u4eec\u53ef\u4ee5\u8f6c\u5316\u95ee\u9898\uff0c\u5148\u7b97\u51fa\u6240\u6709\u7684\u8d21\u732e\uff0c\u5728\u51cf\u53bb\u4e0d\u5e94\u8be5\u6709\u7684\u8d21\u732e\u3002\n\n\u5f62\u8c61\u5316\u7684\u8868\u8fbe\u5373\n$$\n\\sum_{i=1}^n f(i)=(m+1)\\sum_{i=1}^ni^k-\\sum_{u=1}^{\\min(m+1,\\log_2(n))}\\sum_{i=1}^n[u\\le g(i)]i^k\n$$\n\u524d\u9762\u7684\u67ff\u5b50\u5c31\u662f\u81ea\u7136\u6570\u5e42\u548c\uff0c\u4f2f\u52aa\u5229\u6570\uff0c\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u76f4\u63a5\u641e\uff0c\u63a8\u4e00\u63a8\u540e\u9762\u7684\u67ff\u5b50\u3002\n$$\n\\sum_{u=1}^{\\min(m+1,\\log_2(n))}\\sum_{i=1}^n[u\\le g(i)]i^k\n$$\n\n\u4efb\u610f\u4e00\u4e2a\u6b63\u6574\u6570\u7684 $g(i)$ \u90fd\u662f\u5927\u4e8e\u7b49\u4e8e $1$\uff08\u9898\u76ee\u4e2d\u7279\u6b8a\u89c4\u5b9a\u4e86 $g(1)=1$\uff09\uff0c\u6240\u4ee5\u53ef\u4ee5\u62c6\u4e00\u4e0b\u67ff\u5b50\u3002\n\n$$\n\\sum_{u=2}^{\\min(m+1,\\log_2(n))}\\sum_{i=1}^n[u\\le g(i)]i^k+\\sum_{i=1}^ni^k\n$$\n\n\u7136\u540e\u6765\u770b\u524d\u9762\u8fd9\u4e00\u5768\u67ff\u5b50\u3002\n\n$$\n\\sum_{u=2}^{\\min(m+1,\\log_2(n))}\\sum_{i=1}^n[u\\le g(i)]i^k\n$$\n\n\u8003\u8651\u505a\u5bb9\u65a5\uff0c\u679a\u4e3e\u4e00\u4e9b\u8d28\u56e0\u5b50\u5f3a\u5236\u5927\u4e8e\u7b49\u4e8e $u$\u3002\n\n$$\n\\sum_{u=2}^{\\min(m+1,\\log_2(n))}\\sum_{i=1}^n[u\\le g(i)]i^k=-\\sum_{u=2}^{\\min(m+1,\\log_2(n))}\\sum_{p=2}^{\\sqrt[u]{n}}\\mu(p)\\sum_{i=1}^{\\lfloor\\frac{n}{p^u}\\rfloor}(ip^u)^k\n$$\n\n\u7136\u540e\u79fb\u9879\u3002\n$$\n\\sum_{u=2}^{\\min(m+1,\\log_2(n))}\\sum_{p=2}^{\\sqrt[u]{n}}\\mu(p)p^u\\sum_{i=1}^{\\lfloor\\frac{n}{p^u}\\rfloor}i^k\n$$\n\n\u53d1\u73b0\u8fd9\u4e1c\u897f\u53ef\u4ee5\u76f4\u63a5\u7b97\uff0c\u540e\u9762\u90a3\u4e00\u5768\u5c31\u662f\u81ea\u7136\u6570\u5e42\u548c\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5bf9 $n$ \u6574\u9664\u5206\u5757\u5f97\u5230\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a $i$\uff0c$\\lfloor\\dfrac{n}{i}\\rfloor$ \u7684\u503c\uff0c\u7136\u540e\u5957\u4e0a\u6c42\u81ea\u7136\u6570\u5e42\u548c\u7684\u677f\u5b50\u76f4\u63a5\u9884\u5904\u7406\u51fa\u6765\uff0c\u7136\u540e\u6bcf\u6b21 $\\mathcal{O(1)}$ \u7528\u5c31\u884c\u4e86\u3002\n\n\u81f3\u4e8e\u6bcf\u6b21\u6c42\u524d\u7f00\u548c\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5927\u7ea6\u5728 $\\mathcal{O(\\sqrt{n})}$\uff0c~~\u81f3\u4e8e\u8bc1\u660e\u6211\u4e0d\u4f1a\uff0c\u6211\u53ef\u662f\u4e2a\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u767d\u75f4\u3002~~\n\n#### \u5173\u4e8e\u4e3a\u5565\u8fd9\u4e2a\u5f0f\u5b50\u662f\u6b63\u786e\u7684\u3002\n\n$$\n\\sum_{i=1}^n[u\\le g(i)]i^k=-\\sum_{p=2}^{\\sqrt[u]{n}}\\mu(p)\\sum_{i=1}^{\\lfloor\\frac{n}{p^u}\\rfloor}(ip^u)^k\n$$\n\n\u6211\u6765\u89e3\u91ca\u4e00\u4e0b\uff0c\u56e0\u4e3a\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u5c31\u76f8\u5f53\u4e8e\u662f\u4e2a\u5bb9\u65a5\uff0c\u5f53 $p$ \u6709\u591a\u4e2a\u91cd\u590d\u7684\u8d28\u56e0\u5b50\u662f\u503c\u4e3a $0$\uff0c\u4e8e\u662f\u76f8\u5f53\u4e8e\u679a\u4e3e\u7684\u4e0d\u540c\u8d28\u56e0\u5b50\u7684\u4e58\u79ef\u3002\n\n\u4e3e\u4e2a\u901a\u4fd7\u6613\u61c2\u7684\u6817\u5b50\u6765\u8bf4\u660e\u4e00\u4e0b\u8fd9\u4e2a\u5f0f\u5b50\uff0c$\\mu(2)=-1$\uff0c$\\mu(3)=-1$\uff0c$\\mu(6)=1$\uff0c\u5f53 $p=2$ \u65f6\uff0c\u6211\u51cf\u53bb\u4e86\u6709\u8d28\u56e0\u5b50 $2$ \u7684\u6b21\u6570\u5927\u4e8e\u7b49\u4e8e $u$ \u7684\u6570\u7684\u8d21\u732e\uff0c\u5f53 $p=3$ \u65f6\uff0c\u6211\u51cf\u53bb\u4e86\u6709\u8d28\u56e0\u5b50 $3$ \u7684\u6b21\u6570\u5927\u4e8e\u7b49\u4e8e $u$ \u7684\u6570\u7684\u8d21\u732e\uff0c\u4f46\u662f\u4f60\u4f1a\u53d1\u73b0\u6211\u51cf\u591a\u4e86\uff0c\u5bf9\u4e8e\u5f62\u5982 $i6^u$ \u7684\u6570\u6211\u4eec\u4f1a\u51cf\u53bb\u4e24\u6b21\uff0c\u4e8e\u662f\u9700\u8981\u52a0\u56de\u6765\u3002\n\n\u5982\u679c\u8fd8\u4e0d\u61c2\u7684\u8bdd\u53ef\u4ee5\u53bb\u641c\u4e00\u641c\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u4e0e\u5bb9\u65a5\uff0c~~\u5305\u770b\u5305\u61c2~~\u3002\n\n\u4ee3\u7801\n```cpp\n#include <cstdio>\n#include <map>\n#include <iostream>\n#include <algorithm>\n#include <queue>\n#include <cstring>\n#include <cmath>\n#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/pb_ds/hash_policy.hpp>\nusing namespace std;\nusing namespace __gnu_pbds;\n#define LL long long\n#define int long long\nconst int mod = 998244353;\nconst int inv2 = 499122177;\nint dec(int x, int y) { return x >= y ? x - y : x + mod - y; }\nint mul(int x, int y) { return 1ll * x * y % mod; }\nint add(int x, int y) {\n    if (x + y >= mod)\n        return x + y - mod;\n    return x + y;\n}\nint qkpow(LL a, int b) {\n    int res = 1;\n    for (; b; b >>= 1, a = mul(a, a))\n        if (b & 1)\n            res = mul(res, a);\n    return res;\n}\nint sq, size, cnt;\nint m, k, prime[10000005], id1[1000005], id2[1000005], Str[105][105], fk[10000005];\nint h[1000005], hprime[2000005], phi[10000005], mn[10000005], mx[10000005], pw[10000005], f[10000005],\n    inv[205];\nint mu[200005], fs[200005];\nLL n, num[1000005];\nbool vis[10000005];\n\ngp_hash_table<LL, int> Phi;\n\nint Id(LL x) {\n    if (x == 0)\n        return 0;\n    return (x <= sq ? id1[x] : id2[n / x]);\n}\n\nint S(LL n) {\n    if (n == 1)\n        return m;\n    if (n <= 10000000)\n        return f[n];\n    if (fs[Id(n)])\n        return fs[Id(n)];\n    int maxg = log2(n) + 1;\n    int tot = mul(m, h[Id(n)]);\n    for (int p = 2; 1ll * p * p <= n; p++) {\n        if (mu[p]) {\n            int pkx = mul(pw[p], pw[p]);\n            LL anopkx = 1ll * p * p;\n            for (int u = 2; anopkx <= n && u <= min(m + 1, maxg);\n                 u++, pkx = mul(pkx, pw[p]), anopkx = 1ll * anopkx * p) {\n                int now = mul(mu[p], pkx);\n                tot = add(tot, mul(now, h[Id(n / anopkx)]));\n            }\n        }\n    }\n    return fs[Id(n)] = tot;\n}\n\nint calcphi(LL n) {\n    if (n <= 10000000)\n        return phi[n];\n    if (Phi[n])\n        return Phi[n];\n    int res = mul(n % mod, add(n, 1) % mod);\n    res = mul(res, inv2);\n    for (LL i = 2, j; i <= n; i = j + 1) {\n        j = n / (n / i);\n        res = dec(res, mul(dec(add(j % mod, 1) % mod, i % mod), calcphi(n / i)));\n    }\n    return Phi[n] = res;\n}\n\nsigned main() {\n    scanf(\"%lld %lld %lld\", &n, &m, &k);\n    for (int i = 1; i <= k + 2; i++) inv[i] = qkpow(i, mod - 2);\n    Str[0][0] = 1;\n    for (int i = 1; i <= k; i++)\n        for (int j = 1; j <= k; j++) Str[i][j] = add(Str[i - 1][j - 1], mul(j, Str[i - 1][j]));\n    sq = sqrt(n * 1.0);\n    phi[1] = 1, f[1] = m, pw[1] = 1;\n    for (int i = 2; i <= 10000000; i++) {\n        if (!vis[i])\n            prime[++cnt] = i, phi[i] = i - 1, pw[i] = qkpow(i, k), mn[i] = mx[i] = 1;\n        for (int j = 1; j <= cnt && prime[j] * i <= 10000000; j++) {\n            vis[i * prime[j]] = 1;\n            pw[i * prime[j]] = mul(pw[i], pw[prime[j]]);\n            if (i % prime[j] == 0) {\n                mn[i * prime[j]] = mn[i] + 1, mx[i * prime[j]] = max(mx[i], mn[i] + 1);\n                phi[i * prime[j]] = phi[i] * prime[j];\n                break;\n            }\n            mn[i * prime[j]] = 1, mx[i * prime[j]] = mx[i];\n            phi[i * prime[j]] = phi[i] * (prime[j] - 1);\n        }\n        f[i] = add(f[i - 1], mul(pw[i], max(m - mx[i] + 1, 0ll))) % mod;\n        phi[i] = add(phi[i], phi[i - 1]);\n    }\n    for (int i = 1; i <= sq; i++) vis[i] = 0;\n    cnt = 0;\n    mu[1] = 1;\n    for (int i = 2; i <= sq; i++) {\n        if (!vis[i])\n            mu[i] = -1, prime[++cnt] = i, fk[cnt] = pw[i], hprime[cnt] = add(hprime[cnt - 1], fk[cnt]);\n        for (int j = 1; j <= cnt && prime[j] * i <= sq; j++) {\n            vis[i * prime[j]] = 1;\n            if (i % prime[j] == 0) {\n                mu[i * prime[j]] = 0;\n                break;\n            }\n            mu[i * prime[j]] = -mu[i];\n        }\n    }\n    for (int i = 1; i <= sq; i++) mu[i] = (mu[i] == -1 ? mod - 1 : mu[i]);\n    for (LL l = 1, r; l <= n; l = r + 1) {\n        r = n / (n / l);\n        num[++size] = n / r;\n        LL Num = n / r % mod;\n        int prod = 1;\n        for (int i = 0; i <= k; ++i)\n            prod = mul((Num + 1 - i) % mod, prod),\n            h[size] = add(h[size], mul(mul(Str[k][i], prod), inv[i + 1]));\n        if (n / r <= sq)\n            id1[n / r] = size;\n        else\n            id2[r] = size;\n    }\n    int tot = 0, lstans = 0;\n    for (LL l = 1, r; l <= n; l = r + 1) {\n        r = n / (n / l);\n        int phisum = dec(mul(2, calcphi(n / r)), 1), ano, fsum = S(r);\n        ano = fsum;\n        fsum = dec(fsum, lstans);\n        lstans = ano;\n        tot = add(tot, mul(fsum, phisum));\n    }\n    printf(\"%lld\\n\", tot);\n    return 0;\n}\n```",
        "postTime": 1611126520,
        "uid": 154560,
        "name": "Silver187",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P7277 \u3010\u5e73\u51e1\u70b9\u6ef4\u3011"
    },
    {
        "content": "\u672c\u6587\u540c\u6b65\u53d1\u8868\u4e8e\u6211\u7684\u535a\u5ba2\uff1a<https://www.alpha1022.me/articles/lg-7277.htm>\u3002\n\n\u9996\u5148\u663e\u7136\u5730\uff0c\u6709\u7b54\u6848\u4e3a\n$$\n\\sum\\limits_{d=1}^n f(d) \\left(2\\sum\\limits_{i=1}^{\\left\\lfloor\\frac nd\\right\\rfloor} \\varphi(i) - 1\\right)\n$$\n\n\u675c\u6559\u7b5b / Min_25 \u7b5b\u4e00\u4e0b\uff0c\u90a3\u4e48\u95ee\u9898\u53d8\u4e3a\u6c42 $f(i)$ \u7684\u524d\u7f00\u548c\u3002  \n\u8bbe $s(n) = \\sum\\limits_{i=1}^n f(i)$\u3002\n\n\u89c2\u5bdf\u5230 $f(n)$ \u5b9e\u9645\u4e0a\u5e76\u4e0d\u597d\u5904\u7406\uff0c\u8003\u8651\u628a\u90a3\u4e2a $\\max(m-g(n)+1,0)$ \u7684\u7cfb\u6570\u5904\u7406\u4e00\u4e0b\uff1a\n$$\nf(n) = \\sum\\limits_{u=1}^m [g(n) \\le u] n^k\n$$\n\n\u4f46\u662f $m$ \u53ef\u80fd\u5f88\u5927\u3002  \n\u7136\u800c\u6ce8\u610f\u5230 $g(n) \\le \\log_2 n$\uff0c\u6240\u4ee5\u53ef\u4ee5\u628a $m$ \u964d\u5230 $O(\\log n)$ \u7ea7\u522b\uff0c\u8d85\u51fa\u90e8\u5206\u76f4\u63a5\u7b97\u4e00\u4e0b\u81ea\u7136\u6570\u5e42\u548c\u5373\u53ef\u3002\n\n\u5219\n$$\n\\begin{aligned}\ns(n)\n&= \\sum\\limits_{i=1}^n f(i) \\\\\n&= \\sum\\limits_{i=1}^n \\sum\\limits_{u=1}^m [g(i) \\le u] i^k \\\\\n&= \\sum\\limits_{u=1}^m \\sum\\limits_{i=1}^n [g(i) \\le u] i^k\n\\end{aligned}\n$$\n\n\u8003\u8651\u6c42 $\\sum\\limits_{i=1}^n [g(i) \\le u]i^k$\u3002  \n\u8fd9\u53ef\u4ee5\u8003\u8651\u5bb9\u65a5\uff0c\u5373\u679a\u4e3e\u67d0\u4e9b\u8d28\u56e0\u5b50\uff0c\u4f7f\u5b83\u4eec\u7684\u6307\u6570\u5f3a\u5236\u8d85\u8fc7 $u$\u3002  \n\u5219\n$$\n\\begin{aligned}\n\\sum\\limits_{i=1}^n [g(i) \\le u]i^k\n&= \\sum\\limits_{p=1}^{\\lfloor n^{1/(u+1)}\\rfloor} \\mu(p) \\sum\\limits_{i=1}^{\\left\\lfloor\\frac n{p^{u+1}}\\right\\rfloor} (ip^{u+1})^k \\\\\n&= \\sum\\limits_{p=1}^{\\lfloor n^{1/(u+1)}\\rfloor} \\mu(p) p^{(u+1)k} \\sum\\limits_{i=1}^{\\left\\lfloor\\frac n{p^{u+1}}\\right\\rfloor} i^k\n\\end{aligned}\n$$\n\n\u7136\u540e\u6ce8\u610f\u5230 $\\sum\\limits_{u=1}^m O(n^{1/(u+1)}) = O(\\sqrt n)$\uff0c\u6240\u4ee5\u5bf9\u4e8e $u=1,\\dots, m$ \u5982\u6b64\u8ba1\u7b97\u4e00\u6b21\u7684\u590d\u6742\u5ea6\u662f $O(\\sqrt n)$ \u7684\u3002  \n\u53e6\u5916\u53ef\u4ee5\u901a\u8fc7\u7ebf\u7b5b $g(n)$ \u9884\u5904\u7406\u51fa\u4e00\u5b9a\u8303\u56f4\u5185\u7684 $s(n)$\u3002  \n\u4e8e\u662f\u6839\u636e\u675c\u6559\u7b5b\u7684\u601d\u60f3\uff0c\u5e73\u8861\u81f3 $O(n^{2/3})$ \u5373\u53ef\u3002\n\n\u4e0d\u8fc7\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u90a3\u5c31\u662f\u8ba1\u7b97\u81ea\u7136\u6570 $k$ \u6b21\u5e42\u548c\u3002  \n\u8fd9\u662f\u4e00\u4e2a\u7ecf\u5178\u95ee\u9898\uff0c\u5bb9\u6613\u53d1\u73b0\u9700\u8981\u8ba1\u7b97\u7684\u4f4d\u7f6e\u53ea\u6709 $O(\\sqrt n)$ \u79cd\uff0c\u6709\u5f88\u591a\u65b9\u6cd5\u53ef\u4ee5\u505a\u5230 $O(k^2)$ \u9884\u5904\u7406\u540e $O(k\\sqrt n)$ \u89e3\u51b3\u3002  \n\u6807\u7a0b\u4f7f\u7528\u7684\u662f\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u3002\n\n\u603b\u590d\u6742\u5ea6 $O(k^2 + k\\sqrt n + n^{2/3})$\u3002  \n\u53ef\u80fd\u7565\u5fae\u5361\u5e38\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\nconst long long N = 1e10;\nconst int MX = 5e6;\nconst int LIM = 1e5;\nconst int M = 33;\nconst int K = 100;\nconst int mod = 998244353;\ninline int fpow(int a,int b)\n{\n    int ret = 1;\n    for(;b;b >>= 1)\n        (b & 1) && (ret = (long long)ret * a % mod),a = (long long)a * a % mod;\n    return ret;\n}\nlong long n;\nint lim,m,k;\nint inv[K + 5],S[K + 5][K + 5];\nint vis[MX + 5],cnt,prime[MX + 5];\nint mn[MX + 5],mx[MX + 5],f[MX + 5],phi[MX + 5],mu[MX + 5],pw[MX + 5];\nint le[LIM + 5],ge[LIM + 5],tot;\nint sk[2 * LIM + 5];\ninline int &id(long long x)\n{\n    return x <= lim ? le[x] : ge[n / x];\n}\nint w[2][MX + 5];\ninline int &mem_sphi(long long x)\n{\n    return w[0][n / x];\n}\ninline int &mem_sf(long long x)\n{\n    return w[1][n / x];\n}\nint sphi(long long n)\n{\n    if(n <= MX)\n        return phi[n];\n    if(~mem_sphi(n))\n        return mem_sphi(n);\n    int ret = n & 1 ? ((n + 1 >> 1) % mod) * (n % mod) % mod : ((n >> 1) % mod) * ((n + 1) % mod) % mod;\n    for(register long long l = 2,r;l <= n;l = r + 1)\n    {\n        r = n / (n / l);\n        ret = (ret - (r - l + 1) % mod * sphi(n / l) % mod + mod) % mod;\n    }\n    return mem_sphi(n) = ret;\n}\nint sf(long long n)\n{\n    if(n <= MX)\n        return f[n];\n    if(~mem_sf(n))\n        return mem_sf(n);\n    int ret = m > M ? (long long)(m - M) * sk[id(n)] % mod : 0;\n    for(register int i = 1;(long long)i * i <= n;++i)\n        if(mu[i])\n        {\n            long long j = n / i / i;\n            int s = (long long)pw[i] * pw[i] % mod;\n            for(register int u = 1;u <= min(m,M) && j;++u,j /= i,s = (long long)s * pw[i] % mod)\n                ret = (ret + (long long)s * mu[i] % mod * sk[id(j)]) % mod;\n        }\n    return mem_sf(n) = ret;\n}\nint ans;\nint main()\n{\n    memset(w,-1,sizeof w);\n    scanf(\"%lld%d%d\",&n,&m,&k),lim = sqrt(n);\n    inv[1] = 1;\n    for(register int i = 2;i <= k + 1;++i)\n        inv[i] = (long long)(mod - mod / i) * inv[mod % i] % mod;\n    S[0][0] = 1;\n    for(register int i = 1;i <= k;++i)\n        for(register int j = 1;j <= k;++j)\n            S[i][j] = (S[i - 1][j - 1] + (long long)j * S[i - 1][j]) % mod;\n    phi[1] = mu[1] = pw[1] = 1,f[1] = m;\n    for(register int i = 2;i <= MX;++i)\n    {\n        if(!vis[i])\n            mn[prime[++cnt] = i] = mx[i] = 1,phi[i] = i - 1,mu[i] = mod - 1,pw[i] = fpow(i,k);\n        for(register int j = 1;j <= cnt && i * prime[j] <= MX;++j)\n        {\n            vis[i * prime[j]] = 1,pw[i * prime[j]] = (long long)pw[i] * pw[prime[j]] % mod;\n            if(!(i % prime[j]))\n            {\n                mn[i * prime[j]] = mn[i] + 1,mx[i * prime[j]] = max(mx[i],mn[i] + 1),phi[i * prime[j]] = phi[i] * prime[j];\n                break;\n            }\n            mn[i * prime[j]] = 1,mx[i * prime[j]] = mx[i],phi[i * prime[j]] = phi[i] * (prime[j] - 1),mu[i * prime[j]] = (mod - mu[i]) % mod;\n        }\n        f[i] = (f[i - 1] + (long long)pw[i] * max(m - mx[i] + 1,0)) % mod,\n        phi[i] = (phi[i] + phi[i - 1]) % mod;\n    }\n    for(register long long l = 1,r;l <= n;l = r + 1)\n    {\n        r = n / (n / l);\n        id(n / l) = ++tot;\n        int prod = 1;\n        for(register int i = 0;i <= k;++i)\n            prod = (n / l + 1 - i) % mod * prod % mod,\n            sk[tot] = (sk[tot] + (long long)S[k][i] * prod % mod * inv[i + 1]) % mod;\n    }\n    for(register long long l = 1,r;l <= n;l = r + 1)\n    {\n        r = n / (n / l);\n        ans = (ans + (2LL * sphi(n / l) - 1 + mod) * (sf(r) - sf(l - 1) + mod)) % mod;\n    }\n    printf(\"%d\\n\",ans);\n}\n```",
        "postTime": 1610865241,
        "uid": 75840,
        "name": "deserter",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P7277 \u3010\u5e73\u51e1\u70b9\u6ef4\u3011"
    }
]
[
    {
        "content": "\u8868\u793a\u6b63\u89e3\u4e3a\u4ec0\u4e48\u662f$O(4^{n})$\u554a\u2026\u2026\n\n\u660e\u660e\u53ef\u4ee5\u505a\u5230$O(3^n)$\u554a\u2026\u2026\n\n\u611f\u89c9\u90a3\u4e2adp\u505a\u6cd5\u5341\u5206\u5947\u602a\u2026\u2026\u540c\u65f6\u51ed\u501f$O(2^{n})$\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u62ff\u4e86rk1\uff1f\n\n# \u5bb9\u65a5\u539f\u7406\n\n\u770b\u5230\u8ba1\u6570\u60f3\u5bb9\u65a5\u2026\u2026\u57fa\u672c\u6765\u8bb2\u8fd9\u79cd\u7384\u5b66\u7684\u8ba1\u6570\u9898\u5c31\u662f\u5bb9\u65a5\u5b9a\u7406\u6ca1\u8dd1\u4e86\u2026\u2026\n\n\u9996\u5148\u6211\u4eec\u53d1\u73b0\u77e9\u9635\u4e2d\u4e00\u4e2a\u70b9\u80af\u5b9a\u6709\u4e00\u4e2a\u53d6\u503c\u8303\u56f4\n\n\u8303\u56f4\u662f$[1,min(min(v_{i}),m)]$\u5176\u4e2di\u662f\u8986\u76d6\u4e86\u8fd9\u4e2a\u70b9\u7684\u77e9\u9635\uff0c\u56e0\u4e3a\u5462\uff0c\u5982\u679c\u8fd9\u4e2a\u70b9\u7684\u53d6\u503c\u5927\u8fc7\u4e86v\u7684\u6700\u5c0f\u503c\uff0c\u5bf9\u5e94\u5b50\u77e9\u9635\u7684\u9650\u5236\u5c31\u4e0d\u6ee1\u8db3\u4e86\n\n\u7136\u540e\u503c\u57df\u76f8\u540c\u7684\u70b9\u4f1a\u8fde\u6210\u4e00\u4e9b\u5947\u5f62\u602a\u72b6\u7684\u56fe\u6848(\u5f53\u7136\uff0c\u4e0d\u4e00\u5b9a\u5168\u90e8\u76f8\u8fde)\n\n\u6211\u4eec\u4ed4\u7ec6\u89c2\u5bdf\u8fd9\u4e2a\u56fe\u5f62\uff0c**\u53d1\u73b0\u503c\u57df\u4e0d\u540c\u7684\u70b9\u4e4b\u95f4\u7684\u53d6\u503c\u65e0\u5173\u3002**\n\n\u8fd9\u4e2a\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f\n\n\u5982\u679c\u4e24\u4e2a\u70b9a,b\u503c\u57df\u4e0d\u540c\u7684\u8bdd\uff0ca\u53d6\u5230\u503c\u57df\u7684max\uff0c\u6240\u6ee1\u8db3\u7684\u5b50\u77e9\u9635(\u4eec)\uff0c\u548cb\u53d6\u5230\u503c\u57df\u7684max\u6240\u6ee1\u8db3\u7684\u5b50\u77e9\u9635(\u4eec)\u80af\u5b9a\u4e0d\u540c\uff0c\u6ca1\u6709\u4ec0\u4e48\u65e2\u7136a\u53d6\u4e86max\u90a3\u4e48b\u5c31\u53ef\u4ee5\u968f\u4fbf\u53d6\u4e86\u8fd9\u4e2a\u8bf4\u6cd5\u3002\n\n\u6240\u4ee5a\u53d6\u4ec0\u4e48\u503c\u548cb\u53d6\u4ec0\u4e48\u503c\u6839\u672c\u6ca1\u6709\u4efb\u4f55\u5173\u7cfb~\n\n\u90a3\u4e48\u65e2\u7136\u662f\u72ec\u7acb\u4e8b\u4ef6\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e58\u6cd5\u539f\u7406~\n\n\u56e0\u6b64\u5206\u522b\u6c42\u51fa\u6bcf\u4e2a\u503c\u57df\u7684\u65b9\u6848\u6570\uff0c\u6700\u540e\u4e58\u8d77\u6765\u5c31\u662f\u7b54\u6848\u4e86\uff01\n\n### \u6c42\u67d0\u4e00\u4e2a\u503c\u57df\u7684\u65b9\u6848\u6570\n\n(\u6211\u77e5\u9053\u80e1\u4e71\u8bbe\u4e00\u5806\u53d8\u91cf\u5341\u5206\u96be\u7406\u89e3\uff0c\u4f46\u662f\u7684\u786e\u4e0d\u662f\u5f88\u597d\u8bf4)\n\n\u90a3\u4e48\u6211\u4eec\u4f1a\u53d1\u73b0\u5462\uff0c\u53ef\u80fd\u6709\u591a\u4e2a\u77e9\u9635\u7684\u503c\u57df\u76f8\u540c\uff0c\u90a3\u4e48\u8bbe\u503c\u57df\u6700\u5927\u503c\u4e3ak\u7684**\u70b9**\u6784\u6210\u4e00\u4e2a\u96c6\u5408$S_{k}$\uff0c\u91cc\u9762\u7684\u70b9\u53ef\u4ee5\u6ee1\u8db3\u7684\u5b50\u77e9\u9635\u6682\u4e14\u8bb0\u4e3a1\uff0c2\uff0c3\u2026\u2026\u53f7\u77e9\u9635\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5148\u8ba9\u6240\u6709\u7684\u70b9\u968f\u4fbf\u53d6\uff0c\u90a3\u4e48\u603b\u65b9\u6848\u6570\u5c31\u662f$k^{|S_{k}|}$\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u660e\u663e\u591a\u7b97\u4e86\n\n\u6240\u4ee5\u51cf\u53bb1\u53f7\u5b50\u77e9\u9635\u53d6\u4e0d\u5230max\u7684\u60c5\u51b5\uff0c\u8bb0$S_{k}$\u4e2d\u5c5e\u4e8ei\u53f7\u77e9\u9635\u7684\u70b9\u6784\u6210\u4e86\u96c6\u5408$T_{k,i}$\u90a3\u4e48\u603b\u65b9\u6848\u6570\u4e3a$(k-1)^{|T_{k,1}|}k^{|S_{k}|-|T_{k,1}|}$\uff0c\u5c31\u662f\u5c5e\u4e8e\u4e00\u53f7\u77e9\u9635\u7684\u70b9\u4e0d\u53ef\u4ee5\u53d6max\uff0c\u5176\u4ed6\u7684\u70b9\u968f\u4fbf\u53d6\n\n\u7136\u540e\u51cf\u53bb2\u53f7\u5b50\u77e9\u9635\u53d6\u4e0d\u5230max\u7684\u60c5\u51b5\uff0c3\u53f7\u5b50\u77e9\u9635\u53d6\u4e0d\u5230max\u7684\u60c5\u51b5\uff0c\u7b49\u7b49\u2026\u2026\n\n\u53d1\u73b01\uff0c2\u53f7\u5b50\u77e9\u9635\u540c\u65f6\u53d6\u4e0d\u5230max\u7684\u60c5\u51b5\u88ab\u591a\u51cf\u4e86\uff0c\u6240\u4ee5\u51cf\u53bb1\uff0c2\u540c\u65f6\u53d6\u4e0d\u5230max\u7684\u60c5\u51b5\uff0c2\uff0c3\u540c\u65f6\u53d6\u4e0d\u5230max\u7684\u60c5\u51b5\uff0c1\uff0c3\u540c\u65f6\u53d6\u4e0d\u5230max\u7684\u60c5\u51b5\u2026\u2026\u7b49\u7b49\n\n\u53d1\u73b0\u6b64\u65f61\uff0c2\uff0c3\u53f7\u5b50\u77e9\u9635\u540c\u65f6\u53d6\u4e0d\u5230max\u7684\u60c5\u51b5\u88ab\u591a\u52a0\u4e86\uff0c\u6240\u4ee5\u51cf\u53bb1\uff0c2\uff0c3\u540c\u65f6\u53d6\u4e0d\u5230max\u7684\u60c5\u51b5\uff0c\u2026\u2026\u7b49\u7b49\u2026\u2026\n\n\u7136\u540e\u8fd9\u6837\u5c31\u53ef\u4ee5\u5927\u529b\u5bb9\u65a5\u51fa\u6bcf\u4e00\u4e2a\u503c\u57df\u7684\u65b9\u6848\u6570\u4e86\n\n\u5927\u6982\u5c31\u662f\u679a\u4e3ev\u503c\u76f8\u540c\u7684\u77e9\u9635\u96c6\u5408\u7684\u5b50\u96c6\uff0c\u7136\u540e\u52a0\u52a0\u51cf\u51cf\u4ec0\u4e48\u7684\n\n\u95ee\u9898\u6765\u4e86\uff0c\u4e0a\u9762\u8981\u6c42\u6211\u4eec\u8981\u6c42\u51faS\u96c6\u5408\u548cT\u96c6\u5408\u7684siz\u2026\u2026\n\n\u5176\u5b9e\u5c31\u662f\u53ef\u4ee5\u7406\u89e3\u6210v\u503c\u76f8\u540c\u5b50\u77e9\u9635\u77e9\u9635\u7684\u5e76\u96c6\u222a\u6240\u6709\u503c\u5c0f\u4e8e\u5f53\u524dv\u7684\u5b50\u77e9\u9635\u5e76\u96c6-\u6240\u6709\u503c\u5c0f\u4e8ev\u7684\u77e9\u9635\u7684\u5e76\u96c6\n\nT\u96c6\u5408\u7684\u8bdd\u5dee\u4e0d\u591a\uff0c\u5c31\u662f\u628a\u4e0a\u9762\u7684\u201c\u6240\u6709\u201d\u6539\u6210\u5b50\u96c6\u5c31\u53ef\u4ee5\u4e86\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u6c42\u51fa\u8fd9\u4e2a\u96c6\u5408\u7684siz\u4e86\u3002\n\n\u95ee\u9898\u662f\u5982\u4f55\u6c42\u51fa\u6240\u6709\u5e76\u96c6\u7684siz\uff1f\n\n\u663e\u7136\u6240\u6709\u5e76\u96c6\u7684siz\u662f\u53ef\u4ee5\u5bb9\u65a5\u539f\u7406\u66b4\u529b\u505a\u7684\uff0c\u76f4\u63a5\u679a\u4e3e\u5b50\u96c6\u5c31\u597d\u2026\u2026\u7136\u540e$O(3^{n})$\u66b4\u529b\u7684\u679a\u4e3e\u5b50\u96c6\u5927\u529b\u5bb9\u65a5\u5c31\u53ef\u4ee5\u4e86\n\n\u6240\u4ee5\u5f53\u7136\u975e\u5e38\u5feb\u4e86\u2026\u2026\u5c31\u9171\n\n\u4e0a\u4ee3\u7801~\n\n```C\n\n// luogu-judger-enable-o2\n#include<cstdio>\n#include<algorithm>\nusing namespace std;const int N=15;const int M=1050;typedef long long ll;const ll mod=1e9+7;\ninline ll po(ll a,ll p){ll r=1;for(;p;p>>=1,a=a*a%mod){if(p&1){r=r*a%mod;}}return r;}\nint n;int m;ll h;ll w;ll s[M];ll u[M];int up;int siz[M];ll res;int T;\nstruct retc//\u77e9\u5f62\u7c7b \n{\n    ll x;ll y;ll x1;ll y1;int v;\n    inline void rd(){scanf(\"%lld%lld%lld%lld%d\",&x,&y,&x1,&y1,&v);}\n    inline bool ck(){return (x>x1)||(y>y1);}//\u662f\u5426\u4e3a\u7a7a \n    inline ll calcs(){return (x1-x+1)*(y1-y+1);}//\u6c42\u9762\u79ef \n    void operator &=(const retc& a)//\u4ea4 \n    {x=max(x,a.x);y=max(y,a.y);x1=min(x1,a.x1);y1=min(y1,a.y1);}\n    friend bool operator <(retc a,retc b){return a.v<b.v;}\n}r[N],tr;\ninline void solve()\n{\n    scanf(\"%lld%lld%d%d\",&h,&w,&m,&n);\n    for(int i=0;i<n;i++){r[i].rd();}sort(r,r+n);up=(1<<n)-1;\n    for(int i=1;i<=up;i++)//\u66b4\u529b\u6c42\u4ea4\u96c6\u9762\u79ef \n    {\n        tr.x=1;tr.y=1;tr.x1=h;tr.y1=w;\n        for(int p=i,j=0;p;p>>=1,j++){if(p&1){tr&=r[j];if(tr.ck()){s[i]=0;goto ed;}}}\n        s[i]=tr.calcs();ed:;\n    }\n    for(int i=1;i<=up;i++)//\u66b4\u529b\u6c42\u5e76\u96c6\u9762\u79ef \n    {\n        for(int j=i;j;j=(j-1)&i)\n        {if(siz[j]%2){u[i]+=s[j];}else {u[i]-=s[j];}}\n    }\n    int ns=0;int ls=0;res=1;\n    for(int i=0;i<n;i++)//\u5206\u503c\u57df\u7edf\u8ba1\u65b9\u6848\u6570 \n    {\n        ns|=(1<<i);if(r[i].v==r[i+1].v){continue;}\n        ll tot=u[ns|ls]-u[ls];ll st=tot;ll ret=po(r[i].v,tot);\n        for(int k=ns;k;k=(k-1)&ns)\n        {\n            tot=u[k|ls]-u[ls];\n            ll del=po(r[i].v-1,tot)*po(r[i].v,st-tot)%mod;\n            if(siz[k]%2){ret=(ret+mod-del)%mod;}\n            else {ret=(ret+del)%mod;}\n        }res=res*ret%mod;ls|=ns;ns=0;//\u4e58\u8d77\u6765\t\n    }printf(\"%lld\\n\",res*po(m,h*w-u[up])%mod); \n}\ninline void clear(){for(int i=0;i<=up;i++){u[i]=0;}}\nint main()\n{\n    for(int i=1;i<=1023;i++){siz[i]=siz[i>>1]+(i&1);}scanf(\"%d\",&T);\n    for(int z=1;z<=T;z++){solve();clear();}return 0;//\u62dc\u62dc\u7a0b\u5e8f~ \n}\n\n```\n\n\n\n\n\n\n",
        "postTime": 1523967063,
        "uid": 56384,
        "name": "shadowice1984",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3813 \u3010[FJOI2017]\u77e9\u9635\u586b\u6570\u3011"
    },
    {
        "content": "**Update On 2020.3.6\uff1a\u4fee\u590d\u4e86\u4e00\u4e9b\u7ec6\u8282\u95ee\u9898**\n\n---\n\n\u201c\u5b50\u77e9\u9635\u6700\u5927\u503c\u7b49\u4e8e $v$ \u201d\u7684\u65b9\u6848\u6570\u7b49\u4e8e\u201c\u5b50\u77e9\u9635\u6700\u5927\u503c\u5c0f\u4e8e\u7b49\u4e8e$v$\u7684\u65b9\u6848\u6570\u201d\u51cf\u53bb\u201c\u5b50\u77e9\u9635\u6700\u5927\u503c\u5c0f\u4e8e $v$ \u7684\u65b9\u6848\u6570\u201d\uff0c\u8003\u8651\u5bb9\u65a5\u3002$2^n$ \u5730\u679a\u4e3e\u54ea\u4e9b\u5b50\u77e9\u9635\u6ee1\u8db3\u6700\u5927\u503c\u5c0f\u4e8e $v$\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u77e9\u9635\u4e2d\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\u80fd\u591f\u53d6\u5230\u7684\u6700\u5927\u503c\uff0c\u8bbe $x_{i,j}$ \u8868\u793a $(i,j)$ \u7684\u6700\u5927\u53d6\u503c\uff0c\u90a3\u4e48\u65b9\u6848\u6570\u5c31\u662f $\\prod\\limits_{i=1}^H \\prod\\limits_{j=1}^W x_{i,j}$\u3002\n\n\u590d\u6742\u5ea6 $O(2^nHW)$ \u4e0d\u80fd\u63a5\u53d7\u3002\u53d1\u73b0\u77e9\u5f62\u4e2a\u6570\u5f88\u5c11\uff0c\u6240\u4ee5\u6709\u5927\u91cf\u7684\u4f4d\u7f6e\u53d6\u5230\u7684\u6700\u5927\u503c\u76f8\u7b49\u3002\u53ef\u4ee5\u5bf9\u6a2a\u7eb5\u5750\u6807\u79bb\u6563\u5316\uff0c\u5904\u7406\u51fa\u4e00\u4e9b\u5b50\u77e9\u5f62\u6ee1\u8db3\u65e0\u8bba\u5982\u4f55\u8fd9\u4e2a\u5b50\u77e9\u5f62\u5185\u90e8\u7684\u6700\u5927\u503c\u5747\u76f8\u7b49\u3002\u56e0\u4e3a\u6a2a\u7eb5\u5750\u6807\u90fd\u53ea\u6709 $O(n)$ \u79cd\uff0c\u6240\u4ee5\u4e00\u5171\u6709 $O(n^2)$ \u4e2a\u8fd9\u6837\u7684\u77e9\u5f62\uff0c\u5bf9\u4e8e\u540c\u4e00\u4e2a\u77e9\u5f62\u7684\u8d21\u732e\u53ef\u4ee5\u540c\u65f6\u8ba1\u7b97\u3002\u518d\u6309\u7167\u4e0a\u9762\u7684\u65b9\u6cd5\u505a\u590d\u6742\u5ea6\u5c31\u662f $O(2^nn^3)$ \u4e86\uff0c\u7cbe\u7ec6\u5b9e\u73b0\u8fd8\u53ef\u4ee5\u505a\u5230 $O(n^3+2^nn^2)$\u3002\n\n```\n#include<bits/stdc++.h>\n//this code is written by Itst\nusing namespace std;\n\nconst int MOD = 1e9 + 7;\nint arr[25][25] , X[25] , Y[25] , cntx , cnty , W , H , N , M , T , pos[11][5];\n\nint poww(long long a , int b){\n    int times = 1;\n    while(b){\n        if(b & 1) times = times * a % MOD;\n        a = a * a % MOD; b >>= 1;\n    }\n    return times;\n}\n\nint main(){\n#ifdef ONLINE_JUDGE\n    freopen(\"in\",\"r\",stdin);\n    freopen(\"out\",\"w\",stdout);\n#endif\n    ios::sync_with_stdio(0);\n    for(cin >> T ; T ; --T){\n        cin >> W >> H >> M >> N; cntx = cnty = 0;\n        for(int i = 1 ; i <= N ; ++i){\n            for(int j = 0 ; j < 5 ; ++j)\n                cin >> pos[i][j];\n            X[++cntx] = pos[i][0]; Y[++cnty] = pos[i][1];\n            X[++cntx] = ++pos[i][2]; Y[++cnty] = ++pos[i][3];\n        }\n        X[++cntx] = 1; X[++cntx] = W + 1;\n        Y[++cnty] = 1; Y[++cnty] = H + 1;\n        sort(X + 1 , X + cntx + 1); cntx = unique(X + 1 , X + cntx + 1) - X - 1;\n        sort(Y + 1 , Y + cnty + 1); cnty = unique(Y + 1 , Y + cnty + 1) - Y - 1;\n        int ans = 0;\n        for(int i = 0 ; i < 1 << N ; ++i){\n            for(int j = 1 ; j < cntx ; ++j)\n                for(int k = 1 ; k < cnty ; ++k)\n                    arr[j][k] = M;\n            for(int j = 1 ; j <= N ; ++j)\n                for(int k = lower_bound(X + 1 , X + cntx + 1 , pos[j][0]) - X ; X[k] != pos[j][2] ; ++k)\n                    for(int l = lower_bound(Y + 1 , Y + cnty + 1 , pos[j][1]) - Y ; Y[l] != pos[j][3] ; ++l)\n                        arr[k][l] = min(arr[k][l] , pos[j][4] - (i >> (j - 1) & 1));\n            int tmp = 1;\n            for(int j = 1 ; j < cntx ; ++j)\n                for(int k = 1 ; k < cnty ; ++k)\n                    tmp = 1ll * tmp * poww(arr[j][k] , (X[j + 1] - X[j]) * (Y[k + 1] - Y[k])) % MOD;\n            ans = (ans + MOD + (__builtin_popcount(i) & 1 ? -1ll : 1ll) * tmp) % MOD;\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}\n```",
        "postTime": 1560953917,
        "uid": 96296,
        "name": "Itst",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3813 \u3010[FJOI2017]\u77e9\u9635\u586b\u6570\u3011"
    },
    {
        "content": "\u6572\u4ee3\u7801\u7684\u65f6\u5019\u61d2\u5f97\u5207\u8f93\u5165\u6cd5\u6240\u4ee5\u6ce8\u91ca\u5168\u662f\u82f1\u6587emmm\n\n\u4f5c\u4e3a\u672c\u84bb\u7684\u4e00\u4e2a\u5fc3\u7ed3\uff0c\u8fd9\u9053\u9898\u7684\u7ec6\u8282\u8fd8\u662f\u86ee\u591a\u7684\u3002\n\n\u505a\u6cd5\u5c31\u662f \u79bb\u6563\u5316\u5750\u6807 + \u72b6\u538bDP\u3002\n\n\n\u4e0b\u9762\u8fd9\u6bb5\u5185\u5bb9\u6458\u5f55\u81eaFJWC2017\u8bfe\u4ef6\u3002\n\n\n> \u9898\u610f\uff1a\u4e00\u4e2a\u77e9\u9635\u4e2d\u53ef\u4ee5\u4efb\u610f\u586b m \u4e2a\u6570\u3002\u7ed9\u4f60 N \u4e2a\u5c0f\u77e9\u9635\u5e76\u4e14\u544a\u8bc9\u4f60\u6b64\u77e9\u9635\u4e2d\u7684\u6700\u5927\u503c v\uff0c\u6c42\u6709\u591a\u5c11\u79cd\u5927\u77e9\u9635\u6ee1\u8db3\u6240\u7ed9\u6761\u4ef6\u3002\n\n> \u5206\u6790\uff1a\u8003\u8651\u5230 n \u5f88\u5c0f\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u79bb\u6563\u5316\u5c06\u6240\u6709\u4e0d\u540c\u7684\u77e9\u9635\u91cd\u53e0\u7684\u60c5\u51b5(\u6700\u591a $2 ^ n$\u79cd)\u7684\u6700\u5927\u503c\u548c\u5757\u6570\u5148\u5904\u7406\u51fa\u6765\u3002\u5176\u4e2d\u7b2c i \u79cd\u7684\u6700\u5927\u503c\u4e3a $v_i$\uff0c\u5757\u6570\u4e3a $c_i$\u3002\n\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e00\u79cd\u91cd\u53e0\u60c5\u51b5\uff0c\u6211\u4eec\u6709\u4e24\u79cd\u9009\u62e9\uff0c\u5176\u4e00\u662f\u4e0d\u53d6\u6700\u5927\u503c\uff0c\u5219\u65b9\u6848\u6570\u4e3a$(v_i - 1) ^{c_i}$\u3002\u7b2c\u4e8c\u79cd\u662f\u53d6\u6700\u5927\u503c\uff0c\u5219\u65b9\u6848\u6570\u4e3a $v_i ^ {c_i} - (v_i - 1) ^ {c_i}$\u3002\n\n\u5219\u53ef\u4ee5\u8bbe `dp[i][j]`\u4e3a\u524d i \u79cd\u91cd\u53e0\u5757\u5176\u4e2d\u6709 j \u8fd9\u4e9b\u72b6\u6001\u7684\u77e9\u9635\u7684\u6700\u5927\u503c\u88ab\u6ee1\u8db3\u4e86\u7684\u65b9\u6848\u6570\uff0c\u5219\u6211\u4eec\u73b0\u5728\u8003\u8651\u7b2c i+1 \u5757\u7684\u53d6\u7684\u60c5\u51b5\u3002\u4e0d\u59a8\u8bbe\u5f53\u7b2c i+1 \u5757\u53d6\u6700\u5927\u503c\u65f6\u80fd\u4f7f\u5f97 `s[i + 1]`\u7684\u77e9\u9635\u88ab\u6ee1\u8db3\u3002\n\n\u5219\u5f53\u53d6\u6700\u5927\u503c\u65f6\uff0c\u628a\u5bf9\u5e94\u65b9\u6848\u6570\u8f6c\u79fb\u5230 `dp[i + 1][j | s[i + 1]]`\uff0c\u5426\u5219\u8f6c\u79fb\u5230 `dp[i + 1][j]`\u3002\n\n\u6545 `dp[(1 << n)][(1 << n) - 1]`\u4e3a\u6700\u7ec8\u7684\u65b9\u6848\u3002\n\n\n\u5177\u4f53\u5b9e\u73b0\u7ec6\u8282\u8bf7\u53c2\u8003\u672c\u84bb\u7684\u4ee3\u7801\u3002\n\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#define maxn 10010\n#define maxm 30\n#define mod 1000000007\n#define Lovelive long long\n\n// Records the matrices' information.\nint x1[maxm], y1[maxm], x2[maxm], y2[maxm], v[maxm];\n\n// Represents x-bounds && y-bounds.  \n// e.g. xb[i] = 1 means that there is a gap between row 1 and row 2. \nint xb[maxm], yb[maxm], xbs, ybs;\n\n// Record the information for each block.\nint block[maxm * maxm], bs, blimit[maxm * maxm], fulfill[maxm * maxm];\n\n// DP array.\nLovelive f[maxm * maxm][1100];\n\n// Tell whether the grid (x,y) is in rectangle i.\ninline int in(int x, int y, int i) {\n    return x >= x1[i] && x <= x2[i] && y >= y1[i] && y <= y2[i];\n}\n\n// Returns the minimum value between x and y.\ninline int min(int x, int y) {\n    return x < y ? x : y;\n}\n\n// Calculate power of an integer in O(log p) time\nLovelive pow(Lovelive n, Lovelive p) {\n    Lovelive ret = 1;\n    for(; p; p >>= 1, n = n * n % mod) {\n        if(p&1) ret = ret * n % mod;\n    }\n    return ret;\n}\n\nint main() {\n    int T;\n    scanf(\"%d\", &T);\n    while(T--) {\n        //initialization \n        xbs = ybs = bs = 0;\n        xb[xbs++] = 0;\n        yb[ybs++] = 0;\n        memset(f, 0, sizeof f);\n        memset(fulfill, 0, sizeof fulfill);\n        \n        int h, w, m, n;\n        scanf(\"%d%d%d%d\", &h, &w, &m, &n);\n        for(int i = 0; i < n; i++) {\n            scanf(\"%d%d%d%d%d\", x1 + i, y1 + i, x2 + i, y2 + i, v + i);\n            xb[xbs++] = x1[i] - 1;\n            yb[ybs++] = y1[i] - 1;\n            xb[xbs++] = x2[i];\n            yb[ybs++] = y2[i];\n        }\n        xb[xbs++] = h;\n        yb[ybs++] = w;\n        // Discretize indices.\n        std::sort(xb, xb + xbs);\n        std::sort(yb, yb + ybs);\n        xbs = std::unique(xb, xb + xbs) - xb;\n        ybs = std::unique(yb, yb + ybs) - yb;\n        \n        // Preprocess the information of each block.\n        for(int i = 1; i < xbs; ++i) {\n            for(int j = 1; j < ybs; ++j) {\n                ++bs;\n                block[bs] = (xb[i] - xb[i-1]) * (yb[j] - yb[j-1]);\n                blimit[bs] = m;\n                for(int k = 0; k < n; ++k)\n                    if(in(xb[i], yb[j], k))\n                        blimit[bs] = min(blimit[bs], v[k]);                \n                for(int k = 0; k < n; ++k)\n                    if(in(xb[i], yb[j], k) && blimit[bs] == v[k])\n                        fulfill[bs] ^= 1 << k;\n            }\n        }\n        \n        int li = 1 << n;\n        f[0][0] = 1;\n        for(int i = 1; i <= bs; ++i) {\n            int ful = fulfill[i];\n            Lovelive fail = pow(blimit[i] - 1, block[i]);\n            Lovelive success = pow(blimit[i], block[i]) - fail + mod;\n            for(int j = 0; j - li; ++j) {\n                f[i][j] = (f[i][j] + f[i-1][j] * fail) % mod;\n                f[i][j|ful] = (f[i][j|ful] + f[i-1][j] * success) % mod;\n            }\n        }\n        \n        printf(\"%d\\n\", (int)f[bs][li-1]);\n    }\n}\n```",
        "postTime": 1516034550,
        "uid": 21421,
        "name": "pantw",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3813 \u3010[FJOI2017]\u77e9\u9635\u586b\u6570\u3011"
    },
    {
        "content": "> \u73b0\u5728\uff0c\u4f60\u7684\u4efb\u52a1\u662f\u6c42\u51fa\u6709\u591a\u5c11\u79cd\u586b\u6570\u7684\u65b9\u6848\u6ee1\u8db3 $n$ \u4e2a\u9650\u5236\u3002\n\n\u8003\u8651\u5bb9\u65a5\uff0c\u7b2c $i$ \u4e2a\u77e9\u5f62\u7684\u6761\u4ef6\u4e3a\uff1a\u77e9\u5f62\u4e2d\u7684\u70b9\u6743\u4e0d\u8d85\u8fc7 $v_i$ \u4e14\u5b58\u5728\u70b9\u6743\u4e3a $v_i$ \u7684\u70b9\u3002\n\n> \u5c06 $\\max(a_1,a_2)=v$ \u8f6c\u6362\u4e3a $\\max(a_1,a_2)\\leq v$ \u548c $a_1=v$ \u6216 $a_2=v$\u3002\n\n\u9700\u8981\u6c42\u7684\u662f $n$ \u4e2a\u96c6\u5408\u7684\u4ea4\u96c6\u3002\n\n\u8003\u8651\u6ca1\u6709\u9650\u5236\u5b58\u5728\u70b9\u6743\uff0c\u53ea\u6709 $\\leq v_i$ \u7684\u9650\u5236\uff0c\u76f8\u5f53\u4e8e\u77e9\u5f62\u53d6 $\\min$\uff0c\u67e5\u503c\uff0c\u79bb\u6563\u5316\u6a2a\u7eb5\u5750\u6807\u66b4\u529b\u518d\u5229\u7528\u4e58\u6cd5\u539f\u7406\u5373\u53ef\u5f97\u51fa\u3002\n\n> \u4e3a\u4ec0\u4e48\u80fd\u7528\u4e58\u6cd5\u539f\u7406\uff1f\n>\n> \u8003\u8651\u4e24\u4e2a\u6570\u7684\u60c5\u51b5\uff0c\u5373 $\\max(a_1,a_2)\\leq v$\uff0c\u8f6c\u5316\u4e3a\u4e24\u4e2a\u72ec\u7acb\u7684\u5f0f\u5b50\uff1a$a_1\\leq v,a_2\\leq v$\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e58\u6cd5\u539f\u7406\u3002\n\n\u7531\u4e8e\u53ef\u4ee5\u5feb\u901f\u6c42\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u6bcf\u4e2a\u77e9\u5f62 $\\leq v_i$ \u7684\u4ea4\u4f5c\u4e3a\u5168\u96c6\u3002\n\n\u8bb0 $S_i$ \u8868\u793a\u5728\u7b2c $i$ \u77e9\u5f62\u5185\u5b58\u5728\u70b9\u6743\u4e3a $v_i$ \u7684\u70b9\u3002\n\n$$\n\\begin{aligned}\n\n\\Bigg|\\bigcap_{i=1}^nS_i\\Bigg|&=|U|-\\Bigg|\\bigcup_{i=1}^n\\overline{S_i}\\Bigg|\\\\\n\n&=|U|-\\sum_{T\\in[n],T\\ne\\emptyset}(-1)^{|T|+1}\\Bigg|\\bigcap_{i\\in T}\\overline{S_i}\\Bigg|\\\\\n\n&=|U|+\\sum_{T\\in[n],T\\ne\\emptyset}(-1)^{|T|}\\Bigg|\\bigcap_{i\\in T}\\overline{S_i}\\Bigg|\\\\\n\n&=\\sum_{T\\in[n]}(-1)^{|T|}\\Bigg|\\bigcap_{i\\in T}\\overline{S_i}\\Bigg|\\\\\n\n\\end{aligned}\n$$\n\n\u8003\u8651 $\\overline{S_i}$ \u7684\u610f\u4e49\uff1a\u5728\u7b2c $i$ \u4e2a\u77e9\u5f62\u5185\u4e0d\u5b58\u5728\u70b9\u6743\u4e3a $v_i$ \u7684\u70b9\uff0c\u5373\u7b2c $i$ \u4e2a\u77e9\u5f62\u5185\u70b9\u6743 $\\leq v_i-1$\u3002\u53c8\u53ef\u4ee5\u6309\u6c42\u5168\u96c6\u7684\u65b9\u6cd5\u505a\u4e86\u3002\n\n\u6ce8\u610f\u70b9\uff1a\u6574\u4e2a $h\\times w$ \u7684\u77e9\u5f62\u4e5f\u6709\u9650\u5236\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u79bb\u6563\u5316\u548c\u6c42\u5168\u96c6\u65f6\u52a0\u4e0a\uff0c\u4f46\u662f\u5bb9\u65a5\u7684\u65f6\u5019\u4e0d\u8981\u5e26\u4e0a\uff0c\u56e0\u4e3a\u5b83\u7684\u8981\u6c42\u53ea\u662f\u4e0d\u8d85\u8fc7 $m$\u3002\n\n[My Submission](https://www.luogu.com.cn/record/104286784)",
        "postTime": 1678497441,
        "uid": 271736,
        "name": "Daidly",
        "ccfLevel": 6,
        "title": "P3813 [FJOI2017]\u77e9\u9635\u586b\u6570 \u9898\u89e3"
    },
    {
        "content": "\u9996\u5148\u8ba1\u7b97\u6700\u5c0f\u503c\u6070\u597d $=v$ \u7684\u65b9\u6848\u6570\u6709\u4e00\u4e2a\u975e\u5e38\u5957\u8def\u7684\u8f6c\u5316\u662f\u5dee\u5206\u4e00\u4e0b\u53d8\u6210\u6700\u5c0f\u503c $\\leq v$ \u548c\u6700\u5c0f\u503c $\\leq v-1$ \u7684\u6570\u91cf\u76f8\u51cf\u3002\n\n\u8fd9\u91cc\u6709\u591a\u4e2a\u9650\u5236\uff0c\u76f4\u63a5\u8fd9\u6837\u505a\u5c31\u4e0d\u884c\u4e86\uff0c\u4f46\u6ce8\u610f\u5230 $n\\leq10$\uff0c\u663e\u7136\u53ef\u4ee5\u679a\u4e3e\u4e00\u4e2a\u5b50\u96c6\u7136\u540e\u5bb9\u65a5\uff0c\u94a6\u5b9a\u4e0d\u5408\u6cd5\u7684\u5b50\u77e9\u5f62\u9650\u5236\u6700\u5c0f\u503c $\\leq v-1$\uff0c\u6ca1\u6709\u94a6\u5b9a\u7684\u5219\u4e0d\u53d8\u3002\n\n\u73b0\u5728\u6211\u4eec\u8981\u5feb\u901f\u6c42\u51fa\u6bcf\u4e2a\u70b9\u7684\u53d6\u503c\u8303\u56f4\uff0c\u663e\u7136\u4e0b\u754c\u6c38\u8fdc\u662f $1$\uff0c\u53ea\u8981\u6c42\u4e0a\u754c\u5373\u53ef\u3002\n\n\u4e0d\u96be\u60f3\u5230\u5c06\u6240\u6709\u9650\u5236\u6309\u7167\u6743\u503c\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u4f9d\u6b21\u52a0\u5165\uff0c\u8fd9\u6837\u4e00\u65e6\u4e00\u4e2a\u4f4d\u7f6e\u88ab\u8986\u76d6\u540e\u4e0a\u754c\u5c31\u4e0d\u4f1a\u518d\u6539\u53d8\u4e86\uff0c\u4e8e\u662f\u95ee\u9898\u8f6c\u5316\u6210\u4e86\u7ef4\u62a4\u4e00\u4e2a $01$ \u77e9\u9635\uff0c\u652f\u6301\u67e5\u8be2\u77e9\u5f62\u548c\uff0c\u77e9\u5f62\u8d4b\u503c\u6210 $0$\u3002\n\n\u8fd9\u4e2a\u600e\u4e48\u505a\uff1f\u6811\u5957\u6811\uff1f\u5206\u5757\uff1f\u505c\u505c\uff0c\u522b\u6570\u636e\u7ed3\u6784\u5b66\u50bb\u4e86\uff0c\u4e00\u5171\u53ea\u6709\u5341\u6b21\u64cd\u4f5c\uff0c\u8fd8\u53ef\u4ee5\u79bb\u7ebf\uff0c\u76f4\u63a5\u628a\u77e9\u5f62\u79bb\u6563\u5316\u4e00\u4e0b\u7136\u540e\u6bcf\u6b21\u66b4\u529b\u627e\u5c31\u7ed3\u675f\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(2^nn^3)$\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<bitset>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nconst int block=100,mod=1e9+7;\nint t,n,m,lim,p,ans,sum[31][31],node1[31],cnt1,node2[31],cnt2;\nbool vis[31][31];\nstruct element\n{\n    int l1,l2,r1,r2,w;\n    bool operator<(const element &other) const\n    {\n        return w<other.w;\n    }\n}a[10],b[10];\ninline void init()\n{\n    ios::sync_with_stdio(0);\n    cin.tie(0);\n}\ninline int read()\n{\n    int x;\n    cin>>x;\n    return x;\n}\ninline int pw(int a,int b)\n{\n    int res=1;\n    while(b)\n    {\n        if(b&1)\n            res=1ll*res*a%mod;\n        b>>=1;\n        a=1ll*a*a%mod;\n    }\n    return res;\n}\ninline int Mod(int x)\n{\n    return x>=mod? x-mod:x;\n}\ninline int calc(int l1,int l2,int r1,int r2)\n{\n    int res=0;\n    for(int i=l1;i<l2;++i)\n        for(int j=r1;j<r2;++j)\n            if(!vis[i][j])\n            {\n                vis[i][j]=1;\n                res+=sum[i][j];\n            }\n    return res;\n}\ninline void clear()\n{\n    for(int i=1;i<cnt1;++i)\n        for(int j=1;j<cnt2;++j)\n            vis[i][j]=0;\n}\nint main()\n{\n    init();\n    t=read();\n    while(t--)\n    {\n        n=read(),m=read(),lim=read(),p=read();\n        cnt1=cnt2=ans=0;\n        node1[++cnt1]=1;\n        node1[++cnt1]=n+1;\n        node2[++cnt2]=1;\n        node2[++cnt2]=m+1;\n        memset(sum,0,sizeof sum);\n        for(int i=0;i<p;++i)\n            node1[++cnt1]=a[i].l1=read(),node2[++cnt2]=a[i].r1=read(),node1[++cnt1]=a[i].l2=read()+1,node2[++cnt2]=a[i].r2=read()+1,a[i].w=read();\n        sort(node1+1,node1+cnt1+1);\n        sort(node2+1,node2+cnt2+1);\n        cnt1=unique(node1+1,node1+cnt1+1)-node1-1;\n        cnt2=unique(node2+1,node2+cnt2+1)-node2-1;\n        for(int i=0;i<p;++i)\n        {\n            a[i].l1=lower_bound(node1+1,node1+cnt1+1,a[i].l1)-node1;\n            a[i].l2=lower_bound(node1+1,node1+cnt1+1,a[i].l2)-node1;\n            a[i].r1=lower_bound(node2+1,node2+cnt2+1,a[i].r1)-node2;\n            a[i].r2=lower_bound(node2+1,node2+cnt2+1,a[i].r2)-node2;\n        }\n        for(int i=1;i<cnt1;++i)\n            for(int j=1;j<cnt2;++j)\n                sum[i][j]=(node1[i+1]-node1[i])*(node2[j+1]-node2[j]);\n        for(int s=0;s<1<<p;++s)\n        {\n            int res=1;\n            for(int i=0;i<p;++i)\n            {\n                b[i]=a[i];\n                if(s>>i&1)\n                    --b[i].w;\n            }\n            clear();\n            sort(b,b+p);\n            for(int i=0;i<p;++i)\n                res=1ll*res*pw(b[i].w,calc(b[i].l1,b[i].l2,b[i].r1,b[i].r2))%mod;\n            for(int i=1;i<cnt1;++i)\n                for(int j=1;j<cnt2;++j)\n                    if(!vis[i][j])\n                        res=1ll*res*pw(lim,sum[i][j])%mod;\n            ans=Mod(ans+1ll*(__builtin_parity(s)? mod-1:1)*res%mod);\n        }\n        cout<<ans<<'\\n';\n    }\n    cout.flush();\n    return 0;\n}\n```",
        "postTime": 1671545065,
        "uid": 85682,
        "name": "\u7edd\u9876\u6211\u4e3a\u5cf0",
        "ccfLevel": 8,
        "title": "P3813 [FJOI2017]\u77e9\u9635\u586b\u6570 \u9898\u89e3"
    },
    {
        "content": "\u8fd9\u91cc\u662f\u4e00\u4e2a $O(n2^n)$ \u7684\u505a\u6cd5\uff08\u4e0d\u8fc7\u5e38\u6570\u76f8\u5bf9\u8f83\u5927\uff09\u3002\n\n------------\n\n\u6700\u5927\u503c\u4e3a $v$ \u7684\u9650\u5236\u4e0d\u597d\u5904\u7406\uff0c\u8003\u8651\u5c06\u9650\u5236\u8f6c\u6210**\u77e9\u9635\u5185\u6240\u6709\u6570\u7684\u503c\u4e0d\u5927\u4e8e $v$** \u540e\u7528\u5bb9\u65a5\u6c42\u89e3\uff08\u5177\u4f53\u6765\u8bb2\uff0c\u679a\u4e3e\u5176\u4e2d\u6bcf\u4e2a\u9650\u5236\u662f\u5426\u88ab\u6253\u7834\uff0c\u90a3\u4e48\u5bf9\u4e8e\u6240\u6709\u88ab\u6253\u7834\u7684\u9650\u5236\u5c06\u4f1a\u53d8\u4e3a**\u77e9\u9635\u5185\u6240\u6709\u6570\u7684\u503c\u4e0d\u5927\u4e8e $v-1$**\uff09\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5c06\u6574\u4e2a\u77e9\u9635\u5206\u6210 $O(n^2)$ \u5757\uff0c\u6bcf\u5757\u90fd\u4f1a\u6709\u82e5\u5e72\u4e2a\u6700\u5927\u503c\u7684\u9650\u5236\uff08\u4e5f\u53ef\u80fd\u6ca1\u6709\u9650\u5236\uff09\u3002\u663e\u7136\u8fd9\u4e9b\u9650\u5236\u4e2d\u53ea\u6709 $v$ \u503c\u6700\u5c0f\u7684\u6700\u5927\u503c\u9650\u5236\u80fd\u5f71\u54cd\u6bcf\u5757\u7684\u53d6\u503c\u8303\u56f4\uff08\u5373\u4fbf\u6253\u7834\u5176\u4ed6\u9650\u5236\u4e5f\u65e0\u6cd5\u5bf9\u5176\u4ea7\u751f\u5f71\u54cd\uff09\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u53ea\u4fdd\u7559\u8fd9\u4e9b\u6027\u8d28\u3002\u5bf9\u4e8e\u5757 $i$\uff0c\u6211\u4eec\u8bb0 $S_i$ \u8868\u793a\u80fd\u5f71\u54cd\u5757 $i$ \u53d6\u503c\u8303\u56f4\u7684\u9650\u5236\u7684\u96c6\u5408\uff0c$w_i$ \u8868\u793a\u8fd9\u4e9b\u9650\u5236\u7684 $v$\u3002\n\n\u6211\u4eec\u5c06\u6240\u6709 $v$ \u503c\u76f8\u540c\u7684\u6700\u5927\u503c\u9650\u5236\u770b\u505a\u4e00\u7ec4\uff0c\u8bb0\u4f5c\u96c6\u5408 $U$\uff0c\u679a\u4e3e\u5176\u4e2d\u54ea\u4e9b\u6027\u8d28\u88ab\u6253\u7834\uff0c\u8bb0\u8fd9\u4e9b\u88ab\u6253\u7834\u7684\u6027\u8d28\u7684\u96c6\u5408\u4e3a $T$\u3002\u5bb9\u6613\u53d1\u73b0\u5bf9\u4e8e\u6240\u6709\u7684\u5757 $x(w_x=v)$\uff0c\u5f53\u4e14\u4ec5\u5f53 $T\\bigcap S_x=\\varnothing$ \u65f6\u5757 $x$ \u7684\u53d6\u503c\u8303\u56f4\u4e3a $\\left[1,v\\right]$\uff0c\u5426\u5219\u4e3a $\\left[1,v-1\\right]$\u3002\n\n\u5c06 $T$ \u5bf9 $U$ \u53d6\u8865\u96c6\uff0c\u6709 $S_x\\subset\\complement_UT$\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5 $O(t2^t)$\uff08$t$ \u4e3a\u96c6\u5408 $U$ \u7684\u5927\u5c0f\uff09\u5bf9\u4e8e\u6240\u6709\u7684 $T$ \u6c42\u51fa\u6240\u6709 $w_x=v$ \u7684\u5757 $x$ \u4e2d\u53d6\u503c\u8303\u56f4\u4e3a $\\left[1,v\\right]$ \u7684\u5757\u7684\u603b\u9762\u79ef\uff0c\u4ece\u800c\u6c42\u51fa\u8be5\u90e8\u5206\u7684\u7b54\u6848\u3002\n\n\u5404\u90e8\u5206\u7684\u7b54\u6848\u7684\u4e58\u79ef\u518d\u4e58\u4e0a\u6240\u6709\u6ca1\u6709\u88ab\u53d7\u9650\u5236\u7684\u5757\u7684\u90e8\u5206\u7684\u7b54\u6848\u5c31\u662f\u6700\u7ec8\u7ed3\u679c\u3002\n\n\u5957\u4e2a\u5149\u901f\u5e42\u5c31\u80fd\u505a\u5230 $O(n2^n)$ \u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define p 1000000007\n#define K 10000\nusing namespace std;\nint T,h,w,m,n;\nint x_1[15],y_1[15],x_2[15],y_2[15],v[15],xh[15],tk[15];\nint fm[2][15][K+5],ffm[2][15][K+5];\nbool cmp(const int &x,const int &y){return v[x]<v[y];}\nint lx[25],ly[25],ls[25],tx,ty;\nint fg[25][25][15],ff[(1<<10)+5],f[(1<<10)+5],fk,ans;\nint dr()\n{\n    int xx=0;char ch=getchar();\n    while(ch<'0'||ch>'9')ch=getchar();\n    while(ch>='0'&&ch<='9')xx=xx*10+ch-'0',ch=getchar();\n    return xx;\n}\nint P(int opt,int xh,int y){return opt?1ll*ffm[1][xh][y/K]*ffm[0][xh][y%K]%p:1ll*fm[1][xh][y/K]*fm[0][xh][y%K]%p;}\nint fi(int opt,int x)\n{\n    int l=1,r=opt?ty:tx,mid;\n    while(l<=r)\n    {\n        mid=(l+r)>>1;int mx=opt?ly[mid]:lx[mid];\n        if(x==mx)return mid;\n        if(x<mx)r=mid-1;else l=mid+1;\n    }\n    return -1;\n}\nint main()\n{\n    T=dr();\n    while(T--)\n    {\n        tx=ty=0,fk=0,ans=0;\n        memset(fg,0,sizeof(fg));\n        memset(f,0,sizeof(f));\n        memset(ff,0,sizeof(ff));\n        memset(tk,0,sizeof(tk));\n        h=dr(),w=dr(),m=dr(),n=dr();\n        for(int i=1;i<=n;i++)lx[i]=x_1[i]=dr(),ly[i]=y_1[i]=dr(),lx[n+i]=(x_2[i]=dr())+1,ly[n+i]=(y_2[i]=dr())+1,v[i]=dr(),xh[i]=i;\n        lx[2*n+1]=ly[2*n+1]=1,lx[2*n+2]=h+1,ly[2*n+2]=w+1;\n        sort(lx+1,lx+2*n+3),sort(ly+1,ly+2*n+3),sort(xh+1,xh+n+1,cmp);\n        for(int i=1;i<=2*n+2;i++)if(lx[i]!=lx[i-1])ls[++tx]=lx[i];\n        for(int i=1;i<=tx;i++)lx[i]=ls[i];\n        for(int i=1;i<=2*n+2;i++)if(ly[i]!=ly[i-1])ls[++ty]=ly[i];\n        for(int i=1;i<=ty;i++)ly[i]=ls[i];\n        for(int i=1;i<=n;i++)\n        {\n            fm[0][i][0]=fm[1][i][0]=ffm[0][i][0]=ffm[1][i][0]=1;\n            for(int j=1;j<=K;j++)fm[0][i][j]=1ll*fm[0][i][j-1]*v[i]%p,ffm[0][i][j]=1ll*ffm[0][i][j-1]*(v[i]-1)%p;\n            for(int j=1;j<=K;j++)fm[1][i][j]=1ll*fm[1][i][j-1]*fm[0][i][K]%p,ffm[1][i][j]=1ll*ffm[1][i][j-1]*ffm[0][i][K]%p;\n        }\n        fm[0][0][0]=fm[1][0][0]=1;\n        for(int i=1;i<=K;i++)fm[0][0][i]=1ll*fm[0][0][i-1]*m%p;\n        for(int i=1;i<=K;i++)fm[1][0][i]=1ll*fm[1][0][i-1]*fm[0][0][K]%p;\n        for(int t=1;t<=n;t++)\n        {\n            int x=fi(0,x_1[t]),y=fi(1,y_1[t]),xx=fi(0,x_2[t]+1),yy=fi(1,y_2[t]+1);\n            for(int i=x;i<xx;i++)for(int j=y;j<yy;j++)fg[i][j][t]=1;\n        }\n        for(int i=1;i<tx;i++)for(int j=1;j<ty;j++)\n        {\n            int kn=(lx[i+1]-lx[i])*(ly[j+1]-ly[j]),fv=0;\n            for(int t=1;t<=n;t++)if(fg[i][j][xh[t]]){fv=v[xh[t]];break;}\n            if(fv)\n            {\n                int zt=0;\n                for(int t=1;t<=n;t++)\n                if(v[xh[t]]==fv)\n                {\n                    tk[t]+=kn;\n                    if(fg[i][j][xh[t]])zt^=1<<(t-1);\n                }\n                ff[zt]+=kn;\n            }\n            else fk+=kn;\n        }\n        ans=P(0,0,fk);\n        for(int t=1;t<=n;t++)\n        {\n            int nt=t,l,tzt;\n            while(nt<n&&v[xh[nt+1]]==v[xh[t]])++nt;\n            l=nt-t+1,tzt=(1<<l)-1;\n            for(int i=0;i<=tzt;i++)f[i]=ff[i<<(t-1)];\n            for(int i=0;i<l;i++)for(int j=0;j<(1<<l);j++)if(!(j&(1<<i)))f[j^(1<<i)]+=f[j];\n            int lan=0;\n            for(int i=0;i<=tzt;i++)\n            {\n                int lans=1ll*P(0,xh[t],f[i])*P(1,xh[t],tk[t]-f[i])%p,ttt=i^tzt,op=0;\n                for(int j=0;j<l;j++)if(ttt&(1<<j))op^=1;\n                lan=(lan+(op?-1ll:1ll)*lans+p)%p;\n            }\n            for(int i=0;i<(1<<l);i++)f[i]=0;\n            ans=1ll*ans*lan%p,t=nt;\n        }\n        printf(\"%d\\n\",ans);\n    }\n}\n```",
        "postTime": 1615726496,
        "uid": 104581,
        "name": "kkk\u7684\u5c0f\u8214\u72d7",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3813 \u3010[FJOI2017]\u77e9\u9635\u586b\u6570\u3011"
    },
    {
        "content": "[\u9898\u76ee](https://www.luogu.org/problem/P3813)\n\n\u7ed9\u5b9a\u4e00\u4e2a $h\\times w$ \u7684\u77e9\u9635\uff0c\u6bcf\u4e2a\u683c\u5b50\u4e2d\u5c06\u586b\u5165 $1$ \u5230 $m$ \u4e2d\u7684\u67d0\u4e2a\u6574\u6570\u3002  \n\u4e00\u4e2a\u5408\u6cd5\u7684\u586b\u6570\u65b9\u6848\u987b\u6ee1\u8db3 $n$ \u6761\u9650\u5236\uff0c\u6bcf\u6761\u9650\u5236\u5f62\u5982\u201c\u4ee5 $(x_1,y_1)$ \u4e3a\u5de6\u4e0a\u89d2\uff0c$(x_2,y_2)$ \u4e3a\u53f3\u4e0b\u89d2\u7684\u5b50\u77e9\u9635\u4e2d\uff0c\u6700\u5927\u503c\u5fc5\u987b\u4e3a $v$\u201d\u3002  \n\u6c42\u586b\u6570\u65b9\u6848\u6570\uff0c\u5bf9\u5927\u8d28\u6570\u53d6\u6a21\u3002  \n\n\u628a\u8fd9 $n$ \u6761\u9650\u5236\u6309\u7167 $v$ \u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u3002\n\n\u8fd9\u6837\uff0c\u5c31\u53ef\u4ee5\u5bf9\u6bcf\u4e2a $x$ \u6c42\u51fa\u6700\u5c0f\u9650\u5236\u4e3a $x$ \u7684\u533a\u57df\u7684\u7b54\u6848\uff0c\u6700\u540e\u5904\u7406\u6ca1\u88ab\u9650\u5236\u7684\u533a\u57df\uff08\u8fd9\u663e\u7136\u662f $m^{S_R}$\uff0c$S_R$ \u6ca1\u88ab\u9650\u5236\u7684\u533a\u57df\u7684\u9762\u79ef\uff09\u3002\n\n\u7b54\u6848\u5c31\u662f\u628a\u8fd9\u4e9b\u4e1c\u897f\u5168\u90e8\u4e58\u8d77\u6765\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u5bf9\u4e8e\u6bcf\u4e2a $x$ \u6c42\u51fa\u6700\u5c0f\u9650\u5236\u4e3a $x$ \u7684\u533a\u57df\u7684\u7b54\u6848\u3002\n\n\u8bbe $A$ \u4e3a\u6240\u6709 $v$ \u503c\u7b49\u4e8e $x$ \u7684\u9650\u5236\u6784\u6210\u7684\u96c6\u5408\u3002\u6211\u4eec\u8981\u6ee1\u8db3 $A$ \u4e2d\u6240\u6709\u9650\u5236\uff0c\u5e76\u4e0d\u597d\u7b97\uff0c\u8003\u8651\u5bb9\u65a5\u3002\n\n\u6539\u4e3a\u5bf9 $A$ \u7684\u6bcf\u4e2a\u5b50\u96c6 $B$\uff0c\u6c42\u5f3a\u5236\u8ba9\u5176\u4e0d\u6ee1\u8db3\u7684\u65b9\u6848\u6570\uff0c\u5927\u6982\u662f $(x-1)^{S_B}x^{S_{A-B}}$ \uff0c\u5176\u4e2d $S_A$ \u4e3a\u96c6\u5408 $A$ \u4e2d\u6240\u6709\u5b50\u77e9\u9635\u7684\u5e76\u7684\u9762\u79ef\u53bb\u6389\u5176\u4e2d\u6709\u66f4\u5c0f\u9650\u5236\u7684\u9762\u79ef\u3002\u7136\u540e\u52a0\u52a0\u51cf\u51cf\u5c31\u884c\u3002\n\n\u53d1\u73b0\u6211\u4eec\u8fd8\u8981\u6c42\u533a\u57df\u9762\u79ef\uff0c\u5f53\u7136\u53ef\u4ee5\u79bb\u6563\u5316\u5750\u6807\u503c\u7136\u540e\u968f\u4fbf\u641e\uff0c\u4f46\u90a3\u4e2a\u7ec6\u8282\u5de8\u591a\u3002\u8003\u8651\u66f4\u597d\u5199\u7684\u65b9\u6cd5\uff1a\u7ee7\u7eed\u5bb9\u65a5\u3002\n\n\u6211\u4eec\u53d1\u73b0\u672c\u9898\u4e2d\u6240\u6709\u7684\u9762\u79ef\u90fd\u53ef\u4ee5\u8f6c\u4e3a\u77e9\u5f62\u7684\u4ea4\u548c\u5e76\u3002\n\n\u53d1\u73b0\u77e9\u5f62\u4ea4\u662f\u597d\u6c42\u7684\uff0c\u800c\u5e76\u7684\u5c31\u7b49\u4e8e\u5176\u5b50\u96c6\u7684\u4ea4\u52a0\u52a0\u51cf\u51cf\uff0c\u7136\u540e\u5c31\u6c42\u5b8c\u4e86\u3002\u679a\u4e3e\u5b50\u96c6\u7684\u5b50\u96c6\u662f $O(3^n)$ \u7684\u3002\n\n\u6bcf\u7ec4\u6570\u636e\u7684\u590d\u6742\u5ea6\u4e3a $O(3^n+2^n\\log(hw))$\uff0c$\\log$ \u6765\u81ea\u5feb\u901f\u5e42\u3002\uff08\u5f53\u7136\u53ef\u4ee5 FMT \u628a $3^n$ \u4f18\u5316\u6389\uff0c\u4f18\u5316\u5230 $O(2^nn+2^n\\log(hw))$\uff0c\u4f46\u6ca1\u6709\u5fc5\u8981\uff09\u3002\n\n```cpp\n#include<cstdio>\n#include<algorithm>\ntypedef long long ll;\nconst int N=10,M=1e9+7;\ninline int Pow(int a,int m){int s=1;for(;m;m>>=1)m&1?s=(ll)s*a%M:0,a=(ll)a*a%M;return s;}\nint x[N],y[N],xx[N],yy[N],mx[N],t[N],n,m,h,w,cnt[1<<N],ans,tmp;ll cup[1<<N],cap[1<<N];\nbool Cmp(const int&i,const int&j){return mx[i]<mx[j];}\nint main(){\n    int a,b,aa,bb,U;\n\tfor(int I=0;I<(1<<N);I++)cnt[I]=cnt[I>>1]+(I&1);\n\tint T;scanf(\"%d\",&T);for(;T--;){\n\tscanf(\"%d%d%d%d\",&h,&w,&m,&n);\n\tfor(int i=0;i<n;i++)scanf(\"%d%d%d%d%d\",x+i,y+i,xx+i,yy+i,mx+i),t[i]=i;\n\tstd::sort(t,t+n,Cmp);\n\tfor(int I=0;I<(1<<n);I++){\n\t  a=b=0,aa=h,bb=w;\n\t  for(int i=0;i<n;i++)if(I&1<<i){\n\t\ta=std::max(a,x[i]);\n\t\tb=std::max(b,y[i]);\n\t\taa=std::min(aa,xx[i]);\n\t\tbb=std::min(bb,yy[i]);\n\t  }\n\t  cap[I]=a>aa||b>bb?0:(ll)(aa-a+1)*(bb-b+1);\n\t}\n\tfor(int I=0;I<(1<<n);I++){\n\t  cup[I]=0;\n\t  for(int J=I;J;J=I&J-1)\n\t\tcup[I]=(cup[I]+cap[J]*(cnt[J]&1?1:-1));\n\t}\n\tans=Pow(m,h*w-cup[(1<<n)-1]);\n\tU=0;\n\tfor(int l=0,r=0,I;r<n;r++)if(r+1==n||mx[t[r]]!=mx[t[r+1]]){\n\t  I=0;\n\t  for(int i=l;i<=r;i++)I|=1<<t[i];\n\t  tmp=Pow(mx[t[r]],cup[I|U]-cup[U]);\n\t  for(int J=I;J;J=I&J-1)\n\t\ttmp=(tmp+(ll)Pow(mx[t[r]]-1,cup[J|U]-cup[U])*Pow(mx[t[r]],cup[I|U]-cup[J|U])%M*(cnt[J]&1?-1:1)+M)%M;\n\t  ans=(ll)ans*tmp%M;\n\t  U|=I,l=r+1;\n\t}\n\tprintf(\"%d\\n\",ans);\n\t}return 0;\n}\n```",
        "postTime": 1582140571,
        "uid": 72487,
        "name": "Dreamunk",
        "ccfLevel": 9,
        "title": "FJOI2017 \u77e9\u9635\u586b\u6570"
    },
    {
        "content": "### \u9898\u610f\u6982\u8981\uff1a\n\n\u7ed9\u5b9a\u4e00\u4e2a $h\\times w$ \u7684\u77e9\u9635\uff0c\u6bcf\u4e2a\u70b9\u53ef\u4ee5\u586b $[1,m]$ \u95f4\u7684\u4e00\u4e2a\u6b63\u6574\u6570\uff0c\u5e76\u4e14\u8981\u6c42\u6ee1\u8db3 $n$ \u4e2a\u5b50\u77e9\u9635\u5185\u7684\u6700\u5927\u503c**\u5206\u522b**\u4e3a $w_i$\u3002\n\n### \u9898\u76ee\u5206\u6790\uff1a\n\n\u8fd9\u4e2a\u6700\u5927\u503c\u4e3a $w_i$ \u7684\u9650\u5236\u6761\u4ef6\u76f4\u63a5\u505a\u4e0d\u597d\u505a\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5bb9\u65a5\uff0c\u5373\u6211\u4eec\u7edf\u8ba1\u8fd9\u4e2a\u5b50\u77e9\u9635\u5185 $\\max\\le w_i$ \u7684\u65b9\u6848\u6570 $x$\uff0c\u7136\u540e\u7edf\u8ba1 $\\max<w_i$ \u7684\u65b9\u6848\u6570 $y$\uff0c$x-y$ \u5c31\u662f\u8fd9\u4e2a\u5b50\u77e9\u9635\u5185 $\\max=w_i$ \u7684\u65b9\u6848\u6570\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u591a\u4e2a\u5b50\u77e9\u9635\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5c06\u5b50\u77e9\u9635\u6309\u6743\u503c\u5927\u5c0f\u4ece\u5c0f\u5230\u5927\u52a0\u5165\u8fd9\u4e2a\u77e9\u9635\uff0c\u7136\u540e\u7edf\u8ba1\u7b54\u6848\u5c31\u884c\uff0c\u5305\u62ec\u6ca1\u6709\u4efb\u4f55\u9650\u5236\u7684\u90e8\u5206\u3002\u7531\u4e8e\u53ef\u80fd\u4ece\u5728\u4e24\u4e2a\u9650\u5236\u6761\u4ef6 $P_1$\uff0c$P_2$\uff0c\u6ee1\u8db3\u4ed6\u4eec\u9650\u5236\u7684 $w_1,w_2$ \u76f8\u540c\uff0c\u5728\u8003\u8651 $w$ \u51cf\u4e0d\u51cf $1$ \u7684\u65f6\u5019\uff0c$P_1,P_2$ \u7684\u52a0\u5165\u987a\u5e8f\u4f1a\u53d1\u751f\u6539\u53d8\u3002\u6240\u4ee5\u6211\u4eec\u8981\u8003\u8651\u5bb9\u65a5\uff0c$f(A)$ \u4e3a\u5728\u6ee1\u8db3 $A$ \u6761\u4ef6\u4e0b\uff0c\u77e9\u9635\u7684\u65b9\u6848\u6570\u3002 \u5373 $f(\\max\\le w_1 \\cap\\max\\le w_2)-f(\\max <w_1\\cap \\max\\le w_2)-f(\\max \\le w_1\\cap \\max<w_2)+f(\\max<w_1\\cap\\max<w_2)$\u3002\n\n\u6269\u5c55\u5230\u591a\u4e2a\u9650\u5236\u6761\u4ef6\u540c\u7406\u3002\n\n\u5177\u4f53\u64cd\u4f5c\u5c31\u662f\u5c06\u77e9\u9635\u79bb\u6563\u5316\uff0c\u652f\u6301\u77e9\u5f62\u7684\u533a\u95f4\u8986\u76d6\uff0c\u533a\u95f4\u67e5\u8be2\u3002\u5f53\u7136\uff0c\u7531\u4e8e $n$ \u975e\u5e38\u5c0f\uff0c\u6211\u4eec\u53ea\u9700\u8981\u66b4\u529b\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(n^22^{n})$\u3002\n\n### \u4ee3\u7801\u5982\u4e0b\uff1a\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define pd push_back\n#define all(x) x.begin(),x.end()\n#define Clear(x,n) for(int i=0;i<=n;i++)x[i]=0;\n#define LB lower_bound\n//==============================================================================\nll QP(ll x,ll y,ll mod){ll ans=1;for(;y;y>>=1,x=x*x%mod)if(y&1)ans=ans*x%mod;return ans;}\n//==============================================================================\nnamespace IO{\n\tint readInt(){\n\t\tint x=0,y=0;char c=0;\n\t\twhile(!isdigit(c))y|=c=='-',c=getchar();\n\t\twhile(isdigit(c))x=(x<<3)+(x<<1)+(c^48),c=getchar();\n\t\treturn !y?x:-x;\n\t}\n\tvoid write(int x){if(!x)return;write(x/10);putchar(x%10+'0');}\n\tvoid Output(int x){if(x<0)putchar('-'),x=-x;if(!x)putchar('0');else write(x);}\n\tvoid WL(int x){Output(x);putchar('\\n');}\n\tvoid WS(int x){Output(x);putchar(' ');}\n}\nnamespace Debug{\n\tvoid DeVec(vector<int> c){for(auto y:c)printf(\"%d \",y);puts(\"\");}\n\tvoid DeNum(int x){printf(\"%d\\n\",x);}\n}\n//==============================================================================\nconst int N=20+10;\nll T;\nconst int mod=1e9+7;\nll n,m,p,q;\nll s[N][N];\nbool vis[N][N];\nstruct node{ll x1,y1,x2,y2,w;}a[20];\nbool cmp(const node &x,const node &y){return x.w<y.w;}\nint pop_count(int x){int ans=0;for(;x;x>>=1)ans+=x&1;return ans;}\nint main(){\n\t//freopen(\".in\",\"r\",stdin);\n\t//freopen(\".out\",\"w\",stdout);\n\tios::sync_with_stdio(false);\n    cin.tie(nullptr);\n\tcin>>T;\n\twhile(T--){\n\t\tcin>>n>>m>>p>>q;\n\t\tfor(int i=1;i<=q;i++)cin>>a[i].x1>>a[i].y1>>a[i].x2>>a[i].y2>>a[i].w;\n\t\tfor(int i=1;i<=q;i++)a[i].x2++,a[i].y2++;\n\t\tvector<ll> v1,v2;v1.pd(1);v1.pd(n+1);v2.pd(1);v2.pd(n+1);\n\t\tfor(int i=1;i<=q;i++)v1.pd(a[i].x1),v2.pd(a[i].y1),v1.pd(a[i].x2),v2.pd(a[i].y2);\n\t\tsort(all(v1));sort(all(v2));v1.erase(unique(all(v1)),v1.end());v2.erase(unique(all(v2)),v2.end());\n\t\tfor(int i=1;i<=q;i++)a[i].x1=LB(all(v1),a[i].x1)-v1.begin()+1,a[i].y1=LB(all(v2),a[i].y1)-v2.begin()+1,\n\t\t\t\t\t\t\t a[i].x2=LB(all(v1),a[i].x2)-v1.begin()+1,a[i].y2=LB(all(v2),a[i].y2)-v2.begin()+1;\n\t\tfor(int i=0;i<v1.size()-1;i++)\n\t\t\tfor(int j=0;j<v2.size()-1;j++)\n\t\t\t\ts[i+1][j+1]=(v1[i+1]-v1[i])*(v2[j+1]-v2[j]);\n\t\tll ans=0;\n\t\tfor(int S=0;S<(1<<q);S++){\n\t\t\tvector<node> v;\n\t\t\tfor(int i=1;i<=q;i++){\n\t\t\t\tv.pd(a[i]);\n\t\t\t\tif(S>>(i-1)&1)v[i-1].w--;\n\t\t\t}sort(v.begin(),v.end(),cmp);\n\t\t\tll rs=1;\n\t\t\tfor(int i=1;i<v1.size();i++)\n\t\t\t\tfor(int j=1;j<v2.size();j++)\n\t\t\t\t\tvis[i][j]=false;\n\t\t\tfor(auto k:v){\n\t\t\t\tll t=0;\n\t\t\t\tfor(int i=k.x1;i<k.x2;i++)\n\t\t\t\t\tfor(int j=k.y1;j<k.y2;j++)\n\t\t\t\t\t\tif(!vis[i][j])\n\t\t\t\t\t\t\tvis[i][j]=true,\n\t\t\t\t\t\t\tt=(s[i][j]+t)%(mod-1);\n\t\t\t\trs=rs*QP(k.w,t,mod)%mod;\n\t\t\t}for(int i=1;i<v1.size();i++)\n\t\t\t\tfor(int j=1;j<v2.size();j++)\n\t\t\t\t\tif(!vis[i][j])\n\t\t\t\t\t\trs=rs*QP(p,s[i][j],mod)%mod;\n\t\t\tans=(ans+(pop_count(S)&1?(-1):(1))*rsod;\n\t\t}printf(\"%lld\\n\",(ans+mod)%mod);\n\t}\n}\n\n\n```\n",
        "postTime": 1684217938,
        "uid": 511271,
        "name": "\u30c0\u6708",
        "ccfLevel": 5,
        "title": "[FJOI2017]\u77e9\u9635\u586b\u6570"
    },
    {
        "content": "> $h\\times w$ \u7684\u77e9\u9635\uff0c\u6bcf\u4e2a\u683c\u5b50\u53ef\u4ee5\u586b $1\\sim m$ \u4e2d\u7684\u4e00\u4e2a\u6570\u3002$n$ \u4e2a\u9650\u5236\uff0c\u6bcf\u6761\u9650\u5236\u8981\u6c42\u67d0\u4e2a\u5b50\u77e9\u9635\u7684\u6700\u5927\u503c\u4e3a $v$\u3002\u6c42\u6ee1\u8db3\u6240\u6709\u9650\u5236\u7684\u586b\u6570\u65b9\u6848\u6570\u3002\n>\n> $1\\le h,w,m\\le 10^4$\uff0c$1\\le n\\le 10$\uff0c$1\\le v\\le m$\u3002 \n\n\u8003\u8651 $n$ \u5f88\u5c0f\uff0c\u6240\u4ee5\u5176\u5b9e\u77e9\u9635\u4e2d\u7684\u5173\u952e\u70b9\u4e0d\u591a\uff0c\u79bb\u6563\u5316\u4e4b\u540e\u5b8c\u5168\u53ef\u4ee5\u66b4\u529b\u626b\u63cf\u6574\u4e2a\u77e9\u9635\u6765\u505a\u3002\n\n\u4f46\u53d1\u73b0\u95ee\u9898\u5728\u4e8e\uff0c\u7c7b\u4f3c\u300c\u67d0\u4e2a\u5b50\u77e9\u9635\u6700\u5927\u503c\u5fc5\u987b\u4e3a $v$\u300d\u8fd9\u6837\u7684\u7ea6\u675f\u5e76\u4e0d\u597d\u505a\uff0c\u56e0\u4e3a\u7ea6\u675f\u6700\u5927\u503c\u4e3a $v$ \u5c31\u610f\u5473\u7740\u8be5\u5b50\u77e9\u9635\u4e2d\u7684\u6240\u6709\u503c\u90fd $\\le v$\uff0c\u4e14\u81f3\u5c11\u6709\u4e00\u4e2a\u503c\u4e3a $v$\u3002\n\n\u53d1\u73b0\u540e\u8005\u7684\u9650\u5236\u662f\u5f88\u4e0d\u5e73\u51e1\u7684\u3002\n\n\u4e8e\u662f\u6b63\u96be\u5219\u53cd\uff0c\u8003\u8651\u5c06\u8fd9\u6837\u7684\u7ea6\u675f\u5bb9\u65a5\u505a\u3002 \n\n\u5177\u4f53\u5730\uff0c\u4e0d\u59a8\u5c06\u6240\u6709\u503c\u7684\u4e0a\u754c\u4f5c\u4e3a\u5168\u96c6\uff0c\u300c\u81f3\u5c11\u6709\u4e00\u4e2a\u503c\u4e3a $v$ \u300d\u8fd9\u6837\u7684\u9650\u5236\u4f5c\u4e3a\u5c5e\u6027\uff0c\u5c06\u6c42\u89e3\u4ea4\u96c6\u8f6c\u5316\u4e3a\u6c42\u89e3\u8865\u96c6\u7684\u5e76\u96c6\uff0c\u5219\u300c\u81f3\u5c11\u6709\u4e00\u4e2a\u503c\u4e3a $v$\u300d\u8fd9\u6837\u7684\u5c5e\u6027\u5c31\u88ab\u6211\u4eec\u8f6c\u5316\u4e3a\u4e86\u66f4\u597d\u6c42\u89e3\u7684 \u300c\u6240\u6709\u503c\u90fd\u5c0f\u4e8e $v$\u300d\uff0c\u4e8e\u662f\u5957\u7528\u5bb9\u65a5\u6c42\u5e76\u96c6\u7684\u505a\u6cd5\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^32^n)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N=105;\nconst int mod=1e9+7;\nint t,h,w,m,n,lshx[N],ltotx,lshy[N],ltoty;\nstruct node{\n    int ax,ay,bx,by,v;\n}p[N];\nint read(){\n    int w=0,f=1;\n    char ch=getchar();\n    while (ch>'9'||ch<'0') {\n        if (ch=='-') f=-1;\n        ch=getchar();\n    }\n    while (ch>='0'&&ch<='9') {\n        w=(w<<3)+(w<<1)+(ch^48);\n        ch=getchar();\n    }\n    return w*f;\n}\nint coun(int x){\n    int y=0;\n    while (x){\n        if (x&1) ++y;\n        x>>=1;\n    }\n    return y;\n}\nll ksm(ll x,ll y){\n    ll ans=1;\n    while (y){\n        if (y&1) ans=ans*x%mod;\n        x=x*x%mod;\n        y>>=1;\n    }\n    return ans;\n}\nint main(){\n#ifndef ONLINE_JUDGE\n    freopen(\"in.in\",\"r\",stdin);\n#endif\n    t=read();\n    while (t--){\n        h=read(),w=read(),m=read(),n=read(),ltotx=ltoty=0;\n        for (int i=1;i<=n;i++){\n            lshx[++ltotx]=p[i].ax=read(),lshy[++ltoty]=p[i].ay=read(),lshx[++ltotx]=p[i].bx=read()+1,lshy[++ltoty]=p[i].by=read()+1,p[i].v=read();\n        }\n        lshx[++ltotx]=1,lshx[++ltotx]=h+1,lshy[++ltoty]=1,lshy[++ltoty]=w+1;\n        sort(lshx+1,lshx+1+ltotx);\n        ltotx=unique(lshx+1,lshx+1+ltotx)-lshx-1;\n        sort(lshy+1,lshy+1+ltoty);\n        ltoty=unique(lshy+1,lshy+1+ltoty)-lshy-1;\n        for (int i=1;i<=n;i++)\n            p[i].ax=lower_bound(lshx+1,lshx+1+ltotx,p[i].ax)-lshx,\n            p[i].ay=lower_bound(lshy+1,lshy+1+ltoty,p[i].ay)-lshy,\n            p[i].bx=lower_bound(lshx+1,lshx+1+ltotx,p[i].bx)-lshx,\n            p[i].by=lower_bound(lshy+1,lshy+1+ltoty,p[i].by)-lshy;\n        // for (int i=1;i<=ltotx;i++) cout<<lshx[i]<<\"\\n\";\n        // for (int i=1;i<=ltoty;i++) cout<<lshy[i]<<\"\\n\";\n        ll ans=0;\n        for (int i=0;i<(1<<n);i++){\n            int x=coun(i),f=(x&1)?-1:1;\n            ll num=1;\n            for (int b=1;b<=n;b++)\n                if (i&(1<<b-1)) p[b].v--;\n            for (int j=1;j<ltotx;j++){\n                for (int k=1;k<ltoty;k++){\n                    int g=(lshx[j+1]-lshx[j])*(lshy[k+1]-lshy[k]),maxn=m;\n                    for (int s=1;s<=n;s++)\n                        if (p[s].ax<=j&&j<p[s].bx&&p[s].ay<=k&&k<p[s].by) maxn=min(maxn,p[s].v);\n                    num=num*ksm(maxn,g)%mod;\n                    //cout<<num<<\"\\n\";\n                }\n            }\n            for (int b=1;b<=n;b++)\n                if (i&(1<<b-1)) p[b].v++;\n            ans=(ans+num*f)%mod;\n        }\n        cout<<(ans+mod)%mod<<\"\\n\";\n    }\n    return 0;\n}\n```",
        "postTime": 1678710769,
        "uid": 257621,
        "name": "\u7ffc\u5fb7\u5929\u5c0a",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P3813 [FJOI2017]\u77e9\u9635\u586b\u6570"
    },
    {
        "content": "\n## \u770b\u524d\u8bf7\u786e\u4fdd\u5df2\u7ecf\u6df1\u601d\u719f\u8651\uff0c\u7136\u540e\u98df\u7528\n\n\n##### \u89e3\u6790\n\u663e\u7136\u6211\u4eec\u60f3\u5230\u4e86\u72b6\u538bDP\uff0c\u4ee4 f[i][j] \u8868\u793a\u505a\u5230\u4e86\u7b2ci\u4e2a\u5757\u72b6\u6001\u4e3aj\u7684\u65b9\u6848\uff0cj\u8868\u793a\u54ea\u4e9b\u5757\u6ee1\u8db3\u9650\u5236\u3002\n\n\u6ce8\u610f\uff0c\u7531\u4e8e\u5b50\u77e9\u9635\u9650\u5236\u53ef\u80fd\u4f1a\u91cd\u53e0\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u9884\u5904\u7406\uff0c\u5c06\u77e9\u9635\u5206\u4e3a\u82e5\u5e72\u4e2a\u5c0f\u5757\uff0c\u6bcf\u4e2a\u5c0f\u5757\u4e2d\u4ec5\u6709\u4e00\u4e2a\u9650\u5236\u6761\u4ef6\uff08\u663e\u7136\u5c31\u662f\u6240\u6709\u8986\u76d6\u6761\u4ef6\u4e2d\u6700\u5c0f\u7684\u4e00\u4e2a\uff09\u3002\n\n\u7136\u540e\u6211\u4eec\u8bb0 Val \u8868\u793a\u8fd9\u4e00\u5757\u91cc\u9762\u7684\u9650\u5236\u503c\uff0cNum \u8868\u793a\u8fd9\u4e00\u5757\u7684\u4e2a\u6570\uff0c\u7136\u540e\u6211\u4eec\u518d\u8bb0\u4e2a op \u8868\u793a\u8986\u76d6\u54ea\u4e9b\u5757\u7684\u9650\u5236\u503c\u4e3aVal\u3002\n\n\u4e4b\u540e\u7528\u72b6\u538bDP\uff0c\u8003\u8651\u7b2c i \u5757\u662f\u5426\u53d6\u9650\u5236\u503c\uff0c\u53d6\u5219\u65b9\u6848\u6570\u4e3a (Val - 1) ^ Num\uff0c\u4e0d\u53d6\u5219\u65b9\u6848\u6570\u4e3a Val ^ Num - (Val - 1) ^ Num\u3002\n\n\u5f53\u53d6\u9650\u5236\u503c\u65f6\uff0c\u628a\u5bf9\u5e94\u65b9\u6848\u6570\u8f6c\u79fb\u5230 f[i + 1][j | op[i + 1]]\uff0c\u5426\u5219\u8f6c\u79fb\u5230 f[i + 1][j]\u3002\u6700\u540e\u7b54\u6848\u5c31\u662f f[cnt][all] \u4e86\n\n------------\n\n\n```cpp\n#include <bits/stdc++.h>//\u4e07\u80fd\u5934QwQ\nusing namespace std;\ntypedef long long ll;\nconst int MOD=1e9+7;\nint T;\nint h,w,m,n,all;\nint qx[1001],x,qy[1001],y;\nint Num[1001],Val[1001],op[1001],cnt;\nint f[1001][3001]= {0};\nstruct power\n{\n\tint x1,y1;\n\tint x2,y2;\n\tint val;\n} a[1001];\nint get()\n{\n\tint res=1,Q=1;\n\tchar c;\n\twhile((c=getchar())<48 || c>57 )//\u8f6c\u5316ing\n\t{\n\t\tif(c=='-')Q=-1;\n\t}\n\tres=c-48;\n\twhile((c=getchar())>=48 && c<=57 )\n\t{\n\t\tres=res*10+c-48;\n\t}\n\treturn res*Q;\n}\n\nll Quick(ll a,int b)\n{\n\tll res=1;\n\twhile(b)\n\t{\n\t\tif(b&1) res=res*a%MOD;\n\t\ta=(ll)a*a%MOD;\n\t\tb>>=1;\n\t}\n\treturn res;\n}\n\nvoid Deal_first()\n{\n\tsort(qx+1,qx+x+1);\n\tx=unique(qx+1,qx+x+1)-qx-1;\n\tsort(qy+1,qy+y+1);\n\ty=unique(qy+1,qy+y+1)-qy-1;\n\tcnt=0;\n\tfor(int i=2; i<=x; i++)\n\t\tfor(int j=2; j<=y; j++)\n\t\t{\n\t\t\tint lenx=qx[i]-qx[i-1];\n\t\t\tint leny=qy[j]-qy[j-1];\n\t\t\tNum[++cnt]=lenx*leny;\n\t\t\tVal[cnt]=m;\n\t\t\top[cnt]=0;\n\n\t\t\tfor(int l=1; l<=n; l++)\n\t\t\t\tif(a[l].x1<=qx[i-1] && qx[i]<=a[l].x2 && a[l].y1<=qy[j-1] && qy[j]<=a[l].y2)\n\t\t\t\t\tVal[cnt]=min(Val[cnt],a[l].val);\n\n\t\t\tfor(int l=1; l<=n; l++)\n\t\t\t\tif(a[l].val==Val[cnt])\n\t\t\t\t\tif(a[l].x1<=qx[i-1] && qx[i]<=a[l].x2 && a[l].y1<=qy[j-1] && qy[j]<=a[l].y2)\n\t\t\t\t\t\top[cnt]|=(1<<l-1);\n\t\t}\n}\n\nvoid Deal()\n{\n\tmemset(f,0,sizeof(f));\n\tf[0][0]=1;\n\n\tfor(int i=0; i<=cnt-1; i++)\n\t{\n\t\tfor(int opt=0; opt<=all; opt++)\n\t\t{\n\t\t\tif(f[i][opt])\n\t\t\t{\n\t\t\t\tf[i+1][opt|op[i+1]] = (f[i+1][opt|op[i+1]] + (ll)f[i][opt]*(ll)(Quick(Val[i+1],Num[i+1]\n                                -Quick(Val[i+1]-1,Num[i+1]) + MOD) % MOD) % MOD;\n\t\t\t\tf[i+1][opt] = (f[i+1][opt] + (ll)f[i][opt]*Quick(Val[i+1]-1,Num[i+1]) % MOD) % MOD;\n\n\t\t\t}\n\t\t}\n\t}\n}\nint main()\n{\n\tT=get();\n\twhile(T--)\n\t{\n\t\th=get();\n\t\tw=get();\n\t\tm=get();\n\t\tn=get();\n\t\tall=(1<<n)-1;\n\t\tx=y=0;\n\t\tfor(int i=1; i<=n; i++)\n\t\t{\n\t\t\ta[i].x1=get();\n\t\t\ta[i].y1=get();\n\t\t\ta[i].x2=get();\n\t\t\ta[i].y2=get();\n\t\t\ta[i].x1--;\n\t\t\ta[i].y1--;\n\t\t\ta[i].val=get();\n\t\t\tqx[++x]=a[i].x1;\n\t\t\tqx[++x]=a[i].x2;\n\t\t\tqy[++y]=a[i].y1;\n\t\t\tqy[++y]=a[i].y2;\n\t\t}\n\t\tqx[++x]=0;\n\t\tqx[++x]=h;\n\t\tqy[++y]=0;\n\t\tqy[++y]=w;\n\t\tDeal_first();\n\t\tDeal();\n\t\tprintf(\"%d\\n\",f[cnt][all]);\n\t}\n    return 0\uff1b//\u5b8c\u7f8e\u6536\u5b98\n}\n```\n\n\n[\u539f\u7f51\u5740](https://www.cnblogs.com/BearChild/p/7530456.html)\uff0c\u5df2\u8fc7\uff0c\u8bf7\u653e\u5fc3\u98df\u7528",
        "postTime": 1574431778,
        "uid": 128295,
        "name": "assassinRay",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3813 \u3010[FJOI2017]\u77e9\u9635\u586b\u6570\u3011"
    },
    {
        "content": "\n### \u4e00\u3001\u9898\u76ee\n\n[\u70b9\u6b64\u770b\u9898](https://www.luogu.org/problem/P3813)\n\n### \u4e8c\u3001\u89e3\u6cd5\n\n\u89c2\u5bdf\u6570\u7ec4\u8303\u56f4\uff0c\u53d1\u73b0$h,w$\u7279\u522b\u5927\uff0c\u800c\u9650\u5236\u53ea\u6709\u81f3\u591a$10$\u6761\uff0c\u6211\u4eec\u8003\u8651**\u79bb\u6563\u5316**\u3002\n\n\u600e\u4e48\u4e2a\u79bb\u6563\u5316\u6cd5\u5462\uff1f\u8003\u8651\u5c06\u6bcf\u4e00\u4e2a\u9650\u5236\u7684\u56db\u4e2a\u8fb9\u5ef6\u957f\uff0c\u8fd9\u6837\u5c31\u5c06\u5927\u77e9\u5f62\u5207\u5272\u6210\u4e86\u81f3\u591a$20\\times 20$\u4e2a\u5c0f\u77e9\u5f62\uff0c\u4e14\u8fd9\u4e9b\u5c0f\u77e9\u5f62\u7684\u6027\u8d28\u662f\u4e00\u6837\u7684\uff08\u88ab\u54ea\u4e9b\u9650\u5236\u5305\u542b\uff09\u3002\n\u5177\u4f53\u7684\u79bb\u6563\u5316\u64cd\u4f5c\u6211\u4eec\u628a\u5b83\u5f53\u505a\u5207\u6728\u68cd\uff0c\u5bf9\u4e8e$[l,r]$\uff0c\u6211\u4eec\u8fd9\u6837\u79bb\u6563\u5316\uff1a\n\n![\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0](https://img-blog.csdnimg.cn/20191028125824268.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0MyMDIwNDR6eHk=,size_16,color_FFFFFF,t_70)\n\n\u4e5f\u5c31\u662f\u6211\u4eec\u628a$l\uff0cr$\u5404\u5207\u4e00\u5200\uff0c\u5728$l$\u52a0\u4e0a\u4e00\u4e2a\u5de6\u62ec\u53f7\uff0c$l-1$\u52a0\u4e0a\u4e00\u4e2a\u53f3\u62ec\u53f7\uff0c$r$\u52a0\u4e0a\u4e00\u4e2a\u5de6\u62ec\u53f7\uff0c$r+1$\u52a0\u4e0a\u4e00\u4e2a\u53f3\u62ec\u53f7\uff0c\u79bb\u6563\u5316\u5c31\u53d8\u6210\u4e86\u62ec\u53f7\u5339\u914d\u95ee\u9898\uff0c\u6392\u5e8f\u540e\u5339\u914d\u76f8\u90bb\u7684\u62ec\u53f7\u5373\u53ef\u3002\n\n\u79bb\u6563\u5316\u540e\uff0c\u6211\u4eec\u53d1\u73b0\u6bcf\u4e2a\u9650\u5236\u4e2d\u53ea\u8981\u4e2d\u53ea\u8981\u6709\u4e00\u4e2a\u5c0f\u77e9\u5f62\u6ee1\u8db3\u9650\u5236\u5c31\u53ef\u4ee5\u4e86\uff0c\u7531\u4e8e\u9650\u5236\u6570\u5f88\u5c0f\uff0c\u8003\u8651\u72b6\u6001\u538b\u7f29\uff0c\u8bbe$dp[i][s]$\u4e3a\u524d$i$\u4e2a\u5c0f\u77e9\u5f62\u6ee1\u8db3\u72b6\u538b\u540e\u4e3a$s$\u7684\u6761\u4ef6\u7684\u65b9\u6848\u6570\uff0c\u6211\u4eec\u5148\u8003\u8651\u6bcf\u4e00\u4e2a\u5c0f\u77e9\u5f62\uff1a\n\n![\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0](https://img-blog.csdnimg.cn/20191027132133106.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0MyMDIwNDR6eHk=,size_16,color_FFFFFF,t_70)\n\n\u4e2d\u95f4\u7684\u90a3\u4e2a\u5c0f\u77e9\u5f62\u88ab\u4e24\u4e2a\u9650\u5236\u6240\u5305\u542b\uff0c\u4f46\u662f\u6211\u4eec\u53ea\u80fd\u6ee1\u8db3\u8981\u6c42\u6700\u5927\u503c\u4e3a$3$\u7684\u9650\u5236\uff0c\u6240\u4ee5\u6211\u4eec\u8bb0\u5c0f\u77e9\u5f62\u7684\u72b6\u6001\u4e3a$10$\uff08\u4e8c\u8fdb\u5236\uff09\uff0c$dp$\u65f6\u62ff\u539f\u72b6\u6001\u6216\u4e0a\u5c0f\u77e9\u5f62\u7684\u72b6\u6001\u5c31\u53ef\u4ee5\u5f97\u5230\u76ee\u6807\u72b6\u6001\u3002\u6211\u4eec\u518d\u8bb0$g[i]=(Min-1)^s$\uff08$s$\u4e3a\u5c0f\u77e9\u5f62\u7684\u9762\u79ef\uff09\uff0c\u5373\u65e0\u6cd5\u6ee1\u8db3\u4efb\u4f55\u4e00\u4e2a\u9650\u5236\u7684\u60c5\u51b5\uff0c$f[i]=Min^{s}-g[i]$\u4e3a\u80fd\u6ee1\u8db3\u6700\u5927\u503c\u6700\u5c0f\u7684\u9650\u5236\u7684\u60c5\u51b5\uff08\u6211\u4eec\u4e5f\u53ea\u80fd\u6ee1\u8db3\u8fd9\u4e9b\u9650\u5236\uff09\uff0c\u90a3\u6837\u6211\u4eec\u5c31\u80fd\u5199\u51fa\u5982\u4e0b$dp$\u65b9\u7a0b\uff08\u8bb0\u5c0f\u77e9\u5f62\u72b6\u6001\u4e3a$S$\uff09\uff1a\n\n$\\begin{cases}\ndp[i][j|S]=dp[i-1][j]\\times f[i] \\\\\ndp[i][j]=dp[i-1][j]\\times g[i]\n\\end{cases}$\n\n\u6700\u540e\u8f93\u51fa$dp[m][2^n-1]$\u5373\u53ef\uff08$m$\u662f\u5c0f\u77e9\u5f62\u7684\u4e2a\u6570\uff09\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$O(4n^{2}\\times 2^n)$\u3002\n\n\n```cpp\n#include <cstdio>\n#include <vector>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\n#define int long long\nconst int MOD = 1e9+7;\n\nconst int MAXN = 10005;\nint read()\n{\n\tint x=0,flag=1;char c;\n\twhile((c=getchar())<'0' || c>'9') if(c=='-') flag=-1;\n\twhile(c>='0' && c<='9') x=(x<<3)+(x<<1)+(c^48),c=getchar();\n\treturn x*flag;\n}\nint T,h,w,m,n,cnt,oth,dp[505][1<<10];\nint x1[MAXN],y1[MAXN],x2[MAXN],y2[MAXN],v[MAXN];\nbool vx[MAXN][2],vy[MAXN][2];\nvector<pair<int,int> > x,y;\nstruct node\n{\n    int f,g,s;\n}a[505];\nvoid add(int z,bool d,bool type)\n{\n    if(!type) x.push_back(make_pair(z,d)),vx[z][d]=1;\n    else y.push_back(make_pair(z,d)),vy[z][d]=1;\n}\nint qkpow(int a,int b)\n{\n    int res=1;\n    while(b>0)\n    {\n        if(b&1) res=res*a%MOD;\n        a=a*a%MOD;\n        b>>=1;\n    }\n    return res;\n}\nsigned main()\n{\n    T=read();\n    while(T--)\n    {\n        h=read();w=read();m=read();n=read();\n        cnt=oth=0;\n        memset(vx,0,sizeof vx);\n        memset(vy,0,sizeof vy);\n        memset(dp,0,sizeof dp);\n        x.clear();y.clear();\n        add(1,0,0);add(h,1,0);\n        add(1,0,1);add(w,1,1);\n        for(int i=1;i<=n;i++)\n        {\n            x1[i]=read();y1[i]=read();x2[i]=read();y2[i]=read();v[i]=read();\n            if(x1[i]>1 && !vx[x1[i]-1][1])\n                add(x1[i]-1,1,0);\n            if(!vx[x1[i]][0])\n                add(x1[i],0,0);\n            if(x2[i]<h && !vx[x2[i]+1][0])\n                add(x2[i]+1,0,0);\n            if(!vx[x2[i]][1])\n                add(x2[i],1,0);\n            if(y1[i]>1 && !vy[y1[i]-1][1])\n                add(y1[i]-1,1,1);\n            if(!vy[y1[i]][0])\n                add(y1[i],0,1);\n            if(y2[i]<w && !vy[y2[i]+1][0])\n                add(y2[i]+1,0,1);\n            if(!vy[y2[i]][1])\n                add(y2[i],1,1);\n        }\n        sort(x.begin(),x.end());\n        sort(y.begin(),y.end());\n        for(int i=0;i<x.size();i+=2)\n            for(int j=0;j<y.size();j+=2)\n            {\n                int a1=x[i].first,a2=x[i+1].first;\n                int b1=y[j].first,b2=y[j+1].first;\n                int siz=(a2-a1+1)*(b2-b1+1),s=0,Min=m;\n                for(int k=1;k<=n;k++)\n                {\n                    if(a1>=x1[k] && a2<=x2[k] && b1>=y1[k] && b2<=y2[k])\n                    {\n                        if(Min>v[k])\n                        {\n                            Min=v[k];\n                            s=0;\n                        }\n                        if(Min==v[k]) s|=(1<<k-1);\n                    }\n                }\n                int g=qkpow(Min-1,siz),f=qkpow(Min,siz)-g;\n                if(!s) oth+=siz;\n                else  a[++cnt]=node{f,g,s};\n            }\n        dp[0][0]=1;\n        for(int i=1;i<=cnt;i++)\n        {\n            for(int j=0;j<(1<<n);j++)\n                dp[i][j|a[i].s]=(dp[i][j|a[i].s]+dp[i-1][j]*a[i].f)%MOD;\n            for(int j=0;j<(1<<n);j++)\n                dp[i][j]=(dp[i][j]+dp[i-1][j]*a[i].g)%MOD;\n        }\n        printf(\"%d\\n\",(dp[cnt][(1<<n)-1]*qkpow(m,oth)%MOD+MOD)%MOD);\n    }\n}\n\n```\n",
        "postTime": 1572242730,
        "uid": 128239,
        "name": "C20203030",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3813 \u3010[FJOI2017]\u77e9\u9635\u586b\u6570\u3011"
    }
]
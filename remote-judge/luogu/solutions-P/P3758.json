[
    {
        "content": "\u8fd9\u9053\u9898\u6211\u4eec\u53ef\u4ee5\u4ece**\u90bb\u63a5\u77e9\u9635**\u7684**\u5e42**\u7684\u610f\u4e49\u8003\u8651\u3002\n\n\u8bbe\u73b0\u5728\u6709\u4e00\u4e2a\u90bb\u63a5\u77e9\u9635$A$\u3002\n\n\u90a3\u4e48$A^k$\u7684\u610f\u4e49\u662f\u4ec0\u4e48\uff1f\uff08\u4e24\u4e2a\u70b9\u4e4b\u95f4\u82e5\u6709\u8fb9\u5219$A[u][v]=1$\uff09\n\n\u4ece$floyd$\u7b97\u6cd5\u7684\u89d2\u5ea6\u8003\u8651\uff0c\u4e0d\u96be\u53d1\u73b0$A^k$\u7684\u7b2c$i$\u884c\u7b2c$j$\u5217\u7684\u6570\u5b57\u542b\u4e49\u662f\u4ece$i$\u5230$j$\u7ecf\u8fc7$k$\u6b65\u7684\u8def\u5f84\u65b9\u6848\u603b\u6570\u3002\n\n\u4ece\u8fd9\u4e2a\u89d2\u5ea6\u8003\u8651\uff0c\u8fd9\u4e2a\u70b9\u5c31\u6709\u4e86\u4e00\u79cd\u505a\u6cd5\u3002\n\n\u9996\u5148\u5c06\u8fd9\u4e2a\u56fe\u7684\u90bb\u63a5\u77e9\u9635\u5efa\u51fa\u6765\uff0c\u7136\u540e\u76f4\u63a5\u7b97\u8fd9\u4e2a\u77e9\u9635\u7684$k$\u6b21\u65b9\u3002\n\n\u6700\u540e\u7edf\u8ba1$\\sum\\limits_{i=1}^{n}A[1][i]$\u5c31\u662f\u7b54\u6848\u3002\n\n\u90a3\u4e48\u5728\u539f\u5730\u505c\u7559\u548c\u81ea\u7206\u600e\u4e48\u5904\u7406\uff1f\n\n\u5728\u539f\u5730\u505c\u7559\u5f88\u7b80\u5355\uff0c\u6211\u4eec\u53ea\u8981\u8ba4\u4e3a\u6bcf\u4e2a\u70b9\u90fd\u6709\u4e00\u4e2a\u4ece\u81ea\u5df1\u5230\u81ea\u5df1\u7684\u81ea\u73af\u5373\u53ef\u3002\n\n\u90a3\u81ea\u7206\u5462\uff1f\n\n\u6211\u4eec\u53ef\u4ee5\u5c06\u81ea\u7206\u8fd9\u4e2a**\u72b6\u6001**\u4e5f\u770b\u6210\u4e00\u4e2a**\u57ce\u5e02**\uff0c\u5c31\u8bbe\u5b83\u4e3a\u7f16\u53f7$0$\u3002\n\n\u6211\u4eec\u5728\u90bb\u63a5\u77e9\u9635\u4e0a\u4ece\u6bcf\u4e2a\u70b9\u90fd\u5411\u8fd9\u4e2a\u70b9\u8fde\u4e00\u6761\u8fb9\uff0c\u8fd9\u4e2a\u70b9\u9664\u4e86\u81ea\u5df1\u5916\u4e0d\u8fde\u5176\u4ed6\u51fa\u8fb9\u3002\n\n\u8fd9\u6837\u5c31\u6ee1\u8db3\u4e86\u4efb\u4f55\u4e00\u4e2a\u70b9\u968f\u65f6\u53ef\u4ee5\u81ea\u7206\uff0c\u4e14\u65e0\u6cd5\u6062\u590d\u5230\u5176\u4ed6\u72b6\u6001\u3002\n\n\u6700\u540e\uff0c\u7edf\u8ba1\u7b54\u6848\u3002$Ans=\\sum\\limits_{i=0}^{n}A[1][i]$\n\n\u4ee3\u7801\u5982\u4e0b\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<cstdlib>\n#include<cctype>\n#include<cmath>\n#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<set>\n#include<map>\n#include<queue>\n#include<stack>\ntypedef long long ll;\ntypedef unsigned long long ull;\nusing namespace std;\nconst int P=2017;\nstruct Matrix{\n    int a[31][31];\n    inline Matrix operator * (const Matrix &rhs)\n    {\n        Matrix ret;\n        memset(&ret,0,sizeof ret);\n        for(int i=0;i<=30;i++)\n            for(int j=0;j<=30;j++)\n                for(int k=0;k<=30;k++)\n                    (ret.a[i][j]+=a[i][k]*rhs.a[k][j]%P)%=P;\n        return ret;\n    }\n}mp;\nMatrix ksm(Matrix &a,int b)\n{\n    Matrix ret;\n    memset(&ret,0,sizeof ret);\n    for(int i=0;i<=30;i++) ret.a[i][i]=1;\n    while(b)\n    {\n        if(b&1) ret=ret*a;\n        a=a*a;b>>=1;\n    }\n    return ret;\n}\nint u,v,n,m,t;\nint main()\n{\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=m;i++)\n    {\n        scanf(\"%d%d\",&u,&v);\n        mp.a[u][v]=1;mp.a[v][u]=1;\n    }\n    for(int i=0;i<=n;i++)\n        mp.a[i][i]=1;\n    for(int i=1;i<=n;i++) mp.a[i][0]=1;\n    int ans=0;\n    scanf(\"%d\",&t);\n    Matrix anss=ksm(mp,t);\n    for(int i=0;i<=n;i++) (ans+=anss.a[1][i])%=P;\n    printf(\"%d\\n\",ans);\n}\n```",
        "postTime": 1522323463,
        "uid": 31565,
        "name": "Zhang_RQ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3758 \u3010[TJOI2017]\u53ef\u4e50\u3011"
    },
    {
        "content": "## \u5206\u5c42\u56feDP\n\n\u6211\u505a\u8fd9\u9898\u672c\u6765\u662f\u51b2\u7740\u5b83\u90a3\u4e2a\u201c\u500d\u589e\u201d\u6807\u7b7e\u6765\u7684\uff0c\u7ed3\u679c\u8fdb\u6765\u4e00\u770b\uff0c\u54df\uff0c\u4e0d\u662f\u6807\u51c6\u7684**\u5206\u5c42\u56feDP**\u561b\uff0c\u6109\u5feb\u5730\u6572\u8d77\u4e86\u4ee3\u7801\uff0c20\u5206\u79cd\uff0c\u611f\u8c22\u6211\u4eec\u53ef\u7231\u7684\u6c27\u6c14\u540c\u5fd7\u548c\u8bc4\u6d4b\u673a\u540c\u5fd7\uff0c\u75db\u5feb\u5730AC\u4e86\u8fd9\u9898\n\n\u5206\u5c42\u56fe\u5927\u5bb6\u5e94\u8be5\u90fd\u77e5\u9053\uff08\u8fd9\u5176\u5b9e\u5c31\u662fDP\uff09\uff0c\u901a\u5e38\u72b6\u6001\u662f\uff1a\n\n$f[j][u][...]$\u4ee3\u8868\u5728\u7b2c$j$\u65f6\u523b\uff0c\u5728\u8282\u70b9$u$,\u7136\u540e\u72b6\u6001\u4e3a$...$\u7684\u6700\u4f18\u5316/\u8ba1\u6570\u7b49\n\n\u8fd9\u9053\u9898\u5c31\u662f\u4e2a\u6734\u7d20\u7684\u5206\u5c42\u56feDP\uff0c  \n\n$f[j][u]$\u8868\u793a\u7b2c$j$\u65f6\u523b\uff0c\u5728\u8282\u70b9$u$\u7684\u60c5\u51b5\u6570\n\n\u7136\u540e\u662f\u5904\u7406\u7206\u70b8\u3002\u5f53\u7136\u6211\u4eec\u53ef\u4ee5\u52a0\u5165\u72b6\u6001\uff0c\u4f46\u662f\u4e3a\u4e86\u540e\u9762\u66f4\u597d\u5730\u505a\u77e9\u9635\u4e58\u6cd5\uff0c\u6211\u4eec\u51b3\u5b9a\u628a\u4ed6\u642c\u5230\u751f\u6d3b\u4e2d\u6765\n\n> \u4e00\u4e2a\u673a\u5668\u4eba\uff0c\u5982\u679c\u5b83\u9009\u62e9\u4e86\u6b7b\u4ea1\uff0c\u90a3\u4e48\u8fd9\u5c06\u662f\u5b83\u4e00\u4e2a\u6709\u53bb\u65e0\u56de\u7684\u8def\uff0c\u4e00\u4e2a\u4e0d\u53ef\u9006\u8f6c\u7684\u8def\uff0c\u5b83\u5c06\u6c38\u8fdc\u5446\u5728\u91cc\u9762\u2026\u2026\n\n\u5bf9\u5c31\u662f\u8fd9\u6837\uff01\u8fd9\u662f\u4e2a\u6709\u53bb\u65e0\u56de\u7684\u5355\u5411\u8fb9\uff01\u7206\u70b8\u7684\u6b7b\u4ea1\u8282\u70b9\u7684\u8def\u662f\u65e0\u6cd5\u9006\u8f6c\u7684\uff01\n\n\u597d\u7684\uff0c\u6211\u4eec**\u521b\u5efa\u4e00\u4e2a\u6b7b\u4ea1\u8282\u70b9**$n+1$\uff0c\u6240\u6709\u70b9\u8fde\u5411\u5b83\uff0c\u7136\u800c\u5b83\u4e0d\u80fd\u8fde\u5411\u522b\u4eba\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=39,M=109; \nstruct edge{int to,nxt;}e[(M+N)<<1]; int hd[N],tot;\nvoid add(int u,int v){\n\te[++tot]=(edge){v,hd[u]}; hd[u]=tot;\n}\nint n,m,t,ans,f[1000002][32];\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1,u,v;i<=m;i++) scanf(\"%d%d\",&u,&v),add(u,v),add(v,u);\n\tscanf(\"%d\",&t);\n\tfor(int i=1;i<=n;i++) add(i,n+1),add(i,i); f[0][1]=1; add(n+1,n+1);\n\tfor(int j=0;j<=t;j++){\n\t\tfor(int u=1;u<=n+1;u++){\n\t\t\tfor(int i=hd[u];i;i=e[i].nxt){\n\t\t\t\tf[j+1][e[i].to]=(f[j+1][e[i].to]+f[j][u])%2017; \n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=n+1;i++) ans=(ans+f[t][i])%2017;\n\tprintf(\"%d\",ans);\n\treturn 0;\n}\n```\n\uff08\u6ce8\uff1a\u5982\u679c$f$\u6570\u7ec4\u518d\u5f00\u5927\u4e00\u70b9\u5c31\u4f1aMLE\uff0c\u6240\u4ee5\u561b\u3002\u3002\u3002\uff09\n\n## \u7cbe\u76ca\u6c42\u7cbe--\u77e9\u9635\u4e58\u6cd5\n\n\u7ecf\u8fc7\u6c27\u6c14\u540c\u5fd7\u548c\u8bc4\u6d4b\u673a\u540c\u5fd7\u7684\u4e0d\u61c8\u52aa\u529b\u4e0b\uff0c\u6211\u4eecAC\u4e86\u8fd9\u4e2a\u9898\u76ee\n\n\u53ef\u662f\u6211\u4eec\u8981\u6709\u804c\u4e1a\u7cbe\u795e\uff0c\u53d6\u5f97\u66f4\u597d\u7684\u6210\u7ee9\uff0c\u800c\u4e0d\u662f\u4f9d\u8d56\u4e8e\u6211\u4eec\u7684\u597d\u670b\u53cb\u6c27\u6c14\u548c\u8bc4\u6d4b\u673a\n\n\u6211\u4eec\u518d\u770b\u4e00\u773c\u8f6c\u79fb\u65b9\u7a0b\uff1a\n```cpp\nf[j+1][e[i].to]=(f[j+1][e[i].to]+f[j][u])%2017;\n```\n\n\u4f60\u770b\u5230\u4e86\u4ec0\u4e48\uff1f**\u5e38\u7cfb\u6570\u7ebf\u6027\u53d8\u6362**\uff01\u800c\u4e14$n\\le 30$ \uff01\u8fd9\u662f**\u77e9\u9635\u4e58\u6cd5**\u7684\u6807\u5fd7!\n\n\u63a8\u4e00\u4e0b\u5c31\u77e5\u9053\uff0c\u8f6c\u79fb\u77e9\u9635\u5176\u5b9e\u5c31\u662f\u6211\u4eec\u7684\u90bb\u63a5\u77e9\u9635\uff0c\u4e8e\u662f\uff0c\u4fee\u6539\u8fc7\u7684\u90bb\u63a5\u77e9\u9635\u505a\u4e00\u4e2a\u77e9\u9635\u5feb\u901f\u5e42\u5c31\u597d\u4e86\n\n\u5176\u5b9e\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u9053\u9898\u5c31\u662f\u4f20\u7403\u6e38\u620f\u7684\u4e00\u4e2a\u53d8\u79cd\uff0c\u6211\u4eec\u53ea\u9700\u8981\u52a0\u5165\u6b7b\u4ea1\u8282\u70b9\u4e4b\u540e\uff0c\u4e00\u5207\u5c31\u53d8\u5f97\u7b80\u5355\u65e0\u6bd4\u4e86\n\n\u7136\u540e\u6211\u4eec\u4e3a\u4e86\u7b80\u5316\u4e00\u4e0b\u77e9\u9635\uff08\u5176\u5b9e\u4e5f\u6ca1\u591a\u5c11\uff09\uff0c\u6b7b\u4ea1\u8282\u70b9\u53d8\u6210$0$\u53f7\u8282\u70b9\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,m,t,ans;\nstruct mat{ //\u6734\u7d20\u77e9\u9635 \n\tint a[33][33];\n\tmat(){memset(a,0,sizeof(a));}\n\tmat operator *(const mat b)const{\n\t\tmat c;\n\t\tfor(int i=0;i<=n;i++)\n\t\t\tfor(int j=0;j<=n;j++)\n\t\t\t\tfor(int k=0;k<=n;k++)\n\t\t\t\t\tc.a[i][j]=(c.a[i][j]+a[i][k]*b.a[k][j])%2017;\n\t\treturn c;\n\t}\n}I,E,ansm;\nmat pow(mat a,int p){ //\u6734\u7d20\u5feb\u901f\u5e42 \n\tif(p==0) return I;\n\tif(p==1) return a;\n\tmat tmp=pow(a*a,p/2);\n\tif(p%2) return tmp*a;\n\telse return tmp;\n}\nint main(){\n\tscanf(\"%d%d\",&n,&m,&t);\n\tfor(int i=1,u,v;i<=m;i++) scanf(\"%d%d\",&u,&v),E.a[u][v]=E.a[v][u]=1; //\u6734\u7d20\u90bb\u63a5\u77e9\u9635 \n\tfor(int i=0;i<=n;i++) I.a[i][i]=E.a[i][i]=1,E.a[i][0]=1; //\u65b0\u8fb9\u548c\u5355\u4f4d\u77e9\u9635 \n\tscanf(\"%d\",&t); ansm=pow(E,t); //\u77e9\u9635\u5feb\u901f\u5e42 \n\tfor(int i=0;i<=n;i++) ans+=ansm.a[1][i]; //\u7edf\u8ba1\u7b54\u6848 \n\tprintf(\"%d\",ans%2017);\n\treturn 0;\n}\n```\n\n\u5176\u5b9e\u8fd9\u4efd\u4ee3\u7801\u9664\u4e86\u4e24\u884c\u6dfb\u52a0\u65b0\u8fb9\u548c\u7edf\u8ba1\u7b54\u6848\uff0c\u5168\u90e8\u90fd\u662f\u90bb\u63a5\u77e9\u9635\u5feb\u901f\u5e42\u7684\u6a21\u677f\uff0c\u6240\u4ee5\u5176\u5b9e\u8fd9\u79cd\u9898\u578b\u9700\u8981\u66f4\u52a0\u719f\u7ec3\u624d\u884c\uff0c\u8bf4\u4e0d\u5b9a\u4e0b\u6b21\u6c27\u6c14\u548c\u8bc4\u6d4b\u673a\u5c31\u62ef\u6551\u4e0d\u4e86\u4f60\u4e86\u5462",
        "postTime": 1583504668,
        "uid": 180652,
        "name": "_lgswdn",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3758 \u3010[TJOI2017]\u53ef\u4e50\u3011"
    },
    {
        "content": "\u770b\u4e86\u4e00\u5708\u4e0b\u9762\u7684\u9898\u89e3\uff0c\u5173\u4e8e\u90bb\u63a5\u77e9\u9635\u7684k\u6b21\u65b9\u7684\u89e3\u91ca\u57fa\u672c\u4e0a\u90fd\u662f\u76f4\u63a5\u7ed9\u7ed3\u8bba\u7684\u3002\n\n\u8fd9\u9898\u7684\u8fde\u8fb9\u5df2\u7ecf\u6709\u5927\u4f6c\u89e3\u91ca\u4e86\uff0c\u7206\u70b8\u76f8\u5f53\u4e8e\u8fde\u4e00\u4e2a\u865a\u62df\u70b9\uff0c\u505c\u7559\u76f8\u5f53\u4e8e\u81ea\u73af\u3002\n\n\u90a3\u4e48\u63a5\u4e0b\u6765\u6211\u6765\u89e3\u91ca\u4e00\u4e0b\u90a3\u4e2a\u795e\u79d8\u7684\u7ed3\u8bba\u3002\n\n\u5148\u4e0d\u8003\u8651\u9898\u8bbe\u91cc\u7684\u8be1\u5f02\u64cd\u4f5c\u3002\u6211\u4eec\u6765\u601d\u8003\u4e00\u5f20\u7b80\u5355\u56fe\n\n![](https://cdn.luogu.com.cn/upload/pic/50067.png )\n\n\u4e3a\u4e86\u7a0d\u5fae\u590d\u6742\u4e00\u70b9\u70b9\uff0c\u6211\u4eec\u5047\u5b9a\u8fd9\u91cc\u6bcf\u4e2a\u70b9\u90fd\u6709\u4e2a\u81ea\u73af\u3002\n\n\u53ef\u4ee5\u77e5\u9053\uff0c\u90bb\u63a5\u77e9\u9635\u91cc\u957f\u8fd9\u6837\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/50070.png)\n\n\n\u601d\u8def\u662f\u8fd9\u6837\uff0c\u6211\u4eec\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5bf9\u4e8e\u4ece1\u52301\u8d70\u4e24\u6b65\u7684\u65b9\u6848\uff1a\n\u4e09\u79cd\u65b9\u6848\uff1a\n\n\u57281\u4f11\u606f\u2014\u57281\u4f11\u606f\u3002\n\n\u53bb2\u2014\u56de1\n\n\u53bb3\u2014\u56de1\n\n\u5bf9\u5e94\u5230\u77e9\u9635\u91cc\uff0c\u8fd9\u4e9b\u65b9\u6848\u5206\u522b\u662f\uff1a\n\n1 1 *1 1     \u4f11\u606f\u4e00\u6b21\u7684\u65b9\u6848\u6570*\u4f11\u606f\u4e00\u6b21\u7684\u65b9\u6848\u6570\n\n2 1*1 2      1->2\u7684\u65b9\u6848\u6570*2->1\u7684\u65b9\u6848\u6570\n\n3 1*1 3      1->3\u7684\u65b9\u6848\u6570*3->1\u7684\u65b9\u6848\u6570\n\n\u52a0\u8d77\u6765\uff0c3\u79cd\u3002\n\n\u4ee5\u53ca\u4e0d\u6210\u7acb\u76844 1*1 4=0      1->4\u2014\u2014\u4e0d\u901a\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\uff0c\u8fd9\u4e00\u6b65\u64cd\u4f5c\u5b9e\u9645\u4e0a\u505a\u4e86\u4e00\u90e8\u5206\u7684\u77e9\u9635\u4e58\u6cd5\u3002\n\n\u641e\u5b8c\u6574\u4e2a\u8868\u683c\uff0c\u5b83\u5c31\u957f\u6210\u8fd9\u6837\u5b50\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/50069.png)\n\n\u7c7b\u4f3c\u7684\uff0c\u5bf9\u4e8e\u77e9\u9635a\u7684k\u6b21\u65b9\uff0c\u5b83\u7684i\u884cj\u5217\u5b9e\u9645\u4e0a\u5c31\u662f\u8dd1k\u6b65\uff0ci\u6070\u597d\u8d70\u5230j\u7684\u5bf9\u5e94\u65b9\u6848\u6570\u3002\n\n\u8dd1\u677f\u5b50\uff0c\u6ca1\u4e86\u3002\n\n\u4ee3\u7801\u5949\u4e0a\u3002\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nll n,j,k,t,y,x,anss,m,f[1001],mo=2017;\nstruct mat\n{\n    ll a[101][101];\n    mat(){memset(a,0,sizeof(a));}\n    void beg(){for(int i=1;i<=n;i++)a[i][i]=1;\n    }\n    \n}a,ans;\nmat operator *(const mat &x,const mat &y)\n    {\n    mat z;\n    for(int k=1;k<=n;++k)\n    for(int i=1;i<=n;++i)\n    for(int j=1;j<=n;++j)\n    z.a[i][j]=(z.a[i][j]+x.a[i][k]*y.a[k][j]%mo)%mo;\n    return z;\n    }\nint main() \n{\n    cin>>n>>m;\n    n++;\n    for(int i=1;i<=m;i++)\n    {cin>>x>>y;a.a[x][y]=1;a.a[y][x]=1;}\n    for(int i=1;i<=n;i++)a.a[i][n]=1,a.a[i][i]=1;\n    ans.beg();\n    cin>>k;\n    do\n    {\n        if(k&1)ans=ans*a;\n        a=a*a;k>>=1;\n    }while(k);\n    for(int i=1;i<=n;i++)(anss+=ans.a[1][i])%=mo;\n    cout<<anss;\n    return 0;\n}\n```",
        "postTime": 1548655512,
        "uid": 87316,
        "name": "Asuka\u4e8c\u53f7\u673a",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3758 \u3010[TJOI2017]\u53ef\u4e50\u3011"
    },
    {
        "content": "\u9996\u5148\u770b\u5230\u8fd9\u4e2a\u9898\uff0c\u611f\u89c9\u975e\u5e38\u4e0d\u53ef\u505a\u2026\u2026\n\n\u7136\u540e\u5c1d\u8bd5\u5199\u4e86\u4e2a\u66b4\u529b\u3002\n\n\u7531\u4e8e\u8fd9\u4e2a\u9898\u7684$n$\u4e0d\u662f\u5f88\u5927\uff0c\u6240\u4ee5\u6211\u4eec\u91c7\u7528\u90bb\u63a5\u77e9\u9635\u6765\u5b58\u50a8\u56fe\u7684\u5173\u7cfb\u3002\n\n\u800c\u4e14\u5bf9\u4e8e\u505c\u5728\u539f\u5730\u53ef\u4ee5\u5c06\u5b83\u770b\u6210\u81ea\u73af\uff1b\u5bf9\u4e8e\u81ea\u7206\u53ef\u4ee5\u865a\u62df\u51fa\u4e00\u4e2a\u8282\u70b9$0$\uff0c\u4f7f\u6bcf\u4e2a\u8282\u70b9\u90fd\u5411\u5b83\u8fde\u6709\u8fb9\uff0c\u800c\u5b83\u53ea\u5411\u81ea\u5df1\u8fde\u6709\u8fb9\u3002\n\n\u5bf9\u4e8e\u7b2c$i$\u79d2\u4e4b\u540e\u5230\u8fbe$j$\u8282\u70b9\u7684\u65b9\u6848\u6570$dp[i][j]$\uff0c\u6709\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b$dp[i][j]=\\sum\\limits_{k=0}^ndp[i-1][k]*mp[k][j]$\u3002\n\n\u7136\u9e45\u8fd9\u6837\u590d\u6742\u5ea6\u4e3a$O(t*n^2)$\uff0c\u7406\u8bba\u4e0a\u6765\u8bb2\u53ef\u80fd\u4f1a\u88ab\u5361\u6389\uff0c\u90a3\u6211\u4eec\u60f3\u60f3\u6709\u6ca1\u6709\u66f4\u4f18\u7684\u505a\u6cd5\u5462\uff1f\n\n\u5176\u5b9e\u8fd9\u9898\u7684\u4e3b\u8981\u5361\u70b9\u5728\u4e8e\uff0c$t$\u592a\u5927\u4e86\uff0c\u53ea\u8981\u590d\u6742\u5ea6\u91cc\u5e26\u4e0a\u4e86$t$\uff0c\u5c31\u6709\u53ef\u80fd\u88ab\u5361\u6389\u3002\n\n\u90a3\u6709\u6ca1\u6709\u6bd4$O(t)$\u66f4\u5feb\u7684\u590d\u6742\u5ea6\u5462\uff1f\n\n$O(\\log t)$\uff01\n\n\u4e8e\u662f\u6211\u4eec\u6765\u60f3\u60f3\u5e26$\\log$\u7684\u7b97\u6cd5\u3002\n\n\u6811\u72b6\u6570\u7ec4\uff1f\u7ebf\u6bb5\u6811\uff1f\u5e73\u8861\u6811\uff1f~~\u663e\u7136\u4e0d\u662f~~\n\n\u4e8c\u5206\u67e5\u627e\uff1f\u4e8c\u5206\u7b54\u6848\uff1f\u5806\uff1f~~\u90a3\u66f4\u4e0d\u53ef\u80fd\u4e86~~\n\n\u4e8e\u662f\u6211\u4eec\u60f3\u5230\u4e86\u5206\u6cbb\uff01\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u4ee4$mdp[i][j][k]$\u4e3a\u7ecf\u8fc7$i$\u79d2\u4ece$j$\u8d70\u5230$k$\u7684\u65b9\u6848\u6570\u3002\n\n\u5219$mdp[i][j][k]=\\sum\\limits_{l=0}^nmdp[i-x][j][l]*mdp[x][l][k]$\uff08\u5176\u4e2d$x$\u4e3a\u4efb\u610f\u5e38\u6570\uff09\u3002\n\n\u4e14$mdp[1][i][j]=mp[i][j]$\u3002\n\n\u6240\u6c42\u7ed3\u679c\u5c31\u662f$\\sum\\limits_{i=0}^nmdp[t][1][i]$\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u5229\u7528\u5206\u6cbb\u6c42\u89e3\u4e86\u3002\n\n\u5177\u4f53\u4ee3\u7801\u6211\u5c31\u4e0d\u4e0a\u4e86\uff0c\u6bd5\u7adf\u8fd9\u9898\u4e0d\u96be\u5b9e\u73b0\uff0c\u800c\u4e14\u8fd9\u91cc\u4e3b\u8981\u8bb2\u601d\u60f3\u3002",
        "postTime": 1581563105,
        "uid": 104662,
        "name": "PrincessQi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3758 \u3010[TJOI2017]\u53ef\u4e50\u3011"
    },
    {
        "content": "# \u5173\u4e8e\u81ea\u7206\u7684\u5904\u7406\n\n\u4f17\u591a\u9898\u89e3\u7684\u505a\u6cd5\u90fd\u662f\u521b\u5efa\u4e00\u4e2a\u865a\u62df\u70b90\u8ba9\u4ed6\u8d70\u8fc7\u53bb\uff0c\u786e\u5b9e\u975e\u5e38\u5de7\u5999\uff0c\u4f46\u662f\u50cf\u6211\u8fd9\u6837\u7684\u849f\u84bb\u662f\u60f3\u4e0d\u5230\u8fd9\u6837\u5de7\u5999\u7684\u65b9\u6cd5\u7684\u2026\u2026\n\n\u8003\u8651\u81ea\u7206\u610f\u5473\u7740\u505c\u6b62\u884c\u52a8\u3002\u6240\u4ee5\u9898\u76ee\u8ba9\u6211\u4eec\u6c42\u7684\u5176\u5b9e\u7b49\u4ef7\u4e8e\u65f6\u95f4\u4e3a0,1,2,3...t\u7684\u6240\u6709\u65b9\u6848\u3002\n\n\u5047\u8bbe\u90bb\u63a5\u77e9\u9635\u4e3a$G$\uff0c\u5219\u5bf9\u4e8e\u65f6\u95f4\u4e3a$t$\u7684\u60c5\u51b5\uff0c\u7b54\u6848\u5e94\u8be5\u662f$G^t$\u7684\u7b2c\u4e00\u884c\u4e4b\u548c\u3002\u56e0\u6b64\u6240\u6709\u60c5\u51b5\u7684\u7b54\u6848\u5c31\u662f$1+G+G^1+G^2+...+G^t$\u7684\u7b2c\u4e00\u884c\u4e4b\u548c\n\n\u8003\u8651\u4f7f\u7528\u5206\u5757\u77e9\u9635\uff0c\u6784\u5efa\u4e00\u4e2a\u5982\u4e0b\u77e9\u9635\uff1a$$\\begin{bmatrix}G & G\\\\ 0 & 1\\end{bmatrix}$$\u5bb9\u6613\u53d1\u73b0\uff0c\u8fd9\u6837\u7684\u77e9\u9635\u81ea\u4e58$t$\u6b21\u4ee5\u540e\u53f3\u4e0a\u89d2\u5c31\u662f\u6211\u4eec\u6240\u8981\u6c42\u7684$1+G+G^1+G^2+...+G^t$\u3002\u56e0\u6b64\u7edf\u8ba1\u4e00\u4e0b\u7b2c\u4e00\u884c\u5c31\u53ef\u4ee5\u4e86\n\n```cpp\n/*By DennyQi 2018*/\n#include <cstdio>\n#include <queue>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\ntypedef long long ll;\nconst int MAXN = 10010;\nconst int MAXM = 20010;\nconst int INF = 1061109567;\ninline int Max(const int a, const int b){ return (a > b) ? a : b; }\ninline int Min(const int a, const int b){ return (a < b) ? a : b; }\ninline int read(){\n    int x = 0; int w = 1; register char c = getchar();\n    for(; c ^ '-' && (c < '0' || c > '9'); c = getchar());\n    if(c == '-') w = -1, c = getchar();\n    for(; c >= '0' && c <= '9'; c = getchar()) x = (x<<3) + (x<<1) + c - '0'; return x * w;\n}\nint N,M,x,y,t;\nint a[35][35],g[100][100],ans[100][100],b[100][100];\ninline void Matrix_ksm(int y){\n\twhile(y > 0){\n\t\tif(y & 1){\n\t\t\tfor(int i = 1; i <= 2*N; ++i){\n\t\t\t\tfor(int j = 1; j <= 2*N; ++j){\n\t\t\t\t\tb[i][j] = 0;\n\t\t\t\t\tfor(int k = 1; k <= 2*N; ++k){\n\t\t\t\t\t\tb[i][j] = (b[i][j] + ans[i][k] * g[k][j]) % 2017;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i = 1; i <= 2*N; ++i){\n\t\t\t\tfor(int j = 1; j <= 2*N; ++j){\n\t\t\t\t\tans[i][j] = b[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\ty /= 2;\n\t\tfor(int i = 1; i <= 2*N; ++i){\n\t\t\tfor(int j = 1; j <= 2*N; ++j){\n\t\t\t\tb[i][j] = 0;\n\t\t\t\tfor(int k = 1; k <= 2*N; ++k){\n\t\t\t\t\tb[i][j] = (b[i][j] + g[i][k] * g[k][j]) % 2017;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i = 1; i <= 2*N; ++i){\n\t\t\tfor(int j = 1; j <= 2*N; ++j){\n\t\t\t\tg[i][j] = b[i][j];\n\t\t\t}\n\t\t}\n\t}\n}\nint main(){\n//\tfreopen(\".in\",\"r\",stdin);\n\tN = read(), M = read();\n\tfor(int i = 1; i <= M; ++i){\n\t\tx = read(), y = read();\n\t\ta[x][y] = 1;\n\t\ta[y][x] = 1;\n\t}\n\tt = read();\n\tfor(int i = 1; i <= N; ++i){\n\t\ta[i][i] = 1;\n\t}\n\tfor(int i = 1; i <= N; ++i){\n\t\tfor(int j = 1; j <= N; ++j){\n\t\t\tg[i][j] = a[i][j];\n\t\t\tg[i][j+N] = a[i][j];\n\t\t}\n\t}\n\tfor(int i = N+1; i <= 2*N; ++i){\n\t\tg[i][i] = 1;\n\t}\n\tfor(int i = 1; i <= 2*N; ++i){\n\t\tans[i][i] = 1;\n\t}\n\tMatrix_ksm(t);\n\tint Ans = 1;\n\tfor(int i = N+1; i <= N*2; ++i){\n\t\tAns = (Ans + ans[1][i]) % 2017;\n\t}\n\tprintf(\"%d\", Ans);\n\treturn 0;\n}\n```",
        "postTime": 1540734238,
        "uid": 115065,
        "name": "DennyQi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3758 \u3010[TJOI2017]\u53ef\u4e50\u3011"
    },
    {
        "content": "\u539f\u9898\u4f20\u9001\u95e8[>Here<](https://www.luogu.org/problemnew/show/P3758)\n\n\u8fd9\u9053\u9898\u53e6\u5916\u4e24\u4e2a\u64cd\u4f5c\u6709\u70b9\u68d8\u624b\uff0c\u5982\u679c\u53ea\u6709\u7b2c\u4e8c\u4e2a\u64cd\u4f5c\u7684\u8bdd\u53ef\u4ee5\u5c31\u7528\u77e9\u9635\u5feb\u901f\u5e42\u3002\n\n\u8003\u8651\u628a\u53e6\u5916\u4e24\u4e2a\u64cd\u4f5c\u8f6c\u5316\u6210\u8fde\u8fb9\u7684\u64cd\u4f5c\uff1a\n\n1\u53ef\u4ee5\u770b\u505a\u5411\u81ea\u5df1\u8fde\u4e86\u4e00\u6761\u8fb9\uff1b\n\n3\u53ef\u4ee5\u770b\u505a\u662f\u5b83~~\u88ab\u53d1\u914d\u8fb9\u7586\uff08\u96fe\uff09~~\u8d70\u5230\u4e86\u4e00\u4e2a\u70b9\u7136\u540e\u518d\u4e5f\u4e0d\u56de\u6765\u4e86\u3002\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u5efa\u56fe\u5feb\u901f\u5e42\u4e86\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <cstdio>\n#include <cstring>\n\nint matrix[31][31],tem[31][31],ans[31][31],n,m,T,s,t;\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=m;i++){\n\t\tscanf(\"%d%d\",&s,&t);\n\t\tmatrix[s][t]=matrix[t][s]=1;\n\t}\n\tscanf(\"%d\",&T);\n\tfor(int i=0;i<=n;i++)matrix[i][0]=matrix[i][i]=1,ans[i][i]=1;\n\twhile(T){\n\t\tif(T&1){\n\t\t\tfor(int i=0;i<=n;i++)\n\t\t\t\tfor(int j=0;j<=n;j++)\n\t\t\t\t\tfor(int k=0;k<=n;k++)\n\t\t\t\t\t\ttem[i][j]=(tem[i][j]+ans[i][k]*matrix[k][j])%2017;\n\t\t\tfor(int i=0;i<=n;i++)\n\t\t\t\tfor(int j=0;j<=n;j++)\n\t\t\t\t\tans[i][j]=tem[i][j],tem[i][j]=0;\n\t\t}\n\t\tfor(int i=0;i<=n;i++)\n\t\t\tfor(int j=0;j<=n;j++)\n\t\t\t\tfor(int k=0;k<=n;k++)\n\t\t\t\t\ttem[i][j]=(tem[i][j]+matrix[i][k]*matrix[k][j])%2017;\n\t\tfor(int i=0;i<=n;i++)\n\t\t\tfor(int j=0;j<=n;j++)\n\t\t\t\tmatrix[i][j]=tem[i][j],tem[i][j]=0;\n\t\tT>>=1;\n\t}\n\tint fin=0;\n\tfor(int i=0;i<=n;i++)fin=(fin+ans[1][i])%2017;\n\tprintf(\"%d\\n\",fin);\n}\n```",
        "postTime": 1537704792,
        "uid": 30903,
        "name": "Isonan",
        "ccfLevel": 0,
        "title": "luoguP3758 [TJOI2017]\u53ef\u4e50"
    },
    {
        "content": "#### \u8fd9\u9053\u9898\u7684\u6b63\u89e3\u771f\u662f\u592a\u5999\u8fa3\uff01\n\u7136\u800c\u849f\u84bb\u5148\u5199\u4e86\u4e2a\u66b4\u529b\u4f01\u56fe\u6570\u636e\u6709\u68af\u5ea6\u8bd5\u8bd5\u80fd\u5f97\u591a\u5c11\u5206\n~~\uff08\u7136\u540eAC\u4e86~~\n\n\u9009\u62e9\u9012\u63a8\n\nf[i][j][0]:\u5f53\u524d\u4e3a\u7b2ci\u79d2\u672b\uff0c\u4f4d\u4e8e\u8282\u70b9j\uff0c\u6ca1\u6709\u7206\u70b8\u8fc7\u7684\u65b9\u6848\u6570\n\nf[i][j][1]:\u5f53\u524d\u4e3a\u7b2ci\u79d2\u672b\uff0c\u4f4d\u4e8e\u8282\u70b9j\uff0c\u5728\u7b2ci\u79d2\u672b\u4e4b\u524d\u5df2\u7ecf\u7206\u70b8\u8fc7\u7684\u65b9\u6848\u6570\n\n\u4e8e\u662f\u6709:\nf[i][j][0] = sigma(f[i-1][k][0] | k\u4e0ej\u76f8\u8fde)+f[i-1][j][0]\n\nf[i][j][1] = f[i-1][j][0]+f[i-1][j][1]\n\n\u65f6\u95f4\u590d\u6742\u5ea6O(t*n)\n##### ~~\uff08\u53ef\u80fd\u9700\u8981\u4e00\u4e2aO2~~\n\u53e6\u5916\u89c2\u5bdf\u5230\u8fd9\u9053\u9898\u76ee\u7684\u7a7a\u95f4\u9650\u5236\u4e3a128mb\uff0c\u800c\u5bf9\u4e8e\u5b58\u4e0b\u6574\u4e2a\u72b6\u6001\u6570\u7ec4\u662f\u663e\u7136\u4e0d\u591f\u7684\uff1b\u4f46\u56e0\u4e3a\u6bcf\u4e2af[i]\u4ec5\u4ec5\u4ecef[i-1]\u8f6c\u79fb\u800c\u6765\uff0c\u6240\u4ee5\u4f7f\u7528**\u6eda\u52a8\u6570\u7ec4**\uff0c\u53ea\u9700\u8981\u5b58\u50a8f[i]\u548cf[i-1]\u7684\u72b6\u6001\u5c31\u53ef\u4ee5\u4e86\n\n#### \u4ee3\u7801\uff1a\n```cpp\n#include <iostream>\n#include <cstdlib>\n#include <cstdio>\n#include <cstring>\n\nusing namespace std;\nint f[3][31][3];\nint n,m;\nint map[31][33];\ninline int add(int x, int y)\n{\n    register int res = x+y;\n    res -= (res>=2017)*2017;\n    return res;\n}\nint main()\n{\n    cin >> n >> m;\n    int u,v;\n    for(int i = 1; i<=m; i++)\n    {\n        scanf(\"%d%d\",&u,&v);\n        map[u][++map[u][0]] = v;\n        map[v][++map[v][0]] = u;\n    }\n    register int t,ans = 0,tmp1,tmp2;\n    cin >> t;\n    f[0][1][0] = 1;\n    for(register int i = 1; i<=t; i++)\n    {\n        tmp1 = i&1, tmp2 = i&1^1;\n        for(register int j = 1; j<=30; j++)\n        {\n        \tf[tmp1][j][0] = f[tmp2][j][0];\n            for(register int *k = map[j]+1; k<=map[j]+map[j][0]; k++)\n                f[tmp1][j][0] = add(f[tmp1][j][0],f[tmp2][*k][0]);\n            f[tmp1][j][1] = add(f[tmp2][j][0],f[tmp2][j][1]);\n            ans = add(ans,(i==t)*add(f[tmp1][j][0],f[tmp1][j][1]));\n        }\n    }\n    cout << ans << endl;\n \treturn 0;\n}\n```\n\n\n",
        "postTime": 1527316727,
        "uid": 31098,
        "name": "Caro23333",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3758 \u3010[TJOI2017]\u53ef\u4e50\u3011"
    },
    {
        "content": "\u5bf9\u4e8e100%\u7684pn\uff0c\u67091 < t \u2264 10^6\u3002\n\n\u8fd9\u9700\u8981\u4e00\u4e9b\u5de7\u5999\u7684\u601d\u60f3 \u770b\u5230\u9898\u7684\u7b2c\u4e00\u773c\u5927\u6982\u5c31\u662f\u8bb0\u5fc6\u8bdd\u641c\u7d22\u6216\u8005\u76f4\u63a5\u9012\u63a8\u5f0f\u8fdb\u884c\u8ba1\u7b97\n\n\u9274\u4e8e\u65f6\u95f4\u5361\u7684\u975e\u5e38\u7d27 \u5269\u4f5980%\u7684\u6570\u636e\u76f4\u63a510^6\u554a \u53ea\u597d\u7528\u77e9\u9635\u52a0\u901f\u4e00\u4e0b\n\n\u3010\u6570\u636e\u8303\u56f4\u3011 \u5bf9\u4e8e20%\u7684pn\uff0c\u67091 < t \u2264 1000\n\n\u5bf9\u4e8e100%\u7684pn\uff0c\u67091 < t \u2264 10^6\u3002\n\n\u53ef\u4ee5\u770b\u51fa\u603b\u65b9\u6848\u6570\uff1dt \u79d2\u540e\u5904\u4e8e\u5404\u4e2a\u4f4d\u7f6e\u7684\u53ef\u80fd\u52a0\u4e0a\u6240\u6709\u5df2\u7ecf\u7206\u70b8\u4e86\u7684\u53ef\u80fd\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u6b64\u6784\u9020\u77e9\u9635    \u8bbe\u77e9\u9635\u4e3aP\n\nP(ij) \u8868\u793ai\u4e0ej \u4e4b\u95f4\u6709\u8fb9\u76f8\u8fde \u586b1 \u8fd9\u91cc\u6211\u4eec\u77e9\u9635\u90fd\u662f\u4ece(0,0)\u5f00\u59cb\u7684\u56e0\u4e3a\u6211\u4eec\u9700\u8981\u8ba1\u7b97\u7206\u70b8\u7684\u6570\u76ee\n\n\u6837\u4f8b\uff1a\n\n0 1 0 0              1 0 0 0                                   1 1 1 0\n\n0 0 0 0     \\*        1 1 1 0  ----------------------->  0 0 0 0\n\n1 1 1 1\n\n1 0 1 1\n\n\n\u7531\u4e8e\u6211\u4eec\u4e0d\u505c\u4e58\u76f8\u540c\u77e9\u9635 \u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5feb\u901f\u5e42\u4f18\u5316\u4e0b\u6211\u4eec\u77e9\u9635\u7684\u500d\u589e\n\n\u4e0b\u9762\u4ee3\u7801\u4e5f\u6709\u6ce8\u91ca\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#define N 2017\nstruct matrix{\n    int f[33][33],l,c;\n}base1,base,base2,p;\nint x[110],y[110],n,m,ans,t;\ninline matrix multiply(matrix a,matrix b){\n    matrix c;memset(c.f,0,sizeof(c));\n    c.l=a.l;c.c=b.c;\n    for (int i=0;i<=c.l;++i)\n        for (int j=0;j<=c.c;++j){\n            for (int z=0;z<=a.c;++z){\n                (c.f[i][j]+=a.f[i][z]*b.f[z][j]%N)%=N;\n            }\n        }    \n    return c;\n}\nvoid build(){\n    memset(base1.f,0,sizeof(base1.f));\n    base1.l=base1.c=n;\n    for (int i=1;i<=n;++i)\n        for (int j=1;j<=n;++j) if (i==j) base1.f[i][j]=1;\n    memset(base.f,0,sizeof(base.f));\n    base.l=base.c=n;\n    base.f[0][0]=1;\n    for (int i=1;i<=m;++i){\n        base.f[x[i]][y[i]]=1;\n        base.f[y[i]][x[i]]=1;\n    }\n    for (int i=1;i<=n;++i) base.f[i][i]=1,base.f[i][0]=1;\n    memset(base2.f,0,sizeof(base2.f));\n    base2.l=1;base2.c=n;base2.f[0][1]=1;\n}\nint main(){\n    //freopen(\"3758.in\",\"r\",stdin);\n    //freopen(\"3758.out\",\"w\",stdout);\n    scanf(\"%d%d\",&n,&m);\n    for (int i=1;i<=m;++i) scanf(\"%d%d\",&x[i],&y[i]);scanf(\"%d\",&t);\n    build();//\u6784\u9020\u521d\u59cb\u77e9\u9635\n    for (;t!=0;t>>=1,base=multiply(base,base))    //\u77e9\u9635\u5feb\u901f\u5e42\uff08\u77e9\u9635\u500d\u589e\uff09\n        if (t&1) base2=multiply(base2,base);\n    for (int i=0;i<=n;++i) (ans+=base2.f[0][i]%N)%=N; //\u6700\u540e\u7684\u7b54\u6848\u5168\u90e8\u4f4d\u4e8e\u77e9\u9635\u7684\u7b2c0\u884c \u7b2c0\u5217\u662f\u6240\u6709\u7206\u70b8\u7684\u6570\u91cf \u5269\u4e0b1~n\u662f\u90a3\u4e2a\u70b9\u7684\u6570\u91cf\n    printf(\"%d \",ans);\n    return 0;\n} \n```",
        "postTime": 1496883407,
        "uid": 5037,
        "name": "elijahqi",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3758 \u3010[TJOI2017]\u53ef\u4e50\u3011"
    },
    {
        "content": "\u6ca1\u7528\u77e9\u9635\u52a0\u901f\uff0c\u4e0d\u77e5\u600e\u7684\u6211\u5c31\u7528\u666e\u901aDP\u6c34\u8fc7\u53bb\u4e86\u2026\u2026\n\n[\u63a8\u9500\u81ea\u5df1\u535a\u5ba2](http://ssttkkl.top/posts/ShengXuan/2018/03/%E3%80%90TJOI2017%E3%80%91%E5%8F%AF%E4%B9%90/)\n\n-----\n\n\u6bcf\u4e00\u79d2\u7684\u51b3\u7b56\u6709\u4e09\u79cd\uff1a\u8d70\u5230\u76f8\u90bb\u7684\u8282\u70b9\uff0c\u505c\u7559\u5728\u539f\u5730\uff0c\u81ea\u7206\u3002\u4ee4$f(i,j)$\u8868\u793a\u7b2c$i$\u79d2\u5728$j$\u70b9\u7684\u65b9\u6848\u6570\uff0c\u5bb9\u6613\u5f97DP\u72b6\u8f6c\u65b9\u7a0b\uff1a\n\n$$f(i,j)=\\sum_{k\\ \\mathrm{is\\ adjacent\\ to}\\ i} f(i+1,k)+f(i+1,j)+1$$\n\n\u6700\u7ec8\u7b54\u6848\u5c31\u662f$f(0,1)$\n\n```cpp\n#include <iostream>\n#define maxn 35\n#define maxm 105\n#define maxt 1000005\nusing namespace std;\nint add(int x, int y)\n{\n    int ans = x + y;\n    if (ans >= 2017)\n        ans -= 2017;\n    return ans;\n}\nstruct edge\n{\n    int to, next;\n} edges[maxm * 2];\nint head[maxn], ecnt;\nvoid addedge(int u, int v)\n{\n    ecnt++;\n    edges[ecnt].to = v;\n    edges[ecnt].next = head[u];\n    head[u] = ecnt;\n}\nint n, m, t, dp[2][maxn];\nint main()\n{\n    cin >> n >> m;\n    for (int i = 1; i <= m; i++)\n    {\n        int a, b;\n        cin >> a >> b;\n        addedge(a, b);\n        addedge(b, a);\n    }\n    cin >> t;\n    for (int i = t; i >= 0; i--)\n    {\n        for (int v = 1; v <= n; v++)\n        {\n            dp[i & 1][v] = add(1, dp[(i + 1) & 1][v]);\n            for (int j = head[v]; j; j = edges[j].next)\n            {\n                int w = edges[j].to;\n                dp[i & 1][v] = add(dp[i & 1][v], dp[(i + 1) & 1][w]);\n            }\n        }\n    }\n    cout << dp[0][1];\n    return 0;\n}\n```\n\n",
        "postTime": 1520851888,
        "uid": 22890,
        "name": "huangwenlong",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3758 \u3010[TJOI2017]\u53ef\u4e50\u3011"
    },
    {
        "content": "f[0][i][t]\u8868\u793a\u7b2ct\u79d2\u5230i\u7684\u5168\u90e8\u65b9\u6848\uff08\u542b\u4e4b\u524d\u5df2\u7ecf\u5728i\u70b8\u6389\u7684\uff09f[1][i][t]\u8868\u793a\u7b2ct\u79d2\u5230i\u800c\u4e14\u8fd8\u5728i\u6ca1\u70b8\u7684\u65b9\u6848\u6570\uff0c\u5219\n\nf[0][i][t]=f[0][i][t-1]+f[1][j][t-1]+f[1][j][t-1]|i,j\u4e4b\u95f4\u6709\u8fb9\n\nf[1][i][t]=f[1][j][t-1]+f[1][i][t-1]|i,j\u4e4b\u95f4\u6709\u8fb9 \n\nt=10^9\uff0c\u9700\u8981\u77e9\u9635\u500d\u589e\u52a0\u901f\u3002\n\n\u6b22\u8fce\u5230[\u6211\u7684blog](http://blog.csdn.net/icefox\\_zhx/article/details/77327525)\u67e5\u770b\u66f4\u8be6\u7ec6\u9898\u89e3\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#define mod 2017\n#define ll long long\nint const N=31;\nint n,m,tt,h[N],num=0,ans=0;\nstruct edge{int to,next;}data[101<<1];\nstruct matrix{\n    int f[N<<1][N<<1];\n    //f[i]\u5230i\u5168\u90e8\u65b9\u6848\uff0cf[n+i]\u5230i\u6ca1\u70b8\u7684\u65b9\u6848\u3002 \n    matrix(){memset(f,0,sizeof(f));}\n    matrix operator*(const matrix b){\n        matrix res;\n        for(int i=1;i<=n<<1;++i)\n            for(int j=1;j<=n<<1;++j)\n                for(int k=1;k<=n<<1;++k)\n                    res.f[i][j]=(res.f[i][j]+(ll)f[i][k]*b.f[k][j])%mod;\n        return res;\n    }\n}a,base;\ninline int read(){\n    int x=0;char ch=getchar();\n    while(ch<'0'||ch>'9') ch=getchar();\n    while(ch>='0'&&ch<='9') x=x*10+ch-'0',ch=getchar();\n    return x;\n}\nint main(){\n//  freopen(\"cola.in\",\"r\",stdin);\n//  freopen(\"cola.out\",\"w\",stdout);\n    n=read();m=read();\n    for(int i=1;i<=m;i++){\n        int x=read(),y=read();\n        data[++num].to=y;data[num].next=h[x];h[x]=num;\n        data[++num].to=x;data[num].next=h[y];h[y]=num;\n    }\n    tt=read();\n    a.f[1][1]=a.f[1][n+1]=1;\n    for(int i=1;i<=n;i++){\n        base.f[i][i]=base.f[n+i][i]=base.f[n+i][n+i]=1;\n        for(int j=h[i];j;j=data[j].next){\n            int y=data[j].to;\n            base.f[n+y][i]=base.f[n+y][n+i]=1;\n        }\n    }\n    for(;tt;tt>>=1,base=base*base)\n        if(tt&1) a=a*base;\n    for(int i=1;i<=n;++i) ans=(ans+a.f[1][i])%mod;\n    printf(\"%d\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1503045627,
        "uid": 31311,
        "name": "IceFox",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3758 \u3010[TJOI2017]\u53ef\u4e50\u3011"
    }
]
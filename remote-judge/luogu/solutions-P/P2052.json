[
    {
        "content": "[\u9053\u8def\u4fee\u5efa\u9898\u9762](https://www.luogu.com.cn/problem/CF1219G)\n\n## \u9898\u9762\u63cf\u8ff0\n\n\u7ed9\u51fa\u4e00\u68f5\u6811\uff0c\u544a\u8bc9\u4f60\u6bcf\u6761\u8fb9\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e3a\u8fb9\u4e24\u8fb9\u8054\u901a\u5757\u5927\u5c0f\u5dee\u7684\u7edd\u5bf9\u503c\u4e58\u4e0a\u8fb9\u6743\uff0c\u8ba9\u4f60\u6c42\u51fa\u6240\u6709\u8fb9\u7684\u8d21\u732e\u4e4b\u548c\u3002\n\n\u5982\u679c\u6ca1\u6709\u542c\u61c2\u7684\u8bdd\u4e5f\u53ef\u4ee5\u7ee7\u7eed\u770b\u4e0b\u9762\u7684\u5206\u6790\u3002\n\n## \u5206\u6790\n\n\u6837\u4f8b\u662f\u8fd9\u6837\u7684\u4e00\u9897\u6811\n\n![\u3002](https://cdn.luogu.com.cn/upload/image_hosting/cpjndwbn.png)\n\n\u53ef\u4ee5\u624b\u63a8\u4e00\u4e0b\u8fd9\u4e2a\u4f8b\u5b50\u8ba9\u4f60\u66f4\u6e05\u695a\u7684\u7406\u89e3\u9898\u610f\u3002\n\n\u7531\u4e8e\u8003\u8651\u6bcf\u6761\u8fb9\u4e0a\u7684\u8d21\u732e\u4ec5\u7531\u8fb9\u6743\u548c\u8fb9\u4e24\u8fb9\u7684\u8054\u901a\u5757\u5927\u5c0f\u786e\u5b9a\uff0c\u800c\u6211\u4eec\u53ea\u8981\u77e5\u9053\u4efb\u610f\u4e00\u8fb9\u7684\u8054\u901a\u5757\u7684\u5927\u5c0f\uff0c\u901a\u8fc7 n-\u8054\u901a\u5757\u5927\u5c0f \u5373\u53ef\u5f97\u77e5\u53e6\u4e00\u5757\u8fde\u901a\u5757\u5730\u5927\u5c0f\u3002\n\n\u6240\u4ee5\u6211\u4eec\u4f7f\u7528$size_i$\u8bb0\u5f55\u4ee5i\u4e3a\u6839\u7684\u5b50\u6811\u7684\u5927\u5c0f\uff0c\u90a3\u4e48\u4e00\u6761\u8fb9\u4e0a\u7684\u8d21\u732e\u5c31\u662f\n$$dist_{i,j}*|size[i]-(n-size[i])|=dist_{i,j}*|size[i]*2-n|$$\n\u76f4\u63a5\u7528dfs\u6c42\u89e3\u5373\u53ef\n\n## \u5b8c\u6574\u4ee3\u7801\n\n\u76f4\u63a5\u6309\u5206\u6790\u7b80\u5355\u6a21\u62df\u5373\u53ef\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int maxn=10000010;\nll n,cnt,ans;\nll size[maxn],head[maxn];\nstruct node\n{\n\tint w,to,nt;\n}e[maxn*2];\nvoid add(int x,int y,int z)\n{\n\tcnt++;\n\te[cnt].to=y;\n\te[cnt].nt=head[x];\n\te[cnt].w=z;\n\thead[x]=cnt;\n}\nvoid dfs(int x,int fa)\n{\n\tsize[x]=1;\n\tfor(int i=head[x];i;i=e[i].nt)\n\t{\n\t\tint to=e[i].to;\n\t\tif(fa==to) continue;\n\t\tdfs(to,x);\n\t\tsize[x]+=size[to];\n\t\tans+=e[i].w*abs(2*size[to]-n);\n\t}\n} \nint main()\n{\n\tcin>>n;\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tint x,y,z;\n\t\tscanf(\"%d%d%d\",&x,&y,&z);\n\t\tadd(x,y,z);\n\t\tadd(y,x,z);\n\t}\n\tdfs(1,0);\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```\n",
        "postTime": 1591876355,
        "uid": 78331,
        "name": "Melon_Musk",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P2052 \u3010[NOI2011]\u9053\u8def\u4fee\u5efa\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u663e\u7136\u5c31\u662f\u4e00\u4e2a$dfs$\u641e\u5b9a\u7684\u4e8b\u60c5\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5bf9\u8fd9\u68f5\u6811\u8fdb\u884c$dfs$\u8ba1\u7b97\u51fa\u6bcf\u4e2a\u70b9\u7684$size$\uff0c\u7136\u540e\u5c31\u77e5\u9053\u8fd9\u6761\u8fb9\u7684\u8d21\u732e\u4e3a$abs(n-2*size_v)*w[i]$\uff0c\u5176\u4e2d$v$\u4e3a\u8fd9\u6761\u8fb9\u7684\u513f\u5b50\u3002\n\n```cpp\n#include<cstdio>\n#include<cmath>\n#define Rint register int\nusing namespace std;\ntypedef long long LL;\nconst int N = 1000003; \nint n, head[N], to[N << 1], nxt[N << 1], w[N << 1];\ninline void add(int a, int b, int c){\n    static int cnt = 0;\n    to[++ cnt] = b; nxt[cnt] = head[a]; head[a] = cnt; w[cnt] = c;\n}\nLL ans;\nint siz[N];\ninline void dfs(int x, int fa){\n    siz[x] = 1;\n    for(Rint i = head[x];i;i = nxt[i])\n        if(to[i] != fa){\n            dfs(to[i], x);\n            ans += (LL) abs(n - 2 * siz[to[i]]) * w[i];\n            siz[x] += siz[to[i]];\n        }\n}\nint main(){\n    scanf(\"%d\", &n);\n    for(Rint i = 1;i < n;i ++){\n        int a, b, c;\n        scanf(\"%d%d%d\", &a, &b, &c);\n        add(a, b, c); add(b, a, c);\n    }\n    dfs(1, 1);\n    printf(\"%lld\", ans);\n}\n```",
        "postTime": 1544765043,
        "uid": 68148,
        "name": "watermoon",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P2052 \u3010[NOI2011]\u9053\u8def\u4fee\u5efa \u3011"
    },
    {
        "content": "[P2052 [NOI2011]\u9053\u8def\u4fee\u5efa](https://www.luogu.com.cn/problem/P2052)\n\n[Best watch in the blog](https://www.luogu.com.cn/blog/Shuchong/solution-p2052)\n\n### $\\text{Part 1}$ \u9898\u5916\u8bdd\n\n\u4f20\u8bf4\u4e2d NOI \u7684\u9001\u5206\u9898\uff0c\u5361\u4e86\u6211\u4e09\u5929\n\n\u4eca\u5929\u624d\u77e5\u9053\u5361\u4e86\u6211\u4e09\u5929\u7684\u539f\u56e0\u662f `scanf` \u6ca1\u52a0 `&` \u2026\u2026\uff08\u611f\u8c22\u4e8c\u4e9a\u59d0\u59d0\u5e2e\u6211\u63ea\u51fa\u8fd9\u4e2a\u9519\u8bef\uff09\n\n### $\\text{Part 2 Solution}$\n\n\u8fd9\u9898\u771f\u6bd2\u7624\uff01\u5c45\u7136\u8fd8\u80fd\u5361\u6211\u597d\u51e0\u4e2a\u505a\u6cd5\uff01\n\n\u6211\u7684\u7b2c\u4e00\u4e2a\u60f3\u6cd5\uff1a\u7528\u6570\u7ec4\u6a21\u62df\u94fe\u8868\u6811\uff0c\u4ece $a$ \u8fd9\u4e00\u4fa7\u8ba1\u6570\u957f\u5ea6 $\\text{tot\\_a}$\uff0c\u4ece $b$ \u8fd9\u4e00\u4fa7\u8ba1\u6570\u957f\u5ea6 $\\text{tot\\_b}$ \uff0c\u518d\u7528\u516c\u5f0f\u7b97\u51fa $\\text{ans}$ \uff0c\u7136\u540e\uff0c\u5c31\u6709\u4e86\u4e0b\u9762\u7684\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\nstruct node {\n\tlong long val, next;\n} e[1000086 * 2];\n\nlong long head[1000086], n, m, c[1000086], tot_a = 0, tot_b = 0, a[1000086], b[1000086];\n\nvoid add (long long f, long long s) {\n\te[++m] = (node) {s, head[f]};\n\thead[f] = m;\n}\n\nvoid dfs (long long cur, long long fa) {\n\ttot_a++;\n\tfor (long long i = head[cur]; i > 0; i = e[i].next) {\n\t\tif (e[i].val == fa) continue;\n\t\tdfs(e[i].val, cur);\n\t}\n}\n\nint main () {\n\tlong long n, ans = 0;\n\tscanf(\"%lld\", &n);\n\tfor (long long i = 1; i < n; i++) {\n\t\tscanf(\"%lld%lld%lld\", &a[i], &b[i], &c[i]);\n\t\tadd(a[i], b[i]), add(b[i], a[i]);\n\t}\n\tfor (long long i = 1; i < n; i++) {\n\t\tdfs(a[i], b[i]);\n\t\ttot_b = n - tot_a;\n\t\tans += abs(tot_a - tot_b) * c[i];\n\t\ttot_a = 0, tot_b = 0;\n\t}\n\tprintf(\"%lld\", ans);\n\treturn 0;\n}\n```\n\n\u4f60\u4f1a\u53d1\u73b0\u5f97\u4e86 $45$ \u5206\uff0c[Link](https://www.luogu.com.cn/record/33493990)\uff0cTLE \u4e86\u597d\u591a\u70b9\u3002\n\n\u8fd9 \u5f88 \u6b63 \u5e38\uff0c\u56e0\u4e3a\u770b\u770b\u548c\u853c\u53ef\u4eb2\u7684\u6570\u636e\u8303\u56f4\u3002\n\n\u6240\u4ee5\u6b63\u89e3\u5e94\u8be5\u662f\u600e\u4e48\u529e\u7684\u5462\uff1f\u6b63\u89e3\u5199\u51fa\u6765\u6bd4\u8f83\u9ebb\u70e6\uff0c\u6211\u5c31\u6ce8\u91ca\u5728\u6211\u7684\u4ee3\u7801\u91cc\u4e86\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\nstruct node { // a node\n\tlong long val, len, next; // value of this node, length of this node, next node of this node\n} e[1000086 * 2]; // node [e]\n\nlong long head[1000086], sum[1000086], n, m, ans = 0; // root now, [sum], n, length of the tree, answer\n\nvoid addEdge (long long u, long long v, long long len) {\n\te[++m].next = head[u]; // son\n\te[m].val = v; // value\n\te[m].len = len; // length\n\thead[u] = m; // length of the tree\n}\n\n// addEdge : u --len-- v\n\nvoid dfs (long long cur, long long father) {\n\tsum[cur] = 1; // report [sum]\n\tfor (long long i = head[cur]; i; i = e[i].next) // for i to i.next\n\t\tif (e[i].val != father) { // son != father\n\t\t\tdfs(e[i].val, cur); // dfs again\n\t\t\tans += abs(sum[e[i].val] - (n - sum[e[i].val])) * e[i].len; // calc ans\n\t\t\tsum[cur] += sum[e[i].val]; // calc [sum]\n\t\t}\n}\n\n// dfs the tree\n\nint main () {\n\tscanf(\"%lld\", &n); // scan\n\tfor (long long i = 1, u, v, len; i < n; i++) { // only n - 1\n\t\tscanf(\"%lld%lld%lld\", &u, &v, &len); // scan\n\t\taddEdge(u, v, len); // u --len-- v\n\t\taddEdge(v, u, len); // v --len-- u\n\t} // scan + add stop, then dfs\n\tdfs(1, 0); // from 1 to dfs (father is 0 because 1 doesn't have father)\n\tprintf(\"%lld\", ans); // print the ans\n\treturn 0; // goodbye the code\n}\n```\n\n[AC Link](https://www.luogu.com.cn/record/33558569)\n\n### $\\text{Part\\ 3}$ \u603b\u7ed3\n\n\u7a81\u7136\u53d1\u73b0\u8fd9\u662f\u6211\u7b2c\u4e00\u4e2a A \u6389\u7684 NOI \u9898\uff0c\u5174\u594b\u6765\u5f97\u592a\u7a81\u7136\uff0c\u6700\u540e\u4e00\u60f3\u8fde `&` \u90fd\u80fd\u5361\u6211\u4e09\u5929\uff0c\u679c\u771f\u662f\u6211\u592a\u83dc\u3002\n\n\u8fd9\u9898\u4e3b\u8981\u7684\u8003\u70b9\u5c31\u662f **\u6570\u7ec4\u6a21\u62df\u94fe\u8868\u6811** \u548c **dfs**\uff0c\u53ea\u8981\u4e86\u89e3\u4e86\u6811\u7684\u57fa\u672c\u6982\u5ff5\uff0c\u518d\u52a0\u4e0a\u7ec6\u5fc3\uff0c\u8fd9\u9898\u5176\u5b9e\u5c31\u51fa\u6765\u4e86\u3002\u4ed4\u7ec6\u4e00\u60f3\uff0c\u8fd8\u771f\u7684\u662f NOI \u9001\u5206\u9898\u3002\n\nAll right\uff0c\u57fa\u672c\u5c31\u662f\u8fd9\u6837\u3002",
        "postTime": 1589289255,
        "uid": 114914,
        "name": "\u4e00\u53ea\u4e66\u866b\u4ed4",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2052 \u3010[NOI2011]\u9053\u8def\u4fee\u5efa\u3011"
    },
    {
        "content": "#### \u5410\u69fd\u4e00\u4e0b\n\n\u6211\u5f00\u4e86$-O2$\u4f18\u5316\u7ed3\u679c\u8dd1\u7684\u66f4\u6162\u4e86\u4ec0\u4e48\u9b3c\uff1f\uff1f\uff1f\uff01\uff01\uff01\n\n\u6211\u6015\u4e0d\u662f\u5438\u4e86\u4e00\u53e3``\u6bd2\u6c27\u6c14``\n\n**\u4e0d\u8981\u8138\u7684\u653e\u4e0a\u6211\u7684\u535a\u5ba2\uff0c\u6b22\u8fce\u5927\u5bb6[\u524d\u6765\u9762\u57fa](http://www.cnblogs.com/bljfy/)**\n\n#### \u9898\u76ee\u5927\u610f\n\n\u7ed9\u5b9a\u4e00\u68f5\u6709$n$\u4e2a\u8282\u70b9\u7684\u6811\uff0c\u6811\u4e2d\u6709${n-1}$\u6761\u8fb9\uff0c\u6bcf\u6761\u8fb9\u82b1\u8d39\u7684\u4ef7\u683c\u662f\u8fd9\u6761\u8fb9\u4e24\u4fa7\u7684\u70b9\u7684\u6570\u91cf\u7684\u5dee\u7684\u7edd\u5bf9\u503c\u548c\u8fd9\u6761\u8fb9\u957f\u5ea6\u7684\u79ef\u3002\u6c42\u8fd9\u68f5\u6811\u7684\u603b\u82b1\u8d39\u3002\n\n#### \u89e3\u9898\u601d\u8def\n\n\u4ee5\u8282\u70b9$1$\u4f5c\u4e3a\u8fd9\u68f5\u6811\u7684\u6839\u8282\u70b9\uff0c~~\u5176\u5b9e\u9009\u54ea\u4e2a\u90fd\u53ef\u4ee5~~\u4ece\u9898\u4e2d\u53ef\u4ee5\u5f97\u51fa\u4e00\u4e2a\u57fa\u672c\u7684\u7ed3\u8bba\uff0c\u4e00\u6761\u8fb9\u7684\u4e24\u8fb9\u7684\u70b9\u7684\u6570\u91cf\u5206\u522b\u7b49\u4e8e\u7ec8\u70b9\u8282\u70b9\u513f\u5b50\u7684\u6570\u91cf$+1$\u548c\u8d77\u70b9\u8282\u70b9\u7956\u5148\u7684\u6570\u91cf\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u904d\u5386\u6574\u68f5\u6811\u5c06\u6bcf\u4e2a\u8282\u70b9\u513f\u5b50\u7684\u6570\u91cf\u9884\u5904\u7406\u51fa\u6765\u3002\n\n\u5728\u9884\u5904\u7406\u7684\u540c\u65f6\u53ef\u4ee5\u8fdb\u884c\u7edf\u8ba1\u3002\u5230\u6700\u540e\u8f93\u51faAns\u5c31\u53ef\u4ee5\n\n#### \u9644\u4e0a\u4ee3\u7801\n\n\u5f53\u7136\u4e0d\u80fd\u5c11\u4e86\u4ee3\u7801\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cmath>\n#include <algorithm>\n#define int long long\n\nusing namespace std;\n\nconst int maxn = 1e6+3;\nint n, fir[maxn], nx[maxn<<1], u[maxn<<1], v[maxn<<1], w[maxn<<1], s[maxn], Ans;\nbool vis[maxn];\ninline int DFS(int x, int fr) {\n    if(s[x] != 1) return s[x];\n    int k = fir[x];\n    while (k != -1) {\n        if(fr != v[k]) {\n            s[x] += DFS(v[k], x);\n            Ans += abs(n-2*s[v[k]]) * w[k];\n        }\n        k = nx[k];\n    }\n    return s[x];\n}\n\nmain() {\n    scanf(\"%lld\", &n);\n    memset(fir, -1, sizeof(fir));\n    fill(s+1, s+1+n, 1);\n    for(int i=1; i<=(n-1)*2; i++) {\n        scanf(\"%lld%lld%lld\", &u[i], &v[i], &w[i]);\n        nx[i] = fir[u[i]];\n        fir[u[i]] = i;\n        u[i+1] = v[i], v[i+1] = u[i], w[i+1] = w[i];\n        i++;\n        nx[i] = fir[u[i]];\n        fir[u[i]] = i;\n    }\n    vis[1] = 1;\n    DFS(1, 1);\n    printf(\"%lld\", Ans);\n}\n```",
        "postTime": 1533440587,
        "uid": 60941,
        "name": "\u5954\u6ce2\u513f\u9738",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2052 \u3010[NOI2011]\u9053\u8def\u4fee\u5efa \u3011"
    },
    {
        "content": "**\u9898\u76ee\u76f4\u8bd1\uff1a**\n\n\u4e00\u68f5\u6811\uff0c\u6bcf\u6761\u8fb9\u7684\u6743\u503c\u7b49\u4e8e\u957f\u5ea6\u00d7abs\uff08\u4ee5\u5176\u4e2d\u4e00\u4e2a\u7aef\u70b9\u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\u7684\u8282\u70b9\u4e2a\u6570-\u4f59\u4e0b\u8282\u70b9\u4e2a\u6570\uff09\uff0c\u6c42\u8fd9\u68f5\u6811\u7684\u8fb9\u6743\u503c\u4e4b\u548c\u3002\n\n**\u6838\u5fc3\u4ee3\u7801**\n\n\u968f\u4fbf\u9009\u4e00\u4e2a\u70b9\u4e3a\u6839\u8282\u70b9\u8fdb\u884cdfs\uff0c\u6bcf\u4e2a\u8282\u70b9\u7684\u5b50\u6811\u7684\u8282\u70b9\u4e2a\u6570\u7b49\u4e8e\u5176\u6240\u6709\u5b50\u8282\u70b9\u7684\u5b50\u6811\u7684\u8282\u70b9\u4e2a\u6570\u4e4b\u548c\u518d+1\uff0csize[u]=(for\u5faa\u73af\u6240\u6709\u8fde\u8fb9\uff09size[edge[i].v]+1;\u5728\u7b97\u6bcf\u4e2a\u8282\u70b9\u7684\u5b50\u6811\u8282\u70b9\u4e2a\u6570\u65f6\uff0c\u540c\u65f6\u8bb0\u5f55\u7b54\u6848ans+=(long long)abs(size[v]-(n-size[v]))*edge[i].dis;(n-size[v])\u662f\u53e6\u4e00\u4e2a\u7aef\u70b9\u6240\u8fde\u63a5\u7684\u8282\u70b9\u4e2a\u6570\u3002\n\n```cpp\nvoid dfs(int u,int fa)\n{\n\tsize[u]=1;\n\tfor(int i=head[u];i;i=edge[i].next)\n\t{\n\t\tint v=edge[i].v;\n\t\tif(v!=fa)\n\t\t{\n\t\t\tdfs(v,u);\n\t\t\tans+=(long long)abs(size[v]-(n-size[v]))*edge[i].dis;\n\t\t\tsize[u]+=size[v];\n\t\t}\n\t}\n}\n```\n~~\u4e4d\u4e00\u770b\u6709\u70b9\u50cf\u6811p~~\n\n\u5b8c\u6574\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\nusing namespace std;\nint n,m,cnt,size[1000001],t,head[1000001];\nlong long ans;\nstruct node{\n\tint dis,next,v;\n}edge[2000001];\nvoid add(int u,int v,int w)\n{\n\tedge[++cnt].next=head[u];\n\tedge[cnt].v=v;\n\tedge[cnt].dis=w;\n\thead[u]=cnt;\n}\nvoid dfs(int u,int fa)\n{\n\tsize[u]=1;\n\tfor(int i=head[u];i;i=edge[i].next)\n\t{\n\t\tint v=edge[i].v;\n\t\tif(v!=fa)\n\t\t{\n\t\t\tdfs(v,u);\n\t\t\tans+=(long long)abs(size[v]-(n-size[v]))*edge[i].dis;\n\t\t\tsize[u]+=size[v];\n\t\t}\n\t}\n}\nint main()\n{\n\tcin>>n;\n\tfor(int i=1;i<=n-1;i++)\n\t{\n\t\tint x,y,w;\n\t\tcin>>x>>y>>w;\n\t\tadd(x,y,w);\n\t\tadd(y,x,w);\n\t}\n\tdfs(1,0);\n\tcout<<ans;\n}\n```",
        "postTime": 1566374509,
        "uid": 94437,
        "name": "philosopherchang",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2052 \u3010[NOI2011]\u9053\u8def\u4fee\u5efa \u3011"
    },
    {
        "content": "\u8d77\u5148\u4ee5\u4e3a\u662f\u4e00\u9053\u56fe\u8bba\uff0c\u4f46\u662f\u7ec6\u7ec6\u770b\u9898\u53d1\u73b0\u8fd9\u9898\u6ee1\u8db3 $n$ \u4e2a\u70b9\u548c $n-1$ \u6761\u8fb9\u4e14\u8fde\u901a\uff0c\u90a3\u4e48\u6b64\u9898\u9700\u8981\u5904\u7406\u7684\u662f\u4e00\u68f5\u6811\u3002\n\n## \u9898\u610f\u6982\u62ec\n\n\u9898\u76ee\u5373\u8981\u6211\u4eec\u6309\u7167\u4ee5\u4e0b\u89c4\u5219\u6c42\u51fa\u6240\u6709\u8fb9\u7684\u8d21\u732e\u4e4b\u548c\uff1a\n\n$$S_{e}=|n-2\\times size_v|\\times w_u$$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u7684\u610f\u4e49\u5728\u4e8e\uff0c\u6bcf\u4e00\u4e2a\u8fb9\u7684\u8d21\u732e\uff0c\u5c31\u53ef\u4ee5\u4e25\u683c\u6309\u7167\u9898\u76ee\u7684\u8bf4\u660e\uff0c\u8f6c\u5316\u4e3a\u5de6\u53f3\u4e24\u8fb9\u7684\u70b9\u6570\u4e4b\u5dee\u4e58\u4e0a\u8fb9\u6743\u3002\n\n\n## \u89e3\u6cd5\u5206\u6790\n\n\u7531\u4e8e\u4e00\u5171\u6709 $n$ \u4e2a\u70b9\uff0c\u5bf9\u4e8e\u67d0\u4e00\u8fb9\u5b50\u6811\u7684 $size_v$ \u6765\u8bf4\uff0c\u53e6\u4e00\u8fb9\u663e\u7136\u6709 $n-size_v$ \u4e2a\u70b9\uff0c\u4e5f\u5c31\u662f\u8bf4\u4e24\u8fb9\u4e4b\u5dee\u5b9e\u9645\u4e0a\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a\n\n$$|n-size_v-size_v|=|n-2\\times size_v|$$\n\n\u90a3\u4e48\u6211\u4eec\u6240\u9700\u8981\u505a\u7684\uff0c\u663e\u7136\u5c31\u662f\u53bb\u627e\u51fa\u6bcf\u4e00\u4e2a\u70b9\u7684 $size$\uff0c\u5728\u8fd9\u4e00\u70b9\u4e0a\uff0c\u6211\u4eec\u8003\u8651\u4f7f\u7528 $\\texttt{DFS}$ \u8fdb\u884c\u6c42\u89e3\u3002\u540c\u5f52\u9012\u5f52\u8fdb\u884c\u641c\u7d22\u7684\u5177\u4f53\u7684\u6b65\u9aa4\u5982\u4e0b\uff1a\n\n- \u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u70b9\uff0c\u4ee4\u5176\u521d\u59cb $size$ \u4e3a $1$\uff0c\u5373\u5305\u542b\u81ea\u5df1\u3002\n- \u5982\u679c\u76ee\u524d\u641c\u7d22\u7684\u76f8\u90bb\u8fb9\u901a\u5411\u513f\u5b50\uff0c\u90a3\u4e48\u7ee7\u7eed\u4e0b\u4e00\u8f6e\u7684\u641c\u7d22\uff0c\u5728\u9012\u5f52\u540e\u8fdb\u884c\u7b54\u6848\u7684\u7d2f\u52a0\u3002\n- \u7528\u9012\u5f52\u7684\u7ed3\u679c\u66f4\u65b0\u5f53\u524d\u8282\u70b9\u7684 $size$\u3002\n\n## \u4ee3\u7801\u5b9e\u73b0\n\n\u5b9e\u73b0\u7684\u8fc7\u7a0b\u4e2d\u6ce8\u610f\u4ee5\u4e0b\u51e0\u70b9\uff1a\n\n- \u7531\u4e8e\u662f\u4e00\u9897\u6811\uff0c\u56e0\u6b64\u5efa\u8fb9\u662f\u65e0\u5411\u7684\uff08\u6362\u8a00\u4e4b\u53cc\u5411\u7684\uff09\u3002\n- \u7b54\u6848\u53ef\u80fd\u4f1a\u7206 $\\texttt{long\\ long}$\u3002\n- \u9012\u5f52\u4e0d\u80fd\u91cd\u590d\u641c\u7d22\u5230\u81ea\u5df1\u7684\u7236\u4eb2\uff0c\u5426\u5219\u4f1a\u51fa\u4e0d\u6765\u3002\n\n\u90a3\u4e48\u7ed9\u51fa AC \u4ee3\u7801\u53ef\u4f9b\u5bf9\u62cd\u8c03\u8bd5\u4f7f\u7528\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define N 1000005 \nusing namespace std;\nint n,cnt,h[N],ans,s[N];\nstruct Edge{\n    int v,w,nxt;\n}e[N<<1];\nvoid add(int u,int v,int w){\n    e[++cnt].v=v;e[cnt].w=w;\n    e[cnt].nxt=h[u];h[u]=cnt;\n}void dfs(int x,int fa){\n\ts[x]=1;\n\tfor(int i=h[x];i;i=e[i].nxt){\n\t\tint v=e[i].v,w=e[i].w;\n\t\tif(v!=fa){\n\t\t\tdfs(v,x);\n\t\t\tans+=abs(n-2*s[v])*w;\n\t\t\ts[x]+=s[v];\n\t\t}\n\t}\n}signed main(){\n\tscanf(\"%lld\",&n);\n\tfor(int i=1;i<n;i++){\n\t\tint u,v,w;\n\t\tscanf(\"%lld%lld%lld\",&u,&v,&w);\n\t\tadd(u,v,w);add(v,u,w);\n\t}dfs(1,1);\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1627347668,
        "uid": 212283,
        "name": "Aw\u987f\u987f",
        "ccfLevel": 5,
        "title": "\u3010\u9898\u89e3\u3011P2052 [NOI2011] \u9053\u8def\u4fee\u5efa"
    },
    {
        "content": "\u535a\u5ba2\u9605\u8bfb\u6233\u8fd9\u91cc\uff1a[\u6233\u6211!\u6233\u6211!](https://www.cnblogs.com/rmy020718/p/9416193.html)\n\n\u5148\u8bf4\u4e00\u4e0b\u66b4\u529b\u89e3\u6cd5\uff0c\u65e2\u7136\u7ed9\u51fa\u4e86\u6bcf\u4e00\u6761\u8fb9\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u6bcf\u4e00\u6b21\u5904\u7406\u4e24\u4e2a\u70b9\u7684\u65f6\u5019\uff0c\u5f53\u505a\u8fd9\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684\u8fb9\u4e0d\u5b58\u5728\uff0c\u90a3\u6837\u7684\u8bdd\u5c31\u76f8\u5f53\u4e8e\u5c06\u8fd9\u4e2a\u56fe\u5206\u6210\u4e86\u4e24\u90e8\u5206\uff0c\u7136\u540e\u5224\u65ad\u4e00\u4e0b\uff0c\u67d0\u4e00\u90e8\u5206\u7684\u70b9\u7684\u6570\u91cf\uff0c\u5316\u7b80\u4e00\u4e0b\u8ba1\u7b97\u4ee3\u4ef7\u7684\u5f0f\u5b50\u53ef\u4ee5\u5f97\u51fa\uff1a\u4ee3\u4ef7=|\u603b\u70b9\u6570-2*\u67d0\u4e00\u8fb9\u7684\u70b9\u6570|\u3002\n\n\u8fd9\u9898\u6709\u4e00\u4e2a\u5751\uff1a\u7b54\u6848\u9700\u8981\u7528long long\u7c7b\u578b\n\n\u9884\u8ba1\u5f97\u5206\uff1a``40``\n```cpp\n#include <algorithm>\n#include <iostream>\n#include <cstring>\n#include <cstdio>\n#include <vector>\n#include <cmath>\n#include <queue>\n#include <map>\nusing namespace std;\n#define N int(1e6+2)\n#define mod 998244353\n#define LL long long\nLL a[N],n,T,l,r,ans;\nLL x[N],y[N],z[N];\nstruct ahah{\n    int nxt,to;\n    LL dis;\n}edge[N];\nint head[N],tot;\nvoid add(int x,int y,int z)\n{\n    edge[++tot].nxt=head[x],edge[tot].to=y,edge[tot].dis=z,head[x]=tot;\n}\nbool vis[N];\nint dfs(int x,int sum)\n{\n    queue<int> que;\n    que.push(x); \n    while(!que.empty())\n    {\n        int temp=que.front();\n        que.pop(),sum++,vis[temp]=1;\n        for(int i=head[temp];i;i=edge[i].nxt)\n        {\n            if(temp==l&&edge[i].to==r)continue;\n            if(!vis[edge[i].to])que.push(edge[i].to);\n        }\n        \n    }\n    return sum;\n}\nint main()\n{\n    scanf(\"%d\",&n);\n    for(int i=1;i<n;i++)scanf(\"%lld%lld%lld\",&x[i],&y[i],&z[i]),add(x[i],y[i],z[i]),add(y[i],x[i],z[i]);\n    for(int i=1;i<=n;i++)\n    {\n        l=x[i],r=y[i];\n        ans+=abs(n-2*dfs(x[i],0))*z[i];\n        for(int i=1;i<=n;i++)vis[i]=0;\n    }\n    printf(\"%lld\",ans);\n}\n```\n\n\u6b63\u89e3\uff1a\u9898\u76ee\u4e2d\u8bf4\u5230n\u4e2a\u70b9n-1\u6761\u8fb9\u90a3\u4e48\u81ea\u7136\u60f3\u5230\u8fd9\u662f\u4e00\u68f5\u6811\u54af\uff0c\u4e00\u9897\u65e0\u6839\u6811\uff0c\u6211\u4eec\u53ef\u4ee5\u7ed9\u5b83\u968f\u610f\u5b9a\u4e49\u4e00\u4e2a\u6839\uff0c\u8fd9\u91cc\u5b9a\u4e491\u53f7\u4e3a\u6839\uff0c\u7136\u540e\u5224\u65ad\u6bcf\u4e2a\u8282\u70b9\u7684\u5b50\u6811\u6709\u591a\u5c11\u4e2a\u8282\u70b9(\u4e5f\u5c31\u662f\u8bf4\u5c06\u8fd9\u4e2a\u70b9\u548c\u5b83\u7684\u7236\u8282\u70b9\u5207\u65ad\u540e\u67d0\u4e00\u4fa7\u4f1a\u6709\u591a\u5c11\u4e2a\u8282\u70b9,\u4ed4\u7ec6\u60f3\u60f3,\u662f\u5427)\u3002\n\n\u7136\u540e\u901a\u8fc7dfs\u6765\u8ba1\u7b97\u6bcf\u4e00\u6761\u8fb9\u7684\u6d88\u8017\u4ee3\u4ef7\u3002\n```cpp\n#include <algorithm>\n#include <iostream>\n#include <cstring>\n#include <cstdio>\n#include <vector>\n#include <cmath>\n#include <queue>\n#include <map>\nusing namespace std;\n#define N int(2e6+2)\n#define mod 998244353\n#define LL long long\nLL a[N],n,T,l,r,ans;\nLL x[N],y[N],z[N],siz[N];\nstruct ahah{\n    int nxt,to;\n    LL dis;\n}edge[N];\nint head[N],tot;\nvoid add(int x,int y,int z)\n{\n    edge[++tot].nxt=head[x],edge[tot].to=y,edge[tot].dis=z,head[x]=tot;\n}\nbool vis[N];\nint dfs(int s,int fa)\n{\n    vis[s]=1;\n    for(int i=head[s];i;i=edge[i].nxt)\n    {\n        if(edge[i].to!=fa)    //\u4e0d\u80fd\u518d\u6b21\u5411\u7236\u8282\u70b9\u8fde\u8fb9\u907f\u514d\u91cd\u590d\u8ba1\u7b97\u3002\n        {\n            ans+=abs(siz[1]-2*siz[edge[i].to])*edge[i].dis;        \n            dfs(edge[i].to,s);\n        }\n    }\n}\nvoid prepare(int u,int list)\n{\n    for(int i=head[u];i;i=edge[i].nxt)\n        if(edge[i].to!=list)     //\u5148\u8ba1\u7b97\u5b50\u8282\u70b9\u542b\u8282\u70b9\u6570\u76ee,\u518d\u52a0\u4e0a\u5c31\u597d\u4e86\u3002 \n            prepare(edge[i].to,u),siz[u]+=siz[edge[i].to];\n}\nint read()\n{\n    int sum=0,fg=1; char c=getchar();\n    while(c<'0'||c>'9'){if(c=='-')fg=-1;c=getchar();}\n    while(c>='0'&&c<='9'){sum=sum*10+c-'0';c=getchar();}\n    return sum*fg;\n}\nint main()\n{\n    scanf(\"%d\",&n);\n    for(int i=1;i<n;i++)\n    {\n        siz[i]=1;        //\u521d\u59cb\u65f6\u6bcf\u4e2a\u8282\u70b9\u53ea\u542b\u6709\u81ea\u5df11\u4e2a \n        x[i]=read();y[i]=read();z[i]=read();\n        add(x[i],y[i],z[i]),add(y[i],x[i],z[i]);\n    }\n    siz[n]=1;\n    prepare(1,1);\n    for(int i=1;i<=n;i++)\n        if(!vis[i])dfs(i,i);    //\u5224\u65ad\u662f\u5426\u91cd\u590d\u3002 \n    printf(\"%lld\",ans);\n}\n```",
        "postTime": 1533300032,
        "uid": 61727,
        "name": "Manjusaka\u4e36\u68a6\u5bd2",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2052 \u3010[NOI2011]\u9053\u8def\u4fee\u5efa \u3011"
    },
    {
        "content": "\u9898\u76ee\u4e0a\u6765\u5c31\u662f $n$ \u4e2a\u56fd\u5bb6 $n-1$ \u6761\u9053\u8def\uff0c\u663e\u7136\u662f\u4e00\u68f5\u6811\u3002\n\n\u90a3\u6211\u4eec\u628a\u6837\u4f8b\u626d\u66f2\u4e00\u4e0b\uff0c\u53d8\u6210\u4e00\u68f5\u4ee5 $1$ \u4e3a\u6839\u7684\u6811\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/k0f9il7f.png)\n\n\u5047\u5982\u6211\u4eec\u8981\u6c42\u7ea2\u8fb9\u7684\u8d39\u7528\uff0c\u901a\u8fc7\u770b\u4e0a\u9762\u8fd9\u5f20\u56fe\u5f88\u5bb9\u6613\u53ef\u4ee5\u53d1\u73b0\u8d39\u7528\u5c31\u662f\u8be5\u8fb9\u8fb9\u6743\u4e58\u4ee5**\u4ee5\u513f\u5b50\u4e3a\u6839\u7684\u5b50\u6811\u7684\u603b\u7ed3\u70b9\u6570\u548c\u6574\u68f5\u6811\u4e2d\u5176\u4ed6\u7ed3\u70b9\u6570\u7684\u5dee\u7684\u7edd\u5bf9\u503c**\u3002\u5176\u5b83\u8fb9\u540c\u7406\u3002\u6240\u4ee5\u53ea\u9700\u8981\u6c42\u51fa\u8fd9\u4e2a\u4e1c\u897f\u5c31\u597d\u4e86\u3002\n\n\u7136\u540e\u8fdb\u4e00\u6b65\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u6574\u68f5\u6811\u4e2d\u5176\u4ed6\u7ed3\u70b9\u6570\u5c31\u662f $n$ \u51cf\u53bb\u4ee5\u513f\u5b50\u4e3a\u6839\u7684\u5b50\u6811\u7684\u603b\u7ed3\u70b9\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u73b0\u5728\u53ea\u9700\u8981\u6c42\u4ee5\u6bcf\u4e2a\u8282\u70b9\u4e3a\u6839\u7684\u5b50\u6811\u7684\u603b\u7ed3\u70b9\u6570\uff0c\u8fd9\u4e1c\u897f dfs \u8dd1\u4e00\u904d\u5c31\u597d\u4e86\uff0c\u7136\u540e\u518d\u6765\u4e00\u904d dfs \u7edf\u8ba1\u6bcf\u6761\u8fb9\u7684\u8d39\u7528\u3002\n\n\u7b54\u6848\u8981\u5f00 long long.\n\nCode\n\n```cpp\n#include <cstdio>\n#include <cmath>\nusing namespace std;\nconst int MAXN=1000005;\ninline int read() {\n\tint res=0,f=1; char ch=getchar();\n\twhile(ch<'0'||ch>'9') {if(ch=='-') f=-1; ch=getchar();}\n\twhile(ch>='0'&&ch<='9') {res=res*10+ch-'0'; ch=getchar();}\n\treturn res*f;\n}\nint n,ecnt;\nlong long ans=0;\nint head[MAXN];\nint tot[MAXN];\nstruct Edge {\n\tint next,to,dis;\n}e[MAXN<<1];\ninline void add(int from,int to,int dis) {\n\te[++ecnt].next=head[from];\n\te[ecnt].to=to;\n\te[ecnt].dis=dis;\n\thead[from]=ecnt;\n}\ninline void dfs1(int x,int fa) {\n\ttot[x]=1;\n\tfor(register int i=head[x];i;i=e[i].next) {\n\t\tif(e[i].to==fa) continue;\n\t\tdfs1(e[i].to,x);\n\t\ttot[x]+=tot[e[i].to];\n\t}\n}\ninline void dfs2(int x,int fa) {\n\tfor(register int i=head[x];i;i=e[i].next) {\n\t\tif(e[i].to==fa) continue;\n\t\tans+=abs(tot[e[i].to]-(n-tot[e[i].to]))*(long long)e[i].dis;\n\t\tdfs2(e[i].to,x);\n\t}\n}\nsigned main() {\n\tn=read();\n\tfor(register int u,v,w,i=1;i<n;++i) {\n\t\tu=read(); v=read(); w=read();\n\t\tadd(u,v,w); add(v,u,w);\n\t}\n\tdfs1(1,0);\n\tdfs2(1,0);\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1627624865,
        "uid": 149815,
        "name": "Isprime",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2052 \u3010[NOI2011] \u9053\u8def\u4fee\u5efa\u3011"
    },
    {
        "content": "\u9996\u5148\u5bf9\u4e8e\u4e00\u68f5\u6811\uff0c\u4ed6\u80af\u5b9a\u662f\u4e00\u4e2a**\u8fde\u901a\u56fe**\u3002\n\n\u6240\u4ee5\uff0c\u5bf9\u4e8e\u4e00\u6761\u8fb9 $(x,y)$\uff0c$x$ \u8fde\u7684\u8282\u70b9\u4e2a\u6570 $-$ $y$ \u8fde\u7684\u8282\u70b9\u4e2a\u6570 $=$ $($ $n$ $-$ $y$ \u8fde\u7684\u8282\u70b9\u4e2a\u6570 $)$ $-$ $y$ \u8fde\u7684\u8282\u70b9\u4e2a\u6570\n\n\u56e0\u4e3a\u8fd9\u5f20\u56fe\u662f\u8fde\u901a\u7684\uff0c\u6240\u4ee5**\u6240\u6709\u8282\u70b9\u4e0d\u5728 $x$ \u90a3\u7aef\uff0c\u5c31\u5728 $y$ \u90a3\u7aef**\u3002\n\n\u6211\u4eec\u56de\u5230\u6811\uff0c\u6211\u4eec\u53ef\u4ee5 $O(n)$ \u7684\u65f6\u95f4\u904d\u5386\u4e00\u904d\u6811\uff0c\u5e76\u6c42\u51fa $size$\u3002\n\n\u5927\u5bb6\u53ef\u4ee5\u770b\u770b\u6211\u7684\u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntemplate<typename T>inline void read(T &FF) {\n\tT RR = 1; FF = 0; char CH = getchar();\n\tfor (; !isdigit(CH); CH = getchar())if (CH == '-')RR = -1;\n\tfor (; isdigit(CH); CH = getchar())FF = (FF << 1) + (FF << 3) + (CH ^ 48);\n\tFF *= RR;\n}\nconst int N = 1e6 + 10;\nvector<pair<int, int> >v[N];\nll sz[N], ans, n;\nvoid dfs(int x, int fa) {\n\tsz[x] = 1;//\u6c42size\n\tfor (auto i : v[x]) {\n\t\tif (i.first != fa) {\n\t\t\tdfs(i.first, x);\n\t\t\tsz[x] += sz[i.first];\n\t\t\tans += 1ll * i.second * abs(sz[i.first] - (n - sz[i.first]));//\u4e0a\u9762\u7684\u65b9\u6cd5\n\t\t}\n\t}\n}\nint main() {\n\tread(n);\n\tfor (int i = 1; i < n; i++) {\n\t\tint x, y, z;\n\t\tread(x); read(y); read(z);\n\t\tv[x].push_back(make_pair(y, z));\n\t\tv[y].push_back(make_pair(x, z));\n\t} dfs(1, 0);\n\tcout << ans;\n\treturn 0;\n}\n```",
        "postTime": 1589594882,
        "uid": 180242,
        "name": "orzdevinwang",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2052 \u3010[NOI2011]\u9053\u8def\u4fee\u5efa\u3011"
    },
    {
        "content": "## 0.\u7eea\u8bba\n\u6700\u8fd1\u6709\u4e9b\u9893\u5e9f\uff0c\u4e8e\u662f\u5c31\u5237\u5230\u4e86\u8fd9\u6837\u4e00\u9053\u5927\u6c34\u9898\u2026\u2026     \n~~\u6240\u4ee5\u6211\u5c31\u6765\u6c34\u9898\u89e3\u52a0\u5495\u503c\u4e86 **\uff08[\u987a\u4fbf\u5ba3\u4f20\u535a\u5ba2\u56ed](https://www.cnblogs.com/juruoajh/)\uff09**~~\n## 1.\u89e3\u6cd5\n\u770b\u5230\u9898\u9762\u7b2c\u4e00\u773c\u88ab\u5413\u4e86\u4e00\u4e0b\uff0c\u8fd8\u4ee5\u4e3a\u662f\u6c42\u6700\u4f18\u65b9\u6848\u4e4b\u7c7b\u7684 ~~\uff08\u6211\u679c\u7136\u8fd8\u662f\u592a\u83dc\u4e86\uff09~~\uff0c\u4e0d\u8fc7\u770b\u4e86\u7b2c\u4e8c\u773c\u5c31\u53ef\u4ee5\u53d1\u73b0\uff1a\u4ed6\u5176\u5b9e\u53ea\u662f\u7ed9\u51fa\u8fb9\u7684\u957f\u5ea6\u8ba9\u4f60\u7edf\u8ba1\u6240\u6709**\u8fb9\u6743=\u4e24\u7aef\u70b9\u6570\u5dee$\\times$\u8fb9\u957f**\u4e4b\u548c\u3002           \n\u53ef\u4ee5\u91c7\u53d6\u7b80\u5355\u7684\u641c\u7d22\u8fc7\u6389\u6b64\u9898\u3002         \n\u6309\u7167\u6b63\u5e38\u7684\u641c\u6cd5\uff0c\u8bb0\u5f55\u6bcf\u4e2a\u70b9\u7684\u5b50\u6811\u5927\u5c0f```siz[i]```\uff0c\u540c\u65f6\u7edf\u8ba1\u7b54\u6848```ans+=abs(n-2*siz[v])*e[i].wei```\u3002\n## 2.\u7ec6\u8282\n$ans$\u4f1a\u7206$int$\uff0c\u6ce8\u610f```#define int LL```\uff0c\u53ef\u4ee5\u81ea\u884c\u7b97\u4e00\u4e0b\u3002~~\uff08\u5f53\u7136\u50cf\u6211\u4e00\u6837\u61d2\u5f97\u7b97\u7684\u4e5f\u53ef\u4ee5\u5b9e\u8df5\u51fa\u771f\u77e5\uff09~~\n## 3.\u4ee3\u7801\n\u6b64\u5904\u7ed9\u51fa\u4ee3\u7801\u4e3b\u4f53\u90e8\u5206\uff08\u518d\u63d0\u9192\u4e00\u904d\u8bb0\u5f97LL\uff01\uff09     \n\u7f3a\u7701\u6e90\u53bb[\u8fd9\u91cc](https://www.cnblogs.com/juruoajh/p/12632444.html)\u627e\u3002      \n```cpp\n#define N 1000010\nint n,ans,siz[N];\n//siz[i]\u8868\u793a\u70b9i\u7684\u5b50\u6811\u5927\u5c0f\uff08\u4e5f\u5c31\u662f\u8fd9\u6761\u8fb9\u4e00\u7aef\u7684\u70b9\u6570\uff09 \nstruct Edge {\n\tint to,nxt,wei;\n}e[N<<1];\nint head[N],cnt;\ninline void ade(int u,int v,int w){\n\te[++cnt].to=v;\n\te[cnt].wei=w;\n\te[cnt].nxt=head[u];\n\thead[u]=cnt;\n}\nvoid DFS(int now,int fa){\n\tsiz[now]=1;\n\tfor(rg int i=head[now];i;i=e[i].nxt){\n\t\tint v=e[i].to;\n\t\tif(v!=fa){\n\t\t\tDFS(v,now);\n\t\t\t//\u4e00\u6761\u8fb9\u7684\u8fb9\u6743\uff1aabs(siz[v]-(n-siz[v]))*e[i].wei \n\t\t\tans+=abs(n-2*siz[v])*e[i].wei;\n\t\t\tsiz[now]+=siz[v];\n\t\t}\n\t}\n}\nsigned main(){\n\tRead(n);\n\tfor(rg int i=1;i<n;i++){\n\t\tint u,v,w;\n\t\tRead(u),Read(v),Read(w);\n\t\tade(u,v,w),ade(v,u,w);\n\t}\n\tDFS(1,0);//\u968f\u4fbf\u627e\u4e00\u4e2a\u70b9\u5f53\u6839\u641c\u7d22 \n\tcout<<ans<<endl;\n\treturn 0;\n}\n```\n\u5b8c\u7ed3\u6492\u82b1~",
        "postTime": 1588647348,
        "uid": 220524,
        "name": "_ajthreac_",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2052 \u3010[NOI2011]\u9053\u8def\u4fee\u5efa\u3011"
    },
    {
        "content": "\u5206\u6790$:$\n\u661f\u7403\u4e0a\u6709$N$\u4e2a\u56fd\u5bb6\u3002\u5728\u5404\u4e2a\u56fd\u5bb6\u4e4b\u95f4\u5efa\u8bbe$N-1$\u53cc\u5411\u9053\u8def\u4f7f\u5f97\u56fd\u5bb6\u4e4b\u95f4\u8fde\u901a\u3002  \n\u6bcf\u6761\u9053\u8def\u7684\u4fee\u5efa\u90fd\u8981\u4ed8\u51fa\u4e00\u5b9a\u7684\u8d39\u7528\uff0c\u8fd9\u4e2a\u8d39\u7528\u7b49\u4e8e\u9053\u8def\u957f\u5ea6\u4e58\u4ee5\u9053\u8def\u4e24\u7aef \u7684\u56fd\u5bb6\u4e2a\u6570\u4e4b\u5dee\u7684\u7edd\u5bf9\u503c\u3002\u4f8b\u5982\uff0c\u5728\u4e0b\u56fe\u4e2d\uff0c\u865a\u7ebf\u6240\u793a\u9053\u8def\u4e24\u7aef\u5206\u522b\u6709$2$\u4e2a\u548c$4$\u4e2a\u56fd\u5bb6\uff0c\u5982\u679c\u8be5\u9053\u8def\u957f\u5ea6\u4e3a$1$\uff0c\u5219\u8d39\u7528\u4e3a$1\u00d7|4-2|=2$\u3002\n![](https://cdn.luogu.com.cn/upload/pic/2604.png)  \n\u8bf7\u5bf9\u4e8e\u7ed9\u5b9a\u7684\u5efa\u9020\u65b9\u6848\uff0c\u8ba1\u7b97\u51fa\u6240\u9700\u8981\u7684\u8d39\u7528\u3002\n\u8f93\u5165\u683c\u5f0f\n\u8f93\u5165\u7684\u7b2c\u4e00\u884c\u5305\u542b\u4e00\u4e2a\u6574\u6570$N$\u7684\u56fd\u5bb6\u7684\u6570\u91cf\uff0c\u56fd\u5bb6\u4ece$1$\u5230$N$\u7f16\u53f7\u3002  \n\u63a5\u4e0b\u6765$N-1$\u884c\u63cf\u8ff0\u9053\u8def\u5efa\u8bbe\u60c5\u51b5\uff0c\u5176\u4e2d\u7b2c$i$\u884c\u5305\u542b\u4e09\u4e2a\u6574\u6570 $a_i,b_i,c_i,$\u8868\u793a\u7b2c$i$\u6761\u53cc\u5411\u9053\u8def\u4fee\u5efa\u5728$a_i,b_i$\u4e24\u4e2a\u56fd\u5bb6\u4e4b\u95f4$,$\u957f\u5ea6\u4e3a$c_i$\u3002  \n\u5bf9\u4e8e$45\\%$\u7684\u6570\u636e$:2\\leq N \\leq10^4$  \n\u5bf9\u4e8e$100\\%$\u7684\u6570\u636e$:2\\leq N\\leq10^6,1\\leq a_i,b_i\\leq N,0\\leq c_i\\leq10^6$\n\n\u5206\u6790$:$  \n\u56e0\u4e3a\u53ea\u4fee$N-1$\u6761\u9053\u8def,\u6240\u4ee5,\u5b83\u4e00\u5b9a\u4f1a\u8fde\u6210\u4e00\u4e2a\u6811.  \n\u53c8\u56e0\u4e3a\u5b83\u4e00\u4e2a\u70b9\u6709\u53ef\u80fd\u8fde$10^6-1$\u4e2a\u70b9,\u4e5f\u6709\u53ef\u80fd\u53ea\u8fde$1$\u4e2a\u70b9,\u6240\u4ee5\u5fc5\u987b\u8981\u6709\u4e00\u79cd\u53ef\u53d8\u957f\u5ea6\u6570\u7ec4\u7684\u6570\u636e\u7ed3\u6784.  \n\u7b2c\u4e00\u4e2a\u60f3\u5230\u7684\u5c31\u662f$vector,$\u4f46\u662f\u849f\u84bb\u4e0d\u4f1a\u7528$.$\u4e8e\u662f\u5c31\u53ea\u80fd\u5f53\u4e00\u4e2a\u8461\u8404\u67b6\u4e0b\u7684\u72d0\u72f8\u5047\u88c5\u8bf4$vector$\u5f88\u6162\u4e86ToT(\u597d\u50cf$vector$\u771f\u7684\u5f88\u6162,\u6ca1\u6709\u6570\u636e\u7ed3\u6784\u80fd\u6bd4\u4ed6\u6162\u4e86)  \n\u8fd8\u6709\u4ec0\u4e48\u80fd\u6a21\u62df$vector$\u5462$?$\n### [\u6307\u9488](https://www.luogu.com.cn/blog/Luo-is-LWZ080805/Adjacency-table) $!!!$\n\u8fd9\u91cc\u5c31\u9009\u6570\u7ec4\u6a21\u62df\u6307\u9488\u4e86$.$  \n\u56e0\u4e3a\u6211\u4eec\u4e0d\u9700\u8981\u5728\u4e24\u4e2a\u8fb9\u4e4b\u95f4\u63d2\u5165\u4e00\u6761\u8fb9,\u6240\u4ee5\u53ea\u9700\u8981\u4fdd\u5b58\u5934\u5c31\u53ef\u4ee5\u4e86\n```\n       \u250f\u2501\u2501\u2501\u2501\u2513  \u250f\u2501\u2501\u2501\u2501\u2513\n       \u2503 x  \u2503  \u2503 x  \u2503\n       \u2523\u2501\u2501\u2501\u2501\u252b  \u2523\u2501\u2501\u2501\u2501\u252b\n*head\u2501\u2501> to \u2503\u250f\u2501> to \u2503\u250f>NULL\n       \u2523\u2501\u2501\u2501\u2501\u252b\u2503 \u2523\u2501\u2501\u2501\u2501\u252b\u2503\n       \u2503*nxt\u2523\u251b \u2503*nxt\u2523\u251b\n       \u2517\u2501\u2501\u2501\u2501\u251b  \u2517\u2501\u2501\u2501\u2501\u251b\n```\n\u4f46\u6307\u9488\u8fd8\u662f\u6162,\u6700\u540e\u6211\u4eec\u7528\u6570\u7ec4\u6a21\u62df\u6307\u9488\u6765\u505a,\u8fd8\u6709\u4f18\u5316\u7684\u7a7a\u95f4.  \n\u8fd9\u5c31\u6709\u4e86[\u90bb\u63a5\u8868\u7b14\u8bb0](https://www.luogu.com.cn/blog/Luo-is-LWZ080805/lin-jie-biao)\u91cc\u4ee3\u7801\u7684\u65b9\u6cd5$.$\n\n45\u5206\u505a\u6cd5$:O(N^2)$  \n\u5728\u90bb\u63a5\u8868\u7684\u57fa\u7840\u4e0a\u7206\u641c\n\n\u52a0\u4e00\u4e0b\u8bb0\u5fc6\u5316\u641c\u7d22\u53ed  \n100\u5206\u505a\u6cd5$:O(N)$\n```cpp\n#include<algorithm>\n#include<cmath>\n#include<cstdio>\nusing namespace std;\n#define NR 1000002\n#define MR 1000002\nstruct edge{\n\tint to,nxt,w;\n}g[2*MR];\nint gsz;\nint fte[NR];\nlong long ans;\nbool flag[NR];\nint n;\nvoid addedge(int u,int v,int w){\n\tg[++gsz]=(edge){v,fte[u],w};\n\tfte[u]=gsz;\n}\nint dfs(int x){\n\tflag[x]=1;//\u8bb0\u5fc6\u5316\n\tint sum=1;\n\tfor(int i=fte[x];i;i=g[i].nxt){\n\t\tint y=g[i].to;\n\t\tif(flag[y])continue;//\u5982\u679c\u5df2\u7ecf\u641c\u8fc7\u4e86\u5c31\u8df3\u8fc7\n\t\tint num=dfs(y);\n\t\tans+=1ll*abs(n-2*num)*g[i].w;\n\t\tsum+=num;\n\t}return sum;\n}\nint main(){ \n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<n;++i){\n\t\tint u,v,w;\n\t\tscanf(\"%d%d%d\",&u,&v,&w);\n\t\taddedge(u,v,w);\n\t\taddedge(v,u,w);\n\t}\n\tdfs(1);\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n\u6700\u540e\uff0c\u63a8\u5e7f\u4e00\u4e0b[\u535a\u5ba2](https://www.luogu.com.cn/blog/Luo-is-LWZ080805/)\uff1a\u91cc\u9762\u6709\u80cc\u5305\u95ee\u9898\u6a21\u677f\u4e0e\u4e00\u4e9b\u56fe\u8bba\u7684\u77e5\u8bc6\u70b9\uff0c\u6b22\u8fce\u5404\u4f4d\u63d0\u9ad8\u7ec4\u7684dalao\u540a\u6253\u3002  \n\u540a\u6253\u4e5f\u662f\u7231\uff01\n# \u8c22\u8c22\u5404\u4f4d!",
        "postTime": 1585355897,
        "uid": 192447,
        "name": "\u7f57\u95fb\u7ae01",
        "ccfLevel": 0,
        "title": "P2052\u7b14\u8bb0"
    },
    {
        "content": "\u8fd9\u9053\u9898\uff0c\u6211\u6700\u5f00\u59cb\u5ba1\u9898\u51fa\u4e86\u70b9\u95ee\u9898\uff0c\u4e4b\u540e\u628a\u4ee3\u7801\u5b8c\u5168\u91cd\u6784\u4e86\u4e00\u904d\u3002\u6211\u603b\u89c9\u5f97\u8fd9\u9898\u601d\u8def\u4e0d\u7b97\u96be\uff0c\u6d1b\u8c37DFS\u5c31\u80fd\u8fc7\u3002\n\n\u4e0d\u8fc7\uff0c\u636e\u8bf4NOI2011\u8d5b\u573a\u4e0a\u5199DFS\u4f1a\u7206\u6808\uff0c\u53ea\u5f9775\u5206\uff0c\u4e8e\u662f\u6211\u53c8\u7528BFS\u5199\u4e86\u4e00\u904d\uff0c\u5b9e\u6d4b\u4e0d\u5f00O2\u4f1aTLE4\u4e2a\u70b9\uff0c\u5f00O2\u80fd\u8fc7\uff0c\u7136\u800c\uff0c\u5373\u4f7fTLE4\u4e2a\u70b9\u53d880\u4e5f\u6bd4DFS\u7206\u6808\u53d875\u5f3a\uff0c\u53e6\u5916\uff0c\u6211\u53d1\u73b0\u6ca1\u6709BFS\u7684\u9898\u89e3\uff0c\u6211\u5c31\u6765HNO3\u4e00\u53d1\u5427\u3002\n\n\u6ce8\u610f\u672c\u9898\u9898\u610f\u4e3a\u5148\u5efa\u6811\uff0c\u518d\u6c42\u89e3\uff0c\u4e0d\u80fd\u7528\u5e76\u67e5\u96c6\u4e00\u6761\u4e00\u6761\u5730\u52a0\u8fb9\uff0c\u90a3\u6837\u53ea\u80fd\u5f975\u5206\uff08\u53ea\u67091\u8fb9\uff0c\u8d39\u7528\u4e3a0\uff09\u3002\n\n1. DFS\u505a\u6cd5\uff1a\u968f\u4fbf\u627e\u4e00\u70b9\u505a\u6839\uff0c\u5411\u4e0b\u641c\u7d22\u6c42\u51fa\u5404\u4e2a\u8282\u70b9\u5b50\u6811\u5927\u5c0f\uff0c\u987a\u4fbf\u6c42\u51fa\u6bcf\u6761\u8fb9\u7684\u8d39\u7528\uff0c\u56e0\u4e3a\u5176\u4e2d\u4e00\u8fb9\u5927\u5c0f\u662fS\uff0c\u53e6\u4e00\u8fb9\u5fc5\u662fN-S\uff0c\u6240\u4ee5\u76f4\u63a5\u6c42N-2S\u7684\u7edd\u5bf9\u503c\u5373\u53ef\u3002\n\n2. BFS\u505a\u6cd5:\u8fd8\u662f\u968f\u4fbf\u627e\u4e00\u6839\uff0c\u5148\u4ece\u6839\u81f3\u53f6\u6c42\u51fa\u7b2c\u4e8c\u6b21\u7a77\u4e3e\u7684\u987a\u5e8f\uff0c\u5728\u4ece\u53f6\u81f3\u6839\u6c42\u5b50\u6811\u5927\u5c0f\u3001\u4ee5\u53ca\u8fb9\u7684\u8d39\u7528\u3002\n\n\u9644\u6ce8\u4ee3\u7801\uff1a\n\n1. \u5ba1\u9519\u9898\uff0c5pts:\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\n#define ll long long\n#define maxn 1024000\nint n;\nint fa[maxn];\nll siz[maxn];\nll ans;\nvoid init()\n{\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfa[i]=i;\n\t\tsiz[i]=1;\n\t}\n\treturn;\n}\nint find(int x)\n{\n\tif(fa[x]==x)\n\t{\n\t\treturn x;\n\t}else\n\t{\n\t\tsiz[fa[x]]+=siz[x];\n\t\tsiz[x]=0;\n\t\treturn fa[x]=find(fa[x]);\n\t}\n}\nvoid merge(int x,int y)\n{\n\tint fx=find(x);\n\tint fy=find(y);\n\tfa[fx]=fy;\n\tsiz[fy]+=siz[fx];\n\tsiz[fx]=0;\n\treturn;\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tinit();\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tint x,y;\n\t\tll z;\n\t\tscanf(\"%d%d%lld\",&x,&y,&z);\n\t\tx=find(x);\n\t\ty=find(y);\n\t\tans+=z*abs(siz[x]-siz[y]);\n\t\tmerge(x,y);\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n\n2. DFS\u7248\u201c\u6b63\u89e3\u201d\uff0cOJ\u4e0aAC\uff0cNOI2011\u4e0a75pts:\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\n#define ll long long\n#define maxn 1024000\nint n;\nstruct node\n{\n\tint to;\n\tint nxt;\n\tll val;\n}nd[2*maxn];\nint head[maxn],cnt;\nll siz[maxn];\nll ans;\nvoid init()\n{\n\tmemset(head,-1,sizeof(head));\n\tcnt=1;\n\treturn;\n}\nvoid add(int x,int y,ll z)\n{\n\tnd[cnt].to=y;\n\tnd[cnt].nxt=head[x];\n\tnd[cnt].val=z;\n\thead[x]=cnt++;\n\treturn;\n}\nvoid dfs(int x,int rt)\n{\n\tsiz[x]=1;\n\tfor(int i=head[x];i!=-1;i=nd[i].nxt)\n\t{\n\t\tint t=nd[i].to;\n\t\tif(t!=rt)\n\t\t{\n\t\t\tdfs(t,x);\n\t\t\tsiz[x]+=siz[t];\n\t\t\tans+=nd[i].val*abs(n-2*siz[t]);\n\t\t}\n\t}\n\treturn;\n}\nint main()\n{\n\tinit();\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tint x,y;\n\t\tll z;\n\t\tscanf(\"%d%d%lld\",&x,&y,&z);\n\t\tadd(x,y,z);\n\t\tadd(y,x,z);\n\t}\n\tdfs(1,0);\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n\n3. BFS\u7248\u201c\u6b63\u89e3\u201d\uff0c\u5f00O2\u80fd\u8fc7\uff0c\u4e0d\u5f0080pts\uff08\u6211\u4e3a\u4e86\u5361\u5e38\u6570\uff0c\u7801\u4e86\u5feb\u8bfb\uff0c\u4f46\u4f9d\u7136TLE4\u4e2a\u70b9\uff09:\n\n```cpp\n// luogu-judger-enable-o2\n#include<queue>\n#include<cstdio>\n#include<cctype>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\n#define ll long long\n#define maxn 1024000\nint n;\nstruct node\n{\n    int to;\n    int nxt;\n    ll val;\n}nd[2*maxn];\nint head[maxn],cnt;\nint dep[maxn];\nll siz[maxn];\nll ans;\nqueue<int>q;\nchar str;\nstruct point\n{\n    int x;\n    int dep;\n    friend bool operator < (point a,point b)\n    {\n        return a.dep<b.dep;\n    }\n}po;\npriority_queue<point>p;\ntemplate<class X> void read(X &x)\n{\n    x=0;\n    int f=1;\n    while(!isdigit(str))\n    {\n        if(str=='-')\n        {\n            f=-1;\n        }\n        str=getchar();\n    }\n    while(isdigit(str))\n    {\n        x*=10;\n        x+=str-'0';\n        str=getchar();\n    }\n    x*=f;\n    return;\n}\nvoid init()\n{\n    memset(head,-1,sizeof(head));\n    cnt=1;\n    return;\n}\nvoid add(int x,int y,ll z)\n{\n    nd[cnt].to=y;\n    nd[cnt].nxt=head[x];\n    nd[cnt].val=z;\n    head[x]=cnt++;\n    return;\n}\nvoid bfs()\n{\n    q.push(1);\n    memset(dep,0x3f,sizeof(dep));\n    for(int i=1;i<=n;i++)\n    {\n        siz[i]=1;\n    }\n    po.x=1;\n    dep[1]=0;\n    po.dep=0;\n    p.push(po);\n    while(q.size())\n    {\n        int x=q.front();\n        q.pop();\n        for(int i=head[x];i!=-1;i=nd[i].nxt)\n        {\n            int t=nd[i].to;\n            if(dep[t]==0x3f3f3f3f)\n            {\n                q.push(t);\n                dep[t]=dep[x]+1;\n                po.x=t;\n                po.dep=dep[t];\n                p.push(po);\n            }\t\t\t\n        }\n    }\n    while(p.size())\n    {\n        po=p.top();\n        p.pop();\n        int x=po.x;\n        for(int i=head[x];i!=-1;i=nd[i].nxt)\n        {\n            int t=nd[i].to;\n            if(dep[t]==dep[x]+1)\n            {\n                siz[x]+=siz[t];\n                ans+=nd[i].val*abs(n-2*siz[t]);\n            }\n        }\n    }\n    return;\n}\nint main()\n{\n    init();\n    read(n);\n    for(int i=1;i<n;i++)\n    {\n        int x,y;\n        ll z;\n        read(x),read(y),read(z);\n        add(x,y,z);\n        add(y,x,z);\n    }\n    bfs();\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1555677694,
        "uid": 158849,
        "name": "renhr2002",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2052 \u3010[NOI2011]\u9053\u8def\u4fee\u5efa \u3011"
    },
    {
        "content": "## \u849f\u84bb\u7684\u601d\u8def\n\u7b2c\u4e00\u773c\u770b\u9519\u9898\u76ee\uff0c\u4ee5\u4e3a\u662f\u5de6\u53f3\u4e24\u8fb9\u7f16\u53f7\u7684abs*w[i]\uff0c\u5fc3\u60f3\u8fd9\u5c31\u662f\u4e00\u9053\u5927\u6c34\u9898\n\n\u5199\u5230\u4e00\u534a\u53d1\u73b0\u7ed3\u8bba\u91cc\u662f\u5de6\u53f3\u4e24\u8fb9\u7684\u8282\u70b9\u6570\u91cf\uff0c\u601d\u8003\u4e86\u4e00\u4e0b\uff0c\u5bf9\u4e8e\u4efb\u610f\u6811\u4e0a\u8fb9\uff0c\u53ef\u4ee5\u5728dfs\u7684\u65f6\u5019\u7edf\u8ba1\u5b50\u6811\u5927\u5c0f\uff0c\u540c\u65f6\u6839\u636e\u516c\u5f0f _**abs\uff08n-size[v]-siz[v])*w[i]**_ \u8ba1\u7b97\u6bcf\u6761\u8fb9\u7684\u8d21\u732e\uff0c\u9009\u53d6\u7684\u6839\u8282\u70b9\u4e0d\u5931\u4e00\u822c\u6027\n\n## \u4e00\u70b9\u51cf\u5c11\u7801\u91cf\u7684\u7ed3\u8bba\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8fde\u8fb9\uff08\u4e0d\u5305\u62ec\u7236\u8fb9\uff09\u90fd\u53ef\u4ee5\u5728\u5faa\u73af\u5185\u5c31\u8ba1\u7b97\u51fa\u6765\uff0c\u56e0\u4e3a\u5730\u7403\u4eba\u90fd\u77e5\u9053\u4e58\u6cd5\u52a0\u6cd5\u6ee1\u8db3\u7ed3\u5408\u5f8b~~\uff08\u611f\u89c9\u6211\u548c\u6ca1\u8bf4\u4e00\u6837\uff09~~\n\n## Solution\n**\u849f\u84bb\u8ba4\u4e3a\u4e0e\u5176\u4f1a\u505a\u4e00\u9053\u9898\uff0c\u4e0d\u5982\u4f7f\u7528\u4e00\u79cd\u601d\u7ef4\u65b9\u5f0f\u6765\u89e3\u51b3\u95ee\u9898**\n\n### \u5982\u4f55\u60f3\u5230\u8fd9\u6837\u4e00\u4e2a\u7b97\u6cd5\uff1f\n\n\u6811\uff1f\u4fdd\u8bc1\u8054\u901a\u53ea\u6709\u4e00\u79cd\u65b9\u5f0f\n\n\u7b54\u6848\u552f\u4e00\uff1f~~\uff08\u9898\u76ee\u5c31\u662f\u9a97\u4eba\uff09~~\u53d1\u73b0\u4e24\u7aef\u8282\u70b9\u4e2a\u6570\u56fa\u5b9a\uff0c\u4e0e\u7edf\u8ba1\u987a\u5e8f\u65e0\u5173\n\n### \u5982\u4f55\u5b9e\u73b0\uff1f\n\n\u5982\u4f55\u7edf\u8ba1\u7b54\u6848\uff1f\u6839\u636e\u516c\u5f0f\u8ba1\u7b97\n\n\u5982\u4f55\u8fdb\u884cdfs\uff1f\u901a\u8fc7\u81ea\u4e0b\u800c\u4e0a\u7ef4\u62a4\u5b50\u6811\u5927\u5c0f\u6765\u5e26\u5165\u516c\u5f0f\n\n### \u60f3\u5b8c\u8fd9\u4e9b\uff0c\u5c31\u53ef\u4ee5\u8f7b\u677eAC\u4e86\n\n## \u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn=1000003;\n\nint n,cnt,head[maxn],siz[maxn];\nstruct edge{\n\tint next,to,w;\n}e[maxn<<1];\nlong long ans=0;\n\ninline int read(){\n\tint f=1,x=0;\n\tchar c=getchar();\n\twhile(c<'0'||c>'9'){\n\t\tif(c=='-')f=-1;\n\t\tc=getchar();\n\t}\n\twhile(c>='0'&&c<='9'){\n\t\tx=x*10+c-'0';\n\t\tc=getchar();\n\t}\n\treturn f*x;\n}\n\ninline void add(int u,int v,int w){\n\te[++cnt].next=head[u];\n\te[cnt].to=v;\n\te[cnt].w=w;\n\thead[u]=cnt;\n}\n\nvoid dfs(int now,int fz\uff09{\n\tsiz[now]=1;\n\tfor(int i=head[now];i;i=e[i].next){\n\t\tint v=e[i].to;\n\t\tif(v==fz)continue;\n\t\tdfs(v,now);\n\t\tans+=(long long)abs(n-2*siz[v])*e[i].w;\n\t\tsiz[now]+=siz[v];\n\t}\n}\n\nint main(){\n\tn=read();\n\tfor(int i=1;i<n;i++){\n\t\tint x=read\uff08\uff09;\n\t\tint y=read\uff08\uff09;\n\t\tint z=read\uff08\uff09;\n\t\tadd(x,y,z);\n\t\tadd(y,x,z);\n\t}\n\tdfs(1,1);\n\tcout<<ans;\n\treturn 0;\n}\n```\n\u8bf7\u52ff\u5c1d\u8bd5\u76f4\u63a5\u590d\u5236\u63d0\u4ea4\uff0c\u5426\u5219\u4f60\u4f1a\u6536\u83b7\u4e00\u4e2a\u53ef\u7231\u7684CE",
        "postTime": 1571929790,
        "uid": 85799,
        "name": "wyqwq",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2052 \u3010[NOI2011]\u9053\u8def\u4fee\u5efa \u3011"
    },
    {
        "content": "\u6811\u578b\u7ed3\u6784\uff0cn\u4e2a\u70b9\u4f1a\u6709n-1\u6761\u8fb9\u3002\u6240\u4ee5\u6bcf\u4e00\u6761\u8fb9\u90fd\u662f\u6865emmm\uff08\u6ca1\u4e00\u70b9\u610f\u4e49\uff09\n\u4f46\u662f\u6027\u8d28\u53ca\u5176\u660e\u663e\uff0c\u8fd9\u6761\u8fb9\u4e00\u8fb9\u6709r\u4e2a\u70b9\uff0c\u53e6\u4e00\u8fb9\u5b9a\u6709n-r\u4e2a\u70b9\uff0c\n\uff08\u9898\u76ee\u5ffd\u7565\u4e24\u4e2a\u7aef\u70b9\uff0c\u90fd\u51cf\u4e00\u5373\u53ef\uff0c\u6beb\u65e0\u610f\u4e49\uff09\n\u6240\u4ee5\u5f88\u5bb9\u6613\u5f97\u51fa\n\n\u8fb9\u6743=(long long)abs(size[v]-(n-size[v]))*edge[i].dis\n\n\u81f3\u6b64\u8bc1\u6bd5\n\n\u89e3\u6cd5\u94fe\u5f0f\u524d\u5411\u661f\u6302\u8fb9\uff0c\u7136\u540eDFS\u4e00\u4e0b\u6c42\u6bcf\u4e2a\u70b9\u7684size\uff08\u513f\u5b50\u6570\uff09\uff0c\n\n```\nsize[u]=1\uff1b\nint e,v;\nfor(e=first[u];v=go[e],e;e=next[e]){\n   if(v!=father)dfs(v,father);\n   size[u]+=size[v];\n}\n\n```\n~~\u5269\u4e0b\u7684\u4ee3\u7801\u61d2\u5f97\u5f04\u4e86\u3002~~\n\n\u6c42\u8fb9\u6743\u52a0\u5230dfs\u91cc\u5373\u53ef\uff0c\u5355\u72ec\u62ff\u51fa\u6765for\u4e00\u904d\u5e94\u8be5\u4e5f\u4e0d\u4f1aTLE\u3002\n\n~~\u8fd9\u9898\u597d\u6c34~~\n\n**\u522b\u5fd8\u4e86\u5f00long long\uff01\uff01\uff01\uff01\uff01**",
        "postTime": 1571891991,
        "uid": 158869,
        "name": "\u76e7\u92c5",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2052 \u3010[NOI2011]\u9053\u8def\u4fee\u5efa \u3011"
    },
    {
        "content": "[\u5b89\u5229\u4e00\u6ce2\u535a\u5ba2](https://www.cnblogs.com/cold-cold/p/10029766.html)\n\n\u6bcf\u4e2a\u8fb9\u7684\u5b9e\u9645\u82b1\u8d39\u8d39\u7528\u4e3a\u9053\u8def\u7684\u6743\u4e58\u4ee5\u9053\u8def\u4e24\u7aef\u7684\u56fd\u5bb6\u4e2a\u6570\u4e4b\u5dee\u7684\u7edd\u5bf9\u503c\uff0c\u90a3\u4e48\u5982\u679c\u6211\u4eec\u9884\u5904\u7406\u6bcf\u4e2a\u70b9\u7684\u5b50\u6811\u7684\u5927\u5c0fsiz\n\n\u901a\u8fc7\u6811\u7684\u904d\u5386\u6765\u904d\u5386\u6bcf\u4e00\u6761\u8fb9\uff0c\u56e0\u4e3a\u662f\u4ece\u6211\u4eec\u6c42siz\u65f6\u4f7f\u7528\u7684\u6839\u51fa\u53d1\uff0c\u90a3\u4e48\u5bf9\u4e8eu->v\u7684\u4e00\u6761\u8fb9\uff0cv\u7684\u90a3\u4e00\u5934\u7684\u56fd\u5bb6\u6570\u91cf\u5c31\u662fsiz[v],\u800cu\u7684\u90a3\u4e00\u5934\u7684\u56fd\u5bb6\u6570\u91cf\u5c31\u662fn-siz[v]\n\n\u6211\u4eec\u5c06\u4e24\u4e2a\u6570\u76f8\u51cf\u53d6\u7edd\u5bf9\u503cabs(siz[v]-n+siz[v])\uff0c\u518d\u4e58\u4ee5\u8fb9\u6743\uff0c\u5c31\u662f\u6bcf\u4e2a\u8fb9\u7684\u5b9e\u9645\u82b1\u8d39\u8d39\u7528\n\n\u6ce8\u610f\uff1a\u4e0d\u5f00long long \u4f3c\u4e4e\u8981WA\n\n\u603b\u4f53\u5b9e\u73b0\u5982\u4e0b\uff1a\n\n```cpp\n#include <algorithm>\n#include <iostream>\n#include <cmath>\n#include <cstring>\n#include <map>\n#include <string>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <cstdio>\n#include <cstdlib>\nusing namespace std;\ninline int read()\n{\n    register int p(1),a(0);register char ch=getchar();\n    while((ch<'0'||ch>'9')&&ch!='-') ch=getchar();\n    if(ch=='-') p=-1,ch=getchar();\n    while(ch>='0'&&ch<='9') a=a*10+ch-48,ch=getchar();\n    return a*p;\n}\nconst int N=1000100;\nint n,u,v,w,siz[N],head[N],cnt=0;\nlong long ans=0;\nstruct EDGE{int nxt,val,to;}e[N<<1];\nvoid add(int u,int v,int w){e[++cnt]=(EDGE){head[u],w,v};head[u]=cnt;}\nvoid dfs(int u,int fa)\n{\n\tsiz[u]=1;\n\tfor(int i=head[u],v=e[i].to;i;i=e[i].nxt,v=e[i].to) if(fa!=v)\n\t{\n\t\tdfs(v,u);\n\t\tsiz[u]+=siz[v];\n\t}\n}\nvoid dfs2(int u,int fa)\n{\n\tfor(int i=head[u],v=e[i].to;i;i=e[i].nxt,v=e[i].to) if(fa!=v)\n\t{\n\t\tans+=(abs(siz[v]-n+siz[v])*1ll*e[i].val);\n\t\tdfs2(v,u);\n\t}\n}\nint main()\n{\n//\tfreopen(\"input\",\"r\",stdin);\n//\tfreopen(\"output\",\"w\",stdout);\n\tn=read();\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tu=read(),v=read(),w=read();\n\t\tadd(u,v,w);add(v,u,w);\n\t}\n\tdfs(1,-1);\n\tdfs2(1,-1);\n\tprintf(\"%lld\",ans);\n    return 0;\n}\n```\n",
        "postTime": 1543332183,
        "uid": 48934,
        "name": "cold_cold",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2052 \u3010[NOI2011]\u9053\u8def\u4fee\u5efa \u3011"
    },
    {
        "content": "\u6c34\u9898.......(\u8001\u5e74\u9000\u5f79\u9009\u624b\u53ea\u80fd\u505a\u6c34\u9898\u538b\u538b\u60ca\u3002)\n\n\u5047\u8bbe\u5f53\u524d\u8fb9\u7684\u4e24\u90e8\u5206\u7684\u70b9\u7684\u6570\u91cf\u5206\u522b\u4e3a$x,y$,\u5219\u5f53\u6211\u4eec\u904d\u5386\u7684\u65f6\u5019\n\n$y=size[v],x=n-size[v]$     ($v$\u4e3a\u5f53\u524d\u904d\u5386\u5230\u7684\u513f\u5b50\u8282\u70b9)\n\n\u90a3\u4e48\u6211\u4eec\u5f97\u5230\u7684\u5c31\u662f$|n-2\\times size[v]| \\times w[i]$($w[i]$\u4e3a\u5f53\u524d\u8fb9\u7684\u8fb9\u6743)\n\n\u6ce8\u610f\u8fb9\u6743\u8981\u5f00 $long \\ long$\n\n``\u4ee3\u7801``\n\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#define R register\n#define lo long long\n\nusing namespace std;\n\nconst int gz=1e6+8;\n\ninline void in(R int &x)\n{\n\tR int f=1;x=0;char s=getchar();\n\twhile(!isdigit(s)){if(s=='-')f=-1;s=getchar();}\n\twhile(isdigit(s)){x=x*10+s-'0';s=getchar();}\n\tx*=f;\n}\n\nint head[gz],tot,size[gz],n;\n\nlo ans;\n\nstruct cod{int u,v;lo w;}edge[gz<<1];\n\ninline void add(R int x,R int y,R lo z)\n{\n\tedge[++tot].u=head[x];\n\tedge[tot].v=y;\n\tedge[tot].w=z;\n\thead[x]=tot;\n}\n\nvoid dfs(R int u,R int fa)\n{\n\tsize[u]=1;\n\tfor(R int i=head[u];i;i=edge[i].u)\n\t{\n\t\tif(edge[i].v==fa)continue;\n\t\tdfs(edge[i].v,u);\n\t\tsize[u]+=size[edge[i].v];\n\t\tans+=(lo)(abs(n-2*size[edge[i].v])*edge[i].w);\n\t}\n}\n\nint main()\n{\n\tin(n);\n\tfor(R int i=1,x,y;i<n;i++)\n\t{\n\t\tlo z;\n\t\tin(x),in(y),scanf(\"%lld\",&z);\n\t\tadd(x,y,z),add(y,x,z);\n\t}\n\tdfs(1,0);\n\tprintf(\"%lld\\n\",ans);\n}\n```\n\n",
        "postTime": 1543055033,
        "uid": 87960,
        "name": "\u987ez",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2052 \u3010[NOI2011]\u9053\u8def\u4fee\u5efa \u3011"
    },
    {
        "content": "    \n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#define N 1000005  \n#define ll long long  \nusing namespace std;\nint n;\nlong long ans;\nint cnt=0;//cnt \u4e3a\u8fb9\u6570 \nstruct edge\n{\nint to,len,next;//to \u4e3a\u8d77\u70b9\uff0cnext\u4e3a\u4e0b\u4e00\u4e2a\u70b9\uff0clen \u4e3a\u6743\u503c \n}e[N*2];//\u90bb\u63a5\u8868 \nint size[N],last[N];   \ninline void insert(int u,int v,int len)  \n{  \n    e[++cnt].to=v;\n    e[cnt].len=len;\n    e[cnt].next=last[u];\n    last[u]=cnt; //\u5b58\u5165 \n    e[++cnt].to=u;\n    e[cnt].len=len;\n    e[cnt].next=last[v];\n    last[v]=cnt;  //\u53cc\u5411\u9053\u8def\uff0c\u6b63\u53cd\u5404\u4e00\u904d \n```\n}//\u90bb\u63a5\u8868\u7684\u5b58\u5165\n```cpp\nvoid dfs(int x,int fa)  \n{  \n    size[x]=1;  \n    for (int i=last[x];i;i=e[i].next)  \n    {  \n        if (e[i].to==fa) continue;  \n        dfs(e[i].to,x);  \n        size[x]+=size[e[i].to];  \n        ans+=(ll)e[i].len*abs(n-2*size[e[i].to]);  \n    }  \n}  \nint main()\n{\n    scanf(\"%d\",&n);\n    for(int i=1;i<n;i++)\n    {\n         int u,v,len;  \n        scanf(\"%d%d%d\",&u,&v,&len);\n        insert(u,v,len);  \n    }\n    dfs(1,0);\n    printf(\"%lld\",ans);\n    return 0;\n}\n```",
        "postTime": 1498474465,
        "uid": 45444,
        "name": "zhn_666",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2052 \u3010\u9053\u8def\u4fee\u5efa \u3011"
    },
    {
        "content": "\u8bb2\u7ec6\u4e00\u70b9\u7684\u8bdd\uff0c\u53ef\u4ee5\u53d1\u73b0\uff0c\u6bcf\u6b21\u67e5\u8be2\u7684\u4e24\u4e2a\u70b9\u5fc5\u5b9a\u5728\u6811\u4e0a\u6709\u76f4\u63a5\u70b9\u8fde\u8fb9\u3002\u90a3\u4e48\u5c06\u8fd9\u4e00\u6761\u8fb9\u5220\u53bb\uff0c\u6574\u4e2a\u6811\u5c31\u5206\u6210\u4e24\u4e2a\u96c6\u5408\uff0c\u4e00\u4e2a\u662f\u88ab\u62c6\u7684\u8282\u70b9\u7684\u5b50\u6811\uff0c\u8fd8\u4e00\u4e2a\u96c6\u5408\u5c31\u662f\u53e6\u5916\u7684\u8282\u70b9\uff0c\u7528dfs\u9884\u5904\u7406\u51fa\u6bcf\u4e2a\u8282\u70b9\u7684\u513f\u5b50\u6570\u91cf\u5c31\u884c\u4e86\u3002\n\n\n```cpp\nconst maxn=100010;\nvar ans:int64;\n    i,j,k,l,m,n,tot:longint;\n    size:array[1..maxn]of longint;\n    v:array[1..maxn]of boolean;\n    head,first,depth,next,last,value:array[1..maxn*2]of longint;\nprocedure adds(x,y,val:longint);\nbegin\n    inc(tot);\n    next[tot]:=head[x];\n    head[x]:=tot;\n    last[tot]:=y;\n    first[tot]:=x;\n    value[tot]:=val;\nend;\nprocedure init;\nvar i,x,y,va:longint;\nbegin\n    readln(n);\n    for i:=1 to n-1 do\n    begin\n      readln(x,y,va);\n      adds(x,y,va);\n      adds(y,x,va);\n    end;\n    fillchar(v,sizeof(v),true);\nend;\nprocedure dfs(i,d:longint);\nvar j,k,num:longint;\nbegin\n    v[i]:=false;j:=head[i];size[i]:=1;\n    depth[i]:=d;\n    while j<>0 do\n    begin\n      k:=last[j];\n      if v[k] then\n      begin\n        dfs(k,d+1);\n        inc(size[i],size[k]);\n      end;\n      j:=next[j];\n    end;\nend;\nprocedure swap(var x,y:longint);\nvar k:longint;\nbegin\n    k:=x;x:=y;y:=k;\nend;\nprocedure work;\nvar i,j,k,x,y:longint;\nbegin\n    dfs(1,1);\n    for i:=1 to n-1 do\n    begin\n      j:=i*2;\n      x:=first[j];\n      y:=last[j];\n      if depth[x]<depth[y] then swap(x,y);\n      inc(ans,abs(size[x]-(n-size[x]))*value[j]);\n    end;\n    writeln(ans);\nend;\nbegin\n    init;\n    work;\nend.\n\n```",
        "postTime": 1479122945,
        "uid": 20390,
        "name": "lwhllw",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2052 \u3010\u9053\u8def\u4fee\u5efa \u3011"
    },
    {
        "content": "\u6570\u636e\u7565\u6c34\uff0cdfs\u7248\u672c\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#define LOCAL\n//\u8bb0\u5f97\u52a0\u7b26\u53f7LOCAL \nusing namespace std;\nconst int MAX=1000000;\nint node[MAX+100],to[MAX*2+100],W[MAX*2+100],next[MAX*2+100],p=1;//\u90bb\u63a5\u8868\nint sontree[MAX+100];//\u4ee5\u5404\u8282\u70b9\u4e3a\u6839\u7684\u5b50\u6811\u5927\u5c0f\nint fa[MAX+100];//\u987a\u4fbf\u8bb0\u4e0b\u7236\u4eb2 \nint getint(){\n    char ch = getchar(); int x = 0;\n    while (ch < '0'|| ch > '9') ch = getchar();\n    while (ch >= '0' && ch <= '9') x = x * 10 + ch - 48, ch = getchar();\n    return x;\n```\n}//\u8bfb\u5165\u4f18\u5316\n\nvoid putint(long long x){\n\n    if (x > 9) putint(x / 10);\n\n    putchar(x % 10 + '0');\n\n}//\u8f93\u51fa\u4f18\u5316\n\n\n```cpp\nvoid ins(int a,int b,int c)\n{\n    next[p]=node[a]; node[a]=p; to[p]=b; W[p]=c;\n    p++;\n```\n}//\u52a0\u5165\u4e00\u6761\u8fb9\n\n```cpp\nint getstree(int x,int f)\n{\n    int a=node[x];\n    while(a){\n        if(to[a]!=f){\n            fa[to[a]]=x;\n            sontree[x]+=getstree(to[a],x);\n        }\n        a=next[a];\n    }\n    sontree[x]++;\n    return sontree[x];\n```\n}//\u6c42\u5b50\u6811\u5927\u5c0f\uff08\u987a\u5e26\u8bb0\u7236\u4eb2\uff09\n\n```cpp\nint main()\n{\n    #ifdef LOCAL\n    freopen(\"balance.in\",\"r\",stdin);\n    freopen(\"balance.out\",\"w\",stdout);\n    #endif\n    int n;\n    n=getint();\n    int a,b,c;\n    for(int i=0;i<n-1;i++)\n    {\n        a=getint(); b=getint(); c=getint();\n        ins(a,b,c); ins(b,a,c);\n    }\n    getstree(1,1);\n    long long ans=0;\n    for(int i=1;i<=n;i++)\n    {\n        a=node[i];\n        while(a){\n            if(to[a]!=fa[i]){\n                b=sontree[to[a]];\n                c=n-b;\n                ans+=abs(b-c)*W[a];\n            }\n            a=next[a];\n        }\n    }\n    putint(ans);\n    return 0;\n}\n```",
        "postTime": 1469261954,
        "uid": 7980,
        "name": "\u5927\u8868\u54e5",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2052 \u3010\u9053\u8def\u4fee\u5efa \u3011"
    }
]
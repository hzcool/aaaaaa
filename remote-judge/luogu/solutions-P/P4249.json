[
    {
        "content": "## \u9898\u76ee\u5927\u610f\n\n\u7ade\u8d5b\u56fe\u4e2d\u7684\u90e8\u5206\u8fb9\u65b9\u5411\u5df2\u786e\u5b9a\uff0c\u4f60\u9700\u8981\u51b3\u5b9a\u5269\u4f59\u8fb9\u7684\u65b9\u5411\uff0c\u4f7f\u5f97\u6574\u4e2a\u56fe\u4e0a\u7684\u4e09\u5143\u73af\u6570\u91cf\u6700\u591a\u3002\n\n## \u9898\u89e3\n\n\u4ece\u6574\u4e2a\u56fe\u7684 $n$\u4e2a\u70b9\u4e2d\u4efb\u53d6 $3$\u4e2a\u70b9\uff0c\u65b9\u6848\u6570\u4e3a$$C^{3}_{n}=\\frac{n!}{3!(n-3)!}=\\frac{n(n-1)(n-2)}{6}$$\n\u8003\u8651 $3$\u4e2a\u70b9\u4e0d\u6784\u6210\u4e09\u5143\u73af\u7684\u60c5\u51b5\uff0c\u5fc5\u7136\u4e3a\u4e00\u70b9\u7684\u5165\u5ea6\u4e3a $2$\uff0c\u4e00\u70b9\u7684\u51fa\u5ea6\u4e3a\n $2$\uff0c\u4e00\u70b9\u7684\u5165\u5ea6\u51fa\u5ea6\u4e3a $1$\u3002\u4e0d\u59a8\u4ece\u5165\u5ea6\u5165\u624b\uff0c\u4e00\u4e2a\u70b9\u82e5\u5165\u5ea6\u4e3a $2$\uff0c\u5219\u8868\u660e\u5931\u53bb\u4e86\u4e00\u4e2a\u4e09\u5143\u73af\uff0c\u82e5\u5165\u5ea6\u4e3a $3$\uff0c\u5219\u4f1a\u5931\u53bb $3$\u4e2a\u4e09\u5143\u73af\uff08\u8003\u8651\u70b9 $A$\u88ab\u70b9 $B, C, D$\u901a\u8fc7\u8fb9\u6307\u5411\uff0c\u90a3\u4e48 $(A,B,C), (A,B,D), (A,C,D)$\u90fd\u4e0d\u4f1a\u662f\u4e09\u5143\u73af\uff09\uff0c\u56e0\u6b64\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u70b9 $u$\u800c\u8a00\uff0c\u8bb0\u5176\u5165\u5ea6\u4e3a $degree(u)$\uff0c\u90a3\u4e48\u70b9 $u$\u4f1a\u4f7f\u6574\u5f20\u56fe\u4f1a\u5931\u53bb\n $C^{2}_{degree(u)}$\u4e2a\u4e09\u5143\u73af\u3002\u6545\u5bf9\u4e8e\u6700\u7ec8\u7b54\u6848 $ans$\uff0c\u6709\n$$ans = \\frac{n(n-1)(n-2)}{6} - \\sum_{u \\in V}{C^{2}_{degree(u)}}$$\n\u901a\u8fc7\u4e0a\u8ff0\u8fc7\u7a0b\u5df2\u7ecf\u80fd\u591f\u53d1\u73b0\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u70b9 $u$\uff0c\u8003\u8651\u5dee\u5206\uff0c\u82e5\u5176\u5165\u5ea6\u589e\u52a0 $1$\uff0c\u5219\u4f1a\u4f7f\u6574\u4e2a\u56fe\u5931\u53bb\u7684\u4e09\u5143\u73af\u4e2a\u6570\u4e3a $$C^{2}_{degree(u)} - C^{2}_{degree(u)-1} = degree(u)-1$$\u56e0\u6b64\uff0c\u53ef\u4ee5\u5c06\u5931\u53bb\u7684\u4e09\u5143\u73af\u4f5c\u8d39\u7528\uff0c\u8dd1\u8d39\u7528\u6d41\u3002\n\n\u6211\u4eec\u5bf9\u4e8e\u672a\u5b9a\u5411\u7684\u8fb9\uff0c\u5c06\u5176\u89c6\u4e3a\u70b9\uff08\u4ee5\u4e0b\u79f0\u4f5c\u300c\u8fb9\u5bf9\u5e94\u7684\u70b9\u300d\uff09\uff0c\u5efa\u56fe\u5982\u4e0b\uff1a\n\n$1.$ \u7531\u6e90\u70b9 $s$\u5411\u6bcf\u4e00\u6761\u8fb9\u5bf9\u5e94\u7684\u70b9\u8fde\u8fb9\uff0c\u5bb9\u91cf\u4e3a $1$\uff0c\u8d39\u7528\u4e3a $0$\uff1b\n\n$2.$ \u7531\u6bcf\u4e00\u6761\u8fb9\u5bf9\u5e94\u7684\u70b9\u5411\u8be5\u8fb9\u8fde\u63a5\u7684\u4e24\u4e2a\u56fe\u4e0a\u7ed3\u70b9\u8fde\u8fb9\uff0c\u5bb9\u91cf\u4e3a $1$\uff0c\u8d39\u7528\u4e3a\n $0$\uff0c\u8868\u660e\u8be5\u6761\u8fb9\u53ea\u4f1a\u4f7f\u5f97\u5176\u4e2d\u4e00\u4e2a\u70b9\u5165\u5ea6 $+1$\uff1b\n\n$3.$ \u7531\u6bcf\u4e00\u4e2a\u56fe\u4e0a\u7ed3\u70b9\u5411\u6c47\u70b9 $t$\u8fde\u82e5\u5e72\u6761\u8fb9\uff0c\u8d39\u7528\u4f9d\u6b21\u4e3a $0, 1, 2, 3......$\uff08\u5206\u522b\u8868\u793a\u8be5\u70b9\u5165\u5ea6\u4ece $0$\u5f00\u59cb\u6bcf\u589e\u52a0 $1$\u5c31\u4f1a\u5931\u53bb\u7684\u4e09\u5143\u73af\u6570\u91cf\uff09\uff0c\u5bb9\u91cf\u5747\u4e3a $1$\uff08\u6ce8\u610f\u521d\u59cb\u56fe\u7684\u5904\u7406\uff0c\u5373\u67d0\u4e9b\u70b9\u521d\u59cb\u5165\u5ea6\u4e0d\u4e3a $0$\uff09\u3002\n\n\u6700\u540e\u7684\u8f93\u51fa\u65b9\u6848\uff0c\u5bf9\u4e8e\u672a\u5b9a\u5411\u8fb9\uff0c\u53ea\u9700\u770b\u8d39\u7528\u6d41\u7684\u56fe\u4e2d\uff0c\u8fb9\u5bf9\u5e94\u7684\u70b9\u6307\u5411\u7684\u4e24\u4e2a\u56fe\u4e0a\u7ed3\u70b9\u7684\u8fb9\u4e2d\u54ea\u4e00\u6761\u6ee1\u6d41\u5373\u53ef\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <vector>\n#include <queue>\nusing namespace std;\n\nconst int maxn = 5150 + 10;\nconst int maxg = 100 + 10;\nconst int INF = 1000000000;\n\nint n;\nint s, t;\nint rel[maxg][maxg];\nint wedge[maxg][maxg];\nint indeg[maxn];\n\nint edgeidx(int x, int y) {\n  return (2*n-x) * (x-1) / 2 + (y-x) + n;\n}\n\nstruct Edge {\n  int from, to, cap, flow, cost;\n  Edge(int from, int to, int cap, int flow, int cost):\n    from(from), to(to), cap(cap), flow(flow), cost(cost) {}\n};\n\ntemplate <int maxn> struct MCMF {\n  int n, m, s, t;\n  vector <Edge> edges;\n  vector <int> G[maxn];\n  int inq[maxn];\n  int d[maxn];\n  int p[maxn];\n  int a[maxn];\n\n  void init(int n) {\n    this->n = n;\n    for(int i = 0; i < n; i++) G[i].clear();\n    edges.clear();\n  }\n\n  void AddEdge(int from, int to, int cap, int cost) {\n    edges.push_back(Edge(from, to, cap, 0, cost));\n    edges.push_back(Edge(to, from, 0, 0, -cost));\n    m = edges.size();\n    G[from].push_back(m-2);\n    G[to].push_back(m-1);\n  }\n\n  bool BellmanFord(int s, int t, int& cost) {\n    for(int i = 0; i < n; i++) d[i] = INF;\n    memset(inq, 0, sizeof(inq));\n    d[s] = 0; inq[s] = 1; p[s] = 0; a[s] = INF;\n  \n    queue <int> Q;\n    Q.push(s);\n    while(!Q.empty()) {\n      int u = Q.front(); Q.pop();\n      inq[u] = 0;\n      for(int i = 0; i < G[u].size(); i++) {\n        Edge& e = edges[G[u][i]];\n        if(e.cap > e.flow && d[e.to] > d[u] + e.cost) {\n          d[e.to] = d[u] + e.cost;\n          p[e.to] = G[u][i];\n          a[e.to] = min(a[u], e.cap - e.flow);\n          if(!inq[e.to]) { Q.push(e.to); inq[e.to] = 1; }\n        }\n      }\n    }\n    if(d[t] == INF) return false;\n    cost += d[t] * a[t];\n    int u = t;\n    while(u != s) {\n      edges[p[u]].flow += a[t];\n      edges[p[u]^1].flow -= a[t];\n      u = edges[p[u]].from;      \n    }\n    return true;\n  }\n\n  int Mincost(int s, int t) {\n    int cost = 0;\n    while(BellmanFord(s, t, cost));\n    return cost;\n  }\n};\n  \nMCMF <maxn> solver;\n  \nint main() {\n  scanf(\"%d\", &n);\n  s = 0; t = (n+1)*n/2 + n + 1;\n  solver.init(t+1);\n  for(int i = 1; i <= n; i++)\n    for(int j = 1; j <= n; j++) {\n      scanf(\"%d\", &rel[i][j]);\n      if(rel[i][j] == 1) indeg[j]++;\n    }\n\n  for(int i = 1; i <= n; i++)\n    for(int j = i+1; j <= n; j++) {\n      if(rel[i][j] < 2) continue;\n      solver.AddEdge(s, edgeidx(i, j), 1, 0);\n      solver.AddEdge(edgeidx(i, j), i, 1, 0);\n      wedge[j][i] = solver.m - 2;\n      solver.AddEdge(edgeidx(i, j), j, 1, 0);\n      wedge[i][j] = solver.m - 2;\n    }\n\n  int down = 0;\n  for(int i = 1; i <= n; i++) {\n    down += indeg[i] * (indeg[i]-1) / 2;\n    for(int j = indeg[i] + 1; j < n; j++)\n      solver.AddEdge(i, t, 1, j-1);\n  }\n\n  down += solver.Mincost(s, t);\n\n  printf(\"%d\\n\", n*(n-1)*(n-2) / 6 - down);\n\n  for(int i = 1; i <= n; i++) {\n    for(int j = 1; j <= n; j++) {\n      if(rel[i][j] < 2) printf(\"%d\", rel[i][j]);\n      else printf(\"%d\", solver.edges[wedge[i][j]].flow);\n      if(j < n) printf(\" \");\n    }\n    printf(\"\\n\");\n  }\n\n  return 0;\n}\n```",
        "postTime": 1520343412,
        "uid": 50167,
        "name": "Imagine",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4249 \u3010[WC2007]\u526a\u5200\u77f3\u5934\u5e03\u3011"
    },
    {
        "content": "\u4e00\u53e5\u8bdd\u9898\u610f\uff1a\u7ed9\u5b9a\u4e00\u5f20\u56fe\uff0c\u6bcf\u4e24\u70b9\u4e4b\u95f4\u6709\u4e00\u6761\u6709\u5411\u8fb9\u6216\u65e0\u5411\u8fb9\uff0c\u628a\u6240\u6709\u65e0\u5411\u8fb9\u5b9a\u5411\uff0c\u4f7f\u56fe\u4e2d\u4e09\u5143\u73af\u4e2a\u6570\u5c3d\u91cf\u591a\n\n\u56e0\u4e3a\u539f\u56fe\u662f\u4e00\u4e2a\u5b8c\u5168\u56fe\uff0c\u5047\u8bbe\u56fe\u4e2d\u4efb\u610f\u4e09\u70b9\u90fd\u80fd\u6784\u6210\u4e09\u5143\u73af\uff0c\u90a3\u4e48\u9014\u4e2d\u4e09\u5143\u73af\u7684\u4e2a\u6570\u4e3a\uff1a$\\binom{n}{3}$\u3002\n\n\u90a3\u4e48\u5982\u679c\u4e00\u4e2a\u4e09\u5143\u7ec4\u4e0d\u662f\u4e09\u5143\u73af\uff0c\u90a3\u4e48\u6709\u4e00\u4e2a\u70b9\u7684\u51fa\u5ea6\u4e3a2\u3002\n\n\u6211\u4eec\u5047\u8bbe\u4e00\u4e2a\u70b9\u7684\u51fa\u5ea6\u4e3ad\uff0c\u90a3\u4e48\u5bf9\u4e8e\u8fd9\u4e2a\u70b9\uff0c\u4e09\u5143\u73af\u4f1a\u51cf\u5c11$\\frac{d (d-1)}{2}$\n\n\u6240\u4ee5\u4e09\u5143\u73af\u7684\u6570\u91cf\u4e3a\uff1a$\\binom{n}{3}- \\sum_{i=1}^n\\binom{d[i]}{2}=\\binom{n}{3}- \\sum_{i=1}^n\\frac{d[i] (d[i]-1)}{2}$\n\n\u6240\u4ee5\u6211\u4eec\u8981\u6700\u5c0f\u5316\uff1a$ \\sum_{i=1}^n\\frac{d[i] (d[i]-1)}{2}$\u7684\u503c\u3002\n\n\u600e\u4e48\u505a\u5462\uff1f\n\n\u5982\u679c\u6211\u4eec\u5bf9\u4e8e\u4e00\u6761\u65e0\u5411\u8fb9\uff0c\u53ef\u80fd\u8ba9u\u51fa\u5ea6+1\uff0c\u4e5f\u53ef\u80fd\u8ba9v\u51fa\u5ea6+1\uff0c\u975e\u9ed1\u5373\u767d\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u8d39\u7528\u6d41\u3002\n\n\u89c2\u5bdf\u67ff\u5b50$\\frac{d[i] (d[i]-1)}{2}$\uff0c\u5bb9(hen)\u6613(nan)\u60f3\u5230\u5c0f\u5b66\u7b49\u5dee\u6570\u5217\u6c42\u548c\u516c\u5f0f\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5c06\u4e00\u4e2a\u70b9\u7684\u8d21\u732e\u770b\u6210$(0+1+2+3+\u2026\u2026+d[i]-1)$\n\n\u628a\u6bcf\u4e00\u6761\u8fb9\u770b\u6210\u4e00\u4e2a\u70b9\uff0c\u4ece\u6e90\u70b9\u5411\u6bcf\u6761\u8fb9\u8fde\u4e00\u6761\u5bb9\u91cf\u4e3a1\uff0c\u8d39\u7528\u4e3a0\u7684\u8fb9\u3002\n\n\u5bf9\u4e8e\u4e00\u6761\u65e0\u5411\u8fb9\uff0c\u5f80u\uff0cv\u5206\u522b\u5efa\u4e00\u6761\u5bb9\u91cf\u4e3a1\uff0c\u8d39\u7528\u4e3a0\u7684\u8fb9\u3002\n\n\u6709\u5411\u8fb9\u5219\u628a\u8fb9\u548cv\u5efa\u4e00\u6761\u5bb9\u91cf\u4e3a1\uff0c\u8d39\u7528\u4e3a0\u7684\u8fb9\u3002\n\n\u6bcf\u4e2a\u70b9\u5411\u6c47\u70b9\u8fden\u6761\u5bb9\u91cf\u4e3a1\uff0c\u8d39\u7528\u4e3a0-(n-1)\u9012\u589e\u7684\u8fb9\uff0c\u8868\u793a\u4e0a\u9762\u7684\u7b49\u5dee\u6570\u5217\uff08\u53ef\u4ee5\u8868\u793a\u51fa\u4efb\u4f55\u51fa\u5ea6\u7684\u60c5\u51b5\uff09\n\n\u6700\u540e\u5c31\u662f\u8d39\u7528\u6d41\u7684\u677f\u5b50\u4e86\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define il inline\n#define re register\n#define inf 123456789\n#define debug printf(\"Now is Line : %d\\n\",__LINE__)\nil int read()\n{\n    re int x=0,f=1; re char c=getchar();\n    while(c<'0'||c>'9') {if(c=='-') f=-1;c=getchar();}\n    while(c>='0'&&c<='9') x=x*10+c-48,c=getchar();\n    return x*f;\n}\n#define maxn 105\n#define maxm 105*105\nstruct edge\n{\n    int v,w,val,next;\n}e[maxm<<3];\nint n,a[maxn][maxn],S,T,maxflow,cost,vis[maxm],dis[maxm],head[maxm],cnt=1,pa;\nil void add(int u,int v,int val,int w)\n{\n    e[++cnt]=(edge){v,w,val,head[u]};\n    head[u]=cnt;\n    e[++cnt]=(edge){u,-w,0,head[v]};\n    head[v]=cnt;\n}\nqueue<int>q;\nil bool spfa()\n{\n    memset(vis,0,sizeof(vis));\n    memset(dis,127,sizeof(dis));\n    dis[S]=0; q.push(S);\n    while(!q.empty())\n    {\n        int u=q.front();\n        q.pop();\n        vis[u]=0;\n        for(re int i=head[u];i;i=e[i].next)\n        {\n            int v=e[i].v;\n            if(dis[v]>dis[u]+e[i].w&&e[i].val>0)\n            {\n                dis[v]=dis[u]+e[i].w;\n                if(!vis[v])\n                {\n                    vis[v]=1;\n                    q.push(v);\n                }\n            }\n        }\n    }\n    return dis[T]!=2139062143;\n}\nil int dfs(int u,int mi)\n{\n    if(u==T)\n    {\n        vis[T]=1;\n        return mi;\n    }\n    vis[u]=1;\n    int use=0;\n    for(re int i=head[u];i;i=e[i].next)\n    {\n        int v=e[i].v;\n        if((!vis[v]||v==T)&&e[i].val>0&&dis[v]==dis[u]+e[i].w)\n        {\n            int low=dfs(v,min(mi-use,e[i].val));\n            if(low>0)\n            {\n                cost+=low*e[i].w;\n                e[i].val-=low; e[i^1].val+=low;\n                use+=low;\n            }\n        }\n    }\n    return use;\n}\nil void dinic()\n{\n    while(spfa())\n    {\n        vis[T]=1;\n        while(vis[T])\n        {\n            memset(vis,0,sizeof(vis));\n            dfs(S,inf);\n        }\n    }\n    int ans=((n-1)*(n-2)*n)/6;\n    ans-=cost;\n    printf(\"%d\\n\",ans);\n}\nint main()\n{\n    n=read(); T=n*n+n+1;\n    for(re int i=1;i<=n;++i)\n    {\n        for(re int j=1;j<=n;++j)\n        {\n            a[i][j]=read();\n            if(i>=j) continue;\n            if(a[i][j]==2)\n            {\n                add(S,(i-1)*n+j,1,0);\n                add((i-1)*n+j,n*n+i,1,0);\n                add((i-1)*n+j,n*n+j,1,0);\n            }\n            else if(a[i][j]==1) add(S,n*n+j,1,0);\n            else add(S,n*n+i,1,0);\n        }\n    }\n    for(re int i=1;i<=n;++i)\n    {\n        for(re int j=0;j<n;++j) add(n*n+i,T,1,j);\n    }\n    dinic();\n    for(re int i=1;i<=n;++i)\n    {\n        for(re int j=i+1;j<=n;++j)\n        {\n            if(a[i][j]<2) continue;\n            for(re int k=head[(i-1)*n+j];k;k=e[k].next)\n            {\n                if(e[k].v&&e[k].val==0)\n                {\n                    a[i][j]=(e[k].v-n*n==j);\n                    a[j][i]=a[i][j]^1;\n                }\n            }\n        }\n    }\n    for(re int i=1;i<=n;++i,puts(\"\"))\n    {\n        for(re int j=1;j<=n;++j) printf(\"%d \",a[i][j]);\n    }\n    return 0;\n}\n```",
        "postTime": 1548684087,
        "uid": 57014,
        "name": "Nemlit",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4249 \u3010[WC2007]\u526a\u5200\u77f3\u5934\u5e03\u3011"
    },
    {
        "content": "## \u8fd9\u662f\u4e00\u7bc7\u6a21\u62df\u9000\u706b\u7684\u9898\u89e3\n\n\u524d\u7f6e\u77e5\u8bc6\uff1a[\u6a21\u62df\u9000\u706b](https://oi-wiki.org/misc/simulated-annealing/)\n\n\u9898\u76ee\u4e2d\u77e9\u9635\u91cc\u5143\u7d20 $2$ \u53ef\u4ee5\u81ea\u884c\u5339\u914d\u3002\u53ef\u4ee5\u5bf9\u6bcf\u4e00\u79cd\u5408\u6cd5\u7684\u77e9\u9635\u6c42\u5f97\u4e09\u5143\u7ec4\u6570\u91cf\uff0c\u6545\u8003\u8651\u6a21\u62df\u9000\u706b\u3002\n\n\u5bf9\u4e8e\u6a21\u62df\u9000\u706b\u4e2d\u6c42\u5f53\u524d\u7b54\u6848\u64cd\u4f5c\uff08\u540e\u6587\u5c06\u5176\u79f0\u4e3a $check$\uff09\uff0c\u4f9d\u636e\u9898\u610f\u53ef\u4ee5\u76f4\u63a5\u6a21\u62df\u5f97\n\n```cpp\nint answer()\n{\n\tint all=0;\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tfor(int j=i+1;j<=n;++j)\n\t\t{\n\t\t\tfor(int k=j+1;k<=n;++k)\n\t\t\t{\n\t\t\t\tif(a[i][j]==1&&a[j][k]==1&&a[k][i]==1)++all;\n\t\t\t\telse if(a[i][j]==0&&a[j][k]==0&&a[k][i]==0)++all;\n\t\t\t}\n\t\t}\n\t}\n\treturn all;\n}\n```\n\n\u6bcf\u4e00\u6b21 $check$ \u90fd\u9700\u8981 $n^3$ \u7684\u65f6\u95f4\uff0c\u5bf9\u4e8e $N\\leq100$ \u7684\u8303\u56f4\u6709\u4e9b\u5403\u4e0d\u6d88\uff0c\u8003\u8651\u4f18\u5316\u3002\n\n\u5728\u672c\u9898\u4e2d\uff0c\u77e9\u9635\u4e2d\u4e24\u4e2a\u76f8\u4e92\u5bf9\u5e94\u7684 $2$ \u53ef\u4ee5\u770b\u505a $(0,1)$ \u6216 $(1,0)$ \u7684\u8f6c\u6362\u3002\u5bf9\u4e8e\u4e09\u5143\u7ec4\uff0c\u4e0d\u9700\u8981\u6bcf\u6b21\u904d\u5386\u6574\u4e2a\u77e9\u9635\u627e\u7b54\u6848\uff0c\u53ea\u9700\u8981\u5bf9\u6bd4\u77e9\u9635\u66f4\u6539\u524d\u540e\u6d88\u5931\u4e0e\u589e\u52a0\u7684\u4e09\u5143\u7ec4\u6570\u91cf\u5373\u53ef\u3002\n\n\u679a\u4e3e $n$ \u4e2a\u5143\u7d20\u67e5\u627e\u4e09\u5143\u7ec4\u6570\u91cf\u53d8\u5316\uff0c$check$ \u65f6\u95f4\u590d\u6742\u5ea6\u964d\u4e3a $O(n)$\u3002\n\n```cpp\nint from,to;\nint check()\n{\n\tfrom=0;to=0;\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tif(a[px][py]){if(a[py][i]==1&&a[i][px]==1)++to;}\n\t\telse {if(a[px][i]==1&&a[i][py]==1)++to;}\n\t}\n\tswap(a[px][py],a[py][px]);\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tif(a[px][py]){if(a[py][i]==1&&a[i][px]==1)++from;}\n\t\telse {if(a[px][i]==1&&a[i][py]==1)++from;}\n\t}\n\tswap(a[px][py],a[py][px]);\n\treturn to-from;\n}\n```\n\n\u7531\u4e8e $check$ \u64cd\u4f5c\u65f6\u95f4\u590d\u6742\u5ea6\u4e0d\u9ad8\uff0c\u53ef\u4ee5\u9002\u5f53\u964d\u4f4e $eps$ \u5e76\u63d0\u9ad8 $\\Delta t$ \u4ee5\u63d0\u9ad8\u5355\u6b21\u9000\u706b\u64cd\u4f5c\u51c6\u786e\u6027\u3002\u6211\u7684 $eps$ \u5f00\u5230\u4e86 $1e-19$\uff0c$\\Delta t$ \u5f00\u5230\u4e86 $0.9998$ \u624d\u6210\u529f AC\uff0c\u8fd9\u9053\u9898\u6570\u636e\u9700\u8981\u8fd9\u4e48\u6781\u7aef\u53ef\u80fd\u662f\u56e0\u4e3a\u5355\u6b21\u77e9\u9635\u53d8\u6362\u5e26\u6765\u7684\u7b54\u6848\u53d8\u5316\u4e0d\u5927\u3002\n\n\u6700\u540e\u8bf4\u4e00\u4e0b\u6a21\u62df\u9000\u706b\u4e0d\u8981\u9677\u5165 $check$ \u64cd\u4f5c\u5fc5\u987b\u6574\u4f53\u6c42\u7b54\u6848\u7684\u601d\u7ef4\u8bef\u533a\u3002\u6709\u7684\u65f6\u5019\u9000\u706b\u5f53\u524d\u7b54\u6848\u662f\u53ef\u4ee5\u4ece\u6700\u4f18\u7b54\u6848\u4e2d\u63a8\u51fa\u6765\u7684\u3002~~\u6211\u5728\u6a21\u62df\u8d5b\u65f6\u5c31\u72af\u4e86\u8fd9\u4e2a\u9519\u8bef\u53ea\u60f3\u5230\u4e86 $O(n^3)$ \u7684 $check$\uff0c\u53ea\u62ff\u5230\u4e86 $30$ \u5206\u7684\u90e8\u5206\u5206\u3002\u95ee\u4e86\u5927\u4f6c\u624d\u77e5\u9053\u8fd8\u80fd\u8fd9\u4e48\u5199\uff0c\u771f\u662f\u53d7\u76ca\u532a\u6d45\u3002~~\n\n\u4f18\u5316 $check$ \u64cd\u4f5c\u65f6\u95f4\u590d\u6742\u5ea6\u4ee5\u63d0\u9ad8\u9000\u706b\u51c6\u786e\u6027\u80fd\u66f4\u597d\u7684\u62ff\u9ad8\u5206\u3002\n\n\u6700\u540e\u9644\u4e0a\u5b8c\u6574\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define debug printf(\"ssf_nimaWRZontop\\n\")\n#define DEBUG printf(\"bowdowntotheWRZ\\n\")\n#define double long double\nusing namespace std;\nconst int inf=0x3f3f3f3f;\nconst double eps=1e-19;\nconst int N=105;\nint n,a[N][N],ans,now,deltanow;\nstruct gets{\n\tint x,y;\n}e[N*N];int cnt;\nint px,py;\nint answer()\n{\n\tint all=0;\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tfor(int j=i+1;j<=n;++j)\n\t\t{\n\t\t\tfor(int k=j+1;k<=n;++k)\n\t\t\t{\n\t\t\t\tif(a[i][j]==1&&a[j][k]==1&&a[k][i]==1)++all;\n\t\t\t\telse if(a[i][j]==0&&a[j][k]==0&&a[k][i]==0)++all;\n\t\t\t}\n\t\t}\n\t}\n\treturn all;\n}\nint from,to;\nint check()\n{\n\tfrom=0;to=0;\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tif(a[px][py]){if(a[py][i]==1&&a[i][px]==1)++to;}\n\t\telse {if(a[px][i]==1&&a[i][py]==1)++to;}\n\t}\n\tswap(a[px][py],a[py][px]);\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tif(a[px][py]){if(a[py][i]==1&&a[i][px]==1)++from;}\n\t\telse {if(a[px][i]==1&&a[i][py]==1)++from;}\n\t}\n\tswap(a[px][py],a[py][px]);\n\treturn to-from;\n}\ndouble temp=5000,delta=0.9998;\nvoid sa()\n{\n\twhile(temp>eps)\n\t{\n\t\tint x=rand()%cnt+1;\n\t\tpx=e[x].x;\n\t\tpy=e[x].y;\n\t\tswap(a[px][py],a[py][px]);\n\t\tdeltanow=check();\n\t\t\n\t\tif(deltanow>0)now+=deltanow,ans=max(ans,now);\n\t\telse if(exp(deltanow/temp)*(double)RAND_MAX<(double)rand())swap(a[px][py],a[py][px]);\n\t\telse now+=deltanow;\n\t\ttemp*=delta;\n\t}\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;++i)\n\t\tfor(int j=1;j<=n;++j)\n\t\t\tscanf(\"%d\",&a[i][j]);\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tfor(int j=i+1;j<=n;++j)\n\t\t{\n\t\t\tif(a[i][j]==2)\n\t\t\t{\n\t\t\t\te[++cnt].x=i;\n\t\t\t\te[cnt].y=j;\n\t\t\t\ta[i][j]=1;\n\t\t\t}\n\t\t}\n\t\tfor(int j=1;j<i;++j)if(a[i][j]==2)a[i][j]=0;\n\t}\n\tnow=ans=answer();\n\twhile(1)\n    {\n        if(clock()*1.0/CLOCKS_PER_SEC*1000>990)break;\n        sa();\n    }\n    printf(\"%d\\n\",ans);\n    for(int i=1;i<=n;++i)\n    {\n    \tfor(int j=1;j<=n;++j)printf(\"%d \",a[i][j]);\n    \tprintf(\"\\n\");\n\t}\n    return 0;\n}\n//freopen(\"wrz.in\",\"r\",stdin);\n//freopen(\"wrz.out\",\"w\",stdout);\n```\n",
        "postTime": 1668260593,
        "uid": 306610,
        "name": "TryToThink",
        "ccfLevel": 5,
        "title": "P4249 [WC2007]\u526a\u5200\u77f3\u5934\u5e03"
    },
    {
        "content": "~~[\u5e7f\u544a](https://www.cnblogs.com/hbyer/p/10464216.html)~~\n\n\u8003\u8651\u8865\u96c6\u8f6c\u5316\uff0c\u6ee1\u8db3\u6761\u4ef6\u7684\u4e0d\u597d\u6c42\uff0c\u90a3\u5c31\u6c42\u4e0d\u6ee1\u8db3\u6761\u4ef6\u7684\u3002\n\n\u8bbe\u7b2c$i$\u4e2a\u4eba\u8d62\u4e86$val_i$\u6b21\uff0c\u90a3\u4e48\u4e0d\u6ee1\u8db3\u6761\u4ef6\u7684\u4e09\u5143\u7ec4\u4e2a\u6570\u5c31\u662f\uff1a\n\n$\\sum_{i=1}^{n}\\binom{val_i}{2}=\\sum_{i=1}^{n}val_i(val_i-1)/2$\n\n\u8003\u8651\u7f51\u7edc\u6d41\u5efa\u56fe\uff1a\n\n- \u5bf9\u4e8e\u6bcf\u4e2a\u4eba\uff0c\u5efa\u51fa\u4e00\u4e2a$A_i$\u8868\u793a\u8fd9\u4e2a\u4eba\uff0c\u7136\u540e$A_i$\u5411\u6c47\u70b9$t$\u8fde\u8fb9\uff0c\u5bb9\u91cf\u4e3a$n$\u3002\n- \u5bf9\u4e8e\u6bcf\u573a\u4e0d\u786e\u5b9a\u7684\u6bd4\u8d5b$(x,y)$\uff0c\u5efa\u51fa$B_i$\u8868\u793a\u8fd9\u573a\u6bd4\u8d5b\uff0c\u6e90\u70b9$s$\u5411$B_i$\u8fde\u8fb9\uff0c$B_i$\u5411$x,y$\u8fde\u8fb9\uff0c\u5bb9\u91cf\u5747\u4e3a$1$\u3002\n\n\u90a3\u4e48\u8fd9\u4e2a\u56fe\u7684\u6bcf\u79cd\u6700\u5927\u6d41\u90fd\u8868\u793a\u4e00\u79cd\u53ef\u884c\u7684\u65b9\u6848\u3002\n\n\u73b0\u5728\u6211\u4eec\u7684\u76ee\u7684\u5c31\u662f\u7ed9\u8fd9\u4e2a\u56fe\u52a0\u4e0a\u8d39\u7528\uff0c\u4f7f\u5f97\u8d39\u7528\u6700\u5c0f\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e\u70b9$A_i$\uff0c\u82e5\u6d41\u5411$t$\u7684\u6d41\u91cf\u4e3a$x$\uff0c\u8d39\u7528\u5c31\u662f$x(x-1)/2$\uff0c\u4f46\u662f\u8fd9\u91cc\u662f\u4e00\u4e2a\u4e8c\u6b21\u7684\u589e\u957f\uff0c\u4e00\u822c\u7684\u5efa\u56fe\u5c31\u505a\u4e0d\u4e86\u4e86\u3002\n\n\u53ef\u4ee5\u8003\u8651\u628a\u8fd9\u6761\u8fb9\u62c6\u6210$n$\u6761\uff0c\u6bcf\u6761\u5bb9\u91cf\u4e3a$1$\uff0c\u8d39\u7528\u4f9d\u6b21\u9012\u589e\uff0c\u5373\u8d39\u7528\u4e3a$0,1,2,...,n-1$\uff0c\u90a3\u4e48\u53ef\u4ee5\u53d1\u73b0\uff0c\u7531\u4e8e\u8d39\u7528\u6d41\u6bcf\u6b21\u589e\u5e7f\u90fd\u4f1a\u9009\u62e9\u6700\u5c0f\u7684\u90a3\u6761\u8fb9\uff0c\u6240\u4ee5\u6d41\u91cf\u4e3a$x$\u65f6\u8d39\u7528\u4e3a$x(x-1)/2$\uff0c\u5373\u6ee1\u8db3\u6761\u4ef6\u3002\n\n\u7136\u540e\u5efa\u5b8c\u56fe\u8dd1\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\uff0c\u7136\u540e\u62ff\u603b\u65b9\u6848\u51cf\u4e00\u4e0b\u5c31\u597d\u4e86\u3002\n\n\u8f93\u51fa\u65b9\u6848\u968f\u4fbf\u679a\u4e3e\u4e00\u4e0b\u54ea\u6761\u8fb9\u6d41\u6ee1\u4e86\u5c31\u597d\u4e86\u3002\n\n```c++\n#include<bits/stdc++.h>\nusing namespace std;\n \nvoid read(int &x) {\n    x=0;int f=1;char ch=getchar();\n    for(;!isdigit(ch);ch=getchar()) if(ch=='-') f=-f;\n    for(;isdigit(ch);ch=getchar()) x=x*10+ch-'0';x*=f;\n}\n \nvoid print(int x) {\n    if(x<0) putchar('-'),x=-x;\n    if(!x) return ;print(x/10),putchar(x%10+48);\n}\nvoid write(int x) {if(!x) putchar('0');else print(x);putchar('\\n');}\n\nconst int maxn = 2e5+10;\nconst int inf = 1e9;\n\nint n,s,t,tot=1,cnt,cost;\nint head[maxn],vis[maxn],dis[maxn],val[maxn],mp[102][102];\nstruct edge{int to,nxt,w,c;}e[maxn];\n\nvoid add(int u,int v,int w,int c) {e[++tot]=(edge){v,head[u],w,c},head[u]=tot;}\nvoid ins(int u,int v,int w,int c) {add(u,v,w,c),add(v,u,0,-c);}\n\nint bfs() {\n\tmemset(dis,63,(t+1)*4);\n\tmemset(vis,0,(t+1)*4);\n\tqueue<int > q;q.push(s),dis[s]=0,vis[s]=1;\n\twhile(!q.empty()) {\n\t\tint now=q.front();q.pop();vis[now]=0;\n\t\tfor(int i=head[now];i;i=e[i].nxt)\n\t\t\tif(e[i].w>0&&dis[e[i].to]>dis[now]+e[i].c) {\n\t\t\t\tdis[e[i].to]=dis[now]+e[i].c;\n\t\t\t\tif(!vis[e[i].to]) vis[e[i].to]=1,q.push(e[i].to);\n\t\t\t}\n\t}\n\treturn dis[t]<inf;\n}\n\nint dfs(int x,int f) {\n\tvis[x]=1;\n\tif(x==t) return cost+=f*dis[t],f;\n\tint used=0;\n\tfor(int i=head[x];i;i=e[i].nxt)\n\t\tif((e[i].to==t||!vis[e[i].to])&&e[i].w>0&&dis[e[i].to]==dis[x]+e[i].c) {\n\t\t\tint d=dfs(e[i].to,min(f-used,e[i].w));\n\t\t\tif(d>0) e[i].w-=d,e[i^1].w+=d,used+=d;\n\t\t\tif(used==f) break;\n\t\t}\n\treturn used;\n}\n\nint mcmf() {\n\tcost=0;\n\twhile(bfs()) dfs(s,inf);\n\treturn cost;\n}\n\nint tmp[5],top,mark;\n\nint main() {\n\tread(n);s=n*n+1,t=s+1;cnt=n;\n\tint ans=n*(n-1)*(n-2)/6;\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1,x;j<=n;j++) {\n\t\t\tread(x);mp[i][j]=x;\n\t\t\tif(j>i) {\n\t\t\t\tif(x==1) val[i]++;\n\t\t\t\telse if(x==0) val[j]++;\n\t\t\t\telse ins(s,++cnt,1,0),ins(cnt,i,1,0),ins(cnt,j,1,0);\n\t\t\t}\n\t\t}\n\tfor(int i=1;i<=n;i++) \n\t\tfor(int j=val[i];j<=n;j++) ins(i,t,1,j);\n\tfor(int i=1;i<=n;i++) ans-=val[i]*(val[i]-1)/2;\n\twrite(ans-mcmf());\n\tfor(int x=n+1;x<=cnt;x++) {\n\t\ttop=-1;\n\t\tfor(int i=head[x];i;i=e[i].nxt)\n\t\t\tif(e[i].to!=s) {\n\t\t\t\ttmp[++top]=e[i].to;\n\t\t\t\tif(e[i].w==0) mark=top;\n\t\t\t}\n\t\tmp[tmp[mark]][tmp[mark^1]]=1;\n\t\tmp[tmp[mark^1]][tmp[mark]]=0;\n\t}\n\tfor(int i=1;i<=n;i++,puts(\"\")) for(int j=1;j<=n;j++) printf(\"%d \",mp[i][j]);\n\treturn 0;\n}\n```",
        "postTime": 1551580311,
        "uid": 50777,
        "name": "Hyscere",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4249 \u3010[WC2007]\u526a\u5200\u77f3\u5934\u5e03\u3011"
    },
    {
        "content": "### \u9898\u76ee\u5927\u610f\n\n[P4249 [WC2007]\u526a\u5200\u77f3\u5934\u5e03](https://www.luogu.com.cn/problem/P4249)\n\n\n\u7ed9\u51fa\u4e00\u4e2a\u56fe\uff0c\u56fe\u4e2d\u6709\u4e9b\u8fb9\u7684\u65b9\u5411\u6ca1\u6709\u786e\u5b9a\uff0c\u6709\u4e9b\u65b9\u5411\u7ed9\u5b9a\uff0c\u8981\u6c42\u4f60\u5b9a\u4e0b\u4e0d\u786e\u5b9a\u8fb9\u7684\u65b9\u5411\uff0c\u4f7f\u5f97\u56fe\u4e2d\u7684\u4e09\u5143\u73af\u6700\u591a\u3002\n\n### \u95ee\u9898\u6c42\u89e3\n\n\u5bf9\u4e8e\u4e09\u5143\u73af\u7684\u4e2a\u6570\uff0c\u6211\u4eec\u76f4\u63a5\u6c42\u89e3\u975e\u5e38\u56f0\u96be\uff0c\u6240\u4ee5\u8003\u8651\u8865\u96c6\uff0c\u7528\u603b\u7684\u4e2a\u6570\u51cf\u53bb\u4e0d\u80fd\u6784\u6210\u4e09\u5143\u73af\u7684\u4e2a\u6570\uff0c\u4e5f\u5c31\u662f\u603b\u7684\u4e09\u5143\u73af\u7684\u4e2a\u6570\u4e86\u3002\n\n\u663e\u7136\uff0c\u4efb\u610f\u4e09\u4e2a\u70b9\u6784\u6210\u4e09\u5143\u73af\u7684\u4e2a\u6570\u662f $C_n^3$\u3002\n\n\u518d\u6765\u601d\u8003\u4e0d\u80fd\u6784\u6210\u4e09\u5143\u73af\u7684\u4e2a\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u4e00\u4e2a\u70b9\u4e0d\u80fd\u6784\u6210\u4e09\u5143\u73af\uff0c\u90a3\u4e48\u8fd9\u4e2a\u70b9\u7684\u51fa\u5ea6\u4e3a $2$\uff0c\u90a3\u4e48\u5982\u679c\u4e00\u4e2a\u70b9\u7684\u51fa\u5ea6\u4e3a $du[x]$ \u7684\u8bdd\uff0c\u4e0d\u80fd\u6784\u6210\u4e09\u5143\u73af\u7684\u4e2a\u6570\u5c31\u662f $C_{du[x]}^2=\\frac{du[x]\\times (du[x]-1)}{2}$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8981\u6c42\u7684\u7b54\u6848\u5c31\u53d8\u6210\u4e86 $C_n^3-\\sum C_{du[x]}^2$\u3002\n\n\u56e0\u6b64\uff0c\u8981\u6700\u5c0f\u5316 $\\sum C_{du[x]}^2$ \u7684\u503c\u3002\n\n\u5982\u679c\u4e00\u6761$(u,v)$\u8fb9\uff0c\u5047\u8bbe\u786e\u5b9a\u7684\u8fb9\u6211\u4eec\u53ea\u80fd\u5c06 $du[v]+1$\uff0c\u5982\u679c\u4e0d\u786e\u5b9e\u53ef\u4ee5\u5c06 $du[u]+1$ \u6216 $du[v]+1$ \uff0c$u$ \u548c $v$ \u4e8c\u9009\u4e00\uff0c\u53c8\u6ce8\u610f\u5230\u8fb9\u6570\u6bd4\u8f83\u5c0f\uff0c\u6240\u4ee5\u8003\u8651\u7f51\u7edc\u6d41\uff0c\u5c06\u8fb9\u770b\u6210\u4e00\u4e2a\"\u70b9\"\uff0c\u4ece\u8fb9\u6d41\u5411\u70b9\u518d\u6d41\u5411\u8d85\u7ea7\u6c47\u70b9\u3002\n\n\u5982\u679c\u4e00\u6761\"\u8fb9\"\u4f7f\u5f97 $du[u]+1$ \u90a3\u4e48\u5efa\u7acb\u4e00\u6761\u4ece\u8fd9\u4e2a\"\u8fb9\"\u5230 $u$ \u70b9\u7684\u8fb9,\u6d41\u91cf\u4e3a $1$,\u8d39\u7528\u4e3a $0$ \u5982\u679c\u4e00\u6761\u8fb9\u662f\u6ca1\u6709\u786e\u5b9a\u7684\uff0c\u90a3\u4e48\u5efa\u7acb\u4e00\u6761\u5230 $u$ \u70b9\u7684\u8fb9\u548c\u4e00\u6761\u5230 $v$ \u7684\u8fb9\uff0c\u6d41\u91cf\u4e3a $1$\uff0c\u8d39\u7528\u4e3a $0$ ,\u4ee3\u8868\u4e8c\u9009\u4e00\uff0c\u4ece\u8d85\u7ea7\u6e90\u70b9\u5230\u6bcf\u6761\"\u8fb9\"\u4e5f\u5efa\u7acb\u4e00\u6761\u6d41\u91cf\u4e3a $1$ \uff0c\u8d39\u7528\u4e3a $0$ \u7684\u8fb9\uff0c\u9650\u5236\u6d41\u91cf\u3002\n\n\u8003\u8651\u5982\u4f55\u8ba1\u7b97\u7b54\u6848\uff0c\u89c2\u5bdf\u67ff\uff08\u5f0f\uff09\u5b50 $C_{du[x]}^2=\\frac{du[x]\\times (du[x]-1)}{2}$ \uff0c\u53d1\u73b0\u540e\u9762\u90a3\u4e2a\u67ff\u5b50\u5f88\u60f3\u5c0f\u5b66\u7684\u65f6\u5019\u5b66\u8fc7\u7684\u7b49\u5dee\u6570\u5217 $0+1+2+3+...+du[x-1]=\\frac{du[x]\\times (du[x]-1)}{2}$ ,\u90a3\u4e48\u6211\u4eec\u5efa$du[x]$ \u6761\u8fb9\uff0c\u4ece\u70b9\u5230\u8d85\u7ea7\u6c47\u70b9\uff0c\u6d41\u91cf\u4e3a $1$\uff0c\u8d39\u7528\u5206\u522b\u4e3a $0,1,2,...,du[x]-1$\uff0c\u5c31\u53ef\u4ee5\u8868\u793a\u6240\u6709\u7684\u60c5\u51b5\u4e86\u3002\n\n\u7136\u540e\u5c31\u4e00\u822c\u7684\u5237\u8d39\u7528\u6d41\u5c31\u597d\u4e86\u3002\n\n### \u4ee3\u7801\u5b9e\u73b0\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=10105,maxe=maxn*8,INF=0x3f3f3f3f;\nint N,mp[105][105],st,ed;\nint lnk[maxn],nxt[maxe],son[maxe],w[maxe],cost[maxe],cnt=1,vis[maxn],dis[maxn],Q[maxn];\nint maxflow,mincost,Ans;\ninline int read(){\n\tint ret=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-f;ch=getchar();}\n\twhile(ch<='9'&&ch>='0')ret=ret*10+ch-'0',ch=getchar();\n\treturn ret*f;\n}\ninline int calc(int x,int y){return (x-1)*N+y;}\ninline void add_e(int x,int y,int z,int c){\n\tson[++cnt]=y;nxt[cnt]=lnk[x];lnk[x]=cnt;w[cnt]=z;cost[cnt]=c;\n}\ninline void add_edge(int x,int y,int z,int c){\n\tadd_e(x,y,z,c);add_e(y,x,0,-c);\n}\nint spfa(){\n\tint hed=0,til=1;\n\tmemset(dis,INF,sizeof dis);\n\tmemset(vis,0,sizeof vis);\n\tdis[st]=0;Q[til]=st;\n\twhile(hed!=til){\n\t\thed=(hed+1)%maxn;vis[Q[hed]]=0;\n\t\tfor(int j=lnk[Q[hed]];j;j=nxt[j])\n\t\t\tif(w[j]>0&&dis[son[j]]>dis[Q[hed]]+cost[j]){\n\t\t\t\tdis[son[j]]=dis[Q[hed]]+cost[j];\n\t\t\t\tif(!vis[son[j]]){\n\t\t\t\t\tvis[son[j]]=1;Q[til=(til+1)%maxn]=son[j];\n\t\t\t\t}\n\t\t\t}\n\t}\n\treturn dis[ed]!=INF;\n}\nint min(int x,int y){return x<y?x:y;}\nint DFS(int x,int delta){\n\tvis[x]=1;\n\tif(x==ed)return delta;\n\tint flow=0;\n\tfor(int j=lnk[x];j;j=nxt[j]){\n\t\tif((!vis[son[j]]||x==ed)&&w[j]>0&&dis[son[j]]==dis[x]+cost[j]){\n\t\t\tint t=DFS(son[j],min(delta-flow,w[j]));\n\t\t\tif(t>0){flow+=t;w[j]-=t;w[j^1]+=t;mincost+=t*cost[j];}\n//\t\t\tif(flow==delta)break;\n\t\t}\n\t}\n\treturn flow;\n}\ninline void Dinic(){\n\twhile(spfa()){\n\t\tvis[ed]=1;\n\t\twhile(vis[ed]){\n\t\t\tmemset(vis,0,sizeof vis);\n\t\t\tint tmp=DFS(st,INF);\n\t\t\tmaxflow+=tmp;\n\t\t}\n\t}\n\tAns=((N-1)*(N-2)*N)/6;\n\tAns-=mincost;\n}\nint main(){\n\tN=read();st=0;ed=N*N+N+1;\n\tfor(int i=1;i<=N;i++)\n\tfor(int j=1;j<=N;j++){\n\t\tmp[i][j]=read();\n\t\tif(i>=j)continue;\n\t\tif(!(mp[i][j]^2)){\n\t\t\tadd_edge(st,calc(i,j),1,0);\n\t\t\tadd_edge(calc(i,j),N*N+i,1,0);\n\t\t\tadd_edge(calc(i,j),N*N+j,1,0);\n\t\t}\n\t\telse if(!(mp[i][j]^1)) add_edge(st,N*N+j,1,0);\n\t\telse add_edge(st,N*N+i,1,0);\n\t}\n\tfor(int i=1;i<=N;i++)\n\tfor(int j=0;j<N;j++)\n\t\tadd_edge(N*N+i,ed,1,j);\n\tDinic();\n\tprintf(\"%d\\n\",Ans);\n\tfor(int i=1;i<=N;i++){\n\t\tfor(int j=i+1;j<=N;j++){\n\t\t\tif(mp[i][j]<2)continue;\n\t\t\tfor(int k=lnk[calc(i,j)];k;k=nxt[k]){\n\t\t\t\tif(son[k]&&w[k]==0){\n\t\t\t\t\tmp[i][j]=(son[k]-N*N==j);\n\t\t\t\t\tmp[j][i]=mp[i][j]^1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=N;i++){\n\t\tfor(int j=1;j<=N;j++)printf(\"%d \",mp[i][j]);\n\t\tprintf(\"\\n\");\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1629969066,
        "uid": 128822,
        "name": "OI\u754c\u7684\u5c0f\u6df7\u6df7",
        "ccfLevel": 6,
        "title": "P4249 [WC2007]\u526a\u5200\u77f3\u5934\u5e03 \u9898\u89e3"
    },
    {
        "content": "> $n$ \u4e2a\u8282\u70b9\uff0c\u5176\u4e2d\u5df2\u7ecf\u8fde\u4e86\u4e00\u4e9b\u8fb9\uff0c\u6c42\u5c06\u8fd9\u5f20\u56fe\u8865\u6210\u4e00\u4e2a\u5b8c\u5168\u56fe\u540e\uff0c\u4e09\u5143\u73af\u7684\u4e2a\u6570\u6700\u591a\u662f\u591a\u5c11\u3002\n>\n> $1\\le n\\le 100$\u3002\n\n\u6b63\u7740\u505a\u6bd4\u8f83\u56f0\u96be\uff0c\u8003\u8651\u53cd\u7740\u601d\u8003\u3002\u5373\u6c42\u89e3 \u300c\u4e0d\u6784\u6210\u4e09\u5143\u73af\u7684\u4e09\u5143\u7ec4\u4e2a\u6570\u6700\u5c11\u662f\u591a\u5c11\u300d\u3002\n\n\u8003\u8651\u5bf9\u4e8e\u4e00\u4e2a\u8fde\u4e86\u4e09\u6761\u8fb9\u7684\u4e09\u5143\u7ec4\uff0c\u4ec0\u4e48\u60c5\u51b5\u4e0b\u4e0d\u6784\u6210\u4e09\u5143\u73af\u2014\u2014\u53ef\u4ee5\u53d1\u73b0\u6b64\u65f6\u4e00\u5b9a\u5b58\u5728\u4e00\u4e2a\u70b9\u51fa\u5ea6\u4e3a $2$\u3002\n\n\u4e8e\u662f\u5bf9\u4e8e\u4e00\u4e2a\u51fa\u5ea6\u4e3a $w$ \u7684\u8282\u70b9\uff0c\u7531\u4e8e\u6bcf\u4e24\u4e2a\u51fa\u5ea6\u5c31\u53ef\u4ee5\u9501\u5b9a\u4e00\u4e2a\u975e\u73af\u7684\u4e09\u5143\u7ec4\uff0c\u6545\u8fd9\u4e2a\u8282\u70b9\u4e00\u5171\u53ef\u4ee5\u9501\u5b9a $C_{w}^2=\\frac{w\\times(w-1)}{2}$ \u4e2a\u8fd9\u6837\u7684\u4e09\u5143\u7ec4\u3002\n\n\u90a3\u4e48\u6211\u4eec\u8981\u505a\u4e9b\u4ec0\u4e48\u5462\uff1f\u5bf9\u4e8e\u4e00\u6761\u8fd8\u672a\u5b58\u5728\u7684\u8fb9 $(u,v)$\uff0c\u53ef\u4ee5\u9009\u62e9\u5c06\u5176\u51fa\u5ea6\u7684\u8d21\u732e\u52a0\u7ed9 $u$\uff0c\u4e5f\u53ef\u4ee5\u52a0\u7ed9 $v$\uff0c\u800c\u6211\u4eec\u8981\u505a\u7684\uff0c\u5c31\u662f\u5408\u7406\u5206\u914d\u8fd9\u4e9b\u51fa\u5ea6\u3002\n\n\u8003\u8651\u7f51\u7edc\u6d41\uff0c\u6d41\u91cf\u8868\u793a\u51fa\u5ea6\uff0c\u8d39\u7528\u8868\u793a\u975e\u73af\u4e09\u5143\u7ec4\u7684\u4e2a\u6570\u3002\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e2a\u539f\u56fe\u4e0a\u7684\u8282\u70b9\u6765\u8bf4\uff0c\u5b83\u6bcf\u589e\u52a0\u4e00\u4e2a\u6d41\u91cf\u6240\u589e\u52a0\u7684\u8d39\u7528\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u4f8b\u5982 $C_{2}^{2}-C_{1}^2=1$\uff0c$C_{3}^{2}-C_{2}^2=2$\uff0c$C_{4}^2-C_{3}^2=3$\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\u6240\u4ee5\u5efa\u56fe\u65f6\u4e5f\u9700\u8981\u5c06\u8fd9\u70b9\u8003\u8651\u8fdb\u53bb\u3002\n\n\u5efa\u56fe\u5982\u4e0b\uff1a\n\n- \u5de6\u4fa7\u8282\u70b9\u8868\u793a\u672a\u9501\u5b9a\u7684\u8fb9\uff0c\u7531\u6e90\u70b9\u5411\u5176\u6d41 $1$ \u6d41\u91cf\u8868\u793a\u53ea\u80fd\u5c06\u51fa\u5ea6\u8d4b\u7ed9\u4e00\u4e2a\u8282\u70b9\u3002\n- \u53f3\u4fa7\u8282\u70b9\u8868\u793a\u70b9\uff0c\u7531\u6e90\u70b9\u5411\u5176\u6d41\u5df2\u7ecf\u9501\u5b9a\u7684\u8fb9\u4e2d\u8be5\u70b9\u51fa\u5ea6\u4e2a\u6d41\u91cf\uff0c\u518d\u7531\u5bf9\u5e94\u7684\u8868\u793a\u672a\u9501\u5b9a\u8fb9\u7684\u8282\u70b9\u5411\u5176\u8fde $1$ \u6d41\u91cf\u3002\u5e76\u5411\u6c47\u70b9\u8fde $n$ \u6761\u8fb9\uff0c\u6d41\u91cf\u90fd\u4e3a $1$\uff0c\u8d39\u7528\u5206\u522b\u4e3a $0$ \u5230 $n-1$\u3002\n\n\u7136\u540e\u8dd1\u8d39\u7528\u6d41\u5373\u53ef\u3002\u6700\u7ec8\u7b54\u6848\u4e3a $C_{n}^3-ans$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int K=105;\nconst int N=20005;\nconst int M=2e5+5;\nconst int INF=1e9;\nint n,a[K][K],s,t,p[K][K],dep[N],ans,cost;\nbool vis[N];\nconst int id(int x,int y){\n\treturn (x-1)*n+y;\n}\nstruct node{\n\tint to[M],next[M],head[N],tot=1,val[M],co[M];\n\tvoid adde(int u,int v,int w,int f){\n\t\tto[++tot]=v,next[tot]=head[u],val[tot]=w,co[tot]=f,head[u]=tot;\n\t\tto[++tot]=u,next[tot]=head[v],val[tot]=0,co[tot]=-f,head[v]=tot;\n\t}\n}S;\nll read(){\n    ll w=0,f=1;\n    char ch=getchar();\n    while (ch>'9'||ch<'0') {\n        if (ch=='-') f=-1;\n        ch=getchar();\n    }\n    while (ch>='0'&&ch<='9') {\n        w=(w<<3)+(w<<1)+(ch^48);\n        ch=getchar();\n    }\n    return w*f;\n}\nqueue<int> q;\nbool bfs(){\n\tfor (int i=s;i<=t;i++) dep[i]=INF,vis[i]=0;\n\tdep[s]=0,q.push(s);\n\twhile (!q.empty()){\n\t\tint u=q.front();\n\t\tq.pop();\n\t\tvis[u]=0;\n\t\tfor (int i=S.head[u];i;i=S.next[i]){\n\t\t\tint v=S.to[i];\n\t\t\tif (S.val[i]&&dep[v]>dep[u]+S.co[i]){\n\t\t\t\tdep[v]=dep[u]+S.co[i];\n\t\t\t\tif (!vis[v]){\n\t\t\t\t\tvis[v]=1;\n\t\t\t\t\tq.push(v);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tif (dep[t]==INF) return 0;\n\treturn 1;\n}\nint dfs(int u,int flow){\n\tvis[u]=1;\n\tif (u==t) return flow;\n\tint used=0,rlow=0;\n\tfor (int i=S.head[u];i;i=S.next[i]){\n\t\tint v=S.to[i];\n\t\tif ((!vis[v]||v==t)&&S.val[i]&&dep[v]==dep[u]+S.co[i]){\n\t\t\tif (rlow=dfs(v,min(flow-used,S.val[i]))){\n\t\t\t\tS.val[i]-=rlow;\n\t\t\t\tS.val[i^1]+=rlow;\n\t\t\t\tused+=rlow;\n\t\t\t\tcost-=rlow*S.co[i];\n\t\t\t\tif (used==flow) break;\n\t\t\t}\n\t\t}\n\t}\n\treturn used;\n}\nvoid dinic(){\n\twhile (bfs()){\n\t\tvis[t]=1;\n\t\twhile (vis[t]){\n\t\t\tmemset(vis,0,sizeof(vis));\n\t\t\tdfs(s,INF);\n\t\t}\n\t}\n}\nint main(){\n#ifndef ONLINE_JUDGE\n    freopen(\"in.in\",\"r\",stdin);\n#endif\n    n=read(),s=0,t=n*n+n+1,cost=n*(n-1)*(n-2)/3/2;\n\tfor (int i=1;i<=n;i++)\t\n\t\tfor (int j=1;j<=n;j++)\t\n\t\t\ta[i][j]=read();\n\tfor (int i=1;i<=n;i++){\n\t\tfor (int j=i+1;j<=n;j++){\n\t\t\tif (a[i][j]==0){\n\t\t\t\tS.adde(s,j+n*n,1,0);\n\t\t\t}else if (a[i][j]==1){\n\t\t\t\tS.adde(s,i+n*n,1,0);\n\t\t\t}else{\n\t\t\t\tS.adde(s,id(i,j),1,0);\n\t\t\t\tS.adde(id(i,j),i+n*n,1,0);\n\t\t\t\tS.adde(id(i,j),j+n*n,1,0);\n\t\t\t\tp[i][j]=S.tot;\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i=1;i<=n;i++){\n\t\tfor (int j=0;j<n;j++)\n\t\t\tS.adde(i+n*n,t,1,j);\n\t}\n\tdinic();\n\tcout<<cost<<\"\\n\";\n\tfor (int i=1;i<=n;i++){\n\t\tfor (int j=i+1;j<=n;j++){\n\t\t\tif (a[i][j]==2){\n\t\t\t\tif (S.val[p[i][j]]==0)\n\t\t\t\t\tp[j][i]=0,p[i][j]=1;\n\t\t\t\telse p[j][i]=1,p[i][j]=0;\t\t\t\t\n\t\t\t}else{\n\t\t\t\tp[i][j]=a[i][j],p[j][i]=a[j][i];\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i=1;i<=n;i++){\n\t\tfor (int j=1;j<=n;j++)\n\t\t\tcout<<p[i][j]<<\" \";\n\t\tputs(\"\");\n\t}\n    return 0;\n}\n```",
        "postTime": 1678148724,
        "uid": 257621,
        "name": "\u7ffc\u5fb7\u5929\u5c0a",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P4249 [WC2007]\u526a\u5200\u77f3\u5934\u5e03"
    },
    {
        "content": "[P4249](https://www.luogu.com.cn/problem/P4249) [CF1264E](https://www.luogu.com.cn/problem/CF1264E)\n\n\u9e3d\u597d\u4e45\u4e86\uff0c\u7a0d\u5fae\u5199\u4e00\u4e0b\u3002\n\n\u6c42\u6210\u73af\u7684\u4e09\u5143\u7ec4\u4e2a\u6570\u5e76\u6ca1\u6709\u4f18\u79c0\u7684\u505a\u6cd5\uff0c\u8003\u8651\u6c42\u4e0d\u6210\u73af\u7684\u4e09\u5143\u7ec4\u4e2a\u6570\u3002\n\n\u8003\u8651\u4e0d\u6210\u73af\u7684\u60c5\u51b5\uff0c\u5fc5\u7136\u662f\u5176\u4e2d\u4e00\u4e2a\u70b9\u5165\u5ea6\u4e3a $2$\uff0c\u53e6\u4e00\u4e2a\u70b9\u51fa\u5ea6\u4e3a $2$\u3002\n\n\u4e0d\u59a8\u4ee4\u4e09\u5143\u7ec4\u6709\u5e8f\uff0c\u8bbe $d_i$ \u4e3a\u70b9 $i$ \u7684\u51fa\u5ea6\u3002\n\n\u90a3\u4e48\u8fd9\u6837\u7684\u4e09\u5143\u7ec4\u603b\u6570\u5c31\u662f $\\dfrac{n(n-1)(n-2)}{6}$\u3002\n\n\u800c\u5bf9\u4e8e\u4e0d\u6210\u73af\u7684\u4e09\u5143\u7ec4\uff0c\u5fc5\u7136\u6709\u4e00\u4e2a\u70b9\u51fa\u5ea6\u4e3a $2$\uff0c\u90a3\u4e48\u8003\u8651\u7ec4\u5408\u610f\u4e49\uff0c\u5c31\u662f\u4ece\u4efb\u4f55\u4e00\u4e2a\u51fa\u5ea6 $\\ge 2$ \u7684\u70b9\u4e2d\u4efb\u9009\u4e24\u4e2a\u51fa\u8fb9\u8fde\u63a5\u7684\u70b9\u7ec4\u6210\u4e00\u4e2a\u4e09\u5143\u7ec4\uff0c\u8fd9\u6837\u7684\u4e09\u5143\u7ec4\u4e2a\u6570\u5373\u4e3a $\\sum\\limits_{i=1}^n\\dbinom{d_i}{2}$\u3002\n\n\u4e8e\u662f\u6210\u73af\u4e09\u5143\u7ec4\u6570\u5373\u4e3a $\\dfrac{n(n-1)(n-2)}{6}-\\sum\\limits_{i=1}^n\\dbinom{d_i}{2}$\u3002\n\n\u8fd9\u4e2a\u5f0f\u5b50\u62c6\u4e00\u4e0b\u53d8\u6210 $\\dfrac{n(n-1)(n-2)}{6}-\\sum\\limits_{i=1}^n\\dfrac{{d_i}^2}{2}+\\sum\\limits_{i=1}^n\\dfrac{d_i}{2}$\u3002\n\n\u53c8\u56e0\u4e3a\u6240\u6709\u70b9\u7684\u51fa\u5ea6\u548c\u7b49\u4e8e\u56fe\u7684\u8fb9\u6570\uff0c\u5373 $\\sum\\limits_{i=1}^nd_i=\\dfrac{n(n-1)}{2}$\u3002\n\n\n\u4ee3\u5165\u53ef\u5f97\u539f\u5f0f\u503c\u4e3a $\\dfrac{n(n-1)(2n-1)}{12}-\\dfrac{1}{2}\\sum\\limits_{i=1}^n{d_i}^2$\u3002\n\n\u7136\u540e\u8981\u6700\u5927\u5316\u8fd9\u4e2a\u503c\uff0c\u53ea\u9700\u6700\u5c0f\u5316 $\\sum\\limits_{i=1}^n{d_i}^2$ \u5373\u53ef\u3002\n\n\u73b0\u5728\u8981\u628a\u5176\u4f59\u672a\u5b9a\u5411\u7684\u8fb9\u5b9a\u5411\uff0c\u8003\u8651\u8d39\u7528\u6d41\u3002\n\n\u8003\u8651\u5bf9\u4e8e\u672a\u5b9a\u5411\u7684\u8fb9\uff0c\u53ef\u4ee5\u628a\u8fd9\u4e9b\u8fb9\u770b\u505a\u4e00\u4e2a\u70b9\uff0c\u4ece\u6e90\u70b9\u5411\u8fd9\u4e9b\u70b9\u8fde\u6d41\u91cf\u4e3a $1$\uff0c\u8d39\u7528\u4e3a $0$ \u7684\u8fb9\uff0c\u8fd9\u4e9b\u70b9\u518d\u5411\u8fb9\u7684\u4e24\u4e2a\u7aef\u70b9\u8fde\u6d41\u91cf\u4e3a $1$\uff0c\u8d39\u7528\u4e3a $0$ \u7684\u8fb9\u5373\u53ef\u4fdd\u8bc1\u6bcf\u573a\u6bd4\u8d5b\u6709\u552f\u4e00\u80dc\u8005\u3002\n\n\u7136\u540e\u8fd9\u4e9b\u70b9\u5411\u6c47\u70b9\u8fde\u8fb9\uff0c\u8003\u8651\u8be5\u70b9\u6bcf\u591a\u83b7\u80dc\u4e00\u573a\u589e\u52a0\u7684\u8d21\u732e\u4e3a $\\dfrac{d_i(d_i+1)}{2}-\\dfrac{d_i(d_i-1)}{2}=d_i$\uff0c\u6240\u4ee5\u76f4\u63a5\u8fde\u6d41\u91cf\u4e3a $1$\uff0c\u8d39\u7528\u4e3a $d_i$ \u7684\u8fb9\u5373\u53ef\u3002\n\n\u6700\u540e\u77e9\u9635\u7684\u5f62\u6001\u53ea\u9700\u8981\u53c2\u8003\u4ece\u8fb9 $(i,j)$ \u5230\u70b9 $i$ \u7684\u6d41\u91cf\u662f\u5426\u6d41\u5b8c\u5373\u53ef\uff0c\u8bb0\u5f55\u4e00\u4e0b\u8fb9\u5230\u70b9\u7684\u6d41\u91cf\u5c31\u505a\u5b8c\u4e86\u3002",
        "postTime": 1658237242,
        "uid": 93266,
        "name": "\u65ad\u6e05\u79cb",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011P4249 [WC2007]\u526a\u5200\u77f3\u5934\u5e03 || CF1264E Beautiful League"
    },
    {
        "content": "[$\\Large\\color{#FFBBFF}\\textit{Tian-Xing's blog}$](https://Tian-Xing.github.io)\n\n------------\n\n# Description\n\n[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4249)\n\n------------\n\n# Solution\n\n\u9996\u5148\u53d1\u73b0\u76f4\u63a5\u6c42\u8fd9\u79cd\u4e09\u5143\u7ec4\u4e0d\u6253\u597d\u6c42\uff0c\u90a3\u4e48\u8003\u8651\u7403\u4e0d\u6ee1\u8db3\u8fd9\u79cd\u5173\u7cfb\u7684\u4e09\u5143\u7ec4\u7684\u6570\u91cf\u3002\n\n\u6ce8\u610f\u5230\u4e00\u4e2a\u4e09\u5143\u7ec4\uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\u8fd9\u79cd\u5173\u7cfb\uff0c\u80af\u5b9a\u5206\u522b\u8d62\u4e86$0$\uff0c$1$\uff0c$2$\u573a\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5982\u679c\u77e5\u9053\u4e86\u6bcf\u4e2a\u4eba\u8d62\u7684\u573a\u6570$y_i$\uff0c\u4e0d\u5177\u6709\u8fd9\u79cd\u5173\u7cfb\u7684\u4e09\u5143\u7ec4\u6570\u91cf\u5c31\u662f$\\sum \\frac{y_i \\times (y_i - 1}{2}$\u3002\n\n\u56e0\u4e3a\u8981\u4f7f\u6ee1\u8db3\u8fd9\u79cd\u5173\u7cfb\u7684\u4e09\u5143\u7ec4\u6570\u91cf\u6700\u591a\uff0c\u6240\u4ee5\u6211\u4eec\u5efa\u7acb\u7684\u5408\u6cd5\u65b9\u6848\u8981\u4f7f$\\sum \\frac{y_i \\times (y_i - 1}{2}$\u6700\u5c0f\u3002\u8003\u8651\u7528\u7f51\u7edc\u6d41\u6765\u6c42\u89e3\u3002\n\n\u9996\u5148\u8981\u6ee1\u8db3\u662f\u4e00\u79cd\u5408\u6cd5\u65b9\u6848\uff0c\u53ef\u4ee5\u8fd9\u6837\u5efa\u6a21\uff0c\u9996\u5148\u6bcf\u4e2a\u4eba\u5411$T$\u8fde\u4e00\u6761\u5bb9\u91cf\u4e3a$n$\u7684\u6709\u5411\u8fb9\uff0c\u7136\u540e\u5bf9\u4e8e\u4e00\u4e2a\u8fd8\u6ca1\u6709\u53d1\u751f\u7684\u6bd4\u8d5b\uff0c\u65b0\u5efa\u4e00\u4e2a\u8282\u70b9$tmp$\uff0c\u4ece$tmp$\u5206\u522b\u5411$i$\u548c$j$\u8fde\u4e00\u6761\u5bb9\u91cf\u4e3a$1$\u7684\u6709\u5411\u8fb9\uff0c\u4ece$S$\u5411$tmp$\u94fe\u63a5\u4e00\u6761\u5bb9\u91cf\u4e3a$1$\u7684\u6709\u5411\u8fb9\u3002\u8fd9\u6837\u5efa\u6a21\u8dd1\u51fa\u6765\u7684\u6700\u5927\u6d41\u5c31\u662f\u4e00\u79cd\u5408\u6cd5\u65b9\u6848\u3002\n\n\u73b0\u5728\u8003\u8651\u5982\u4f55\u5728\u8dd1\u6700\u5927\u6d41\u7684\u65f6\u5019\u4f7f$\\sum \\frac{y_i \\times (y_i - 1)}{2}$\u6700\u5c0f\uff0c\u5c06\u6bcf\u4e2a\u4eba\u5411$T$\u8fde\u7684\u6709\u5411\u8fb9\u62c6\u6210\u5bb9\u91cf\u4e3a$1$\u7684\u82e5\u5e72\u6761\u6709\u5411\u8fb9\uff0c\u8d39\u7528\u5206\u522b\u4e3a$0$\uff0c$1$\uff0c$2 \\dots$\u8fd9\u6837\u8fde\u8fb9\u662f\u56e0\u4e3a\u5982\u679c\u4e00\u4e2a\u4eba\u7684\u80dc\u5229\u573a\u6570\u589e\u52a0\u4e00\uff0c$\\frac{y_i \\times (y_i - 1}{2}$\u7684\u53d8\u5316\u4f1a\u5448\u73b0\u4e00\u79cd\u7b49\u5dee\u6570\u5217\u7684\u5f62\u5f0f\uff0c\u800c\u8fd9\u6837\u5c06\u8fb9\u62c6\u5f00\uff0c\u6bcf\u6b21\u53ea\u4f1a\u589e\u5e7f\u8d39\u7528\u6700\u5c0f\u7684\u4e00\u6761\u8def\uff0c\u6240\u4ee5\u80fd\u4fdd\u8bc1\u6b63\u786e\u6027\u3002\n\n\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u4e00\u4e2a\u4eba\u672c\u6765\u6709\u4e00\u4e9b\u80dc\u5229\u573a\u6570\uff0c\u8981\u5728\u539f\u5148\u7684\u80dc\u5229\u573a\u6b21\u57fa\u7840\u4e0a\u8fdb\u884c\u62c6\u8fb9\u548c\u5efa\u6a21\u3002\n\n------------\n\n# Code\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <queue>\nusing namespace std;\n\n#define int long long\n\nconst int INF = 999999999;\nconst int N = 1000050;\nconst int M = 2000050;\n\nint n, s, t, head[N], cur[N], d[N], vis[N], a[500][500], num = 1, cnt, y[N], ans, maxflow, mincost, neww[N][3], diao;\n\nstruct Node\n{\n\tint next, to, flow, dis;\n} edge[M * 2];\n\nvoid Addedge(int u, int v, int w, int c)\n{\n\tedge[++num] = (Node){ head[u], v, w, c};\n\thead[u] = num;\n}\n\nvoid Add(int u, int v, int w, int c)\n{\n\tAddedge(u, v, w, c);\n\tAddedge(v, u, 0, -c);\n\treturn; \n}\n\ntemplate <class T>\nvoid Read(T &x)\n{\n\tx = 0; int p = 0; char st = getchar();\n\twhile (st < '0' || st > '9') p = (st == '-'), st = getchar();\n\twhile (st >= '0' && st <= '9') x = (x << 1) + (x << 3) + st - '0', st = getchar();\n \tx = p ? -x : x;\n \treturn;\n}\n\ntemplate <class T>\nvoid Put(T x)\n{\n\tif (x < 0) putchar('-'), x = -x;\n\tif (x > 9) Put(x / 10);\n\tputchar(x % 10 + '0');\n\treturn; \n}\n\nvoid Work(int x)\n{\n\tfor (int i = y[x] + 1; i <= n; i++)\n\t{\n\t\tAdd(x, t, 1, i - 1);\n\t}\n\treturn;\n}\n\nint Bfs()\n{\n\tqueue<int> q;\n\tfor (int i = 0; i <= cnt; i++) d[i] = INF, vis[i] = 0;\n\td[s] = 0; vis[s] = 1; q.push(s);\n\twhile (!q.empty())\n\t{\n\t\tint u = q.front(); q.pop(); vis[u] = 0;\n\t\tfor (int i = head[u]; i; i = edge[i].next)\n\t\t\tif (edge[i].flow > 0 && d[edge[i].to] > d[u] + edge[i].dis)\n\t\t\t{\n\t\t\t\td[edge[i].to] = d[u] + edge[i].dis;\n\t\t\t\tif (!vis[edge[i].to])\n\t\t\t\t{\n\t\t\t\t\tvis[edge[i].to] = 1;\n\t\t\t\t\tq.push(edge[i].to);\n\t\t\t\t}\n\t\t\t}\t\n\t} \n\treturn d[t] != INF;\n}\n\nint Dinic(int x, int flow)\n{\n\tif (x == t || !flow) return flow;\n\tint rest = flow, k;\n\tvis[x] = 1;\n\tfor (int i = cur[x]; i && rest; i = edge[i].next)\n\t{\n\t\tint v = edge[i].to;\n\t\tcur[x] = i;\n\t\tif (!vis[edge[i].to] && edge[i].flow > 0 && d[edge[i].to] == d[x] + edge[i].dis)\n\t\t{\n\t\t\tint v = edge[i].to;\n\t\t\tint k = Dinic(v, min(rest, edge[i].flow));\n\t\t//\tif (!k) dis[edge[i].to] = INF;\n\t\t\trest -= k;\n\t\t\tedge[i].flow -= k;\n\t\t\tedge[i ^ 1].flow += k;\n\t\t\tmincost += k * edge[i].dis;\n\t\t}\n\t}\n\tvis[x] = 0;\n\treturn flow - rest;\n}\n\nvoid Solve()\n{\n\twhile(Bfs())\n\t{\n\t\tfor (int i = 0; i <= cnt; i++) cur[i] = head[i]; \n\t\tmaxflow += Dinic(s, INF);\n\t}\n\treturn; \n}\n\nsigned main()\n{\n\tRead(n);\n\tcnt = n + 1;\n\tfor (int i = 1; i <= n; i++) \n\t\tfor (int j = 1; j <= n; j++)\n\t\t{\n\t\t\tRead(a[i][j]);\n\t\t\tif (a[i][j] == 1) y[i]++;\n\t\t}\n\ts = 0; t = n + 1;\n\tfor (int i = 1; i <= n; i++) ans += y[i] * (y[i] - 1) / 2, Work(i);\n\tfor (int i = 1; i <= n; i++)\n\t\tfor (int j = i + 1; j <= n; j++)\n\t\t\tif (a[i][j] == 2)\n\t\t\t{\n\t\t\t\tint tmp = ++cnt;\n\t\t\t\tneww[++diao][1] = i;\n\t\t\t\tneww[diao][2] = j; \n\t\t\t\tAdd(s, tmp, 1, 0);\n\t\t\t\tAdd(tmp, j, 1, 0); \n\t\t\t\tAdd(tmp, i, 1, 0);\n\t\t\t\tneww[diao][0] = num;\n\t\t\t} \n\tSolve();\n\tans += mincost;\n\tPut(n * (n - 1) * (n - 2) / 6 - ans); putchar('\\n');\n\tfor (int i = 1; i <= diao; i++) a[neww[i][1]][neww[i][2]] = edge[neww[i][0]].flow > 0 ? 1 : 0, a[neww[i][2]][neww[i][1]] = a[neww[i][1]][neww[i][2]] ^ 1;\n \tfor (int i = 1; i <= n; i++) \n\t{\n\t\tfor (int j = 1; j <= n; j++)\n\t\t\tPut(a[i][j]), putchar(' ');\n\t\tputchar('\\n');\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1584346869,
        "uid": 73983,
        "name": "Infiltrator",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4249 \u3010[WC2007]\u526a\u5200\u77f3\u5934\u5e03\u3011"
    },
    {
        "content": "\u697c\u4e0a\u8bb2\u7684\u76f8\u5f53\u7684\u6e05\u695a\uff0c\u8fd9\u91cc\u849f\u84bb\u5206\u4eab\u4e00\u4e0b\u81ea\u5df1\u7684\u601d\u8def\u3002\n\n\u4e0d\u4f1a\u7684\u540c\u5b66\u53ef\u4ee5\u5148\u4e86\u89e3\u4e00\u4e0b\u6709\u5173\u77e5\u8bc6[\u7f51\u7edc\u6d41\u95ee\u9898\uff1a\u6700\u5927\u6d41\u53ca\u5176\u7b97\u6cd5](https://blog.csdn.net/vonmax007/article/details/64921089)\n\n\u5206\u6790\uff1a\u8fd9\u9898\u4ece\u6b63\u9762\u5206\u6790\uff0c\u770b\u4e0d\u51fa\u4ec0\u4e48\u4e1c\u897f\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u5bf9\u5076\u7684\u6027\u8d28\uff0c\u627e\u4e0d\u80fd\u6784\u6210\u526a\u5200\u77f3\u5934\u5e03\u7684\u60c5\u51b5\uff0c\u5bf9\u4e8e\u4efb\u610f\u4e09\u4e2a\u70b9\uff0c\u8fd8\u6709\u8fd9\u4e09\u4e2a\u70b9\u4e4b\u95f4\u7684\u4e09\u6761\u8fb9\uff0c\u5982\u679c\u6ee1\u8db3\u5176\u4e2d\u4e00\u4e2a\u70b9\u7684\u5165\u5ea6\u4e3a2\uff0c\u5219\u8fd9\u4e2a\u56fe\u4e0d\u662f\u526a\u5200\u77f3\u5934\u5e03\u60c5\u51b5\uff0c\u5bf9\u4e8e\u6574\u4e2a\u56fe\u4e2d\u7684\u4e00\u4e2a\u70b9\u7684\u5165\u5ea6in[i]\uff0c\u90a3\u4e48\u6709C(in[i],2)\u79cd\u60c5\u51b5\u4e0d\u884c\uff0c\u90a3\u4e48\u53ef\u4ee5\u6784\u6210\u526a\u5200\u77f3\u5934\u5e03\u60c5\u51b5\u7684\u6570\u91cf\u4e3aC(n,3)-sum{C(i[i],2)}(1<=i<=n)\n\n\u5bf9\u8fd9\u4e2a\u5f0f\u5b50\u8fdb\u884c\u8f6c\u6362\uff0c\u6709S=n*(n-1)*(n-2)-sum{in[i]^2}/2+sum{in[i]}/2\n\n\u7531\u4e8eS=n*(n-1)*(n-2)+sum{in[i]}/2\u662f\u5b9a\u503c\uff0c\u6240\u4ee5\u53ea\u8981\u4fdd\u8bc1sum{in[i]^2}/2\u7684\u503c\u6700\u5c0f\u5373\u53ef\n\n\n\u5177\u4f53\u65b9\u6cd5\uff1a\n\n\u6784\u56fe\uff0c\u865a\u62df\u6e90\u70b9\u548c\u6c47\u70b9\uff0c\u8fd8\u6709\u6ca1\u56fa\u5b9a\u7684\u8fb9\u8868\u793a\u4e00\u79cd\u8282\u70b9\uff0c\u53e6\u5916\u5c31\u662fn\u4e2a\u8282\u70b9\uff0c\u90a3\u4e48\u5bf9\u4e8e\u5df2\u7ecf\u56fa\u5b9a\u7684\u8fb9\uff0c\u5728\u6e90\u70b9\u4e0e\u76f8\u5e94\u9876\u70b9\u8fde\u4e0a\u4e00\u6761\u8fb9\uff0c\u5bb9\u91cf\u4e3a1\uff0c\u8d39\u7528\u4e3a0\uff0c\u5bf9\u4e8e\u4e0d\u56fa\u5b9a\u7684\u8fb9\uff0c\u5728\u6e90\u70b9\u4e0e\u8fd9\u6761\u8fb9\u5bf9\u5e94\u8282\u70b9\u8fde\u4e0a\u5bb9\u91cf\u4e3a1\uff0c\u8d39\u7528\u4e3a0\u7684\u8fb9\uff0c\u8fd9\u6761\u8fb9\u5bf9\u5e94\u8282\u70b9\u4e0e\u8fd9\u6761\u8fb9\u7684\u4e24\u4e2a\u7aef\u70b9\u5206\u522b\u8fde\u4e00\u6761\u5bb9\u91cf\u4e3a1\uff0c\u8d39\u7528\u4e3a0\u7684\u8fb9\uff0c\u5bf9\u4e8en\u4e2a\u70b9\uff0c\u5982\u4f55\u8ba1\u7b97in[i]^2\u5462\uff0c\u4e5f\u5c31\u662f\u6d41\u91cf\u7684\u5e73\u65b9\uff1f\n\n\u5982\uff1a\n\n\u6d41\u91cf  1  2  3  4...n\n\n\u8d39\u7528  1  4  9 16...n^2\n\n\u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u6761\u8fb9\u62c6\u6210n\u6761\u5bb9\u91cf\u4e3a1\u7684\u8fb9\uff0c\u8d39\u7528\u5206\u522b\u4e3a 1,3,5,7,9......\n\n\u7136\u540e\u6c42\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```\n#include <bits/stdc++.h>\n\n#define re register\n\n#define REP(u) for(re int i=p[u]; i>=0; i=p[ver[i]]) \n\nusing namespace std;\n\nifstream fin(\"jsb.in\");\nofstream fout(\"jsb.out\");\n\nconst int mm=1111111;//fff\nconst int mn=111111;\nconst int oo=1e9;\n\nint node,src,dest,edge;\n\nint head[mm],vis[mm],ver[mm],flow[mm],cost[mm],next[mm],dis[mm];\n\nint p[mm],q[mm];\n\ninline void prepare(int _n,int _s,int _d) {\n\tnode=_n,src=_s,dest=_d;\n\tfor(re int i=0; i<node; ++i) head[i]=-1,vis[i]=0;\n\tedge=0;\n}\n\ninline void add(int u,int v,int f,int c) {\n\tver[edge]=v,flow[edge]=f,cost[edge]=c,next[edge]=head[u],head[u]=edge++;\n\tver[edge]=u,flow[edge]=0,cost[edge]=-c,next[edge]=head[v],head[v]=edge++;\n}\n\ninline bool spfa() {\n\tint u,v,i,r=0,tmp;\n\tfor(re int i=0; i<node; ++i) dis[i]=oo;\n\tdis[q[r++]=src]=0;\n\tp[dest]=p[src]=-1;\n\tfor(re int l=0; l!=r; (++l>=mn)?l=0:l) {\n\t\tfor(i=head[u=q[l]],vis[u]=0; i>=0; i=next[i]) {\n\t\t\tif(flow[i]&&dis[v=ver[i]]>(tmp=dis[u]+cost[i])) {\n\t\t\t\tdis[v]=tmp;\n\t\t\t\tp[v]=i^1;\n\t\t\t\tif(vis[v]) continue;\n\t\t\t\tvis[q[r++]=v]=1;\n\t\t\t\tif(r>mn) r=0;\n\t\t\t}\n\t\t}\n\t}\n\treturn (p[dest]>=0);\n}\n\ninline int work2() {\n\tint ret=0,delta;\n\twhile(spfa()) {\n\t\tdelta=oo;\n\t\tREP(dest){\n\t\t\tif(flow[i^1]<delta) delta=flow[i^1];\n\t\t}\n\t\tREP(dest){\n\t\t\tflow[i]+=delta,flow[i^1]-=delta;\n\t\t}\n\t\tret+=delta*dis[dest];\n\t}\n\treturn (ret);\n}\n\nint a[111][111];\nint n,m=0,an;\n\ninline void init() {\n\tcin>>n;\n\tfor(re int i=1; i<=n; ++i) {\n\t\tfor(re int j=1; j<=n; ++j) {\n\t\t\tcin>>a[i][j];\n\t\t\tif(i<j&&a[i][j]>1) ++m;\n\t\t}\n\t}\n}\n\ninline void print() {\n\tcout<<an<<'\\n';\n\tfor(re int i=1; i<=n; ++i) {\n\t\tfor(re int j=1; j<=n; ++j) {\n\t\t\tcout<<a[i][j]<<' ';\n\t\t}\n\t\tcout<<'\\n';\n\t}\n}\n\ninline void work1() {\n\tint k=0;\n\tprepare(m+n+2,0,m+n+1);\n\tfor(re int i=1; i<=n; ++i) {\n\t\tfor(re int j=i+1; j<=n; ++j) {\n\t\t\tif(a[i][j]<2) {\n\t\t\t\tif(a[i][j]) add(src,m+j,1,0);\n\t\t\t\telse add(src,m+i,1,0);\n\t\t\t} \n\t\t\telse {\n\t\t\t\t++k;\n\t\t\t\tadd(src,k,1,0);\n\t\t\t\tadd(k,m+i,1,0);\n\t\t\t\tadd(k,m+j,1,0);\n\t\t\t}\n\t\t}\n\t}\n\tfor(re int i=1; i<=n; ++i) {\n\t\tfor(re int j=1; j<=n; ++j) {\n\t\t\tadd(m+i,dest,1,j*2-1);\n\t\t}\n\t}\n\tan=n*(n-1)*(n-2)/3+n*(n-1)/2;\n\tan=(an-work2())/2;k=0;\n\tfor(re int i=1; i<=n; ++i) {\n\t\tfor(re int j=i+1; j<=n; ++j) {\n\t\t\tif(a[i][j]>1) {\n\t\t\t\tfor(re int l=head[++k]; l>=0; l=next[l]) { \n\t\t\t\t\tif(!flow[l]) {\n\t\t\t\t\t\tif(ver[l]-m==i) a[j][i]=1,a[i][j]=0;\n\t\t\t\t\t\telse a[i][j]=1,a[j][i]=0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprint();\n\treturn;\n}\n\nint main() {\n\tinit();\n\twork1();\n\treturn 0;\n}\n\n/*\n3\n0 1 2\n0 0 2\n2 2 0\n*/\n```",
        "postTime": 1545410735,
        "uid": 124571,
        "name": "\u795e\u8ff9",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4249 \u3010[WC2007]\u526a\u5200\u77f3\u5934\u5e03\u3011"
    },
    {
        "content": "[\u70b9\u6211\u98df\u7528\u6548\u679c\u8ddf\u4f73](https://www.cnblogs.com/hbxblog/p/11112246.html)\n\n### $Solution$\n\n\u76f4\u63a5\u6c42\u5f88\u660e\u663e\u4e0d\u592a\u597d\u6c42\uff0c\u4e8e\u662f\u8003\u8651\u4e0d\u6784\u6210\u526a\u5200\u77f3\u5934\u5e03\u7684\u60c5\u51b5\u3002\n\n\u6211\u4eec\u73b0\u5728\u5047\u8bbe\u4e00\u4e2a\u4eba$i$\u8d62\u4e86$x$\u573a\uff0c\u90a3\u4e48\u5c31\u4f1a\u6709$\\frac{x*(x-1)}{2}$\n\n\u6211\u4eec\u73b0\u5728\u8981\u6700\u5c0f\u5316$\\frac{x*(x-1)}{2}$\n\n~~\u8fd9\u6837\u5c31\u5f88\u660e\u663e\u662f\u8d39\u7528\u6d41\u4e86\u5427~~\n\n\u6211\u4eec\u5148\u4e0d\u7ba1\u8d39\u7528\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u4eba\u5411$T$\u8fde\u8fb9\uff0c\u6d41\u91cf\u4e3a$n$\n\n\u961f$i,j$\u4e4b\u95f4\u7684\u6bd4\u8d5b\u5efa\u7acb\u70b9$y$,$s$\u5411$y$\u8fde\u8fb9\uff0c\u82e5\u6bd4\u8d5b\u7ed3\u679c\u4e0d\u786e\u5b9a\u5219\u5c06$y$\u5206\u522b\u5411$i$\u548c$j$\u8fde\u8fb9\u3002\u5982\u679c\u786e\u5b9a\u5219\u5411\u8d62\u7684\u4eba\u8fde\u8fb9,\u6d41\u91cf\u90fd\u4e3a$1$\n\n\u4f46\u662f$\\frac{x*(x-1)}{2}$\u8fd9\u4e2a\u82b1\u8d39\u4e0d\u592a\u597d\u8868\u793a\uff0c\u56e0\u4e3a\u4ed6\u4e0d\u662f\u56fa\u5b9a\u7684\u3002\n\n\u4e8e\u662f\u53ef\u4ee5\u60f3\u5230\u62c6\u8fb9\u3002\u6211\u4eec\u5c06\u6bcf\u4e2a\u4eba\u5411$T$\u8fde\u7684\u8fb9\u62c6\u6210$n$\u6761\uff0c\u6bcf\u6761\u8fb9\u5bb9\u91cf\u4e3a$1$\uff0c\u8d39\u7528\u5206\u522b\u4e3a$0,1,2,3...n-1$\n\n### $Code$\n\n``` cpp\n#include<bits/stdc++.h>\n#define rg register\n#define file(x) freopen(x\".in\",\"r\",stdin);freopen(x\".out\",\"w\",stdout);\nusing namespace std;\nconst int inf=1e9;\nconst int N=1.1e4+5;\nint read(){\n    int x=0,f=1;\n    char c=getchar();\n    while(c<'0'||c>'9') f=(c=='-')?-1:1,c=getchar();\n    while(c>='0'&&c<='9') x=x*10+c-48,c=getchar();\n    return f*x;\n}\nstruct node{\n    int to,next,v,w;\n}a[2000001];\nint head[N],cnt=1,n,m,s,t,x,y,z,tot,minx,maxx,dis[N],f[N],pre[10001],fa[10001];\nvoid add(int x,int y,int c,int v){\n    a[++cnt].to=y,a[cnt].next=head[x],a[cnt].v=c,a[cnt].w=v,head[x]=cnt;\n    a[++cnt].to=x,a[cnt].next=head[y],a[cnt].v=0,a[cnt].w=-v,head[y]=cnt;\n}\nqueue<int>q;\nint spfa(){\n    q.push(s);\n    memset(dis,127,sizeof(dis));\n    memset(f,0,sizeof(f));\n    f[s]=1,dis[s]=0;\n    int inf=dis[s+1];\n    while(!q.empty()){\n        int now=q.front();\n        q.pop();\n        f[now]=0;\n        for(int i=head[now];i;i=a[i].next){\n            int v=a[i].to;\n            if(dis[v]>dis[now]+a[i].w&&a[i].v){\n                dis[v]=dis[now]+a[i].w,pre[v]=i,fa[v]=now;\n                if(!f[v])\n                    f[v]=1,q.push(v);\n            }\n        }\n    }\n    if(dis[t]!=inf)\n        return 1;\n    return 0;\n}\nint ans1,ans;\nvoid answer(){\n    while(spfa()){\n        int minx=2147483647;\n        for(int i=t;i!=s;i=fa[i])\n            minx=min(minx,a[pre[i]].v);\n        ans+=minx,ans1+=dis[t]*minx;\n        for(int i=t;i!=s;i=fa[i])\n            a[pre[i]].v-=minx,a[pre[i]^1].v+=minx;\n    }\n}\nint M[1001][1001],vis[1001][1001];\nint main(){\n    n=read();\n    s=0,tot=n;\n    for(int i=1;i<=n;i++)\n        for(int j=1;j<=n;j++)\n            M[i][j]=read();\n    for(int i=1;i<=n;i++)\n        for(int j=1;j<i;j++){\n            tot++,add(s,tot,1,0);\n            if(M[i][j]!=1) add(tot,i,1,0),vis[j][i]=cnt-1;\n            if(M[i][j]!=0) add(tot,j,1,0),vis[i][j]=cnt-1;\n        }\n    t=tot+n;\n    for(int i=1;i<=n;i++)\n        for(int j=0;j<n;j++)\n            add(i,t,1,j);\n    answer();\n    cout<<(n)*(n-1)*(n-2)/6-ans1<<endl;\n    for(int i=1;i<=n;i++,cout<<endl)\n        for(int j=1;j<=n;j++){\n            if(M[i][j]<2) cout<<M[i][j]<<\" \";\n            else printf(\"%d \",!vis[i][j]||a[vis[i][j]].v?0:1);\n        }\n}\n```",
        "postTime": 1561944085,
        "uid": 19805,
        "name": "\u64a4\u4e91",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4249 \u3010[WC2007]\u526a\u5200\u77f3\u5934\u5e03\u3011"
    }
]
[
    {
        "content": "[\u539f\u9898\u4f20\u9001\u95e8\uff1aP2547 [AHOI2004]DNA\u53d8\u5f02](https://www.luogu.com.cn/problem/P2547)\n\n\u9898\u76ee\u5927\u610f\uff1a\n\n\u7ed9\u51fa $n$ \u4e2a\u5e8f\u5217\uff0c\u6bcf\u4e2a\u5e8f\u5217\u6709 $8$ \u4e2a\u5143\u7d20\uff0c\u6bcf\u4e2a\u5143\u7d20\u53ef\u4ee5\u662f\u2018A\u2019\u2018T\u2019\u2018C\u2019\u2018G\u2019\u56db\u4e2a\u4e0d\u540c\u5b57\u6bcd\u3002\n\n\u5c06\u7531\u4e00\u4e2a\u5e8f\u5217\u7ecf\u8fc7\u5176\u4e2d\u4e24\u7ec4\u4e0d\u540c\u7684\u4e24\u4e2a\u5143\u7d20\u4ea4\u6362\uff08\u4e0d\u540c\u5b9a\u4e49\u4e3a\u5171\u56db\u4e2a\u5143\u7d20\u7684\u4f4d\u7f6e\u5404\u4e0d\u76f8\u540c\uff09\u540e\uff0c\u53d8\u6210\u53e6\u4e00\u4e2a\u5e8f\u5217\uff0c\u8fd9\u4e24\u4e2a\u5e8f\u5217\u4e3a\u8840\u7f18\u5e8f\u5217\uff0c\u6c42 $n$ \u4e2a\u5e8f\u5217\u4e2d\u4e24\u4e24\u662f\u8840\u7f18\u5e8f\u5217\u7684\u603b\u4e2a\u6570\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a\n- $1 \\leq n \\leq 8000$\n\n\u601d\u8003\u8fc7\u7a0b\uff1a\n\n\u9996\u5148\uff0c\u6211\u4eec\u5148\u8003\u8651\u6734\u7d20\u7684\u66b4\u529b\uff0c\u679a\u4e3e\u4e24\u6b21\u4ea4\u6362\u7684\u56db\u4e2a\u4e0d\u540c\u4f4d\u7f6e\uff0c\u518d\u8fdb\u884c\u66b4\u529b\u5224\u65ad\u4e24\u4e24\u5e8f\u5217\u4e4b\u95f4\u662f\u5426\u5408\u6cd5\uff0c\u53bb\u91cd\u3002\u7531\u4e8e\u6bcf\u4e00\u4e2a\u5143\u7d20\u4f4d\u7f6e\u4e0d\u540c\uff0c\u6240\u4ee5\u679a\u4e3e\u4f4d\u7f6e\u65f6\u5e76\u4e0d\u9700\u8981\u679a\u4e3e $8^4$ \u6b21\uff0c\u800c\u662f $C_8^4$ \u6b21\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u7ea6\u4e3a $O(C_8^4n^2)$ \u3002\u65f6\u95f4\u590d\u6742\u5ea6\u7206\u70b8\u3002\n\n\u7136\u540e\uff0c\u6211\u4eec\u8003\u8651\u4f18\u5316\uff0c\u7531\u4e8e\u6bcf\u4e2a\u5143\u7d20\u53ea\u53ef\u80fd\u6709\u56db\u79cd\u4e0d\u540c\u60c5\u51b5\uff0c\u4e00\u4e2a\u5e8f\u5217\u603b\u5171\u516b\u4e2a\u5143\u7d20\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u538b\u6210\u4e00\u4e2a\u56db\u8fdb\u5236\u6570\uff0c\u7136\u540e\u7528 $vis$ \u6570\u7ec4\u8bb0\u5f55\u4f4d\u7f6e\uff0c\u53bb\u91cd\u5373\u53ef\uff0c\u4f5c\u8005\u4e3a\u4e86\u5077\u61d2\uff0c\u7528\u4e86STL\u91cc\u7684 $map$ \u3002\n\n\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u7ea6\u4e3a $O(C_8^4n)=O(1680n)$ \uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,a[8005],b[8005][9],mul[9],vis[70005],ans;\nchar c[9];\nmap<int,int>vis2[8005];\nvoid check(int w,int x,int y,int z){\n\tint temp;\n\tfor(int i=1;i<=n;i++){\n\t\ttemp=a[i]-mul[w]*b[i][7-w]+mul[x]*b[i][7-w]-mul[x]*b[i][7-x]+mul[w]*b[i][7-x];\n\t\ttemp=temp-mul[y]*b[i][7-y]+mul[z]*b[i][7-y]-mul[z]*b[i][7-z]+mul[y]*b[i][7-z];\n\t\tif(temp!=a[i]&&vis[temp]&&!vis2[i][temp])ans++,vis2[i][temp]=1;\n\t}\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%s\",c);\n\t\tfor(int j=0;j<8;j++){\n\t\t\ta[i]=a[i]*4;\n\t\t\tif(c[j]=='A')b[i][j]=0;\n\t\t\telse if(c[j]=='T')a[i]++,b[i][j]=1;\n\t\t\telse if(c[j]=='C')a[i]=a[i]+2,b[i][j]=2;\n\t\t\telse a[i]=a[i]+3,b[i][j]=3;\n\t\t}\n\t\tvis[a[i]]=1;\n\t}\n\tmul[0]=1;\n\tfor(int i=1;i<=7;i++)mul[i]=mul[i-1]*4;\n\tfor(int i=0;i<8;i++){\n\t\tfor(int j=i;j<8;j++){\n\t\t\tif(i==j)continue;\n\t\t\tfor(int k=i;k<8;k++){\n\t\t\t\tif(i==k||j==k)continue;\n\t\t\t\tfor(int l=k;l<8;l++){\n\t\t\t\t\tif(i==l||j==l||k==l)continue;\n\t\t\t\t\tcheck(i,j,k,l);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\",ans/2);\n\treturn 0;\n}\n```\n",
        "postTime": 1578714840,
        "uid": 85514,
        "name": "\u4e07\u4e07\u6ca1\u60f3\u5230",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P2547 [AHOI2004]DNA\u53d8\u5f02"
    },
    {
        "content": "\u7528\u7684\u662f\u5341\u5206\u7b80\u5355\u7684\u65b9\u6cd5\n\n\u8840\u7f18\u5e8f\u5bf9\uff08S1, S2\uff09\u5fc5\u5b9a\u6709\u76f8\u540c\u7684A\u3001T\u3001C\u3001G\u6570\uff0c\u53ea\u9700\u5728\u5177\u6709\u76f8\u540cATCG\u6570\u7684DNA\u4e2d\u5bfb\u627e\u8840\u7f18\u5e8f\u5bf9\u3002\n\n\u4ee3\u7801:\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n\nusing namespace std;\nconst int chag[4][5] = {{1, 0, 3, 2}, {2, 3, 0, 1}, {3, 2, 1, 0}};\n//\u6709\u4e24\u5bf9\u4e0d\u540c\u78b1\u57fa\u4ea4\u6362\u7684\u4e09\u79cd\u60c5\u51b5\n\nstruct DNA\n{\n    int s[10];\n    int n;\n    \n    bool operator < (const DNA& dna) const\n    {   \n        const DNA& A = (*this);\n        const DNA& B = dna;\n        if (A.n < B.n) return true; \n        if (A.n > B.n) return false; \n        \n        for (int i = 1; i <= 8; i++)\n        {\n            if (A.s[i] < B.s[i]) return true;\n            if (A.s[i] > B.s[i]) return false;\n        }\n        return false;\n    }\n};\n\nint N;\nDNA A[8010];\n\n//\u78b1\u57fa\u8f6c\u6570\u5b57\ninline int AP(char c)\n{\n    switch(c)\n    {\n        case 'A': return 0;\n        case 'T': return 1;\n        case 'C': return 2;\n        case 'G': return 3;\n    }\n    return 4;\n}\n\n//\u5f97\u51fa[l, r]\u4e2d\u8840\u7f18\u5e8f\u5bf9\u4e2a\u6570\nint getPair(int l, int r)\n{    \n    int ans = 0;\n    for (int i = l; i <= r; i++)\n        for (int j = i + 1; j <= r; j++)\n        {\n            int n[9][2], t = 0, AGCT[5];\n            memset(n, 0, sizeof(n));\n            memset(AGCT, 0, sizeof(AGCT));\n            \n            //\u8bb0\u5f55\u4e0d\u540c\u5904\n            for (int k = 1; k <= 8; k++)\n                if (A[i].s[k] != A[j].s[k])\n                    n[t][0] = A[i].s[k], n[t][1] = A[j].s[k], t++;\n                else AGCT[A[i].s[k]]++;\n                    \n            switch (t)\n            {\n                case 2:\n                {\n                    if (n[0][0] == n[1][1] && n[1][0] == n[0][1])\n                        if (AGCT[0] > 1 || AGCT[1] > 1 ||\n                            AGCT[2] > 1 || AGCT[3] > 1)\n                            ans++;\n                    //\u6709\u4e24\u4e2a\u4e0d\u540c\u78b1\u57fa\u4ea4\u6362\uff0c\u4e24\u4e2a\u76f8\u540c\u4ea4\u6362\n                    break;\n                }\n                case 4:\n                {\n                    for (int k = 0; k < 3; k++)\n                    {\n                        int m;\n                        for (m = 0; m < 4; m++)\n                            if (n[m][0] != n[chag[k][m]][1])\n                                break;\n                \n                        if (m >= 4)\n                        { ans++; break; }\n                    }\n                    //\u6709\u4e24\u5bf9\u4e0d\u540c\u78b1\u57fa\u4ea4\u6362\n                    break;\n                }\n            }\n        }\n    return ans;\n}\n\nint main()\n{\n    scanf(\"%d\", &N);\n    for (int i = 1; i <= N; i++)\n    {\n        int AGCT[5];\n        memset(AGCT, 0, sizeof(AGCT));\n        \n        char str[10]; scanf(\"%s\", str);\n        for (int j = 1; j <= 8; j++)\n        {\n            char c = str[j - 1];\n            A[i].s[j] = AP(c);\n            AGCT[AP(c)]++;\n            //\u8bb0\u5f55AGCT\u6570\n        }\n        A[i].n = (AGCT[3] << 9) + (AGCT[2] << 6)\n               + (AGCT[1] << 3) + AGCT[0];\n        //\u5c06DNA AGCT\u6570\u8f6c\u4e3a\u516b\u8fdb\u5236\u6570\n    }\n    \n    sort(A + 1, A + N + 1);\n    \n    int ans = 0;\n    int p = 1, q = 1;\n    while (p <= N)\n    {\n        while (A[p].n == A[++q].n && q <= N) {}\n        ans += getPair(p, q - 1);\n        //\u53d6\u5f97AGCT\u6570\u76f8\u540c\u7684DNA\u8840\u7f18\u5e8f\u5bf9\u6570\n        p = q;\n    }\n    printf(\"%d\\n\", ans);\n    return 0;\n}\n\n```",
        "postTime": 1550398870,
        "uid": 73562,
        "name": "0x80mem",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2547 \u3010[AHOI2004]DNA\u53d8\u5f02\u3011"
    },
    {
        "content": "# [\u5728\u672c\u4ebaBlog\u98df\u7528\u66f4\u4f73](https://dilute.coding.me/2018/10/24/Solutions/Solution-Luogu2547/)\n\n\u8bf6\u2026\u2026\u4f3c\u4e4e\u6ca1\u6709C++\u7684\u9898\u89e3\n\n\u90a3\u672c\u849f\u84bb\u5c31\u6765\u6c34\u4e00\u53d1\u4e86QwQ\n\n\u9996\u5148\u6211\u4f5c\u4e3a\u4e00\u4e2a\u849f\u84bb\uff0c\u62ff\u5230\u5b57\u7b26\u4e32\u9898\uff0c\u9996\u5148\u770b\u770b\u80fd\u4e0d\u80fd\u65e0\u8111\u54c8\u5e0c\n\n\u7136\u540e\u4e8e\u662f\u6211\u4eec\u5c31\u53d1\u73b0\u4e86\u4e00\u4e2a\u7edd\u5999\u7684\u505a\u6cd5\uff1a\u66b4\u529b\u679a\u4e3e\u6bcf\u4e2a\u5b57\u7b26\u4e32\u80fd\u591f\u8f6c\u6362\u6210\u7684\u5b57\u7b26\u4e32\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u83b7\u5f97\u4e86$O(N * 8^4)$\u7684\u4f18\u79c0\u590d\u6742\u5ea6\n\n\u663e\u7136\u4f1aT\u98deQwQ\n\n\u6211\u4eec\u8003\u8651\u518d\u8fd9\u4e2a\u57fa\u7840\u4e0a\u8fdb\u884c\u4f18\u5316\n\n\u6211\u4eec\u4f1a\u53d1\u73b0\u5982\u679c\u6211\u4eec$O(8^4)$\u679a\u4e3e\u7684\u8bdd\uff0c\u5176\u4e2d\u6709\u4e00\u5927\u90e8\u5206\u679a\u4e3e\u51fa\u6765\u7684\u72b6\u6001\u90fd\u662f\u91cd\u590d\u7684\n\n\u90a3\u4e48\u6211\u4eec\u601d\u8003\uff1a\u8fd9\u5176\u4e2d\u6709\u591a\u5c11\u4e2a\u72b6\u6001\u662f\u6709\u7528\u7684\u5462\n\n\u9996\u5148\u6211\u4eec\u5047\u8bbe\u6211\u4eec\u5c06$s_a, s_b$\u4ea4\u6362\uff0c$s_c, s_d$\u4e92\u6362\uff08$a,b,c,d\\in [1, 8] $, $a \\neq b \\neq c \\neq d$\uff09\u540c\u65f6\u6211\u4eec\u4ee4$a < b $ \u4e14 $c < d$\n\n\u90a3\u4e48\u6211\u4eec\u4f1a\u53d1\u73b0\u6700\u7ec8\u53ea\u6709$C_8^4 * 3$\u79cd\u53ef\u80fd\u662f\u53ef\u884c\u7684\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u628a\u8fd9\u4e9b\u9884\u5904\u7406\u51fa\u6765\uff0c\u90a3\u4e48\u6211\u4eec\u5728\u540e\u9762\u679a\u4e3e\u7684\u65f6\u5019\u53ea\u9700\u8981\u5728\u8fd9\u4e9b\u72b6\u6001\u4e2d\u53d6\u5c31\u884c\u4e86\n\n\u6700\u7ec8\u590d\u6742\u5ea6$O(N * C_8^4 * 3 * 8)$\uff0c\uff08\u6700\u540e\u76848\u662fHash\u7684\u590d\u6742\u5ea6\uff09\u4f50\u4ee5\u4f18\u79c0\u7684\u5e38\u6570\u4fbf\u53efAC\u6b64\u9898\u3002\n\n```cpp\n// Sooke bless me.\n// LJC00118 bless me.\n#include<bits/stdc++.h>\n\nusing namespace std;\n\n#define INF 2147483647\n#define ll long long\n\nint Inp(){\n\tchar c = getchar();\n\tregister int Neg = 1;\n\twhile(c < '0' || c > '9'){\n\t\tif(c == '-')\n\t\t\tNeg = -1;\n\t\tc = getchar();\n\t}\n\tregister int Sum = 0;\n\twhile(c >= '0' && c <= '9'){\n\t\tSum = ((Sum << 3) + (Sum << 1)) + c - '0';\n\t\tc = getchar();\n\t}\n\treturn Neg * Sum;\n}\n\nstring s[10010];\nbool Used[20];\n\nbool cg[10000000];\n\ninline int Hash(string s){\n\tint Sum = 0;\n\tfor(int i = 0; i < 8; i++){\n\t\tSum <<= 2;\n\t\tswitch(s[i]){\n\t\t\tcase 'A':{\n\t\t\t\tSum += 1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'C':{\n\t\t\t\tSum += 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'T':{\n\t\t\t\tSum += 3;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn Sum;\n}\n\nint Hsh[10000];\nint sa[1010];\nint sb[1010];\nint C_swap;\n\nint main(){\n\tregister int n = Inp();\n\tfor(register int i = 1; i <= n; i++)\n\t\tcin >> s[i], Hsh[i] = Hash(s[i]);\n\tfor(register int j1 = 0; j1 < 8; j1++){\n\t\tUsed[j1] = true;\n\t\tfor(register int j2 = j1 + 1; j2 < 8; j2++){\n\t\t\tif(Used[j2])\n\t\t\t\tcontinue;\n\t\t\tUsed[j2] = true;\n\t\t\tsa[++C_swap] = j1;\n\t\t\tsb[C_swap] = j2;\n\t\t\tUsed[j2] = false;\n\t\t}\n\t\tUsed[j1] = false;\n\t}\n\tregister int Ans = 0;\n\tfor(register int i = 1; i <= n; i++){\n\t\t\n\t\tfor(int j = 1; j <= C_swap; j++)\n\t\t\tfor(int u = j + 1; u <= C_swap; u++){\n\t\t\t\tif(sa[j] == sa[u] || sb[j] == sb[u] || sa[j] == sb[u] || sb[j] == sa[u])\n\t\t\t\t\tcontinue;\n\t\t\t\tstring s2 = s[i];\n\t\t\t\tswap(s2[sa[j]], s2[sb[j]]);\n\t\t\t\tswap(s2[sa[u]], s2[sb[u]]);\n\t\t\t\tcg[Hash(s2)] = true;\n\t\t\t}\n\t\tfor(register int j = i + 1; j <= n; j++) \n\t\t\tif(cg[Hsh[j]])\n\t\t\t\tAns++, cg[Hsh[j]] = false;\n\t}\n\tprintf(\"%d\", Ans);\n}\n\n```",
        "postTime": 1540210093,
        "uid": 36362,
        "name": "Dilute",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2547 \u3010[AHOI2004]DNA\u53d8\u5f02\u3011"
    },
    {
        "content": "~~\u62a2fb.~~\n\n**\u9898\u610f**.\u7ed9\u51fa$n$\u4e2aDNA\u5e8f\u5217.\u82e52\u4e2aDNA\u5e8f\u5217\u53ef\u4ee5\u901a\u8fc7\u53d8\u5f02\u4e92\u76f8\u5f97\u5230.\u5219\u89c6\u4e3a1\u5bf9\u8840\u7f18\u5173\u7cfb.\u6c42\u8840\u7f18\u5173\u7cfb\u603b\u6570.\n\nDNA\u5e8f\u5217:\u75318\u4e2a\u57fa\u56e0\u6bb5\u6784\u6210.\u57fa\u56e0\u6bb5\u53ef\u80fd\u4e3a$A,T,C,G$\u4e2d\u76841\u4e2a.\n\n\u53d8\u5f02:\u82e51\u4e2aDNA\u5e8f\u5217\u53d1\u751f2\u6b21\u4ea4\u6362.\u6bcf\u6b21\u90fd\u90092\u4e2a**\u4e0d\u540c**\u4e14**\u6ca1\u6709\u4ea4\u6362\u8fc7**\u7684\u57fa\u56e0\u6bb5\u4ea4\u6362.\u8fc7\u7a0b\u79f0\u4e3a\u53d8\u5f02.\n\n\u7531\u4e8e\u53ea\u67098\u4e2a\u4f4d\u7f6e.\u4ec5\u4ec5\u4ea4\u63622\u6b21.\u53ef\u4ee5\u66b4\u529b\u679a\u4e3e\u6bcf\u4e2a\u5e8f\u5217\u7684\u4ea4\u6362\u4f4d\u7f6e.\n\n\u597d\u50cf\u53ea\u67091680\u79cd..\n\n\u53ef\u4ee5\u53d1\u73b0,DNA\u5e8f\u5217\u6700\u591a\u53ea\u6709$4^8 = 65536$\u79cd..\n\n\u628aDNA\u5e8f\u5217\u5f53\u505a4\u8fdb\u5236\u53d8\u6210\u6570\u5b57\u50a8\u5b58.\u53ef\u4ee5$O(1)$\u5224\u65ad\u5e8f\u5217\u662f\u5426\u5b58\u5728..\n\n\u81f3\u4e8e\u4ea4\u6362\u8fc7\u7a0b.\u8f6c\u5316\u6210\u4e86\u6570.\u5c31\u53ef\u4ee5\u52a0\u51cf\u5bf9\u5e94\u7684\u503c\u4e86..\n\n\u8bbe\u4ea4\u6362\u4f4d\u7f6e$p,p1$.\u5e8f\u5217\u7684\u6570\u4e3a$ssum$.\u6574\u4e2a\u5e8f\u5217\u4e3as.\u5219:\n\n$ssum\\;-= (s_p*4^{8-p}+s_{p1}*4^{8-p1}) - (s_p*4^{8-p1}+s_{p1}*4^{8-p})$.\n\n\u7136\u540e\u5224\u65ad$ssum$\u662f\u5426\u5b58\u5728\u5c31\u53ef\u4ee5\u4e86..\n\n\u6700\u540e.\u4e2d\u95f4\u53ef\u80fd\u51fa\u73b0\u91cd\u590d\u7684.\u6570\u7ec4\u6807\u8bb0..\u53bb\u6389\u5c31\u884c\u4e86..\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(1680n)$.\u7a7a\u95f4$O(5n)$.\n\nDiu\u4ee3\u7801..\n\n```cpp\nprogram P2547;\n var\n  d,b:array[0..100001] of longint;\n  c:array[0..8001] of longint;\n  p:Array[0..8001] of int64;\n  s:array[0..8001] of string;\n  dp:array['A'..'Z'] of longint;\n  dp2:array[1..8] of longint=(16384,4096,1024,256,64,16,4,1);\n  i,j,k,l,m,n,o,pc,t,ss,ssum:longint;\n function hahahash(k,u:int64):longint; //\u524d\u8eab\u662f\u54c8\u5e0c(Tle)..\n  var                                    //\u73b0\u5728\u7528\u6765\u76f4\u63a5\u5224\u65ad.\n   o:longint;\n  begin\n   if u=0 then\n    if d[k]=1008208820 then d[k]:=1;   //\u8bf4\u660e\u6709\u8fd9\u4e2a\u5e8f\u5217..\n   if u>0 then\n    if (d[k]=1) and (b[k]<>u) then     //\u5e8f\u5217\u5b58\u5728.\u4e14\u662f\u5f53\u524d\n     begin                               //\u8fd9\u4e2a\u5e8f\u5217\u7b2c1\u6b21\u4ea7\u751f\u7684.\n      b[k]:=u;                         //\u6807\u8bb0\u4e3a\u4e0d\u662f\u7b2c1\u6b21\u4ea7\u751f.\n      exit(k);\n     end\n                              else exit(1008208820);  //..\n  end;\n procedure hahaswap(k,x,y,x1,y1:longint); //\u5f97\u51fa\u4ea4\u6362\u4f4d\u7f6e\u540e\u7684\u5e8f\u5217\u503c.\n  begin\n   dec(p[k],dp2[x1]*dp[s[k,x]]+dp2[y1]*dp[s[k,y]]); //\u76f8\u5f53\u4e8e\u5148\u8d4b\u503c\u62100.\n   inc(p[k],dp2[x1]*dp[s[k,y]]+dp2[y1]*dp[s[k,x]]); //\u518d\u52a0\u56de\u6765..\n  end;\n begin\n  dp['A']:=0;\n  dp['C']:=1;\n  dp['T']:=2;\n  dp['G']:=3;                             //\u4ee3\u8868\u6570\u5b57..\n  filldword(d,length(d),1008208820);      //\u4ee5\u6570\u5b57\u5f62\u5f0f\u5b58\u653e\u5e8f\u5217..\n  filldword(b,length(b),0);               //\u7528\u6765\u5224\u91cd..\n  readln(n);\n  for i:=1 to n do\n   begin\n    readln(s[i]);\n    p[i]:=0;                              //\u5f53\u524d\u5e8f\u5217\u4ee3\u8868\u7684\u503c..\n    for j:=1 to 8 do\n     p[i]:=p[i]*4+dp[s[i,j]];             //\u5f53\u62104\u8fdb\u5236..\n    t:=hahahash(p[i],0);\n   end;\n  ssum:=0;\n  for i:=1 to n do\n   begin\n    for j:=1 to 8 do\n     for k:=1 to 8 do\n      for l:=1 to 8 do\n       for m:=1 to 8 do                   //\u5927\u529b\u679a\u4e3e..\n        if (j<>k) and (j<>l) and (j<>m) and (k<>l) and (k<>m) and (l<>m) then\n         begin\n          hahaswap(i,j,k,j,k);\n          hahaswap(i,l,m,l,m);\n          if hahahash(p[i],i)<>1008208820 then inc(ssum); //\u6210\u529f\u5339\u914d..\n          hahaswap(i,k,j,j,k);\n          hahaswap(i,m,l,l,m);\n         end;\n    dec(ssum);       //\u7279\u522b\u6ce8\u610f.\u7531\u4e8e1\u4e2a\u5e8f\u5217\u81f3\u5c11\u67092\u5bf9\u76f8\u540c\u7684\u57fa\u56e0.\n   end;                //\u81ea\u5df1\u4e0e\u81ea\u5df11\u5b9a\u80fd\u6210\u4e3a\u8840\u7f18\u5173\u7cfb..\u5e94\u5f53\u51cf\u6389..\n  writeln(ssum>>1);\n end.\n```\n(\u0ca1\u03c9\u0ca1).\n",
        "postTime": 1514450418,
        "uid": 20454,
        "name": "BFSBFSBFSBFS",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2547 \u3010[AHOI2004]DNA\u53d8\u5f02\u3011"
    }
]
[
    {
        "content": "#### \u524d\u8a00\n\n\u88ab\u5355\u8c03\u6808\u641e\u61f5\u7684\u7b2c $n$ \u5929\n\n#### \u601d\u8def\n\n\u5bf9\u4e8e\u8fd9\u4e2a\u9898\uff0c\u6838\u5fc3\u601d\u8def\u5c31\u662f\u8981\u5224\u65ad\u4e24\u4e24\u5706\u7684\u76f8\u5207\n\n\u56e0\u4e3a\u4f4d\u7f6e\u662f\u5355\u8c03\u9012\u589e\u7684\uff0c\u6240\u4ee5\u8bf4\u505a\u8fd9\u9053\u9898\u66f4\u52a0\u7b80\u4fbf\u4e86 \n\n\u90a3\u4e48\u5bf9\u4e8e\u5728\u5e73\u9762\u5185\u7684\u4e24\u4e2a\u5706 $A(x_i,y_i)$ \u534a\u5f84\u4e3a$r_i$, $B(x_j,y_j)$ ,\u534a\u5f84\u4e3a $r_j$ \u76f8\u5207(\u6216\u8005\u4e0d\u76f8\u4ea4)\u7684\u6761\u4ef6$(i>j)$\u4e3a\n\n$$(x_i-x_j)^2+(y_i-y_j)^2 \\geq (r_i+r_j)^2$$\n\n\u5316\u7b80\u53ef\u5f97 \n\n$$r_i\\leq\\frac{(x_i-x_j)^2}{4r_j}$$\n\n\u6574\u5408\u4e0a\u9762\u4e24\u4e2a\u516c\u5f0f\u53ef\u5f97\n\n$$r_i=\\min_{1\\leq j<i}(\\frac{(x_i-x_j)^2}{4r_i})$$\n\n\u8003\u8651\u7528\u5355\u8c03\u6808\u6765\u6c42\u89e3\n\n#### \u8bc1\u660e\n\n\u5bf9\u4e8e\u5355\u8c03\u6808\u4e2d\u7684\u5143\u7d20 $i<j$ \u6765\u8bf4\uff0c\u5047\u8bbe\u4e00\u4e2a\u70b9 $i<j<k$ ,\u5982\u679c$r_k<r_j$ \u90a3\u4e48 $k$ \u4e00\u5b9a\u4e0d\u4f1a\u53d7\u5230 $i$ \u7684\u5f71\u54cd\n\n\u901a\u8fc7\u4e0a\u9762\u7684\u5b9a\u7406\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u6761\u4ef6\uff1a\n\n$r_k<r_j<\\dfrac{(x_j-x_i)^2}{4r_i}<\\dfrac{(x_k-x_i)^2}{4r_i}$\n\n\u5373 $r_k<\\dfrac{(x_k-x_i)^2}{4r_i}$ \u7684\u65f6\u5019\uff0c$k$ \u5c31\u4e0d\u4f1a\u53d7\u5230 $j$ \u4e4b\u524d\u7684\u6c14\u7403\u7684\u5f71\u54cd\n\n\u90a3\u4e48\u53ef\u4ee5\u7528\u5355\u8c03\u6808\u5b9e\u73b0\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n\n- \u53d6\u51fa\u6808\u9876 $j$ \n\n- \u5982\u679c $r_k<r_j$ \u4e0d\u53d7\u4e4b\u524d\u7684\u5f71\u54cd,\u52a0\u5165\u6808\u9876\n\n- \u4e3a\u4e86\u7ef4\u62a4\u5355\u8c03\u6808\u662f\u9012\u589e\u7684\uff0c\u5982\u679c$r_k>r_j$,\u5f39\u51fa\u6808\u9876 $j$ \u4fdd\u8bc1\u9012\u589e\uff0c\u8fd4\u56de\u7ee7\u7eed\u5faa\u73af\u6267\u884c\u4e09\u4e2a\u64cd\u4f5c\n\n#### \u4ee3\u7801\n\n```\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<map>\n#include<algorithm>\n#include<map>\n#include<cmath>\nusing namespace std;\nconst int N=2e5+9;\ndouble r[N];// \ndouble x[N];//\u7b2ci\u4e2a\u6c14\u7403\u4e0e\u5730\u9762\u5728x_i\u7684\u4f4d\u7f6e\u76f8\u9047 \nint stk[N];\nint top,n;\nint main()\n{\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;i++)\n        scanf(\"%lf%lf\",&x[i],&r[i]);\n    for(int i=1;i<=n;i++)\n    {\n        while(top>0)\n        {\n            int di=stk[top];\n            double dis=(x[i]-x[di])*(x[i]-x[di])/(4.0*r[di]);\n            r[i]=min(r[i],dis);\n            if(r[i]<=r[di]) break;//\u5fc5\u987b\u4fdd\u8bc1\u5355\u8c03\u9012\u589e \n            top--;\n        }\n        stk[++top]=i;\n        printf(\"%.4lf\\n\",r[i]); \n    }\n    return 0;\n} \n```\n\n\n\n",
        "postTime": 1612360718,
        "uid": 230804,
        "name": "Durancer",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P4697 \u3010[CEOI2011]Balloons\u3011"
    },
    {
        "content": "#### [$\\large \\color{#ff7daf}\\texttt{CEOI2011 Balloons}$](https://xc.fubuki.cn/2019/CEOI2011Balloons)\n\n\u5148\u819c\u62dc\u968f\u673a\u8fc7\u9898\u7684\u5927\u4f6c [$\\texttt{Alpha}$](https://www.luogu.org/space/show?uid=87058) \u3002\n\n\u82e5\u5706 $i$ \u4e0e\u5706 $j$ \u76f8\u5207\uff0c\u5219 $r_i=\\frac{(x_i-x_j)^2}{4r_j}$ \uff1b\u82e5\u5b58\u5728 $i,j$ \u6ee1\u8db3 $x_i>x_j,r_i>r_j$ \uff0c\u5219\u5706 $j$ \u4e00\u5b9a\u4e0d\u4f1a\u5bf9\u540e\u52a0\u5165\u7684\u70b9\u4ea7\u751f\u6709\u6548\u9650\u5236\u3002\u56e0\u4e3a\u9898\u76ee\u4fdd\u8bc1 $x$ \u9012\u589e\uff0c\u6240\u4ee5\u8fd9\u91cc\u80fd\u7528\u4e00\u4e2a\u5355\u8c03\u6808\u8f7b\u677e\u7ef4\u62a4\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u51b3\u7b56\u3002\u4e0d\u96be\u53d1\u73b0\uff0c\u82e5\u5b58\u5728 $j$ \u6ee1\u8db3 $R(i, j)\\leq r_j$ \uff08\u5176\u4e2d $R(i, j)$ \u8868\u793a\u5706 $i$ \u4e0e\u5706 $j$ \u76f8\u5207\u65f6\u7684 $r_i$ \uff09\uff0c\u5219\u6240\u6709 $j$ \u4e4b\u524d\u7684\u5706\u4e0d\u4f1a\u5bf9 $i$ \u4ea7\u751f\u6709\u6548\u9650\u5236\uff1b\u82e5 $R(i, j)>r_j$ \uff0c\u5219\u8be5\u9650\u5236\u53ef\u80fd\u662f\u4e00\u4e2a\u6709\u6548\u9650\u5236\uff0c\u5e76\u4e14\u4e00\u5b9a\u6709 $r_i > r_j$ \uff0c\u53ef\u4ee5\u76f4\u63a5\u4ece\u6808\u4e2d\u5220\u53bb $j$ \u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$ \uff0c\u8bc1\u660e\u7565\uff08\u5176\u5b9e\u633a\u663e\u7136\u7684????\uff09\n\n```cpp\n\n#include <cstdio>\n\n#define maxn 200005\n\nint n, stk[maxn], top;\ndouble r[maxn], x[maxn];\n\nint main()\n{\n    freopen(\"test.in\", \"r\", stdin);\n    freopen(\"test.out\", \"w\", stdout);\n    scanf(\"%d\", &n);\n    for (int i = 1; i <= n; ++i)\n    {\n        scanf(\"%lf%lf\", &x[i], &r[i]);\n        while (top > 0)\n        {\n            int j = stk[top];\n            double now = (x[i] - x[j]) / 4.0 / r[j] * (x[i] - x[j]);\n            r[i] = now < r[i] ? now : r[i];\n            if (r[i] <= r[j])\n                break;\n            else\n                --top;\n        }\n        stk[++top] = i;\n        printf(\"%.6lf\\n\", r[i]);\n    }\n    return 0;\n}\n\n```",
        "postTime": 1558574878,
        "uid": 32831,
        "name": "\u5439\u96ea\u5439\u96ea\u5439",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4697 \u3010[CEOI2011]Balloons\u3011"
    },
    {
        "content": "\u7ffb\u9605\u4e86\u7f51\u4e0a\u5c48\u6307\u53ef\u6570\u7684\u9898\u89e3\uff0c\u4f3c\u4e4e\u90fd\u6ca1\u6709\u63d0\u5230\u51b3\u7b56\u7684\u5355\u8c03\u6027\u7684\u8bc1\u660e\uff1b\u56e0\u6b64\u672c\u4eba\u4e8e\u6b64\u8865\u4e0a\u8bc1\u660e\u3002\n\n\u5bf9\u4e8e\u53ea\u60f3\u770b\u770b\u51b3\u7b56\u5355\u8c03\u6027\u8bc1\u660e\u7684\u4eba\uff0c\u8bf7\u624b\u52a8\u7ffb\u5230\u4e0b\u9762\u7684**\u8bc1\u660e 2** \u4e00\u8282\u3002\n\n\u5bf9\u4e8e\u60f3\u8981\u5230\u6211\u7684\u6d1b\u8c37\u535a\u5ba2\u67e5\u770b\u7684\u4eba\uff0c\u8bf7\u5230[\u8fd9\u91cc](https://www.luogu.com.cn/blog/moonoshawott/loj2487)\u3002\n\n---\n\n\u524d\u7f6e\u77e5\u8bc6\uff1a\u4ee5\u70b9 $A$ \u4e3a\u5706\u5fc3\u7684\u534a\u5f84\u4e3a $r_A$ \u7684\u5706\uff0c\u4e0e\u4ee5\u70b9 $B$ \u4e3a\u5706\u5fc3\u7684\u534a\u5f84\u4e3a $r_B$ \u7684\u5706\u4e0d\u76f8\u4ea4\u7684\u5145\u8981\u6761\u4ef6\u662f\n\n$$\\text{dis}(A, B) \\geq r_A + r_B$$\n\n\u5176\u4e2d $\\text{dis}(A, B)$ \u8868\u793a\u70b9 $A$ \u5230\u70b9 $B$ \u7684\u8ddd\u79bb\uff0c$\\text{dis}(A, B) = \\sqrt {(x_A - x_B)^2 + (y_A - y_B)^2}$\u3002\n\n---\n\n\u5bf9\u4e8e $j < i$\uff0c\u5706 $j$ \u548c\u5706 $i$ \u4e0d\u76f8\u4ea4\u7684\u5145\u8981\u6761\u4ef6\u662f\n\n$$\n\\begin{aligned}\n\t(r_i - r_j)^2 + (x_i - x_j)^2 &\\geq (r_i + r_j)^2 \\\\\n\t(x_i - x_j)^2 &\\geq 4r_ir_j \\\\\n\tr_i &\\leq \\frac {(x_i - x_j)^2}{4r_j} \\ \\\\\n\\end{aligned}\n$$\n\n\u5728\u6ca1\u6709\u9650\u5236\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5f97\u5230\n\n$$r_i = \\min_{1 \\leq j < i} \\left\\{\\frac {(x_i - x_j)^2}{4r_j}\\right\\}$$\n\n\u8003\u8651\u5982\u4f55\u6c42\u89e3\u3002\n\n**\u5b9a\u7406 1**\uff1a\u82e5 $x_i < x_j$ \u4e14 $r_i \\leq r_j$\uff0c\u5219\u5706 $i$ \u4e00\u5b9a\u4e0d\u4f1a\u5f71\u54cd\u5230 $j$ \u540e\u9762\u7684\u5706\u3002\u5373\uff0c\u5bf9\u4e8e $k > j$ \u6709\n\n$$\\frac {(x_k - x_j)^2}{4r_j} < \\frac {(x_k - x_i)^2}{4r_i}$$\n\n**\u8bc1\u660e 1**\uff1a\u663e\u7136\u6709 $(x_k - x_j)^2 < (x_k - x_i)^2$ \u4e14 $r_j > r_i$\uff0c\u6613\u8bc1\u3002\n\n\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u5ffd\u7565\u5706 $i$\u3002\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a\u5355\u8c03\u6808\u7ef4\u62a4\u5b83\uff0c\u4f7f\u6808\u5185\u4ece\u9876\u5230\u5e95 $x_i$ \u5355\u8c03\u4e0b\u964d\u4e14 $r_i$ \u5355\u8c03\u4e0a\u5347\u3002\n\n\u4e0b\u9762\u8003\u8651\u5982\u4f55\u51b3\u7b56\u3002\n\n**\u5b9a\u7406 2**\uff1a\u5bf9\u4e8e\u6808\u5185\u5143\u7d20 $i < j$ \u548c\u5f53\u524d\u51b3\u7b56\u70b9 $k$\uff08$i < j < k$\uff09\uff0c\u82e5 $r_k < r_j$\uff0c\u5219 $r_k$ \u4e0d\u4f1a\u53d7\u5230 $i$ \u7684\u5f71\u54cd\u3002\n\n\u66f4\u76f4\u767d\u5730\uff0c\u82e5\u4e00\u4e2a\u6c14\u7403\u7684\u534a\u5f84\u6bd4\u524d\u9762\u67d0\u4e2a\u6c14\u7403 $j$ \u7684\u534a\u5f84\u5c0f\uff0c\u5219\u5b83\u4e0d\u4f1a\u53d7\u5230 $j$ \u524d\u9762\u6c14\u7403\u7684\u5f71\u54cd\u3002\n\n**\u8bc1\u660e 2**\uff1a\u8003\u8651\u8bc1\u660e $r_j < \\frac {(x_k - x_i)^2}{4r_i}$\u3002\u8fd9\u4e2a\u8bc1\u660e\u662f\u663e\u7136\u7684\uff1a\n\n$$r_k < r_j < \\frac {(x_j - x_i)^2}{4r_i} < \\frac {(x_k - x_i)^2}{4r_i}$$\n\n\u4e5f\u5c31\u662f $r_k < \\frac {(x_k - x_i)^2}{4r_i}$\uff0c\u5373 $r_k$ \u4e0d\u4f1a\u53d7\u5230 $j$ \u4e4b\u524d\u6c14\u7403 $i$ \u7684\u5f71\u54cd\u3002\n\n\u8fd9\u4e00\u70b9\u4fdd\u969c\u4e86\u6211\u4eec\u51b3\u7b56\u65f6\u53ea\u9700\u8981\u627e\u51fa\u6808\u9876\u8fdb\u884c\u51b3\u7b56\u5373\u53ef\uff1a\n\n1. \u53d6\u51fa\u6808\u9876 $j$ \u5bf9\u5f53\u524d\u51b3\u7b56\u70b9 $k$ \u8fdb\u884c\u51b3\u7b56\uff1b\n2. \u82e5 $r_k < r_j$\uff0c\u5219\u5b83\u4e0d\u4f1a\u53d7\u524d\u9762\u7684\u6c14\u7403\u7684\u5f71\u54cd\u4e86\u3002\u628a $r_k$ \u52a0\u5165\u6808\u9876\uff0c\u9000\u51fa\uff1b\n3. \u5426\u5219\u5f39\u51fa\u6808\u9876 $j$\uff08\u4e3a\u4e86\u7ef4\u62a4 $r_j$ \u9012\u589e\uff09\uff0c\u56de\u5230 1\u3002\n\n```plain\nstack.clear()\nfor i = 1 to n\n    while stack is not empty\n        j = stack.top\n        r[i] = min(r[i], (x[i] - x[j]) * (x[i] - x[j]) / 4 / r[j])\n        if r[i] < r[j] then\n            break\n        else\n            stack.pop()\n    stack.push(i)\n```\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(n)$\u3002",
        "postTime": 1595476640,
        "uid": 116137,
        "name": "\u5609\u7136\u5c0f\u59d0\u7684\u72d7",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4697 \u3010[CEOI2011]Balloons\u3011"
    },
    {
        "content": "\u9700\u8981\u638c\u63e1\u5355\u8c03\u6808\u7b97\u6cd5\u548c\u4e00\u70b9\u6570\u5b66\u57fa\u7840\u3002\n\n\u867d\u7136\u6c14\u7403\u662f\u4e09\u7ef4\u7269\u4f53\uff0c\u4f46\u662f\u6240\u6709\u6c14\u7403\u90fd\u6392\u5728\u540c\u4e00\u6761\u76f4\u7ebf\u4e0a\uff0c\u6240\u4ee5\u53ef\u4ee5\u7b80\u5316\u4e3a\u4e8c\u7ef4\u7684\u95ee\u9898\u3002\n\n\u8003\u8651\u4e24\u4e2a\u6c14\u7403\uff0c\u6c14\u7403 $1$ \u7684 $x$ \u5750\u6807\u4e3a $x_1$\uff0c\u534a\u5f84\u4e3a $r_1$\uff0c\u6c14\u7403 $2$ \u7684 $x$ \u5750\u6807\u4e3a $x_2$\uff0c\u534a\u5f84\u4e3a $r_2$\u3002\n\n![P4697-1](https://cdn.luogu.com.cn/upload/image_hosting/2s8m330g.png)\n\n\u56e0\u4e3a\u4e24\u5706\u76f8\u5207\u7684\u5145\u8981\u6761\u4ef6\u662f\u4e24\u5706\u5706\u5fc3\u7684\u8ddd\u79bb\u7b49\u4e8e\u4e24\u5706\u534a\u5f84\u4e4b\u548c\uff0c\n\n$\\therefore \\sqrt{(x_1-x_2)^2+(r_1-r_2)^2}=r_1+r_2$\n\n$\\therefore (x_1-x_2)^2+r_1^2+r_2^2-2r_1r_2=r_1^2+r_2^2+2r_1r_2$\n\n$\\therefore 4r_1r_2=(x_1-x_2)^2$\n\n$\\therefore r_2=\\frac{(x_1-x_2)^2}{4r_1}$\n\n![P4697-2](https://cdn.luogu.com.cn/upload/image_hosting/wjc2vrpr.png)\n\n\u663e\u7136\uff0c\u7b2c $i$ \u4e2a\u6c14\u7403\u7684\u534a\u5f84 $r_i=\\min\\limits_{j=1}^{i-1}\\frac{(x_i-x_j)^2}{r_j}$\u3002\u6ce8\u610f\u5230\u5982\u679c\u6c14\u7403 $1$ \u548c\u6c14\u7403 $2$ \u6ee1\u8db3 $x_1<x_2$ \u5e76\u4e14 $r_1\\leqslant r_2$\uff0c\u5219\u6c14\u7403 $2$ \u4e4b\u540e\u7684\u6c14\u7403\u90fd\u4e0d\u4f1a\u53d7\u5230\u6c14\u7403 $1$ \u7684\u5f71\u54cd\uff08\u88ab\u6c14\u7403 $2$ \u6321\u4f4f\u4e86\uff09\u3002\u56e0\u6b64\u8003\u8651\u7528\u5355\u8c03\u6808\u7ef4\u62a4\u53ef\u80fd\u5bf9\u4e4b\u540e\u6c14\u7403\u4ea7\u751f\u5f71\u54cd\u7684\u6c14\u7403\u3002\u5177\u4f53\u5730\uff0c\u5982\u679c\u5f53\u524d\u7684\u6808\u9876\u6c14\u7403\u7684\u534a\u5f84\u5c0f\u4e8e\u7b49\u4e8e\u5f53\u524d\u6c14\u7403\u7684\u534a\u5f84\uff0c\u5219\u628a\u6808\u9876\u6c14\u7403\u5f39\u51fa\u3002\n\n\u5230\u6b64\uff0c\u5f97\u51fa\u4e86\u6b64\u9898\u7684\u601d\u8def\u3002\n\n```\n#include <iostream>\n#include <cstdio>\nusing namespace std;\ntypedef long long ll;\ntypedef double db;\nll n,st[200001];\ndb x[200001],r[200001],ans[200001];\ninline db sq(db x){return x*x;}\ninline db calc(db x1,db r1,db x2){return sq(x2-x1)/r1/4;}//\u8ba1\u7b97\u6c14\u7403\u534a\u5f84\nint main()\n{\n\tscanf(\"%lld\",&n);\n\tfor(int i=1;i<=n;++i) scanf(\"%lf%lf\",&x[i],&r[i]);\n\tll top=0;\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tans[i]=r[i];\n\t\twhile(top>0)\n\t\t{\n\t\t\tans[i]=min(ans[i],calc(x[st[top]],ans[st[top]],x[i]));\n\t\t\tif(ans[st[top]]<=ans[i]) --top;//\u5f53\u524d\u6808\u9876\u6c14\u7403\u4e0d\u4f1a\u5bf9\u4e4b\u540e\u7684\u6c14\u7403\u4ea7\u751f\u5f71\u54cd\uff0c\u5c06\u5176\u5f39\u51fa\n\t\t\telse break;//\u6808\u4e2d\u6c14\u7403\u90fd\u6709\u53ef\u80fd\u5bf9\u4e4b\u540e\u7684\u6c14\u7403\u4ea7\u751f\u5f71\u54cd\n\t\t}\n\t\tst[++top]=i;//\u628a\u5f53\u524d\u6c14\u7403\u538b\u5165\u6808\u4e2d\n\t}\n\tfor(int i=1;i<=n;++i) printf(\"%.4lf\\n\",ans[i]);//\u9632\u6b62\u7cbe\u5ea6\u51fa\u73b0\u8bef\u5dee\uff0c\u591a\u8f93\u51fa\u4e00\u4f4d\n\treturn 0;\n}\n```",
        "postTime": 1657631124,
        "uid": 244009,
        "name": "TianTian2008",
        "ccfLevel": 0,
        "title": "P4697 \u9898\u89e3"
    },
    {
        "content": "## P4697 [CEOI2011] Balloons\n\n**\u3010\u9898\u610f\u3011**\n\n\u7ed9\u5b9a $n$ \u4e2a\u5706\uff0c\u5176\u4e2d\u7b2c $i$ \u4e2a\u5706\u7684\u5750\u6807\u4e3a $(x_i, r_i)$ (\u5bf9\u4e8e $r_i$ \u8868\u793a\u7684\u662f\u7b2c $i$ \u4e2a\u5706\u7684\u6700\u5927\u534a\u5f84\u9650\u5236)\uff0c\u8bbe\u7b2c $i$ \u4e2a\u5706\u7684\u5b9e\u9645\u534a\u5f84\u662f $r_i$ \u3002$r_i$ \u6ee1\u8db3\u5f53\u524d\u5706\u521a\u597d\u548c $i$ \u4e4b\u524d\u7684\u5706\u76f8\u5207\uff0c\u73b0\u8981\u6c42\u6c42\u51fa\u5bf9\u4e8e\u6bcf\u4e2a $i$ ($1 \\le i \\le n$) \u6c42\u51fa\u4e00\u4e2a\u6700\u5927\u7684 $r_i$ \u3002\n\n**\u3010\u5206\u6790\u3011**\n\n\u9996\u5148\u6839\u636e\u9898\u610f\uff0c\u80fd\u591f\u5f71\u54cd $r_i$ \u7684\u503c\u7684\u53ea\u6709\u5728 $i$ \u4e4b\u524d\u7684\u5706\u3002\n\n\u82e5\u8003\u8651\u76f4\u63a5\u679a\u4e3e\u4e0a\u4e00\u4e2a\u5706 $j$, \u5219\u663e\u7136\u6709\uff1a\n$$\nr_i = \\min\\limits_{1\\le j < i} \\left(\\sqrt{(x_i - x_j)^2+(r_i-r_j)^2} - r_j\\right)\n$$\n$$\n(r_i+r_j)^2 = (x_i - x_j) ^2 + (r_i - r_j)^2\n$$\n$$\n4r_ir_j = (x_i-x_j)^2\n$$\n$$\nr_i=\\frac{(x_i-x_j)^2}{4r_j}\n$$\n$$\nr_i = \\min\\limits_{1\\le j < i}\\left(\\frac{(x_i-x_j)^2}{4r_j}\\right)\n$$\n\u6b64\u65f6\u76f4\u63a5\u679a\u4e3e\u7684\u6548\u7387\u5c31\u662f $O(n^2)$ \uff0c\u8003\u8651\u7ee7\u7eed\u4f18\u5316\u3002\n\n**\u5355\u8c03\u6808\uff1a**\n\n\u89c2\u5bdf\u5f0f\u5b50\u53d1\u73b0\u5bf9\u4e8e $m$, $n$ \u5982\u679c\u6ee1\u8db3 $x_m > x_n$ \u4e14 $r_m > r_n$ \u5219\u53ef\u4ee5\u4fdd\u8bc1 $n$ \u5bf9\u53ea\u540e\u7684\u7b54\u6848\u4e00\u5b9a\u6ca1\u6709\u8d21\u732e\u3002\n\n\u8bc1\u660e\uff1a\n$$\nr_1 = \\frac{(x_i - x_m)^2}{4r_m}\n$$\n$$\nr_2 = \\frac{(x_i - x_m)^2}{4r_n}\n$$\n\n\u5219\u663e\u7136\u6709 $r_1 < r_2$ \uff0c\u5f97\u8bc1\u3002\n\n\u8003\u8651\u4f7f\u7528\u5355\u8c03\u6808\u6765\u7ef4\u62a4\u51fa\u4e00\u4e2a $x_i$, $r_i$ \u5747\u5355\u589e\u7684\u5e8f\u5217\u3002\u6b64\u65f6\u6bcf\u6b21\u679a\u4e3e\u51b3\u7b56\u70b9\u7684\u4f4d\u7f6e\u53ea\u9700\u679a\u4e3e\u6808\u5185\u7684\u5143\u7d20\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4ecb\u4e8e $O(n)$ \u5230 $O(n^2)$ \uff0c\u8003\u8651\u7ee7\u7eed\u4f18\u5316\u3002\n\n**\u51b3\u7b56\u5355\u8c03\u6027\u4f18\u5316\uff1a**\n\n\u5bf9\u4e8e $m$, $n$ ($1 \\le m < n \\le i$), \u5176\u4e2d $i$ \u662f\u5f53\u524d\u51b3\u7b56\u70b9\uff0c\u5982\u679c\u6ee1\u8db3 $r_m < r_n$\uff0c$x_m < x_n$ \u4e14 $r_i < r_n$ \u5219 $r_i$ \u4e0d\u4f1a\u53d7\u5230 $r_m$ \u7684\u5f71\u54cd\u3002\n\n\u8bc1\u660e, \u5e26\u5165\u4e0a\u5f0f\u53ef\u5f97(\u8bbe $r_{a, b}$ \u8868\u793a $a$\uff0c$b$ \u4e24\u5706\u7684\u6700\u5927\u534a\u5f84)\uff1a\n$$\nr_i < r_n \\le \\frac{(x_n - x_m)^2}{4x_m}\n$$\n\u53c8\u6709\n$$\n\\frac{(x_n - x_m)^2}{4x_m} < \\frac{(x_i - x_m)^2}{4x_m}\n$$\n\u6240\u4ee5\u6709\n$$\nr_i < \\frac{(x_i - x_m)^2}{4x_m} = r_{i, m}\n$$\n\u5f97\u8bc1\u3002\n\n\u53c8\u7531\u4e8e\u6211\u4eec\u5df2\u7ecf\u7ef4\u62a4\u4e86\u4e00\u4e2a\u5355\u8c03\u6808\uff0c\u4fdd\u8bc1\u4e86\u4e0a\u8ff0\u8bc1\u660e\u7684\u6027\u8d28\uff0c\u56e0\u6b64\u53ea\u9700\u6bcf\u6b21\u53d6\u51fa\u6808\u9876\u5143\u7d20\u5224\u65ad\u5373\u53ef\u3002\n\n**\u3010\u603b\u7ed3\u3011**\n\n\u9996\u5148\uff0c\u5bf9\u4e8e\u5f53\u524d\u6c42\u503c\u7684 $i$ \u6765\u8bf4\uff0c\u6bcf\u6b21\u53d6\u51fa\u6808\u9876\u5143\u7d20 $j$ \u3002\u5bf9\u4e8e\u5f53\u524d\u7684 $r_i$ \u8ba1\u7b97\u51fa\u4e00\u4e2a\u503c\uff0c\u5982\u679c\u5f53\u524d\u7684 $r_i < r_j$ \u6ee1\u8db3\u5355\u8c03\u6808\u7684\u6027\u8d28\uff0c\u5165\u6808\uff0c\u5426\u5219\u5f39\u51fa\u6808\u9876\u5143\u7d20\uff0c\u91cd\u65b0\u53d6\u51fa $j$\u3002\n\n\u56e0\u4e3a\u6bcf\u4e2a\u5143\u7d20\u53ea\u4f1a\u5165\u3001\u51fa\u6808\u4e00\u6b21\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n)$ \u3002\n\n\u4ee3\u7801(\u7b80\u77ed\u7248\uff0c\u5361\u5e38\u7248\u6233[\u8fd9\u91cc](https://www.luogu.com.cn/record/86161599))\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#define MAXN 200005\nusing namespace std;\ntypedef long long ll;\ndouble x[MAXN], r[MAXN]; int stack[MAXN], top = 0, n, i = 1;\nint main() {\n\tscanf(\"%d\", &n);\n\tfor (; i <= n; i ++) scanf(\"%lf %lf\", x + i, r + i);\n\tfor (i = 1; i <= n; ++i) {\n\t\twhile (top > 0) {\n\t\t\tint j = stack[top]; r[i] = min(r[i], (1.0 * (x[i] - x[j]) * (x[i] - x[j])) / (4 * r[j]));\n\t\t\tif (r[i] <= r[j]) break;\n\t\t\telse top--;\n\t\t}\n\t\tstack[++top] = i;\n\t\tprintf(\"%.4lf\\n\", r[i]);\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1662709884,
        "uid": 675237,
        "name": "DiruiXiao",
        "ccfLevel": 6,
        "title": "P4697 [CEOI2011] Balloons"
    }
]
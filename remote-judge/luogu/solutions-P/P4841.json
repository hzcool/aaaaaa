[
    {
        "content": "1. \u6807\u7b7e\uff1a\u591a\u9879\u5f0f\u6c42\u9006, NTT.\n2. \u8bbe$f(n)$\u4e3a\u70b9\u6570\u4e3a$n$\u7684**\u65e0\u5411\u8fde\u901a\u56fe**\u7684\u6570\u91cf, $g(n)$\u4e3a\u70b9\u6570\u4e3a$n$**\u65e0\u5411\u56fe**, \u6613\u5f97$g(n)=2^{n\\choose 2}$\n3. \u90a3\u4e48\u6709\n\t$$g(n) = \\sum_{i = 1}^{n} {{n - 1} \\choose {i - 1}} f(i) g(n - i)$$\n    , \u53ef\u4ee5\u770b\u6210\u679a\u4e3e\u4e00\u53f7\u8282\u70b9\u6240\u5728\u8054\u901a\u5757\u5927\u5c0f, \u7edf\u8ba1\u65b9\u6848\u6570.\n4. \u5c06$g(n)=2^{n\\choose 2}$\u5e26\u5165\u5e76\u5c06\u5f0f\u5b50\u53d8\u5f62,\n\t$$2^{n \\choose 2} = \\sum_{i = 1}^{n} {{n - 1} \\choose {i - 1}} f(i) 2^{{n - i} \\choose 2}$$\n   $$\\frac{2^{n \\choose 2}}{(n-1)!} = \\sum_{i = 1}^{n} \\frac{f(i)}{(i-1)!} \\frac{2^{{n - i} \\choose 2}}{(n-i)!}\n\t$$\n5. \u53d1\u73b0\u662f\u4e00\u4e2a\u5377\u79ef\u7684\u884c\u5f0f, \u5b9a\u4e49\n\n\t$$F(x) = \\sum_{n=1}^{+\\infty} \\frac{f(n)}{(n-1)!}x^n $$\n\t$$G(x) = \\sum_{n=0}^{+\\infty} \\frac{2^{n \\choose 2}}{n!}x^n $$\n\t$$H(x) = \\sum_{n=1}^{+\\infty} \\frac{2^{n \\choose 2}}{(n-1)!}x^n$$\n6. \u5219\n\t$$F=H*G^{-1}\\pmod{x^{n+1}}$$\n    , $H$\u548c$G$\u90fd\u662f\u5df2\u77e5\u7684, \u90a3\u4e48\u5bf9$G$\u6c42\u9006\u518d\u4e0e$H$\u5377\u79ef\u5c31\u53ef\u4ee5\u6c42\u51fa$F$\u4e86.\n    \n```cpp\n#include <iostream>\n#include <cstdio>\n#define mod 1004535809\nusing namespace std;\n\nlong long inv[200005], fiv[200005];\n\nlong long fsp(long long base, long long p) {\n    long long rt = 1;\n    while (p) {\n        if (p & 1) (rt *= base) %= mod;\n        (base *= base) %= mod;\n        p >>= 1;\n    }\n    return rt;\n}\n\nint rtt[600005];\nstruct Poly {\n    long long x[600005];\n    void cpy(Poly &a, int len) {\n        for (int i = 0; i < len; ++i) x[i] = a.x[i];\n        return ;\n    }\n    void mem(int len) {\n        for (int i = 0; i < len; ++i) x[i] = 0;\n        return ;\n    }\n    void ntt(int w, int b) {\n        int len = 1 << w;\n        for (int i = 0; i < len; ++i) {\n            rtt[i] = rtt[i >> 1] >> 1 | ((i & 1) << (w - 1));\n            if (i < rtt[i]) swap(x[i], x[rtt[i]]);\n        }\n        for (int l = 2; l <= len; l <<= 1) {\n            int m = l >> 1;\n            long long omega = fsp(3, (mod - 1) / l);\n            if (b) omega = fsp(omega, mod - 2);\n            for (int i = 0; i < len; i += l) {\n                long long tomega = 1;\n                for (int j = i; j < i + m; ++j, (tomega *= omega) %= mod) {\n                    long long t = tomega * x[j + m] % mod;\n                    x[j + m] = (x[j] + mod - t) % mod;\n                    x[j] = (x[j] + t) % mod;\n                }\n            }\n        }\n        return ;\n    }\n} g1, g2, f, tmp1, tmp2;\n\nPoly inversion(Poly &a, Poly &b, Poly &c, int n) {\n    b.mem(2 * n);\n    if (a.x[0] == 1) b.x[0] = 1;\n    else b.x[0] = fsp(a.x[0], mod - 2);\n    for (int w = 1; (1 << (w - 1)) < n; ++w) {\n        int len = 1 << w;\n        c.cpy(a, len), c.ntt(w + 1, 0), b.ntt(w + 1, 0);\n        for (int i = 0; i < (len << 1); ++i) (b.x[i] *= mod + 2ll - b.x[i] * c.x[i] % mod) %= mod;\n        b.ntt(w + 1, 1);\n        long long ny = fsp(len << 1, mod - 2);\n        for (int i = 0; i < len; ++i) (b.x[i] *= ny) %= mod;\n        for (int i = len; i < (len << 1); ++i) b.x[i] = 0;\n    }\n    return b;\n}\n\nint main() {\n    int n, w = 0;\n    scanf(\"%d\", &n);\n    n++;\n    fiv[0] = fiv[1] = inv[0] = inv[1] = 1;\n    for (int i = 2; i <= n; ++i) {\n        inv[i] = mod - (mod / i) * inv[mod % i] % mod;\n        fiv[i] = fiv[i - 1] * inv[i] % mod;\n    }\n    g2.x[0] = 1;\n    for (int i = 1; i < n; ++i) {\n        long long tmp = fsp(2, 1ll * i * (i - 1) / 2 % (mod - 1));\n        g1.x[i] = tmp * fiv[i - 1] % mod, g2.x[i] = tmp * fiv[i] % mod;\n    }\n    g2 = inversion(g2, tmp1, tmp2, n);\n    while ((1 << w) < (n << 1)) w++;\n    for (int i = n; i < (1 << w); ++i) g2.x[i] = 0;\n    g1.ntt(w, 0), g2.ntt(w, 0);\n    for (int i = 0; i <= (1 << w); ++i) f.x[i] = g1.x[i] * g2.x[i] % mod;\n    f.ntt(w, 1);\n    printf(\"%lld\", fsp(inv[2], w) * f.x[n - 1] % mod * fsp(fiv[n - 2], mod - 2) % mod);\n    return 0;\n}\n```\n\n",
        "postTime": 1551709642,
        "uid": 51237,
        "name": "Kinandra",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4841 \u3010\u57ce\u5e02\u89c4\u5212\u3011"
    },
    {
        "content": "\u9996\u5148\uff0c\u6839\u636e\u6307\u6570\u516c\u5f0f\u5b9a\u7406\uff1a\n\n\u5982\u679c\u5b58\u5728\u4e24\u4e2a EGF $F(x)$ \u4e0e $G(x)$\uff0c\u6ee1\u8db3 $e^{F(x)}=G(x)$\uff0c$F(x)$ \u662f ${f_i}$ \u7684 EGF\uff0c\u90a3\u4e48 $G(x)$ \u662f\n\n$$g_n=\\sum_{\\pi=\\{S_1,S_2,\\dots,S_n\\}}\\prod_{i=1}^n f_{|S_i|}$$\n\nEGF\uff0c\u5176\u4e2d $\\pi$ \u662f $[n]$ \u7684\u5212\u5206\u3002\n\n\u5230\u4e86\u8fd9\u91cc\u5c31\u53ef\u4ee5\u76f4\u63a5\u505a\u5b8c\u8fd9\u9053\u9898\u76ee\u4e86\uff0c\u56e0\u4e3a\u5982\u679c\u8bbe $f_i$ \u4e3a $i$ \u8282\u70b9\u7684\u8fde\u901a\u56fe\uff0c$g_i$ \u4e3a $i$ \u8282\u70b9\u7684\u4efb\u610f\u4e00\u4e2a\u56fe\uff0c\u6709 $e^{F(x)} = G(x)$ \u5e76\u4e14 $g_i=2^{\\binom{i}{2}}$\uff0c\u6240\u4ee5\u6765\u53d6\u5f97 $f$ \u76f4\u63a5\u505a\u591a\u9879\u5f0f $\\ln$ \u5c31\u53ef\u4ee5\u3002\n\n\u4e3b\u8981\u4ee3\u7801\uff1a\n\n```cpp\nint fc[524320];\nint p1[524320];\nint p1l[524320];\n\nsigned main() {\n    ios_base::sync_with_stdio(false); cin.tie(0);\n    int n; cin >> n;\n    n++;\n    int l = 1; while(l < (n<<1)) l <<= 1;\n    poly::init(l);\n    fc[0] = 1;\n    rep1(i, n) fc[i] = 1ll * fc[i-1] * i % poly::MOD;\n    rep(i, n) p1[i] = 1ll * poly::qpow(2, 1ll*i*(i-1)/2) * poly::qpow(fc[i], poly::MOD-2) % poly::MOD;\n    poly::ln(p1, n, p1l);\n    cout << 1ll * p1l[n-1] * fc[n-1] % poly::MOD << endl;\n}\n```",
        "postTime": 1592491392,
        "uid": 220037,
        "name": "w33z8kqrqk8zzzx33",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4841 \u3010[jxdzy2013]\u57ce\u5e02\u89c4\u5212\u3011"
    },
    {
        "content": "#### \u6211\u4eec\u8bb0$f_i$\u8868\u793a$i$\u4e2a\u70b9\u7684\u65e0\u5411\u8fde\u901a\u56fe\u4e2a\u6570\uff0c$t_i$\u8868\u793a$i$\u4e2a\u70b9\u7684\u65e0\u5411\u56fe\u4e2a\u6570\uff0c\u663e\u7136$t_i=2^{C(i,2)}$\u3002\n\n#### \u6839\u636e\u5bb9\u65a5\u7684\u5957\u8def\uff0c\u679a\u4e3e$1$\u53f7\u70b9\u6240\u5728\u8054\u901a\u5757\u5927\u5c0f\uff0c\u9009\u4e00\u4e9b\u70b9\u548c$1$\u53f7\u70b9\u5728\u540c\u4e00\u4e2a\u8054\u901a\u5757\uff0c\u518d\u8ba9\u5269\u4e0b\u70b9\u968f\u610f\u6784\u6210\u4e00\u4e2a\u65e0\u5411\u56fe\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n\n#### $f_i=t_i-\\sum_{j=1 \\to i-1}f_j*C(i-1,j-1)*t_{i-j}$\n\n#### \u5c55\u5f00\u7ec4\u5408\u6570\uff0c\u5f97\u5230\uff1a\n\n#### $f_i=t_i-\\sum_{j=1 \\to i-1}f_j*t_{i-j}*\\frac{(i-1)!}{(j-1)!(i-j)!}$\n\n#### \u5408\u5e76\u540c\u7c7b\u9879\uff0c\u5f97\u5230\uff1a\n\n#### $\\frac{f_i}{(i-1)!}=\\frac{t_i}{(i-1)!}-\\sum_{j=1 \\to i-1}\\frac{f_j}{(j-1)!}*\\frac{t_{i-j}}{(i-j)!}$\n\n#### \u4e8e\u662f\u8bbe$g_i=\\frac{f_i}{(i-1)!}$\uff0c$h_i=\\frac{t_i}{i!}$\uff0c\u5f97\u5230\uff1a\n\n#### $g_i=h_i-\\sum_{j=1 \\to i-1}g_jh_{i-j}$\n\n#### \u5269\u4e0b\u7684\u5c31\u662f[P4721 \u3010\u6a21\u677f\u3011\u5206\u6cbb FFT](https://www.luogu.org/problemnew/show/P4721)\u4e86\u3002\n\n#### \u4ee3\u7801\uff1a\n\n```\n\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<string>\n#include<algorithm>\n#include<math.h>\n#include<time.h>\nusing namespace std;\n\nconst int N=1e6+5;\nconst int mod=1004535809;\nconst int sqr=3;\nconst int sqrinv=334845270;\n\nint n,mx,g[N],inv[N],infac[N],fac[N];\nint c[N],x[N],y[N],limit,lg,r[N],h[N];\nint NTT_inv[N],scom[N],ss[N];\n\nnamespace MATHEMATICS\n{\n\tint add(int x,int y)\n\t{\n\t\tint ret=x+y;\n\t\tif(ret>=mod) ret-=mod;\n\t\treturn ret;\n\t}\n\tint mi(int x,int y)\n\t{\n\t\tint ret=x-y;\n\t\tif(ret<0) ret+=mod;\n\t\treturn ret;\n\t}\n\t\n\tvoid inc(int &x,int y)\n\t{\n\t\tx+=y;\n\t\tif(x>=mod) x-=mod;\n\t}\n\tvoid dec(int &x,int y)\n\t{\n\t\tx-=y;\n\t\tif(x<0) x+=mod;\n\t}\n\t\n\tint mul(int x,int y)\n\t{\n\t\treturn 1LL*x*y%mod;\n\t}\n\tint F_p(int x,int y)\n\t{\n\t\tint bas=x,ret=1;\n\t\twhile(y)\n\t\t{\n\t\t\tif(y&1) ret=mul(ret,bas);\n\t\t\tbas=mul(bas,bas);\n\t\t\ty>>=1;\n\t\t}\n\t\treturn ret;\n\t}\n};\nusing namespace MATHEMATICS;\n\nvoid prework()\n{\n\tint i;\n\tfac[0]=1;for(i=1;i<=n;++i) fac[i]=mul(fac[i-1],i);\n\tinv[1]=1;for(i=2;i<=n;++i) inv[i]=mul(inv[mod%i],mod-mod/i);\n\tinfac[0]=1;for(i=1;i<=n;++i) infac[i]=mul(infac[i-1],inv[i]);\n\t\n\tfor(i=1;i<=n;++i) c[i]=1LL*i*(i-1)/2%(mod-1);\n\tfor(i=1;i<=n;++i) h[i]=mul(F_p(2,c[i]),infac[i]);\n}\n\nint solve_complex(int x,int op)\n{\n\tif(~op) return F_p(sqr,x);\n\telse return F_p(sqrinv,x);\n}\nvoid NTT(int *A,int op)\n{\n\tint i;\n\tfor(i=0;i<limit;++i)\n\t\tif(i<r[i])\n\t\t\tswap(A[i],A[r[i]]);\n\t\n\tint len,j,k;\n\tfor(len=1;len<limit;len<<=1)\n\t{\n\t\tint wn;\n\t\tif(~op)\n\t\t{\n\t\t\tif(scom[len]) wn=scom[len];\n\t\t\telse wn=scom[len]=solve_complex((mod-1)/(2*len),1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(ss[len]) wn=ss[len];\n\t\t\telse wn=ss[len]=solve_complex((mod-1)/(2*len),-1);\n\t\t}\n\n\t\tfor(j=0;j<limit;j+=len<<1)\n\t\t{\n\t\t\tint w=1;\n\t\t\tfor(k=0;k<len;++k,w=mul(w,wn))\n\t\t\t{\n\t\t\t\tint x=A[j+k];\n\t\t\t\tint y=mul(w,A[j+k+len]);\n\t\t\t\tA[j+k]=add(x,y);\n\t\t\t\tA[j+k+len]=mi(x,y);\n\t\t\t}\n\t\t}\n\t}\n}\n\nvoid calc(int L,int mid,int mm,int R)\n{\n\tlimit=1,lg=0;int len=R-L,i;\n\twhile(limit<len+len) limit<<=1,++lg;\n\tfor(i=1;i<limit;++i) r[i]=(r[i>>1]>>1)|((i&1)<<(lg-1));\n\t\n\tfor(i=0;i<=mid-L;++i) x[i]=g[i+L];\n\tfor(i=0;i<R-L;++i) y[i]=h[i+1];\n\tfor(i=mid-L+1;i<limit;++i) x[i]=0;\n\tfor(i=R-L;i<limit;++i) y[i]=0;\n\t\n\tNTT(x,1),NTT(y,1);\n\tfor(i=0;i<limit;++i) x[i]=mul(x[i],y[i]);\n\tNTT(x,-1);\n\t\n\tint inv;\n\tif(NTT_inv[limit]) inv=NTT_inv[limit];\n\telse NTT_inv[limit]=inv=F_p(limit,mod-2);\n\t\n\tfor(i=mm;i<=R;++i) dec(g[i],mul(x[i-mm+mid-L],inv));\n}\n\nvoid solve(int l,int r)\n{\n\tif(l==r) return;\n\tint mid=(l+r)>>1;\n\tsolve(l,mid);\n\tcalc(l,mid,mid+1,r);\n\tsolve(mid+1,r);\n}\n\nvoid work()\n{\n//\tcout<<clock()<<endl;\n\tmx=1;int i;\n\tfor(i=1;i<=n;++i) g[i]=mul(infac[i-1],F_p(2,c[i]));\n\twhile(mx<=n) mx<<=1;\n\tsolve(0,mx-1);\n\tprintf(\"%d\\n\",mul(g[n],fac[n-1]));\n}\n\nint main()\n{\n\tscanf(\"%d\",&n);\n//\tcout<<clock()<<endl;\n\tprework();work();\n//\tcout<<clock()<<endl;\n\treturn 0;\n}\n\n```",
        "postTime": 1545745157,
        "uid": 31435,
        "name": "hwk0518",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4841 \u3010\u57ce\u5e02\u89c4\u5212\u3011"
    },
    {
        "content": "### Part1 \u524d\u8a00\r\n\r\n\u4ec0\u4e48\uff1f\u6211\u53ea\u4f1a\u6570\u636e\u7ed3\u6784\uff1f\u4e0d\u4f1a\u751f\u6210\u51fd\u6570\u600e\u4e48\u529e\u554a\uff01\r\n\r\n\u867d\u7136\u591a\u9879\u5f0f\u5df2\u7ecf\u201c\u6eda\u51fa NOI\u201d\u4e86\uff0c\u4f46\u5b83\u5f88\u6709\u5229\u4e8e\u7406\u89e3\u751f\u6210\u51fd\u6570\uff0c\u6bd5\u7adf\u8003\u8bd5\u8981\u662f\u6b63\u89e3\u751f\u6210\u51fd\u6570\u53ea\u662f\u653e\u66b4\u529b\u5377\u79ef\u8fc7\u5462\uff1f\r\n\r\n### Part2 \u5f62\u5f0f\u53ca\u542b\u4e49\r\n\r\n\u7ed9\u5b9a\u6570\u5217 $a_i$\uff0c\u5b83\u7684\u666e\u901a\u751f\u6210\u51fd\u6570\u4e3a $\\sum\\limits_{i=0}^\\infty a_ix^i$\uff0c\u6307\u6570\u751f\u6210\u51fd\u6570\u4e3a $\\sum\\limits_{i=0}^\\infty\\dfrac{a_i}{i!}x^i$\u3002\r\n\r\n\u5bf9\u4e8e\u6570\u5217 $a_i=1$\uff0c\u5b83\u7684\u666e\u901a\u751f\u6210\u51fd\u6570\u4e3a $\\sum\\limits_{i=0}^\\infty x^i=\\dfrac1{1+x}$\uff0c\u6ce8\u610f\u5de6\u5f0f\u53ea\u6709 $|x|<1$ \u624d\u662f\u6536\u655b\u7684\uff0c\u53f3\u5f0f\u79f0\u4e3a\u5f62\u5f0f\u5e42\u7ea7\u6570\uff0c\u53ea\u6709\u5de6\u5f0f\u6536\u655b\u624d\u80fd\u4e0e\u53f3\u5f0f\u5bf9\u5e94\u3002\r\n\r\n\u5b83\u7684\u6307\u6570\u751f\u6210\u51fd\u6570\u4e3a $\\sum\\limits_{i=0}^\\infty\\dfrac{x^i}{i!}=e^x$\uff0c\u8fd9\u4e00\u6b65\u53ef\u4ee5\u76f4\u63a5\u53f3\u5f0f\u6cf0\u52d2\u5c55\u5f00\u5f97\u5230\u5de6\u5f0f\u3002\r\n\r\n### Part3 \u95ee\u9898\u8f6c\u5316\r\n\r\n\u5bf9\u4e8e\u8fd9\u7c7b\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u60f3\u4e00\u60f3\u80fd\u5426\u5f97\u5230\u4e0e\u7b54\u6848\u7c7b\u4f3c\u7684\u4e1c\u897f\u3002\r\n\r\n\u6bd4\u5982\uff0c\u8bbe $g_n$ \u8868\u793a $n$ \u4e2a\u8282\u70b9\u6709\u6807\u53f7\u65e0\u5411\u56fe\u4e2a\u6570\uff0c\u663e\u7136\u6709 $g_n=2^{\\frac{n(n-1)}2}$\u3002\r\n\r\n\u4f46\u8fd9\u5e76\u4e0d\u662f\u6211\u4eec\u60f3\u8981\u5f97\u5230\u7684\u7b54\u6848\uff0c\u8bbe $f_n$ \u8868\u793a $n$ \u4e2a\u70b9\u6709\u6807\u53f7\u65e0\u5411\u8fde\u901a\u56fe\u4e2a\u6570\uff0c\u8003\u8651 $1$ \u6240\u5728\u8fde\u901a\u5757\u8282\u70b9\u4e3a $k$ \u4e2a\uff0c\u6709\uff1a$g_n=\\sum\\limits_{k=1}^n\\binom{n-1}{k-1}f_kg_{n-k}$\uff0c\u4e8e\u662f\u6211\u4eec\u5f97\u51fa\u4e86 $f$ \u4e0e $g$ \u7684\u5173\u7cfb\u3002\r\n\r\n\u5230\u4e86\u8fd9\u4e00\u6b65\uff0c\u751f\u6210\u51fd\u6570\u7684\u4f5c\u7528\u5c31\u5728\u4e8e\u6784\u5efa\u5377\u79ef\u5173\u7cfb\uff0c\u5f53\u7136\u6211\u4eec\u9700\u8981\u8ba9\u51fd\u6570\u7684\u9879\u53ea\u4e0e\u6b21\u6570\u76f8\u5173\u3002\r\n\r\n\u5c06\u4e8c\u9879\u5f0f\u62c6\u5f00\uff0c\u5f97\u5230 $\\dfrac{g_n}{(n-1)!}=\\sum\\limits_{k=1}^n\\dfrac{f_k}{(k-1)!}\\dfrac{g_{n-k}}{(n-k)!}$\uff0c\u8fd9\u5c31\u662f\u4e00\u4e2a\u5377\u79ef\u5f62\u5f0f\u3002\r\n\r\n\u8bbe $F=\\sum\\dfrac{f_i}{i!},G=\\sum\\dfrac{g_i}{i!}$\uff0c\u5206\u522b\u662f\u6570\u5217 $f_i,g_i$ \u7684\u6307\u6570\u751f\u6210\u51fd\u6570\u3002\r\n\r\n\u90a3\u4e48 $xG'=xF'G,F=\\int\\dfrac{G'}G=\\ln G$\uff0c\u76f4\u63a5\u4f7f\u7528\u591a\u9879\u5f0f\u5bf9\u6570\u51fd\u6570\u5373\u53ef\u3002\r\n\r\n### Part4 \u53e6\u4e00\u4e2a\u89d2\u5ea6\r\n\r\n\u4e0a\u9762\u53ea\u662f\u7528\u6765\u53d1\u6398\u6307\u6570\u4e0e\u8ba1\u6570\u7684\u8054\u7cfb\uff0c\u5176\u5b9e\u666e\u901a\u751f\u6210\u51fd\u6570\u4e5f\u53ef\u4ee5\uff0c\u751a\u81f3\u4e0d\u7528\u5bf9\u6570\uff0c\u6bd5\u7adf\u5bf9\u6570\u7684\u5b9e\u73b0\u4e5f\u662f\u591a\u9879\u5f0f\u6c42\u9006\u3002\r\n\r\n\u4e8b\u5b9e\u4e0a\uff0c\u8bbe $H=\\sum\\dfrac{g_i}{(i-1)!}x^i,F=\\sum\\dfrac{f_i}{(i-1)!}x^i,G=\\sum\\dfrac{g_i}{i!}x^i$\u3002\r\n\r\n\u90a3\u4e48\u6709 $H=FG,F=\\dfrac{H}G$\uff0c\u591a\u9879\u5f0f\u6c42\u9006\u5373\u53ef\u3002\r\n\r\n### Part5 \u540e\u8bb0\r\n\r\n\u600e\u4e48\u4f1a\u544a\u4e00\u6bb5\u843d\uff0c\u751f\u6210\u51fd\u6570\u8fdc\u4e0d\u53ea\u8fd9\u4e9b\uff0c\u5f53\u7136\u53ef\u4ee5\u653e\u4ee3\u7801\uff1a\r\n\r\n\u65b9\u6cd5\u4e00\uff1a\r\n```cpp\r\nint main(){\r\n\tios::sync_with_stdio(false);\r\n\tint i,j,k,l,r,x,y;\r\n\tcin>>n;\r\n\tjc[0]=nv[0]=nv[1]=1;\r\n\tfor(x=2;x<=n;++x)nv[x]=ll(M-M/x)*nv[M%x]%M;\r\n\tfor(x=1;x<=n;++x){\r\n\t\tjc[x]=ll(jc[x-1])*x%M;\r\n\t\tnv[x]=ll(nv[x-1])*nv[x]%M;\r\n\t}\r\n\tfor(x=0;x<=n;++x)g[x]=ll(qp(2,ll(x-1)*x/2%(M-1)))*nv[x]%M;\r\n\tP.Ln(g,f,18);\r\n\tk=ll(f[n])*jc[n]%M;\r\n\tprintf(\"%d\\n\",k);\r\n\treturn 0;\r\n}\r\n```\r\n\u65b9\u6cd5\u4e8c\uff1a\r\n```cpp\r\nint main(){\r\n\tios::sync_with_stdio(false);\r\n\tint i,j,k,l,r,x,y;\r\n\tcin>>n;\r\n\tjc[0]=nv[0]=nv[1]=1;\r\n\tfor(x=2;x<=n;++x)nv[x]=ll(M-M/x)*nv[M%x]%M;\r\n\tfor(x=1;x<=n;++x){\r\n\t\tjc[x]=ll(jc[x-1])*x%M;\r\n\t\tnv[x]=ll(nv[x-1])*nv[x]%M;\r\n\t}\r\n\tfor(x=0;x<=n;++x)g[x]=ll(qp(2,ll(x-1)*x/2%(M-1)))*nv[x]%M;\r\n\tP.Inv(g,f,18);\r\n\tmemset(g,0,4<<19);\r\n\tfor(x=1;x<=n;++x)g[x]=ll(qp(2,ll(x-1)*x/2%(M-1)))*nv[x-1]%M;\r\n\tP.mul(f,g);\r\n\tk=ll(f[n])*jc[n-1]%M;\r\n\tprintf(\"%d\\n\",k);\r\n\treturn 0;\r\n}\r\n```",
        "postTime": 1678267592,
        "uid": 502410,
        "name": "EnofTaiPeople",
        "ccfLevel": 0,
        "title": "\u751f\u6210\u51fd\u6570\u5165\u95e8"
    },
    {
        "content": "\u4ee4 $f_n$ \u8868\u793a $n$ \u4e2a\u70b9\u7684\u8fde\u901a\u65e0\u5411\u56fe\u4e2a\u6570\u3002\n\n\u679a\u4e3e\u8fde\u901a\u5757\u4e2a\u6570\uff0c\u7136\u540e\u9012\u5f52\u5b9a\u4e49\n\n$$f_n=\\sum_{i\\geq 0}\\frac{1}{i!}\\sum_{k_1+\\dots+k_i=n-1} \\binom{n-1}{k_1,\\dots,k_i}\\prod_{j=1}^{i} (2^{k_j}-1)f_{k_j}$$\n\n\u5728\u7ecf\u8fc7\u5c1d\u8bd5\u4e4b\u540e\uff0c\u53d1\u73b0\u5355\u72ec\u5bf9 $f_n$ \u6765\u9012\u5f52\u5b9a\u4e49 $\\hat F(x)$ \u975e\u5e38\u4e0d\u597d\u505a\uff0c\u56e0\u4e3a\u6bcf\u9879\u7cfb\u6570\u603b\u4f1a\u591a\u51fa\u4e00\u4e2a $2^x-1$\u3002\n\n\u8003\u8651\u5230\u8fd9\u6837\u9012\u5f52\u5b9a\u4e49\u5fc5\u987b\u8003\u8651\u56fe\u7684\u8fde\u901a\u6027\uff0c\u6545\u800c\u4e0d\u592a\u597d\u505a\u3002\u8f6c\u800c\u60f3\u5230\u76f4\u63a5\u8ba1\u6570\u65e0\u5411\u56fe\u4e2a\u6570\u3002\u6211\u4eec\u4ee4 $g_n=2^{\\binom{n}{2}}$ \u8868\u793a\u65e0\u5411\u56fe\u4e2a\u6570\uff0c\u8fd8\u662f\u679a\u4e3e\u8fde\u901a\u5757\u4e2a\u6570\uff0c\u5219\n\n$$g_n=\\sum_{i\\geq 0}\\frac{1}{i!}\\sum_{k_1+\\dots+k_i=n} \\binom{n}{k_1,\\dots,k_i}\\prod_{j=1}^{i} f_{k_j}$$\n\n$$\\frac{g_n}{n!}=\\sum_{i\\geq 0}\\frac{1}{i!}\\sum_{k_1+\\dots+k_i=n} \\prod_{j=1}^{i} \\frac{f_{k_j}}{k_j!}$$\n\n\u90a3\u4e48\u5c31\u6709\n\n$$\\frac{g_n}{n!}=[x^n]\\sum_{i\\geq 0}\\frac{\\hat F(x)^i}{i!}=[x^n]e^{\\hat F(x)}$$\n\n$$ \\hat G(x)=e^{\\hat F(x)}$$\n\n\u6240\u4ee5\n\n$$\\hat F(x)=\\ln \\hat G(x)=\\ln\\sum_{n\\geq 0} \\frac{2^{\\binom{n}{2}}}{n!} x^n$$",
        "postTime": 1616723383,
        "uid": 83337,
        "name": "wwlw",
        "ccfLevel": 7,
        "title": "\u57ce\u5e02\u89c4\u5212"
    },
    {
        "content": "# \u9898\u76ee\u5927\u610f   \n\u7ed9\u4f60 $n$ \u4e2a\u70b9\uff0c\u8fd9 $n$ \u4e2a\u70b9\u4e92\u76f8\u8054\u901a \uff0c\u95ee\u6211\u4eec\u6240\u6709\u6784\u6210\u4e00\u68f5\u6811\u7684\u65b9\u6848 \uff0c\u4e24\u4e2a\u65b9\u6848\u4e0d\u540c\u4ec5\u5f53\u9009\u7684\u8fb9\u4e0d\u540c \u3002   \n\n## $solution$    \n\u9996\u5148\u8fd9\u9053\u9898\u662f\u4e00\u9053\u7ecf\u5178\u7684\u9012\u63a8\u9898    \n\u6211\u4eec\u8bbe $f[i]$ \u4e3a $i$ \u4e2a\u70b9\u7684\u65b9\u6848\u6570 \u3002    \n\u6211\u4eec\u53d1\u73b0\u5982\u679c\u6211\u4eec\u76f4\u63a5\u53bb\u627e\u80af\u5b9a\u662f\u5f88\u9ebb\u70e6\u7684 \n\u8001\u65b9\u6cd5\uff0c\u6b63\u96be\u5219\u53cd\uff0c\u6211\u4eec\u8003\u8651\u6240\u6709\u65b9\u6cd5\uff0c\u51cf\u53bb\u4e0d\u5408\u6cd5\u7684      \n$$f[i]=2^{C_{n}^{2}}-\\sum_{j=1}^{i-1}C_{i-1}^{j-1}\u00d7f[j]\u00d72^{C_{i-j}^{2}}$$   \n\u7b54\u6848\u7b49\u4e8e \u6240\u6709\u65b9\u6848\u6570 $-$ \u679a\u4e3e $1$ \u4e0e\u591a\u5c11\u4e2a\u70b9\u8054\u901a\u5f62\u6210\u5927\u5c0f\u4e3a $j $ \u7684\u8054\u901a\u5feb\u7684\u4e2a\u6570 $\u00d7$ \u8be5\u5927\u5c0f\u6240\u6709\u5408\u6cd5\u65b9\u6848\u6570 $\u00d7$ \u5176\u4ed6\u70b9\u7684\u81ea\u7531\u7ec4\u5408 .   \n\n$$f[i]=2^{C_{n}^{2}}-\\sum_{j=1}^{i-1}(\\frac{(i-1)!}{(i-j)!(j-1)!})\u00d7f[j]\u00d72^{C_{i-j}^{2}}$$   \n\u901a\u5206   \n$$\\frac{f[i]}{(i-1)!}=\\frac{2^{C_{n}^{2}}}{(i-1)!}-\\sum_{j=1}^{i-1}(\\frac{1}{(i-j)!(j-1)!})\u00d7f[j]\u00d72^{C_{i-j}^{2}}$$    \n\u79fb\u9879  \n$$\\frac{f[i]}{(i-1)!}+\\sum_{j=1}^{i-1}(\\frac{1}{(i-j)!(j-1)!})\u00d7f[j]\u00d72^{C_{i-j}^{2}}=\\frac{2^{C_{n}^{2}}}{(i-1)!}$$     \n\u5408\u5e76\u5de6\u8fb9 \u53ea\u8981\u6211\u4eec\u628a $0!$ \u8bbe\u4e3a $1$ \u4e4b\u540e\u5462\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u5de6\u8fb9\u5408\u5e76   \n\n$$\\sum_{j=1}^{i}(\\frac{1}{(i-j)!(j-1)!})\u00d7f[j]\u00d72^{C_{i-j}^{2}}=\\frac{2^{C_{n}^{2}}}{(i-1)!}$$    \n\n\u62c6\u5f00   \n\n$$\\sum_{j=1}^{i}(\\frac{2^{C_{i-j}^{2}}}{(i-j)!})\u00d7\\frac{f[j]}{(j-1)!}=\\frac{2^{C_{n}^{2}}}{(i-1)!}$$    \n\u4e4b\u540e   \n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{i}(\\frac{2^{C_{i-j}^{2}}}{(i-j)!})\u00d7\\frac{f[j]}{(j-1)!}=\\sum_{i=1}^{n}\\frac{2^{C_{i}^{2}}}{(i-1)!}$$     \n\u6211\u4eec\u8bbe   \n\n$$A=\\sum_{i=1}^{n}\\frac{f[i]}{(i-1)!}$$    \n$$B=\\sum_{i=0}^{n}\\frac{2^{C_i^2}}{i!}$$   \n$$C=\\sum_{i=1}^{n}\\frac{2^{C_i^2}}{(i-1)!}$$    \n\n\u4e4b\u540e\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0    \n$$C(n)=\\sum_{i=0}^{n}A(i)\u00d7B(n-i)$$    \n\n\u60f3\u5fc5\u5927\u5bb6\u4e5f\u90fd\u53d1\u73b0\u4e86\uff0c\u8fd9\u5176\u5b9e\u5c31\u662f\u5377\u79ef   \n\n$$C=A * B$$  \n\u5462\u4e48\u6211\u4eec\u7684\u7b54\u6848\u662f\u8981\u6c42 $F[n]$ \u7684  .  \n\u5462\u4e48  \n$$A=B^{-1}* C$$   \n\u591a\u9879\u5f0f\u6c42\u9006\u5c31\u597d\u5566 \u3002 \n\u6700\u540e $ans=A(n) \u00d7 (n-1)!$   \n\n* $code$   \n\n```cpp\n#include<bits/stdc++.h>\n#define mul(a,b) a*b%mod  \n#define add(a,b) (a+b)%mod  \n#define dec(a,b) (a-b+mod)%mod\n#define ll long long\nusing namespace std;\nconst double Pi=acos(-1.0);\nconst ll maxn=2e6+10;\nconst ll mod=1004535809;\nll G=3,Gi=334845270;\nll n;\nll poww(ll x,ll k) {\n\tll ans=1;\n\twhile(k) {\n\t\tif(k&1) ans=ans*x%mod;\n\t\tx=x*x%mod;\n\t\tk>>=1;\n\t}return ans;\n}\nll a[maxn],b[maxn],c[maxn],Y[maxn],B[maxn],A[maxn],C[maxn];\nll fac[maxn],inv[maxn],r[maxn];\ninline void NTT(ll *A,ll type,ll len) \n{\n\tll limit=1,l=0;\n\twhile(limit<len) limit<<=1,++l;\n\tfor(ll i=0;i<limit;++i) r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\tfor(ll i=0;i<limit;++i) if(i<r[i]) swap(A[i],A[r[i]]);\n\tfor(ll mid=1;mid<limit;mid<<=1) {\n\t\tll Wn=poww(type==1?G:Gi,(mod-1)/(mid<<1));\n\t\tfor(ll R=mid<<1,j=0;j<limit;j+=R) {\n\t\t\tll w=1;\n\t\t\tfor(ll k=0;k<mid;++k,w=w*Wn%mod) {\n\t\t\t\tll x=A[j+k],y=w*A[j+k+mid]%mod;\n\t\t\t\tA[j+k]=add(x,y);\n\t\t\t\tA[j+k+mid]=dec(x,y);\n\t\t\t}\n\t\t}\n\t}\n\tif(type==-1) {\n\t\tfor(ll i=0,inv=poww(len,mod-2);i<limit;++i) \n\t\t\tA[i]=1ll*A[i]*inv%mod;\n\t}\n}\n\nvoid Inv(ll *a,ll *b,ll len) \n{\n\tif(len==1) {\n\t\tb[0]=poww(a[0],mod-2);\n\t\treturn ;\n\t}\n\tInv(a,b,len>>1);\n\tfor(ll i=0;i<len;++i) A[i]=a[i],B[i]=b[i];\n\tNTT(A,1,len<<1);NTT(B,1,len<<1);\n\tfor(ll i=0;i<(len<<1);++i) A[i]=mul(mul(A[i],B[i]),B[i]);\n\tNTT(A,-1,len<<1);\n\tfor(ll i=0;i<len;++i) b[i]=(1ll*(b[i]<<1)%mod+mod-A[i])%mod;\n}\nll m;\nint main() \n{\n//\tcout<<poww(2,4);\n\tfac[0]=1;\n\tscanf(\"%d\",&n);m=n+n;\n\tfor(ll i=1;i<=n;++i) fac[i]=fac[i-1]*i%mod;\n\tinv[n]=poww(fac[n],mod-2);\n\tfor(ll i=n-1;i>=0;i--) inv[i]=inv[i+1]*(i+1)%mod;\n\tfor(ll i=0;i<=n;++i) b[i]=poww(2,(i*(i-1))/2)*inv[i]%mod;\n\tll Len;for(Len=1;Len<=n;Len<<=1);\n\tInv(b,C,Len);\n\t//for(int i=1;i<=Len;++i) cout<<C[i]<<\" \";\n\t//cout<<'\\n';\n\tfor(ll i=1;i<=n;++i) \n\ta[i]=poww(2,(i*(i-1))/2)*inv[i-1]%mod;\n\tfor(Len=1;Len<=m;Len<<=1);\n\tNTT(C,1,Len);NTT(a,1,Len);\n\tfor(ll i=0;i<Len;++i) a[i]=a[i]*C[i]%mod;\n\tNTT(a,-1,Len);\n\tcout<<a[n]*fac[n-1]%mod<<\"\\n\";\n\treturn 0;\n}\n\n\n```\n \n\n.\n...\n\n\n \n",
        "postTime": 1559114398,
        "uid": 102786,
        "name": "Sym_Je",
        "ccfLevel": 0,
        "title": "2013\u4e2d\u56fd\u56fd\u5bb6\u96c6\u8bad\u961f\u7b2c\u4e8c\u6b21\u4f5c\u4e1a \u57ce\u5e02\u89c4\u5212"
    },
    {
        "content": "## \u9898\u76ee\u63cf\u8ff0\n\u7ed9\u5b9a $n$\uff0c\u6c42 $n$ \u4e2a\u70b9\u7684\u7b80\u5355\u6709\u6807\u53f7\u65e0\u5411\u8fde\u901a\u56fe\u6570\u76ee\uff0c\u5bf9 $1004535809$ \u53d6\u6a21\u3002\n\n**\u6570\u636e\u8303\u56f4\uff1a**$n\\le130000$\u3002\n\n**\u65f6\u95f4\u9650\u5236\uff1a**$2000\\operatorname{ms}$\u3002\n## Solution\n\u8bbe $f_i$ \u8868\u793a $i$ \u4e2a\u70b9\u7684\u7b80\u5355\u6709\u6807\u53f7\u65e0\u5411\u8fde\u901a\u56fe\u6570\u76ee\uff0c$g_i$ \u8868\u793a $i$ \u4e2a\u70b9\u7684\u7b80\u5355\u6709\u6807\u53f7\u65e0\u5411\u56fe\u7684\u6570\u76ee\uff0c\u6709 $g_i=2^{\\binom{n}{2}}$\u3002\n\n\u679a\u4e3e\u4e00\u53f7\u8282\u70b9\u6240\u5728\u73af\u5927\u5c0f\uff0c\u628a\u8fd9\u4e2a\u73af\u5b64\u7acb\u8d77\u6765\uff0c\u7edf\u8ba1\u65b9\u6848\u6570\uff0c\u6709\n$$g_n=\\sum_{i=1}^{n}{\\dbinom{n-1}{i-1}f_ig_{n-i}}$$\n\u628a\u7ec4\u5408\u6570\u5c55\u5f00\uff0c\u6709\n$$g_n=\\sum_{i=1}^{n}{\\frac{(n-1)!}{(i-1)!(n-i)!}}f_ig_{n-i}$$\n$$\\frac{g_n}{(n-1)!}=\\sum_{i=1}^{n}\\frac{f_i}{(i-1)!}\\times\\frac{g_{n-i}}{(n-i)!}$$\n\u4ee4 $F(x)=\\sum_{i=1}^{n}\\frac{f_i}{(i-1)!}x^i$\uff0c$G(x)=\\sum_{i=0}^{n}{\\frac{g_i}{i!}x^i}$\uff0c$H(x)=\\sum_{i=1}^{n}{\\frac{g_i}{(i-1)!}x^i}$\n\u90a3\u4e48\u6709\n$$H(x)=F(x)G(x)\\bmod{x^{n+1}}$$\n\u6240\u4ee5\n$$F(x)=H(x)G^{-1}(x)\\bmod{x^{n+1}}$$\n\u591a\u9879\u5f0f\u6c42\u9006\u5373\u53ef\u89e3\u51b3\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\log n)$\u3002\n## Code\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\nconst int maxn=300000,MLY=1004535809,g=3;\nint bit,tot,rev[maxn];\nint G[maxn],invG[maxn],H[maxn],g2[maxn];\nint fac[maxn],invfac[maxn],n;\ninline int power(int a,int b){\n\tint ans=1;\n\twhile(b){\n\t\tif(b&1)ans=1ll*ans*a%MLY;\n\t\ta=1ll*a*a%MLY;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\ninline void Init(int n){\n\tbit=0;while((1<<bit)<=(n<<1))++bit;\n\ttot=1<<bit;\n\tfor(int i=1;i<tot;++i)rev[i]=(rev[i>>1]>>1)|((i&1)<<(bit-1));\n}\ninline void NTT(int *a,int inv){\n\tfor(int i=0;i<tot;++i)\n\t\tif(i<rev[i])\n\t\t\tswap(a[i],a[rev[i]]);\n\tfor(int mid=1;mid<tot;mid<<=1){\n\t\tint tmp=power(g,(MLY-1)/(mid<<1));\n\t\tif(!~inv)tmp=power(tmp,MLY-2);\n\t\tfor(int i=0;i<tot;i+=(mid<<1)){\n\t\t\tfor(int j=0,w=1;j<mid;++j,w=1ll*w*tmp%MLY){\n\t\t\t\tint x=a[i+j],y=1ll*w*a[i+j+mid]%MLY;\n\t\t\t\ta[i+j]=(x+y)%MLY;a[i+j+mid]=(x-y+MLY)%MLY;\n\t\t\t}\n\t\t}\n\t}\n\tif(!~inv){\n\t\tinv=power(tot,MLY-2);\n\t\tfor(int i=0;i<tot;++i)a[i]=1ll*a[i]*inv%MLY;\n\t}\n}\ninline void PolyMul(int *F,int *G,int n,int inv=0){\n\tstatic int a[maxn],b[maxn];\n\tInit(n);\n\tfor(int i=0;i<n;++i)a[i]=F[i],b[i]=G[i];\n\tfor(int i=n;i<tot;++i)a[i]=b[i]=0;\n\tNTT(a,1);NTT(b,1);\n\tfor(int i=0;i<tot;++i){\n\t\tif(inv)a[i]=b[i]*(2-1ll*a[i]*b[i]%MLY+MLY)%MLY;\n\t\telse a[i]=1ll*a[i]*b[i]%MLY;\n\t}\n\tNTT(a,-1);\n\tfor(int i=0;i<n;++i)G[i]=a[i];\n}\ninline void PolyInv(int *F,int *G,int n){\n\tif(n==1){\n\t\tG[0]=power(F[0],MLY-2);\n\t\treturn;\n\t}\n\tPolyInv(F,G,(n+1)>>1);\n\tPolyMul(F,G,n,1);\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfac[0]=invfac[0]=1;\n\tfor(int i=1;i<=n;++i)fac[i]=1ll*fac[i-1]*i%MLY;\n\tinvfac[n]=power(fac[n],MLY-2);\n\tfor(int i=n-1;i;--i)invfac[i]=invfac[i+1]*(i+1ll)%MLY;\n\tfor(int i=0;i<=n;++i)g2[i]=power(2,i*(i-1ll)/2%(MLY-1));\n\tfor(int i=1;i<=n;++i)H[i]=1ll*g2[i]*invfac[i-1]%MLY;\n\tfor(int i=0;i<=n;++i)G[i]=1ll*g2[i]*invfac[i]%MLY;\n\tPolyInv(G,invG,n+1);\n\tPolyMul(H,invG,n+1);\n\tprintf(\"%lld\",1ll*invG[n]*fac[n-1]%MLY);\n\treturn 0;\n}\n```",
        "postTime": 1619579488,
        "uid": 375785,
        "name": "x7103",
        "ccfLevel": 9,
        "title": "P4841 [\u96c6\u8bad\u961f\u4f5c\u4e1a2013]\u57ce\u5e02\u89c4\u5212"
    },
    {
        "content": "&emsp;&emsp;[\u524d\u5f80\u535a\u5ba2\u56ed](https://www.cnblogs.com/crashed/p/13284500.html)\u4eab\u53d7\u66f4\u597d\u4f53\u9a8c\u3002   \n# \u9898\u76ee\n&emsp;&emsp;[\u70b9\u8fd9\u91cc](https://www.luogu.com.cn/problem/P4841)\u770b\u9898\u76ee\u3002   \n# \u5206\u6790\n&emsp;&emsp;\u8003\u8651\u5982\u4e0b\u9012\u63a8\uff1a   \n&emsp;&emsp;$f_i$\uff1a$i$\u4e2a\u70b9\u7684\u65e0\u5411\u6709\u6807\u53f7**\u8fde\u901a**\u56fe\u7684\u4e2a\u6570\u3002   \n&emsp;&emsp;$g_i$\uff1a$i$\u4e2a\u70b9\u7684\u65e0\u5411\u6709\u6807\u53f7\u56fe\u7684\u4e2a\u6570\u3002   \n&emsp;&emsp;\u4ee5\u4e0b\u7ed9\u51fa\u4e24\u79cd\u8ba1\u7b97\u65b9\u5f0f\u3002   \n## \u6cd5\u4e00   \n&emsp;&emsp;\u4e0d\u96be\u770b\u51fa\u4e00\u4e2a\u5f0f\u5b50\uff1a   \n   \n$$g_n=\\sum_{i=1}^n\\binom{n-1}{i-1}f_ig_{n-i}$$   \n   \n&emsp;&emsp;\u8fd9\u76f8\u5f53\u4e8e\u679a\u4e3e 1 \u6240\u5728\u7684\u8fde\u901a\u5757\u5927\u5c0f\uff0c\u7136\u540e\u6784\u9020\u51fa\u8fd9\u4e2a\u8fde\u901a\u5757\uff0c\u5269\u4e0b\u7684\u70b9\u4efb\u610f\u8fde\u3002   \n&emsp;&emsp;\u7136\u540e\u611f\u89c9\u8fd9\u4e2a\u4e1c\u897f\u975e\u5e38\u7684 EGF \uff0c\u5c31\u5c1d\u8bd5\u62c6\u4e00\u4e0b\uff1a   \n   \n$$\\frac{g_n}{(n-1)!}=\\sum_{i=1}^n\\frac{f_i}{(i-1)!}\\cdot\\frac{g_{n-i}}{(n-i)!}$$    \n    \n&emsp;&emsp;\u7531\u4e8e\u8d1f\u6570\u7684\u9636\u4e58\u662f\u672a\u5b9a\u4e49\u7684\uff0c\u6211\u4eec\u5c31\u8ba4\u4e3a\u5b83\u662f 0 \uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u7b80\u5316\u4e0b\u6807\uff1a   \n   \n$$\\frac{g_n}{(n-1)!}=\\sum_{i=0}^n\\frac{f_i}{(i-1)!}\\cdot\\frac{g_{n-i}}{(n-i)!}$$   \n   \n&emsp;&emsp;\u53e6\u5916\uff0c\u7531\u4e8e\u4efb\u610f\u4e00\u4e2a\u65e0\u5411\u6709\u6807\u53f7\u56fe\u4e00\u5b9a\u662f\uff1a   \n   \n$$\n\\begin{aligned}\n&G=(V,E')\\\\\n&V=\\{1,2,3,...,n\\}\\\\\n&E=\\{(u,v)|u,v\\in V\\}, E'\\subseteq E\n\\end{aligned}\n$$   \n   \n&emsp;&emsp;\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\uff1a   \n   \n$$g_n=2^{\\binom{n}{2}}$$   \n   \n&emsp;&emsp;\u5b9e\u9645\u4e0a\u5c31\u662f\u770b\u6bcf\u6761\u8fb9\u9009\u4e0d\u9009\u3002   \n&emsp;&emsp;\u5e26\u5165\u5230\u5f0f\u5b50\u4e2d\u53ef\u4ee5\u5f97\u5230\uff1a   \n   \n$$\\frac{2^{\\binom n 2}}{(n-1)!}=\\sum_{i=0}^n\\frac{f_i}{(i-1)!}\\cdot \\frac{2^{\\binom {n - i} 2}}{(n-i)!}$$   \n   \n&emsp;&emsp;\u53cd\u624b\u5199\u6210\u751f\u6210\u51fd\u6570\uff1a   \n   \n$$\n\\begin{aligned}\nH(x)&=\\sum_{i=1}^{+\\infty} \\frac{2^{\\binom i 2}}{(i-1)!}x^i\\\\\nF(x)&=\\sum_{i=1}^{+\\infty} \\frac{f_i}{(i-1)!}x^i\\\\\nG(x)&=\\sum_{i=0}^{+\\infty} \\frac{2^{\\binom i 2}}{i!}x^i\n\\end{aligned}   \n$$   \n  \n&emsp;&emsp;\u4e8e\u662f\u6709\uff1a   \n    \n$$\n\\begin{aligned}\nH(x)&=F(x)*G(x)\\\\\nF(x)&=H(x)*G^{-1}(x)\n\\end{aligned}\n$$   \n   \n&emsp;&emsp;\u591a\u9879\u5f0f\u6c42\u9006\uff0c\u7ed3\u675f\u3002\u65f6\u95f4\u662f$O(n\\log_2n)$\u3002   \n## \u6cd5\u4e8c   \n&emsp;&emsp;\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u5148\u4e0d\u8003\u8651\u6807\u53f7\uff0c\u8bb0\uff1a   \n    \n$$p_i=\\frac{f_i}{i!},q_i=\\frac{g_i}{i!}$$    \n    \n&emsp;&emsp;\u628a\u5b83\u5199\u6210\u751f\u6210\u51fd\u6570\u7684\u5f62\u5f0f\uff1a   \n    \n$$\n\\begin{aligned}\nP(x)&=\\sum_{i=0}^{+\\infty} p_ix^i\\\\\nQ(x)&=\\sum_{i=0}^{+\\infty} q_ix^i\n\\end{aligned}\n$$   \n   \n&emsp;&emsp;\u7136\u540e\u53ef\u4ee5\u53d1\u73b0\uff1a   \n    \n$$\n\\begin{aligned}\nQ(x)=\\sum_{k=0}^{+\\infty} \\frac{(P(x))^k}{k!}\n\\end{aligned}\n$$ \n    \n&emsp;&emsp;\u5176\u4e2d$k$\u662f\u5728\u679a\u4e3e\u8fde\u901a\u5757\u7684\u4e2a\u6570\uff1b\u9664\u4ee5$k!$\uff0c\u662f\u56e0\u4e3a$(P(x))^k$\u4f7f\u5f97\u8fde\u901a\u5757\u4e4b\u95f4\u5b58\u5728\u987a\u5e8f\uff0c\u7136\u800c\u8fd9\u6837\u5c31\u7b97\u91cd\u590d\u4e86\uff0c\u56e0\u6b64\u8981\u9664\u53bb\u3002   \n&emsp;&emsp;\u53d1\u73b0\u7b49\u5f0f\u53f3\u8fb9\u662f\u7ecf\u5178\u7684$e^x$\u7684\u5c55\u5f00\u5f0f\uff0c\u7f29\u56de\u53bb\u5f97\u5230\uff1a   \n$$Q(x)=e^{P(x)}$$   \n&emsp;&emsp;\u8f6c\u4e3a$P(x)=\\ln Q(x)$\u8ba1\u7b97\u5373\u53ef\u3002\u65f6\u95f4\u662f$O(n\\log_2n)$\u3002    \n## \u9898\u5916\u8bdd    \n&emsp;&emsp;\u4e24\u4e2a\u65b9\u6cd5\u90fd\u662f\u6b63\u786e\u7684\uff0c\u4f46\u662f\u7ed3\u679c\u770b\u8d77\u6765\u8fd8\u4e0d\u592a\u4e00\u6837\uff0c\u6211\u4eec\u8fdb\u4e00\u6b65\u5206\u6790\u4e00\u4e0b\uff1a   \n&emsp;&emsp;\u53ef\u4ee5\u53d1\u73b0\uff0c\u591a\u9879\u5f0f\u5b58\u5728\u5982\u4e0b\u7684\u5173\u7cfb\uff1a   \n$$H(x)=xG'(x),F(x)=xP'(x)$$   \n&emsp;&emsp;\u90a3\u4e48\u5c31\u6709\uff1a   \n$$\n\\begin{aligned}\nF(x)&=\\frac{H(x)}{G(x)}\\\\\nx\\cdot P'(x)&=x\\cdot \\frac{G'(x)}{G(x)}\\\\\nP'(x)&=\\ln' G(x)\\\\\nP(x)&=\\ln G(x)\n\\end{aligned}\n$$   \n&emsp;&emsp;\u6240\u4ee5\u8bf4\u4e24\u4e2a\u65b9\u6cd5\u7684\u7ed3\u679c\u662f\u7edf\u4e00\u7684\u3002~~\u53ea\u4e0d\u8fc7\u6cd5\u4e00\u7684\u4ee3\u7801\u7b80\u5355\u4e00\u4e9b\u800c\u5df2~~   \n# \u4ee3\u7801\n&emsp;&emsp;~~\u4f5c\u8005\u592a\u61d2\u4e86\uff0c\u53ea\u6709\u6cd5\u4e00\u7684\u4ee3\u7801~~\n\n```cpp\n#include <cmath>\n#include <cstdio>\n\ntypedef long long LL;\n\nconst int mod = 1004535809, phi = mod - 1, g = 3;\nconst int MAXN = 1e6 + 5;\n\ntemplate<typename _T>\nvoid read( _T &x )\n{\n\tx = 0;char s = getchar();int f = 1;\n\twhile( s > '9' || s < '0' ){if( s == '-' ) f = -1; s = getchar();}\n\twhile( s >= '0' && s <= '9' ){x = ( x << 3 ) + ( x << 1 ) + ( s - '0' ), s = getchar();}\n\tx *= f;\n}\n\ntemplate<typename _T>\nvoid write( _T x )\n{\n\tif( x < 0 ){ putchar( '-' ); x = ( ~ x ) + 1; }\n\tif( 9 < x ){ write( x / 10 ); }\n\tputchar( x % 10 + '0' );\n}\n\ntemplate<typename _T>\nvoid swapp( _T &x, _T &y )\n{\n\t_T t = x; x = y, y = t;\n}\n\nint rev[MAXN], wp[MAXN], wpinv[MAXN];\nint Q[MAXN], G[MAXN], H[MAXN];\nint fac[MAXN], finv[MAXN];\nint N;\n\nint qkpow( int base, int indx )\n{\n\tint ret = 1;\n\twhile( indx )\n\t{\n\t\tif( indx & 1 ) ret = 1ll * ret * base % mod;\n\t\tbase = 1ll * base * base % mod, indx >>= 1;\n\t}\n\treturn ret;\n}\n\nint inv( const int a ) { return qkpow( a, phi - 1 ); }\nint fix( const int a ) { return ( a % mod + mod ) % mod; }\n\nvoid init( const int len )\n{\n\tint lg2 = log2( len );\n\tfor( int i = 0 ; i < len ; i ++ )\n\t\trev[i] = wp[i] = wpinv[i] = 0;\n\tfor( int i = 0 ; i < len ; i ++ )\n\t\tfor( int j = 0 ; j < lg2 ; j ++ )\n\t\t\trev[i] |= ( i >> j & 1 ) << ( lg2 - j - 1 );\n\twp[0] = 1, wp[1] = qkpow( g, phi / len );\n\twpinv[0] = 1, wpinv[1] = qkpow( g, phi - phi / len );\n\tfor( int i = 2 ; i < len ; i ++ )\n\t\twp[i] = 1ll * wp[i - 1] * wp[1] % mod,\n\t\twpinv[i] = 1ll * wpinv[i - 1] * wpinv[1] % mod;\n}\n\nvoid NTT( int *coe, const int len, const int t )\n{\n\t#define p ( s >> 1 )\n\tfor( int i = 0 ; i < len ; i ++ )\n\t\tif( rev[i] < i )\n\t\t\tswapp( coe[i], coe[rev[i]] );\n\tint w, wo, we;\n\tfor( int s = 2 ; s <= len ; s <<= 1 )\n\t\tfor( int i = 0 ; i < len ; i += s )\n\t\t\tfor( int j = 0 ; j < s >> 1 ; j ++ )\n\t\t\t{\n\t\t\t\tw = t > 0 ? wp[len / s * j] : wpinv[len / s * j];\n\t\t\t\twe = coe[i + j], wo = 1ll * coe[i + j + p] * w % mod;\n\t\t\t\tcoe[i + j] = ( we + wo ) % mod, coe[i + j + p] = ( we - wo + mod ) % mod;\n\t\t\t}\n\t#undef p\n\tif( t > 0 ) return; int inver = inv( len );\n\tfor( int i = 0 ; i < len ; i ++ ) coe[i] = 1ll * coe[i] * inver % mod;\n}\n\nnamespace PolyInv\n{\n\tint P[MAXN], F0[MAXN], F[MAXN], B[MAXN];\n\t\n\tvoid PolyInv( const int n )\n\t{\n\t\tif( n == 1 ) { F[0] = inv( P[0] ); return; }\n\t\tint p = n + 1 >> 1, len = 1;\n\t\tPolyInv( p );\n\t\twhile( len < n << 1 ) len <<= 1; init( len );\n\t\tfor( int i = 0 ; i < n ; i ++ ) B[i] = P[i];\n\t\tfor( int i = 0 ; i < len ; i ++ ) F0[i] = F[i], F[i] = 0;\n\t\tNTT( B, len, 1 ), NTT( F0, len, 1 );\n\t\tfor( int i = 0 ; i < len ; i ++ ) F[i] = 1ll * F0[i] * fix( 2 - 1ll * B[i] * F0[i] % mod ) % mod;\n\t\tNTT( F, len, -1 );\n\t\tfor( int i = n ; i < len ; i ++ ) F[i] = 0;\n\t}\n\t\n\tvoid PolyInv( int *ret, int *A, const int n )\n\t{\n\t\tfor( int i = 0 ; i < n << 2 ; i ++ ) P[i] = F0[i] = F[i] = B[i] = 0;\n\t\tfor( int i = 0 ; i < n ; i ++ ) P[i] = A[i];\n\t\tPolyInv( n );\n\t\tfor( int i = 0 ; i < n ; i ++ ) ret[i] = F[i];\n\t}\n}\n\nnamespace PolyMul\n{\n\tint A[MAXN], B[MAXN];\n\t\n\tvoid PolyMul( int *ret, int *a, const int La, int *b, const int Lb )\n\t{\n\t\tint len = 1;\n\t\twhile( len < La + Lb ) len <<= 1;\n\t\tinit( len );\n\t\t\n\t\tfor( int i = 0 ; i < len ; i ++ ) ret[i] = A[i] = B[i] = 0;\n\t\tfor( int i = 0 ; i < La ; i ++ ) A[i] = a[i];\n\t\tfor( int i = 0 ; i < Lb ; i ++ ) B[i] = b[i];\n\t\tNTT( A, len, 1 ), NTT( B, len, 1 );\n\t\tfor( int i = 0 ; i < len ; i ++ ) ret[i] = 1ll * A[i] * B[i] % mod;\n\t\tNTT( ret, len, -1 );\n\t\tfor( int i = La + Lb ; i < len ; i ++ ) ret[i] = 0;\n\t}\n}\n\nint main()\n{\n\tread( N );\n\tif( N == 0 ) return puts( \"0\" ), 0;\n\tfac[0] = 1, finv[1] = 1;\n\tfor( int i = 2 ; i <= N ; i ++ ) finv[i] = 1ll * ( mod - mod / i ) * finv[mod % i] % mod;\n\tfinv[0] = 1;\n\tfor( int i = 1 ; i <= N ; i ++ ) fac[i] = 1ll * fac[i - 1] * i % mod, finv[i] = 1ll * finv[i - 1] * finv[i] % mod;\n\tN ++, G[0] = 1;\n\tfor( int i = 1 ; i < N ; i ++ )\n\t{\n\t\tint tmp = qkpow( 2, 1ll * i * ( i - 1 ) / 2 % phi );\n\t\tG[i] = 1ll * tmp * finv[i] % mod, H[i] = 1ll * tmp * finv[i - 1] % mod;\n\t}\n\tPolyInv :: PolyInv( G, G, N );\n\tPolyMul :: PolyMul( Q, G, N, H, N );\n\twrite( 1ll * Q[N - 1] * fac[N - 2] % mod ), putchar( '\\n' );\n\treturn 0;\n}\n```",
        "postTime": 1594473905,
        "uid": 123809,
        "name": "crashed",
        "ccfLevel": 0,
        "title": "[\u96c6\u8bad\u961f\u4f5c\u4e1a]\u57ce\u5e02\u89c4\u5212"
    },
    {
        "content": "\u63a8\u4e00\u6ce2\u5f0f\u5b50    \n\u9996\u5148\u5982\u679c\u4e0d\u8981\u6c42\u8054\u901a\u7684\u8bdd\u516c\u5f0f\u5f88\u7b80\u5355\uff0c\u4ee4n\u4e2a\u70b9\u4e0d\u8981\u6c42\u8054\u901a\u7684\u65b9\u6848\u6570\u4e3a$g_n$  \n$$g_n=2^{\\frac{n*(n-1)}{2}}$$\n\u56e0\u4e3a\u6bcf\u6761\u8fb9\u90fd\u53ef\u4ee5\u9009\u6216\u4e0d\u9009    \n\u7136\u540e\u5047\u8bbe\u8981\u6c42\u8054\u901a\u7684\u65b9\u6848\u6570\u4e3a$f_n$   \n\u53ef\u4ee5\u627e\u51fa$g_n$\u4e0e$f$\u7684\u5173\u7cfb  \n$$g_n=\\sum_{i=1}^n {n-1\\choose i-1} f_ig_{n-i}$$   \n\u76f8\u5f53\u4e8e\u679a\u4e3e\u7b2c\u4e00\u4e2a\u70b9\u6240\u5728\u7684\u8054\u901a\u5757\u5927\u5c0f\u4e3ai\uff0c\u7136\u540e\u4e58\u4ee5\u5176\u5b83\u70b9\u968f\u4fbf\u8fde\u7684\u65b9\u6848\u6570\uff0c\u5982\u679c\u4e0d\u7406\u89e3\u8bf7\u518d\u770b\u4e00\u4e0bg\u548cf\u7684\u5b9a\u4e49  \n\u73b0\u5728\u6211\u4eec\u8981\u6c42$f_n$\u6240\u4ee5\u62c6\u4e00\u4e0b\u5f0f\u5b50  \n$$g_n=f_n+\\sum_{i=1}^{n-1} {n-1\\choose i-1} f_ig_{n-i}$$\n$$f_n=g_n-\\sum_{i=1}^{n-1} {n-1\\choose i-1} f_ig_{n-i}$$  \n$$f_n=g_n-\\sum_{i=1}^{n-1} \\frac{(n-1)!}{(i-1)!(n-i)!} f_ig_{n-i}$$\n$$f_n=g_n-(n-1)!\\sum_{i=1}^{n-1} \\frac{f_i}{(i-1)!} \\frac{g_{n-i}}{(n-i)!}$$\n\u540e\u9762\u8fd9\u4e2a\u5f0f\u5b50\u770b\u7740\u50cf\u5377\u79ef  \n$$\\sum_{i=1}^{n-1} \\frac{f_i}{(i-1)!} \\frac{g_{n-i}}{(n-i)!}$$\n\u4ee4$h_i=\\frac{f_i}{(i-1)!}$  $t_i=\\frac{g_i}{i!}$\u4ee3\u5165\u5f97\n$$(n-1)!h_n=n!t_n-(n-1)!\\sum_{i=1}^{n-1} h_i t_{n-i}$$\n$$h_n=nt_n-\\sum_{i=1}^{n-1} h_i t_{n-i}$$\n\u7136\u540e\u5206\u6cbbFFT\u5c31\u5b8c\u4e8b\u4e86  \n\u987a\u4fbf\u4e00\u63d0\uff0c\u8fd9\u9898\u7684\u539f\u6839\u4e5f\u662f3\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define mod 1004535809\n#define gg 3\nusing namespace std;\n\nint r[400010];\nlong long tmp1[400010],tmp2[400010],h[400010],t[400010];\nlong long fac[400010],inv[400010];\n\nlong long kasumi(long long a,long long b)\n{\n\tlong long ans=1;\n\twhile(b)\n\t{\n\t\tif(b&1) ans=ans*a%mod;\n\t\ta=a*a%mod;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\n\nvoid NTT(long long *a,int kd,int logn)\n{\n\tint lim=(1<<logn);\n\tfor(int i=0;i<lim;i++)\n\t{\n\t\tr[i]=(r[i>>1]>>1)|((i&1)<<(logn-1));\n\t}\n\tfor(int i=0;i<lim;i++)\n\t{\n\t\tif(i<r[i]) swap(a[i],a[r[i]]);\n\t}\n\tfor(int mid=1;mid<lim;mid<<=1)\n\t{\n\t\tlong long wn=kasumi(gg,(mod-1)/(mid<<1));\n\t\tif(kd) wn=kasumi(wn,mod-2);\n\t\tfor(int i=0;i<lim;i+=(mid<<1))\n\t\t{\n\t\t\tlong long w=1;\n\t\t\tfor(int j=0;j<mid;j++,w=w*wn%mod)\n\t\t\t{\n\t\t\t\tlong long x=a[i+j];\n\t\t\t\tlong long y=a[i+j+mid]*w%mod;\n\t\t\t\ta[i+j]=(x+y)%mod;\n\t\t\t\ta[i+j+mid]=(x-y+mod)%mod;\n\t\t\t}\n\t\t}\n\t}\n\tif(kd)\n\t{\n\t\tint invl=kasumi(lim,mod-2);\n\t\tfor(int i=0;i<lim;i++)\n\t\t{\n\t\t\ta[i]=a[i]*invl%mod;\n\t\t}\n\t}\n}\n\nvoid solve(int l,int r,int logn)\n{\n\tif(!logn) return ;\n\tint mid=(l+r)>>1;\n\tsolve(l,mid,logn-1);\n\tfor(int i=l;i<=r;i++)\n\t{\n\t\ttmp2[i-l]=t[i-l];\n\t}\n\tfor(int i=l;i<=mid;i++)\n\t{\n\t\ttmp1[i-l]=h[i];\n\t}\n\tfor(int i=mid+1;i<=r;i++)\n\t{\n\t\ttmp1[i-l]=0;\n\t}\n\tNTT(tmp1,0,logn);\n\tNTT(tmp2,0,logn);\n\tfor(int i=l;i<=r;i++)\n\t{\n\t\ttmp1[i-l]=tmp1[i-l]*tmp2[i-l]%mod;\n\t}\n\tNTT(tmp1,1,logn);\n\tfor(int i=mid+1;i<=r;i++)\n\t{\n\t\th[i]=(h[i]-tmp1[i-l]+mod)%mod;\n\t}\n\tsolve(mid+1,r,logn-1);\n}\n\nvoid init()\n{\n\tfac[0]=1;\n\tfor(int i=1;i<=200000;i++)\n\t{\n\t\tfac[i]=fac[i-1]*i%mod;\n\t}\n\tinv[200000]=kasumi(fac[200000],mod-2);\n\tfor(int i=199999;i>=0;i--)\n\t{\n\t\tinv[i]=inv[i+1]*(i+1)%mod;\n\t}\n\tt[0]=1;\n\tlong long tmp;\n\tfor(int i=1;i<=200000;i++)\n\t{\n\t\ttmp=kasumi(2,1ll*(i-1)*i/2);\n\t\tt[i]=tmp*inv[i]%mod;\n\t\th[i]=t[i]*i%mod;\n\t}\n}\n\nint n;\n\nint main()\n{\n\tint cnt=1;\n\tinit();\n\tscanf(\"%d\",&n);\n\tfor(;(1<<cnt)<=n;cnt++);\n\tsolve(0,(1<<cnt)-1,cnt);\n\tprintf(\"%lld\\n\",h[n]*fac[n-1]%mod);\n}\n```\n\n",
        "postTime": 1552291772,
        "uid": 185441,
        "name": "\u30cb\u30d2\u30eb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4841 \u3010\u57ce\u5e02\u89c4\u5212\u3011"
    },
    {
        "content": "### \u9898\u76ee\u63cf\u8ff0\n\u6c42 $n$ \u4e2a\u70b9\u65e0\u5411\u8fde\u901a\u56fe\u7684\u4e2a\u6570\n\n$1\\leq n \\leq 1.3\\cdot 10^5$\n\n### \u524d\u7f6e\u829d\u58eb\n\u591a\u9879\u5f0f\u6c42\u9006\uff0c $n$ \u4e2a\u70b9\u7684**\u65e0\u5411\u56fe\u6570\u91cf**\n\n### \u524d\u8a00\uff08\u5c31\u4e00\u53e5\u8bdd\uff09\n\u8bdd\u8bf4\u6211\u518d\u770b\u5230 Mr_Spade \u5927\u4f6c\u7684\u9898\u89e3\u7684\u65f6\u5019\uff0c\u6211\u6123\u4e86\uff0c\u6211\u4e3a\u4ec0\u4e48\u6211\u5316\u7b80\u4e86\u8fd9\u4e48\u4e45\u7684\u5f0f\u5b50\uff0c\u4e3a\u4ec0\u4e48\u8fd8\u8fd9\u4e48\u9ebb\u70e6\uff0c\u4e8e\u662f\uff0c\u6211\u628a\u5b83\u9e3d\u4e86\u51e0\u5929\uff0c\u540e\u6765\u624d\u77e5\u9053\u662f\u6211\u592a\u83dc\u4e86\u3002\u3002\uff08\u51c6\u5907\u6253\u5b8c\u9898\u89e3\u53bb\u5199 Mr_Spade \u7684\u505a\u6cd5\uff09\n\n### solution\n\u8bbe $g(x)$ \u4e3a $n$ \u4e2a\u70b9\u7684**\u65e0\u5411\u56fe\u6570\u91cf**\uff0c\u6613\u77e5\u4e3a $2^{\\left( \\begin{array}{c} n \\\\ 2\\end{array} \\right)}$ \n\n\u8bbe $f(x)$ \u4e3a $n$ \u4e2a\u70b9\u7684**\u65e0\u5411\u8054\u901a\u56fe\u6570\u91cf**\uff08\u5c31\u662f\u9898\u76ee\u8981\u6c42\uff09\n\n\u5c31\u5047\u8bbe\u5728\u679a\u4e3e\u4e00\u4e2a\u70b9\u6240\u5728\u7684\u8fde\u901a\u5757\u7684\u5927\u5c0f\u7684\u65b9\u6848\u6570\n\n\u4e8e\u662f\u5c31\u6709\uff1a\n\n$g(n)=\\large\\sum_{i=1}^{n}$ ${{\\small\\left( \\begin{array}{c} n-1 \\\\ i-1\\end{array} \\right)}\\cdot f(i)\\cdot g(n-i)}$\n\n\u628a\u7ec4\u5408\u6570\u62c6\u5f00\uff0c\u627e\u4e00\u4e0b\u80fd\u5bf9\u5e94\u7684\u5176\u4ed6\u9879\uff0c\u5c31\u73c2\u4ee5\u5316\u6210\u8fd9\u6837\u7684\uff1a\n\n$\\Large\\frac{g(n)}{(n-1)!}$ $=$ $\\large\\sum_{i=1}^{n}$ $\\Large\\frac{f(i)}{(i-1)!}$ $\\cdot$ $\\Large\\frac{g(n-i)}{(n-i)!}$\n\n\u4e8e\u662f\u8fd9\u5c31\u6210\u4e86\u4e00\u4e2a\u5377\u79ef\u7684\u884c\u5f0f\uff0c\u7a0d\u5fae\u64cd\u4f5c\u4e00\u4e0b\uff0c\u8bbe\u8fd9\u4e48\u4e09\u4e2a\u51fd\u6570\uff1a\n\n$F(x)=\\large\\sum_{n=1}^{\\infty}$ $\\Large\\frac{f(n)}{(n-1)!}$ $\\cdot$ $x^n$\n\n$G(x)=\\large\\sum_{n=1}^{\\infty}$ $\\Large\\frac{g(n)}{(n-1)!}$ $\\cdot$ $x^n$\n\n$H(x)=\\large\\sum_{n=0}^{\\infty}$ $\\Large\\frac{g(n)}{n!}$ $\\cdot$ $x^n$\n\n\u6240\u4ee5\u53ef\u4ee5\u6781\u5ea6\u5feb\u4e50\u7684\u628a\u5f0f\u5b50\u5199\u6210\uff1a\n\n$F\\ =\\ G\\ \\cdot\\ H^{\\ -1}$\n\n\u65e2\u7136\u5df2\u7ecf\u77e5\u9053\u4e86 $g(n)$ \uff0c\u90a3\u4e48 $G$ \u548c $H$ \u5c31\u90fd\u6210\u4e86\u5df2\u77e5\u7684\u4e86\uff0c\u7b54\u6848\u4e5f\u5c31\u547c\u4e4b\u6b32\u51fa\u4e86\u3002\n\n\u6700\u540e\u6839\u636e\u5b9a\u4e49\uff0c\u628a $F(n)$ \u4e58\u4e0a $(n-1)!$ \u5c31\u662f\u6700\u540e\u7684\u7b54\u6848\u4e86\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N=5e5+10;\ntypedef ll arr[N];\nconst int mod=1004535809;\nconst int inv3=334845270;\nint n,inv,lim=1,fre,id[N];\nint fac[N],Ifac[N],g2[N];\narr f,g,h,ans,tmp;\ninline int inc(ll x,ll y){return x+y>=mod?x+y-mod:x+y;}\ninline int dec(ll x,ll y){return x-y<0?x-y+mod:x-y;}\ninline int mul(ll x,ll y){return 1ll*x*y%mod;}\ninline int read()\n{\n\tint s=0,w=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9') s=s*10+ch-'0',ch=getchar();\n\treturn s*w;\n}\ninline int ksm(int a,int b)\n{\n\tint tmp=1;\n\twhile(b)\n\t{\n\t\tif(b&1)tmp=mul(tmp,a);\n\t\tb>>=1,a=mul(a,a);\n\t}\n\treturn tmp;\n}\ninline void Never_Tell_TLE(ll* NTT,int sign)\n{\n\tfor(int i=0;i<=lim;++i)if(i<id[i])\n\t{\n\t\tll NTt=NTT[i];\n\t\tNTT[i]=NTT[id[i]];\n\t\tNTT[id[i]]=NTt;\n\t}\n\tfor(int mid=1;mid<lim;mid<<=1)\n\t{\n\t\tint Unit_root;\n\t\tif(sign==1)Unit_root=ksm(3,(mod-1)/(mid<<1));\n\t\telse Unit_root=ksm(inv3,(mod-1)/(mid<<1));\n\t\tfor(int R=mid<<1,r=0;r<lim;r+=R)\n\t\t{\n\t\t\tint pw=1;\n\t\t\tfor(int l=0;l<mid;++l,pw=(1ll*pw*Unit_root)%mod)\n\t\t\t{\n\t\t\t\tint butt=NTT[l+r],rfly=(1ll*pw*NTT[l+r+mid])%mod;\n\t\t\t\tNTT[l+r]=inc(butt,rfly);\n\t\t\t\tNTT[l+r+mid]=dec(butt,rfly);\n\t\t\t}\n\t\t}\n\t}\n\tif(sign==-1)\n\t{\n\t\tint inv_lim=ksm(lim,mod-2);\n\t\tfor(int i=0;i<=lim;++i)NTT[i]=mul(NTT[i],inv_lim);\n\t}\n}\ninline void solve(ll* F,ll* G,int nm)\n{\n\tif(nm==1)\n\t{\n\t\tG[0]=ksm(F[0],mod-2);\n\t\treturn;\n\t}\n\tsolve(F,G,(nm+1)>>1);\n\tlim=1,fre=0;\n\tfor(;lim<(nm<<1);lim<<=1)++fre;\n\tfor(int i=0;i<lim;++i)id[i]=(id[i>>1]>>1)|((i&1)<<(fre-1));\n\tfor(int i=0;i<nm;++i)ans[i]=F[i],tmp[i]=G[i];\n\tfor(int i=nm;i<=lim;++i)ans[i]=tmp[i]=0;\n\tNever_Tell_TLE(ans,1),Never_Tell_TLE(tmp,1);\n\tfor(int i=0;i<lim;++i)G[i]=mul(inc((2ll-mul(ans[i],tmp[i])),mod),tmp[i]);\n\tNever_Tell_TLE(G,-1);\n\tfor(int i=nm;i<=lim;++i)G[i]=0;\n}\ninline void MUL(ll* F,ll* G,int nm)\n{\n\tlim=1,fre=0;\n\tfor(;lim<=(nm<<1);lim<<=1)++fre;\n\tfor(int i=0;i<lim;++i)id[i]=(id[i>>1]>>1)|((i&1)<<(fre-1));\n\tfor(int i=0;i<nm;++i)ans[i]=F[i],tmp[i]=G[i];\n\tfor(int i=nm;i<=lim;++i)ans[i]=tmp[i]=0;\n\tNever_Tell_TLE(ans,1),Never_Tell_TLE(tmp,1);\n\tfor(int i=0;i<lim;++i)G[i]=mul(ans[i],tmp[i]);\n\tNever_Tell_TLE(G,-1);\n\tfor(int i=nm;i<=lim;++i)G[i]=0;\n}\nint main()\n{\n\tn=read();\n\tfac[0]=Ifac[0]=1;\n\tfor(int i=1;i<=n;++i)fac[i]=mul(fac[i-1],i);\n\tIfac[n]=ksm(fac[n],mod-2);\n\tfor(int i=n-1;i;--i)Ifac[i]=mul(Ifac[i+1],i+1);\n\t++n;\n\tfor(int i=0;i<n;++i)g2[i]=ksm(2,1ll*i*(i-1)/2%(mod-1));\n\tfor(int i=0;i<n;++i)f[i]=mul(g2[i],Ifac[i]);\n\tfor(int i=1;i<n;++i)g[i]=mul(g2[i],Ifac[i-1]);\n\tsolve(f,h,n);\n\tMUL(g,h,n);\n\t--n;\n\tprintf(\"%lld\",mul(h[n],fac[n-1]));\n\treturn 0;\n}\n```\n\u53ea\u6c42\u80fd\u5e2e\u52a9\u5230\u51e0\u4e2a\u4eba\u7f62\u3002\u3002",
        "postTime": 1620305693,
        "uid": 206024,
        "name": "Illusory_dimes",
        "ccfLevel": 7,
        "title": "[\u96c6\u8bad\u961f\u4f5c\u4e1a2013]\u57ce\u5e02\u89c4\u5212 \u9898\u89e3"
    },
    {
        "content": "\u8bbe$f(i)$\u4e3a$i$\u4e2a\u70b9\u7684\u9898\u76ee\u6240\u6c42\u7684\u7b54\u6848\uff0c$g(i)$\u4e3a$i$\u4e2a\u70b9\u968f\u4fbf\u8fde\u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u6211\u4eec\u679a\u4e3e$1$\u53f7\u70b9\u6240\u5728\u8054\u901a\u5757\u7684\u5927\u5c0f\uff0c\u53ef\u5f97\uff1a\n$$g(n)=\\sum_{i=1}^nf(i)\\binom{n-1}{i-1}g(n-i)=2^{\\binom{n}{2}}=2^{n(n-1)/2}$$\n\u5bb9\u6613\u77e5\u9053\u8fd9\u6837\u53ef\u4ee5\u4e0d\u91cd\u4e0d\u6f0f\u7684\u7b97\u5230\u6240\u6709\u72b6\u6001\u3002\n\n\u6211\u4eec\u628a$g$\u5e26\u8fdb\u53bb\uff1a\n$$2^{n(n-1)/2}=\\sum_{i=1}^nf(i)\\binom{n-1}{i-1}2^{\\binom{n-i}{2}}$$\n\u4e24\u8fb9\u9664\u4ee5$(n-1)!$\uff1a\n$$\\frac{2^{n(n-1)/2}}{(n-1)!}=\\sum_{i=1}^n\\frac{f(i)}{(i-1)!}\\times \\frac{2^{\\binom{n-i}{2}}}{(n-i)!}$$\n\u6ce8\u610f\u5230\u8fd9\u662f\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u7528\u751f\u6210\u51fd\u6570\u8868\u793a\u4e00\u4e0b\uff1a\n$$A(x)=\\sum_{n=0}^\\infty\\frac{2^{n(n-1)/2}}{(n-1)!}x^n$$\n$$B(x)=\\sum_{n=0}^\\infty\\frac{2^{n(n-1)/2}}{n!}x^n$$\n$$F(x)=\\sum_{n=0}^\\infty\\frac{f(i)}{(n-1)!}x^n$$\n\u90a3\u4e48\uff1a\n$$A(x)=F(x)B(x),F(x)=A(x)B^{-1}(x)$$\n\u90a3\u4e48\u76f4\u63a5\u5957\u591a\u9879\u5f0f\u6c42\u9006\u7684\u677f\u5b50\u5c31\u597d\u4e86\u3002\n\n```c++\n#include<bits/stdc++.h>\nusing namespace std;\n \nvoid read(int &x) {\n    x=0;int f=1;char ch=getchar();\n    for(;!isdigit(ch);ch=getchar()) if(ch=='-') f=-f;\n    for(;isdigit(ch);ch=getchar()) x=x*10+ch-'0';x*=f;\n}\n \nvoid print(int x) {\n    if(x<0) putchar('-'),x=-x;\n    if(!x) return ;print(x/10),putchar(x%10+48);\n}\nvoid write(int x) {if(!x) putchar('0');else print(x);putchar('\\n');}\n\n#define lf double\n#define ll long long \n\nconst int maxn = 6e5+10;\nconst int inf = 1e9;\nconst lf eps = 1e-8;\nconst int mod = 1004535809;\n\nint n,w[maxn],rw[maxn],pos[maxn],f[maxn],a[maxn],b[maxn],c[maxn],mxn,N,bit,fac[maxn],ifac[maxn],g[maxn];\n\nint qpow(int aa,int x) {\n\tint res=1;\n\tfor(;x;x>>=1,aa=1ll*aa*aa%mod) if(x&1) res=1ll*res*aa%mod;\n\treturn res;\n}\n\nvoid prepare() {\n\tw[0]=1,w[1]=qpow(3,(mod-1)/mxn);\n\tfor(int i=2;i<=mxn;i++) w[i]=1ll*w[i-1]*w[1]%mod;\n\trw[0]=1,rw[1]=qpow(qpow(3,mod-2),(mod-1)/mxn);\n\tfor(int i=2;i<=mxn;i++) rw[i]=1ll*rw[i-1]*rw[1]%mod;\n}\n\nvoid ntt(int *r,int op) {\n\tfor(int i=1;i<N;i++) if(pos[i]>i) swap(r[i],r[pos[i]]);\n\tfor(int i=1,d=mxn>>1;i<N;i<<=1,d>>=1) \n\t\tfor(int j=0;j<N;j+=i<<1)\n\t\t\tfor(int k=0;k<i;k++) {\n\t\t\t\tint x=r[j+k],y=1ll*r[i+j+k]*(op==1?w:rw)[k*d]%mod;\n\t\t\t\tr[j+k]=(x+y)%mod,r[i+j+k]=(x-y+mod)%mod;\n\t\t\t}\n\tif(op==-1) {\n\t\tint inv=qpow(N,mod-2);\n\t\tfor(int i=0;i<N;i++) r[i]=1ll*r[i]*inv%mod;\n\t}\n}\n\nint tmp1[maxn],tmp2[maxn];\n\nvoid get_inv(int *r,int *s,int len) {\n\tif(len==1) return s[0]=qpow(r[0],mod-2),void();\n\tget_inv(r,s,len>>1);\n\tfor(int i=0;i<len>>1;i++) tmp1[i]=s[i];\n\tfor(int i=len>>1;i<len;i++) tmp1[i]=0;\n\tfor(int i=0;i<len;i++) tmp2[i]=r[i];\n\n\tfor(bit=0,N=1;N<=len;N<<=1,bit++);\n\tfor(int i=1;i<N;i++) pos[i]=pos[i>>1]>>1|((i&1)<<(bit-1));\n\tfor(int i=len;i<N;i++) tmp1[i]=tmp2[i]=0;\n\tntt(tmp1,1),ntt(tmp2,1);\n\tfor(int i=0;i<N;i++) s[i]=((2ll*tmp1[i]%mod-1ll*tmp2[i]*tmp1[i]%mod*tmp1[i]%mod)%mod+mod)%mod;\n\tntt(s,-1);\n\tfor(int i=len;i<N;i++) s[i]=0;\n}\n\nint main() {\n\tread(n);\n\tfor(mxn=1;mxn<=n<<1;mxn<<=1);\n\tprepare();\n\tfac[0]=ifac[0]=c[0]=1;\n\tfor(int i=1;i<=mxn;i++) fac[i]=1ll*fac[i-1]*i%mod;\n\tifac[mxn]=qpow(fac[mxn],mod-2);\n\tfor(int i=mxn-1;i;i--) ifac[i]=1ll*ifac[i+1]*(i+1)%mod;\n\tfor(int i=1;i<=n;i++) g[i]=qpow(2,(1ll*i*(i-1)/2)%(mod-1));\n\tfor(int i=1;i<=n;i++) c[i]=1ll*g[i]*ifac[i]%mod,b[i]=1ll*g[i]*ifac[i-1]%mod;\n\t\n\tget_inv(c,a,mxn>>1);\n\tfor(bit=0,N=1;N<mxn;N<<=1,bit++);\n\tfor(int i=1;i<N;i++) pos[i]=pos[i>>1]>>1|((i&1)<<(bit-1));\n\tntt(a,1),ntt(b,1);\n\tfor(int i=0;i<N;i++) a[i]=1ll*a[i]*b[i]%mod;\n\tntt(a,-1);\n\tprintf(\"%lld\\n\",(1ll*a[n]*fac[n-1]%mod+mod)%mod);\n\treturn 0;\n}\n```",
        "postTime": 1552988199,
        "uid": 50777,
        "name": "Hyscere",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4841 \u3010\u57ce\u5e02\u89c4\u5212\u3011"
    },
    {
        "content": "\u65e0\u5411\u8054\u901a\u56fe\u8ba1\u6570\u677f\u5b50\n\n\u9996\u5148\uff0c\u8fd9\u4e2a\u592a\u96be\u4e86\uff0c\u5148\u8ba9\u6211\u4eec\u6765\u6c42\u4e00\u4e2a\u7b80\u5355\u7684\uff1a\n\n\u65e0\u5411\u56fe\u8ba1\u6570\u3002\n\n\u4e00\u5171 $ \\frac {n \\times (n+1)} 2 $ \u6761\u53ef\u80fd\u5b58\u5728\u7684\u8fb9\uff0c\u679a\u4e3e\u4e00\u6761\u8fb9\u662f\u5426\u5b58\u5728\uff0c\u5c31\u6709 $ 2^{\\frac {n \\times (n+1)} 2} $ \u4e2a\u65e0\u5411\u56fe\u3002\n\n\u56de\u5230\u672c\u9898\uff0c\u6211\u4eec\u5148\u8bbe $ f_n $ \u662f\u6211\u4eec\u8981\u6c42\u7684 $ n $ \u4e2a\u65e0\u5411\u8054\u901a\u56fe\u7684\u4e2a\u6570\uff0c $ g_n $ \u662f $ 2^{\\frac {n \\times (n+1)} 2} $\uff0c\u5f88\u660e\u663e\u6709\uff1a\n$$ g_n=\\sum_{i=1}^n\\binom{n-1}{i-1}f_ig_{n-i} $$\n\u7ec4\u5408\u6570\u540e\u9762\u7684\u662f\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u800c\u7ec4\u5408\u6570\u672c\u8eab\u5c31\u662f\u4e00\u5806\u9636\u4e58\uff0c\u8fd9\u5728\u63d0\u793a\u6211\u4eec\u4f7f\u7528 EGF\uff0c\u5e76\u4e14\u672c\u9898\u7684\u6a21\u6570\u4e5f\u662f\u4e00\u4e2a NTT \u6a21\u6570\u3002\n$$ \\frac {g_n} {(n-1)!}=\\sum_{i=1}^n \\frac {f_i} {(i-1)!} \\times \\frac {g_{n-i}} {(n-i)!} $$\n\u7136\u540e\u6211\u4eec\u8bbe $ F(x) $ \u662f { $ f_n $ } \u7684 EGF\uff0c$ G(x) $ \u662f { $ g_n $ } \u7684 EGF\u3002\n\n\u5f88\u5bb9\u6613\u53d1\u73b0\uff1a$ g_n=[x^n]G'(x) $\uff0c\u7136\u540e\u5c31\u6709\uff1a\n$$ G'(x)=F'(x)G(x) $$\n$$ \\frac {G'(x)} {G(x)}=F'(x) $$\n$$ F(x)=\\ln G(x) $$\n\u7136\u540e\u6211\u4eec\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u8d34\u4ee3\u7801\uff1a\n```cpp\n#include<cstring>\n#include<cstdio>\n#define clr(f,len) memset(f,0,(len)<<2)\n#define cpy(f,g,len) memcpy(f,g,(len)<<2)\nconst int G=3,invG=334845270,mod=1004535809,M=7e5+5;\nint n,t[M],f[M],inv[M],tor[M];\ninline void swap(int&a,int&b){\n    a^=b^=a^=b;\n}\ninline void GetRev(int len){\n    for(int i=0;i<len;++i)t[i]=t[i>>1]>>1|(i&1?len>>1:0);\n}\ninline void px(int*f,int*g,int len){\n    for(int i=0;i<len;++i)f[i]=1ll*f[i]*g[i]%mod;\n}\ninline void der(int*f,int n){\n    for(int i=1;i<n;++i)f[i-1]=1ll*f[i]*i%mod;\n    f[n-1]=0;\n}\ninline void itg(int*f,int n){\n    for(int i=n;i;--i)f[i]=1ll*f[i-1]*inv[i]%mod;\n    f[0]=0;\n}\ninline int pow(int a,int b=mod-2){\n    int ans=1;\n    for(;b;b>>=1,a=1ll*a*a%mod)if(b&1)ans=1ll*ans*a%mod;\n    return ans;\n}\nvoid NTT(int*f,bool flag,int n){\n    int i,k,p,w,w1,len;\n    for(i=0;i<n;++i)if(i<t[i])swap(f[i],f[t[i]]);\n    for(p=2;p<=n;p<<=1){\n        len=p>>1;w1=pow(flag?G:invG,(mod-1)/p);\n        for(k=0;k<n;k+=p){\n            w=1;\n            for(i=k;i<k+len;++i){\n                int t=1ll*f[i+len]*w%mod;\n                if((f[i+len]=f[i]-t)<0)f[i+len]+=mod;\n                if((f[i]=f[i]+t)>mod)f[i]-=mod;\n                w=1ll*w*w1%mod;\n            }\n        }\n    }\n    if(flag)return;\n    int invN=pow(n);\n    for(i=0;i<n;++i)f[i]=1ll*f[i]*invN%mod;\n}\nvoid invp(int*f,int m){\n    static int b1[M],b2[M],b3[M];\n    int i,n=1,len;b1[0]=pow(f[0]);\n    while(n<m)n<<=1;\n    for(len=2;len<=n;len<<=1){\n        for(i=0;i<(len>>1);++i)b3[i]=(b1[i]<<1)%mod;\n        cpy(b2,f,len);\n        GetRev(len<<1);\n        NTT(b1,1,len<<1);px(b1,b1,len<<1);\n        NTT(b2,1,len<<1);px(b1,b2,len<<1);\n        NTT(b1,0,len<<1);clr(b1+len,len);\n        for(i=0;i<len;++i)b1[i]=(b3[i]-b1[i]+mod)%mod;\n    }\n    cpy(f,b1,m);clr(b1,n<<1);clr(b2,n<<1);clr(b3,n<<1);\n}\nvoid lnp(int*f,int n){\n    static int sav[M];\n    cpy(sav,f,n);\n    der(f,n);invp(sav,n);\n    GetRev(n<<1);\n    NTT(f,1,n<<1);NTT(sav,1,n<<1);\n    px(f,sav,n<<1);NTT(f,0,n<<1);\n    itg(f,n-1);\n    clr(f+n,n);clr(sav,n);\n}\nsigned main(){\n    int i,m=1,tmp1,tmp2;\n    inv[1]=tor[0]=tor[1]=1;\n    scanf(\"%d\",&n);++n;\n    while(m<n)m<<=1;\n    GetRev(m);\n    for(i=2;i<=m;++i){\n        inv[i]=1ll*(mod-mod/i)*inv[mod%i]%mod;\n        tor[i]=1ll*tor[i-1]*i%mod;\n    }\n    for(i=0;i<m;++i)f[i]=1ll*pow(2,(1ll*i*(i-1)>>1)%(mod-1))*pow(tor[i])%mod;\n    lnp(f,m);\n    printf(\"%d\",1ll*f[n-1]*tor[n-1]%mod);\n}\n```",
        "postTime": 1602924899,
        "uid": 160839,
        "name": "Prean",
        "ccfLevel": 7,
        "title": "\u6570\u8bba \u591a\u9879\u5f0f P4841\u9898\u89e3"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](http://cmsblog.top/archives/-ji-xun-dui-zuo-ye-2013-cheng-shi-gui-hua)\n\n## \u9898\u76ee\u63cf\u8ff0\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4841)\n\n## \u601d\u8def\n\n\u5957\u8def\u9898\u3002\n\n\u8bbe $f_i$ \u8868\u793a\u7531 $i$ \u4e2a\u70b9\u6240\u7ec4\u6210\u7684\u8054\u901a\u65e0\u5411\u56fe\u4e2a\u6570\uff0c$g_i$ \u8868\u793a\u7531 $i$ \u4e2a\u70b9\u7ec4\u6210\u7684\u65e0\u5411\u56fe\u4e2a\u6570\uff0c\u4e0d\u4fdd\u8bc1\u8054\u901a\u3002\n\n\u7531\u4e8e\u6ca1\u6709\u91cd\u8fb9\u4e0e\u81ea\u73af\uff0c $i$ \u4e2a\u70b9\u6700\u591a\u6709 $\\binom{n}{2}$ \u6761\u8fb9\uff0c\u5219\u6709 $g_i = 2^{\\binom{n}{2}}$\u3002\n\n\u8003\u8651 $g_i$ \u600e\u4e48\u8868\u793a\uff0c\u679a\u4e3e $i$ \u53f7\u70b9\u6240\u5728\u7684\u8fde\u901a\u5757\u5927\u5c0f\uff0c\u5219\u6709\uff1a\n\n$$\ng_n = \\sum_{i=1}^n\\binom{n-1}{i-1}f_ig_{n-i}\n$$\n\n$$\n\\Rightarrow \\frac{2^{\\binom{n}{2}}}{(n-1)!} = \\sum_{i=1}^n\\frac{f_i}{(i-1)!}\\cdot\\frac{2^\\binom{{n-i}}{2}}{(n-i)!}\n$$\n\n\u8fd9\u4e2a\u4e1c\u897f\u770b\u8d77\u6765\u5c31\u5f88 OGF\u3002\n\n\u8bbe \n\n$$\nF(x) = \\sum_{n=1}^\\infty \\frac{f_n}{(n-1)!}x^n\n$$\n\n$$\nG(x) = \\sum_{n=1}^\\infty \\frac{2^{\\binom{n}{2}}}{n!}x^n\n$$\n\n$$\nH(x) = \\sum_{i=1}^\\infty \\frac{2^\\binom{{n}}{2}}{(n-1)!}x^n\n$$\n\n\u663e\u7136\u6709\uff1a\n\n$$\nH(x) = F(x) \\times G(x)\n\\Leftrightarrow F(x) = H(x) \\times G^{-1}(x)\n$$\n\n\u76f4\u63a5\u591a\u9879\u5f0f\u6c42\u9006\u5373\u53ef\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll mod = 1004535809, g = 3, MAXN = 130000 << 4;\n\nll qpow(ll a, ll b) {\n\tll res = 1;\n\twhile (b) {\n\t\tif (b & 1ll) res = res * a % mod;\n\t\ta = a * a % mod;\n\t\tb >>= 1ll;\n\t}\n\treturn res;\n}\n\nint r[MAXN];\n\nint limit;\nvoid init(int l) {\n\tfor (int i = 0; i < limit; i++)\n\t\tr[i] = (r[i >> 1] >> 1) | ((i & 1) << (l - 1));\n}\n\nvoid NTT(ll* f, int type) {\n\tfor (int i = 0; i < limit; i++)\n\t\tif (i < r[i])\n\t\t\tswap(f[i], f[r[i]]);\n\t\n\tfor (int mid = 1; mid < limit; mid <<= 1) {\n\t\tll W = qpow(g, (mod - 1) / (mid << 1));\n\t\tif (type == -1) W = qpow(W, mod - 2);\n\t\tfor (int R = mid << 1, j = 0; j < limit; j += R) {\n\t\t\tll w = 1;\n\t\t\tfor (int k = 0; k < mid; k++, w = w * W % mod) {\n\t\t\t\tll x = f[j + k], y = w * f[j + k + mid] % mod;\n\t\t\t\tf[j + k] = (x + y) % mod;\n\t\t\t\tf[j + k + mid] = (x - y + mod) % mod;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (type == 1) return;\n\tll inv = qpow(limit, mod - 2);\n\tfor (int i = 0; i < limit; i++)\n\t\tf[i] = (f[i] * inv + mod) % mod;\n}\n\nll c[MAXN];\n\n\nvoid GetInv(ll* f, ll* g, int n) {\n\tif (n == 1) {\n\t\tg[0] = qpow(f[0], mod - 2);\n\t\treturn;\n\t}\n\tGetInv(f, g, n + 1 >> 1);\n\tlimit = 1;\n\tint l = 0;\n\twhile (limit <= n + n) limit <<= 1, l++;\n\tinit(l);\n\tfor (int i = 0; i < n; i++) c[i] = f[i];\n\tfor (int i = n; i < limit; i++) c[i] = 0;\n\tNTT(c, 1);\n\tNTT(g, 1);\n\tfor (int i = 0; i < limit; i++)\n\t\tg[i] = ((2ll - g[i] * c[i] % mod) + mod) % mod * g[i] % mod;\n\tNTT(g, -1);\n\tfor (int i = n; i < limit; i++)\n\t\tg[i] = 0;\n}\n\nll F[MAXN], G[MAXN], H[MAXN], _G[MAXN];\nll Fiv[MAXN], InvFiv[MAXN];\nll N;\n\nint main() {\n\tios::sync_with_stdio(false); cin.tie(0); cout.tie(0);\n\tcin >> N;\n\tN++;\n\tFiv[0] = InvFiv[0] = 1;\n\tfor (int i = 1; i <= N; i++) {\n\t\tFiv[i] = Fiv[i - 1] * i % mod;\n\t\tInvFiv[i] = qpow(Fiv[i], mod - 2);\n\t}\n\tfor (int i = 0; i < N; i++) {\n\t\tG[i] = qpow(2, 1ll * i * (i - 1) / 2 % (mod - 1)) * InvFiv[i] % mod;\n\t\tif (i) H[i] = qpow(2, 1ll * i * (i - 1) / 2 % (mod - 1)) * InvFiv[i - 1] % mod;\n\t}\n\t\n\tGetInv(G, _G, N);\n\n\tlimit = 1;\n\tint l = 0;\n\twhile (limit <= N * 2) limit <<= 1, l++;\n\tNTT(_G, 1); NTT(H, 1);\n\tfor (int i = 0; i < limit; i++) F[i] = _G[i] * H[i] % mod;\n\tNTT(F, -1);\n\tN--;\n\tcout << F[N] * Fiv[N - 1] % mod << endl;\n\treturn 0;\n}\n```",
        "postTime": 1685015614,
        "uid": 461426,
        "name": "CmsMartin",
        "ccfLevel": 6,
        "title": "[\u96c6\u8bad\u961f\u4f5c\u4e1a2013]\u57ce\u5e02\u89c4\u5212"
    },
    {
        "content": "## $\\textbf{Description}$\n\n>\u6c42 $n$ \u4e2a\u70b9\u7684\u6709\u6807\u53f7\u7684\u65e0\u5411\u8fde\u901a\u56fe\u6570\u76ee\u3002          \n$\\text{restrictions}:1\\le n\\le1.3\\times10^5$\n\n## $\\textbf{solution}$\n\n\u6211\u4eec\u8bbe $g_i$ \u8868\u793a\u6709 $i$ \u4e2a\u70b9\u7684**\u6709\u6807\u53f7\u65e0\u5411\u56fe**\u6570\u76ee\uff0c\u6613\u5f97 $g_i = 2^{C_n^2}$\u3002\n\n>\u8003\u8651\u679a\u4e3e\u6bcf\u4e24\u4e2a\u70b9\u4e4b\u95f4\u662f\u5426\u8fde\u901a\u3002\n\n\u8bbe $f_i$ \u8868\u793a\u6709 $i$ \u4e2a\u70b9\u7684\u8fde\u901a\u56fe\u6570\u76ee\uff08\u5373\u7b54\u6848\u6240\u6c42\uff09\u3002\n\n\u5219\u53ef\u5f97\uff1a\n\n$$\ng_n = \\sum_{i=1}^n C_{n-1}^{i-1}f_i g_{n-i}\n$$\n\n>\u8003\u8651 $1$ \u53f7\u70b9\u6240\u5904\u7684\u8fde\u901a\u5757\u5927\u5c0f $i$\uff0c\u5219\u9700\u8981\u4ece $n-1$ \u4e2a\u70b9\u4e2d\u9009\u51fa $i-1$ \u4e2a\u70b9\uff0c\u5269\u4e0b $n-i$ \u4e2a\u70b9\u968f\u4fbf\u6392\u5217\uff0c\u5373 $g_i$ \u7684\u542b\u4e49\u3002\n\n\u63a8\u4e00\u6ce2\u5f0f\u5b50\uff1a\n\n$$\ng_n = \\sum_{i=1}^n C_{n-1}^{i-1}f_i g_{n-i}\n$$\n$$\ng_n = (n-1)!\\sum_{i=1}^n \\frac {f_i} {(i-1)!} \\times \\frac {g_{n-i}} {(n-i)!} \n$$\n$$\n\\frac {g_n} {(n-1)!} = \\sum_{i=1}^n \\frac {f_i} {(i-1)!} \\times \\frac {g_{n-i}} {(n-i)!} \n$$\n\n\u8bbe \n\n$$\nF(x) = \\sum_{i=1}^{+\\infty}\\frac {f_i} {(i-1)!}x^n \n$$\n$$\nG(x) = \\sum_{i=1}^{+\\infty}\\frac {g_i} {(i-1)!}x^n\n$$\n$$\nH(x) = \\sum_{i=0}^{+\\infty}\\frac {g_i} {i!} x^n\n$$\n\n\u5219 \n$$\nF = H*G^{-1}\n$$\n$$\nf(x) = \\frac {F(x)} {(n-1)!}\n$$\n\n$G,H$ \u53ef\u4ee5\u9884\u5904\u7406\uff0c\u5957\u4e2a\u591a\u9879\u5f0f\u6c42\u9006\u7684\u677f\u5b50\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n\\log n)$",
        "postTime": 1620904270,
        "uid": 413147,
        "name": "_Alejandro_",
        "ccfLevel": 0,
        "title": "P4841\u9898\u89e3"
    },
    {
        "content": "[\u9898\u9762](https://www.luogu.com.cn/problem/P4841)\n\n---\n\n**\u3010\u5206\u6790\u3011**\n-\n\n\u4ee4 $f_n$ \u8868\u793a $n$ \u4e2a\u70b9\u7684\u7b80\u5355\u65e0\u5411\u8fde\u901a\u56fe\u65b9\u6848\u6570\n\n\u518d\u4ee4 $g_n$ \u8868\u793a $n$ \u4e2a\u70b9\u7684\u7b80\u5355\u65e0\u5411\u56fe\u65b9\u6848\u6570\n\n\u4e0d\u96be\u60f3\u5230\uff1a\n1. \u7b54\u6848\u5373\u4e3a $f_n$ \uff0c\u521d\u59cb\u503c $f_0=1$\n2. $g_n=2^{\\displaystyle (^n_2)}$ \uff0c\u539f\u56e0\u662f\u8003\u8651\u6bcf\u6761\u8fb9\u90fd\u53ef\u9009\u6216\u4e0d\u9009\uff0c\u5171 $(^n_2)$ \u6761\u8fb9\n3. $\\displaystyle g_n=\\sum_{i=1}^n(^{n-1}_{i-1})f_ig_{n-i}(i>0)$ \uff0c\u539f\u56e0\u662f\u8003\u8651\u7f16\u53f7\u4e3a $1$ \u7684\u70b9\uff0c\u6240\u5728\u7684\u8fde\u901a\u5757\u5927\u5c0f\u4e3a $i$ \uff0c\u5269\u4e0b\u7684\u70b9\u968f\u610f\u7ec4\u5408\n\n\u56e0\u6b64\u5bf9\u7b2c\u4e09\u4e2a\u5f0f\u5b50\u8fdb\u884c\u53d8\u5f62\uff1a\n\n$\\displaystyle {g_n\\over (n-1)!}=\\sum_{i=1}^n{f_i\\over (i-1)!}\\cdot {g_{n-i}\\over (n-i)!}(i>0)$\n\n\u5373 $\\displaystyle {g_{n+1}\\over n!}=\\sum_{i=0}^n {f_{i+1}\\over i!}\\cdot {g_{n-i}\\over (n-i)!}$\n\n\u8003\u8651\u5e8f\u5217 $\\{f_n\\},\\{g_n\\}$ \u7684 EGF \u5206\u522b\u4e3a $F(x),G(x)$\n\n$\\displaystyle F(x)=\\sum_{n=0}^\\infty {f_n\\over n!}x^n$\n\n$\\displaystyle G(x)=\\sum_{n=0}^\\infty {g_n\\over n!}x^n$\n\n\u5c06\u8fd9\u4e24\u4e2a EGF \u6c42\u5bfc\u5f97\uff1a\n\n$\\displaystyle F'(x)=\\sum_{n=1}^\\infty {f_n\\over n!}\\cdot n\\cdot x^{n-1}=\\sum_{n=0}^\\infty {f_{n+1}\\over n!}x^n$\n\n$\\displaystyle G'(x)=\\sum_{n=1}^\\infty {g_n\\over n!}\\cdot n\\cdot x^{n-1}=\\sum_{n=0}^\\infty {g_{n+1}\\over n!}x^n$\n\n\u53d1\u73b0\u6070\u597d\u4e0e\u6211\u4eec\u7b2c\u4e09\u4e2a\u5f0f\u5b50\u7684\u5de6\u4fa7\u5f0f\u3001\u5377\u79ef\u7684\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u76f8\u540c\uff01\n\n\u4e8e\u662f\u6211\u4eec\u6839\u636e\u5f0f\u5b50\uff0c\u5199\u51fa\u5377\u79ef\uff1a$G'(x)=F'(x)\\cdot G(x)$\n\n\u56e0\u6b64 $\\displaystyle F(x)=\\int {G'(x)\\over G(x)}\\text dx+f_0$\n\n\u6c42\u89e3 $G(x)$ \u65f6\uff0c\u6bcf\u4e00\u9879\u7684 $g_n$ \u7528 $2^{\\displaystyle (^n_2)}$ \u4ee3\u5165\u5373\u53ef\n\n\u5f53\u7136\uff0c\u8be5\u5f0f\u5b50\u80fd\u8fdb\u4e00\u6b65\u5316\u7b80\uff1a\n\n$\\displaystyle F(x)=\\int {\\text d[G(x)]\\over G(x)}=\\ln G(x)+f_0$\n\n---\n\n**\u3010\u4ee3\u7801\u3011**\n-\n\n\u4f7f\u7528\u591a\u9879\u5f0f\u7684\u677f\u5b50\u5373\u53ef\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int MAXN=1<<18,MOD=1004535809;\ninline int add(int a,int b) { return (a+b>=MOD)?(a+b-MOD):(a+b); }\ninline int dis(int a,int b) { return (a-b<0)?(a-b+MOD):(a-b); }\ninline int fpow(ll a,ll x) { ll ans=1; for(;x;x>>=1,a=a*a%MOD) if(x&1) ans=ans*a%MOD; return ans; }\n//\u5feb\u901f\u5e42\ninline int inv(ll a) { return fpow(a,MOD-2); }//\u9006\u5143\nint Omega[2][22],Frac[MAXN],InF[MAXN],InV[MAXN];\ninline void pre(){\n    Omega[1][18]=fpow(3,MOD>>18);\n    Omega[0][18]=inv( Omega[1][18] );\n    for(int i=17;i>=0;i--)\n        Omega[1][i]=1ll*Omega[1][i+1]*Omega[1][i+1]%MOD,\n        Omega[0][i]=1ll*Omega[0][i+1]*Omega[0][i+1]%MOD;\n    //\u9884\u5904\u7406\u5355\u4f4d\u6839\n    \n    Frac[0]=1;\n    for(int i=1;i<=2e5;i++) Frac[i]=1ll*Frac[i-1]*i%MOD;\n    InF[int(2e5)]=inv(Frac[int(2e5)]);\n    for(int i=2e5;i>=0;i--) InF[i-1]=1ll*InF[i]*i%MOD;\n    for(int i=1;i<=2e5;i++) InV[i]=1ll*InF[i]*Frac[i-1]%MOD;\n    //\u9884\u5904\u7406\u9636\u4e58\u3001\u9636\u4e58\u9006\u5143\u3001\u9006\u5143\n}\nint L,Rev[MAXN],invL;\ninline void preNTT(){\n    Rev[1]=L>>1;\n    for(int i=2;i<L;i++) Rev[i]=(Rev[i>>1]>>1)|Rev[i&1];\n    invL=inv(L);\n}\ninline void NTT(int f[MAXN],short op){//op=0 \u8868\u793a IDFT\n    for(int i=1;i<L;i++) if(i<Rev[i]) swap(f[i],f[Rev[i]]);\n    for(int bas=2,mid=1,lb=1;bas<=L;bas<<=1,mid<<=1,lb++)\n        for(int l=0,omega=Omega[op][lb],buf,tmp;buf=1,l<L;l+=bas)\n            for(int k=l;tmp=1ll*buf*f[k+mid]%MOD,k<mid+l;k++,buf=1ll*buf*omega%MOD)\n                f[k+mid]=dis(f[k],tmp),f[k]=add(f[k],tmp);\n    if(!op) for(int i=0;i<L;i++) f[i]=1ll*f[i]*invL%MOD;\n}\ninline void mul(int f[MAXN],int g[MAXN],int h[MAXN],int N,int M,int mod=-1){\n    static int p[MAXN],q[MAXN];\n    L=1;\n    while(L<N+M) L<<=1;\n    preNTT();\n    for(int i=0;i<L;i++) p[i]=q[i]=0;\n    for(int i=0;i<N;i++) p[i]=f[i];\n    for(int i=0;i<M;i++) q[i]=g[i];\n    //\u5148\u62f7\u8d1d\u518d\u53d8\u6362\n    NTT(p,1);\n    NTT(q,1);\n    for(int i=0;i<L;i++) h[i]=1ll*p[i]*q[i]%MOD;\n    NTT(h,0);\n    if(mod>=0) for(int i=mod;i<L;i++) h[i]=0;\n}\ninline void inv(int f[MAXN],int g[MAXN],int mod){//\u591a\u9879\u5f0f\u6c42\u9006\n    static int p[MAXN];\n    if(mod==1){\n        g[0]=inv(f[0]);\n        return ;\n    }\n    inv(f,g,mod+1>>1);\n    for(int i=0;i<mod;i++) p[i]=0;\n    mul(f,g,p,mod,mod,mod);\n    for(int i=0;i<mod;i++) p[i]=dis(0,p[i]);\n    p[0]=add(p[0],2);\n    mul(g,p,g,mod,mod,mod);\n}\ninline void ddx(int f[MAXN],int g[MAXN],int mod){//\u591a\u9879\u5f0f\u6c42\u5bfc\n    static int p[MAXN];\n    for(int i=0;i<mod;i++) p[i]=f[i+1]*(i+1ll)%MOD;\n    for(int i=0;i<mod;i++) g[i]=p[i];\n}\ninline void intdx(int f[MAXN],int g[MAXN],int mod,int C=0){//\u591a\u9879\u5f0f\u79ef\u5206\n    static int p[MAXN];\n    for(int i=1;i<mod;i++) p[i]=1ll*f[i-1]*InV[i]%MOD; p[0]=C;\n    for(int i=0;i<mod;i++) g[i]=p[i];\n}\ninline void ln(int f[MAXN],int g[MAXN],int mod,int C=0){//\u591a\u9879\u5f0f\u5bf9\u6570\n    static int p[MAXN],q[MAXN];\n    ddx(f,p,mod);\n    inv(f,q,mod);\n    mul(p,q,g,mod,mod,mod);\n    intdx(g,g,mod,C);\n}\nint F[MAXN],G[MAXN],N;\ninline void work(){\n    pre();\n    static int p[MAXN],q[MAXN];\n    N=1.3e5;\n    for(int i=0;i<=N;i++) G[i]=fpow(2,1ll*i*(i-1)/2);\n    for(int i=0;i<=N;i++) G[i]=1ll*G[i]*InF[i]%MOD;//OGF->EGF\n    ln(G,F,N,1);\n    for(int i=0;i<N;i++) F[i]=1ll*F[i]*Frac[i]%MOD;//EGF->OGF\n}\nint main(){\n    ios::sync_with_stdio(0);\n    cin.tie(0);\n    cout.tie(0);\n    work();\n    cin>>N;\n    cout<<F[N]<<endl;\n    return 0;\n}\n```\n\n\u6700\u540e\u5b89\u5229\u4e00\u4e0b[\u672c\u849f\u84bb\u7684\u535a\u5ba2](https://www.luogu.com.cn/blog/JustinRochester/)",
        "postTime": 1604418246,
        "uid": 36031,
        "name": "JustinRochester",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P4841 \u3010[\u96c6\u8bad\u961f\u4f5c\u4e1a2013]\u57ce\u5e02\u89c4\u5212\u3011"
    },
    {
        "content": "\u6211\u6765\u8865\u4e00\u53d1\u591a\u9879\u5f0f\u6c42\u9006\u7684\u9898\u89e3\u3002\u601d\u8def\u662f\u4ece$Misckoo$\u90a3\u91cc\u6765\u7684\u3002  \n~~\u6bd5\u7adf\u8fd9\u9898\u597d\u50cf\u6807\u7b97\u662f\u6c42\u9006~~  \n\u6211\u4eec\u4ee4$g(n)$\u8868\u793a\u6709n\u4e2a\u70b9\u7684\u65e0\u5411\u56fe\u7684\u4e2a\u6570\uff0c$f(n)$\u8868\u793a\u6709n\u4e2a\u70b9\u7684\u65e0\u5411\u8fde\u901a\u56fe\u4e2a\u6570\u3002  \n$g(n)$\u6bd4\u8f83\u597d\u6c42\uff0c\u56e0\u4e3a\u4e00\u5171\u6709$C_n^2$\u6761\u8fb9\uff0c\u6bcf\u6761\u8fb9\u53ef\u4ee5\u9009\u6216\u8005\u4e0d\u9009\uff0c\u6240\u4ee5\u81ea\u7136\u6709$g(n) = 2^{C_n^2}$.  \n\n\u4e4b\u540e\u6211\u4eec\u6362\u4e00\u79cd\u65b9\u6cd5\uff0c\u5728\u8282\u70b91\u6240\u5728\u7684\u8054\u901a\u5757\u4e2d\u6709\u591a\u5c11\u4e2a\u8282\u70b9\uff0c\u5269\u4e0b\u7684\u53ea\u9700\u8981\u968f\u4fbf\u8fde\u5c31\u53ef\u4ee5\u4e86\u3002\u90a3\u4e48\u5c31\u6709$g(n) = \\sum_{i=1}^nC_{n-1}^{i-1}f(i)g(n-i)$  \n\n\u628a$g(n) = 2^{C_n^2}$\u5e26\u8fdb\u5f0f\u5b50,\u4e24\u8fb9\u518d\u540c\u65f6\u9664\u4ee5$(n-1)!$\uff0c\u5f97\u5230:\n$$\\frac{2^{C_n^2}}{(n-1)!} = \\sum_{i=1}^n\\frac{f(i)}{(i-1)!}\\frac{2^{C_{n-i}^2}}{(n-i)!}$$  \n\n\u8fd9\u73a9\u610f\u53ef\u4ee5\u770b\u51fa\u6765\u662f\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u90a3\u4e48\u6211\u4eec\u8bbe:\n$$F(x) = \\sum_{i=1}^\\infty\\frac{f(i)}{(i-1)}x^i$$  \n$$G(x) = \\sum_{i=0}^\\infty\\frac{2^{C_i^2}}{i!}x^i$$  \n$$H(x) = \\sum_{i=1}^\\infty\\frac{2^{C_i^2}}{(i-1)!}$$  \n\n\u90a3\u4e48$H(x) = F(x)G(x)$\uff0c\u5728$(mod\\ x^{n+1})$\u610f\u4e49\u4e0b\u6c42\u51fa$G(x)^{-1}$,\u90a3\u4e48$F(x) \\equiv G(x)^{-1}H(x) (mod \\ x^{n+1})$\u5373\u4e3a\u7b54\u6848\u3002\u6ce8\u610f\u6700\u540e\u8981\u4e58\u4e0a$fac[n-1]$.  \n\n\u6ce8\u610f\u4e0d\u8981\u50cf\u6211\u4e00\u6837\u72af\u667a\u969c\u9519\u8bef\u2026\u2026\u6211\u5bf9\u6307\u6570\u53d6\u6a21\u5bfc\u81f4\u7b2c\u4e00\u6b21\u53ea\u670965pts\uff0c\u4f46\u662f\u53ef\u4ee5\u5bf9mod-1\u53d6\u6a21\uff0c\u56e0\u4e3a\u6a21\u6570\u662f\u8d28\u6570\uff0c\u800c$a^{p-1} \\equiv 1(mod\\ p)$,\u5bf9\u7b54\u6848\u6ca1\u6709\u5f71\u54cd\u3002  \n\n\n```cpp\n#include<bits/stdc++.h>\n#define rep(i,a,n) for(int i = a;i <= n;i++)\n#define per(i,n,a) for(int i = n;i >= a;i--)\n#define enter putchar('\\n')\n#define fr friend inline\n#define y1 poj\n\nusing namespace std;\ntypedef long long ll;\nconst int M = 800005;\nconst int mod = 1004535809;\nconst int G = 3;\nconst int invG = 334845270;\nconst double eps = 1e-7;\n\nint read()\n{\n   int ans = 0,op = 1;char ch = getchar();\n   while(ch < '0' || ch > '9') {if(ch == '-') op = -1;ch = getchar();}\n   while(ch >= '0' && ch <= '9') ans = ans * 10 + ch - '0',ch = getchar();\n   return ans * op;\n}\n\nint n,f[M],g[M],c[M],invg[M],d[M],rev[M],fac[M],inv[M],ans;\n\nint inc(int a,int b){return (a+b) % mod;}\nint mul(int a,int b){return 1ll * a * b % mod;}\nint qpow(int a,ll b)\n{\n   int p = 1;\n   while(b)\n   {\n      if(b & 1) p = mul(p,a);\n      a = mul(a,a),b >>= 1;\n   }\n   return p;\n}\n\nvoid NTT(int *a,int l,int f)\n{\n   rep(i,0,l-1) if(i < rev[i]) swap(a[i],a[rev[i]]);\n   for(int i = 1;i < l;i <<= 1)\n   {\n      int w1 = qpow(f ? G : invG,(mod-1) / (i<<1));\n      for(int j = 0;j < l;j += (i<<1))\n      {\n\t int w = 1;\n\t rep(k,0,i-1)\n\t {\n\t    int kx = a[k+j],ky = mul(a[k+j+i],w);\n\t    a[k+j] = inc(kx,ky),a[k+j+i] = inc(kx,mod-ky),w = mul(w,w1);\n\t }\n      }\n   }\n   if(!f)\n   {\n      int inv = qpow(l,mod-2);\n      rep(i,0,l-1) a[i] = mul(a[i],inv);\n   }\n}\n\nvoid init()\n{\n   fac[0] = inv[0] = inv[1] = 1;\n   rep(i,1,n) fac[i] = mul(fac[i-1],i);\n   inv[n] = qpow(fac[n],mod-2);\n   per(i,n-1,1) inv[i] = mul(inv[i+1],i+1);\n}\n\nint C(int n,int m){return mul(mul(fac[n],inv[m]),inv[n-m]);}\n\nvoid getinv(int *a,int *b,int len)\n{\n   if(len == 1) {b[0] = qpow(a[0],mod-2);return;}\n   getinv(a,b,(len+1)>>1);\n   int l = 1,L = 0;\n   while(l < (len<<1)) l <<= 1,L++;\n   rep(i,0,l-1) rev[i] = (rev[i>>1] >> 1) | ((i&1) << (L-1));\n   rep(i,0,len-1) d[i] = a[i];\n   rep(i,len,l-1) d[i] = 0;\n   NTT(d,l,1),NTT(b,l,1);\n   rep(i,0,l-1) b[i] = mul(inc(2,mod-mul(d[i],b[i])),b[i]);\n   NTT(b,l,0);\n   rep(i,len,l-1) b[i] = 0;\n}\n\nint main()\n{\n   n = read(),init();\n   //rep(i,1,n) c[i] = mul(qpow(2,C(i,2)),inv[i-1]);\u9519\u8bef\u5199\u6cd5\n   //rep(i,0,n) g[i] = mul(qpow(2,C(i,2)),inv[i]);\n   rep(i,1,n) c[i] = mul(qpow(2,(1ll * i * (i-1) / 2)),inv[i-1]);\n   rep(i,0,n) g[i] = mul(qpow(2,(1ll * i * (i-1) / 2)),inv[i]);\n   getinv(g,invg,n+1);\n   int l = 1,L = 0;\n   while(l < n<<1) l <<= 1,L++;\n   rep(i,0,l-1) rev[i] = (rev[i>>1] >> 1) | ((i&1) << (L-1));\n   NTT(invg,l,1),NTT(c,l,1);\n   rep(i,0,l-1) c[i] = mul(c[i],invg[i]);\n   NTT(c,l,0);\n   ans = mul(c[n],fac[n-1]);\n   printf(\"%d\\n\",ans);\n   return 0;\n}\n\n```",
        "postTime": 1551494611,
        "uid": 67695,
        "name": "Captain1",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4841 \u3010\u57ce\u5e02\u89c4\u5212\u3011"
    },
    {
        "content": "**\u6ce8\u610f\uff1a\u4e0b\u6587\u4e2d\u7684\u201c\u56fe\u201d\u5747\u6307\u6709\u6807\u53f7\u65e0\u5411\u56fe\u3002**\n## \u9898\u610f\n\u7ed9\u5b9a $n$\uff0c\u6c42 $n$ \u4e2a\u8282\u70b9\u6784\u6210\u7684\u8fde\u901a\u56fe\u6570\u91cf\u3002\n## \u89e3\u6cd5 0\n\u8003\u8651 DP\u3002\n\n\u8bb0 $f_n$ \u8868\u793a $n$ \u4e2a\u8282\u70b9\u6784\u6210\u7684\u8fde\u901a\u56fe\u7684\u4e2a\u6570\uff0c$g_n$ \u8868\u793a $n$ \u4e2a\u8282\u70b9\u6784\u6210\u7684\u56fe\u7684\u4e2a\u6570\uff0c\u90a3\u4e48\u6709\uff1a\n$$f_n=g_n-\\sum_{i=1}^{n-1}{n-1\\choose i-1}f_ig_{n-i}$$\n$$g_n=2^{n\\choose 2}$$\n\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u7406\u89e3\u4e3a\u901a\u8fc7\u679a\u4e3e 1 \u53f7\u8282\u70b9\u6240\u5728\u8054\u901a\u5757\u7684\u5927\u5c0f\u6765\u6784\u9020\u975e\u8fde\u901a\u56fe\uff0c\u518d\u5728\u6240\u6709\u56fe\u4e2d\u51cf\u53bb\u975e\u8fde\u901a\u56fe\uff1b\u7b2c\u4e8c\u4e2a\u5f0f\u5b50\u5219\u6bd4\u8f83\u663e\u7136\u3002\n\n\u6734\u7d20 DP \u5373\u53ef\u6c42\u89e3\u3002\u590d\u6742\u5ea6 $O(n^2)$\u3002\n## \u89e3\u6cd5 1\n\u53d1\u73b0\u4e0a\u5f0f\u7c7b\u4f3c\u4e8e\u5206\u6cbb NTT \u7684\u5f62\u5f0f\uff0c\u4e8e\u662f\u4f7f\u7528\u5206\u6cbb NTT\u3002\u590d\u6742\u5ea6 $O(n\\log^2n)$\u3002\n## \u89e3\u6cd5 2\n~~\u4ee5\u5206\u6cbb NTT \u7684\u5c3f\u6027~~ \u6839\u636e\u6211\u4eec\u7684\u7ecf\u9a8c\uff0c\u5f88\u591a\u5206\u6cbb NTT \u7684\u9898\u76ee\u90fd\u53ef\u4ee5\u7528\u751f\u6210\u51fd\u6570\u505a\u3002\u6211\u4eec\u4e5f\u8003\u8651\u4f7f\u7528\u751f\u6210\u51fd\u6570\u3002\n\n\u5c06\u4e0a\u5f0f\u79fb\u9879\uff1a\n$$g_n=f_n+\\sum_{i=1}^{n-1}{n-1\\choose i-1}f_ig_{n-i}$$\n\u53d1\u73b0 $n-1\\choose n-1$ \u548c $g_0$ \u5747\u4e3a $1$\uff0c\u4e8e\u662f\u5c06 $f_n$ \u5408\u5e76\u5230\u6c42\u548c\u5f0f\u91cc\u9762\u53bb\uff1a\n$$g_n=\\sum_{i=1}^n{n-1\\choose i-1}f_ig_{n-i}$$\n$$g_n=\\sum_{i=1}^n\\dfrac{(n-1)!}{(i-1)!(n-i)!}f_ig_{n-i}$$\n$$\\dfrac{g_n}{(n-1)!}=\\sum_{i=1}^n\\dfrac{f_i}{(i-1)!}\\cdot\\dfrac{g_{n-i}}{(n-i)!}$$\n\u53d1\u73b0\u5f62\u5f0f\u662f\u5377\u79ef\uff0c\u6784\u9020 EGF\uff1a\n$$F(x)=\\sum_{n\\ge 1}\\dfrac{x^n}{(n-1)!}\\cdot f_n$$\n$$G(x)=\\sum_{n\\ge 0}\\dfrac{x^n}{n!}\\cdot g_n$$\n$$H(x)=\\sum_{n\\ge 1}\\dfrac{x^n}{(n-1)!}\\cdot g_n$$\n\u4e8e\u662f\uff1a\n$$H(x)=F(x)G(x)\\pmod{x^{n+1}}$$\n$$F(x)=\\dfrac{H(x)}{G(x)}\\pmod {x^{n+1}}$$\n\u4f7f\u7528\u591a\u9879\u5f0f\u6c42\u9006\u5373\u53ef\u5728 $O(n\\log n)$ \u65f6\u95f4\u5185\u89e3\u51b3\u3002\n## \u4ee3\u7801\n\u5c01\u88c5\u4e86\u7c7b\uff0c\u5e38\u6570\u7565\u5927\u3002\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int M=1004535809;\nconst int N=1<<18;\ntemplate<typename T>T qpow(T a,ll b){\n\tT res=1;\n\tfor(;b;b>>=1,a=a*a)\n\t\tif(b&1)res=res*a;\n\treturn res;\n}\nclass mint{\n\tpublic:\n\tll val;\n\tmint(ll _val=0){val=(_val%M+M)%M;}\n\tmint operator +(mint _){return (val+_.val+M)%M;}\n\tmint operator -(mint _){return (val-_.val+M)%M;}\n\tmint operator *(mint _){return val*_.val%M;}\n\tmint operator /(mint _){return *this*qpow(_,M-2);}\n\tmint operator ^(ll _){return qpow(*this,_);}\n\tmint operator +=(mint _){return *this=*this+_;}\n\tmint operator -=(mint _){return *this=*this-_;}\n\tmint operator *=(mint _){return *this=*this*_;}\n\tmint operator /=(mint _){return *this=*this/_;}\n\tmint operator ^=(ll _){return *this=*this^_;}\n};\nint rev[N*2];\nvoid NTT(int lim,mint*F,int type){\n\trev[0]=0;\n\tfor(int i=1;i<lim;i++)rev[i]=(rev[i>>1]>>1)|((i&1)*(lim>>1));\n\tfor(int i=0;i<lim;i++)if(i<rev[i])swap(F[i],F[rev[i]]);\n\tfor(int i=1;i<lim;i<<=1){\n\t\tmint wn=(mint)3^((M-1)/(i<<1));\n\t\tif(type==-1)wn=(mint)1/wn;\n\t\tfor(int j=0;j<lim;j+=(i<<1)){\n\t\t\tmint w=1;\n\t\t\tfor(int k=0;k<i;k++,w*=wn){\n\t\t\t\tmint x=F[j+k],y=w*F[j+k+i];\n\t\t\t\tF[j+k]=x+y;\n\t\t\t\tF[j+k+i]=x-y;\n\t\t\t}\n\t\t}\n\t}\n\tif(type==1)return;\n\tmint inv=(mint)1/lim;\n\tfor(int i=0;i<lim;i++)F[i]*=inv;\n}\nclass Polynom{\n\tpublic:\n\tint n;\n\tmint a[N];\n\tPolynom(int _n=-1){n=_n;memset(a,0,sizeof a);}\n\tvoid print(){\n\t\tif(n<0){puts(\"0\");return;}\n\t\tfor(int i=0;i<=n;i++)printf(\"%lld \",a[i].val);\n\t\tputs(\"\");\n\t}\n\tfriend Polynom operator +(Polynom F,Polynom G){\n\t\tPolynom H;\n\t\tH.n=max(F.n,G.n);\n\t\tfor(int i=0;i<=H.n;i++)H.a[i]=F.a[i]+G.a[i];\n\t\treturn H;\n\t}\n\tfriend Polynom operator -(Polynom F,Polynom G){\n\t\tPolynom H;\n\t\tH.n=max(F.n,G.n);\n\t\tfor(int i=0;i<=H.n;i++)H.a[i]=F.a[i]-G.a[i];\n\t\twhile(!H.a[H.n].val)H.n--;\n\t\treturn H;\n\t}\n\tfriend Polynom operator *(Polynom F,Polynom G){\n\t\tPolynom H;H.n=F.n+G.n;\n\t\tint lim=1;while(lim<=H.n)lim<<=1;\n\t\tNTT(lim,F.a,1),NTT(lim,G.a,1);\n\t\tfor(int i=0;i<lim;i++)H.a[i]=F.a[i]*G.a[i];\n\t\tNTT(lim,H.a,-1);\n\t\treturn H;\n\t}\n\tfriend Polynom inv(Polynom F){\n\t\tPolynom G=Polynom(0);G.a[0]=(mint)1/F.a[0];\n\t\tPolynom F0=Polynom(0);\n\t\tint lim;\n\t\tfor(lim=2;lim<=F.n*2;lim<<=1){\n\t\t\tfor(int i=0;i<lim;i++)F0.a[i]=F.a[i];\n\t\t\tfor(int i=lim;i<lim*2;i++)F0.a[i]=0;\n\t\t\tNTT(lim*2,F0.a,1);\n\t\t\tNTT(lim*2,G.a,1);\n\t\t\tfor(int i=0;i<lim*2;i++)\n\t\t\t\tG.a[i]*=(mint)2-F0.a[i]*G.a[i];\n\t\t\tNTT(lim*2,G.a,-1);\n\t\t\tfor(int i=lim;i<lim*2;i++)G.a[i]=0;\n\t\t}\n\t\tG.n=F.n;\n\t\tfor(int i=G.n+1;i<lim*2;i++)G.a[i]=0;\n\t\treturn G;\n\t}\n\tfriend Polynom operator /(Polynom F,Polynom G){\n\t\treverse(F.a,F.a+F.n+1);\n\t\treverse(G.a,G.a+G.n+1);\n\t\tG.n=F.n-G.n;\n\t\tPolynom H=F*inv(G);\n\t\treverse(H.a,H.a+G.n+1);\n\t\tfor(int i=G.n+1;i<=H.n;i++)H.a[i]=0;\n\t\tH.n=G.n;\n\t\treturn H;\n\t}\n\tfriend Polynom operator %(Polynom F,Polynom G){return F-(F/G)*G;}\n\tPolynom operator +=(Polynom _){return *this=*this+_;}\n\tPolynom operator -=(Polynom _){return *this=*this-_;}\n\tPolynom operator *=(Polynom _){return *this=*this*_;}\n\tPolynom operator /=(Polynom _){return *this=*this/_;}\n};\nPolynom F,G,H;\nmint fac[N],ifac[N];\nint n;\nvoid init(int N){\n\tfac[0]=1;\n\tfor(int i=1;i<=N;i++)fac[i]=fac[i-1]*i;\n\tifac[N]=(mint)1/fac[N];\n\tfor(int i=N;i>=1;i--)ifac[i-1]=ifac[i]*i;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tinit(n);\n\tG.n=n;for(int i=0;i<=n;i++)G.a[i]=((mint)2^(1ll*i*(i-1)/2))*ifac[i];\n\tH.n=n;for(int i=1;i<=n;i++)H.a[i]=((mint)2^(1ll*i*(i-1)/2))*ifac[i-1];\n\tF=H*inv(G);\n\tprintf(\"%lld\",(F.a[n]*fac[n-1]).val);\n\treturn 0;\n}\n```\n",
        "postTime": 1677386749,
        "uid": 654546,
        "name": "ScatteredHope",
        "ccfLevel": 5,
        "title": "P4841 \u9898\u89e3"
    },
    {
        "content": "### \u524d\u7f6e\u77e5\u8bc6\n\n- \u591a\u9879\u5f0f\u4e58\u6cd5 (NTT)\n\n- \u591a\u9879\u5f0f\u4e58\u6cd5\u9006\n\n- \u751f\u6210\u51fd\u6570\uff08OGF,EGF\uff09\n\n### \u601d\u8def\n\n\u901a\u8fc7\u5bf9\u6307\u6570\u751f\u6210\u51fd\u6570 ( $\\text{EGF}$ ) \u7684\u5b66\u4e60\uff0c\u6211\u4eec\u53ef\u4ee5\u5f88\u7b80\u5355\u7684\u77e5\u9053\u4e0b\u9762\u7684\u4e24\u79cd\u60c5\u51b5\u7684\u6307\u6570\u751f\u6210\u51fd\u6570\uff1a\n\n\u5982\u679c $n$ \u4e2a\u70b9\u7684\u7b80\u5355\u65e0\u5411\u8054\u901a\u56fe\u7684 $\\text{EGF}$ \u8bbe\u4e3a $\\hat{F}(x)$\uff0c\u5219 $n$ \u4e2a\u70b9\u7684\u7b80\u5355\u65e0\u5411\u56fe\u7684 $\\text{EGF}$ \u4e3a $\\exp \\hat{F}(x)$\uff0c\u53ef\u4ee5\u77e5\u9053\u7684\u662f\uff1a\n\n$$\\exp \\hat{F}(x)=\\sum_{n=0}^{\\infty}2^{\\binom{n}{2}}\\frac{x^n}{n!}$$\n\n\u5229\u7528\u591a\u9879\u5f0f $\\ln$ \u7684\u77e5\u8bc6\u5373\u53ef\u5f97\u5230 $\\hat{F}(x)$\u3002\n\n\u8fd9\u662f\u751f\u6210\u51fd\u6570\u7684\u505a\u6cd5\uff0c\u8fd9\u91cc\u8981\u8bb2\u7684\u662f\u7528\u591a\u9879\u5f0f\u6765\u5e72\u6389\u4ed6\uff01\n\n\u8bbe\u6211\u4eec\u8981\u6c42\u7684 $n$ \u4e2a\u70b9\u7684**\u7b80\u5355\u65e0\u5411\u8fde\u901a\u56fe**\u7684\u6570\u91cf\u8bbe\u4e3a $f_n$\uff0c\u8bbe $n$ \u4e2a\u70b9\u7684**\u7b80\u5355\u65e0\u5411\u56fe**\u7684\u6570\u91cf\u4e3a $g_n$\u3002\n\n\u6211\u4eec\u8981\u6c42\u7684\u5c31\u662f $f_n$ \uff0c\u4f46\u662f\u6211\u4eec\u8981\u5148\u6c42\u51fa $g_n$ \u624d\u884c\u3002\n\n\u6839\u636e\u5bf9 $g_n$ \u7684\u5b9a\u4e49\uff0c\u53ef\u4ee5\u53d1\u73b0\u4efb\u4f55\u4e24\u4e2a\u4e0d\u540c\u7684\u70b9\u7684\u8fde\u63a5\u60c5\u51b5\u53ea\u6709\n**\u8fde**\u4e0e**\u4e0d\u8fde**\u4e24\u79cd\u60c5\u51b5\u5566\uff0c\u6240\u4ee5\u8bf4\u6bcf\u4e24\u4e2a\u70b9\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u662f $2$\uff0c\u56e0\u6b64\u53ef\u4ee5\u5f97\u51fa\uff1a\n\n$$g_n=2^{\\binom{n}{2}}$$\n\n\u7406\u89e3\u8d77\u6765\u5e94\u8be5\u5f88\u7b80\u5355\u4e86qwq\uff0c\u90a3\u4e48\u8fd9\u91cc\u5c31\u4e0d\u518d\u8d58\u8ff0\u3002\n\n\u63a5\u4e0b\u6765\u5c31\u6765\u8003\u8651\u5982\u4f55\u6c42\u51fa $f_n$\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5206\u6210\u4e24\u4e2a\u90e8\u5206\u8ba8\u8bba\uff0c\u7b2c\u4e00\u4e2a\u90e8\u5206\u8ba8\u8bba\u8054\u901a\u5757\u7684\u5927\u5c0f\uff0c\u7b2c\u4e8c\u4e2a\u90e8\u5206\u8ba8\u8bba\u5269\u4e0b\u7684\u70b9\u7ec4\u6210\u7684**\u65e0\u5411\u56fe**\u3002\n\n\u8bbe\u6211\u4eec\u4eb2\u7231\u7684 $1$ \u53f7\u4e3a\u4e00\u76f4\u5f85\u5728\u8054\u901a\u5757\u4e2d\u7684\u70b9\uff0c\u5047\u8bbe\u8054\u901a\u5757\u5185\u6709 $x$ \u4e2a\u70b9\uff0c\u7ec4\u6210\u7684\u65b9\u6848\u6570\u5c31\u662f\uff1a\n\n$$f_x\u00b7\\binom{n-1}{x-1}$$\n\n$f_x$ \u8bb0\u5f55\u7684\u662f\u7ed9\u5b9a\u7684\u70b9\u7ec4\u6210 $x$ \u4e2a\u70b9\u7684\u65e0\u5411\u8fde\u901a\u56fe\u7684\u65b9\u6848\uff0c\u7136\u540e\u53ef\u4ee5\u5728\u9664\u4e86 $1$ \u53f7\u70b9\u4e4b\u5916\u627e $n-1$ \u4e2a\u70b9\u6765\u7ec4\u6210\u8fd9\u4e2a\u65b9\u6848\uff0c\u6240\u4ee5\u5c31\u53ef\u4ee5\u5f97\u51fa\uff1a\n\n$$g_n=\\sum_{x=1}^nf_x\\binom{n-1}{x-1}\u00b7g_{n-x}$$\n\n\u7136\u540e\u628a\u6211\u4eec\u4e00\u5f00\u59cb\u6c42\u51fa\u7684 $g_n=2^{\\binom{n}{2}}$ \u4ee3\u8fdb\u53bb\u5f97\u5230\uff1a\n\n$$2^{\\binom{n}{2}}=\\sum_{x=1}^{n}f_x\\frac{(n-1)!}{(x-1)!(n-x)!}g_{n-x}$$\n\n$$\\frac{2^{\\binom{n}{2}}}{(n-1)!}=\\sum_{x=1}^n\\frac{f_x}{(x-1)!}\u00b7\\frac{g_{n-x}}{(n-x)!}$$\n\n~~\u7a81\u7136\u53d1\u73b0\u81ea\u5df1\u597d\u50cf\u5feb\u6ca1\u53d8\u91cf\u4f7f\u4e86~~\u3002\u63a5\u4e0b\u6765\u628a\u4ed6\u5316\u6210\u751f\u6210\u51fd\u6570\u7684\u5f62\u5f0f\n\n\u8bbe\uff1a \n\n$$H(x)=\\sum_{i=1}^{\\infty}\\frac{2^{\\binom{i}{2}}}{(i-1)!}x^i$$  \n\n$$G(x)=\\sum_{i=0}^{\\infty}\\frac{g_{i}}{i!}x^i$$\n\n$$F(x)=\\sum^{\\infty}_{i=1}\\frac{f_i}{(i-1)!}x^i$$\n\n\u7531\u4e0a\u9762\u7684\u5f0f\u5b50\u5f97\u5230\u4e86 \n\n$$F(x)=\\frac{H(x)}{G(x)}$$\n\n\n\u9884\u5904\u7406 $H(x),G(x)$\uff0c\u7136\u540e\u5728\u6a21 $x^{n+1}$ \u7684\u610f\u4e49\u4e0b\u5bf9 $G(x)$ \u6c42\u4e2a\u9006\uff0c\u7136\u540e\u6c42\u5f97 $F(x)$\uff0c\u5c06 $F(x)$ \u7b2c $n$ \u6b21\u9879\u7684\u7cfb\u6570\u4e0e $(n-1)$ \u76f8\u4e58\uff0c\u5373\u53ef\u5f97\u5230\u7b54\u6848\u3002\n\n\u5bf9\u4e8e\u4e3a\u4ec0\u4e48\u8981\u5728\u6a21 $x^{n+1}$ \u7684\u610f\u4e49\u4e0b\uff0c\u56e0\u4e3a\u8981\u4fdd\u7559 $x^n$ \u4e4b\u524d\u7684\u6b21\u9879\uff0c\u5176\u4f59\u7684\u90fd\u4f1a\u88ab\u6a21\u53bb\u3002\n\n#### \u4ee3\u7801\u5b9e\u73b0\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<queue>\n#include<stack>\n#include<algorithm>\n#include<vector>\n#include<map>\n#define int long long \nusing namespace std;\nconst int N=4e5+9;\nconst int mod=1004535809;\nconst int gn[]={3,(mod+1)/3};\nint g[N],f[N],h[N];\nint c[N];//\u6c42\u9006\u4e2d\u8f6c\u6570\u7ec4 \nint invg[N];//\u5bf9g\u6c42\u9006 \nint r[N];\nint inv[N],ifac[N],fac[N];\nint n;\nint read()\n{\n\tint f=1,x=0;\n\tchar s=getchar();\n\twhile(s<'0'||s>'9'){if(s=='-')f=-1;s=getchar();}\n\twhile(s>='0'&&s<='9'){x=(x<<1)+(x<<3)+(s^'0');s=getchar();}\n\treturn f*x;\n}\nint quick(int x,int p)\n{\n\tint ret=1;\n\twhile(p)\n\t{\n\t\tif(p&1) ret=ret*x%mod;\n\t\tx=x*x%mod;\n\t\tp>>=1;\n\t}\n\treturn ret;\n}\nvoid NTT(int *A,int term,int type)\n{\n\tfor(int i=0;i<term;i++)\n\t\tif(i<r[i])\n\t\t\tswap(A[i],A[r[i]]);\n\tfor(int mid=1;mid<term;mid<<=1)\n\t{\n\t\tint R=mid<<1;\n\t\tint Wn=quick(gn[type],(mod-1)/R);\n\t\tfor(int j=0;j<term;j+=R)\n\t\t{\n\t\t\tint w=1;\n\t\t\tfor(int k=0;k<mid;k++,w=w*Wn%mod)\n\t\t\t{\n\t\t\t\tint x=A[j+k]%mod;\n\t\t\t\tint y=w*A[j+k+mid]%mod;\n\t\t\t\tA[j+k]=(x+y)%mod;\n\t\t\t\tA[j+k+mid]=(x-y+mod)%mod;\n\t\t\t}\n\t\t}\n\t}\n\tif(type==1)\n\t{\n\t\tint inv=quick(term,mod-2);\n\t\tfor(int i=0;i<term;i++)\n\t\t\tA[i]=A[i]*inv%mod;\n\t}\n}\nvoid Prepare()\n{\n\tinv[0]=inv[1]=1;\n\tifac[0]=ifac[1]=1;\n\tfac[0]=fac[1]=1;\n\tg[0]=1;\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tinv[i]=(mod-mod/i)*inv[mod%i]%mod;\n\t\tifac[i]=ifac[i-1]*inv[i]%mod;\n\t\tfac[i]=fac[i-1]*i%mod;\n\t}\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tint tmp=quick(2,(1ll*i*(i-1)/2)%(mod-1));//\u6b27\u62c9\u5b9a\u7406\n\t\tg[i]=tmp*ifac[i]%mod;\n\t\th[i]=tmp*ifac[i-1]%mod; \n\t}\n}\nvoid Inv(int *a,int *b,int len)\n{\n\tif(len==1)\n\t{\n\t\tb[0]=quick(a[0],mod-2);\n\t\treturn;\n\t}\n\tInv(a,b,(len+1)>>1);\n\tint term=1,l=0;\n\twhile(term<(len<<1))\n\t{\n\t\tterm<<=1;\n\t\tl++;\n\t}\n\tfor(int i=0;i<term;i++)\n\t\tr[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\tfor(int i=0;i<len;i++)\n\t\tc[i]=a[i];\n\tfor(int i=len;i<term;i++)\n\t\tc[i]=0;\n\tNTT(c,term,0);\n\tNTT(b,term,0);\n\tfor(int i=0;i<term;i++)\n\t\tb[i]=(2-b[i]*c[i]%mod+mod)%mod*b[i]%mod;\n\tNTT(b,term,1);\n\tfor(int i=len;i<term;i++)\n\t\tb[i]=0;\n}\nsigned main()\n{\n\tn=read()+1;//\u6700\u540e\u6c42\u7684\u662fx^n \u56e0\u6b64\u8981\u4fdd\u7559\u524dn+1\u9879 \n\tPrepare();\n\tInv(g,invg,n);\n\tint term=1,l=0;\n\twhile(term<(n<<1))\n\t{\n\t\tl++;\n\t\tterm<<=1;\n\t}// \n\tfor(int i=0;i<term;i++)\n\t\tr[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\tNTT(h,term,0);\n\tNTT(invg,term,0);\n\tfor(int i=0;i<term;i++)\n\t\tf[i]=invg[i]*h[i]%mod;\n\tNTT(f,term,1);\n\tn--;\n\tint Ans=f[n]*fac[n-1]%mod;\n\tprintf(\"%lld\\n\",Ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1626769890,
        "uid": 230804,
        "name": "Durancer",
        "ccfLevel": 4,
        "title": "\u3010\u9898\u89e3\u3011P4841 [\u96c6\u8bad\u961f\u4f5c\u4e1a2013]\u57ce\u5e02\u89c4\u5212"
    },
    {
        "content": "\u505a\u7684\u7b2c\u4e00\u9053\u6570\u8bba\u7c7b\u9ed1\u9898\uff0c\u6765\u7eaa\u5ff5\u4e00\u4e0b\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u6c42\u51fa $n$ \u4e2a\u70b9\u7684\u6709\u6807\u53f7\u65e0\u5411\u8fde\u901a\u56fe\u6570\u76ee\uff0c\u8bbe\u4e3a $a_n$\u3002\n\n\u53c8\u56e0\u4e3a $n$ \u4e2a\u70b9\u7684\u6709\u6807\u53f7\u65e0\u5411\u56fe\u6570\u76ee\u5f88\u597d\u6c42\uff0c\u5c31\u662f $2^{C_n^2}$\uff0c\u8bbe\u4e3a $b_n$\u3002\n\n\u53c8\u56e0\u4e3a\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e $1$ \u53f7\u8282\u70b9\u6240\u5728\u8054\u901a\u5757\u7684\u5927\u5c0f\uff0c\u5269\u4e0b\u7684\u8fb9\u4e71\u8fde\uff0c\u5c31\u53ef\u4ee5\u5f97\u51fa\u8fd9\u4e2a\u5f0f\u5b50\uff1a\n\n$$b_n=\\sum\\limits_{i=1}^n C_{n-1}^{i-1}a_ib_{n-i}\n$$\n\n\u5377\u79ef\uff1f\u4e0d\u597d\u6c42\u3002\u6211\u4eec\u6ce8\u610f\u5230 $C_{n-1}^{i-1}=\\dfrac{(n-1)!}{(n-i)!(i-1)!}$ \u8ddf $n,i,n-i$ \u6709\u4e00\u4e9b\u5947\u602a\u7684\u5173\u7cfb\uff0c\u5c55\u5f00\u7ec4\u5408\u6570\u5f97\uff1a\n\n$$\\frac{b_n}{(n-1)!} = \\sum\\limits_{i=1}^{n}\\left(\\dfrac{a_i}{(i-1)!}\\times\\dfrac{b_{n-i}}{(n-i)!}\\right)$$\n\n\u8fd9\u6837\u5c31\u5f88\u660e\u663e\u4e86\uff0c\u4ee4 $A_n=\\dfrac{a_n}{(n-1)!},B_n=\\dfrac{b_n}{n!},C_n=\\dfrac{b_n}{(n-1)!}$\uff0c\u518d\u4ee4 $f_A(x),f_B(x),f_C(x)$ \u4e3a\u5b83\u4eec\u7684\u751f\u6210\u51fd\u6570\uff0c\u5f97$f_C(x)=f_A(x)f_B(x)$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5148\u6c42\u51fa $f_B(x),f_C(x)$\uff0c\u518d\u628a $f_B(x)$ \u6c42\u9006\uff0c\u6700\u540e\u4e0e $f_C(x) \\ \\texttt{NTT}$\uff0c\u53d6 $a_n(n-1)!$ \u5373\u53ef\u3002\n\nAC code:\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define mod 1004535809\nusing namespace std;\nint n,w[300005]={1},rw[300005]={1},tmp[300005],f[300005],a[300005],b[300005],c[300005]={1},tlen,bign,bit,jc1[300005]={1},jc2[300005]={1},g[300005],tmp1[300005],tmp2[300005];\nint qp(int ds,int zs)\n{\n\tint ansa=1;\n\twhile(zs)\n    {\n\t\tif(zs&1)\n            ansa=(ansa*ds)%mod;\n\t\tds=(ds*ds)%mod;\n\t\tzs>>=1;\n\t}\n    return ansa;\n}\nvoid NTT(int *A,int val)\n{\n\tfor(int i=1;i<bign;i++)\n    {\n        if(i<tmp[i])\n            swap(A[i],A[tmp[i]]);\n    }\n\tfor(int i=1,ii=tlen>>1;i<bign;i*=2,ii>>=1)\n    {\n\t\tfor(int j=0;j<bign;j+=i*2)\n        {\n\t\t\tfor(int k=0;k<i;k++)\n            {\n                int S1=A[k+j],S2;\n                if(val==1)\n                    S2=(A[k+i+j]*w[k*ii])%mod;\n                else\n                    S2=(A[k+i+j]*rw[k*ii])%mod;\n                A[k+j]=(S1+S2)%mod;\n\t\t\t\tA[k+i+j]=(S1-S2+mod)%mod;\n\t\t\t}\n\t\t}\n\t}\n\tif(val==1)\n        return;\n\tint niyuan=qp(bign,mod-2);\n    for(int i=0;i<bign;i++)\n        A[i]=(A[i]*niyuan)%mod;\n}\nvoid do_ny(int *A,int *B,int step)\n{\n\tif(step==1) \n    {\n        B[0]=qp(A[0],mod-2);\n        return;\n    }\n\tdo_ny(A,B,(step+1)>>1);\n    for(int i=0;i<(step>>1);i++)\n    {\n        tmp1[i]=B[i];\n    }\n\tfor(int i=step>>1;i<step;i++)\n        tmp1[i]=0;\n\tfor(int i=0;i<step;i++)\n        tmp2[i]=A[i];\n\tfor(bit=0,bign=1;bign<=step;bign<<=1,bit++);\n\tfor(int i=1;i<bign;i++)\n        tmp[i]=(tmp[i>>1]>>1)|((i&1)<<(bit-1));\n\tfor(int i=step;i<bign;i++)\n        tmp1[i]=tmp2[i]=0;\n\tNTT(tmp1,1);\n    NTT(tmp2,1);\n\tfor(int i=0;i<bign;i++)\n        B[i]=((2*tmp1[i]%mod-tmp2[i]*tmp1[i]%mod*tmp1[i]%mod)%mod+mod)%mod;\n\tNTT(B,-1);\n\tfor(int i=step;i<bign;i++)\n        B[i]=0;\n}\nsigned main()\n{\n\tcin>>n;\n\tfor(tlen=1;tlen<=n<<1;tlen<<=1);\n\tw[1]=qp(3,(mod-1)/tlen);\n\tfor(int i=2;i<=tlen;i++)\n        w[i]=(w[i-1]*w[1])%mod;\n\trw[1]=qp(qp(3,mod-2),(mod-1)/tlen);\n\tfor(int i=2;i<=tlen;i++)\n        rw[i]=(rw[i-1]*rw[1])%mod;\n\tfor(int i=1;i<=tlen;i++)\n        jc1[i]=(jc1[i-1]*i)%mod;\n\tjc2[tlen]=qp(jc1[tlen],mod-2);\n\tfor(int i=tlen-1;i;i--)\n        jc2[i]=(jc2[i+1]*(i+1))%mod;\n\tfor(int i=1;i<=n;i++)\n        g[i]=qp(2,(i*(i-1)/2)%(mod-1));\n\tfor(int i=1;i<=n;i++)\n        c[i]=(g[i]*jc2[i])%mod,b[i]=(g[i]*jc2[i-1])%mod;\n\tdo_ny(c,a,tlen>>1);\n\tbit=0,bign=1;\n   for(;bign<tlen;bign<<=1,bit++);\n\tfor(int i=1;i<bign;i++)\n        tmp[i]=(tmp[i>>1]>>1)|((i&1)<<(bit-1));\n\tNTT(a,1);\n    NTT(b,1);\n\tfor(int i=0;i<bign;i++)\n        a[i]=(a[i]*b[i])%mod;\n\tNTT(a,-1);\n\tcout<<(a[n]*jc1[n-1]%mod)%mod;\n\treturn 0;\n}\n```",
        "postTime": 1610493619,
        "uid": 342767,
        "name": "\u57f9\u6dc72021",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P4841 \u3010[\u96c6\u8bad\u961f\u4f5c\u4e1a2013]\u57ce\u5e02\u89c4\u5212\u3011"
    }
]
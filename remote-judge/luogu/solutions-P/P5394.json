[
    {
        "content": "lyx_cjz\u7684\u300a<\u5177\u4f53\u6570\u5b66>\u9009\u8bb2\u300b\u54ea\u91cc\u6709\u554a?\u6c42\u6559\u5927\u4f6c!!!\n\n\u770bmrsrz\u5927\u4f6c\u7684\u9898\u89e3\u6ca1\u770b\u61c2,\u7136\u540e\u81ea\u5df1\u63a8\u4e86\u4e00\u4e0b,\u6765\u53d1\u4e00\u7bc7\u8be6\u7ec6\u4e00\u70b9\u7684\u9898\u89e3:\n\n\u4e00\u79cd\u601d\u8def\u662f\u628a\u8fd9\u4e1c\u897f\u8f6c\u6362\u56de\u666e\u901a\u591a\u9879\u5f0f,\u5377\u5728\u4e00\u8d77\u518d\u6362\u56de\u6765\u3002\n\n\u4e0d\u8fc7\u90a3\u6837\u5b50\u590d\u6742\u5ea6\u662f\u5927\u5e38\u6570\u7684$O(nlog^2n)$,\u4ee3\u7801\u53c8\u957f\u2026\u2026\n\n\u6bd5\u7adf\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u7684\u6b21\u6570\u4e5f\u662f\u6709\u9650\u7684,\u6211\u4eec\u8003\u8651\u5229\u7528\u70b9\u503c\u6765\u641e\u4e8b\u60c5\u3002\n\n\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u7684**\u70b9\u503c**\u548cEGF\u6709\u7740\u83ab\u5927\u7684\u5173\u7cfb\u3002\n\n\u9898\u76ee\u7ed9\u4e86\u6211\u4eec\u4e24\u4e2a\u4e0b\u964d\u5e42\u591a\u9879\u5f0f$F(x),G(x)$\u6211\u4eec\u8bbe$F[n]$\u4e3a$F(x)$\u7684\u7b2c$n$\u9879\u7cfb\u6570\u3002\n\n\u6211\u4eec\u5199\u51fa\u70b9\u503c\u7684EGF: $F^\\#=\\sum\\limits_{i=0}^\u221e\\dfrac{F(i)}{i!}x^i$\n\n\u90a3\u4e48,\u5148\u6765\u624b\u73a9$x^{\\underline{n}}$\u7684\u70b9\u503cEGF:\n\n$\\sum\\limits_{i=0}^\u221e\\dfrac{i^{\\underline{n}}}{i!}x^i==\\sum\\limits_{i=0}^\u221e\\dfrac{1}{(i-n)!}x^i=x^n\\sum\\limits_{i=0}^\u221e\\dfrac{1}{i!}x^i=e^xx^n$\n\n\u90a3\u4e48$F(n)=\\sum\\limits_{i=0}^\u221eF[i]n^{\\underline{i}}$\n\n\u5c31\u76f8\u5f53\u4e8e\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u7684\u70b9\u503c\u7684EGF\u4e3a$F^\\#=\\sum\\limits_{i=0}^\u221e\\dfrac{x^i}{i!}\\sum\\limits_{j=0}^\u221eF[j]i^{\\underline{j}}$\n\n\u4ea4\u6362\u548c\u5f0f\u5f97\u5230:$=\\sum\\limits_{j=0}^\u221eF[j]\\sum\\limits_{i=0}^\u221e\\dfrac{x^i}{i!}i^{\\underline{j}}$\n\n$=\\sum\\limits_{j=0}^\u221eF[j]\\sum\\limits_{i=0}^n\\dfrac{i^{\\underline{j}}}{i!}x^i$\n\n\u6839\u636e\u4e0a\u6587\u7684\u7ed3\u8bba$\\sum\\limits_{i=0}^\u221e\\dfrac{i^{\\underline{n}}}{i!}x^i=e^xx^n$,\u5f0f\u5b50\u53d8\u4e3a\n\n$=\\sum\\limits_{i=0}^\u221eF[i]e^xx^i=e^x\\sum\\limits_{i=0}^\u221eF[i]x^i$\n\n\u4e5f\u5c31\u662f\u8bf4,\u6211\u4eec\u628a$F[]$\u5f53\u6210\u666e\u901a\u591a\u9879\u5f0f,\u5377\u4e0a$e^x$\u5c31\u80fd\u5f97\u5230\u70b9\u503c\u7684EGF\u5566!\n\n\u70b9\u503cEGF\u70b9\u4e58\u5c31\u597d,\u7136\u540e\u5728\u9006\u8fd0\u7b97\u56de\u53bb,\u5177\u4f53\u65b9\u6cd5\u662f\u5377\u4e0a$e^{-x}$,\u6beb\u65e0\u6bdb\u75c5\u3002\n\nTips:$e^{-x}$\u5e76\u4e0d\u7528\u6c42\u9006,\u5176$=\\sum\\limits_{i=0}^\u221e\\dfrac{(-1)^i}{i!}x^i$\n\n```cpp\n#include<algorithm>\n#include<cstdio>\n#define mod 998244353\n#define G 3\n#define Maxn 200500\nusing namespace std;\nint r[Maxn<<2];\nlong long invn,invG,fac[Maxn],inv[Maxn];\nlong long powM(long long a,long long t=mod-2)\n{\n  long long ans=1,buf=a;\n  while(t){\n  \tif(t&1)ans=(ans*buf)%mod;\n  \tbuf=(buf*buf)%mod;\n  \tt>>=1;\n  }return ans;\n}\nvoid NTT(long long *f,bool op,int n)\n{\n  for (int i=0;i<n;i++)\n    if (r[i]<i)swap(f[r[i]],f[i]);\n  for (int len=1;len<n;len<<=1){\n    int w=powM(op==1 ? G:invG,(mod-1)/len/2);\n  \tfor (int p=0;p<n;p+=len+len){\n  \t  long long buf=1;\n  \t  for (int i=p;i<p+len;i++){\n  \t  \tint sav=f[i+len]*buf%mod;\n  \t  \tf[i+len]=f[i]-sav;\n  \t  \tif (f[i+len]<0)f[i+len]+=mod;\n  \t  \tf[i]=f[i]+sav;\n  \t  \tif (f[i]>=mod)f[i]-=mod;\n  \t  \tbuf=buf*w%mod;\n        }//F(x)=FL(x^2)+x*FR(x^2)\n         //F(W^k)=FL(w^k)+W^k*FR(w^k)\n         //F(W^{k+n/2})=FL(w^k)-W^k*FR(w^k)\n    }\n  }\n}\nvoid Init(int lim)\n{\n  inv[1]=inv[0]=fac[0]=1;\n  for (int i=1;i<=lim;i++)fac[i]=fac[i-1]*i%mod;\n  for (int i=2;i<=lim;i++)\n  \tinv[i]=inv[mod%i]*(mod-mod/i)%mod;\n  for (int i=2;i<=lim;i++)inv[i]=inv[i-1]*inv[i]%mod;\n}\nlong long s[Maxn<<2];\nvoid FDT(long long *f,int n,bool op)\n{\n  if (op)\n\tfor (int i=0;i<n;i++)s[i]=inv[i];\n  else \n\tfor (int i=0;i<n;i++)\n\t  if (i&1)s[i]=mod-inv[i];\n      else s[i]=inv[i];\n  int len=1;for (;len<n+n;len<<=1);\n  for (int i=n;i<len;i++)s[i]=0;\n  for (int i=0;i<len;i++)\n    r[i]=(r[i>>1]>>1)|(i&1?len>>1:0);\n  NTT(f,1,len);NTT(s,1,len);\n  for (int i=0;i<len;i++)f[i]=f[i]*s[i]%mod;\n  NTT(f,0,len);invn=powM(len);\n  for (int i=0;i<n;i++)f[i]=f[i]*invn%mod;\n  for (int i=n;i<len;i++)f[i]=0;\n}\nint n,m;\nlong long f[Maxn<<2],g[Maxn<<2];\nint main()\n{\n  scanf(\"%d%d\",&n,&m);\n  invG=powM(G);\n  n++;m++;\n  for (int i=0;i<n;i++)scanf(\"%lld\",&f[i]);\n  for (int i=0;i<m;i++)scanf(\"%lld\",&g[i]);\n  int cnt=n+m-1;\n  Init(cnt);\n  FDT(f,cnt,1);FDT(g,cnt,1);\n  for (int i=0;i<cnt;i++)\n\tf[i]=f[i]*g[i]%mod*fac[i]%mod;\n  FDT(f,cnt,0);\n  for (int i=0;i<cnt;i++)printf(\"%lld \",f[i]);\n  return 0;\n}\n```",
        "postTime": 1562991318,
        "uid": 58705,
        "name": "command_block",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5394 \u3010\u3010\u6a21\u677f\u3011\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u4e58\u6cd5\u3011"
    },
    {
        "content": "## \u9898\u610f\n\u7ed9\u51fa\u4e0b\u964d\u5e42\u591a\u9879\u5f0f $A,B$\uff0c\u6c42\u4e0b\u964d\u5e42\u591a\u9879\u5f0f $A\\times B$\n## \u9898\u89e3\n\u5ba3\u4f20 [$\\color{skyblue}\\Large\\mathbb{BLOG}$](https://chen-jia-liang.gitee.io/article/P5394.html)\n\n\u9996\u5148\u770b\u4e00\u4e0b\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u7684\u5f62\u5f0f\uff1a\n\n$$A(x)=\\sum_{i=0}a_ix^{\\underline{i}}$$\n\n\u4e0d\u96be\u53d1\u73b0\u4e00\u4e2a $n$ \u6b21\u7684\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u552f\u4e00\u5bf9\u5e94\u4e00\u4e2a $n$ \u6b21\u4e00\u822c\u591a\u9879\u5f0f\u3002\n\n\u8003\u8651\u6211\u4eec\u5728 $\\rm DFT$ \u4e2d\u7684\u505a\u6cd5\uff0c\u6c42\u51fa $A,B$ \u7684 $n+m+1$ \u4e2a\u70b9\u503c\u4e58\u8d77\u6765\uff0c\u5c31\u80fd\u552f\u4e00\u786e\u5b9a $A\\times B$\u3002\u518d\u901a\u8fc7 $\\rm IDFT$ \u628a\u70b9\u503c\u8f6c\u6362\u6210\u4e3a\u7cfb\u6570\u3002\n\n\u8003\u8651\u4e00\u79cd\u4ece\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u5230\u70b9\u503c\u7684\u7ebf\u6027\u53d8\u6362 $\\rm \\color{d}Z\\color{red}LCAK\\color{d}T$ \u548c\u5b83\u7684\u9006\u53d8\u6362 $\\rm \\color{d}IZ\\color{red}LCAK\\color{d}T$\u3002\u8fd9\u79cd\u53d8\u6362\u6709\u4e24\u79cd\u63a8\u6cd5\uff0c\u4e0d\u8fc7\u6700\u7ec8\u662f\u6b8a\u9014\u540c\u5f52\u3002\n### \u63a8\u6cd5 $1$\n\u628a $F(x)=\\sum\\limits_{i=0}^nf_ix^{\\underline{i}}$ \u8f6c\u6362\u4e3a $\\sum\\limits_{i=0}^na_ix^i$\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u77e5\u9053 $a_i$ \u5177\u4f53\u7684\u503c\uff0c\u53ea\u662f\u4e00\u4e2a\u63a8\u5bfc\u8fc7\u7a0b\u4e2d\u7684\u4e2d\u95f4\u53d8\u91cf\u3002\n\n\u8003\u8651 \n$$x^k=\\sum_{i=0}^k\\left\\{\\begin{matrix}\nk\\\\ i\n\\end{matrix}\\right\\}x^{\\underline{i}}$$\n\u4e8e\u662f\u6765\u63a8\u4e00\u6ce2\u67ff\u5b50\n$$\n\\begin{aligned}\n\t\\sum_{k=0}^na_kx^k&=\\sum_{k=0}^na_k\\sum_{i=0}^k\\left\\{\\begin{matrix}k\\\\ i\\end{matrix}\\right\\}x^{\\underline i}\\\\\n\t&=\\sum_{i=0}^n\\left(\\sum_{k=i}^na_k\\left\\{\\begin{matrix}k\\\\ i\\end{matrix}\\right\\}\\right)x^{\\underline i}\\\\\nf_k&=\\sum_{i=k}^na_i\\left\\{\\begin{matrix}i\\\\ k\\end{matrix}\\right\\}=\\sum_{i=0}^na_i\\left\\{\\begin{matrix}i\\\\ k\\end{matrix}\\right\\}\n\\end{aligned}\n$$\n\u628a\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u5c55\u5f00\uff1a\n$$\n\\begin{aligned}\nf_k&=\\sum_{i=0}^na_i\\sum_{t=0}^k\\frac{t^i}{t!}\\times \\frac{(-1)^{k-t}}{(k-t)!}\\\\\n&=\\sum_{t=0}^k\\frac{\\sum_{i=0}^na_it^i}{t!}\\times \\frac{(-1)^{k-t}}{(k-t)!}\\\\\n&=\\sum_{t=0}^k\\frac{F(t)}{t!}\\times\\frac{(-1)^{k-t}}{(k-t)!}\n\\end{aligned}\n$$\n\u5982\u679c\u8bb0 $G$ \u4e3a\u7cfb\u6570\u7684 $\\mathbf{OGF}$\uff0c$\\hat{G}$ \u4e3a $0,1,2,\\ldots,n$ \u70b9\u503c\u7684 $\\mathbf{EGF}$,$H$ \u4e3a $\\{(-1)^i\\}_{i=0}$ \u7684 $\\mathbf{EGF}$\uff0c\u6709\uff1a\n$$G(z)=\\hat{G}(z)\\times H(z)\\pmod{z^{n+1}}$$\n\u4e0d\u96be\u53d1\u73b0\u6709 $H(z)=e^{-z}$\uff1a\n$$G(z)=e^{-z}\\hat{G}(z)\\pmod{z^{n+1}}\\Longleftrightarrow e^zG(z)=\\hat{G}(z)\\pmod{z^{n+1}}$$\n\u524d\u8005\u4e3a \u9006\u53d8\u6362 $\\rm \\color{d}IZ\\color{red}LCAK\\color{d}T$,\u800c\u540e\u8005\u4e3a$\\rm \\color{d}Z\\color{red}LCAK\\color{d}T$\n## \u63a8\u6cd5 $2$\n\u4e0a\u9762\u7684\u65b9\u6cd5\u4e2d\u95f4\u8bbe\u4e86\u666e\u901a\u591a\u9879\u5f0f\u4f5c\u4e3a\u4e2d\u95f4\u53d8\u91cf\u56e0\u6b64\u8fc7\u7a0b\u8f83\u4e3a\u7e41\u7410\uff0c\u8003\u8651\u76f4\u63a5\u4e0a\u70b9\u503c\u7684 $\\mathbf{EGF}$\uff1a\n$$\\hat{G}(z)=\\sum_{i=0}^\\infty\\frac{F(i)}{i!}z^i$$\n\u8003\u8651\u51fd\u6570\u662f\u7ebf\u6027\u7684\uff0c\u56e0\u6b64\u53ef\u4ee5\u662f\u6bcf\u4e00\u4e2a $x^{\\underline{n}}$ \u7684 $\\mathbf{EGF}$ \u4e4b\u548c\u3002\u5148\u6765\u63a8 $x^{\\underline{n}}$ \u7684 $\\mathbf{EGF}$,\u8bb0\u4e3a $\\hat{G}_n(z)$\n\n$$\n\\begin{aligned}\n\\hat{G}_n(z)&=\\sum_{i=0}^\\infty\\frac{i^{\\underline{n}}}{i!}z^i=\\sum_{i=0}^\\infty\\frac1{(i-n)!}z^i=\\sum_{i=0}^\\infty\\frac1{i!}z^{n+i}\\\\\n&=z^n\\sum_{i=0}^\\infty \\frac{z^i}{i!}=z^ne^z\n\\end{aligned}\n$$\n\u4e8e\u662f\u518d\u6765\u63a8 $\\hat{G}(z)$\n$$\\hat{G}(z)=\\sum_{i=0}^nf_i\\hat{G}_i(z)=\\sum_{i=0}^nf_iz^ie^z=e^z\\sum_{i=0}^nf_iz^i$$\n\u4e8e\u662f\u81ea\u7136\u6709\uff1a\n$$\\hat{G}(z)=e^zG(z)\\pmod{z^{n+1}}$$\n\u4e0d\u8a00\u800c\u55bb\u4e00\u76ee\u4e86\u7136\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nnamespace in{\n\tchar buf[1<<21],*p1=buf,*p2=buf;\n\tinline int getc(){return p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++;}\n\ttemplate <typename T>inline void read(T& t){\n\t\tt=0;int f=0;char ch=getc();while (!isdigit(ch)){if(ch=='-')f = 1;ch=getc();}\n\t    while(isdigit(ch)){t=t*10+ch-48;ch = getc();}if(f)t=-t;\n\t}\n\ttemplate <typename T,typename... Args> inline void read(T& t, Args&... args){read(t);read(args...);}\n}\nnamespace out{\n\tchar buffer[1<<21];int p1=-1;const int p2 = (1<<21)-1;\n\tinline void flush(){fwrite(buffer,1,p1+1,stdout),p1=-1;}\n\tinline void putc(const char &x) {if(p1==p2)flush();buffer[++p1]=x;}\n\ttemplate <typename T>void write(T x) {\n\t\tstatic char buf[15];static int len=-1;if(x>=0){do{buf[++len]=x%10+48,x/=10;}while (x);}else{putc('-');do {buf[++len]=-(x%10)+48,x/=10;}while(x);}\n\t\twhile (len>=0)putc(buf[len]),--len;\n\t}\n}\nusing namespace std;\ntemplate<const int mod>\nstruct modint{\n    int x;\n    modint<mod>(int o=0){x=o;}\n    modint<mod> &operator = (int o){return x=o,*this;}\n    modint<mod> &operator +=(modint<mod> o){return x=x+o.x>=mod?x+o.x-mod:x+o.x,*this;}\n    modint<mod> &operator -=(modint<mod> o){return x=x-o.x<0?x-o.x+mod:x-o.x,*this;}\n    modint<mod> &operator *=(modint<mod> o){return x=1ll*x*o.x%mod,*this;}\n    modint<mod> &operator ^=(int b){\n        modint<mod> a=*this,c=1;\n        for(;b;b>>=1,a*=a)if(b&1)c*=a;\n        return x=c.x,*this;\n    }\n    modint<mod> &operator /=(modint<mod> o){return *this *=o^=mod-2;}\n    modint<mod> &operator +=(int o){return x=x+o>=mod?x+o-mod:x+o,*this;}\n    modint<mod> &operator -=(int o){return x=x-o<0?x-o+mod:x-o,*this;}\n    modint<mod> &operator *=(int o){return x=1ll*x*o%mod,*this;}\n    modint<mod> &operator /=(int o){return *this *= ((modint<mod>(o))^=mod-2);}\n    template<class I>friend modint<mod> operator +(modint<mod> a,I b){return a+=b;}\n    template<class I>friend modint<mod> operator -(modint<mod> a,I b){return a-=b;}\n    template<class I>friend modint<mod> operator *(modint<mod> a,I b){return a*=b;}\n    template<class I>friend modint<mod> operator /(modint<mod> a,I b){return a/=b;}\n    friend modint<mod> operator ^(modint<mod> a,int b){return a^=b;}\n    friend bool operator ==(modint<mod> a,int b){return a.x==b;}\n    friend bool operator !=(modint<mod> a,int b){return a.x!=b;}\n    bool operator ! () {return !x;}\n    modint<mod> operator - () {return x?mod-x:0;}\n    modint<mod> &operator++(int){return *this+=1;}\n};\nconst int N=4e6+5;\n\nconst int mod=998244353;\nconst modint<mod> GG=3,Ginv=modint<mod>(1)/3,I=86583718;\nstruct poly{\n    vector<modint<mod>>a;\n    modint<mod>&operator[](int i){return a[i];}\n    int size(){return a.size();}\n    void resize(int n){a.resize(n);}\n    void reverse(){std::reverse(a.begin(),a.end());}\n    void print(){for(auto xx:a)printf(\"%d \",xx);puts(\"\");}\n};\nint rev[N];\ninline poly one(){poly a;a.a.push_back(1);return a;}\ninline int ext(int n){int k=0;while((1<<k)<n)k++;return k;}\ninline void init(int k){int n=1<<k;for(int i=0;i<n;i++)rev[i]=(rev[i>>1]>>1)|((i&1)<<(k-1));}\ninline void ntt(poly&a,int k,int typ){\n    int n=1<<k;\n    for(int i=0;i<n;i++)if(i<rev[i])swap(a[i],a[rev[i]]);\n    for(int mid=1;mid<n;mid<<=1){\n        modint<mod> wn=(typ>0?GG:Ginv)^((mod-1)/(mid<<1));\n        for(int r=mid<<1,j=0;j<n;j+=r){\n            modint<mod> w=1;\n            for(int k=0;k<mid;k++,w=w*wn){\n                modint<mod> x=a[j+k],y=w*a[j+k+mid];\n                a[j+k]=x+y,a[j+k+mid]=x-y;\n            }\n        }\n    }\n    if(typ<0){\n        modint<mod> inv=modint<mod>(1)/n;\n        for(int i=0;i<n;i++)a[i]*=inv;\n    }\n}\npoly operator +(poly a,poly b){\n    int n=max(a.size(),b.size());a.resize(n),b.resize(n);\n    for(int i=0;i<n;i++)a[i]+=b[i];return a;\n}\npoly operator -(poly a,poly b){\n    int n=max(a.size(),b.size());a.resize(n),b.resize(n);\n    for(int i=0;i<n;i++)a[i]-=b[i];return a;\n}\ninline poly operator*(poly a,poly b){\n    int n=a.size()+b.size()-1,k=ext(n);\n    a.resize(1<<k),b.resize(1<<k),init(k);\n    ntt(a,k,1);ntt(b,k,1);for(int i=0;i<(1<<k);i++)a[i]*=b[i];\n    ntt(a,k,-1),a.resize(n);return a;\n}\ninline poly operator*(poly a,modint<mod> b){for(int i=0;i<a.size();i++)a[i]*=b;return a; }\ninline poly operator/(poly a,modint<mod> b){for(int i=0;i<a.size();i++)a[i]/=b;return a; }\ninline poly operator-(poly a){for(int i=0;i<a.size();i++)a[i]=-a[i];return a; }\ntypedef modint<mod>mint;\nmint fac[N],ifac[N];\nvoid zlcakt(poly&A,int type){\n\tpoly B;B.resize(A.size());\n\tif(type==1){\n\t\tfor(int i=0;i<A.size();i++)B[i]=ifac[i];\n\t\tA=A*B;A.resize(B.size());\n\t\tfor(int i=0;i<A.size();i++)A[i]*=fac[i];\n\t}else{\n\t\tfor(int i=0;i<A.size();i++)A[i]*=ifac[i];\n\t\tfor(int i=0;i<A.size();i++)\n\t\t\tif(i&1)B[i]=-ifac[i];else B[i]=ifac[i];\n\t\tA=A*B;A.resize(B.size());\n\t}\n\t//A.print();\n}\npoly mul(poly a,poly b){\n\tint n=a.size()+b.size()-1;\n    a.resize(n),b.resize(n);\n    zlcakt(a,1);zlcakt(b,1);\n\tfor(int i=0;i<n;i++)a[i]*=b[i];\n    zlcakt(a,-1);return a;\n}\nsigned main(){\n\tfac[0]=1;for(int i=1;i<N;i++)fac[i]=fac[i-1]*i;\n\tifac[N-1]=1/fac[N-1];for(int i=N-1;i;i--)ifac[i-1]=ifac[i]*i;\n\tpoly A,B;\n\tint n,m;\n\tin::read(n,m);A.resize(n+1);B.resize(m+1);\n\tfor(int i=0;i<=n;i++)in::read(A[i]);\n\tfor(int i=0;i<=m;i++)in::read(B[i]);\n\tA=mul(A,B);\n\tfor(int i=0;i<=n+m;i++)out::write(A[i].x),out::putc(' ');\n\tout::flush();\n\treturn 0;\n}\n```",
        "postTime": 1615706879,
        "uid": 174304,
        "name": "jun\u5934\u5409\u5409",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5394 \u3010\u3010\u6a21\u677f\u3011\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u4e58\u6cd5\u3011 && ZLCAK\u53d8\u6362\u5b66\u4e60\u5c0f\u8bb0"
    },
    {
        "content": "\u6211\u4eec\u5df2\u77e5 $n$ \u6b21\u591a\u9879\u5f0f $f(x)$ \u5728 $[0,n]$ \u7684\u70b9\u503c\uff0c\u6c42\u51fa\u5b83\u7684\u4e0b\u964d\u5e42\u8868\u793a\u3002\n\n\u8bbe $f(x)=\\sum\\limits_{i=0}^{n}b_ix^{\\underline{i}}=\\sum\\limits_{i=0}^{n}b_i\\dfrac{x!}{(x-i)!}$\n\n\u5219 $\\dfrac{f(x)}{x!}=\\sum\\limits_{i=0}^{n}b_i\\dfrac{1}{(x-i)!}=b*e^x$\n\n\u56e0\u6b64\uff0c$b=\\text{EGF}(f)*e^{-x}$\u3002\n\n\u540c\u7406\uff0c\u4e0b\u964d\u5e42\u8868\u793a\u8f6c\u6210\u70b9\u503c\u4e5f\u4e00\u6837\u7b80\u5355\uff0c\u5377\u4e0a $e^x$ \u5373\u53ef\u3002\n\n\u56e0\u6b64\uff0c\u5bf9\u4e8e\u672c\u9898\u800c\u8a00\uff0c\u6211\u4eec\u5148\u5c06\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u8f6c\u4e3a\u70b9\u503c\uff0c\u7136\u540e\u76f4\u63a5\u76f8\u4e58\uff08\u6ce8\u610f\u8f6c\u5316\u7684\u70b9\u503c\u5e26\u6709 EGF \u7684\u7cfb\u6570\uff0c\u4e58\u7684\u65f6\u5019\u8981\u6d88\u53bb\uff09\uff0c\u7136\u540e\u8f6c\u56de\u6765\u5373\u53ef\u3002\n\n\u6ce8\u610f\uff0c\u56e0\u4e3a\u5377\u79ef\u4f1a\u5bfc\u81f4\u6b21\u6570\u589e\u5927\uff0c$e^x$ \u548c $e^{-x}$ \u7684\u6b21\u6570\u9700\u8981\u5f00\u5230 $2\\max(n,m)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mod=998244353,g=3,invg=(mod+1)/g; \nint jc[200005]={1},ny[200005]={1},n,m,N,a[600005],b[600005],c[600005],d[600005],e[600005],tr[600005];\nint C(int x,int y){\n\tif(x<y)return 0;\n\treturn 1ll*jc[x]*ny[y]%mod*ny[x-y]%mod;\n}\nint Power(int x,int y){\n\tint ret=1;\n\twhile(y){\n\t\tif(y&1)ret=1ll*ret*x%mod;\n\t\ty>>=1,x=1ll*x*x%mod;\n\t}\n\treturn ret;\n}\nvoid NTT(int a[],int len,int flag){\n\tfor(int i=0;i<len;i++)if(tr[i]<i)swap(a[i],a[tr[i]]);\n\tfor(int i=1;i<len;i<<=1){\n\t\tint w=Power(flag==1?g:invg,(mod-1)/(i<<1));\n\t\tfor(int j=0;j<len;j+=(i<<1)){\n\t\t\tint u=1;\n\t\t\tfor(int k=0;k<i;k++,u=1ll*u*w%mod){\n\t\t\t\tint x=a[j+k],y=a[i+j+k];\n\t\t\t\ta[j+k]=(x+1ll*u*y)%mod,a[i+j+k]=(x-1ll*u*y%mod+mod)%mod;\n\t\t\t}\n\t\t}\n\t}\n\tif(flag==-1)for(int i=0,inv=Power(len,mod-2);i<len;i++)a[i]=1ll*a[i]*inv%mod; \n}\nint main() {\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=0;i<=n;i++)scanf(\"%d\",&c[i]);\n\tfor(int i=0;i<=m;i++)scanf(\"%d\",&d[i]);\n\tN=max(n,m)*2;\n\tfor(int i=1;i<=N;i++)jc[i]=1ll*jc[i-1]*i%mod,ny[i]=Power(jc[i],mod-2);\n\tfor(int i=0;i<=N;i++){\n\t\tif(i&1)b[i]=mod-ny[i];\n\t\telse b[i]=ny[i];\n\t\ta[i]=ny[i];\n\t}\n\tint len=1;\n\twhile(len<=2*N)len<<=1;\n\tfor(int i=0;i<len;i++)tr[i]=(tr[i>>1]>>1)|((i&1)?(len>>1):0);\n\tNTT(a,len,1),NTT(b,len,1),NTT(c,len,1),NTT(d,len,1);\n\tfor(int i=0;i<len;i++)c[i]=1ll*a[i]*c[i]%mod,d[i]=1ll*d[i]*a[i]%mod;\n\tNTT(c,len,-1),NTT(d,len,-1);\n\tfor(int i=0;i<=N;i++)e[i]=1ll*c[i]*d[i]%mod*jc[i]%mod;\n\tNTT(e,len,1);\n\tfor(int i=0;i<len;i++)e[i]=1ll*e[i]*b[i]%mod;\n\tNTT(e,len,-1);\n\tfor(int i=0;i<=n+m;i++)printf(\"%d \",e[i]);\n\treturn 0;\n}\n```",
        "postTime": 1594897223,
        "uid": 42156,
        "name": "feecle6418",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5394 \u3010\u3010\u6a21\u677f\u3011\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u4e58\u6cd5\u3011"
    },
    {
        "content": "\u8bbe$F(x)$\u8868\u793a\u4e0b\u964d\u5e42\u591a\u9879\u5f0f$f(x)$\u7684\u70b9\u503c\u7684\u6307\u6570\u751f\u6210\u51fd\u6570\uff0c\u5373$F(x)=\\sum_{i=0}^{\\infty}\\frac{f(i)}{i!}x^i$\u3002\n\n\u8003\u8651\u4e00\u4e2a\u4e0b\u964d\u5e42\u5355\u9879\u5f0f$x^{\\underline n}$\uff0c\u5b83\u7684\u70b9\u503c\u7684\u6307\u6570\u751f\u6210\u51fd\u6570\u4e3a$\\sum_{i=n}^{\\infty}\\frac{i!}{(i-n)!i!}x^i=x^ne^x$\u3002\n\n\u8bbe$f(x)$\u7684\u7cfb\u6570\u751f\u6210\u51fd\u6570\u4e3a$G(x)$\uff0c\u5219$F(x)=e^xG(x)$\u3002\u540c\u7406$G(x)=e^{-x}F(x)$\u3002\n\n\u90a3\u4e48\u5148\u5f97\u5230\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u7684\u5404\u70b9\u70b9\u503c\uff0c\u518d\u628a\u5bf9\u5e94\u70b9\u503c\u76f8\u4e58\uff0c\u7136\u540e\u518d\u8f6c\u56de\u7cfb\u6570\u5373\u53ef\u3002\n\n\u90fd\u53ef\u4ee5\u901a\u8fc7\u7b80\u5355\u7684\u591a\u9879\u5f0f\u4e58\u6cd5\u5b9e\u73b0\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\log n)$\u3002\n\n\u66f4\u8be6\u7ec6\u5185\u5bb9\u8bf7\u53c2\u89c1lyx_cjz\u7684\u300a<\u5177\u4f53\u6570\u5b66>\u9009\u8bb2\u300b\u3002\n\n## Code\uff1a\n```cpp\n#include<cstdio>\n#include<algorithm>\nconst int N=524288,md=998244353,g3=(md+1)/3;\ntypedef long long LL;\nint n,m,A[N],B[N],fac[N],iv[N],rev[N],C[N],g[20][N],lim,M;\ninline int pow(int a,int b){\n    int ret=1;\n    for(;b;b>>=1,a=(LL)a*a%md)if(b&1)ret=(LL)ret*a%md;\n    return ret;\n}\ninline void upd(int&a){a+=a>>31&md;}\nvoid init(int n){\n    int l=-1;\n    for(lim=1;lim<n;lim<<=1)++l;M=l+1;\n    for(int i=1;i<lim;++i)\n    rev[i]=((rev[i>>1])>>1)|((i&1)<<l);\n}\nvoid NTT(int*a,int f){\n    for(int i=1;i<lim;++i)if(i<rev[i])std::swap(a[i],a[rev[i]]);\n    for(int i=0;i<M;++i){\n        const int*G=g[i],c=1<<i;\n        for(int j=0;j<lim;j+=c<<1)\n        for(int k=0;k<c;++k){\n            const int x=a[j+k],y=a[j+k+c]*(LL)G[k]%md;\n            upd(a[j+k]+=y-md),upd(a[j+k+c]=x-y);\n        }\n    }\n    if(!f){\n        const int iv=pow(lim,md-2);\n        for(int i=0;i<lim;++i)a[i]=(LL)a[i]*iv%md;\n        std::reverse(a+1,a+lim);\n    }\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);++n,++m;\n    for(int i=0;i<20;++i){\n        int*G=g[i];\n        G[0]=1;\n        const int gi=G[1]=pow(3,(md-1)/(1<<i+1));\n        for(int j=2;j<1<<i;++j)G[j]=(LL)G[j-1]*gi%md;\n    }\n    for(int i=0;i<n;++i)scanf(\"%d\",A+i);\n    for(int i=0;i<m;++i)scanf(\"%d\",B+i);\n    for(int i=*fac=1;i<N;++i)\n    fac[i]=fac[i-1]*(LL)i%md;\n    iv[N-1]=pow(fac[N-1],md-2);\n    for(int i=N-2;~i;--i)iv[i]=(i+1LL)*iv[i+1]%md;\n    init(n+m<<1);\n    for(int i=0;i<n+m-1;++i)C[i]=iv[i];\n    NTT(A,1),NTT(B,1),NTT(C,1);\n    for(int i=0;i<lim;++i)A[i]=(LL)A[i]*C[i]%md,B[i]=(LL)B[i]*C[i]%md;\n    NTT(A,0),NTT(B,0);\n    for(int i=0;i<lim;++i)C[i]=0;\n    for(int i=0;i<n+m-1;++i)\n    C[i]=(i&1)?md-iv[i]:iv[i];\n    for(int i=0;i<lim;++i)A[i]=(LL)A[i]*B[i]%md*fac[i]%md;\n    for(int i=n+m-1;i<lim;++i)A[i]=0;\n    NTT(A,1),NTT(C,1);\n    for(int i=0;i<lim;++i)A[i]=(LL)A[i]*C[i]%md;\n    NTT(A,0);\n    for(int i=0;i<n+m-1;++i)printf(\"%d%c\",A[i],\" \\n\"[i==n+m-2]);\n    return 0;\n}\n\n```",
        "postTime": 1557997197,
        "uid": 6813,
        "name": "mrsrz",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5394 \u3010\u3010\u6a21\u677f\u3011\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u4e58\u6cd5\u3011"
    }
]
[
    {
        "content": "[\u4e0a\u4e00\u7bc7\u9898\u89e3](https://www.luogu.com.cn/blog/Stitch0711/solution-b3717)\n\n\u8003\u8651\u76f4\u63a5\u6839\u636e\u8d39\u9a6c\u5c0f\u5b9a\u7406\u6c42\u51fa $(n!)^{-1}$\u3002\n\n\u7136\u540e\u6839\u636e $(i!)^{-1}=(i+1)!^{-1}\\times (i+1)$ \u53cd\u63a8\u56de\u53bb\uff0c\u8fd9\u6837\u66f4\u52a0\u5de7\u5999\uff0c\u4f46\u7406\u8bba\u4e0a\u590d\u6742\u5ea6\u4e00\u6837\u3002\n\n\u663e\u7136\u65f6\u6548\u66f4\u597d\uff0c\u56e0\u4e3a\u4e0d\u9700\u8981\u6c42\u9006\u5143\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N = 5e6 + 5, p = 998244353;\nll f[N], inv[N], t, maxn;\nll Pow(ll a, int b) {\n\tll ans = 1;\n\twhile(b) {\n\t\tif(b & 1) ans = ans * a % p;\n\t\ta = a * a % p;\n\t\tb >>= 1;\n\t}\n\treturn ans;\n}\nint main() {\n\tios::sync_with_stdio(false);\n\tcin >> t >> maxn; f[0] = 1;\n\tfor(int i = 1; i <= maxn; i++) f[i] = f[i - 1] * i % p;\n\tinv[maxn] = Pow(f[maxn], p - 2);\n\tfor(int i = maxn - 1; i >= 0; i--) inv[i] = inv[i + 1] * (i + 1) % p; // \u53cd\u63a8\u9636\u4e58\u9006\u5143\n\tint ans = 0;\n\twhile(t--) {\n\t\tint n, m; cin >> n >> m;\n\t\tll tmp = f[n] * inv[m] % p * inv[n - m] % p;\n\t\tans ^= tmp;\n\t}\n\tcout << ans;\n\treturn 0;\n}\n```\n\n\u5728 C++20 O2 \u7684\u73af\u5883\u4e0b\uff1a\n\n\u672c\u9898\u89e3\u4ee3\u7801 1.11s \u901a\u8fc7\u3002\n\n\u4e0a\u4e00\u7bc7 1.19s\u3002\n\n~~80ms \u5dee\u8ddd\u4e0d\u5927\u3002~~",
        "postTime": 1679561773,
        "uid": 675466,
        "name": "Stitch0711",
        "ccfLevel": 5,
        "title": "B3717\u9898\u89e32"
    },
    {
        "content": "# B3717 \u7ec4\u5408\u6570\u95ee\u9898 \u9898\u89e3\n\n###### ad: [better_reading_experience](https://www.luogu.com.cn/blog/DMTX-blog/b3717-ti-jie)\n\n$\\text{2023/3/19}$ \u66f4\u65b0\uff1a\u4fee\u590d $\\text{markdown}$ \u3002\n\n$\\text{2023/3/24}$ \u66f4\u65b0\uff1a\u4fee\u590d $\\LaTeX$ \u3002\n\n------------\n\n[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/B3717)\n\n\u62ff\u5230\u8fd9\u9053\u9898\uff0c\u6211\u4eec\u5148\u6765\u7b80\u5355\u5206\u6790\u4e00\u4e0b\u53ef\u884c\u7684\u601d\u8def\uff1a\n\n- \u66b4\u529b\u7b97\n- \u5362\u5361\u65af\u5b9a\u7406\n- \u9006\u5143\n\n\u6211\u4eec\u5206\u522b\u6765\u770b\u4e00\u4e0b\u8fd9\u4e09\u4e2a\u601d\u8def\u7684\u53ef\u884c\u6027\u3002\n\n## plan 1 \u66b4\u529b (TLE)\n\n\u5f88\u663e\u7136\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u662f\u4e0d\u53ef\u884c\u7684\u3002\u9898\u76ee\u4e2d\u6709\u8fd9\u6837\u7684\u6570\u636e\u8303\u56f4\uff1a\n\n> $1 \\le T \\le 5 \\times 10^6 \\text{\uff0c } m \\le n \\le N \\le 5 \\times 10^6$\n\n\u5982\u679c\u6211\u4eec\u66b4\u529b\u7b97\u51fa\u6bcf\u4e00\u4e2a\u503c\u7684\u8bdd\uff0c\u663e\u7136\u4f1a\u8d85\u65f6\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u6765\u770b plan 2\u3002\n\n## plan 2 \u5362\u5361\u65af\u5b9a\u7406 (TLE)\n\n[**\u5362\u5361\u65af\u5b9a\u7406**](https://oi-wiki.org/math/number-theory/lucas/)\n\n\u5362\u5361\u65af\u5b9a\u7406\u662f\u8fd9\u6837\u7684\uff1a\n\n\u5bf9\u4e8e\u8d28\u6570 $p$\uff0c \u6b63\u6574\u6570 $n \\le m$\uff0c \u6709\uff1a\n\n$C _{m} ^{n} =  C _{\\frac{m}{p}} ^{\\frac{n}{p}} \\times C _{m \\bmod p} ^{n \\bmod p} \\bmod p$\n\n\u4f46\u8fd9\u4e00\u505a\u6cd5\u4f1a TLE\uff0c\u6240\u4ee5\u4e0d\u80fd\u7528\u6765\u505a\u8fd9\u4e00\u9053\u9898\uff0c\u4f46\u53ef\u4ee5 AC [P3807](https://www.luogu.com.cn/problem/P3807)\u3002\n\n[\u60b2\u4f24\u7684TLE](https://www.luogu.com.cn/record/105101464)\n\n## plan 3 \u9006\u5143 (AC)\n\n[**\u9006\u5143**](https://oi-wiki.org/math/number-theory/inverse/)\n\n\u56e0\u4e3a $C _{m} ^{n} \\bmod p = \\dfrac{n!}{m! \\times (n-m)!} \\bmod p = (n! \\bmod p) \\times (m!^{-1} \\bmod p) \\times ((n-m)!^{-1} \\bmod p) \\bmod p$ \uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u9884\u5904\u7406\u51fa $m!$ \u548c $(n-m)!$ \u5728 $\\bmod p$ \u4e0b\u7684\u9006\u5143\u5373\u53ef\u3002\n\n## code\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nint T,maxn,n,m,tmp,ans=0;\nint ny[5000005],nyjie[5000005],jie[5000005]; \nconst int p=998244353;\ninline int read(){\t//\u5feb\u8bfb\u6a21\u677f \n\tregister int x=0,f=1;\n\tregister char c;\n\tc=getchar();\n\twhile(c<'0'||c>'9'){\n\t\tif(c=='-') f=-1;\n\t\tc=getchar();\n\t}\n\twhile(c>='0'&&c<='9'){\n\t\tx=x*10+c-'0';\n\t\tc=getchar();\n\t}\n\treturn x * f;\n}\ninline void write(int x){\t//\u5feb\u5199\u6a21\u677f \n\tif(x < 0){\n\t\tputchar('-');\n        x = -x;\n\t}\n\tif(x > 9){\n\t\twrite(x/10);\n\t}\n\tputchar(x % 10 + '0');\n    return;\n}\nvoid init(){\n\tny[1]=1;\n\tnyjie[0]=1;\n\tjie[0]=1; \n\tfor(int i=2;i<=maxn;i++){\t// p.s. \u53ea\u80fd\u7528\u7ebf\u6027\u7b5b\u6cd5\u6765\u6c42\u9006\u5143\uff0c\u5426\u5219\u4f1aTLE \n\t\tny[i]=(p-p/i)*ny[p%i]%p; //\u7ebf\u6027\u7b5b\u6c42\u9006\u5143 \n\t}\n\tfor(int i=1;i<=maxn;i++){\t//\u6ce8\u610f\u662f maxn \uff0c\u4e0d\u662f n \n\t\tnyjie[i]=nyjie[i-1]*ny[i]%p;\t//\u7ebf\u6027\u7b5b\u6c42\u9636\u4e58\u7684\u9006\u5143 \n\t\tjie[i]=jie[i-1]*i%p;\t//\u7ebf\u6027\u6c42\u9636\u4e58\n\t}\n}\nsigned main(){\n\tT=read(),maxn=read();\n\tinit();\t//\u5343\u4e07\u522b\u5fd8\u4e86\u521d\u59cb\u5316 \n\twhile(T--){\n\t\tn=read(),m=read();\n\t\ttmp=(jie[n]*nyjie[m]%p)*nyjie[n-m]%p;\t//\u6c42\u503c \n\t\tans=ans^tmp;\t//\u6309\u4f4d\u5f02\u6216 \n\t}\n\twrite(ans);\n\treturn 0;\n}\n```\n\n[\u559c\u60a6\u7684AC](https://www.luogu.com.cn/record/105113208)",
        "postTime": 1679140861,
        "uid": 565378,
        "name": "Orange1015",
        "ccfLevel": 3,
        "title": "B3717\u9898\u89e3"
    },
    {
        "content": "\u5927\u5bb6\u597d\uff0c\u6211\u662f CQ-C2024 \u849f\u84bb CJH\u3002\n\n\u6700\u8fd1\u56de\u6765\u590d\u4e60\u4e00\u4e0b\u7ec4\u5408\u6570\uff0c\u4e8e\u662f\u5c31\u770b\u5230\u4e86\u8fd9\u4e00\u9053\u9898\u3002\n\n## \u9898\u610f\n\n\u7ed9\u5b9a\u4e24\u4e2a\u6574\u6570 $n,m$\uff0c\u6c42\u51fa $\\dbinom{n}{m}$\u3002\n\n## \u5206\u6790\n\n\u6839\u636e\u7ec4\u5408\u6570\u7684\u5b9a\u4e49\u53ef\u77e5\uff1a\n\n$$\\dbinom{n}{m}=\\dfrac{n!}{m!(n-m)!}$$\n\n\u6839\u636e\u6570\u636e\u8303\u56f4 $1 \\leq T \\leq 5 \\times 10^6$\uff0c$0 \\leq m \\leq n \\leq N \\leq 5 \\times 10^6$\uff0c\u53ef\u77e5\u5355\u6b21\u6c42\u7ec4\u5408\u6570\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(1)$ \u624d\u884c\u3002\n\n\u5f88\u5bb9\u6613\u60f3\u5230\u9884\u5904\u7406\u9636\u4e58\u4ee5\u53ca[\u4e58\u6cd5\u9006\u5143](https://oi-wiki.org/math/number-theory/inverse/)\u7684\u9636\u4e58\u3002\n\n\u603b\u4f53\u65f6\u95f4\u590d\u6742\u5ea6 $O(N+T)$\u3002\n\n## \u4ee3\u7801\n\n```cpp\n//the code is from chenjh\n#include<cstdio>\n#define MAXN 5000005\ntypedef long long LL;\nconst int mod=998244353;\nint f[MAXN],inv[MAXN];//\u9636\u4e58\u4ee5\u53ca\u4e58\u6cd5\u9006\u5143\u3002\nint main(){\n\tint T,N;scanf(\"%d%d\",&T,&N);\n\tf[0]=f[1]=inv[0]=inv[1]=1;//\u8bb0\u5f97\u8d4b\u521d\u59cb\u503c\uff01\n\tfor(int i=2;i<=N;i++) f[i]=(LL)f[i-1]*i%mod,inv[i]=(LL)(mod-mod/i)*inv[mod%i]%mod;//\u9012\u63a8\u9636\u4e58\u548c\u9006\u5143\uff0c\u4e2d\u95f4\u8fd0\u7b97\u53ef\u80fd\u4f1a\u8d85\u8fc7 long long\uff0c\u6240\u4ee5\u9700\u8981\u4e34\u65f6\u8f6c\u6362\u7c7b\u578b\u3002\n\tfor(int i=1;i<=N;i++) inv[i]=(LL)inv[i-1]*inv[i]%mod;//\u9884\u5904\u7406\u9006\u5143\u7684\u9636\u4e58\u3002\n\tint ans=0;\n\tfor(int n,m;T--;)scanf(\"%d%d\",&n,&m),ans^=(LL)f[n]*inv[m]%mod*inv[n-m]%mod;//\u6839\u636e\u7ec4\u5408\u6570\u516c\u5f0f\u6c42\u51fa\u7ec4\u5408\u6570\u3002\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\n\n## \u5173\u4e8e\u6b64\u9898\u7684\u9898\u5916\u8bdd\n\n\u56e0\u4e3a\u6b64\u9898\u53ea\u6709\u4e00\u7ec4\u6570\u636e\uff0c\u6240\u4ee5\u7528\u4ee5\u4e0b\u7684\u4ee3\u7801\u4e5f\u53ef\u4ee5 AC \u6b64\u9898\uff1a\n\n```c\nmain(){puts(\"522716868\");}\n```\n\n\u6545\u8bf7\u6c42\u7ba1\u7406\u5458\u52a0\u5f3a\u6570\u636e\u3002",
        "postTime": 1684394252,
        "uid": 577880,
        "name": "cjh20090318",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 B3717 \u7ec4\u5408\u6570\u95ee\u9898"
    },
    {
        "content": "[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/B3717)   \n\u4e00\u9053\u7ec3\u4e60\u9006\u5143\u7684\u597d\u9898\u3002     \n\u9996\u5148\uff0c\u6211\u4eec\u77e5\u9053\uff0c$C^m_n=\\frac{n!}{m!\\times(n-m)!}$\u3002     \n\u90a3\u53d6\u6a21\u600e\u4e48\u505a\u5462\uff1f     \n\u8003\u8651\u5230\u6a21\u6570\u662f\u8d28\u6570\uff0c\u53ef\u4ee5\u4f7f\u7528\u9006\u5143\u8ba1\u7b97\u9664\u6cd5\u3002        \n\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u9884\u5904\u7406\u9636\u4e58\uff0c\u4e4b\u540e\u6bcf\u6b21\u8ba1\u7b97\u7528\u9006\u5143\u8ba1\u7b97\u5373\u53ef\u3002    \n\u4f46\u662f\u8fd9\u6837\u4f1a TLE\u3002     \n\u4e3a\u4ec0\u4e48\u5462\uff1f      \n\u6c42\u9006\u5143\u662f $O(\\log n)$ \u7684\uff0c\u800c $1\\le T,N\\le5\\times10^6$\uff0c\u65f6\u95f4\u592a\u6162\u4e86\u3002        \n\u8003\u8651\u5230\u4e0a\u9762\u7684\u5f0f\u5b50\u53ef\u4ee5\u628a\u4e58\u6cd5\u5316\u6210\u9664\u6cd5\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u76f4\u63a5\u9884\u5904\u7406\u9636\u4e58\u7684\u9006\u5143\u5373\u53ef\u3002       \n\u4e0d\u96be\u60f3\u5230\uff0c$i!^{-1}=(i-1)!^{-1}\\times i^{-1}$\u3002        \n\u6211\u4eec\u5148\u9884\u5904\u7406\u51fa $[1,N]$ \u91cc\u7684\u9006\u5143\uff0c\u518d\u9884\u5904\u7406\u9636\u4e58\u7684\u9006\u5143\u5373\u53ef\u3002     \n[CODE](https://www.luogu.com.cn/paste/68ryutoe)",
        "postTime": 1679804346,
        "uid": 592238,
        "name": "__dest__ruct__or__",
        "ccfLevel": 0,
        "title": "B3717 \u7ec4\u5408\u6570\u95ee\u9898 \u9898\u89e3"
    },
    {
        "content": "$C_n^m={\\dfrac{n!}{m!\\times(n-m)!}}$\n\n\u90a3\u4e48\u53ef\u4ee5\u7406\u89e3\u4e3a $n!\\times (m!)^{-1}\\times (n-m!)^{-1}$\u3002\n\n$n!$ \u5bf9 $p$ \u53d6\u6a21\u53ef\u4ee5\u9884\u5904\u7406\u3002\n\n\u63a5\u4e0b\u6765\u662f\u9884\u5904\u7406\u9636\u4e58\u7684\u9006\u5143 $(x!)^{-1}$\u3002\n\n\u663e\u7136\u53ef\u5f97 $(x!)^{-1}=({(x-1)!)^{-1}\\times x^{-1}}$\u3002\n\n\u90a3\u4e48\u5148\u7ebf\u6027\u9012\u63a8 $x^{-1}$\uff0c\u518d\u7ebf\u6027\u9012\u63a8 $(x!)^{-1}$ \u5373\u53ef\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define pc putchar\nconst int N = 5000010;\nint inv[N], jc[N], Jc[N];\nconst int p = 998244353;\nvoid init(int n, int p) {\n\tinv[1] = 1, jc[0] = 1, Jc[0] = 1;\n\tfor(int i = 2; i <= n; i++) inv[i] = 1LL * (p - p / i) * inv[p % i] % p; // \u7ebf\u6027\u6c42\u9006\u5143\n\tfor(int i = 1; i <= n; i++) jc[i] = 1LL * jc[i - 1] * inv[i] % p, Jc[i] = 1LL * Jc[i - 1] * i % p; // \u7ebf\u6027\u6c42\u9636\u4e58\u9006\u5143\n}\nsigned main() {\n\tios::sync_with_stdio(0);\n\tint ans = 0, t, maxn; cin >> t >> maxn; init(maxn, p);\n\twhile(t--) {\n\t    int n, m; cin >> n >> m;\n\t    int a = 1LL * Jc[n] * jc[m] % p * jc[n - m] % p;\n\t    ans ^= a;\n\t}\n\tcout << ans << endl;\n    return 0;\n}\n```",
        "postTime": 1678351309,
        "uid": 675466,
        "name": "Stitch0711",
        "ccfLevel": 5,
        "title": "B3717 \u9898\u89e3"
    }
]
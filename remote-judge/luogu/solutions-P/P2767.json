[
    {
        "content": "\u597d\u50cf\u6ca1\u4ec0\u4e48\u4eba\u7528\u66f4\u6570\u5b66\u4e00\u70b9\u7684\u65b9\u6cd5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u2026\u2026\n\n\u8003\u8651\u751f\u6210\u51fd\u6570\uff0c\u9996\u5148\u8981\u6709\u4e00\u4e2a\u8282\u70b9\uff0c\u5176\u6b21\u6bcf\u4e2a\u5b50\u6811\u53ef\u4ee5\u4e3a\u7a7a\u6216\u8005\u4e3a $m$ \u53c9\u6811\uff0c\u56e0\u6b64\u53ef\u5217\u51fa\u5f0f\u5b50\n\n$$ f(z) = z(1 + f(z))^m $$\n\n\u53d8\u5f0f\u4e3a\n\n$$ z = \\frac{f(z)}{(1 + f(z))^m} $$\n\n\u90a3\u4e48\u5b9a\u4e49\u9006\u51fd\u6570\n\n$$ g(w) = \\frac{w}{(1+w)^m} $$\n\n\u6839\u636e Lagrange \u53cd\u6f14\uff0c\u6709\n\n$$ [z^n]f(z) = \\frac1n[w^{n-1}]\\left(\\frac w{g(w)}\\right)^n $$\n\n\u5c55\u5f00\uff0c\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\u53ef\u4ee5\u5f97\u5230\n\n$$ \\frac{\\binom{nm}{n - 1}}{n} $$\n\n\u90a3\u4e48\u5c31\u7b97\u51fa\u7ec4\u5408\u6570\u5c31\u5b8c\u4e8b\u4e86\u3002\n\n```cpp\n#include <cstdio>\n\nusing namespace std;\n\nconst int P = 10007;\n\nint inv[P], fac[P], ifac[P];\n\nint binom(int n, int m) {\n\tif (m > n)\n\t\treturn 0;\n\treturn fac[n] * ifac[m] % P * ifac[n - m] % P;\n}\n\nint lucas(int n, int m) {\n\tif (m > n)\n\t\treturn 0;\n\tif (m == 0)\n\t\treturn 1;\n\treturn binom(n % P, m % P) * lucas(n / P, m / P) % P;\n}\n\nint main() {\n\n\tinv[1] = 1;\n\tfor (int x = 2; x < P; ++x)\n\t\tinv[x] = -(P / x) * inv[P % x] % P + P;\n\tfac[0] = ifac[0] = 1;\n\tfor (int x = 1; x < P; ++x) {\n\t\tfac[x] = fac[x - 1] * x % P;\n\t\tifac[x] = ifac[x - 1] * inv[x] % P;\n\t}\n\tint n, m;\n\tscanf(\"%d%d\", &n, &m);\n\tprintf(\"%d\\n\", lucas(n * m, n - 1) * inv[n] % P);\n\n\treturn 0;\n}\n```\n",
        "postTime": 1537709974,
        "uid": 21423,
        "name": "Elegia",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P2767 \u3010\u6811\u7684\u6570\u91cf\u3011"
    },
    {
        "content": "### \u9898\u610f\n\u6c42 $n$ \u4e2a\u8282\u70b9\u7684\u6709\u6839 $m$ \u53c9\u6811\u7684\u4e2a\u6570\n### \u9898\u89e3\n\u5176\u4ed6\u9898\u89e3\u91cc\u5199\u7684\u795e\u4ed9\u7ec4\u5408\u6570\u770b\u4e0d\u61c2\uff0c\u53d1\u4e2a $O(n^3)$ \u7684\u52a8\u89c4\u9898\u89e3\u5427\n\n~~\u597d\u60f3\u53c8\u597d\u5199\uff0c\u52a8\u89c4\u5927\u6cd5\u4fdd\u667a\u5546~~\n\n###### \u72b6\u6001 \n$dp_{i,j}$ \u8868\u793a\u6709 $i$ \u4e2a\u70b9\uff0c\u6839\u8282\u70b9\u6709 $j$ \u68f5\u5b50\u6811\u65f6\u7684\u65b9\u6848\u6570\uff08\u5141\u8bb8\u5b50\u6811\u4e3a\u7a7a\uff09\n\n###### \u8f6c\u79fb\n\u5148\u5f3a\u52bf\u4e0a\u56fe \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jet6pd0f.png)\n\n$$dp_{i,j}=\\sum_{k=0}^{i-1}dp_{k,m}\\cdot dp_{i-k,j-1}$$\n\n\u6211\u4eec\u679a\u4e3e\u5f53\u524d\u7684\u8fd9\u68f5\u5b50\u6811\u6709 $k$ \u4e2a\u70b9\uff0c\u5141\u8bb8\u6709\u7a7a\u6811\uff0c\u6240\u4ee5 $k\\ge 0$\uff0c\u8981\u7ed9\u6839\u8282\u70b9\u7559\u4e00\u4e2a\u70b9\uff0c\u6240\u4ee5 $k\\le i-1$\uff0c\u8fd9\u68f5\u5b50\u6811\u5141\u8bb8\u6700\u591a\u6709 $m$ \u4e2a\u513f\u5b50\uff0c\u6240\u4ee5\u8be5\u5b50\u6811\u7684\u65b9\u6848\u6570\u4e3a $dp_{k,m}$\n\n\u73b0\u5728\u8fd8\u5269\u4e0b\u4e00\u9897\u6709 $i-k$ \u4e2a\u8282\u70b9\u7684\u6811\uff0c\u56e0\u4e3a\u6709\u4e00\u4e2a\u5b50\u6811\u914d\u989d\u88ab\u6211\u4eec\u679a\u4e3e\u7684\u5b50\u6811\u7528\u6389\u4e86\uff0c\u6240\u4ee5\u73b0\u5728\u8fd8\u6709 $j-1$ \u4e2a\u5b50\u6811\u914d\u989d\uff0c\u5269\u4e0b\u7684\u6811\u7684\u65b9\u6848\u6570\u4e3a $dp_{i-k,j-1}$\n\n\u628a\u4e24\u4e2a\u67ff\u5b50\u4e58\u4e00\u4e58\u52a0\u4e00\u52a0\u5c31\u5f97\u5230 $dp_{i,j}$ \u4e86\n### \u4ee3\u7801\n```cpp\n#include<iostream>\n#define mod 10007\nusing namespace std;\nint n,m,dp[128][128];\nint main()\n{\n\tcin>>n>>m;\n\tfor(int i=0;i<=m;i++)dp[0][i]=1;\n\tfor(int i=0;i<=m;i++)dp[1][i]=1;\n\tfor(int i=2;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++)\n\t\t\tfor(int k=0;k<i;k++)\n\t\t\t\tdp[i][j]=(dp[i][j]+dp[k][m]*dp[i-k][j-1]%mod)%mod;\n\tcout<<dp[n][m];\n}\n```",
        "postTime": 1626346670,
        "uid": 87434,
        "name": "_Life_",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2767 \u3010\u6811\u7684\u6570\u91cf\u3011"
    },
    {
        "content": "**upd \uff1a\u524d\u6587\u4ecb\u7ecd\u7684\u529e\u6cd5\u6bd4\u8f83\u9ebb\u70e6\uff0c\u5982\u679c\u4f60\u60f3\u77e5\u9053\u8f7b\u677e\u4e00\u70b9\u7684\u65b9\u6cd5\u53ef\u4ee5\u770b\u540e\u9762**\n\n\u4ec0\u4e48\u62c9\u53cd\u6211\u4e0d\u61c2\uff0c\u83dc\u5c31\u7528\u4e86\u83dc\u7684\u65b9\u6cd5\u3002\n\n\u8bbe $i$ \u4e2a\u70b9\u7684\u751f\u6210\u6811\u6570\u76ee\u662f $f_i$\uff0c\u4ed6\u7684 $\\rm OGF$ \u662f $F(x) = \\sum\\limits_{i \\ge 0} f_i x^i$ \n\n\u6709 $F(x) = x F(x)^m + 1$\uff0c$xF(x)^{m} - F(x) + 1 = 0$\n\n\u725b\u987f\u8fed\u4ee3\u5373\u53ef\n\n\u8fd9\u4e2a\u51fa\u4f53\u4eba\u4e0d\u8bb2 wood\uff0c\u4e0d\u7ed9 $\\rm NTT$ \u819c\u6570\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u8fd9\u91cc\u7528\u4e86\u66b4\u529b\u6c42\u9006\uff0c\u66b4\u529b\u5feb\u901f\u5e42\u7b49\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\Theta(n^2 \\log m)$\uff08\u66b4\u529b\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u662f $n^2\\log m$ \u7684\uff09\n\n```cpp\n#include<bits/stdc++.h>\n#define L(i, j, k) for(int i = j, i##E = k; i <= i##E; i++)\n#define R(i, j, k) for(int i = j, i##E = k; i >= i##E; i--)\n#define ll long long\n#define ull unsigned long long\n#define db double\n#define pii pair<int, int>\n#define mkp make_pair\nusing namespace std;\nconst int N = 2e4 + 7, mod = 10007;\nint qpow(int x, int y = mod - 2) {\n\tint res = 1;\n\tfor(; y; x = (ll) x * x % mod, y >>= 1) if(y & 1) res = (ll) res * x % mod;\n\treturn res;\n}\nvoid mul(int *f, int *g, int *ans, int n, int m) {\n\tstatic int res[N]; \n\tfill(res, res + n + m - 1, 0);\n\tL(i, 0, n - 1) L(j, 0, m - 1) (res[i + j] += (ll) f[i] * g[j] % mod) %= mod;\n\tcopy(res, res + n + m - 1, ans);\n} \nvoid fpow(int *f, int *g, int k, int n) {\n\tstatic int res[N], now[N]; \n\tfill(res, res + n, 0), res[0] = 1, copy(f, f + n, now);\n\tfor(; k; mul(now, now, now, n, n), k >>= 1) if(k & 1) mul(res, now, res, n, n);\n\tcopy(res, res + n, g);\n}\nvoid inv(int *f, int *g, int n) {\n\tstatic int sav[N], ans[N];\n\tfill(sav, sav + n, 0), sav[0] = 1;\n\tL(i, 0, n - 1) {\n\t\tans[i] = (ll) sav[i] * qpow(f[0]) % mod;\n\t\tL(j, i, n - 1) (sav[j] += mod - (ll) ans[i] * f[j - i] % mod) %= mod;\n\t}\n\tcopy(ans, ans + n, g);\n}\nint t;\nvoid Newton(int *f, int n) {\n\tstatic int sav[N], sv[N], now[N];\n\tfill(now, now + n, 0), now[0] = 1;\n\tfor(int m = 1, pn; m <= n; m <<= 1) {\n\t\tpn = m << 1, fpow(now, sav, t, pn), fpow(now, sv, t - 1, pn);\n\t\tR(i, pn - 1, 1) sav[i] = sav[i - 1], sv[i] = (ll) sv[i - 1] * t % mod;\n\t\tsav[0] = 1, sv[0] = mod - 1;\n\t\tL(i, 0, pn - 1) (sav[i] += mod - now[i]) %= mod;\n\t\tinv(sv, sv, pn), mul(sav, sv, sav, pn, pn);\n\t\tL(i, 0, pn - 1) (now[i] += mod - sav[i]) %= mod; \n\t}\n\tcopy(now, now + n, f);\n}\nint n, f[N];\nint main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0), cout.tie(0);\n\tcin >> n >> t;\n\tNewton(f, n + 1);\n\tcout << f[n] << \"\\n\";\n\treturn 0;\n} \n```\n\n\u8fd9\u4e2a\u505a\u6cd5\u4e5f\u662f\u6709\u4f18\u52bf\u7684\uff0c\u5982\u679c\u7528\u4efb\u610f\u6a21\u6570 NTT \u53ef\u4ee5\u5728 $\\Theta(n \\log n)$ \u7684\u65f6\u95f4\u5185\u5f97\u5230\u6240\u6709 $x \\le n$ \u7684\u7b54\u6848qwq\n\n-----\n\n\u4f18\u79c0\u7684\u505a\u6cd5\u662f\u4ec0\u4e48\uff1f\n\n\u53d1\u73b0\u8fd9\u4e2a\u65b9\u7a0b\u662f $\\mathcal{B}_m$\uff0c\u4e8e\u662f\u7b54\u6848\u662f $\\frac{\\binom{nm+1}{n}}{nm+1} = \\frac{\\binom{nm}{n-1}}{n}$\uff0c\u6211\u4eec\u79d2\u4e86\u8fd9\u9898\u3002\n\n\u4e0d\u4f1a\u5e7f\u4e49\u4e8c\u9879\u7ea7\u6570\u7684\u53ef\u4ee5\u70b9 [\u8fd9\u513f](https://www.cnblogs.com/zkyJuruo/p/14872991.html)\u3002",
        "postTime": 1614474831,
        "uid": 173660,
        "name": "zhoukangyang",
        "ccfLevel": 0,
        "title": "\u9898\u89e3-P2767 \u6811\u7684\u6570\u91cf"
    },
    {
        "content": "# Fuss-Catalan \u6570\n\n\u5b9a\u4e49 $C_k(z)$ \u6ee1\u8db3\n$$\nC_k(z) = 1 + z C_k^k(z)\n$$\n\n\u6709\u7ed3\u8bba $[z^n] C_k^s(z) = \\frac{s}{kn+s}\\binom{kn+s}{n}$\uff0c\u901a\u8fc7\u62c9\u683c\u6717\u65e5\u53cd\u6f14\u5f88\u5bb9\u6613\u8bc1\u660e\uff0c\u4f46\u6b64\u5904\u4e0d\u8d58\u8ff0\u3002  \n\u5f53 $s=1,k=2$ \u65f6\u5c31\u7edf\u4e00\u5230\u7ecf\u5178\u7684 Catalan \u6570 $\\frac1{n+1} \\binom{2n}n$\u3002\n\n# k-Dyck \u8def\n\n\u8003\u8651\u4ece $(0,0)$ \u5230 $((k+1)n,0)$ \u7684\u683c\u70b9\u8def\u5f84\uff0c\u5176\u4e2d\u53ea\u80fd\u8d70 $(1,1)$ \u6216 $(1,-k)$\uff0c\u4e14\u4e0d\u80fd\u8d70\u5230 $y=0$ \u4ee5\u4e0b\u3002\n\n\u5f53 $k=1$ \u65f6\u5c31\u7edf\u4e00\u5230\u8bb8\u591a\u5e38\u89c1\u7684\u7ec4\u5408\u6a21\u578b\uff1a\u62ec\u53f7\u5e8f\u5217\u3001\u51fa\u6808\u5e8f\u5217\u3001\u51f8\u591a\u8fb9\u5f62\u4e09\u89d2\u5212\u5206\u3001\u4e8c\u53c9\u6811\u7b49\u3002\u8fd9\u4e5f\u5c31\u662f\u7ecf\u5178\u7684 Catalan \u6570 $\\frac1{n+1} \\binom{2n}n$\u3002\n\n# k \u53c9\u6811\n\n\u672c\u6587\u4e2d\u8003\u8651\u7684 $k$ \u53c9\u6811\u6ee1\u8db3\u6bcf\u4e2a\u7ed3\u70b9**\u5fc5\u6709** $k$ \u4e2a\u513f\u5b50\u6216**\u6ca1\u6709**\u513f\u5b50\uff0c\u5176\u4e2d\u6709\u513f\u5b50\u7684\u70b9\u79f0\u4e3a**\u5185\u70b9**\uff0c\u6ca1\u6709\u513f\u5b50\u7684\u70b9\u79f0\u4e3a**\u5916\u70b9**\u3002  \n\u5bb9\u6613\u53d1\u73b0\u6b64\u9898\u5373\u8ba1\u6570\u6070\u6709 $n$ \u4e2a\u5185\u70b9\u7684 $m$ \u53c9\u6811\u4e2a\u6570\u3002\n\n\u5f53 $k=2$ \u65f6\u5c31\u7edf\u4e00\u5230\u7ecf\u5178\u7684 Catalan \u6570 $\\frac1{n+1} \\binom{2n}n$\u3002\n\n# \u4e00\u79cd\u8054\u7cfb\n\n\u4ece Symbolic Method \u53ef\u4ee5\u7acb\u523b\u5efa\u7acb\u8d77 $k$ \u53c9\u6811\u4e0e $C_k(z)$ \u7684\u8054\u7cfb\uff1a\u540e\u8005\u5373\u4e3a\u524d\u8005\u7684 OGF\u3002  \n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5efa\u7acb $k+1$ \u53c9\u6811\u4e0e $k$-Dyck \u8def\u7684\u53cc\u5c04\uff0c\u518d\u4ecb\u7ecd\u4e00\u79cd\u8ba1\u6570 $k$-Dyck \u8def\u7684**\u7ec4\u5408\u65b9\u6cd5**\u3002\n\n## \u53cc\u5c04\n\n### \u6811 -> \u8def\n\n\u6211\u4eec\u9996\u5148\u6539\u5199 $k$-Dyck \u8def\u4e3a\uff1a\u7b2c\u4e00\u6b65\u5fc5\u4e3a $(1,1)$\uff0c\u6700\u540e\u8d70\u5230 $((k+1)n+1,1)$\uff0c\u4e14\u7b2c\u4e00\u6b65\u4e4b\u540e\u4e0d\u8d70\u5230 $y=1$ \u4ee5\u4e0b\u7684\u683c\u70b9\u8def\u5f84\u3002  \n\u5bb9\u6613\u53d1\u73b0\u8fd9\u6837\u7684 $k$-Dyck \u8def\u548c\u539f\u6765\u7684 $k$-Dyck \u8def\u4e5f\u662f\u4e00\u4e00\u5bf9\u5e94\u7684\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651\u4e00\u68f5 $k+1$ \u53c9\u6811\u5982\u4f55\u6620\u5c04\u5230\u4e00\u6761 $k$-Dyck \u8def\u3002  \n\u9996\u5148\u5728\u6700\u524d\u9762\u6dfb\u52a0\u4e00\u6b65 $(1,1)$\uff1b\u63a5\u4e0b\u6765\u4ece\u5de6\u5f80\u53f3\u8003\u8651\u5176 $k+1$ \u4e2a\u513f\u5b50\uff0c\u5c06\u5176\u5404\u81ea\u5b50\u6811\u6240\u6620\u5c04\u5230\u7684 $k$-Dyck \u8def\u63a5\u5728\u5df2\u6709\u7684 $k$-Dyck \u8def\u540e\u65b9\uff1b\u6700\u540e\uff0c\u5982\u679c\u8fd9\u68f5\u6811\u7684\u6839\u7ed3\u70b9\u4e3a\u5185\u70b9\uff0c\u5219\u5728\u6700\u540e\u6dfb\u52a0\u4e00\u6b65 $(1,-k)$\u3002  \n\u5bb9\u6613\u9a8c\u8bc1\u8fd9\u6837\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u6761\u5408\u6cd5\u7684 $k$-Dyck \u8def\u3002\n\n### \u8def -> \u6811\n\n\u540c\u6837\u6539\u5199 $k$-Dyck \u8def\u3002\n\n\u4ece\u6700\u540e\u4e00\u6b65\u5f80\u524d\u8003\u8651\u4e00\u6761 $k$-Dyck \u8def\u3002\u82e5\u6700\u540e\u4e00\u6b65\u4e3a $(1,-k)$\uff0c\u5219\u786e\u5b9a\u6811\u7684\u6839\u7ed3\u70b9\u4e3a\u5185\u70b9\u6216\u5916\u70b9\uff1b\u5982\u4e3a\u5185\u70b9\uff0c\u5219\u7ee7\u7eed\u8003\u8651\u5012\u6570\u7b2c\u4e8c\u6b65\uff0c\u5373\u53ef\u786e\u5b9a\u5f53\u524d\u6839\u7ed3\u70b9\u6700\u53f3\u7684\u5c1a\u672a\u786e\u5b9a\u7684\u513f\u5b50\u4e3a\u5185\u70b9\u6216\u5916\u70b9\uff0c\u4ee5\u6b64\u7c7b\u63a8\u5730\u9012\u5f52\u6784\u9020\u5373\u53ef\u3002\n\n# k-Dyck \u8def\u8ba1\u6570\n\n\u540c\u6837\u6539\u5199 $k$-Dyck \u8def\u3002\n\n\u8003\u8651\u4ece $(0,0)$ \u5230 $((k+1)n+1,1)$\uff0c\u4e0d\u8981\u6c42\u6240\u6709\u65f6\u523b\u4e0d\u4f4e\u4e8e $y=1$ \u7684\u683c\u70b9\u8def\u5f84\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u6620\u5c04\u5230\u4e00\u4e2a $k$-Dyck \u8def\uff1a  \n\u8003\u8651\u5176\u6700\u4f4e\u70b9\u4e2d\u6700\u53f3\u65b9\u7684\u4f4d\u7f6e\uff0c\u8bbe\u5176\u4e3a $(x,y)$\uff1b\u5c06 $x$ \u53ca\u4ee5\u540e\u7684\u6240\u6709\u90e8\u5206\u6574\u4f53\u300c\u526a\u5207\u300d\u5230 $(0,0)$ \u5f00\u59cb\u7684\u90e8\u5206\uff1b\u63a5\u4e0b\u6765\uff0c\u5c06\u539f\u8def\u5f84\u4e2d $x$ \u4ee5\u524d\u7684\u90e8\u5206\u518d\u76f4\u63a5\u63a5\u5230\u5176\u540e\u65b9\u3002\u5bb9\u6613\u53d1\u73b0\u8fd9\u6837\u6ee1\u8db3\u6761\u4ef6\u3002\n\n\u4e0d\u8fc7\u8fd9\u5e76\u4e0d\u662f\u53cc\u5c04\u3002\u6ce8\u610f\u5230\u5bf9\u4e8e\u4e00\u6761 $k$-Dyck \u8def\uff0c\u5176\u6070\u597d\u53ef\u4ee5\u6620\u5c04\u5230 $(k+1)n+1$ \u6761\u5982\u4e0a\u7684\u683c\u70b9\u8def\u5f84\u3002  \n\u56e0\u6b64\uff0c$k$-Dyck \u8def\u7684\u6570\u91cf\u5373\u4e3a $\\frac1{(k+1)n+1} \\binom{(k+1)n+1}n$\u3002\n\n\u8fd9\u4e00\u65b9\u6cd5\u4e5f\u88ab\u79f0\u4f5c\u662f\u5171\u8f6d\u539f\u5219\uff0c\u6216\u8005\u662f\u73af\u5f15\u7406\u3002  \n\u5b9e\u9645\u4e0a\uff0c\u5176\u5728\u903b\u8f91\u4e0a\u4e0e\u62c9\u683c\u6717\u65e5\u53cd\u6f14\u662f\u7b49\u4ef7\u7684\u3002\n\n# \u9898\u89e3\n\n\u56e0\u6b64\uff0c\u5bf9\u4e8e\u6b64\u9898\uff0c\u76f4\u63a5\u4f7f\u7528 Lucas \u5b9a\u7406\u8ba1\u7b97 $\\frac1{nm+1} \\binom{nm+1}n = \\frac1n \\binom{nm}{n-1}$ \u5373\u53ef\u3002",
        "postTime": 1623328634,
        "uid": 75840,
        "name": "deserter",
        "ccfLevel": 0,
        "title": "Fuss-Catalan \u6570\u3001(m-1)-Dyck \u8def\u4e0e m \u53c9\u6811"
    },
    {
        "content": "\u9996\u5148\u58f0\u660e\u4e0b\u8fd9\u7bc7\u9898\u89e3\u4e0d\u5e76\u662f\u6211\u72ec\u7acb\u5b8c\u6210\u7684\uff0c\u4e3b\u8981\u53c2\u8003\u7684\u662f[sxd666888](https://www.luogu.org/space/show?uid=84156)\u5927\u4f6c\u7684idea\u5e76\u5728\u4ed6\u7684\u534f\u52a9\u4e0b\u5b8c\u6210\u7684\u3002\n\n### $O(n^4)$\u7b97\u6cd5\n\n\u4ee4$dp[i]$\u8868\u793a\u7528$i$\u4e2a\u4e0d\u540c\u7684\u8282\u70b9\u6784\u6210$m$\u53c9\u6811\u7684\u6570\u91cf\u3002\u6211\u4eec\u53d1\u73b0\u597d\u50cf\u65e0\u6cd5\u8f6c\u79fb\uff0c\u4e8e\u662f\u8003\u8651\u53e6\u8bbe$dpp[j][k]$\u8868\u793a\u6839\u8282\u70b9\u6709$j$\u4e2a\u513f\u5b50\uff0c\u5b50\u6811\u5927\u5c0f\u4e3a$k$\u7684\u65b9\u6848\u6570\u3002\u6613\u5f97$dpp[j][k] = \\sum_{l = 0}^{k - 1}dp[l]\\times dpp[j-1][k-l]$\uff0c\u4e5f\u5c31\u662f\u8bf4\u5728\u4e00\u68f5\u6811\u7684\u6839\u8282\u70b9\u4e0a\u63a5\u4e0a\u4e00\u68f5$m$\u53c9\u6811\u3002\u6700\u540e\u6211\u4eec\u6709$dp[i] = dpp[m][i]$\u3002\n\n### $O(n^3)$\u7b97\u6cd5\n\n\u72b6\u6001\u5b9a\u4e49\u548c$O(n^4)$\u7b97\u6cd5\u4e0d\u591a\uff0c\u53ea\u662f$dpp[i][j]$\u628a\u6839\u8282\u70b9\u7ed9\u53bb\u6389\u4e86\uff0c\u5373\u5b9a\u4e49\u4e86\u7531$i$\u4e2a$j$\u53c9\u6811\u6784\u6210\u7684\u68ee\u6797\uff0c\u7136\u540e\u76f4\u63a5\u540c\u5361\u7279\u5170\u6570\u90a3\u6837\u5927\u529b\u63a5\u4e0a\u53bb\u5c31\u53ef\u4ee5\u4e86\uff1a`dpp[i][j] += dp[k] * dpp[i-k][j-1]`\u3002\n\n\u5f53\u7136\u6700\u540e\u662f$dp[i+1] = dp[m][i]$\u3002\n\n### \u66f4\u597d\u7684\u505a\u6cd5\n\n\u9996\u5148\uff0c\u6211\u4eec\u6709\u4e00\u4e2a\u731c\u60f3\uff1a\n\n\u7ed9\u5b9a\u4e00\u4e2a\u6709\u81ea\u7136\u6570\u6784\u6210\u7684\u957f\u5ea6\u4e3a$n$\u7684\u5e8f\u5217$\\{a\\}$\uff0c\u82e5$\\sum a_i=n-1$\uff0c\u5219\u6709\u4e14\u4ec5\u6709\u4e00\u4e2a$I$\u4f7f\u5f97\u53ef\u4ee5\u4ea7\u751f\u4e00\u4e2a\u6b63\u6574\u6570\uff08\u9664\u6700\u540e\u4e00\u4e2a\u4e3a$0$\uff09\u6784\u6210\u7684\u957f\u5ea6\u4e3a$n$\u7684\u5e8f\u5217$\\{b\\}$\uff1a\n\n$$b_i=\\sum_{j = 1}^{i} a_{(j+I-2)\\% n+1}-i+1$$\n\n\u6bd4\u5982\u8bf4\u8fd9\u6837\u4e00\u4e2a\u5e8f\u5217\uff1a\n\n```plain\n3 0 0 0 0 2\n```\n\n\u6211\u4eec\u6709\u4e14\u4ec5\u6709\u4e00\u4e2a$I=5$\u4f7f\u5f97\u4ea7\u751f\u5408\u6cd5$b$\u7684\u5e8f\u5217\uff1a\n\n```plain\n2 4 3 2 1 0\n```\n\n\u7136\u540e\u6211\u4eec\u6765\u8bc1\u660e\u5b83\uff1a\n\n\u6240\u6709\u5e8f\u5217$\\{a\\}$\uff0c\u5f53$I = 1$\u65f6\uff0c\u6240\u4ea7\u751f\u7684$\\{b\\}$\u5e8f\u5217\u90fd\u7c7b\u4f3c\u4e0b\u9762\u8fd9\u6837\u7684\u56fe\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/50592.png)\n\n\u53ef\u4ee5\u53d1\u73b0\u7684\u662f\uff0c\u5f53\u6211\u4eec\u9009$I = x(x \\not = 1)$\u65f6\uff0c$0$\u7ebf\u4f1a\u79fb\u5230\u5f53\u524d$b_x$\u6240\u5728\u4f4d\u7f6e\uff0c\u5e76\u4e14\u4ece$x+1\\sim n$\u548c$1$\u7684\u70b9\u4f1a\u4e0a\u5347$1$\u3002\n\n\u56e0\u6b64\uff0c\u5f53\u4e14\u4ec5\u5f53\u9009$I$\u4e3a\u6700\u8fd1\u7684\u5904\u5728\u6700\u4f4e\u8c37\u7684\u70b9\u7684\u4f4d\u7f6e\u65f6\uff0c\u4ea7\u751f\u7684$\\{b\\}$\u5408\u6cd5\u3002\n\n\u7136\u540e\u6211\u4eec\u9700\u8981\u628a\u8fd9\u4e2a\u7ed3\u8bba\u548c\u6811\u8054\u7cfb\u8d77\u6765\u3002\n\n\u6211\u4eec\u7ed9\u4e00\u68f5\u6811\u8bb0\u5f55\u4e00\u6b21$\\text{dfs}$\uff0c\u6211\u4eec\u5148\u628a\u513f\u5b50\u8282\u70b9\u5165\u6808\uff0c\u904d\u5386\u5b8c\u540e\u5c06\u5176\u51fa\u6808\uff0c\u8fd9\u6837\u5b50\uff0c\u6211\u4eec\u5bf9\u4e8e\u4e00\u4e2a\u5e8f\u5217$\\{a\\}$\uff0c${a_i}$\u8868\u793a\u7684\u662f\u7b2c$i$\u4e2a\u8282\u70b9\u6709\u51e0\u4e2a\u513f\u5b50\u3002\n\n\u6211\u4eec\u6bcf\u6b21\u904d\u5386\u5230\u4e00\u4e2a\u8282\u70b9\u65f6\u5148\u5c06\u5b83\u51fa\u6808\uff08$-1$\uff09\uff0c\u518d\u628a\u5b83\u7684\u513f\u5b50\u5165\u6808\uff08$+a_i$\uff09\uff0c\u5f53\u524d\u6808\u91cc\u5143\u7d20\u4e2a\u6570\u5c31\u662f${b_i}$\uff0c\u5373\u80fd\u62d3\u5c55\u70b9\u7684\u4e2a\u6570\u3002\u6700\u7ec8\u5c31\u5f97\u5230\u4e86$\\{b\\}$\u5e8f\u5217\u3002\u5982\u679c\u4e2d\u9014\u4e2d\u9014\u51fa\u73b0\u5c0f\u4e8e\u7b49\u4e8e$0$\u7684\u6570\uff0c\u90a3\u4e48\u4e0b\u4e00\u4e2a\u8282\u70b9\u5c31\u4e0d\u77e5\u9053\u5728\u54ea\u4e86\uff0c\u4e0d\u7b26\u5408\u6811\u7684\u5b9a\u4e49\u3002\n\n\u56e0\u4e3a\u9898\u4e2d\u662f$m$\u53c9\u6811\uff0c\u6240\u4ee5\u8fde\u63a5\u513f\u5b50\u7684\u8fb9\u7684\u9009\u62e9\u4f1a\u5f71\u54cd\n\u65b9\u6848\u6570\uff0c\u56e0\u6b64\u5e8f\u5217$\\{a\\}$\u4e2d\u6bcf\u4e2a\u6570\u7684\u5927\u5c0f\u4e0d\u8d85\u8fc7m\uff0c\u603b\u5171\u6709$n\\times m$\u6761\u8fb9\uff0c\u4ece\u4e2d\u9009\u51fa$n-1$\u6761,\u5e76\u7528\u4e0b\u56fe\u6784\u6210\u5e8f\u5217$\\{a\\}$\u3002\n\n![](https://cdn.luogu.com.cn/upload/pic/50594.png)\n\n\u800c\u6784\u6210\u7684\u5e8f\u5217$\\{a\\}$\u4e2d\uff0c\u53ea\u6709$\\frac{1}{n}$\u7684\u65b9\u6848\u662f\u53ef\u884c\u7684\uff0c\u56e0\u6b64\u5f97\u51fa\u516c\u5f0f\uff1a\n\n$$ans = \\frac{C_{n\\times m}^{n-1}}{n}$$\n\n",
        "postTime": 1548922664,
        "uid": 84088,
        "name": "pufanyi",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2767 \u3010\u6811\u7684\u6570\u91cf\u3011"
    },
    {
        "content": "DP\n\n$f[i][j]$\u8868\u793a\u5f53\u524d\u5df2\u7ecf\u9009\u62e9i\u4e2a\u70b9\uff0c\u8fd9\u68f5\u6811\u7684\u6700\u6df1\u5c42\u6709j\u4e2a\u8282\u70b9\u7684\u65b9\u6848\u6570\n\n\u8f6c\u79fb\u679a\u4e3e\u4e0a\u4e00\u5c42\u7684\u8282\u70b9\u6570\n\n\u663e\u7136\u4e00\u4e2a\u8282\u70b9\u6700\u591a\u53ef\u4ee5\u6709m\u4e2a\u5b50\u8282\u70b9\n\n\u90a3\u4e48 $f[i][j]=\\sum_{k=j/m}^{min(i-j,n)}f[i-j][k]*C(k*m,j)$\n\n\u7b54\u6848\u5373\u4e3a$\\sum_{i=1}^{n}f[n][i]$\n\n\n```cpp\n#include <cstdio>\n#include <algorithm>\n#include <cmath>\n#include <cstring>\n#include <iostream>\n#include <ctime>\n#include <map>\n#include <queue>\n#include <cstdlib>\n#include <string>\n#include <climits>\n#include <set>\n#include <vector>\n#include <complex>\n#define int long long\nusing namespace std;\ninline int read(){\n\tint k=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){k=k*10+ch-'0';ch=getchar();}\n\treturn k*f;\n}\ninline void write(int x){\n\tif(x<0){putchar('-');x=-x;}if(x>9)write(x/10);\n\tputchar(x%10+'0');\n}\ninline void writeln(int x){\n\twrite(x);puts(\"\");\n}\nconst int MOD=10007,N=210;\nint n,m,f[N][N],ans=0;\nint c[200*N][210];\ninline int C(int x,int y){\n\treturn c[x][y];\n}\nsigned main()\n{\n\tn=read();m=read();\n\tc[0][0]=1;\n\tfor(int i=1;i<=n*m;i++){\n\t\tc[i][0]=1;\n\t\tfor(int j=1;j<=min(i,n);j++)c[i][j]=(c[i-1][j]+c[i-1][j-1])%MOD;\n\t}\n\tf[1][1]=1;int ans=0;\n\tfor(int i=2;i<=n;i++)\n\t\tfor(int j=1;j<min(i,n);j++){\n\t\t\tf[i][j]=0;\n\t\t\tfor(int k=j/m;k<=min(i-j,n);k++){\n\t\t\t\tf[i][j]=(f[i][j]+f[i-j][k]*C(k*m,j)%MOD)%MOD;\n\t\t\t}\n\t\t}\n\tfor(int j=1;j<=n;j++)ans=(ans+f[n][j])%MOD;\n\twriteln(ans);\n\treturn 0;\n}\n```",
        "postTime": 1543202464,
        "uid": 5716,
        "name": "jzqjzq",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P2767 \u3010\u6811\u7684\u6570\u91cf\u3011"
    },
    {
        "content": "### \u524d\u7f6e\u77e5\u8bc6\uff1a\n\u5173\u4e8e $ m $ \u53c9\u6811\u7684\u5b9a\u4e49\uff1a\n\u76f8\u6bd4\u4e8e\u719f\u6089\u7684\u4e8c\u53c9\u6811\uff0c  $ m $  \u53c9\u6811\u662f\u4e00\u4e2a\u610f\u601d\uff0c \u4e8c\u53c9\u6811\u662f\u4e00\u68f5\u4ee5\u6839\u8282\u70b9\u5f00\u59cb\uff0c\u6bcf\u4e2a\u8282\u70b9\u542b\u6709\u4e0d\u8d85\u8fc7  $ 2 $    (\u53ef\u4ee5\u662f $ 0 $  ,  $ 1 $  ,  $ 2 $  )  \u4e2a\u5b50\u8282\u70b9\u7684\u6811\u3002\u5c06\u8fd9\u4e2a\u5b9a\u4e49\u6269\u5c55\u5230  $ m $  \u53c9\u6811\uff0c\u4e00\u68f5\u4ee5\u6839\u8282\u70b9\u5f00\u59cb\uff0c \u6bcf\u4e2a\u8282\u70b9\u4e0d\u8d85\u8fc7 $ m $ \u4e2a\u5b50\u8282\u70b9\u7684\u6811\uff0c \u79f0\u4e3a  $ m $  \u53c9\u6811\n\n\n------------\n**\u5212\u91cd\u70b9**  \u5b50\u6811\u53ef\u4ee5\u4e3a\u7a7a\uff0c\u8fd9\u70b9\u5f88\u91cd\u8981\uff01\uff01\uff01\n\n\n------------\n\u5230\u8fd9\u91cc dp \u65b9\u7a0b\u5c31\u975e\u5e38\u597d\u60f3\u4e86\uff0c\u8be6\u89c1\u56fe\u793a\u5185\u5bb9  ~~\u4e0d\u60f3\u518d\u591a\u8bf4\u4e86~~\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/beztx55q.png)\n\n### \u6700\u540e dp \u4ee3\u7801:\n\n```cpp\nfor(int i=0;i<=m;i++)  f[0][i]=1,f[1][i]=1;//\u521d\u59cb\u5316\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=m;j++)\n\t\t{\n\t\t\tfor(int k=0;k<i;k++)\n\t\t\t{\n\t\t\t\tf[i][j]=(f[i][j]+f[k][m]*f[i-k][j-1]%10007)%10007;\n\t\t\t}\n\t\t}\n\t}\n```\n",
        "postTime": 1664371347,
        "uid": 295398,
        "name": "1105Lee",
        "ccfLevel": 0,
        "title": "\u7b80\u5355\u7684DP\u597d\u5427"
    },
    {
        "content": "\u600e\u4e48\u9898\u89e3\u533a\u90fd\u662f\u5404\u79cd\u9ad8\u7ea7\u505a\u6cd5\uff0c\u8fd9\u4e0d\u5c31\u4e00\u4e2a\u57fa\u7840 dp \u5417\uff08\n\n\u9996\u5148\u60f3\u5230\u7684\u72b6\u6001\u662f $f_{i, j}$ \u8868\u793a $i$ \u4e2a\u70b9 $j$ \u53c9\u6811\u6709\u591a\u5c11\u7684\u65b9\u6848\uff0c\u53ef\u662f\u8fd9\u6837\u4f3c\u4e4e\u6ca1\u6709\u529e\u6cd5\u8f6c\u79fb\uff0c\u56e0\u4e3a\u4e00\u4e2a\u53c9\u6570\u7684\u6570\u597d\u50cf\u548c\u5176\u5b83\u53c9\u6570\u7684\u6ca1\u6709\u4ec0\u4e48\u5173\u7cfb\u3002\u4e8e\u662f\u589e\u52a0\u4e00\u7ef4\uff0c $f_{i, j, k}$ \u8868\u793a $i$ \u4e2a\u70b9 $j$ \u53c9\u4e14\u6839\u8fde\u4e86 $k$ \u53c9\u7684\u65b9\u6848\u6570\uff0c\u8fd9\u6837\u53ea\u8981\u679a\u4e3e\u6839\u52a0\u8fdb\u53bb\u7684\u6700\u540e\u4e00\u53c9\u6709\u591a\u5c11\u4e2a\u5c31\u53ef\u4ee5\u8f6c\u79fb\u4e86\u3002\n\n\u5bb9\u6613\u53d1\u73b0\uff0c\u8fd9\u4e2a\u65f6\u5019 $j$ \u5df2\u7ecf\u6ca1\u6709\u4ec0\u4e48\u7528\u4e86\uff0c\u56e0\u4e3a\u5f53\u524d\u53c9\u53ef\u4ee5\u63a5 $0$\uff0c \u6240\u4ee5\u8fd9\u4e2a $k$ \u5b8c\u5168\u5305\u542b\u4e86 $j$ \u7684\u4f5c\u7528\uff0c\u90a3\u4e48\u5b9a\u4e49\u65b0\u72b6\u6001 $f_{i, j}$ \u8868\u793a $i$ \u4e2a\u70b9\u7684 $m$ \u53c9\u6811\u6839\u8282\u70b9\u8fde\u4e86 $j$ \u53c9\u7684\u65b9\u6848\u6570\u3002\n\n$$\nf_{i, j} = \\sum_{k=0}^{i-1} f_{i-k, j-1} \\times f_{k, m}\n$$\n\n\u6700\u540e\u8981\u6ce8\u610f\u521d\u59cb\u72b6\u6001 $f_{0, i} = f_{1, i} = 1$\uff0c\u6bd5\u7adf\u53ea\u6709\u4e00\u4e2a\u70b9\u548c\u6ca1\u6709\u70b9\u603b\u662f\u53ea\u6709\u4e00\u79cd\u65b9\u6cd5\u3002\u56e0\u4e3a\u8fd9\u4e2a\u95ee\u9898\u8c03\u4e86\u5f88\u4e45\u3002\n\n\u6838\u5fc3\u4ee3\u7801\u53ea\u6709\u4e94\u884c\u3002\n\n```cpp\n#include <cstdio>\nconst int N = 305, P = 10007;\nint n, m, f[N][N];\nint main() {\n\tscanf(\"%d%d\", &n, &m);\n\tfor (int i = 0; i <= m; i++) f[1][i] = f[0][i] = 1;\n\tfor (int i = 2; i <= n; i++) \n\t\tfor (int j = 1; j <= m; j++) \n\t\t\tfor (int k = 0; k < i; k++)\n\t\t\t\tf[i][j] = (f[i][j] + f[i-k][j-1] * f[k][m] % P) % P;\n\tprintf(\"%d\", f[n][m]);\n\treturn 0;\n}\n```",
        "postTime": 1626337427,
        "uid": 40318,
        "name": "Acfboy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2767 \u6811\u7684\u6570\u91cf"
    },
    {
        "content": "\u4e00\u9053\u7b80\u5355 GF \u9898\u3002\u663e\u7136\u4e00\u68f5\u65e0\u6807\u53f7\u6709\u6839\u6709\u5e8f $m$ \u53c9\u6811\u7531\u4e00\u4e2a\u6839\u8282\u70b9\u548c $m$ \u68f5\u5b50\u6811\u6784\u6210\uff0c\u6240\u4ee5\u8003\u8651\u89e3\u6790\u7ec4\u5408\uff0c\u8bbe $m$ \u53c9\u6811\u7684\u7ec4\u5408\u7c7b\u4e3a $\\mathcal{T}$\uff0c\u5219\u6709\uff1a\n\n$$\\mathcal{T}=\\mathcal{Z}\\times(\\mathcal{E}+\\mathcal{T})^m$$\n\n\u6ce8\u610f\uff0c\u4e3a\u4e86\u540e\u9762\u62c9\u683c\u6717\u65e5\u53cd\u6f14\u65b9\u4fbf\uff0c\u5c06\u5e38\u6570\u9879\u8bbe\u4e3a $0$\u3002\n\n\u5bf9\u5e94 OGF \u4e3a\uff1a\n\n$$T(z)=z(1+T(z))^m$$\n\n\u6211\u4eec\u8981\u6784\u9020\u4e00\u4e2a\u51fd\u6570 $G(z)$ \u4f7f\u5f97 $G(z)$ \u4e0e $T(z)$ \u4e92\u4e3a\u590d\u5408\u9006\uff0c\u5373\u6ee1\u8db3 $T(G(z))=G(T(z))=z$\u3002\n\n\u628a $T(z)$ \u7a0d\u5fae\u53d8\u6362\u4e00\u4e0b\u5f97\u5230\uff1a\n\n$$\\dfrac{T(z)}{(1+T(z))^m}=z$$\n\n\u90a3\u4e48\u6709\uff1a\n\n$$G(T(z))=z=\\dfrac{T(z)}{(1+T(z))^m}$$\n\n\u56e0\u6b64\u5f97\u5230 $G(z)$ \u7684\u5b9a\u4e49\uff1a\n\n$$G(z)=\\dfrac{z}{(1+z)^m}$$\n\n\u62c9\u683c\u6717\u65e5\u53cd\u6f14\u540e\u5f97\u5230\uff1a\n\n$$\n\\begin{aligned}\n[z^n]F(z)&=\\dfrac{1}{n}[z^{n-1}]\\left(\\dfrac{z}{G(z)}\\right)^n\\\\\n&=\\dfrac{1}{n}[z^{n-1}]\\left(\\dfrac{z}{\\frac{z}{(1+z)^m}}\\right)^n\\\\\n&=\\dfrac{1}{n}[z^{n-1}]\\left((1+z)^m\\right)^n\\\\\n&=\\dfrac{1}{n}[z^{n-1}](1+z)^{mn}\\\\\n&=\\dfrac{1}{n}[z^{n-1}]\\sum_{i \\ge 0}\\dbinom{mn}{i}z^i\\\\\n&=\\dfrac{1}{n}\\dbinom{mn}{n-1}\n\\end{aligned}\n$$\n\n\u7528 Lucas \u5b9a\u7406\u8ba1\u7b97\u5373\u53ef\u3002",
        "postTime": 1654600908,
        "uid": 370281,
        "name": "m256i",
        "ccfLevel": 0,
        "title": "[\u9898\u89e3]P2767 \u6811\u7684\u6570\u91cf"
    },
    {
        "content": "# Preface\n\n\u8fd9\u662f\u4e00\u9053 DP \u9898\u76ee\u3002\n\n# Solution\n\n\u5b9a\u4e49 $f_{i,j}$ \u8868\u793a\u6709 $i$ \u4e2a\u8282\u70b9\uff0c\u6839\u8282\u70b9\u62e5\u6709\u81f3\u591a $j$ \u53c9\u7684\u65b9\u6848\u6570\u91cf\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u8fd9\u4e48\u8003\u8651\uff0c\u5355\u72ec\u62ce\u51fa\u6765\u4e00\u4e2a\u5b50\u6811\uff0c\u5c06\u5176\u8d4b\u4e88\u5b83\u7684\u5927\u5c0f\uff0c\u5176\u5b83\u5b50\u6811\u4ee5\u53ca\u6839\u8282\u70b9\u53c8\u81ea\u6210\u4e00\u9897\u6811\u3002\n\n\u90a3\u4e48\u6613\u5f97\u65b9\u7a0b\uff1a$f_{i,j}\\gets \\sum_{k=0}^{i-1} f_{k,m}\\times f_{i-k,j-1}$\n\n\u7136\u540e\u95ee\u9898\u5c31\u89e3\u51b3\u4e86\u3002",
        "postTime": 1653054005,
        "uid": 364122,
        "name": "BigJoker",
        "ccfLevel": 6,
        "title": "P2767 \u6811\u7684\u6570\u91cf-\u9898\u89e3\u62a5\u544a"
    },
    {
        "content": "## \u601d\u8def\n\n\u8003\u8651 $dp_{i,j}$\uff0c\u8868\u793a\u76ee\u524d\u7528\u53bb $i$ \u4e2a\u8282\u70b9\uff0c\u6700\u4e0b\u9762\u4e00\u5c42\u6709 $j$ \u4e2a\u8282\u70b9\u7684\u65b9\u6848\u6570\u3002\n\n\u4ee4 $pre_{i,j}$ \u8868\u793a\u4e0a\u9762\u4e00\u5c42 $i$ \u4e2a\u8282\u70b9\uff0c\u8f6c\u79fb\u5230\u4e0b\u4e00\u5c42 $j$ \u4e2a\u8282\u70b9\u7684\u65b9\u6848\u6570\u3002\n\n\u6613\u77e5\uff1a$pre_{i,j}=\\sum_{k=0}^mpre_{i-1,j-k}\\times\\binom{m}{k}$\u3002\u5176\u4e2d $k$ \u8868\u793a\u8be5\u5b50\u6811\u7684\u8282\u70b9\u6570\u3002\u6574\u4e2a\u5f0f\u5b50\u7684\u610f\u601d\u5c31\u662f\u8003\u8651\u4e0a\u4e00\u6b21\u9009\u5230 $i-1$ \u53f7\u8282\u70b9\uff0c\u8fd9\u6b21\u591a\u52a0\u4e00\u4e2a\u8282\u70b9\u548c\u5176 $k$ \u4e2a\u513f\u5b50\uff0c\u5e76\u4ece\u4ed6\u603b\u5171\u53ef\u4ee5\u6709\u7684 $m$ \u53c9\u4e2d\u9009\u51fa $k$ \u4e2a\u4f4d\u7f6e\u653e\u7f6e\u8282\u70b9\u3002\n\n\u8003\u8651\u8f6c\u79fb\u65b9\u7a0b\uff0c\u76ee\u524d\u8fd9\u4e00\u5c42\u4e3a $j$ \u4e2a\u8282\u70b9\uff0c\u4e0b\u9762\u6784\u9020 $k$ \u4e2a\u8282\u70b9\uff1a$dp_{i+k,k}+=dp_{i,j}\\times pre_{j,k}$\u3002\u4e5f\u5c31\u662f\u8fd9\u4e00\u5c42 $j$ \u8282\u70b9\u4e0b\u4e00\u5c42 $k$ \u8282\u70b9\u8f6c\u6362\u7684\u65b9\u6848\u6570\u3002\n\n\u6700\u540e\u8ba1\u7b97 $\\sum_{i=1}^ndp_{n,i}$ \u5373\u53ef\uff0c\u590d\u6742\u5ea6 $\\Theta(n^3)$ \u5373\u53ef\u901a\u8fc7\u6b64\u9898\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint dp[128][128];\nint pre[128][128];\nint C[128][128];\nconst int mod=10007;\nsigned main(){\n\tint n,m;\n\tcin>>n>>m;\n\tpre[0][0]=1;\n\tfor(int i=0;i<=128;i++) C[i][0]=1;\n\tfor(int i=0;i<=128;i++) for(int j=1;j<=i;j++) C[i][j]=(C[i-1][j]+C[i-1][j-1])%mod;\n\tfor(int i=0;i<=n;i++){\n\t\tfor(int j=0;j<=n;j++){\n\t\t\tfor(int k=0;k+j<=n&&k<=m;k++){\n\t\t\t\tpre[i+1][k+j]=(pre[i+1][k+j]+pre[i][j]*C[m][k])%mod;\n\t\t\t}\n\t\t}\n\t}\n\tdp[1][1]=1;\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=1;j<=i;j++){\n\t\t\tfor(int k=1;k+i<=n;k++){\n\t\t\t\tdp[i+k][k]=(dp[i+k][k]+dp[i][j]*pre[j][k]%mod)%mod;\n\t\t\t}\n\t\t}\n\t}\n\tint sum=0;\n\tfor(int i=1;i<=n;i++){\n\t\tsum=(sum+dp[n][i])%mod;\n\t}\n\tcout<<sum;\n\treturn 0;\n}\n```\t",
        "postTime": 1648123569,
        "uid": 116664,
        "name": "Daniel_lele",
        "ccfLevel": 8,
        "title": "P2767 \u9898\u89e3"
    },
    {
        "content": "\u8fd9\u9053\u9898\u7b97\u662f\u4e00\u9053\u601d\u7ef4\u91cf\u7b97\u662f\u5f88\u5927\u7684\u9898\u76ee\u3002\n\n\u7b2c\u4e00\u53cd\u5e94\u6570\u6570\u9898\uff0c\u53d1\u73b0\u600e\u4e48\u4e5f\u63a8\u4e0d\u51fa\u6765\u67ff\u5b50\u3002\n\n\u7a81\u7136\u60f3\u8d77\u6709\u4e00\u4e9b\u6570\u6570\u9898\u53ef\u4ee5\u7528 dp \u505a\u3002\n\n\u4e8e\u662f\u5f80 dp \u4e0a\u60f3\u3002\n\n\u6709\u4e00\u4e2a\u663e\u7136\u7684\u72b6\u6001\n\n$f_{i,j,k}$ \u8868\u793a $i$ \u4e2a\u70b9 $j$  \u53c9\u4e14\u6839\u8fde\u4e86 $k$ \u53c9\u7684\u6709\u591a\u5c11\u79cd\u65b9\u6848\u3002\u4f46\u662f\u8fd9\u4e2a\u65b9\u6848\u4ed4\u7ec6\u60f3\u60f3\u4e0d\u662f\u5f88\u597d\u8f6c\u79fb\uff0c\u56e0\u4e3a\u6709\u4e00\u4e2a\u51e0\u4e4e\u534a\u8d39\u7684\u72b6\u6001 $j$ \uff0c\u8fd9\u4e2a $j$ \u662f\u53ef\u4ee5\u88ab $k$\u5b8c\u5168\u8986\u76d6\u6389\u7684\u3002\n\n\u90a3\u4e48\u6211\u4eec\u8003\u8651\u4f18\u5316\u4e00\u4e0b\u8fd9\u4e2a\u72b6\u6001\u3002\n\n$f_{i,j}$ \u793a $i$ \u4e2a\u70b9\u7684 $m$ \u53c9\u6811\u6839\u8282\u70b9\u8fde\u4e86 $j$ \u53c9\u6709\u591a\u5c11\u79cd\u65b9\u6848\u3002\n\n\u6700\u540e\u4e3a\u4ec0\u4e48\u5c31\u51b3\u5b9a\u662f\u8fd9\u4e2a\u65b9\u6848\u5462\uff1f\u56e0\u4e3a\u8fd9\u4e2a\u72b6\u6001\u5f88\u7b80\u6d01\uff0c\u6ca1\u6709\u4ec0\u4e48\u5e9f\u8bdd\uff0c\u540c\u65f6\u4e5f\u53ef\u4ee5\u5f88\u8be6\u7ec6\u7684\u8868\u793a\u51fa\u6240\u6709\u4fe1\u606f\u3002\u56e0\u6b64\u8fd9\u4e2a\u72b6\u6001\u662f\u5f88\u6709\u53ef\u80fd\u6210\u529f\u7684\u3002\n\n\u6709\u4e86\u72b6\u6001\u4e4b\u540e\uff0c\u6211\u4eec\u8003\u8651\u8fd9\u4e2a\u8f6c\u79fb\u65b9\u7a0b\u3002\n\n\u6211\u4eec\u679a\u4e3e\u4e00\u4e2a $k$ \u8ba9\u540e\u4ece\u5bf9 $f_{i-k,j-1} \\times f_{k,m}$ \u6c42\u548c\u6765\u66f4\u65b0 $f_{i,j}$ \u3002\n\n\u590d\u6742\u5ea6 $O(n^3)$ \u5728 $n\\le 127$ \u7684\u6761\u4ef6\u4e0b\u53ef\u8fc7.\n\n\u4ee3\u7801\u5c31\u4e0d\u7ed9\u4e86\uff0c\u611f\u89c9\u5f88\u597d\u5199\u3002\n\n",
        "postTime": 1633778985,
        "uid": 369904,
        "name": "zplqwq",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2767 \u6811\u7684\u6570\u91cf"
    },
    {
        "content": "## \u9898\u610f\n\u6709 $n$ \u4e2a\u4e0d\u540c\u8282\u70b9\uff0c\u8bf7\u95ee\u80fd\u7ec4\u6210\u591a\u5c11\u79cd $m$ \u53c9\u6811\u7ed3\u6784\u3002\n## \u9898\u89e3\n\u76f4\u63a5\u4e0a\u7ec4\u5408\uff1a\n$$\\mathcal T=\\mathrm{root}\\times \\mathrm{SEQ}_ {m}(\\mathrm{emptytree}\\cup\\mathcal T)$$\n\u7136\u540e\u5c31\u662f\u559c\u95fb\u4e50\u89c1\u7684 $\\mathbf{GF}$\uff1a\n$$t(z)=z(1+t(z))^m$$\n\u7136\u540e\u5c31\u4e0d\u4f1a\u4e86\uff0c\u600e\u4e48\u529e\u529e\u5462\uff1f\n\n\u8fd9\u4e2a\u5176\u5b9e\u5df2\u7ecf\u53ef\u4ee5\u505a\u4e86\u3002\u6839\u636e $\\text{\u300aAnalytic Combinatorics\u300b}$ \u7684\u8bf4\u6cd5\uff0c\u8fd9\u4e2a\u7ea6\u675f\u662f\u9012\u5f52\u7684\uff0c\u53ea\u8981\u628a $t(z)=1$ \u5e26\u8fdb\u53bb\u4e0d\u505c\u8fed\u4ee3\u5373\u53ef\uff0c\u6709\u65f6\u95f4\u4f1a\u5199\u3002\n\n\u5e94\u8be5\u8981\u8fed\u4ee3 $n$ \u6b21\uff0c\u6bcf\u6b21\u66b4\u529b\u5377\u79ef $O(n^2)$\uff0c$m$ \u6b21\u5feb\u901f\u5e42\u505a\u5230 $O(n^2\\log m)$\u8fd9\u4e2a $O(n^3\\log m)$ \u7684\u7b97\u6cd5\u770b\u4e0a\u53bb\u662f\u53ef\u4ee5\u8fc7\u7684\uff0c\u800c\u4e14\u66b4\u529b\u5377\u79ef\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u5e38\u6570\u4f18\u5316\u3002\u4e0d\u8fc7\u8fd9\u4e2a $3$ \u6b21\u65b9\u7684\u89e3\u6cd5\u4ecd\u7136\u4e0d\u662f\u6211\u4eec\u60f3\u8981\u7684\u3002\n\n\u8003\u8651\u4e00\u4e0b\u725b\u987f\u8fed\u4ee3\uff1a\n$$G(t(z))=z(1+t(z))^m-t(z)=0$$\n\u5047\u5982\u6211\u4eec\u77e5\u9053 $t_0$ \u6ee1\u8db3 $G(t_0(z))\\equiv 0\\pmod {x^n}$\uff0c\u90a3\u4e48\u8fed\u4ee3\u5230 $t(z)$\uff1a\n$$\nt(z)\\equiv t_0(z)-\\frac{G(t_0(z))}{G^\\prime (t_0(z))} \\pmod {x^{2n}}\n$$\n\u7136\u540e\u5c31\u4e0d\u662f\u5f88\u597d\u5316\u4e86\uff0c\u8003\u8651\u8bb0 $f(z)=t(z)+1$\uff0c\u4e8b\u60c5\u5c31\u4f1a\u660e\u6717\u5f88\u591a,\u91cd\u65b0\u8bbe\uff1a\n$$G(f(z))=z f^m(z)-f(z)+1=0$$\n\u8fd9\u4e2a\u4e1c\u897f\u725b\u8fed\u5c31\u5f88\u7b80\u5355\u4e86\u3002\n\n$$f(z)=f_0(z)-\\frac{zf_0^m(z)-f_0(z)+1}{zm f_0^{m-1}(z)-1}$$\n\n\u73b0\u5728\u7684\u590d\u6742\u5ea6\u662f $\\sum_{i=0}^{\\log n}(2^i)^2\\log m+(2^i)^2$\uff0c\u611f\u89c9\u5e94\u8be5\u662f $O(n^2 \\log n)$ \u7684\uff08\u9ed8\u8ba4 $n,m$ \u540c\u9636\uff09\u3002\n\n\u8fd9\u6837\u5199\u5e94\u8be5\u6ca1\u6709\u4efb\u4f55\u95ee\u9898\u3002\n\n\u4f46\u8fd8\u662f\u4e0d\u591f\u7ed9\u529b\u5440\uff01\uff01\uff01\n\n\u8fd9\u4e2a\u65b9\u7a0b\u975e\u5e38\u4e0d\u79d1\u5b66\uff0c\u5e76\u6ca1\u6709\u4ee3\u6570\u89e3\uff0c\u81f3\u5c11 $\\rm Mathematica$ \u89e3\u4e0d\u51fa\u6765![jk](https://cdn.luogu.com.cn/upload/pic/62234.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ccgak8zk.png)\n\n\u4e8e\u662f\u5c31\u53ea\u80fd\u53bb\u770b\u9898\u89e3\uff0c\u7136\u540e\u5c31\u770b\u5230\u795e $\\rm E\\color{red}legia$ \u7684\u9898\u89e3\uff0c\u5728\u8fd9\u4e00\u6b65\u76f4\u63a5\u4e0a\u62c9\u53cd\u3002\n\n$$\\frac{t(z)}{(1+t(z))^m}=z\\quad\\frac{w}{(1+w)^m}=g(w)\\Longrightarrow t\\circ g=\\epsilon$$\n\n$g(t(z))=\\frac{t(z)}{(1+t(z))^m}=z$\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u6f14\u4e86\u3002\n$$[z^n]t(z)=\\frac1n[w^{n-1}]\\left(\\frac{w}{g(w)}\\right)^n$$\n\u7136\u540e\u5c31\u76f4\u63a5 \n$$\\frac{\\binom{nm}{n-1}}n$$\n\n\u6a21\u6570\u8fd9\u4e48\u5c0f\u611f\u89c9\u4f1a\u51fa\u95ee\u9898\uff0c\u7ed3\u679c\u4e00\u53d1\u8fc7\u4e86![yiw](https://cdn.luogu.com.cn/upload/pic/62243.png)\n\n\u9274\u4e8e\u8fd9\u4e2a\u4ee3\u7801\u4f1a\u51fa\u95ee\u9898\uff0c\u56e0\u6b64\u7ed9\u4e2a [\u9519\u8bef\u94fe\u63a5](https://www.luogu.com.cn/paste/we1zryg4)\uff0c\u5e0c\u671b\u5927\u5bb6\u4e0d\u8981\u91cd\u8e48\u8fd9\u4e2a\u5c51\u7684\u8986\u8f99\uff0c\u4ee5\u81f3\u4e8e\u88ab $\\rm x\\color{red}zggzh$ $\\mathcal D$ \u7206\u3002\n\n\u6b63\u7ecf\u5199\u6cd5\u5e94\u8be5\u662f\u7528 $\\rm lucas$\n## \u4ee3\u7801\n\u53c8\u81ed\u53c8\u957f\u7684\u725b\u987f\u8fed\u4ee3\u3002\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntemplate<const int mod>\nstruct modint{\n    int x;\n    modint<mod>(int o=0){x=o%mod;(x<0)&&(x+=mod);}\n    modint<mod> &operator = (int o){return x=o%mod,(x<0)&&(x+=mod),*this;}\n    modint<mod> &operator +=(modint<mod> o){return x=x+o.x>=mod?x+o.x-mod:x+o.x,*this;}\n    modint<mod> &operator -=(modint<mod> o){return x=x-o.x<0?x-o.x+mod:x-o.x,*this;}\n    modint<mod> &operator *=(modint<mod> o){return x=1ll*x*o.x%mod,*this;}\n    modint<mod> &operator ^=(int b){\n        modint<mod> a=*this,c=1;\n        for(;b;b>>=1,a*=a)if(b&1)c*=a;\n        return x=c.x,*this;\n    }\n    modint<mod> &operator /=(modint<mod> o){return *this *=o^=mod-2;}\n    modint<mod> &operator +=(int o){return x=x+o>=mod?x+o-mod:x+o,*this;}\n    modint<mod> &operator -=(int o){return x=x-o<0?x-o+mod:x-o,*this;}\n    modint<mod> &operator *=(int o){return x=1ll*x*o%mod,*this;}\n    modint<mod> &operator /=(int o){return *this *= ((modint<mod>(o))^=mod-2);}\n    template<class I>friend modint<mod> operator +(modint<mod> a,I b){return a+=b;}\n    template<class I>friend modint<mod> operator -(modint<mod> a,I b){return a-=b;}\n    template<class I>friend modint<mod> operator *(modint<mod> a,I b){return a*=b;}\n    template<class I>friend modint<mod> operator /(modint<mod> a,I b){return a/=b;}\n    friend modint<mod> operator ^(modint<mod> a,int b){return a^=b;}\n    friend bool operator ==(modint<mod> a,int b){return a.x==b;}\n    friend bool operator !=(modint<mod> a,int b){return a.x!=b;}\n    bool operator ! () {return !x;}\n    modint<mod> operator - () {return x?mod-x:0;}\n    modint<mod> &operator++(int){return *this+=1;}\n};\ntypedef modint<10007> mint;\nconst int N=256;\nint up;\nstruct poly{\n\tmint a[N];\n\tmint&operator[](int x){return a[x];}\n\tvoid init(){memset(a,0,sizeof a);}\n\tvoid cpy(poly&b){memcpy(a,b.a,sizeof a);}\n}tmp,tmp1,tmp2;\nvoid mul(poly&c,poly&a,poly&b){\n\tc.init();\n\tfor(int i=0;i<up;i++)\n\t\tfor(int j=0;j<up;j++)\n\t\t\tif(i+j<up)c[i+j]+=a[i]*b[j];\n}\nvoid inv(poly&a,poly&b){\n\tb[0]=1/a[0];\n\tfor(int i=1;i<up;i++){\n\t\tb[i]=0;\n\t\tfor(int j=0;j<i;j++)b[i]-=b[j]*a[i-j];\n\t\tb[i]/=a[0];\n\t}\n}\nvoid pow(poly&res,poly a,int b){\n\tstatic poly tmp;\n\tres.init();res[0]=1;\n\twhile(b){\n\t\tif(b&1)mul(tmp,res,a),res.cpy(tmp);\n\t\tmul(tmp,a,a),a.cpy(tmp);b>>=1;\n\t}\n}\nvoid mulx(poly&a){\n\tfor(int i=up-1;i;i--)\n\t\ta[i]=a[i-1];\n\ta[0]=0;\n}\nint n,m;\npoly f[2];\nsigned main(){\n\tcin>>n>>m;\n\tint now=0,lst=1;\n\tfor(int i=0;(1<<i-1)<=n;i++){\n\t\tswap(now,lst);\n\t\tf[now].init();\n\t\tint n=1<<i;up=n;\n\t\tif(i==0){\n\t\t\tf[now][0]=1;\n\t\t}else{\n\t\t\tpow(tmp,f[lst],m);\n\t\t\tmulx(tmp);\n\t\t\tfor(int i=0;i<n;i++)\n\t\t\t\ttmp[i]-=f[lst][i];\n\t\t\ttmp[0]+=1;\n\t\t\t\n\t\t\tpow(tmp1,f[lst],m-1);\n\t\t\tmulx(tmp1);\n\t\t\tfor(int i=0;i<n;i++)\n\t\t\t\ttmp1[i]*=m;\n\t\t\ttmp1[0]-=1;\n\t\t\tinv(tmp1,tmp2);\n\t\t\t\n\t\t\tmul(tmp1,tmp,tmp2);\n\t\t\t\n\t\t\tfor(int i=0;i<n;i++)\n\t\t\t\tf[now][i]=f[lst][i]-tmp1[i];\n\t\t}\n\t\t//for(int i=0;i<n;i++)\n\t\t//\tprintf(\"%d \",f[now][i]);\n\t\t//puts(\"\");\n\t}\n\tcout<<f[now][n].x;\n    return 0;\n}\n```\n\u4ee5\u53ca\u725b\u903c\u7684\u65b9\u6cd5\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntemplate<const int mod>\nstruct modint{\n    int x;\n    modint<mod>(int o=0){x=o%mod;}\n    modint<mod> &operator = (int o){return x=o,*this;}\n    modint<mod> &operator +=(modint<mod> o){return x=x+o.x>=mod?x+o.x-mod:x+o.x,*this;}\n    modint<mod> &operator -=(modint<mod> o){return x=x-o.x<0?x-o.x+mod:x-o.x,*this;}\n    modint<mod> &operator *=(modint<mod> o){return x=1ll*x*o.x%mod,*this;}\n    modint<mod> &operator ^=(int b){\n        modint<mod> a=*this,c=1;\n        for(;b;b>>=1,a*=a)if(b&1)c*=a;\n        return x=c.x,*this;\n    }\n    modint<mod> &operator /=(modint<mod> o){return *this *=o^=mod-2;}\n    modint<mod> &operator +=(int o){return x=x+o>=mod?x+o-mod:x+o,*this;}\n    modint<mod> &operator -=(int o){return x=x-o<0?x-o+mod:x-o,*this;}\n    modint<mod> &operator *=(int o){return x=1ll*x*o%mod,*this;}\n    modint<mod> &operator /=(int o){return *this *= ((modint<mod>(o))^=mod-2);}\n    template<class I>friend modint<mod> operator +(modint<mod> a,I b){return a+=b;}\n    template<class I>friend modint<mod> operator -(modint<mod> a,I b){return a-=b;}\n    template<class I>friend modint<mod> operator *(modint<mod> a,I b){return a*=b;}\n    template<class I>friend modint<mod> operator /(modint<mod> a,I b){return a/=b;}\n    friend modint<mod> operator ^(modint<mod> a,int b){return a^=b;}\n    friend bool operator ==(modint<mod> a,int b){return a.x==b;}\n    friend bool operator !=(modint<mod> a,int b){return a.x!=b;}\n    bool operator ! () {return !x;}\n    modint<mod> operator - () {return x?mod-x:0;}\n    modint<mod> &operator++(int){return *this+=1;}\n};\nconst int mod=10007;\ntypedef modint<mod> mint;\nint n,m;\nmint fac[mod];\nmint C(int n,int m){\n\tif(n<m){\n\t\treturn 0;\n\t}\n\treturn fac[n]/fac[m]/fac[n-m];\n}\nmint lucas(int n,int m){\n\tif(m>n)return 0;\n\tif(m==0)return 1;\n\treturn C(n%mod,m%mod)*lucas(n/mod,m/mod);\n}\nsigned main(){\n\tfac[0]=1;for(int i=1;i<mod;i++)fac[i]=fac[i-1]*i;\n\tcin>>n>>m;\n\tcout<<(lucas(n*m,n-1)/n).x;\n\treturn 0;\n}\n```",
        "postTime": 1619361383,
        "uid": 174304,
        "name": "jun\u5934\u5409\u5409",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P2767 \u3010\u6811\u7684\u6570\u91cf\u3011"
    },
    {
        "content": "$O(  N^4  )$ \u7684DP\n\n\u51e0\u7bc7\u9898\u89e3\u601d\u8def\u8bb2\u5f97\u5f88\u6e05\u695a\u4e86\uff0c~~\u4f46\u662f\u6ca1\u4eba\u8d34\u4ee3\u7801~~\n\n~~\u6240\u4ee5\u6211\u6765\u7ed9\u4e2a\u4ee3\u7801~~\n\n\u8fd9\u79cd\u66b4\u529b\u591a\u4e00\u7ef4\u6765\u5904\u7406\u672a\u505a\u90e8\u5206\u7684\u601d\u60f3\u8fd8\u662f\u503c\u5f97\u5b66\u4e60\u7684\n\n```cpp\n#include<bits/stdc++.h>\n\nusing namespace std;\n\n#define N 135\n\nint n, m, dp[N], f[N][N];\n\nint main()\n{\n    scanf(\"%d%d\", &n, &m);\n    for(int i = 1; i <= n; i++)\n    {\n        memset(f, 0, sizeof(f));\n        f[0][1] = 1, dp[0] = 1;\n        for(int j = 1; j <= m; j++)\n        {\n            for(int k = 1; k <= i; k++)\n            {\t\n                for(int l = 0; l < k; l++)\n                {\n                    f[j][k] += (dp[l] * f[j - 1][k - l]) % 10007;\n                    f[j][k] %= 10007;\n                }\n            }\n        }\n        dp[i] = f[m][i];\n    }\n    cout << dp[n] << endl;\n    return 0;\n}\n```",
        "postTime": 1562657597,
        "uid": 54544,
        "name": "LJB00131",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2767 \u3010\u6811\u7684\u6570\u91cf\u3011"
    },
    {
        "content": "# P2767 \u6811\u7684\u6570\u91cf\n\n- - **73**\u901a\u8fc7\n  - **169**\u63d0\u4ea4\n- **\u96be\u5ea6****\u7701\u9009/NOI-**\n- **\u65f6\u7a7a\u9650\u5236**1000ms / 128MB\n\n## \u9898\u76ee\u63cf\u8ff0\n\n\u6709$n$\u4e2a\u4e0d\u540c\u8282\u70b9\uff0c\u8bf7\u95ee\u80fd\u7ec4\u6210\u591a\u5c11\u79cd$m$\u53c9\u6811\u7ed3\u6784\u3002\n\n\uff08\u6ce8\u610f\uff1a1\u3001\u8282\u70b9\u7684\u4e24\u4e2a\u5b50\u6811\u4ea4\u6362\u4e86\uff0c\u5c31\u4e0d\u7b97\u4e00\u79cdm\u53c9\u6811\n\n2\u3001\u4efb\u610f\u5b50\u6811\u53ef\u4ee5\u4e3a\u7a7a\n\n3\u3001\u4e0d\u8981\u5f53\u56fe\u8003\u8651\uff0c\u540c\u4e00\u79cd\u6811\u4e00\u5b9a\u662f\u6839\u8282\u70b9\u4e00\u6837\uff0c\u7136\u540e\u4e0b\u9762\u7684\u5b50\u6811\u4e5f\u4e00\u6837\n\n4.\u4ea4\u6362\u4e24\u8282\u70b9\u540e\u7b97\u4e00\u79cd\uff09\n\n## \u8f93\u5165\u8f93\u51fa\u683c\u5f0f\n\n### \u8f93\u5165\u683c\u5f0f\uff1a\n\n\u8f93\u5165\u5360\u4e00\u884c\uff0c\u8f93\u5165$n, m(n, m\u2264127)$\u3002\n\n### \u8f93\u51fa\u683c\u5f0f\uff1a\n\n\u5360\u4e00\u884c\uff0c\u5c31\u662f$\\text{\u79cd\u7c7b\u7684\u4e2a\u6570}(\\bmod 10007)$\n\n## \u8f93\u5165\u8f93\u51fa\u6837\u4f8b\n\n### \u8f93\u5165\u6837\u4f8b#1\uff1a\n\n```\n2 2\n```\n\n### \u8f93\u51fa\u6837\u4f8b#1\uff1a\n\n```\n2\n```\n\n# \u5206\u6790\n\n## $DP$\n\n$DP$\u80af\u5b9a\u662f\u53ef\u4ee5\u505a\u7684\u3002\n\n\u8003\u8651\u8bbe$dp$\u8868\u793a\u6839\u8282\u70b9\u6709$j$\u4e2a\u513f\u5b50\uff0c\u5b50\u6811\u5927\u5c0f\u4e3a$k$\u7684\u65b9\u6848\u6570\u3002\u6613\u5f97$dp[j][k] = \\sum_{l = 0}^{k - 1}dp[m][l]\\times dp[j-1][k-l]$\uff0c\u4e5f\u5c31\u662f\u8bf4\u5728\u4e00\u68f5\u6811\u7684\u6839\u8282\u70b9\u4e0a\u63a5\u4e0a\u4e00\u68f5$m$\u53c9\u6811\u3002\n\n\u7136\u540e\u53d1\u73b0\u7206\u4e86\u3002\n\n\u539f\u56e0\u663e\u7136\uff1a\u5177\u6709\u540e\u6548\u6027\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u5347\u7ef4, \u7528$f_i$\u8868\u793a$i$\u4e2a\u8282\u70b9\u7684\u65b9\u6848\u6570\uff0c \u7136\u540e\u6bcf\u6b21\u505a\u5b8c\u4e4b\u540e$f_i=  dp[j][k]$\u3002$\\Omicron(n^4)$\n\n\u8fd9\u6837\u53ef\u4ee5\u8fc7\u3002\n\n\u4f46\u662f\u6211\u4eec\u4e5f\u53ef\u4ee5\u6a21\u4eff$catalan\u6570$ \u9012\u63a8\uff0c\u4e5f\u53ef\u4ee5$\\Omicron(n^3)$\n\n## ?\n\n\u6211\u4eec\u60f3\u5230$catalan\u6570$\u7684\u516c\u5f0f\n\n\u7136\u540e~~\u76f2\u731c~~\u51fa\u516c\u5f0f : \n\n$$\\Large\\frac{n-1\\choose n\\cdot m}{n}$$\n\n\u4f46\u662f\uff0c\u4e3a\u4ec0\u4e48\u5462\uff1f\n\n![VUlFIS.png](https://s2.ax1x.com/2019/06/05/VUlFIS.png)\n\n**\u6211\u4e0d\u4f1a**\n\n## \u4e71\u641e\n\n\u56e0\u4e3a\u9898\u4e2d\u662f$m$\u53c9\u6811\uff0c\u6240\u4ee5\u8fde\u63a5\u513f\u5b50\u7684\u8fb9\u7684\u9009\u62e9\u4f1a\u5f71\u54cd\u65b9\u6848\u6570\uff0c\u56e0\u6b64\u5e8f\u5217\u4e2d\u6bcf\u4e2a\u6570\u7684\u5927\u5c0f\u4e0d\u8d85\u8fc7$m$\uff0c\u603b\u5171\u6709$n\\times m$\u6761\u8fb9$(\u53ef\u4ee5\u4e3a\u7a7a)$\uff0c\u4ece\u4e2d\u9009\u51fa$n-1$\u6761\u3002\n\n\u7136\u800c\uff0c\u8fd9\u4e9b\u65b9\u6848\u4e2d\u53ea\u6709$\\frac1n$\u662f\u53ef\u4ee5\u7684\u3002\n\n\u4e3a\u4ec0\u4e48\u5462\uff1f\n\n\u8003\u8651\u6211\u4eec\u5728\u8fd9$n$\u4e2a\u70b9\u4e2d\u6309$dfs$\u987a\u5e8f\u9009\u513f\u5b50\n\n\u663e\u7136\u6211\u4eec\u4e0d\u53ef\u4ee5\u9009\u5df2\u7ecf\u9009\u8fc7\u7684\u8282\u70b9\uff0c\u6240\u4ee5\u4e00\u4e2a\u65b9\u6848\u6210\u7acb\u7684\u6982\u7387\u662f\n\n$$\\Large\\prod_{i = 1}^{n - 1}\\frac{i }{i + 1} = \\frac1n$$\n\n\n\n",
        "postTime": 1559728968,
        "uid": 34511,
        "name": "\u849f\u84bbwyx",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2767 \u3010\u6811\u7684\u6570\u91cf\u3011"
    }
]
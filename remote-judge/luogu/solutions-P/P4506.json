[
    {
        "content": "```\n\u5047\u8bbe\u5206\u89e3\u4e3a\u220f(pix+qi)\uff0c\u90a3\u4e48\u5c31\u6709\u220fpi=An\uff0c\u220fqi=A0\u3002\u7531\u4e8e\u6709pi<=1000000\uff0cqi<=1000000\uff0c\u6211\u4eec\u679a\u4e3eAn\u548cA0\u7684\u7ea6\u6570\u7136\u540e\u66b4\u529b\u679a\u4e3e\u5224\u65ad\u3002\u3002\u3002\n\n\u00a0 \u00a0 \u00a0 \u00a0\u81f3\u4e8e\u4e8e\u662f\u5224\u65ad\uff0c\u53ef\u4ee5\u8003\u8651\u5728\u6a21\u610f\u4e49\u4e0b\u5224\u65ad\uff0c\u900970\u4e2a\u5927\u8d28\u6570\u5206\u522b\u5224\u65ad\u5373\u53ef\u3002\u3002\u3002\n\n\u00a0 \u00a0 \u00a0 \u00a0\u5269\u4e0b\u7684\u5c31\u662f\u7801\u7801\u7801\u4e86\u3002\u3002\n\nAC\u4ee3\u7801\u5982\u4e0b\uff1a\n\n\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define ll long long\nusing namespace std;\n \nconst int prm[70]={543892411,567498259,643448581,772660877,802279559,823153213,847485637,907170331,919507003,923425961,929812711,935151689,938910911,962946403,970870897,977946113,985116131,989743967,991308817,994793521,995403061,997310857,998623607,999049111,999860857,1000885111,1002002609,1002270383,1002326077,1002351107,1002642457,1002681557,1003013519,1004475841,1005879367,1006478441,1007120461,1007468677,1007576071,1008054149,1008640013,1008894637,1009316083,1009528721,1009862393,1010510329,1010915173,1011460739,1012072651,1012612079,1012668131,1012825181,1014091867,1014515053,1014904973,1015114333,1015944323,1016003431,1016121461,1017088367,1017307463,1017423811,1017620873,1018394743,1018932493,1019199101,1019208581,1019319187,1019376101,1019831203};\nint n,m,cnt,tot1,tot2,b[70][85],p[100005],q[100005];\nchar s0[30005],s1[30005];\nstruct node{ int x,y,z; }ans[85];\nbool cmp(const node &u,const node &v){\n\treturn (ll)u.x*v.y>(ll)u.y*v.x;\n}\nstruct hugnum{\n\tint len,sgn,num[40];\n\tvoid ins(int tot,int fu){\n\t\tint i,j; sgn=fu;\n\t\tfor (i=tot; i>0; i-=9){\n\t\t\tlen++;\n\t\t\tfor (j=max(1,i-8); j<=i; j++) num[len]=num[len]*10+s1[j]-'0';\n\t\t}\n\t}\n\tint getmod(int x){\n\t\tint i,t=0;\n\t\tfor (i=len; i; i--)\n\t\t\tt=((ll)t*1000000000+num[i])%x;\n\t\treturn t;\n\t}\n}a[85];\nvoid get_in(){\n\tscanf(\"%s\",s0+1);\n\tint i=1,len=strlen(s0+1);\n\twhile (i<=len){\n\t\tint tot=0,fu=1,dgr=0;\n\t\tif (s0[i]=='-') fu=-1;\n\t\tif (s0[i]=='+' || s0[i]=='-') i++;\n\t\tif (s0[i]=='x'){\n\t\t\ts1[tot=1]='1'; i++;\n\t\t\tif (s0[i]=='^'){\n\t\t\t\tfor (i++; s0[i]>='0' && s0[i]<='9'; i++)\n\t\t\t\t\tdgr=dgr*10+s0[i]-'0';\n\t\t\t\ta[dgr].ins(tot,fu);\n\t\t\t\tif (!n) n=dgr;\n\t\t\t} else a[1].ins(tot,fu);\n\t\t} else{\n\t\t\tfor (; s0[i]>='0' && s0[i]<='9'; i++) s1[++tot]=s0[i];\n\t\t\tif (!s0[i]) a[0].ins(tot,fu); else{\n\t\t\t\ti++;\n\t\t\t\tif (s0[i]=='^'){\n\t\t\t\t\tfor (i++; s0[i]>='0' && s0[i]<='9'; i++)\n\t\t\t\t\t\tdgr=dgr*10+s0[i]-'0';\n\t\t\t\t\ta[dgr].ins(tot,fu);\n\t\t\t\t\tif (!n) n=dgr;\n\t\t\t\t} else a[1].ins(tot,fu);\n\t\t\t}\n\t\t}\n\t}\n\tif (a[n].sgn<0) putchar('-');\n\tif (a[n].len>1 || a[n].num[1]>1){\n\t\tprintf(\"%d\",a[n].num[a[n].len]);\n\t\tfor (i=a[n].len-1; i; i--) printf(\"%09d\",a[n].num[i]);\n\t}\n}\nvoid put_out(){\n\tsort(ans+1,ans+cnt+1,cmp); int i;\n\tfor (i=1; i<=cnt; i++){\n\t\tif (!ans[i].x) putchar('x'); else\n\t\t\tif (ans[i].y==1)\n\t\t\t\tif (ans[i].x<0) printf(\"(x+%d)\",-ans[i].x);\n\t\t\t\telse printf(\"(x%d)\",-ans[i].x);\n\t\t\telse\n\t\t\t\tif (ans[i].x<0) printf(\"(x+%d/%d)\",-ans[i].x,ans[i].y);\n\t\t\t\telse printf(\"(x%d/%d)\",-ans[i].x,ans[i].y);\n\t\tif (ans[i].z>1) printf(\"^%d\",ans[i].z);\n\t}\n\tputs(\"\");\n}\nint ksm(int x,int y,int mod){\n\tint t=1; for (; y; y>>=1,x=(ll)x*x%mod) if (y&1) t=(ll)t*x%mod;\n\treturn t;\n}\nint gcd(int x,int y){ return (y)?gcd(y,x%y):x; }\nbool ok(int x,int y){\n\tint i,j,t,mod,tmp;\n\tfor (i=0; i<70; i++){\n\t\tmod=prm[i]; t=(x+mod)%mod;\n\t\tt=(ll)t*ksm(y,mod-2,mod)%mod;\n\t\tfor (j=n,tmp=0; j>=0; j--)\n\t\t\ttmp=((ll)tmp*t+b[i][j])%mod;\n\t\tif (tmp) return 0;\n\t}\n\treturn 1;\n}\nvoid divide(int x,int y){\n\tint i,j,t,mod;\n\tfor (i=0; i<70; i++){\n\t\tmod=prm[i]; t=(x+mod)%mod;\n\t\tt=(ll)t*ksm(y,mod-2,mod)%mod;\n\t\tfor (j=n; j>=0; j--)\n\t\t\tb[i][j]=((ll)b[i][j+1]*t+b[i][j])%mod;\n\t}\n}\nint main(){\n\tget_in();\n\tint i=0,j,k; while (!a[i].len) i++;\n\tif (i>0) ans[++cnt]=(node){0,1,i};\n\tfor (j=i; j<=n; j++) a[j-i]=a[j];\n\tn-=i;\n\tfor (i=0; i<70; i++)\n\t\tfor (j=0; j<=n; j++) b[i][j]=(a[j].getmod(prm[i])*a[j].sgn+prm[i])%prm[i];\n\tfor (i=1; i<=1000000; i++){\n\t\tif (!a[0].getmod(i)) p[++tot1]=i;\n\t\tif (!a[n].getmod(i)) q[++tot2]=i;\n\t}\n\tfor (i=1; i<=tot1; i++)\n\t\tfor (j=1; j<=tot2; j++) if (gcd(p[i],q[j])==1){\n\t\t\tfor (k=0; ok(p[i],q[j]); k++)\n\t\t\t\tdivide(p[i],q[j]);\n\t\t\tif (k) ans[++cnt]=(node){p[i],q[j],k};\n\t\t\tfor (k=0; ok(-p[i],q[j]); k++)\n\t\t\t\tdivide(-p[i],q[j]);\n\t\t\tif (k) ans[++cnt]=(node){-p[i],q[j],k};\n\t\t}\n\tput_out();\n\treturn 0;\n}\n```",
        "postTime": 1558931252,
        "uid": 142305,
        "name": "\u5356\u6deb\u7fc1",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4506 \u3010[CTSC2013]\u56e0\u5f0f\u5206\u89e3\u3011"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4506#submit)\n\n### \u9898\u89e3\uff1a\n\n~~\u672c\u849f\u84bb\u662f\u521d\u4e00\u7684\u6570\u5b66\u849f\u84bb,\u5e78\u597d\u521d\u4e2d\u5b66\u5b8c\u4e86\uff0c\u4e0d\u8fc7\u5b66\u7684\u5f88\u70c2\u3002~~\n\n\u5927\u4f6c\u4e0d\u559c\u8bf7\u55b7\u3002\n\n\u6839\u636e\u4ee3\u6570\u57fa\u672c\u5b9a\u7406\uff0c\u5f53 $(x-a)$ \u4e3a $f(x)$ \u7684\u56e0\u5f0f\u65f6, $f(a)=0$ \u3002\n\n\u8bbe $a_1,a_2,a_3,......,a_i$ \u4e3a\u591a\u9879\u5f0f $A$ \u7684\u6839\u3002\n\n\u5219 $A=(x-a_1)(x-a_2)......(x-a_i)T$ , $T$ \u4e3a $f(x)$ \u5728\u6709\u7406\u6570\u8303\u56f4\u5185\u4e0d\u53ef\u7ea6\u4e3a\u4e00\u6b21\u7684\u56e0\u5f0f\u3002\n\n\u4e3e\u4e2a\u4f8b\u5b50:\n\n\u8bbe $f(x)=x^3 - 3x^2 - 5x +14$ \u3002\n\n\u82e5 $(x-a)$ \u4e3a $f(x)$ \u7684\u56e0\u5f0f,\u5219 $a$ \u4e00\u5b9a\u4e3a $\\pm\\frac{a_i}{b_i}$ \uff0c\u5176\u4e2d $a_i$ \u548c $b_i$ \u4e3a\u6700\u4f4e\u6b21\u9879\u548c\u6700\u9ad8\u6b21\u9879\u7684\u56e0\u6570\u3002(\u6570\u8bba\u77e5\u8bc6\uff0c\u8bbe\u4e3a\u6761\u4ef6\u2460)\n\n\u5f53 $x=2$ \u65f6\uff0c$f(x)=0$ \uff0c\u56e0\u4e3a $2^3-3\\times2^2 - 5 \\times 2 + 14=0$ \u3002\n\n\u53ef\u5f97 $f(x)=(x-2)\\times(x^2-x+7)$ \u3002\n\n\u7ed9\u4e2a\u8bc1\u660e\uff1a\n\n\u82e5 $(a-x)$ \u4e3a $f(x)$ \u7684\u56e0\u5f0f\uff0c\u8bbe $g(x)\\times(a-x)=f(x)$ \u3002\n\n\u5219 $f(a)=(a-a)\\times g(a)=0$ \uff0c\u5f97\u8bc1\u3002\n\n\u5728\u4ee3\u7801\u4e2d\u6211\u4eec\u6bcf\u6b21\u5c06\u7b26\u5408\u6761\u4ef6\u2460\u7684\u6570\u5e26\u8fdb\u53bb\uff0c\u679a\u4e3e\u5373\u53ef\u3002\n\n\u6ce8\u610f\u9ad8\u7cbe\u548c\u7ea6\u5206\u4e3a\u4e24\u5927\u96be\u70b9\uff0c\u4ee3\u7801\u5199\u7684\u8db3\u591f\u8be6\u7ec6\u4e86\u3002\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1000001;\n//\u8d28\u6570(\u7d20\u6570)\u6253\u8868\nconst int su[75]={543892411,567498259,643448581,772660877,802279559,823153213,847485637,907170331,919507003,923425961,929812711,935151689,938910911,962946403,970870897,977946113,985116131,989743967,991308817,994793521,995403061,997310857,998623607,999049111,999860857,1000885111,1002002609,1002270383,1002326077,1002351107,1002642457,1002681557,1003013519,1004475841,1005879367,1006478441,1007120461,1007468677,1007576071,1008054149,1008640013,1008894637,1009316083,1009528721,1009862393,1010510329,1010915173,1011460739,1012072651,1012612079,1012668131,1012825181,1014091867,1014515053,1014904973,1015114333,1015944323,1016003431,1016121461,1017088367,1017307463,1017423811,1017620873,1018394743,1018932493,1019199101,1019208581,1019319187,1019376101,1019831203};\nint n,m,cnt,tot1,tot2,b[70][85],p[N],q[N];\nchar s1[N],s2[N];\nstruct nod{\n    int fz,fm,cs;\n}ans[85];//\u5206\u6570,\u540d\u5b57\u5199\u7684\u5f88\u660e\u767d\u4e86\n//fz\u5206\u5b50fm\u5206\u6bcdcs\u6b21\u6570\nbool cmp(const nod &u,const nod &v){\n\treturn (long long)u.fz*v.fm>(long long)u.fm*v.fz;\n}//\u5206\u6570\u6392\u5e8f\u4ea4\u53c9\u76f8\u4e58 \nstruct gjd{//\u9ad8\u7cbe\u5ea6\n\tint len,sgn,num[40];\n\tvoid tim(int ws,int fu){//\u538b\u4f4d\u4e58\n\t\tint i,j; sgn=fu;\n\t\tfor (i=ws; i>0; i-=9){\n\t\t\tlen++;\n\t\t\tfor (j=max(1,i-8); j<=i; j++) num[len]=num[len]*10+s2[j]-'0';\n\t\t}\n\t}\n\tint getmod(int x){//\u538b\u4f4d\u6a21\n\t\tint i,t=0;\n\t\tfor (i=len; i; i--)\n\t\t\tt=((long long)t*1000000000+num[i])%x;\n\t\treturn t;\n\t}\n}a[85];\nint ksm(int x,int y,int mod){\n\tint t=1; \n    for (; y; y>>=1,x=(long long)x*x%mod) if (y&1) t=(long long)t*x%mod;\n\treturn t;\n}\nint gcd(int x,int y){return (y)?gcd(y,x%y):x;}//\u6700\u5927\u516c\u7ea6\u6570 \nbool pd(int x,int y){\n\tint i,j,t,mod,tmp;\n\tfor (i=0; i<70; i++){\n\t\tmod=su[i]; t=(x+mod)%mod;\n\t\tt=(long long)t*ksm(y,mod-2,mod)%mod;\n\t\tfor (j=n,tmp=0; j>=0; j--) tmp=((long long)tmp*t+b[i][j])%mod;\n\t\tif (tmp) return 0;\n\t}\n\treturn 1;\n}\nvoid ys(int x,int y){\n\tint i,j,t,mod;\n\tfor (i=0; i<70; i++){\n\t\tmod=su[i];\n        t=(x+mod)%mod;\n\t\tt=(long long)t*ksm(y,mod-2,mod)%mod;\n\t\tfor (j=n; j>=0; j--) b[i][j]=((long long)b[i][j+1]*t+b[i][j])%mod;\n\t}\n}\nint main(){\n    ios_base::sync_with_stdio(false);\n\tscanf(\"%s\",s1+1);//\u4ece1\u5f00\u59cb \n\tint i=1,len=strlen(s1+1);//strlen\u4e00\u5b9a\u8981\u52a0\u4e2a\u4e00,\u5426\u5219\u4f1aRE \n\twhile (i<=len){\n\t\tint ws=0,fu=1,sh=0;\n\t\tif (s1[i]=='-') fu=-1;//\u8d1f\u6570 \n\t\tif (s1[i]=='+' || s1[i]=='-') i++;//\u7b26\u53f7 \n\t\tif (s1[i]=='x'){//'x' \n\t\t\ts2[ws=1]='1'; i++;\n\t\t\tif (s1[i]=='^'){//\u6b21\u65b9 \n\t\t\t\tfor (i++; s1[i]>='0' && s1[i]<='9'; i++)\n\t\t\t\t\tsh=sh*10+s1[i]-'0';\n\t\t\t\ta[sh].tim(ws,fu);\n\t\t\t\tif (!n) n=sh;\n\t\t\t} else a[1].tim(ws,fu);\n\t\t} else{//\u7cfb\u6570 \n\t\t\tfor (; s1[i]>='0' && s1[i]<='9'; i++) s2[++ws]=s1[i];\n\t\t\tif (!s1[i]) a[0].tim(ws,fu); else{\n\t\t\t\ti++;\n\t\t\t\tif (s1[i]=='^'){\n\t\t\t\t\tfor (i++; s1[i]>='0' && s1[i]<='9'; i++) sh=sh*10+s1[i]-'0';\n\t\t\t\t\ta[sh].tim(ws,fu);\n\t\t\t\t\tif (!n) n=sh;\n\t\t\t\t}\n                else a[1].tim(ws,fu);\n\t\t\t}\n\t\t}\n\t}\n\tif (a[n].sgn<0) putchar('-');//\u8d1f\u6570 \n\tif (a[n].len>1 || a[n].num[1]>1){\n\t\tprintf(\"%d\",a[n].num[a[n].len]);\n\t\tfor (i=a[n].len-1; i; i--) printf(\"%09d\",a[n].num[i]);\n\t}\n    //---\u5206\u5272\u7ebf \n\tint j,k;\n\ti=0;//\u521d\u59cb\u5316 \n    while (!a[i].len) i++;\n\tif (i>0) ans[++cnt]=(nod){0,1,i};\n\tfor (j=i; j<=n; j++) a[j-i]=a[j];\n\tn-=i;\n\tfor (i=0; i<70; i++) for (j=0; j<=n; j++) b[i][j]=(a[j].getmod(su[i])*a[j].sgn+su[i])%su[i];\n\tfor (i=1; i<=1000000; i++){\n\t\tif (!a[0].getmod(i)) p[++tot1]=i;//\u9996\u9879\u56e0\u6570 \n\t\tif (!a[n].getmod(i)) q[++tot2]=i;//\u672b\u9879\u56e0\u6570 \n\t}\n\tfor (i=1; i<=tot1; i++) for (j=1; j<=tot2; j++) if (gcd(p[i],q[j])==1){//\u4e92\u8d28,\u51cf\u5c11\u6b21\u6570 \n\t\tfor (k=0; pd(p[i],q[j]); k++) ys(p[i],q[j]);\n\t\tif (k) ans[++cnt]=(nod){p[i],q[j],k};//\u5206\u6570 \n\t\tfor (k=0; pd(-p[i],q[j]); k++) ys(-p[i],q[j]);\n\t\tif (k) ans[++cnt]=(nod){-p[i],q[j],k};//\u5206\u6570 \n\t}\n\t//---\u5206\u5272\u7ebf \n\tsort(ans+1,ans+cnt+1,cmp);\n\tfor (i=1; i<=cnt; i++){\n\t\tif (!ans[i].fz) putchar('x'); \n        else if (ans[i].fm==1)\n\t\t\tif (ans[i].fz<0) printf(\"(x+%d)\",-ans[i].fz);\n\t\t\telse printf(\"(x%d)\",-ans[i].fz);\n\t\telse \n            if (ans[i].fz<0) printf(\"(x+%d/%d)\",-ans[i].fz,ans[i].fm);\n\t\t\telse printf(\"(x%d/%d)\",-ans[i].fz,ans[i].fm);\n\t\tif (ans[i].cs>1) printf(\"^%d\",ans[i].cs);\n\t}\n\treturn 0; \n}\n```\n\n\u672c\u4eba\u7b2c```1```\u9053\u7d2b\u9898\u9898\u89e3\uff0c\u7ba1\u7406\u5458\u8f9b\u82e6\u4e86\uff0c\u5e0c\u671b\u7ed9\u8fc7~~\u4e0d\u8981\u5728\u610f\u67d0\u4e9bLaTeX\u7684\u7ec6\u8282~~\u3002",
        "postTime": 1644552008,
        "uid": 375242,
        "name": "ynxynx",
        "ccfLevel": 0,
        "title": "P4506\u56e0\u5f0f\u5206\u89e3\u9898\u89e3"
    }
]
[
    {
        "content": "\u60f3\u5fc5\u6765\u505a\u8fd9\u9898\u7684\u4eba\u90fd\u505a\u8fc7 [P2000 \u62ef\u6551\u4e16\u754c](https://www.luogu.org/problem/P2012) \u5427\u3002  \n\u5728\u90a3\u9898\u4e2d\uff0c\u65b9\u6848\u90fd\u662f\u65e0\u5e8f\u7684\uff0c\u6240\u4ee5\u7528\u666e\u901a\u751f\u6210\u51fd\u6570\u89e3\u51b3\u3002\n\u800c\u5728\u8fd9\u9898\u4e2d\u662f\u6709\u5e8f\u7684\uff0c\u8fd9\u65f6\u5c31\u8981\u4f7f\u7528\u6307\u6570\u578b\u751f\u6210\u51fd\u6570(EGF)\u3002\n\n\u6709\u4e00\u4e2a\u6570\u5217 $a$\uff0c\u5176 EGF \u5c31\u662f\uff1a\n$$ \\sum\\limits_{i=0}^\\infty \\frac{x^i}{i!}a_i$$\n\u90a3\u4e48\u6211\u4eec\u6839\u636e\u9898\u76ee\u4e2d\u7684\u4e09\u79cd\u57fa\u56e0\uff0c\u53ef\u4ee5\u5217\u51fa\u5b83\u4eec\u7684 EGF\uff1a\n$$ f(x)=\\sum\\limits_{i=0}^\\infty \\frac{x^i}{i!}=\\text e^x$$  \n$$ g(x)=\\sum\\limits_{i=0}^\\infty \\frac{x^{2i}}{(2i)!}=\\frac12(\\text e^x+ \\text e^{-x})$$\n$$ h(x)=\\sum\\limits_{i=0}^\\infty \\frac{x^{2i+1}}{(2i+1)!}=\\frac12(\\text e^x-\\text e^{-x})$$\n****\n\u548c P2000 \u90a3\u9898\u4e00\u6837\uff0c\u7b54\u6848\u7684 EGF \u5c31\u662f\u628a\u5b83\u4eec\u90fd\u4e58\u8d77\u6765\n$$ A(x)=(f(x)g(x)h(x))^4$$\n$$ =(\\frac14e^x(\\text e^{2x}-\\text e^{-2x}))^4$$\n$$ =(\\frac14(\\text e^{3x}-\\text e^{-x}))^4$$\n$$ =\\frac{1}{256}(\\text e^{12x}-4\\text e^{8x}+6\\text  e^{4x}-4+\\text e^{-4x})$$\n****\n\u90a3\u4e48\u7b54\u6848\u5c31\u662f\u53d6\u5176 $n$ \u6b21\u9879\u7cfb\u6570\uff0c\u4e0d\u8fc7\u8981\u6ce8\u610f\u4e58\u4e2a $n!$\n$$\\text{ans}=n![x^n]A(x)$$\n$$=\\frac{n!}{256}(\\frac{12^n}{n!}-\\frac{4\\times8^n}{n!}+\\frac{6\\times4^n}{n!}+\\frac{(-4)^n}{n!})$$\n$$= \\frac{1}{256}(12^n-4\\times8^n+6\\times4^n+(-4)^n)$$\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u8ba1\u7b97\u4e86\uff0c\uff0c\n\n\u4e0d\u8fc7\u8981\u6ce8\u610f\u7684\u662f $256$ \u5728\u6a21 $10^9$ \u4e0b\u6ca1\u6709\u9006\u5143\uff0c\u6240\u4ee5\u5728 $n$ \u8f83\u5c0f\u7684\u65f6\u5019\u76f4\u63a5\u66b4\u529b\uff0c\u5426\u5219\u7b54\u6848\u5c31\u662f  \n$$81\\times12^{n-4}-8^{n-2}+6\\times4^{n-4}+(-4)^{n-4}$$\n\u76f4\u63a5\u5feb\u901f\u5e42\u5c31\u80fd\u89e3\u51b3\u3002  \n\n\u4f46\u662f\u8fd9\u9898\u6781\u5ea6\u5361\u5e38\uff0c\u8981\u7528\u4e00\u4e2a\u5c0f\u5c0f\u7684\u4f18\u5316\u3002  \n\u6839\u636e\u6269\u5c55\u6b27\u62c9\u5b9a\u7406\uff1a \n$$ a^{b} \\equiv \\left\\{\\begin{aligned} a^{b\\text{ mod }\u03c6(m)+\u03c6(m)}\\space(b\\ge\u03c6(m)) \\\\ a^b\\space(b<\u03c6(m))\\end{aligned}\\right.(\\text{mod }m)$$\n$\u03c6(10^9)=4\\times10^8$\uff0c\u6240\u4ee5\u53ea\u8981 $n\\ge4\\times10^8$ \u5c31\u5bf9\u5176\u53d6\u6a21\u518d\u52a0\u4e0a\u53bb\u5c31\u597d\u4e86\u3002\n\n\u53ef\u4ee5\u7a0d\u5fae\u9884\u5904\u7406\u4e00\u4e0b\uff0c\u6bcf\u7ec4\u6570\u636e\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\Theta(1)$\n\nCode:\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<vector>\n#define reg register\n#define ll long long\n#define p 1000000000\n#define phi 400000000\nusing namespace std;\n\nint table[8] = {0,0,0,0,24,480,7680,107520};\nint pw1[32769],pw2[32769],pw3[32769],pw4[32769];\n\ninline int solve(const int& n){\n    reg int x = (ll)pw1[n&32767]*pw2[n>>15]%p,y = (ll)x*x%p;\n    reg int res = (81ll*pw3[n&32767]%p*pw4[n>>15]%p-64ll*x%p*y)%p;\n    res = (res+6ll*y+p)%p;\n    return (n&1)?(res<y?res-y+p:res-y):(res+y>=p?res+y-p:res+y);\n}\n\nint main(){\n    pw1[0] = pw2[0] = pw3[0] = pw4[0] = 1;\n    pw1[1] = 2;\n    for(reg int i=2;i<=32768;++i) pw1[i] = pw1[i-1]<500000000?(pw1[i-1]<<1):(pw1[i-1]<<1)-p;\n    pw2[1] = pw1[32768];\n    for(reg int i=2;i<=32768;++i) pw2[i] = (ll)pw2[i-1]*pw2[1]%p;\n    pw3[1] = 12;\n    for(reg int i=2;i<=32768;++i) pw3[i] = (ll)pw3[i-1]*12%p;\n    pw4[1] = pw3[32768];\n    for(reg int i=2;i<=32768;++i) pw4[i] = (ll)pw4[i-1]*pw4[1]%p;\n    reg ll n;\n    reg int x;\n    while(cin>>n){\n    \tif(n==0) break;\n        x = n>=phi?n%phi+phi:n;\n        printf(\"%d\\n\",x<8?table[x]:solve(x-4));\n    }\n}\n```",
        "postTime": 1565589485,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "P2012 solution"
    },
    {
        "content": "# \u7b97\u6cd5\u96f6\n\n\u6253\u66b4\u529b\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(T \\times 12^n) \\approx \\Theta(10^{10^{19}})$\u3002\n\n# \u7b97\u6cd5\u4e00\n\n\u72b6\u538b $\\texttt{DP}$\uff0c$dp_{i, stat}$ \u8868\u793a\u957f\u5ea6\u4e3a $i$\uff0c\u516b\u79cd\u7279\u6b8a\u57fa\u56e0\u7684\u5947\u5076\u6027\u72b6\u6001\u4e3a $stat$\uff0c\u6700\u7ec8\u7b54\u6848\u4e3a $dp_{n, 00001111}$\u3002\n\n\u8f6c\u79fb\u65b9\u7a0b\u4e3a $dp_{i, stat} = 4 \\times dp_{i-1, stat} + \\sum\\limits_{i=0}^{7} dp_{i-1, stat\\texttt{\u6539\u53d8\u4efb\u610f\u4e00\u4f4d\u540e\u7684\u503c}}$\uff0c\u521d\u59cb\u72b6\u6001\u4e3a $dp_{0, 00000000} = 1$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\Theta(8 \\times 256 \\times n) \\approx \\Theta(1.9 \\times 10^{22})$\u3002\n\n## \u4f18\u5316\n\n\u663e\u7136 $dp_{i, 00001111}$ \u548c $dp_{i, 11110000}$ \u662f\u76f8\u7b49\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4 $dp_{i, stat}$ \u7684\u503c\u53ea\u53d6\u51b3\u4e8e $stat$ \u4e2d $1$ \u7684\u4e2a\u6570\u3002\n\n\u4ee4 $dp_{i, j}$ \u8868\u793a\u539f\u5148 $dp_{i, stat}$ \uff08$stat$ \u4e2d\u6070\u597d\u6709 $j$ \u4e2a $1$\uff09\u7684\u503c\u3002\n\n\u6ce8\u610f\u5566\uff01\u8fd9\u91cc $dp_{i, 1}$ \u5c31\u662f $dp_{i, 00000001}$\uff0c\u4e5f\u7b49\u4e8e $dp_{i, 00000010}$\uff0c\u4e5f\u7b49\u4e8e $dp_{i, 00000100} \\cdots dp_{i, 10000000}$\uff0c\u800c\u4e0d\u662f\u5b83\u4eec\u7684\u548c\u3002\n\n\u9996\u5148\u8003\u8651 $j$ \u7b49\u4e8e $0$ \u7684\u60c5\u51b5\u3002\n\n\u4e5f\u5c31\u662f\u5168\u662f $0$\uff0c\u662f\u5982\u4f55\u63a8\u5f97\u7684\u5462\uff1f\n\n\u53ea\u6709\u4e24\u79cd\u53ef\u80fd\u6027\uff1a\u4e00\u662f\u4e0a\u4e00\u6b21\u5c31\u5168\u662f $0$\uff1b\u4e8c\u662f\u4e0a\u4e00\u6b21\u6709\u4e00\u4e2a $1$ \uff0c\u4f46\u662f\u88ab\u53bb\u6389\u4e86\u3002\n\n\u4e0a\u4e00\u6b21\u5168\u662f $0$\uff0c\u6240\u4ee5\u4f7f\u7528\u56db\u79cd\u666e\u901a\u57fa\u56e0\uff0c\u8981\u4e58\u4ee5 $4$\u3002\n\n\u4e0a\u4e00\u6b21\u6709\u4e00\u4e2a $1$\uff0c\u8fd9\u4e2a $1$ \u7684\u4f4d\u7f6e\u6709\u516b\u79cd\u53ef\u80fd\u6027\uff0c\u8981\u4e58\u4ee5 $8$\u3002\n\n\u4e5f\u5c31\u662f\u8bf4 $dp_{i, 0} = 4dp_{i-1, 0} + 8dp_{i-1,1}$\u3002\n\n\u7136\u540e\u8003\u8651 $j$ \u7b49\u4e8e $1$\u3002\n\n\u4e5f\u5c31\u662f\u539f\u5148\u7684 $dp_{i, 00000001}$\u3002\n\n\u6709\u4e09\u79cd\u53ef\u80fd\u6027\uff1a\u4e00\u662f\u4e0a\u4e00\u6b21\u5c31\u662f\u8fd9\u4e2a\u72b6\u6001\uff1b\u4e8c\u662f\u4e0a\u4e00\u6b21\u6709\u4e24\u4e2a $1$ \uff0c\u4f46\u662f\u53bb\u6389\u4e86\u4e00\u4e2a\uff1b\u4e09\u662f\u4e0a\u4e00\u6b21\u4e00\u4e2a $1$ \u4e5f\u6ca1\u6709\uff0c\u4f46\u662f\u52a0\u4e0a\u4e86\u4e00\u4e2a\u3002\n\n\u4e0a\u4e00\u6b21\u5168\u662f $0$\uff0c\u6240\u4ee5\u8fd8\u662f\u4f7f\u7528\u56db\u79cd\u666e\u901a\u57fa\u56e0\uff0c\u8981\u4e58\u4ee5 $4$\u3002\n\n\u4e0a\u4e00\u6b21\u6709\u4e24\u4e2a $1$\uff0c\u88ab\u53bb\u6389\u7684 $1$ \u7684\u4f4d\u7f6e\u653e\u5728\u73b0\u5728 $0$ \u7684\u4f4d\u7f6e\uff0c\u6709\u4e03\u4e2a\uff0c\u8981\u4e58\u4ee5 $7$\u3002\n\n\u4e0a\u4e00\u6b21\u4e00\u4e2a $1$ \u4e5f\u6ca1\u6709\uff0c\u53ea\u80fd\u52a0\u5728\u73b0\u5728\u7684\u4f4d\u7f6e\uff0c\u4e58\u4ee5 $1$\u3002\n\n\u4e5f\u5c31\u662f\u8bf4 $dp_{i, 1} = 4dp_{i-1, 1} + 7dp_{i-1,2} + dp_{i-1,0}$\u3002\n\n\u540c\u7406\u53ef\u5f97\uff1a\n\n$$dp_{i, 2} = 4dp_{i-1, 2} + 6dp_{i-1, 3} + 2dp_{i-1, 1}$$\n\n$$dp_{i, 3} = 4dp_{i-1, 3} + 5dp_{i-1, 4} + 3dp_{i-1, 2}$$\n\n$$dp_{i, 4} = 4dp_{i-1, 4} + 4dp_{i-1, 5} + 4dp_{i-1, 3}$$\n\n$$\\huge{\\cdots}$$\n\n$$dp_{i, 8} = 4dp_{i-1, 8} + 8dp_{i-1, 7}$$\n\n\u521d\u59cb\u72b6\u6001\u4e3a $dp_{0, 0} = 1$\u3002\n\n\u6700\u7ec8\u7b54\u6848\u4e3a $dp_{n, 4}$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(25 \\times n) \\approx \\Theta(2.3 \\times 10^{20})$\u3002\n\n# \u7b97\u6cd5\u4e8c\n\n\u770b\u5230\u7b97\u6cd5\u4e00\u4f18\u5316\u7684 $\\texttt{DP}$ \u65b9\u7a0b\uff0c\u4f60\u6709\u6ca1\u6709\u60f3\u5230\u4ec0\u4e48\u4e1c\u897f\uff1f\n\n\u5bf9\u5566\uff01\u77e9\u9635\u52a0\u901f\u3002\n\n\u628a\u8f6c\u79fb\u65b9\u7a0b\u5199\u6210\u77e9\u9635\u7684\u5f62\u5f0f\uff0c\u4f60\u4f1a\u770b\u5230\u4e00\u4e2a\u751a\u4e3a\u58ee\u89c2\u7684\u8f6c\u79fb\u77e9\u9635\uff1a\n\n$$\\left[\\begin{matrix}dp_{i, 0}\\\\dp_{i, 1}\\\\dp_{i, 2}\\\\dp_{i, 3}\\\\dp_{i, 4}\\\\dp_{i, 5}\\\\dp_{i, 6}\\\\dp_{i, 7}\\\\dp_{i, 8}\\end{matrix}\\right] = \\left[\\begin{matrix}4\\;8\\;0\\;0\\;0\\;0\\;0\\;0\\;0\\\\1\\;4\\;7\\;0\\;0\\;0\\;0\\;0\\;0\\\\0\\;2\\;4\\;6\\;0\\;0\\;0\\;0\\;0\\\\0\\;0\\;3\\;4\\;5\\;0\\;0\\;0\\;0\\\\0\\;0\\;0\\;4\\;4\\;4\\;0\\;0\\;0\\\\0\\;0\\;0\\;0\\;5\\;4\\;3\\;0\\;0\\\\0\\;0\\;0\\;0\\;0\\;6\\;4\\;2\\;0\\\\0\\;0\\;0\\;0\\;0\\;0\\;7\\;4\\;1\\\\0\\;0\\;0\\;0\\;0\\;0\\;0\\;8\\;4\\end{matrix}\\right] \\times \\left[\\begin{matrix}dp_{i-1, 0}\\\\dp_{i-1, 1}\\\\dp_{i-1, 2}\\\\dp_{i-1, 3}\\\\dp_{i-1, 4}\\\\dp_{i-1, 5}\\\\dp_{i-1, 6}\\\\dp_{i-1, 7}\\\\dp_{i-1, 8}\\end{matrix}\\right]$$\n\n\u4e8e\u662f\u7b54\u6848\u5c31\u662f\n\n$$\\left[\\begin{matrix}4\\;8\\;0\\;0\\;0\\;0\\;0\\;0\\;0\\\\1\\;4\\;7\\;0\\;0\\;0\\;0\\;0\\;0\\\\0\\;2\\;4\\;6\\;0\\;0\\;0\\;0\\;0\\\\0\\;0\\;3\\;4\\;5\\;0\\;0\\;0\\;0\\\\0\\;0\\;0\\;4\\;4\\;4\\;0\\;0\\;0\\\\0\\;0\\;0\\;0\\;5\\;4\\;3\\;0\\;0\\\\0\\;0\\;0\\;0\\;0\\;6\\;4\\;2\\;0\\\\0\\;0\\;0\\;0\\;0\\;0\\;7\\;4\\;1\\\\0\\;0\\;0\\;0\\;0\\;0\\;0\\;8\\;4\\end{matrix}\\right] ^n \\times\\left[\\begin{matrix}1\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\end{matrix}\\right]$$\n\n\u7684\u7b2c\u4e94\u4e2a\u5143\u7d20\u3002\uff08\u4e0b\u6807\u4e3a4\uff09\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(T \\times \\log n \\times 9^3) \\approx \\Theta(9.2 \\times 10^9)$\u3002\n\n\u4f3c\u4e4e\u770b\u5230\u4e86\u5e0c\u671b\u7684\u66d9\u5149\uff1f\n\n## \u4f18\u5316\u4e00\n\n\u77e9\u9635\u5149\u901f\u5e42\u3002\n\n\u4f17\u6240\u5468\u77e5\uff0c\u666e\u901a\u5149\u901f\u5e42\u662f\u628a\u6307\u6570\u5206\u62c6\u3002\n\n\u6bd4\u5982\uff1a$a^{114514} = a^{11 \\times 10^4 + 4514} = (a^{10^4})^{11} \\times a^{4514}$\n\n\u4f46\u662f\u8fd9\u91cc\u592a\u5927\uff0c\u5206\u62c6\u4e86\u4e5f\u6ca1\u7528\u3002\n\n\u4f46\u662f\u4e3a\u4ec0\u4e48\u4e00\u5b9a\u8981\u5206\u62c6\u6210\u4e24\u4e2a\u5462\uff1f\n\n\u6bd4\u5982\uff1a$a^{998244353} = a^{998 \\times 10^6 + 244 \\times 10^3 + 353} = (a^{10^6})^{998} \\times (a^{10^3})^{244} \\times a^{353}$\n\n\u8fd9\u6837\u867d\u7136\u8981\u4e09\u6b21\u76f8\u4e58\uff0c\u4f46\u662f\u9700\u8981\u9884\u5904\u7406\u7684\u4e1c\u897f\u4e5f\u5c11\u4e86\u3002\n\n\u6211\u6b63\u662f\u4f7f\u7528\u4e86\u8fd9\u4e00\u65b9\u6cd5\u3002\n\n\u6211\u53ea\u9700\u8981\u9884\u5904\u7406\uff1a\n\n$$\\left[\\,\\cdots\\right]^{(0,1,\\cdots,2^{16}-1)},$$\n\n$$\\left[\\,\\cdots\\right]^{(2^{16}, 2^{17}, \\cdots, 2^{32}-2^{16})},$$\n\n$$\\left[\\,\\cdots\\right]^{(2^{32}, 2^{33}, \\cdots, 2^{48}-2^{32})},$$\n\n$$\\left[\\,\\cdots\\right]^{(2^{48}, 2^{49}, \\cdots, 2^{63}-2^{48})}$$\n\n\u5373\u53ef\u3002\n\n$n$ \u4e0d\u662f $2^{63}$ \u5417\uff1f\u628a\u5b83\u4e8c\u8fdb\u5236\u5206\u4e3a\u56db\u6bb5\uff0c$0\\sim15$ \u4f4d\uff0c$16\\sim32$ \u4f4d\uff0c$33\\sim48$ \u4f4d\uff0c\u4ee5\u53ca $49\\sim63$ \u4f4d\u3002\n\n\u4e5f\u5c31\u662f\u5206\u89e3\u4e3a $n_1\\times2^{48}+n_2\\times2^{32}+n_3\\times2^{16}+n_4$\u3002\n\n\u628a\u4ed6\u4eec\u5206\u522b\u5bf9\u5e94\u7684\u56db\u4e2a\u77e9\u9635\u76f8\u4e58\uff0c\u518d\u4e58\u4ee5\u521d\u59cb\u77e9\u9635\uff0c\u5373\u53ef\u3002\n\n\u7b54\u6848\u5c31\u662f\uff1a\n\n$$\\Big(\\left[\\,\\cdots\\right]^{2^{48}}\\Big)^{n_1} \\times \\Big(\\left[\\,\\cdots\\right]^{2^{32}}\\Big)^{n_2} \\times \\Big(\\left[\\,\\cdots\\right]^{2^{16}}\\Big)^{n_3} \\times \\left[\\,\\cdots\\right]^{n_4} \\times \\left[\\begin{matrix}1\\\\0\\\\\\vdots\\\\0\\end{matrix}\\right]$$\n\n\u7684\u7b2c $5$ \u884c\u3002\uff08\u5b9e\u9645\u4e0b\u6807\u4e3a $4$\uff09\n\n\u9884\u5904\u7406 $\\Theta(9^3\\times(2^{16}\\times3+2^{15})) \\approx\\Theta(1.7\\times10^8)$\uff0c\u5355\u6b21\u8be2\u95ee $\\Theta(9^3\\times3)=\\Theta(2187)$\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(6.0 \\times 10^8)$\u3002\n\n\u662f\u4e0d\u662f\u80dc\u5229\u5c31\u5728\u773c\u524d\uff1f\n\n## \u4f18\u5316\u4e8c\n\n\u4ed4\u7ec6\u52a8\u8111\u7b4b\u60f3\u60f3\uff0c\n\n$$\\left[\\begin{matrix}a_{0,0}\\quad a_{0,1} \\cdots a_{0,8}\\\\a_{1,0}\\quad a_{1,1}\\cdots a_{1,8}\\\\\\vdots\\qquad\\vdots\\ \\ \\ddots\\ \\ \\vdots\\\\a_{8,0}\\quad a_{8,1}\\cdots a_{8,8}\\end{matrix}\\right] \\times \\left[\\begin{matrix}1\\\\0\\\\\\vdots\\\\0\\end{matrix}\\right]$$\n\n\u7684\u7b2c $5$ \u884c\u548c\n\n$$\\left[\\begin{matrix}a_{0,0}\\quad a_{0,1} \\cdots a_{0,8}\\\\a_{1,0}\\quad a_{1,1}\\cdots a_{1,8}\\\\\\vdots\\qquad\\vdots\\ \\ \\ddots\\ \\ \\vdots\\\\a_{8,0}\\quad a_{8,1}\\cdots a_{8,8}\\end{matrix}\\right]$$\n\n\u7684\u7b2c $5$ \u884c\u7b2c $1$ \u5217\u662f\u4e0d\u662f\u6ca1\u6709\u533a\u522b\uff1f\n\n\u4e8e\u662f\u7b54\u6848\u53c8\u53d8\u6210\u4e86\uff1a\n\n$$\\Big(\\left[\\,\\cdots\\right]^{2^{48}}\\Big)^{n_1} \\times \\Big(\\left[\\,\\cdots\\right]^{2^{32}}\\Big)^{n_2} \\times \\Big(\\left[\\,\\cdots\\right]^{2^{16}}\\Big)^{n_3} \\times \\left[\\,\\cdots\\right]^{n_4}$$\n\n\u7684\u7b2c $5$ \u884c\u7b2c $1$ \u5217\u3002\n\n\u518d\u60f3\u60f3\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u6c42\u5b83\u4eec\u7684\u4e58\u79ef\uff0c\u6211\u4eec\u53ea\u8981\u6c42\u5b83\u4eec\u4e58\u79ef\u7684\u67d0\u4e00\u56fa\u5b9a\u4f4d\u7f6e\u7684\u503c\uff01\n\n\u5047\u8bbe\u56db\u4e2a\u77e9\u9635\u5206\u522b\u662f $A,B,C,D$\uff0c\n\n\u6839\u636e\u77e9\u9635\u4e58\u6cd5\u7684\u6027\u8d28\uff0c\u7b54\u6848\u5e94\u4e3a\uff1a\n\n$$\\sum_{i=0}^{8}\\sum_{j=0}^{8}\\sum_{k=0}^{8}A_{4,i}B_{i,j}C_{j,k}D_{k,0}$$\n\n\u4f46\u662f\u8fd9\u6837\u8fd8\u662f\u8981\u8d85\u65f6\uff0c\u53ef\u4ee5\u6bcf\u6b21\u9501\u5b9a $j$\uff0c\u7136\u540e\u63d0\u4e00\u4e0b\u516c\u56e0\u5f0f\u3002\u4e5f\u5c31\u662f\uff1a\n\n$$\\sum_{j=0}^{8}[\\sum_{i=0}^{8}(A_{4,i}B_{i,j})\\times\\sum_{k=0}^{8}(C_{j,k}D_{k,0})]$$\n\n\u4e8e\u662f\u4e4e\u5355\u8bcd\u8be2\u95ee $\\Theta(2187)\\rightarrow\\Theta(162)$\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(9^3\\times(2^{16}\\times3+2^{15})+162\\times2\\times10^5)\\approx\\Theta(2.0\\times10^8)$\n\n## \u4f18\u5316\u4e09\n\n\u5361\u5e38\u6570\u5373\u53ef\u3002\n\n\u5361\u5e38\u6570\u6ce8\u610f\u4e8b\u9879\uff1a\n\n1. \u53d6\u6a21\u975e\u5e38\u6162\uff0c\u5c3d\u53ef\u80fd\u51cf\u5c11\u53d6\u6a21\u6b21\u6570\u3002\n\uff08\u4e3b\u8981\u662f\u9884\u5904\u7406\u65f6\uff0c\u8be2\u95ee\u65f6\u7531\u4e8e\u8ba1\u7b97\u672c\u8eab\u5c31\u5c11\uff0c\u5c31\u65e0\u6240\u8c13\u4e86\uff09\n\n1. \u7528 `register`\u3002\n\n\u4e0d\u5f00 $\\texttt{O2}$ \u4e0d\u7528 `register` \u6700\u5927\u7684\u4e00\u4e2a\u70b9 $\\texttt{800ms}$\uff0c\u7528\u4e86 `register` $\\texttt{650ms}$\uff0c\u5f00\u4e86 $\\texttt{O2}$ \u53ea\u8981 $\\texttt{250ms}$\uff01\u8fd8\u662f\u6709\u5f88\u5927\u7684\u4f59\u5730\u7684\u3002\n\n\u89c1\u4ee3\u7801\uff1a\n\n```cpp\n#include <cstdio>\n#define mod 1000000000\nconst int mat[9][9] = \n{{4, 8, 0, 0, 0, 0, 0, 0, 0},\n {1, 4, 7, 0, 0, 0, 0, 0, 0},\n {0, 2, 4, 6, 0, 0, 0, 0, 0},\n {0, 0, 3, 4, 5, 0, 0, 0, 0},\n {0, 0, 0, 4, 4, 4, 0, 0, 0},\n {0, 0, 0, 0, 5, 4, 3, 0, 0},\n {0, 0, 0, 0, 0, 6, 4, 2, 0},\n {0, 0, 0, 0, 0, 0, 7, 4, 1},\n {0, 0, 0, 0, 0, 0, 0, 8, 4}};\nint pow0[65536][9][9];\nint pow1[65536][9][9];\nint pow2[65536][9][9];\nint pow3[32768][9][9];\nlong long t;\nint x0, x1, x2, x3;\nint main() {\n\tregister int i, x, y, z, tmp1, tmp2, ans;\n\tregister long long tmp;\n\tfor (x = 0; x <= 8; x++) {\n\t\tfor (y = 0; y <= 8; y++) {\n\t\t\tpow0[0][x][y] = pow1[0][x][y] = pow2[0][x][y] = pow3[0][x][y] = (x == y);\n\t\t\tpow0[1][x][y] = mat[x][y];\n\t\t}\n\t}\n\tfor (i = 2; i <= 65535; i++) {\n\t\tfor (x = 0; x <= 8; x++) {\n\t\t\tfor (y = 0; y <= 8; y++) {\n\t\t\t\ttmp = 0;\n\t\t\t\tfor (z = 0; z <= 8; z++) {\n\t\t\t\t\ttmp += (long long)pow0[i-1][x][z] * pow0[1][z][y];\n\t\t\t\t}\n\t\t\t\tpow0[i][x][y] = tmp % mod;\n\t\t\t}\n\t\t}\n\t}\n\tfor (x = 0; x <= 8; x++) {\n\t\tfor (y = 0; y <= 8; y++) {\n\t\t\ttmp = 0;\n\t\t\tfor (z = 0; z <= 8; z++) {\n\t\t\t\ttmp += (long long)pow0[65535][x][z] * pow0[1][z][y];\n\t\t\t}\n\t\t\tpow1[1][x][y] = tmp % mod;\n\t\t}\n\t}\n\tfor (i = 2; i <= 65535; i++) {\n\t\tfor (x = 0; x <= 8; x++) {\n\t\t\tfor (y = 0; y <= 8; y++) {\n\t\t\t\ttmp = 0;\n\t\t\t\tfor (z = 0; z <= 8; z++) {\n\t\t\t\t\ttmp += (long long)pow1[i-1][x][z] * pow1[1][z][y];\n\t\t\t\t}\n\t\t\t\tpow1[i][x][y] = tmp % mod;\n\t\t\t}\n\t\t}\n\t}\n\tfor (x = 0; x <= 8; x++) {\n\t\tfor (y = 0; y <= 8; y++) {\n\t\t\ttmp = 0;\n\t\t\tfor (z = 0; z <= 8; z++) {\n\t\t\t\ttmp += (long long)pow1[65535][x][z] * pow1[1][z][y];\n\t\t\t}\n\t\t\tpow2[1][x][y] = tmp % mod;\n\t\t}\n\t}\n\tfor (i = 2; i <= 65535; i++) {\n\t\tfor (x = 0; x <= 8; x++) {\n\t\t\tfor (y = 0; y <= 8; y++) {\n\t\t\t\ttmp = 0;\n\t\t\t\tfor (z = 0; z <= 8; z++) {\n\t\t\t\t\ttmp += (long long)pow2[i-1][x][z] * pow2[1][z][y];\n\t\t\t\t}\n\t\t\t\tpow2[i][x][y] = tmp % mod;\n\t\t\t}\n\t\t}\n\t}\n\tfor (x = 0; x <= 8; x++) {\n\t\tfor (y = 0; y <= 8; y++) {\n\t\t\ttmp = 0;\n\t\t\tfor (z = 0; z <= 8; z++) {\n\t\t\t\ttmp += (long long)pow2[65535][x][z] * pow2[1][z][y];\n\t\t\t}\n\t\t\tpow3[1][x][y] = tmp % mod;\n\t\t}\n\t}\n\tfor (i = 2; i <= 32767; i++) {\n\t\tfor (x = 0; x <= 8; x++) {\n\t\t\tfor (y = 0; y <= 8; y++) {\n\t\t\t\ttmp = 0;\n\t\t\t\tfor (z = 0; z <= 8; z++) {\n\t\t\t\t\ttmp += (long long)pow3[i-1][x][z] * pow3[1][z][y];\n\t\t\t\t}\n\t\t\t\tpow3[i][x][y] = tmp % mod;\n\t\t\t}\n\t\t}\n\t}\n\twhile (1) {\n\t\tscanf(\"%lld\", &t);\n\t\tif (!t) return 0;\n\t\tx0 = (t & 65535ll);\n\t\tx1 = ((t >> 16ll) & 65535ll);\n\t\tx2 = ((t >> 32ll) & 65535ll);\n\t\tx3 = ((t >> 48ll) & 32767ll);\n\t\tans = 0;\n\t\tfor (y = 0; y <= 8; y++) {\n\t\t\ttmp1 = tmp2 = 0;\n\t\t\tfor (x = 0; x <= 8; x++) tmp1 = ((long long)pow0[x0][4][x] * pow1[x1][x][y] + tmp1) % mod;\n\t\t\tfor (x = 0; x <= 8; x++) tmp2 = ((long long)pow2[x2][y][x] * pow3[x3][x][0] + tmp2) % mod;\n\t\t\tans = ((long long)tmp1 * tmp2 + ans) % mod;\n\t\t}\n\t\tprintf(\"%d\\n\", ans);\n\t}\n}\n```\n",
        "postTime": 1629034679,
        "uid": 153422,
        "name": "0x3F",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2012\u3010\u62ef\u6551\u4e16\u754c2\u3011"
    },
    {
        "content": "\u6211\u76ee\u524d\u770b\u5230\u7684\u6240\u6709\u9898\u89e3\u90fd\u5dee\u4e0d\u591a\u5229\u7528\u4e86$EGF$,\u7c7b\u4f3c\u8fd9\u6837\uff1a\n\n$EGF_{ACGT}(x)=e^{4x}$\n\n$EGF_{YIN}(x)=\\left(\\dfrac{e^x+e^{-x}}{2}\\right)^4$\n\n$EGF_{YANG}(x)=\\left(\\dfrac{e^x-e^{-x}}{2}\\right)^4$\n\n$EGF(x)=EGF_{ACGT}(x)EGF_{YIN}(x)EGF_{YANG}(x)$\n\n$=\\left(\\dfrac{1}{4}e^x\\left(e^{2x}-e^{-2x}\\right)\\right)^4$\n\n$=\\dfrac{1}{256}\\left(e^{12x}-4e^{8x}+6e^{4x}-4+e^{-4x}\\right)$\n\n$\\therefore a_n=n!EGF^{(n)}(0)=\\dfrac{1}{256}\\left(12^n-4\\cdot8^n+6\\cdot4^n+(-4)^n\\right)$\n\n\u90a3\u5f88\u591a\u4e0d\u61c2$EGF$\u7684\u5c0f\u670b\u53cb\u5c31\u8981\u95ee\u4e86\uff1a\n\n__$EGF$\u5230\u5e95\u662f\u5565\u5462\uff1f__\n\n*\u7b80\u5355\u5730*\u6765\u8bf4\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u6570\u5217$a_n(n\\in\\mathbb{N})$\u6765\u8bf4\uff0c\u5b83\u7684$EGF$\u5c31\u662f\u4e00\u4e2a\u4e00\u5143\u51fd\u6570$EGF(x)=a_0+a_1x+a_2\\dfrac{x^2}{2}+a_3\\dfrac{x^3}{6}+a_4\\dfrac{x^4}{24}+\\cdots+a_n\\dfrac{x^n}{n!}+\\cdots$\u3002\n\n__\u90a3\u4e48\u8fd9\u73a9\u610f\u6709\u4ec0\u4e48\u7528\u5462\uff1f__\n\n__\u5f88\u6709\u7528\u554a\uff01__\n\n\u6bd4\u5982\u8bf4\u6709\u4e24\u4e2a\u6570\u5217$a_n,b_n$\uff0c\u5b83\u4eec\u7684$EGF$\u5df2\u77e5\uff1a$A(x),B(x)$\uff0c\u6709\u7b2c\u4e09\u4e2a\u6570\u5217$c_n=C_n^0a_0b_n+C_n^1a_1b_{n-1}+\\cdots+C_n^ka_kb_{n-k}+\\cdots+C_n^na_nb_0$\uff0c\u90a3\u4e48\u5b83\u7684$EGF$__\u5c31\u662f$C(x)=A(x)B(x)$\uff01__\n\n\u6211\u4eec\u6765\u8bc1\u660e\u4e00\u4e0b\uff1a\n\n\u7b97\u4e86\uff0c\u61d2\u5f97\u6572\u516c\u5f0f\uff0c\u4e22\u4e2a\u94fe\u63a5\u81ea\u5df1\u770b\uff1a[\u63a8\u5bfc](https://www.latexlive.com/#JTVDYmVnaW4lN0JhbGlnbiU3RCUwQUMoeCkmPSU1Q3N1bV8lN0JpPTAlN0QlNUUlNUNpbmZ0eSUyMGNfaSU1Q2ZyYWMlN0J4JTVFaSU3RCU3QmkhJTdEJTVDJTVDJTBBJj0lNUNzdW1fJTdCaT0wJTdEJTVFJTVDaW5mdHklNUNzdW1fJTdCaj0wJTdEJTVFaUNfaSU1RWphX2piXyU3QmktaiU3RCU1Q2ZyYWMlN0J4JTVFaSU3RCU3QmkhJTdEJTVDJTVDJTBBJj0lNUNzdW1fJTdCaT0wJTdEJTVFJTVDaW5mdHklNUNzdW1fJTdCaj0wJTdEJTVFaSU1Q2ZyYWMlN0JpISU3RCU3QmohKGktaikhJTdEYV9qYl8lN0JpLWolN0QlNUNmcmFjJTdCeCU1RWklN0QlN0JpISU3RCU1QyU1QyUwQSY9JTVDc3VtXyU3Qmk9MCU3RCU1RSU1Q2luZnR5JTVDc3VtXyU3Qmo9MCU3RCU1RWklNUNmcmFjJTdCYV9qJTdEJTdCaiElN0R4JTVFaiU1Q2Nkb3QlNUNmcmFjJTdCYl8lN0JpLWolN0QlN0QlN0IoaS1qKSElN0R4JTVFJTdCaS1qJTdEJTVDJTVDJTBBJj0lNUNzdW1fJTdCaj0wJTdEJTVFJTVDaW5mdHklNUNzdW1fJTdCaT1qJTdEJTVFJTVDaW5mdHklNUNmcmFjJTdCYV9qJTdEJTdCaiElN0R4JTVFaiU1Q2Nkb3QlNUNmcmFjJTdCYl8lN0JpLWolN0QlN0QlN0IoaS1qKSElN0R4JTVFJTdCaS1qJTdEJTVDJTVDJTBBJj0lNUNzdW1fJTdCaj0wJTdEJTVFJTVDaW5mdHklNUNzdW1fJTdCaz0wJTdEJTVFJTVDaW5mdHklNUNmcmFjJTdCYV9qJTdEJTdCaiElN0R4JTVFaiU1Q2Nkb3QlNUNmcmFjJTdCYl9rJTdEJTdCayElN0R4JTVFayU1QyU1QyUwQSY9JTVDc3VtXyU3Qmo9MCU3RCU1RSU1Q2luZnR5JTIwYV9qJTVDZnJhYyU3QnglNUVqJTdEJTdCaiElN0QlNUNjZG90JTVDc3VtXyU3Qms9MCU3RCU1RSU1Q2luZnR5JTIwYl9rJTVDZnJhYyU3QnglNUVrJTdEJTdCayElN0QlNUMlNUMlMEEmPUEoeClCKHgpJTBBJTVDZW5kJTdCYWxpZ24lN0Q=)\n\n\u800c\u4ece\u4e00\u4e2a$EGF$\u4e5f\u53ef\u4ee5\u63a8\u51fa\u539f\u6570\u5217\uff1a$a_n=n!EGF^{(n)}(0)$\n\n\u63a8\u5bfc\u561b\u2026\u2026\u4e3b\u8981\u601d\u8def\u5c31\u662f\u5bf9$EGF$\u7684\u5b9a\u4e49\u5f0f\u6c42$n$\u9636\u5bfc\uff0c\u7136\u540e\u53d6$x=0$\uff0c\u7c7b\u4f3c\u4e8e\u6cf0\u52d2\u5c55\u5f00\uff0c~~\u7559\u4f5c\u4e60\u9898~~\uff08\u9003\n\n__\u90a3\u4e48\u5b83\u4e0e\u9898\u76ee\u600e\u4e48\u8054\u7cfb\u4e0a\u5462\uff1f__\n\n\u9996\u5148\uff0c\u5728$n$\u4e2a\u57fa\u56e0\u4e2d\uff0c\u9009\u53d6$k$\u4e2a\u653e$A$\uff0c\u8fd9\u4e2a\u5b50\u95ee\u9898\u8bbe\u6709$a_k$\uff1b\n\n\u518d\u8bbe\u5269\u4e0b\u90e8\u5206\u6709$b_{n-k}$\u79cd\u65b9\u6cd5\u3002\n\n\u800c\u6b64\u65f6\u65b9\u6cd5\u6570\u4e3a$C_n^ka_kb_{n-k}$\u3002\n\n$C_n^k$\u5bf9\u5e94\u7740\u9009\u53d6$k$\u4e2a\u57fa\u56e0\u653e$A$\uff1b$a_k$\u5bf9\u5e94\u7740\u7b2c\u4e00\u4e2a\u5b50\u95ee\u9898\uff1b$b_{n-k}$\u5bf9\u5e94\u7740\u7b2c\u4e8c\u4e2a\u5b50\u95ee\u9898\u3002\\\n\u53c8\u56e0\u4e3a$k$\u7684\u53d6\u503c\u8303\u56f4\u662f$0\\le k\\le n$\uff0c\u6240\u4ee5\u603b\u65b9\u6cd5\u6570\u5c31\u4e3a\u2026\u2026\n\n$C_n^0a_0b_n+C_n^1a_1b_{n-1}+\\cdots+C_n^ka_kb_{n-k}+\\cdots+C_n^na_nb_0$\uff01\n\n\u4e8e\u662f\uff0c\u5927\u95ee\u9898\u7684$EGF$\u5c31\u4e3a\u4e24\u4e2a\u5b50\u95ee\u9898\u7684$EGF$\u4e4b\u4e58\u79ef\uff01\n\n\u7136\u540e\uff0c\u6211\u4eec\u518d\u5bf9$b_{n-k}$\u8fdb\u884c\u540c\u6837\u7684\u5206\u89e3\u64cd\u4f5c\uff0c\u7136\u540e\u518d\u5206\u89e3\uff0c\u5206\u89e3\u2026\u2026\n\n\u4e8e\u662f\uff0c\u5927\u95ee\u9898\u7684$EGF$\u5c31\u4e3a\u6240\u6709\u57fa\u56e0\u7684$EGF$\u4e4b\u4e58\u79ef\uff01\n\n\u63a5\u4e0b\u6765\u5c31\u7b97\u51fa\u6bcf\u4e2a\u57fa\u56e0\u7684$EGF$\u5c31\u597d\u4e86\u3002\n\n\u5bf9\u4e8e$ACGT$\uff0c$EGF$\u5c31\u4e3a$1+x+\\dfrac{x^2}{2}+\\dfrac{x^3}{6}+\\cdots=e^x$\uff1b\n\n\u5bf9\u4e8e\u56db\u4e2a\u9633\u5366\uff0c$EGF$\u5c31\u4e3a$1+\\dfrac{x^2}{2}+\\dfrac{x^4}{24}+\\cdots=\\dfrac{e^x+e^{-x}}2$\uff1b\n\n\u5bf9\u4e8e\u56db\u4e2a\u9634\u5366\uff0c$EGF$\u5c31\u4e3a$x+\\dfrac{x^3}{6}+\\dfrac{x^5}{120}+\\cdots=\\dfrac{e^x-e^{-x}}2$\u3002\n\n\u6240\u4ee5\u603b\u7684$EGF$\u5c31\u662f\u628a\u5b83\u4eec\u4e58\u8d77\u6765\u3002\n\n\u7136\u540e\u6709\u603b\u65b9\u6cd5\u6570\u4e3a$n!EGF^{(n)}(0)$\u3002\n\n\u8fd8\u6709\uff0c\u6700\u540e\u7684\u516c\u5f0f\u4f1a\u6709\u4e00\u4e2a$\\dfrac{1}{256}$\uff0c\u800c$256$\u6a21$10^9$\u662f\u6ca1\u6709\u4e58\u6cd5\u9006\u5143\u7684\uff0c\u6240\u4ee5\u5148\u5bf9$n<4$\u8fdb\u884c\u7279\u5224\uff0c\u800c$n\\ge4$\u65f6$256|4^n$,\u6240\u4ee5\u53ef\u4ee5\u53d8\u5f62\u4e3a$3^n\\cdot4^{n-4}-4\\cdot2^n\\cdot4^{n-4}+6\\cdot4^{n-4}+(-1)^n\\cdot4^{n-4}$\u3002\n\n---\n\u5176\u5b9e\uff0c\u53ea\u8981\u662f\u8981\u6c42\u957f\u5ea6\u4e3a$n$\uff0c\u800c\u6bcf\u4e2a\u5b57\u7b26\u51fa\u73b0\u6b21\u6570\u6709\u9650\u5236\u7684\u5b57\u7b26\u4e32\u8ba1\u6570\u90fd\u53ef\u4ee5\u7528$EGF$\u6765\u505a\u3002\u6839\u636e\u4e0a\u9762\u7684\u63a8\u5bfc\uff0c\u53ef\u4ee5\u770b\u51fa\u603b\u95ee\u9898\u7684$EGF$\u5c31\u4e3a\u6bcf\u4e2a\u5b57\u7b26\u6240\u5bf9\u5e94\u7684$EGF$\u7684\u4e58\u79ef\u3002\u8fd9\u91cc\u6211\u4eec\u5217\u51fa\u4e00\u4e9b\u57fa\u672c\u7684$EGF$\u53ca\u8bc1\u660e\uff1a\n\n$a_n=1$\u7684$EGF$\u4e3a$1+x+\\dfrac{x^2}{2}+\\dfrac{x^3}{6}+\\cdots=e^x$\uff1b\n\n$a_n=1(n=2k)0(n=2k+1)$\u7684$EGF$\u4e3a$1+\\dfrac{x^2}{2}+\\dfrac{x^4}{24}+\\dfrac{x^6}{720}+\\cdots=\\dfrac{1}{2}(1+x+\\dfrac{x^2}{2}+\\dfrac{x^3}{6}+\\cdots+1-x+\\dfrac{x^2}{2}-\\dfrac{x^3}{6}+\\cdots)=\\dfrac{1}{2}(e^x+e^{-x})$;\n\n\u540c\u7406\uff0c$a_n=0(n=2k)1(n=2k+1)$\u7684$EGF$\u4e3a$\\dfrac{1}{2}(e^x-e^{-x})$\u3002\n\n$a_n=\\lambda^n$\u7684$EGF$\u4e3a$1+\\lambda x+\\lambda^2\\dfrac{x^2}{2}+\\lambda^3\\dfrac{x^3}{6}+\\cdots=e^{\\lambda x}$\u3002\n\n$a_n=n!$\u7684$EGF$\u4e3a$1+x+x^2+x^3+x^4+\\cdots=\\dfrac{1}{1-x}$\u3002\n\n$a_n=n$\u7684$EGF$\u4e3a$x+x^2+\\dfrac{x^3}{2}+\\dfrac{x^4}{6}+\\cdots=xe^x$\u3002\n\n$a_n=n(n-1)(n-2)\\cdots(n-k+1)$\u7684$EGF$\u4e3a$x^ke^x$\u3002\n\n###### \u7801\u5b57\u4e0d\u6613\uff0c\u4e3a\u4e86\u5173\u7167\u672c\u849f\u84bb\u7684\u7b2c\u4e00\u7bc7\u9898\u89e3\uff0c~~\u5c31\u70b9\u4e2a\u8d5e\u5457~~\uff01\n###### \u671b\u7ba1\u7406\u5458\u901a\u8fc7",
        "postTime": 1608971255,
        "uid": 384214,
        "name": "esquigybcu",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2012 \u3010\u62ef\u6551\u4e16\u754c2\u3011"
    },
    {
        "content": "\u9898\u610f\uff1a\u591a\u6d4b\uff0c\u6c42\u6709\u591a\u5c11\u53ea\u957f\u5ea6\u4e3a $n$ \u7684\u53ea\u5305\u542b\u5b50\u4e11\u5bc5\u536f\u8fb0\u5df3\u5348\u672a\u7533\u9149\u620c\u4ea5\u7684\u5e8f\u5217\uff0c\u6ee1\u8db3\u5b50\u4e11\u5bc5\u536f\u6709\u4efb\u610f\u4e2a\uff0c\u8fb0\u5df3\u5348\u672a\u6709\u5947\u6570\u4e2a\uff0c\u7533\u9149\u620c\u4ea5\u6709\u5076\u6570\u4e2a\u3002$T\\le 2\\times 10^5,1\\le n<2^{63},\\bmod 10^9$\n\n\u7531\u4e8e\u662f\u5e8f\u5217\uff0c\u800c\u4e0d\u662f\u96c6\u5408\uff0c\u4f7f\u7528 $\\text{EGF}$\u3002\n\n\u6211\u8be6\u7ec6\u5730\u89e3\u91ca\u4e00\u4e0b $\\text{EGF}$ \u7684\u539f\u7406\u3002\n\n> \u6709\u591a\u5c11\u4e2a\u5927\u5c0f\u4e3a $4$ \u7684\u53ef\u91cd\u96c6\uff0c$1$ \u4e0d\u8d85\u8fc7 $1$ \u4e2a\uff0c$2$ \u4e0d\u8d85\u8fc7 $2$ \u4e2a\uff0c$3$ \u4e0d\u8d85\u8fc7 $3$ \u4e2a\u3002\n\n\u5148\u8bb2\u4e00\u4e0b $\\text{OGF}$\u3002\n\n\u8fd9\u9053\u9898\u7684\u7b54\u6848\u662f $[x^4](1+x)(1+x+x^2)(1+x+x^2+x^3)$\u3002\n\n\u4e3a\u4ec0\u4e48\u5462\uff1f\n\n\u6211\u4eec\u8003\u8651\u5230\u7b2c\u4e00\u4e2a\u62ec\u53f7\u7684 $x$ \u4e58\u4e0a \u7b2c\u4e8c\u4e2a\u62ec\u53f7\u91cc\u7684 $x^2$ \u4e58\u4e0a \u7b2c\u4e09\u4e2a\u62ec\u53f7\u91cc\u7684 $x$ \u7b49\u4e8e $x^4$ \u5b83\u7684\u610f\u4e49\u5c31\u662f \u7528\u4e86 $1\\times1,2\\times2,1\\times3$\u3002\u8fd9\u6837\u8fd9\u5c31\u4e3a\u7b54\u6848\u4ea7\u751f\u4e86\u4e00\u4e2a\u8d21\u732e\uff0c\u6240\u6709\u8d21\u732e\u76f8\u52a0\u5c31\u662f\u7b54\u6848\u3002\n\n> \u6709\u591a\u5c11\u4e2a\u957f\u5ea6\u4e3a $4$ \u7684\u5b57\u7b26\u4e32\uff0c$1$ \u4e0d\u8d85\u8fc7 $1$ \u4e2a\uff0c$2$ \u4e0d\u8d85\u8fc7 $2$ \u4e2a\uff0c$3$ \u4e0d\u8d85\u8fc7 $3$ \u4e2a\u3002\n\n\u8fd9\u9053\u9898\u7684\u7b54\u6848\u662f $4![x^4](1+\\dfrac x {1!})(1+\\dfrac x{1!}+\\dfrac{x^2}{2!})(1+\\dfrac x{1!}+\\dfrac{x^2}{2!}+\\dfrac{x^3}{3!})$\u3002\n\n\u4e3a\u4ec0\u4e48\u5462\uff1f\n\n\u6211\u4eec\u8003\u8651\u5230\u7b2c\u4e00\u4e2a\u62ec\u53f7\u7684 $\\dfrac x {1!}$ \u4e58\u4e0a \u7b2c\u4e8c\u4e2a\u62ec\u53f7\u91cc\u7684 $\\dfrac{x^2}{2!}$ \u4e58\u4e0a \u7b2c\u4e09\u4e2a\u62ec\u53f7\u91cc\u7684 $\\dfrac x {1!}$ \u4e58\u4e0a $4!$ \u7b49\u4e8e $\\dfrac{4!\\times x^4}{1!\\times2!\\times1!}$ \u5b83\u7684\u610f\u4e49\u5c31\u662f \u7528\u4e86 $1\\times1,2\\times2,1\\times3$\u3002\u7136\u540e\u5c31\u662f\u4e00\u4e2a[\u591a\u91cd\u96c6\u7684\u6392\u5217\u6570](https://oi-wiki.org/math/combinatorics/combination/#_9)\u4e86\u3002\n\n\u7136\u540e\u4f60\u5c31\u660e\u767d\u4e86 $\\text{EGF}$ \u7684\u7cbe\u9ad3\u3002\n\n\u7136\u540e\u4f60\u5c31\u53ef\u4ee5\u62ef\u6551\u4e16\u754c\u4e86\u3002\n\n\u5b50\u4e11\u5bc5\u536f\u7684 $\\text{EGF}$\uff1a$1+\\dfrac x{1!}+\\dfrac{x^2}{2!}+\\dfrac{x^3}{3!}+\\ldots=e^x$\n\n\u8fb0\u5df3\u5348\u672a\u7684 $\\text{EGF}$\uff1a$\\dfrac x{1!}+\\dfrac{x^3}{3!}+\\ldots=\\dfrac{e^x-e^{-x}}2$\n\n\u7533\u9149\u620c\u4ea5\u7684 $\\text{EGF}$\uff1a$1+\\dfrac{x^2}{2!}+\\dfrac{x^4}{4!}+\\ldots=\\dfrac{e^x+e^{-x}}2$\n\n\u7b54\u6848\u7684 $\\text{EGF}$\uff1a\n\n$$(e^x(\\dfrac{e^x-e^{-x}}2)(\\dfrac{e^x+e^{-x}}2))^4$$\n\n$$\\frac1{256}(e^{12x}-4e^{8x}+6e^{4x}-4+e^{-4x})$$\n\n\u4e58\u4ee5\u4e00\u4e2a $n!$ \u53d6\u7b2c $n$ \u9879\u7cfb\u6570\uff1a\n\n$$\\frac1{256}(12^n-4\\times8^n+6\\times4^n+(-4)^n)$$\n\n\u5e38\u6570\u9879\u6254\u4e86\u2026\u2026\n\n\u4f60\u53d1\u73b0\u8fd9\u4e2a\u6a21\u6570\u5f88\u9b3c\u755c\uff0c\u4e8e\u662f\u4f60\u5728 $n$ \u5c0f\u7684\u65f6\u5019\u786c\u7b97\uff0c\u5927\u7684\u65f6\u5019\u9664\u6389\u3002\n\n$$81\\times12^{n-4}-8^{n-2}+6\\times4^{n-4}+(-4)^{n-4}$$\n\n\u7136\u540e\u9002\u5ea6\u4e0a\u6269\u6b27\u5427\uff0c\u52a0\u4e00\u4e2a\u5149\u901f\u5e42\uff0c\u9760\u4fe1\u4ef0\u8dd1\u3002\n\n\u73b0\u5728\u662f $15:14$\uff0c\u6211\u770b\u6211\u4ec0\u4e48\u65f6\u5019\u5199\u5b8c\u3002\n\n\u73b0\u5728\u662f $15:37$\uff0c\u6211\u5199\u5b8c\u4e86\u3002\n\n```cpp\n#define maxn 200010\nlong long n;\nint N[maxn];\nint tot,mx;\nconst int p=1e9;\ntemplate<class _Tp,class _tp>void add(_Tp&x,const _tp& y){((x+=y)>=p)&&(x-=p);}template<class _Tp,class _tp>_Tp Add(_Tp x,const _tp y){add(x,y);return x;}\ntemplate<class _Tp,class _tp>void sub(_Tp&x,const _tp&y){((x-=y)<0)&&(x+=p);}template<class _Tp,class _tp>_Tp Sub(_Tp x,const _tp y){sub(x,y);return x;}\ntemplate<class _Tp,class _tp>void mul(_Tp&x,const _tp&y){x=1ll*x*y%p;}template<class _Tp,class _tp>_Tp Mul(const _Tp x,const _tp y){return 1ll*x*y%p;}\ntemplate<class _Tp,class _tp>_Tp ksm(_Tp a,_tp b){_Tp ans(1);for(;b;b>>=1,mul(a,a))if(b&1)mul(ans,a);return ans;} \ntemplate<class _Tp>_Tp div2(_Tp a){if(a&1)a+=p;return a>>1;}\nstruct gsm{\n\t#define _Tp long long\n\tint _[32768][2],mx;\n\tgsm(int o,_Tp lim){\n\t\tmx=sqrt(lim)+1;\n\t\t_[0][0]=_[0][1]=1;\n\t\tfor(int i=1;i<=mx;i++)_[i][0]=Mul(_[i-1][0],o);\n\t\tfor(int i=1;i<=mx;i++)_[i][1]=Mul(_[i-1][1],_[mx][0]);\n\t}\n\tint operator()(_Tp x){return Mul(_[x%mx][0],_[x/mx][1]);}\n};\nsigned main(){\n#ifndef ONLINE_JUDGE\n\tfreopen(\"testdata.in\",\"r\",stdin);\n#endif\n\twhile(cin>>n,n){\n\t\tif(n>=4e8)n%=400000000,n+=400000000;\n\t\tN[++tot]=n;\n\t\tmx=max(mx,N[tot]);\n\t}\n\tgsm A(12,mx),B(8,mx),C(4,mx),D(p-4,mx);\n\tfor(int i=1;i<=tot;i++){\n\t\tif(N[i]<=3)cout<<0<<endl;\n\t\telse cout<<Add(Sub(Mul(81,A(N[i]-4)),B(N[i]-2)),Add(Mul(6,C(N[i]-4)),D(N[i]-4)))<<endl;\n\t}\n#ifndef ONLINE_JUDGE\n\tcerr<<endl<<(double)clock()/CLOCKS_PER_SEC;\n#endif\n}\n```\n\u968f\u4fbf\u5c31\u6700\u4f18\u89e3\u4e86\uff0c\u6211\u4e5f\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u3002\u3002\u3002",
        "postTime": 1632640462,
        "uid": 100325,
        "name": "peterwuyihong",
        "ccfLevel": 7,
        "title": "P2012 \u62ef\u6551\u4e16\u754c2 \u8bb0\u5f55"
    },
    {
        "content": "\u505a\u8fd9\u9898\u4f60\u9996\u5148\u8981\u77e5\u9053\u4e00\u4e2a\u5e38\u7528\u7684\u6cf0\u52d2\u5c55\u5f00\u516c\u5f0f\u3002\n\n$e^{cx}=\\sum_{i\\ge 0}c^i\\frac{x^i}{i!}$\n\n\u7136\u540e\uff0c\u4e09\u79cd\u9650\u5236\u7684\u751f\u6210\u51fd\u6570\u662f\uff1a\n\n$A(x)=\\sum_{i\\ge 0}\\frac{x^i}{i!}=e^x$\n\n$B(x)=\\sum_{i\\ge 0}\\frac{x^{2i}}{(2i)!}=\\frac{e^x+e^{-x}}{2}$\n\n$C(x)=\\sum_{i\\ge 0}\\frac{x^{2i+1}}{(2i+1)!}=\\frac{e^x-e^{-x}}{2}$\n\n\u56e0\u4e3a\u6bcf\u79cd\u90fd\u6709\u56db\u4e2a\uff0c\u6240\u4ee5\u6700\u540e\u7b54\u6848\u7684\u751f\u6210\u51fd\u6570\u662f$Ans(x)=(A(x)B(x)C(x))^4$\u3002\n\n\u624b\u7b97\u4e00\u4e0b$Ans(x)=\\frac{e^{12x}-4e^{8x}+6e^{4x}+e^{-4x}-4}{256}$\n\n\u628a\u6bcf\u4e00\u9879\u6cf0\u52d2\u5c55\u5f00\u5f97\u5230\uff1a\n\n$Ans(x)=\\frac{\\sum_{i\\ge 0}12^i\\frac{x^i}{i!}-4\\sum_{i\\ge 0}8^i\\frac{x^i}{i!}+6\\sum_{i\\ge 0}4^i\\frac{x^i}{i!}+\\sum_{i\\ge 0}(-4)^i\\frac{x^i}{i!}-4}{256}$\n\n\u5408\u5e76\u4e4b\u540e\uff0c\u7b2cn\u9879\u7684\u7cfb\u6570(\u5373\u7b54\u6848)\u5c31\u662f$\\frac{12^n-4\\times8^n+6\\times4^n+(-4)^n}{256}$(\u56e0\u4e3a$n<4$\u7684\u65f6\u5019\u7b54\u6848\u4e3a0\uff0c\u800c\u4e0a\u9762\u90a3\u4e2a\u5f0f\u5b50\u6700\u540e\u7684-4\u53ea\u548c\u5e38\u6570\u9879\u6709\u5173\uff0c\u6240\u4ee5\u4e0d\u7528\u8003\u8651\u3002\u4e0d\u8fc7\u5c31\u7b97\u4f60\u8003\u8651\u4e86\uff0c$n<4$\u65f6\uff0c\u7b54\u6848\u4e5f\u662f0)\u3002\n\n~~\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u8bfb\u5165\u8981\u5199scanf\uff0c\u4e0d\u80fd\u7528\u5feb\u8bfb\uff0c\u6211\u56e0\u4e3a\u8fd9\u4e2aT\u5230\u81ea\u95ed~~",
        "postTime": 1558836145,
        "uid": 27677,
        "name": "day_dream",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2012 \u3010\u62ef\u6551\u4e16\u754c2\u3011"
    },
    {
        "content": "![](https://cdn.luogu.com.cn/upload/pic/52669.png)   \n\n\u4f7f\u7528Python3+Sympy\u5b9e\u73b0\u7684\u6c42\u9012\u63a8\u7cfb\u6570\u7684\u4ee3\u7801:\n```python\nfrom sympy import *\nx = symbols(\"x\")\nf = ((sinh(x)*cosh(x)*exp(x))**4).diff().diff().diff().diff()\ncoefs = []\nfor i in range(20):\n    coefs.append(f.subs([(x, 0)]))\n    f = f.diff()\nprint(coefs)\n\neqs = []\nxs = list([symbols(\"x%d\" % i) for i in range(8)])\nA = 4 # \u5047\u8bbe\u7684\u9012\u63a8\u7cfb\u6570\nfor i in range(A+4):\n    a = 0\n    for j in range(i, i+A):\n        a += xs[j-i]*coefs[j]\n    eqs.append(Eq(a, coefs[i+A]))\nprint(eqs)\nprint(solve(eqs))\n\n```\n\n\u4f7f\u7528\u77e9\u9635\u4e58\u6cd5\u901a\u8fc7\u672c\u9898\u7684\u4ee3\u7801(\u7531\u4e8e\u6211\u4e00\u5f00\u59cb\u6ca1\u6709\u6ce8\u610f\u5230\u6211\u8bfb\u5165\u51fd\u6570\u5199\u6302\u4e86\u6545\u7528\u4e86\u5927\u91cf\u5361\u5e38\u624b\u6bb5):\n\n```cpp\n// luogu-judger-enable-o2\n// luogu-judger-enable-o2\n#pra\\\ngma GCC optimi\\\nze(\"Ofast\")\n#include <assert.h>\n#include <algorithm>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\nusing int_t = unsigned long long int;\nusing std::cin;\nusing std::cout;\nusing std::endl;\nconst int_t mod = 1e9;\n\nstruct Matrix {\n    int data[4][4];\n    int n, m;\n    Matrix() {\n        n = m = 0;\n        // memset(data, 0, sizeof(data));\n    }\n    Matrix(int n, int m) {\n        this->n = n;\n        this->m = m;\n        // memset(data, 0, sizeof(data));\n#ifdef DEBUG\n        cout << \"n=\" << n << \",m=\" << m << endl;\n#endif\n    }\n    __attribute__((hot)) Matrix operator*(const Matrix& mat) {\n        Matrix result(n, mat.m);\n        for (short i = 0; i < n; i++) {\n            for (short j = 0; j < mat.m; j++) {\n                int_t sum = 0;\n                for (short k = 0; k < m; k++) {\n                    sum += (int_t)data[i][k] * mat.data[k][j];\n                }\n                result.data[i][j] = sum % mod;\n            }\n        }\n        return result;\n    }\n    Matrix operator^(const Matrix& mat) {\n        Matrix result(n, mat.m);\n        result.data[0][0] = ((int_t)data[0][0] * mat.data[0][0] +\n                             (int_t)data[0][1] * mat.data[1][0] +\n                             (int_t)data[0][2] * mat.data[2][0] +\n                             (int_t)data[0][3] * mat.data[3][0]) %\n                            mod;\n        result.data[0][1] = ((int_t)data[0][0] * mat.data[0][1] +\n                             (int_t)data[0][1] * mat.data[1][1] +\n                             (int_t)data[0][2] * mat.data[2][1] +\n                             (int_t)data[0][3] * mat.data[3][1]) %\n                            mod;\n        result.data[0][2] = ((int_t)data[0][0] * mat.data[0][2] +\n                             (int_t)data[0][1] * mat.data[1][2] +\n                             (int_t)data[0][2] * mat.data[2][2] +\n                             (int_t)data[0][3] * mat.data[3][2]) %\n                            mod;\n        result.data[0][3] = ((int_t)data[0][0] * mat.data[0][3] +\n                             (int_t)data[0][1] * mat.data[1][3] +\n                             (int_t)data[0][2] * mat.data[2][3] +\n                             (int_t)data[0][3] * mat.data[3][3]) %\n                            mod;\n\n        return result;\n    }\n    int* operator[](int r) { return data[r]; }\n};\ntemplate <class T>\nvoid write(T x) {\n    if (x > 9) write(x / 10);\n    putchar('0' + x % 10);\n}\nMatrix base(1, 4), trans(4, 4);\nMatrix pows[128];\nint main() {\n    base[0][0] = 24;\n    base[0][1] = 480;\n    base[0][2] = 7680;\n    base[0][3] = 107520;\n    trans[1][0] = 1;\n    trans[2][1] = 1;\n    trans[3][2] = 1;\n    trans[0][3] = 1536;\n    trans[1][3] = mod - 320;\n    trans[2][3] = mod - 80;\n    trans[3][3] = 20;\n\n    pows[0] = trans;\n    for (int i = 1; i < 128; i++) {\n        pows[i] = pows[i - 1] * pows[i - 1];\n    }\n    int counter = 0;\n    while (true) {\n        int_t x;\n        cin>>x;\n        if (x == 0) break;\n        counter++;\n        if (counter > 200000) break;\n        if (x < 4) {\n            cout << 0 << endl;\n            continue;\n        }\n        x -= 4;\n        assert(x >= 0);\n        Matrix result = base;\n        int bit = 0;\n        while (x) {\n            if (x & 1) result = result ^ pows[bit];\n            bit++;\n            x >>= 1;\n        }\n        write(result.data[0][0]);\n        putchar('\\n');\n    }\n    return 0;\n}\n```\n\n\u4f7f\u7528\u7279\u5f81\u65b9\u7a0b\u901a\u8fc7\u672c\u9898\u7684\u4ee3\u7801:\n\n```cpp\n#pragma GCC target(\"avx2,sse\")\n#include <assert.h>\n#include <cctype>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\nusing int_t = unsigned long long int;\nusing std::cin;\nusing std::cout;\nusing std::endl;\n\nconst int mod = 1e9;\nconst int phi = 400000000;\ntemplate <class T>\nvoid read(T& x) {\n    x = 0;\n    char chr = getchar();\n    assert(chr != '-');\n    int counter = 0;\n    while (isdigit(chr) == false) {\n        int curr = getchar();\n        if (curr == -1) return;\n        chr = curr;\n        counter++;\n        assert(counter <= 10);\n    }\n    while (isdigit(chr)) {\n        x = x * 10 + (chr - '0');\n        chr = getchar();\n    }\n}\ntemplate <class T>\nvoid write(T x) {\n    assert(x >= 0);\n    if (x > 9) write(x / 10);\n    putchar('0' + x % 10);\n}\nint main() {\n    int counter = 0;\n    while (true) {\n        int_t x;\n        read(x);\n        if (x == 0) break;\n        counter += 1;\n        assert(counter <= 200000);\n        if (x > phi) x = x % phi + phi;\n        if (x < 4) {\n            write(0);\n            putchar('\\n');\n            continue;\n        }\n        x -= 4;\n        int t2 = 1;\n        int t3 = 1;\n        int b3 = 3, b2 = 2;\n        int index = x;\n        while (index) {\n            t2 = (int_t)t2 * ((index & 1) ? b2 : 1) % mod;\n            t3 = (int_t)t3 * ((index & 1) ? b3 : 1) % mod;\n            b3 = (int_t)b3 * b3 % mod;\n            b2 = (int_t)b2 * b2 % mod;\n            index >>= 1;\n        }\n        int t4 = (int_t)t2 * t2 % mod;\n        int result = ((int_t)((x & 1) ? (mod - 1) : 1) + (int_t)81 * t3 + 6 -\n                      (int_t)64 * t2 % mod + mod) %\n                     mod * t4 % mod;\n        write(result);\n        putchar('\\n');\n    }\n    return 0;\n}\n```",
        "postTime": 1550994038,
        "uid": 56891,
        "name": "officeyutong",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2012 \u3010\u62ef\u6551\u4e16\u754c2\u3011"
    },
    {
        "content": "[\u66f4\u597d\u4f53\u9a8c](https://www.cnblogs.com/caijiLYC/p/14354710.html)  \n[\u94fe\u63a5](https://www.luogu.com.cn/problem/P2012)  \n\u554a\uff0c\u62ef\u6551\u4e86\u4e00\u6b21\u4e16\u754c\u540e\u6211\u4eec\u518d\u62ef\u6551\u4e00\u6b21  \n\u53d1\u73b0\u8fd9\u9898\u7684\u65b9\u6848\u662f\u548c\u6392\u5217\u6709\u5173\u7684\uff0c\u6bcf\u79cd\u57fa\u56e0\u51fa\u73b0\u4f4d\u7f6e\u4e0d\u540c\u89c6\u4e3a\u4e0d\u540c\u65b9\u6848\uff0c\u6240\u4ee5\u4f7f\u7528\u6307\u6570\u751f\u6210\u51fd\u6570  \n\u4e00\u770b\u9898\u9762\uff0c\u53d1\u73b0\u548c\u62ef\u6551\u4e00\u5dee\u4e0d\u591a\uff0c\u4ecd\u7136\u8ba9\u6307\u6570\u4e3a\u4f7f\u7528\u4e2a\u6570\uff0c\u7cfb\u6570\u4e3a\u7b54\u6848\uff0c\u5217\u51fa\u5982\u4e0b\u4e09\u4e2a\u65b9\u7a0b(\u6ce8\u610f\u662f\u4e09\u4e2a\uff0c\u4e00\u5f00\u59cb\u7528\u4e24\u4e2a\u63a8\u63a8\u4e86\u4e2a\u5bc2\u5bde(\u4e0d\u8fc7\u4f30\u8ba1\u4e5f\u5c31\u6211\u8fd9\u4e48\u50bb))  \n$$\\sum_{i}{\\frac{x^i}{i!}}$$\n$$\\frac{x}{1!}+\\frac{x^3}{3!}+\\frac{x^5}{5!}+\u2026\u2026=\\sum_{i}{\\frac{x^{2*i+1}}{(2*i+1)!}}$$\n$$1+\\frac{x^2}{2!}+\\frac{x^4}{4!}+\u2026\u2026=\\sum_{i}{\\frac{x^{2*i}}{(2*i)!}}$$\n\u5176\u4e2d\u7b2c\u4e00\u6761\u548c\u7b2c\u4e8c\u6761\u53ef\u4ee5\u5c06$-x$\u5e26\u5165\u7b2c\u4e09\u6761\u76f8\u51cf\u6216\u76f8\u52a0\u540e\u83b7\u5f97\uff0c\u5927\u5bb6\u90fd\u4f1a\uff0c\u4e0d\u8d58\u8ff0\u4e86  \n\u5148\u7528\u5947\u602a\u516c\u5f0f\u5316\u7b80\u4e00\u4e0b\n$$\n\\sum_{i}{\\frac{x^i}{i!}}=e^x$$\n$$\\sum_{i}{\\frac{x^{2*i+1}}{(2*i+1)!}}=\\frac{e^x+e^{-x}}{2}$$\n$$\\sum_{i}{\\frac{x^{2*i}}{(2*i)!}}=\\frac{e^x-e^{-x}}{2}\n$$\n\u7528\u4e58\u6cd5\u539f\u7406\u4e58\u4e00\u4e0b\uff0c\u7531\u4e8e\u90a3\u4e9b\u57fa\u56e0\u5404\u6709$4$\u79cd\uff0c\u540c\u6837\u7531\u4e58\u6cd5\u539f\u7406\u5f97\u8981\u5c06\u8fd9\u4e9b\u67ff\u5b50\u56db\u6b21\u65b9\n$$\n(e^x)^4*(\\frac{e^x+e^{-x}}{2})^4*(\\frac{e^x-e^{-x}}{2})^4$$\n$$\\frac{1}{256}*(e^x*(e^x+e^{-x})*(e^x-e^{-x}))^4$$\n$$\\frac{1}{256}*(e^{3*x}-e^{-x})^4\n$$\n\u6709\u8da3\u7684\u662f\uff0c\u6211\u4eec\u8fd9\u6b21\u91c7\u7528\u66b4\u529b\u5316\u7b80\uff0c\u76f4\u63a5\u5c06\u56db\u6b21\u65b9\u5c55\u5f00(\n$$\\frac{1}{256}*(e^{12*x}-4*e^{8*x}+6*e^{4*x}+e^{-4*x}-4)$$\n\u5bf9\u4e8e\u6bcf\u4e00\u9879\uff0c\u7528\u5947\u602a\u516c\u5f0f\u53cd\u8fc7\u6765\u63a8\n$$\\frac{1}{256}*(\\sum{\\frac{(12*x)^i}{i!}}-4*\\sum{\\frac{(8*x)^i}{i!}}+6*\\sum{\\frac{(4*x)^i}{i!}}+\\sum{\\frac{(-4*x)^i}{i!}}-4)$$\n\u56e0\u4e3a\u7b54\u6848\u5c31\u662f\u7b2c$n$\u9879\u7684\u7cfb\u6570\uff0c\u6240\u4ee5\u4ee3\u5165$n$\uff0c\u53d6\u51fa\u7cfb\u6570\n$$\\frac{1}{256}*(\\frac{12^n}{n!}-4*\\frac{8^n}{n!}+6*\\frac{4^n}{n!}+\\frac{(-4)^n}{n!})$$\n\u56e0\u4e3a\u662f$EGF$\u6700\u540e\u4e58\u4e0a$n!$\n\u5c31\u662f\n$$\n\\frac{1}{256}*(12^n-4*8^n+6*4^n+(-4)^n)$$\n$$81*12^{n-4}-4*8^{n-2}+6*4^{n-4}+(-4)^{n-4}\n$$\n\u90a3\u4e48\u8fd9\u6761\u67ff\u5b50\u5df2\u7ecf\u53ef\u4ee5\u505a\u4e86  \n\u4f46\u662f\u7531\u4e8e\u9898\u76ee\u6076\u81ed\uff0c\u76f4\u63a5\u505a\u662f\u4f1a$T$\u7684\uff0c\u6b64\u65f6\u5c31\u9700\u8981\u6269\u5c55\u6b27\u62c9\u5b9a\u7406\u4f18\u5316\u4e00\u4e0b  \n\u79d1\u666e\u4e00\u4e0b[\u7b11](https://oi-wiki.org/math/fermat/)  \n\u5176\u5b9e\u8fd8\u6709\u4e0d\u5c11\u65b9\u6cd5\uff0c\u5927\u5bb6\u7528\u7684\u90fd\u4e0d\u4e00\u6837\u554a\n```c++\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#define ll long long\nusing namespace std;\nconst ll mod=1e9,phi=4e8; \nll n,m,ans,T;\n\ninline ll ksm(ll x,ll k){\n\tll tmp=1;\n\twhile(k>0){\n\t\tif(k&1)tmp=tmp*x%mod;\n\t\tx=x*x%mod,k>>=1;\n\t}\n\treturn tmp;\n}\n\nint main(){\n\tscanf(\"%lld\",&n);\n\twhile(n){\n\t\tans=0;\n\t\tif(n<4)printf(\"0\\n\");\n\t\telse if(n<phi){\n\t\t\tans=(81*ksm(12,n-4)%mod-ksm(8,n-2)+6*ksm(4,n-4)+ksm(-4,n-4)+mod)%mod;\n\t\t\tprintf(\"%lld\\n\",ans);\n\t\t}\n\t\telse {\n\t\t\tans=(ans+81*ksm(12,(n-4)%phi+phi)%mod)%mod;\n\t\t\tans=(ans-ksm(8,(n-2)%phi+phi)+mod)%mod;\n\t\t\tans=(ans+6*ksm(4,(n-4)%phi+phi)%mod)%mod;\n\t\t\tll tmp=ksm(4,(n-4)%phi+phi);\n\t\t\tif((n-4)%2==1)ans=(ans-tmp+mod)%mod;\n\t\t\telse ans=(ans+tmp)%mod;\n\t\t\tprintf(\"%lld\\n\",ans);\n\t\t}\n\t\tscanf(\"%lld\",&n);\n\t}\n}\n```",
        "postTime": 1612108209,
        "uid": 251882,
        "name": "\u849f\u84bb\u4e01",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2012 \u3010\u62ef\u6551\u4e16\u754c2\u3011"
    },
    {
        "content": "\u6211\u4eec\u5c06\u5143\u7d20\u5206\u4e3a\u56db\u7c7b\u3002\n\n* O \u7c7b\uff1aA\u3001C\u3001G\u3001T\n* A \u7c7b\uff1a\u4e7e\u3001\u574e\u3001\u826e\u3001\u9707\n* B \u7c7b\uff1a\u5764\u3001\u5151\u3001\u79bb\u3001\u5dfd\n\n\u5176\u7ec4\u5408\u7c7b\u5206\u522b\u4e3a $\\mathcal{O}$\u3001$\\mathcal{A}$ \u548c $\\mathcal{B}$\u3002\u6211\u4eec\u9700\u8981\u5bf9\u8fd9\u56db\u7c7b\u5143\u7d20\u8fdb\u884c**\u6807\u53f7\u79ef**\u800c\u4e0d\u662f**\u7ec4\u5408\u79ef**\uff0c\u56e0\u6b64\u4f7f\u7528\u6709\u6807\u53f7\u8ba1\u6570\uff0c\u751f\u6210\u51fd\u6570\u4e3a EGF\u3002\n\nO \u7c7b\u7684 EGF $\\hat O(x)$ \u4e3a\uff1a\n\n$$\n\\begin{aligned}\n\\hat O(x)&=\\sum_{n \\ge 0}\\dfrac{x^n}{n!}\\\\\n&=\\gdef\\ex#1{\\mathrm e^{#1}}\\mathrm e^x\n\\end{aligned}\n$$\n\nA \u7c7b\u7684 EGF $\\hat A(x)$ \u4e3a\uff1a\n\n$$\n\\hat A(x)=\\sum_{\\begin{subarray}{c}n \\ge 0\\\\n \\equiv 1 \\pmod 2\\end{subarray}}\\dfrac{x^n}{n!}\n$$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u600e\u4e48\u5316\u7b80\uff1f\u8003\u8651\u4e00\u4e2a\u751f\u6210\u51fd\u6570 $G(x)=\\displaystyle\\sum_{n \\ge 0}g_nx^n$\uff0c\u90a3\u4e48\uff1a\n\n$$\n\\begin{aligned}\nG(x)+G(-x)&=\\left(\\sum_{n \\ge 0}g_nx^n\\right)+\\left(\\sum_{n \\ge 0}g_n(-x)^n\\right)\\\\\n&=\\sum_{n \\ge 0}g_n(1+(-1)^n)x^n\\\\\n&=\\sum_{n \\ge 0}2g_n[n \\equiv 0 \\pmod 2]x^n\\\\\n&=2\\sum_{n \\ge 0}g_n[n \\equiv 0 \\pmod 2]x^n\n\\end{aligned}\n$$\n\n\u90a3\u4e48 $\\displaystyle\\sum_{\\begin{subarray}{c}n \\ge 1\\\\n\\equiv 0 \\pmod 2\\end{subarray}}g_nx^n=\\dfrac{G(x)+G(-x)}{2}$\u3002\u540c\u7406\u6709 $\\displaystyle\\sum_{\\begin{subarray}{c}n \\ge 1\\\\n\\equiv 1 \\pmod 2\\end{subarray}}g_nx^n=\\dfrac{G(x)-G(-x)}{2}$\u3002\n\n\u7531\u6b64\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 $\\hat A(x)=\\dfrac{O(x)-O(-x)}{2}=\\dfrac{\\mathrm e^x-\\mathrm e^{-x}}{2}$\uff0c\u4e14 B \u7c7b\u7684 EGF $\\hat B(x)=\\dfrac{O(x)+O(-x)}{2}=\\dfrac{\\mathrm e^x+\\mathrm e^{-x}}{2}$\n\n\u73b0\u5728\u628a\u8fd9\u4e9b\u5143\u7d20\u505a\u7b1b\u5361\u5c14\u79ef\uff0c\u5f97\u5230\u7ed3\u679c\u7684 EGF $\\hat F(x)$\uff1a\n\n$$\n\\begin{aligned}\n\\hat F(x)&=\\hat O(x)^4\\hat A(x)^4\\hat B(x)^4\\\\\n&=(\\mathrm e^x)^4\\left(\\dfrac{\\mathrm e^x+\\mathrm e^{-x}}{2}\\right)^4\\left(\\dfrac{\\mathrm e^x-\\mathrm e^{-x}}{2}\\right)^4\\\\\n&=\\mathrm e^{4x}\\left(\\left(\\dfrac{\\mathrm e^x}{2}+\\dfrac{\\mathrm e^{-x}}{2}\\right)\\left(\\dfrac{\\mathrm e^x}{2}-\\dfrac{\\mathrm e^{-x}}{2}\\right)\\right)^4\\\\\n&=\\mathrm e^{4x}\\left(\\dfrac{\\mathrm e^{2x}}{4}-\\dfrac{\\mathrm e^{-2x}}{4}\\right)^4\\\\\n&=\\dfrac{1}{256}\\mathrm e^{4x}(\\mathrm e^{2x}-\\mathrm e^{-2x})^4\\\\\n&=\\dfrac{1}{256}\\mathrm e^{4x}(\\mathrm e^{-8x}-4\\mathrm e^{2x}\\mathrm e^{-6x}+6\\mathrm e^{4x}\\mathrm e^{-4x}-4\\mathrm e^{6x}\\mathrm e^{-2x}+\\mathrm e^{8x})\\\\\n&=\\dfrac{1}{256}\\mathrm e^{4x}(\\mathrm e^{-8x}-4\\mathrm e^{-4x}+6-4\\mathrm e^{4x}+\\mathrm e^{8x})\\\\\n&=\\dfrac{1}{256}(\\mathrm e^{-4x}-4+6\\mathrm e^{4x}-4\\mathrm e^{8x}+\\mathrm e^{12x})\\\\\n&=\\dfrac{\\mathrm e^{12x}-4\\mathrm e^{8x}+6\\mathrm e^{4x}+\\mathrm e^{-4x}-4}{256}\n\\end{aligned}\n$$\n\n\u90a3\u4e48\uff1a\n\n$$\n\\begin{aligned}\n\\left[\\dfrac{x^n}{n!}\\right]\\hat F(x)&=\\dfrac{1}{256}\\left(-4+\\sum_{n \\ge 0}(12^n-4 \\times 8^n+6 \\times 4^n+(-4)^n)\\dfrac{x^n}{n!}\\right)\\\\\n&=\\dfrac{12^n-4 \\times 8^n+6 \\times 4^n+(-4)^n}{256}\n\\end{aligned}\n$$\n\n\u6839\u636e\u9e3d\u5de2\u539f\u7406\uff0c\u672c\u9898\u7684\u7b54\u6848\u6b63\u662f $\\left[\\dfrac{x^n}{n!}\\right]\\hat F(x)$\u3002\n\n\u4f46\u662f $256$ \u5728\u6a21 $10^9$ \u610f\u4e49\u4e0b\u6ca1\u6709\u4e58\u6cd5\u9006\u5143\u3002\u4e0d\u8fc7\u6211\u4eec\u53d1\u73b0\uff0c\u6bcf\u4e2a\u4e58\u65b9\u7684\u5e95\u6570\u5747\u542b\u6709\u56e0\u5b50 $4$\uff0c\u628a $n$ \u52a0\u4e0a $4$ \u5c31\u53ef\u4ee5\u628a\u5206\u6bcd\u6d88\u6389\u4e86\u3002\n\n$$\n\\begin{aligned}\n\\left[\\dfrac{x^{n+4}}{n!}\\right]\\hat F(x)&=\\dfrac{12^{n+4}-4 \\times 8^{n+4}+6 \\times 4^{n+4}+(-4)^{n+4}}{256}\\\\\n&=\\dfrac{20736 \\times 12^n-16384 \\times 8^n+1536 \\times 4^n+256 \\times (-4)^n}{256}\\\\\n&=81 \\times 12^n-64 \\times 8^n+6 \\times 4^n+(-4)^n\n\\end{aligned}\n$$\n\n\u5f53 $n<4$ \u65f6\u7b54\u6848\u663e\u7136\u4e3a $0$\u3002\u56e0\u6b64\uff1a\n\n$$\n\\left[\\dfrac{x^n}{n!}\\right]\\hat F(x)=\\begin{cases}81 \\times 12^{n-4}-64 \\times 8^{n-4}+6 \\times 4^{n-4}+(-4)^{n-4}&n \\ge 4\\\\0&n<4\\end{cases}$$\n\n\u5149\u901f\u5e42\u5373\u53ef\u3002\n$$",
        "postTime": 1658466838,
        "uid": 370281,
        "name": "m256i",
        "ccfLevel": 0,
        "title": "[\u9898\u89e3]P2012 \u62ef\u6551\u4e16\u754c2"
    },
    {
        "content": "\u7531\u4e8e\u4e0d\u662f\u7ec4\u5408\uff0c\u6240\u4ee5\u4e0d\u80fd\u591f\u7528 OGF\uff0c\u4e8e\u662f\u6211\u4eec\u8003\u8651 EGF\u3002\n\n\u5bf9\u4e8e `A,C,G,T` \u56db\u79cd\uff1a $G_1(i)=\\sum\\limits_{i=0}^{\\infty}\\frac{x^i}{i!}=e^x$\n\n\u5bf9\u4e8e\u4e7e\u3001\u574e\u3001\u826e\u3001\u9707\uff1a $G_2(i)=\\sum\\limits_{i=0}^{\\infty}\\frac{x^{2i}}{(2i)!}=\\frac{1}{2}(e^x+e^{-x}) \\ $ \uff08$e^{-x}=\\sum\\limits_{i=0}^{\\infty}\\frac{(-1)^ix^i}{i!}$\uff0c\u4e24\u4e2a\u76f8\u52a0\u5373\u53ef\u62b5\u6d88\u5947\u6570\uff09\u3002\n\n\u5269\u4e0b\u90a3\u79cd\uff1a $G_3(i)=\\sum\\limits_{i=0}^{\\infty}\\frac{x^{2i+1}}{(2i+1)!}=e^x-G_2(x)=\\frac{1}{2}(e^x-e^{-x})$\n\n\u4e8e\u662f\uff1a\n\n$$\\begin{aligned}G(x)&= (G_1(x)G_2(x)G_3(x))^4\\\\&=(\\frac{1}{4}e^x(e^x+e^{-x})(e^x-e^{-x}))^4\\\\&=\\frac{1}{2^8}(e^{3x}-e^{-x})^4\\\\&=\\frac{1}{2^8}(e^{12x}-4e^{8x}+6e^{4x}-4+e^{-4x})\\end{aligned}$$\n\n\u7136\u540e\u6211\u4eec\u8981\u6c42\u7684\u662f $G(x)$ \u4e2d $x^n$ \u7684\u7cfb\u6570\uff1a\n\n$$\\because e^{ax}=\\sum\\limits_{i=0}^{\\infty}\\frac{a^ix^i}{i!},[x^n]e^{ax}=\\frac{a^n}{n!}$$\n\n$$\\begin{aligned}\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\therefore G(x)ans&=n![x^n]G(x)\\\\&=\\frac{1}{2^8}(12^n-4\\times8^{n}+6\\times 4^{n}-4+(-1)^{n}\\times4^n)\\end{aligned}$$\n\n\u7136\u540e\u8fd9\u9053\u6bd2\u7624\u9898\u8fd8\u8981\u7528\u6b27\u62c9\u5b9a\u7406\uff1a\n\n$$a^b\\equiv a^{b\\mod \\varphi(p)}\\mod p$$\n\n\u7136\u540e\u6211\u4eec\u77e5\u9053 $\\varphi(10^9)=4\\times10^8$\u3002\n\n\u5148\u53d6\u6a21\uff0c\u7136\u540e\u5feb\u901f\u5e42\u5373\u53ef\u3002\n\n\u5f53 $n\\le 4$ \u7684\u65f6\u5019\u7531\u4e8e\u65e0\u6cd5\u8ba1\u7b97 $2^8$ \u7684\u9006\u5143\uff0c\u6240\u4ee5\u8981\u5355\u72ec\u62ce\u51fa\u6765\u5224\u65ad\u3002\n\n```cpp\nconst int mod = 1e9;\nconst int mp = 4e8;\n\nint n;\n\nint ksm(int p, int q) {\n\tint res = 1;\n\twhile (q) {\n\t\tif (q & 1) res = res * p % mod;\n\t\tp = p * p % mod;\n\t\tq >>= 1;\n\t}\n\treturn res;\n}\n\nsigned main() {\n\twhile (scanf(\"%lld\", &n) && n) {\n\t\tif (n <= 4) puts(n == 4 ? \"24\" : \"0\");\n\t\telse {\n\t\t\tint a = n - 4;\n\t\t\tint b = n - 2;\n\t\t\ta %= mp, b %= mp;\n\t\t\tprintf(\"%lld\\n\", (((((81 * ksm(12, a) % mod - ksm(8, b) % mod) % mod + mod) % mod + 6 * ksm(4, a) % mod) % mod + ksm(-1, a) * ksm(4, a) % mod) + mod) % mod);\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1640346172,
        "uid": 306573,
        "name": "Ender32k",
        "ccfLevel": 0,
        "title": "P2012 \u62ef\u6551\u4e16\u754c2 \u9898\u89e3"
    },
    {
        "content": "\u6210\u529f\u8dd1\u5230\u5168\u8c37\u6700\u52a3\u89e3\uff08\uff08\uff08  \n\u9996\u5148\uff0c\u6ce8\u610f\u8fd9\u4e9b\u7279\u6b8a\u57fa\u56e0\u4e0d\u9700\u8981\u5206\u522b\u7c7b\u578b\uff0c\u53ea\u9700\u8981\u5206\u522b\u5b83\u4eec\u5728\u5f53\u524d\u524d\u7f00\u91cc\u662f\u5426\u5408\u6cd5\u3002  \n\u4f8b\u5982\uff0c\u521d\u59cb\u6709\u56db\u4e2a\u5408\u6cd5\uff08\u9634\u7684\u57fa\u56e0\uff09\uff0c\u6709\u56db\u4e2a\u4e0d\u5408\u6cd5\uff08\u9633\u7684\u57fa\u56e0\uff09\u3002  \n\u5728\u57fa\u56e0\u5e8f\u5217\u7ed3\u5c3e\u52a0\u4e0a\u4efb\u610f\u4e00\u4e2a\u7279\u6b8a\u57fa\u56e0\u8981\u4e48\u4f1a\u5bfc\u81f4\u539f\u6765\u4e0d\u5408\u6cd5\u7684\u67d0\u4e2a\u57fa\u56e0\u53d8\u5408\u6cd5\uff0c\u8981\u4e48\u4f1a\u5bfc\u81f4\u76f8\u53cd\u3002  \n\u4e8e\u662f\u8003\u8651 dp\uff0c\u7b2c\u4e00\u7ef4\u662f\u5f53\u524d\u57fa\u56e0\u957f\u5ea6\uff0c\u7b2c\u4e8c\u7ef4\u662f\u6709\u591a\u5c11\u5408\u6cd5\u57fa\u56e0\uff0c\u8fb9\u754c\u662f $dp[0][i]=[i=4]$\uff0c\u60f3\u6c42\u7684\u662f $dp[n][0]$\u3002\u8f6c\u79fb\u4e5f\u5c31\u662f $dp[n][i]$ \u6709 $i$ \u79cd\u65b9\u6cd5\u5f80 $dp[n+1][i-1]$\uff08\u9009\u4e00\u4e2a\u5f53\u524d\u5408\u6cd5\u8fb9\u4e0d\u5408\u6cd5\uff09\uff0c\u6709 $8-i$ \u79cd\u65b9\u6cd5\u5f80 $dp[n+1][i+1]$\uff0c\u6709 $4$ \u79cd\u65b9\u6cd5\u5f80 $dp[n+1][i]$\u3002\u4f46\u662f\u76f4\u63a5\u66b4\u529b\u505a\u663e\u7136\u70b8\uff0c\u4e8e\u662f\u8003\u8651\u77e9\u9635\u4f18\u5316\u3002\n\n\u6734\u7d20\u77e9\u9635\u4f18\u5316\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(qk^3\\log n)$\uff0c\u663e\u7136\u8dd1\u4e0d\u8fdb\uff0c\u8003\u8651\u628a $k^3$ \u538b $k^2$\u3002\u9996\u5148\u6211\u4eec\u9884\u5904\u7406\u51fa\u6765\u8f6c\u79fb\u77e9\u9635 $z$ \u7684 $z^{k\\cdot 256^i}$ \u503c\uff0c\u53ef\u4ee5\u7528\u8fd9\u4e9b\u4e58\u8d77\u6765\uff0c\u53ea\u9700\u8981\u4e58 $O(\\frac{\\log n}{\\omega})$ \u6b21\u77e9\u9635\uff0c\u4f46\u662f\u9700\u8981 $O(\\frac{\\log n}{\\omega}2^{\\omega})$ \u7684\u9884\u5904\u7406\u77e9\u9635\u76f8\u4e58\u3002\u5728\u8fd9\u91cc\u9009\u62e9\u4e86 $\\omega=8$\u3002\n\n\u6bd5\u7adf\u6c38\u8fdc\u662f\u4e00\u4e2a\u4e00\u7ef4\u77e9\u9635\u6210\u8f6c\u79fb\u77e9\u9635\u7684\u6b21\u5e42\uff0c\u4e58\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f $O(k^2)$ \u4e86\u3002  \n\u603b\u5171\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\frac{\\log n}{\\omega}2^{\\omega}+\\frac{k^2}{\\omega}\\sum\\log n)$\u3002\n\n\u7136\u540e\u6269\u5c55\u6b27\u62c9\u5b9a\u7406\u90fd\u6ca1\u6709\u7528\u3002\u3002\u3002\u8bfb\u5165\u4f18\u5316\u90fd\u6ca1\u6709\u7528\u3002\u3002\u3002\u5faa\u73af\u5c55\u5f00\u90fd\u6ca1\u6709\u7528\u3002\u3002\u3002AC 993ms \u65f6\u9650 1000ms\uff08\uff08\uff08\n\n\u8d34\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconstexpr int mod = 1000000000;\nclass mat {\npublic:\n\tint n, m;\n\tint ar[9][9];\n\tvoid init(int _n, int _m) {\n\t\tn = _n; m = _m;\n\t\tfor(int i=0; i<_n; i++)\n\t\t\tfor(int j=0; j<_m; j++)\n\t\t\t\tar[i][j] = 0;\n\t}\n};\n\nmat mul(const mat& a, const mat& b) {\n\tassert(a.m == b.n);\n\tmat r; r.init(a.n, b.m);\n\tfor(int i=0; i<a.n; i++)\n\t\tfor(int k=0; k<b.n; k++)\n\t\t\tfor(int j=0; j<a.m; j++)\n\t\t\t\tr.ar[i][k] = (r.ar[i][k] + 1ll * a.ar[i][j] * b.ar[j][k]) % mod;\n\treturn r;\n}\n\nmat zy, uni, ans, a2;\nmat ini[8][257];\n\nint main(){\n\tzy.init(9, 9);\n\tuni.init(9, 9);\n\tfor(int valid=0; valid<9; valid++) {\n\t\tif(valid!=8) zy.ar[valid][valid+1] += 8-valid;\n\t\tif(valid!=0) zy.ar[valid][valid-1] += valid;\n\t\tzy.ar[valid][valid] += 4;\n\t\tuni.ar[valid][valid] = 1;\n\t}\n\tfor(int i=0; i<8; i++) {\n\t\tini[i][0] = uni;\n\t\tif(i) ini[i][1] = ini[i-1][256];\n\t\telse ini[i][1] = zy;\n\t\tfor(int j=2; j<=256; j++) ini[i][j] = mul(ini[i][j-1],ini[i][1]);\n\t} \n\tlong long n;\n\twhile(cin >> n && n) {\n\t\t ans.init(1,9); ans.ar[0][4] = 1;\n\t\t //ans.ar[4][0] = 1;\n\t\t int dx = 0;\n\t\t while(n) {\n\t\t \tans = mul(ans, ini[dx][n&255]);\n\t\t \tn>>=8;\n\t\t \tdx++;\n\t\t }\n\t\t cout << ans.ar[0][0] << endl;\n\t}\n}\n\n\n```",
        "postTime": 1599441699,
        "uid": 220037,
        "name": "w33z8kqrqk8zzzx33",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2012 \u3010\u62ef\u6551\u4e16\u754c2\u3011"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u9053\u5361\u5e38(\u5212\u6389)\u751f\u6210\u51fd\u6570\u7684\u597d\u9898\u3002\n\n\u56e0\u4e3a\u9898\u76ee\u8981\u6c42\u7684\u662f\u6709\u5e8f\u5e8f\u5217\u3002\u6240\u4ee5\u6211\u4eec\u91c7\u7528EGF(\u6307\u6570\u578b\u751f\u6210\u51fd\u6570)\u6765\u505a\u3002\n\n\u5bb9\u6613\u770b\u51fa\u3002\u4e09\u4e2a\u7c7b\u578b\u7684\u57fa\u56e0\u5e8f\u5217\u5bf9\u5e94\u7684\u751f\u6210\u51fd\u6570\u5206\u522b\u662f\n\nA(x)=1+x+x^2/2!+x^3/3!+x^4/4!+...=e^x\n\nB(x)=x+x^3/3!+x^5/5!+x^7/7!+...    =1/2(e^x-e^-x)\n\nC(x)=1+x^2/2!+x^4/4!+x^6/6!+...   =1/2(e^x+e^-x)\n\n\u7531\u4e8e\u6bcf\u7c7b\u57fa\u56e0\u90fd\u6709\u56db\u79cd\u3002\u56e0\u6b64\u7b54\u6848\u7684\u751f\u6210\u51fd\u6570\u5c31\u662f(ABC)^4\n\n\u6211\u4eec\u66b4\u529b\u5c55\u5f00\u4e00\u4e0b\u3002\u5f97\u5230\u4e0b\u9762\u8fd9\u4e2a\u5f0f\u5b50\uff1a\n\n(e^12x - 4\\*e^8x + 6\\*e^4x + e^-4x - 4)/256\n\n\u5c06\u6bcf\u4e00\u9879\u9ea6\u514b\u52b3\u6797\u5c55\u5f00\u3002\u518d\u9010\u9879\u5408\u5e76\u3002\u6211\u4eec\u5f97\u5230n>1\u7b54\u6848\u4e3a\n\n(12^n-4\\*8^n+6\\*4^n+(-4)^n)/256\n\n\u76f4\u63a5\u8ba1\u7b97\u5373\u53ef\u3002\n\n\n\u5410\u69fd\uff1a\u8fd9\u9898\u5361\u5e38\u5361\u5f97\u6211\u5410\u8840\u3002\u6700\u540e\u53d1\u73b0\u53bb\u6389\u4e00\u4e2a b=n; \u8d4b\u503c\u5c31\u53ef\u4ee5\u8fc7\u4e86\u3002\u6211\u4e5f\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u3002\n",
        "postTime": 1497335380,
        "uid": 17993,
        "name": "demerzel_iv",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2012 \u3010\u62ef\u6551\u4e16\u754c2\u3011"
    },
    {
        "content": "\u4e0b\u6587\u4ee4 $m=8$\u3002\n\n## \u7b97\u6cd5 1\n\n\u679a\u4e3e\u6bcf\u4e2a\u4f4d\u7f6e\u57fa\u56e0\uff0c\u6700\u540e\u5224\u65ad\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(Tm^n)$\uff0c\u671f\u671b\u5f97\u5206 $0$\u3002\n\n## \u7b97\u6cd5 2\n\n\u8003\u8651 dp\uff0c\u8bbe $f_{i,j}$ \u4e3a\u524d $i$ \u4e2a\u57fa\u4e8e\u6709 $j$ \u4e2a\u6761\u4ef6\u5408\u6cd5\u7684\u3002\n\n\u666e\u901a\u57fa\u4e8e\u5bf9\u4e8e\u72b6\u6001\u6ca1\u6709\u5f71\u54cd\uff0c\u6709 $4\\times f_{i-1,j}$ \u79cd\u65b9\u6848\u3002\u9634\u9633\u72b6\u6001\u672c\u8d28\u6ca1\u6709\u533a\u522b\uff1a\u5982\u679c\u589e\u52a0\u4e86\u5408\u6cd5\u72b6\u6001\uff0c\u90a3\u4e48\u4e0a\u4e00\u6b21\u6709 $j-1$ \u79cd\u5408\u6cd5\u72b6\u6001\uff0c$8-(j-1)=9-j$ \u79cd\u4e0d\u5408\u6cd5\u72b6\u6001\uff0c\u6709 $(9-j)\\times f_{i-1,j-1}$ \u79cd\u65b9\u6848\uff1b\u5982\u679c\u51cf\u5c11\u4e86\u5408\u6cd5\u72b6\u6001\uff0c\u90a3\u4e48\u4e0a\u4e00\u6b21\u6709 $j+1$ \u79cd\u5408\u6cd5\u72b6\u6001\uff0c\u6709 $(j+1)\\times f_{i-1,j+1}$ \u79cd\u65b9\u6848\u3002\n\n$$f_{i,j}=4\\times f_{i-1,j}+(9-j)\\times f_{i-1,j-1}+(j+1)\\times f_{i-1,j+1}$$\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(Tnm)$\uff0c\u671f\u671b\u5f97\u5206 $10$\u3002\n\n## \u7b97\u6cd5 3\n\n\u53d1\u73b0\u4e0a\u5348\u8f6c\u79fb\u65b9\u7a0b\u53ef\u4ee5\u5199\u6210\u77e9\u9635\u5f62\u5f0f\uff1a\n\n$$\n\\begin{pmatrix}\n4,1,0,0,0,0,0,0,0 \\\\\n8,4,2,0,0,0,0,0,0 \\\\\n0,7,4,3,0,0,0,0,0 \\\\\n0,0,6,4,4,0,0,0,0 \\\\\n0,0,0,5,4,5,0,0,0 \\\\\n0,0,0,0,4,4,6,0,0 \\\\\n0,0,0,0,0,3,4,7,0 \\\\\n0,0,0,0,0,0,2,4,8 \\\\\n0,0,0,0,0,0,0,1,4 \\\\\n\\end{pmatrix}\n\\times\n\\begin{pmatrix}\nf_{i-1,0}\\\\\nf_{i-1,1}\\\\\nf_{i-1,2}\\\\\nf_{i-1,3}\\\\\nf_{i-1,4}\\\\\nf_{i-1,5}\\\\\nf_{i-1,6}\\\\\nf_{i-1,7}\\\\\nf_{i-1,8}\\\\\n\\end{pmatrix}\n\n=\n\\begin{pmatrix}\nf_{i,0}\\\\\nf_{i,1}\\\\\nf_{i,2}\\\\\nf_{i,3}\\\\\nf_{i,4}\\\\\nf_{i,5}\\\\\nf_{i,6}\\\\\nf_{i,7}\\\\\nf_{i,8}\\\\\n\\end{pmatrix}\n$$\n\n\u77e9\u9635\u5feb\u901f\u5e42\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(Tm^3\\log n)$\uff0c\u671f\u671b\u5f97\u5206 $50$\u3002\n\n## \u7b97\u6cd5 3 plus\n\n\u8bbe $p=10^9$\uff0c\u539f $9\\times 9$ \u7684\u77e9\u9635\u4e3a $A$\u3002\n\n\u8003\u8651\u62d3\u5c55\u6b27\u62c9\u5b9a\u7406\u964d\u5e42\uff1a\n\n$$a^b\\equiv\\begin{cases}a^b&b<\\varphi(p)\\\\a^{b\\bmod\\varphi(p)+\\varphi(p)}&b\\leq\\varphi(p)\\end{cases}\\text{ }(\\bmod\\text{ }p)$$\n\n\u90a3\u4e48\u6700\u540e\u964d\u5e42\u540e $a^b\\equiv a^c$\uff0c$c\\leq 2\\times\\varphi(p)$\u3002\n\n\u7136\u540e\u5b9a\u4e00\u4e2a $B$\uff0c\u9884\u5904\u7406 $A$ \u7684 $1\\sim B$ \u6b21\u65b9\u4e0e $A^{B}$ \u7684 $1\\sim \\lfloor2\\times\\varphi(p)/B\\rfloor$ \u6b21\u65b9\u3002\u56e0\u4e3a $A^{x}=A^{x\\bmod B}\\times A^{B\\times\\lfloor x/B\\rfloor}$\uff0c\u800c\u4e24\u8005\u90fd\u9884\u5904\u7406\u8fc7\u4e86\uff0c\u4e00\u6b21\u4e58\u6cd5\u5373\u53ef\u6c42\u51fa $A^{x}$\u3002\n\n\u9884\u5904\u7406\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\mathcal{O}(B+\\lfloor2\\times\\varphi(p)/B\\rfloor)$\uff0c$B$ \u53d6 $\\sqrt{2\\times\\varphi(p)}$ \u6700\u4f18\u3002\u56e0\u4e3a\u6d6e\u70b9\u6570\u8f6c\u6574\u5f62\u5411\u4e0b\u53d6\u6574\uff0c\u6240\u4ee5\u4ee4 $B=\\sqrt{2\\times\\varphi(p)}+1$\u3002\u9884\u5904\u7406\u4e00\u4e0b\u5c31\u53ef\u4ee5 $\\mathcal{O}(m^3)$ \u8ba1\u7b97\u7b54\u6848\u3002\n\n\u8fd9\u4e2a\u597d\u50cf\u53eb\u505a\u300c\u5149\u901f\u5e42\u300d\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(m^3(\\sqrt{p}+T))$\uff0c\u671f\u671b\u5f97\u5206 $100$\uff08\u5f97\u5361\u4e00\u4e0b\u5e38\uff09\u3002\n\n~~\u53c8\u7528\u84dd\u9898\u7684\u505a\u6cd5\u6c34\u4e86\u4e00\u9053\u9ed1\u9898\u3002~~\n\n\u4ee3\u7801\u89c1\u6587\u672b\u3002\n\n## \u7b97\u6cd5 4\n\n\u53c2\u8003\u4e86\u5176\u4ed6\u9898\u89e3\uff1a\n\n\u95ee\u9898\u5176\u5b9e\u662f\u6c42\u6392\u5217\u6570\uff0c\u8003\u8651\u6307\u6570\u751f\u6210\u51fd\u6570\u3002\n\n\u6784\u9020\u751f\u6210\u51fd\u6570\uff08\u666e\u901a\u4e3a $F$\uff0c\u9633\u4e3a $G$\uff0c\u9634\u4e3a $H$\uff09\uff1a\n\n$$F(x)=\\left(\\sum_{i=0}^{\u221e}\\frac{x^i}{i!}\\right)^4=e^{4x}$$\n$$G(x)=\\left(\\sum_{i=0}^{\u221e}\\frac{x^{2i+1}}{(2i+1)!}\\right)^4=\\frac{1}{16}(e^{x}-e^{-x})^4$$\n$$H(x)=\\left(\\sum_{i=0}^{\u221e}\\frac{x^{2i}}{(2i)!}\\right)^4=\\frac{1}{16}(e^{x}+e^{-x})^4$$\n\n\u4e09\u79cd\u90fd\u6ee1\u8db3\u7684\u6392\u5217\u7684\u751f\u6210\u51fd\u6570\u5c31\u662f $A(x)=F(x)G(x)H(x)$\u3002\n\n$$A(x)=e^{4x}\\times\\frac{1}{16}(e^{x}-e^{-x})^4\\times\\frac{1}{16}(e^{x}+e^{-x})^4=\\frac{1}{256}(e^{3x}-e^{-x})^4$$\n$$A(x)=\\frac{1}{256}(e^{-4x}-4+6e^{4x}-4e^{8x}+e^{12x})$$\n\n\u7b54\u6848\u53d6\u5176 $n$ \u6b21\u9879\u7cfb\u6570\uff0c\u8fd8\u8981\u4e58 $n!$\u3002\u5373\u4e3a\uff1a\n\n$$\\frac{1}{256}((-4)^{n}+6\\times4^{n}-4\\times8^{n}+12^{n})$$\n\n\u56e0\u4e3a\u6a21\u6570 $10^9$\u975e\u5e38\u9b3c\u755c\uff0c\u53ef\u4ee5\u5316\u5f0f\u5b50\u4e3a\uff1a\n\n$$((-4)^{n-4}+6\\times4^{n-4}-8^{n-2}+81\\times12^{n-4})$$\n\n\u7136\u540e\u4f7f\u7528\u7b97\u6cd5 3 plus \u7684\u5149\u901f\u5e42\u8ba1\u7b97\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(\\sqrt p+T)$\u3002\n\n## Code\n\n\u77e9\u9635\u5feb\u901f\u5e42\uff0c[3.54s](https://www.luogu.com.cn/record/100421128)\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\nconst int N = 1e5 + 5, mod = 1e9;\nstruct matrix {\n\tLL a[12][12];\n\tmatrix operator * (matrix x) {\n\t\tmatrix c;\n\t\tmemset(c.a, 0, sizeof c.a);\n\t\tfor (int i = 0; i <= 8; i ++)\n\t\t\tfor (int k = 0; k <= 8; k ++)\n\t\t\t\tfor (int j = 0; j <= 8; j ++)\n\t\t\t\t\tc.a[i][j] = (c.a[i][j] + a[i][k] * x.a[k][j]) % mod;\n\t\treturn c;\n\t}\n} bas, f, f1[N], f2[N];\nLL n, phi, cnt;\nmatrix query(LL k) { return f1[k % cnt] * f2[k / cnt]; }\nLL getPhi(LL k) {\n\tLL res = 1;\n\tfor (int i = 2; i * i <= k; i ++) {\n\t\tif (k % i) continue;\n\t\tres *= i - 1, k /= i;\n\t\twhile (k % i == 0) k /= i, res *= i;\n\t}\n\tif (k != 1) res *= k - 1;\n\treturn res;\n}\nint main() {\n\tios::sync_with_stdio(0);\n\tcin.tie(0), cout.tie(0);\n\tfor (int i = 0; i <= 8; i ++) {\n\t\tbas.a[i][i] = 4;\n\t\tif (i > 0) bas.a[i][i - 1] = 9 - i;\n\t\tif (i < 8) bas.a[i][i + 1] = i + 1;\n\t}\n\tphi = getPhi(mod), cnt = sqrt(phi * 2) + 1, f.a[4][0] = 1;\n\tfor (int i = 0; i <= 8; i ++) f1[0].a[i][i] = f2[0].a[i][i] = 1;\n\tfor (int i = 1; i <= cnt; i ++) f1[i] = f1[i - 1] * bas;\n\tfor (int i = 1; i <= cnt; i ++) f2[i] = f2[i - 1] * f1[cnt];\n\twhile (cin >> n, n) {\n\t\tif (n >= phi) n = n % phi + phi;\n\t\tcout << (query(n) * f).a[8][0] << '\\n';\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1674475540,
        "uid": 560516,
        "name": "\u55b5\u4ed4\u725b\u5976",
        "ccfLevel": 0,
        "title": "P2012 \u62ef\u6551\u4e16\u754c2 \u9898\u89e3"
    },
    {
        "content": "\u672c\u9898\u89e3\u4e3b\u8981\u8bf4\u4f18\u5316\uff0c\u5176\u5b83\u5c31\u4e0d\u8be6\u7ec6\u8bf4\u660e\u4e86\uff0c\u522b\u7684\u9898\u89e3\u6709\u5f88\u591a\u8bb2\u89e3\u4e86\u3002\n\n\u601d\u8def:\u770b\u5230\u8fd9\u9053\u9898\u540e\uff0c\u5f88\u660e\u663e\u4f1a\u60f3\u5230\u6307\u6570\u578b\u751f\u6210\u51fd\u6570 $\\operatorname{EGF}$\uff0c\u56e0\u4e3a\u6211\u4eec\u9700\u8981\u8003\u8651\u987a\u5e8f(\u9898\u76ee\u91cc\u8981\u6c42\u7684\u662f\u5e8f\u5217\u7684\u4e2a\u6570\u800c\u4e0d\u662f\u96c6\u5408)\u3002\n\n\u6211\u4eec\u53ea\u8981\u6c42\u51fa\u4e09\u4e2a\u9650\u5236\u7684 $\\operatorname{EGF}$ \u518d\u76f8\u4e58\uff0c\u7136\u540e\u53d6\u5176 $n$ \u6b21\u9879\u7cfb\u6570\uff0c\u6700\u540e\u4e0e $n!$ \u76f8\u4e58\u3002\n\n\u4f17\u6240\u5468\u77e5\uff0c\u6839\u636e\u6cf0\u52d2\u5c55\u5f00\uff0c$e^{cx}=\\sum_{i=0}^{\\infty}c^i\\frac{x^i}{i!}$\u3002\n\n\u6240\u4ee5\u5b83\u4eec\u7684 $\\operatorname{EGF}$ \u5206\u522b\u4e3a $e^{4x},\\frac{(e^x+e^{-x})^4}{16},\\frac{(e^x-e^{-x})^4}{16}$(\u6bcf\u79cd\u90fd\u6709\u56db\u4e2a\u6240\u4ee5\u8981\u56db\u6b21\u65b9)\u3002\n\n\u7136\u540e\u53d6\u5176 $n$ \u6b21\u9879\u7cfb\u6570\uff0c\u5e76\u4e0e $n!$ \u76f8\u4e58(\u624b\u7b97\u65f6\u5efa\u8bae\u7528\u6cf0\u52d2\u5c55\u5f00)\u3002\n\n\u6700\u540e\u7b54\u6848\u5c31\u662f $\\frac{12^n-4\\times8^n+6\\times4^n+(-4)^n}{256}$\u3002\n\n\u4f46\u6211\u4eec\u53d1\u73b0 $256$ \u548c $1000000000$ \u6709\u4e0d\u4e92\u8d28\uff0c\u6240\u4ee5 $256$ \u6ca1\u6709\u9006\u5143\u3002\n\n\u6ca1\u529e\u6cd5\uff0c\u8fd9\u80fd\u602a\u51fa\u9898\u4eba\u592a\u6bd2\u7624\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u5199\u6210 $81\\times12^{n-4}-8^{n-2}+6\\times4^{n-4}+{(-4)}^{n-4}$\u3002\n\n\u4f46 $n<4$ \u600e\u4e48\u529e?\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u679c $n<4$\uff0c\u90a3\u4e48\u4e00\u5b9a\u6ca1\u6709\u89e3\u51b3\u65b9\u6848\uff0c\u56e0\u4e3a\u4e7e\u3001\u574e\u3001\u826e\u3001\u9707\u4e00\u5b9a\u8981\u51fa\u73b0\u5947\u6570\u6b21\uff0c\u6240\u4ee5\u6700\u5c11\u4e5f\u8981 $n=4$ \u624d\u80fd\u6709\u89e3\u3002\n\n\u540e\u6765\u8bd5\u4e86\u4e00\u4e0b\uff0c\u8fd9\u91cc\u5176\u5b9e\u4e0d\u7528\u4f18\u5316\u4e5f\u80fd\u8fc7\uff0c\u4f46\u8fd8\u662f\u8bb2\u8bb2\u5404\u79cd\u4f18\u5316\u7684\u65b9\u6cd5\u3002\n\n### \u4f18\u53160 \u4e0d\u4f18\u5316\n\n\u6700\u5927\u8017\u65f6\u70b9 813ms\u3002\n\n\n### \u4f18\u53161 \u5361\u5e38(\u5c31\u662f\u5438\u4e86\u4e2a\u6c27)\n\n\u8fd9\u91cc\u597d\u50cf\u52a0\u5feb\u8bfb\u4f1a\u51fa\u95ee\u9898\u3002\n\n\u5438\u6c27\u4ee5\u540e\u6700\u5927\u8017\u65f6 738ms\u3002\n\n\u56e0\u4e3a\u662f\u7528 ```while``` \u505a\u5faa\u73af\u6240\u4ee5\u5f00\u4e0d\u5f00 ```register``` \u90fd\u4e00\u6837\u3002\n\n\n### \u4f18\u53162 \u6307\u6570\u5316\u7b80\n\n\u6839\u636e $n \\bmod 2$ \u5206\u7c7b\u8ba8\u8bba\uff0c\u518d\u7528 $2^{n-4}$ \u548c $3^{n-4}$ \u8868\u793a\u6574\u4e2a\u5f0f\u5b50\u5c31\u4f1a\u5feb\u5f88\u591a\u3002\n\n\u6307\u6570\u5316\u7b80\u540e(\u6ca1\u5438\u6c27) 440ms\uff0c\u5438\u6c27\u540e 394ms\n\n### \u4f18\u53163 \u6307\u6570\u53d6\u6a21\n\n\u56e0\u4e3a $\\varphi{(1000000000)}=400000000$\u3002\n\n\u5982\u679c\u6307\u6570\u5927\u4e8e $400000000$ \uff0c\u53ea\u8981\u5728\u5feb\u901f\u5e42\u524d\u628a\u6307\u6570\u6a21 $400000000$ \u518d\u52a0 $400000000$ \u5c31\u53ef\u4ee5\u5566\u3002\n\n\u5316\u7b80\u540e 398ms\uff0c\u52a0\u4e0a\u6307\u6570\u5316\u7b80\u5e76\u4e14\u5438\u6c27 203ms\u3002\n\n### \u4f18\u53164 \u5149\u901f\u5e42\n\n\u5927\u5bb6\u90fd\u77e5\u9053\uff0c\u61d2\u5f97\u5199\u4e5f\u4e0d\u8bf4\u4e86\u3002\n\n## \u6700\u540e\n\n\u4ee3\u7801\u4e0d\u8d34\u4e86\uff0c\u5176\u5b83\u9898\u89e3\u5df2\u7ecf\u6709\u5f88\u591a\u4e86\u3002\n\n\u7b2c\u4e00\u6b21\u5199\u9ed1\u9898\u89e3\uff0c\u8bf7\u7ba1\u7406\u5927\u5927\u591a\u591a\u5305\u542b\u3002",
        "postTime": 1673952618,
        "uid": 671294,
        "name": "HappyRabit",
        "ccfLevel": 5,
        "title": "P2012 \u62ef\u6551\u4e16\u754c2 \u9898\u89e3"
    },
    {
        "content": "\u8fd9\u9053\u9898\u7b97\u662f\u751f\u6210\u51fd\u6570\uff08GF\uff09\u5165\u95e8\u9898\u4e86\u5427\uff0c\u90a3\u5c31\u987a\u4fbf\u8bb2\u4e00\u4e0b\u751f\u6210\u51fd\u6570\u3002\n\n\u4e0d\u4e25\u8c28\u7684\u5b9a\u4e49\uff1a\u5047\u8bbe\u6709\u4e00\u4e32\u5e8f\u5217 $\\{a_n\\}_0^\\infty$\uff0c\u8bbe $G(x)=\\sum\\limits_{i=0}^\\infty a_ik_n(x)$\uff0c\u5219\u79f0 $G(x)$ \u4e3a\u5e8f\u5217 $\\{a_n\\}_0^\\infty$ \u7684\u751f\u6210\u51fd\u6570\uff0c\u751f\u6210\u51fd\u6570\u7684\u7b2c $i$ \u9879\u5bf9\u5e94\u7740\u539f\u5e8f\u5217\u7684 $a_i$\u3002\n\n#### \u5206\u7c7b\n\n$k_n(x)$ \u4e00\u822c\u6709 $3$ \u79cd\uff0c\u6839\u636e $k_n(x)$\uff0c\u751f\u6210\u51fd\u6570\u4e00\u822c\u5206\u4e3a $3$ \u7c7b\uff1a\n\n1. \u666e\u901a\u751f\u6210\u51fd\u6570\uff08OGF\uff09\uff1a$k_n(x) = x^n$\n\n2. \u6307\u6570\u751f\u6210\u51fd\u6570\uff08EGF\uff09\uff1a$k_n(x) = \\frac{x^n}{n!}$\n\n3. \u72c4\u5229\u514b\u96f7\u751f\u6210\u51fd\u6570\uff08DGF\uff09\uff1a$k_n(x) = \\frac1{x^n}$\n\n\u51fd\u6570\u4e2d\u7684 $x$ \u53ef\u4ee5\u53d6\u4efb\u610f\u503c\uff0c\u4e14\u4e0e\u539f\u5e8f\u5217\u65e0\u5173\uff0c\u6240\u4ee5\u88ab\u79f0\u4e3a\u5f62\u5f0f\u5e42\u7ea7\u6570\u3002\n\n\u66f4\u4e3a\u5e38\u7528\u7684\u662f\u524d\u4e24\u79cd\u3002\n\n#### \u5e94\u7528\n\n\u666e\u901a\u751f\u6210\u51fd\u6570\u8fd0\u7528\u4e8e**\u4e0d\u8bb2\u6c42\u6570\u5217\u987a\u5e8f\u7684\u6570\u5217\u8ba1\u6570\u95ee\u9898**\uff0c\u610f\u601d\u5c31\u662f\u5047\u8bbe\u6709\u56db\u4e2a\u6570 $a,b,c,d$\uff0c\u6392\u5217 $(a,b,c,d)$ \u548c\u6392\u5217 $(a,c,b,d)$ \u662f\u540c\u4e00\u79cd\u3002\n\n\u6307\u6570\u751f\u6210\u51fd\u6570\u8fd0\u7528\u4e8e**\u8bb2\u6c42\u6570\u5217\u987a\u5e8f\u7684\u6570\u5217\u8ba1\u6570\u95ee\u9898**\uff0c\u5047\u8bbe\u6709\u56db\u4e2a\u6570 $a,b,c,d$\uff0c\u6392\u5217 $(a,b,c,d)$ \u548c\u6392\u5217 $(a,c,b,d)$ \u662f\u4e0d\u540c\u7684\u65b9\u6848\u3002\n\n#### \u5c01\u95ed\u5f62\u5f0f\n\n1. \u7531\u4e8e\u751f\u6210\u51fd\u6570\u662f\u65e0\u7a77\u7ea7\u6570\uff0c\u7528\u8d77\u6765\u975e\u5e38\u4e0d\u65b9\u4fbf\uff0c\u53c8\u56e0\u4e3a $x$ \u53ef\u4ee5\u53d6\u4efb\u610f\u503c\uff0c\u9650\u5b9a $-1<x<1$\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e9b\u5c01\u95ed\u5f62\u5f0f\u3002\n\n$$\\sum\\limits_{i=0}^\\infty x^i=\\frac1{1-x}$$\n\n\u8bc1\u660e: \u8bbe $F(x)=\\sum\\limits_{i=0}^\\infty x^i,xF(x)=\\sum\\limits_{i=1}^nx^i=\\sum\\limits_{i=0}^nx^i+1$\n\n$\\therefore xF(x)=F(x)+1$\uff0c\u79fb\u9879\u5f97\uff1a$F(x)=\\frac{1}{1-x}$\n\n\u4e00\u4e9b\u4f8b\u5b50: \n\n\u5e8f\u5217 $\\{p,2p,3p,\\cdots\\}_0^\\infty$ \u7684\u751f\u6210\u51fd\u6570\uff1a$\\frac{1}{1-x^p}$\n\n\u5e8f\u5217 $\\{ \\binom{m}{0} ,\\binom{m}{1},\\binom{m}{2},\\cdots\\}_0^\\infty$ \u7684\u751f\u6210\u51fd\u6570\uff1a$(1+x)^m$\uff0c\u4e8c\u9879\u5f0f\u5b9a\u7406\u5c55\u5f00\u5373\u53ef\u3002\n\n\u56e0\u4e3a\u8ba1\u6570\u7c7b\u95ee\u9898\u4e00\u822c\u6ee1\u8db3\u4e58\u6cd5\u539f\u7406\uff0c\u6240\u4ee5\u6211\u4eec\u5f80\u5f80\u9700\u8981\u628a\u4e24\u4e2a\u751f\u6210\u51fd\u6570\u76f8\u4e58\u3002 \u4e24\u4e2a\u751f\u6210\u51fd\u6570\u76f8\u4e58\uff0c\u4e5f\u5c31\u662f\u5b83\u4eec\u7684\u5c01\u95ed\u5f62\u5f0f\u76f8\u4e58\u3002\n\n\u4f8b\u9898\uff1a[\u62ef\u6551\u4e16\u754c](https://www.luogu.com.cn/problem/P2000)\n\n2. Taylor\u5c55\u5f00\n\n$$e^x=\\sum\\limits_{n=0}^\\infty \\frac{x^n}{n!}$$\n\n\u4e00\u4e9b\u4f8b\u5b50: \n\n$F(x)=\\sum\\limits_{n=0}^\\infty\\frac{x^{2n}}{(2n)!}$ \u7684\u751f\u6210\u51fd\u6570\uff1a$\\frac12(e^x+e^{-x})$\n\n$F(x)=\\sum\\limits_{n=0}^\\infty\\frac{x^{2n+1}}{(2n+1)!}$ \u7684\u751f\u6210\u51fd\u6570\uff1a$\\frac12(e^x-e^{-x})$\n\n\u56e0\u4e3a\u8ba1\u6570\u7c7b\u95ee\u9898\u4e00\u822c\u6ee1\u8db3\u4e58\u6cd5\u539f\u7406\uff0c\u6240\u4ee5\u6211\u4eec\u5f80\u5f80\u9700\u8981\u628a\u4e24\u4e2a\u751f\u6210\u51fd\u6570\u76f8\u4e58\u3002\n\u4e24\u4e2a\u751f\u6210\u51fd\u6570\u76f8\u4e58\uff0c\u4e5f\u5c31\u662f\u5b83\u4eec\u7684\u5c01\u95ed\u5f62\u5f0f\u76f8\u4e58\u3002\n\n\u4f8b\u9898\uff1a[\u62ef\u6551\u4e16\u754c2](https://www.luogu.com.cn/problem/P2012)\n\n\u56de\u5230\u672c\u9898\uff0c\u663e\u7136\u6b64\u9898\u4e0d\u540c\u7684\u6392\u5217\u662f\u4e0d\u540c\u7684\u7ed3\u679c\uff0c\u6240\u4ee5\u8981\u7528\u6307\u6570\u751f\u6210\u51fd\u6570\u3002\n\n\u666e\u901a\u57fa\u56e0\u4e32\u7684 EGF \u4e3a\uff1a$e^x$\n\n\u5947\u6570\u4e32\u7684 EGF \u4e3a\uff1a$\\frac12(e^x-e^{-x})$\n\n\u5076\u6570\u4e32\u7684 EGF \u4e3a: $\\frac12(e^x+e^{-x})$\n\n\u628a\u5b83\u4eec\u4e58\u8d77\u6765\uff0c\u518d\u56db\u6b21\u65b9\u3002\n\n\u4e5f\u5c31\u662f\uff1a\n$$\n\\begin{aligned}\n&=(\\frac14e^x(e^x-e^{-x})(e^x+e^{-x}))^4\\\\\n\n&=\\frac1{256}(e^x(e^{2x}-e^{-2x}))^4\\\\\n\n&=\\frac1{256}(e^{3x}-e^{-x})^4\\\\\n\n&=\\frac1{256}(e^{12}-4e^{-8x}+6e^{4x}-4+e^{-4x})\n\\end{aligned}\n$$\n\n\u53d6\u5176\u7ed3\u679c\u7684 $n$ \u6b21\u9879\uff0c\u4f46\u662f\uff0c\u56e0\u4e3a $n$ \u6b21\u9879\u6709\u4e2a $\\frac1{n!}$\uff0c\u6240\u4ee5\u5f97\u5230\u7684\u7ed3\u679c\u8981\u4e58 $n!$\uff0c\u628a\u5b83\u62b5\u6d88\u3002\n\n\u7b54\u6848\u8868\u793a\u4e3a\uff1a\n\n$$n![x^n]A(x)$$\n\n\n$$\n\\begin{aligned}\n&=\\frac{n!}{256}(\\frac{12^n}{n!}-4\\cdot\\frac{8^n}{n!}+6\\cdot\\frac{4^n}{n!}+\\frac{(-4)^n}{n!})\\\\\n\n&=\\frac{1}{256}(12^n-4\\cdot 8^n + 6 \\cdot4^n+(-4)^n)\n\\end{aligned}\n$$\n\n\u7136\u540e\u5462\uff0c\u56e0\u4e3a $256$ \u5728 $\\bmod\\ 1000000000$ \u610f\u4e49\u4e0b\u6ca1\u6709\u9006\u5143\uff0c\u4f46\u662f\u5f53 $n \\geq 4,256\\mid4\n^n$\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u5728 $n < 4$ \u65f6\u7279\u5224\uff0c$n \\geq 4$ \u76f4\u63a5\u5feb\u901f\u5e42\uff0c\u5c31\u53ef\u4ee5 AC \u672c\u9898\u3002\n\n\u4ee3\u7801\u5982\u4e0b:\n\n```cpp\n#include<cstdio>\nusing namespace std;\n#define int long long\nconst int mod = 1e9;\ntemplate <typename T>\ninline void read(T &x) {\n\tx = 0;\n\tbool f = 1;\n\tstatic char ch = getchar();\n\twhile (ch < '0' || ch > '9') {\n\t\tif (ch == '-') \n\t\t\tf = 0;\n\t\tch = getchar();\n\t}\n\twhile (ch >= '0' && ch <= '9') {\n\t\tx = (x << 3) + (x << 1) + (ch ^ 48);\n\t\tch = getchar();\n\t}\n\tif (!f) x = -x;\n}\ninline int qpow(int a, int b) {\n\tint ans = 1;\n\twhile (b) {\n\t\tif (b & 1) ans = 1ll * ans * a % mod;\n\t\ta = 1ll * a * a % mod;\n\t\tb >>= 1;\n\t}\n\treturn ans;\n}\nsigned main(){\n    int n;\n    while (1) {\n    \tread(n);\n    \tif (!n) break;\n    \tif (n < 4) puts(\"0\");\n    \telse if (n == 4) puts(\"24\");\n\t\telse {\n\t\t\tprintf(\"%lld\\n\", (((81ll * qpow(12, n - 4) % mod - qpow(8, n - 2) + mod) % mod + \n\t\t\t6ll * qpow(4, n - 4) % mod) % mod + qpow(mod - 4, n - 4)) % mod);\n\t\t}\n\t}\n    return 0;\n}\n```\n\n~~\u6ca1\u5361\u5e38\u90fd\u8fc7\u4e86\uff0c\u6570\u636e\u771f\u6ef4\u6c34\u3002~~",
        "postTime": 1660295353,
        "uid": 430283,
        "name": "W123789",
        "ccfLevel": 0,
        "title": "P2012\u9898\u89e3"
    }
]
[
    {
        "content": "\u89e3\u6cd51\uff1a  \r\n\u6211\u6709\u4fe1\u4ef0\uff0c\u6211\u662fMC\u73a9\u5bb6\uff0c\u8f93\u51fa0\uff0c\u9884\u8ba1\u5f97\u52063.\r\n\r\n\u89e3\u6cd52\uff1a  \r\n\u6211\u4f1a\u66b4\u529bdfs\uff0c\u9884\u8ba1\u5f97\u520633\u5206\u3002\r\n\r\n\u89e3\u6cd53\uff1a  \r\n\u6211\u4f1a\u7279\u5224\uff0c\u89c2\u5bdf\u5230k\u7684\u53d6\u503c\u8303\u56f4\u4ee5\u53ca\u6811\u9000\u5316\u7684\u60c5\u51b5\uff0c\u8003\u8651\u7279\u5224\uff0c\u9884\u8ba1\u5f97\u520660-70\u5206\u3002\r\n\r\n\u89e3\u6cd54\uff1a  \r\n\u6211\u4f1a\u6a21\u62df\u9000\u706b\uff0c\u51fa\u9898\u4eba~~\u7279\u610f~~\u5f00\u4e86\u4e50\u591a\u8d5b\u5236\uff0c\u671f\u671b\u5f97\u52060-100\r\n\r\n\u89e3\u6cd55\uff1a  \r\n\u6211\u4f1a\u72b6\u538bDP\u3002\u6211\u4eec\u53ef\u4ee5\u8bb0\u5f55\u6bcf\u4e2a\u8282\u70b9\u7684\u513f\u5b50\u3002\u56e0\u4e3a\u5728\u53d8\u52a8\u8282\u70b9\u7684\u65f6\u5019\uff0c\u4ed6\u7684\u513f\u5b50\u59cb\u7ec8\u662f\u4e0d\u53d8\u7684\u3002  \r\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u96c6\u5408S\uff0c\u8bb0S'\u9664\u53bb\u5f53\u524d\u8003\u8651\u7684\u8282\u70b9x,\u7136\u540e\u770b\u4ed6\u91cc\u9762\u6709\u51e0\u4e2a\u70b9\u7684\u513f\u5b50\u662fx,\u7136\u540e\u51cf\u53bb\u8fd9\u4e2a\u8ddd\u79bb\u518d\u8ba1\u7b97\uff08\u8f6c\u79fb\uff09\u5c31\u53ef\u4ee5\u4e86\u3002\u65f6\u95f4\u590d\u6742\u5ea6$O(n^2*2^n)$\uff0c\u53ef\u4ee5\u8fc7\u5168\u90e8\u7684\u70b9\u3002\r\n\r\n\u4ee3\u7801\uff1a\uff08100pts\uff09  \r\n```\r\n#include<map>\r\n#include<cstdio>\r\n#include<cstring>\r\n#include<iostream>\r\nusing namespace std;\r\nint n,k,d[101],top,far;\r\nint o[51][51],f[1<<20];\r\nint son[1<<20];\r\nstring s,t;\r\nmap<string,int> qwq;\r\nint num(int x){\r\n    if(x==0)\treturn 0;\r\n    return num(x-(x&-x))+1;\r\n}\r\nvoid dfs(int node){\r\n    if(d[node]>1)\r\n        far|=(1<<node-1);\r\n    for(int i=1;i<=n;i++)\r\n        if(o[node][i]){\r\n            d[i]=d[node]+1;\r\n            dfs(i);\t\t\t\r\n            son[node]|=(1<<i-1);\r\n            son[node]|=son[i];\r\n        }\r\n    return ;\r\n}\r\nint main(){\r\n    int cnt=1;\r\n    cin>>n>>k;\r\n    cin>>s;\tqwq[s]=1;\r\n    for(int i=2;i<=n;i++){\r\n        cin>>s>>t;\r\n        qwq[s]=++cnt;\r\n        o[qwq[t]][qwq[s]]=1;\r\n    }\r\n    dfs(1);\r\n    for(int s=1;s<(1<<n);s++){\r\n        for(int i=1;i<=n;i++){\r\n            if(s&(1<<i-1)){\r\n                int s1=s-(1<<i-1),dis=d[i];\r\n                for(int j=1;j<=n;j++)\r\n                    if(s1&(1<<j-1)&&(son[j]&(1<<i-1))&&d[j]>1)\r\n                        dis--;\r\n                if(dis<=1)\tf[s]=max(f[s],f[s1]);\r\n                else\tf[s]=max(f[s],f[s1]+((num(s&far)+dis)&k));\r\n            }\r\n        }\r\n    }\r\n    cout<<f[(1<<n)-1]<<endl;\r\n    return 0;\r\n}\r\n```\r\n\r\n~~\u5176\u5b9e\u4e5f\u4e0d\u662f\u5f88\u957f\uff0c\u5bf9\u5427~~\r\n",
        "postTime": 1542150023,
        "uid": 20780,
        "name": "\u5357\u57ce\u5fc6\u6f47\u6e58",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5034 \u3010\u679c\u51bb\u3011"
    },
    {
        "content": "\n~~\u849f\u84bb\u7b2c\u4e00\u6b21\u5199\u9898\u89e3\uff0c\u5199\u7684\u4e0d\u597d\u8fd8\u8bf7\u5305\u5bb9~~\n## Descripition\n\u6709\u4e00\u68f5 $n$ \u4e2a\u70b9\u6784\u6210\u7684\u4ee5\u8282\u70b9 1 \u4e3a\u6839\u7684\u6811\uff0c\u6bcf\u4e2a\u53f6\u5b50\u8282\u70b9\u5230 1 \u53f7\u8282\u70b9\u7684\u8ddd\u79bb $d_i$ \u4e3a\u8be5\u8282\u70b9\u5230 1 \u8282\u70b9\u7684\u8fb9\u6570\uff0c\u7b2c $t$ \u5206\u949f\u4f1a\u6709\u4e00\u4e2a\u4e0d\u4ee5 1 \u8282\u70b9\u4e3a\u7236\u8282\u70b9\u7684\u513f\u5b50\u8282\u70b9\u5e26\u7740\u81ea\u5df1\u7684\u5b50\u6811\u6302\u5230 1 \u53f7\u8282\u70b9\u4e0a\uff0c\u5e76\u4f1a\u83b7\u5f97 $(d_i+t) \\operatorname{and} k$ \u7684\u8d21\u732e\uff0c\u6c42\u5f53\u6240\u6709\u8282\u70b9\u7684\u7236\u8282\u70b9\u90fd\u4e3a 1 \u65f6\uff0c\u83b7\u5f97\u7684\u8d21\u732e\u6700\u5927\u4e3a\u591a\u5c11\u3002\n## Solution\n\u849f\u84bb\u5199\u8fd9\u9053\u9898\u662f\u521a\u5b66\u5b8c\u6a21\u62df\u9000\u706b\uff0c\u770b\u5230\u8fd9\u4e2a $n$ \u7684\u8303\u56f4\u53ea\u6709 20\uff0c\u4fbf\u51b3\u5b9a\u6d17\u628a\u8138\u62ff\u6a21\u9000\u4e71\u641e\uff0c\u4e0d\u4f1a\u6a21\u9000\u7684\u53ef\u4ee5\u5148\u53bb\u770b\u8fd9\u9053\u9898\n[\u540a\u6253xxx](https://www.luogu.com.cn/problem/P1337)\uff0c\u8fd9\u91cc\u5c31\u4e0d\u8fc7\u591a\u5bf9\u6a21\u9000\u672c\u8eab\u8fdb\u884c\u8bb2\u89e3\u3002\u9996\u5148\u6211\u4eec\u6784\u9020\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6570\u5217\uff0c\u521d\u59cb\u8d4b\u503c\u4e3a $1$ \u5230 $n$\uff0c\u8868\u793a\u6211\u4eec\u8981\u6302\u5230 1 \u53f7\u8282\u70b9\u7684\u987a\u5e8f\uff0c\u521d\u59cb\u65f6\u5148\u6c42\u51fa $ans$\uff0c\u7136\u540e\u6a21\u62df\u9000\u706b\u65f6\u968f\u673a\u9009 $1$ \u5230 $n$ \u4e2d\u7684 2 \u4e2a\u4e0d\u76f8\u540c\u7684\u6570\u4ea4\u6362\uff0c\u7136\u540e\u518d\u8ba1\u7b97\u7b54\u6848\u4e0e $ans$ \u4f5c\u6bd4\u8f83\uff0c\u5982\u679c\u66f4\u4f18\u5c31\u66f4\u6539 $ans$\uff0c\u5426\u5219\u6839\u636e\u6a21\u9000\u516c\u5f0f\u6982\u7387\u63a5\u53d7\u65b0\u7b54\u6848\uff0c\u7136\u540e\u8fdb\u884c\u4e0b\u4e00\u6b21\u4ea4\u6362\uff0c\u56e0\u4e3a $n$ \u7684\u8303\u56f4\u5f88\u5c0f\uff0c\u6240\u4ee5\u53ea\u8981\u4ea4\u6362\u7684\u6b21\u6570\u591f\u591a\uff0c\u603b\u80fd\u627e\u5230\u6700\u4f18\u7b54\u6848\u3002\n\n\n------------\n### Part 1\n\u9996\u5148\u662f\u8f93\u5165\u90e8\u5206\uff0c\u9898\u76ee\u4e2d\u6bcf\u4e2a\u8282\u70b9\u53ef\u80fd\u662f\u5b57\u7b26\u4e32\uff0c\u6211\u8fd9\u91cc\u91c7\u7528 map \u5c06\u5b57\u7b26\u4e32\u5168\u90e8\u8f6c\u5316\u4e3a\u6570\u5b57\uff0c\u7136\u540e\u53ea\u9700\u8981\u5b58\u4e0b\u6bcf\u4e2a\u8282\u70b9\u7684\u7236\u8282\u70b9\u5373\u53ef\u3002\n```cpp\nscanf(\"%d%d\",&n,&k);\nif(n==0&&k==0){//\u7279\u5224k=0\u7684\u60c5\u51b5\n\tprintf(\"0\");\n\treturn 0;\n}\nstd::cin>>s;\nmap[s]=1;\nfor(int i=2;i<=n;i++){\n\tstd::cin>>s>>s1;\n\tmap[s]=i;//\u5b58\u5165\u65b0\u8282\u70b9\n\tfa[i]=map[s1];//\u5b58\u4e0b\u6bcf\u4e2a\u8282\u70b9\u7684\u7236\u8282\u70b9\n\ta[i]=i;//\u6a21\u9000\u521d\u59cb\u6570\u5217\n}\n```\n### Part 2\n\u63a5\u4e0b\u6765\u662f\u6211\u4eec\u5f97\u5230\u4e00\u4e2a\u53ef\u80fd\u6700\u6709\u7684\u987a\u5e8f\u65f6\u600e\u6837\u6c42\u51fa\u7b54\u6848\uff0c\u8fd9\u91cc\u6211\u91c7\u7528\u7684\u662f\u7c7b\u4f3c\u5e76\u67e5\u96c6\u7684\u601d\u60f3\uff0c\u9012\u5f52\u6c42\u51fa\u5f53\u524d\u8282\u70b9\u5230\u6839\u8282\u70b9\u7684\u8ddd\u79bb\uff0c\u7136\u540e\u6839\u636e\u9898\u610f\u7b97\u51fa\u8d21\u732e\uff0c\u7136\u540e\u5c06\u8be5\u8282\u70b9\u7684\u7236\u8282\u70b9\u6539\u4e3a 1\uff0c\u8fd9\u6837\u8be5\u8282\u70b9\u7684\u5b50\u6811\u4e5f\u540c\u6837\u4f1a\u6539\u53d8\u4f4d\u7f6e\uff0c\u5e2e\u52a9\u8ba1\u7b97\u53f6\u8282\u70b9\u7684\u8d21\u732e\u3002\n```cpp\nint find(int now,int step){\n\tif(now==1){//\u5982\u679c\u5df2\u7ecf\u5230\u8fbe\u6839\u8282\u70b9\uff0c\u5c31\u8fd4\u56dedis\n   //\u8fd9\u91cc\u4e0d\u5982\u5904\u7406\u51fa\u6bcf\u4e2a\u8282\u70b9\u5230\u6839\u8282\u70b9\u8ddd\u79bb\u662f\u56e0\u4e3a\u6bcf\u4e2a\u8282\u70b9\u5728\u53d8\u5316\u4e2d\u5230\u6839\u8282\u70b9dis\u4f1a\u53d8\n\t\treturn step;\n\t}\n\treturn find(fa1[now],step+1);\n}\n\nint getans(){\n\tfor(int i=1;i<=n;i++){\n\t\tfa1[i]=fa[i];//\u6bcf\u6b21\u6c42\u7b54\u6848\u65f6\u6bcf\u4e2a\u8282\u70b9\u7684\u7236\u8282\u70b9\u90fd\u4f1a\u6539\u53d8\uff0c\u6240\u4ee5\u6bcf\u6b21\u6c42\u4e4b\u524d\u91cd\u7f6e\n\t}\n\tint tmp=0;\n\tint t=0;//\u8bb0\u5f55\u7b2c\u51e0\u5206\u949f\n\tfor(int i=2;i<=n;i++){\n\t\tif(fa1[a[i]]==1)continue;//\u5982\u679c\u7236\u8282\u70b9\u672c\u8eab\u5c31\u662f1\u90a3\u5c31\u4e0d\u9700\u8981\u6302\u4e0a\u53bb\n\t\tt++;\n\t\tsum=find(a[i],0);//\u6c42\u8be5\u8282\u70b9\u5230\u6839\u8282\u70b9\u8ddd\u79bb\n\t\ttmp=tmp+((sum+t)&k);//\u6c42\u51fa\u8d21\u732e\n\t\tfa1[a[i]]=1;//\u5c06\u8be5\u8282\u70b9\u6302\u5230\u6839\u8282\u70b9\u4e0a\n\t}\n\treturn tmp;//\u8fd4\u56de\u7b54\u6848\n}\n```\n### Part 3\n\u63a5\u4e0b\u6765\u5c31\u662f\u6700\u91cd\u8981\u7684\u6a21\u9000\u90e8\u5206\uff0c\u9996\u5148\u6784\u9020\u4e00\u4e2a\u6570\u5217 $a$ \u6c42\u51fa\u4e00\u4e2a\u521d\u59cb\u7684\u6302\u8282\u70b9\u7684\u987a\u5e8f\uff0c\u7136\u540e\u6bcf\u6b21\u6a21\u9000\u7684\u65f6\u5019\u968f\u673a\u4ea4\u6362 2 \u4e2a\u70b9\u7684\u6302\u7684\u987a\u5e8f\uff0c\u7136\u540e\u6839\u636e\u4e0a\u4e00\u90e8\u5206\u6c42\u51fa\u6bcf\u6b21\u7b54\u6848\uff0c\u7136\u540e\u53d6\u6700\u5927\u503c\uff0c\u6a21\u9000\u662f\u4e2a\u7384\u5b66\u7b97\u6cd5\uff0c\u8bb0\u5f97\u591a\u8dd1\u51e0\u904d\u3002\n```cpp\nvoid sa(int times){\n\twhile(times--){//\u6d17\u628a\u8138\uff0c\u591a\u8dd1\u51e0\u6b21\u8bf4\u4e0d\u5b9a\u5c31\u8fc7\u4e86\n\t\tfor(double i=t;i>end;i*=down){//\u5b9e\u65f6\u6e29\u5ea6\n\t\t\tint x=0,y=0;\n\t\t\twhile(x==y){//\u968f\u673a\u4ea4\u63622\u4e2a\u4e0d\u4e00\u6837\u7684\u70b9\n\t\t\t\tx=rand()%(n-1)+2;\n\t\t\t\ty=rand()%(n-1)+2;\n\t\t\t}\n\t\t\tstd::swap(a[x],a[y]);\n\t\t\tint tmp=getans();\n\t\t\tfor(int i=2;i<=n;i++){\n\t\t\t\t\n\t\t\t}\n\t\t\tif(tmp>=ans){\n\t\t\t\tans=tmp;\n\t\t\t}else if(exp(ans-tmp)/i>(double)rand()/RAND_MAX){//\u4e0d\u662f\u6700\u4f18\u89e3\u65f6\u6982\u7387\u63a5\u53d7\u5f53\u524d\u7b54\u6848\n\t\t\t\tstd::swap(a[x],a[y]);\n\t\t\t}\n\t\t}\n\t}\n}\n```\n------------\n\n\u6a21\u9000\u4e3b\u8981\u8fd8\u662f\u770b~~\u4eba\u54c1~~\u53c2\u6570\uff0c\u795d\u613f\u5404\u4f4d\u8c03\u51fa\u5feb\u4e00\u70b9\u7684\u53c2\u6570\uff0c\u6700\u540e\u9644\u4e0a\u5b8c\u6574\u9ad8\u6e05\u65e0\u6ce8\u91ca\u4ee3\u7801\u3002\n### Code\n```cpp\n#include<bits/stdc++.h>\n\nconst double t=4000,down=0.99,end=1e-13;\nstd::map<std::string,int>map;\nstd::string s,s1;\nint n,k,fa[30],fa1[30],a[30],ans,sum;\n\nint find(int now,int step){\n\tif(now==1){\n\t\treturn step;\n\t}\n\treturn find(fa1[now],step+1);\n}\n\nint getans(){\n\tfor(int i=1;i<=n;i++){\n\t\tfa1[i]=fa[i];\n\t}\n\tint tmp=0;\n\tint t=0;\n\tfor(int i=2;i<=n;i++){\n\t\tif(fa1[a[i]]==1)continue;\n\t\tt++;\n\t\tsum=find(a[i],0);\n\t\ttmp=tmp+((sum+t)&k);\n\t\tfa1[a[i]]=1;\n\t}\n\treturn tmp;\n}\n\nvoid sa(int times){\n\twhile(times--){\n\t\tfor(double i=t;i>end;i*=down){\n\t\t\tint x=0,y=0;\n\t\t\twhile(x==y){\n\t\t\t\tx=rand()%(n-1)+2;\n\t\t\t\ty=rand()%(n-1)+2;\n\t\t\t}\n\t\t\tstd::swap(a[x],a[y]);\n\t\t\tint tmp=getans();\n\t\t\tfor(int i=2;i<=n;i++){\n\t\t\t\t\n\t\t\t}\n\t\t\tif(tmp>=ans){\n\t\t\t\tans=tmp;\n\t\t\t}else if(exp(ans-tmp)/i>(double)rand()/RAND_MAX){\n\t\t\t\tstd::swap(a[x],a[y]);\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tscanf(\"%d%d\",&n,&k);\n\tif(n==0&&k==0){\n\t\tprintf(\"0\");\n\t\treturn 0;\n\t}\n\tstd::cin>>s;\n\tmap[s]=1;\n\tfor(int i=2;i<=n;i++){\n\t\tstd::cin>>s>>s1;\n\t\tmap[s]=i;\n\t\tfa[i]=map[s1];\n\t\ta[i]=i;\n\t}\n\tans=getans();\n\tsa(10);\n\tprintf(\"%d\",ans);\n\treturn 0;\n}\n```\n\u8003\u573a\u614e\u7528\u6a21\u9000\u3002",
        "postTime": 1663597513,
        "uid": 349827,
        "name": "_TRINITY",
        "ccfLevel": 6,
        "title": "P5034\u679c\u51bb"
    }
]
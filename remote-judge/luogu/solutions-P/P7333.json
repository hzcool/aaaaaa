[
    {
        "content": "### T1 JFCA\n#### Subtask 1\n\u8fd9\u4e2a $Subtask$ \u4e2d $n \\leqslant 10^3$ ,\u66b4\u529b $O(n^2)$ \u5411\u5de6\u53f3\u62d3\u5c55\u5373\u53ef\uff0c\u4f46\u662f\u7531\u4e8e\u6ca1\u6709 $O2$\uff0c\u53ea\u80fd\u901a\u8fc7\u6570\u636e\u70b9 $1$ \u81f3 $4$ \u6570\u636e\u70b9\uff08\u6570\u636e\u70b9 $4$ \u53ef\u6781\u9650\u901a\u8fc7\uff09\uff0c\u671f\u671b\u5f97\u5206 $20$.\n\n#### Subtask 2\n\u91c7\u7528\u6346\u7ed1\u6d4b\u8bd5\uff0c$10^5$ \u7684\u6570\u636e\u53ef\u4ee5\u60f3\u5230\u8981\u7528 $O(n\\log n)$ \u7684\u7b97\u6cd5\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u4e8c\u5206\uff0c\u4f46\u662f $a_j$ \u6ca1\u6709\u5355\u8c03\u6027\u3002\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u7ef4\u62a4\u533a\u95f4\u6700\u5927\u503c\uff0c\u6ee1\u8db3\u5355\u8c03\u6027\u3002\n\n\u7531\u4e8e\u9898\u76ee\u8bf4\u8fd9\u662f\u4e00\u4e2a\u73af\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5206\u7c7b\u8ba8\u8bba\u6216\u8005\u65ad\u73af\u4e3a\u94fe\uff0c\u8fd9\u7bc7\u9898\u89e3\u4e3b\u8981\u8bb2\u65ad\u73af\u4e3a\u94fe\u3002\n\n\u6211\u4eec\u5c06\u6bcf\u4e2a\u6570\u5b58 $3$ \u904d\uff0c\u5373 $a_{i+n+n}=a_{i+n}=a_i$.\n\n\u5b9a\u4e49 $f(i,j)=\\max_{k=i}^j a_k$\uff0c\u6211\u4eec\u8bbe\u5f53\u524d\u5904\u7406\u7684\u662f\u5e8f\u53f7\u4e3a $i$ \u7684\u6570\uff0c\u5219 $check(x)=\\max(f(i-x,i-1),f(i+1,i+x))$ \u3002\n\n\u6211\u4eec\u5bf9\u4e8e$i+n$ \u4e8c\u5206\u4e00\u6b21\u5373\u53ef\u3002\n\n\n\u6ce8\u610f\u4e8b\u9879\uff1a\n- 1.\u65ad\u73af\u4e3a\u94fe\u65f6\uff0c\u6211\u4eec\u590d\u5236 $3$ \u904d\u7684\u539f\u56e0\u662f\u5904\u7406\u8f83\u540e\u7684\u6570\u65f6\u53ef\u80fd\u4f1a\u9020\u6210\u6570\u7ec4\u8d8a\u754c\u9519\u8bef\u3002\n- 2.\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 $ST$\u8868 \u5e73\u8861\u590d\u6742\u5ea6\u5230 $n\\log n$\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u6570\u636e\u7ed3\u6784\u5982\u7ebf\u6bb5\u6811\u505a\u5230 $n\\log^2 n$ \u7684\u590d\u6742\u5ea6\u3002\n- 3.\u7531\u4e8e $i\\ne j$\uff0c\u6c42\u533a\u95f4\u6700\u5927\u503c\u65f6\u4e0d\u80fd\u76f4\u63a5\u7b97 $f(i-x,i+x)$\u3002\n\n\n\u63a5\u4e0b\u6765\u5c31\u53ef\u4ee5\u6109\u5feb\u7684\u4e8c\u5206\u4e86\uff0c\u4e0d\u7406\u89e3\u7684\u548c\u5269\u4f59\u7684\u5185\u5bb9\u53ef\u4ee5\u7ed3\u5408\u4ee3\u7801\u7406\u89e3\u3002\n\n$std$:\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=3e5+10;\nint n,m,st[N][30],lg[N];\nnamespace IO{\n\t//read(),write()\n}using namespace IO;\ninline int query(int l,int r){\n\tint q=lg[r-l+1];\n\treturn max(st[l][q],st[r-(1<<q)+1][q]);\n}\ninline int ef(int x,int i){//\u4e8c\u5206\n\tint l=1,r=n;\n\twhile(l<r){\n\t\tint mid=l+r>>1;\n\t\tif(max(query(i-mid,i-1),query(i+1,i+mid))>=x){\n\t\t\tr=mid;\n\t\t}else{\n\t\t\tl=mid+1;\n\t\t}\n\t}\n\treturn l==n?-1:l;\n}\nint main(){\n    n=read();\n    for(int i=1;i<=n;i++){//\u65ad\u73af\u4e3a\u94fe\n    \tst[i][0]=st[i+n][0]=st[i+n+n][0]=read();\n\t}\n\tfor(int i=2;i<=n+n+n;i++){\n\t    lg[i]=lg[i>>1]+1;\n\t}\n\tint ln=lg[n+n+n];\n\tfor(int i=1;i<=ln;i++){//ST\u8868\u9884\u5904\u7406\n\t\tfor(int j=1;j+(1<<i)-1<=n+n+n;j++){\n\t\t\tst[j][i]=max(st[j][i-1],st[j+(1<<i-1)][i-1]);\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tint b=read();\n\t\tint a2=ef(b,i+n);\n\t\twrite(a2);\n\t\tout[len++]=' ';\n\t}\n\tfwrite(out,1,len,stdout);\n    return 0;\n}\n```\n\u8fd9\u9053\u9898\u4f5c\u4e3a $T1$ \u8fd8\u662f\u5f88\u6c34\u7684\uff0c\u540e\u9762\u7684\u9898\u5c31\u5f88\u6bd2\u7624\u4e86\u3002\n\n\u611f\u8c22\u5927\u5bb6\u53c2\u4e0e\u8fd9\u573a\u6bd4\u8d5b\uff01",
        "postTime": 1610616365,
        "uid": 365127,
        "name": "cyffff",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P7333\u3010[JRKSJ R1] JFCA\u3011"
    },
    {
        "content": "### \u524d\u8a00\n\n\u8003\u5bdf\u4e8c\u5206\u548c $\\text{ST}$ \u8868\u7684\u7ed3\u5408\u8fd0\u7528\u3002\n\n### \u601d\u8def\n\n\u65e2\u7136\u8bf4\u597d\u4e86\u662f\u52a3\u5f27\uff0c\u6240\u4ee5\u80af\u5b9a\u53ea\u80fd\u5728\u5411\u5de6\u6216\u8005\u5411\u53f3\u7684 $\\dfrac{len}{2}$ \u4e2a\u70b9\u4e2d\u5bfb\u627e\uff08~~\u8c8c\u4f3c\u4e0d\u8bf4\u4e5f\u662f\u8fd9\u4e48\u5e72~~\uff09\u3002\n\n\u518d\u770b\u5982\u4f55\u5bfb\u627e\u6700\u5c0f\u957f\u5ea6\uff0c\u7ebf\u6027\u4e00\u4e2a\u4e2a\u67e5\u627e\u80af\u5b9a\u4e0d\u73b0\u5b9e\uff0c\u6240\u4ee5\u5c31\u8003\u8651\u533a\u95f4\u6700\u5927\u503c\u5982\u4f55\u53bb\u64cd\u4f5c\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\u6709\u4e00\u4e2a\u6027\u8d28\uff0c\u4e00\u4e2a\u533a\u95f4\u5185\uff0c\u4e00\u65e6\u4e00\u4e2a\u7aef\u70b9\u88ab\u56fa\u5b9a\u4e0b\u4e4b\u540e\uff0c\u8fd9\u4e2a\u533a\u95f4\u5185\u7684\u6700\u5927\u503c\u4f1a\u968f\u7740\u533a\u95f4\u7684\u6269\u5927\u800c**\u975e\u4e25\u683c\u5355\u8c03\u9012\u589e**\uff0c\u90a3\u4e48\u5c31\u627e\u5230\u8fd9\u4e2a\u533a\u95f4\u7684\u5355\u8c03\u6027\u4e86\uff0c\u73b0\u5728\u591a\u4e86\u4e00\u4e2a\u4e8c\u5206\u53ef\u4ee5\u9009\u62e9\u3002\n\n\u7ef4\u62a4\u533a\u95f4\u6700\u5927\u503c\uff0c\u770b\u6570\u636e\u8303\u56f4\uff0c\u53ef\u4ee5\u7528 $\\text{ST}$ \u8868\u8fdb\u884c\u7ef4\u62a4\u3002\n\n\u73b0\u5728\u5c31\u6709\u4e86\u4e00\u79cd\u505a\u6cd5\uff0c\u786e\u5b9a\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u7136\u540e\u5411\u524d\u5411\u540e\u5206\u522b\u4e8c\u5206\u8fdb\u884c\u67e5\u627e\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\log n)$ \uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\n\n\u81f3\u4e8e\u5982\u4f55\u65ad\u73af\u6210\u94fe\uff0c\u53ef\u4ee5\u60f3\u4e00\u60f3\uff1a\u56e0\u4e3a\u6211\u4eec\u662f\u8981\u4ece\u5de6\u9762\u548c\u53f3\u9762\u67e5\u627e\uff0c\u90a3\u4e48\u524d\u9762\u548c\u540e\u9762\u6211\u4eec\u5e94\u8be5\u662f\u5b58\u50a8\u4e00\u4e2a\u5b8c\u6574\u7684\u94fe\uff0c\u800c\u6211\u4eec\u5f53\u524d\u56fa\u5b9a\u7684\u70b9\u662f\u5728\u4e2d\u95f4\u7684\uff0c\u6240\u4ee5\u5c31\u5f00**\u4e09\u500d**\u7a7a\u95f4\uff0c\u590d\u5236\u4e09\u6b21\u94fe\u3002\u4ee5\u4e2d\u95f4\u4e00\u6761\u94fe\u4e3a\u57fa\u51c6\uff0c\u8fdb\u884c\u524d\u9762\u540e\u9762\u7684\u67e5\u627e\u3002\n\n### \u5751\u70b9\n\n\u4e8c\u5206\u7684\u65f6\u5019\u53ef\u80fd\u968f\u624b\u5c31\u5199\u6210\u4e86\u8fd9\u79cd\u5f62\u5f0fqwq\u3002\n\n```cpp\n\tint l=i-len+1;\n    \tint r=i;\n    \t//\u6216\u8005\u662f\n        int l=i;\n        int r=i+len-1;\n```\n\u5176\u5b9e\u8fd9\u79cd\u60f3\u6cd5\u662f $\\text{very}$ \u9519\u8bef\u7684\uff0c\u4ee5\u4e3a\u6211\u4eec\u8981\u627e\u5230\u533a\u95f4\u4e00\u5b9a\u662f\u4e0d\u80fd\u5305\u542b $i$ \u8fd9\u4e2a\u70b9\u7684\uff0c\u56e0\u4e3a\u4e00\u65e6\u8fd9\u6837\u90a3\u4e48\u6709\u65f6\u5019\u4f1a\u51fa\u73b0\u4e00\u4e2a\u5947\u5947\u602a\u602a\u7684\u9519\u8bef\uff0c\u6ce8\u610f\u770b\u9898\u76ee\uff08$i\\neq j$\uff09\n\n\u800c\u4e14 `i+len-1` \u8fd9\u79cd\u505a\u6cd5\u4e5f\u662f\u9519\u8bef\u7684\uff0c\u81ea\u5df1\u624b\u819c\u4e00\u4e0b\u53d1\u73b0\u6839\u672c\u4e0d\u9700\u8981 $+1-1$ \u7684\u64cd\u4f5c\u3002\n\n### \u4ee3\u7801\u5b9e\u73b0\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<map>\nconst int N=1e5+9;\nconst int M=23;\nint Max[N*3][M+1];//a[i]\u7684\u6700\u5927\u503c \n//\u5904\u7406\u4e2d\u95f4\u4e00\u4e2a\u590d\u5236\u7684\u73af\u7684\u65f6\u5019\u5411\u5de6\u53f3\u632a\u52a8\u53ef\u80fd\u4f1a\u53d1\u751f\u6570\u7ec4\u8d8a\u754c\uff0c\n//\u6240\u4ee5\u76f4\u63a5\u4e09\u500d\uff0c\u53ea\u5904\u7406\u4e2d\u95f4\u4e00\u73af\u5373\u53ef\u3002\n//\u5f53\u4e00\u4e2a\u7aef\u70b9\u786e\u5b9a\u662f\uff0c\u8be5\u533a\u95f4\u6269\u5c55\u65f6\uff0c\u6700\u5927\u503c\u975e\u4e25\u683c\u5355\u8c03\u9012\u589e\uff0c\u7528\u4e8c\u5206\uff0c+st\u8868\u7ef4\u62a4 \nint Log[N];\nint a[N],b[3*N];\nint n;\nint f[N];\nint read()\n{\n\tint f=1,x=0;\n\tchar s=getchar();\n\twhile(s<'0'||s>'9'){if(s=='-')f=-1;s=getchar();}\n\twhile(s>='0'&&s<='9'){x=(x<<1)+(x<<3)+(s^'0');s=getchar();}\n\treturn f*x;\n} \nint max(int a,int b)\n{\n\tif(a>b) return a;\n\telse return b;\n}\nint min(int a,int b)\n{\n\tif(a<b) return a;\n\telse return b;\n}\nint RMQ(int l,int r)\n{\n\tint k=Log[r-l+1];\n\treturn max(Max[l][k],Max[r-(1ll<<k)+1][k]);\n}\nvoid prepare()\n{\n\tfor(int i=1;i<=n;i++)//\u6bcf\u6b21\u4e8c\u5206\u6700\u957f\u4e3a\u4e00\u4e2a\u94fe\uff0c\u4e0d\u9700\u8981\u5904\u7406\u8fc7\u591a \n\t\tLog[i]=log2(i);\n\tfor(int j=1;j<M;j++)\n\t\tfor(int i=1;i+(1ll<<j)-1<=3*n;i++)\n\t\t\tMax[i][j]=max(Max[i][j-1],Max[i+(1ll<<(j-1))][j-1]);\n}\nvoid erfen()\n{\n\tint len=n/2;\n\tfor(int i=n+1;i<=n+n;i++)\n\t{\n\t\tint ans=0x3f3f3f3f;\n\t\tif(RMQ(i-len,i-1)>=b[i])// \u627e\u5de6\u8fb9 |i-len+1-----i-1|//\u6ce8\u610f\u6ca1\u6709i\uff01\uff01\uff01 \n\t\t{\n\t\t\tint l=i-len;\n\t\t\tint r=i-1;//Wrong\uff0c\u6700\u540e\u4e0d\u80fd\u6709i\u8fd9\u4e2a\u4f4d\u7f6e \n\t\t\twhile(l<=r)\n\t\t\t{\n\t\t\t\tint mid=(l+r)>>1;\n\t\t\t\tint cal=RMQ(mid,i-1);\n\t\t\t\t//printf(\"l= %d , r= %d , mid= %d , cal= %d\\n\",l,r,mid,cal);\n\t\t\t\tif(cal>=b[i])//Wrong\u5728\u8fd9\u4e2a\u8303\u56f4\u5185\u6709\uff0c\u7f29\u5c0f\u8303\u56f4 \n\t\t\t\t{\n\t\t\t\t\t//std::cout<<\"b[i]= \"<<b[i]<<std::endl;\n\t\t\t\t\tans=min(ans,i-mid);\n\t\t\t\t\tl=mid+1;\n\t\t\t\t}\n\t\t\t\telse r=mid-1;//\u6269\u5927\u8303\u56f4\u7ee7\u7eed\u627e \n\t\t\t}\n\t\t}\n\t\tif(RMQ(i+1,i+len)>=b[i])// \u627e\u53f3\u8fb9 |i+1------i+len-1|\uff0c\u4e0d\u8981\u5305\u542bi\uff01\uff01\uff01 \n\t\t{\n\t\t\tint l=i+1;\n\t\t\tint r=i+len;\n\t\t\twhile(l<=r)\n\t\t\t{\n\t\t\t\tint mid=(l+r)>>1;\n\t\t\t\tint cal=RMQ(i+1,mid);//Wrong \n\t\t\t\t//printf(\"l= %d , r= %d , mid= %d , cal= %d\\n\",l,r,mid,cal);\n\t\t\t\tif(cal>=b[i])\n\t\t\t\t{\n\t\t\t\t\tans=min(ans,mid-i);\n\t\t\t\t\tr=mid-1;\n\t\t\t\t}\n\t\t\t\telse l=mid+1; \n\t\t\t}\n\t\t}\n\t\tif(ans!=0x3f3f3f3f)\n\t\t\tprintf(\"%d \",ans);\n\t\telse printf(\"-1 \");\n\t}\n}\nint main()\n{\n\tn=read();\n\tfor(int i=1;i<=n;i++)\n\t\tMax[i][0]=Max[i+n][0]=Max[i+n+n][0]=read();\n\tfor(int i=1;i<=n;i++)\n\t\tb[i]=b[i+n]=b[i+n+n]=read();\n\tprepare();\n\terfen();\n\treturn 0;\n}\n```",
        "postTime": 1621995140,
        "uid": 230804,
        "name": "Durancer",
        "ccfLevel": 4,
        "title": "\u3010\u9898\u89e3\u3011P7333 [JRKSJ R1] JFCA"
    },
    {
        "content": "### \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u73af\uff0c\u6c42\u4e00\u4e2a $a_j \\ge b_i$ \u4e14\u8ddd\u79bb\u6700\u8fd1\u7684\u70b9\u3002\n\n### \u9898\u89e3\n\n\u5bf9\u4e8e $20\\%$ \u7684\u70b9\uff0c\u76f4\u63a5\u66b4\u529b\u5411\u5de6\u53f3\u6269\u5c55\u5c31\u53ef\u4ee5\u3002\n\n\u5bf9\u4e8e $100\\%$ \u7684\u70b9\uff0c\u5148\u65ad\u73af\u6210\u94fe\uff0c\u4e09\u500d\u7a7a\u95f4\u3002\u6211\u4eec\u6ce8\u610f\u5230\u968f\u7740\u533a\u95f4\u7684\u6269\u5927\uff0c\u6700\u5927\u503c\u662f\u5448\u975e\u4e25\u683c\u5355\u8c03\u9012\u589e\u7684\u72b6\u6001\u7684\u3002\u56e0\u4e3a\u533a\u95f4\u6269\u5927\u7684\u540c\u65f6\u4e5f\u5305\u542b\u7740\u539f\u533a\u95f4\uff0c\u90a3\u4e48\u6700\u5927\u503c\u4e0d\u4f1a\u5c0f\u4e8e\u539f\u6700\u5927\u503c\u3002\u6839\u636e\u8fd9\u4e2a\u53ef\u4ee5\u8fdb\u884c\u4e8c\u5206\uff0c\u5355\u6b21\u8be2\u95ee\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\log n)$.\n\n\u540c\u65f6\u53ef\u4ee5\u7528 $\\tt{ST}$ \u8868\u6765\u5e73\u8861\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u603b\u590d\u6742\u5ea6 $O(n\\log n)$.\n\n\u8981\u6ce8\u610f $i \\not= j$.\n\n```cpp\n#include <cstdio>\n#include <iostream>\n\nusing namespace std;\n\ninline int read() {\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9') {if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9') {x=x*10+ch-'0';ch=getchar();}\n\treturn x*f;\n}\n\nconst int N=3e5+5;\nconst int Logn=23;\n\nint n;\nint logn[N],f[N][Logn+5];\n\nvoid init() {//\u6253\u4e00\u4e2alog2\u7684\u8868\n\tlogn[1]=0;\n\tlogn[2]=1;\n\tfor(int i=3;i<=n+n+n;i++) logn[i]=logn[i>>1]+1;\n}\n\nint query(int l,int r) {//\u67e5\u8be2\u533a\u95f4\u6700\u5927\u503c\n\tint s=logn[r-l+1];\n\treturn max(f[l][s],f[r-(1<<s)+1][s]);\n}\n\nint binary_search(int a,int x) {//\u4e8c\u5206\n\tint l=1,r=n;\n\twhile(l<r) {\n\t\tint mid=l+((r-l)>>1);//\u7b49\u540c\u4e8el+r>>1\n\t\tif(max(query(x-mid,x-1),query(x+1,x+mid))>=a) r=mid;\n\t\telse l=mid+1;\t\n\t}\n\treturn l==n?-1:l;\n}\n\nint main() {\n\tn=read();\n\tfor(int i=1;i<=n;i++) f[i+n+n][0]=f[i+n][0]=f[i][0]=read();//\u65ad\u73af\u6210\u94fe\n\tinit();\n\tfor(int j=1;j<=Logn;j++) {\n\t\tfor(int i=1;i+(1<<j)-1<=n+n+n;i++) {\n\t\t\tf[i][j]=max(f[i][j-1],f[i+(1<<(j-1))][j-1]);\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++) {\n\t\tint b=read();\n\t\tprintf(\"%d \",binary_search(b,i+n));\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1674406341,
        "uid": 448593,
        "name": "ldh081122",
        "ccfLevel": 4,
        "title": "P7333 [JRKSJ R1] JFCA \u9898\u89e3"
    },
    {
        "content": "[\u539f\u9898\u94fe\u63a5](https://www.luogu.com.cn/problem/P7333)\n \n[\u535a\u5ba2\u98df\u7528](https://www.luogu.com.cn/blog/solution-p7333)\n\n---\n\n**solution 1**\n \n\u76f4\u63a5\u66b4\u529b\u679a\u4e3e\u957f\u5ea6\uff0c\u590d\u6742\u5ea6 $O(n^2)$ \uff0c\u53ef\u4ee5\u8fc7 $\\text{subtask\\space1}$\n\n\u671f $\\text{20pts}$\n\n---\n\n**solution 2**\n\n\u5b9a\u4e49 $\\operatorname{Max}(p,q)$ \u4e3a $\\max_{i=p}^{i\\leq q} a_i$\n\n\u4e8c\u5206\u957f\u5ea6\uff0c\u6bcf\u6b21\u53d6 $\\max(\\operatorname{MAX}(i-mid,i-1),\\operatorname{MAX}(i+1,i+mid))$\uff0c\u5224\u65ad\u5176\u662f\u5426\u5927\u4e8e $b_i$\n\n\u65ad\u73af\u4e3a\u94fe\uff0c\u7528\u4e09\u500d\u7a7a\u95f4\u5b58 $a$ \u6570\u7ec4\uff0c\u5176\u4e2d $a_i=a_{i+n}=a_{i+n+n}$\n\n\u6240\u4ee5\u539f\u6765\u7684\u516c\u5f0f\u5e94\u8be5\u53d8\u6210\n\n$$\\max(\\operatorname{MAX}(n+i-mid,n+i-1),\\operatorname{MAX}(n+i+1,n+i+mid))$$\n\n\u8ba1\u7b97\u4e24\u4e2a $\\operatorname{MAX}$ \uff0c\u7528 ST\u8868\n\n\u6ce8\u610f ST\u8868 \u9700\u8981\u5f00\u4e09\u500d\u7a7a\u95f4\uff0c\u5bf9\u5e94 $a$ \u6570\u7ec4\u7684\u65ad\u73af\u4e3a\u94fe\u4e09\u500d\u7a7a\u95f4\n\n---\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<stdio.h>\n#include<math.h>\nint n,n3,a[300001],b[100001];\ninline const int& max2(const int& a,const int& b){return a > b ? a : b;}\ntemplate<int maxn> struct ST{\n\tint st[maxn + 1][33];\n\tvoid init(){\n\t    for(int i = 1;i <= n3;++i) st[i][0] = a[i];\n\t\tfor(int j = 1;(1 << j) <= n3;++j)\n\t\t\tfor(int i = 1;i + (1 << j) - 1 <= n3;++i)\n\t\t\t\tst[i][j] = max2(st[i][j - 1],st[i + (1 << (j - 1))][j - 1]);\n\t}\n\tint query(int l,int r){\n\t\tint j = log2(r - l + 1);\n\t\treturn max2(st[l][j],st[r - (1 << j) + 1][j]);\n\t}\n};\nST<300000> st;\nint main(){\n\tscanf(\"%d\",&n),n3 = n * 3;\n\tfor(int i = 1;i <= n;++i) scanf(\"%d\",a + i),a[i + n] = a[i + n + n] = a[i];\n\tfor(int i = 1;i <= n;++i) scanf(\"%d\",b + i);\n\tst.init();\n\tfor(int i = 1;i <= n;++i){\n\t\tint l = 1,r = n;\n\t\twhile(l < r){\n\t\t\tint mid = l + r >> 1;\n\t\t\tif(max2(st.query(n + i + 1,n + i + mid),st.query(n + i - mid,n + i - 1)) >= b[i]) r = mid;\n\t\t\telse l = mid + 1;\n\t\t}\n\t\tif(l == n) printf(\"-1 \");\n\t\telse printf(\"%d \",l);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1620976696,
        "uid": 368107,
        "name": "xfrvq",
        "ccfLevel": 7,
        "title": "\u9898\u89e3-P7333"
    },
    {
        "content": "# $\\text{Description:}$\n\n\u73af\u4e0a\u627e\u4e00\u4e2a\u5927\u4e8e\u8fd9\u4e2a\u70b9\u4e14\u8ddd\u79bb\u6700\u8fd1\u7684\u70b9\n\n# $\\text{Solution:}$\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u5047\u5982\u533a\u95f4 $[l,r]$ \u6ee1\u8db3\u6761\u4ef6\uff0c\u663e\u7136 $[l,r+1]$ \u4e5f\u6ee1\u8db3\uff0c\u6ee1\u8db3\u5355\u8c03\u6027\u76f4\u63a5\u4e8c\u5206max\u5c31\u597d\uff0c\u4e8c\u5206\u957f\u5ea6\uff0c\u7136\u540e\u6b63\u53cd\u6765\u4e00\u6b21\uff0cmax\u76f4\u63a5ST\u8868\uff0c\u7136\u540e\u4e0d\u5199\u65ad\u73af\u6210\u94fe\u7684\u8bdd\u7279\u5224\u4e00\u4e0b\u5c31\u597d\u4e86\u3002\n\n\u590d\u6742\u5ea6 $O(n\\log n)$\n\n# $\\text{Code:}$\n\n```cpp\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\n#include <iostream>\n#include <cmath>\n\n#define N (int)(1e5+5) \n\nusing namespace std;\n\nint f[N][20],a[N],b[N],n;\n\nint rd() {\n\tint f=1,sum=0; char ch=getchar();\n\twhile(!isdigit(ch)) {if(ch=='-') f=-1;ch=getchar();}\n\twhile(isdigit(ch)) {sum=(sum<<3)+(sum<<1)+ch-'0';ch=getchar();}\n\treturn sum*f;\n}\n\nint gt(int l,int r) {\n//\tcout<<l<<\" \"<<r<<endl;\n\tif(l<1) return max(gt(n+l,n),gt(1,r));\n\tif(r>n) return max(gt(l,n),gt(1,r-n));\n\tif(l>r) return 0;\n\t\n\tint le=r-l+1,qwq=log2(le); \n\treturn max(f[l][qwq],f[r-(1<<qwq)+1][qwq]);\n} \n\nint main() {\n\tn=rd();\n\tfor(int i=1;i<=n;i++) a[i]=rd(),f[i][0]=a[i];\n\tfor(int i=1;i<=n;i++) b[i]=rd();\n\tfor(int i=1;i<=18;i++)\n\t\tfor(int j=1;j<=n-(1<<i)+1;j++)\n\t\t\tf[j][i]=max(f[j][i-1],f[j+(1<<(i-1))][i-1]);\n\tfor(int i=1;i<=n;i++) {\n\t\tint l=1,r=n-1,answ=0x7fffffff;\n\t\twhile(l<=r) {\n\t\t\tint mid=(l+r)>>1,res=gt(i+1,i+mid);\n\t\t\tif(res>=b[i]) answ=min(answ,mid),r=mid-1;\n\t\t\telse l=mid+1;\n\t\t//\tcout<<res<<endl;\n\t\t}\n\t\tl=1,r=n-1;\n\t\twhile(l<=r) {\n\t\t\tint mid=(l+r)>>1,res=gt(i-mid,i-1);\n\t\t\tif(res>=b[i]) answ=min(answ,mid),r=mid-1;\n\t\t\telse l=mid+1;\n\t\t//\tcout<<res<<endl;\n\t\t}\n\t\tprintf(\"%d \",answ==0x7fffffff?-1:answ);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1619321737,
        "uid": 125901,
        "name": "FxorG",
        "ccfLevel": 7,
        "title": "P7333 [JRKSJ R1] JFCA"
    },
    {
        "content": "ST \u8868 + \u4e8c\u5206\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$ \u505a\u6cd5\u3002\n\n\u53d1\u73b0\u6211\u4eec\u8981\u627e\u7684\u4e1c\u897f\u548c\u533a\u95f4\u6700\u5927\u503c\u6709\u5173\u3002\n\n\u7136\u540e\u8fd9\u4e1c\u897f\u4e0d\u7528\u4fee\u6539\u3002\n\n\u663e\u7136\u60f3\u5230 ST \u8868\u3002\n\n\u7136\u540e\u53d1\u73b0\u5bf9\u4e8e\u7aef\u70b9\u56fa\u5b9a\u7684\u4e00\u4e2a\u533a\u95f4\uff0c$\\max$ \u503c\u5355\u8c03\u4e0d\u964d\u3002\n\n\u5f88\u660e\u663e\u7684\u4e8c\u5206\u4e86\u3002\n\n\u5b9e\u73b0\u770b\u4ee3\u7801\uff0c\u6ce8\u610f\u5224\u8fb9\u754c\u548c $-1$\uff0c\u65ad\u73af\u6210\u94fe\u5f00\u4e09\u500d\u7a7a\u95f4\u5373\u53ef\u3002\n\n```cpp\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\nusing namespace std;\nconst int MAXN=1e6+10;\ninline int read()\n{\n    char c=getchar();int x=0,f=1;\n    while(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n    while(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\n    return x*f;\n}\nint Max[MAXN][21];\nint Query(int l,int r)\n{\n    int k=log2(r-l+1); \n    return max(Max[l][k],Max[r-(1<<k)+1][k]);}\nint main()\n{\n    int N=read(),M=N;\n    for(int i=1;i<=N;i++) Max[i][0]=Max[i+N][0]=Max[i+N+N][0]=read();\n    for(int j=1;j<=21;j++)\n        for(int i=1;i+(1<<j)-1<=N+N+N;i++)\n            Max[i][j]=max(Max[i][j-1],Max[i+(1<<(j-1))][j-1]);\n    for(int i=1;i<=M;i++)\n    {\n        int x=read();\n        int l=i+1,r=N+i-1,ans=-1,res=99999999;\n        if(Query(l,r)<x)\n        {\n            l=N+i+1,r=N+N+i-1;\n            if(Query(l,r)<x){printf(\"-1 \");continue;}\n            while(l<=r)\n            {\n                int mid=(l+r)>>1;\n                if(Query(N+i+1,mid)>=x)ans=mid,r=mid-1;\n                else l=mid+1;\n            }\n            printf(\"%d \",ans-i-N);\n        }\n        else\n        {\n            while(l<=r)\n            {\n                int mid=(l+r)>>1;\n                if(Query(mid,N+i-1)>=x)ans=mid,l=mid+1;\n                else r=mid-1;\n            }\n            res=i+N-ans;\n        }\n        l=N+i+1,r=N+N+i-1;\n        if(Query(l,r)<x){printf(\"%d \",res);continue;}\n        while(l<=r)\n        {\n            int mid=(l+r)>>1;\n            if(Query(N+i+1,mid)>=x)ans=mid,r=mid-1;\n            else l=mid+1;\n        }\n        int yp=ans-i-N;if(yp>res)yp=res;\n        printf(\"%d \",yp);\n    }\n    return 0;\n}\n```",
        "postTime": 1612702852,
        "uid": 171487,
        "name": "cmll02",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P7333 \u3010[JRKSJ R1] JFCA\u3011"
    },
    {
        "content": "[**_\u539f\u9898_**](https://www.luogu.com.cn/problem/P7333)  \n\n\u4e00\u9053\u4e0d\u96be\u7684\u9898\u76ee\u3002  \n\n\u9898\u610f\u5df2\u7ecf\u5f88\u660e\u786e\u4e86\u3002\u6211\u4eec\u53d1\u73b0\u6570\u636e\u8303\u56f4\u662f $1\\leq n\\leq 10^5$\uff0c\u53ef\u4ee5\u60f3\u5230\u6b63\u89e3\u662f\u4e00\u4e2a $\\mathcal{O}(n\\sqrt {n})$ \u6216 $\\mathcal{O}(n \\log n)$ \u7684\u505a\u6cd5\u3002  \n\n## \u9898\u89e3  \n\n\n\u6211\u4eec\u8981\u627e\u5230\u4e0e $x$ \u8ddd\u79bb\u6700\u8fd1\u7684 $i$\uff0c\u663e\u7136\u662f\u6309\u4ece $x$ \u9012\u589e\u548c\u9012\u51cf\u4e24\u4e2a\u65b9\u5411\u53bb\u6bd4\u8f83\u3002\u590d\u6742\u5ea6\u52a3\u7684\u4e3b\u8981\u539f\u56e0\u662f\u6bd4\u8f83\u5f88\u591a\u4e0d\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\uff0c\u5373 $a_i$ \u7684\u503c\u6bd4 $b_x$ \u5c0f\u3002  \n\n\u4e3a\u4e86\u4f18\u5316\u590d\u6742\u5ea6\uff0c\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u533a\u95f4\u5185 $a_i$ \u6700\u5927\u503c\uff0c\u5982\u679c\u533a\u95f4\u6700\u5927\u503c\u6bd4  $b_x$ \u5c0f\uff0c\u90a3\u6574\u4e2a\u533a\u95f4\u90fd\u4e0d\u4f1a\u6709\u7b26\u5408\u9898\u610f\u7684 $a_i$\uff0c\u5927\u5927\u51cf\u5c11\u4e86\u6bd4\u8f83\u6b21\u6570\u3002  \n\n\u4f46\u56e0\u4e3a\u8fd9\u662f\u4e00\u4e2a\u73af\uff0c\u4e3a\u4e86\u65ad\u73af\u6210\u94fe\uff0c\u9700\u8981\u5f00\u4e09\u500d\u7a7a\u95f4\uff0c\u65b9\u4fbf\u5904\u7406\u5de6\u53f3\u8fb9\u754c\uff0c\u5e76\u5c06\u539f\u6765\u7684 $\\left[1,n\\right]$ \u653e\u5230 $\\left[n+1,n+n\\right]$ \u5185\u5904\u7406\uff0c\u540c\u65f6\u8fd8\u6709\u4e2a\u5c0f\u7ec6\u8282\uff0c\u5373\u7279\u5224\u5f53 $f_x=n$ \u65f6\uff0c\u8fd9\u8bf4\u660e $x$ \u7ed5\u4e86 $n$ \u4e2a\u6570\u56de\u5230\u4e86 $x$\uff0c\u6b64\u65f6\u5c06 $f_x \\gets -1$\u3002\n\n\n\u5bb9\u6613\u60f3\u5230\u5206\u5757\u3002  \n\n\u5bf9\u4e8e $x$ \u6240\u5728\u7684\u5757\u5185\uff0c\u76f4\u63a5\u66b4\u529b\u679a\u4e3e\u5757\u8fb9\u3002\u7136\u540e\u50cf\u539f\u6765\u4e00\u6837\uff0c\u6309\u8ddd $x$ \u7684\u8ddd\u79bb\u9012\u589e\u6bd4\u8f83\u6bcf\u4e2a\u5757\uff0c\u82e5\u5757\u5185\u6700\u5927\u503c\u5927\u4e8e $b_x$\uff0c\u5c31\u7ee7\u7eed\u6309\u8ddd $x$ \u7684\u8ddd\u79bb\u9012\u589e\u6bd4\u8f83\u6bcf\u4e2a\u6570\uff0c\u627e\u5230\u8ddd $x$ \u6700\u8fd1\u7684 $i$ \u4f7f $a_i \\geq b_x$\u3002  \n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal{O}(n\\sqrt{n})$\uff0c\u4f46\u56e0\u4e3a\u5bf9\u4e8e\u968f\u673a\u671f\u671b\u8fd0\u884c\u6b21\u6570\u5f88\u5c11\uff0c\u8dd1\u5f97\u98de\u5feb\u3002  \n\n\u60a8\u4e5f\u53ef\u4ee5\u50cf\u51fa\u9898\u4eba\u90a3\u6837\u5199\u4e8c\u5206 ST \u8868\uff0c\u601d\u8def\u90fd\u5f88\u7b80\u5355\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N = 1e5 + 10;\nint n , a[N * 3] , b[N * 3] , belong[N * 3] , f[N];\nint L , C , s[N * 3] , t[N * 3] , maxx[N * 3];\nvoid init() {\n    C = 0;\n    L = sqrt(3 * n);\n    for(int i = 1; i <= n * 3; i += L) {\n        s[++ C] = i;\n        t[C] = min(n * 3 , i + L - 1);\n        for(int j = s[C]; j <= t[C]; j ++) {\n            belong[j] = C;\n            maxx[C] = max(maxx[C] , a[j]);\n        }\n    }\n}\nint query_l(int x , int k) {\n\tint edge = belong[x];\n\tfor(int i = x - 1; i >= s[edge]; i --) \n\t\tif(a[i] >= k) \n\t\t\treturn x - i;\n\tfor(int i = edge - 1; i >= 1; i --) \n\t\tif(maxx[i] >= k) \n\t\t\tfor(int j = t[i]; j >= s[i]; j --) \n\t\t\t\tif(a[j] >= k) \n\t\t\t\t\treturn x - j;\n\treturn -1;\n}\nint query_r(int x , int k) {\n\tint edge = belong[x];\n\tfor(int i = x + 1; i <= t[edge]; i ++) \n\t\tif(a[i] >= k) \n\t\t\treturn i - x;\n\tfor(int i = edge + 1; i <= C; i ++) \n\t\tif(maxx[i] >= k) \n\t\t\tfor(int j = s[i]; j <= t[i]; j ++) \n\t\t\t\tif(a[j] >= k) \n\t\t\t\t\treturn j - x;\n\treturn -1;\n}\nint main() {\n\tscanf(\"%d\" , &n);\n\tfor(int i = 1; i <= n; i ++) \n\t\tscanf(\"%d\" , &a[i]) , a[i + n] = a[i] , a[i + n + n] = a[i];\n\tfor(int i = 1; i <= n; i ++)\n\t\tscanf(\"%d\" , &b[i]);\n\tinit();\n\tfor(int i = 1; i <= n; i ++) {\n\t\tf[i] = min(query_l(n + i , b[i]) , query_r(n + i , b[i]));\n\t\tif(f[i] == n) \n\t\t\tf[i] = -1;\n\t}\n\tfor(int i = 1; i <= n; i ++) \n\t\tprintf(\"%d \" , f[i]);\n\treturn 0;\n}\n```  ",
        "postTime": 1612686980,
        "uid": 365107,
        "name": "Terac",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P7333 [JRKSJ R1] JFCA"
    },
    {
        "content": "### [\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P7333)\n\n## \u9898\u610f\u7b80\u8ff0:  \n\u5bf9\u4e8e\u6bcf\u4e2a $b_j$ \uff08$1 \\leq j \\leq n$\uff09\u627e\u5230\u6700\u8fd1\u7684\u5927\u4e0e\u7b49\u4e8e\u5b83\u7684 $a_i$,\u8981\u6c42 $i \\neq j$\u3002\u8f93\u51fa $\\operatorname{abs}(i-j)$\uff0c\u5982\u679c\u6ca1\u6709\u5219\u8f93\u51fa $-1$\u3002\n\n## \u89e3\u9898\u601d\u8def\uff1a  \n\u5bf9\u4e8e\u8d77\u70b9 $j$\uff0c\u6211\u4eec\u67e5\u627e $j$ \u5de6\u8fb9\u533a\u95f4\u7684\u6700\u5927\u503c\u4e2d\u6ee1\u8db3 $a_i \\geq b_j$ \u4e14\u5de6\u8fb9\u754c\u6700\u8fd1\u7684\u3002\u5bf9\u4e8e\u8d77\u70b9 $j$\uff0c\u6211\u4eec\u67e5\u627e $j$ \u53f3\u8fb9\u533a\u95f4\u7684\u6700\u5927\u503c\u4e2d\u6ee1\u8db3 $a_i \\geq b_j$ \u4e14\u53f3\u8fb9\u754c\u6700\u8fd1\u7684\u3002  \n\u5bf9\u4e8e\u8fd9\u4e24\u4e2a\u95ee\u9898\uff0c\u533a\u95f4\u6700\u503c\u53ef\u4ee5\u4f7f\u7528ST\u8868\u8fdb\u884c $\\mathcal{O}(1)$ \u8be2\u95ee\uff0c\u533a\u95f4\u7684\u8fb9\u754c\u53ef\u4ee5\u7528\u4e8c\u5206\u6765\u67e5\u627e\uff0c\u56e0\u4e3a\u6211\u4eec\u53d1\u73b0\uff0c\u4ece $j$ \u4e3a\u8d77\u70b9\uff0c\u5f80\u5de6\u6269\u5c55\u8fb9\u754c\u7684\u533a\u95f4\u6700\u5927\u503c\u662f\u9012\u589e\u7684\uff0c\u4ece $j$ \u4e3a\u8d77\u70b9\uff0c\u5f80\u53f3\u6269\u5c55\u8fb9\u754c\u7684\u533a\u95f4\u6700\u5927\u503c\u4e5f\u662f\u9012\u589e\u7684\u3002  \n\u6570\u7ec4\u6709\u5e8f\uff0c\u7b26\u5408\u4e8c\u5206\u67e5\u627e\u7684\u6761\u4ef6\u3002\n\n## Code:  \n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint n,l,r,len,mid,a[300005],b[300005],dp[300005][25],log_2[300005];\nbool check(int l,int r,int x)//\u5224\u65ad [l,r] \u533a\u95f4\u7684\u6700\u5927\u503c\u662f\u5426\u5927\u4e8e\u7b49\u4e8e x\n{\n    int s=log_2[r-l+1];\n    int cnt=max(dp[l][s],dp[r-(1<<s)+1][s]);\n    if (cnt>=x)\n        return true;\n    return false;\n}\nint help(int pos)//\u4e8c\u5206\u641c\u7d22\u8fb9\u754c\n{\n    len=n;\n    r=pos-1;\n    l=pos-n+1;\n    while(l<=r)//\u641c\u7d22\u5de6\u8fb9\n    {\n        mid=(l+r)/2;\n        if (check(mid,r,b[pos-n])==true)\n        {\n            l=mid+1;\n            len=min(len,pos-mid);\n        }\n        else\n            r=mid-1;\n    }\n    l=pos+1;\n    r=pos+n-1;\n    while(l<=r)//\u641c\u7d22\u53f3\u8fb9\n    {\n        mid=(l+r)/2;\n        if (check(l,mid,b[pos-n])==true)\n        {\n            r=mid-1;\n            len=min(len,mid-pos);\n        }\n        else\n            l=mid+1;\n    }\n    if (len==n)\n        return -1;\n    return len;\n}\nsigned main()\n{\n    cin >> n;\n    for(int i=1; i<=n; i++)//\u521d\u59cb\u5316\n    {\n        cin >> a[i];\n        dp[i][0]=dp[i+n][0]=dp[i+2*n][0]=a[i];\n    }\n    for(int i=1; i<=n; i++)\n        cin >> b[i];\n    for(int i=1; i<=20; i++)//\u9884\u5904\u7406 dp \u6570\u7ec4\n        for(int j=1; j+(1<<i)-1<=3*n; j++)\n            dp[j][i]=max(dp[j][i-1],dp[j+(1<<(i-1))][i-1]);\n    for(int i=2; i<=3*n; i++)//\u9884\u5904\u7406 log_2 \u6570\u7ec4\n        log_2[i]=log_2[i/2]+1;\n    for(int i=1; i<=n; i++)//\u5229\u7528\u4e8c\u5206\u67e5\u627e\u5e76\u8f93\u51fa\u7b54\u6848\n        cout << help(i+n) << \" \";\n    return 0;\n}\n```",
        "postTime": 1648945756,
        "uid": 367194,
        "name": "kdy20100729",
        "ccfLevel": 0,
        "title": "P7333 \u9898\u89e3"
    },
    {
        "content": "\u6211\u7684\u505a\u6cd5\u4e0e\u697c\u4e0a\u7684\u51e0\u4f4d\u5de8\u4f6c\u4eec\u7684\u622a\u7136\u4e0d\u540c\uff0c\u8bf4\u5230\u5e95\u8fd8\u662f\u6ca1\u6709\u7075\u654f\u5730\u4e00\u773c\u770b\u51fa\u53ef\u4ee5\u7528**\u4e8c\u5206**\u505a,\u4f46\u662f\uff0c\u6211\u7684\u8fd9\u79cd\u65b9\u6cd5\u4e5f\u5e76\u4e0d\u6bd4\u4ed6\u4eec\u6162\u3002\n\n\u63a5\u4e0b\u6765\u8bb2\u4e00\u8bb2\u6211\u7684\u65b9\u6cd5\uff0c\u9996\u5148\u9898\u76ee\u4e2d\u8bf4\u662f\u4e00\u4e2an\u4e2a\u70b9\u7684**\u73af**\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u8f93\u5165\u65f6**\u65ad\u73af\u4e3a\u94fe**\uff1a\n```cpp\nfor(RI i=1;i<=n;i=-~i){\n\tscanf(\"%d\",&a[i]);\n\ta[i+n]=a[i];\n}\nfor(RI i=1;i<=n;i=-~i){\n\tscanf(\"%d\",&b[i]);\n\tb[i+n]=b[i];\n}\n```\n\u7136\u540e,\u5faa\u73af\u9010\u4e00\u6c42\u89e3\uff0c\u4e0d\u8fc7\u5bf9\u4e8e\u53cc\u91cd\u5faa\u73af\u7684$O(n^2)$\u590d\u6742\u5ea6\u662f\u5fc5\u5b9a\u4f1a\u8d85\u65f6\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u8fdb\u884c\u4e00\u4e9b**\u526a\u679d\u548c\u4f18\u5316**\u3002\n\n\u5bf9\u4e8e$a_i$,\u5b83\u53ef\u4ee5\u5e2e\u52a9\u5176\u4ed6$b_i$\u6c42\u89e3\uff0c\u56e0\u6b64\u6211\u4eec\u8981\u628a\u5b83\u5b58\u4e0b\u6765\uff0c\u4e0d\u8fc7\u5e76\u4e0d\u662f\u6240\u6709\u7684\u90fd\u8981\u5b58\uff0c\u56e0\u4e3a\u4f46$a_i$\u6bd4$a_j$\u5927\u4e14$i>j$,\u5219\u5b8c\u5168\u53ef\u4ee5\u5c06$a_j$\u4ece\u4e2d**\u5220\u53bb**\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u4e2a**\u5355\u8c03\u6808**\u5b58\u50a8\uff1a\n```cpp\nfor(RI j=t;j>0;--j)\n\tif(d[j][1]>=b[i]){\n\t\tif(i%n==d[j][0]) break;\n\t\tf[i%n]=min(f[i%n],i-d[j][0]);//\u8bb0\u5f55\u7b54\u6848\n\t\tbreak;\n\t}\nwhile(d[t][1]<=a[i]&&t) --t;//\u5220\u9664\u5143\u7d20\nd[++t][1]=a[i];d[t][0]=i;\n```\n\n\u5bf9\u4e8e$b_i$,\u5c31\u4e0d\u80fd\u5c06\u5b83\u5220\u53bb\uff0c\u56e0\u4e3a\u90a3\u6837\u5c31\u6ca1\u6709\u7b54\u6848\u4e86\u3002\u6240\u4ee5\u53ea\u80fd\u5728\u6bcf\u6b21\u5faa\u73af\u65f6\u6bd4\u8f83$a_i$\u548c$b_j$\u7684\u5927\u5c0f\uff0c\u5982\u679c$b_j\\le a_j$,\u5219\u8bb0\u5f55\u7b54\u6848\u3002\u4f46\u662f\u9010\u4e00\u6bd4\u8f83\u7684\u8bdd\u5176\u590d\u6742\u5ea6\u53c8\u4f1a\u9000\u56de\u5230$O(n^2)$\u3002\u53d1\u73b0\u6bcf\u6b21\u5927\u5faa\u73af$a_i$\u53ea\u6709\u4e00\u4e2a\uff0c\u4f46$b_j$\u6709\u591a\u4e2a\uff0c\u4e8e\u662f\u4fbf\u53ef\u4ee5\u7ed9b\u88c5\u4e00\u4e2a**\u4f18\u5148\u961f\u5217**\uff0c\u5f53$a_i$\u5c0f\u4e8e\u524d\u9762\u8f83\u5c0f\u7684\u5143\u7d20\u65f6\u5c31\u53ef\u76f4\u63a5\u9000\u51fa\u5faa\u73af:\n\n```cpp\nwhile(q.size()&&a[i]>=-q.top().first){\n\tif(i%n==q.top().second) break;\n\tf[q.top().s%n]=min(f[q.top().s%n],i-q.top().s);//\u8bb0\u5f55\u7b54\u6848\n\tq.pop();\n}\nq.push((du){-b[i],i});\n```\n\n\u63a5\u4e0b\u6765\u5949\u4e0a\u5b8c\u6574\u7684\u4ee3\u7801:\n\n```cpp\n#include<bits/stdc++.h>\n#define RI register int\n#define du pair<int,int> \n#define f first\n#define s second\n#define ru(x,y) q.push((du){-x,y})\nusing namespace std;\nconst int N=1e5+3;\nint a[N<<1],b[N<<1],f[N],d[N<<1][2];\ninline int min(int x,int y){return x<y?x:y;}\npriority_queue<du>q;\nint main(){\n\tRI n,t=0;\n\tmemset(f,127/3,sizeof f);\n\tscanf(\"%d\",&n);\n\tfor(RI i=1;i<=n;i=-~i){\n\t\tscanf(\"%d\",&a[i]);\n\t\ta[i+n]=a[i];\n\t}\n\tfor(RI i=1;i<=n;i=-~i){\n\t\tscanf(\"%d\",&b[i]);\n\t\tb[i+n]=b[i];\n\t}\n\tfor(RI i=1,m=n<<1;i<=m;i=-~i){\n\t\tfor(RI j=t;j>0;--j)\n\t\t\tif(d[j][1]>=b[i]){\n\t\t\t\tif(i%n==d[j][0]) break;\n\t\t\t\tf[i%n]=min(f[i%n],i-d[j][0]);\n\t\t\t\tbreak;\n\t\t\t}\n      while(d[t][1]<=a[i]&&t) --t;\n\t\td[++t][1]=a[i];d[t][0]=i;\n\t\twhile(q.size()&&a[i]>=-q.top().f){\n\t\t\tif(i%n==q.top().s) break;\n\t\t\tf[q.top().s%n]=min(f[q.top().s%n],i-q.top().s);\n\t\t\tq.pop();\n\t\t}\n\t\tru(b[i],i);\n\t}\n\tfor(RI i=1;i<n;i=-~i)\n\t\tprintf(\"%d \",f[i]>n?-1:f[i]);\n\tprintf(\"%d\",f[0]>n?-1:f[0]);//\u6ce8\u610fn%n==0\n\treturn 0;\n}\n```\n\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u662f$O(nlogn)$,\u52a0\u4e0a\u4ebf\u4e9b\u5361\u5e38\u7684\u8bdd\u53ef\u4ee527ms\u8dd1\u8fc7\u3002",
        "postTime": 1612921501,
        "uid": 133037,
        "name": "_OccDreamer_",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P7333 \u3010[JRKSJ R1] JFCA\u3011"
    },
    {
        "content": "$\\color{blue}{\\texttt{[Problem]}}$\n\n$n$ \u4e2a\u6570\u5bf9 $(a_i,b_i)$ \u5728\u540c\u4e00\u4e2a\u73af\u4e0a\uff0c\u4f60\u9700\u8981\u6c42\u51fa $f_{1 \\cdots n}$\uff0c\u4f7f\u5f97 $f_{i}$ \u7b49\u4e8e\u6ee1\u8db3 $a_{j}\\geq b_{i}$ \u7684\u79bb $i$ **\u6700\u8fd1**\u7684 $j$ \u5230 $i$ \u7684**\u8ddd\u79bb**\u3002\n\n$\\color{blue}{\\texttt{[Solution]}}$\n\n\u6ce8\u610f\u6211\u4eec\u8981\u6c42\u7684\u662f\u8ddd\u79bb\u3002\n\n\u8fd9\u4e2a\u4e1c\u897f\u662f\u6709\u5355\u8c03\u6027\uff08A.K.A. \u53ef\u4e8c\u5206\u6027\uff09\u7684\uff0c\u5373\u5982\u679c $x$ \u7684\u8ddd\u79bb\u5185\u6709\u70b9 $j$ \u6ee1\u8db3 $a_{j}>b_{i}$\uff0c\u5219 $(x+1)$ \u7684\u8ddd\u79bb\u5185\u4e00\u5b9a\u4e5f\u6709\uff08\u70b9 $j$ \u660e\u663e\u5c31\u662f\u561b\uff09\u3002\n\n\u8fd9\u4e2a\u7ed3\u8bba\u6709\u4ec0\u4e48\u7528\uff1f\u5f88\u7b80\u5355\uff0c\u6211\u4eec\u53ef\u4ee5**\u4e8c\u5206\u7b54\u6848**\u3002\n\n\u5177\u4f53\u6765\u8bf4\uff0c\u6211\u4eec\u5148\u8981\u7834\u73af\u4e3a\u94fe\uff0c\u628a\u94fe\u4e09\u500d\uff0c\u4f7f $a_{i+2 \\times n}=a_{i+n}=a_i$\u3002\u8fd9\u6837\u533a\u95f4 $[i-t,i-1]$ \u548c $[i+1,i+t]$ \u5c31\u662f\u6240\u6709\u5230 $i$ \u8ddd\u79bb $\\leq t$ \u7684\u70b9\u3002\n\n\u5982\u4f55\u5feb\u901f\u5224\u65ad\u8fd9\u4e2a\u533a\u95f4\u5185\u6709\u6ca1\u6709\u6ee1\u8db3\u6761\u4ef6\u7684\u70b9\u5462\uff1f\u5f88\u7b80\u5355\uff0c\u53ea\u8981\u8fd9\u4e9b\u70b9\u4e2d\u6700\u5927\u7684 $a_{k}\\geq b_{i}$ \u5373\u53ef\u3002\n\n\u5982\u4f55\u5feb\u901f\u5730\u6c42\u51fa\u6700\u5927\u503c\u5462\uff1f\u5f88\u7b80\u5355\uff0c\u7528\u4e00\u4e2a **ST \u8868**\u5373\u53ef\u3002\n\n\u6700\u540e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$T(3 \\times n \\times \\log (3 \\times n)+n \\times \\log (3 \\times n))=O(n \\times \\log n)$\u3002\n\n$\\color{blue}{\\texttt{[code]}}$\n\n```cpp\nconst int N=1e5+100;\nint lg[N*3],f[20][N*3],n,a[N*3];\ninline int query(int l,int r){\n\tregister int s=lg[r-l+1];\n\treturn max(f[s][l],f[s][r-(1<<s)+1]);\n}\ninline bool check(int t,int i,int x){\n\treturn max(query(i-t,i-1),query(i+1,i+t))>=x;\n}\ninline int work(int x,int i){\n\tint l=1,r=n-1,ans=-1;\n\twhile (l<=r){\n\t\tint mid=(l+r)>>1;\n\t\tif (check(mid,i,x)){\n\t\t\tans=mid;\n\t\t\tr=mid-1;\n\t\t}\n\t\telse l=mid+1;\n\t}\n\treturn ans;\n}\nint main(){\n\tn=read();lg[0]=-1;\n\tfor(int i=1;i<=n;i++)\n\t\ta[i+2*n]=a[i+n]=a[i]=read();\n\tfor(int i=1;i<=3*n;i++){\n\t\tlg[i]=lg[i>>1]+1;\n\t\tf[0][i]=a[i];\n\t}\n\tfor(int j=1;(1<<j)<=3*n;j++)\n\t\tfor(int i=1;i+(1<<j)-1<=3*n;i++)\n\t\t\tf[j][i]=max(f[j-1][i],f[j-1][i+(1<<(j-1))]);\n\tfor(int i=1;i<=n;i++){\n\t\tprintf(\"%d \",work(read(),i+n));\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1621169613,
        "uid": 95624,
        "name": "HPXXZYY",
        "ccfLevel": 7,
        "title": "the Solution of the Problem P7333"
    },
    {
        "content": "\u8003\u8651\u4e8c\u5206\u8ddd\u79bb\u3002\n\n\u7136\u540e\u6765\u8003\u8651 check \u600e\u4e48\u6253\u3002\n\n\u6574\u4e00\u4e2a ST \u8868\u7ef4\u62a4 $a$ \u7684\u6700\u5927\u503c\uff0c\u7136\u540e\u4e8c\u5206\u8ddd\u79bb\u7684\u65f6\u5019\u5224\u65ad\u8ddd\u79bb\u5185\u6709\u65e0\u6ee1\u8db3\u6761\u4ef6\u7684\u5143\u7d20\u5373\u53ef\u3002\n\n\u6ce8\u610f\u6b64\u9898\u7684\u5751\u70b9\u5728\u4e8e\u4f60 Query \u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\u4e0d\u80fd\u628a\u81ea\u5df1\u5305\u542b\u8fdb\u53bb\u3002\n\n\u5177\u4f53\u6765\u8bf4\u5c31\u662f\u62c6\u8be2\u95ee\u3002\n\n\u628a \u4e00\u4e2a $[l,r]$ \u62c6\u6210 $[l,x],[x+1,r]$\uff0c\u7136\u540e\u8ba8\u8bba\u4e00\u4e0b\u3002\n\n```cpp\n#include <bits/stdc++.h>\n\nconst int N = 2e5, L = 20;\n\nint n, a[N + 5], b[N + 5];\n\nstruct RangeMaxQuery {\n\tint f[N + 5][L + 5];\n\t\n\tvoid initTable() {\n\t\tfor (int i = 1; i <= n; ++i) {\n\t\t\tf[i][0] = a[i];\n\t\t}\n\t\t\n\t\tint lim = std::log(n) / std::log(2) + 1;\n\t\tfor (int j = 1; j <= lim; ++j) {\n\t\t\tfor (int i = 1; i <= n - (1 << j) + 1; ++i) {\n\t\t\t\tf[i][j] = std::max(f[i][j - 1], f[i + (1 << (j - 1))][j - 1]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tint rangeQ(int l, int r) {\n\t\tif (l > r) {\n\t\t\treturn 0;\n\t\t}\n\t\tint len = std::log(r - l + 1) / std::log(2);\n\t\treturn std::max(f[l][len], f[r - (1 << len) + 1][len]);\n\t}\n\t\n\tint rangeQuery(int l, int r) {\n\t\tif (l >= 1 && r <= n) {\n\t\t\treturn rangeQ(l, r);\n\t\t} else if (l <= 0 && r <= n) {\n\t\t\treturn std::max(rangeQ(n + l, n), rangeQ(1, r));\n\t\t} else {\n\t\t\treturn std::max(rangeQ(l, n), rangeQ(1, r - n));\n\t\t}\n\t}\n} rmqEr;\n\nint calc(int x) {\n\tint l = 1, r = n / 2, res = 0;\n//\tstd::cout << \"\\n{\" << x << \"}\\n\";\n\twhile (l <= r) {\n//\t\tstd::cout << \"[\" << l << \" \" << r << \"]\\n\";\n\t\tint mid = (l + r) / 2;\n\t\tif (std::max(rmqEr.rangeQuery(x - mid, x - 1), rmqEr.rangeQuery(x + 1, x + mid)) >= b[x]) {\n\t\t\tr = mid - 1;\n\t\t\tres = mid;\n\t\t} else {\n\t\t\tl = mid + 1;\n\t\t}\n\t}\n//\tstd::cout << \"\\n(\" << x << \" \" << res << \")\\n\";\n\tif (res == 0) {\n\t\treturn -1;\n\t} else {\n\t\treturn res;\n\t}\n}\n\nint main() {\n\tstd::ios::sync_with_stdio(0);\n\tstd::cin.tie(0);\n\tstd::cout.tie(0);\n\tstd::cin >> n;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tstd::cin >> a[i];\n\t}\n\tfor (int i = 1; i <= n; ++i) {\n\t\tstd::cin >> b[i];\n\t}\n\trmqEr.initTable();\n\tfor (int i = 1; i <= n; ++i) {\n\t\tstd::cout << calc(i) << ' ';\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1612688194,
        "uid": 161849,
        "name": "cirnovsky",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P7333 \u3010[JRKSJ R1] JFCA\u3011"
    }
]
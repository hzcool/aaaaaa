[
    {
        "content": "\u6c42\u51fa\u5bf9\u4e8e\u8239\u7684\u5de6\u4e0a\u89d2\uff0c\u5728\u54ea\u4e9b\u70b9\u662f\u5408\u6cd5\u7684\uff0c\u90a3\u4e48$bfs$\u5373\u53ef\u3002(\u6ce8\u610f\u5de6\u4e0a\u89d2\u6709\u53ef\u80fd\u8d85\u51fa\u5730\u56fe\uff0c\u5373\u5750\u6807\u6709\u53ef\u80fd\u4e3a\u8d1f)\n\n\n\u4f46\u8981\u6c42\u8239\u5168\u90e8\u5408\u6cd5\u6bd4\u8f83\u9ebb\u70e6\uff0c\u53ef\u4ee5\u53ea\u8003\u8651\u5404\u4e2a\u8fb9\u754c\u7684\u5408\u6cd5\u3002\n\n\n\u6bd4\u5982\u4ece\u4e0a\u5f80\u4e0b\u8d70\u65f6\uff0c\u5c31\u53ea\u7528\u8003\u8651\u79fb\u52a8\u540e\u4e0b\u8fb9\u754c\u7684\u5408\u6cd5\uff0c\u56e0\u4e3a\u5176\u4ed6\u7684\u70b9\u90fd\u662f\u548c\u539f\u6765\u7684\u8239\u4f53\u91cd\u53e0\u7684\u3002\n\n\n\u8003\u8651\u5728$(x,y)$\u5904\u4e0b\u8fb9\u754c\u5408\u6cd5\u5c31\u662f$s[x+d_{i}][y+i]=0(i=0..k)$\uff0c\u5176\u4e2d$d_{i}$\u8868\u793a\u8239\u4f53\u4ece\u5de6\u5f80\u53f3\u7b2c$i$\u5217\u4e0b\u8fb9\u754c\u7684\u884c\uff0c$k$\u8868\u793a\u8239\u5bbd\u3002\n\n\n\u90a3\u4e48\u679a\u4e3e\u5217\uff0c\u5c06\u5176\u4ed6\u5217\u5206\u522b\u79fb\u52a8$d_{i}$\u4f4d\u518d$or$\u8d77\u6765\uff0c\u5c31\u5f97\u5230\u4e86\u8fd9\u4e00\u5217\u7684\u7b54\u6848\u3002\n\n\n\u7528$bitset$\u5b9e\u73b0\uff0c\u65f6\u95f4$O(n^3/32)$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\ntemplate <typename T> void chmin(T &x,const T &y)\n{\n    if(x>y)x=y;\n}\ntemplate <typename T> void chmax(T &x,const T &y)\n{\n    if(x<y)x=y;\n}\ntypedef unsigned int ui;\n#define rep(i,l,r) for(int i=l;i<=r;++i)\nconst int N=2000+5;\nint n,u;\ntemplate <int N>\nstruct BITSET\n{\nstatic const int U=N/32+2;\nui a[U];\nvoid set1(int x)\n{\n    a[x/32]|=1<<(x&31);\n}\nbool operator [](int x)\n{\n    return a[x/32]&(1<<(x&31));\n}\n};\nvoid or_left_move(ui *a,ui *b,int x)//a|=b<<x  b[0..u]\n{\n    int dk=x/32,dl=x&31;\n    if(!dl)\n    {\n        rep(i,0,u)a[i+dk]|=b[i];\n        return ;\n    }\n    rep(i,0,u)\n    {\n        a[i+dk]|=b[i]<<dl;\n        a[i+dk+1]|=b[i]>>32-dl; \n    }\n}\nstruct F\n{\nchar s[N][N];\nBITSET<N>a[N];\nBITSET<N*2>cant[N*2];\nint x0,y0;//left up\nint x1,y1;//right down\nint d[N];\nvoid init()\n{\n    x0=y0=n;\n    rep(i,1,n)\n    rep(j,1,n)\n    if(s[i][j]=='X')\n     a[j].set1(i);\n    else\n    if(s[i][j]=='r')\n    {\n        chmin(x0,i);chmin(y0,j);\n        chmax(x1,i);chmax(y1,j);\n        chmax(d[j],i);\n    }\n    rep(j,-n,n)\n    rep(j2,max(1,j),min(n,j+y1-y0))\n    if(d[y0+j2-j]) or_left_move(cant[N+j].a,a[j2].a,N-(d[y0+j2-j]-x0)); \n}\nbool judge(int x,int y)\n{\n    return !cant[N+y][x+1+N];\n}\n};\nF f[4];//f[0] judge if can move down;f[1] up;f[2] right;f[3] left;\nint g[N*2][N*2];\nstruct point\n{\n    short x,y;\n};\npoint q[N*N*2*2];int tail;\nint dis;\nvoid out()\n{\n    cout<<dis;exit(0);\n}\nvoid push(short x,short y)\n{\n    q[++tail]=(point){x,y};g[N+x][N+y]=dis;\n}\n\nint main()\n{\n    freopen(\"1.in\",\"r\",stdin);freopen(\"1.out\",\"w\",stdout);\n    cin>>n;u=n/32;\n    rep(i,1,n)scanf(\"%s\",f[0].s[i]+1);\n    rep(i,1,n)\n    rep(j,1,n)f[1].s[n-i+1][n-j+1]=f[2].s[j][n-i+1]=f[3].s[n-j+1][i]=f[0].s[i][j];\n    rep(i,0,3)f[i].init(); \n    memset(g,-1,sizeof(g));\n    push(f[0].x0,f[0].y0);\n    rep(head,1,tail)\n    {\n        short x=q[head].x,y=q[head].y;\n        dis=g[N+x][N+y]+1;\n        if(g[N+x+1][N+y]==-1&&f[0].judge(x,y))\n        {\n            if(x==n) out();\n            push(x+1,y);\n        }\n        int _x=x+f[0].x1-f[0].x0,_y=y+f[0].y1-f[0].y0;\n        //(_x,_y)\n        if(g[N+x-1][N+y]==-1&&f[1].judge(n-_x+1,n-_y+1))\n        {\n            if(_x==1) out();\n            push(x-1,y); \n        }\n        //(_x,y)\n        if(g[N+x][N+y+1]==-1&&f[2].judge(y,n-_x+1))\n        {\n            if(y==n) out();\n            push(x,y+1);\n        }\n        //(x,_y)\n        if(g[N+x][N+y-1]==-1&&f[3].judge(n-_y+1,x))\n        {\n            if(_y==1) out();\n            push(x,y-1);\n        }\n    }\n    puts(\"NIE\");\n}\n```",
        "postTime": 1515997218,
        "uid": 9168,
        "name": "kczno1",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3468 \u3010[POI2008]ROB-Robinson\u3011"
    }
]
[
    {
        "content": "\u7ef4\u62a4x\u6b21\u65b9\u6c42\u548c\u597d\u50cf\u90fd\u80fd\u5361\u3002\u3002\n\n\u8003\u8651\u4ec0\u4e48\u65f6\u5019\u80fd\u7ec4\u6210\u7b49\u5dee\u6570\u5217\u3002\n\n1. \u9996\u5148$\\mathrm{max-min=(r-l)k}$\n2. \u5176\u6b21**\u76f8\u90bb\u4e24\u6570\u5dee\u7684\u7edd\u5bf9\u503c**\u7684$\\gcd$\u662f$k$\n3. \u533a\u95f4$[l,r]$\u5185\u7684\u6570\u4e0d\u91cd\u590d\n\n\u6ee1\u8db3\u6027\u8d281\u3002\u6211\u4eec\u628a$[l,r]$\u5185\u7684\u6570\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u51cf\u53bb\u6700\u5c0f\u503c\uff0c\u5f97\u5230$\\{0,a,b,c,\\cdots,(r-l)k\\}$\n\n\u6ee1\u8db3\u6027\u8d282\u3002\u8bf4\u660e$a,b,c,\\cdots$\u90fd\u662f$k$\u7684\u500d\u6570\u3002\u90fd\u9664\u4ee5$k$\uff0c\u5f97\u5230$\\{0,a',b',c',\\cdots,r-l\\}$\n\n\u6ee1\u8db3\u6027\u8d283\u3002\u6570\u4e0d\u91cd\u590d\uff0c\u90a3\u4e48$a',b',c',\\cdots$\u53ea\u80fd\u662f$1,2,3,\\cdots$\n\n\u6240\u4ee5\u80fd\u7ec4\u6210\u516c\u5dee\u662f$k$\u7684\u7b49\u5dee\u6570\u5217\u3002\n\n\u73b0\u5728\u6765\u770b\u9700\u8981\u7ef4\u62a4\u4ec0\u4e48\u3002\n\n\u6700\u5927\u503c\uff0c\u6700\u5c0f\u503c\uff0c\u524d\u9a71\u7684\u6700\u5927\u503c\uff0c\u533a\u95f4\u5de6\u7aef\u70b9\u6570\u503c\uff0c\u533a\u95f4\u53f3\u7aef\u70b9\u6570\u503c\uff0c\u5dee\u7684$\\mathrm{gcd}$\n\n\u8fd9\u91cc\u524d\u9a71\u6307\u524d\u9762\u51fa\u73b0\u8fd9\u4e2a\u6570\u7684\u6700\u540e\u4e00\u4e2a\u4f4d\u7f6e\u3002\n\n\u7ebf\u6bb5\u6811,map,set\u7ef4\u62a4\u5373\u53ef\uff0c\u6ce8\u610f\u5f3a\u5236\u5728\u7ebf\n\n```cpp\n#include<cstdio>\n#include<set>\n#include<map>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nconst int N=6e5+50;\ninline void rad(int &_){\n    static char ch;\n    while(ch=getchar(),ch<'0'||ch>'9');_=ch-48;\n    while(ch=getchar(),ch<='9'&&ch>='0')_=_*10+ch-48;\n}\nint gcd(int u,int v){return v?gcd(v,u%v):u;}\nint n,m,x,y,z,cnt,opt,las;\nint a[N],pre[N],net[N];\nmap<int,int>mp;\nset<int>s[N];\ntypedef set<int>::iterator IT;\nstruct node{\n    int lval,rval,mx,mn,mnp,gc;\n    node(){}\n    node(int A,int B,int C,int D,int E,int F):lval(A),rval(B),mx(C),mn(D),mnp(E),gc(F){}\n}r;\nstruct tree{\n    node tre[N<<3];\n    node update(node u,node v){\n        return node(u.lval,v.rval,max(u.mx,v.mx),min(u.mn,v.mn),max(u.mnp,v.mnp),gcd(gcd(u.gc,v.gc),abs(u.rval-v.lval)));\n    }\n    void mktree(int now,int ls,int rs){\n        if(ls==rs){\n            tre[now]=(node){a[ls],a[ls],a[ls],a[ls],pre[ls],0};\n            return;\n        }\n        int noww=now<<1,nrs=ls+rs>>1;\n        mktree(noww,ls,nrs);\n        mktree(noww|1,nrs+1,rs);\n        tre[now]=update(tre[noww],tre[noww|1]);\n    }\n    void change(int now,int ls,int rs,int mb,node val){\n        if(ls>mb||rs<mb)return;\n        if(ls==rs){tre[now]=val;return;}\n        int noww=now<<1,nrs=ls+rs>>1;\n        change(noww,ls,nrs,mb,val);\n        change(noww|1,nrs+1,rs,mb,val);\n        tre[now]=update(tre[noww],tre[noww|1]);\n    }\n    node query(int now,int ls,int rs,int zuo,int you){\n        if(ls>=zuo&&rs<=you)return tre[now];\n        int noww=now<<1,nrs=ls+rs>>1;\n        if(you<=nrs)return query(noww,ls,nrs,zuo,you);\n        if(zuo>nrs)return query(noww|1,nrs+1,rs,zuo,you);\n        return update(query(noww,ls,nrs,zuo,you),query(noww|1,nrs+1,rs,zuo,you));\n    }\n}t;\nint main(){\n    rad(n);rad(m);\n    for(int i=1;i<=n;i++){\n        rad(x);a[i]=x;\n        if(mp.find(x)==mp.end())mp[x]=++cnt,s[cnt].insert(i);\n        else{\n            y=mp[x];\n            z=*--s[y].end();\n            pre[i]=z;\n            net[z]=i;//\u8bb0\u5f55\u6bcf\u4e2a\u6570\u7684\u524d\u9a71\u540e\u7ee7\n            s[y].insert(i);//\u4e22\u5230set\u91cc\n        }\n    }\n    t.mktree(1,1,n);\n    for(int i=1;i<=m;i++){\n        rad(opt);\n        if(opt==1){\n            rad(x);rad(y);\n            x^=las;y^=las;\n            net[pre[x]]=net[x];\n            pre[net[x]]=pre[x];//\u4fee\u6539\u524d\u9a71\u540e\u7ee7\n            z=a[net[x]];\n            t.change(1,1,n,net[x],node(z,z,z,z,pre[x],0));//\u4fee\u6539\u540e\u7ee7\u5728\u7ebf\u6bb5\u6811\u5185\u7684\u4fe1\u606f\n            s[mp[a[x]]].erase(x);//set\u4e2d\u5220\u9664\n            if(mp.find(y)==mp.end()){\n                mp[y]=++cnt,s[cnt].insert(i);\n                pre[x]=net[x]=0;\n            }else{\n                z=mp[y];\n                IT it=s[z].lower_bound(x);//set\u7684lower_bound\u627e\u524d\u9a71\u540e\u7ee7\n                if(it==s[z].begin()){//\u6709\u540e\u7ee7\u65e0\u524d\u9a71\n                    pre[x]=0;net[x]=*it;\n                    pre[*it]=x;\n                    t.change(1,1,n,*it,node(a[*it],a[*it],a[*it],a[*it],x,0));//\u4fee\u6539\u540e\u7ee7\u5728\u7ebf\u6bb5\u6811\u5185\u7684\u4fe1\u606f\n                }else if(it==s[z].end()){//\u6709\u524d\u9a71\u65e0\u540e\u7ee7\n                    --it;\n                    pre[x]=*it;net[x]=0;\n                    net[*it]=x;\n                }else{//\u6709\u524d\u9a71\u6709\u540e\u7ee7\n                    IT It=--it;++it;\n                    pre[x]=*It;net[x]=*it;\n                    net[*It]=x;pre[*it]=x;\n                    t.change(1,1,n,*it,node(a[*it],a[*it],a[*it],a[*it],x,0));//\u4fee\u6539\u540e\u7ee7\u5728\u7ebf\u6bb5\u6811\u5185\u7684\u4fe1\u606f\n                }\n            }\n            a[x]=y;\n            t.change(1,1,n,x,node(y,y,y,y,pre[x],0));//\u4fee\u6539\u81ea\u8eab\u4fe1\u606f\n        }else{\n            rad(x);rad(y);rad(z);\n            x^=las;y^=las;z^=las;\n            r=t.query(1,1,n,x,y);\n            if((r.mx-r.mn==z*(y-x))&&(r.gc==z||!r.gc)&&(r.mnp<x||!z))las++,puts(\"Yes\");//\u8fd9\u91cc\u6ce8\u610f\u4e00\u4e0b\n            else puts(\"No\");\n        }\n    }\n}\n```",
        "postTime": 1554164161,
        "uid": 50092,
        "name": "da32s1da",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P5278 \u3010\u7b97\u672f\u5929\u624d\u2468\u4e0e\u7b49\u5dee\u6570\u5217\u3011"
    },
    {
        "content": "### \u8fd9\u662f\u4e00\u79cd\u4e71\u641e\u505a\u6cd5\uff0c\u975e\u6b63\u89e3\u3002   \n\n\u8fd9\u91cc\u7528\u4e86hash\u7684\u601d\u60f3\uff0c\u7c7b\u6bd4\u8fd9\u4e2a\u9898\u76ee\uff1a  \n[P3792 \u7531\u4e43\u4e0e\u5927\u6bcd\u795e\u539f\u578b\u548c\u5076\u50cf\u5d07\u62dc ](https://www.luogu.org/problemnew/show/P3792)  \n\n\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u7ef4\u62a4\u533a\u95f4\u5e73\u65b9\u548c\uff0c\u7531\u4e8e\u51fa\u9898\u4eba\u975e\u5e38\u826f\u5fc3\uff0c\u6240\u4ee5\u8fd9\u4e2a\u65b9\u6cd5\u6ca1\u6709\u88ab\u5361\u6389\u3002   \n\u5bf9\u4e8e\u53ef\u4ee5\u91cd\u6392\u4e3a\u516c\u5dee\u4e3a $k$ \u7684\u533a\u95f4 $[l,r]$\uff0c\u8bbe\u5176\u6700\u5c0f\u503c\u4e3a $x$\uff0c\u5219\u4e00\u5b9a\u6709\uff1a  \n$$ \\sum\\limits_{i=l}^ra_i^2=\\sum\\limits_{i=0}^{r-l}(x+ki)^2$$  \n**\u6ce8\u610f\u8fd9\u4e2a\u53ea\u662f\u5145\u5206\u6761\u4ef6\uff0c\u4e0d\u5177\u6709\u5fc5\u8981\u6027\u3002**  \n\n\u7136\u540e\u6211\u4eec\u628a\u7b49\u5f0f\u53f3\u8fb9\u5c55\u5f00\u4e00\u4e0b\n$$ \\sum\\limits_{i=0}^{r-l}(x+ki)^2$$ \n$$ =\\sum\\limits_{i=0}^{r-l}(x^2+2xki+k^2i^2)$$  \n$$ =(r-l+1)x^2+kx(r-l)(r-l+1)+k^2\\sum\\limits_{i=0}^{r-l}i^2$$\n \n \n\u5f0f\u5b50\u5c55\u5f00\u5230\u8fd9\u91cc\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97\u4e86\u3002  \n\u533a\u95f4\u6700\u5c0f\u503c $x$ \u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\uff0c\u6700\u53f3\u8fb9\u90a3\u4e00\u9879\u5957\u5e73\u65b9\u548c\u516c\u5f0f\u5373\u53ef\u3002  \n$$\\sum\\limits_{i=1}^ni^2=\\frac{n(n+1)(2n+1)}{6}$$  \n\u6700\u540e\uff0c\u628a\u7b97\u51fa\u6765\u7684\u7ed3\u679c\u4e0e\u533a\u95f4\u5b9e\u9645\u5e73\u65b9\u548c\u8fdb\u884c\u6bd4\u8f83\u3002  \n\u5982\u679c\u4e00\u6837\uff0c\u5c31\u8f93\u51fa `Yes`\uff0c\u5426\u5219\u8f93\u51fa `No`\u3002  \n\u6ce8\u610f\u5e73\u65b9\u548c\u7684\u7ed3\u679c\u53ef\u80fd\u5f88\u5927\uff0c\u6240\u4ee5\u6211\u4eec\u968f\u4fbf\u627e\u4e2a\u8d28\u6570\u819c\u4e00\u4e0b\uff0c\u51e0\u4e4e\u4e0d\u4f1a\u5f71\u54cd\u5230\u7b54\u6848\u7684\u6b63\u786e\u6027\u3002\n\n\u7136\u540e\u6211\u7684\u975e\u6b63\u89e3\u5c31\u6c34\u8fc7\u4e86\u8fd9\u4e2a\u9898 23333  \n\n\u4ee3\u7801\uff1a  \n```cpp\n#include<cstdio> \n#include<iostream>\n#include<cstring>\n#include<algorithm>\n#include<vector>\n#define int long long\n#define N 300003\n#define reg register\n#define p 998244353\n#define ls (u<<1)\n#define rs (u<<1|1)\n#define mid ((l+r)>>1)\n#define inf 0x3f3f3f3f\nusing namespace std;\n\nint w[N],a[N<<2],minn[N<<2],s[N<<2];\nint n,q,key;\n\ninline void read(int &x);\ninline int power(int a,int t);\nvoid build(int l,int r,int u);\ninline void pushup(int u);\ninline int min(int x,int y);\nvoid modify(int t,int k,int l,int r,int u);\nint qmin(int nl,int nr,int l,int r,int u);\nint qsqr(int nl,int nr,int l,int r,int u);\ninline int inv(int x);\n\nsigned main(){\n    int op,l,r,x,y,k,t,sum,sqr;\n    int len,inv6;\n    inv6 = inv(6);\n    read(n),read(q);\n    for(int i=1;i<=n;++i) read(w[i]);\n    build(1,n,1);\n    while(q--){\n        read(op);\n        if(op==1){\n            read(x),read(y);\n            x ^= key,y ^= key;\n            modify(x,y,1,n,1);\n            w[x] = y;\n        }else{\n            read(l),read(r),read(k);\n            l ^= key,r ^= key;\n            k ^= key;\n            len = r-l+1;\n            x = qmin(l,r,1,n,1);\n            sqr = qsqr(l,r,1,n,1);\n            t = len*x%p*x%p;\n            t = t+x*k%p*len%p*(len-1)%p;\n            t %= p;\n            --len;\n            sum = k*k%p*(len*(len+1)%p*((len<<1)+1)%p*inv6%p)%p;\n            t = (t+sum)%p;\n            if(t!=sqr){\n                printf(\"No\\n\");\n                continue;\n            } \n            printf(\"Yes\\n\");\n            ++key;\n        }\n    }\n    return 0;\n}\n\ninline int inv(int x){\n    return power(x,p-2);\n}\n\nint qsqr(int nl,int nr,int l,int r,int u){\n    if(nl<=l&&r<=nr) return s[u];\n    int res = 0;\n    if(nl<=mid) res += qsqr(nl,nr,l,mid,ls);\n    if(nr>mid) res += qsqr(nl,nr,mid+1,r,rs);\n    return res%p;\n}\n\nint qmin(int nl,int nr,int l,int r,int u){\n    if(nl<=l&&r<=nr) return minn[u];\n    int res = inf;\n    if(nl<=mid) res = min(res,qmin(nl,nr,l,mid,ls));\n    if(nr>mid) res = min(res,qmin(nl,nr,mid+1,r,rs));\n    return res;\n}\n\nvoid modify(int t,int k,int l,int r,int u){\n    if(l==r){\n        a[u] = minn[u] = k;\n        s[u] = k*k%p;\n        return;\n    }\n    if(t<=mid) modify(t,k,l,mid,ls);\n    else modify(t,k,mid+1,r,rs);\n    pushup(u);\n}\n\ninline void pushup(int u){\n    a[u] = (a[ls]+a[rs])%p;\n    s[u] = (s[ls]+s[rs])%p;\n    minn[u] = min(minn[ls],minn[rs]);\n}\n\nvoid build(int l,int r,int u){\n    if(l==r){\n        a[u] = minn[u] = w[l];\n        s[u] = w[l]*w[l]%p;\n        return;\n    }\n    build(l,mid,ls);\n    build(mid+1,r,rs);\n    pushup(u);\n}\n\ninline int min(int x,int y){\n    return x<y?x:y;\n}\n\ninline void read(int &x){\n    x = 0;\n    char c = getchar();\n    while(c<'0'||c>'9') c = getchar();\n    while(c>='0'&&c<='9'){\n        x = (x<<3)+(x<<1)+(c^48);\n        c = getchar();\n    }\n}\n\ninline int power(int a,int t){\n    int res = 1;\n    while(t){\n        if(t&1) res = res*a%p;\n        a = a*a%p;\n        t >>= 1;\n    }\n    return res;\n}\n```",
        "postTime": 1554132859,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5278 \u3010\u7b97\u672f\u5929\u624d\u2468\u4e0e\u7b49\u5dee\u6570\u5217\u3011"
    },
    {
        "content": "# \u95f2\u626f\n\n\u8fd9\u9053\u9898 $JKLover$ \u8bb2\u8fc7\uff0c\u7136\u540e\u8865\u8bfe\u7684\u65f6\u5019\u8001\u5e08\u4e5f\u63d0\u5230\u4e86\uff0c\u60f3\u4e86\u60f3\u8fd8\u662f\u505a\u4e86\u5427\uff0c\u987a\u4fbf\u5199\u7bc7\u9898\u89e3\u7eaa\u5ff5\u4e00\u4e0b\u3002\n\n# \u9898\u9762\n\n[P5278 \u7b97\u672f\u5929\u624d\u2468\u4e0e\u7b49\u5dee\u6570\u5217](https://www.luogu.org/problem/P5278)\n\n# Solution\n\n\u5bf9\u4e8e\u4e00\u4e2a\u5e8f\u5217\uff0c\u5982\u679c\u5b83\u6392\u5e8f\u540e\u80fd\u6784\u6210\u4e00\u4e2a\u516c\u5dee\u4e3a $d$ \u7b49\u5dee\u6570\u5217\uff0c\u4e00\u5b9a\u6ee1\u8db3\u4e00\u4e0b\u51e0\u70b9\uff1a\n\n1. $max-min=d\\cdot(len-1)$ \u3002\n2. $gcd_{k=i}^{j-1}(val_{k+1}-val_k)=d$ \u3002\n3. \u5e8f\u5217\u4e2d\u6ca1\u6709\u91cd\u590d\u5143\u7d20\u3002\n\n\u524d\u4e24\u4e2a\u6761\u4ef6\u5f88\u597d\u7ef4\u62a4\uff0c\u76f4\u63a5\u4e0a\u7ebf\u6bb5\u6811\u5373\u53ef\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u7740\u91cd\u89e3\u51b3\u7684\u662f\u7b2c $3$ \u4e2a\u6761\u4ef6\u3002\n\n\u6709\u4e00\u4e2a\u5f88\u5de7\u5999\u7684\u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u6c42\u51fa\u6bcf\u4e00\u4e2a\u5143\u7d20\uff0c\u5b83\u5728\u5e8f\u5217\u4e2d\u4e0a\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u5982\u679c\u8fd9\u4e00\u4e2a\u533a\u95f4\u4e2d\u6240\u6709\u5143\u7d20\u4e0a\u4e00\u6b21\u51fa\u73b0\u4f4d\u7f6e\u7684\u6700\u5927\u503c\u5c0f\u4e8e $l$ \uff0c\u90a3\u4e48\u4e00\u5b9a\u6ca1\u6709\u91cd\u590d\u5143\u7d20\u3002\n\n\u56e0\u4e3a\u6570\u636e\u8303\u56f4\u5f88\u5927\uff0c\u800c\u4e14\u662f\u5f3a\u5236\u5728\u7ebf\uff0c\u6240\u4ee5\u6211\u4eec\u7528 $map$ \u5957 $set$ \u5b58\u4e00\u4e0b\uff0c\u5355\u70b9\u4fee\u6539\u65f6\u6ce8\u610f\u4e0b\u8fb9\u754c\u6761\u4ef6\u5373\u53ef\u3002\n\n\u9700\u8981\u6ce8\u610f\u7684\u662f**\u4e00\u4e2a\u6570\u7684\u6570\u5217\u4e5f\u7b97\u662f\u7b49\u5dee\u6570\u5217**\uff0c\u8fd8\u6709\u5728 $d=0$ \u65f6\u6211\u4eec\u76f4\u63a5\u5224\u65ad\u6700\u5927\u503c\u662f\u5426\u7b49\u4e8e\u6700\u5c0f\u503c\u5373\u53ef\u3002\n\n# Code\n\n```c++\n#include<bits/stdc++.h>\n#include<unordered_map>\n#define del(a,i) memset(a,i,sizeof(a))\n#define ll long long\n#define inl inline\n#define il inl void\n#define it inl int\n#define ill inl ll\n#define re register\n#define ri re int\n#define rl re ll\n#define mid ((l+r)>>1)\n#define lowbit(x) (x&(-x))\n#define INF 0x3f3f3f3f\nusing namespace std;\ntemplate<class T>il read(T &x){\n\tint f=1;char k=getchar();x=0;\n\tfor(;k>'9'||k<'0';k=getchar()) if(k=='-') f=-1;\n\tfor(;k>='0'&&k<='9';k=getchar()) x=(x<<3)+(x<<1)+k-'0';\n\tx*=f;\n}\ntemplate<class T>il _print(T x){\n\tif(x/10) _print(x/10);\n\tputchar(x%10+'0');\n}\ntemplate<class T>il print(T x){\n\tif(x<0) putchar('-'),x=-x;\n\t_print(x);\n}\nll mul(ll a,ll b,ll mod){long double c=1.;return (a*b-(ll)(c*a*b/mod)*mod)%mod;}\nit qpow(int x,int m,int mod){\n\tint res=1,bas=x%mod;\n\twhile(m){\n\t\tif(m&1) res=(1ll*res*bas)%mod;\n\t\tbas=(1ll*bas*bas)%mod,m>>=1;\n\t}\n\treturn res%mod;\n}\nconst int MAXN = 3e5+5;\nint n,m,val[MAXN],opt,x,y,k,cnt,pre[MAXN];\nunordered_map<int,set<int> > mp;\nset<int>::iterator ite;\nit gcd(int x,int y){return y==0?x:gcd(y,x%y);}\nit max(int x,int y){return x>y?x:y;}\nit min(int x,int y){return x<y?x:y;}\n#define lc (cur<<1)\n#define rc (cur<<1|1)\nstruct Seg_Tree{\n\tint mx,mn,mx_pre;\n}T[MAXN<<2];\nil pushup(int cur){\n\tT[cur].mn=min(T[lc].mn,T[rc].mn);\n\tT[cur].mx=max(T[lc].mx,T[rc].mx);\n\tT[cur].mx_pre=max(T[lc].mx_pre,T[rc].mx_pre);\n}\nil build_tree(int cur,int l,int r){\n\tif(l==r) return T[cur].mn=T[cur].mx=val[l],T[cur].mx_pre=pre[l],void();\n\tbuild_tree(lc,l,mid),build_tree(rc,mid+1,r);\n\tpushup(cur);\n}\nil updata(int cur,int l,int r,int pos,int k){\n\tif(l==r) return T[cur].mn=T[cur].mx=k,T[cur].mx_pre=pre[l],void();\n\tif(mid>=pos) updata(lc,l,mid,pos,k);\n\telse updata(rc,mid+1,r,pos,k);\n\tpushup(cur);\n}\nit query_mx(int cur,int l,int r,int L,int R){\n\tif(l>=L&&r<=R) return T[cur].mx;\n\tri res=0;\n\tif(mid>=L) res=max(res,query_mx(lc,l,mid,L,R));\n\tif(R>mid) res=max(res,query_mx(rc,mid+1,r,L,R));\n\treturn res;\n}\nit query_mn(int cur,int l,int r,int L,int R){\n\tif(l>=L&&r<=R) return T[cur].mn;\n\tri res=INT_MAX;\n\tif(mid>=L) res=min(res,query_mn(lc,l,mid,L,R));\n\tif(R>mid) res=min(res,query_mn(rc,mid+1,r,L,R));\n\treturn res;\n}\nit query_pre(int cur,int l,int r,int L,int R){\n\tif(l>=L&&r<=R) return T[cur].mx_pre;\n\tri res=-1;\n\tif(mid>=L) res=max(res,query_pre(lc,l,mid,L,R));\n\tif(R>mid) res=max(res,query_pre(rc,mid+1,r,L,R));\n\treturn res;\n}\nstruct Tree{\n\tint d;\n}T1[MAXN<<2];\nint c[MAXN];\nil build(int cur,int l,int r){\n\tif(l==r) return T1[cur].d=c[l],void();\n\tbuild(lc,l,mid),build(rc,mid+1,r);\n\tT1[cur].d=gcd(T1[lc].d,T1[rc].d);\n}\nil updata_d(int cur,int l,int r,int pos){\n\tif(l==r) return T1[cur].d=c[pos],void();\n\tif(mid>=pos) updata_d(lc,l,mid,pos);\n\telse updata_d(rc,mid+1,r,pos);\n\tT1[cur].d=gcd(T1[lc].d,T1[rc].d);\n}\nit query_d(int cur,int l,int r,int L,int R){\n\tif(l>=L&&r<=R) return T1[cur].d;\n\tri res=0;\n\tif(mid>=L) res=gcd(res,query_d(lc,l,mid,L,R));\n\tif(R>mid) res=gcd(res,query_d(rc,mid+1,r,L,R));\n\treturn res;\n}\nit solve(int l,int r,int k){\n\tif(l==r) return 1;\n\tri mx=query_mx(1,1,n,l,r),mn=query_mn(1,1,n,l,r),d=query_d(1,1,n-1,l,r-1),mx_pre=query_pre(1,1,n,l,r);\n\tif(mx-mn!=1ll*(r-l)*k) return 0;\n\tif(k&&mx_pre>=l) return 0;\n\tif(d!=k) return 0;\n\treturn 1;\n}\nint main(){\n//\tfreopen(\".in\",\"r\",stdin);\n//\tfreopen(\".out\",\"w\",stdout);\n\tread(n),read(m);\n\tfor(ri i=1;i<=n;++i) read(val[i]);\n\tfor(ri i=1;i<n;++i) c[i]=abs(val[i+1]-val[i]);\n\tfor(ri i=1;i<=n;++i){\n\t\tif(!mp[val[i]].size()) pre[i]=-1;\n\t\telse{\n\t\t\tite=mp[val[i]].end();--ite;\n\t\t\tpre[i]=*ite;\n\t\t}\n\t\tmp[val[i]].insert(i);\n\t}\n\tbuild_tree(1,1,n),build(1,1,n-1);\n\tfor(ri i=1;i<=m;++i){\n\t\tread(opt),read(x),read(y);\n\t\tx^=cnt,y^=cnt;\n\t\tif(opt==1){\n\t\t\tite=mp[val[x]].find(x);\n\t\t\tif(ite!=mp[val[x]].end()) ++ite,pre[*ite]=pre[x],updata(1,1,n,*ite,val[*ite]);\n\t\t\tmp[val[x]].erase(x),val[x]=y;\n\t\t\tite=mp[val[x]].lower_bound(x);\n\t\t\tif(ite!=mp[val[x]].end()) pre[*ite]=x,updata(1,1,n,*ite,val[*ite]);\n\t\t\tif(ite==mp[val[x]].begin()) pre[x]=-1;\n\t\t\telse --ite,pre[x]=*ite,mp[val[x]].insert(x);\n\t\t\tc[x]=abs(val[x+1]-val[x]),c[x-1]=abs(val[x]-val[x-1]);\n\t\t\tupdata(1,1,n,x,y),updata_d(1,1,n-1,x);\n\t\t\tif(x-1) updata_d(1,1,n-1,x-1);\n\t\t}\n\t\tif(opt==2){\n\t\t\tread(k),k^=cnt;\n\t\t\tif(solve(x,y,k)) puts(\"Yes\"),++cnt;\n\t\t\telse puts(\"No\");\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n# \u603b\u7ed3\n\n\u8fd9\u9053\u9898\u9700\u8981\u8003\u8651\u5230\u80fd\u6784\u6210\u7b49\u5dee\u6570\u5217\u7684\u591a\u79cd\u6761\u4ef6\uff0c\u800c\u4e14\u8fb9\u754c\u9700\u8981\u7279\u522b\u6ce8\u610f\uff0c\u4f46\u662f\u597d\u50cf\u80fd\u7528 $hash$ \u4e71\u641e\u8fc7\u53bb\u3002\n\n\u5c31\u76f4\u63a5\u5b58\u4e00\u4e0b\u533a\u95f4\u6700\u5927\uff0c\u6700\u5c0f\uff0c\u533a\u95f4\u548c\uff0c\u5143\u7d20\u7684\u5e73\u65b9\u548c\uff0c\u7acb\u65b9\u548c\uff0c\u7136\u540e\u5bf9\u4e8e $d$ \uff0c\u6211\u4eec\u6839\u636e\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\uff0c\u7b97\u51fa\u4ee5\u4e0a\u7684 $3$ \u4e2a\u503c\u7684 $hash$ \u503c\uff0c\u7136\u540e\u5224\u65ad\u76f8\u7b49\u5373\u53ef\u3002",
        "postTime": 1570504105,
        "uid": 122273,
        "name": "TheShadow",
        "ccfLevel": 0,
        "title": "P5278 \u7b97\u672f\u5929\u624d\u2468\u4e0e\u7b49\u5dee\u6570\u5217 \u9898\u89e3"
    },
    {
        "content": "\uff08\u8d81\u8fd8\u662f\u6700\u4f18\u89e3\uff0c\u9898\u89e3\u533a\u4e5f\u6ca1\u6709$zkw$\u8dd1\u6765\u5199\u4e00\u7bc7$zkw$\u7684\u9898\u89e3$QWQ$\uff09\n\n# \u9898\u9762\n\n[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5278)\n\n# \u5206\u6790\n\n## Solution 1\n\n\u6839\u636e\u9898\u610f\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u76f4\u63a5\u641e\u80af\u5b9a\u4e0d\u73b0\u5b9e\n\n\u90a3\u4e48\u6211\u4eec\u8003\u8651\u7ef4\u62a4\u5bf9\u4e8e\u4e00\u4e2a\u6574\u6bb5\u533a\u95f4\u7684\u4fe1\u606f\uff0c\u6765\u4ee3\u66ff\u6bcf\u4e00\u4e2a\u70b9\u7684\u4fe1\u606f\n\n\u6240\u4ee5\u5f88\u5bb9\u6613\u60f3\u5230\u54c8\u5e0c\u7684\u505a\u6cd5\n\n\u90a3\u4e48\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u7ef4\u62a4\u533a\u95f4\u7684\u5e73\u65b9\u548c ~~\uff08\u4e3a\u4ec0\u4e48\u5462\uff0c\u522b\u95ee\uff0c\u95ee\u5c31\u662flxl\u8bf4\u7684\uff09~~\n\n\u56e0\u4e3a\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u76f4\u63a5\u641e\u4e00\u4e2a\u786e\u5b9a\u6027\u505a\u6cd5\u7684\u7b97\u6cd5\u6bd4\u8f83\u4e0d\u597d\u60f3\uff0c\n\n\u6240\u4ee5\u6211\u4eec\u5c31\u76f4\u63a5\u5f04\u6210\u8fd9\u79cd\u6b63\u786e\u6027\u6bd4\u8f83\u9ad8\u7684\u505a\u6cd5\n\n\u5c31\u662f\u4e00\u4e2a\u5e8f\u5217\u662f\u7b49\u5dee\u6570\u5217\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u6539\u5199\u5b83\u7684\u5e73\u65b9\u548c\u7684\u5f62\u5f0f\uff08\u5c31\u662f\u795e\u9c7c\u9c7c\u7684\u90a3\u4e2a/kel\uff09\n\n\u7136\u540e\u5e26\u503c\u8fdb\u53bb\u6bd4\u8f83\u4e24\u4e2a\u503c\u76f8\u4e0d\u76f8\u7b49\u5c31\u884c\u4e86/fad\n\u8fd9\u91cc\u6211\u4eec\u7ebf\u6bb5\u6811\u8981\u7ef4\u62a4\u7684\u6709\u4e24\u4e2a\u503c\uff1a\n\n$1.$\u533a\u95f4\u6700\u5c0f\u503c\n\n$2.$\u533a\u95f4\u5e73\u65b9\u548c\n\n\u56e0\u4e3a\u662f\u5355\u70b9\u4fee\u6539\uff0c\u5199\u8d77\u6765\u4e5f\u7279\u522b\u7b80\u5355\uff0c\u8fd9\u91cc\u91c7\u7528\u5e38\u6570\u5c0f\u7684$zkw$\u7ebf\u6bb5\u6811\u5b9e\u73b0\n\n\n## Solution 2\n\n\uff08\u590d\u8ff0\u4e00\u4e0b$lxl$\u7684\u6b63\u89e3\uff09\n\n\u8fd9\u662f\u4e00\u4e2a\u786e\u5b9a\u6027\u505a\u6cd5\u3002~~\uff08lxl\u7ed9\u51fa\u7684\u6b63\u89e3\uff09~~\n\n\u53ef\u4ee5\u8003\u8651\u7ef4\u62a4\u533a\u95f4\u6700\u5c0f\u503c\u548c\u6700\u5927\u503c\n\n\u7136\u540e\u628a\u6574\u4e2a\u533a\u95f4\u5dee\u5206\uff0c\u7ef4\u62a4\u5dee\u5206\u6570\u7ec4\u7684\u533a\u95f4$gcd$\uff0c\u800c\u8fd9\u4e2a$gcd$\u5fc5\u987b\u7b49\u4e8e$k$\uff0c\n\n\u6613\u8bc1\u5176\u4ed6\u60c5\u51b5\u90fd\u4e0d\u6ee1\u8db3\u8fd9\u4e2a\u533a\u95f4\u662f\u4e2a\u7b49\u5dee\u6570\u5217\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u91cd\u590d\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u53ef\u4ee5\u7ef4\u62a4\u4e00\u4e2a\u524d\u9a71\u7684\u6700\u5927\u503c\uff08\u8fd9\u4e2a\u524d\u9a71\u7684\u503c\u5b9a\u4e49\u4e3a\u6570$x$\u524d\u9a71\u6240\u5728\u7684\u4f4d\u7f6e\uff09\n\n\uff08\u8fd8\u6709\u4e00\u79cd\u505a\u6cd5\u662f\u4e00\u7ef4\u6570\u70b9\uff0c\u4f46\u662f\u8fd9\u6837\u505a\u6709\u70b9\u6162\uff0c\u591a\u4e00\u4e2a$log$\uff09\n\n\u90a3\u4e48\u6700\u540e\u5224\u65ad\u4e00\u4e0b\u5c31\u884c\u4e86\n\n# Code\n\n\u8fd9\u91cc\u53ea\u7ed9\u51fa\u7b2c\u4e00\u79cd\u89e3\u6cd5\u7684\u4ee3\u7801 ~~\uff08\u56e0\u4e3a\u7b2c\u4e8c\u79cd\u4e0d\u4f1a~~\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntemplate <typename T>\ninline void read(T &x){\n\tx=0;char ch=getchar();bool f=false;\n\twhile(!isdigit(ch)){if(ch=='-'){f=true;}ch=getchar();}\n\twhile(isdigit(ch)){x=(x<<1)+(x<<3)+(ch^48);ch=getchar();}\n\tx=f?-x:x;\n\treturn ;\n}\ntemplate <typename T>\ninline void write(T x){\n\tif(x<0) putchar('-'),x=-x;\n\tif(x>9) write(x/10);\n\tputchar(x%10^48);\n\treturn ;\n}\n#define int long long\nconst int N=1e6+5,p=998244353;\nint n,m,las;\nint sum[N<<2],minn[N<<2],mi,base,sqr1;\n#define sqr(x) (x*x%p)\n#define inc(x,y) (x+y>=p?x+y-p:x+y)\n#define min(x,y) (x<y?x:y)\n#define max(x,y) (x>y?x:y)\ninline void modify(int x,int k){\n\tminn[base+x]=k;\n\tsum[base+x]=sqr(k);\n\tfor(int i=(base+x)>>1;i;i>>=1){\n\t\tminn[i]=min(minn[i<<1],minn[i<<1|1]);\n\t\tsum[i]=inc(sum[i<<1],sum[i<<1|1]);\n\t}\n\treturn ;\n}\ninline int query1(int x,int y){\n\tint res=0x3f3f3f3f;\n\tfor(int s=base+x-1,t=base+y+1;t-s>1;t>>=1,s>>=1){\n\t\tif(~s&1) res=min(res,minn[s^1]);\n\t\tif(t&1) res=min(res,minn[t^1]);\n\t}\n\treturn res;\n}\ninline int query2(int x,int y){\n\tint res=0;\n\tfor(int s=base+x-1,t=base+y+1;t-s>1;t>>=1,s>>=1){\n\t\tif(~s&1) res=inc(res,sum[s^1]);\n\t\tif(t&1) res=inc(res,sum[t^1]);\n\t}\n\treturn res;\n}\nint QuickPow(int x){\n\tint res=1,y=p-2;\n\twhile(y){\n\t\tif(y&1) res=(res*x)%p;\n\t\tx=(x*x)%p;\n\t\ty>>=1;\n\t}\n\treturn res;\n}\nint de;\nsigned main(){\n\tread(n),read(m);de=QuickPow(6);\n\tbase=(1<<(int)(ceil(log(n+1)/log(2))));\n\tfor(int i=base+1;i<=base+n;i++) read(minn[i]),sum[i]=sqr(minn[i]);\n\tfor(int i=base-1;i>=1;i--) sum[i]=inc(sum[i<<1],sum[i<<1|1]),minn[i]=min(minn[i<<1],minn[i<<1|1]);\n\twhile(m--){\n\t\tint op,x,y,k;\n\t\tread(op),read(x),read(y);\n\t\tx^=las,y^=las;\n\t\tif(op==1) modify(x,y);\n\t\telse{\n\t\t\tread(k);\n\t\t\tk^=las;int len=y-x+1;\n\t\t\tmi=query1(x,y)%p,sqr1=query2(x,y)%p;\n\t\t\tif(inc(inc(len*sqr(mi)%p,k*mi%p*len%p*(len-1)%p),sqr(k)*de%p*(len-1)%p*len%p*((len<<1)-1)%p)==sqr1){\n\t\t\t\tlas++;\n\t\t\t\tputs(\"Yes\");\n\t\t\t}\n\t\t\telse puts(\"No\");\n\t\t}\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1607934460,
        "uid": 130387,
        "name": "_Anchor",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5278 \u3010\u7b97\u672f\u5929\u624d\u2468\u4e0e\u7b49\u5dee\u6570\u5217\u3011"
    },
    {
        "content": "**\u8fd9\u4e0d\u662f\u6b63\u89e3\uff0c\u800c\u4e14\u5f88\u5bb9\u6613\u5361\uff0c\u53ea\u662f\u8fd9\u9898\u6570\u636e\u4e0d\u662f\u4e00\u822c\u7684\u6c34\u624d\u80fd\u8fc7\u53bb\u3002~~\u6000\u7591\u6570\u636e\u662f\u7528\u811a\u9020\u7684~~**\u3002\n\n\u5982\u679c\u4e00\u4e2a\u533a\u95f4\u80fd\u91cd\u6392\u6210\u7b49\u5dee\u5e8f\u5217\uff0c\u90a3\u4e48\u5b83\u7684\u9996\u9879\u548c\u5c3e\u9879\u7684\u5dee\u4e00\u5b9a\u662f $k\\times (len-1)$\uff0c\u5176\u4e2d $k$ \u662f\u516c\u5dee\uff0c$len$ \u662f\u957f\u5ea6\u3002\n\n\u6240\u4ee5\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u9519\u8bef\u7387\u5f88\u9ad8\u7684\u65b9\u6cd5\uff1a\u7ef4\u62a4\u533a\u95f4 $max,min$,\u82e5\u5b83\u4eec\u7684\u5dee\u7b26\u5408\u8981\u6c42\uff0c\u90a3\u4e48\u5c31\u662f\uff0c\u5426\u5219\u5c31\u4e0d\u662f\u3002\u7531\u4e8e\u6570\u636e\u4e0d\u662f\u4e00\u822c\u7684\u6c34\uff0c\u6240\u4ee5\u8fd9\u4e2a\u505a\u6cd5\u6709 $50$\u3002\n\n\u8003\u8651\u63d0\u9ad8\u6b63\u786e\u6027\u3002\u7ef4\u62a4\u4e00\u4e2a\u533a\u95f4\u548c\uff0c\u7528\u7b49\u5dee\u6570\u5217\u6c42\u548c\uff08$(max+min)\\times len/2$\uff09\u6c42\u51fa\u5982\u679c\u662f\u7b49\u5dee\u6570\u5217\u7684\u8bdd\u6240\u6709\u6570\u7684\u548c\uff0c\u5728\u524d\u9762\u6761\u4ef6\u6ee1\u8db3\u7684\u60c5\u51b5\u4e0b\u548c\u4e00\u6837\uff0c\u90a3\u4e48\u5c31\u662f\uff0c\u5426\u5219\u5c31\u4e0d\u662f\u3002\u8fd9\u6837\u7684\u5f88\u5bb9\u6613\u5361\uff0c\u4f46\u662f\u6570\u636e\u4e0d\u662f\u4e00\u822c\u7684\u6c34\uff0c\u6240\u4ee5\u8fd9\u4e2a\u505a\u6cd5\u6709 $100$\u3002\n\n\u7136\u540e\u5c31\u6109\u5feb\u7684\u6c34\u8fc7\u8fd9\u9898\u3002\n\n```cpp\n#include<iostream>\n#define int long long\nusing namespace std;\nconst int N=3e5+5;\nint n,q,lst;\nint a[N];\nstruct tree\n{\n\tint l,r,sum,minn,maxx;\n\ttree operator +(tree x)\n\t{\n\t\ttree ans;\n\t\tans.sum=sum+x.sum;\n\t\tans.maxx=max(maxx,x.maxx);\n\t\tans.minn=min(minn,x.minn);\n\t\treturn ans;\n\t}\n}t[N*4];\nvoid pushup(int k)\n{\n\tt[k].sum=t[k*2].sum+t[k*2+1].sum;\n\tt[k].maxx=max(t[k*2].maxx,t[k*2+1].maxx);\n\tt[k].minn=min(t[k*2].minn,t[k*2+1].minn); \n}\nvoid build(int k,int l,int r)\n{\n\tt[k].l=l;t[k].r=r;\n\tif(l==r)\n\t{\n\t\tt[k].sum=t[k].maxx=t[k].minn=a[l];\n\t\treturn;\n\t}\n\tint mid=(l+r)>>1;\n\tbuild(k*2,l,mid);\n\tbuild(k*2+1,mid+1,r);\n\tpushup(k);\n}\nvoid change(int k,int p,int v)\n{\n\tif(t[k].l==t[k].r)\n\t{\n\t\tt[k].sum=t[k].maxx=t[k].minn=v;\n\t\treturn;\n\t}\n\tif(p<=t[k*2].r) change(k*2,p,v);\n\telse change(k*2+1,p,v);\n\tpushup(k);\n}\nconst int qwq=1e16;\ntree ask(int k,int l,int r)\n{\n\tif(l<=t[k].l&&t[k].r<=r) return t[k];\n\ttree ans=(tree){0,0,0,qwq,0};\n\tif(l<=t[k*2].r) ans=ans+ask(k*2,l,r);\n\tif(t[k*2+1].l<=r) ans=ans+ask(k*2+1,l,r);\n\treturn ans;\n}\nsigned main()\n{\n\tcin>>n>>q;\n\tfor(int i=1;i<=n;i++)\n\tcin>>a[i];\n\tbuild(1,1,n);\n\twhile(q--)\n\t{\n\t\tint op;\n\t\tcin>>op;\n\t\tif(op==1)\n\t\t{\n\t\t\tint x,y;\n\t\t\tcin>>x>>y;\n\t\t\tx^=lst;y^=lst;\n\t\t\tchange(1,x,y);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint l,r,k;\n\t\t\tcin>>l>>r>>k;\n\t\t\tl^=lst;r^=lst;k^=lst;\n\t\t\ttree ans=ask(1,l,r);\n\t\t\tif(ans.maxx-ans.minn==(r-l)*k&&ans.sum==(ans.minn+ans.maxx)*(r-l+1)/2)\n\t\t\t{\n\t\t\t\tlst++;\n\t\t\t\tcout<<\"Yes\\n\";\n\t\t\t}\n\t\t\telse cout<<\"No\\n\";\n\t\t}\n\t}\n \treturn 0;\n}\n```\n",
        "postTime": 1611314626,
        "uid": 196899,
        "name": "lndjy",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5278 \u3010\u7b97\u672f\u5929\u624d\u2468\u4e0e\u7b49\u5dee\u6570\u5217\u3011"
    },
    {
        "content": "**\u975e\u6b63\u89e3\uff0c\u597d\u50cf\u6ca1\u6709\u4e00\u6837\u7684\u505a\u6cd5\uff0c\u4e0d\u662f\u76f4\u63a5\u7ef4\u62a4\u5e73\u65b9\u548c\uff0c\u800c\u662f\u90a3\u79cd\u4e0d\u5bb9\u6613\u6784\u9020\u6570\u636e\u5361\u6389\u7684\u8fdb\u5236Hash\u3002**\n\n\u8fd8\u662f\u501f\u9274\u4e86[P6688](https://www.luogu.com.cn/problem/P6688)\u4e3a\u53ef\u91cd\u96c6\u8bbe\u8ba1\u7279\u5f81\u51fd\u6570\u7684\u601d\u60f3\uff0c\u90a3\u9053\u9898[\u6211\u7684\u66b4\u529b\u505a\u6cd5](https://www.luogu.com.cn/blog/SingerCoder/solution-p6688)\u5728\u8fd9\u91cc\uff0c\u7136\u540e[\u6b63\u89e3](https://www.luogu.com.cn/blog/skydogli/solution-p6688)\u5728\u8fd9\u91cc\u3002\n\n\u8fd9\u91cc\u5148\u8bf4\u4e00\u4e0b\u8fdb\u5236Hash\u601d\u60f3\uff0c\u6211\u4eec\u77e5\u9053\u672c\u9898\u7ef4\u62a4\u533a\u95f4\u672c\u8d28\u4e0a\u5c31\u662f\u7ef4\u62a4\u53ef\u91cd\u96c6\uff0c\u56e0\u4e3a\u4e0d\u8003\u8651\u987a\u5e8f\uff1b\n\n\u90a3\u4e48\u8003\u8651$a_i$\u5bf9Hash\u503c\u7684\u8d21\u732e\u4e3a$2^{a_i}$\uff0c\u8fd9\u6837\u5c31\u6709\u4e86\u53ef\u91cd\u96c6\u7684\u7279\u5f81\u51fd\u6570\uff1a\n\n$$Hash(S) = \\sum_{a_i \\in S} 2^{a_i}$$\n\n\u5bf9\u6574\u4e2a\u96c6\u5408\u6574\u4f53\u52a0\u51cf\u5c31\u5bf9\u7279\u5f81\u51fd\u6570\u8fdb\u884c\u4e58\u9664\u5373\u53ef\u3002\n\n\u90a3\u4e48\u73b0\u5728\u552f\u4e00\u7684\u95ee\u9898\u5c31\u5728\u4e8e\uff0c\u5982\u4f55\u5feb\u901f\u6c42\u51fa\u4e00\u4e2a\u957f\u5ea6\u4e3an\u3001\u9996\u9879\u4e3aa_1\u3001\u516c\u5dee\u4e3ak\u7684\u7b49\u5dee\u6570\u5217\u7684\u7279\u5f81\u51fd\u6570\uff1f\n\n\u663e\u7136\u6211\u4eec\u53ef\u4ee5\u4ee4\u9996\u9879\u4e3a0\uff0c\u518d\u5bf9\u6574\u4e2a\u96c6\u5408\u6574\u4f53\u52a0\u51cf\uff0c\u4ee4$f(n,k)$\u8868\u793a\u957f\u5ea6\u4e3an\u3001\u9996\u9879\u4e3a0\uff0c\u516c\u5dee\u4e3ak\u7684\u7b49\u5dee\u6570\u5217\u7684\u7279\u5f81\u51fd\u6570\uff0c\u5219\u6709\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8x10x6q3.png)\n\n\u50cf\u5feb\u901f\u5e42\u90a3\u6837\u5199\u4e2a\u9012\u5f52\u5373\u53ef\uff0c\u5b9e\u6d4b\u5355\u54c8\u5e0c\u5373\u53efAC\n\n```cpp\n#include<bits/stdc++.h>\n\n#define ll long long \n\n#define inf 0x3f3f3f3f\n\nusing namespace std;\n\ninline int read()\n{\n\tint a=0,f=1,c=getchar();\n\twhile(!isdigit(c))\n\t{\n\t\tif(c=='-')f=-1;\n\t\tc=getchar();\n\t}\n\twhile(isdigit(c))\n\t{\n\t\ta=a*10+c-'0';\n\t\tc=getchar();\n\t}\n\treturn a*f;\n}\n\nconst int N=3e5+10;\nconst int P=1e9+7;\nll pm(ll a,ll x)\n{\n\tif(x==0)return 1;\n\tif(x&1)return pm(a,x-1)*a%P;\n\tll ret=pm(a,x/2);\n\treturn ret*ret%P;\n}\nll f(ll n,ll k)\n{\n\tif(n==1)return 1;\n\tif(n&1)return (f(n-1,k)*pm(2,k)+1)%P;\n\tll ret=f(n/2,k);\n\treturn (ret+ret*pm(2,k*(n/2)))%P;\n}\n\nstruct SGT\n{\n\tstruct node\n\t{\n\t\tint mn;\n\t\tll sum;\n\t}a[N*4];\n\tinline int ls(int u){return u<<1;}\n\tinline int rs(int u){return u<<1|1;}\n\tinline void upd_one(int u,int val)\n\t{\n\t\ta[u].mn=val;\n\t\ta[u].sum=pm(2,val);\n\t}\n\tinline void push_up(int u)\n\t{\n\t\ta[u].mn=min(a[ls(u)].mn,a[rs(u)].mn);\n\t\ta[u].sum=(a[ls(u)].sum+a[rs(u)].sum)%P;\n\t}\n\tvoid build(int u,int l,int r,int* val)\n\t{\n\t\tif(l==r)upd_one(u,val[l]);\n\t\telse\n\t\t{\n\t\t\tint mid=(l+r)/2;\n\t\t\tbuild(ls(u),l,mid,val);\n\t\t\tbuild(rs(u),mid+1,r,val);\n\t\t\tpush_up(u);\n\t\t}\n\t}\n\tvoid upd(int u,int l,int r,int p,int val)\n\t{\n\t\tif(l==r)upd_one(u,val);\n\t\telse\n\t\t{\n\t\t\tint mid=(l+r)/2;\n\t\t\tif(p<=mid)upd(ls(u),l,mid,p,val);\n\t\t\telse upd(rs(u),mid+1,r,p,val);\n\t\t\tpush_up(u);\n\t\t}\n\t}\n\tint ask_mn(int u,int l,int r,int ql,int qr)\n\t{\n\t\tif(ql<=l && r<=qr)return a[u].mn;\n\t\telse\n\t\t{\n\t\t\tint mid=(l+r)/2,ret=inf;\n\t\t\tif(ql<=mid)ret=min(ret,ask_mn(ls(u),l,mid,ql,qr));\n\t\t\tif(mid+1<=qr)ret=min(ret,ask_mn(rs(u),mid+1,r,ql,qr));\n\t\t\treturn ret;\n\t\t}\n\t}\n\tll ask_sum(int u,int l,int r,int ql,int qr)\n\t{\n\t\tif(ql<=l && r<=qr)return a[u].sum;\n\t\telse\n\t\t{\n\t\t\tint mid=(l+r)/2;\n\t\t\tll ret=0;\n\t\t\tif(ql<=mid)ret=(ret+ask_sum(ls(u),l,mid,ql,qr))%P;\n\t\t\tif(mid+1<=qr)ret=(ret+ask_sum(rs(u),mid+1,r,ql,qr))%P;\n\t\t\treturn ret;\n\t\t}\n\t}\n}T;\n\nint n,m;\nint a[N];\n\nint main()\n{\n//\tfreopen(\"1.in\",\"r\",stdin);\n\t\n\tn=read();\n\tm=read();\n\tfor(int i=1;i<=n;++i)a[i]=read();\n\tT.build(1,1,n,a);\n\t\n\tint cnt=0;\n\tfor(int i=1;i<=m;++i)\n\t{\n\t\tint op=read();\n\t\tif(op==1)\n\t\t{\n\t\t\tint x=read()^cnt;\n\t\t\tint y=read()^cnt;\n\t\t\tT.upd(1,1,n,x,y);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint l=read()^cnt;\n\t\t\tint r=read()^cnt;\n\t\t\tint k=read()^cnt;\n\t\t\tint mn=T.ask_mn(1,1,n,l,r);\n\t\t\tll sum=T.ask_sum(1,1,n,l,r);\n\t\t\tif(sum==f(r-l+1,k)*pm(2,mn)%P)\n\t\t\t{\n\t\t\t\t++cnt;\n\t\t\t\tputs(\"Yes\");\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tputs(\"No\");\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn 0;\n}\n```\n\n# \u540e\u8bb0\n\n\u8bf4\u4e00\u4e0b\u4e3a\u5565\u90092\u4e3abase\u4e0d\u4f1a\u4ea7\u751f\u51b2\u7a81\u5427\uff0c\u9996\u5148\u5f88\u663e\u7136\u8fd9\u6837\u6211\u4eec\u5f62\u6210\u7684Hash\u503c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6570\uff0c\u4f8b\u5982\uff1a\n\n$$Hash({1,3,5})=(10101)_2$$\n\n\u90a3\u4e48\u5982\u679c\u8981\u5728\u96c6\u5408\u4e0d\u540c\u7684\u60c5\u51b5\u4e0b\u4ee4Hash\u503c\u76f8\u540c\uff0c\u6211\u4eec\u5c31\u5fc5\u987b\u4f7f\u5f97\u4e8c\u8fdb\u6570\u7684\u67d0\u4e00\u4f4d\u4e0d\u662f\u76f4\u63a5\u5f97\u6765\uff0c\u800c\u662f\u7531\u4e0a\u4e00\u4f4d\u8fdb\u4f4d\u5f97\u6765\uff0c\u8fd9\u6837\u6574\u4e2a\u4e8c\u8fdb\u6570\u4e2d1\u7684\u4e2a\u6570\u5c31\u4f1a\u51cf\u5c11\uff0c\u4e5f\u5c31\u65e0\u6cd5\u4f7f\u5f97Hash\u503c\u76f8\u540c\u3002\n\n\u7136\u800c\u4e0a\u8ff0\u5206\u6790\u6210\u7acb\u7684\u524d\u63d0\u662f$k \\ne 0$\uff0c\u5bf9\u4e8e$k=0$\u7684\u60c5\u51b5\uff0c\u5728\u6700\u5c0f\u503c\u786e\u5b9a\u7684\u60c5\u51b5\u4e0b\u53d1\u73b0S\u4e0eHash(S)\u4e3a\u4e92\u4e3a\u552f\u4e00\u6620\u5c04\u3002\n\n\u53e6\u5916\uff0c\u4f9d\u636e\u53ef\u91cd\u96c6\u90a3\u9053\u9898\u7684\u7ecf\u9a8c\uff0c\u7528sin cos\u6765\u8bbe\u8ba1\u7279\u5f81\u51fd\u6570\u8c8c\u4f3c\u4e5f\u662f\u53ef\u884c\u7684\uff0c\u4e0d\u8fc7\u6bd5\u7adf\u6d6e\u70b9\u6570\u5b58\u5728\u8bef\u5dee\u6240\u4ee5\u5c31\u6ca1\u6709\u5c1d\u8bd5\uff0c\u6709\u5174\u8da3\u7684\u5c0f\u670b\u53cb\u53ef\u4ee5\u8bd5\u4e00\u8bd5\u54c8\u3002",
        "postTime": 1611150138,
        "uid": 239241,
        "name": "Singercoder",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5278 \u3010\u7b97\u672f\u5929\u624d\u2468\u4e0e\u7b49\u5dee\u6570\u5217\u3011"
    },
    {
        "content": "\u533a\u95f4 $[l,\\ r]$ \u6240\u7ec4\u6210\u7684\u7b49\u5dee\u6570\u5217\u9996\u9879\u4e3a $\\min{a_{l\\cdots r}}$ \uff0c\u672b\u9879\u4e3a $\\max{a_{l\\cdots r}}$ \uff0c\u516c\u5dee\u4e3a $k$\n\n\u53ef\u4ee5\u8003\u8651\u6c42\u51fa $[l,\\ r]$ \u548c\u8fd9\u4e2a\u7b49\u5dee\u6570\u5217\u7684hash\u503c\uff0c\u63a5\u7740\u5bf9\u6bd4\u5373\u53ef\n\n\u5982\u679c\u5c06\u533a\u95f4\u548c\u4f5c\u4e3ahash\u503c\uff0c\u51b2\u7a81\u7387\u5f88\u9ad8\uff0c\u53ef\u4ee5\u8003\u8651\u7528\u6bcf\u4e2a\u6570\u7684\u5e73\u65b9\u4f5c\u4e3ahash\u503c\n\n\u8bbe\u8be5\u7b49\u5dee\u6570\u5217\u9996\u9879\u4e3a $l$ \uff0c\u516c\u5dee\u4e3a $k$ \uff0c\u9879\u6570\u4e3a $t$\n\n\u5219\u5b83\u7684hash\u503c\u4e3a\n$$\\displaystyle\\sum_{a=0}^t{(l+ak)^2}$$\n\n\u63a5\u7740\u5927\u529b\u5316\u5f0f\u5b50\n\n$$hash=\\displaystyle\\sum_{a=0}^t{l^2+2lak+a^2k^2}$$\n$$=(t+1)l^2+k\\displaystyle\\sum_{a=0}^t{a^2k+2la}$$\n$$=(t+1)l^2+k(\\displaystyle\\sum_{a=0}^t{a^2}+2l\\sum_{a=0}^ta)$$\n$$=(t+1)l^2+k(\\frac{t(t+1)(2t+1)}{6}+lt(t+1))$$\n\n\u6545\u53ef $O(1)$ \u6c42\u51fa\n\n\u6b64\u9898\u8fd8\u9700\u8981\u7279\u5224 $l=r$ \u53ca $k=0$ \u7684\u60c5\u51b5\n\n\u7531\u4e8e\u6211\u62c5\u5fc3\u88ab\u5361\uff0c\u7528\u4e86\u53cc\u6a21\u6570\uff0c\u5e38\u6570\u7a0d\u5927 qaq\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\n\n``` cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define mid ((l + r) >> 1)\n#define lson k << 1, l, mid\n#define rson k << 1 | 1, mid + 1, r\nconst int maxn = 3e5 + 10, P1 = 1e9 + 7, P2 = 1e9 + 9, inv1 = 166666668, inv2 = 833333341;\nint n, m, lastans;\n\nstruct node {\n  int mn, mx, v1, v2;\n  node(int x = INT_MAX, int y = 0, int _v1 = 0, int _v2 = 0) :\n    mn(x), mx(y), v1(_v1), v2(_v2) {}\n} tree[maxn << 2];\n\ninline node operator + (node a, node b) {\n  return node(min(a.mn, b.mn), max(a.mx, b.mx), (a.v1 + b.v1) % P1, (a.v2 + b.v2) % P2);\n}\n\nvoid build(int k, int l, int r) {\n  if (l == r) {\n    int x;\n    scanf(\"%d\", &x);\n    tree[k] = node(x, x, 1ll * x * x % P1, 1ll * x * x % P2);\n    return;\n  }\n  build(lson), build(rson);\n  tree[k] = tree[k << 1] + tree[k << 1 | 1];\n}\n\nvoid upd(int k, int l, int r, int x, int v) {\n  if (l == r) {\n    tree[k] = node(v, v, 1ll * v * v % P1, 1ll * v * v % P2);\n    return;\n  }\n  if (x <= mid) {\n    upd(lson, x, v);\n  } else {\n    upd(rson, x, v);\n  }\n  tree[k] = tree[k << 1] + tree[k << 1 | 1];\n}\n\nnode query(int k, int l, int r, int ql, int qr) {\n  if (ql <= l && r <= qr) {\n    return tree[k];\n  }\n  node res;\n  if (ql <= mid) res = query(lson, ql, qr);\n  if (qr > mid) res = res + query(rson, ql, qr);\n  return res;\n}\n\ninline int getsum(int l, int k, int t, int P, int inv) {\n  return (1ll * l * l % P * (t + 1) % P + k * (1ll * l * t % P * (t + 1) % P + k * (1ll * t * (t + 1) % P * (2 * t + 1) % P * inv % P))) % P;\n}\n\ninline int getsum1(int l, int r, int k) {\n  return getsum(l, k, (r - l) / k, P1, inv1);\n}\n\ninline int getsum2(int l, int r, int k) {\n  return getsum(l, k, (r - l) / k, P2, inv2);\n}\n\ninline int reget(int x) {\n  if (x < 1) x = 1;\n  if (x > n) x = n;\n  return x;\n}\n\nint main() {\n  scanf(\"%d %d\", &n, &m);\n  build(1, 1, n);\n  int op, x, y, k; node tmp;\n  while (m--) {\n    scanf(\"%d %d %d\", &op, &x, &y);\n    x ^= lastans, y ^= lastans, x = reget(x);\n    if (op == 1) {\n      upd(1, 1, n, x, y);\n      continue;\n    }\n    y = reget(y);\n    if (x > y) swap(x, y);\n    bool ans;\n    scanf(\"%d\", &k);\n    k ^= lastans;\n    if (x == y) {\n      ans = 1;\n    } else {\n      tmp = query(1, 1, n, x, y);\n      ans = k ? tmp.mx - tmp.mn == 1ll * k * (y - x) && getsum1(tmp.mn, tmp.mx, k) == tmp.v1 && getsum2(tmp.mn, tmp.mx, k) == tmp.v2 : tmp.mn == tmp.mx;\n    }\n    ans ? lastans++, puts(\"Yes\") : puts(\"No\");\n  }\n  return 0;\n}\n```\n\n",
        "postTime": 1554456401,
        "uid": 73934,
        "name": "Juanzhang",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5278 \u3010\u7b97\u672f\u5929\u624d\u2468\u4e0e\u7b49\u5dee\u6570\u5217\u3011"
    },
    {
        "content": "\u4e00\u6bb5\u533a\u95f4$[l,r]$\u6392\u5e8f\u540e\u662f\u7b49\u5dee\u6570\u5217\uff0c\u7b49\u4ef7\u4e8e$(max-min)=k*(r-l)$\u4e14\u76f8\u90bb\u4e24\u6570\u5dee\u7684$gcd$\u662fk\u7684\u500d\u6570\u4e14\u8fd9\u6bb5\u533a\u95f4\u6ca1\u6709\u91cd\u590d\u6570\u5b57\u3002\n\n\u6240\u4ee5\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\u5dee\u5206\u6570\u7ec4\u533a\u95f4gcd\u3001\u539f\u6570\u7ec4\u6700\u5927\u6700\u5c0f\u503c\uff0c\u7528hash+set\u7ef4\u62a4\u6bcf\u4e2a\u6570\u5b57\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u5e76\u5728\u7ebf\u6bb5\u6811\u4e0a\u7ef4\u62a4\u6bcf\u4e2a\u70b9\u7684\u524d\u9a71(\u6700\u9760\u53f3\u7684\u503c\u76f8\u7b49\u7684\u70b9)\uff0c\u5c31\u53ef\u4ee5\u5224\u65ad\u533a\u95f4\u5185\u662f\u5426\u6709\u91cd\u590d\u6570\u5b57\u4e86\u3002\n\n```cpp\n#include <stdio.h>\n#include <string.h>\n#include <map>\n#include <set>\n#include <algorithm>\nusing namespace std;\ntypedef long long ll;\nconst int N=3e5+2,M=1.2e6+2,inf=1e9;\nint l[M],r[M],s[M],zd[M],zx[M],a[N],dy[N],pre[M],st[M];\nint n,m,i,j,x,y,z,c,ans,xz,dz,gc,ss,cc,tp;\nmap<int,int> ls;\nset<int> b[N<<1];\nset<int>::iterator it,jt;\ninline int ab(register int x)\n{\n\tif (x>0) return x;\n\treturn -x;\n}\ninline int gcd(register int x,register int y)\n{\n\tif (x>y) swap(x,y);\n\twhile (x)\n\t{\n\t\ty%=x;swap(x,y);\n\t}\n\treturn y;\n}\ninline void read(int &x)\n{\n\tc=getchar();\n\twhile ((c<48)||(c>57)) c=getchar();\n\tx=c^48;c=getchar();\n\twhile ((c>=48)&&(c<=57))\n\t{\n\t\tx=x*10+(c^48);\n\t\tc=getchar();\n\t}\n}\ninline void pushup(register int x)\n{\n\tc=x<<1;\n\ts[x]=gcd(s[c],s[c|1]);\n\tzd[x]=max(zd[c],zd[c|1]);\n\tzx[x]=min(zx[c],zx[c|1]);\n\tpre[x]=max(pre[c],pre[c|1]);\n}\nvoid build(int x)\n{\n\tif (l[x]==r[x])\n\t{\n\t\tread(a[l[x]]);s[x]=ab(a[l[x]]-a[l[x]-1]);\n\t\tzx[x]=zd[x]=a[l[x]];dy[l[x]]=x;\n\t\tif ((c=ls[zx[x]])==0) b[ls[zx[x]]=c=++ss].insert(0);\n\t\tb[c].insert(l[x]);\n\t\treturn;\n\t}\n\tst[++tp]=x;\n\tl[c=x<<1]=l[x];r[c]=l[x]+r[x]>>1;\n\tl[c|1]=r[c]+1;r[c|1]=r[x];\n\tbuild(c);build(x<<1|1);\n}\ninline void allpush(register int x)\n{\n\twhile (x=x>>1) pushup(x);\n}\ninline void mdf()\n{\n\tit=b[c=ls[a[z]]].find(z);\n\tjt=it++;if (it!=b[c].end()) pre[dy[*it]]=*(--jt);\n\tb[c].erase(z);\n\tzx[dy[z]]=zd[dy[z]]=a[z]=y;\n\tif ((c=ls[y])==0) b[ls[y]=c=++ss].insert(0);\n\tjt=it=b[c].insert(z).first;pre[dy[z]]=*(--jt);\n\t++it;if (it!=b[c].end()) pre[dy[*it]]=z;\n\ts[dy[z]]=ab(a[z]-a[z-1]);\n\tif (z<=n) s[dy[z+1]]=ab(a[z+1]-a[z]);\n\tallpush(dy[z]);if (z<=n) allpush(dy[z+1]);\n}\nvoid find1(int x)\n{\n\tif ((z<=l[x])&&(r[x]<=y))\n\t{\n\t\tcc=max(cc,pre[x]);xz=min(xz,zx[x]);\n\t\tdz=max(dz,zd[x]);return;\n\t}\n\tif (z<=r[x<<1]) find1(x<<1);\n\tif (y>r[x<<1]) find1(x<<1|1);\n}\nvoid find2(int x)\n{\n\tif ((z<=l[x])&&(r[x]<=y))\n\t{\n\t\tif (~gc) gc=gcd(gc,s[x]); else gc=s[x];\n\t\treturn;\n\t}\n\tif (z<=r[x<<1]) find2(x<<1);\n\tif (y>r[x<<1]) find2(x<<1|1);\n}\nint main()\n{\n\tread(n);read(m);\n\tr[l[1]=1]=n;build(1);\n\tfor (i=1;i<=ss;i++) for (it=b[i].begin(),jt=it++;it!=b[i].end();jt=it++) pre[dy[*it]]=*jt;\n\twhile (tp) pushup(st[tp--]);\n\twhile (m--)\n\t{\n\t\tread(x);read(z);read(y);z^=ans;y^=ans;\n\t\tif (x==1) mdf(); else\n\t\t{\n\t\t\tread(x);x^=ans;xz=inf;dz=0;gc=-1;cc=0;\n\t\t\tif (z==y) {puts(\"Yes\");++ans;continue;}\n\t\t\tfind1(1);\n\t\t\tif (x==0)\n\t\t\t{\n\t\t\t\tif (xz==dz) puts(\"Yes\"),++ans; else puts(\"No\");continue;\n\t\t\t}\n\t\t\tif ((cc>=z)||((ll)(y-z)*x!=dz-xz)) {puts(\"No\");continue;}++z;\n\t\t\tfind2(1);\n\t\t\tif (gc%x) puts(\"No\"); else {puts(\"Yes\");++ans;}\n\t\t}\n\t}\n}\n```\n",
        "postTime": 1554294080,
        "uid": 29826,
        "name": "SSerxhs",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5278 \u3010\u7b97\u672f\u5929\u624d\u2468\u4e0e\u7b49\u5dee\u6570\u5217\u3011"
    },
    {
        "content": "update:\n\n2020-10-07 \u6dfb\u52a0\u7a0b\u5e8f\u4ee3\u7801\uff0c\u4fee\u6539 $latex$ \u516c\u5f0f\uff0c\u4f18\u5316\u9898\u89e3\u8bb2\u89e3\n\n\u524d\u7f6e\u829d\u58eb\uff1a[Luogu3792](https://www.luogu.com.cn/problem/P3792)\n### Solution\n\u9996\u5148,\u6211\u4eec\u8bbe\u8fd9\u4e2a\u7b49\u5dee\u6570\u5217\u7684\u9996\u9879\u4e3a $t$,\u9879\u6570\u4e3a $n$,\u516c\u5dee\u4e3a $k$\n\n\u8fd9\u9053\u9898\u5c31\u662f\u4e00\u4e2a\u7ef4\u62a4\u533a\u95f4 $hash$ \u7684\u601d\u60f3\uff0c\n\u6211\u4eec\u8981\u7ef4\u62a4\u533a\u95f4\u7684 $\\min$ \u548c $\\max$\uff0c\u8fd9\u6837\u80fd\u591f\u77e5\u9053\u9996\u9879\u548c\u672b\u9879\u3002\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e2a\u7b49\u5dee\u6570\u5217\u7684\u6027\u8d28\uff1a\n\n1.$(\\max-\\min)=k(r-l)$\n\n2.\u516c\u5dee\u4e3a $k$ \u7684\u7b49\u5dee\u6570\u5217\u4e2d\u4efb\u610f\u9009\u51fa\u4e24\u4e2a\u5143\u7d20\uff0c\u4ed6\u4eec\u7684\u5dee\u4e00\u5b9a\u662fk\u7684\u500d\u6570\u3002\n\n3.\u533a\u95f4[l,r]\u7684\u6570\u4e0d\u91cd\u590d\n\n\u8fd9\u5176\u4e2d\u6709\u4e00\u4e2a\u5751\uff1a$l==r$\u662f\u4e5f\u7b97\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\uff0c\u4f46\u662f\u516c\u5dee $k$ \u4e3a $0$\u3002\n\n\u4e8e\u662f\u8003\u8651\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\u5dee\u5206\u533a\u95f4\u6570\u7ec4 $\\gcd$\uff0c$\\min$&$\\max$ \u503c\uff0c\u5404\u70b9\u524d\u9a71\uff0chash\u5957set\u7ef4\u62a4\u6570\u5b57\u51fa\u73b0\u4f4d\u7f6e\uff0c\u7136\u540e\u7ef4\u62a4\u533a\u95f4 $\\gcd$\uff0c\u4f46\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u4e0a\u9762\u4e09\u6761\u6027\u8d28\u8fbe\u6210\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O( mlog^2n )$\u3002\n\n### Code\n\n\u5b8c\u6574\u4ee3\u7801\u8fc7\u957f\uff0c\u6b64\u5904\u5c31\u4e0d\u8d34\u4e86\uff0c\u8fd9\u91cc\u9644\u4e0a\u5173\u952e\u4ee3\u7801\n```C++\nwhile(t--)\n{\n\tcin>>opt>>z>>y;\n\tz^=ans,y^=ans;//\u5f02\u6216 \n\tif(opt==1)\n\t{\n   \t\tadd(z,y);\n   } \n\telse\n\t{\n\t\tcin>>k;\n\t\tk^=ans;\n\t\tmn=INF;\n\t\tmx=0;\n\t\tg=-1;\n\t\tc=0;\n\t\tif(z==y) //l==r \u7279\u5224 \n\t\t{\n\t\t\tputs(\"Yes\");\n\t\t\tans++;\n\t\t\tcontinue;\n\t\t}\n\t\tfind_minmax(mn,mx,1);//\u627emin,max\u503c \n\t\tif(k==0)//\u516c\u5dee\u4e3a0 \n\t\t{\n\t\t\tif(mx==mn)//\u82e5\u6700\u5927\u6700\u5c0f\u503c\u76f8\u7b49 \n\t\t\t{\n\t\t\t\tcout<<\"Yes\\n\";\n\t\t\t\tans++;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcout<<\"No\\n\";\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tif((c>=z)||((long long)(y-z)*k!=mx-mn))//\u4e0d\u7b26\u5408\u7b49\u5dee\u6570\u5217\u6027\u8d28 \n\t\t{\n\t\t\tcout<<\"No\\n\";\n\t\t\tcontinue;\n\t\t}\n\t\tz++;\n\t\tfind_gcd(g,1);//\u627e\u533a\u95f4gcd \n\t\tif(g%k!=0)//\u533a\u95f4\u4e0d\u80fd\u6574\u9664k \n\t\t{\n\t\t\tcout<<\"No\\n\";\n\t\t\tcontinue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcout<<\"Yes\\n\";\n\t\t\tans++;\n\t\t\tcontinue; \n\t\t}\n\t}\n}\n```",
        "postTime": 1601880376,
        "uid": 263414,
        "name": "Sktic",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5278 \u3010\u7b97\u672f\u5929\u624d\u2468\u4e0e\u7b49\u5dee\u6570\u5217\u3011"
    }
]
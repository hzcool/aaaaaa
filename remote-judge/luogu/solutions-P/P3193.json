[
    {
        "content": "\u9898\u89e3\u6709\u70b9\u957f\u8bf7\u8010\u5fc3\u89c2\u770b...\r\n## \u9898\u610f\r\n\u6c42\u6709\u591a\u5c11\u4e2a$n$\u4f4d\u7684\u6570\u5b57\u4e32\u4e0d\u5305\u542b$m$\u4f4d\u7684\u5b57\u7b26\u4e32\r\n\uff08\u8303\u56f4 $n <= 1e9 $\uff0c $m <= 20$\uff09\r\n## \u5206\u6790\r\n\u7f51\u4e0a\u7684\u9898\u89e3\u6211\u90fd\u770b\u4e0d\u61c2\u554aQAQ(\u592a\u5f31\u4e86)\uff0c\u90a3\u4e48\u6211\u5c31\u5199\u8be6\u7ec6\u4e00\u70b9\u5427...\r\n### 0x01 \u66b4\u529b\r\n\u7b2c\u4e00\u773c\u770b\u5230\u5c31\u662f\u4e0d\u4f1a...\r\n\u4e0d\u4f1a\u600e\u4e48\u529e..\u5148\u628a\u66b4\u529b\u6253\u4e86...\r\n\u66b4\u529b\u679a\u4e3e\u5b57\u7b26\u4e32\uff0c\u7136\u540e$Hash$\u6bd4\u8f83\r\n\u590d\u6742\u5ea6$O(10^n\\cdot n)$\uff0c\u5b9e\u6d4b\u53ea\u80fd\u8fc7$n<=7$\u7684\u70b9\r\n\u7136\u540e\u5f97\u5230$10$\u5206\r\n\r\n![](https://ws2.sinaimg.cn/large/006tKfTcly1fqa913k95mj30no0gjgmr.jpg)\r\n\r\n### 0x02 DP\r\n\u5988\u5988\u6211\u4f1a$DP$ !\r\n\u6839\u636e\u5957\u8def\uff0c\u56e0\u4e3a$m$\u5e76\u4e0d\u4f1a\u5f88\u5927\uff0c\u8bbe$f[i][j]$\u8868\u793a\u957f\u4e32\u5339\u914d\u5230\u7b2c$i$\u4f4d\uff0c\u77ed\u4e32\u6700\u591a\u53ef\u4ee5\u5339\u914d\u5230\u7b2c$j$\u4f4d\u7684\u65b9\u6848\u6570\r\n![](https://ws4.sinaimg.cn/large/006tKfTcly1fqa7y12r2vj30ft079gm0.jpg)\r\n\u90a3\u4e48\u4e3a\u4e86\u8ba9\u5b83\u4e0d\u80fd\u627e\u5230\u5b8c\u5168\u7684\u5339\u914d\uff0c\u7b54\u6848\u5c31\u662f\r\n$$\\sum_{i=0}^{m-1}f[n][i]$$\r\n\u90a3\u4e48\u600e\u4e48\u8f6c\u79fb\uff1f\r\n\u8003\u8651\u5bf9\u4e8e\u5df2\u7ecf\u5339\u914d\u4e86\u7684$f[i][j]$\u8f6c\u79fb\u5230$f[i + 1][k]$\u65b0\u52a0\u4e00\u4e2a\u65b0\u7684\u5b57\u7b26\u9020\u6210\u7684\u5f71\u54cd\u3002\r\n![](https://ws2.sinaimg.cn/large/006tKfTcly1fqa82b67ssj30ev05wq3f.jpg)\r\n\u7531\u4e8e\u8fd9\u4e2a$new$\u662f\u53ef\u4ee5\u968f\u4fbf\u586b\u5199\u7684\uff0c\u5bf9\u4e8e\u77ed\u4e32\u7684$j+1$\uff0c\u53ef\u80fd\u4f1a\u6709\u51e0\u79cd\u60c5\u51b5\u3002\r\n1. new\u548c$t+1$\u5339\u914d\uff0c\u8f6c\u79fb\u5230$f[i+1][j+1]$\r\n2. \u4e0d\u5339\u914d\r\n\r\n![](https://ws4.sinaimg.cn/large/006tKfTcly1fqa873h653j30f7081wfj.jpg)\r\n\r\n\u5982\u56fe\uff0c\u8fd9\u6837\u53ef\u80fd\u4f1a\u627e\u5230\u4e00\u4e2a\u65b0\u7684\u957f\u5ea6\u4e3a$k$\u7684\u524d\u7f00\u4f7f\u5f97\u548c\u5f53\u524d\u679a\u4e3e\u5230\u7684\u540e\u7f00\u5339\u914d\r\n\r\n![](https://ws2.sinaimg.cn/large/006tKfTcly1fqa89i1k3aj30fv08gjs9.jpg)\r\n\r\n\u751a\u81f3$k=0$\u65e0\u6cd5\u5339\u914d\r\n\r\n\u5176\u5b9e\uff0c\u8fd9\u4e2a\u4e1c\u897f\u548c\u679a\u4e3e\u7684\u5b57\u6bcd\u65e0\u5173\uff0c\u8003\u8651\u5230\u6700\u540e\u7684\u7b54\u6848\uff0c\u5728$DP$\u8fc7\u7a0b\u4e2d\u53ea\u9700\u8981\u8003\u8651\u957f\u5ea6\u5bf9\u7b54\u6848\u9020\u6210\u7684\u5f71\u54cd\u3002\r\n\r\n\u5bf9\u4e8e\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u5c31\u662f\u8981\u77e5\u9053\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5339\u914d\u5230\u957f\u5ea6\u4e3a$j$\u7684\u4e32\uff0c\u8f6c\u79fb\u5230$k$\u7684\u4e32\u7684\u65b9\u6848\uff0c\u4e5f\u5c31\u5bf9\u4e8e\u957f\u5ea6\u4e3a$i$\u7684\u4e32\uff0c\u52a0\u4e00\u4e2a\u6570\u5b50\uff0c\u80fd\u52a0\u5165\u591a\u5c11\u79cd\u6570\u5b57\uff0c\u4f7f\u5f97\u957f\u5ea6\u4e3a$j$\u7684\u5339\u914d\u53d8\u6210\u957f\u5ea6\u4e3a$k$\u7684\u5339\u914d\uff08\u5982\u56fe\uff09\u3002\r\n\r\n$DP$\u5f0f\u5c31\u53ef\u4ee5\u5199\u51fa\u6765\u5566\r\n$$f[i][j]=\\sum_{k=0}^{m-1} f[i-1][k]*g[k][j]$$\r\n\r\n$DP$\u5957$DP$\uff1f\r\n\r\n\u5176\u5b9e\u6ca1\u90a3\u4e48\u9ebb\u70e6\uff0c\u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u7684\u65b9\u6848\u6570\uff0c\u56e0\u4e3a\u6211\u4eec\u77e5\u9053\u77ed\u4e32\uff0c\u8fd9\u4e2a\u201c$g[i][j]$\u201d\u662f\u56fa\u5b9a\u7684\uff0c\u5c31\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u7ed3\u679c\u3002\r\n\r\n![](https://ws2.sinaimg.cn/large/006tKfTcly1fqa8lwb5xyj309307p74l.jpg)\r\n\u4e3a\u4e86\u8ba1\u7b97\u957f\u5ea6\u4e3a$j$\u7684\u5df2\u7ecf\u5339\u914d\u597d\u4e86\u7684\u4e32\u53ef\u4ee5\u7528\u591a\u5c11\u79cd\u6570\u5b57\u53d8\u4e3a$k$\uff0c\u679a\u4e3e\u4e00\u4e2a\u6570\u5b57\uff0c\u770b\u5b83\u5728\u77ed\u4e32\u4e2d\u6700\u957f\u53ef\u4ee5\u5339\u914d\u5230\u6700\u591a\u591a\u957f\u7684\u524d\u7f00\u3002\r\n\r\n\u5988\u5988\u6211\u4f1a$Kmp$\uff01\r\n\r\n\u7136\u540e\u4e3a\u4e86\u4fdd\u8bc1\u662f\u6700\u957f\u7684\u800c\u4e14\u524d\u9762\u7684\u4e1c\u897f\u4fdd\u7559\uff0c\u66b4\u529b\u679a\u4e3e\u7684\u590d\u6742\u5ea6\u597d\u50cf\u6709\u70b9\u7206\u70b8\uff0c\u8fd9\u4e2a\u65f6\u5019\u4e00\u770b\u4e0d\u5c31\u662f\u4e00\u4e2a\u88f8$Kmp$\u5417\uff0c\u5bf9\u4e8e\u65b0\u7684\u6570\u5b57\uff0c\u5931\u53bb\u5339\u914d\u5c31\u8df3$next$\u3002\r\n\r\n![](https://ws2.sinaimg.cn/large/006tKfTcly1fqa8rri4eej309p09bdgp.jpg)\r\n\r\n\u4e8e\u662f\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a$O(n*m^2)$\u7684\u4f18\u79c0\u7b97\u6cd5....\r\n\u5927\u6982\u53ef\u4ee5\u505a$n<=250000$\u7684\u6570\u636e\uff0c\u7136\u540e\u5f97\u5230$40$\u5206\r\n\r\n![](https://ws2.sinaimg.cn/large/006tKfTcly1fqa91ilorsj30np0f6my9.jpg)\r\n\r\n### 0x03 \u77e9\u9635\u5feb\u901f\u5e42\r\n\u7136\u540e\u770b\u4e00\u770b$DP$\u5f0f\r\n$$f[i][j]=\\sum_{k=0}^{m-1} f[i-1][k]*g[k][j]$$\r\n\u8fd9\u4e0d\u5c31\u662f\u4e00\u4e2a\u77e9\u9635\u4e58\u6cd5\u7684\u5f0f\u5b50\u5417...\r\n\u56e0\u4e3a$g[i][j]$\u662f\u56fa\u5b9a\u7684\uff0c\u4e8e\u662f\u628a$f[i][j]$\u770b\u6210\u4e00\u4e2a\u77e9\u9635\uff0c\u5bf9\u4e8e\u77e9\u9635$F[i]$\u5b83\u7684\u7b2c\u4e00\u5c42\u5c31\u662f$f[i][j]$\u3002\r\n$$F[i]=F[i-1]*G$$\r\n$G$\u662f\u56fa\u5b9a\u7684\uff0c\u4f60\u53c8\u77e5\u9053$F[0]$\u7684\u7b2c\u4e00\u884c\u7b2c\u4e00\u5217\u662f$1$\uff0c\u7136\u540e\u6c42\u4e00\u4e2a$F[n]$\u5c31\u884c\u4e86...\r\n\u77e9\u9635\u5feb\u901f\u5e42\u5373\u53ef....\r\n\r\n### 0x04 \u4ee3\u7801\r\n\u66b4\u529b\r\n```\r\n#include<bits/stdc++.h>\r\nusing namespace std;\r\ninline int read(){\r\n    char ch = getchar(); int u = 0, f = 1;\r\n    while (!isdigit(ch)) { u = (u << 1) + (u << 3) + ch - 48; ch = getchar(); }\r\n    while (isdigit(ch)) { u = (u << 1) + (u << 3) + ch - 48; ch = getchar(); }\r\n    return u * f;\r\n}\r\nconst int maxn = 1e5 + 10;\r\nint n, m, k;\r\nint ans = 0;\r\ntypedef unsigned long long ull;\r\null ha_m; \r\null mod = 19260817;\r\null base = 266;\r\null ha[maxn], pw[maxn];\r\nint s[maxn];\r\nchar md[maxn];\r\ninline void build(){\r\n    ha[0] = 0;\r\n    for (int i = 1; i <= n; ++i)\r\n        ha[i] = (ha[i - 1] * base + s[i]) % mod;\r\n}\r\ninline ull split(int l, int r){\r\n    return ((ha[r] - (ha[l - 1] * pw[r - l + 1]) % mod) + mod) % mod;\r\n}\r\ninline void dfs(int x){\r\n    if (x == n + 1){\r\n        build();\r\n        for (int i = 1; i + m - 1 <= n; ++i){\r\n            if (split(i, i + m - 1) == ha_m) return; \r\n        }\r\n        ans++; \r\n        return;\r\n    }\r\n    for (int i = 0; i <= 9; ++i){\r\n        s[x] = i;\r\n        dfs(x + 1);\r\n    }\r\n}\r\nint main(){\r\n//\tfreopen(\"data.txt\", \"r\", stdin);\r\n    n = read(), m = read(), k = read();\r\n    if (n >= 10) return 0 * puts(\"NO\");\r\n    scanf(\"%s\", md + 1);\r\n    pw[1] = base;\r\n    for (int i = 2; i <= n; ++i) pw[i] = (pw[i - 1] * base) % mod;\r\n    for (int i = 1; i <= m; ++i) ha_m = (ha_m * base + (md[i] - '0')) % mod;\r\n    dfs(1);\r\n    printf(\"%d\", ans % k);\r\n    return 0;\r\n}\r\n```\r\n40\u5206DP\r\n```\r\n#include<bits/stdc++.h>\r\nusing namespace std;\r\ninline int read(){\r\n    char ch = getchar(); int u = 0, f = 1;\r\n    while (!isdigit(ch)) { if (ch == '-') f = -1; ch = getchar(); }\r\n    while (isdigit(ch)) { u = (u << 1) + (u << 3) + ch - 48; ch = getchar(); }\r\n    return u * f;\r\n}\r\nconst int maxn = 1e6+10;\r\nint f[maxn][30], n, m, k;\r\nint nxt[50], match[50][50];\r\nchar md[50];\r\n\r\ninline void Inittt(){\r\n    n = read(), m = read(), k = read();\r\n    scanf(\"%s\", md + 1);\r\n}\r\ninline void Kmp(){ \r\n    nxt[0] = -1;\r\n    for (int i = 1; i <= m; ++i){\r\n        int j = nxt[i - 1];\r\n        while (j != -1 && md[j + 1] != md[i]) j = nxt[j];\r\n        nxt[i] = j + 1;\r\n    }\r\n    nxt[0] = 0;\r\n    for (int i = 0; i < m; ++i){\r\n        for (int j = '0'; j <= '9'; ++j){\r\n            int temp = i;\r\n            while (md[temp + 1] != j && temp > 0) temp = nxt[temp];\r\n            if (md[temp + 1] == j) temp++;\r\n            if (temp < m) match[i][temp]++;\r\n        }\t\r\n    }\r\n}\r\nint main(){\r\n    Inittt();\r\n    Kmp();\r\n    f[0][0] = 1;\r\n    for (int i = 1; i <= n; ++i)\r\n        for (int j = 0; j < m; ++j)\r\n            for (int p = 0; p < m; ++p)\r\n                { (f[i][j] += f[i - 1][p] * match[p][j]) %= k; }\r\n    int ans = 0;\r\n    for (int i = 0; i < m; ++i) (ans += f[n][i]) %= k;\r\n    printf(\"%d\", ans);\r\n    return 0;\r\n}\r\n```\r\n100\u5206\u4ee3\u7801\uff08\u4eba\u50bb\u5927\u5e38\u6570\u5927\r\n```\r\n#include<bits/stdc++.h>\r\nusing namespace std;\r\ninline int read(){\r\n    char ch = getchar(); int u = 0, f = 1;\r\n    while (!isdigit(ch)) { if (ch == '-') f = -1; ch = getchar(); }\r\n    while (isdigit(ch)) { u = (u << 1) + (u << 3) + ch - 48; ch = getchar(); }\r\n    return u * f;\r\n}\r\nconst int maxn = 5050;\r\nint f[maxn][30], n, m, k;\r\nint nxt[maxn], match[maxn][50];\r\nchar md[maxn];\r\ninline void Kmp(){ \r\n    nxt[0] = -1;\r\n    for (int i = 1; i <= m; ++i){\r\n        int j = nxt[i - 1];\r\n        while (j != -1 && md[j + 1] != md[i]) j = nxt[j];\r\n        nxt[i] = j + 1;\r\n    }\r\n    nxt[0] = 0;\r\n    for (int i = 0; i < m; ++i){\r\n        for (int j = '0'; j <= '9'; ++j){\r\n            int temp = i;\r\n            while (md[temp + 1] != j && temp > 0) temp = nxt[temp];\r\n            if (md[temp + 1] == j) temp++;\r\n            if (temp < m) match[i][temp]++;\r\n        }\t\r\n    }\r\n}\r\nclass MARTIX{\r\npublic:\r\n    int mr[23][23];\r\n    MARTIX(){ memset(mr, 0, sizeof(m)); }\t\r\n    void pr(){ for (int i = 0; i <= m; i++, cerr << endl) for (int j = 0; j <= m; ++j) cerr << mr[i][j] << \" \"; }\r\n    MARTIX operator * (MARTIX B){\r\n        MARTIX Rtn;\r\n        memset(Rtn.mr, 0, sizeof(Rtn.mr));\r\n        for (int i = 0; i < m; ++i)\r\n            for (int j = 0; j < m; ++j)\r\n                for (int p = 0; p < m; ++p)\r\n                    { (Rtn.mr[i][j] += mr[i][p] * B.mr[p][j]) %= k; }\r\n        return Rtn;\r\n    }\r\n}F, G;\r\n\r\ninline MARTIX ksm(MARTIX A, int pw){\r\n    MARTIX Rtn;\r\n    for (int i = 0; i <= m; ++i)\r\n        Rtn.mr[i][i] = 1;\r\n    for (; pw; pw >>= 1, A = A * A)\r\n        if (pw & 1) Rtn = Rtn * A;\r\n    return Rtn;\r\n}\r\nsigned main(){\r\n    \r\n    n = read(), m = read(), k = read(); scanf(\"%s\", md + 1);\r\n    \r\n    Kmp();\r\n\r\n    F.mr[0][0] = 1;\r\n    for (int i = 0; i <= m; ++i)\r\n        for (int j = 0; j <= m; ++j)\r\n            G.mr[i][j] = match[i][j];\r\n    G = ksm(G, n); \r\n    F = F * G;\r\n    int ans = 0;\r\n    \r\n    for (int i = 0; i < m; ++i) { (ans += F.mr[0][i]) %= k; }\r\n    printf(\"%d\", ans);\r\n    return 0;\r\n}\r\n```\r\n",
        "postTime": 1523545248,
        "uid": 42857,
        "name": "Edgration",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3193 \u3010[HNOI2008]GT\u8003\u8bd5\u3011"
    },
    {
        "content": "[$$\\Large\\texttt{My Blog}$$](https://hydingsy.github.io/articles/problem-HNOI-2008-GT-Exam/)\n\n---\n\n## Description\n\n> \u9898\u76ee\u94fe\u63a5\uff1a[Luogu 3193](https://www.luogu.org/problemnew/show/P3193)\n\n\u963f\u7533\u51c6\u5907\u62a5\u540d\u53c2\u52a0 GT \u8003\u8bd5\uff0c\u51c6\u8003\u8bc1\u53f7\u4e3a $n$ \u4f4d\u6570 $X_1,X_2,\\dots,X_n$\uff0c\u4ed6\u4e0d\u671b\u51c6\u8003\u8bc1\u53f7\u4e0a\u51fa\u73b0\u4e0d\u5409\u5229\u7684\u6570\u5b57\u3002\u4ed6\u7684\u4e0d\u5409\u5229\u6570\u5b66 $A_1,A_2,\\dots,A_m$ \u6709 $m$ \u4f4d\uff0c\u4e0d\u51fa\u73b0\u662f\u6307 $X_1,X_2,\\dots,X_n$ \u4e2d\u6ca1\u6709\u6070\u597d\u4e00\u6bb5\u7b49\u4e8e $A_1,A_2,\\dots,A_m$\u3002\u6ce8\u610f $A_1$ \u548c $X_1$ \u53ef\u4ee5\u4e3a $0$\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\le n\\le 10^9$\uff0c$1\\le m\\le 20$\uff0c$1\\le k\\le 1000$\uff0c$0\\le X_i,A_i\\le 9$\n\n------\n\n## Solution\n\n\u6211\u4eec\u5b9a\u4e49 $\\text{DP}$ \u72b6\u6001 $f_{i,j}$ \u8868\u793a\u8003\u8651\u5230\u7b2c $i$ \u4e2a\u6570\uff0c\u5339\u914d\u5230\u4e86 $X$ \u4e2d\u7684\u7b2c $j$ \u4e2a\u5b57\u7b26\u65f6\u7684\u65b9\u6848\u6570\u3002\u663e\u7136 $i,j$ \u7684\u8303\u56f4\u662f $0\\le i\\le n$\uff0c$0\\le j<m$\u3002\n\n\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a\n$$f_{i,j}=\\sum_{k=0}^{9} f_{i-1,p}$$\n\u5176\u4e2d\u7684 $p$ \u4e0d\u4e00\u5b9a\u662f $0$ \u6216\u8005 $j-1$\uff0c\u56e0\u4e3a\u52a0\u5165\u5b57\u7b26 $k$ \u540e\uff0c\u6709\u5982\u4e0b\u4e09\u79cd\u60c5\u51b5\uff1a\n\n1. \u5339\u914d\u5230\u4e86 $X$ \u4e2d\u7684\u4e0b\u4e00\u4e2a\u5b57\u7b26\u3002\n2. \u5931\u914d\uff0c\u65e0\u6cd5\u5339\u914d\u4efb\u4f55\u5b57\u7b26\u3002\n3. \u91cd\u65b0\u5339\u914d\u5230\u4e86 $X$ \u7684\u4e00\u4e2a\u524d\u7f00\u3002\n\n\u8fd9\u4e2a\u5f0f\u5b50\u770b\u4f3c\u65e0\u6cd5\u4f18\u5316\u4e86\uff0c\u6211\u4eec\u6362\u4e00\u79cd\u65b9\u5f0f\u5199\u51fa\u8f6c\u79fb\u65b9\u7a0b\uff1a\n$$f_{i,j}=\\sum_{k=0}^{m-1} f_{i-1,k}\\times g_{k,j}$$\n\u5176\u4e2d\u7684 $g_{k,j}$ \u8868\u793a\u4e00\u4e2a\u5339\u914d\u4e86\u957f\u5ea6\u4e3a $k$ \u957f\u5ea6\u7684\u4e32\uff0c\u6709\u591a\u5c11\u79cd\u52a0\u6570\u5b57\u7684\u65b9\u6cd5\uff0c\u4f7f\u5f97\u5339\u914d\u957f\u5ea6\u53d8\u6210 $j$\u3002\n\n\u7531\u4e8e\u6211\u4eec\u77e5\u9053\u539f\u4e32\uff0c\u90a3\u4e48 $g_{i,j}$ \u662f\u56fa\u5b9a\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u8fd9\u4e2a\u6570\u7ec4\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 $\\text{KMP}$ \u7b97\u6cd5\uff0c\u6c42\u51fa $\\text{next}$ \u6570\u7ec4\u540e\uff0c\u679a\u4e3e\u5339\u914d\u957f\u5ea6 $k$ \u548c\u5b57\u7b26 $ch$\uff0c\u66b4\u529b\u8ba1\u7b97\u80fd\u5339\u914d\u5230\u591a\u957f\u7684\u524d\u7f00\u3002\n\n\u8fd9\u6837\u4e00\u6765\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a $O(nm^2)$ \u7684\u7b97\u6cd5\u3002\n\n\u518d\u6b21\u89c2\u5bdf\u8fd9\u4e2a $\\text{DP}$ \u5f0f\u5b50\uff0c\u53ef\u4ee5\u8f7b\u677e\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50\u548c**\u77e9\u9635\u4e58\u6cd5**\u7684\u5f0f\u5b50\u975e\u5e38\u76f8\u4f3c\uff0c\u90a3\u4e48\u6211\u4eec\u7528\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316 $\\text{DP}$ \u8f6c\u79fb\u5373\u53ef\uff0c\u6c42\u51fa $g$ \u77e9\u9635\u7684 $n$ \u6b21\u5e42\u3002\n\n**\u65f6\u95f4\u590d\u6742\u5ea6**\uff1a$O(m^3\\log n)$\n\n------\n\n## Code\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n\nconst int N=21;\nint n,m,mod,nxt[N];\nchar s[N];\n\nvoid upd(int &x,int y) {\n\t(x+=y)>=mod&&(x-=mod);\n}\nstruct Matrix {\n\tint n,A[N][N];\n\tMatrix(int _n=0) {n=_n,memset(A,0,sizeof(A));}\n\tvoid operator ~ () {\n\t\tfor(int i=0;i<n;++i) A[i][i]=1;\n\t}\n\tMatrix operator * (const Matrix &b) const {\n\t\tMatrix ret(n);\n\t\tfor(int i=0;i<n;++i) for(int j=0;j<n;++j) for(int k=0;k<n;++k) {\n\t\t\tupd(ret.A[i][k],1LL*A[i][j]*b.A[j][k]%mod);\n\t\t}\n\t\treturn ret;\n\t}\n\tMatrix operator ^ (const long long &b) const {\n\t\tMatrix ret(n),x=*this; ~ret;\n\t\tfor(long long p=b;p;p>>=1,x=x*x) if(p&1) ret=ret*x;\n\t\treturn ret;\n\t}\n};\n\nMatrix kmp() {\n\tnxt[1]=0;\n\tfor(int i=2,j=0;i<=m;++i) {\n\t\twhile(j&&s[j+1]!=s[i]) j=nxt[j];\n\t\tif(s[j+1]==s[i]) ++j;\n\t\tnxt[i]=j;\n\t}\n\tMatrix a(m);\n\tfor(int i=0;i<m;++i) {\n\t\tfor(char ch='0';ch<='9';++ch) {\n\t\t\tint j=i;\n\t\t\twhile(j&&s[j+1]!=ch) j=nxt[j];\n\t\t\tif(s[j+1]==ch) ++j;\n\t\t\t++a.A[i][j];\n\t\t}\n\t}\n\treturn a;\n}\nint main() {\n\tscanf(\"%d%d%d%s\",&n,&m,&mod,s+1);\n\tMatrix a=kmp();\n\ta=a^n;\n\tint ans=0;\n\tfor(int i=0;i<m;++i) upd(ans,a.A[0][i]);\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1549595242,
        "uid": 49725,
        "name": "Siyuan",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3193 \u3010[HNOI2008]GT\u8003\u8bd5\u3011"
    },
    {
        "content": " _~~\u672c\u840c\u65b0\u6d1b\u8c37\u7b2c\u4e00\u7bc7\u9898\u89e3~~_ \n \n \u770b\u4e86\u5f88\u591a\u9898\u89e3\uff0c\u53d1\u73b0\u6709\u5f88\u591a\u7ec6\u8282\u76f4\u63a5\u5ffd\u7565\u4e86\uff0c\u6240\u4ee5\u6211\u5c06\u5404\u4f4d\u5927\u4f6c\u7684\u601d\u8def\u6574\u5408\u4e86\u4ee5\u4e0b\n## \u9898\u5916\u8bdd\n\u672c\u6765\u5c31\u662f\u60f3\u597d\u597d\u60f3\u7ec3\u4e00\u4e0b$KMP$\uff0c\u6839\u636e\u4f60\u8c37\u6807\u7b7e\u627e\u5230\u4e86\u8fd9\u9053\u9898\uff0c\u770b\u9898\u9762\u90a3\u4e48\u7b80\u77ed\uff0c\u4ee5\u4e3a\u5e76\u4e0d\u662f\u5f88\u96be\uff08\u867d\u7136\u662f\u7d2b\u7684\uff09\uff0c\u7ed3\u679c\u505a\u7740\u505a\u7740\u5c31\u50bb\u4e86\n\u8fd9\u9898\u5f88\u7efc\u5408\uff0c$DP$+\u77e9\u9635\u5feb\u901f\u5e42+$KMP$\uff0c\u6211\u539f\u5730\u87ba\u65cb\u5347\u5929sto orz\n### \u72b6\u6001\u8f6c\u79fb\uff1a\n* \u8bbe$dp[i][j]$\u8868\u793a\u957f\u5ea6\u4e3a$i$\u7684\u5b57\u7b26\u4e32\uff0c\u6700\u540e$j$\u4e2a\u53ef\u4ee5\u5339\u914d\u6a21\u5f0f\u4e32\u524d$j$\u4f4d\u7684\u60c5\u51b5\u6570\uff0c\u7b54\u6848\u5c31\u662f$\\sum_{i=0}^{m-1}dp[n][i]$\n* However,\u7406\u8bba\u662f\u6709\u4e86\uff0c\u5982\u4f55\u5b9e\u73b0\uff1f\n* \u5173\u952e\u5728\u4e8e\u5bf9\u6a21\u5f0f\u4e32\u7684\u4e0d\u540c\u5339\u914d\u60c5\u51b5\uff0c\u7528\u4e00\u4e2a$g[k][j]$\u5bf9\u4e8e\u4e00\u4e2a\u5339\u914d\u5230\u957f\u5ea6\u4e3a $j$\u7684\u4e32\uff0c\u8f6c\u79fb\u5230 $k$ \u7684\u4e32\u7684\u65b9\u6848\n* \u6b64\u65f6\u8f6c\u79fb\u65b9\u7a0b$dp[i][j] = \\sum_{k=0}^{m-1}dp[i-1][k]*g[k][j]$\uff0c\u4f60\u770b\uff0c\u4f60\u770b\uff0c\u4f60\u4ed4\u7ec6\u770b\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u50cf\u4ec0\u4e48\uff1f\u77e9\u9635\u4e58\u554a\uff01\uff08\u672c\u849f\u84bb\u6c38\u8fdc\u63a8\u4e0d\u51fa\u6765\u7cfb\u5217\uff09\n* \u56e0\u4e3a\u6211\u4eec\u6700\u540e\u53ea\u9700\u8981$n$\u8fd9\u4e00\u884c\u77e9\u9635\uff0c\u6240\u4ee5\u6211\u4eec\u628a\u6bcf\u4e00\u884c$dp[i][j]$\u62bd\u8c61\u6210**\u53ea\u6709\u4e00\u884c**\uff0c**\u5217\u6570\u4e3a**$m-1$\u7684$F[i]$,\u6700\u540e\u5c31\u53d8\u6210\u4e86$F[i] = F[i-1]*G$,\u63a8\u51fa$F[n] = F[0]*G^{n}$,\u8fd9\u65f6\u5019\u5c31\u53ef\u4ee5\u8dd1\u77e9\u9635\u5feb\u901f\u5e42\u4e86\uff08\u8fd9\u91cc\u5f88\u591a\u9898\u89e3\u4e00\u5e26\u800c\u8fc7\uff0c\u9700\u8981\u5bf9\u77e9\u9635\u4e58\u6cd5\u7406\u89e3\u900f\u5f7b\uff09\n\n~~\u7b49\u4f1a\u513f\uff0c\u6211\u4e0d\u662f\u6765\u7ec3$KMP$\u7684\u5417\uff1f\uff1f\uff1f~~\n## Code\n```c++\n#include<bits/stdc++.h>\n#define N 25\nusing namespace std;\ninline int read(){\n\tint x = 0,f =  1;\n\tchar ch = getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=(x<<1)+(x<<3)+(ch^48);ch=getchar();}\n\treturn x*f;\n}\nint n,m,mod,kmp[N];\nchar s[N];\nstruct xzy{//\u5b9a\u4e49\u77e9\u9635\n\tint a[N][N];\n\txzy(){memset(a,0,sizeof(a));}\n}G,F;\nxzy operator *(xzy a,xzy b){//\u77e9\u9635\u4e58\u6cd5\n\txzy ans;\n\tfor(int i = 0;i < m;i++){\n\t\tfor(int j = 0;j < m;j++){\n\t\t\tfor(int k = 0;k < m;k++){\n\t\t\t\tans.a[i][j] = (ans.a[i][j]+a.a[i][k]*b.a[k][j]%mod)%mod;\n\t\t\t}\n\t\t}\n\t}\n\treturn ans;\n}\nxzy quickpow(xzy g,int t){//\u77e9\u9635\u5feb\u901f\u5e42\n\txzy ans;\n\tfor(int i = 0;i < m;i++)ans.a[i][i] = 1;\n\twhile(t){\n\t\tif(t&1)ans = ans*g;\n\t\tg = g*g;\n\t\tt >>= 1;\n\t}\n\treturn ans;\n}\nint main(){\n\tn=read();m=read();mod=read();\n\tscanf(\"%s\",s+1);\n\tint j=0;\n\tfor(int i=2;i<=m;++i) {//kmp\u6c42\u5339\u914d\u60c5\u51b5\n\t\twhile(j && s[j+1]!=s[i]) j=kmp[j];\n\t\tif(s[j+1]==s[i]) j++;\n\t\tkmp[i]=j;\n\t}\n\t\n\tfor(int i=0;i<m;++i) {//\u7b97\u51fa\u6240\u6709\u672a\u5b8c\u5168\u5339\u914d\u7684\u4e2a\u6570\uff08\u8fd9\u597d\u50cf\u624d\u662f\u6211\u7684\u672c\u610f\u2026\u2026\uff09\n\t\tfor(char ch='0';ch<='9';++ch) {//\u679a\u4e3e\u6240\u6709\u4f4d\u6570\n\t\t\tint j=i;\n\t\t\twhile(j && s[j+1]!=ch) j=kmp[j];//\u5931\u914d\u56de\u8df3\n\t\t\tif(s[j+1]==ch) j++;//\u8be5\u60c5\u51b5\u6210\u7acb\n\t\t\tG.a[i][j]=(G.a[i][j]+1)%mod;//\u52a0\u4e0a\u4e00\u79cd\u60c5\u51b5\n\t\t}\n\t}\n\tF.a[0][0]=1;//F\u662f\u4e00\u884cm\u5217\u7684\n\tG=quickpow(G,n);\n\tF=F*G;\n\tint ans=0;\n\tfor(int i=0;i<m;++i) ans=(ans+F.a[0][i])%mod;\n\tprintf(\"%d\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1595466501,
        "uid": 322491,
        "name": "HH_Halo",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P3193 \u3010[HNOI2008]GT\u8003\u8bd5\u3011"
    },
    {
        "content": "\u4e00\u5f00\u59cb\u611f\u89c9\u8fd9\u9053\u9898\u76ee\u5f88\u96be\u554a\u4ec0\u4e48\u7684\uff1b\n\n\u7136\u540e\u8eab\u8fb9\u7684\u540c\u5b66\u4eec\u6162\u6162\u90fdac\u4e86\uff1b\n\n\u624d\u53d1\u73b0\u8fd9\u9053\u9898\u5e76\u4e0d\u662f\u600e\u4e48\u7684\u96be\uff1b\n\n\u6211\u4eec\u641e\u4e00\u4e2af[i][j]\u8868\u793a\u73b0\u5728\u5df2\u7ecf\u6709i\u4e2a\u6570\u5b57\u4e86\uff0c\u800c\u4e14\u6700\u540ej\u4e2a\u6570\u5b57\u662f\u4e0d\u5e78\u6570\u5b57\u7684\u4e00\u90e8\u5206\uff1b\n\n\u6ce8\u610f\u5bf9\u4e8e\u540c\u4e00\u4e2a\u72b6\u6001j\u8981\u7adf\u53ef\u80fd\u5927\uff1b\n\n\u6bd4\u5982\n1212\u662f\u4e0d\u5e78\u6570\u5b57\n\n\u90a3\u4e48551212\u662ff[6][4];\n\n\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0f[0][0]=1;\n\nans=f[n][k] (k=0~m-1)\n\n\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u53ef\u4ee5\u4ecef[0][0]\u5730\u63a8\uff1b\n\n\u6bcf\u5c40\u8fd9\u4e2a\u72b6\u6001\u6700\u540e\u653e\u4e00\u4e2a\u4ec0\u4e48\u6570\u5b57\uff0c\u7136\u540ekmp\u6c42j\n\na[j][k]\u8868\u793aj\u4e2a\u4e0d\u5e78\u4e4b\u540e\u653ek\u4ea7\u751f\u7684\u65b0\u7684j\n\n```cpp\nf[i+1][a[j][k]]=(f[i+1][a[j][k]]+f[i][j])%mo;\n```\n\n```cpp\n#include<bits/stdc++.h>\n#define Ll long long\nusing namespace std;\nconst int N=25,M=1e5+5;\nint n,m,mo,ans;\nchar c[N];\nint f[M][N],p[N],a[N][10];\nvoid make(){\n    p[0]=-1;\n    int j=-1;\n    for(int i=1;i<=m;p[i++]=++j)\n        while(j!=-1&&c[i]!=c[j+1])j=p[j];\n}\nint find(int j,int k){\n    while(j!=-1&&c[j+1]!=char(k+48))j=p[j];\n    return j+1;\n}\nint main()\n{\n    scanf(\"%d%d%d\",&n,&m,&mo);\n    scanf(\"%s\",c+1);\n    make();\n    for(int j=0;j<=m-1;j++)\n        for(int i=0;i<=9;i++)a[j][i]=find(j,i);\n    f[0][0]=1;\n    for(int i=0;i<n;i++)\n        for(int j=0;j<m;j++)\n            for(int k=0;k<=9;k++)\n                f[i+1][a[j][k]]=(f[i+1][a[j][k]]+f[i][j])%mo;\n    for(int i=0;i<m;i++)ans+=f[n][i];\n    printf(\"%d\",ans%mo);\n}\n```\n\n\u7136\u540e\u7528\u77e9\u9635\u4f18\u5316\u5c31\u597d\u4e86\uff1b\n\n\u5b8c\u5168\u7684\u4ee3\u7801\u53ef\u4ee5\u770b\u6211\u535a\u5ba2\uff1a\n\nhttp://blog.csdn.net/largecub233/article/details/74327768\n",
        "postTime": 1499150512,
        "uid": 7442,
        "name": "\u5de8\u578b\u65b9\u5757",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3193 \u3010[HNOI2008]GT\u8003\u8bd5\u3011"
    },
    {
        "content": "\u6211\u7684\u601d\u8def\u8ddf\u5404\u4f4d\u5927\u4f6c\u6709\u70b9\u4e0d\u4e00\u6837\uff0c\u6211\u662f\u5148\u6c42\u51fa\u6765**\u51fa\u73b0\u4e0d\u5409\u5229\u53f7\u7801**\u6709\u591a\u5c11\u79cd\u60c5\u51b5\uff0c\u518d\u7528$10^n$\u51cf\u53bb\u4ed6\u5f97\u51fa\u7b54\u6848\u3002\n\n\u601d\u8def\u8ddf\u666e\u901a\u7684\u505a\u6cd5\u5dee\u4e0d\u591a\u3002\u628a\u77e9\u9635\u62d3\u5c55\u4e00\u7ef4\uff0c\u4e5f\u5c31\u662f$m+1$\u7ef4\u3002\u524d$m$\u7ef4\u662f\u4e00\u6a21\u4e00\u6837\u7684\uff0c\u6700\u540e\u4e00\u7ef4\u8bb0\u5f55**\u5df2\u7ecf\u51fa\u73b0\u8fc7\u4e0d\u5409\u5229\u53f7\u7801\u7684\u6570\u91cf**\u3002\n\n\u521d\u59cb\u77e9\u9635\u5c31\u662f1,0,0,0... \u8f6c\u79fb\u77e9\u9635\u7684$(m+1,m+1)$\u4f4d\u7f6e\u662f10\u3002\u9700\u8981\u6ce8\u610f$m+1$\u5217\u7684\u524d$m$\u4f4d\u4e0d\u4e00\u5b9a\u662f0\u3002\n\n\u4ee5\u6837\u4f8b\u4e3a\u4f8b \u8f6c\u79fb\u77e9\u9635\n$$\n \\left[\n \\begin{matrix}\n   9 &1 &0 &0\\\\ \n9&0& 1 &0 \\\\\n9 &0 &0 &1 \\\\\n0 &0& 0 &10 \n  \\end{matrix}\n  \\right] $$\n\u521d\u59cb\u77e9\u9635\n$$\n \\left[\n \\begin{matrix}\n\n1 &0& 0 &0 \n  \\end{matrix}\n  \\right] $$\n\u4ee3\u7801\uff1a  \n``` cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef pair<int,int> pii;\n#define forg(i,x) for(int i=first[x];i;i=nxt[i])\n#define forl(z,i,x) for(int i=z.first[x],y=z.to[i];i;i=z.nxt[i],y=z.to[i])\n#define uu unsigned\n#define fi first\n#define se second\n#define ran() ((unsigned)rand())\n#define lam(z,k) [&](const z &a,const z &b){ return k; }\n#define od(x) ((x)&1)\n#define ev(x) (od(x)^1)\n\nint n,m,mod;char dan[23];\nint nxt[23];\nstruct mat{\n\tint a[23][23];\n\tint x,y;\n\tmat(){\n\t\tmemset(a,0,sizeof(a));\n\t}\n\tmat(int xx,int yy){\n\t\tx=xx,y=yy;memset(a,0,sizeof(a));\n\t}\n\tinline void pr(){\n\t\tputs(\"******************\");\n\t\tfor(int i=0;i<=x;++i){\n\t\t\tfor(int j=0;j<=y;++j)printf(\"%d \",a[i][j]);\n\t\t\tputs(\"\");\n\t\t}\n\t}\n};\nmat hp,st,res,zy;\nmat operator *(mat &a,mat &b){\n\tstatic mat hp;\n\thp=mat(a.x,b.y);\n\tfor(int k=0;k<=a.y;++k)for(int i=0;i<=hp.x;++i)for(int j=0;j<=hp.y;++j){\n\t\t(hp.a[i][j] += a.a[i][k]*b.a[k][j])%=mod;\n\t}\n\treturn hp;\n}\ninline mat mpor(mat &be,mat &a,int p){\n\thp=be;\n\tfor(int i=p;i;i>>=1){\n\t\tif(i&1)hp=hp*a;\n\t\ta=a*a;\n\t}\n\treturn hp;\n}\n\ninline mat giao(){\n\t// 10^n % mod\n\tmat a=mat(0,0),b=mat(0,0);\n\ta.a[0][0]=1%mod,b.a[0][0]=10%mod;\n\treturn mpor(a,b,n);\n}\ninline int msub(int a,int b){\n\treturn a>=b?a-b:a-b+mod;\n}\nint main(){\n\tscanf(\"%d%d%d%s\",&n,&m,&mod,dan+1);\n\tnxt[0]=-1,nxt[1]=0;\n\tfor(int i=2,j=0;i<=m;++i){\n\t\twhile(~j&&dan[j+1]!=dan[i])j=nxt[j];\n\t\tnxt[i]=++j;\n\t}\n\tst=mat(0,m); st.a[0][0]=1;\n\tzy=mat(m,m);\n\tfor(int i=0;i<m;++i)for(int j='0';j<='9';++j){\n\t\tint k=i;\n\t\twhile(~k&&dan[k+1]!=j)k=nxt[k];\n\t\t++k;//\u666e\u901a\u7684\u505a\u6cd5\u5f97\u5199\u4e00\u53e5 if(k!=m)\n\t\t++zy.a[i][k];\n\t}\n\tzy.a[m][m]=10;\n\n\tres=mpor(st,zy,n);\n\tmat why=giao();//\u6c4210^n\n\tprintf(\"%d\\n\",msub(why.a[0][0],res.a[0][m]));\n\treturn 0;\n}\n```",
        "postTime": 1592873774,
        "uid": 152497,
        "name": "\u7cbe\u795e\u5c0f\u706b",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3193 \u3010[HNOI2008]GT\u8003\u8bd5\u3011"
    },
    {
        "content": "# \u6d1b\u8c37P3193[HNOI2008]GT\u8003\u8bd5\n\u4f20\u9001\u95e8:[https://www.luogu.org/fe/problem/P3193](https://www.luogu.org/fe/problem/P3193)\n\n\u5148\u8bf4\u4e00\u4ef6\u5927\u4e8b:~~\u6211\u80cc\u53db\u4e86P\u515a~~\u6211\u8f6cc++\u5566!\n\n\u601d\u8def:\n\n\u770b\u5230\u8fd9\u9053\u9898,\u9996\u5148\u60f3\u66b4\u641c.\u66b4\u641c\u7684\u8bdd\u679a\u4e3e\u6bcf\u4e00\u4f4d,\u65f6\u95f4\u590d\u6742\u5ea6O(10^n),\u4e0d\u70b8\u98de\u624d\u602a.\n\n\u90a3\u4e48,\u66b4\u641c\u6162\u5728\u54ea\u91cc?\u5c31\u662f\u56e0\u4e3a\u4e00\u4e2a\u4e00\u4e2a\u52a0.\u4e00\u5768\u4e00\u5768\u52a0\u4e0d\u5c31\u5feb\u4e86\u5417?\n\n\u5982\u4f55\u4e00\u5768\u4e00\u5768\u52a0?\u8003\u8651\u5206\u7c7b\u8ba8\u8bba,\u5c06\u5f53\u524d\u7684\u6570\u4e32\u5206\u4e3a\u4ee5\u4e0b\u51e0\u79cd\u60c5\u51b5:\n\n(1):\u8be5\u4e32\u540e\u7f00\u4e0e\u4e0d\u5409\u5229\u4e32\u524d\u7f00\u6700\u591a\u80fd\u5339\u914d0\u4f4d\n\n(2):\u8be5\u4e32\u540e\u7f00\u4e0e\u4e0d\u5409\u5229\u4e32\u524d\u7f00\u6700\u591a\u80fd\u5339\u914d1\u4f4d\n\n(3):\u8be5\u4e32\u540e\u7f00\u4e0e\u4e0d\u5409\u5229\u4e32\u524d\u7f00\u6700\u591a\u80fd\u5339\u914d2\u4f4d\n\n(4):\u8be5\u4e32\u540e\u7f00\u4e0e\u4e0d\u5409\u5229\u4e32\u524d\u7f00\u6700\u591a\u80fd\u5339\u914d3\u4f4d\n\n......\n\n(m):\u8be5\u4e32\u540e\u7f00\u4e0e\u4e0d\u5409\u5229\u4e32\u524d\u7f00\u6700\u591a\u80fd\u5339\u914dm-1\u4f4d\n\n\u62ff\u6837\u4f8b\u6765\u8bf4,\u5c31\u662f:\n\n(1):\u8be5\u4e32\u540e\u7f00\u4e0e111\u524d\u7f00\u6700\u591a\u80fd\u5339\u914d0\u4f4d(X...XXX)\n\n(2):\u8be5\u4e32\u540e\u7f00\u4e0e111\u524d\u7f00\u6700\u591a\u80fd\u5339\u914d1\u4f4d(X...XX1)\n\n(3):\u8be5\u4e32\u540e\u7f00\u4e0e111\u524d\u7f00\u6700\u591a\u80fd\u5339\u914d2\u4f4d(X...X11)\n\n\u4e09\u4f4d\u662f\u4e0d\u53ef\u80fd\u7684\n\n\u60f3\u5230\u72b6\u6001:f[i][j]\u8868\u793a\u524di\u4f4d,\u8be5\u4e32\u540e\u7f00\u4e0e\u4e0d\u5409\u5229\u4e32\u524d\u7f00\u6700\u591a\u5339\u914dj\u4f4d\u7684\u65b9\u6848\u6570\n\n\u90a3\u4e48f[i][0]\u4f1a\u52a0\u5230\u54ea\u91cc\u53bb?\n\n\u4e00\u4e2a\u5339\u914d0\u4f4d\u7684\u4e32\u518d\u52a0\u4e00\u4f4d,\u6709\u4e24\u79cd\u60c5\u51b5:\n\n(1)\u52a01 \u7531XXX\u53d8\u6210XX1,f[i+1][1]+=f[i][0]\n\n(2)\u4e0d\u52a01 \u7531XXX\u53d8\u6210XXX,f[i+1][0]+=f[i][0]*9\n\n\u6309\u540c\u6837\u7684\u65b9\u6cd5,\u53ef\u4ee5\u63a8\u51fa\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b:\n\nf[i+1][0]=f[i][0]*9+f[i][1]*9+f[i][2]*9\n\nf[i+1][1]=f[i][0]\n\nf[i+1][2]=f[i][1]\n\n\u4f46\u8fd9\u53ea\u662f\u4e0d\u5409\u5229\u4e32\u4e3a111\u65f6\u7684\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b,\u6362\u4e00\u4e0b\u53c8\u5f97\u91cd\u63a8o(T\u30d8To)\n\n\u90a3\u600e\u4e48\u529e?\u53ea\u80fd**\u8ba9\u7535\u8111\u6765\u63a8\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b**!\n\n\u4ec0\u4e48?\u8fd8\u6709\u8fd9\u79cd\u64cd\u4f5c?\u522b\u6025,\u4e14\u542c\u6211\u6162\u6162\u9053\u6765\n\n\u8bbea[i][j]\u8868\u793af[x][i]\u8f6c\u79fb\u5230f[x+1][j]\u6709\u51e0\u79cd\u53ef\u80fd\n\n\u60f3\u60f3,\u521a\u521a\u4eba\u5de5\u60f3\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u662f\u600e\u4e48\u641e\u7684?\n\n\u5bf9\u5440!**\u679a\u4e3e\u6700\u540e\u4e00\u6b65(\u4f4d)**!\n\n\u679a\u4e3e\u6700\u540e\u4e00\u4f4d(\u7b2cx+1\u4f4d)\u662f\u4ec0\u4e48\n\n\u679a\u4e3e\u5b8c\u4e86\u4ee5\u540e\u518d\u679a\u4e3ek,k\u8868\u793a\u5f53\u524d\u4e32\u7684\u6700\u540ek\u4f4d\u548c\u4e0d\u5409\u5229\u4e32\u7684\u524dk\u4f4d\u6bd4\u8f83\n\n\u679a\u4e3e\u5b8ck\u518d\u5199\u4e00\u4e2acheck\u51fd\u6570,\u5224\u65ad\u5f53\u524d\u4e32\u7684\u6700\u540ek\u4f4d\u548c\u4e0d\u5409\u5229\u4e32\u7684\u524dk\u4f4d\u76f8\u4e0d\u76f8\u7b49\u5373\u53ef\n\n\u597d\u4e86!\u601d\u8def\u6574\u7406\u5b8c\u4e86,\u5c31\u6765\u770b\u770bCODE\u5427:\n```cpp\n//s\u4e3a\u4e0d\u5409\u5229\u4e32\na[0][0]=9;a[0][1]=1;//\u521d\u59cb\u5316\nfor(int i=1;i<m;i++){\n    for(int j=0;j<i;j++) tmp[j]=s[j];//\u6709j\u4f4d\u5df2\u7ecf\u5339\u914d\u597d\u4e86\n    for(int j=0;j<=9;j++){\n        tmp[i]=j+48;//\u6570\u5b57\u8f6c\u5b57\u7b26\n        int k;//\u6ce8\u610f\u8981\u5916\u9762\u5b9a\u4e49\n        for(k=i+1;k>=1;k--)\n            if(check(tmp+(i-k+1),s,k)) break;\n        a[i][k]++;//\u627e\u5230\u6700\u5927\u7684k\u540ea[i][k]++\n    }\n}\n```\n\u8fd8\u6709check\u51fd\u6570~~~\n```cpp\nbool check(char s1[],char s2[],int k){\n    for(int i=0;i<k;i++) if(s1[i]!=s2[i]) return 0;\n    return 1;\n}\n\n```\n\u597d\u5566!\u90a3\u8fd8\u6709\u4e00\u5927\u96be\u9898:n\u6700\u5927\u662f10^9......\n\n\u600e\u4e48\u529e\u5462?\u522b\u6002!\u5148\u628a\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5199\u51fa\u6765:\n\nf[i][j]=\u03a3(0<=k<m)f[i-1][k]*a[k][j]\n\n\u7b49\u7b49,\u597d\u50cf\u6709\u70b9\u50cf......\n\n\u518d\u786e\u8ba4\u4e00\u4e0b,\u4e0a\u77e9\u9635\u4e58\u6cd5\u7684\u5f0f\u5b50:\n\nc[i][j]=\u03a3(0<=k<m)a[i][k]*b[k][j]\n\n\u90a3\u4e0a\u9762\u4e00\u4e2a\u5f0f\u5b50\u4e0d\u5c31\u662ff[i-1]*a=f[i]\u561b!\n\n\u90a3\u4e48f[n]=f[0]*a^n\n\n\u6240\u4ee5\u5957\u7528\u77e9\u9635\u5feb\u901f\u5e42\u6c42\u51faa^n,\u77e9\u9635\u4e58\u6cd5\u6c42f[n],\u6700\u540e\u8f93\u51faf[0~m-1]\u7684\u548c\u5373\u53ef\n\n(\u4e5f\u53ef\u4ee5\u8f93\u51faa^n\u7b2c0\u884c\u7684\u548c)\n\n\u4e0a\u4ee3\u7801(\u5fc3\u7d2f\u554a):\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nstruct matrix{\n    int a[25][25],n,m;\n}x;\nint n,m,mod,ans,a[25][25];\nchar tmp[25],s[25];\nbool check(char s1[],char s2[],int k){\n    for(int i=0;i<k;i++) if(s1[i]!=s2[i]) return 0;\n    return 1;\n}\nmatrix mul(matrix a,matrix b){\n    matrix c;\n    c.n=a.n,c.m=b.m;\n    for(int i=0;i<c.n;i++)\n        for(int j=0;j<c.m;j++){\n            c.a[i][j]=0;\n            for(int k=0;k<a.m;k++) c.a[i][j]=(c.a[i][j]+a.a[i][k]*b.a[k][j]%mod)%mod;\n        }\n    return c;\n}\nmatrix q_pow(matrix a,int b){\n    matrix q;\n    q.n=m,q.m=m; \n    for(int i=0;i<q.n;i++)\n        for(int j=0;j<q.m;j++) q.a[i][j]=(i==j);\n    while(b>0){\n        if(b&1) q=mul(q,a);\n        a=mul(a,a);\n        b>>=1;\n    }\n    return q;\n}\nint main(){\n    scanf(\"%d%d%d\",&n,&m,&mod);\n    scanf(\"%s\",s);\n    a[0][0]=9;a[0][1]=1;\n    for(int i=1;i<m;i++){\n        for(int j=0;j<i;j++) tmp[j]=s[j];\n        for(int j=0;j<=9;j++){\n            tmp[i]=j+48;\n            int k;\n            for(k=i+1;k>=1;k--)\n                if(check(tmp+(i-k+1),s,k)) break;\n            a[i][k]++;\n        }\n    }\n    for(int i=0;i<m;i++)\n        for(int j=0;j<m;j++) x.a[i][j]=a[i][j];\n    x.n=x.m=m;\n    x=q_pow(x,n);\n    for(int i=0;i<m;i++) ans=(ans+x.a[0][i])%mod;\n    printf(\"%d\\n\",ans);\n    return 0;\n}\n```\n",
        "postTime": 1554900767,
        "uid": 104381,
        "name": "hanmo0321",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3193 \u3010[HNOI2008]GT\u8003\u8bd5\u3011"
    },
    {
        "content": "\u5b9e\u8bdd\u8bf4\u8fd9\u91cc\u7684\u9898\u89e3\u6211\u4e00\u4e2a\u90fd\u770b\u4e0d\u61c2\uff0c\u6211\u592a\u5f31\u4e86......\n\n\u5e0c\u671b\u6211\u7684\u8fd9\u4e00\u7bc7\u80fd\u591f\u9020\u798f\u66f4\u591a\u50cf\u6211\u4e00\u6837\u7684\u65b0\u624b\u3002\n\n\u5148\u6765\u8bf4\u4e00\u4e0b\u8f85\u52a9\u6570\u7ec4G\n\nG[i][j]\u8868\u793aA\u4e32\u7684\u524di\u4f4d\uff0c\u589e\u52a0\u4e00\u4e2a\u5b57\u7b26\u540e\u7684\u540e\u7f00\u80fd\u4e0eA\u4e32\u7684\u524dj\u4f4d\u5339\u914d\u7684\u65b9\u6cd5\u6570\u3002\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u82e5A = 129919\n\nG[5][2]\u5c31\u662f1\uff0c\u56e0\u4e3a\u572812991\u540e\u52a0\u4e0a\u4e00\u4e2a2\u7684129912\u7684\u540e\u7f0012\u4e8e12991\u7684\u524d\u7f0012\uff0c\u5e76\u4e14\u53ef\u4ee5\u77e5\u9053\u8fd9\u662f\u552f\u4e00\u4e00\u79cd\u65b9\u6cd5\u3002\n\nG\u7684\u751f\u6210......\u7531\u4e8em\u53ea\u670920\uff0c\u6240\u4ee5\u76f4\u63a5\u66b4\u529b\u5c31\u884c\u4e86\uff0c\u5982\u679cm\u662f100\u53ef\u4ee5\u7528KMP\u7b97\u6cd5\u3002\n\nd[i][j]\u8868\u793a\u957f\u5ea6\u4e3ai\u4f4d\u7684\u4e32\uff0c\u672b\u5c3ej\u4f4d\u548cA\u4e32\u7684\u524dj\u4f4d\u5339\u914d\u7684\u65b9\u6cd5\u6570\u3002\n\nd[i][j] = d[i-1][0] \u4e58 G[0][j] + d[i-1][1] \u4e58 G[1][j] + ... + d[i-1][j] \u4e58 G[j][j]\n\n\u4e0b\u9762\u662f\u91cd\u70b9\uff01\uff01\uff01\uff01\uff01\n\n\u8fd9\u91cc\u4e5f\u662f\u6211\u770b\u4e0d\u61c2\u5176\u4ed6\u9898\u89e3\u7684\u4e00\u70b9\u3002\n\n\u7b54\u6848\u4e2d\u5199\u7684\u662fd[n][0]+d[n][1]+...+d[n][m-1]\n\n\u4f46\u662f\u8981\u6ce8\u610f\uff0c\u6700\u540em\u4f4d\u4e0d\u5339\u914d\u4e0d\u4ee3\u8868\u524d\u9762\u4e0d\u5339\u914d\n\n\u4f3c\u4e4e\u6211\u4eec\u7684G\u51fa\u73b0\u4e86\u4e00\u70b9\u95ee\u9898\n\n\u56e0\u4e3a\u53ea\u8981\u5728\u67d0\u4e00\u4f4d\u5339\u914d\u5230\u4e86m\u4f4d\uff0c\u4e4b\u540e\u4e0d\u8bba\u662f\u600e\u4e48\u6837\u7684\uff0c\u8fd9\u90fd\u662f\u4e00\u4e2a\u4e0d\u5409\u5229\u7684\u4e32\u3002\n\n\u6240\u4ee5\uff0c\u4ee4G[m][m] = 10\uff08\u53ea\u67090-9\u5341\u4e2a\u5b57\u7b26\uff09, \u800c\u5176\u4ed6\u7684G[m][j] \u90fd\u4e3a0.\n\n\u6700\u540e\uff0c\u6b64\u9898\u7684DP\u9700\u8981\u77e9\u9635\u4e58\u6cd5\u3002\n\n\u7531\u4e8e\u6211\u4e0d\u559c\u6b22\u6570\u7ec4\u96f6\u4e0b\u6807\uff0c\u6211\u5c31\u628a0->m\u6539\u6210\u4e861->m+1\u3002\n\n\u5176\u5b9e\u8fd9\u9053\u9898\u4ee3\u7801\u5e76\u4e0d\u96be\u5199\uff0c\u96be\u7684\u5730\u65b9\u662f\u5bf9\u9898\u7684\u7406\u89e3\u3002\n\n\u4ee3\u7801\u7ec6\u8282\u8bf7\u770b\u6211\u7684\u4ee3\u7801\u3002\n```\n#include <iostream>\n#include <string>\nusing namespace std;\nint n, m, K;\nstring x;\nstruct matrix\n{\n  int n, m;\n  int s[22][22];\n}p, q, r, null;\nint d[22][22];\nmatrix matmul(matrix a, matrix b)\n{\n  int i, j, k;\n  int n, m, p;\n  matrix ans = null;\n  n = ans.n = a.n;\n  m = a.m;\n  p = ans.m = b.m;\n  for(i = 1; i <= n; i++)\n    for(j = 1; j <= p; j++)\n      for(k = 1; k <= m; k++)\n        ans.s[i][j] = (ans.s[i][j] + a.s[i][k] * b.s[k][j]) % K;\n  return ans;\n}\nint main()\n{\n    int i, j, k, t, ans = 0;\n\tcin >> n >> m >> K >> x;\n    x = \" \" + x;\n    for(i = 0; i < m/*\u6ce8\u610f\uff01\uff01\uff01\uff01\uff01*/; i++)\n      for(j = 0; j <= 9; j++)\n        for(k = i + 1; k >= 0; k--)\n          if(k == 0 || x.substr(i - k + 2, k - 1) + (char)(j + '0') == x.substr(1, k))\n          {\n            d[i][k]++;//d[i][j]\u662f\u5339\u914di\u4f4d\u52a0\u4e00\u4e2a\u5b57\u7b26\u5339\u914dj\u4f4d\u7684\u65b9\u6cd5\u6570 \n            break;\n\t\t  }\n\td[m][m] = 10;//\u5df2\u7ecf\u5230\u4e86m\u4f4d\u5c31\u4e0d\u80fd\u56de\u53bb\u4e86 \n    r.n = r.m = m + 1;\n    for(i = 1; i <= m + 1; i++)\n      r.s[i][i] = 1;\n    p.n = p.m = m + 1;\n    for(i = 1; i <= m + 1; i++)\n      for(j = 1; j <= m + 1; j++)\n        p.s[i][j] = d[j - 1][i - 1];//\u53cd\u8fc7\u6765 \n    q.n = m + 1;\n    q.m = 1;\n    q.s[1][1] = 1;\n    t = n;\n    while(t)\n    {\n      if(t & 1) r = matmul(r, p);\n      p = matmul(p, p);\n      t /= 2;\n\t}\n\tq = matmul(r, q);\n\tfor(i = 1; i <= m; i++)\n\t  ans = (ans + q.s[i][1]) % K;\n\tcout << ans << endl;\n\treturn 0;\n}\n```\n\u6c42\u8fc7\uff0c\u8c22\u8c22\uff01\uff01\uff01",
        "postTime": 1538312080,
        "uid": 47140,
        "name": "\u65af\u8302",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3193 \u3010[HNOI2008]GT\u8003\u8bd5\u3011"
    },
    {
        "content": "\u77e9\u9635\u4e58\u6cd5\u52a0\u901f\u52a8\u6001\u89c4\u5212\n\n### step1\n\n\u9996\u5148\u5148\u9610\u8ff0\u4e00\u4e2asb\u9519\u8bef:\u6211\u521a\u5f00\u59cb\u4ee5\u4e3a\u7ed9\u7684\u5e8f\u5217\u662f\u65e0\u5173\u7b54\u6848\u7684\uff0c\u540e\u6765\u53d1\u73b0\u5176\u5b9e\u662f\u4e0d\u884c\u7684\uff0c\u56e0\u4e3a\u4f8b\u5982\n\nn=4 m=3 \u6570\u5217\u4e3a101\u548c\u6570\u5217\u4e3a111\u65f6\u662f\u4e0d\u4e00\u6837\u7684\u7b54\u6848\u56e0\u4e3a\u5bf9\u4e8e1111 1101\u5176\u4e00\u4e2a\u6709\u91cd\u590d\u4e00\u4e2a\u65e0\u91cd\u590d\u6784\u6210\u7684\u7b54\u6848\u4e0d\u540c~~\u5e94\u8be5\u53ea\u6709\u6211\u8fd9\u79cd\u849f\u84bb\u4f1a\u8fd9\u4e48\u60f3\u5427~~\n\n**\u5207\u5165\u6b63\u9898\uff1a**\n\n\u5728\u8fd9\u91cc\u8bbe$dp[i][j]$ \u4e3a\u6587\u672c\u4e32\u5230i\u6700\u591a\u80fd\u5339\u914d\u5230\u6a21\u5f0f\u4e32\u7684j\u4f4d\u4e0a(\u6587\u672c\u4e32\u4e2di-j+1--i\u4e3a\u4e0e\u6a21\u5f0f\u4e321--j\u4f4d\u76f8\u7b49)\u4e0a\u7684\u6570\u603b\u6570\n\n**\u518d\u5f15\u5165\u4e00\u4e2a\u6570\u7ec4$g$,$g[i][j]$\u8868\u793a\u5728\u6a21\u5f0f\u4e32\u524d\u7f00\u4e3ai\u540e\u52a0\u4e00\u4e2a\u6570\u5b57\u4f7f\u5f97\u540e\u7f00\u6700\u591a\u5339\u914d\u524d\u7f00\u6570\u91cf\u4e3aj\u7684\u65b9\u6848\u6570**\n\n\u7b54\u6848\u5373\u4e3a$\\sum_{i=0}^{m-1}dp[n][i]$\n\n\u53ef\u4ee5\u5f97\u51fa\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b$dp[i][j]=\\sum_{k=0}^{m-1}{dp[i-1][k]+g[k][j]}$\n\n\u4ec0\u4e48\u610f\u601d\u5462?**\u5176\u5b9e\u5c31\u662f\u5728i\u4f4d\u679a\u4e3e0-9\u7684\u53ef\u80fd\uff0c\u4f7fi-1\u4f4d\u4e0a\u5339\u914d\u7684k\u4e2a\u53d8\u4e3aj\u4e2a\u3002**\n\n\u7136\u540e\u672c\u95ee\u9898\u5c31\u53ef\u4ee5\u5728$O(n*m^2)$ \u7684\u65f6\u95f4\u5185\u89e3\u51b3\u4e86\n\n\u4ecb\u7ecd\u4e00\u4e0b$g$\u6570\u7ec4\u7684\u6c42\u6cd5\uff0c\u663e\u7136\u6d89\u53ca\u5230\u540e\u7f00\u524d\u7f00\u5339\u914d\uff0c\u4f7f\u7528kmp\u5373\u53ef\u3002\n\n```cpp\nvoid kmp()\n{\n\tp[1]=0;\n\tfor(int i=2;i<=m;i++)\n\t{\n\t\tint j=p[i-1];\n\t\twhile(s[j+1]!=s[i]&&j)j=p[j];\n\t\tif(s[j+1]==s[i])p[i]=j+1;\n\t}\n\tfor(int i=0;i<=m-1;i++)//\u5728i+1\u4f4d\u4e0a\u653ej\u53ef\u4ee5\u4f7f\u5f97\u6700\u591a\u5339\u914d\u4e2a\u6570\n\tfor(int j='0';j<='9';j++)\n\t{\n\t\tint k=i;\n\t\twhile(s[k+1]!=j&&k)k=p[k];\n\t\tif(s[k+1]==j)k++;\n\t\tg[i][k]++;\n\t}\n}\n```\n\n### step2\n\n\u663e\u7136\u4e0a\u6587\u7684\u590d\u6742\u5ea6\u662f\u4e0d\u8db3\u4ee5\u901a\u8fc7\u7684\u3002\n\n\u6b64\u65f6\u89c2\u5bdf\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b$dp[i][j]=\\sum_{k=0}^{m-1}{dp[i-1][k]+g[k][j]}$\n\n\u662f\u4e0d\u662f\u5f88\u50cf\u77e9\u9635\u4e58\u6cd5?\n\n\u6211\u4eec\u53ef\u4ee5\u5efa\u7acb\u4e24\u4e2a\u77e9\u9635$DP$\u77e9\u9635\u548c$G$ \u77e9\u9635\n\n$$\\begin{vmatrix}1\\\\0\\\\\\cdots\\\\0\\\\\\end{vmatrix}$$\n\n$$\\begin{vmatrix}g[0][0] &g[0][1] &\\cdots &g[0][m-1] \\\\g[1][0] &\\cdots & \\cdots &g[1][m-1] \\\\ \\cdots &\\cdots &\\cdots &\\cdots \\\\g[m-1][0] &g[m-1][1] &\\cdots & g[m-1][m-1]\\\\\\end{vmatrix}$$\n\u6b64\u65f6\u53d1\u73b0$DP$\u77e9\u9635\u8868\u793a$i=0$\u65f6\u7684\u60c5\u51b5\u5373$dp[0][0]=1$\u5176\u4f59\u4e3a0\n\n\u628a$DP$\u77e9\u9635\u4e0e$G$\u77e9\u9635\u7684n\u6b21\u76f8\u4e58\u5373\u5f97\u51fa\u6700\u7ec8\u7b54\u6848\u4e86\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,m,mo,tans;\nchar s[25];\nint p[25],g[25][25];\nvoid kmp()\n{\n\tp[1]=0;\n\tfor(int i=2;i<=m;i++)\n\t{\n\t\tint j=p[i-1];\n\t\twhile(s[j+1]!=s[i]&&j)j=p[j];\n\t\tif(s[j+1]==s[i])p[i]=j+1;\n\t}\n\tfor(int i=0;i<=m-1;i++)\n\tfor(int j='0';j<='9';j++)\n\t{\n\t\tint k=i;\n\t\twhile(s[k+1]!=j&&k)k=p[k];\n\t\tif(s[k+1]==j)k++;\n\t\tg[i][k]++;\n\t}\n}\nstruct node{\n\tint p[25][25];\n\tnode(){memset(p,0,sizeof(p));}\n}ans,G,dp;\nvoid tim(node &a,node b)\n{\n\tnode c;\n\tfor(int k=0;k<=m-1;k++)\n\tfor(int i=0;i<=m-1;i++)\n\tfor(int j=0;j<=m-1;j++)\n\tc.p[i][j]=(c.p[i][j]+a.p[i][k]*b.p[k][j])%mo;\n\ta=c;\n}\nvoid pow(node &G)\n{\n\tint t=n;for(int i=0;i<=m-1;i++)ans.p[i][i]=1;\n\twhile(t!=1)\n\t{\n\t\tif(t%2)tim(ans,G);\n\t\tt/=2;tim(G,G);\n\t}\n\ttim(ans,G);\n\tG=ans;\n}\nint main()\n{\n\tscanf(\"%d%d%d\",&n,&m,&mo);\n\tcin>>s+1;kmp();dp.p[0][0]=1;\n\tfor(int i=0;i<=m-1;i++)\n\tfor(int j=0;j<=m-1;j++)\n\tG.p[i][j]=g[i][j];\n\tpow(G);tim(dp,G);\n\tfor(int i=0;i<=m-1;i++)tans=(tans+dp.p[0][i])%mo;\n\tprintf(\"%d\",tans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1551105171,
        "uid": 41855,
        "name": "DavidJing",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3193 \u3010[HNOI2008]GT\u8003\u8bd5\u3011"
    },
    {
        "content": "# \u5e7f\u544a\n\n[\u849f\u84bb\u306eblog](http://www.cnblogs.com/dedicatus545/p/8902550.html)\n\n# \u601d\u8def\n\n\u9996\u5148\uff0c\u5982\u679c$n$\u548c$m$\u6ca1\u6709\u90a3\u4e48\u5927\u7684\u8bdd\uff0c\u6709\u4e00\u4e2a\u975e\u5e38\u663e\u7136\u7684dp\u505a\u6cd5\uff1a\n\n\u8bbe$dp[i][j]$\u8868\u793a\u957f\u5ea6\u4e3ai\u7684\u5b57\u7b26\u4e32\uff0c\u6700\u540ej\u4e2a\u53ef\u4ee5\u5339\u914d\u6a21\u677f\u4e32\u524dj\u4f4d\u7684\u60c5\u51b5\u6570\n\n\u90a3\u4e48\u663e\u7136\uff0c\u7b54\u6848\u5c31\u662f$\\sum_{i=0}^{m-1}dp[n][i]$\u4e86\n\n\u8f6c\u79fb\u8fc7\u7a0b\u5219\u9700\u8981\u7528\u4e00\u4e2a\u8f85\u52a9\u6570\u7ec4\uff1a\u4ee4$g[i][j]$\u8868\u793a\u6a21\u677f\u4e32\u7684\u524d\u7f00$i$\u53ef\u4ee5\u8f6c\u79fb\u5230\u524d\u7f00$j$\u7684\u65b9\u6cd5\u6570\uff08\u6ce8\u610f\u5b83\u53ef\u80fd\u53ef\u4ee5\u8f6c\u79fb\u5230\u5f88\u591a\u4e2a\u4e32\uff09\n\n\u8f85\u52a9\u6570\u7ec4\u7684\u751f\u6210\u53ef\u4ee5\u7528next\u6570\u7ec4\u6765\u63a8\uff08\u6a21\u677f\u4e32\u592a\u77ed\uff0c\u5176\u5b9e\u66b4\u529b\u4e5f\u662f\u53ef\u4ee5\u7684\uff09\n\n\u90a3\u4e48$dp[i+1][k]=dp[i][j]*g[j][k]\\left(j=1...m\\right)$\n\n\u7136\u540e\u518d\u770b\u8fd9\u9898\u7684\u6570\u636e\u8303\u56f4\uff1a$n\\leq 10^9$\n\nEasy\uff0c\u52a0\u4e00\u4e2a\u77e9\u9635\u5feb\u901f\u5e42\u6765\u89e3\u51b3\u4e0a\u9762\u7684\u9012\u63a8\u5c31\u884c\u4e86\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define ll long long\n#define inf 1e9\nusing namespace std;\nint MOD;\nstruct ma{//\u77e9\u9635\u7c7b\n    int n,m,a[25][25];\n    ma(){n=m=0;memset(a,0,sizeof(a));}\n    void clear(){n=m=0;memset(a,0,sizeof(a));}\n}A,B;\nvoid mul(ma &a,ma b){//\u77e9\u9635\u4e58\u6cd5\n    ma re;int i,j,k;re.n=a.n;re.m=b.m;\n    for(i=0;i<=re.n;i++){\n        for(k=0;k<=a.m;k++){\n            if(!a.a[i][k]) continue;\n            for(j=0;j<=re.m;j++){\n                re.a[i][j]=(re.a[i][j]+a.a[i][k]*b.a[k][j]%MOD)%MOD;\n            }\n        }\n    }\n    a=re;\n}\nint n,m,a[30],fail[30],f[30][10];char s[30];\nvoid qpow(ma &x,ma &y,int t){//\u5feb\u901f\u5e42\n    while(t){\n        if(t&1) mul(x,y);\n        mul(y,y);t>>=1;\n    }\n}\nint main(){\n    scanf(\"%d%d%d\",&m,&n,&MOD);\n    scanf(\"%s\",s);int i,j,k;\n    for(i=0;i<n;i++) a[i]=s[i]-'0';a[n]=inf;\n    fail[0]=fail[1]=0;j=0;\n    for(i=1;i<n;i++){//\u6c42\u51fanext\u6570\u7ec4\n        while(j&&(a[i]!=a[j])) j=fail[j];\n        j+=(a[i]==a[j]);fail[i+1]=j;\n    }\n    for(i=0;i<n;i++){//\u751f\u6210\u8f6c\u79fb\u77e9\u9635\n        for(j=0;j<10;j++){\n            k=i;while(k&&a[k]!=j) k=fail[k];\n            k+=(a[k]==j);\n            if(k<n) B.a[i][k]+=1;\n        }\n    }\n    B.m=B.n=A.m=n-1;A.n=0;A.a[0][0]=1;\n    qpow(A,B,m);\n    int ans=0;\n    for(i=0;i<n;i++) ans+=A.a[0][i],ans%=MOD;\n    printf(\"%d\",ans);\n}\n```",
        "postTime": 1524304603,
        "uid": 27753,
        "name": "Orion545",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3193 \u3010[HNOI2008]GT\u8003\u8bd5\u3011"
    },
    {
        "content": "\u524d\u7f6e\u6280\u80fd\uff1a\n\nkmp \u77e9\u9635\u4e58\u6cd5\n\n\u4e0d\u4f1a\u7684\u53ef\u4ee5\u53bb\u505a\u6a21\u677f\u9898...qwq\n\n\u8fd9\u9898\u597d\u50cf\u6ca1\u6709\u4ec0\u4e48\u90e8\u5206\u5206\u5427\uff0c\u9898\u76ee\u91cc\u597d\u50cf\u6ca1\u6709\u5199\n\n\u90a3\u6211\u5c31\u8bb2\u8bb2\u6807\u7b97\u5427\n\n100 pts\n\n\u9996\u5148\u666e\u901a\u7684dp\u72b6\u6001\u5e94\u8be5\u662ff[i][j]\u5230i\u4e3a\u5339\u914dj\u4f4d\n\n\u80af\u5b9atle\n\n\u8003\u8651\u5230m\u6bd4\u8f83\u5c0f\n\n\u6211\u4eec\u53ef\u4ee5\u5efa\u4e00\u4e2a\u77e9\u9635\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u601d\u8003\u4ece\u5339\u914di\u4f4d\u5230j\u4f4d\u7684\u53ef\u80fd\u603b\u6570\n\n\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u7528kmp\uff0c\u6c42\u4e00\u53d1nxt\u6570\u7ec4\u5373\u53ef\n\n\u5269\u4f59\u7684\u6211\u4eec\u5efa\u7acb\u4e00\u4e2a\u521d\u59cb\u77e9\u9635\uff0c\u968f\u4fbf\u8f6c\u79fb\u4e00\u4e0b\u5c31\u53ef\n\n\u6ce8\u610f\u77e9\u9635\u4e2d\u7684A[len][len]\u4e3a1\n\n\u5373\u8868\u793a\u53ea\u8981\u5339\u914d\u4e86\u4fbf\u662f\u6ee1\u8db3\u6761\u4ef6\n\n\u6700\u540e\u7edf\u8ba1\u4e0d\u662fA[len][len]\u7684\u548c\n\n\u653e\u4e0a\u6211\u4e11\u964b\u7684\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N = 25;\nstruct mat {\n\tint a[N][N];\n} a, b;\nint len, p, nxt[N];\nmat operator *(mat a, mat b) {\n\tmat c;\n\tint i, j, k;\n\tfor (i = 0; i <= len; ++i)\n\t\tfor (j = 0; j <= len; ++j) c.a[i][j] = 0;\n\tfor (i = 0; i <= len; ++i)\n\t\tfor (j = 0; j <= len; ++j)\n\t\t\tfor (k = 0; k <= len; ++k) c.a[i][j] = (c.a[i][j] + a.a[i][k] * b.a[k][j]) % p;\n\treturn c;\n}\nmat pw(mat s, mat x, int y) {\n\tmat x1 = s, x2 = x;\n\tfor (; y; y >>= 1, x2 = x2 * x2)\n\t\tif (y & 1) x1 = x1 * x2;\n\treturn x1;\n}\nint main() {\n\tint i, j, x, n, res = 0;\n\tchar s[N], c;\n\tscanf(\"%d%d%d\", &n, &len, &p);\n\tscanf(\"%s\", s + 1);\n\tfor (i = 1, j = 0; i <= len; ++i) {\n\t\twhile (j && s[i + 1] != s[j + 1]) j = nxt[j];\n\t\tif (s[i + 1] == s[j + 1]) ++j;\n\t\tnxt[i + 1] = j;\n\t}\n\tfor (i = 0; i <= len; ++i)\n\t\tfor (j = 0; j <= len; ++j) a.a[i][j] = b.a[i][j] = 0;\n\tb.a[0][1] = a.a[0][0] = 1; b.a[len][len] = 10; b.a[0][0] = 9;\n\tfor (i = 1; i < len; ++i)\n\t\tfor (c = '0'; c <= '9'; ++c) {\n\t\t\tx = i;\n\t\t\twhile (x && s[x + 1] != c) x = nxt[x];\n\t\t\tif (s[x + 1] == c) ++b.a[i][x + 1];\n\t\t\telse ++b.a[i][0];\n\t\t}\n\tmat ans = pw(a, b, n);\n\tfor (i = 0; i < len; ++i) res = (res + ans.a[0][i]) % p;\n\tprintf(\"%d\\n\", res);\n\treturn 0;\n}\n\n```",
        "postTime": 1549709446,
        "uid": 30817,
        "name": "muller",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3193 \u3010[HNOI2008]GT\u8003\u8bd5\u3011"
    },
    {
        "content": "[$\\tt\\text{My blog}$](https://ctz45562.github.io/2019/03/27/%E6%B4%9B%E8%B0%B7-P3193-HNOI2008-GT%E8%80%83%E8%AF%95/)\n\n[\u4f20\u9001\u95e8](https://www.luogu.org/problemnew/show/P3193)\n\n\u6c42\u65b9\u6848\u6570\uff0c\u663e\u7136\u8fd9\u4e2a\u9898\u5f97\u52a8\u6001\u89c4\u5212\u3002\u3002\u3002\n\n\u8bbe$f(i,j)$\u4e3a\u6bcd\u4e32\u957f\u4e3a$i$\u4f4d\uff0c\u5b50\u4e32\u5f53\u524d\u5339\u914d\u5230\u4e86\u7b2c$j$\u4f4d\u7684\u65b9\u6848\u6570\u3002\u8003\u8651$f(i,j)$\u5411$i+1$\u8f6c\u79fb\uff1a\n\n\u679a\u4e3e$i+1$\u7684\u6570\u5b57\uff0c\u7136\u540e\u5c31\u4f1a\u53d1\u73b0\u8fd9\u73a9\u610f\u53ef\u4ee5\u7528$kmp$\u8f6c\u79fb\u3002\u9884\u5904\u7406\u51fa$next$\u6570\u7ec4\u540e\uff0c\u8f6c\u79fb\u65f6\u548c\u666e\u901a\u7684$kmp$\u5339\u914d\u4e00\u6837\u8df3$next$\u6570\u7ec4\uff0c\u76f4\u5230\u5339\u914d\u5230\u6700\u957f\u524d\u7f00\u8f6c\u79fb\u8fc7\u53bb\u3002\n\n\u521d\u503c$f(0,0)=1$\uff0c\u7b54\u6848$ans=\\sum\\limits_{i=0}^{i<m}f(n,i)$\n\n\u4f2a\u4ee3\u7801\uff1a\n\n```cpp\n\tf[0][0]=1;\n\tfor(int i=0;i<n;++i)\n\t\tfor(int j=0;j<m;++j)\n\t\t\tfor(int k='0';k<='9';++k){//\u679a\u4e3e\u4e0b\u4e00\u4f4d\n\t\t\t\tint l=j;\n\t\t\t\twhile(l&&a[l+1]!=k)l=next[l];\n\t\t\t\tif(a[l+1]==k)++l;\n                //\u548ckmp\u4e00\u6837\u4ee5k\u4e3ai+1\u4f4d\u7684\u6570\u5b57\u5339\u914d\n\t\t\t\t(f[i+1][l]+=f[i][j])%=mod;\n\t\t\t}\n\tint ans=0;\n\tfor(int i=0;i<m;++i)\n\t\t(ans+=f[n][i])%=mod;\n\n```\n\n\u590d\u6742\u5ea6~~\u4e0d\u4f1a\u8bc1~~\uff0c\u53cd\u6b63\u4e0d\u4f4e\u4e8e$O(10nm)$\u3002\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316\u3002\u628a$f(i-1,0$ ~ $m-1)$\u548c$f(i,0$ ~ $m-1)$\u6254\u8fdb\u53bb\uff0c\u679a\u4e3e\u6bcf\u4e00\u4e2a$j$\u548c\u7b2c$i+1$\u4f4d\u7684\u6570\u5b57\uff0c\u5728\u77e9\u9635\u4e0a\u5bf9\u5e94\u7684\u4f4d\u7f6e$+1$\u3002\n\n\u663e\u7136$f(1,0)=9,f(1,1)=1$\uff0c\u7136\u540e\u76f4\u63a5\u77e9\u4e58\u5c31\u597d\u4e86\u3002\n\n\u77e9\u9635\u5927\u5c0f\uff1a$(2m)*(2m)$\uff0c\u590d\u6742\u5ea6$O(40^3\\log n)$\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cmath>\n#include <cstring>\n\nusing namespace std;\n\ninline int read(){\n    int x=0,y=0;\n    char ch=getchar();\n    while(ch<'0'||ch>'9'){if(ch=='-')y=1;ch=getchar();}\n    while(ch>='0'&&ch<='9')x=(x<<1)+(x<<3)+(ch^48),ch=getchar();\n    return y?-x:x;\n}\ntemplate<typename T>\ninline T read(){\n    T x=0;\n    int y=0;\n    char ch=getchar();\n    while(ch<'0'||ch>'9'){if(ch=='-')y=1;ch=getchar();}\n    while(ch>='0'&&ch<='9')x=(x<<1)+(x<<3)+(ch^48),ch=getchar();\n    return y?-x:x;\n}\nint n,m,mod;\nint next[50];\nchar a[22];\nstruct Matrix{\n    int a[50][50],l,c;\n    Matrix operator * (const Matrix x){\n        Matrix ans;\n        ans.l=l,ans.c=x.c;\n        for(register int k=0;k<c;++k)\n            for(register int i=0;i<l;++i)\n                for(register int j=0;j<x.c;++j)\n                    (ans.a[i][j]+=a[i][k]*x.a[k][j])%=mod;\n        return ans;\n    }\n    Matrix(){\n        memset(a,0,sizeof a);\n    }\n}start,origin;\n//start\u4e3a\u521d\u59cb\u77e9\u9635\uff0corigin\u4e3a\u8f6c\u79fb\u77e9\u9635\nMatrix quickpow(Matrix x,int y){\n    Matrix ans;\n    ans.l=ans.c=x.l;\n    for(register int i=0;i<ans.l;++i)\n        ans.a[i][i]=1;\n    while(y){\n        if(y&1)ans=ans*x;\n        x=x*x;\n        y>>=1;\n    }\n    return ans;\n}\nvoid kmp(){\n    int j=0;\n    for(register int i=2;i<=m;++i){\n        while(j&&a[j+1]!=a[i])j=next[j];\n        if(a[j+1]==a[i])++j;\n        next[i]=j;\n    }\n}\nvoid build(){\n    for(register int i=m,j=0;i<(m<<1);++i,++j)\n        origin.a[i][j]=1;\n    for(register int i=0;i<m;++i){\n        for(register int j='0';j<='9';++j){\n            int k=i;\n            while(k&&a[k+1]!=j)k=next[k];\n            if(a[k+1]==j)++k;\n            if(k<m)++origin.a[i+m][k+m];\n            //m=i\u3001\u4e0b\u4e00\u4f4d\u4e3aj\u65f6\u4f1a\u5bf9\u7b2ck\u4f4d\u4ea7\u751f\u5f71\u54cd\n        }\n    }\n    origin.l=origin.c=m<<1;\n    start.l=1,start.c=m<<1;\n    start.a[0][0]=start.a[0][m+1]=1,start.a[0][m]=9;\n}\nint main(){\n    n=read(),m=read(),mod=read();\t\n    scanf(\"%s\",a+1);\n    kmp();\n    build();\n    start=start*quickpow(origin,n);\n    int ans=0;\n    for(register int i=0;i<m;++i)\n        (ans+=start.a[0][i])%=mod;\n    printf(\"%d\\n\",ans);\n}\n\n\n```\n\n",
        "postTime": 1553672875,
        "uid": 111762,
        "name": "_ctz",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3193 \u3010[HNOI2008]GT\u8003\u8bd5\u3011"
    },
    {
        "content": "\u597d\u9898\u3002\u4e0d\u770b\u9898\u89e3\u4e0d\u4f1a\u5199\u9898\u7cfb\u5217\u3002 \n\n~~\u867d\u7136AC\u81ea\u52a8\u673a\u7684\u9898\u89e3\u672c\u6765\u5c31\u6ca1\u51e0\u7bc7\u6211\u8fd8\u4e00\u7bc7\u90fd\u6ca1\u770b\u61c2~~\n\n\n~~\u4e00\u5f00\u59cb\u53e3\u80e1\u7684\u5199\u6cd5\u662f\u5bf9\u7684\u4e0d\u8fc7\u56e0\u4e3a\u4e00\u4e2a\u5c0f\u7455\u75b5\u5199\u6302\u4e86~~ \n\n\u5efa\u8bae\u5148\u5199\u8fc7[\u6587\u672c\u751f\u6210\u5668](http://www.cnblogs.com/refun/p/8706911.html)\u518d\u6765\u5199\u8fd9\u4e2a\u9898\n\n\u4e0d\u7136\u8fd9\u4e2a\u9898\u89e3\u53ef\u80fd\u770b\u4e0d\u61c2\n\n\u800c\u4e14\u56e0\u4e3a\u6211\u6bd4\u8f83\u83dc\u4e0d\u4f1a\u7684\u4e1c\u897f\u592a\u591a\u6240\u4ee5\u8fd9\u4e2a\u9898\u89e3\u53ef\u80fd\u5f88\u957f\u2026\u2026\n\n \n\u8003\u8651\u66b4\u529b\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u8fd9\u4e2a\u9898\u548c\u6211\u505a\u8fc7\u7684BZOJ1030\u597d\u50cf\u51e0\u4e4e\u4e00\u6a21\u4e00\u6837\u2026\u2026\n\n\u5c31\u8fdeDP\u5f0f\u5b50\u90fd\u4e00\u6837\n\n\u53ea\u4e0d\u8fc7N\u592a\u5927\u4e86\u6ca1\u6cd5\u8f6c\u79fb\u662f\u4e48\u2026\u2026\n\n\u8d34\u4e00\u6bb5\u6587\u672c\u751f\u6210\u5668\u7684AC\u4ee3\u7801\u3002\n\n```cpp\nfor (int i=1;i<=m;++i)\n\tfor (int j=0;j<=sz;++j)\n\t\tfor (int k=0;k<26;++k)\n\t\t\tif (!End[Son[j][k]])\n\t\t\t\t(f[i][Son[j][k]]+=f[i-1][j])%=MOD;\n```\n\u6211\u4eec\u53d1\u73b0\u5916\u5c42\u7684m(\u4e5f\u5c31\u662f\u672c\u9898\u7684N)\u5faa\u73af\u7684\u65f6\u5019\uff0c\u91cc\u9762\u4e24\u4e2a\u5faa\u73af\u6bcf\u6b21\u8fdb\u884c\u7684\u8f6c\u79fb\u90fd\u662f\u673a\u68b0\u4e00\u6837\u7684\u3002\n\n\u90fd\u662f\u6839\u636e\u7236\u4eb2\u7684\u72b6\u6001\u6765\u63a8\u513f\u5b50\u7684\u72b6\u6001\u3002\n\n\u8fd9\u6837\u7684\u8bdd\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u6765\u4f18\u5316\u4e86\u3002\n\n\n\u4e3e\u4e2a\u4f8b\u5b50\n\n4 3 100\n\n111\n\n\u8fd9\u662f\u6837\u4f8b\u3002\n\n\u6211\u4eec\u5c06\u521d\u59cb\u77e9\u9635start\u5b9a\u4e49\u4e3a[1,0,0]\uff0c\u8fd9\u5bf9\u5e94\u7684\u662f\u6587\u672c\u751f\u6210\u5668\u4e00\u9898\u4e2d\u7684\u521d\u59cb\u5316f[0][0]=1; \n\n\u7136\u540e\u5c06x\u8282\u70b9\u4e0ex\u7684\u6240\u6709\u513f\u5b50\u8282\u70b9\u5728\u8f6c\u79fb\u77e9\u9635a\u4e2da[x][son]+=1\n\n\u8fd9\u6837\u5728\u77e9\u4e58\u8f6c\u79fb\u7684\u65f6\u5019\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u7236\u4eb2\u7684\u72b6\u6001\u63a8\u5230\u513f\u5b50\u4e86 \n\n\u6700\u540e\u7b54\u6848\u5373\u4e3astart*a^n\n\n\n\u56e0\u4e3a\u5f88\u5bb9\u6613\u53d1\u73b0,start\u662ff[0][]\u7684\u6240\u6709\u72b6\u6001\n\nstart*a\u662ff[1][]\u7684\u6240\u6709\u72b6\u6001\n\n\u90a3\u4e48start*a^n\u5373\u4e3af[n][]\u7684\u6240\u6709\u72b6\u6001\n\n\u5c06start*a^n\u77e9\u9635\u91cc\u7684\u6240\u6709\u6570\u503c\u52a0\u8d77\u6765\u5373\u4e3a\u6240\u6c42\u7b54\u6848\u3002\n\norz\u611f\u89c9\u81ea\u5df1\u5df2\u7ecf\u662f\u4e00\u6761\u54b8\u9c7c\u4e86\n\n\n\u5bf9\u4e86\u9001\u7ec4\u6570\u636e: \n\n1000000000 19 9973\n\n1010100110011000001 \n\n5753\n\n\u4ee3\u7801\u6233\u2192[\u849f\u84bb\u7684\u535a\u5ba2](http://www.cnblogs.com/refun/p/8710926.html)",
        "postTime": 1522758446,
        "uid": 41890,
        "name": "Refun",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3193 \u3010[HNOI2008]GT\u8003\u8bd5\u3011"
    },
    {
        "content": "\u9996\u5148n=1e9\uff0cm=20\uff0c\u57fa\u672c\u53ef\u4ee5\u786e\u5b9a\u8fd9\u662f\u4e00\u5230\u77e9\u9635\u4e58\u6cd5\u7684\u9898\u3002\n\n\u6240\u4ee5\u6211\u4eec\u6309\u7167\u5957\u8def\uff0c\u8003\u8651f[i][j]=f[i][k]*g[k][j](0<=k<m),f\u6570\u7ec4\u8868\u793a\u9009\u4e86i\u4e2a\u6570\uff0c\u672b\u5c3e\u5b57\u7b26\u4e32\u5339\u914d\u5b57\u7b26\u4e32a\u524d\u7f00k\u4f4d\uff0cg\u6570\u7ec4\u8868\u793a\u4ece\u5339\u914dk\u4f4d\u5230\u5339\u914dj\u4f4d\u7684\u65b9\u6cd5\u79cd\u6570\u3002\n\n\u7b54\u6848\u5c31\u662ff[n][k] \uff080<=k<m\uff09\n\n\u6839\u636ef\u6570\u7ec4\u7684\u5b9a\u4e49\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u60f3\u5230\u7528kmp\u9884\u5904\u7406\u51fanext\u6570\u7ec4\u3002\n\n\u8003\u8651\u5904\u7406g\u6570\u7ec4\uff0c\u5047\u8bbe\u5f53\u524d\u5df2\u7ecf\u5339\u914d\u4e86i\u4f4d\uff0c\u6211\u4eec\u679a\u4e3e\u7b2ci+1\u4f4d\u9009\u4e86\u54ea\u4e2a\u6570\u5b57\uff0c\u5904\u7406\u51fa\u5728\u9009\u4e86\u8fd9\u4e2a\u6570\u5b57\u7684\u60c5\u51b5\u4e0b\u80fd\u4e0e\u524d\u7f00\u5339\u914d\u51e0\u4f4d\u3002\n\n\u6ce8\u610ff[i][i]\u521d\u59cb\u65f6\u90fd\u4e3a1\u3002\n\n\u7136\u540e\u52a0\u4e2a\u77e9\u9635\u4f18\u5316\u5c31\u884c\u4e86\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n#include<string>\n#include<queue>\nusing namespace std;\ntypedef long long ll;\nconst ll N=25;\nll n,m,mod,ans,next[N],f[N][N],b[N][N];char s[N];\ninline ll read(){\n\tll x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=(x<<1)+(x<<3)+ch-'0';ch=getchar();}\n\treturn x*f;\n}\ninline void mul(ll a[25][25],ll b[25][25]){\n\tll c[25][25];\n\tmemset(c,0,sizeof(c));\n\tfor(ll i=0;i<m;i++){\n\t\tfor(ll j=0;j<m;j++){\n\t\t\tfor(ll k=0;k<m;k++){\n\t\t\t\tc[i][j]=(c[i][j]+a[i][k]*b[k][j])%mod;\n\t\t\t}\n\t\t}\n\t}\n\tmemcpy(a,c,sizeof(c));\n}\nint main(){\n\tn=read();m=read();mod=read();\n\tscanf(\"%s\",s+1);\n\tnext[1]=0;\n\tfor(ll i=2,j=0;i<=m;i++){\n\t\twhile(j&&s[j+1]!=s[i]) j=next[j];\n\t\tif(s[j+1]==s[i]) j++;\n\t\tnext[i]=j; \n\t}\n\tfor(ll i=0;i<m;i++){\n\t\tfor(ll j='0';j<='9';j++){\n\t\t\tll p=i;\n\t\t\twhile(p&&s[p+1]!=j) p=next[p];\n\t\t\tif(s[p+1]==j) p++;\n\t\t\tif(p!=m) b[i][p]=(b[i][p]+1)%mod;\n\t\t}\n\t}\n\tfor(ll i=0;i<m;i++) f[i][i]=1;\n\tfor(ll i=n;i;i>>=1,mul(b,b)){\n\t\tif(i&1) mul(f,b);\n\t}\n\tfor(ll i=0;i<m;i++) ans=(ans+f[0][i])%mod;\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1544836631,
        "uid": 53032,
        "name": "\u5c0f\u5858\u7a7a\u660e",
        "ccfLevel": 0,
        "title": "P3193 [HNOI2008]GT\u8003\u8bd5"
    },
    {
        "content": "\u4ee4f[i][j]\u8868\u793a\u539f\u4e32\u7b2ci\u4f4d\u5339\u914d\u4e86\u4e0d\u5409\u5229\u6570\u5217(unlu[])\u7b2cj\u4f4d\u7684\u65b9\u6848\u6570\n\n\u5219\u5bf9\u4e8e\u539f\u4e32\u4e2d\u6bcf\u4e00\u4e2af[i][j]\uff0c\u7528\u5b83\u66f4\u65b0\u6240\u6709\u540e\u63a50-9\u6570\u5b57\u5e94\u8be5\u8f6c\u79fb\u5230\u7684\u6240\u6709f[i+1][k]\n\n\u540e\u63a5\u6570\u5b57\u8981\u4e48\u7b49\u4e8eunlu[j+1]\uff0c\u90a3\u4e48k\u4e3aj+1\n\n\u8981\u4e48\u627e\u5230\u524d\u9762\u4e0e\u5176\u5339\u914d\u7684\u4f4d\u7f6ek\n\n\n\u7136\u540e\u7528kmp\u4e0e\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316\u5373\u53ef\n\n\n\u4ee3\u7801\n'''\n\n\n\n\n\n\n\n\n\n\n\n\n```cpp\n//miaomiao 2017.2.12\n#include<cstdio>\n#include<cstring>\nusing namespace std;\n#define Set(a, v) memset(a, v, sizeof(a))\n#define For(i, a, b) for(int i = (a); i <= (int)(b); i++)\n#define M (20+5)\nint n, rm, P, unlu[M], f[M];\nstruct Matrix{\n    int m[M][M];\n    Matrix(int x=0){\n        Set(m, 0); if(!x) return;\n        For(i, 0, rm) m[i][i] = 1;\n    }\n    Matrix operator *(const Matrix &rhs)const{\n        Matrix ret;\n        For(k, 0, rm-1) For(i, 0, rm-1) if(m[i][k]) For(j, 0, rm-1)\n            ret.m[i][j] = (ret.m[i][j]+m[i][k]*rhs.m[k][j]%P)%P;\n        return ret;\n    }\n    Matrix operator ^(int num){\n        Matrix ret(1), a = *this;\n        while(num){\n            if(num&1) ret = ret*a;\n            a = a*a; num >>= 1;\n        }\n        return ret;\n    }\n}base;\nint to[M][10];\ninline void getfail(){\n    For(i, 1, rm-1){\n        int j = f[i];\n        while(j && unlu[i+1]!=unlu[j+1]) j=f[j];\n        f[i+1] = unlu[i+1]==unlu[j+1]? j+1: 0;\n    }    \n    For(i, 0, rm-1) For(j, 0, 9){\n        to[i][j] = unlu[i+1]==j? i+1: to[f[i]][j];\n        base.m[i][to[i][j]]++;\n    }\n}\nint main(){\n    scanf(\"%d%d%d\", &n, &rm, &P);\n    For(i, 1, rm) scanf(\"%1d\", &unlu[i]);\n    getfail();\n    Matrix a; a.m[0][0] = 1;\n    a = a*(base^n);\n    int sum = 0;\n    For(i, 0, rm-1) sum += a.m[0][i];\n    printf(\"%d\\n\", sum%P);\n    return 0;\n}\n'''\n```",
        "postTime": 1486915489,
        "uid": 8925,
        "name": "miaowey",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3193 \u3010[HNOI2008]GT\u8003\u8bd5\u3011"
    },
    {
        "content": "## \u9898\u76ee\u603b\u7ed3\n\n\u6c42N\u4f4d\u6570\uff08\u53ef\u4ee5\u4ee50\u5f00\u5934\uff09\u4e2d\u4e0d\u5305\u542b\u6570\u5b57\u4e32M\u7684\u4e2a\u6570\uff1b\n\n## \u6570\u636e\u8303\u56f4\n\n$N\u226410^9,M\u226420,K\u22641000$\n\n## \u89e3\u9898\u601d\u8def\n\nKMP+DP\uff1b\n\n\u5f88\u5bb9\u6613\u53d1\u73b0\u6b64\u9898\u53ef\u4ee5\u7528DP\u6765\u5199\uff1b\n\n$f[i][j]$ \u8868\u793a\u7b2ci\u4f4d\u6570\u5b57\uff0c\u5339\u914d\u957f\u5ea6\u4e3aj\u7684\u6570\u91cf\uff1b\n\n![](https://cdn.luogu.com.cn/upload/pic/20141.png)\n\n\u4f46\u662fN\u8f83\u5927\uff0c\u8003\u8651\u4f18\u5316\uff1b\n\n\u56e0\u4e3a\u6bcf\u6b21\u4e58\u6570\u76f8\u540c\uff0c\u5e76\u4e14\u8fd9\u4e2a\u8f6c\u79fb\u5341\u5206\u50cf\u77e9\u9635\uff0c\u8003\u8651\u77e9\u9635\u5feb\u901f\u5e42\uff1b\n\n\u521d\u59cb\u77e9\u9635\u4e3a $f[0][0]=0$\uff1b\n\n\u4e58\u77e9\u9635G\u53ef\u901a\u8fc7KMP\u7edf\u8ba1\uff1b\u5bf9\u4e8e\u6bcf\u4e00\u4f4di\uff0c\u679a\u4e3e\u4e0b\u4e00\u4f4d\u6570\u5b57\uff0c\u901a\u8fc7KMP\u52a0\u901f\u5339\u914d\uff0c\u627e\u5230\u8854\u63a5\u8fd9\u4f4d\u6570\u5b57\u540e\u7684\u5339\u914d\u6570\uff0c++\uff1b\n\n\u7531\u4e8e\u521d\u59cb\u77e9\u9635\u5f88\u7279\u6b8a\uff0c\u6240\u4ee5\u4e0d\u7528\u4e58\u5b83\uff0c\u53ea\u9700\u5c06\u5feb\u901f\u5e42\u540e\u7684G\u77e9\u9635\u7b2c0\u884c\u52a0\u8d77\u6765\u5373\u53ef\uff08\u81ea\u5df1\u624b\u7b97\u89c4\u5f8b\uff09\n\n## \u6613\u9519\u8bef\u533a\n\n**\u4e00\u5b9a\u4e0d\u8981\u5199\u9519KMP\uff01\uff01\uff01**\n```cpp\nnxt[0] = -1;\n    for (ri i = 1, j; i <= m; i++) {\n        j = nxt[i - 1];\n        while (j != -1 && s[j + 1] != s[i]) j = nxt[j];\n        nxt[i] = j + 1;\n    }\n    nxt[0] = 0;\n```\n\n## \u4ee3\u7801\u5c55\u793a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cmath>\n#include<cstring>\n#include<string>\n#include<algorithm>\n#include<vector>\n#include<map>\n#include<set>\n#include<list>\n#include<queue>\n#include<stack>\n#include<bitset>\n#include<deque>\nusing namespace std;\n#define ll long long\n#define inf 0x3f3f3f3f\n#define ri register int\n#define il inline\n#define fi first\n#define se second\n#define mp make_pair\n#define pi pair<int,int>\n#define mem0(x) memset((x),0,sizeof (x))\n#define mem1(x) memset((x),0x3f,sizeof (x))\nil char gc() {\n    static const int BS = 1 << 22;\n    static unsigned char buf[BS], *st, *ed;\n    if (st == ed) ed = buf + fread(st = buf, 1, BS, stdin);\n    return st == ed ? EOF : *st++;\n}\n#define gc getchar\ntemplate<class T>void in(T &x)\n{\n    x = 0; bool f = 0; char c = gc();\n    while (c < '0' || c > '9') {if (c == '-') f = 1; c = gc();}\n    while ('0' <= c && c <= '9') {x = (x << 3) + (x << 1) + (c ^ 48); c = gc();}\n    if (f) x = -x;\n}\n#undef gc\nvoid out(int x) {\n    if (x < 0) putchar('-'), x = -x;\n    if (x > 9) out(x / 10);\n    putchar(x % 10 + '0');\n}\n#define N 25\n#define M 1\nint n, m, md;\nchar s[N];\nint ls, nxt[N];\nstruct Mat {\n    int p[N][N];\n    Mat() {mem0(p);}\n};\nvoid mul(Mat &a, Mat &b) {\n    Mat ret;\n    for (ri i = 0; i < m; i++) {\n        for (ri k = 0; k < m; k++) {\n            if (!a.p[i][k]) continue;\n            for (ri j = 0; j < m; j++) {\n                (ret.p[i][j] += a.p[i][k] * b.p[k][j] % md) %= md;\n            }\n        }\n    }\n    a = ret;\n}\nvoid qpow(Mat &a, int p) {\n    Mat ret = a; p--;\n    for (; p; p >>= 1, mul(a, a)) if (p & 1) mul(ret, a);\n    a = ret;\n}\nint ans;\nMat g;\nsigned main() {\n    in(n), in(m), in(md);\n    scanf(\"%s\", s + 1);\n    nxt[0] = -1;\n    for (ri i = 1, j; i <= m; i++) {\n        j = nxt[i - 1];\n        while (j != -1 && s[j + 1] != s[i]) j = nxt[j];\n        nxt[i] = j + 1;\n    }\n    nxt[0] = 0;\n    for (ri i = 0, t; i < m; i++) {\n        for (ri j = '0'; j <= '9'; j++) {\n            t = i;\n            while (t && s[t + 1] != j) t = nxt[t];\n            if (s[t + 1] == j) t++;\n            g.p[i][t]++;\n        }\n    }\n    qpow(g, n);\n    for (ri i = 0; i < m; i++) (ans += g.p[0][i]) %= md;\n    printf(\"%d\\n\", ans);\n    return 0;\n}\n```",
        "postTime": 1527436152,
        "uid": 58302,
        "name": "i207M",
        "ccfLevel": 0,
        "title": "\u89e3\u9898\u62a5\u544a-P3193-GT\u8003\u8bd5"
    }
]
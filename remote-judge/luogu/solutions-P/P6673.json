[
    {
        "content": "~~\u5176\u5b9e\u662f\u633a\u65e0\u804a\u7684\u4e00\u4e2a\u677f\u5b50\u9898\uff0c\u6211\u4e0d\u4f1a\u505a\u771f\u7684\u662f\u8d25\u7b14\u3002~~\n\n------------\n\u6784\u9020\u6570\u5217 $g$\uff0c\u82e5 $i$ \u7684\u4e09\u8fdb\u5236\u8868\u793a\u4e2d\u6709 $x$ \u4e2a $1$ \u548c $y$ \u4e2a $2$\uff0c\u5219 $g_i=b_{x,y}$\u3002\u90a3\u4e48\u5bb9\u6613\u53d1\u73b0 $f_i$ \u5373\u4e3a $f_{i-1}$ \u4e0e $g$ \u7684\u9ad8\u7ef4\u5faa\u73af\u5377\u79ef\uff0c\u6bcf\u4e00\u7ef4\u957f\u5ea6\u4e3a $3$\uff08$3$ \u8fdb\u5236\u4e0d\u8fdb\u4f4d\u52a0\u6cd5\u5377\u79ef\uff09\u3002\n\n\u663e\u7136\u6211\u4eec\u5bf9\u5b83\u8fdb\u884c\u4e09\u8fdb\u5236\u7684 FWT\uff0c\u5373\u9ad8\u7ef4 FFT\u3002FFT \u7684\u610f\u4e49\u662f\u591a\u9879\u5f0f\u5728\u5355\u4f4d\u6839\u5904\u7684\u53d6\u503c\uff0c\u4f46\u662f\u6211\u4eec\u4e0d\u65b9\u4fbf\u6c42\u4e09\u6b21\u5355\u4f4d\u6839\u3002\n\n\u4f5c\u4e3a\u4e00\u4e2a\u719f\u7ec3\u7684\u9009\u624b\u7acb\u5373\u60f3\u5230\u6269\u57df\u3002\u5c06\u6bcf\u4e2a\u590d\u6570\u8868\u793a\u4e3a $a\\omega_3+b$ \u7684\u5f62\u5f0f\uff08\u800c\u975e $ai+b$\uff09\uff0c\u90a3\u4e48\u6839\u636e $\\omega_3^3=1$ \u4e14 $\\omega_3\\ne1$\uff0c$\\omega_3^2+\\omega_3+1=0$ \u53ef\u4ee5\u5b9a\u4e49\u4e58\u6cd5\u3002\n\nIFWT \u7684\u5f0f\u5b50\u53ef\u4ee5\u624b\u89e3\u4e00\u4e0b\u4e09\u5143\u4e00\u6b21\u65b9\u7a0b\u3002\u4f46\u662f\u6211\u4eec\u8fd8\u9700\u8981\u8bc1\u660e $3$ \u6709\u9006\u5143\uff0c\u8fd9\u662f\u5bb9\u6613\u7684\uff1a\u82e5 $3\\mid p$ \u6709 $x=y=\\dfrac23p$ \u6ee1\u8db3 $\\dfrac1x+\\dfrac1y=\\dfrac3p$\u3002\n\nFWT \u662f\u7ebf\u6027\u53d8\u6362\uff0c\u6240\u4ee5\u76f4\u63a5 FWT \u8fc7\u53bb\u4e4b\u540e\u5feb\u901f\u5e42\u4e00\u4e0b\u518d IFWT \u56de\u6765\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(3^m(m+\\log))$\uff0c\u8f7b\u5fae\u5361\u5e38\u3002\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ninline ll readint(){\n\tll x=0;\n\tbool f=0;\n\tchar c=getchar();\n\twhile(!isdigit(c)&&c!='-') c=getchar();\n\tif(c=='-'){\n\t\tf=1;\n\t\tc=getchar();\n\t}\n\twhile(isdigit(c)){\n\t\tx=x*10+c-'0';\n\t\tc=getchar();\n\t}\n\treturn f?-x:x;\n}\nconst int maxn=5.4e5,maxm=12+5;\nint m,n=1,t,p,b[maxm][maxm],phip;\nstruct cp{\n\tint a,b;\n\tcp operator +(cp x){\n\t\treturn {(a+x.a)%p,(b+x.b)%p};\n\t}\n\tcp operator *(cp x){\n\t\treturn {(int)((1ll*a*x.b%p+1ll*b*x.a%p-1ll*a*x.a%p+p)%p),(int)((1ll*b*x.b%p-1ll*a*x.a%p+p)%p)};\n\t}\n\tcp operator *(ll x){\n\t\treturn {(int)(1ll*a*x%p),(int)(1ll*b*x%p)};\n\t}\n}f[maxn],g[maxn];\ncp ksm(cp a,int b){\n\tcp ans={0,1};\n\twhile(b){\n\t\tif(b%2==1) ans=ans*a;\n\t\ta=a*a;\n\t\tb/=2;\n\t}\n\treturn ans;\n}\nint phi(int n){\n\tint res=n;\n\tfor(int i=2;i*i<=n;i++) if(n%i==0){\n\t\tres=1ll*res*(i-1)/i;\n\t\twhile(n%i==0) n/=i;\n\t}\n\tif(n>1) res=1ll*res*(n-1)/n;\n\treturn res;\n}\nint ksm(int a,int b){\n\tint ans=1;\n\twhile(b){\n\t\tif(b%2==1) ans=1ll*ans*a%p;\n\t\ta=1ll*a*a%p;\n\t\tb/=2;\n\t}\n\treturn ans;\n}\nvoid FWT(cp* f,int n,bool flag){\n\tfor(int i=1;i<n;i*=3) for(int j=0;j<n;j+=i*3) for(int k=j;k<j+i;k++){\n\t\tcp t0=f[k],t1=f[k+i],t2=f[k+i*2];\n\t\tif(flag){\n\t\t\tf[k]=t0+t1+t2;\n\t\t\tf[k+i]=t0+t1*(cp){1,0}+t2*(cp){p-1,p-1};\n\t\t\tf[k+i*2]=t0+t1*(cp){p-1,p-1}+t2*(cp){1,0};\n\t\t}\n\t\telse{\n\t\t\tf[k]=t0+t1+t2;\n\t\t\tf[k+i]=t0+t1*(cp){p-1,p-1}+t2*(cp){1,0};\n\t\t\tf[k+i*2]=t0+t1*(cp){1,0}+t2*(cp){p-1,p-1};\n\t\t}\n\t}\n\tif(!flag){\n\t\tint invn=ksm(n,phip-1);\n\t\tfor(int i=0;i<n;i++) f[i]=f[i]*invn;\n\t}\n}\nint main(){\n\t#ifdef LOCAL\n\tfreopen(\"in.txt\",\"r\",stdin);\n\tfreopen(\"out.txt\",\"w\",stdout);\n\t#endif\n\tm=readint();\n\tfor(int i=0;i<m;i++) n*=3;\n\tt=readint();\n\tp=readint();\n\tfor(int i=0;i<n;i++) f[i].b=readint();\n\tfor(int i=0;i<=m;i++) for(int j=0;j<=m-i;j++) b[i][j]=readint();\n\tfor(int i=0;i<n;i++){\n\t\tint x=i,cnt1=0,cnt2=0;\n\t\tfor(int j=0;j<m;j++){\n\t\t\tif(x%3==1) cnt1++;\n\t\t\telse if(x%3==2) cnt2++;\n\t\t\tx/=3;\n\t\t}\n\t\tg[i].b=b[cnt1][cnt2];\n\t}\n\tphip=phi(p);\n\tFWT(f,n,1);\n\tFWT(g,n,1);\n\tfor(int i=0;i<n;i++) f[i]=f[i]*ksm(g[i],t);\n\tFWT(f,n,0);\n\tfor(int i=0;i<n;i++) printf(\"%d\\n\",f[i].b);\n\t#ifdef LOCAL\n\tfprintf(stderr,\"%f\\n\",1.0*clock()/CLOCKS_PER_SEC);\n\t#endif\n\treturn 0;\n}\n```",
        "postTime": 1640314439,
        "uid": 174045,
        "name": "FZzzz",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6673 \u3010[\u6e05\u534e\u96c6\u8bad2016] \u77f3\u5bb6\u5e84\u7684\u5de5\u4eba\u9636\u7ea7\u961f\u4f0d\u6bd4\u8f83\u575a\u5f3a\u3011"
    },
    {
        "content": "\u77f3\u5934\u526a\u5200\u5e03\uff0c\u5b9e\u8d28\u662f\u4e09\u8fdb\u5236\u8ba1\u7b97\u3002\u672c\u9898\u8003\u8651\u4f7f\u7528\u4e09\u8fdb\u5236\u5f02\u6216\u3002\n\n\u6211\u4eec\u4e0d\u59a8\u5047\u8bbe\u526a\u5200\u77f3\u5934\u5e03\u64cd\u4f5c\u5206\u522b\u5bf9\u5e94 $0$\uff0c$1$\uff0c$2$\uff08\u5373\u4e3a\u4e09\u8fdb\u5236\uff09\uff0c\u90a3\u4e48\u4e24\u4f4d\u9009\u624b\u7684\u64cd\u4f5c\u7684\u4e09\u8fdb\u5236\u4e0d\u9000\u4f4d\u51cf\u6cd5\u7684\u7ed3\u679c\u5219\u5206\u522b\u5bf9\u5e94\u5e73\u5c40\u3001\u8d62\u3001\u8f93\u3002\n\n\u4e0d\u96be\u53d1\u73b0\uff1a\n\n$$\n\\newcommand{\\tab}{\\ \\ \\ \\ \\ }\n\\begin{aligned}\n0 \\ominus 0 = 0 \\tab 0 \\ominus 1 = 2 \\tab 0 \\ominus 2 = 1 \\\\\n1 \\ominus 0 = 1 \\tab 1 \\ominus 1 = 0 \\tab 1 \\ominus 2 = 2 \\\\\n2 \\ominus 0 = 2 \\tab 2 \\ominus 1 = 1 \\tab 2 \\ominus 2 = 0 \\\\\n\\end{aligned}\n$$\n\n\u663e\u7136\u5e94\u5f53\u5148\u53ef\u4ee5\u5904\u7406\u51fa\u6765\u4e00\u4e2a\u5e8f\u5217 $B$ \u6ee1\u8db3 $B_i = b (\\operatorname{popcount_1(i)}, \\operatorname{popcount_2(i)})$\u3002\u7136\u540e\u548c $f_0$ \u505a $t$ \u6b21 $3$ \u8fdb\u5236\u5f02\u6216\u5377\u79ef\u5373\u53ef\u3002\n\n\u9700\u8981\u7279\u522b\u6ce8\u610f\u7684\u662f\uff0c$\\omega_3$ \u53ef\u80fd\u5728\u6a21 $p$ \u610f\u4e49\u4e0b\u6ca1\u6709\u5bf9\u5e94\u7684\u6574\u6570\uff0c\u53ef\u4ee5\u8003\u8651\u62ff\u4e2a\u591a\u9879\u5f0f\u6765\u5b58\u3002\n\n\u4ee3\u7801\u8bf7\u8bfb\u8005\u81ea\u884c\u5b9e\u73b0\uff08\u96fe\uff09\u3002",
        "postTime": 1597020308,
        "uid": 349885,
        "name": "HECZ",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6673 \u3010[\u6e05\u534e\u96c6\u8bad2016] \u77f3\u5bb6\u5e84\u7684\u5de5\u4eba\u9636\u7ea7\u961f\u4f0d\u6bd4\u8f83\u575a\u5f3a\u3011"
    },
    {
        "content": "## \u3010\u6e05\u534e\u96c6\u8bad\u3011\u77f3\u5bb6\u5e84\u7684\u5de5\u4eba\u9636\u7ea7\u961f\u4f0d\u6bd4\u8f83\u575a\u5f3a\n\n\u7ed9\u5b9a $m$\uff0c\u7136\u540e\u4ee4 $n=3^m$\uff0c\u7ed9\u5b9a\u6570\u7ec4 $f_{0,0},f_{0,1}...f_{0,3^m-1}$\n\n\u7ed9\u5b9a\u6570\u7ec4 $b$\uff0c\u7136\u540e\u5b9a\u4e49\u5377\u79ef\uff1a\n\n$$f_{k,x}=\\sum_{y}f_{k-1,y}b_{u,v}$$\n\n\u5176\u4e2d $u$ \u5b9a\u4e49\u4e3a $W(x,y)$\uff0c$v$ \u5b9a\u4e49\u4e3a $L(x,y)$\n\n\u5176\u4e2d $W(x,y)$ \u88ab\u5b9a\u4e49\u4e3a\u5c06\u4e09\u8fdb\u5236\u7684\u6bcf\u4e00\u4f4d\u8fdb\u884c\u6bd4\u8f83\uff0c\u51fa\u73b0\u4e00\u7ec4 ```10/21/02``` \u5c31\u7d2f\u52a0\u4e00\u6b21\u8d21\u732e\uff0c$L(x,y)$ \u5b9a\u4e49\u4e3a $W(y,x)$\n\n\u4f60\u9700\u8981\u8ba1\u7b97 $f_{t}$\uff0c$t$ \u7ed9\u5b9a\u3002\n\n\u7b54\u6848\u5bf9 $p$ \u53d6\u6a21\uff0c\u4fdd\u8bc1\u4e0d\u5b58\u5728 $x,y$ \u6ee1\u8db3 $\\frac{1}{x}+\\frac{1}{y}=\\frac{3}{p}$\n\n$m\\le 12,t\\le 10^9,p\\le 10^9$\n\n### Solution\n\n\u53c8\u6765\u6c34\u9898\u89e3\u4e86\u3002\n\n\u8003\u8651\u4e09\u8fdb\u5236\u4e0d\u9000\u4f4d\u51cf\u6cd5\uff1a\n\n$$\\begin{matrix}\n    0\\oplus 0=0&0\\oplus 1=2&0\\oplus 2=1\n    \\\\1\\oplus 1=0&1\\oplus 2=2&1\\oplus 0=1\n    \\\\2\\oplus 2=0&2\\oplus 0=2&2\\oplus 1=1\n\\end{matrix}$$\n\n\u6211\u4eec\u53d1\u73b0\u7ed3\u679c\u4e3a $1$ \u7b49\u4ef7\u4e8e win\uff0c\u7ed3\u679c\u4e3a $2$ \u7b49\u4ef7\u4e8e lose\n\n\u8bbe $bit_k(x)$ \u8868\u793a $x$ \u4e2d\u7684 $k$ \u7684\u6570\u91cf\u3002\n\n\u90a3\u4e48\u6211\u4eec\u6709\u8f6c\u79fb\u5f62\u5982\uff1a\n\n$$f_{k,x}=\\sum_y f_{k-1,y}b_{bit_1(x\\oplus y),bit_2(x\\oplus y)}$$\n\n\u4e0d\u96be\u53d1\u73b0\u8d21\u732e\u5b9e\u9645\u4e0a\u53ea\u548c $x\\oplus y$ \u76f8\u5173\u3002\n\n\u8bbe $\\odot$ \u8868\u793a\u4e09\u8fdb\u5236\u4e0d\u8fdb\u4f4d\u52a0\u6cd5\uff0c\u90a3\u4e48\u4e0d\u96be\u53d1\u73b0\uff1a\n\n$$f_{k,x}=\\sum_{y\\odot z=x} f_{k-1,y}b_{z}$$\n\n\u4e8e\u662f\u76f8\u5f53\u4e8e\u8ba1\u7b97 3 \u8fdb\u5236\u4e0b\u5f02\u6216\u5377\u79ef\u7684 $k$ \u6b21\u5e42\u3002\n\n\u6211\u4eec\u641e\u51fa FWT \u7684\u70b9\u503c\u5373\u53ef\u5904\u7406\u4e86\u3002\n\n\u6ce8\u610f\u5230 $k$ \u8fdb\u5236 FWT \u76f8\u5f53\u4e8e\u5728\u505a\u5faa\u73af\u5377\u79ef\uff0c\u8fd9\u6837\u6211\u4eec\u53ea\u9700\u8981\u5c06\u7ed9 $k$ \u8fdb\u5236\u5355\u4f4d\u6839\u4ee3\u5165\u8fdb\u53bb\u5373\u53ef\u3002\n\n\u5177\u4f53\u5f0f\u5b50\uff1a\n\n$$FWT(i)=\\sum_{j=0} c(i,j)A_j$$\n\n$$FWT(i)=\\sum_{j=0}^{k-1} c(i_{\\mathbf{M}},j)\\sum c(i',j')A_{j'+j\\times k^{\\mathbf{M}}}$$\n\n$$FWT(i)=\\sum_{j=0}^{k-1} \\omega_{k}^{i_{\\mathbf{M}}j}\\sum c(i',j')A_{j'+j\\times k^{\\mathbf{M}}}$$\n\n\u8fd9\u6837\u9012\u5f52\u5373\u53ef\uff0c\u7531\u4e8e\u53ea\u9700\u8981\u4e58\u4ee5\u5355\u9879\u5f0f\uff0c\u6240\u4ee5\u590d\u6742\u5ea6\u662f $\\mathcal O(k^{m+3})$ \u7684\u3002\n\n\u7531\u4e8e\u8981\u6b21\u5e42\u4e00\u4e0b\uff0c\u4f1a\u6389\u7cbe\u5ea6\uff0c\u6240\u4ee5\u53ea\u80fd\u6269\u57df\uff0c\u6211\u4eec\u627e\u4e00\u4e2a\u4ee3\u6570\u5355\u4f4d\u6765\u8868\u793a $\\omega_3$ \n\n\u6839\u636e\u5355\u4f4d\u6839\u7684\u6027\u8d28\uff0c\u6211\u4eec\u6ce8\u610f\u5230 $\\omega_3^2+\\omega_3+1=0$\uff0c\u8fd9\u6837\u7684\u8bdd\u5c31\u6709 $\\omega_3^2=-\\omega_3-1$\n\n\u8fd9\u6837\u6211\u4eec\u5148\u76f8\u5f53\u4e8e\u62ff\u7740 $ax^2+bx+c$ \u7c7b\u578b\u7684\u591a\u9879\u5f0f\u5728\u6a21(?)\u4e0a\u505a\u8fd0\u7b97\uff0c\u6700\u540e\u6211\u4eec\u518d\u628a $a$ \u8868\u793a\u6210 $b,c$ \u76f8\u5173\u6d88\u4e00\u6d88\u3002\n\n- \u5751\uff1a\u8fd9\u4e2a\u6a21\u6570\u4fdd\u8bc1\u4e86 $3$ \u5b58\u5728\u9006\u5143\uff0c\u4f46\u662f\u4e0d\u80fd\u76f4\u63a5\u5957\u8d28\u6570\u60c5\u51b5\u7684\u6c42\u6cd5...\n\n\u7136\u540e\u53d1\u73b0\u8fd9\u4e2a\u9898\u5361\u8fd9\u4e2a\u505a\u6cd5\uff0c\u7136\u540e\u4f60\u4f1a\u53d1\u73b0\u6ca1\u5fc5\u8981 FWT \u7684\u65f6\u5019\u53d6\u6a21\uff0c\u6240\u4ee5\u53ef\u4ee5\u6700\u540e\u53d6\u6a21\u3002\n\n\u7136\u540e\u624b\u52a8\u5faa\u73af\u5c55\u5f00\u4e00\u4e0b\uff0c\u5c31\u53ef\u4ee5\u8fc7\u4e86\u3002\u6700\u540e\u653e\u4e00\u4e0b\u6bd4\u8f83\u4e11\u7684\u4ee3\u7801\n\n$Code:$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std ;\n#define Next( i, x ) for( register int i = head[x]; i; i = e[i].next )\n#define rep( i, s, t ) for( register int i = (s); i <= (t); ++ i )\n#define drep( i, s, t ) for( register int i = (t); i >= (s); -- i )\n#define re register\n#define int long long\nint gi() {\n\tchar cc = getchar() ; int cn = 0, flus = 1 ;\n\twhile( cc < '0' || cc > '9' ) {  if( cc == '-' ) flus = - flus ; cc = getchar() ; }\n\twhile( cc >= '0' && cc <= '9' )  cn = cn * 10 + cc - '0', cc = getchar() ;\n\treturn cn * flus ;\n}\nconst int N = 1e6 + 5 ; \nconst int M = 20 + 5 ; \nint lim, m, t, P, b[M][M] ; \nstruct gf {\n\tint a[3] ; \n\tvoid init() { a[0] = a[1] = a[2] = 0 ; }\n} f[N], g[N], Nx[N] ;\nint fpow(int x, int k) {\n\tint ans = 1, base = x ;\n\twhile(k) {\n\t\tif(k & 1) ans = 1ll * ans * base % P ;\n\t\tbase = 1ll * base * base % P, k >>= 1 ;\n\t} return ans ;\n}\nvoid inc(int &x, int y) { (x += y) ; }\nint bit1(int x) { int ans = 0 ; while( x ) ans += (x % 3 == 1), x /= 3 ; return ans ; }\nint bit2(int x) { int ans = 0 ; while( x ) ans += (x % 3 == 2), x /= 3 ; return ans ; }\ngf Move(gf x, int l) {\n\tgf ans ; ans.init() ; \n\tans.a[(0 + l) % 3] = x.a[0], ans.a[(1 + l) % 3] = x.a[1], ans.a[(2 + l) % 3] = x.a[2] ;\n\treturn ans ; \n}\ngf operator * (gf x, gf y) {\n\tgf ans ; ans.init() ; \n\tans.a[0] = ( x.a[0] * y.a[0] + x.a[1] * y.a[2] + x.a[2] * y.a[1] ) % P ; \n\tans.a[1] = ( x.a[0] * y.a[1] + x.a[1] * y.a[0] + x.a[2] * y.a[2] ) % P ; \n\tans.a[2] = ( x.a[0] * y.a[2] + x.a[1] * y.a[1] + x.a[2] * y.a[0] ) % P ; \n\treturn ans ; \n}\ngf operator * (gf x, int y) { gf ans ; rep(i, 0, 2) ans.a[i] = x.a[i] * y % P ; return ans ; }\ngf operator + (gf x, gf y) { gf ans ; rep(i, 0, 2) ans.a[i] = (x.a[i] + y.a[i]) ; return ans ; }\ngf fpow(gf x, int k) {\n\tgf ans, base = x ; ans.init(), ans.a[0] = 1 ; \n\twhile(k) {\n\t\tif(k & 1) ans = ans * base ;\n\t\tbase = base * base, k >>= 1 ; \n\t} return ans ; \n}\ngf operator % (gf x, int p) { rep( i, 0, 2 ) x.a[i] %= p ; return x ; }\nvoid FWT(gf *a) {\n\tfor(re int k = 1; k < lim; k *= 3 ) for(re int i = 0; i < lim; i += (k * 3) )\n\tfor(re int j = i; j < i + k; ++ j) {\n\t\trep( l, 0, 2 ) Nx[l].init() ; \n\t\trep( l, 0, 2 ) rep( o, 0, 2 ) \n\t\tNx[l] = (Nx[l] + Move(a[j + o * k], o * l % 3)) ; \n\t\trep( l, 0, 2 ) a[j + l * k] = Nx[l] ; \n\t}\n}\nvoid IFWT(gf *a) {\n\tfor(re int k = 1; k < lim; k *= 3 ) for(re int i = 0; i < lim; i += (k * 3) )\n\tfor(re int j = i; j < i + k; ++ j) {\n\t\trep( l, 0, 2 ) Nx[l].init() ; \n\t\trep( l, 0, 2 ) rep( o, 0, 2 ) \n\t\tNx[l] = (Nx[l] + Move(a[j + o * k], 3 - o * l % 3)) ; \n\t\trep( l, 0, 2 ) a[j + l * k] = Nx[l] ; \n\t}\n}\nint phi(int x) {\n\tint ans = x ; \n\tfor(re int i = 2; i <= sqrt(x); ++ i) {\n\t\tif(x % i) continue ;\n\t\tans = (ans - ans / i) ;\n\t\twhile(x % i == 0) x /= i ; \n\t} if( x != 1 ) ans = ans - ans / x ;\n\treturn ans ;  \n}\nsigned main()\n{\n\tm = gi(), t = gi(), P = gi(), lim = 1 ; \n\trep( i, 1, m ) lim = lim * 3 ; \n\trep( i, 0, lim - 1 ) f[i].a[0] = gi() ; \n\trep( i, 0, m ) rep( j, i, m ) b[i][j - i] = gi() ; \n\trep( i, 0, lim - 1 ) g[i].a[0] = b[bit1(i)][bit2(i)] ; \n\tFWT(f), FWT(g) ;\n\trep( i, 0, lim - 1 ) f[i] = f[i] % P, g[i] = g[i] % P ; \n\trep( i, 0, lim - 1 ) f[i] = f[i] * fpow(g[i], t) ;\n\tint iv = fpow(lim, phi(P) - 1) ; IFWT(f) ;\n\trep( i, 0, lim - 1 ) f[i] = f[i] % P ; \n\trep( i, 0, lim - 1 ) f[i] = f[i] * iv ;\n\trep( i, 0, lim - 1 ) {\n\t\tint d = (f[i].a[0] - f[i].a[2] + P) % P ; \n\t\tprintf(\"%lld\\n\", d ) ; \n\t}\n\treturn 0 ;\n}\n```",
        "postTime": 1602086694,
        "uid": 30036,
        "name": "Soulist",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P6673 \u3010[\u6e05\u534e\u96c6\u8bad2016] \u77f3\u5bb6\u5e84\u7684\u5de5\u4eba\u9636\u7ea7\u961f\u4f0d\u6bd4\u8f83\u575a\u5f3a\u3011"
    },
    {
        "content": "# \u57fa\u672c\u601d\u8def\n\n\u5c31\u50cf\u524d\u9762\u51e0\u4f4d\u5927\u4f6c\u8bf4\u7684\uff0c\u8fd9\u9053\u9898\u8981\u75283\u8fdb\u5236FWT\u8fd8\u662f\u5f88\u597d\u770b\u51fa\u6765\u7684\n\n\u5b9a\u4e49 $K$ \u8fdb\u5236\u5f02\u6216\n\n$(\\sum_{i=0}^{|A|}a_{i}K^{i})\u2295_{K}(\\sum_{i=0}^{|B|}b_{i}K^{i})=\\sum_{i=0}^{\u221e}(a_{i}+b_{i})\\mod K\\cdot K^{i}(a_{i},b_{i}<K)$\n\n\u7136\u540e\u5b9a\u4e49 $K$ \u8fdb\u5236\u5f02\u6216\u5377\u79ef $C=A\u2295_{3}B$ \u6ee1\u8db3 $C_{i}=\\sum_{i=j\u2295_{3}k}A_{i}B_{i}$\uff0c$K$ \u8fdb\u5236\u5f02\u6216\u5377\u79ef\u610f\u4e49\u4e0b\u7684 $n$ \u6b21\u5e42 $B=A^{k}=A^{k-1}\u2295_{3}A$\n\n\u63a5\u7740\u518d\u5b9a\u4e49 $a_{j}=b_{u,v}$ ,\u5176\u4e2d $u$ \u5206\u522b\u8868\u793a $j$ \u5728 $3$ \u8fdb\u5236\u4e0b\u4e3a $1$ \u7684\u6570\u4f4d\u6570\u91cf\uff0c $v$ \u5206\u522b\u8868\u793a $j$ \u5728 $3$ \u8fdb\u5236\u4e0b\u4e3a $2$ \u7684\u6570\u4f4d\u6570\u91cf\uff0c\u4f8b\u5982 $a_{19260817}=b_{7,5}$ \u56e0\u4e3a $(19260817)_{10}=(1100020112212121)_{3}$\n\n\u6839\u636e\u201c $0$ \u8868\u793a\u526a\u5200\uff0c$1$ \u8868\u793a\u77f3\u5934\uff0c$2$ \u8868\u793a\u5e03\u201d\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u679c $x$ \u5728\u7b2c $i$ \u5c40\u6218\u80dc $y$ \uff0c\u5219 $x$ \u7684\u53f3\u8d77\u7b2c $i$ \u4f4d $x_{i}$ \u548c $y$ \u7684\u53f3\u8d77\u7b2c $i$ \u4f4d $y_{i}$ \u6ee1\u8db3 $x_{i}\\equiv y_{i}+1\\pmod3$ \uff1b\u800c\u5982\u679c $x$ \u5728\u7b2c $i$ \u5c40\u8f93\u7ed9 $y$ \uff0c\u5219 $x$ \u7684\u53f3\u8d77\u7b2c $i$ \u4f4d $x_{i}$ \u548c $y$ \u7684\u53f3\u8d77\u7b2c $i$ \u4f4d $y_{i}$ \u6ee1\u8db3 $x_{i}\\equiv y_{i}+2\\pmod3$ \u3002\u6240\u4ee5\u82e5 $z$ \u6ee1\u8db3\u5f53 $x$ \u5728\u7b2c $i$ \u5c40\u6218\u80dc $y$ \u65f6\uff0c $z$ \u7684\u53f3\u8d77\u7b2c $i$ \u4f4d\u4e3a $1$ \uff1b\u5f53 $x$ \u5728\u7b2c $i$ \u5c40\u8f93\u7ed9 $y$ \u65f6\uff0c $z$ \u7684\u53f3\u8d77\u7b2c $i$ \u4f4d\u4e3a2\uff1b\u5f53 $x$ \u5728\u7b2c $i$ \u5c40\u4e0e $y$ \u6253\u5e73\u65f6\uff0c $z$ \u7684\u53f3\u8d77\u7b2c $i$ \u4f4d\u4e3a $0$ \u3002\u4e8e\u662f\u6709 $x\u2295_{3}y=z$ \u3002\n\n\u7531\u9898\u76ee\u4e2d\u7684\u5f0f\u5b50\u53ef\u5f97\n\n$f_{i,j}=\\sum_{k\u2295_{3}l=j}f_{i-1,k}a_{l}$\n\n\u5373\n\n$f_{i}=f_{i-1}\u2295_{3}a$\n\n\u5373\n\n$f_{i}=a^{i}$\n\n\u663e\u7136\u8fd9\u9053\u9898\u7684\u95ee\u9898\u5728\u4e8e\u5982\u4f55\u6c423\u8fdb\u5236\u5f02\u6216\u5377\u79ef\uff0c\u7531\u4e8e\u8fd9\u9898\u8fd8\u6ca1\u6709\u8be6\u7ec6\u8bf4\u660eK\u8fdb\u5236\u5f02\u6216\u5377\u79ef\u7684\u9898\u89e3\uff0c\u8fd9\u91cc\u5c31\u8bb2\u8bb2\u5b83\u5427\u3002\n\n\n------------\n\n\n# K\u8fdb\u5236\u5f02\u6216\u5377\u79ef\n\n$K$ \u8fdb\u5236\u5f02\u6216\u5377\u79ef\u7684\u601d\u8def\u548c2\u8fdb\u5236\u5f02\u6216\u5377\u79ef\u57fa\u672c\u76f8\u540c\uff0c\u90fd\u662f\u5148\u628a\u6570\u7ec4\u8f6c\u5316\u6210\u70b9\u503c\u8868\u793a\uff0c\u5377\u79ef\u4ee5\u540e\u518d\u8f6c\u5316\u4e3a\u63d2\u503c\u8868\u793a\u3002\u4f46\u662f\uff0c\u6574\u4e2a\u7b97\u6cd5\u5206\u6790\u8fc7\u7a0b\u5374\u5b8c\u5168\u4e0d\u540c\u3002\n\n\u5047\u8bbe\u6211\u4eec\u8981\u5bf9\u957f\u5ea6\u4e3a $n=K^{m}$ \u7684\u6570\u5217 $A$ \u548c $B$ \u505a $K$ \u8fdb\u5236\u5f02\u6216\u5377\u79ef\u3002\n\n\u5b9a\u4e49**\u5355\u4f4d\u6839**\uff08\u662f\u4e00\u4e2a\u6570\uff0c\u53ef\u80fd\u662f\u6574\u6570\u3001\u5b9e\u6570\u751a\u81f3\u590d\u6570\uff09 $\\omega_{K}$ \u6ee1\u8db3 $\\omega_{K}^{x}=1$ \u5f53\u4e14\u4ec5\u5f53 $K|x$ \uff0c\u5b9a\u4e49K\u884cK\u5217\u77e9\u9635 $W'$ \u6ee1\u8db3 $W'_{i,j}=\\omega_{K}^{ij}$ \uff0c K\u884cK\u5217\u77e9\u9635 $V'$ \u6ee1\u8db3 $V'_{i,j}=\\dfrac{\\omega_{K}^{-ij}}{K}$ \n\n\u518d\u5b9a\u4e49n\u884cn\u5217\u77e9\u9635 $W$ \uff0c\u6ee1\u8db3\u5f53\n\n$u=\\sum_{i=0}^{m-1}u_{i}K^{i},v=\\sum_{i=0}^{m-1}v_{i}K^{i}(u_{i},v_{i}<K)$\n\n\u65f6\uff0c\n\n$W_{u,v}=\\prod_{i=0}^{m-1}W'_{u_{i},v_{i}}$\n\n\u540c\u6837\u5b9a\u4e49n\u884cn\u5217\u77e9\u9635 $V$ \uff0c\u6ee1\u8db3\u5f53\n\n$u=\\sum_{i=0}^{m-1}u_{i}K^{i},v=\\sum_{i=0}^{m-1}v_{i}K^{i}(u_{i},v_{i}<K)$\n\n\u65f6\uff0c\n\n$V_{u,v}=\\prod_{i=0}^{m-1}V'_{u_{i},v_{i}}$\n\n****\u6211\u4eec\u53d1\u73b0\u77e9\u9635 $W$ \u548c\u77e9\u9635 $V$ \u6ee1\u8db3\u4ee5\u4e0b\u4e24\u4e2a\u6027\u8d28\uff1a****\n\n****\u6027\u8d28A\uff1a**** $W^{-1}=V$\n\n\u8bc1\u660e\u5982\u4e0b\uff1a\n\n\u8bbe $U_{t}=\\sum_{i=0}^{K^{t}-1}\\prod_{j=0}^{t-1}W'_{u_{j},i_{j}}V'_{i_{j},v_{j}}(t>0)$\n\n\u5219 $U_{t}=\\sum_{i=0}^{K^{t}-1}\\prod_{j=0}^{t-1}\\dfrac{\\omega_{K}^{i_{j}(u_{j}-v_{j})}}{K}$\n\n$=\\sum_{k=0}^{K-1}\\sum_{i=kK^{t-1}}^{(k+1)K^{t-1}-1}\\prod_{j=0}^{t-1}\\dfrac{\\omega_{K}^{i_{j}(u_{j}-v_{j})}}{K}$\n\n$=\\sum_{k=0}^{K-1}\\sum_{i=kK^{t-1}}^{(k+1)K^{t-1}-1}\\dfrac{\\omega_{K}^{k(u_{t-1}-v_{t-1})}}{K}\\prod_{j=0}^{t-2}\\dfrac{\\omega_{K}^{i_{j}(u_{j}-v_{j})}}{K}$\n\n$=\\sum_{k=0}^{K-1}\\dfrac{\\omega_{K}^{k(u_{t-1}-v_{t-1})}}{K}\\sum_{i=kK^{t-1}}^{(k+1)K^{t-1}-1}\\prod_{j=0}^{t-2}\\dfrac{\\omega_{K}^{i_{j}(u_{j}-v_{j})}}{K}$\n\n$=\\sum_{k=0}^{K-1}\\dfrac{\\omega_{K}^{k(u_{t-1}-v_{t-1})}}{K}U_{t-1}$\n\n$=U_{t-1}\\sum_{k=0}^{K-1}\\dfrac{(\\omega_{K}^{u_{t-1}-v_{t-1}})}{K}^{k}(t>1,i=\\sum_{j=0}^{m-1}i_{j}K^{j}(i_{j}<K))$\n\n\u4e8e\u662f\u5f53 $u_{t-1}=v_{t-1}$ \u65f6\uff0c\n\n$U_{t}=U_{t-1}\\sum_{k=0}^{K-1}\\dfrac{1^{k}}{K}=1$\n\n\u5426\u5219\n\n$U_{t}=U_{t-1}\\dfrac{1-(\\omega_{K}^{u_{t-1}-v_{t-1}})^{K}}{K(1-\\omega_{K}^{u_{t-1}-v_{t-1}})}$\n\n$=U_{t-1}\\dfrac{1-\\omega_{K}^{K(u_{t-1}-v_{t-1})}}{K(1-\\omega_{K}^{u_{t-1}-v_{t-1}})}$\n\n$=0$\n\n\u800c $U_{1}=\\sum_{i=0}^{K-1}W'_{u_{0},i_{0}}V'_{i_{0},v_{0}}=\\sum_{i=0}^{K-1}\\dfrac{(\\omega_{K}^{u_{0}-v_{0}})^{i}}{K}$\n\n\u4e8e\u662f\u5f53 $u_{0}=v_{0}$ \u65f6\uff0c\n\n$U_{1}=\\sum_{i=0}^{K-1}\\dfrac{1^{i}}{K}=1$\n\n\u5426\u5219\n\n$U_{1}=\\dfrac{1-\\omega_{K}^{K(u_{0}-v_{0})}}{K(1-\\omega_{K}^{u_{0}-v_{0}})}=0$\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c $U_{t}$ \u5728 $u=v$ \u65f6\u7b49\u4e8e $1$ ,\u5728 $u\u2260v$ \u65f6\u7b49\u4e8e $0$\n\n\u6b64\u5916\uff0c\u5bb9\u6613\u770b\u51fa\u77e9\u9635 $WV$ \u7b2c $u$ \u884c\u7b2c $v$ \u5217\u7b49\u4e8e $U_{t}$ \uff0c\u6240\u4ee5\u77e9\u9635 $W$ \u548c\u77e9\u9635 $V$ \u4e92\u9006\u3002\n\n**\u6027\u8d28B\uff1a** $W_{i,j}W_{i,k}=W_{i,j\u2295_{K}k}, V_{i,j}V_{i,k}=V_{i,j\u2295_{K}k}$\n\n\u5f53 $t\\equiv j+k \\pmod K$ \u65f6\uff0c$W_{i,j}W_{i,k}=\\omega_{K}^{ij+ik}=\\omega_{K}^{i(j+k)\\mod K}=W_{i,j\u2295_{K}k}=\\omega_{K}^{it}=W_{i,t}$\n\n\u663e\u7136 $j\u2295_{K}k\\equiv j+k \\pmod K$\n\n\u6240\u4ee5\u6709 $W_{i,j}W_{i,k}=W_{i,j\u2295_{K}k}$\n\n$V_{i,j}V_{i,k}=V_{i,j\u2295_{K}k}$ \u540c\u7406\uff0c\u5728\u6b64\u4e0d\u8d58\u8ff0\u3002\n\n**\u73b0\u5728\u5b9a\u4e49FWT\u53d8\u6362\u548cIFWT\u53d8\u6362**\n\n\u5b9a\u4e49\u6570\u5217 $B=FWT(A_{k,t})$ \u662f\u957f\u5ea6\u4e3a $n=K^{m}$ \u7684\u6570\u5217 $A_{i}$ \u5728\u533a\u95f4 $[k\\cdot K^{t},(k+1)\\cdot K^{t}]$ \u7684 FWT \u53d8\u6362\uff0c\u5219\u5f53 $t>0$ \u65f6\uff0c\n\n$B_{i}=\\sum_{j=0}^{K^{t}-1}W_{i,j}A_{k\\cdot K^{t}+j}(i\u2208[k\\cdot K^{t},(k+1)\\cdot K^{t}])$\n\n\u5f53 $t=0$ \u65f6,\n\n$B_{k}=A_{k}$\n\n\uff0c\u82e5 $k=0$ \u4e14 $K^{t}=n$ \uff0c\u5219FWT\u53d8\u6362\u7b80\u8bb0\u4e3a $FWT(A)$ \u3002\n\n\u540c\u6837\u5730\uff0c\u5b9a\u4e49\u6570\u5217 $B=IFWT(A_{k,t})$ \u662f\u957f\u5ea6\u4e3a $n=K^{m}$ \u7684\u6570\u5217 $A_{i}$ \u5728\u533a\u95f4 $[k\\cdot K^{t},(k+1)\\cdot K^{t}]$ \u7684 IFWT \u53d8\u6362\uff0c\u5219\u5f53 $t>0$ \u65f6\uff0c\n\n$B_{i}=\\sum_{j=0}^{K^{t}-1}V_{i,j}A_{k\\cdot K^{t}+j}(i\u2208[k\\cdot K^{t},(k+1)\\cdot K^{t}])$\n\n\u5f53 $t=0$ \u65f6,\n\n$B_{k}=A_{k}$\n\n\uff0c\u82e5 $k=0$ \u4e14 $K^{t}=n$ \uff0c\u5219IFWT\u53d8\u6362\u7b80\u8bb0\u4e3a $IFWT(A)$ \u3002\n\n**\u8981\u4f7fFWT\u53d8\u6362\u548cIFWT\u53d8\u6362\u53d1\u6325\u76f8\u5e94\u7684\u529f\u80fd\uff0c\u5b83\u4eec\u5fc5\u987b\u6ee1\u8db3\u4e0b\u5217\u4e09\u4e2a\u6027\u8d28\uff1a**\n\n\u6027\u8d281\uff1a\u4e0d\u8003\u8651\u53d8\u91cf $K$ \u7684\u5f71\u54cd\uff0c\u6c42\u89e3\u957f\u5ea6\u4e3a $n$ \u7684\u6570\u5217\u7684FWT\u548cIFWT\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5c11\u4e8e $O(n^{2})$\n\n\u6027\u8d282\uff1a\u5bf9\u4e8e\u6574\u4e2a\u6570\u5217\u7684IFWT\u53d8\u6362\u662fFWT\u53d8\u6362\u548c\u9006\u8fd0\u7b97\n\n\u6027\u8d283\uff1a\u5b9a\u4e49\u4e24\u4e2a\u6570\u5217\u70b9\u4e58 $C=A\\cdot B$ \uff0c\u6ee1\u8db3 $C_{i}=A_{i}B_{i}$ \uff0c\u5219 $FWT(A)\\cdot FWT(B)=FWT(A\u2295_{K}B)$\n\n\u53ef\u4ee5\u770b\u51fa\uff0c\u8fd9\u4e09\u6761\u6027\u8d28\u5168\u90e8\u6210\u7acb\uff0c\u4ee5\u4e0b\u662f\u4e09\u6761\u6027\u8d28\u7684\u8bc1\u660e\u3002\n\n**\u6027\u8d281\u7684\u8bc1\u660e\uff1a**\n\n\u8bbe $B=FWT(A_{k,t})$\n\n$B_{i}=\\sum_{j=0}^{K^{t}-1}W_{i,j}A_{k\\cdot K^{t}+j}$\n\n$=\\sum_{l=0}^{K-1}\\sum_{j=l\\cdot K^{t-1}}^{(l+1)\\cdot K^{t-1}-1}W_{i,j}A_{k\\cdot K^{t}+j}$\n\n$=\\sum_{l=0}^{K-1}\\sum_{j=l\\cdot K^{t-1}}^{(l+1)\\cdot K^{t-1}-1}\\prod_{x=0}^{t-1}\\omega_{K}^{i_{x},j_{x}}A_{k\\cdot K^{t}+j}$\n\n$=\\sum_{l=0}^{K-1}\\sum_{j=l\\cdot K^{t-1}}^{(l+1)\\cdot K^{t-1}-1}\\omega_{K}^{i_{t-1},j_{t-1}}\\prod_{x=0}^{t-2}\\omega_{K}^{i_{x},j_{x}}A_{k\\cdot K^{t}+j}$\n\n$=\\sum_{l=0}^{K-1}\\sum_{j=l\\cdot K^{t-1}}^{(l+1)\\cdot K^{t-1}-1}W_{i_{t-1},l}W_{i-i_{t-1},j-l\\cdot K^{t-1}}A_{k\\cdot K^{t}+j}$\n\n$=\\sum_{l=0}^{K-1}W_{i_{t-1},l}\\sum_{j=0}^{K^{t-1}-1}W_{i-i_{t-1},j}A_{(Kk+l)\\cdot K^{t-1}+j}$\n\n$=\\sum_{l=0}^{K-1}W'_{i_{t-1},l}FWT(A_{Kk+l,t-1})(t>0)$\n\n\u4e8e\u662f $FWT(A)$ \u53ef\u4ee5\u901a\u8fc7\u9012\u5f52\u6216\u8774\u8776\u53d8\u6362\u6c42\u89e3\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(nK\\log n)$\n\n\u6c42\u89e3 $IFWT(A)$ \u540c\u7406\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(nK\\log n)$\n\n**\u6027\u8d282\u7684\u8bc1\u660e\uff1a**\n\n\u8bbe $B=FWT(A),C=IFWT(A)$ \uff0c\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6570\u5217\u53ef\u4ee5\u770b\u505a\u662f\u4e00\u4e2a $n$ \u884c $1$ \u5217\u7684\u77e9\u9635\uff0c\u4e8e\u662f\u6839\u636eFWT\u53d8\u6362\u7684\u5b9a\u4e49\u5c31\u6709\n\n$B_{i}=\\sum_{j=0}^{n-1}W_{i,j}A_{j,1},C_{i}=\\sum_{j=0}^{n-1}V_{i,j}A_{j,1}$\n\n\u6240\u4ee5\n\n$B=WA,C=VA$\n\n\n\u6240\u4ee5\n\n$IFWT(FWT(A))=V(WA)=A$\n\n**\u6027\u8d283\u7684\u8bc1\u660e\uff1a**\n\n\u8bbe $C=FWT(A\u2295_{K}B)$ \uff0c\u5219\n\n$C_{i}=\\sum_{j=0}^{n-1}W_{i,j}\\sum_{k\u2295_{K}l=j}A_{k}B_{l}$\n\n$=\\sum_{k=0}^{n-1}\\sum_{l=0}^{n-1}W_{i,k\u2295_{K}l}A_{k}B_{l}$\n\n$=\\sum_{k=0}^{n-1}\\sum_{l=0}^{n-1}W_{i,k}W_{i,l}A_{k}B_{l}$\n\n$=\\sum_{k=0}^{n-1}W_{i,k}A_{k}\\sum_{l=0}^{n-1}W_{i,l}B_{l}$\n\n$=FWT(A)\\cdot FWT(B)$\n\n**\u4e8e\u662f\u6211\u4eec\u5f97\u5230 $A$ \u548c $B$ \u7684 $K$ \u8fdb\u5236\u5f02\u6216\u5377\u79ef\u7684\u7b97\u6cd5\uff1a\u5148\u6c42\u51fa $FWT(A)$ \u548c $FWT(B)$ \uff0c\u518d\u901a\u8fc7\u70b9\u4e58\u5f97\u5230 $FWT(A\u2295_{K}B)$ ,\u6700\u540e\u901a\u8fc7IFWT\u53d8\u6362\u6c42\u51fa $A\u2295_{K}B$ \uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(nK\\log n)$**\n\n**\u6700\u540e\u63d0\u4e00\u5634\u6570\u5217 $A$ \u7684 $K$ \u8fdb\u5236\u5f02\u6216\u5377\u79ef\u610f\u4e49\u4e0b\u7684 $n$ \u6b21\u5e42**\n\n\u663e\u7136\u6570\u5217\u70b9\u4e58\u5177\u6709\u7ed3\u5408\u5f8b\uff0c\u4e8e\u662f\u6211\u4eec\u5148\u6c42\u51fa $FWT(A)$ \uff0c\u518d\u7c7b\u4f3c\u5feb\u901f\u5e42\u7684\u65b9\u6cd5\u6c42\u51fa $FWT(A)$ \u8fde\u7eed\u70b9\u4e58 $FWT(A)$ $(n-1)$ \u6b21\u7684\u503c $FWT(A^{n})$\uff0c\u6700\u540e\u6c42\u5176IFWT\u53d8\u6362\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(nK\\log N)$\u3002\n\n\u4f46\u662f\u8bf4\u4e86\u8fd9\u4e48\u591a\uff0c\u6211\u4eec\u53d1\u73b0\u7b97\u6cd5\u4e00\u5f00\u5934\u63d0\u5230\u7684\u5355\u4f4d\u6839 $\\omega_K$ \u7684\u503c\u8fd8\u6ca1\u6709\u786e\u5b9a\u3002 $\\omega_K$ \u4e00\u822c\u6839\u636e\u9898\u76ee\u6761\u4ef6\u786e\u5b9a\uff0c\u53d6\u590d\u6570\u6216\u8005\u6a21\u610f\u4e49\u4e0b\u7684\u590d\u6570\u80af\u5b9a\u662f\u884c\u5f97\u901a\u7684\uff0c\u4f46\u662f\u672c\u9898\u5b58\u5728\u53d6\u5f97\u6574\u6570\u7684\u65b9\u6848\u3002\n\n\n------------\n\n\n# \u672c\u9898\u5355\u4f4d\u6839\u7684\u786e\u5b9a\n\n\u4ee5\u4e0b\u5185\u5bb9\u53c2\u8003\u4e86[[lydsy4740][uoj272][\u6e05\u534e\u96c6\u8bad2016]\u77f3\u5bb6\u5e84\u7684\u5de5\u4eba\u9636\u7ea7\u961f\u4f0d\u6bd4\u8f83\u575a\u5f3a](https://yhx-12243.github.io/OI-transit/records/lydsy4740%3Buoj272.html)\n\n**\u8fd9\u9898\u6709\u4e00\u4e2a\u5947\u602a\u7684\u6761\u4ef6\uff0c\u4e0d\u5b58\u5728\u4efb\u4f55\u4e24\u4e2a\u6574\u6570\u4f7f\u5f97\u4ed6\u4eec\u7684\u5012\u6570\u548c\u7b49\u4e8e $\\dfrac{3}{p}$ \uff0c\u7531\u6b64\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7ed3\u8bba\uff1a$p$ \u53ea\u542b\u6709\u5f62\u5982 $6k+1$ \u7684\u8d28\u56e0\u5b50**\n\n\u82e5 $p=(3k-1)r$ \uff0c\u5219 $\\dfrac{1}{kr}+\\dfrac{1}{kp}=\\dfrac{p+r}{kpr}=\\dfrac{(3k-1)r+r}{kpr}=\\dfrac{3}{p}$ \uff0c\u4e0e\u5047\u8bbe\u77db\u76fe\u3002\n\n\u82e5 $p=3r$ \uff0c\u5219 $\\dfrac{1}{r+1}+\\dfrac{1}{r(r+1)}=\\dfrac{r+1}{r(r+1)}=\\dfrac{1}{r}=\\dfrac{3}{p}$ \uff0c\u4e0e\u5047\u8bbe\u77db\u76fe\u3002\n\n\u82e5 $p=6kr$ \uff0c\u5219 $p=3\\cdot(2k)r$ \uff0c\u4e0e\u524d\u8ff0\u77db\u76fe\u3002\n\n\u82e5 $p=(6k+2)r$ \uff0c\u5219 $p=[3\\cdot(2k+1)-1]r$ \uff0c\u4e0e\u524d\u8ff0\u77db\u76fe\u3002\n\n\u82e5 $p=(6k+3)r$ \uff0c\u5219 $p=[3\\cdot(2k+1)]r$ \uff0c\u4e0e\u524d\u8ff0\u77db\u76fe\u3002\n\n\u82e5 $p=(6k+4)r$ \uff0c\u5219 $p=2\\cdot[3(k+1)-1]r$ \uff0c\u4e0e\u524d\u8ff0\u77db\u76fe\u3002\n\n\u82e5 $p=(6k+5)r$ \uff0c\u5219 $p=\\left\\{3\\cdot[2(k+1)]-1\\right\\}r$ \uff0c\u4e0e\u524d\u8ff0\u77db\u76fe\u3002\n\n\u7efc\u4e0a\u6240\u8ff0\uff0c $p$ \u53ea\u542b\u6709\u5f62\u5982 $6k+1$ \u7684\u8d28\u56e0\u5b50\u3002\n\n**\u636e\u6b64\u6211\u4eec\u53c8\u53ef\u4ee5\u53d1\u73b0 $p-3$ \u662f $p$ \u7684\u4e8c\u6b21\u5269\u4f59\uff0c\u4e0b\u9762\u7ed9\u51fa\u76f8\u5173\u8bc1\u660e\u3002**\n\n$a$ \u662f $p$ \u7684\u4e8c\u6b21\u5269\u4f59\uff0c\u662f\u6307\u5b58\u5728 $x$ \u6ee1\u8db3 $x^{2}\\equiv a\\pmod p$ \u3002\n\n\u5047\u8bbe $p$ \u662f\u8d28\u6570\uff0c\u6839\u636e\u52d2\u8ba9\u5fb7\u7b26\u53f7\u7684\u5b8c\u5168\u79ef\u6027\u548c\u4e8c\u6b21\u4e92\u53cd\u5f8b\u53ef\u5f97\n\n$(\\dfrac{p-3}{p})$\n\n$=(\\dfrac{3p-3}{p})$\n\n$=(\\dfrac{p-1}{p})(\\dfrac{3}{p})$\n\n$=(-1)^{\\frac{p-1}{2}}(\\dfrac{p}{3})(-1)^{\\frac{3-1}{2}\\cdot\\frac{p-1}{2}}$\n\n$=(-1)^{6k}(\\dfrac{6k+1}{3})$\n\n$=(\\dfrac{1}{3})$\n\n$=1$\n\n\u6240\u4ee5 $p-3$ \u662f $p$ \u7684\u4e8c\u6b21\u5269\u4f59\n\n\u5173\u4e8e\u52d2\u8ba9\u5fb7\u7b26\u53f7\u7684\u4fe1\u606f\u53ef\u53c2\u8003[Legendre\u7b26\u53f7\u53caGauss\u4e8c\u6b21\u4e92\u53cd\u5f8b\u7684\u8bc1\u660e.pdf](https://max.book118.com/html/2017/0806/126227703.shtm)\n\n\u8bbe $x^{2}\\equiv p-3\\pmod {p^{\\alpha}}(\\alpha>0,\\gcd(x,p)=1)$\n\n\u4e8e\u662f\u53ef\u8bbe $x^{2}\\equiv p-3+tp^{\\alpha}\\pmod {p^{\\alpha+1}}$\n\n\u7531\u4e8e $p=6k+1$ , \u6240\u4ee5 $2$ \u4e0e $p$ \u4e92\u8d28\uff0c\u5373 $2x$ \u5728\u6a21 $p$ \u610f\u4e49\u4e0b\u5b58\u5728\u9006\u5143 $(2x)^{-1}$ \uff0c\u6240\u4ee5\u53c8\u53ef\u8bbe $k=t(2x)^{-1}$ \u3002\n\n\u4e8e\u662f\u6709 $(x-kp^{\\alpha})^2\\equiv x^2-2kxp^{\\alpha}+k^2p^{2\\alpha}\\equiv p-3+tp^{\\alpha}-tp^{\\alpha}\\equiv p-3\\pmod {p^{\\alpha+1}}$\n\n\u663e\u7136 $\\gcd(x-kp^{\\alpha},p)=1$\n\n\u7531\u6570\u5b66\u5f52\u7eb3\u6cd5\u53ef\u5f97\uff0c\u5f53 $p$ \u7b49\u4e8e\u67d0\u4e2a\u8d28\u6570\u7684\u4e58\u5e42\u65f6\uff0c $p-3$ \u662f $p$ \u7684\u4e8c\u6b21\u5269\u4f59\u3002\n\n\u5047\u8bbe $p$ \u4e0d\u4e00\u5b9a\u662f\u8d28\u6570\uff0c $p=\\prod_{i=1}^{t}p_{i}^{k_{i}}$ \uff0c\n\n\u5219\u5bf9\u4e8e\u6bcf\u4e2a $i$ \uff0c\u90fd\u80fd\u5f97\u5230 $x^2\\equiv p-3\\pmod {p_{i}^{k_{i}}}$ \u7684\u89e3 $x\\equiv x_{i}\\pmod {p_{i}^{k_{i}}}$ ,\u8fd9\u4e9b\u89e3\u53ef\u4ee5\u7528CRT\u5408\u5e76\u6210\u4e00\u4e2a\u901a\u89e3 $x\\equiv x_{0}\\pmod p$ \uff0c\u663e\u7136\u8fd9\u662f $x^{2}\\equiv p-3\\pmod p$ \u7684\u89e3\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u7528\u4efb\u610f\u6a21\u6570\u4e8c\u6b21\u5269\u4f59\u6c42\u51fa $x$ \u6ee1\u8db3 $x^{2}\\equiv p-3\\pmod p$ ,\u6c42\u4e8c\u6b21\u5269\u4f59\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u5206\u89e3\u8d28\u56e0\u6570\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u5982\u679c\u7528Pollard-Rho\u5206\u89e3\u8d28\u56e0\u6570\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\sqrt[4]p\\log^2n)$ \uff0c\u5f53\u7136\u7528 $O(\\sqrt p)$ \u7684\u66b4\u529b\u5206\u89e3\u8d28\u56e0\u6570\u7684\u65b9\u6cd5\u4e5f\u53ef\u4ee5\u3002\n\n\u4efb\u610f\u6a21\u6570\u4e8c\u6b21\u5269\u4f59\u7684\u65b9\u6cd5\u53ef\u53c2\u8003[\u3010\u6a21\u677f\u3011\u3010\u8bc1\u660e\u3011\u4efb\u610f\u6a21\u6570\u4e0b\u7684\u4e8c\u6b21\u5269\u4f59\u6c42\u89e3](https://blog.csdn.net/zxyoi_dreamer/article/details/85195819)\n\n**\u7531\u4e8e $p$ \u7684\u8d28\u56e0\u6570\u5168\u4e3a\u5947\u6570\uff0c\u6240\u4ee5 $2$ \u5b58\u5728\u6a21 $p$ \u610f\u4e49\u4e0b\u5b58\u5728\u9006\u5143 $2^{-1}$ \uff0c\u6613\u5f97 $2^{-1}(x-1)$ \u662f\u4e00\u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u5355\u4f4d\u6839**\n\n\u672c\u9898Pollard-Rho\u5206\u89e3\u8d28\u56e0\u6570\u65f6\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\sqrt[4]p\\log^2n+n\\log n)$ \uff0c\u66b4\u529b\u5206\u89e3\u8d28\u56e0\u6570\u662f\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\sqrt p+n\\log n)$",
        "postTime": 1651133333,
        "uid": 4865,
        "name": "Mr_Li",
        "ccfLevel": 8,
        "title": "P6673 [\u6e05\u534e\u96c6\u8bad2016] \u77f3\u5bb6\u5e84\u7684\u5de5\u4eba\u9636\u7ea7\u961f\u4f0d\u6bd4\u8f83\u575a\u5f3a"
    }
]
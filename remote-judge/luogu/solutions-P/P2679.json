[
    {
        "content": "\u5341\u4e00\u884c\u5b50\u4e32\uff01\uff08MQX\u6700\u5e05\uff09\n\nDP\u65b9\u7a0b\u5f88\u7b80\u5355\uff0c\u524d\u9762\u5f88\u591a\u5927\u795e\u90fd\u5199\u4e86\uff0c\u6211\u4e3b\u8981\u662f\u7528sum\u5904\u7406\u4e86\u4e00\u4e0b\uff0c\u7136\u540e\u53ef\u4ee5\u6eda\u52a8\u6389\u4e00\u7ef4\uff0c\u4e8e\u662f\u6210\u4e862\u7ef411\u884cdp\n\n- A' \u8868\u793a\u7531\u4e32A\u524di\u4e2a\u5b57\u7b26\u7ec4\u6210\u7684\u4e32\n\n- B' \u8868\u793a\u7531\u4e32B\u524dj\u4e2a\u5b57\u7b26\u7ec4\u6210\u7684\u4e32\n\n\u8bbe$f(i,j,k)$\u4e3a\u4eceA'\u4e2d\uff0c\u987a\u5e8f\u53d6k\u4e2a\u4e0d\u91cd\u590d\u5b50\u4e32\uff0c\u9996\u5c3e\u76f8\u63a5\u540e\u4e0eB'\u76f8\u7b49\u7684\u65b9\u6848\u6570\n\n$f(i,j,k)=\\begin{cases}f(i-1,j,k) &,A_i\\neq B_j\\\\ f(i-1,j,k)+f(i-1,j-1,k-1) &,A_i=B_j,A_{i-1}\\neq B_{j-1}\\\\ f(i-1,j,k)+f(i-1,j-1,k-1)+f(i-2,j-2,k-1) &,A_i=B_j,A_{i-1}=B_{j-1},A_{i-2}\\neq B_{j-2}\\\\ \\vdots\\\\ \\end{cases}$\n\n\u8bbe$p$\n\n\u6ee1\u8db3\uff1a\n\n$\\forall x\\in[0,p], A_{i-x}=B_{j-x}$\n\n$A_{i-p-1}\\neq B_{j-p-1}$\n\n\u5219\u6709\uff1a\n\n$f(i,j,k)=\\begin{cases}f(i-1,j,k)&,A_i\\neq B_j\\\\ f(i-1,j,k)+\\sum\\limits^{p+1}_{t=1}f(i-t,j-t,k-1)&,A_i=B_j\\end{cases}$\n\n```cpp\n#include<iostream>\nlong long f[201][201]={1},sum[201][201],n,m,ki;\nchar a[1001],b[201];\nint main(){\n    std::cin>>n>>m>>ki>>a>>b;\n    for(int i=1;i<=n;i++)\n      for(int j=m;j>=1;j--)\n        for(int k=ki;k>=1;k--)\n              f[j][k]=(f[j][k]+ (sum[j][k]= a[i-1]==b[j-1]? sum[j-1][k]+f[j-1][k-1] : 0))%1000000007;\n    std::cout<<f[m][ki];\n}",
        "postTime": 1479353931,
        "uid": 23420,
        "name": "Rumia",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\u770b\u5230\u5404\u4f4dDP\u6570\u7ec4\u90fd\u53ea\u5f00\u4e24\u4e09\u7ef4\u7684\u6211\u5f88\u5bb3\u6015\u554a\uff0c\u6211\u6765\u8bb2\u4e00\u8bb2\u5982\u4f55\u5f88\u66b4\u529b\u7684\u505a\u8fd9\u9053\u9898\u3002\n\n------------\n### \u72b6\u6001\n  \u9996\u5148\u6211\u4eec\u8003\u8651\u8bbe\u8ba1\u72b6\u6001\u3002\u6211\u4eec\u53d1\u73b0\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u65e0\u540e\u6548\u6027\u7684\u4e00\u4f4d\u4e00\u4f4d\u5f80\u540e\u63a8\uff0c\u6211\u4eec\u9700\u8981\u8bb0\u5f55\u5f53\u524d\u63a8\u5230$a$\u4e32\u7684\u54ea\u4e00\u4e2a\u4f4d\u7f6e\u4e86\uff1b\u63a5\u7740\u8fd8\u6709\u8bb0\u5f55\u5339\u914d\u4e86$b$\u4e32\u7684\u90a3\u51e0\u4e2a\u5b57\u7b26\u3002\u56e0\u4e3a\u662f\u6309\u7167\u539f\u4e32\u987a\u5e8f\uff0c\u6240\u4ee5\u76f8\u5f53\u4e8e\u662f\u5373\u5339\u914d$b$\u7684\u524d\u51e0\u4e2a\u5b57\u7b26\u3002\u6709\u8fd9\u4e9b\u8fd8\u4e0d\u591f\uff0c\u6211\u4eec\u8fd8\u8981\u8bb0\u5f55\u5212\u5206\u4e86\u51e0\u4e2a\u5b50\u4e32\u3002\u6700\u540e\uff0c\u4e3a\u4e86\u4fbf\u4e8e\u8f6c\u79fb\uff0c\u6211\u4eec\u8fd8\u8981\u6807\u8bb0\u4e00\u7ef4`0/1`\u72b6\u6001\uff0c\u8868\u793a$a$\u4e32\u4e2d\u7684\u7b2c$i$\u4e2a\u5b57\u7b26\u662f\u5426\u9009\u5165\u3002\n  \n  \u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u8bbe\u8ba1\u597d\u4e86\u72b6\u6001\u3002\u6211\u4eec\u8bb0$f_{i,j,p,v}$\u8868\u793a\u5230$a$\u4e32\u7684\u7b2c$i$\u4e2a\u4f4d\u7f6e\u4e3a\u6b62\u4f7f\u7528$p$\u4e2a\u5b50\u4e32\u5339\u914d$b$\u4e32\u524d$j$\u4f4d\u5b57\u7b26\u4e14\u7b2c$i$\u4e2a\u4f4d\u7f6e\u9009\u6216\u4e0d\u9009\uff08$v$\uff09\u7684\u65b9\u6848\u6570\u3002\n\n------------\n### \u8f6c\u79fb\n\u8bbe\u8ba1\u597d\u72b6\u6001\uff0c\u4e0d\u4f1a\u8f6c\u79fb\u600e\u4e48\u884c\u3002\u6211\u4eec\u5206\u60c5\u51b5\u8003\u8651\u3002\n1. \u5f53$a_i=b_j$\u65f6\uff1a\n\n\t1. $f_{i,j,p,0}$\uff1a\u7531\u4e8e\u8fd9\u4f4d\u4e0d\u9009\uff0c\u6240\u4ee5\u5c31\u662f\u524d\u9762\u4e00\u4f4d\u9009\u548c\u4e0d\u9009\u65b9\u6848\u6570\u4e4b\u548c\uff0c\u5373$f_{i,j,p,0}=f_{i-1,j,p,0}+f_{i-1,j,p,1}$\u3002\n    \n    2. \u5bb9\u6613\u5f97\u5230$f_{i,j,p,1}=f_{i-1,j-1,p,1}+f_{i-1,j-1,p-1,0}+f_{i-1,j-1,p-1,1}$.\n    \n2. \u5f53$a_i\\ne b_j$\u65f6\uff1a\n\n\t1. \u4e0d\u9009\u60c5\u51b5\u540c\u4e0a\uff0c\u5373$f_{i,j,p,0}=f_{i-1,j,p,0}+f_{i-1,j,p,1}$.\n    \n    2. \u7531\u4e8e\u9009\u4e0d\u4e86\uff0c\u81ea\u7136\u5c31\u662f$0$\uff0c\u5373$f_{i,j,p,1}=0$.\n    \n\n------------\n### \u4f18\u5316\u7a7a\u95f4\n\u5982\u679c\u4f60\u8bfb\u5b8c\u72b6\u6001\u8bbe\u8ba1\u4e4b\u540e\u53c8\u7a0d\u5fae\u601d\u8003\u5c31\u4f1a\u53d1\u73b0\uff0c\u7a7a\u95f4\u53ef\u80fd\u8f83\u5927\u3002\u7a7a\u95f4\u4e0d\u591f\u600e\u4e48\u529e\uff1f\u5728luogu\u8fd8\u597d\u8bf4\uff0c\u5982\u679c\u771f\u7684\u5728NOIP\uff0c\u5e94\u8be5\u662f\u4e0d\u6562\u5f00$1000\\times200\\times200\\times2=8\\times10^7$\u7684\u6570\u7ec4\u5427\u3002\u6240\u4ee5\u6211\u4eec\u89c2\u5bdf\u8f6c\u79fb\u65b9\u7a0b\uff0c\u53d1\u73b0\u6bcf\u6b21\u8f6c\u79fb\u53ea\u7528\u5230\u4e86\u524d\u4e00\u4f4d\uff01\u4e8e\u662f\u6211\u4eec\u628a\u7b2c\u4e00\u7ef4\u5f88\u6109\u5feb\u5730\u6eda\u6389\u4e86\u3002\u8fd9\u6837\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6\u5c31\u4fdd\u8bc1\u662f$O(mk)$\u4e86\u3002\u90a3\u4e48\u65f6\u95f4\u5462\uff1f\u65f6\u95f4\u662f$O(n\\cdot mk)$\uff0c\u4f46\u662f\u65f6\u95f4\u4e0d\u50cf\u7a7a\u95f4\uff0c\u8fd9\u4e2a\u590d\u6742\u5ea6\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u3002\u4e8e\u662f\uff0c\u5b8c\u6574\u7b97\u6cd5\u5c31\u7ed3\u675f\u4e86\u3002\n\n------------\n`Cpp`\u4ee3\u7801\uff1a\n```cpp\n#include<cstdio>\n#include<cstring>\nconst int MAXN=1010;\nconst int MAXM=210;\nconst int MOD=(int)(1e9)+7;\nint f[2][MAXM][MAXM][2];\nchar a[MAXN],b[MAXM];\nint n,m,k;bool val=1;\n\nvoid dp(){\n    f[0][0][0][0]=f[1][0][0][0]=1;\n    for(int i=1;i<=n;i++,val^=1)\n        for(int j=1;j<=m;j++)\n            for(int p=1;p<=k;p++){\n                if(a[i]==b[j]){\n                    f[val][j][p][0]=(f[val^1][j][p][0]+f[val^1][j][p][1])%MOD;\n                    f[val][j][p][1]=(f[val^1][j-1][p][1]+\\\n                                    (f[val^1][j-1][p-1][0]+f[val^1][j-1][p-1][1])%MOD)%MOD;\n                }\n                else{\n                    f[val][j][p][0]=(f[val^1][j][p][0]+f[val^1][j][p][1])%MOD;\n                    f[val][j][p][1]=0;\n                }\n            }\n}\n\nint main(){\n    scanf(\"%d%d%d\",&n,&m,&k);\n    scanf(\"%s%s\",a+1,b+1);\n    dp();\n    printf(\"%d\\n\",(f[n&1][m][k][0]+f[n&1][m][k][1])%MOD);\n    return 0;\n}\n```",
        "postTime": 1519306715,
        "uid": 23398,
        "name": "frankchenfu",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "#\u8fd9\u4e2a\u5947\u602a\u7684DP\uff0c\u90a3\u5e74\u6211\u53ea\u5f97\u4e8620\u5206\u6211\u4e5f\u662f\u9189\u4e86\n\n\n\u4e00\u4e2a\u975e\u5e38\u7ed5\u7684dp\uff0c\u53c2\u8003\u4e86\u4e00\u90e8\u5206\u522b\u4eba\u7684\u89e3\u6cd5\u7406\u89e3\u4e86\uff0c\u89c9\u5f97\u66f4\u597d\u7406\u89e3\u4e00\u4e9b\uff0c\u5206\u4eab\u7ed9\u5927\u5bb6\u3002\n\n\u7248\u6743\u5927\u6982\u5f52\u5c5e\u4e8ecodevs 34504\u548c\u4e1c\u8425\u80dc\u5229\u4e00\u4e2d\u7684GaoTY\u54e5\u54e5\uff0c\u636e\u8bf4\u4ed6\u4e5f\u5728\u6d1b\u8c37~\n\n\u5e0c\u671b\u7ba1\u7406\u5458\u4e0d\u8981\u7206\u7834\uff0cwiki\u7684\u76ee\u7684\u6211\u60f3\u6839\u672c\u5728\u4e8e\u5206\u4eab\u548c\u4fc3\u8fdb\u5927\u5bb6\u66f4\u597d\u5730\u5199\u4ee3\u7801\uff0c\u8d21\u732e\u5206\u5565\u7684\u4e0d\u8981\u4e5f\u7f62\u3002\n\n\n##\u601d\u8def\n\n\u521d\u59cb\u7684\u60f3\u6cd5\u662f\u8bbe\u7f6e**f[i][j][k]\u8868\u793aA\u4e32\u524di\u4e2a\u5b57\u7b26\u91cc\uff0c\u4f7f\u7528\u4e86k\u4e2a\u5b50\u4e32\uff0c\u6765\u5339\u914d\u4e86B\u4e32\u524dj\u4e2a\u5b57\u7b26**\u3002\n\n\u6240\u4ee5\u53ef\u5217\u51fa\u6700\u57fa\u672c\u7684\u65b9\u7a0b**f[i][j][k]=f[i-1][j-1][k-1]+f[i-1][j-1][k]**\uff0c\u7ffb\u8bd1\u8fc7\u6765\u5c31\u662f\n\n**A\u4e32\u524di\u4e2a\u5b57\u7b26\u91cc\uff0c\u4f7f\u7528\u4e86k\u4e2a\u5b50\u4e32\uff0c\u5339\u914d\u4e86B\u4e32\u524dj\u4e2a\u5b57\u7b26\u7684\u65b9\u6848\u6570\uff0c\u7b49\u4ef7\u4e8e \u5355\u72ec\u4f7f\u7528\u7b2ci-1\u4e2a\u5b57\u7b26\u4f5c\u4e3a\u4e00\u4e2a\u5b50\u4e32\u7684\u65b9\u6848\u6570\u548c\u4e0d\u5355\u72ec\u4f7f\u7528\u7684\u65b9\u6848\u6570\uff08\u5305\u62ec\u4e0d\u4f7f\u7528\u548c\u548c\u524d\u9762\u8fde\u5728\u4e00\u8d77\uff09**\n\n\u4f46\u6b63\u5982\u62ec\u53f7\u91cc\u6240\u8bf4\uff0c\u8fd9\u4e2a\u9012\u5f52\u65b9\u7a0b**\u672a\u80fd\u89e3\u51b3\u4e0d\u4f7f\u7528\u548c\u548c\u524d\u9762\u8fde\u5728\u4e00\u8d77**\u7684\u95ee\u9898\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u6dfb\u52a0\u4e00\u7ef40/1\u7ef4\uff0c\u6765\u8868\u793a\u4f7f\u7528\u4e86\u5f53\u524d\u5b57\u7b26\u548c\u6ca1\u4f7f\u7528\u5f53\u524d\u7684\u5b57\u7b26\u3002\n\n\u6240\u4ee5\u52a8\u6001\u8f6c\u79fb\u65b9\u7a0b\u53d8\u6210\u4e86\u4e24\u4e2a\n\n- **f[i][j][k][0]=f[i-1][j][k][0]+f[i-1][j][k][1]**\uff0c\u7ffb\u8bd1\u662f \u5982\u679c\u7b2ci\u4f4d\u4e0d\u4f7f\u7528\uff0c\u90a3\u4e48\u65b9\u6848\u6570\u5c31\u662f \u7b2ci-1\u4f4d\u672a\u4f7f\u7528\u65f6\uff0c\u524di-1\u4f4d\u5339\u914d\u524dj\u4f4d\u4f7f\u7528k\u4e2a\u5b50\u4e32 + \u7b2ci-1\u4f4d\u4f7f\u7528\u65f6\uff0c\u524di-1\u4f4d\u5339\u914d\u524dj\u4f4d\u4f7f\u7528k\u4e2a\u5b50\u4e32\u3002\n\n\n- **\uff08a[i]==b[j]\uff09f[i][j][k][1]=f[i-1][j-1][k-1][0]+f[i-1][j-1][k][1]+f[i-1][j-1][k-1][1] \u7ffb\u8bd1\u662f \u5982\u679c\u7b2ci\u4f4d\u4f7f\u7528\uff0c\u610f\u5473\u7740a[i]==b[j]\uff0c\u90a3\u4e48\u65b9\u6848\u6570\u5c31\u662f \u7b2ci-1\u4f4d\u672a\u4f7f\u7528\u800c\u7b2ci\u4f4d\u4f5c\u4e3a\u4e00\u4e2a\u65b0\u5b50\u4e32 + \u7b2ci\u4f4d\u548c\u524d\u9762\u8fde\u5728\u4e00\u8d77\uff0c\u4e0d\u5355\u72ec\u4f7f\u7528 + \u7b2ci-1\u4f4d\u4f7f\u7528\u4e86\uff0c\u4f46\u7b2ci\u4f4d\u4ecd\u4f5c\u4e3a\u4e00\u4e2a\u65b0\u5b50\u4e32\u3002\n\n\n\u8fd9\u6837\u8f6c\u79fb\u65b9\u7a0b\u5c31\u51fa\u6765\u4e86\u3002\n\n\n\u6211\u4eec\u518d\u6765\u601d\u8003\u8fb9\u754c\u6761\u4ef6\u3002\u8fb9\u754c\u6761\u4ef6\u4e24\u79cd\u60c5\u51b5\u3002\n\n- \u5bf9\u4e8eA\u5b50\u4e32\u524di\u4f4d\uff0c\u5339\u914dB\u4e32\u7b2c1\u4e2a\u5b57\u7b26\uff0c\u90a3\u4e48\u53ea\u53ef\u80fd\u4f7f\u75281\u4e2a\u5b57\u7b26\u4e32\uff0c\u8fd9\u79cd\u60c5\u51b5\u5982\u679c\u7b2ci\u4f4d\u4e0d\u8fdb\u884c\u5339\u914d\uff0c\u90a3\u4e48\u65b9\u6848\u6570\u5c31\u662f\u4e4b\u524d\u6240\u6709\u80fd\u4e0e\u7b2c1\u4f4d\u5339\u914d\u7684\u5b57\u7b26\uff0c\u6240\u4ee5**f[i][1][1][0]=sum(a[1~i-1]==b[1])**\u3002\n\n\n- \u540c\u4e0a\uff0c\u4f46\u5982\u679cB\u4e32\u7b2c\u4e00\u4f4d\u548cA\u4e32\u7b2c\u4e00\u4f4d\u5339\u914d\u4e86\u8bdd\uff0c\u90a3\u4e48f[i][1][1][1]=1\u662f\u663e\u7136\u7684\u3002\n\n\n#\u7efc\u4e0a\u8f6c\u79fb\u65b9\u7a0b\n\n\n```cpp\n- **f[i][j][k][0]=f[i-1][j][k][0]+f[i-1][j][k][1]**\n- **\uff08a[i]==b[j]\uff09f[i][j][k][1]=f[i-1][j-1][k-1][0]+f[i-1][j-1][k][1]+f[i-1][j-1][k-1][1]**\n- **f[i][1][1][0]=sum(a[1~i-1]==b[1])**\n- **\uff08a[i]==b[1]\uff09f[i][1][1][1]=1 **\n```\n##\u7ec6\u8282\n###\u7a7a\u95f4\u590d\u6742\u5ea6\n\n\u8fd9\u4e2a\u9898\u5982\u679c\u5f001000\\*200\\*200\\*2\u7684\u8bdd\uff0c\u6390\u6307\u4e00\u7b97\u53ef\u5f97\u4f60\u9700\u8981\u5927\u7ea6300MB\u7a7a\u95f4\u2026\u2026\n\n\u4f46\u4e0d\u96be\u53d1\u73b0\uff0c\u65b9\u7a0b\u91cc\u53ea\u6709i\u548ci-1\u88ab\u6765\u56de\u8c03\u7528\uff0c\u5176\u4f59\u4f8b\u5982i-2\uff0ci-3\u5728\u63a5\u4e0b\u6765\u7684\u52a8\u6001\u89c4\u5212\u91cc\u90fd\u5e9f\u4e86\uff0c\u6240\u4ee5\u90a3\u4e9b\u7a7a\u95f4\u662f\u4e0d\u9700\u8981\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u628a**\u6570\u7ec4\u6eda\u52a8**\u8d77\u6765\u3002\n\n\u6211\u4eec\u5f00\u4e00\u4e2af[2][201][201][2]\uff08p\u515a\u8bf7\u81ea\u884c\u8bbe\u7f6e\u4e3a0~x\uff09\n\n\u4f7f\u7528\u4e00\u4e2anow\u548c\u4e00\u4e2apre\u53d8\u91cf\uff0c\\_\\_\u8c01\u4e3a1\u8c01\u4e3a0\u65e0\u6240\u8c13\\_\\_\uff0c\u53ea\u8981**\u6539\u53d8i\u5c31\u4ea4\u6362**\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u8fd9\u6837\u7a7a\u95f4\u91cf\u7f29\u5c0f\u81f31/50\uff0c6MB\u5c31\u591f\u4e86\u3002\n\n###\u6e05\u7a7a\u6eda\u52a8\u6570\u7ec4\n\n\u6211\u5f00\u59cb\u5199\u5230\u8fd9\u91cc\u65f6\uff0c\u600e\u4e48\u60f3\u90fd\u89c9\u5f97\u5e94\u8be5\u8fc7\u4e86\uff0c\u4f46\u6837\u4f8b\u90fd\u6316\u3002\n\n\u540e\u6765\u4ed4\u7ec6\u4e00\u60f3\uff0c\u660e\u767d\u4e86\uff0c\u6eda\u52a8\u6570\u7ec4\u7684\u65f6\u5019\uff0c\u53ef\u80fd\u5b58\u5728\u672c\u5e94\u8be5f[i][1][1][1]=0\u7684\u4f4d\u7f6e\uff0c\u53d8\u4e3a\u4e861\uff08\u770b\u4e0b\u9762\u7684\u4ee3\u7801\u4f60\u5c31\u660e\u767d\u4e86\uff09\uff0c\u4f46\u8fd9\u4e2a\u4f4d\u7f6e\u53ef\u80fd\u65e0\u6cd5\u88ab\u63a5\u4e0b\u6765\u7684\u52a8\u89c4\u8986\u76d6\u6389\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u4f4d\u7f6e\u6839\u636e\u65b9\u7a0b\uff0c\u4ec5\u5f53a[i]==b[1]\u65f6\u624d\u4f1a\u66f4\u65b0\uff0c\u800c\u4e14\u66f4\u65b0\u7684\u503c\u59cb\u7ec8\u4e3a1\uff0c\u53d8\u4e0d\u56de0\u3002\n\n\u6240\u4ee5\uff0c\u5728\u4e00\u904d\u52a8\u89c4\u5b8c\u6210\u4e4b\u540e\uff0c\u5fc5\u987b\u8981\u628af[pre]\u6e050\u3002\n\n###\u53d6\u6a21\n\n\u52a0\u6cd5\u6a21\u8fd0\u7b97\u5c0f\u5b66\u751f\u96be\u5ea6\uff0c\u4f46\u662f\u2026\u2026\u672c\u50bb\u74dc\u5199\u5230\u6700\u540e\u4e86\u5fd8\u4e86\u5199\u6a21\u7b2c\u4e00\u904d\u6ea2\u51fa\u4e86\uff01\u53ea\u5f97\u4e8650\u5206\u2026\u2026\n\n\n##\u590d\u6742\u5ea6\n\n\u7a7a\u95f4\u590d\u6742\u5ea6O\uff08mk)\n\n\u65f6\u95f4\u590d\u6742\u5ea6O\uff08nmk\uff09\n\n\u597d\u5427\uff0c4\\*10^8\uff0c\u52c9\u5f3a\u80fd\u8fc7\uff0c\u6700\u540e\u4e00\u4e2a\u70b9600ms\uff0c\u4e5f\u4e0d\u7b97\u5dee\u3002\n\n\n##\u4ee3\u7801\n\n```cpp\n#include<cstdio>\n#include<iostream>\n#define prime 1000000007\nusing namespace std;\nchar a[1001],b[201];\nint n,m,t,f[2][201][201][2],s,now,pre=1;//s\u662f\u7528\u6765\u8bb0\u5f55\u4e4b\u524d\u6709\u591a\u5c11\u4e2aA\u4e32\u5b57\u7b26\u80fd\u548cB\u4e32\u7b2c\u4e00\u4e2a\u5b57\u7b26\u5339\u914d\nint main(){\n    scanf(\"%d%d%d\",&n,&m,&t);\n    scanf(\"%s%s\",a+1,b+1);//\u5410\u69fd\uff1a\u8fd9\u4e2a\u5947\u8469\u7684\u8bfb\u5165\u6211\u4ee5\u524d\u4e00\u76f4\u6ca1\u7528\u8fc7...\n    for (int i=1;i<=n;i++){\n        swap(now,pre); //\u4ea4\u6362\uff0c\u53ea\u8981i\u6539\u53d8\n        f[now][1][1][0]=s;//\u8fb9\u754c1\n        if (a[i]==b[1]) f[now][1][1][1]=1,s++;//\u8fb9\u754c2\uff0c\u89e3\u51b3\u4e86s\u7edf\u8ba1\u7684\u95ee\u9898\n        for (int j=2;j<=m;j++){\n            for (int k=1;k<=t;k++){\n                if (a[i]==b[j]){\n                    f[now][j][k][1]=((f[pre][j-1][k-1][1]+f[pre][j-1][k][1])%prime+f[pre][j-1][k-1][0])%prime;\n                }//\u65b9\u7a0b2\n                f[now][j][k][0]=(f[pre][j][k][0]+f[pre][j][k][1])%prime;//\u65b9\u7a0b1\n            }\n        }\n    for(int j=1;j<=m;j++)\n          for(int k=1;k<=t;k++)\n            f[pre][j][k][1]=f[pre][j][k][0]=0;//\u6e05\u7a7a\n    }\n    printf(\"%d\",(f[now][m][t][1]+f[now][m][t][0])%prime);\n    return 0; \n}\n```",
        "postTime": 1477799958,
        "uid": 26096,
        "name": "CRyan",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\u4e00\u4e2a\u80fd\u8017\u6211\u597d\u51e0\u4e2a\u5c0f\u65f6\u7684\u666e\u901adp\u3002\u6211\u611f\u89c9\u6211\u5728\u505a\u8fd9\u9898\u65f6\uff0c\u4e00\u5f00\u59cb\u5927\u90e8\u5206\u65f6\u95f4\u505a\u7684\u90fd\u662f\u65e0\u7528\u529f\uff0c\u9009\u62e9\u4e00\u79cd\u5408\u9002\u7684\u65b9\u6cd5\u5165\u624b\u624d\u76f8\u5f53\u4e8e\u771f\u6b63\u5f00\u59cb\u505a\u8fd9\u9898\uff0c\u5f53\u7136\u627e\u5bf9\u4e86\u5207\u5165\u70b9\u8fd9\u9898\u5c31\u4e00\u70b9\u4e0d\u96be\u3002\n\n\u5bf9\u4e8e\u7ebf\u6027\u7ed3\u6784\u4e0a\u7684dp\uff0c\u53d1\u73b0\u81ea\u5df1\u590d\u6742\u5ea6\u8d85\u4e86\uff0c\u8981\u4e48\u662f\u65b9\u7a0b\u4e0d\u5408\u7406\uff0c\u8981\u4e48\u662f\u53ef\u4ee5\u4f18\u5316\u8f6c\u79fb\u3002\u800c\u8fd9\u9898\u5173\u952e\u5c31\u662f\u4f18\u5316\u8f6c\u79fb\u3002\n\n#### \u9898\u610f\n\n\u7ed9\u5b9a2\u4e2a\u5b57\u7b26\u4e32$A$,$B$\uff0c\u6c42\u6709\u591a\u5c11\u79cd\u65b9\u6848\uff0c\u5c06$B$\u5206\u6210$k$\u6bb5\uff0c\u4f7f\u5f97\u8fd9\u4e9b\u6bb5\u5728$A$\u4e2d\u4f9d\u6b21\u51fa\u73b0\u3002\n\n#### 70pts\n\n\u9996\u5148\u66b4\u529b\u80af\u5b9a\u662f\u4e0d\u884c\u7684\uff0c\u6c42\u65b9\u6848\u6570\u663e\u7136\u9700\u8981dp\n\n\u6709\u70b9\u7ecf\u9a8c\u7684\u5e94\u8be5\u80fd\u7acb\u5373\u60f3\u51fadp\u6570\u7ec4\uff1a$f[i][j][p]$\u8868\u793a$A$\u5230$i$\uff0c$B$\u7528\u5b8c\u4e86\u524d$j$\u4e2a\uff0c\u5206\u6210\u4e86$p$\u6bb5\uff0c\u5e76\u4e14$A_i$\u662f\u6700\u540e\u4e00\u4e2a\u5339\u914d\u7684\u5b57\u7b26\u3002\uff08$p$\u4e0d\u4e0e\u9898\u76ee\u4e2d\u7684$k$\u91cd\u590d\uff09\n\n\u5982\u679c\u8fd9\u65f6\u5c31\u7528\u6700\u5927\u6570\u636e\u5f00\u6570\u7ec4\uff0c\u5c31\u4f1a\u53d1\u73b0\u7a7a\u95f4\u663e\u7136\u4e0d\u591f\u3002\u4f46\u5bf9\u4e8e70pts\u505a\u6cd5\uff0c\u4e0d\u9700\u8981\u7ba1\uff0c\u53ea\u7528\u5f00\u524d7\u4e2a\u70b9\u591f\u7528\u7684\u6570\u7ec4\u3002\n\n\u53ef\u4ee5\u4e0d\u5fc5\u4e00\u4e0a\u6765\u5c31\u8003\u8651\u6807\u7b97\u7684\u505a\u6cd5\uff0c\u56e0\u4e3a\u6bd4\u5982\u8fd9\u9898\u5c31\u662f\u9760\u8f6c\u79fb\u4f18\u5316\u6765\u5b9e\u73b0\u6807\u7b97\u590d\u6742\u5ea6\u7684\u3002\n\n\u7136\u540e\u6211\u4eec\u8003\u8651dp\u65b9\u7a0b\u548c\u8f6c\u79fb\u3002\u6839\u636e\u6570\u7ec4\u8868\u793a\uff0c$f[i][j][p]$\u4e0d\u4e3a0\uff0c\u5f53\u4e14\u4ec5\u5f53$A_i=B_j$\u3002\u5982\u679c\u6ee1\u8db3\u8fd9\u4e2a\u6761\u4ef6\uff0c\u90a3\u4e48\u5c31\u80fd\u679a\u4e3e\u65ad\u70b9\u8fdb\u884c\u8f6c\u79fb\u4e86\uff08\u53ef\u4ee5\u4e00\u6b21\u6027\u5339\u914d$B$\u4e2d\u8fde\u7eed\u591a\u4e2a\u5b57\u7b26\uff09\u3002\u5047\u8bbe\u5df2\u7ecf\u6210\u529f\u4ece$A_{i-L+1}$\u548c$B_{j-L+1}$\u5f00\u59cb\u5339\u914d\uff0c\u90a3\u4e48\u4e0a\u4e00\u6b21\u5728$A$\u4e2d\u53d6\u4e32\u7684\u6700\u540e\u4f4d\u7f6e\u53ef\u4ee5\u5728$[1,i-L]$\u4efb\u53d6\u3002\n\n\u9700\u8981\u7528\u6570\u7ec4$g[i][j][p]$\u8868\u793a\u5173\u4e8e$i$\u7684\u524d\u7f00\u548c\uff0c\u65b9\u7a0b\u4e3a\uff1a$f[i][j][p]=\\sum_Lg[i-L][j-L][p-1]$\uff0c\u5176\u4e2d$L$\u4e3a$A$\u7684\u524d$i$\u9879\u3001$B$\u7684\u524d$j$\u9879\u7684\u516c\u5171\u540e\u7f00\u957f\u5ea6\uff08\u4e0d\u4e00\u5b9a\u6700\u957f\uff0c\u53ea\u8981\u5f53$A_i=B_j$\u65f6\u5faa\u73af\u4e0b\u53bb\u5c31\u884c\u4e86\uff09\u3002\u60f3\u4e0d\u51fa\u524d\u7f00\u548c\u6211\u4e5f\u6ca1\u529e\u6cd5\u3002\u5e94\u8be5\u53ea\u8981\u60f3\u5230\u679a\u4e3e\u65ad\u70b9\u7684\u65b9\u6cd5\uff0c\u8f6c\u79fb\u65b9\u7a0b\u5c31\u80fd\u51fa\u6765\u4e86\u3002\n\n\u6700\u574f\u590d\u6742\u5ea6\u4e3a$O(nm^2k)$\n\n\u53ef\u89c1\u51fa\u9898\u4eba\u5f88\u826f\u5fc3\uff0c\u9001\u4e86\u6211\u4eec\u8fd9\u4e48\u591a\u5206\u3002\n\n```cpp\n\tfor (int i=1;i<=n;i++) {\n        g[i-1][0][0]=1;\n        for (int j=1;j<=m && j<=i;j++) {\n            for (int p=1;p<=k && p<=j;p++) { //\u6bb5\u6570\n                for (int l=0;l<i && l<j && a[i-l]==b[j-l];l++) { //\u679a\u4e3e\u65ad\u70b9\n                    (f[i][j][p]+=g[i-l-1][j-l-1][p-1])%=MOD;\n                }\n                g[i][j][p]=(g[i-1][j][p]+f[i][j][p])%MOD;\n            }\n        }\n    }\n```\n\n#### 100pts\n\n\u663e\u7136\u4e3a\u4e86\u4f18\u5316\u590d\u6742\u5ea6\uff0c\u5f97\u53bb\u6389\u679a\u4e3e$L$\u7684\u8fc7\u7a0b\u3002\u5bf9$g$\u6570\u7ec4\u6c42\u524d\u7f00\u548c\uff1f\u5e94\u8be5\u53ef\u4ee5\u8fd9\u6837\u505a\uff0c\u4f46\u5e76\u4e0d\u9700\u8981\u3002\u6392\u9664\u6389$A_i\u2260B_j$\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u53d1\u73b0\u6c42\u548c\u7684\u5c55\u5f00\u5f0f\u4e2d\uff0c$f[i][j][p]$\u7684\u6070\u597d\u6bd4$f[i-1][j-1][p]$\u7684\u591a\u4e86\u4e00\u9879$g[i-1][j-1][p-1]$\uff08\u56e0\u4e3a\u6700\u957f\u516c\u5171\u540e\u7f00\u957f\u5ea6\u589e\u52a0\u4e861\uff09\uff0c\u90a3\u4e48\u53ef\u4ee5\u76f4\u63a5\u8fd9\u6837\u8f6c\u79fb\uff1a\n\n$$f[i][j][p]=\\begin{cases}  0 & A_i\u2260B_j\\\\f[i-1][j-1][p]+g[i-1][j-1][p-1] & A_i=B_j\\end{cases}$$\n\n\u590d\u6742\u5ea6\u4e3a$O(nmk)$\n\n\u5230\u8fd9\u91cc\u5df2\u7ecf\u57fa\u672c\u4e0a\u89e3\u51b3\u95ee\u9898\u4e86\uff0c\u53ea\u9700\u8981\u8003\u8651\u4f18\u5316\u7a7a\u95f4\uff0c\u5373\u4f7f\u7528\u6eda\u52a8\u6570\u7ec4\u3002$n$,$m$,$k$\u57fa\u672c\u4e0a\u540c\u7ea7\uff0c\u4e14\u8f6c\u79fb\u53ea\u6d89\u53ca\u76f8\u90bb\u9879\uff0c\u6839\u636e\u65b9\u7a0b\uff0c\u5e94\u8be5\u968f\u4fbf\u6eda\u54ea\u4e2a\u90fd\u884c\u3002\u8fd9\u91cc\u6211\u9009\u62e9\u6eda\u6389$i$\u8fd9\u7ef4\u3002\u6eda\u52a8\u67093\u79cd\u65b9\u6cd5\uff0c\u7b2c1\u79cd\u662f\u6839\u636e\u8f6c\u79fb\u987a\u5e8f\u8986\u76d6\u6389\u4e4b\u524d\u7684\u6570\u636e\uff08\u6bd4\u8f83\u5371\u9669\u4f46\u5f88\u4f18\u7f8e\uff09\uff0c\u7b2c2\u79cd\u662f\u75282\u4e2a\u6307\u9488\u4ea4\u66ff\u5b9a\u4f4d\uff0c\u7b2c3\u79cd\u662f\u5bf9\u4e0b\u6807$i$\u53d6\u6a21\uff08\u63a8\u8350\uff0c\u53ea\u4e0d\u8fc7\u770b\u4e0a\u53bb\u6709\u70b9**\uff09\u3002\n\n\u8fd9\u91cc\u6211\u7528\u50cf01\u80cc\u5305\u90a3\u6837\u5012\u7740\u5faa\u73af\u7684\u65b9\u6cd5\uff0c\u7406\u8bba\u4e0a$j$,$p$\u90fd\u9700\u8981\u5012\u7740\uff0c\u4f46\u5b9e\u6d4b$j$\u5012\u7740\u5c31\u884c\u4e86\u3002\n\n\u96be\u5f97\u7684\u4ee3\u7801\u7279\u522b\u77ed\u7684\u9898\u3002\u4e0d\u77e5\u4e3a\u4f55\u8bc4\u6d4b\u6392\u540d\u8fdb\u5165\u7b2c2\u9875\u3002\n\n```cpp\n#include <cstdio>\n#define MAXN 1010\n#define MAXM 210\nusing namespace std;\nconst int MOD=1e9+7;\nint n,m,k;\nchar a[MAXN],b[MAXM];\nint f[MAXM][MAXM]; //a\u5230n, b\u5230m, \u53d6\u4e86k\u4e32\nint g[MAXM][MAXM]; //f\u7684\u524d\u7f00\u548c\ninline int min(int a,int b) { return a<b ? a : b; }\nint main() {\n    scanf(\"%d%d%d\",&n,&m,&k);\n    scanf(\"%s%s\",a+1,b+1);\n    g[0][0]=1;\n    for (int i=1;i<=n;i++) {\n        for (int j=min(m,i);j>=1;j--) {\n            for (int p=min(k,j);p>=1;p--) {\n                f[j][p]=a[i]==b[j] ? (f[j-1][p]+g[j-1][p-1])%MOD : 0;\n                g[j][p]=(g[j][p]+f[j][p])%MOD;\n            }\n        }\n    }\n    printf(\"%d\\n\",g[m][k]);\n    return 0;\n}\n```\n",
        "postTime": 1536834354,
        "uid": 32771,
        "name": "\u554a\u561e\u561e\u561e\u561e",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "#  \u849f\u84bb\u8868\u793a\u7814\u7a76DP\u65b9\u7a0b\u5f88\u4e45\u7684\u8bf4\n\n\u5c3d\u7ba1\u5404\u4f4d\u5927\u4f6c\u90fd\u89c9\u5f97\u6b64\u9898DP\u65b9\u7a0b\u5f88\u7b80\u5355\n\n\u4f46\u662f\u53ef\u80fd\u4e5f\u4f1a\u6709\u50cf\u6211\u8fd9\u6837\u7684\u849f\u84bb\u770b\u7684\u4e0d\u662f\u5f88\u61c2\n\n\u4e8e\u662f\u5728\u849f\u84bb\u7814\u7a76\u4e86\u5f88\u4e45\u4e4b\u540e\uff0c\u7ec8\u4e8eAC\u4e86\n\n\u4e4b\u540e\u849f\u84bb\u5c06\u4f1a\u4ece\u52a8\u89c4\u7684\u4e09\u8981\u7d20\u8bb2\u8d77\n\n## \u5173\u4e8e\u9636\u6bb5\n\n\u7531\u9898\u53ef\u77e5\uff0c\u9636\u6bb5\u5e94\u5982\u6b64\u5212\u5206\uff08~~\u849f\u84bb\u8ba4\u4e3a~~\uff09\n\nA\u4e32\u7684\u7b2ci\u4f4d \u5339\u914d\u5230\u4e86B\u4e32\u7b2cj\u4f4d \u4f7f\u7528\u4e86p\u4e2a\u5b50\u4e32\n\n\uff08\u5e94\u8be5\u53ef\u4ee5\u7406\u89e3\u5427\uff09\n\n\n\u81f3\u4e8e\u4e3a\u4ec0\u4e48\uff1f\u54b1\u4eec\u770b\u770b\u9898\u76ee\n\n\u4eceA\u4e32\u4e2d\u53d6\u51fak\u4e2a\u4e92\u4e0d\u91cd\u53e0\u7684\u975e\u7a7a\u5b50\u4e32\uff0c\u628a\u8fd9k\u4e2a\u5b50\u4e32\u6309\u7167\u51fa\u73b0\u7684\u987a\u5e8f\u4f9d\u6b21\u8fde\u63a5\u8d77\u6765\u5f97\u5230\u4e00\u4e2a\u65b0\u7684\u5b57\u7b26\u4e32\uff0c\u5e76\u4f7f\u5f97\u8fd9\u4e2a\u65b0\u4e32\u4e0eB\u4e32\u76f8\u7b49\n\n\u55ef\u55ef\u55ef\uff0c\u6211\u76f8\u4fe1\u5404\u4f4d\u90fd\u61c2\u4e86\u5427\n\n## \u5173\u4e8e\u72b6\u6001\n\n\t\u72b6\u6001\u4e00\uff1a A\u4e32\u7b2ci\u4f4d\u5b57\u7b26\n\n\t\u72b6\u6001\u4e8c\uff1a B\u4e32\u7b2cj\u4f4d\u5b57\u7b26\n\n\t\u72b6\u6001\u4e09\uff1a \u5f53\u524d\u4f7f\u7528\u7684\u5b50\u4e32\u6570p\uff08\u6ce8\u610fp<=k\uff09\n\n\t\u4ee5\u53ca \u72b6\u6001\u56db\uff1aa[i]\u662f\u5426\u80fd\u5339\u914d\u5f97\u4e0ab[j]\n\n\t\u8fd8\u6709\u72b6\u6001\u4e94\uff0c\u4f46\u662f\u8fd9\u4e2a\u7a0d\u4f5c\u60ac\u5ff5\uff0c\u4e0b\u4e00\u680f\u518d\u8fdb\u4e00\u6b65\u5206\u6790\n\n## \u5173\u4e8e\u51b3\u7b56\n\n\t\u4f46\u662f\u7531\u4e8e\u72b6\u6001\u56db\u7684\u4e0d\u786e\u5b9a\u6027\uff0c\u5f97\u5206\u4e24\u79cd\u60c5\u51b5\n\n\t1.a[i]=b[j]\u65f6\n\t\n    \u51b3\u7b56\u4e00\uff1a\u4f7f\u7528\u8be5\u5b57\u7b26\u5339\u914d\n    \n    \u51b3\u7b56\u4e8c\uff1a\u4e0d\u4f7f\u7528\u8be5\u5b57\u7b26\u5339\u914d\n    \n\t2.a[i]!=b[j]\u65f6\n\n\t\u53ea\u80fd\u4e0d\u4f7f\u7528\u8be5\u5b57\u7b26\u5339\u914d\n\n\t\u7531\u6b64\u53ef\u89c1\uff0c\u72b6\u6001\u4e94\u4fbf\u534e\u4e3d\u4e3d\u5730\u767b\u573a\u4e86\n\n\t\u90a3\u5c31\u662f \u662f\u5426\u4f1a\u4f7f\u7528\u8be5\u5b57\u7b26\n\n\t\u6211\u4eec\u53ef\u4ee5\u75280\u8868\u793a\u4e0d\u4f7f\u7528\uff0c1\u8868\u793a\u4f7f\u7528\n\n## \u7efc\u4e0a\u6240\u8ff0 \u5f97\u51fa\u52a8\u6001\u8f6c\u79fb\u65b9\u7a0b\n\n\t1.a[i]=b[j]\u65f6\n\n\t\u51b3\u7b56\u4e00\uff1af[i][j][p][1]=f[i-1][j-1][p][1]+f[i-1][j-1][p-1][0]+f[i-1][j-1][p-1][1]\n    \n\uff08~~\u4ee3\u7801\u91cc\u4e5f\u6709\u89e3\u91ca\uff0c\u4e0d\u8fc7\u4e0d\u662f\u5f88\u8be6\u5c3d~~\uff09\n\n\t\u5bf9\u4e8e\u4e0a\u8ff0\u7684\u6570\u7ec4\u89e3\u91ca\u5982\u4e0b\n    \n\tf[i][j][p][1]:A\u4e32\u524di\u4e2a\u4f7f\u7528\u4e86k\u4e2a\u5b50\u4e32\u5339\u914d\u5230B\u4e32\u524dj\u4e2a\uff0c\u5e76\u4e14\u4f7f\u7528\u4e86\u5f53\u524da[i]\u7684\u79cd\u6570 \n    \n\tf[i-1][j-1][p][1]:\u5c06\u5f53\u524d\u5b57\u7b26\u7eb3\u5165\u524d\u4e00\u4e2a\u5b50\u4e32\uff0c\u5e76\u4f7f\u7528\u524d\u4e00\u4e2a\u5b57\u7b26\u7684\u79cd\u6570 \n    \n\tf[i-1][j-1][p-1][0]:\u5c06\u5f53\u524d\u5b57\u7b26\u7eb3\u5165\u65b0\u5b50\u4e32\uff0c\u4f46\u4e0d\u4f7f\u7528\u524d\u4e00\u4e2a\u5b57\u7b26\u7684\u79cd\u6570 \n    \n\tf[i-1][j-1][p-1][1]:\u5c06\u5f53\u524d\u5b57\u7b26\u7eb3\u5165\u65b0\u5b50\u4e32\uff0c\u5e76\u4f7f\u7528\u524d\u4e00\u4e2a\u5b57\u7b26\u7684\u79cd\u6570\n    \n\u5bf9\u4e8e\u4e0a\u8ff0\u65b9\u7a0b\u7684\u89e3\u91ca\uff1a\n    \n\u5c06\u8be5\u5b57\u7b26\u7eb3\u5165\u524d\u4e00\u4e2a\u5b50\u4e32\u7b97\u4e00\u79cd\u60c5\u51b5\uff08\u56e0\u4e3a\u7eb3\u5165\u524d\u4e00\u4e2a\u5b50\u4e32\uff0c\u6545\u80af\u5b9a\u662f\u4f7f\u7528\uff09\n    \n\u5c06\u8be5\u5b57\u7b26\u5355\u72ec\u770b\u6210\u4e00\u4e2a\u65b0\u5b50\u4e32\u7b97\u4e00\u79cd\uff0c\u800c\u770b\u6210\u4e00\u4e2a\u65b0\u5b50\u4e32\uff0c\u53c8\u5206\u4e24\u79cd\uff1a\u7b2c\u4e00\u79cd\u662f\u4e0d\u4f7f\u7528\u524d\u4e00\u4e2a\u5b57\u7b26\uff0c\u7b2c\u4e8c\u79cd\u662f\u4e0d\u4f7f\u7528\u524d\u4e00\u4e2a\u5b57\u7b26\u3002\uff08\u56e0\u4e3a\u662f\u65b0\u5b50\u4e32\uff0c\u6240\u4ee5\u524d\u4e00\u4e2a\u5b57\u7b26\u4e0e\u5f53\u524d\u5b57\u7b26\u662f\u72ec\u7acb\u7684\uff0c\u6240\u4ee5\u6709\u4e24\u79cd\uff09\n    \n    \u51b3\u7b56\u4e8c:f[i][j][p][0]=f[i-1][j][p][1]+f[i-1][j][p][0]\n       \n\u672a\u4f7f\u7528\u8be5\u5b57\u7b26\uff0c\u6545B\u5b50\u4e32\u5339\u914d\u6570\u4ecd\u4e3aj\uff0c\u5b50\u4e32\u4ecd\u4e3ak.\n    \n\u672a\u4f7f\u7528\u8be5\u5b57\u7b26\u7684\u79cd\u6570\u5373\u524d\u4e00\u4e2a\u5b57\u7b26\u4f7f\u7528\u7684\u79cd\u6570+\u524d\u4e00\u4e2a\u5b57\u7b26\u672a\u4f7f\u7528\u7684\u79cd\u6570(\u7ee7\u627f\u4e0a\u4e00\u9636\u6bb5\u7684\uff09\n\n\t2.a[i]!=b[j]\u65f6\n\n\tf[i][j][p][1]=0\n    \n\u4e0d\u80fd\u4f7f\u7528\u8be5\u5b57\u7b26\uff0c\u6240\u4ee5\u4e3a0\n    \n\tf[i][j][p][0]=f[i-1][j][p][1]+f[i-1][j][p][0];\n    \n\u56e0\u4e3a\u4e0d\u80fd\u4f7f\u7528\u8be5\u5b57\u7b26\uff0c\u6240\u4ee5\u4fbf\u7ee7\u627f\u4e0a\u4e00\u9636\u6bb5\u7684\u503c\n\n## \u63d0\u9192\n\n\t\u6570\u7ec4 1000 * 200 * 200 * 2\u80af\u5b9a\u4f1a\u7206\uff0c\u6545\u6eda\u52a8\u7b2c\u4e00\u7ef4\uff08\u56e0\u4e3a\u7b2c\u4e00\u7ef4\u53ea\u6709i\u548ci-1\uff09\n\n\t\u6700\u540e\u7b54\u6848\u5e94\u8be5\u4e3af[n][m][k][1]+f[n][m][k][0]\u76f8\u52a0\n    \n    \uff08\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u4f7f\u7528\u548c\u4e0d\u4f7f\u7528\u662f\u4e24\u79cd\u60c5\u51b5\u561b\uff0c\u6700\u7ec8\u7b54\u6848\u5e94\u8be5\u662f\u4ed6\u4eec\u4e4b\u548c\uff09\n\n## \u4e0a\u4ee3\u7801\n\n\u4e8e\u662f\uff0c\u5404\u4f4d\u6700\u7231\u7684\u4ee3\u7801\u4e0a\u7ebf\u4e86\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\nusing namespace std;\nint md=1000000007;\nint n,m,k,f[2][222][222][2];\nchar a[1001],b[201];\nint main()\n{\n\tint i,j,p;\n\tscanf(\"%d%d%d\",&n,&m,&k);\n\tfor(i=1;i<=n;i++)\n\t\tcin>>a[i];\n\tfor(i=1;i<=m;i++)\n\t\tcin>>b[i];\n\tf[0][0][0][0]=1;\n\tf[1][0][0][0]=1;//\u521d\u59cb\u5316\uff0c\u5426\u5219\u4e4b\u540e\u90fd\u5f97\u662f0\n\tfor(i=1;i<=n;i++)\n\t\tfor(j=1;j<=m;j++)\n\t\t\tfor(p=1;p<=k;p++)\n\t\t\t{\n\t\t\t\tif(a[i]==b[j])\n\t\t\t\t{\n\t\t\t\t\tf[i%2][j][p][1]=(f[(i-1)%2][j-1][p][1]+f[(i-1)%2][j-1][p-1][0])%md+f[(i-1)%2][j-1][p-1][1]%md;\n\t\t\t\t\t//f[i-1][j-1][p][1]:\u5c06\u5f53\u524d\u5b57\u7b26\u7eb3\u5165\u524d\u4e00\u4e2a\u5b50\u4e32\uff0c\u5e76\u4f7f\u7528\u524d\u4e00\u4e2a\u5b57\u7b26\u7684\u79cd\u6570 \n\t\t\t\t\t//f[i-1][j-1][p-1][0/1]:\u5c06\u5f53\u524d\u5b57\u7b26\u7eb3\u5165\u65b0\u5b50\u4e32\uff0c\u4f46\u4e0d\u4f7f\u7528\uff08\u4f7f\u7528\uff09\u524d\u4e00\u4e2a\u5b57\u7b26\u7684\u79cd\u6570 \n\t\t\t\t\tf[i%2][j][p][1]%=md;\n\t\t\t\t\tf[i%2][j][p][0]=f[(i-1)%2][j][p][1]+f[(i-1)%2][j][p][0];\n\t\t\t\t\t//\u672a\u4f7f\u7528\u8be5\u5b57\u7b26\u7684\u79cd\u6570\u5373\u524d\u4e00\u4e2a\u5b57\u7b26\u4f7f\u7528\u7684\u79cd\u6570+\u524d\u4e00\u4e2a\u5b57\u7b26\u672a\u4f7f\u7528\u7684\u79cd\u6570 \n\t\t\t\t\tf[i%2][j][p][0]%=md;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tf[i%2][j][p][0]=f[(i-1)%2][j][p][1]+f[(i-1)%2][j][p][0];\n\t\t\t\t\tf[i%2][j][p][0]%=md;\n\t\t\t\t\tf[i%2][j][p][1]=0;//\u4e0d\u80fd\u4f7f\u7528\u8be5\u5b57\u7b26\n\t\t\t\t } \n\t\t\t}\n\tprintf(\"%d\",(f[n%2][m][k][1]+f[n%2][m][k][0])%md);\n\treturn 0;\n}\n```",
        "postTime": 1570434875,
        "uid": 99959,
        "name": "\u516b\u91cd\u6a31\u98de",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "# \u900f\u5f7b\u662f\u591a\u4e48\u91cd\u8981\n\n\u4eca\u5929\u8003\u8bd5\u63a8\u4e86\u534a\u5929\u7684\u65b9\u7a0b \u6ca1\u6709\u63a8\u51fa\u6765  \uff08\u220f_\u220f\uff09\n\n\u849f\u84bb\u5df2\u65e0\u8bed dalao\u72c2\u9119\u89c6\n\n------------------------------------\u5410\u69fd\u65f6\u95f4----------------------------------------\n\n\u9996\u5148 \u8fd9\u9053\u9898\u770b\u4e0a\u53bb\u662f\u4e00\u9053\u5b57\u7b26\u4e32\u5339\u914d\u9898 AC\u81ea\u52a8\u673aorKMP\n\n\u53ef\u662f \u518d\u591a\u770b\u770b\u9898\u9762 **\u4e0d\u662f**\n\n\u6211\u4eec\u60f3\u5230\u4e86\u4ec0\u4e48 DP\n\n\u8003\u8651\u5f53\u524d\u5339\u914d\u6210\u529f\u4e0e\u5339\u914d\u4e0d\u6210\u529f\n\n\u5206\u522b\u7528 \n\nans[i][j][k] \u8bb0\u5f55\u5f53\u524d A[i]\u4e0d\u8bba\u7b49\u4e0d\u7b49\u4e8eB[j] \u6211\u4eec\u53ef\u4ee5\u9009\u7528\u4e5f\u53ef\u4ee5\u4e0d\u9009\u7528 \u4f7f\u7528k\u4e2a\u5b50\u4e32\u65b9\u6848\u6570\n\nres[i][j][k] \u8bb0\u5f55\u5f53\u524d A[i]==B[j] \u5e76\u4e14\u6211\u4eec\u9009\u7528A[i]\u548cB[j] \u65b9\u6848\u6570 \u4f7f\u7528k\u4e2a\u5b50\u4e32\u65b9\u6848\u6570\n\n\u5f97\u5230\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\n\n```cpp\nif(A[i]==B[j])\n  res[i][j][k]=(ans[i-1][j-1][k-1]+res[i-1][j-1][k])%mod;\n//ans[i-1][j-1][k-1] \u6211\u4eec\u628a\u5f53\u524d\u5339\u914d\u5b57\u7b26\u5355\u72ec\u7b97\u505a\u4e00\u4e2a\u5b50\u4e32\n//res[i-1][j-1][k] \u6211\u4eec\u628a\u5f53\u524d\u5339\u914d\u5b57\u7b26\u4e0e\u4e0a\u9762\u7684\u548c\u4e3a\u4e00\u4e2a\u5b50\u4e32\n\nelse res[i][j][k]=0;\n//\u4e0d\u6210\u5219\u4e3a\u96f6\n\nans[i][j][k]=(res[i][j][k]+ans[i-1][j][k])%mod;\n//res[i][j][k] \u4f7f\u7528\u5f53\u524d\u5b57\u7b26\n//ans[i-1][j][k] \u4e0d\u4f7f\u7528\u5f53\u524d\u5b57\u7b26\n\n```\n\n\u8c8c\u4f3c\u4e00\u5207\u5927\u5409\u4e86\uff1f\uff1f\n\n\u53ef\u662f ans[1000][20][20]\n\n\u4fdd\u5e95\u90fd\u5f00\u4e0d\u4e0b \u66f4\u4f55\u51b5\u8fd8\u8981\u5f00\u5927\u4ee5\u9632\u6b62RE\n\n\u8003\u8651[\u6eda\u52a8\u6570\u7ec4](https://www.cnblogs.com/GNLin0820/p/6434693.html)\n\n```\nif(A[i] == B[j]) \nres[now][j][p]=(res[now^1][j-1][p]+ans[now^1][j-1][p-1])%mod;\nelse res[now][j][p]=0; \nans[now][j][p]=(ans[now^1][j][p]+res[now][j][p])%mod;\n```\n\n\u56e0\u4e3a\u72b6\u6001\u8f6c\u79fb\u65f6 \u53ea\u9700\u8c03\u7528 i and i-1\n\n\u6240\u4ee5\u53ea\u9700\u57281\u548c0\u4e4b\u95f4\u6eda\u52a8\u5373\u53ef\n\ndalao\u52ff\u55b7\n\n# CODE\uff1a\n\n```cpp\n#pragma GCC optimize(3)\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<cstdlib>\n#include<string>\n#include<queue>\n#include<map>\n#include<stack>\n#include<list>\n#include<set>\n#include<deque>\n#include<vector>\n#include<ctime>\n#define ll long long\n#define inf 0x7fffffff\n#define mod 1000000007\n#define N 500008\n#define IL inline\n#define M 1008611\n#define D double\n#define ull unsigned long long\n#define R register\nusing namespace std;\ntemplate<typename T>void read(T &a)\n{\n    T x=0,f=1;char ch=getchar();\n    while(!isdigit(ch))\n    {\n        if(ch=='-')f=0;ch=getchar();\n    }\n    while(isdigit(ch))\n    {\n        x=(x<<1)+(x<<3)+ch-'0';ch=getchar();\n    }\n    a=f?x:-x;\n}\n/*-------------OI\u4f7f\u6211\u5feb\u4e50-------------*/\nint n,m,k,now;\nint ans[3][1010][1010],res[3][1010][1010];\nchar A[1010],B[1010]; \nint main()\n{\n//\tfreopen(\".in\",\"r\",stdin);\n//\tfreopen(\".out\",\"w\",stdout);\n    read(n);read(m);read(k);\n    scanf(\"%s%s\",A+1,B+1);\n    ans[0][0][0]=1;now=1;\n    for(R int i=1;i<=n;++i){\n        ans[now][0][0]=1;\n        for(R int j=1;j<=m;++j)\n         for(R int p=1;p<=k;++p){\n         \tif(A[i] == B[j]) res[now][j][p]=(res[now^1][j-1][p]+ans[now^1][j-1][p-1])%mod;\n            else res[now][j][p]=0; \n            ans[now][j][p]=(ans[now^1][j][p]+res[now][j][p])%mod;\n         }\n        now^=1;  \t \n    }\n    printf(\"%d\\n\",ans[now^1][m][k]);\n//\tfclose(stdin);\n//\tfclose(stdout);\n    return 0;\n}\n\n```\n\nNOIP 2018 \u5373\u5c06\u5230\u6765\n\n\u4e0d\u900f\u5f7b\u7684\u8d76\u7d27\u900f\u5f7b \u6ca1\u51c6\u4f1aRP++",
        "postTime": 1535944067,
        "uid": 87931,
        "name": "tcswuzb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\u5b9a\u4e49\u72b6\u6001$f[i][j][k][0/1]$\u8868\u793a\u5b57\u7b26\u4e32$A$\u7684\u524d$i$\u4e2a\u5b57\u7b26\u548c\u5b57\u7b26\u4e32$B$\u7684\u524d$j$\u4e2a\u5b57\u7b26\u7528\u4e86$k$\u4e2a\u5b50\u4e32\uff0c\u7b2c\u56db\u7ef4\u4e3a$1$\u8868\u793a$A$\u5b57\u7b26\u4e32\u7684\u7b2c$i$\u4e2a\u5b57\u7b26\u5fc5\u987b\u88ab\u9009\u51fa\uff0c\u4e3a$0$\u8868\u793a$A$\u5b57\u7b26\u4e32\u7684\u7b2c$i$\u4e2a\u5b57\u7b26\u4e0d\u80fd\u88ab\u9009\u51fa\u3002\n\n\u90a3\u4e48\u5f88\u5bb9\u6613\u5f97\u51fa\u8f6c\u79fb\uff1a\n\n1\u3001\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a$0<=i<=n$\uff0c$f[i][0][0][0]=1$\u3002\n\n2\u3001$f[i][j][k][0]=f[i-1][j][k][0]+f[i-1][j][k][1]$\n\n3\u3001$f[i][j][k][1]=f[i-1][j-1][k][1]+f[i-1][j-1][k-1][0]+f[i-1][j-1][k-1][1]$\n\n\u6700\u540e\u7ed3\u679c\u5373\u4e3a$f[n][m][K][0]+f[n][m][K][1]$\u3002\n\n\u8003\u8651\u5230\u7a7a\u95f4\u95ee\u9898\uff0c\u8fd9\u91cc\u6eda\u52a8$f$\u7684\u7b2c\u4e00\u7ef4\u4ee5\u8282\u7701\u7a7a\u95f4\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\ninline int read() {\n    int res = 0; bool bo = 0; char c;\n    while (((c = getchar()) < '0' || c > '9') && c != '-');\n    if (c == '-') bo = 1; else res = c - 48;\n    while ((c = getchar()) >= '0' && c <= '9')\n        res = (res << 3) + (res << 1) + (c - 48);\n    return bo ? ~res + 1 : res;\n}\nconst int N = 1005, M = 205, PYZ = 1e9 + 7;\nint n, m, K, f[2][M][M][2];\nchar a[N], b[M];\nint main() {\n    int i, j, k; n = read(); m = read(); K = read();\n    scanf(\"%s\", a + 1); scanf(\"%s\", b + 1); f[0][0][0][0] = 1;\n    for (i = 1; i <= n; i++) {\n        int op = i & 1; f[op][0][0][0] = 1;\n        for (j = 1; j <= min(i, m); j++) for (k = 1; k <= min(j, K); k++) {\n            f[op][j][k][0] = f[op][j][k][1] = 0;\n            f[op][j][k][0] = (f[op ^ 1][j][k][0] + f[op ^ 1][j][k][1]) % PYZ;\n            if (a[i] == b[j]) {\n                f[op][j][k][1] = (f[op ^ 1][j - 1][k][1] +\n                    f[op ^ 1][j - 1][k - 1][0]) % PYZ;\n                (f[op][j][k][1] += f[op ^ 1][j - 1][k - 1][1]) %= PYZ;\n            }\n        }\n    }\n    printf(\"%d\\n\", (f[n & 1][m][K][0] + f[n & 1][m][K][1]) % PYZ);\n    return 0;\n}\n```",
        "postTime": 1503125439,
        "uid": 29936,
        "name": "xyz32768",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u5f88\u6709\u96be\u5ea6\uff0c \u662f\u4e00\u9053\u4e0d\u9519\u7684$dp$\u3002\u5f88\u591a\u4eba\u53ea\u53bb\u5173\u6ce8\u4f18\u5316\uff0c \u6211\u8ba4\u4e3a\u8fd9\u662f\u4e0d\u6b63\u786e\u7684\u3002\n\n\u6211\u60f3\u6211\u5e94\u8be5\u628a\u6211\u5bf9\u8fd9\u9053\u9898\u7684\u7406\u89e3\u900f\u5f7b\u7684\u8bb2\u51fa\u6765\uff0c \u800c\u4e0d\u662f\u6cdb\u6cdb\u800c\u8c08\u3002\n\n\n\u6211\u4e48\u9996\u5148\u80fd\u8bbe\u51fa\u72b6\u6001$dp[i][j][k]$\u8868\u793a$A$\u4e32\u7684\u524d$i$\u4e2a\u9009$k$\u4e2a\u548c$B$\u4e32\u7684\u524d$j$\u548c\u914d\u5bf9\uff0c \u4ea7\u751f\u7684\u65b9\u6848\u6570\u3002\n\n\u90a3\u4e48\u6211\u4eec\u6709\uff1a\n\u5982\u679c\u5f53\u524d\u4f4d\u5339\u914d\u4e0a\u4e86\uff0c \u5373$A[i] = B[j]$\uff1a\n\u6211\u4eec\u53ef\u4ee5\u63a5\u7740\u7b2c$k$\u6b21\u914d\u5bf9\uff0c \u6216\u8005\u662f\u627e\u5230\u4e4b\u524d\u7684\u7b2c$k - 1$\u6b21\u7684\u4e32\u914d\u5bf9\u3002\n\u7b2c\u4e00\u79cd\u60c5\u51b5\u5c31\u662f$dp[i - 1][j][k]$,\n\u5bf9\u4e8e\u6211\u4eec\u6240\u8bf4\u7684\u7b2c\u4e8c\u79cd\u60c5\u51b5\uff0c \u6211\u4eec\u8fd9\u6837\u8003\u8651\uff1a\n\u56e0\u4e3a\u6211\u4eec\u8981\u6c42\u6c42\u51fa\u65b9\u6848\u6570\uff0c \u6240\u4ee5\u6211\u4eec\u9700\u8981\u77e5\u9053\u4ec0\u4e48\u60c5\u51b5\u53ef\u4ee5\u8f6c\u79fb\u5230\u5f53\u524d\u72b6\u6001\uff0c \u6211\u4eec\u53d1\u73b0\uff0c \u5bf9\u4e8e\u7b2c$k$\u4e2a\u5b50\u4e32\u800c\u8a00\uff0c \u9996\u5148\u5b83\u4e00\u5b9a\u662f\u8fde\u7eed\u7684\u4e00\u6bb5\uff0c \u90a3\u4e48\u8fd9\u8fde\u7eed\u7684\u4e00\u6bb5\uff0c \u6211\u4eec\u5f53\u7136\u53ef\u4ee5\u4ece$i$\u5f00\u5934\uff0c \u4ee3\u8868\u8fd9\u662f\u7b2c$k$\u4e2a\u5b57\u4e32\u7684\u7b2c\u4e00\u4f4d\uff0c \u6211\u4eec\u4e5f\u53ef\u4ee5\u4e0d\u4ece$i$\u5f00\u5934\uff0c \u4ece$i$\u4e4b\u524d\u5f00\u5934\uff0c\u53ea\u8981\u6ee1\u8db3\u6211\u4e4b\u524d\u7ed3\u675f\u7684\u662f\u7b2c$k-1$\u4e2a\u5b50\u4e32\u5c31\u884c\u5457\u3002\u4f46\u5982\u679c\u4ece$i$\u4e4b\u524d\u5f00\u5934\uff0c \u6211\u4eec\u4e3a\u4e86\u6ee1\u8db3\u540c\u4e00\u4e2a\u5b50\u4e32\u662f\u8fde\u7eed\u7684\u8fd9\u4e2a\u6761\u4ef6\uff0c\u6211\u4eec\u5fc5\u987b\u4fdd\u8bc1\u4ece$i$\u5f00\u59cb\uff0c\u5411\u524d\u7684\u6bcf\u4e00\u4f4d\u90fd\u5fc5\u987b\u662f\u76f8\u7b49\u7684\uff0c \u76f4\u5230\u6709\u4e00\u4f4d\u65ad\u4e86\u3002\n\u53c8\u56e0\u4e3a\u6211\u4eec\u662f$i$\u4e0e$j$\u914d\u5bf9\uff0c \u90a3\u663e\u7136$i-1$\u5c31\u5fc5\u987b\u548c$j-1$\u914d\u5bf9\u3002\n\u90a3\u8f6c\u79fb\u65b9\u7a0b\u5c31\u663e\u7136\u4e86\u3002\n\n\u7b2c\u4e8c\u79cd\u60c5\u51b5\uff1a\n\n\n$dp[i][j][k]=\\sum_{p = 1}^{A[i-p]=B[j-p]}dp[i-p][j-p][k-1] $\n\n\u90a3\u4e48\u5c31\u5f88\u663e\u7136\u4e86\uff0c \u628a\u4e24\u79cd\u60c5\u51b5\u548c\u52a0\u8d77\u6765\u5c31\u884c\u4e86\u3002\n\n\u5982\u679c\u5f53\u524d\u6ca1\u5339\u914d\u4e0a\uff0c \u90a3\u4e48\u5c31\u4e0d\u80fd\u6784\u6210\u65b0\u7684\u65b9\u6848\u4e86\uff0c \u5c31\u53ea\u80fd\u7ee7\u627f\u4e0a\u6b21\u7684\u65b9\u6848\u4e86\u3002\u5373\uff1a$dp[i][j][k] = dp[i - 1][j][k]$\u3002\n\n\u5bf9\u4e8e\u4f18\u5316\uff0c \u6211\u4eec\u53d1\u73b0\u5bf9\u4e8e\u6c42$\\sum dp[i-p]$\u6211\u4eec\u53ef\u4ee5\u641e\u4e00\u4e2a\u524d\u7f00\u548c\uff0c\u56e0\u4e3a\u53ea\u8981\u6709\u4e00\u4e2a\u4e2d\u95f4\u4e0d\u5339\u914d\uff0c \u90a3\u4e48\u4e4b\u524d\u7684\u8d21\u732e\u53ea\u80fd\u5bf9\u4e8e\u4e4b\u524d\u6709\u6548\u4e86\uff0c\u5bf9\u4e8e\u4e4b\u540e\u5c31\u65e0\u6548\u4e86\u3002\n\n\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u8bbe$sum[i][j][k]$\u8868\u793a\u5bf9\u4e8e$A[i]$\u548c$B[j]$\u800c\u8a00\u7684\u5411\u524d\u5ef6\u4f38\u7684\u6700\u5927\u957f\u5ea6\u7684\u5168\u90e8\u8d21\u732e\u3002\n\n\u8fd9\u6837\u7684\u8bdd\uff0c \u5982\u679c\u5f53\u524d\u4f4d\u5339\u914d\u4e86\uff0c $sum[i][j][k] =sum[i-1][j-1][k]+dp[i - 1][j-1][k-1]$\uff0c\u5373\u7ee7\u7eed\u7d2f\u52a0\uff0c \u5982\u679c\u6709\u4e00\u4e2a\u4e0d\u5339\u914d\uff0c \u5c31\u8d4b\u503c\u4e3a$0$\uff0c \u4ee3\u8868\u4e4b\u524d\u7684\u5bf9\u4e4b\u540e\u7684\u4e0d\u4ea7\u751f\u8d21\u732e\u3002\n\n\u6211\u4eec\u53d1\u73b0$i$\u4e4b\u548c$i-1$\u6709\u5173\uff0c \u90a3\u4e48\u518d\u6eda\u52a8\u6570\u7ec4\u4e00\u4e0b\u5c31\u884c\u4e86\u3002\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <cctype>\n#include <cstring>\nusing namespace std;\ntemplate <typename T>\ninline void read(T &x) {\n\tint f = 1; x = 0; char ch = getchar();\n\twhile(!isdigit(ch)) {if(ch == '-') f = -1; ch = getchar();}\n\twhile(isdigit(ch)) {x = x * 10 + ch - '0'; ch = getchar();}\n\tx *= f;\n}\ntemplate <typename T, typename ...Args>\ninline void read(T &x, Args &...args) {read(x); read(args...);}\nconst int mod = 1000000007, N = 1005;\nchar a[N], b[N];\nint dp[2][205][205];\nint sum[2][205][205];\nint main() {\n\tint n, m, t;\n\tread(n, m, t);\n\tscanf(\"%s\", a + 1);\n\tscanf(\"%s\", b + 1);\n\tdp[0][0][0] = dp[1][0][0] = 1;\n\tint now = 0;\n\tfor(int i = 1; i <= n; i++) {\n\t\tfor(int j = 1; j <= m; j++) {\n\t\t\tfor(int k = 0; k <= t; k++) {\n\t\t\t\tdp[now][j][k] = (dp[now ^ 1][j][k]) % mod;\n\t\t\t\tif(a[i] == b[j]) {\n\t\t\t\t\tsum[now][j][k] = (sum[now][j][k] + sum[now ^ 1][j - 1][k] + dp[now ^ 1][j - 1][k - 1]) % mod;\n\t\t\t\t} else {\n\t\t\t\t\tsum[now][j][k] = 0;\n\t\t\t\t}\n\t\t\t\tdp[now][j][k] = (dp[now][j][k] + sum[now][j][k]) % mod;\n\t\t\t} \n\t\t}\n\t\tmemset(sum[now ^ 1], 0, sizeof(sum[now ^ 1]));\n\t\tnow ^= 1;\n\t}\n\tcout << dp[now ^ 1][m][t] << endl;\n\treturn 0;\n}\n\n```\n\n",
        "postTime": 1573284884,
        "uid": 111617,
        "name": "RoRoyyy",
        "ccfLevel": 0,
        "title": "P2679"
    },
    {
        "content": "\u5bf9\u4e8e\u8fd9\u9053\u9898, \u6709\u597d\u591a\u5927\u4f6c\u53d1\u4e86\u9898\u89e3, \u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e5f\u90fd\u4e00\u6837, \u4f46\u662f\u90a3\u4e9b\u5927\u4f6c\u4eec\u90fd\u662f\u53ea\u7ed9\u4e2a\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b, \u4ee5\u81f3\u4e8e\u6211\u8fd9\u4e2a\u849f\u84bb\u5f88\u96be\u641e\u61c2\u4ec0\u4e48\u610f\u601d, \u6240\u4ee5\u53d1\u7bc7\u9898\u89e3\u8bf4\u4e0b\u81ea\u5df1\u7684\u7406\u89e3\n\n$f[i][j][k] =  0 \\qquad \\qquad \\qquad \\qquad \\qquad \\qquad \\qquad \\qquad \\qquad \\qquad (A_{i}\\ne B_{j}) $ \n$f[i][j][k] = f[i-1][j-1][k]+sum[i-1][j-1][k-1] \\qquad (A_{i}= B_{j})$  \n\n\u8fd9\u91cc\u7528\u5230\u4e86\u6eda\u52a8\u6570\u7ec4,\u5c31\u4e0d\u8fc7\u591a\u8bf4\u660e\u4e86, \u5c31\u53ea\u7b80\u5355\u8bf4\u4e00\u8bf4\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u7684\u542b\u4e49 : \n\n\u5bf9\u4e8e$f[i][j][k]$\u7684\u5b9a\u4e49\u610f\u601d\u662f$A$\u4e32\u9009\u5230$A_{i}$($A_{i}$\u88ab\u9009), $B$\u4e32\u76ee\u524d\u9009\u5230$B_{j}$($B_{j}$\u4e4b\u524d\u7684\u548c$B_{j}$\u90fd\u88ab\u9009)\u7684\u65f6\u5019\u5206\u6210$k$\u6bb5\u9009\u53d6\u5171\u6709\u591a\u5c11\u79cd\u9009\u6cd5\n\n\u53e6\u5916\u518d\u5f00\u4e00\u4e2a\u6570\u7ec4\u8bb0\u5f55\u524d\u7f00\u548c, $sum[i][j][k]$\u610f\u601d\u662f$A$\u4e32\u9009\u5230$A_{i}$($A_{i}$\u4e0e\u4e4b\u524d\u7684\u600e\u4e48\u9009\u90fd\u884c), $B$\u4e32\u76ee\u524d\u9009\u5230$B_{j}$($B_{j}$\u4e4b\u524d\u7684\u548c$B_{j}$\u90fd\u88ab\u9009)\u7684\u65f6\u5019\u5206\u6210$k$\u6bb5\u9009\u53d6\u6240\u6709\u9009\u53d6\u65b9\u6848\u7684\u548c \n\n$sum[i][j][k] = sum[i - 1][j][k] + f[i][j][k]$\n\n\u5bf9\u4e8esum\u6570\u7ec4\u7684\u8ba1\u7b97\u4e0d\u5fc5\u591a\u8bf4, \u4f46\u5bf9\u4e8ef\u7684\u8ba1\u7b97\u6211\u662f\u60f3\u4e86\u597d\u4e45\u624d\u60f3\u660e\u767d\n\n\u82e5$A_{i}\\ne B_{j} \\ f[i][j][k] =  0 $, \u8fd9\u4e2a\u5f88\u5bb9\u6613\u7406\u89e3, \u56e0\u4e3a\u82e5$A_{i}\\ne B_{j}$\u7684\u8bdd, \u90a3\u4e48$A_{i}$\u9009\u7684\u8bdd\u662f\u4e0d\u53ef\u80fd\u6709\u65b9\u6848\u7684\n\n\u82e5$A_{i}= B_{j} \\ f[i][j][k] = f[i-1][j-1][k]+sum[i-1][j-1][k-1] $, \u53ef\u80fd\u6211\u6bd4\u8f83\u7b28\u5427, \u60f3\u4e86\u597d\u4e45 :   \n1. \u53ef\u4ee5\u628a$A_{i} \\ B_{j}$\u4e0e$A_{i - 1} \\ B_{j - 1}$\u770b\u505a\u4e00\u4e2a\u6574\u4f53, \u8fd9\u6837\u7684\u8bdd,\u4e5f\u5c31\u53ea\u6709\u4e00\u79cd\u65b9\u6848, \u5c31\u662f$f[i-1][j-1][k]$, \u56e0\u4e3asum\u5b9a\u4e49\u662f$A_{i}$\u53ef\u80fd\u9009\u6216\u4e0d\u9009\u7684\u65b9\u6848\u548c, \u4f46$A_{i}$\u5fc5\u9009;\n2. \u53ef\u4ee5\u628a$A_{i} \\ B_{j}$\u770b\u505a\u4e00\u4e2a\u5355\u72ec\u7684\u90e8\u5206, \u8fd9\u6837\u7684\u8bdd, \u65b9\u6848\u5c31\u4f1a\u591a\u4e0a$sum[i-1][j-1][k-1]$, \u56e0\u4e3a\u770b\u505a\u5355\u72ec\u7684\u90e8\u5206\u7684\u8bdd, \u90a3\u4e48\u5c31\u76f8\u5f53\u4e8e$A_{i - 1} $ ($A_{i - 1}$\u9009\u6216\u4e0d\u9009) $\\ B_{j - 1}$\u6bcf\u4e00\u4e2a\u53ef\u884c\u65b9\u6848\u540e\u9762\u52a0\u4e0a\u4e00\u4e2a\u5339\u914d\u7684$A_{i}$  $ \\ B_{j}$, \u6240\u4ee5\u6b64\u65f6$A_{i - 1} \\ B_{j - 1}$($A_{i - 1}$\u9009\u6216\u4e0d\u9009)\u6bcf\u4e00\u4e2a\u53ef\u884c\u65b9\u6848\u5bf9\u4e8e$A_{i} \\ B_{j}$\u5339\u914d\u8fd9\u79cd\u60c5\u51b5\u90fd\u662f\u53ef\u884c\u7684\n\n\u8fd9\u5c31\u662f\u672c\u4eba\u5bf9\u4e8e\u8fd9\u4e2a\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u7684\u7406\u89e3, \u4ee3\u7801\u5176\u4ed6\u5927\u4f6c\u4eec\u90fd\u53d1\u4e86, \u672c\u4eba\u4e0d\u518d\u8d58\u8ff0",
        "postTime": 1572016965,
        "uid": 85733,
        "name": "takagi_",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\u52a8\u6001\u89c4\u5212\u3002\n\n\u7528 f[j][p] \u6570\u7ec4\u8868\u793a\u5230 s2 \u7684\u5206\u5272\u4e86p\u6b21\u7684\u60c5\u51b5\uff08\u4e0a\u4e00\u6b21\u5230\u5f53\u524d\u6ca1\u5206\uff0c\u6240\u4ee5\u5339\u914d\u5230s [i]!=s[j]\u65f6\uff0c\u8981\u6e05\u96f6\uff09\u3002\n\n\n\u7528dp[j][p]\u6570\u7ec4\u8868\u793a\u5230s2\u7684\u5206\u5272\u4e86p\u6b21\u7684\u60c5\u51b5\uff08\u8fd9\u6b21\u7ed3\u5c3e\u65ad\u5f00\uff09\u3002\n\n\n\u5c0f\u7ec6\u8282\uff0cj \u4ece\u540e\u5f80\u524d\u5339\u914d\uff0c\u4e3a\u4e86\u907f\u514d\u51b2\u7a81\uff08\u514d\u53bb\u4e86\u6eda\u52a8\u6570\u7ec4\uff09\u3002\n\n\n\u56e0\u4e3a\u53d6\u51fa\u65b9\u5f0f\u4e0d\u540c\u7b97\u4f5c\u4e0d\u540c\u65b9\u5f0f\uff0c\u6240\u4ee5\u8be5\u7b97\u6cd5\u6b63\u786e\u3002\n\n\n\u5c31\u662f\u8fd9\u6837\u3002\n\n\nps\uff1a\u53c2\u7167\u4e0b\u9762\u540c\u5b66\u5199\u7684\uff0c\u4f46\u662f\u4ed6\u7684\u4ee3\u7801\u6709\u70b9\u95ee\u9898\uff0c\u987a\u4fbf\u7406\u4e86\u4e0b\u4ed6\u7684\u601d\u8def\u3002\n\n\nc++\u4ee3\u7801\u5982\u4e0b\uff1a\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\ntypedef long long ll;\nconst ll mod = 1e9 + 7;\nint dp[201][201],f[201][201];\nchar s1[1001],s2[201];\nint main()\n{\n    int len1,len2,k;\n    scanf(\"%d%d%d\",&len1,&len2,&k);\n    scanf(\"%s%s\",s1 + 1,s2 + 1);\n    dp[0][0] = 1;\n    for(int i = 1;i <= len1;i++)\n        for(int j = len2 ; j  ;j--)\n            for(int p = k;p;p--)\n            {\n                if(s1[i] != s2[j]){ f[j][p] = 0; continue; }\n                f[j][p] = (f[j-1][p] + dp[j-1][p-1])%mod;\n                dp[j][p] = (f[j][p] + dp[j][p])%mod;\n            }\n    cout<<dp[len2][k];\n    return 0;\n}\n\u63a8\u5e7fblog<http://http://tgotp.science>\n```",
        "postTime": 1498275243,
        "uid": 23087,
        "name": "Tgotp",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\u4ee4$f[n][m][k]$\u4e3a$A$\u5b57\u7b26\u4e32\u5230\u7b2c$n$\u4f4d\uff0c$B$\u5b57\u7b26\u4e32\u5230\u7b2c$m$\u4f4d\uff0c\u603b\u5171\u6709$k$\u4e2a\u5b50\u4e32\uff0c\u6709\u591a\u5c11\u79cd\u60c5\u51b5\u3002\n\n\u53ef\u5f97$dp$\u65b9\u7a0b\uff1a\n\n$f[n][m][k] = f[n-1][m][k]~~~$ (\u4e0a\u4e00\u4e2a\u4e0d\u9009)\n\n$~~~~~~~~~~~~~~~~~~~+f[n-len-1][m-len-1][k-1]~~~~~$\n\n\uff08$1\\leq n\\leq min(n,m)-1$\n\u4e14A\u4e2d\u4ee5n\u4e3a\u7ed3\u5c3elen\u4e3a\u957f\u7684\u5b57\u7b26\u4e32\u4e0eB\u4e2d\u4ee5m\u7ed3\u5c3elen\u4e3a\u957f\u7684\u5b57\u7b26\u4e32\u4e00\u6a21\u4e00\u6837\uff09\u5373\u9009\u4e00\u4e2alen\u957f\u7684\u5b50\u4e32\n\n\u53ef\u4ee5\u5199\u51fa\u8fd9\u6837\u7684\u7a0b\u5e8f\uff1a\n\n```c++\nf[0][0][0] = 1;\nfor (int i = 1; i <= n; i++) {\n\tf[i][0][0] = 1;\n\tfor (int j = 1; j <= m; j++) {\n\t\tfor (int s = 0; s <= k; s++) {\n\t\t\tf[i][j][s] += f[i - 1][j][s] % mod;\n\t\t\tfor (int kk = 0; kk <= min(i, j) - 1; kk++) {\n\t\t\t\tif (a[i - kk] == b[j - kk])\n\t\t\t\t\tf[i][j][s] = (f[i][j][s] + f[i - kk - 1][j - kk - 1][s - 1]) % mod;\n\t\t\t\telse break;\n\t\t\t}\n\t\t}\n\t}\n}\n```\n\n\u89c2\u5bdf\u5230\u4e00\u65e6\u5b50\u4e32\u4e0d\u5339\u914d\u540e\u9762\u66f4\u5927\u7684\u5b50\u4e32\u4e5f\u4e0d\u5339\u914d\uff0c\u6240\u4ee5\uff0c\u53ef\u4ee5\u7528\u524d\u7f00\u548c\u6c42\u51fa\u3002\n\n```c++\nf[0][0][0] = 1;\nfor (int i = 1; i <= n; i++) {\n\tf[i][0][0] = 1;\n\tfor (int j = 1; j <= m; j++) {\n\t\tfor (int s = 0; s <= k; s++) {\n\t\t\tf[i][j][s] += f[i - 1][j][s] % mod;\n\t\t\tif (a[i] == b[j])\n\t\t\t\tsum[i][j][s] = (sum[i][j][s] + sum[i - 1][j - 1][s] + f[i - 1][j - 1][s - 1]) % mod;\n\t\t\telse sum[i][j][s] = 0;\n\t\t\tf[i][j][s] = (f[i][j][s] + sum[i][j][s]) % mod;\n\t\t}\n\t}\n}\n```\n\n\u56e0\u4e3a$n$\u7684\u503c\u5f88\u5927\uff0c\u4f1a\u7206\u5185\u5b58\uff0c\u89c2\u5bdf\u5230$i$\u53ea\u4f1a\u4ece$i-1$\u63a8\u5f97\uff0c\u6545\u6eda\u52a8\u6570\u7ec4\u5373\u53ef\uff0c\u5728\u6eda\u52a8\u8fc7\u7a0b\u4e2d\u8981\u8bb0\u5f97\u6e05\u96f6$sum$\u6570\u7ec4\n\u3002\n\n\n------------\n\n**\u6700\u540e\u8d34\u4e0a\u4ee3\u7801\uff1a\uff08\u6ce8\u610f\u7ec6\u8282\uff09**\n```c++\n#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\nconst int maxn = 1005;\nconst int maxm = 205;\nconst int mod = 1000000007;\nint n, m, k;\nchar a[maxn], b[maxn];\nint f[2][maxm][maxm], sum[2][maxm][maxm];\n\nint main() {\n\tscanf(\"%d%d%d\", &n, &m, &k);\n\tscanf(\"%s%s\", (a + 1), (b + 1));\n\tint now = 0;\n\tf[0][0][0] = f[1][0][0] = 1;\n\tfor (int i = 1; i <= n; i++) {\n\t\tfor (int j = 1; j <= m; j++) {\n\t\t\tfor (int s = 0; s <= k; s++) {\n\t\t\t\tf[now][j][s] = f[now ^ 1][j][s] % mod;\n\t\t\t\tif (a[i] == b[j])\n\t\t\t\t\tsum[now][j][s] = (sum[now][j][s] + sum[now ^ 1][j - 1][s] + f[now ^ 1][j - 1][s - 1])\n\t\t\t\t\t\t\t\t\t % mod;\n\t\t\t\telse sum[now][j][s] = 0;\n\t\t\t\tf[now][j][s] = (f[now][j][s] + sum[now][j][s]) % mod;\n\t\t\t}\n\t\t}\n\t\tmemset(sum[now ^ 1], 0, sizeof(sum[now ^ 1])); //\u6e05\u96f6 \n\t\tnow ^= 1;\n\t}\n\tprintf(\"%d\\n\", f[now ^ 1][m][k]);\n\treturn 0;\n}\n```",
        "postTime": 1549723329,
        "uid": 93352,
        "name": "alfayoung",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\u5927\u4f53\u601d\u8def\uff0c\u4e09\u7ef4\u6570\u7ec4\u5b58\u7684i,j,k,\u5206\u522b\u662fA\u4e32\u9009\u53d6\u5230\u54ea\u4e2a\u5b57\u7b26\uff0cB\u4e32\u9009\u53d6\u5230\u54ea\u4e2a\u5b57\u7b26\uff0c\u4ee5\u53ca\u9009\u53d6\u7684\u5b57\u7b26\u4e32\u7684\u4e2a\u6570\u3002\n\n```\n#include<bits/stdc++.h>\n#define ll long long \nusing namespace std;\nint n,m,k;\n f[2][201][201],s[2][201][201];//\u7531\u4e8e\u4e09\u7ef4\u4e0d\u53ef\u80fd\u5f00\u90a3\u4e48\u5927\uff0c\u6240\u4ee5\u53ea\u5f00\u5230f[0]\u548cf[1]\uff0c\u7ee7\u7eed\u5f80\u4e0b\u3002\nchar a[10001],b[1001];\nconst int mod=1000000007;\nint main()\n{\n\tscanf(\"%d%d%d\",&n,&m,&k);\n\tscanf(\"%s\",a+1);\n\tscanf(\"%s\",b+1);//\u8bfb\u5165\u3002\n\tint now=1,last=0;//\u6b64\u5904\u7528\u5230\u7684\u662f\u6eda\u52a8\u6570\u7ec4\uff0c\u6700\u540e\u4f1a\u653e\u4e2a\u56fe\u5e2e\u52a9\u4e0b\u7406\u89e3\uff0c\u7136\uff0c\u5ea6\u5a18\u662f\u6700\u7231\u4f60\u7684\u3002\n\tf[0][0][0]=1;//\u521d\u59cb\u3002\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tf[now][0][0]=1;\n\t\tfor(int j=1;j<=m;j++)\n\t\t\tfor(int kk=1;kk<=k;kk++)\n\t\t\t{\n\t\t\t\tif(a[i]==b[j])\n\t\t\t\t{\n\t\t\t\t\ts[now][j][kk]=(s[last][j-1][kk]+f[last][j-1][kk-1])%mod;\n/*\u8bb2\u4e00\u4e0b\u4e09\u6b21\u8f6c\u79fb\u3002\u8fd9\u662f\u7b2c\u4e00\u6b21\uff0c\u4e09\u4e2a\u5b57\u7b26\u5206\u522b\u8868\u793a\u7684\u610f\u4e49\u5df2\u7ecf\u7ed9\u51fa\uff0c\n\u5bf9\u4e8eA\u4e32\u548cB\u4e32\u4e2d\u5339\u914d\u5230\u76f8\u540c\u7684\u5b57\u7b26\uff0c\u5904\u7406\uff1a\n            1. \u5ef6\u7eed\u8fd9\u4e2a\u5b50\u4e32\uff0c\u5373kk\u4e0d\u662f\u4ece\u4e0a\u4e00\u4e2a\u8fc7\u6765\u7684\uff0c\u6240\u4ee5\u4e0d\u7528-;\n\n\t\t\t2. \u65b0\u5f00\u4e00\u4e2a\u5b50\u4e32,\u5373kk\u662f\u65b0\u7684\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u4e0a\u6b21\u7684\u8981-\uff1b\n*/\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ts[now][j][kk]=0;\n\t\t\t\t}\n\t\t\t\tf[now][j][kk]=(f[last][j][kk]+s[now][j][kk])%mod;\n                /*\u7528\u4e8e\u8ba1\u7b97f\u6570\u7ec4\uff0cf[i][j][kk]\u8868\u793a\u5728A\u4e32\u7684\u524di\u4e2a\u5b57\u7b26\u4e2d\u9009\n                kk\u4e2a\u5b50\u4e32\u5339\u914dB\u4e32\u7684\u524dj\u4e2a\u5b57\u7b26\u7684\u65b9\u6848\u6570.\u6c42\u65b9\u6848\u6570\u53ef\u4ee5\u91c7\u7528\u52a0\n                \u6cd5\u539f\u7406\uff0c\u8003\u8651A\u4e32\u7684\u7b2ci\u4e2a\u5b57\u7b26,\u90a3\u4e48\u8fd9\u4e2a\u5b57\u7b26\u7684\u51b3\u7b56\u53ea\u6709\u53d6\u6216\n                \u4e0d\u53d6\uff0c\u52a0\u6cd5\u539f\u7406\uff0c\u628a\u4e0d\u53d6\u7684\u65b9\u6848\u6570\u548c\u53d6\u7684\u65b9\u6848\u6570\u52a0\u8d77\u6765\u5c31\u53ef\n                \u4ee5\u3002\n                */\n\t\t\t}\n\t\t\tswap(now,last);\n            /*\u6eda\u52a8\u6570\u7ec4\u522b\u5fd8\u8bb0\u4ea4\u6362\uff0c\n            \u5426\u5219[0]\u548c[1]\u4e0d\u53d8\u7684\u60c5\u51b5\u4e0b\u6c38\u8fdc\u90fd\u662f\u548c\u81ea\u5df1\u4ea4\u6362\u3002\n            \u5f53\u7136\uff0c\u5927\u4f6c\u4e5f\u53ef\u4ee5\u5199\u6210&1\u548c\u5f62\u5f0f\uff0c\n            \u56e0\u4e3a\u6bcf\u4e2ai\u503c\u90fd\u662f\u4ece\u4e0a\u4e00\u4e2a\u9012\u63a8\u91cc\u9762\u51fa\u6765\u7684\uff0c\n            \u76f8\u5f53\u4e8e\u4e8c\u8fdb\u5236\u4e0b\u53d6\u6700\u540e\u4e00\u4f4d\uff0c\u6bcf\u4e2a\u76f8\u90bb\u7684\u6570\u90fd\u662f\u4e0d\u4e00\u6837\u7684\u3002\n            \u8fd8\u4e0d\u7406\u89e3\u7684\u8bdd\u7785\u7785\u6700\u540e\u9762\u90a3\u4e2a\u4e1c\u897f\uff0c\u6bd5\u7adf\u6211\u4e5f\u662fJu~\uff0c\u6211\u4e5f\u7231\u5ea6\u5a18\u3002\n            */\n\t}\n\tprintf(\"%lld\\n\",f[last][m][k]);\n\treturn 0;\n}\n```\n![](https://cdn.luogu.com.cn/upload/pic/40583.png)",
        "postTime": 1540807875,
        "uid": 66336,
        "name": "LW417",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u7684\u72b6\u6001\u8868\u793a\u975e\u5e38\u7b80\u5355\uff0c\u76f4\u63a5\u4f7f\u7528\u81ea\u7136\u72b6\u6001\uff0c$f[i][j][k]$ \u8868\u793a\u4ece\u5b57\u7b26\u4e32 $A$ \u4e2d\u524d $i$ \u4e2a\u5b57\u6bcd\u7ec4\u6210\u7684\u5b57\u7b26\u4e32\u4e2d\u9009\u51fa $k$ \u4e2a\u4e92\u4e0d\u91cd\u53e0\u7684\u5b50\u4e32\uff0c\u5e76\u4e14\u6309\u7167\u51fa\u73b0\u987a\u5e8f\u8fde\u63a5\uff0c\u7ec4\u6210\u5b57\u7b26\u4e32 $B$ \u4e2d\u524d $j$ \u4e2a\u5b57\u7b26\u8868\u793a\u7684\u5b57\u7b26\u4e32\u6709\u591a\u5c11\u79cd\u65b9\u6cd5\u3002\n\n\u8ba1\u7b97\u8fd9\u4e2a\u503c\u6709\u4e2a~~\u975e\u5e38naive\u7684~~\u65b9\u6cd5\uff0c\u76f4\u63a5\u679a\u4e3e\u6700\u540e\u4e00\u6bb5\u5373\u53ef\u3002\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n+ \u5982\u679c $A$ \u7b2c $i$ \u4e2a\u5b57\u7b26\u4e0e $B$ \u7684\u7b2c $j$  \u4e2a\u5b57\u7b26\u5e76\u4e0d\u76f8\u540c\uff0c\u90a3\u4e48\u663e\u7136 $f[i][j]][k]=f[i-1][j][k]$\n+ \u5982\u679c $A_i=B_j, A_{i-1} \\neq B_{j-1}$\uff0c\u90a3\u4e48 $f[i][j][k] = f[i-1][j][k]+f[i-1][j-1][k-1]$\n+ \u4f9d\u6b21\u7c7b\u63a8\uff0c\u5982\u679c $A_i=B_i\\cdots A_{i-t}=B_{j-t},A_{i-t-1}\\neq B_{j-t-1}$\uff0c\u90a3\u4e48 $f[i][j][k]=f[i-1][j][k]+f[i-1][j-1][k-1]\\cdots +f[i-t][j-t][k-t]$\u3002\n\n\u8fd9\u6837\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a **\u6700\u574f\u60c5\u51b5** $\\mathcal O(NM^2K)$ \u7684\u505a\u6cd5\uff0c\u4f46\u662f\u8fd9\u9898\u6570\u636e\u663e\u7136\u8fc7\u6c34\uff0c[\u53ef\u4ee5\u901a\u8fc7\u5361\u5e38\u5361\u8fdb\u65f6\u9650](https://www.luogu.com.cn/record/34041604)\u3002\n\n\u6ce8\u610f\u5230 $f[i][j][k]$ \u7684\u8ba1\u7b97\u65b9\u6cd5\u4e2d\u6709\u4e00\u90e8\u5206\u5728\u8ba1\u7b97 $f[i][j-1][k]$ \u7684\u65f6\u5019\u4e5f\u7528\u5230\u4e86\uff0c\u5c06 $f[i][j][k]$ \u7684\u8f6c\u79fb\u65b9\u7a0b\u62c6\u6210\u81ea\u5df1\u7684\u90e8\u5206\u4e0e $f[i][j-1][k]$ \u4e2d\u7684\u4e00\u90e8\u5206\u3002\n$$\nf[i][j][k]=\\color{blue}{f[i-1][j][k]+f[i-1][j-1][k]}+\\color{red}{f[i-1][j-1][k-1]\\cdots +f[i-t][j-t][k-t]}\n$$\n\n\u90a3\u4e48\u5728 dp \u65f6**\u989d\u5916\u8bb0\u5f55\u7ea2\u8272\u90e8\u5206\u3002**\u90a3\u4e48\u53ef\u4ee5 $O(1)$ \u8f6c\u79fb\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n\u6ce8\u610f\u5230\u672c\u9898\u5361\u4e86\u7a7a\u95f4\u3002\u56e0\u4e3a $ f[i] $ \u8f6c\u79fb\u53ea\u4f9d\u8d56 $f[i-1]$\uff0c\u56e0\u6b64\u76f4\u63a5\u628a\u7b2c\u4e00\u7ef4\u5ea6\u4f7f\u7528**\u6eda\u52a8\u6570\u7ec4**\u8fdb\u884c\u4f18\u5316\u5373\u53ef\u5361\u8fc7\u3002\n\n~~\u6700\u540e\u63d0\u9192\u5927\u5bb6\uff1a\u5982\u679c\u78b0\u5230 DP \u9898\u76ee\u4e0d\u4f1a\u505a\uff0c\u53ef\u4ee5\u5148\u819c\u62dc UM \u795e\u4ed9\u4ee5\u589e\u52a0 RP\u3002~~\n\n[Code](https://www.luogu.com.cn/record/34052070)",
        "postTime": 1590924362,
        "uid": 319914,
        "name": "Aftershock",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "~~\u6de6~~\uff01\u8fd9\u9898\u6211\u505a\u4e86\u4e09\u4e2a\u6708\u554a\n\n## \u9898\u76ee\u63cf\u8ff0\n\u6709\u4e24\u4e2a\u4ec5\u5305\u542b\u5c0f\u5199\u82f1\u6587\u5b57\u6bcd\u7684\u5b57\u7b26\u4e32 $A$ \u548c $B$\u3002\n\n\u73b0\u5728\u8981\u4ece\u5b57\u7b26\u4e32 $A$ \u4e2d\u53d6\u51fa $k$ \u4e2a\u4e92\u4e0d\u91cd\u53e0\u7684\u975e\u7a7a\u5b50\u4e32\uff0c\u7136\u540e\u628a\u8fd9 $k$ \u4e2a\u5b50\u4e32\u6309\u7167\u5176\u5728\u5b57\u7b26\u4e32 $A$ \u4e2d\u51fa\u73b0\u7684\u987a\u5e8f\u4f9d\u6b21\u8fde\u63a5\u8d77\u6765\u5f97\u5230\u4e00\u4e2a\u65b0\u7684\u5b57\u7b26\u4e32\u3002\u8bf7\u95ee\u6709\u591a\u5c11\u79cd\u65b9\u6848\u53ef\u4ee5\u4f7f\u5f97\u8fd9\u4e2a\u65b0\u4e32\u4e0e\u5b57\u7b26\u4e32 $B$ \u76f8\u7b49\uff1f\n\n\u6ce8\u610f\uff1a\u5b50\u4e32\u53d6\u51fa\u7684\u4f4d\u7f6e\u4e0d\u540c\u4e5f\u8ba4\u4e3a\u662f\u4e0d\u540c\u7684\u65b9\u6848\u3002\n\n## \u8f93\u5165\u683c\u5f0f\n\u7b2c\u4e00\u884c\u662f\u4e09\u4e2a\u6b63\u6574\u6570 $n,m,k$\uff0c\u5206\u522b\u8868\u793a\u5b57\u7b26\u4e32 $A$ \u7684\u957f\u5ea6\uff0c\u5b57\u7b26\u4e32 $B$ \u7684\u957f\u5ea6\uff0c\u4ee5\u53ca\u95ee\u9898\u63cf\u8ff0\u4e2d\u6240\u63d0\u5230\u7684 $k$\uff0c\u6bcf\u4e24\u4e2a\u6574\u6570\u4e4b\u95f4\u7528\u4e00\u4e2a\u7a7a\u683c\u9694\u5f00\u3002\n\n\u7b2c\u4e8c\u884c\u5305\u542b\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5b57\u7b26\u4e32\uff0c\u8868\u793a\u5b57\u7b26\u4e32 $A$\u3002\n\n\u7b2c\u4e09\u884c\u5305\u542b\u4e00\u4e2a\u957f\u5ea6\u4e3a $m$ \u7684\u5b57\u7b26\u4e32\uff0c\u8868\u793a\u5b57\u7b26\u4e32 $B$\u3002\n\n## \u8f93\u51fa\u683c\u5f0f\n\u4e00\u4e2a\u6574\u6570\uff0c\u8868\u793a\u6240\u6c42\u65b9\u6848\u6570\u3002\n\n\u7531\u4e8e\u7b54\u6848\u53ef\u80fd\u5f88\u5927\uff0c\u6240\u4ee5\u8fd9\u91cc\u8981\u6c42\u8f93\u51fa\u7b54\u6848\u5bf9 $1000000007$ \u53d6\u6a21\u7684\u7ed3\u679c\u3002\n\n## \u9898\u89e3\n\n\u9996\u5148\u6709\u8fd9\u4e9b\u53d8\u91cf\u540d:\n\n$dp[i][j][k]$ : \u8868\u793a\u62ff$A[i]$\u4e0e$B[j]$\u914d\u5bf9\uff0c\u914d\u6210$K$\u6bb5\u7684\u65b9\u6848\u6570\uff0c\u5047\u5982$A[i]$\u548c$B[j]$\u914d\u4e0d\u4e0a\u7684\u8bdd\u5c31\u7b49\u4e8e$0$\u3002    \n$sum[i][j][k]$ : \u8868\u793a$A$\u4ece$1$\u5230$i$\uff0c\u80fd\u548c$B[j]$\u914d\u6210$K$\u6bb5\u7684\u65b9\u6848\u603b\u6570($dp$\u6570\u7ec4\u7684\u524d\u7f00\u548c\u6570\u7ec4)\uff0c\u610f\u601d\u5c31\u662f$sum[i][j][k] = dp[1][j][k] + dp[2][j][k]...+dp[i][j][k]$\u3002\n\n\u90a3\u4e48\u8003\u8651\u5355\u72ec\u7684$A[i]$\u548c$B[j]$\uff0c\u5b58\u5728\u4e24\u79cd\u60c5\u51b5: \n\n### \u7b2c\u4e00\u79cd\u662f$A[i]$\u548c$B[j]$\u914d\u4e0a\u4e86\uff0c\u90a3\u4e48\u5c31\u53c8\u5206\u51fa\u4e24\u79cd\u60c5\u51b5:     \n\u7b2c\u4e00\u79cd\u662f$A[i - 1]$\u548c$B[j - 1]$\u4e5f\u914d\u4e0a\u4e86\uff0c\u90a3\u4e48\u53ef\u4ee5\u76f4\u63a5\u63a5\u5728\u5b83\u4eec\u540e\u9762\uff0c\u4e5f\u53ef\u4ee5\u53e6\u8d77\u7089\u7076(\u4e3a\u4ec0\u4e48\u4e0d\u7528\u8003\u8651$A[i - 1]$\u548c$B[j - 1]$\u6ca1\u63a5\u4e0a\u7684\u60c5\u51b5\uff1f\u56e0\u4e3a\u6ca1\u63a5\u4e0a\u7684\u8bdd$dp[i - 1][j - 1] = 0$\uff0c\u65e0\u9700\u8003\u8651)\uff1b    \n\n\u7b2c\u4e8c\u79cd\u662f$A[i - 1]$\u548c$B[j - 1]$\u6ca1\u914d\u4e0a\uff0c\u90a3\u6211\u4eec\u5c31\u5fc5\u987b\u627e\u5230\u67d0\u4e2a$A[i']$\u548c$B[j - 1]$\u914d\u4e0a\u4e86\uff0c\u800c\u4e14\u914d\u6210\u4e86$k - 1$\u6bb5\u7684\u5730\u65b9\uff0c\u8ba9$A[i]$\u4e0e$B[j]$\u63a5\u5728\u540e\u9762\u914d\u6210\u7b2c$k$\u6bb5    \n\u7136\u540e\u6211\u4eec\u53d1\u73b0\uff0c\u8981\u627e\u5230$A[i']$\u548c$B[j']$\u7684\u4f4d\u7f6e\u662f\u8981$O(n)$\u5904\u7406\u7684\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u627f\u53d7\u4e0d\u4f4f\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u8981\u7528\u5230$sum$\u6570\u7ec4\uff0c\u4e0d\u7528\u627e\uff0c\u76f4\u63a5\u7d2f\u52a0\u8d77\u524d\u4e00\u4e2a\u5339\u914d\u4f4d\u7f6e$A[i']$\u7684\u65b9\u6848\u6570\u5c31\u53ef\u4ee5\n\n### \u7b2c\u4e8c\u79cd\u662f\u914d\u4e0d\u4e0a$A[i]$\u4e0e$B[j]$\u914d\u4e0d\u4e0a\uff0c\u90a3\u4e48\u76f4\u63a5\u8d4b\u503c\u4e3a$0$\n\n\u6ce8\u610f:\u6211\u4eec\u7684$dp$\u8f6c\u79fb\u65b9\u5f0f\u662f\u7528$A$\u6570\u7ec4\u7684\u6bcf\u4e00\u4f4d\u53bb\u5c1d\u8bd5\u5339\u914d$B$\u7684\u67d0\u4e00\u4f4d\uff0c\u53ea\u6709$B$\u7684\u4e0a\u4e00\u4f4d\u5df2\u7ecf\u5339\u914d\u8fc7\u4e86\uff0c\u8fd9\u4e00\u4f4d\u624d\u80fd\u7ee7\u7eed\u5339\u914d\n\n\u7ed9\u5927\u4f6c~~\u6070~~\u4ee3\u7801:\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define rint register int\nint n, m, k;\nint dp[2][210][210], sum[2][210][210];\nchar a[1010], b[250];\ninline int read( void ){\n    int re = 0, f = 1; char ch = getchar();\n    while( ch > '9' || ch < '0' ){\n        if( ch == '-' ) f = -1;\n        ch = getchar();\n    }\n    while( ch >= '0' && ch <= '9' ){\n        re = re * 10 + ch - '0';\n        ch = getchar();\n    }\n    return re * f; \n}\nint main( void ){\n    n = read(); m = read(); k = read();\n    scanf( \"%s%s\", a+1, b+1 );\n    dp[0][0][0] = 1;//\u4e00\u4e2a\u90fd\u4e0d\u5339\u914d\u7684\u65b9\u6848\u6570\u5f53\u7136\u662f0\n    int now = 0, pre = 1;\n    for( rint i = 1; i <= n; i++ ){\n        dp[now][0][0]=sum[now][0][0] = 1;\n        dp[pre][0][0]=sum[pre][0][0] = 1;\n        for( rint j = 1; j <= m; j++ ){\n            for( rint kk = 1; kk <= k; kk++ ){\n                if( a[i] == b[j] ){\n                    dp[now][j][kk] = ( sum[pre][j - 1][kk - 1] + dp[pre][j - 1][kk] ) % 1000000007;\n                } \n                else dp[now][j][kk] = 0;\n                sum[now][j][kk] = ( sum[pre][j][kk] + dp[now][j][kk] ) % 1000000007; //\u5904\u7406\u524d\u7f00\u548c\n            } \n        }\n        swap( now, pre ); \n    }\n    cout << sum[pre][m][k];\n    return 0;\n}\n```\n[\u6211\u7684\u535a\u5ba2](https://www.cnblogs.com/with6676/p/11828110.html)   \n$CSP2019$ $RP++$",
        "postTime": 1573346520,
        "uid": 149105,
        "name": "Indigo_Boy",
        "ccfLevel": 3,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "~~\u76f8\u4fe1\u8fd9\u7bc7\u6ca1\u4eba\u770b, \u5168\u5f53\u81ea\u5df1\u7684\u603b\u7ed3\u5427.~~  \n\u672c\u9898\u5e76\u6ca1\u6709\u8003\u5bdf\u5b57\u7b26\u4e32\u7b97\u6cd5 ( \u4e0d\u4f1a ), \u4ec5\u4ec5\u662f\u7b80\u5355\u7684$DP$.  \n\u72b6\u6001\u4e5f\u975e\u5e38\u7b80\u5355, **$f(k,i,j)$\u8868\u793a\u4ece$A[1..i]$\u4e2d\u53d6$k$\u4e2a\u4e92\u4e0d\u91cd\u53e0\u7684\u975e\u7a7a\u5b50\u4e32, \u586b\u5145$B[1..j]$\u7684\u65b9\u6848\u6570**. \u4e0b\u9762\u662f\u521d\u59cb\u72b6\u6001\u53ca\u8f6c\u79fb:  \n- **\u521d\u59cb\u72b6\u6001**  \n\u5f53$k=j=0$\u65f6, $f(k,i,j)=1$, \u5176\u4f59\u60c5\u51b5$f(k,i,j)=0$.  \n\n- **\u8f6c\u79fb\u65b9\u7a0b**  \n\u8f6c\u79fb\u4e3a\u4e24\u7c7b\u72b6\u6001\u4e4b\u548c: \u4e0d\u4f7f\u7528$A[i]$; \u4f7f\u7528$A[1..i]$\u7684\u4e00\u6bb5\u540e\u7f00\u586b\u5145$B[1..j]$\u7684\u4e00\u6bb5\u540e\u7f00. \u90a3\u4e48\u6709:\n$$\nf(k,i,j)=f(k,i-1,j)+\\sum_{p=i,q=j}^{p,q>0}\\lbrack A\\lbrack p..i\\rbrack=B\\lbrack q..j\\rbrack \\rbrack(f(k-1,p-1,q-1))\n$$\n\n\u65f6\u7a7a$O(nm^3)/T(nm^2)$, \u4e8e\u662f\u8bde\u751f\u4e86$80pts.\\,MLE$\u7684\u4ee3\u7801:\n```cpp\n#include <cstdio>\n\n#define Int register int\n\nconst int MAXN = 1000, MAXM = 200, MAXK = MAXM, MOD = 1e9 + 7;\nint N, M, K, F[MAXN + 5][MAXM + 5][MAXK + 5] = {};\nchar A[MAXN + 5] = {}, B[MAXM + 5] = {};\n\ninline void Work () {\n\tscanf ( \"%d %d %d %s %s\", &N, &M, &K, A + 1, B + 1 );\n\tfor ( Int i = 0; i <= N; ++ i ) {\n\t\tF[i][0][0] = 1;\n\t}\n\tfor ( Int i = 1; i <= N; ++ i ) {\n\t\tfor ( Int j = 1; j <= M && j <= i; ++ j ) {\n\t\t\tfor ( Int k = 1, *now = &( F[i][j][k] = F[i - 1][j][k] ); k <= K && k <= j; ++ k, now = &( F[i][j][k] = F[i - 1][j][k] ) ) {\n\t\t\t\tfor ( Int p = i, q = j; p && q && A[p] == B[q]; -- p, -- q ) {\n\t\t\t\t\t*now = ( *now + F[p - 1][q - 1][k - 1] ) % MOD;\n\t\t\t\t}\n//\t\t\t\tprintf ( \"F[%d][%d][%d]=%d\\n\", i, j, k, *now );\n\t\t\t}\n\t\t}\n\t}\n\tprintf ( \"%d\\n\", F[N][M][K] );\n}\n\nint main () {\n\tWork ();\n\treturn 0;\n}\n```\n~~\u6709\u4e00\u4e2a\u8be5$T$\u7684\u70b9$A$\u4e86, \u9a97\u5206\u5bfc\u8bba\u5361\u5e38\u6280\u5de7\u8d50\u795e\u529b/\u6ed1\u7a3d.~~  \n\u8fd9\u65f6, \u81ea\u7136\u5730\u60f3\u5230\u6eda\u52a8\u6570\u7ec4, $T(nm^2)\\Rightarrow T(nm),\\,80pts.\\,TLE$:\n```cpp\n#include <cstdio>\n\n#define Int register int\n\nconst int MAXN = 1000, MAXM = 200, MAXK = MAXM, MOD = 1e9 + 7;\nint N, M, K, F[2][MAXN + 5][MAXM + 5] = {};\nchar A[MAXN + 5] = {}, B[MAXM + 5] = {};\n\ninline void Work () {\n\tscanf ( \"%d %d %d %s %s\", &N, &M, &K, A + 1, B + 1 );\n\tfor ( Int i = 0; i <= N; ++ i ) {\n\t\tF[0][i][0] = 1;\n\t}\n\tfor ( Int k = 1, t = 1; k <= K; ++ k, t ^= 1 ) {\n\t\tfor ( Int i = k; i <= N; ++ i ) {\n\t\t\tfor ( Int j = k, *now; j <= i && j <= N; ++ j ) {\n\t\t\t\tnow = &( F[t][i][j] = F[t][i - 1][j] );\n\t\t\t\tfor ( Int p = i, q = j; p >= k && q >= k && A[p] == B[q]; -- p, -- q ) {\n\t\t\t\t\t*now = ( *now + F[t ^ 1][p - 1][q - 1] ) % MOD;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf ( \"%d\\n\", F[K & 1][N][M] );\n}\n\nint main () {\n\tWork ();\n\treturn 0;\n}\n```\n\u89c2\u5bdf\u8f6c\u79fb\u65b9\u7a0b, $\\sum_{p=i,q=j}^{p,q>0}[A[p..i]=B[q..j]](f(k-1,p-1,q-1))$\u4e2d\u82e5\u5728\u67d0\u4e00\u65f6\u523b$[A[p..i]=B[q..j]]=0$, $\\forall p'<p$, $\\,[A[p'..i]=B[q'..j]=0$.\u6240\u4ee5\u6211\u4eec\u518d\u7528\u4e00\u4e2a\u6eda\u52a8\u6570\u7ec4$Sum$\u7ef4\u62a4$f$\u7684\u6761\u4ef6\u524d\u7f00\u548c\u5373\u53ef, \u5219:\n$$\nf(k,i,j)=f(k,i-1,j)+[A[i]=B[i]\\,and\\,i,j\\ge k]Sum(k-1,i-1,j-1)\n$$\n~~\u6211\u7684\u5929\u660e\u660e\u5f88\u8be6\u7ec6\u770b\u7740\u5374\u50cf\u5ffd\u60a0\u4eba, \u80af\u5b9a\u662f\u9898\u592a\u6c34\u4e86/\u518d\u6b21\u6ed1\u7a3d.~~  \n\u65f6\u7a7a$O(nm^2)/T(nm)$, $100pts.\\,AC$, \u4e0a\u4ee3\u7801:\n```cpp\n#include <cstdio>\n#include <cstring>\n\n#define Int register int\n\nconst int MAXN = 1000, MAXM = 200, MAXK = MAXM, MOD = 1e9 + 7;\nint N, M, K, F[2][MAXN + 5][MAXM + 5] = {}, Sum[2][MAXN + 5][MAXM + 5] = {};\nchar A[MAXN + 5] = {}, B[MAXM + 5] = {};\n\ninline void Work () {\n\tscanf ( \"%d %d %d %s %s\", &N, &M, &K, A + 1, B + 1 );\n\tfor ( Int i = 0; i <= N; ++ i ) {\n\t\tSum[0][i][0] = F[0][i][0] = 1;\n\t}\n\tfor ( Int i = 1; i ^ N; ++ i ) {\n\t\tfor ( Int j = 1; j ^ M; ++ j ) {\n\t\t\tSum[0][i][j] += ( A[i] == B[j] ) * Sum[0][i - 1][j - 1];\n\t\t}\n\t}\n\tfor ( Int k = 1, t = 1; k <= K; ++ k, t ^= 1 ) {\n\t\tmemset ( Sum[t], 0, sizeof Sum[t] );\n\t\tfor ( Int i = k; i <= N; ++ i ) {\n\t\t\tfor ( Int j = k, *now; j <= i && j <= M; ++ j ) {\n\t\t\t\tnow = &( F[t][i][j] = F[t][i - 1][j] );\n\t\t\t\t*now = ( *now + ( A[i] == B[j] && i >= k && j >= k ) * Sum[t ^ 1][i - 1][j - 1] ) % MOD;\n\t\t\t\tSum[t][i][j] = ( *now + ( A[i] == B[j] && i >= k && j >= k ) * Sum[t][i - 1][j - 1] ) % MOD;\n\t\t\t}\n\t\t}\n\t}\n\tprintf ( \"%d\\n\", F[K & 1][N][M] );\n}\n\nint main () {\n\tWork ();\n\treturn 0;\n}\n```\n~~\u7ba1\u7406\u5458\u5927\u5927\u4e0d\u8981\u7206\u7834\u6211\u5199\u6c34\u9898\u9898\u89e3\u5237\u5495\u503c\u5f88\u7d2f\u7684/\u8fd9\u5f88\u6ed1\u7a3d.~~",
        "postTime": 1565003987,
        "uid": 123807,
        "name": "Rainybunny",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\u8fd9\u4e2a\u9898\u6211\u641e\u4e86\u597d\u4e45\uff0c\u7ec8\u4e8e\u7b97\u662f\u660e\u767d\u4e86\u70b9\u5427\n\n\u770b\u4e86\u5f88\u591a\u5927\u795e\u7684\u535a\u5ba2\uff0c\u603b\u7ed3\u51fa\u6765\u4e86\u4e00\u4e9b\u505a\u6cd5\uff0c\u4e0d\u77e5\u5bf9\u4e0d\u5bf9\uff0c\u5c31\u5199\u4e00\u4e9b\u5427\u3002\n\n\u5148\u5b9a\u4e49\u4e24\u4e2a\u6570\u7ec4\n\nsum[i][j][k]\u5c31\u662fa\u4e32\u524di\u4e2a\u5b57\u6bcd,b\u4e32\u524dj\u4e2a\u5b57\u6bcd\u7684\u65b9\u6848\u603b\u6570\uff01\uff01\uff01\uff01\uff0c\u5c31\u662f\u7ed3\u679c\n\nf[i][j][k]\u662f\u7528\u7b2ci\u4e2a\u5b57\u6bcd\u7528\u7684\u65b9\u6848\u6570\u3002\n\n\u5f53\u5339\u914d\u65f6\uff1a\n\n\u56e0\u4e3a\u7b2ci\u4e2a\u53ef\u4ee5\u548c\u524di-1\u5408\u5e76\u4e3a\u4e00\u5757(\u4f46\u8fd9\u662f\u65b9\u6848\u6570\u4e0d\u53d8,\u56e0\u4e3a\u7ec4\u6570\u76f8\u540c\uff0c\u4e3af[i-1][j-1][k]),\u4e5f\u53ef\u4ee5\u4e0d\u5408\u5e76,\uff08\u4e3asum[i-1][j-1][k-1],\u4e0d\u5408\u5e76\u5c31\u662f\u524d\u4e00\u7ec4\u6240\u6709\u7684\u65b9\u6848\uff09\u7136\u540e\u52a0\u8d77\u6765\u2014\u2014\u300b\u300b\n\n\u5f97f[i][j][k]=\uff08a[i]==a[j]\uff09\uff08sum[i-1][j-1][k-1]+f[i-1][j-1][k]\uff09;\n\n\u4e0d\u5339\u914d\u662f\u5c31\u662f\u96f6\uff0c\u56e0\u4e3af\u662f\u7528\u4e86\u7684\u60c5\u51b5\uff0c\u4e0d\u5339\u914d\u5c31\u6ca1\u6cd5\u7528\u4e86\n\n\u90a3\u4e48\u5904\u7406\u51faf[i][j][k]\u6765\u4e86\u3002\n\nsum[i][j][k]\u5c31\u7b49\u4e8e\u4e0a\u4e00\u4e32\u7684\u7684\u603b\u65b9\u6848\uff08sum[i-1][j][k]\uff09\u52a0\u4e0a\u7528\u7528\u8fd9\u4e2a\u4e32\u7684(f[i][j][k])\n\n```cpp\n#include<iostream>\n#define p 1000000007\nusing namespace std; \nlong long f[201][201],sum[201][201],n,m,k;\nchar a[1001],b[201];\nint main(){\n    cin>>n>>m>>k>>a>>b;\n    sum[0][0]=1;\n    for(int i=1;i<=n;i++)\n      for(int j=m;j>=1;j--)\n        for(int q=k;q>=1;q--)\n        {\n            if(a[i-1]==b[j-1])\n            f[j][q]=(f[j-1][q]+sum[j-1][q-1])%p;\n            else f[j][q]=0;\n            \n            sum[j][q]+=f[j][q];\n            sum[i][q]%=p;\n           }\n        \n        \n              \n    cout<<sum[m][k];\n}\n\n```",
        "postTime": 1497174206,
        "uid": 18371,
        "name": "alpq010815",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "# \u5b50\u4e32 \u9898\u89e3\n\n\u6211\u7684\u5185\u5fc3\u72ec\u767d\uff1a\n\n\u770b\u8d77\u6765\u597d\u50cf\u4e0d\u600e\u4e48\u597d\u5199\uff0c\u4f46\u662f\u597d\u50cf\u6709**\u4e00\u7ec4\u6570\u636ek==1\u53ef\u4ee5\u7528KMP\u6c34\u4e00\u6ce2~**\n\n\u7136\u540e\u5c31\u53ea\u670910\u5206\u4e86\u2026\u2026\n\n\u6ca1\u6709\u5173\u7cfb\uff0c\u6211\u4eec\u6765\u770b\u6b63\u89e3\uff01\n\n\u5b9e\u9645\u4e0a\u8fd9\u9053\u9898\u80af\u5b9a\u662f\u4f7f\u7528dp\u6765\u505a\uff0c\u56e0\u4e3a\u5f53\u524d\u7684\u5b57\u7b26\u65e0\u8bba\u9009\u6216\u4e0d\u9009\u90fd\u4e0d\u4f1a\u5f71\u54cd\u5230\u540e\u7eed\u7684\u72b6\u6001\uff0c\u5e76\u4e14\u4ece\u4e00\u4e2a\u72b6\u6001\u4e4b\u95f4\u53c8\u53ef\u4ee5\u5f88\u7b80\u5355\u5730\u8f6c\u79fb\u5230\u4e0b\u4e00\u4e2a\u72b6\u6001\uff0c\u6240\u4ee5\u8bf4\uff1a\n\n### DP\u5927\u6cd5\uff01\uff01\uff01\n\n\u8bbe$f_{i,j,p,0/1}$\u8868\u793a\u5f53\u524d\u5339\u914d\u5230a\u4e32i\u4f4d\u7f6e\uff0cb\u4e32j\u4f4d\u7f6e\uff0c\u5f53\u524d\u5212\u5206\u4e86p\u4e2a\u5b50\u4e32\u4e14a\u4e32\u7684\u7b2ci\u4e2a\u5b57\u7b26\u9009\u6216\u4e0d\u9009\u7684\u72b6\u6001\uff0c\u53ef\u4ee5\u7b80\u5355\u5730\u5f97\u5230\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$f_{i,j,p,0}=\\begin{cases}f_{i-1,j,p,0}+f_{i-1,j,p,1}&a_{i}=b_{j}\\\\f_{i-1,j,p,0}+f_{i-1,j,p,l}&a_{i}\\neq b_{j}\\end{cases}$\n\n$f_{i,j,p,1}=\\begin{cases}f_{i-1,j-1,p,1}+f_{i-1,j-1,p-1,0}+f_{i-1,j-1,p-1,1}&a_{i}=b_{j}\\\\0&a_{i}\\ne b_{j}\\end{cases}$\n\nUpdate 2019.11.12 \u6b64\u5904\u7684\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u6709\u4e00\u70b9\u70b9\u95ee\u9898\uff0c\u73b0\u5df2\u66f4\u6b63\uff0c\u611f\u8c22@CuO\u540c\u5b66\n\n\u4ed8\u4e0a\u6e90\u4ee3\u7801\uff1a\n```cpp\n#include <cstdio>\nusing namespace std;\nconst int MOD=1000000007;\nconst int MAXN=1001;\nconst int MAXM=201;\nconst int MAXK=201;\nint f[2][MAXM][MAXM][2];\nchar a[MAXN],b[MAXM];\nint n,m,k,val=1;\nint main()\n{\n\t//freopen(\"in.txt\",\"r\",stdin);\n\tscanf(\"%d%d%d\",&n,&m,&k);\n\tscanf(\"%s%s\",a+1,b+1);\n\tf[0][0][0][0]=f[1][0][0][0]=1;\n\tfor (int i=1;i<=n;i++,val^=1)\n\t\tfor (int j=1;j<=m;j++)\n\t\t\tfor (int p=1;p<=k;p++)\n\t\t\t\tif (a[i]==b[j])\n\t\t\t\t{\n\t\t\t\t\tf[val][j][p][0]=(f[val^1][j][p][0]+f[val^1][j][p][1])%MOD;\n\t\t\t\t\tf[val][j][p][1]=(f[val^1][j-1][p][1]+(f[val^1][j-1][p-1][0]+f[val^1][j-1][p-1][1])%MOD)%MOD;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tf[val][j][p][0]=(f[val^1][j][p][0]+f[val^1][j][p][1])%MOD;\n\t\t\t\t\tf[val][j][p][1]=0;\n\t\t\t\t}\n\tprintf(\"%d\",(f[n&1][m][k][0]+f[n&1][m][k][1])%MOD);\n}\n//LGOJ https://www.luogu.org/problem/P2679\n```\n",
        "postTime": 1572876934,
        "uid": 113476,
        "name": "Gorun",
        "ccfLevel": 4,
        "title": "\u9898\u89e3\u3010P2679\u3011 \u5b50\u4e32"
    },
    {
        "content": "DP\uff1a\n\u8bbef[i][j][k]\u4e3aa[i]\u4e0eb[j]\u914d\u5bf9\u7ec4\u6210\u7b2ck\u5bf9\u7684\u65b9\u6848\u6570\n\ng[i][j][k]\u4e3aa[1..i]\u4e2d\u4efb\u610f\u4e00\u4e2a\u4e0eb[j]\u914d\u5bf9\u7ec4\u6210\u7b2ck\u5bf9\u7684\u65b9\u6848\u6570\n\n\u6240\u4ee5g[i][j][k]=f[1][j][k]+f[2][j][k]+...+f[i][j][k]=g[i-1][j][k]\n\nif(a[i]==b[j])f[i][j][k]=f[1][j-1][k-1]+f[2][j-1][k-1]+...+f[i-1][j-1][k-1]+f[i-1][j-1][k]=g[i-1][j-1][k-1]+f[i-1][j-1][k];\n\nelse f[i][j][k]=0;\n\n\u8fb9\u754cf[i][0][0]=g[i][0][0]=1;\n\n\n\u5982\u662f\u5f97\u5230\u4ee3\u7801\u5982\u4e0b\uff1a\n\n    \n    \n```cpp\n    #include<iostream>\n    #include<cstdio>\n    using namespace std;\n    #define N 1001\n    #define M 201\n    #define MOD 1000000007\n```\nchar a[N],\n        b[N];\n\nint f[N][M][M],\n\n    \n\n```cpp\n        g[N][M][M];\n    int main()\n    {\n        int n,m,l;\n        cin>>n>>m>>l;\n        cin>>a+1;                                                                                                            //a+1\u662f\u6307\u4ee5a[1]\u4e3a\u6570\u7ec4\u8d77\u70b9\u8bfb\u5b57\u7b26\u4e32\uff0c\u8fd9\u6837\u597d\u5904\u7406\u8fb9\u754c\n        cin>>b+1;\n        for(int i=0;i<=n;i++)\n            f[i][0][0]=g[i][0][0]=1;\n        for(int i=1;i<=n;i++)\n            for(int j=1;j<=m;j++)\n                for(int k=1;k<=l;k++){\n                    if(a[i]==b[j])f[i][j][k]=(g[i-1][j-1][k-1]+f[i-1][j-1][k])%MOD;\n                    g[i][j][k]=(g[i-1][j][k]+f[i][j][k])%MOD;\n                }\n        cout<<g[n][m][l];\n        return 0;\n    }\n```\n\u53c8\u7531\u4e8e\u6d1b\u8c37\u8fd9\u9898\u53ea\u7ed9\u4e86128M\u7a7a\u95f4\uff0c\u9700\u8981\u6eda\u52a8\u6570\u7ec4\uff0c\u91cd\u70b9\u7a0b\u5e8f\u6bb5\u5982\u4e0b\uff1a\n```cpp\n    int now=0,las=1;\n    for(int i=0;i<=n;i++){\n        swap(now,las);\n        f[now][0][0]=g[now][0][0]=1;\n        if(i)\n            for(int j=1;j<=m;j++)\n                for(int k=1;k<=l;k++){\n                    if(a[i]==b[j])f[now][j][k]=(g[las][j-1][k-1]+f[las][j-1][k])%MOD;\n                        else f[now][j][k]=0;                                                                   //\u4e0d\u6eda\u52a8\u65f6\u521d\u503c\u662f0\uff0c\u6eda\u52a8\u5c31\u8981\u624b\u7f6e\u4e86\n                    g[now][j][k]=(g[las][j][k]+f[now][j][k])%MOD;\n                }\n    }\n    cout<<g[now][m][l];\n\u7531\u4e8ei\u5728\u6700\u5916\u5c42\u5faa\u73af\uff0c\u6240\u4ee5\u628ai\u6eda\u52a8\u6389\n```",
        "postTime": 1509283297,
        "uid": 41425,
        "name": "wanghaoyu1008",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\u5bf9\u4e8e\u6bcf\u4e2ai\uff0cj\uff0c\u9884\u5148\u5904\u7406\u5b83\u80fd\u5ef6\u957f\u7684\u6700\u957f\u5b57\u4e32\uff08n\\*m\uff09\uff0c\u5b9a\u4e49dp[i][j][k]\u8868\u793a\u542bk\u4e2a\u5b50\u4e32\u65f6\uff0c\u672b\u4f4d\u4e3ai\uff0cj\u7684\u65b9\u6848\u6570\uff0c\u53ef\u77e5\u82e5a[i]!=b[j]\u5219\u7b54\u6848\u4e00\u5b9a\u4e3a0\uff1b\u5426\u5219\uff1a\n\n1..\u5728i\u4e4b\u524d\u65ad\u5f00\uff0c\u5219i\u53ef\u8fde\u63a5\u4efb\u4e00\u524d\u4e00\u4e2a\u5b50\u4e32\u6545dp[i][j][k]=sigma(dp[ai][j-1][k-1])(ai<i)\n\n2..\u4e0d\u65ad\u5f00\uff0c\u90a3\u4e48\u53ea\u80fd\u8fde\u63a5\u524d\u4e00\u4e2a\u5b50\u4e32\u6545dp[i][j][k]=dp[i-1][j-1][k]\uff1b\u56e0\u4e3a\u524d\u9762\u4e0d\u65ad\u7684\u60c5\u51b5\u5df2\u7b97\u8fdbdp[i-1][j-1][k]\u4e2d\u4e86\uff0c\u6240\u4ee5\u4e0d\u7528\u53e0\u52a0\n\n\u8f93\u51fasigma(dp[i][k])\u5373\u53ef\n\n\u96be\u4ee5\u60f3\u8c61\u5f53\u5e74\u4e3a\u4ec0\u4e48\u6ca1\u6709\u505a\u51fa\u6765\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#define mod 1000000007\n#define M(x) ((x)%mod+mod)%mod\ntypedef long long ll;\nusing namespace std;\nll dp[2000][205][2],l[2000][205],sum[2000][205][2];\nchar a[2009],b[209];\nint n,m,k;\nint main()    {\n    scanf(\"%d%d%d\",&n,&m,&k);\n    scanf(\"%s%s\",a+1,b+1);\n    for(int i=1;i<=n;i++)\n        for(int j=1;j<=min(m,i);j++)    {\n            if(a[i]==b[j])    \n                l[i][j]=l[i-1][j-1]+1;\n            else     \n                l[i][j]=0;\n        }\n    int cur=0,curr=1;\n    for(int i=1;i<=n;i++)\n        for(int j=1;j<=min(i,j);j++)    {\n            if(l[i][j]==j)\n                dp[i][j][cur]=1;\n        }\n    for(int p=2;p<=k;p++)    {\n        for(int i=1;i<=n;i++)\n            for(int j=0;j<=m;j++)\n                sum[i][j][cur]=M((j ? sum[i-1][j][cur]: 0 )+dp[i][j][cur]);\n        for(int i=1;i<=n;i++)\n            for(int j=1;j<=min(i,m);j++)    {\n                if(!l[i][j])\n                    continue;\n                dp[i][j][curr]=sum[i-1][j-1][cur];//\u65ad\u5f00 \n                if(l[i][j]>1)//\u53ef\u4ee5\u4e0d\u65ad\u5f00    \n                {\n                    dp[i][j][curr]=M(dp[i][j][curr]+dp[i-1][j-1][curr]);     \n                }\n            }\n        cur^=1;\n        curr^=1;\n    }\n    int ans=0;\n    for(int i=m;i<=n;i++)\n        ans=M(ans+dp[i][m][cur]);\n    cout<<ans<<endl;\n}\n```",
        "postTime": 1479307094,
        "uid": 7364,
        "name": "what_trouble",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\n\u66b4\u529b\u7684\u65b9\u7a0b\u662f\u5f88\u597d\u60f3\u5230\u7684\uff1a\n$f[i][p][j][0/1]$\n\n$A$\u4e32\u4e2d\u9009\u4e86\u524d$i$\u4e2a\uff0c\u9009\u4e86$p$\u4e2a\u5b50\u4e32\uff0c\u5339\u914d\u5230\u4e86$B$\u7684\u524d$j$\u4e2a\uff0c$\nA$\u7684\u7b2c$i$\u4e2a\u9009\u4e0d\u9009\u7684\u65b9\u6848\u603b\u6570\n\n\u5982\u4f55\u8f6c\u79fb\uff1f\n\n1.\u524d\u63d0\u662f\u5f53\u524d\u4e32\u53ef\u4ee5\u5339\u914d\u4e0a\n\n- $f[i][p][j][1] += f[i - 1][p][j - 1][1]$\n\n- $f[i][p][j][1] += f[i - 1][p - 1][j - 1][0]$\n\n- $f[i][p][j][1] += f[i - 1][p - 1][j - 1][1]$ \n\n2.\u65e0\u6240\u8c13\uff0c\u80e1\u4e71\u8f6c\u79fb\u4e00\u4e0b\u5c31\u597d\n\n$f[i][p][j][0] += f[i - 1][p][j][0/1]$\n\n\u521d\u59cb\u5316\uff1f\n\n\u8003\u8651\u5230\u521d\u59cb\u7684\u65f6\u5019$p,j$\u90fd\u7b49\u4e8e\u96f6\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u521d\u59cb\u5316\n\n$f[1...n][0][0][0/1] = 1$\n\n\u8fb9\u754c\u5462\uff1f\n\n$i(1 ... n)$\n\n$p(1 ... k)$\n\n$j(1 ... i)$\n\n\n\u590d\u6742\u5ea6? $O(nmk).$\n\n\u8c8c\u4f3c\u8dd1\u4e0d\u6ee1\u3002\u8bd5\u8bd5\u770b\uff1f\n\n\u7b49\u7b49\uff0c\u7a7a\u95f4\u70b8\u4e86\u3002\u6eda\u52a8\u6570\u7ec4\uff1f\u53ef\u884c\uff01\n\n\u8c8c\u4f3c\u4e00\u7ef4\u7684\u4e0d\u597d\u6eda...\u90a3\u5f00\u4e24\u7ef4\u6765\u56de\u6eda\u603b\u884c\u4e86\u5427\uff1f\n\n\u5173\u7cfb\uff1f....\uff08\u60f3\u8d77\u4e86\u7f51\u7edc\u6d41\u5220\u8fb9\uff09\u5f00$0$\u548c$1$\u7136\u540e\u5f02\u6216\u4e00\u4e0d\u5c31\u597d\u4e86\uff1f\n\n\uff08\u4ee5\u4e0a\u6458\u81ea\u6211\u505a\u9898\u65f6\u5199\u7684txt\uff09\n\n$Code:$\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\n\nusing namespace std;\n\nconst int mod = 1e9 + 7;\nconst int N = 1001;\nconst int M = 201;\nbool now;\n\nint n , m , k;\n\nchar a[N] , b[N];\nll f[2][M][M][2];\n\nint main () {\n\tscanf(\"%d %d %d\" ,&n , &m, &k);\n\tscanf(\"%s %s\" , a + 1 , b + 1);\n\tf[0][0][0][0] = f[1][0][0][0] = 1;\n\tfor(int i = 1 ; i <= n ; ++ i , now ^= 1) {\n\t\tfor(int j = 1 ; j <= min(i , m) ; ++ j) {\n\t\t\tfor(int p = 1 ; p <= k ; ++ p) {\n\t\t\t\tif(a[i] == b[j]) {\n\t\t\t\t\tf[now][p][j][1] = f[now ^ 1][p][j - 1][1]+ f[now ^ 1][p - 1][j - 1][0]+ f[now ^ 1][p - 1][j - 1][1];\n\t\t\t\t\tf[now][p][j][1] %= mod;\n\t\t\t\t} else f[now][p][j][1] = 0;\n\t\t\t\tf[now][p][j][0] = (f[now ^ 1][p][j][0] + f[now ^ 1][p][j][1]);\n\t\t\t\tf[now][p][j][0] %= mod;\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%lld\\n\" ,( f[now ^ 1][k][m][0] + f[now ^ 1][k][m][1]) % mod);\n\treturn 0;\n}\n```",
        "postTime": 1572681684,
        "uid": 134080,
        "name": "jins3599",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\u542c\u8bf4NOIP\u6682\u505c\u4e86\uff0c\u6211\u62b1\u7740\u60b2\u75db\u4e07\u5206\u7684\u5fc3\u60c5\u628a\u8fd9\u9053\u9898\u7ed9\u5199\u4e86\u3002QAQ\n\n-----\n### \u672c\u9898\u89e3\u7684\u4eae\u70b9\n1.\u8be1\u5f02\u7684\u9884\u5904\u7406\u65b9\u6cd5\uff08\u4e3b\u8981\u662f\u521d\u59cb\u72b6\u6001\u61d2\u5f97\u60f3\u4e86\uff09\uff0c\u7ed9\u4e0d\u592a\u4f1a\u60f3\u521d\u72b6\u6001\u7684\u4f60\u3002\n\n2.\u8be1\u5f02\u7684\u4f18\u5316\u65b9\u5f0f\uff08\u4e3b\u8981\u662f\u8fb9\u505a\u8fb9\u5904\u7406\u4e5f\u4e0d\u592a\u4f1a\u60f3\uff09\n\n3.\u6709\u70b9\u8be1\u5f02\u7684\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff0c\u4e3b\u8981\u4e5f\u662f\u6211\u592a\u849f\u4e86\uff0c\u867d\u7136\u5f62\u5f0f\u662f\u5dee\u4e0d\u591a\u7684\u3002\n\n----\n### \u601d\u8def\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n```\ndp[i][j][k]: B\u5339\u5230\u7b2ci\u4f4d\n             A\u5339\u5230\u7b2cj\u4f4d\uff08\u4fdd\u8bc1A[j]\u662f\u6700\u540e\u4e00\u4f4d\uff09\n\t\t\t \u5df2\u7ecf\u7528\u4e86k\u7ec4\n\u6545\u82e5A[j]!=B[i] \u503c\u4e3a0\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\tdp[i][j][k]=dp[i][j-1][k]+dp[i-1][x][k-1]\n\t\t1 <= x <= j-1\n\t\u89e3\u91ca\uff1a\n\t\tdp[i][j-1][k] A[j]\u63a5\u5728A[j-1]\u540e\u9762\n\t\tdp[i-1][x][k-1] A[j]\u53e6\u8d77\u95e8\u6237\n\t\u521d\u59cb\u5316\uff1a\n\t\t\u628a\u6240\u6709\u7b2c\u4e00\u7ec4\u7684\u7b2c\u4e00\u4e2a\u7684dp\u503c\u5904\u7406\u51fa\u6765\u5c31\u597d\u4e86\n\t\t\u5373dp[1][j][1]=1 \u5f53\u4e14\u4ec5\u5f53A[j]==B[1]\n    \u7b54\u6848\uff1a\n\t\t\u6240\u6709\u7684dp[m][n][K]\u4e86\n```\n\n\n\u7136\u540e\u7167\u7740\u8fd9\u4e2a\u601d\u8def\u5199\u51fa\u7684\u4ee3\u7801\u662f\u8fd9\u6837\u7684\uff1a(\u6ce8\u610f\uff1a\u6211\u7684\u8f93\u5165\u4e2d\u7684k\u6211\u6362\u6210K\u4e86\uff0c\u4f7f\u5728\u8f6c\u79fb\u4e2d\u4e0d\u91cd\u540d\uff09\n\n```cpp\nFOR(i,1,m) FOR(j,1,n) FOR(k,1,K){\n        if(A[j]!=B[i]) continue;\n        if(i==1&&k==1) dp[i][j][1]=1;\n        else dp[i][j][k]=dp[i-1][j-1][k];\n        FOR(x,1,j-1) dp[i][j][k]=(dp[i][j][k]+dp[i-1][x][k-1])%mod;\n}\n```\n\u4f46\u662f\u8fd9\u6837\u4f1a\u7206\u65f6\u95f4\uff0c\u89c2\u5bdf\u8fd9\u4e2a\u5f0f\u5b50\uff1a\n```cpp\nFOR(x,1,j-1) dp[i][j][k]=(dp[i][j][k]+dp[i-1][x][k-1])%mod;\n\n```\n\n\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e0d\u5c31\u662f\u524d\u7f00\u548c\u5417\uff0c\u4e14\u4ec5\u4e0e i-1 \u7684\u72b6\u6001\u6709\u5173\uff0c\u6240\u4ee5\u6211\u5c31\u5728\u4e00\u5f00\u59cb\u5904\u7406\u4e86\uff1a\n\n```cpp\nFOR(i,1,m){\n        FOR(k,1,K) FOR(j,1,n)\n            Sum[k][j]= (Sum[k][j-1]+dp[i-1][j][k])%mod ;\n        \n        FOR(j,1,n) FOR(k,1,K){\n            if(A[j]!=B[i]) continue;\n            if(i==1&&k==1) dp[i][j][1]=1;\n            else dp[i][j][k]=dp[i-1][j-1][k];\n            dp[i][j][k]=( dp[i][j][k]+Sum[k-1][j-1] )%mod;\n        }\n    }\n```\n\n\u4f46\u662f\u8fd8\u6709\u4e2a\u95ee\u9898\uff0c\u7a7a\u95f4\u53c8\u7206\u4e86\uff0c\u6211\u4eec\u50cf\u505a\u80cc\u5305\u90a3\u6837\u7f29\u4e00\u7ef4\uff0c\u5e76\u5012\u7740\u641c\uff1a\n\n```cpp\nFOR(i,1,m){\n        FOR(k,1,K) FOR(j,1,n)\n            Sum[k][j]= (Sum[k][j-1]+dp[j][k])%mod ;\n        \n        For(j,n,1) For(k,K,1){\n            if(A[j]!=B[i]){\n                dp[j][k]=0; continue; //\u8fd9\u5f88\u91cd\u8981 \uff01\uff01\uff01\n            }\n            if(i==1&&k==1) dp[j][k]=1;\n            else dp[j][k]=dp[j-1][k];\n            dp[j][k]=( dp[j][k]+Sum[k-1][j-1] )%mod;\n        }\n}\n```\n\n\u7136\u540e\u8fd9\u9898\u5c31\u6109\u5feb\u5730A\u4e86 qwq",
        "postTime": 1567091565,
        "uid": 29304,
        "name": "DYI_ZJZGC",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\u4e00\u9053\u672c\u6765\u633a\u6b63\u5e38\u7684DP\uff0c\u786c\u751f\u751f\u8ba9\u6211\u6bd2\u7624\u4e86\u534a\u5929\u3002\u3002\u3002\n\n\u9898\u610f\uff1a\u5728$A$\u4e32\u91cc\u62ff\u51fa$k$\u4e2a\u5b50\u4e32\uff0c\u4ee4\u4e4b\u4e0e$B$\u4e32\u76f8\u7b49\uff0c\u6c42\u65b9\u6848\u6570\u3002\n\n\u770b\u8d77\u6765\u597d\u50cf\u6ca1\u6cd5\u4e0b\u624b\u554a\uff1f\u5c31\u7b97\u53bb\u66b4\u529b\uff0c\u8fd9\u4e2a\u66b4\u529b\u600e\u4e48\u6253\u4e5f\u662f\u4e2a\u95ee\u9898\u3002\n\n~~\u4f46\u662f\u53c8\u597d\u50cf\u4e00\u770b\u5c31\u662f$DP$\u3002~~\n\n\u4e0d\u8fc7\uff0c\u8fd9\u4e2a$DP$\u600e\u4e48\u5199\uff1f~~\u6211\u5feb\u88ab\u641e\u75af\u4e86\uff08\u5927\u6982\u662f\u56e0\u4e3a\u8fd9\u7c7b$DP$\u7ec3\u7684\u592a\u5c11\uff09~~\n\n### \u6211\u4eec\u60f3\u66b4\u529b\u4e00\u70b9\uff0c~~\u66b4\u529b$DP$\u4e86\u89e3\u4e00\u4e0b\u3002~~\n\n\u72b6\u6001\u8bbe\u4e3a\uff1a$f[i][j][k]$\u8868\u793a$A$\u4e32\u524d$i$\u4e2a\uff0c\u5339\u914d\u4e86$B$\u4e32\u524d$j$\u4e2a\uff0c\u9009\u4e86$k$\u4e2a\u5b50\u4e32\u7684\u65b9\u6848\u6570\uff0c**\u800c\u4e14\u5f53\u524d\u7684$i$\u548c$j$\u5339\u914d**\u3002\n\n\u7136\u540e\u6bcf\u6b21\u8f6c\u79fb\u4e5f\u66b4\u529b\u4e00\u70b9\uff0c\u4e0d\u662f\u8bf4$A$\u4e32\u524d$i$\u4e2a\u561b\uff0c\u90a3\u6211\u4eec\u5c31\u53bb\u679a\u4e3e\u4e00\u4e0b\u4e0a\u4e00\u6b21\u6700\u540e\u4e00\u4e2a\u662f\u54ea\u4e2a\u548c$j-1$\u5339\u914d\u7684\u3002\u8fd9\u4e9b\u90fd\u9700\u8981\u7edf\u8ba1\u5230$f[i][j][k]$\u91cc\u9762\uff0c\u6240\u4ee5$f[i][j][k]$\u5c31\u9700\u8981\u52a0\u4e0a$f[1][j-1][k-1]$(\u7531\u4e8e\u5f53\u524d\u7684$i$\u548c$j$\u662f\u7b2c$k$\u4e2a,\u90a3\u4e48\u663e\u7136\u4e0a\u4e00\u6b21\u5339\u914d\u662f\u7b2c$k-1$\u4e2a\u5b50\u4e32\uff09$+f[2][j-1][k-1]+f[3][j-1][k-1]+...+f[i-1][j-1][k-1]$\u3002\u800c\u5982\u679c\u5f53\u524d\u7684$i$\u4e0e$j$\u5339\u914d\u548c\u524d\u9762\u7684\u53ef\u4ee5\u8fde\u5728\u4e00\u8d77\uff0c\u90a3\u4e5f\u662f\u4e00\u79cd\u60c5\u51b5\uff0c\u800c\u6b64\u65f6\u5b50\u4e32\u6570\u91cf\u548c\u4e0a\u4e00\u6b21\u5339\u914d\u76f8\u7b49\uff0c\u5373\u8fd8\u8981\u52a0\u4e0a$f[i-1][j-1][k]$\u3002\n\n\u7efc\u4e0a\uff1a$f[i][j][k]=f[1][j-1][k-1]+...f[i-1][j-1][k-1]+f[i-1][j-1][k]$\u6211\u4eec\u53d1\u73b0\u5982\u679c\u771f\u7684\u53bb\u679a\u4e3e\u8fd9\u4e2a$1$\u5230$i-1$\u672a\u514d\u6709\u4e9b\u592a\u7b28\u4e86\uff0c\u4e0d\u5982\u5728\u7b97\u7684\u8fc7\u7a0b\u4e2d\u7528\u53e6\u4e00\u4e2a\u6570\u7ec4$g[i][j][k]$\u7ef4\u62a4\u4e00\u4e0b\u524d\u7f00\u548c\uff0c\u4ee4$g[i][j][k]$==\n$\\sum\\limits_{p=1}^if[p][j][k]$\uff0c\u5219\u539f\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u53d8\u4e3a\uff1a$f[i][j][k]=g[i-1][j-1][k-1]+f[i-1][j-1][k]$.\n\n\u8fd9\u6837\u5199\u4e00\u4e2a$DP$\u51fa\u6765\u5c31\u80fd\u5f97$70pts$\u4e86\uff08\u6ce8\u610f\u7a7a\u95f4\u9650\u5236\uff09\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\n\n### $Code:$\n```\n#include<bits/stdc++.h>\nusing namespace std;\nchar a[1010],b[210];\nint f[501][101][101];//a\u4e32\u524di\u4e2a\uff0cb\u4e32\u524dj\u4e2a\uff0c\u9009k\u4e2a\u5b50\u4e32\u7684\u65b9\u6848\u6570\u3002 \nint g[501][101][101];\nint main(){\n    int n,m,k;\n    cin>>n>>m>>k;\n    scanf(\"%s%s\",a+1,b+1);\n    g[0][0][0]=1;\n    for(int i=1;i<=n;i++){\n    \tg[i][0][0]=1;\n        for(int j=1;j<=m;j++){\n            for(int k1=1;k1<=k;k1++){\n                if(a[i]==b[j]) f[i][j][k1]=(f[i-1][j-1][k1]+g[i-1][j-1][k1-1])%1000000007;\n                else f[i][j][k1]=0;//\u76ee\u524d\u53ef\u4ee5\u7701\u7565\uff0c\u4f46\u6eda\u52a8\u65f6\u5fc5\u987b\u6709\n                g[i][j][k1]=(g[i-1][j][k1]+f[i][j][k1])%1000000007;\n            }\n        }\n    } \n    printf(\"%d\",g[n][m][k]);//\u5f88\u663e\u7136\u7b54\u6848\u9700\u8981\u628af[1...n][m][k]\u5168\u90e8\u7b97\u4e0a\uff0c\u5373\u4e3ag[n][m][k];\n    return 0;\n} \n```\n\u7a7a\u95f4\u4e0d\u591f\u600e\u4e48\u529e\u5462\uff0c\u6211\u4eec\u6ce8\u610f\u5230\u6bcf\u6b21\u7684$f[i][j][k]$\u548c$g[i][j][k]$\u53ea\u4e0e\u4e0a\u4e00\u6b21\u7684$i-1$\u6709\u5173\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u538b\u6389$i$\u8fd9\u4e00\u7ef4\u3002\u800c\u4e14\u76f4\u63a5\u91c7\u7528\u5c31\u5730\u6eda\u52a8\u5c31\u597d\u4e86\uff0c\u4e0d\u7528\u5f00\u6210$[0/1]$\u3002\n\n### $Code:$\n```\n#include<bits/stdc++.h>\nusing namespace std;\nchar a[1010],b[210];\nint f[201][201];//a\u4e32\u524di\u4e2a\uff0cb\u4e32\u524dj\u4e2a\uff0c\u9009k\u4e2a\u5b50\u4e32\u7684\u65b9\u6848\u6570\u3002 \nint g[201][201];\nint main(){\n    int n,m,k;\n    cin>>n>>m>>k;\n    scanf(\"%s%s\",a+1,b+1);\n    g[0][0]=1;\n    for(int i=1;i<=n;i++){\n        for(int j=m;j>=1;j--){//\u5012\u5e8f\u679a\u4e3e\u5c31\u5730\u6eda\u52a8\uff0c\u539f\u7406\u540c01\u80cc\u5305\n            for(int k1=1;k1<=k;k1++){//\u524d\u4e00\u7ef4\u5728\u6eda\u52a8\u65f6\u4e0d\u53d8\uff0c\u6545\u8fd9\u4e00\u7ef4\u4f1a\u8ddf\u7740\u4fdd\u5b58\u4e0b\u6765\uff0c\u8fd9\u4e00\u7ef4\u5c31\u4e0d\u7528\u5012\u5e8f\u4e86\n                if(a[i]==b[j]) f[j][k1]=(f[j-1][k1]+g[j-1][k1-1])%1000000007;\n                else f[j][k1]=0;\n                g[j][k1]=(g[j][k1]+f[j][k1])%1000000007;\n            }\n        }\n    } \n    printf(\"%d\",g[m][k]);\n    return 0;\n} \n```\n$100pts$\u5230\u624b\u3002",
        "postTime": 1539224723,
        "uid": 64611,
        "name": "\u4eba\u6b87\u7269\u5df2\u975e",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "~~\u849f\u84bb\u7684\u7b2c\u4e00\u7bc7\u9898\u89e3~~\n\n\u4e2a\u4eba\u7b2c\u4e00\u773c\u89c9\u5f97\u8fd9\u9053\u9898\u53ef\u80fd\u6bd4\u8f83\u50cf[P1077 \u6446\u82b1](https://www.luogu.org/problemnew/show/P1077)\uff0c\u6240\u4ee5\u4e4b\u540e\u7684DP\u4e0e\u4e4b\u7c7b\u4f3c\u3002\n\n\u8bbe\u5b9a**f[i,j,k]**\u8868\u793a\uff1a\u4ece\u5b57\u7b26\u4e32A\u4e2d\u7684\u524di\u4f4d\u4e2d \u53d6k\u4e2a\u5b50\u4e32 \u62fc\u6210\u5b57\u7b26\u4e32A\u4e2d\u7684\u524dj\u4f4d \u7684\u65b9\u6cd5\u603b\u6570\u3002\n\n\u81ea\u7136\u53ef\u4ee5\u5f97\u5230\n\n**f[i,j,k]=f[i-1,j,k]+sum(f[i-l,j-l,k-1]);(0<l<i)**\n\n\u5176\u4e2d**f[i-1,j,k]**\u8868\u793a\u4e0d\u7528\u5230\u5b57\u7b26\u4e32A\u4e2d\u7684\u7b2ci\u4f4d\u7684\u65b9\u6cd5\u6570\uff1b\n\n**sum(f[i-l,j-l,k-1])**\u8868\u793a\u628a\u4ece\u7b2ci\u4f4d\u5f00\u59cb\u524dl\u4f4d\u5206\u5272\u4e3a\u4e00\u4e2a\u5b50\u4e32\u7684\u65b9\u6848\u6570\uff1b\n\n\u6545\u53ef\u4ee5\u5f97\u5230\u7a0b\u5e8f\uff1a\n```pascal\nfor i:=1 to n do\n  for j:=1 to min(i,m) do\n    for k:=1 to min(j,kk) do\n      begin\n        f[i,j,k]:=f[i-1,j,k];\n        for l:=1 to j do\n          if a[i-l+1]=b[j-l+1] then\n            f[i,j,k]:=f[i,j,k]+f[i-l,j-l,k-1]\n          else\n            break;\n      end;\n```\n\n\u4f46\u662f\u56db\u7ef4\u5faa\u73af\u5bf9\u4e8e\u6570\u636e\u7a0d\u5f3a\u7684\u60c5\u51b5\u5c31\u4f1a\u51fa\u73b0TLE\u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u53ea\u80fd\u5f9780\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u5c06l\u5faa\u73af\u820d\u53bb\uff0c\u518d\u5efa\u7acb\u4e00\u4e2a\u6570\u7ec4\u6765\u5c06\u7d2f\u52a0\u7684\u7ed3\u679c\u50a8\u5b58\u3002\n\n\u6700\u540e\u518d\u628ai\u6570\u7ec4\u6eda\u52a8\u8282\u7701\u7a7a\u95f4\uff0c\u6b64\u9898\u5b8c\u6210\u3002\n\n\u9644\u4ee3\u7801\uff1a\n```\nvar\n  n,m,kk,i,j,k,l,s,x,y,t:longint;\n  a,b:ansistring;\n  dp:array[0..1000,0..200] of longint;//\u50a8\u5b58\u7d2f\u52a0\u7ed3\u679c\n  f:array[0..1,0..200,0..200] of longint;\nfunction min(a,b:longint):longint;\n  begin\n    if a>b then\n      exit(b)\n    else\n      exit(a);\n  end;\nbegin\n  readln(n,m,kk);\n  readln(a);\n  readln(b);\n  for i:=1 to 1000 do\n    dp[i,0]:=1;\n  s:=1000;x:=1;y:=0;\n  for i:=1 to n do//dp\n  begin\n    for j:=1 to min(i,m) do\n      for k:=1 to min(j,kk) do\n        begin\n          f[x,j,k]:=f[y,j,k];\n          if b[j]=a[i] then\n            begin\n              dp[s-i+j,k-1]:=(dp[s-i+j,k-1]+f[y,j-1,k-1]) mod 1000000007;\n              f[x,j,k]:=(f[x,j,k]+dp[s-i+j,k-1]) mod 1000000007;\n            end\n          else\n            dp[s-i+j,k-1]:=0;\n        end;\n    t:=x;\n    x:=y;\n    y:=t;//\u6eda\u52a8\u6570\u7ec4\n  end;\n  write(f[y,m,kk]);\nend.\n```",
        "postTime": 1533694413,
        "uid": 68281,
        "name": "Sefre",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "### \u3010\u9898\u610f\u63cf\u8ff0\u3011\n\u6709\u4e24\u4e2a\u5b57\u7b26\u4e32\uff0c\u8981\u4ece A \u4e2d\u627e\u51fa\u591a\u4e2a\u5b50\u4e32\uff0c\u4f7f\u5f97\u65b0\u4e32\u4e0e B \u76f8\u7b49\u3002\n\n### \u3010\u5206\u6790\u3011\n\u8fd9\u9053\u9898\u662f\u771f\u7684\u6ca1\u6709\u601d\u8def\uff0c\u7136\u540e\u6211\u5c31~~\u6084\u54aa\u54aa\u7684~~\u770b\u4e86\u5404\u4f4d\u5927\u4f6c\u7684\u9898\u89e3\uff0c\u603b\u7b97\u77e5\u9053\u4e86 dp \u7684\u9b45\u529b\u3002\u5b9a\u4e49 dp[ i ][ j ][ k ]\u4e3a A \u4e32\u4f4d\u7f6e\u5230\u4e86 i \uff0cB \u4e32\u5230\u4e86 j \uff0c\u5df2\u7ecf\u7528\u4e86 k \u4e2a\u5b50\u4e32\u7684\u6700\u5927\u503c\u3002\u6240\u4ee5\uff1a\n\n\u5f53 A[ i ] = B[ j ] \u65f6\uff0cdp[ i ][ j ][ k ] = dp[ i-1 ][ j-1 ][ k ] + dp[ i-1 ][ j-1 ][ k-1 ]\uff1b\n\n\u53e6\u5916\u7684\uff0c\u76f4\u63a5\u8d4b 0\uff1b\n\n\u4f46\u662f\u8fd9\u6837\u7684\u7a7a\u95f4\u80af\u5b9a\u4f1a\u70b8\uff0c\u6240\u4ee5\u8003\u8651\u5c06\u7b2c\u4e00\u7ef4\u7684 i \u7ed9\u5220\u53bb\u3002\u56e0\u4e3a\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u6bcf\u4e00\u4e2a i \u90fd\u4e0e \u4e0a\u4e00\u4e2a i \u76f8\u5173\u8054\uff0c\u90a3\u4e48\u8fd9\u4e00\u7ef4\u76f4\u63a5\u53bb\u6389\uff0c\u7136\u540e\u6bcf\u6b21\u5f15\u7528\u4e0a\u4e00\u4e2a\u7684\u5c31\u53ef\u4ee5\u4e86\u3002\n\n### \u3010\u6838\u5fc3\u4ee3\u7801\u3011\nsum[ i ][ j ]\u7528\u6765\u50a8\u5b58\u4e0a\u4e00\u6b21\u7684\u60c5\u51b5\uff0c\u5728\u6bcf\u6b21\u5224\u65ad\u5b8c\u540e\uff0c\u5982\u679c\u4e0d\u7b49\u5c31\u8d4b\u4e3a 0\uff0c\u5982\u679c\u76f8\u7b49\u5c31\u4e0e\u4e0a\u4e00\u6b21\u7684\u76f8\u52a0\u3002\uff08\u6700\u540e\u522b\u5fd8\u4e86\u53d6\u6a21\u54e6~\uff09\n```cpp\nfor(int i = 1; i <= n; i++)\n{\n\tfor(int j = m; j >= 1; j--)\n\t{\n\t\tfor(int k = K; k >= 1; k--)\n\t\t{\n\t\t\tif(s1[i - 1] == s2[j - 1])\n\t\t\t{\n\t\t\t\tsum[j][k] = (sum[j - 1][k] + f[j - 1][k - 1]) % INF;\n\t\t\t\tf[j][k] = (f[j][k] + sum[j][k]) % INF;\n\t\t\t}\n\t\t\telse\n\t\t\t\tsum[j][k] = 0;\n\t\t}\n\t}\n}\n```\n### \u3010\u6b63\u89e3\u3011\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\n\nconst int INF = 1000000007;\nint n, m, K;\nll f[201][201], sum[201][201];\nchar s1[5050], s2[5050];\n\nint main()\n{\n// \tfreopen(\"substring.in\", \"r\", stdin);\n// \tfreopen(\"substring.out\", \"w\", stdout);\n\tcin >> n >> m >> K;\n\tcin >> s1 >> s2;\n\tf[0][0] = 1;\n\tfor(int i = 1; i <= n; i++)\n\t{\n\t\tfor(int j = m; j >= 1; j--)\n\t\t{\n\t\t\tfor(int k = K; k >= 1; k--)\n\t\t\t{\n\t\t\t\tif(s1[i - 1] == s2[j - 1])\n\t\t\t\t{\n\t\t\t\t\tsum[j][k] = (sum[j - 1][k] + f[j - 1][k - 1]) % INF;\n\t\t\t\t\tf[j][k] = (f[j][k] + sum[j][k]) % INF;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tsum[j][k] = 0;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tcout << f[m][K];\n\t\n\treturn 0;\n}\n```",
        "postTime": 1532514775,
        "uid": 71084,
        "name": "\u5e05\u5230\u62a5\u8b66",
        "ccfLevel": 0,
        "title": "\u5b50\u4e32"
    },
    {
        "content": "\u7528f[i][j][k]\u8868\u793aa\u4e32\u5339\u914d\u5230i\uff0cb\u4e32\u5339\u914d\u5230j\uff0c\u5206\u4e86k\u5757,\u5e76\u4e14\u6210\u529f\u5339\u914d\u7684\u65b9\u6848\u6570\u3002\n\n\u5f53a[i]!=b[j]\u65f6\uff0cf[i][j][k]=0\n\n\u5f53a[i]==b[j]\u65f6\uff0cf[i][j][k]=f[i-1][j-1][k]+sum(f[1][j-1][k-1],f[2][j-1][k-1]\u2026\u2026f[i-1][j-1][k-1])\u3002\u4e5f\u5c31\u662f\u4e0d\u65b0\u5206\u4e00\u4e2a\u5757\u7684\u60c5\u51b5+\u65b0\u5206\u4e00\u4e2a\u5757\u7684\u60c5\u51b5\u3002\u800c\u5bf9\u4e8esum\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u6570\u7ec4\u8fdb\u884c\u8bb0\u5f55\uff0c\u4e5f\u5c31\u662f\u6bcf\u6b21\u5904\u7406\u5b8cf[i][j][k],\u5c31\u52a0\u4e00\u4e0b\u3002\n\n\u7531\u4e8e\u53eai\u6d89\u53ca\u5230i\u548ci-1\uff0c\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u628a\u8fd9\u4e00\u7ef4\u7701\u6389\uff0c\u5728\u5904\u7406\u7684\u65f6\u5019\uff0cj\u3001k\u5012\u5e8f\u679a\u4e3e\u5373\u53ef\u3002\u53ef\u4ee5\u89e3\u51b3\u5f00\u4e0d\u4e0b\u7684\u95ee\u9898\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nconst int mod=1e9+7;\nint n,m,k;\nint sum[210][210],f[210][210];\nchar a[1100],b[210];\nint main()\n{\n\tchar tmp[10];\n    scanf(\"%d%d%d\",&n,&m,&k);\n    scanf(\"%s%s\",a+1,b+1);\n    sum[0][0]=1;\n    for(int i=1;i<=n;i++)\n        for(int j=m;j>=1;j--)\n            for(int p=k;p>=1;p--)//\u5012\u5e8f\u679a\u4e3e\uff0c\u76f8\u5f53\u4e8e\u6eda\u52a8\u6570\u7ec4\n            {\n                if(a[i]!=b[j])\n                {\n                    f[j][p]=0;\n                    continue;\n                }\n                f[j][p]=(f[j-1][p]+sum[j-1][p-1])%mod;\n                sum[j][p]=(f[j][p]+sum[j][p])%mod;//\u8bb0\u5f551~i\u7684f[j][p]\u7684\u65b9\u6848\u548c\n            }\n    cout<<sum[m][k];\n\treturn 0;\n}\n```",
        "postTime": 1532507327,
        "uid": 21874,
        "name": "hicc0305",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\u72b6\u6001`f[k][i][j]` \u8868\u793a\u5728$s1$\u7684\u524d$i$\u4e2a\u5b57\u7b26\u4e2d\u9009\u62e9\u9009\u62e9\u4e86$k$\u4e2a\u5b50\u4e32, \u548c$s2$\u7684\u524d$j$\u4e2a\u5b57\u7b26\u5339\u914d\u6240\u80fd\u6210\u529f\u5339\u914d\u7684\u4e2a\u6570\n\n\u8f6c\u79fb `f[k][i][j] += f[k - 1][i'][j']`   \u5176\u4e2d$i'$ \u548c$j'$ \u662f\u8868\u793a$s1$\u7684 $i$ \u5230 $i'$ \u4e0e $s2$\u7684$j$ \u5230 $j'$ \u76f8\u540c(\u5176\u5b9e\u5c31\u662f\u679a\u4e3e\u6700\u540e\u4e00\u4e2a\u5b50\u4e32)\n\n\u4f46\u7a7a\u95f4\u5f00\u4e0d\u4e0b, \u9700\u8981\u6eda\u52a8\u6570\u7ec4\u628a$k$ \u6eda\u4e86.\n\n\u8fd8\u6709\u5c31\u662f\u8fd9\u4e2a$O(n^4) $\u7684\u590d\u6742\u5ea6, \u4f46\u53ef\u4ee5\u4ece\u679a\u4e3e\u6700\u540e\u4e00\u4e2a\u5b50\u4e32\u90a3\u91cc\u4f18\u5316\u4e00\u7ef4, \u5177\u4f53\u4f18\u5316\u770b\u4ee3\u7801\n\n\n\n\n\n    \n    \n    \n    \n        \n                \n                \n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#define MOD 1000000007\nusing namespace std;\nconst int N = 1003;\nchar s[N];\nchar c[N];\nint f[2][N][202];\nint sum[N][N * 3];\nint next[N][202];\nint main() {\n    int n, m, tim;\n    scanf(\"%d %d %d\", &n, &m, &tim);\n    scanf(\"%s %s\", &s[1], &c[1]);\n    for (int i = 0; i <= n; i++) f[0][i][0] = 1, sum[i][i + N] = 1;\n    int o = 0;\n    for (int i = 1; i <= n; i++) { // \u9884\u5904\u7406\u524d\u7f00\u548c (f[k][i][j] += f[k - 1][i - len][j -len], \u53ef\u4ee5\u8f6c\u6362\u6210\u524d\u7f00\u548c)\n        for (int j = 1; j <= m; j++) {\n            sum[i][i - j + N] = sum[i - 1][i - j + N] + f[o][i][j];\n            sum[i][i - j + N] %= MOD;\n        }\n    }\n    for (int i = 1; i <= n; i++) { // next[i][j]\u8868\u793a s1\u7684i\u4f4d\u7f6e\u548c s2\u7684j\u4f4d\u7f6e \u7684\u6700\u957f\u76f8\u540c\u540e\u7f00\n        for (int j = 1; j <= m; j++) {\n            int limit = min(i, j), l;\n            for (l = 1; l <= limit; l++)\n                if (s[i - l + 1] != c[j - l + 1]) break;\n            next[i][j] = l;\n        }\n    }\n    for (int k = 1; k <= tim; k++) {\n        o ^= 1;\n        memset(f[o], 0, sizeof(f[o]));\n        for (int i = 1; i <= n; i++) {\n            for (int j = 1; j <= m; j++) {\n                f[o][i][j]= f[o][i - 1][j];\n                int l = next[i][j];\n                if (i - l < 0) f[o][i][j] += sum[i - 1][i - j + N];\n                else f[o][i][j] += (sum[i - 1][i - j + N] + MOD - sum[i - l][i - j + N] ) % MOD;\n                //    \u7b49\u4ef7\u4e8e f[k][i][j] += f[k - 1][i - len][j -len], \u53ea\u4e0d\u8fc7\u7528\u524d\u7f00\u548c\u53ef\u4ee5\u5c11\u4e0d\u7528\u679a\u4e3elen\n                f[o][i][j] %= MOD;\n            }\n        }\n        memset(sum, 0, sizeof(sum));\n        for (int i = 1; i <= n; i++) {\n            for (int j = 1; j <= m; j++) {\n                sum[i][i - j + N] += (sum[i - 1][i - j + N] + f[o][i][j]) % MOD;\n                sum[i][i - j + N] %= MOD;\n            }\n        }\n    }\n    printf(\"%d\\n\", f[o][n][m]);\n    return 0;\n}\n\n```",
        "postTime": 1509773424,
        "uid": 49078,
        "name": "acfox",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\n\u5bf9\u697c\u4e0b\u7684\u4ee3\u7801\u63d0\u70b9\u5efa\u8bae\uff0c\u50cf01\u80cc\u5305\uff0c\u628aj\u5012\u7740\u5faa\u73af\uff0c\u53ef\u4ee5\u505a\u5230\u538b\u7ef4 \u3002\n\n\u53ea\u9700\u8981\u5f00\u4e8c\u4f4d\uff0c\u5185\u5b58\u6781\u5c0f.\n\n\u601d\u8def\u662f\u6284\u88ad\u7684\u697c\u4e0b\u7684\uff1a\n\nf[j][k]\uff1a\u4e00\u5b9a\u53d6\u5230a[i]\u65f6\uff0c\u5728B\u7684\u524dj\u4f4d\u4e2d\u53d6\u4e86k\u4e2a\u5b50\u4e32\u7684\u65b9\u6cd5\u6570\n\n\u8003\u8651a[i]\u662f\u5355\u72ec\u6210\u4e00\u4e2a\u5b50\u4e32(f[j-1][k])\u8fd8\u662f\u4e0e\u524d\u9762\u7684\u5408\u6210\u4e00\u4e2a\u5b50\u4e32(g[j-1][k-1])\n\ng[j][k]:A\u7684\u524di\u4f4d\uff0cB\u7684\u524dj\u4f4d\u53d6\u4e86k\u4e2a\u5b50\u4e32\u7684\u65b9\u6cd5\u6570\uff08\u5bf9\u662f\u5426\u53d6\u5230a[i]\u6ca1\u6709\u8981\u6c42\uff09\n\n\u8003\u8651a[i]\u7684\u53d6(f[j][k])(f\u4e00\u5b9a\u5728g\u4e4b\u524d\u66f4\u65b0\u5230)\u6216\u4e0d\u53d6(g[j][k])\n\n\u7ed3\u679c:g[m][k];\n\n\u8fb9\u754c\uff1af[0][0]=g[0][0]=1\n\n\n\n```cpp\n#include<cstdio>\nusing namespace std;\nconst int mod=1000000007;\nchar a[1001],b[201];\nint n,m,k1,f[201][201],g[201][201];\nint main()\n{\n    scanf(\"%d%d%d\",&n,&m,&k1);\n    scanf(\"%s%s\",a,b);\n    f[0][0]=g[0][0]=1;\n    for (int i=1; i<=n; i++)\n        for (int j=m; j>=1; j--)\n            for (int k=1; k<=k1; k++)\n            {\n                if (a[i-1]!=b[j-1]) {f[j][k]=0; continue;}\n                f[j][k]=(f[j-1][k]%mod+g[j-1][k-1]%mod)%mod;\n                g[j][k]=(g[j][k]%mod+f[j][k]%mod)%mod;//\u8981\u4e0d\u65ad\u7684% \n            }\n    printf(\"%d\",g[m][k1]);\n    return 0;\n}\n```\n/\\*\n6 3 3\naabaab\naab\n\n7\n\\*/",
        "postTime": 1508459513,
        "uid": 48036,
        "name": "\u79cb\u65e5\u79c1\u8bed",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "/\\*\n\u72b6\u6001f[i][j][k] \u8868\u793aA\u4e32\u5339\u914d\u5230i B\u4e32\u5339\u914d\u5230j \u7528\u4e86k\u4e2a\u5b50\u4e32\n\n\u8f6c\u79fb\u7684\u8bdd f[i][j][k]=f[i-1][j-1][k]+f[i-1][j-1][k-1]\u5206\u522b\u8868\u793ai\u662f\u4e0d\u662f\u5efa\u7acb\u4e86\u4e00\u4e2a\u65b0\u7684\u5b50\u4e32\n\n\u5f53\u7136\u8fd9\u662f\u6211\u4eec\u4f1a\u53d1\u73b0 \u8fd9\u6837\u7684\u72b6\u6001\u662f\u9ed8\u8ba4\u4e86i\u7528\u4e86 \u663e\u7136i\u53ef\u4ee5\u4e0d\u7528 \u4e5f\u5c31\u662f\u8bf4\u8fd9\u6837\u5c31\u9057\u6f0f\u4e86\u8bb8\u591a\u72b6\u6001\n\n\u6211\u4eec\u91cd\u65b0\u5b9a\u4e49\u4e00\u4e0b\u4ed6 \u52a0\u4e00\u7ef401\u8868\u793ai\u7528\u4e86\u6ca1\u7528 f[i][j][k][0\u62161]\n\n\u8fd9\u6837\u8f6c\u79fb\u5c31\u8981\u5206\u5f00\u8003\u865101\n\nf[i][j][k][0]=f[i-1][j][k][0]+f[i-1][j][k][1]\u56e0\u4e3ai\u6ca1\u6709\u7528 \u6240\u4ee5\u4e0d\u4f1a\u6709\u65b0\u4e32k\u4e0d\u53d8 B\u4e32\u4e5f\u4e0d\u4f1a\u66f4\u65b0\u5339\u914dj\u4e0d\u53d8\n\nf[i][j][k][1]=\n\n+f[i-1][j-1][k-1][0]\n\n+f[i-1][j-1][k][1]\n\n+f[i-1][j-1][k-1][1]\n\n\\*/\n```cpp\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#define mod 1000000007\n#define maxn 210\nusing namespace std;\nint n,m,p,s,f[2][maxn][maxn][2];\nchar A[maxn*5],B[maxn];\nint main()\n{\n    scanf(\"%d%d%d\",&n,&m,&p);\n    scanf(\"%s%s\",A+1,B+1);\n    for(int i=1;i<=n;i++)\n      {\n          f[i%2][1][1][0]=s;\n        if(A[i]==B[1])f[i%2][1][1][1]=1,s++;\n          for(int j=2;j<=m;j++)\n          for(int k=1;k<=p;k++)\n            {\n                f[i%2][j][k][0]=(f[(i+1)%2][j][k][0]+f[(i+1)%2][j][k][1])%mod;\n                if(A[i]==B[j])\n                  f[i%2][j][k][1]=((f[(i+1)%2][j-1][k-1][1]+f[(i+1)%2][j-1][k][1])%mod+f[(i+1)%2][j-1][k-1][0])%mod;\n            }\n        for(int j=1;j<=m;j++)\n          for(int k=1;k<=p;k++)\n            f[(i+1)%2][j][k][1]=f[(i+1)%2][j][k][0]=0;\n      }\n    printf(\"%d\\n\",(f[n%2][m][p][0]+f[n%2][m][p][1])%mod);\n    return 0;\n}\n```",
        "postTime": 1502969689,
        "uid": 20833,
        "name": "\u5b89\u597d",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "/\\*\n\u7efc\u5408\u6027\u5f88\u5f3a\uff0c\u601d\u7ef4\u91cf\u8f83\u5927\u7684\u597d\u9898\u3002\n\ndp+\u4f18\u5316+\u6eda\u52a8\n\n\u4e00\u300170\u5206\uff1a\u7b80\u5355O(n\\*m^3)\u66b4\u529b\u7684dp\u3002\n\nf[i][j][k] \u6bcd\u4e32i\u4e4b\u524d\u4f4d\u7f6e\uff0c\u5339\u914d\u5230\u5b57\u4e32\u7684j\u4f4d\u7f6e\uff0ck\u90e8\u5206\u65b9\u6848\u6570\u3002\n\nf[i][j][k]=f[i-1][j][k]+f[i-l][j-l][k-1](l\u4e3a\u521a\u597d\u4e0d\u80fd\u76f8\u5339\u914d\u7684\u90a3\u4e00\u4f4d\u7f6e)\n\n\u4e8c\u300190\u5206\uff1a\u4f18\u5316dp\u65f6\u95f4\uff0cO(n\\*m^2)\u3002\n\n\u7531\u4e8e\u72b6\u6001\u590d\u6742\u5ea6\u5df2\u7ecf\u4e3aO(n\\*m^2)\uff0c\u663e\u7136\u5747\u4e3a\u6709\u7528\u7684\u72b6\u6001\uff0c\u8003\u8651\u5728\u72b6\u6001\u8f6c\u79fb\u4e0a\u4f18\u5316\u4e3a\u5e38\u6570\u3002\n\n\u4ed4\u7ec6\u89c2\u5bdf\uff1a(\u8bbe\u521a\u597d\u4e0d\u80fd\u5339\u914d\u7684\u539f\u4e32\u4e0e\u5b57\u4e32\u7684\u4f4d\u7f6e\u4e3al1,l2)\n\nf[i][j][k]=f[i-1][j][k]+(f[i-1][j-1][k-1]+..+f[l1][l2][k-1])\n\nf[i-1][j-1][k]=f[i-2][j-1][k]+(f[i-2][j-2][k-1]+..+f[l1][l2][k-1])\n\n\u53d1\u73b0\u4e0e\u4e4b\u524d\u67d0\u4e00\u72b6\u6001\u4ea7\u751f\u4e86\u91cd\u53e0\u3002\n\n\u6b23\u559c\u4e4b\u4f59\uff0c\u5f97\u5230f[i][j][k]=(f[i-1][j-1][k]-f[i-2][j-1][k]+f[i-1][j-1][k-1])+f[i-1][j][k]\n\n\u4f46\u662f\u4e5f\u8bb8l1=i-1,l2=j-1\uff0c\u5373\u6b64\u4e3a\u7d2f\u52a0\u7684\u7b2c\u4e00\u4e2a\u6570\u3002\u53ea\u9700\u8ba8\u8bba\u4e00\u4e0b\u5373\u53ef\u3002\n\n\u8f6c\u79fb\u7684\u65f6\u95f4\u56e0\u6b64\u964d\u4e3a\u5e38\u6570\u9636\u3002\n\n\u81f3\u6b64\u7b97\u6cd5\u6027\u80fd\u5df2\u6709\u5de8\u5927\u98de\u8dc3\u3002\n\n\u4e09\u3001100\u5206\uff1a\u4f18\u5316dp\u7a7a\u95f4\uff0c\u4e0a\u6eda\u52a8\u6570\u7ec4\uff0c\u7a7a\u95f4O(m^2)\u3002\n\n\u7406\u8bba\u4e0a\u76f4\u63a5\u6eda\u52a8\u5373\u53ef\uff0c\u4f46\u662f\u65b9\u7a0b\u4e2d\u51fa\u73b0\u4e86\u8de8\u5ea6\u4e3a2\u7684\u72b6\u6001\u3002\n\n\u8003\u8651\u80fd\u5426\u8ba9j\u5012\u7740\u5faa\u73af\uff0c\u4ee5\u9632\u6b62i-2\u7684\u72b6\u6001\u4e0e\u65b0\u72b6\u6001\u76f8\u51b2\u7a81\u3002\n\n\u4e4d\u4e00\u770b\u6ca1\u95ee\u9898\uff0c\u4f46\u662f\u7ed3\u5408\u65b9\u7a0b\uff0c\u53d1\u73b0\u8fd9\u6837\u505a\u6b21\u5e8f\u9519\u4e86\uff0c\u65b9\u7a0b\u5c31\u9519\u4e86\u3002\n\n\u56e0\u6b64\u5f97\u60f3\u5176\u5b83\u7684\u65b9\u6cd5\uff0c\u8003\u8651\u5230\u65b0\u5f00\u4e00\u4e2a\u6570\u7ec4\u4e34\u65f6\u5b58\u653e\uff0c\u6ce8\u610ff[]\u7684\u521d\u59cb\u5316\u3002\n\n\u6ce8\u610f\u7ec6\u8282\uff1a\n\n1.\u8fb9dp\u8fb9\u53d6\u6a21\uff0c\u4e0d\u80fd\u5fd8\u8bb0\u3002dp\u524d\u89c2\u5bdf\u6570\u636e\u8303\u56f4\uff0c2\\*mo\u4e0d\u4f1a\u8d85int,\u8fd9\u6837\u624d\u53ef\u4ee5\u653e\u5fc3\u5730\u5f00int\u3002\n\n2.\u72b6\u6001\u8f6c\u79fb\u5b58\u5728\u51cf\u6cd5\u9700\u6ce8\u610f\u3002\n\n3.\u5f00\u6eda\u52a8\u65f6\u6ce8\u610f\u72b6\u6001\u7684\u51b2\u7a81\u3002\n\n4.\u6ce8\u610f\u5339\u914d0\u4e2a\u7684\u8fb9\u754c\uff0c\u7531\u4e8e\u521d\u59cb\u5316\u8fc7\uff0c\u4e4b\u540e\u4e0d\u7406\u776c\u5373\u53ef\u3002\n\n\\*/\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<cstring>\n#include<cstdlib>\n#define mo 1000000007\nusing namespace std;\nint f[2][201][201],g[201][201];\nchar a[1001],b[201];\nint i,j,k,l,n,m,p,len;\nint main()\n{\n    memset(f,0,sizeof(f));\n    scanf(\"%d%d%d\",&n,&m,&p); gets(a);\n    a[0]=b[0]=1;\n    gets(a+1); gets(b+1);\n    f[1][0][0]=1; f[0][0][0]=1;\n    for (i=1; i<=n; i++) {\n        int t1=i&1, t2=(i-1)&1;\n        if (i>1)\n            for (j=1; j<=m; j++)\n                for (k=1; k<=p; k++) {\n                    g[j][k]=f[t1][j][k];\n                    f[t1][j][k]=0; //init\n                }\n        for (j=1; j<=min(i,m); j++)\n        {\n            if (a[i]==b[j]) {\n                for (k=1; k<=p; k++)\n                    if (j==1) f[t1][j][k]=f[t2][j-1][k-1];\n                    else {\n                        f[t1][j][k]=(f[t2][j-1][k]-g[j-1][k]+f[t2][j-1][k-1])%mo;\n                        if (f[t1][j][k]<0) f[t1][j][k]+=mo;\n                    }\n            }\n            for (k=1; k<=p; k++) \n                f[t1][j][k]=(f[t1][j][k]+f[t2][j][k])%mo;\n        }\n    }\n    printf(\"%d\",f[n&1][m][p]);\n    return 0;\n} //f[i][j][k] \u6bcd\u4e32i\u4f4d\u7f6e\u4f4d\u7f6e\uff0c\u5339\u914d\u5230\u5b57\u4e32\u7684j\u4f4d\u7f6e\uff0ck\u90e8\u5206\u65b9\u6848\u6570\u3002\n\n```",
        "postTime": 1480170018,
        "uid": 19884,
        "name": "\u7fe0\u7af9\u53f6\u98de",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\u5982\u4f55\u505a\uff0c \u4e4b\u524d\u7684\u795e\u7287\u5df2\u7ecf\u8bf4\u7684\u5f88\u6e05\u695a\u4e86\u3002 \u6211\u8bf4\u70b9\u522b\u7684\u4e1c\u897f\uff0c \u5c31\u662f\u4f18\u5316\u3002\n\n\u6211\u770b\u4ed6\u4eec\u6ca1\u5565\u4f18\u5316\uff0c \u602a\u4e0d\u5f97\u8dd1\u8fd9\u4e48\u6162\u3002\uff08\u6211\u770b\u518d\u66b4\u529b\u70b9\u5c31\u8d85\u65f6\u4e86\u3002\u3002\u3002\uff09\n\n\u9996\u5148\u8fb9\u754c\u6ca1\u4ed6\u4eec\u8bf4\u5f97\u90a3\u4e48\u590d\u6742\uff0c\n\n\u4f18\u5316 \u4e00 \uff1a\u5bf9\u4e8e\u4e0d\u5b58\u5728\u7684\u8fb9\u754c\u662f 0\uff1b \uff08\u4f8b\u5982 \u5f53 k > j \u6216 j > i \u7b49\u7b49\uff09\n\n\u5bf9\u4e8e\u5b58\u5728\u7684\u7279\u6b8a\u8fb9\u754c\u662f 1\uff1b \uff08\u6709 f[i][0][0][0] , 0 <= i <= n\uff09\n\n\u6240\u4ee5\u76f4\u63a5\u5728\u5faa\u73af\u5916\u52a0    f[0][0][0][0] = f[1][0][0][0] = 1; \uff08\u56e0\u4e3a\u662f\u6eda\u52a8\u6570\u7ec4\uff09\uff1b\n\n\uff08\u60f3\u4e00\u60f3 \uff0c\u8fd9\u4e2a\u4f18\u5316 \u662f\u4e0d\u662f\u8fd9\u4e2a\u9053\u7406\uff1f\uff09\n\n\u4f18\u5316 \u4e8c \uff1a \u6700\u540e \u6539\u4e00\u4e0b\u5faa\u73af \u7684\u4e0a\u754c \uff08\u5177\u4f53\u770b\u6211\u4ee3\u7801\uff09\n\n\u4e0b\u9762 \u8d34 \u6211\uff08ju ruo\uff09\u7b80\uff08chou\uff09\u6d01 \uff08lou\uff09\u7684\u4ee3\u7801 :\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nconst int N = 1005, M = 205, MOD = 1000000007;\nint n, m, ans, i, K, f[2][M][M][2];\nchar A[N], B[M];\nint main() {\n    scanf(\"%d%d%d\\n\", &n, &m, &K);\n    scanf(\"%s\\n%s\\n\", A+1, B+1);\n    f[0][0][0][0] = f[1][0][0][0] = 1;\n    for(int t = 1; t <= n; t++) {\n        i = t % 2; \n        for(int j = 1; j <= min(t, m); j++) \n        for(int k = 1; k <= min(j, K); k++) {    \n            if(A[t] == B[j]) \n            f[i][j][k][1] = ((f[i^1][j-1][k][1] + f[i^1][j-1][k-1][0]) % MOD + f[i^1][j-1][k-1][1]) % MOD;\n            else f[i][j][k][1] = 0;\n            f[i][j][k][0] = (f[i^1][j][k][0] + f[i^1][j][k][1]) % MOD;\n        }\n        if(f[i][m][K][1]) ans = (ans + f[i][m][K][1]) % MOD;\n    }\n    printf(\"%d\\n\", ans);\n      return 0;\n}\n```",
        "postTime": 1479218265,
        "uid": 18451,
        "name": "\u7b49\u71d5\u8fd8\u6545\u69bb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\u4e00\u9053\u5b57\u7b26\u4e32\u4e0a\u7684dp\u3002\n\n\u56e0\u4e3a\u672c\u4eba\u6280\u672f\u4f4e\u4e0b\uff0c\u65e0\u6cd5\u63d0\u4f9b\u89e3\u9898\u601d\u8def\uff0c\u5c31\u8bb2\u4e00\u4e0b\u505a\u6cd5\u597d\u4e86\uff1a\n\n\n1. \u4ee4f[i][j][k]\u4e3a\n\n- \u5728A\u4e32\u4e2d\u53d6\u5230\u4e86\u7b2ci\u4f4d\uff081~i\u4f4d\u4e0d\u4e00\u5b9a\u5168\u6709\uff0c\u4f46\u4e00\u5b9a\u53d6\u4e86\u7b2ci\u4f4d\uff09\n\n- \u5728B\u4e32\u4e2d\u53d6\u5230\u4e86\u7b2cj\u4f4d\uff081~j\u4f4d\u4e00\u5b9a\u90fd\u53d6\u5230\u4e86\uff09\n\n-\u5171\u53d6\u4e86k\u6b21\n\n2. \u5f97\u51fadp\u65b9\u7a0b\n\n-\u5f53A[i]\u2260B[j]\u65f6\uff0cf[i][j][k] = 0;  //\u663e\u800c\u6613\u89c1\u5427\n\n-\u5f53A[i]=B[j]\u65f6\uff0cf[i][j][k]  = f[1..i-2][j-1][k-1] + f[1..i-3][j-2][k-1](\u5f53A[i-1] = B[j - 1]\u65f6) + f[1..i-4][j-3][k-1](\u5f53A[i-1] = B[j - 1]  && A[i - 2]\n\nf     =B[i-2]\u65f6)\u2026\u2026\n\n\u89e3\u91ca\u4e00\u4e0b\uff1a\u5bf9\u4e8ef[i][j][k](A[i]=B[j])\n\nf                     \u8fde\u7eed\u53d6\u51faA\u4e32\u4e2d\u7b2ci~i-x+1\u4e2a\u5b57\u7b26\uff0c\u5bf9\u5e94B\u4e32\u4e2d\u7b2cj~j-x+1\u4e2a\u5b57\u7b26\uff08\u4fdd\u8bc1\u80fd\u5bf9\u5e94\u4e0a,x\u22651\uff09\n\nf                     \u5219A\u4e32\u4e2d\u8fd8\u6709\u7b2c1~i-x\u4e2a\u5b57\u7b26\uff0cB\u4e32\u4e2d\u8fd8\u67091~j-x\u4e2a\u5b57\u7b26\uff0c\u8fd8\u53ef\u4ee5\u53d6k-1\u6b21\n\nf                     \u6240\u4ee5\u52a0\u4e0af[1..i-x][j-x][k-1]\n\n3. \u521d\u59cb\u5316\uff08\u7565\uff09\n\n4. \u4f18\u5316\n\n-\u5bf9\u4e8ef[1..i-x][j-x][k-1]\u4f7f\u7528\u524d\u7f00\u548c\u4f18\u5316\u6548\u7387\n\n-\u53d1\u73b0 f[1..i-4][j-3][k-1](\u5f53A[i-1] = B[j - 1]  && A[i - 2]=B[i-2]\u65f6) +\u2026\u2026\u5c31\u662ff[i-1][j-1][l],\u6240\u4ee5\u52a0\u4e0af[i-1][j-1][l]\u5373\u53ef\n\n-\u53d1\u73b0f[i][j][k]\u53ea\u53ef\u80fd\u7531f[i'][j'][k]\u548cf[i''][j''][k-1]\u63a8\u51fa\uff0c\u6240\u4ee5\u4f7f\u7528\u6eda\u52a8\u6570\u7ec4\u4f18\u5316\u7a7a\u95f4\n\n\n\\*\u6ce8\uff1a\u672c\u9898\u89e3\u4e2d\u7684\u884c\u9996\u7684\u201cf\u201d\u662f\u5360\u4f4d\u7b26\uff0c\u65e0\u5b9e\u610f\n\n\n```cpp\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\nusing namespace std;\n\nconst int mod = 1000000007;\nconst int maxn = 1001, maxm = 201;\nint n, m, k, ans;\nchar a[maxn], b[maxm];\nint f[2][maxn][maxm], sum[2][maxn][maxm];\nbool B[maxn][maxm];\n\ninline void prepare()  //\u8d4b\u521d\u59cb\u503c  \n{\n    register int i, j, k;\n    for(i = n; i >= 1; i--)\n      a[i] = a[i - 1];\n    for(i = m; i >= 1; i--)\n      b[i] = b[i - 1];\n    a[0] = b[0] = ' ';\n    for(j = 1; j <= m; j++)\n      for(i = j; i <= n; i++) {\n        if(a[i] == b[j] && (B[i - 1][j - 1] || j == 1))\n          f[1][i][j] = 1,B[i][j] = true;\n        sum[1][i][j] = (sum[1][i - 1][j] + f[1][i][j]) % mod;\n      }\n}\n\ninline void solve() //dp\n{\n    register int i, j, l;\n    for(l = 2; l <= k; l++) {    \n      memset(sum[l % 2], 0, sizeof(sum[l % 2]));\n      memset(f[l % 2], 0, sizeof(f[l % 2]));\n      for(j = l; j <= m; j++)\n        for(i = l; i <= n; i++) {\n          if(a[i] != b[j]) \n            f[l % 2][i][j] = 0;\n          else \n            f[l % 2][i][j] = (sum[(l - 1) % 2][i - 1][j - 1] + f[l % 2][i - 1][j - 1]) % mod;\n          sum[l % 2][i][j] = (sum[l % 2][i - 1][j] + f[l % 2][i][j]) % mod;\n        }\n    }\n    ans = sum[k % 2][n][m];\n} \n\nint main()\n{\n    freopen(\"substring.in\", \"r\", stdin);\n    freopen(\"substring.out\", \"w\", stdout);\n    int i, j;\n    scanf(\"%d%d%d\\n\", &n, &m, &k);\n    scanf(\"%s\\n%s\", a, b);\n    prepare();\n    solve();\n    printf(\"%d\", ans);\n    return 0;\n}\n```",
        "postTime": 1476458269,
        "uid": 17156,
        "name": "dsl2002",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\u770b\u5230\u8fd9\u9053\u9898\uff0c\u201d\u6c42\u65b9\u6848\u6570\u201c\u3002\u770b\u5230\u8fd9\u53e5\u8bdd\uff0c\u7a0d\u5fae\u6709\u4e9b\u7ecf\u9a8c\u7684\u4eba\u90fd\u77e5\u9053\u8fd9\u9898\u4e0d\u662f\u7206\u641c\u6216\u679a\u4e3e\u7684\u6c34\u9898\uff08\u653e\u5728\u8fd9\u4e2a\u4f4d\u7f6e\u7684\u9898\u80af\u5b9a\u4e0d\u662f\u6c34\u9898\uff09\uff0c\u90a3\u4e48\u4e00\u5b9a\u662f\u52a8\u6001\u89c4\u5212\uff08\u76f4\u89c9\uff01\uff09\u3002\u597d\u4e86\uff0c\u63a5\u4e0b\u6765\u63a8\u52a8\u6001\u8f6c\u79fb\u65b9\u7a0b\u3002\n\n\n\u535a\u4e3b\u6211\u7684\u52a8\u89c4\u5b66\u5f97\u4e0d\u9519\uff0c\u4f46\u65b9\u7a0b\u8fd8\u662f\u63a8\u4e86\u534a\u4e2a\u591a\u5c0f\u65f6\uff0c\u53ef\u89c1\u9898\u76ee\u7684\u96be\u5ea6\uff08\u8981\u77e5\u9053\u8fd9\u9898\u7684\u8003\u70b9\u4e0d\u53ea\u662f\u52a8\u6001\u8f6c\u79fb\u65b9\u7a0b\uff01\uff01\uff01\uff09\u3002\n\n\n\u5148\u5206\u6790\u52a8\u6001\u8f6c\u79fb\u65b9\u7a0b\uff0c\u8bbef[i][j][l]\u8868\u793aA\u4e32\u53d6i\u4e2a\uff08\u4f46a[i]\u5e76\u4e00\u5b9a\u80fd\u53d6\u5230\uff09,B\u4e32\u53d6j\u4e2a\uff08b[j]\u4e00\u5b9a\u80fd\u53d6\u5230\uff09,\u6b64\u65f6\u7528\u4e86l\u4e2a\u4e32\u7684\u65b9\u6848\u6570\u3002\n\n\n\u7b2c\u4e00\u79cd\u60c5\u51b5\uff1aa[i]==b[j]\n\n\n\nf[i][j][l]=f[i-1][j-1][l]+f[x][j-1][l-1](1<=x<=i-1)\n\n\u7b2c\u4e8c\u79cd\u60c5\u51b5\uff1aa[i]!=b[j]\n\n\n\nf[i][j][l]=0\n\n\u5230\u8fd9\u91cc\uff0c\u5df2\u7ecf\u62ff\u523060\u5206\u4e86\u3002\n\n\n\u5f88\u660e\u663e\uff0cf[x][j-1][l-1]\u7684\u5904\u7406\u6bd4\u8f83\u8017\u65f6\u95f4\uff0c\u90a3\u4e48\u5c31\u5e94\u8be5\u5bf9\u8fd9\u6bb5\u65f6\u95f4\u8fdb\u884c\u4f18\u5316\u3002\u65b9\u6cd5\u5f88\u7b80\u5355\uff0c\u548c\u6570\u7ec4\uff1f\uff01\n\n\n\u4ee4s[i][j][l]=sum(f[x][j][l])(1<=x<=i)\n\n\n\u8fd9\u6837\u53ef\u4ee5\u5c06\u65f6\u95f4\u6548\u7387\u4eceo(n^2mk)\u964d\u4e3ao(nmk)\u73b0\u5728\u65f6\u95f4\u6ee1\u8db3\u4e86\uff0c\u4f46\u8fd8\u53ea\u670990\u5206\uff0c\u4e3a\u4ec0\u4e48\uff1f\n\n\n\u56e0\u4e3a\u7a7a\u95f4\u8d85\u4e86\uff0c\u7531\u4e8e\u6bcf\u6b21\u7684\u8f6c\u79fb\u53ea\u8ddf\u8fd9\u6b21\u548c\u4e0a\u6b21\u72b6\u6001\u6709\u5173\uff0c\u6211\u4eec\u4e0d\u7981\u60f3\u5230\u6eda\u52a8\u6570\u7ec4\uff08\uff0c\u5bf9\uff09\u3002\n\n\n\u901a\u8fc7\u6eda\u8ba2\u6570\u7ec4\u4f18\u5316\u7a7a\u95f4\uff0c\u6ee1\u5206\u4e86\u3002\n\n\n\u5f53\u7136\uff0c\u521d\u59cb\u5316\u4e5f\u662f\u5fc5\u9700\u7684\u3002\n\n\n\u4e0d\u8fc7\u9650\u4e8e\u535a\u4e3b\u7684\u80fd\u529b\u6709\u9650\uff0c\u521d\u59cb\u5316\u6ca1\u6709\u60f3\u51fa\u4f18\u5316\u7684\u65b9\u6cd5\uff0c\u5982\u679c\u60a8\u6709\u597d\u7684\u65b9\u6cd5\uff0c\u6216\u60f3\u4e0e\u535a\u4e3b\u4ea4\u6d41\uff0c\u6b22\u8fce\u52a0qq\u8ba8\u8bba\uff08QQ\u53f7\uff1a2389047486\uff09\n\n\n\u9644\u4e0a\u6807\u79f0\u53ca\u6570\u636e\uff1ahttp://pan.baidu.com/s/1gec4MQn\n",
        "postTime": 1456154243,
        "uid": 10069,
        "name": "cx0627",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\u8fd9\u9898\u76ee\u7b2c\u4e00\u773c\u626b\u8fc7\u53bb\u5c31\u662fDP\uff0c\u72b6\u6001\u7684\u8868\u793a\u719f\u7ec3\u7684\u4eba\u4e5f\u4e0d\u80fd\u60f3\u51fa\u6765\u7528$f[i,j,k]$\u8868\u793a\u5f53$A$\u5339\u914d\u5230\u524d$i$\u4f4d\uff0c$B$\u5b57\u7b26\u4e32\u5339\u914d\u5230$j$\u4f4d\uff0c\u5c06$A$\u5e8f\u5217\u5206\u6210$k$\u6bb5\u65f6\u5019\u6240\u80fd\u5f97\u5230\u7684\u6570\u91cf\u3002\n\n\u603b\u5171\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\n\u4e00\uff1a$i$\u8fd9\u4e00\u4f4d\u4e0d\u4e0e$j$\u5339\u914d\uff0c\u5373\u7528\u524d$i-1$\u53bb\u5339\u914d$B$\u7684\u524d$j$\u4f4d\uff1b\u4e8c\uff1a$i$\u8fd9\u4e00\u4f4d\u4e0e$i$\u524d\u51e0\u4f4d\u80fd\u4e0e$B$\u7684$j$\u8fd9\u4e00\u4f4d\u4e0e\u5176\u524d\u51e0\u4f4d\u4e00\u8d77\u5339\u914d\uff0c\u4f5c\u4e3a\u4e00\u4e2a\u5355\u72ec\u7684\u6bb5\uff08\u4e5f\u5c31\u662f\u6709\u76f8\u540c\u7684\u540e\u7f00\uff09\u3002\u90a3\u4e48\u5c31\u6709$f[i,j,k]=f[i-1][j][k]$(\u4e0d\u5339\u914d)$+\\sum_{L}f[i-L-1][j-L-1][k-1]$(\u6ee1\u8db3$A[i-L..i]=B[j-L..j]$\uff0c\u4e5f\u5c31\u662f\u6240\u8bf4\u7684\u4e00\u8d77\u5339\u914d)\u3002\n\n\u90a3\u4e48\u6ce8\u610f\u597d\u521d\u59cb\u5316\u4e0d\u96be\u5199\u51fa\u4e00\u4e2a\u6734\u7d20\u7684\u4ee3\u7801\uff1a\n```cpp\nfor(int i=0;i<=n;++i) f[i][0][0]=1;\nfor(int i=1;i<=n;i++){\n    for(int j=1;j<=m && j<=i;j++){\n    \tfor(int p=1;p<=k && p<=j;p++){\n            f[i][j][p]+=f[i-1][j][p];\n            for(int l=0;l<i && l<j && A[i-l]==B[j-l];l++)\n                f[i][j][p]+=f[i-l-1][j-l-1][p-1];\n        }\n    }\n}\n```\n\u53ef\u60dc\uff0c\u8fd9\u6837\u5199\u4f1a\u6302\u6389\uff0c\u65f6\u95f4\u548c\u7a7a\u95f4\u4e0a\u90fd\u662f\u3002\u5148\u8003\u8651\u65f6\u95f4\u4e0a\u7684\u4f18\u5316\uff0c\u53ef\u4ee5\u4f18\u5316\u7684\u5730\u65b9\u53ea\u5269\u4e0b\u5faa\u73af\u627e\u4e00\u8d77\u5339\u914d\u7684\u6bb5\u54ea\u91cc\u4e86\u3002\u6211\u4eec\u60f3\u5982\u679c$A[i-L..i]=B[j-L..j]$\u7684\u8bdd\uff0c\u90a3\u4e48$f[i-1,j-1,k]$\u662f\u4e0d\u662f\u4fdd\u5b58\u4e86\u6c42$\\sum_{L}f[i-L-1][j-L-1][k-1]$\u7684\u90a3\u4e00\u6bb5\u5462\uff1f\uff08\u56e0\u4e3a\u5c31\u76f8\u5f53\u4e8e$A[i-1..i]$\u4e0e$B[j-1..j]$\u4e00\u8d77\u5339\u914d\u8fdb\u53bb\u7136\u540e\u7b97\uff09\u3002\n\n\u4f46\u662f\u5982\u679c\u8fd9\u6837\u7b80\u5355\u7684\u6539\u4e00\u4e0b\u4ee3\u7801\u662f\u4e0d\u884c\u7684\uff1a\n```cpp\nfor(int i=0;i<=n;++i) f[i][0][0]=1;\nfor(int i=1;i<=n;i++){\n\tfor(int j=1;j<=m && j<=i;j++){\n        for(int p=1;p<=k;p++){\n            f[i][j][p]+=f[i-1][j][p];\n            if(A[i]==B[j]){\n            \tf[i][j][p]+=f[i-1][j-1][p-1];\n               \tif(A[i-1]==B[j-1])\n               \t\tf[i][j][p]+=f[i-1][j-1][p];\n            }\n        }\n\t}\n}\n```\n\u56e0\u4e3a\u8fd9\u91cc\u7684$f$\u6570\u7ec4\u4fdd\u5b58\u7684\u4fe1\u606f\u4e0d\u4e00\u5b9a\u80fd\u6784\u6210\u8fde\u7eed\uff0c\u5b83\u4e5f\u4f1a\u4fdd\u5b58\u524d\u9762\u4e0d\u80fd\u8fde\u7eed\u5339\u914d\u7684\u6570\u636e\uff0c\u6bd4\u5982\u8fd9\u7ec4\u6570\u636e:\n\n```cpp\n6 3 2 \naabaab \naab\n```\n\u6309\u7167\u4e0a\u9762\u4ee3\u7801\u8dd1\u51fa\u6765\u7684$f[4,1,1]=3$\u8fd9\u672c\u8eab\u6ca1\u9519\uff0c\u4f46\u662f\u770b$f[5,2,2]=f[4,2,2]+f[4,1,0]+f[4,1,1]=1+0+3=4$\uff0c\u663e\u7136\u6709\u8bef\u3002\u4ed4\u7ec6\u601d\u8003\u5c31\u4f1a\u53d1\u73b0\u6211\u4eec\u53ef\u4ee5\u65b0\u5efa\u4e00\u4e2a\u6570\u7ec4$g$\uff0c\u5f53$A[i]!=B[j]$\u7684\u65f6\u5019\u628a$g$\u7f6e\u4e3a$0$,\u5f53$A[i]=B[j]$\u7684\u65f6\u5019\u4ee4$g[i][j][k]=g[i-1][j-1][k]$(\u548c\u524d\u9762\u8fde\u7eed\u7684\u4e00\u540c\u6784\u6210\u8fd9\u7b2ck\u6bb5)$+f[i-1][j-1][k-1]$(\u5355\u72ec\u6784\u6210\u7b2ck\u6bb5)\uff0c\u800c$f[i][j][k]=g[i][j][k]+f[i-1][j][k]$\u5c31\u884c\u4e86\u3002\n\n\u7136\u540e\u5c31\u662f\u7a7a\u95f4\u7684\u4f18\u5316\u4e86\uff0c\u50cf\u80cc\u5305\u4e00\u6837\u628a\u7b2c\u4e00\u7ef4\u7701\u7565\u6389\uff0c\u7b2c\u4e8c\u4f4d\u5012\u5e8f\u5faa\u73af\u5c31ok\u4e86\u3002\n\n\u6700\u540e\u9644\u4e0a\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1005,M=205,mod=1000000007;\ntypedef long long ll;\n\nchar A[N],B[N];\nll f[M][M],g[M][M];\nint n,m,k;\n\nint main(){\n\tscanf(\"%d%d%d\",&n,&m,&k);\n\tscanf(\"%s\",A+1);\n\tscanf(\"%s\",B+1);\n\tf[0][0]=1;\n    for (int i=1;i<=n;i++){\n        for(int j=min(m,i);j>=1;j--) {\n            for(int p=1;p<=k && p<=j;p++) {\n            \tif(A[i]==B[j])  g[j][p]=(g[j-1][p]+f[j-1][p-1])%mod;\n        \t\telse g[j][p]=0;\n                f[j][p]=(g[j][p]+f[j][p])%mod;\n            }\n        }\n    }\n\tprintf(\"%lld\",f[m][k]%mod);\n\treturn 0;\n}\n```\n",
        "postTime": 1572187872,
        "uid": 202048,
        "name": "Asika391",
        "ccfLevel": 0,
        "title": "[NOIP2015] \u5b50\u4e32 \u9898\u89e3"
    },
    {
        "content": "\n1. \u72b6\u6001\u91cf\u3000\n\n\n\u8003\u8651\u8fd9\u9053\u9898\u4e2d\u7684\u53d8\u91cf\uff1aa\u4e32\u957f\u5ea6\uff0c b\u4e32\u957f\u5ea6\uff0ck\u6bb5\u3002\n\n\u6240\u4ee5\u6211\u4eec\u521d\u6b65\u53ef\u4ee5\u8bbe\u4e00\u4e2a\u4e09\u7ef4\u7684\u72b6\u6001\u91cf$f[i][j][k]$;\n\n\u8868\u793a$a[1 \\sim i]$\u5230$b[1 \\sim j]$\u7528$k$\u6bb5\u5339\u914d\u3002\n\n\u7136\u540e\u8fdb\u4e00\u6b65\u8003\u8651\uff0c \u53d1\u73b0\u8fd9\u4e2a\u72b6\u6001\u91cf\u7684\u8f6c\u79fb\u65b9\u7a0b\u4e0d\u597d\u63a8\u3002\n\n\u5176\u539f\u56e0\u662f\u5f53\u4f7f\u7528$a[j]$\u4e0e\u4e0d\u4f7f\u7528$a[j]$\u65f6\u72b6\u6001\u6df7\u6dc6\uff0c\u6240\u4ee5\u8fd9\u4e2a\u72b6\u6001\u91cf\u4e00\u5b9a\u6709\u95ee\u9898\u3002\n\n\u6240\u4ee5\u6211\u4eec\u52a0\u4e00\u7ef4\uff0c\u8fdb\u884c\u533a\u522b\u3002\n\n\u6700\u7ec8\u72b6\u6001\u91cf\uff1a$f[i][j][k][0 / 1]$, $0$\u5373\u662f\u4e0d\u4f7f\u7528\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002\n\n2. \u65b9\u7a0b\n\n$$f[i][j][k][0] = f[i - 1][j][k][1] + f[i - 1][j][k][0]$$\n\n\u82e5$a[i] = b[j]$, \u5219\n\n$$f[i][j][k][1] = f[i - 1][j - 1][k - 1][1] + f[i - 1][j - 1][k][1] + f[i][j - 1][k - 1][0]$$\n\n\u903b\u8f91\u5728\u4e8e\uff1a\n\n\u5f53\u524d\u5b57\u7b26\u4e0d\u4f7f\u7528\u65f6\uff0c\u53ef\u4ee5\u4ece\u4e24\u4e2a\u65b9\u5411\u8f6c\u79fb\u800c\u6765\uff1a\n\n\u4e0a\u4e2a\u5b57\u7b26\u7684\u4f7f\u7528\u3001\u4e0d\u4f7f\u7528\u7686\u53ef\u3002\n\n\u5f53\u524d\u5b57\u7b26\u4f7f\u7528\u65f6\uff0c\u53ef\u4ee5\u4ece\u4e09\u4e2a\u65b9\u5411\u8f6c\u79fb\u800c\u6765\uff1a\n\n[\u6ce8]\u663e\u7136\u5f53\u8fd9\u4e24\u4e2a\u5b57\u7b26\u76f8\u7b49\u65f6\uff0cb\u4e32\u7684\u5f53\u524d\u5b57\u7b26\u662f\u4e0d\u80fd\u7528\u7684\u3002\n\n(1)\u4e0a\u9636\u6bb5\u6709k\u6bb5\uff0c\u800c\u5f53\u524d\u8981\u63a5\u4e0a\uff0c\u5219\u4e0a\u4e2a\u5b57\u7b26\u5fc5\u7136\u4f7f\u7528\u3002\n\n(2)\u4e0a\u9636\u6bb5\u6709k - 1\u6bb5\uff0c\u5219\u5f53\u524d\u4f7f\u4e0d\u4f7f\u7528\u7686\u53ef\u3002\n\n3. \u8fb9\u754c\n\n## \u6613\u77e5,$f[i][1][1][0] = \\sum_{j = 1}^{i - 1}(a[j] == b[1])$\n\n## \u5212\u91cd\u70b9\uff01\uff01\n\n\u8fd9\u53ef\u80fd\u662f\u535a\u4e3b\u5728\u505a\u8fd9\u9053\u9898\u7684\u65f6\u5019\u6700\u61f5\u7684\u4e00\u70b9\u4e86\uff0c\u4e0d\u8fc7~~\u624b\u73a9~~\u6309\u903b\u8f91\u63a8\u4e00\u4e0b\u4e5f\u662f\u8fc7\u5f97\u6765\u7684\u3002\u770b\u61c2\u4e86\u8fd9\u4e00\u70b9\uff0c\u5c31\u641e\u61c2\u4e86\u7a0b\u5e8f\u3002\u6240\u4ee5\u4ec5\u4f5c\u63d0\u793a\uff1a\u6ce8\u610f\u72b6\u6001\u91cf\u7684\u5b9a\u4e49\u3002\n\n---\n\n\u63a5\u4e0b\u6765\u662f\u6700\u6fc0\u52a8\u4eba\u5fc3\u7684\u65f6\u523b\uff1a\n\n```cpp\n\n/************************************************\n*Author        :  Jack\n*Created Time  :  2019.10.25.21:17\n*Mail          :  724033213@qq.com\n*Problem       :  P2679\n*Extra         :  [NOIP2015] D2T2 \n************************************************/\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\n//dp[i][j][k][1] a[i] & b[j] for k \nconst int maxn = 1e3 + 2;\nconst int maxk = 2e2 + 2;\nconst int MOD = 1e9 + 7;\nint f[2][maxk][maxk][2];\nint n, m, NOW, PRE, s, t;\nchar a[maxn], b[maxn];\nsigned main() {\n//    freopen(\"P2679.in\",\"r\",stdin);\n//    freopen(\"P2679.out\",\"w\",stdout);\n    scanf(\"%lld%lld%lld\", &n, &m, &t);\n\tscanf(\"%s%s\", a + 1, b + 1);\n\tNOW = 0, PRE = 1;\n\tfor(int i = 1;i <= n;i ++){\n\t\tswap(NOW, PRE);\n\t\tf[NOW][1][1][0] = s;\n\t\tif(a[i] == b[1]){\n\t\t\tf[NOW][1][1][1] = 1;\n\t\t\ts ++;\n\t\t}\n\t\tfor(int j = 2;j <= m; j++){\n\t\t\tfor(int k = 1;k <= t;k ++){\n\t\t\t\tif(a[i] == b[j]){\n\t\t\t\t\tf[NOW][j][k][1] = f[PRE][j - 1][k - 1][1] + f[PRE][j - 1][k][1] + f[PRE][j - 1][k - 1][0];\n\t\t\t\t\tf[NOW][j][k][1] %= MOD;\n\t\t\t\t}\n\t\t\t\tf[NOW][j][k][0] = f[PRE][j][k][0] + f[PRE][j][k][1];\n\t\t\t\tf[NOW][j][k][0] %= MOD;\n\t\t\t}\n\t\t}\n\t\tfor(int j = 1;j <= m;j ++){\n\t\t\tfor(int k = 1;k <= t;k ++){\n\t\t\t\tf[PRE][j][k][0] = f[PRE][j][k][1] = 0;\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%lld\", (f[NOW][m][t][1] + f[NOW][m][t][0]) % MOD);\n    return 0;\n}\n```\n\n\u6700\u540e\uff0c\u9e23\u8c22@CRyan\u5927\u4f6c\u7684\u9898\u89e3\uff0c\u7ed9\u4e86\u6211\u5f88\u5927\u7684\u542f\u53d1\u3002",
        "postTime": 1572080264,
        "uid": 39993,
        "name": "\u5143\u5915",
        "ccfLevel": 0,
        "title": "\u5b50\u4e32"
    },
    {
        "content": "\u9898\u610f:https://www.luogu.org/problem/P2679\n\n\u8fd9\u79cd\u9898\u663e\u7136\u8981\u8fd9\u4e48\u8bbe\u72b6\u6001\uff1a\u5148\u8bbef[i][j]\u8868\u793aA\u5230\u4e86\u7b2ci\u4f4d,B\u5339\u914d\u4e86\u5230\u4e86j\u4f4d\u7684\u65b9\u6848\u6570,\u4e4b\u540e\u5411\u4e0a\u9762\u52a0\u7ef4\u5ea6\u5230\u53ef\u4ee5\u89e3\u51b3\n\n\u7531\u4e8e\u89c4\u5b9a\u53ea\u80fd\u53d6K\u4e2a,\u56e0\u6b64\u518d\u52a0\u4e00\u7ef4,f[i][j][k]\u8868\u793aA\u5230\u4e86\u7b2ci\u4f4d,B\u5339\u914d\u4e86\u5230\u4e86j\u4f4d,A\u5206\u4e86k\u6bb5\u7684\u65b9\u6848\u6570\n\n\u8fd9\u65f6\u53ef\u4ee5\u6c42\u89e3\u4e86,\u4f46\u662f\u8f6c\u79fb\u65f6\u4e0d\u77e5\u9053\u524d\u540e\u662f\u5426\u80fd\u591f\u62fc\u63a5,\u56e0\u6b64\u518d\u52a0\u4e00\u7ef4f[i][j][k][0/1]\u8868\u793a\u8868\u793aA\u5230\u4e86\u7b2ci\u4f4d,B\u5339\u914d\u4e86\u5230\u4e86j\u4f4d,A\u5206\u4e86k\u6bb5,\u7b2ci\u4e2a\u662f\u5426\u9009\u62e9(0->\u5426,1->\u662f)\u7684\u65b9\u6848\u6570\n\n\u8fb9\u754c:f[0][0][0][0]=1\n\n\u8f6c\u79fb\u65b9\u7a0b:\n\nf[i][j][k][0]=f[i-1][j][k][0]+f[i-1][j][k][1]\n\n\u7531\u4e8ei\u4e0d\u9009,\u90a3\u4e48\u4e0eB\u7684\u5339\u914d\u957f\u5ea6j\u548c\u9009\u7684\u6bb5\u6570k\u90fd\u4e0d\u4f1a\u589e\u5927,\u76f4\u63a5\u4ecei-1\u7684\u4e24\u4e2a\u72b6\u6001\u8f6c\u79fb\u5373\u53ef\n\nA[i]==B[j] f[i][j][k][1]=f[i-1][j-1][k][1]+f[i-1][j-1][k-1][0]+f[i-1][j-1][k-1][1]\n\n\u65e2\u7136\u80fd\u5339\u914d,\u90a3\u4e48\u8981\u4e48\u62fc\u63a5\u4e0a\u4e00\u6bb5\u7ed3\u5c3e(f[i-1][j-1][k][1]),\u8981\u4e48\u65b0\u5f00\u4e00\u6bb5(f[i-1][j-1][k-1][0]+f[i-1][j-1][k-1][1])\n\nA[i]!=B[j] f[i][j][k][1]=0\n\nA[i]!=B[i]\u81ea\u7136\u4e0d\u5408\u6cd5\n\ncode:\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mod=1000000007;\nconst int maxn=1010;\nconst int maxm=210;\nint n,m,K;\nint f[2][maxm][maxm][2]; \nchar s1[maxn],s2[maxm];\nint main()\n{\n\t//freopen(\"test.in\",\"r\",stdin);\n\t//freopen(\"test.out\",\"w\",stdout);\n\tscanf(\"%d%d%d\",&n,&m,&K);\n\tscanf(\"%s%s\",s1+1,s2+1);\n\tf[0][0][0][0]=1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint now=i&1;\n\t\tfor(int j=0;j<=m;j++)\n\t\t\tfor(int k=0;k<=min(K,j);k++)\n\t\t\t{\t\t\n\t\t\t\tf[now][j][k][0]=(f[now^1][j][k][0]+f[now^1][j][k][1])%mod;\n\t\t\t\tif(j<=0||s1[i]!=s2[j]){f[now][j][k][1]=0;continue;}\n\t\t\t\tf[now][j][k][1]=f[now^1][j-1][k][1];\n\t\t\t\tif(k>0)f[now][j][k][1]=((f[now][j][k][1]+f[now^1][j-1][k-1][0])%mod+f[now^1][j-1][k-1][1])%mod;\n\t\t\t}\n\t}\n\tprintf(\"%d\",(f[n&1][m][K][0]+f[n&1][m][K][1])%mod);\n\treturn 0;\n} \n```\n",
        "postTime": 1568601630,
        "uid": 145441,
        "name": "nofind",
        "ccfLevel": 6,
        "title": "P2679 \u5b50\u4e32(DP)"
    },
    {
        "content": "### \u601d\u8def\n\n\u540e\u7f00\u81ea\u52a8\u673a\u4e4b\u7c7b\u7684\u7384\u5b66\u505a\u6cd5\uff0c\u5373\u4f7f\u53ef\u4ee5\u8fc7\uff0c\u4e5f\u4e0d\u9002\u5408\u849f\u84bb\u5728$NOIP$\u8d5b\u573a\u4e0a\u62ff\u51fa\u6765\u3002\u8fd9\u4e2a\u6570\u636e\u8303\u56f4\u4e5f\u4e0d\u9002\u5408 **\uff08\u4e0d\u8bb0\u5fc6\u5316\u7684\uff09** \u641c\u7d22\u3002\u5f88\u50cf$DP$\uff0c\u4f46\u662f\u8981\u600e\u6837$DP$\u5462\uff1f\n\n\u6309\u7167$DP$\u7684\u5e38\u89c4\u601d\u8def\uff0c\u5148\u7ed9$m$\uff0c$n$\uff0c$k$\u5206\u522b\u8bbe\u7f6e\u4e00\u4e2a\u7ef4\u5ea6\uff0c\u8bb0\u4e3a\n\n\u200b\t$f[i][j][p]$\n\n\u8868\u793a\u8f6c\u79fb\u5230$A[i]$\u548c$B[j]$\uff0c\u4f7f\u7528\u4e86$p$\u4e2a\u5b50\u4e32\u3002\u4e00\u79cd\u601d\u8def\u662f\u679a\u4e3e$A$\u6570\u7ec4\u7684$[1,i]$\u6bb5\u518d\u5339\u914d\u3002\u4f46\u662f\u8fd9\u4e0d\u592a\u597d\u7406\u89e3\uff0c\u53ef\u4ee5\u4eba\u4e3a\u5730\u518d\u589e\u52a0\u4e00\u7ef4\u5e03\u5c14\u53d8\u91cf\uff0c\u76f8\u5f53\u4e8e**\u628a\u4e00\u4e2a\u72b6\u6001\u5206\u4e3a\u4e24\u90e8\u5206**\uff0c\u5176\u610f\u4e49\u662f$A[i]$\u662f\u5426\u5bf9\u5e94$B[i]$\u3002\u5219\u6709\n\n\u200b\t$f[i][j][p][q],q\\in \\{0,1\\} $\n\n### \u72b6\u6001\u8f6c\u79fb\n\n\u663e\u7136\uff0c\u51b3\u5b9a\u8f6c\u79fb\u65b9\u7a0b\u7684\u6761\u4ef6\u662f$A[i]==B[j]$\u3002\n\n\u5982\u679c$q=0$\uff0c\u65e0\u8bba$A[i]$\u4e0e$B[j]$\u76f8\u7b49\u4e0e\u5426\uff0c\u90fd\u76f4\u63a5\u7167\u642c$A[i-1]$\u3001$B[j]$\u7684\u8f6c\u79fb\u7ed3\u679c\u5373\u53ef\n\n\u200b\t$f[i][j][p][0]=f[i-1][j][p][0]+f[i-1][j][p][1]$\n\n\u5982\u679c$q=1$\uff0c\u5219\u5206\u7c7b\u8ba8\u8bba\u3002\n\n- \u5f53$A[i]==B[j]$\u65f6\uff0c\u7b54\u6848\u662f$A[i-1]$\u3001$B[j-1]$\u7684\u65b9\u6848\u6570\u3002\u8fd9\u4e5f\u5206\u4e3a\u4e24\u79cd\uff0c\u4e00\u79cd\u662f\u628a$A[i]$\uff0c$B[j]$\u4f5c\u4e3a\u5355\u72ec\u7684\u5b50\u4e32\uff0c\u6b64\u65f6$p$\u8981\u51cf\u4e00\uff1b\u4e00\u79cd\u662f\u628a\u5b50\u4e32$A[i]$\uff0c$B[j]$\u4e0e$A[i-1]$\uff0c$B[j-1]$\u76f8\u8fde\uff0c\u6b64\u65f6$p$\u4fdd\u6301\u4e0d\u53d8\uff0c$q$\u53ea\u80fd\u662f$1$\u3002\n- \u5f53$A[i]!=B[j]$\u65f6\uff0c\u65e0\u6cd5\u5339\u914d\uff0c\u7b54\u6848\u4e3a$0$\u3002\n\n\u7efc\u4e0a\u6240\u8ff0\uff0c\u5f97\n\n$f[i][j][p][0]=f[i-1][j][p][0]+f[i-1][j][p][1]$\n\n\u200b\t\t$f[i][j][p][1]=\\begin{cases}{A[i]==B[j]\\quad f[i-1][j-1][p-1][1]+f[i-1][j-1][p-1][0]+f[i-1][j-1][p][1]}\\\\{A[i]!=B[j]\\quad 0}\\end{cases}$\n\n\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u521d\u503c\u600e\u4e48\u8bbe\uff1f\n\n\u53ef\u4ee5\u5728\u7b2c\u4e00\u5c42\u5faa\u73af\u5185\u52a0\u5224\u65ad\u3002\u5982\u679c$A[i]$\u4e0e$B[1]$\u76f8\u540c\uff0c\u5219\n\n\u200b\t$f[i][1][1][1]=1,f[i][1][1][0]=count,count++$\n\n### \u4f18\u5316\n\n\u7a7a\u95f4\u5927\u7ea6\u662f\n\n\u200b\t$1000*200*200*2=8\\times 10^7$\n\n\u8fd9\u8c01\u9876\u5f97\u4f4f\u554a\u3002\u89c2\u5bdf\u53d1\u73b0\uff0c\u6bcf\u6b21\u72b6\u6001\u8f6c\u79fb\u53ea\u548c\u4e0a\u4e00\u6b21\u7ed3\u679c\u6709\u5173\u3002\u53ef\u4ee5\u4f7f\u7528\u6eda\u52a8\u6570\u7ec4\u4f18\u5316\u3002\n\n```cpp\n#include<iostream>\n#include<cstring>\nusing namespace std;\nint f[2][205][205][2],n,m,k,cnt,i=1;\nstring a,b;\nconst int mod=1000000007;\nint main()\n{\n    cin>>n>>m>>k;\n    cin>>a>>b;\n    a=' '+a,b=' '+b;\n    for(int temp=1;temp<=n;temp++,i^=1)\n    {\n        f[i][1][1][0]=cnt;\n        if(a[temp]==b[1]) f[i][1][1][1]=1,cnt++;\n        else f[i][1][1][1]=0; \n        for(int j=2;j<=m;j++)\n            for(int p=1;p<=k;p++)\n            {\n                f[i][j][p][0]=(f[i^1][j][p][1]+f[i^1][j][p][0])%mod;\n                f[i][j][p][1]=(a[temp]==b[j])*((f[i^1][j-1][p-1][1]+f[i^1][j-1][p-1][0])%mod+f[i^1][j-1][p][1])%mod;\n            }\n    }\n    cout<<(f[n&1][m][k][1]+f[n&1][m][k][0])%mod;\n    return 0;\n}\n```\n",
        "postTime": 1558364296,
        "uid": 34372,
        "name": "_wkjzyc",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\u5148\u63a8\u4e00\u4e0b\u672c\u849f\u84bb\u7684$blog$:https://blog.csdn.net/dhdhdhx\n[\u6211\u7684\u535a\u5ba2\u5730\u5740](blog.csdn.net./dhdhdhx)\n\n~~\u516c\u7136\u5728\u6d1b\u8c37\u63a8csdn\u535a\u5ba2~~\n\n\n\u8fd9\u9898\u4e00\u6253\u773c\n\n$dp[i][j][k]$\u8868\u793a\u65b9\u6848\u6570\u554a!\n\n\u4f46\u662f\u4ed4\u7ec6\u60f3\u60f3\u4e0d\u5bf9 \u8fd9\u4e2a$dp$\u5f0f\u4f53\u73b0\u4e0d\u51fa\u5f53\u524d\u5b57\u7b26\u548c\u524d\u4e00\u4e2a\u4e32\u7684\u5173\u7cfb ($dp$\u5f0f:n\u4f60\u5c11\u52a0\u4e00\u7ef4\u8fd8\u602a\u6211\u4e86?)\n\n\u6240\u4ee5\u6211\u4eec\u8981\u518d\u52a0\u4e00\u7ef4$0/1$\u8868\u793a\u5f53\u524d\u5b57\u7b26\u662f\u63a5\u5728\u4e0a\u4e00\u4e2a\u5b50\u4e32$/$\u5f53\u524d\u5b57\u7b26\u662f\u4e00\u4e2a\u65b0\u7684\u5b50\u4e32\u7684\u5f00\u7aef\n\n$0/1$\u5f00\u4e24\u4e2a\u6570\u7ec4\u66f4\u76f4\u89c2\u4e00\u70b9:\n\n\u6211\u4eec\u7528$ans[i][j][k]$\u8868\u793a\u5230$A$\u5b57\u7b26\u4e32\u7b2c$i$\u4e2a\u5b57\u7b26 $B$\u5b57\u7b26\u4e32\u7b2c$j$\u4e2a\u5b57\u7b26 \u5f53\u524d\u5b50\u4e32\u6570\u4e3a$k$\u7684\u7b54\u6848\u6570\n$sum[i][j][k]$\u8868\u793a\u5f53\u524d\u5728$A$\u5b57\u7b26\u4e32\u7b2c$i$\u4e2a\u5b57\u7b26 $B$\u5b57\u7b26\u4e32\u7b2c$j$\u4e2a\u5b57\u7b26 \u5f53\u524d\u5b50\u4e32\u6570\u4e3a$k$\u65f6\u7684\u65b9\u6848\u6570\n\n\u7136\u540e\u5c31\u662f\u5173\u7cfb\u5f0f\u4e86 \u600e\u4e48\u641e\u5462\n\u9996\u5148\u8003\u8651\u5f53\u524d\u7684$ans$ \u8981\u4e48\u7528$A[i]$\u8981\u4e48\u4e0d\u7528\n\u6240\u4ee5$ans[i][j][l]=ans[i-1][j][l]+sum[i][j][l]$\n\n\u663e\u800c\u6613\u89c1 \u5f53$A[i]\\neq B[i]$\u65f6 $sum$\u7684\u503c\u5c31\u662f$0$\n\n\u7ecf\u8fc7\u601d\u8003\u53ef\u77e5\u5f53 $A[i]=B[i]$\u65f6 \u6b64\u65f6\u8981\u4e48\u63a5\u5728\u4e0a\u4e2a\u5b50\u4e32\u4e0a \u8981\u4e48\u5f00\u4e00\u4e2a\u65b0\u7684\u5b50\u4e32\n\n\u6240\u4ee5$sum[i][j][l]=sum[i-1][j-1][l]+ans[i-1][j-1][l-1]$\n\n\u54c8\u54c8 \u505a\u5b8c\u4e86\uff1f\u60f3\u5f97\u7f8e\n\n$dp[1000][200][200][2]??$\u663e\u7136\u662f\u70b8\u7684 \u6240\u4ee5\u6211\u4eec\u8981\u4f18\u5316\u7a7a\u95f4\n\n\u6ce8\u610f\u5230\u7b2c\u4e00\u7ef4\u8c8c\u4f3c\u6ca1\u4ec0\u4e48\u5375\u7528 \u6240\u4ee5\u76f4\u63a5\u6eda\u6389\n\n\u7a7a\u95f4\u590d\u6742\u5ea6$O(4mk)$\u65f6\u95f4\u590d\u6742\u5ea6$O(nmk)$ \u6ca1\u5565\u5927\u95ee\u9898\n\n\u4e0a\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mod=1e9+7;\nint n,m,k,now,ans[2][202][202],sum[2][202][202];\nchar a[1010],b[202];\nint main(){\n    cin>>n>>m>>k;\n    scanf(\"%s%s\",a+1,b+1);\n    ans[0][0][0]=ans[1][0][0]=now=1;\n    for(int i=1;i<=n;i++){\n        for(int j=1;j<=m;j++){\n            for(int l=1;l<=k;l++){\n                if(a[i]==b[j])sum[now][j][l]=(sum[now^1][j-1][l]+ans[now^1][j-1][l-1])%mod;\n                else sum[now][j][l]=0;\n                ans[now][j][l]=(ans[now^1][j][l]+sum[now][j][l])%mod;\n            }\n        }\n        now^=1;\n    }\n    printf(\"%d\\n\",ans[now^1][m][k]);\n}\n```\n\n",
        "postTime": 1570878092,
        "uid": 95366,
        "name": "Dawn_cx",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    },
    {
        "content": "\u8fd9\u91cc\u662f\u9898\u76ee\uff1a[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.org/problemnew/show/P2679)\n\n\u8fd9\u9053\u9898\u7684\u6570\u636e\u90e8\u5206\u5206\uff0c\u5f53k\u662f\u4e00\u7684\u65f6\u5019\uff0c\u76f4\u63a5\u5224\u65ad\u5c31\u597d\u4e86\uff0ck\u662f\u4e8c\u7684\u65f6\u5019\uff0c\u679a\u4e3e\u54ea\u91cc\u5206\u5f00\uff0c\u5206\u522b\u5224\u65ad\uff0ck\u662fm\u7684\u65f6\u5019\uff0c\u901a\u8fc7\u641c\u7d22\u5f97\u5230\u8fd9m\u4e2a\u70b9\u7684\u4f4d\u7f6e\uff0c\u5728\u770b\u548c\u5f85\u5339\u914d\u6570\u7ec4\u662f\u5426\u76f8\u540c\u5c31\u597d\u4e86\n```cpp\n#include<iostream>\n#include<cstring>\n#include<string>\n#include<cstdio>\nusing namespace std;\nconst int maxN=1010;\nconst int maxM=210;\nconst int maxK=210;\nconst long long mod=1000000007;\nint n,m,k;\nstring s1,s2;\nint f[maxN][maxM][maxK],g[maxN][maxM][maxK];\n\nvoid prepare()\n{\n    if(s1[0]==s2[0]){\n        f[1][1][1]=1;\n        g[1][1][1]=1;\n    }\n    for(int i=1;i<=n;++i)\n        f[i][0][0]=1;\n    for(int i=2;i<=n;++i){\n        for(int j=1;j<=i;++j){\n            for(int l=1;l<=min(k,j);++l){\n                if(s1[i-1]==s2[j-1]){\n                    g[i][j][l]=f[i-1][j-1][l-1]+g[i-1][j-1][l];\n                    f[i][j][l]=+f[i-1][j][l]+f[i-1][j-1][l-1]+g[i-1][j-1][l];\n                }\n                else{\n                    g[i][j][l]=0;\n                    f[i][j][l]=f[i-1][j][l];\n                }\n                //cout<<i<<\" \"<<j<<\" \"<<l<<\" \"<<f[i][j][l]<<\" \"<<g[i][j][l]<<endl;\n            }\n        }\n    }\n}\n\nint main()\n{\n    cin>>n>>m>>k;\n    cin>>s1>>s2;\n    prepare();\n    cout<<f[n][m][k]<<endl;\n    return 0;\n}\n```\n\n\u4e4b\u540e\u6211\u4eec\u60f3\u5230\u53ef\u4ee5\u7528\u52a8\u6001\u89c4\u5212\uff0cf[i][j][k]\u8868\u793a\u4eceS1\u4e2d\u524di\u4e2a\u9009\u53d6k\u4e2a\u5b57\u4e32\u7b49\u4e8es2\u4e2d\u7684\u524dj\u4e2a\uff0c\u5f53s1[i]!=s2[j]\u7684\u65f6\u5019f[i][j][k]=f[i-1][j][k],\u5f53\u76f8\u7b49\u7684\u65f6\u5019\uff0c\u53ef\u9009\u53ef\u4e0d\u9009\uff0c\u9009\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u81ea\u5df1\u4e00\u4e2a\u5355\u72ec\u4e00\u4e2a\u5b57\u4e32\uff0c\u6216\u8005\u4e0e\u524d\u9762\u7684\u4e00\u4e2a\u4f4d\u7f6e\u5f62\u6210\u4e00\u4e2a\u5b50\u4e32\uff0c\u4e8e\u662f\u53c8f[i][j][k]=f[i-1][j][k]+f[i-1][j-1][k-1]+g[i-1][j-1][k],\u4e4b\u540e\u8003\u8651g\u6570\u7ec4\uff0c\u5f53s1[i]!=s2[j]\u65f6\uff0cg[i][j][k]\u7684\u503c\u5c31\u662f0\uff0c\u76f8\u7b49\u7684\u65f6\u5019g[i][j][k]=f[i-1][j-1][k-1]+g[i-1][j-1][k]\n\n\u9644\u4e0a\u8d85\u7a7a\u95f4\u7684\u4ee3\u7801\uff1a\n```cpp\n#include<iostream>\n#include<cstring>\n#include<string>\n#include<cstdio>\nusing namespace std;\nconst int maxN=1010;\nconst int maxM=210;\nconst int maxK=210;\nconst long long mod=1000000007;\nint n,m,k;\nstring s1,s2;\nint f[maxN][maxM][maxK],g[maxN][maxM][maxK];\n\nvoid prepare()\n{\n    if(s1[0]==s2[0]){\n        f[1][1][1]=1;\n        g[1][1][1]=1;\n    }\n    for(int i=1;i<=n;++i)\n        f[i][0][0]=1;\n    for(int i=2;i<=n;++i){\n        for(int j=1;j<=i;++j){\n            for(int l=1;l<=min(k,j);++l){\n                if(s1[i-1]==s2[j-1]){\n                    g[i][j][l]=(f[i-1][j-1][l-1]+g[i-1][j-1][l])%mod;\n                    f[i][j][l]=((f[i-1][j][l]+f[i-1][j-1][l-1])%mod+g[i-1][j-1][l])%mod;\n                }\n                else{\n                    g[i][j][l]=0;\n                    f[i][j][l]=f[i-1][j][l];\n                }\n                //cout<<i<<\" \"<<j<<\" \"<<l<<\" \"<<f[i][j][l]<<\" \"<<g[i][j][l]<<endl;\n            }\n        }\n    }\n}\n\nint main()\n{\n    cin>>n>>m>>k;\n    cin>>s1>>s2;\n    prepare();\n    cout<<f[n][m][k]%mod<<endl;\n    return 0;\n}\n```\n\n\u4e4b\u540e\uff0c\u6211\u4eec\u53d1\u73b0f,g\u4e24\u4e2a\u6570\u7ec4\u90fd\u662f\u7528\u5230\u4e86i-1\u8fd9\u4e00\u7c7b\u7684f\u548cg\u6570\u7ec4\uff0c\u6211\u4eec\u4e0d\u59a8\u4f7f\u7528\u6eda\u52a8\u6570\u7ec4\uff1a\n```cpp\n#include<iostream>\n#include<cstring>\n#include<string>\n#include<cstdio>\nusing namespace std;\nconst int maxN=1010;\nconst int maxM=210;\nconst int maxK=210;\nconst long long mod=1000000007;\nint n,m,k;\nint ne,now;\nstring s1,s2;\nint f[2][maxM][maxK],g[2][maxM][maxK];\n\nvoid prepare()\n{\n\tif(s1[0]==s2[0]){\n\t\tf[now][1][1]=1;\n\t\tg[now][1][1]=1;\n\t}\n\tf[now][0][0]=1;\n\tfor(int i=2;i<=n;++i){\n\t\tne=1-now;\n\t\tf[ne][0][0]=1;\n\t\tfor(int j=1;j<=min(i,m);++j){\n\t\t\tfor(int l=1;l<=min(k,j);++l){\n\t\t\t\tif(s1[i-1]==s2[j-1]){\n\t\t\t\t\tg[ne][j][l]=(f[now][j-1][l-1]+g[now][j-1][l])%mod;\n\t\t\t\t\tf[ne][j][l]=((f[now][j][l]+f[now][j-1][l-1])%mod+g[now][j-1][l])%mod;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tg[ne][j][l]=0;\n\t\t\t\t\tf[ne][j][l]=f[now][j][l];\n\t\t\t\t}\n\t\t\t\t//cout<<i<<\" \"<<j<<\" \"<<l<<\" \"<<f[ne][j][l]<<\" \"<<g[ne][j][l]<<endl;\n\t\t\t}\n\t\t}\n\t\tnow=ne;\n\t\t//cout<<now<<endl;\n\t}\n}\n\nint main()\n{\n\t//freopen(\"substring.in\",\"r\",stdin);\n\t//freopen(\"substring.out\",\"w\",stdout);\n\tcin>>n>>m>>k;\n\tcin>>s1>>s2;\n\tprepare();\n\tcout<<f[now][m][k]%mod<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1540561136,
        "uid": 112221,
        "name": "Nirvana_Xero",
        "ccfLevel": 0,
        "title": "P2679 \u5b50\u4e32"
    },
    {
        "content": "\u4e00\u9053DP\u3002\n\n\u7528\u4e86\u4e24\u4e2a\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b(f[i][j][l][0]\u8868\u793a\u5230A\u4e32\u7b2ci\u4e2a\u5b57\u7b26B\u4e32\u7b2cj\u4e2a\u5b57\u7b26\u4e3a\u6b62\u7528l\u4e2a\u5b50\u4e32A\u4e32\u4e2d\u524di\u4e2a\u5143\u7d20\u7ec4\u6210B\u4e32\u524dj\u4e2a\u5143\u7d20\u7684\u65b9\u6848\u603b\u6570,f[i][j][l][1]\u8868\u793a\u4ee5A\u4e32\u7b2ci\u4e2a\u5b57\u7b26\u7ed3\u5c3e\u7684\u65b9\u6848\u603b\u6570)\u3002\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u89c1\u4ee3\u7801\uff0c\u603b\u4f53\u601d\u60f3\u5c31\u662f\u5f53a[i-1]==b[j-1]\u65f6\uff0c\u672c\u6b21\u8f6c\u79fb\u53ef\u4ee5\u8f6c\u79fb\u5230f[i-1][j-1][l](\u53ef\u4ee5\u628a\u672c\u6b21\u548c\u4e0a\u6b21\u5408\u6210\u4e00\u4e2a\u5b50\u4e32\u4f7f\u7528)\u3002\u6700\u540e\u5c31\u662f\u663e\u7136i\u90fd\u662fi-1\u8f6c\u79fb\u6765\u7684\uff0c\u56e0\u6b64\u53ef\u4ee5\u6eda\u52a8\u6570\u7ec4\u4f18\u5316\u3002\n\n\nQWQ\u8eab\u4e3a\u849f\u84bb\u7684\u6211\u5199\u7684\u4ee3\u7801\u5e38\u6570\u597d\u50cf\u6709\u70b9\u5927\u3002\n\n```cpp\n\n#include <cstdio>\n\nusing namespace std;\n\nchar a[1001],b[201];\n\nlong long f[201][201][2]={0};\n\nint main()\n{\n    int n,m,k;\n    scanf(\"%d%d%d\",&n,&m,&k);\n    scanf(\"%s%s\",a+1,b+1);\n    for(int i=1;i<=n;i++)\n    {\n        for(int j=m;j>=1;j--)\n        {\n            for(int l=1;l<=k;l++)\n            {\n                if(a[i]==b[j])\n                {\n                    if(j==1)\n                    {\n                        if(l==1)f[j][l][0]++,f[j][l][1]=1;\n                        }\n                    else\n                    {\n                        f[j][l][0]+=f[j-1][l-1][0];\n                        f[j][l][1]=f[j-1][l-1][0];\n                        if(i>1&&a[i-1]==b[j-1])\n                        {\n                            f[j][l][0]+=f[j-1][l][1];\n                            f[j][l][1]+=f[j-1][l][1];\n                            }\n                        }\n                    }\n                    else f[j][l][1]=0;\n                    f[j][l][0]%=1000000007;\n                    f[j][l][1]%=1000000007;\n                }\n            }\n        }\n    printf(\"%lld\",f[m][k][0]);\n    return 0;\n    }\n```",
        "postTime": 1467240190,
        "uid": 14815,
        "name": "crowworks695",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2679 \u3010\u5b50\u4e32\u3011"
    }
]
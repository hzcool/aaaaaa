[
    {
        "content": "Update on 2020.5.31\uff1a\u6781\u5927\u7b80\u5316\u4e86\u4ee3\u7801\uff0c\u8dd1\u7684\u98de\u5feb\n\n\u5c0f\u849f\u84bb\u7684\u7b2c\u4e00\u7bc7\u9898\u89e3\uff0c\u671b\u5927\u5bb6\u652f\u6301\uff0c\u5982\u6709\u6392\u7248\u683c\u5f0f\u95ee\u9898\u8fd8\u8bf7\u89c1\u8c05\u3002\n\n\u6b64\u9898\u6bd4\u8f83\u590d\u6742\uff0c\u505a\u7684\u8bdd\u9700\u8981\u5148\u719f\u6089\u6570\u4f4ddp\u7684\u57fa\u672c\u5957\u8def\uff0c\u6211\u4eec\u6162\u6162\u5206\u6790\u3002\n\n\u770b\u5230 \u201c\u5404\u4f4d\u6570\u5b57\u4e4b\u79ef\u201d \u5e94\u8be5\u53ef\u4ee5\u60f3\u5230\u8fd9\u662f\u6570\u4f4ddp\u9898\uff0c\u90a3\u4e48\u6700\u6734\u7d20\u7684\u60f3\u6cd5\u5c31\u662f $f(i,j)$ \u8868\u793a\u524d $i$ \u4f4d\u6570\u5404\u4f4d\u6570\u5b57\u4e4b\u79ef\u4e3a $j$ \u65f6\u7684\u7b54\u6848\uff0c$j$ \u6700\u5927$10^{18}$\uff0c\u65e0\u6cd5\u901a\u8fc7\u3002\n\n\u8003\u8651\u5230 K \u4e3a 1-9 \u8fd9\u4e9b\u6570\u5b57\u7684\u4e58\u79ef\uff08\u6211\u4eec\u5148\u5ffd\u75650\uff09\uff0cK\u7684\u8d28\u56e0\u5b50\u5c31\u53ea\u6709 2,3,5,7 \u56db\u4e2a\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u7528\u56db\u4e2a\u4e0b\u6807 a , b , c , d \u6765\u8868\u793a $j$ \uff0c\u5373 $j=2^a * 3^b * 5^c * 7^d$ ,\u4f46\u662f\u628a\u56db\u4e2a\u53c2\u6570\u90fd\u5199\u5230dp\u6570\u7ec4\u91cc\u7684\u8bdd\u72b6\u6001\u6570\u8fd8\u662f\u6709\u70b9\u5927\uff0c\u8fbe\u5230\u4e86 1e8 \u7684\u7ea7\u522b\u3002\n\n\u4e3a\u4e86\u51cf\u5c11\u590d\u6742\u5ea6\u6211\u4eec\u5148\u9884\u5904\u7406\u51fa $10^{18}$ \u6240\u6709\u4ee5\u5185\u6240\u6709\u53ef\u80fd\u7684 $j$ \uff08$j=2^a * 3^b * 5^c * 7^d$\uff09 ,\u5b83\u53ef\u4ee5\u5f88\u66b4\u529b\uff08~~\u53cd\u6b63\u6570\u5f88\u5c11~~\uff09\uff0c\u5982\u4e0b\uff1a\n```cpp\n\tint lim2=59,lim3=37,lim5=25,lim7=21;\n\tll fac2[60],fac3[60],fac5[60],fac7[60];\n\tfac2[0]=fac3[0]=fac5[0]=fac7[0]=1;\n\tfac[0]=1;\n\tfor(int i=1;i<=lim2;i++)fac2[i]=fac2[i-1]*2;\n\tfor(int i=1;i<=lim3;i++)fac3[i]=fac3[i-1]*3;\n\tfor(int i=1;i<=lim5;i++)fac5[i]=fac5[i-1]*5;\n\tfor(int i=1;i<=lim7;i++)fac7[i]=fac7[i-1]*7;\n\tfor(int i=1;i<=18;i++)fac[i]=fac[i-1]*10;\n\tmaxk=fac[18];\n\tfor(int i=1;i<=18;i++)fac[i]%=mod;\n\tfor(int i=0;i<=lim2;i++)\n\t\tfor(int j=0;j<=lim3&&fac2[i]*fac3[j]<=maxk;j++)\n\t\t\tfor(int k=0;k<=lim5&&fac2[i]*fac3[j]*fac5[k]<=maxk;k++)\n\t\t\t\tfor(int l=0;l<=lim7&&fac2[i]*fac3[j]*fac5[k]*fac7[l]<=maxk;l++)\n\t\t\t\t\tnum[++kcnt]=fac2[i]*fac3[j]*fac5[k]*fac7[l];\n\tsort(num+1,num+kcnt+1);\n```\n\u4e3a\u4e86\u8f6c\u79fb\u65b9\u4fbf\uff0c\u67d0\u4e2a $j$ \u4e0e1-9\u4e2d\u7684\u67d0\u6570\u8fd0\u7b97\u7684\u7ed3\u679c\u5728\u6570\u8868num\u4e2d\u7684\u4f4d\u7f6e\u6211\u4eec\u4e5f\u9700\u8981\u77e5\u9053\uff0c\u9884\u5904\u7406\u51fa\u6765\uff0c$p_{0-3}$ \u5bf9\u5e94\u77402,3,5,7\u3002\n```cpp\n\tfor(int i=1;i<=kcnt;i++)to[i][1]=i;\n\tfor(int i=0;i<=3;i++)\n\t\tfor(int j=1;j<=kcnt;j++)\n\t\t\tif(num[j]%p[i]==0)to[j][p[i]]=id(num[j]/p[i]);\n\tfor(int i=4;i<=9;i++)\n\t{\n\t\tif(i==p[0]||i==p[1]||i==p[2]||i==p[3])continue;\n\t\tfor(int j=1;j<=kcnt;j++)to[j][i]=getto(j,i);\n\t}\n```\n\u5176\u4e2d $to(i,j)$ \u8868\u793a\u6570\u8868\u4e2d\u7b2c $i$ \u4e2a\u6570\u9664\u4ee5 $j$ \u7684\u7ed3\u679c\u5728\u6570\u8868\u4e2d\u7684\u4f4d\u7f6e\uff08\u6ce8\u610f\u662f\u9664\u4e0d\u662f\u4e58\uff0c\u539f\u56e0\u4e0b\u9762\u8bb2\uff09id\u51fd\u6570\u4f7f\u7528\u7684stl\u7684\u4e8c\u5206\u67e5\u627e\uff0cgetto\u662f\u8d28\u56e0\u6570\u5206\u89e3\u6c42to\u7684\u8fc7\u7a0b\uff0c\u5982$to(i,4)=to(to(i,2),2)$ \u3002\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\nint id(ll x)\n{\n\treturn lower_bound(num+1,num+kcnt+1,x)-num;\n}\nint getto(int x,int k)\n{\n\tfor(int i=0;i<=3;i++)\n\t\twhile(k%p[i]==0)\n\t\t{\n\t\t\tk/=p[i];\n\t\t\tx=to[x][p[i]];\n\t\t}\n\treturn x;\n}\n```\n\u7136\u540e\u6211\u4eec\u7684dp\u72b6\u6001\u5c31\u53ef\u4ee5\u8bbe\u8ba1\u4e3a $f(i,j)$ \u8868\u793a\u524d $i$ \u4f4d\u5f53\u524d\u4e58\u79ef\u4e3a $j$ \u7684\u7b54\u6848\u6570\uff0c\u56e0\u4e3a\u5982\u679c\u6ca1\u6709\u6570\u7684\u5927\u5c0f\u9650\u5236\uff0c\u4e14\u6ca1\u6709\u524d\u5bfc\u96f6\u7684\u5f71\u54cd\uff0c$f(i,j)$\u7684\u503c\u5c31\u53ea\u4e0e\u6700\u7ec8\u6570\u4f4d\u7684\u4e58\u79efK\u6709\u5173\u7cfb\u3002\u6211\u4eec\u628a$f(i,j)$\u7684\u542b\u4e49\u6539\u4e00\u4e0b\uff0c\u8868\u793a\u5230\u4e86\u7b2c $i$ \u4f4d\uff0c\u8fd8\u9700\u8981\u7684\u6570\u4f4d\u4e58\u79ef\u4e3a $j$ \u7684\u7b54\u6848\uff0c\u90a3\u4e48 $f(i,j)$\u7684\u503c\u4e0eK\u4e5f\u6ca1\u6709\u4e86\u5173\u7cfb\uff08\u628aK\u5f53\u521d\u59cb\u503c\u6765\u770b\uff09\u3002\u6211\u4eec\u6c42\u7b54\u6848\u7528\u5230 $f$ \u7684\u65f6\u5019\u5df2\u7ecf\u6709\u5c0f\u4e8e\u4e0a\u754c\u548c\u65e0\u524d\u5bfc\u96f6\u7684\u6761\u4ef6\uff0c\u8fd9\u4e24\u7ef4\u4e0d\u7528\u8003\u8651\u3002\n\n\u6211\u4eec\u518d\u5173\u6ce8\u4e00\u4e0b\u8fd9\u4e2a\u9898\u8981\u6c42\u4ec0\u4e48\uff1a\u6ee1\u8db3\u9898\u610f\u6570\u7684\u548c\u3002\u5982\u679c\u6c42\u4e2a\u6570\u7684\u8bdd\u5c31\u5f88\u7b80\u5355\u4e86\uff0c\u548c\u600e\u4e48\u6c42\u5462\uff1f\u6211\u4eec\u8fd8\u8981\u52a0\u5165\u4e00\u4e2a\u6570\u7ec4g\uff0c$f,g$\u7684\u6700\u7ec8\u542b\u4e49\uff1a$f(i,j)$\u8868\u793a\u5230\u4e86\u7b2c $i$ \u4f4d\uff0c\u8fd8\u9700\u8981\u7684\u6570\u4f4d\u4e58\u79ef\u4e3a $j$ \u65f6\u7684\u65b9\u6848\u6570\uff1a $g(i,j)$\u8868\u793a\u5230\u4e86\u7b2c $i$ \u4f4d\uff0c\u8fd8\u9700\u8981\u7684\u6570\u4f4d\u4e58\u79ef\u4e3a $j$ \u65f6\u53ef\u4ee5\u586b\u7684\u6570\u7684\u548c\uff08\u4e2d\u95f4\u4e24\u7ef4\u6211\u7565\u4e86\uff09\u3002\u8fd9\u4e2a $g$ \u6307\u7684\u6570\u662f\u4ece\u7b2c $i$ \u4f4d\u5f00\u59cb\u8ba1\u7684\uff0c\u6bd4\u5982$i=3$\uff0c\u540e\u4e09\u4f4d\u53ef\u4ee5\u586b123,213,321\u8fd9\u4e09\u4e2a\u6570,\uff0c\u90a3\u4e48$f$\u7684\u503c\u4e3a3\uff0c$g$ \u7684\u503c\u5373\u4e3a$123+213+321$\n\n$f(i,j),g(i,j)$\u5982\u4f55\u8f6c\u79fb\u5462\uff1f$f$ \u7684\u503c\u53ef\u4ee5\u76f4\u63a5\u4ece\u4e0b\u4e00\u4f4d\u7d2f\u52a0\uff0c\u5047\u8bbe\u7b2c $i$ \u4f4d\u6211\u4eec\u586b\u4e86a\uff0c\u540e\u9762\u8fd8\u67093\u4f4d\uff0c$g$ \u8ba1\u7b97\u7684\u548c\u5373\u4e3a\u5f62\u5982aXXX\u8fd9\u6837\u7684\u6570\u7684\u548c\uff0c\u8fd9\u4e2aXXX\u6bcf\u6709\u4e00\u79cd\u65b9\u6848, $g$ \u5c31\u52a0\u4e0a$1000a$\n\u800c\u540e\u9762\u8fd9\u4e9b\u53ef\u80fd\u7684XXX\u7684\u603b\u548c\u6070\u662f\u4e0b\u4e00\u4f4d\u7684 $g$ \u8981\u6240\u8868\u793a\u7684\uff0cXXX\u7684\u65b9\u6848\u6570\u5219\u7531\u4e0b\u4e00\u4f4d\u7684 $f$ \u8868\u793a\uff0c\u90a3\u4e48\u8fd9\u4e2a\u9884\u5148dp\u5c31\u53ef\u4ee5\u5199\u51fa\u4e86\uff08\u8fb9\u754c\u503c\u6309$f,g$\u7684\u5b9a\u4e49\u5f88\u597d\u8003\u8651, $fac(i)$\u4e3a$10^i$\uff1a\n```\nvoid dp(int k,int rest)\n{\n\tif(!k)\n\t{\n\t\tf[k][rest]=(rest==1);\n\t\tg[k][rest]=0;\n\t\treturn;\n\t}\n\tif(f[k][rest]!=-1)return;\n\tll rf=0,rg=0;\n\tint a1,a2;\n\tfor(int i=9;i>=1;i--)\n\t{\n\t\ta1=k-1;\n\t\ta2=(i==0)?rest:to[rest][i];\n\t\tif(!a2)continue;\n\t\tdp(a1,a2);\n\t\trf+=f[a1][a2];\n\t\trg=(rg+i*f[a1][a2]*fac[k-1]+g[a1][a2])%mod;\n\t}\n\tf[k][rest]=rf%mod;\n\tg[k][rest]=rg;\n\treturn;\n}\n```\n\n\u5269\u4f59\u7684\u6570\u4f4d\u4e58\u79ef\u662f\u51cf\u5c11\u7684\uff0c$to$\u5728\u8fd9\u91cc\u5c31\u7528\u4e0a\u4e86\uff08\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48$to$\u5904\u7406\u7684\u662f\u9664\uff09\u3002\n\n\u9700\u8981 $f,g$ \u7684\u503c\u65f6\u8c03\u7528\u8fd9\u4e2adp\uff1a\n```\nif(f[k][rest]==-1)dp(k,rest);\n```\n\n\u90a3\u4e48\u5bf9\u4e8e\u8f93\u5165\u7684A,B,K\uff0c\u5148\u8f6c\u5316\u6210\u524d\u7f00\u76f8\u51cf\uff1a\n```cpp\ncout<<((solve(r)-solve(l-1))%mod+mod)%mod<<endl;\n```\n\u5728\u4e0a\u754c\u7684\u9650\u5236\u4e0bdfs\u6bcf\u4e00\u4f4d\u586b\u4ec0\u4e48\uff0c\u5e76\u4f20\u9012\u5f53\u524d\u524d\u7f00\u503c\uff0c\u5982\u679c\u6ee1\u8db3\u5df2\u7ecf\u5c0f\u4e8e\u4e0a\u754c\u3001\u6ca1\u6709\u524d\u5bfc\u96f6\u5f71\u54cd\u4e86\uff0c\u76f4\u63a5\u8fd4\u56de\u7b54\u6848\uff0c\u8ba1\u7b97\u65b9\u6cd5\u4e0e $g$ \u7684\u63a8\u5bfc\u7c7b\u4f3c\uff0c\u53ef\u4ee5\u628a\u5f53\u524d\u7684\u524d\u7f00\u503cpre\u770b\u505a\u6211\u4eec\u521a\u624d\u8ba8\u8bba $g$ \u65f6\u7684a\u3002dfs\u4ee3\u7801\u5982\u4e0b\uff1a\n```\nll dfs(int k,int low,int zero,int rest,ll pre)\n{\n\tif(!rest)return 0;\n\tif(low&(!zero))\n\t{\n\t\tif(f[k][rest]==-1)dp(k,rest);\n\t\treturn (pre*fac[k]%mod*f[k][rest]+g[k][rest])%mod;\n\t}\n\tif(!k)return pre*(rest==1);\n\tll res=0;\n\tfor(int i=low?9:a[k];i>=(!zero);i--)\n\t\tres+=dfs(k-1,low|(i<a[k]),zero&(i==0),(i==0)?rest:to[rest][i],(pre*10+i)%mod);\n\treturn res;\n}\n```\n\n\u8fd9\u4e2a\u9898\u505a\u5b8c\u4e86\uff1f\u4f3c\u4e4e\u6211\u4eec\u8fd8\u5ffd\u7565\u4e86\u96f6\u3002\u3002\u3002\n\n\u5982\u679c$K=0$ ,\u95ee\u9898\u53ef\u4ee5\u770b\u505a\u6c42\u5728A\u5230B\u4e2d\u6240\u6709\u81f3\u5c11\u6709\u4e00\u4f4d\u4e3a\u96f6\u7684\u6570\u7684\u548c\uff0c\uff08~~\u548c\u4e0a\u9762\u90a3\u4e9b\u6bd4\u8fd9\u8fd8\u4e0d\u7b80\u5355~~\uff09\u4e0e$f,g$\u7684\u5b9a\u4e49\u7c7b\u4f3c\uff0c$f0(i,j,k,l)$\u8868\u793a\u5230\u4e86\u7b2c $i$ \u4f4d \u662f\uff081\uff09\u5426\uff080\uff09\u5c0f\u4e8e\u4e0a\u754c\u503c\uff0c\u662f\uff081\uff09\u5426\uff080\uff09\u6709\u524d\u5bfc\u96f6\uff0c \u524d\u9762\u5df2\u7ecf\u6709 $l$ \u4e2a\u96f6\u65f6\u7684\u586b\u7684\u65b9\u6848\u6570\uff0c$g0$ \u8868\u793a\u586b\u7684\u6570\u7684\u548c\uff0c\u6ce8\u610f\u524d\u5bfc\u96f6\u3002\n```cpp\nvoid dp0(int k,int low,int zero,int cnt0)\n{\n\tif(!k)\n\t{\n\t\tf0[k][low][zero][cnt0]=(cnt0>0);\n\t\tg0[k][low][zero][cnt0]=0;\n\t\treturn;\n\t}\n\tif(f0[k][low][zero][cnt0]!=-1)return;\n\tll rf=0,rg=0;\n\tint b1,b2,b3,b4;\n\tfor(int i=low?9:a[k];i>=0;i--)\n\t{\n\t\tb1=k-1;\n\t\tb2=low|(i<a[k]);\n\t\tb3=zero&(i==0);\n\t\tb4=cnt0+((!zero)&(i==0));\n\t\tdp0(b1,b2,b3,b4);\n\t\trf=(rf+f0[b1][b2][b3][b4])%mod;\n\t\trg=(rg+i*f0[b1][b2][b3][b4]*fac[k-1]%mod+g0[b1][b2][b3][b4])%mod;\n\t}\n\tf0[k][low][zero][cnt0]=rf;\n\tg0[k][low][zero][cnt0]=rg;\n\treturn;\n}\n```\n\u8fd8\u6709\u4e00\u4e9b\u7ec6\u8282\u5982\u5224\u65adK\u662f\u5426\u53ef\u4ee5\u88ab2,3,5,7\u8d28\u56e0\u6570\u5206\u89e3\u7b49\u4e0d\u4e00\u4e00\u8d58\u8ff0\u4e86\uff0c\u770b\u5b8c\u6574\u4ee3\u7801\u5427\uff0c\u5c11\u7528\u4e9b\u53d6\u6a21\u8fd0\u7b97\u901f\u5ea6\u63d0\u5347\u5f88\u5927\u3002\n\n\u611f\u89c9\u81ea\u5df1\u5199\u7684\u590d\u6742\u5ea6\u5f88\u9ad8\uff0c\u5e38\u6570\u5f88\u5927\uff0c\u6709\u53ef\u4f18\u5316\u4e4b\u5904\u8fd8\u671b\u5404\u4f4ddalao\u8d50\u6559qwq\u3002\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<ctime>\n#define ll long long\nusing namespace std;\nconst int mod=20120427;\nint kcnt;\nint to[70000][10],a[20],p[4]={2,3,5,7};\nll l,r,K,maxk;\nll fac[20],num[70000],f[20][70000],g[20][70000];\nll f0[20][2][2][20],g0[20][2][2][20];\nint id(ll x)\n{\n\treturn lower_bound(num+1,num+kcnt+1,x)-num;\n}\nint getto(int x,int k)\n{\n\tfor(int i=0;i<=3;i++)\n\t\twhile(k%p[i]==0)\n\t\t{\n\t\t\tk/=p[i];\n\t\t\tx=to[x][p[i]];\n\t\t}\n\treturn x;\n}\nvoid dp(int k,int rest)\n{\n\tif(!k)\n\t{\n\t\tf[k][rest]=(rest==1);\n\t\tg[k][rest]=0;\n\t\treturn;\n\t}\n\tif(f[k][rest]!=-1)return;\n\tll rf=0,rg=0;\n\tint a1,a2;\n\tfor(int i=9;i>=1;i--)\n\t{\n\t\ta1=k-1;\n\t\ta2=(i==0)?rest:to[rest][i];\n\t\tif(!a2)continue;\n\t\tdp(a1,a2);\n\t\trf+=f[a1][a2];\n\t\trg=(rg+i*f[a1][a2]*fac[k-1]+g[a1][a2])%mod;\n\t}\n\tf[k][rest]=rf%mod;\n\tg[k][rest]=rg;\n\treturn;\n}\nvoid init()\n{ \n\tint lim2=59,lim3=37,lim5=25,lim7=21;\n\tll fac2[60],fac3[60],fac5[60],fac7[60];\n\tfac2[0]=fac3[0]=fac5[0]=fac7[0]=1;\n\tfac[0]=1;\n\tfor(int i=1;i<=lim2;i++)fac2[i]=fac2[i-1]*2;\n\tfor(int i=1;i<=lim3;i++)fac3[i]=fac3[i-1]*3;\n\tfor(int i=1;i<=lim5;i++)fac5[i]=fac5[i-1]*5;\n\tfor(int i=1;i<=lim7;i++)fac7[i]=fac7[i-1]*7;\n\tfor(int i=1;i<=18;i++)fac[i]=fac[i-1]*10;\n\tmaxk=fac[18];\n\tfor(int i=1;i<=18;i++)fac[i]%=mod;\n\tfor(int i=0;i<=lim2;i++)\n\t\tfor(int j=0;j<=lim3&&fac2[i]*fac3[j]<=maxk;j++)\n\t\t\tfor(int k=0;k<=lim5&&fac2[i]*fac3[j]*fac5[k]<=maxk;k++)\n\t\t\t\tfor(int l=0;l<=lim7&&fac2[i]*fac3[j]*fac5[k]*fac7[l]<=maxk;l++)\n\t\t\t\t\tnum[++kcnt]=fac2[i]*fac3[j]*fac5[k]*fac7[l];\n\t//cout<<kcnt<<endl;\n\tsort(num+1,num+kcnt+1);\n\tfor(int i=1;i<=kcnt;i++)to[i][1]=i;\n\tfor(int i=0;i<=3;i++)\n\t\tfor(int j=1;j<=kcnt;j++)\n\t\t\tif(num[j]%p[i]==0)to[j][p[i]]=id(num[j]/p[i]);\n\tfor(int i=4;i<=9;i++)\n\t{\n\t\tif(i==p[0]||i==p[1]||i==p[2]||i==p[3])continue;\n\t\tfor(int j=1;j<=kcnt;j++)to[j][i]=getto(j,i);\n\t}\n\tmemset(f,-1,sizeof(f));\n\treturn;\n}\nll check(ll x)\n{\n\tfor(int i=0;i<=3;i++)\n\t\twhile(x%p[i]==0)x/=p[i];\n\treturn x;\n}\nll dfs(int k,int low,int zero,int rest,ll pre)\n{\n\tif(!rest)return 0;\n\tif(low&(!zero))\n\t{\n\t\tif(f[k][rest]==-1)dp(k,rest);\n\t\treturn (pre*fac[k]%mod*f[k][rest]+g[k][rest])%mod;\n\t}\n\tif(!k)return pre*(rest==1);\n\tll res=0;\n\tfor(int i=low?9:a[k];i>=(!zero);i--)\n\t\tres+=dfs(k-1,low|(i<a[k]),zero&(i==0),(i==0)?rest:to[rest][i],(pre*10+i)%mod);\n\treturn res;\n}\nvoid dp0(int k,int low,int zero,int cnt0)\n{\n\tif(!k)\n\t{\n\t\tf0[k][low][zero][cnt0]=(cnt0>0);\n\t\tg0[k][low][zero][cnt0]=0;\n\t\treturn;\n\t}\n\tif(f0[k][low][zero][cnt0]!=-1)return;\n\tll rf=0,rg=0;\n\tint b1,b2,b3,b4;\n\tfor(int i=low?9:a[k];i>=0;i--)\n\t{\n\t\tb1=k-1;\n\t\tb2=low|(i<a[k]);\n\t\tb3=zero&(i==0);\n\t\tb4=cnt0+((!zero)&(i==0));\n\t\tdp0(b1,b2,b3,b4);\n\t\trf=(rf+f0[b1][b2][b3][b4])%mod;\n\t\trg=(rg+i*f0[b1][b2][b3][b4]*fac[k-1]+g0[b1][b2][b3][b4])%mod;\n\t}\n\tf0[k][low][zero][cnt0]=rf;\n\tg0[k][low][zero][cnt0]=rg;\n\treturn;\n}\nll solve(ll x)\n{\n\tint len=0;\n\twhile(x)\n\t{\n\t\ta[++len]=x%10;\n\t\tx/=10;\n\t}\n\treturn dfs(len,0,1,id(K),0);\n}\nll solve0(ll x)\n{\n\tint len=0;\n\twhile(x)\n\t{\n\t\ta[++len]=x%10;\n\t\tx/=10;\n\t}\n\tmemset(f0,-1,sizeof(f0));\n\tdp0(len,0,1,0);\n\treturn g0[len][0][1][0];\n}\nint main()\n{\n\tint T;\n\tinit();\n\tcin>>T;\n\twhile(T--)\n\t{\n\t\tcin>>l>>r>>K;\n\t\tif(!K)\n\t\t{\n\t\t\tcout<<((solve0(r)-solve0(l-1))%mod+mod)%mod<<endl;\n\t\t\tcontinue;\n\t\t}\n\t\tll x=check(K);\n\t\tif(x!=1)\n\t\t{\n\t\t\tcout<<0<<endl;\n\t\t\tcontinue;\n\t\t}\n\t\tcout<<((solve(r)-solve(l-1))%mod+mod)%mod<<endl;\n\t}\n\treturn 0;\n}\n```\n\n\n\n\n\n\n\n",
        "postTime": 1585675875,
        "uid": 68865,
        "name": "slgdsxw",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5842 \u3010[SCOI2012]Blinker \u7684\u4ef0\u6155\u8005\u3011"
    },
    {
        "content": "#### \u9898\u610f\u7b80\u8ff0\uff1a\n\n\u6c42 $[l,r]$ \u5185\u5404\u4e2a\u6570\u4f4d\u79ef\u4e3a $k$ \u7684\u6570\u7684\u548c\u3002\n\n---\n\n#### \u89e3\uff1a\n\n\u5728\u770b\u9898\u89e3\u524d\uff0c\u8bf7\u5148\u786e\u8ba4\u81ea\u5df1\u662f\u5426\u7cbe\u901a\u4e86\u6570\u4f4d dp \u6a21\u677f\u9898\uff0c\u5426\u5219\u4f1a\u5f88\u96be\u7406\u89e3\u3002\n\n\u5bf9\u4e8e\u6734\u7d20\u7684\u6570\u4f4d dp\uff0c\u6211\u4eec\u53ef\u4ee5\u8bb0\u5f55 $f_{i,j}$ \u4ee3\u8868\u679a\u4e3e\u5230\u7b2c $x$ \u4f4d\uff0c\u8fd8\u9700\u8981\u7684\u4e58\u79ef\u4e3a $j$ \u7684\u6570\u4e4b\u548c\u3002\n\n\u53ea\u6709\u4e00\u4e2a\u72b6\u6001\u5904\u7406\u6570\u7684\u4e2a\u6570\uff0c\u4f46\u672c\u9898\u8981\u6c42\u6570\u7684\u548c\uff0c\u8fd9\u6837\u6211\u4eec\u6bd4\u8f83\u96be\u7528\u4e00\u4f4d\u53bb\u5904\u7406\u3002\n\n\u6240\u4ee5\u518d\u5b9a\u4e49 $g_{i,j}$ \u4e3a\u679a\u4e3e\u5230\u7b2c $x$ \u4f4d\uff0c\u8fd8\u9700\u8981\u7684\u4e58\u79ef\u4e3a $j$ \u7684\u6570\u4e2a\u6570\u3002\n\n\u90a3\u4e48\u5408\u5e76\u4e0a\u6765\u5373\u662f\uff1a\n\n$g_{i,j}=\\sum g_{i-1,j/k}$\n\n$f_{i,j}=\\sum f_{i-1,j/k}+k\\times g_{i-1,j/k}\\times 10^{i-1}$\n\n\u90a3\u4e48\u76f4\u63a5\u679a\u4e3e\u5411\u4e0b\u641c\u7d22\u5373\u53ef\uff0c\u5982\u679c\u641c\u5230\u5e95\u90e8 $j=1$\uff0c\u90a3\u4e48\u6240\u6709\u5e94\u8be5\u9664\u7684\u6570\u5df2\u9664\u5b8c\uff0c\u76f4\u63a5\u8fd4\u56de\u548c\u4e3a $0$\uff0c\u4e2a\u6570\u4e3a $1$\uff0c\u5426\u5219\u8fd4\u56de\u4e2a\u6570\u4e3a $0$\u3002\n\n\u7279\u6b8a\u5904\u7406\u4e00\u4e0b $K=0$\u3002\n\n\u5f53 $K=0$ \u65f6\u5c31\u8bb0\u5f55\u72b6\u6001\u4e3a\u5f53\u524d\u6570\u662f\u5426\u6709 $0$ \u8fd9\u4e00\u4f4d\uff0c\u7136\u540e\u540c\u6837\u8bb0\u5f55 $f,g$ \u4e24\u4e2a\u6570\u7ec4\u7684\u503c\uff0c\u5f80\u4e0b\u641c\u5373\u53ef\u3002\n\n\u7528 map \u5b58\u50a8\u8bb0\u5fc6\u5316\u6765\u89e3\u51b3\u7a7a\u95f4\u95ee\u9898\uff0c\u671f\u671b\u5f97\u5206 $20pts$\u3002\uff08\u4e0d\u6127\u662f\u9ed1\uff0c\u90e8\u5206\u5206\u90fd\u90a3\u4e48\u96be\u62ff\uff09\u3002\n\n---\n\n\u8003\u8651\u6734\u7d20 dp \u7684\u7f3a\u9677\u3002\n\n1\u3001\u8c03\u7528 map \u5f00\u9500\u5927\u91cf\u65f6\u95f4\u3002\n\n2\u3001\u6709\u8bb8\u591a\u5197\u4f59\u72b6\u6001\u3002\n\n\u8bf4\u767d\u4e86\u5c31\u662f\u6570\u5b58\u591a\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u5bf9\u6b64\u8fdb\u884c\u4f18\u5316\u3002\n\n\u7531\u4e8e\u6570\u4f4d\u53ea\u6709 $0$ \u5230 $9$\uff0c\u90a3\u4e48\u8d28\u6570\u53ea\u6709 $2,3,5,7$\uff0c\u6240\u4ee5\u5bf9\u6211\u4eec\u6765\u8bf4\u6709\u7528\u7684\u6570\u4ec5\u4ec5\u53ea\u6709 $2^a\\times3^b\\times5^c\\times7^d$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u628a\u72b6\u6001\u538b\u6210 $f_{i,a,b,c,d}$ \u4ee3\u8868\u679a\u4e3e\u5230\u7b2c $i$ \u4f4d\u6211\u4eec\u8fd8\u5269\u4e0b\u7684\u56e0\u5b50\u4e3a $2^a\\times3^b\\times5^c\\times7^d$ \u7684\u548c\uff0c$g_{i,a,b,c,d}$ \u540c\u7406\u3002\n\n\u8f6c\u79fb\u6bd4\u8f83\u5bb9\u6613\uff0c\u76f4\u63a5\u9884\u5904\u7406\u51fa\u6765\u6bcf\u4e2a\u6570\u5305\u542b\u54ea\u4e9b\u8d28\u56e0\u5b50\uff0c\u5728\u5bf9\u5e94\u7684\u8d28\u56e0\u5b50\u4e0a\u51cf\u53bb\u5373\u53ef\u3002\n\n\u671f\u671b\u5f97\u5206\uff1a$50pts$\uff0c\u5b9e\u9645\u5f97\u5206\uff1a$20pts$\uff0c\u88ab\u5361\u7a7a\u95f4\u4e86\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#define int long long\nusing namespace std;\nconst int mod=20120427;\nint n,cnt,a[20],f[20][55][37][20][20],g[20][55][37][20][20],t2,t3,t5,t7,power[20],k,f2[20][2][2][2],g2[20][2][2][2];\nint s[10][4]={\n{0,0,0,0},\n{0,0,0,0},\n{1,0,0,0},\n{0,1,0,0},\n{2,0,0,0},\n{0,0,1,0},\n{1,1,0,0},\n{0,0,0,1},\n{3,0,0,0},\n{0,2,0,0}\n};\npair<int,int>dfs(int x,int k2,int k3,int k5,int k7,bool flag,bool zero,bool zero2)\n{\n\t//cout<<x<<\" \"<<k2<<\" \"<<k3<<\" \"<<k5<<\" \"<<k7<<\" \"<<flag<<\" \"<<zero<<\" \"<<f[x][k2][k3][k5][k7]<<endl;\n\tif(x==0&&zero2)return {0,1};\n\tif(x==0&&!k2&&!k3&&!k5&&!k7)return {0,1};\n\tif(x==0)return {0,0};\n\tif(!flag&&!zero&&f[x][k2][k3][k5][k7]!=-1)return {f[x][k2][k3][k5][k7],g[x][k2][k3][k5][k7]};\n\tint ed=9;\n\tif(flag)ed=a[x];\n\tint sum=0,tot=0;\n\tfor(int i=0;i<=ed;i++)\n\t{\n\t\tif(!zero&&i==0&&k!=0)continue;\n\t\tint p2=k2-s[i][0],p3=k3-s[i][1],p5=k5-s[i][2],p7=k7-s[i][3];\n\t\tif((p2<0||p3<0||p5<0||p7<0))continue;\n\t\tpair<int,int>res=dfs(x-1,p2,p3,p5,p7,flag&(i==a[x]),zero&(i==0),zero2|((!zero)&(!i)));\n\t\ttot+=res.second;\n\t\ttot%=mod;\n\t\tsum+=res.first+i*power[x-1]%mod*res.second%mod;\n\t\tsum%=mod;\n\t}\n\tif(!flag&&!zero)f[x][k2][k3][k5][k7]=sum,g[x][k2][k3][k5][k7]=tot;\n\treturn {sum,tot};\n}\npair<int,int>dfs2(int x,bool flag,bool zero,bool zero2)\n{\n\tif(x==0)return {0,zero2};\n\tif(f2[x][flag][zero][zero2]!=-1)return {f2[x][flag][zero][zero2],g2[x][flag][zero][zero2]};\n\tint ed=9;\n\tif(flag)ed=a[x];\n\tint tot=0,sum=0;\n\tfor(int i=0;i<=ed;i++)\n\t{\n\t\tpair<int,int>res=dfs2(x-1,flag&(i==a[x]),zero&(i==0),zero2|((!zero)&(!i)));\n\t\ttot+=res.second;\n\t\ttot%=mod;\n\t\tsum+=res.first+i*power[x-1]%mod*res.second%mod;\n\t\tsum%=mod;\n\t}\n\tf2[x][flag][zero][zero2]=sum,g2[x][flag][zero][zero2]=tot;\n\treturn {sum,tot};\n}\nint solve(int x)\n{\n\tcnt=0;\n\twhile(x)\n\t{\n\t\ta[++cnt]=x%10;\n\t\tx/=10;\n\t}\n\tif(k==0)\n\t{\n\t\tmemset(f2,-1,sizeof(f2));\n\t\tmemset(g2,0,sizeof(g2));\n\t\tint res=dfs2(cnt,1,1,0).first;\n\t\treturn res;\n\t}\n\tint t=k;\n\tt2=t3=t5=t7=0;\n\twhile(t%2==0)t/=2,t2++;\n\twhile(t%3==0)t/=3,t3++;\n\twhile(t%5==0)t/=5,t5++;\n\twhile(t%7==0)t/=7,t7++;\n\t//if(t2>3*cnt||t3>2*cnt||t5>cnt||t7>cnt)return 0;\n\tif(k!=0&&t!=1)return 0;\n\tfor(int i=0;i<=cnt;i++)\n\t\tfor(int j=0;j<=t2;j++)\n\t\t\tfor(int sp=0;sp<=t3;sp++)\n\t\t\t\tfor(int q=0;q<=t5;q++)\n\t\t\t\t\tfor(int l=0;l<=t7;l++)f[i][j][sp][q][l]=-1,g[i][j][sp][q][l]=0;\n\tint res=dfs(cnt,t2,t3,t5,t7,1,1,0).first;\n\treturn res;\n}\nsigned main()\n{\n// \tfreopen(\"fans.in\",\"r\",stdin);\n// \tfreopen(\"fans.out\",\"w\",stdout);\n\tscanf(\"%lld\",&n);\n\tpower[0]=1;\n\tfor(int i=1;i<=18;i++)power[i]=power[i-1]*10,power[i]%=mod;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint l,r;\n\t\tscanf(\"%lld%lld%lld\",&l,&r,&k);\n\t\tint ans=solve(r)-solve(l-1);\n\t\tans=(ans%mod+mod)%mod;\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n\u8003\u8651\u4e0a\u8ff0\u65b9\u6cd5\u7f3a\u9677\uff1a\u6709\u7279\u522b\u591a\u72b6\u6001\u662f\u7528\u4e0d\u5230\u7684\uff0c\u5982 $2^{54}\\times 3^{36}$\uff0c\u800c\u6211\u4eec\u628a\u5b83\u4eec\u90fd\u538b\u5165\u4e86\u6570\u7ec4\u3002\n\n\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\uff1a\u76f4\u63a5\u9884\u5904\u7406\u51fa\u6765 $10^{18}$ \u4ee5\u5185\u6ee1\u8db3 $2^a\\times3^b\\times5^c\\times7^d$ \u7684\u6570\uff0c\u76f4\u63a5\u5faa\u73af\u679a\u4e3e\u5c31\u597d\u3002\n\n\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u8f6c\u79fb\u72b6\u6001\u65f6\u8981\u77e5\u9053\u4e0b\u4e00\u4e2a\u72b6\u6001\u7684\u7f16\u53f7\u4e3a\u591a\u5c11\uff0c\u8fd9\u4e2a\u63d0\u524d\u7528\u4e8c\u5206\u9884\u5904\u7406\u51fa\u6765\u5373\u53ef\uff0c\u6ce8\u610f\u6e05\u7a7a\u6570\u7ec4\u65f6\u5f97\u7528\u6808\u5148\u5b58\u50a8\u54ea\u4e9b\u72b6\u6001\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u518d\u6e05\u7a7a\u3002\n\n\u671f\u671b\u5f97\u5206\uff1a$100pts$\uff0c\u5b9e\u9645\u5f97\u5206\uff1a$50pts$\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<map>\n#include<algorithm>\n#define int long long\nusing namespace std;\nconst int mod=20120427;\nconst int N=7e4+5;\nconst int M=1e18+5;\nint n,cnt,a[20],f[20][N],g[20][N],t2,t3,t5,t7,power[20],f2[20][2][2][2],g2[20][2][2][2],num[N],lent,to[N][10],cnp;\nint s[10][4]={\n{0,0,0,0},\n{0,0,0,0},\n{1,0,0,0},\n{0,1,0,0},\n{2,0,0,0},\n{0,0,1,0},\n{1,1,0,0},\n{0,0,0,1},\n{3,0,0,0},\n{0,2,0,0}\n};\npair<int,int>q[N];\npair<int,int>dfs(int x,int k,bool flag,bool zero)\n{\n\tif(k==0)return {0,0};\n\t//cout<<x<<\" \"<<k<<\" \"<<flag<<\" \"<<zero<<endl;\n\tif(x==0&&k==1)return {0,1};\n\tif(x==0)return {0,0};\n\tif(!flag&&!zero&&f[x][k]!=-1)return {f[x][k],g[x][k]};\n\tint ed=9;\n\tif(flag)ed=a[x];\n\tint sum=0,tot=0;\n\tfor(int i=0;i<=ed;i++)\n\t{\n\t\tif(!zero&&i==0)continue;\n\t\tif(!to[k][i])continue;\n\t\tpair<int,int>res=dfs(x-1,to[k][i],flag&(i==a[x]),zero&(i==0));\n\t\ttot+=res.second;\n\t\ttot%=mod;\n\t\tsum+=res.first+i*power[x-1]%mod*res.second%mod;\n\t\tsum%=mod;\n\t}\n\tif(!flag&&!zero)f[x][k]=sum,g[x][k]=tot,q[++cnp]={x,k};\n\treturn {sum,tot};\n}\npair<int,int>dfs2(int x,bool flag,bool zero,bool zero2)\n{\n\tif(x==0)return {0,zero2};\n\tif(f2[x][flag][zero][zero2]!=-1)return {f2[x][flag][zero][zero2],g2[x][flag][zero][zero2]};\n\tint ed=9;\n\tif(flag)ed=a[x];\n\tint tot=0,sum=0;\n\tfor(int i=0;i<=ed;i++)\n\t{\n\t\tpair<int,int>res=dfs2(x-1,flag&(i==a[x]),zero&(i==0),zero2|((!zero)&(!i)));\n\t\ttot+=res.second;\n\t\ttot%=mod;\n\t\tsum+=res.first+i*power[x-1]%mod*res.second%mod;\n\t\tsum%=mod;\n\t}\n\tf2[x][flag][zero][zero2]=sum,g2[x][flag][zero][zero2]=tot;\n\treturn {sum,tot};\n}\nint numfind(int x)\n{\n\tint l=1,r=lent;\n\twhile(l<r)\n\t{\n\t\tint mid=(l+r)>>1;\n\t\tif(num[mid]<x)l=mid+1;\n\t\telse r=mid;\n\t}\n\treturn l;\n}\nint solve(int x,int k)\n{\n\tcnt=0;\n\twhile(x)\n\t{\n\t\ta[++cnt]=x%10;\n\t\tx/=10;\n\t}\n\tif(k==0)\n\t{\n\t\tmemset(f2,-1,sizeof(f2));\n\t\tmemset(g2,0,sizeof(g2));\n\t\tint res=dfs2(cnt,1,1,0).first;\n\t\treturn res;\n\t}\n\tint t=k;\n\tt2=t3=t5=t7=0;\n\twhile(t%2==0)t/=2,t2++;\n\twhile(t%3==0)t/=3,t3++;\n\twhile(t%5==0)t/=5,t5++;\n\twhile(t%7==0)t/=7,t7++;\n\tif(t!=1)return 0;\n\tcnp=0;\n\tint res=dfs(cnt,numfind(k),1,1).first;\n\tfor(int i=cnp;i>0;i--)f[q[i].first][q[i].second]=-1,g[q[i].first][q[i].second]=0;\n\treturn res;\n}\nvoid prepare()\n{\n\tint num2=1;\n\tfor(int i=0;i<=54;i++)\n\t{\n\t\tif(num2>M)break;\n\t\tint num3=1;\n\t\tfor(int j=0;j<=36;j++)\n\t\t{\n\t\t\tif(num2*num3>M)break;\n\t\t\tint num5=1;\n\t\t\tfor(int q=0;q<=18;q++)\n\t\t\t{\n\t\t\t\tif(num2*num3*num5>M)break;\n\t\t\t\tint num7=1;\n\t\t\t\tfor(int l=0;l<=18;l++)\n\t\t\t\t{\n\t\t\t\t\tif(num2*num3*num5*num7>M)break;\n\t\t\t\t\tnum[++lent]=num2*num3*num5*num7;\n\t\t\t\t\tnum7*=7;\n\t\t\t\t}\n\t\t\t\tnum5*=5;\n\t\t\t}\n\t\t\tnum3*=3;\n\t\t}\n\t\tnum2*=2;\n\t}\n\tsort(num+1,num+1+lent);\n\tfor(int i=1;i<=lent;i++)\n\t{\n\t\tto[i][0]=to[i][1]=i;\n\t\tfor(int j=2;j<=9;j++)\n\t\t{\n\t\t\tif(num[i]%j)continue;\n\t\t\tto[i][j]=numfind(num[i]/j);\n\t\t}\n\t}\n}\nint read()\n{\n\tchar ch=getchar();\n\tint sum=0;\n\twhile(ch>'9'||ch<'0')ch=getchar();\n\twhile(ch>='0'&&ch<='9')sum=(sum<<1)+(sum<<3)+(ch^48),ch=getchar();\n\treturn sum;\n}\nvoid write(int x)\n{\n\tif(x/10)write(x/10);\n\tputchar((x%10)^48);\n}\nsigned main()\n{\n\t//freopen(\"fans.in\",\"r\",stdin);\n\t//freopen(\"fans.out\",\"w\",stdout);\n\tprepare();\n\tn=read();\n\tpower[0]=1;\n\tmemset(f,-1,sizeof(f));\n\tfor(int i=1;i<=18;i++)power[i]=power[i-1]*10,power[i]%=mod;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint l,r,k;\n\t\tl=read(),r=read(),k=read();\n\t\tint ans=solve(r,k)-solve(l-1,k);\n\t\tans=(ans%mod+mod)%mod;\n\t\twrite(ans);\n\t\tputchar('\\n');\n\t}\n\treturn 0;\n}\n```\n\u90a3\u4e48\u5269\u4e0b\u7684\u4e5f\u4e0d\u597d\u5f04\u4e86\uff0c\u76f4\u63a5\u4e0a\u526a\u679d\u3002\n\n\u8bb0\u5f55\u4e00\u4e0b\u6bcf\u4e2a\u72b6\u6001\u641c\u5230 $1$ \u7684\u6700\u5c0f\u6b65\u6570\uff0c\u5982\u679c\u73b0\u5728\u72b6\u6001\u7684\u6b65\u6570\u5df2\u7ecf\u5927\u4e8e\u4e86\u5269\u4e0b\u7684\u4f4d\u6570\uff0c\u8bf4\u660e\u65e0\u6cd5\u8fbe\u5230\uff0c\u76f4\u63a5\u8fd4\u56de\u3002\n\n\u8bb0\u5f55\u6700\u5c0f\u6b65\u6570\u5c31\u4ece\u81ea\u5df1\u53ef\u80fd\u7684\u4e0b\u4e00\u4e2a\u72b6\u6001\u8f6c\u79fb\u4e0a\u6765\uff0c\u53d6\u6700\u5c0f\u503c\u3002\n\n\u671f\u671b\u5f97\u5206\uff1a$100pts$\uff0c\u5b9e\u9645\u5f97\u5206\uff1a$100pts$\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<map>\n#include<algorithm>\n#define int long long\nusing namespace std;\nconst int mod=20120427;\nconst int N=7e4+5;\nconst int M=1e18+5;\nint n,cnt,a[20],f[20][N],g[20][N],t2,t3,t5,t7,power[20],f2[20][2][2][2],g2[20][2][2][2],num[N],lent,to[N][10],cnp,dep[N];\npair<int,int>q[N];\npair<int,int>dfs(int x,int k,bool flag,bool zero)\n{\n\tif(k==0)return {0,0};\n\tif(dep[k]>x)return {0,0};\n\t//cout<<x<<\" \"<<k<<\" \"<<flag<<\" \"<<zero<<endl;\n\tif(x==0&&k==1)return {0,1};\n\tif(x==0)return {0,0};\n\tif(!flag&&!zero&&f[x][k]!=-1)return {f[x][k],g[x][k]};\n\tint ed=9;\n\tif(flag)ed=a[x];\n\tint sum=0,tot=0;\n\tfor(int i=0;i<=ed;i++)\n\t{\n\t\tif(!zero&&i==0)continue;\n\t\tif(!to[k][i])continue;\n\t\tpair<int,int>res=dfs(x-1,to[k][i],flag&(i==a[x]),zero&(i==0));\n\t\ttot+=res.second;\n\t\ttot%=mod;\n\t\tsum+=res.first+i*power[x-1]%mod*res.second%mod;\n\t\tsum%=mod;\n\t}\n\tif(!flag&&!zero)f[x][k]=sum,g[x][k]=tot,q[++cnp]={x,k};\n\treturn {sum,tot};\n}\npair<int,int>dfs2(int x,bool flag,bool zero,bool zero2)\n{\n\tif(x==0)return {0,zero2};\n\tif(f2[x][flag][zero][zero2]!=-1)return {f2[x][flag][zero][zero2],g2[x][flag][zero][zero2]};\n\tint ed=9;\n\tif(flag)ed=a[x];\n\tint tot=0,sum=0;\n\tfor(int i=0;i<=ed;i++)\n\t{\n\t\tpair<int,int>res=dfs2(x-1,flag&(i==a[x]),zero&(i==0),zero2|((!zero)&(!i)));\n\t\ttot+=res.second;\n\t\ttot%=mod;\n\t\tsum+=res.first+i*power[x-1]%mod*res.second%mod;\n\t\tsum%=mod;\n\t}\n\tf2[x][flag][zero][zero2]=sum,g2[x][flag][zero][zero2]=tot;\n\treturn {sum,tot};\n}\nint numfind(int x)\n{\n\tint l=1,r=lent;\n\twhile(l<r)\n\t{\n\t\tint mid=(l+r)>>1;\n\t\tif(num[mid]<x)l=mid+1;\n\t\telse r=mid;\n\t}\n\treturn l;\n}\nint solve(int x,int k)\n{\n\tcnt=0;\n\twhile(x)\n\t{\n\t\ta[++cnt]=x%10;\n\t\tx/=10;\n\t}\n\tif(k==0)\n\t{\n\t\tmemset(f2,-1,sizeof(f2));\n\t\tmemset(g2,0,sizeof(g2));\n\t\tint res=dfs2(cnt,1,1,0).first;\n\t\treturn res;\n\t}\n\tint t=k;\n\tt2=t3=t5=t7=0;\n\twhile(t%2==0)t/=2,t2++;\n\twhile(t%3==0)t/=3,t3++;\n\twhile(t%5==0)t/=5,t5++;\n\twhile(t%7==0)t/=7,t7++;\n\tif(t!=1)return 0;\n\tcnp=0;\n\tint res=dfs(cnt,numfind(k),1,1).first;\n\tfor(int i=cnp;i>0;i--)f[q[i].first][q[i].second]=-1,g[q[i].first][q[i].second]=0;\n\treturn res;\n}\nvoid prepare()\n{\n\tint num2=1;\n\tfor(int i=0;i<=54;i++)\n\t{\n\t\tif(num2>M)break;\n\t\tint num3=1;\n\t\tfor(int j=0;j<=36;j++)\n\t\t{\n\t\t\tif(num2*num3>M)break;\n\t\t\tint num5=1;\n\t\t\tfor(int q=0;q<=18;q++)\n\t\t\t{\n\t\t\t\tif(num2*num3*num5>M)break;\n\t\t\t\tint num7=1;\n\t\t\t\tfor(int l=0;l<=18;l++)\n\t\t\t\t{\n\t\t\t\t\tif(num2*num3*num5*num7>M)break;\n\t\t\t\t\tnum[++lent]=num2*num3*num5*num7;\n\t\t\t\t\tnum7*=7;\n\t\t\t\t}\n\t\t\t\tnum5*=5;\n\t\t\t}\n\t\t\tnum3*=3;\n\t\t}\n\t\tnum2*=2;\n\t}\n\tsort(num+1,num+1+lent);\n\tfor(int i=1;i<=lent;i++)\n\t{\n\t\tif(i!=1)dep[i]=1e18;\n\t\tto[i][0]=to[i][1]=i;\n\t\tfor(int j=2;j<=9;j++)\n\t\t{\n\t\t\tif(num[i]%j)continue;\n\t\t\tint lim=numfind(num[i]/j);\n\t\t\tto[i][j]=lim;\n\t\t\tdep[i]=min(dep[i],dep[lim]+1);\n\t\t}\n\t}\n}\nint read()\n{\n\tchar ch=getchar();\n\tint sum=0;\n\twhile(ch>'9'||ch<'0')ch=getchar();\n\twhile(ch>='0'&&ch<='9')sum=(sum<<1)+(sum<<3)+(ch^48),ch=getchar();\n\treturn sum;\n}\nvoid write(int x)\n{\n\tif(x/10)write(x/10);\n\tputchar((x%10)^48);\n}\nsigned main()\n{\n\t//freopen(\"fans.in\",\"r\",stdin);\n\t//freopen(\"fans.out\",\"w\",stdout);\n\tprepare();\n\tn=read();\n\tpower[0]=1;\n\tmemset(f,-1,sizeof(f));\n\tfor(int i=1;i<=18;i++)power[i]=power[i-1]*10,power[i]%=mod;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint l,r,k;\n\t\tl=read(),r=read(),k=read();\n\t\tint ans=solve(r,k)-solve(l-1,k);\n\t\tans=(ans%mod+mod)%mod;\n\t\twrite(ans);\n\t\tputchar('\\n');\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1668156060,
        "uid": 275793,
        "name": "Gmt\u4e36FFF",
        "ccfLevel": 5,
        "title": "P5842 [SCOI2012]Blinker \u7684\u4ef0\u6155\u8005 \u9898\u89e3"
    },
    {
        "content": "[$\\Large\\color{#FFBBFF}\\textit{Tian-Xing's blog}$](https://Tian-Xing.github.io)\n\n------------\n\n# Description\n\n[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5842)\n\n------------\n\n# Solution\n\n\u4e0d\u96be\u60f3\u5230\u8fd9\u9898\u7528\u6570\u4f4d$dp$\u89e3\u51b3\u3002\n\n\u90a3\u4e48\u9996\u5148\u53ef\u4ee5\u60f3\u5230$dp_{i, j, num2, num3, num5, num7}$\u8868\u793a\u4ece\u9ad8\u5230\u4f4e\u586b\u4e86$i$\u4f4d\uff0c\u662f\u5426\u5361\u4f4d\uff0c\u4e58\u79ef\u4e2d\u7684\u6bcf\u4e2a\u8d28\u56e0\u5b50\u6570\u91cf\u662f\u591a\u5c11\u6b64\u65f6\u7684\u65b9\u6848\u6570\uff0c$sum_{i, j, num2, num3, num5, num7}$\u8868\u793a\u8fd9\u4e9b\u6570\u7684\u548c\u3002\n\n\u8fd9\u6837\u5b50\u7684\u8f6c\u79fb\u662f\u5f88\u597d\u60f3\u7684\u4e0d\u518d\u8d58\u8ff0\uff0c\u4f46\u662f\u8fd9\u6837\u5b9a\u4e49\u72b6\u6001\u7a7a\u95f4\u4f1a\u7206\u70b8\uff0c\u5927\u6982\u9700\u8981$\\log_2 {2 ^ {64}} \\times \\log_3 {2 ^ {64}} \\times \\log_5 {2 ^ {64}} \\times \\log_7 {2 ^ {64}} \\times 2 \\times 19 \\times 2= 125296640$\u7684\u7a7a\u95f4\u3002\n\n\u8fd9\u65f6\u6ce8\u610f\u5230\u5b9e\u9645\u4e0a\u6ca1\u5fc5\u8981\u7528\u8fd9\u4e48\u591a\u72b6\u6001\uff0c\u6240\u6709\u53ef\u884c\u7684\u72b6\u6001\u53ea\u6709\u5927\u6982$66061$\u4e2a\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u628a\u6240\u6709\u7684\u53ef\u884c\u72b6\u6001\u90fd\u6254\u5230\u4e00\u4e2a\u54c8\u5e0c\u8868\u91cc\uff0c\u5c31\u89e3\u51b3\u4e86\u7a7a\u95f4\u7684\u95ee\u9898\u3002\n\n\u63a5\u4e0b\u6765\u5c31\u53ef\u4ee5\u6309\u7167\u5957\u8def\u5148\u9884\u5904\u7406\u51fa$f_{i, j}$\u8868\u793a\u4ece\u4f4e\u5230\u9ad8$i$\u4f4d\uff0c\u4e58\u79ef\u5728\u54c8\u5e0c\u8868\u91cc\u7684\u4f4d\u7f6e\u662f$j$\u7684\u65b9\u6848\u6570\uff0c$sum_{i, j}$\u8868\u793a\u6b64\u65f6\u7684\u548c\u3002\n\n\u5269\u4e0b\u7684\u5c31\u662f\u5982\u4f55\u5361\u4f4d\u4ee5\u53ca\u7b97\u8d21\u732e\u3002\n\n\u4ece\u9ad8\u4f4d\u5230\u4f4e\u4f4d\u679a\u4e3e\u4e00\u4e0b$lcp$\u7136\u540e\u679a\u4e3e\u8fd9\u4f4d\u586b\u7684\u6570\u5b57$j$\u3002\u5148\u5224\u65ad\u586b$j$\u662f\u5426\u53ef\u884c\uff0c\u4e5f\u5c31\u662f\u8bf4\u770b\u770b$lcp$\u548c$j$\u7684\u79ef\u662f\u5426\u6574\u9664$k$\u3002\u53ea\u8981\u8fd9\u4e00\u4f4d\u4e0d\u662f\u586b\u7684\u6700\u9ad8\u4f4d\u90a3\u4e48\u540e\u9762\u53ef\u4ee5\u968f\u4fbf\u586b\uff0c\u6240\u4ee5\u8fd9\u4e00\u4f4d\u5982\u679c\u53ef\u884c\u5c31\u5728\u6700\u7ec8\u7684\u7b54\u6848\u91cc\u52a0\u4e0a$(lcp \\times 10 + j) * 10^{i - 1} * f_{i - 1, k / lcp / j} + g_{i - 1, k / lcp / j}$\u3002\n\n\u6700\u540e\u522b\u5fd8\u4e86\u52a0\u4e0a$\\sum_{i = 1}^{n - 1}g_{i, k}$\u3002\n\n\u5bf9\u4e8e\u5361\u4f4d\uff0c\u6bcf\u4e00\u4f4d\u90fd\u5361\u5230\u6700\u9ad8\u6570\u5b57\u8981\u6c42\u53ea\u7b97\u4e00\u904d\u8d21\u732e\u3002\u6211\u4eec\u6bcf\u6b21\u679a\u4e3e\u6bcf\u4e00\u4f4d\u586b\u4ec0\u4e48\u7684\u65f6\u5019\u586b\u5c0f\u4e8e\u5f53\u524d\u4f4d\u7684\u6570\u5b57\uff0c\u8fd9\u65f6\u6211\u4eec\u53d1\u73b0\u6240\u6709\u4f4d\u90fd\u5361\u4f4d\u7684\u60c5\u51b5\u6ca1\u6709\u7b97\u4e0a\uff0c\u90a3\u4e48\u53ef\u4ee5\u5c06\u8981\u7b97\u7684\u6570\u5148\u52a0\u4e00\uff0c\u8fd9\u6837\u4fdd\u8bc1\u53ea\u5728\u6700\u540e\u4e00\u4f4d\u7684\u65f6\u5019\u7b97\u4e0a\u4e86\u8d21\u732e\u3002\n\n\u6ce8\u610f$k$\u7684\u53d6\u503c\u53ef\u80fd\u662f$0$\uff0c\u8fd9\u662f\u6211\u4eec\u5c31\u8981\u6c42\u81f3\u5c11\u6709\u4e00\u4f4d\u662f$0$\u5e76\u4e14\u6709\u6570\u5b57\u51fa\u73b0\u8fc7\uff0c\u8fd9\u5c31\u662f\u4e00\u4e2a\u57fa\u7840\u7684\u6570\u4f4d$dp$\uff0c\u6b64\u5904\u4e0d\u518d\u8d58\u8ff0\u3002\n\n------------\n\n# Code\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n\nusing namespace std;\n\nconst int MOD = 20120427, HashMOD = 1000037, zt = 66062;\n\n#define ll long long\n\nint head[HashMOD + 50], num, f[19][zt], g[19][zt], cnt, zhi[20], pow[19], dp[20][2][2][2], sum[20][2][2][2];\n\nstruct Node\n{\n\tint next;\n\tll zhi;\n} hash[HashMOD + 50];\n\ntemplate <class T>\nvoid Read(T &x)\n{\n\tx = 0; int p = 0; char st = getchar();\n\twhile (st < '0' || st > '9') p = (st == '-'), st = getchar();\n\twhile (st >= '0' && st <= '9') x = (x << 1) + (x << 3) + st - '0', st = getchar();\n\tx = p ? -x : x;\n\treturn;\n}\n\ntemplate <class T>\nvoid Put(T x)\n{\n\tif (x < 0) putchar('-'), x = -x;\n\tif (x > 9) Put(x / 10);\n\tputchar(x % 10 + '0');\n\treturn; \n}\n\nint Ins(ll x)\n{\n\tint bh = x % HashMOD;\n\tfor (int i = head[bh]; i; i = hash[i].next)\n\t\tif (hash[i].zhi == x) return i;\n\thash[++num] = (Node){head[bh], x};\n\thead[bh] = num;\n\treturn num;\n} \n\nint Ask(ll x)\n{\n\tint bh = x % HashMOD;\n\tfor (int i = head[bh]; i; i = hash[i].next)\n\t\tif (hash[i].zhi == x) return i;\n\treturn 0;\n}\n\nvoid Prework()\n{\n\tpow[0] = 1;\n\tfor (int i = 1; i <= 18; i++) pow[i] = (pow[i -1] * 10) % MOD;\n\tint tmp;\n\tf[0][Ins(1)] = 1;\n\tfor (int i = 0; i < 18; i++)\n\t\tfor (int j = 1; j <= num; j++)\n\t\t\tfor (int k = 1; k <= 9; k++)\n\t\t\t{\n\t\t\t\tif (hash[j].zhi * k > 1000000000000000000LL) break;\n\t\t\t\t(f[i + 1][tmp = Ins(hash[j].zhi * k)] += f[i][j]) %= MOD,\n\t\t\t\t(g[i + 1][tmp] += g[i][j] * 10 % MOD + f[i][j] * k) %= MOD;\n\t\t\t}\n\treturn;\n} \n\nint Work(ll x, ll k)\n{\n\tcnt = 0;\n\twhile (x)\n\t{\n\t\tzhi[++cnt] = x % 10;\n\t\tx /= 10;\n\t}\n\tll ans = 0, pre = 0, mul = 1;\n\tfor (int i = cnt; i; i--)\n\t{\n\t\tif (!zhi[i]) break;\n\t\tfor (int j = 1; j < zhi[i]; j++)\n\t\t\tif ((k % (mul * j)) == 0)\n\t\t\t{\n\t\t\t\tll tmp = k / mul / j;\n\t\t\t\tint t = Ask(tmp);\n\t\t\t\t(ans += (pre * 10 + j) * pow[i - 1] % MOD * f[i - 1][t] % MOD + g[i - 1][t]) %= MOD; \n\t\t\t}\n\t\tpre = pre * 10 + zhi[i];\n\t\tmul = mul * zhi[i];\n\t}\n\tint tmp = Ask(k);\n\tfor (int i = 1; i < cnt; i++) (ans += g[i][tmp]) %= MOD;\n\treturn ans;\n} \n\nint Work0(ll x)\n{\n\tcnt = 0;\n\tmemset(dp, 0, sizeof(dp));\n\tmemset(sum, 0, sizeof(sum));\n\twhile (x)\n\t{\n\t\tzhi[++cnt] = x % 10;\n\t\tx /= 10;\n\t}\n\tdp[cnt + 1][1][0][0] = 1;\n\tfor (int i = cnt + 1; i >= 2; i--)\n\t{\n\t\tif (i != cnt + 1) dp[i][0][0][0] = 1;\n\t\tfor (int j = 0; j <= 1; j++)\n\t\t\tfor (int t = 0; t <= 1; t++)\n\t\t\t\tfor (int q = 0; q <= 1; q++)\n\t\t\t\t\tif (dp[i][j][t][q])\n\t\t\t\t\t\tfor (int k = 0; k <= 9; k++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (j && k > zhi[i - 1]) break;\n\t\t\t\t\t\t\tif (!t && !q && !k) continue; \n\t\t\t\t\t\t\t(dp[i - 1][j && (k == zhi[i - 1])][t || (!k)][q || k] += dp[i][j][t][q]) %= MOD; \n\t\t\t\t\t\t\t(sum[i - 1][j && (k == zhi[i - 1])][t || (!k)][q || k] += sum[i][j][t][q] * 10 + dp[i][j][t][q] * k) %= MOD;\n \t\t\t\t\t\t}\n\t}\n \treturn (sum[1][1][1][1] + sum[1][0][1][1]) % MOD;\n}\n\nint main()\n{\n\tPrework();\n\tint t;\n\tll l, r, k;\n\tRead(t);\n\twhile (t--)\n\t{\n\t\tRead(l); Read(r); Read(k);\n\t\tif (k) Put((Work(r + 1, k) - Work(l, k) + MOD) % MOD), putchar('\\n');\n\t\telse Put((Work0(r) - Work0(l - 1) + MOD) % MOD), putchar('\\n');\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1586664344,
        "uid": 73983,
        "name": "Infiltrator",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5842 \u3010[SCOI2012]Blinker \u7684\u4ef0\u6155\u8005\u3011"
    }
]
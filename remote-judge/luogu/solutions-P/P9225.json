[
    {
        "content": "## \u9898\u76ee\u5206\u6790\n\n\u9996\u5148\u6309\u7167\u7f16\u53f7\u4ece\u5c0f\u5230\u5927\u5730\u8003\u8651\u673a\u5668\uff0c\u53ef\u4ee5\u53d1\u73b0\u5f53\u8003\u8651\u5230\u7b2c $i$ \u53f0\u673a\u5668\u65f6\uff0c\u751f\u4ea7\u7684\u94bb\u77f3\u4e0d\u662f $2^i$ \u500d\u6570\u7684\u60c5\u51b5\u4e00\u5b9a\u4e0d\u4f18\u3002\u90a3\u4e48\u60f3\u5230 dp\uff0c\u8bbe $f(i,j)$ \u8868\u793a\u524d $i$ \u53f0\u673a\u5668\u751f\u4ea7\u4e86 $j\\times 2^i$ \u4e2a\u94bb\u77f3\u7684\u6700\u5c0f\u82b1\u8d39\uff0c\u66b4\u529b\u5b9e\u73b0\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u6307\u6570\u7ea7\u7684\uff0c\u4e0b\u9762\u6211\u4eec\u8003\u8651\u4f18\u5316\u3002\n\n\u7b2c\u4e00\u4e2a\u4f18\u5316\uff0c\u6839\u636e $a_i,b_i$ \u7684\u8303\u56f4\u6211\u4eec\u5bb9\u6613\u53d1\u73b0\u6bcf\u53f0\u673a\u5668\u88ab\u542f\u52a8\u7684\u6b21\u6570\u4e00\u5b9a\u4e0d\u4f1a\u592a\u591a\u3002\u5177\u4f53\u6765\u8bf4\u542f\u52a8 $k$ \u6b21\u7684\u82b1\u8d39\u662f $k\\times a_i+{k\\times (k-1)\\over 2}\\times b_i\\geq {k\\times(k+1)\\over 2}$\uff0c\u800c\u7b54\u6848\u6700\u5927\u4e5f\u53ea\u80fd\u662f $a_n$\uff0c\u4e8e\u662f $k\\leq \\sqrt {2a_n}$\uff0c\u4e8e\u662f $j$ \u6700\u5927\u53ea\u9700\u679a\u4e3e\u5230 $k\\times{\\sum_{p=1}^i 2^p\\over 2^i}=2\\sqrt {2a_n}$\u3002\u6b64\u65f6\u6211\u4eec\u4f18\u5316\u5230\u4e86 $O(n\\times a_n)$\u3002\n\n\u7b2c\u4e8c\u4e2a\u4f18\u5316\uff0c\u518d\u8003\u8651\u80fd\u5426\u5feb\u901f\u8f6c\u79fb\u3002\u6211\u4eec\u5217\u5f0f\u5b50\u6709 $f_{i,j}=\\min \\{ f_{i-1,2\\times k}+(j-k)\\times a_i+{(j-k-1)(j-k)\\over 2}\\times b_i\\}$\uff0c\u800c\u5728\u6bcf\u4e00\u8f6e\u8f6c\u79fb\u4e2d\u4e0e $i$ \u76f8\u5173\u7684\u4e1c\u897f\u90fd\u662f\u56fa\u5b9a\u7684\uff0c\u6240\u4ee5\u8f6c\u5316\u6210 $g_j=\\min \\{h_k+(j-k)\\times a+{(j-k-1)(j-k)\\over 2}\\times b\\}$ \u8fd9\u79cd\u5f62\u5f0f\u3002\u90a3\u4e48\u53d1\u73b0\u53ef\u4ee5\u659c\u7387\u4f18\u5316\uff0c\u6a2a\u5750\u6807\u5355\u589e\uff0c\u4f7f\u7528\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u4e0b\u51f8\u58f3\u3002\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4f18\u5316\u5230\u4e86 $O(n\\sqrt {a_n})$\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n## \u4ee3\u7801\n\n```cpp\n/*\n  author: PEKKA_l  \n*/\n#include <iostream>\n#include <cstring>\n#include <algorithm>\n#include <cstdio>\nusing namespace std;\n#define int long long\n\nint n,a[1005],b[1005],dp[9005],g[9005],head,tail,q[9005];\n\nint gety(int x,int k) {return g[k]+k*(k+1)*b[x]/2-a[x]*k;}\n\nsigned main()\n{\n\tcin>>n; for(int i=1;i<=n;i++) cin>>a[i]; for(int i=1;i<=n;i++) cin>>b[i];\n\tfor(int i=0;i<=9000;i++) dp[i]=a[1]*i+b[1]*(i-1)*i/2;\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=4500;j++) {g[j]=dp[j<<1]; g[j+4500]=100000000000000000;} head=tail=1;\n\t\tfor(int j=1;j<=9000;j++)\n\t\t{\n\t\t\twhile(head<tail&&(double)(gety(i,q[tail])-gety(i,q[tail-1]))/(q[tail]-q[tail-1])>=(double)(gety(i,j)-gety(i,q[tail]))/(j-q[tail])) tail--;\n\t\t\tq[++tail]=j;\n\t\t\twhile(head<tail&&b[i]*j>=(double)(gety(i,q[head+1])-gety(i,q[head]))/(q[head+1]-q[head])) head++;\n\t\t\tdp[j]=g[q[head]]+a[i]*(j-q[head])+(j-q[head]-1)*(j-q[head])*b[i]/2;\n\t\t}\n\t}\n\tcout<<dp[1]<<endl;\n}\n```\n",
        "postTime": 1681744049,
        "uid": 529697,
        "name": "PEKKA_l",
        "ccfLevel": 6,
        "title": "P9225 \u9898\u89e3"
    },
    {
        "content": "\u8fd9\u4e5f\u80fd\u7d2b\u9898\u5417\u54e5\uff1f\n\n\u9996\u5148\u663e\u7136\u7b54\u6848\u4e0d\u4f1a\u8d85\u8fc7 $a_n$\uff0c\u6240\u4ee5\u6bcf\u5c42\u53ea\u80fd\u53d6 $\\sqrt{2a_n}$ \u4e2a\u3002\n\n\u8003\u8651\u4ece\u524d\u5f80\u540e DP\uff0c\u6bcf\u5c42\u9009\u82e5\u5e72\u4e2a\u4e4b\u540e $\\div2$ \u8f6c\u79fb\u5230\u4e0b\u4e00\u5c42\u3002\n\n\u7136\u540e\u4f60\u7528\u811a\u90fd\u80fd\u770b\u51fa\u6765\u524d $x-1$ \u5c42\u7684\u51b3\u7b56\u548c\u7b2c $x$ \u5c42\u7684\u51b3\u7b56\u90fd\u662f\u51f8\u7684\uff0c\u6240\u4ee5\u76f4\u63a5\u53cc\u6307\u9488\u626b\u4e00\u904d\uff08\u4f60\u4e5f\u53ef\u4ee5\u53eb\u5b83\u95f5\u53ef\u592b\u65af\u57fa\u548c\uff09\u5904\u7406\u5f53\u524d\u5c42\u51b3\u7b56\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\sqrt v)$\u3002",
        "postTime": 1685503305,
        "uid": 111055,
        "name": "dead_X",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P9225"
    }
]
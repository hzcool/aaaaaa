[
    {
        "content": "\u9898\u89e3\u540c\u6b65\u53d1\u5728[\u535a\u5ba2](https://foreverlasting1202.github.io/)\n\n\u77e9\u9635\u5feb\u901f\u5e42\u3002\n\n\u771f\u7684\u53ef\u60dc\u554a\uff0c\u6bd4\u8d5b\u7684\u65f6\u5019\u5fc5\u987b\u8981\u53bb\u665a\u81ea\u4fee\uff0c\u5bfc\u81f4\u4e00\u5806\u5206\u90fd\u6ca1\u62ff\uff0c\u96be\u53d7\u5f97\u4e00\u6279\u3002\n\n\u8bf4\u8bf4\u8fd9\u9053\u9898\uff0c\u51fa\u9898\u4eba\u7684\u539f\u610f\u662f$k$\u8fdb\u5236\u77e9\u4e58\u662f\u5427\u3002\u7136\u540e\u6211\u5c31\u6b63\u5e38\u500d\u589e\u77e9\u4e58\u8fc7\u4e86\u6b64\u9898\uff0c\u8ba9\u6211\u5f88\u662f\u9707\u60ca\u3002\n\n\u6211\u65e2\u6ca1\u6709\u5faa\u73af\u5c55\u5f00\uff0c\u4e5f\u6ca1\u6709\u4ec0\u4e48\u77e9\u4e58\u7684\u65f6\u5019\u4e58\u4e86\u4e00\u5b9a\u6b21\u6570\u518d\u819c\u6765\u51cf\u5c11\u819c\u7684\u6b21\u6570\uff0c\u5c31\u662f\u6700\u8001\u5b9e\u7684\u77e9\u4e58\uff0c\u53ef\u80fd\u6211\u4ee3\u7801\u5929\u751f\u81ea\u5e26\u5c0f\u5e38\u6570\u3002\u4e0d\u8fc7\u4e00\u4e9b\u5c0f\u6280\u5de7\u8fd8\u662f\u8981\u6ce8\u610f\u4e00\u4e0b\u7684\uff0c\u6bd4\u5982\u8bf4\u80fd\u51cf\u6cd5\u5c31\u505a\u51cf\u6cd5\uff0c\u4e0d\u8981\u53d6\u6a21\uff0c\u7136\u540e\u5c3d\u91cf\u51cf\u5c11\u77e9\u4e58\u65f6\u7684\u5faa\u73af\u6b21\u6570\uff0c\u6bd4\u5982\u8bb0\u5f55\u4e00\u4e2a\u77e9\u9635\u5927\u5c0f\uff0c\u5176\u4ed6\u597d\u50cf\u5c31\u6ca1\u6709\u4ec0\u4e48\u4e86\u3002\n\n\u6b63\u5f0f\u9898\u89e3\u5728[\u6b64](https://blog.csdn.net/stone41123/article/details/85039483)\n\uff0c\u6709\u6b63\u5f0f\u9898\u89e3\u90a3\u6211\u4e0d\u7528\u8bb2\u4e86\uff0c\u76f4\u63a5\u4e0a\u4ee3\u7801\u3002\n\ncode:\n```\n//2018.12.17 by ljz\n#include<bits/stdc++.h>\nusing namespace std;\n#define res register int\n#define LL long long\n#define inf 0x3f3f3f3f\n#define eps 1e-15\ninline int read(){\n    res s=0;\n    bool w=0;\n    char ch=getchar();\n    while(ch<'0'||ch>'9'){if(ch=='-')w=1;ch=getchar();}\n    while(ch>='0'&&ch<='9')s=s*10+ch-'0',ch=getchar();\n    return w?-s:s;\n}\ninline void _swap(res &x,res &y){\n    x^=y^=x^=y;\n}\ninline int _abs(const res &x){\n    return x>0?x:-x;\n}\ninline int _max(const res &x,const res &y){\n    return x>y?x:y;\n}\ninline int _min(const res &x,const res &y){\n    return x<y?x:y;\n}\nconst int N=50+10;\nconst int kcz=998244353;\nnamespace MAIN{\n    struct Matrix{\n        int t[N][N],n,m;\n        Matrix() {memset(t,0,sizeof(t));}\n        inline void INIT(){\n            for(res i=0;i<n;i++)t[i][i]=1;\n        }\n    };\n    int n,m,q;\n    int a[N];\n    inline void add(res &x,const res &y){\n        x+=y,x>=kcz?x-=kcz:1;\n    }\n    inline Matrix operator * (const Matrix &x,const Matrix &y){\n        Matrix cnt;\n        for(res i=0;i<x.n;i++)\n            for(res j=0;j<y.m;j++)\n                for(res k=0;k<x.m;k++)add(cnt.t[i][j],1LL*x.t[i][k]*y.t[k][j]%kcz);\n        cnt.n=x.n,cnt.m=y.m;\n        return cnt;\n    }\n    Matrix ret,ans[32];\n    inline int qpow(res x,res y){\n        res ret=1;\n        while(y){\n            if(y&1)ret=1LL*ret*x%kcz;\n            x=1LL*x*x%kcz,y>>=1;\n        }\n        return ret;\n    }\n    inline void MAIN(){\n        n=read(),m=read(),q=read();\n        for(res i=0;i<n;i++)ret.t[i][0]=read();\n        ret.n=ret.m=1;\n        ans[0].n=ans[0].m=n;\n        ans[0].INIT();\n        for(res i=1;i<=m;i++){\n            res u=read(),v=read();\n            ans[0].t[v-1][u-1]++;\n        }\n        for(res i=0;i<n;i++){\n            res pos=0;\n            for(res j=0;j<n;j++)add(pos,ans[0].t[j][i]);\n            pos=qpow(pos,kcz-2);\n            for(res j=0;j<n;j++)ans[0].t[j][i]=1LL*ans[0].t[j][i]*pos%kcz;\n        }\n        for(res i=1;i<=31;i++)ans[i]=ans[i-1]*ans[i-1];\n        while(q--){\n            res t=read();\n            Matrix tmp=ret;\n            for(res i=0;i<=31;i++)if((1<<i)&t)tmp=ans[i]*tmp;\n            LL qaq=0;\n            for(res i=0;i<n;i++)qaq^=tmp.t[i][0];\n            printf(\"%lld\\n\",qaq%kcz);\n        }\n    }\n}\nint main(){\n    MAIN::MAIN();\n    return 0;\n}\n```",
        "postTime": 1545029198,
        "uid": 32878,
        "name": "foreverlasting",
        "ccfLevel": 7,
        "title": "LG5107\u3010\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "# P5107 \u80fd\u91cf\u91c7\u96c6\n#### [ \u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5107)\n\n**\u66b4 \u529b \u8349 \u6807 \u7b97**\n\n\u5f53\u7136\u4e5f\u4e0d\u662f\u6700\u57fa\u7840\u7684\u66b4\u529b\uff0c\u7528\u77e9\u9635\u5feb\u901f\u5e42\u500d\u589e\u4e00\u4e0b\u518d\u5361\u5361\u5e38\u5c31\u8f7b\u677e\u8fc7\u53bb\u4e86\u3002\n##### \u524d\u7f6e\u77e5\u8bc6\n\n\u5148\u770b\u6570\u636e\u8303\u56f4\uff0c$1\\leqslant n\\leqslant 50$\uff0c\u663e\u7136\u662f\u8ba9 $n^3$ \u7b97\u6cd5\u8fc7\u7684\uff0c $n^3$ \u60f3\u5230\u4ec0\u4e48\uff1f\u77e9\u9635\u4e58\u6cd5\uff01\n\n\u60f3\u5230\u77e9\u9635\u4e58\u6cd5\u5c31\u597d\u505a\u4e86\uff0c\u5982\u679c\u4f60\u4e0d\u77e5\u9053\u77e9\u9635\u4e58\u6cd5\u662f\u4ec0\u4e48~~\u90a3\u4f60\u770b\u4e3a\u5565\u8981\u770b\u8fd9\u9053\u9898~~\uff0c\u51fa\u95e8\u5de6\u8f6c\u6a21\u677f\u533a[\u77e9\u9635\u5feb\u901f\u5e42](https://www.luogu.com.cn/problem/P3390)\u548c[\u77e9\u9635\u52a0\u901f](https://www.luogu.com.cn/problem/P1939)\uff0c\u8fd9\u91cc\u7b80\u5355\u5217\u51fa\u5f0f\u5b50\uff0c\u4e0d\u518d\u8bb2\u89e3\uff1a\n\n\u5bf9\u4e8e $p\\times q$ \u7684\u77e9\u9635 $A$ \u4e0e $q\\times r$ \u7684\u77e9\u9635 $B$\uff0c\u5b83\u4eec\u7684\u4e58\u79ef $C=A\\times  B$ \u8ba1\u7b97\u65b9\u5f0f\u4e3a\uff1a\n\n$$C_{i,j}=\\sum_{k=1}^{q}A_{i,k}\\times B_{k,j}$$\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(pqr)$\u3002\n\n****\n\n\u73b0\u5728\u4f60\u4e86\u89e3\u4e86\u77e9\u9635\u4e58\u6cd5\u4e0e\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u90a3\u4e48\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u4e00\u4e2a $n\\times1$  \u7684\u77e9\u9635 $res$ \u4e3a\u521d\u59cb\u77e9\u9635\uff0c\u5176\u4e2d $res_{i,1}$ \u4ee3\u8868\u7b2c $i$ \u4e2a\u70b9\u6700\u5f00\u59cb\u7684\u80fd\u91cf\u3002\n\n\u5bf9\u4e8e\u8fb9\uff0c\u6211\u4eec\u521b\u9020\u4e00\u4e2a $n\\times n$ \u7684\u8f6c\u6362\u77e9\u9635 $base$ \u4e3a\u56fe\u7684\u90bb\u63a5\u77e9\u9635\uff0c\u5176\u4e2d\uff0c$res_{i,1}\\times base_{i,j}$ \u4e3a $i$ \u53f7\u70b9\u4f1a\u6d41\u7ed9 $j$ \u53f7\u70b9\u7684\u80fd\u91cf\u3002\u5bf9\u4e8e\u8fb9$(u,v)$\uff0c\u6211\u4eec\u4f7f $base'_{v,u}$ \u52a0\u4e00\uff0c\u6700\u540e\n$$base_{i,j}=\\frac{base'_{i,j}}{\\sum_{k=1}^nbase'_{k,j}}$$\n\n\u6c42\u4e00\u4e2a\u9006\u5143\u5373\u53ef\u3002\n\n****\n\u5bf9\u4e8e\u6bcf\u6b21\u8be2\u95ee\u76f4\u63a5\u4e0a\u77e9\u9635\u5feb\u901f\u5e42\u5417\uff1f\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(qn^3log_2t)\u22481.8\\times10^{11}$ ~~\u539f\u5730\u5347\u5929~~\u3002\n\n\u90a3\u600e\u4e48\u529e\uff1f\n\n\u4ee4\n$$P_i=base^{2^i}={P_{i-1}}^2$$\n\u6bcf\u6b21\u8be2\u95ee\u7684\u7b54\u6848\u77e9\u9635 $ans$ \u521d\u59cb\u503c\u8bbe\u4e3a $res$ \uff0c\u5bf9\u4e8e\u6bcf\u4e2a $i\\in[0,31]$ \u4e14 $t$ \u5728\u4e8c\u8fdb\u5236\u4e0b\u7b2c $i$ \u4f4d\u6709\u4e3a $1$\uff0c$ans\\gets P_i\\times ans$\n.\n\n\u6700\u7ec8\u7b54\u6848\u4e3a$\\bigoplus_{i=1}^{n}ans_{i,1}$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(n^3log_2t+qn^2log_2t)\u22483.7\\times10^9$\uff0c\u5361\u5361\u5e38\u5c31\u53ef\u4ee5\u8fc7\u4e86\uff0c\u7528`__int128`\u628a $\\sum_{k=1}^{q}A_{i,k}\\times B_{k,j}$ \u5b58\u8d77\u6765\u6700\u540e\u53d6\u6a21\u53ef\u4ee5\u5927\u5927\u51cf\u5c11\u53d6\u6a21\u6b21\u6570\uff0c\u53ef\u4ee5\u5361\u8fdb $3s$\u3002\n\n\u6b63\u89e3\u5927\u6982\u662f\u8f6c\u5230 $k$ \u8fdb\u5236\u500d\u589e\uff0c\u4f46\u662f\u6211\u592a\u849f\u84bb\u4e86\u4e0d\u4f1a\uff0c\u53ef\u4ee5\u770b\u522b\u7684\u5946\u4f6c\u7684\u9898\u89e3\u3002\n****\n$Code$\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nnamespace IO{//IO\u4f18\u5316\n\tint len=0;\n\tchar ibuf[(1<<20)+1],*iS,*iT,out[(1<<25)+1];\n\t#define gh() (iS==iT?iT=(iS=ibuf)+fread(ibuf,1,(1<<20)+1,stdin),(iS==iT?EOF:*iS++):*iS++)\n\t#define reg register\n\tinline int read(){\n\t\treg char ch=gh();\n\t\treg int x=0;\n\t\twhile(ch<'0'||ch>'9') ch=gh();\n\t\twhile(ch>='0'&&ch<='9') x=x*10+(ch^48),ch=gh();\n\t\treturn x;\n\t}\n\tinline void write(int x){\n\t\tif(x>9)write(x/10);\n\t\tout[len++]=x%10+48;\n\t}\n}using namespace IO;\nconst int mod=998244353;\ninline void add(int &a,int b){//\u4f18\u5316\u52a0\u6cd5\n\ta+=b;\n\tif(a>=mod) a-=mod;\n}\nstruct matrix{//\u77e9\u9635\n\tint n,m,a[55][55];\n\tint* operator[](const int &x){\n\t\treturn a[x];\n\t}\n\tmatrix(){\n\t\tmemset(a,0,sizeof(a));\n\t}\n\tfriend matrix operator*(const matrix &a,const matrix &b){//\u77e9\u9635\u4e58\u6cd5\n\t\tmatrix c;\n\t\tc.n=a.n;\n\t\tc.m=b.m;\n\t\tfor(int i=1;i<=a.n;i++){\n\t\t\tfor(int j=1;j<=b.m;j++){\n\t\t\t\t__int128 ret=0;\n\t\t\t\tfor(int k=1;k<=a.m;k++){\n\t\t\t\t\tret+=1ll*a.a[i][k]*b.a[k][j];\n\t\t\t\t}\n\t\t\t\tc[i][j]=ret%mod;\n\t\t\t}\n\t\t}\n\t\treturn c;\n\t}\n\tinline void init(int qwq){//\u5927\u5c0f\u4e3aqwq*qwq\u7684\u5355\u4f4d\u77e9\u9635\n\t\tn=m=qwq;\n\t\tfor(int i=1;i<=n;i++){\n\t\t\ta[i][i]=1;\n\t\t}\n\t}\n}res,p[32];\ninline int qpow(int x,int y){//\u5feb\u901f\u5e42\n\tint ret=1;\n\twhile(y){\n\t\tif(y&1) ret=1ll*ret*x%mod;\n\t\tx=1ll*x*x%mod;\n\t\ty>>=1;\n\t}\n\treturn ret;\n}\nint n,m,q;\ninline void init(){\n\tn=read(),m=read(),q=read();\n\tfor(int i=1;i<=n;i++){//\u539f\u77e9\u9635\n\t\tres[i][1]=read();\n\t}\n\tres.n=n;\n\tres.m=1;\n\tp[0].init(n);\n\tfor(int i=1;i<=m;i++){\n\t\tint u=read(),v=read();\n\t\tp[0][v][u]++;//\u90bb\u63a5\u77e9\u9635\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tint ret=0;\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tadd(ret,p[0][j][i]);\n\t\t}\n\t\tret=qpow(ret,mod-2);//\u9006\u5143\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tp[0][j][i]=1ll*p[0][j][i]*ret%mod;\n\t\t}\n\t}\n\tfor(int i=1;i<=31;i++){//\u9884\u5904\u7406P\n\t\tp[i]=p[i-1]*p[i-1];\n\t}\n}\ninline void solve(){\n\tfor(int i=1;i<=q;i++){\n\t\tint t=read();\n\t\tmatrix now=res;\n\t\tfor(int j=31;~j;j--){//\u500d\u589e\n\t\t\tif(t&(1<<j)){\n\t\t\t\tnow=p[j]*now;\n\t\t\t}\n\t\t}\n\t\tll ans=0;\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tans^=now[j][1];\n\t\t}\n\t\twrite(ans%mod);\n\t\tout[len++]='\\n';\n\t}\n}\nint main(){\n\tinit();\n\tsolve();\n\tfwrite(out,1,len,stdout);\n    return 0;\n}\n/*\nMemoty:5.49MB\nTime:5.17s\n*/\n```\n\u90a3\u4e48\u849f\u84bb\u7684\u8fd9\u7bc7\u9898\u89e3\u5c31\u7ed3\u675f\u4e86\uff0c\u518d\u89c1$qwq$~",
        "postTime": 1609428613,
        "uid": 365127,
        "name": "cyffff",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5107 \u3010\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "### \u9898\u610f\u7b80\u8ff0\uff1a\n\n\u7ed9\u5b9a\u4e00\u5f20 $n$ \u4e2a\u70b9\uff0c$n+m$ \u6761\u6709\u5411\u8fb9\uff08\u5305\u62ec\u81ea\u73af\uff09\u7684\u6709\u5411\u56fe\u3002\n\n\u6bcf\u4e00\u65f6\u523b\u70b9 $u$ \u7684\u6743\u503c\u4f1a\u5e73\u5747\u5206\u914d\u5230\u6240\u6709 $u\\to v$ \u7684\u8fb9\u7684\u7ec8\u70b9\u4e0a\u3002\n\n\u4f8b\u5982 $2\\to 2$\uff0c$2\\to 1$\uff0c$2\\to 3$\uff0c$2\\to 3$ \u56db\u6761\u8fb9\u3002  \n\u70b9 $2$ \u7684\u6743\u503c\u5c31\u4f1a\u5e73\u5206\u6210 $4$ \u4efd\uff0c\u4e00\u4efd\u7ed9\u70b9 $2$\uff0c\u4e00\u4efd\u7ed9\u70b9 $1$\uff0c\u4e24\u4efd\u7ed9\u70b9 $3$\u3002\n\n$q$ \u6b21\u8be2\u95ee\uff0c\u95ee $t$ \u65f6\u523b\u540e\u6bcf\u4e2a\u70b9\u7684\u6743\u503c ${}\\bmod 998244353$\u3002\n\n### \u9898\u89e3\uff1a\n\n\u8003\u8651\u8868\u793a\u51fa\u6bcf\u4e00\u65f6\u523b\u6743\u503c\u5206\u914d\u7684\u8fc7\u7a0b\u3002\n\n\u53d1\u73b0\u53ef\u4ee5\u7528\u77e9\u9635\u7684\u5f62\u5f0f\u8f6c\u79fb\uff1a\u8fb9 $u\\to v$\uff08\u5305\u62ec\u81ea\u73af\uff09\u8868\u793a\u5728\u77e9\u9635 $Q_{v,u}$ \u5904\u52a0\u4e0a $1/d_u$\u3002\u5176\u4e2d $d_u$ \u8868\u793a\u70b9 $u$ \u7684\u51fa\u5ea6\uff08\u5305\u62ec\u81ea\u73af\uff09\u3002\n\n\u6700\u7ec8\u5373\u662f\u6c42 $Q^{t}\\times a$\u3002\u5176\u4e2d $a$ \u5c31\u662f\u521d\u59cb\u6743\u503c\u7684\u5217\u5411\u91cf\u3002\n\n\u8003\u8651\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316\u3002\n\n\u590d\u6742\u5ea6 $\\Theta(qn^3\\log_2t)\\approx 2\\times 10^{11}$\u3002\u663e\u7136\u4e0d\u80fd\u63a5\u53d7\u3002\n\n---\n\n### \u4e00\u3001\n\n\u8003\u8651\u4f18\u5316\u77e9\u9635\u5feb\u901f\u5e42\u7684\u8fc7\u7a0b\u3002\n\n\u8003\u8651\u6c42\u7684\u662f $Q^{t}\\times a$ \u662f\u4e00\u4e2a\u5217\u5411\u91cf\uff0c\u672c\u8d28\u4e0a\u662f\u77e9\u9635\u548c\u5411\u91cf\u7684\u4e58\u79ef\u3002\n\n\u8ba1\u7b97\u77e9\u9635\u548c\u5411\u91cf\u7684\u4e58\u79ef\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\Theta(n^2)$ \u7684\uff0c\u6bd4\u8f83\u4f4e\u3002\n\n\u8003\u8651\u51cf\u5c11\u77e9\u9635\u548c\u77e9\u9635\u4e58\u79ef\u7684\u6b21\u6570\uff0c\u7528\u77e9\u9635\u548c\u5411\u91cf\u7684\u4e58\u79ef\u4ee3\u66ff\u3002\n\n\u628a $Q^t$ \u8868\u793a\u6210\u82e5\u5e72\u4e2a\u53ef\u4ee5\u76f4\u63a5\u5f97\u51fa\u7684\u77e9\u9635\u7684\u4e58\u79ef $Q_1\\times Q_2\\times Q_3\\times \\cdots$\u3002\n\n\u5219\u7b54\u6848\u53ef\u4ee5\u5199\u4f5c $Q_1\\times(Q_2\\times(Q_3\\times(\\cdots \\times a)))$ \u7684\u5f62\u5f0f\u3002\n\n\u5176\u4e2d\u7684\u6bcf\u6b21\u4e58\u6cd5\u90fd\u662f\u77e9\u9635\u548c\u5411\u91cf\u7684\u4e58\u6cd5\uff0c\u590d\u6742\u5ea6\u6bd4\u8f83\u4f18\u3002\n\n---\n\n### \u4e8c\u3001\n\n\u90a3\u4e48\u5982\u4f55\u628a $Q^t$ \u5206\u89e3\u5462\uff1f\u6bd4\u8f83\u5bb9\u6613\u60f3\u5230\u7684\u662f\u4e8c\u8fdb\u5236\u62c6\u5206\u3002\n\n\u5373\u8bb0\u5f55 $Q^1, Q^2, Q^4, Q^8, Q^{16}, Q^{32}, \\cdots$\uff0c\u8ba1\u7b97\u65f6\u6839\u636e $t$ \u7684\u503c\u4e0e\u5bf9\u5e94\u7684\u77e9\u9635\u76f8\u4e58\u5373\u53ef\u3002\n\n\u8fd9\u6837\u7684\u590d\u6742\u5ea6\u662f $\\Theta(\\log_2 t(n^3+qn^2))\\approx 4\\times 10^9$\uff0c\u76f8\u8f83\u4e0a\u6b21\u6709\u8f83\u5927\u4f18\u5316\u3002\n\n\u4f46\u662f\u4ecd\u7136\u4e0d\u80fd\u63a5\u53d7\uff0c\u53d1\u73b0\u5176\u4e2d $n^3\\log_2 t$ \u662f\u9884\u5904\u7406\u590d\u6742\u5ea6\uff0c\u6bd4\u8f83\u5c0f\u3002  \n\u800c\u590d\u6742\u5ea6\u74f6\u9888\u4ecd\u5728\u4e8e\u8ba1\u7b97\u7b54\u6848\u65f6\u7684\u590d\u6742\u5ea6\u3002\n\n---\n\n### \u4e09\u3001\n\n\u8003\u8651\u8ba9\u9884\u5904\u7406\u590d\u6742\u5ea6\u7a0d\u5fae\u6269\u5927\uff0c\u4ee5\u51cf\u5c0f\u8ba1\u7b97\u7b54\u6848\u65f6\u7684\u590d\u6742\u5ea6\u3002\n\n\u65b9\u6cd5\u5c31\u662f\u4e0d\u8981\u7528\u4e8c\u8fdb\u5236\u62c6\u5206\u3002\n\n\u4ee4\u8fdb\u5236\u6570\u4e3a $b$ \uff0c\u5219\u6700\u7ec8\u590d\u6742\u5ea6\u5e94\u8be5\u4e3a $\\Theta(b\\lceil\\log_b t\\rceil n^3+q\\lceil\\log_b t\\rceil n^2)$\u3002  \n\u5373 $\\Theta(n^2\\lceil\\log_b t\\rceil (bn+q))$\u3002\n\n\u8ba1\u7b97\u4e00\u6ce2\u53ef\u4ee5\u5f97\u5230\uff0c\u5f53 $\\lceil\\log_b t\\rceil=4$ \u7684\u65f6\u5019\u4f1a\u6bd4\u8f83\u79d1\u5b66\uff0c\u5bf9\u5e94\u7684 $b$ \u503c\u4e3a $178$\u3002\n\n\u6700\u7ec8\u7684\u590d\u6742\u5ea6\u4e3a $\\Theta(n^2\\times 4\\times (178n+q))\\approx 5.89\\times 10^8$ \u53ef\u80fd\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\n\n---\n\n### \u56db\u3001\n\n\u6700\u540e\u8003\u8651\u4e00\u4e0b $q$ \u4e2a\u8be2\u95ee\uff0c\u53d1\u73b0 $t$ \u662f\u6ca1\u6709\u987a\u5e8f\u7684\u3002\n\n\u5982\u679c\u628a $t$ \u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u6bcf\u6b21\u4ece\u4e0a\u4e00\u4e2a\u7684\u7ed3\u679c\u63a8\u8fc7\u6765\uff0c\u4e5f\u53ef\u4ee5\u4f18\u5316\u4e00\u4e9b\u5e38\u6570\u3002\n\n---\n\n### \u4e94\u3001\n\n\u6700\u540e\u662f\u5e95\u5c42\u4f18\u5316\u3002\u5728\u77e9\u9635\u5feb\u901f\u5e42\u65f6\u5faa\u73af\u5c55\u5f00\u53ef\u80fd\u53ef\u4ee5\u5f97\u5230\u66f4\u597d\u7684\u6548\u679c\u3002\n\n---\n\n### \u603b\u7ed3\uff1a\n\n\u524d\u4e09\u79cd\u4f18\u5316\u5982\u679c\u4e0d\u52a0\u662f\u8fc7\u4e0d\u4e86\u8fd9\u9898\u7684\u3002\u540e\u4e24\u79cd\u4f18\u5316\u53ef\u4ee5\u9009\u62e9\u6027\u7684\u4f7f\u7528\u3002\n\n\u6211\u7684\u4ee3\u7801\u53ea\u7528\u4e86\u7b2c\u56db\u4e2a\u4f18\u5316\uff0c\u800c\u6807\u7a0b\u5219\u4e24\u79cd\u90fd\u7528\u4e86\u3002\n\n\u8d34\u4e00\u4e0b\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#define F(i) for(int i=0;i<N;++i)\nconst int Mod=998244353;\nconst int B=178;\ntypedef long long LL;\nint inv[2452];\ninline void Init(){inv[1]=1;for(int i=2;i<=2451;++i)inv[i]=(LL)(Mod-Mod/i)*inv[Mod%i]%Mod;}\ninline void Add(int&x,int y){x-=(x+=y)>=Mod?Mod:0;}\nint N,M,Q;\nint q[50000],p[50000],Ans[50000];\nint S[2450],T[2450],d[50];\nstruct Mat{int a[50][50];};\nstruct Vec{int a[50];};\nMat operator*(Mat p1,Mat p2){\n\tMat p3;LL s;\n\tF(i)F(j){\n\t\ts=0;\n\t\tF(k)s=(s+(LL)p1.a[i][k]*p2.a[k][j])%Mod;\n\t\tp3.a[i][j]=s;\n\t}\n\treturn p3;\n}\nVec operator*(Mat p1,Vec p2){\n\tVec p3;LL s;\n\tF(i){\n\t\ts=0;\n\t\tF(j)s=(s+(LL)p1.a[i][j]*p2.a[j])%Mod;\n\t\tp3.a[i]=s;\n\t}\n\treturn p3;\n}\nVec v;\nMat A;\nMat s[4][B];\ninline void IM(){\n\tfor(int i=0;i<4;++i){\n\t\tif(i)s[i][1]=s[i-1][1]*s[i-1][B-1];\n\t\telse s[i][1]=A;\n\t\tfor(int j=2;j<B;++j)s[i][j]=s[i][1]*s[i][j-1];\n\t}\n}\ninline Vec E(Vec v,int e){\n\tif(!e)return v;\n\tfor(int j=0;e;++j,e/=B)if(e%B)v=s[j][e%B]*v;\n\treturn v;\n}\nint main(){\n\tInit();int x;\n\tscanf(\"%d%d%d\",&N,&M,&Q);\n\tF(i)scanf(\"%d\",&x),v.a[i]=x,d[i]=1;\n\tfor(int i=0;i<M;++i)scanf(\"%d%d\",S+i,T+i),++d[--S[i]],--T[i];\n\tF(i)F(j)A.a[i][j]=i==j?inv[d[i]]:0;\n\tfor(int i=0;i<M;++i)Add(A.a[T[i]][S[i]],inv[d[S[i]]]);\n\tIM();\n\tfor(int i=0;i<Q;++i)scanf(\"%d\",q+i),p[i]=i;\n\tsort(p,p+Q,[](int i,int j){return q[i]<q[j];});\n\tint lst=0;\n\tfor(int qq=0;qq<Q;++qq){\n\t\tv=E(v,q[p[qq]]-lst);\n\t\tint S=0;\n\t\tF(i)S^=v.a[i];\n\t\tAns[p[qq]]=S%Mod;\n\t\tlst=q[p[qq]];\n\t}\n\tfor(int qq=0;qq<Q;++qq)printf(\"%d\\n\",Ans[qq]);\n\treturn 0;\n}\n```",
        "postTime": 1544970840,
        "uid": 10703,
        "name": "\u5c0f\u7c89\u5154",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5107 \u3010\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "\u597d\u8349\u554a\u2026\u7b80\u5355\u9898\u8c03\u4e86\u534a\u5929\u3002\n\n\u8fd9\u9898\u5176\u5b9e\u662f\u4e00\u4e2a\u77e9\u9635\u5feb\u901f\u5e42\u7684\u677f\u5b50\uff0c\u5982\u679c\u4e0d\u4f1a\u7684\u8bdd\u5efa\u8bae\u53bb\u5b66\u77e9\u9635\u5feb\u901f\u5e42\u3002\n\n\u7136\u540e\u7684\u8bdd\u8fd9\u9898\u666e\u901a\u7684\u5feb\u901f\u5e42\u662f\u8fc7\u4e0d\u53bb\u7684\u3002\n\u6211\u4eec\u8003\u8651 $k$ \u8fdb\u5236\u4f18\u5316\u3002\n\n\u5e38\u89c1\u7684\u500d\u589e\u77e9\u9635\u5176\u5b9e\u662f $k^x$ \u7684$k=2$\u60c5\u51b5\u3002\n\n\u4f46\u662f\u8fd9\u9898\u7528\u8fd9\u79cd\u65b9\u6cd5\u4e0d\u77e5\u9053\u80fd\u4e0d\u80fd\u8dd1\u8fc7\u53bb\uff0c\u4f3c\u4e4e\u9898\u89e3\u6709\u4eba\u8fd9\u4e48\u8fc7\u4e86\u3002\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8003\u8651 $k$ \u53d6 32 \u7684\u65f6\u5019\uff0c\u8dd1\u7684\u98de\u5feb\uff08\n\n```cpp\n#include <bits/stdc++.h>\nconst int P = 998244353;\nvoid mul(int &x, const int &y) {\n\tx = 1ll * x * y % P;\n}\nint power(int x, int y) {\n\tif (y < 0) {\n\t\ty += P - 1;\n\t}\n\tint res = 1;\n\twhile (y) {\n\t\tif (y & 1) {\n\t\t\tmul(res, x);\n\t\t}\n\t\tmul(x, x);\n\t\ty /= 2;\n\t}\n\treturn res;\n}\nvoid plus(int &x, const int &y) {\n\tx += y;\n\tif (x >= P) {\n\t\tx -= P;\n\t}\n}\nvoid sub(int &x, const int &y) {\n\tx -= y;\n\tif (x < 0) {\n\t\tx += P;\n\t}\n}\nstruct modint {\n\tint value;\n\tmodint() {\n\t\tvalue = 0;\n\t}\n\tmodint(int _value): value(_value) {}\n\tvoid operator =(const int &rhs) {\n\t\tvalue = rhs;\n\t}\n\tvoid operator =(const modint &rhs) {\n\t\tvalue = rhs.value;\n\t}\n\tmodint operator +(const int &rhs) {\n\t\tif (value + rhs >= P) {\n\t\t\treturn value + rhs - P;\n\t\t} else {\n\t\t\treturn value + rhs;\n\t\t}\n\t}\n\tmodint operator +(const modint &rhs) {\n\t\tif (value + rhs.value >= P) {\n\t\t\treturn value + rhs.value - P;\n\t\t} else {\n\t\t\treturn value + rhs.value;\n\t\t}\n\t}\n\tmodint operator -(const int &rhs) {\n\t\tif (value < rhs) {\n\t\t\treturn value - rhs + P;\n\t\t} else {\n\t\t\treturn value - rhs;\n\t\t}\n\t}\n\tmodint operator -(const modint &rhs) {\n\t\tif (value < rhs.value) {\n\t\t\treturn value - rhs.value + P;\n\t\t} else {\n\t\t\treturn value - rhs.value;\n\t\t}\n\t}\n\tmodint operator *(const int &rhs) {\n\t\treturn 1ll * value * rhs % P;\n\t}\n\tmodint operator *(const modint &rhs) {\n\t\treturn 1ll * value * rhs.value % P;\n\t}\n\tmodint operator /(const int &rhs) {\n\t\treturn 1ll * value * power(rhs, -1) % P;\n\t}\n\tmodint operator /(const modint &rhs) {\n\t\treturn 1ll * value * power(rhs.value, -1) % P;\n\t}\n\tvoid operator +=(const int &rhs) {\n\t\tplus(value, rhs);\n\t}\n\tvoid operator +=(const modint &rhs) {\n\t\tplus(value, rhs.value);\n\t}\n\tvoid operator -=(const int &rhs) {\n\t\tsub(value, rhs);\n\t}\n\tvoid operator -=(const modint &rhs) {\n\t\tsub(value, rhs.value);\n\t}\n\tvoid operator *=(const int &rhs) {\n\t\tmul(value, rhs);\n\t}\n\tvoid operator *=(const modint &rhs) {\n\t\tmul(value, rhs.value);\n\t}\n\tvoid operator /=(const int &rhs) {\n\t\tmul(value, power(rhs, -1));\n\t}\n\tvoid operator /=(const modint &rhs) {\n\t\tmul(value, power(rhs.value, -1));\n\t}\n\tbool operator ==(const int &rhs) {\n\t\treturn value == rhs;\n\t}\n\tbool operator ==(const modint &rhs) {\n\t\treturn value == rhs.value;\n\t}\n\toperator int() {\n\t\treturn value;\n\t}\n};\nint n, m, q;\nconst int N = 50;\nstruct Matrix {\n\tmodint a[N][N];\n\tmodint* operator[](int x) {\n\t\treturn a[x];\n\t}\n\tMatrix() {}\n\tvoid initial() {\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\ta[i][i] = 1;\n\t\t}\n\t}\n\tvoid print() {\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tstd::cout << a[i][j] << ' ';\n\t\t\t}\n\t\t\tstd::cout << \"\\n\";\n\t\t}\n\t}\n};\nstruct Line {\n\tmodint a[N];\n\tmodint& operator[](int x) {\n\t\treturn a[x];\n\t}\n\tLine() {}\n\tvoid print() {\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tstd::cout << a[i] << ' ';\n\t\t}\n\t\tstd::cout << \"\\n\";\n\t}\n};\nMatrix mul(Matrix x, Matrix y) {\n\tMatrix z;\n\tfor (int i = 0; i < n; i++) {\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tz[i][j] = 0;\n\t\t\tfor (int k = 0; k < n; k++) {\n\t\t\t\tz[i][j] += x[i][k] * y[k][j];\n\t\t\t}\n\t\t}\n\t}\n\treturn z;\n}\nLine mul(Line x, Matrix y) {\n\tLine z;\n\tfor (int j = 0; j < n; j++) {\n\t\tz[j] = 0;\n\t\tfor (int k = 0; k < n; k++) {\n\t\t\tz[j] += x[k] * y[k][j];\n\t\t}\n\t}\n\treturn z;\n}\nLine initial;\nconst int T = 5;\nconst int S = 1 << T;\nMatrix base, pw[32 / T + 1][S];\nLine res;\nint main() {\n\tstd::ios::sync_with_stdio(false);\n\tstd::cin.tie(nullptr);\n\tstd::cin >> n >> m >> q;\n\tfor (int i = 0; i < n; i++) {\n\t\tint x;\n\t\tstd::cin >> x;\n\t\tinitial[i] = x;\n\t}\n\twhile (m--) {\n\t\tint x, y;\n\t\tstd::cin >> x >> y;\n\t\t--x;\n\t\t--y;\n\t\tbase[x][y] += 1;\n\t}\n\tfor (int i = 0; i < n; i++) {\n\t\tbase[i][i] += 1;\n\t}\n\tfor (int i = 0; i < n; i++) {\n\t\tmodint all = 0;\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tall += base[i][j];\n\t\t}\n\t\tint iv = power(all, -1);\n\t\tfor (int j = 0; j < n; j++) {\n\t\t\tbase[i][j] *= iv;\n\t\t}\n\t}\n\tfor (int i = 0; i < 32 / T + 1; i++) {\n\t\tpw[i][0].initial();\n\t\tif (i == 0) {\n\t\t\tpw[i][1] = base;\n\t\t} else {\n\t\t\tpw[i][1] = mul(pw[i - 1][S - 1], pw[i - 1][1]);\n\t\t}\n\t\tfor (int j = 2; j < S; j++) {\n\t\t\tpw[i][j] = mul(pw[i][j - 1], pw[i][1]);\n\t\t}\n\t}\n\twhile (q--) {\n\t\tint x;\n\t\tstd::cin >> x;\n\t\tres = initial;\n\t\tint t = 0;\n\t\twhile (x) {\n\t\t\tres = mul(res, pw[t][x & S - 1]);\n\t\t\tx >>= T;\n\t\t\t++t;\n\t\t}\n\t\tint ans = 0;\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tans ^= res[i];\n\t\t}\n\t\tif (ans >= P) {\n\t\t\tans -= P;\n\t\t}\n\t\tstd::cout << ans << '\\n';\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1604297733,
        "uid": 96580,
        "name": "SXNhdW5veWE",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5107 \u3010\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "\u5f53\u6211\u770b\u5230\u8fd9\u9053\u9898\u7684\u65f6\u5019\uff0c\u6211\u5c31\u611f\u89c9\u5b83\u548c[\u9b54\u6cd5\u503c](https://www.luogu.com.cn/problem/P6569)\u7279\u522b\u50cf\uff0c\u6240\u4ee5\u6ca1\u505a\u8fc7\u7684\u53ef\u4ee5\u53bb\u505a\u505a\uff0c\u8bf4\u4e0d\u5b9a\u4f1a\u6709\u4ec0\u4e48\u65b0\u7684\u53d1\u73b0\u3002\n\n### Solution\n\n\u77e9\u9635\u5feb\u901f\u5e42\n\n\u770b\u89c1 $n$ \u7684\u8303\u56f4\u662f $1\\leq n\\leq 50$ \uff0c\u4e0d\u96be\u60f3\u5230\u8fd9\u9053\u9898\u8981\u7528\u5230\u90bb\u63a5\u77e9\u9635\u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u505a\u8fd9\u4e2a\u9898\u3002\u6784\u9020\u4e00\u4e2a $n\\times n$ \u7684\u77e9\u9635\uff0c $G_{i,j}$ \u4ee3\u8868 $i\\rightarrow j$ \u6709\u662f\u5426\u4e00\u6761\u6709\u5411\u8fb9\uff0c\u6709\u7684\u8bdd\u5b58\u50a8\u7684\u5219\u662f $i$ \u7684\u51fa\u5ea6\u7684\u9006\u5143\uff0c\u90a3\u4e48 $G$ \u5c31\u662f\u6211\u4eec\u7684\u8f6c\u79fb\u77e9\u9635\u3002\u628a $F$ \u4e00\u4e2a $1\\times n$ \u7684\u5217\u5411\u91cf\u4f5c\u4e3a\u521d\u59cb\u77e9\u9635\uff0c\u53ea\u5b58\u50a8 $a_i$ \u3002\u6b64\u65f6\u590d\u6742\u5ea6\u4e3a $O(qn^3\\log t)$ \u3002\n\n\u5982\u679c\u52a0\u4e0a\u500d\u589e\u9884\u5904\u7406 $G^{2^i}$ \uff0c\u590d\u6742\u5ea6\u53ef\u964d\u4e3a $O(n^3\\log t+qn^2\\log t)$ \u3002   \n\n\n\n\u4f46\u6b64\u65f6\u7684\u590d\u6742\u5ea6\u5728\u8138\u9ed1\u7684\u60c5\u51b5\u4e0b\u8fd8\u662f\u8fc7\u4e0d\u4e86\u7684\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u4f18\u5316\uff0c\u53ef\u4ee5\u8003\u8651\u5c06\u500d\u589e\u4e2d\u7684\u4e8c\u8fdb\u5236\u9884\u5904\u7406\u6539\u4e3a\u66f4\u5927\u7684\u8fdb\u5236\uff0c\u8bbe\u4e3a $z$ \u8fdb\u5236\uff0c\u5219\u6b64\u65f6\u590d\u6742\u5ea6\u4e3a $O(n^3\\log_z t+qn^2\\log_z t)$ \u5c31\u53ef\u4ee5\u8fc7\u4e86\n\n\uff08\u8fd8\u6709\u4e00\u4e9b\u4f18\u5316\u662f\u4f18\u5316\u5e38\u6570\uff0c\u5728\u8fd9\u91cc\u4e0d\u63d0\u4e86\uff09\n\n**\u6ce8\u610f\uff1a\u56e0\u4e3a\u4f1a\u6d41\u5411\u81ea\u5df1\uff0c\u6240\u4ee5 $i\\rightarrow i$  \u4e5f\u76f8\u5f53\u4e8e\u6709\u4e00\u6761\u6709\u5411\u8fb9\uff0c\u5373\u5728\u77e9\u9635\u4e2d\u4e5f\u8981\u8f6c\u79fb**\n\n### \u4ee3\u7801\n\n```c++\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<algorithm>\n#define re register\n#define ll long long\n\nusing namespace std;\nconst int maxn=51,mod=998244353;\ninline int add(int a,int b){int res=a+b;if(res>=mod) res-=mod;return res;}\ninline int mul(int a,int b){return (ll)a*b-(ll)a*b/mod*mod;}\ninline int dec(int a,int b){int res=a-b;if(res<0) res+=mod;return res;}\nint n,m,q,out[maxn],map[maxn][maxn],inv[maxn*maxn];\nstruct matrix{\n    int a[maxn][maxn],x,y;//x,y\u662f\u77e9\u9635\n    inline matrix(){memset(a,0,sizeof(a));}\n    inline matrix operator = (const matrix &o){\n        memcpy(a,o.a,sizeof(a));x=o.x;y=o.y;\n        return *this;\n    }\n    inline matrix operator * (const matrix &o) const {\n        matrix res;\n        res.x=x;res.y=o.y;\n        for(re int i=1;i<=x;i++)\n            for(re int k=1;k<=y;k++)\n                for(re int j=1;j<=o.y;j++)\n                    res.a[i][j]=add(res.a[i][j],mul(a[i][k],o.a[k][j]));\n        return res;\n    }\n}F,G;\nmatrix quick[4][257];//\u9ad8\u6b21\u5e42\u7684\u9884\u5904\u7406\n\ninline void init(){\n    inv[0]=0;inv[1]=1;\n    for(int i=2;i<=2500;i++)\n        inv[i]=dec(0,mul(inv[mod%i],mod/i));\n}\n\nint main(){\n    scanf(\"%d%d%d\",&n,&m,&q);\n    init();\n    F.x=1;F.y=n;\n    for(re int i=1;i<=n;i++){\n        ++map[i][i];++out[i];\n        scanf(\"%d\",&F.a[1][i]);\n    }\n    for(re int i=1;i<=m;i++){\n        int x,y;\n        scanf(\"%d%d\",&x,&y);\n        ++map[x][y];++out[x];\n    }\n    for(re int i=0;i<4;i++){\n        quick[i][0].x=quick[i][0].y=n;\n        for(re int j=1;j<=n;j++) quick[i][0].a[j][j]=1;\n    }\n    quick[0][1].x=quick[0][1].y=n;\n    for(re int i=1;i<=n;i++)\n        for(re int j=1;j<=n;j++)\n            quick[0][1].a[i][j]=mul(map[i][j],inv[out[i]]);\n    for(re int i=2;i<=256;i++) quick[0][i]=quick[0][i-1]*quick[0][1];\n    quick[1][1]=quick[0][256];\n    for(re int i=2;i<=256;i++) quick[1][i]=quick[1][i-1]*quick[1][1];\n    quick[2][1]=quick[1][256];\n    for(re int i=2;i<=256;i++) quick[2][i]=quick[2][i-1]*quick[2][1];\n    quick[3][1]=quick[2][256];\n    for(re int i=2;i<=256;i++) quick[3][i]=quick[3][i-1]*quick[3][1];\n    while(q--){\n        int x,ans=0;\n        scanf(\"%d\",&x);\n        G=F*quick[0][x&255]*quick[1][(x>>8)&255]*quick[2][(x>>16)&255]*quick[3][(x>>24)&255];\n        for(re int i=1;i<=n;i++) ans^=G.a[1][i];\n        printf(\"%d\\n\",(ans>=mod)?ans-mod:ans);\n    }\n    return 0;\n}\n```\n\n",
        "postTime": 1598365602,
        "uid": 272143,
        "name": "\u662f\u4e2a\u6c49\u5b50",
        "ccfLevel": 4,
        "title": "P5107 \u80fd\u91cf\u91c7\u96c6"
    },
    {
        "content": "\u8fd9\u9053\u9898\u6781\u5ea6\u5361\u5e38\u3002\n\n\u5927\u5bb6\u5e94\u8be5\u80fd\u770b\u51fa\u6765\u8fd9\u662f\u4e00\u4e2a\u77e9\u9635\u5feb\u901f\u5e42\u88f8\u9898\uff0c\u4e0d\u8fc7\u6570\u636e\u8303\u56f4\u6709\u70b9\u3002\u3002\u3002\n\n\u9996\u5148\uff0c\u4f60\u8981\u4f7f\u7528\u4e00\u4e2a\u53eb**\u5149\u901f\u5e42**\u7684\u4e1c\u897f\uff08\u540d\u5b57\u975e\u5e38\u5f62\u8c61\uff09\uff0c\u5c31\u662f\u6bd4\u5feb\u901f\u5e42\u8fd8\u8981\u5feb\u901f\u7684\u4e1c\u897f\u3002\n\n\u5728\u5e95\u6570\u56fa\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5$O(1)$\u8ba1\u7b97$a^b$\u3002\n\n\u5176\u5b9e\u4e5f\u4e0d\u662f\u4ec0\u4e48\u9ad8\u5927\u4e0a\u7684\u4e1c\u897f\uff0c\u5c31\u662f\u5bf9$b$\u7684\u503c\u57df\u8fdb\u884c\u5206\u5757\uff0c\u7136\u540e\u518d\u9884\u5904\u7406\u4e00\u4e9b\u4e1c\u897f\uff0c\u5c31\u53ef\u4ee5\u505a\u51fa\u6765\u4e86\u3002\n$$a^b=a^{b \\mod\\ k}*(a^k)^{\\frac{b}{k}}$$\n\u91cc\u9762\u7684\u9664\u6cd5\u662f\u6574\u9664\u3002\n\n\u5bf9\u524d\u4e00\u9879\u8fdb\u884c\u9884\u5904\u7406\uff0c\u540e\u4e00\u9879\u9012\u5f52\u8ba1\u7b97\uff0c\u5c31\u53ef\u4ee5\u505a\u51fa\u6765\u4e86\u3002\u8fd9\u4e2a\u65b9\u6cd5\u53eb$k$\u8fdb\u5236\u500d\u589e\uff0c\u4e5f\u53ef\u4ee5\u5bf9\u77e9\u9635\u6c42\u5e42\u3002\n\n\u5176\u4e2d$k=256$\u7684\u65f6\u5019\u53c8\u597d\u5199\u53c8\u5feb\u3002\n\n\u800c\u4e14\u8981\u6ce8\u610f\uff0c\u6bcf\u6b21\u662f\u53ef\u4ee5\u6d41\u5411\u81ea\u5df1\u7684\u3002\uff08\u88ab\u9898\u610f\u6740\u7684juruo\u5728\u6b64\uff09\n```cpp\n#include<cstdio>\n#include<cstring>\n#define Rint register int\nusing namespace std;\ntypedef long long LL;\nconst int N = 51, mod = 998244353;\ninline int add(int a, int b){int res = a + b; if(res >= mod) res -= mod; return res;}\ninline int mul(int a, int b){return (LL) a * b - (LL) a * b / mod * mod;}\ninline int dec(int a, int b){int res = a - b; if(res < 0) res += mod; return res;}\nint n, m, q, out[N], map[N][N], inv[N * N];\nstruct Matrix {\n    int a[N][N], r, c;\n    inline Matrix(){memset(a, 0, sizeof a);}\n    inline Matrix operator = (const Matrix &o){\n        memcpy(a, o.a, sizeof a); r = o.r; c = o.c;\n        return *this;\n    }\n    inline Matrix operator * (const Matrix &o) const {\n        Matrix res;\n        res.r = r; res.c = o.c;\n        for(Rint i = 1;i <= r;i ++)\n            for(Rint k = 1;k <= c;k ++)\n                for(Rint j = 1;j <= o.c;j ++)\n                    res.a[i][j] = add(res.a[i][j], mul(a[i][k], o.a[k][j]));\n        return res;\n    }\n} F, A[4][257], G;\ninline void init(){\n    inv[0] = 0; inv[1] = 1;\n    for(Rint i = 2;i <= 2500;i ++)\n        inv[i] = dec(0, mul(inv[mod % i], mod / i));\n}\nint main(){\n    scanf(\"%d%d%d\", &n, &m, &q);\n    init();\n    F.r = 1; F.c = n;\n    for(Rint i = 1;i <= n;i ++){\n        ++ map[i][i]; ++ out[i];\n        scanf(\"%d\", &F.a[1][i]);\n    }\n    for(Rint i = 1;i <= m;i ++){\n        int x, y;\n        scanf(\"%d%d\", &x, &y);\n        ++ map[x][y]; ++ out[x];\n    }\n    for(Rint i = 0;i < 4;i ++){\n        A[i][0].r = A[i][0].c = n;\n        for(Rint j = 1;j <= n;j ++)\n            A[i][0].a[j][j] = 1;\n    }\n    A[0][1].r = A[0][1].c = n;\n    for(Rint i = 1;i <= n;i ++)\n        for(Rint j = 1;j <= n;j ++)\n            A[0][1].a[i][j] = mul(map[i][j], inv[out[i]]);\n    for(Rint i = 2;i <= 256;i ++) A[0][i] = A[0][i - 1] * A[0][1];\n    A[1][1] = A[0][256];\n    for(Rint i = 2;i <= 256;i ++) A[1][i] = A[1][i - 1] * A[1][1];\n    A[2][1] = A[1][256];\n    for(Rint i = 2;i <= 256;i ++) A[2][i] = A[2][i - 1] * A[2][1];\n    A[3][1] = A[2][256];\n    for(Rint i = 2;i <= 256;i ++) A[3][i] = A[3][i - 1] * A[3][1];\n    while(q --){\n        int x, ans = 0;\n        scanf(\"%d\", &x);\n        G = F * A[0][x & 255] * A[1][(x >> 8) & 255] * A[2][(x >> 16) & 255] * A[3][(x >> 24) & 255];\n        for(Rint i = 1;i <= n;i ++) ans ^= G.a[1][i];\n        printf(\"%d\\n\", (ans >= mod) ? ans - mod : ans);\n    }\n}\n```",
        "postTime": 1553666708,
        "uid": 68148,
        "name": "watermoon",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5107 \u3010\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "\u663e\u7136\u662f\u4e2a\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u6784\u9020$n\\times n$\u7684\u77e9\u9635\u3002\n\n\u6709\u591a\u7ec4\u8be2\u95ee\uff0c\u5982\u679c\u6bcf\u6b21\u5feb\u901f\u5e42\u4e00\u904d\uff0c\u5219\u65f6\u95f4\u590d\u6742\u5ea6$O(qn^3\\log t)$\uff0c\u8fc7\u4e0d\u4e86\u3002\n\n\u53ef\u4ee5\u8003\u8651\u8bb0\u5f55\u77e9\u9635\u7684$2^k$\u6b21\u5e42\uff0c\u7136\u540e\u4e8c\u8fdb\u5236\u62c6\u5206\u4e58\u3002\u7531\u4e8e\u72b6\u6001\u77e9\u9635\u4e3a$1\\times n$\u7684\uff0c\u5176\u505a\u77e9\u9635\u4e58\u6cd5\u4e00\u6b21\u590d\u6742\u5ea6\u4e3a$O(n^2)$\uff0c\u6240\u4ee5\u53ef\u4ee5\u505a\u5230$O(n^3\\log t+qn^2\\log t)$\u3002\n\n\u770b\u8d77\u6765\u8fd8\u662f\u6709\u4e9b\u5927\uff08\u5b9e\u9645\u4e0a\u53ef\u4ee5\u8fc7\uff09\u3002\n\n\u8003\u8651\u5206\u5757\u6c42\u5e42\uff0c\u53ef\u4ee5\u505a\u5230\u9884\u5904\u7406\u590d\u6742\u5ea6$O(\\sqrt tn^3)$\uff0c\u67e5\u8be2$O(qn^2)$\u3002\n\n\u4f46\u662f\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a$O(qn^2)$\uff0c\u4f1a\u8d85\u8fc7512MB\u7684\u9650\u5236\u3002\n\n\u90a3\u4e48\u6211\u4eec\u8003\u8651\u5206\u62104\u5757\uff0c\u6bcf$\\sqrt[4]t$\u5206\u6210\u4e00\u5757\uff08\u6b64\u5904\u53d6$256$\uff09\uff0c\u7136\u540e\u67e5\u8be2\u4e5f\u52064\u5757\u8be2\u95ee\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(4\\sqrt[4]tn^3+4qn^2)$\u3002\n\n## Code\uff1a\n```cpp\n#include<cstdio>\n#define md 998244353\n#define STC static_cast<long long>\n#ifndef ONLINE_JUDGE\n#define __int128 long long\n#endif\n#define reg register\nstruct matrix{\n\tint a[50][50];\n\tint r,c;\n\tmatrix operator*(const matrix&b)const{\n\t\tmatrix c;\n\t\tc.r=r,c.c=b.c;\n\t\tfor(int i=0;i<r;++i)\n\t\tfor(reg int j=0;j<b.c;++j){\n\t\t\treg __int128 tmp=0;\n\t\t\tfor(reg int k=0;k<b.r;++k)\n\t\t\ttmp+=STC(a[i][k])*b.a[k][j];\n\t\t\tc.a[i][j]=tmp%md;\n\t\t}\n\t\treturn c;\n\t}\n}_1[257],_2[257],_3[257],_4[257],a;\nint deg[50],inv[2501],n,m,T;\nvoid init(){\n\tinv[1]=1;\n\tfor(int i=2;i<2500;++i)inv[i]=STC(md-md/i)*inv[md%i]%md;\n\tfor(int i=0;i<n;++i)\n\tscanf(\"%d\",&a.a[0][i]),_1->a[i][i]=deg[i]=1;\n\ta.r=1,a.c=_1->r=_1->c=n;\n\t_1[1]=*_1;\n\twhile(m--){\n\t\tint x,y;\n\t\tscanf(\"%d%d\",&x,&y);\n\t\t++_1[1].a[--x][y-1];\n\t\t++deg[x];\n\t}\n\tfor(int i=0;i<n;++i)\n\tfor(int j=0;j<n;++j)\n\t_1[1].a[i][j]=STC(_1[1].a[i][j])*inv[deg[i]]%md;\n\tfor(int i=2;i<257;++i)_1[i]=_1[i-1]*_1[1];\n\t*_2=*_1,_2[1]=_1[256];\n\tfor(int i=2;i<257;++i)_2[i]=_2[i-1]*_2[1];\n\t*_3=*_2,_3[1]=_2[256];\n\tfor(int i=2;i<257;++i)_3[i]=_3[i-1]*_3[1];\n\t*_4=*_3,_4[1]=_3[256];\n\tfor(int i=2;i<257;++i)_4[i]=_4[i-1]*_4[1];\n}\nint main(){\n\tscanf(\"%d%d%d\",&n,&m,&T);\n\tinit();\n\twhile(T--){\n\t\tscanf(\"%d\",&m);\n\t\tmatrix x=a*_1[m&255]*_2[m>>8&255]*_3[m>>16&255]*_4[m>>24&255];\n\t\tint y=0;\n\t\tfor(int i=0;i<n;++i)y^=x.a[0][i];\n\t\tprintf(\"%d\\n\",y>=md?y-md:y);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1545906460,
        "uid": 6813,
        "name": "mrsrz",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5107 \u3010\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "# \u66b4\u529b\n\n\u8bbe$f[i][u]=$ \u7b2c$i$\u79d2$u$\u53f7\u70b9\u7684\u80fd\u91cf\uff0c\u5219\n\n$f[i][u]=\\sum{map[v][u]*inv(d[v])}$\n\n\u5176\u4e2d$map[i][j]$\u662f$i$\u53f7\u70b9\u548c$j$\u53f7\u70b9\u4e4b\u95f4\u8fb9\u6570\uff0c$d[i]$\u662f$i$\u53f7\u70b9\u7684\u5ea6\u6570\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(qn^2t)$\n\n\u53ef\u4ee5\u5f97\u5230$30$\u5206\u3002\n\n# \u77e9\u9635\u5feb\u901f\u5e42\n\n\u56e0\u4e3a\u6bcf\u8f6e\u8f6c\u79fb\u7684\u7cfb\u6570\u90fd\u662f\u56fa\u5b9a\u7684\uff0c\u6240\u4ee5\u663e\u7136\u53ef\u4ee5\u77e9\u9635\u4e58\u6cd5\u4f18\u5316\u3002\n\n\u628a$map[i][j]*inv(d[i])$\u5b58\u5165$n*n$\u7684\u8f6c\u79fb\u77e9\u9635\u4e2d\uff0c\u7136\u540e\u7528$1*n$\u7684\u521d\u59cb\u80fd\u91cf\u7684\u77e9\u9635\u4e58\u8f6c\u79fb\u77e9\u9635\u7684$t$\u6b21\u5e42\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(qn^3logt)$\n\n\u7ed3\u5408\u66b4\u529b\u53ef\u4ee5\u5f97\u5230$60$\u5206\u3002\n\n# \u9884\u5904\u7406\n\n\u6ce8\u610f\u5230\u4e24\u4e2a$n*n$\u7684\u77e9\u9635\u7684\u76f8\u4e58\u590d\u6742\u5ea6\u662f$O(n^3)$\u7684\uff0c\u4f46\u662f\u4e00\u4e2a$1*n$\u7684\u77e9\u9635\u548c\u4e00\u4e2a$n*n$\u7684\u77e9\u9635\u76f8\u4e58\uff0c\u590d\u6742\u5ea6\u5c31\u662f$O(n^2)$\u7684\u3002\n\n\u56e0\u6b64\uff0c\u53ef\u4ee5\u4e0d\u5728\u6bcf\u6b21\u8be2\u95ee\u7684\u65f6\u5019\u90fd\u628a$t$\u6b21\u5e42\u73b0\u7528\u5feb\u901f\u5e42\u7b97\u4e00\u6b21\uff0c\u800c\u662f\u5728\u5904\u7406\u6240\u6709\u8be2\u95ee\u4e4b\u524d\uff0c\u5148\u628a\u77e9\u9635\u7684$2^1$\u3001$2^2$\u3001$2^3$\u3001\u2026\u2026\u3001$2^{30}$\u6b21\u5e42\u9884\u5904\u7406\u51fa\u6765\uff0c\u8be2\u95ee\u65f6\u628a$t$\u62c6\u6210\u4e8c\u8fdb\u5236\uff0c\u5982\u679c\u5bf9\u5e94\u7684\u4f4d\u6570\u662f$1$\u5c31\u4e58\u5bf9\u5e94\u5e42\u6b21\u7684\u77e9\u9635\u3002\n\n\u8fd9\u6837\u590d\u6742\u5ea6\u5c31\u662f$O(n^3logt+qn^2logt)$\u4e86\u3002\n\n\u5982\u679c\u4f60\u7684\u77e9\u9635\u4e58\u6cd5\u662f\u8fb9\u4e58\u8fb9\u53d6\u6a21\u7684\uff0c\u606d\u559c\u4f60\u83b7\u5f97$80$\u5206\u7684\u597d\u6210\u7ee9\uff01\n\n\u5982\u679c\u4f60\u7684\u77e9\u9635\u4e58\u6cd5\u8fd9\u4e48\u5199\uff0c\u53ef\u4ee5\u51cf\u5c11\u5927\u91cf\u7684\u53d6\u6a21\u6b21\u6570\u3002\n\n```cpp\nstruct mat{\n\tint n,m;\n\tll a[N][N];\n\tmat operator*(const mat& p)const{\n\t\tmat res;\n\t\tres.n=n,res.m=p.m;\n\t\tfor(rint i=1;i<=n;++i)\n\t\t\tfor(rint j=1;j<=p.m;++j){\n\t\t\t\t__int128 sum=0;\n\t\t\t\tfor(rint k=1;k<=m;++k)\n\t\t\t\t\tsum+=a[i][k]*p.a[k][j];\n\t\t\t\tres.a[i][j]=sum%mod;\n\t\t\t}\n\t\treturn res;\n\t}\n}A[32],ans;\n```\n\n\u5c31\u53ef\u4ee5\u8fc7\u4e86\u3002\u800c\u4e14\u6700\u6162\u7684\u70b9\u4e5f\u5c31\u4e0d\u5230$3s$\u3002\n\n\u8fd9\u9898\u5f88\u591a\u5957\u8def\u90fd\u548cP4007\u5f88\u50cf\u3002\u505a\u5b8c\u90a3\u9053\u9898\u518d\u6765\u505a\u5c31\u4f1a\u611f\u89c9\u8fd9\u4e2a\u9898\u5f88\u7b80\u5355\u3002\n\n# \u4ee3\u7801\n\n```cpp\n\n#include<bits/stdc++.h>\n#define rint register int\nusing namespace std;\ntypedef long long ll;\ninline int read(){\n\tregister int res=0;\n\tregister char c=getchar();\n\twhile(c<48||c>57)c=getchar();\n\twhile(c>=48&&c<=57)res=(res<<3)+(res<<1)+(c&15),c=getchar();\n\treturn res;\n}\n\nconst int N=55,mod=998244353;\ninline ll qpow(ll x,ll y){\n\tll res=1;\n\tfor(;y;y>>=1){\n\t\tif(y&1)res=res*x%mod;\n\t\tx=x*x%mod;\n\t}return res;\n}\ninline ll inv(ll x){\n\treturn qpow(x,mod-2);\n}\nstruct mat{\n\tint n,m;\n\tll a[N][N];\n\tmat operator*(const mat& p)const{\n\t\tmat res;\n\t\tres.n=n,res.m=p.m;\n\t\tfor(rint i=1;i<=n;++i)\n\t\t\tfor(rint j=1;j<=p.m;++j){\n\t\t\t\t__int128 sum=0;\n\t\t\t\tfor(rint k=1;k<=m;++k)\n\t\t\t\t\tsum+=a[i][k]*p.a[k][j];\n\t\t\t\tres.a[i][j]=sum%mod;\n\t\t\t}\n\t\treturn res;\n\t}\n}A[32],ans;\n\nint n,m,q,x,y,d[N];\nint mp[N][N];\nll a[N],res,t;\n\nint main(){\n\tn=read(),m=read(),q=read();\n\tfor(int i=1;i<=n;++i)\n\t\ta[i]=read(),++d[i],mp[i][i]=1;\n\tfor(int i=1;i<=m;++i){\n\t\tx=read(),y=read();\n\t\t++d[x],++mp[x][y];\n\t}\n\tfor(int i=1;i<=n;++i)\n\t\tfor(int j=1;j<=n;++j)\n\t\t\tA[0].a[i][j]=mp[i][j]*inv(d[i])%mod;\n\tA[0].n=A[0].m=n;\n\tans.n=1,ans.m=n;\n\tfor(int i=1;i<=30;++i)\n\t\tA[i]=A[i-1]*A[i-1];\n\t\n\twhile(q--){\n\t\tt=read();\n\t\tmemset(ans.a,0,sizeof(ans.a));\n\t\tfor(int i=1;i<=n;++i)ans.a[1][i]=a[i];\n\t\tfor(int i=0;i<=30;++i)\n\t\t\tif((t>>i)&1)ans=ans*A[i];\n\t\tres=0;\n\t\tfor(int i=1;i<=n;++i)\n\t\t\tres^=ans.a[1][i];\n\t\tprintf(\"%lld\\n\",res%mod);\n\t}return 0;\n}\n```",
        "postTime": 1544965645,
        "uid": 49260,
        "name": "fr200110217102",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5107 \u3010\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "\u8868\u793a\u8fd9\u9053\u9898\u6734\u7d20\u505a\u6cd5 + \u4e00\u5806\u4f18\u5316\u80fd A \uff0c\u4e4b\u524d\u9898\u89e3\u597d\u50cf\u6ca1\u600e\u4e48\u5199\u8fc7\u8fd9\u4e9b\u4f18\u5316\u7684\uff08\u90fd\u662f\u5728\u53e3\u80e1\uff1f\uff09\uff0c\u4e8e\u662f\u8865\u4e0a\u4e00\u7bc7\n\n# noteskey\n\n\u9996\u5148\u5c31\u662f\u5f97\u77e5\u9053\u8fd9\u9053\u9898\u7684\u6734\u7d20\u505a\u6cd5\uff1a\n\n\u4e00\u770b\u5230\u8fd9\u6570\u636e\u8303\u56f4\u5c31\u611f\u89c9\u53ef\u4ee5\u7528\u77e9\u9635\u52a0\u901f dp \u8f6c\u79fb\uff08\u597d\u50cf\u4e5f\u4e0d\u662f dp\uff1f \uff09\n\n\u7136\u540e\u6211\u4eec\u5c31\u6784\u9020\u77e9\u9635\uff0c\u6bcf\u4e2a\u70b9\u5b58\u4e00\u4e0b\u51fa\u5ea6\uff0c\u7136\u540e i \u8f6c\u5411\u7684\u6bcf\u4e2a\u70b9\u8fb9\u6570\u4e58\u4e0a du[i] \u7684\u9006\u5143\uff0c\u8fd9\u6837\u5c31\u80fd\u6784\u9020\u51fa\u8f6c\u79fb\u77e9\u9635 F[0] \u4e86\n \n \u7136\u540e\u6211\u4eec\u500d\u589e\u6c42\u51fa F[0~30] \uff0c\u8be2\u95ee\u7684\u65f6\u5019\u4e5f\u662f\u500d\u589e\u67e5\u8be2\u5c31\u597d\u4e86\n \n\n\u4f46\u662f\u8fd9\u4e2a\u590d\u6742\u5ea6...\u663e\u7136\u5d29\u6389\u4e86\u5427\uff1f\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u65f6\u95f4\u57fa\u672c\u90fd\u5728\u67e5\u8be2\u90a3\u5757\u4e22\u6389\u7684\uff0c\u4e8e\u662f\u4e4e\u6211\u4eec\u6709\u4e24\u79cd\u8def\u53ef\u8d70\uff0c\u4e00\u79cd\u5c31\u662f\u8001\u8001\u5b9e\u5b9e\u589e\u52a0\u9884\u5904\u7406\u590d\u6742\u5ea6\u4ee5\u5747\u8861\u8be2\u95ee\u590d\u6742\u5ea6\uff0c\u4e5f\u5c31\u662f\u7528 k \u8fdb\u5236\u4f18\u5316\u8fd9\u4e2a\u7b97\u6cd5\uff1b\u53e6\u5916\u4e00\u79cd\u5c31\u662f\u53bb\u4f18\u5316\u5e38\u6570\uff08\u5361\u5e38\uff01\uff09\u4e86...\n\n\n\u4e8e\u662f\u6211\u4eec\u8003\u8651\uff1a\n\n> -1. \u5feb\u8bfb\u3001\u5feb\u8f93\u52a0\u4e0a\u53bb\n\n> 0. \u5404\u79cd register \u3001 static \u3001 inline ...\n\n> 1. \u77e9\u4e58\u7684\u65f6\u5019\u8bb0\u5f55\u4e24\u4e2a\u77e9\u9635\u7684\u884c\u6570\u3001\u5217\u6570\uff0c\u8fd9\u6837\u67e5\u8be2\u7684\u65f6\u5019\u7684\u77e9\u4e58\u590d\u6742\u5ea6\u5c31\u53d8\u6210\u4e86 $n^2$ \uff01\n\n> 2. \u6240\u6709\u7684\u8be2\u95ee\u8bfb\u8fdb\u6765\uff0c\u6392\u4e2a\u5e8f\uff0c\u7136\u540e\u4ece\u5c0f\u5230\u5927\u5904\u7406\u6240\u6709\u8be2\u95ee\u7684\u7b54\u6848\n\n> 3. \u5faa\u73af\u5c55\u5f00\u4f18\u5316...\u4e00\u822c\u6765\u8bb2\u5c31\u662f 4 \u5c42\u4e86 QVQ \uff0c\u6548\u679c\u597d\u50cf\u633a\u660e\u663e\u7684...\n\n> 4. \u5b9e\u5728\u4e0d\u884c\uff0c\u8bd5\u8bd5\u8bc4\u6d4b\u673a\u6ce2\u52a8\u5361\u5e38\n\n> 5. \u8fd8\u662fTLE\uff0c\u7b2c\u56db\u6b65\u57fa\u7840\u4e0a\u6d17\u628a\u8138\u53ef\u80fd\u5c31 A \u4e86 XD\n\n# code\n\n\u7136\u9e45\u8fd9\u4e2a\u4ee3\u7801\u8dd1\u5f97\u5de8\u6162\uff0c\u52c9\u5f3a\u5361\u8fc7...\n\n```\n//by Judge\n#pragma GCC optimize(\"Ofast\")\n#include<bits/stdc++.h>\n#define Rg register\n#define fp(i,a,b) for(Rg int i=(a),I=(b)+1;i<I;++i)\n#define ll unsigned int\nusing namespace std;\nconst int mod=998244353;\nconst int M=51;\n#ifndef Judge\n#define getchar() (p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\n#endif\nchar buf[1<<21],*p1=buf,*p2=buf;\ninline int mul(int x,int y){return 1ll*x*y%mod;}\ninline int inc(int x,int y){return x+y>=mod?x+y-mod:x+y;}\ninline int read(){ int x=0,f=1; char c=getchar();\n\tfor(;!isdigit(c);c=getchar()) if(c=='-') f=-1;\n\tfor(;isdigit(c);c=getchar()) x=x*10+c-'0'; return x*f;\n} char sr[1<<21],z[20];int CCF=-1,Z;\ninline void Ot(){fwrite(sr,1,CCF+1,stdout),CCF=-1;}\ninline void print(ll x,char chr='\\n'){\n    if(CCF>1<<20)Ot(); while(z[++Z]=x%10+48,x/=10);\n    while(sr[++CCF]=z[Z],--Z);sr[++CCF]=chr;\n} static int n,m,Q,du[M],ans[50003];\nstruct que{ int t,id; }q[50003];\nbool cmp(que& a,que& b){return a.t<b.t;}\ninline int qpow(Rg int x,Rg int p=mod-2,Rg int s=1){\n\tfor(;p;p>>=1,x=mul(x,x)) if(p&1) s=mul(s,x); return s;\n}\nstruct Matrix{ int n,m,a[M][M]; Matrix(){memset(a,0,sizeof a);}\n\tint* operator [](const int& x){return a[x];}\n\tMatrix operator *(Matrix& b)const{ Matrix c; c.n=n,c.m=b.m;\n\t\tfp(i,1,n) fp(k,1,b.n) fp(j,1,b.m) c[i][j]=inc(c[i][j],1ll*a[i][k]*b[k][j]%mod); return c;\n\t}\n}A,S,F[35];\nint main(){ n=read(),m=read(),Q=read();\n\tF[0].n=F[0].m=A.m=n,A.n=1; int x,y;\n\tfp(i,1,n) A[1][i]=read(),du[i]=F[0][i][i]=1;\n\tfp(i,1,m) x=read(),y=read(),++F[0][x][y],++du[x];\n\tfp(i,1,n) du[i]=qpow(du[i]);\n\tfp(i,1,n) fp(j,1,n) F[0][i][j]=mul(F[0][i][j],du[i]);\n\tfp(i,1,30) F[i]=F[i-1]*F[i-1];\n\tfp(i,1,Q) q[i].t=read(),q[i].id=i;\n    sort(q+1,q+1+Q,cmp),S=A;\n    fp(j,1,Q){ Rg int t=q[j].t-q[j-1].t;\n        Rg int i; for(i=0;i<=27;i+=4){\n            if((t>>i)&1) S=S*F[i];\n            if((t>>i+1)&1) S=S*F[i+1];\n            if((t>>i+2)&1) S=S*F[i+2];\n            if((t>>i+3)&1) S=S*F[i+3];\n        }\n        for(;i<=30;++i) if((t>>i)&1) S=S*F[i];\n        fp(i,1,n) ans[q[j].id]^=S[1][i];\n    }\n    fp(i,1,Q) print(ans[i]%mod); return Ot(),0;\n}\n```\n\n\u52a0\u4e86\u8fd9\u4e48\u591a\u4f18\u5316\u6211\u624d\u8fc7...\u679c\u7136\u662f\u4eba\u50bb\u5e38\u89c4\u6570\u5927\u5462~\n\n\n\n",
        "postTime": 1555326707,
        "uid": 38576,
        "name": "J\u03bcdge",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5107 \u3010\u80fd\u91cf\u91c7\u96c6\u3011"
    }
]
[
    {
        "content": "Upd on 2022.4.3 \u4fee\u6539\u9519\u8bef\u3002\n\n> [*P3447 [POI2006]KRY-Crystals*](https://www.luogu.com.cn/problem/P3447)\n>\n> [*POI \u5408\u96c6*](https://www.cnblogs.com/alex-wei/p/POI.html)\u3002\n\n\u8bfb\u5b8c\u9898\u76ee\uff0c\u7eb7\u7e41\u590d\u6742\u7684\u9650\u5236\u8ba9\u6211\u4eec\u65e0\u4ece\u4e0b\u624b\u3002\u4ece\u54ea\u4e2a\u6761\u4ef6\u4f5c\u4e3a\u7a81\u7834\u53e3\u5462\uff1f\u80af\u5b9a\u662f\u6700\u4e25\u683c\u7684\u5f02\u6216\u9650\u5236\u3002\n\n\u5f02\u6216\u6709\u6027\u8d28 $a \\oplus b = c\\Rightarrow b = a\\oplus c$\u3002\u5bf9\u5e94\u5230\u9898\u76ee\u4e2d\uff0c\u5c31\u662f\u82e5\u5e8f\u5217 $a$ \u6709 $n - 1$ \u4e2a\u6570\u786e\u5b9a\uff0c\u5219\u672a\u5b9a\u6570\u53ea\u80fd\u7b49\u4e8e\u6240\u6709\u786e\u5b9a\u6570\u7684\u5f02\u6216\u548c\u3002\u8fd9\u542f\u53d1\u6211\u4eec\u601d\u8003\uff0c\u6709\u6ca1\u6709\u4e00\u79cd\u53ef\u80fd\uff0c\u672a\u5b9a\u6570\u5bf9\u5e94\u7684\u9650\u5236 $m_i$ \u975e\u5e38\u5927\uff0c\u4ee5\u81f3\u4e8e\u65e0\u8bba $n - 1$ \u4e2a\u6570\u600e\u4e48\u9009\uff0c\u5b83\u4eec\u7684\u5f02\u6216\u548c\u603b\u4e0d\u5927\u4e8e $m_i$\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u7528\u4e58\u6cd5\u539f\u7406\u6c42\u51fa\u7b54\u6848\u3002\n\n\u5b9e\u9645\u4e0a\u6709\u53ef\u80fd\uff01\u8003\u8651\u7b2c $i$ \u4f4d\uff0c\u5047\u8bbe\u5b58\u5728 $p$ \u4f7f\u5f97 $m_p$ \u8fd9\u4e00\u4f4d\u4e3a $1$\uff0c\u4f46 $a_p$ \u4e3a $0$\uff0c\u8bf4\u660e\u82e5\u6240\u6709\u6570\u5b57\u5728\u7b2c $i$ \u4f4d\u53ca\u5176\u9ad8\u4f4d\u5f02\u6216\u548c\u4e3a $0$\uff0c\u90a3\u4e48\u65e0\u8bba\u5176\u5b83\u6570\u5b57\u4f4e $i - 1$ \u4f4d\u600e\u4e48\u586b\u90fd\u7b26\u5408\u6761\u4ef6\uff0c\u56e0\u4e3a $a_p$ \u5728\u7b2c $i$ \u4f4d\u5c0f\u4e8e $m_p$\uff0c\u6240\u4ee5\u63a5\u4e0b\u6765\u7684\u4f4e $i - 1$ \u4f4d\u6ca1\u6709\u9650\u5236\u3002\n\n\u8fd9\u542f\u53d1\u6211\u4eec\u76f4\u63a5\u679a\u4e3e\u6240\u6709 $a_p$ \u4e0e $m_p$ \u7684\u6700\u77ed LCP\uff0c\u5373 \u5b58\u5728 $p$ \u4f7f\u5f97 $m_p$ \u5728\u7b2c $i$ \u4f4d\u4e3a $1$ \u4f46 $a_p$ \u4e3a $0$\uff0c\u4e14 $a$ \u9ad8\u4e8e\u7b2c $i$ \u4f4d\u7684\u90e8\u5206\u4e0e $m$ \u76f8\u540c \u7684\u4f4d\u6570 $i$\u3002\u8fd9\u6837\uff0c\u6211\u4eec\u53ea\u9700\u628a\u4efb\u610f\u4e00\u4e2a $p$ \u7684\u7cfb\u6570\u53d8\u4e3a $1$\uff08\u56e0\u4e3a\u5b83\u4f9d\u8d56\u4e8e\u5269\u4f59\u6570\u7684\u5f02\u6216\u548c\uff09\uff0c\u5269\u4e0b\u7684\u7cfb\u6570\u7528\u4e58\u6cd5\u539f\u7406\u4e58\u8d77\u6765\u5373\u53ef\u3002\n\n\u5177\u4f53\u5730\uff0c\u8003\u8651\u6211\u4eec\u5173\u5fc3\u4ec0\u4e48\uff1a\u7b2c $i$ \u4f4d\u5f02\u6216\u548c\u4e3a $0$ \u4e14\u5b58\u5728 $p$\u3002\u8fd9\u542f\u53d1\u6211\u4eec\u8bbe\u8ba1 DP $f_{j, k, l}$ \u8868\u793a\u8003\u8651\u5230\u7b2c $j$ \u4e2a\u6570\uff0c\u7b2c $i$ \u4f4d\u5f02\u6216\u548c\u4e3a $k$ \u4e14\u662f\u5426\u5b58\u5728 $p$\u3002\u6839\u636e\u4e58\u6cd5\u539f\u7406\u4e0e\u5b9e\u9645\u610f\u4e49\u8f6c\u79fb\uff1a\n\n\u82e5 $m_j$ \u7b2c $i$ \u4f4d\u4e3a $1$\uff0c\u90a3\u4e48 $a_j$ \u53ef\u4ee5\u9009\u62e9 $0 / 1$\uff1a\u9009 $0$ \u7684\u65b9\u6848\u6570\u4e3a $2^i$\uff0c\u9009 $1$ \u7684\u65b9\u6848\u6570\u4e3a $m_j$ \u5728\u4f4e $2 ^ {i - 1}$ \u4f4d\u7684\u503c\u52a0\u4e0a $1$\uff0c\u8bb0\u4f5c $c_i$\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f $(m_j \\& (2 ^ i - 1)) + 1$\u3002\u4ece $l = 0$ \u8f6c\u79fb\u5230 $l = 1$ \u65f6\uff0c\u7cfb\u6570\u4e3a $1$\uff0c\u8868\u793a\u94a6\u5b9a $j$ \u7684\u7cfb\u6570\u4e3a $1$\u3002\n$$\n\\begin{aligned}\n& f_{j, 0, 0} = f_{j - 1, 1, 0}\\times c_j \\\\\n& f_{j, 1, 0} = f_{j - 1, 0, 0}\\times c_j \\\\\n& f_{j, 0, 1} = f_{j - 1, 1, 1}\\times c_j + f_{j - 1, 0, 1}\\times 2 ^ i + f_{j - 1, 0, 0} \\\\\n& f_{j, 1, 1} = f_{j - 1, 0, 1}\\times c_j + f_{j - 1, 1, 1}\\times 2 ^ i + f_{j - 1, 1, 0}\n\\end{aligned}\n$$\n\u82e5 $m_j$ \u7b2c $i$ \u4f4d\u4e3a $0$\uff0c\u5219\u53ea\u80fd\u9009 $0$ \u4e14\u65b9\u6848\u6570\u4e3a $c_j$\u3002\n$$\nf_{j, k, l} = f_{j - 1, k, l}\\times c_j\n$$\n\u6700\u540e\uff0c\u82e5 $m$ \u6bd4 $i$ \u9ad8\u7684\u4f4d\u7684\u5f02\u6216\u548c\u4e3a $0$ \u624d\u80fd\u8ba1\u7b97\u5f53\u524d\u4f4d\u8d21\u732e $f_{n, 0, 1}$\uff0c\u56e0\u4e3a\u94a6\u5b9a\u4e86\u9ad8\u4f4d $a$ \u90fd\u53d6 $m$\u3002\u6ce8\u610f\u5168\u96f6\u5e8f\u5217\u4f1a\u88ab\u7edf\u8ba1\u5230\uff0c\u56e0\u6b64\u6700\u540e\u7b54\u6848\u51cf $1$\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u4f18\u79c0\u7684 $\\mathcal{O}(n\\log m)$\u3002\n\n\u603b\u7ed3\u4e00\u4e0b\uff0c\u5bf9\u4e8e\u4f4d\u8fd0\u7b97\u76f8\u5173 **\u6709\u9650\u5236** \u7684\u8ba1\u6570\u9898\uff0c\u9996\u5148\u8003\u8651 **\u6700\u4e25\u683c** \u7684\u9650\u5236\uff0c\u5e76\u5c3d\u91cf **\u72ec\u7acb\u6bcf\u4e00\u4f4d**\uff0c\u5982\u679c\u505a\u4e0d\u5230\u5c31\u6309\u987a\u5e8f\u8003\u8651\u6bcf\u4e00\u4f4d\u7684\u9650\u5236\u3002\u9009\u62e9\u672c\u9898\u7684\u539f\u56e0\u662f\u5e0c\u671b\u5404\u4f4d\u540c\u5b66\u80fd\u591f\u611f\u53d7\u5230\u8fd9\u79cd\u6309\u4f4d\u679a\u4e3e\u4ec0\u4e48\u4e1c\u897f\u7136\u540e\u518d DP \u7684\u5957\u8def\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N = 50 + 5;\nunsigned long long n, ans, xs, m[N], f[2][2][2];\nint main() {\n\tcin >> n;\n\tfor(int i = 1; i <= n; i++) scanf(\"%llu\", &m[i]), xs ^= m[i];\n\tans = !xs, xs = 0;\n\tfor(int i = 31; i >= 0; i--) {\n\t\tmemset(f, 0, sizeof(f)), f[0][0][0] = 1;\n\t\tfor(int j = 1, p = 0, q = 1; j <= n; j++, swap(p, q)) {\n\t\t\tunsigned long long coef = (m[j] & ((1 << i) - 1)) + 1;\n\t\t\txs ^= m[j] >> i + 1;\n\t\t\tfor(int c : {0, 1}) for(int d : {0, 1}) f[q][c ^ m[j] >> i & 1][d] = f[p][c][d] * coef;\n\t\t\tif(m[j] >> i & 1) for(int c : {0, 1}) f[q][c][1] += (f[p][c][1] << i) + f[p][c][0];\n\t\t}\n\t\tif(!xs) ans += f[n & 1][0][1];\n\t\telse break;\n\t}\n\tcout << ans - 1 << endl;\n\treturn 0;\n}\n```",
        "postTime": 1639413841,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "P3447 [POI2006]KRY-Crystals"
    },
    {
        "content": "\u9996\u5148\u6709\u4e00\u79cd\u66b4\u529b\u65b9\u6cd5\uff0c\u5c31\u662f\u4f4d\u6570\u4ece\u9ad8\u5230\u4f4e\u76f4\u63a5\u6570\u4f4d dp\uff0c\u8bb0\u5f55\u5f53\u524d\u6bcf\u4e00\u4e2a\u6570\u7684\u4e0a\u9650\u662f\u5426\u53d6\u6ee1\u4e86\uff0c\u4f46\u8fd9\u6837\u590d\u6742\u5ea6\u663e\u7136\u662f\u7206\u70b8\u7684\u3002\u6211\u4eec\u8003\u8651\u6709\u6ca1\u6709\u4ec0\u4e48\u6027\u8d28\u53ef\u4ee5\u4f18\u5316\u8fd9\u4e2a\u8fc7\u7a0b\u3002\r\n\r\n\u5f02\u6216\u6709\u4e00\u4e2a\u5f88\u4f18\u79c0\u7684\u6027\u8d28\uff1b$a\\oplus b \\oplus c=0$\uff0c\u90a3\u4e48 $a\\oplus b=c$\uff0c\u6240\u4ee5\u6211\u4eec\u53d1\u73b0\uff0c\u53ea\u8981\u786e\u5b9a\u4e86\u524d $n-1$ \u4e2a\u6570\uff0c\u7b2c $n$ \u4e2a\u6570\u4e5f\u5c31\u786e\u5b9a\u4e86\uff0c\u53ea\u8981\u8003\u8651\u662f\u5426\u5728\u8303\u56f4\u5185\u5373\u53ef\u3002\r\n\r\n\u7136\u540e\u5c31\u5bb9\u6613\u591a\u4e86\uff0c\u9996\u5148\u4e0d\u96be\u53d1\u73b0\u5982\u679c $a_n=2^{32}-1$ \u7684\u8bdd\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u4e3a $\\prod\\limits_{i=1}^n(a_i+1)-1$\uff0c\u8fd9\u8fd8\u662f\u5728\u5f15\u5bfc\u4f60\u4ece\u9ad8\u4f4d\u5230\u4f4e\u4f4d\u8003\u8651\uff1a\u5982\u679c\u4f60\u5728\u4e00\u4e2a\u9ad8\u4f4d\u6ca1\u53d6\u6ee1\uff0c\u5728\u4f4e\u4f4d\u5c31\u53ef\u4ee5\u4efb\u610f\u53d6\u3002\r\n\r\n\u4e8e\u662f\u987a\u7740\u8fd9\u4e2a\u601d\u8def\u4ece\u9ad8\u4f4d\u8003\u8651\uff0c\u5f53\u524d\u5728\u7b2c $j$ \u4f4d\uff08\u6700\u4f4e\u4f4d\u7b97 $0$\uff09\uff0c\u8bbe\u6709 $k$ \u4e2a\u6570\u5728\u5f53\u524d\u4f4d\u662f $1$\uff0c\u90a3\u4e48\u5982\u679c\u4f60\u6709\u4efb\u610f\u4e00\u4e2a\u5f53\u524d\u4f4d\u4e3a $1$ \u7684\u6570\u6ca1\u53d6 $1$\uff0c\u90a3\u4e48\u4f60\u53ef\u4ee5\u7acb\u5373\u7528\u4e0a\u9762\u7684\u5f0f\u5b50\u7b97\u51fa\u7b54\u6848\uff0c\u5426\u5219\u5c31\u4e00\u5b9a\u662f\u5168\u90e8\u53d6\u4e86 $1$\uff0c\u90a3\u5c31\u628a\u8fd9\u4f4d\u53bb\u6389\uff0c\u6210\u4e3a\u4e86\u4e00\u4e2a $j-1$ \u4f4d\u7684\u5b50\u95ee\u9898\u3002\r\n\r\n\u5047\u5982\u6709 $t$ \u4e2a\u5f53\u524d\u4f4d\u662f $1$\uff0c\u4f46\u662f\u6ca1\u53d6 $1$ \u7684\uff0c\u90a3\u4e48\u8fd9\u4e2a\u96c6\u5408\u91cc\u9762\u6709\u4e00\u4e2a\u9700\u8981\u7528\u5728\u6700\u540e\u88ab\u786e\u5b9a\u7684\u90a3\u4e2a\uff0c\u9664\u4e86\u8fd9\u4e2a\u4e4b\u5916\u7684\u90fd\u53ef\u4ee5\u4efb\u9009\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u53ef\u4ee5 $O(n)$ dp \u89e3\u51b3\u3002\r\n\r\n\u5177\u4f53\u7684\uff0c\u8bbe $dp_{i,0/1}$ \u8868\u793a\u8003\u8651\u5230\u524d $i$ \u4e2a\uff0c\u8fd9\u4e00\u4f4d\u76ee\u524d\u7684\u5f02\u6216\u503c\u662f $0/1$ \u7684\u7b54\u6848\u603b\u548c\uff0c\u8f6c\u79fb\u663e\u7136\u3002\u5f53\u524d\u4f4d\u7684\u7b54\u6848\u5c31\u4e3a $dp_{n,0}$\u3002\r\n\r\n\u4e00\u4e9b\u7ec6\u8282\uff1a\r\n\r\n1. \u5982\u679c\u5f53\u524d\u4f4d\u4e3a $1$ \u7684\u4e2a\u6570\u662f\u5076\u6570\uff08\u7b2c $0$ \u4f4d\u9664\u5916\uff09\uff0c\u90a3\u4e48\u6700\u7ec8\u7684 $dp$ \u503c\u5c31\u9700\u8981\u51cf\u53bb $\\prod\\limits_{i=1}^n((a_i\\mod 2^j)+1)$\uff0c\u56e0\u4e3a\u8fd9\u5305\u542b\u4e86\u5168\u90e8\u9009\u7684\u65b9\u6848\uff0c\u4f46\u662f\u5982\u679c\u5168\u90e8\u9009\u7684\u8bdd\u5b9e\u9645\u4e0a\u5e94\u8be5\u8003\u8651\u5728 $j-1$ \u7684\u5b50\u95ee\u9898\u4e2d\uff0c\u6240\u4ee5\u4e0d\u80fd\u7b97\u3002\r\n2. \u4f60\u5728\u7b97**\u6709 $1$ \u7684\u6700\u9ad8\u4f4d**\u7684\u8d21\u732e\u7684\u65f6\u5019\uff0c\u4f1a\u628a\u5168\u90e8\u662f $0$ \u7684\u65b9\u6848\u7b97\u8fdb\u53bb\uff0c\u56e0\u6b64\u6700\u7ec8 ans \u8981\u51cf $1$\u3002\r\n3. \u5982\u679c\u5f53\u524d\u4f4d\u6709\u5947\u6570\u4e2a $1$\uff0c\u90a3\u4e48\u7edf\u8ba1\u5b8c\u5c31\u76f4\u63a5\u9000\u51fa\u5faa\u73af\uff08\u663e\u7136\uff09\u3002\r\n4. \u7b54\u6848\u4f1a\u7206 ll\uff0c\u5efa\u8bae\u5f00 int128\u3002\r\n\r\n\u590d\u6742\u5ea6 $O(n\\log m)$\u3002\r\n\r\n\u6838\u5fc3\u4ee3\u7801\uff1a\r\n\r\n```\r\nrdn;\r\nupn rd(a[i]);\r\nint ans=0;\r\npu(j,31,0)\r\n{\r\n\tint st=0;\r\n\tup(i,1,n)\r\n\t{\r\n\t\tif(a[i]&(1<<j))++st;\r\n\t}\r\n\tdp[0][0]=1;\r\n\tint ww=1;\r\n\tup(i,1,n)\r\n\t{\r\n\t\tif(a[i]&(1<<j))\r\n\t\t{\r\n\t\t\tdp[i][0]=dp[i-1][1]*(a[i]%(1<<j)+1);\r\n\t\t\tdp[i][1]=dp[i-1][0]*(a[i]%(1<<j)+1);\r\n\t\t\tdp[i][0]+=dp[i-1][0]*(1<<j);\r\n\t\t\tdp[i][1]+=dp[i-1][1]*(1<<j);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tdp[i][0]=dp[i-1][0]*(a[i]%(1<<j)+1);\r\n\t\t\tdp[i][1]=dp[i-1][1]*(a[i]%(1<<j)+1);\r\n\t\t}\r\n\t\tww*=(a[i]%(1<<j)+1);\r\n\t}\r\n\tint vl=0;\r\n\tvl=dp[n][0];\r\n\tif(st%2==0)vl-=ww;\r\n\tif(st%2==0&&j==0)vl+=ww;\r\n\tvl/=(1<<j);\r\n\tns+=vl;\r\n\tif(st&1)\r\n\t{\r\n\t\tbreak;\r\n\t}\r\n}\r\nprint(ans-1);\r\n```",
        "postTime": 1659512117,
        "uid": 121275,
        "name": "Silviac",
        "ccfLevel": 0,
        "title": "\u4f60\u53d6\u4e2a\u6a21\u4f1a\u6b7b\uff0c\u5417\uff0c\uff0c\uff0c"
    },
    {
        "content": "### \u9898\u610f\n\n\u7ed9\u51fa\u5e8f\u5217 $a_{1\\sim n}$\uff0c\u6c42\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u7684\u5e8f\u5217 $b$ \u7684\u4e2a\u6570\uff1a\n\n- $\\forall i$\uff0c$0 \\leq b_i \\leq a_i$\uff1b\n- $b_1\\oplus b_2\\oplus \\ldots\\oplus b_n=0$\u3002\n\n$n \\leq 50$\uff0c$a_i<2^{32}-1$\uff0c\u4fdd\u8bc1\u7b54\u6848\u5c0f\u4e8e $2^{64}$\u3002\n\n### \u9898\u89e3\n\n\u5982\u679c\u524d\u9762 $n-1$ \u4e2a\u6570\u5df2\u7ecf\u586b\u597d\uff0c\u90a3\u4e48\u7b2c $n$ \u4e2a\u6570\u53ea\u6709\u4e00\u79cd\u9009\u62e9\uff0c\u4f46\u5b83\u7684\u4e0a\u9650\u4f1a\u9650\u5236\u5408\u6cd5\u6027\u3002\u5982\u679c $a_n = +\\infty$\uff0c\u5219\u65b9\u6848\u6570\u5c31\u662f $\\prod_{i=1}^{n-1}(a_i+1)$\u3002\n\n\u8fd9\u542f\u793a\u6211\u4eec\u4ece\u9ad8\u4f4d\u5230\u4f4e\u4f4d\u8003\u8651\uff0c\u4e0d\u59a8\u8bbe\u6240\u6709 $a_i$ \u4e2d\u6700\u9ad8\u7684\u4f4d\u4e3a $w$\uff0c$a_i$ \u5305\u542b\u6700\u9ad8\u4f4d\u7684 $i$ \u7684\u96c6\u5408\u4e3a $S$\u3002\u5982\u679c\u5b58\u5728\u4e00\u4e2a\u5305\u542b\u6700\u9ad8\u4f4d\u7684 $a$\uff0c\u5b83\u7684 $b$ \u5728 $w$ \u8fd9\u4e00\u4f4d\u4e0d\u9876\u4e0a\u754c\uff08\u5373\u53d6 $0$\uff09\uff0c\u8fd9\u79cd\u60c5\u51b5\u6211\u4eec\u53ef\u4ee5\u5feb\u901f\u7b97\u51fa\u3002\u5177\u4f53\u800c\u8a00\uff0c\u5982\u679c $S$ \u7684**\u975e\u7a7a**\u5b50\u96c6 $T$ \u5185\u7684 $b_i$ \u6700\u9ad8\u4f4d\u586b\u7684\u662f $0$\uff0c\u4e5f\u5c31\u662f\u975e\u6700\u9ad8\u4f4d\u4e0d\u53d7\u9650\uff0c\u90a3\u4e48\u53ea\u9700\u8981\u4ece $T$ \u96c6\u5408\u4e2d\u4efb\u53d6\u4e00\u4e2a\u653e\u6700\u540e\u300c\u8865\u6f0f\u300d\uff0c\u5176\u5b83\u968f\u4fbf\u53d6\u5373\u53ef\uff0c\u65b9\u6848\u6570\u5c31\u662f\uff1a\n$$\n\\sum_{T\\subseteq S, T \\neq \\varnothing}[|S|-|T| \\text{ is even}](2^w)^{|T|-1}\\prod_{i \\not\\in T}(a_i\\bmod 2^w+1)\n$$\n\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u4e00\u904d DP \u7b80\u5355\u5730 $O(n)$ \u7b97\u51fa\uff0c\u4e0d\u8d58\u8ff0\u3002\u5269\u4e0b\u7684\u60c5\u51b5\u53ea\u6709 $S$ \u5185\u6240\u6709 $b$ \u6700\u9ad8\u4f4d\u90fd\u586b $1$\uff0c\u5224\u65ad\u5408\u6cd5\u6027\u540e\u5c31\u662f\u5c06\u6240\u6709\u6570\u90fd\u53bb\u6389\u6700\u9ad8\u4f4d\u4e4b\u540e\u7684\u5b50\u95ee\u9898\u4e86\u3002\u6545\u6211\u4eec\u505a $O(\\log m)$ \u6b21 DP \u5373\u53ef\u6c42\u51fa\u7b54\u6848\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n \\log m)$\u3002\n\n\u6ce8\u610f DP \u7684\u8fc7\u7a0b\u4e2d\u4f1a\u7206 `ull`\uff0c\u53ef\u80fd\u9700\u8981\u4f7f\u7528 `__int128`\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define FOR(i,a,b) for(int i=a,i##i=b;i<=i##i;++i)\n#define ROF(i,a,b) for(int i=a,i##i=b;i>=i##i;--i)\nusing namespace std;\ntypedef unsigned long long ull;\ntypedef __int128 INT;\nconst int N=57;\null n,a[N],ans,ct;\nINT O,E,y,v,t;\n#define G (a[i]+1)\nsigned main(){\n\tcin>>n;\n\tFOR(i,1,n)cin>>a[i];\n\tROF(w,31,0){\n\t\tE=y=1,v=1ull<<w,ct=O=0;\n\t\tFOR(i,1,n){\n\t\t\tif(a[i]&v)a[i]-=v,t=O,O=v*O+G*E,E=v*E+G*t,ct^=1;\n\t\t\telse O*=G,E*=G;\n\t\t\ty*=G,t=O;\n\t\t}\n\t\tct&1?O-=y:E-=y,ans+=E/v;\n\t\tif(ct&1)cout<<ans-1,exit(0);\n\t}\n\tcout<<ans;\n\treturn 0;\n}\n```\n\n",
        "postTime": 1652443036,
        "uid": 78372,
        "name": "M4_SOPMODII_JR",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3447 [POI2006]KRY-Crystals"
    },
    {
        "content": "\u4e3a\u52a0\u6df1\u5f71\u54cd\u5199\u7684\u9898\u89e3\uff0c\u5927\u4f6c\u770b\u4e0d\u60ef\u6b22\u8fce\u6765\u55b7\uff01\n\n> \u505a\u6cd5:\u627e\u6027\u8d28\uff0cDP\n\n\u8fd9\u9898\u7684\u5173\u952e\u5c31\u662f\u53d1\u73b0\u4e00\u4e2a\u6027\u8d28\uff1a\u5982\u679c\u4e00\u4e2a\u6570\u7684\u6700\u9ad8\u4f4d\u53d61\u7684\u8bdd,\u90a3\u4e48\u4ed6\u5c31\u53d7\u9650\u5236\uff0c\u5426\u5219\u63a5\u4e0b\u6765\u51e0\u4f4d\u5c31\u53ef\u4ee5\u53d6\u4efb\u610f\u503c\uff0c\u6211\u4eec\u5728\u8fd9\u91cc\u5148\u79f0\u5b83\u4e3a**\u81ea\u7531\u6570**(~~\u54c7\u8fd9\u4e48\u591a\u5e9f\u8bdd~~)\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u4e00\u6b65\u6b65\u5411\u4e0b\u5e76\u66f4\u65b0\u6700\u5927\u4f4d\u540e\uff0c\u53ea\u8981\u5f53\u524d\u6700\u5927\u4f4d\u4e3a1\u7684\u4e2a\u6570\u662f\u5947\u6570\u4e2a\u6570\uff0c\u90a3\u4e48\u4e00\u5b9a\u4f1a\u6709\u4e00\u4e2a\u6570\u662f\u81ea\u7531\u6570,\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u9000\u51fa\n\n\u800c\u662f\u5076\u6570\u4e2a\u6570\u7684\u8bdd\uff0c\u53ef\u4ee5\u6839\u636e\u6b21\u6027\u8d28\u8fdb\u884cdp\uff0c\u5bf9\u6bcf\u4e2a\u6570\u5728\u6700\u9ad8\u4f4d\u8fdb\u884c\u8ba8\u8bba(\u8be6\u60c5\u89c1Code)\n\n#### Code:\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int M=55;\ntypedef unsigned long long ull;\null dp[M][2],A[M],ans;\n//dp[i][0/1] --> \u5f53\u524d\u7b2c\u67d0\u4f4d\u65f6,\u524di\u4e2a\u6570\u7684\u5f53\u524d\u4f4d\u5f02\u6216\u8d77\u6765\u4e3a0/1\nint main(){\n\tint n;\n\tbool flag;\n\tscanf(\"%d\",&n);\n\tfor(int i=1; i<=n; i++) scanf(\"%llu\",&A[i]);\n\tfor(int i=31; i>=0; i--){\n\t\tmemset(dp,0,sizeof dp);\n\t\tdp[0][0]=1;\n\t\tfor(int j=1; j<=n; j++){\n\t\t\tif(A[j]&(1<<i)){\n\t\t\t\tdp[j][0]=dp[j-1][1]*((((1<<i)-1)&A[j])+1)+dp[j-1][0]*((1<<i)); //\u5f02\u6216\u5f53\u524d\u4f4d\u4e3a0\uff0c\u53ef\u4ee5\u524dj-1\u4e2a\u6570\u4e3a1\u62160\u8f6c\u79fb\u800c\u6765\n\t\t\t\tdp[j][1]=dp[j-1][0]*((((1<<i)-1)&A[j])+1)+dp[j-1][1]*((1<<i)); //\u540c\u4e0a\n\t\t\t}else{\n\t\t\t\tdp[j][0]=dp[j-1][0]*(A[j]+1); dp[j][1]=dp[j-1][1]*(A[j]+1); //\u76f8\u5f53\u4e8e\u4f60\u53ea\u80fd\u5f02\u62160\n\t\t\t}\n\t\t}\n\t\tflag=0;\n\t\tfor(int j=1; j<=n; j++) if(A[j]&(1<<i)){\n\t\t\tflag^=1;\n\t\t\tull res=1,val=0;\n\t\t\tfor(int k=j+1; k<=n; k++) res*=(((1<<i)-1)&A[k])+1,val^=A[k]>>i; //\u524d\u540e\u5f02\u6216\u8fc7\u540e\u8981\u7b49\u4e8e0,\u76f8\u5f53\u4e8e\u5f53\u524d\u4f4d\u524d\u540e\u76f8\u7b49\n\t\t\tans+=res*dp[j-1][val];\n\t\t}\n\t\tif(flag) break; //\u5947\u6570\u4e2a\u80fd\u5bfc\u81f4\u7559\u4e00\u4e2a\u81ea\u7531\u6570,\u5373\u63a5\u4e0b\u6765\u600e\u4e48\u653e\u90fd\u80fd\u53d8\u62100\n\t\tfor(int j=1; j<=n; j++) A[j]&=(1<<i)-1;//\u66f4\u65b0\u81f3\u4e0b\u4e00\u4f4d\n\t}\n\tif(flag) ans--; //\u5982\u679c\u4ee5\u5947\u6570\u4e3a\u7ed3\u5c3e\uff0c\u4e0d\u80fd\u5b58\u5728\u6240\u6709\u6570\u5b57\u90fd\u4e3a0\u7684\u60c5\u51b5\n\tprintf(\"%llu\\n\",ans);\n\treturn 0;\n\t\u6b22\u8fce\u6765\u55b7\uff01\n}\n```\n\n",
        "postTime": 1562489963,
        "uid": 81715,
        "name": "ppp204",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3447 \u3010[POI2006]KRY-Crystals\u3011"
    },
    {
        "content": "\u51fa\u9898\u4eba\u5c31\u4e0d\u4f1a\u53d6\u6a21\u5417\uff1f\n\n\u867d\u7136\u4f46\u662f\uff0c\u8fd9\u4e0d\u5f71\u54cd\u8fd9\u662f\u4e00\u9053\u597d\u9898\u3002\n\n## \u9898\u76ee\u7b80\u8ff0\n\n> - \u8be2\u95ee\u6709\u591a\u5c11\u957f\u5ea6\u4e3a $n$ \u7684**\u81ea\u7136\u6570**\u6570\u5217 $a_1,a_2,\\dots a_n$ \u6ee1\u8db3\u4e00\u4e0b\u6761\u4ef6\uff1a\n> - - \u5bf9\u4efb\u610f\u7684 $i$ \u90fd\u6709 $0\\leq a_i\\leq b_i$\u3002\n>   - $a_1 \u2295a_2\u2295a_3\u2295\\dots\u2295a_{n-1}\u2295a_n=0$\u3002\n>   - $a$ \u4e0d\u5168\u4e3a $0$\u3002\n> - \u539f\u9898 $n\\leq 50$\u3002\u5b9e\u9645\u4e0a\u53ef\u4ee5\u505a\u5230 $n\\leq 10^6$\uff0c\u53ea\u8981\u53d6\u4e2a\u6a21\u5373\u53ef\u3002\n\n## \u89e3\u9898\u601d\u8def\n\n\u9996\u5148\u6761\u4ef6 $3$ \u53ea\u8981\u6ee1\u8db3\u524d\u4e24\u4e2a\u6761\u4ef6\u540e\u8f93\u51fa $ans-1$ \u5373\u53ef\u3002\n\n\u7136\u540e\u6ce8\u610f\u5230 $a_i\\leq b_i$ \u8fd9\u4e2a\u6761\u4ef6\uff0c\u5f88\u81ea\u7136\u7684\u53ef\u4ee5\u60f3\u5230\u6570\u4f4d dp\u3002\u4f46\u662f\u6211\u4eec\u8981\u8bb0\u5f55\u6bcf\u4e00\u4f4d\u7684\u662f\u5426\u9876\u5230\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u5927\u4e8e $O(2^n)$\uff0c\u8fde\u539f\u9898\u90fd\u8fc7\u4e0d\u53bb\u3002\n\n\u6ce8\u610f\u5230\u6570\u4f4d dp \u7684\u8fc7\u7a0b\uff0c\u4e0d\u96be\u53d1\u73b0\u5bf9\u4e8e\u4e00\u4e2a\u4e8c\u8fdb\u5236\u4e0b\u662f $\\texttt{101110}$ \u7684\u6570\uff0c\u6570\u4f4d dp \u4f1a\u628a\u5b83\u62c6\u6210 $\\texttt{0?????},\\texttt{100???},\\texttt{1010??},\\texttt{10110?},\\texttt{101110}$\u3002\u5176\u4e2d $\\texttt ?$ \u8868\u793a\u968f\u4fbf\u9009\u53d6\u7684\u4f4d\u3002\n\n\u89c2\u5bdf\u4e00\u4e2a\u4f8b\u5b50\uff0c\u6211\u4eec\u5bf9  $\\texttt{10???},\\texttt{001??},\\texttt{111??},\\texttt{0100?}$ \u5f53\u4e2d\u7684 $\\texttt ?$ \u968f\u4fbf\u9009\u53d6\u4f7f\u5f97\u5176\u5f02\u6216\u4e3a $0$ \u7684\u65b9\u6848\u6570\uff0c\u6211\u4eec\u4e0d\u96be\u60f3\u5230\u56fa\u5b9a $\\texttt{10???}$ \u4e3a**\u81ea\u7531\u5143**\uff0c\u5bf9\u4e8e\u5176\u4ed6\u4e09\u4e2a\u6570**\u968f\u610f\u9009\u53d6**\u5f53\u4e2d\u7684 $\\texttt ?$ \u5373\u53ef\u3002\u56e0\u4e3a $\\texttt{10???}$ \u540e\u7f00\u7684 $\\texttt ?$ \u5f88\u591a\uff0c\u6240\u4ee5\u6211\u4eec\u603b\u80fd\u8c03\u6574\u5b83\u4f7f\u5f97\u6574\u4f53\u7684\u5f02\u6216\u4e3a $0$\u3002\n\n\u8fd9\u542f\u793a\u6211\u4eec\uff0c\u5bf9\u4e0a\u9762\u8fd9\u7c7b\u578b\u7684\u95ee\u9898\uff0c\u6211\u4eec\u53ea\u9700\u8981\u53d6\u540e\u7f00 $\\texttt ?$ \u6700\u591a\u7684\u5143\u7d20\u4f5c\u4e3a\u81ea\u7531\u5143\u5373\u53ef\uff0c\u5176\u4ed6\u5143\u7d20\u5c31\u53ef\u4ee5\u81ea\u7531\u9009\u53d6\u4e86\u3002\n\n\u672c\u9898\u662f\u7c7b\u4f3c\u7684\uff0c\u539f\u9898\u7684\u6570\u636e\u8303\u56f4\u5f88\u5c0f\uff0c\u751a\u81f3\u53ef\u4ee5\u76f4\u63a5\u628a\u6bcf\u4e2a\u6570\u62c6\u6210\u6570\u4f4d dp \u7684\u5f62\u5f0f\uff0c\u7136\u540e\u679a\u4e3e\u6bcf\u4e2a\u6570\u4f5c\u4e3a\u81ea\u7531\u5143\u7684\u8d21\u732e\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O((n\\log V)^2)$ \u7684\u3002\u663e\u7136\u8fd8\u53ef\u4ee5\u679a\u4e3e\u81ea\u7531\u5143\u7684\u957f\u5ea6\u518d\u53bb\u8dd1\u4e00\u904d dp\uff0c\u53ef\u4ee5\u505a\u5230 $O(n\\log V)$\u3002\n\n## \u5177\u4f53\u5b9e\u73b0\n\n\u679a\u4e3e\u81ea\u7531\u5143\u7684\u957f\u5ea6 $i$\uff0c\u7ef4\u62a4 dp \u6570\u7ec4 $f[i][j][k]$ \u8868\u793a\u524d $i$ \u4e2a\u6570\u5f53\u4e2d\uff0c\u662f\u5426\u6709\u81ea\u7531\u5143\uff0c\u5e76\u4e14\u7b2c $i$ \u4f4d\u5f53\u524d\u7684\u5f02\u6216\u3002 \n\n\u90a3\u4e48\u6bcf\u4e2a\u6570 $a_j$ \u6709\u4e24\u79cd\u60c5\u51b5\uff1a\n\n- $a_j$ \u5728\u7b2c $i$ \u4f4d\u662f $0$\uff1a\u90a3\u4e48\u5b83\u80af\u5b9a\u4e0d\u662f\u81ea\u7531\u5143\uff0c\u5b83\u53ea\u6709 $a\\ \\text{and}\\  (2^n-1)$ \u7684\u8d21\u732e\u7ed9 $f[j][k][t]$ \u81ea\u5df1\u8f6c\u81ea\u5df1\u3002\n- $a_j$ \u5728\u7b2c $i$ \u4f4d\u662f $1$\uff1a\u90a3\u4e48\u5b83\u53ef\u4ee5\u662f\u81ea\u7531\u5143\uff0c\u679a\u4e3e\u4e24\u79cd\u60c5\u51b5\uff0c\u7b2c\u4e00\u662f $a_j$ \u662f\u81ea\u7531\u5143\uff0c\u90a3\u4e48\u4ed6\u662f\u6ca1\u6709\u8d21\u732e\u7684\uff0c\u53ea\u80fd\u628a $f[j-1][0][]$ \u8f6c\u79fb\u5230 $f[j][1][]$\uff0c\u7b2c\u4e8c\u662f $a_j$ \u4e0d\u662f\u81ea\u7531\u5143\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u8981\u679a\u4e3e $a_j$ \u7b2c $i$ \u4f4d\u7684\u9009\u53d6\u60c5\u51b5\u5373\u53ef\u3002\n\n\u9700\u8981\u6ce8\u610f\u7684\u662f\u53ef\u80fd\u8d85\u8fc7 $i$ \u4f4d\u7684\u90e8\u5206\u672c\u8eab\u5f02\u6216\u5c31\u4e0d\u662f $0$\uff0c\u8fd9\u6837\u5b50\u4e0d\u80fd\u52a0\u5165\u7b54\u6848\u3002\n\n\u4e0a\u9762\u7684 $f$ \u7684\u8f6c\u79fb\u90fd\u6bd4\u8f83\u957f\uff0c\u5177\u4f53\u7684\u53ef\u4ee5\u89c1\u4ee3\u7801\uff1a\n\n```cpp\nconst int MAXN=55;\nint n;ull a[MAXN];\null f[MAXN][2][2],ans;\nint main(){\n\tcin>>n;\n\tfor(int i=1;i<=n;i++) cin>>a[i];\n\tfor(int i=31;i>=0;i--){\n\t\tmemset(f,0,sizeof(f));\n\t\tf[0][0][0]=1;int flag=0;\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tflag^=(a[j]>>i+1);\n\t\t\tif(a[j]>>i&1){\n\t\t\t\tf[j][0][1]=f[j-1][0][0]*((a[j]&((1<<i)-1))+1);\n\t\t\t\tf[j][0][0]=f[j-1][0][1]*((a[j]&((1<<i)-1))+1);\n\t\t\t\tf[j][1][0]=f[j-1][0][0]+f[j-1][1][1]*((a[j]&((1<<i)-1))+1)+f[j-1][1][0]*((1<<i));\n\t\t\t\tf[j][1][1]=f[j-1][0][1]+f[j-1][1][0]*((a[j]&((1<<i)-1))+1)+f[j-1][1][1]*((1<<i));\n\t\t\t}else{\n\t\t\t\tf[j][0][1]=f[j-1][0][1]*((a[j]&((1<<i)-1))+1);\n\t\t\t\tf[j][0][0]=f[j-1][0][0]*((a[j]&((1<<i)-1))+1);\n\t\t\t\tf[j][1][0]=f[j-1][1][0]*((a[j]&((1<<i)-1))+1);\n\t\t\t\tf[j][1][1]=f[j-1][1][1]*((a[j]&((1<<i)-1))+1);\n\t\t\t}\n\t\t} \n\t\tif(!flag) ans+=f[n][1][0];\n\t\tif(!flag&&i==0) ans+=f[n][0][0];\n\t}\n\tcout<<ans-1;\n\treturn 0;\n}\n```\n\n ",
        "postTime": 1681372137,
        "uid": 248400,
        "name": "Inaba_Meguru",
        "ccfLevel": 7,
        "title": "P3447 [POI2006]KRY-Crystals"
    },
    {
        "content": "## \u9898\u76ee\u5206\u6790\n\n\u662f\u597d\u9898\u3002\u867d\u7136\u6570\u636e\u8303\u56f4\u8fc7\u4e8e\u5c0f\u4e86\uff0c\u8ba9\u6211\u60f3\u4e86\u534a\u5929\u3002\u3002\u3002\n\n\u5148\u60f3\u6570\u4f4d $\\text{dp}$\uff0c\u611f\u89c9\u4e0d\u662f\u5f88\u597d\u505a\uff0c\u56e0\u4e3a\u4f60\u9700\u8981\u8bb0\u5f55\u6bcf\u4e2a\u6570\u7684\u524d $j$ \u9ad8\u4f4d\u662f\u5426\u90fd\u662f\u9876\u7740 $m_i$ \u9009\u7684\uff0c\u72b6\u538b\u4e0b\u6765\u76f4\u63a5\u5c31\u70b8\u4e86\u3002\u90a3\u4e48\u8003\u8651\u5f02\u6216\u4e0e\u5927\u5c0f\u8fd9\u4e24\u4e2a\u6027\u8d28\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u53d1\u73b0\u66f4\u5bb9\u6613\u5904\u7406\u7684\u662f\u540e\u8005\u5bf9\u524d\u8005\u7684\u5f71\u54cd\uff0c\u56e0\u4e3a\u5f53\u4e00\u4e2a\u6570\u7684\u5927\u5c0f\u65e0\u9650\u5236\u65f6\uff0c\u5176\u5b83\u6570\u968f\u4fbf\u9009\u90fd\u53ef\u4ee5\u7528\u5b83\u4f7f\u5f02\u6216\u548c\u53d8\u6210 $0$\u3002\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u77e5\u9053\u5177\u4f53\u662f\u54ea\u4e9b\u6570\u65e0\u9650\u5236\uff0c\u53ea\u8981\u6709\u4e00\u4e2a\u6570\u53ef\u4ee5\u65e0\u9650\u5236\u5730\u9009\uff0c\u90a3\u4e48\u5176\u5b83\u6570\u5c31\u53ef\u4ee5\u4efb\u9009\u3002\n\n\u4e8e\u662f\u518d\u6309\u4f4d\u8003\u8651\uff0c\u5f02\u6216\u5728\u4e0d\u540c\u4f4d\u4e4b\u95f4\u4e92\u4e0d\u5f71\u54cd\uff0c\u800c\u5927\u5c0f\u5f53\u4e14\u4ec5\u5f53\u9ad8\u4f4d\u7684 $a_i$ \u4e0e $m_i$ \u5168\u76f8\u7b49\u65f6\u624d\u53d7\u9650\u5236\uff0c\u4e8e\u662f\u6211\u4eec\u81ea\u7136\u60f3\u5230\u679a\u4e3e\u4ece\u9ad8\u5230\u4f4e\u7b2c\u4e00\u6b21\u51fa\u73b0 $(a_i\\And 2^j)<(m_i\\And 2^j)$ \u7684\u4f4d\u6570 $j$\u3002\u6b64\u65f6\u9ad8\u4e8e $j$ \u7684\u4f4d\u662f\u56fa\u5b9a\u7684\uff0c\u53ea\u9700\u7b2c $j$ \u4f4d\u7684\u5f02\u6216\u548c\u4e3a $0$ \u4e14 $\\exists\\ (a_i\\And 2^j)<(m_i\\And 2^j) $ \u5373\u53ef\u5982\u4e0a\u6587\u6240\u8bf4\u5730\u4efb\u9009\u4f4e\u4f4d\u3002\n\n\u6211\u4eec\u8fd9\u6837\u60f3\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $a_i$ \u5bb9\u6613\u6c42\u51fa\u7b2c $j$ \u4f4d\u9009 $0,1$ \u7684\u65b9\u6848\u6570 $b_i,c_i$\uff0c\u7136\u540e\u6211\u4eec\u6c42\u51fa $f(x)=\\prod\\limits_{i=1}^n{(c_ix+b_i)}$\uff0c\u4ee4 $cnt$ \u8868\u793a $\\sum [m_i\\And 2^j]$\uff0c\u4e8e\u662f\u80fd\u4f7f\u7b2c $j$ \u4f4d\u5f02\u6216\u548c\u4e3a $0$ \u7684\u65b9\u6848\u6570\u4e14\u5b58\u5728 $(a_i\\And 2^j)<(m_i\\And 2^j)$ \u7684\u5408\u6cd5\u65b9\u6848\u6570\u662f $\\sum [i\\bmod 2=0][i\\neq cnt][x^i]f(x)$\uff0c\u56e0\u4e3a\u5176\u4e2d\u6709\u4e00\u4e2a\u4f4e\u4f4d\u4e0d\u53d7\u9650\u7684\u6570\u8981\u6ee1\u8db3\u5f02\u6216\u548c\u4e3a $0$ \uff08\u5373\u76f8\u5f53\u4e8e\u5b83\u88ab\u5176\u5b83\u6570\u56fa\u5b9a\u4e86\u9009\u6cd5\uff0c\u800c\u5b83\u7684\u4f4e\u4f4d\u672c\u8eab\u6709 $2^j$ \u79cd\uff09\uff0c\u6240\u4ee5\u8fd9\u4f4d\u7684\u8d21\u732e\u662f $\\displaystyle\\frac{\\sum [i\\bmod 2=0][i\\neq cnt][x^i]f(x)}{2^j}$\u3002\n\n\u4ee5\u4e0a\u7684\u5f0f\u5b50\u53ea\u662f\u65b9\u4fbf\u7406\u89e3\uff0c\u4e8b\u5b9e\u4e0a\u5bb9\u6613\u6ce8\u610f\u5230\u8fd9\u53ef\u4ee5\u4f7f\u7528 $\\text{dp}$ \u5728 $O(n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u5b8c\u6210\u3002\u6bd4\u5982\u4ee4 $f_{i,0/1,0/1}$ \u8868\u793a\u8003\u8651\u4e86\u524d $i$ \u4e2a\u6570\uff0c\u5f02\u6216\u548c\u4e3a $0$ \u8fd8\u662f $1$\uff0c\u5f53\u524d\u6709\u8fd8\u662f\u6ca1\u6709 $(a_i\\And 2^j)<(m_i\\And 2^j)$ \u7684\u6570\u3002\u8bb0 $d_i$ \u8868\u793a $m_i\\bmod 2^j$\uff0c\u6709\u7b80\u5355\u7684\u8f6c\u79fb\uff1a\n\n* \u82e5 $m_i\\And 2^j=0$\uff0c\u5219\u5bf9 $\\forall j,k$ \u6709 $f_{i,j,k}=f_{i-1,j,k}\\times (d_i+1)$\u3002\n* \u82e5 $m_i\\And 2^j=1$\uff0c\u5219\u6709\uff1a\n\n$$\n\\begin{aligned}\n& f_{i,0,0}=f_{i-1,1,0}\\times(d_i+1)\\\\\n& f_{i,1,0}=f_{i-1,0,0}\\times(d_i+1)\\\\\n& f_{i,0,1}=f_{i-1,1,1}\\times(d_i+1)+(f_{i-1,0,0}+f_{i-1,0,1})\\times {2^j}\\\\\n& f_{i,1,1}=f_{i-1,0,1}\\times(d_i+1)+(f_{i-1,1,0}+f_{i-1,1,1})\\times {2^j}\n\\end{aligned}\n$$\n\n\u6613\u77e5\u8fd9\u4e00\u4f4d\u5bf9 $ans$ \u7684\u8d21\u732e\u5373\u4e3a $\\displaystyle\\frac{f_{n,0,1}}{2^j}$\u3002\u6ce8\u610f\u9700\u8981 $\\bigoplus\\limits_{i=1}^n m_i$ \u7684\u9ad8\u4f4d\u5747\u4e3a $0$ \u65f6\u624d\u80fd\u8ba1\u7b97\u6b64\u8d21\u732e\uff0c\u5e76\u4e14\u82e5 $\\bigoplus\\limits_{i=1}^n m_i$ \u672c\u8eab\u5c31\u4e3a $0$ \u5219\u4e5f\u5bf9 $ans$ \u6709 $1$ \u7684\u8d21\u732e\u3002\u6700\u540e\u8f93\u51fa $ans-1$\uff0c\u56e0\u4e3a\u9898\u76ee\u8981\u6c42\u5168 $0$ \u4e0d\u5408\u6cd5\u3002\n\n## \u4ee3\u7801\n\n```cpp\n/*\n  author: PEKKA_l  \n */\n#include <iostream>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\n#define ll unsigned long long\n#define int __int128\n\nint ss,dp[2][2],g[2][2],cf[55];\nll n,m[55],ans;\n\nsigned main()\n{\n\tcin>>n; for(int i=1;i<=n;i++) cin>>m[i],ss^=m[i]; if(!ss) ans++;\n\tcf[0]=1; for(int i=1;i<=40;i++) cf[i]=cf[i-1]*2;\n\tfor(int i=31;i>=0;i--)\n\t{\n\t\tif(ss&cf[i+1]) break; dp[0][0]=1; dp[0][1]=dp[1][0]=dp[1][1]=0;\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tmemcpy(g,dp,sizeof(dp));\n\t\t\tif(m[j]&cf[i])\n\t\t\t{\n\t\t\t\tdp[0][0]=g[1][0]*((m[j]&(cf[i]-1))+1);\n\t\t\t\tdp[1][0]=g[0][0]*((m[j]&(cf[i]-1))+1);\n\t\t\t\tdp[0][1]=g[1][1]*((m[j]&(cf[i]-1))+1)+(g[0][0]+g[0][1])*cf[i];\n\t\t\t\tdp[1][1]=g[0][1]*((m[j]&(cf[i]-1))+1)+(g[1][0]+g[1][1])*cf[i];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdp[0][1]=g[0][1]*((m[j]&(cf[i]-1))+1);\n\t\t\t\tdp[0][0]=g[0][0]*((m[j]&(cf[i]-1))+1);\n\t\t\t\tdp[1][1]=g[1][1]*((m[j]&(cf[i]-1))+1);\n\t\t\t\tdp[1][0]=g[1][0]*((m[j]&(cf[i]-1))+1);\n\t\t\t}\n\t\t}\n\t\tans+=(ll)((dp[0][1])/cf[i]);\n\t}\n\tcout<<ans-1<<endl;\n}\n```\n",
        "postTime": 1684639292,
        "uid": 529697,
        "name": "PEKKA_l",
        "ccfLevel": 6,
        "title": "P3447 \u9898\u89e3"
    },
    {
        "content": "\u53d1\u73b0\u53ea\u8981\u6709\u67d0\u4e2a $x_i$ \u7684\u7b2c $j$ \u4f4d\u6ca1\u6709\u9876\u5230\u4e0a\u754c\uff0c\u90a3\u4e48\u5176\u4ed6\u7684 $x_k$ \u5728\u7b2c $j$ \u4f4d\u4e4b\u540e\u5c31\u4e0d\u9700\u8981\u8003\u8651\u90a3\u4e2a\u5f02\u6216\u7684\u9650\u5236\u4e86\uff0c\u56e0\u4e3a\u8fd9\u4e2a $x_i$ \u603b\u80fd\u6709\uff08\u4e5f\u662f\u552f\u4e00\u7684\uff09\u65b9\u6848\u6765\u6ee1\u8db3\u5176\u4ed6 $x_k$ \u5728\u8fd9\u4e00\u4f4d\u4e0a\u7684\u5f02\u6216\u7ea6\u675f\u3002\n\n\u8003\u8651\u679a\u4e3e\u7b2c\u4e00\u6b21\u51fa\u73b0\u67d0\u4e2a $x_i$ \u4e0d\u9876\u4e0a\u754c\u7684\u4f4d\uff08\u90a3\u4e48\u8fd9\u8981\u6c42\u524d\u9762\u7684\u4f4d\u4e0a $m_i$ \u5404\u81ea\u7684\u524d\u7f00\u5f02\u6216\u8d77\u6765\u6070\u597d\u548c $k$ \u7684\u524d\u7f00\u4e00\u6837\uff09\u3002\u8fd9\u4e00\u4f4d\u4e0a\u53ef\u80fd\u4f1a\u6709\u4e0d\u6b62\u4e00\u4e2a $x_i$ \u4e0d\u9876\u4e0a\u754c\uff0c\u5e76\u4e14\u9700\u8981\u6ee1\u8db3\u8fd9\u4e00\u4f4d\u4e0a\u7684\u5f02\u6216\u7ea6\u675f\u3002\u8003\u8651 DP\uff1a$f(i,0/1,0/1)$ \u8868\u793a\u8003\u8651\u4e86\u524d $i$ \u4e2a\u6570\uff0c\u5f02\u6216\u548c\u4e3a $0/1$\uff0c\u662f\u5426\u9009\u8fc7\u4e0d\u9876\u4e0a\u754c\u7684\u6570\uff0c\u7684\u65b9\u6848\u6570\u3002\u5982\u679c\u679a\u4e3e\u7684\u662f\u7b2c $j$ \u4f4d\uff0c\u6709\u8f6c\u79fb\uff1a\n\n- $m_{i+1}$ \u8fd9\u4e00\u4f4d\u4e0a\u662f $0$\uff1a\u90a3\u4e48 $x_{i+1}$ \u8fd9\u4e00\u4f4d\u8fd8\u5f97\u9876\u4e0a\u754c\uff0c\u6709 $f(i,c,x)\\times (m_{i+1}\\bmod 2^j)\\to f(i+1,c,x)$\n- $m_{i+1}$ \u8fd9\u4e00\u4f4d\u4e0a\u662f $1$\uff1a\u90a3\u4e48 $x_{i+1}$ \u8fd9\u4e00\u4f4d\u53ef\u4ee5\u9009\u62e9\u9876\u4e0a\u754c\u6216\u8005\u4e0d\u9876\u4e0a\u754c\u3002\u5982\u679c\u9876\u4e0a\u754c\u4e5f\u5c31\u662f\u8fd9\u4e00\u4f4d\u9009 $1$\uff0c\u6709\u8f6c\u79fb $f(i,c,x)\\times(m_{i+1}\\bmod 2^j)\\to f(i+1,c\\oplus 1,x)$\uff1b\u5426\u5219\u6709\u76f8\u5f53\u4e8e\u8fd9\u4e00\u4f4d\u9009 $0$\uff0c\u8f6c\u79fb\u5f0f\u4e3a $f(i,c,x)\\times (\\texttt{x==1 ? 1<<j : 1})\\to f(i+1,c,1)$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log m)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n\n#define ull unsigned long long\n\nusing namespace std;\n\ninline int read(){\n\tint x=0,f=1;char c=getchar();\n\tfor(;(c<'0'||c>'9');c=getchar()){if(c=='-')f=-1;}\n\tfor(;(c>='0'&&c<='9');c=getchar())x=x*10+(c&15);\n\treturn x*f;\n}\n\nconst ull mod=1ull<<64;\nint ksm(int x,int y,int p=mod){\n\tint ans=1;\n\tfor(int i=y;i;i>>=1,x=1ll*x*x%p)if(i&1)ans=1ll*ans*x%p;\n\treturn ans%p;\n}\nint inv(int x,int p=mod){return ksm(x,p-2,p)%p;}\nint randint(int l,int r){return rand()*rand()%(r-l+1)+l;}\nvoid add(ull &x,ull v){x+=v;if(x>=mod)x-=mod;}\nvoid Mod(ull &x){if(x>=mod)x-=mod;}\n\nconst int N=55;\null f[N][2][2],lim[N],n,X;\n\nvoid solve(){\n    n=read(),X=0;\n\tull ans=0,now=0;\n\tfor(int i=1;i<=n;i++)lim[i]=read()+1,now^=lim[i];\n\t\n\tfor(int w=31;w>=0;w--){\n//\t\tcout<<\"bit = \"<<w<<endl;\n\t\tbool chk=1;\n\t\tfor(int i=31;i>w;i--)if((now^X)&(1<<i)){chk=0;break;}\n\t\tif(!chk)break;\n\t\tint U=(1<<w)-1;\n\t\tmemset(f,0,sizeof(f));\n\t\tf[0][0][0]=1;\n\t\tfor(int i=0;i<n;i++)for(int c=0;c<2;c++)for(int x=0;x<2;x++)if(f[i][c][x]){\n//\t\t\tcout<<i<<\" \"<<c<<\" \"<<x<<\" \"<<f[i][c][x]<<endl;\n\t\t\tif(lim[i+1]&(1<<w)){\n\t\t\t\tadd(f[i+1][c^1][x],1ll*f[i][c][x]*((lim[i+1]&U)));\n\t\t\t\tadd(f[i+1][c][1],1ll*f[i][c][x]*(x?(U+1):1ll));\n\t\t\t}\n\t\t\telse add(f[i+1][c][x],1ll*f[i][c][x]*((lim[i+1]&U)));\n\t\t}\n\t\tif(X&(1<<w))add(ans,f[n][1][1]);\n\t\telse add(ans,f[n][0][1]);\n//\t\tcout<<\"ans = \"<<ans<<endl;\n\t}\n\tcout<<ans-1<<endl;\n}\n\nsigned main(void){\n\n#ifdef YUNQIAN\n\tfreopen(\"1.in\",\"r\",stdin);\n#endif\n\n    solve();\n\n\treturn 0;\n}\n```",
        "postTime": 1680010273,
        "uid": 307453,
        "name": "\u4e91\u6d45\u77e5\u5904",
        "ccfLevel": 6,
        "title": "P3447"
    },
    {
        "content": "\u9996\u5148\u8981\u77e5\u9053\u4e00\u4e2a\u4e1c\u897f\uff1a\u82e5 $n$ \u4e2a\u6570\u4e2d\uff0c\u82e5\u6709 $1$ \u4e2a\u6570\u7684\u7b2c $i$ \u4f4d\u6ca1\u8fbe\u5230\u4e0a\u9650\uff0c\u90a3\u8fd9 $n-1$ \u4e2a\u6570\u7684\u540e\u9762 $i-1$ \u4f4d\u5c31\u53ef\u4ee5\u968f\u4fbf\u53d6\uff0c\u90a3\u4e00\u4e2a\u6570\u51d1\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u540e\u9762 $i-1$ \u4f4d\u7684\u5f02\u6216\u548c\u4e3a $0$\u3002\n\n\u4ece\u6bcf\u4e00\u4f4d\u770b\uff0c\u8fd9\u4e00\u4f4d\u53ef\u4ee5\u5206\u4e24\u79cd\u60c5\u51b5\n1. \u8fd9\u4f4d\u6709\u6570\u6ca1\u6709\u53d6\u5230\u4e0a\u9650\u7684\n2. \u8fd9\u4f4d\u6240\u6709\u6570\u90fd\u53d6\u5230\u4e86\u4e0a\u9650\n\n\u5bf9\u4e8e\u7b2c\u4e8c\u79cd\u60c5\u51b5\uff1a\u9700\u8981\u6bcf\u4e2a\u6570\u53d6\u5230\u4e0a\u9650\u540e\u5f02\u6216\u8d77\u6765\u548c\u662f $0$\uff0c\u5426\u5219\u8df3\u51fa\u5faa\u73af\u5c31\u597d\u4e86\uff0c\u7b26\u5408\u6761\u4ef6\u540e\u76f4\u63a5\u5230\u4e0b\u4e00\u4f4d\u5373\u53ef\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e00\u79cd\u60c5\u51b5\uff1a\u9700\u8981\u8981\u505a\u5230\u7684\u662f\u4e0d\u91cd\u4e0d\u843d\u7684\u679a\u4e3e\u5b8c\u6709\u4e1c\u897f\u6ca1\u53d6\u5230\u4e0a\u9650\u7684\u60c5\u51b5\u3002\n\n\u8fd9\u91cc\u63a8\u8350\u4e00\u79cd\u679a\u4e3e\u7684\u65b9\u6cd5\uff1a\u679a\u4e3e\u7b2c $i$ \u4e2a\u6570\u662f\u6700\u540e\u6ca1\u6709\u5230\u4e0a\u9650\u7684\u6570\uff08\u5f53\u7136\u8fd9\u4e2a\u6570\u8fd9\u4e00\u4f4d\u5f97\u662f $1$\uff09$i$ \u524d\u7684\u968f\u4fbf\u6709\u6ca1\u6709\u53d6\u5230\u4e0a\u9650\uff0c$i$ \u540e\u7684\u90fd\u8981\u53d6\u5230\u4e0a\u9650\u3002\n\n\u56e0\u4e3a $i$ \u540e\u5168\u8981\u53d6\u5230\u4e0a\u9650\uff0c\u6240\u4ee5\u5f02\u6216\u7684\u503c\u662f\u56fa\u5b9a\u7684\uff0c\u6240\u4ee5\u524d\u9762\u4efb\u610f\u53d6\u7684\u65b9\u6848\u6570dp\u5c31\u597d\u4e86\uff0c\u53ef\u4ee5\u770b\u770b\u4ee3\u7801\u3002\n\n\u6700\u540e\uff0c\u5982\u679c\u5230\u4e86\u6700\u540e\u90fd\u6ee1\u8db3\u7684\u8bdd\uff0c\u8bb0\u5f97\u52a0\u4e0a\u6bcf\u4e2a\u6570\u90fd\u53d6\u5230\u4e0a\u9650\u7684\u53d6\u6cd5\u3002\n\n\u6ce8\u610f\uff1a\n1. \u8bb0\u5f97\u51cf\u53bb\u5168\u90fd\u662f $0$ \u7684\u60c5\u51b5\n2. ```long long``` \u4e0d\u591f\u7528 \u5f97 ```unsigned long long```\n\n\n```\n#include <bits/stdc++.h>\nusing namespace std;\n#define ull unsigned long long\nconst int N= 55;\nint a[N]; ull dp[N][2];   // dp[i][j]\u8868\u793a\u7b2ci\u4e2a\u6570 \u5f02\u6216\u548c\u4e3aj\u540e\u9762\u7684\u65b9\u6848\u6570\nint main()\n{\n\tint n; cin>> n; int fl= 0;\n\tfor(int i= 1; i<= n; i++ ) scanf(\"%d\", &a[i]);\n\tull ans= 0; \n\tfor(int i= 31; i>= 0; i-- )\n\t{\n\t\tdp[0][0]= 1, dp[0][1]= 0; fl= 0; \n\t\tfor(int j= 1; j<= n; j++ )\n\t\t{\n\t\t\tif(a[j]>> i& 1) \n\t\t\t{\n\t\t\t\tdp[j][0]= (ull)dp[j- 1][1]* ((a[j]& ((1<< i)- 1))+ 1)+ (ull)dp[j- 1][0]* (1<< i);\n\t\t\t\tdp[j][1]= (ull)dp[j- 1][1]* (1<< i)+ (ull)dp[j- 1][0]* ((a[j]& ((1<< i)- 1))+ 1);\n\t\t\t}\n\t\t\telse dp[j][0]= dp[j- 1][0]* (a[j]+ 1), dp[j][1]= dp[j- 1][1]* (a[j]+ 1);\n\t\t}\n\t\tfor(int j= 1; j<= n; j++ )\n\t\t{\n\t\t\tif(! (a[j]>> i& 1)) continue; fl^= 1; ull res= 1, tmp= 0;\n\t\t\tfor(int k= j+ 1; k<= n; k++ ) res*= ((a[k]& ((1<< i)- 1))+ 1), tmp^= (a[k]>> i& 1);\n\t\t\tans+= (ull)res* dp[j- 1][tmp]; \n\t\t}\n\t\tif(fl== 1) break;\n\t\tfor(int j= 1; j<= n; j++ ) a[j]&= (1<< i)- 1; \n\t}\n\tif(fl== 0) ans++ ; cout<< ans- 1<< endl;\n\treturn 0;\n}\n```",
        "postTime": 1660400699,
        "uid": 685539,
        "name": "autumnlove",
        "ccfLevel": 0,
        "title": "[POI2006]KRY-Crystals"
    }
]
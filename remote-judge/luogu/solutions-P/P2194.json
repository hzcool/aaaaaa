[
    {
        "content": "\u5176\u5b9e\u6211\u672c\u4eba\u662f\u53cd\u5bf9\u70e7\u60c5\u4fa3\u7684\n\n\u56e0\u4e3a\u6211\u559c\u6b22\u4e00\u4e2a\u7279\u52c7\u7684\u5973\u5b69\u7eb8,\u4f46\u662f\u603b\u662f\u6ce1\u4e0d\u5230\uff08OIer\u5171\u6027\uff09\n\n\u597d\u4e86\uff0c\u8fdb\u5165\u6b63\u9898\n\n\u6b64\u9898\u4e3aTarjan\n\n\u6211\u5c31\u8bf4\u4e00\u4e0b\u65b9\u6848\u6570\u600e\u4e48\u7b97\n\n\u5c31\u662f\u4e58\u6cd5\u539f\u7406\uff1a\u5404\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u4e2d\u6700\u5c0f\u82b1\u8d39\u70b9\u7684\u4e2a\u6570\u76f8\u4e58\n\n\u4e0a\u4ee3\u7801:\n```\n#include<bits/stdc++.h>//\u4e07\u80fd\u5934\n#define maxn 100001\n#define maxm 300005\nusing namespace std;\nstruct Edge{\n\tint nex,to;\n}edge[maxm];\nint low[maxn],dfn[maxn],k[maxm],c[maxm],du[maxm],hea[maxm],stac[maxn],ins[maxn],a[maxn];\nint top,tot,n,m,num,cnt;\nlong long ans1,ans2=1,mo=1e9+7;//ans1,ans2\u4e00\u5b9a\u8981longlong\u4e0d\u7136\u53ef\u80fd\u4f1a\u70b8\nvector<int>scc[maxm];\nvoid add(int x,int y)\n{\n\tedge[++tot].nex=hea[x];\n\tedge[tot].to=y;\n\thea[x]=tot; \n}//\u5b58\u4e0b\u4e00\u6761<x.y>\u7684\u5f27\nvoid tarjan(int x)//Tarjan1\u7ecf\u5178\u6a21\u677f\n{\n\tdfn[x]=low[x]=++num;\n\tstac[++top]=x;ins[x]=1;\n\tfor(int i=hea[x];i;i=edge[i].nex)\n\t{\n\t\tint y=edge[i].to;\n\t\tif(!dfn[y])\n\t\t{\n\t\t\ttarjan(y);\n\t\t\tlow[x]=min(low[x],low[y]);\n\t\t}\n\t\telse if(ins[y])\n\t\t{\n\t\t\tlow[x]=min(low[x],dfn[y]);\n\t\t}\n\t}\n\tif(low[x]==dfn[x])\n\t{\n\t\tint z;cnt++;\n\t\tdo{\n\t\t\tz=stac[top--];ins[z]=0;c[z]=cnt;k[cnt]++;scc[cnt].push_back(z);\n\t\t}while(x!=z);\n\t}\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&a[i]);\n\t}\n\tscanf(\"%d\",&m);\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint x,y;\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tadd(x,y);//\u5b58\u8fb9\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(!dfn[i])  tarjan(i);//\u5982\u679c\u672a\u88ab\u641c\u7d22\u5c31Tarjan\n\t}\n\tfor(int i=1;i<=cnt;i++)\n\t{\n\t\tint coun=1,x=0x3fffffff;\n\t\tint len=scc[i].size();\n\t\tfor(int j=0;j<len;j++)\n\t\t{\n\t\t\tif(a[scc[i][j]]==x) coun++;//\u5982\u679c\u4e00\u6837\u5c31++\n\t\t    if(a[scc[i][j]]<x)\n\t\t    {\n\t\t\t    x=a[scc[i][j]];\n\t\t\t    coun=1;\n\t\t    }//\u5982\u679c\u5c0f\u4e8e\u5c31\u91cd\u7f6e\n\t\t}\n\t\tans1+=x;\n\t\tans2*=coun;\n\t\tans2%=mo;\n\t}\n\tcout<<ans1<<\" \"<<ans2;\n\treturn 0;\n}\n```\n\u6700\u540e\uff0c\u795d\u5404\u4f4dOIer\u90fd\u80fdA\u8fc7\u6b64\u9898\uff08\u4e0d\u6284\u9898\u89e3\uff09\uff0c\u4e5f\u795d\u4f60\u4eec\u80fd\u591f\u8ffd\u5230\u81ea\u5df1\u5fc3\u4eea\u7684\u59b9\u5b50\uff01\n\n\u7ba1\u7406\u5927\u5927\u7ed9\u4e2a\u901a\u8fc7\u5457",
        "postTime": 1571114217,
        "uid": 118300,
        "name": "\u626c\u76932006",
        "ccfLevel": 0,
        "title": "P2194 HXY\u70e7\u60c5\u4fa3 \u9898\u89e3"
    },
    {
        "content": "### \u6b8b\u5fcd\u7684\u9898\u9762\n\n\u6211\u4eec\u6765\u770b\u8fd9\u4e00\u9053\u9898\uff0c\u5176\u5b9e\u5197\u957f\u7684\u9898\u76ee\u544a\u8bc9\u6211\u4eec\u4e00\u4e2a\u6838\u5fc3\u2014\u2014**\u7528tarjan**\n\n**tarjan\u662f\u7528\u6765\u5e72\u4ec0\u4e48\u5462\uff1f**\u662f\u7528\u6765\u6c42\u5f3a\u8fde\u901a\u5206\u91cf\uff08\u4ee3\u7801\u4e2d\u6307sc\uff09\n\n**\u6c42\u51fa\u6765\u53c8\u6709\u4ec0\u4e48\u7528\u5462\uff1f**\u6bcf\u5f53\u6211\u4eec\u6c42\u51fa\u4e00\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u65f6\uff0c\u5c31\u53bb\u8ba1\u7b97\u5f53\u524d\u5f3a\u8fde\u901a\u5206\u91cf\u4e2d\u5404\u70b9\u6700\u5c0f\u503c\u662f\u591a\u5c11\u4ee5\u53ca\u5176\u4e2a\u6570\uff0c\u7136\u540e\u5206\u522b\u5f00\u4e24\u4e2a\u8ba1\u6570\u5668\uff0c\u5047\u8bbeans1\u662f\u7528\u6765\u5b58\u4e2a\u6570\u76f8\u4e58\uff0cans2\u662f\u7528\u6765\u7d2f\u52a0\u6700\u5c0f\u503c\u7684\u3002\n\n\u4e34\u95e8\u4e00\u811a\uff0c\u5343\u4e07\u522b\u5fd8\u4e86\u53d6%   \u53e6\u5916\u6ce8\u610f\u5982\u679c\u5c0f\u4f19\u4f34\u8fd9\u6837\u548c\u6211\u4e00\u6837\u5199tarjan\u7684\u8bdd\n\n```cpp\nfor(int i=head[x];i!=-1;i=e[i].next)\n```\n\u4e00\u5b9a\u8bb0\u4f4f\uff0c\u5728main\u51fd\u6570\u91cc\u8981\n\n```cpp\nmemset(head,-1,sizeof(head));\n```\n\n\u5426\u5219\u4ed6\u4f1a\u8f93\u4e0d\u8fdb\u53bb\uff0c\u4e5f\u8dd1\u4e0d\u51fa\u6765\uff01\uff08\u8840\u7684\u6559\u8bad\uff09\n\n~~\uff08\u770b\u672c\u849f\u84bb\u7684\u4ee3\u7801\uff0c\u5927\u795e\u52ff\u55b7\uff09~~\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mod = 1e9+7;\n#define ll long long\n#define inf 1e9\nconst int N = 310000;\nconst int M = 210000;\nint head[M],v[M],dfn[M],low[M],q[M];\nint be[M],sum[M],hh[M],num[M];\nint ss,n,m,now,cnt,tot,sc;\nll ans1=1,ans2;\nbool f[N];\nstruct Edge{\n\tint to,next;\n}e[N];\nvoid add(int x,int y)\n{\n\te[++ss].to=y;\n\te[ss].next=head[x];\n\thead[x]=ss;\n}\nvoid dfs(int x)//\u8fd9\u91cc\u7684dfs\u548c\u4e0b\u9762tarjan\u5206\u7740\u5199\u7684\uff0c\u4e0d\u7ba1\u600e\u6837\u90fd\u662ftarjan\u6a21\u677f\n{\n\tlow[x]=dfn[x]=++cnt;\n\tq[++tot]=x;\n\tf[x]=1;\n\tfor(int i=head[x];i!=-1;i=e[i].next)\n\t{\n\t\tif(!dfn[e[i].to])\n\t\t{\n\t\t\tdfs(e[i].to);\n\t\t\tlow[x]=min(low[x],low[e[i].to]);\n\t\t}\n\t\telse\n\t\tif(f[e[i].to])\n\t\tlow[x]=min(low[x],dfn[e[i].to]);\n\t}\n\tif(low[x]==dfn[x])\n\t{\n\t\tsc++;\n\t\tbe[x]=sc;\n\t\thh[sc]=inf;\n\t\tdo\n\t\t{\n\t\t\tnow=q[tot--];\n\t\t\tf[now]=0;\n\t\t\tbe[now]=sc;\n\t\t\tif(v[now]<hh[sc])\n\t\t\t{\n\t\t\t\thh[sc]=v[now];\n\t\t\t\tnum[sc]=0;\n\t\t\t}\n\t\t\tif(v[now]==hh[sc]) num[sc]++;\n\t\t}\n\t\twhile(now!=x);\n\t}\n}\nvoid tarjan()\n{\n\tfor(int i=1;i<=n;i++)\n\t\tif(!dfn[i]) dfs(i);\n}\nint main()\n{\n\tmemset(head,-1,sizeof(head));\n\tcin>>n;\n\tfor(int i=1;i<=n;i++)\n\t\tcin>>v[i];\n\tcin>>m;\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint x,y;\n\t\tcin>>x>>y;\n\t\tadd(x,y);\n\t}\n\ttarjan();\n\tfor(int i=1;i<=sc;i++)//\u6700\u540e\u7684\u5904\u7406\uff0cans1\u522b\u5fd8\u521d\u503c\u4e3a1\n\t{\n\t\tans1*=num[i];\n\t\tans2+=hh[i];\n\t\tans1%=mod;\n\t}\n\tcout<<ans2<<\" \"<<ans1;\n\treturn 0;\n}\n```",
        "postTime": 1545634119,
        "uid": 48821,
        "name": "\u4e09\u597d\u4ee3\u8868",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2194 \u3010HXY\u70e7\u60c5\u4fa3\u3011"
    },
    {
        "content": "tarjan\u6c34\u9898\n\n\ntarjan\u7f29\u70b9\uff0c\u8bb0\u5f55\u8054\u901a\u5757\u60c5\u51b5\uff0c\u6a21\u62df\u4e00\u4e0b\u5373\u53ef\n\n\u3002\u3002\u3002\n\n\u8be6\u7ec6\u4e00\u70b9\u5c31\u662f\n\nvector\u6570\u7ec4\u8bb0\u5f55\u6bcf\u4e2a\u8054\u901a\u5757\u91cc\u7684\u6bcf\u4e00\u4e2a\u70b9\n\n\u6700\u5c0f\u6c7d\u6cb9\u8d39\u5373\u4e3a\u6bcf\u4e2a\u8054\u901a\u5757\u91cc\u6700\u5c0f\u70b9\u6743\n\n\u65b9\u6848\u6570\u5373\u4e3a\u6bcf\u4e2a\u8054\u901a\u5757\u91cc\u6700\u5c0f\u70b9\u6743\u7684\u70b9\u6570\u4e4b\u79ef\uff08\u4e58\u6cd5\u539f\u7406\uff09%1e9+7\n\n```cpp\n#include<bits/stdc++.h>\n\n#define N 501010\nusing namespace std;\n\nint n,head[N],tot,w[N],m,ans1,ans2;\nstruct node {\n    int to,next;\n} e[N];\nvoid add(int u,int v) {\n    e[++tot].to=v,e[tot].next=head[u],head[u]=tot;\n}\n\nconst int mod=1e9+7;\n\nint dfn[N],low[N],item,belong[N],all[N],cnt;\nbool vis[N];\nstack<int>S;\nvector<int>G[N];\nvoid tarjan(int u){\n\tdfn[u]=low[u]=++item;\n\tS.push(u);vis[u]=1; \n\tfor(int i=head[u];i;i=e[i].next){\n\t\tint v=e[i].to;\n\t\tif(!dfn[v]){\n\t\t\ttarjan(v);\n\t\t\tlow[u]=min(low[u],low[v]);\n\t\t}else if(vis[v]) low[u]=min(low[u],dfn[v]); \n\t}\n\tif(low[u]==dfn[u]){\n\t\tint v=u;++cnt;\n\t\tdo{\n\t\t\tv=S.top();S.pop();\n\t\t\tvis[v]=0;belong[v]=cnt;all[cnt]++;\n\t\t\tG[cnt].push_back(v);\n\t\t}while(v!=u);\n\t}\n}\n\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&w[i]);\n\tscanf(\"%d\",&m);\n\tfor(int a,b,i=1;i<=m;i++) {\n\t\tscanf(\"%d%d\",&a,&b);\n\t\tadd(a,b);\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tif(!dfn[i]) tarjan(i);\n\tans2=1;\n\tfor(int i=1;i<=cnt;i++){\n\t\tint tpt=G[i].size(),tkt=0,minn=mod;\n\t\tfor(int j=0;j<tpt;j++){\n\t\t\tif(w[G[i][j]]<minn){\n\t\t\t\tminn=w[G[i][j]];\n\t\t\t\ttkt=1;\n\t\t\t}else if(minn==w[G[i][j]]) ++tkt;\n\t\t}\n\t\tans1+=minn;\n\t\tans2=(ans2%mod*tkt%mod)%mod;\n\t}\n\tprintf(\"%d %d\",ans1,ans2);\n\treturn 0;\n}\n```",
        "postTime": 1534602556,
        "uid": 60939,
        "name": "\u6e05\u98ce\u6211\u5df2\u901d",
        "ccfLevel": 0,
        "title": "\u89e3\u9898\u62a5\u544a P2194 \u3010HXY\u70e7\u60c5\u4fa3\u3011"
    },
    {
        "content": "\u8fd9\u9898\u662f\u4e00\u9053[\u5f3a\u8054\u901a\u5206\u91cf](https://baike.baidu.com/item/\u5f3a\u8fde\u901a\u5206\u91cf/7448759?fr=aladdin)\u7684~~\u6c34~~\u9898,\u6211\u7528[$tarjan$](https://blog.csdn.net/weixin_43843835/article/details/88381828)\u505a\u7684\u3002\n\n\u7b2c\u4e00\u95ee\u7684\u6700\u5c0f\u82b1\u8d39\u5176\u5b9e\u5c31\u662f\u6c42\u6bcf\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u91cc\u7684\u6700\u5c0f\u70b9\u6743\u503c,\u7136\u540e\u518d\u628a\u5b83\u4eec\u76f8\u52a0\u3002\n\n\u5177\u4f53\u5b9e\u73b0:\n\n```cpp\nfor(int i=1;i<=cnt;i++) ans1=ans1+minn[i];\n```\n\n$cnt$\u4e3a\u6709\u591a\u5c11\u4e2a\u5f3a\u8054\u901a\u5206\u91cf,$minn_i$\u662f\u6bcf\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u91cc\u7684\u6700\u5c0f\u70b9\u6743\u503c\u3002\n\n\u7b2c\u4e8c\u95ee\u5176\u5b9e\u4e5f\u4e0d\u96be,\u53ef\u4ee5\u7528\u4e58\u6cd5\u539f\u7406\u505a,\u5728\u8dd1$tarjan$\u7684\u65f6\u5019\u52a0\u4e00\u4e2a\u5224\u65ad\u5c31\u884c\u4e86:\u5982\u679c\u4e00\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u4e2d\u6709\u4e24\u4e2a\u6700\u5c0f\u70b9\u6743\u503c\u76f8\u7b49,\u90a3\u4e48$sum_i$(\u8bb0\u5f55\u6bcf\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u91cc\u9762\u6709\u591a\u5c11\u4e2a\u6700\u5c0f\u70b9\u6743\u503c)\u5c31\u52a0$1$\u3002\u8fd9\u91cc\u6709\u4e00\u70b9\u8981\u6ce8\u610f:\u5982\u679c\u6700\u5c0f\u70b9\u6743\u503c\u66f4\u65b0\u4e86,\u90a3\u4e48$sum_i$\u4e5f\u8981\u968f\u4e4b\u66f4\u65b0\u3002\n\n\u5177\u4f53\u5b9e\u73b0:\n\n```cpp\nans2=1;\nfor(int i=1;i<=cnt;i++) ans2=(ans2*sum[i])%1000000007;\n```\n\n\u5b8c\u6574\u4ee3\u7801:\n\n```cpp\n#include<bits/stdc++.h>\n//#define chenkeqi return\n//#define AK 0\n//#define PJz ;\nusing namespace std;\nstruct edge\n{\n\tlong long v,next;\n}\ne[600005];\nlong long a[100005],head[600005];\nlong long low[300005],ins[300005];\nlong long belong[300005],dfn[300005];\nlong long cnt,k,tot,n,m,ans1,ans2;\nlong long minn[300005],sum[300005];\nstack<int>s;\nvoid adde(long long u,long long v)\n{\n\te[++k].v=v;\n\te[k].next=head[u];\n\thead[u]=k;\n}\n//\u524d\u5411\u661f\u5b58\u56fe\nvoid tarjan(int u)\n{\n\tdfn[u]=low[u]=++tot;\n\ts.push(u);\n\tins[u]=1;\n\tfor(int i=head[u];i!=-1;i=e[i].next)\n\t{\n\t\tint v=e[i].v;\n\t\tif(!dfn[v])\n\t\t{\n\t\t\ttarjan(v);\n\t\t\tlow[u]=min(low[u],low[v]);\n\t\t}\n\t\telse if(ins[v])\n\t\t\tlow[u]=min(low[u],dfn[v]);\n\t}\n\tif(dfn[u]==low[u])\n\t{\n\t\tint kl;\n\t\tcnt++;\n\t\tdo\n\t\t{\n\t\t\tkl=s.top();\n\t\t\ts.pop();\n\t\t\tbelong[kl]=cnt;//belong\u597d\u50cf\u6ca1\u5565\u7528\n\t\t\tins[kl]=0;\n\t\t\tif(minn[cnt]==a[kl])//\u5982\u679c\u6700\u5c0f\u503c\u6709\u76f8\u540c\n\t\t\t\tsum[cnt]++;//\u6b64\u5f3a\u8fde\u901a\u5206\u91cf\u4e2d\u591a\u4e00\u79cd\u65b9\u6848\n\t\t\tif(a[kl]<minn[cnt])//\u5982\u679c\u6709\u66f4\u5c0f\u503c\n\t\t\t{\n\t\t\t\tminn[cnt]=a[kl];//\u66f4\u65b0\u6700\u5c0f\u503c\n\t\t\t\tsum[cnt]=1;//\u6b64\u5f3a\u8fde\u901a\u5206\u91cf\u4e2d\u65b9\u6848\u5f521\n\t\t\t}\n\t\t}while(u!=kl);\n\t}\n}\n//tarjan\u6a21\u677f\u4ee3\u7801\nint main()\n{\n\tmemset(head,-1,sizeof(head));\n\tmemset(minn,127,sizeof(minn));//\u6ce8\u610fminn\u548chead\u7684\u521d\u59cb\u5316\n\tcin>>n;\n\tfor(int i=1;i<=n;i++)\n\t\tcin>>a[i];\n\tcin>>m;\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint a,b;\n\t\tcin>>a>>b;\n\t\tadde(a,b);//\u52a0\u8fb9\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(!dfn[i])\n\t\t\ttarjan(i);\n\t}\n\tfor(int i=1;i<=cnt;i++)\n\t\tans1=ans1+minn[i];\n\tans2=1;\n\tfor(int i=1;i<=cnt;i++)\n\t\tans2=(ans2*sum[i])%1000000007;\n   \t//\u5bf9\u4e24\u4e2a\u95ee\u7684\u64cd\u4f5c,\u524d\u9762\u5df2\u7ecf\u8bb2\u8fc7\n\tcout<<ans1<<\" \"<<ans2;\n\t//chenkeqi AK PJz\n\treturn 0;\n}\n```",
        "postTime": 1595206000,
        "uid": 263011,
        "name": "chenkeqi1",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2194 \u3010HXY\u70e7\u60c5\u4fa3\u3011"
    },
    {
        "content": "\u9047\u5230\u8fd9\u79cd~~\u9b3c\u8ff7\u65e5\u773c~~\u7684\u9898\u76ee\u8981\u5b66\u4f1a\u7ffb\u8bd1\u6210\u73b0\u4ee3\u6c49\u8bed\u3002\n\n> \u4f17\u6240\u5468\u77e5\uff0cHXY\u5df2\u7ecf\u52a0\u5165\u4e86FFF\u56e2\u3002\u73b0\u5728\u5979\u8981\u5f00\u59cb\u559c\uff08sang\uff09\u95fb\uff08xin\uff09\u4e50\uff08bing\uff09\u89c1\uff08kuang\uff09\u5730\u70e7\u60c5\u4fa3\u4e86\u3002\u8fd9\u91cc\u6709n\u5ea7\u7535\u5f71\u9662\uff0cn\u5bf9\u60c5\u4fa3\u5206\u522b\u5728\u6bcf\u5ea7\u7535\u5f71\u9662\u91cc\uff0c\u7136\u540e\u7535\u5f71\u9662\u91cc\u90fd\u6709\u6c7d\u6cb9\uff0c\u4f46\u662f\u8981\u4f7f\u7528\u5b83\u9700\u8981\u4e00\u5b9a\u7684\u8d39\u7528\u3002m\u6761\u5355\u5411\u901a\u9053\u8fde\u63a5\u76f8\u90bb\u7684\u4e24\u5bf9\u60c5\u4fa3\u6240\u5728\u7535\u5f71\u9662\u3002\u7136\u540eHXY\u6709\u4e2a\u7edd\u6280\uff0c\u5982\u679c\u5979\u80fd\u4ece\u4e00\u4e2a\u70b9\u5f00\u59cb\u70e7\uff0c\u6700\u540e\u56de\u5230\u8fd9\u4e2a\u70b9\uff0c\u90a3\u4e48**\u70e7\u8fd9\u6761\u56de\u8def\u4e0a\u7684\u60c5\u4fa3\u7684\u8d39\u7528\u53ea\u9700\u8981\u8be5\u70b9\u7684\u6c7d\u6cb9\u8d39\u5373\u53ef**\u3002\u5e76\u4e14**\u6bcf\u5bf9\u60c5\u4fa3\u53ea\u9700\u70e7\u4e00\u904d\uff0c\u7535\u5f71\u9662\u53ef\u4ee5\u91cd\u590d\u53bb**\u3002\u7136\u540e\u5979\u60f3**\u82b1\u5c3d\u53ef\u80fd\u5c11\u7684\u8d39\u7528\u70e7\u6389\u6240\u6709\u7684\u60c5\u4fa3**\u3002\u95ee\u6700\u5c11\u9700\u8981\u591a\u5c11\u8d39\u7528\uff0c\u5e76\u4e14\u5f53**\u8d39\u7528\u6700\u5c11\u65f6\u7684\u65b9\u6848\u6570**\u662f\u591a\u5c11\uff1f\u7531\u4e8e\u65b9\u6848\u6570\u53ef\u80fd\u8fc7\u5927\uff0c\u6240\u4ee5\u8bf7\u8f93\u51fa\u65b9\u6848\u6570\u5bf91e9+7\u53d6\u6a21\u7684\u7ed3\u679c\u3002\n>\n> \uff08\u6ce8\uff1a\u8fd9\u91ccHXY\u6bcf\u6b21\u53ef\u4ee5\u4ece\u4efb\u4f55\u4e00\u4e2a\u70b9\u5f00\u59cb\u8d70\u56de\u8def\u3002\u5c31\u662f\u8bf4\u4e00\u4e2a\u56de\u8def\u8d70\u5b8c\u4e86\uff0c\u4e0b\u4e00\u4e2a\u5f00\u59cb\u4f4d\u7f6e\u53ef\u4ee5\u4efb\u9009\u3002\u6240\u4ee5\u8bf4\u4e0d\u5b58\u5728\u70e7\u4e0d\u4e86\u6240\u6709\u60c5\u4fa3\u7684\u60c5\u51b5\uff0c\u5373\u4f7f\u56fe\u4e0d\u8fde\u901a\uff0cHXY\u81ea\u884c\u9009\u62e9\u9876\u70b9\u8fdb\u884c\u70e7\u60c5\u4fa3\u884c\u52a8\u3002\u4e14\u8d70\u8fc7\u7684\u9053\u8def\u53ef\u4ee5\u91cd\u590d\u8d70\u3002\uff09\n\n\u626f\u4e86\u8fd9\u4e48\u591a\uff0c\u5176\u5b9e\u5c31\u662f\u60f3\u8868\u8fbe\u4e00\u4e2a\u610f\u601d\uff1a\u6c42\u6240\u6709$SCC$\u4e2d\u7684**\u6700\u5c0f\u70b9\u6743\u548c**\u4ee5\u53ca**\u80fd\u8fbe\u5230\u8fd9\u4e2a\u6700\u5c0f\u70b9\u6743\u548c\u7684\u65b9\u6848\u6570**\u3002\n\n$SCC$\u4e2d\u7684\u6700\u5c0f\u70b9\u6743\u548c\u6c42\u6cd5\u8fd9\u91cc\u5c31\u65e0\u9700\u8d58\u8ff0\u4e86\u3002\u6bd4\u8f83\u96be\u7684\u662f\u8fd9\u4e2a\u65b9\u6848\u6570\u3002\n\n\u6211\u4eec\u4e0d\u96be\u4ece\u6837\u4f8b#2\u4e2d\u53d1\u73b0\uff0c\u53ef\u80fd\u4e00\u4e2a$SCC$\u4e2d\u6700\u5c0f\u70b9\u6743\u6709\u591a\u4e2a\u3002\u6211\u4eec\u4e0d\u59a8\u5927\u80c6\u5730\u505a\u51fa\u731c\u60f3\uff1a\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c\u5982\u679c\u6211\u4eec\u628a\u6240\u6709$SCC$\u4e2d\u6700\u5c0f\u70b9\u6743\u7684\u6570\u91cf\u4e58\u8d77\u6765\uff0c\u662f\u4e0d\u662f\u5c31\u662f\u65b9\u6848\u6570\u4e86\u5462\uff1f**\u8fd9\u662f\u6ca1\u95ee\u9898\u7684**\u3002\n\n\u6240\u4ee5\u8bf4\u672c\u9898\u7684\u4e24\u4e2a\u7b54\u6848\uff1a\n\n$minn[i]$\u8868\u793a\u7b2c$i$\u4e2a$SCC$\u7684\u6700\u5c0f\u70b9\u6743\uff0c$num[i]$\u8868\u793a\u7b2c$i$\u4e2a$SCC$\u4e2d\u6700\u5c0f\u70b9\u6743\u7684\u6570\u91cf\uff0c$cnt$\u8868\u793a$SCC$\u7684\u6570\u91cf\u5219\uff1a\n\n\u7b2c\u4e00\u4e2a\u7b54\u6848$ans1 = \\sum\\limits_{i = 1}^{cnt}{minn[i]}$\u3002\n\n\u7b2c\u4e8c\u4e2a\u7b54\u6848$ans2 = \\prod\\limits_{i = 1}^{cnt}{num[i]}$\n\n\u8fd9\u5c31\u5b8c\u4e86\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<stack>\n#include<cstring>\nusing namespace std;\n\nconst int MaxN = 1e5 + 5;\nconst int MaxM = 3e5 + 5;\nconst int Mod = 1e9 + 7;\nint n, m;\nstruct Edge \n{\n\tint v, nxt;\n} edge[MaxM];\nint head[MaxN], k = 1;\nint ins[MaxN], low[MaxN], dfn[MaxN], col[MaxN], cnt = 0, minn[MaxN], num[MaxN], tim;\nint val[MaxN];\nstack<int> st;\n\nint get() //\u8bfb\u4f18\u4e0d\u89e3\u91ca\n{\n\tint x = 0, f = 1; char c = getchar();\n\twhile(!isdigit(c)) { if(c == '-') f = -1; c = getchar(); }\n\twhile(isdigit(c)) { x = x * 10 + c - '0'; c = getchar(); }\n\treturn x * f;\n}\n\nvoid addedge(int u, int v) //\u5efa\u8fb9\u4e0d\u89e3\u91ca\n{\n\tedge[k].v = v;\n\tedge[k].nxt = head[u];\n\thead[u] = k++;\n}\n\nvoid init() //\u8bfb\u5165\u6570\u636e\n{\n\tmemset(minn, 0x3f, sizeof(minn)); \n\tn = get();\n\tfor(int i = 1; i <= n; i++) val[i] = get();\n\tm = get();\n\tfor(int i = 1; i <= m; i++) addedge(get(), get());\n}\n\nvoid Tarjan(int u) //Tarjan\u6c42SCC\n{\n\tdfn[u] = low[u] = ++tim;\n\tins[u] = 1;\n\tst.push(u);\n\tfor(int i = head[u]; i; i = edge[i].nxt)\n\t{\n\t\tint v = edge[i].v;\n\t\tif(!dfn[v]) Tarjan(v), low[u] = min(low[u], low[v]);\n\t\telse if(ins[v]) low[u] = min(low[u], dfn[v]);\n\t}\n\tif(low[u] == dfn[u])\n\t{\n\t\tint l;\n\t\tcnt++;\n\t\tdo\n\t\t{\n\t\t\tl = st.top(); st.pop();\n\t\t\tins[l] = 0;\n\t\t\tcol[l] = cnt;\n\t\t\tif(val[l] < minn[cnt]) //\u5982\u679c\u51fa\u73b0\u4e00\u4e2a\u66f4\u4fbf\u5b9c\u7684\uff0c\u8bf4\u660e\u4e4b\u524d\u7edf\u8ba1\u7684\u90fd\u767d\u7edf\u8ba1\u4e86\uff0c\u8981\u6e05\u96f6\n\t\t\t{\n\t\t\t\tminn[cnt] = val[l];\n\t\t\t\tnum[cnt] = 1;\n\t\t\t}\n\t\t\telse if(val[l] == minn[cnt]) num[cnt]++; //\u5982\u679c\u76f8\u7b49\uff0c\u8bf4\u660e\u8fd9\u4e2a\u503c\u4e5f\u53ef\u80fd\u662f\u6700\u5c0f\u70b9\u6743\u3002\n\t\t} while(l != u);\n\t}\n}\n\nvoid Calc_SCC()\n{\n\tfor(int i = 1; i <= n; i++) if(!dfn[i]) Tarjan(i); //\u56fe\u53ef\u80fd\u4e0d\u8fde\u901a\uff0c\u6240\u4ee5\u8981\u679a\u4e3e\u6811\u6839\n}\n\nvoid solve()\n{\n\tCalc_SCC();\n\tint sum = 0, ans = 1; //\u548c\u7684\u521d\u503c\u4e3a0\uff0c\u79ef\u7684\u521d\u503c\u4e3a1\n\t/*\n\tprintf(\"cnt=%d\\n\", cnt);\n\tfor(int i = 0; i <= n; i++)\n\t{\n\t\tprintf(\"%d %d %d\\n\", col[i], num[col[i]], minn[col[i]]);\n\t}\n\t*/\n\tfor(int i = 1; i <= cnt; i++)\n\t{\n\t\tsum += minn[i]; //\u7d2f\u52a0\u548c\n\t\tans *= num[i]; //\u7d2f\u4e58\u79ef\n\t\tans %= Mod; //\u4e0d\u8981\u5fd8\u4e86\u53d6\u6a21\n\t}\n\tprintf(\"%d %d\", sum, ans);\n}\n\nint main()\n{\n\tinit();\n\tsolve();\n}\n```\n\n\u53e6\u5916\uff0c\u8fd9\u9898\u7684\u6570\u636e\u8c8c\u4f3c\u6709\u70b9\u95ee\u9898\u554a\uff1f\n\n\u6211\u4e00\u4e2a\u8fc7\u4e0d\u4e86\u6837\u4f8b\u4e00\u7684\u7a0b\u5e8f\uff08\u65f6\u95f4\u6233``++tim``\u5199\u6210``tim++``\uff09\u4ea4\u4e0a\u53bb\u670990pts\uff1f\u671b\u52a0\u5f3a\u3002",
        "postTime": 1559966839,
        "uid": 92254,
        "name": "Social_Zhao",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2194 \u3010HXY\u70e7\u60c5\u4fa3\u3011"
    },
    {
        "content": "## \u9898\u5916\u8bdd\n\u770b\u4e86\u770b\u90fd\u662fTarjan\u7684\u7b97\u6cd5\uff0c\u8fd9\u91cc\u6765\u4e2aKosaraju\u7684\u3002\n## Ad\n\u4e2a\u4eba\u535a\u5ba2\u9ad8\u6e05\u91cd\u5236\u7248\u540c\u6b65\uff1ahttp://www.cinema000.xyz/1544.ruby\n## \u5206\u6790\n\n\u5176\u5b9e\u8fd9\u91cc\u7b2c\u4e00\u95ee\u5c31\u662f\u6c42\u6bcf\u4e2aSCC\u7684\u6700\u5c0f\u6743\u503c\u7684\u548c\uff0c\u548c\u4e0e\u8fd9\u4e2a\u6700\u5c0f\u6743\u503c\u76f8\u7b49\u7684\u65b9\u6848\u6570\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u5728\u6c42SCC\u7684\u8fc7\u7a0b\u4e2d\u7ef4\u62a4\u6700\u5c0f\u503c\uff0c\u800c\u65b9\u6848\u6570\u53ef\u4ee5\u7528\u5206\u6b65\u8ba1\u6570\u539f\u7406\u6c42\u89e3\u3002\n\n## \u4ee3\u7801\n\nKosaraju\uff1a\n\n```cpp\n#include<cstdio>\n#include<vector>\n#include<algorithm>\nconst int MAXN = 100000 + 6;\nconst int INF = 0x7fffffff;\nint A[MAXN],ans[MAXN],ans2[MAXN];\nstruct Edge{int v,d;Edge(int v,int d){this -> v = v;this -> d = d;}Edge(){}};\nclass SCC{\npublic:\n\tstd::vector<Edge> G[MAXN],G2[MAXN];\n\tstd::vector<int> S;\n\tint SCCNo[MAXN],SCCCnt;\n\tbool hash[MAXN];\n\tvoid addEdge(int u,int v,int d){\n\t\tG[u].push_back(Edge(v,d));\n\t\tG2[v].push_back(Edge(u,d));\n\t}\n\tvoid dfs1(int u){\n\t\tif(hash[u]) return;\n\t\thash[u] = true;\n\t\tfor(int i = 0;i < G[u].size();i++) dfs1(G[u][i].v);\n\t\tS.push_back(u);\n\t}\n\tvoid dfs2(int u){\n\t\tif(SCCNo[u]) return;\n\t\tSCCNo[u] = SCCCnt;\n\t\tans[SCCNo[u]] = std::min(ans[SCCNo[u]],A[u]);\n\t\tfor(int i = 0;i < G2[u].size();i++) dfs2(G2[u][i].v);\n\t}\n\tvoid findSCC(int n){\n\t\tSCCCnt = 0;\n\t\tfor(int i = 1;i <= n;i++) dfs1(i);\n\t\tfor(int i = n - 1;i >= 0;i--) if(!SCCNo[S[i]]){SCCCnt++;dfs2(S[i]);}\n\t}\n};\n\nint main(){\n\tSCC s;\n\tstd::fill(ans,ans + MAXN,INF);\n\tint n;scanf(\"%d\",&n);\n\tfor(int i = 1;i <= n;i++) scanf(\"%d\",&A[i]);\n\tint m,u,v;scanf(\"%d\",&m);\n\twhile(m--){\n\t\tscanf(\"%d %d\",&u,&v);\n\t\ts.addEdge(u,v,666);\n\t}\n\ts.findSCC(n);\n\tlong long cnt1 = 0,cnt2 = 1;\n\tfor(int i = 1;i <= s.SCCCnt;i++) cnt1 += ans[i];\n\tfor(int i = 1;i <= n;i++) if(A[i] == ans[s.SCCNo[i]]) ans2[s.SCCNo[i]]++;\n\tfor(int i = 1;i <= s.SCCCnt;i++) cnt2 *= ans2[i] % (long long)(1e9 + 7);\n\t\n\tprintf(\"%lld %lld\",cnt1,cnt2);\n\t\n\treturn 0;\n}\n```\n\n",
        "postTime": 1534416815,
        "uid": 77211,
        "name": "i9_7980XE",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2194 \u3010HXY\u70e7\u60c5\u4fa3\u3011"
    },
    {
        "content": "[\u9898\u76ee](https://www.luogu.org/problem/P2194)\n\n\u8bf4\u5b9e\u8bdd\uff0c\u8fd9\u9898\u6211\u7b2c\u4e00\u904d\u6ca1\u505a\u51fa\u6765\uff0c\u53bb\u770b\u4e86\u9898\u89e3\uff0c\u7136\u800c\u770b\u4e86\u9898\u89e3\u7684\u6211\u773c\u6cea\u6389\u4e0b\u6765\uff0c\u600e\u4e48\u5927\u5bb6\u6700\u540e\u5f39\u6808\u7684\u8fc7\u7a0b\u5168\u90fd\u662f$do \\ while$\u554a,~~\u5e9f\u8bdd\uff0c\u90a3\u4e2a\u597d\u5199~~\uff0c\u4f46\u662f\u672c\u4eba\u6bd4\u8f83\u559c\u6b22$while$\uff0c\u6240\u4ee5\u5c31\u6765\u5199\u4e00\u5199\u60f9\n\n##### 1.\u8fd9\u9898\u8981\u5efa\u7acb\u7684\u662f\u5355\u5411\u8fb9\n\n\u5927\u5bb6\u4ed4\u7ec6\u5206\u6790\u6837\u4f8b\u8fd9\u662f\u5f88\u5bb9\u6613\u5c31\u53ef\u4ee5\u53d1\u73b0\u7684\n\n##### 2.\u591a\u79cd\u65b9\u6848\u60c5\u51b5\n\u4e00\u5f00\u59cb\uff0c\u6211\u4ee5\u4e3a\u591a\u79cd\u65b9\u6848\u5c31\u662f\u591a\u5c11\u79cd\u8d70\u6cd5~~\u4f60\u5230\u5e95\u770b\u6ca1\u770b\u9898\u76ee\u554a~~\u7136\u540e\u6211\u4eec\u53ef\u5b8c\u7f8e\u7684\u8fc7\u63892\u4e2a\u6837\u4f8b\u5e76\u4e14\u62ff\u5230$0$\u5206\u7684\u597d\u6210\u7ee9\uff0c\u7136\u540e\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u591a\u79cd\u65b9\u6848\u6570\u5176\u5b9e\u5c31\u662f\u5728\u4e00\u4e2a\u73af\u5185\uff0c\u6709\u591a\u4e2a\u70b9\u7684\u70b9\u6743\u76f8\u7b49\uff0c\u6b64\u65f6\u4e0d\u8bba\u4ece\u54ea\u4e2a\u70b9\u8d70\u4ed6\u4eec\u7684\u7b54\u6848\u90fd\u662f\u4e00\u6837\u7684\u3002\n##### 3.tarjan\u5f39\u6808\n\u867d\u7136$do \\ while$\u7801\u91cf\u6bd4\u8f83\u5c11\uff0c\u4f46\u662f\u6211\u5c31\u662f\u559c\u6b22$while$\uff0c\u6240\u4ee5\u6211\u5c31\u5199\u7684$while$\u4e00\u5f00\u59cb\u6211\u7684\u4ee3\u7801\u4e0d\u5bf9\uff0c\u8fd8\u4ee5\u4e3a\u662f\u8fd9\u91cc\u7684\u95ee\u9898\uff0c\u60f3\u627e\u7bc7\u9898\u89e3\u5eb7\u5eb7\u4eba\u5bb6\u600e\u4e48\u5199\u7684\uff0c\u7ed3\u679c\u6ca1\u627e\u5230$qwq$\n##### 4.\u7edf\u8ba1\u7b54\u6848\n\u636e\u8bf4\u8fd9\u9898\u4e0d\u53d6\u6a21\u4e5f\u80fd\u8fc7\u3002\u5176\u5b9e\u6211\u4eec\u5b8c\u5168\u4e0d\u5fc5\u8981\u53c8\u5f00\u6570\u7ec4\u6700\u540e\u53c8\u6765\u5faa\u73af\u7edf\u8ba1\u7b54\u6848\u4e4b\u7c7b\u7684,\u76f4\u63a5\u5f00\u5355\u4e2a\u53d8\u91cf\u7ef4\u62a4\u5c31\u597d\u4e86\u3002\u65b9\u6848\u6570\u7edf\u8ba1\u662f\u4e58\u6cd5\u539f\u7406\u3002\n\n\u8fd9\u91cc\u518d\u5bf9\u4e0a\u8fb9\u63d0\u7684$4$\u70b9\u518d\u7ed3\u5408\u4ee3\u7801\u8bb2\u4e00\u4e0b\n```cpp\n\n\tif(dfn[u] == low[u]) {\n\t\tgeshu = 0, \tminn = 0x3f3f3f3f;\n\t\twhile(stac[top] != u) {\n\t\t\tvis[stac[top]] = 0;\n\t\t\tif(w[stac[top]] < minn) minn = w[stac[top]], geshu = 0;\n\t\t\tif(w[stac[top--]] == minn) geshu++;\n\t\t}\n\t\ttop--, vis[u] = 0;\n\t\tif(w[u] < minn) minn = w[u], geshu = 1;\n\t\telse if(w[u] == minn) geshu++;\n\t\tans += minn;\n\t\tsum = (sum * geshu) % md;\n\t}\n```\n\n\u6211\u4eec$while$\u5faa\u73af\u7684\u6761\u4ef6\u662f\u6808\u9876\u4e0d\u7b49\u4e8e\u5f53\u524d\u7684\u8282\u70b9\uff0c\u6240\u4ee5\u5230\u4e86\u5f53\u524d\u7684\u8282\u70b9$u$\u7684\u65f6\u5019\u5c31\u4f1a\u505c\u4e0b\uff0c\u800c$u$\u53c8\u662f\u8fd9\u4e2a\u73af\u91cc\u7684\u5143\u7d20\uff0c\u6240\u4ee5\u6211\u4eec\u6700\u540e\u518d\u5bf9$u$\u5224\u65ad\u4e00\u4e0b\u5373\u53ef\uff0c$while$\u91cc\u7684\u6700\u540e\u4e24\u884c\uff0c\u662f\u66f4\u65b0\u6700\u5c0f\u503c\u5e76\u8bb0\u5f55\u6700\u5c0f\u503c\u7684\u6570\u91cf\u7684\uff0c\u5012\u6570\u7b2c\u4e8c\u884c\u628a\u4ed6\u53d8\u6210\u96f6\uff0c\u6700\u540e\u4e00\u4e2a\u884c\u53c8\u4f1a\u628a\u5b83\u53d8\u6210$1$\u4e86\uff0c\u6240\u4ee5\u4e0d\u7528\u62c5\u5fc3\u6ca1\u6709\u66f4\u65b0\u7684\u60c5\u51b5\uff0c\u5982\u679c\u6211\u4eec\u76f4\u63a5\u628a\u4ed6\u53d8\u6210$1$\u90a3\u6837\u6700\u540e\u4e00\u884c\u6309\u7406\u8bf4\u662f\u5e94\u8be5\u5199$else \\ if$\u4f46\u662f\u6211\u4eec\u5df2\u7ecf\u66f4\u65b0\u4e86\uff0c\u5982\u679c$geshu$\u52a0\u4e86\uff0c\u90a3\u53ea\u80fd\u8bf4\u660e\u8fd9\u4e2a\u70b9\u7684\u70b9\u6743\u548c\u4e0a\u4e00\u6b21\u66f4\u65b0\u4e4b\u524d\u7684\u4e00\u6837\uff0c\u8fd9\u6837\u5199\u5c31\u4f1a\u4f7f\u6211\u4eec\u7684$sum$\u6700\u540e\u53d8\u5927\n\nThe Last;\n```cpp\n#include <cstdio>\n#include <iostream>\nusing namespace std;\nconst int N = 1e6+7;\nconst int md = 1e9+7;\nint n, head[N << 1], cnt,  w[N], m, dfn[N], low[N], tot, top, stac[N], ans, minn, sum = 1, geshu;\nbool vis[N];\nstruct node {\n\tint nxt, to;\n}e[N << 1];\nint read() {\n\tint s = 0, w = 1;\n\tchar ch = getchar();\n\twhile(!isdigit(ch)) {if(ch == '-') w = -1; ch = getchar();}\n\twhile(isdigit(ch)) {s = s * 10 + ch - '0'; ch = getchar();}\n\treturn s * w;\n}\nvoid add(int x, int y) {\n\te[++cnt].nxt = head[x];\n\te[cnt].to = y;\n\thead[x] = cnt;\n}\nvoid tarjan(int u) {\n\tdfn[u] = low[u] = ++tot, stac[++top] = u, vis[u] = 1;\n\tfor(int i = head[u]; i; i = e[i].nxt) {\n\t\tint v = e[i].to;\n\t\tif(!dfn[v]) tarjan(v), low[u] = min(low[u], low[v]);\n\t\telse if(vis[v]) low[u] = min(low[u], dfn[v]); \n\t}\n\tif(dfn[u] == low[u]) {\n\t\tgeshu = 0, \tminn = 0x3f3f3f3f;\n\t\twhile(stac[top] != u) {\n\t\t\tvis[stac[top]] = 0;\n\t\t\tif(w[stac[top]] < minn) minn = w[stac[top]], geshu = 0;\n\t\t\tif(w[stac[top--]] == minn) geshu++;\n\t\t}\n\t\ttop--, vis[u] = 0;\n\t\tif(w[u] < minn) minn = w[u], geshu = 1;\n\t\telse if(w[u] == minn) geshu++;\n\t\tans += minn;\n\t\tsum = (sum * geshu) % md;\n\t}\n} \nint main() {\n\tn = read();\n\tfor(int i = 1; i <= n; i++) w[i] = read();\n\tm = read();\n\tfor(int i = 1, x, y; i <= m; i++) {\n\t\tx = read(), y = read();\n\t\tadd(x, y);\n\t}\n\tfor(int i = 1; i <= n; i++) \n\t\tif(!dfn[i]) tarjan(i);\n\tprintf(\"%d %d\\n\", ans, sum);\n\treturn 0;\n}\n```\n\u8c22\u8c22\u6536\u770b\uff0c\u795d\u8eab\u4f53\u5065\u5eb7\uff01",
        "postTime": 1572247597,
        "uid": 147646,
        "name": "lzpclxf",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2194 \u3010HXY\u70e7\u60c5\u4fa3\u3011"
    },
    {
        "content": "\u8fd9\u9898\u5176\u5b9e\u5c31\u662f\u9053\u6c42\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u6a21\u677f\u9898\u2026\u2026\u6211\u662f\u7528tarjan\u5199\u7684\u3002\u6c42\u5f3a\u8fde\u901a\u5206\u91cf\uff08SCC\uff09\u7684\u8fc7\u7a0b\u4e0d\u518d\u8d58\u8ff0\uff0c\u53ef\u81ea\u884c\u5bfb\u627e\u7f51\u4e0a\u8bba\u6587\u8fdb\u884c\u5b66\u4e60tarjan\u6c42\u5f3a\u8fde\u901a\u5206\u91cf\u7b97\u6cd5\u3002\u7136\u540e\u5c31\u4e0d\u96be\u4e86\uff0c\u6c42SCC\u7684\u65f6\u5019\u6bcf\u627e\u5230\u4e00\u4e2a\uff0c\u5c31\u8ba1\u7b97\u5f53\u524dSCC\u4e2d\u7684\u5404\u70b9\u7684\u6700\u5c0f\u503c\u53ca\u5176\u4e2a\u6570\uff0c\u7528\u4e58\u6cd5\u539f\u7406\u628a\u4e2a\u6570\u76f8\u4e58\u4f5c\u4e3aans1\uff0c\u7d2f\u52a0\u6700\u5c0f\u503c\u4f5c\u4e3aans2\u3002\n\n\u7136\u540e\u6309\u8981\u6c42\u8f93\u51fa\u5373\u53ef\u2026\u2026\n\n\n  \n```cpp\n#include<iostream>  \n#include<cstring>  \n#include<cstdio>  \n#include<algorithm>  \n#include<vector>  \n#include<string>  \n#include<set>  \n#include<queue>  \n#include<stack>  \n#include<map>  \n#include<cmath>  \n#include<cstdlib>  \n#define ll long long  \n#define maxn 100010  \n#define maxm 300010  \n#define hzy 1000000007  \n#define inf 1000000000  \nusing namespace std;  \ninline ll read()  \n{  \n    ll x=0,f=1;char ch=getchar();  \n    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}  \n    while(ch>='0'&&ch<='9'){x*=10;x+=ch-'0';ch=getchar();}  \n    return x*f;  \n}  \ninline void read(char *s,int &ts)  \n{  \n    char x=getchar();  \n    while(!(x>='a'&&x<='z'))x=getchar();  \n    while(x>='a'&&x<='z')s[++ts]=x,x=getchar();  \n}  \nusing namespace std;  \nstruct data{int to,next;}e[maxm];  \nint head[maxn];  \nint n,m,now,cnt,top;  \nint v[maxn],dfn[maxn],low[maxn],q[maxn];  \nint scc,mn[maxn],belong[maxn],num[maxn];  \nbool inq[maxn];  \nll ans1=1,ans2;  \nvoid dfs(int a)  \n{  \n    inq[a]=1;  \n    low[a]=dfn[a]=++cnt;  \n    q[++top]=a;  \n    int c=head[a];  \n    while(c)  \n    {  \n        if(!dfn[e[c].to])  \n        {  \n            dfs(e[c].to);  \n            low[a]=min(low[a],low[e[c].to]);  \n        }  \n        else if(inq[e[c].to])low[a]=min(low[a],dfn[e[c].to]);  \n        c=e[c].next;  \n    }  \n    if(low[a]==dfn[a])  \n    {  \n        scc++;  \n        belong[a]=scc;  \n        mn[scc]=inf;  \n        do  \n        {  \n            now=q[top--];  \n            inq[now]=0;  \n            belong[now]=scc;  \n            if(v[now]<mn[scc]){mn[scc]=v[now];num[scc]=0;}  \n            if(v[now]==mn[scc])num[scc]++;  \n        }  \n        while(now!=a);  \n    }  \n}  \nvoid tarjan()  \n{  \n    for(int i=1;i<=n;i++)  \n        if(!dfn[i])dfs(i);  \n}  \nint main()  \n{  \n    scanf(\"%d\",&n);  \n    for(int i=1;i<=n;i++)  \n        scanf(\"%d\",&v[i]);  \n    scanf(\"%d\",&m);  \n    for(int i=1;i<=m;i++)  \n    {  \n        int x,y;  \n        scanf(\"%d%d\",&x,&y);  \n        e[i].to=y;  \n        e[i].next=head[x];  \n        head[x]=i;  \n    }  \n    tarjan();  \n    for(int i=1;i<=scc;i++)  \n    {  \n       ans1*=num[i];ans2+=mn[i];  \n       ans1%=hzy;  \n    }  \n    printf(\"%I64d %I64d\\n\",ans2,ans1);  \n    return 0;  \n}\n```",
        "postTime": 1412435999,
        "uid": 270,
        "name": "caozy623",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2194 \u3010HXY\u70e7\u60c5\u4fa3\u3011"
    },
    {
        "content": "~~\u770b\u5230\u9898\u9762\u65f6\u6211\u8fd9\u4e2a\u5355\u8eab\u72d7\u7684\u7b2c\u4e00\u53cd\u5e94\u7adf\u7136\u662f\u597d~~\n\n\u8fd9\u9053\u9898\u5f88\u660e\u663e\uff0c\u662f\u9053\u5f3a\u8fde\u901a\uff08\u8981\u70e7\u5230\u51fa\u53d1\u70b9\uff09\u6240\u4ee5\u80af\u5b9a\u7528tarjan\uff0c\u6240\u4ee5\u7b2c\u4e00\u5c0f\u95ee\u5c31\u5f88\u7b80\u5355\u4e86\uff0c\u5c31\u662f\u4e00\u4e2a\u6a21\u677f\u5f3a\u8fde\u901a\u3002\n\n\u7b2c\u4e8c\u5c0f\u95ee\u4e5f\u5f88\u6c34\uff0c\u53ea\u9700\u8981\u7edf\u8ba1\u6bcf\u4e2a\u5f3a\u8fde\u901a\u5185\u6700\u5c0f\u82b1\u8d39\u7684\u6c7d\u6cb9\u6876\u6709\u591a\u5c11\u4e2a\uff0c\u518d\u5c06\u5404\u4e2a\u6743\u503c\u76f8\u4e58\u5373\u53ef\uff08\u4e58\u6cd5\u539f\u7406\uff09~~\u4e0d\u8981\u5fd8\u4e86\u53d6\u6a21\u54e6\uff08\u8840\u7684\u6559\u8bad\uff09~~\n\n\u53e6\u5916\uff0c\u9898\u5e72\u867d\u7136\u8bf4\u6ca1\u67090\uff0c\u4f46\u662f\u597d\u50cf\u6709\uff0c\u6240\u4ee5\u4e0d\u80fd\u8fd9\u6837\u6253\uff1a\n\n```\nif(s1[ma[a]]==s[a])\t  \ns2[ma[a]]++,s2[ma[a]]=s2[ma[a]]%1000000007;\nif(s1[ma[a]]>s[a])\ns2[ma[a]]=1,s1[ma[a]]=s[a];\n```\n\n\u597d\u4e86\uff0c\u4e0b\u9762\u662f\u6b63\u786e\u4ee3\u7801\uff0c\u7801\u98ce\u6709\u70b9\u5947\u7279\uff0c\u5927\u4f6c\u52ff\u55b7\n\n```\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cstring>\n#include<cmath>\n#include<stack>\nusing namespace std;\nlong long ans1,a,b,c,d,e,f,g,m,n,z,x,k1[500001],k2[500001],l,o,opt,head[500001],cnt,ans,ans2,dfn[500001],low[500001],mjc,vis[500001],ma[500001],in[500001],out[500001],s[100001],s1[100001],s2[100001];\nstack <int >p;\nvoid ab(int q,int w)\n{\n    cnt++;\n    k1[cnt]=head[q];\n    k2[cnt]=w;\n    head[q]=cnt;\n}\n\nvoid tarjin(int q)\n{\n    int w;\n    dfn[q]=low[q]=++mjc;\n    p.push(q);\n    vis[q]=1;\n    for(int i=head[q];i!=0;i=k1[i])\n    {\n        w=k2[i];\n        if(dfn[w]==0)\n        {\n            tarjin(w);\n            low[q]=min(low[q],low[w]);\n        }\n        else\n        if(vis[w])\n        low[q]=min(low[q],dfn[w]);\n    }\n    if(low[q]==dfn[q])\n    {\n\t\tans++;\n        while(q!=w)\n        {\n            w=p.top();\n            p.pop();\n            vis[w]=0;\n            ma[w]=ans;\n        }\n    }\n}\nint main ( )\n{\n    cin>>n;\n    for(int i=1;i<=n;i++)\n    scanf(\"%d\",&s[i]);\n    cin>>m;\n    for(int i=1;i<=m;i++)\n\t{\n\t\tscanf(\"%d%d\",&b,&c);\n\t\tif(b!=c)\n\t\tab(b,c);\n\t}\n    for(int i=1;i<=n;i++)\n    if(!dfn[i])\n    tarjin(i);\n    for(a=1;a<=ans;a++)\n\ts1[a]=999999999; \n  \tfor(a=1;a<=n;a++)\n  \t{\n  \t\t{\n  \t\t\tif(s1[ma[a]]==s[a])\n  \t\t\ts2[ma[a]]++,s2[ma[a]]=s2[ma[a]]%1000000007;\n  \t\t\tif(s1[ma[a]]>s[a])\n  \t\t\ts2[ma[a]]=1,s1[ma[a]]=s[a];\n  \t\t}\n  \t}\n  \tans1=0;ans2=1;\n  \tfor(a=1;a<=ans;a++)\n  \t{\n  \t\tans1+=s1[a];\n  \t\tans2*=s2[a]%1000000007;\n  \t}\n  \tif(ans1!=0)\n\tcout<<ans1<<' '<<ans2%1000000007;\n    return 0 ;\n}\n```\n\n~~\u70b9\u8d5e\u54e6~~",
        "postTime": 1595643542,
        "uid": 187923,
        "name": "liuyanxi2",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2194 \u3010HXY\u70e7\u60c5\u4fa3\u3011"
    },
    {
        "content": "## \u9898\u76ee\u94fe\u63a5\uff1a\n\n[P2194 HXY\u70e7\u60c5\u4fa3](<https://www.luogu.org/problem/P2194>)\n\n## \u9898\u76ee\u63cf\u8ff0\uff1a\n\n\u4f17\u6240\u5468\u77e5\uff0cHXY\u5df2\u7ecf\u52a0\u5165\u4e86FFF\u56e2\u3002\u73b0\u5728\u5979\u8981\u5f00\u59cb\u559c\uff08sang\uff09\u95fb\uff08xin\uff09\u4e50\uff08bing\uff09\u89c1\uff08kuang\uff09\u5730\u70e7\u60c5\u4fa3\u4e86\u3002\u8fd9\u91cc\u6709n\u5ea7\u7535\u5f71\u9662\uff0cn\u5bf9\u60c5\u4fa3\u5206\u522b\u5728\u6bcf\u5ea7\u7535\u5f71\u9662\u91cc\uff0c\u7136\u540e\u7535\u5f71\u9662\u91cc\u90fd\u6709\u6c7d\u6cb9\uff0c\u4f46\u662f\u8981\u4f7f\u7528\u5b83\u9700\u8981\u4e00\u5b9a\u7684\u8d39\u7528\u3002m\u6761\u5355\u5411\u901a\u9053\u8fde\u63a5\u76f8\u90bb\u7684\u4e24\u5bf9\u60c5\u4fa3\u6240\u5728\u7535\u5f71\u9662\u3002\u7136\u540eHXY\u6709\u4e2a\u7edd\u6280\uff0c\u5982\u679c\u5979\u80fd\u4ece\u4e00\u4e2a\u70b9\u5f00\u59cb\u70e7\uff0c\u6700\u540e\u56de\u5230\u8fd9\u4e2a\u70b9\uff0c\u90a3\u4e48\u70e7\u8fd9\u6761\u56de\u8def\u4e0a\u7684\u60c5\u4fa3\u7684\u8d39\u7528\u53ea\u9700\u8981\u8be5\u70b9\u7684\u6c7d\u6cb9\u8d39\u5373\u53ef\u3002\u5e76\u4e14\u6bcf\u5bf9\u60c5\u4fa3\u53ea\u9700\u70e7\u4e00\u904d\uff0c\u7535\u5f71\u9662\u53ef\u4ee5\u91cd\u590d\u53bb\u3002\u7136\u540e\u5979\u60f3\u82b1\u5c3d\u53ef\u80fd\u5c11\u7684\u8d39\u7528\u70e7\u6389\u6240\u6709\u7684\u60c5\u4fa3\u3002\u95ee\u6700\u5c11\u9700\u8981\u591a\u5c11\u8d39\u7528\uff0c\u5e76\u4e14\u5f53\u8d39\u7528\u6700\u5c11\u65f6\u7684\u65b9\u6848\u6570\u662f\u591a\u5c11\uff1f\u7531\u4e8e\u65b9\u6848\u6570\u53ef\u80fd\u8fc7\u5927\uff0c\u6240\u4ee5\u8bf7\u8f93\u51fa\u65b9\u6848\u6570\u5bf91e9+7\u53d6\u6a21\u7684\u7ed3\u679c\u3002\n\n\uff08\u6ce8\uff1a\u8fd9\u91ccHXY\u6bcf\u6b21\u53ef\u4ee5\u4ece\u4efb\u4f55\u4e00\u4e2a\u70b9\u5f00\u59cb\u8d70\u56de\u8def\u3002\u5c31\u662f\u8bf4\u4e00\u4e2a\u56de\u8def\u8d70\u5b8c\u4e86\uff0c\u4e0b\u4e00\u4e2a\u5f00\u59cb\u4f4d\u7f6e\u53ef\u4ee5\u4efb\u9009\u3002\u6240\u4ee5\u8bf4\u4e0d\u5b58\u5728\u70e7\u4e0d\u4e86\u6240\u6709\u60c5\u4fa3\u7684\u60c5\u51b5\uff0c\u5373\u4f7f\u56fe\u4e0d\u8fde\u901a\uff0cHXY\u81ea\u884c\u9009\u62e9\u9876\u70b9\u8fdb\u884c\u70e7\u60c5\u4fa3\u884c\u52a8\u3002\u4e14\u8d70\u8fc7\u7684\u9053\u8def\u53ef\u4ee5\u91cd\u590d\u8d70\u3002\uff09\n\n## \u89e3\u9898\u601d\u8def\uff1a\n\n\u9898\u76ee\u4e2d\u5199\u7684\u5f88\u6e05\u695a\uff0c\u8fd9\u9898\u76f4\u63a5\u5957\u4e00\u4e2a Tarjan \u5c31\u5b8c\u4e86\n\n\u73b0\u5728\u8ba8\u8bba\u4e00\u4e0b\u4e24\u4e2a\u95ee\u9898\uff1a\n\n1. \u6700\u5c11\u9700\u8981\u591a\u5c11\u8d39\u7528\n\n   \u8fd9\u4e2a\u6bd4\u8f83\u597d\u60f3\uff0c\u53ea\u8981\u5c06\u7f29\u70b9\u540e\u7684\u6bcf\u4e2a SCC \u6743\u503c\u53d8\u6210\u5176\u4e2d\u70b9\u6743\u6700\u5c0f\u7684\u5373\u53ef\n\n2. \u603b\u5171\u6709\u591a\u5c11\u65b9\u6848\n\n   \u8fd9\u4e2a\u6bd4\u8f83\u96be\u60f3\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u7ed3\u5408\u4e00\u4e0b\u4e58\u6cd5\u539f\u7406\u7684\u601d\u60f3\uff0c\u5c06\u6bcf\u4e2a SCC \u4e2d\u7684\u70b9\u6743\u7b49\u4e8e SCC \u7684\u70b9\u6743\u7684\u4e2a\u6570\u76f8\u4e58\n\n\u53ef\u80fd\u6709\u70b9\u7ed5\u53e3\uff0c\u6211\u4eec\u7528\u5f62\u5f0f\u5316\u7684\u8bed\u8a00\u6765\u63cf\u8ff0\u4e00\u4e0b\n\n\u8bb0 $siz_i$  \u4e3a $SCC_i$ \u4e2d\u70b9\u6743\u6700\u5c0f\u7684\u6743\u503c\uff0c $num_i$ \u4e3a $SCC_i$ \u4e2d\u70b9\u6743\u7b49\u4e8e\u6700\u5c0f\u70b9\u6743\u7684\u6743\u503c\u7684\u70b9\uff0c$cnt$ \u4e3a SCC \u6570\u91cf\n\n\u5219\u6709\n\n$$ans_1 = \\sum^{cnt}_{i=1}siz[i]$$\n\n$$ans_2 = \\prod^{cnt}_{i=1}num_i$$\n\n\u4fbf\u53ef\u5199\u51fa\u4ee3\u7801\n\n## \u4ee3\u7801\uff1a\n\n```cpp\n#include <cstring>\n#include <cstdio>\n#include <cctype>\n#include <cmath>\n#include <stack>\nusing std::stack;\n#define long long ll\n#define register int ri\n\nchar buf[1<<21],*p1=buf,*p2=buf;\ninline int gc(){return p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++;}\ninline int read() {\n\tchar v = gc();int x = 0,f = 1;\n\twhile (!isdigit(v)) {if (v == '-')f = -1;v = gc();}\n\twhile (isdigit(v)) {x = x * 10 + v - 48;v = gc();}\n\treturn x * f;\n}\nconst int N = 100001;\nconst int M = 500001;\nconst int INF = 0x3f3f3f3f;\n\nint to[M],hd[N],nxt[M],tot;\n\ninline void add(int u,int v) {to[++tot] = v;nxt[tot] = hd[u];hd[u] = tot;}\ninline void addedge(int u,int v) {add(u,v),add(v,u);}\n\ntemplate <typename T> inline T min(T x,T y) {return x<y?x:y;}\ntemplate <typename T> inline T max(T x,T y) {return x>y?x:y;}\n\nint dfn[N],low[N],c[N],cnt,num,siz[N],p[N],pre[N],ins[N],n,m,ans1,ans2 = 1;\nstack <int> s;\n\nvoid tarjan(int x) {\n\tdfn[x] = low[x] = ++cnt;\n\ts.push(x);ins[x] = 1;\n\tfor (int i = hd[x];i;i = nxt[i]) {\n\t\tif (!dfn[to[i]]) {\n\t\t\ttarjan(to[i]);\n\t\t\tlow[x] = min(low[x],low[to[i]]);\n\t\t}\n\t\telse if (ins[to[i]]) {\n\t\t\tlow[x] = min(low[x],dfn[to[i]]);\n\t\t}\n\t}\n\tif (dfn[x] == low[x]) {\n\t\tint y;c[x] = ++num;\n\t\tdo {\n\t\t\ty = s.top();c[y] = num;ins[y] = 0;s.pop();\n\t\t\tif (pre[y] < p[num]) {\n\t\t\t\tp[num] = pre[y];\n\t\t\t\tsiz[num] = 1;\n\t\t\t}\n\t\t\telse if (pre[y] == p[num]) {\n\t\t\t\t++siz[num];\n\t\t\t}\n\t\t}while (x != y);\n\t}\n}\n\nsigned main() {\n\tmemset(p,INF,sizeof(p));\n\tn = read();\n\tfor (int i = 1;i <= n;++i) pre[i] = read();\n\tm = read();\n\tfor (int i = 1;i <= m;++i) {\n\t\tint x = read(),y = read();add(x,y);\n\t}\n\tfor (int i = 1;i <= n;++i) {\n\t\tif (!dfn[i]) tarjan(i);\n\t}\n\tfor (int i = 1;i <= num;++i) {\n\t\tans1 += p[i];ans2 *= siz[i];\n\t}\n\tprintf(\"%d %d\",ans1,ans2);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1570805907,
        "uid": 105230,
        "name": "Retired_Doubeecat",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2194 \u3010HXY\u70e7\u60c5\u4fa3\u3011"
    },
    {
        "content": "\u8fd9\u4e2a\u9898\u53ef\u4ee5\u8bf4\u662ftarjan\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u88f8\u9898\uff0c\u4f46\u9700\u8981\u7ef4\u62a4\u6bcf\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u6700\u5c0f\u503c\uff0c\u6240\u4ee5\u505a\u6cd5\u5c31\u5f88\u660e\u786e\u4e86\u3002\n\n\u6211\u4eec\u5148\u660e\u786e\u51e0\u4e2a\u6570\u7ec4\u7684\u610f\u601d\uff1a\n\n1.\u9996\u5148\u662ftarjan\u7f29\u70b9\u4e2d\u7684\u51e0\u4e2a\u6570\u7ec4\uff1a\n   \n      dfn[i]:i\u70b9\u7684\u65f6\u95f4\u6233\n  \n      low[i]\uff0c\u8868\u793a\u8fd9\u4e2a\u70b9\u4ee5\u53ca\u5176\u5b50\u5b59\u8282\u70b9\u8fde\u7684\u6240\u6709\u70b9\u4e2ddfn\u6700\u5c0f\u7684\u503c\n  \n      stack[]\uff0c\u8868\u793a\u5f53\u524d\u6240\u6709\u53ef\u80fd\u80fd\u6784\u6210\u662f\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u70b9\u3002\n  \n      ins[i]\uff0c\u8868\u793a i \u662f\u5426\u5728stack[ ]\u6570\u7ec4\u4e2d\n      \n      num[i],\u8868\u793a\u7b2c i \u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u4e2d\u6709\u591a\u5c11\u4e2a\u70b9\n      \n      belong[i],\u8868\u793a\u7b2c i \u70b9\u5728\u54ea\u4e00\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u91cc\n      \n2.\u7136\u540e\u662f\u6211\u4eec\u7528\u6765\u7ef4\u62a4\u6700\u5c0f\u503c\u4ee5\u53ca\u6700\u5c0f  \u503c\u4e2a\u6570\u7684\u6570\u7ec4\n\n      minn[i]\uff0c\u8868\u793a\u7b2c i \u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u4e2d\u70b9\u6743\u7684\u6700\u5c0f\u503c\n      \n      sum[]:\u8868\u793a\u6700\u5c0f\u503c\u662f i \u7684\u6709\u591a\u5c11\u4e2a\n      \n      \n\u6700\u6700\u6700\u9700\u8981\u6ce8\u610f\u7684\u4e24\u521d\u59cb\u5316\uff1a\n\n1.ans2 \u9700\u8981\u521d\u59cb\u5316\u4e3a 1\n\n2.minn[i]\u8fd9\u4e2a\u6570\u7ec4\u8981\u521d\u59cb\u4e3a\u6b63\u65e0\u7a77\u3002\n\n\n```cpp\n#include <iostream>\n#include <cstring>\n#include <cstdio>\n#include <algorithm>\nusing namespace std;\nconst long long mod = 1e9 + 7;\nconst int maxn = 1e5 + 5;\nconst int maxm = 3e5 + 4;\n\nint n,m,a[maxn],x,y;\nstruct Edge{\n\tint to,next,val;\n}edge[maxm << 1];\nint head[maxn],tot;\nint dfn[maxn],low[maxn],ind;\nint stack[maxn],top,cnt,num[maxn],belong[maxn];\nbool ins[maxn];\nint ans1,ans2 = 1,minn[maxn],sum[maxn];\n\nvoid add(int u,int v){\n\tedge[++tot].to = v;\n\tedge[tot].next = head[u];\n\thead[u] = tot;\n}\n\ninline int read(){\n\tchar ch = getchar();\n\tint f = 1 , x = 0;\n\twhile(ch > '9' || ch < '0'){\n\t\tif(ch == '-') f = -1;\n\t\tch = getchar();\n\t}\n\twhile(ch <= '9' && ch >= '0'){\n\t\tx = x * 10 + ch - '0';\n\t\tch = getchar();\n\t}\n\treturn x * f;\n}\n\nvoid print(int x){\n\tif(x < 0){\n\t\tputchar('-');\n\t\tx = -x;\n\t}\n\tif(x > 9)  print(x / 10);\n\tputchar(x % 10 + '0');\n}\n\nvoid tarjan(int x){\n\tdfn[x] = low[x] = ++ind;\n\tins[x] = true;\n\tstack[++top] = x;\n\tfor(int i=head[x];i;i=edge[i].next){\n\t\tint v = edge[i].to;\n\t\tif(ins[v])  low[x] = min(low[x] , dfn[v]);\n\t\tif(!dfn[v]){\n\t\t\ttarjan(v);\n\t\t\tlow[x] = min(low[x] , low[v]);\n\t\t}\n\t}\n\tint k;\n\tif(dfn[x] == low[x]){\n\t\t++cnt;\n\t\tdo{\n\t\t\tk = stack[top];\n\t\t\tnum[cnt]++;\n\t\t\tins[k] = false;\n\t\t\tminn[cnt] = min(minn[cnt] , a[k]);\n\t\t\ttop--;\n\t\t\tbelong[k] = cnt;\n\t\t}  while(k != x);\n\t}\n}\n\nint main(){\n\tn = read();\n\tfor(int i=1;i<=n;i++){\n\t\ta[i] = read();\n\t}\n\tm = read();\n\tfor(int i=1;i<=m;i++){\n\t\tx = read();  y = read();\n\t\tadd(x,y);\n\t}\n\tfor(int i=1;i<=n;i++)\n\t   minn[i] = 1e9;\n\tfor(int i=1;i<=n;i++)\n\t  if(!dfn[i]) tarjan(i);\n\tfor(int i=1;i<=cnt;i++){\n\t\tans1 += minn[i];\n\t}\n\tprint(ans1);\n\tcout<<\" \";\n\tfor(int i=1;i<=n;i++)\n\t  if(a[i] == minn[belong[i]])\n\t    sum[belong[i]]++;\n\tfor(int i=1;i<=cnt;i++)\n\t  ans2 = ans2 * sum[i] % mod;\n\tprint(ans2);\n\treturn 0;\n}\n```",
        "postTime": 1536497177,
        "uid": 54635,
        "name": "Kevin_F",
        "ccfLevel": 0,
        "title": "HXY\u70e7\u60c5\u4fa3"
    },
    {
        "content": "## Description\n\n[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/P2194)\n\n## Solution\n\n\u86ee\u88f8\u7684\u4e00\u9053$tarjan$\u9898\u3002\n\n\u8003\u8651\u6bcf\u4e00\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\uff0c\u7edf\u8ba1\u70b9\u6743\u6700\u5c0f\u7684\u70b9\u7684\u6743\u503c\u548c\u70b9\u6743\u6700\u5c0f\u7684\u70b9\u7684\u4e2a\u6570\u3002\n\n\u90a3\u4e48\u6700\u5c11\u7684\u8d39\u7528\u5c31\u662f\u6bcf\u4e2a$SCC$\u91cc\u70b9\u6743\u6700\u5c0f\u70b9\u7684\u6743\u503c\u4e4b\u548c\uff0c\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c\u65b9\u6848\u6570\u5c31\u662f\u6bcf\u4e2a$SCC$\u91cc\u70b9\u6743\u6700\u5c0f\u7684\u70b9\u7684\u4e2a\u6570\u4e4b\u79ef\u3002\n\n\u505a\u6cd5\u4e0d\u96be\u60f3\uff0c\u5957\u4e2a$tarjan$\u8fd9\u9898\u5c31\u505a\u5b8c\u4e86\u3002\u4e0d\u8fc7\u8981\u6ce8\u610f\u4e24\u4e2a$ans$\u8981\u5f00$long$ $long$\uff0c$inf$\u4e5f\u8981\u5f00\u5927\uff0c\u4e0d\u7136\u4f1a\u7206\u70b8\u3002\n\n~~\u522b\u95ee\u6211\u600e\u4e48\u77e5\u9053\u7684\u4f1a\u70b8\u5c31\u5bf9\u4e86~~\n\n## Code\n```cpp\n#include <cmath>\n#include <stack>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\n#define maxn 1000005\n#define inf 1e9\n#define mod 1000000007\nusing namespace std;\n\nstruct node\n{\n\tint nxt, to;\n}edge[maxn << 2];\nlong long n, m, dfs_block, scc_cnt, tot, ans1, ans2 = 1;\nlong long siz[maxn], head[maxn], sccno[maxn], low[maxn], dfn[maxn], minn[maxn], sum[maxn], v[maxn];\nbool vis[maxn];\nstack<int> s;\n\ninline void addedge(int u, int v)\n{\n\tedge[++tot].nxt = head[u];\n\tedge[tot].to = v;\n\thead[u] = tot;\n}\n\ninline int read()\n{\n    int x=0,f=1;char ch=getchar();\n    while(ch<'0'||ch>'9')f=ch=='-'?-1:f,ch=getchar();\n    while(ch>='0'&&ch<='9')x=x*10+ch-'0',ch=getchar();\n    return x*f;\n}\n\nvoid tarjan(int u)\n{\n\tlow[u] = dfn[u] = ++dfs_block;\n\tvis[u] = true;\n\ts.push(u);\n\tfor (int i = head[u];i;i = edge[i].nxt)\n\t{\n\t\tint v = edge[i].to;\n\t\tif (!dfn[v])\n\t\t{\n\t\t\ttarjan(v);\n\t\t\tlow[u] = min(low[u], low[v]);\n\t\t}\n\t\telse if (vis[v])\n\t\t{\n\t\t\tlow[u] = min(low[u], dfn[v]);\n\t\t}\n\t}\n\tif (dfn[u] == low[u])\n\t{\n\t\tsccno[u] = ++scc_cnt;\n\t\tvis[u] = false;\n\t\tminn[scc_cnt] = inf;\n\t\tfor (;;)\n\t\t{\n\t\t\tint x = s.top();s.pop();\n\t\t\tsccno[x] = scc_cnt;\n\t\t\tvis[x] = false;\n\t\t\tif (v[x] < minn[scc_cnt])\n\t\t\t{\n\t\t\t\tminn[scc_cnt] = v[x];\n\t\t\t\tsum[scc_cnt] = 0;\n\t\t\t}\n\t\t\tif (v[x] == minn[scc_cnt]) sum[scc_cnt]++;\n\t\t\tif (x == u) break;\n\t\t}\n\t}\n}\n\nint main(void)\n{\n\tn = read();\n\tfor (int i = 1;i <= n;i++)\n\t\tv[i] = read();\n\tm = read();\n\tfor (int i = 1;i <= m;i++)\n\t{\n\t\tint u = read(), v = read();\n\t\taddedge(u, v);\n\t}\n\tfor (int i = 1;i <= n;i++)\n\t\tif (!dfn[i]) tarjan(i);\n\tfor (int i = 1;i <= scc_cnt;i++)\n\t{\n\t\tans1 += minn[i];\n\t\tans2 *= sum[i];\n\t\tans2 %= mod;\n\t}\n\tcout << ans1 << \" \" << ans2 << endl;\n\treturn 0;\n}\n```\n",
        "postTime": 1590256660,
        "uid": 246019,
        "name": "_came11ia_",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2194 \u3010HXY\u70e7\u60c5\u4fa3\u3011"
    },
    {
        "content": "[\u53cc\u500d\u7ecf\u9a8c](https://www.luogu.com.cn/problem/CF427C)\n\n\u8fd9\u9053\u9898\u4e0eCF\u7684CF427C Checkposts\u5341\u5206\u76f8\u4f3c\n\n\u8fd9\u9053\u9898\u96be\u5ea6\u5e76\u4e0d\u5927\uff0c\u53ea\u8981\u4f1a\u5f3a\u8fde\u901a\u5206\u91cf\u57fa\u672c\u4e0a\u90fd\u80fdAC\u3002\n\n\u5f3a\u8fde\u901a\u5206\u91cf\u8bb2\u89e3[\u770b\u8fd9\u91cc](https://183473.blog.luogu.org/tarjan-qiang-lian-tong-fen-liang)\n\n\u6211\u4eec\u5206\u6b65\u6765\u770b\uff1a\n\n\u9996\u5148\uff0c\u4ed6\u8ba9\u6211\u4eec\u627e\u6700\u5c0f\u503c\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6c42\u5f3a\u8fde\u901a\u5206\u91cf\u662f\u7ed9\u6bcf\u4e00\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u5148\u4ed8\u4e00\u4e2a\u6700\u5927\u503c\uff0c\u7136\u540e\u5728\u548c\u5c5e\u4e8e\u8fd9\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u70b9\u4e00\u4e00\u6bd4\u8f83\uff0c\u53d6\u6700\u5c0f\u503c\u5373\u53ef\u3002\n\n```\ncost_last[numb]=min(cost_last[numb],cost[q]);\n```\n\ncost_last[numb]\u4e3a\u7b2cnumb\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u6700\u5c0f\u503c\uff0ccost[q]\u4e3a\u5c5e\u4e8e\u7b2cnumb\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u70b9q\u7684\u82b1\u8d39\u3002\n\n\u5176\u6b21\u9898\u76ee\u8ba9\u6211\u4eec\u6c42\u6709\u51e0\u79cd\u82b1\u8d39\u76f8\u540c\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u53ef\u4ee5\u53bb\u627e\u6bcf\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u662f\u5426\u6709\u82b1\u8d39\u4e00\u6837\u7684\u70b9\uff0c\u5982\u679c\u6709\u5c31\u7d2f\u4e58\uff0c\u4e00\u76f4\u4e58\u9053\u6700\u540e\uff0c\u522b\u5fd8\u4e86mod1000000007\u3002\n\n\u6e29\u99a8\u63d0\u793a\uff1a\n\n# long long\n\n\u8bf7\u8bb0\u4f4f\u4e0d\u5f00long long\u89c1zz\uff0c\u591a\u5f00long long\u89c1zz\u3002\n\n\u6700\u540e\u8d34\u4e0a\u4ee3\u7801\uff1a\n\n```\n#include<bits/stdc++.h>\n#define MAX 0x3f3f3f3f\nusing namespace std;\nconst int M= 1e5 + 10;\nconst int mod=1000000007; \ninline int read()\n{\n\tint x=0,f=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9')\n\t{\n\t\tif(ch=='-')\n\t\tf=-1;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0'&&ch<='9')\n\t{\n\t\tx=(x<<1)+(x<<3)+(ch^48);\n\t\tch=getchar();\n\t}\n\treturn x*f;\n}\nvector<int> m[M];\nvector<int> fe[M];\nstack<int> st;\nbool inst[M];\nint n,q,low[M],dfn[M],num;\nint a,b,numb;\nlong long cost_last[M],cost[M],last_sum,latlat;\nint nums[M],tot;\nvoid tarjan(int x)\n{\n\tdfn[x]=low[x]=++num;\n\tinst[x]=true;\n\tst.push(x);\n\tfor(int i=0;i<m[x].size();i++)\n\t{\n\t\tint next=m[x][i];\n\t\tif(dfn[next]==0)\n\t\t{\n\t\t\ttarjan(next);\n\t\t\tlow[x]=min(low[x],low[next]);\n\t\t}\n\t\telse if(inst[next]==1)\n\t\t{\n\t\t\tlow[x]=min(low[x],dfn[next]);\n\t\t}\n\t}\n\tif(dfn[x]==low[x])\n\t{\n\t\tnumb++;\n\t\tint q;\n\t\tdo\n\t\t{\n\t\t\tq=st.top();\n\t\t\tst.pop();\n\t\t\tinst[q]=false;\n\t\t\t//bl[q]=numb;\n\t\t\tcost_last[numb]=min(cost_last[numb],cost[q]);\n\t\t\tfe[numb].push_back(q);\n\t\t}while(q!=x);\n\t}\n}\nint main() \n{\n\tlatlat=1;\n\ttot=0;\n\tmemset(cost_last,21474836,sizeof(cost_last)) ;\n\tn=read();\n\tfor(int i=1;i<=n;i++)\n\tcost[i]=read();\n\tq=read();\n\tfor(int i=1;i<=q;i++)\n\t{\n\t\ta=read();b=read();\n\t\tm[a].push_back(b);\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tif(dfn[i]==0)\n\t\ttarjan(i);\n\tfor(int i=1;i<=numb;i++)\n\t{\n\t\tlast_sum+=cost_last[i];\n\t}\n\tcout<<last_sum<<\" \";\n\tfor(int i=1;i<=numb;i++)\n\t{\n\t\tfor(int j=0;j<fe[i].size();j++)\n\t\t{\n\t\t\tif(cost[fe[i][j]]==cost_last[i])\n\t\t\ttot++;\n\t\t}\n\t\tlatlat=(latlat*tot)%mod;\n\t\ttot=0;\n\t}\n\tcout<<latlat;\n\treturn 0;\n}\n```\n",
        "postTime": 1585093735,
        "uid": 183473,
        "name": "PrincessYR\u2728\uff5e",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2194 \u3010HXY\u70e7\u60c5\u4fa3\u3011"
    },
    {
        "content": "\u9898\u9762\u4e2d,  \n\u56de\u8def\u7b49\u4ef7\u4e8e\u5f3a\u8fde\u901a\u5206\u91cf  \n\u65b9\u6848\u4e4b\u95f4\u7684\u533a\u522b\u5728\u4e8e\u4e0d\u540c\u56de\u8def\u9009\u62e9\u7684\u8d77\u70b9  \n\u56e0\u6b64\u6700\u5c0f\u4ee3\u4ef7\u7b49\u4e8e\u6bcf\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u6700\u5c0f\u4ee3\u4ef7\u70b9\u4e4b\u548c  \n\u65b9\u6848\u6570\u7b49\u4e8e\u6bcf\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u6700\u5c0f\u70b9\u6743\u70b9\u7684\u4e2a\u6570\u4e4b\u79ef  \n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n\nusing namespace std;\n\nconst int maxn = 123456, maxm = 345678, inf = 2147483647, p = 1000000007;\ntypedef long long ll;\n\nint cost[maxn];\nint head[maxn], ver[maxm], nex[maxm], tot;\ninline void addedge(int u, int v) {\n\tver[tot] = v; nex[tot] = head[u]; head[u] = tot++;\t\n}\n\nint dfn[maxn], low[maxn], minCost[maxn], co[maxn], num[maxn], sta[maxn], col = 1, dfs_clock = 1, top;\nvoid tarjan(int cur) {\n\tdfn[cur] = low[cur] = dfs_clock++;\n\tsta[top++] = cur;\n\tfor(int i = head[cur]; ~i; i = nex[i]) {\n\t\tif(!dfn[ver[i]]) {\n\t\t\ttarjan(ver[i]);\n\t\t\tlow[cur] = min(low[cur], low[ver[i]]);\t\n\t\t} else if(!co[ver[i]]) {\n\t\t\tlow[cur] = min(low[cur], dfn[ver[i]]);\n\t\t}\n\t}\n\tif(dfn[cur] == low[cur]) {\n\t\tminCost[col] = cost[cur]; num[col] = 1;\n\t\twhile(sta[--top] != cur) {\n\t\t\tco[sta[top]] = col;\n\t\t\tif(cost[sta[top]] < minCost[col]) {\n\t\t\t\tminCost[col] = cost[sta[top]];\n\t\t\t\tnum[col] = 1;\n\t\t\t} else if(cost[sta[top]] == minCost[col]) {\n\t\t\t\t++num[col];\t\n\t\t\t}\n\t\t}\n\t\tco[cur] = col++;\n\t}\n}\n\nint main() {\n\tmemset(head, -1, sizeof(head));\n\tint n, m, u, v;\n\tscanf(\"%d\", &n);\n\tfor(int i = 1; i <= n; ++i) scanf(\"%d\", cost + i);\n\tscanf(\"%d\", &m);\n\twhile(m--) {\n\t\tscanf(\"%d %d\", &u, &v);\n\t\taddedge(u, v);\n\t}\n\tfor(int i = 1; i <= n; ++i)\n\t\tif(!co[i])\n\t\t\ttarjan(i);\n\tll ansCost = 0, ansNum = 1;\n\tfor(int i = 1; i < col; ++i) {\n\t\tansCost += minCost[i];\n\t\tansNum = ansNum * num[i] % p;\n\t}\n\tprintf(\"%lld %lld\\n\", ansCost, ansNum);\n\treturn 0;\n}\n```",
        "postTime": 1580099393,
        "uid": 88735,
        "name": "\u5bd2\u9e3d\u513f",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2194 \u3010HXY\u70e7\u60c5\u4fa3\u3011"
    },
    {
        "content": "\u9898\u610f\uff1a\u770b\u5b8c\u8fd9\u4e2a\u9898\u76ee\u89c9\u5f97\u662f\u5f3a\u8054\u901a\u6ca1\u95ee\u9898\uff0c\u95ee\u9898\u5728\u4e8e\u9700\u4e0d\u9700\u8981\u7f29\u70b9\u91cd\u65b0\u5efa\u56fe\uff0c\u540e\u6765\u53d1\u73b0\u9898\u76ee\u8bf4\uff08\u53ef\u4ee5\u4ece\u4efb\u4f55\u4e00\u4e2a\u70b9\u5f00\u59cb\u8d70\u56de\u8def\uff09\uff0c\u6240\u4ee5\u5c31\u6ca1\u5fc5\u8981\u4e86\u3002\u76f4\u63a5\u4e0a\u624b\u8dd1\u5f3a\u8054\u901a\u5206\u91cf\uff0c\u540c\u65f6\u8bb0\u5f55\u6bcf\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u91cc\u9762\u6700\u5c0f\u503c\u7684\u5927\u5c0f\u548c\u5143\u7d20\u4e2a\u6570\u3002\u6700\u540e\u4e2a\u6570\u76f8\u4e58\uff0c\u5143\u7d20\u76f8\u52a0\u3002\u8f93\u51fa\u5c31\u597d\u4e86\uff0c\u6ca1\u5fc5\u8981\u5f00Long Long\u3002\u3002\u76f4\u63a5\u7ed9\u51fa\u4ee3\u7801\uff1a\uff08\u5218\u6c5d\u4f73\u7248tarjain\uff09\n```c\n#include<bits/stdc++.h>\n#pragma GCC optimize(2)\n#define MAXN 100010\n#define maxnode 50010\n#define sigma_size 26\n#define md 1000000007\n#define INF 0x3f3f3f3f\nusing namespace std;\ntypedef long long LL;\n\nint n,m,u,v;\nint val[MAXN];\nvector<int> G[MAXN];\nint pre[MAXN],lowlink[MAXN],sccno[MAXN],dfs_clock,scc_cnt;\nstack<int> S;\n\nvoid dfs(int u)\n{\n    S.push(u);\n    pre[u]=lowlink[u]=++dfs_clock;\n    for(int i=0;i<G[u].size();i++)\n    {\n        int v=G[u][i];\n        if(!pre[v])\n        {\n            dfs(v);\n            lowlink[u]=min(lowlink[u],lowlink[v]);\n        }\n        else if(!sccno[v])\n        {\n            lowlink[u]=min(lowlink[u],pre[v]);\n        }\n    }\n    if(pre[u]==lowlink[u])\n    {\n        ++scc_cnt;\n        for(;;)\n        {\n            int x=S.top();\n            S.pop();\n            sccno[x]=scc_cnt;\n            if(x==u)\n                break;\n        }\n    }\n}\n\nvoid Find_scc(int n)\n{\n    memset(pre,0,sizeof(pre));\n    memset(sccno,0,sizeof(sccno));\n    dfs_clock=scc_cnt=0;\n    for(int i=1;i<=n;i++)\n    {\n        if(!pre[i])\n            dfs(i);\n    }\n    int maxn[MAXN],num[MAXN];\n    memset(maxn,INF,sizeof(maxn));\n    for(int i=1;i<=n;i++)\n    {\n        int tg=sccno[i];\n        if(val[i]<maxn[tg])                                          //\u5728\u6bcf\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u91cc\u9762\u627e\u5230\u6700\u5c0f\u503c\n        {\n            maxn[tg]=val[i];                                          //\u8bb0\u5f55\u6700\u5c0f\u503c\n            num[tg]=1;                                                   //\u6b64\u65f6\u7684\u6570\u91cf\u7f6e\u4e3a1\n        }\n        else if(val[i]==maxn[tg])                             //\u5982\u679c\u8fd9\u4e2a\u70b9\u662f\u6240\u5728\u5f3a\u8fde\u901a\u7684\u6700\u5c0f\u503c\n        {\n            num[tg]++;                                                   //\u8ba1\u6570\u503c\u76f4\u63a5\u52a0\u4e00\n        }\n    }\n    int sum=0,ans=1;\n    for(int i=1;i<=scc_cnt;i++)\n    {\n        sum+=maxn[i];\n        ans*=num[i];\n        ans%=md;\n    }\n    printf(\"%d %d\\n\",sum,ans);\n}\n\nint main()\n{\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;i++)\n        scanf(\"%d\",&val[i]);\n    scanf(\"%d\",&m);\n    for(int i=1;i<=m;i++)\n    {\n        scanf(\"%d %d\",&u,&v);\n        G[u].push_back(v);\n    }\n    Find_scc(n);\n    return 0;\n}\n\n```\n",
        "postTime": 1574909959,
        "uid": 210155,
        "name": "abandentsky",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2194 \u3010HXY\u70e7\u60c5\u4fa3\u3011"
    },
    {
        "content": "~~\u8fd9\u9053\u9898\u770b\u5230\u673a\u623fdalao\u505a\uff0c4\u904d\u624dA\u6389\uff0c\u7136\u540e\u6211\u4e5f\u505a\u4e86\u4e00\u4e0b\uff0c\u4e00A,\u6570\u636e\u4e5f\u592a\u6c34\u4e86\u3002\u3002\u3002\u3002~~\n\ncsp\u524d\u9893\u5e9f\u53d1\u9898\u89e3\n\n\u8fdb\u5165\u6b63\u9898\uff1a\n\n1.\u9996\u5148\u8bfb\u5b8c\u9898\u53ef\u4ee5\u7684\u51fa\u8fd9\u662f\u4e00\u9053\u7f29\u70b9\u7684\u6a21\u677f\u3002\n\n2.\u7136\u540e\u53ef\u4ee5\u6253\u5b8cTarjan\u7248\u5b50\n\n3.\u663e\u7136\uff0c\u6bcf\u4e2a\u73af\u7684\u8d39\u7528\u5373\u4e3a\u73af\u4e2d\u8d39\u7528\u7684\u6700\u5c0f\u503c\uff0c\u5982\u679c\u6ca1\u73af\u5219\u8d39\u7528\u4e3a\u81ea\u5df1\u7684\u8d39\u7528\n\n4.\u7136\u540e\u6700\u5c0f\u8d39\u7528\u5373\u4e3a\u6240\u6709\u5f3a\u8fde\u901a\u7684\u6700\u5c0f\u8d39\u7528\u548c\n\n5.\u5982\u4f55\u5904\u7406\u65b9\u6848\u4e2a\u6570\u5462\uff1f\u6211\u6bd4\u8f83\u61d2\uff0c\u6240\u4ee5\u5f00\u4e86\u4e00\u4e2amap\uff0c\u5c06\u4e00\u4e2a\u73af\u4e2d\u6bcf\u4e2a\u70b9\u7684\u8d39\u7528\u7684\u76f4\u79bb\u6563\u5230map\u4e2d\u7136\u540e\u6bcf\u4e2a\u73af\u4e2d\u6700\u5c0f\u8d39\u7528\u51fa\u73b0\u7684\u4e2a\u6570\u76f8\u4e58\u5373\u4e3a\u65b9\u6848\u6570\n\n6.\u5176\u5b9emap\u6bd4\u8f83\u6162\uff0c\u5982\u679c\u8981\u8ffd\u6c42\u66f4\u5febO\uff081\uff09\u5b58\u8d39\u7528\u7684\u53ef\u4ee5\u5148\u628a\u8d39\u7528\u79bb\u6563\u5316\u4e00\u4e0b\uff0c\u7136\u540e\u5373\u53ef\uff0c\u8fd9\u91cc\u5c31\u4e0d\u5199\u79bb\u6563\u5316\u4ee3\u7801\u4e86\uff08\u4e3a\u4ec0\u4e48\uff1f\u56e0\u4e3a\u6211\u61d2\u3002\u3002\uff09\n\n\u5176\u5b9e\u8fd9\u6837\u7684\u9898\u9002\u5408\u9893\u5e9f\u65f6\u5237\uff0c\u601d\u7ef4\u91cf\u5c0f\uff0c\u4ee3\u7801\u597d\u6253\u4e5f\u597d\u8c03\u3002\u3002\n\n\u8be6\u7ec6\u6ce8\u91ca\u5728\u4ee3\u7801\u4e2d\n\ncode\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <map>\n#define Re register\nusing namespace std;\n\nconst int mod = 1e9 + 7;\nconst int maxn = 3e5 + 10;\n\nmap<int, int>M; \n\nint n, m, u, v, w;\nint cnt, tim, top, ans, sum;\nint head[maxn], a[maxn];\nint dfn[maxn], low[maxn], sd[maxn], stc[maxn], size[maxn], val[maxn], rht[maxn];\nbool vis[maxn];\n\n//dfn[], low[], sd[], stc[], vis[]\u4e3a\u7f29\u70b9\u4e13\u7528\u6570\u7ec4\uff1b\n//size[]\u8fd9\u91cc\u5176\u5b9e\u6ca1\u5565\u7528\uff0c\u5c31\u662f\u987a\u624b\u6253\u4e0a\u7684\uff0c\u53ef\u4ee5\u8bb0\u5f55\u6bcf\u4e2a\u5f3a\u8fde\u901a\u4e2d\u7684\u70b9\u7684\u4e2a\u6570\n//val[]\u8bb0\u5f55\u6bcf\u4e2a\u5f3a\u8fde\u901a\u4e2d\u7684\u6700\u5c0f\u503c\n//rht[]\u8bb0\u5f55\u6bcf\u4e2a\u5f3a\u8fde\u901a\u4e2d\u4e0e\u6700\u5c0f\u503c\u76f8\u7b49\u7684\u70b9\u7684\u4e2a\u6570\n\nstruct Edge{\n\tint u, v, w, next;\n\tEdge(int _u, int _v, int _nxt){\n\t\tthis -> u = _u;\n\t\tthis -> v = _v;\n\t\tthis -> next = _nxt;\n\t}Edge(){}\n}e[maxn << 1];//\u636e\u8bf4\u6307\u9488\u6bd4\u8f83\u5feb\u3002\n\n\ninline int Min (int x,int y){\n\treturn (x < y) ? x : y;\n}//\u6bd4\u8f83\u559c\u6b22\u624b\u5199Min\n\nvoid add (int u, int v){\n\te[++cnt] = Edge(u, v, head[u]);\n\thead[u] = cnt;\n}\n\nint f_;\nchar ch_;\ntemplate <class T>\n\tinline T read (T &x_){\n\t\tx_ = 0, f_ = 1, ch_ = getchar();\n\t\twhile (ch_ > '9' || ch_ < '0'){if (ch_ == '-') f_ = -1; ch_ = getchar();}\n\t\twhile (ch_ >= '0' && ch_ <= '9') x_ = (x_ << 3) + (x_ << 1) + ch_ - 48, ch_ = getchar();\n\t\treturn x_ *= f_;\n\t}\n\t\nvoid Tarjan(int x){\n\tdfn[x] = low[x] = ++tim;\n\tstc[++top] = x;\n\tvis[x] = 1;\n\tfor (Re int i = head[x];i;i = e[i].next){\n\t\tint y = e[i].v;\n\t\tif (!dfn[y]){\n\t\t\tTarjan(y);\n\t\t\tlow[x] = Min (low[x], low[y]);\n\t\t}\n\t\telse if (vis[y])\n\t\t\t\tlow[x] = Min (low[x], dfn[y]);\n\t}\n\tif (dfn[x] == low[x]){\n\t\tint y;\n\t\tval[x] = a[x];\n\t\twhile (y = stc[top--]){\n\t\t\tsd[y] = x;\n\t\t\tvis[y] = 0;\n\t\t\tsize[x]++;//\u8bb0\u5f55\u5f3a\u8fde\u901a\u4e2d\u70b9\u7684\u4e2a\u6570\n\t\t\tval[x] = Min (val[x], a[y]);//\u5c31\u5f3a\u8fde\u901a\u7684\u6700\u5c0f\u8d39\u7528\n            M[a[y]]++;//\u79bb\u6563\u5230map\u4e2d\n\t\t\tif (x == y) break;\n\t\t}\n\t\trht[x] = M[val[x]];//\u8bb0\u5f55\u4e0e\u6700\u5c0f\u503c\u76f8\u7b49\u7684\u70b9\u7684\u4e2a\u6570\n\t\tM.clear();//\u6e05\u7a7amap\n\t}\n}\n\nint main(){\n\tread(n);\n\tfor (Re int i = 1;i <= n; ++i) read(a[i]);\n\tread(m);\n\tfor (Re int i = 1;i <= m; ++i){\n\t\tread(u); read(v);\n\t\tadd (u, v);\n\t}\n\tfor (Re int i = 1;i <= n; ++i){\n\t\tif (!dfn[i]) Tarjan(i);\n\t}\n\tsum = 1;//sum\u8bb0\u5f55\u65b9\u6848\u6570\n\tfor (Re int i = 1;i <= n; ++i){\n\t\tif (sd[i] != i) continue;//\u82e5\u7b49\u4e8ei\uff0c\u5219\u8bf4\u660e\u5b83\u5c31\u662f\u5f3a\u8fde\u901a\u7684\u5934\n\t\tans += val[i];\n\t\tif (size[i] == 1) continue;\n\t\tsum *= rht[i]; //\u6c42\u65b9\u6848\u6570\n\t\tsum %= mod;\n\t}\n\tprintf (\"%d \", ans);\n\tprintf (\"%d\\n\", sum);\n\treturn 0;\n}\n```\n\n\u6709\u95ee\u9898\u53ef\u4ee5\u79c1\u4fe1\u6211\uff0c\u770b\u5230\u5b9a\u56de\u590d\u3002\n\n\u795d\u5927\u5bb6CSP RP++;\n\n\u65e5\u62f1\u4e00\u5352\uff0c\u529f\u4e0d\u5510\u6350\uff01\n",
        "postTime": 1571838609,
        "uid": 168317,
        "name": "Last_Reincarnation",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2194 \u3010HXY\u70e7\u60c5\u4fa3\u3011"
    },
    {
        "content": "\u6570\u7ec4**Tarjan**![](https://cdn.luogu.com.cn/upload/pic/1436.png)\n\nnumm[]\u548chh[]\u5206\u522b\u5b58\u65b9\u6848\u548c\u8d39\u7528\n\n\n```c\n#include\"iostream\"\n#include\"cstring\"\nusing namespace std;\n#define inf 1e9\nconst int mod=1e9+7;\nconst int N = 310000;\nconst int M = 210000+100000;\nint dfn[M],low[M],vv[M];\nint be[M],hh[M],st[M],numm[M];\nint fir[M],next[M],to[M];\nbool co[N];\nlong long ans1=1,ans2=0;\nint ss,n,m,now,cnt,tot,sc;\nvoid tarjan(int u)\n{\n\tdfn[u]=low[u]=++cnt;\n\tst[++tot]=u;\n\tco[u]=1;\n\tfor(int i=fir[u];i;i=next[i])\n\t{//**\u8fd9\u91cc**\n\t\tint v=to[i];\n\t\tif(!dfn[v])\n\t\t{\n\t\t\ttarjan(v);\n\t\t\tlow[u]=min(low[u],low[v]);\n\t\t}\n\t\telse \n\t\tif(co[v])\n\t\tlow[u]=min(low[u],dfn[v]);\n\t}\n\tif(low[u]==dfn[u])\n\t{\n\t\tsc++;\n\t\tbe[u]=sc;\n\t\thh[sc]=inf;\n\t\tdo\n\t\t{\n\t\t\tnow=st[tot--];\n\t\t\tco[now]=0;\n\t\t\tbe[now]=sc;\n\t\t\tif(vv[now]<hh[sc])\n\t\t\t{\n\t\t\t\thh[sc]=vv[now];\n\t\t\t\tnumm[sc]=0;\n\t\t\t}\n\t\t\tif(vv[now]==hh[sc])numm[sc]++;\n\t\t}\n\t\twhile(now!=u);\n\t}\n}\nvoid uu(int x,int y)\n{\n\tto[++ss]=y;\n\tnext[ss]=fir[x];\n\tfir[x]=ss;\n}\nint main()\n{\n\t//memset(fir,-1,sizeof(fir));//\u5982\u679c\n                              //\u8d4b\u503c\u5219\u51fd\u6570\u5faa\u73af\u201ci\u201d\u6539\u4e3a\u201ci\uff01=-1\u201d\uff1b\n\tcin>>n;\n\tfor(int i=1;i<=n;i++)\n\tcin>>vv[i];\n\tcin>>m;\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint x,y;\n\t\tcin>>x>>y;\n\t\tuu(x,y);\n\t}\n\t for(int i=1;i<=n;i++)\n        if(!dfn[i]) tarjan(i);\n\t\n\tfor(int i=1;i<=sc;i++)\n\t{\n\t\tans1*=numm[i];//ans1\u521d\u59cb1\uff08\u4e58\u6cd5\u3002\uff09\n\t\tans2+=hh[i];\n\t\tans1%=mod;\n\t}\n\tcout<<ans2<<\" \"<<ans1;\n\treturn 0;\n}\n```\n\u770b\u4e0d\u61c2\u7ed3\u6784\u4f53\u7684\u53ef\u4ee5\u6765\u770b\u770b\u6570\u7ec4![](https://cdn.luogu.com.cn/upload/pic/1436.png)\n\n",
        "postTime": 1565250543,
        "uid": 205161,
        "name": "MC233_",
        "ccfLevel": 3,
        "title": "\u9898\u89e3 P2194 \u3010HXY\u70e7\u60c5\u4fa3\u3011"
    },
    {
        "content": "## [------\u66f4\u597d\u7684\u89c2\u770b\u6548\u679c------](https://www.cnblogs.com/zhenglw/p/10752577.html)\n\n###                 ~~\u7701\u9009\u524d\u9893\u51e0\u9053\u6c34\u9898\uff1f~~\n\n\u8a00\u5f52\u6b63\u4f20\uff1a\n\t\u663e\u7136\u8fd9\u662f\u4e00\u9053TARJAN\uff0c~~\u9898\u9762\u5df2\u7ecf\u60f3\u65b9\u8bbe\u6cd5\u5728\u63d0\u9192\u4f60\u4e86~~\n    \n    \n   \u53ea\u8981\u8bb0\u5f55\u6bcf\u4e2a\u5f3a\u8054\u901a\u5206\u91cf\u4e2d\u7684\u6700\u5c0f\u5143\u7d20\u503c\u548c\u6700\u5c0f\u5143\u7d20\u503c\u5bf9\u5e94\u7684\u6570\u91cf\u5373\u53ef\n   \n   \u770b\u5230\u5f88\u591a\u9898\u89e3\u90fd\u662f\u5168\u90e8\u5904\u7406\u5b8c\u4e4b\u540e\u5728\u6700\u540e\u7edf\u8ba1\u6700\u5c0f\u5143\u7d20\u503c\u548c\u6700\u5c0f\u5143\u7d20\u5bf9\u5e94\u6570\u91cf\u5e76\u7edf\u8ba1\u4e24\u4e2a\u7b54\u6848\u7684\uff0c\u5176\u5b9e\u5bf9\u4e8e\u51cf\u5c0f\u5e38\u6570\u6765\u8bf4\u8fd9\u6837\u662f\u6ca1\u5fc5\u8981\u7684,\u56e0\u4e3a\u6bcf\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u53ea\u4f1a\u5728tarjan\u7684\u9014\u4e2d\u88ab\u641c\u7d22\u5230\u4e00\u6b21\uff08\u53ef\u4ee5\u53eb\u505a\u65e0\u540e\u6548\u6027\uff1f\uff09\u6240\u4ee5\u53ea\u8981\u4e00\u8fb9tarjan\u4e00\u8fb9\u7edf\u8ba1\u7b54\u6848\u5373\u53ef\n   \n   \n```cpp\n#include<cstdio>\n#include<iostream>\n#include<cstdlib>\n#include<cstring>\n#define writep(x) write(x),putchar(' ')\n#define writeln(x) write(x),puts(\"\") \n#define ha 1000000007//\u73cd\u60dc\u751f\u547d\uff0c\u66b4\u529b\u53d6\u819c\u4e0d\u53ef\u53d6\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u53d6ha\nusing namespace std;\ninline int read(){\n    int ans=0,f=1;char chr=getchar();\n    while(!isdigit(chr)){if(chr=='-') f=-1;chr=getchar();}\n    while(isdigit(chr)){ans=(ans<<3)+(ans<<1)+chr-48;chr=getchar();}\n    return ans*f;\n}void write(int x){\n    if(x<0) putchar('-'),x=-x;\n    if(x>9) write(x/10);\n    putchar(x%10+'0');\n}const int M=3e5+5;\nint n,m,a[M],head[M],ver[M],nxt[M],tot,dfn[M],low[M],ins[M],sta[M],top,t,mn[M],col,color[M],cnt[M],mc[M],ans1,ans2=1;\n/*\ncol \u5f3a\u8fde\u901a\u5206\u91cf\u6570\u91cf\ncolor[]\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u7f16\u53f7\ncnt[]\u5f3a\u8fde\u901a\u5206\u91cf\u91cd\u5143\u7d20\u4e2a\u6570\uff08\u8fd9\u91cc\u8c8c\u4f3c\u6ca1\u7528\uff09\nmn[]\u5f3a\u8fde\u901a\u5206\u91cf\u4e2d\u503c\u6700\u5c0f\u503c\nmc[]\u5f3a\u8fde\u901a\u5206\u91cf\u4e2d\u6700\u5c0f\u503c\u4e2a\u6570\n*/\ninline void add(int x,int y){ver[++tot]=y;nxt[tot]=head[x];head[x]=tot;}\ninline void cmin(int &a,int b){if(a>b) a=b;}\nvoid Tarjan(int x){\n    dfn[x]=low[x]=++t;ins[x]=1,sta[top++]=x;\n    for(register int i=head[x];i;i=nxt[i])\n        if(ins[ver[i]]==0) Tarjan(ver[i]),cmin(low[x],low[ver[i]]);\n        else if(ins[ver[i]]==1) cmin(low[x],dfn[ver[i]]);\n    if(dfn[x]==low[x]) ++col,mn[col]=0x7fffffff;\n    if(dfn[x]==low[x]){\n        do{\n            --top,++cnt[col],color[sta[top]]=col;ins[sta[top]]=-1;\n            if(mn[col]>a[sta[top]])\t mn[col]=a[sta[top]],mc[col]=0;\n            if(mn[col]==a[sta[top]]) ++mc[col];//\u5173\u952e\u90e8\u5206\n        }while(sta[top]!=x);\n        ans1+=mn[col];ans2=ans2*mc[col]%ha;//\u8bb0\u5f55\u7b54\u6848\n\t}\n    \n}\nint main(){\n    n=read();for(register int i=1;i<=n;++i) a[i]=read();\n    m=read();for(register int i=1,x,y;i<=m;++i){x=read(),y=read(),add(x,y);}\n    for(register int i=1;i<=n;++i) if(!dfn[i]) Tarjan(i);//\u57fa\u672c\u64cd\u4f5c\n    writep(ans1),writeln(ans2);//\u8f93\u51fa\n    return 0;\n}\n\n```",
        "postTime": 1555933773,
        "uid": 9287,
        "name": "LevenKoko",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2194 \u3010HXY\u70e7\u60c5\u4fa3\u3011"
    },
    {
        "content": "\u52062\u6b65\uff1a  \n1.tarjan\u7f29\u70b9    \u7f29\u70b9\u65f6\u8bb0\u5f55\u5f3a\u8fde\u901a\u5206\u91cf\u5185\u6700\u5c11\u7684\u82b1\u8d39\u548c\u6700\u5c11\u82b1\u8d39\u7684\u65b9\u6cd5\u6570  \n2.\u5bf9\u4e8e\u6bcf\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf  ans1+=\u6700\u5c0f\u82b1\u8d39,ans2*=\u65b9\u6cd5\u6570  \n\u7406\u6e05\u540e  \u4e0a\u4ee3\u7801  \n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#define N 100010\n#define M 300010\n#define inf 0x3f3f3f3f\nconst int mod=1e9+7; \nusing namespace std;\nint n,m,cost[N],dfn[N],low[N],min_cost[N],way[N],stack[N],ru[N],c[N],all[N],ans1,ans2,tot,num,cnt,top,head[N];\nbool ins[N];\nstruct Edge{\n\tint u,v,next;\n}edge[M];\ninline int read(){\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-f;ch=getchar();\n\t}while(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();\n\t}return  x*f;\n}\ninline void add(int x,int y){edge[++tot].u=x;edge[tot].v=y;edge[tot].next=head[x];head[x]=tot;}\nvoid tarjan(int x){\n\tdfn[x]=low[x]=++num;\n\tstack[++top]=x;ins[x]=1;\n\tfor(int i=head[x];i;i=edge[i].next){\n\t\tint y=edge[i].v;\n\t\tif(!dfn[y]){\n\t\t\ttarjan(y);\n\t\t\tlow[x]=min(low[x],low[y]);\n\t\t} \n\t\telse if(ins[y])\n\t\t\tlow[x]=min(low[x],dfn[y]);\n\t}\n\tif(dfn[x]==low[x]){\n\t\tint z;cnt++;\n\t\tdo{\n\t\t\tz=stack[top--];\n\t\t\tif(cost[z]<min_cost[cnt]){\n\t\t\t\tmin_cost[cnt]=cost[z];way[cnt]=1;\n\t\t\t}\n\t\t\telse if(cost[z]==min_cost[cnt])\n\t\t\t\tway[cnt]++;\n\t\t\tins[z]=0;c[z]=cnt;all[cnt]++;\n\t\t}while(x!=z);\n\t}\n}\nint main()\n{\n\tn=read();\n\tmemset(min_cost,0x3f,sizeof(min_cost));\n\tans2=1;\n\tfor(int i=1;i<=n;i++){\n\t\tcost[i]=read();\n\t}\n\tm=read();\n\tfor(int i=1;i<=m;i++){\n\t\tint x=read(),y=read();\n\t\tadd(x,y);\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tif(!dfn[i])tarjan(i);\n\tfor(int i=1;i<=tot;i++)\n\t{\n\t\tint u=edge[i].u,v=edge[i].v;\n\t\tif(c[u]!=c[v])\n\t\t\tru[c[v]]++;\n\t}\n\tfor(int i=1;i<=cnt;i++){\n\t\tans1+=min_cost[i];\n\t\tans2=ans2*way[i]%mod;\n\t}\n\tprintf(\"%d %d\\n\",ans1,ans2);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1554094977,
        "uid": 88733,
        "name": "Zekrom",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2194 \u3010HXY\u70e7\u60c5\u4fa3\u3011"
    },
    {
        "content": "```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#define ll long long//long long\u7528ll\u8868\u793a \n#define maxn 1000000\n#define INF 1e9+7//\u5927\u6570\u7528INF\u8868\u793a \nusing namespace std;\nll qr,cnt,cnum,dfn[maxn],low[maxn],vis[maxn],stack[maxn];\nll top,n,m,qq,p[maxn],ans[maxn],ans1,ans2=1,head[maxn];\nll color[maxn],anss[maxn];\nstruct EDGE\n{\n    ll next;\n    ll to;\n}edge[maxn*3];\nvoid add(ll from,ll to)\n{\n    edge[++qr].next=head[from];\n    edge[qr].to=to;\n    head[from]=qr;\n}\nvoid tarjan(ll x)\n{\n    dfn[x]=low[x]=++cnt;//\u66f4\u65b0\u65f6\u95f4\u6233\uff0c\u5c31\u8fd9\u4e2a\u5199\u6cd5 \n    vis[x]=1;stack[++top]=x;//\u5165\u6808\u64cd\u4f5c \n    for(ll i=head[x];i;i=edge[i].next)\n```\n{//\u679a\u4e3e\u4ecex\u5f00\u59cb\u7684\u8fb9\uff0c\u5176\u5b9e\u8fd9\u4e2a\u51fd\u6570\u51e0\u4e4e\u5c31\u662f\u6a21\u677f\n```cpp\n         ll v=edge[i].to;\n         if(!dfn[v])\n          {\n              tarjan(v);\n              low[x]=min(low[x],low[v]);\n          }\n         else if(vis[v]) low[x]=min(low[x],dfn[v]);\n     }\n    if(dfn[x]==low[x])\n     {\n         cnum++;//\u5bf9\u6211\u6765\u8bf4\u5f88\u957f\u65f6\u95f4\u624d\u5f04\u61c2\u8fd9\u4e2a\u73a9\u610f\uff1a\u5f3a\u8fde\u901a\u5206\u91cf\u6570\u76ee \n         do\n         {\n             color[stack[top]]=cnum;//\u6807\u8bb0\u5f3a\u8fde\u901a\u5206\u91cf\u53f7\uff08\u6709\u4eba\u79f0\u67d3\u8272\uff09 \n             vis[stack[top]]=0;//\u51fa\u6808\u64cd\u4f5c\uff0c\u6a21\u677f\u80cc\u8fc7 \n             ans[cnum]=min(ans[cnum],p[stack[top]]);//\u66f4\u65b0\u8fd9\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u6700\u5c0f\u7684\u8d39\u7528 \n             qq=stack[top--];//\u51fa\u6808 \n         }while(qq!=x);\n     }\n}\nint main()\n{\n    ios::sync_with_stdio(false);\n    cin>>n;\n    for(ll i=1;i<=n;++i)\n     cin>>p[i];\n    cin>>m;\n    ll z=INF;//\u6700\u540e\u76f4\u63a5%INF\u7684\u8bdd\u7f16\u8bd1\u9519\u8bef\uff0c\u6211\u4e5f\u4e0d\u77e5\u9053\u4e3a\u5565 \n    for(int i=1;i<=n;++i)\n     ans[i]=INF;//\u521d\u59cb\u5316\uff0cmemset\u6700\u597d\u522b\u7528\uff0c\u6709\u6bd2\uff01\u603b\u662f\u4f1a\u51fa\u73b0\u4e00\u4e9b\u83ab\u540d\u5176\u5999\u7684\u6570 \n    for(ll i=1;i<=m;++i)\n     {\n         ll x,y;\n         cin>>x>>y;\n         add(x,y);\n     }\n    for(ll i=1;i<=n;++i)\n     if(!dfn[i]) tarjan(i);//\u6a21\u677f \n    for(ll i=1;i<=cnum;++i)\n     ans1+=ans[i];//\u6bcf\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u52a0\u4e0a\u6700\u5c0f\u503c\uff0c\u6700\u540e\u5c31\u662f\u7b2c\u4e00\u95ee\u7b54\u6848 \n    printf(\"%lld \",ans1);//\u8f93\u51fall\u578b\uff0cint\u4e0d\u77e5\u9053\u4f1a\u4e0d\u4f1a\u70b8 \n    for(int i=1;i<=n;++i)\n     {    \n         if(p[i]==ans[color[i]])\n              anss[color[i]]++;//\u679a\u4e3e\u6bcf\u4e00\u4e2a\u70b9\uff0c\u5982\u679c\u8fd9\u4e2a\u70b9\u7684\u8d39\u7528\u548c\u6240\u5c5e\u7684\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u6700\u5c0f\u8d39\u7528\u4e00\u6837\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u65b9\u6848\u6570\u52a0\u4e00 \n     }\n    for(int i=1;i<=cnum;++i) ans2*=anss[i];//\u6211\u4e00\u5f00\u59cb\u9519\u4e86\uff1a\u505a\u7684\u52a0\u6cd5\uff0c\u540e\u6765\u60f3\u60f3\u6bcf\u4e2a\u70b9\u90fd\u6709**\u79cd\u53ef\u80fd\uff0cn\u4e2a\u70b9\u80af\u5b9a\u4e58\u6cd5\u554a \n    printf(\"%lld\",ans2%z);//\u6a21 \n    return 0;\n}\n```",
        "postTime": 1508030796,
        "uid": 49851,
        "name": "\u777f\u5c7f\u9752\u886b",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2194 \u3010HXY\u70e7\u60c5\u4fa3\u3011"
    },
    {
        "content": "\u601d\u8def\uff1a\n\n\u8fd9\u9898\uff0c\u4e5f\u7b97\u4e00\u4e2atarjan\u7684\u88f8\u9898\u5427\uff0c\u9898\u76ee\u7684\u610f\u601d\u5c31\u662f\u6c42\u5728\u4e00\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u91cc\u7684\u70b9\u6700\u5c0f\u503c\u4e0e\u548c\u8fd9\u4e2a\u6700\u5c0f\u503c\u76f8\u7b49\u7684\u70b9\u6709\u51e0\u4e2a\uff0c\u4e3a\u4ec0\u4e48\u5462\uff1f\n\n\u7b2c\u4e00\u95ee\u662f\u6c42\u70e7\u5b8c\u5168\u90e8\u60c5\u4fa3\u9700\u8981\u7684\u6700\u5c0f\u6c7d\u6cb9\u8d39\u7528\uff0c\u5176\u5b9e\u5c31\u662f\u6c42\u6bcf\u4e00\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u91cc\u7684\u6700\u5c0f\u503c\uff0c\u7136\u540e\u7d2f\u52a0\u5c31\u53ef\u4ee5\u4e86\uff0c\u7b2c\u4e8c\u95ee\u662f\u6c42\u65b9\u6848\u6570\uff0c\u4e5f\u6bd4\u8f83\u663e\u7136\u5730\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6c42\u6bcf\u4e00\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u91cc\u7684\u548c\u6700\u5c0f\u503c\u76f8\u7b49\u7684\u70b9\u6709\u51e0\u4e2a\uff0c\u7136\u540e\u7d2f\u4e58\u5c31\u884c\u4e86\u3002\n\n\n\u4ee3\u7801\u5982\u4e0b\uff0c\u90e8\u5206\u91cd\u8981\u7ec6\u8282\u5df2\u6ce8\u91ca\n\n\n\n\n\n\n\n\n\n\n\n    \n\n\n\n\n```cpp\n#include<cstdio>\n#include<stack>\n#include<algorithm>\n#define N 100009\n#define M 300009\nusing namespace std;\n#ifdef WIN32                    //\u6761\u4ef6\u7f16\u8bd1\uff0cNOIP\u515a\u9ed1\u79d1\u6280\uff0c\u53ef\u4ee5\u4e0d\u7528\u518d\u62c5\u5fc3long long\u7684\u5f71\u54cd \n#define LL \"%I64d %I64d\\n\"\n#else\n#define LL \"%lld %lld\\n\"\n#endif\nconst long long MOD = 1000000007;\nint en,n,m;\nint t,cnt,low[N],dfn[N];\nbool instack[N];\nstack<int> sta;\nlong long ans1,ans2 = 1;\nint node[N];\nstruct edge{\n    int e;\n    edge *next;\n}*v[N],ed[M];\nvoid add_edge(int s,int e){                       //\u524d\u5411\u661f\u5b58\u8fb9 \n    en++;\n    ed[en].next = v[s],v[s] = ed+en,v[s]->e =e;\n}\nvoid dfs(int now){\n    t++;\n    low[now] = dfn[now] = t;\n    instack[now] = true;\n    sta.push(now);\n    for(edge *e = v[now];e;e=e->next)\n      if(!dfn[e->e]){\n           dfs(e->e);\n           low[now] = min(low[now],low[e->e]);\n      }\n      else if(instack[e->e])low[now] = min(low[now],dfn[e->e]);\n    if(low[now] == dfn[now]){\n        cnt++;\n        int minz = 19999999,cc = 0;\n        while(sta.top() != now){\n            instack[sta.top()] = false;\n            if(node[sta.top()] < minz){\n                cc = 1;\n                minz = node[sta.top()];\n            }\n            else if(minz == node[sta.top()])cc++;\n            sta.pop();\n        } \n        sta.pop();\n        instack[now] = false;\n        if(node[now] == minz)cc++;\n        else if(node[now] < minz){\n            cc = 1;\n            minz = node[now];\n        }\n        ans1 += minz;                        //\u7d2f\u52a0\u6bcf\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u6700\u5c0f\u503c \n        ans2 = (ans2*cc)%MOD;                //\u7d2f\u4e58\u6bcf\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u91cc\u548c\u6700\u5c0f\u503c\u76f8\u7b49\u7684\u70b9\u7684\u4e2a\u6570\u5e76\u53d6\u6a21 \n    }\n}\nvoid tarjan(){                               //Tarjan \n    for(int a = 1; a<= n; a++)\n      if(!dfn[a])dfs(a);\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i = 1; i <= n; i++)scanf(\"%d\",&node[i]);\n    scanf(\"%d\",&m);\n    for(int i = 1; i <= m; i++){\n        int u,v;\n        scanf(\"%d%d\",&u,&v);\n        add_edge(u,v);\n    }\n    tarjan();\n    printf(LL,ans1,ans2);            //\u8f93\u51fa \n    return 0;\n}\n\n```",
        "postTime": 1506167193,
        "uid": 32526,
        "name": "\u9648\u65b0\u6708",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2194 \u3010HXY\u70e7\u60c5\u4fa3\u3011"
    }
]
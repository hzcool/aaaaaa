[
    {
        "content": "#### \u867d\u7136\u8fd9\u771f\u7684\u662f\u4e00\u9053\u4e24\u6210\u4ee3\u7801\u662f\u5934\u6587\u4ef6\u7684\u6c34\u9898\uff0c\u4f46\u662f\u6211\u8fd8\u662f\u6765\u8bb2\u4e00\u8bb2\u5982\u4f55~~`\u5927\u529b\u88c5\u903c`~~\u601d\u8003\u3002\n\n```cpp\n    #include <iostream>\n    #include <algorithm>\n    #include <stdio.h>\n    using namespace std;\n    int n,f[5003][5003],a[5003],ans=0;\n    int main(){\n        scanf(\"%d\",&n);\n        for(int i=1;i<=n;i++)scanf(\"%d\",&a[i]);for(int i=n;i;i--)a[i]-=a[i-1];\n        for(int i=2;i<=n;i++)for(int j=i+ans+1;j<=n;j++)if(a[i]==a[j])\n            ans=max(ans,f[i][j]=min(j-i-1,f[i-1][j-1]+1));\n        printf(\"%d\\n\",ans>3?ans+1:0);\n        return 0;\n    }\n```\n\u628a\u539f\u6570\u7ec4\u7684\u6bcf\u4e00\u4f4d\u51cf\u53bb\u524d\u4e00\u4f4d\uff08**\u5012\u7740\u5199**\u4e0d\u7528\u7528\u6211\u6559\u7684\u5427\uff09\uff0c\u5bf9\u4e8e\u7b2ci\u4f4d\u548c\u7b2cj\u4f4d\u4e3a\u7ed3\u5c3e\u65f6\u7684\u6700\u957f\u7ed3\u679c\u8bb0\u4f5c`f[i][j]`\uff0c\u5219`f[i][j]<i-j`\uff08\u4e0d\u91cd\u590d\u4e14\u7a7a\u51fa\u53f3\u4fa7\u5b50\u4e32\u7684\u524d\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u539f\u6765\u7684\u4e50\u8c31\u4e2d\u7684**\u65cb\u5f8b\u76f8\u540c**\u4e0d\u91cd\u53e0\u4e32\u957f\u5ea6\u4e3a**k**\uff0c\u5728\u6570\u5217\u6bcf\u4e2a\u4f4d\u7f6e\u90fd\u51cf\u524d\u4e00\u4f4d\u540e\u5c31\u53d8**\u5b8c\u5168\u76f8\u540c**\u4e0d\u91cd\u53e0**\u4e0d\u8fde\u7eed**\u4e32\u957f\u5ea6\u4e3a**k-1**\uff09\u90a3\u4e48\u5c31\u6709\u4e86\u4ee3\u7801\u4e2d\u7684\u9012\u63a8\u5f0f\uff0c\u800cans\u4fdd\u5b58\u5df2\u6709\u6700\u5927\u503c\uff0c\u4e4b\u540ej\u5c31\u81f3\u5c11\u53ef\u4ee5\u4ece**i+ans+1**\u5f00\u59cb\u679a\u4e3e\u3002\u6700\u540e\u7279\u5224\u4e0d\u7b26\u5408\u957f\u5ea6\u6761\u4ef6\u7684\u5730\u65b9\uff0c\u7136\u540e\u8f93\u51fa**ans+1**\u3002\n#### \u4e8e\u662f\u5b8c\u6210~~`\u5927\u529b\u88c5\u903c`~~\u601d\u8003\n",
        "postTime": 1513930061,
        "uid": 13925,
        "name": "yyhhenry",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2743 \u3010[USACO5.1]\u4e50\u66f2\u4e3b\u9898Musical Themes\u3011"
    },
    {
        "content": "\u697c\u6559\u4e3b\u7537\u4eba\u516b\u9898 AND 2009\u5e74\u96c6\u8bad\u961f\u8bba\u6587\u7684\u4f8b\u9898\u4e4b\u4e00\uff0c\u5728POJ\u4e0an\u7684\u8303\u56f4\u662f20000\uff0cdp\u548chash\u4ec0\u4e48\u7684\u5e94\u8be5\u90fd\u4f1a\u88ab\u5361\uff0c\u6240\u4ee5\u540e\u7f00\u6570\u7ec4\u624d\u662f\u771f\u6b63\u7684\u6b63\u89e3\n\n\u5148\u4e0d\u8003\u8651\u8f6c\u8c03\uff0c\u9a6c\u4e0a\u60f3\u5230\u53ef\u4ee5**\u4e8c\u5206**\u5224\u65ad\u957f\u5ea6\u4e3amid\u662f\u5426\u53ef\u884c\n\n\u5148\u6c42\u51fa\u5b57\u7b26\u4e32\u7684height\u6570\u7ec4\uff0c\u7136\u540e\u5728height\u4e0a\u5206\u7ec4\n\n\u6bcf\u7ec4\u662fheight\u4e0a**\u8fde\u7eed\u7684\u4e00\u6bb5**\uff0c\u4e14\u5176\u4e2d**\u9664\u7b2c\u4e00\u4e2a\u4ee5\u5916**\u6240\u6709height\u503c\u90fd**\u4e0d\u5c0f\u4e8emid**\uff08\u65e0\u6cd5\u6ee1\u8db3\u7684\u5c31\u81ea\u5df1\u5355\u72ec\u4e00\u4e2a\u7ec4\uff09\n\n\u6ee1\u8db3\u8fd9\u4e24\u70b9\u7684\u60c5\u51b5\u4e0b**\u4f7f\u4e00\u7ec4\u5c3d\u91cf\u957f**\uff0c\n\u6bd4\u5982\u8fd9\u6837(\u56fe\u7247\u4e5f\u51fa\u81ea\u8bba\u6587)\n![\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0](https://i.loli.net/2018/12/06/5c08efd719dc9.png)\n\n\u6211\u4eec\u53ea\u9700\u8981\u68c0\u67e5\u662f\u5426\u5b58\u5728\u4e00\u7ec4\uff0c\n\u6ee1\u8db3\u5176\u4e2d**\u6700\u5927\u7684sa-\u6700\u5c0f\u7684sa>mid**\uff0c\u82e5\u6ee1\u8db3\u5373\u53ef\u884c\n\n\u56e0\u4e3a\u6309\u8fd9\u6837\u5206\u7ec4\uff0c**\u7ec4\u5185\u4efb\u610f\u4e24\u4e2a\u540e\u7f00\u7684lcp\u957f\u5ea6\u90fd\u4e0d\u4f1a\u5c0f\u4e8emid**\n\n\u73b0\u5728\u8003\u8651\u8f6c\u8c03\uff0c\u5176\u5b9e\u4e5f\u5f88\u7b80\u5355\n\n\u6211\u4eec\u53ea\u9700\u8981\u5728\u539f\u97f3\u4e50\u5e8f\u5217\u7684**\u5dee\u5206\u6570\u7ec4**\u4e0a\u6c42height\u5373\u53ef\n\n\u56e0\u4e3a\u82e5\u539f\u5e8f\u5217\u6709\u4e24\u4e2a\u5b50\u6bb5\u7684\u5dee\u5206\u5e8f\u5217\u4e00\u6837\uff0c\u90a3\u4e48\u4ed6\u4eec\u4e00\u5b9a\u53ef\u4ee5\u901a\u8fc7\u52a0/\u51cf\u540c\u4e00\u4e2a\u6570\u5f97\u5230\n\n(\u518d\u6b21\u6ce8\u610f\u8f6c\u8c03**\u4e0d\u662f**\u6700\u5927\u7684sa-\u6700\u5c0f\u7684sa+1>mid\uff0c\u56e0\u4e3a\u6211\u4eec\u8981\u5728\u539f\u5e8f\u5217\u7684**\u5dee\u5206\u6570\u7ec4**\u4e0a\u6c42height)\n\n\n***********\n\n```cpp\n//niiick\n#include<iostream>\n#include<cmath>\n#include<algorithm>\n#include<queue>\n#include<cstring>\n#include<cstdio>\n#include<map>\nusing namespace std;\ntypedef long long lt;\n\nint read()\n{\n    int x=0,f=1;\n    char ss=getchar();\n    while(ss<'0'||ss>'9'){if(ss=='-')f=-1;ss=getchar();}\n    while(ss>='0'&&ss<='9'){x=x*10+ss-'0';ss=getchar();}\n    return x*f;\n} \n\nconst int maxn=40010;\nint n,m;\nint a[maxn];\nint rak[maxn],sa[maxn],tp[maxn],tax[maxn];\nint height[maxn];\n\nvoid rsort()\n{\n    for(int i=0;i<=m;++i) tax[i]=0;\n    for(int i=1;i<=n;++i) tax[rak[i]]++;\n    for(int i=1;i<=m;++i) tax[i]+=tax[i-1];\n    for(int i=n;i>=1;--i) sa[tax[rak[tp[i]]]--]=tp[i];\n}\n\nvoid ssort()\n{\n    m=210;\n    for(int i=1;i<=n;++i)\n    rak[i]=a[i],tp[i]=i;\n    \n    rsort();\n    for(int k=1;k<=n;k<<=1)\n    {\n        int p=0;\n        for(int i=n-k+1;i<=n;++i) tp[++p]=i;\n        for(int i=1;i<=n;++i) if(sa[i]>k) tp[++p]=sa[i]-k;\n        \n        rsort();\n        swap(rak,tp);\n        rak[sa[1]]=p=1;\n        for(int i=2;i<=n;++i)\n        rak[sa[i]]=(tp[sa[i]]==tp[sa[i-1]]&&tp[sa[i]+k]==tp[sa[i-1]+k])?p:++p;\n        if(p>=n) break;\n        m=p;\n    }\n}\n\nvoid getH()\n{\n    int k=0;\n    for(int i=1;i<=n;++i)\n    {\n        if(k) k--;\n        int j=sa[rak[i]-1];\n        while(a[i+k]==a[j+k]) k++;\n        height[rak[i]]=k;\n    }\n}\n\nint check(int x)\n{\n    int mx=sa[1],mi=sa[1];\n    for(int i=2;i<=n;i++)\n    {\n        if(height[i]<x) mx=mi=sa[i];\n        else\n        {\n            if(sa[i]<mi) mi=sa[i];\n            if(sa[i]>mx) mx=sa[i];\n            if(mx-mi>x) return 1;\n        }\n    }\n    return 0;\n}\n\nint main()\n{\n    while(scanf(\"%d\",&n)!=EOF)\n    {\n    \tif(n==0) break;\n    \tfor(int i=1;i<=n;++i) a[i]=read();\n    \tfor(int i=1;i<n;++i) a[i]=a[i+1]-a[i]+90;\n    \tn--;//\u5dee\u5206\u6570\u7ec4\u957f\u5ea6\u5c111\n    \t\n    \tssort(); getH();\n    \t\n    \tint ans=0;\n        int L=0,R=n,mid;\n        while(L<R)\n        {\n            mid=L+R>>1;\n            if(check(mid)) ans=mid,L=mid+1;\n            else R=mid;\n        }\n        if(ans<4) printf(\"0\\n\");\n        else printf(\"%d\\n\",ans+1);\n    }\n    return 0;\n}\n```\n",
        "postTime": 1544407652,
        "uid": 60885,
        "name": "niiick",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2743 \u3010[USACO5.1]\u4e50\u66f2\u4e3b\u9898Musical Themes\u3011"
    },
    {
        "content": "\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\n\n[CTime_Pup_314\u7684\u535a\u5ba2](https://ctp314.github.io/)\n\n# [P2743 [USACO5.1]\u4e50\u66f2\u4e3b\u9898Musical Themes](https://www.luogu.org/problemnew/show/P2743)\n\n>**\u6c42\u4e0d\u91cd\u53e0\u7684\u6700\u957f\u91cd\u590d\u5b50\u4e32**\uff0c\u5176\u4e2d\u4e24\u4e2a\u5b57\u7b26\u4e32\u76f8\u7b49\u7684\u6761\u4ef6\u53d8\u4e3a\u76f8\u540c\u4f4d\u7f6e\u4e24\u5b57\u7b26\u5dee\u503c\u4e00\u5b9a\n\n\n\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u89e3\u51b3\u88ab\u91cd\u65b0\u5b9a\u4e49\u7684\u5339\u914d\u7684\u95ee\u9898\uff0c\u76f8\u540c\u4f4d\u7f6e\u5b57\u7b26\u5dee\u503c\u4e00\u5b9a\uff0c\u90a3\u4e48\u540c\u4e00\u4e2a\u5b57\u7b26\u4e32\u76f8\u90bb\u5dee\u503c\u4e0e\u53e6\u4e00\u4e2a\u4f4d\u7f6e\u7684\u5dee\u503c\u76f8\u7b49\n\n\u4f8b\u5982\uff1a1 2 3 5 \u4e0e 3 4 5 2 \u4e24\u4e2a\u5b57\u7b26\u4e32\u8f6c\u6210\u67e5\u5206\u540e\u53d8\u4e3a 1 1 2 \u4e0e 1 1 -3  \u90a3\u4e48 1 2 3 \u4e0e 3 4 5 \u76f8\u7b49\uff0c \u5c31\u53ef\u4ee5\u53c8 1 1 \u4e0e 1 1 \u76f8\u7b49\u5f97\u51fa\n\n\u5373\u95ee\u9898\u53d8\u4e3a\u5728\u5dee\u5206\u6570\u7ec4\u4e0b\u6c42\u539f\u5b9a\u4e49\u7684\u76f8\u7b49\u7684\u4e0d\u91cd\u53e0\u6700\u5927\u5b50\u4e32\uff0c\u9700\u6ce8\u610f\u7684\u662f\u5dee\u5206\u6570\u7ec4\u7684\u5b50\u4e32\u957f\u5ea6+1\u624d\u662f\u539f\u5b50\u4e32\n\n\u5176\u6b21\uff0c\u6211\u4eec\u8981\u77e5\u9053\uff0c\u6700\u5927\u91cd\u590d\u5b50\u4e32\u5373\u4e3aheight\u6570\u7ec4\u91cc\u7684\u6700\u5927\u503c\uff0c\u8fd9\u4e0d\u96be\u8bc1\u660e\uff0c\u56e0\u4e3a\u91cd\u590d\u5b50\u4e32\u5fc5\u5b9a\u662f\u4efb\u610f\u4e24\u540e\u7f00\u7684LCP\uff0c\u800cLCP\u5c31\u5bf9\u5e94\u7684\u662fheight\u6570\u7ec4\u4e00\u6bb5\u8fde\u7eed\u533a\u95f4\u7684\u6700\u5c0f\u503c\uff0c\u5fc5\u5b9a\u5c0f\u4e8e\u7b49\u4e8eheight\u7684\u6700\u5927\u503c\n\n\u800c\u73b0\u5728\u9898\u76ee\u8981\u6c42\u4e0d\u91cd\u53e0\uff0c\u5bf9\u957f\u5ea6k\u8fdb\u884c\u4e8c\u5206\uff0c\u5c06\u95ee\u9898\u53d8\u4e3a\u5224\u5b9a\u957f\u4e3ak\u7684\u4e0d\u91cd\u53e0\u91cd\u590d\u5b50\u4e32\u7684\u5b58\u5728\u95ee\u9898\n\n\u6240\u4ee5\u6211\u4eec\u628aheight\u503c\u5927\u4e8e\u7b49\u4e8ek\u7684\u5f52\u5728\u4e00\u7ec4\uff0c\u53ea\u6709\u8fd9\u6837\u624d\u5b58\u5728\u81f3\u5c11\u957f\u4e3ak\u7684\u4e0d\u91cd\u53e0\u5b50\u4e32\uff0c\u8be5\u7ec4\u5185sa\u7684\u6700\u5927\u503c\u4e0e\u6700\u5c0f\u503c\u7684\u5dee\u82e5\u5c0f\u4e8e\u7b49\u4e8ek\uff0c\u5c31\u5b58\u5728\n\n\u6309height\u5206\u7ec4\u662f\u5e38\u89c1\u65b9\u6cd5\uff0c\u5982\u56fe\n\n![\u6309height\u5206\u7ec4](https://ctp314.github.io/2019/02/21/%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%84%E5%8D%81%E4%B8%89%E9%A2%98/SA_1.png)\n\n\u5b9e\u73b0\u683c\u5f0f\u8f83\u56fa\u5b9a\n\n```cpp\nfor(int i = 1; i <= n; ++i)\n{        \n    if(height[i] < k) maxv = -INF, minv = INF;// \u91cd\u65b0\u66f4\u65b0 \n    // \u6bcf\u4e00\u7ec4\u5185\u7ef4\u62a4\u7684\u4fe1\u606f\n    // \u5224\u65ad\u662f\u5426\u5408\u6cd5\n}\n\n```\n\n\u56e0\u6b64\u7b2c\u4e00\u9053\u9898\u5c31\u89e3\u51b3\u4e86\n\n\u5dee\u5206\u8f6c\u5316\n\n```cpp\nn = read();\nfor(int i = 1; i <= n; ++i) a[i] = read();\nfor(int i = 1; i <= n; ++i) s[i] = a[i]-a[i-1]+100; // \u9632\u6b62\u8d1f\u6570\n```\n\n\u5224\u65ad\u4e8c\u5206\u7b54\u6848\u5408\u6cd5\n\n```cpp\nbool valid(int k)\n{\n    int maxv = -INF, minv = INF;\n    for(int i = 1; i <= n; ++i)\n    {        \n        if(height[i] < k) maxv = -INF, minv = INF;        \n        maxv = max(sa[i], maxv);\n        minv = min(sa[i], minv);\n        if(maxv-minv > k) return true; //\u6ce8\u610f\u4e3a\u5c0f\u4e8ek\uff0c\u56e0\u4e3a\u8fd9\u662f\u5dee\u5206\u6570\u7ec4\n    }\n    return false;\n}\n```\n\n\u4e8c\u5206\u7b54\u6848\n\n```cpp\nint l = 0, r = n;\nwhile(l <= r)\n{\n    int mid = (l+r)>>1;\n    if(valid(mid)) l = mid+1, ans = mid;\n    else r = mid-1;\n}\n++ans;\nif(ans < 5) ans = 0; // \u6309\u9898\u610f\u5224\u65ad\nprintf(\"%d\\n\", ans);\n```",
        "postTime": 1550918857,
        "uid": 123514,
        "name": "CTime_Pup_314",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P2743 [USACO5.1]\u4e50\u66f2\u4e3b\u9898Musical Themes"
    },
    {
        "content": "\u4e00\u9053\u6bd4\u8f83\u7b80\u5355\u7684dp\u9898\n\nf[i][j]\u8868\u793a\u4ee5 \u7b2c\u4e00\u4e2a\u90e8\u5206\u4ee5\u7b2ci\u4e2a\u5b57\u7b26\u4e3a\u7ed3\u5c3e\uff0c\u7b2c\u4e8c\u4e2a\u90e8\u5206\u4ee5\u7b2cj\u4e2a\u5b57\u7b26\u4e3a\u7ed3\u5c3e\uff0c\u4e3b\u9898\u7684\u957f\u5ea6\u3002\n\ndp\u8f6c\u79fb\u65b9\u7a0bf[i][j]=f[i-1][j-1]+1\uff08a[i]-a[i-1]==a[j]-a[j-1]\uff09\n\n                  f[i][j]=1(a[i]-a[i-1]!=a[j]-a[j-1])\n\n\u7136\u800c\u4e0d\u80fd\u6709\u91cd\u53e0\u90e8\u5206\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0cf[i][j]\u6700\u5927\u4e3aj-i\uff0c\u6240\u4ee5\u8981\u52a0\u4e2a\u9650\u5236f[i-1][j-1]+1<=j-i\n\n\u7136\u540e\u5f005k\\*5k\u7684\u6570\u7ec4\u4f1a\u70b8\uff08\u5728usaco\u4e0a\uff09\uff0c\u6240\u4ee5\u7528\u6eda\u52a8\u6570\u7ec4\uff08\u591a\u68d2\uff09\n\n```cpp\n/*\nID: ylx14271\nPROG: theme \nLANG: C++     \n*/\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\nusing namespace std;\nint a[5010];\nint i,j,k,n;\nint f[2][5010]; \nint ans;\nint main()\n{\n    freopen(\"theme.in\",\"r\",stdin);\n    freopen(\"theme.out\",\"w\",stdout);\n    scanf(\"%d\",&n);\n    for (i=1;i<=n;i++) scanf(\"%d\",&a[i]);//\u8bfb\u5165\n    for (i=1;i<n-4;i++)//\u56e0\u4e3a\u957f\u5ea6\u6700\u5927\u4e3a5\uff0c\u6240\u4ee5\u53ea\u641e\u5230n-4\n        for (j=i+1;j<=n;j++)//\u4e0d\u80fd\u91cd\u53e0\uff0c\u6240\u4ee5i+1\u5f00\u59cb\n        {\n            if (a[i]-a[i-1]==a[j]-a[j-1]&&f[(i-1)%2][j-1]+1<=j-i)\n            f[i%2][j]=f[(i-1)%2][j-1]+1; else f[i%2][j]=1;\n            ans=max(ans,f[i%2][j]);\n        }\n    if (ans<5) ans=0;\n    printf(\"%d\\n\",ans);//\u8f93\u51fa\n    return 0;\n}\n```",
        "postTime": 1499226549,
        "uid": 2674,
        "name": "\u300cQQ\u7ea2\u5305\u300d",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2743 \u3010[USACO5.1]\u4e50\u66f2\u4e3b\u9898Musical Themes\u3011"
    },
    {
        "content": "$SAM$ \u597d\u9898\u3002\n\n\u8003\u8651\u628a\u6e90\u5e8f\u5217\u8fdb\u884c\u5dee\u5206\uff0c\u8bbe\u539f\u5e8f\u5217\u4e3a $A_1, A_2, \\dots, A_N$\uff0c\u90a3\u4e48\u5dee\u5206\u540e\u5c31\u662f $A'_i=A_{i+1}-A_i$\u3002\n\n\u5982\u679c\u5b58\u5728\u4e00\u6bb5 $[l,r]$ \u6ee1\u8db3\u5b58\u5728\u4e00\u6bb5 $[l',r']$ \u4f7f\u5f97 $r+1 < l'$ \u5e76\u4e14 $A'_l=A'_{l'}\\ \\wedge\\ A'_{l+1}=A'_{l'+1}\\ \\wedge\\dots\\wedge\\ \nA'_r=A'_{r'}$\uff0c\u90a3\u4e48\u5728\u539f\u5e8f\u5217\u7684\u533a\u95f4 $[l-1,r]$\uff08\u548c $[l'-1,r]$\uff09\u5f62\u6210\u4e00\u4e2a\u4e3b\u9898\u3002\n\n\u6ce8\u610f\u9700\u8981 $r+1 < l'$\uff0c\u800c\u4e0d\u662f $r < l'$\uff0c\u5e94\u4e3a\u5982\u679c $r+1=l'$ \u90a3\u4e48\u4e24\u4e2a\u533a\u95f4\u5728\u539f\u5e8f\u5217\u5bf9\u5e94\u7684\u533a\u95f4\u4f1a\u91cd\u53e0\u3002\n\n\u628a $A'$ \u5f53\u6210\u4e00\u4e2a\u5b57\u7b26\u4e32\u7136\u540e\u7528 SAM \u7ef4\u62a4\u5b50\u4e32\u7684\u6700\u5c0f $r$\uff0c\u6700\u5927 $r$\uff0c\u7136\u540e\u8f93\u51fa\u5224\u65ad\u6700\u5927\u5408\u6cd5\u5b50\u4e32 $+1$ \u662f\u5426\u5927\u4e8e\u7b49\u4e8e $5$ \u5c31\u597d\u4e86\u3002\n\n\uff08\u611f\u89c9\u5e94\u8be5\u51fa\u4e00\u4e2a\u52a0\u5f3a\u7248\uff0c$N\\le 2\\cdot10^5$\u3002\u3002\u3002\uff09\n\n```cpp\n// writer: w33z8kqrqk8zzzx33\n#include <bits/stdc++.h>\nusing namespace std;\n\n// begin fast read template by CYJian (source: https://www.luogu.com.cn/paste/i11c3ppx)\n\nnamespace io {\n\tconst int __SIZE = (1 << 21) + 1;\n\tchar ibuf[__SIZE], *iS, *iT, obuf[__SIZE], *oS = obuf, *oT = oS + __SIZE - 1, __c, qu[55]; int __f, qr, _eof;\n\t#define Gc() (iS == iT ? (iT = (iS = ibuf) + fread (ibuf, 1, __SIZE, stdin), (iS == iT ? EOF : *iS ++)) : *iS ++)\n\tinline void flush () { fwrite (obuf, 1, oS - obuf, stdout), oS = obuf; }\n\tinline void gc (char &x) { x = Gc(); }\n\tinline void pc (char x) { *oS ++ = x; if (oS == oT) flush (); }\n\tinline void pstr (const char *s) { int __len = strlen(s); for (__f = 0; __f < __len; ++__f) pc (s[__f]); }\n\tinline void gstr (char *s) { for(__c = Gc(); __c < 32 || __c > 126 || __c == ' ';)  __c = Gc();\n\t\tfor(; __c > 31 && __c < 127 && __c != ' '; ++s, __c = Gc()) *s = __c; *s = 0; }\n\ttemplate <class I> inline bool gi (I &x) { _eof = 0;\n\t\tfor (__f = 1, __c = Gc(); (__c < '0' || __c > '9') && !_eof; __c = Gc()) { if (__c == '-') __f = -1; _eof |= __c == EOF; }\n\t\tfor (x = 0; __c <= '9' && __c >= '0' && !_eof; __c = Gc()) x = x * 10 + (__c & 15), _eof |= __c == EOF; x *= __f; return !_eof; }\n\ttemplate <class I> inline void print (I x) { if (!x) pc ('0'); if (x < 0) pc ('-'), x = -x;\n\t\twhile (x) qu[++ qr] = x % 10 + '0',  x /= 10; while (qr) pc (qu[qr --]); }\n\tstruct Flusher_ {~Flusher_(){flush();}}io_flusher_;\n} using io::pc; using io::gc; using io::pstr; using io::gstr; using io::gi; using io::print;\n\n// end fast read template by CYJian\n\n#define iter(i, a, b) for(int i=(a); i<(b); i++)\n#define rep(i, a) iter(i, 0, a)\n#define rep1(i, a) iter(i, 1, (a)+1)\n#define log(a) cerr<<\"\\033[32m[DEBUG] \"<<#a<<'='<<(a)<<\" @ line \"<<__LINE__<<\"\\033[0m\"<<endl\n#define all(a) a.begin(), a.end()\n#define fi first\n#define se second\n#define pb push_back\n#define mp make_pair\n \nusing ll=long long;\nusing pii=pair<int, int>;\n//#define int ll\n//const int MOD = 1000000007;\n\nnamespace SAM {\n\tconstexpr int MAXN = 5005;\n\tconstexpr int MAXT = 177;\n\tstruct state {\n\t\tint len, lnk, fpo;\n\t\tint nxt[MAXT];\n\t} st[MAXN*2];\n\tint sz, last;\n\tint mknode(int fro = -1) {\n\t\tint nd = sz++;\n\t\tif(fro == -1) memset(st[nd].nxt, -1, sizeof st[nd].nxt);\n\t\telse {\n\t\t\tmemcpy(st[nd].nxt, st[fro].nxt, sizeof st[nd].nxt);\n\t\t\tst[nd].lnk = st[fro].lnk;\n\t\t\tst[nd].fpo = st[fro].fpo;\n\t\t}\n\t\treturn nd;\n\t}\n\tvoid init() {\n\t\tsz = last = 0;\n\t\tmknode(); st[0].len = 0, st[0].lnk = -1;\n\t}\n\tvoid ext(int c) {\n\t\tint cur = mknode();\n\t\tst[cur].len = st[last].len+1;\n\t\tst[cur].fpo = st[cur].len-1;\n\t\tint p = last;\n\t\twhile(p != -1 && st[p].nxt[c] == -1) st[p].nxt[c] = cur, p = st[p].lnk;\n\t\tif(p == -1) st[cur].lnk = 0;\n\t\telse {\n\t\t\tint q = st[p].nxt[c];\n\t\t\tif(st[p].len + 1 == st[q].len) st[cur].lnk = q;\n\t\t\telse {\n\t\t\t\tint cl = mknode(q); \n\t\t\t\tst[cl].len = st[p].len + 1; st[cur].lnk = st[q].lnk = cl;\n\t\t\t\twhile(p != -1 && st[p].nxt[c] == q) st[p].nxt[c] = cl, p = st[p].lnk;\n\t\t\t}\n\t\t}\n\t\tlast = cur;\n\t}\n\tvector<int> revlnk[MAXN*2];\n\tint lpo[MAXN*2], ans;\n\tint dfs(int p) {\n\t\tlpo[p] = st[p].fpo;\n\t\tfor(int& v:revlnk[p]) lpo[p] = max(lpo[p], dfs(v));\n\t\tif(((st[p].lnk==-1)?0:(st[st[p].lnk].len+1))<=min(st[p].len,min(lpo[p]-st[p].fpo-1, st[p].fpo+1)))\n\t\t\tans = max(ans,min(st[p].len,min(lpo[p]-st[p].fpo-1,st[p].fpo+1)));\n\t\treturn lpo[p];\n\t}\n\tint makelpo() {\n\t\trep1(i, sz-1) revlnk[st[i].lnk].pb(i);\n\t\tans = 0;\n\t\tdfs(0);\n\t\treturn ans;\n\t}\n}\n\nsigned main() {\n    ios_base::sync_with_stdio(false); cin.tie(0);\n    int n; gi(n);\n\tint prev = -1;\n\tSAM::init();\n\trep(i, n) {\n\t\tint v; gi(v);\n\t\tif(i) SAM::ext(v - prev + 87);\n\t\tprev = v;\n\t}\n\tint v = SAM::makelpo()+1;\n\tprint((v<5)?0:v);\n}\n\n```",
        "postTime": 1586692053,
        "uid": 220037,
        "name": "w33z8kqrqk8zzzx33",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2743"
    },
    {
        "content": "## \u54c8\u5e0c\u5927\u6cd5\u543c\uff01\n\n\u8fd9\u9053\u9898\u4e0d\u9700\u8981\u7528\u540e\u7f00\u6570\u7ec4\u8fd9\u4e9b~~\u82b1\u91cc\u80e1\u54e8~~\u7684\uff0c\u7528\u7eafnoip\u5185\u5bb9\u7684hash+\u4e8c\u5206\u662f\u53ef\u4ee5~~\u6c34~~\u8fc7\u7684\u3002\n\n\u9996\u5148\u6211\u4eec\u53d1\u73b0\u6211\u4eec\u9700\u8981\u5bfb\u627e\u6700\u957f\u7684\u4e00\u79cd\u6ca1\u6709\u516c\u5171\u90e8\u5206\u7684\u91cd\u590d\u51fa\u73b0\u7684\u5b50\u4e32\uff0c\u4f7f\u8fd9\u4e2a\u4e32\u4e2d\u6570\u5b57\u4e4b\u95f4\u7684\u5dee\u4e0d\u53d8\u3002\u90a3\u6211\u4eec\u5c06\u8fd9n\u4e2a\u6570\u524d\u540e\u505a\u5dee\uff0c\u5f97\u5230\u53e6\u4e00\u4e2a\u957f\u5ea6\u662fn-1\u7684\u5e8f\u5217\u3002\u95ee\u9898\u8f6c\u5316\u4e3a\u6c42\u51fa\u8fd9\u4e2a\u5e8f\u5217\u7684\u6700\u957f\u91cd\u590d\u5b50\u4e32\uff0c\u4e14\u8fd9\u4e9b\u5b50\u4e32\u4e0d\u80fd\u91cd\u53e0\u3002\n\n\u6211\u4eec\u53d1\u73b0\u8fd9\u79cd\u4e32\u7684\u957f\u5ea6\u6ee1\u8db3\u5355\u8c03\u6027\uff0c\u6240\u4ee5\u8003\u8651\u4e8c\u5206\u4e32\u7684\u957f\u5ea6\uff0c\u81f3\u4e8e\u5982\u4f55\u5224\u65ad\u91cd\u590d\u7684\u5b50\u4e32\uff0c\u5c31\u7528hash\u5904\u7406\u6574\u4e2a\u4e32\uff0c\u4f7f\u6211\u4eec\u7684hash\u6ee1\u8db3\u524d\u7f00\u548c\u7684\u6027\u8d28\uff0c\u5230\u65f6\u5019\u76f8\u51cf\u8fdb\u884c\u5224\u65ad\u5c31\u884c\u4e86\u3002\n\n\u8ba9\u6211\u4eec\u770b\u770b\u5982\u4f55~~\u4e71\u641e~~\u6784\u9020\u4e00\u4e2a\u597d\u7684hash\n\n1.\u9996\u5148\uff0c\u4f60\u9700\u8981\u4e00\u4e2aunsigned long long\u6765\u9632\u6b62hash\u503c\u7b56\u9a6c\u5954\u817e\u800c\u7206\u6389\n\n2.\u7136\u540e\uff0c\u5f00\u59cb\u4e71\u641e\uff0c\u8d8a\u4e71\u8d8a\u597d\uff0c\u628a\u60f3\u8981\u5361\u4f60hash\u7684\u6570\u636e\u79c0\u6655\n\n3.\u4e4b\u540e\u53d6\u4e2a\u6a21\uff0c\u88c5\u5165\u94fe\u8868\u6216vector\u4ee5\u4fbf\u4e8e\u67e5\u627e\n\n\u6211\u7684hash\u662f\u8fd9\u6837\u7684\uff1a\n\n\u5047\u8bbe\u6709\u4e00\u4e32\u65701,2,3,4,5\n\n\u5148\u968f\u4fbf\u8bbe\u4e00\u4e2a\u51e0\u5343\u7684\u503cx\uff08\u6bd4\u5982\u4f60\u7684\u751f\u65e5\uff1f\uff09\n\n| hash(1)     | hash(2)     | hash(3)     | hash(4)     | hash(5)     |\n| :---- | :---- | :---- | :---- | :---- |\n| hash(2)+1 |       |       |       |       |\n| | hash(3)*x+2 |       |       |       |\n| | | hash(2)*x+3 |       |       |\n| |  |  | hash(4)*x+4 |       |\n| |  |  |  | 5 |\n\n\u5176\u5b9e\u4e5f\u5c31\u662f\u8fd9\u4e2a\n\n$hash(5)=5*x^0$\n\n$hash(4)=5*x^1+4*x^0$\n\n$hash(3)=5*x^2+4*x^1+3*x^0;$\n\n$hash(2)=5*x^3+4*x^2+3*x^1+2*x^0$\n\n$hash(1)=5*x^4+4*x^3+3*x^2+2*x^1+1*x^0;$\n\n\n\u603b\u901a\u5f0f:$H(i)=s[n]x^{n-i}+s[n-1]x^{x-i-1}+......+s[i+1]x+s[i]$\n\n\u56e0\u4e3a$hash$\u503c\u53ea\u4e0e$s[i]~s[i+L-1]$\u548c$L$\u6709\u5173\uff0c\u6240\u4ee5\u5c31\u53ef\u4ee5\u4e3a\u6240\u6b32\u4e3a\u4e86\n\n\u6700\u540e\u9001\u4e00\u53e5\u8bdd\n\n>Hash\u7684\u7cbe\u9ad3\u5728\u4e8e\u4e71\u641e\u2014\u2014\u53f6\u67d0\u5bcc\n\n```\n#include <iostream>\n#include <stdio.h>\n#include <cstring>\n#include <vector>\nusing namespace std;\ntypedef unsigned long long ull;\nconst int N=200010;\nconst int mod=2007;\nconst ull Rand=5201;\nstruct ss{\n    ull zhi;int pos;\n    ss(ull a,int b)\n    {\n        zhi=a;pos=b;\n    }\n};\nvector<ss> G[mod];\nint n,tlen,ans;\null Hash[N],base[N];\nint data[N],tmp[N];\nvoid Init()\n{\n    base[0]=1;\n    for(int i=1;i<n;i++)\n    tmp[i]=data[i+1]-data[i];\n    tlen=n-1;\n    for(int i=1;i<n;i++)\n    {\n        Hash[i]=Hash[i-1]*Rand+tmp[i];\n        base[i]=base[i-1]*Rand;\n    }\n}\nint query(ull v,int wei,int l)\n{\n    int x=v%mod;\n    G[x].push_back(ss(v,wei));\n    for(int i=0;i<G[x].size();i++)\n    if(G[x][i].zhi==v&&wei-G[x][i].pos>=l+1)\n    return 1;\n    return 0;\n}\nint check(int l)\n{\n    l--;\n    for(int i=0;i<mod;i++)\n    G[i].clear();\n    int flag=0;\n    for(int i=1;i<=tlen-l+1;i++)\n    {\n        ull v=Hash[i+l-1]-Hash[i-1]*base[l];\n        if(query(v,i,l))\n        {\n            flag=1;return 1;\n        }\n    }\n    return 0;\n}\nint main()\n{\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;i++)\n    scanf(\"%d\",&data[i]);\n    Init();\n    int l=5,r=n;\n    while(l<r)\n    {\n        int mid=(l+r)/2;\n        if(check(mid))\n        {\n            ans=mid;\n            l=mid+1;\n        }\n        else\n        r=mid;\n    }\n    printf(\"%d\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1533972682,
        "uid": 63035,
        "name": "Danny_boodman",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2743 \u3010[USACO5.1]\u4e50\u66f2\u4e3b\u9898Musical Themes\u3011"
    },
    {
        "content": "# \u9898\u76ee\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[\u70b9\u8fd9\u91cc](https://www.luogu.org/problem/P2743)\u770b\u9898\u76ee\u3002\n# \u5206\u6790\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u9996\u5148\uff0c\u5f88\u5bb9\u6613\u770b\u51fa\uff0c\u8f6c\u8c03\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u7528\u5dee\u5206\u6765\u6d88\u9664\u5f71\u54cd\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u7136\u540e\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u6c42\u539f\u4e32\u4e2d\u6700\u957f\u7684\u76f8\u540c\u5b50\u4e32\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u4e0d\u96be\u770b\u51fa\u53ef\u4ee5\u7528\u540e\u7f00\u6570\u7ec4+\u9ad8\u5ea6\u6570\u7ec4\u6c42\u89e3\u3002\u5148\u628a\u8fd9\u4e24\u4e2a\u4e1c\u897f\u9884\u5904\u7406\u51fa\u6765\uff0c\u7136\u540e\u6765\u4e00\u4e2a$O(n^2)$\u7684\u679a\u4e3e\uff0c\u679a\u4e3e\u7684\u662f\u4e24\u4e2a\u4e32\u7684\u8d77\u70b9\u3002\u7136\u540e$RMQ$\u67e5\u8be2$LCP$\u7684\u91cd\u590d\u957f\u5ea6\uff0c\u7136\u540e\u6ce8\u610f\u7279\u5224\u4e00\u4e0b\u91cd\u590d\u957f\u5ea6$\\ge5$\u548c\u76f8\u4ea4\u4e0e\u5426\uff0c~~\u7136\u540e\u5e78\u597d\u6570\u636e\u5c0f\u4e0d\u7136\u5c31\u4f1aT~~\uff0c\u7136\u540e\u5c31\u8fc7\u4e86\u3002  \n# \u4ee3\u7801\n```cpp\n#include <cmath>\n#include <cstdio>\n\nconst int MAXN = 5005, MAXSIZ = 5005, MAXLOG = 25;\n//\u4e0d\u77e5\u4e3a\u4f55MAXSIZ\u5f00\u5c0f\u4e86\u4e00\u76f4RE\uff0c\u6240\u4ee5\u624d\u5f00\u5f97\u548cN\u4e00\u6837\u5927\n\ntemplate<typename _T>\nvoid read( _T &x )\n{\n\tx = 0;char s = getchar();int f = 1;\n\twhile( s > '9' || s < '0' ){if( s == '-' ) f = -1; s = getchar();}\n\twhile( s >= '0' && s <= '9' ){x = ( x << 3 ) + ( x << 1 ) + ( s - '0' ), s = getchar();}\n\tx *= f;\n}\n\ntemplate<typename _T>\nvoid write( _T x )\n{\n\tif( x < 0 ){ putchar( '-' ); x = ( ~ x ) + 1; }\n\tif( 9 < x ){ write( x / 10 ); }\n\tputchar( x % 10 + '0' );\n}\n\ntemplate<typename _T>\n_T MAX( const _T a, const _T b )\n{\n\treturn a > b ? a : b;\n}\n\ntemplate<typename _T>\n_T MIN( const _T a, const _T b )\n{\n\treturn a < b ? a : b;\n}\n\nint RMQ[MAXN][MAXLOG];\nint cnt[MAXSIZ], rnk[MAXN * 4], tmp[MAXN * 4], sa[MAXN], height[MAXN];\nint a[MAXN], dif[MAXN];\nint N, lg2;\n\nbool equal( const int x, const int y, const int s )\n{\n\treturn rnk[x] == rnk[y] && rnk[x + s] == rnk[y + s];\n}\n\nvoid init()\n{\n\tfor( int j = 1 ; j <= lg2 ; j ++ )\n\t{\n\t\tfor( int i = 1 ; i + ( 1 << ( j - 1 ) ) <= N ; i ++ )\n\t\t{\n\t\t\tRMQ[i][j] = MIN( RMQ[i][j - 1], RMQ[i + ( 1 << ( j - 1 ) )][j - 1] );\n\t\t}\n\t}\n}\n\nint LCP( const int l, const int r )\n{\n\tif( l == r ) return N - l + 1;\n\tint x = rnk[l], y = rnk[r];\n\tif( x > y ) x ^= y, y ^= x, x ^= y;\n\tx ++;\n\tint k = log2 ( y - x + 1 );\n\treturn MIN( RMQ[x][k], RMQ[y - ( 1 << k ) + 1][k] );\n}\n\nint main()\n{\n\tint upper = 0;\n\tread( N );\n\tlg2 = log2( N );\n\tfor( int i = 1 ; i <= N ; i ++ )\n\t{\n\t\tread( a[i] );\n\t\tdif[i] = a[i] - a[i - 1] + 100;\n        //\u907f\u514d\u51fa\u73b0\u8d1f\u6570\u4e0b\u6807\n\t\tupper = MAX( upper, dif[i] );\n\t}\n\tfor( int i = 1 ; i <= N ; i ++ )\n\t{\n\t\tcnt[dif[i]] = 1;\n\t}\n\tfor( int i = 1 ; i <= upper ; i ++ )\n\t{\n\t\tcnt[i] += cnt[i - 1];\n\t}\n\tfor( int i = 1 ; i <= N ; i ++ )\n\t{\n\t\trnk[i] = cnt[dif[i]];\n\t}\n\tint las = cnt[upper], p = 0;\n\tfor( int k = 1 ; k < N ; k <<= 1 )\n\t{\n\t\tfor( int i = 1 ; i <= las ; i ++ ) cnt[i] = 0;\n\t\tfor( int i = 1 ; i <= N ; i ++ ) cnt[rnk[i + k]] ++;\n\t\tfor( int i = 1 ; i <= las ; i ++ ) cnt[i] += cnt[i - 1];\n\t\tfor( int i = N ; i >= 1 ; i -- ) tmp[cnt[rnk[i + k]] --] = i;\n\t\tfor( int i = 1 ; i <= las ; i ++ ) cnt[i] = 0;\n\t\tfor( int i = 1 ; i <= N ; i ++ ) cnt[rnk[tmp[i]]] ++;\n\t\tfor( int i = 1 ; i <= las ; i ++ ) cnt[i] += cnt[i - 1];\n\t\tfor( int i = N ; i >= 1 ; i -- ) sa[cnt[rnk[tmp[i]]] --] = tmp[i];\n\t\tlas = 0;\n\t\tfor( int i = 1 ; i <= N ; i ++ ) \n\t\t{\n\t\t\tif( ! equal( sa[i], sa[i - 1], k ) ) las ++;\n\t\t\ttmp[sa[i]] = las;\n\t\t}\n\t\tfor( int i = 1 ; i <= N ; i ++ ) rnk[i] = tmp[i];\n\t}\n\tp = 0;\n\tfor( int i = 1, j ; i <= N ; i ++ )\n\t{\n\t\tif( rnk[i] == 1 ) continue;\n\t\tif( p ) p --;\n\t\tj = sa[rnk[i] - 1];\n\t\twhile( i + p <= N && j + p <= N && dif[i + p] == dif[j + p] ) p ++;\n\t\theight[rnk[i]] = p;\n\t}\n\tfor( int i = 1 ; i <= N ; i ++ )\n\t{\n\t\tRMQ[i][0] = height[i];\n\t}\n\tinit();\n\tint res = 0, t;\n\tfor( int i = 1 ; i <= N ; i ++ )\n\t{\n\t\tfor( int j = i + 1 ; j <= N ; j ++ )\n\t\t{\n\t\t\tif( ( t = LCP( i, j ) ) >= 4 && i + t - 1 < j - 1 )\n            //\u6ce8\u610f\u5dee\u5206\u6570\u7ec4\u8f6c\u6362\u6210\u5bf9\u5e94\u7684\u539f\u5e8f\u5217\u957f\u5ea6\u65f6\u5f97\u52a0\u4e00\uff0c\u6240\u4ee5\u662f>=4\uff1b\n\t\t\t{\n\t\t\t\tres = MAX( res, t + 1 );\n\t\t\t}\n\t\t}\n\t}\n    //\u679a\u4e3e\u4e24\u4e2a\u8d77\u70b9\n\twrite( res ), putchar( '\\n' );\n\treturn 0;\n}\n```",
        "postTime": 1565613714,
        "uid": 123809,
        "name": "crashed",
        "ccfLevel": 0,
        "title": "[P2743][USACO5.1]\u4e50\u66f2\u4e3b\u9898Musical Themes"
    },
    {
        "content": "\u6700\u8fd1\u5728\u5b66SAM\uff0c\u62ffsam\u4e5f\u53ef\u4ee5\u505a\u3002\n\n\u9898\u610f\u5c31\u662f\u8ba9\u4f60\u6c42\u4e0d\u53ef\u91cd\u53e0\u6700\u957f\u91cd\u590d\u5b50\u4e32\uff0c\u53ea\u4e0d\u8fc7\u8fd9\u4e2a\u5b57\u4e32\u88ab\u52a0\u52a0\u6e10\u6e10\u4e86\u4e00\u901a\uff0c\u6240\u4ee5\u4e0d\u80fd\u76f4\u63a5\u5957\u6a21\u677f\n\n~~\u7ed3\u5408\u7269\u7406~~\u5c31\u50cf\u52bf\u80fd\u4e00\u6837\uff0c\u52bf\u80fd\u5927\u5c0f\u53ef\u4ee5\u968f\u610f\u5b9a\uff0c\u4f46\u662f\u52bf\u80fd\u5dee\u6052\u5b9a\uff0c\u6240\u4ee5\u6211\u4eec\u8f6c\u5316\u4e00\u4e0b\uff0c\n\n\u8981 5\u4e2a\u8fde\u7eed\u97f3\u7b26\u4e3b\u9898 \u7b49\u4ef7\u4e8e \u6709\u8fde\u7eed4\u6b21\u7684\u91cd\u590d\u53d8\u5316\n\u6240\u4ee5\u505a\u5dee\n\n\u7136\u540e\u8003\u8651Right\u96c6\u5408\u5b9a\u4e49:\n\n1\u3001\u6ee1\u8db3\u201c\u4e0d\u53ef\u91cd\u53e0\u201d\u8fd9\u4e00\u6761\u4ef6\u5c31\u9700\u8981|Right|>=2\uff0c\u6bcf\u4e00\u4e2a\u53f6\u5b50\u6240\u4ee3\u8868\u7684Right\u662f\u4e0d\u76f8\u4ea4\u7684\u3002\n\n2\u3001\u5f97\u51fa\u6bcf\u4e2a\u7ed3\u70b9\u7684right\u96c6\u5408\uff0c\u5c31\u80fd\u5f97\u5230\u8fd9\u4e9b\u4e32\u7684\u51fa\u73b0\u4f4d\u7f6e\uff0cright\u96c6\u5408\u5c31\u662f\u5728PARENT\u6811\u4e2d \u5b50\u6811\u5185\u7ed3\u675f\u7ed3\u70b9\u7684\u5e76\u96c6\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u5e76\u96c6\uff0c\u53ea\u9700\u8981\u6ee1\u8db3\u6761\u4ef6\u7684\u4e32\u7684\u533a\u95f4\u957f\u5ea6\n\n3\u3001\u53ef\u4ee5dp\u51faright\u96c6\u5408\u4e2d\u7684\u6700\u5927\u503c/\u6700\u5c0f\u503c\uff0c\u5dee\u503c\u548cmaxlen\u53d6\u8f83\u5c0f\u503c\u5c31\u662f\u5230\u8be5\u7ed3\u70b9\u4e32\u7b26\u5408\u9898\u610f\u7684\u6700\u957f\u957f\u5ea6\u3002\n\n\u7136\u540e\u5c31\u505a\u51fa\u6765\u4e86\n\n~~\u7740\u5b9e\u611f\u89c9\u9700\u8981\u7279\u522b\u660e\u767d\u90a3\u4e9b\u6666\u6da9\u7684\u5b9a\u4e49\u624d\u80fd\u7075\u6d3b\u5e94\u7528\u3002~~\n\n\n\n```cpp\n#include<set>\n#include<map>\n#include<ctime>\n#include<queue>\n#include<cmath>\n#include<cstdio>\n#include<vector>\n#include<cstring>\n#include<cstdlib>\n#include<iostream>\n#include<algorithm>\n#define ll unsigned long long\n#define mem(a,b) memset(a,b,sizeof(a))\n#define mec(a,b) memcpy(a,b,sizeof(b))\nusing namespace std;\nconst int  MAXN=50000+50;\nint n;\nint str[MAXN];\nll ans;\nstruct SAM\n{\n    int tot,last,cur;\n    int fa[MAXN*2],ts[MAXN*2][180];\n    int ln[MAXN*2],sz[MAXN*2],c[MAXN],q[MAXN*2];\n    int l[MAXN*2],r[MAXN*2];\n    void init(){fa[tot=last=1]=0;mem(l,0x3f);}\n    //\n    //\n    inline void extend(int x,int id)\n    {\n        int p,q,tmq;\n        cur=++tot;ln[cur]=ln[last]+1;sz[cur]=1;l[cur]=r[cur]=id;\n        for(p=last;p&&!ts[p][x];p=fa[p])\n            ts[p][x]=cur;\n        if(p==0)fa[cur]=1;\n        else \n        {\n            if(ln[p]+1==ln[q=ts[p][x]])fa[cur]=q;\n            else \n            {\n                tmq=++tot;\n                ln[tmq]=ln[p]+1;\n                fa[tmq]=fa[q];\n                fa[cur]=fa[q]=tmq;\n                mec(ts[tmq],ts[q]);\n                for(;ts[p][x]==q;p=fa[p])ts[p][x]=tmq;\n            }\n        }\n        last=cur;\n    }\n    void sort()\n    {\n        for(int i=0;i<=n;i++)c[i]=0;\n        for(int i=1;i<=tot;i++)c[ln[i]]++;\n        for(int i=1;i<=n;i++)c[i]+=c[i-1];\n        for(int i=tot;i>=1;i--)q[c[ln[i]]--]=i;\n    }\n    void solve()\n    {\n    \tint ans=0;\n    \tfor(int i=tot,u=q[i],f=fa[u],t;i>=1;u=q[--i],f=fa[u])\n    \t{\n    \t\tsz[f]+=sz[u];\n    \t\tl[f]=min(l[f],l[u]),r[f]=max(r[f],r[u]);\n    \t\tif(sz[u]>=2&&(t=min(ln[u],r[u]-l[u]-1))>=4)\n    \t\t\tans=max(ans,t);\n    \t\tif(ln[u]<4)break;\n    \t}\n    \tprintf(\"%d\",ans<4?0:ans+1);\n    }\n    \n}sam;\nint main()\n{\n    \n    scanf(\"%d\",&n);\n    sam.init();\n    int past;scanf(\"%d\",&past);n--;\n    for(int i=1,x;i<=n;i++)\n    {\n    \tscanf(\"%d\",&x);str[i]=x-past+88;past=x;\n    \t//printf(\"%3d\",str[i]);\n    \tsam.extend(str[i],i);\n    }\n    sam.sort();sam.solve();\n    \n    return 0;\n        \n}\n```",
        "postTime": 1528506148,
        "uid": 39506,
        "name": "drophell",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2743 \u3010[USACO5.1]\u4e50\u66f2\u4e3b\u9898Musical Themes\u3011"
    },
    {
        "content": "\u8fd9\u4e00\u9053\u9898\u66b4\u529b\u80af\u5b9a\u662f\u4e0d\u884c\u7684\uff08\u6211\u4e5f\u4e0d\u4f1a\u6253\u66b4\u529b\uff09\n\n\u6211\u4e00\u770b\u5230\u53ea\u8981\u662f\u91cd\u590d\u51fa\u73b0\u7684\u5c31\u53ef\u4ee5\u4e86\uff0c\u5c31\u7075\u673a\u4e00\u52a8\uff0c\u60f3\u5230\u4e86\n\nDP\uff08\u4e5f\u53ef\u4ee5\u8bf4\u662f\u9012\u63a8\uff09\uff0cf[i][j]\u8868\u793a\u4ee5i\u5f00\u5934\u548cj\u5f00\u5934\u7684\u6700\u5927\u503c\n```cpp\n#include<bits/stdc++.h>\n#define MAXN 5100\nusing namespace std;\nint n,a[MAXN];\nint f[MAXN][MAXN];\nint maxx;\nint main()\n{\n\tint i,j;\n\tscanf(\"%d\",&n);\n\tfor(i=1;i<=n;++i) scanf(\"%d\",&a[i]);//\u8f93\u5165 \n\tfor(i=1;i<=n-5;++i)//\u679a\u4e3e\u4e24\u4e2a\u9876\u70b9 \n\t{\n\t\tfor(j=i+5;j<=n;++j)//\u6700\u5c0f\u67095\u4e2a \n\t\t{\n\t\t\tif(a[i]-a[i-1]==a[j]-a[j-1])//\u5982\u679c\u53d8\u5316\u5e45\u5ea6\u76f8\u540c \n\t\t\t{\n\t\t\t\tf[i][j]=min(j-i-1,f[i-1][j-1]+1);//\u8fd9\u91cc\u4e0d\u7528f[i][j]\u662f\u56e0\u4e3af[i][[j]\u5f00\u59cb\u80af\u5b9a\u662f0\uff0c\u8fd8\u6709\u5c31\u662f\u8fd9\u4e2a\u503c\u5728\u600e\u4e48\u5927\u4e5f\u4e0d\u80fd\u91cd\u590d \n\t\t\t\tmaxx=max(maxx,f[i][j]);//\u8bb0\u5f55\u6700\u5927\u503c \n\t\t\t}\n\t\t}\n\t}\n\tif(maxx>=4) printf(\"%d\\n\",maxx+1);//\u8f93\u51fa \n\telse\t\tprintf(\"0\\n\");//\u8bb0\u5f97\u8fd9\u91cc\u6ca1\u6709\u8bb0\u5f55\u5934\uff0c\u53ea\u8bb0\u5f55\u4e86\u540e\u9762\uff0c\u6240\u4ee5\u8981+1 \n\treturn 0;\n}\n```",
        "postTime": 1527226135,
        "uid": 66181,
        "name": "Celebrate",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2743 \u3010[USACO5.1]\u4e50\u66f2\u4e3b\u9898Musical Themes\u3011"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u4e2a\u4e5f\u8bb8\u80fd\u8fc7n <= 20000\u7684\u54c8\u5e0c\u505a\u6cd5\n\n\u5e38\u89c4\u5957\u8def\uff0c\u6211\u4eec\u6c42\u51fa\u539f\u4e32\u54c8\u5e0c\u503c\uff0c\u7136\u540e\u4e8c\u5206\u7b54\u6848mid\uff0c\u4f9d\u6b21\u679a\u4e3e\u6bcf\u4e2a\u4f4d\u7f6e\u8d77\u59cb\uff0c\u957f\u4e3amid\u7684\u4e32\u662f\u5426\u51fa\u73b0\u8fc7\uff0c\u7136\u540e\u7528map\u7ef4\u62a4\u4e32\u7684\u4e0a\u4e00\u6b21\u7684\u5f00\u59cb\u4f4d\u7f6e\uff0c\u590d\u6742\u5ea6O(nlog^2n)\n\n\u5bf9\u4e8e\u8f6c\u8c03\uff0c\u5904\u7406\u539f\u6570\u7ec4\u7684\u5dee\u5206\u6570\u7ec4\u5373\u53ef\n\n\u7136\u540e\u8fd9\u91cc\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u54c8\u5e0c\u503c\u5bb9\u6613\u91cd\u590d\u3002\u6839\u636e\u67d0\uff08\u5176\u5b9e\u662f\u6211\u5fd8\u4e86\u53eb\u5565\u7684\u6982\u7387\u6a21\u578b\uff09\uff1a\u503c\u57df\u5728[0,mod]\u7684\u54c8\u5e0c\u503c\uff0c\u5bf9\u4e8e[0,20000]\u6b21\u7684\u8be2\u95ee\uff0c\u51b2\u7a81\u7684\u6982\u7387\u5176\u5b9e\u5f88\u5927\uff0c\u53ea\u662f\u56e0\u4e3aluogu\u4e0a\u6570\u636e\u5c0f\uff0c\u6240\u4ee5\u80fd\u8fc7\n\n\u89e3\u51b3\u8fd9\u4e00\u95ee\u9898\u7684\u65b9\u6cd5\u662f\u53cc\u54c8\u5e0c\u3002\u9009\u62e9\u4e24\u4e2a\u6a21\u6570\u4f5c\u4e3a\u54c8\u5e0c\uff0c\u5f00\u4e24\u4e2amap\u5206\u522b\u7ef4\u62a4\u4e24\u4e2a\u54c8\u5e0c\u503c\uff0cmap\u91cc\u7ef4\u62a4<ll,pair>\uff0cpair\u91cc\u5b58\u4f4d\u7f6e\u548c\u8fd9\u4e2a\u70b9\u7684\u53e6\u4e00\u4e2a\u54c8\u5e0c\u503c\u3002\u7136\u540e\u5728\u7b97\u67d0\u4e2a\u4f4d\u7f6e\u7684\u54c8\u5e0c\u503c\u7684\u65f6\u5019\u5462\uff0c\u4f60\u5c06\u4e24\u4e2a\u54c8\u5e0c\u503c\u90fd\u7b97\u51fa\u6765\uff0c\u54ea\u4e2a\u80fd\u591f\u548c\u4e24\u4e2a\u90fd\u5339\u914d\u4e0a\uff0c\u54ea\u4e2a\u5c31\u662f\u6b63\u786e\u7684\n\n\u8fd9\u6837\u7684\u51fa\u9519\u6982\u7387\u5c31\u5f88\u5c0f\u4e86\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<queue>\n#include<cmath> \n#include<iostream>\n#include<map>\nusing namespace std;\n#define O(x) cout << #x << \" \" << x << endl;\n#define O_(x) cout << #x << \" \" << x << \"  \";\n#define B cout << \"breakpoint\" << endl;\n#define pii pair<ll,int>\n#define mp make_pair\ntypedef double db;\ntypedef long long ll;\ninline int read()\n{\n    int ans = 0,op = 1;\n    char ch = getchar();\n    while(ch < '0' || ch > '9')\n    {\n        if(ch == '-') op = -1;\n        ch = getchar();\n    }\n    while(ch >= '0' && ch <= '9')\n    {\n        (ans *= 10) += ch - '0';\n        ch  = getchar();\n    }\n    return ans * op;\n}\nconst int maxn = 5005;\nconst ll b = 5505;\nconst ll mod0 = 998244353;\nconst ll mod1 = 19260817;\nll hash[maxn][2],base[maxn][2];\nint a[maxn],val[maxn];\nint n;\nbool check(int l)\n{\n    l--;\n    map<ll,pii> m0,m1;\n    for(int i = 1;i <= n - l;i++)\n    {\n        ll tp0 = (hash[i + l - 1][0] - hash[i - 1][0] * base[l][0] % mod0 + mod0) % mod0;\n        ll tp1 = (hash[i + l - 1][1] - hash[i - 1][1] * base[l][1] % mod1 + mod1) % mod1;\n        if(m0[tp0].second)\n        {\n        \tpii u0 = m0[tp0];\n        \tll val0 = u0.first,lt = u0.second;\n        \tif(val0 == tp1 && i - lt >= l + 1) return 1;\n        }\n        if(m1[tp1].second)\n        {\n        \tpii u1 = m1[tp1];\n        \tll val1 = u1.first,lt = u1.second;\n        \tif(val1 == tp0 && i - lt >= l + 1) return 1;\n        }\n        if(!m1[tp1].second && !m0[tp0].second) \n        {\n        \tm0[tp0] = mp(tp1,i);\n        \tm1[tp1] = mp(tp0,i);\n        }\n    }\n    return 0;\n}\nint main()\n{\n    n = read();\n    base[0][0] = base[0][1] = 1;\n    for(int i = 1;i <= n;i++)\n        val[i] = read();\n    for(int i = 1;i < n;i++)\n    {\n        a[i] = val[i + 1] - val[i] + 88;\n        base[i][0] = (base[i - 1][0] * b) % mod0;\n        hash[i][0] = (hash[i - 1][0] * b % mod0 + (ll)a[i]) % mod0;\n        base[i][1] = (base[i - 1][1] * b) % mod1;\n        hash[i][1] = (hash[i - 1][1] * b % mod1 + (ll)a[i]) % mod1;\n    }\n    int l = 5,r = n;\n    int ans = 0;\n    while(l < r)\n    {\n        int mid = l + r >> 1;\n        if(check(mid))\n            l = mid + 1,ans = max(ans,mid);\n        else r = mid;\n    }\n    printf(\"%d\",ans);\n}\n        \n\n```\n\n\n",
        "postTime": 1558518436,
        "uid": 86721,
        "name": "L_M_",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2743 \u3010[USACO5.1]\u4e50\u66f2\u4e3b\u9898Musical Themes\u3011"
    },
    {
        "content": "\u6765\u4e00\u53d1\u540e\u7f00\u6570\u7ec4\u7684\u9898\u89e3\u3002\u3002\n\n\u540e\u7f00\u6570\u7ec4\u662f\u5565\uff0c\u8bf7\u89c1\u56fd\u5bb6\u96c6\u8bad\u961f\u8bba\u6587\u3002\u3002\u3002\u3002\u5176\u5b9e\u6211\u53ea\u662f\u4e2a\u5f31\u9e21\u3002\u3002\u3002\u3002\u3002\uff08\u9003~~~~\uff09\n\n\u00b7\u00b7\n\n\n\n\n    \n\n\n    \n\n        \n```cpp\n#include <iostream>\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\nusing namespace std;\nint _rank[20005],wb[20005],wv[20005],wss[20005];\nint n;\nint height[20005],sa[20005];\ninline int read()\n{\n    int x=0,f=1;\n    char c=getchar();\n    while(c<'0' || c>'9')\n    {\n        if(c=='-') f=-1;\n        c=getchar();\n    }\n    while(c>='0' && c<='9')\n    {\n        x=x*10+c-48;\n        c=getchar();\n    }\n    return x*f;\n}\nbool cmp(int *r,int a,int b,int l)  \n{  \n    return r[a]==r[b] && r[a+l]==r[b+l];  \n}  \nvoid da(int *r,int *sa,int n,int m)\n{\n    int i,j,p,*x=_rank,*y=wb,*t;\n    for(i=0;i<m;i++) wss[i]=0;\n    for(i=0;i<n;i++) wss[x[i]=r[i]]++;\n    for(i=1;i<m;i++) wss[i]+=wss[i-1];\n    for(i=n-1;i>=0;i--)\n        sa[--wss[x[i]]]=i;\n    for(j=1,p=1;p<n;j*=2,m=p)\n    {\n        for(p=0,i=n-j;i<n;i++) y[p++]=i;\n        for(i=0;i<n;i++) if(sa[i]>=j) y[p++]=sa[i]-j;\n        for(i=0;i<n;i++) wv[i]=x[y[i]];\n        for(i=0;i<m;i++) wss[i]=0;\n        for(i=0;i<n;i++) wss[wv[i]]++;\n        for(i=1;i<m;i++) wss[i]+=wss[i-1];\n        for(i=n-1;i>=0;i--) sa[--wss[wv[i]]]=y[i];\n        for(t=x,x=y,y=t,p=1,x[sa[0]]=0,i=1;i<n;i++)\n        x[sa[i]]=cmp(y,sa[i-1],sa[i],j)?p-1:p++;\n    }\n}\nvoid calheight(int *r,int n)\n{\n    int i,j,k=0;\n    for(i=1;i<=n;i++)    _rank[sa[i]]=i;\n    for(i=0;i<n;height[_rank[i++]]=k)\n        for(k?k--:0,j=sa[_rank[i]-1];r[i+k]==r[j+k];k++); \n}\nbool judge(int k,int n)\n{\n    int i,mx,mi;\n    mx=mi=sa[1];\n    for(i=2;i<=n;i++)\n    {\n        if(height[i]>=k&&i<=n)\n        {\n            mi=min(mi,sa[i]);\n            mx=max(mx,sa[i]);\n            if(mx-mi>k)    return 1;\n            continue;\n        }\n            mx=mi=sa[i];\n    }\n    return 0;\n}\nint main()\n{\n    int s[20005],r1[20005];\n    int l,i;\n    scanf(\"%d\",&l);\n        for(i=0;i<l;i++)\n            scanf(\"%d\",&s[i]); \n        for(i=0;i<l-1;i++)    s[i]=s[i+1]-s[i]+100;\n        for(i=0;i<l;i++)    r1[i]=s[i];\n        r1[--l]=0;\n        da(r1,sa,l+1,200);\n        calheight(r1,l);\n```\n/\\*\n\u4e0d\u53ef\u91cd\u53e0\u6700\u957f\u91cd\u590d\u5b50\u4e32\n\n    \n\u4e8c\u5206\u4e00\u4e2a\u7b54\u6848k\uff0c\u7136\u540e\u5bf9height\u8fdb\u884c\u5206\u7ec4\u3002\u3002\u3002\n\n\u6709\u5e0c\u671b\u6210\u4e3a\u6700\u957f\u516c\u5171\u524d\u7f00\u4e0d\u5c0f\u4e8ek\u7684\u4e24\u4e2a\u540e\u7f00\u4e00\u5b9a\u5728\u540c\u4e00\u7ec4\u3002\n\n\u7136\u540e\u5bf9\u4e8e\u6bcf\u7ec4\u540e\u7f00\uff0c\n\n\u53ea\u987b\u5224\u65ad\u6bcf\u4e2a\u540e\u7f00\u7684sa\u503c\u7684\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\u4e4b\u5dee\u662f\u5426\u4e0d\u5c0f\u4e8ek\u3002\n\n\u5982\u679c\u6709\u4e00\u7ec4\u6ee1\u8db3\uff0c\u5219\u8bf4\u660e\u5b58\u5728\uff0c\u5426\u5219\u4e0d\u5b58\u5728\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(nlogn)\u3002\n\n\\*/\n\n        \n```cpp\n    /*for(i=0; i<l; i++)  // _rank[i] : suffix(i)\u6392\u7b2c\u51e0  \n        printf(\"_rank[%d] =  %d\\n\",i,_rank[i]);  \n    printf(\"\\n\");  \n    for(i=1; i<=l; i++)   // sa[i] : \u6392\u5728\u7b2ci\u4e2a\u7684\u662f\u8c01  \n        printf(\"sa[%d] =  %d\\n\",i,sa[i]);\n    printf(\"\\n\");\n    for(i=1; i<=l; i++)   // height[i]\uff1asuffix(sa[i-1])\u548csuffix(sa[i])\u7684\u6700\u957f\u516c\u5171\u524d\u7f00\uff0c\u4e5f\u5c31\u662f\u6392\u540d\u76f8\u90bb\u7684\u4e24\u4e2a\u540e\u7f00\u7684\u6700\u957f\u516c\u5171\u524d\u7f00\n        printf(\"height[%d] =  %d\\n\",i,height[i]); */\n        int li=4,ri=l/2,mid;\n        int ans=0;\n        while(li<=ri)\n         {\n              mid=(li+ri)/2;\n                if(judge(mid,l))\n            {\n                ans=mid;\n                    li=mid+1;\n            }\n            else    \n                ri=mid-1;\n        }\n        ans++;\n        printf(\"%d\\n\",ans<5?0:ans);\n    return 0;\n}\n\u00b7\u00b7\n```",
        "postTime": 1501382174,
        "uid": 20929,
        "name": "void_zxh",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2743 \u3010[USACO5.1]\u4e50\u66f2\u4e3b\u9898Musical Themes\u3011"
    },
    {
        "content": "\u6211\u53ea\u80fd\u8bf4\u6211\u7684\u65b9\u6cd5\u975e\u5e38\u7279\u522b\uff0c\u6253\u5b8c\u4e00\u4e2aO(n^3)\u7684\u66b4\u529b\u4ee5\u540e\u53d1\u73b0\u670979\u5206\uff0c\u597d\u795e\u5947\uff0c\u7136\u540e\u6211\u5f00\u59cb\u60f3\u600e\u4e48\u4f18\u5316\u66b4\u529b\uff0c\u7136\u540e\u53d1\u73b0\u4e86\u4e00\u4e2a\u5de7\u5999\u7684\u6027\u8d28\u6211\u4eec\u7528\u4e00\u4e2a\u6570\u7ec4dp[i][j]\u4ee3\u8868\u4ee5i\u5f00\u5934\u548c\u4ee5j\u5f00\u5934\u7684\u5b50\u4e32\u7684\u6700\u5927\u4e3b\u9898\u957f\u5ea6\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u5982\u679c\u4f60\u8981\u6c42dp[i][j]\u7684\u503c\uff0c\u53ef\u4ee5\u4ece\u4e0a\u4e00\u6b21dp[i-1][j-1]\u63a8\u8fc7\u6765\uff0c\u4ec0\u4e48\u610f\u601d\u5462\uff1f\u5c31\u662f\u4f60\u4ecei-1\uff0cj-1\u5f00\u59cb,\u53d1\u73b0\u6709dp[i-1][j-1]\u8fd9\u4e48\u957f\u7684\u91cd\u590d\u957f\u5ea6\uff0c\u90a3\u6211\u4eec\u5c31\u6ca1\u5fc5\u8981\u4ecei\uff0cj\u5f00\u59cb\u7b97\uff0c\u76f4\u63a5\u4ecei+dp[i-1][j-1]-1,j+dp[i-1][j-1]-1\u5f00\u59cb\u7b97\u5c31\u53ef\u4ee5\u4e86\uff0c\u8fd9\u6837\u7701\u53bb\u4e86\u5f88\u591a\u6ca1\u5fc5\u8981\u7684\u6bd4\u8f83\uff0c\u6709\u70b9\u7c7b\u4f3cKMP\u7684\u601d\u60f3\uff0c\u8fd9\u6837\u5e94\u8be5\u53ef\u4ee5\u8fbe\u5230\u8fd1\u4f3cO\uff08n^2\uff09\uff0c\u901f\u5ea6\u4e5f\u4e0d\u6162\u3002\n\n/*************************************************************************\n\n    > File Name: \u4e50\u66f2\u4e3b\u9898.cpp\n    > Author: Drinkwater-cnyali\n    > Created Time: 2017/5/7 23:00:41\n************************************************************************/\n\n\n\n\n\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cmath>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\n#define REP(i, a, b) for(register int i = (a), i##_end_ = (b); i <= i##_end_; ++ i)\n#define DREP(i, a, b) for(register int i = (a), i##_end_ = (b); i >= i##_end_; -- i)\n#define mem(a, b) memset((a), b, sizeof(a))\nint read()\n{\n    int sum = 0, fg = 1; char c = getchar();\n    while(c < '0' || c > '9') { if (c == '-') fg = -1; c = getchar(); }\n    while(c >= '0' && c <= '9') { sum = sum * 10 + c - '0'; c = getchar(); }\n    return sum * fg;\n}\nconst int maxn = 5010;\nint n;\nint a[maxn],ans;\nint dp[maxn][maxn];\nint main()\n{\n    n = read();\n    REP(i,1,n)a[i] = read();\n    for(int i=1;i<=n-5;++i)\n    {\n        for(int j=i+5;j<=n;j++)\n        {\n            int c = a[i] - a[j];\n            int sum = max(dp[i-1][j-1]-1,0);\n            int len = max(dp[i-1][j-1]-1,0);\n            for(int l=i+len,r=j+len;\n                    l<=min(j-1,n)&&r<=n;++l,++r)\n            {\n                if(a[l] != a[r] + c)break;\n                if(a[l] == a[r] + c)sum++;\n                ans = max(ans,sum);\n            }\n            dp[i][j] = sum;\n        }\n    }\n    if(ans < 5)puts(\"0\");\n    else printf(\"%d\",ans);\n    return 0;\n}\n\n```",
        "postTime": 1494173434,
        "uid": 19645,
        "name": "Drinkwater",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2743 \u3010[USACO5.1]\u4e50\u66f2\u4e3b\u9898Musical Themes\u3011"
    },
    {
        "content": "\u6211\u53bb\u6211\u5c45\u7136\u4e00\u5f00\u59cb\u7528\u4e8c\u5206\u7b54\u6848\u505a\uff0c\u6ca1\u770b\u51fa\u6765\u8fd9\u662f\u6700\u957f\u516c\u5171\u5b50\u4e32dp\u7684\u53d8\u4f53\u3002\uff08\u8bf7\u5173\u7231\u5f31\u667a\u513f\u7ae5\uff09\n\n\n\n\n\n```cpp\n#include<iostream>\n#include<cmath>\n#include<algorithm>\n#include<cstring>\n#include<string>\n#include<cstdio>\n#include<queue>\n#include<stack>\n#include<set>\n#include<map>\n#include<vector>\n#include<climits>\n#define rep(i,s,n) for(int (i)=(s);(i)<=(n);(i)++)\nusing namespace std;\nconst int maxn=5010;\n```\nstatic int dp[maxn][maxn],cha[maxn],a[maxn],n,\n\n\n\n```cpp\n                      ans;\ninline void init()\n{\n    scanf(\"%d\",&n);\n    rep(i,1,n) scanf(\"%d\",&a[i]);\n    rep(i,1,n-1) rep(j,i+1,n) dp[i][j]=dp[j][i]=1;\n    rep(i,2,n) cha[i]=a[i]-a[i-1];\n}\nint main()\n{\n  freopen(\"e:/in.txt\",\"r\",stdin);\n     init();\n     rep(i,2,n)\n       rep(j,i+1,n)\n       if(cha[i]==cha[j]&&j-i>dp[i-1][j-1])\n    {\n        dp[i][j]=max(dp[i][j],dp[i-1][j-1]+1);\n        ans=max(dp[i][j],ans);\n        }\n  printf(\"%d\",ans>4 ? ans:0);\n  return 0;\n}//by lyyz-ljy\n```",
        "postTime": 1474799879,
        "uid": 17378,
        "name": "Vin_1999",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2743 \u3010[USACO5.1]\u4e50\u66f2\u4e3b\u9898Musical Themes\u3011"
    },
    {
        "content": "[\u6233\u6211\u83b7\u5f97\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8cqwq](https://www.goldenpotato.cn/%E5%AD%97%E7%AC%A6%E4%B8%B2/luogu-p2743-usaco5-1%E4%B9%90%E6%9B%B2%E4%B8%BB%E9%A2%98musical-themes/)\n\n---\n# Solution\n\u8fd9\u9898\u53ef\u4ee5\u7528\u54c8\u5e0c\u505a\uff0c\u4e5f\u53ef\u4ee5\u7528SA\u505a\u3002\u4e0b\u9762\u6211\u4eec\u5206\u522b\u8bb2\u4e00\u4e0b\u4e24\u79cd\u505a\u6cd5\u3002\n\n### \u54c8\u5e0c\n\u9996\u5148\uff0c\u6211\u4eec\u628a\u8f6c\u6389\u7684\u95ee\u9898\u5904\u7406\u6389\u3002\u6211\u4eec\u8003\u8651\u628a\u539f\u4e32\u505a\u5dee\u5206\u6570\u7ec4\uff0c\u5373\u7528\u540e\u9762\u90a3\u4e00\u4e2a\u51cf\u53bb\u524d\u9762\u90a3\u4e00\u4e2a\u3002\u8fd9\u6837\u5b50\uff0c\u6211\u4eec\u76f4\u63a5\u5728\u65b0\u7684\u4e32\u4e0a\u627e\u5b8c\u5168\u76f8\u540c\u7684\u4e24\u4e2a\u4e0d\u53ef\u91cd\u53e0\u5b50\u4e32\u5373\u53ef\u3002\n\n\u8fd9\u4e2a\uff0c\u6211\u4eec\u8003\u8651\u5148\u5728\u5916\u9762\u4e8c\u5206\u4e00\u4e2a\u7b54\u6848\u7684\u957f\u5ea6\uff0c\u7136\u540e\u66b4\u529b\u505a\uff0c\u4ece\u540e\u5f80\u524d\u626b\uff0c\u628a\u6240\u6709\u5b50\u4e32\u90fd\u4e22\u5230\u54c8\u5e0c\u8868\u91cc\u9762\uff0c\u63d2\u5165\u4e00\u4e2a\u65b0\u7684\u4e32\u4e4b\u524d\uff0c\u5c31\u68c0\u67e5\u4e00\u4e0b\u4e4b\u524d\u662f\u5426\u6709\u8fd9\u4e2a\u4e32\uff0c\u5982\u679c\u6709\u7684\u8bdd\uff0c\u5c31\u68c0\u67e5\u4e00\u4e0b\u662f\u5426\u6ee1\u8db3\u76f8\u9694\u957f\u5ea6\u662f\u5426\u5927\u4e8emid\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(nlogn)$\n\n\n### \u540e\u7f00\u6570\u7ec4\n\u8fd9\u9898\u7684\u540e\u7f00\u6570\u7ec4\u505a\u6cd5\u5c31\u6bd4\u8f83\u5999\u4e86\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u8fd8\u662f\u8981\u505a\u5dee\u5206\u6570\u7ec4\u7684\u3002\n\u7136\u540e\uff0c\u6211\u4eec\u8fd8\u662f\u8981\u6c42\u51faSA\u53caheight\u7684(\u4e0d\u4f1aSA\u7684\u5c0f\u4f19\u4f34\u53ef\u4ee5\u770b[\u8fd9\u91cc](https://www.goldenpotato.cn/\u5b57\u7b26\u4e32/\u540e\u7f00\u6570\u7ec4sa\u5b66\u4e60\u7b14\u8bb0/))\n\u7136\u540e\uff0c\u6211\u4eec\u4ecd\u7136\u662f\u5728\u5916\u9762\u4e8c\u5206\u7b54\u6848\uff0c\u7136\u540e\u8003\u8651\u600e\u4e48\u68c0\u67e5\u3002\n\n\u56e0\u4e3a\u6bcf\u4e2a\u4e32\u4e0d\u53ef\u91cd\u590d\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u628aheight\u6570\u7ec4\u5206\u7ec4\uff0c\u6211\u4eec\u5e0c\u671b\u4e00\u4e2a\u7ec4\u5c3d\u53ef\u80fd\u957f\uff0c\u5e76\u4e14\u7ec4\u5185\u6240\u6709\u5143\u7d20\u7684$height>=mid$\uff0c\u8fd9\u6837\u5b50\uff0c\u5982\u679c\u8fd9\u4e2a\u7ec4\u91cc\u9762\u6709\u4e24\u4e2a\u539f\u6570\u7684sa\u76f8\u9694\u8d85\u8fc7mid\uff0c\u5219\u8bf4\u660e\u8fd9\u4e2a\u7ed3\u679c\u662f\u6b63\u786e\u7684\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(nlogn)$\n\n---\n# Code\nsa\u505a\u6cd5\u7eaf\u5c5eyy\uff0c\u5982\u679c\u8bb2\u7206\u4e86\u8fd8\u8bf7\u5404\u4f4ddalao\u6307\u51faqwq\n\n\u6211\u5199\u7684\u53cc\u6a21hash\uff0c\u800c\u4e14\u6ca1\u6709\u4f7f\u7528\u54c8\u5e0c\u8868\uff0c\u7528\u7684\u662fset\uff0c\u603b\u590d\u6742\u5ea6$O(nlog^2n)$\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<set>\nusing namespace std;\nconst int N=20000+100;\nconst int E=233;\nconst int P2=2333333333;\nint n;\nunsigned long long POW[N];\nlong long POW2[N],c[N];\nvoid Init()\n{\n    POW2[0]=POW[0]=1;\n    for(int i=1;i<=n;i++)\n        POW[i]=POW[i-1]*E,\n        POW2[i]=(POW2[i-1]*E)%P2;\n}\nstruct rec\n{\n    unsigned long long hash;\n    long long hash2;\n    int t;\n    friend bool operator < (rec a,rec b)\n    {\n        if(a.hash==b.hash)\n            return a.hash2<b.hash2;\n        return a.hash<b.hash;\n    }\n};\nset <rec> record;\nbool Check(int ans)\n{\n    record.clear();\n    unsigned long long hash=0;\n    long long hash2=0;\n    for(int i=1;i<=ans;i++)\n    {\n        hash=hash+c[i]*POW[ans-i+1];\n        hash2=(hash2+c[i]*POW2[ans-i+1])%P2;\t\n    }\n    record.insert((rec){hash,hash2,ans});\n    for(register int i=ans+1;i<n;i++)\n    {\n        hash=(hash-c[i-ans]*POW[ans])*E+c[i]*E;\n        hash2=((((hash2-c[i-ans]*POW2[ans])*E+c[i]*E)%P2)+P2)%P2;\n        set <rec> :: iterator p=record.lower_bound((rec){hash,hash2,0});\n        if((*p).hash==hash and (*p).hash2==hash2)\n        {\n            if(i-(*p).t>=ans)\n                return true;\n        }\n        else\n            record.insert((rec){hash,hash2,i});\n    }\t\t\n    return false;\n}\nint main()\n{\n    scanf(\"%d\",&n);\n    for(register int i=1;i<=n;i++)\n        scanf(\"%lld\",&c[i]);\n    for(register int i=1;i<n;i++)\n        c[i]=c[i+1]-c[i];\n    Init();\n    \n    int L=4,R=n,mid,ans=0;\n    while(L<=R)\n    {\n        mid=(L+R)>>1;\n        if(Check(mid)==true)\n            ans=mid+1,L=mid+1;\n        else\n            R=mid-1;\n    }\n    \n    if(ans==6) ans++;\n    printf(\"%d\",ans);\n    return 0;\n}\n\n```\n\n\n\n\n",
        "postTime": 1551846589,
        "uid": 52563,
        "name": "GoldenPotato137",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2743 \u3010[USACO5.1]\u4e50\u66f2\u4e3b\u9898Musical Themes\u3011"
    }
]
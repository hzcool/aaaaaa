[
    {
        "content": "## \u6d1b\u8c37P3631 [APIO2011]\u65b9\u683c\u67d3\u8272 \u9898\u89e3\r\n\r\n### \u7b80\u8981\u9898\u610f\uff1a\r\n\u5728\u4e00\u4e2a$n \\times m$\u7684\u65b9\u683c\u4e2d\u7684\u6570\u5b57\u4e0d\u662f$0$\u5c31\u662f$1$\uff0c\u73b0\u5728\u77e5\u9053\u4e00\u90e8\u5206\u6570\u5b57\uff0c\u95ee\u6709\u591a\u5c11\u79cd\u65b9\u5f0f\u4f7f\u5f97\u6bcf\u4e2a$2 \\times 2$\u5927\u5c0f\u7684\u65b9\u683c\u5185\u7684\u6570\u5b57\u7684\u5f02\u6216\u548c\u4e3a$1$\r\n\r\n### \u9898\u89e3\uff1a\r\n\u5185\u5bb9\u90e8\u5206\u53c2\u8003\u81ea[\u5927\u4f6c\u7684\u9898\u89e3](https://blog.csdn.net/Arya__/article/details/45458517)\r\n\r\n\u9996\u5148\u8fd8\u662f\u90a3\u53e5\u8001\u8bdd\uff1a\u5f02\u6216\u7684\u4e00\u4e2a\u7279\u6027\uff1a$$a \\bigoplus b \\bigoplus a = b$$\r\n\r\n\u7136\u540e\u6839\u636e\u8fd9\u4e2a\u7279\u6027\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4ec0\u4e48\u5462\uff1f\r\n\r\n![](https://cdn.luogu.com.cn/upload/pic/31068.png)\r\n\r\n\u5047\u8bbe\u6211\u4eec\u73b0\u5728\u6709\u8fd9\u4e48\u4e00\u4e2a\u8868\u683c\uff0c\u90a3\u4e48\u6839\u636e\u9898\u610f\u53ef\u4ee5\u5f97\u51fa\uff1a\r\n\r\n$A \\bigoplus B \\bigoplus C \\bigoplus D=C \\bigoplus D \\bigoplus E \\bigoplus F = E \\bigoplus F \\bigoplus G \\bigoplus H = 1$\r\n\r\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u76f8\u90bb\u7684\u4e24\u4e2a\u5f0f\u5b50\u5f02\u6216\u4e00\u4e0b\uff0c\u4f8b\u5982\uff1a\r\n\r\n$(A \\bigoplus B \\bigoplus C \\bigoplus D) \\bigoplus (C \\bigoplus D \\bigoplus E \\bigoplus F)$\r\n\r\n$= 1 \\bigoplus 1$\r\n\r\n$=0$\r\n\r\n$\\Rightarrow A \\bigoplus B \\bigoplus E \\bigoplus F =0$\r\n\r\n\u4e5f\u501f\u6b64\u53ef\u4ee5\u63a8\u51fa\uff1a\r\n\r\n$A \\bigoplus B \\bigoplus G \\bigoplus H = 1$\r\n\r\n\u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u4e2a\u5f0f\u5b50\u63a8\u5e7f\u4e00\u4e0b\u3002\u5047\u8bbe\u8fd9\u91cc\u53c8\u6709\u4e00\u5f20\u66f4\u5927\u7684\u8868\u683c\uff1a\r\n\r\n![](https://cdn.luogu.com.cn/upload/pic/31071.png)\r\n\r\n\u8fd9\u662f\u4e00\u5f20$4 \\times 4$\u7684\u8868\u683c\uff0c\u5047\u8bbe\u5b83\u8fd8\u662f\u9075\u5faa\u9898\u610f\u3002\r\n\r\n\u6211\u4eec\u53ef\u4ee5\u6309\u7167\u4e0a\u9762\u7684\u601d\u8def\u7ee7\u7eed\u505a\u4e0b\u53bb\uff1a\r\n\r\n$\\because A \\bigoplus B \\bigoplus E \\bigoplus F = E \\bigoplus F \\bigoplus I \\bigoplus J$\r\n\r\n$\\therefore A \\bigoplus B \\bigoplus I \\bigoplus J = 0$\r\n\r\n$\\because F \\bigoplus G \\bigoplus J \\bigoplus K = 1$\r\n\r\n$\\because A \\bigoplus E \\bigoplus C \\bigoplus G = 0$\r\n\r\n$\\because E \\bigoplus I \\bigoplus G \\bigoplus K = 0$\r\n\r\n$\\therefore A \\bigoplus C \\bigoplus I \\bigoplus K = 0$\r\n\r\n\u7136\u540e\u518d\u63a8\u5e7f\u51fa\u53bb\uff0c\u5bf9\u4e8e\u4e0d\u540c\u7684\u683c\u5b50\uff0c\u6211\u4eec\u8fdb\u884c\u7c7b\u4f3c\u64cd\u4f5c\uff0c\u53ef\u4ee5\u76f4\u89c2\u5730\u53d1\u73b0\uff0c\u5982\u679c\u6211\u4eec\u4efb\u610f\u679a\u4e3e\u4e00\u4e2a\u65b9\u683c\u7684\u5de6\u4e0a\u70b9$\\{1,1\\}$\u548c\u53f3\u4e0b\u70b9$\\{x,y\\}$\uff0c\u5982\u679c$\\{x,y\\}$\u90fd\u4e3a\u5076\u6570\u7684\u65f6\u5019\uff0c\u603b\u5171\u6709\u5947\u6570\u4e2a\u5927\u5c0f\u4e3a$2 \\times 2$\u7684\u65b9\u683c\uff0c\u8fd9\u4e5f\u5c31\u610f\u5473\u7740\u603b\u5f02\u6216\u503c\u4e3a$1$\uff0c\u5426\u5219\u603b\u5171\u6709\u5076\u6570\u4e2a\u5927\u5c0f\u4e3a$2 \\times 2$\u7684\u65b9\u683c\uff0c\u603b\u5f02\u6216\u503c\u4e3a$0$\u3002\r\n\r\n\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u7ed3\u8bba\uff1a\u5982\u679c\u539f\u65b9\u683c\u5185\u7684\u7b2c\u4e00\u884c\u7b2c\u4e00\u5217\u7684\u683c\u5b50\u88ab\u786e\u5b9a\uff0c\u90a3\u4e48\u6574\u4e2a\u65b9\u683c\u5373\u53ef\u88ab\u552f\u4e00\u786e\u5b9a\u3002\r\n\r\n\u63a5\u4e0b\u6765\u5c31\u8981\u5f00\u59cb\u601d\u8003\u5982\u4f55\u8ba1\u7b97\u4e86\u3002\u6309\u7167\u4e0a\u9762\u7684\u7ed3\u8bba\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5982\u679c$\\{1,1\\}$\u8fd9\u4e2a\u70b9\u88ab\u786e\u5b9a\u4e86\uff0c\u90a3\u4e48$\\{1,j\\}$\u548c$\\{i,1\\}$\u7684\u5173\u7cfb\u4e5f\u5c31\u88ab\u786e\u5b9a\u4e86\uff0c\u4e5f\u5c31\u662f\u4e00\u5b9a\u76f8\u7b49\u548c\u4e00\u5b9a\u4e0d\u76f8\u7b49\u3002\u7136\u540e\u63a5\u4e0b\u6765\u8981\u7ef4\u62a4\u76f8\u7b49\u548c\u4e0d\u76f8\u7b49\u7684\u5173\u7cfb\uff0c\u5f88\u663e\u7136\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a\u5e26\u6743\u5e76\u67e5\u96c6\u6765\u5b9e\u73b0\u8fd9\u4e9b\u64cd\u4f5c\u3002\r\n\r\n\u901a\u8fc7\u5408\u5e76\u7684\u64cd\u4f5c\uff0c\u5230\u4e86\u6700\u540e\u4f1a\u6709\u5f88\u591a\u7684\u8054\u901a\u5757\u3002\u9664\u4e86$\\{1,1\\}$\u8fd9\u4e2a\u70b9\u6240\u5728\u7684\u8054\u901a\u5757\u4e4b\u5916\uff0c\u5176\u4ed6\u7684\u6bcf\u4e2a\u8054\u901a\u5757\u90fd\u6709\u4e24\u79cd\u60c5\u51b5\uff0c\u56e0\u6b64\u6700\u540e\u7684\u7b54\u6848\u5c31\u662f$2^{\\text{\u8054\u901a\u5757\u4e2a\u6570}-1}$\r\n\r\n\u63a5\u4e0b\u6765\u5c31\u662f\u4ee3\u7801\u7ec6\u8282\u4e86\u3002\r\n\r\n```cpp\r\n#include <iostream>\r\n#include <cstdio>\r\n#include <algorithm>\r\n#include <cmath>\r\n#include <cstring>\r\n#include <cctype>\r\n\r\nusing namespace std;\r\n\r\nconst int mod=1e9;\r\n\r\nint read()\r\n{\r\n\tint x=0,f=1;char ch=getchar();\r\n\twhile (!isdigit(ch)){if (ch=='-') f=-1;ch=getchar();}\r\n\twhile (isdigit(ch)){x=x*10+ch-48;ch=getchar();}\r\n\treturn x*f;\r\n}\r\n\r\nint n,m,k,x[100050],y[100050],z[100050];\r\n\r\nint fa[200050],g[200050];\r\n\r\nint Find(int x)\r\n{\r\n\tif (x==fa[x])\r\n\t\treturn x;\r\n\tint t=Find(fa[x]);\r\n\tg[x]^=g[fa[x]];\r\n\treturn fa[x]=t;\r\n}\r\n\r\nlong long quickpow(long long a,long long b)\r\n{\r\n    long long ans=1;\r\n    while (b!=0)\r\n    {\r\n        if (b&1)\r\n        {\r\n            ans*=a;\r\n            ans%=mod;\r\n        }\r\n        a*=a;\r\n        a%=mod;\r\n        b>>=1;\r\n    }\r\n    return ans;\r\n}\r\n\r\n\r\nint Calc(int opt)\r\n{\r\n\tfor (int i=1;i<=n+m;i++)\r\n\t{\r\n\t\tfa[i]=i;\r\n\t\tg[i]=0;\r\n\t}\r\n\tfa[n+1]=1;\r\n\tif (opt==1)\r\n\t{\r\n\t\tfor (int i=1;i<=k;i++)\r\n\t\t\tif (x[i]>1 && y[i]>1)\r\n\t\t\t\tz[i]^=1;\r\n\t}\r\n\tfor (int i=1;i<=k;i++)\r\n\t{\r\n\t\tint x=::x[i],y=::y[i],z=::z[i];\r\n\t\tif (x!=1 || y!=1)\r\n\t\t{\r\n\t\t\tint fx=Find(x),fy=Find(n+y);\r\n\t\t\tint ty=g[x]^g[n+y]^z;\r\n\t\t\tif (fx!=fy)\r\n\t\t\t{\r\n\t\t\t\tfa[fy]=fx;\r\n\t\t\t\tg[fy]=ty;\r\n\t\t\t}\r\n\t\t\telse if (ty)\r\n\t\t\t\treturn 0;\r\n\t\t}\r\n\t}\r\n\tint tot=0;\r\n\tfor (int i=1;i<=n+m;i++)\r\n\t\tif (i==Find(i))\r\n\t\t\ttot++;\r\n\treturn quickpow(2,tot-1);\r\n}\r\n\r\nint main()\r\n{\r\n\tn=read();\r\n\tm=read();\r\n\tk=read();\r\n\tint flag=-1;\r\n\tfor (int i=1;i<=k;i++)\r\n\t{\r\n\t\tx[i]=read();\r\n\t\ty[i]=read();\r\n\t\tz[i]=read();\r\n\t\tif ((!(x[i]&1)) && (!(y[i]&1)))\r\n\t\t\tz[i]^=1;\r\n\t\tif (x[i]==1 && y[i]==1)\r\n\t\t\tflag=z[i];\r\n\t}\r\n\tif (flag!=-1)\r\n\t\tcout << Calc(flag) << endl;\r\n\telse\r\n\t\tcout << (Calc(0)+Calc(1))%mod << endl;\r\n\treturn 0;\r\n}\r\n\r\n```",
        "postTime": 1535526817,
        "uid": 8457,
        "name": "chen_zhe",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3631 \u3010[APIO2011]\u65b9\u683c\u67d3\u8272\u3011"
    },
    {
        "content": "[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/P3631)\n\n\u521a\u521a\u505a\u4e86\u8fd9\u9053\u9898\uff0c\u611f\u89c9\u8fd9\u9898\u6709\u8bf8\u591a\u7ec6\u8282\uff08~~\u8c03\u4e86\u6211\u51e0\u4e2a\u5c0f\u65f6~~\uff09\uff0c\u540e\u6765\u53d1\u73b0\u5927\u5bb6\u7684\u4ee3\u7801\u592a\u9ebb\u70e6\u4e86\uff0c\u4e8e\u662f\u8fc7\u6765\u5199\uff08shui\uff09\u7bc7\u9898\u89e3\u3002\n\n\u8fd9\u9053\u9898\u601d\u8def\u5927\u81f4\u662f\u8fd9\u6837\u7684\uff08\u8bb0$(x,y)$\u8868\u793a\u683c\u5b50$(x,y)$\u7684\u989c\u8272\uff09\uff1a\n\n$$(x,y)\\oplus(x-1,y)\\oplus(x,y-1)\\oplus(x-1,y-1)=1$$\n\n\u4ee4$x=x-1$\uff0c\u6709\uff1a\n\n$$(x-1,y)\\oplus(x-2,y)\\oplus(x-1,y-1)\\oplus(x-2,y-1)=1$$\n\n\u4e24\u5f0f\u5f02\u6216\u8d77\u6765\u5f97\u5230\uff1a\n\n$$(x,y)\\oplus(x,y-1)\\oplus(x-2,y)\\oplus(x-2,y-1)=0$$\n\n\u4e8e\u662f\u4fbf\u6709\uff1a\n\n$$(x,y)\\oplus(x,y-1)\\oplus(x-2k,y)\\oplus(x-2k,y-1)=0$$\n\n\u4ee4$y=y-1$\uff0c\u5f97\u5230\uff1a\n\n$$(x,y-1)\\oplus(x,y-2)\\oplus(x-2k,y-1)\\oplus(x-2k,y-2)=0$$\n\n\u4e24\u5f0f\u5f02\u6216\u8d77\u6765\u5f97\u5230\uff1a\n\n$$(x,y)\\oplus(x,y-2)\\oplus(x-2k,y)\\oplus(x-2k,y-2)=0$$\n\n\u540c\u7406\uff1a\n\n$$(x,y)\\oplus(x,y-t)\\oplus(x-2k,y)\\oplus(x-2k,y-t)=0$$\n\n\u540c\u7406\u4ea6\u6709\uff1a\n\n$$(x,y)\\oplus(x,y-2k)\\oplus(x-t,y)\\oplus(x-t,y-2k)=0$$\n\n\u4e8e\u662f\u6211\u4eec\u4fbf\u5f97\u5230\u82e5$x,y$\u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u662f\u5947\u6570\u65f6:\n\n$$(x,y)\\oplus(x,1)\\oplus(1,y)\\oplus(1,1)=0$$\n\n\u5f53$x,y$\u90fd\u662f\u5076\u6570\u65f6\uff0c\u81ea\u5df1\u63a8\u4e00\u4e0b\u4e0d\u96be\u5f97\u5230:\n\n$$(x,y)\\oplus(x,1)\\oplus(1,y)\\oplus(1,1)=1$$\n\n\u8fd9\u65f6\u6709\u4e9b\u9898\u89e3\u7684\u505a\u6cd5\u662f\u679a\u4e3e$(1,1)$\u7684\u6240\u6709\u53ef\u80fd\uff08\u5373$0$\u6216$1$\uff09\uff0c\u5176\u5b9e\u8fd9\u6837\u505a\u9ebb\u70e6\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u591a\u5f00\u4e00\u884c\u4e00\u5217\uff08\u5373$(0,y)$\u548c$(x,0)$\uff09\uff0c\u7136\u540e\u9ed8\u8ba4$(0,0)=0,(1,0)=0$\uff0c\u8fd9\u6837\u6574\u4e2a\u56fe\u5c31\u662f\u65b0\u5f00\u7684\u8fd9\u4e00\u884c\u8fd9\u4e00\u5217\u51b3\u5b9a\u7684\u4e86\uff0c\u7136\u540e\u5c31\u4e0d\u5fc5\u8003\u8651\u90a3\u4e48\u591a\u4e86\n\n\u5bf9\u4e8e\u4e00\u4e2a\u65b0\u6dfb\u52a0\u7684\u989c\u8272$(x,y)=t$\uff0c\u82e5$x,y$\u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u662f\u5076\u6570\u65f6\uff0c\u4ee4\uff1a\n\n$$(x,0)\\oplus(0,y)=(x,y)\\oplus(0,0)\\oplus1=t\\oplus1$$\n\n\u5426\u5219\u4ee4\uff1a\n\n$$(x,0)\\oplus(0,y)=(x,y)\\oplus(0,0)=t$$\n\n\u7528\u79cd\u7c7b\u5e76\u67e5\u96c6\u7ef4\u62a4\u4e00\u4e0b$(x,0)$\u548c$(0,y)$\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u6700\u540e\u8bb0\u5f97\u628a$(1,0)$\u53bb\u6389\uff0c\u7136\u540e\u8bb0\u5f55\u4e00\u4e0b\u8fde\u901a\u5757\u7684\u4e2a\u6570$cnt$\uff0c\u6700\u540e\u7684\u7b54\u6848\u4fbf\u662f$2^{cnt}$\n\n\u653e\u4e0a~~\u5de8\u4e11\u65e0\u6bd4\u7684~~\u4ee3\u7801\uff1a\n\n```\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nconst int maxn=100005;\nint fa[maxn<<2],opp[maxn<<2],del[maxn<<2];\nint find(int x){\n\treturn fa[x]==x?x:fa[x]=find(fa[x]);\n}\nint push(int x,int y){\n\tfa[x]=y;\n}\nint push(int x,int y,int c){\n\tif(c){\n\t\tx=find(x);y=find(y);\n\t\tif(x==y)return false;\n\t\tif(x==opp[y])return true;\n\t\tpush(x,opp[y]);push(opp[x],y);\n\t}\n\telse{\n\t\tx=find(x);y=find(y);\n\t\tif(x==opp[y])return false;\n\t\tif(x==y)return true;\n\t\tpush(x,y);push(opp[x],opp[y]);\n\t}\n\treturn true;\n}\nlong long mod=1e9;\nlong long power(long long a,int n){\n\tlong long ans=1;\n\twhile(n){\n\t\tif(n&1)ans=ans*a%mod;\n\t\tn>>=1;a=a*a%mod;\n\t}\n\treturn ans;\n}\nint main(){\n\tint n,m,k;\n\tscanf(\"%d %d %d\",&n,&m,&k);int all=n+m;\n\tfor(int i=1;i<=all;++i)opp[i+all]=fa[i]=i,opp[i]=fa[i+all]=i+all;//(x,0)->x (0,y)->y+n\n\tint Im=0;\n\tfor(int i=0,x,y,c,t;i<k;++i){\n\t\tscanf(\"%d %d %d\",&x,&y,&c);\n\t\tif((x+1&1)==0&&(y+1&1)==0)c^=1;\n\t\ty+=n;\n\t\tif(!push(x,y,c)){\n\t\t\tIm=1;break;\n\t\t}\n\t}\n\tif(Im){\n\t\tputchar(0);\n\t}\n\telse{\n\t\tint temp=find(1),ans=0;\n\t\tdel[temp]=true;del[opp[temp]]=true;\n\t\tfor(int i=2;i<=all;++i){\n\t\t\tint x=find(i);\n\t\t\tif(!del[x])++ans;\n\t\t\tdel[x]=del[opp[x]]=true;\n\t\t}\n\t\tprintf(\"%lld\",power(2,ans));\n\t}\n\treturn 0;\n}\n```\n\n~~\u4f3c\u4e4e\u6bd4\u5176\u4ed6\u505a\u6cd5\u8981\u7b80\u6d01\u5427\u3002\u3002\u3002~~\n\n~~\u5e0c\u671b\u8fd9\u7bc7\u9898\u89e3\u5bf9\u4f60\u6709\u5e2e\u52a9~~\n\n~~\u6b22\u8fce\u63d0\u4f9bhack\u6570\u636e~~",
        "postTime": 1580562295,
        "uid": 230249,
        "name": "xiaolilsq",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 [APIO2011]\u65b9\u683c\u67d3\u8272"
    },
    {
        "content": "[\u6d1b\u8c37\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3631)\n\nyyy\uff0c\u9898\u89e3\u6ca1\u770b\u61c2\uff0c\u8fd8\u662f\u81ea\u5df1\u8bf4\u4e00\u4e2a\u5427\n\n### Solution\n\n\u5982\u679c\u53ea\u8981 $20\\%$ \u7684\u5206\uff0c\u72b6\u538b\u662f\u4f60\u6700\u597d\u7684\u9009\u62e9\n\n\uff08\u6b64\u9898\u6b63\u89e3\u548c\u72b6\u538b\u6ca1\u5173\u7cfb\uff09\n\n---\n\n\u8fd8\u662f\u60f3\u60f3\u6b63\u89e3\u5427(\\*^_^*)\n\n\u65e2\u7136\u8f93\u5165\u5c31\u662f\u8fd9\u4e48\u8f93\u7684\uff0c\u5c31\u76f4\u63a5\u5c06\u84dd\u8272\u770b\u4f5c $0$ \uff0c\u7ea2\u8272\u770b\u4f5c $1$ \uff0c\u90a3\u4e48\u6ee1\u8db3\u6761\u4ef6\u7684 $2\\times 2$ \u7684\u533a\u57df\u5c31\u662f $a_{i,j}\\oplus a_{i,j+1}\\oplus a_{i+1,j}\\oplus a_{i+1,j+1}=1$  \u3002\n\n\u6ce8\u610f\u5230\uff0c\u5f53\u7b2c\u4e00\u5217\u548c\u7b2c\u4e00\u884c\u786e\u5b9a\u4e86\u5982\u4f55\u67d3\u8272\u65f6\uff0c\u6574\u4e2a\u8868\u683c\u5c31\u786e\u5b9a\u4e86\u3002\u56e0\u4e3a\u5f53\u4e00\u4e2a $2\\times 2$ \u7684\u533a\u57df\u6709\u4e09\u4e2a\u786e\u5b9a\u65f6\uff0c\u6700\u540e\u4e00\u4e2a\u4e5f\u5c31\u786e\u5b9a\u4e86\u3002\n\n\u5982\u679c\u6ca1\u6709 $k$ \u4e2a\u5df2\u586b\u683c\u5b50\u7684\u9650\u5236\uff0c\u65b9\u6848\u6570\u5c31\u662f $2^{n+m-1}$ \u3002\n\n\u90a3\u4e48\u53ea\u8981\u80fd\u628a\u9650\u5236\u8f6c\u5316\u6210\u548c\u7b2c\u4e00\u884c\u7b2c\u4e00\u5217\u6709\u5173\u7cfb\uff0c\u5c31\u53ef\u4ee5\u6c42\u51fa\u771f\u7684\u65b9\u6848\u6570\u4e86\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u70b9 $(x,y)$ \uff0c\u7ecf\u8fc7\u4e00\u7cfb\u5217\u63a8\u5bfc\uff08\u63a8\u5bfc\u522b\u7684\u9898\u89e3\u5199\u7684\u5f88\u6e05\u695a\uff09\u5f97\uff1a\n$$\na_{1,1}\\oplus a_{x,1}\\oplus a_{1,y}\\oplus a_{x,y}=((x-1)*(y-1))\\&1\n$$\n\u4eba\u8bdd\u5c31\u662f\uff1a\u5f53 $x,y$ \u5747\u4e3a\u5076\u6570\u65f6\uff0c\u8fd9\u56db\u4e2a\u4e1c\u897f\u5f02\u6216\u4e3a $1$ \uff0c\u4e0d\u7136\u4e3a $0$ \u3002\n\n\u8fdb\u4e00\u6b65\u610f\u601d\u662f\uff0c\u6211\u4eec\u77e5\u9053\u4e86 $a_{x,y},a_{1,1}$ \uff0c\u5c31\u53ef\u4ee5\u77e5\u9053 $a_{x,1}$ \u548c $a_{1,y}$ \u662f\u989c\u8272\u76f8\u540c $(0)$ \u8fd8\u662f\u4e0d\u540c $(1)$ \u3002\n\n\u8fd9\u4e2a\u6027\u8d28\u5177\u6709\u4f20\u9012\u6027\u2014\u2014\u6211\u4eec\u77e5\u9053 $i,j$ \u548c $j,k$ \u7684\u5173\u7cfb\uff0c $i,k$ \u7684\u5173\u7cfb\u4e5f\u786e\u5b9a\u4e86\u3002\n\n\u90a3\u4e48\u8003\u8651\u679a\u4e3e $a_{1,1}$ \u7684\u67d3\u8272\u60c5\u51b5\uff0c\u7528\u5e26\u6743\u5e76\u67e5\u96c6\u6765\u7ef4\u62a4\u4e0d\u540c\u7684\u5173\u7cfb\u3002\u5f53\u5757\u91cc\u67d0\u4e00\u4e2a\u503c\u786e\u5b9a\u4e86\uff0c\u90a3\u6574\u4e2a\u5757\u5c31\u786e\u5b9a\u4e86\u3002\u56e0\u4e3a\u503c\u6709 $0,1$ \u4e24\u79cd\uff0c\u6240\u4ee5\u6bcf\u4e2a\u5757\u7684\u8d21\u732e\u4e3a $2$ \u3002\n\n\u8bbe\u5757\u6570\u4e3a $cnt$ \uff0c\u5219\u7b54\u6848\u4e3a $2^{cnt-1}$ \u3002\uff08\u56e0\u4e3a $a_{1,1}$ \u662f\u786e\u5b9a\u7684\uff0c\u5219\u6240\u5728\u7684\u8fde\u901a\u5757\u662f\u786e\u5b9a\u7684\uff09\n\n~~\u5b8c\u7ed3\u6492\u82b1~~\n\n\u5c0f\u7ec6\u8282\uff1a1.\u5982\u679c\u9898\u76ee\u7ed9\u4e86 $a_{1,1}$ \u662f\u4ec0\u4e48\u8272\uff0c\u90a3\u5c31\u4e0d\u7528\u679a\u4e3e\u4e86\u30022. $a_{1,1}=0$ \u76f4\u63a5\u679a\u4e3e\uff0c\u5f53 $a_{1,1}=1$ \u65f6\uff0c\u628a\u9664\u4e86\u7b2c\u4e00\u884c\u7b2c\u4e00\u5217\u7684\u5168\u90e8\u53d6\u53cd\u3002\u56e0\u4e3a\u4e4b\u524d\u662f $a_{x,y}\\oplus0=a_{x,y}$ \uff0c\u73b0\u5728\u662f $a_{x,y}\\oplus 1=(a_{x,y}\\oplus1)\\oplus 0$ \u30023.\u5728\u786e\u5b9a $a_{x,1},a_{{1,y}}$ \u5173\u7cfb\u65f6\uff0c\u4e3a\u4e86\u65b9\u4fbf\uff0c\u4f7f\u5f97`\u56db\u4e2a\u4e1c\u897f`\u4ec0\u4e48\u60c5\u51b5\u5f02\u6216\u90fd\u4e3a $0$ \uff0c\u5177\u4f53\u64cd\u4f5c\u4e3a\u4f7f\u5f97 $a_{x,y}\\oplus 1$ \n\n\u5176\u4ed6\u7ec6\u8282\u53ef\u4ee5\u770b\u4ee3\u7801\n\n### Code\n\n```c++\n#include<vector>\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\n\nusing namespace std;\nconst int N=200010,mod=1e9;\nint fa[N],g[N],n,m,k,ans,flag[2]={1,1};\nint x[N],y[N],c[N];\n\nint find(int x){\n    if(x==fa[x]) return x;\n    int tmp=find(fa[x]);\n    g[x]^=g[fa[x]];\t//\u5e26\u6743\u5e76\u67e5\u96c6\u7279\u6b8a\u4e4b\u5904\n    return fa[x]=tmp;\n}\n\n\nint solve(){\n    for(int i=1;i<=n+m;i++) fa[i]=i,g[i]=0;\n    fa[n+1]=1;\n    for(int i=1;i<=k;i++){\n        int fx=find(x[i]),fy=find(y[i]+n);\n        int tmp=g[x[i]]^g[y[i]+n]^c[i];\n        if(fx!=fy) fa[fx]=fy,g[fx]=tmp;\n        else if(tmp) return 0;\n    }\n    int res=-1;\n    for(int i=1;i<=n+m;i++)\n        if(fa[i]==i){\n            if(res==-1) res=1;\n            else res<<=1;\n            if(res>=mod) res-=mod;\n        }\n    return res;\n}\n\nint main(){\n    scanf(\"%d%d%d\",&n,&m,&k);\n    for(int i=1;i<=k;i++){\n        scanf(\"%d%d%d\",&x[i],&y[i],&c[i]);\n        if(x[i]==1&&y[i]==1) flag[c[i]^1]=0,--k,--i;\n        else if(x[i]%2==0&&y[i]%2==0) c[i]^=1;\t//x,y\u90fd\u4e3a\u5076\u6570\u65f6\n    }\n    if(flag[0]) ans+=solve();\n    if(flag[1]){\n        for(int i=1;i<=k;i++)\n            if(x[i]>1&&y[i]>1) c[i]^=1;\t//\u9664\u4e86\u7b2c\u4e00\u884c\u7b2c\u4e00\u5217\uff0c\u90fd\u53d6\u53cd\n        ans+=solve();\n    }\n    if(ans>=mod) ans-=mod;\n    printf(\"%d\\n\",ans);\n}\n```\n\n",
        "postTime": 1604060500,
        "uid": 272143,
        "name": "\u662f\u4e2a\u6c49\u5b50",
        "ccfLevel": 4,
        "title": "P3631 [APIO2011]\u65b9\u683c\u67d3\u8272"
    },
    {
        "content": "\u4e2a\u4eba\u535a\u5ba2\u91cc\u7684\u9898\u89e3\uff1a<http://blog.csdn.net/litble/article/details/77506815>\n\n# \u9898\u76ee\u5206\u6790\n\n\u9996\u5148\u53d1\u73b0\uff0c\u5982\u679c\u6211\u4eec\u628a\u84dd\u8272\u770b\u4f5c1\uff0c\u628a\u7ea2\u8272\u770b\u4f5c0\uff08\u4e0d\u8fc7\u7ea2\u914d\u84dd\u4ec0\u4e48\u7684\u771f\u7684\u4e11....\uff09\uff0c\u90a3\u4e48\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u683c\u5b50a(i,j)\uff0c\u90fd\u6709\uff1aa(i,j)^a(i+1,j)^a(i,j+1)^a(i+1,j+1)=1\n\n\u90a3\u4e48\u53ea\u8981\u7b2c\u4e00\u5217\u548c\u7b2c\u4e00\u884c\u786e\u5b9a\u4e86\u5982\u4f55\u67d3\u8272\uff0c\u6574\u4e2a\u8868\u683c\u7684\u67d3\u8272\u5c31\u786e\u5b9a\u4e86\u3002\uff08\u8fd9\u662f\u663e\u7136\u7684\uff0c\u56e0\u4e3a\u4e00\u4e2a$2*2$\u7684\u683c\u5b50\u4e2d\u6709\u4e09\u4e2a\u88ab\u67d3\u8272\u4e86\uff0c\u5269\u4e0b\u7684\u683c\u5b50\u989c\u8272\u5df2\u5b9a\u3002\uff09\n\n\u73b0\u5728\u6211\u4eec\u628a\u4e0a\u9762\u90a3\u4e2a\u5f0f\u5b50\u8bb0\u4f5cS(i,j),\u5219\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e00\u4e2a(i,j),\u6c42\u4e00\u6b21s(1,1)^s(1,2)^...^s(i-1,j-1),\u8fd9\u4e2a\u8fc7\u7a0b\u6570\u5b66\u611f\u4e0d\u597d\u7684\u4eba\uff08\u6bd4\u5982\u672c\u849f\u84bb\uff09\uff0c\u5c31\u8981\u5d29\u6e83\u4e86\u3002\u4e0d\u8fc7\u6211\u4eec\u53ef\u4ee5\u5f62\u8c61\u7684\u60f3\u4e00\u60f3\uff0c\u76f8\u5f53\u4e8e\u5728\u4e00\u4e2ai\\*j\u7684\u683c\u5b50\u4e2d\u7528\u4e00\u57572\\*2\u7684\u5c0f\u6bef\u5b50\u4e0d\u505c\u5730\u79fb\u4f4d\u8986\u76d6\uff0c\u90a3\u4e48\u88ab\u76d6\u4e86\u5076\u6570\u6b21\u7684\u4e00\u4e2aa(x,y\uff09\uff0c\u5c31\u4f1a\u53d1\u751fa(x,y)^a(x,y)=0\u8fd9\u6837\u7684\u4e8b\u6545\uff0c\u800c0^0=0,0^1=1,\u6240\u4ee5\u5c31\u76f8\u5f53\u4e8e\u6d88\u9664\u4e86\u3002\u90a3\u4e48\u88ab\u76d6\u4e86\u5947\u6570\u6b21\u7684\u683c\u5b50\u53ea\u6709a(1,1),a(i,1),a(1,j)\u548ca(i,j),\u56e0\u6b64\uff0ca(1,1)^a(i,1)^a(1,j)^a(i,j)\u5728i\u548cj\u5747\u4e3a\u5076\u6570\u7684\u65f6\u5019\uff08\u6b64\u65f6(i-1)\\*(j-1)\u662f\u5947\u6570\uff0cs\u7684\u5f02\u6216\u524d\u7f00\u548c\u662f1\uff09\u4e3a1\uff0c\u5426\u5219\u4e3a0.\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u679a\u4e3ea(1,1)\u7684\u503c\uff0c\u7136\u540e\u56e0\u4e3aa(i,j)\u7684\u503c\u548ca(1,1)\u7684\u5f02\u540c\u5173\u7cfb\uff0ca(i,1)\u548ca(1,j)\u7684\u5f02\u540c\u5173\u7cfb\u53ef\u4ee5\u786e\u5b9a\uff0c\u7528\u5e26\u6743\u5e76\u67e5\u96c6\u7ef4\u62a4\u6240\u6709\u6709\u5173\u7cfb\u7684\u70b9a(i,1)\u6216a(1,j)\uff0c\u7136\u540e\u6709\u591a\u5c11\u4e2a\u96c6\uff0c\u7b54\u6848\u5c31\u67092\u7684\u591a\u5c11\u6b21\u65b9\u7684\u8d21\u732e\u3002\u5f53\u7136\u8fd8\u8981\u6ce8\u610f\u4e00\u70b9\uff0c\u6709\u4e9b\u96c6\u56e0\u4e3a\u9898\u76ee\u7ed9\u51fa\u7684\u6761\u4ef6\u6240\u4ee5\u5df2\u7ecf\u786e\u5b9a\u4e86\u6240\u6709\u5143\u7d20\u662f1\u8fd8\u662f0\uff0c\u6240\u4ee5\u8fd9\u4e9b\u96c6\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u662f1\u4e0d\u662f2.\n\n# \u4ee3\u7801\u5b9e\u73b0\n\n\u867d\u7136\u9898\u76ee\u5206\u6790\u5df2\u7ecf\u5f88\u660e\u4e86\u4e86\uff0c\u4f46\u662f\u4ee3\u7801\u5b9e\u73b0\u4e0d\u591f\u7b80\u6d01\uff0c\u5c31\u5bb9\u6613\u5982boshi\u5927\u4f6c\u4e00\u6837\u6000\u7591\u4eba\u751f\uff0c\u6000\u7591\u9c81\u8fc5\uff0c\u6000\u7591\u67a3\u6811\u3002\n\n\u4ee5\u4e0b\u4e24\u4e2a\u64cd\u4f5c\u53ef\u4ee5\u7b80\u6d01\u4ee3\u7801\uff1a\n\n1.\u5982\u679ca(1,1)=0\uff0c\u76f4\u63a5\u64cd\u4f5c\uff0c\u5982\u679c\u679a\u4e3e\u5230a(1,1)=1,\u5219\u628a\u9664\u4e86\u7b2c\u4e00\u884c\u548c\u7b2c\u4e00\u5217\u4ee5\u5916\u7684\u989c\u8272\u90fd\u53cd\u8fc7\u6765\u5373\u53ef\u3002\n\n2.\u5e26\u6743\u5e76\u67e5\u96c6\uff0c\u901a\u8fc7\u5f02\u6216\u7b49\u4f4d\u8fd0\u7b97\u64cd\u4f5c\u8fdb\u884c\u5224\u65ad\uff0c\u6765\u7b80\u6d01\u4ee3\u7801\u3002\u7ed9\u5bf9\u4e8e\u4f4d\u8fd0\u7b97\u64cd\u4f5c\u4e0d\u662f\u5f88\u719f\u6089\u7684\u4eba\uff08\u6bd4\u5982\u672c\u849f\u84bb\uff09\u7684\u63d0\u9192\uff1a\u5bf9\u4e8e1\u548c0\uff0c\u5982\u679c\u5f02\u62160\uff0c\u5219\u4e0d\u53d8\uff0c\u5982\u679c\u5f02\u62161\uff0c\u5219\u53d1\u751f\u53d8\u5316\u3002\n\n\u8fd8\u6709\u672c\u849f\u84bb\u56e0\u4e3a\u6ca1\u53d6\u6a21WA\u4e86\u4e24\u6b21QAQ\n\n# \u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<climits>\nusing namespace std;\n#define LL long long\nLL mod=1000000000;\nconst int N=100005;\nint n,m,T;\nint x[N],y[N],w[N],f[N<<1],bj[N<<1],d[N<<1];\nLL ans;\nint find(int x){//\u5e26\u6743\u5e76\u67e5\u96c6\u7ef4\u62a4\u5f02\u540c\u5173\u7cfb\n    if(f[x]==x)return x;\n    int t=f[x];\n    f[x]=find(f[x]),d[x]=(d[x]+d[t])%2;\n    return f[x];\n}\nLL work(){\n    int i,r1,r2,t;LL re=1;\n    for(i=1;i<=n+m;++i)f[i]=i,d[i]=0,bj[i]=-1;//bj[i]=-1\u8868\u793a\u8fd9\u4e2a\u96c6\u91cc\u7684\u5143\u7d20\u6ca1\u6709\u786e\u5b9a\uff0c0\u8868\u793a\u6839\u8282\u70b9\u53d60\uff0c1\u8868\u793a\u6839\u8282\u70b9\u53d61\uff1bd[i]=1\u8868\u793ai\u548c\u6839\u8282\u70b9\u503c\u4e0d\u540c\uff0c\u7b49\u4e8e0\u8868\u793a\u76f8\u540c\u3002\n    f[n+1]=1,bj[1]=0;\n    for(i=1;i<=T;++i){\n        if(x[i]==1&&y[i]==1)continue;\n        if(x[i]==1||y[i]==1){//\u7279\u5224\n            if(y[i]==1)r1=find(x[i]),t=x[i];\n            else r1=find(y[i]+n),t=y[i]+n;\n            if(bj[r1]==-1)bj[r1]=w[i]^d[t];\n            else if(bj[r1]!=w[i]^d[t])return 0;\n            continue;\n        }\n        r1=find(x[i]),r2=find(y[i]+n);\n        if(r1!=r2){//\u8fde\u63a5\n            f[r1]=r2,d[r1]=(d[y[i]+n]-d[x[i]]+w[i]+4)%2;\n            if(bj[r1]!=-1&&bj[r2]!=-1&&bj[r2]!=bj[r1]^d[r1])return 0;\n            if(bj[r2]==-1&&bj[r1]!=-1)bj[r2]=bj[r1]^d[r1],bj[r1]=-1;\n        }\n        else if(d[x[i]]^d[y[i]+n]^w[i]==1)return 0;//\u5224\u65ad\u53ef\u884c\u6027\n    }\n    for(i=1;i<=n+m;++i)if(find(i)==i&&bj[i]==-1)re=(re<<1)%mod;//\u6ce8\u610f\u53d6\u6a21\n    return re;\n}\nint main(){\n    int i,j,flag=-1;\n    scanf(\"%d%d%d\",&n,&m,&T);\n    for(i=1;i<=T;++i){\n        scanf(\"%d%d%d\",&x[i],&y[i],&w[i]);\n        if(x[i]==1&&y[i]==1)flag=w[i];\n        if(!(x[i]&1)&&!(y[i]&1))w[i]^=1;\n    }\n    if(flag==-1||flag==0)ans+=work();\n    if(flag==-1||flag==1){\n        for(i=1;i<=T;++i)//\u53cd\u8fc7\u6765\u540e\u53ef\u4ee5\u7ee7\u7eed\u5f53a[1][1]=0\n            if(x[i]!=1&&y[i]!=1)w[i]^=1;\n        ans+=work();\n    }\n    ans%=mod//\u6ce8\u610f\u53d6\u6a21\n    printf(\"%lld\",ans);//\u6211\u662f\u4e0d\u662f\u5f88\u53ef\u7231\u554aQWQ\uff1f\n    return 0;\n}\n```",
        "postTime": 1503474058,
        "uid": 20604,
        "name": "litble",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P3631 \u3010[APIO2011]\u65b9\u683c\u67d3\u8272\u3011"
    },
    {
        "content": "\u8bbe\u683c\u5b50\u989c\u8272\u4e3a0\u548c1\uff0c\u90a3\u4e48\u6bcf\u4e2a2\\*2\u65b9\u683c\u4e2d\u7684\u5f02\u6216\u503c\u5fc5\u5b9a\u90fd\u4e3a1\uff0e\n\n\n\u6839\u636e\u8fd9\u4e2a\u6761\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff1a\n\n\u82e5\u6211\u4eec\u9009\u62e9\u4e86\u67d0\u4e9b\u683c\u5b50\uff0c\u6b64\u65f6\u5df2\u9009\u683c\u5b50\u7684\u5f02\u6216\u503c\u4e3ax\uff0c\u8fd9\u65f6\u6211\u4eec\u518d\u9009\u62e9\u67d0\u4e2a2\\*2\u7684\u65b9\u683c\uff0c\u5f02\u6216\u503c\u5c06\u53d8\u4e3ax^1\uff0e\u6bcf\u9009\u62e9\u4e00\u4e2a2\\*2\u7684\u65b9\u683c\uff0c\u5982\u679c\u65b9\u683c\u91cc\u7684\u6570\u5df2\u7ecf\u88ab\u9009\u62e9\uff0c\u90a3\u4e48\u76f8\u5f53\u4e8e\u4e0d\u518d\u9009\u62e9\uff0c\u6ca1\u6709\u9009\u62e9\u7684\u5c06\u6dfb\u52a0\u5230\u5df2\u9009\u683c\u5b50\u7684\u96c6\u5408\u4e2d\u53bb\uff0e\u56e0\u6b64\u9009\u62e9\u683c\u5b50\u4e5f\u662f\u4e00\u4e2a\u5f02\u6216\u7684\u8fc7\u7a0b\uff0e\n\n\u8fd9\u610f\u5473\u7740\uff0e\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u9009\u62e9\u6070\u5f53\u7684\u4e00\u4e9b2\\*2\u7684\u65b9\u683c\uff0c\u4f7f\u5f97\u68cb\u76d8\u4e0a\u6709\u6070\u5f53\u7684\u51e0\u4e2a\u683c\u5b50\u88ab\u9009\u62e9\uff0c\u800c\u5b83\u4eec\u7684\u5f02\u6216\u503c\u6211\u4eec\u53c8\u662f\u53ef\u4ee5\u7ef4\u62a4\u7684\uff0e\n\n\n\u901a\u8fc7\u5c1d\u8bd5\u4e0e\u5f52\u7eb3\uff0c\u4e0d\u96be\u53d1\u73b0\uff1a\n\n\u5bf9\u4e8e\u683c\u5b50(x,y):\n\n\u82e5x,y\u5747\u4e3a\u5076\u6570\uff0c\u90a3\u4e48(x,y)=(x,1)^(1,y)^(1,1)^1\n\n\u5426\u5219(x,y)=(x,1)^(1,y)^(1,1)\n\n\u6240\u4ee5\u6839\u636e\u6bcf\u4e00\u4e2a\u5df2\u77e5\u989c\u8272\u7684\u683c\u5b50\uff0c\u6211\u4eec\u53ef\u4ee5\u5efa\u7acb\u7b2c\u4e00\u884c\u548c\u7b2c\u4e00\u5217\u683c\u5b50\u76f8\u7b49\u4e0e\u4e0d\u76f8\u7b49\u7684\u5173\u7cfb\uff0e\u8fd9\u79cd\u5173\u7cfb\u53ef\u4ee5\u7528\u5e26\u6743\u5e76\u67e5\u96c6\u7ef4\u62a4\uff0e\n\n\n\u6211\u4eec\u53c8\u53d1\u73b0\uff0c\u5982\u679c\u786e\u5b9a\u4e86\u7b2c\u4e00\u884c\u548c\u7b2c\u4e00\u5217\uff0c\u6574\u4e2a\u68cb\u76d8\u90fd\u662f\u786e\u5b9a\u7684\u4e86\uff0e\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u7edf\u8ba1\u7b2c\u4e00\u884c\u548c\u7b2c\u4e00\u5217\u7684\u65b9\u6848\u6570\u5373\u53ef\uff0e\n\n\n\u5bf9\u4e8e\u5df2\u77e5\u683c\u5b50(x,y)\uff0c\u5982\u679c\u5b83\u4e0d\u518d\u7b2c\u4e00\u884c\u6216\u7b2c\u4e00\u5217\uff0c\u6211\u4eec\u7528\u5b83\u7ef4\u62a4\u5e76\u67e5\u96c6\uff0c\u5426\u5219\u7528\u6765\u786e\u5b9a\u7b2c\u4e00\u884c\u548c\u7b2c\u4e00\u5217\u67d0\u4e9b\u5e76\u67e5\u96c6\u7684\u989c\u8272\uff0e\n\n\n```cpp\n#include <iostream>\n#include <cstring>\n#include <cstdio>\n\n#define MX 2000002\n#define MD 1000000000\n\nusing namespace std;\n\ntypedef long long ll;\n\nint fa[MX],dis[MX];//\u8868\u793a\u8be5\u8282\u70b9\u5230\u6839\u8282\u70b9\u7684\u8ddd\u79bb\uff0c\u4ee5\u53ca\u4e2d\u9014\u7ecf\u8fc7\u4e86\u591a\u5c11\u6b21\uff02\u4e0d\u540c\uff02\u7684\u5173\u7cfb\nint have[MX],must[MX];//\u8fd9\u4e2a\u8282\u70b9\u662f\u5426\u786e\u5b9a\u6570\u503c\uff0c\u786e\u5b9a\u7684\u6570\u503c\u662f\u51e0(\u7528\u4e8e\u5224\u5b9a\u51b2\u7a81)\nint n,m,k;\nint px[MX],py[MX],pn[MX];//\u5df2\u77e5\u70b9\u7684x,y,number\nint vis[MX];\n\nll ksm(ll x,int t)\n{\n    ll ans=1;\n    while(t)\n    {\n        if(t&1)ans=ans*x%MD;\n        x=x*x%MD;\n        t>>=1;\n    }\n    return ans;\n}\n\nint findfa(int x)\n{\n    if(fa[x]==x)return x;\n    else\n    {\n        findfa(fa[x]);\n        dis[x]+=dis[fa[x]];\n        fa[x]=fa[fa[x]];\n        return fa[x];\n    }\n}\n\nll work(int top)\n{\n    int f1,f2,x,y,del,ans=0;\n    for(int i=1;i<=n+m;i++)fa[i]=i,dis[i]=0,vis[i]=0,must[i]=0,have[i]=0;\n    for(int i=1;i<=k;i++)\n    {\n        if(px[i]==1||py[i]==1)continue;\n        f1=findfa(x=px[i]);\n        f2=findfa(y=(py[i]+n));\n        del=(top+pn[i])&1;\n        if(f1==f2)\n        {\n            if(((x&1)||(y&1)))\n            {\n                if((dis[x]+del)%2!=dis[y]%2)return 0;\n            }\n            else\n            {\n                if((dis[x]+del)%2==dis[y]%2)return 0;\n            }\n        }\n        else\n        {\n            fa[f1]=f2;\n            dis[f1]=((dis[x]%2!=dis[y]%2)+del+((x&1)||(y&1))+1)%2;\n        }\n    }\n    fa[1]=n+1;\n    have[findfa(1)]=1;\n    must[fa[1]]=top;\n    for(int i=1;i<=k;i++)\n    {\n        x=px[i];\n        y=n+py[i];\n        if(px[i]==1)\n        {\n            if(have[findfa(y)]==0)have[fa[y]]=1,must[fa[y]]=(pn[i]+dis[y])%2;\n            else if(must[fa[y]]!=(pn[i]+dis[y])%2)return 0;\n        }\n        if(py[i]==1)\n        {\n            if(have[findfa(x)]==0)have[fa[x]]=1,must[fa[x]]=(pn[i]+dis[x])%2;\n            else if(must[fa[x]]!=(pn[i]+dis[x])%2)return 0;\n        }\n    }\n    for(int i=1;i<=n+m;i++)\n        if(!vis[findfa(i)]&&!have[findfa(i)])\n            vis[fa[i]]=1,ans++;\n    return ksm(2,ans);\n}\n\nint main()\n{\n    scanf(\"%d%d%d\",&n,&m,&k);\n    for(int i=1;i<=k;i++)scanf(\"%d%d%d\",&px[i],&py[i],&pn[i]);\n    cout<<(work(0)+work(1))%MD<<endl;\n    return 0;\n}\n```",
        "postTime": 1503458773,
        "uid": 41155,
        "name": "totorato",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P3631 \u3010[APIO2011]\u65b9\u683c\u67d3\u8272\u3011"
    },
    {
        "content": "## T15 Apio2011 \u65b9\u683c\u67d3\u8272\n\n~~20\u5206\u7b97\u6cd5\uff1a\u66b4\u529b\u679a\u4e3e\u6bcf\u4e2a\u70b9~~\n\n~~\u6284\u9898\u89e3\u505a\u7684\u8fd8\u662f\u597d\u597d\u5199\u603b\u7ed3\u5427~~\n\n\u628a\u7ea2\u8272\u89c6\u4e3a0\uff0c\u84dd\u8272\u89c6\u4e3a1\n\n\u5047\u8bbe\u6709\u4e00\u4e2a\u8868\u683c\u5982\u4e0b\uff1a\n\n| A    | C    | E    | G    |\n| ---- | ---- | ---- | ---- |\n| B    | D    | F    | H    |\n\n\u6839\u636e\u9898\u8bbe\u6709$A\\bigoplus B\\bigoplus C\\bigoplus D=C\\bigoplus D\\bigoplus E\\bigoplus F=1$\n\n\u7136\u540e\u6709$A\\bigoplus B\\bigoplus E\\bigoplus F=0$\n\n\u800c$E\\bigoplus F\\bigoplus G\\bigoplus H=1$\n\n\u6240\u4ee5$A\\bigoplus B\\bigoplus G\\bigoplus H=1$\n\n\u518d\u653e\u5230\u4e00\u822c\u6027\u7684\u8868\u683c\u4e2d\n\n| A       | ...... | C       |\n| ------- | ------ | ------- |\n| B       | ...... | D       |\n| I       | ...... | J       |\n| ....... | ...... | ....... |\n| E       | ...... | G       |\n| F       | ...... | H       |\n\n\u5f53C\uff0cD\u5904\u4e8e\u5947\u6570\u5217\u7684\u65f6\u5019\uff0c\u6709:\n\n$A\\bigoplus B\\bigoplus C\\bigoplus D=0,E\\bigoplus F\\bigoplus G\\bigoplus H=0,B\\bigoplus I\\bigoplus D\\bigoplus J=0$\n\n\u6240\u4ee5\u6709:\n\n$A\\bigoplus C\\bigoplus I\\bigoplus J=0$\n\n\u63a8\u51fa\n\n$A\\bigoplus C\\bigoplus F\\bigoplus H=0$\n\n\u5373\uff1a\n\n$A\\bigoplus H=C\\bigoplus F$\n\n\u5f53C\uff0cD\u5728\u5076\u6570\u5217\u4e0a\uff0c\u6709\uff1a\n\n$A\\bigoplus B\\bigoplus C\\bigoplus D=1,E\\bigoplus F\\bigoplus G\\bigoplus H=1,B\\bigoplus I\\bigoplus D\\bigoplus J=1$\n\n\u5f53H\u5728\u5947\u6570\u884c\uff1a\n\n$1\\bigoplus A\\bigoplus H=C\\bigoplus F$\n\n\u5f53H\u5728\u5076\u6570\u884c\uff1a\n\n$A\\bigoplus H=C\\bigoplus F$\n\n\n\n\u8bbeH\u5750\u6807\u4e3a$(i,j)$,A\u5750\u6807\u4e3a$(1,1)$\n\n\u5219\u6709\uff1a\n$if(i\\ mod\\ 2==0\\ and\\ j\\ mod \\ 2==0) \\ 1\\bigoplus(1,1)\\bigoplus(i,j) ==(1,j)\\bigoplus(i,1)$\n$else\\ (1,1)\\bigoplus(i,j) ==(1,j)\\bigoplus(i,1)$\n\n\u800c\u663e\u7136\u5982\u679c\u786e\u5b9a\u4e86\u7b2c\u4e00\u6392\uff0c\u7b2c\u4e00\u5217\uff0c\u90a3\u4e48\u53ef\u4ee5\u786e\u5b9a\u6574\u5f20\u56fe\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u679a\u4e3e$(1,1)$\u7684\u503c\uff0c\u7136\u540e\u5408\u5e76\u6240\u6709\u76f8\u5173\u7684\u96c6\u5408\uff0c\u53bb\u6389\u5df2\u77e5\u70b9\u7684\u96c6\u5408\uff0c\u5269\u4e0b\u7684\u96c6\u5408\u4e2a\u6570\u4e3a$cnt$\uff0c\u5219\u7b54\u6848\u4e3a$2^{cnt}$\u3002\n\u628a(1,1)\u4e3a0,1\u7684\u7b54\u6848\u52a0\u8d77\u6765\u5373\u53ef\n\n\u5408\u5e76\u96c6\u5408\u7684\u65f6\u5019\u4f7f\u7528\u6269\u5c55\u57df\u5e76\u67e5\u96c6\u7ef4\u62a4\u5230\u6839\u8282\u70b9\u7684\u5f02\u6216\u503c\u3002\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n\n#define R register\n#define ll long long\n\nconst int MAXN=1e6+10;\nconst int Mod=1e9;\n\ninline int read()\n{\n\tint x=0,f=1;\n\tchar a=getchar();\n\tfor(;a>'9'||a<'0';a=getchar()) if(a=='-') f=-1;\n\tfor(;a>='0'&&a<='9';a=getchar()) x=x*10+a-'0';\n\treturn x*f;\n}\n\nint n,m,k,flg=-1,cnt,Size;\nint fa[MAXN];\nint X[MAXN],Y[MAXN],Z[MAXN];\n\ninline int find(int x) { return x==fa[x]?x:fa[x]=find(fa[x]); }\ninline void merge(int x,int y)\n{\t\n\tint fx=find(x),fy=find(y); \n\tfa[fx]=fy;cnt-=fx!=fy;\n}\n\ninline void Init()\n{\n\tn=read();m=read();k=read();\n\tSize=n+m-1;\n\tfor(R int i=1;i<=k;i++)\n\t{\n\t\tX[i]=read();Y[i]=read();Z[i]=read();\n\t\tif(X[i]==1&&Y[i]==1) flg=Z[i];\n\t}\n}\n\ninline int id(int x) { return x==1?1:m+x-1; }\n\nint vis[MAXN];\nint ans=0;\n\ninline void Solve(bool delta)\n{\n\tfor(R int i=1;i<=Size*2;i++) fa[i]=i;\n\tcnt=Size*2;\n\tfor(R int i=1;i<=k;i++)\n\t{\n\t\tint a=X[i],b=Y[i];\n\t\tif(a==1&&b==1) continue;\n\t\tif(a%2==0&&b%2==0)\n\t\t{\n\t\t\tif(1^delta^Z[i]) \n\t\t\t{\n\t\t\t\tmerge(id(a),b+Size);merge(id(a)+Size,b);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmerge(id(a),b);merge(id(a)+Size,b+Size);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(delta^Z[i]) \n\t\t\t{\n\t\t\t\tmerge(id(a),b+Size);\n\t\t\t\tmerge(id(a)+Size,b);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmerge(id(a),b);\n\t\t\t\tmerge(id(a)+Size,b+Size);\n\t\t\t}\n\t\t}\n\t\tif(find(b)==find(b+Size)||find(id(a))==find(id(a)+Size))\n\t\t{\n\t\t\tprintf(\"0\\n\");\n\t\t\texit(0);\n\t\t}\n\t}\n\tmemset(vis,0,sizeof(vis));\n\tcnt--;\n\tvis[find(1)]=1;\n\tfor(R int i=1;i<=k;i++)\n\t{\n\t\tif(X[i]==1&&vis[find(Y[i])]==0) \n\t\t{\n\t\t\tvis[find(Y[i])]=1;\n\t\t\tcnt--;\n\t\t}\n\t\telse \n\t\t\tif(Y[i]==1&&vis[find(id(X[i]))]==0)\n\t\t\t{\n\t\t\t\tvis[find(id(X[i]))]=1;\n\t\t\t\tcnt--;\n\t\t\t}\n\t}\n\tcnt>>=1;\n\tint tmp=1;\n\tfor(R int i=1;i<=cnt;i++) tmp=(tmp<<1)>=Mod?(tmp<<1)-Mod:(tmp<<1);\n\tans=ans+tmp>=Mod?ans+tmp-Mod:ans+tmp;\n}\n\nint main()\n{\n\tInit();\n\tif(flg==-1) Solve(0),Solve(1);\n\tif(flg==0) Solve(0);\n\tif(flg==1) Solve(1);\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1582793707,
        "uid": 139012,
        "name": "______OvO______",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3631 \u3010[APIO2011]\u65b9\u683c\u67d3\u8272\u3011"
    },
    {
        "content": "[P3631 [APIO2011]\u65b9\u683c\u67d3\u8272](https://www.luogu.com.cn/problem/P3631)\n\n\u633a\u795e\u5947\u7684\u4e00\u9053\u9898\u3002\u4e8e\u662f\u51b3\u5b9a\u5199\u7bc7\u9898\u89e3\u603b\u7ed3\u4e00\u4e0b\u3002\u672c\u7bc7\u9898\u89e3\u548c\u5176\u4ed6\u9898\u89e3\u7684\u601d\u8def\u5dee\u4e0d\u591a\uff0c\u4e3b\u8981\u662f\u6709\u4e00\u4e9b\u6211\u81ea\u5df1\u7684\u7406\u89e3\u3002\n\n\u8bb0 $(x,y)$ \u8868\u793a\u683c\u5b50 $(x,y)$ \u7684\u989c\u8272\uff1a$(x,y)\u2295(x\u22121,y)\u2295(x,y\u22121)\u2295(x\u22121,y\u22121)=1$\n\n\u4ee4 $x=x-1$\uff0c\u6709\uff1a$(x\u22121,y)\u2295(x\u22122,y)\u2295(x\u22121,y\u22121)\u2295(x\u22122,y\u22121)=1$\n\n\u4e24\u5f0f\u5f02\u6216\u8d77\u6765\u5f97\u5230\uff1a$(x,y)\u2295(x,y\u22121)\u2295(x\u22122,y)\u2295(x\u22122,y\u22121)=0$\n\n\u5f52\u7eb3\u5f97\u5230\uff1a$(x,y)\u2295(x,y\u22121)\u2295(x\u22122k,y)\u2295(x\u22122k,y\u22121)=0$\n\n\u540c\u7406\u6709\uff1a$(x,y)\u2295(x,y\u22122)\u2295(x\u22122k,y)\u2295(x\u22122k,y\u22122)=0$\n\n\u540c\u7406\uff1a$(x,y)\u2295(x,y\u2212t)\u2295(x\u22122k,y)\u2295(x\u22122k,y\u2212t)=0$\n\n\u540c\u7406\u4ea6\u6709\uff1a$(x,y)\u2295(x,y\u22122k)\u2295(x\u2212t,y)\u2295(x\u2212t,y\u22122k)=0$\n\n\u4e8e\u662f\u82e5 $x,y$ \u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u662f\u5947\u6570\u65f6\uff1a$(x,y)\u2295(x,1)\u2295(1,y)\u2295(1,1)=0$\n\n\u5f53 $x,y$ \u90fd\u662f\u5076\u6570\u65f6\uff0c$(x,y)\u2295(x,1)\u2295(1,y)\u2295(1,1)=1$\n\n\u5982\u679c\u539f\u65b9\u683c\u5185\u7684\u7b2c\u4e00\u884c\u548c\u7b2c\u4e00\u5217\u7684\u683c\u5b50\u88ab\u786e\u5b9a\uff0c\u90a3\u4e48\u6574\u4e2a\u65b9\u683c\u5373\u53ef\u88ab\u552f\u4e00\u786e\u5b9a\u3002\u5982\u679c (1,1) \u548c $(i, j)$ \u786e\u5b9a\u4e86\uff0c\u90a3\u4e48 $(1,j)$ \u548c $(i,1)$ \u7684\u5173\u7cfb\u4e5f\u5c31\u88ab\u786e\u5b9a\u4e86\uff0c\u4e5f\u5c31\u662f\u4e00\u5b9a\u76f8\u7b49\u548c\u4e00\u5b9a\u4e0d\u76f8\u7b49\u3002\u6211\u4eec\u53ef\u4ee5\u7528\u5e26\u6743\u5e76\u67e5\u96c6\u6765\u5b9e\u73b0\u3002\n\n\u5177\u4f53\u5730\uff0c\u679a\u4e3e\uff081,1\uff09\u53ef\u80fd\u7684\u60c5\u51b5\uff0c\u5bf9\u4e8e\u6bcf\u79cd\u60c5\u51b5\u628a\u6709\u5173\u7cfb\u7684\u70b9\u653e\u5728\u4e00\u4e2a\u8fde\u901a\u5757\u5185\uff0c\u6700\u7ec8\u9664\u4e86(1,1)\u6240\u5728\u7684\u8fde\u901a\u5757\uff0c\u5176\u4ed6\u8fde\u901a\u5757\u90fd\u67091,0\u4e24\u79cd\u9009\u62e9\uff0c\u6700\u540e\u7684\u7b54\u6848\u5373\u4e3a $2^{\u8fde\u901a\u5757\u4e2a\u6570-1}$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int N=2e5+5;\nconst int mo=1e9;\nint n,m,k,x[N],y[N],z[N],fa[N],g[N];\nll qpow(ll x,int y)\n{\n\tll s=1;\n\twhile(y)\n\t{\n\t\tif(y&1)s=s*x%mo;\n\t\tx=x*x%mo;\n\t\ty>>=1;\n\t}\n\treturn s;\n}\nint find(int u)\n{\n\tif(u==fa[u])return u;\n\tint f=find(fa[u]);\n\tg[u]^=g[fa[u]];\n\tfa[u]=f;\n\treturn fa[u];\n}\nll calc(int opt)\n{\n\tint cnt=0;\n\tfor(int i=1;i<=n+m;i++)\n\t{\n\t\tfa[i]=i;\n\t\tg[i]=0;\n\t}\n\tfa[n+1]=1;\n\tif(opt)\n\t{\n\t\tfor(int i=1;i<=k;i++)\n\t\t\tif(x[i]>1||y[i]>1)\n\t\t\t\tz[i]^=1;\n\t}\n\tfor(int i=1;i<=k;i++)\n\t{\n\t\tif(x[i]==1&&y[i]==1)continue;\n\t\tint fx=find(x[i]),fy=find(n+y[i]);\n\t\tint w=g[x[i]]^g[n+y[i]]^z[i];\n\t\tif(fx!=fy)\n\t\t{\n\t\t\tfa[fx]=fy;\n\t\t\tg[fx]=w;\n\t\t}\n\t\telse if(w)return 0;\n\t}\n\tfor(int i=1;i<=n+m;i++)\n\t\tif(i==find(i))cnt++;\n\treturn qpow(2,cnt-1);\n}\nint main()\n{\n\tscanf(\"%d%d%d\",&n,&m,&k);\n\tint fl=-1;\n\tfor(int i=1;i<=k;i++)\n\t{\n\t\tscanf(\"%d%d%d\",&x[i],&y[i],&z[i]);\n\t\tif(!(x[i]&1)&&(!(y[i]&1)))z[i]^=1;\n\t\tif(x[i]==1&&y[i]==1)\n\t\t\tfl=z[i];\n\t}\n\tif(fl!=-1)\n\t\tprintf(\"%lld\",calc(fl));\n\telse printf(\"%lld\",(calc(0)+calc(1))%mo);\n\treturn 0;\n}\n```",
        "postTime": 1606042026,
        "uid": 224403,
        "name": "\u6728xx\u6728\u5927",
        "ccfLevel": 9,
        "title": "P3631 [APIO2011]\u65b9\u683c\u67d3\u8272\uff08\u57fa\u4e8e\u5f02\u6216\u6027\u8d28\u7684\u5e76\u67e5\u96c6\uff09"
    },
    {
        "content": "\u5c06\u7ea2\u8272\u770b\u4f5c $1$\uff0c\u84dd\u8272\u770b\u4f5c $0$\uff0c\u90a3\u4e48\u9898\u76ee\u8981\u6c42\u5373\u4e3a\uff0c\u5bf9\u4e8e\u6240\u6709\u7684 $x,y$\uff0c\u6ee1\u8db3\uff1a\n\n$$\na_{x,y}\\oplus a_{x-1,y}\\oplus a_{x,y-1} \\oplus a_{x-1,y-1}=1\n$$\n\n\u663e\u7136\u4e5f\u5e94\u8be5\u6ee1\u8db3\uff1a\n\n$$\na_{x-1,y}\\oplus a_{x-2,y}\\oplus a_{x-1,y-1} \\oplus a_{x-2,y-1}=1\n$$\n\n\u4e24\u5f0f\u5b50\u5408\u5e76\uff0c\u5f97\uff1a\n\n$$\na_{x,y}\\oplus a_{x,y-1}\\oplus a_{x-2,y}\\oplus a_{x-2,y-1}=0\n$$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u7ee7\u7eed\u63a8\u5e7f\uff0c\u6700\u540e\u53ef\u4ee5\u5f97\u5230\u7ed3\u8bba\uff1a\n\n$$\na_{x,y}\\oplus a_{x,y-1}\\oplus a_{x-2t,y}\\oplus a_{x-2t,y-1}=0\n$$\n\n\u540c\u7406\u6211\u4eec\u6709\uff1a\n\n$$\na_{x,y-1}\\oplus a_{x,y-2}\\oplus a_{x-2t,y-1}\\oplus a_{x-2t,y-2}=0\n$$\n\n\u4e24\u5f0f\u5b50\u5408\u5e76\uff0c\u5f97\uff1a\n\n$$\na_{x,y}\\oplus a_{x,y-2}\\oplus a_{x-2t,y}\\oplus a_{x-2t,y-2}=0\n$$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u4e0e\u4e0a\u9762\u7684\u90a3\u4e2a\u7ed3\u8bba\u6bd4\u8f83\uff0c\u53ef\u4ee5\u5f97\u5230\u7ed3\u8bba\uff1a\n\n$$\na_{x,y}\\oplus a_{x,y-k}\\oplus a_{x-2t,y}\\oplus a_{x-2t,y-k}=0\n$$\n\n\n\n\u540c\u7406\uff1a\n\n$$\na_{x,y}\\oplus a_{x,y-2*k}\\oplus a_{x-t,y}\\oplus a_{x-t,y-2*k}=0\n$$\n\n\n\u56e0\u6b64\uff0c\u4e0d\u96be\u53d1\u73b0\uff1a\n\n\u5f53 $x $ \u548c $y$ \u4e2d\u6709\u4efb\u610f\u4e00\u4e2a\u6570\u5b57\u4e3a\u5947\u6570\uff0c\u5219\uff1a\n\n$$\na_{x,y}\\oplus a_{x,1}\\oplus a_{1,y}\\oplus a_{1,1}=0\n$$\n\n\u5426\u5219\uff0c\u6211\u4eec\u6709\uff1a\n\n\n$$\na_{x,y}\\oplus a_{x,1}\\oplus a_{1,y}\\oplus a_{1,1}=1\n$$\n \n\u8fd9\u4e2a\u600e\u4e48\u8bc1\u660e\u5462\uff1f\u540c\u673a\u623f\u5927\u4f6c\u8bc1\u51fa\u6765\u4e86\uff0c\u6211\u8d34\u4e00\u4e2a [\u526a\u8d34\u677f](https://www.luogu.com.cn/paste/0vduacja)\u3002\n\n\u597d\u4e86\uff0c\u51c6\u5907\u5de5\u4f5c\u5b8c\u6210\u4e86\u3002\n\n\u6211\u4eec\u63a5\u4e0b\u6765\u53d1\u73b0\u786e\u5b9a\u4e86\u7b2c\u4e00\u884c\u548c\u7b2c\u4e00\u5217\u4e4b\u540e\u5c31\u53ef\u4ee5\u786e\u5b9a\u6574\u4e2a\u65b9\u6848\uff0c\u539f\u56e0\u5f88\u7b80\u5355\u3002\n\n\u6240\u4ee5\u4e00\u5f00\u59cb\u7a7a\u7684\u65b9\u6848\u6570\u4e3a $2^{n+m-1}$\u3002\n\n\u518d\u770b\u770b\u4e0a\u9762\u7684\u5f0f\u5b50\uff0c\u6211\u4eec\u53d1\u73b0\u5f53 $a_{1,1}$ \u548c $a_{x,y}$ \u5df2\u77e5\u65f6\u53ef\u4ee5\u63a8\u51fa $a_{x,1}$ \u548c $a_{1,y}$ \u7684\u5173\u7cfb\u5c31\u4e0d\u96be\u60f3\u5230\u6bcf\u4e2a\u70b9\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e86\u3002\n\n\u56e0\u4e3a\u4e00\u5f00\u59cb\u70b9\u4e0e\u70b9\u4e4b\u95f4\u7684\u51b3\u7b56\u662f\u72ec\u7acb\u7684\uff0c\u800c\u6bcf\u4e2a\u70b9\u76f8\u5f53\u4e8e\u786e\u5b9a\u4e86\u4ed6\u4eec\u4e4b\u95f4\u7684\u4e00\u4e9b\u5173\u7cfb\uff0c\u6240\u4ee5\u7528\u4e00\u4e2a\u5e26\u6743\u5e76\u67e5\u96c6\u7ef4\u62a4\u5373\u53ef\u3002\n\n\u8bbe\u6709 $k$ \u4e2a\u8fde\u901a\u5757\uff0c\u5219\u7b54\u6848\u4e3a $2^{k-1}$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define LL long long\nusing namespace std;\nconst LL N=1e6;\nconst LL mod=1e9;\nLL ksm(LL x,LL y)\n{\n\tif(y<0)return 0;\n\tLL ans=1;\n\twhile(y)\n\t{\n\t\tif(y&1)ans=ans*x%mod;\n\t\tx=x*x%mod,y>>=1; \n\t}\n\treturn ans;\n}\nLL n,m,k,fa[N],g[N],x[N],y[N],z[N],flg[2],ans;\nLL find(LL x)\n{\n\tif(fa[x]==x)return x;\n\tLL t=find(fa[x]);\n\tg[x]^=g[fa[x]];\n\treturn fa[x]=t;\n}\nLL solve(LL a)\n{\n\tfor(int i=1;i<=n+m;i++)fa[i]=i,g[i]=0;\n\tfa[1]=1+n;\n\tfor(int i=1;i<=k;i++)\n\t{\n\t\tLL fx=find(x[i]),fy=find(n+y[i]);\n\t\tLL t=z[i]^a;\n\t\tif(x[i]%2==0&&y[i]%2==0)t^=1;\n\t\tif(fx!=fy)fa[fx]=fy,g[fx]^=t^g[x[i]]^g[y[i]+n];\n\t\telse if(t!=g[x[i]]^g[y[i]+n])return 0;\n\t}\n\tLL cnt=0;\n\tfor(int i=1;i<=n+m;i++)\n\t{\n\t\tif(find(i)==i)cnt++;\n\t}\n\treturn ksm(2,cnt-1);\n}\nint main() \n{\n\tcin>>n>>m>>k;\n\tfor(int i=1;i<=k;i++)\n\t{\n\t\tcin>>x[i]>>y[i]>>z[i];\n\t\tif(x[i]==1&&y[i]==1)flg[z[i]]=1,i--,k--;\n\t}\n\tif(!flg[1])ans=(ans+solve(0))%mod;\n\tif(!flg[0])ans=(ans+solve(1))%mod;\n\tcout<<ans<<endl;\n}\n```",
        "postTime": 1684143356,
        "uid": 501947,
        "name": "DengDuck",
        "ccfLevel": 6,
        "title": "P3631 [APIO2011] \u65b9\u683c\u67d3\u8272 \u9898\u89e3"
    }
]
[
    {
        "content": "\u8fd9\u9053\u9898\u663e\u7136\u662fDP\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u8bbe $ f_{i,j} $ \u8868\u793a $ [1,i] $ \u7684\u6392\u5217\u4e2d\u9006\u5e8f\u5bf9\u4e2a\u6570 $ \\bmod \\ k$ \u4e3a $ j $ \u65f6\u7684\u6392\u5217\u4e2a\u6570\u3002\n\n\u90a3\u4e48\u6211\u4eec\u4e0d\u96be\u60f3\u51fa\u4e00\u4e2a\u6bd4\u8f83\u7b80\u5355\u7684\u8f6c\u79fb\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5f80\u540e\u66f4\u65b0(\u56e0\u4e3a\u6bd4\u8f83\u597d\u6253)\n\n\u4e3a\u4ec0\u4e48\u5462\uff0c\u5176\u5b9e\u5f88~~\u7b80\u5355~~\u3002\n\n\u6211\u4eec\u8003\u8651\u653e\u5165\u4e00\u4e2a\u65b0\u7684\u6570\uff0c\u524d\u9762 $i-1$ \u4e2a\u6570\u7684\u6392\u5217\u6211\u4eec\u5b8c\u5168\u4e0d\u7528\u7ba1\u3002\n\n\u6211\u4eec\u63d2\u5165\u7684\u8fd9\u4e2a\u6570 $i$ \u4e00\u5b9a\u662f\u6700\u5927\u7684\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6570\u5bf9\u9006\u5e8f\u5bf9\u6570\u91cf\u7684\u8d21\u732e\u5c31\u4e3a\uff1a\n\n\u8fd9\u4e2a\u6570 $i$ \u63d2\u5165\u5230\u6392\u5217 $[1,i-1]$ \u4e2d\u5b83\u540e\u9762\u6709\u591a\u5c11\u4e2a\u6570\u3002\n\n\u6240\u4ee5\u4e00\u4e2a $i$ \u63d2\u5165\u5230 $[1,i-1]$ \u7684\u6392\u5217\u4e2d\u6700\u591a\u53ef\u4ee5\u8d21\u732e $i-1$ \u5bf9\u9006\u5e8f\u5bf9\u3002\n\n\u6700\u5c11\u5219 $0$ \u5bf9\uff0c\u6211\u4eec\u4ee4 $l$ \u4e3a\u63d2\u5165 $i$ \u540e\u65b0\u4ea7\u751f\u7684\u9006\u5e8f\u5bf9\u4e2a\u6570\u3002\n\n\u7136\u540e\u5c31\u80fd\u63a8\u51fa $ f_{i+1,(j+l)\\bmod k} = f_{i+1,(j+l)\\bmod k} + f_{i,j}$\n\n\u6240\u4ee5\u5c31\u6709\u4e86\u4e00\u4e2a $ O(n^2k)$ \u7684\u505a\u6cd5\u2026\u2026\n\n```cpp\n#include<cstdio>\n#include<iostream>\n#define int long long\nusing namespace std;\nconst int N=1e5+10,K=1e3+10,mod=998244353;\nint n,k,f[N][K],invjc=1;\nint fpow(int x,int y){\n\tint sum=1;\n\tfor(;y;y>>=1ll){\n\t\tif(y&1ll)sum=(sum*x)%mod;\n\t\tx=(x*x)%mod;\n\t}\n\treturn sum;\n}\nint inv(int x){return fpow(x,mod-2);}\nsigned main(){\n\tscanf(\"%lld%lld\",&n,&k);\n\tf[1][0]=1;\n\tfor(int i=2;i<=n;++i)invjc=(invjc*i)%mod;\n\tinvjc=inv(invjc);\n\tfor(int i=1;i<n;++i){\n\t\tfor(int j=0;j<k;++j){\n\t\t\tfor(int l=0;l<=i;++l){\n\t\t\t\tf[i+1][(j+l)%k]=(f[i+1][(j+l)%k]+f[i][j])%mod;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=0;i<k;++i)printf(\"%lld \",(f[n][i]*invjc)%mod);\n\tputs(\"\");\n\treturn (0^0);\n}\n```\n\n~~\u7a33\u7a33\u5730T\u98de\u4e86~~\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f00\u59cb\u8003\u8651\u4f18\u5316\u3002\n\n## \u7a7a\u95f4\n\n\u5bf9\u4e8e\u8fd9\u79cd\u53ea\u7531\u524d\u4e00\u5c42\u66f4\u65b0\u8fc7\u6765\u7684\u6211\u4eec\u901a\u5e38\u4f1a\u4f7f\u7528\u6eda\u52a8\u6570\u7ec4\u3002\n\n\u8fd9\u6837\u7a7a\u95f4\u5c31\u4e0d\u4f1a\u70b8\u4e86\u3002(\u597d\u50cf\u4e0d\u5f00\u6ca1\u70b8\uff1f\uff1f\uff1f)\n\n## \u65f6\u95f4\n\n\u6211\u4eec\u5c1d\u8bd5~~\u63d0\u9ad8\u4ee3\u7801\u590d\u6742\u5ea6~~\u5c06DP\u7684\u8f6c\u79fb\u4ece\u4ece\u524d\u5f80\u540e\u66f4\u65b0\u6539\u4e3a\u4ece\u7531\u524d\u9762\u8f6c\u79fb\u3002\n\n\u4f1a\u9ebb\u70e6\u4e00\u4e9b\uff0c\u6211\u4eec\u5148\u5b9a\u4e49\u4e0b\u9650 $d=(j-i+1)\\bmod k$\n\n\u90a3\u4e48\u6211\u4eec\u4f1a\u63a8\u51fa\u4ee5\u4e0b\u8f6c\u79fb\u65b9\u7a0b\n\n\u5f53$ d \\le j $ \u65f6 \u53ea\u8981 $ d \\le x \\le j $ \u65f6 $ f_{i-1,x} $ \u662f\u53ef\u4ee5\u66f4\u65b0\u5230 $ f_{i,j} $ \u7684\u3002\n\n\u56e0\u4e3a\u5982\u4e0a\u6587\u6240\u8ff0\uff0c\u6bcf\u6b21\u63d2\u5165\u7684 $i$ \u53ef\u4ee5\u81f3\u591a\u4ea7\u751f $i-1$ \u4e2a\u9006\u5e8f\u5bf9\u3002\n\n\u6700\u5c11\u5219\u4e3a $0$ \u4e2a\u3002\n\n\u6240\u4ee5\u5728\u8fd9\u4e2a\u4e0b\u9650 $d$ \u5230\u4e0a\u9650 $j$ \u8fd9\u4e2a\u8303\u56f4\u5185\u90fd\u662f\u53ef\u4ee5\u66f4\u65b0\u8fc7\u6765\u7684\u3002\n\n\u4e3a\u4ec0\u8981\u8003\u8651 $d$ \u7684\u5927\u5c0f\u5462\uff1f\n\n\u56e0\u4e3a \u8fd9\u4e2a $d$ \u662f $ \\bmod \\ k $ \u610f\u4e49\u4e0b\u7684\uff0c\u6240\u4ee5\u539f\u59cb\u53ef\u80fd\u4e3a\u8d1f\uff0c\n\n\u90a3\u4e48 $d$ \u5c31\u4f1a\u5927\u4e8e $j$ \u3002\n\n\u6b64\u65f6\u5f53 $ d \\le x < n $ \u65f6 $ f_{i-1,x} $ \u4e5f\u662f\u5bf9 $ f_{i,j} $ \u6709\u8d21\u732e\u7684\u3002\n\n\u4f46\u662f\u8fd8\u6709 $ 0 \\le x \\le j$ \u7684\u8fd9\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u4e5f\u8981\u7b97\u4e0a\u3002\n\n\u7efc\u4e0a\u6240\u8ff0\uff0c\u6211\u4eec\u8981\u4e24\u79cd\u8ba8\u8bba\u53bb\u8f6c\u79fb\u3002\n\n\u7136\u540e\u5c31\u6709\u4e86DP\u7531\u524d\u9762\u8f6c\u79fb\u7684\u7248\u672c\u3002\n\n```cpp\n#include<cstdio>\n#include<iostream>\n#define int long long\nusing namespace std;\nconst int K=1e3+10,mod=998244353;\nint n,k,f[2][K],invjc=1;\nint fpow(int x,int y){\n\tint sum=1;\n\tfor(;y;y>>=1ll){\n\t\tif(y&1ll)sum=(sum*x)%mod;\n\t\tx=(x*x)%mod;\n\t}\n\treturn sum;\n}\nint inv(int x){return fpow(x,mod-2);}\nsigned main(){\n\tscanf(\"%lld%lld\",&n,&k);\n\tf[1][0]=1;\n\tfor(int i=2;i<=n;++i)invjc=(invjc*i)%mod;\n\tinvjc=inv(invjc);\n\tfor(int i=2;i<=n;++i){\n\t\tint u=(i&1),v=(u^1);\n\t\tfor(int j=0;j<k;++j){\n\t\t\tint d=((j-i+1)%k+k)%k;\n\t\t\tif(d<=j)for(int l=d;l<=j;++l)f[u][j]=(f[u][j]+f[v][l])%mod;\n\t\t\telse{\n\t\t\t\tfor(int l=d;l<k;++l)f[u][j]=(f[u][j]+f[v][l])%mod;\n\t\t\t\tfor(int l=0;l<=j;++l)f[u][j]=(f[u][j]+f[v][l])%mod;\n\t\t\t}\n\t\t}\n\t\tfor(int j=0;j<k;++j)f[v][j]=0;\n\t}\n\tfor(int i=0;i<k;++i)printf(\"%lld \",(f[(n&1)][i]*invjc)%mod);\n\tputs(\"\");\n\treturn (0^0);\n}\n```\n\n~~\u5c45\u7136\u6709\u5206\uff01\uff01\uff01~~\n\n\u5176\u5b9e\u65f6\u95f4\u590d\u6742\u5ea6\u8fd8\u662f $ O(n^2k) $ \u4f46\u662f\u8fd9\u6837\u5c31\u53ef\u4ee5\u65b9\u4fbf\u6211\u4eec\u4f18\u5316\u4e86\u3002\n\n\u6211\u4eec\u53d1\u73b0\u6bcf\u6b21 $ f_{i,j} $ \u7684\u8f6c\u79fb\u90fd\u662f\u7531\u8fde\u7eed\u7684\u4e00\u6bb5\u6216\u4e24\u6bb5\u7684\u4e0a\u4e00\u6b21\u7684DP\u503c\u8f6c\u79fb\u7684\u3002\n\n\u6240\u4ee5\u6211\u4eec\u641e\u4e00\u4e2a\u524d\u7f00\u548c\u4f18\u5316\uff0c\u6bcf\u6b21\u8f6c\u79fb\u5c31\u662f $O(1)$ \u7684\u4e86\uff01\n\n\u4f46\u662f\u7531\u4e8e\u53d6\u6a21\u5e38\u6570\u5f88\u7384\u5b66~~ex~~\u3002\n\n\u8fd9\u6837\u5e26\u6eda\u52a8\u6570\u7ec4\u7684 $ O(nk) $ \u505a\u6cd5\u8fc7\u4e0d\u4e86\u2026\u2026\n\n\u6240\u4ee5\u6211\u6253\u8868\u53d1\u73b0\u4e86\u4e00\u4e2a\u89c4\u5f8b\u3002\n\n\u5f53 $ n \\ge k $ \u65f6\uff0c\u6240\u6709\u503c\u7684\u7b54\u6848\u90fd\u4e3a $ 1/k $ \u6240\u4ee5\u8fd9\u6837 $ O(nk) $ \u505a\u6cd5\u5c31\u8715\u53d8\u4e3a $ O(k^2) $ \u505a\u6cd5\u5566\uff01\uff01\uff01\n\n\u53d6\u6a21\u5e38\u6570\u5565\u7684\u5c31\u57fa\u672c\u6ca1\u95ee\u9898\u4e86\uff01\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u6b22\u4e50AC\u4e86\uff01\n\n# AC code\n\n```cpp\n#include<cstdio>\n#include<iostream>\n#define int long long\nusing namespace std;\nconst int K=1e3+10,mod=998244353;\nint n,k,f[2][K],g[2][K],invjc=1;\nint fpow(int x,int y){\n\tint sum=1;\n\tfor(;y;y>>=1ll){\n\t\tif(y&1ll)sum=(sum*x)%mod;\n\t\tx=(x*x)%mod;\n\t}\n\treturn sum;\n}\nint inv(int x){return fpow(x,mod-2);}\nsigned main(){\n\tscanf(\"%lld%lld\",&n,&k);\n\tif(n>k){\n\t\tn=inv(k);\n\t\tfor(;k--;)printf(\"%lld \",n);\n\t\tputs(\"\");\n\t\treturn (0^0);\n\t}\n\tf[1][0]=g[1][0]=1;\n\tfor(int i=1;i<k;++i)g[1][i]=1;\n\tfor(int i=2;i<=n;++i)invjc=(invjc*i)%mod;\n\tinvjc=inv(invjc);\n\tfor(int i=2;i<=n;++i){\n\t\tint u=(i&1),v=(u^1);\n\t\tfor(int j=0;j<k;++j){\n\t\t\tint d=((j-i+1)%k+k)%k;\n\t\t\tif(d<=j){\n\t\t\t\tif(d==0)f[u][j]=(g[v][j])%mod;\n\t\t\t\telse f[u][j]=((g[v][j]-g[v][d-1])%mod+mod)%mod;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tf[u][j]=((g[v][k-1]-g[v][d-1])%mod+mod)%mod;\n\t\t\t\tf[u][j]=(f[u][j]+g[v][j])%mod;\n\t\t\t}\n\t\t\tif(j==0)g[u][j]=f[u][j];\n\t\t\telse g[u][j]=(g[u][j-1]+f[u][j])%mod;\n\t\t}\n\t}\n\tfor(int i=0;i<k;++i)printf(\"%lld \",(f[(n&1)][i]*invjc)%mod);\n\tputs(\"\");\n\treturn (0^0);\n}\n```\n\n\u5c0f\u5c0f\u7684\u63d0\u793a\uff1a\n\n\u6ce8\u610f\u8d1f\u6570\u53d6\u6a21\u548c\u6700\u540e\u4e58\u4e0a\u5168\u6392\u5217\u603b\u6570\u7684\u9006\u5143\u3002\n\n\u795dA ~~(\u770b\u5230\u8fd9\u4e86\u8fd8\u4e0d\u70b9\u8d5e\u5417QWQ)~~",
        "postTime": 1644411095,
        "uid": 374929,
        "name": "SpeMars",
        "ccfLevel": 7,
        "title": "\u672a\u6765\u7684\u672a\u6765\u306e\u9898\u89e3"
    },
    {
        "content": "\u8003\u573a\u4e0a\u79d2\u6389\u4e86\u8fd9\u9053\u9898\uff0c\u6765\u5199\u7bc7\u9898\u89e3\uff0c\u9996\u5148\u8fd9\u9053\u9898\u8981\u5c06\u9636\u4e58\u9006\u5143\u6253\u8868\uff0c\u56e0\u4e3a\u8981\u6c42\u7ec4\u5408\u6570\u548c\u6709\u7406\u6570\u53d6\u4f59\uff0c\u53c2\u8003\u8fd9\u4e24\u9053\u6a21\u677f\uff1a[P5431](/problem/P5431)\uff0c[P2613](problem/P2613)\u3002\n\n\u63a5\u4e0b\u6765\u53ef\u4ee5\u8fdb\u884c\u7ebf\u6027 dp\uff0c\u4f7f\u7528\u5dee\u5206\u4f18\u5316\uff0c\u6eda\u52a8\u6570\u7ec4\uff08\u4e0d\u6eda\u4e5f\u53ef\u4ee5\uff09\uff0c\u6bcf\u6b21\u9012\u63a8\u65f6\u6574\u4e2a\u7684 k \u53ef\u4ee5\u89c6\u4e3a\u5168\u5c40\u52a0\u4e00\uff0c\u5269\u4f59\u7684\u5728\u5dee\u5206\u6570\u7ec4\u4e0a\u76f4\u63a5\u4fee\u6539\u5373\u53ef\uff0c\u6700\u540e\u5c06\u5dee\u5206\u6570\u7ec4\u8f6c\u6362\u4e3a\u5b9e\u9645\u6570\u7ec4\u3002\n\n\u5177\u4f53\u5b9e\u73b0\uff0c\u8bb0 $md=i\\bmod k,cd=i/k$\uff0c\u51cf\u5c11\u5e38\u6570\uff0c$f$ \u6570\u7ec4\u4e3a\u4e0a\u4e00\u72b6\u6001\uff0c$g$ \u6570\u7ec4\u4e3a\u8fd9\u4e00\u6b21\u72b6\u6001\u7684\u5dee\u5206\u6570\u7ec4\uff08\u5faa\u73af\u672b\u5c3e\u5c06 $g$ \u6570\u7ec4\u8f6c\u6362\u4e3a $f$ \u6570\u7ec4\uff09\u3002\u5bf9\u4e8e $0\\le b<k$ \u90fd\u4f1a\u5bf9\u4e0b\u4e00\u72b6\u6001\u9020\u6210 $cd\\times f[b]$ \u7684\u5f71\u54cd\uff0c\u5bf9\u4e8e\u5269\u4f59\u7684\u4f59\u6570\uff0c\u53ea\u5bf9 $b-(b+md)\\bmod k$ \u7684\u6570\u5b57\u9020\u6210 $f[b]$ \u7684\u5f71\u54cd\uff0c\u4e8e\u662f\u8003\u573a AC \u4ee3\u7801\u5c31\u51fa\u6765\u5566\uff01\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1005,M=998244353;\ntypedef long long ll;\nchar buf[N+5],*p1,*p2,c;\n#define gc (p1==p2&&(p2=(p1=buf)+fread(buf,1,N,stdin),p1==p2)?EOF:*p1++)\ninline void read(int &x){\n\tx=0;while(!isdigit(c=gc));\n\tdo x=x*10+c-'0';while(isdigit(c=gc));\n}\ninline ll qp(ll a,int x){\n\tll bs=a;\n\tfor(a=1;x;x>>=1){\n\t\tif(x&1)a=a*bs%M;bs=bs*bs%M;\n\t}return a;\n}\nint n,k,md,cd;\nll f[N],g[N],jc;\nint main(){\n\tread(n),read(k);int a,b,d;\n\tfor(a=jc=1;a<=n;++a)jc=jc*a%M;jc=qp(jc,M-2);f[0]=1;\n\tfor(a=1;a<n;++a){\n\t\tif(++md==k)md=0,++cd;\n\t\tfor(b=0;b<k;++b){\n\t\t\tg[0]=(g[0]+f[b]*cd)%M;d=b+md;if((g[b]+=f[b])>=M)g[b]-=M;\n\t\t\tif(d<k){if((g[d+1]-=f[b])<0)g[d+1]+=M;}\n\t\t\telse{\n\t\t\t\tif((g[0]+=f[b])>=M)g[0]-=M;\n\t\t\t\tif((g[d-k+1]-=f[b])<0)g[d-k+1]+=M;\n\t\t\t}\n\t\t}\n\t\tfor(f[0]=g[0],g[0]=0,b=1;b<k;g[b++]=0)\n\t\t\tif((f[b]=f[b-1]+g[b])>M)f[b]-=M;\n\t}\n\tfor(b=0;b<k;++b)printf(\"%lld \",f[b]*jc%M);\n\treturn 0;\n}\n```",
        "postTime": 1644147235,
        "uid": 502410,
        "name": "EnofTaiPeople",
        "ccfLevel": 0,
        "title": "P8107 [Cnoi2021]\u672a\u6765\u8bd5\u9898 \u9898\u89e3"
    },
    {
        "content": "### \u9898\u76ee\u63cf\u8ff0\n\n\u7ed9\u5b9a\u4e24\u4e2a\u6b63\u6574\u6570 $n,k$ \u3002\u5bf9 $\\forall i \\in [0,k)$ \uff0c\u6c42\u7b49\u6982\u7387\u751f\u6210\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5168\u6392\u5217\u65f6\uff0c\u5168\u6392\u5217\u4e2d\u9006\u5e8f\u7684\u4e2a\u6570\u5bf9 $k$ \u53d6\u6a21\u540e\uff0c\u4f59\u6570\u4e3a $i$ \u7684\u6982\u7387\u3002\n\n### \u5206\u6790\n\n\u770b\u5230\u8fd9\u9053\u9898\u540e\uff0c\u6709\u4e00\u4e2a\u66b4\u529b\u505a\u6cd5\u662f\u663e\u7136\u7684\uff0c\u8bbe $dp_{i,j}$ \u4e3a\u751f\u6210\u957f\u5ea6\u4e3a $i$ \u7684\u5e8f\u5217\u65f6\uff0c\u9006\u5e8f\u5bf9\u4e2a\u6570\u5bf9 $k$ \u53d6\u6a21\u540e\u4f59\u6570\u4e3a $j$ \u7684\u6982\u7387\u3002\n\n\u5219\u6709\u4ee5\u4e0b\u8f6c\u79fb\uff1a\n\n$dp_{i,j}=\\frac{1}{i}\\sum_{l=0}^{i-1}dp_{i-1,(j-l)\\bmod{k}}$\n\n\u7ed9\u51fa\u8fd9\u4e2a\u8f6c\u79fb\u7684\u89e3\u91ca\uff1a\u6211\u4eec\u8003\u8651\u8fd9\u6837\u4e00\u4ef6\u4e8b\u60c5\uff0c\u5bf9\u4e8e\u4e00\u79cd\u957f\u5ea6\u4e3a $i$ \uff0c\u9006\u5e8f\u5bf9\u4e2a\u6570\u4e3a $j$ \u7684\u5168\u6392\u5217\u5e8f\u5217\uff0c\u79fb\u53bb\u6570\u5b57 $i$ \u540e\uff0c\u6240\u51cf\u5c11\u7684\u9006\u5e8f\u5bf9\u6570\u91cf\u53ef\u80fd\u6709 $0,1,... ,(i-1)$ \u4e2a\u3002\u56e0\u4e3a\u5728\u8fd9\u4e2a\u5e8f\u5217\u4e2d\uff0c $i$ \u662f\u6700\u5927\u7684\u6570\u5b57\uff0c\u5176\u4e0e\u6240\u6709\u5e8f\u5217\u4e2d\u5728\u5176\u540e\u9762\u7684\u5143\u7d20\u5747\u53ef\u4ee5\u6784\u6210\u9006\u5e8f\u5bf9\uff0c\u800c $i$ \u5728\u6bcf\u4e2a\u4f4d\u7f6e\u7684\u6982\u7387\u5747\u4e3a $\\frac{1}{i}$ \uff0c\u56e0\u6b64\uff0c\u8f6c\u79fb\u65b9\u7a0b\u6210\u7acb\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\ndp[1][0]=1;\nfor(int i=2;i<=n;i++){\n\tfor(int j=0;j<k;j++){\n\t\tdp[i][j]=0;\n\t\tfor(int l=0;l<i;l++){\n\t\t\tdp[i][j]+=dp[i-1][((j-l)%k+k)%k];\n\t\t\tdp[i][j]%=mod;\n\t\t}\n\t\tdp[i][j]=(dp[i][j]*(inv[i])%mod;\n\t}\n}\n```\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u4e2a\u8f6c\u79fb\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n^{2}k)$ \u7684\uff0c\u663e\u7136\u4e0d\u80fd\u901a\u8fc7\u672c\u9898\uff0c\u6211\u4eec\u8003\u8651\u53ef\u4ee5\u5728\u6b64\u57fa\u7840\u4e0a\u8fdb\u884c\u4f18\u5316\u3002\n\n### \u4f18\u5316\n\n\u4e00\u4e2a\u5f88\u663e\u7136\u7684\u4f18\u5316\u662f\uff1a\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u4e00\u4e2a\u5f88\u663e\u7136\u7684\u4e8b\u60c5\u662f\uff1a$\\forall j \\in [0,k)$ ,\u5728\u5bf9\u4e8e $l$ \u7684\u904d\u5386\u65f6\uff0c\u90fd\u88ab\u81f3\u5c11\u7b97\u4e86 $\\lfloor \\frac{i}{k} \\rfloor$ \u6b21\u3002\n\n\u800c\u540c\u7406\u53ef\u5f97\uff0c\u5bf9\u4e8e\u5269\u4f59\u7684\u4e0d\u6ee1\u4e00\u6b21\u7684\u904d\u5386\uff0c\u4e5f\u4e00\u5b9a\u6784\u6210\u4e00\u4e2a\u8fde\u7eed\u7684\u533a\u95f4\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $i$ ,\u8003\u8651\u7ef4\u62a4\u4e00\u4e2a $dp_{i}$ \u7684\u524d\u7f00\u548c\uff0c\u8f6c\u79fb\u65f6\u5206\u7c7b\u8ba8\u8bba\u5373\u53ef\u3002\u8f6c\u79fb\u4e2d\u7684\u7ec6\u8282\u6bd4\u8f83\u591a\uff0c\u9700\u591a\u52a0\u6ce8\u610f\u3002\n\n\u8fd9\u6837\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f $O(nk)$ \uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n### \u7ec6\u8282\n* \u5728 $n\\geq k$ \u65f6\uff0c\u6bcf\u79cd\u60c5\u51b5\u51fa\u73b0\u7684\u6982\u7387\u663e\u7136\u5747\u4e3a $\\frac{1}{k}$ \uff0c\u76f4\u63a5\u8f93\u51fa\u5373\u53ef\uff0c\u8fd9\u6837\uff0c\u6211\u4eec\u6210\u529f\u5730\u5c06 $n,k$ \u964d\u5230\u4e86\u540c\u4e00\u4e2a\u6570\u91cf\u7ea7\u3002\n\n* \u5f88\u663e\u7136\uff0c\u8fd9\u4e2a\u8f6c\u79fb\u53ef\u4ee5\u4f7f\u7528\u6eda\u52a8\u6570\u7ec4\u8fdb\u884c\u4f18\u5316\uff0c\u907f\u514d\u7a7a\u95f4\u590d\u6742\u5ea6\u7684\u7206\u70b8\u3002\n\n### AC\u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#define int long long\n\nusing namespace std;\n\nconst int mod=998244353;\n\nint dp[2][1001]={},sum[2][1001]={},inv[100001]={};\n\nsigned main(){\n\tint n,k,tmp,t1,t2;\n\tscanf(\"%lld%lld\",&n,&k);\n\tif(n>k) n=k;\n\tdp[1][0]=1;\n\tfor(int i=0;i<k;i++) sum[1][i]=1;\n\tinv[1]=1; for(int i=2;i<=n;i++) inv[i]=(inv[mod%i]*(mod-mod/i))%mod;\n\tfor(int i=2;i<=n;i++){\n\t\tfor(int j=0;j<k;j++){\n\t\t\tdp[i&1][j]=0; sum[i&1][j]=0;\n\t\t\tdp[i&1][j]=((i/k)*sum[(i-1)&1][k-1])%mod;\n\t\t\tif(j>=(i%k)){\n\t\t\t\tdp[i&1][j]+=((sum[(i-1)&1][j]-sum[(i-1)&1][j-(i%k)])%mod+mod)%mod;\n\t\t\t\tdp[i&1][j]%=mod;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tt1=j+1,t2=i%k-1;\n\t\t\t\tdp[i&1][j]+=((sum[(i-1)&1][((j-t1)%k+k)%k]-sum[(i-1)&1][((((j-t2)%k+k)%k-1)%k+k)%k])%mod+mod)%mod;\n\t\t\t\tdp[i&1][j]%=mod;\n\t\t\t\tdp[i&1][j]+=sum[(i-1)&1][j]; dp[i&1][j]%=mod;\n\t\t\t}\n\t\t\tdp[i&1][j]%=mod;\n\t\t\tdp[i&1][j]=(dp[i&1][j]*inv[i])%mod;\n\t\t\tsum[i&1][j]=dp[i&1][j]; if(j) sum[i&1][j]+=sum[i&1][j-1];\n\t\t\tsum[i&1][j]%=mod;\n\t\t}\n\t}\n\tfor(int i=0;i<k;i++) printf(\"%lld \",dp[n&1][i]);\n\treturn 0;\n}\n```\n",
        "postTime": 1644035536,
        "uid": 525349,
        "name": "Sakura_xyz",
        "ccfLevel": 4,
        "title": "P8107 [Cnoi2021]\u672a\u6765\u8bd5\u9898 \u9898\u89e3"
    },
    {
        "content": "~~\u7ed9\u4e00\u79cd OEIS \u89e3\u6cd5~~\n\n\u9996\u5148\u4e0d\u7ba1\u6a21 $k$ \u7684\u9650\u5236\uff0c\u76f4\u63a5\u628a\u6837\u4f8b\u89e3\u91ca\u91cc\u7684\u9006\u5e8f\u5bf9\u6570\u6254\u5230 OEIS \u4e0a\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u73a9\u610f\u513f\u7684 GF \u662f\uff1a\n$$\\prod_{i=1}^n\\sum_{j=1}^ix^j$$\n\u7136\u540e\u8003\u8651\u600e\u4e48\u7b97\u3002\u7531\u4e8e\u4e58\u51fa\u6765\u7684\u5f0f\u5b50\u7684\u9879\u6570\u662f $n^2$ \u6570\u91cf\u7ea7\u7684\uff0c\u56e0\u6b64\u4efb\u4f55\u591a\u9879\u5f0f\u505a\u6cd5\u90fd\u4e0d\u7528\u60f3\u4e86\u3002\u4e8e\u662f\u6211\u4eec\u8003\u8651\u628a\u6a21 $k$ \u7684\u9650\u5236\u62ff\u56de\u6765\u505a dp\u3002$f_{i,j}$ \u8868\u793a\u5728\u7b2c $i$ \u4e2a\u56e0\u5f0f\u5904\uff0c\u6240\u6709\u6b21\u6570\u6a21 $k$ \u4f59 $j$ \u7684\u9879\u7684\u7cfb\u6570\u548c\u3002\u4e8e\u662f\u76f4\u63a5\u5199\u51fa\u8f6c\u79fb\u65b9\u7a0b\uff1a\n$$f_{i,j}=\\sum_{l=1}^i f_{i-1,(j-l)\\bmod k}$$\n\u7136\u800c\u66b4\u529b\u8f6c\u79fb\u7684\u590d\u6742\u5ea6\u662f $O(nk^2)$\uff0c\u663e\u7136\u4e0d\u884c\u3002\u6240\u4ee5\u6211\u4eec\u9700\u8981\u52a0\u901f\u8f6c\u79fb\u8fc7\u7a0b\u3002\u4e0d\u96be\u53d1\u73b0\uff0c$\\sum\\limits_{l=1}^if_{i-1,(j-l)\\bmod k}$ \u7684\u7b2c\u4e8c\u7ef4\u662f\u5728\u6a21\u610f\u4e49\u4e0b\u662f\u8fde\u7eed\u7684\u3002\u56e0\u6b64\u4f60\u7ef4\u62a4\u4e00\u4e2a\u524d\u7f00\u548c\uff0c\u5c31\u628a\u590d\u6742\u5ea6\u538b\u5230 $O(nk)$ \u4e86\u3002\u5173\u4e8e\u7a7a\u95f4\uff0c\u4e0a\u4e2a\u6eda\u52a8\u6570\u7ec4\u538b\u6389\u7b2c\u4e00\u7ef4\u5373\u662f $O(k)$\u3002\u5177\u4f53\u89c1 Code\uff1a\n```cpp\ndp[0][0] = 1;\nfor(int i = 1; i <= k; ++i) sum[0][i] = 1;\nfor(int i = 1; i < n; ++i){\n\tint t = (i & 1), p = i % k;\n\tsum[t][0] = 0;\n\tfor(int j = 0; j < k; ++j){\n\t\tdp[t][j] = sum[t ^ 1][k] * (i / k) % MOD;\n\t\tif(j >= p) dp[t][j] = (dp[t][j] + sum[t ^ 1][j + 1] - sum[t ^ 1][j - p]) % MOD;\n\t\telse dp[t][j] = (dp[t][j] - sum[t ^ 1][j - p + k] + sum[t ^ 1][j + 1] + sum[t ^ 1][k] + MOD) % MOD;\n\t\tsum[t][j + 1] = (sum[t][j] + dp[t][j]) % MOD;\n\t}\n}\n```\n\u6700\u540e\uff0c\u7edf\u8ba1\u7b54\u6848\u65f6\u4e0d\u8981\u5fd8\u4e86\u4e58\u4e0a $n!$ \u7684\u9006\u5143\u3002\n\nupd\uff1a\u5176\u5b9e\u8fd9\u4e2a GF \u662f\u6211\u81ea\u5df1\u63a8\u51fa\u6765\u7684\u3002\u672c\u8d28\u4e0a\u5b83\u5c31\u662f\u5728\u679a\u4e3e\u6bcf\u4e00\u4f4d\u6240\u9009\u7684\u6570\u4e0e\u4e4b\u524d\u7684\u76f8\u5bf9\u5927\u5c0f\u5173\u7cfb\uff0c\u56e0\u6b64\u76f4\u63a5 dp \u4e5f\u6ca1\u6709\u4efb\u4f55\u95ee\u9898\u3002~~\u4e0d\u8fc7\u5047\u6258 OEIS \u4e4b\u624b\u66f4\u6709\u610f\u601d~~",
        "postTime": 1644021885,
        "uid": 314991,
        "name": "zhouyuhang",
        "ccfLevel": 7,
        "title": "[Cnoi2021]\u672a\u6765\u8bd5\u9898 \u9898\u89e3"
    }
]
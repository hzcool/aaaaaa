[
    {
        "content": "## [\u9898\u610f](https://blog.csdn.net/BeNoble_/article/details/79825013)\n\n\u7ed9\u4f60\u4e00\u5e45\u65e0\u5411\u56fe$,$\u4e00\u6761\u8def\u5f84\u7684\u6743\u503c\u4e3a\u8def\u5f84\u4e0a\u8fb9\u6743\u7684\u5f02\u6216\u548c\n\n\u4f60\u5728\u6bcf\u4e2a\u70b9\u53ef\u4ee5\u7b49\u6982\u7387\u7684\u8d70\u5411\u76f8\u8fde\u7684\u70b9\n\n\u6c42$1\\to n$\u8def\u5f84\u6743\u503c\u7684\u671f\u671b(\u6709\u81ea\u73af\u91cd\u8fb9)\n\n---\n\n\u4e00\u5f00\u59cb\u60f3\u504f\u4e86$,$\u4ee5\u4e3a\u671f\u671b\u7684\u5f02\u6216\u5c31\u662f\u5f02\u6216\u7684\u671f\u671b\n\n\u540e\u6765\u53d1\u73b0\u53ef\u4ee5\u6309\u4f4d\u5904\u7406\n\n---\n\n## \u9898\u89e3\n\n~~\u6574\u4e2a\u5904\u7406\u663e\u7136\u662f\u4e0d\u884c\u7684~~\n\n\u56e0\u4e3a\u6bcf\u4e00\u4f4d\u90fd\u662f\u72ec\u7acb\u7684$,$\u6240\u4ee5\u8003\u8651\u6309\u4f4d\u5904\u7406$,$\u6c42\u51fa\u6bcf\u4e00\u4f4d\u662f$1$\u7684\u6982\u7387\n\n\u8fd8\u662f~~\u6309\u7167\u5957\u8def~~\u8bbe$f[u]$\u8868\u793a$u\\to n$\u7684\u8def\u5f84\u8fd9\u4e00\u4f4d\u4e3a$1$\u7684\u6982\u7387,$dg[u]$\u8868\u793a$u$\u7684\u51fa\u5ea6\n\n\u90a3\u4e48$1-f[u]$\u5c31\u662f$u\\to n$\u7684\u8def\u5f84\u8fd9\u4e00\u4f4d\u4e3a$0$\u7684\u6982\u7387\n\n$$\\forall_{(u,v)\\in E}\\ f[u]=\\frac1{dg[u]}(\\sum_{w(u,v)=0}f[v]+\\sum_{w(u,v)=1}1-f[v])$$\n\n$$\\Rightarrow\\forall_{(u,v)\\in E}\\ dg[u]f[u]=\\sum_{w(u,v)=0}f[v]+\\sum_{w(u,v)=1}1-f[v]$$\n\n\u4e5f\u5c31\u662f\u8fd9\u6761\u8fb9\u8fd9\u4e00\u4f4d\u662f$1$\u90a3\u4e48$v\\to n$\u7684\u6743\u503c\u5c31\u8981\u662f$0;$\u53cd\u4e4b\u5219\u4e3a$1$\n\n\u65b9\u7a0b\u5373\u4e3a\n\n$$dg[u]f[u]-\\sum_{w(u,v)=0}f[v]+\\sum_{w(u,v)=1}f[v]=\\sum_{w(u,v)=1}1$$\n\n\u9ad8\u65af\u6d88\u5143\u5373\u53ef\n\n\u6700\u540e$ans=\\sum_i2^if_i[1]$\n\n\u6ce8\u610f\u8fd9\u9898\u867d\u7136\u662f\u65e0\u5411\u56fe$,$\u4f46\u662f\u81ea\u73af\u4e5f\u4e0d\u80fd\u52a0\u4e24\u6b21$,$\u9700\u8981\u7279\u5224\n\n```\n#include<bits/stdc++.h>\n#define fp(i,a,b) for(register int i=a,I=b+1;i<I;++i)\n#define fd(i,a,b) for(register int i=a,I=b-1;i>I;--i)\n#define go(u) for(register int i=fi[u],v=e[i].to;i;v=e[i=e[i].nx].to)\n#define file(s) freopen(s\".in\",\"r\",stdin),freopen(s\".out\",\"w\",stdout)\ntemplate<class T>inline bool cmax(T&a,const T&b){return a<b?a=b,1:0;}\ntemplate<class T>inline bool cmin(T&a,const T&b){return a>b?a=b,1:0;}\nusing namespace std;\nchar ss[1<<17],*A=ss,*B=ss;\ninline char gc(){return A==B&&(B=(A=ss)+fread(ss,1,1<<17,stdin),A==B)?-1:*A++;}\ntemplate<class T>inline void sd(T&x){\n    char c;T y=1;while(c=gc(),(c<48||57<c)&&c!=-1)if(c==45)y=-1;x=c-48;\n    while(c=gc(),47<c&&c<58)x=x*10+c-48;x*=y;\n}\nchar sr[1<<21],z[20];int C=-1,Z;\ninline void Ot(){fwrite(sr,1,C+1,stdout),C=-1;}\ntemplate<class T>inline void we(T x){\n    if(C>1<<20)Ot();if(x<0)sr[++C]=45,x=-x;\n    while(z[++Z]=x%10+48,x/=10);\n    while(sr[++C]=z[Z],--Z);sr[++C]='\\n';\n}\nconst int N=105,M=2e4+5;\nconst double eps=1e-9;\ntypedef int arr[N];\ntypedef double db;\nstruct eg{int nx,to,w;}e[M];\nint n,m,Mx;arr dg,fi;db Ans,ans[N],G[N][N];\ninline void build(int x){\n    G[n][n]=1;\n    fp(u,1,n-1){\n        G[u][u]=dg[u];\n        go(u)\n            if(e[i].w&x)++G[u][v],++G[u][n+1];\n            else --G[u][v];\n    }\n}\ninline int cmp(db x){return fabs(x)<eps?0:x<0?-1:1;}\ninline void Gauss(int n){\n    db t;int mx;\n    fp(i,1,n){mx=i;\n        fp(j,i,n)if(cmp(G[mx][i]-G[j][i]))mx=j;\n        fp(j,i+1,n)if(cmp(G[j][i])){\n            t=G[j][i]/G[i][i];\n            fp(k,i,n+1)G[j][k]-=G[i][k]*t;\n        }\n    }\n    fd(i,n,1){\n        fp(j,i+1,n)G[i][n+1]-=G[i][j]*ans[j];\n        ans[i]=G[i][n+1]/G[i][i];\n    }\n\n    fp(i,1,n)fp(j,1,n+1)G[i][j]=0;\n}\ninline void add(int u,int v,int w){static int ce=0;e[++ce]={fi[u],v,w},fi[u]=ce;}\nint main(){\n    #ifndef ONLINE_JUDGE\n        file(\"s\");\n    #endif\n    sd(n),sd(m);int u,v,w;\n    while(m--){\n        sd(u),sd(v),sd(w),add(u,v,w),++dg[u];\n        if(u^v)add(v,u,w),++dg[v];cmax(Mx,w);\n    }\n    for(int i=1;i<=Mx;i<<=1)\n        build(i),Gauss(n),Ans+=ans[1]*i;\n    printf(\"%.3lf\\n\",Ans);\nreturn 0;\n}\n```",
        "postTime": 1522899024,
        "uid": 20156,
        "name": "Kelin",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3211 \u3010[HNOI2011]XOR\u548c\u8def\u5f84\u3011"
    },
    {
        "content": "[\u9898\u76ee\u94fe\u63a5](https://www.luogu.org/problemnew/show/P3211)\n\n\u4e00\u822c\u6765\u8bf4\uff0c\u9047\u5230\u6c42\u671f\u671b\u7684\u9898\u65f6\uff0c\u6211\u4eec\u90fd\u8981\u8f6c\u5316\u671f\u671b\u7684\u5f62\u5f0f\u4f7f\u5176\u4fbf\u4e8e\u6c42\u89e3\u3002\n\n\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5b83\u8f6c\u5316\u4e3a\u4e00\u4e2a\u671f\u671bdp\u6a21\u578b\u3002\n\n\u6211\u4eec\u5148\u8bd5\u7740\u5217\u4e00\u4e0bdp\u5f0f\u5b50\uff1a\n\n\u8bbe$f[i]$\u4e3a\u5f53\u524d\u5728$i$\u53f7\u8282\u70b9\uff0c\u8d70\u5230$n$\u53f7\u8282\u70b9\u5f97\u5230\u7684\u5f02\u6216\u548c\u7684\u671f\u671b\u503c\u3002\n\n\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a$f[i]$\uff0c\u5b83\u53ef\u4ee5\u7531\u6bcf\u4e2a\u4e0e\u5b83\u76f8\u90bb\u7684\u8282\u70b9\u7684\u72b6\u6001\u8f6c\u79fb\u8fc7\u6765\u3002\u6240\u4ee5\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a\n\n$$f[i] = \\sum{(f[to[p]] \\operatorname{xor} val[p])/deg[i]}$$\n\n\uff08\u8fd9\u91cc$p$\u8868\u793a\u4e0e$i$\u76f8\u90bb\u7684\u8fb9\uff0c$to[p]$\u4e3a\u8fd9\u6761\u8fb9\u8fde\u63a5\u7684\u53e6\u4e00\u4e2a\u70b9\uff0c$val[p]$\u4e3a\u8fb9\u6743\uff0c$deg[i]$\u8868\u793a$i$\u7684\u5ea6\uff09\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5~~\u6109\u5feb\u5730~~\u8f6c\u79fb\u2026\u2026\u4e86\u5417\uff1f\n\n\u7531\u4e8e\u8fd9\u4e2a\u56fe\u4e0d\u662f\u4e00\u4e2a$DAG$\uff0c\u6240\u4ee5\u901a\u8fc7\u4e00\u4e2a\u70b9\u53ef\u80fd\u7ecf\u8fc7\u67d0\u6761\u8def\u5f84\u4f7f\u5b83\u80fd\u591f\u56de\u5230\u539f\u70b9\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9\u91cc\u7684\u72b6\u6001\u662f\u6709\u540e\u6548\u6027\u7684\u3002\n\n\u770b\u8d77\u6765\u72b6\u6001\u6709\u540e\u6548\u6027\u7684\u9898\u6211\u4eec\u4f3c\u4e4e\u5e76\u4e0d\u80fddp\u6c42\u89e3\u3002\n\n\u7136\u800c\u8fd9\u91cc\u7684\u7b54\u6848\uff08\u671f\u671b\uff09~~\u663e\u7136~~\u662f\u5b58\u5728\u7684\u3002\n\n\u4e8e\u662f\u6211\u4eec\u8bbe\u6240\u6709\u7684$f[i]$\u4e3a\u672a\u77e5\u6570\uff0c\u6839\u636e\u4e0a\u9762\u7684\u5f0f\u5b50\u5217\u65b9\u7a0b\u6c42\u89e3\u3002\n\n\u6211\u4eec\u628a\u539f\u5f0f\u8f6c\u5316\u4e00\u4e0b\uff1a\n\n$$deg[i] \\times f[i] = \\sum{(f[to[p]] \\operatorname{xor} val[p])}$$\n\n\uff08\u5176\u4e2d\u6240\u6709\u7684$f$\u4e3a\u672a\u77e5\u91cf\uff09\n\n\u6211\u4eec\u9700\u8981\u7528\u5230\u9ad8\u65af\u6d88\u5143\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(n^3)$\n\n\u7136\u540e\u6211\u4eec\u5c31\u4f1a\u53d1\u73b0\uff0c\u4e0a\u9762\u5217\u7684dp\u5f0f\u5b50\u5e26\u4e00\u4e2a$\\operatorname{xor}$\uff0c\u4e0d\u80fd\u76f4\u63a5\u7528\u8fd9\u4e2a\u5f0f\u5b50\u5217\u65b9\u7a0b\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u8003\u8651\u671f\u671b\u7684~~\u5404\u79cd\u795e\u5947\u7684~~\u6027\u8d28\uff08\u597d\u5427\u6211\u4eec\u77e5\u9053\u7684\u5173\u4e8e\u671f\u671b\u7684\u6027\u8d28\u53ea\u6709\u4e00\u4e2a\uff0c\u90a3\u5c31\u662f\u671f\u671b\u5177\u6709\u7ebf\u6027\u6027\uff0c\u5373$E(a+b) = E(a) + E(b)$\uff09\n\n\u90a3\u4e48\u7531\u4e8e\u5f02\u6216\u8fd0\u7b97\u7684\u6bcf\u4e00\u4f4d\u4e92\u4e0d\u5f71\u54cd\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u6bcf\u4e00\u4f4d\u62c6\u5f00\u3002\u8fd9\u6837\u6211\u4eec\u7684$val[p]$\u5c31\u53ea\u5269\u4e0b\u4e860\u62161\u3002\n\n\u7136\u540e\u6211\u4eec\u7684$f[i]$\u5b9a\u4e49\u5c31\u53d8\u6210\u4e86\uff1a\u5f53\u524d\u5728$i$\u53f7\u8282\u70b9\uff0c\u8d70\u5230$n$\u53f7\u8282\u70b9\u5f97\u5230\u7684\u5f02\u6216\u548c\u4e3a1\u7684\u671f\u671b\u503c\uff08\u4e5f\u5c31\u662f\u8be5\u4f4d\u4e3a1\u7684\u6982\u7387\uff09\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u80fd\u628a$\\operatorname{xor}$\u62c6\u6210\u4e24\u79cd\u60c5\u51b5\uff0c\u5373\uff1a\n\n$$deg[i] \\times f[i] = \\sum_{val[p]=0}{f[to[p]]}+\\sum_{val[p]=1}{(1-f[to[p]])}$$\n\n$$\\sum_{val[p]=0}{f[to[p]]}-\\sum_{val[p]=1}{f[to[p]]} - deg[i] \\times f[i] = -\\sum_{val[p]=1}{1}$$\n\n\uff08\u56e0\u4e3a$1\\operatorname{xor}0=0\\operatorname{xor}1=1$\uff09\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4f4d\u90fd\u505a\u4e00\u904d\uff0c\u6700\u7ec8\u7b54\u6848\u4e3a$\\sum_{i=0}^{30}{2^if[1]}$\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(30n^3)$\n\n\u4e0b\u9762\u653e\u4ee3\u7801\uff1a\n```cpp\n#include <cstdio>\n#include <cctype>\n#include <cstring>\n#include <algorithm>\n#define maxn 105\n#define maxm 20005\ninline int read() {\n\tint d=0;char ch=getchar();while(!isdigit(ch))ch=getchar();\n\twhile(isdigit(ch)){d=d*10+ch-48;ch=getchar();}return d;\n}\n\nconst double eps = 1e-9;\ninline double fabs(double x) {return x < 0 ? -x : x;}\ninline int sgn(double x) {return x > eps ? 1 : x < -eps ? -1 : 0;}\n\nint n, m, u, v, w;\nint head[maxn], ver[maxm], edge[maxm], nxt[maxm], tot;\nint deg[maxn];\n\ninline void add(int u, int v, int w) {\n\tver[++tot] = v, edge[tot] = w, nxt[tot] = head[u], head[u] = tot;\n}\n\ndouble a[maxn][maxn];\ndouble ans;\n\nvoid gauss() { // \u9ad8\u65af\u6d88\u5143\u8fc7\u7a0b\n\tdouble div;\n\tfor(int i = 1; i <= n; ++i) {\n\t\tint m = i;\n\t\tfor(int j = i+1; j <= n; ++j)\n\t\t\tif(sgn(fabs(a[j][i])-fabs(a[m][i])) == 1)\n\t\t\t\tm = j;\n\t\tfor(int k = i; k <= n+1; ++k)\n\t\t\tstd::swap(a[m][k], a[i][k]);\n\t\tdiv = a[i][i];\n\t\tfor(int k = i; k <= n+1; ++k)\n\t\t\ta[i][k] /= div;\n\t\tfor(int j = 1; j <= n; ++j) {\n\t\t\tif(j != i) {\n\t\t\t\tdiv = a[j][i];\n\t\t\t\tfor(int k = i; k <= n+1; ++k)\n\t\t\t\t\ta[j][k] -= div*a[i][k];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main() {\n\tn = read(), m = read();\n\tfor(int i = 1; i <= m; ++i) {\n\t\tu = read(), v = read(), w = read();\n\t\tif(u == v) { // \u6ce8\u610f\u6709\u81ea\u73af\u7684\u60c5\u51b5\uff0c\u6b64\u65f6\u53ea\u80fd\u7edf\u8ba1\u4e00\u6b21\n\t\t\t++deg[u];\n\t\t\tadd(u, v, w);\n\t\t}\n\t\telse {\n\t\t\t++deg[u], ++deg[v];\n\t\t\tadd(u, v, w), add(v, u, w);\n\t\t}\n\t}\n\tfor(int k = 30; k >= 0; --k) { // \u5bf9\u4e8e\u6bcf\u4e00\u4f4d\u62c6\u5f00\u6765\u505a\n\t\tmemset(a, 0, sizeof(a));\n\t\tfor(int i = 1; i < n; ++i) {\n\t\t\ta[i][i] = -deg[i];\n\t\t\tfor(int p = head[i]; p; p = nxt[p]) {\n\t\t\t\tint v = ver[p], w = (edge[p]>>k)&1; // w\u4e3a\u8fb9\u6743\u57282\u8fdb\u5236\u4e0b\u7684\u7b2ck\u4f4d\n\t\t\t\tif(w) a[i][v] -= 1, a[i][n+1] -= 1;\n\t\t\t\telse a[i][v] += 1; \n\t\t\t}\n\t\t}\n\t\ta[n][n] = 1;\n\t\tgauss();\n\t\tans += (1<<k)*a[1][n+1]; // \u5408\u5e76\u7b54\u6848\n\t}\n\tprintf(\"%.3lf\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1553039463,
        "uid": 79017,
        "name": "\u82b1\u91cc\u5fc3\u7231",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3211 \u3010[HNOI2011]XOR\u548c\u8def\u5f84\u3011"
    },
    {
        "content": "[\u6d1b\u8c37\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3211)\n\n### Solution\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e2a\u9898\u548c\u6e38\u8d70\u5f88\u50cf\uff08\u867d\u7136\u6e38\u8d70\u662fHNOI2013\uff0c\u8fd9\u4e2a\u662fHNOI2011\u5427\uff09\n\n\u4f46\u662f\u8fd9\u4e2a\u9898\u662f\u8981\u6c42\u5f02\u6216\u548c\uff0c\u6bcf\u4e00\u4f4d\u662f\u4e92\u4e0d\u5e72\u6270\u7684\uff0c\u518d\u52a0\u4e0a\u671f\u671b\u7684\u7ebf\u6027\u6027\uff0c\u6240\u4ee5\u8003\u8651**\u6bcf\u4e00\u4f4d\u5355\u72ec\u8ba1\u7b97**\u3002\n\n\u6211\u4eec\u8bbe $f_i$ \u8868\u793a\u4ece $i$ \u5230 $n$ \u8def\u5f84\u8fd9\u4e00\u4f4d\u5f02\u6216\u548c\u4e3a $1$ \u7684\u6982\u7387\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5~~\u663e\u7136\u7684~~\u5f97\u5230\u8f6c\u79fb\u65b9\u7a0b\uff1a\n$$\nf_u=\\sum_{v\\in w_{u,v} \u6b64\u4f4d\u4e3a 0} \\frac {f_v}{d_u}+\\sum_{v\\in w_{u,v} \u6b64\u4f4d\u4e3a 1} \\frac {1-f_v}{d_u}\n$$\n\uff08\u5176\u4e2d $w_{u,v}$ \u8868\u793a $\\langle u,v\\rangle$ \u8fd9\u6761\u8fb9\u7684\u8fb9\u6743\uff0c $d_u$ \u8868\u793a $u$ \u7684\u5ea6\u6570\uff0c\u5373\u4e0e $u$ \u76f8\u8fde\u7684\u8fb9\u6570\uff0c\u5305\u62ec\u81ea\u73af\uff09\n\n\u524d\u9762\u7684 $\\sum$ \u8868\u793a\u8981\u5728 $v$ \u4e2d\u627e $0$ \u7684\u6982\u7387\uff0c\u540e\u9762\u7684\u8868\u793a\u8981\u5728 $v$ \u4e2d\u627e $1$ \u7684\u6982\u7387\u3002\n\n\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u65b9\u7a0b\u662f\u6709\u540e\u6548\u6027\u7684\uff0c\u6240\u4ee5\u8fd8\u8981\u7ee7\u7eed\u8003\u8651\u3002\u53d1\u73b0\u8fdb\u4e00\u6b65\u8f6c\u5316\u53ef\u4ee5\u5f97\u5230\uff1a\n$$\n-\\sum_{v\\in w_{u,v} \u6b64\u4f4d\u4e3a 1}\\frac 1{d_u}=-f_u+\\sum_{v\\in w_{u,v} \u6b64\u4f4d\u4e3a 0} \\frac {f_v}{d_u}-\\sum_{v\\in w_{u,v} \u6b64\u4f4d\u4e3a 1} \\frac {f_v}{d_u}\n$$\n\n\u54e6~\u8fd9\u957f\u5f97\u5f88\u50cf $n-1$ \u5143\u65b9\u7a0b\u554a\uff0c\u800c\u6211\u4eec\u603b\u5171\u6709 $n-1$ \u4e2a\u65b9\u7a0b\uff0c\u6240\u4ee5\u8003\u8651\u7528\u9ad8\u65af\u6d88\u5143\u6c42\u89e3\u3002\n\n\uff08 \u56e0\u4e3a\u5230\u8fbe $n$ \u7684\u65f6\u5019\u5c31\u505c\u6b62\u4e86\uff0c\u6240\u4ee5 $f_n=0$ \uff0c\u5728\u8ba1\u7b97\u7684\u65f6\u5019\u4e0d\u8003\u8651\uff09\n\n\u518d\u7b80\u5355\u7684\u63d0\u4e00\u4e0b\u8ba1\u7b97\u7b54\u6848\uff1a \u8bbe\u5f53\u524d\u4f4d\u4e3a $i$ \uff0c\u90a3\u5c31 $ans+=f_1\\times 2^i$ \u5373\u53ef\u3002\n\n\u6ce8\u610f\uff1a\u4e00\u4e2a\u81ea\u73af\u53ea\u80fd\u589e\u52a0\u4e00\u6761\u8fb9\uff0c\u91cd\u8fb9\u5728\u7d2f\u52a0\u65b9\u7a0b\u7cfb\u6570\u7684\u65f6\u5019\u90fd\u8981\u7b97\u4e0a\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^3\\log w)$ \n\n~~\u5b8c\u7ed3\u6492\u82b1~~\n\n---\n\n\u4f60\u4e0d\u4f1a\u4ee5\u4e3a\u8fd9\u5c31\u5b8c\u4e86\u5427(\u2299_\u2299)\n\n\u4e3a\u4ec0\u4e48\u662f\u4ece $u$ \u5230 $n$ \u9006\u63a8\u5462\uff1f\u6211\u76f8\u4fe1\u53ea\u6709\u6211\u4e00\u4e2a\u849f\u84bb\u611f\u5230\u7591\u60d1\uff0c\u4f46\u662f\u8fd8\u662f\u8981\u8bf4\u4e00\u4e0b\u3002\n\n\u56e0\u4e3a\u5f02\u6216\u548c\u4e0d\u4e3a $1$ \u7684\u6982\u7387\u662f $1-f_u$ \uff0c\u4f46\u662f\u6b63\u63a8\u6b64\u65f6\u7684\u542b\u4e49\u662f\uff1a $1$ \u5230 $u$ \u5f02\u6216\u548c\u4e0d\u4e3a $1$ \u7684\u6982\u7387\u548c**\u4ece $1$ \u65e0\u6cd5\u8d70\u5230 $u$ \u7684\u6982\u7387**\uff1b\u4f46\u662f\u9006\u63a8\u7684\u8bdd\uff0c $1-f_u$ \u5c31\u8fd8\u662f\u8d70\u5230 $n$ \u30fe(\u2267\u25bd\u2266*)o\n\n\u6b63\u5f0f\u5b8c\u7ed3\u6492\u53d1\u3002\n\n### Code\n\n```c++\n#include<bits/stdc++.h>\n#define re register\n\nusing namespace std;\nconst int N=110;\nconst double eps=1e-9;\nint n,m,head[N],cnt,d[N],pw[N];\ndouble a[N][N],f[N],ans;\nstruct edge{\n    int to,nxt,w;\n}e[N*N<<1];\n\ninline int read(){\n    int x=0,f=1;\n    char ch=getchar();\n    while(!isdigit(ch)){if(ch=='-') f=-1;ch=getchar();}\n    while(isdigit(ch)){x=x*10+(ch^48);ch=getchar();}\n    return x*f;\n}\n\ninline void add(int u,int v,int w){\n    e[++cnt].to=v;\n    e[cnt].w=w;\n    e[cnt].nxt=head[u];\n    head[u]=cnt;\n    d[v]++;\n}\n\ninline void Gauss(){\n    for(re int i=1;i<n;i++)\n        for(re int j=i+1;j<=n;j++){\n            double tmp=a[j][i]/a[i][i];\n            for(re int k=1;k<=n+1;k++) a[j][k]-=a[i][k]*tmp;\n        }\n    for(re int i=n;i;i--){\n        f[i]=a[i][n+1]/a[i][i];\n        for(re int j=i-1;j;j--) a[j][n+1]-=a[j][i]*f[i];\n    }\n}\n\nint main(){\n    n=read(); m=read();\n    memset(head,-1,sizeof(head));\n    pw[0]=1;\n    for(re int i=1;i<=30;i++) pw[i]=pw[i-1]*2;\n    for(re int i=1,u,v,w;i<=m;i++){\n        u=read(); v=read(); w=read();\n        add(u,v,w); if(u!=v) add(v,u,w);\n    }\n    for(re int i=0;i<=30;i++){\n        memset(a,0,sizeof(a)); a[n][n]-=1.0;\n        for(re int u=1;u<n;u++){\n            a[u][u]=-1;\n            for(re int j=head[u];j!=-1;j=e[j].nxt){\n                int v=e[j].to;\n                if(~e[j].w&pw[i]) a[u][v]+=1.0/d[u];\n                else a[u][n+1]-=1.0/d[u],a[u][v]-=1.0/d[u];\n            }\n        }\n        Gauss();\n        ans+=f[1]*pw[i];\n    }\n    printf(\"%.3lf\\n\",ans);\n    return 0;\n}\n```\n\n\u5c0f\u5f69\u86cb\uff1a\u9898\u76ee\u63cf\u8ff0\u4e2d\u7684\u7b2c\u4e00\u6bb5\u7684\u9898\u4e5f\u662f\u771f\u5b9e\u51fa\u73b0\u7684\uff0c\u5c31\u662f[\u4ecb\u4e2a](https://www.luogu.com.cn/problem/P4151)\u3002",
        "postTime": 1606476695,
        "uid": 272143,
        "name": "\u662f\u4e2a\u6c49\u5b50",
        "ccfLevel": 4,
        "title": "P3211 [HNOI2011]XOR\u548c\u8def\u5f84"
    },
    {
        "content": "# \u9898\u76ee\u5206\u6790\n\u5bb9\u6613\u53d1\u73b0\u5f02\u6216\u65f6\u4e0d\u540c\u7684\u4e8c\u8fdb\u5236\u4f4d\u4e0d\u4f1a\u4e92\u76f8\u5f71\u54cd\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5206\u522b\u8003\u8651\u6bcf\u4e00\u4e2a\u4e8c\u8fdb\u5236\u4f4d\u3002  \n\u5bf9\u4e8e\u5f53\u524d\u8003\u8651\u7684\u4e8c\u8fdb\u5236\u4f4d\uff0c\u663e\u7136\u6bcf\u6761\u8fb9\u53ea\u67090\u6216\u80051\u4e24\u79cd\u60c5\u51b5\u3002\u540c\u65f6\u5230\u8fbe\u6bcf\u4e2a\u70b9\u65f6\u5f53\u524d\u8def\u5f84\u7684\u5f02\u6216\u548c\u4e5f\u53ea\u67090\u62161\u4e24\u79cd\u60c5\u51b5\u3002\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u7528\u9ad8\u65af\u6d88\u5143\u8ba1\u7b97\u51fa\u7ecf\u8fc7\u7b2c $i$ \u4e2a\u70b9\u65f6\u5f53\u524d\u7684\u5f02\u6216\u548c\u662f0\u548c1\u7684\u671f\u671b\u6b21\u6570\u3002\u8ba1\u7b97\u51fa\u540e\u53ea\u9700\u7528 $n$ \u8282\u70b9\u7684\u5f02\u6216\u548c\u7684\u671f\u671b\u6b21\u6570\u4e58\u4ee5\u5f53\u524d\u4e8c\u8fdb\u5236\u4f4d\u7684\u5927\u5c0f\u5373\u53ef\u3002 \n\u4ee4 $f_{x,0}$ \u8868\u793a\u7ecf\u8fc7\u70b9 $x$ \u65f6\u5f02\u6216\u548c\u4e3a0\u7684\u671f\u671b\uff0c$f_{x,1}$ \u8868\u793a\u7ecf\u8fc7\u70b9 $x$ \u65f6\u5f02\u6216\u548c\u4e3a1\u7684\u671f\u671b\uff0c\u4ee4 $tot_x$ \u8868\u793a\u70b9 $x$ \u7684\u5165\u5ea6\uff0c$y$ \u8868\u793a\u5230 $x$ \u6709\u8fb9\u6743\u4e3a0\u7684\u70b9\uff0c$z$ \u8868\u793a\u5230 $x$ \u6709\u8fb9\u6743\u4e3a1\u7684\u70b9\u3002\u5219 \n$$f_{x,0}=\\sum\\limits_{y}f_{y,0}+\\sum\\limits_{z}f_{z,1}$$\n$$f_{x,1}=\\sum\\limits_{y}f_{y,1}+\\sum\\limits_{z}f_{z,0}$$\n\u7279\u522b\u7684\uff0c$f_{1,0}=\\sum\\limits_{y}f_{y,0}+\\sum\\limits_{1}f_{z,1}+1$\u3002\u56e0\u4e3a\u4e00\u5f00\u59cb\u5c31\u7ecf\u8fc7\u4e86\u8282\u70b91\u4e00\u6b21\u3002  \n\u540c\u65f6\u6ce8\u610f\u5230\u8fbe $n$ \u8282\u70b9\u65f6\u5c31\u4f1a\u505c\u6b62\uff0c\u81ea\u73af\u53ea\u80fd\u8ba1\u7b97\u4e00\u904d\u3002  \n\u7136\u540e\u53ea\u9700\u8981\u9ad8\u65af\u6d88\u5143\u5c31\u597d\u4e86\uff0c\u590d\u6742\u5ea6$O(N^3logw)$\u3002\n``` cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntemplate<class T>inline void read(T &x)\n{\n\tx=0;\n\tchar c=getchar();\n\twhile(!isdigit(c))c=getchar();\n\twhile(isdigit(c))x=x*10+(c&15),c=getchar();\n}\n#define N 105\n#define M 10001\nconst double eps=0.000000000001;\nint n,m,head[N],cnt,tot[N];\ndouble a[N<<1][N<<1],ans;\nstruct Edge//\u94fe\u5f0f\u524d\u5411\u661f\n{\n\tint a,b,c;\n}e[M<<1];\ninline void add(int a,int b,int c)\n{\n\te[++cnt].a=head[a],e[cnt].b=b,e[cnt].c=c,head[a]=cnt;\n}\nsigned main()\n{\n\tread(n),read(m);\n\tfor(register int i=1,x,y,z;i<=m;i++)//\u52a0\u8fb9\uff0c\u540c\u65f6\u65ad\u6389n\u8282\u70b9\u7684\u6240\u6709\u51fa\u8fb9\n\t{\n\t\tread(x),read(y),read(z);\n\t\tif(x>y)swap(x,y);\n\t\tif(x==n && y==n)continue;else if(y==n || x==y)add(x,y,z),++tot[x];else if(x!=y)add(x,y,z),add(y,x,z),++tot[x],++tot[y];\n\t}\n\tfor(register int xi=0,y=1;xi<=30;xi++,y<<=1)//2^30>1e9\n\t{\n\t\tmemset(a,0,sizeof(a));\n\t\tfor(register int x=1;x<=n;x++)//\u5217\u65b9\u7a0b\n\t\t{\n\t\t\ta[x][x]=a[x+n][x+n]=1;\n\t\t\tif(x==1)a[x][n<<1|1]=1;\n\t\t\tfor(register int i=head[x];i;i=e[i].a)\n\t\t\t{\n\t\t\t\tif(e[i].c&y)\n\t\t\t\t{\n\t\t\t\t\ta[e[i].b][x+n]-=1.0/tot[x];\n\t\t\t\t\ta[e[i].b+n][x]-=1.0/tot[x];\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ta[e[i].b][x]-=1.0/tot[x];\n\t\t\t\t\ta[e[i].b+n][x+n]-=1.0/tot[x];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(register int i=1;i<=n<<1;i++)//\u9ad8\u65af\u6d88\u5143\n\t\t{\n\t\t\tdouble x=a[i][i];\n\t\t\tfor(register int j=1;j<=(n<<1|1);j++)a[i][j]/=x;\n\t\t\tfor(register int j=1;j<=n<<1;j++)\n\t\t\t{\n\t\t\t\tif(fabs(a[j][i])<=eps || j==i)continue;\n\t\t\t\tx=a[j][i];\n\t\t\t\tfor(register int k=1;k<=(n<<1|1);k++)a[j][k]-=x*a[i][k];\n\t\t\t}\n\t\t}\n\t\tans+=a[n<<1][n<<1|1]*y;//\u7edf\u8ba1\u7b54\u6848\n\t}\n\tprintf(\"%0.3lf\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1595838010,
        "uid": 60075,
        "name": "pzc2004",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3211 \u3010[HNOI2011]XOR\u548c\u8def\u5f84\u3011"
    },
    {
        "content": "\u6211\u8fd8\u662ftcl\u505a\u4e0d\u52a8\u671f\u671b\u9898\u2026\u2026\n\n\u4e00\u822c\u6765\u8bf4\uff0c\u8fd9\u79cd\u8def\u5f84\u968f\u673a\u5e76\u4e14\u6570\u636e\u8303\u56f4\u8f83\u5c0f\uff08\u4e00\u822c\u4e3a\u51e0\u767e\uff09\u7684\u671f\u671b\u9898\uff0c\u9ad8\u65af\u6d88\u5143\u662f\u4e00\u4e2a\u975e\u5e38\u4e0d\u9519\u7684\u9009\u62e9\u3002\n\n\u5982\u679c\u8fd9\u9053\u9898\u7684\u8fb9\u7ec4\u6210\u4e86\u4e00\u5f20$DAG$\uff08\u6709\u5411\u65e0\u73af\u56fe\uff09\uff0c\u90a3\u5f88\u663e\u7136\uff0c\u6211\u4eec\u53ef\u4ee5\u5f88\u8f7b\u677e\u5730\u5217\u51fa$dp$\u65b9\u7a0b\u3002\u7136\u800c\uff0c\u8fd9\u9053\u9898\u4e0d\u4ec5\u662f\u65e0\u5411\u56fe\uff0c\u800c\u4e14\u8fd8\u6709\u81ea\u73af\u3001\u91cd\u8fb9\uff08\u7b2c\u4e00\u6b21\u56e0\u4e3a\u6ca1\u6709\u6ce8\u610f\u5230\u91cd\u8fb9\u7684\u5b58\u5728\u6302\u621010\u5206\uff09\u7b49\u6076\u5fc3\u4eba\u7684\u4e1c\u897f\uff0c\u6240\u4ee5\u6211\u4eec\u7684$dp$\u505a\u6cd5\u5c31$GG$\u5566\u3002\n\n\u4f46\u662f\u6211\u4eec\u53c8\u4e0d\u60f3\u653e\u5f03\u6211\u4eec\u7684$dp$\u505a\u6cd5\uff0c\u56e0\u4e3a\u5b83\u770b\u8d77\u6765\u662f\u6b63\u786e\u7684\u3002\u90a3\u600e\u4e48\u529e\u5462\uff1f\n\n\u6211\u4eec\u6bcf\u4e2a\u70b9\u90fd\u80fd\u5217\u51fa\u4e00\u4e2a$dp$\u65b9\u7a0b\uff0c\u90a3\u662f\u4e0d\u662f\u7ec4\u5728\u4e00\u8d77\u5c31\u662f\u4e00\u4e2a\u65b9\u7a0b\u7ec4\u4e86\u5462\uff1f\u663e\u7136\u662f\u53ef\u4ee5\u7684\u3002\n\n\u7531\u4e8e\u4f4d\u8fd0\u7b97\u6bd4\u8f83\u6076\u5fc3\uff0c\u6240\u4ee5\u6211\u4eec\u4e00\u822c\u4f1a\u9009\u62e9\u6309\u4f4d\u6765\u5904\u7406\u3002\u6211\u4eec\u63a5\u4e0b\u6765\u5047\u8bbe\u5df2\u7ecf\u7b97\u5230\u4e86\u7b2c$t$\u4f4d\u3002\n\n\u6211\u4eec\u4ee4$f[i]$\u8868\u793a\u8d70\u5230$i$\u8fd9\u4e2a\u70b9\uff0c\u7b2c$t$\u4f4d\u7684\u5f02\u6216\u503c\u4e3a$1$\u7684\u6982\u7387\u3002\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u7531\u4e8e$1$\u8fd9\u4e2a\u70b9\u4e0d\u597d\u5b9a\u521d\u59cb\u503c\uff0c\u56e0\u4e3a$1$\u53ef\u4ee5\u8d70\u5f88\u591a\u6b21\uff0c\u6837\u4f8b\u91cc\u751a\u81f3\u7ed9\u51fa\u4e86\u81ea\u73af\u8fd9\u79cd\u4e1c\u897f\uff0c\u6240\u4ee5\u8fd9\u6837\u8bbe\u72b6\u6001\u53ef\u80fd\u4f1a\u975e\u5e38\u96be\u505a\u3002\n\n\u6211\u4eec\u53d1\u73b0$n$\u53f7\u70b9\u8d70\u5230\u4e4b\u540e\u5c31\u4e0d\u80fd\u7ee7\u7eed\u8d70\u4e86\uff0c\u90a3\u6211\u4eec\u662f\u4e0d\u662f\u53ef\u4ee5\u8003\u8651\u4e00\u4e0b\uff0c\u5c06\u72b6\u6001\u6539\u4e3a$f[i]$\u8868\u793a\u4ece$i$\u70b9\u8d70\u5230$n$\u70b9\u7b2c$t$\u4f4d\u4e0a\u7684\u503c\u4e3a1\u7684\u6982\u7387\uff1f\n\n\u663e\u7136\u8fd9\u6837\u66f4\u52a0\u65b9\u4fbf\u3002\u56e0\u4e3a\u6211\u4eec\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u77e5\u9053$f[n]=0$\uff08\u4f60\u5728\u8fd9\u4e2a\u70b9\u5df2\u7ecf\u4e0d\u80fd\u52a8\u4e86\u6240\u4ee5\u8def\u5f84\u5f02\u6216\u548c\u4e3a$0$\uff09\u3002\u7531\u4e8e\u6982\u7387\u4e4b\u548c\u80af\u5b9a\u4e3a1\uff0c\u6240\u4ee5\u4ece$i$\u70b9\u8d70\u5230$n$\u70b9\u8fd9\u4e00\u4f4d\u4e0a\u7684\u5f02\u6216\u548c\u4e3a$0$\u7684\u6982\u7387\u4e3a$1-f[i]$\u3002\n\n\u7136\u540e\u6211\u4eec\u8003\u8651\u5176\u4ed6\u70b9\u7684\u65b9\u7a0b\u3002\n\n\u6211\u4eec\u8bbe$p$\u70b9\u4e0e$i$\u70b9\u76f8\u8fde\uff0c\u5e76\u4e14\u8981\u4ece$p$\u70b9\u8d70\u5230$i$\u70b9\uff0c$p->i$\u8fd9\u6761\u8fb9\u6743\u503c\u5728\u4e8c\u8fdb\u5236\u4e0b\u7684\u7b2c$t$\u4f4d\u4e3a$s$\uff0c\u7b2c$i$\u4e2a\u70b9\u7684\u5ea6\u6570\u4e3a$deg[i]$\u3002\n\n\u82e5$s=1$\uff0c\u90a3\u4e48\u8981\u4f7f$p$\u8d70\u5230$i$\u540e\u7b2c$t$\u4f4d\u4e3a1\uff0c\u90a3\u4e48\u8d70\u5230$p$\u70b9\u7684\u5f02\u6216\u548c\u5728\u7b2c$t$\u4f4d\u4e0a\u5fc5\u987b\u4e3a0\uff08\u56e0\u4e3a$1 xor 0=1$\uff09\u3002\u800c\u8d70\u5230$i$\u8fd9\u4e2a\u70b9\u662f\u4ece$p$\u8fd9\u4e2a\u70b9\u8d70\u8fc7\u6765\u7684\u6982\u7387\u53c8\u4e3a$\\frac{1}{deg[i]}$\uff0c\u6240\u4ee5$p$\u5bf9$i$\u7684\u8d21\u732e\u4e3a$\\frac{1-f[p]}{deg[i]}$\n\n\u82e5$s=0$\uff0c\u90a3\u4e48\u8981\u4f7f$p$\u8d70\u5230$i$\u540e\u7b2c$t$\u4f4d\u4e3a1\uff0c\u90a3\u4e48\u8d70\u5230$p$\u70b9\u7684\u5f02\u6216\u548c\u5728\u7b2c$t$\u4f4d\u4e0a\u5fc5\u987b\u4e3a1\uff08\u56e0\u4e3a$0 xor 1=1$\uff09\u3002\u800c\u8d70\u5230$i$\u8fd9\u4e2a\u70b9\u662f\u4ece$p$\u8fd9\u4e2a\u70b9\u8d70\u8fc7\u6765\u7684\u6982\u7387\u53c8\u4e3a$\\frac{1}{deg[i]}$\uff0c\u6240\u4ee5$p$\u5bf9$i$\u7684\u8d21\u732e\u4e3a$\\frac{f[p]}{deg[i]}$\n\n\u7efc\u4e0a\u6240\u8ff0\uff0c\n$f[i]=\\sum_{p,s(val[i->p])=1}\\frac{1-f[p]}{deg[i]}+\\sum_{p,s(val[i->p])=0}\\frac{f[p]}{deg[i]}(i<n)$\n\n\u6700\u540e\u7ed3\u679c\u5373\u4e3a$\\sum f[1]\u00d72^{t-1}$\n\n\u4ee5\u6837\u4f8b\u4e3a\u4f8b\u5427\u3002\n\n\u5148\u505a\u7b2c\u4e00\u4f4d\uff08\u4ece\u4f4e\u4f4d\u5230\u9ad8\u4f4d\uff09\u3002\u5bf9\u4e8e$1$\u53f7\u70b9\uff0c\u6709\u4e24\u4e2a\u70b9$1,2$\u4e0e\u5b83\u76f8\u8fde\u3002$1$\u53f7\u70b9\u548c$1$\u53f7\u70b9\u7684\u8fb9\u6743\u4e3a$2$\uff0c\u7b2c$1$\u4f4d\u4e3a0\uff0c$2$\u53f7\u70b9\u548c$1$\u53f7\u70b9\u7684\u8fb9\u6743\u4e3a3\uff0c\u7b2c$1$\u4f4d\u4e3a1\u3002\u6240\u4ee5\u53ef\u4ee5\u5217\u51fa\u65b9\u7a0b\n\n$f[1]=\\frac{1}{2}f[1]+\\frac{1}{2}(1-f[2])$\n\n$f[2]=0$\n\n\u89e3\u5f97$f[1]=1,f[2]=0$\u3002\u6240\u4ee5\u7b2c$1$\u4f4d\u7684\u8d21\u732e\u4e3a$1\u00d72^{0}=1$\u3002\n\n\u540c\u7406\uff0c\u7b2c\u4e8c\u4f4d\u7684\u4e24\u4e2a\u65b9\u7a0b\u662f\n\n$f[1]=\\frac{1}{2}(1-f[1])+\\frac{1}{2}(1-f[2])$\n\n$f[2]=0$\n\n\u89e3\u5f97$f[1]=\\frac{2}{3},f[2]=0$\n\u3002\u6240\u4ee5\u7b2c$2$\u4f4d\u7684\u8d21\u732e\u4e3a$\\frac{2}{3}\u00d72^1=\\frac{4}{3}$\u3002\n\n\u4e24\u8005\u76f8\u52a0\u5373\u4e3a\u7b54\u6848\uff0c$1+\\frac{4}{3}=\\frac{7}{3}$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=102;\n#define db double\n\nint n,m,deg[N],first[N],f[N][N],w;\ndb a[N][N],ans;\n\nstruct ed\n{\n\tint to,nxt,dis;\n} edge[N*N*2];\n\nvoid read(int &x,int &y) {scanf(\"%d %d\",&x,&y);}\nvoid read(int &x,int &y,int &z) {scanf(\"%d %d %d\",&x,&y,&z);}\n\nvoid add(int x,int y,int z)\n{\n\tedge[++w].to=y,edge[w].nxt=first[x],edge[w].dis=z,first[x]=w;\n}\n\nint getw(int x,int i)\n{\n\treturn (x&(1<<(i-1)))>>(i-1);\n}\n\nvoid Gauss(int t)\n{\n\tfor (int i=1;i<=n;i++)\n\t\tfor (int j=1;j<=n+1;j++)\n\t\t\ta[i][j]=0;\n\tfor (int i=1;i<n;i++)\n\t{\n\t\ta[i][i]=1;\n\t\tfor (int j=first[i];j;j=edge[j].nxt)\n\t\t{\n\t\t\tint v=edge[j].to;\n\t\t\tif (getw(edge[j].dis,t)==1) a[i][v]+=(db)1/deg[i],a[i][n+1]+=(db)1/deg[i];\n\t\t\t\telse a[i][v]-=(db)1/deg[i];\n\t\t}\n\t}\n\ta[n][n]=1;\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tint p=i;\n\t\twhile (!a[p][i]) ++p;\n\t\tfor (int j=1;j<=n+1;j++) swap(a[i][j],a[p][j]);\n\t\tfor (int j=1;j<=n;j++)\n\t\t\tif (j!=i)\n\t\t\t{\n\t\t\t\tdb r=a[j][i]/a[i][i];\n\t\t\t\tfor (int k=1;k<=n+1;k++) a[j][k]-=a[i][k]*r;\n\t\t\t}\n\t}\n\tans+=a[1][n+1]/a[1][1]*(1<<(t-1));\n}\n\nint main()\n{\n\tread(n,m);\n\tfor (int i=1;i<=m;i++)\n\t{\n\t\tint u,v,w;read(u,v,w);add(u,v,w);deg[u]++;\n\t\tif (u!=v) deg[v]++,add(v,u,w);\n\t}\n\tfor (int i=1;i<=31;i++) Gauss(i);\n\tprintf(\"%.3lf\",ans);\n}\n```\n\n\u8fd8\u662f\u8981\u6ce8\u610f\u91cd\u8fb9\uff01\uff01\uff01\u4e0d\u8981\u7528\u90bb\u63a5\u77e9\u9635\uff01\uff01\uff01",
        "postTime": 1557106507,
        "uid": 29575,
        "name": "Holy_Push",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3211 \u3010[HNOI2011]XOR\u548c\u8def\u5f84\u3011"
    },
    {
        "content": "\u5728\u6b64\u4e4b\u524d\uff0c\u5efa\u8bae\u5148\u5b8c\u6210[\u672c\u9898](https://www.luogu.com.cn/problem/P3232)\uff0c\u89e3\u51b3\u65b9\u5f0f\u662f\u7c7b\u4f3c\u7684\u3002\n### \uff081\uff09\u8f6c\u79fb\u65b9\u7a0b\n\u6211\u4eec\u8bbe\u7f6e $f_u$ \u8868\u793a\u8282\u70b9 $u$ \u5230 $n$ \u8def\u5f84\u5f02\u6216\u548c\u7684\u671f\u671b\uff0c\u53d1\u73b0\u8fd9\u662f\u7531\u4e0e $u$ \u76f8\u8fde\u7684\u8282\u70b9\u8f6c\u79fb\u800c\u6765\u7684\uff0c\u4e8e\u662f\u5c31\u6709\uff1a\n$$f_u=\\frac{1}{deg_u}\\sum_{(u,v)\\in E}(f_v \\operatorname{xor} w)$$\n\n\u7136\u800c\u6211\u4eec\u9762\u4e34\u4e24\u4e2a\u95ee\u9898\u3002\n\n\u9996\u5148\uff0c\u8fd9\u4e2a\u65b9\u7a0b\u5e76\u975e\u5728 $\\operatorname{DAG}$ \u4e0a\uff0c\u4e0d\u80fd\u9760\u62d3\u6251\u6392\u5e8f\u7b49\u65b9\u5f0f\u76f4\u63a5\u8f6c\u79fb\u3002\u5176\u6b21\uff0c\u82e5\u4f7f\u7528\u4e0a\u9762\u4f8b\u9898\u201c\u6e38\u8d70\u201d\u7684\u9ad8\u65af\u6d88\u5143\uff0c\u8fd9\u4e2a $\\operatorname{xor}$ \u8fd0\u7b97\u4e5f\u662f\u4e0d\u53ef\u505a\u7684\u3002\n\n### \uff082\uff09\u6c42\u89e3\n\u7136\u800c\u4f60\u53d1\u73b0\uff0c\u671f\u671b\u662f\u7ebf\u6027\u7684\uff0c\u56e0\u6b64\u6bcf\u4e00\u4f4d\u4e0a\u7684\u8d21\u732e\u4e4b\u548c\uff08\u6309\u4f4d\u8fdb\u5236\u8f6c\u6362\u540e\uff09\u5c31\u662f\u6211\u4eec\u7684\u7b54\u6848\uff0c\u56e0\u6b64\u8003\u8651\u628a\u6bcf\u4e2a\u6743\u503c\u62c6\u5f00\u3002\u53d1\u73b0\u6bcf\u4e00\u4f4d\u8d21\u732e\u53ea\u53ef\u80fd\u662f $0/1$\uff0c\u7136\u540e\u4eff\u7167\u4e0a\u5f0f\u5c31\u5f97\u5230\uff1a\n$$f_u=\\frac{1}{deg_u}\\left(\\sum_{w(u,v)=0} f_v+\\sum_{w(u,v)=1} (1-f_v)\\right)$$\n\n\u7136\u540e\u628a\u5f0f\u5b50\u518d\u62c6\u4e00\u62c6\uff0c\u5c31\u80fd\u5f97\u5230\uff1a\n$$f_u\\times deg_u-\\sum_{w(u,v)=0} f_v+\\sum_{w(u,v)=1}f_v=\\sum_{w(u,v)=0}1$$\n\n\u663e\u7136\u5957\u5230\u9ad8\u65af\u6d88\u5143\u91cc\u5c31\u80fd\u6c42\u89e3\u4e86\u3002\n\n```cpp\ninline void G(int n){\n\tfor(int i=1;i<=n;i++){\n\t\tint pos=i;\n\t\tfor(int j=i+1;j<=n;j++){\n\t\t\tif(fabs(a[j][i])-fabs(a[pos][i])>eps)\n\t\t\t\tpos=j;\n\t\t}\n\t\tif(pos!=i) swap(a[i],a[pos]);\n\t\tdb q=a[i][i];\n\t\tfor(int j=i;j<=n+1;j++){\n\t\t\ta[i][j]/=q;\n\t\t}\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tif(i!=j){\n\t\t\t\tq=a[j][i];\n\t\t\t\tfor(int k=i;k<=n+1;k++){\n\t\t\t\t\ta[j][k]-=q*a[i][k];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\ndb ans;\nint main(){\n\tn=read(),m=read();\n\tfor(int i=1;i<=m;i++){\n\t\tint u=read(),v=read(),w=read();\n\t\tadd_edge(u,v,w); deg[u]++;\n\t\tif(u!=v){\n\t\t\tadd_edge(v,u,w); deg[v]++;\n\t\t}\n\t}\n\tfor(int k=30;k>=0;k--){\n\t\tmemset(a,0,sizeof(a));\n\t\tfor(int u=1;u<n;u++){\n\t\t\ta[u][u]=-deg[u];\n\t\t\tfor(int i=head[u];i;i=e[i].nxt){\n\t\t\t\tint v=e[i].to,w=(e[i].w>>k)&1;\n\t\t\t\tif(w){\n\t\t\t\t\ta[u][v]-=1.0; a[u][n+1]-=1.0;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\ta[u][v]+=1.0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\ta[n][n]=1.0;\n\t\tG(n);\n\t\tans+=(1<<k)*a[1][n+1];\n\t}\n\tprintf(\"%.3lf\\n\",ans);\n}\n```",
        "postTime": 1644287429,
        "uid": 321177,
        "name": "SoyTony",
        "ccfLevel": 6,
        "title": "\u9898\u89e3\u2014\u2014P3211 [HNOI2011]XOR\u548c\u8def\u5f84"
    },
    {
        "content": "$\\text{xor}$ \u8fd0\u7b97\u663e\u7136\u4e0d\u540c\u4e8e\u5176\u4ed6\u8fd0\u7b97\uff0c\u6211\u4eec\u5fc5\u987b\u77e5\u9053\u51c6\u786e\u7684\u6574\u6570\u624d\u80fd\u591f\u6c42\u8fd9\u7c7b\u671f\u671b\u95ee\u9898\u3002\u6240\u4ee5\u76f4\u63a5\u8bbe $f_i$ \u4e3a $i\\to n$ \u7684\u671f\u671b $\\mathrm{xor}$ \u503c\u662f\u65e0\u6cd5\u505a\u7684\u3002\n\n\u5bf9\u4e8e\u8fd9\u4e00\u7c7b\u4e0e\u4f4d\u8fd0\u7b97\u76f8\u5173\u7684\u95ee\u9898\uff0c\u65e2\u7136\u4e0d\u80fd\u76f4\u63a5\u505a\uff0c\u90a3\u5c31\u5c1d\u8bd5\u62c6\u4f4d\u505a\uff0c\u8fd9\u4e2a\u505a\u6cd5\u6b63\u786e\u6027\u57fa\u4e8e\u7b54\u6848\u7684\u6bcf\u4e00\u4f4d\u4e4b\u95f4\u662f\u72ec\u7acb\u7684\uff0c\u5e76\u4e14\u5bf9\u4e8e\u7b2c $i$ \u4f4d\uff0c\u5b83\u7684\u53d6\u503c\u53ea\u80fd\u662f $0/1$\u3002\n\n\u5982\u679c\u6211\u4eec\u80fd\u6c42\u51fa\u4efb\u610f\u7b2c $X$ \u4f4d\u4e0a\u7684\u671f\u671b\u503c $E[X]$\uff0c\u90a3\u4e48\u5c31\u80fd\u591f\u5f97\u5230\u6700\u7ec8\u7684\u671f\u671b\u662f $\\sum\\limits_{x}E[X]\\times 2^X$\u3002\u7531\u4e8e\u6bcf\u4e00\u4f4d\u4e0a\u7684\u53d6\u503c\u53ea\u80fd\u662f $0/1$\uff0c\u6839\u636e\u671f\u671b\u5b9a\u4e49\u5f0f\uff0c\u4e8c\u8fdb\u5236\u610f\u4e49\u4e0b\u7b2c $X$ \u4f4d\u7684\u671f\u671b\u503c\u5c31\u4e3a\u7b2c $X$ \u4f4d\u4e3a $1$ \u7684\u6982\u7387\u3002\n\n\u8bbe $f_i$ \u4e3a\u4ece $i\\to n$ \u7b2c $X$ \u4f4d\u4e0a\u7684\u503c\u4e3a $1$ \u7684\u6982\u7387\uff0c\u4e8e\u662f\u6709\uff1a\n\n$$\nf_i=\\frac{1}{du_i}\\left(\\sum_{w(i,j)=0}f_j+\\sum_{w(i,j)=1} 1-f_j\\right)\n$$\n\n\u5176\u4e2d $w(i,j)$ \u4e3a $w(i,j)$ \u8fd9\u6761\u8fb9\u5728\u4e8c\u8fdb\u5236\u610f\u4e49\u4e0b\u7684 $X$ \u4f4d\u7684\u503c\u3002\n\n\u6839\u636e\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4f4d\u76f4\u63a5\u9ad8\u65af\u6d88\u5143\u6c42\u89e3\u5373\u53ef\u3002\u6ce8\u610f\u81ea\u73af\u53ea\u80fd\u52a0\u4e00\u6b21\u8fb9\uff0c\u5e76\u4e14\u8981\u5904\u7406\u91cd\u8fb9\u7684\u60c5\u51b5\u3002\u6c42\u5f97 $f_1$ \u540e\uff0c\u6839\u636e\u4e0a\u8ff0\u5206\u6790\u7edf\u8ba1\u7b54\u6848\u3002\n\n\u4e3a\u4ec0\u4e48\u4e0d\u5b9a\u4e49 $f_i$ \u4e3a $1\\to i$ \u7684\u72b6\u6001\u5462\uff1f~~\u5199\u4e00\u5199\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4f60\u5c31\u77e5\u9053\u4e86\uff08\u96fe~~\u3002\u5176\u5b9e\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u4e0d\u8fc7\u5bf9\u4e8e\u8fb9\u754c\u548c\u521d\u503c\u7684\u60c5\u51b5\u8981\u6709\u66f4\u614e\u91cd\u7684\u5904\u7406\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^3 \\log V)$\uff0c\u5176\u4e2d $V$ \u4e3a\u8fb9\u6743\u6700\u5927\u503c\u3002\uff08~~\u4f46\u662f $\\text{tommy}$ \u592a\u61d2\u4e86\uff0c\u4ee3\u7801\u91cc\u6ca1\u6709\u6c42 $V$ \u800c\u662f\u76f4\u63a5\u5c06 $V=10^9$~~\n\n```cpp\n#include<cstdio>\nint cnt=0;\nint h[105],du[105],to[20005],ver[20005],w[20005];\ndouble a[105][105];\ninline int read() {\n    register int x=0,f=1;register char s=getchar();\n    while(s>'9'||s<'0') {if(s=='-') f=-1;s=getchar();}\n    while(s>='0'&&s<='9') {x=x*10+s-'0';s=getchar();}\n    return x*f;\n}\ninline void swap(double &x,double &y) {double tmp=x;x=y;y=tmp;}\ninline void add(int x,int y,int z) {++du[x]; to[++cnt]=y; ver[cnt]=h[x]; w[cnt]=z; h[x]=cnt;}\ninline void BuildMatrix(int n,int bit) {\n    for(register int x=1;x<=n;++x) for(register int y=1;y<=n+1;++y) a[x][y]=0.00;\n    a[n][n]=1;//very important\n    for(register int x=1;x<n;++x) {\n        a[x][x]=du[x];\n        for(register int i=h[x];i;i=ver[i]) {\n            if(w[i]>>bit&1) ++a[x][to[i]],++a[x][n+1];\n            else --a[x][to[i]];\n        }\n    }\n}\ninline void Guass(int n) {\n    for(register int i=1;i<=n;++i) {\n        int tmp=0;\n        for(register int j=i;j<=n;++j) if(a[j][i]) {tmp=j;break;}\n        if(!tmp) continue;\n        for(register int j=1;j<=n+1;++j) swap(a[i][j],a[tmp][j]);\n        for(register int j=1;j<=n;++j) {\n            if(j==i) continue;\n            double t=a[j][i]/a[i][i];\n            for(register int k=i;k<=n+1;++k) a[j][k]-=t*a[i][k];\n        }\n    }\n}\nint main() {\n    int n=read(),m=read();\n    double ans=0.00;\n    for(register int i=1;i<=m;++i) {\n        int u=read(),v=read(),w=read();\n        add(u,v,w); if(u^v) add(v,u,w);\n    }\n    for(register int i=0;i<=30;++i) {BuildMatrix(n,i); Guass(n); ans+=(a[1][n+1]*(1<<i)/a[1][1]);}\n    printf(\"%.3lf\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1603951412,
        "uid": 95244,
        "name": "tommymio",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3211 \u3010[HNOI2011]XOR\u548c\u8def\u5f84\u3011"
    },
    {
        "content": "###\u770b\u89c1\u6ca1\u4eba\u6c34\u9898\u89e3\uff0c\u6211\u5c31\u6765\u6c34\u4e00\u7bc7\uff08\u624b\u52a8\u6ed1\u7a3d\uff09\n\n\u6211\u7684[blog](http://blog.csdn.net/stone41123/article/details/78027949)\n\n\u9898\u89e3\uff1a\n\n\u9996\u5148\uff0c\u5f02\u6216\u7684\u8bdd\u76f4\u63a5\u8ba8\u8bba\u4e0d\u597d\u8ba8\u8bba\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u6309\u4f4d\u8ba8\u8bba\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4f4d\u8ba8\u8bba\u51fa\u6765\u4e00\u4e2a\u7ed3\u679c\uff0c\u7136\u540e\u5c06\u7ed3\u679c\u76f8\u52a0\u5c31\u597d\u4e86\u3002\n\n\u7136\u540e\u8003\u8651\u600e\u4e48\u8ba8\u8bba\u4e00\u4f4d\u4e0a\u7684\u7ed3\u679c\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u8bbe\u51fa\u6765\u4e00\u4e2adp\u65b9\u7a0b\uff1af(i)\u8868\u793ai\u5230n\u7684\u5f02\u6216\u548c\u671f\u671b\u503c\uff0c\u5219\u521d\u59cb\u72b6\u6001\u4e3af(n)=0\n\ndp\u8f6c\u79fb\u65b9\u7a0b\u5c31\u662f\uff1a\u5176\u4e2dweight(u,v)\u4ee3\u8868(u,v)\u7684\u90a3\u4e00\u4f4d\u7684\u503c\n\nf(v)=\u2211(u,v)\u2208Ef(u)/degree(v) weight(u,v)=0 \n\nf(v)=\u2211(u,v)\u2208E(1\u2212f(u))/degree(v) weight(u,v)=1 \n\n\u5219\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\uff49\uff0c\u90fd\u4f1a\u6709\u4e00\u4e2a\u7ebf\u6027\u65b9\u7a0b\uff1a\n\nf[i]=f[j1]/degree[i]+(1\u2212f[j2])/degree[i]+...... \n\n\u7136\u540e\u9884\u5904\u7406\u51fa\u77e9\u9635\u6765\uff0c\u9ad8\u65af\u6d88\u5143\u5373\u53ef\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\n#include<cstring>\n#define ll long long\nusing namespace std;\ninline int read(){\n    int x=0;char ch=' ';int f=1;\n    while(ch<'0'||ch>'9')ch=getchar();\n    if(ch=='-'){\n        f=-1;ch=getchar();\n    }\n    while(ch>='0'&&ch<='9')x=x*10+ch-'0',ch=getchar();\n    return x*f;\n}\nstruct edge{\n    int to,next,w;\n}e[20001];\nint n,m,tot;\nint head[101];\nint in[101];\ndouble a[101][101];\nvoid gauss(){\n    for(int i=1;i<=n;i++){\n        int mx=i;\n        while(!a[mx][i])mx++;\n        if(i!=mx)swap(a[i],a[mx]);\n        double mul=a[i][i];\n        for(int j=i;j<=n+1;j++)a[i][j]/=mul;\n        for(int k=1;k<=n;k++){\n            if(k!=i&&a[k][i]){\n                mul=a[k][i];\n                for(int j=i;j<=n+1;j++){\n                    a[k][j]-=mul*a[i][j];\n                }\n            }\n        }\n    }\n}\ninline void addedge(int x,int y,int l){\n    e[++tot].to=y;e[tot].next=head[x];e[tot].w=l;head[x]=tot;in[y]++;\n}\nint main(){\n    n=read();m=read();\n    for(int i=1;i<=m;i++){\n        int x=read(),y=read(),l=read();\n        if(x!=y)addedge(x,y,l),addedge(y,x,l);\n        else addedge(x,y,l);\n    }\n    double ans=0;\n    for(int k=0;k<=30;k++){\n        memset(a,0,sizeof(a));\n        for(int x=1;x<n;x++){\n            a[x][x]=1.0;\n            for(int i=head[x];i;i=e[i].next){\n                int u=e[i].to;\n                if((e[i].w>>k)&1){\n                    a[x][u]+=1.0/in[x];a[x][n+1]+=1.0/in[x];\n                }\n                else{\n                    a[x][u]-=1.0/in[x];\n                }\n            }\n        }\n        a[n][n]=1.0;\n        gauss();\n        ans+=a[1][n+1]*1.0*(1<<k);\n    }\n    printf(\"%.3lf\",ans);\n    return 0;\n}\n```",
        "postTime": 1505791300,
        "uid": 39505,
        "name": "\u73ab\u8475\u4e4b\u8776",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3211 \u3010[HNOI2011]XOR\u548c\u8def\u5f84\u3011"
    },
    {
        "content": "\u5f88\u660e\u663e\u671f\u671b dp\u3002\n\n\u5f00\u59cb\u65f6\u60f3\u5230\u8bbe $f_i$ \u4e3a $i$ \u5230 $n$ \u7684\u671f\u671b\u503c\u3002\n\n\u4f46\u7531\u4e8e\u8fd9\u9898\u662f\u5f02\u6216\uff0c\u6240\u4ee5\u8981\u62c6\u5206\u6210 $2$ \u8fdb\u5236\uff0c\u5206\u6210\u6bcf\u4e00\u4f4d\u7684\u5b50\u4efb\u52a1\u89e3\u51b3\u3002\n\n\u90a3\u4e48\u6539\u53d8\u5b9a\u4e49\uff0c\u8bbe $f_i$ \u4e3a\u70b9 $i$ \u5230 $n$ \u7b2c $x$ \u4f4d\u4e3a $1$ \u7684\u671f\u671b\u503c\uff0c$r_i$ \u4ee3\u8868 $i$ \u53f7\u70b9\u7684\u51fa\u5ea6\u3002\u5bf9\u4e8e\u6bcf\u4e00\u6761\u8fb9 $(i,j)$ \u90a3\u4e48\uff1a\n\n$$f_i=\\frac{1}{r_i}(\\sum_{(i,j)=0}f_j+\\sum_{(i,j)=1}(1-f_j))$$\n\n$$r_if_i-\\sum_{(i,j)=0}f_v+\\sum_{(i,j)=1}f_v=\\sum_{(i,j)=1}1$$\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u628a $f_i$ \u770b\u6210\u672a\u77e5\u6570\uff0c\u5148\u5efa\u65b9\u7a0b\uff0c\u518d\u89e3\u65b9\u7a0b\u5373\u53ef\u3002\n\n\u4f46\u662f $n$ \u4e2a\u672a\u77e5\u6570\uff0c$n-1$ \u4e2a\u65b9\u7a0b\uff0c\u6240\u4ee5\u8fd8\u6709\u4e00\u4e2a\u521d\u59cb\u65b9\u7a0b $f_n=0$\u3002\n\n\u5f88\u597d\u7406\u89e3\uff0c\u56e0\u4e3a\u5230\u4e86\u70b9 $n$ \u4ee5\u540e\u65e0\u6cd5\u518d\u79fb\u52a8\uff0c\u6240\u4ee5\u70b9 $n$ \u5230 $n$ \u671f\u671b\u503c\u8d4b\u4e3a $0$\u3002\n\n\u7b54\u6848\u5c31\u662f\u8d77\u59cb\u70b9 $1$ \u7684\u671f\u671b\u503c\u4e58\u4e0a\u5bf9\u5e94\u7684\u4f4d\u6570\uff0c\u5373 $\\sum f_1\\times 2^{x-1}$\u3002\n\n\u590d\u6742\u5ea6\uff1a$O(n^3)$\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<vector>\n#include<cstring>\n#define int long long\nusing namespace std;\nconst int N=105;\nint n,m,cnt,r[N];\ndouble ans[N],t[N][N];\nstruct node\n{\n\tint to,data;\n};\nvector<node>a[N];\ninline int tabs(int x)\n{\n\treturn x>0?x:-x;\n}\nvoid build(int x)\n{\n\tmemset(t,0,sizeof(t));\n\tt[n][n]=1;\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tt[i][i]=r[i];\n\t\tint len=a[i].size();\n\t\tfor(int j=0;j<len;j++)\n\t\t{\n\t\t\tif(a[i][j].data&x)t[i][a[i][j].to]++,t[i][n+1]++;\n\t\t\telse t[i][a[i][j].to]--;\n\t\t}\n\t}\n}\nvoid xiao()\n{\n\tans[1]=0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint ma=i;\n\t\tfor(int j=i+1;j<=n;j++)if(tabs(t[j][i])>tabs(t[ma][i]))ma=i;\n\t\tfor(int j=1;j<=n+1;j++)swap(t[i][j],t[ma][j]);\n\t\tif(!t[i][i])return;\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tif(j==i)continue;\n\t\t\tdouble num=t[j][i]/t[i][i];\n\t\t\tfor(int k=1;k<=n+1;k++)t[j][k]-=t[i][k]*num;\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)ans[i]=t[i][n+1]/t[i][i];\n}\nsigned main()\n{\n\t//freopen(\"xor.in\",\"r\",stdin);\n\t//freopen(\"xor.out\",\"w\",stdout);\n\tscanf(\"%lld%lld\",&n,&m);\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint u,v,w;\n\t\tscanf(\"%lld%lld%lld\",&u,&v,&w);\n\t\ta[u].push_back((node){v,w}),r[u]++;\n\t\tif(u!=v)a[v].push_back((node){u,w}),r[v]++;\n\t}\n\tdouble res=0;\n\tfor(int i=1;i<=1e9;i<<=1)\n\t{\n\t\tbuild(i);\n\t\txiao();\n\t\tres+=i*ans[1];\n\t}\n\tprintf(\"%.3f\",res);\n\treturn 0;\n}\n```",
        "postTime": 1663934007,
        "uid": 275793,
        "name": "Gmt\u4e36FFF",
        "ccfLevel": 5,
        "title": "P3211 [HNOI2011]XOR\u548c\u8def\u5f84"
    },
    {
        "content": "\u6211\u8da3\uff0c\u597d\u6bd2\u7624\n\n\u7531\u671f\u671b\u5b9a\u4e49\uff0c\u53ef\u4ee5\u62c6\u8d21\u732e .\n\nxor \u53ef\u4ee5\u6309\u4f4d\u8003\u8651\uff0c\u4e8e\u662f\u6211\u4eec\u5bf9\u6bcf\u4f4d\u505a\u5904\u7406 .\n\n\u4ee4 $dp_u$ \u8868\u793a\u4ece $u$ \u5230 $n$ \u8def\u5f84 xor \u548c\u4e3a $1$ \u7684\u6982\u7387\uff0c\u4e8e\u662f\n$$dp_u=\\dfrac1{\\deg u}\\left(\\sum_{val(u,v)=0}(1-dp_v)+\\sum_{val(u,v)=1}dp_v\\right)$$\n\u7531\u4e8e\u53ef\u80fd\u6709\u540e\u6548\u6027\uff0c\u4e8e\u662f\u8003\u8651 Gauss \u6d88\u5143 .\n\n\u505a\u5b8c\u4e86\uff0c\u6ce8\u610f\u91cd\u8fb9\u81ea\u73af\u7684\u5f71\u54cd .\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(wn^3)$\uff0c\u5176\u4e2d $w$ \u662f\u8fb9\u6743\u7684\u4f4d\u6570 .\n\nCode:\n```cpp\nusing namespace std;\nconst int N = 333;\nconst double eps = 1e-9;\nint n, m, deg[N];\ndouble a[N][N];\nvector<pair<int, int> > g[N];\ninline void addedge(int u, int v, int w){g[u].emplace_back(make_pair(v, w)); ++deg[v];}\ninline void ade(int u, int v, int w){addedge(u, v, w); addedge(v, u, w);}\nvoid create(int _)\n{\n\ta[n][n] = 1;\n\tfor (int u=1; u<n; u++)\n\t{\n\t\t\n\t\ta[u][u] = deg[u];\n\t\tfor (auto e : g[u])\n\t\t{\n\t\t\tint v = e.first, w = e.second;\n\t\t\tif (w & (1 << _)){++a[u][v]; ++a[u][n+1];}\n\t\t\telse --a[u][v]; // \u91cd\u8fb9\u81ea\u73af \n\t\t}\n\t}\n}\ninline bool z(const double& x){return abs(x)<eps;}\nint Gauss() // O(n^3)\n{\n\tint c, r;\n\tfor (c=1, r=1; c<=n; c++)\n\t{\n\t\tint m = r;\n\t\tfor (int i=r; i<=n; i++)\n\t\t\tif (abs(a[i][c]) > abs(a[m][c])) m = i;\n\t\tif (z(a[m][c])) continue;\n\t\tfor (int i=c; i<=n+1; i++) swap(a[m][i],a[r][i]);\n\t\tfor (int i=n+1; i>=c; i--) a[r][i] /= a[r][c];\n\t\tfor (int i=r+1; i<=n; i++)\n\t\t\tif (!z(a[i][c]))\n\t\t\t\tfor (int j=n+1; j>=c; j--) a[i][j] -= a[r][j] * a[i][c];\n\t\tr++;\n\t}\n\tfor (int i=n; i>=0; i--) //\u56de\u4ee3\n\t\tfor (int j=i+1; j<=n; j++) a[i][n+1] -= a[i][j] * a[j][n+1];\n\tif (r <= n)\n\t{\n\t\tfor (int i=r; i<=n; i++)\n\t\t\tif (!z(a[i][n+1])) return -1;\n\t\treturn 0;\n\t} return 1;\n}\nint main()\n{\n\tscanf(\"%d%d\", &n, &m);\n\tfor (int i=0, u, v, w; i<m; i++)\n\t{\n\t\tscanf(\"%d%d%d\", &u, &v, &w); addedge(u, v, w);\n\t\tif (u != v) addedge(v, u, w);\n\t}\n\tdouble ans = 0;\n\tfor (int i=0; i<32; i++)\n\t{\n\t\tmemset(a, 0, sizeof a);\n\t\tcreate(i); Gauss();\n\t\tans += pow(2, i) * a[1][n+1];\n\t}\n\tprintf(\"%.3f\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1642682132,
        "uid": 227514,
        "name": "jijidawang",
        "ccfLevel": 0,
        "title": "P3211 \u9898\u89e3"
    },
    {
        "content": "\u8fd9\u9898\u662f\u6982\u7387\u9898\n\n\u5bf9\u4e8e\u8fd9\u9053\u9898\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u6309\u4f4d\u5904\u7406\n\n\u56e0\u4e3a\u6bcf\u4e00\u4f4d\u90fd\u4e92\u4e0d\u5f71\u54cd\n\n\u6211\u4eec\u679a\u4e3e\u6bcf\u4e00\u4f4d\n\n\u7528 $f_{i}$ \u8868\u793a\u70b9i\u5728\u8fd9\u4e00\u4f4d\u662f $1$ \u7684\u6982\u7387\n\n\u663e\u7136\u70b9i\u5728\u8fd9\u4e00\u4f4d\u662f0\u7684\u6982\u7387\u5c31\u662f $1-f_{i}$\n\n$d_{i}$ \u8868\u793a\u70b9 $i$ \u7684\u5ea6\n\n\u5982\u679c $v \\sim u$ \u7684\u8fd9\u6761\u8fb9\u5728\u8fd9\u4e00\u4f4d\u662f $1$\n\n\u90a3\u5c31\u8981\u7528 $(1-f_{v})$ (\u70b9 $v$ \u5728\u8fd9\u4e00\u4f4d\u662f0\u7684\u6982\u7387)\u8f6c\u79fb\u624d\u80fd\u4f7f\u70b9u\u5728\u8fd9\u4e00\u4f4d\u662f $1$\n\n\u5728 $v \\sim u$ \u7684\u8fd9\u6761\u8fb9\u662f $0$ \u540c\u7406\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u5199\u51fa $dp$ \u5f0f\u5b50\uff1a\n\n$f_{i}=\\frac{1}{d_{i}}(\\sum_{edge(u,v)=0 }f_{v}+\\sum_{edge(u,v)=1}1-f_{v})$\n\n\u663e\u7136\u6709\u540e\u6548\u6027\uff0c\u4e0d\u80fd\u76f4\u63a5\u9012\u63a8\n\n\u90a3\u5c31\u628a\u5f0f\u5b50\u5316\u6210\u8fd9\u6837 :$d_{i}\u2217f_{i}\u2212\\sum_{edge(u,v)=0}f_{v}+\\sum_{edge(u,v)=1}f_{v}=\\sum_{edge(u,v)=1}1$\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u9ad8\u65af\u6d88\u5143\u4e86\u5bf9\u5427\n\n\u7136\u540e\u8fd8\u8981\u6ce8\u610f\u4e24\u70b9\n\n1.\u5982\u679c\u6709\u81ea\u73af\u5c31\u53ea\u8981\u8fde\u4e00\u6761\u8fb9(\u56e0\u4e3a\u81ea\u73af\u8d70\u4e24\u6b21\u76f8\u5f53\u4e8e\u6ca1\u8d70)\n\n2.\u77e9\u9635\u7684\u7b2cn\u884c\u53ea\u6709\uff08n,n\uff09\u662f1\uff0c\u5176\u4ed6\u5217\u90fd\u662f0\uff0c\u5176\u4ed6\u884c\u7684\u7b2cn\u5217\u90fd\u662f0\uff08\u56e0\u4e3a\u8d70\u5230n\u5c31\u7ed3\u675f\u4e86\uff0c\u4e0d\u80fd\u901a\u8fc7n\u6765\u8f6c\u79fb\uff09\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nconst int M = 105 ;\nconst int N = 10005 ;\nconst double eps = 1e-7 ;\nusing namespace std ;\ninline int read() {\n    char c = getchar() ; int x = 0 , w = 1 ;\n    while(c>'9'||c<'0') { if(c=='-') w = -1 ; c = getchar() ; }\n    while(c>='0'&&c<='9') { x = x*10+c-'0' ; c = getchar() ; }\n    return x*w ;\n}\n \n \nint n , m ;\nstruct E {\n    int Nxt , to , dis ;\n}edge[N<<1]; \nint hea[M] , num ;\ninline void add_edge(int from , int to , int dis) {\n    edge[++num].Nxt = hea[from] ;\n    edge[num].to = to ;\n    edge[num].dis = dis ;\n    hea[from] = num ;\n}\nint d[M] , Mx ;\ndouble B[M][M] , Ans ;\ninline void Solve(int x) {\n    memset(B , 0 , sizeof(B)) ;\n    for(int i = 1 ; i < n ; i ++) {\n        B[i][i] = d[i] ;\n        for(int j = hea[i] ; j ; j = edge[j].Nxt) {\n            int v = edge[j].to ;\n            if(edge[j].dis&(1<<(x - 1)))\n              ++B[i][v] , ++B[i][n + 1] ;\n            else --B[i][v] ;\n        }\n    }\n    for(int i = 1 ; i < n ; i ++) B[i][n] = 0 ;\n    B[n][n] = 1 ;\n}\ninline void Gauss() {\n    for(int i = 1 , Tab ; i <= n ; i ++) {\n        Tab = i ;\n        for(int j = i + 1 ; j <= n ; j ++)\n          if(fabs(fabs(B[j][i]) - fabs(B[Tab][i])) <= eps)\n            Tab = j ;\n        if(Tab != i)\n          for(int j = 1 ; j <= n + 1 ; j ++) swap(B[i][j] , B[Tab][j]) ;\n        for(int j = i + 1 ; j <= n + 1 ; j ++) B[i][j] /= B[i][i] ;\n        for(int j = 1 ; j <= n ; j ++)\n          if(i != j)\n            for(int k = i + 1 ; k <= n + 1 ; k ++)\n              B[j][k] -= B[j][i] * B[i][k] ;\n    }\n}\nint main() {\n    n = read() ; m = read() ;\n    for(int i = 1 , u , v , w ; i <= m ; i ++) {\n        u = read() , v = read() , w = read() ;\n        Mx = max(Mx , w) ;\n        add_edge(u , v , w) ; ++d[u] ;\n        if(u ^ v) add_edge(v , u , w) , ++d[v] ;\n    }\n    for(int i = 1 ; i <= 31 ; i ++) {\n        if((1<<(i - 1)) > Mx) break ;\n        Solve(i) ; Gauss() ;\n        Ans += (1<<(i - 1)) * B[1][n + 1] ;\n    }\n    printf(\"%.3lf\\n\",Ans) ;\n    return 0 ;\n}\n  ```",
        "postTime": 1611819009,
        "uid": 306255,
        "name": "\u65e5\u5fa1\u8353\u7ff3",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P3211 \u3010[HNOI2011]XOR\u548c\u8def\u5f84\u3011"
    },
    {
        "content": "\u5f02\u6216\u7684\u671f\u671b\u4e0d\u80fd\u76f4\u63a5\u7b97\uff0c\u5bf9\u6bcf\u4e00\u4f4d\u5355\u72ec\u8003\u8651\u3002\n\n$f[u][0/1]$:\u8282\u70b9 $u$ \u7684\u7b2c $i$ \u4f4d\u4e3a $0/1$ \u7684\u6982\u7387\u3002\n\n\u6ce8\u610f\u7ecf\u8fc7\u8282\u70b9 $u$ \u7684\u6982\u7387\u4e0d\u4e00\u5b9a\u4e3a $1$ \uff0c\u6240\u4ee5 $f[u][0]+f[u][1]$ \u7684\u503c\u4e0d\u4e00\u5b9a\u4e3a $1$\u3002\n\n$$f[1][0]=1,f[1][1]=0$$\n\n$$f_{u,0} = \\begin{cases}\n\\frac{f_{v,1}}{\\deg_v} & \\text{w\u7b2ci\u4f4d\u4e3a1}  \\\\\n\t\t  \\frac{f_{v,0}}{\\deg_v} & \\text{w\u7b2ci\u4f4d\u4e3a0}\n\\end{cases}$$\n$f_{u,1}$ \u540c\u7406\u3002\n\n\u9ad8\u65af\u6d88\u5143\u5f97\u5230 $f_{n,1}$ , \u4e58\u4e0a\u8be5\u4f4d\u6240\u5bf9\u5e94\u7684\u6570\u5373\u4e3a\u8be5\u4f4d\u7684\u671f\u671b\u3002\u5bf9\u6240\u6709\u4f4d\u6c42\u548c\u5373\u4e3a\u7b54\u6848\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n^3\\log w)$\u3002\n\n\u6ce8\u610f\u91cd\u8fb9\u548c\u81ea\u73af\u7684\u5904\u7406\u3002\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <vector>\n#include <cstring>\n#include <iostream>\nusing namespace std;\n#define eps 1e-8\n\nconst int MAXN = 200 , LOG = 31;\n\nint w; double a[ MAXN + 5 ][ MAXN + 5 ];\nvoid Gauss( ) {\n\tfor( int i = 1 ; i <= w ; i ++ ) {\n\t\tint pos = i;\n\t\tfor( int j = i + 1 ; j <= w ; j ++ )\n\t\t\tif( fabs( a[ pos ][ i ] ) < fabs( a[ j ][ i ] ) ) pos = j;\n\t\tswap( a[ i ] , a[ pos ] );\n\t\tif( fabs( a[ i ][ i ] ) < eps ) continue;\n\t\tfor( int j = 1 ; j <= w ; j ++ )\n\t\t\tif( i != j ) {\n\t\t\t\tdouble del = a[ j ][ i ] / a[ i ][ i ];\n\t\t\t\tfor( int k = 1 ; k <= w + 1 ; k ++ )\n\t\t\t\t\ta[ j ][ k ] -= a[ i ][ k ] * del; \n\t\t\t}\n\t}\n\tfor( int i = 1 ; i <= w ; i ++ ) if( fabs( a[ i ][ i ] ) > eps ) a[ i ][ w + 1 ] /= a[ i ][ i ];\n}\n\nint n , m , deg[ MAXN + 5 ];\nstruct node { int v , w; node(){} node( int V , int W ) { v = V , w = W; } };\nvector< node > Graph[ MAXN + 5 ];\n\nint main( ) {\n\tscanf(\"%d %d\",&n,&m);\n\tfor( int i = 1 , u , v , w ; i <= m ; i ++ ) {\n\t\tscanf(\"%d %d %d\",&u,&v,&w);\n\t\tdeg[ u ] ++; Graph[ u ].push_back( node( v , w ) );\n\t\tif( u != v ) deg[ v ] ++ , Graph[ v ].push_back( node( u , w ) );\n\t}\n\t\n\tw = 2 * n;\n\tdouble Ans = 0;\n\tfor( int i = 0 ; i <= LOG ; i ++ ) {\n\t\tmemset( a , 0 , sizeof( a ) );\n\t\t\n\t\ta[ 1 ][ w + 1 ] = 1;\n\t\tfor( int u = 1; u <= n ; u ++ ) {\n\t\t\ta[ u ][ u ] = 1; a[ u + n ][ u + n ] = 1;\n\t\t\tfor( node s : Graph[ u ] )\n\t\t\t\tif( s.v != n ) {\n\t\t\t\t\tif( ( s.w >> i ) & 1 ) {\n\t\t\t\t\t\ta[ u ][ s.v ] -= 0;\n\t\t\t\t\t\ta[ u ][ s.v + n ] -= 1.0 / deg[ s.v ];\n\t\t\t\t\t\ta[ u + n ][ s.v ] -= 1.0 / deg[ s.v ];\n\t\t\t\t\t\ta[ u + n ][ s.v + n ] -= 0;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\ta[ u ][ s.v ] -= 1.0 / deg[ s.v ];\n\t\t\t\t\t\ta[ u ][ s.v + n ] -= 0;\n\t\t\t\t\t\ta[ u + n ][ s.v ] -= 0;\n\t\t\t\t\t\ta[ u + n ][ s.v + n ] -= 1.0 / deg[ s.v ];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\t\t\n\t\tGauss();\n\t\tAns += a[ w ][ w + 1 ] * ( 1 << i );\n\t}\n\tprintf(\"%.3f\\n\", Ans );\n\treturn 0;\n} \n```\n",
        "postTime": 1606398125,
        "uid": 123802,
        "name": "chihik",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3211 \u3010[HNOI2011]XOR\u548c\u8def\u5f84\u3011"
    }
]
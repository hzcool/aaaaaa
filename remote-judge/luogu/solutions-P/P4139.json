[
    {
        "content": "\u5404\u4f4ddalao\u5e94\u8be5\u90fd\u77e5\u9053\u6269\u5c55\u6b27\u62c9\u5b9a\u7406\u5427\u2026\u2026\n\n\u5927\u6982\u957f\u8fd9\u6837\uff1a\n\n\u5bf9\u4e8e\u4efb\u610f$b \\geq \\varphi(p)$,\u6709\uff1a\n\n![](https://www.zhihu.com/equation?tex=a^b%20\\equiv%20a^{b\\text{%20mod%20}\\varphi(p)%20%2B%20\\varphi(p)}%20(\\text{mod%20}p))\n\n\u5f53$b < \\varphi(p)$\u65f6\u6709$a^b \\equiv a^{b \\text{ mod } \\varphi(p)} (\\text{mod } p)$\n\n\n\u5176\u4e2d$a,p$\u53ef\u4ee5\u4e0d\u4e92\u8d28\u3002\n\n  \n\u6709\u4e86\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u9898\u76ee\u4e2d\u7684$2^{2^{2^{2^{\\cdots}}}} \\text { mod } p$\u5c31\u5f88\u597d\u6c42\u4e86\uff0c\u7167\u7740\u4e0a\u9762\u7684\u5f0f\u5b50\u9012\u5f52\u5c31\u884c\u3002\u8fd9\u91cc\u8981\u6ce8\u610f\u5e94\u7528\u6761\u4ef6\uff1a\u8fd9\u91cc\u7684\u6307\u6570$b=2^{2^{2^{2^{\\cdots}}}}$\u662f\u6ee1\u8db3$b \\geq \\varphi(p)$\u7684\uff0c\u4e8e\u662f\u53ef\u4ee5\u76f4\u63a5\u7528\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u3002\n\n  \n\u9644\u4e0a\u4ee3\u7801\u3002\u672c\u849f\u84bb\u4e0d\u4f1a\u7ebf\u6027\u7b5b\uff0c\u53ea\u597d\u7528Eratosthenes\u7b5b\u4ee3\u66ff\u4e86= =\n\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int MAXP = 1e7;\n\nint T, p, phi[MAXP+10];\n\nvoid InitPhi() {\n    phi[1] = 1; \n    for(int i=2; i<=MAXP; i++)\n        if(!phi[i]) {\n            for(int j=i; j<=MAXP; j+=i) {\n                if(!phi[j]) phi[j] = j; \n                phi[j] = phi[j] / i * (i-1);\n            }\n        }\n}\n\ninline int fastmul(int a, int x, int mod) {\n    int ret = 0;\n    while(x) {\n        if(x&1) ret = ((ret%mod) + (a%mod))%mod;\n        x>>=1; a = ((a%mod) + (a%mod)) %mod;\n    }\n    return ret;\n}\n\ninline int fastpow(int a, int x, int mod) {\n    int ret = 1;\n    while(x) {\n        if(x&1) ret = fastmul(ret, a, mod) % mod;\n        x>>=1; a = fastmul(a, a, mod) % mod;\n    }\n    return ret;\n}\n\nint solve(int mod) {\n    if(mod == 1) return 0;\n    return fastpow(2, solve(phi[mod])+phi[mod], mod);\n}\n\nint main() {\n    InitPhi();\n    scanf(\"%d\", &T);\n    while(T--) {\n        scanf(\"%d\", &p);\n        printf(\"%d\\n\", solve(p));\n    }\n}\n```\n",
        "postTime": 1517107337,
        "uid": 23865,
        "name": "panda_2134",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4139 \u3010\u4e0a\u5e1d\u4e0e\u96c6\u5408\u7684\u6b63\u786e\u7528\u6cd5\u3011"
    },
    {
        "content": "[$$\\Large\\texttt{My Blog}$$](https://hydingsy.github.io/articles/problem-BZOJ-3884-God-and-Set/)\n\n---\n\n## Description\n\n> \u9898\u76ee\u94fe\u63a5\uff1a[Luogu 4139](https://www.luogu.org/problemnew/show/P4139)\n\n\u6c42\u5982\u4e0b\u5f0f\u5b50\u7684\u503c\uff1a\n$$2^{2^{2\\cdots}}\\bmod p$$\n\u672c\u9898 $T$ \u7ec4\u6570\u636e\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\le T\\le 1000$\uff0c$1\\le p\\le 10^7$\n\n------\n\n## Solution\n\n\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u6839\u636e**\u6269\u5c55\u6b27\u62c9\u5b9a\u7406**\uff1a\n$$\\text{\u5f53}\\ b\\ge \\varphi(p)\\ \\text{\u65f6\uff0c\u6709}\\ a^b\\equiv a^{b\\bmod \\varphi(p)+\\varphi(p)}\\pmod p$$\n\u5f97\u5230\uff1a\n$$2^{2^{2\\cdots}}\\bmod p=2^{(2^{2\\cdots}\\bmod \\varphi(p)+\\varphi(p))}\\bmod p$$\n\u5f88\u663e\u7136\u8fd9\u662f\u4e00\u4e2a\u9012\u5f52\u5f0f\u5b50\uff0c\u8fb9\u754c\u6761\u4ef6\u4e3a $p=1$\uff0c\u6b64\u65f6\u5f0f\u5b50\u7684\u503c\u4e3a $0$\u3002\n\n\u5bf9\u4e8e $\\varphi(p)$\uff0c\u6211\u4eec\u53ef\u4ee5\u7ebf\u6027\u7b5b\u9884\u5904\u7406\u3002\n\n**\u65f6\u95f4\u590d\u6742\u5ea6**\uff1a$O(P+T\\log p)$\n\n------\n\n## Code\n\n```cpp\n#include <cstdio>\n\nconst int N=1e7+5,M=N/10;\nint n,tot,p[M],phi[N];\nbool flg[N];\n\nvoid sieve(int n) {\n\tphi[1]=1;\n\tfor(int i=2;i<=n;++i) {\n\t\tif(!flg[i]) p[++tot]=i,phi[i]=i-1;\n\t\tfor(int j=1;j<=tot&&i*p[j]<=n;++j) {\n\t\t\tflg[i*p[j]]=1;\n\t\t\tif(i%p[j]==0) {\n\t\t\t\tphi[i*p[j]]=phi[i]*p[j];\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tphi[i*p[j]]=phi[i]*phi[p[j]];\n\t\t\t}\n\t\t}\n\t}\n}\nint pow(int x,int p,int mod) {\n\tint ret=1;\n\tfor(;p;p>>=1,x=1LL*x*x%mod) if(p&1) ret=1LL*ret*x%mod;\n\treturn ret;\n}\nint solve(int p) {\n\tif(p==1) return 0;\n\treturn pow(2,solve(phi[p])+phi[p],p);\n}\nint main() {\n\tsieve(N-5);\n\tint T;\n\tfor(scanf(\"%d\",&T);T--;) {\n\t\tint p;\n\t\tscanf(\"%d\",&p);\n\t\tprintf(\"%d\\n\",solve(p));\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1549594976,
        "uid": 49725,
        "name": "Siyuan",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4139 \u3010\u4e0a\u5e1d\u4e0e\u96c6\u5408\u7684\u6b63\u786e\u7528\u6cd5\u3011"
    },
    {
        "content": "\u53d1\u73b0\u8fd9\u9898\u5176\u5b9e\u662f\u6211\u51fa\u8fc7\u4e00\u9898\u7684\u5f31\u5316\u7248\u3002\u3002    \n\u4f20\u9001\u95e8\uff1a[link](https://www.luogu.org/problemnew/show/T59422)  \n\n\u9898\u76ee\u8981\u6c42\u51fa\uff1a  \n$$2^{2^{2^{...}}} \\bmod p$$  \n\u7684\u503c  \n\n\u6839\u636e\u6269\u5c55\u6b27\u62c9\u5b9a\u7406\uff1a  \n\u6b64\u5904 $\\varphi$ \u6307\u7684\u5c31\u662f\u6570\u8bba\u4e2d\u7684\u6b27\u62c9\u51fd\u6570\uff0c\u8bc1\u660e\u7565\u3002\u7f51\u4e0a\u4e00\u641c\u4e00\u5927\u5806\u3002\n$$a^b\\equiv \\left\\{\\begin{aligned}a^{b \\bmod\\varphi(p)+\\varphi(p)}(b>\\varphi(p))\\\\a^b(b \\le \\varphi(p))\\end{aligned}\\right. \\pmod p$$   \n  \n\n\u6211\u4eec\u4e0d\u96be\u60f3\u5230\u8fd9\u6837\u7684\u4e00\u4e2a\u9012\u5f52\u51fd\u6570\uff0c\u7528\u6765\u6c42 $a^{a^{a^{...}}}\\text{mod }p$\uff08$n$ \u4e2a $a$\uff09\u3002   \n\u7531\u4e8e\u662f\u8fd9\u4e2a\u4e58\u65b9\u5854\u6709\u65e0\u9650\u5c42\uff0c$b$ \u80af\u5b9a\u5927\u4e8e $\\varphi(p)$\uff0c\u6240\u4ee5\u76f4\u63a5\u7528\u7b2c\u4e00\u79cd\u60c5\u51b5\u5373\u53ef\u3002\n```cpp\nint tower(int a,int n,int p){\n    if(p==1) return 0;\n    if(n==1) return c%p;\n    int t = phi(p);\n    return power(a,tower(a,n-1,t)+t,p);\n}\n```  \n\uff08\u8fd9\u91cc `phi` \u662f\u6c42\u6b27\u62c9\u51fd\u6570\u7684\uff09\n\n\u53ef\u662f\u9898\u76ee\u4e2d\u8ba9\u6c42\u7684\u662f\u65e0\u9650\u5c42\uff0c\u5e76\u4e0d\u662f\u6709\u9650\u5c42\uff0c\u600e\u4e48\u529e\u554a\uff1f  \n\u4e0d\u8981\u7d27\uff0c\u5728\u4e00\u5c42\u5c42\u7684\u9012\u5f52\u4e2d\uff0c$p$ \u4e00\u904d\u904d\u7684\u88ab\u6c42\u5176 $\\varphi$ \u503c\uff0c\u6700\u7ec8**\u5fc5\u5b9a**\u4f1a\u964d\u5230 $1$\u3002\u539f\u56e0\u5f88\u7b80\u5355\uff1a\n\n- \u5bf9\u4efb\u610f\u5927\u4e8e $1$ \u7684\u6574\u6570 $p$\uff0c$\\varphi (p)$ \u662f\u5076\u6570\u3002\n- \u82e5 $p$ \u662f\u5076\u6570\uff0c$\\varphi(p) \\leq p/2$\u3002\n\n\u7b2c\u4e8c\u6761\u53ef\u4ee5\u5229\u7528\u6b27\u62c9\u51fd\u6570\u7684\u79ef\u6027\uff0c\u4ece\u4e2d\u63d0\u53d6 $2$ \u8fd9\u4e2a\u8d28\u56e0\u5b50\u6765\u8bc1\u660e\u3002\u7531\u6b64\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u4e2a\u9012\u5f52\u8fc7\u7a0b\u53ea\u4f1a\u8fdb\u884c $\\mathcal O(\\log p)$ \u6b21\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u6709\u529e\u6cd5\u4e86\uff0c\u6c42\u7b54\u6848\u7684\u65f6\u5019\u76f4\u63a5\u7528\u4e00\u4e2a\u5f88\u5927\u7684 $n$ \u6765\u8ba1\u7b97\u5c31\u597d\u5566\uff01  \n\u6ce8\u610f\u505a\u5feb\u901f\u5e42\u65f6\u6bcf\u6b21\u6a21\u6570\u4e0d\u540c\uff0c\u9700\u8981\u6ce8\u610f\u4e00\u4e0b\u3002\n\n\u53c2\u8003\u4ee3\u7801\uff1a\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<cstring>\n#include<algorithm>\n#include<cmath>\n#define ll long long\nusing namespace std;\n\ninline int phi(int n){  \n    int res,a;\n    res = a = n;\n    for(int i=2;i*i<=a;++i){\n        if(a%i) continue;\n        res = res/i*(i-1);  \n        while(!(a%i)) a /= i;\n    }  \n    if(a>1) res = res/a*(a-1);\n    return res;  \n}\n\ninline void read(int &x){\n    x = 0;\n    char c = getchar();\n    while(!isdigit(c)) c = getchar();\n    while(isdigit(c)){\n    \tx = (x<<3)+(x<<1)+c-'0';\n    \tc = getchar();\n    }\n}\n\ninline int power(int a,int t,int p){\n    int res = 1;\n    while(t){\n        if(t&1) res = (ll)res*a%p;\n        a = (ll)a*a%p;\n        t >>= 1;\n    }\n    return res;\n}\n\nint tower(int c,int p){ // \u8fd9\u91cc\u7a0d\u5fae\u6539\u4e86\u4e00\u4e0b\uff0c\u76f4\u63a5\u6c42\u89e3\uff0c\u4e0d\u7528\u8bbe\u7f6e\u4e00\u4e2a\u5f88\u5927\u7684 n\n    if(p==1) return 0;\n    int t = phi(p);\n    return power(c,tower(c,t)+t,p);\n}\n\nvoid print(int x){\n    if(x>9) print(x/10);\n    putchar(x%10+'0');\n}\n\nvoid optimized(){\n    int m;\n    read(m);\n    print(tower(2,m));\n    putchar('\\n');\n}\n\nint main(){\n    int T;\n    read(T);\n    while(T--)\n        optimized(); \n    return 0;\n}\n```\n",
        "postTime": 1544624058,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4139 \u3010\u4e0a\u5e1d\u4e0e\u96c6\u5408\u7684\u6b63\u786e\u7528\u6cd5\u3011"
    },
    {
        "content": "\u524d\u7f6e\u4e4b\u58eb\uff1a\u6b27\u62c9\u5b9a\u7406\u548c\u62d3\u5c55\u6b27\u62c9\u5b9a\u7406:\n\n$a^b\\equiv a^{b\\ mod\\ \u03c6 (m)}  \\ \\ \\ \\qquad\\qquad gcd(a,m)=1$\n\n$a^b\\equiv a^b     \\qquad\\qquad\\qquad\\qquad       gcd(a,m)\\neq 1,b<\u03c6 (m)$\n\n$a^b\\equiv a^{(b\\ mod\\ \u03c6 (m))+\u03c6 (m)} \\qquad  gcd(a,m)\\neq 1,b\\ge \u03c6 (m)$\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\uff0c$p$\u662f\u968f\u5373\u6570\u636e\uff0c\u4e0d\u628a\u4fdd\u8bc1$p,a$\u4e92\u8d28\uff0c\u6240\u4ee5\u6211\u4eec\u7528\u4e0a\u8ff0\u540e\u4e24\u4e2a\u7ed3\u8bba\uff0c\u4e5f\u5c31\u662f\u62d3\u5c55\u6b27\u62c9\u5b9a\u7406\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u9012\u5f52\u6267\u884c\uff0c\u76f4\u5230\u6a21\u6570\u4e3a0\uff0c\u8fd4\u56de1\u5373\u53ef\n\n\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u968f\u7740\u9012\u5f52\u7684\u6df1\u5165\uff0c\u6211\u4eec\u7684\u6a21\u6570\u4e5f\u5728\u53d8\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u9884\u5904\u7406\u51fa\u6240\u6709\u7684$\u03c6$\u503c\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u7ebf\u6027\u7b5b\uff08\u4e3b\u8981\u662fEratosthenes\u7b5b\u6cd5TLE\u4e86\uff09\u6765\u9884\u5904\u7406\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define il inline\n#define re register\n#define debug printf(\"Now is Line : %d\\n\",__LINE__)\n#define file(a) freopen(#a\".in\",\"r\",stdin);freopen(#a\".out\",\"w\",stdout)\n#define ll long long\nil int read()\n{\n    re int x=0,f=1;re char c=getchar();\n    while(c<'0'||c>'9') {if(c=='-') f=-1;c=getchar();}\n    while(c>='0'&&c<='9') x=x*10+c-48,c=getchar();\n    return x*f;\n}\n#define maxn 10000000\nint n,m,f[maxn+5],p[5000000],tot;\nbool is[maxn+5];\nil ll quickpow(ll a,int b,int mod)\n{\n    ll r=1;\n    while(b)\n    {\n        if(b&1) r=(r*a)%mod;\n        b>>=1;\n        a=(a*a)%mod;\n    }\n    return r;\n}\nil ll solve(int mod)\n{\n    if(mod==1) return 0;\n    return quickpow(2,solve(f[mod])+f[mod],mod);\n}\nsigned main()\n{\n    f[1]=1;\n    for(re int i=2;i<=maxn;++i)\n    {\n        if(!is[i]) p[++tot]=i,f[i]=i-1;\n        for(re int j=1;j<=tot;++j) \n        {\n            if(i*p[j]>maxn) break;\n            is[i*p[j]]=1;\n            if(i%p[j]) f[i*p[j]]=f[i]*(p[j]-1);\n            else {f[i*p[j]]=f[i]*p[j];break;}\n        }\n    }\n    int T=read();\n    while(T--)\n    {\n        n=read();\n        printf(\"%lld\\n\",solve(n));\n    }\n    return 0;\n}\n```",
        "postTime": 1548680020,
        "uid": 57014,
        "name": "Nemlit",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4139 \u3010\u4e0a\u5e1d\u4e0e\u96c6\u5408\u7684\u6b63\u786e\u7528\u6cd5\u3011"
    },
    {
        "content": "\u697c\u4e0b\u7528\u7684\u662fEratosthenes\u7b5b\uff0c\u90a3\u6211\u6765\u8865\u4e00\u53d1\u7ebf\u6027\u7b5b\t\n\u5148\u6765\u770b\u4e00\u4e0b\u7ebf\u6027\u7b5b\u7d20\u6570\uff1a\n```cpp\nvoid Get_prime(){\n    isprime[1]=1;\n    for(int i=2;i<=10000000;i++){\n        if(!isprime[i])\n            prime[++tot]=i;\n        for(int j=1;j<=tot;j++){\n            if(i*prime[j]>10000000)\n                break;\n            isprime[i*prime[j]]=1;\n            if(!(i%prime[j]))\n                break;\n        }\n    }\n}\n```\n\u5728\u8fd9\u4e2a\u4ee3\u7801\u4e2d\uff0c\u6bcf\u4e2a\u5408\u6570\u4ec5\u88ab\u5b83\u7684\u6700\u5c0f\u7d20\u56e0\u5b50\u7b5b\u53bb\u6b63\u597d\u4e00\u6b21\uff0c\u6240\u4ee5\u4e3a\u7ebf\u6027\u65f6\u95f4\u3002\t\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u6b27\u62c9\u51fd\u6570\u7684\u51e0\u4e2a\u6027\u8d28\u6765\u501f\u6b64\u6c42\u51fa10000000\u4ee5\u5185\u7684\u6240\u6709\u6b27\u62c9\u51fd\u6570(p\u4e3a\u7d20\u6570)\uff1a\t\n1.\u03c6(p)=p-1\t\n2.\u5982\u679ci mod p=0\uff0c\u5219\u03c6(i\u00b7p)=p*\u03c6(i)\t\n3.\u5982\u679ci mod p\u22600\uff0c\u5219\u03c6(i\u00b7p)=\u03c6(i)\u00b7(p-1)\t\n\u5229\u7528\u8fd9\u4e9b\u6027\u8d28\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f88\u8f7b\u677e\u5730\u5728\u7ebf\u6027\u7684\u65f6\u95f4\u5185\u6c42\u51fa10000000\u4ee5\u5185\u7684\u6b27\u62c9\u51fd\u6570\u3002\t\n\u4ee3\u7801\uff1a\n```cpp\nvoid Get_phi(){\n\tphi[1]=1;\n\tfor(int i=2;i<=10000000;i++){\n\t\tif(!phi[i]){\n\t\t\tprime[++tot]=i;\n\t\t\tphi[i]=i-1;\n\t\t}\n\t\tfor(int j=1;j<=tot;j++){\n\t\t\tif(i*prime[j]>10000000)\n\t\t\t\tbreak;\n\t\t\tif(!(i%prime[j])){\n\t\t\t\tphi[i*prime[j]]=phi[i]*prime[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse phi[i*prime[j]]=phi[i]*(prime[j]-1);\n\t\t}\n\t}\n}\n```\n\u6c42\u5b8c\u6b27\u62c9\u51fd\u6570\u4ee5\u540e\uff0c\u5f88\u7b80\u5355\uff0c\u76f4\u63a5\u7528\u6269\u5c55\u6b27\u62c9\u5b9a\u7406\u5c31\u53ef\u4ee5\u8f7b\u677e\u6c42\u51fa\u7b54\u6848\u3002\n\u603b\u4ee3\u7801\uff1a\n```cpp\n#include<cstdio>\nint quick_pow(long long a,int n,int mod){\n\tlong long ans=1;\n\twhile(n){\n\t\tif(n&1)\n\t\t\tans=ans*a%mod;\n\t\ta=a*a%mod;\n\t\tn>>=1;\n\t}\n\treturn ans;\n}\nint phi[10000010],prime[10000010],tot,n;\nvoid Get_phi(){\n\tphi[1]=1;\n\tfor(int i=2;i<=10000000;i++){\n\t\tif(!phi[i]){\n\t\t\tprime[++tot]=i;\n\t\t\tphi[i]=i-1;\n\t\t}\n\t\tfor(int j=1;j<=tot;j++){\n\t\t\tif(i*prime[j]>10000000)\n\t\t\t\tbreak;\n\t\t\tif(!(i%prime[j])){\n\t\t\t\tphi[i*prime[j]]=phi[i]*prime[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse phi[i*prime[j]]=phi[i]*(prime[j]-1);\n\t\t}\n\t}\n}\nint solve(int mod){\n\tif(mod==1)\n\t\treturn 0;\n\treturn quick_pow(2,solve(phi[mod])+phi[mod],mod);\n}\nint main(){\n\t#ifndef ONLINE_JUDGE\n\tfreopen(\"4139.in\",\"r\",stdin);\n\tfreopen(\"self.out\",\"w\",stdout);\n\t#endif\n\tGet_phi();\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++){\n\t\tint p;\n\t\tscanf(\"%d\",&p);\n\t\tprintf(\"%d\\n\",solve(p));\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1521862764,
        "uid": 49097,
        "name": "ezoiHQM",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4139 \u3010\u4e0a\u5e1d\u4e0e\u96c6\u5408\u7684\u6b63\u786e\u7528\u6cd5\u3011"
    },
    {
        "content": "\u7531\u6269\u5c55\u6b27\u62c9\u5b9a\u7406\uff0ca^b\u2261a^(b mod \u03c6(p)+\u03c6(p)) mod(p)\n\n\u6240\u4ee5\u53ea\u9700\u8981\u6c42\u51fa\u03c6\uff0c\u7528\u4e00\u4e2a\u7b80\u5355\u7684\u9012\u5f52\u4fbf\u80fd\u89e3\u51b3\u672c\u9898\n\n\u9898\u76ee\u4e2dT<=1000\uff0c\u800cp<=10e7\uff0c\u56e0\u6b64\u4e0d\u9002\u5408\u7528\u7b5b\u6cd5\u6c42\u03c6\n\n\u5b9e\u6d4b\uff1a\n\nEratosthenes\u7b5b\uff1a\n```cpp\ninline void calc_phi(int x){\n\tfor(int i=1;i<=x;i++)phi[i]=i;\n\tfor(int i=2;i<=x;i++)if(phi[i]==i)for(int j=i;j<=x;j+=i)phi[j]=phi[j]/i*(i-1);\n}\n```\n\u7528\u65f65.67 s\n\n\u7ebf\u6027\u7b5b\uff1a\n```cpp\ninline void calc_phi(int x){\n    phi[1]=1;\n    for(int i=2;i<=x;i++){\n        if(!vis[i])pr[++tot]=i,phi[i]=i-1;\n        for(int j=1,k;k=i*pr[j],j<=tot&&k<=x;j++){\n            vis[k]=1;\n            if(i%pr[j]==0){phi[k]=phi[i]*pr[j];break;}\n            else phi[k]=phi[i]*phi[pr[j]];\n        }\n    }\n}\n```\n\u7528\u65f62.13 s\n\n\u975e\u7b5b\u6cd5\u6c42\u03c6\uff1a\n```cpp\nint phi(int x){\n\tint r=x;\n\tfor(int i=2;i*i<=x;i++)if(x%i==0){\n\t\tr=r/i*(i-1);\n\t\tdo x/=i;while(x%i==0);\n\t}\n\tif(x>1)r=r/x*(x-1);\n\treturn r;\n}\n```\n\u7528\u65f6\u4ec549ms!\uff08\u672a\u5f00O2\uff09\n\n\u5f88\u660e\u663e\uff0c\u975e\u7b5b\u6cd5\u7684\u6548\u7387\u8fdc\u8d85\u7b5b\u6cd5\n\n\u6c42\u4e86\u03c6\u540e\uff0c\u53ea\u9700\u8981\u5feb\u901f\u5e42+\u9012\u5f52\u5c31\u53ef\u4ee5\u4e86\uff08\u5982\u679c\u4e0d\u7528\u5feb\u901f\u4e58\u6ce8\u610f\u5f00long long\uff09\n\n\u5b8c\u6574\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define L long long\nusing namespace std;\nint t,x;\nint phi(int x){//\u6c42\u03c6\n\tint r=x;\n\tfor(int i=2;i*i<=x;i++)if(x%i==0){\n\t\tr=r/i*(i-1);\n\t\tdo x/=i;while(x%i==0);\n\t}\n\tif(x>1)r=r/x*(x-1);\n\treturn r;\n}\nL pow(L x,L y,L z){//\u5feb\u901f\u5e42\n\tL r=1;\n\twhile(y){\n\t\tif(y&1)r=(r*x)%z;\n\t\tx=(x*x)%z,y>>=1;\n\t}\n\treturn r;\n}\nint f(int x){//\u9012\u5f52\n\tif(x<3)return 0;//\u5c0f\u4e8e3\u5219\u7ec8\u6b62\u9012\u5f52\n\tint n=phi(x);\n\treturn x<3?0:pow(2,n+f(n),x);\n}\nint main(){\n    scanf(\"%d\",&t);\n    while(t--)scanf(\"%d\",&x),printf(\"%d\\n\",f(x));\n}\n```\n",
        "postTime": 1564304591,
        "uid": 221955,
        "name": "panyf",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P4139 \u3010\u4e0a\u5e1d\u4e0e\u96c6\u5408\u7684\u6b63\u786e\u7528\u6cd5\u3011"
    },
    {
        "content": "### \u3010\u9898\u76ee\u3011\n![\u9898\u76ee](https://cdn.luogu.com.cn/upload/pic/31175.png)\n\n### \u3010\u6269\u5c55\u6b27\u62c9\u5b9a\u7406\u3011\n![\u516c\u5f0f](https://cdn.luogu.com.cn/upload/pic/31185.png)\n\n### \u3010\u89e3\u9898\u601d\u8def\u3011\n- \u5229\u7528\u6269\u5c55\u6b27\u62c9\u5b9a\u7406\u3002\n- \u539f\u5f0f=2^(\u5269\u4f59\u6570%$\u03d5(p)+\u03d5(p)$)\uff0c\u800c \u5269\u4f59\u6570%$\u03d5(p)$\u53c8\u53ef\u4ee5\u8fdb\u884c\u5206\u89e3\uff0c\u6240\u4ee5\u8fd9\u4e2a\u8fc7\u7a0b\u53ef\u4ee5\u7528\u9012\u5f52\u5b9e\u73b0\u3002\n- \u6ce8\u610f\u8fb9\u754c\u6761\u4ef6\uff1a\u5f53$p=1$\u65f6\uff0c\u4f59\u6570\u81ea\u7136\u4e3a0\u3002\n\n### \u3010\u53c2\u8003\u7a0b\u5e8f\u3011\n```cpp\n#include<cstdio>\n#include<cstring>\ntypedef long long LL;\n//#define int LL\nint Euler(int n)\n{\n\tint eu=n;\n\tfor (int i=2;i*i<=n;i++)\n\t{\n\t\tif (n%i==0)\n\t\t{\n\t\t\teu=eu/i*(i-1);\n\t\t\twhile (n%i==0)\n\t\t\t\tn/=i;\n\t\t}\n\t}\n\tif (n>1)\n\t\teu=eu/n*(n-1);\n\treturn eu;\n}\nint quick_pow(int x,int y,int Mod)\n{\n\tint sum=1;\n\tfor (;y;y>>=1,x=1ll*x*x%Mod)\n\t\tif (y&1)\n\t\t\tsum=1ll*sum*x%Mod;\n\treturn sum%Mod;\n}\nint vis[10000005];\nint Solve(int p)\n{\n\tif (vis[p]!=-1) return vis[p];\n\tint phi=Euler(p);\n\treturn vis[p]=quick_pow(2,Solve(phi)+phi,p);\n}\nsigned main()\n{\n\tint T;\n\tscanf(\"%d\",&T);\n\tmemset(vis,-1,sizeof vis);\n\tvis[1]=0;\n\twhile (T--)\n\t{\n\t\tint p;\n\t\tscanf(\"%d\",&p);\n\t\tprintf(\"%d\\n\",Solve(p));\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1535547444,
        "uid": 12349,
        "name": "FREEH",
        "ccfLevel": 6,
        "title": "\u6269\u5c55\u6b27\u62c9\u5b9a\u7406\u2014\u2014\u9898\u89e3 P4139 \u3010\u4e0a\u5e1d\u4e0e\u96c6\u5408\u7684\u6b63\u786e\u7528\u6cd5\u3011"
    },
    {
        "content": "\u539f\u9898\u53ef\u8f6c\u5316\u4e3a\u89e3\u65b9\u7a0b$2^x\\equiv x(\\text{mod}~ m)$\u3002  \n\u7531\u6b27\u62c9\u5b9a\u7406\u5f97$2^x\\equiv 2^{x~\\text{mod}~\\varphi(m)+\\varphi(m)} (\\text{mod}~m)$\uff0c\u90a3\u5c31\u8f6c\u5316\u4e3a\u6c42$x~\\text{mod}~\\varphi(m)$\u3002  \n\n\u9012\u5f52\u6c42\u89e3\uff0c\u81f3$m=1$\u65f6\u7ec8\u6b62\u5373\u53ef\u3002  \n\u53ef\u4ee5\u8bc1\u660e\u9012\u5f52\u7684\u5c42\u6570\u4e0d\u5927\u4e8e$2\\log 2m$\u3002  \n\n\u4ee3\u7801\u5982\u4e0b\uff08[\u5feb\u8bfb\u6a21\u677f](https://andyli.blog.luogu.org/read-template)\uff09\uff1a  \n```cpp\nconst int maxn = 10000005;\n\nint phi[maxn], r[maxn];\nbool vis[maxn];\nvector<int> primes;\nvoid init(int n)\n{\n    phi[1] = 1;\n    vis[0] = vis[1] = true;\n    for (int i = 2; i <= n; i++) {\n        if (!vis[i])\n            primes.push_back(i), phi[i] = i - 1, r[i] = i;\n        for (size_t j = 0; j < primes.size() && i * primes[j] <= n; j++) {\n            vis[i * primes[j]] = true;\n            r[i * primes[j]] = primes[j];\n            phi[i * primes[j]] = phi[i] * (primes[j] - (primes[j] < r[i]));\n            if (i % primes[j] == 0)\n                break;\n        }\n    }\n}\nint quick_pow(int a, int n, int p)\n{\n    a %= p;\n    int ans = 1;\n    while (n) {\n        if (n & 1)\n            ans = 1LL * ans * a % p;\n        a = 1LL * a * a % p;\n        n >>= 1;\n    }\n    ans %= p;\n    return ans;\n}\nint f(int p) { return p == 1 ? 0 : quick_pow(2, f(phi[p]) + phi[p], p); }\nint main()\n{\n    init(maxn - 5);\n    int T;\n    io.read(T);\n    while (T--) {\n        int p;\n        io.read(p);\n        writeln(f(p));\n    }\n    return 0;\n}\n```",
        "postTime": 1581085648,
        "uid": 84282,
        "name": "andyli",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4139 \u3010\u4e0a\u5e1d\u4e0e\u96c6\u5408\u7684\u6b63\u786e\u7528\u6cd5\u3011"
    },
    {
        "content": "# EX\u6b27\u62c9\u5b9a\u7406\n\u76f8\u4fe1\u5927\u5bb6\u90fd\u77e5\u9053\u6b27\u62c9\u5b9a\u7406\u662f\u4ec0\u4e48\u5427\n\n\n------------\n\n#### \u6b27\u62c9\u5b9a\u7406\n\n\u82e5$\\gcd(a,p)=1$ \n\n\u5219$a^{\\phi(p)}\u22611\\mod p$\n\n\u5373$a^b\u2261a^{(b\\%\\phi(p))} \\mod p$\n\n\n------------\n\n#### ex\u6b27\u62c9\u5b9a\u7406\n\n$a,p$\u4efb\u610f\n\n$a^b\u2261a^{((b\\%\\phi(p)) +\\phi(p))} \\mod p$\n\n\u6307\u6570\u53d8\u4e3a$\\phi(p)+b\\%\\phi(p)$\n\n------------\n\n\u90a3\u4e48$\\phi(p)$\u600e\u4e48\u6c42\u5462?\n\n\u4ec0\u4e48?\n\u4f60\u4e0d\u77e5\u9053$\\phi(p)$\u662f\u4ec0\u4e48?\n\u4f60\u662f\u6765\u5b66\u6570\u8bba\u7684\u5417?\n\n\u597d\u5427\uff0c\u5218\u59e5\u59e5\u8bf4\uff0c\u6b27\u62c9\u51fd\u6570$\\phi(p)$\u662f\u6c42\u5c0f\u4e8e\u7b49\u4e8e$p$\u7684\u6570\u4e2d\u4e0e$p$\u4e92\u8d28\u7684\u6570\u7684\u6570\u76ee\n\n\u7b5b\u6b27\u62c9\u51fd\u6570\n\n\u6b27\u62c9\u51fd\u6570\u6709\u5f88\u597d\u7684\u6027\u8d28\n\n$p$\u4e3a\u8d28\u6570\n\n1.$\\phi(p)=p-1$ \u00a0 \u56e0\u4e3a\u8d28\u6570$p$\u9664\u4e86$1$\u4ee5\u5916\u7684\u56e0\u6570\u53ea\u6709$p$\uff0c\u6545$1$\u81f3$p$\u7684\u6574\u6570\u53ea\u6709$p$\u4e0e$p$\u4e0d\u4e92\u8d28\n\n2.\u5982\u679c$i \\mod p = 0$, \u90a3\u4e48\u00a0$\\phi(i \\times p)=\\phi(i)\\times p$\n\n3.\u82e5$i \\mod p\\ne 0$, \u00a0\u90a3\u4e48\u00a0$\\phi(i\\times p)= \\phi(i) \\times(p-1)$\n\n```cpp\ninline void init()\n{\n\tphi[1]=1;\n\tfor(re int i=2;i<inf;i++)prime[i]=true;\n\tfor(re int i=2;i<inf;i++)\n\t{\n\t\tif(prime[i])\n\t\t{\n\t\t\tq[++tot]=i;\n\t\t\tphi[i]=i-1;\n\t\t}\n\t\tfor(re int j=1;j<=tot&&q[j]*i<inf;j++)\n\t\t{\n\t\t\tprime[q[j]*i]=false;\n\t\t\tif(i%q[j]==0)\n\t\t\t{\n\t\t\t\tphi[i*q[j]]=phi[i]*q[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tphi[i*q[j]]=phi[i]*(q[j]-1);\n\t\t}\n\t}\n\treturn;\n}\n```\n\u53ef\u4ee5\u5728\u7ebf\u6027\u7684\u65f6\u95f4\u5185\u8303\u56f4\u5185\u6570\u7684\u6b27\u62c9\u51fd\u6570\u3002\u3002\n\n------------\n\n\u672c\u9898\u5c31\u53ef\u4ee5\u5229\u7528\u6269\u5c55\u6b27\u62c9\u5b9a\u7406\u3002\n\n\u539f\u5f0f=$2^{(\\text{\u5269\u4f59\u6570}\\%\\phi(p)+\\phi(p))}$\uff0c\u800c$\\text{\u5269\u4f59\u6570}\\%\\phi(p)$ \u53c8\u53ef\u4ee5\u8fdb\u884c\u5206\u89e3\uff0c\u6240\u4ee5\u8fd9\u4e2a\u8fc7\u7a0b\u53ef\u4ee5\u7528\u9012\u5f52\u5b9e\u73b0\u3002\n\n\u6ce8\u610f\u8fb9\u754c\u6761\u4ef6\uff1a\u5f53$p=1$\u65f6\uff0c\u4f59\u6570\u81ea\u7136\u4e3a$0$\u3002\n\n\u4ee3\u7801\n```cpp\n#pragma GCC optimize(2)\n#include<bits/stdc++.h>\n#define eps 1e-10\n#define re register\n#define N 2001001\n#define MAX 2001\n#define PI acos(-1)\nusing namespace std;\ntypedef long long ll;\ntypedef double db;\ninline void read(re ll &ret)\n{\n    ret=0;re ll pd=0;re char c=getchar();\n    while(!isdigit(c)){pd|=c=='-';c=getchar();}\n    while(isdigit(c)){ret=(ret<<1)+(ret<<3)+(c^48);c=getchar();}\n    ret=pd?-ret:ret;\n}\nconst ll inf=1e7+1;\nbool prime[inf];\nll q[N],tot,phi[inf];\ninline void init()\n{\n\tphi[1]=1;\n\tfor(re int i=2;i<inf;i++)prime[i]=true;\n\tfor(re int i=2;i<inf;i++)\n\t{\n\t\tif(prime[i])\n\t\t{\n\t\t\tq[++tot]=i;\n\t\t\tphi[i]=i-1;\n\t\t}\n\t\tfor(re int j=1;j<=tot&&q[j]*i<inf;j++)\n\t\t{\n\t\t\tprime[q[j]*i]=false;\n\t\t\tif(i%q[j]==0)\n\t\t\t{\n\t\t\t\tphi[i*q[j]]=phi[i]*q[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tphi[i*q[j]]=phi[i]*(q[j]-1);\n\t\t}\n\t}\n\treturn;\n}\n\ninline ll qpow(re ll a,re ll b,re ll p)\n{\n\tre ll ret=1;\n\twhile(b)\n\t{\n\t\tif(b&1)/*ret=qmul(a,ret,p);*/ret*=a,ret%=p;\n\t\tb>>=1;\n\t\t//a=qmul(a,a,p);\n\t\ta*=a;\n\t\ta%=p;\n\t}\n\treturn ret;\n}\ninline ll work(re ll num)\n{\n\tif(num==1)return 0;\n\treturn qpow(2,work(phi[num])+phi[num],num);\n}\nll t;\nll p;\nint main()\n{\n\tinit();\n    read(t);\n\twhile(t--)\n\t{\n\t\tread(p);\n\t\tprintf(\"%lld\\n\",work(p));\n\t}\n    exit(0);\n}\n\n```\n",
        "postTime": 1562474107,
        "uid": 176990,
        "name": "Celtic",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4139 \u3010\u4e0a\u5e1d\u4e0e\u96c6\u5408\u7684\u6b63\u786e\u7528\u6cd5\u3011"
    },
    {
        "content": "\u8fd9\u9898\u8981\u7528\u5230\u4e00\u4e2a\u795e\u5947\u7684\u4e1c\u897f\uff1a\u6269\u5c55\u6b27\u62c9\u5b9a\u7406\u3002\n\n\u957f\u8fd9\u6837\uff1a\n\n\u82e5$b>=\\phi(p)$\n\n$$a^b\\equiv a^{b \\mod\\phi(p)+\\phi(p)}(\\mod p)$$\n\n\u8bc1\u660e\uff1a~~\u5373\u5f97\u6613\u89c1\u5e73\u51e1\uff0c\u7531\u4e0a\u53ef\u77e5\u663e\u7136\uff0c\u7559\u505a\u4e60\u9898\u7b54\u6848\u7565\uff0c\u8bfb\u8005\u81ea\u8bc1\u4e0d\u96be~~\n\n\u8bbe$p=l*q^r$,\u4e14$l\\perp q$,$q$\u662f$a$\u7684\u8d28\u56e0\u5b50\n\n\u6709\u6b27\u62c9\u5b9a\u7406\uff1a\n\n$$q^{\\phi(l)}\\equiv 1(\\mod l)$$\n\n\u663e\u7136\u4e5f\u6709\uff1a\n\n$$q^{\\phi(p)}\\equiv 1(\\mod l)$$\n\n$$q^{k\\phi(p) + r +b}\\equiv q^{r+b}(\\mod p)$$\n\n\u5373\u53ef\u5f97\uff1a\n\n$$q^{k\\phi(p)+c}\\equiv q^c(\\mod p)$$\n\n\u5176\u4e2d$r\\le c$\n\n\u8bbe$p^t$\u662f$a$\u7684\u56e0\u5b50\uff1a\n\n$$q^{tc}\\equiv q^{t\\phi(p)+tc}\\equiv (q^t)^{s\\phi(p)+c}\\equiv (q^t)^{c\\mod \\phi(p)+\\phi(p)}(\\mod p)$$\n\n\u6709$\\because a$\u7684\u6240\u6709\u8d28\u56e0\u5b50\u90fd\u6ee1\u8db3\u4e0a\u5f0f\uff0c\u4e58\u8d77\u6765\u5c31\u597d\u4e86\u3002\n\n\u518d\u770b\u8fd9\u9053\u9898\uff0c\u53ef\u4ee5\u53d1\u73b0\uff1a\n\n$$2^{2^{2^{2^{......}}}}\\equiv2^{2^{2^{2^{......}}}\\mod \\phi(p)+\\phi(p)}(\\mod p)$$\n\n\u9012\u5f52\u4e0b\u53bb\u5c31\u597d\u4e86\u3002\n\n\u8fb9\u754c\u6761\u4ef6\uff1ap\u4e3a1\u65f6\u8fd4\u56de0\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\n\nusing namespace std;\n\nbool notprime[10000007];\nint t, pp, prime[10000007], top = 0, phi[10000007];\n\ninline void pre() {\n    phi[1] = 1;\n    for (register int i = 2; i <= 10000000; ++i) {  \n        if (!notprime[i]) prime[++top] = i, phi[i] = i - 1;\n        for (register int j = 1; j <= top; ++j) {  \n            if (i * prime[j] > 10000000) break;  \n            notprime[i * prime[j]] = 1;\n            if (!(i % prime[j])) {  \n                phi[i * prime[j]] = phi[i] * prime[j];\n                break;  \n            } else phi[i * prime[j]] = phi[i] * (prime[j] - 1);\n        } \n    }\n}\n\ninline int power(int a, int b, int p) {\n\tlong long y = 1, l = a; int k = b;\n\twhile (k) {\n\t\tif (k & 1) y = (y * l) % p;\n\t\tl = (l * l) % p; k >>= 1;\n\t} return (int)y;\n}\n\ninline int calc(int l) {\n\tif (l == 1) return 0;\n\treturn power(2, calc(phi[l]) + phi[l], l);\n}\n\nint main() {\n\tscanf(\"%d\", &t); pre();\n\twhile (t--) {\n\t\tscanf(\"%d\", &pp);\n\t\tprintf(\"%d\\n\", calc(pp));\n\t} return 0;\n}\n```\n",
        "postTime": 1576664584,
        "uid": 98096,
        "name": "Smallbasic",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4139 \u3010\u4e0a\u5e1d\u4e0e\u96c6\u5408\u7684\u6b63\u786e\u7528\u6cd5\u3011"
    },
    {
        "content": "### \u9996\u5148\u4ecb\u7ecd\u4e00\u4e0b\u6b27\u62c9\u51fd\u6570\u548c\u6269\u5c55\u6b27\u62c9\u51fd\u6570\uff08phi\u6307\u7684\u662f\u6b27\u62c9\u51fd\u6570\uff09\n\n \t\ta^b = a^(b%phi(p)) gcd(a,p) == 1 (mod p)\n\t\t  \t a^b          gcd(a,p) != 1 b < phi(p) (mod p) \n  \t\t     a^(b%phi(p)+phi(p)) gcd(a,p) != 1 b >= phi(p) (mod p) \n             \n### \u672c\u9898\u7528\u5230\u7684\u5c31\u662f\u4e09\u5f0f  \n\n# \u9898\u610f\u4e3a  ![](http://www.lnsyoj.com/files/upload/49A6BDE9-E807-11B4-DF6D-B913A1AED1C9QQ%E6%88%AA%E5%9B%BE20180211101936.png)\n### cal\u51fd\u6570\u4e3a\u6c42\u51fa\u8fd9\u4e2a\u5f0f\u5b50\u5bf9p\u53d6mod\u7684\u7ed3\u679c\n\n### \u5f00\u59cb\u65f6\u8bbe\u5e95\u6570\u4e3a2\uff0c\u6307\u6570\u4e3a2\u76842\u6b21\u65b9\u76842\u6b21\u65b9\u2026\u2026 \uff0ccal\uff08\u539f\u5f0f\uff09\u7684\u7ed3\u679c\u4e3aw\uff0c\u5e94\u7528\u516c\u5f0f\uff0ccal\uff08\u539f\u5f0f\uff09 = 2 ^ \uff08\u5269\u4f59\u6570%phi\uff08p\uff09+ p\uff09\u3002\n\n### \u6240\u4ee5\u7ed3\u679c\u4e3a2\u7684\uff08\u5269\u4f59\u6570%phi\uff08p\uff09+ p\uff09\uff0c\u53ef\u4ee5\u7528\u5feb\u901f\u5e42\u6c42\u51fa\uff0c\u800c\u6307\u6570\u90e8\u5206\u7684\uff08\u5269\u4f59\u6570%phi\uff08p\uff09\uff09\u4ecd\u53ef\u4ee5\u6309\u4e0a\u8ff0\u65b9\u6cd5\u6c42\u89e3\uff0c\u4e8e\u662f\u9012\u5f52\u6c42\u89e3\u5373\u53ef\n\n### \u6ce8\u610f:\u5f53p == 1\u65f6\uff0c\u5bf91\u53d6mod\u5e94\u8fd4\u56de0\uff0c\u5373\u4e3a\u7ec8\u6b62\u6761\u4ef6\uff0c\u8f93\u51fa\u5373\u53ef\u3002\n\n### \u4ee3\u7801\n\n    #include<cstdio>\n    #include<cstring>\n    #include<algorithm>\n    #include<cmath>\n    using namespace std;\n    typedef long long ll;\n    ll ksm(ll x, ll y,ll mode)\n    {\n        ll ans = 1;\n        while(y)\n        {\n            if(y % 2 == 1)\n            {\n                ans = ans * x % mode;\n            }\n            x = x * x %mode ;\n            y = y/2;\n        }\n        return ans;\n    }\n    ll phi(ll x)\n    {\n        ll ans = x;\n        for(ll i = 2 ; i * i <= x ;i++)\n        {\n            if(x % i == 0)\n            {\n                ans = ans / i * (i - 1);\n                while(x % i == 0)\n                {\n                    x /= i;\n                } \n            }\n        }\n        if(x != 1) \n        {\n            ans = ans / x * (x - 1);\n        }\n        return ans;\n    }\n    ll cal(ll x)\n    {\n        if(x == 1)\n        {\n            return 0;\n        }\n        ll t = phi(x);\n        return ksm(2,cal(t) + t, x);\n    }\n    int main()\n    {\n        int t;\n        scanf(\"%d\", &t);\n        ll p;\n        for(int i = 1;i <= t;i++)\n        {\n            scanf(\"%lld\", &p);\n            printf(\"%lld\\n\",cal(p));\n        }\n        return 0;\n    }\n    /*  a^b = a^(b%phi(p)) gcd(a,p) == 1 (mod p)\n              a^b          gcd(a,p) != 1 b < phi(p) (mod p) \n              a^(b%phi(p)+phi(p)) a,p \u53ef\u4ee5\u4e0d\u4e92\u8d28 b >= phi(p) (mod p) \n    */ \n\n\n\n\n\n\n\n",
        "postTime": 1526631704,
        "uid": 66904,
        "name": "\u5fc6\u6b87",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4139 \u3010\u4e0a\u5e1d\u4e0e\u96c6\u5408\u7684\u6b63\u786e\u7528\u6cd5\u3011"
    },
    {
        "content": "~~\u4e3a\u4ec0\u4e48\u4e00\u5b9a\u8981\u7528\u7b5b\u5462\uff1f~~\n\n\u6211\u8fd9\u7bc7\u9898\u89e3\u4e3b\u8981\u662f\u4f18\u5316\u4e86\u6c42phi\u7684\u51fd\u6570\n\n\u4e0d\u7528\u521d\u59cb\u5316\u5168\u90e8\u6570\u7684phi\u503c\n```cpp\ninline ll phi(ll n){\n    ll ans=n,m=sqrt(n);\n    for(ll i=2;i<=m;i++)\n        if(n%i==0)\n        {\n            ans=ans/i*(i-1);//\u8fd9\u662f\u5b9a\u7406\n            while(n%i==0) n/=i;\n        }\n        if(n>1)ans=ans/n*(n-1);\n        return ans;\n}\n```\n\u7136\u540e\u53ef\u4ee5\u5feb\u4e50\u7684\u8dd1\u4e86\n\nac\u7a0b\u5e8f\uff1a\n```cpp\n#include<iostream>\n#include<cmath> \n#include<cstdio>\n#define ll long long\nusing namespace std;\nll p;\ninline ll read()\n{\n\tll x=0,f=1;\n\tchar c=getchar();\n\tfor(;!isdigit(c);c=getchar())\n\t\tif(c=='-')\n\t\t\tf=-1;\n\tfor(;isdigit(c);c=getchar())\n\t\tx=(x<<3)+(x<<1)+c-'0';\n\treturn x*f;\n}\ninline ll phi(ll n){\n    ll ans=n,m=sqrt(n);\n    for(ll i=2;i<=m;i++)\n        if(n%i==0)\n        {\n            ans=ans/i*(i-1);\n            while(n%i==0) n/=i;\n        }\n        if(n>1)ans=ans/n*(n-1);\n        return ans;\n}\ninline ll mul(ll a, ll x, ll mod) {\n    ll ret = 0;\n    while(x) {\n        if(x&1) ret = ((ret%mod) + (a%mod))%mod;\n        x>>=1; a = ((a%mod) + (a%mod)) %mod;\n    }\n    return ret;\n}\n\ninline ll pow(ll a, ll x, ll mod) {\n    ll ret = 1;\n    while(x) {\n        if(x&1) ret = mul(ret, a, mod) % mod;\n        x>>=1; a = mul(a, a, mod) % mod;\n    }\n    return ret;\n}\ninline ll solve(int mod){\n    if(mod==1)\n        return 0;\n    return pow(2,solve(phi(mod))+phi(mod),mod);\n}\nint main()\n{\n\tll T=read();\n\tfor(register ll i=1;i<=T;++i)\n\t{\n\t\tp=read();\n\t\tcout<<solve(p)<<endl;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1554706107,
        "uid": 140659,
        "name": "\u6e3a\u5c0f\u7684Mastar",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4139 \u3010\u4e0a\u5e1d\u4e0e\u96c6\u5408\u7684\u6b63\u786e\u7528\u6cd5\u3011"
    },
    {
        "content": "# \u524d\u8a00\n~~\u8d81\u673a\u5ba3\u4f20\u4e00\u6ce2\u81ea\u5df1\u7684\u535a\u5ba2\uff1a[\u3010\u4f20\u9001\u95e8\u3011](https://www.cnblogs.com/chhokmah/p/10645053.html)~~\n\n------\n# \u9898\u76ee\u5927\u610f\n\u8ba9\u4f60\u6c42$2^{2^{2^{\\cdots}}}(mod)P$\u7684\u503c\u3002\n\n------\n# \u524d\u7f6e\u77e5\u8bc6\n## \u77e5\u8bc61\uff1a\u65e0\u9650\u6b21\u5e42\u600e\u4e48\u89e3\u51b3\n\u8ba9\u6211\u4eec\u5148\u6765\u770b\u4e00\u9053\u5168\u56fd\u6570\u5b66\u7ade\u8d5b\u7684\u4e00\u9053\u6c34\u9898\uff1a  \n\u8ba9\u4f60\u6c42\u89e3\uff1a$x^{x^{x^{\\cdots}}}=2$\u65b9\u7a0b\u7684\u89e3\u3002  \n\u5bf9\u4e8e\u4e0a\u9762\u7684\u65e0\u9650\u6b21\u5e42\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u4e2a\u5f0f\u5b50\u79fb\u4e0a\u53bb\uff0c\u5f97\u5230\u4e86$x^{2}=2$\u3002  \n\u56e0\u4e3a\u6307\u6570\u7684\u539f\u56e0\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5f97\u5230\u4e86$x=\\sqrt{2}$\u3002  \n\u4ee5\u4e0a\u7684\u95ee\u9898\uff0c\u542f\u793a\u6211\u4eec\u5bf9\u4e8e\u8fd9\u4e00\u4e9b\u65e0\u9650\u6b21\u5e42\u53ef\u4ee5\u8f6c\u79fb\u6765\u89e3\u51b3\u3002  \n~~\u4ee5\u4e0a\u7684\u4e1c\u897f\u53ef\u80fd\u7528\u4e0d\u5230~~\n\n## \u77e5\u8bc62\uff1a\u6b27\u62c9\u5b9a\u7406\u548c\u6269\u5c55\u6b27\u62c9\u5b9a\u7406\n\u8be6\u7ec6\u8bf7\u51fa\u95e8\u5de6\u62d0\u6d1b\u8c37\u6a21\u677f\u533a[\u3010\u4f20\u9001\u95e8\u3011](https://www.luogu.org/problemnew/show/P5091)\u3002\uff08\u4ece\u5165\u95e8\u5230\u5165\u571f\uff09  \n\u56e0\u4e3a\u8fd9\u4e00\u9053\u9898\u76ee$p$\u4e3a\u4efb\u610f\u6574\u6570\uff0c\u90a3\u4e48\u65e0\u6cd5\u4f7f\u7528\u6b27\u62c9\u5b9a\u7406\uff0c\u90a3\u4e48\u5c31\u7528\u6bd4\u6b27\u62c9\u5b9a\u7406\u7a0d\u5fae\u590d\u6742\u4e00\u70b9\u70b9\u7684\u6269\u5c55\u6b27\u62c9\u5b9a\u7406\u3002  \n\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0b\u6269\u6b27\u5b9a\u7406\uff1a  \n$$a^b\\equiv a^{(b\\mod\\varphi(m))+\\varphi(m)}\\mod m$$\n\u6761\u4ef6\u662f$b>= \\varphi(m)$  \n\u7ed9\u4e00\u4efd\u849f\u84bb\u7684\u7ebf\u6027\u7b5b\u6b27\u62c9\u51fd\u6570\u7684\u4ee3\u7801\n```cpp\ninline void Get_Phi(int MAXN) {\n\tphi[1] = 1;\n\tfor (int i = 2; i <= MAXN; i ++) {\n\t\tif (!vis[i]) prime[++ Prime_tot] = i, phi[i] = i - 1;\n\t\tfor (int j = 1; j <= Prime_tot && i * prime[j] <= MAXN ; j ++) {\n\t\t\tvis[i * prime[j]] = 1;\n\t\t\tif (i % prime[j] == 0) { phi[i * prime[j]] = phi[i] * prime[j]; break; }\n\t\t\telse phi[i * prime[j]] = phi[i] * phi[prime[j]];\n\t\t}\n\t}\n}\n```\n\n-------\n# \u6b63\u89e3\n\u65e2\u7136\u6211\u4eec\u77e5\u9053\u4e86\u6b27\u62c9\u516c\u5f0f\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u4ee3\u5230\u539f\u6765\u7684\u5e42\u6b21\u4e2d\uff0c\u5f97\u5230\u4ee5\u4e0b\u7684\u63a8\u5bfc\uff1a  \n$$2^{2^{2^{\\cdots}}} \\ mod \\ p = 2^{2^{2^{\\cdots}} mod \\ \\varphi(p) + \\varphi(p)}\\ mod \\ p$$\n\u5f88\u660e\u663e\u7684\u662f$\\varphi(1)=1$\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5c31\u662f\u6211\u4eec\u9012\u5f52\u7684\u8fb9\u754c\u3002  \n\u5269\u4e0b\u6765\u7684\u5e42\u6b21\u6211\u4eec\u53ef\u4ee5\u7528\u5feb\u901f\u5e42\u5b9e\u73b0\u3002  \n\u6b27\u62c9\u51fd\u6570\u7684\u7b5b\u6cd5\u5c31\u7528\u7ebf\u6027\u7b5b\u5c31\u53ef\u4ee5\u4e86\uff0c\u597d\u50cf\u8fd9\u4e00\u9053\u9898\u76ee\u5c31\u53ea\u7528\u5355\u4e2a\u7684\u7b5b\u597d\u50cf\u53ef\u4ee5\u66f4\u5feb\u3002  \n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(T+T\\times log_2^p)$\n\n----\n# \u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\n#define ms(a, b) memset(a, b, sizeof(a))\n#define inf 0x3f3f3f3f\n#define db double\n#define N 10000500\nusing namespace std;\ntemplate <typename T>\ninline void read(T &x) {\n\tx = 0; T fl = 1; char ch = 0;\n\tfor (; ch < '0' || ch > '9'; ch = getchar())\n\t\tif (ch == '-') fl = -1;\n\tfor (; ch >= '0' && ch <= '9'; ch = getchar())\n\t\tx = (x << 1) + (x << 3) + (ch ^ 48);\n\tx *= fl;\n}\ntemplate <typename T>\ninline T Power(T x, T y, T Mod) {\n\tT res = 1;\n\tfor (; y; y >>= 1) {if (y & 1) res = (res * x) % Mod; x = (x * x) % Mod;} \n\treturn res % Mod;\n}\nll a, b, c;\nll Prime_tot = 0;\nint phi[N], prime[N];\nbool vis[N];\ninline void Get_Phi(int MAXN) {\n\tphi[1] = 1;\n\tfor (int i = 2; i <= MAXN; i ++) {\n\t\tif (!vis[i]) prime[++ Prime_tot] = i, phi[i] = i - 1;\n\t\tfor (int j = 1; j <= Prime_tot && i * prime[j] <= MAXN ; j ++) {\n\t\t\tvis[i * prime[j]] = 1;\n\t\t\tif (i % prime[j] == 0) { phi[i * prime[j]] = phi[i] * prime[j]; break; }\n\t\t\telse phi[i * prime[j]] = phi[i] * phi[prime[j]];\n\t\t}\n\t}\n}\nll f(ll x) {\n\tif (x == 1) return 0;\n\telse return Power(2ll, f(phi[x]) + phi[x], x);\n}\nint main() {\n\tint cas; read(cas);\n\tGet_Phi(1e7+1);\n\twhile (cas --) {\n\t\tll n; read(n); \n\t\tprintf(\"%lld\\n\", f(n));\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1554207765,
        "uid": 35567,
        "name": "Ayers",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4139 \u3010\u4e0a\u5e1d\u4e0e\u96c6\u5408\u7684\u6b63\u786e\u7528\u6cd5\u3011"
    },
    {
        "content": "## **\u9898\u76ee\u63cf\u8ff0**\n\n\n![](https://cdn.luogu.com.cn/upload/pic/69649.png)\n\n\n## **\u8be6\u89e3**\n**\u6b27\u62c9\u5b9a\u7406**\uff1a\u82e5\u6b63\u6574\u6570a\uff0cn\u4e92\u8d28\uff0c\u5219$a^{\u03c6(n)}$\u22611(mod n)\u3002\n\n**\u6269\u5c55\u6b27\u62c9\u5b9a\u7406**\uff1a\u82e5\u6b63\u6574\u6570a\uff0cn\u4e92\u8d28\uff0c\u5219\u5bf9\u4e8e\u4efb\u610f\u6b63\u6574\u6570b\uff0c\u6709$a^{b}$\u2261$a^{b \\mod \u03c6(n)}$(mod n)\u3002\n\n~~\u8bc1\u660e\u672c\u849f\u84bb\u5e76\u4e0d\u592a\u4f1a\u3002\u3002\u3002~~\n\n### **\u6b27\u62c9\u7684\u8ba1\u7b97\u5f0f**\n\n```cpp\nint phi(int n)\n{\n\tint ans=n;\n\tfor(R int i=2;i<=sqrt(n);i++)\n\t{\n\t\tif(n%i==0)\n\t\t{\n\t\t\tans=ans/i*(i-1);\n\t\t\twhile(n%i==0) n/=i;\n\t\t}\n\t}\n\tif(n>1) ans=ans/n*(n-1);\n\treturn ans;\n}\n```\n\n### **Eratosthenes\u7b5b\u6cd5**\n```cpp\nvoid euler(int n)\n{\n\tfor(R int i=2;i<=n;i++) phi[i]=i;\n\tfor(R int i=2;i<=n;i++)\n\t{\n\t\tif(phi[i]==i)\n\t\t{\n\t\t\tfor(R int j=i;j<=n;j+=i)\n\t\t\t{\n\t\t\t\tphi[j]=phi[j]/i*(i-1);\n\t\t\t}\n\t\t}\n\t}\n}\n```\n\n### **\u7ebf\u6027\u7b5b**\n\n```cpp\nvoid euler(int n)\n{\n\tfor(R int i=2;i<=n;i++)\n\t{\n\t\tif(!phi[i])\n\t\t{\n\t\t\tprime[++tot]=i;\n\t\t\tphi[i]=i-1;\n\t\t}\n\t\tfor(R int j=1;j<=tot;j++)\n\t\t{\n\t\t\tif(prime[j]>n/i) break;\n\t\t\tif(!(i%prime[j]))\n\t\t\t{\n\t\t\t\tphi[i*prime[j]]=phi[i]*prime[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse phi[i*prime[j]]=phi[i]*(prime[j]-1);\n\t\t}\n\t}\n}\n```\n\n\n\u6240\u4ee5\u672c\u9898\u53ef\u4ee5\u4e0d\u65ad\u9012\u5f52\u6c42\u89e3\uff0c\u5229\u7528\u6269\u5c55\u6b27\u62c9\u5b9a\u7406\u3002\n\n## **\u4ee3\u7801\u5982\u4e0b**\n\n\u5feb\u901f\u5e42\u5982\u679c\u4e0d\u7528\u5feb\u901f\u4e58\u7684\u8bdd\u8981\u5f00 long long\n\n\u81ea\u5df1\u6b7b\u4e86\u597d\u51e0\u6b21\u3002\u3002\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define R register\nusing namespace std;\nint prime[5100000],phi[11000000],tot,T,p;\nvoid euler(int n)\n{\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tif(!phi[i])\n\t\t{\n\t\t\tprime[++tot]=i;\n\t\t\tphi[i]=i-1;\n\t\t}\n\t\tfor(int j=1;j<=tot;j++)\n\t\t{\n\t\t\tif(i*prime[j]>n) break;\n\t\t\tif(!(i%prime[j]))\n\t\t\t{\n\t\t\t\tphi[i*prime[j]]=phi[i]*prime[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse phi[i*prime[j]]=phi[i]*(prime[j]-1);\n\t\t}\n\t}\n}\nint q_mul(long long a,int b,int c)\n{\n\tlong long ans=1;\n\twhile(b)\n\t{\n\t\tif(b&1) ans=(ans*a)%c;\n\t\ta=(a*a)%c;\n\t\tb>>=1;\n\t}\n\treturn ans%c;\n}\nint solve(int mod)\n{\n\tif(mod==1) return 0;\n\treturn q_mul(2,solve(phi[mod])+phi[mod],mod);\n}\nint main ()\n{\n\teuler(10000000);\n\tscanf(\"%d\",&T);\n\twhile(T--)\n\t{\n\t\tscanf(\"%d\",&p);\n\t\tprintf(\"%d\\n\",solve(p));\n\t}\n\treturn 0;\n}\n```\n\n\n\n",
        "postTime": 1565083481,
        "uid": 166289,
        "name": "\u4e03\u91cc",
        "ccfLevel": 7,
        "title": "P4139 \u4e0a\u5e1d\u4e0e\u96c6\u5408\u7684\u6b63\u786e\u7528\u6cd5"
    },
    {
        "content": "[\u535a\u5ba2\u98df\u7528\u66f4\u4f73~](https://tle666.github.io/2019/07/18/[BZOJ3884]%20%E4%B8%8A%E5%B8%9D%E4%B8%8E%E9%9B%86%E5%90%88%E7%9A%84%E6%AD%A3%E7%A1%AE%E7%94%A8%E6%B3%95/)\n\n\n# **Description**\n\n\u6c42 \n$$2^{2^{2 \\cdots}} \\bmod p$$\n\n\u5bf9\u4e8e $100\\%$ \u7684\u6570\u636e\uff0c\u6709\u6570\u636e\u7ec4\u6570 $T \\leq 1000$ \uff0c $p \\leq 10^7$\n\n[\u9898\u76ee\u94fe\u63a5\u6233\u8fd9\u91cc](https://www.luogu.org/problemnew/show/P4139)\n\n# **Solution**\n\n\u6839\u636e **\u6269\u5c55\u6b27\u62c9\u5b9a\u7406** \uff0c\u5373\u5f53 $b \\geq \\varphi (p)$ \u65f6\uff0c\n\n$$a ^ b \\equiv a ^ {b \\bmod \\varphi(p) + \\varphi(p)} \\pmod{p}$$\n\n\u800c\u5f53 $b < \\varphi(p)$ \u65f6\uff0c\n\n$$a^b \\equiv a ^ {b \\bmod \\varphi(p)} \\equiv a^b \\pmod{p}$$\n\n~~\u8c8c\u4f3c\u6ca1\u5565\u7528\uff1f~~\n\n\u7531\u4e8e\u9898\u76ee\u4e2d\u7684 $b$ \u662f $2^{2 \\cdots}$ \uff0c\u6240\u4ee5\u4e00\u5b9a\u6709 $b \\geq \\varphi(p)$\uff0c\u56e0\u6b64\u9012\u5f52\u4e00\u4e0b\u5f0f\u5b50\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u5177\u4f53\u5982\u4e0b\uff1a\n\n```cpp\nll work(ll m) {\n  if (m == 1) return 0; // \u5e26\u5165\u7b97\u4e00\u4e0b\u5c31\u80fd\u5f97\u51fa 0\n  return qpow(2, work(phi[m]) + phi[m], m); // \u9012\u5f52\uff0c qpow \u662f\u5feb\u901f\u5e42\n}\n```\n\n# **Code**\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\nconst int N = 10000100;\n\nll T, P, p[700700], phi[N], cnt;\nbool vis[N];\n\ninline void prework() {\n  phi[1] = 1;\n  for (int i = 2; i <= 1e7; i++) {\n    if (!vis[i]) p[++cnt] = i, phi[i] = i - 1;\n    for (int j = 1; j <= cnt && i * p[j] <= 1e7; j++) {\n      vis[i * p[j]] = true;\n      if (i % p[j] == 0) { phi[i * p[j]] = phi[i] * p[j]; break ; }\n      else phi[i * p[j]] = phi[i] * phi[p[j]];\n    }\n  }\n}\n\ninline ll qpow(ll a, ll b, ll mod) {\n  ll res = 1;\n  while (b) {\n    if (b & 1) (res *= a) %= mod;\n    (a *= a) %= mod, b >>= 1;\n  }\n  return res;\n}\n\ninline ll work(ll m) {\n  if (m == 1) return 0;\n  return qpow(2, work(phi[m]) + phi[m], m);\n}\n\nint main() {\n  prework();\n  scanf(\"%lld\", &T);\n  while (T--) {\n    scanf(\"%lld\", &P);\n    printf(\"%lld\\n\", (work(P) + P) % P);\n  }\n  return 0;\n}\n```\n\nPS\uff1a\u6211\u6ca1\u6709\u7814\u7a76 `long long` \u662f\u5426\u5fc5\u8981\uff0c\u53ea\u662f\u4fdd\u9669\u7f62\u4e86\n\n",
        "postTime": 1563459845,
        "uid": 54628,
        "name": "eros1on",
        "ccfLevel": 0,
        "title": "\u300cBZOJ3884\u300d\u4e0a\u5e1d\u4e0e\u96c6\u5408\u7684\u6b63\u786e\u7528\u6cd5"
    }
]
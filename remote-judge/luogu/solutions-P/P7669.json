[
    {
        "content": "\u6bd4\u8f83\u5957\u8def\u7684\u9898\u76ee\u3002\n\n\u9996\u5148\u6211\u4eec\u9700\u8981\u6c42\u51fa $S\\to T$ \u7684\u6700\u77ed\u8def\u53ef\u884c\u8fb9\u3002\n\n\u6211\u4eec\u5206\u522b\u4ee5 $S/T$ \u4e3a\u8d77\u70b9\uff0c\u8dd1\u6700\u77ed\u8def\u5f97\u5230 $dist_1,dist_2$ \uff0c\u5982\u679c\u4e24\u7aef $dist$ \u4e4b\u548c\u52a0\u4e0a\u8fb9\u7684\u957f\u5ea6\u4e3a\u6700\u77ed\u8def\uff0c\u5219\u5f53\u524d\u8fb9\u51fa\u73b0\u5728\u4e00\u6761\u6700\u77ed\u8def\u4e2d\u3002\n\n\u73b0\u5728\u4ece $U\\to V$ \uff0c\u514d\u8d39\u7684\u4e00\u5b9a\u662f\u4e00\u6761\u8fde\u7eed\u7684\u8def\u5f84\u3002\n\n\u800c\u8fd9\u6761\u514d\u8d39\u7684\u8def\u5f84\u8981\u4e48\u662f\u987a\u7740\u6700\u77ed\u8def\u5f84\u56fe\u8d70\u4e00\u6bb5\uff0c\u8981\u4e48\u662f\u9006\u7740\u6700\u77ed\u8def\u5f84\u56fe\u8d70\u4e00\u6bb5\uff0c\u800c\u4e0d\u80fd\u540c\u65f6\u6709\u987a\u5411\u6216\u9006\u5411\u8d70\u3002\n\n\u7b80\u5355\u60f3\u4e86\u4e00\u4e2a\u8d2a\u5fc3\uff0c\u5927\u6982\u662f\u5148\u6c42\u51fa $U/V$ \u5230\u6700\u77ed\u8def\u5f84\u56fe\u7684\u6700\u8fd1\u70b9 $P,Q$\uff0c\u518d\u4ece $P/Q$ \u4e3a\u8d77\u70b9\u51fa\u53d1\u987a\u5411\u6216\u9006\u5411\u627e\u5230\u6700\u8fd1\u516c\u5171\u53ef\u8fbe\u70b9\uff0c\u5206\u522b\u4ee5 $P,Q$ \u4e3a\u8d77\u70b9\u6b63\u56fe\u53cd\u56fe\u90fd\u8dd1\u4e00\u904d\u6700\u77ed\u8def\u3002\n\n\u7801\u4e86 $10$ \u5206\u949f\u611f\u89c9\u592a\u9ebb\u70e6\u4e86\uff0c\u4e0d\u5982\u76f4\u63a5\u5206\u5c42\u56fe\u3002\u7b2c $1$ \u5c42\u548c\u7b2c $4$ \u5c42\u5206\u522b\u8868\u793a\u8fd8\u672a\u5f00\u59cb\u514d\u8d39\u8def\u5f84\uff0c\u5df2\u7ecf\u7ed3\u675f\u514d\u8d39\u8def\u5f84\u3002\u7b2c $2$ \u5c42\u8868\u793a\u514d\u8d39\u8def\u5f84\u987a\u7740\u8d70\uff0c\u8fd9\u4e00\u5c42\u5c31\u662f\u6700\u77ed\u8def\u56fe\uff0c\u7b2c $3$ \u5c42\u8868\u793a\u514d\u8d39\u8def\u5f84\u9006\u7740\u8d70\uff0c\u5c31\u662f\u6700\u77ed\u8def\u56fe\u7684\u53cd\u56fe\u3002\n\n\u6700\u540e\u518d\u8dd1\u4e00\u904d\u6700\u77ed\u8def\u5373\u53ef\uff0c\u4e00\u5171\u8dd1\u4e09\u904d\u6700\u77ed\u8def\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}((N+M)\\log (N+M))$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<=b;i++)\n#define pre(i,a,b) for(int i=a;i>=b;i--)\n#define N 400005\n#define int long long \nusing namespace std;\nint n,m,d[N],c[N],mk[N],h[N],tot,s,t,u,v;\nstruct edge{int to,nxt,val;}e[N];\nvoid add(int x,int y,int z){e[++tot].nxt=h[x];h[x]=tot;e[tot].to=y;e[tot].val=z;}\ntypedef pair<int,int> Pr;\npriority_queue<pair<int,int>>q;\nvector<Pr>a[N];\nvoid ins(int x,int y,int z){a[x].push_back(make_pair(y,z));}\nvoid dij(){\n\tmemset(d,0x3f,sizeof(d));\n\td[s]=0;q.push(make_pair(0,s));\n\twhile(!q.empty()){\n\t\tint x=q.top().second;q.pop();mk[x]=1;\n\t\tfor(int i=h[x];i;i=e[i].nxt)if(d[x]+e[i].val<d[e[i].to])\n\t\t\td[e[i].to]=d[x]+e[i].val,q.push(make_pair(-d[e[i].to],e[i].to));\n\t\twhile(!q.empty()&&mk[q.top().second])q.pop();\n\t}\n\tmemset(c,0x3f,sizeof(c));\n\tmemset(mk,0,sizeof(mk));\n\tc[t]=0;q.push(make_pair(0,t));\n\twhile(!q.empty()){\n\t\tint x=q.top().second;q.pop();mk[x]=1;\n\t\tfor(int i=h[x];i;i=e[i].nxt)if(c[x]+e[i].val<c[e[i].to])\n\t\t\tc[e[i].to]=c[x]+e[i].val,q.push(make_pair(-c[e[i].to],e[i].to));\n\t\twhile(!q.empty()&&mk[q.top().second])q.pop();\n\t}\n\trep(x,1,n)\n\t\tfor(int i=h[x];i;i=e[i].nxt)\n\t\t\tif(d[x]+e[i].val+c[e[i].to]==d[t]){\n\t\t\t\tins(x+n,e[i].to+n,0),ins(e[i].to+n+n,x+n+n,0);\n\t\t\t}\n}\nvoid solve(){\n\tmemset(d,0x3f,sizeof(d));\n\tmemset(mk,0,sizeof(mk));\n\td[u]=0;q.push(make_pair(0,u));\n\twhile(!q.empty()){\n\t\tint x=q.top().second;q.pop();mk[x]=1;\n\t\tfor(auto w:a[x]){\n\t\t\tint y = w.first,z = w.second;\n\t\t\tif(d[x] + z < d[y])d[y] = d[x] + z,q.push(make_pair(-d[y],y));\n\t\t}\n\t\twhile(!q.empty()&&mk[q.top().second])q.pop();\n\t}\n\tprintf(\"%lld\\n\",d[v+n+n+n]);\n}\nsigned main(){\n\tscanf(\"%lld%lld\",&n,&m);\n\tscanf(\"%lld%lld%lld%lld\",&s,&t,&u,&v);\n\trep(i,1,m){\n\t\tint x,y,z;scanf(\"%lld%lld%lld\",&x,&y,&z);\n\t\tadd(x,y,z);add(y,x,z);\n\t\tins(x,y,z);ins(y,x,z);\n\t\tins(x+n+n+n,y+n+n+n,z);ins(y+n+n+n,x+n+n+n,z);\n\t}\n\trep(i,1,n)ins(i,i+n,0),ins(i,i+n+n,0),ins(i+n,i+n+n+n,0),ins(i+n+n,i+n+n+n,0);\n\tdij();solve();\n\treturn 0;\n}\n```",
        "postTime": 1625061039,
        "uid": 119261,
        "name": "7KByte",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011[JOI2018] Commuter Pass"
    },
    {
        "content": "## \u9898\u610f\n\u7ed9\u51fa\u4e00\u5f20\u65e0\u5411\u56fe\uff0c\u95ee\u5c06 $s$ \u5230 $ t$ \u67d0\u6761\u6700\u77ed\u8def\u4e0a\u6240\u6709\u8fb9\u6743\u503c\u7f6e\u4e3a $0$ \u540e $u\\to v$ \u7684\u6700\u77ed\u8def\u3002\n## \u601d\u8def\n\n\u5148\u8dd1\u51fa\u6765 $s,t,u,v$ \u5404\u81ea\u7684\u5355\u6e90\u6700\u77ed\u8def\uff0c\u7136\u540e\u6734\u7d20\u7684\u60f3\u6cd5\u662f\u5148\u5224\u65ad\u4e0d\u7ecf\u8fc7\u6700\u77ed\u8def\u7684\u60c5\u51b5\uff0c\u8fd9\u79cd\u76f4\u63a5\u8dd1\u5373\u53ef\u3002\n\n\u7136\u540e\u679a\u4e3e $s\\to t$ \u6700\u77ed\u8def\u4e0a\u7684\u4e24\u4e2a\u70b9\uff0c\u6c42\u51fa $u,v$ \u5230\u4ed6\u4eec\u8ddd\u79bb\u4e4b\u548c\u3002\n\n\u8fd9\u6837\u590d\u6742\u5ea6\u660e\u663e\u662f $O(n^2)$ \u7684\uff0c\u6211\u4eec\u8003\u8651\u4f18\u5316\uff0c\u5148\u53ea\u679a\u4e3e\u6700\u77ed\u8def\u5f84\u4e0a\u4e00\u4e2a\u7684\u70b9\uff0c\u8bbe\u4e3a $x$ \uff0c\u7136\u540e\u95ee\u9898\u5c31\u662f\u53e6\u5916\u4e00\u4e2a\u70b9\u7684\u9009\u53d6\u3002\n\n\u4e0d\u96be\u53d1\u73b0\u6211\u4eec\u5bf9 $s$ \u4e3a\u6e90\u70b9\u7684\u5355\u6e90\u6700\u77ed\u8def\u5efa\u51fa\u6765\u6700\u77ed\u8def\u6811\uff0c\u518d\u52a0\u4e0a\u4e0d\u5728\u6811\u4e0a\u4f46\u662f\u53ef\u4ee5\u4f4d\u4e8e\u6700\u77ed\u8def\u4e0a\u7684\u8fb9\uff0c\u5c31\u5f62\u6210\u4e86\u4e00\u4e2a\u53ea\u6709\u4e00\u4e2a\u6e90\u70b9 $s$ \u7684 DAG \uff0c\u5219\u5728\u8fd9\u4e2a DAG \u4e0a\u80fd\u5230\u8fbe $x$ \u7684\u70b9\u90fd\u662f\u5408\u6cd5\u7684\u3002\u6ee1\u8db3\u5b58\u5728\u4e00\u6761\u6700\u77ed\u8def\u5f84\u540c\u65f6\u7ecf\u8fc7\u8fd9\u4e24\u4e2a\u70b9\u3002\n\n\u800c\u5bf9\u4e8e $t$  \u4e3a\u6e90\u70b9\u7684\u6700\u77ed\u8def\u5f84\u540c\u7406\u3002\n\n\u6ce8\u610f\u5230\u5e76\u4e0d\u9700\u8981\u663e\u793a\u5efa\u51fa\u6765\u8fd9\u4e2a DAG\uff0c\u76f4\u63a5\u5728\u8dd1\u6700\u77ed\u8def\u7684\u65f6\u5019\u987a\u4fbf dp \u5373\u53ef\u5f97\u5230\u7b54\u6848\u3002\n\n## code\n\n```cpp\nconst int MAXN=2e5+10;\nvector<pii>e[MAXN];\n\nint n;\nvoid dijk(int s,ll dis[])\n{\n    memset(dis,0x3f,8*MAXN);\n    dis[s]=0;\n    priority_queue<pll>q;\n    q.emplace(0,s);\n    vector<bool>vis(n+1);\n    while(!q.empty())\n    {\n        int u=q.top().second;q.pop();\n        if(vis[u])continue;\n        vis[u]=1;\n        for(auto&[v,w]:e[u])if(cmin(dis[v],dis[u]+w))q.emplace(-dis[v],v);\n    }\n}\nvoid dijk2(int s,ll dis[],ll mmin[])\n{\n    memset(dis,0x3f,8*MAXN);\n    dis[s]=0;\n    priority_queue<pll>q;\n    q.emplace(0,s);\n    vector<ll>val(mmin,mmin+n+1);\n    vector<bool>vis(n+1);\n    while(!q.empty())\n    {\n        int u=q.top().second;q.pop();\n        if(vis[u])continue;\n        vis[u]=1;\n        for(auto&[v,w]:e[u])\n        {\n            if(cmin(dis[v],dis[u]+w))mmin[v]=val[v],q.emplace(-dis[v],v);\n            if(dis[v]==dis[u]+w)cmin(mmin[v],mmin[u]);\n        }\n        \n    }\n}\nll d1[MAXN],d2[MAXN];\nint fa1[MAXN],fa2[MAXN];\nll d3[MAXN],d4[MAXN];\nll mmin1[MAXN],mmin2[MAXN];\nint main()\n{\n\tios::sync_with_stdio(0),cin.tie(0),cout.tie(0);cout<<fixed<<setprecision(10);\n\tint m;cin>>n>>m;\n    int s,t,x,y;\n    cin>>s>>t>>x>>y;\n    for(int i=1,u,v,w;i<=m;i++)cin>>u>>v>>w,e[u].emplace_back(v,w),e[v].emplace_back(u,w);\n    dijk(x,d3),dijk(y,d4);\n    for(int i=1;i<=n;i++)mmin1[i]=mmin2[i]=d4[i];\n    dijk2(s,d1,mmin1),dijk2(t,d2,mmin2);\n    ll len=d1[t];\n    ll ans=d3[y];\n    for(int i=1;i<=n;i++)if(d1[i]+d2[i]==len)\n    {\n        cmin(ans,mmin1[i]+d3[i]);\n        cmin(ans,mmin2[i]+d3[i]);\n    }\n    cout<<ans;\n\treturn 0;\n} \n\n```\n",
        "postTime": 1682148222,
        "uid": 571229,
        "name": "__stick",
        "ccfLevel": 7,
        "title": "P7669 [JOI2018] Commuter Pass"
    }
]
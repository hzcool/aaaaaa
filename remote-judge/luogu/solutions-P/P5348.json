[
    {
        "content": "\u6570\u8bba\u6bd2\u7624\u9898\n\n\u540e\u9762\u6839\u672c\u4e0d\u4f1a\u505a\u4e86\uff0c\u4ec0\u4e48\u6c42\u548c\u5957\u8def\u90fd\u7528\u5149\u4e86\u3002\n\n\u6240\u4ee5\u8fd8\u662f\u81ea\u5df1\u5bb9\u65a5\u5b66\u7684\u592a\u5dee\u4e86\u3002\u3002\u3002\n\n\u4e0d\u8fc7\u8fd9\u9898\u7b80\u76f4\u5c31\u662f\u591a\u5408\u4e00\u554a\n\n### \u8bb2\u8bb2\u6211\u7684\u5fc3\u8def\u5386\u7a0b\uff1a\n\n\u505a\u8fd9\u9053\u9898\u4e4b\u524d\u8bf7\u505a\u4e00\u505a[$P2257$](https://www.luogu.org/problemnew/show/P2257)\u548c[$P1587$](https://www.luogu.org/problemnew/show/P1587)\u548c[$SP4168$](https://www.luogu.org/problemnew/show/SP4168)\n\n~~\u987a\u4fbf\u5b89\u5229\u4e00\u4e0b\u6211\u7684\u9898\u89e3~~\n\n\u524d\u9762\u90fd\u662f\u81ea\u5df1\u778e\u63a8\u7684\uff0c\u540e\u9762\u601d\u8def\u53c2\u8003\u4e86\u697c\u4e0a\u7684\u5927\u4f6c\u3002\n\n## \u9898\u610f\uff1a\n\n\u8bbe\u4e00\u4e2a\u51fd\u6570$f(i)$\uff0c\u6ee1\u8db3\n\n$$\\sum_{i|j}f(j)=\\mu(i)$$\n\n\u6c42$f(m)$\n\n\u7136\u540e\u5f88\u663e\u7136\u7684\u7528\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5b9a\u7406\u7684\u7b2c$2$\u79cd\u5f62\u5f0f\n\n\u590d\u4e60\u4e00\u4e0b~~\u524d\u51e0\u5929\u8fd8\u8bf4\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5b9a\u7406\u6ca1\u7528~~\n\n\u82e5\n\n$$g(i)=\\sum_{i|j}f(j)$$\n\n\u5219\n\n$$f(i)=\\sum_{i|j}g(j)\\mu(\\frac ji)$$\n\n\u8bc1\u660e\uff1a\n\n$$\\sum_{i|j}g(j)\\mu(\\frac ji)=\\sum_{i|j}\\sum_{j|k}f(k)\\mu(\\frac ji)$$\n\n$$=\\sum_{i|k}\\sum_{\\frac ji|\\frac ki}f(k)\\mu(\\frac ji)$$\n\n\u8bbe$d=\\frac ji$\n\n$$=\\sum_{i|k}f(k)\\sum_{d|\\frac ki}\\mu(d)\\ =\\ \\sum_{i|k}f(k)[\\frac ki==1]$$\n\n$$=\\sum_{i|k}f(k)[k==i]\\ =f(k)$$\n\n\u8bc1\u5b8c\u4e86\u3002\n\n\n------------\n\n\n\u6240\u4ee5\u6211\u4eec\u7528\u4e00\u7528\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5b9a\u7406\u5c31\u6709\n\n\n$$f(m)=\\sum_{m|j}\\mu(\\frac jm)\\mu(j)$$\n\n\u5957\u8def\u53bb\u8bbe$k=\\frac jm$\n\n$$=\\sum_{k=1}^{\\lfloor \\frac nm\\rfloor}\\mu(k)\\mu(km)$$\n\n\u8fd9\u5c31\u53c8\u7528\u5230\u4e86\u5faa\u73af\u4e4b\u7f8e\u7684\u5957\u8def\u4e86\uff0c\u4e0d\u4f1a\u7684\u53ef\u4ee5\u770b\u4e00\u770b[\u6211\u7684\u5c0f\u7ed3](https://www.luogu.org/blog/wohaocaia/mu-bi-wu-si-fan-yan-di-ge-zhong-tao-lu-zong-jie)\u4e2d\u7684\u7b2c$3$\u6761\n\n$\\mu(ij)=\\mu(i)\\mu(j)[gcd(i,j)==1]$\n\n\u6240\u4ee5\u5c31\u53ef\u4ee5\u62c6\u6389\u4e86\n\n$$f(m)=\\sum_{k=1}^{\\lfloor \\frac nm\\rfloor}\\mu^2(k)\\mu(m)[gcd(m,k)==1]$$\n\n$$f(m)=\\mu(m)\\sum_{k=1}^{\\lfloor \\frac nm\\rfloor}\\mu^2(k)[gcd(m,k)==1]$$\n\n\u8fd9\u524d\u9762\u90fd\u662f\u81ea\u5df1\u63a8\u7684\uff0c\u7136\u540e\u540e\u9762\u6211\u5c31\u61f5\u903c\u4e86\n\n\u600e\u4e48\u6c42\u8fd9\u4e2a\u5f0f\u5b50\n\n$$\\sum_{k=1}^{\\lfloor \\frac nm\\rfloor}\\mu^2(k)[gcd(m,k)==1]?$$\n\n\u6211\u60f3\u5230\u4e86$SPOJ$\u90a3\u9053\u9898\uff01\n\n\u8003\u8651\u6ca1\u6709$gcd$\u7684\u60c5\u51b5\n\n$$\\sum_{i=1}^{n}\\mu^2(i)=\\sum_{i=1}^{\\sqrt{n}}\\mu(i)\\lfloor\\frac n{i^2}\\rfloor$$\n\n\u6211\u4eec\u8981\u6c42\u7684\u5c31\u662f$1$~$n$\u4e2d\u4e0d\u662f\u5b8c\u5168\u5e73\u65b9\u6570$(1$\u9664\u5916$)$\u500d\u6570\u7684\u6570\u7684\u4e2a\u6570\u3002\n\n\u7136\u540e\u6839\u636e\u679a\u4e3e\u5e73\u65b9\u56e0\u5b50\u7684\u500d\u6570\u4e2a\u6570\uff0c\u7136\u540e\u5bb9\u65a5\uff0c\u4e14\u5bb9\u65a5\u7cfb\u6570\u4e3a$\\mu$\uff0c\u5c31\u5f97\u5230\u4e86\u6211\u4eec\u8981\u7684\u5f0f\u5b50\n\n\u4e0d\u61c2\u7684\u53ef\u4ee5\u770b\u6211\u7684\u9898\u89e3\u6216\u8005$Sooke$\u7684\u9898\u89e3\u3002\n\n\u5176\u5b9e\u73b0\u5728\u5c31\u591a\u4e86\u4e00\u4e2a\u6761\u4ef6\uff0c\u8fd9\u4e2a\u6570\u548c$m$\u4e92\u8d28\uff0c\u4e8e\u662f\u6211\u5c31\u53bb\u63a8\u5f0f\u5b50\u4e86\u3002\n\n\u5bb9\u65a5\u5bb9\u65a5\uff0c\u641e\u4e0d\u51fa\u6765\uff0c\u6837\u4f8b\u6ca1\u8fc7\u3002\u3002\u3002\n\n\u7136\u540e\u5c31\u53c2\u8003\u4e86$ywwywwyww$\u5de8\u4f6c\u7684\u9898\u89e3\uff01\n\n\u6211\u4eec\u5bb9\u65a5\u7684\u4e0d\u662f$\\lfloor\\frac n{i^2}\\rfloor$\u7684\u4e2a\u6570\u5417\uff1f\n\n\u5b83\u7684\u610f\u4e49\u662f\u4ec0\u4e48\uff1f\u4e0d\u5c31\u662f\u5e73\u65b9\u6570\u7684\u500d\u6570\u4e2a\u6570\u5417\uff1f\n\n\u53ea\u8981\u8fd9\u4e2a\u5e73\u65b9\u6570\u7684\u500d\u6570\u548c$m$\u4e92\u8d28\u4e0d\u5c31\u597d\u4e86\u5417\uff1f\uff1f\uff1f\n\n\u8bbe$p=i^2j$\u5c31\u662f\u8fd9\u4e2a\u5e73\u65b9\u6570\u7684\u4e2a\u6570\n\n\u5fc5\u987b\u8981\u6709$gcd(p,m)=1$\u3002\n\n\u5373$gcd(i^2j,m)=1$\u3002\n\n\u8bbe$h(i)$\u8868\u793a$i^2$\u7684\u500d\u6570\u4e2d\u4e0e$m$\u4e92\u8d28\u7684\u6570\u7684\u4e2a\u6570\n\n\u6240\u4ee5\u6211\u4eec\u73b0\u5728\u8981\u6c42\u7684\u4e0d\u5c31\u662f\n\n\u8bbe$\\lfloor \\frac nm\\rfloor=N$\n\n$$\\sum_{i=1}^{\\sqrt{N}}\\mu(i)h(i)\\ \\ ?$$\n\n\u7136\u540e\u600e\u4e48\u6c42$h$?\n\n\u6211\u7684\u601d\u8def\u548c\u5de8\u4f6c\u5c45\u7136\u662f\u7c7b\u4f3c\u7684\uff01\u60ca\u559c\uff01\uff01\uff01\n\n\u6211\u4eec\u5206\u7c7b\u8ba8\u8bba$i$\u548c$m$\u7684\u5173\u7cfb\u3002\n\n\u5982\u679c$gcd(i,m)!=1$\uff0c\u90a3\u4e48\u65e0\u8bba\u5982\u4f55$gcd(p,m)$\u90fd\u4e0d\u4f1a\u7b49\u4e8e$1$\u4e86\uff0c\u56e0\u4e3a$p=i^2j$\n\n\u6240\u4ee5$h(i)$\u76f4\u63a5\u7b49\u4e8e$0$\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u5426\u5219\uff0c\n$$h(i)=\\sum_{j=1}^{\\lfloor\\frac N{i^2}\\rfloor}[gcd(i^2j,m)==1]$$\n\n$$\\because gcd(i,m)==1$$\n\n$$h(i)=\\sum_{j=1}^{\\lfloor\\frac N{i^2}\\rfloor}[gcd(j,m)==1]$$\n\n\u8fd9\u4e2a\u7ee7\u7eed\u7528\u5957\u8def\n\n$$=\\sum_{j=1}^{\\lfloor\\frac N{i^2}\\rfloor}\\sum_{d|j,d|m}\\mu(d)\\ =\\ \\sum_{d|m}\\sum_{j=1}^{\\lfloor\\frac {\\lfloor\\frac N{i^2}\\rfloor}d\\rfloor}\\mu(d)$$\n\n$$=\\ \\sum_{d|m}\\mu(d)\\lfloor\\frac {\\lfloor\\frac N{i^2}\\rfloor}d\\rfloor$$\n\n\u679a\u4e3e$m$\u7684\u7ea6\u6570\u5c31\u53ef\u4ee5\u5feb\u901f\u8ba1\u7b97\u4e86\u3002\n\n\u7136\u540e\u8fd9\u9053\u9898\u5c31\u505a\u5b8c\u4e86\uff0c\u8bbe$m$\u6709$\\alpha $\u4e2a\u7ea6\u6570\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f$O(T\\alpha\\sqrt N)$\n\n\u5bf9\u4e86\u4e0d\u8981\u5fd8\u8bb0\u5916\u5c42\u8fd8\u6709\u4e00\u4e2a$\\mu(m)!!!$\n\n\u770b\u4e0d\u61c2\u7684\u8fd8\u53ef\u4ee5\u79c1\u4fe1\u95ee\u6211\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u975e\u5e38\u6076\u5fc3\uff1f\n\n```cpp\n// luogu-judger-enable-o2\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nll n,m,T,p[100001],d[100001],arfa,tot,vis[100001],mu[100001],MU[100001];\ninline void init(ll nx){\n    mu[1]=1;\n    for (register int i=2;i<=nx;i++){\n        if (!vis[i]) p[++tot]=i,mu[i]=-1;\n        for (register int j=1;j<=tot&&(ll)i*p[j]<=nx;j++){\n        \tif (1LL*i*p[j]>nx) continue;\n            vis[1LL*i*p[j]]=1;\n            if((i%p[j])==0){\n                mu[1LL*i*p[j]]=0;\n                break;\n            }\n            mu[1LL*i*p[j]]=-mu[i];\n        }\n    }\n}\nll Mu(ll a){//\u6c42\u5355\u4e2a\u6570\u7684\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\n    if (a<=35001) return mu[a];\n    ll x=a,cnt=0;\n    for (ll j=2;j*j<=a;j++){\n        if (x%j==0){\n        \tll now=0;\n            while (x%j==0) now++,x/=j;\n            if (now>1) return 0;\n            cnt++;\n        }\n    }\n    if (x!=1) cnt++;\n    return (cnt&1)?-1:1;\n}\ninline ll h(ll I){\n    if (__gcd(I,m)!=1) return 0;\n    ll ans=0;\n    for (int i=1;i<=arfa;i++){\n        ans+=MU[i]*(n/m/(I*I)/d[i]);\n    }\n    return ans;\n}\nint main(){\n    init(35005);\n    cin>>T;\n    while (T--){\n        cin>>n>>m;\n        arfa=0;\n        for (int i=1;i*i<=m;i++){\n            if (m%i==0) d[++arfa]=m/i,d[++arfa]=i;//\u679a\u4e3e\u56e0\u6570\n        }\n        if (d[arfa]==d[arfa-1]) d[arfa--]=0;\n        for (int i=1;i<=arfa;i++){\n            MU[i]=Mu(d[i]);//\u9884\u5904\u7406\u6bcf\u4e00\u4e2a\u56e0\u6570\u7684\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\n        } \n        ll ans=0;\n        for (register int i=1;i*i<=n/m;i++){\n            ans+=mu[i]*h(i);\n        }\n        printf(\"%lld\\n\",Mu(m)*ans);\n    }\n}\n```",
        "postTime": 1557056053,
        "uid": 20309,
        "name": "Fading",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5348 \u3010\u5bc6\u7801\u89e3\u9501\u3011"
    },
    {
        "content": "\u5982\u679c\u9700\u8981\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\u8bf7\u5230\u6211\u7684[$\\texttt{blog}$](https://www.cnblogs.com/cj-xxz/p/10812358.html)\n\n\u8bb0$N =  \\dfrac nm$\n\n\u8fd9\u9053\u9898\u76ee\u5c31\u662f\u8981\u6c42$a_m = \\sum_{i=1}^N \\mu(i)\\mu(im)$\n\n\u56e0\u4e3a$\\mu(ij) = \\mu(i)\\mu(j)[\\gcd(i, j) = 1]$\n\n\u6240\u4ee5$a_m = \\mu(m)\\sum_{i=1}^N \\mu^2(i) [\\gcd(i, m) = 1]$\n\n\u8bbe$\\mathbf S(n, m) = \\sum_{i=1}^n \\mu^2(i)[\\gcd(i, m) = 1]$\n\n\u5219\u6709\uff1a\n\n$$\\begin{aligned}\\mathbf S(n, m) &= \\sum_{i=1}^n\\mu^2(i)\\sum_{d|i, d|m}\\mu(d) \\\\&= \\sum_{d|m} \\mu(d) \\sum_{d|i}^n \\mu^2(i) \\\\&= \\sum_{d|m} \\mu(d) \\sum_{i=1}^{n/d} \\mu^2(id) \\\\&= \\sum_{d|m} \\mu(d) \\sum_{i=1}^{n/d} \\mu^2(i)\\mu^2(d)[\\gcd(i, d) = 1] \\\\&= \\sum_{d|m} \\mu^3(d) \\sum_{i=1}^{n/d} \\mu^2(i)[\\gcd(i, d) = 1] \\\\&= \\sum_{d|m} \\mu(d) \\mathbf S\\left(\\left\\lfloor\\frac nd \\right\\rfloor, d\\right)\\end{aligned}$$\n\n\u4e8e\u662f\u5c31\u53ef\u4ee5\u9012\u5f52\u5904\u7406\u4e86\u3002\n\n\u4e0d\u8fc7\u6570\u636e\u592a\u6c34\uff0c$\\mathrm{O}(\\sqrt n)$\u6c42$\\mu$\u90fd\u53ef\u4ee5\u8fc7\uff0c\u4e0a\u9762\u90a3\u4e2a\u4e1c\u897f\u4e0d\u8bb0\u5fc6\u5316\u90fd\u53ef\u4ee5\u8fc7\uff0c\u4e5f\u662f\u6bd2\u7624\u4e86\u3002",
        "postTime": 1557032132,
        "uid": 46800,
        "name": "xgzc",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5348 \u3010\u5bc6\u7801\u89e3\u9501\u3011"
    },
    {
        "content": "\u9898\u76ee\u5927\u610f\uff1a\u7ed9\u4f60 $n',m$\uff0c\u6709 $\\sum_{i\\mid j}a_j=\\mu(i)[i\\leq n']$\uff0c\u6c42 $a_m$\u3002$m\\leq {10}^9,\\frac{n'}{m}\\leq {10}^9$\u3002\n\n\u5148\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u4e00\u4e0b\uff0c\u4ee4 $n=\\frac{n'}{m}$\u3002\u90a3\u4e48 $a_m=\\sum_{i=1}^n\\mu(i)\\mu(im)=\\mu(m)\\sum_{i=1}^n[\\gcd(i,m)=1]\\mu^2(i)$\u3002\n\n\u8003\u8651\u65e0\u5e73\u65b9\u56e0\u5b50\u6570\u662f\u600e\u4e48\u7b97\u7684\uff0c\u5c31\u662f\u679a\u4e3e\u6bcf\u4e2a\u5b8c\u5168\u5e73\u65b9\u6570 $i^2$\uff0c\u7136\u540e\u8ba1\u7b97 $i^2$ \u7684\u500d\u6570\uff0c\u5bb9\u65a5\u4e00\u4e0b\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u5b8c\u5168\u5e73\u65b9\u6570 $i^2$\uff0c\u5982\u679c $\\gcd(i,m)=1$\uff0c\u90a3\u4e48 $\\gcd(i^2j,m)=\\gcd(j,m)$\uff0c\u5c31\u53ea\u7528\u6c42 $\\sum_{j=1}^\\frac{n}{i^2}[\\gcd(m,j)=1]$\uff0c\u518d\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u4e00\u4e0b\u5c31\u80fd\u7b97\u4e86\uff1b\n\n\u5982\u679c $\\gcd(i,m)\\neq 1$\uff0c\u90a3\u4e48 $\\gcd(i^2j,m)\\neq 1$\uff0c\u8d21\u732e\u5c31\u662f $0$ \u4e86\u3002\n\n\u590d\u6742\u5ea6\u4e0d\u4f1a\u7b97\u3002\u4e0a\u9650\u662f $O(\\sqrt n\\sigma_0(m))$\u3002",
        "postTime": 1556983761,
        "uid": 153599,
        "name": "ywwywwyww",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5348 \u3010\u5bc6\u7801\u89e3\u9501\u3011"
    },
    {
        "content": "\u76ee\u524d\u6700\u4f18\u89e3,\u6b22\u8fce\u540a\u6253\u3002\n\n**\u9898\u610f:**\n\n\u6709$(d\\leq n)\\ \\mu(d)=\\sum\\limits_{d|i}^nf(i)$,\u6ce8\u610f\u8fd9\u5e76\u4e0d\u662f\u72c4\u5229\u514b\u96f7\u5377\u79ef\u3002\n\n\u6c42$f(m)$\u3002\n\n\u5148\u500d\u6570\u53cd\u6f14\u4e00\u4e0b\u5f97\u5230:\n\n$f(m)=\\sum\\limits_{k=1}^\u221e\\mu(k)\\mu(mk)[mk\\leq n]$\n\n**\u8bbe** $N=\\left\\lfloor\\dfrac{n}{m}\\right\\rfloor$\n\n$=\\sum\\limits_{k=1}^N\\mu(k)\\mu(mk)$\n\n$=\\mu(m)\\sum\\limits_{k=1}^N\\mu^2(k)[m\\perp k]$\n\n\u8bbe$G(n,m)=\\sum\\limits_{k=1}^n\\mu^2(k)[m\\perp k]$\n\n\u53cd\u6f14\u4e00\u4e0b$=\\sum\\limits_{k=1}^n\\mu^2(k)\\sum\\limits_{d|m,d|k}\\mu(d)$\n\n$=\\sum\\limits_{d|m}\\mu(d)\\sum\\limits_{d|k}^n\\mu^2(k)$\n\n$=\\sum\\limits_{d|m}\\mu(d)\\sum\\limits_{k=1}^{n/d}\\mu^2(kd)$\n\n$=\\sum\\limits_{d|m}\\mu^3(d)\\sum\\limits_{k=1}^{n/d}\\mu^2(k)[d\\perp k]$\n\n$=\\sum\\limits_{d|m}\\mu(d)G\\left(\\left\\lfloor\\dfrac{n}{d}\\right\\rfloor,d\\right)$\n\n\u8fb9\u754c\u5c31\u662f$G(0,m)=0;G(n,1)=\\sum\\limits_{k=1}^n\\mu^2(k)$\n\n\u8bbe$S(n)=\\sum\\limits_{k=1}^n\\mu^2(k)$,\u6c42\u6cd5\u89c1[SP4168 SQFREE](https://www.luogu.org/problem/SP4168),\u4f3c\u4e4e\u53ef\u4ee5\u505a\u5230$O(n^{0.33})$\n\n\u6309\u7167\u8fd9\u4e2a\u9012\u63a8\u6c42$G$\u5c31\u597d\u4e86,\u6211\u4eec\u6765\u4f18\u5316\u4e00\u4e0b:\n\n**\u4f18\u5316** : \u6ce8\u610f\u5230$G(n,m)$\u4e2d\u7684$n$\u90fd\u662f$N$\u9664\u4ee5\u67d0\u4e9b\u6570\u7684\u6765\u7684,\u6240\u4ee5\u53d6\u503c\u53ea\u6709$O(\\sqrt{n})$\u79cd\u3002\n\n\u6211\u4eec\u628a$S(n)$\u8bb0\u5fc6\u5316\u4e00\u4e0b,\u518d\u9884\u5904\u7406\u4e00\u90e8\u5206,\u590d\u6742\u5ea6\u79ef\u5206\u51fa\u6765\u5927\u7ea6\u662f$O(N^\\frac{5}{9})$\u3002\n\n**\u4f18\u5316** : \u6211\u4eec\u6bcf\u6b21\u53ea\u679a\u4e3e$\\mu(d)\u22600$\u7684$d$\u3002\n\n\u90a3\u4e48$10^9$\u4ee5\u5185\u53ea\u80fd\u6709$9$\u4e2a\u4e0d\u540c\u8d28\u56e0\u5b50\u3002\n\n\u53ea\u80fd\u4ea7\u751f$2^9$\u79cd\u4e0d\u540c\u7684$d$\u3002\n\n**\u4f18\u5316** : \u4e8b\u5148\u628a$m$\u5206\u89e3,\u7136\u540e\u538b\u4f4d\u5b58\u50a8\u7d20\u56e0\u5b50,\u679a\u4e3e\u56e0\u6570\u5c31\u53d8\u6210\u4e86\u679a\u4e3e\u5b50\u96c6\u3002\n\n\u6c42$\\mu$\u53ef\u4ee5\u6570\u4e8c\u8fdb\u5236\u4e0b1\u7684\u4e2a\u6570\u3002\n\n\u8bb0$\\alpha(m)$\u4e3a$m$\u7684\u4e0d\u540c\u7d20\u56e0\u5b50\u4e2a\u6570($\\leq 9$)\u3002\n\n\u8fd9\u6837\u5b50\u603b\u590d\u6742\u5ea6\u5927\u7ea6\u662f$O(T(3^{\\alpha(m)}logN+N^\\frac{5}{9}))$,\u5e72\u8106\u53ef\u4ee5\u7406\u89e3\u6210\u7384\u5b66\u3002\n\n**Code:**\n\n\u8fd9\u9898\u6570\u636e\u8fc7\u6c34,$S$**\u4e0d**\u9884\u5904\u7406,**\u4e0d**\u8bb0\u5fc6\u5316\u53cd\u800c\u66f4\u5feb\u3002\n\n```cpp\n// luogu-judger-enable-o2\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\n#include<map>\n#define ll long long\n#define MaxLim 505000\n#define MaxS 666\nusing namespace std;\nint tn,p[MaxLim/10],mu[MaxLim],S[MaxLim];\nbool e[MaxLim];\nll dmu[MaxS];int dc[MaxS];\nvoid getsth()\n{\n  mu[1]=1;e[1]=1;\n  for (int i=2;i<=500000;i++){\n  \tif (!e[i]){\n  \t  p[++tn]=i;\n  \t  mu[i]=-1;\n    }\n  \tfor (int j=1;j<=tn&&i*p[j]<=500000;j++){\n  \t  e[i*p[j]]=1;\n  \t  if (i%p[j]==0)break;\n  \t  mu[i*p[j]]=-mu[i];\n  \t}\n  }for (int i=1;i<=500000;i++){\n    S[i]=S[i-1]+(mu[i]!=0);\n    mu[i]+=mu[i-1];\n  }\n  dc[0]=dmu[0]=1;\n  for (int i=1;i<(1<<9);i++)\n     dmu[i]=(i&1) ? -dmu[i>>1] : dmu[i>>1];\n}\nmap<int,int> sav;\nint getS(int n)\n{\n  if (n<=500000)return S[n];\n  if (sav.count(n))return sav[n];\n  int sum=0;\n  for (int l=1,r;l<=n;l=r+1) {\n    if (n/(l*l)==0)break;\n    r=sqrt(n/(n/(l*l)));\n    sum+=n/(l*l)*(mu[r]-mu[l - 1]);\n  }return sav[n]=sum;\n}\nll getG(int n,int ds)\n{\n  if (!n)return 0;\n  ll ans=0;\n  for (int i=ds;i;i=(i-1)&ds)\n    ans+=dmu[i]*getG(n/dc[i],i);\n  ans+=getS(n);\n  return ans;\n}\nll n;int m,tot;\nbool preD()\n{\n  int sav=m,cnt=0; tot=0;\n  for (int i=2;i*i<=sav;i++)\n    if (sav%i==0){\n      for (int s=0;s<(1<<tot);s++)\n        dc[s|(1<<tot)]=dc[s]*i;\n      tot++;cnt=0;\n      while(sav%i==0)\n        {sav/=i;cnt++;}\n      if (cnt>1)return 0;\n    }\n  if (sav>1){\n    for (int s=0;s<(1<<tot);s++)\n      dc[s|(1<<tot)]=dc[s]*sav;\n    tot++;\n  }return 1;\n}\nvoid solve()\n{\n  scanf(\"%lld%d\",&n,&m);\n  n/=m;\n  if (!preD())puts(\"0\");\n  else printf(\"%lld\\n\",\n    dmu[(1<<tot)-1]*getG(n,(1<<tot)-1)\n  );\n}\nint main()\n{\n  getsth();\n  int T;scanf(\"%d\",&T);\n  while(T--)solve();\n  return 0;\n}\n```\n",
        "postTime": 1566969918,
        "uid": 58705,
        "name": "command_block",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5348 \u3010\u5bc6\u7801\u89e3\u9501\u3011"
    },
    {
        "content": "\u9996\u5148,\u58f0\u660e\u4e00\u4e0b,\u6211\u7684\u65b9\u6cd5\u7531\u4e8e\u9700\u8981\u4f7f\u7528$map$\u8fdb\u884c\u8bb0\u5fc6\u5316MLE\n\n\u4f46\u662f\u672c\u7740~~\u53e3\u80e1~~\u6c42\u77e5\u7684\u7cbe\u795e,\u6211\u51b3\u5b9a\u5c06\u81ea\u5df1\u624b\u63a8\u4e86\u534a\u5929\u7684\u5f0f\u5b50\u642c\u4e0a\u6765,\u4e5f\u7b97\u63d0\u4f9b\u4e00\u79cd\u65b0\u601d\u8def,\u53cd\u6b63\u9898\u89e3\u4e5f\u53ea\u662f\u63d0\u4f9b\u4e00\u4e0b\u601d\u8def\n\n\u5f53\u7136,\u5982\u679c\u8c01\u53d1\u73b0\u6211\u9519\u4e86\u4e00\u5b9a\u8981\u63d0\u9192\u6211\u8865\u9505\n\n\u9996\u5148\u6211\u4eec\u8003\u8651\u6211\u4eec\u8bbe$f(x)$\u4e3a\u5e8f\u5217\u4e2d\u7684\u7b2c$x$\u9879\n\n$F(x)=\\mu(x)=\\sum\\limits_{x|d}f(d)$\n\n\u53cd\u6f14\u6709$f(x)=\\sum\\limits_{x|d}\\mu(d)F(\\dfrac {d} {x})=\\sum\\limits_{x|d}\\mu(d)\\mu(\\dfrac {d} {x})$\n\n\u90a3\u4e48\u6211\u4eec\u8981\u6c42\u7684\u7b2c$m$\u9879\n\n$f(m)=\\sum\\limits_{m|d}\\mu(d)\\mu(\\dfrac {d} {m})$\n\n\u6211\u4eec\u6539\u4e3a\u6c42\u548c\u5f62\u5f0f\n\n$f(m)=\\sum_{i=1}^{\\left\\lfloor\\frac {n} {m}\\right\\rfloor}\\mu(im)\\mu(i)$\n\n$=\\sum_{i=1}^{\\left\\lfloor\\frac {n} {m}\\right\\rfloor}\\mu(m)\\mu(i)^2[i\\bot m]$\n\n$=\\mu(m)\\sum_{i=1}^{\\left\\lfloor\\frac {n} {m}\\right\\rfloor}\\mu(i)^2[i\\bot m]$\n\n\u8bb0$T(x,y)=\\sum_{i=1}^x\\mu(i)^2[i\\bot y]$\n\n\u90a3\u4e48\u6240\u6c42\u5c31\u662f$\\mu(m)T(\\left\\lfloor\\dfrac {n} {m}\\right\\rfloor,m)$\n\n\u9996\u5148$m$\u4e2d\u662f\u5426\u6709\u5e73\u65b9\u8d28\u56e0\u5b50\u5bf9\u662f\u5426\u4e92\u8d28\u65e0\u5f71\u54cd,\u63d0\u524d\u6d88\u9664\n\n\u8003\u8651$m$\u7684\u8d28\u56e0\u5b50$p$\n\n\u6211\u4eec\u6709$T(\\left\\lfloor\\dfrac {n} {m}\\right\\rfloor,m)=\\sum_{i=1}^{\\left\\lfloor\\frac {n} {m}\\right\\rfloor}\\mu(i)^2[i\\bot m]$\n\n$=\\sum_{i=1}^{\\left\\lfloor\\frac {n} {m}\\right\\rfloor}\\mu(i)^2[i\\bot \\dfrac{m} {p}]-\\sum_{i=1}^{\\left\\lfloor\\frac {n} {m}\\right\\rfloor}\\mu(i)^2[i\\bot \\dfrac{m} {p}][p|i]$\n\n$=T(\\left\\lfloor\\dfrac {n} {m}\\right\\rfloor,\\dfrac {m} {p})-\\sum_{i=1}^{\\left\\lfloor\\frac {n} {mp}\\right\\rfloor}\\mu(ip)^2[ip\\bot \\dfrac {m} {p}]$\n\n\u5bf9\u5e73\u65b9\u56e0\u5b50\u4e0d\u4e88\u8003\u8651\n\n$=T(\\left\\lfloor\\dfrac {n} {m}\\right\\rfloor,\\dfrac {m} {p})-\\sum_{i=1}^{\\left\\lfloor\\frac {n} {mp}\\right\\rfloor}\\mu(i)^2\\mu(p)^2[i\\bot p][i\\bot \\dfrac {m} {p}]$\n\n$=T(\\left\\lfloor\\dfrac {n} {m}\\right\\rfloor,\\dfrac {m} {p})-\\mu(p)^2\\sum_{i=1}^{\\left\\lfloor\\frac {n} {mp}\\right\\rfloor}\\mu(i)^2[i\\bot m]$\n\n$=T(\\left\\lfloor\\dfrac {n} {m}\\right\\rfloor,\\dfrac {m} {p})-\\mu(p)^2T({\\left\\lfloor\\dfrac {n} {mp}\\right\\rfloor},m)$\n\n$=T(\\left\\lfloor\\dfrac {n} {m}\\right\\rfloor,\\dfrac {m} {p})-T({\\left\\lfloor\\dfrac {n} {mp}\\right\\rfloor},m)$\n\n\u8fb9\u754c\u662f$T(...,1)$\u6216\u8005$T(1,...)$\n\n\u524d\u8005\u76f8\u5f53\u4e8e\u6ca1\u6709\u5e73\u65b9\u56e0\u5b50\u6570\u7684\u4e2a\u6570,\u6709\u5f0f\u5b50$\\sum_{i=1}^n\\mu(i)^2=\\sum_{d=1}^{\\sqrt{n}}\\mu(d)\\left\\lfloor\\dfrac {n} {d^2}\\right\\rfloor$\n\n\u53ef\u4ee5$O(\\sqrt{n})$\u7b97\n\n\u540e\u8005\u4e0d\u5c31\u53ea\u6709$1$\u5417?\n\n\u4e8e\u662f\u6211\u4eec\u987a\u5229\u7684\u89e3\u51b3\u4e86\u8fd9\u9053\u9898\u76ee,\u9664\u4e86\u7a7a\u95f4\u5f00\u4e0d\u4e0b,\u8fd9\u4e2a\u7b97\u6cd5\u590d\u6742\u5ea6\u8fd8\u662f\u53ef\u4ee5\u8fc7\u7684",
        "postTime": 1580186871,
        "uid": 78290,
        "name": "Polaris_Dane",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5348 \u3010\u5bc6\u7801\u89e3\u9501\u3011"
    },
    {
        "content": "\u60f3\u8981\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\u8bf7\u5230\u6211\u7684[blog](https://www.cnblogs.com/cnyali-Tea/p/11519578.html)\n\n# Description\n\n\u7ed9\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6570\u7ec4 $a[1\\dots n]$ \uff0c\u6ee1\u8db3 $\\sum_{m|x}a[x] = \\mu(m)$\uff0c\u6c42 $a[m]$\u3002\n\n$n\\le 10^{18}, m\\le 10^9, \\frac{n}{m}\\le10^9,n\\geq m$\n\n# Solution\n\n\u7531\u53e6\u4e00\u79cd\u5f62\u5f0f\u7684\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff1a\n\n$$\\begin{aligned}a[m] &= \\sum_{m|x}\\mu(\\frac{x}{m})\\mu(x)\\\\&=\\sum_{i=1}^{\\frac{n}{m}}\\mu(i)\\mu(im)\\\\&=\\mu(m)\\sum_{i=1}^{\\lfloor\\frac{n}{m}\\rfloor}\\mu(i)^2[\\gcd(i, m) = 1]\\\\ \\end{aligned}$$\n\n**\u540e\u9762\u90a3\u4e2a $\\sum$ \u5c31\u662f\u5728\u6c42 $1\\dots \\frac{n}{m}$ \u4e2d\u4e0e $m$ \u4e92\u8d28\u4e14\u4e0d\u80fd\u5199\u6210\u5b8c\u5168\u5e73\u65b9\u6570\u7684\u500d\u6570\u7684\u4e2a\u6570\u3002**\n\n\u7c7b\u4f3c\u4e8e [[\u4e2d\u5c71\u5e02\u90092011]\u5b8c\u5168\u5e73\u65b9\u6570](https://endsah.cf/blog/BZOJ2440-%E5%AE%8C%E5%85%A8%E5%B9%B3%E6%96%B9%E6%95%B0/#more)\uff0c\u53ef\u4ee5\u5bb9\u65a5\u6c42\uff1a\n\n\u4ee4 $N = \\lfloor\\frac{n}{m}\\rfloor$\uff0c\n\n$$\\begin{aligned} a[m] &=\\mu(m)\\sum_{i=1}^{\\frac{n}{m}}\\mu(i)^2[\\gcd(i, m) = 1]\\\\&=\\mu(m)\\sum_{i=1}^{\\sqrt{N}}\\mu(i)\\sum_{j=1}^{\\lfloor\\frac{N}{i^2}\\rfloor}[\\gcd(i^2j,m)=1]\\\\&=\\mu(m)\\sum_{i=1}^{\\sqrt{N}}\\mu(i)[\\gcd(i,m)=1]\\sum_{j=1}^{\\lfloor\\frac{N}{i^2}\\rfloor}[\\gcd(j,m)=1]\\\\&=\\mu(m)\\sum_{i=1}^{\\sqrt{N}}\\mu(i)[\\gcd(i,m)=1]\\sum_{j=1}^{\\lfloor\\frac{N}{i^2}\\rfloor}\\sum_{d|\\gcd(j,m)}\\mu(d)\\\\&=\\mu(m)\\sum_{i=1}^{\\sqrt{N}}\\mu(i)[\\gcd(i,m)=1]\\sum_{d|m}\\mu(d)\\lfloor\\frac{\\lfloor\\frac{N}{i^2}\\rfloor}{d}\\rfloor\\end{aligned}$$\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u628a $m$ \u7684\u6240\u6709\u7ea6\u6570\u5904\u7406\u51fa\u6765\uff0c\u66b4\u529b\u7b97\uff08\u590d\u6742\u5ea6\u4e0a\u754c\u4e3a $O(T\\sqrt \\frac{n}{m} \\sqrt m)$\uff0c\u5b9e\u9645\u540e\u9762\u7684 $\\sqrt m$ \u8dd1\u4e0d\u6ee1\uff09\u3002\n\n\u6ce8\u610f$\\mu$\u8981\u7b5b\u5230$\\sqrt N$\u590d\u6742\u5ea6\u624d\u662f\u5bf9\u7684\uff08\u4e0d\u7136\u591a\u4e00\u4e2a\u6839\u53f7\uff09\u3002\n\n### code\n\n```cpp\n#include <bits/stdc++.h>\n\ntypedef long long LL;\ntypedef unsigned long long uLL;\n\n#define SZ(x) ((int)x.size())\n#define ALL(x) (x).begin(), (x).end()\n#define MP(x, y) std::make_pair(x, y)\n#define DEBUG(...) fprintf(stderr, __VA_ARGS__)\n#define GO cerr << \"GO\" << endl;\n\nusing namespace std;\n\ninline void proc_status()\n{\n\tifstream t(\"/proc/self/status\");\n\tcerr << string(istreambuf_iterator<char>(t), istreambuf_iterator<char>()) << endl;\n}\n\ntemplate<class T> inline T read() \n{\n\tregister T x(0);\n\tregister char c;\n\tregister int f(1);\n\twhile (!isdigit(c = getchar())) if (c == '-') f = -1;\n\twhile (x = (x << 1) + (x << 3) + (c xor 48), isdigit(c = getchar()));\n\treturn x * f;\n}\n\ntemplate<typename T> inline bool chkmin(T &a, T b) { return a > b ? a = b, 1 : 0; }\ntemplate<typename T> inline bool chkmax(T &a, T b) { return a < b ? a = b, 1 : 0; }\n\nconst int maxN = 1e5;\n\nbool vis[maxN + 1];\nvector<int> prime;\nint mu[maxN + 1];\nLL n, m;\n\nvoid Init()\n{\n\tmu[1] = 1;\n\tfor (int i = 2; i <= maxN; ++i)\n\t{\n\t\tif (!vis[i])\n\t\t{\n\t\t\tprime.push_back(i);\n\t\t\tmu[i] = -1;\n\t\t}\n\t\tfor (int j = 0; j < SZ(prime) and prime[j] * i <= maxN; ++j)\n\t\t{\n\t\t\tvis[prime[j] * i] = 1;\n\t\t\tif (i % prime[j] == 0)\n\t\t\t\tbreak;\n\t\t\telse \n\t\t\t\tmu[i * prime[j]] = -mu[i];\n\t\t}\n\t}\n}\n\nint Mu(LL M)\n{\n\tif (M <= maxN) return mu[M];\n\t//GO;\n\tint cnt = 0;\n\tfor (LL i = 2; i * i <= M; ++i)\n\t\tif (M % i == 0)\n\t\t{\n\t\t\tM /= i;\n\t\t\tcnt++;\n\t\t\tif (M % i == 0)\n\t\t\t\treturn 0;\n\t\t}\n\tif (M != 1) cnt++;\n\treturn (cnt & 1) ? -1 : 1;\n}\n\nvector<pair<LL, int> > p;\n\nLL calc(LL i)\n{\n\tLL ans(0);\n\tfor (int l = 0; l < SZ(p); ++l)\n\t\tans += (LL)p[l].second * (((n / m) / (i * i)) / p[l].first);\n\treturn ans;\n}\n\nvoid GetP(LL m)\n{\n\tp.clear();\n\tfor (LL d = 1; d * d <= m; ++d)\n\t\tif (m % d == 0)\n\t\t{\n\t\t\tp.push_back(MP(d, Mu(d)));\n\t\t\tif (m / d == d) continue;\n\t\t\tp.push_back(MP(m / d, Mu(m / d)));\n\t\t}\n}\n\nvoid Solve()\n{\n\tint T = read<int>();\n\twhile (T--)\n\t{\n\t\tn = read<LL>(), m = read<LL>();\n\n\t\tGetP(m);\n\n\t\tLL ans(0);\n\t\tfor (LL i = 1; i * i <= (n / m); ++i)\n\t\t\tif (__gcd((LL)i, m) == 1)\n\t\t\t\tans += Mu(i) * calc(i);\n\t\tans *= Mu(m);\n\n\t\tprintf(\"%lld\\n\", ans);\n\t}\n}\n\nint main() \n{\n#ifndef ONLINE_JUDGE\n\tfreopen(\"xhc.in\", \"r\", stdin);\n\tfreopen(\"xhc.out\", \"w\", stdout);\n#endif\n\tInit();\n\tSolve();\n\treturn 0;\n}\n```",
        "postTime": 1568452406,
        "uid": 103989,
        "name": "VegTea",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5348 \u3010\u5bc6\u7801\u89e3\u9501\u3011"
    },
    {
        "content": "\u4ee4 $F(n,m)=\\sum_{i=1}^n\\mu(i)\\mu(i*m)=\\mu(m)\\sum_{d|m}\\mu(d)\\sum_{i=1}^{\\frac{n}{d}}\\mu^2(id)=\\mu(m)\\sum_{d|m}F(\\frac{n}{d},d)$\n\n\u7b54\u6848\u5c31\u662f$F(\\frac{n}{m},m)$\n\n",
        "postTime": 1557062407,
        "uid": 39243,
        "name": "flukehn",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5348 \u3010\u5bc6\u7801\u89e3\u9501\u3011"
    }
]
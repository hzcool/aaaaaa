[
    {
        "content": "[\u70b9\u6211\u4e86\u89e3\u8be6\u60c5(\u00b4\u25bd`)\uff89 ](https://hatate.cn/2018/09/17/usaco18openout-of-sorts-g/)\n<!--more-->\n\n\u63a8\u8350\u6211\u7684[\u535a\u5ba2](https://hatate.cn/)\n```cpp\nsorted = false\nwhile (not sorted):\n   sorted = true\n   moo\n   for i = 0 to N-2:\n      if A[i+1] < A[i]:\n         swap A[i], A[i+1]\n   for i = N-2 downto 0:\n      if A[i+1] < A[i]:\n         swap A[i], A[i+1]\n   for i = 0 to N-2:\n      if A[i+1] < A[i]:\n         sorted = false\n```\n\u95ee\u4e0a\u8ff0\u7a0b\u5e8f\u4f1a\u8f93\u51fa\u51e0\u6b21moo\u3002\n\n\u9996\u5148\u8bfb\u9898\uff0c\u77e5\u9053\u4ed6\u60f3\u8ba9\u4f60\u505a\u4ec0\u4e48\u3002\n\n\u5976\u725b\u7684\u4ee3\u7801\u5c31\u662f\u95ee\u4f60\u5982\u679c\u628a\u5192\u6ce1\u6392\u5e8f\u8be5\u6210\u53cc\u5411\u7684\u8981\u6392\u51e0\u6b21\u3002\n\n\u5982\u679c\u666e\u901a\u7684\u5192\u6ce1\uff0c\u90a3\u4e48\u4ed6\u7684\u904d\u6570= max {1\uff0c\u6bcf\u4e2a\u6570\u524d\u9762\u6709\u51e0\u4e2a\u6bd4\u5b83\u5927}\uff1b\n\n\u56e0\u4e3a\u4f60\u6bcf\u6b21\u4f1a\u628a\u4e00\u4e2a\u6bd4\u67d0\u4e2a\u6570\u5c0f\u7684\u6570\u79fb\u5230\u8fd9\u4e2a\u6570\u540e\u9762\u3002\n\n\u6211\u4eec\u5148\u79bb\u6563\u5316\uff0c\u6bcf\u4e2a\u6570\u7684\u503c\u4e3a\u4ed6\u7684\u6392\u540d\uff0c\u5c31\u662f\u7b2c\u51e0\u5927\u3002\n\n\u4f8b\u5982 100 1000 10000\u79bb\u6563\u5316\u540e\u662f1 2 3\uff1b\n\n\u540c\u7406\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u53cc\u5411\u5192\u6ce1\u6392\u5e8f\u904d\u6570=max{\u524d?\u4e2a\u4f4d\u7f6e\u4e0a\u503c>?\u7684\u6570\u6709\u591a\u5c11\u4e2a\uff0c1}\n\n\u6ce8\u610f\u5b83\u548c\u666e\u901a\u5192\u6ce1\u6392\u5e8f\u7684\u4e0d\u540c\u3002\n\n\u4e3a\u4ec0\u4e48\u7ed3\u8bba\u662f\u8fd9\u4e2a\uff1f\n\n\u56e0\u4e3a\u5bf9\u4e8e\u6bcf\u4e2a?\n\n1. \u5411\u540e\u626b\u4f1a\u4fdd\u8bc1\u628a\u524d ? \u4e2a\u4f4d\u7f6e\u4e0a\u4e00\u4e2a\u503c> ? \u7684\u6570\u6254\u5230\u540e\u8fb9\u53bb  \n2. \u5411\u524d\u626b\u4f1a\u4fdd\u8bc1\u88ab\u6362\u5230\u524d? \u4e2a\u4f4d\u7f6e\u4e0a\u7684\u65b0\u6570\u7684\u503c\u662f\u2264 ? \u7684\n\n\u5982\u679c\u4e0d\u61c2\u53ef\u4ee5\u770b\u4e0b\u9762\u3002\n\n\u62ff\u6837\u4f8b\u4e3e\u4f8b\n\n5\n\n1 8 5 3 2\n\n\u79bb\u6563\u5316\u540e 1 5 4 3 2\n\n\u4f4d\u7f6e\u4e3a &emsp;1 2 3 4 5\n\n\u4f8b\u5982i=3\n\n\u524d3\u4e2a\u6570\u5206\u522b\u662f1 5 4\n\n5\u548c4>3\n\n\u540e\u4e24\u4e2a\u6570\u5206\u522b\u662f 3 2\n\n3 2<=3\n\n\u6240\u4ee5\u6211\u4eec\u5c31\u6362\u4e86\u4e24\u6b21\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u6a21\u62df\u4e86\u3002\n\n\u61d2\u5f97\u6a21\u62df\u5199\u6811\u72b6\u6570\u7ec4\u4e5f\u884c\u3002\n\n\n````cpp\n#include <cstdio>\n#include <algorithm> \n\nusing namespace std;\nconst int N=100005;\n\nstruct data\n{\n    int val,num;\n    friend bool operator <(data x,data y){if(x.val==y.val)return x.num<y.num;return x.val<y.val;}\n}a[N];\nint n,ans=1,cnt;\nint vis[N];\nint main()\n{\n\tscanf(\"%d\",&n);\n    for(int i=1;i<=n;i++) scanf(\"%d\",&a[i].val),a[i].num=i;\n    sort(a+1,a+n+1);\n    for(int i=1;i<=n;i++)\n    {\n        if(i<a[i].num) cnt++;\n        if(vis[i]) cnt--;\n        vis[a[i].num]=true;\n        ans=max(ans,cnt);\n    }\n   printf(\"%d\",ans);\n}\n````",
        "postTime": 1537192883,
        "uid": 56757,
        "name": "Meepo",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4375 \u3010[USACO18OPEN]Out of Sorts G\u3011"
    },
    {
        "content": "\n### [P4375 Out of Sorts G](https://www.luogu.org/problem/P4375)\n### [\u535a\u5ba2](https://www.luogu.org/blog/hs-black/mao-pao-pai-xu-shen-ru-li-xie)\u5185\u98df\u7528\u6548\u679c\u66f4\u4f73\n\n\u9898\u610f:\u6c42\u53cc\u5411\u5192\u6ce1\u6392\u5e8f\u7684\u6392\u5e8f\u6b21\u6570\n\n### \u5bf9\u4e8e\u4e00\u4e2a\u5e8f\u5217, \u6211\u4eec\u79f0\u4e4b\u4e3a\u6709\u5e8f\u7684, \u5f53\u4e14\u4ec5\u5f53\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u4f4d\u7f6e\u524d\u9762\u6ca1\u6709\u6bd4\u5b83\u5927\u7684\u6570(\u53ef\u4ee5\u6a21\u62df\u4e00\u4e0b)\n\n\u6211\u4eec\u6682\u4e14\u79f0\u5b83\u4e3a\u5e73\u8861\u6761\u4ef6\u5427\n\n\u9996\u5148\u5c06\u5e8f\u5217\u79bb\u6563\u5316\n\n\u76f8\u6bd4\u8f83\u4e8eOut of Sorts S, \u672c\u9898\u601d\u8def\u5728\u4e8e\u4e0d\u52a8\u7684\u4f4d\u7f6e, \u7ed3\u8bba\u4e3a\u5bf9\u4e8e\u4f4d\u7f6ex, ans = max{ans, \u524d\u9762\u6709\u51e0\u4e2a\u6570\u7684\u6570\u503c\u5927\u4e8ex}\n\n\u4e3a\u4ec0\u4e48\u5462\n\n\u5728x\u4e0d\u6ee1\u8db3\u5e73\u8861\u6761\u4ef6\u7684\u65f6\u5019\n\n### \u9996\u5148\u7b2c\u4e00\u6ce2\u64cd\u4f5c\u7684\u65f6\u5019,\u5bf9\u4e8e\u524dx\u4e2a\u4f4d\u7f6e\u4e00\u5b9a\u4f1a\u6362\u51fa\u4e00\u4e2a\u5927\u4e8ex\u7684\u6570\n\n\u56e0\u4e3a\u5b83\u4e0d\u6ee1\u8db3\u5e73\u8861\u6761\u4ef6\n\n### \u7b2c\u4e8c\u6ce2\u64cd\u4f5c\u65f6, \u53c8\u4f1a\u6709\u4e00\u4e2a\u5c0f\u4e8e\u7b49\u4e8ex\u7684\u6570\u63d2\u56de\u6765\n\n\u56e0\u4e3a\u56de\u6765\u7684\u65f6\u5019\u4e00\u5b9a\u4f1a\u5192\u6ce1\u51fa\u4e00\u4e2a\u4f4d\u7f6e\u5728x\u540e\u7684\u6700\u5c0f\u503c, \u56e0\u4e3ax\u4e0d\u6ee1\u8db3\u5e73\u8861\u6761\u4ef6, \u6240\u4ee5\u6700\u5c0f\u503c\u5c0f\u4e8e\u7b49\u4e8ex, \u5c31\u53c8\u63d2\u4e86\u56de\u6765\n\n\u6709\u4eba\u53ef\u80fd\u4f1a\u95ee\u4e3a\u4ec0\u4e48Out of Sorts S\u4e0d\u80fd\u7528\u8fd9\u4e2a\u5f0f\u5b50\u561e, \u56e0\u4e3a\u6bcf\u6b21\u6362\u51fa\u7684\u4e00\u5b9a\u5927\u4e8ex, \u4f46x+1\u4f4d\u7f6e\u4e0a\u7684\u6570\u53ef\u80fd\u6362\u8fc7\u6765, \u800c\u5b83\u6709\u53ef\u80fd\u5927\u4e8ex\n\n\u7531\u6b64\u53ef\u77e5, \u6c42\u6bcf\u4e2a\u4f4d\u7f6e\u524d\u5927\u4e8e\u5176\u7684\u6570\u5c31\u884c\u5566\n\n\u4ee3\u7801:\n\n```\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nconst int N = 100500;\nint d[N], n;\nint read(void) {\n\tint x = 0;\n\tchar c = getchar();\n\twhile (!isdigit(c)) c = getchar();\n\twhile (isdigit(c)){\n\t\tx = (x << 3) + (x << 1) + c - '0';\n\t\tc = getchar();\n\t}\n\treturn x;\n}\nstruct node{\n\tint val, pos;\n\tbool operator < (const node &i) const{\n\t\tif (val == i.val) return pos < i.pos;\n\t\treturn val < i.val;\n\t}\n}p[N];\ninline int low(int x) {\n\treturn x & -x;\n}\nint get(int x) {\n\tint tmp = 0;\n\tfor (;x;x -= low(x)) tmp += d[x];\n\treturn tmp;\n}\nvoid add(int x) {\n\tfor (;x <= n; x += low(x)) d[x]++;\n}\nbool cmp(node i,node j) {\n\treturn i.pos < j.pos;\n}\nint main() {\n\tn = read();\n\tfor (int i = 1;i <= n; i++) p[i] = (node){read(),i};\n\tsort(p + 1,p + n + 1);\n\tfor (int i = 1;i <= n; i++) p[i].val = i;\n\tsort(p + 1,p + n + 1, cmp);\n\tint ans = 1;\n\tfor (int i = 1;i <= n; i++) {\n\t\tadd(p[i].val);\n\t\tans = max(ans, i - get(i));\n\t}\n\tprintf (\"%d\\n\", ans);\n\treturn 0;\n}\n/*\n6\n2 5 6 3 1 4\n\n*/\n```",
        "postTime": 1569155868,
        "uid": 122144,
        "name": "hs_black",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4375 \u3010[USACO18OPEN]Out of Sorts G\u3011"
    },
    {
        "content": "\u8003\u8651\u8fd9\u6837\u4e00\u4e2a\u4e8b\u60c5\uff0c\u5982\u679c\u6b63\u53cd\u6765\u4e86\u4e00\u8fb9\u90a3\u4e48\u6bcf\u4e00\u6b21\u5bf9\u4e8ei\u4f4d\u7f6e\u4e0a\u7684\u6570a[i]\u6765\u8bf4\u4ed6\u5de6\u8fb9\u4f4d\u7f6ej $\\in $ [1,i-1]\u6bd4a[i]\u4e25\u683c\u5927\u7684\u6570\u6709\u4e00\u4e2a\u88ab\u653e\u5230\u4e86i\u7684\u53f3\u8fb9\n\n\u4ed6\u53f3\u8fb9\u7684\u4f4d\u7f6ej$\\in $ [i+1,n]\u6bd4a[i]\u4e25\u683c\u5c0f\u7684\u6570\u6709\u4e00\u4e2a\u88ab\u653e\u5230\u4e86i\u7684\u5de6\u8fb9\u3002\u5f53\u4e14\u4ec5\u5f53a[i]\u5de6\u8fb9\u548c\u53f3\u8fb9\u4e0d\u5b58\u5728\u4e0a\u8ff0\u7684\u6570\u90a3\u4e48\u505c\u6b62\u3002\n\n\u5982\u679c\u628a\u4e00\u4e2a\u6570\u7ec4\u53d8\u4e3a\u6709\u5e8f\u663e\u7136\u7b2ci\u4e2a\u4f4d\u5b50\u4e0a\u653e\u7f6e\u7b2ci\u5927\u7684\u6570\u3002\n\n\u663e\u7136\u4ed6\u4eec\u7684\u4f4d\u7f6e\u4e00\u5b9a\u5728i\u4f4d\u7f6e\u540e\u9762\u3002\u6240\u6709\u81f3\u5c11\u9700\u8981\u79fb\u52a8\u8fd9\u4e48\u591a\u6b21\uff0c\u628a\u6bcf\u4e00\u4e2a\u6bd4i\u5927\u7684\u6570\u79fb\u52a8\u5230i\u7684\u53f3\u9762\u3002\n\n\u663e\u7136\u6211\u4eec\u5192\u6ce11\u6b21\u5bf9\u4e8e\u6bcf\u4e2ai\u5bf9\u5e94\u7684\u6709\u591a\u5c11\u6570\u5728\u4ed6\u5de6\u8fb9\u53ea\u80fd\u51cf\u5c111\u4e2a\u8fd9\u6837\u7684\u6570\uff0c\u6240\u4ee5\u7b54\u6848\u5c31\u662fmax{\u524di\u4e2a\u6570\u91cc\u9762\u6709\u591a\u5c11\u4e2a\u6570\u5b57\u79bb\u6563\u5316\u540e\u662f\u6bd4i\u5927\u7684\uff0c1}\n\n```\n# include <bits/stdc++.h>\nusing namespace std;\nconst int N=1e5+10;\nint c[N],n;\nstruct rec{int x,id;}a[N];\nbool cmp(rec a,rec b)\n{\n    if (a.x!=b.x) return a.x<b.x;\n    return a.id<b.id;\n}\nvoid update(int x){for (;x<=n;x+=x&-x) c[x]++;}\nint query(int x){int ret=0; for (;x;x-=x&-x) ret+=c[x]; return ret;}\nint main()\n{\n    scanf(\"%d\",&n);\n    for (int i=1;i<=n;i++)\n     scanf(\"%d\",&a[i].x),a[i].id=i;\n    sort(a+1,a+1+n,cmp);\n    int ans=1;\n    for (int i=1;i<=n;i++){\n        update(a[i].id);\n        ans=max(ans,i-query(i));\n    }\n    printf(\"%d\\n\",ans);\n    return 0;\n}\n\n```",
        "postTime": 1551454153,
        "uid": 16456,
        "name": "ljc20020730",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4375 \u3010[USACO18OPEN]Out of Sorts G\u3011"
    },
    {
        "content": "[\u535a\u5ba2\u98df\u7528\u66f4\u4f73](https://www.cnblogs.com/xixike/p/15472038.html)\n\n# Description\n\n[\u6d1b\u8c37\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4375)\n\n# Solution\n\n\u4e00\u9053\u5f88\u5de7\u5999\u7684\u7ed3\u8bba\u9898\u3002\n\n\u6211\u4eec\u89c2\u5bdf\u5230\u9898\u76ee\u4e2d\u662f\u4e00\u4e2a\u53cc\u5411\u5192\u6ce1\u6392\u5e8f\u3002\u7136\u540e\u95ee\u4f60\u8981\u8fdb\u884c\u591a\u5c11\u8f6e\u624d\u80fd\u6392\u597d\u5e8f\u3002\n\n\u6211\u4eec\u9996\u5148\u5bf9\u4e8e\u539f\u6570\u7ec4\u8fdb\u884c\u79bb\u6563\u5316\u3002\n\n\u8003\u8651\u5192\u6ce1\u6392\u5e8f\u7684\u8fc7\u7a0b\uff08\u5047\u8bbe\u5f53\u524d\u6570\u7ec4\u672a\u6392\u597d\u5e8f\uff09\uff1a\n\n- \u7b2c\u4e00\u6b21\uff1a\u627e\u51fa\u4e00\u4e2a\u6700\u5927\u503c\u653e\u5230\u6700\u540e\u9762\u3002\n\n  \u5bf9\u4e8e\u4f4d\u7f6e $x$\uff0c\u5192\u6ce1\u4e4b\u540e\u4e00\u5b9a\u6709\u4e00\u4e2a\u5927\u4e8e $x$ \u7684\u6570\u88ab\u653e\u5230\u4e86 $x$ \u540e\u9762\u3002\n\n- \u7b2c\u4e8c\u6b21\uff1a\u627e\u51fa\u4e00\u4e2a\u6700\u5c0f\u503c\u653e\u5230\u6700\u524d\u9762\u3002\n\n  \u540c\u7406\uff0c\u5bf9\u4e8e\u4f4d\u7f6e $x$\uff0c\u4e00\u5b9a\u6709\u4e00\u4e2a\u5c0f\u4e8e\u7b49\u4e8e $x$ \u7684\u503c\u653e\u5230\u4e86 $x$ \u7684\u524d\u9762\u3002\n\n\u8fd9\u6837\u4e00\u6765\uff0c\u76f8\u5f53\u4e8e\u628a $x$ \u524d\u9762\u7684\u4e00\u4e2a\u5927\u4e8e\u5b83\u7684\u6570\u548c\u5b83\u540e\u9762\u4e00\u4e2a\u5c0f\u4e8e\u7b49\u4e8e\u5b83\u7684\u6570\u4ea4\u6362\u4e86\u3002\n\n\u56e0\u6b64\uff0c\u7ed3\u8bba\u5c31\u662f\uff1a$$ans = max(ans, x \u524d\u9762\u5927\u4e8e x \u7684\u6570\u7684\u4e2a\u6570)$$\n\n\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u4e00\u4e0b\u5373\u53ef\u3002\n\n# Code\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n\nusing namespace std;\n\ninline int read(){\n    int x = 0, f = 1;\n    char ch = getchar();\n    while(ch < '0' || ch > '9') {if(ch == '-') f = -1; ch = getchar();}\n    while(ch >= '0' && ch <= '9') x = (x << 3) + (x << 1) + ch - '0', ch = getchar();\n    return x * f;\n}\n\nconst int N = 1e5 + 10;\nint n;\nstruct node{\n    int pos, val;\n    bool operator < (const node &b) const{\n        return val != b.val ? val < b.val : pos < b.pos;\n    }\n}p[N];\nint c[N];\n\ninline void update(int x){\n    for(; x <= n; x += x & (-x))\n        c[x]++;\n}\n\ninline int query(int x){\n    int res = 0;\n    for(; x; x -= x & (-x))\n        res += c[x];\n    return res;\n}\n\nint main(){\n    n = read();\n    for(int i = 1; i <= n; ++i){\n        p[i].val = read();\n        p[i].pos = i;\n    }\n    sort(p + 1, p + 1 + n);\n    int ans = 1;\n    for(int i = 1; i <= n; ++i){\n        update(p[i].pos);\n        ans = max(ans, i - query(i));\n    }\n    printf(\"%d\\n\", ans);\n    return 0;\n}\n```\n\n# End",
        "postTime": 1635329217,
        "uid": 158846,
        "name": "xixike",
        "ccfLevel": 0,
        "title": "P4375 [USACO18OPEN]Out of Sorts G \u9898\u89e3"
    },
    {
        "content": "\u4e00\u9053\u73c2\u7231\u5e76\u4e14\u55b5\u55b5\u7684\u53ef\u7231\u9898\u3002\n\n## \u9898\u76ee\u7b80\u8ff0\n\n- \u6c42\u53cc\u91cd\u5192\u6ce1\u6392\u5e8f\u5faa\u73af\u6b21\u6570\u3002\n- $n\\leq10^5$\u3002\n\n## \u9898\u76ee\u5206\u6790\n\n\u6211\u4eec\u5148\u8bf4\u7ed3\u8bba\uff0c\u5047\u8bbe $a$ \u5df2\u7ecf\u7ecf\u5386\u8fc7\u79bb\u6563\u5316\uff0c\u90a3\u4e48\u7b54\u6848\u662f\uff1a\n\n$$\\max_{i=1}^n \\{\\sum_{j=1}^i [a_j>i]\\}$$\n\n\u6211\u4eec\u8bc1\u660e\u4e00\u4e0b\u3002\n\n\u8fd9\u4e2a\u5f0f\u5b50\u5176\u5b9e\u5c31\u662f\u5728 $[1,i]$ \u4e2d\u4e0d\u5c5e\u4e8e\u8fd9\u4e2a\u533a\u95f4\u7684\u6570\u7684\u4e2a\u6570\u3002\n\n\u6bcf\u4e00\u6b21\u5982\u679c $[1,i]$ \u6ca1\u6709\u6392\u5e8f\u597d\uff0c\u5de6\u5192\u6ce1\u8d70\u6389\u7684\u80af\u5b9a\u4e0d\u5c5e\u4e8e\u8fd9\u4e2a\u533a\u95f4\uff0c\u5e76\u4e14\u53f3\u5192\u6ce1\u80af\u5b9a\u4f1a\u8865\u56de\u6765\u4e00\u4e2a\uff0c\u6240\u4ee5\u5355\u72ec\u5bf9\u4e8e\u8fd9\u4e2a\u533a\u95f4\u6765\u8bf4\u5c31\u9700\u8981 $\\sum_{j=1}^i [a_j>i]$ \u7684\u6b21\u6570\u3002\n\n\u90a3\u4e48\u6392\u5e8f\uff0c\u5c31\u662f\u8981\u5bf9\u4efb\u610f\u7684 $i$\uff0c\u4e0b\u6807\u4e3a $[1,i]$ \u7684\u6570\u5f53\u4e2d\u53ea\u6709 $[1,i]$ \u6240\u4ee5\u7ed3\u8bba\u5f97\u8bc1\u3002\n\n## \u53c2\u8003\u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nconst int MAXN=1e5+5;\nint n;\nstruct node{\n\tint val,id;\n}a[MAXN];\nbool cmp1(node x,node y){return ((x.val!=y.val)?x.val<y.val:x.id<y.id);}\nbool cmp2(node x,node y){return x.id<y.id;}\nint t[MAXN];\nint lowbit(int x){\n\treturn x&(-x);\n}\nvoid add(int x){\n\twhile(x<=n){\n\t\tt[x]++;\n\t\tx+=lowbit(x);\n\t}\n}\nint que(int x){\n\tint res=0;\n\twhile(x>0){\n\t\tres+=t[x];\n\t\tx-=lowbit(x);\n\t}\n\treturn res;\n}\nint main(){\n\tcin>>n;\n\tfor(int i=1;i<=n;i++)\n\t\tcin>>a[i].val,a[i].id=i;\n\tsort(a+1,a+n+1,cmp1);\n\tfor(int i=1;i<=n;i++)\n\t\ta[i].val=i;\n\tsort(a+1,a+n+1,cmp2);\n\tint ans=1;\n\tfor(int i=1;i<=n;i++){\n\t\tadd(a[i].val);\n\t\tans=max(ans,i-que(i));\n\t}\n\tcout<<ans<<endl;\n}\n```\n",
        "postTime": 1647771920,
        "uid": 248400,
        "name": "Inaba_Meguru",
        "ccfLevel": 7,
        "title": "P4375 [USACO18OPEN]Out of Sorts G \u9898\u89e3"
    },
    {
        "content": "\u672c\u9898\u7684\u7ed3\u8bba\uff1a\u6700\u7ec8\u7b54\u6848\u4e3a\u5bf9\u4e8e\u6bcf\u4e2a\u4f4d\u7f6e\uff0c\u5728\u8fd9\u4e2a\u4f4d\u7f6e\u4e4b\u524d\u6bd4\u5b83\u5927\u7684\u6570\u7684\u603b\u6570\u4e2d\u7684\u6700\u5927\u503c\u3002\n\n\u8003\u8651\u5976\u725b\u7684\u4ee3\u7801\u4e2d\u6bcf\u6b21\u6392\u5e8f\u5b9e\u9645\u4e0a\u662f\u628a\u4e00\u4e2a\u6700\u5c0f\u5143\u7d20\u653e\u7f6e\u5230\u6700\u524d\u9762\uff0c\u6700\u5927\u5143\u7d20\u653e\u5728\u6700\u540e\u9762\uff0c\u4e8e\u662f\u5bf9\u4e8e\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u7b49\u4ef7\u4e8e\u628a\u4e00\u4e2a\u6bd4\u5b83\u5927\u7684\u5143\u7d20\u548c\u4e00\u4e2a\u6bd4\u5b83\u5c0f\u7684\u5143\u7d20\u4ea4\u6362\uff0c\u5176\u4f59\u4e0d\u53d8\u3002\n\n\u4f46\u662f\u7531\u4e8e\u6570\u636e\u7684\u8303\u56f4\u592a\u5927\uff0c\u76f4\u63a5\u7ef4\u62a4\u96be\u4ee5\u901a\u8fc7\uff0c\u8003\u8651\u79bb\u6563\u5316\u540e\u6c42\u6392\u540d\uff0c\u6700\u540e\u7528\u6392\u540d\u4f5c\u4e3a\u5176\u5927\u5c0f\u91cd\u65b0\u6392\u5e8f\u4e00\u904d\u4e4b\u540e\u8fdb\u884c\u7ef4\u62a4\u3002\n\n\u8fd9\u662f\u4e00\u4e2a\u652f\u6301\u5355\u70b9\u4fee\u6539\u548c\u533a\u95f4\u67e5\u8be2\u7684\u6570\u636e\u7ed3\u6784\uff0c\u53ef\u4ee5\u7528\u6811\u72b6\u6570\u7ec4\u5b9e\u73b0\uff0c\u4f46\u8fd9\u91cc\u4f7f\u7528 LCT \u5b9e\u73b0\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $ \\mathcal{O}(n \\log{n}) $\uff0c\u5b9e\u9645\u8fd0\u884c\u6548\u7387\u5341\u5206\u611f\u4eba\uff0c\u4e0d\u5f00\u6c27\u6c14\u559c\u63d0\u6700\u52a3\u89e3\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define int long long//\u4fdd\u9669\nconst int maxn=2e5+10;\ninline int read()\n{\n    int x=0,f=1;char ch=getchar();\n    while (ch<'0'||ch>'9'){if (ch=='-') f=-1;ch=getchar();}\n    while (ch>='0'&&ch<='9'){x=x*10+ch-48;ch=getchar();}\n    return x*f;\n}\nint c[2000020],tag[2000020],n;\nstruct Splay\n{\n    int ch[maxn][2],fa[maxn],siz[maxn],val[maxn],sum[maxn],add[maxn],mul[maxn],rev[maxn];\n    void clear(int x)\n    {\n        ch[x][0]=ch[x][1]=fa[x]=siz[x]=val[x]=sum[x]=add[x]=rev[x]=0;\n        mul[x]=1;\n    }\n    int getch(int x)\n    {\n        return (ch[fa[x]][1]==x);\n    }\n    int isroot(int x)\n    {\n        clear(0);\n        return ch[fa[x]][0]!=x&&ch[fa[x]][1]!=x;\n    }\n    void maintain(int x)\n    {\n        clear(0);\n        siz[x]=(siz[ch[x][0]]+1+siz[ch[x][1]]);\n        sum[x]=(sum[ch[x][0]]+val[x]+sum[ch[x][1]]);\n    }\n    void pushdown(int x)\n    {\n        clear(0);\n        if(mul[x]!=1)\n        {\n            if(ch[x][0])\n            mul[ch[x][0]]=(mul[x]*mul[ch[x][0]]),val[ch[x][0]]=(val[ch[x][0]]*mul[x]),sum[ch[x][0]]=(sum[ch[x][0]]*mul[x]),add[ch[x][0]]=(add[ch[x][0]]*mul[x]);\n            if(ch[x][1])\n            mul[ch[x][1]]=(mul[x]*mul[ch[x][1]]),val[ch[x][1]]=(val[ch[x][1]]*mul[x]),sum[ch[x][1]]=(sum[ch[x][1]]*mul[x]),add[ch[x][1]]=(add[ch[x][1]]*mul[x]);\n            mul[x]=1;\n        }\n        if(add[x])\n        {\n            if(ch[x][0])\n            add[ch[x][0]]=(add[ch[x][0]]+add[x]),val[ch[x][0]]=(val[ch[x][0]]+add[x]),sum[ch[x][0]]=(sum[ch[x][0]]+add[x]*siz[ch[x][0]]);\n            if(ch[x][1])\n            add[ch[x][1]]=(add[ch[x][1]]+add[x]),val[ch[x][1]]=(val[ch[x][1]]+add[x]),sum[ch[x][1]]=(sum[ch[x][1]]+add[x]*siz[ch[x][1]]);\n            add[x]=0;\n        }\n        if(rev[x])\n        {\n            if(ch[x][0])\n            rev[ch[x][0]]^=1,swap(ch[ch[x][0]][0],ch[ch[x][0]][1]);\n            if(ch[x][1])\n            rev[ch[x][1]]^=1,swap(ch[ch[x][1]][0],ch[ch[x][1]][1]);\n            rev[x]=0;\n        }\n    }\n    void update(int x)\n    {\n        if(!isroot(x))\n        update(fa[x]);\n        pushdown(x);\n    }\n    void rotate(int x)\n    {\n        int y=fa[x],z=fa[y],chx=getch(x),chy=getch(y);\n        fa[x]=z;\n        if(!isroot(y))\n        ch[z][chy]=x;\n        ch[y][chx]=ch[x][chx^1];\n        fa[ch[x][chx^1]]=y;\n        ch[x][chx^1]=y;\n        fa[y]=x;\n        maintain(y);\n        maintain(x);\n        maintain(z);\n    }\n    void splay(int x)\n    {\n        update(x);\n        for(int f=fa[x];f=fa[x],!isroot(x);rotate(x))\n        if(!isroot(f))\n        rotate(getch(x)==getch(f)?f:x);\n    }\n    void access(int x)\n    {\n        for(int f=0;x;f=x,x=fa[x])\n        splay(x),ch[x][1]=f,maintain(x);\n    }\n    void makeroot(int x)\n    {\n        access(x);\n        splay(x);\n        swap(ch[x][0],ch[x][1]);\n        rev[x]^=1;\n    }\n    int find(int x)\n    {\n        access(x);\n        splay(x);\n        while(ch[x][0])\n        x=ch[x][0];\n        splay(x);\n        return x;\n    }//\u524d\u9762\u90fd\u662fLCT\u677f\u5b50\u90e8\u5206\n    void added(int u,int c)\n    {\n        int v=u;\n        makeroot(u), access(v), splay(v);\n      val[u] = (val[v] + c) ;\n      sum[v] = (sum[v] + siz[v] * c ) ;\n      add[v] = (add[v] + c) ;\n        return;\n    }//\u5355\u70b9\u52a0\uff08\u76f8\u5f53\u4e8e\u5bf9\u533a\u95f4[u,u]\u52a0\uff09\n    int query(int u)\n    {\n        if(u==0)\n            return 0;\n        int v=1;\n        makeroot(u), access(v), splay(v);\n        return sum[v];\n    }//\u533a\u95f4\u67e5\u8be2\uff08\u6ce8\u610f\u7279\u5224u=0\u7684\u60c5\u51b5\uff0c\u5728\u8f6c\u5316\u524d\u7f00\u548c\u65f61-1=0\u4f1a\u51fa\u95ee\u9898\uff09\n    void link(int u,int v)\n    {\n    if (find(u) != find(v)) \n    makeroot(u), fa[u] = v;\n    }\n}st;\nint c1[maxn],d1[maxn],c2[maxn],d2[maxn],a[maxn];\nstruct node\n{\n    int fir,sec;\n    bool operator<(const node &i)const\n    {\n\t\tif (fir==i.fir) \n        return sec<i.sec;\n\t\treturn fir<i.fir;\n\t}\n}seele[maxn];\ninline bool seele_cmp(node a,node b)\n{\nreturn a.sec<b.sec;\n}\nsigned main()\n{\n        int n;\n        cin>>n;\n        for(int i=1;i<=n;i++)\n        seele[i]=(node){read(),i};\n        sort(seele+1,seele+n+1);\n        for(int i=1;i<=n;i++)\n        seele[i].fir=i;\n        sort(seele+1,seele+n+1,seele_cmp);\n        for(int i=1;i<=maxn/2;i++)\n        st.clear(i),st.val[i]=0,st.maintain(i),st.splay(i);\n        for(int i=1;i<=100000;i++)\n            st.link(i,i+1);\n        int ans=1;\n        for(int i=1;i<=n;i++)\n        {\n        st.added(seele[i].fir,1);\n        ans=max(ans,i-st.query(i));\n        }\n        cout<<ans;\n}\n```\n",
        "postTime": 1658235493,
        "uid": 714821,
        "name": "loser_seele",
        "ccfLevel": 4,
        "title": "P4375\u9898\u89e3"
    },
    {
        "content": "# \u9898\u76ee\u5927\u610f\n\n\u6c42\u5bf9\u4e00\u4e2a\u5e8f\u5217\u8fdb\u884c\u591a\u5c11\u6b21\u53cc\u5411\u5192\u6ce1\u6392\u5e8f\u53ef\u4ee5\u4f7f\u5176\u6709\u5e8f\u3002\n\n# \u9898\u76ee\u5206\u6790\n\n\u5bf9 $a$ \u8fdb\u884c\u7f16\u53f7\uff08\u5176\u5b9e\u8fd9\u91cc\u4e0d\u5e94\u8be5\u53eb\u505a\u201c\u79bb\u6563\u5316\u201d\uff0c\u56e0\u4e3a\u5c31\u7b97\u6570\u636e\u5f88\u5c0f\u4e5f\u9700\u8981\u8fdb\u884c\u6240\u8c13\u7684\u201c\u79bb\u6563\u5316\u201d\uff09\uff0c\u5219\u7b54\u6848\u4e3a $\\max_{i=1}^n\\{\\sum\\limits_{j=1}^i[a[j]\\gt i]\\}$\uff0c\u5176\u4e2d $[a]$ \u7684 $a$ \u662f\u4e00\u4e2a\u903b\u8f91\u8bed\u53e5\uff0c\u82e5 $a$ \u4e3a\u771f\u5219 $[a]=1$\uff0c\u53cd\u4e4b\u5219 $[a]=0$\u3002\n\n~~\u5f88\u9057\u61be\uff0c\u60a8\u4e0a\u4f20\u7684\u9898\u89e3 P4375 [USACO18OPEN]Out of Sorts G \u672a\u80fd\u901a\u8fc7\u5ba1\u6838\u3002\u539f\u56e0\u662f \u5e94\u8865\u5145\u6b63\u786e\u6027\u8bc1\u660e\uff1b\u5bf9\u89e3\u6cd5\u7684\u8bf4\u660e\u8fc7\u5c11/\u4e0d\u591f\u6e05\u6670\u3002~~\n\n\u8bc1\u660e\uff1a\n\n\u6392\u5e8f\u540e\uff0c\u5bf9\u4e8e $[1,i]$ \u8303\u56f4\u5185\u4e0d\u5c5e\u4e8e\u8fd9\u4e2a\u533a\u95f4\uff0c\u5373 $\\exists j\\in[1,i],a[j]\\gt i$ \u7684\u6240\u6709 $a[j]$ \u663e\u7136\u90fd\u4f1a\u88ab\u79fb\u5230 $[1,i]$ \u5916\u9762\u53bb\uff1b\u76f8\u5bf9\u5e94\u7684\uff0c\u540c\u65f6\u5c5e\u4e8e $[1,i]$ \u7684\u4e5f\u4f1a\u88ab\u79fb\u4e00\u4e2a\u8fdb\u6765\u3002\u6240\u4ee5\u64cd\u4f5c\u6570\u5c31\u662f $[1,i]$ \u5185\u5927\u4e8e $a[i]$ \u7684\u6570\u7684\u4e2a\u6570\u3002\n\n\u800c\u8fd9\u7c7b\u4f3c\u4e8e\u9006\u5e8f\u5bf9\uff0c\u53ef\u4f7f\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u503c\u57df\u6c42\u89e3\u3002",
        "postTime": 1655042088,
        "uid": 430409,
        "name": "Coros_Trusds",
        "ccfLevel": 6,
        "title": "P4375 [USACO18OPEN]Out of Sorts G"
    },
    {
        "content": "\u7ec8\u4e8e~~\u5728\u5e2e\u52a9\u4e0b~~AC\u4e86\n\n**\u77e5\u8bc6\u70b9\uff1a\u6811\u72b6\u6570\u7ec4 + ~~\u667a\u5546\u9898~~**\n\n\u5f00\u59cb\u7684\u65f6\u5019\u60f3\u7684\u662f\u627e\u89c4\u5f8b \u7ed3\u679c\u53d1\u73b0\u627e\u4e0d\u5230\n\n\u540e\u6765\u88ab\u544a\u77e5\u662f**\u6811\u72b6\u6570\u7ec4**\uff08\u6211\u592a\u83dc\u5566\n\n**sum[i] \u8868\u793a \u6392\u597d\u5e8f\u4e4b\u540e\u6709\u591a\u5c11\u4e2a\u6570\u5728 [1\uff0ci]\u5185**\n\n\u6240\u4ee5 \u4e0d\u5728 [1,i]\u5185\u7684\u5c31\u53ef\u4ee5\u7528 i-sum[i]\n\n\uff08\u5f00\u59cb\u7684\u65f6\u5019\u628asum\u7406\u89e3\u6210\u4e86\u524d\u7f00\u548c \u4e8e\u662f\u61f5\u4e86\u597d\u4e45\n\n\u6392\u5e8f\u8bb0\u5f55\u4e0b\u539f\u6765\u7684num \u5728\u539f\u6765\u7684num\u57fa\u7840\u4e0a\u6807\u8bb0\u6811\u72b6\u6570\u7ec4\n\n**ins \u7b80\u5355\u7406\u89e3\u5c31\u662f\u6253\u6807\u8bb0 ask \u5c31\u662f\u8be2\u95ee\u6709\u591a\u5c11\u4e2a\u4e0d\u5728[1,i]\u5185\u7684\u6570**\n\n\u6700\u540e **\u7b54\u6848\u5c31\u662fi-ask(i)\u7684\u6700\u5927\u503c**\u554a\n\nPs\uff1a\u8fd8\u6709\u4e00\u4e2a\u6bd4\u8f83\u5751\u7684\u5730\u65b9\u5c31\u662f\u5df2\u7ecf\u6392\u597d\u5e8f\u7684 \u8fd9\u4e2a\u65f6\u5019\u4f60\u53ef\u80fd\u4f1a\u8f93\u51fa0\n\n\u4f46\u662f\u7b54\u6848\u6700\u5c11\u4e5f\u662f1 \u6240\u4ee5 \u5de7\u5999\u5730\u5904\u7406\u4e00\u4e0b\u5c31\u597d\u4e86\n```cpp\nprintf(\"%d\",max(ans,1));\n```\n~~\uff08\u6ed1\u7a3d~~ \u5206\u5272\u7ebf\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<cstring>\n#include<algorithm>\n#include<queue> \n#define MAXN 100005\n#define LL long long\n#define INF 2147483640\n#define MOD 100000007\n#define free(s) freopen(\"s.txt\",\"r\",stdin);\n#define lowbit(x) ((x&(-x))) \nusing namespace std;\nconst int L=1e5+5;\nstruct node{\n\tint x,num;\n};\nbool cmp(const node &a,const node &b)\n{\n\treturn a.x<b.x||(a.x==b.x&&a.num<b.num);\n}\nint n,ans,sum[L];\nnode a[L];\nvoid ins(int x)\n{\n\tfor(int i=x;i<=L;i+=lowbit(i))\n\t\tsum[i]++;\n}\nint ask(int x)\n{\n    int res=0;\n    for(int i=x;i;i-=lowbit(i))\n    \tres+=sum[i];\n    return res;\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&a[i].x);\n\t\ta[i].num=i;\n\t}\n\tsort(a+1,a+n+1,cmp);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tins(a[i].num);\n\t\tans=max(ans,i-ask(i));\n\t}\n\tprintf(\"%d\",max(ans,1));\n\treturn 0;\n}\n```",
        "postTime": 1525597215,
        "uid": 37427,
        "name": "\u66f9\u8001\u5e08",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4375 \u3010[USACO18OPEN]Out of Sorts G\u3011"
    },
    {
        "content": "\u7ed3\u8bba\u9898\u3002\n\n\u7ed3\u8bba\uff1a\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u4f4d\u7f6e $x$ \u5728\u5b83\u524d\u9762\u79bb\u6563\u5316\u540e\u5c0f\u4e8e $x$ \u7684\u503c\u7684\u6570\u91cf\u7684\u6700\u5927\u503c\u3002\n\n\u8bc1\u660e\u5f88\u7b80\u5355\u3002\u8003\u8651\u5192\u6ce1\u6392\u5e8f\u7684\u8fc7\u7a0b\uff1a\u5bf9\u4e8e\u4e00\u4e2a\u4f4d\u7f6e $x$\uff0c\u5148\u628a\u5b83\u4e4b\u524d\u7684\u4e00\u4e2a\u5927\u4e8e $x$ \u7684\u6570\u653e\u5728\u5b83\u540e\u9762\uff0c\u518d\u628a\u5b83\u540e\u9762\u4e00\u4e2a\u5c0f\u4e8e\u7b49\u4e8e $x$ \u7684\u6570\u653e\u5728\u5b83\u524d\u9762\u3002\u5c31\u76f8\u5f53\u4e8e\u628a\u5927\u4e8e\u5b83\u7684\u548c\u5c0f\u4e8e\u7b49\u4e8e\u5b83\u7684\u6570\u5b57\u4ea4\u6362\u3002\n\n\u6240\u4ee5\uff0c\u7ed3\u8bba\u6210\u7acb\u3002\u8fd9\u4e2a\u4e1c\u897f\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u4e00\u4e0b\u5c31\u884c\u3002\n\n\u6709\u4e00\u4e2a\u5751\u70b9\u662f\u5f53\u5e8f\u5217\u539f\u672c\u6709\u5e8f\u7684\u65f6\u5019\u5976\u725b\u4e5f\u4f1a\u53eb\u4e00\u6b21\u3002 \u628a\u7b54\u6848\u548c $1$ \u53d6\u4e00\u904d $\\max$ \u5c31\u884c\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int MAXN = 1e5+5;\nint c[MAXN],n,ans=1;\npair<int,int> a[MAXN];\nint lowbit(int x){return x&-x;}\nvoid add(int x,int k){for(;x<=n;x+=lowbit(x)) c[x]+=k;}\nint query(int x){int ret=0;for(;x;x-=lowbit(x)) ret+=c[x]; return ret;}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&a[i].first),a[i].second=i;\n\tsort(a+1,a+n+1);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tadd(a[i].second,1);\n\t\tans=max(ans,i-query(i));\n\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1660020789,
        "uid": 280473,
        "name": "404Not_Found",
        "ccfLevel": 5,
        "title": "P4375 \u9898\u89e3"
    },
    {
        "content": "~~\u5728\u4eba\u7c7b\u667a\u6167\u9898\u9762\u524d\u663e\u793a\u4e86\u6211\u662f\u4e2a\u5927\u806a\u660e~~\n\n\u9996\u5148\u79bb\u6563\u5316\uff0c\u76f8\u540c\u7684\u6570\u539f\u672c\u4f4d\u7f6e\u5728\u524d\u7684\u79bb\u6563\u540e\u66f4\u9760\u524d\u3002\n\n\u7136\u540e\u5bf9\u6bcf\u4e2a\u4f4d\u7f6e $i$ \u5355\u72ec\u8003\u8651\u3002\n\n\u5f88\u663e\u7136\u6240\u6709\u5927\u4e8e $i$ \u7684\u6570\u90fd\u4e0d\u5e94\u8be5\u6392\u5728\u4f4d\u7f6e $i$ \u548c\u5b83\u7684\u524d\u9762\u3002\n\n\u7136\u540e\u518d\u6765\u770b\u4e00\u4e0b\u90a3\u4e2a\u4e24\u6b21\u6392\u5e8f\u3002\n\n\u624b\u52a8\u6a21\u62df\uff0c\u7b2c\u4e00\u6b21\u6392\u5e8f\u53ef\u4ee5\u5c06\u4e00\u4e2a\u4e14\u53ea\u6709\u4e00\u4e2a\u5728 $i$ \u6216\u5b83\u4e4b\u524d\u7684\u4e00\u4e2a\u5927\u4e8e $i$ \u7684\u6570\u632a\u5230 $i$ \u7684\u540e\u9762\u53bb\u3002\n\n\uff08\u5047\u5982\u53ea\u6709\u4e00\u4e2a\u5927\u4e8e $i$ \u7684\u6570\uff0c\u90a3\u4e48\u5728\u7b2c\u4e00\u6b21\u5192\u6ce1\u4e2d\u5728 $i$ \u53ca $i$ \u4e4b\u524d\u4e0d\u4f1a\u6709\u5927\u4e8e\u8fd9\u4e2a\u6570\u7684\u6570\uff0c\u90a3\u4e48\u4e00\u5b9a\u4f1a\u88ab\u5192\u6ce1\u5e26\u51fa    $i$ ,\u5047\u5982\u6709\u4e24\u4e2a\u6216\u8005\u66f4\u591a\uff0c\u90a3\u4e48\u5047\u5982\u73b0\u5728\u6b63\u5728\u79fb\u52a8\u4e86\u4e00\u4e2a\u6570 $k$ \uff0c\u5047\u5982\u9047\u5230\u4e86\u4e00\u4e2a\u5927\u4e8e $k$ \u7684 $l$ \uff0c\u90a3\u4e48\u4f1a\u9009\u62e9\u5192\u6ce1 $l$ \u800c\u4e0d\u662f $k$ \uff0c\u6240\u4ee5\u53ea\u6709\u4e00\u4e2a\u6570\u80fd\u88ab\u5e26\u51fa $i$\uff09\n\n\u90a3\u4e48\u76f4\u63a5\u6613\u5f97\u628a $i$ \u548c\u5b83\u4e4b\u524d\u7684\u6240\u6709\u5927\u4e8e $i$ \u7684\u6570\uff08\u5047\u8bbe\u6709 $k_i$ \u4e2a\uff09\u632a\u51fa\u53bb\u8981 $k_i$ \u6b21\u3002\n\n\u6839\u636e\u4e0a\u9762\u7684\u5206\u6790\u4e5f\u6613\u5f97\u7136\u540e\u628a\u6240\u6709\u4e0d\u5728 $i$ \u548c\u5b83\u4e4b\u524d\u7684\u6240\u6709\u5c0f\u4e8e\u7b49\u4e8e $i$ \u7684 $k_i$ \u4e2a\u6570\uff08\u4e00\u5b9a\u7b49\u4e8e\u5728\u5927\u4e8e $i$ \u7684\u6570\u7684\u4e2a\u6570\uff09\u632a\u56de\u6765\u4e5f\u9700\u8981 $k_i$ \u6b21\uff0c\u6070\u597d\u5c31\u5728 $k_i$ \u6b21\u5faa\u73af\u5185\u641e\u5b9a\u3002\n\n\u81f3\u4e8e\u6700\u7ec8\u8981\u6c42\u6709\u5e8f\u7684\u8bdd\u6613\u8bc1\u7ecf\u8fc7 $k_i$ \u6b21\u540e\u5728 $i$ \u4e0a\u7684\u4e00\u5b9a\u662f $i$ \uff0c\u6240\u4ee5\u53ea\u8981\u5bf9\u6bcf\u4e2a\u4f4d\u7f6e\u90fd\u7ecf\u8fc7 $k_i$ \u6b21\u79fb\u52a8\u6700\u7ec8\u4e00\u5b9a\u6709\u5e8f\u3002\n\n\u7b54\u6848\u5c31\u662f $\\max(k_i)$ \u3002\n\n\u7136\u540e\u5751\u903c\u7684\u662f\u5047\u5982\u6570\u5217\u539f\u672c\u6709\u5e8fBessie\u4e5f\u4f1a\u53eb\u4e00\u58f0\u3002\n\ncode\uff1a\n\n```\n#include<bits/stdc++.h>\n#define lb(x) x&(-x)\nusing namespace std;\nint tree[1000001],ans=1,n;\nint num[1000001],b[1000001],cnt[1000001],check[1000001],size;\nvoid change(int x,int d){for(;x<=cnt[size];x+=lb(x)) tree[x]+=d;}\nint query(int x)\n{\n\tint ans=0;\n\tfor(;x;x-=lb(x)) ans+=tree[x];\n\treturn ans;\n}\t\nbool cmp(int x,int y){return x<y;}\nint find(int x)\n{\t\n\tint l=1,r=size,m;\n\twhile(l<=r)\n\t{\n\t\tm=(l+r)>>1;\n\t\tif(b[m]==x) return m;\n\t\telse if(b[m]<x) l=m+1;\n\t\telse r=m-1;\n\t}\n}\t\nint main()\n{\t\n\tcin>>n;\n\tfor(int i=1;i<=n;i++) cin>>num[i],b[i]=num[i];\n\tsort(b+1,b+n+1,cmp);\n\tsize=unique(b+1,b+n+1)-b-1;\n\tfor(int i=1;i<=n;i++) cnt[find(num[i])]++;\n\tfor(int i=2;i<=size;i++) cnt[i]+=cnt[i-1];\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint x=find(num[i]);\n\t\tnum[i]=cnt[x-1]+check[x]+1;\n\t\tcheck[x]++;\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tchange(num[i],1);\n\t\tans=max(ans,query(cnt[size])-query(i));\n\t}\n\tcout<<ans;\n}\t\n```\n",
        "postTime": 1649489128,
        "uid": 167279,
        "name": "Danno0v0",
        "ccfLevel": 7,
        "title": "P4375 Out of Sorts G"
    },
    {
        "content": "# \u94fe\u63a5\uff1a\n\n[\u6d1b\u8c37](https://www.luogu.com.cn/problem/P4375)\n\n[\u535a\u5ba2\u56ed](https://www.cnblogs.com/GJY-JURUO/p/14419835.html)\n\n# \u9898\u76ee\u5927\u610f\uff1a\n\n\u6709\u4e00\u6bb5\u4ee3\u7801\uff1a\n\n```pascal\nsorted = false\nwhile (not sorted):\n   sorted = true\n   moo\n   for i = 0 to N-2:\n      if A[i+1] < A[i]:\n         swap A[i], A[i+1]\n   for i = N-2 downto 0:\n      if A[i+1] < A[i]:\n         swap A[i], A[i+1]\n   for i = 0 to N-2:\n      if A[i+1] < A[i]:\n         sorted = false\n```\n\n\u8ba9\u4f60\u6c42\u8fd9\u6bb5\u4ee3\u7801\u91cc\u7684 `moo` \u4f1a\u8fd0\u884c\u591a\u5c11\u6b21\u3002\n\n# \u6b63\u6587\uff1a\n\n\u8fd9\u9053\u9898\u7684\u601d\u8def\u5f88\u5999\u3002\u9996\u5148\u5355\u72ec\u770b\u7b2c\u4e00\u4e2a `for` \u5faa\u73af\uff0c\u4f60\u4f1a\u53d1\u73b0\u8fd9\u4e2a\u64cd\u4f5c\u5176\u5b9e\u7b49\u4ef7\u4e8e\u5c06\u82e5\u5e72\u4e2a\u6570 $a_i$ \u79fb\u5230\u4e00\u4e2a\u7b2c\u4e00\u4e2a\u5927\u4e8e\u5b83\u7684\u6570\u7684\u524d\u9762\uff0c\u7b2c\u4e8c\u4e2a\u5faa\u73af\u7c7b\u4f3c\u3002\u8bbe $x$ \u8868\u793a\u4e00\u4e2a\u4e2d\u5fc3\u70b9\uff0c\u8981\u6c42\u4e24\u4e2a\u5faa\u73af\u7684\u82e5\u5e72\u4e2a\u6570\u4e2d\u5206\u522b\u81f3\u5c11\u6709\u4e00\u4e2a\u6570\u5728\u79fb\u52a8\u7684\u65f6\u5019\u7ecf\u8fc7 $x$\u3002\u6211\u4eec\u4e0d\u59a8\u628a\u6bcf\u6b21 `moo` \u90fd\u662f\u7b2c\u4e00\u4e2a\u5faa\u73af\u7684\u90a3\u4e2a\u6570\u548c\u7b2c\u4e8c\u4e2a\u5faa\u73af\u7684\u90a3\u4e2a\u6570\u4e92\u76f8\u642d\u914d\u3002\n\n\u5982\u679c\u8981\u8ba9 `moo` \u7684\u6b21\u6570\u591a\uff0c\u90a3\u4e48\u5c31\u610f\u5473\u7740\u8ba9 $x$ \u524d\u540e\u66f4\u591a\u6570\u76f8\u642d\u914d\u3002\u5f52\u7eb3\u4e00\u4e0b\uff0c\u6211\u4eec\u7ed9 $a$ \u6570\u7ec4\u79bb\u6563\u5316\u5f97\u5230\u6392\u540d\u6570\u7ec4 $r$\uff0c\u90a3\u4e48\u76f8\u642d\u914d\u5fc5\u5b9a\u662f $x$ \u524d\u7684\u6570\u7684\u6392\u540d\u8981\u5927\u4e8e $x$\uff0c$x$ \u540e\u7684\u6570\u76f8\u53cd\u3002\u7b54\u6848\u5373\uff1a\n\n$$\\max_{x=1}^{n}\\{(\\sum_{i\\leq x,r_i>x}1)\\}$$\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u4e86\u3002\n\n# \u4ee3\u7801\uff1a\n\n```cpp\nconst int N = 1e5 + 10;\n\nint n;\nstruct node\n{\n\tint id, val;\n}a[N];\nint t[N], ans = 1;\n\nvoid modify(int x){for (; x <= n; x += x & -x) t[x]++;}\nint query(int x){int ans = 0;for (; x; x -= x & -x) ans += t[x]; return ans;}\n\nbool cmp(node a, node b){return a.val < b.val;} \nbool cmp2(node a, node b){return a.id < b.id;} \n\nint main()\n{\n//\tfreopen(\".in\", \"r\", stdin);\n//\tfreopen(\".out\", \"w\", stdout);\n\tscanf (\"%d\", &n);\n\tfor (int i = 1; i <= n; i++)\n\t\tscanf (\"%d\", &a[i].val), a[i].id = i;\n\tsort (a + 1, a + 1 + n, cmp);\n\tfor (int i = 1; i <= n; i++) a[i].val = i;\n\tsort (a + 1, a + 1 + n, cmp2);\n\tfor (int i = 1; i <= n; i++)\n\t{\n\t\tmodify(a[i].val);\n\t\tans = max(ans, i - query(i));\n\t}\n\tprintf (\"%d\\n\", ans);\n    return 0;\n```",
        "postTime": 1613795144,
        "uid": 80695,
        "name": "Jayun",
        "ccfLevel": 6,
        "title": "\u3010\u9898\u89e3\u3011P4375 [USACO18OPEN]Out of Sorts G"
    },
    {
        "content": "# $zkw$\u7ebf\u6bb5\u6811$+$\u79bb\u6563\u5316\n## $zkw:$\u6811\u72b6\u6570\u7ec4=\u7ebf\u6bb5\u6811\uff0c\u54c8\u54c8\n\n------------\n[\u4f20\u9001\u95e8 \u6d1b\u8c37P4375 [USACO18OPEN]Out of Sorts G](https://www.luogu.org/problem/P4375)\n\n[\u6b22\u8fce\u5728\u6211\u7684\u535a\u5ba2\u67e5\u770b\uff08\u4e5f\u8bb8\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\uff1f\uff09](https://www.luogu.org/blog/trc233231/solution-p4375)\n\n\n\n------------\n\n### \u6700\u8fd1\u521a\u597d\u5728\u5b66$zkw$\u7ebf\u6bb5\u6811\uff0c\u4e8e\u662f\u6211\u5c31\u5728\u9898\u5e93\u91cc\u7ffb\u6807\u7b7e\u6709\u6811\u72b6\u6570\u7ec4\u7684\u9898\uff0c\u521a\u597d\u5207\u5230\u8fd9\u4e00\u9898\uff0c\u770b\u5230\u9898\u89e3\u91cc\u90fd\u662f\u6811\u72b6\u6570\u7ec4$or$\u6a21\u62df\uff0c\u6211\u5c31\u6765\u53d1\u4e00\u7bc7$zkw$\u7ebf\u6bb5\u6811\u3002\n\n\u8fd9\u91cc\u7b80\u5355\u8bb2\u4e00\u4e0b$zkw$\u7ebf\u6bb5\u6811\uff0c\u5b83\u662f\u4e00\u79cd**\u81ea\u4e0b\u5411\u4e0a**\u4fee\u6539\u548c\u67e5\u8be2\u7684**\u975e\u9012\u5f52**\u7684\u7ebf\u6bb5\u6811\u3002\u5b83\u6e90\u4e8e$zkw$\u5927\u4f6c\u7684\u53d1\u73b0\u2014\u2014**\u7ebf\u6bb5\u6811\u7684\u53f6\u5b50\u8282\u70b9\u7f16\u53f7\u4e0e\u539f\u6570\u7ec4\u4e0b\u6807\u7684\u5dee\u503c\u662f\u4e00\u5b9a\u7684**\u3002\u901a\u8fc7**\u5c0f\u5b66\u751f\u627e\u89c4\u5f8b**\u7684\u65b9\u6cd5\u6613\u5f97\uff0c\u8fd9\u4e2a**\u5dee\u503c$d=2^{log{(n+1)}}$**\u3002\n\n![](https://cdn.luogu.com.cn/upload/pic/71036.png )\n------------\n\n**$d$\u7684\u6c42\u6cd5\uff1a**\n```cpp\nwhile(d<=n+1)d<<=1;\n```\n**\u5355\u70b9\u66f4\u65b0\u64cd\u4f5c\uff1a($zkw$:\u662f\u4e0d\u662f\u5f88\u50cf\u6811\u72b6\u6570\u7ec4\uff1f\u662f\u5c31\u5bf9\u4e86\u3002\u56e0\u4e3a\u6811\u72b6\u6570\u7ec4=\u7ebf\u6bb5\u6811\uff0c\u54c8\u54c8\u3002)**\n```cpp\ninline void update(int pos,int val){\n\tfor(pos+=d;pos;pos>>=1)\n    \tzkw[pos]+=val;\n}\n\n```\n**\u533a\u95f4\u67e5\u8be2\u64cd\u4f5c\uff1a\u8fd9\u4e2a\u6709\u70b9\u590d\u6742\uff0c$zkw$\u51b3\u5b9a\u91c7\u7528\u201c\u5de6\u53f3\u5939\u2642\u51fb\u201d(?)\u7684\u65b9\u5f0f\u5177\u4f53\u8bf7\u89c1\u5982\u4e0b\u4ee3\u7801**\u3002\n\n**\u524d\u65b9\u4f4d\u8fd0\u7b97\u9ad8\u80fd\u8b66\u544a\uff01\uff01\uff01**\n\n```cpp\nl=l+d-1;//\u627e\u5230\u5de6\u533a\u95f4\u7684\u5de6\u8fb9\u7684\u53f6\u5b50\u8282\u70b9\u7684\u7f16\u53f7\nr=r+d+1;//\u627e\u5230\u5de6\u533a\u95f4\u7684\u5de6\u8fb9\u7684\u53f6\u5b50\u8282\u70b9\u7684\u7f16\u53f7\nl^r^1//\u5176\u8fd4\u56de\u503c\u7684\u610f\u4e49\u4e3al\u548cr\u662f\u5426\u4e3a\u5144\u5f1f\nl>>=1,r>>=1;//l,r\u5f80\u4e0a\u8d70\n~l&1//\u5176\u8fd4\u56de\u503c\u7684\u610f\u4e49\u4e3al\u662f\u5426\u4e3a\u5de6\u513f\u5b50\nl^1//\u5176\u8fd4\u56de\u503c\u4e3al\u7684\u5144\u5f1f\nr&1//\u5176\u8fd4\u56de\u503c\u7684\u610f\u4e49\u4e3ar\u662f\u5426\u4e3a\u53f3\u513f\u5b50\nr^1//\u8fd4\u56der\u7684\u5144\u5f1f\n\n//\u4e8e\u662f\u4ee3\u7801\u5982\u4e0b\ninline int query(int l,int r){\n\tint ans=0;\n    for(l=l+d-1,r=r+d+1;l^r^1;l>>=1,r>>=1){\n    \tif(~l&1)\n            ans+=zkw[l^1];\n        if(r&1)\n            ans+=zkw[r^1];\n    }//\u5e94\u8be5\u597d\u7406\u89e3\n    return ans;\n}\n\n```\n### \u5b8c\u6574$AC$\u4ee3\u7801\u5982\u4e0b\uff1a~~\u6211\u77e5\u9053\u6ce5\u840c\u53ea\u770b\u4ecb\u4e2a\uff08\u9003~~\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=1e5+5;\ninline int read(){\n    int x=0,f=0;char ch=getchar();\n    while(!isdigit(ch))f|=ch=='-',ch=getchar();\n    while(isdigit(ch))x=(x<<3)+(x<<1)+(ch^48),ch=getchar();\n    return f?-x:x;\n}//\u5feb\u8bfb\nint n,d=1,zkw[maxn<<1];\ninline void update(int pos,int val){for(pos+=d;pos;pos>>=1)zkw[pos]+=val;}\ninline int query(int l,int r){int ans=0;for(l=l+d-1,r=r+d+1;l^r^1;l>>=1,r>>=1){if(~l&1)ans+=zkw[l^1];if(r&1)ans+=zkw[r^1];}return ans;}//\u5199zkw\u4e0d\u538b\u884c\u6ca1\u6709\u7075\u9b42\nstruct node{\n    int w;\n    int id;\n    inline bool operator< (const node& a) const{\n        return w==a.w?id<a.id:w<a.w;\n    }//\u91cd\u8f7d\u8fd0\u7b97\u7b26\uff0c\u4e0d\u7136sort\u4e0d\u4e86\n}a[maxn];\nint main(){\n    n=read();\n    while(d<=n+1)\n        d=d<<1;\n    for(int i=1;i<=n;++i){\n        a[i].w=read();\n        a[i].id=i;//\u79bb\u6563\u5316\n    }\n    int res=1;\n    sort(a+1,a+n+1);\n    for(int i=1;i<=n;++i){\n        update(a[i].id,1);\n        res=max(res,i-query(1,i));\n    }\n    printf(\"%d\",res);\n    return 0;\n}\n```\n\n# ---------------------------------$OVER$------------------------------------\n",
        "postTime": 1565173972,
        "uid": 62246,
        "name": "Del_Your_Heart",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4375 \u3010Out of Sorts G\u3011"
    }
]
[
    {
        "content": "\u611f\u89c9\u8bb8\u591a\u9898\u89e3\u90fd\u662f\u4f9d\u9760\u6570\u636e\u6c34\u624d\u8fc7\u7684\u3002\u3002\n\n\u6211\u89c9\u5f97\u6b63\u89e3\u5e94\u8be5\u662f\u542f\u53d1\u5f0f\u641c\u7d22\n\n\u9996\u5148\u8dd1\u4e00\u904d\u65e0\u89c6\u6587\u5316\u6392\u65a5\u7684\u6700\u77ed\u8def\u3002\u5bb9\u6613\u8bc1\u660e\uff0c\u65e0\u89c6\u6587\u5316\u6392\u65a5\u6700\u77ed\u8def\u7684\u7b54\u6848\u4e00\u5b9a\u4e0d\u5927\u4e8e\u8003\u8651\u6587\u5316\u6392\u65a5\u7684\u7b54\u6848\u3002\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u7528\u4e00\u4e2a\u5f88\u5f3a\u7684\u526a\u679d\u4e86\u3002\n\n\u5982\u679c\u5f53\u524d\u5230\u7684\u8fd9\u4e2a\u70b9\u7684\u82b1\u8d39\u52a0\u4e0a\u4ece\u8fd9\u4e2a\u70b9\u51fa\u53d1\u5230\u7ec8\u70b9\u7684\u65e0\u89c6\u6587\u5316\u6392\u65a5\u7684\u6700\u77ed\u8def\u7684\u82b1\u8d39\u6bd4\u7b54\u6848\u8fd8\u8981\u5927\uff0c\u90a3\u4e48\u5c31\u6ca1\u6709\u7ee7\u7eed\u5f80\u4e0b\u641c\u7d22\u7684\u610f\u4e49\u4e86\u2014\u2014\u526a\u679d\u3002\n\n\n\n\n\n\n\n\n\n\n    \n    \n\n\n    \n    \n        \n    \n\n        \n        \n    \n    \n    \n    \n    \n```cpp\n#include <set>\n#include <queue>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\nconst size_t Max_NK(105);\nconst size_t Max_M(20050);\nsize_t N;\nsize_t K;\nunsigned int M;\nsize_t Total;\nsize_t S, T;\nunsigned int u, v, d;\nunsigned int Head[Max_NK];\nunsigned int To[Max_M];\nunsigned int Weight[Max_M];\nunsigned int Next[Max_M];\nunsigned int C[Max_NK];\nbool A[Max_NK][Max_NK];//A[i][j]\u82e5\u4e3atrue\u8868\u793ai\u6392\u65a5j \nunsigned int Dist[Max_NK];\nbool In_Q[Max_NK];\nvoid Spfa()\n{\n    memset(Dist, 0X7F, sizeof(Dist));\n    queue<unsigned int> Q;\n    Q.push(S);\n    In_Q[S] = true;\n    Dist[S] = 0;\n    unsigned int Top;\n    while (Q.size())\n    {\n        Top = Q.front();\n        Q.pop();\n        In_Q[Top] = false;\n        for (size_t i = Head[Top];i;i = Next[i])\n            if (Dist[To[i]] > Dist[Top] + Weight[i])\n            {\n                Dist[To[i]] = Dist[Top] + Weight[i];\n                if (!In_Q[To[i]])\n                {\n                    In_Q[To[i]] = true;\n                    Q.push(To[i]);\n                }\n            }\n    }\n}\nunsigned int Ans(0X7F7F7F7FU);\nbool Went[Max_NK];\nset<unsigned int> culture;\nbool check(const unsigned int &cl)\n{\n    for (set<unsigned int>::const_iterator iter = culture.begin();\n        iter != culture.end();++iter)\n        if (A[*iter][cl])\n            return false;\n    return true;\n}\nvoid Dfs(const size_t &Now, const unsigned int &D)\n{\n    Went[Now] = true;\n    culture.insert(C[Now]);\n    if (Now == S)\n    {\n        Ans = min(Ans, D);\n        return;\n    }\n    if (D + Dist[Now] > Ans)\n        return;\n    for (size_t i = Head[Now];i;i = Next[i])\n        if (!Went[To[i]] && check(C[To[i]]))\n            Dfs(To[i], D + Weight[i]);\n    Went[Now] = false;\n    culture.erase(C[Now]);\n}\nint main()\n{\n    scanf(\"%u%u%u%u%u\", &N, &K, &M, &S, &T);\n    for (size_t i = 1;i <= N;++i)\n        scanf(\"%u\", C + i);\n    for (size_t i = 1;i <= K;++i)\n        for (size_t j = 1;j <= K;++j)\n            scanf(\"%d\", &A[i][j]);\n    while (M--)\n    {\n        scanf(\"%u%u%u\", &u, &v, &d);\n        ++Total;\n        To[Total] = v;\n        Weight[Total] = d;\n        Next[Total] = Head[u];\n        Head[u] = Total;\n        ++Total;\n        To[Total] = u;\n        Weight[Total] = d;\n        Next[Total] = Head[v];\n        Head[v] = Total;\n    }\n    Spfa();\n    if (Dist[T] == 0X7F7F7F7FU)\n    {\n        printf(\"-1\");\n        return 0;\n    }\n    Dfs(T, 0);\n    if (Ans == 0X7F7F7F7FU)\n        printf(\"-1\");\n    else\n        printf(\"%u\", Ans);\n    return 0;\n}\n```",
        "postTime": 1441111032,
        "uid": 3182,
        "name": "Created_equal1",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "> *\u53cd\u6b63\u8fd9\u662f\u4e00\u9053\u9519\u9898\uff0c\u90a3\u5c31\u600e\u4e48\u7384\u5b66\u600e\u4e48\u6765\u561b*\n\n\u7531\u4e8e\u770b\u5230 $n<=100$ \u7684\u6570\u636e\uff0c\u6240\u4ee5\u4e00\u79d2\u60f3\u5230Floyd\n\n\u76f4\u63a5\u4e0d\u7528\u6309\u9898\u76ee\u7684\u601d\u8def\u6765\u505a\uff0c\u66b4\u529b\u8dd1\u4e00\u904dFloyd\uff0c\u4e0d\u52a0\u6587\u5316\u6392\u65a5\u3002\n\n\u671f\u671b\u5f97\u520630\u5206\u5de6\u53f3\uff0c\u5b9e\u9645\u5f97\u520672\u5206\u3002\n\n# \uff1f\uff1f\uff01\uff01\n---\n\u7136\u540e\u6211\u4eec\u8bd5\u56fe\u52a0\u5165\u5224\u65ad\u6587\u5316\u7684\u4e00\u4e9b\u52a8\u4f5c\uff0c\u5176\u5b9e\u53ef\u4ee5\u76f4\u63a5\u5728\u5efa\u8fb9\u7684\u65f6\u5019\u5904\u7406\u6389\uff0c\u5373\u4ece$aa$\u5230$bb$\uff0c\u82e5$bb$\u6392\u65a5$aa$\uff0c\u5219\u4e0d\u5efa\u8fb9\uff1b\u82e5$aa$\u6392\u65a5$bb$\uff1b\u5219\u4e0d\u5efa\u53cd\u5411\u8fb9\u3002\n\n### \u8fd9\u4e2a\u987a\u5e8f\u4e00\u5b9a\u8981\u6ce8\u610f\uff01\n\n\u671f\u671b\u5f97\u5206100\u5206\u3002\n\n### \u7ed3\u679c\u4e5f\u5c31\u662f\u591a\u4e868\u5206\u800c\u5df2\uff08\u9003\u4e0d\u6389\uff09\n\n---\n\u6311\u4e0d\u51fa\u9519\u6765\uff0c\u4e0b\u4e86\u4e00\u7ec4\u6570\u636e\u770b\u4e86\u534a\u5929\uff0c\u7ed3\u679c\u2026\u2026\n\n\u60f3\u5230\u4e86\u4e00\u4e2a\u6bd4\u8f83\u7384\u5b66\u7684\u4e1c\u897f\uff0c\u5c31\u662f\u8d77\u70b9\u4e0e\u7ec8\u70b9\u7684\u6587\u5316\u76f8\u540c\uff0c\u5c31\u8f93\u51fa-1\n\n\u671f\u671b\u5f97\u520690\u5206\uff0c\u5b9e\u9645\u5f97\u5206100\u5206\n\n# emm\n---\n# \u7ed3\u8bba\uff1a\n\u8fd9\u662f\u4e00\u9053\u975e\u5e38\u4e4b\u7384\u5b66\u7684\u9898\u76ee\uff0c\u76f8\u5f53\u4e8e\u5728Floyd\u6a21\u677f\u4e0a\u7a0d\u5fae\u4fee\u6539\u4e00\u4e0b\uff0c\u4e8e\u662f\u4e4e\u6a59\u9898\u53d8\u7eff\u9898\uff08\u9003\n\ncode\uff1a\n```\n#include<bits/stdc++.h>\nusing namespace std;\nint n,k,m,s,t,c[120],g[120][120],f[120][120],aa,bb,cc;\nint main(){\n    cin>>n>>k>>m>>s>>t;\n    for(register int i=1;i<=n;i++)\n        for(register int j=1;j<=n;j++)\n        \tf[i][j]=21743822;\n    for(register int i=1;i<=n;i++){\n        cin>>c[i];\n    }\n    for(register int i=1;i<=k;i++){\n        for(register int j=1;j<=k;j++){\n            cin>>g[i][j];\n        }\n    }\n    for(register int i=1;i<=m;i++){\n        cin>>aa>>bb>>cc;\n        if(!g[c[bb]][c[aa]]&&c[bb]!=c[aa])f[aa][bb]=min(f[aa][bb],cc);\n        if(!g[c[aa]][c[bb]]&&c[bb]!=c[aa])f[bb][aa]=min(f[bb][aa],cc);\n    }\n    if(c[s]==c[t]){\n        cout<<-1;\n        return 0;\n    }\n    for(register int i=1;i<=n;i++){\n        for(register int j=1;j<=n;j++){\n            if(i!=j)\n                for(register int k=1;k<=n;k++){\n                    if(j!=k&&i!=k){\n                        if(f[i][k]+f[k][j]<f[i][j]){\n                            f[i][j]=f[i][k]+f[k][j];\n                        }\n                    }\n                }\n        }\n    }\n    if(f[s][t]==21743822)cout<<-1;\n    else cout<<f[s][t];\n}\n```",
        "postTime": 1538224760,
        "uid": 34239,
        "name": "ironwheel",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u8fd9\u4e2a\u9898\u662f\u666e\u53ca\u7ec4\u5c11\u89c1\u7684\u56fe\u8bba\u9898\uff0c\u56e0\u4e3a\u6570\u636e\u8303\u56f4\u662f$n\\le100$\uff0c\u6240\u4ee5\u6c42\u6700\u77ed\u8def\u65f6\u53ef\u4ee5\u7528Floyd\uff0c\u6bd4\u8f83\u65b9\u4fbf\u3002\n\n\u4e00\u5f00\u59cb\u6211\u505a\u8fd9\u4e2a\u9898\u65f6\u611f\u89c9\u8fd9\u4e2a\u6392\u65a5\u53ef\u4ee5\u7528\u5e76\u67e5\u96c6\u5904\u7406\uff0c\u56e0\u4e3a\u8bbf\u95ee\u8fc7\u7684\u6587\u5316\u4e0d\u4f1a\u518d\u8bbf\u95ee\u4e00\u904d\uff0c\u4e5f\u76f8\u5f53\u4e8e\u6392\u65a5\u4e86\u3002\u4f46\u662f\u9898\u76ee\u4e2d\u63d0\u5230\u4e86i\u6587\u5316\u6392\u65a5j\u4f46j\u6587\u5316\u4e0d\u4e00\u5b9a\u6392\u65a5i\uff0c\u8fd9\u6837\u5e76\u67e5\u96c6\u7684\u65b9\u6cd5\u5c31\u65e0\u6548\u4e86\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8981\u5728\u6700\u77ed\u8def\u4e0a\u627e\u7a81\u7834\u53e3\uff0c\u5c31\u662f\u5bf9\u5728\u8def\u4e0a\u7ecf\u8fc7\u7684\u70b9\u6240\u62e5\u6709\u7684\u6587\u5316\u8fdb\u884c\u6807\u8bb0\u3002\u52a0\u4e0a\u51e0\u79cd\u5224\u65ad\u5e76\u8f6c\u79fb\uff0c\u6211\u505a\u7684\u65b9\u6cd5\u662f\u590d\u6742\u5ea6$<O(N^4)$\u7684\uff0c\u56e0\u6b64\u8fd9\u4e2a\u9898$N\\le100$\u7684\u6570\u636e\u57fa\u672c\u662f\u80fd\u8fc7\u7684\uff0c~~\uff08Floyd\u7684\u5e38\u6570\u5f53\u7136\u662f1\u4e86\uff09\u5f53\u7136\u4e86\uff0cif\u5224\u65ad\u60e9\u7f5a\u53e6\u8bf4~~\uff0c\u5b9e\u9645\u4e0a\u8dd1\u4e8652ms\u3002\n\n\n\n------------\n\n### \u5bf9Floyd\u63d2\u70b9\u505a\u6807\u8bb0\u7684\u89e3\u91ca\n\n\u56e0\u4e3aFloyd\u662f\u63d2\u70b9\u627e\u6700\u77ed\u8def\uff0c\u6240\u4ee5\u6bcf\u6b21\u72b6\u6001\u90fd\u4f1a\u88ab\u8bb0\u5f55\uff0c\u63d2\u7684\u70b9\u7684\u6587\u5316\u5c31\u4f1a\u88ab\u8bb0\u5f55\u5728\u8fd9\u6761\u8def\u91cc\uff0c\u6bd4\u5982\u82e5\u5728i\uff0cj\u4e2d\u63d2\u5165k\u65f6\u6ca1\u6709\u77db\u76fe\u4e14\u6ee1\u8db3\u6700\u77ed\u8def\uff0c\u90a3\u4e48\n\n```cpp\nfor(int t=1;t<=n;t++)\n    used[i][j][t]=used[i][k][t]||used[k][j][t];//\u4efb\u610f\u4e00\u4e2a\u4e3a1\u5219\u503c\u4e3a1\n        used[i][j][c[k]]=true;\n            f[i][j]=f[i][k]+f[k][j];\n```\n\n\u5c06\u4e24\u6761\u8def\u4e0a\u7684\u4fe1\u606f\u5408\u5e76\u5e76\u66f4\u65b0k\u7684\u4fe1\u606f\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u65b0\u8def\u5f84\u7684\u503c\u3002\n\n## Code\uff1a\n\n```cpp\n#include<cstdio>\n#include<cstring>\nint min(int x,int y){return x<y?x:y;}\n\nint c[105],n;//c\u6570\u7ec4\u5b58\u6587\u5316\u79cd\u7c7b\nint a[105][105];//a\u6570\u7ec4\u5b58\u662f\u5426\u6392\u65a5\nint f[105][105];//f\u6570\u7ec4\u5b58\u8def\u5f84\u957f\u5ea6\nbool used[105][105][105];//i,j,k\u8868\u793ai\u5411j\u7684\u8fb9\u7ecf\u8fc7\u4e86\u6587\u5316k\nvoid floyd()//\u6c42\u6700\u77ed\u8def\u5e76\u5224\u65ad\u662f\u5426\u6392\u65a5\u6216\u91cd\u590d\n{\n    for(int k=1;k<=n;k++)\n        for(int i=1;i<=n;i++)\n            for(int j=1;j<=n;j++)\n                if(!a[c[k]][c[i]]&&!a[c[j]][c[k]]&&!used[i][k][c[j]]&&!used[k][j][c[i]]&&f[i][k]+f[k][j]<f[i][j])\n                {\n                    for(int t=1;t<=n;t++)\n                        used[i][j][t]=used[i][k][t]||used[k][j][t];//\u6709\u4e00\u4e2a\u5f0f\u5b50\u4e3a\u771f\u5219\u8868\u8fbe\u5f0f\u503c\u4e3a\u771f\n                    used[i][j][c[k]]=true;\n                    f[i][j]=f[i][k]+f[k][j];\n                }\n}\nint main()\n{\n    memset(f,0x3f,sizeof(f));\n    int k,m,s,t,u,v,w;\n    scanf(\"%d%d%d%d%d\",&n,&k,&m,&s,&t);\n    for(int i=1;i<=n;i++)\n    {\n        scanf(\"%d\",&c[i]);\n        f[i][i]=0;//\u6700\u77ed\u8def\u521d\u59cb\u5316\n    }\n    for(int i=1;i<=k;i++)\n        for(int j=1;j<=k;j++)\n            scanf(\"%d\",&a[i][j]);\n    for(int i=1;i<=m;i++)\n    {\n        scanf(\"%d%d%d\",&u,&v,&w);\n        if(!a[c[v]][c[u]]&&c[u]!=c[v])//\u5982\u679c\u4e24\u4e2a\u70b9\u6392\u65a5\u6216\u6587\u5316\u76f8\u540c\u5219\u4e0d\u80fd\u8fde\u8fb9\n            f[u][v]=min(w,f[u][v]);//\u4e24\u4e2a\u70b9\u4e4b\u95f4\u4e0d\u6b62\u4e00\u6761\u8def\n        if(!a[c[u]][c[v]]&&c[u]!=c[v])\n            f[v][u]=min(w,f[v][u]);\n    }\n    for(int i=1;i<=n;i++)\n        for(int j=1;j<=n;j++)\n        {\n            used[i][j][c[i]]=true;//\u521d\u59cb\u5316\u6761\u4ef6\n            used[i][j][c[j]]=true;\n        }\n    floyd();\n    if(f[s][t]==0x3f3f3f3f)\n        printf(\"-1\\n\");//\u4e0d\u80fd\u5230\u8fbe\n    else\n        printf(\"%d\\n\",f[s][t]);\n    return 0;\n}\n\n```",
        "postTime": 1525614510,
        "uid": 63539,
        "name": "wjyyy",
        "ccfLevel": 9,
        "title": "\u3010\u6587\u5316\u4e4b\u65c5\u3011\u89e3\u9898\u62a5\u544a"
    },
    {
        "content": "/\\*\n\u6df1\u641c\uff0c\u5012\u7740\u8dd1\u4e00\u904dspfa\uff0c\u7528\u4e8e\u6700\u4f18\u89e3\u526a\u679d\uff0c\u4e0d\u7528\u5012\u7740\u641c\u6216\u8005\u7279\u6b8a\u5904\u7406\uff0c\u5012\u7740\u641c\u4e0d\u662f\u4e5f\u662f\u770b\u4e86\u6570\u636e \u624d\u53d1\u73b0\u5012\u7740\u8981\u5feb\u4e9b\u7684\u5417\n\n\\*/\n```cpp\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<cstdlib>\nusing namespace std;\nint n,k,m,s,t,ans=100000000,cnt=0;\nint c[200];\nint vis[200][200];\nint visit[200];\nstruct node{\n    int to,next,value;\n}e[20000];\nint head[200];\nint que[100000],qh=0,qt=0;\nbool inq[1000];\nint dist[1000];\nvoid add(int u,int v,int w)\n{\n    e[++cnt].to=v;\n    e[cnt].value=w;\n    e[cnt].next=head[u];\n    head[u]=cnt;\n}\nvoid spfa()\n{\n    memset(dist,0x7f7f7f,sizeof(dist));\n    dist[n]=0;\n    que[++qt]=n;\n    while(qh<qt)\n    {\n        int p=que[++qh];\n        inq[p]=false;\n        for(int i=head[p];i;i=e[i].next)\n        {\n            if(dist[e[i].to]>dist[p]+e[i].value)\n            {\n                dist[e[i].to]=dist[p]+e[i].value;\n                if(!inq[e[i].to])\n                {\n                    inq[e[i].to]=true;\n                    que[++qt]=e[i].to;\n                }\n            } \n        }\n    }\n}\nvoid dfs(int u,int step)\n{\n    bool pp=false;\n    if(u==t)\n    ans=min(ans,step);\n    if(step>=ans)\n    return;\n    visit[c[u]]=true;\n    for(int i=1;i<=k;i++)\n    if(vis[i][c[u]]) visit[i]=true;\n    for(int i=head[u];i;i=e[i].next)\n    {\n        if(!visit[c[e[i].to]]&&!vis[c[t]][c[e[i].to]]&&((e[i].to!=t&&c[e[i].to]!=c[t])||e[i].to==t)&&step+e[i].value+dist[e[i].to]<ans)//\u6700\u540e\u4e00\u4e2a\u526a\u679d\u5f88\u91cd\u8981\uff0c\u5982\u679c\u5f53\u524d\u7684\u503c\u52a0\u4e0a\u4ee5\u540e\u4e0d\u8003\u8651\u6587\u5316\u51b2\u7a81\u5230\u8fbe\u7ec8\u70b9\u7684\u6700\u77ed\u8def\u6bd4\u7b54\u6848\u5927\u7684\u8bdd\u5c31\u4e0d\u641c\u7d22\u4e86 \n        pp=true,dfs(e[i].to,step+e[i].value);\n    }\n    if(!pp)\n    visit[c[u]]=false;\n    for(int i=1;i<=k;i++)\n    if(vis[c[u]][i]) visit[i]=false;\n}\nint main()\n{\n    scanf(\"%d%d%d%d%d\",&n,&k,&m,&s,&t);\n    for(int i=1;i<=n;i++)\n    scanf(\"%d\",&c[i]);\n    for(int i=1;i<=k;i++)\n    for(int j=1;j<=k;j++)\n    scanf(\"%d\",&vis[i][j]);\n    for(int i=1;i<=m;i++)\n    {\n        int u,v,w;\n        scanf(\"%d%d%d\",&u,&v,&w);\n        add(u,v,w),add(v,u,w);\n    }\n    spfa();\n    dfs(s,0); \n    if(ans==100000000) printf(\"-1\");\n    else printf(\"%d\",ans);\n}\n```",
        "postTime": 1477377271,
        "uid": 25692,
        "name": "\u8d75\u6668\u6d0b",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u8868\u793a\u7b2c\u4e00\u6b21\u770b\u8fd9\u9053\u9898\u89c9\u5f97\u5f88\u96be\uff0c\uff0c\u7136\u540e\u5c31\u653e\u5f03\u4e86\uff0c\u540e\u6765\u53d1\u73b0\u7206\u641c\u5c45\u7136\u80fd\u8fc7\uff0c\u3002\u3002\u3002233333\n\n\u7136\u800c\u5e76\u6ca1\u6709\u770b\u51fa\u6765\u8fd9\u4e2a\u600e\u4e48\u7528\u6700\u77ed\u8def\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint z[150]/*\u6bcf\u79cd\u6587\u5316\u662f\u5426\u5df2\u5b66\u4e60\u6216\u88ab\u6392\u65a5\uff0c-1\u5b66\u4e60\uff0c\u5927\u4e8e0\u6392\u65a5*/,n/*\u56fd\u5bb6\u6570\u91cf*/,k/*\u6587\u5316\u6570\u91cf*/,m/*\u9053\u8def\u6570\u91cf*/;\nint from/*\u8d77\u70b9*/,want/*\u7ec8\u70b9*/,s[120][120]/*\u6587\u5316\u4e4b\u95f4\u7684\u6392\u65a5\u60c5\u51b5\uff0c\u540e\u8005\u4e3a\u88ab\u6392\u65a5*/,q[120][120]/*\u4e24\u4e2a\u56fd\u5bb6\u4e4b\u95f4\u7684\u8ddd\u79bb*/; \nint ans=9999999,may,have[120]/*\u6bcf\u4e2a\u56fd\u5bb6\u6240\u62e5\u6709\u7684\u6587\u5316*/;\nvoid search(int now)\n{\n    int i,j;\n    if(now==want)//\u5982\u679c\u5230\u4e86\n    {\n        if(may<ans) ans=may;//\u5c0f\u5c31\u66f4\u65b0\n        return ;\n    }\n    if(may>=ans) return ;//\u526a\u679d\n    for(i=1;i<=n;i++)\n    {\n        if(q[now][i]!=9999999&&z[have[i]]==0)//\u5982\u679c\u80fd\u5230\uff0c\u5e76\u4e14\u6587\u5316\u4e0d\u6392\u65a5\u4e0d\u91cd\u590d\n        {\n            may+=q[now][i];\n            z[have[i]]=-1;\n            for(j=1;j<=n;j++)\n                if(s[have[j]][i]) z[j]++;//\u8fd9\u91cc\u6ce8\u610f\u662f\u5b66\u4e60\u8fc7\u88ab\u5f53\u5730\u6392\u65a5\u7684\u6587\u5316\u624d\u4e0d\u80fd\u8fdb\uff0c\u4e4b\u524d\u641e\u53cd\u4e86\u5168\u8f93\u51fa-1.\u3002\u3002\u8fd9\u91cc\u8981\u7528++\u662f\u56e0\u4e3a\u56de\u6eaf\u7684\u65f6\u5019\u5982\u679c\u76f4\u63a5\u7528\u7684\u662ftrue\u62161\u7684\u8bdd\uff0c\u4e07\u4e00\u8fd9\u4e2a\u6587\u5316\u88ab\u5f88\u591a\u5730\u65b9\u6392\u65a5\uff0c\u800c\u90a3\u4e9b\u5730\u65b9\u4e5f\u6392\u65a5\u4e86\u5176\u4ed6\u6587\u5316\uff0c\u90a3\u4e48\u53ef\u80fd\u5b66\u4e60\u8fc7\u597d\u51e0\u79cd\u88ab\u67d0\u4e2a\u5730\u65b9\u6392\u65a5\u7684\u6587\u5316\uff0c\u8fd9\u6837\u56de\u6eaf\u6389\u4e00\u79cd\u663e\u7136\u4e5f\u662f\u4e0d\u80fd\u53bb\u7684\uff0c\u6240\u4ee5\u4e0d\u80fd\u5b8c\u5168\u6d88\u6389\uff0c\u56e0\u6b64\u7528++\u6765\u8868\u793a\uff0c\u56de\u6eaf\u5c31--\uff0c\u53ef\u4ee5\u5c31\u4e0d\u4f1a\u53bb\u6389\u5176\u4ed6\u6587\u5316\u5bfc\u81f4\u7684\u4e0d\u80fd\u53bb\u4e86\n            search(i);\n            may-=q[now][i];//\u56de\u6eaf\n            z[have[i]]=0;\n            for(j=1;j<=n;j++)\n                if(s[have[j]][i]) z[j]--;\n        }\n    } \n}\nint main()\n{\n    int a,b,c,j,i;\n    memset(z,0,120);\n    scanf(\"%d%d%d%d%d\",&n,&k,&m,&want,&from);//\u53cd\u7740\u8bfb\uff0c\u5c31\u76f8\u5f53\u4e8e\u5012\u7740\u641c\u7d22\uff0c\uff0c\u4f1a\u5feb\u4e00\u70b9\uff08\u4f46\u662f\u67d0\u4e00\u4e2a\u70b9\u4f1a\u6162\u4e00\u70b9\uff09\uff0c\u6211\u4e5f\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\n    for(i=1;i<=n;i++)\n    {\n        scanf(\"%d\",&have[i]);\n        for(j=1;j<=n;j++)\n            q[i][j]=9999999;\n    }\n    for(i=1;i<=k;i++)\n        for(j=1;j<=k;j++)\n        {\n            s[i][j]=false;\n            scanf(\"%d\",&b);\n            if(!b)continue;\n            s[i][j]=true;        \n        }\n    for(i=1;i<=m;i++)\n    {\n        scanf(\"%d%d%d\",&a,&b,&c);\n        if(q[a][b]>c) q[a][b]=c; \n        if(q[b][a]>c) q[b][a]=c;\n    } \n    z[have[from]]=-1;\n    for(i=1;i<=n;i++)\n        if(s[i][have[from]]) z[i]++;\n    search(from);\n    if(ans==9999999) ans=-1;//\u5982\u679cans\u6ca1\u6709\u88ab\u6539\u53d8\u8fc7\uff0c\u5c31\u4ee3\u8868\u4e0d\u80fd\u5230\n    printf(\"%d\",ans);\n    return 0; \n}\n```",
        "postTime": 1504231906,
        "uid": 47136,
        "name": "ww3113306",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "```cpp\n\n//Floyd\u7b97\u6cd5 \n#include<set>  \n#include<map>  \n#include<list>  \n#include<queue>  \n#include<stack>  \n#include<string>  \n#include<math.h>  \n#include<time.h>  \n#include<vector>  \n#include<bitset>  \n#include<memory>  \n#include<utility>  \n#include<stdio.h>  \n#include<sstream>  \n#include<iostream>  \n#include<stdlib.h>  \n#include<string.h>  \n#include<algorithm> \n#define LL unsigned long long  \nusing namespace std;\nint b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;\nint pd[500][500],a[500][500];\nint wh[500];\nint main()\n{\n    scanf(\"%d%d%d%d%d\",&n,&k,&m,&s,&t);\n    for (i=1;i<=n;i++)\n        for (j=1;j<=n;j++)\n        {\n            a[i][j]=233333333;//\u521d\u59cb\u5316 \n        }\n    for (i=1;i<=n;i++)\n    {\n        scanf(\"%d\",&wh[i]);\n    }\n    for (i=1;i<=k;i++)\n        for (j=1;j<=k;j++)\n        {\n            scanf(\"%d\",&pd[i][j]);\n        }\n    for (i=1;i<=m;i++)\n    {\n        scanf(\"%d %d %d\",&x,&y,&z);\n        if (z<a[x][y])//\u4e24\u57ce\u5e02\u4e4b\u95f4\u4e0d\u6b62\u4e00\u6761\u7ebf\u8def\uff0c\u6240\u4ee5\u8981\u52a0\u5224\u65ad \n        {\n            if (pd[wh[x]][wh[y]]==0) a[y][x]=z;\n            if (pd[wh[y]][wh[x]]==0) a[x][y]=z;  \n        }\n    }\n    for (k=1;k<=n;k++)\n        for (i=1;i<=n;i++)\n            for (j=1;j<=n;j++)\n            if (a[i][k]+a[k][j]<a[i][j]) a[i][j]=a[i][k]+a[k][j];\n    if (a[s][t]==233333333) cout<<-1; else cout<<a[s][t];\n    return 0;\n}\n\n```",
        "postTime": 1455615144,
        "uid": 2674,
        "name": "\u300cQQ\u7ea2\u5305\u300d",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u6765\u4e00\u7bc7\u7b80\u5355\u6613\u61c2\u7684dijkstra\u6700\u77ed\u8def\u89e3\u6cd5  \n\u53ea\u7528\u5728\u6a21\u677f\u4e0a\u52a0\u4e00\u4e2a\u5224\u65ad\u662f\u5426\u6587\u5316\u6392\u65a5\u7684\u51fd\u6570\u5373\u53ef  \n\u591a\u7684\u4e0d\u8bf4   \n\u76f4\u63a5\u770b\u4ee3\u7801\u3002\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<vector>\n#include<algorithm>\n#include<queue>\n#include<cstring>\nusing namespace std;\n#define N 1001\nint n,k,m,s,t;//\u5982\u9898\nint a[101][101],wen[101];//wen\u8be5\u57ce\u5e02\u6587\u5316\uff0ca\u7528\u6765\u8bfb\u5165\u77e9\u9635\nint d[100001];//\u5355\u6e90\u6700\u77ed\u8def\nbool vis[100001];//\u662f\u5426\u8bbf\u95ee\u8fc7 \u6700\u77ed\u8def\u4e2d\u7528\nint qi,mo,f;\u4e2d\u95f4\u7528\u6765\u8f93\u5165\u7684\ninline int read()//\u8bfb\u5165\u4f18\u5316\u4e0d\u591a\u8bf4\u4e86\n{\n    char ch=getchar();\n    int x=0,f=1;\n    while((ch>'9'||ch<'0')&&ch!='-')\n        ch=getchar();\n    if(ch=='-')\n    {\n        f=-1;\n        ch=getchar();\n    }\n    while('0'<=ch&&ch<='9')\n    {\n        x=x*10+ch-'0';\n        ch=getchar();\n    }\n    return x*f;\n}\nstruct Edge\n{\n    int v,w;\n    Edge(int _v=0,int _w=0){v=_v,w=_w;}\n};\nvector<Edge>e[N];//vector\u5b58\u90bb\u63a5\u8868\nvector<int>di[N];//\u7528vector\u5b58\u6bcf\u4e2a\u56fd\u5bb6\u7684\u6587\u5316\u548c\u90a3\u4e9b\u56fd\u5bb6\u76f8\u5bf9\nstruct Node\n{\n    int v,w;\n    Node(int _v=0,int _w=0){v=_v,w=_w;}\n    bool operator <(const Node &n) const\n    {\n        return w>n.w;\n    }\n};\npriority_queue<Node>q;//\u5806\u4f18\u5316\u6700\u77ed\u8def\nint x;\nbool kx(int x,int y)//\u5224\u65ad\u4e0b\u4e2a\u56fd\u5bb6\u80fd\u5426\u8d70\n{\n    for(int j=0;j<di[y].size();j++)\n     {\n     \tif(di[y][j]==x)return false;\n     }\n     return true;\n}\nvoid dijkstra()//\u6700\u77ed\u8def\u6a21\u677f\n{\n    d[s]=0;\n    q.push(Node(1,0));\n    while(!q.empty())\n       {\n       \tint x=q.top().v;\n       \tq.pop();\n       \tif(vis[x])continue;\n       \tvis[x]=true;\n       \tfor(int i=0;i<e[x].size();i++)\n       \t  {\n       \t  \tint v=e[x][i].v;\n       \t  \tint w=e[x][i].w;\n       \t  \tif(kx(wen[x],wen[v]))//\u5224\u65ad\u80fd\u5426\u8d70\n       \t  \t{\n       \t  \t    if(d[v]>d[x]+w)\n       \t  \t      {\n       \t  \t \t  d[v]=d[x]+w;\n       \t  \t \t  q.push(Node(v,d[v]));\n                  }\n            }\n            else\n       \t  \t continue;\n          }\n       }\n}\nint main()\n{\n    n=read();\n    k=read();\n    m=read();\n    s=read();\n    t=read();\t\n    for(int i=1;i<=n;i++)\n    wen[i]=read();\n    for(int i=1;i<=k;i++)\n      for(int j=1;j<=k;j++)\n      {\n      \tx=read();\n      \tif(x==1)di[i].push_back(j);\n      \ta[i][j]=x;\n      }\n    for(int j=1;j<=m;j++)\n       {\n       \tcin>>qi>>mo>>f;\n       \tif(a[mo][qi]==0)//\u5982\u679c\u4e0d\u654c\u5bf9\u518d\u52a0\u8fb9\n           e[qi].push_back(Edge(mo,f));\n       \tif(a[qi][mo]==0)\n           e[mo].push_back(Edge(qi,f));\n       }\n    memset(d,0x3f3f3f3f,sizeof(d));\n    dijkstra();\n    if(vis[t]&&wen[t]!=wen[s])cout<<d[t];\n    else cout<<\"-1\";\n    return 0;\n}\n```\n\u4f5c\u4e3a\u849f\u84bb\u7684\u6211  \n\u5927\u5bb6\u5e94\u8be5\u90fd\u80fd\u770b\u61c2\u6211\u7684\u4ee3\u7801  \n\u7b2c\u4e00\u6b21\u53d1\u9898\u89e3\u5e0c\u671b\u80fd\u8fc7\u554a\n%%%",
        "postTime": 1569503185,
        "uid": 117973,
        "name": "\u8c22\u8c22_\u5bf9\u4e0d\u8d77",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u4f5c\u4e3a\u4e00\u4e2a\u849f\u84bb\uff08\u7b2c\u4e00\u6b21\u5728\u9898\u89e3\u91cc\u53d1\u5e16\u54c8\uff0c\u591a\u591a\u5305\u6db5\uff09\uff0c\u8868\u793a\u8fd9\u9053\u9898\u76ee\u5176\u5b9e\uff08\u5e94\u8be5\uff09\u6ca1\u6709\u60f3\u8c61\u4e2d\u7684\u96be\uff0c\u4e00\u4e2aDFS\u52a0\u7b80\u5355\u7684\u526a\u679d\u5e94\u8be5\u5c31\u80fd\u8fc7\u3002\n\u9996\u5148\u8bf4\u4e00\u4e0b\u526a\u679d\u3002\u5bf9\u4e8e\u56fd\u5bb6i\u3001j\u95f4\u7684\u591a\u6761\u8def\u5f84\uff0c\u53ef\u4ee5\u5728\u8f93\u5165\u65f6\u5c31\u76f4\u63a5\u53d6\u5176\u4e2d\u8ddd\u79bb\u6700\u77ed\u7684\u8def\u5f84\uff0c\u628a\u5176\u5b83\u8def\u5f84\u76f4\u63a5\u6254\u6389\u3002\u663e\u7136\u8fd9\u79cd\u65b9\u6cd5\u5bf9\u4e8e\u6c42\u6700\u4f18\u89e3\u65e0\u5f71\u54cd\uff0c\u4e14\u5f97\u5230\u7684\u603b\u8ddd\u79bb\u4e5f\u8f83\u5c0f\u3002\u63a5\u4e0b\u6765\u5047\u8bbe\u4e00\u6761\u8def\u5f84\u53ef\u7ecf\u8fc7\u56fd\u5bb6i\u5230\u8fbe\u7ec8\u70b9t\uff08\u4e14\u8be5\u8def\u5f84\u8ddd\u79bb\u6700\u77ed\uff09\uff0c\u5f88\u663e\u7136s\u5230i\u7684\u8def\u5f84\u4e5f\u662f\u6700\u77ed\u7684\uff0ci\u5230t\u7684\u8def\u5f84\u4e5f\u662f\u6700\u77ed\u7684\uff0c\u6545\u5efa\u7acb\u4e00\u6570\u7ec4sum[i]\u6765\u8868\u793a\u5230\u8fbe\u56fd\u5bb6i\u7684\u6700\u77ed\u8def\u5f84\uff0c\u5f53dfs\u5230\u56fd\u5bb6i\u65f6\u82e5\u6b64\u65f6\u7684\u603b\u8ddd\u79bb>=sum[i]\uff0c\u5219\u76f4\u63a5\u7ed3\u675f\u9012\u5f52\uff0c\u8fd9\u6837\u53ef\u4ee5\u5927\u5e45\u51cf\u5c0f\u65f6\u95f4\u590d\u6742\u5ea6\uff08\u76f8\u5e94\u7684\uff0c\u4e5f\u4e0d\u7528\u5355\u72ec\u5efa\u7acb\u6570\u7ec4\u786e\u8ba4\u56fd\u5bb6i\u662f\u5426\u5df2\u8d70\u8fc7\uff09\u3002\n\u7136\u540e\u662f\u5224\u65ad\u90e8\u5206\u3002\u8fd9\u4e00\u90e8\u5206\u5f88\u70e6\uff0c\u9700\u8981\u6162\u6162\u6765\u3002\u9996\u5148\u5efa\u7acb\u4e00\u4e2a\u6570\u7ec4\u5b58\u50a8\u65c5\u884c\u8005\u5df2\u7ecf\u5b66\u4e60\u8fc7\u7684\u6240\u6709\u6587\u5316\uff08\u6211\u592a\u5f31\u4e86\uff0c\u4e8e\u662f\u624b\u5199\u4e86vector\uff09\uff0c\u7136\u540e\u518d\u51c6\u5907\u524d\u5f80\u56fd\u5bb6i\u524d\u8fdb\u884c\u68c0\u6d4b\u5c31\u884c\u4e86\u3002\u6ce8\u610f\u56fd\u5bb6i\u7684\u6587\u5316\u4e0d\u80fd\u4e0e\u5df2\u5b66\u4e60\u7684\u4efb\u4f55\u4e00\u79cd\u6587\u5316\u76f8\u540c\u6216\u6392\u65a5\u3002\n\u663e\u7136\u4efb\u548c\u4e00\u6761\u8def\u5f84\u7684\u957f\u5ea6\u5747>0\uff0c\u6545\u53ea\u8981\u67e5\u770b\u8def\u5f84\u957f\u5ea6\u5c31\u80fd\u5224\u65ad\u4e24\u4e2a\u56fd\u5bb6\u95f4\u662f\u5426\u6709\u8def\u5f84\u3002\n\u4e0b\u9762\u662f\u6211\u7684\u4ee3\u7801\uff0c\u5199\u7684\u4e0d\u600e\u4e48\u6837\uff0c\u5927\u4f6c\u4eec\u8f7b\u55b7~\n\uff08\u6ce8\uff1ap\u6570\u7ec4\u4e3a\u56fd\u5bb6i\u3001j\u95f4\u7684\uff08\u6700\u77ed\uff09\u8def\u5f84\u957f\u5ea6\uff0ch\u6570\u7ec4\u4e3a\u6587\u5316i\u6392\u65a5\u6587\u5316j\uff08\u6ce8\u610f\uff0c\u6392\u65a5\u662f\u5355\u5411\u7684\uff09\uff0cc\u6570\u7ec4\u4e3a\u56fd\u5bb6i\u7684\u6587\u5316\uff0cbag\u6570\u7ec4\u4e3a\u65c5\u884c\u8005\u5df2\u5b66\u4e60\u7684\u6587\u5316\uff0csum\u6570\u7ec4\u4e3a\u5230\u8fbe\u56fd\u5bb6i\u7684\u6700\u77ed\u8def\u5f84\u957f\u5ea6\u3002\uff09\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,k,m,s,t,u,v,d,flag,flag2,cnt;\nint c[105],h[105][105],p[105][105],sum[105],bag[105];\nint dfs(int l,int dis){\n\tif(dis>=sum[l])return 0;\n\tsum[l]=dis;\n\tif(l==t){\n\t\tflag=1;\n\t\treturn 0;\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tif(p[l][i]>0){\n\t\t\tflag2=1;\n\t\t\tfor(int j=1;j<=cnt;j++)if(h[c[i]][bag[j]]==1||c[i]==bag[j])flag2=0;\n\t\t\tif(flag2==1){\n\t\t\t    cnt++;bag[cnt]=c[i];\n\t\t\t    dfs(i,dis+p[l][i]);\n\t\t\t    cnt--;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\nint main(){\n    for(int i=1;i<=100;i++)sum[i]=100000000;\n\tcin>>n>>k>>m>>s>>t;\n\tfor(int i=1;i<=n;i++)cin>>c[i];\n\tfor(int i=1;i<=k;i++)for(int j=1;j<=k;j++)cin>>h[i][j];\n\tfor(int i=1;i<=m;i++){\n\t\tcin>>u>>v>>d;\n\t\tif(u>v)swap(u,v);\n\t\tif(p[u][v]==0||d<p[u][v])p[u][v]=d;\n\t\tp[v][u]=d;\n\t}\n\tcnt=1;bag[1]=c[s];\n\tdfs(s,0);\n\tif(flag==1)cout<<sum[t]<<endl;\n\telse cout<<-1<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1540046730,
        "uid": 67894,
        "name": "fishfree88",
        "ccfLevel": 0,
        "title": "\u3010DFS+\u526a\u679d\u3011"
    },
    {
        "content": "\u8fd9\u662f\u672c\u849f\u84bb\u7b2c\u4e00\u7bc7\u9898\u89e3\u3002~~\u56e0\u4e3a\u672c\u849f\u84bb\u4ece\u6765\u6ca1\u6709\u8fc7\u597d\u7684\u60f3\u6cd5\u3002~~\n\n\u8a00\u5f52\u6b63\u4f20\uff0c\u5728\u6211\u770b\u6765\uff0c\u8fd9\u9053\u9898\u5c31\u662f\u9053\u6a21\u677f\u9898\uff0c\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u88ab\u5212\u4e3a\u7eff\u9898\n\n~~\uff08\u53ef\u80fd\u56e0\u4e3a\u6211\u592a\u5f3a\u4e86\u5427\uff09~~\n\n\u6570\u636e\u5f88\u6c34\uff0c~~\u6211\u521a\u5f00\u59cb\u6ca1\u52a0\u76f8\u540c\u6587\u5316\u4e0d\u80fd\u8d70\u7684\u5224\u65ad\u8fd8A\u4e8610\u4e2a\u70b9~~\n\n\u672c\u9898\u6709\u51e0\u4e2a\u5751\u70b9\uff0c\u5b58\u56fe\u65f6\u8981\u6b63\u53cd\u5b58\u4e24\u904d\uff0c\u56e0\u4e3a\u662f\u65e0\u5411\u56fe\u3002\u8fd8\u6709\uff0ci\u6587\u5316\u6392\u65a5j\n\n\u6587\u5316\uff0c\u4f46j\u6587\u5316\u4e0d\u4e00\u5b9a\u6392\u65a5i\u6587\u5316\uff0c\u6240\u4ee5\u5e76\u67e5\u96c6~~\uff08\u51b0\u8336\u51e0\uff09~~\u662f\u4e0d\u53ef\u884c\u7684\u3002\u3002\u3002\n\n\u601d\u8def\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u8fb9\u8dd1dijistra\u8fb9\u8bb0\u5f55\u8dd1\u8fc7\u7684\u8def\u5f84\uff0c\u7528\u4e00\u4e2a\u524d\u7ee7\u6570\u7ec4pre\u6765\n\n\u7ef4\u62a4\uff0c\u7136\u540e\u6bcf\u6b21\u677e\u5f1b\u4e0b\u4e00\u4e2a\u70b9\u4e4b\u524d\uff0c\u5c31\u5224\u65adpre\u6570\u7ec4\u91cc\u7684\u57ce\u5e02\u6587\u5316\u662f\u5426\u548c\u4e0b\n\n\u4e00\u4e2a\u57ce\u5e02\u6587\u5316\u76f8\u540c\u6216\u8005\u6392\u65a5\uff0c\u6700\u540e\u8dd1\u51fa\u6765\u7684dis[t]\u5c31\u662f\u5230\u7ec8\u70b9\u56fd\u5bb6t\u7684\u6700\u77ed\n\n\u8ddd\u79bb\u4e86\u3002\u7528\u8fd9\u4e2a\u601d\u8def\uff0c\u6700\u540e\u8dd1\u4e8632ms\u3002\n\n\u732e\u4e0a\u4e11\u964b\u7684\u4ee3\u7801~~~\uff08\u6211\u7528\u7684\u662fgreater\u4f18\u5148\u961f\u5217\u4f18\u5316\uff0c\u4f60\u4e5f\u53ef\u4ee5\u8bd5\u8bd5\u4e0d\u52a0\n\n\u4f18\u5316\u7684\uff09\n\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int MAXN=707406378;//\u6700\u5927\u503c \nint cnt=0;\nbool vis[105];\nint a[105][105],c[105],head[105],dis[105],pre[105];//pre[i]\u5b58\u50a8i\u70b9\u7684\u524d\u4e00\u4e2a\u70b9\uff0c\u5f62\u6210\u94fe\u8868 \npriority_queue<pair<int,int>,\n               vector<pair<int,int> >,\n               greater<pair<int,int> > > Q;\nstruct edge{\n    int to;\n    int val;\n    int next;\n}e[10005];\nint read(){//\u8bfb\u5165\u4f18\u5316 \n    int x=0;int f=1;char s=getchar();\n    while(s<'0'||s>'9'){\n        if(s=='-')\tf=-1;\n        s=getchar();\n    }\n    while(s>='0'&&s<='9'){\n        x=x*10+s-'0';\n        s=getchar();\n    }\n    return f*x;\n}\nvoid addEdge(int u,int v,int val){//\u90bb\u63a5\u8868\u5efa\u56fe \n    e[++cnt].to=v;\n    e[cnt].val=val;\n    e[cnt].next=head[u];\n    head[u]=cnt;\n}\nbool judge(int u,int v){\n    int tmp=u;\n    while(tmp){\n    \t//\u5982\u679cV\u56fd\u5bb6\u7684\u6587\u5316\u6392\u65a5\u6240\u6709\u8d70\u8fc7\u7684\u56fd\u5bb6\u4e4b\u4e00\u7684\u6587\u5316\n\t\t//\u6216\u6240\u6709\u8d70\u8fc7\u7684\u56fd\u5bb6\u7684\u6587\u5316\u4e4b\u4e00\u4e0eV\u56fd\u5bb6\u76f8\u540c\n\t\t//\u90a3\u4e48\u5c31\u4e0d\u80fd\u8d70\uff0c\u8fd4\u56defalse \n        if(a[c[v]][c[tmp]]!=0||c[v]==c[tmp]){\n            return false;\n        }\n        //\u5426\u5219\u7ee7\u7eed\u5411\u524d\u626b\uff0c\u627e\u524d\u4e00\u4e2a\u56fd\u5bb6\u662f\u5426\u7b26\u5408\u8981\u6c42 \n        tmp=pre[tmp];\n    }\n    //\u6ca1\u6709\u627e\u5230\u4e0d\u7b26\u5408\u8981\u6c42\u7684\u8bf4\u660e\u6240\u6709\u7684\u56fd\u5bb6\u90fd\u7b26\u5408\u8981\u6c42\uff0c\u8fd4\u56detrue \n    return true;\n}\nvoid dijistra(int u){//dijistra+greater\u5806\u4f18\u5316\uff0c\u4e0d\u518d\u8d58\u8ff0 \n    memset(dis,127/3,sizeof(dis));//\u5f00\u59cb\u4e3a\u6b63\u65e0\u7a77 \n    dis[u]=0;\n    Q.push(make_pair(0,u));\n    while(Q.size()){\n        int k=Q.top().second;\n        Q.pop();\n        if(vis[k])\tcontinue;\n        vis[k]=1;\n        for(int i=head[k];i;i=e[i].next){\n        \t//\u5982\u679c\u8be5\u70b9\u53ef\u4ee5\u88ab\u677e\u5f1b\uff0c\u4e14\u8be5\u56fd\u5bb6\u7684\u6587\u5316\u4e0d\u6392\u65a5\u6240\u6709\u8d70\u8fc7\u7684\u56fd\u5bb6\u4e4b\u4e2d\u7684\u6587\u5316\u4e14\u4e0d\u76f8\u540c\uff0c\u90a3\u4e48\u5c31\u677e\u5f1b \n            if(dis[e[i].to]>dis[k]+e[i].val&&judge(k,e[i].to)){\n                pre[e[i].to]=k;//\u50a8\u5b58\u8def\u5f84 \u5373\u5f53\u524d\u56fd\u5bb6\u7684\u524d\u4e00\u4e2a\u70b9 \n                dis[e[i].to]=dis[k]+e[i].val;\n                Q.push(make_pair(dis[e[i].to],e[i].to));\n            }\n        }\n    }\n}\nint main(){\n//\tfreopen(\"culture.in\",\"r\",stdin);\n//\tfreopen(\"culture.out\",\"w\",stdout);\n    int n,k,m,s,t;\n    scanf(\"%d%d%d%d%d\",&n,&k,&m,&s,&t);\n    for(int i=1;i<=n;++i){\n        c[i]=read();\n    }\n    for(int i=1;i<=k;++i){\n        for(int j=1;j<=k;++j){\n            a[i][j]=read();\t\n        }\n    }\n    for(int i=1;i<=m;++i){\n        int u,v,d;\n        u=read();v=read();d=read();\n        addEdge(u,v,d);//\u65e0\u5411\u56fe\uff01\uff01 \n        addEdge(v,u,d);\n    }\n    dijistra(s);\n    if(dis[t]==MAXN){//\u5982\u679cdis[t]\u4ecd\u7b49\u4e8e\u6b63\u65e0\u7a77\uff0c\u8bf4\u660e\u65e0\u6cd5\u5230\u8fbe\u76ee\u7684\u56fd\u5bb6\uff0c\u8f93\u51fa-1 \n        printf(\"-1\\n\");\n        return 0;\n    }\n    printf(\"%d\\n\",dis[t]);//\u5426\u5219\u8f93\u51fa\u6700\u77ed\u8ddd\u79bb \n    return 0;\n}\n```\n\n\n\n\n",
        "postTime": 1537768083,
        "uid": 95244,
        "name": "tommymio",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u521a\u5b66\u4e86Dijkstra\u7b97\u6cd5\uff0c\u4e8e\u662f\u672c\u849f\u84bb\u6765\u5b9e\u6218\u6f14\u4e60\uff08\u6ca1\u60f3\u5230\u4e00\u904dA\u4e86\uff1f\uff1f\uff1f\uff09\n\n\u548c\u697c\u4e0bdalao\u4eec\u4e0d\u540c\uff0c\u56e0\u4e3a\u672c\u849f\u84bb\u786c\u8981\u7528vector\uff0c\u6240\u4ee5\u52a0\u4e86\u4e00\u5927\u5806stl\uff08\u4f18\u5148\u961f\u5217\uff0cset\uff09\u4f46\u662f\u7adf\u7136\u80fd\u8fc7\uff1f\uff01\uff08\u56e0\u4e3a\u6570\u636e\u592a\u6c34\uff09\n\n\u4e3a\u4ec0\u4e48\u4e0d\u7528\u90bb\u63a5\u77e9\u9635\uff1f \u56e0\u4e3a\u5218\u6c5d\u4f73\u7684\u7d2b\u4e66\u4e0a\u8bf4 \u5927\u591a\u6570\u60c5\u51b5\u4e0b\u4f7f\u7528priority\\_queue\u5b9e\u73b0\u7684Dijstra\u7b97\u6cd5\u662f\u6bd4\u57fa\u4e8e\u90bb\u63a5\u77e9\u9635\u7684Dijstra\u7b97\u6cd5\u5feb\u7684\u3002\n\n\uff08\u7136\u800c\u697c\u4e0bdalao\u7684\u9898\u89e3\u66f4\u597d\u7406\u89e3\u4e9b\uff09\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<vector>\n#include<queue>\n#include<set>\nusing namespace std;\nstruct edge{\n    int from,to,dis;\n};\nstruct data{\n    int d,u;\n    set <int> r;    //\u539f\u6765\u60f3\u7528bool\u5b58\u50a8\uff0c\u7136\u800c\u603b\u662f\u51fa\u95ee\u9898\n    bool operator < (const data &tmp) const{\n        return d>tmp.d;\n    }  //\u81ea\u5b9a\u4e49\u6570\u503c\u5c0f\u7684\u5148\u51fa\u5217\n};\nset <int> r1;\nint a[102][102],c[102],d[102],k;\nvector <edge> ed;     //\u5b58\u8fb9\nvector <int> g[102];   //\u5b58\u8fb9\u7684\u7f16\u53f7\npriority_queue <data> h;  \nvoid pc(data q,int x)     //\u6807\u8bb0\u5f53\u524d\u4f7f\u8005\u4f1a\u88ab\u54ea\u4e9b\u6587\u5316\u6392\u65a5\n{\n    q.r.insert(x);\n    for(int j=1;j<=k;j++)\n        if(a[j][x])\n            q.r.insert(j);\n}\nint main()\n{\n    memset(d,127/3,sizeof(d));\n    const int inf=d[0];\n    int n,m,s,t,i,j,q1,q2,q3,q4=-1;\n    scanf(\"%d%d%d%d%d\",&n,&k,&m,&s,&t);\n    for(i=1;i<=n;i++) scanf(\"%d\",&c[i]);\n    for(i=1;i<=k;i++)\n        for(j=1;j<=k;j++)\n            scanf(\"%d\",&a[i][j]);\n    for(i=1;i<=m;i++)\n    {\n        scanf(\"%d%d%d\",&q1,&q2,&q3);\n        ed.push_back((edge){q1,q2,q3});\n        g[q1].push_back(++q4);\n        ed.push_back((edge){q2,q1,q3});\n        g[q2].push_back(++q4);\n    }     //\u65e0\u5411\u56fe\u6240\u4ee5\u8981\u5b58\u4e24\u6b21\n    d[s]=0;\n    r1.insert(c[s]);\n    for(j=1;j<=k;j++)\n        if(a[j][c[s]])\n            r1.insert(j);\n    h.push((data){0,s,r1});        \n    while(!h.empty())\n    {\n        data x=h.top(); h.pop();\n        int u=x.u,len=g[u].size();        \n        if(x.d!=d[u]) continue;\n        for(i=0;i<len;i++)\n        {\n            edge &e=ed[g[u][i]];\n            data p=x;\n            if(!p.r.count(c[e.to]))     //\u4e0d\u88ab\u6392\u65a5\n                if(d[e.to]>d[u]+e.dis)     //\u53ef\u4ee5\u8d70\u5e76\u4e14\u8fd9\u79cd\u8d70\u6cd5\u66f4\u4f18\n                {\n                    d[e.to]=d[u]+e.dis;\n                    pc(p,c[e.to]);   //\u6807\u8bb0\n                    h.push((data){d[e.to],e.to,p.r});   //\u5165\u961f\n                }\n        }    \n    }\n    if(d[t]==inf) printf(\"-1\");    //\u5224\u65ad\u4f7f\u8005\u80fd\u5426\u5230\u8fbe\u7ec8\u70b9\n    else printf(\"%d\",d[t]);\n    return 0;\n}\n\n```",
        "postTime": 1504022654,
        "uid": 21679,
        "name": "\u9999\u98ce\u667a\u4e43",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u601d\u8def\u7b80\u5355\uff0c\u76f4\u63a5\u4ee3\u7801\u89e3\u91ca\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint road[101][101];//\u8bb0\u5f55\u662f\u5426\u901a\u8def \nint n,k,m,s,t,ans=1000000;\nint exc[101][101];//\u6587\u5316\u95f4\u7684\u6392\u65a5\u5173\u7cfb \nint cul[101];//\u7b2ci\u5ea7\u57ce\u5e02\u7684\u6587\u5316\u79cd\u7c7b \nbool ok[101];//\u5224\u65ad\u5f53\u524d\u57ce\u5e02\u7684\u6587\u5316\u662f\u5426\u5df2\u7ecf\u88ab\u5b66\u4e60 \nvoid dfs(int x,int sum)//x\u8868\u793a\u8d77\u70b9\uff0csum\u8868\u793a\u8ddd\u79bb \n{\n\tif(x==t)\n\t{\n\t\tans=min(ans,sum);//\u66f4\u65b0\u6700\u5c0f\u503c \n\t\treturn;\n\t}\n\tok[cul[x]]=1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(!road[x][i]||exc[cul[i]][cul[x]]||ok[cul[i]]) continue;//\u5982\u679cx\uff0ci\u4e4b\u95f4\u6ca1\u6709\u901a\u8def\uff1b\n        dfs(i,sum+road[x][i]);                                    //\u6216\u8005\u6587\u5316i\u7684\u6587\u5316\u6392\u65a5x\u7684\u6587\u5316\uff1b\n\t}                                                             //\u6216\u8005\u5f53\u524d\u57ce\u5e02\u6587\u5316\u5df2\u7ecf\u88ab\u5b66\u4e60\uff0c\u8df3\u8fc7 \n\tok[cul[x]]=1;//\u56de\u6eaf \n}\nint main()\n{\n\tcin>>n>>k>>m>>s>>t;\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&cul[i]);\n\tfor(int i=1;i<=k;i++)\n\t   for(int j=1;j<=k;j++) scanf(\"%d\",&exc[i][j]);\t    \n\tfor(int i=1;i<=m;i++)\n\t{\n\t    int gg,zz,xx;\n\t\tscanf(\"%d%d%d\",&gg,&zz,&xx);\n\t\troad[gg][zz]=xx;\n\t } //\u8f93\u5165\u4e0d\u7528\u89e3\u91ca \n\tdfs(s,0);\n\tif(ans==1000000) cout<<\"-1\"<<endl;\n\telse cout<<ans<<endl;\n\treturn 0;\n}\n```\n\n\u5c31\u8fd9\u6837\uff0c\u5176\u5b9e\u5c31\u662fdfs\u52a0\u51e0\u4e2a\u5224\u65ad\u6761\u4ef6",
        "postTime": 1572917259,
        "uid": 195918,
        "name": "\u5c71\u6d77\u65e0\u98ce",
        "ccfLevel": 0,
        "title": "\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u591a\u5947\u5947\u602a\u602a\u7684\u505a\u6cd5\uff1f\uff1f\uff1f\u96be\u9053\u4e0d\u662f\u4e00\u4e2adfs\u5c31\u89e3\u51b3\u7684\u5417\uff1f\uff1f\uff1f"
    },
    {
        "content": "\u8fd9\u9898\u4e0d\u96be\u5427\u3002\u3002\u770b\u4e86\u8fd9\u4e48\u591a\u5927\u795e\u7684\u65b9\u6cd5\uff0c\u6211\u60f3\u4e86\u60f3\uff0c\u4e3a\u4f55\u4e0d\u7528\u5e7f\u641c\u5462\uff1f\u5e7f\u641c\u7a0b\u5e8f\u5982\u4e0b\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nint n,s[101][101],a[101][101][2],u[2001][101],v,ans,o[50001],m,start,k,end,p[50001],d[101],pp[101];\nvoid bfs()\n{\n    int i,j,head=0,tail=1;\n    o[0]=start;\n    p[0]=0;\n    u[0][start]=1;\n    for(i=1;i<=n;i++)\n    if(s[pp[i]][pp[start]]==1)\n    u[0][i]=1;\n    else if(pp[i]==pp[start])\n    u[0][i]=1;\n    while(head!=tail)\n    {\n        for(i=1;i<=a[o[head]][0][0];i++)\n        if(u[head][a[o[head]][i][0]]==0&&(d[a[o[head]][i][0]]>p[head]+a[o[head]][i][1]||d[a[o[head]][i][0]]==0))//\u5224\u65ad\n        {\n            for(j=1;j<=n;j++)\n            if(s[pp[j]][pp[a[o[head]][i][0]]]==1)\n            u[tail][j]=1;\n            else if(u[head][j]==1)\n            u[tail][j]=1;\n            else if(pp[j]==pp[a[o[head]][i][0]])\n            u[tail][j]=1;\n            d[a[o[head]][i][0]]=p[head]+a[o[head]][i][1];\n            p[tail]=d[a[o[head]][i][0]];\n            o[tail]=a[o[head]][i][0];\n            tail++;\n            tail%=50000;\n        }\n        head++;\n        head%=50000;\n    }\n}\nint main()\n{\n    int i,j,dd,b,c;\n    cin>>n>>k>>m>>start>>end;\n    for(i=1;i<=n;i++)\n    scanf(\"%d\",&pp[i]);\n    for(i=1;i<=k;i++)\n    for(j=1;j<=k;j++)\n    scanf(\"%d\",&s[i][j]);\n    for(i=1;i<=m;i++)\n    {\n        scanf(\"%d%d%d\",&dd,&b,&c);\n        a[dd][++a[dd][0][0]][0]=b;\n        a[dd][a[dd][0][0]][1]=c;\n        a[b][++a[b][0][0]][0]=dd;\n        a[b][a[b][0][0]][1]=c;\n    }\n    bfs();\n    if(d[end]!=0)\n    cout<<d[end];//\u5224\u65ad\u91cd\u4e2d\u70b9\u662f\u5426\u5230\u8fbe\n    else\n    cout<<-1;\n    return 0;\n}\n```",
        "postTime": 1475656731,
        "uid": 24805,
        "name": "luaddict",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u770b\u4e86\u770bdaolao\u4eec\u7684\u9898\u89e3\uff0c\u53d1\u73b0\u6ca1\u6709\u4ec0\u4e48Dijkstra\u7b97\u6cd5\u7684\u9898\u89e3\u3002\n\n~~\u6211\u8fd9\u4e48\u7231Dijkstra\u7684\u4eba\u600e\u4e48\u80fd\u5fcd\u5462~~\n\n\u5728\u8fd9\u53d1\u7bc7\u7b80\u5355\u6613\u61c2\u7684Dijkstra\u9898\u89e3\u3002\n\n\u8bf4\u5b9e\u8bdd\u8fd9\u9898\u6211\u5199\u7684\u65f6\u5019\u662f\u5148\u6253\u4e86\u4e00\u904dDijkstra\u7684\u6a21\u677f\u7136\u540e\u5c06\u4e00\u4e9b\u5224\u5b9a\u52a0\u4e86\u8fdb\u53bb.\n\n\u6240\u4ee5.....\n\n\u8fd9\u662f\u4e00\u9053\u6a21\u677f\u9898\uff08~~\u4e00\u672c\u6b63\u7ecf\u7684\u80e1\u8bf4\u516b\u9053~~\uff09\n\n\u4ee3\u7801\u5982\u4e0b\uff08~~\u6a21\u677f\u6ca1\u4ec0\u4e48\u597d\u8bf4\u7684~~\uff09\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst long long inf=2147483647;\nint N,K,M,S,T;\nint c[105];\nint a[105][105];\nstruct edge{\n\tint v,next,val;\n}e[20005];\nint cnt;\nint head[105];\nvoid add(int u,int v,int val){\n\t++cnt;\n\te[cnt].v=v;\n\te[cnt].val=val;\n\te[cnt].next=head[u]; \n\thead[u]=cnt;\n}\nint dis[110];\nbool vis[110];\nbool pan(int x){\n\tint jk[105],l=0;\n\tfor(int i=1;i<=N;i++)\n\tif(vis[c[i]])\n\tjk[++l]=c[i];\n\tfor(int i=1;i<=l;i++)\n\tif(a[c[x]][jk[i]])\n\treturn 1;\n\treturn 0;\n}\nvoid dijsktra(){\n\tint minn,u;\n\tfor(int j=1;j<=N;j++){\n\t\tdis[j]=inf;\n\t\tvis[j]=0;\n\t}\n\tdis[S]=0;\n\tfor(int i=1;i<N;i++){\n\t\tminn=inf;\n\t\tu=S;\n\t\tfor(int j=1;j<=N;j++){\n\t\t\tif(!vis[c[j]]&&minn>dis[j]&&!pan(j)){\n\t\t\t\tminn=dis[j];\n\t\t\t\tu=j;\n\t\t\t}\n\t\t}\n\t\tvis[c[u]]=1;\n\t\tdis[u]=minn;\n\t\tfor(int j=head[u];j;j=e[j].next){\n\t\t\tint v=e[j].v;\n\t\t\tif(!vis[c[v]]&&dis[u]+e[j].val<dis[v]&&!pan(v))\n\t\t\tdis[v]=dis[u]+e[j].val;\n\t\t}\n\t}\n}\nvoid Read(){\n\tscanf(\"%d %d %d %d %d\",&N,&K,&M,&S,&T);\n\tfor(int i=1;i<=N;i++)\n\tscanf(\"%d\",&c[i]);\n\tfor(int i=1;i<=K;i++)\n\tfor(int j=1;j<=K;j++)\n\tscanf(\"%d\",&a[i][j]);\n\tint aa,b,c;\n\tfor(int i=1;i<=M;i++){\n\t\tscanf(\"%d %d %d\",&aa,&b,&c);\n\t\tadd(aa,b,c);\n\t\tadd(b,aa,c);\n\t}\n}\nvoid Solve(){\n\tif(c[S]==c[T]||a[c[T]][c[S]]){\n\t\tprintf(\"-1\");\n\t\treturn;\n\t}\n\tdijsktra();\n\tif(dis[T]==inf)\n\tprintf(\"-1\");\n\telse \n\tprintf(\"%d\",dis[T]);\n}\nint main(){\n\t//freopen(\"culture.in\",\"r\",stdin);\n\t//freopen(\"culture.out\",\"w\",stdout);\n\tRead();\n\tSolve();\n\treturn 0;\n}\n```\n",
        "postTime": 1564449773,
        "uid": 203825,
        "name": "\u5207\u683c\u74e6\u00b7\u661f",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u5bf9\u4e8e\u8fd9\u6837\u4e00\u4e2a\u6ca1\u6709\u6b63\u89e3\u7684\u9898\u76ee\uff0c\n\u6211\u60f3\u7ed9\u5927\u5bb6\u4e00\u4e2a\u6709\u6280\u672f\u542b\u91cf\u7684\u641c\u7d22\u7b97\u6cd5\u3002\n\n\u9996\u5148\u7528A*\u7684\u601d\u60f3\uff0c\u5982\u679c\u5f53\u524d\u5df2\u8d70\u7684\u8ddd\u79bb+\u8fd9\u4e2a\u70b9\u5230t\u7684\u4e0d\u7ba1\u9650\u5236\u7684\u6700\u77ed\u8def>=ans\uff0c\u90a3\u4e48\u53ef\u4ee5\u76f4\u63a5\u526a\u679d\u3002\n\n\u5176\u6b21\u7528\u4f4d\u8fd0\u7b97\uff08bitset\uff09\u52a0\u5feb\u5224\u65ad\u6587\u5316\u6392\u65a5\u3002\n\n\u6700\u6ca1\u6709\u6280\u672f\u542b\u91cf\u4f46\u662f\u6700\u6709\u7528\u7684\u5c31\u662f\u5224\u65ad\u6709\u6ca1\u6709\u91cd\u590d\u8d70\u540c\u4e00\u4e2a\u70b9\uff08\u4e0d\u8fc7\u540c\u4e00\u79cd\u6587\u5316\u4e0d\u80fd\u8d70\u591a\u6b21\uff0c\u8fd9\u5df2\u7ecf\u5728\u524d\u9762\u4e00\u4e2a\u5224\u8fc7\u4e86\uff09\n\n\u7136\u540e\u3002\u3002\u3002\u3002\u3002\u3002\u8fd9\u4e48\u6b63\u7ecf\u7684\u7b97\u6cd5\u5176\u5b9e\u662f\u4f1aT\u4e00\u4e2a\u70b9\u7684\uff0c\u90a3\u4e48\uff0c\u9762\u5411\u6570\u636e\u7f16\u7a0b\u5c31\u884c\u4e86\u3002\n\nAC Code:\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<queue>\n#include<vector>\n#include<set>\n#include<bitset>\n#define maxn 205\n#define maxm 20005\nusing namespace std;\n\nint ans=0x3f3f3f3f;\nint n,k,m,s,t,dis[maxn][maxn],c[maxn];\nint info[maxn],Prev[maxm],to[maxm],cst[maxm],cnt_e;\ninline void Node(int u,int v,int ct){ Prev[++cnt_e]=info[u],info[u]=cnt_e,to[cnt_e]=v,cst[cnt_e]=ct; }\n\nint hc[maxn],tot = 0;\nbool vis[maxn];\nbitset<maxn>sta,pc[maxn];\nvoid dfs(int now,int dep)\n{\n\ttot ++;\n\tif(tot > 50000) return;\n\tif(dis[now][t] + dep >= ans) return;\n\tif(now == t){ ans = dep;return; }\n\tvis[now] = 1;\n\tfor(int i=info[now];i;i=Prev[i])\n\t\tif(!vis[to[i]] && (!(sta&pc[c[to[i]]]).any()))\n\t\t{\n\t\t\t(!hc[c[to[i]]]++) && (sta[c[to[i]]]=1);\n\t\t\tdfs(to[i],dep+cst[i]);\n\t\t\tif(tot > 50000) return;\n\t\t\t(!--hc[c[to[i]]]) && (sta[c[to[i]]]=0);\n\t\t\tif(dis[now][t] + dep >= ans){ vis[now] = 0;return; }\n\t\t}\n\tvis[now] = 0;\n}\n\nint main()\n{\n\tscanf(\"%d%d%d%d%d\",&n,&k,&m,&s,&t);\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&c[i]);\n\tfor(int i=1;i<=k;i++)\n\t\tfor(int j=1;j<=k;j++)\n\t\t{\n\t\t\tint tmp;\n\t\t\tscanf(\"%d\",&tmp);\n\t\t\tif(tmp) pc[i][j]=1;\n\t\t}\n\tfor(int i=1;i<=k;i++) \n\t\tpc[i][i] = 1;\n\t\t\n\tmemset(dis,0x3f,sizeof dis);\n\tfor(int i=1,u,v,w;i<=m;i++)\n\t{\n\t\tscanf(\"%d%d%d\",&u,&v,&w);\n\t\tNode(u,v,w),Node(v,u,w);\n\t\tdis[u][v] = dis[v][u] = min(dis[u][v] , w);\n\t}\n\tfor(int i=1;i<=n;i++) dis[i][i] = 0;\n\tfor(int k=1;k<=n;k++)\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tfor(int j=1;j<=n;j++)\n\t\t\t\tdis[i][j] = min(dis[i][j] , dis[i][k] + dis[k][j]);\n\t\t\n\tsta[c[s]] = 1;\n\tdfs(s,0);\n\tif(ans == 0x3f3f3f3f || tot > 50000) ans = -1;\n\tprintf(\"%d\\n\",ans);\n}\n```",
        "postTime": 1541858713,
        "uid": 30037,
        "name": "Freopen",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u8c01\u8bf4\u6570\u636e\u52a0\u5f3a\u4e4b\u540e\u6700\u77ed\u8def\u8fc7\u4e0d\u4e86\u7684\uff01\uff01\uff01\uff01\uff01\uff1f\uff1f\uff1f\uff1f\uff01\uff01\n\n\u4e0b\u9762\u6211\u6765\u63a8\u51fa\u5806\u4f18\u5316dijkstra\u505a\u6cd5\u3002\u6839\u672c\u4e0d\u7528\u679a\u4e3e\u524d\u9a71\u7ed3\u70b9\uff0c\u7136\u540e\u65ad\u8fb9\uff0c\u53ea\u9700\u8981\u5224\u65ad\u4e24\u4e2a\u56fd\u5bb6\u4e4b\u95f4\u6587\u5316\u7684\u6392\u65a5\u5173\u7cfb\u5c31\u597d\u4e86\uff0c\u7136\u540e\u76f4\u63a5\u52a0\u6216\u8005\u4e0d\u52a0\u8fd9\u6761\u8fb9\uff0c\u7136\u540e\u5c31\u53d8\u6210\u4e86\u4e00\u9053~~\u6700\u77ed\u8def\u7684\u677f\u5b50\u9898~~~~~~\u3002\u3002\u3002\n\n\n\u732e\u4e0a\u6211~~\u5947\u4e11\u65e0\u6bd4~~\u7684\u4ee3\u7801\uff1a\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<queue>\n#include<cstring>\n#include<algorithm>\n#define maxn 100+1\n#define maxn1 10000+1\nusing namespace std;\ninline int qread()             //\u5feb\u8bfb\u3002\n{\n    char c=getchar();int num=0,f=1;\n    for(;!isdigit(c);c=getchar()) if(c=='-') f=-1;\n    for(;isdigit(c);c=getchar()) num=num*10+c-'0';\n    return num*f;\n}\nint n,m,dis[maxn],head[maxn],s,k,num,t,c[maxn],pc[maxn][maxn],xx[maxn];        //dis\u6570\u7ec4\u5b58\u50a8\u70b9\u5230\u8d77\u70b9\u7684\u6700\u77ed\u8def\uff0cpc\u4e3a\u6392\u65a5\u5173\u7cfb\u3002\nstruct Edge\n{\n    int v,w,nxt;\n}edge[maxn1];\ninline void ct(int u,int v,int w)  //\u94fe\u5f0f\u524d\u5411\u661f\u5b58\u56fe\u3002\n{\n    edge[++num].v=v;\n    edge[num].w=w;\n    edge[num].nxt=head[u];\n    head[u]=num;\n}\nstruct node\n{\n    int x,y;\n    bool operator < (const node &a) const  //\u91cd\u8f7d\u8fd0\u7b97\u7b26\uff0c\u628a\u5927\u6839\u5806\u8f6c\u5316\u4e3a\u5c0f\u6839\u5806\u3002\n    {\n        return y>a.y;\n    }\n};\nvoid dijkstra()\n{\n    memset(dis,0x3f,sizeof(dis));  //\u521d\u59cb\u5316\u3002\n    dis[s]=0;\n    priority_queue<node>q;     //\u4f18\u5148\u961f\u5217\u6a21\u62df\u5806\u3002\n    q.push((node){s,0});\n    while(!q.empty())\n    {\n        int u=q.top().x,d=q.top().y;\n        q.pop();\n        if(d!=dis[u]) continue;\n        for(int i=head[u];i;i=edge[i].nxt)\n        {\n            int v=edge[i].v;\n            if((dis[v]>dis[u]+edge[i].w))  //dijkstra\u5957\u8def\u3002\u3002\n            {\n                dis[v]=dis[u]+edge[i].w;\n                q.push((node){v,dis[v]});\n            }\n        }\n    }\n}\nint main()\n{\n    n=qread(),k=qread(),m=qread(),s=qread(),t=qread();\n    for(int i=1;i<=n;++i)\n        c[i]=qread();\n    for(int i=1;i<=k;++i)\n    {\n        for(int j=1;j<=k;++j)\n        {\n            pc[i][j]=qread();\n        }\n    }\n    for(int i=1,u,v,w;i<=m;++i)\n    {\n        u=qread(),v=qread(),w=qread();\n        if(pc[c[v]][c[u]]==0) ct(u,v,w);  //\u4e0a\u9762\u5f00\u59cb\u8bf4\u7684\u52a0\u8fb9\u64cd\u4f5c\u3002\n        if(pc[c[u]][c[v]]==0) ct(v,u,w);\n    }\n    dijkstra();\n    if(dis[t]!=1061109567&&c[s]!=c[t])   //\u5982\u679c\u8d77\u70b9\u7ec8\u70b9\u6587\u5316\u4e00\u6837\u6216\u4e0d\u80fd\u5230\u8fbe\uff0c\u663e\u7136\u8f93\u51fa-1\u3002\n      cout<<dis[t]<<'\\n';\n    else\n      cout<<\"-1\"<<'\\n';\n    return 0;\n}\n```\n\n## \u4e0d\u8981\u6284\u88ad\u54e6\uff01",
        "postTime": 1539780648,
        "uid": 68622,
        "name": "King\u4e28\u5e1d\u5fa1\u5a01",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u63d0\u4f9b~~Dijkstreap~~ Dijkstra+heap\n\n\u5f00set\u4fdd\u5b58\u8bbf\u95ee\u8fc7\u7684\u56fd\u5bb6\u7f16\u53f7\n\nset::insert(x).second==0\u5219\u5c31\u662f\u5df2\u7ecf\u8bbf\u95ee\u8fc7\u4e86x\n\n\u4f9d\u636e\u9898\u610f\u6a21\u62df\u6700\u77ed\u8def\u8fc7\u7a0b\u5c31ok\u4e86\n\n```cpp\n#include<set>\n#include<queue>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\ntypedef set<int>si;\nconst int N=101,INF=1e8;\nbool exc[N][N],vis[N];\nint n,k,m,s,t,head[N],cnt,c[N],d[N];\nstruct edge{int to,w,next;}e[N*N];\ninline void addedge(int a,int b,int c)\n{\n\te[++cnt].next=head[a];\n\thead[a]=cnt;\n\te[cnt].to=b;\n\te[cnt].w=c;\n}\nstruct heap\n{\n\tint id,dis;si vis;\n\tbool operator<(const heap &h)const\n\t{\n\t\treturn dis>h.dis;\n\t}\n};\npriority_queue<heap>q;\ninline int dijkstra(int start,int end)\n{\n\tfill(d+1,d+n+1,INF);d[start]=0;\n\tsi init;init.insert(c[start]);\n\tq.push((heap){start,0,init}); //\u521d\u59cb\u5316\n\twhile (q.size())\n\t{\n\t\tint p=q.top().id;si done=q.top().vis;q.pop();\n\t\tif (vis[p])continue;vis[p]=1;\n\t\tfor (int i=head[p];i;i=e[i].next)\n\t\t{\n\t\t\tint to=e[i].to,newdis=d[p]+e[i].w;\n\t\t\tif (vis[to])continue;\n\t\t\tif (newdis<d[to])\n\t\t\t{\n\t\t\t\tsi DONE=done;\n\t\t\t\tif (done.insert(c[to]).second&&!exc[c[to]][c[p]])\n\t\t\t\t\tq.push((heap){to,d[to]=newdis,done}),done=DONE;\n\t\t\t}\n\t\t}\n\t}\n\treturn d[end]==INF?-1:d[end]; //\u65e0\u6cd5\u5230\u8fbe\u8fd4\u56de-1\n}\nint main()\n{\n\tscanf(\"%d%d%d%d%d\",&n,&k,&m,&s,&t);\n\tfor (int i=1;i<=n;i++)scanf(\"%d\",&c[i]);\n\tfor (int i=1;i<=k;i++)\n\t\tfor (int j=1;j<=k;j++)\n\t\t\tscanf(\"%d\",&exc[i][j]);\n\twhile (m--)\n\t{\n\t\tint u,v,w;\n\t\tscanf(\"%d%d%d\",&u,&v,&w);\n\t\taddedge(u,v,w);addedge(v,u,w);\n\t}\n\tprintf(\"%d\",dijkstra(s,t));\n\treturn 0;\n}\n```",
        "postTime": 1537353964,
        "uid": 14374,
        "name": "zhengrunzhe",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u6587\u7ae0\u539f\u5740\uff1a\n\n<http://blog.csdn.net/love\\_phoebe/article/details/77196579>\n\n\u9996\u5148\u8bf4\u4e00\u4e0b\u4ec0\u4e48\u53eb\u5355\u6e90\u6700\u77ed\u8def\u5f84\u95ee\u9898\uff1a\n\n\u7ed9\u5b9a\u4e00\u4e2a\u5e26\u6743\u6709\u5411\u56feG=\uff08V,E\uff09\uff0c\u5176\u4e2d\u6bcf\u6761\u8fb9\u7684\u6743\u662f\u4e00\u4e2a\u5b9e\u6570\u3002\u53e6\u5916\uff0c\u8fd8\u7ed9\u5b9aV\u4e2d\u7684\u4e00\u4e2a\u9876\u70b9\uff0c\u79f0\u4e3a\u6e90\u3002\u73b0\u5728\u8981\u8ba1\u7b97\u4ece\u6e90\u5230\u5176\u4ed6\u6240\u6709\u5404\u9876\u70b9\u7684\u6700\u77ed\u8def\u5f84\u957f\u5ea6\u3002\u8fd9\u91cc\u7684\u957f\u5ea6\u5c31\u662f\u6307\u8def\u4e0a\u5404\u8fb9\u6743\u4e4b\u548c\u3002\uff08\u6458\u81ea\u767e\u79d1\uff09\n\n\u8fd9\u4e2a\u9898\u7b97\u662f\u6b63\u513f\u516b\u7ecf\u7684\u5355\u6e90\u6700\u77ed\u8def\u5f84\u95ee\u9898\uff0c\u56e0\u4e3a\u56fe\u4e2d\u8fb9\u4e0a\u7684\u6743\u503c\u4e0d\u53ef\u80fd\u4e3a\u8d1f\u503c\uff0c\u6240\u4ee5\u91c7\u7528dijkstra\u7b97\u6cd5\uff1a\n\ndijkstra\u7b97\u6cd5\u91c7\u7528\u8d2a\u5fc3\u7b56\u7565\uff0c\u4e0b\u9762\u8fdb\u884c\u56fe\u89e3\n\n![](http://cdnv2.luogu.org/upload/pic/7057.png)\n\n\u51c6\u5907\uff1a\u6211\u4eec\u9700\u8981\u4e00\u4e2ab\u6570\u7ec4\u4f5c\u4e3a\u4e00\u4e2a\u96c6\u5408\u7528\u6765\u8868\u793a\u5df2\u7ecf\u8fbe\u5230\u6700\u4f18\u7684\u70b9\uff0cb[i]=0\u8868\u793a\u7f16\u53f7\u4e3ai\u7684\u70b9\u5728\u96c6\u5408\u5916\uff1b\n\n\u4e00\u4e2adis\u6570\u7ec4\u8868\u793a\u8ddd\u79bb\uff0cdis\u3010i\u3011\u8868\u793a\u51fa\u53d1\u70b9\u5230i\u7684\u6700\u77ed\u8ddd\u79bb\uff0cdis\u521d\u59cb\u5316\u4e3a-1\uff1b\n\n1\uff0cb\u30101\u3011=1\uff081\u52301\u8ddd\u79bb\u4e3a0\uff0c\u5df2\u8fbe\u5230\u6700\u4f18\uff09\uff0c\u7136\u540e\u4ece\u51fa\u53d1\u70b9\u70b91\u5f00\u59cb\u627e\u5230\u76ee\u6807\u70b9\u80fd\u5230\u8fbe\u7684\u70b92,3\u5e76\u66f4\u65b0dis\u6570\u7ec4\uff1b\n\n\n\u4ece\u4e2d\u9009\u62e9\u8ddd\u79bb\u51fa\u53d1\u70b9\u6700\u8fd1\u7684\u70b93\uff08\u5373\u4eceb\u6570\u7ec4\u4e3a0\uff0cd\u503c\u6700\u5c0f\u4e14\u4e0d\u4e3a0\u7684\u70b9\u4e2d\u9009\u4e00\u4e2a\u70b9\uff09\uff1b\n\n2\uff0cb\u30103\u3011=1\uff0c\u4ece\u80fd\u4ece3\u5230\u8fbe\u7684b\u3010i\u3011=0\u7684\u70b9\u4e2d\u8fdb\u884c\u4e0b\u4e00\u6b65\u64cd\u4f5c\uff1b\u5206\u4e24\u79cd\u60c5\u51b5\uff0cdis\u4e3a-1\u548c\u4e0d\u4e3a-1\uff1b\u5982\u70b95\u7684dis\u503c\u4e3a-1\uff0c\u8fa3\u4e48d[5]=map[5][3]+d[3]=10+1=11;  \u5982dis[2]=4,dis[2]=min(dis[2],map[2][3],+d[3])=min(4,5)=4;\n\n\u76ee\u7684\u5c31\u662f\u5229\u7528\u7b2c1\uff0c\u6b65\u627e\u5230\u7684\u8ddd\u79bb\u76ee\u6807\u70b9\u6700\u8fd1\u7684\u70b9\u6765\u5c1d\u8bd5\u4f18\u5316\u5f53\u524d\u7684\u8def\u5f84\uff1b\n\n\n3\uff0c\u4eceb\u6570\u7ec4\u4e3a0\uff0cd\u503c\u6700\u5c0f\u4e14\u4e0d\u4e3a0\u7684\u70b9\u4e2d\u9009\u4e00\u4e2a\u70b9\uff081,3 b\u6570\u7ec4\u503c\u5df2\u4e3a1\uff09\uff0c\u9009\u51fa\u70b92\uff1b\n\n4\uff0c\u91cd\u590d\u7b2c\u4e8c\u6b65b\u30102\u3011=1\uff1b\n\n\u4ece\u80fd\u4ece3\u5230\u8fbe\u7684b\u3010i\u3011=0\u7684\u70b9\u4e2d\u8fdb\u884c\u4e0b\u4e00\u6b65\u64cd\u4f5c\uff1b\u5206\u4e24\u79cd\u60c5\u51b5\uff0cdis\u4e3a-1\u548c\u4e0d\u4e3a-1\uff1b\u5982\u70b94\u7684dis\u503c\u4e3a-1\uff0c\u8fa3\u4e48d[4]=map[4][2]+d[2]=2+4=6;  \u5982dis[5]=11,dis[5]=min(dis[5],map[2][5],+d[2])=min(11,1+4)=5;\n\n\n\u76f4\u5230\u6240\u6709\u7684\u70b9b\u6570\u7ec4\u503c\u4e3a1\uff0c\u8f93\u51fadis\u6570\u7ec4\u5c31\u662f\u521d\u59cb\u70b9\u5230\u6bcf\u4e00\u4e2a\u70b9\u7684\u6700\u8fd1\u8def\u5f84\u957f\u5ea6\n\n\u7ed9\u51fa\u9898\u76ee\u4ee3\u7801\uff1a\n\n       \n      \n          \n```cpp\n#include<cstring>  \n#include<cmath>  \n#include<iostream>  \n#include<climits>  \nusing namespace std;  \nconst int L=110;  \nint C[L],vis[L][L],map[L][L],dis[L];// \u6587\u5316\u503c\u6570\u7ec4\uff0c\u6587\u5316\u662f\u5426\u51b2\u7a81\u6570\u7ec4 \u5730\u56fe  \u51fa\u53d1\u70b9\u5230\u6bcf\u4e2a\u70b9\u7684\u6700\u77ed\u8ddd\u79bb\u6570\u7ec4   \nbool b[L]; // \u70b9\u662f\u5426\u6700\u4f18\u5224\u65ad\u6570\u7ec4   \nint main(){  \n    memset(map,0,sizeof(map));  \n    int N,K,M,S,T;  \n    cin>>N>>K>>M>>S>>T;  \n    for(int i=1;i<=N;i++)cin>>C[i];  \n    for(int i=1;i<=K;i++)for(int n=1;n<=K;n++)cin>>vis[i][n];  \n    for(int i=1;i<=M;i++){  \n        int x,y,d;  \n        cin>>x>>y>>d;  \n        map[x][y]=d;  \n        map[y][x]=d;  \n    }  \n    memset(dis,-1,sizeof(dis));  \n    //\u6570\u636e\u521d\u59cb\u5316  \n    for(int i=1;i<=N;i++){  \n        if(i==S)dis[i]=0;  \n        else if(map[S][i]!=0){  \n            if(vis[C[i]][C[S]]==0)dis[i]=map[S][i];//\u521d\u59cb\u5316   \n        }  \n    }  \n    b[S]=1;// \u521d\u59cb\u5316   \n    for(int i=1;i<N-1;i++){  \n        int xmin=INT_MAX,k=-1;  \n        for(int n=1;n<=N;n++)if(!b[n]&&xmin>dis[n]&&dis[n]!=-1){  \n            xmin=dis[n];  \n            k=n; //\u6311\u51fa\u7684\u6700\u8fd1\u7684\u70b9   \n        }  \n        if(k==-1)continue;  \n        //\u5229\u7528\u6311\u51fa\u7684\u70b9\u8fdb\u884c\u4f18\u5316   \n        b[k]=1;  \n        for(int n=1;n<=N;n++)if(!b[n]&&map[n][k]!=0&&vis[C[n]][C[k]]==0){  \n            if(dis[n]==-1)dis[n]=dis[k]+map[n][k];  \n            else dis[n]=min(dis[n],dis[k]+map[n][k]);  \n        }  \n    }  \n    cout<<dis[T];  \n    return 0;  \n}   \n\n```",
        "postTime": 1502804998,
        "uid": 39098,
        "name": "zhuozhizhao",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u8868\u793a\u8fd9\u9053\u9898\u4e0d\u9700\u8981\u4ec0\u4e48\u6700\u77ed\u8def\u7b97\u6cd5(\u611f\u89c9\u8fd9\u6837\u5199\u662f\u9519\u7684) \u4e5f\u5e76\u4e0d\u9700\u8981\u5012\u7740\u641c\u7d22 \u5176\u5b9e\u53ea\u9700\u8981\u591a\u4e00\u4e2a\u4e0e\u7ec8\u70b9\u7684\u5224\u65ad\u5c31\u53ef\u4ee5\u4e86\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<cstdlib>\nusing namespace std;\nconst int Inf=100000010;\nint n,m,k,s,t;\nint k1=0,sum=0,ans=Inf;\nint con[110],head[20010],fig[110][110];//con[i]=j\u8868\u793a\u7b2ci\u4e2a\u56fd\u5bb6\u51b2\u7a81\u7b2cj\u79cd\u6587\u5316 fig[i][j]\u8868\u793ai j\u6587\u5316\u5173\u7cfb \nbool road[110],exp[110],flag=false;//road\u8868\u793a\u5df2\u8bbf\u95ee\u7684\u56fd\u5bb6 exp\u8868\u793a\u5df2\u8bbf\u95ee\u7684\u6587\u5316 \nstruct node{\n    int to,next,w;\n}e[20010];\nvoid add(int u,int v,int w)\n{\n    k1++;\n    e[k1].next=head[u];\n    e[k1].to=v;\n    e[k1].w=w;\n    head[u]=k1;\n}\nbool judge(int x)\n{\n  if(road[x] || exp[con[x]]) return false;\n   for(int i=1;i<=k;i++)\n    if(exp[i]&&fig[con[x]][i]==1||fig[con[t]][con[x]]==1||fig[con[t]][i]) return false;\n    //\u540e\u4e24\u4e2a\u5224\u65ad\u8868\u660e\u5982\u679c\u7ec8\u70b9\u7684\u6587\u5316\u51b2\u7a81\u5df2\u7ecf\u5b66\u8fc7\u7684\u6587\u5316\u548c\u8bbf\u95ee\u6b21\u56fd\u5bb6\u7684\u6587\u5316 \u5219return false \n     return true;\n}\nvoid dfs(int x,int sum)\n{\n    bool ff=false;\n  if(x==t){\n      flag=true;\n      ans=min(ans,sum);\n      return ;\n  }\n  if(sum>=ans) return;//\u526a\u679d \n  for(int i=head[x];i;i=e[i].next)\n  {\n      int p=e[i].to;\n      if(judge(p))\n      {\n        ff=true;//\u5224\u65ad\u662f\u5426\u53ef\u4ee5\u5f80\u4e0b\u8d70 \n        road[p]=true,exp[con[p]]=true;\n        dfs(p,sum+e[i].w);\n        road[p]=false,exp[con[p]]=false;\n    }\n  }\n  if(ff==false){\n      printf(\"-1\");//\u5982\u679c\u6ca1\u6709\u5f80\u4e0b\u8d70 \u8fd9\u76f4\u63a5\u6253\u5370-1\u5e76\u9000\u51fa \n      exit(0);\n  }\n}\nint main()\n{\n    memset(road,false,sizeof(road));\n    memset(exp,false,sizeof(exp));\n    scanf(\"%d%d%d%d%d\",&n,&k,&m,&s,&t);\n    for(int i=1;i<=n;i++) scanf(\"%d\",&con[i]);\n    for(int i=1;i<=k;i++)\n     for(int j=1;j<=k;j++) \n      scanf(\"%d\",&fig[i][j]);\n    int x,y,z;\n    for(int i=1;i<=m;i++)\n    {\n      scanf(\"%d%d%d\",&x,&y,&z);\n      sum+=z;\n      add(x,y,z);\n      add(y,x,z);\n    }  \n    exp[con[s]]=true;\n    dfs(s,0);\n    if(ans>sum||flag==false) printf(\"-1\");\n    else printf(\"%d\",ans);\n    return 0;\n} \n\u5982\u679c\u4ee3\u7801\u6709\u4e0d\u61c2\u6216\u8005\u53ef\u4ee5\u6539\u5584\u7684\u5730\u65b9 \u6b22\u8fce\u63d0\u51fa!\n```",
        "postTime": 1475410854,
        "uid": 22060,
        "name": "Memorize",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u6b64\u9898\u6807\u7b97dfs\u3002\u5f53\u521d\u6211\u5199\u4e86SPFA90\u5206\uff0c\u540e\u6765\u624d\u53d1\u73b0\u90a3\u662f\u9519\u7684\uff0c\u5e76\u6ca1\u6709\u8bb0\u5f55\u5df2\u5b66\u8fc7\u7684\u6240\u6709\u6587\u5316\u3002\n\n\u6b64\u9898\u6570\u636e\u89c4\u6a21\u5c0f\uff0cdfs\u6548\u7387\u8fd8\u633a\u9ad8\u7684\uff0c100\u518510ms\u5185\u53ef\u4ee5\u8f7b\u677e\u8fc7\u3002\n\n```cpp\n#include<cstdio>\n#include<cstring>\nint i,j,n,k,m,s,t,ans=16843009;\nint c[101];\nint matrix[101][101];\nint ljma[101][101];\nint u[10001],v[10001],d[10001];\nbool learned[101]; //\u8bb0\u5f55\u67d0\u79cd\u6587\u5316\u662f\u5426\u5df2\u88ab\u5b66\u8fc7 \nvoid dfs(int a, int dis)\n{\n    if (a == t) \n    {\n        if (dis < ans) ans = dis;\n        return;\n    }\n    if (dis >= ans) return;  //\u6700\u4f18\u6027\u526a\u679d \n    for (i=1; i<=n; i++)\n      if (learned[c[i]]==0 && matrix[c[i]][c[a]]==0 && ljma[i][a] >= 1)\n        {\n            bool flag = 1;\n            for (j=1; j<=k; j++)\n              if (learned[j] == 1)\n                if (matrix[c[i]][j] == 1) { flag=0; break; } //\u6bcf\u4e00\u4e2d\u5df2\u5b66\u8fc7\u7684\u6587\u5316\u90fd\u53ef\u80fd\u88ab\u6392\u65a5 \n            if (flag==0) break;\n            learned[c[i]] = 1;\n            dfs(i,dis+ljma[i][a]);\n            learned[c[i]] = 0;\n        }\n}\nint main()\n{\n    memset(ljma,0,sizeof(ljma));\n    memset(learned,0,sizeof(learned));\n    scanf(\"%d%d%d%d%d\",&n,&k,&m,&s,&t);\n    for (i=1; i<=n; i++)\n      scanf(\"%d\",&c[i]);\n    for (i=1; i<=k; i++)\n      for (j=1; j<=k; j++)\n        scanf(\"%d\",&matrix[i][j]); //\u5173\u4e8e\u6587\u5316\u7684\u77e9\u9635 \n    for (i=1; i<=m; i++)\n    {\n      scanf(\"%d%d%d\",&u[i],&v[i],&d[i]);\n      if (ljma[u[i]][v[i]]>0 && ljma[u[i]][v[i]]>d[i] || ljma[u[i]][v[i]]==0)\n      {\n        ljma[u[i]][v[i]]=d[i]; //\u662f\u5426\u6709\u8def\u5f84 \n        ljma[v[i]][u[i]]=d[i];\n      }\n    }\n    learned[c[s]]=1; \n    dfs(s,0);\n    if (ans == 16843009) printf(\"-1\");\n    else printf(\"%d\",ans);\n    return 0;\n}\n```",
        "postTime": 1472374678,
        "uid": 19884,
        "name": "\u7fe0\u7af9\u53f6\u98de",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "[P1078](https://www.luogu.org/problemnew/show/P1078)\n\n\u672c\u9898\u662f\u9519\u9898\uff0c\u540e\u6765\u88ab\u8bc1\u660e\u6ca1\u6709\u9760\u8c31\u7684\u591a\u9879\u5f0f\u590d\u6742\u5ea6\u7684\u505a\u6cd5\u3002\u6d4b\u8bd5\u6570\u636e\u975e\u5e38\u7684\u6c34\uff0c\u5404\u79cd\u7384\u5b66\u505a\u6cd5\u90fd\u53ef\u4ee5\u901a\u8fc7\uff08\u6bd4\u5982\u53cd\u7740\u626b\uff09\uff0c\u4e0d\u4ee3\u8868\u7b97\u6cd5\u6b63\u786e\u3002\n\n\u8bf4\u4e00\u4e0b\u6211\u7684\u7384\u5b66\u601d\u8def\uff0c\u5927\u4f53\u4e0a\u5c31\u662f\u90bb\u63a5\u8868\u5b58\u8fb9+bfs\u3002\n\n\u7528\u4e86\u4e24\u4e2aSTL\uff0cqueue\u548cvector\uff0c\u867d\u7136\u624b\u5199\u961f\u548c\u94fe\u5f0f\u524d\u5411\u661f\u82b1\u4e0d\u4e86\u591a\u957f\u65f6\u95f4\uff0c\u4f46\u8fd8\u662f\u61d2\u5f97\u5199\u3002\u90bb\u63a5\u8868\u5b58\u8fb9\u7684\u65f6\u5019\u5224\u65ad\u4e00\u4e0b\uff0c\u5982\u679c\u56fd\u5bb6b\u7684\u6587\u5316\u6392\u65a5\u56fd\u5bb6a\u7684\u6587\u5316\uff0c\u90a3a\u5230b\u5c31\u4e0d\u7528\u8fde\u8fb9\u4e86\uff0c\u540c\u7406\uff0cb\u5230a\u4e5f\u8fd9\u4e48\u505a\u3002\n\n\u4e0a\u4ee3\u7801\uff1a\n```cpp\n#include <iostream>\n#include <cstring>\n#include <queue>\n#include <vector>\nusing namespace std;\ntypedef struct pair<int,int> P;\nconst int MAXN=100;\nint n,k,m,s,t,c[MAXN+2],rel[MAXN+2][MAXN+2],d[MAXN+2];\nvector<P> V[MAXN+2]; //vector\u5b9e\u73b0\u7684\u90bb\u63a5\u8868\nbool bl[MAXN+2];\n\nvoid bfs(){\n\tmemset(d,0x7f7f7f7f,sizeof(d));\n\tqueue<P> Q;\n\tQ.push(P(s,0));\n\td[s]=0,bl[c[s]]=1;\n\twhile(Q.size()){\n\t\tP p=Q.front(); Q.pop();\n\t\tfor(int i=0;i<V[p.first].size();++i){\n\t\t\tP now=V[p.first][i];\n\t\t\tif(bl[c[now.first]]) continue; //\u62e5\u6709\u76f8\u540c\u6587\u5316\u7684\u56fd\u5bb6\u5c31\u4e0d\u53bb\u4e86\n\t\t\tif(p.second+now.second<d[now.first]){\n\t\t\t\tQ.push(P(now.first,p.second+now.second));\n\t\t\t\td[now.first]=p.second+now.second;\n\t\t\t}\n\t\t}\n\t}\n\tcout<<(d[t]>=0x7f7f7f7f ? -1 : d[t])<<endl;\n}\n\nint main(){\n\tcin>>n>>k>>m>>s>>t;\n\tfor(int i=1;i<=n;++i) cin>>c[i];\n\tfor(int i=1;i<=k;++i)\n\t\tfor(int j=1;j<=k;++j) cin>>rel[i][j];\n\tfor(int i=1;i<=m;++i){\n\t\tint a,b,d;\n\t\tcin>>a>>b>>d;\n\t\tif(!rel[c[b]][c[a]]) V[a].push_back(P(b,d));\n\t\tif(!rel[c[a]][c[b]]) V[b].push_back(P(a,d));\n\t}\n\tbfs();\n\treturn 0;\n}\n```\n**\u8bf7\u5404\u4f4d\u81ea\u91cd\uff0c\u4e0d\u8981\u6284\u9898\u89e3\uff01**",
        "postTime": 1534158557,
        "uid": 51308,
        "name": "Jith_2004",
        "ccfLevel": 7,
        "title": "20180813\uff083\uff09"
    },
    {
        "content": "#\u771f\u662f**\u201d\u6587\u5316\u82e6\u65c5\u201c**\n\n#\u8fd9\u9053\u9898\u6709\u6bd2\n\n##\u8fd9\u9053\u9898\u6709\u6bd2\n\n###\u8fd9\u9053\u9898\u6709\u6bd2\n\n\n-\u5410\u69fd\u5b8c\u4e86\u3002\u3002\u3002\u63a5\u4e0b\u6765\u8bb2\u9898\n\n\n-\u867d\u7136  **Floyd\u53ef\u4ee5\u8fc7**  \u4f46\u5f3a\u4e00\u70b9\u7684\u6570\u636e\u5c31\u4f1awa\uff1b\n\n-\u66b4\u529bDFS\u53ea\u80fd\u62ff60\u5206\uff1b\n\n-so\u3002\u3002\u3002\u53ef\u4ee5\u628a\u201d\u6587\u5316\u51b2\u7a81\u201c\u4e0e\u201c\u6587\u5316\u91cd\u590d\u201d\u770b\u4f5c\u6700\u77ed\u8def\u7684\u6743\u7528\uff0c\u7528SPFA\u6c42\u51fa\u80fd\u591f\u5230\u5f53\u524d\u70b9\u7684\u6240\u6709\u70b9\u6700\u5c0f\u503c\uff0c\u5728\u627e\u5230\u4ece\u5f53\u524d\u70b9\u5230\u7ec8\u70b9\u4e2d\u6240\u6709\u70b9\u7684\u6700\u5927\u503c\uff08\u5148\u4e70\u518d\u5356\uff09\n\n\n-\u8d34\u4ee3\u7801\uff08**\\_\u5f31\u9e21\\_**\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48**DFS\u4f1a\u8d85\u65f6** \u3002\u3002\u3002\u53ea\u597d\u52a0\u4e00\u4e2a\u5224\u65f6\u3002\u3002\u3002\uff09\n\n```cpp\n#include \"stdafx.h\"\n#include<iostream>\n#include<cstring>\n#include<algorithm>\n#include<cmath>\n#include<queue>\nusing namespace std;\n\nconst int MAX = 105;\n\nint n, k, m, s, t, ans = 1e9,tot,tmp;\nint c[MAX], a[MAX][MAX], dis[MAX][MAX], w[MAX], b[MAX];\nint flag, inq[MAX], vis[MAX];\nvector<int >v[105];\nqueue<int >q;\n\ninline void spfa() {\n    memset(w, 0x3f, sizeof(w));\n    \n    q.push(t);\n    inq[t] = 1;\n    w[t] = 0;\n    \n    while(!q.empty())\n    {\n        int u = q.front();\n        \n        q.pop();\n        inq[u] = 0;\n        \n        for(int i = 0;i<v[u].size();i++)\n            if (w[ v[u][i] ] > w[u] + dis[u][ v[u][i] ])\n            {\n                w[ v[u][i] ] = w[u] + dis[u][ v[u][i] ];\n                \n                if (!inq[ v[u][i] ])\n                {\n                    inq[ v[u][i] ] = 1;\n                    q.push(v[u][i]);\n                }\n            }\n    }\n    return;\n}\n\ninline void dfs(int u,int val) {\n    if (tot > 1000000)return;\n    tot++;\n    if (val + w[u] >= ans)return ;\n    if (u == t) {\n        ans = val;\n        flag = 1;\n        return;\n    }\n    \n    for (int i = 1;i <= k;i++)\n        if (a[i][c[u]])\n            b[i]++;\n    for (int i = 0; i<v[u].size(); i++)\n        if (b[ c[ v[u][i] ] ] == 0)\n        {\n            if (v[u][i] != t && c[v[u][i]] == c[t])continue;\n            \n            b[ c[ v[u][i]] ] = 1;\n            \n            dfs(v[u][i], val + dis[u][ v[u][i] ]);\n            \n            b[ c[v[ u][i] ] ] = 0;\n        }\n    \n    for (int i = 1;i <= k;i++)\n        if (a[i][c[u]])\n            b[i]--;\n    return;\n}\n\nint main()\n{\n    register int x, y, z;\n    \n    cin >> n >> k >> m >> s >> t;\n    \n    for (int i = 1;i <= n;i++)\n        cin >> c[i];\n    for (int i = 1;i <= k;i++) \n        for (int j = 1;j <= k;j++)\n            cin >> a[i][j];\n    \n    memset(dis, 0x3f, sizeof(dis));\n    \n    while (m--) {\n        cin>>x>>y>>z;\n        \n        if (dis[x][y]>1e9)\n            v[x].push_back(y),v[y].push_back(x);\n        \n        dis[x][y] = min(dis[x][y], z),dis[y][x] = min(dis[y][x], z);\n    }\n    \n    spfa();\n    \n    if (w[s] > 1e9) {\n        cout << -1 << endl;\n        return 0;\n    }\n    \n    vis[c[s]] = 1;\n    \n    dfs(s, 0);\n    \n    if (flag)\n        cout<<ans<<endl;\n    else\n        cout<<-1<<endl;\n\n    return 0;\n}\n```\n# **\u4e0d\u8981\u5728\u610f\u5934\u6587\u4ef6\u3002\u3002\u6211\u7528VS2017\u5199\u7684\u3002\u3002\uff08\u56e0\u4e3adev c++\u5728win10\u4e0a\u8001\u5d29\u6e83\uff09**\n\n",
        "postTime": 1509371535,
        "uid": 55638,
        "name": "Adun",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u4e2a\u591a\u6e90\u6700\u77ed\u8def\u95ee\u9898\uff0c\u6211\u4eec\u7528\u4e24\u4e2a\u56fe\u6765\u5b58\uff0c\u4f8b\u5982\u6211\u7528dis\u6765\u5b58\u9053\u8def\uff0cf\u6765\u5b58\u6587\u5316\n\n\u7531\u4e8e\u6570\u636e\u8f83\u5c0f\uff0c\u90fd\u53ef\u4ee5\u5b58\u6210\u90bb\u63a5\u77e9\u9635\n\n\u518d\u7528floyed\u6216dijkstra\u6c42\u6700\u77ed\u8def\u5373\u53ef\n\n\u4ee3\u7801\u5982\u4e0b\n\n    \n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<cmath>\n#include<iostream>//\u5934\u6587\u4ef6\nusing namespace std;\nint main()\n{\n    int i,j,n,p,m,k,s,t,dis[101][101],f[101][101],a,b,u,v,d,c[101];//c\u5b58\u6bcf\u4e2a\u5730\u65b9\u7684\u6587\u5316\uff0cdis\u5b58\u9053\u8def\u56fe\uff0cf\u5b58\u6587\u5316\u56fe\n    for (i=1;i<=101;++i)\n    for (j=1;j<=101;++j)\n    dis[i][j]=99999;//\u521d\u59cb\u5316\u9053\u8def\uff0c\u540e\u9762floyed\u8981\u7528\uff0c\u8981\u5c06dis\u90fd\u5b58\u4e00\u4e2a\u8f83\u5927\u7684\u503c\n    scanf(\"%d%d%d%d%d\",&n,&k,&m,&s,&t);//\u8f93\u5165\n    for (i=1;i<=n;++i)\n    cin>>c[i];//\u8f93\u5165\u6bcf\u4e2a\u5730\u65b9\u7684\u6587\u5316\n    for (i=1;i<=k;++i)\n    {\n        for (j=1;j<=k;++j)\n        cin>>f[i][j];//\u8f93\u5165f\u6587\u5316\u56fe\uff0cf\u3010i\u3011\u3010j\u3011=1\u8868\u793ai\u6392\u65a5j\n    }\n    for (i=1;i<=m;++i)\n    {\n        cin>>u>>v>>d;\n    if (!f[c[u]][c[v]]) dis[v][u]=min(dis[v][u],d);//\u8fd9\u91cc\u8981\u6ce8\u610ff\u3010c\u3010u\u3011\u3011\u3010c\u3010v\u3011\u3011\u8868\u793au\u7684\u6587\u5316\u662f\u5426\u6392\u65a5v\uff0c\u4e0d\u6392\u65a5\u65f6v\u548cu\u624d\u6709\u8def\n    if (!f[c[v]][c[u]]) dis[u][v]=min(dis[u][v],d);//\u53c8\u56e0\u4e3a\u8def\u4e0d\u6b62\u4e00\u6761\uff0c\u6240\u4ee5\u7528\u4e2amin\u53d6\u6700\u77ed\u8def\n    }\n    for (p=1;p<=n;++p)//floyed \u628a\u8f6c\u70b9p\u653e\u5728\u6700\u5916\u9762\n    for (i=1;i<=n;++i)\n    for (j=1;j<=n;++j)\n    {\n        if (!f[c[p]][c[i]] && !f[c[j]][c[i]] && !f[c[j]][c[p]])\n        dis[i][j]=min(dis[i][p]+dis[p][j],dis[i][j]);//\u6587\u5316\u4e0d\u6392\u65a5\u624d\u6362\n    }\n    if (dis[s][t]>=99999) printf(\"-1\");//\u5927\u4e8e\u4e00\u5f00\u59cb\u7684\u521d\u59cb\u503c\u5219\u5fc5\u5b9a\u4e0d\u53ef\u4ee5\u8f93\u51fa-1\n    else printf(\"%d\",dis[s][t]);//\u5426\u5219\u8f93\u51fadis\u3010s\u3011\u3010t\u3011 s\u5230t\u7684\u6700\u77ed\u8def\n    return 0;\n}\n```",
        "postTime": 1508461702,
        "uid": 9181,
        "name": "\u5305\u5b50\u5165\u4fb5",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "/\\*\u54c8\u54c8\u54c8\u4eca\u5929\u597d\u5f00\u5fc3\n\n\u8fdea\u4e24\u9053\u56fe\u8bba\n\n\u8fd9\u9053\u9898\u6211\u7528spfa\n\n\u8ddf\u697c\u4e0b\u7684spfa\u4e0d\u4e00\u6837\n\n\u7528\u7684\u662f\u7ed3\u6784\u4f53\u52a0\u624b\u5199\u961f\u5217\n\n\u53ea\u8981\u5728\u6700\u77ed\u8def\u7684\u6a21\u677f\u4e0a\u52a0\u4e0a\u5224\u65ad\u5c31\u597d\n\n\\*/\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#define INF 1e4\nusing namespace std;\nint n,k,m,s,t;\nint c[101];//\u57ce\u5e02\u5bf9\u5e94\u7684\u6587\u5316 \nbool a[101][101]; //\u6587\u5316\u662f\u5426\u6392\u65a5 \nint map[101][101];//n\u5c0f\u6240\u4ee5\u7528\u90bb\u63a5\u77e9\u9635\u65b9\u4fbf\u5feb\u6377 \nbool j[101];//spfa\u5224\u65ad\u662f\u5426\u5728\u961f\u5217\u4e2d \nint dis[101];//\u5355\u6e90\u6700\u77ed\u8def\u6570\u7ec4 \nstruct node{\n    bool flag[101]={0};//\u8981\u591a\u5b58\u4e00\u72b6\u6001\u662f\u5728\u67d0\u70b9\u6240\u5177\u6709\u7684\u6587\u5316\u90fd\u662f\u54ea\u4e9b \n    int cnt;\n}q[1000001];//\u624b\u5199\u961f\u5217\uff0c\u7528stl\u7684\u8bdd\u6d89\u53ca\u7ed3\u6784\u4f53copy\u5f88\u9ebb\u70e6 \nint main()\n{    freopen(\"123.txt\",\"r\",stdin);//\u9632\u6284 \n        cin>>n>>k>>m>>s>>t;//\u8f93\u5165\u521d\u59cb\u5316\u4e0d\u89e3\u91ca \n    for(int i=1;i<=n;i++)cin>>c[i];\n    memset(map,-INF,sizeof(map));\n    for(int i=1;i<=101;i++)\n    dis[i]=INF;\n    memset(j,0,sizeof(j));\n    for(int i=1;i<=k;i++)\n    {\n        for(int j=1;j<=k;j++)\n        {\n            int tmp;\n            cin>>tmp;\n            a[i][j]=tmp;\n        }\n    }\n    for(int i=1;i<=m;i++)\n    {    int x,y,z;\n        cin>>x>>y>>z;\n        if(map[x][y]<=0||map[x][y]>z)\n        {\n            map[x][y]=z;\n            map[y][x]=z;    \n```\n}//\u53ef\u80fd\u6709\u591a\u6761\u8def\u6240\u4ee5\u4e00\u5b9a\u5728\u8fd9\u91cc\u8981\u53d6\u6700\u5c0f\uff01\n```cpp\n    }// \n    //cout<<map[1][2];\n    int head=1;\n    int tail=2;\n    q[head].cnt=s;\n    q[head].flag[c[s]]=true;\n    j[s]=1;\n    dis[s]=0;\n    bool tmp=0;//\u521d\u59cb\u5316\u961f\u5217 \n    while(head<=tail)\n    {\n        int now=q[head].cnt;\n        j[now]=0;\n        head++;\n            for(int i=1;i<=n;i++)\n            {\n            if(!j[s]&&map[now][i]>0)//\u662f\u4e0d\u662f\u5b58\u5728\u9053\u8def \n            {\n                    for(int kk=1;kk<=k;kk++)\n                    {\n                        //if(q[head-1].flag[kk]==1&&a[c][c[i]]==1)continue;\n                        int cul=q[head-1].flag[kk];\n                        if(cul==1&&a[c[i]][cul])//\u6392\u65a5\u5426 \n                        {tmp=1;\n                        break;\n```\n}//\u8fd9\u662f\u5224\u65ad\u662f\u5426\u80fd\u591f\u5c06\u4e0b\u4e00\u4e2a\u4f5c\u4e3a\u7ed3\u70b9\n        \n```cpp\n                    }\n                    if(dis[i]>dis[now]+map[now][i]&&!tmp)//spfa\u6a21\u677f \n                    {    //cout<<map[now][i]<<\" \";\n                        dis[i]=dis[now]+map[now][i];\n                        //cout<<dis[i]<<\" \"<<1;\n                        if(!j[i])\n                        {\n                            j[i]=1;\n                            q[tail].cnt=i;//\u5165\u961f\n                            for(int kk=1;kk<=k;kk++)\n                            {\n                             q[tail].flag[kk]=q[head-1].flag[kk];\n                            }\n                            q[tail].flag[c[i]]=1;//\u5bf9flag\u6570\u7ec4\u7684\u72b6\u6001\u8fdb\u884c\u4fee\u6539                                 \n                        }      \n                        tail++;    //\u4e4b\u524d\u5fd8\u6253\u8fd9\u4e2a\u5168wa....                \n                    }\n                    else tmp=0;//\u590d\u4f4d\u5224\u65ad \n                }\n            }\n        }    \n    if(dis[t]==INF)cout<<-1;\n    else cout<<dis[t];//\u8f93\u51fa\uff01\uff01\n    //\u5b8c\u6210~~\n    //NOIP\u52a0\u6cb9\uff01 \n}\n\n```",
        "postTime": 1508068511,
        "uid": 27330,
        "name": "\u68ee\u6d77\u585e\u5c14",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u9700\u8981\u641c\u7d22\uff1f\uff1f\uff1f\n\n\nNONONO\uff0c\u6c42\u6700\u77ed\u8def\u5c31\u597d\u4e86\n\n\n1AC 0ms/12320kB\n\n\n2AC 1ms/12320kB\n\n\n3AC 0ms/12320kB\n\n\n4AC 0ms/12320kB\n\n\n5AC 0ms/12320kB\n\n\n6AC 0ms/12320kB\n\n\n7AC 0ms/12320kB\n\n\n8AC 0ms/12320kB\n\n\n9AC 1ms/12320kB\n\n\n10AC 1ms/12320kB\n\n\u5177\u4f53\u89e3\u91ca\u89c1\u4ee3\u7801\n\n\u7528\u4e2adijkstra\u52a0\u5806\u4f18\u5316\uff1a\n\n\n```cpp\n#include<algorithm>\n#include<iostream>\n#include<cstring>\n#include<cstdlib>\n#include<cstdio>\n#define rg register\n#define ls 2*k\n#define rs 2*k+1\nusing namespace std;\nconst int INF=0x3f3f3f3f;\nconst int MAXN=110;\nstruct node\n{\n    int next;\n    int to;\n    int w;\n}t[MAXN*MAXN*3];\nstruct Node\n{\n    int a;\n    int dist;\n    bool go[MAXN];//\u6765\u8bb0\u5f55\u5b66\u8fc7\u54ea\u4e9b\u6587\u5316\n};\nstruct Heap//\u5806\n{\n    Node pp[MAXN];\n    int tail;\n    void clear()\n    {\n        tail=0;\n    }\n    void Swap(int x,int y)\n    {\n        swap( pp[ x ],pp[ y ] );\n    }\n    void insert(Node temp)//\u63d2\u5165\n    {\n        pp[ ++tail ]=temp;\n        int tmp=tail;\n        while( tmp>=2 )\n        {\n            if( pp[ tmp ].dist<pp[ tmp/2 ].dist )\n            {\n                Swap( tmp,tmp/2 );\n                tmp=tmp/2;\n            }\n            else   break ;\n        }\n    }\n    void update(rg int k)\n    {\n        int tmp=k;\n        if( ls<=tail && pp[ ls ].dist<=pp[ tmp ].dist )   tmp=ls;\n        if( rs<=tail && pp[ rs ].dist<=pp[ tmp ].dist )   tmp=rs;\n        if( tmp!=k )\n        {\n            Swap( k,tmp );\n            update( tmp );\n        }\n    }\n    int top( )\n    {\n        return pp[ 1 ].a;\n    }\n    void pop( )\n    {\n        pp[ 1 ].a=pp[ tail ].a,pp[ 1 ].dist=pp[ tail-- ].dist;\n        if( tail<=1 )   return ;\n        update( 1 );\n    }\n    int empty( )\n    {\n        return tail;\n    }\n}q;\nbool flag[MAXN][MAXN];//\u5224\u65ad\u4e24\u79cd\u6587\u5316\u662f\u5426\u6392\u65a5\nbool vis[MAXN];\nint head[MAXN],num;\nint dis[MAXN],c[MAXN];//\u8bb0\u8ddd\u79bb\uff0c\u6587\u5316\nint n,k,m,S,T;\nvoid add(int u,int v,int d)\n{\n    t[ ++num ].next=head[ u ];\n    t[ num ].to=v;\n    t[ num ].w=d;\n    head[ u ]=num;\n}\nint main()\n{\n    int u,v,d,x;\n    Node tmp,ljlovezzl;\n    memset( dis,INF,sizeof dis);\n    scanf(\"%d%d%d%d%d\",&n,&k,&m,&S,&T);\n    for(int i=1;i<=n;i++)   scanf(\"%d\",&c[ i ]);\n    for(int i=1;i<=k;i++)\n        for(int j=1,x;j<=k;j++)\n        {\n            scanf(\"%d\",&d);\n            flag[ i ][ j ]=d;\n        }\n    for(int i=1;i<=m;i++)\n    {\n        scanf(\"%d%d%d\",&u,&v,&d);\n        add( u,v,d ),add( v,u,d );\n    }\n    flag[ c[ S ] ][ c[ S ] ]=flag[ c[ T ] ][ c[ T ] ]=1;//\u4e00\u4e2a\u5904\u7406\u561b\uff0c\u56e0\u4e3a\u540c\u4e00\u6587\u5316\u4e0d\u80fd\u518d\u53bb\uff0c\u6240\u4ee5\u76f4\u63a5\u8ba4\u4e3a\u5c31\u662f\u6392\u65a5\n    for(int i=1;i<=k;i++)   tmp.go[ i ]=0;\n    tmp.a=S,tmp.dist=0,tmp.go[ c[ S ] ]=1;\n    q.clear(),dis[ S ]=0,q.insert( tmp );\n    while( q.empty() )//dijkstra\u7b97\u6cd5\n    {\n        x=q.top(),q.pop();\n        if( vis[ x ] )   continue ;\n        vis[ x ]=1;\n        for(rg int i=head[ x ],y,cs; i ;i=t[ i ].next )\n        {\n            y=t[ i ].to,cs=1;;\n            if( dis[ y ]>dis[ x ]+t[ i ].w && !vis[ y ] )\n            {\n                for(int j=1;j<=k;j++)\n                    if( tmp.go[ j ] && flag[ c[ y ] ][ j ] )\n                    {\n                        cs=0;\n                        break ;\n                    }\n                if( !cs )   continue ;//\u8bf4\u660e\u6709\u51b2\u7a81\n                dis[ y ]=dis[ x ]+t[ i ].w;\n                ljlovezzl=tmp,ljlovezzl.go[ c[ y ] ]=1,ljlovezzl.dist=dis[ y ],ljlovezzl.a=y;\n                q.insert( ljlovezzl );\n            }\n        }\n    }\n    if( dis[ T ]==INF )   printf(\"%d\\n\",-1);\n    else   printf(\"%d\\n\",dis[ T ]);\n    return 0;\n}\n```",
        "postTime": 1501050633,
        "uid": 25098,
        "name": "QJLYH",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u4ed4\u7ec6\u4e00\u60f3,\u5176\u5b9e\u8fd9\u4e2a\u65b9\u6cd5\u5e76\u4e0d\u662f\u5f88\u6b63\u786e\n\n\u5047\u8bbe\u4eces=1\u5230t=3\u7ecf\u5386\u4e86 1 2 3 4\u8fd9\u4e9b\u70b9,1 3, 1 2, 2 3, 1 4, 4 3\n\n\u5e76\u6ca1\u6709\u5224\u65ad\u5b8c\u5168,\u4f46\u662f\u5bf9\u4e8e\u672c\u9898,\u53ef\u4ee5\u5f88\u8f7b\u677e\u901a\u8fc7\n\n\u8fd9\u9898\u6570\u636e\u91cf\u5f88\u5c0f,\u7528Floyd\u7b97\u6cd5\u5b8c\u5168\u53ef\u4ee5\u8fc7,\u5e76\u4e14\u4ee3\u7801\u4e5f\u662f\u5341\u5206\u7b80\u6d01\u7684\n\n\u7528SPFA\u968f\u4fbf\u4e00\u5199\u5c31\u662f\u4e03\u516b\u5341\u884c\u5b9e\u5728\u662f\u4e0d\u60f3\u5199\uff08\u5176\u5b9e\u5c31\u662f\u61d2\uff09\n\n```cpp\n #include<bits/stdc++.h>\nusing namespace std;\nint a[101][101],ct[101][101],c[101];\nint main()\n{\n    memset(a,0xf,sizeof(a));                                //\u8d4b\u4e00\u4e2a\u6bd4\u8f83\u5927\u7684\u503c \n    int n,k,m,s,t;\n    cin>>n>>k>>m>>s>>t;\n    for(int i=1;i<=n;i++)\n        cin>>c[i];\n    for(int i=1;i<=k;i++)\n        for(int j=1;j<=k;j++)\n            cin>>ct[i][j];\n    for(int i=1;i<=m;i++)\n    {\n        int u,v,w;\n        cin>>u>>v>>w;\n        a[u][v]=w;\n        a[v][u]=w;\n    }                                   //\u4ee5\u4e0a\u5747\u4e3a\u5bf9\u8f93\u5165\u6570\u636e\u5904\u7406 \n    if(ct[c[s]][c[t]])cout<<\"-1\";        //\u5982\u679c\u8d77\u70b9\u548c\u7ec8\u70b9\u4e0d\u8fde\u901a, \u8f93\u51fa-1 \n    //\u8fd9\u91cc\u662f\u4e0d\u662f\u5e94\u8be5\u6709\u4e00\u53e5return 0; \u4f46\u6211\u63d0\u4ea4\u7684\u65f6\u5019\u6ca1\u6709\u5199\u8fd8\u662fAC\u4e86,,\u597d\u5947\u602a\u54e6 \n    for(int i=1;i<=n;i++)\n        for(int k=1;k<=n;k++)\n            for(int j=1;j<=n;j++)           //Floyd\u7b97\u6cd5\u6838\u5fc3 \n                if(i!=j&&j!=k&&i!=k)          //\u4e0d\u80fd\u81ea\u5df1\u5230\u81ea\u5df1 \n                if(ct[c[i]][c[j]]==0&&ct[c[j]][c[k]]==0&&ct[c[i]][c[k]]==0)  //i\u4e0ej j\u4e0ek i\u4e0ek\u5747\u4e0d\u51b2\u7a81 \n                if(a[i][j]>a[i][k]+a[k][j])                                 \n                a[i][j]=a[i][k]+a[k][j];\n    if(a[s][t]<=25645135)cout<<a[s][t];                     //\u8fd9\u79cd\u65b9\u6cd5\u8d4b\u503c\u5f97\u5230\u521d\u59cb\u503c\u4e3a252645135\n    else cout<<\"-1\";                                    //\u5e76\u4e0d\u80fd\u5230\u8fbe,\u8f93\u51fa-1 \n}\n```",
        "postTime": 1500888549,
        "uid": 36507,
        "name": "shijunfeng00",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u7684\u6570\u636e\u6211\u4e5f\u662f\u4e0d\u60f3\u591a\u8bf4\u4ec0\u4e48\u4e86\u3002\u3002\u3002\u3002\u5f00\u59cb\u662f\u6570\u7ec4\u5f00\u5c0f\u4e86\uff0c\u7136\u540e\u52a0\u4e86\u4e24\u4e2a\u66b4\u529b\u526a\u679d\uff0c\u7136\u540e\u5c31A\u4e86\uff1f\uff1f\uff1f\uff1f\u6211\u5199\u7684\u6df1\u641c\uff0c\u662f\u6700\u88f8\u7684\u6df1\u641c\uff0c\u5012\u7740\u641c\uff0c\u8981\u662f\u770b\u4e0d\u61c2\u90a3\u5c31\u6ca1\u4ec0\u4e48\u5176\u4ed6\u7684\u529e\u6cd5\u4e86\u3002\u3002\u3002\u3002\u3002\n\n\n\n\n\n\n\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cstdlib>\n#include<cmath>\n#include<algorithm>\n#include<queue>\nusing namespace std;\n#define REP(i,a,b) for(register int i = (a),i##_end_ = (b); i <= i##_end_; ++i)\ninline int read()\n{\n    char c = getchar();register int fg = 1, sum = 0;\n    while(c < '0' || c > '9')\n    {\n        if(c == '-')fg = -1;\n        c = getchar();\n    }\n    while(c >= '0' && c <= '9')\n    {\n        sum =sum * 10 + c - '0';\n        c = getchar();\n    }\n    return fg * sum;\n} \nconst int maxn = 4010;\nint n,k,m,s,t;\nint c[maxn],a[maxn][maxn];\nint be[maxn],ne[maxn],to[maxn],e,w[maxn];\n#define inf 0x3f3f3f3f\nvoid add(int x,int y,int z)\n{\n    to[++e] = y;\n    ne[e] = be[x];\n    be[x] = e;\n    w[e] = z;\n    to[++e] = x;\n    ne[e] = be[y];\n    be[y] = e;\n    w[e] = z;\n}\nint ans = inf;\nint vis_c[maxn],vis[maxn],cnt;\nvoid dfs(int x,int y,int step)\n{\n    //if(++cnt > 10000)return ;\n    if(step > ans)return ;\n    if(x == y)ans = min(ans,step);\n    for(int i = be[x]; i;i = ne[i])\n    {\n        int v = to[i];\n        int flag = 0;\n        REP(j,1,k)if(vis_c[j] && a[j][c[v]]){flag = 1;break;}\n        if(!vis[v] && !vis_c[c[v]] && !flag)\n        {\n            vis[v] = 1;vis_c[c[v]] = 1;\n            dfs(v,y,step+w[i]);\n            vis[v] = 0,vis_c[c[v]] = 0;\n        }\n    }\n}\nint main()\n{\n    n = read(), k = read(), m = read(), s = read(), t = read();\n    REP(i,1,n)c[i] = read();\n    REP(i,1,k)\n        REP(j,1,k)\n            a[i][j] = read();\n    REP(i,1,m)\n    {\n        int x,y,z;\n        x = read(), y = read(), z = read();\n        add(x,y,z);\n    }\n    vis[t] = 1, vis_c[c[t]] = 1;\n    dfs(t,s,0);\n    printf(\"%d\\n\",ans == inf ? -1 : ans);\n    return 0;\n}\n```",
        "postTime": 1489716157,
        "uid": 19645,
        "name": "Drinkwater",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u672c\u9898\u6570\u636e\u597d\u5f31\uff0cdfs 2ms\u8f7b\u677eAC\uff08\u5355\u70b9\uff09\n\n\u4e0d\u8fc7\u987a\u641c\u786e\u5b9e\u7565\u5751\uff0c\u7b2c\u5341\u4e2a\u6d4b\u8bd5\u70b9TLE\u3002\u65e0\u5948\u4e4b\u4e0b\uff0c\u6211\u5c1d\u8bd5\u5012\u7740\u641c\u3002\n\n\u4e0a\u4ee3\u7801\uff1a\n\n\n\n\n\n\n\n\n\n\n```cpp\nvar\n        a,b:array[1..100] of longint; //a\u6570\u7ec4\u8bb0\u5f55\u6587\u5316\u7c7b\u578b\uff0cb\u6570\u7ec4\u641c\u7d22\u9700\u8981\uff0c\u9047\u5230\u6587\u5316\u51b2\u7a81\u5219inc\uff0c\u641c\u7d22\u7ed3\u675fdec\uff0cb[i]=0\u65f6\u8bf4\u660e\u6587\u5316\u4e0d\u51b2\u7a81\u3002\n        vis:array[1..100] of boolean;//\u662f\u5426\u8bbf\u95ee\u8fc7\u6b64\u70b9\u3002\n        hate:array[1..100,1..100] of boolean;//i\u8ba8\u538cj\u6587\u5316\u7684\u5224\u65ad\n        way:array[1..100,1..100] of longint;//i\u5230j\u7684\u8def\uff0c0\u4e3a\u65e0\u8def\u3002\n        n,k,m,s,t,i,j,ans,x,y:longint;\nprocedure dfs(x,v:longint);//\u91cd\u70b9\u5728\u8fd9\nvar i:longint;\nbegin\n        if v>=ans then exit;//\u526a\u679d\uff0c\u52a0\u5feb\u901f\u5ea6\u548c\u6548\u7387\n        if x=s then//\u5230\u8d77\u70b9\n        begin\n                ans:=v;//\u6700\u4f18\n                exit;\n        end;\n        inc(b[a[x]]); //\u4e0a\u6587\u5df2\u63cf\u8ff0\uff0c\u8bf7\u81ea\u884c\u7406\u89e3\n        vis[x]:=true;\n        for i:=1 to k do\n                if hate[a[x],i] then\n                        inc(b[i]);\n        for i:=1 to n do\n                if not vis[i] and (b[a[i]]=0) and (way[i,x]>0) then\n                        dfs(i,v+way[i,x]);//\u641c\u7d22\n        //\u64a4\u9500\u6807\u8bb0\n        for i:=1 to k do\n                if hate[i,a[x]] then\n                        dec(b[i]);\n        vis[x]:=false;\n        dec(b[a[x]]);\nend;\nbegin {\u4e0d\u89e3\u91ca\u4e86}\n        readln(n,k,m,s,t);\n        for i:=1 to n do\n                read(a[i]);\n        readln;\n        for i:=1 to k do\n        begin\n                for j:=1 to k do\n                begin\n                        read(x);\n                        if x=1 then hate[i,j]:=true\n                        else hate[i,j]:=false;\n                end;\n                readln;\n        end;\n        for i:=1 to m do\n                begin\n                        read(x,y);\n                        readln(way[x,y]);\n                        way[y,x]:=way[x,y];\n                end;\n        fillchar(vis,sizeof(vis),false);\n        fillchar(b,sizeof(b),0);\n        ans:=maxlongint;\n        dfs(t,0);\n        if ans=maxlongint then\n                writeln(-1)\n        else\n                writeln(ans);\nend.\n\u4e0d\u61c2\u7684\u518d\u79c1\u804a\u95ee\u6211\u3002\n```",
        "postTime": 1478997585,
        "uid": 7706,
        "name": "AC_Evil",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u4ecb\u7ecd\u4e00\u79cd\u8ba1\u65f6\u5668\u7684\u65b9\u6cd5\n\n\u6709\u70b9\u4f5c\u5f0a\uff0c\u4f46\u662f\u53ef\u4ee5AC\n\n\u5728\u6b63\u5f0f\u6bd4\u8d5b\u65f6\u98ce\u9669\u8f83\u5927\uff0c\u4e0d\u5efa\u8bae\u4f7f\u7528\u3002\n\n\u6211\u7528\u7684\u662fDFS \u4f46\u5982\u679c\u5f53DFS\u96be\u4ee5\u526a\u679d\u7684\u8bdd\uff0c\u4e0d\u59a8\u8bd5\u8bd5\u5728\u5feb\u8981\u8d85\u65f6\u7684\u65f6\u5019\u76f4\u63a5\u8f93\u51fa\u76ee\u524d\u8ba1\u7b97\u51fa\u7684\u7b54\u6848\uff0c\u4f46\u662f\u5982\u679c\u65f6\u95f4\u5b9a\u9519\uff0c\u5c31\u4f1a\u9020\u6210WA\uff0c\u53ef\u80fd\u8fd8\u4f1a\u66f4\u4e8f\u3002\u771f\u4e0d\u884c\u4f60\u5c31\u5012\u7740\u641c\u7d22\u597d\u4e86\u3002\u3002\u3002\n\n\u4e0aPASCAL\u4ee3\u7801\u3002\n\n```pascal\nvar n,k,m,s,t,u,v,d,i,j,min,time:longint;\n    c:array[1..100] of longint;\n    a,b:array[1..100,1..100] of longint;\n    y,z:array[1..100] of boolean;\n    find:boolean;  //\u52a0\u4e2a\u5e03\u5c14\u786e\u5b9a\u662f\u5426\u627e\u5230\uff0c\u5426\u5219\u8f93\u51fa-1\nprocedure try(x,ans:longint);\nvar i,j:longint;\n    f:boolean;\nbegin\n  inc(time);  //\u6b64\u5904\u662f\u8ba1\u65f6\u5668\uff0c\u5982\u679c\u8981\u8d85\u65f6\u76f4\u63a5halt\n  if time>500000 then  //\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u8fd9\u6bb5\u4ee3\u7801\u8ba1\u65f6\u56685*10^5\u5c31\u80fdAC\u3002\u6ca1\u5fc5\u8981\u5012\u7740\u641c\u3002\n  begin\n    if find then writeln(min) else writeln('-1');\n    halt;\n  end;\n  if ans>min then exit;  //\u8fd9\u91cc\u7684\u526a\u679d\u5341\u5206\u5fc5\u8981\uff0c\u5426\u5219\u4f1a\u591a\u641c\u7d22\u5f88\u591a\u6b21\n  if t=x then   //\u5178\u578bDFS \u627e\u5230\u89e3\u5c31\u9000\u6389\u4e00\u5c42\n  begin\n    find:=true;\n    min:=ans;\n    exit;\n  end;\n  for i:=1 to n do\n    if (x<>i)and(b[x,i]<>-1)and not z[i] then\n    begin\n      f:=false;\n      for j:=1 to k do if y[j] and (a[c[i],j]=1) then\n      begin\n        f:=true;\n        break;\n      end;\n      if f then continue;\n      z[i]:=true;  //\u53bb\u4e86\u56fd\u5bb6i\n      y[c[i]]:=true;  //\u5b66\u4e86\u6587\u5316C[i]\n      try(i,ans+b[x,i]);\n      z[i]:=false;    //\u522b\u5fd8\u4e86\u56de\u6eaf\n      y[c[i]]:=false;\n    end;\nend;\nbegin\n  min:=maxlongint div 3;  //\u521a\u5f00\u59cb\u521d\u59cb\u5316\u8d4b\u503c\u6210\u65e0\u7a77\u5927\n  read(n,k,m,s,t);\n  for i:=1 to n do read(c[i]);\n  for i:=1 to k do\n    for j:=1 to k do read(a[i,j]);\n  for i:=1 to n do\n    for j:=1 to n do b[i,j]:=-1;  //\u8def\u4e0d\u901a\u7684\u60c5\u51b5\n  for i:=1 to m do\n  begin\n    read(u,v,d);\n    b[u,v]:=d;\n    b[v,u]:=d;  //\u6ce8\u610f\u662f\u53cc\u5411\u7684\n  end;\n  y[c[s]]:=true;  //\u7b2c\u4e00\u4e2a\u56fd\u5bb6\u7684\u6587\u5316\u5fc5\u987b\u5b66\n  try(s,0);\n  if find then writeln(min) else writeln('-1');\nend.\n```",
        "postTime": 1478142120,
        "uid": 18267,
        "name": "acaca",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u8fa3\u9e21\u9898\u76ee\u3002\n\n\u9996\u5148floyd\u6216\u5355\u7eaf\u7684spfa\u4e00\u5b9a\u662f\u9519\u7684\uff0c\u65e0\u9700\u591a\u8a00\uff08\u51fa\u4e86\u80fdac\uff0c\u4e00\u65e0\u662f\u5904\uff09\u3002\n\n\u6211\u4e00\u5f00\u59cb\u60f3\u7684\u662f\u66b4\u529bdfs\uff0c\u4e0d\u52a0\u526a\u679d60\u5206\uff0c\u7a0d\u5fae\u526a\u4e86\u526a90\u5206\u3002\u4ece\u6b64\u518d\u4e5f\u5f00\u4e0d\u4e0a\u53bb\u3002\n\n\u770b\u4e86created equal\u7684\u9898\u89e3\uff0c\u5199\u542f\u53d1\u5f0f\u526a\u679d\uff0c\u5e76\u4e0d\u77e5\u9053\u662f\u4ec0\u4e48\uff0c\u4ecd\u7136\u8fc7\u4e0d\u4e86\u6700\u540e\u4e00\u4e2a\u70b9\u3002\n\n\u53c8\u53bb\u5b66\u4e86A\\*\u7b97\u6cd5\uff0c\u4ecd\u7136\u8d85\u65f6\u3002\n\n\u6700\u540e\u53d1\u73b0\u662f\u5012\u7740\u641c\u5c31\u53ef\u4ee5\uff0c\u52a0\u4e86\u4e2aswap\uff0cac\u3002\n\n\u53d1\u4e00\u4e2aA\\*\u7b97\u6cd5\uff0c\u4f9b\u5927\u5bb6\u501f\u9274\n\n\n```cpp\n#include<algorithm>\n#include<iostream>\n#include<cstring>\n#include<vector>\n#include<cstdio>\n#include<queue>\nusing namespace std;\nvector<int>v[105],w[105];\nqueue<int>q1;\nint n,k,m,s,t,ans=1e9+7,cul[105],a[105][105],dis[105];\nbool flg,inq[105];\nstruct node\n{\n    bool b[105];\n    int cur,val,exp;\n}c1,c2;\nbool operator < (node c,node d)\n{\n    return c.val+c.exp>d.val+d.exp;\n}\npriority_queue<node>q2;\nvoid spfa()\n{\n    memset(dis,0x3f,sizeof(dis));\n    q1.push(t);\n    inq[t]=1;\n    dis[t]=0;\n    while(!q1.empty())\n    {\n        int u=q1.front();\n        q1.pop();\n        inq[u]=0;\n        for(int i=0;i<v[u].size();i++)\n            if(dis[v[u][i]]>dis[u]+w[u][i])\n            {\n                dis[v[u][i]]=dis[u]+w[u][i];\n                if(!inq[v[u][i]])\n                {\n                    inq[v[u][i]]=1;\n                    q1.push(v[u][i]);\n                }\n            }\n    }\n}\nint main()\n{\n    scanf(\"%d%d%d%d%d\",&n,&k,&m,&s,&t);\n    swap(s,t);\n    for(int i=1;i<=n;i++)\n        scanf(\"%d\",&cul[i]);\n    for(int i=1;i<=k;i++)\n        for(int j=1;j<=k;j++)\n            scanf(\"%d\",&a[i][j]);\n    while(m--)\n    {\n        int x,y,z;\n        scanf(\"%d%d%d\",&x,&y,&z);\n        v[x].push_back(y);\n        v[y].push_back(x);\n        w[x].push_back(z);\n        w[y].push_back(z);\n    }\n    spfa();\n    for(int i=1;i<=k;i++)\n        a[i][i]=1;\n    memset(c1.b,0,sizeof(c1.b));\n    for(int i=1;i<=k;i++)\n        if(a[cul[s]][i]==1)\n            c1.b[i]=1;\n    c1.cur=s,c1.exp=dis[s],c1.val=0;\n    q2.push(c1);\n    while(!q2.empty())\n    {\n        c1=q2.top();\n        q2.pop();\n        if(c1.cur==t)\n        {\n            flg=1;\n            printf(\"%d\\n\",c1.val);\n            break;\n        }\n        int u=c1.cur;\n        for(int i=0;i<v[u].size();i++)\n            if(!c1.b[cul[v[u][i]]])\n            {\n                c2=c1;\n                for(int j=1;j<=k;j++)\n                    if(a[cul[v[u][i]]][j])\n                        c2.b[j]=1;\n                c2.val+=w[u][i];\n                c2.exp=dis[v[u][i]];\n                c2.cur=v[u][i];\n                q2.push(c2);\n            }\n    }\n    if(!flg)\n        printf(\"-1\\n\");\n    return 0;\n}\n```",
        "postTime": 1478091300,
        "uid": 12070,
        "name": "Lynx",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u6211\u603b\u5171\u63d0\u4ea4\u4e8619\u6b21\u2026\u2026\u770b\u6570\u636e\u89c4\u6a21\u611f\u89c9\u662f\u53ef\u4ee5\u66b4\u529b\u641c\u7d22\uff0c\u4f46\u662f\u4e00\u76f4TLE\uff0c\u76f4\u5230\u52a0\u4e86\u4e00\u4e2a\u5f53dfs\u65f6\u5f53\u524d\u7b54\u6848\u5df2\u7ecf\u5927\u4e8e\u5df2\u77e5\u6700\u77ed\u7684\u7b54\u6848\u5c31\u9000\u51fa\u7684\u526a\u679d\u2026\u2026\u679c\u7136\u6df1\u641c\u9760\u526a\u679d\u2026\u2026\u8fd8\u6709\u5c31\u662f\u8981\u5012\u7740\u641c\uff0c\u6b63\u7740\u641c\u6700\u540e\u4e00\u4e2a\u70b9\u4f1a\u88ab\u5361\uff08\u949f\u957f\u8005%%%\uff09  \u4e0b\u9762\u4e0a\u4ee3\u7801:\n\n\n\n```cpp\ntype\n  node=record                                  //\u90bb\u63a5\u8868\n    next:array[0..100] of longint;\n    w:array[1..100] of longint;\nend;\nvar\n  cnt:int64;\n  n,k,m,s,t,i,j,temp,u,v,d,ans:longint;\n  c:array[1..100] of longint;//\u4e0d\u540c\u56fd\u5bb6\u7684\u6587\u5316\n  r:array[1..100,1..100] of boolean;//false=bad  \u4e0d\u540c\u6587\u5316\u95f4\u7684\u5173\u7cfb\n  a:array[1..100] of node;\n  learn:array[1..100] of boolean;//\u5df2\u7ecf\u5b66\u4e60\u4e86\u54ea\u4e9b\u6587\u5316\n  f:array[1..100] of boolean;//\u5df2\u7ecf\u53bb\u8fc7\u4e86\u54ea\u4e9b\u56fd\u5bb6\nprocedure dfs(x,an:longint);\nvar\n  l,p:longint;\n  ff:boolean;\nbegin\n```\nif an>ans\n```cpp\n    then exit;\n  if x=s\n    then begin\n           if an<ans\n             then ans:=an;\n           exit;\n         end;\n  learn[c[x]]:=true;\n  for l:=1 to a[x].next[0] do\n    begin\n      if ((not learn[c[a[x].next[l]]]))and(f[a[x].next[l]])//\u4e4b\u524d\u4e00\u76f4\u5199\u6210'f[l]'\u800cWA\uff0c\u8fd9\u91cc\u662f\u5224\u65ad\u56fd\u5bb6\u662f\u5426\u53bb\u8fc7\n        then begin\n               ff:=true;     //\u8fd9\u91cc\u662f\u5224\u65ad\u662f\u5426\u6709\u6587\u5316\u51b2\u7a81\n               for p:=1 to k do\n```\nif not r[c[a[x].next[l]],c[p]]\n```cpp\n                   then if learn[c[p]]\n                          then begin\n                                 ff:=false;\n                                 break;\n                               end;\n```\nif ff\n\n```cpp\n                 then begin\n                        f[a[x].next[l]]:=false;\n                        dfs(a[x].next[l],a[x].w[l]+an);\n                        f[a[x].next[l]]:=true;//\u56de\u6eaf\n                      end;\n             end;\n    end;\n  learn[c[x]]:=false;//\u56de\u6eaf      \u81f3\u4e8e\u4e3a\u4ec0\u4e48\u8fd9\u6837\u56de\u6eaf\u3002 \u9b42\u9b42\u9b42\nend;           \nbegin\n  fillchar(f,sizeof(f),true);\n  fillchar(learn,sizeof(learn),false);\n  ans:=100002001;//\u521d\u59cb\u5316\u4e00\u4e2a\u5927\u4e00\u70b9\u7684\u6570\n  readln(n,k,m,s,t);\n  for i:=1 to n-1 do\n    read(c[i]);\n  readln(c[n]);\n  for i:=1 to k do\n    begin\n      for j:=1 to k-1 do\n        begin\n          read(temp);\n          if temp=1\n            then r[i,j]:=false\n            else r[i,j]:=true;\n        end;\n      readln(temp);\n      if temp=1\n        then r[i,k]:=false\n        else r[i,k]:=true;\n    end;\n  for i:=1 to m do\n    begin\n      readln(u,v,d);\n      inc(a[u].next[0]);\n      a[u].next[a[u].next[0]]:=v;\n      a[u].w[a[u].next[0]]:=d;\n      inc(a[v].next[0]);\n      a[v].next[a[v].next[0]]:=u;\n      a[v].w[a[v].next[0]]:=d;\n    end;\n  dfs(t,0);//\u5012\u7740\u641c\n  if ans=100002001\n    then writeln('-1')\n    else writeln(ans);\nend.\n```",
        "postTime": 1469943283,
        "uid": 8878,
        "name": "\u5085\u50e7",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u8865\u5145\u4e00\u4e0b\u4e0b\u9762\u7684\u8fd9\u4e2a\u9898\u89e3\uff0c\u4ee3\u7801\u8d34\u9519\u4e86\uff0c\u6700\u6807\u51c6\u7684\u7b54\u6848\u5e94\u8be5\u4e3a\uff08\u52a0\u4e0adis[i].bz\uff09:\n\n\n\n\n\n\n```cpp\ntype\n        trr=array[0..100] of boolean;\n        arr=array[0..100] of longint;\nvar\n        c:array[1..100] of longint;\n        a:array[1..100,0..1000] of longint;\n        bz,d:array[1..100,1..100] of longint;\n        data:array[1..1000] of longint;\n        f:array[1..100] of boolean;\n        dis:array[1..100] of record way:longint; xuan:arr; bz:trr end;\n        n,k,m,s,t,i,j,x,y,way,head,tail,w:longint;\nfunction pd(x:arr; k:longint):boolean;\nvar\n        i:LONGINT;\nbegin\n        for i:=1 to x[0] do\n                if (bz[c[k],c[x[i]]]=1) then exit(false);\n        exit(true);\nend;\nbegin\n        assign(input,'culture.in'); reset(input);\n        assign(output,'culture.out'); rewrite(output);\n        readln(n,k,m,s,t);\n        for i:=1 to n do\n                read(c[i]);\n        for i:=1 to k do\n        begin\n                for j:=1 to k do\n                        read(bz[i,j]);\n                readln;\n        end;\n        fillchar(d,sizeof(d),5);\n        for i:=1 to m do\n        begin\n                read(x,y,way);\n                inc(a[x,0]);\n                a[x,a[x,0]]:=y;\n                if way<d[x,y] then d[x,y]:=way;\n                inc(a[y,0]);\n                a[y,a[y,0]]:=x;\n                if way<d[y,x] then d[y,x]:=way;\n        end;\n        head:=0;\n        tail:=1;\n        fillchar(dis,sizeof(dis),5);\n        dis[s].way:=0;\n        dis[s].xuan[0]:=1;\n        dis[s].xuan[1]:=s;\n        data[1]:=s;\n        while head<tail do\n        begin\n                inc(head);\n                w:=data[head];\n                for i:=1 to a[w,0] do\n                        if pd(dis[w].xuan,a[w,i]) and (dis[a[w,i]].way>dis[w].way+d[w,a[w,i]]) and dis[w].bz[c[a[w,i]]] then\n                        begin\n                                dis[a[w,i]]:=dis[w];\n                                dis[a[w,i]].way:=dis[a[w,i]].way+d[w,a[w,i]];\n                                dis[a[w,i]].bz:=dis[w].bz;\n                                dis[a[w,i]].bz[c[a[w,i]]]:=false;\n                                inc(dis[a[w,i]].xuan[0]);\n                                dis[a[w,i]].xuan[dis[a[w,i]].xuan[0]]:=a[w,i];\n                                if not f[a[w,i]] then\n                                begin\n                                        f[a[w,i]]:=true;\n                                        inc(tail);\n                                        data[tail]:=a[w,i];\n                                end;\n                        end;\n                f[w]:=false;\n        end;\n        if dis[t].way=84215045 then writeln(-1) else writeln(dis[t].way);\n        close(input); close(output);\nend.\n```",
        "postTime": 1461760587,
        "uid": 7603,
        "name": "liuyuli",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u6b64\u9898\u4e0d\u53ef\u7528\u6700\u77ed\u8def\u5f84\uff0c\u56e0\u4e3a\u76f8\u540c\u6587\u5316\u7684\u56fd\u5bb6\u4e0d\u80fd\u7ecf\u8fc7\u591a\u6b21\uff0c\u8fd9\u662f\u5173\u952e\uff1b\u5176\u6b21\u5982\u679c\u4e0b\u4e2a\u57ce\u5e02\u7684\u6587\u5316\u6392\u65a5\u4f60\u5b66\u8fc7\u6587\u5316\u4e2d\u7684\u4e00\u79cd\uff08\u5047\u5b9a\u4e0d\u662f\u5f53\u524d\u5b66\u7684\u6587\u5316\uff09\uff0c\u4f8b\u5982\uff0c\n\n3 3 2 1 3\n\n1 2 3\n0 0 0\n0 0 0\n1 0 0\n1 2 1\n2 3 1\n\n\u8fd9\u4e2a\u6837\u4f8b\u65e0\u89e3\n\n\u56e0\u4e3a\u6587\u53163\u6392\u65a5\u6587\u53161\uff0c\u60f3\u5230\u8fbe\u57ce\u5e023\u5fc5\u987b\u5b66\u4e60\u6587\u53163\uff0c\u540c\u65f6\u5fc5\u987b\u7ecf\u8fc7\u6587\u53161,2\u7684\u57ce\u5e02\uff0c\u6240\u4ee5\u65e0\u6cd5\u5230\u8fbe\u57ce\u5e023\u3002\n\n\u7528\u6700\u77ed\u8def\u5f84\u7b97\u6cd5\u80fd\u591f\u56e0\u4e3a\u6570\u636e\u5f31\u5f97\u60ca\u4eba\n\n\u8fd9\u9898\u6b63\u89e3\u5e94\u662f\u641c\u7d22+\u526a\u679d\n\n\u8fd9\u9898\u6b63\u7740\u641c90\uff0c\u5012\u7740\u641c100.\n\n\n```cpp\n#include<iostream>\n#include<cmath>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\nint f[110][110][2],n,m,k,s,e,a[110],i,j,b[110][110],ans,answer=100000000,d[110],paichi[110][110];\nbool c[110];\nvoid DFS(int now)\n{\n    int i,j;\n    //cout<<now<<\" \";\n    if (ans>answer) return;//\u91cd\u8981\u7684\u526a\u679d\uff1a\u5982\u679c\u5f53\u524d\u8def\u5f84\u4e4b\u548c\u5927\u4e8e\u5df2\u7ecf\u786e\u5b9a\u7684\u7b54\u6848\u5c31\u65e0\u9700\u518d\u641c \n    if (now==s) //\u8bb0\u5f55\u7b54\u6848 \n    {\n        answer=min(answer,ans);\n        return;\n    }\n    if (!f[now][0][0])return;\n    for(i=1;i<=f[now][0][0];i++)//\u679a\u4e3e\u4e0e\u5f53\u524d\u70b9\u76f8\u90bb\u7684\u70b9 \n    {\n        int l=f[now][i][0],ff=0;\n        for(j=1;j<=paichi[a[l]][0];j++)//\u5224\u65ad\u4e0b\u4e2a\u70b9\u662f\u5426\u6392\u65a5\u5f53\u524d\u5df2\u7ecf\u5b66\u8fc7\u7684\u6587\u5316 \n        {\n            if (c[paichi[a[l]][j]]) {ff=1;break;}\n        }\n        if (ff) continue;//\u53ea\u8981\u6709\u4e00\u4e2a\u6392\u65a5\u5c31\u8df3\u8fc7 \n        if (!c[a[l]]&&!b[a[l]][a[now]])//\u5224\u65ad\u6b64\u70b9\u7684\u6587\u5316\u662f\u591f\u5b66\u8fc7\u4e14\u4e0b\u4e2a\u70b9\u662f\u5426\u6392\u65a5\u5f53\u524d\u70b9\uff0c\u540e\u8005\u53ef\u5220\u56e0\u4e3a\u524d\u9762\u7684 for(j=1;j<=paichi[a[l]][0];j++)\u5df2\u7ecf\u5224\u65ad\u4e86 \n        {\n            c[a[l]]=1;\n            ans+=f[now][i][1];\n            DFS(f[now][i][0]);//\u7ee7\u7eed\u641c \n            ans-=f[now][i][1];//\u56de\u6eaf \n            c[a[l]]=0;\n        }\n    }\n}\nint main()\n{\n    cin>>n>>k>>m>>s>>e;\n    for(i=1;i<=n;i++)\n    scanf(\"%d\",&a[i]);\n    for(i=1;i<=k;i++)\n    {\n        for(j=1;j<=k;j++)\n        {\n            int p;\n            scanf(\"%d\",&p);\n            if (p) b[i][j]=1,paichi[j][++paichi[j][0]]=i;  //paichi\u4ee3\u8868\u70b9j\u6392\u65a5\u7b2cpaichi[j][0]\u7684\u70b9i\uff0c\u56e0\u4e3a\u662f\u5012\u641c\u6240\u4ee5\u8981\u5012\u7740\u6392\u65a5 \n        }\n    }\n    for(i=1;i<=m;i++)\n    {\n        int x,y,z;\n        scanf(\"%d%d%d\",&x,&y,&z);\n        if (!b[a[y]][a[x]]) f[x][++f[x][0][0]][0]=y,f[x][f[x][0][0]][1]=z;//\u8fde\u8fb9 \n        if (!b[a[x]][a[y]]) f[y][++f[y][0][0]][0]=x,f[y][f[y][0][0]][1]=z;//\u8fde\u8fb9 \n    }\n    c[a[e]]=1;//\u5f00\u59cb\u5012\u641c \n    DFS(e);\n    if (answer<100000000)\n    cout<<answer;\n    else cout<<\"-1\";\n}\n\n```",
        "postTime": 1414494112,
        "uid": 2937,
        "name": "diaosipan",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u7528\u5f17\u6d1b\u4f0a\u5fb7\u7b97\u6cd5\uff0c\u4ec5\u4f9b\u53c2\u8003\u3002\n\n\n```cpp\n#include<iostream>\nusing namespace std;\nint n,m,k,s,t,u,v,duv,l;\nint c[110],a[110][110],flag[110][110];\nlong long d[110][110];\nint main()\n{\n//freopen(\"culture.in\",\"r\",stdin);\n//freopen(\"culture.out\",\"w\",stdout);\nint i,j,l;\nfor (i=1;i<=100;i++)\n for (j=1;j<=100;j++) d[i][j]=2147480000;\ncin>>n>>k>>m>>s>>t;\nfor (i=1;i<=n;i++) scanf(\"%d\",&c[i]);\nfor (i=1;i<=k;i++)\n{\nfor (j=1;j<=k;j++)\n  scanf(\"%d\",&a[i][j]);\n}\n    for (i=1;i<=m;i++)\n      {\n      scanf(\"%d%d%d\",&u,&v,&duv);\n      if  (a[c[v]][c[u]]==0)\n      {\n        flag[u][v]=1;\n        d[u][v]=duv;\n      }\n      if  (a[c[u]][c[v]]==0)\n      {\n        flag[v][u]=1;\n        d[v][u]=duv;\n      }\n      }\n      for (l=1;l<=n;l++)\n        for (i=1;i<=n;i++)\n         for (j=1;j<=n;j++)\n           {\n           if (flag[i][l]&&flag[l][j])\n            {\n        if (d[i][j]>d[i][l]+d[l][j]) \n            d[i][j]=d[i][l]+d[l][j];\n            flag[i][j]=1;\n            }\n           }\n      if (flag[s][t]) cout<<d[s][t];\n        else cout<<-1;\n      return 0;\n}\n\n```",
        "postTime": 1382621404,
        "uid": 258,
        "name": "suzhe",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u6ca1\u7684\u8bf4 \u591a\u6e90\u6700\u77ed\u8def\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#define choose(a,b) (a<b?a:b)\nusing namespace std;\nconst int N(100+15);\nconst long long MAX=999999999;\nint n,k,m,s,t,u,v,d,c[N];\nint a[N][N],b[N][N];\nint main()\n {\n     //\u8f93\u5165\u6570\u636e \n     scanf(\"%d%d%d%d%d\",&n,&k,&m,&s,&t);\n     //\u8f93\u5165\u6587\u5316\n     for(int i=1;i<=n;i++) cin>>c[i];\n     //\u521d\u59cb\u5316a\u6570\u7ec4 \n     for(int i=1;i<=n;i++)\n       for(int j=1;j<=n;j++)\n         a[i][j]=MAX;\n     //\u8f93\u5165\u5404\u4e2a\u56fd\u5bb6\u4e4b\u95f4\u7684\u80fd\u5426\u5230\u8fbe\u5173\u7cfb,0\u8868\u793a\u80fd\u5230\u8fbe\uff0c1\u8868\u793a\u4e0d\u80fd\u5230\u8fbe \n     for(int i=1;i<=k;i++)\n       for(int j=1;j<=k;j++)\n       cin>>b[i][j];\n     //\u8f93\u5165\u56fd\u4e0e\u56fd\u4e4b\u95f4\u8054\u7cfb\u7684\u4fe1\u606f \n     for(int i=1;i<=m;i++)\n     {\n         scanf(\"%d%d%d\",&u,&v,&d);\n         //\u5982\u679c\u80fd\u5230\u8fbe\uff0c\u6211\u4eec\u5c31\u628a\u8ddd\u79bb\u521d\u59cb\u5316\u4e3a\u8def\u7684\u8ddd\u79bb\uff0c\u4e4b\u524d\u662f999999999\uff0c\u4e5f\u5c31\u662f\u89c4\u5b9a\u7684\u6700\u5927\u503c \n         if(!b[c[v]][c[u]]) a[u][v]=choose(a[u][v],d);\n         if(!b[c[u]][c[v]]) a[v][u]=choose(a[v][u],d);\n     }\n     //Floyed\u627e\u6700\u77ed\u8def \n     for(int k=1;k<=n;k++)\n       for(int i=1;i<=n;i++)\n           for(int j=1;j<=n;j++)\n           //\u5982\u679c\u70b9\u4e0e\u70b9\u4e92\u76f8\u80fd\u5230\u8fbe\u624d\u80fd\u7528 \n           //\u56fa\u5b9a\u6a21\u677f \n             if(!b[c[j]][c[i]]&&!b[c[k]][c[i]]&&!b[c[j]][c[k]])\n               a[i][j]=choose(a[i][k]+a[k][j],a[i][j]);\n     //\u5982\u679c\u5927\u4e8e\u6700\u5927\u503c\uff0c\u4e0d\u7528\u60f3\uff0c\u4e0d\u53ef\u80fd\u5230 \n     if(a[s][t]>=MAX) printf(\"-1\");\n     else  printf(\"%d\",a[s][t]);\n     return 0;\n}\n```",
        "postTime": 1507017784,
        "uid": 42186,
        "name": "\u6e05\u6c34\u6e7e\u843d\u8f66",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    },
    {
        "content": "\u7528\u52a8\u89c4\uff0cFloyd\u7b97\u6cd5\uff0c\u51fd\u6570\u89e3\u51b3\u6587\u5316\u76f8\u5bb9\u95ee\u9898\n\n```cpp\nvar   n,k,m,s,t,i,j,u,v,x:integer;\n    c:array [1..1000] of integer;\n    a,d:array [1..1000,1..1000] of integer;\n  begin\n    readln(n,k,m,s,t);\n    for i:=1 to n do\n      read(c[i]);\n    for i:=1 to k do\n      for j:=1 to k do\n        read(a[i,j]);\n    for i:=1 to n do\n      for j:=1 to n do\n        d[i,j]:=maxint;\n    for i:=1 to m do\n      begin\n        readln(u,v,x);\n        if a[c[u],c[v]]=0 then d[u,v]:=x;\n        if a[c[v],c[u]]=0 then d[v,u]:=x;\n      end;   \n    for i:=1 to n do\n      for j:=1 to n do\n        if i<>j then \n          for k:=1 to n do\n            if (a[c[k],c[i]]=0)and(a[c[j],c[k]]=0)and(i<>j)and(j<>k)and(d[i,j]>d[i,k]+d[k,j])\n              then d[i,j]:=d[i,k]+d[k,j];             \n    if d[s,t]=maxint then writeln('-1') else writeln(d[s,t]);\nend.\n```",
        "postTime": 1444025886,
        "uid": 7161,
        "name": "sunjunhan",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1078 \u3010\u6587\u5316\u4e4b\u65c5\u3011"
    }
]
[
    {
        "content": "### \u9898\u610f\r\n\r\n[Link](https://www.luogu.com.cn/problem/P8382)\r\n\r\n[\u4e50](https://www.luogu.com.cn/record/list?user=217300&pid=P8382&page=1)\r\n\r\nupd\uff1a\u53bb\u6389\u4e86\u51e0\u4e2a\u7a7a\u683c\u3002\r\n\r\n### \u89e3\u6cd5\r\n\r\n\u9996\u5148\u7a7a\u7684\u683c\u5b50\u6570\u91cf\u662f\u4e0d\u53d8\u7684\u3002\r\n\r\n\u6211\u4eec\u7528 $f_i$ \u8868\u793a\u53f3\u8d77\u7b2c $i$ \u4e2a\u7a7a\u683c\u5de6\u8fb9\u6709\u51e0\u4e2a\u8fde\u7eed\u7684\u68cb\u5b50\u3002\u7279\u6b8a\u5730\uff0c$f_0$ \u8868\u793a\u8868\u683c\u53f3\u8fb9\u53f3\u8d77\u6709\u51e0\u4e2a\u8fde\u7eed\u7684\u68cb\u5b50\u3002\r\n\r\n\u4f8b\u5982\u6837\u4f8b\u4e2d $f=\\{0,1,0,2,0\\}$\u3002\r\n\r\n\u5982\u6b64\uff0c\u6bcf\u6b21\u64cd\u4f5c\u4fbf\u53ef\u4ee5\u7b49\u4ef7\u4e3a\u9009\u62e9\u4e00\u4e2a $i(i> 0,f_i\\not=0)$\uff0c\u548c\u4e00\u4e2a\u5c0f\u4e8e $f_i$ \u7684\u6b63\u6574\u6570 $p$\uff0c$f_i\\leftarrow f_i-p$, $f_{i-1}\\leftarrow f_{i-1}+p$\u3002\u8fbe\u6210 $f_0>0$ \u8005\u83b7\u80dc\u3002\r\n\r\n\u7136\u540e\u5c31\u662f\u9636\u68af nim\u3002\u4e5f\u5c31\u662f\u8981\u6c42\u5bf9\u4e8e\u6240\u6709\u5947\u6570 $i$\uff0c$f_i$ \u7684\u5f02\u6216\u548c\u4e3a $0$ \u4e3a\u5148\u624b\u5fc5\u8d25\u6001\u3002\r\n\r\n\u4e8e\u662f\u672c\u9898\u5c31\u662f\u6c42\u64cd\u4f5c\u4e00\u6b21\u540e $f$ \u6570\u7ec4\u5947\u6570\u4f4d\u5f02\u6216\u548c\u4e3a $0$ \u7684\u65b9\u6848\u6570\u3002\r\n\r\n\u8003\u8651\u6c42\u51fa\u5947\u6570\u4f4d\u539f\u672c\u7684\u5f02\u6216\u548c $c$\u3002\r\n\r\n\u5bf9\u4e8e\u5947\u6570 $i$\uff0c$f_i$ \u53ef\u4ee5\u4e00\u6b65\u53d8\u6210 $[0,f_i)$ \u4e4b\u4e2d\u7684\u4e00\u4e2a\u6570\u3002\u6545\u5f53\u4e14\u4ec5\u5f53 $f_i \\oplus c\\in [0,f_i)$ \u53ef\u884c\u3002\r\n\r\n\u5bf9\u4e8e\u5076\u6570 $i$\uff0c$f_i$ \u53ef\u4ee5\u8ba9 $f_{i-1}$ \u4e00\u6b65\u53d8\u6210 $(f_{i-1},f_{i-1}+f_i]$ \u4e4b\u4e2d\u7684\u4e00\u4e2a\u6570\uff0c\u56e0\u6b64\u5f53\u4e14\u4ec5\u5f53 $f_{i-1}\\oplus c\\in (f_{i-1},f_{i-1}+f_i]$ \u53ef\u884c\u3002\r\n\r\n\u6ce8\u610f $i$ \u5f88\u5927\uff0c\u4e0d\u8981\u628a\u6240\u6709\u7684\u90fd\u5b58\u4e0b\u6765\u3002\u5b58\u975e $0$ \u7684\u5c31\u53ef\u4ee5\u4e86\u3002\r\n\r\n### Code\r\n\r\n```cpp#include<iostream>\r\n#include<algorithm>\r\n#include<stdio.h>\r\n#include<vector>\r\nusing namespace std;\r\n#define pii pair<int,int>\r\nconst void readln(int &I){\r\n    I=0;char C=getchar();bool f=0;\r\n    while(!isdigit(C))f|=(C=='-'),C=getchar();\r\n    while( isdigit(C))I=I*10+C-'0',C=getchar();\r\n    if(f)I=-I;\r\n}\r\nint m,n,pos[1000006],c,ans;\r\nvector<pii >f;\r\npii operator++(pii&px){px.second++;return px;}\r\nint main(){\r\n    readln(m),readln(n);\r\n    for(int i=1;i<=n;i++)\r\n        readln(pos[i]);\r\n    if(pos[n]==m-1){\r\n        for(int j=n-1;j>0;j--)  \r\n            if(pos[j]==pos[j+1]-1)++ans;\r\n            else break;\r\n        return printf(\"%d\\n\",++ans),0;\r\n    }\r\n    for(int i=n;i>=1;i--)\r\n        if(pos[i]==pos[i+1]-1)++*(f.rbegin());\r\n        else f.push_back(make_pair(m-pos[i]-(n-i),1));\r\n    for(auto fx:f)\r\n        if(fx.first&1)c^=fx.second;\r\n    for(int i=0;i<f.size();i++){\r\n        auto fx=f[i];\r\n        if(fx.first&1){\r\n            if(fx.second>(fx.second^c))\r\n            ++ans;\r\n        }\r\n        else if(i!=0){\r\n            int nx;\r\n            if(f[i-1].first==f[i].first-1) nx=f[i-1].second;\r\n            else nx=0;\r\n            if(fx.second+nx>=(nx^c) and (nx^c)>nx)++ans;\r\n        }\r\n        else if(f[i].first>3 and f.size()==2){//\u6ce8\u610f\u7279\u5224/kk\r\n            if(fx.second>=c)++ans;   // 8 3 1 3 4\r\n        }\r\n    }\r\n    printf(\"%d\\n\",ans);\r\n}\r\n```",
        "postTime": 1663675866,
        "uid": 217300,
        "name": "Error_Eric",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P8382 [POI2004] Gra"
    }
]
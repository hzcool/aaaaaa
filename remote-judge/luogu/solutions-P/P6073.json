[
    {
        "content": "### \u9898\u9762\n\n\u6211\u76f8\u4fe1\u6211\u8bb2\u7684\u5f88\u6e05\u695a\u3002 \n\n### \u524d\u8a00\n\n~~\u56fd\u5bb6\u961f\u961f\u7237\u5e76\u4e0d\u4f1a general \u60c5\u51b5\u4e0b\u7684\u505a\u6cd5\uff0c\u5982\u679c\u6709\u4eba\u60f3\u51fa\u6765\u4e86\u8bf7\u8054\u7cfb\u6211\uff0c\u5e76\u4e14\u4ed6\u53ef\u4ee5\u540a\u6253\u56fd\u5bb6\u961f\u961f\u7237~~\n\n~~\u987a\u4fbf\u63d0\u4e00\u53e5\uff0c\u90a3\u4e2a\u9898\u76ee\u53eb\u505a Epic Convolution II~~\n\n### \u9898\u89e3 \n\n### $\\texttt{Subtask 1(4 pts)}$\n\n\u4eba\u53e3\u666e\u67e5\u5206\u3002\n\n\u6211\u4eec\u6765\u63a8\u5f0f\u5b50\u3002\n\n$$f_n=\\sum\\limits_{k=0}^{n}k^ng_kh_{n-k}$$\n\n\u73b0\u5728\u8003\u8651\u628a\u8fd9\u4e2a\u4e1c\u897f\u62c6\u6210\u4e24\u534a\uff0c\u4e8e\u662f\u5f97\u5230\n\n$$f_n=\\sum\\limits_{k=0}^{m-1}k^ng_kh_{n-k}+\\sum\\limits_{k=m}^{n}k^ng_kh_{n-k}$$\n\n\u7136\u540e\u4ee3\u5165\uff0c\u7531\u4e8e $g_k$ \u5728 $k\\geq m$ \u7684\u65f6\u5019\u4e3a $0$\uff0c\u6240\u4ee5\u539f\u5f0f\u5316\u4e3a\n\n$$f_n=\\sum\\limits_{k=0}^{m-1}k^n$$\n\n\u7531\u4e8e $n$ \u5728\u6bcf\u7ec4\u8be2\u95ee\u4e2d\u662f\u4e0d\u53d8\u7684\uff0c\u6240\u4ee5\u9884\u5904\u7406\u4e00\u4e0b\u6bcf\u4e2a\u6570\u7684 $n$ \u6b21\u5e42\u5373\u53ef\u3002\n\n### $\\texttt{Subtask 2(16 pts)}$\n\n\u63a8\u5f0f\u5b50\u3002\n\n\u5148\u4e0d\u8003\u8651\u5f53 $k\\lt m$ \u65f6 $h_k=0$ \u7684\u9650\u5236\uff0c\u76f4\u63a5\u8ba9 $h_k=\\frac{(-1)^{k-m}}{(k-m)!}$\uff0c\u7136\u540e\u5f00\u59cb\u63a8\u5f0f\u5b50\u3002\n\n$$f_n=\\sum\\limits_{k=0}^{n}k^n\\frac{1}{(k+m+1)!}\\frac{(-1)^{n-k-m}}{(n-k-m)!}$$\n\n\u6ce8\u610f\u5230 $(k+m+1)+(n-k-m)=n+1$\uff0c\u6240\u4ee5\u7b49\u5f0f\u4e24\u8fb9\u540c\u65f6\u4e58\u4e0a $(n+1)!$\uff0c\u53ef\u4ee5\u628a\u53f3\u8fb9\u5199\u6210\u4e8c\u9879\u5f0f\u7684\u5f62\u5f0f\u3002\u4e8e\u662f\u6211\u4eec\u6709\n\n$$(n+1)!f_n=\\sum\\limits_{k=0}^{n}k^n(-1)^{n-k-m}\\binom{n+1}{k+m+1}$$\n\n\u7136\u540e\u611f\u89c9\u662f\u4e0d\u662f\u6709\u70b9\u4e0d\u77e5\u6240\u63aa\u4e86\uff1f\n\n\u5176\u5b9e\uff0c\u6211\u4eec\u63a5\u4e0b\u6765\u7684\u4e00\u6b65\u662f\u8981\u62c6\u53f3\u8fb9\u7684\u4e8c\u9879\u5f0f\u3002\uff08\u8fd9\u4e00\u6b65\u9700\u8981\u773c\u529b\u4ee5\u53ca\u5f88\u591a\u7684\u6280\u5de7\uff09\n\n\u8003\u8651\u5230\u6709\u8fd9\u6837\u4e00\u4e2a\u5f0f\u5b50\uff1a\n\n$$\\binom{n+1}{k+m+1}=\\sum\\limits_{j=0}^{n}\\binom{j}{k}\\binom{n-j}{m}$$\n\n\u6211\u4eec\u6765\u8bc1\u660e\u4e00\u4e0b\u3002\u4f60\u4f1a\u53d1\u73b0\u53f3\u8fb9\u90a3\u4e2a\u4e1c\u897f\u7279\u522b\u50cf\u5377\u79ef\u5f62\u5f0f\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528\u751f\u6210\u51fd\u6570\u7684\u601d\u60f3\u3002\n\n\u8003\u8651\u5728\u53f3\u8fb9\u4e58\u4e0a\u4e00\u4e2a $x^n$ \u5e76\u4e14\u628a\u5b83\u62c6\u6210 $x^j$ \u4e0e $x^{n-j}$ \u7684\u4e58\u79ef\uff0c\u4e8e\u662f\u7b49\u5f0f\u53f3\u8fb9\u53d8\u6210\u5982\u4e0b\u5f0f\u5b50\uff1a\n\n$$\\sum\\limits_{j=0}^{n}x^j\\binom{j}{k}x^{n-j}\\binom{n-j}{m}$$\n\n\u7136\u540e\u4f60\u4f1a\u53d1\u73b0\u6211\u4eec\u5982\u679c\u8bbe $F(x)=\\sum\\limits_{i=0}^{\\infty}\\binom{i}{k}x^i$ \u548c $G(x)=\\sum\\limits_{i=0}^{\\infty}\\binom{i}{m}x^i$\uff0c\u90a3\u4e48\u7b49\u5f0f\u53f3\u8fb9\u5c31\u662f\u4e24\u4e2a\u751f\u6210\u51fd\u6570\u7684\u4e58\u79ef\u7684 $x^n$ \u7684\u7cfb\u6570\u3002\n\n\u5e78\u8fd0\u7684\u662f\uff0c\u8fd9\u4e24\u4e2a\u751f\u6210\u51fd\u6570\u90fd\u6709\u7b80\u5355\u7684\u5c01\u95ed\u5f62\u5f0f\uff0c\u8fd9\u91cc\u4ee5 $F(x)$ \u4e3a\u4f8b\u3002\uff08\u5176\u5b9e $F(x)$ \u548c $G(x)$ \u5f62\u5f0f\u662f\u4e00\u6837\u7684\uff0c\u77e5\u9053\u4e00\u4e2a\u5c31\u77e5\u9053\u53e6\u4e00\u4e2a\uff09\n\n\u8003\u8651\u5230\u5f53 $i\\lt k$ \u7684\u65f6\u5019 $x^i$ \u7684\u7cfb\u6570\u4e3a $0$\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5e73\u79fb\u4e00\u4e0b\u3002\n\n\u6211\u4eec\u6784\u9020 $F^\\prime(x)=\\sum\\limits_{i=0}^{\\infty}\\binom{i+k}{k}x^i$\uff0c\u90a3\u4e48\u53ef\u4ee5\u53d1\u73b0 $F(x)=x^kF^\\prime(x)$\u3002\n\n\u7136\u800c $F^\\prime(x)$ \u7684\u5c01\u95ed\u5f62\u5f0f\u975e\u5e38\u7b80\u5355\uff0c\u662f $\\frac{1}{(1-x)^{k+1}}$\u3002\n\n\u6240\u4ee5\uff0c$F(x)=\\frac{x^k}{(1-x)^{k+1}}$\uff0c\u540c\u7406\u6709 $G(x)=\\frac{x^m}{(1-x)^{m+1}}$\uff0c\u4e8e\u662f\u5f97\u5230 $F(x)G(x)=\\frac{x^{k+m}}{(1-x)^{k+m+2}}$\u3002\n\n\u73b0\u5728\u6211\u4eec\u6765\u6c42\u5b83\u7684 $x^n$ \u7684\u7cfb\u6570\u3002\n\n\u6839\u636e\u4e0a\u9762\u7684\u63a8\u5bfc\uff0c\u6211\u4eec\u53d1\u73b0 $\\frac{x^{k+m}}{(1-x)^{k+m+1}}$ \u4e2d $x^n$ \u7684\u7cfb\u6570\u5f88\u597d\u6c42\uff0c\u800c\u6211\u4eec\u53d1\u73b0\n\n$$\\frac{x^{k+m}}{(1-x)^{k+m+2}}=\\frac{x^{k+m}}{(1-x)^{k+m+1}}\\frac{1}{1-x}$$\n\n\u800c\u8fd9\u4e2a $\\frac{1}{1-x}$ \u76f8\u5f53\u4e8e\u5c06\u7cfb\u6570\u505a\u524d\u7f00\u548c\u3002\uff08\u4f46\u51e1\u662f\u5b66\u8fc7\u4e00\u70b9\u751f\u6210\u51fd\u6570\u7684\u90fd\u77e5\u9053\u5427\uff09\uff0c\u6240\u4ee5\u6211\u4eec\u7684\u7b54\u6848\u4e3a\n\n$$\\sum\\limits_{i=0}^{n}\\binom{i}{k+m}$$\n\n\u8fd9\u5c31\u662f\u4e2a\u88f8\u7684\u4e0a\u6307\u6807\u6c42\u548c\uff0c\u56e0\u6b64\u7b54\u6848\u4e3a $\\binom{n+1}{k+m+1}$\u3002\n\n\u554a\u54c8\uff01\u56de\u5230\u6b63\u9898\uff0c\u628a\u6211\u4eec\u521a\u521a\u8bc1\u660e\u7684\u5f0f\u5b50\u4ee3\u5165\u4e00\u4e0b\uff0c\u53ef\u5f97\n\n$$(n+1)!f_n=\\sum\\limits_{k=0}^{n}k^n(-1)^{n-k-m}\\sum\\limits_{j=0}^{n}\\binom{j}{k}\\binom{n-j}{m}$$\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u53ef\u4ee5\u8c03\u6574\u4e00\u4e0b\u6c42\u548c\u7684\u4e0a\u4e0b\u754c\uff0c\u6240\u4ee5\u6709\n\n$$(n+1)!f_n=\\sum\\limits_{k=0}^{n}\\sum\\limits_{j=k}^{n}k^n(-1)^{n-k-m}\\binom{j}{k}\\binom{n-j}{m}$$\n\n\u7136\u540e\u4ea4\u6362\u4e00\u4e0b\u6c42\u548c\u987a\u5e8f\uff0c\u5f97\u5230\n\n$$(n+1)!f_n=\\sum\\limits_{j=0}^{n}\\sum\\limits_{k=0}^{j}k^n(-1)^{n-k-m}\\binom{j}{k}\\binom{n-j}{m}$$\n\n\u63a5\u7740\u62c6 $(-1)^{n-k-m}$\uff0c\u62c6\u6210 $(-1)^{j-k}$ \u548c $(-1)^{n-j-m}$\uff0c\u5f97\u5230\uff08\u8fd9\u4e00\u6b65\u9700\u8981\u773c\u529b\u4ee5\u53ca\u5f88\u591a\u7684\u6280\u5de7\uff09\n\n$$(n+1)!f_n=\\sum\\limits_{j=0}^{n}\\sum\\limits_{k=0}^{j}k^n(-1)^{j-k}(-1)^{n-j-m}\\binom{j}{k}\\binom{n-j}{m}$$\n\n\u7136\u540e\u6211\u4eec\u5199\u7684\u6e05\u695a\u70b9\n\n$$(n+1)!f_n=\\sum\\limits_{j=0}^{n}(-1)^{n-j-m}\\binom{n-j}{m}\\sum\\limits_{k=0}^{j}k^n(-1)^{j-k}\\binom{j}{k}$$\n\n\u7136\u540e\u53d1\u73b0\u53f3\u8fb9\u90a3\u4e2a\u4e1c\u897f\u662f\u65af\u7279\u6797\u6570\u7684\u5f62\u5f0f\u5565\u7684\uff0c\u5c31\u53ef\u4ee5\u5316\u5f00\u4e86\uff0c\u6240\u4ee5\u63a8\u51fa\u6765\u6709\n\n$$(n+1)!f_n=\\sum\\limits_{j=0}^{n}\\begin{Bmatrix}n\\\\j\\end{Bmatrix}\\binom{n-j}{m}(-1)^{n-j-m}j!$$\n\n\u63a5\u4e0b\u6765\uff0c\u53f3\u8fb9\u662f\u4e00\u4e2a\u5f88\u7ecf\u5178\u7684\u516c\u5f0f\uff0c\u8bc1\u660e\u53ef\u4ee5\u770b[\u6211 P5825 \u7684\u9898\u89e3](https://www.luogu.com.cn/blog/Karry5307/solution-p5825)\uff0c\u7531\u4e8e\u8bc1\u660e\u8fc7\u7a0b\u592a\u957f\u4e86\uff0c\u6240\u4ee5\u4e0d\u5199\u5728\u8fd9\u91cc\u3002\uff08\u56e0\u4e3a\u540e\u9762\u8fd8\u6709\u597d\u51e0\u4e2a $\\texttt{Subtask}$\uff09\n\n\u6240\u4ee5\u6211\u4eec\u5f97\u5230\n\n$$f_n=\\frac{\\left\\langle\\begin{matrix}n\\\\m\\end{matrix}\\right\\rangle}{(n+1)!}$$\n\n\u8003\u8651\u5230\u5f53 $n\\leq m$ \u7684\u65f6\u5019 $f_n$ \u4e3a $0$\uff0c\u6240\u4ee5\u5b83\u786e\u5b9e\u662f\u6b63\u786e\u7b54\u6848\u3002\n\n\u4f46\u662f\uff0c\u6211\u4eec\u53d1\u73b0 $m$ \u5f88\u5c0f\uff08\u5f88\u5927\u7684\u65f6\u5019\u505a\u4e0d\u505a\u5f97\u51fa\u8fd8\u662f\u95ee\u9898\uff09\uff0c\u6240\u4ee5\u53ef\u4ee5\u8003\u8651\u53e6\u5916\u4e00\u4e2a\u5f88\u7ecf\u5178\u7684\u516c\u5f0f\uff1a\uff08P5825 \u9898\u89e3\u6709\u4eba\u8bc1\u660e\u4e86\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u8bc1\u660e\u8fc7\u7a0b\u8ddf \u4e4b\u524d\u7684\u5f0f\u5b50\u4e00\u6837\uff0c\u90fd\u662f\u6570\u5b66\u5f52\u7eb3\u6cd5\uff09\n\n$$\\left\\langle\\begin{matrix}n\\\\m\\end{matrix}\\right\\rangle=\\sum\\limits_{k=0}^{m}\\binom{n+1}{k}(m+1-k)^n(-1)^k$$\n\n\u7136\u540e\u9884\u5904\u7406\u4e00\u4e0b\u5e42\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(nm+qm)$\u3002\n\n\u7279\u522b\u7684\u662f\uff0c\u5982\u679c\u4f60\u4e0d\u9884\u5904\u7406\u5e42\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(qm\\log n)$\uff0c\u5982\u679c\u5199\u7684\u4e0d\u597d\u53ef\u80fd\u4e0d\u4f1a\u901a\u8fc7\u3002\n\n### $\\texttt{Subtask 3(16 pts)}$\n\n\u4e00\u4e9b\u6280\u5de7\u6027\u7684\u4e1c\u897f\u3002\n\n$n$ \u7684\u8303\u56f4\u53d8\u6210\u4e86 $998244353$ \u800c\u4e0d\u662f $10^5$\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u6bd4\u8f83\u5feb\u901f\u7684\u6765\u5904\u7406 $(n+1)!$\u3002\n\n\u7531\u4e8e\u5feb\u901f\u9636\u4e58\u7b97\u6cd5\u592a\u6162\uff0c\u5e76\u4e14\u6a21\u6570\u56fa\u5b9a\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u5206\u5757\u6253\u8868\uff0c\u53ef\u4ee5\u8003\u8651\u6bcf $10^6$ \u6253\u4e00\u6b21\u3002\n\n\u7136\u800c\u53ef\u80fd\u4f1a\u5f88\u5361\u5e38\uff0c\u5e42\u4e5f\u8981\u5206\u5757\u6253\u8868\u4e00\u4e0b\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(m\\sqrt{M}+q(m+l))$\u3002\uff08\u8fd9\u91cc\u7528 $M$ \u8868\u793a\u6a21\u6570\uff0c$l$ \u8868\u793a\u9636\u4e58\u5206\u5757\u6253\u8868\u7684\u5757\u957f\uff09\uff0c\u5982\u679c\u5e42\u4e0d\u5206\u5757\u6253\u8868\u800c\u662f\u76f4\u63a5\u5feb\u901f\u5e42\u7684\u8bdd\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(q(m\\log n+l))$\uff0c\u53ef\u80fd\u65e0\u6cd5\u901a\u8fc7\u3002\n\n### $\\texttt{Subtask 4(32 pts)}$\n\n\u5927\u91cf\u7684 dirty works \u4ee5\u53ca\u4e00\u4e9b\u6280\u5de7\u6027\u7684\u4e1c\u897f\u3002\n\n\u9996\u5148\u5148\u63a8\u5f0f\u5b50\u3002\n\n$$f_n=\\sum\\limits_{k=0}^{n}k^n\\frac{k^m}{k!}\\frac{(-1)^k}{k}$$\n\n\u773c\u5c16\u7684\u795e\u4ed9\u53ef\u4ee5\u53d1\u73b0\u8fd9\u5c31\u662f\u4e2a\u65af\u7279\u6797\u6570\uff0c\u6240\u4ee5\n\n$$f_n=\\begin{Bmatrix}n+m\\\\n\\end{Bmatrix}$$\n\n\u63a5\u4e0b\u6765\u4f7f\u7528\u4e8c\u9636\u6b27\u62c9\u6570\u8fdb\u884c\u8ba1\u7b97\u3002\u6211\u4eec\u6709\u4ee5\u4e0b\u4e24\u4e2a\u6052\u7b49\u5f0f\uff1a\n\n$$\\begin{Bmatrix}x\\\\x-n\\end{Bmatrix}=\\sum\\limits_{k}\\left\\langle\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle\\right\\rangle\\binom{x+n-1-k}{2n}$$\n\n\u548c\n\n$$\\begin{bmatrix}x\\\\x-n\\end{bmatrix}=\\sum\\limits_{k}\\left\\langle\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle\\right\\rangle\\binom{x+k}{2n}$$\n\n\u8bc1\u660e\u53ef\u4ee5\u4f7f\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u5bf9 $n$ \u8fdb\u884c\u5f52\u7eb3\u3002\n\n\u7136\u540e\u8003\u8651\u65af\u7279\u6797\u591a\u9879\u5f0f\uff0c\u6839\u636e\u5b9a\u4e49\uff0c\u6709\n\n$$\\sigma_n(x)=\\frac{\\begin{bmatrix}x\\\\x-n\\end{bmatrix}}{x(x-1)\\cdots(x-n)}$$\n\n\u6211\u4eec\u77e5\u9053\uff0c$\\sigma_n(x)$ \u7684\u6b21\u6570\u662f $n-1$\uff0c\u800c\u5206\u6bcd\u7684\u6b21\u6570\u4e3a $n+1$\uff0c\u6240\u4ee5\u8bf4\uff0c$\\begin{bmatrix}x\\\\x-n\\end{bmatrix}$ \u7684\u6b21\u6570\u4e3a $2n$\u3002\n\n\u7c7b\u4f3c\u5730\uff0c\u7531\u4e8e $\\binom{x+n-1-k}{2n}$ \u4e0e $\\binom{x+k}{2n}$ \u6b21\u6570\u603b\u662f\u76f8\u540c\uff0c\u6240\u4ee5 $\\begin{Bmatrix}x\\\\x-n\\end{Bmatrix}$ \u7684\u6b21\u6570\u4e5f\u4e3a $2n$\uff0c\u4e5f\u5c31\u662f\u8bf4 $\\begin{Bmatrix}x+n\\\\x\\end{Bmatrix}$ \u7684\u6b21\u6570\u4e5f\u4e3a $2n$\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u624b\u6bb5\u7b97\u51fa $x$ \u5f88\u5c0f\u7684\u65f6\u5019\u7684\u4e00\u4e9b\u503c\u7136\u540e\u5e26\u8fdb\u53bb\u63d2\u503c\u5c31\u53ef\u4ee5\u5f97\u5230\u901a\u9879\u516c\u5f0f\u3002\n\n\u63a5\u4e0b\u6765\u5c31\u662f\u624b\u7b97\u65af\u7279\u6797\u6570\u8fd9\u79cd dirty works \u4e86\uff0c\u7b97\u5b8c\u4e4b\u540e\u518d\u63d2\u503c\u5c31\u53ef\u4ee5\u6253\u8868\u6c42\u51fa\u8fd9\u4e9b\u591a\u9879\u5f0f\u4e86\u3002\u4e3a\u4ec0\u4e48\u521a\u521a\u8bf4\u660e\u4e86\u591a\u9879\u5f0f\u7684\u6b21\u6570\u5462\uff0c\u662f\u65b9\u4fbf\u4f60\u624b\u7b97\u7684\u3002\uff08\u6211\u5728\u8fd9\u4e2a\u5b50\u4efb\u52a1\u4e0a\u7528\u4e86\u4e00\u4e2a\u4e0b\u5348\uff09\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(qm)$\uff0c\u5982\u679c\u4e0d\u4f7f\u7528\u79e6\u4e5d\u97f6\u76f4\u63a5\u5feb\u901f\u5e42\u7684\u8bdd\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(qm\\log n)$\uff0c\u53ef\u80fd\u65e0\u6cd5\u901a\u8fc7\u3002\n\n\u540e\u9762 $10$ \u4e2a\u6d4b\u8bd5\u70b9\uff0c\u7531\u4e8e $n$ \u7684\u8303\u56f4\u975e\u5e38\u5927\uff0c\u6240\u4ee5\u8fb9\u8bfb\u5165\u8fb9\u53d6\u6a21\u3002 \n\n### $\\texttt{Subtask 5(32 pts)}$\n\n\u6bd4 $\\texttt{Subtask 3}$ \u66f4\u96be\uff0c\u5f62\u5f0f\u66f4\u9690\u853d\u7684\u6570\u5b66\u63a8\u5bfc\u3002\n\n\u8003\u8651\u5148\u4ea4\u6362\u6c42\u548c\u987a\u5e8f\n\n$$ans=\\sum\\limits_{i=0}^{m}\\sum\\limits_{k=0}^{m-i}\\frac{(k+1)^{m+n+1-i}}{(k+1)!}\\frac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!}$$\n\n\u7136\u540e\u6539\u53d8\u4e00\u4e0b\u5185\u5c42\u548c\u5f0f\u7684\u4e0a\u4e0b\u754c\uff08\u4e5f\u5c31\u662f\u5c06\u539f\u6765\u7684 $k+1$ \u53d8\u6210\u4e86\u73b0\u5728\u7684 $k$\uff09\n\n$$ans=\\sum\\limits_{i=0}^{m}\\sum\\limits_{k=1}^{m-i+1}\\frac{k^{m+n+1-i}}{k!}\\frac{\\binom{2n+1}{i}(-1)^{m-k+1}}{(m-k+1-i)!}$$\n\n\u8003\u8651\u5230\u5f53 $k=0$ \u65f6\u91cc\u9762\u7684\u548c\u5f0f\u4e3a $0$\uff0c\u6240\u4ee5\u6539\u4e00\u4e0b\u4e0b\u754c\u3002\u63a5\u4e0b\u6765\u62c6 $(-1)^{m-k+1}$\uff0c\u62c6\u6210 $(-1)^{i}$ \u548c $(-1)^{m-k+1-i}$\uff0c\u5e76\u4e14\u628a\u4e0e $k$ \u65e0\u5173\u7684\u9879\u63d0\u51fa\u6765\n\n$$ans=\\sum\\limits_{i=0}^{m}\\binom{2n+1}{i}(-1)^i\\sum\\limits_{k=0}^{m-i+1}\\frac{k^{m+n+1-i}}{k!}\\frac{(-1)^{m-k+1-i}}{(m-k+1-i)!}$$\n\n\u53d1\u73b0\u53f3\u8fb9\u662f\u4e2a\u65af\u7279\u6797\u6570\uff0c\u4e8e\u662f\u6709\n\n$$ans=\\sum\\limits_{i=0}^{m}\\binom{2n+1}{i}(-1)^i\\begin{Bmatrix}n+m+1-i\\\\m+1-i\\end{Bmatrix}$$\n\n\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u7ecf\u5178\u7684\u516c\u5f0f\uff0c\u662f\u4e8c\u9636\u6b27\u62c9\u6570\u7684\u901a\u9879\u516c\u5f0f\uff0c\u8bc1\u660e\u7684\u8bdd\u53ef\u4ee5\u4f7f\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\uff0c\u7c7b\u4f3c\u4e8e\u4e4b\u524d\u63d0\u5230\u7684\u4e00\u6837\u3002\n\n\u8fd9\u4e2a\u4e1c\u897f\u6709\u4e2a\u7ec4\u5408\u610f\u4e49\uff0c\u5c31\u662f\u591a\u91cd\u96c6 $\\{1,1,2,2,\\cdots,n,n\\}$ \u7684\u6ee1\u8db3\u5bf9\u4e8e $1\\leq m\\leq n$\uff0c$m$ \u7684\u4e24\u6b21\u51fa\u73b0\u4e4b\u95f4\u7684\u6240\u6709\u6570\u90fd\u5927\u4e8e $m$ \u7684\u6392\u5217\u4e2a\u6570\u3002\n\n$\\texttt{dp}$ \u4e00\u4e0b\u5c31\u597d\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2+q)$\u3002\n\n\u54ce\uff0c\u7b97\u4e86\uff0c\u4e0e\u9c30\u8fbe\u6210\u534f\u8bae\uff0c\u628a\u4ee3\u7801\u653e\u51fa\u6765\u5427\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef int ll;\ntypedef long long int li;\nconst ll MAXN=2e5+51,MOD=998244353;\nll taskId; \nll factBlock[1051]={1,373341033,45596018,834980587,623627864,428937595,442819817,499710224,833655840,83857087,295201906,788488293,671639287,849315549,597398273,813259672,732727656,244038325,122642896,310517972,160030060,483239722,683879839,712910418,384710263,433880730,844360005,513089677,101492974,959253371,957629942,678615452,34035221,56734233,524027922,31729117,102311167,330331487,8332991,832392662,545208507,594075875,318497156,859275605,300738984,767818091,864118508,878131539,316588744,812496962,213689172,584871249,980836133,54096741,417876813,363266670,335481797,730839588,393495668,435793297,760025067,811438469,720976283,650770098,586537547,117371703,566486504,749562308,708205284,932912293,939830261,983699513,206579820,301188781,593164676,770845925,247687458,41047791,266419267,937835947,506268060,6177705,936268003,166873118,443834893,328979964,470135404,954410105,117565665,832761782,39806322,478922755,394880724,821825588,468705875,512554988,232240472,876497899,356048018,895187265,808258749,575505950,68190615,939065335,552199946,694814243,385460530,529769387,640377761,916128300,440133909,362216114,826373774,502324157,457648395,385510728,904737188,78988746,454565719,623828097,686156489,713476044,63602402,570334625,681055904,222059821,477211096,343363294,833792655,461853093,741797144,74731896,930484262,268372735,941222802,677432735,474842829,700451655,400176109,697644778,390377694,790010794,360642718,505712943,946647976,339045014,715797300,251680896,70091750,40517433,12629586,850635539,110877109,571935891,695965747,634938288,69072133,155093216,749696762,963086402,544711799,724471925,334646013,574791029,722417626,377929821,743946412,988034679,405207112,18063742,104121967,638607426,607304611,751377777,35834555,313632531,18058363,656121134,40763559,562910912,495867250,48767038,210864657,659137294,715390025,865854329,324322857,388911184,286059202,636456178,421290700,832276048,726437551,526417714,252522639,386147469,674313019,274769381,226519400,272047186,117153405,712896591,486826649,119444874,338909703,18536028,41814114,245606459,140617938,250512392,57084755,157807456,261113192,40258068,194807105,325341339,884328111,896332013,880836012,737358206,202713771,785454372,399586250,485457499,640827004,546969497,749602473,159788463,159111724,218592929,675932866,314795475,811539323,246883213,696818315,759880589,4302336,353070689,477909706,559289160,79781699,878094972,840903973,367416824,973366814,848259019,462421750,667227759,897917455,81800722,956276337,942686845,420541799,417005912,272641764,941778993,217214373,192220616,267901132,50530621,652678397,354880856,164289049,781023184,105376215,315094878,607856504,733905911,457743498,992735713,35212756,231822660,276036750,734558079,424180850,433186147,308380947,18333316,12935086,351491725,655645460,535812389,521902115,67016984,48682076,64748124,489360447,361275315,786336279,805161272,468129309,645091350,887284732,913004502,358814684,281295633,328970139,395955130,164840186,820902807,761699708,246274415,592331769,913846362,866682684,600130702,903837674,529462989,90612675,526540127,533047427,110008879,674279751,801920753,645226926,676886948,752481486,474034007,457790341,166813684,287671032,188118664,244731384,404032157,269766986,423996017,182948540,356801634,737863144,652014069,206068022,504569410,919894484,593398649,963768176,882517476,702523597,949028249,128957299,171997372,50865043,20937461,690959202,581356488,369182214,993580422,193500140,540665426,365786018,743731625,144980423,979536721,773259009,617053935,247670131,843705280,30419459,985463402,261585206,237885042,111276893,488166208,137660292,720784236,244467770,26368504,792857103,666885724,670313309,905683034,259415897,512017253,826265493,111960112,633652060,918048438,516432938,386972415,996212724,610073831,444094191,72480267,665038087,11584804,301029012,723617861,113763819,778259899,937766095,535448641,593907889,783573565,673298635,599533244,655712590,173350007,868198597,169013813,585161712,697502214,573994984,285943986,675831407,3134056,965907646,401920943,665949756,236277883,612745912,813282113,892454686,901222267,624900982,927122298,686321335,84924870,927606072,506664166,353631992,165913238,566073550,816674343,864877926,171259407,908752311,874007723,803597299,613676466,880336545,282280109,128761001,58852065,474075900,434816091,364856903,149123648,388854780,314693916,423183826,419733481,888483202,238933227,336564048,757103493,100189123,855479832,51370348,403061033,496971759,831753030,251718753,272779384,683379259,488844621,881783783,659478190,445719559,740782647,546525906,985524427,548033568,333772553,331916427,752533273,730387628,93829695,655989476,930661318,334885743,466041862,428105027,888238707,232218076,769865249,730641039,616996159,231721356,326973501,426068899,722403656,742756734,663270261,364187931,350431704,671823672,633125919,226166717,386814657,237594135,451479365,546182474,119366536,465211069,605313606,728508871,249619035,663053607,900453742,48293872,229958401,62402409,69570431,71921532,960467929,537087913,514588945,513856225,415497414,286592050,645469437,102052166,163298189,873938719,617583886,986843080,962390239,580971332,665147020,88900164,89866970,826426395,616059995,443012312,659160562,229855967,687413213,59809521,398599610,325666688,154765991,159186619,210830877,386454418,84493735,974220646,820097297,2191828,481459931,729073424,551556379,926316039,151357011,808637654,218058015,786112034,850407126,84202800,94214098,30019651,121701603,176055335,865461951,553631971,286620803,984061713,888573766,302767023,977070668,110954576,83922475,51568171,60949367,19533020,510592752,615419476,341370469,912573425,286207526,206707897,384156962,414163604,193301813,749570167,366933789,11470970,600191572,391667731,328736286,30645366,215162519,604947226,236199953,718439098,411423177,803407599,632441623,766760224,263006576,757681534,61082578,681666415,947466395,12206799,659767098,933746852,978860867,59215985,161179205,439197472,259779111,511621808,145770512,882749888,943124465,872053396,631078482,166861622,743415395,772287179,602427948,924112080,385643091,794973480,883782693,869723371,805963889,313106351,262132854,400034567,488248149,265769800,791715397,408753255,468381897,415812467,172922144,64404368,281500398,512318142,288791777,955559118,242484726,536413695,205340854,707803527,576699812,218525078,875554190,46283078,833841915,763148293,807722138,788080170,556901372,150896699,253151120,97856807,918256774,771557187,582547026,472709375,911615063,743371401,641382840,446540967,184639537,157247760,775930891,939702814,499082462,19536133,548753627,593243221,563850263,185475971,687419227,396799323,657976136,864535682,433009242,860830935,33107339,517661450,467651311,812398757,202133852,431839017,709549400,99643620,773282878,290471030,61134552,129206504,929147251,837008968,422332597,353775281,469563025,62265336,835064501,851685235,21197005,264793769,326416680,118842991,84257200,763248924,687559609,150907932,401832452,242726978,766752066,959173604,390269102,992293822,744816299,476631694,177284763,702429415,374065901,169855231,629007616,719169602,564737074,475119050,714502830,40993711,820235888,749063595,239329111,612759169,18591377,419142436,442202439,941600951,158013406,637073231,471564060,447222237,701248503,599797734,577221870,69656699,51052704,6544303,10958310,554955500,943192237,192526269,897983911,961628039,240232720,627280533,710239542,70255649,261743865,228474833,776408079,304180483,63607040,953297493,758058902,395529997,156010331,825833840,539880795,234683685,52626619,751843490,116909119,62806842,574857555,353417551,40061330,822203768,681051568,490913702,9322961,766631257,124794668,37844313,163524507,729108319,490867505,47035168,682765157,53842115,817965276,757179922,339238384,909741023,150530547,158444563,140949492,993302799,551621442,137578883,475122706,443869843,605400098,689361523,769596520,801661499,474900284,586624857,349960501,134084537,650564083,877097974,379857427,887890124,159436401,133274277,986182139,729720334,568925901,459461496,499309445,493171177,460958750,380694152,168836226,840160881,141116880,225064950,109618190,842341383,85305729,759273275,97369807,669317759,766247510,829017039,550323884,261274540,918239352,29606025,870793828,293683814,378510746,367270918,481292028,813097823,798448487,230791733,899305835,504040630,162510533,479367951,275282274,806951470,462774647,56473153,184659008,905122161,664034750,109726629,59372704,325795100,486860143,843736533,924723613,880348000,801252478,616515290,776142608,284803450,583439582,274826676,6018349,377403437,244041569,527081707,544763288,708818585,354033051,904309832,589922898,673933870,682858433,945260111,899893421,515264973,911685911,9527148,239480646,524126897,48259065,578214879,118677219,786127243,869205770,923276513,937928886,802186160,12198440,638784295,34200904,758925811,185027790,80918046,120604699,610456697,573601211,208296321,49743354,653691911,490750754,674335312,887877110,875880304,308360096,414636410,886100267,8525751,636257427,558338775,500159951,696213291,97268896,364983542,937928436,641582714,586211304,345265657,994704486,443549763,207259440,302122082,166055224,623250998,239642551,476337075,283167364,211328914,68064804,950202136,187552679,18938709,646784245,598764068,538505481,610424991,864445053,390248689,278395191,686098470,935957187,868529577,329970687,804930040,84992079,474569269,810762228,573258936,756464212,155080225,286966169,283614605,19283401,24257676,871831819,612689791,846988741,617120754,971716517,979541482,297910784,991087897,783825907,214821357,689498189,405026419,946731704,609346370,707669156,457703127,957341187,980735523,649367684,791011898,82098966,234729712,105002711,130614285,291032164,193188049,363211260,58108651,100756444,954947696,346032213,863300806,36876722,622610957,289232396,667938985,734886266,395881057,417188702,183092975,887586469,83334648,797819763,100176902,781587414,841864935,371674670,18247584};\ninline ll read()\n{\n    register ll num=0;\n    register char ch=getchar();\n    while(!isdigit(ch))\n    {\n        ch=getchar();\n    }\n    while(isdigit(ch))\n    {\n        num=(num<<3)+(num<<1)+(ch-'0');\n        ch=getchar();\n    }\n    return num;\n}\ninline ll readm()\n{\n    register li num=0;\n    register char ch=getchar();\n    while(!isdigit(ch))\n    {\n        ch=getchar();\n    }\n    while(isdigit(ch))\n    {\n        num=((num<<3)+(num<<1)+(ch-'0'))%MOD;\n        ch=getchar();\n    }\n    return num;\n}   \ninline ll qpow(ll base,ll exponent)\n{\n    ll res=1;\n    while(exponent)\n    {\n        if(exponent&1)\n        {\n            res=(li)res*base%MOD;\n        }\n        base=(li)base*base%MOD,exponent>>=1;\n    }\n    return res;\n}\ninline ll calcFact(ll x)\n{\n\tll res=factBlock[x/1000000];\n\tfor(register int i=x/1000000*1000000+1;i<=x;i++)\n\t{\n\t\tres=(li)res*i%MOD;\n\t}\n\treturn res;\n}\nnamespace Subtask1{\n\tll p,qcnt,x;\n\tll pw[MAXN];\n\tinline void main()\n\t{\n\t\tp=read()-1,qcnt=read(); \n\t\tfor(register int i=1;i<=p;i++)\n\t\t{\n\t\t\tpw[i]=(pw[i-1]+qpow(i,p+1))%MOD;\n\t\t}\n\t\tfor(register int i=0;i<qcnt;i++)\n\t\t{\n\t\t\tprintf(\"%d\\n\",pw[read()-1]);\n\t\t}\n\t}\n} \nnamespace Subtask2{\n\tll n,m,qcnt,numer,cur,hi,lo;\n\tli res; \n\tll block[22][32768],pw[22][32768],fact[MAXN],finv[MAXN];\t\n\tinline void setup(ll cnt)\n\t{\n\t\tfact[0]=finv[0]=1;\n\t\tblock[1][1]=1;\n\t\tblock[2][1]=167578608;\n\t\tblock[3][1]=192671909;\n        block[4][1]=683753077;\n        block[5][1]=21763235;\n        block[6][1]=791422997;\n        block[7][1]=326153078;\n        block[8][1]=883105292;\n        block[9][1]=84695472;\n        block[10][1]=823499382;\n        block[11][1]=659299615;\n        block[12][1]=359937775;\n        block[13][1]=647360147;\n        block[14][1]=699980812;\n        block[15][1]=695403701;\n        block[16][1]=918327899;\n        block[17][1]=48786078;\n        block[18][1]=285585793;\n        block[19][1]=698289863;\n        block[20][1]=63206045;\n        block[21][1]=995343487;\n\t\tfor(register int i=1;i<cnt;i++)\n\t\t{\n\t\t\tfact[i]=(li)fact[i-1]*i%MOD;\n\t\t}\n\t\tfor(register int i=1;i<=21;i++)\n\t\t{\n\t\t\tpw[i][0]=block[i][0]=1,pw[i][1]=i;\n\t\t\tfor(register int j=1;j<32768;j++)\n\t\t\t{\n\t\t\t\tpw[i][j]=(li)pw[i][j-1]*i%MOD;\n\t\t\t\tblock[i][j]=(li)block[i][j-1]*block[i][1]%MOD;\n\t\t\t}\n\t\t} \n\t\tfinv[cnt-1]=qpow(fact[cnt-1],MOD-2);\n\t\tfor(register int i=cnt-2;i;i--)\n\t\t{\n\t\t\tfinv[i]=(li)finv[i+1]*(i+1)%MOD;\n\t\t}\n\t}\n\tinline void solve()\n\t{\n\t\tif(!m)\n\t\t{\n\t\t\treturn (void)(puts(\"1\"));\t\n\t\t}\t\n\t\tnumer=1,res=0,hi=n>>15,lo=n&32767;\n\t\tfor(register int i=m+1,sgn=1,j=n+1;i;i--,sgn^=1,j--)\n\t\t{\n\t\t\tcur=(li)block[i][hi]*pw[i][lo]%MOD*numer%MOD*finv[m+1-i]%MOD;\n\t\t\tres=sgn?res+cur:res-cur+MOD;\n\t\t\tnumer=(li)numer*j%MOD;\n\t\t}\n\t\tprintf(\"%d\\n\",res%MOD*finv[n+1]%MOD);\n\t}\n\tinline void main()\n\t{\n\t\tsetup(200011),qcnt=read();\n\t\tfor(register int i=0;i<qcnt;i++)\n\t\t{\n\t\t\tn=read(),m=read(),solve();\n\t\t}\n\t}\n}\nnamespace Subtask3{\n\tll qcnt,n,m,hi,lo,numer,res,cur;\n\tll block[22][32768],pw[22][32768],finv[22];\n\tinline void setup()\n\t{\n\t\tblock[1][1]=1;\n\t\tblock[2][1]=167578608;\n\t\tblock[3][1]=192671909;\n        block[4][1]=683753077;\n        block[5][1]=21763235;\n        block[6][1]=791422997;\n        block[7][1]=326153078;\n        block[8][1]=883105292;\n        block[9][1]=84695472;\n        block[10][1]=823499382;\n        block[11][1]=659299615;\n        block[12][1]=359937775;\n        block[13][1]=647360147;\n        block[14][1]=699980812;\n        block[15][1]=695403701;\n        block[16][1]=918327899;\n        block[17][1]=48786078;\n        block[18][1]=285585793;\n        block[19][1]=698289863;\n        block[20][1]=63206045;\n        block[21][1]=995343487;\n        finv[0]=finv[1]=1;\n        finv[2]=499122177;\n        finv[3]=166374059;\n        finv[4]=291154603;\n        finv[5]=856826403;\n        finv[6]=641926577;\n        finv[7]=376916469;\n        finv[8]=421456191;\n        finv[9]=712324701;\n        finv[10]=370705776;\n        finv[11]=305948985;\n        finv[12]=275056837;\n        finv[13]=405098354;\n        finv[14]=314148269;\n        finv[15]=154042465;\n        finv[16]=945481735;\n        finv[17]=407938109;\n        finv[18]=632701444;\n        finv[19]=33300076;\n        finv[20]=400962745;\n        finv[21]=637054254;\n\t\tfor(register int i=1;i<=21;i++)\n\t\t{\n\t\t\tpw[i][0]=block[i][0]=1,pw[i][1]=i;\n\t\t\tfor(register int j=1;j<32768;j++)\n\t\t\t{\n\t\t\t\tpw[i][j]=(li)pw[i][j-1]*i%MOD;\n\t\t\t\tblock[i][j]=(li)block[i][j-1]*block[i][1]%MOD;\n\t\t\t}\n\t\t} \n\t}\n\tinline void solve()\n\t{\n\t\tif(!m)\n\t\t{\n\t\t\treturn (void)(puts(\"1\"));\t\n\t\t}\t\n\t\tnumer=1,res=0,hi=n>>15,lo=n&32767;\n\t\tfor(register int i=m+1,sgn=1,j=n+1;i;i--,sgn^=1,j--)\n\t\t{\n\t\t\tcur=(li)block[i][hi]*pw[i][lo]%MOD*numer%MOD*finv[m+1-i]%MOD;\n\t\t\tres=sgn?(res+cur)%MOD:(res-cur+MOD)%MOD;\n\t\t\tnumer=(li)numer*j%MOD;\n\t\t}\n\t\tprintf(\"%d\\n\",(li)res*qpow(calcFact(n+1),MOD-2)%MOD);\n\t}\n\tinline void main()\n\t{\n\t\tsetup(),qcnt=read();\n\t\tfor(register int i=0;i<qcnt;i++)\n\t\t{\n\t\t\tn=read(),m=read(),solve();\n\t\t}\n\t}\n}\nnamespace Subtask4{\n\tll qcnt,n,m,res,cur;\n\tll poly[100][100]={\n\t\t{1},\n\t\t{0,499122177,499122177},\n\t\t{0,582309206,623902721,915057324,873463809},\n\t\t{0,0,873463809,977447596,977447596,519918934,644699478},\n\t\t{0,141417950,107449913,842268673,94451940,544875043,965316154,967049217,330148523},\n\t\t{0,0,353544875,838455934,703623624,535949768,653451447,349558830,851800520,771646351,931434770},\n\t\t{0,550618909,178158888,58789352,129719774,797050168,796364164,791624030,488052236,941404697,659322198,354368080,243993623},\n\t\t{0,0,429799652,399743386,554801643,742853433,722665655,404016728,60088290,522271464,226257407,315863991,413266952,110861881,88731284},\n\t\t{0,70708975,419637300,526847060,645516780,37819976,686120930,268400327,256931840,479065066,996185375,206740503,38492104,987371789,694986290,916901540,754228970},\n\t\t{0,0,817312564,426355808,1832508,826402119,209769896,439803051,551557285,364677809,974827794,179093010,86072836,94912195,751433324,437960094,280979498,724651150,818313884}\n\t};\n\tinline void solve()\n\t{\n\t\tn=readm(),m=read(),res=0,cur=1;\n\t\tfor(register int i=0;i<=(m<<1);i++)\n\t\t{\n\t\t\tres=(res+(li)poly[m][i]*cur%MOD)%MOD,cur=(li)cur*n%MOD;\n\t\t}\n\t\tprintf(\"%d\\n\",res);\n\t}\n\tinline void main()\n\t{\n\t\tqcnt=read();\n\t\tfor(register int i=0;i<qcnt;i++)\n\t\t{\n\t\t\tsolve();\n\t\t}\n\t}\n}\nnamespace Subtask5{\n\tll qcnt,n,m;\n\tll dp[2051][2051];\n\tinline void main()\n\t{\n\t\tdp[0][0]=1;\n\t\tfor(register int i=1;i<=2000;i++)\n\t\t{\n\t\t\tdp[i][0]=1;\n\t\t\tfor(register int j=1;j<=i;j++)\n\t\t\t{\n\t\t\t\tdp[i][j]=(li)(j+1)*dp[i-1][j]%MOD;\n\t\t\t\tdp[i][j]=(dp[i][j]+(li)((i<<1)-1-j)*dp[i-1][j-1]%MOD)%MOD;\n\t\t\t}\n\t\t}\n\t\tqcnt=read();\n\t\tfor(register int i=0;i<qcnt;i++)\n\t\t{\n\t\t\tn=read(),m=read(),printf(\"%d\\n\",dp[n][m]);\n\t\t}\n\t}\n}\nint main()\n{\n\ttaskId=read();\n\tif(taskId==1)\n\t{\n\t\tSubtask1::main();\n\t}\n\tif(taskId==2)\n\t{\n\t\tSubtask2::main();\n\t}\n\tif(taskId==3)\n\t{\n\t\tSubtask3::main();\n\t}\n\tif(taskId==4)\n\t{\n\t\tSubtask4::main();\n\t}\n\tif(taskId==5)\n\t{\n\t\tSubtask5::main();\n\t}\n}\n```",
        "postTime": 1581299946,
        "uid": 60990,
        "name": "Karry5307",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P6073 \u3010[MdOI2020] Epic Convolution\u3011"
    },
    {
        "content": "Epic Convolution\uff01\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/z586y7dg.png?x-oss-process=image/resize,m_lfit,h_200,w_200)\n\n\uff08made by [Loser_King](https://www.luogu.com.cn/user/159686)\uff09\n\n\u5c1d\u8bd5\u5199\u4e00\u7bc7\u4eba\u8bdd\u9898\u89e3\u3002\n\n\u5728\u505a\u8fd9\u9053\u9898\u4e4b\u524d\uff0c\u4f60\u9700\u8981\u4ed4\u7ec6\u9605\u8bfb \u5177\u4f53\u6570\u5b66\uff08Concrete Mathematics\uff09 \u7684 6.2 \u7ae0\u8282\uff0c\u4e0b\u9762\u5217\u51fa\u4e00\u4e9b\u4e4b\u540e\u8981\u7528\u5230\u7684\u4e1c\u897f\uff1a\n$$\nm!\\begin{Bmatrix}n\\\\m\\end{Bmatrix}=\\sum_k k^n\\binom{m}{k}(-1)^{m-k}\n$$\n\n$$\n\\begin{Bmatrix}n\\\\m\\end{Bmatrix}=\\sum_k \\frac{k^n(-1)^{m-k}}{k!(m-k)!}\n$$\n\n$$\n\\left\\langle\\begin{matrix}n\\\\m\\end{matrix}\\right\\rangle=\\sum_{k}\\begin{Bmatrix}n\\\\k\\end{Bmatrix}\\binom{n-k}{m}(-1)^{n-k-m}k!=\\sum_{k=0}^m\\binom{n+1}{k}(m+1-k)^n(-1)^k\n$$\n\n$$\n\\left\\langle\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle\\right\\rangle=(k+1)\\left\\langle\\left\\langle\\begin{matrix}n-1\\\\k\\end{matrix}\\right\\rangle\\right\\rangle+(2n-1-k)\\left\\langle\\left\\langle\\begin{matrix}n-1\\\\k-1\\end{matrix}\\right\\rangle\\right\\rangle\n$$\n\n$$\n\\left\\langle\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle\\right\\rangle=\\sum_{i=0}^k\\binom{2n+1}{i}(-1)^{i}\\begin{Bmatrix}n+k+1-i\\\\k+1-i\\end{Bmatrix}\n$$\n\n\u63a5\u4e0b\u6765\u4f9d\u6b21\u5206\u6790\u5404\u4e2a Subtask\u3002\n\n# Subtask 1\n\n$$\n\\begin{aligned}\nf_n&=\\sum_{k=0}^nk^ng_kh_{n-k}\\\\\n&=\\sum_{k=0}^{m-1}k^n\n\\end{aligned}\n$$\n\n\u7531\u4e8e $n$ \u56fa\u5b9a\uff0c\u9884\u5904\u7406\u5e42\u7684\u524d\u7f00\u548c\u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6\u4e3a $O(n)-O(1)$\u200b\u3002\n\n```cpp\nnamespace Shemesh{\n\tll ans[N];\n    void Metatron(){\n        IO>>n>>q;\n        rep(i,1,n-1)ans[i]=(ans[i-1]+qpow(i,n))%P;\n    }\n\tvoid Shemesh(){\n\t\twhile(q--){\n\t\t\tll m;\n\t\t\tIO>>m;\n\t\t\tIO<<ans[m-1]<<'\\n';\n\t\t}\n\t}\n}// Metatron Shemesh \u7edd\u706d\u5929\u4f7f\u00b7\u65e5\u8f6e\n```\n\n# Subtask 2\n\n$$\nf_n=\\sum_{k=0}^{n}k^n\\frac{1}{(k+m+1)!}\\frac{(-1)^{n-k-m}}{(n-k-m)!}\n$$\n\n\u663e\u7136\u8fd9\u91cc\u53ef\u4ee5\u63d0\u4e00\u4e2a\u7ec4\u5408\u6570\uff0c\u4e24\u8fb9\u4e58\u4ee5 $(n+1)!$ \u53ef\u5f97\n$$\n(n+1)!f_n=\\sum_{k=0}^{n}k^n\\binom{n+1}{k+m+1}(-1)^{n-k-m}\n$$\n\u7136\u540e\u8fd9\u4e2a $k^n$\u200b \u663e\u7136\u8981\u62ff\u53bb\u914d\u65af\u7279\u6797\u6570\uff0c\u6211\u4eec\u89c2\u5bdf\u4e00\u4e0b\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u7136\u540e\u6765\u5c1d\u8bd5\u5f3a\u884c\u51d1\u4e00\u4e2a\u3002\n$$\n\\begin{Bmatrix}n\\\\m\\end{Bmatrix}=\\sum_k \\frac{k^n(-1)^{m-k}}{k!(m-k)!}\n$$\n\u90a3\u4e48\u7ec4\u5408\u6570\u53ef\u4ee5\u4ea7\u751f\u6c42\u548c\u7b26\u53f7\uff0c\u9996\u5148\u53ef\u4ee5\u628a $(-1)^{n-k-m}$ \u62c6\u6210 $(-1)^{n-j-m}(-1)^{j-k}$\uff0c$j$ \u662f\u5916\u5c42\u6c42\u548c\u679a\u4e3e\u7684\u53d8\u91cf\uff0c\u7136\u540e\u6765\u8003\u8651\u5206\u6bcd\u600e\u4e48\u52a8\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u53ef\u4ee5\u628a\u65af\u7279\u6797\u6570\u7684\u5f0f\u5b50\u6539\u4e00\u4e0b\u53d8\u6210\uff1a\n$$\n\\begin{Bmatrix}n\\\\j\\end{Bmatrix}=\\sum_k \\frac{k^n(-1)^{j-k}}{k!(j-k)!}\n$$\n\u90a3\u4e48\u6211\u4eec\u6574\u4e00\u4e2a $\\dbinom{j}{k}$ \u5c31\u53ef\u4ee5\u641e\u51fa\u6765\u4e86\uff0c\u4e0b\u9762\u8003\u8651\u600e\u4e48\u628a $\\dbinom{n+1}{k+m+1}$ \u641e\u6210\u6c42\u548c\u5f62\u5f0f\u3002\n\n\u4e8b\u5b9e\u4e0a\u6839\u636e\u751f\u6210\u51fd\u6570\u5bb9\u6613\u8bc1\u660e\uff1a\n$$\n\\binom{n+1}{k+m+1}=\\sum_{j}\\binom{j}{k}\\binom{n-j}{m}\n$$\n\u7136\u540e\u5e26\u8fdb\u53bb\u5c31\u53ef\u4ee5\u5f97\u5230\u6211\u4eec\u60f3\u8981\u7684\u5f0f\u5b50\uff1a\n$$\n\\begin{aligned}\n\\sum_{k=0}^{n}k^n\\binom{n+1}{k+m+1}(-1)^{n-k-m}&=\\sum_{k=0}^{n}k^n(-1)^{n-k-m}\\sum_{j}\\binom{j}{k}\\binom{n-j}{m}\\\\\n&=\\sum_{j}(-1)^{n-j-m}\\binom{n-j}{m}\\sum_{k=0}^{n}k^n(-1)^{j-k}\\binom{j}{k}\\\\\n&=\\sum_{j}(-1)^{n-j-m}\\binom{n-j}{m}j!\\begin{Bmatrix}n\\\\j\\end{Bmatrix}\n\\end{aligned}\n$$\n\u7136\u540e\u4f60\u5c31\u4f1a\u53d1\u73b0\u548c\u6b27\u62c9\u6570\u7684\u901a\u9879\u4e00\u5b8c\u5168\u4e00\u81f4\uff0c\u7528\u901a\u9879\u4e8c\u5e26\u8fdb\u53bb\u53ef\u5f97\n$$\nf_n=\\frac{1}{(n+1)!}\\sum_{k=0}^m\\binom{n+1}{k}(m+1-k)^n(-1)^k\n$$\n\u9884\u8ba1\u7b97\u5e42\u548c\u9636\u4e58\uff0c\u5355\u6b21 $O(m)$\u200b \u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6 $O(nm)-O(m)$\u3002\n\n```cpp\nnamespace Malakh{\n\tll fac[N],invfac[N],pw[25][N];\n\tvoid Metatron(ll n,ll m){\n\t\tfac[0]=1;\n\t\trep(i,1,n)fac[i]=fac[i-1]*i%P;\n\t\tinvfac[n]=qpow(fac[n],P-2);\n\t\tRep(i,n-1,0)invfac[i]=invfac[i+1]*(i+1)%P;\n\t\trep(i,1,m){\n\t\t\tpw[i][0]=1;\n\t\t\trep(j,1,n)pw[i][j]=pw[i][j-1]*i%P;\n\t\t}\n\t}\n\tll C(ll n,ll m){return fac[n]*invfac[m]%P*invfac[n-m]%P;}\n\tvoid Malakh(){\n\t\tfor(IO>>q;q--;){\n\t\t\tIO>>n>>m;\n\t\t\tll ans=0;\n\t\t\trep(k,0,m){\n\t\t\t\tif(k&1^1)ans=(ans+C(n+1,k)*pw[m+1-k][n]%P)%P;\n\t\t\t\telse ans=(ans+(P-C(n+1,k))*pw[m+1-k][n]%P)%P;\n\t\t\t}\n\t\t\tIO<<ans*invfac[n+1]%P<<'\\n';\n\t\t}\n\t}\n}//Metatron Mal'akh \u7edd\u706d\u5929\u4f7f\u00b7\u5929\u7ffc\n```\n\n# Subtask 5\n\n\u56e0\u4e3a sub3 \u548c sub4 \u6709\u70b9\u6bc1\u5929\u706d\u5730\uff0c\u6240\u4ee5\u5148\u6765\u8bb2 Sub5 \u4e86\u3002\n\n\u9996\u5148\u51fa\u9898\u4eba\u663e\u7136\u628a\u8fd9\u73a9\u610f\u7684 $k+1$ \u6b21\u5e42\u5f3a\u884c\u62c6\u5f00\u4e86\uff0c\u73b0\u5728\u6211\u4eec\u628a\u5b83\u5408\u8d77\u6765\uff0c\u987a\u4fbf\u628a $k+1$ \u8f6c\u5316\u6210 $k$\u3002\n$$\n\\begin{aligned}\nAns&=\\sum_{k=0}^{m}\\sum_{i=0}^{m-k}\\frac{\\dbinom{2n+1}{i}(-1)^{m-k}(k+1)^{m+n+1-i}}{(m-k-i)!(k+1)!}\\\\\n&=\\sum_{k=1}^{m+1}\\sum_{i=0}^{m-k+1}\\frac{\\dbinom{2n+1}{i}(-1)^{m-k}k^{m+n+1-i}}{(m-k+1-i)!k!}\\\\\n\\end{aligned}\n$$\n\u7ee7\u7eed\u8003\u8651\u600e\u4e48\u5316\u51fa\u65af\u7279\u6797\u6570\u3002\n\n\u9996\u5148\u89c2\u6d4b\u5230 $k=0$ \u65f6\uff0c\u540e\u9762\u7684\u5f0f\u5b50\u4e5f\u662f $0$\u200b\uff0c\u6240\u4ee5\u53ef\u4ee5\u628a $k=0$ \u6254\u8fdb\u6765\u3002\n\n\u5929\u7136\u7684 $\\dfrac{k^{m+n+1-i}}{(m-k+1-i)!k!}$\u200b\u200b\u200b\u200b \u80af\u5b9a\u4e0d\u8981\u52a8\uff0c\u90a3\u4e48 $i$\u200b\u200b\u200b\u200b\u200b\u200b \u662f\u56fa\u5b9a\u7684\uff0c\u8003\u8651\u5176\u4f59\u600e\u4e48\u914d\u3002\n\n\u4ee3\u5165\u65af\u7279\u6797\u6570\u7684\u901a\u9879\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff1a\n$$\n\\begin{Bmatrix}m+n+1-i\\\\m+1-i\\end{Bmatrix}=\\sum_k \\frac{k^{m+n+1-i}(-1)^{m+1-k-i}}{k!(m-k+1-i)!}\n$$\n\u76f4\u63a5\u62c6 $(-1)^{m-k}$ \u4e3a $(-1)^{m+1-k-i}(-1)^{i-1}$ \u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u4e8e\u662f\u539f\u5f0f\u5316\u4e3a\n$$\n\\begin{aligned}\nAns&=\\sum_{k=0}^{m+1}\\sum_{i=0}^{m-k+1}\\frac{\\dbinom{2n+1}{i}(-1)^{m-k}k^{m+n+1-i}}{(m-k+1-i)!k!}\\\\\n&=\\sum_{i=0}^{m}\\sum_{k=0}^{m-i+1}\\frac{\\dbinom{2n+1}{i}(-1)^{m-k}k^{m+n+1-i}}{(m-k+1-i)!k!}\\\\\n&=\\sum_{i=0}^{m}\\dbinom{2n+1}{i}(-1)^{i-1}\\sum_{k=0}^{m-i+1}\\frac{(-1)^{m+1-k-i}k^{m+n+1-i}}{(m-k+1-i)!k!}\\\\\n&=\\sum_{i=0}^{m}\\dbinom{2n+1}{i}(-1)^{i-1}\\begin{Bmatrix}n+k+1-i\\\\k+1-i\\end{Bmatrix}\n\\end{aligned}\n$$\n\u6ce8\u610f\u5230\u8fd9\u6b63\u597d\u662f\u4e8c\u9636\u6b27\u62c9\u6570\u7684\u901a\u9879\uff0c\u800c\u6ce8\u610f\u5230\u6570\u636e\u8303\u56f4\u53ea\u6709 $2000$\uff0c\u6240\u4ee5\u53ef\u4ee5\u901a\u8fc7\u9012\u5f52\u5f0f $n^2$ dp \u6c42\u5f97\u3002\n\n\u590d\u6742\u5ea6\u4e3a $O(n^2)-O(1)$ \u7684\u3002\n\n```cpp\nnamespace Satan{\n\tll Euler[2005][2005];\n\tvoid Devil(ll n){\n\t\trep(i,0,n)Euler[i][0]=1;\n\t\trep(i,1,n)rep(j,1,i)Euler[i][j]=((j+1)*Euler[i-1][j]%P+(2*i-1-j)*Euler[i-1][j-1])%P;\n\t}\n\tvoid Satan(){\n\t\tfor(IO>>q;q--;){\n\t\t\tIO>>n>>m;\n\t\t\tIO<<Euler[n][m]<<'\\n';\n\t\t}\n\t}\n}//Satan \u53cd\u8f6c\u4f53 \u6551\u4e16\u9b54\u738b\n```\n\n# Subtask 3\n\n\u76f8\u6bd4 Subtask 2 \u800c\u8a00\uff0c\u6570\u636e\u8303\u56f4\u4e0a\u5347\u5230\u4e86 $998244352$\u200b\u200b\uff0c\u8003\u8651\u600e\u4e48\u4f18\u5316\u9884\u5904\u7406\u3002\n\n\u5feb\u901f\u9636\u4e58\u7b97\u6cd5\u6211\u4e0d\u4f1a\uff0c\u6240\u4ee5\u4e0a\u5206\u5757\u6253\u8868\u3002\n\n\u8fd9\u91cc\u5757\u957f\u76f4\u63a5\u8bbe $10^6$\u200b\uff0c\u8fd9\u6837\u6570\u7ec4\u957f\u5ea6\u53ea\u6709 $1000$\u200b\u3002\n\n\u4e3a\u4e86\u9632\u6b62\u5feb\u901f\u5e42\u88ab\u5361\uff0c\u6240\u4ee5\u4e0a\u5149\u901f\u5e42\uff0c\u5757\u957f\u8bbe $32768$\u200b \u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u7136\u540e\u8fd9\u4e2a sub \u5c31\u6ca1\u4e86\u3002\n\n```cpp\nconst ll prefac[]={\u55b5\u55b5\u55b5\u55b5\u55b5\u55b5\u55b5\u55b5\u55b5};\nll calcfac(ll n){\n\tll ret=prefac[n/B];\n\trep(i,n/B*B+1,n)ret=ret*i%P;\n\treturn ret;\n}\nnamespace Kadour{\n\tconst ll bl=32768;\n\tll pw1[25][32800],inv[25],pw2[25][32800];\n\tvoid Metatron(ll m){\n\t\trep(i,1,m){\n\t\t\tpw1[i][0]=1;\n\t\t\trep(j,1,bl)pw1[i][j]=pw1[i][j-1]*i%P;\n\t\t\tpw2[i][0]=1;\n\t\t\trep(j,1,bl)pw2[i][j]=pw2[i][j-1]*pw1[i][bl]%P;\n\t\t}\n\t\tinv[0]=inv[1]=1;\n\t\trep(i,2,m)inv[i]=(P-P/i)*inv[P%i]%P;\n\t}\n\tll pw(ll n,ll m){\n\t\treturn pw2[n][m>>15]*pw1[n][m&(bl-1)]%P;\n\t}\n\tvoid Kadour(){\n\t\tfor(IO>>q;q--;){\n\t\t\tIO>>n>>m;\n\t\t\tll ans=0,binom=1;\n\t\t\trep(k,0,m){\n\t\t\t\tif(k&1^1)ans=(ans+binom*pw(m+1-k,n)%P)%P;\n\t\t\t\telse ans=(ans-binom*pw(m+1-k,n)%P+P)%P;\n\t\t\t\tbinom=binom*(n+1-k)%P*inv[k+1]%P;\n\t\t\t}\n\t\t\tIO<<ans*qpow(calcfac(n+1),P-2)%P<<'\\n';\n\t\t}\n\t}\n}//Metatron Kadour \u7edd\u706d\u5929\u4f7f\u00b7\u5149\u5251\n```\n\n# Subtask 4\n\n$$\nf_n=\\sum_{k=0}^{n}k^n\\frac{k^m}{k!}\\frac{(-1)^{n-k}}{(n-k)!}\n$$\n\n\u5c0f Q \u5bf9\u5c0f K \u8bf4\uff1a\u4f60\u8fd9\u4e2a\u83dc\u9e21\uff0c\u8fd9\u4e0d\u663e\u7136\u7684\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u5417\uff0c\u4f60\u65af\u7279\u6797\u6570\u600e\u4e48\u5b66\u7684\u4e86\u3002\n\n\u7136\u540e\u4ed6\u4ed4\u7ec6\u770b\u4e86\u4e00\u904d\uff0c\n$$\nn\\le 10^{10^5},m\\le 10\n$$\n\u50bb\u773c\u4e86\uff0c\u53d1\u73b0\u4ed6\u4e0d\u4f1a\u8fd9\u9053\u9898\u3002\n\n\u5bb9\u6613\u77e5\u9053\u8fd9\u9053\u9898\u8981\u6c42\u7684\u5c31\u662f\n$$\n\\begin{Bmatrix}n+m\\\\n\\end{Bmatrix}\n$$\n\u7136\u540e\u6839\u636e\u5177\u4f53\u6570\u5b66\uff1a\n$$\n\\begin{Bmatrix}n+m\\\\n\\end{Bmatrix}=\\sum_{k=0}^{m}\\left\\langle\\left\\langle\\begin{matrix}m\\\\k\\end{matrix}\\right\\rangle\\right\\rangle \\binom{n+2m-k}{2m}\n$$\n\u90a3\u4e48 $O(m^2)$\u200b \u9884\u5904\u7406\u4e8c\u9636\u6b27\u62c9\u6570\uff0c\u7136\u540e\u7528\u7c7b\u4f3c Subtask 3 \u7684\u505a\u6cd5\u5904\u7406\u7ec4\u5408\u6570\uff0c\u6bcf\u6b21\u53d8\u5316\u90fd\u662f $O(1)$ \u7684\u3002\n\n\u4f46\u662f\u8fd9\u91cc\u8981\u6c42\u7684\u9006\u5143\u90fd\u5f88\u5927\uff0c\u600e\u4e48\u529e\u5462\uff1f\u8003\u8651\u8fdb\u884c\u6570\u636e\u5206\u6cbb\uff0c\u5bf9 $31\\sim 40$ \u7684\u6570\u636e\u9884\u5904\u7406\u9006\u5143\uff0c\u5bf9 $41\\sim 50$ \u7684\u6570\u636e $O(\\log P)$\u200b\u200b \u8ba1\u7b97\u3002\u8fd9\u6837 $31\\sim 40$ \u7684\u590d\u6742\u5ea6\u662f $O(m^2+n)-O(m)$ \u7684\uff0c\u800c $41\\sim 50$ \u7684\u590d\u6742\u5ea6\u662f $O(m^2)-O(m\\log P)$ \u7684\uff0c\u5747\u53ef\u901a\u8fc7\u3002\n\n```cpp\nnamespace Artelif{\n\tll inv[N<<1],Euler[15][15],ma;\n\tvoid Metatron(ll n,ll m){\n\t\tma=n;\n\t\tinv[0]=inv[1]=1;\n\t\trep(i,2,n)inv[i]=(P-P/i)*inv[P%i]%P;\n\t\trep(i,0,m)Euler[i][0]=1;\n\t\trep(i,1,m)rep(j,1,i)Euler[i][j]=((j+1)*Euler[i-1][j]%P+(2*i-1-j)*Euler[i-1][j-1])%P;\n\t}\n\tll calcinv(ll n){\n\t\treturn n<=ma?inv[n]:qpow(n,P-2);\n\t}\n\tvoid Artelif(){\n\t\tfor(IO>>q;q--;){\n\t\t\tIO.read(n,P);\n\t\t\tIO>>m;\n\t\t\tll binom=1,ans=0;\n\t\t\trep(i,n,n+2*m-1)binom=binom*i%P*calcinv(i-n+1)%P;\n\t\t\trep(i,0,m){\n\t\t\t\tans=(ans+binom*Euler[m][i]%P)%P;\n\t\t\t\tbinom=binom*calcinv(n+2*m-1-i)%P*(n-i-1)%P;\n\t\t\t}\n\t\t\tIO<<ans<<'\\n';\n\t\t}\n\t}\n}//Metatron Artelif \u7edd\u706d\u5929\u4f7f\u00b7\u70ae\u51a0\n```\n\n\u4e0b\u9762\u662f\u5b8c\u6574\u4ee3\u7801\u3002\n\n```cpp\n// Problem: P6073 \u300eMdOI R1\u300fEpic Convolution\n// Contest: Luogu\n// URL: https://www.luogu.com.cn/problem/P6073\n// Memory Limit: 500 MB\n// Time Limit: 400 ms\n// \n// Powered by CP Editor (https://cpeditor.org)\n\n#include<bits/stdc++.h>\n#define endl '\\n' \n#define rep(i,a,b) for(ll i=(a);i<=(b);++i)\n#define Rep(i,a,b) for(ll i=(a);i>=(b);--i)\nusing namespace std;\ntypedef long long ll;\ninline void chkmax(ll &x,ll y){if(x<y)x=y;}\ninline void chkmin(ll &x,ll y){if(x>y)x=y;}\nstruct IO_Tp {\n    const static int _I_Buffer_Size = 2 << 22;\n    char _I_Buffer[_I_Buffer_Size], *_I_pos = _I_Buffer;\n\n    const static int _O_Buffer_Size = 2 << 22;\n    char _O_Buffer[_O_Buffer_Size], *_O_pos = _O_Buffer;\n\n    IO_Tp() { fread(_I_Buffer, 1, _I_Buffer_Size, stdin); }\n    ~IO_Tp() { fwrite(_O_Buffer, 1, _O_pos - _O_Buffer, stdout); }\n\n\tvoid read(ll &res,ll mod){\n\t\tll f=1;\n        while (!isdigit(*_I_pos)&&(*_I_pos)!='-') ++_I_pos;\n        if(*_I_pos=='-')f=-1,++_I_pos;\n        res = *_I_pos++ - '0';\n        while (isdigit(*_I_pos)) res = (res * 10 + (*_I_pos++ - '0') ) % mod;\n        res*=f;\n\t}\n\n    IO_Tp &operator>>(ll &res) {\n    \tll f=1;\n        while (!isdigit(*_I_pos)&&(*_I_pos)!='-') ++_I_pos;\n        if(*_I_pos=='-')f=-1,++_I_pos;\n        res = *_I_pos++ - '0';\n        while (isdigit(*_I_pos)) res = res * 10 + (*_I_pos++ - '0');\n        res*=f;\n        return *this;\n    }\n\n    IO_Tp &operator<<(ll n) {\n    \tif(n<0)*_O_pos++='-',n=-n;\n        static char _buf[10];\n        char *_pos = _buf;\n        do\n            *_pos++ = '0' + n % 10;\n        while (n /= 10);\n        while (_pos != _buf) *_O_pos++ = *--_pos;\n        return *this;\n    }\n\n    IO_Tp &operator<<(char ch) {\n        *_O_pos++ = ch;\n        return *this;\n    }\n} IO;\ntypedef vector<int> vec;\nconst int N=2e5+5,P=998244353,B=1e6;\nll op,q,n,m;\nconst ll prefac[]={1,373341033,45596018,834980587,623627864,428937595,442819817,499710224,833655840,83857087,295201906,788488293,671639287,849315549,597398273,813259672,732727656,244038325,122642896,310517972,160030060,483239722,683879839,712910418,384710263,433880730,844360005,513089677,101492974,959253371,957629942,678615452,34035221,56734233,524027922,31729117,102311167,330331487,8332991,832392662,545208507,594075875,318497156,859275605,300738984,767818091,864118508,878131539,316588744,812496962,213689172,584871249,980836133,54096741,417876813,363266670,335481797,730839588,393495668,435793297,760025067,811438469,720976283,650770098,586537547,117371703,566486504,749562308,708205284,932912293,939830261,983699513,206579820,301188781,593164676,770845925,247687458,41047791,266419267,937835947,506268060,6177705,936268003,166873118,443834893,328979964,470135404,954410105,117565665,832761782,39806322,478922755,394880724,821825588,468705875,512554988,232240472,876497899,356048018,895187265,808258749,575505950,68190615,939065335,552199946,694814243,385460530,529769387,640377761,916128300,440133909,362216114,826373774,502324157,457648395,385510728,904737188,78988746,454565719,623828097,686156489,713476044,63602402,570334625,681055904,222059821,477211096,343363294,833792655,461853093,741797144,74731896,930484262,268372735,941222802,677432735,474842829,700451655,400176109,697644778,390377694,790010794,360642718,505712943,946647976,339045014,715797300,251680896,70091750,40517433,12629586,850635539,110877109,571935891,695965747,634938288,69072133,155093216,749696762,963086402,544711799,724471925,334646013,574791029,722417626,377929821,743946412,988034679,405207112,18063742,104121967,638607426,607304611,751377777,35834555,313632531,18058363,656121134,40763559,562910912,495867250,48767038,210864657,659137294,715390025,865854329,324322857,388911184,286059202,636456178,421290700,832276048,726437551,526417714,252522639,386147469,674313019,274769381,226519400,272047186,117153405,712896591,486826649,119444874,338909703,18536028,41814114,245606459,140617938,250512392,57084755,157807456,261113192,40258068,194807105,325341339,884328111,896332013,880836012,737358206,202713771,785454372,399586250,485457499,640827004,546969497,749602473,159788463,159111724,218592929,675932866,314795475,811539323,246883213,696818315,759880589,4302336,353070689,477909706,559289160,79781699,878094972,840903973,367416824,973366814,848259019,462421750,667227759,897917455,81800722,956276337,942686845,420541799,417005912,272641764,941778993,217214373,192220616,267901132,50530621,652678397,354880856,164289049,781023184,105376215,315094878,607856504,733905911,457743498,992735713,35212756,231822660,276036750,734558079,424180850,433186147,308380947,18333316,12935086,351491725,655645460,535812389,521902115,67016984,48682076,64748124,489360447,361275315,786336279,805161272,468129309,645091350,887284732,913004502,358814684,281295633,328970139,395955130,164840186,820902807,761699708,246274415,592331769,913846362,866682684,600130702,903837674,529462989,90612675,526540127,533047427,110008879,674279751,801920753,645226926,676886948,752481486,474034007,457790341,166813684,287671032,188118664,244731384,404032157,269766986,423996017,182948540,356801634,737863144,652014069,206068022,504569410,919894484,593398649,963768176,882517476,702523597,949028249,128957299,171997372,50865043,20937461,690959202,581356488,369182214,993580422,193500140,540665426,365786018,743731625,144980423,979536721,773259009,617053935,247670131,843705280,30419459,985463402,261585206,237885042,111276893,488166208,137660292,720784236,244467770,26368504,792857103,666885724,670313309,905683034,259415897,512017253,826265493,111960112,633652060,918048438,516432938,386972415,996212724,610073831,444094191,72480267,665038087,11584804,301029012,723617861,113763819,778259899,937766095,535448641,593907889,783573565,673298635,599533244,655712590,173350007,868198597,169013813,585161712,697502214,573994984,285943986,675831407,3134056,965907646,401920943,665949756,236277883,612745912,813282113,892454686,901222267,624900982,927122298,686321335,84924870,927606072,506664166,353631992,165913238,566073550,816674343,864877926,171259407,908752311,874007723,803597299,613676466,880336545,282280109,128761001,58852065,474075900,434816091,364856903,149123648,388854780,314693916,423183826,419733481,888483202,238933227,336564048,757103493,100189123,855479832,51370348,403061033,496971759,831753030,251718753,272779384,683379259,488844621,881783783,659478190,445719559,740782647,546525906,985524427,548033568,333772553,331916427,752533273,730387628,93829695,655989476,930661318,334885743,466041862,428105027,888238707,232218076,769865249,730641039,616996159,231721356,326973501,426068899,722403656,742756734,663270261,364187931,350431704,671823672,633125919,226166717,386814657,237594135,451479365,546182474,119366536,465211069,605313606,728508871,249619035,663053607,900453742,48293872,229958401,62402409,69570431,71921532,960467929,537087913,514588945,513856225,415497414,286592050,645469437,102052166,163298189,873938719,617583886,986843080,962390239,580971332,665147020,88900164,89866970,826426395,616059995,443012312,659160562,229855967,687413213,59809521,398599610,325666688,154765991,159186619,210830877,386454418,84493735,974220646,820097297,2191828,481459931,729073424,551556379,926316039,151357011,808637654,218058015,786112034,850407126,84202800,94214098,30019651,121701603,176055335,865461951,553631971,286620803,984061713,888573766,302767023,977070668,110954576,83922475,51568171,60949367,19533020,510592752,615419476,341370469,912573425,286207526,206707897,384156962,414163604,193301813,749570167,366933789,11470970,600191572,391667731,328736286,30645366,215162519,604947226,236199953,718439098,411423177,803407599,632441623,766760224,263006576,757681534,61082578,681666415,947466395,12206799,659767098,933746852,978860867,59215985,161179205,439197472,259779111,511621808,145770512,882749888,943124465,872053396,631078482,166861622,743415395,772287179,602427948,924112080,385643091,794973480,883782693,869723371,805963889,313106351,262132854,400034567,488248149,265769800,791715397,408753255,468381897,415812467,172922144,64404368,281500398,512318142,288791777,955559118,242484726,536413695,205340854,707803527,576699812,218525078,875554190,46283078,833841915,763148293,807722138,788080170,556901372,150896699,253151120,97856807,918256774,771557187,582547026,472709375,911615063,743371401,641382840,446540967,184639537,157247760,775930891,939702814,499082462,19536133,548753627,593243221,563850263,185475971,687419227,396799323,657976136,864535682,433009242,860830935,33107339,517661450,467651311,812398757,202133852,431839017,709549400,99643620,773282878,290471030,61134552,129206504,929147251,837008968,422332597,353775281,469563025,62265336,835064501,851685235,21197005,264793769,326416680,118842991,84257200,763248924,687559609,150907932,401832452,242726978,766752066,959173604,390269102,992293822,744816299,476631694,177284763,702429415,374065901,169855231,629007616,719169602,564737074,475119050,714502830,40993711,820235888,749063595,239329111,612759169,18591377,419142436,442202439,941600951,158013406,637073231,471564060,447222237,701248503,599797734,577221870,69656699,51052704,6544303,10958310,554955500,943192237,192526269,897983911,961628039,240232720,627280533,710239542,70255649,261743865,228474833,776408079,304180483,63607040,953297493,758058902,395529997,156010331,825833840,539880795,234683685,52626619,751843490,116909119,62806842,574857555,353417551,40061330,822203768,681051568,490913702,9322961,766631257,124794668,37844313,163524507,729108319,490867505,47035168,682765157,53842115,817965276,757179922,339238384,909741023,150530547,158444563,140949492,993302799,551621442,137578883,475122706,443869843,605400098,689361523,769596520,801661499,474900284,586624857,349960501,134084537,650564083,877097974,379857427,887890124,159436401,133274277,986182139,729720334,568925901,459461496,499309445,493171177,460958750,380694152,168836226,840160881,141116880,225064950,109618190,842341383,85305729,759273275,97369807,669317759,766247510,829017039,550323884,261274540,918239352,29606025,870793828,293683814,378510746,367270918,481292028,813097823,798448487,230791733,899305835,504040630,162510533,479367951,275282274,806951470,462774647,56473153,184659008,905122161,664034750,109726629,59372704,325795100,486860143,843736533,924723613,880348000,801252478,616515290,776142608,284803450,583439582,274826676,6018349,377403437,244041569,527081707,544763288,708818585,354033051,904309832,589922898,673933870,682858433,945260111,899893421,515264973,911685911,9527148,239480646,524126897,48259065,578214879,118677219,786127243,869205770,923276513,937928886,802186160,12198440,638784295,34200904,758925811,185027790,80918046,120604699,610456697,573601211,208296321,49743354,653691911,490750754,674335312,887877110,875880304,308360096,414636410,886100267,8525751,636257427,558338775,500159951,696213291,97268896,364983542,937928436,641582714,586211304,345265657,994704486,443549763,207259440,302122082,166055224,623250998,239642551,476337075,283167364,211328914,68064804,950202136,187552679,18938709,646784245,598764068,538505481,610424991,864445053,390248689,278395191,686098470,935957187,868529577,329970687,804930040,84992079,474569269,810762228,573258936,756464212,155080225,286966169,283614605,19283401,24257676,871831819,612689791,846988741,617120754,971716517,979541482,297910784,991087897,783825907,214821357,689498189,405026419,946731704,609346370,707669156,457703127,957341187,980735523,649367684,791011898,82098966,234729712,105002711,130614285,291032164,193188049,363211260,58108651,100756444,954947696,346032213,863300806,36876722,622610957,289232396,667938985,734886266,395881057,417188702,183092975,887586469,83334648,797819763,100176902,781587414,841864935,371674670,18247584};\nll qpow(ll a,ll b){return !b?1:qpow(a*a%P,b>>1)*(b&1?a:1)%P;}\n////////////////////////Subtask 1///////////////////\nnamespace Shemesh{\n\tll ans[N];\n    void Metatron(){\n        IO>>n>>q;\n        rep(i,1,n-1)ans[i]=(ans[i-1]+qpow(i,n))%P;\n    }\n\tvoid Shemesh(){\n\t\twhile(q--){\n\t\t\tll m;\n\t\t\tIO>>m;\n\t\t\tIO<<ans[m-1]<<'\\n';\n\t\t}\n\t}\n}// Metatron Shemesh \u7edd\u706d\u5929\u4f7f\u00b7\u65e5\u8f6e\n////////////////////////Subtask 2///////////////////\nnamespace Malakh{\n\tll fac[N],invfac[N],pw[25][N];\n\tvoid Metatron(ll n,ll m){\n\t\tfac[0]=1;\n\t\trep(i,1,n)fac[i]=fac[i-1]*i%P;\n\t\tinvfac[n]=qpow(fac[n],P-2);\n\t\tRep(i,n-1,0)invfac[i]=invfac[i+1]*(i+1)%P;\n\t\trep(i,1,m){\n\t\t\tpw[i][0]=1;\n\t\t\trep(j,1,n)pw[i][j]=pw[i][j-1]*i%P;\n\t\t}\n\t}\n\tll C(ll n,ll m){return fac[n]*invfac[m]%P*invfac[n-m]%P;}\n\tvoid Malakh(){\n\t\tfor(IO>>q;q--;){\n\t\t\tIO>>n>>m;\n\t\t\tll ans=0;\n\t\t\trep(k,0,m){\n\t\t\t\tif(k&1^1)ans=(ans+C(n+1,k)*pw[m+1-k][n]%P)%P;\n\t\t\t\telse ans=(ans+(P-C(n+1,k))*pw[m+1-k][n]%P)%P;\n\t\t\t}\n\t\t\tIO<<ans*invfac[n+1]%P<<'\\n';\n\t\t}\n\t}\n}//Metatron Mal'akh \u7edd\u706d\u5929\u4f7f\u00b7\u5929\u7ffc\n////////////////////////Subtask 3///////////////////\nll calcfac(ll n){\n\tll ret=prefac[n/B];\n\trep(i,n/B*B+1,n)ret=ret*i%P;\n\treturn ret;\n}\nnamespace Kadour{\n\tconst ll bl=32768;\n\tll pw1[25][32800],inv[25],pw2[25][32800];\n\tvoid Metatron(ll m){\n\t\trep(i,1,m){\n\t\t\tpw1[i][0]=1;\n\t\t\trep(j,1,bl)pw1[i][j]=pw1[i][j-1]*i%P;\n\t\t\tpw2[i][0]=1;\n\t\t\trep(j,1,bl)pw2[i][j]=pw2[i][j-1]*pw1[i][bl]%P;\n\t\t}\n\t\tinv[0]=inv[1]=1;\n\t\trep(i,2,m)inv[i]=(P-P/i)*inv[P%i]%P;\n\t}\n\tll pw(ll n,ll m){\n\t\treturn pw2[n][m>>15]*pw1[n][m&(bl-1)]%P;\n\t}\n\tvoid Kadour(){\n\t\tfor(IO>>q;q--;){\n\t\t\tIO>>n>>m;\n\t\t\tll ans=0,binom=1;\n\t\t\trep(k,0,m){\n\t\t\t\tif(k&1^1)ans=(ans+binom*pw(m+1-k,n)%P)%P;\n\t\t\t\telse ans=(ans-binom*pw(m+1-k,n)%P+P)%P;\n\t\t\t\tbinom=binom*(n+1-k)%P*inv[k+1]%P;\n\t\t\t}\n\t\t\tIO<<ans*qpow(calcfac(n+1),P-2)%P<<'\\n';\n\t\t}\n\t}\n}//Metatron Kadour \u7edd\u706d\u5929\u4f7f\u00b7\u5149\u5251\n////////////////////////Subtask 4///////////////////\nnamespace Artelif{\n\tll inv[N<<1],Euler[15][15],ma;\n\tvoid Metatron(ll n,ll m){\n\t\tma=n;\n\t\tinv[0]=inv[1]=1;\n\t\trep(i,2,n)inv[i]=(P-P/i)*inv[P%i]%P;\n\t\trep(i,0,m)Euler[i][0]=1;\n\t\trep(i,1,m)rep(j,1,i)Euler[i][j]=((j+1)*Euler[i-1][j]%P+(2*i-1-j)*Euler[i-1][j-1])%P;\n\t}\n\tll calcinv(ll n){\n\t\treturn n<=ma?inv[n]:qpow(n,P-2);\n\t}\n\tvoid Artelif(){\n\t\tfor(IO>>q;q--;){\n\t\t\tIO.read(n,P);\n\t\t\tIO>>m;\n\t\t\tll binom=1,ans=0;\n\t\t\trep(i,n,n+2*m-1)binom=binom*i%P*calcinv(i-n+1)%P;\n\t\t\trep(i,0,m){\n\t\t\t\tans=(ans+binom*Euler[m][i]%P)%P;\n\t\t\t\tbinom=binom*calcinv(n+2*m-1-i)%P*(n-i-1)%P;\n\t\t\t}\n\t\t\tIO<<ans<<'\\n';\n\t\t}\n\t}\n}//Metatron Artelif \u7edd\u706d\u5929\u4f7f\u00b7\u70ae\u51a0\n////////////////////////Subtask 5///////////////////\nnamespace Satan{\n\tll Euler[2005][2005];\n\tvoid Devil(ll n){\n\t\trep(i,0,n)Euler[i][0]=1;\n\t\trep(i,1,n)rep(j,1,i)Euler[i][j]=((j+1)*Euler[i-1][j]%P+(2*i-1-j)*Euler[i-1][j-1])%P;\n\t}\n\tvoid Satan(){\n\t\tfor(IO>>q;q--;){\n\t\t\tIO>>n>>m;\n\t\t\tIO<<Euler[n][m]<<'\\n';\n\t\t}\n\t}\n}//Satan \u53cd\u8f6c\u4f53 \u6551\u4e16\u9b54\u738b\nint main(){\n\tIO>>op;\n\tif(op==1)Shemesh::Metatron(),Shemesh::Shemesh();\n\telse if(op==2)Malakh::Metatron(2e5+1,21),Malakh::Malakh();\n\telse if(op==3)Kadour::Metatron(21),Kadour::Kadour();\n\telse if(op==4)Artelif::Metatron(2e5+100,10),Artelif::Artelif();\n\telse if(op==5)Satan::Devil(2000),Satan::Satan();\n\treturn 0;\n}\n```\n\n\u5b8c\u7ed3\u6492\u6298\u7eb8\uff01",
        "postTime": 1633573262,
        "uid": 121027,
        "name": "Spasmodic",
        "ccfLevel": 7,
        "title": "Epic Convolution"
    }
]
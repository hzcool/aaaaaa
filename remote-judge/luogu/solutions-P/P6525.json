[
    {
        "content": "> [\u9898\u9762\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P6525)\u3002\n\n> \u9898\u610f\u7b80\u8ff0\uff1a\u4ece\u7ed9\u51fa\u7684 $n$ \u4e2a\u6570\u4e2d\u9009\u51fa\u82e5\u5e72\u4e2a\u6570 $b_1,b_2,\\cdots,b_m$\uff0c\u5176\u5206\u503c\u4e3a $m\\times \\max b_i$\u3002\u6c42\u6240\u6709\u6ee1\u8db3\u5b58\u5728 $i,j,k$ \u4f7f\u5f97 $b_i,b_j,b_k$ \u80fd\u7ec4\u6210\u4e00\u4e2a\u4e09\u89d2\u5f62\u7684\u65b9\u6848\u7684\u5206\u503c\u4e4b\u548c\u3002\n\n\u9898\u76ee\u8fd8\u662f\u633a\u4e0d\u9519\u7684\uff0c\u5982\u679c\u6a21\u6570\u662f\u8d28\u6570 / \u4e0d\u5361\u7a7a\u95f4\u5c31\u66f4\u68d2\u4e86\u3002\n\n---\n\n\u6b63\u7740\u7b97\u4e0d\u65b9\u4fbf\uff0c\u8003\u8651\u7528\u6240\u6709\u65b9\u6848\u51cf\u53bb\u4e0d\u6ee1\u8db3\u7684\u65b9\u6848\u3002\n\n\u9996\u5148\u5c06\u7ed9\u5b9a\u7684\u6570\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u7136\u540e\u4ece\u5de6\u5f80\u53f3 DP\uff1a\u8bbe $l_{i,j},c_{i,j}$ \u5206\u522b\u4e3a\u5012\u6570\u7b2c\u4e8c\u4e2a\u6570\u662f $a_i$\uff0c\u5012\u6570\u7b2c\u4e00\u4e2a\u6570\u662f $a_j$ \u4e14\u4e0d\u80fd\u6784\u6210\u4e09\u89d2\u5f62\u7684\u65b9\u6848**\u957f\u5ea6\u4e4b\u548c / \u4e2a\u6570**\u3002\n\n\u8003\u8651\u4e00\u4e2a\u72b6\u6001\u80fd\u6269\u5c55\u5230\u54ea\u4e9b\u72b6\u6001\uff0c\u663e\u7136\u6709\uff1a\n\n$$(i,j)\\to (j,p)\\quad(a_i+a_j\\leq a_p)$$\n\n\u5373 $l_{j,p}\\gets l_{j,p}+l_{i,j}+c_{i,j},\\ c_{j,p}\\gets c_{j,p}+c_{i,j}\\quad(a_i+a_j\\leq a_p)$\u3002\n\n\u521d\u503c\uff1a$l_{0,i}=c_{0,i}=1$\u3002\u76ee\u6807\uff1a$\\sum a_j\\times l_{i,j}$\u3002\n\n\u76f4\u63a5\u4e09\u91cd\u5faa\u73af\u679a\u4e3e\u663e\u7136\u4e0d\u884c\uff0c\u63a5\u4e0b\u6765\u662f\u4e00\u4e9b\u4f18\u5316\uff1a\n\n- **\u6bcf\u4e00\u6b21\u5185\u5c42\u5faa\u73af** $j$ \u7684\u65f6\u5019\uff0c\u51b3\u7b56 $p$ \u662f\u5355\u8c03\u7684\uff0c\u53ef\u4ee5\u7528\u4e00\u4e2a\u53d8\u91cf\u7ef4\u62a4\uff0c\u5747\u644a\u590d\u6742\u5ea6 $O(n)$\u3002\n- \u53ef\u4ee5\u53d1\u73b0\u6bcf\u6b21\u8f6c\u79fb\u7684\u662f\u4e00\u6bb5\u533a\u95f4\uff08\u51c6\u786e\u6765\u8bf4\u662f $a$ \u7684\u4e00\u4e2a\u540e\u7f00\uff09\uff0c\u7528~~\u6811\u72b6\u6570\u7ec4~~\u524d\u7f00\u548c\u7ef4\u62a4\u5373\u53ef\u505a\u5230 $O(1)$ \u8f6c\u79fb\u3002\n\n\u6613\u77e5\u6240\u6709\u65b9\u6848\u5206\u503c\u4e4b\u548c\u4e3a\uff1a$\\sum_{i=1}^{i\\leq n}\\sum_{j=1}^{j\\leq i}a_i\\times j\\times \\binom{i-1}{j-1}$\uff0c\u5176\u4e2d $i$ \u8868\u793a\u5012\u6570\u7b2c\u4e00\u4e2a\u6570\u4e3a $a_i$\uff0c$j$ \u8868\u793a\u9009\u51fa\u7684\u6570\u7684\u4e2a\u6570\u4e3a $j$\u3002\n\n\u56e0\u4e3a\u672c\u9898\u6a21\u6570\u4e0d\u662f\u8d28\u6570\uff08\u6bd2\u7624\uff09\uff0c\u6240\u4ee5\u9700\u8981\u65f6\u7a7a $O(n^2)$ \u9884\u5904\u7406\u7ec4\u5408\u6570\uff08\u6bd2\u7624\uff09\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $O(n^2)$\u3002\n\n```cpp\nint n,tot,sub,a[N],l[N][N],c[N][N],C[N][N];\n\nint main(){\n\tn=read(); for(int i=1;i<=n;i++)a[i]=read(),l[0][i]=c[0][i]=1; sort(a+1,a+n+1);\n\tC[0][0]=1; for(int i=1;i<=n;i++)for(int j=0;j<=i;j++)C[i][j]=!j?1:(C[i-1][j-1]+C[i-1][j])%P;\n\tfor(int i=1;i<=n;i++){\n\t\tint p=i+1; for(int j=0;j<i;j++){\n\t\t\tif(j)l[j][i]=(l[j][i-1]+l[j][i])%P,c[j][i]=(c[j][i-1]+c[j][i])%P;\n\t\t\twhile(p<=n&&a[j]+a[i]>a[p])p++;\n\t\t\tif(p<=n)l[i][p]=(l[i][p]+l[j][i]+c[j][i])%P,c[i][p]=(c[i][p]+c[j][i])%P;\n\t\t\tsub=(sub+1ll*l[j][i]*a[i])%P;\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)for(int j=1;j<=i;j++)tot=(tot+1ll*C[i-1][j-1]*j%P*a[i])%P;\n\tcout<<(tot-sub+P)%P;\n\treturn 0;\n}\n```\n",
        "postTime": 1588771319,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P6525 \u3010\u300cWdoi-1\u300d\u84ec\u83b1\u7389\u679d\u3011"
    },
    {
        "content": "Changelog: \u91cd\u6784\u3002\n\n[\u539f\u6587](https://www.luogu.com.cn/paste/60mpok16)\u3002\n\n---\n\n\u9996\u5148\u6392\u5e8f\u3002\u4e0b\u9762\u8ba4\u4e3a $a$ \u4e0d\u964d\u3002\n\n\u4e0d\u8003\u8651\u662f\u5426\u65e0\u804a\uff0c\u7528\u6240\u6709\u9009\u62e9\u65b9\u6848\u7684\u8d21\u732e\u51cf\u65e0\u804a\u7684\u65b9\u6848\u7684\u8d21\u732e\u3002\n\n\u5168\u90e8\u65b9\u6848\u7684\u8d21\u732e\u4e3a\n$$\\sum_{i = 1}^n a_i \\sum_{j = 0}^{i - 1} (j + 1) \\binom {i - 1} j = \\sum_{i = 1}^n 2^{i - 2} (i + 1) a_i$$\n\n\u8003\u8651\u5728\u4e00\u4e2a\u5927\u5c0f\u81f3\u5c11\u4e3a $2$ \u7684\u65e0\u804a\u65b9\u6848 $S$ \u540e\u52a0\u5165 $a_i$ \u662f\u5426\u65e0\u804a\u3002\u8bbe $j, k$ \u4e3a $S$ \u4e2d\u6700\u5927\u7684\u4e24\u4e2a\u4f4d\u7f6e\uff0c\u5219\u65b0\u65b9\u6848\u65e0\u804a\u5f53\u4e14\u4ec5\u5f53 $a_j + a_k \\le a_i$\u3002\n\n\u8bbe $f_{i, j}, h_{i, j}$ \u5206\u522b\u8868\u793a\u65b9\u6848\u4e2d\u6700\u5927\u4f4d\u7f6e\u4e3a $i$\u3001\u6b21\u5927\u4f4d\u7f6e\u4e3a $j$ \u7684\u5927\u5c0f\u4e4b\u548c\u3001\u65b9\u6848\u6570\uff0c\u5219\n\n$$f_{i, j} = \\sum_{k < j \\land a_k + a_j \\le a_i} (f_{j, k} + h_{j, k}) + 2$$\n$$h_{i, j} = \\sum_{k < j \\land a_k + a_j \\le a_i} h_{j, k} + 1$$\n\n\u5176\u4e2d $k$ \u7684\u8303\u56f4\u53ef\u4ee5\u5728\u679a\u4e3e $j$ \u7684\u540c\u65f6\u53cc\u6307\u9488\u5f97\u5230\u3002\n\n\u65f6\u7a7a\u590d\u6742\u5ea6 $O(n^2)$\u3002\n\n```cpp\nnamespace khin { namespace main {\n  constexpr lu const mod(20'060'723);\n  constexpr hu const n_max(5'000);\n  hu n; lu a[n_max + 1]; lu f[n_max + 1][n_max + 1], h[n_max + 1][n_max + 1]; lu ans;\n  inline void main(dint, char*[]) {\n    get(n); for (size_t i(1); i <= n; ++i) get(a[i]); sort(a + 1, a + n + 1);\n    {\n      lu pow(1);\n      for (size_t i(2); i <= n; pow = pow * 2 % mod, ++i) ans = (ans + (1ull * (i + 1) * pow % mod - 1 + mod) * a[i]) % mod;\n    }\n    for (size_t i(1); i <= n; ++i) for (size_t j(1), k0(i); j < i; ++j) {\n      while (k0 && a[k0] + a[j] > a[i]) --k0;\n      size_t const k(min(k0, j - 1));\n      f[i][j] = (f[j][k] + h[j][k] + 2) % mod, h[i][j] = (h[j][k] + 1) % mod;\n      ans = (ans - 1ull * f[i][j] * a[i] % mod + mod) % mod;\n      f[i][j] = (f[i][j - 1] + f[i][j]) % mod, h[i][j] = (h[i][j - 1] + h[i][j]) % mod;\n    }\n    put(ans, '\\n');\n  }\n} }\n```",
        "postTime": 1586229124,
        "uid": 236807,
        "name": "Mitama",
        "ccfLevel": 9,
        "title": "[Solution] P6525"
    },
    {
        "content": "\u9996\u5148\u6ce8\u610f\u5230\u4e00\u79cd\u65b9\u6848\u4e2d\u4e09\u8fb9\u7684\u504f\u5e8f\u5173\u7cfb\u4e00\u5b9a\uff0c\u6545\u4e3a\u4e86\u8f6c\u79fb\u65b9\u4fbf\uff0c\u6211\u4eec\u5bf9 $ a $ \u6570\u7ec4\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\u3002\n \n\u53d1\u73b0\u6b63\u7740\u7b97\u4e0d\u65b9\u4fbf\uff0c\u8003\u8651\u7528\u6240\u6709\u65b9\u6848\u7684\u8d21\u732e\u51cf\u53bb\u201c\u4e0d\u5408\u6cd5\uff08\u65e0\u804a\u7684\uff09\u201d\u65b9\u6848\u6240\u5e26\u6765\u7684\u8d21\u732e\u3002\n-  ### \u72b6\u6001\u8bbe\u8ba1\n\u7531\u4e8e\u8d21\u732e\u7684\u8ba1\u7b97\u9700\u8981\u77e5\u9053\u9009\u62e9\u7684\u6570\u91cf $ k $ \u548c\u6700\u957f\u7684\u957f\u5ea6 $ m $ \uff0c\u53c8\u8003\u8651\u5230\u65b9\u6848\u662f\u5426\u5408\u6cd5\u7684\u5224\u65ad\u9700\u8981\u4e09\u6761\u8fb9\u7684\u5927\u5c0f\u5173\u7cfb\uff0c\u8bbe\u8ba1\u72b6\u6001\u4e3a $ f_{i,j} $ \u8868\u793a\u6700\u5927\u7684\u8fb9\u4e3a $ a_j $ \uff0c\u6b21\u5927\u7684\u8fb9\u4e3a $ a_i $ \u7684**\u6240\u6709\u65b9\u6848\u7684\u957f\u5ea6\u4e4b\u548c**\uff0c\u663e\u7136\u8981\u6c42 $ i < j $ \uff0c $ g_{i, j} $ \u8868\u793a\u6700\u5927\u7684\u8fb9\u4e3a $ a_j $ \uff0c\u6b21\u5927\u7684\u8fb9\u4e3a $ a_i $ \u7684\u65b9\u6848\u6570\u3002\n\n - ### \u72b6\u6001\u8f6c\u79fb\n \n \u8003\u8651\u5f53\u524d\u72b6\u6001\u53ef\u4ee5\u8f6c\u79fb\u5230\u54ea\u4e9b\u72b6\u6001\uff0c\u663e\u7136\u6709 \n  \t$ (i, j) \\rightarrow (j, k) $ $ | $ ( $ a_i + a_j \\le a_k $ )\u3002\n\n\u5373 \n\n(1)  $ f_{j, k} \\leftarrow f_{j, k} + f_{i, j} + g_{i, j} $ ,  \n\n\n(2)  $ g_{j, k} \\leftarrow g_{j, k} + g_{i, j} $  $ | $ ( $ a_i + a_j \\le a_k $ )\u3002\n\n\u603b\u65b9\u6848\u7684\u8d21\u732e\u548c\uff1a\n$$ \\sum_{i=1}^n\\sum_{j=1}^ia_i \\times j \\times \\tbinom{i-1}{j-1}$$\n\n\u521d\u59cb\u5316\uff1a \n$$ f_{0, i} = g_{0, i} = 0 $$\n\u76ee\u6807\uff1a \n$$ \\sum_{i=1}^n \\sum_{j=0}^{i-1}a_i \\times f_{j, i} $$\n\n  ##### \u8f6c\u79fb\u7ec6\u8282 \n\n1.  \u5faa\u73af $ j $ \u65f6 $ k $ \u7684\u51b3\u7b56\u5355\u8c03\u9012\u589e\u3002\n2. \u6bcf\u6b21\u5411\u4e00\u6bb5\u540e\u7f00\u533a\u95f4\u8f6c\u79fb\uff0c\u5373\n $f_{i, j} \\rightarrow f_{j, k}$ | $(1 \\le k \\le n \\land a_i + a_j \\le a_k)$\n\uff0c\u53ef\u7528\u524d\u7f00\u548c\u4f18\u5316\u3002\n2. \u53ef\u4ee5\u8fb9\u8f6c\u79fb\u8fb9\u8ba1\u7b97\u3002\n\n- ### \u4ee3\u7801\n\n\n```cpp\n#include <bits/stdc++.h>\n#define For(i, l, r) for (int i = (l); i <= (r); i ++ ) \n#define Fer(i, r, l) for (int i = (r); i >= (l); i -- )\n// #define int long long\nusing namespace std;\ntypedef long long LL;\ntypedef __int128 LLL;\ntypedef unsigned long long ULL;\ntypedef pair<int, int> PII;\ntypedef pair<LL, LL> PLL;\ntypedef pair<ULL, ULL> PUU;\nconst int N = 1e4 + 10, M = 5e5 + 10;\nconst LL INF = 2e18;\nconst int mod = 20060723;\n\nint read()\n{\n    int x = 0, k = 1;\n    char ch = getchar();\n    while (ch < '0' || ch > '9') { if (ch == '-') k = -1; ch = getchar(); }\n    while (ch >= '0' && ch <= '9') x = (x << 1) + (x << 3) + ch - '0', ch = getchar();\n    return x * k;\n}\n\nvoid write(int x)\n{\n    if (x < 0) x = -x, putchar('-');\n    if (x > 9) write(x / 10);\n    putchar(x % 10 + '0');\n}\n\nint n;\nint a[N];\nint f[N][N], g[N][N];\nint C[N][N];\n\nsigned main()\n{\n    // freopen(\"S.in\", \"r\", stdin);\n\tn = read();\n\tLL tot = 0, sub = 0;\n    For (i, 1, n) a[i] = read(), f[0][i] = g[0][i] = 1;\n\tsort(a + 1, a + n + 1);\n\tC[0][0] = 1;\n\tFor (i, 1, n) For (j, 0, i) \n\t\tif (!j) C[i][j] = 1;\n\t\telse C[i][j] = (C[i - 1][j] + C[i - 1][j - 1]) % mod;\t\n\tFor (i, 1, n) \n\t{\n\t\tint k = i + 1;\n\t\tFor (j, 0, i - 1) \n\t\t{\n\t\t\tif (j) f[j][i] = (f[j][i] + f[j][i - 1]) % mod, g[j][i] = (g[j][i - 1] + g[j][i]) % mod;\n\t\t\twhile (k <= n && a[i] + a[j] > a[k]) k ++ ;\n\t\t\tif (k <= n) f[i][k] = (f[i][k] + f[j][i] + g[j][i]) % mod, g[i][k] = (g[i][k] + g[j][i]) % mod;\n\t\t\tsub = (sub + 1ll * f[j][i] * a[i]) % mod;\n\t\t}\n\t}\n\tFor (i, 1, n) For (j, 1, i) tot = (tot + 1ll * C[i - 1][j - 1] * j % mod * a[i] % mod) % mod;\n\tprintf(\"%lld\\n\", (tot - sub + mod) % mod);\t\n    return 0;\n}\n```\n\n",
        "postTime": 1662107738,
        "uid": 657888,
        "name": "wxkk",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6525 \u3010\u300cWdoi-1\u300d\u84ec\u83b1\u7389\u679d\u3011"
    },
    {
        "content": "\u8c8c\u4f3c\u8fd8\u6ca1\u6709\u548c\u6211\u505a\u6cd5\u4e00\u6837\u7684\u9898\u89e3\uff0c\u53d1\u4e00\u7bc7\u5427\uff01\n\n\u6211\u4eec\u8003\u8651 $dp_{i,j}$ \u8868\u793a\u9009\u51fa\u6765\u7684\u6570\u4e2d\u6700\u5927\u7684\u4e3a $a_i$\uff0c\u6b21\u5927\u7684\u4e3a $a_j$ \u65f6\u7684**\u6784\u4e0d\u6210\u4e09\u89d2\u5f62\u7684**\u65b9\u6848\u4e2a\u6570\uff0c$t_{i,j}$ \u8868\u793a\u65b9\u6848\u957f\u5ea6\u4e4b\u548c\uff0c\u663e\u7136\u5168\u90e8\u65b9\u6848\u6570\u53ef\u4ee5\u7b80\u5355\u5730\u7b97\u51fa\uff0c\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a\n\n$$dp_{l,i}=dp_{l,i}+dp_{i,j},t_{l,i}=t_{l,i}+t_{i,j}+dp_{i,j}$$\n\n\u53d1\u73b0\u8fd9\u73a9\u610f\u53ef\u4ee5\u5355\u8c03\u961f\u5217\u4f18\u5316\u4e00\u4e0b\uff0c\u518d\u5957\u4e2a\u524d\u7f00\u548c\uff0c\u5747\u644a\u590d\u6742\u5ea6 $O(n^2)$\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n//By: Luogu@\u26a1\u70ad\u6cbb\u90ce\u26a1(a.k.a. Kamado_Tanjiro)(LuoguID:308854)\n#include <bits/stdc++.h>\n#define rep(i,x,y,z) for(int i=(x);i<=(y);i+=(z))\n\nusing namespace std;\n\nconst int INF=(sizeof(int)==4?0x3f3f3f3f:0x3f3f3f3f3f3f3f3f);\nconst int MOD=20060723;\nconst long double EPS=1e-7;\nconst int MAXN=5010;\n\nlong long a[MAXN];\nint dp[MAXN][MAXN];\nint t[MAXN][MAXN];\nint C[MAXN][MAXN];\nint diffDp[MAXN][MAXN];\nint diffT[MAXN][MAXN];\nint Sumdp[MAXN];\nint SumT[MAXN];\n\nsigned main()\n{\n\tios::sync_with_stdio(false);\n\n\tint n;\n\n\tcin>>n;\n\n\tfor(int i=1;i<=n;i++)\n\t\tcin>>a[i];\n\n\tC[0][0]=1;\n\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tC[i][0]=1;\n\n\t\tfor(int j=1;j<=i;j++)\n\t\t{\n\t\t\tC[i][j]=C[i-1][j-1]+C[i-1][j];\n\n\t\t\tC[i][j]%=MOD;\n\t\t}\n\t}\n\n\tsort(a+1,a+1+n);\n\n\tlong long ans=0;\n\t//int beg=3;\n\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=i-1;j++)\n\t\t{\n\t\t\tdp[i][j]=1,t[i][j]=2;\n\n\t\t\tans+=((1ll*C[i-1][j])*(((j+1)*(a[i]%MOD))%MOD));\n\t\t\tans%=MOD;\n\t\t}\n\t}\n\n\t//cout<<ans<<endl;\n\n\t//dp[2][1]=1;\n\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint beg=i+1;\n\n\t\tfor(int j=1;j<=i-1;j++)\n\t\t{\n\t\t\tSumdp[j]+=diffDp[i][j];\n\t\t\tSumT[j]+=diffT[i][j];\n\t\t\tSumdp[j]%=MOD;\n\t\t\tSumT[j]%=MOD;\n\t\t\tdp[i][j]+=Sumdp[j];\n\t\t\tt[i][j]+=SumT[j];\n\t\t\tdp[i][j]%=MOD;\n\t\t\tt[i][j]%=MOD;\n\n\t\t\tbeg=max(beg,i+1);\n\n\t\t\tfor(int l=beg;l<=n;l++)\n\t\t\t{\n\t\t\t\tif(a[i]+a[j]<=a[l])\t\t\t\t\t\t//a[i]+a[j]\u5355\u8c03\u4e0d\u4e0b\u964d\n\t\t\t\t{\n\t\t\t\t\tdiffDp[l][i]+=dp[i][j],diffT[l][i]+=t[i][j]+dp[i][j];\n\t\t\t\t\tbeg=l;\n\t\t\t\t\tdiffDp[l][i]%=MOD;\n\t\t\t\t\tdiffT[l][i]%=MOD;\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tbeg=l;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=i-1;j++)\n\t\t{\n\t\t\tt[i][j]%=MOD;\n\n\t\t\tans-=(1ll*t[i][j]*(a[i]%MOD))%MOD;\n\t\t\tans+=MOD;\n\t\t\tans%=MOD;\n\t\t\t//cout<<dp[i][j]<<\" \";\n\t\t}\n\n\t\t//cout<<endl;\n\t}\n\n\tcout<<(ans+MOD)%MOD<<endl;\n\n\treturn 0;\n}\n```",
        "postTime": 1652011467,
        "uid": 308854,
        "name": "tzl_Dedicatus545",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P6525 \u3010\u300cWdoi-1\u300d\u84ec\u83b1\u7389\u679d\u3011"
    }
]
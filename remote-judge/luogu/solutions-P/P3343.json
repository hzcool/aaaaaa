[
    {
        "content": "\u55ef...\u65e2\u7136\u8fd9\u9898\u6ca1\u6709\u9898\u89e3\u90a3\u6211\u5c31\u6765\u5199\u4e00\u4e2a\u5427\uff01\n\n\u663e\u7136\uff0c\u9898\u76ee\u7b49\u4ef7\u4e8e\u540c\u65f6\u4fee\u5efa\u8fd9$m$\u6761\u9053\u8def\u65f6\uff0c\u9996\u6b21\u8fde\u901a\u7684\u65f6\u95f4\u671f\u671b\u503c\u3002\n\n\u6211\u4eec\u4ee4$p(x)$\u4e3a\u9996\u6b21\u8fde\u901a\u7684\u65f6\u95f4\uff08\u8bbe\u5b83\u4e3a\u968f\u673a\u53d8\u91cf$X$\uff09\u7684\u6982\u7387\u5206\u5e03\u51fd\u6570\uff0c\u4e5f\u5c31\u662f$p(x)=\\frac{dP(x)}{dx}$\uff0c\u5176\u4e2d$P(t)=Pr(X\\geq t)$\uff0c\u90a3\u4e48\u6839\u636e\u671f\u671b\u7684\u5b9a\u4e49\u6709\n\n$$\\begin{aligned}E(X)&=\\int_0^1p(x)x\\mathrm{d}x\\\\&=\\int_0^1p(x)\\int_0^x\\mathrm{d}t\\,\\mathrm{d}x\\\\&=\\int_0^1\\int_t^1p(x)\\mathrm{d}x\\,\\mathrm{d}t\\\\&=\\int_0^1P(t)\\mathrm{d}t\\end{aligned}$$\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8ba1\u7b97$\\int_0^1P(t)dt$\u5373\u53ef\u3002\n\n\u8003\u8651\u5982\u679c$X\\geq t$\uff0c\u4e5f\u5c31\u662f\u8bf4\u56fe\u5728$t$\u65f6\u523b\u4e0d\u8fde\u901a\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u7ed3\u70b9$1$\u5728$t$\u65f6\u523b\u7684\u8fde\u901a\u5757\u91cc\u6709\u54ea\u4e9b\u70b9\u3002\u5982\u679c\u6709$S(1 \\in S)$\u8fd9\u4e9b\u70b9\uff0c\u90a3\u4e48\u9996\u5148$S$\u8981\u8fde\u901a\uff08\u6982\u7387\u6211\u4eec\u5b9a\u4e49\u4e3a$1-P_S(t)$\uff09\uff0c\u5176\u6b21\uff0c$S$\u91cc\u7684\u70b9\u548c\u5176\u5b83\u70b9\u4e4b\u95f4\u7684\u8fb9\u7684$e$\u90fd\u5927\u4e8e$t$\uff08\u6982\u7387\u4e3a$(1-t)^{T(S, \\overline S)}$\uff0c\u5176\u4e2d$\\overline S$\u4e3a$S$\u7684\u8865\u96c6\uff0c$T(A, B)$\u8868\u793a\u70b9\u96c6$A,B$\u4e4b\u95f4\u7684\u8fb9\u6570\uff09\uff1b\u7531\u4e8e\u8fd9\u4e24\u4e2a\u4e8b\u4ef6\u662f\u72ec\u7acb\u7684\uff0c\u6240\u4ee5\u603b\u7684\u6982\u7387\u662f$(1-t)^{T(S, \\overline S)}P_S(t)$\u3002$P_S(t)$\u4e5f\u53ef\u4ee5\u7c7b\u4f3c\u8ba1\u7b97\uff0c\u9012\u63a8\u5f0f\u4e3a\uff1a\n\n$$P_S(t)=\\sum_{1\\in S_0 \\subsetneq S}(1-t)^{T(S_0, S - S_0)}\\left[1-P_{S_0}(t)\\right]\\qquad(1\\in S)$$\n\n\u8fb9\u754c\u6761\u4ef6\u662f$P_{\\{1\\}}(t)=0$\uff0c\u56e0\u4e3a\u5355\u4e00\u7684\u70b9\u6c38\u8fdc\u662f\u8fde\u901a\u7684\u3002\n\n\u90a3\u4e48\u6709\n\n$$\\begin{aligned}\\int_0^1P_S(t)\\mathrm{d}t&=\\sum_{1\\in S_0 \\subsetneq S}\\int_0^1(1-t)^{T(S_0, S - S_0)}\\left[1-P_{S_0}(t)\\right]\\mathrm{d}t\\\\&=\\sum_{1\\in S_0 \\subsetneq S}\\left[\\int_0^1(1-t)^{T(S_0, S - S_0)}-(1-t)^{T(S_0, S - S_0)}P_{S_0}(t)\\mathrm{d}t\\right]\\\\&=\\sum_{1\\in S_0 \\subsetneq S}\\left[\\frac{1}{1+T(S_0, S - S_0)}-\\int_0^1(1-t)^{T(S_0, S - S_0)}P_{S_0}(t)\\mathrm{d}t\\right]\\end{aligned}$$\n\n\u540c\u7406\uff0c\n\n$$\\int_0^1(1-t)^kP_S(t)\\mathrm{d}t=\\sum_{1\\in S_0 \\subsetneq S}\\left[\\frac{1}{1+k+T(S_0, S - S_0)}-\\int_0^1(1-t)^{k+T(S_0, S - S_0)}P_{S_0}(t)\\mathrm{d}x\\right]$$\n\n\u8fb9\u754c\u6761\u4ef6\uff1a$\\int_0^1P_{\\{1\\}}(t)(1-t)^k{\\rm d}t=\\int_0^10{\\rm d}t=0$\n\n\u800c\u6211\u4eec\u8981\u6c42\u7684\u5c31\u662f\n\n$$EX = \\int_0^1P(t){\\rm d}t =\\int_0^1(1-t)^0P_{\\{1,2,\\dots,n\\}}(t){\\rm d}t$$\n\n\u4e8e\u662f\u5173\u4e8e$S, k$\u9012\u63a8\u5373\u53ef\u3002\u6309$S$\u4ece\u5c0f\u5230\u5927\u8ba1\u7b97\uff0c\u6bcf\u6b21\u679a\u4e3e\u5b50\u96c6\u4e4b\u540e\u5229\u7528\u4f4d\u8fd0\u7b97$O(n)$\u6c42\u51fa$T$\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6$O(3^nm)$\u3002\n\nPS\uff1a\u641e\u4e86\u4e00\u665a\u4e0a\u7ec8\u4e8e\u62a2\u4e0brk1\u4e86\u3002\n\n```cpp\n#include <algorithm>\n#include <cstdio>\n#include <cstring>\n\nconst int N = 10;\nconst int M = 45 + 1;\nbool vis[1 << N][M];\nint siz[1 << N], link[N];\ndouble f[1 << N][M];\nint main() {\n  int n, m;\n  scanf(\"%d%d\", &n, &m);\n  int lim = 1 << n;\n  for (int i = 0, x, y; i < m; ++i) {\n    scanf(\"%d%d\", &x, &y);\n    --x; --y;\n    link[x] |= (1 << y);\n    link[y] |= (1 << x);\n  }\n  for (int S = 1; S < lim; ++S) siz[S] = siz[S & (S - 1)] + 1;\n  for (int S1 = 3; S1 < lim; ++S1) if (S1 & 1) {\n    for (int S2 = (S1 - 1) & S1; S2 != 0; S2 = (S2 - 1) & S1) if (S2 & 1) {\n      int T = 0;\n      for (int i = 0; i < n; ++i) if ((S1 >> i) & (~S2 >> i) & 1)\n        T += siz[link[i] & S2];\n      for (int i = 0; i + T <= m; ++i)\n        f[S1][i] += 1.0 / (i + T + 1) - f[S2][i + T];\n    }\n  }\n  printf(\"%.6lf\\n\", f[lim - 1][0]);\n  return 0;\n}\n\n\n```",
        "postTime": 1513996295,
        "uid": 7868,
        "name": "_rqy",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P3343 \u3010[ZJOI2015]\u5730\u9707\u540e\u7684\u5e7b\u60f3\u4e61\u3011"
    },
    {
        "content": "\u60f3\u4e86\u534a\u5929\uff0c\u6253\u5f00\u6d1b\u8c37\u9898\u89e3\u4e00\u770b\uff0c\u6700\u9ad8\u7968\u662f_rqy\u7684\uff0c\u4e00\u5806\u5bc6\u5bc6\u9ebb\u9ebb\u7684\u79ef\u5206\u5dee\u70b9\u628a\u6211\u5413\u8dd1\u3002\n\n\u636e\u8bf4\u6709\u4e09\u79cd\u89e3\u6cd5\uff0c\u7136\u800c\u6211\u53ea\u5b66\u4f1a\u4e86\u4e00\u79cd\u6700\u8fa3\u9e21\u7684\u51e1\u4eba\u89e3\u6cd5\u3002\n\nupt:\u66f4\u6b63\u4e86\u4e00\u4e9b\u9519\u8bef..\n\n------\n\n\u9898\u610f\uff1a\u7ed9\u4e00\u4e2a\u65e0\u5411\u56fe$G$\uff0c\u8fb9\u6743\u4e3a$[0,1]$\u95f4\u7684\u5b9e\u6570\uff0c\u6c42\u8fd9\u4e2a\u56fe\u7684\u6700\u5c0f\u751f\u6210\u6811\u7684\u6700\u5927\u8fb9\u6743\u671f\u671b\u3002\n\n\u63d0\u793a\uff1a\u5bf9\u4e8e $n$ \u4e2a $[0,1]$ \u4e4b\u95f4\u7684\u968f\u673a\u53d8\u91cf $x_1,x_2,\\dots,x_n$\uff0c\u7b2c $k$ \u5c0f\u7684\u90a3\u4e2a\u7684\u671f\u671b\u503c\u662f $\\frac{k}{n+1}$\u3002\n\n------\n\n\u8003\u8651\u4f7f\u7528\u8fd9\u4e2a\u63d0\u793a\u6765\u5e2e\u52a9\u89e3\u9898\u3002\n\n\u9996\u5148\u6709\u4e00\u4e2a\u66b4\u529b\u505a\u6cd5\uff0c\u679a\u4e3e\u8fb9\u6743\u7684\u76f8\u5bf9\u5927\u5c0f\uff0c\u7136\u540e\u505a\u6700\u5c0f\u751f\u6210\u6811\uff0ckruskal\u5f97\u5230\u4e00\u68f5\u6811\u65f6\u62ff\u63d0\u793a\u7b97\u4e00\u4e0b\n\n\u8fd9\u4e2a\u60f3\u6cd5\u542f\u53d1\u6211\u4eec\u94a6\u5b9a\u4e00\u4e2a\u8fb9\u96c6$S$\u4f5c\u4e3a\u524d$|S|$\u5c0f\uff0c\u5982\u679c\u8fd9\u4e2a\u8fb9\u96c6\u52a0\u5165\u7b2c$|S|$\u5c0f\u8fd9\u6761\u8fb9\u65f6\u6070\u597d\u4f7f\u56fe\u8054\u901a\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7b97\u5b83\u7684\u8d21\u732e\u662f$\\frac{|S|}{m+1}$\uff0c\u5982\u679c\u6211\u4eec\u8fd8\u80fd\u7b97\u51fa\u5b83\u7684\u65b9\u6848\u5e76\u9664\u4e0a\u603b\u65b9\u6848\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\u5b83\u7684\u6982\u7387\uff0c\u6240\u4ee5\u8003\u8651\u53bb\u7edf\u8ba1\u8fd9\u4e2a\u65b9\u6848\u3002\n\n\u6070\u597d\u8054\u901a\u8fd9\u4e2a\u6761\u4ef6\u5e76\u4e0d\u597d\u7edf\u8ba1\uff0c\u6211\u4eec\u8f6c\u6362\u4e00\u4e0b\uff0c\u53ef\u4ee5\u53d8\u6210\n\n`\u6070\u597d\u8054\u901a\u65b9\u6848=\u52a0\u4e4b\u524d\u4e0d\u8fde\u901a\u65b9\u6848-\u52a0\u4e4b\u540e\u4e0d\u8fde\u901a\u65b9\u6848`\n\n\u7136\u540e\u6bd4\u8f83\u81ea\u7136\u7684\u53ef\u4ee5\u8003\u8651\u538b\u4e00\u4e2a\u5b50\u96c6\u53bb\u505a$dp$\n\n\u4ee4$f_{S,i},g_{S,i}$\u5206\u522b\u8868\u793a\u70b9\u96c6\u4e3a$S$\uff0c\u7528\u4e86$i$\u6761\u8fb9\uff0c\u4e14\u70b9\u96c6\u4e0d\u8054\u901a/\u8fde\u901a\u7684\u65b9\u6848\u6570\uff0c\u8bbe$d_S$\u4e3a\u70b9\u96c6$s$\u5728\u56fe$G$\u4e2d\u7684\u8fb9\u6570\n\n\u663e\u7136\u6709\n\n$$g_{S,i}+f_{S,i}=\\binom{d_S}{i}$$\n\n\u8003\u8651$f$\u7684\u9012\u63a8\uff0c\u6211\u4eec\u679a\u4e3e$s$\u7684\u5b50\u96c6\uff0c\u5e76\u4e14**\u94a6\u5b9a**\u67d0\u4e2a\u70b9$k$\u4e00\u5b9a\u5728\u5b50\u96c6\u91cc\uff0c\u6709\u8f6c\u79fb\n\n$$f_{S,i}=\\sum_{k\\in T\\subset S}\\sum_{j=0}^{d_T}g_{T,j}\\binom{d_{S-T}}{i-j}$$\n\n\u7136\u540e\u6700\u540e\u8003\u8651\u5982\u4f55\u7edf\u8ba1\u7b54\u6848\uff0c\u8bbe$U$\u4e3a\u5168\u96c6\uff0c\u6309\u7167\u4e4b\u524d\u8bf4\u7684\uff0c\u7b54\u6848\u4e3a\n\n$$\\sum_{k=1}^{m+1}\\frac{k}{m+1}\\times (\\frac{f_{U,k-1}}{\\binom{d_u}{k-1}}-\\frac{f_{U,k}}{\\binom{d_u}{k}})$$\n\n\u5316\u7b80\u4e00\u4e0b\n\n$$\\frac{1}{m+1}\\sum_{k=1}^m\\frac{f_{U,k}}{\\binom{d_U}{k}}$$\n\n------\n\n**Code:**\n\n```cpp\n#include <cstdio>\n#include <cctype>\n#include <algorithm>\nusing std::min;\ntemplate <class T>\nvoid read(T &x)\n{\n\tx=0;char c=getchar();\n\twhile(!isdigit(c)) c=getchar();\n\twhile(isdigit(c)) x=x*10+c-'0',c=getchar();\n}\ndouble C[51][51],f[1<<10][51],g[1<<10][51];\nint yuu[1<<10],dew[1<<10],n,m;\nint main()\n{\n\tread(n),read(m);\n\tfor(int u,v,i=1;i<=m;i++)\n\t{\n\t\tread(u),read(v);\n\t\t++dew[(1<<u-1)|(1<<v-1)];\n\t}\n\tfor(int s=1;s<1<<n;s++)\n\t\tfor(int t=s;t;t=t-1&s)\n\t\t\tyuu[s]+=dew[t];\n\tC[0][0]=1;\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tC[i][0]=1;\n\t\tfor(int j=1;j<=i;j++)\n\t\t\tC[i][j]=C[i-1][j]+C[i-1][j-1];\n\t}\n\tfor(int s=1;s<1<<n;s++)\n\t{\n\t    for(int i=0;i<=yuu[s];i++)\n\t\t{\n\t\t\tfor(int t=s-1&s;t;t=t-1&s)\n                if(t&(s&-s))\n                    for(int j=0;j<=min(i,yuu[t]);j++)\n                        f[s][i]+=g[t][j]*C[yuu[s^t]][i-j];\n\t\t\tg[s][i]=C[yuu[s]][i]-f[s][i];\n\t\t}\n\t}\n\tdouble ans=0;\n\tfor(int i=0;i<=m;i++) ans+=f[(1<<n)-1][i]/C[m][i];\n\tans/=m+1.0;\n\tprintf(\"%.6f\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1551769999,
        "uid": 63727,
        "name": "ButterflyDew",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3343 \u3010[ZJOI2015]\u5730\u9707\u540e\u7684\u5e7b\u60f3\u4e61\u3011"
    },
    {
        "content": "\u671f\u671b\u795e\u9898\u2026\u2026\n\u8fd9\u9053\u9898\u548c\u4eca\u5e74NOIPD2T2\u6781\u5ea6\u795e\u4f3c\uff0c\u4e0d\u77e5\u9053NOIP2018\u8981\u6bd2\u7624\u5230\u54ea\u91cc\u53bb\u4e86\n\n\u6211\u4eec\u9996\u5148\u89c1\u5230\u8fd9\u9053\u9898\uff0c\u7b2c\u4e00\u53cd\u5e94\u662f\u2014\u2014\u4e0d\u4f1a\n\n\u6240\u4ee5\u6211\u4eec\u8981\u5199\u66b4\u529b\u3002\n\n\u5176\u5b9e\uff0c\u5982\u679c\u77e5\u9053\u8fb9\u7684\u6392\u540d\u7684\u8bdd\uff0c\u8dd1kruskal\u5c31\u597d\u4e86\u5bf9\u5427\n\n\u4f46\u662f\u6211\u4eec\u4e0d\u77e5\u9053\u6392\u540d\n\n\u6240\u4ee5\u66b4\u529b\u679a\u4e3e\u8fb9\u7684\u5168\u6392\u5217\uff0c\u8dd1kruskal\uff0c\u7528\u9898\u76ee\u4e2d\u7ed9\u7684\u7ed3\u8bba\u66f4\u65b0\u7b54\u6848\u5373\u53ef\n\n\u590d\u6742\u5ea6n\\*m!\n\n\u663e\u7136\u592a\u66b4\u529b\u4e86\uff0c\u4f46\u662f\u5982\u679c\u4f60\u8bb0\u5f97NOIP2017D2T2\u7684\u8bdd\uff0c\u4f1a\u53d1\u73b0\u5b83\u4e5f\u6709\u4e00\u4e2a\u7c7b\u4f3c\u7684\u5168\u6392\u5217\u679a\u4e3e+\u8d2a\u5fc3\u7684\u505a\u6cd5\n\n\u7136\u540e\u4f18\u5316\u5462\uff1f\n\n\u5b50\u96c6DP\uff0c\u662f\u5b50\u96c6DP\uff0c\u5168\u6392\u5217\u4e4b\u6240\u4ee5\u590d\u6742\u5ea6\u9ad8\uff0c\u662f\u56e0\u4e3a\u5b83\u7ed9\u4e86\u6211\u4eec\u8bb8\u591a\u4e0d\u9700\u8981\u7684\u4fe1\u606f\uff0c\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u6211\u4eec\u53ea\u9700\u4e24\u4e2a\u4fe1\u606f\uff0c\u4e00\u662f\u72b6\u6001\uff0c\u4e8c\u662f\u8054\u901a\u6027\n\u4ece\u800c\u628a\u671f\u671b\u95ee\u9898\u8f6c\u5316\u4e3a\u8ba1\u6570\u95ee\u9898\n\n\u90a3\u4e48\u8fd9\u4e2a\u662f\u53ef\u4ee5\u72b6\u538b\u7684\uff0c\u5f53\u7136\uff0c\u4f60\u4f1a\u53d1\u73b0\u8bbef\\[s]\\[i]\u8868\u793a\u70b9\u96c6s\u5168\u90e8\u8054\u901a,\u6700\u5927\u8fb9\u6392\u540d\u4e3ai\u662f\u4e0d\u53ef\u8f6c\u79fb\u7684\n\n\u6240\u4ee5\u8fd9\u91cc\u6709\u4e2a\u64cd\u4f5c\u53eb\u6b63\u96be\u5219\u53cd\n\n\u6211\u4eec\u8bbedp\\[k]\\[i]\\[s](k\u4e3a0/1\u53d8\u91cf)(s\u4e3a\u4e8c\u8fdb\u5236\u4e32)\u4e3a\u52a0\u5165\u524di\u6761\u8fb9\u65f6\n\u70b9\u96c6s\u8054\u901a/\u4e0d\u8fde\u901a\u7684\u6982\u7387\u3002\n\n\u5148\u89e3\u91ca\u4e00\u4e0b\u4e3a\u4ec0\u4e48\u53d8\u6210\u4e86\u524di\u6761\u8fb9\uff0c\u56e0\u4e3a\u8fd9\u91cc\u8981\u6c42\u7684\u4ee3\u4ef7\u662f**\u6700\u5927\u8fb9\u6700\u5c0f**\uff0c\u800c\u4e0d\u662f\u603b\u548c\u6700\u5c0f\uff0c\u6240\u4ee5\u5e73\u5e38\u505akruskal\u4e2d\u88ab\u201c\u8df3\u8fc7\u201d\u7684\u8fb9\uff0c\u6b64\u65f6\u662f\u65e0\u9700\u4ed8\u51fa\u4ee3\u4ef7\u7684\uff0c\u6240\u4ee5\u4e5f\u53ef\u4ee5\u8bb0\u4e3a\u4e00\u79cd\u65b9\u6848\n\n\u8f6c\u79fb\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u5176\u4e2d\u7684\u4e00\u4e2a\u9876\u70b9\uff0c\u54ea\u4e00\u4e2a\u65e0\u6240\u8c13\uff0c\u53ea\u662f\u5728\u6c42dp[0][s][i]\u7684\u65f6\u5019\u8fd9\u4e2a\u70b9p\u8981\u4e0d\u53d8\uff0c\u679a\u4e3es\u7684\u5b50\u96c6\uff0c\u8be5\u5b50\u96c6\u5fc5\u987b\u5305\u542bp\n\n\u90a3\u4e48dp[0][s][i]=sigma(dp[1][s'][j]\\*c[i-j][size[s^s']])\n\u5176\u4e2dsize\u4e3a\u4e00\u4e2a\u70b9\u96c6\u4e2d\u8fb9\u7684\u6570\u76ee\n\n\u90a3\u4e48\uff0c\u8fd9\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f\uff0c\u76f8\u5f53\u4e8e\u6211\u4eec\u4f9d\u7167\u70b9p\u5c06\u8fd9\u4e2a\u96c6\u5408\u5256\u4e3a\u4e24\u534a\u4e86\n\u800c\u6211\u4eec\u662f\u5728\u679a\u4e3e\u8fd9\u4e2a\u4e0d\u8054\u901a\u96c6\u5408\u8054\u901a\u5757\u7684\u5927\u5c0f\n\n\u7531\u4e8es^s'\u53ea\u80fd\u5728\u672c\u8eab\u5185\u90e8\u8fde\u8fb9\uff0c\u6240\u4ee5\uff0cs^s'\u4e00\u5b9a\u548cs'\u4e0d\u8054\u901a\uff0c\u6240\u4ee5s\u4e00\u5b9a\u4e0d\u8fde\u901a\uff0c\u800c\u4e14\u56e0\u4e3a\u679a\u4e3e\u6240\u6709\u7684\u201c\u5206\u5272\u7ebf\u201d\u6240\u4ee5\u4e0d\u91cd\u4e0d\u6f0f\u7684\u679a\u4e3e\u4e86\u6240\u6709\u65b9\u6848\n\n\u53e6\u4e00\u4e2a\u6027\u8d28dp[0][i][j]+dp[1][i][j]=c[i][size[j]]\n\n\u8fd9\u4e2a\u4e1c\u897f\u5e94\u8be5\u662f\u663e\u7136\uff1f\u597d\u5427\u8fd8\u662f\u89e3\u91ca\u4e0b\uff1a\u56e0\u4e3a\u5df2\u7ecf\u628a\u95ee\u9898\u8f6c\u5316\u4e3a\u4e86\u4e00\u4e2a\u8fb9\u53ef\u4ee5\u5168\u53d6\u95ee\u9898\uff0c\u4e5f\u5c31\u662f\u8bf4\u5df2\u7ecf\u4e0d\u662f\u6811\u4e86\uff0c\u56e0\u6b64\u8fb9\u53ef\u4ee5\u60f3\u600e\u4e48\u53d6\u5c31\u600e\u4e48\u53d6\uff0c\u9664\u4e86\u8054\u901a\u4e0d\u8054\u901a\u5c31\u6ca1\u6709\u4e86\u522b\u7684\u9650\u5236\uff0c\u56e0\u6b64dp[0]\u4e0edp[1]\u8986\u76d6\u4e86\u6240\u6709\u7684\u7ec4\u5408\u6570\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u6109\u5feb\u7684\u9012\u63a8\u4e86\uff0c\u8fd9\u91cc\u6709\u4e00\u4e2a\u64cd\u4f5c\u662f\u679a\u4e3e\u5b50\u96c6\u7684\uff0c\u5982\u679c\u8981\u679a\u4e3es\u7684\u5b50\u96c6\uff0c\u90a3\u4e48\u53ef\u4ee5\u7528\u8fd9\u6837\u7684\u8bed\u53e5\uff1a\n```C\nfor(int k=(s-1)&s;k>0;k=(k-1)&s);\n```\n\n\u5c31\u53ef\u4ee5\u6109\u5feb\u7684\u679a\u4e3e\u5b50\u96c6\u4e86\n\n\u6700\u540e\uff0c\u662f\u5982\u4f55\u751f\u6210\u7b54\u6848\uff0c\u5f88\u9057\u61be\uff0c\u7b54\u6848\u5e76\u4e0d\u80fd\u7531dp[1]\u5f97\u5230\uff0c\u4e3a\u4ec0\u4e48\uff1f\n\u56e0\u4e3a\u628a\u539f\u95ee\u9898\u53cd\u4e86\u4e00\u4e0b\uff0c\u6211\u4eec\u6c42\u51fa\u6765\u7684\u662f\u6210\u529f\u8054\u901a\u7684\u65b9\u6848\uff0c\u800c\u4e0d\u662f\u4ec0\u4e48\n\u6700\u5c0f\u751f\u6210\u6811\uff0c\u60f3\u5fc5\u8054\u901a\u56fe\u548c\u6811\u4e4b\u95f4\u7684\u5dee\u522b\u8fd8\u662f\u6781\u5927\u7684\n\n\u90a3\u4e48\u4e3a\u4e86\u5f97\u51fa\u7b54\u6848\uff0c\u6211\u4eec\u53ef\u80fd\u4e5f\u8981\u53cd\u4e00\u4e0b\u539f\u95ee\u9898\uff0c\u60f3\u4e00\u4e0b\uff0c\u73b0\u5728\u5c3d\u7ba1\u662f\u65e0\u6761\u4ef6\u52a0\u8fb9\uff0c\u4f46\u662f\u5982\u679c\u5728\u52a0\u7b2cX\u6761\u8fb9\u7684\u65f6\u5019\u521a\u597d\u8054\u901a\u4e86\uff0c\u8fd9\u65f6\u7684\u8054\u901a\u56fe\uff0c\u5bf9\u5e94\u7684\u6700\u5c0f\u751f\u6210\u6811\u6700\u5927\u8fb9\u4e5f\u662fx.\n\n\u4e5f\u662f\u8bf4\uff0c\u8fde\u5230\u7b2cX\u6761\u8fb9\u65f6\u521a\u597d\u8054\u901a\u7684**\u8054\u901a\u56fe**\uff0c\u4e0e\u6700\u5927\u8fb9\u4e3aX\u7684\u6700\u5c0f**\u751f\u6210\u6811**\uff0c**\u4e00\u4e00\u5bf9\u5e94**\n\n\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u8981\u6c42\u6700\u5927\u8fb9\u7684\u671f\u671b\uff1a\n\n1.\u8bbe\u6700\u5927\u8fb9\u4e00\u79cd\u53ef\u80fd\u7684\u6392\u540d\u53d6\u503c\u4e3axi\n\n2.\u8bbe\u67d0\u4e00\u53d6\u503cxi\u51fa\u73b0\u7684\u6982\u7387\u4e3aP(xi)\n\n3.\u8bbex\u7684\u53d6\u503c\u4e0d\u6bd4x0\u5c0f\u7684\u6982\u7387\u4e3ap(x>=x0)\n\n4.\u8bbe\u70b9\u96c6\u7684\u5168\u96c6\u4e3aU\n\n\u90a3\u4e48\u6700\u5927\u8fb9\u7684\u6392\u540d\u7684\u671f\u671b\u5c31\u662f\uff1a\n\nsigma(xi\\*p(xi)) \\[i\u2208(1~m)]\n\n\u5bf9\u4e0a\u8ff0\u5f0f\u5b50\u6c42\u4e00\u4e2a\u524d\u7f00\u548c\uff0c\u4e0a\u5f0f\u7b49\u4ef7\u4e8e(\u4e0d\u80fd\u7406\u89e3\u5c31\u8bb0\u6210\u7ed3\u8bba\u597d\u54af)\n\nsigma(p(x\\>=i))\\[i\u2208(1~m)]\n\n\u53cd\u4e00\u4e0b\uff0c\u7b49\u4ef7\u4e8e\n\nsigma(dp\\[0]\\[i]\\[U]/c\\[i]\\[m]) \\[i\u2208(0~m)]\n\nok\uff0c\u6bd5\u7adf\u53d6\u5230**i\u4e0d\u8fde\u901a**\u7684\u6982\u7387\u662f\u7b49\u4ef7\u4e8e**\u6700\u5927\u8fb9\u5927\u4e8ei**\u6982\u7387\u7684\n\n\u8fd9\u6837\u5c31\u6c42\u51fa\u4e86\u8fb9\u6392\u540d\u7684\u671f\u671b\uff0c\u9664\u4e2am+1\u5c31\u884c\u4e86\n\n\u4e0a\u4ee3\u7801~\n\n```C\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\nusing namespace std;\ntypedef long long ll;\nll dp[2][60][2200];ll size[2200];bool book[2200];\nint n;int m;ll c[60][60];int up;\nint map[20][20];double res;\nint main()\n{\n    scanf(\"%d%d\",&n,&m);up=pow(2,n)-1;\n    for(int i=1;i<=m;i++)\n    {\n        int u;int v;\n        scanf(\"%d%d\",&u,&v);\n        map[u-1][v-1]=1;map[v-1][u-1]=1;//\u7528\u90bb\u63a5\u77e9\u9635\u5b58 \n    }\n    for(int i=1;i<=up;i++)\n    {\n        for(int p1=1;p1<n;p1++)\n        {\n            for(int p2=0;p2<p1;p2++)\n            {\n                size[i]+=((i>>p1)&1)&&((i>>p2)&1)&&map[p1][p2];//\u66b4\u529b\u8ba1\u7b97size \n            }\n        }\n    }\n    c[0][0]=1;\n    for(int j=1;j<=m+1;j++)//\u9012\u63a8\u6768\u8f89\u4e09\u89d2 \n    {\n        c[0][j]=1;\n        for(int i=1;i<j;i++)\n        {\n            c[i][j]=c[i][j-1]+c[i-1][j-1];\n        }\n        c[j][j]=1;\n    }\n    for(int i=0;i<=up;i++){dp[0][0][i]=1;}\n    for(int i=0;i<n;i++){dp[1][0][1<<i]=1;dp[0][0][1<<i]=0;}\n\t//\u8fb9\u754c\u6761\u4ef6,\u663e\u7136\u4e00\u4e2a\u70b9\u662f\u8054\u901a\u7684 \n    for(int i=1;i<=m;i++)\n    {\n        for(int j=1;j<=up;j++)\n        {\n            int p1=0;for(;((j>>p1)&1)==0;p1++);//\u968f\u4fbf\u9009\u4e00\u4e2a\u5256\u5206\u70b9 \n            for(int k=(j-1)&j;k>0;k=(k-1)&j)//\u679a\u4e3e\u5b50\u96c6 \n            {\n                if(((k>>p1)&1)==0)continue;//\u4e0d\u5305\u542b\u5c31\u7b97\u4e86 \n                for(int rk=0;rk<=i;rk++)//\u679a\u4e3e\u8865\u96c6\u53ef\u7528\u7684\u8fb9\u6570 \n                {\n                    dp[0][i][j]+=dp[1][rk][k]*c[i-rk][size[j^k]];\n                }\n            }\n            dp[1][i][j]=c[i][size[j]]-dp[0][i][j];//\u540c\u65f6\u6c42\u51fadp[1] \n        }\n    }\n    for(int i=0;i<=m;i++){res+=(double)dp[0][i][up]/(double)(c[i][m]);}//\u5904\u7406\u51fa\u6982\u7387 \n    printf(\"%lf\",(double)res/(double)(m+1));return 0;//\u62dc\u62dc\u7a0b\u5e8f~ \n}\n```\n\n\n\n",
        "postTime": 1517580167,
        "uid": 56384,
        "name": "shadowice1984",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3343 \u3010[ZJOI2015]\u5730\u9707\u540e\u7684\u5e7b\u60f3\u4e61\u3011"
    },
    {
        "content": "\u5e76\u4e0d\u4f1a\u6253\u6570\u5b66\u516c\u5f0f\u7684\u6211\u745f\u745f\u53d1\u6296\n\n\u9898\u89e3\u7684\u94fe\u63a5\n\n\nhttp://www.cnblogs.com/rrsb/p/8149523.html\n\n\u6570\u5b66\u63a8\u5bfc\u7684\u94fe\u63a5\uff1a\n\nhttps://s1.ax1x.com/2017/12/30/zqSzV.jpg\n\nhttps://s1.ax1x.com/2017/12/30/zbzR0.jpg\n\n\u770b\u5728\u6211\u8db3\u8db3\u5199\u4e86\u4e24\u9875\u7eb8\u7684\u4efd\u4e0a\u8ba9\u6211\u8fc7\u5427\u3002\n",
        "postTime": 1514610620,
        "uid": 53193,
        "name": "\u6b87\u96ea",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3343 \u3010[ZJOI2015]\u5730\u9707\u540e\u7684\u5e7b\u60f3\u4e61\u3011"
    },
    {
        "content": "\u5148\u819c\u62dc\u79ef\u5206\u5927\u4f6c\uff01\n\n------------\n\n\u5c31\u7740\u8fd9\u9053\u9898\u8c08\u4e00\u4e0b\u6211\u505a\u6982\u7387\u671f\u671b\u9898\u7684\u611f\u60f3\u5427\u3002\n\n\u8fd9\u4e4b\u4e2d\u79bb\u4e0d\u5f00\u7684\u5c31\u662f**\u65b9\u6848\u6570**+**\u6982\u7387**+**\u671f\u671b**\n\n\u5927\u5bb6\u90fd\u77e5\u9053 \n\n$$\\text{\u6982\u7387}=\\text{\u65b9\u6848\u6570}/\\text{\u603b\u65b9\u6848\u6570}$$\n\n$$\\text{\u671f\u671b}=\\text{\u6982\u7387}*\\text{\u5bf9\u5e94\u6743}$$\n\n\u5982\u679c\u4e00\u9053\u9898\u52a0\u6a21\u6570\u7684\u8bdd\uff0c\u4e09\u4e2a\u91cf\u53ef\u4ee5\u4e0d\u6389\u7cbe\u5ea6\u5730\u8f6c\u5316\uff0c\u4ee5\u65b9\u4fbf\u6211\u4eec\u7684\u5206\u6790\u3002\n\n(\u6bd4\u5982[\u8fd9\u9053\u9898](https://www.luogu.org/problemnew/show/P3600))\n\n\u56de\u5230\u672c\u9898\u7684\u5e73\u6c11\u505a\u6cd5\uff0c\u6211\u4eec\u77e5\u9053\u8981\u6c42\u7684\u662f\u6700\u5c0f\u751f\u6210\u6811\u4e0a\u8fb9\u7684\u6700\u5927\u503c\u7684\u671f\u671b\u3002\n\n\u8fd9\u4e1c\u897f\u4e00\u770b\u5c31\u5f88\u4e0d\u597d\u6c42\uff0c\u800c\u4e14\u8fb9\u7684\u6743\u90fd\u4e0d\u662f\u79bb\u6563\u7684\uff0c\u800c\u662f$[0,1]$\u4ee5\u5185\u7684\u968f\u673a\u5b9e\u6570\uff0c\u8fd9\u5c31\u5f88\u4e0d\u65b9\u4fbf\u5904\u7406\u3002\n\n\n\u9898\u76ee\u5f88\u826f\u5fc3\uff0c\u6709\u4e00\u4e2a\u63d0\u793a\uff1a\n\n```cpp\n\u5bf9\u4e8en\u4e2a[0,1]\u4e4b\u95f4\u7684\u968f\u673a\u53d8\u91cfx1,x2,...,xn\uff0c\u7b2ck\u5c0f\u7684\u90a3\u4e2a\u7684\u671f\u671b\u503c\u662fk/(n+1)\n````\n\n\u8fd9\u8ba9\u6211\u4eec\u60f3\u5230**\u628a\u671f\u671b\u8f6c\u5316\u6210\u6392\u540d\u7684\u671f\u671b**\uff0c\u8fd9\u6837\u5b50\u5c31\u80fd\u5316\u8fde\u7eed\u4e3a\u79bb\u6563\uff08\u4e00\u822c\u6765\u8bb2\uff0c\u8fd9\u53ef\u4ee5\u4f7f\u95ee\u9898\u53d8\u7b80\u5355\uff0c\u5728P3600\u91cc\u9762\u4e5f\u6709\u8fd9\u6837\u7684\u7ec6\u8282\uff09\u3002\n\n\u73b0\u5728\u4e3b\u8981\u7684\u590d\u6742\u70b9\u5c31\u5728\u4e8e**\u6700\u5c0f\u751f\u6210\u6811**,\u8fd9\u662f\u4e2a\u5f88\u590d\u6742\u7684\u4e1c\u897f\uff0c\u6211\u4eec\u60f3\u65b9\u8bbe\u6cd5\u6316\u6398\u672c\u8d28\uff0c\u5c06\u5b83\u53d8\u7b80\u5355\u3002\n\n**\u5047\u8bbe\u4f60\u77e5\u9053\u4e86\u8fb9\u7684\u6392\u540d**\uff0c\u7136\u540e\u5728\u8dd1\u514b\u9c81\u65af\u5361\u5c14\u3002\n\n\u4f60\u4f1a\u4e00\u6761\u4e00\u6761\u5730\u52a0\u8fb9\uff0c\u7136\u540e\u5224\u65ad\u662f\u5426\u751f\u6210\u4e86\u6811\u3002\n\n\u7b54\u6848\u5c31\u662f\u6700\u540e\u52a0\u5165\u7684\u90a3\u4e00\u6761\u8fb9\u7684\u6392\u540d\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u6709\u4e86\u7b2c\u4e00\u4e2a\u7b97\u6cd5\uff1a\n\n```cpp\n\u679a\u4e3e\u8fb9\u7684\u6392\u540d\uff0c\u7136\u540e\u8dd1\u514b\u9c81\u65af\u5361\u5c14\u3002\n\n\u5f97\u5230\u6392\u540d\u7684\u671f\u671b\uff0c\u518d\u9664\u4ee5(m+1)\u5f97\u5230\u7b54\u6848\u3002\n\n\u590d\u6742\u5ea6O(m*m!)\u636e\u8bf4\u5206\u6570\u53ef\u89c2\u3002\n```\n\n\u6211\u4eec\u8003\u8651\u201c\u751f\u6210\u4e86\u6811\u201d\u7684\u672c\u8d28\u662f\u4ec0\u4e48\uff0c\u5728\u514b\u9c81\u65af\u5361\u5c14\u4e2d\uff0c\u5c31\u662f\u628an\u4e2a\u70b9\u90fd\u8054\u901a\u4e86\u8d77\u6765\u3002\n\n**\u4e00\u4e2a\u6700\u5c0f\u751f\u6210\u6811\u5185\u6700\u5927\u7684\u8fb9\u6392\u540d\u4e3ax\u7684\u6982\u7387=\u7528k\u6761\u8fb9\u6070\u597d\u8054\u901a\u6574\u4e2a\u56fe\u7684\u6982\u7387**\uff08\u8fd9\u4e2a\u5f88\u597d\u7406\u89e3\u5427\uff09\n\n\u6839\u636e\u671f\u671b\u7684\u5b9a\u4e49\uff0c\u6392\u540d\u7684\u671f\u671b=$\\sum P(x)*x$\n\n\u5176\u4e2d$P(x)$\u662f\u7528k\u6761\u8fb9**\u6070\u597d**\u8054\u901a\u6574\u4e2a\u56fe\u7684\u6982\u7387\u3002\n\n**\u6070\u597d**\u7684\u610f\u601d\u662f\uff0c\u6ca1\u6709\u7b2ck\u6761\u8fb9\u7684\u65f6\u5019\uff0c\u4e0d\u8fde\u901a\uff0c\u52a0\u4e00\u6761\u8fb9\u5c31\u8054\u901a\u4e86\u3002\n\n\u8fd9\u4e2a\u9650\u5236\u4ee4\u4eba\u5934\u75bc\uff0c\u6211\u4eec\u628a\u5b83**\u524d\u7f00\u548c**\u4e00\u4e0b\uff08P3600\u91cc\u9762\u4e5f\u6709\u7c7b\u4f3c\u5957\u8def\uff09\n\n\u5f97\u5230$P'(x)=\\sum\\limits_{i=0}^nP(x)$\n\n\u6839\u636e\u4eba\u7c7b\u667a\u6167$P(x)'$=\u4e00\u6761\u8fb9\u8054\u901a\u5168\u56fe\u7684\u6982\u7387+\u4e8c\u6761\u8fb9\u8054\u901a\u5168\u56fe\u7684\u6982\u7387+...=**\u7528\u6392\u540d\u524dk\u7684\u8fb9\u8054\u901a\u6574\u4e2a\u56fe\u7684\u6982\u7387**\u3002\n\n\uff08\u4ed4\u7ec6\u4f53\u5473$P(x)$\u548c$P'(x)$\u7684\u4e0d\u540c\uff09\u3002\n\n\u7136\u540e\u56e0\u4e3a\u524d\u7f00\u548c,$P(x)'-P'(x-1)=P(x)$\n\n\u6211\u4eec\u53ea\u8981\u60f3\u529e\u6cd5\u5f04\u51fa$P'(x)$\u5c31\u597d\u4e86\u3002\n\n**\u81f3\u6b64\uff0c\u95ee\u9898\u5df2\u7ecf\u53d8\u6210\u4e86\u56fe\u7684\u8054\u901a\u6027\u95ee\u9898\uff08\u8fb9\u7684\u9009\u53d6\u95ee\u9898\uff09\u3002**\n\n\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c\u8fd9\u73a9\u610f\u600e\u4e48\u6c42\uff1f\n\n\u5982\u679c\u4e00\u9053\u9898\u52a0\u6a21\u6570\u7684\u8bdd\uff0c\u4e09\u4e2a\u91cf\u53ef\u4ee5\u4e0d\u6389\u7cbe\u5ea6\u5730\u8f6c\u5316\uff0c\u4ee5\u65b9\u4fbf\u6211\u4eec\u7684\u5206\u6790\u3002\n\n\u8fd9\u9053\u9898\u6ca1\u52a0\u6a21\u6570\uff0c\u4e0d\u4ee3\u8868\u6211\u4eec\u4e0d\u80fd\u8f6c\u5316\uff0c\u6211\u4eec\u8003\u8651**\u8f6c\u5316\u6210\u65b9\u6848\u6570**\u3002\n\n\u65b9\u6848\u6570\u4f1a\u4e0d\u4f1a\u7206long long\uff0c\u56e0\u4e3a\u6700\u591a\u53ea\u6709$45$\u6761\u8fb9\uff0c\u6700\u591a\u5c31\u662f$C_{45}^{23}=4116715363800$,\u7a33\u5f97\u4e00\u6279\u3002\n\n\u8fd9\u91cc\u6211\u4eec\u91c7\u7528dp\u6c42\u65b9\u6848\u6570\u3002\n\n\u8bbe$f[i][s]$\u8868\u793a\u4f7f\u7528$i$\u6761\u8fb9\u8054\u901a\u4e86s\u8fd9\u4e2a\u96c6\u5408\u7684\u65b9\u6848\u6570\u3002\n\n\u60f3\u4e86\u60f3\u53d1\u73b0\u4e0d\u53ef\u505a\u3002\n\n\u4e8e\u662f\u91c7\u7528\u6b63\u96be\u5219\u53cd\uff0c\u8fd9$g[i][s]$\u8868\u793a\u4f7f\u7528$i$\u6761\u8fb9\u6ca1\u6709\u8054\u901as\u8fd9\u4e2a\u96c6\u5408\u7684\u65b9\u6848\u6570\u3002\n\n\u6211\u4eec\u8bbe$c[x][y]$\u8868\u793a$C_x^y$(\u6ce8\u610f\u8c01\u5728\u4e0b\u9762),\u8bbe$siz[s]$\u8868\u793a\u70b9\u96c6$s$\u5185\u90e8\u6709\u591a\u5c11\u8fb9\u3002\n\n\u4e00\u4e2a\u5f88\u597d\u7406\u89e3\u7684\u4e1c\u897f$c[siz[s]][i]=g[i][s]+f[i][s]$\uff0c\u56e0\u4e3a$g$\u548c$f$\u7ec4\u6210\u4e86\u6240\u6709\u9009\u53d6\u7684\u65b9\u6cd5\u3002\n\n\u6211\u4eec\u8003\u8651\u5982\u4f55\u8f6c\u79fb\u51fa$g[i][s]$\uff1a\n\n\u6211\u81ea\u7136\u5730\u60f3\u5230\u4e86**\u679a\u4e3e\u5b50\u96c6**\uff0c\u628a$s$\u533a\u5206\u6210\u4e86\u4e24\u4e2a\u771f\u5b50\u96c6s1,s2(\u5373\u4e0d\u80fd\u679a\u4e3e\u7a7a\u96c6)\u3002\n\n\uff08\u5982\u679c\u6ca1\u542c\u8bf4\u8fc7**\u679a\u4e3e\u5b50\u96c6**\u7684\u8bdd\u5efa\u8bae\u4e0a\u7f51\u67e5\u4e00\u4e0b\uff0c\u6216\u8005\u53bb\u505aP3959\uff09\n\n\u90a3\u4e48\uff0c\u5fc5\u987b\u4ee4\u8fd9s\u4e0d\u8fde\u901a\uff0c\u90a3\u597d\u529e\uff0c\u76f4\u63a5**\u4ee4\u8fd9s1,s2\u4e4b\u95f4\u6ca1\u6709\u8fb9**\u3002\n\n\u90a3\u4e48s1,s2\u5185\u90e8\u5c31\u53ef\u4ee5\u968f\u4fbf\u8fde\u3002\n\n\u8fd9\u6837\u80af\u5b9a\u662f\u4e0d\u4f1a\u7b97\u6f0f\uff0c\u4f46\u4f1a\u91cd\u590d\u3002\n\n```cpp\n\u7b2c\u4e00\u6b21\u5206\u5272\n1 #  2\n  # \n###  3\n\u6839\u636e\u4efb\u610f\u8fde\u8fb9\uff0c\u6240\u6709\u70b9\u4e4b\u95f4\u90fd\u4e0d\u8fde\u8fb9\u7684\u65b9\u6848\u9002\u5408\u8fd9\u4e2a\u5206\u5272\u7ebf\n\n\u7b2c\u4e8c\u6b21\u5206\u5272\n1 #  2\n  ####\n    3\n\u6839\u636e\u4efb\u610f\u8fde\u8fb9\uff0c\u6240\u6709\u70b9\u4e4b\u95f4\u90fd\u4e0d\u8fde\u8fb9\u7684\u65b9\u6848\u4e5f\u9002\u5408\u8fd9\u4e2a\u5206\u5272\u7ebf\n\n\u5f88\u660e\u663e\u5b58\u5728\u91cd\u590d\u8ba1\u7b97\n```\n\n\u4e4b\u6240\u4ee5\u4f1a\u5b58\u5728\u91cd\u590d\u8ba1\u7b97\uff0c\u662f\u56e0\u4e3a\u5206\u5272\u7ebf\u53ef\u80fd\u4f1a**\u91cd\u590d\u7a7f\u8fc7**\u201c\u968f\u4fbf\u8fde\u201d\u7684\u90e8\u5206\u3002\n\n\u6211\u4eecdp\u51fa\u4e86$f$\u6570\u7ec4\uff0c\u73b0\u5728\u53ef\u4ee5\u62ff\u6765\u7528\uff0c\u6211\u4eec\u89c4\u5b9as1\u5185\u5fc5\u987b\u8054\u901a\uff0cs2\u5185\u53ef\u4ee5\u968f\u4fbf\u3002\n\n\u8fd9\u6837\u5b50\uff0c\u5206\u5272\u7ebf\u5c31\u4e0d\u4f1a\u518d\u6b21\u7a7f\u8fc7s1\uff08\u56e0\u4e3a\u5176\u5185\u90e8\u8054\u901a\uff09\n\n\u73b0\u5728\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679cs1\u4e0es2\u8c03\u6362\uff0c\u8fd8\u662f\u4f1a\u5b58\u5728\u91cd\u590d\u7b97\u7684\u60c5\u51b5(\u5fc5\u987b\u8054\u901a\u2208\u968f\u4fbf\u8fde)\n\n\u6240\u4ee5\u5f53\u6211\u4eec\u679a\u4e3e\u8fc7\u67d0\u4e2as1\u65f6\uff0c**\u5c31\u4e0d\u80fd\u518d\u6b21\u679a\u4e3e\u5b83\u7684\u8865\u96c6**\u4f5c\u4e3as1\u3002\n\n\u8fd9\u91cc\u6709\u4e2a\u975e\u5e38\u8111\u6d1e\u7684\u64cd\u4f5c,\u968f\u4fbf\u94a6\u70b9\u4e00\u4e2as\u5185\u7684\u70b9p\uff0c\u4ee4s1\u5fc5\u987b\u5305\u542bp\uff0c\u8fd9\u6837\u5b50\uff0c\u679a\u4e3e\u8fc7\u7684s1\u7684\u8865\u96c6\u5fc5\u7136\u4e0d\u5305\u542bp\uff0c\u4e5f\u5c31\u88ab\u6392\u9664\u5728\u5916\u4e86\u3002\n\n\u7406\u89e3\u4e86\u8fd9\u4e9b(\u5efa\u8bae\u7ed3\u5408\u5176\u4ed6\u9898\u89e3\u7406\u89e3\u8fd9\u4e2a\uff0c**\u771f\u7684\u4e0d\u597d\u61c2**)\u5c31\u597d\u529e\u4e86\uff0c\u4e0b\u9762\u662fdp\u7684\u4ee3\u7801\u4e0e\u8be6\u7ec6\u6ce8\u91ca\uff1a\n\n```cpp\nlong long f[50][1200],g[50][1200],c[50][50];\n//f:\u8054\u901a; g:\u4e0d\u8fde\u901a; c:\u7ec4\u5408\u6570; \nint siz[1200];\n//siz:\u67d0\u70b9\u96c6\u5185\u8fb9\u7684\u6570\u91cf;\nbool e[12][12];\n//e:\u90bb\u63a5\u77e9\u9635;\n\n  for (int s=0;s<=limit;s++)g[0][s]=1;\n  for (int i=0;i<n;i++)\n   {f[0][1<<i]=1;g[0][1<<i]=0;}\n  //\u6839\u636e\u201c\u4e00\u4e2a\u70b9\u81ea\u8eab\u662f\u8054\u901a\u7684\u201d\u6765\u521d\u59cb\u5316\n  for (int s=0;s<=limit;s++)\n   for (int i=0;i<n;i++)\n  \tfor (int j=i+1;j<n;j++)\n  \t if (e[i][j]&&((1<<i)&s)&&((1<<j)&s))\n  \t  siz[s]++;\n  //\u6c42\u89e3siz\n  for (int i=0;i<=m;i++){\n    c[i][0]=1;\n    for (int j=1;j<=i;j++)\n     c[i][j]=c[i-1][j]+c[i-1][j-1];\n  }//\u9884\u5904\u7406\u7ec4\u5408\u6570\n  for (int i=1;i<=m;i++)\n   for (int s=1;s<=limit;s++){\n   \t int p=0;\n   \t for (;((1<<p)&s)==0;p++);\n    //\u5bfb\u627e\u4e00\u4e2as\u5185\u7684\u70b9(s\u5fc5\u7136\u4e0d\u4e3a\u7a7a\u96c6)\n   \t for (int k=(s-1)&s;k;k=(k-1)&s)\n   \t  if ((1<<p)&k){\n      //\u8fd9\u91cc\u8fd8\u8981\u679a\u4e3e\u5206\u7ed9\u4e24\u4e2a\u5b50\u96c6\u5404\u591a\u5c11\u6761\u8fb9\n   \t   for (int j=0;j<=i;j++)\n   \t    g[i][s]+=f[j][k]*c[siz[s^k]][i-j];\n        //\u5982\u4e0a\u6587\uff0c\u4e00\u90e8\u5206\u968f\u4fbf\u9009\uff0c\u4e00\u90e8\u5206\u5fc5\u987b\u8054\u901a\n   \t  }\n   \t f[i][s]=c[siz[s]][i]-g[i][s];\n     //\u6839\u636ec[siz[s]][i]=g[i][s]+f[i][s]\u6c42\u51faf[i][s]\n   }\n```\n\n\u81f3\u6b64\uff0cdp\u7684\u90e8\u5206\u5c31\u8bb2\u5b8c\u4e86\uff0c\u6211\u4eec\u56de\u5230\u6982\u7387$P'(x)$\u4e0a\u6765\u3002\n\n$P(x)'$=\u4e00\u6761\u8fb9\u8054\u901a\u5168\u56fe\u7684\u6982\u7387+\u4e8c\u6761\u8fb9\u8054\u901a\u5168\u56fe\u7684\u6982\u7387+...=**\u7528\u6392\u540d\u524dk\u7684\u8fb9\u8054\u901a\u6574\u4e2a\u56fe\u7684\u6982\u7387**\u3002\n\n\u5c31\u662f$P(x)'=\\dfrac{f[x][\\text{\u5168\u96c6}]}{c[m]][x]}$\n\n\u4ee3\u7801\n\n```cpp\ndouble p[50],p2[50];\n\n  double ans=0;\n  for (int i=0;i<=m;i++)\n  \tp2[i]=(double)f[i][limit]/(double)c[m][i];\n  //\u8ba1\u7b97p'\n  for (int i=0;i<=m;i++)p[i]=p2[i]-p2[i-1];\n  //\u8ba1\u7b97p\n  for (int i=0;i<=m;i++)ans+=p[i]*i;\n  //\u8ba1\u7b97\u6392\u540d\u7684\u671f\u671b\n  printf(\"%.6lf\",ans/(m+1));\n  //\u5f97\u5230\u6700\u5927\u8fb9\u7684\u671f\u671b\n```\n\n[$AC$\u8bb0\u5f55](https://www.luogu.org/record/show?rid=17237986)",
        "postTime": 1552630173,
        "uid": 58705,
        "name": "command_block",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P3343 \u3010[ZJOI2015]\u5730\u9707\u540e\u7684\u5e7b\u60f3\u4e61\u3011"
    },
    {
        "content": "\u4e8b\u5b9e\u4e0a\uff0c\u95ee\u9898\u5c31\u662f\u6c42\u51fa$i$\u6761\u8fb9\u8fde\u901a\u56fe\u7684\u4e2a\u6570\u3002\n\u505a\u6cd5\u5f88\u591a,\n\n\u8003\u8651\u65af\u7279\u6797\u53cd\u6f14\uff1a\n\u6211\u4eec\u8bb0$f_{s,j,k}$\u8868\u793a$s$\u52a0\u5165\u4e86$j$\u6761\u8fb9\u6709$k$\u4e2a\u8054\u901a\u5757\u7684\u65b9\u6848\u6570\u3002\n$g_{s,j,k}$\u8868\u793a\u81f3\u5c11\u6709$k$\u4e2a\u8054\u901a\u5757\u3002\n\n\u663e\u7136\u6ee1\u8db3$g_{s,j,k}=\\sum_{l}f_{s,j,l} \\begin {Bmatrix} l \\\\k \\end {Bmatrix}$\n\u6240\u4ee5\u5f97\u5230$f_{s,j,k}=\\sum_{l}g_{s,j,l}(-1)^{l-k} \\begin {bmatrix} l \\\\k \\end {bmatrix}$\n\n\n\u8003\u8651$g$\u662f\u53ef\u4ee5\u5148\u7b97\u51fa$h_{s,k,m}$\u8868\u793a\u6211\u4eec\u5c06$s$\u5212\u5206\u6210$m$\u5757\uff0c\u6bcf\u4e2a\u5757\u5185\u90e8\u4e00\u5171\u6709$k$\u6761\u8fb9\uff0c\u663e\u7136$g_{s,j,m}=\\sum_{k}h_{s,k,m}\\binom{k}{j}$\n\n\u8fd9\u6837\u8f6c\u79fb\u5c31\u5f88\u65b9\u4fbf\u4e86\u3002\n\u8003\u8651\u6b64\u65f6$h_{s,j,k}$\u53ef\u4ee5\u76f4\u63a5\u679a\u4e3e\u5f53\u524d\u548c\u6700\u5c0f\u6807\u53f7\u70b9\u7684\u96c6\u5408\u6765\u8f6c\u79fb\u3002\n\u4f46\u8fd9\u4e2a\u7ec8\u7a76\u8fd8\u662f\u8981\u679a\u4e3e\u8054\u901a\u5757\u4e2a\u6570\uff0c\u4e0d\u592a\u4f18\u79c0\u3002\n\n\u6ce8\u610f\u5230\u672c\u9898\u9700\u8981\u6c42\u51fa$f_{s,m,1}=\\sum_{l}g_{s,m,l}(-1)^{l-1}(l-1)!$\n\n\u5bb9\u65a5\u7cfb\u6570\u6211\u4eec\u662f\u53ef\u4ee5\u5f04\u5230$dp$\u91cc\u9762\u7684\uff1a$f_{s,m,1}=\\sum_{l}\\sum_{k} h_{s,k,l} \\binom{k}{m}(-1)^{l-1}(l-1)!$\n\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5$dp_{s,k}=\\sum_{l}h_{s,k,l}(-1)^{l-1}(l-1)!$\n\u8fd9\u4e2a\u8f6c\u79fb\u9664\u4e86\u6700\u540e\u4e00\u6b21\u7279\u6b8a\u5904\u7406\uff0c\u5176\u4ed6\u7684\u66b4\u529b\u679a\u4e3e\u7b2c$l$\u6b21\u52a0\u5165\u7684\u662f\u54ea\u4e2a\u5b50\u96c6\u5c31\u884c\u4e86\u3002\n\n\u590d\u6742\u5ea6\u662f$3^n m$",
        "postTime": 1594004754,
        "uid": 83387,
        "name": "Ymiracle",
        "ccfLevel": 0,
        "title": "[ZJOI2015]\u5730\u9707\u540e\u7684\u5e7b\u60f3\u4e61"
    },
    {
        "content": "\u9898\u76ee\u770b\u5b8c\u4e4b\u540e\u5c31\u77e5\u9053\u4e0d\u4f1a\u505a\u3002\n\n\u7136\u540e\u9898\u76ee\u7684\u63d0\u793a\u5341\u5206\u91cd\u8981\uff1a**\u5bf9\u4e8e n \u4e2a [0,1] \u4e4b\u95f4\u7684\u968f\u673a\u53d8\u91cf x1,x2,...,xn\uff0c\u7b2ck\u5c0f\u7684\u90a3\u4e2a\u7684\u671f\u671b\u503c\u662f k/(n+1)\u3002**\n\n\u5047\u8bbe\u6211\u4eec\u77e5\u9053 $m$ \u6761\u8fb9\u7684\u6743\u503c\uff0c\u6211\u4eec\u505a\u4e00\u904d**\u514b\u9c81\u65af\u5361\u5c14**\u6700\u5c0f\u751f\u6210\u6811\u3002\u7b54\u6848\u5c31\u662f\u6700\u5c0f\u751f\u6210\u6811\u4e2d\u7684\u8fb9\u6743\u6700\u5927\u503c\u3002\u4e5f\u5c31\u662f\u52a0\u5165\u540e**\u6070\u597d**\u4f7f\u56fe\u8054\u901a\u7684\u8fb9\u6743\u3002\n\n\u6839\u636e\u9898\u76ee\u7684\u63d0\u793a\uff1a\u672c\u9898\u7684\u7b54\u6848\u5c31\u662f\u6700\u5c0f\u751f\u6210\u6811\u7684\u6700\u5927\u8fb9\u6743\u5728 $m$ \u6761\u8fb9\u4e2d\u7684\u671f\u671b\u6392\u540d$/ (m+1)$\u3002\n\n\u6240\u4ee5\u73b0\u5728\u5c31\u662f\u8981\u6c42**\u6700\u5c0f\u751f\u6210\u6811\u7684\u6700\u5927\u8fb9\u6743\u5728 m \u6761\u8fb9\u4e2d\u7684\u671f\u671b\u6392\u540d**\u3002\n\n\u7136\u540e\u56e0\u4e3a\u671f\u671b\u7684\u7ebf\u6027\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u751f\u6210\u6811\u4e2d\u6700\u5927\u8fb9\u5728 $m$ \u6761\u8fb9\u4e2d\u7684\u6392\u540d $i$ \u518d\u4e58\u4e0a\u6700\u5927\u8fb9\u5728 $m$ \u6761\u8fb9\u4e2d\u7684\u6392\u540d\u4e3ai\u7684\u6982\u7387 $P(i)$ \u3002\u4e5f\u53ef\u4ee5\u8bf4\u662f\u52a0\u5165\u7b2c $i$ \u6761\u8fb9\u8fd9\u4e2a\u56fe\u521a\u597d\u8054\u901a\u7684\u6982\u7387\u3002\n\u5c31\u662f\uff1a\n$$ans=\\frac{1}{m+1}\\sum_{i=1}^{m}i*P(i)$$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u548c\u4e0b\u9762\u7684\u5f0f\u5b50\u7b49\u4ef7\u3002\n\n$$ans=\\frac{1}{m+1}\\sum_{i=1}^{m}\\sum_{j=i}^{m}P(j)$$\n\n\u8003\u8651$\\sum_{j=i}^{n}P(j)$\u662f\u4ec0\u4e48\uff1f\u5176\u5b9e\u5c31\u662f\u52a0\u5165 $i-1$ \u6761\u8fb9\u56fe\u4e0d\u8fde\u901a\u7684\u6982\u7387\u3002\n\n\u6240\u4ee5\u95ee\u9898\u8f6c\u5316\u4e3a\u6c42\u52a0\u5165 $x$ \u6761\u8fb9\u56fe\u4e0d\u8fde\u901a\u7684\u6982\u7387\u3002\n\n\u7136\u540e\u8fd9\u4e2a\u6982\u7387\u663e\u7136\u7b49\u4e8e\u52a0\u5165x\u6761\u8fb9\u56fe\u4e0d\u8fde\u901a\u7684\u65b9\u6848\u6570$/$\u603b\u65b9\u6848\u6570\u3002\n\n\u56e0\u4e3a\u603b\u65b9\u6848\u6570\u597d\u6c42\u5c31\u662f$C_m^x$\n\n\u6240\u4ee5\u95ee\u9898\u53c8\u8f6c\u5316\u4e3a\u52a0\u5165 $x$ \u6761\u8fb9\u56fe\u4e0d\u8fde\u901a\u7684\u65b9\u6848\u6570\u3002\n\n\u8003\u8651\u7528\u72b6\u538bDP\u89e3\u51b3\u3002\n\n$dp[i][j][0/1]$ \u5206\u522b\u4ee3\u8868\u9009\u4e86\u5728\u70b9\u96c6 $i$ \u7684\u751f\u6210\u5b50\u56fe\u4e2d\u9009\u4e86 $j$ \u6761\u8fb9\u4e0d\u8fde\u901a$/$\u8fde\u901a\u7684\u65b9\u6848\u6570\u3002\n\n$dp[i][j][0]$ \u5957\u8def\u6c42\u6cd5\uff0c\u8bbe\u5b9a\u4e00\u4e2a\u5173\u952e\u70b9\uff0c\u679a\u4e3e\u5173\u952e\u70b9\u6240\u5728\u7684\u8fde\u901a\u5b50\u96c6 $k$\uff0c\u548c\u5b50\u96c6 $k$ \u7684\u751f\u6210\u5b50\u56fe\u4e2d\u7684\u8fb9\u6570 $s$\uff0c\u8bbe $size[i]$\u4e3a\u70b9\u96c6 $i$ \u4e2d\u7684\u8fb9\u7684\u6570\u91cf\uff0c\u8f6c\u79fb\u65b9\u7a0b\u4e3a$dp[i][j][0]=dp[k][s][1]*C_{size[i\\ xor \\ k]}^{j-s}$\u3002\n\n\u5229\u7528$dp[i][j][0]+dp[i][j][1]=C_{size[i]}^{j}$\u5c31\u53ef\u4ee5\u6c42\u51fa $dp[i][j][1]$ \u3002\n\n\u6700\u540e\n$$ans=\\frac{1}{m+1}\\sum_{i=0}^{m}\\frac{dp[(1<<n)-1][m][0]}{C_m^i}$$\n\n```cpp\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\nusing namespace std;\n#define int long long\nint dp[1111][111][2],n,m,u[111],v[111],C[111][111],size[1111];\ndouble ans;\nint read(){\n\tint sum=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){sum=sum*10+ch-'0';ch=getchar();}\n\treturn sum*f;\n}\nsigned main(){\n\tn=read();m=read();\n\tfor(int i=1;i<=m;i++)u[i]=read(),v[i]=read();\n\tfor(int i=0;i<(1<<n);i++)\n\t\tfor(int j=1;j<=m;j++)\n\t\t\tif((i&(1<<(u[j]-1)))&&(i&(1<<(v[j]-1))))size[i]++;\n\tfor(int i=0;i<=m;i++)C[i][0]=1;\n\tfor(int i=1;i<=m;i++)\n\t\tfor(int j=1;j<=m;j++)\n\t\t\tC[i][j]=C[i-1][j-1]+C[i-1][j];\n\tfor(int i=0;i<(1<<n);i++){\n\t\tint p=i&(-i);\n\t\tfor(int j=(i-1)&i;j;j=(j-1)&i){\n\t\t\tif((j&p)==0)continue;\n\t\t\tfor(int a=0;a<=size[j];a++)\n\t\t\t\tfor(int b=0;b<=size[j^i];b++)\n\t\t\t\t\tdp[i][a+b][0]+=dp[j][a][1]*C[size[i^j]][b];\n\t\t}\n\t\tfor(int a=0;a<=size[i];a++)dp[i][a][1]=C[size[i]][a]-dp[i][a][0];\n\t}\n\tfor(int i=0;i<m;i++)ans+=1.0*dp[(1<<n)-1][i][0]/C[m][i];\n\tprintf(\"%.6lf\",1.0*ans/(m+1.0));\n\treturn 0;\n}\n```\n\n```",
        "postTime": 1553516128,
        "uid": 52173,
        "name": "xudaxia",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3343 \u3010[ZJOI2015]\u5730\u9707\u540e\u7684\u5e7b\u60f3\u4e61\u3011"
    },
    {
        "content": "\u6765\u70b9\u4e0d\u9700\u8981\u8111\u5b50\u7684~~\u9700\u8981\u5438\u6c27\u624d\u80fd\u8fc7\u4e14\u6210\u529f\u593a\u5f97 Luogu \u7b2c\u4e8c\u52a3\u89e3~~\u96c6\u5408\u5212\u5206 dp \u505a\u6cd5\u3002\n\n\u4e0d\u96be\u53d1\u73b0\u9898\u76ee\u60f3\u8ba9\u6211\u4eec\u6c42\u51fa**\u8fb9\u4ee5\u4efb\u610f\u65b9\u5f0f\u6392\u5217\u65f6\uff0c\u4f9d\u6b21\u52a0\u8fb9\u4f7f\u5f97\u56fe\u8054\u901a\u7684\u7b2c\u4e00\u4e2a\u65f6\u523b\u9664\u4ee5 $m + 1$ \u7684\u671f\u671b**\u3002\n\n\u6ce8\u610f\u5230 $n$ \u975e\u5e38\u5c0f\uff0c\u8003\u8651\u5bf9\u8fde\u901a\u6027\u72b6\u538b\u3002\u8bbe $dp_{i, S}$ \u8868\u793a $i$ \u65f6\u523b\u65f6\u8fde\u901a\u6027\u4e3a $S$ \u7684\u6982\u7387\u3002\u4e0d\u96be\u53d1\u73b0\u8fd9\u4e2a dp \u7684\u72b6\u6001\u6570\u662f $O(m B_n)$ \u7684\uff0c\u5176\u4e2d $B_n$ \u8868\u793a\u7b2c $n$ \u4e2a\u8d1d\u5c14\u6570\u3002\n\n\u6211\u4eec\u5e0c\u671b\u77e5\u9053\u7684\u662f\uff1a$\\dfrac{\\displaystyle\\sum_{i = 0}^m \\frac{i dp_{i, \\{\\{1, 2, \\cdots, n\\}\\}}}{(m - i)!}}{m! (m + 1)}$\uff08\u6ce8\u610f\uff1a\u4e00\u4e2a $dp_{i, \\{\\{1, 2, \\cdots, n\\}\\}}$ \u4e0d\u80fd\u518d\u5411 $i + 1$ \u8f6c\u79fb\uff09\u3002\n\n\u521d\u503c\uff1a$dp_{0, \\{\\{1\\}, \\{2\\}, \\cdots, \\{n\\}\\}} = 1$\u3002\n\n\u8f6c\u79fb\u5206\u4e3a\u4e24\u79cd\u3002\n\n1. \u4e0d\u6539\u53d8\u8fde\u901a\u6027\n\n\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e8e\u6bcf\u4e2a\u8fde\u901a\u5757\uff0c\u9884\u5904\u7406\u51fa\u5f53\u524d\u8fde\u901a\u5757\u5185\u7684\u8fb9\u6570\uff08\u8bb0\u4e3a $f(S)$\uff09\u3002\n\n\u4e8e\u662f\u6211\u4eec\u76f4\u63a5 $dp_{i + 1, S} \\leftarrow dp_{i + 1, S} + dp_{i, S} \\displaystyle\\sum_{x \\in S} f(x)$ \u5373\u53ef\u3002\n\n2. \u6539\u53d8\u8fde\u901a\u6027\n\n\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u679a\u4e3e\u4e00\u6761\u8fde\u63a5\u5f53\u524d\u4e24\u4e2a\u8fde\u901a\u5757\u7684\u8fb9\uff0c\u5f53\u7136\u8981\u9884\u5904\u7406\u8fde\u901a\u5757\u95f4\u7684\u8fb9\u6570\uff08\u8bb0\u4e3a $g(S, T)$\uff09\u3002\n\n\u4e8e\u662f\u6211\u4eec\u76f4\u63a5 $dp_{i + 1, S - \\{x\\} - \\{y\\} + \\{x \\cup y\\}} \\leftarrow dp_{i + 1, S - \\{x\\} - \\{y\\} + \\{x \\cup y\\}} + dp_{i, S} g(x, y)$ \u5373\u53ef\uff0c\u5176\u4e2d $x, y \\in S$ \u4e14 $x \\neq y$\u3002\u8fd9\u91cc\u6211\u4eec\u9700\u8981\u9884\u5904\u7406\u51fa\u6240\u6709\u8f6c\u79fb\u4ee5\u4fdd\u8bc1\u65f6\u95f4\u590d\u6742\u5ea6\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^3 B_n)$\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <iostream>\n#include <algorithm>\n#include <map>\n#include <vector>\n#include <cstdio>\n\nusing namespace std;\n\nint cnt = 0;\nint a[47], b[47], inside[1027], connect[1027][1027], sum[115977];\ndouble fac[47], dp[47][115977];\nmap<vector<int>, int> mp;\nvector<int> v1, v2, v3[115977];\nvector<pair<int, int> > v4[115977];\n\ninline void init(int n){\n\tfac[0] = 1.0;\n\tfor (register int i = 1; i <= n; i++){\n\t\tfac[i] = fac[i - 1] * i;\n\t}\n}\n\nvoid dfs(int cur, int n, vector<int> v){\n\tif (cur > n){\n\t\tsort(v.begin(), v.end());\n\t\tif (!mp.count(v)){\n\t\t\tint size = v.size();\n\t\t\tcnt++;\n\t\t\tv3[cnt] = v;\n\t\t\tmp[v] = cnt;\n\t\t\tfor (register int i = 0; i < size; i++){\n\t\t\t\tsum[cnt] += inside[v[i]];\n\t\t\t}\n\t\t}\n\t\treturn;\n\t}\n\tint mask = 1 << (cur - 1), cur_i = cur + 1, size = v.size();\n\tv.push_back(mask);\n\tdfs(cur_i, n, v);\n\tv.pop_back();\n\tfor (register int i = 0; i < size; i++){\n\t\tint t = v[i];\n\t\tv[i] |= mask;\n\t\tdfs(cur_i, n, v);\n\t\tv[i] = t;\n\t}\n}\n\nint main(){\n\tint n, m;\n\tdouble ans = 0.0;\n\tcin >> n >> m;\n\tv1.push_back((1 << n) - 1);\n\tinit(m);\n\tfor (register int i = 0; i < n; i++){\n\t\tv2.push_back(1 << i);\n\t}\n\tfor (register int i = 1; i <= m; i++){\n\t\tcin >> a[i] >> b[i];\n\t}\n\tfor (register int i = 0; i < (1 << n); i++){\n\t\tfor (register int j = 1; j <= m; j++){\n\t\t\tif ((i & (1 << (a[j] - 1))) && (i & (1 << (b[j] - 1)))) inside[i]++;\n\t\t}\n\t\tfor (register int j = 0; j < (1 << n); j++){\n\t\t\tif (!(i & j)){\n\t\t\t\tfor (register int k = 1; k <= m; k++){\n\t\t\t\t\tif (((i & (1 << (a[k] - 1))) && (j & (1 << (b[k] - 1)))) || ((i & (1 << (b[k] - 1))) && (j & (1 << (a[k] - 1))))) connect[i][j]++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tdfs(1, n, vector<int>());\n\tfor (register int i = 1; i <= cnt; i++){\n\t\tint size = v3[i].size();\n\t\tfor (register int j = 0; j + 1 < size; j++){\n\t\t\tfor (register int k = j + 1; k < size; k++){\n\t\t\t\tif (connect[v3[i][j]][v3[i][k]] != 0){\n\t\t\t\t\tint t = v3[i][j] | v3[i][k];\n\t\t\t\t\tvector<int> v = v3[i];\n\t\t\t\t\tv.erase(v.begin() + k);\n\t\t\t\t\tv.erase(v.begin() + j);\n\t\t\t\t\tv.insert(lower_bound(v.begin(), v.end(), t), t);\n\t\t\t\t\tv4[i].push_back(make_pair(mp[v], connect[v3[i][j]][v3[i][k]]));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tdp[0][mp[v2]] = 1.0;\n\tfor (register int i = 0; i <= m; i++){\n\t\tans += i * fac[m - i] * dp[i][mp[v1]];\n\t\tdp[i][mp[v1]] = 0.0;\n\t\tif (i == m) break;\n\t\tint ii = i + 1;\n\t\tfor (register int j = 1; j <= cnt; j++){\n\t\t\tif (dp[i][j] == 0.0) continue;\n\t\t\tint size = v4[j].size();\n\t\t\tif (sum[j] != i) dp[ii][j] += dp[i][j] * (sum[j] - i);\n\t\t\tfor (register int k = 0; k < size; k++){\n\t\t\t\tdp[ii][v4[j][k].first] += dp[i][j] * v4[j][k].second;\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%.6lf\", ans / (m + 1) / fac[m]);\n\treturn 0;\n}\n```",
        "postTime": 1665230386,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3343 \u3010[ZJOI2015] \u5730\u9707\u540e\u7684\u5e7b\u60f3\u4e61\u3011"
    },
    {
        "content": "\n## [ZJOI2015]\u5730\u9707\u540e\u7684\u5e7b\u60f3\u4e61\n\n\u7ed9\u5b9a\u4e00\u5f20\u56fe\uff0c\u6bcf\u6761\u8fb9\u7684\u8fb9\u6743\u5728 $[0,1]$ \u4e2d\u968f\u673a\uff0c\u6c42\u6700\u5c0f\u751f\u6210\u6811\u7684\u6700\u5927\u8fb9\u6743\u7684\u671f\u671b\u3002\n\n$n\\le 10,m\\le \\frac{n(n-1)}{2}$\n\n### Solution\n\n[$\\textrm{\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c}$](https://www.cnblogs.com/Soulist/p/13848734.html)\n\n\u5927\u6982\u662f\u6bd4\u8f83 math \u7684\u505a\u6cd5...\u76f8\u5bf9\u522b\u4eba\u7684\u505a\u6cd5\u800c\u8a00\u53ef\u80fd\u4e0d\u662f\u5f88\u9700\u8981\u8111\u5b50\uff1f\n\n\u8fd9\u4e2a\u9898\u5927\u6982\u4ee3\u8868\u4e86 $7$ \u6708\u7684\u4e00\u70b9\u5b66\u4e60\u8bb0\u5f55...\u4eca\u5929\u6574\u7406\u5c31\u987a\u624b\u53d1\u51fa\u6765\u4e86\u3002\n\n\u5bf9\u4e8e**\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf**\uff0c\u6211\u4eec\u4e00\u822c\u4f7f\u7528\u6982\u7387\u5bc6\u5ea6\u51fd\u6570 $f(x)$ \u6765\u63cf\u8ff0\u5b83\u53d6\u503c\u7684\u6982\u7387\uff0c\u5176\u4e00\u5b9a\u533a\u57df\u7684\u79ef\u5206\u53ef\u4ee5\u8868\u793a\u53d6\u503c\u4e3a\u8fde\u7eed\u7684\u4e00\u6bb5\u533a\u95f4\u7684\u6982\u7387\u3002\n\n\u4f8b\u5982\uff0c\u8bba\u8bc1 $\\mathbb{E}(\\max\\{x_1,x_2...x_n\\})=\\frac{n}{n+1}$ \u65f6\uff0c\u6211\u4eec\u5148\u5b9a\u4e49 $F(x)=\\max\\{x_1...x_n\\}\\le x$\uff0c\u90a3\u4e48\u5bb9\u6613\u5f97\u5230 $F(x)=x^n$\n\n\u6211\u4eec\u4e0d\u96be\u89c2\u5bdf\u5230\uff0c$F(x)$ \u7684\u5bfc\u6570\u5c31\u662f\u5176\u5bf9\u5e94\u7684\u5bc6\u5ea6\u51fd\u6570 $f(x)$\n\n\u6240\u4ee5\u6211\u4eec\u5f97\u5230 $f(x)=x^{n-1}n$\n\n\u5bb9\u6613\u89c2\u5bdf\u5f97\u5230\uff0c\u6211\u4eec\u8ba1\u7b97\u7684\u671f\u671b\u4e3a\uff1a\n\n$$\\begin{aligned}\n    &\\int_0^1 xf(x)\\cdot dx\n    \\\\&=\\int_0^1 x^nn\\cdot dx\n    \\\\&=\\frac{n}{n+1}\n\\end{aligned}$$\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651\u8bc1\u660e\u9898\u9762\u7ed9\u51fa\u7684\u6027\u8d28\uff0c\u6ce8\u610f\u5230\u6211\u4eec\u8ba1\u7b97\u7684\u662f\u96c6\u5408\u7684 $\\min_k$\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u901a\u8fc7\u62d3\u5c55 $\\min-\\max$ \u5bb9\u65a5\u6765\u8ba1\u7b97\u7b54\u6848\uff1a\n\n$$\\begin{aligned}\n    &E(\\min_k(x))=\\sum_{i=k}^n \\binom{n}{i}\\binom{i-1}{k-1}(-1)^{i-k}\\frac{i}{i+1}\n    \\\\&=k\\sum_{i=k}^n \\binom{n}{i}\\binom{i}{k}(-1)^{i-k}\\frac{1}{i+1}\n    \\\\&={k}\\binom{n}{k}\\sum_{i=k}^n \\binom{n-k}{i-k}(-1)^{i-k}\\frac{1}{i+1}\n    \\\\&={k} \\binom{n}{k}\\sum_{j=0}^{n-k} \\binom{n-k}{j} (-1)^j \\frac{1}{j+k+1}\n\\end{aligned}$$\n\n\u8bbe $m=n-k$\n\n$$\\begin{aligned}\n    &{k} \\binom{n}{k}\\sum_{j=0}^{m} \\binom{m}{j} (-1)^j \\frac{1}{j+k+1}\n    \\\\&={k} \\binom{n}{k} \\sum_{j=0}^m \\binom{m}{j} (-1)^j \\int_0^1 x^{j+k}\n    \\\\&={k}\\binom{n}{k}\\sum_{j=0}^m \\binom{m}{j}\\int_0^1 x^k(-x)^j\n    \\\\&={k}\\binom{n}{k}\\int_0^1 x^k\\sum_j^m(-x)^j \\binom{m}{j}\n    \\\\&={k}\\binom{n}{k}\\int_0^1 x^k(1-x)^m\n    \\\\&={k} \\times \\frac{n!}{k!(n-k)!}\\times \\frac{k!m!}{(m+k+1)!}\n    \\\\&=\\frac{k}{n+1}\n\\end{aligned}$$\n\n\u4e8e\u662f\u5f97\u8bc1\u3002\n\n\u6700\u540e\u4e00\u6b65\u662f**\u5206\u90e8\u79ef\u5206**\u7684\u7ed3\u8bba\uff0c\u4e0b\u9762\u4e5f\u7ed9\u51fa\u8bc1\u660e\uff1a\n\n\u8003\u8651\uff1a \n\n$$\\begin{aligned}\n    &f(x)g(x)=\\int f'(x)g(x)+\\int f(x)g'(x)\n    \\\\&\\int f'(x)g(x)=f(x)g(x)-\\int f(x)g'(x)\n\\end{aligned}$$\n\n\u8bbe $B(a+b,b)=\\int_0^1 x^a(1-x)^b$\uff0c\u90a3\u4e48\u4e0d\u96be\u53d1\u73b0\uff1a\n\n- $f(x)=\\frac{x^a}{a+1},g(x)=(1-x)^b$\n\n$$\\begin{aligned}\n    &B(a+b,b)=\\int_0^1 f'(x)g(x)\n    \\\\&=f(1)g(1)-\\int_0^1 f(x)g'(x)\n    \\\\&=-\\int_0^1 \\frac{x^{a+1}}{a+1}\\times (-b(1-x)^{b-1})\n    \\\\&=\\frac{b}{a+1}\\int_0^1 x^{a+1}(1-x)^{b-1}\n    \\\\&=\\frac{b}{a+1}B(a+b,b-1)\n\\end{aligned}$$\n\n\u89c2\u5bdf\u5230 $B(a+b,0)=\\int_0^1 x^{a+b}=\\frac{1}{a+b+1}$\uff0c\u4e0d\u96be\u5f97\u5230 $B(a+b,b)=\\frac{b!}{(a+b+1)^{\\underline{b+1}}}=\\frac{a!b!}{(a+b+1)!}$\n\n\u81f3\u6b64\uff0c\u547d\u9898\u5f97\u8bc1\u3002\n\n\n\n\n----\n\n\u6ce8\u610f\u5230\u7b54\u6848\u662f\uff1a\n\n$$\\int_0^1 dx\\times P(X=x)x$$\n\n\u6784\u9020 $g(x)=P(X\\le x)$\uff0c\u90a3\u4e48 $P(X=x)$ \u4e3a $g(x)$ \u7684\u5bfc\u6570\u3002\n\n\u4e8e\u662f\u7b54\u6848\u5373\u4e3a\uff1a\n\n$$\\int_0^1 dx\\cdot g'(x)x=g(x)x-\\int_0^1 dx\\cdot g(x)$$\n\n\u4e0d\u96be\u53d1\u73b0\u7b54\u6848\u5373\u4e3a\uff1a\n\n$$1-\\int_0^1 dx\\cdot P(X\\le x)$$\n\n\u540e\u8005\u7b49\u4ef7\u4e8e\u4ec5\u4fdd\u7559\u5c0f\u4e8e $x$ \u7684\u8fb9\u6709\u6b64\u56fe\u8054\u901a\u3002\n\n\u53ef\u4ee5\u57fa\u4e8e\u8fd9\u6837\u7684\u8003\u91cf\uff0c\u6211\u4eec\u7ed9\u6bcf\u6761\u8fb9\u8d4b\u4e88 $0/1$ \u7684\u6743\u503c\u8868\u793a\u4ed6\u662f\u5426\u5c0f\u4e8e\u7b49\u4e8e $x$\uff0c\u5982\u679c\u4e3a $1$ \u90a3\u4e48\u5c0f\u4e8e\u7b49\u4e8e $x$\uff0c\u4e0d\u59a8\u5047\u8bbe\u6709 $a$ \u6761 $1$ \u8fb9\u548c $(m-a)$ \u6761 $0$ \u8fb9\uff0c\u6b64\u65f6\u6982\u7387\u89d2\u5ea6\u7684\u8d21\u732e\u4e3a\uff1a\n\n$$x^a(1-x)^{m-a}$$\n\n\u5bf9\u4e8e\u67d0\u4e2a\u5177\u4f53\u7684 $a$\uff0c\u6211\u4eec\u76f8\u5f53\u4e8e\u8ba1\u7b97\uff1a\n\n$$\\int_0^1 x^a(1-x)^{m-a}=\\frac{a!(m-a)!}{(m+1)!}$$\n\n\u4e8e\u662f\u6211\u4eec\u6210\u529f\u7684\u518d\u6b21\u901a\u8fc7\u5206\u90e8\u79ef\u5206\u5c06\u6b64\u95ee\u9898\u8f6c\u6362\u4e3a\u7ed9\u8fb9\u67d3\u8272\uff0c\u6070\u597d\u67d3 $a$ \u6761\u9ed1\u8272\u8fb9\u4f7f\u5f97\u8fd9\u5f20\u56fe\u8054\u901a\u7684\u65b9\u6848\u6570\u3002\n\n\u7b49\u4ef7\u4e8e\u6c42\u8fd9\u5f20\u56fe\u7684\u6070\u597d $a$ \u6761\u8fb9\u7684\u8054\u901a\u5b50\u56fe\u7684\u6570\u91cf\u3002\n\n\u7ecf\u5178\u7684\u5bb9\u65a5\u624b\u6bb5\u662f\u5bf9\u4e8e\u5b50\u96c6 $S$ \u5148\u4efb\u610f\u4fdd\u7559\u8fb9\uff0c\u5728\u679a\u4e3e $1$ \u53f7\u70b9\u6240\u5728\u7684\u8fde\u901a\u5757\uff0c\u8fd9\u91cc\u6211\u4eec\u8fd8\u9700\u8981\u679a\u4e3e $1$ \u6240\u5728\u7684\u8fde\u901a\u5757\u6240\u4fdd\u7559\u7684\u8fb9\u6570\uff0c\u6b64\u65f6\u5916\u90e8\u7684\u8fb9\u6570\u662f\u56fa\u5b9a\u7684\uff0c\u7136\u540e\u8f6c\u79fb\uff0c\u590d\u6742\u5ea6\u4e3a $\\mathcal O(3^n\\cdot m^2)$\u3002\n\n\u4e0d\u96be\u53d1\u73b0\u8f6c\u79fb\u7684\u65f6\u5019\u7684\u5377\u79ef\u4e3a\u5b50\u96c6\u5377\u79ef\uff0c\u53ef\u4ee5\u901a\u8fc7 FWT \u5904\u7406\u505a\u5230 $\\mathcal O(2^nn^2\\cdot m^2)$\uff0c\u4e0d\u8fc7\u610f\u4e49\u4e0d\u5927\u3002\n\n$Code:$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std ;\n#define Next( i, x ) for( register int i = head[x]; i; i = e[i].next )\n#define rep( i, s, t ) for( register int i = (s); i <= (t); ++ i )\n#define drep( i, s, t ) for( register int i = (t); i >= (s); -- i )\n#define re register\nint gi() {\n\tchar cc = getchar() ; int cn = 0, flus = 1 ;\n\twhile( cc < '0' || cc > '9' ) {  if( cc == '-' ) flus = - flus ; cc = getchar() ; }\n\twhile( cc >= '0' && cc <= '9' )  cn = cn * 10 + cc - '0', cc = getchar() ;\n\treturn cn * flus ;\n}\nconst int N = 10 + 5 ; \nconst int M = 60 ; \nint n, m, lim, g[1 << 11] ; \nlong double f[1 << 11][M], C[M][M], fac[M] ; \nsigned main()\n{\n\tn = gi(), m = gi() ; int x, y ; \n\trep( i, 1, m ) \n\t\tx = gi() - 1, y = gi() - 1, \n\t\t++ g[(1 << x) | (1 << y)] ;\n\tlim = (1 << n) ;\n\tfor(re int k = 1; k < lim; k <<= 1 ) \n\trep( i, 0, lim ) if(i & k) g[i] += g[i ^ k] ; \n\tC[0][0] = 1, f[0][0] = 1, fac[0] = 1 ; \n\trep( i, 1, m ) rep( j, 0, i ) C[i][j] = (!j) ? 1 : C[i - 1][j - 1] + C[i - 1][j] ; \n\trep( i, 1, m + 1 ) fac[i] = fac[i - 1] * i ; \n\tfor(re int S = 1; S < lim; ++ S) {\n\t\tint p = n ;\n\t\trep( j, 0, n - 1 ) if((1 << j) & S) { p = j ; break ; } \n\t\trep( j, 0, m ) f[S][j] = C[g[S]][j] ; \n\t\tfor(re int i = S; i; i = (i - 1) & S) {\n\t\t\tif((!(i & (1 << p))) || (i == S)) continue ; \n\t\t\tint u = S ^ i, l = g[i], r = g[u] ; \n\t\t\trep( j, 0, l ) rep( k, 0, r ) \n\t\t\tf[S][j + k] -= f[i][j] * C[r][k] ;\n\t\t}\n\t}\n\tlong double Ans = 1 ; -- lim ; \n\trep( j, 0, m ) Ans -= f[lim][j] / fac[m + 1] * fac[j] * fac[m - j] ;\n\tprintf(\"%.6Lf\\n\", Ans ) ; \n\treturn 0 ;\n}\n```\n",
        "postTime": 1603197561,
        "uid": 30036,
        "name": "Soulist",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3343 \u3010[ZJOI2015]\u5730\u9707\u540e\u7684\u5e7b\u60f3\u4e61\u3011"
    },
    {
        "content": "\u6211\u662f\u6765\u8865\u5145**\u65af\u7279\u6797\u53cd\u6f14**\u7684\u8be6\u7ec6\u505a\u6cd5\u7684\u3002\n\n@Ymiracle \u7684\u9898\u89e3\u5df2\u7ecf\u7ed9\u51fa\u4e86\u8be5\u505a\u6cd5\u7684\u601d\u8def\uff0c\u5199\u7684\u5f88\u8be6\u7ec6\uff0c\u4f46\u662f\u5728\u6ca1\u4ec0\u4e48\u65af\u7279\u6797\u53cd\u6f14\u7684\u9898\u76ee\u7684\u60c5\u51b5\u4e0b\uff0c\u4f3c\u4e4e\u8fd8\u662f\u6709\u90a3\u4e48\u4e00\u70b9\u96be\u4ee5\u7406\u89e3\uff0c\u8fd9\u7bc7\u9898\u89e3\u4e3b\u8981\u662f\u8865\u5145\uff0c\u5c3d\u91cf\u8ba9\u4e00\u4e2a\u6ca1\u505a\u8fc7\u65af\u7279\u6797\u53cd\u6f14\u9898\u76ee\u7684\u4eba\u4e5f\u53ef\u4ee5\u770b\u61c2\u3002\n\n\u8be5\u8bb2\u7684\u9898\u610f\u8f6c\u5316\u8fd8\u662f\u5f97\u8bb2\uff1a\u9996\u5148\uff0c\u9898\u76ee\u7684\u610f\u601d\u662f\u56fe\u7684\u6bcf\u4e00\u6761\u8fb9\u7684\u6743\u503c\u90fd\u5728$[0,1]$\u95f4\u968f\u673a\u5206\u5e03\uff0c\u6c42\u539f\u56fe\u6700\u5c0f\u751f\u6210\u6811\u74f6\u9888\u8fb9\u7684\u6743\u503c\u671f\u671b\u5927\u5c0f\u3002 \u9898\u76ee\u91cc\u5df2\u7ecf\u63d0\u793a\u6211\u4eec$n$\u4e2a$[0,1]$\u95f4\u7684\u968f\u673a\u53d8\u91cf\u7b2c$k$\u5c0f\u7684\u671f\u671b\u503c\u662f$\\frac{k}{m+1}$\uff0c**\u8fd9\u5176\u5b9e\u5c31\u662f\u60f3\u8ba9\u6211\u4eec\u8003\u8651\u628a\u6743\u503c\u7684\u671f\u671b\u95ee\u9898\u8f6c\u5316\u6210\u6392\u540d\u7684\u6982\u7387\u95ee\u9898\u3002**\n\n\u4e3a\u4ec0\u4e48\u8fd9\u6837\u8bf4\uff1f\u6211\u4eec\u53ef\u4ee5\u4ece\u671f\u671b\u7684\u5b9a\u4e49\u5165\u624b\uff1a\n\n$$E(X)=\\sum_{x}P(X=x)\\times x$$\n\n\u867d\u7136\u968f\u673a\u53d8\u91cf$X$\u7684\u53d6\u503c\u6709\u65e0\u7a77\u591a\u4e2a\uff0c\u4f46\u662f\u74f6\u9888\u8fb9\u7684\u5927\u5c0f\u5728$m$\u6761\u8fb9\u91cc\u5fc5\u7136\u6709\u4e00\u4e2a\u6392\u540d\uff08\u6392\u540d\u662f\u79bb\u6563\u7684\uff01\uff01\uff09\uff0c\u4e0d\u59a8\u679a\u4e3e\u8fd9\u4e2a\u6392\u540d\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u6743\u503c\uff1a\n\n$$E(X)=\\sum_{k=1}^mP(\\mathrm{the\\ rank\\ of\\ the\\ edge=}\\ k)\\times \\frac{k}{m+1}$$\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u5c31\u8981\u6c42$p_k=P(\\mathrm{the\\ rank\\ of\\ the\\ edge=}\\ k)$. \u90a3\u4e48\uff0c\u74f6\u9888\u8fb9\u7684\u6392\u540d\u4e3a$k$\u662f\u5565\u610f\u601d\uff1f\u5c31\u662f\u8bf4\u6211\u4eec\u7528\u4e86$k-1$\u6761\u8fb9\uff0c\u56fe\u4e0d\u8fde\u901a\uff0c\u73b0\u5728\u6211\u52a0\u5165\u7b2c$k$\u6761\u8fb9\uff0c\u56fe\u5c31\u8054\u901a\u4e86\uff0c**\u8fd9\u5c31\u4ee3\u8868\u6211\u4eec\u52a0\u7684\u8fd9\u6761\u8fb9\u6210\u4e3a\u4e86\u74f6\u9888\u8fb9**\u3002 \u4e5f\u5c31\u662f\u8bf4\uff0c$p_k$\u8868\u793a**\u6709\u987a\u5e8f\u5730**\u9009$k$\u6761\u8fb9**\u6070\u597d**\u8054\u901a\u539f\u56fe\u7684\u6982\u7387.\n\n\u6211\u672c\u6765\u60f3\uff1a\u8fd9\u4e0d\u5c31\u76f8\u5f53\u4e8e\u8ba9\u4f60\u6c42\u539f\u56fe\u9009$k$\u6761\u8fb9\uff0c\u95ee\u6709\u591a\u5c11\u79cd\u60c5\u51b5\u5f97\u5230\u8fde\u901a\u56fe\u5417\u3002**\u4f46\u663e\u7136\u4e0d\u662f\u7684**\u3002\u6709\u4e00\u4e2a\u5f88\u7b80\u5355\u7684\u53cd\u4f8b\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/nc45lhhj.png)\n\n\u5047\u8bbe\u8fd9\u5c31\u662f\u539f\u56fe\uff0c\u663e\u7136\u8fb9**\u5168\u90e8\u90fd\u9009**\u662f$k=5$\u6761\u8fb9\u8054\u901a\u539f\u56fe\u7684\u4e00\u4e2a\u65b9\u6848\uff0c\u4f46\u662f\u8fd9\u53ef\u5343\u4e07\u4e0d\u80fd\u7b97\u5230$p_5$\u91cc\u9762\uff0c\u56e0\u4e3a$5$\u6761\u8fb9**\u6070\u597d**\u8054\u901a\u539f\u56fe\u7684\u6982\u7387\u4e3a$0$\uff0c\u968f\u4fbf\u4f60\u6700\u540e\u52a0\u7684\u662f\u54ea\u4e00\u6761\u8fb9\uff0c\u539f\u56fe\u90fd\u5df2\u7ecf\u8054\u901a\u4e86\uff0c\u5c31\u6ca1\u6709\u6070\u597d\u8fd9\u4e00\u8bf4\u3002\n\n\u8fd9\u65f6\u5019\u4e00\u4e2a\u5f88\u5de7\u5999\u7684\u5904\u7406\u65b9\u6cd5\u5c31\u662f\u524d\u7f00\u548c\uff0c\u4ee4\n\n$$p'_n=\\sum_{i=0}^n p_i$$\n\n\u90a3\u4e48$p'_k$\u5c31\u4ee3\u8868 \u6709\u987a\u5e8f\u9009$1$\u6761\u8fb9**\u6070\u597d**\u8054\u901a\u539f\u56fe\u7684\u6982\u7387 $+$ \u6709\u987a\u5e8f\u9009$2$\u6761\u8fb9**\u6070\u597d**\u8054\u901a\u539f\u56fe\u7684\u6982\u7387 $+\\cdots+$ \u6709\u987a\u5e8f\u9009$k$\u6761\u8fb9**\u6070\u597d**\u8054\u901a\u539f\u56fe\u7684\u6982\u7387 $=$ **\u6709\u987a\u5e8f\u9009$k$\u6761\u8fb9\u539f\u56fe\u8054\u901a\u7684\u6982\u7387\u3002**\n\n\u4e0a\u8ff0\u7b49\u5f0f\u663e\u7136\u53ef\u4ee5\u901a\u8fc7**\u5168\u6982\u7387\u516c\u5f0f**\u6765\u9a8c\u8bc1\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/hg2d3r7l.png)\n\n\u800c**\u6709\u987a\u5e8f**\u9009$k$\u6761\u8fb9\u539f\u56fe\u8054\u901a\u7684\u6982\u7387 $=$ **\u65e0\u987a\u5e8f**\u9009$k$\u6761\u8fb9\u539f\u56fe\u8054\u901a\u6982\u7387\uff01\uff01\uff01\n\n\u8fd9\u6837\uff0c\u5982\u679c\u80fd\u6c42$p'$\u6570\u7ec4\uff0c\u90a3\u4e48$p$\u6570\u7ec4\u5c31\u53ef\u4ee5\u6c42\u3002\n\n**\u4e0a\u9762\u8fd9\u6bb5\u53ef\u80fd\u6709\u70b9\u96be\u7406\u89e3\uff0c\u4e0d\u8fc7\u4e0b\u9762\u5c31\u548c\u6982\u7387\u671f\u671b\u6ca1\u5173\u7cfb\u4e86**\u3002\n\n\u73b0\u5728\u6211\u4eec\u5f97\u5230\u53e6\u4e00\u4e2a\u95ee\u9898\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u56fe\uff0c\u6c42\u4fdd\u7559\u56fe\u4e2d$k$\u6761\u8fb9\uff0c\u539f\u56fe\u8054\u901a\u7684\u6982\u7387$p'_k$\u3002\n\n\u8003\u8651\u5230$m\\leq 45$\uff0c\u5176\u4fdd\u7559\u82e5\u5e72\u6761\u8fb9\u7684\u6700\u5927\u65b9\u6848\u6570$\\binom{45}{23}$\u5728$\\mathrm{long\\ long}$\u7c7b\u578b\u8303\u56f4\u5185\uff0c\u90a3\u4e48\u95ee\u9898\u8f6c\u5230\u6c42\u89e3\u4fdd\u7559$k$\u6761\u8fb9\uff0c\u4f7f\u539f\u56fe\u8054\u901a\u65b9\u6848\u6570$F_{k}$\uff0c\u663e\u7136\u6709$p'_k=\\frac{F_k}{\\binom{m}{k}}$.\n\n\u8fd9\u6837\u7684\u8bdd\u95ee\u9898\u5c31\u53d8\u5f97\u5f88\u7ecf\u5178\u4e86\uff0c\u5bf9\u4e8e**\u548c\u56fe\u8fde\u901a\u6027\u6709\u5173\u7684\u8ba1\u6570\u95ee\u9898**\uff0c\u6211\u4eec\u8981\u8003\u8651\u65af\u7279\u6797\u53cd\u6f14\u3002 \u4e0d\u59a8\u8bbe$f_{S,i,j}$\u8868\u793a\u73b0\u5728\u6211\u4eec\u9009\u4e86\u539f\u56fe\u4e2d$i$\u6761\u8fb9\uff0c**\u628a\u70b9\u96c6$S$\u5212\u5206\u6210$j$\u4e2a\u8fde\u901a\u5757\u7684\u65b9\u6848\u6570**\uff0c$g_{S,i,j}$\u8868\u793a\u6211\u4eec\u9009\u4e86\u539f\u56fe\u4e2d$i$\u6761\u8fb9\uff0c**\u70b9\u96c6$S$\u88ab\u94a6\u5b9a\u5212\u5206\u6210$j$\u4e2a\u8fde\u901a\u5757**\uff08\u4e8b\u5b9e\u4e0a\u53ef\u80fd\u66f4\u591a\uff09\u7684\u65b9\u6848\u6570\u3002\u90a3\u4e48\u6709\u5982\u4e0b\u5173\u7cfb\uff1a\n\n$$g_{S,i,j}=\\sum_{k=j}^n\\begin{Bmatrix}k\\\\ j\\end{Bmatrix}f_{S,i,k}$$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u5bf9\u7406\u89e3\u65af\u7279\u6797\u53cd\u6f14\u6765\u8bf4\u81f3\u5173\u91cd\u8981\uff0c\u4e00\u4e2a\u5f88\u597d\u7684\u60f3\u6cd5\u662f\uff1a\u5bf9\u6bd4\u4e8c\u9879\u5f0f\u53cd\u6f14\u3002\n\n\u5728\u4e8c\u9879\u5f0f\u53cd\u6f14\u91cc\u9762\uff0c\u6211\u4eec\u8981\u7b97**\u6070\u597d**$k$\u7684\u65b9\u6848\uff0c\u5f53\u7136\u662f\u4ee4 $($**\u94a6\u5b9a**$k$\u7684\u65b9\u6848$)=\\sum_{l\\geq k}\\binom{l}{k}($**\u6070\u597d**$l$\u7684\u65b9\u6848$)$\uff0c\u7136\u540e\u8bbe\u6cd5\u53cd\u6f14$/$\u9012\u63a8\u6c42\u51fa\u7b54\u6848\u3002 \u4e3a\u4ec0\u4e48\u8981\u8fd9\u6837\u505a\uff0c\u90a3\u662f\u56e0\u4e3a\u94a6\u5b9a$k$\u7684\u65b9\u6848\u5f88\u597d\u7b97\u3002\n\n**\u94a6\u5b9a**$k$\u5565\u610f\u601d\uff1f\u4e0d\u5c31\u662f\u6211\u5f3a\u9009$k$\u4e2a\u6027\u8d28\u56fa\u5b9a\u4e0b\u6765\uff0c\u7136\u540e\u5269\u4e0b\u7684\u968f\u4fbf\u6765\uff0c\u4f7f\u5f97\u771f\u6b63\u7684\u6027\u8d28\u6570\u91cf**\u81f3\u5c11\u4e3a**$k$\u5417\u3002\n\n\u65af\u7279\u6797\u53cd\u6f14\u540c\u6837\u5982\u6b64\uff0c\u65e2\u7136$i$\u6761\u8fb9\u628a\u70b9\u96c6$S$\u5212\u5206\u6210$j$\u4e2a\u8fde\u901a\u5757\u7684\u65b9\u6848\u6570\u4e0d\u597d\u7b97\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u94a6\u5b9a\u70b9\u96c6$S$\u88ab\u5212\u5206\u4e3a$j$\u4e2a\u8fde\u901a\u5757\uff0c\u7136\u540e\u518d\u8ba1\u7b97 **\u5728\u4e0d\u5f71\u54cd\u94a6\u5b9a\u5047\u8bbe\u7684\u524d\u63d0\u4e0b** **\u968f\u610f\u5730**$i$\u6761\u8fb9\u7684\u65b9\u6848\uff08\u5373\u4e0d\u5728\u94a6\u5b9a\u5212\u5206\u5f00\u6765\u7684\u4e24\u4e2a\u8fde\u901a\u5757\u4e4b\u95f4\u52a0\u8fb9\uff09\uff0c\u8fd9\u6837\uff0c\u5b9e\u9645\u4e0a\u7684\u8fde\u901a\u5757\u6570\u91cf\uff0c\u5c31\u81f3\u5c11\u4e3a$j$\u3002\n\n\u6b64\u65f6\uff0c\u6211\u4eec\u7684\u6c42\u548c\u7cfb\u6570\u5c31\u662f\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\uff0c\u56e0\u4e3a\u4efb\u4f55\u4e00\u4e2a**\u771f\u5b9e\u7684\u5212\u5206**$k$\uff0c\u90fd\u4f1a\u5bf9**\u94a6\u5b9a\u7684\u5212\u5206**$j$\u4ea7\u751f$\\begin{Bmatrix}k \\\\ j\\end{Bmatrix}$\u6b21\u8d21\u732e\uff0c\u5373\uff1a\u9009\u5b50\u96c6\u65b9\u6848\u6570\u3002\n\n\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u5bf9\u539f\u5f0f\u8fdb\u884c\u65af\u7279\u6797\u53cd\u6f14\uff1a\n\n$$f_{S,i,j}=\\sum_{k=j}^n(-1)^{k-j}\\begin{bmatrix}k\\\\ j\\end{bmatrix}g_{S,i,k}$$\n\n\u65af\u7279\u6797\u53cd\u6f14\u7684\u8bc1\u660e\uff0c\u53ef\u4ee5\u5728\u6211\u7684[\u8fd9\u7bc7\u535a\u5ba2](https://www.cnblogs.com/Parsnip/p/13398578.html)\u91cc\u627e\u5230\uff0c\u8fd9\u9053\u9898\u7684\u65af\u7279\u6797\u53cd\u6f14\u7684\u5f0f\u5b50\u8fd8\u7a0d\u6709\u4e0d\u540c\uff0c\u8981\u7528\u5230[\u53cd\u6f14\u539f\u7406](https://www.cnblogs.com/Parsnip/p/12518336.html)\uff08\u535a\u5ba2\u91cc\u9762$3.2$\u8282\uff09\u6765\u8f6c\u5316\u3002\n\n\u8981\u6c42$f_{\\mathrm{U},1\\sim m,1}$\uff0c\u5c31\u662f\u8981\u6c42$g_{\\mathrm{U},1\\sim m,1\\sim n}$\u3002 \u73b0\u5728\u8003\u8651$g$\uff0c\u663e\u7136\uff0c\u6ca1\u6709\u4efb\u4f55\u9650\u5236\u7684\u96c6\u5408\u5212\u5206\u65b9\u6848\u6570\u5c31\u662f$\\mathrm{Bell}$\u6570\uff0c\u4f46\u662f\u73b0\u5728\u6211\u4eec\u8981\u5728\u4e0d\u8fde\u63a5\u5df2\u7ecf\u5212\u5206\u96c6\u5408\u7684\u524d\u63d0\u4e0b\u52a0\u5165$i$\u6761\u8fb9\uff0c\u4e0d\u59a8\u8003\u8651\u5b50\u96c6$\\mathrm{dp}$\u3002\n\n\u5982\u679c\u8981\u76f4\u63a5\u7b97$g$\uff0c\u90a3\u4e48\u81f3\u5c11\u8981\u679a\u4e3e$S,i,j$\uff0c\u8981\u679a\u4e3e$S$\u7684\u5b50\u96c6$T$\u8868\u793a\u65b0\u52a0\u5165\u7684\u4e00\u4e2a\u96c6\u5408\uff0c\u679a\u4e3e$k$\u8868\u793a\u65b0\u96c6\u5408\u91cc\u9762\u9009\u7684\u8fb9\u6570\uff0c\u90a3\u4e48\u590d\u6742\u5ea6\u5c31\u81f3\u5c11\u8981$\\mathcal{O}(3^nnm^2)$\uff0c\u663e\u7136\u7206\u70b8\u3002\n\n\u4f46\u662f\u5176\u5b9e\u6211\u4eec\u53ef\u4ee5\u5148\u7b97\u4e00\u4e2a$h_{S,i,j}$\uff0c\u8868\u793a\u70b9\u96c6$S$\u88ab\u94a6\u5b9a\u5212\u5206\u6210$j$\u4e2a\u8fde\u901a\u5757\uff0c\u8fd9$j$\u4e2a\u8fde\u901a\u5757\u91cc\u9762\u4e00\u5171\u6709$i$\u6761\u8fb9**\u53ef\u9009**\u7684\u65b9\u6848\u6570. \u53ef\u9009\u7684\u610f\u601d\u5c31\u662f\u6211\u52a0\u5165\u4e00\u4e2a\u8fde\u901a\u5757\u5c31\u628a\u8fde\u901a\u5757\u91cc\u9762\u7684\u6240\u6709\u8fb9\u90fd\u52a0\u5230$\\mathrm{dp}$\u6570\u7ec4\u7684\u4e0b\u6807\u91cc\u9762\uff0c\u8868\u793a\u6211\u603b\u5171\u6709\u8fd9\u4e48\u591a\u8fb9\u53ef\u4ee5\u7528.\n\n\u90a3\u4e48\u5c31\u4f1a\u6709\n\n$$g_{S,i,j}=\\sum_{k=i}^m \\binom{k}{i}h_{S,k,j}$$\n\n\u73b0\u5728\u4ee5\u540c\u6837\u7684\u65b9\u5f0f$\\mathrm{dp}$\uff0c\u65e2\u4e0d\u7528\u679a\u4e3e\u5b50\u96c6$T$\u5f53\u4e2d\u7684\u8fb9\u6570\u4e86\uff0c\u4e8e\u662f\u590d\u6742\u5ea6\u5c31\u964d\u5230\u4e86$\\mathcal O(3^n nm)$\u5df2\u7ecf\u53ef\u4ee5\u901a\u8fc7\u3002\n\n\u5177\u4f53\u5730\uff0c\u4ee4$e(T)$\u8868\u793a\u539f\u56fe\u91cc\u8fb9\u70b9\u96c6$T$\u6709\u591a\u5c11\u6761\u8fb9\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u4e00\u4e2a\u5305\u542b$S$**\u6700\u5c0f\u6807\u53f7\u70b9**\u7684\u5b50\u96c6$T$\uff0c\u90a3\u4e48\uff1a\n\n$$h_{S,i,j}=\\sum_{T \\subseteq S,\\min_{x\\in S}\\{x\\}\\in T}h_{\\complement _S T,i-e(T),j-1}$$\n\n\u5982\u679c\u8981\u6c42\u96c6\u5408\u4e4b\u95f4\u662f\u6ca1\u6709\u6807\u53f7\u7684\uff08\u6216\u8005\u8bf4\u65e0\u5e8f\u7684\uff09\uff0c\u90a3\u4e48\u5f3a\u5236\u4f7f\u8f6c\u79fb\u65f6\u52a0\u5165\u7684\u6700\u540e\u4e00\u4e2a\u5b50\u96c6\u5305\u62ec\u6700\u5c0f\u6807\u53f7\u70b9\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u907f\u514d\u7b97\u91cd\u7684\u65b9\u5f0f\uff0c\u4ee3\u7801\u53ef\u4ee5\u8fd9\u6837\u5199\uff1a\n\n```cpp\nfor (int S = 1; S < 1<<n; S++)\n    for (int i = 0; i <= e[S]; i++)\n        for (int j = 1; j <= sz[S]; j++) {\n            for (int T = S&(S-1), P; P = T|Lowbit(S), T; T = (T-1) & S & (S-1))\n                if ( i >= e[P] ) h[S][i][j] += h[S-P][i-e[P]][j-1];\n            h[S][i][j] += h[ S - Lowbit(S) ][ i - e[Lowbit(S)] ][j-1];\n        }\n```\n\n\u6839\u636e\u4e0a\u9762\u63a8\u7684\u5f0f\u5b50\uff0c\u5e94\u8be5\u5bb9\u6613\u5199\u51fa\u4e0b\u9762\u7684\u4ee3\u7801\uff08\u7565\u53bb\u9884\u5904\u7406\uff09\uff1a\n\n```cpp\nfor (int i = 0; i <= m; i++)\n    for (int j = 1; j <= n; j++)\n        for (int k = i; k <= m; k++)\n            g[i][j] += h[(1<<n)-1][k][j] * c[k][i];\nfor (int i = 1; i <= m; i++)\n    for (int j = 1; j <= n; j++)\n        f[i] += ( (j&1) ? 1 : -1 ) * fac[j-1] * g[i][j];\nfor (int i = 0; i <= m; i++) p[i] = 1.0 * f[i] / c[m][i];\nfor (int i = m; i >= 1; i--) p[i] = p[i] - p[i-1];\nfor (int i = 1; i <= m; i++) Ans += p[i] * i / (m+1);\n```\n\n\u8fd9\u6837\u5df2\u7ecf\u5b8c\u5168\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u4e86\u3002\n\n\u7136\u800c@Ymiracle \u5927\u4f6c\u8fd8\u63d0\u5230\u4e86\u4e00\u79cd\u628a\u7cfb\u6570$(-1)^{k-1}(k-1)!$\u653e\u5230$\\mathrm{dp}$\u91cc\u9762\u7684\u505a\u6cd5\uff0c\u6682\u65f6\u8fd8\u6ca1\u6709\u641e\u61c2\u600e\u4e48\u8f6c\u79fb\u6765\u5904\u7406\u7cfb\u6570$(k-1)!$\uff0c\u53ef\u80fd\u53ef\u4ee5\u53c2\u8003[\u8fd9\u7bc7\u535a\u5ba2](https://www.cnblogs.com/bestwyj/p/13052448.html)\u3002 \u5982\u679c\u60a8\u53ef\u4ee5\u63d0\u4f9b\u5e2e\u52a9\uff0c\u671b\u544a\u77e5\u3002\n\n\u603b\u7ed3\uff1a\u8fd9\u9053\u9898\u4e0d\u77e5\u9053\u82b1\u4e86\u6211\u591a\u5c11\u65f6\u95f4\uff0c\u603b\u7684\u6765\u8bf4\uff0c\u4ece\u9898\u9762\u7684\u63d0\u793a\u51fa\u53d1\uff0c\u6211\u4eec\u5e94\u8be5\u5bb9\u6613\u628a\u671f\u671b\u95ee\u9898\u8f6c\u5316\u5230\u6982\u7387\u95ee\u9898\uff0c\u8fdb\u4e00\u6b65\u7684\uff0c\u6211\u4eec\u53d1\u73b0\u53ef\u4ee5\u7528\u524d\u7f00\u548c\u628a\u6070\u597d\u6027\u6982\u7387\u8f6c\u5316\u5230\u7ed3\u679c\u578b\u6982\u7387\uff08\u53ef\u4ee5\u7528\u5168\u6982\u7387\u516c\u5f0f\u9a8c\u8bc1\uff01\uff01\uff09\uff0c\u518d\u901a\u8fc7\u6982\u7387\u7684\u5b9a\u4e49\u8f6c\u5316\u5230\u8ba1\u6570\u95ee\u9898\uff0c\u4f7f\u7528\u65af\u7279\u6797\u53cd\u6f14\u6c42\u89e3\u8fde\u901a\u56fe\u8ba1\u6570\uff0c\u6700\u540e\u5f97\u5230\u7b54\u6848\u3002\u65e0\u8bba\u662f\u671f\u671b\uff0c\u6982\u7387\uff0c\u8fd8\u662f\u8ba1\u6570\u65b9\u9762\uff0c\u8fd9\u9053\u9898\u90fd\u5341\u5206\u6709\u96be\u5ea6\u3002\n",
        "postTime": 1597916237,
        "uid": 59327,
        "name": "Parsnip",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3343 \u3010[ZJOI2015]\u5730\u9707\u540e\u7684\u5e7b\u60f3\u4e61\u3011"
    },
    {
        "content": "### *\u79ef\u5206\u5927\u4f6c\u592a\u5f3a\u4e86*   \n>>>>\u4e0d\u4f1a\u79ef\u5206\u7684\u6211\u745f\u745f\u53d1\u6296\n\n>\u5bf9\u4e8e\u671f\u671b $E=\\sum {P_1(i)*W(i)}$ \n>>\u5176\u4e2d i \u5373\u7528\u524di\u77ed\u7684\u8fb9\u6784\u9020\u6700\u5c0f\u751f\u6210\u6811\u8def( i \u2264 M )\n\n>\u800c\u9898\u76ee\u540e\u65b9\u826f\u5fc3\u7684\u51fa\u9898\u4eba\u544a\u8bc9\u6211\u4eec $ W(i)=i/(M+1) $\n\n>\u90a3\u4e48$(M+1)*E=\\sum  P_1(i)*i $ \n\n>\u800c\u5bf9\u4e8e $P(i)*i $\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u6211\u4eec\u53ef\u4ee5\u7406\u89e3\u4e3a$P(i)$\u88ab\u52a0\u4e0a\u4e86 i \u6b21\uff0c\u5373\u5728\u6bcf\u4e00\u4e2a\u2264i \u7684i \u5904\u90fd\u88ab\u52a0\u4e0a\u4e86\u4e00\u6b21\n\n>\u90a3\u4e48$(M+1)*E=\\sum P_1(x\u2265i)$ ,\u800c\u8fd9\u4e2a\u5f0f\u5b50\u4efb\u7136\u662f\u96be\u4ee5\u5904\u7406\u7684\n\n>\u4ece\u6700\u5c0f\u751f\u6210\u6811\u7684\u6027\u8d28\u53ef\u4ee5\u5f97\u5230 \u6700\u5927\u8fb9\u5927\u4e8e\u7b49\u4e8ei\u7684\u6700\u5c0f\u751f\u6210\u6811\u7684\u6982\u7387 \u7b49\u4e8e \u6700\u5927\u8fb9\uff08\u4e25\u683c\uff09\u5c0f\u4e8ei\u65e0\u6cd5\u6784\u6210\u6700\u5c0f\u751f\u6210\u6811\u7684\u6982\u7387\n\n>\u90a3\u4e48\u6700\u7ec8$(M+1)*E=\\sum P_2(i-1)$\n\n>\u5bf9\u4e8e$P_2$\u6211\u4eec\u5c31\u6709\u529e\u6cd5\u6c42\u4e86\n\n>$P_2=F(j)/(_j^m)$ \n\n>>\u5176\u4e2d$F(j)$\u8868\u793a\u9009\u51faj\u6761\u8fb9\u65e0\u6cd5\u6784\u6210\u6700\u5c0f\u751f\u6210\u6811\u7684\u65b9\u6848\u6570\n\n>>>\u5bf9\u4e8e$F(j)$\u7684\u6c42\u89e3\u6211\u4eec\u53ef\u4ee5\u72b6\u538bDP\n\n>>>\u4ee4$F[i][j]$\u8868\u793a \u70b9\u96c6\u4e3a i \u9009\u8fd9i\u4e2a\u70b9\u4e4b\u95f4 j \u6761\u8fb9\u65e0\u6cd5\u8fde\u901a\u7684\u65b9\u6848\u6570\n\n>>>\u800c\u82e5\u8981\u6c42\u89e3\u6b64\u6570\u7ec4\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u8bbe\u51fa$G[i][j]$\u8868\u793a \u53ef\u4ee5\u8fde\u901a\u7684\u65b9\u6848\u6570\n\n>>>\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u51fa\u9012\u63a8\u5f0f\n\n>>>$F[i][j]=G[i_2][j_2]*(_{j-j_2}^{Cnt[i-i_2]})$\n\n>>>\u5176\u4e2d$Cnt[i]$\u662f\u6765\u8ba1\u7b97\u70b9\u96c6 i \u6240\u542b\u8fb9\u6570\uff08\u4e24\u7aef\u70b9\u90fd\u5728\u70b9\u96c6\u4e2d\uff09\n\n>>>\u800c\u7b80\u5355\u7684\n\n>>>>$G[i][j]=(_i^{Cnt[i]})-F[i][j]$\n\n### \u7136\u540e\u5c31\u53ef\u4ee5A\u4e86\uff0c\u867d\u7136\u6211\u8fd8\u662f\u88ablong long\u5751\u4e86\u3002\u3002\u3002\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nconst int Nn=15;\nconst int Mm=50;\ntypedef long long ll;\nint N,M;\nll Edg[Nn],S[1<<Nn],Cnt[1<<Nn],C[Mm][Mm],G[1<<Nn][Mm],F[1<<Nn][Mm];\nint main(){\n\tscanf(\"%d%d\",&N,&M);\n\tfor(int i=1,x,y;i<=M;i++){\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tEdg[x]|=(1<<y-1);\n\t\tEdg[y]|=(1<<x-1);\n\t}\n\tfor(int i=1;i<1<<N;i++)\n\t S[i]=S[i>>1]+(i&1);\n\tfor(int i=1;i<1<<N;i++){\n\t\tfor(int k=1;k<=N;k++)\n\t\tif((1<<k-1)&i) Cnt[i]+=S[Edg[k]&i];\n\t\tCnt[i]>>=1;\n\t}\n\tfor(int i=0;i<=Mm;i++){\n\t\tC[i][0]=C[i][i]=1;\n\t\tfor(int j=1;j<i;j++)\n\t\t C[i][j]=C[i-1][j]+C[i-1][j-1];\n\t}\n\t\n\tfor(int i=0;i<1<<N;i++){\n\t\tif(S[i]==1){\n\t\t\tG[i][0]=1;\n\t\t\tcontinue ;\n\t\t}\n\t\tint t=i&(-i);\n\t\tfor(int j=(i-1)&i;j;j=(j-1)&i)\n\t\tif(j&t)\n\t\tfor(int a=0;a<=Cnt[j];a++)\n\t\tfor(int b=0;b<=Cnt[i-j];b++)\n\t\t F[i][a+b]+=G[j][a]*C[Cnt[i-j]][b];\n\t\tfor(int j=0;j<=Cnt[i];j++)\n\t\t G[i][j]=C[Cnt[i]][j]-F[i][j];\n\t}\n\t\n\tdouble Ans=0.0;\n\tfor(int i=0;i<=M;i++)\n\t Ans+=double(F[(1<<N)-1][i])/(double)C[M][i];\n\tprintf(\"%.6f\\n\",Ans/(double)(M+1));\n\treturn 0;\n}\n```",
        "postTime": 1536379788,
        "uid": 125924,
        "name": "Kitahara_Haruki",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3343 \u3010[ZJOI2015]\u5730\u9707\u540e\u7684\u5e7b\u60f3\u4e61\u3011"
    },
    {
        "content": "[P3343 [ZJOI2015]\u5730\u9707\u540e\u7684\u5e7b\u60f3\u4e61](https://www.luogu.com.cn/problem/P3343) \n\n\u53c2\u8003\u4e86\u7ed9\u6211\u63a8\u8fd9\u9053\u9898\u7684\u5b66\u957f\u7684[\u535a\u5ba2](https://www.cnblogs.com/zyt1253679098/p/10913026.html)\uff0c\u5728\u8fd9\u91ccorz!\n\n\u6839\u636e\u671f\u671b\u7684\u7ebf\u6027\u6027\u6211\u4eec\u5f97\u5230 $ans=\\sum_{k=1}^{m} \u4efb\u9009 k \u6761\u8fb9\u6070\u597d\u8054\u901a n \u4e2a\u70b9\u7684\u6982\u7387 \\times  \u7b2c k\u5927\u7684\u8fb9\u6743\u7684\u671f\u671b\uff08\u5373\u63d0\u793a\u4e2d\u7684 \\frac{k}{m+1}\uff09$\u3002\n\n\u6070\u597d\u8fde\u901a\u7684\u6982\u7387\u5c31\u662f\u6070\u597d\u8fde\u901a\u7684\u65b9\u6848\u6570\u9664\u4ee5\u603b\u65b9\u6848\u6570\uff08$C_{m+1}^{k}$ \uff09\u3002\n\n**\u6070\u597d\u8fde\u901a**\u7684\u65b9\u6848\u6570\u5f88\u96be\u6c42\uff0c\u90a3\u4e48\u6211\u4eec**\u6b63\u96be\u5219\u53cd**\uff0c\u5c1d\u8bd5\u6c42\u51fa\u56fe\u4e0d\u8fde\u901a\u7684\u65b9\u6848\u6570\u3002\u8bbe $g_{S,i}$ \u8868\u793a\u9009 $i$ \u6761\u8fb9\u540e $S$ \u70b9\u96c6\u4e2d\u7684\u70b9**\u8fd8\u6ca1\u6709\u8fde\u901a**\u7684\u65b9\u6848\u6570\uff0c \u5219\u6070\u597d\u8fde\u901a\u7684\u65b9\u6848\u6570$=g_{S,i-1}-g_{S,i}$ \u3002\u73b0\u5728\uff0c\u8fd9\u4e2a\u671f\u671b\u9898\u5df2\u7ecf\u88ab\u8f6c\u5316\u4e3a\u4e86\u4e00\u4e2a\u8ba1\u6570\u95ee\u9898\u3002\n\n\u4e3a\u4e86\u4fdd\u8bc1 $g_{S,i}$ \u7684\u8f6c\u79fb\u4e0d\u91cd\u4e0d\u6f0f\uff0c\u6211\u4eec\u53c2\u8003[P5933 [\u6e05\u534e\u96c6\u8bad2012]\u4e32\u73e0\u5b50](https://www.luogu.com.cn/problem/solution/P5933)\u7684\u505a\u6cd5\uff0c\u679a\u4e3e\u67d0\u4e2a\u7279\u5b9a\u70b9\u6240\u5728\u7684\u8fde\u901a\u5757\u7684\u60c5\u51b5\uff0c\u8fd9\u4e2a\u8fde\u901a\u5757\u4ee5\u5916\u7684\u90e8\u5206\u968f\u4fbf\u9009\uff0c\u5373 $g_{S,i}=\\sum_{T  \\subseteq  S,lowbit(T)=lowbit(S)}\\sum_{j=1}^{m}(C_{num_T}^{j}-g_{T,j})\\times C_{num_{S-T}}^{i-j}$ \u3002\u89e3\u91ca\u4e00\u4e0b\uff0c$T$ \u4e3a $S$ \u7684\u771f\u5b50\u96c6\u4e14 $lowbit(T)=lowbit(S)$\uff08\u5373\u628a $S$ \u4e2d\u7f16\u53f7\u6700\u5c0f\u7684\u70b9\u4f5c\u4e3a\u4e0a\u9762\u8bf4\u7684\u7279\u5b9a\u70b9\uff09\uff0c$num_T$ \u8868\u793a\u4e24\u7aef\u5747\u5728 $T$ \u70b9\u96c6\u4e2d\u7684\u8fb9\u6570\uff0c$S-T$ \u4e3a $T$ \u5728 $S$ \u4e2d\u7684\u8865\u96c6 \uff0c $C_{num_T}^{j}-g_{T,j}$ \u8868\u793a\u5728 $T$ \u4e2d\u9009 $j$ \u6761\u8fb9\u4f7f\u5176\u8fde\u901a\uff08\u4e0d\u4e00\u5b9a\u6070\u597d\uff09\u7684\u65b9\u6848\u6570\u3002\u66b4\u529b\u8f6c\u79fb\u5373\u53ef\uff0c\u590d\u6742\u5ea6\u5e94\u8be5\u662f $O(3^nm)$\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nnamespace FGF\n{\n\tint n,m;\n\tconst int N=15;\n\tstruct edg{\n\t\tint u,v;\n\t}e[N*N];\n\tll g[1<<N][N*N],C[N*N][N*N],num[1<<N];\n\tdouble ans;\n\tvoid work()\n\t{\n\t\tscanf(\"%d%d\",&n,&m);\n\t\tfor(int i=1;i<=m;i++)\n\t\t\tscanf(\"%d%d\",&e[i].u,&e[i].v),e[i].u--,e[i].v--; \n\t\tfor(int i=1;i<(1<<n);i++)\n\t\t\tfor(int j=1;j<=m;j++)\n\t\t\t\tif((i&(1<<e[j].u))&&(i&(1<<e[j].v)))num[i]++;\n\t\tfor(int i=0;i<=m;i++)\n\t\t{\n\t\t\tC[i][0]=1;\n\t\t\tfor(int j=1;j<=i;j++)\n\t\t\t\tC[i][j]=C[i-1][j]+C[i-1][j-1];\n\t\t}\n\t\tfor(int S=1;S<(1<<n);S++)\n\t\t{\n\t\t\tfor(int T=S&(S-1);T;T=(T-1)&S)\n\t\t\t\tif((S&(-S))==(T&(-T)))\n\t\t\t\t\tfor(int i=0;i<=num[S];i++)\n\t\t\t\t\t\tfor(int j=0;j<=i;j++)\n\t\t\t\t\t\t\tg[S][i]+=(C[num[T]][j]-g[T][j])*C[num[S^T]][i-j];\n\t\t}\n\t\tfor(int i=1;i<=m;i++)\n\t\t\tans+=(double)i/(m+1)*((double)g[(1<<n)-1][i-1]/C[m][i-1]-(double)g[(1<<n)-1][i]/C[m][i]);\n\t\tprintf(\"%.6f\",ans);\n\t}\n}\nint main()\n{\n\tFGF::work();\n\treturn 0;\n}\n```\n\n",
        "postTime": 1606211442,
        "uid": 224403,
        "name": "\u6728xx\u6728\u5927",
        "ccfLevel": 9,
        "title": "P3343 [ZJOI2015]\u5730\u9707\u540e\u7684\u5e7b\u60f3\u4e61\uff08\u72b6\u538b+\u671f\u671bdp\uff09"
    }
]
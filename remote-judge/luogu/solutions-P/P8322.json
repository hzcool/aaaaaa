[
    {
        "content": "\u84dd\u53ef\u7231 /qq\n\n\u4f3c\u4e4e\u662f\u4e00\u4e2a\u590d\u6742\u5ea6\u7565\u5fae\u66f4\u4f4e\u7684\u505a\u6cd5\u3002\n\n\u8bbe $f_{i,j,k}$ \u8868\u793a\u56fa\u5b9a\u524d $i$ \u4e2a\u6570\uff0c$a_i=k$\uff0c\u540c\u65f6 $\\gcd(a_i,a_{i-1})=j$ \u7684\u65b9\u6848\u6570\uff1b$g_{i,j,k}$ \u8868\u793a\u56fa\u5b9a\u524d $i$ \u4e2a\u6570\uff0c$a_i=k$\uff0c\u5e76\u4e14\u56fa\u5b9a $\\gcd(a_i,a_{i+1})=j$ \u7684\u65b9\u6848\u6570\u3002\n\n\u9996\u5148\u8003\u8651 $f$ \u5230 $g$ \u7684\u8f6c\u79fb\uff1a\n\n$$g_{i,j,k}=\\sum_{v|j} f_{i-1,j,v}[\\gcd(v,k)=j]$$\n\n\u8003\u8651\u679a\u4e3e $j$ \u7136\u540e\u628a $j$ \u6574\u4f53\u9664\u6389\uff0c\u7136\u540e\u5c31\u53d8\u6210\u4e86\u5982\u4e0b\u5f62\u5f0f\uff1a\n\n$$g_{k}=\\sum_{v}f_v[v\\perp k]$$\n\n\u76f4\u63a5\u83ab\u53cd\uff1a\n\n$$g_k=\\sum_{v}f_v\\sum_{t|v,t|k}\\mu(t)=\\sum_{t|k}\\mu(t)\\sum_{t|v}f_v$$\n\n\u6240\u4ee5 $f$ \u5230 $g$ \u7684\u8f6c\u79fb\u5c31\u662f\u679a\u4e3e $f$ \u7684\u524d\u4e24\u7ef4\uff0c\u5bf9\u7b2c\u4e09\u7ef4\u8fea\u5229\u514b\u96f7\u540e\u7f00\u548c\uff0c\u9010\u70b9\u4e58 $\\mu$\uff0c\u518d\u8fea\u5229\u514b\u96f7\u524d\u7f00\u548c\u5373\u53ef\uff0c\u5904\u7406\u4e0a\u4e0b\u754c\u53ea\u9700\u8981\u628a\u8d85\u51fa\u9650\u5236\u7684\u72b6\u6001\u503c\u6539\u4e3a $0$\u3002\u8fd9\u90e8\u5206\u590d\u6742\u5ea6 $O(nm\\log m\\log\\log m)$\u3002\n\n\n\n\u518d\u8003\u8651 $g$ \u5230 $f$ \u7684\u8f6c\u79fb\uff1a\n\n$$f_{i,j,k}=\\sum_{p|k}g_{i,p,k}[p\\perp j]$$\n\n\u679a\u4e3e $k$\uff0c\u8003\u8651 $j$ \u7684\u8d28\u56e0\u5b50\u96c6\u5408 $S_1$ \u548c $p$ \u7684\u8d28\u56e0\u5b50\u96c6\u5408 $S_2$ \u9700\u8981\u6ee1\u8db3 $S_1\\cap S_2=\\varnothing$\uff0c\u90a3\u4e48\u53ef\u4ee5\u5bf9\u6240\u6709 $p|k$\uff0c\u5c06 $p$ \u5bf9\u5e94\u7684\u8d28\u56e0\u5b50\u96c6\u5408 $S_1$ \u7684 $h_{S_1}$ \u52a0\u4e0a $g_{i,p,k}$\uff1b\u5bf9 $h$ \u9ad8\u7ef4\u524d\u7f00\u548c\u4e4b\u540e\uff0c\u8bbe $j$ \u5bf9\u5e94\u8d28\u56e0\u5b50\u96c6\u5408 $S_2$\uff0c$f_{i,j,k}$ \u7684\u503c\u5c31\u662f $h_{\\overline{S_2}}$\u3002\n\n\u8fd9\u90e8\u5206\u590d\u6742\u5ea6 $O(nm\\log m+n\\sum_{i=1}^m\\omega(i)2^{\\omega(i)})$\u3002\u8003\u8651\u5230 $\\max\\limits_{i\\leq n}\\omega(i)=O\\left(\\dfrac{\\log n}{\\log\\log n}\\right)$\uff0c\u540c\u65f6 $2^{\\omega(i)}\\leq d(i)$\uff0c\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7c97\u7565\u7684\u590d\u6742\u5ea6\u4e0a\u754c $O\\left(\\dfrac{nm\\log^2m}{\\log\\log m}\\right)$\u3002\uff08\u5b9e\u9645\u4e0a $\\sum_{i=1}^m\\omega(i)2^{\\omega(i)}$ \u5728 $m=5000$ \u7684\u65f6\u5019\u53ea\u6709 $9\\times 10^4$ \u5de6\u53f3\uff0c\u6240\u4ee5\u53ef\u80fd\u5b9e\u9645\u590d\u6742\u5ea6\u63a5\u8fd1 $O(nm\\log m\\log\\log m)$\u3002\uff09\n\n```cpp\ninline void Solve() {\n\tfor (int i = 2;i <= v;i++) {\n\t\tfor (int j = i;j <= v;j += i) {\n\t\t\tif (j >= l[1] && j <= r[1]) g[mp[i][j]] = 1;\n\t\t}\n\t}\n\tfor (int i = 1;i < n;i++) {\n\t\t// g->f\n\t\tfor (int j = 2;j <= v;j++) {\n\t\t\tfor (int k = j;k <= v;k += j) tmp[k / j] = g[mp[j][k]];\n\t\t\tint mx = v / j;\n\t\t\tfor (int k = 1;k <= pcnt;k++) {\n\t\t\t\tif (pri[k] > mx) break;\n\t\t\t\tfor (int x = mx / pri[k] * pri[k];x >= pri[k];x -= pri[k]) tmp[x / pri[k]] = Add(tmp[x / pri[k]], tmp[x]);\n\t\t\t}\n\t\t\tfor (int k = 1;k <= mx;k++) tmp[k] = (tmp[k] * mu[k] % mod + mod) % mod;\n\t\t\tfor (int k = 1;k <= pcnt;k++) {\n\t\t\t\tif (pri[k] > mx) break;\n\t\t\t\tfor (int x = pri[k];x <= mx;x += pri[k]) tmp[x] = Add(tmp[x], tmp[x / pri[k]]);\n\t\t\t}\n\t\t\tfor (int k = j;k <= v;k += j) f[mp[j][k]] = tmp[k / j];\n\t\t}\n        for (int j = 2;j <= v;j++) {\n            for (int k = j;k <= v;k += j) {\n                if (k < l[i + 1] || k > r[i + 1]) f[mp[j][k]] = 0;\n            }\n        }\n\t\t// f->g\n\t\tfor (int j = 2;j <= v;j++) {\n            for (int k = 0;k < (1 << tpw[j]);k++) sdp[k] = 0;\n            for (int k = 1;k <= tpd[j];k++) {\n                if (d[j][k] == 1) continue;\n                sdp[subs[mp[d[j][k]][j]]] = Add(sdp[subs[mp[d[j][k]][j]]], f[mp[d[j][k]][j]]);\n            }\n            for (int k = 0;k < tpw[j];k++) {\n                for (int s = 0;s < (1 << tpw[j]);s++) {\n                    if (s & (1 << k)) sdp[s] = Add(sdp[s], sdp[s ^ (1 << k)]);\n                }\n            }\n            for (int k = 1;k <= tpd[j];k++) {\n                if (d[j][k] == 1) continue;\n                g[mp[d[j][k]][j]] = sdp[((1 << tpw[j]) - 1) ^ subs[mp[d[j][k]][j]]];\n            }\n\t\t}\n\t}\n    long long ans = 0;\n    for (int i = 1;i <= c;i++) ans = Add(ans, f[i]);\n    cout << ans << endl;\n}\n```\n\n\n\n\n\n\n\n\n\n",
        "postTime": 1664441654,
        "uid": 61088,
        "name": "Solystic",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P8322 \u3010\u300eJROI-4\u300f\u5c11\u5973\u5e7b\u846c\u3011"
    },
    {
        "content": "## Subtask1\n\u4f7f\u7528\u641c\u7d22\uff0c\u53ef\u4ee5\u83b7\u5f97\u6bd4\u4e0a\u4e00\u9898\u8fd8\u9ad8\u7684 $7$ \u5206\uff01\n## Subtask2\n\u8bbe $dp[n][m][k]$ \u8868\u793a\u5f53\u524d\u8ba1\u7b97\u5230\u5e8f\u5217\u7684\u7b2c $n$ \u4e2a\u4f4d\u7f6e\uff0c$\\gcd(a[n],a[n-1])=m,a[n]=mk$ \u7684\u5e8f\u5217\u7684\u6570\u91cf\u3002\n\n\u76f4\u63a5\u6839\u636e\u6761\u4ef6\u66b4\u529b\u679a\u4e3e\u5c31\u597d\u4e86\uff0c\u590d\u6742\u5ea6 $O(nm^2\\log m)$\u3002\n## Subtask3\n\u5f00\u59cb\u63a8\u5f0f\u5b50\u3002\n\n\u8f6c\u79fb\u65b9\u7a0b\u7684\u5f62\u5f0f\u4e3a $dp[n][x][A]=\\sum[\\gcd(x,y)=1][\\gcd(A\\times x,B\\times y)=x]dp[n-1][y][B]$\u3002\n\n\u63a5\u4e0b\u6765\u4e3a\u4e86\u65b9\u4fbf\uff0c\u8bbe $f=dp[n],g=dp[n-1]$\uff1a\n$$f[x][A]=\\sum[\\gcd(x,y)=1][\\gcd(A \\times x,B \\times y)=x]g[y][B]$$\n$$f[x][A]=\\sum[\\gcd(x,y)=1]\\sum_{d \\mid A,d \\mid By/x}\\mu(d)g[y][B]$$\n\u679a\u4e3e $(y,B)$\uff0c\u7136\u540e\u5b58\u4e0b\u56e0\u5b50\u548c\u4e0e\u81ea\u5df1\u4e92\u8d28\u7684\u6570\u540e\u66b4\u529b\u8f6c\u79fb\u5373\u53ef\u3002\u590d\u6742\u5ea6\u5927\u6982\u662f $O(nm^{\\frac{5}{3}})$ \u6216 $O(nm^2)$ \u7684\uff0c\u4f46\u662f\u56e0\u4e3a\u8dd1\u4e0d\u6ee1\u80fd\u591f\u901a\u8fc7\u3002\n## Subtask4\n\u8003\u8651\u5bf9\u4e0a\u8ff0\u7b97\u6cd5\u8fdb\u884c\u4f18\u5316\u3002\n\n\u76f4\u63a5\u7cbe\u7ec6\u5b9e\u73b0\u5373\u53ef\u3002\u5f00\u4e00\u4e2a\u6570\u7ec4 $F$ \u7528\u6765\u5b58 $g$ \u90a3\u4e00\u5806\u4e1c\u897f\u7684\u72c4\u5229\u514b\u96f7\u540e\u7f00\u548c\uff0c\u7136\u540e\u518d\u505a\u4e00\u4e2a\u72c4\u5229\u514b\u96f7\u540e\u7f00\u548c\u7ed9\u8f6c\u79fb\u5230 $f$ \u4e0a\u3002\n\n\u679a\u4e3e\u524d\u9762\u72c4\u5229\u514b\u96f7\u540e\u7f00\u548c\u7684\u6570\u7ec4\u4e2d\uff0c\u679a\u4e3e\u7684\u603b\u590d\u6742\u5ea6\u662f $O(\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\lfloor\\frac{n}{ij}\\rfloor[\\gcd(i,j)=1])=O(\\sum_{i=1}^{n}\\lfloor\\frac{n}{i}\\rfloor2^{\\Omega(i)})$\u3002\n\n\u7b97\u4e00\u4e0b\u53ef\u4ee5\u77e5\u9053\u4e0a\u9762\u90a3\u73a9\u610f\u513f\u5728 $m=5000$ \u7684\u65f6\u5019\u53ea\u6709 $159390$\uff0c\u800c\u4e14\u5e38\u6570\u5de8\u5c0f\uff0c\u53ef\u4ee5\u76f4\u63a5\u83bd\u3002\n\n\u4e0a\u8ff0\u90e8\u5206\u7684\u5177\u4f53\u7684\u590d\u6742\u5ea6\u53ef\u4ee5\u89c1[\u8fd9\u91cc](https://www.luogu.com.cn/paste/h3lkw29y)\uff0c\u590d\u6742\u5ea6\u4e3a $O(m\\log^2m)$\u3002\n\n\u72c4\u5229\u514b\u96f7\u5377\u79ef\u90e8\u5206\u7684\u590d\u6742\u5ea6\u662f $O(\\sum_{i=1}^{m}\\lfloor\\frac{m}{i}\\rfloor\\log\\lfloor\\frac{m}{i}\\rfloor)=O(m\\log^2m)$\uff0c\u5e38\u6570\u4e5f\u975e\u5e38\u5c0f\u3002\n\n\u6807\u7b97\u53ea\u8dd1\u4e86 1.6s\uff0c\u590d\u6742\u5ea6 $O(nm\\log^2m)$\u3002\n```cpp\ninline void init(){\n\tui i,j,x,*now;mu[1]=1;\n\tfor(i=1;i<=n;++i)if(r[i]>m)m=r[i];\n\tfor(now=buf1,i=1;i<=m;++i)f[i]=now,now+=m/i+1;f[m+1]=now;\n\tfor(now=buf2,i=1;i<=m;++i)g[i]=now,now+=m/i+1;g[m+1]=now;\n\tfor(now=buf,i=1;i<=m;++i)for(C[i]=now,j=1;i*j<=m;++j)if(gcd(i,j)==1)*now++=j;C[m+1]=now;\n\tfor(i=2;i<=m;++i){\n\t\tif(!pos[i])pri[pos[i]=++top]=i,mu[i]=mod-1;\n\t\tfor(j=1;j<=pos[i]&&(x=i*pri[j])<=m;++j)if((pos[x]=j)!=pos[i])mu[x]=mod-mu[i];\n\t}\n}\ninline void trans(){\n\tui x,y,i,j;\n\tfor(x=1;x<=m;++x){\n\t\tconst ui&n=m/x;\n\t\tfor(i=0;i<=n;++i)g[x][i]=F[i]=0;\n\t\tfor(ui*it=C[x];it!=C[x+1];++it){\n\t\t\tfor(y=*it,i=1;i*y<=n;++i)Mod(F[i*y]+=f[y][i*x]);\n\t\t}\n\t\tfor(i=1;i<=n;++i)for(j=2;i*j<=n;++j)Mod(F[i]+=F[i*j]);\n\t\tfor(i=n;i>=1;--i)if(y=1ull*mu[i]*F[i]%mod)for(j=1;i*j<=n;++j)Mod(g[x][i*j]+=y);\n\t}\n}\n```",
        "postTime": 1651669983,
        "uid": 160839,
        "name": "Prean",
        "ccfLevel": 7,
        "title": "\u6570\u5b66 P8322\u9898\u89e3"
    },
    {
        "content": "\u663e\u7136 $a_i$ \u90fd\u8981\u662f $k$ \u7684\u500d\u6570\uff0c\u56e0\u6b64\u4e0d\u59a8\u6240\u6709 $a_i$ \u5168\u90e8\u9664\u4ee5 $k$\uff0c\u4ee4 $l_i:=\\left\\lceil \\dfrac{l_i}{k}\\right\\rceil$\uff0c$r_i:=\\left\\lfloor \\dfrac{r_i}{k}\\right\\rfloor$\uff0c$m=\\max\\{r_i\\}$\u3002\n\n\u8fd9\u6837\u8f93\u5165\u4e2d\u7684 $k$ \u5c31\u76f4\u63a5\u53ef\u4ee5\u6254\u6389\u4e86\uff0c**\u4e0b\u9762 dp \u8fc7\u7a0b\u4e2d\u7684\u4e0b\u6807 $k$ \u548c\u8f93\u5165\u7684 $k$ \u662f\u65e0\u5173\u7684**\u3002\n\n\u8003\u8651 dp\uff0c\u4ee4 $dp_{i,j,k}$ \u8868\u793a\u786e\u5b9a $1\\sim i$ \u4f4d\uff0c$\\gcd(a_{i-1},a_i)=j$\uff0c$a_i=jk$ \u7684\u65b9\u6848\u6570\u3002\uff08\u6ce8\u610f\u8fd9\u91cc\u6709\u4e00\u4e2a\u9690\u542b\u7684\u4e0a\u754c $jk\\le m$\uff0c\u56e0\u6b64 $j,k$ \u4e24\u7ef4\u7684\u603b\u91cf\u662f $m\\ln m$ \u7684\uff09\n\n\u8f6c\u79fb\u7684\u8bdd\u679a\u4e3e\u4e0a\u4e00\u4e2a\u72b6\u6001 $dp_{i-1,x,y}$\uff0c\u80fd\u8f6c\u79fb\u5f53\u4e14\u4ec5\u5f53\u4e0b\u9762\u7684\u51e0\u4e2a\u6761\u4ef6\u6210\u7acb\uff1a\n\n1. $\\gcd(x,j)=1$\n2. $\\gcd(jk,xy)=j$\n\n\u7531 $2$ \u5f97 $\\gcd\\left(\\dfrac{xy}{j},k\\right)=1$\uff0c\u518d\u7531 $1$ \u5f97 $j|y$\u3002\n\n\u4e8e\u662f\u6709\u8f6c\u79fb\uff1a\n$$\ndp_{i,j,k}=\\sum_{x,y}[\\gcd(x,j)=1][\\gcd\\left(k,\\frac{xy}{j}\\right)=1][j|y]dp_{i-1,x,y}\n$$\n\u6700\u5916\u5c42\u80af\u5b9a\u662f $i$ \u4ece $3$ \u679a\u4e3e\u5230 $n$\uff08$a_1,a_2$ \u66b4\u679a\u4ee5\u786e\u5b9a dp \u521d\u503c\uff09\u3002\n\n\u5185\u90e8\u8f6c\u79fb\u9700\u8981\u4f18\u5316\uff0c\u4ed4\u7ec6\u89c2\u5bdf\u8fd9\u91cc\u7684\u5f0f\u5b50\uff0c\u7ed9\u6211\u4e00\u79cd\u8981\u7b97 $a_i=\\sum_j[\\gcd(i,j)=1]b_j$ \u7684\u611f\u89c9\uff0c\u5c1d\u8bd5\u5f80\u83ab\u53cd\u4e0a\u60f3\u60f3\u3002\n\n\u8fd9\u91cc\u8f6c\u79fb\u6709\u4e09\u4e2a\u6761\u4ef6\uff0c\u53ea\u6709 $k$ \u5728\u5176\u4e2d\u53ea\u51fa\u73b0\u4e86 $1$ \u6b21\uff0c\u56e0\u6b64\u8003\u8651\u679a\u4e3e $x,y,j$\uff0c\u8fd9\u6837\u65b9\u4fbf\u5bf9 $k$ \u8fdb\u884c\u4f18\u5316\u3002\n\n\u540c\u65f6\u6211\u4eec\u53d1\u73b0\u5bf9 $x,y,j$ \u7684\u9650\u5236\u8fd8\u975e\u5e38\u5f3a\uff1a$[\\gcd(x,j)=1][j|y][xy\\le m]$\uff0c\u5f53 $m=5000$ \u662f\u8fd9\u91cc\u5927\u6982\u53ea\u6709 $8\\times 10^4$ \u5bf9\uff0c\u56e0\u6b64\u76f4\u63a5\u66b4\u679a\u8fd9\u4e09\u4e2a\u3002\n\n\u679a\u4e3e\u4e4b\u540e\uff0c\u786e\u5b9a\u4e86 $x,y,j$\uff0c\u53ea\u6709\u4e00\u4e2a $k$ \u672a\u5b9a\uff0c\u540c\u65f6\u4e0e $k$ \u6709\u5173\u7684\u9650\u5236\u4e2d\u6709\u53e6\u4e00\u4e2a\u53d8\u91cf $\\dfrac{xy}{j}$\uff0c\u56e0\u6b64\u8bb0\u53e6\u4e00\u4e2a\u8f85\u52a9\u6570\u7ec4 $f$\uff0c\u5e76\u7ed9 $f_{j,\\small{\\frac{xy}{j}}}$ \u52a0\u4e0a $dp_{i-1,x,y}$\uff0c\u8fd9\u6837\u4e00\u6765\u5c31\u5f97\u5230 $dp_{i,j,k}=\\sum_l[\\gcd(k,l)=1]f_{j,l}$\u3002\n\n\u8fd9\u4e2a\u4e1c\u897f\u5c31\u7b80\u5355\u4e86\uff0c\u679a\u4e3e\u4e86 $j$ \u4e4b\u540e\uff0c$k,l\\le \\left\\lfloor \\dfrac{m}{j}\\right\\rfloor$\uff0c\u56e0\u6b64\u76f4\u63a5\u4e0a\u83ab\u53cd\uff1a\n$$\n\\begin{aligned}\nA_{\\{\\}}&:=dp_{i-1,j,\\{\\}}\\\\\nB_{\\{\\}}&:=f_{j,\\{\\}}\\\\\nA_k&=\\sum_l[\\gcd(k,l)=1]B_l\\\\\n&=\\sum_{d|k}\\mu(d)\\sum_{d|l}B_l\n\\end{aligned}\n$$\n\u4ee4 $C_k=\\sum_{k|l}B_l$\uff0c\u518d\u7c7b\u4f3c\u7684\u8f6c\u79fb\u5230 $A_k$ \u4e2d\u53bb\u5373\u53ef\u3002\n\n\u4e0a\u4e0b\u754c\u7684\u9650\u5236\u5c31\u628a $jk\\notin [l_i,r_i]$ \u7684 dp \u503c\u624b\u52a8\u6539\u6210 $0$\u3002\n\n\u590d\u6742\u5ea6\u4e0d\u592a\u4f1a\u5206\u6790\uff0c\u4e0d\u8fc7 $O(\\text{\u80fd\u8fc7})$\u3002\n\n\u9700\u8981\u5361\u5e38\u4ee5\u53ca\u5361\u7a7a\u95f4\uff0c\u5361\u5e38\u7684\u8bdd\u9884\u5904\u7406\u4e00\u4e9b $\\gcd$ \u5c31\u53ef\u4ee5\uff0c\u5361\u7a7a\u95f4\u7684\u8bdd\u5c31\u52a8\u6001 new \u51fa\u6765\uff08\u5343\u4e07\u4e0d\u8981 vector\uff0c\u4f1a\u5f88\u6162\uff09\u3002\n\n```cpp\nconst int N=5005,mod=998244353;\nint *dp[2][N],*f[N],*G[N],mu[N],prime[N],nprime[N];\nint sum[N],l[N],r[N],n,p,m,ans,cnt;\nvector<int> d[N];\ninline int Plus(int x, int y){ x+=y; return x>=mod?x-mod:x; }\nint main(){\n\tscanf(\"%d%d\",&n,&p);\n\tfor (int i=1; i<=n; i++){\n\t\tscanf(\"%d%d\",&l[i],&r[i]);\n\t\tl[i]=(l[i]+p-1)/p,r[i]/=p; m=max(m,r[i]);\n\t}\n\t\n\tfor (int i=1; i<=m; i++){\n\t\tdp[0][i]=new int[m/i+2];\n\t\tdp[1][i]=new int[m/i+2];\n\t\tf[i]=new int[m/i+2];\n\t\tG[i]=new int[m/i+2];\n\t\tfor (int j=0; j<=m/i+1; j++) dp[0][i][j]=dp[1][i][j]=f[i][j]=0,G[i][j]=__gcd(i,j);\n\t}\n\t\n\tfor (int i=2; i<=m; i++)\n\t\tfor (int j=i; j<=m; j+=i) d[j].push_back(i);\n\t\n\tmu[1]=1;\n\tfor (int i=2; i<=m; i++){\n\t\tif (!nprime[i]) prime[++cnt]=i,mu[i]=mod-1;\n\t\tfor (int j=1; j<=cnt && i*prime[j]<=m; j++){\n\t\t\tnprime[i*prime[j]]=1;\n\t\t\tif (i%prime[j]==0){\n\t\t\t\tmu[i*prime[j]]=0; break;\n\t\t\t} else mu[i*prime[j]]=mod-mu[i];\n\t\t}\n\t}\n\n\tfor (int i=l[1]; i<=r[1]; i++)\n\t\tfor (int j=l[2]; j<=r[2]; j++){\n\t\t\tint k=__gcd(i,j);\n\t\t\tif (k!=1) dp[0][k][j/k]++;\n\t\t}\n\t\n\tfor (int i=3; i<=n; i++){\n\t\tint D=i&1;\n\t\tfor (int x=2; x<=m; x++)\n\t\t\tfor (int y=1; x*y<=m; y++)\n\t\t\t\tfor (int j:d[y]) if (G[x][j]==1) f[j][x*y/j]=Plus(f[j][x*y/j],dp[D^1][x][y]);\n\t\tfor (int j=2; j<=m; j++){\n\t\t\tint L=m/j;\n\t\t\tfor (int k=1; k<=L; k++){\n\t\t\t\tfor (int t=k; t<=L; t+=k) sum[k]=Plus(sum[k],f[j][t]);\n\t\t\t\tsum[k]=1ll*sum[k]*mu[k]%mod;\n\t\t\t}\n\t\t\tfor (int k=1; k<=L; k++)\n\t\t\t\tfor (int t=k; t<=L; t+=k) dp[D][j][t]=Plus(dp[D][j][t],sum[k]);\n\t\t\tfor (int k=1; k<=L; k++){\n\t\t\t\tf[j][k]=sum[k]=0;\n\t\t\t\tif (j*k<l[i] || j*k>r[i]) dp[D][j][k]=0;\n\t\t\t}\n\t\t}\n\t\tfor (int j=2; j<=m; j++)\n\t\t\tfor (int k=1; k*j<=m; k++) dp[D^1][j][k]=0;\n\t}\n\tfor (int i=1; i<=m; i++)\n\t\tfor (int j=1; i*j<=m; j++) ans=(ans+dp[n&1][i][j])%mod;\n\tprintf(\"%d\\n\",ans);\n}\n```",
        "postTime": 1682904173,
        "uid": 44599,
        "name": "wishapig",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P8322 \u300eJROI-4\u300f\u5c11\u5973\u5e7b\u846c"
    }
]
[
    {
        "content": "# \u5e7f\u544a\n\n[\u849f\u84bb\u306eblog](http://www.cnblogs.com/dedicatus545/p/8900630.html)\n\n# \u601d\u8def\n\n\u5148\u628a\u9898\u9762\u8f6c\u6210\u4eba\u8bdd\uff1a\n\n\u5bf9\u4e8e\u7ed9\u5b9a\u4e32\u7684\u6bcf\u4e2a\u524d\u7f00i\uff0c\u6c42\u6700\u957f\u7684\uff0c\u4f7f\u8fd9\u4e2a\u5b57\u7b26\u4e32\u91cd\u590d\u4e24\u8fb9\u80fd\u8986\u76d6\u539f\u524d\u7f00i\u7684\u524d\u7f00\uff08\u5c31\u662f\u524d\u7f00i\u7684\u4e00\u4e2a\u524d\u7f00\uff09\uff0c\u6c42\u6240\u6709\u7684\u8fd9\u4e9b\u201c\u524d\u7f00\u7684\u524d\u7f00\u201d\u7684\u957f\u5ea6\u548c\n\n\u5229\u7528$next$\u7684\u6027\u8d28\uff1a\u524d\u7f00$i$\u7684\u957f\u5ea6\u4e3a$next[i]$\u7684\u524d\u7f00\u548c\u540e\u7f00\u662f\u76f8\u7b49\u7684\n\n\u8fd9\u8bf4\u660e\uff1a\u5982\u679c\u6709i\u4e00\u4e2a\u516c\u5171\u524d\u540e\u7f00\u957f\u5ea6\u4e3aj\uff0c\u90a3\u4e48\u8fd9\u4e2a\u524d\u7f00i\u5c31\u6709\u4e00\u4e2a\u5468\u671f\u4e3ai-j\n\n\u89c1\u4e0b\u56fe\n\n![](http://images.cnblogs.com/cnblogs_com/dedicatus545/1199264/o_POI2006%20p1.png)\n\n\u663e\u7136\u56fe\u4e2d\u84dd\u8272\u7ebf\u6bb5\u662f\u9ed1\u8272\u7ebf\u6bb5\u7684\u4e00\u4e2a\u5468\u671f\n\n\u90a3\u4e48\u63a5\u4e0b\u6765\u7684\u95ee\u9898\u5c31\u5bb9\u6613\u4e86\uff1a\n\n\u5148\u6c42\u51fa$next$\u6570\u7ec4\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u524d\u7f00$i$\uff0c\u4ee4$j=i$\uff0c\u7136\u540e\u5728$j>0$\u7684\u60c5\u51b5\u4e0b\u4ee4$j=next[j]$\uff0c\u6700\u5c0f\u7684$j$\u5c31\u662f\u7b54\u6848\uff0c\u6b64\u65f6$ans+=i-j$\n\n\u4e00\u4e2a\u4f18\u5316\uff1a\u6c42\u51fa$j$\u4ee5\u540e\uff0c\u4ee4$j=fail[i]$\uff0c\u8fd9\u6837\u80fd\u52a0\u5feb\u9012\u5f52\u901f\u5ea6\uff08\u76f8\u5f53\u4e8e\u8bb0\u5fc6\u5316\u4e86\uff09\n\n# Code\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define ll long long\nusing namespace std;\nchar a[1000010];int n,fail[1000010];\nint main(){\n    scanf(\"%d\",&n);scanf(\"%s\",a);int i,j;ll cnt=0;\n    fail[0]=fail[1]=0;j=0;\n    for(i=1;i<n;i++){//\u6c42\u89e3next\n        while(j&&(a[i]!=a[j])) j=fail[j];\n        j+=(a[i]==a[j]);fail[i+1]=j;\n    }\n    for(i=1;i<=n;i++){\n        j=i;\n        while(fail[j]) j=fail[j];\n        if(fail[i]!=0) fail[i]=j;//\u8bb0\u5fc6\u5316\n        cnt+=i-j;\n    }\n    printf(\"%lld\",cnt);\n}\n```",
        "postTime": 1524286124,
        "uid": 27753,
        "name": "Orion545",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3435 \u3010[POI2006]OKR-Periods of Words\u3011"
    },
    {
        "content": "`2019. 10. 26: \u6362\u4e86\u4e00\u5f20\u56fe`\n\n\u8fd9\u662f\u4e00\u9053\u8ba9\u6211\u4eec\u6df1\u5165\u4e86\u89e3KMP\u7b97\u6cd5\u7cbe\u9ad3\u7684\u597d\u9898\u3002\n\n\u9898\u76ee\u4e2d\u7684\u201c\u5339\u914d\u524d\u7f00\u201d\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u7406\u89e3\uff1a\u5728A\u7684\u524d\u7f00\u4e2d\uff0c\u628a\u8fd9\u4e2a\u524d\u7f00\u518d\u53e0\u52a0\u4e00\u904d\u540e\u5c31\u628aA\u5305\u62ec\u8fdb\u6765\uff0c\u5982\u56fe\uff1a\n\n![](https://s2.ax1x.com/2019/10/26/K0Iszt.png)\n\n\u90a3\u4e48\uff0c\"abcabcab\"\u7684\u6700\u957f\u5339\u914d\u5b50\u4e32\u5e94\u8be5\u662f\"abcabc\"\uff0c\u957f\u5ea6\u4e3a6\u3002\n\n\u6211\u4eec\u8bbe\u7b2c\u4e00\u4e2a\u56fe\u4e2d\u5b57\u7b26\u4e32\u4e3aS\uff0c\u7b2c\u4e8c\u4e2a\u5b57\u7b26\u4e32\u4e3aSS\uff0c\u663e\u7136\u6709S[6..8]=SS[6..8]=SS[1..2]=S[1..2]\u3002\u4e8e\u662f\u6211\u4eec\u5f97\u5230\u89c4\u5f8b\uff0c\u5339\u914d\u524d\u7f00\u5b50\u4e32\u6ee1\u8db3KMP\u7b97\u6cd5\u4e2d\u201c\u524d\u7f00\u7b49\u4e8e\u540e\u7f00\u201d\u7684\u6027\u8d28\uff0c\u6211\u4eec\u8981\u4f7f\u5b50\u4e32\u6700\u957f\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5339\u914d\u957f\u5ea6\u5e94\u8be5\u5c3d\u53ef\u80fd\u5c0f\u3002\u6bd4\u5982\u5bf9\u4e8eS\u6765\u8bf4,next[8]\u5e94\u8be5\u4e3a5\uff0c\u8868\u793aS[1..5]\u548cS[4..8]\u662f\u5339\u914d\u7684\uff0c\u4f46\u6211\u4eec\u9009\u62e9\u7684\u662f\u6700\u77ed\u7684\u5339\u914d\u957f\u5ea6short[8]=2,S[1..2]=S[7..8]\uff0c\u800c\u7b54\u6848\u5c31\u662f8-short[8]=6\u3002\n\n\u4f46\u662fKMP\u53ea\u80fd\u6c42\u51fa\u6bcf\u4e2a\u524d\u7f00\u4e32\u7684\u6700\u957f\u5339\u914d\u957f\u5ea6\uff0c\u5982\u679c\u8981\u6c42\u51fa\u6700\u77ed\u5339\u914d\u957f\u5ea6\uff0c\u6211\u4eec\u53ef\u4ee5\u4e00\u76f4\u9012\u63a8next[i],next[next[i]]...\uff0c\u76f4\u5230\u4e3a0. \u719f\u6089\u7684KMP\u672c\u8d28\u7684\u4eba\u90fd\u5e94\u8be5\u77e5\u9053\u4e3a\u4ec0\u4e48\uff0c\u8fd9\u91cc\u4e3e\u4e00\u4e2a\u4f8b\u5b50\u3002\n\n\u5728S\u4e2d\uff0cnext[8]=5,\u800cnext[5]=2\uff0cnext[2]=0\u4e86\uff0c\u6240\u4ee5next[5]=2\u5c31\u662f8\u7684\u6700\u77ed\u5339\u914d\u957f\u5ea6\uff0c\u5c068-2\u7d2f\u8ba1\u5230\u7b54\u6848\u4e2d\u5373\u53ef\u3002\n\n\u6700\u540e\uff0c\u7c7b\u4f3c\u6c42next\u65f6\u7684\u9012\u63a8\u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u9012\u63a8short\u6765\u63d0\u9ad8\u6548\u7387\u3002\u6bd4\u5982\u5728\u4e0a\u4f8b\u4e2d,\u6211\u4eec\u5f97\u5230short[8]=2\u540e\uff0c\u5c31\u76f4\u63a5\u5c06next[8]\u4fee\u6539\u4e3a2\uff0c\u8fd9\u68378\u4ee5\u540e\u7684\u6570\u5b57\u5982\u679c\u9012\u63a8\u52308\u4e86\u5c31\u53ef\u4ee5\u76f4\u63a5\u8df3\u5230next[2]=0\uff0c\u800c\u4e0d\u7528\u8df3\u5230next[5]\u8fd9\u91cc\u3002\n\n**\u7b54\u6848\u8bb0\u5f97long long\uff0c\u5426\u5219\u53ea\u670940\u5206\u3002**\n\n```cpp\n#include <bits/stdc++.h>\n#define MAX (1000000+50)\nusing namespace std;\n\nint size,nxt[MAX];\nchar s[MAX];\nunsigned long long ans;//\u8bb0\u5f97\u5f00long long\n\nint main()\n{\n\tios::sync_with_stdio(0);\n\tcin.tie(0); cin>>size>>(s+1);\n\tfor (register int i=2,j=0; i<=size; i++)\n\t{\n\t\twhile (j && s[i]!=s[j+1]) j=nxt[j];\n\t\tif (s[i]==s[j+1]) j++; nxt[i]=j;\n\t}//KMP\u6c42\u89e3next\u6570\u7ec4\n\tfor (register int i=2,j=2; i<=size; i++,j=i)\n\t{\n\t\twhile (nxt[j]) j=nxt[j]; //\u9012\u63a8\u6c42\u6700\u77ed\u5339\u914d\u957f\u5ea6\n\t\tif (nxt[i]) nxt[i]=j; //\u4fee\u6539next[i]\u7684\u503c\n\t\tans+=i-j;//\u7edf\u8ba1\u7b54\u6848\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```\n\n",
        "postTime": 1549722953,
        "uid": 73489,
        "name": "NyaRu_Official",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3435 \u3010[POI2006]OKR-Periods of Words\u3011"
    },
    {
        "content": "\u8ba9\u7a9d\u6765\u8d21\u732e\u4e00\u4e2a$O(n\\log n)$\u7b97\u6cd5\u3002~~\u8bb2\u89e3\u5f88\u8be6\u7ec6\u54e6~~\n****************************\n\u8054\u7cfbkmp\u7b97\u6cd5\u4e2d\u7684next\u6570\u7ec4\u548c\u9898\u76ee\u4e2d\u63d0\u5230\u7684\u5468\u671f\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2a\u7ed3\u8bba\uff1a\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u6700\u5927\u5468\u671f\u957f\u5ea6\u5c31\u662f\u8fd9\u4e2a\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u51cf\u53bb\u5b83\u6700\u77ed\u7684\u516c\u5171\u524d\u540e\u7f00\u957f\u5ea6\uff0c\u800c\u4e14\u8fd9\u4e2a\u516c\u5171\u524d\u540e\u7f00\u7684\u957f\u5ea6\u5fc5\u987b\u5c0f\u4e8e\u7b49\u4e8e\u5b57\u7b26\u4e32\u957f\u5ea6\u7684\u4e00\u534a\uff0c\u5426\u5219\u4e0d\u5b58\u5728\u5468\u671f\u3002\n\n\u4e3e\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u5047\u8bbe\u6211\u4eec\u8981\u6c42\u4e32$S$\u7684\u67d0\u4e2a\u5468\u671f\u957f\u5ea6\uff0c\u4e14\u8fd9\u4e2a\u4e32\u5b58\u5728\u4e00\u4e2a\u5c0f\u4e8e\u5176\u957f\u5ea6\u4e00\u534a\u7684\u516c\u5171\u524d\u540e\u7f00T\uff0c\u5982\u4e0b\uff1a\n![](https://cdn.luogu.com.cn/upload/image_hosting/d0nowb03.png)\n\n\u56e0\u4e3a$ab$\u6bb5\u4e0e$cd$\u6bb5\u4e00\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u628a$ac$\u6bb5\u5b50\u4e32\u5411\u53f3\u79fb\u52a8\u5230$a$\u70b9\u4e0e$c$\u70b9\u91cd\u5408\uff0c\u8fd9\u6837\u5c31\u5f97\u5230\u4e86\u5982\u4e0b\u4e00\u4e2a\u65b0\u4e32$ae$\uff1a\n![](https://cdn.luogu.com.cn/upload/image_hosting/zdm0llvo.png)\n\n\u5728\u8fd9\u4e2a\u65b0\u4e32\u4e2d\uff0c$ac$\u4e0e$ce$\u5bf9\u5e94\uff0c$ab$\u4e0e$cd$\u5bf9\u5e94\uff0c$bc$\u4e0e$de$\u5bf9\u5e94\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c$ac$\u7684\u957f\u5ea6\u5c31\u662f\u8fd9\u4e2a\u5468\u671f\u7684\u957f\u5ea6\uff0c\u56e0\u4e3a$ac$\u662f$S$\u7684\u524d\u7f00\uff0c\u4e14$S$\u662f$ac$+$ac$\uff0c\u5373$ae$\u7684\u524d\u7f00\u3002\u6240\u4ee5\u63a5\u4e0b\u6765\u6211\u4eec\u8981\u4f7f\u5f97\u8fd9\u4e2a$ac$\u7684\u957f\u5ea6\u5c3d\u91cf\u957f\uff0c\u5c31\u662f$cd$\u7684\u957f\u5ea6\u5c3d\u91cf\u77ed\uff0c\u90a3\u4e48\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a\u4e86\u6c42\u53d6$S$\u7684\u6700\u77ed\u516c\u5171\u524d\u540e\u7f00\u957f\u5ea6\u3002\n\n\u8fd9\u4e2a\u5f88\u597d\u529e\uff0c\u6211\u4eec\u53ea\u9700\u8981\u4e0d\u65ad\u5f80\u524d\u8df3next\u6570\u7ec4\u5bfb\u627e\u5408\u6cd5\u89e3\u5c31\u597d\u4e86\u3002\n\n\u6ce8\u610f\u5230\u4ee5\u4e0a\u7684\u8bba\u8ff0\u5efa\u7acb\u5728\u4e00\u4e2a\u524d\u63d0\u4e0a\uff1a$ab$\u7684\u957f\u5ea6\u5c0f\u4e8e\u7b49\u4e8e$S$\u7684\u4e00\u534a\uff0c\u6240\u4ee5\u8fd9\u4e2a\u6700\u77ed\u516c\u5171\u524d\u540e\u7f00\u7684\u957f\u5ea6\u8fd8\u5fc5\u987b\u5c0f\u4e8e\u7b49\u4e8e\u5b57\u7b26\u4e32\u957f\u5ea6\u7684\u4e00\u534a\uff0c\u5426\u5219\u65e0\u89e3\u3002\n\n\u63a5\u4e0b\u6765\u5c31\u662f\u4ee3\u7801\u5b9e\u73b0\u4e86\u3002\u6211\u4e00\u5f00\u59cb\u5c31\u66b4\u529b\u8df3next\u6570\u7ec4\uff0c\u7ed3\u679cTLE\u4e86\u51e0\u4e2a\u70b9\u3002\u4f46\u662f\u7a9d\u592a\u83dc\u4e86\uff0c\u6839\u672c\u6ca1\u6709\u60f3\u5230\u8bb0\u5fc6\u5316\uff0c\u800c\u662f\u60f3\u5230\u4e86\u4e00\u4e2a\u975e\u5e38\u4f18\u96c5\u7684\u66b4\u529b\u2014\u2014\u500d\u589e\u3002\n\n\u5982\u679c\u4e0d\u77e5\u9053\u500d\u589e\uff0c\u53ef\u4ee5\u53bb\u7814\u7a76\u4e00\u4e0b\u500d\u589e\u6c42LCA\u7684\u7b97\u6cd5\uff0c\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u3002\n\n\u4e8e\u662f\u6211\u4eec\u4fbf\u5f97\u5230\u4e86\u4ee5\u4e0b\u4ee3\u7801\u2014\u2014\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<string>\n#include<cstring>\n#define rep(i,a,b) for(register int i=a;i<=b;i++)\n#define maxn 1000005\nusing namespace std;\n\nint len,nxt[maxn],f[maxn][21];\nlong long ans;\nstring s;\n\nvoid kmp() {\n\tnxt[0]=-1;\n\tf[1][0]=0;\n\tint j=-1;\n\trep(i,0,len-1) {\n\t\twhile(j>-1&&s[j+1]!=s[i+1]) j=nxt[j];\n\t\tif(s[j+1]==s[i+1]) j++;\n\t\tnxt[i+1]=j;\n\t\tf[i+2][0]=j+1;//\u56e0\u4e3a\u500d\u589e\u6570\u7ec4\u6d89\u53ca\u5230\u4ee5\u5b57\u7b26\u7684\u4f4d\u7f6e\u4f5c\u4e0b\u6807\uff0c\u4e3a\u4e86\u65b9\u4fbf\u5904\u7406\uff0c\u6211\u4eec\u628a\u5b57\u7b26\u7684\u4f4d\u7f6e\u52a01\n\t}\n}//kmp\u6a21\u677f\n\nvoid pretreat() {\n\trep(i,0,len-1) {\n\t\trep(j,1,20) {\n\t\t\tf[i+1][j]=f[f[i+1][j-1]][j-1];\n\t\t}\n\t}\n}//\u9884\u5904\u7406\u51fa\u500d\u589e\u6570\u7ec4\n\nvoid check() {\n\trep(i,0,len-1) {\n\t\tint x=i+1;\n\t\tfor(register int j=20;j>=0;j--) {\n\t\t\tif(f[x][j]) {\n\t\t\t\tx=f[x][j];\n\t\t\t}\n\t\t}\n\t\tif(i+1==x||x>i+1>>1) continue;//\u5224\u65ad\u89e3\u662f\u5426\u5408\u6cd5\n\t\tans+=(long long)(i+1)-x;//\u66f4\u65b0\u7b54\u6848\n\t}\n}//\u500d\u589e\u627e\u5230\u6700\u77ed\u516c\u5171\u524d\u540e\u7f00\u957f\u5ea6\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin>>len;\n\tcin>>s;\n\tkmp();\n\tpretreat();\n\tcheck();\n\tcout<<ans;\n\treturn 0;\n}\n```\n",
        "postTime": 1596186687,
        "uid": 91736,
        "name": "RPChe_",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3435 \u3010[POI2006]OKR-Periods of Words\u3011"
    },
    {
        "content": "\u6211\u4eec\u4ee5\u6837\u4f8b\u4e3a\u4f8b\u6765\u89e3\u8fd9\u9053\u9898\uff1a\n```\nbabababa\n```\n\u8fd9\u9053\u9898\u8981\u6c42\u6bcf\u4e2a\u524d\u7f00\u90fd\u8981\u627e\u5230\u6700\u5927\u524d\u7f00\u7684\u957f\u5ea6\u4f7f\u5f97\u8fd9\u4e2a\u7ed9\u51fa\u7684\u5b57\u7b26\u4e32\u662f\u8fd9\u4e24\u4e2a\u76f8\u540c\u7684\u524d\u7f00\u5408\u5728\u4e00\u8d77\u7684\u524d\u7f00\u3002\u6bd4\u5982\u6211\u4eec\u53d6 $\\text{A}$=`babababa` \u7684\u524d\u7f00 $\\text{P}$= `bababa`\uff0c\u6211\u4eec\u5c06\u4e24\u4e2a\u5b57\u7b26\u4e32 $\\text{A}$ \u548c $\\text{PP}$ \u653e\u5728\u4e00\u8d77\u6765\u6bd4\u5bf9\u4e00\u4e0b\uff1a\n```\nbababa bababa\nbababa ba\n```\n\u6211\u4eec\u53d1\u73b0 $\\text{A}$ \u7684\u540e\u4e24\u4e2a\u5b57\u7b26\u4e0e $\\text{PP}$ \u7684\u540e\u9762\u7684 $\\text{P}$ \u524d\u4e24\u4e2a\u7684\u4f4d\u7f6e\u76f8\u540c\u3002\u8fd9\u524d\u4e24\u4e2a\u5b57\u7b26\u5176\u5b9e\u5c31\u662f $\\text{A}$ \u7684\u524d\u9762\u4e24\u4e2a\u5b57\u7b26\uff0c\u5982\u679c\u60f3\u6210\u4e3a proper \u524d\u7f00\u5c31\u5fc5\u987b\u8981\u6c42 $\\text{A}$ \u7684\u524d\u4e24\u4e2a\u5b57\u7b26\u4e0e\u540e\u4e24\u4e2a\u5b57\u7b26\u76f8\u540c\uff0c\u90a3\u4e48\u5c31\u662f\u6c42\u524d\u7f00\u540e\u7f00\u76f8\u540c\u7684\u9898\u4e86\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u7528 KMP \u7684\u6c42\u6700\u957f\u516c\u5171\u524d\u7f00\u540e\u7f00\u7b97\u6cd5\u6765\u505a\uff0c\u800c\u4e14\u53ef\u4ee5\u76f4\u63a5\u628a\u6240\u6709\u7684 $\\text{A}$ \u7684\u524d\u7f00\u7684\u6700\u957f\u516c\u5171\u524d\u7f00\u540e\u7f00\u7684\u957f\u5ea6\u90fd\u6c42\u51fa\u6765\uff0c\u4f46\u662f\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u8981\u6c42 $\\text{A}$ \u7684\u524d\u7f00\u7684\u6700\u5927\u5468\u671f\u6700\u5927\uff0c\u4e5f\u5c31\u662f\u8bf4\u516c\u5171\u524d\u7f00\u540e\u7f00\u8981\u6c42\u5c3d\u91cf\u7684\u5c0f\uff0c\u4f46\u662f\u6211\u4eec\u6c42\u7684\u662f\u6700\u957f\u516c\u5171\u524d\u7f00\u540e\u7f00\uff08\u5728\u8fd9\u91cc\u6211\u4eec\u628a\u6700\u957f\u516c\u5171\u524d\u7f00\u540e\u7f00\u8bbe\u4e3a $\\text{B}$\uff09 \u6240\u4ee5\u6211\u4eec\u9700\u8981\u5224\u65ad $\\text{B}$ \u662f\u5426\u8fd8\u6709\u516c\u5171\u524d\u7f00\u540e\u7f00\uff0c\u5982\u679c\u6709\uff0c\u5c31\u8ba9 $\\text{B}$ \u53d8\u4e3a\u5b83\u7684\u6700\u957f\u516c\u5171\u524d\u7f00\u540e\u7f00\uff0c\u76f4\u5230\u6ca1\u6709\u4e3a\u6b62\u3002\u4f46\u662f\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u8fd9\u6837\u4e0d\u65ad\u5730\u8fdb\u884c\u9012\u5f52\u53ef\u80fd\u4f1a\u9020\u6210\u65f6\u95f4\u590d\u6742\u5ea6\u9000\u5316\u6210 $O(n^2)$\uff0c\u90a3\u6211\u4eec\u600e\u4e48\u529e\uff1f\n\n\u5176\u5b9e\u6211\u4eec\u53ea\u9700\u8981\u5f00\u4e00\u4e2a\u8bb0\u5fc6\u5316\u5c31\u53ef\u4ee5\u4e86\uff0c\u628a\u521a\u624d\u6c42\u51fa\u7684\u6700\u77ed\u516c\u5171\u524d\u7f00\u540e\u7f00\u7684\u957f\u5ea6\u66f4\u65b0\u5230 next \u6570\u7ec4\u91cc\u5934\uff08\u4e4b\u524d\u6c42\u6700\u957f\u516c\u5171\u524d\u7f00\u540e\u7f00\u7684\u957f\u5ea6\u7684\u6570\u7ec4\uff09\u5c31\u884c\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u53d8\u6210\u4e86 $O(n)$\u3002\n\n# code:\n```cpp\n#include<cstdio>\nusing namespace std;\nchar a[1000005];\nint nxt[1000005];\nint main(){\n\tint k,i,j=0;\n\tlong long ans=0;\n\tscanf(\"%d\",&k);\n\tscanf(\"%s\",a);\n\tfor(i=1;i<k;i++){\n\t\twhile(j&&a[i]!=a[j]){\n\t\t\tj=nxt[j];\n\t\t}\n\t\tif(a[i]==a[j]){\n\t\t\tj++;\n\t\t}\n\t\tnxt[i+1]=j;\n\t}\n\tfor(i=1;i<=k;i++){\n\t\tint t=0,j=i;\n\t\twhile(nxt[j]){\n\t\t\tt=j=nxt[j];\n\t\t}\n\t\tnxt[i]=j!=i?j:nxt[i];\n\t\tif(t){\n\t\t\tans+=i-t;\n\t\t}\n\t}\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1587611340,
        "uid": 80614,
        "name": "ZCPB",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3435 \u3010[POI2006]OKR-Periods of Words\u3011"
    },
    {
        "content": "### \u4e00\u9053 $KMP$ \u5165\u95e8\u7684\u597d\u9898\n\n\u9898\u610f\uff1a\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u524d\u7f00 $i$\uff0c\u90a3\u4e48\u6211\u4eec\u8981\u627e\u5230\u4e00\u4e2a$j\\ (1 \\leq j \\leq i)$\uff0c\u6ee1\u8db3 $s_1s_2\\dots s_i$ \u662f $s_1s_2\\dots s_js_1s_2\\dots s_j$ \u7684\u524d\u7f00\u3002\n\n\u9996\u5148\uff0c\u9898\u610f\u8bf4\u5f97\u6709\u4e9b\u9690\u6666\uff0c\u5148\u628a\u5b83\u7ffb\u8bd1\u6210\u6211\u4eec\u719f\u6089\u7684\u8bed\u8a00\uff1a\u56e0\u4e3a$s_1s_2\\dots s_i$ \u662f $s_1s_2\\dots s_js_1s_2\\dots s_j$ \u7684\u524d\u7f00\uff0c\u6240\u4ee5$T1=s_{j+1}s_{j+2}\\dots s_i$ \u4e5f\u662f $T2=s_1s_2\\dots s_j$ \u7684\u524d\u7f00\u3002\u53c8\u6839\u636e\u6211\u4eec\u8981\u627e\u6700\u5927\u7684 $j$\uff0c\u56e0\u6b64\u6211\u4eec\u5e0c\u671b $i-j$ \u7684\u503c\uff0c\u4e5f\u5c31\u662f $T2$ \u7684\u957f\u5ea6\uff0c\u5c3d\u53ef\u80fd\u7684\u5c0f\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u8981\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u524d\u7f00 $i$\uff0c\u627e\u51fa\u6700\u5c0f\u516c\u5171\u524d\u540e\u7f00\u7684\u957f\u5ea6 $j$\uff0c\u90a3\u4e48 $i-j$ \u5c31\u662f\u524d\u7f00 $i$ \u7684\u6700\u5927\u5468\u671f\u3002\n\n\u4e4d\u4e00\u770b\uff0c\u8fd9\u548c $KMP$ \u4e2d $next$ \u6570\u7ec4\u7684\u542b\u4e49\u51e0\u4e4e\u5b8c\u5168\u4e00\u6837\uff0c\u53ea\u4e0d\u8fc7\u6b64\u5904\u662f**\u6700\u5c0f**\u524d\u540e\u7f00\u3002\u5047\u8bbe\u6211\u4eec\u5728\u8ba1\u7b97\u524d\u7f00 $i$ \u7684\u503c\uff0c\u6211\u4eec\u5f00\u4e00\u4e2a\u6307\u9488 $j$\uff0c\u521d\u59cb\u503c\u4e3a $i$\uff0c\u4e0d\u65ad\u4ee4 $j=next_j$\uff0c\u76f4\u5230 $next_j=0$\uff0c\u6b64\u65f6\u7684 $j$ \u5c31\u662f\u6211\u4eec\u8981\u6c42\u7684\u503c\u3002\n\n\u4f46\u662f\u4ec5\u4ec5\u8fd9\u6837\u505a\u662f\u8fc7\u4e0d\u4e86\u7684\uff08\u6211\u4eec\u4f1a\u53d1\u73b0\u4e0a\u8ff0\u8fc7\u7a0b\u4e2d $j$ \u53d8\u5316\u7684\u6b21\u6570\u6700\u9ad8\u53ef\u8fbe $\\mathcal O(n)$ \u7ea7\u522b\uff0c\u8fd9\u6837\u6700\u574f\u65f6\u95f4\u590d\u6742\u5ea6\u4f1a\u9000\u5316\u4e3a $\\mathcal O(n^2)$\uff09\uff0c\u6211\u4eec\u9700\u8981\u8fdb\u884c\u4e00\u4e2a\u5c0f\u5c0f\u7684\u4f18\u5316\uff0c\u6bcf\u7b97\u51fa\u6765\u4e00\u4e2a\u524d\u7f00 $i$ \u7684\u7b54\u6848 $j$ \u5c31\u4ee4 $next_i=j$\uff0c\u76f8\u5f53\u4e8e\u8bb0\u5fc6\u5316\u3002\n\n$code:$\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi\t\t\tfirst\n#define se\t\t\tsecond\n#define fz(i,a,b)\tfor(int i=a;i<=b;i++)\n#define fd(i,a,b)\tfor(int i=a;i>=b;i--)\n#define put(x)\t\tputchar(x)\n#define eoln        put('\\n')\n#define space\t\tput(' ')\n#define int long long\ninline int read(){\n\tint x=0,neg=1;char c=getchar();\n\twhile(!isdigit(c)){\n\t\tif(c=='-')\tneg=-1;\n\t\tc=getchar();\n\t}\n\twhile(isdigit(c))\tx=x*10+c-'0',c=getchar();\n\treturn x*neg;\n}\ninline void print(int x){\n\tif(x<0){\n\t\tputchar('-');\n\t\tprint(abs(x));\n\t\treturn;\n\t}\n\tif(x<=9)\tputchar(x+'0');\n\telse{\n\t\tprint(x/10);\n\t\tputchar(x%10+'0');\n\t}\n}\nint n,nxt[1000005];\nchar s[1000005];\ninline void getnext(){//\u6c42next\u6570\u7ec4\n\tint j=0;\n\tnxt[1]=0;\n\tfor(int i=2;i<=n;i++){\n\t\twhile(j!=0&&s[j+1]!=s[i])\tj=nxt[j];\n\t\tif(s[j+1]==s[i])\t\t\tj++;\n\t\tnxt[i]=j;\n\t}\n}\nsigned main(){\n\tcin>>n>>s+1;\n\tgetnext();\n\tint ans=0;\n\tfz(i,1,n){\n\t\tint j=i;\n\t\twhile(nxt[j])\tj=nxt[j];//\u5f80\u524d\u8df3\n\t\tif(nxt[i])\t\tnxt[i]=j;//\u8bb0\u5fc6\u5316\n\t\tans+=i-j;\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1579098670,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3435 \u3010[POI2006]OKR-Periods of Words\u3011"
    },
    {
        "content": "\u3010\u6d1b\u8c37\u3011P3435 [POI2006]OKR-Periods of Words\n\n### \u9898\u610f\u7b80\u8ff0\uff1a\n\n\u7ed9\u5b9a\u4e00\u4e2a\u5b57\u7b26\u4e32 $S$\uff0c\u6c42\uff1a\n\n$$\n\\sum_{i = 1}^{n}\\max\\limits_{S_i\\sqsubset S_j^2}\\{j\\}\n$$\n\n$1 \\le \\left|S\\right| \\le 10^6$\u3002\n\n[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/P3435)\n\n### \u89e3\u9898\u601d\u8def\uff1a\n\n\u6211\u4eec\u5355\u72ec\u8003\u8651\u67d0\u4e2a\u5b57\u7b26\u4e32 $S_i \\sqsubset S$\uff0c\u5219 $\\forall k \\in \\pi^{\\star}[i]$\uff0c\u90fd\u6709 $S_{i - k} \\sqsubset S_i^2$\u3002\n\n\u8003\u8651\u8ba9 $i - k$ \u6700\u5927\uff08\u9898\u76ee\u8981\u6c42\uff09\uff0c\u5373\u8ba9 $k$ \u6700\u5c0f\uff0c\u4e5f\u5c31\u662f\u6211\u4eec $\\forall i \\in [1, n]$\uff0c\u6c42 $\\pi^{\\star}[i]$ \u4e2d\u7684\u975e\u96f6\u6700\u5c0f\u503c\u3002\n\n\u5bf9\u6bcf\u4e2a $i \\in [1, n]$ \u90fd\u6c42\u4e00\u6b21\u6700\u5c0f\u503c\uff0c\u4f1a\u88ab\u5361\u6210 $O(\\left|S\\right|^2)$\uff0c\u8003\u8651\u8bb0\u5fc6\u5316\u3002\n\n\u6211\u4eec\u6bcf\u6b21\u6c42\u51fa\u6765\u4e86 $\\pi^{\\star}[i]$ \u4e2d\u7684\u975e\u96f6\u6700\u5c0f\u503c $k$ \u65f6\uff0c\u76f4\u63a5\u4ee4 $\\pi[i] \\gets k$\u3002\n\n\u7b54\u6848\u5373\u4e3a\uff08\u4e4b\u540e\u7684\uff09\n$$\n\\sum_{i = 1}^{n}(i - \\pi[i])\n$$\n\n### \u53c2\u8003\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define LL long long\n\nconst int N = 1e6 + 5;\n\nint n, pi[N];\nLL ans;\nchar str[N];\n\nvoid calcPi() {\n\tfor(int i = 2, k = 0; i <= n; ++i) {\n\t\twhile(k > 0 && str[k + 1] != str[i])\n\t\t\tk = pi[k];\n\t\tif(str[k + 1] == str[i])\n\t\t\t++k;\n\t\tpi[i] = k;\n\t}\n}\n\nint32_t main() {\n\tscanf(\"%d\", &n);\n\tscanf(\"%s\", str + 1);\n\tcalcPi();\n\tfor(int i = 1; i <= n; ++i) {\n        int k = i;\n        while(pi[k])\n        \tk = pi[k];\n        if(pi[i])\n        \tpi[i] = k;\n        ans += i - k;\n    }\n    printf(\"%lld\", ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1594541908,
        "uid": 78407,
        "name": "Clever_Jimmy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3435 \u3010[POI2006]OKR-Periods of Words\u3011"
    },
    {
        "content": "### \u9898\u610f\n\n\u8fd9\u9053\u9898\u76ee\u7684\u9898\u9762\u4e0d\u662f\u7ed9\u4eba\u770b\u7684/kk\n\n\u5bf9\u4e8e\u4e00\u4e2a\u957f\u5ea6\u4e3a $k$ \u7684\u5b57\u7b26\u4e32 $A$ \u7684\u6bcf\u4e2a\u524d\u7f00 $\\text{pre}(A, i)$\uff0c\u6c42\u51fa\u6700\u957f\u7684\u5b57\u7b26\u4e32 $S_i$ \u4f7f\u5f97 $|S_i|<i$ \u4e14 $A_i$ \u662f\u82e5\u5e72\u4e2a $S_i$ \u8fde\u63a5\u5728\u4e00\u8d77\u7684\u524d\u7f00\u3002\u6c42\u51fa $|S_1|+ |S_2| + \\cdots + |S_k|$\u3002\n\n### \u9898\u89e3\n\n\u9996\u5148\u8003\u8651 $S_i$\uff0c\u5fc5\u7136\u662f $\\text{pre}(A,i)$ \u7684\u4e00\u4e2a\u5faa\u73af\u8282\uff0c\u800c\u6bcf\u4e2a\u5faa\u73af\u8282\u90fd\u5bf9\u5e94\u7740\u4e00\u4e2a $\\text{Border}$\uff0c\u540c\u65f6 $\\text{Border}$ \u7684\u957f\u5ea6\u4e0e\u8be5\u5faa\u73af\u8282\u957f\u5ea6\u7684\u548c\u4e3a\u539f\u4e32\u957f\u5ea6\u3002\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u4ece $\\text{Border}$ \u89d2\u5ea6\u8003\u8651\u6b64\u95ee\u9898\uff0c\u627e\u51fa\u6700\u77ed\u7684 $\\text{Border}$ \u5373\u627e\u51fa\u6700\u957f\u7684\u5faa\u73af\u8282\u3002\n\n\u53ef\u4ee5\u8fd0\u7528\u5931\u914d\u6811\u7684\u601d\u60f3\uff0c\u5728\u5931\u914d\u6811\u4e2d\u4e00\u4e2a\u8282\u70b9\u7684\u6700\u77ed $\\text{Border}$ \u4e3a\u5176\u5230\u6839\u8282\u70b9\u7684\u8def\u5f84\u4e0a\u9664\u6839\u8282\u70b9\u5916\u79bb\u8ddf\u6839\u8282\u70b9\u6700\u8fd1\u7684\u70b9\u3002\n\n\u6240\u4ee5\u76f4\u63a5\u4f7f\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u8fd9\u68f5\u6811\u5373\u53ef\u3002\n\n### \u7ec6\u8282\n\n\u6ce8\u610f\u5e76\u67e5\u96c6\u4e2d\u6709\u4e00\u70b9\u6bd4\u8f83\u5bb9\u6613\u51fa\u9519\u3002\u5728 $\\text{find}$ \u51fd\u6570\u4e2d\u5f53 $\\text{fa}[x]=0$ \u65f6\u8fd4\u56de\u800c\u4e0d\u662f $\\text{fa}[x]=x$ \u65f6\u8fd4\u56de\u3002\uff08\u56e0\u4e3a\u6839\u8282\u70b9\u4e0d\u7edf\u8ba1\u5728\u5185\uff09\n\n[Code Here](https://www.luogu.com.cn/paste/jh430sxt)",
        "postTime": 1592345993,
        "uid": 319914,
        "name": "Aftershock",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3435 \u3010[POI2006]OKR-Periods of Words\u3011"
    },
    {
        "content": "\u53d1\u73b0\u8fd9\u9053\u6c34\u9898\uff0c\u7f51\u4e0a\u8fd8\u6ca1\u6709\u9898\u89e3\u7528\u54c8\u5e0c\u3002\n\n~~\uff08\u672c\u840c\u65b0\u4e0d\u4f1akmp\uff09\n~~\n\n\u90a3\u6211\u5c31\u8865\u53d1\u4e00\u7bc7hash\u7684\u9898\u89e3\n\n\u5176\u5b9e\u5224\u65ad\u524d\u7f00\u5f88\u597d\u60f3\n\n\u53ea\u8981\u8003\u8651\u600e\u4e48\u5224\u65ad\u540e\u7f00\u5373\u53ef\n\n\u770bA\u662f\u4e0d\u662fQQ\u7684\u524d\u7f00\n\n\u5c31\u662f\u5224\u65adA-Q\u4e0eQ\u7684\u5bf9\u5e94\u90e8\u5206\u662f\u4e0d\u662f\u76f8\u7b49\u5373\u53ef\n\n\u7b54\u6848\u5177\u6709\u5355\u8c03\u6027\uff0c\u6ee1\u8db3\u4e8c\u5206\u6761\u4ef6\n\n\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\u533a\u95f4\u6700\u503c\u5373\u53ef\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff08nlogn\uff09\n\n\u6ce8\u610f\u54c8\u5e0c\u8981\u7528unsigned long long\u7684\u81ea\u7136\u6ea2\u51fa\n\nunsigned int \u5f88\u5bb9\u6613\u88ab\u5361hash WA\u3002\u3002\u3002\n\n\u5b57\u7b26\u4e32\u91cchash\u8fd8\u662f\u5f88\u597d\u7528\u7684\n\n\u4f46\u662fKMp\u5343\u4e07\u4e0d\u8981\u50cf\u6211\u8fd9\u79cd\u840c\u65b0\u4e00\u6837\u4e0d\u4f1a\u554a\u3002\u3002\u3002\u3002\n\n```cpp\n//code by luotc\n#include<bits/stdc++.h>\n\nusing namespace std;\n\n#define mid ((l+r)>>1)\n#define lson k<<1,l,mid\n#define rson k<<1|1,mid+1,r\n#define ull unsigned long long \n\nconst int maxn=1e6+5,base=131;\nint n,tree[maxn<<2];\null hsh[maxn],bas[maxn];\nchar s[maxn];\null ans;\n\ninline bool check(int ll,int rr){\n\treturn (hsh[rr-ll+1]==hsh[rr]-hsh[ll-1]*bas[rr-ll+1]);\n}\n\ninline void update(int k,int l,int r,int L,int R,int dat){\n\tif(L==l&&r==R){\n\t\ttree[k]=max(tree[k],dat);\n\t\treturn;\n\t}\n\tif(R<=mid) update(lson,L,R,dat);\n\telse if(L>mid) update(rson,L,R,dat);\n\telse update(lson,L,mid,dat),update(rson,mid+1,R,dat);\n}\n\ninline int query(int k,int l,int r,int pos){\n\tif(l==r) return tree[k];\n\tif(pos<=mid) return max(tree[k],query(lson,pos));\n\telse return max(tree[k],query(rson,pos));\n}\n\nint main(){\n\tcin>>n;\n\tcin>>(s+1);\n\tfor(int i=1;i<=n;i++)\n\t\thsh[i]=hsh[i-1]*base+s[i]-'a';\n\tbas[0]=1;\n\tfor(int i=1;i<=n;i++) bas[i]=bas[i-1]*base;\n//\tcout<<check(3,4)<<endl;\n\tfor(int i=1;i<n;i++){\n\t\tint l=i+1,r=min(n,2*i),ret=0;\n\t\twhile(l<=r){\n\t\t\tif(check(i+1,mid)) ret=mid,l=mid+1;\n\t\t\telse r=mid-1;\n\t\t}\n\t//\tcout<<i<<' '<<ret<<endl;\n\t\tif(ret!=0) update(1,1,n,i+1,ret,i);\n\t}\n\tfor(int i=2;i<=n;i++) ans+=query(1,1,n,i);\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```\n\n\n",
        "postTime": 1569374634,
        "uid": 118918,
        "name": "whyl",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3435 \u3010[POI2006]OKR-Periods of Words\u3011"
    },
    {
        "content": "\u5e7f\u544a\uff1a[Blog\u91cc\u89c2\u8d4f\u66f4\u4f73](https://stevenmhy.tk/archives/620a89de.html)\n\n### $Pro$\n\n\u5b9a\u4e49\u4e00\u4e2a\u4e32$A$\u662f$Q$\u7684\u5468\u671f\uff0c\u4ec5\u5f53$A$\u662f$Q$\u7684$proper$\u524d\u7f00\uff08\u5373$A!=Q$\u7684\u610f\u601d\uff09\uff0c\u800c\u4e14$Q$\u662f$AA$\u7684\u524d\u7f00\uff08\u6ca1\u6709$proper$\u7684\u9650\u5236\uff09\u3002\u6bd4\u5982\u8bf4$abab$\u548c$ababab$\u662f$abababa$\u7684\u5468\u671f\u3002\n\n\u7ed9\u4f60\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u6c42\u51fa\u5b83\u6240\u6709\u524d\u7f00\u7684\u6700\u5927\u5468\u671f\u957f\u5ea6\u4e4b\u548c\u3002\n\n### $Sol$\n\n![](https://ae01.alicdn.com/kf/H591e3227195a424c945a85bc4cc14babH.png)\n\n\u9996\u5148\u5148\u628a$A,Q$\u753b\u51fa\u6765\u3002\n\n![](https://ae01.alicdn.com/kf/H055fd29a953c41cbac6dc5b555642ffcW.png)\n\n\u53d1\u73b0\u7eff\u8272\u90e8\u5206\u662f\u76f8\u7b49\u7684\uff0c\u800c\u4e14\u7eff\u8272\u90e8\u5206\u662f$A$\u7684\u771f$border$\uff08\u65e2\u662f$A$\u7684\u524d\u7f00\u53c8\u662f$A$\u7684\u540e\u7f00\u800c\u4e14\u4e0d\u7b49\u4e8e$A$\uff09\u3002\n\n\u53d1\u73b0\u5468\u671f\u957f\u5ea6\u4e3a$len(Q)-len(border)$\uff0c\u4e8e\u662f\u60f3\u8ba9\u5468\u671f\u5c3d\u91cf\u957f\uff0c\u5c31\u8981$border$\u5c3d\u91cf\u77ed\u3002\n\n\u95ee\u9898\u8f6c\u5316\u4e3a\u6c42$A$\u7684\u6bcf\u4e2a\u524d\u7f00\u7684\u6700\u77ed\u975e\u7a7a$border$\u3002\n\n\u8fd9\u5c31\u63d0\u793a\u6211\u4eec\u5efa\u7acb$fail$\u6811\uff0c\u4f55\u8c13$fail$\u6811\uff0c\u5c31\u662f$i$\u5411$next[i]$\u8fde\u8fb9\u5f62\u6210\u7684\u6811\u5f62\u7ed3\u6784\u3002\n\n\u53d1\u73b0$i$\u5230\u6839\u8282\u70b9\u7684\u8def\u5f84\u4e0a\u7684\u8282\u70b9\u4ee3\u8868$A[1 \\to i]$\u7684\u6240\u6709$border$\u3002\n\n\u5177\u4f53\u8bc1\u660e\u53c2\u89c1[\u8fd9\u7bc7\u535a\u5ba2](https://stevenmhy.tk/archives/428b39ea.html)\u3002\n\n![](https://ae01.alicdn.com/kf/H1e53b6bbd96b4f088a1f7d3a97f8c897d.png)\n\n\u5efa\u51fa$fail$\u6811\u4e4b\u540e\uff0c\u53d1\u73b0\u5bf9\u4e8e\u548c$0$\u76f8\u90bb\u7684\u6240\u6709\u8282\u70b9\uff0c\u5b83\u7684\u5b50\u6811\u91cc\u9762\u7684\u6240\u6709\u8282\u70b9\u7684\u6700\u77ed\u975e\u7a7a$border$\u7684\u957f\u5ea6\u90fd\u4e3a\u8fd9\u4e2a\u8282\u70b9\u7684\u6807\u53f7\uff0c\u5f88\u597d\u7406\u89e3\u3002\n\n\u4e8e\u662f\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u7c7b\u4f3c\u4e8e\u67d3\u8272\u7684\u65b9\u6cd5\uff0c$O(n)$\u5730\u8ba1\u7b97\u51fa\u6765\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9\u7684\u6700\u77ed\u975e\u7a7a$border$\u7684\u957f\u5ea6\u3002\n\n\u6700\u540e\u7edf\u8ba1\u7b54\u6848\u626b\u4e00\u904d\u5373\u53ef\uff0c\u8bb0\u5f97\u5f00long long\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define MAXN 1000005\nusing namespace std;\ninline int read(){\n\tint x=0,f=1;\n\tchar ch=getchar();\n\twhile (ch<'0'||ch>'9'){\n\t\tif (ch=='-') f=-1;\n\t\tch=getchar();\n\t}\n\twhile (ch>='0'&&ch<='9'){\n\t\tx=(x<<1)+(x<<3)+(ch^'0');\n\t\tch=getchar();\n\t}\n\treturn x*f;\n}\nchar a[MAXN];\nint nex[MAXN];\nvector<int>G[MAXN];\nint num[MAXN];\ninline void dfs(int u,int father,int color){\n\tnum[u]=color;\n\tfor (register int i=0;i<G[u].size();++i){\n\t\tif (color==0) dfs(G[u][i],u,G[u][i]);\n\t\telse dfs(G[u][i],u,color);\n\t}\n}\nint main(){\n\tint n=read();\n\tscanf(\"%s\",a+1);\n\tint j=0;\n\tfor (register int i=2;i<=n;++i){\n\t\twhile (j&&a[j+1]!=a[i]) j=nex[j];\n\t\tif (a[j+1]==a[i]) ++j;\n\t\tnex[i]=j;\n\t}\n\tfor (register int i=1;i<=n;++i){\n\t\tG[nex[i]].push_back(i);\n\t}\n\tdfs(0,0,0);\n\tlong long ans=0;\n\tfor (register int i=1;i<=n;++i){\n\t\tans+=i-num[i];\n\t}\n\tprintf(\"%lld\\n\",ans);\n}\n```\n\n",
        "postTime": 1572790771,
        "uid": 45109,
        "name": "Steven_Meng",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3435 \u3010[POI2006]OKR-Periods of Words\u3011"
    },
    {
        "content": "1468\uff1aOKR-Periods of Words\n\n\u65f6\u95f4\u9650\u5236: 1000 ms         \u5185\u5b58\u9650\u5236: 65536 KB\n\u63d0\u4ea4\u6570: 276     \u901a\u8fc7\u6570: 123 \n\u3010\u9898\u76ee\u63cf\u8ff0\u3011\n\u539f\u9898\u6765\u81ea\uff1aPOI 2006\n\n\u4e32\u662f\u6709\u9650\u4e2a\u5c0f\u5199\u5b57\u7b26\u7684\u5e8f\u5217\uff0c\u7279\u522b\u7684\uff0c\u4e00\u4e2a\u7a7a\u5e8f\u5217\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u4e32\u3002\u4e00\u4e2a\u4e32 P \u662f\u4e32 A \u7684\u524d\u7f00\uff0c\u5f53\u4e14\u4ec5\u5f53\u5b58\u5728\u4e32 B\uff0c\u4f7f\u5f97 A=PB\u3002\u5982\u679cP\u2260A\u5e76\u4e14 P \u4e0d\u662f\u4e00\u4e2a\u7a7a\u4e32\uff0c\u90a3\u4e48\u6211\u4eec\u8bf4 P \u662f A \u7684\u4e00\u4e2a proper \u524d\u7f00\u3002\n\n\u5b9a\u4e49 Q \u662f A \u7684\u5468\u671f\uff0c\u5f53\u4e14\u4ec5\u5f53 Q \u662f A \u7684\u4e00\u4e2a proper \u524d\u7f00\u5e76\u4e14 A \u662f QQ \u7684\u524d\u7f00\uff08\u4e0d\u4e00\u5b9a\u8981\u662f proper \u524d\u7f00\uff09\u3002\u6bd4\u5982\u4e32 abab \u548c ababab \u90fd\u662f\u4e32 abababa \u7684\u5468\u671f\u3002\u4e32 A \u7684\u6700\u5927\u5468\u671f\u5c31\u662f\u5b83\u6700\u957f\u7684\u4e00\u4e2a\u5468\u671f\u6216\u8005\u662f\u4e00\u4e2a\u7a7a\u4e32\uff08\u5f53 A \u6ca1\u6709\u5468\u671f\u7684\u65f6\u5019\uff09\uff0c\u6bd4\u5982\u8bf4\uff0cababab \u7684\u6700\u5927\u5468\u671f\u662f abab\u3002\u4e32 abc \u7684\u6700\u5927\u5468\u671f\u662f\u7a7a\u4e32\u3002\n\n\u7ed9\u51fa\u4e00\u4e2a\u4e32\uff0c\u6c42\u51fa\u5b83\u6240\u6709\u524d\u7f00\u7684\u6700\u5927\u5468\u671f\u957f\u5ea6\u4e4b\u548c\u3002\n\n\u3010\u8f93\u5165\u3011\n\u7b2c\u4e00\u884c\u4e00\u4e2a\u6574\u6570 k\uff0c\u8868\u793a\u4e32\u7684\u957f\u5ea6\u3002\n\n\u63a5\u4e0b\u6765\u4e00\u884c\u8868\u793a\u7ed9\u51fa\u7684\u4e32\u3002\n\n\u3010\u8f93\u51fa\u3011\n\u8f93\u51fa\u4e00\u4e2a\u6574\u6570\u8868\u793a\u5b83\u6240\u6709\u524d\u7f00\u7684\u6700\u5927\u5468\u671f\u957f\u5ea6\u4e4b\u548c\u3002\n\n\u3010\u8f93\u5165\u6837\u4f8b\u3011\n8\nbabababa\n\u3010\u8f93\u51fa\u6837\u4f8b\u3011\n24\n\u3010\u63d0\u793a\u3011\n\u6570\u636e\u8303\u56f4:\n\n\u5bf9\u4e8e\u5168\u90e8\u6570\u636e\uff0c1<k<106\u200b\u200b \u3002\n\n\u3010\u6765\u6e90\u3011\n\nNo\n\n\n\n\n\u5bf9\u4e8e\u4e00\u4e2a\u4e32 \u5982\u679c\u8981\u6c42\u4ed6\u7684\u6700\u957f\u5468\u671f\n\u5148\u8981\u6c42\u51fa\u6700\u77ed\u7684\u524d\u7f00\u540e\u7f00\u76f8\u540c\u7684\u524d\u7f00\u7684\u4f4d\u7f6e\n\u4f8b\u5982babab  \u4f4d\u7f6e\u5c31\u662f0\n\u8fd9\u4e2a\u4f4d\u7f6e\u5bf9\u5e94\u5230\u53f3\u8fb9\u4e5f\u6709\u4e00\u4e2a\u76f8\u540c\u7684b\nbabab \u51cf\u53bb\u6700\u540e\u4e00\u4e2ab \u5c31\u662f\u6700\u957f\u5468\u671fbaba\n\u7b54\u6848\u4e3ai\u51cf\u53bb\u8fd9\u4e2a\u4f4d\u7f6e\n\n\u518d\u5982bbcaefbbc  \u90a3\u4e2a\u4f4d\u7f6e\u662f2\n\n\u600e\u4e48\u6c42\u8fd9\u4e2a\u4f4d\u7f6e\n\u7531kmp\u7b97\u6cd5\nnext[i]\u8868\u793a0\u5230i\u4e2d \u6700\u957f\u7684\u524d\u7f00\u540e\u7f00\u76f8\u540c\u7684\u524d\u7f00\u7684\u4f4d\u7f6e\n\n\u82e5\u8981\u6c42\u6700\u77ed\u7684\u524d\u7f00\u540e\u7f00\u76f8\u540c\u7684\u524d\u7f00\u7684\u4f4d\u7f6e\n\u5219\u9012\u5f52\n\u57280\u5230i\u4e2d\n\u8fd9\u4e2a\u4f4d\u7f6ej=next[next[next[i]] \u8981\u9012\u5f52\u597d\u591a\u6b21\n\t\tint j=i;\n\t\twhile(f[j]!=-1)j=f[j];\n        \n        \n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint k;\nchar st[1000000+100];\nint f[1000000+100];\nint main()\n{\n\tscanf(\"%d\",&k);\n\tscanf(\"%s\",st);\n\tf[0]=-1;\n\tlong long ans=0;\n\tfor(int i=1;i<k;i++)\n\t{\n\t\tint j=f[i-1];f[i]=-1;\n\t\twhile(j>=0&&st[j+1]!=st[i])j=f[j];\t\t\n\t\tif(st[j+1]==st[i])f[i]=j+1;\n\t\telse \n\t\t{\n\t\t\tf[i]=-1;\n\t\t\tcontinue;\n\t\t}\n\t}\n\n\tfor(int i=1;i<k;i++)\n\t{\n\t\tif(f[i]==-1)continue;\n\t\tint j=i;\n\t\twhile(f[j]!=-1)j=f[j];\n\t\tf[i]=j;\n\t\t\n\t\tans+=i-j;\n\t\t\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "postTime": 1572351948,
        "uid": 90562,
        "name": "\u6211\u8981\u8003\u5317\u5927",
        "ccfLevel": 4,
        "title": "OKR-Periods of Words \u2014\u2014kmp\u7b97\u6cd5"
    },
    {
        "content": "**\u9898\u89e3**\n*1.\u5206\u6790*\n\u5148\u7ffb\u8bd1\u4e00\u4e0b\u8fd9\u9053\u8ba9\u4eba\u65e0\u6cd5\u770b\u61c2\u7684\u9898\u3002\n\u7ed9\u51fa\u4e00\u4e2a\u6570\u7ec4\uff0c\u957f\u5ea6\u4e3an\u3002\n\u4f60\u9700\u8981\u5bf9\u5b83\u7684n\u4e2a\u524d\u7f00\u8fdb\u884c\u64cd\u4f5c\n\u64cd\u4f5c\uff1a\u6bd4\u5982\u73b0\u5728\u6211\u4eec\u9700\u8981\u64cd\u4f5c\u524d\u7f00i\u3002\u4f60\u9700\u8981\u627e\u51fa\u8be5i\u5b57\u7b26\u4e32\u7684\u6700\u5927\u5468\u671f\u3002\u5e76\u4e14\u628an\u4e2a\u524d\u7f00\u7684\u6700\u5927\u5468\u671f\u7684\u503c\u52a0\u8d77\u6765\u3002\n\u65e2\u7136\u9700\u8981\u52a0\u4e0a\u6700\u5927\u5468\u671f\uff0c\u90a3\u4e48\u600e\u4e48\u6c42\u6700\u5927\u5468\u671f\u5462\uff1f\n\u5982\u56fe\uff0c\u6bcf\u4e2a\u5b57\u7b26\u4e32\u90fd\u53ef\u4ee5\u5206\u4e3a\u4e09\u4e2a\u5c0f\u5b57\u7b26\u4e32\uff0c\u6211\u4eec\u79f0\u4e3a1,2,3\u53f7\uff1b\uff08\u4ece\u5de6\u5f80\u53f3\u7684\u987a\u5e8f\uff09\n\u5f531\u53f73\u53f7\u5b8c\u5168\u76f8\u7b49\u65f6\uff0c1\u548c2\uff0c\u6216\u80052\u548c3\u5c31\u6784\u6210\u4e86\u4e00\u4e2a\u5468\u671f\uff1b\n\u6700\u5927\uff1a\u4e5f\u5c31\u662f1\u548c3\u8d8a\u5c0f\u65f6\u5468\u671fT\u5c31\u4f1a\u8d8a\u5927\n![\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0](https://img-blog.csdnimg.cn/20190829163603821.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mzg4OTEyMQ==,size_16,color_FFFFFF,t_70)\n\u6839\u636e\u524d\u540e\u76f8\u7b49\u7684\u6027\u8d28\uff081\u53f7\u548c3\u53f7\uff09\uff0c\u6211\u4eec\u5f88\u81ea\u7136\u5c31\u60f3\u5230\u4e86KMP\u4e2d\u7684next\u6570\u7ec4\uff08\u6211\u4e60\u60ef\u7528p\u6570\u7ec4\u6765\u8868\u793a\uff09\u3002\u90a3\u4e48\u600e\u4e48\u6c42\u6700\u5c0f\u5462\uff0c\u6211\u4eec\u4e00\u76f4\u9012\u5f52\u4e0b\u53bb\u5c31\u597d\u4e86\n\u653e\u4e00\u6bb5\u4f2a\u4ee3\u7801\u5427\uff1b\n\n```cpp\nll print()\n{\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint j=i;\n\t\twhile(next[j]) j=next[j];\n\t\tans+=i-j;\n\t\tif(next[i]) next[i]=j;\n\t\t //\u8fd9\u91cc\u662f\u4e00\u4e2a\u4f18\u5316\uff0c\u76f8\u5f53\u4e8e\u4ee5\u540e\u6211\u5728\u8bbf\u95eenext[i]\uff0c\u53ef\u4ee5\u4e00\u6b65\u5230\u4f4d\uff0c\u6709\u70b9\u50cf\u5e76\u67e5\u96c6\u7684\u4f18\u5316\n\t\t //\u5982\u679c\u8fd9\u91cc\u4e0d\u4f18\u5316\u7684\u5316\u5e94\u8be5\u4f1a\u670960\u5206\n      //\u8fd9\u4e2a\u4f18\u5316\u6211\u662f\u5728\u9898\u89e3\u91cc\u9762\u6284\u6765\u7684\uff0c\u611f\u8c22\u90a3\u4f4d\u5927\u4f6c\n\t}\n\treturn ans;\n}\n```\n*2.\u9644\u4e0aAC\u4ee3\u7801+\u6ce8\u91ca*\n\n```c\n#include<bits/stdc++.h>\n#define maxn 1000005\n#define ll long long int \nusing namespace std;\nint n;\nchar a[maxn];\nint next[maxn];\nvoid pre()\n{\n\tnext[1]=0;\n\tint j=0;\n\tfor(int i=1;i<n;i++)\n\t{\n\t\twhile(j>=1&&a[i+1]!=a[j+1]) j=next[j];\n\t\tif(a[i+1]==a[j+1]) j++;\n\t\tnext[i+1]=j;\n\t}\n}\nll ans=0;\nll print()\n{\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint j=i;\n\t\twhile(next[j]) j=next[j];\n\t\tans+=i-j;\n\t\tif(next[i]) next[i]=j; \n\t}\n\treturn ans;\n}\nint main()\n{\n\tcin>>n;\n\tcin>>a+1;//\u6570\u7ec4\u9996\u9879\u4ecea[1]\u5f00\u59cb\n\tpre();\n\tcout<<print();\n\treturn 0;\n}\n```\n",
        "postTime": 1567068667,
        "uid": 179309,
        "name": "\u957f\u6c5f\u8c5a",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3435 \u3010[POI2006]OKR-Periods of Words\u3011"
    },
    {
        "content": "\u8003\u8651\u5bf9\u6bcf\u4e2a $i$ \u6c42\u51fa $s[i,n]$ \u4e0e $s[1,n]$ \u7684 lcp\n\n\u5bf9\u4f4d\u7f6e $i$ \uff0c\u5047\u8bbe lcp \u957f\u5ea6\u4e3a $p$ \uff0c\u90a3\u4e48\u663e\u7136\u4ee5\u533a\u95f4 $[i,i+p-1]$ \u4e3a\u7ed3\u675f\u7684\u524d\u7f00\u90fd\u53ef\u4ee5\u4f7f\u7528 $[1,i-1]$ \u4f5c\u4e3a\u5468\u671f\n\n\u4e8b\u5b9e\u4e0a\u9700\u8981\u5b9e\u73b0\u4e00\u4e2a\u533a\u95f4\u53d6 $\\max$ \uff0c\u76f4\u63a5\u66b4\u529b\u662f\u5e26 $\\log$ \u7684\n\n\u4f46\u662f\u6211\u4eec\u8003\u8651\u7528\u6269\u5c55 kmp \u5b9e\u73b0\u7684\u65f6\u5019\uff0c\u52a0\u5165 $[i,n]$ \u7684 lcp \u4e00\u5b9a\u6bd4 $[j,n](j<i)$ \u66f4\u4f18\uff0c\u4e8e\u662f\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u5355\u8c03\u6808\u5373\u53ef\n\n---\n\n**Code:**\n```cpp\n#include <cstdio>\n#include <cctype>\n#include <cstring>\n#include <algorithm>\n#define ll long long\nusing std::min;\n#define gc() getchar()\ntemplate <class T>\nvoid read(T &x)\n{\n    x=0;char c=gc();\n    while(!isdigit(c)) c=gc();\n    while(isdigit(c)) x=x*10+c-'0',c=gc();\n}\nconst int N=1e6+10;\nint n,sta[N],z[N],tot;\nchar s[N];\nll ans;\nint main()\n{\n    read(n),scanf(\"%s\",s+1);\n    for(int mx=0,l=0,i=2;i<=n;i++)\n    {\n        z[i]=i<=mx?min(z[i-l+1],mx-i+1):0;\n        while(s[i+z[i]]==s[z[i]+1]) ++z[i];\n        if(i+z[i]-1>=mx) l=i,mx=i+z[i]-1;\n        if(z[i]) sta[++tot]=i;\n        while(tot&&i>=sta[tot]+z[sta[tot]]) --tot;\n        if(tot) ans+=sta[tot]-1;\n    }\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n\n```",
        "postTime": 1562249082,
        "uid": 63727,
        "name": "ButterflyDew",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3435 \u3010[POI2006]OKR-Periods of Words\u3011"
    },
    {
        "content": "\u611f\u8c22will7101\u70b9\u62e8\u3002\n\n\n\u8fd9\u4e2a\u9898\u5e76\u975e\u6734\u7d20\u6c42next\u6570\u7ec4\uff0c\u697c\u4e0b\u7684\u601d\u8def\u662f\u6b63\u786e\u7684\u4f46Code\u5e76\u4e0d\u6b63\u786e\u3002\n\n\n\u4e00\u5f00\u59cb\u8bfb\u9898\u6ca1\u8bfb\u61c2\u9898\u610f\u3002\n\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff1aaba\u7684proper period\u662fab\uff0c\u56e0\u4e3aab\u662faba\u7684\u524d\u7f00\u4e14aba\u662fabab\u7684\u5468\u671f\u3002\n\n\n\u4ea4\u53c9\u91cd\u53e0\u90e8\u5206\u5c31\u662f\u9898\u76ee\u8981\u6c42\u7684\u5468\u671f\n\n\n\u6734\u7d20\u7684next\u6570\u7ec4\u4e3a\uff1a0 0 1 2 3 4 5 6\n\n\n\u6b63\u786e\u7684next\u6570\u7ec4\u5e94\u8be5\u662f\u7528\u957f\u5ea6\u51cf\u6389\u4e24\u6bb5\u4ea4\u53c9\u7684\u90e8\u5206\uff08\u4e24\u6bb5\u4ea4\u53c9\u7684\u90e8\u5206\u662f\u6700\u5c0f\u5468\u671f\uff0c\u6240\u4ee5\u526a\u6389\u540e\u5c31\u662f\u6700\u5927\u7684\u9898\u76ee\u8981\u6c42\u7684\u5468\u671f\uff09\n\n\n\u5373\u5bf9next\u6c42\u51fa\u540e\u518d\u8fdb\u884c\u4e00\u6b21\u5904\u7406\uff0c\u5c06\u540e\u9762\u7684\u6307\u5411\u524d\u9762\u7684\u627e\u5230\u4ea4\u53c9\u90e8\u5206\u7136\u540e\u7528\u957f\u5ea6\u51cf\u6389\u3002\n\n\ncode:\n    \n```cpp\n#include<cstdio>\n#include<cstring>\nusing namespace std;\nlong long ans;\nchar s[1000005];\nint next[1000005];\nint main(){\n    int n;\n    scanf(\"%d\",&n);\n    scanf(\"%s\",s+1);\n    int j=0;\n    for(int i=2;i<=n;i++){\n        while(j!=0&&s[i]!=s[j+1]){\n            j=next[j];    \n        }\n        if(s[i]==s[j+1]){\n            j++; \n            next[i]=j;    \n        } \n    }\n    for(int i=1;i<=n;i++){\n        if(next[next[i]]!=0){\n            next[i]=next[next[i]];\n        }\n    }\n    for(int i=1;i<=n;i++){\n        if(next[i]!=0){\n            ans+=i-next[i];\n        }\n    }\n    printf(\"%lld\",ans);\n    return 0;\n}\n```",
        "postTime": 1510143228,
        "uid": 20609,
        "name": "\u6e21\u6d77",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3435 \u3010[POI2006]OKR-Periods of Words\u3011"
    },
    {
        "content": "\u3010POI\u8865\u5168\u8ba1\u5212#19 POI2006 OKR\u3011\n\n\u6839\u636e\u6570\u636e\u8303\u56f4\u731c\u7b97\u6cd5\uff01\u8fd9\u9898\u4e00\u770b\u5c31\u8981\u6c42\u51fanext\u6570\u7ec4\n\n\u63a5\u4e0b\u6765\u60f3\u4e00\u4e0b\u9898\u76ee\u91cc\u8bf4\u7684\u201c\u5468\u671f\u201d\u4ee3\u8868\u7740\u4ec0\u4e48\u2014\u2014\u67d0\u6bb5\u540e\u7f00\u4e0e\u67d0\u6bb5\u524d\u7f00\u76f8\u7b49\u4e14\u6ca1\u6709\u91cd\u53e0\u90e8\u5206\n\n\u4e8e\u662f\u6c42\u6700\u957f\u5468\u671f\u4e32\u5c31\u7b49\u4ef7\u4e8e\u6c42\u6700\u77ed\u524d\u7f00\u4f7f\u5f97\u8be5\u524d\u7f00\u7b49\u4e8e\u4e00\u4e2a\u7b49\u957f\u7684\u540e\u7f00\n\n\u8fd9\u4e2a\u4fe1\u606f\u53ef\u4ee5\u901a\u8fc7next\u6570\u7ec4\u4e0d\u505c\u5f80\u524d\u8df3\uff08\u76f4\u5230\u6700\u540e\u4e00\u4e2a\u975e0\u4f4d\u7f6e\uff09\u5f97\u5230\n\nP.S.\u4e0d\u8981\u5fd8\u8bb0\u5f00long long\uff08\u6211\u5c31\u662f\u56e0\u4e3a\u8fd9\u4e2a\u6302\u4e86\u4e24\u6b21orz\uff09\n\n\u6700\u540e\u8d34\u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\nchar str[1234567];\nint fail[1234567],to[1234567];\nint main()\n{\n    int len;\n    scanf(\"%d\",&len);\n    scanf(\"%s\",str+1);\n    int k=0;\n    long long ans=0;\n    for(int i=2;i<=len;++i)\n    {\n        while(k&&str[k+1]!=str[i])k=fail[k];\n        if(str[k+1]==str[i])++k;\n        fail[i]=k;\n    }\n    for(int i=1;i<=len;++i)\n    {\n        if(fail[i])to[i]=to[fail[i]];\n        else to[i]=i;\n        ans+=i-to[i];\n    }\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1506594174,
        "uid": 3346,
        "name": "oscar",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3435 \u3010[POI2006]OKR-Periods of Words\u3011"
    },
    {
        "content": "\u6211\u4eec\u53d1\u73b0A\u9700\u8981\u662fQQ\u7684\u524d\u7f00\u624d\u884c\n\n\u53d1\u73b0\u5e94\u8be5\u524d\u7f00\u662f\u8fd9\u6837\u7684\u4e00\u4e2a\u56fe\n\nCCCBBBBBBCCCBBBBB\n\nXXXAAAAAANNN\n\n\u8bbeCCCBBBBB\u4e3a\u539f\u6765\u7684Q\n\n\u4e0a\u9762\u7684\u5b57\u7b26\u4e32\u662fQQ\uff0c\u5e95\u4e0b\u7684\u662fA\u4e32\n\n\u53d1\u73b0\u56e0\u4e3a\u6807\u53f7\u4e3aB\u7684\u5b57\u7b26\u4e32\u5e76\u4e0d\u5bf9A\u662f\u5426\u662fQQ\u7684\u524d\u7f00\u6709\u5f71\u54cd\n\n\u53ea\u8981\u6807\u53f7\u4e3aX\u7684\u90e8\u5206\u7b49\u4e8e\u6807\u53f7\u4e3aN\u7684\u90e8\u5206\n\nA\u5c31\u662fQQ\u7684\u524d\u7f00\uff0cQ\u7684\u957f\u5ea6\u7b49\u4e8eA\u7684\u957f\u5ea6-\u6807\u53f7\u4e3aX\u6216N\u7684\u957f\u5ea6\n\n\u6240\u4ee5\u6211\u4eec\u8981\u6c42\u7684\u662fX\u6216N\u7684\u6700\u5c0f\u957f\u5ea6\uff0c\u4e14\u4e0d\u5f97\u7b49\u4e8e\u96f6\n\n\u5c31\u662fA\u7684\u6700\u5c0f\u516c\u5171\u524d\u7f00\u540e\u7f00\u957f\u5ea6\uff08\u4e0d\u4e3a\u96f6\uff09\uff0c\u548cnext\u7684\u5b9a\u4e49\u521a\u597d\u76f8\u53cd\n\n\u90a3\u4e48\u4eceA\u7684next\u5f00\u59cb\u679a\u4e3e\uff0c\u6bcf\u6b21\u679a\u4e3enext\u7684next\uff0c\u5c31\u53ef\u4ee5\u904d\u5386\n\nA\u6240\u6709\u7684\u516c\u5171\u524d\u7f00\u540e\u7f00\uff0c\u7136\u540e\u53d6\u6700\u5c0f\u7684\u5c31\u53ef\u4ee5\u4e86\n\n\u4f46\u662f\u8fd9\u6837\u505a\u662f\u4f1aT\u7684\uff0c\u6211\u4eec\u53d1\u73b0\u6bcf\u6b21\u8f6c\u79fb\u65f6\u4f1a\u7528\u5230\u4e0a\u4e00\u4e2a\u70b9\u7684\n\n\u89e3\uff0c\u800c\u4e14\u5982\u679c\u8fd9\u4e2a\u89e3\u5df2\u88ab\u6c42\u51fa\u5b83\u5c31\u662f\u6052\u5b9a\u7684\n\n\uff08\u5177\u4f53\u7684\u8bdd\u628a\u6211\u4ee3\u7801\u91cc\u7684\u6ce8\u91ca\u6253\u5f00\uff0c\u5c31\u53ef\u4ee5\u975e\u5e38\u6e05\u695a\u7684\u770b\u5230\u539f\u7406\uff09\n\n\u90a3\u4e48\u628anxt\u66f4\u65b0\u6210\u8fd9\u4e2a\u95ee\u9898\u7684\u89e3\uff0c\u5c31\u53ef\u4ee5\u4fdd\u5b58\u4e86\n\n\u4e0a\u4ee3\u7801~\n\n\n\n\n\n```cpp\n#include<cstdio>\n#include<cstring>\nusing namespace std;\nint nxt[1000010];\nchar mde[1000010];\nint n;long long res;\nvoid gnxt()//\u6c42nxt\n{\n    nxt[1]=0;\n    for(int i=2;i<=n;i++)\n    {\n        int p=i-1;\n        while(1)\n        {\n            p=nxt[p];\n            if(mde[p+1]==mde[i])\n            {\n                nxt[i]=p+1;\n                break;\n            }\n            if(p==0)break;\n        }\n    }\n    return;\n}\nint main()\n{\n    scanf(\"%d\",&n);\n    scanf(\"%s\",mde+1);\n    gnxt();\n    for(int i=1;i<=n;i++)\n    {\n        //printf(\"%d:\",i);\n        int p=i;\n        while(nxt[p]!=0)//\u679a\u4e3e\u6240\u6709\u516c\u5171\u524d\u540e\u7f00\n        { \n            //printf(\"%d->\",p);\n            p=nxt[p];\n        }\n        if(nxt[i]!=0)//\u907f\u514d\u6d17\u6389\u7ec8\u6b62\u6761\u4ef6\n        {\n            nxt[i]=p;//\u4fdd\u5b58\u89e3\n        }\n        //printf(\"%d\\n\",p);\n        res+=i-p;//\u8ba1\u7b97\n    }\n    printf(\"%lld\",res);\n    return 0;//\u62dc\u62dc\u7a0b\u5e8f~\n}\n\n```",
        "postTime": 1510983992,
        "uid": 56384,
        "name": "shadowice1984",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3435 \u3010[POI2006]OKR-Periods of Words\u3011"
    }
]
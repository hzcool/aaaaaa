[
    {
        "content": "\u524d\u7f6e\u77e5\u8bc6\uff1a[P1196](https://www.luogu.com.cn/problem/P1196) \u548c [ABC238E](https://www.luogu.com.cn/problem/AT_abc238_e)\u3002\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u4e24\u4e2a\u7eff\u9898\u7f1d\u5408\u8d77\u6765\u53d8\u6210\u9ec4\u9898\u4e86\u3002\r\n\r\n\u9996\u5148\u8003\u8651\u600e\u4e48\u5224\u65ad\u65e0\u89e3\u7684\u60c5\u51b5\u3002[\u89c1\u8fd9\u7bc7\u9898\u89e3](https://www.luogu.com.cn/blog/lovely-seele/solution-at-abc238-e)\r\n\r\n\u89c2\u5bdf\u5230\u539f\u6570\u7ec4\u7684\u5177\u4f53\u53d6\u503c\u5e76\u4e0d\u91cd\u8981\uff0c\u6211\u4eec\u9700\u8981\u7684\u53ea\u662f\u533a\u95f4 $ [l,r] $ \u7684\u548c\u4e3a $ sum_r-sum_{l-1} $\uff0c\u5176\u4e2d $ sum $ \u4ee3\u8868\u524d\u7f00\u548c\u3002\r\n\r\n\u4e8e\u662f\u4e0d\u96be\u60f3\u5230\u4e00\u4e2a\u601d\u8def\uff1a\u5bf9\u4e8e\u7ed9\u5b9a\u7684\u4e00\u4e2a\u533a\u95f4 $ [l,r] $\uff0c\u5efa\u65e0\u5411\u8fb9 $ (l-1,r) $\uff0c\u4ee3\u8868\u7531 $ sum_r $ \u7684\u4fe1\u606f\u80fd\u63a8\u51fa $ sum_{l-1} $ \u7684\u4fe1\u606f\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002\r\n\r\n\u4e8e\u662f\u6211\u4eec\u5df2\u77e5 $ sum_0=0 $\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u8be2\u95ee\uff0c\u95ee\u9898\u8f6c\u5316\u4e3a\u4ece\u56fe\u4e0a\u7684 $ l-1 $ \u8282\u70b9\u80fd\u5426\u5230\u8fbe $ r $\u3002\u8fd9\u4e2a\u53ef\u4ee5\u76f4\u63a5\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u3002\u5f53\u4e24\u4e2a\u7aef\u70b9\u4e0d\u8fde\u901a\u5219\u4ee3\u8868\u65e0\u89e3\u3002\r\n\r\n\u4f46\u662f\u73b0\u5728\u6211\u4eec\u9664\u4e86\u77e5\u9053\u662f\u5426\u8fde\u901a\u4e4b\u5916\u8fd8\u9700\u8981\u77e5\u9053\u5177\u4f53\u7684\u533a\u95f4\u548c\uff0c\u4e8e\u662f\u8003\u8651\u5728\u5e76\u67e5\u96c6\u4e0a\u7ef4\u62a4\u4e00\u4e2a $ val $\uff0c\u8868\u793a\u5f53\u524d\u533a\u95f4\u5230\u6839\u8282\u70b9 $ 0 $ \u7684\u8ddd\u79bb\uff0c\u521d\u59cb\u8bbe\u4e3a $ 0 $\uff0c\u5f53\u5408\u5e76\u4e24\u4e2a\u96c6\u5408\u65f6\u5c06\u4e24\u4e2a\u96c6\u5408\u5bf9\u5e94\u7684 $ val $ \u503c\u5408\u5e76\u5373\u53ef\uff0c\u5219\u5982\u679c\u5f53\u524d\u533a\u95f4\u548c\u80fd\u88ab\u8ba1\u7b97\u51fa\u6765\u5219\u533a\u95f4\u548c\u4e3a $ val_r-val_{l-1} $\u3002\r\n\r\n\u65f6\u95f4\u590d\u6742\u5ea6 $ \\mathcal{O}(n) $\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\r\n\r\n\u53cc\u500d\u7ecf\u9a8c\uff1a[hdu3038](http://acm.hdu.edu.cn/showproblem.php?pid=3038)\uff0c\u601d\u8def\u57fa\u672c\u662f\u4e00\u81f4\u7684\u3002\r\n\r\n\u4ee3\u7801\uff1a\r\n\r\n```cpp\r\n#import <bits/stdc++.h>\r\nusing namespace std;\r\n#define int long long\r\nconst int maxn=200000+10;\r\nint n,m,a,b,s;\r\nint par[maxn],val[maxn];\r\nvoid init(int l,int r)\r\n{\r\nfor(int i=l;i<=r;i++) \r\npar[i]=i,val[i]=0;\r\n}\r\nint find(int x)\r\n{\r\n    if(par[x]==x) \r\n    return x;\r\n    else\r\n    {\r\n        int root=find(par[x]);\r\n        val[x]+=val[par[x]];\r\n        return \r\n        par[x]=root;\r\n    }\r\n}\r\nsigned main()\r\n{\r\n    cin>>n>>m;\r\n    int q;\r\n    cin>>q;\r\n    init(0,n);\r\n    int ans=0;\r\n    for(int i=1,a,b,s;i<=m;i++)\r\n    {\r\n        scanf(\"%lld%lld%lld\",&a,&b,&s); \r\n        a--;\r\n        int t1=find(a),t2=find(b);\r\n        if(t1!=t2)\r\n        {\r\n            par[t2]=t1;\r\n            val[t2]=-val[b]+s+val[a];\r\n        }\r\n    }\r\n    while(q--)\r\n    {\r\n        scanf(\"%d%d\",&a,&b); \r\n        a--;\r\n        int t1=find(a),t2=find(b);\r\n        if(t1!=t2)\r\n        cout<<\"UNKNOWN\\n\";\r\n        else\r\n        cout<<val[b]-val[a]<<'\\n';\r\n    }\r\n}\r\n```\r\n",
        "postTime": 1668316195,
        "uid": 714821,
        "name": "loser_seele",
        "ccfLevel": 4,
        "title": "P8779\u9898\u89e3"
    },
    {
        "content": "\u5206\u6790\uff1a\n\n\u770b\u5230\u9898\u89e3\u91cc\u6709\u7528\u5dee\u5206\u7ea6\u675f\u505a\u7684\uff0c\u6211\u8fd9\u91cc\u63d0\u4f9b\u4e00\u79cd\u7528 **\u5e26\u6743\u5e76\u67e5\u96c6** \u7684\u505a\u6cd5\u3002\n\n\u4ee4 $sum_i$ \u8868\u793a\u4ee5 $i$ \u4e3a\u7ed3\u5c3e\u7684\u524d\u7f00\u548c\u3002\n\n\u5bf9\u4e8e\u7ed9\u5b9a\u7684 $l$\uff0c$r$\uff0c$S$\uff1a\n\n\u628a $l$ \u51cf\u53bb $1$\uff0c\u56e0\u4e3a\u524d\u7f00\u548c\u76f8\u51cf\u7684\u65b9\u6cd5\u662f $sum_r - sum_{l-1}$\u3002\n\n\u9996\u5148\u6211\u4eec\u5224\u65ad $l$ \u548c $r$ \u662f\u5426\u5728\u540c\u4e00\u4e2a\u5e76\u67e5\u96c6\u91cc\u3002\n\n\u5982\u679c\u4e0d\u5728\uff0c\u5219\u5408\u5e76\u4e24\u4e2a\u5e76\u67e5\u96c6\u3002\n\n\u5426\u5219\uff1a\n\n\u4ee4 $fl$ \u8868\u793a $l$ \u5e76\u67e5\u96c6\u7684\u4ee3\u8868\u5143\u7d20\uff0c$fr$ \u4e3a $r$ \u5e76\u67e5\u96c6\u91cc\u7684\u4ee3\u8868\u5143\u7d20\u3002\n\n\u8ba9 $fl$ \u7684\u4ee3\u8868\u5143\u4e3a $fr$\uff0c\u6240\u4ee5\n\n```cpp\nfa[fl]=fr;\n```\n\n\u6b64\u65f6\u8ba1\u7b97 $sum$ \u503c\uff1a\n\n```cpp\nsum[fl]=-x-sum[l]+sum[r];\n```\n\n\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u4f1a\u662f\u8fd9\u6837\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/l0j7oujo.png)\n\n\n\u6700\u540e\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8be2\u95ee $l$ \u548c $r$\uff0c\n\n\u82e5 $l$ \u548c $r$ \u4e0d\u5728\u4e00\u4e2a\u5e76\u67e5\u96c6\u91cc\uff0c\u5219\u65e0\u89e3\u3002\n\n\u5426\u5219\uff0c\u8f93\u51fa $sum_r - sum_{l-1}$\u3002\n\ncode:\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\n\nconst int maxn=2*1e5+10;\nint fa[maxn],sum[maxn];\n\nint find(int x)\n{\n\tif (fa[x]==x) return fa[x];\n\t\n\tint t=find(fa[x]);\n\tsum[x]+=sum[fa[x]];\n\tfa[x]=t;\n\t\n\treturn fa[x];\n}\n\nsigned main()\n{\n\tint n,m,q;\n\tscanf(\"%lld%lld%lld\",&n,&m,&q);\n\t\n\tfor (int i=1;i<=n;i++) fa[i]=i;\n\t\n\tint ans=0;\n\twhile (m--)\n\t{\n\t\tint l,r,x;\n\t\tscanf(\"%lld%lld%lld\",&l,&r,&x);\n\t\t\n\t\tl--;\n\t\t\n\t\tint fl=find(l),fr=find(r);\n\t\t\n\t\tif (fl!=fr)\n\t\t{\n\t\t\tfa[fl]=fr;\n\t\t\tsum[fl]=-x-sum[l]+sum[r];\n\t\t}\n\t}\n\t\n\twhile (q--){\n\t\tint l,r;\n\t\tscanf(\"%lld%lld\",&l,&r);\n\t\tl--;\n\t\t\n\t\tint fl=find(l),fr=find(r);\n\t\t\n\t\tif (fl!=fr) printf(\"UNKNOWN\\n\");\n\t\telse printf(\"%lld\\n\",sum[r]-sum[l]);\n\t}\n\treturn 0; \n}\n```\n\n",
        "postTime": 1682076575,
        "uid": 546301,
        "name": "past_tense",
        "ccfLevel": 0,
        "title": "P8779 \u9898\u89e3"
    },
    {
        "content": " \u5bf9\u4e8e\u5df2\u77e5\u7684\u533a\u95f4 $[l,r]$ \u7684\u548c\u4e3a $s$ \uff0c\u7528\u524d\u7f00\u548c $sum_i - sum_{l-1}=s$ \u8868\u793a\uff0c\u6839\u636e\u5dee\u5206\u7ea6\u675f\u5efa\u56fe\u51c6\u5219\uff0c\u76f8\u5f53\u4e8e\u70b9 $l-\n 1$ \u5230\u70b9 $r$ \u957f\u5ea6\u4e3a $s$ \uff0c$r$ \u5230 $l - 1$ \u957f\u5ea6\u4e3a $-s$ \u3002\n \n \u5efa\u597d\u56fe\u4e4b\u540e\uff0c\u6bcf\u6b21\u8be2\u95ee\u4e00\u4e2a\u533a\u95f4 $[al,ar]$ \u7684\u548c\uff0c\u76f8\u5f53\u4e8e\u8be2\u95ee $sum[ar]-sum[al-1]$ \u7684\u503c\u3002\n \n \u9996\u5148\u8981\u4fdd\u8bc1 $al-1$ \u548c $ar$ \u5728\u540c\u4e00\u4e2a\u8fde\u901a\u5757\u4e2d\uff0c\u5176\u6b21\u6bcf\u4e2a\u8fde\u901a\u5757\u53ea\u9700\u8981\u968f\u4fbf\u4e00\u4e2a\u70b9\u521d\u59cb\u5316\u4e3a0\uff0c\u7136\u540e\u6309\u7167\u8fb9\u957f\u6269\u5c55\u5373\u53ef\u3002\u8fd9\u662f\u7531\u4e8e\u7b49\u53f7\uff0c\u4e0d\u7ba1\u600e\u4e48\u8d70\uff0c\u76f8\u5bf9\u5dee\u503c\u662f\u4e0d\u53d8\u7684\u3002\n \n\u5e7f\u5ea6\u4f18\u5148\u641c\u7d22\u3001\u6df1\u5ea6\u4f18\u5148\u641c\u7d22\u5747\u53ef\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int maxn = 10005;\nconst ll INF = -1e13;\nint n, m, q;\ntemplate <typename T>\ninline T read(T& x) {\n  x = 0;\n  T w = 1;\n  char ch = 0;\n  while (ch < '0' || ch > '9') {\n    if (ch == '-') w = -1;\n    ch = getchar();\n  }\n  while (ch >= '0' && ch <= '9') {\n    x = x * 10 + (ch - '0');\n    ch = getchar();\n  }\n  return x = x * w;\n}\nstruct edge\n{\n    int v; ll w;\n    edge(){}\n    edge(int v, ll w):v(v), w(w){}\n};\nvector<edge>Map[maxn];\nll sum[maxn];\nbool vis[maxn];\nvoid dfs(int u, ll d)\n{\n    vis[u] = 1;\n    sum[u] = d;\n    for(auto x : Map[u])\n    {\n        int v = x.v; ll w = x.w;\n        if(vis[v])continue;\n        dfs(v, d + w);\n    }\n}\nqueue<pair<int,ll> >Q;\nvoid bfs(int u, ll d)\n{\n    vis[u] = 1;\n    sum[u] = d;\n    Q.push(make_pair(u, d));\n    while(!Q.empty())\n    {\n        auto now = Q.front();\n        Q.pop();\n        int u = now.first; ll d = now.second;\n        for(auto x : Map[u])\n        {\n            int v = x.v; ll w = x.w;\n            if(vis[v])continue;\n            vis[v] = 1;\n            sum[v] = d + w;\n            Q.push(make_pair(v, d + w));\n        }\n    }\n}\nint f[maxn];\nint Find(int x)\n{\n    return x == f[x] ? x : f[x] = Find(f[x]);\n}\nint main()\n{\n    read(n);read(m);read(q);\n    for(int i = 0; i <= n; i++)f[i] = i;\n    for(int i = 1; i <= m; i++)\n    {\n        int l, r; ll s;\n        read(l);read(r);read(s);\n        ///cout<<l<<\" \"<<r<<\" \"<<s<<endl;\n        ///sum[r] - sum[l - 1] = s\n        Map[l - 1].push_back(edge(r, s));\n        Map[r].push_back(edge(l - 1, -s));\n        f[Find(l - 1)] = Find(r);\n    }\n    for(int i = 0; i <= n; i++)if(!vis[i])\n        bfs(i, 0);\n    while(q--)\n    {\n        int l, r;\n        read(l), read(r);\n        --l;\n        if(Find(l) != Find(r))puts(\"UNKNOWN\");\n        else printf(\"%lld\\n\", sum[r] - sum[l]);\n    }\n    return 0;\n}\n\n```\n",
        "postTime": 1669457463,
        "uid": 719648,
        "name": "Lord_Sky2048",
        "ccfLevel": 4,
        "title": "\u641c\u7d22"
    }
]
[
    {
        "content": "\u6709\u70b9\u65e0\u8da3\u7684\u9898\u76ee\u3002\n\n\u8fd9\u9898\u662f [P1606](https://www.luogu.com.cn/problem/P1606) \u7684\u52a0\u5f3a\u7248\u3002\u5927\u90e8\u5206\u601d\u8def\u4e0e\u90a3\u9898\u4e00\u81f4\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\uff0c\u5c06\u5b83\u5411\u5b83\u80fd\u76f4\u63a5\u6216\u901a\u8fc7\u8377\u53f6\u95f4\u63a5\u5230\u8fbe\u7684\u70b9\u8fde\u4e00\u6761\u6709\u5411\u8fb9\u3002\u5982\u679c\u8fde\u5411\u6c34\u7684\u8bdd\u8fb9\u6743\u4e3a 1\uff0c\u8fde\u5411\u94c2\u91d1\u7684\u8bdd\u8fb9\u6743\u4e3a 2\u3002\n\n\u8dd1\u6700\u77ed\u8def\uff0c\u987a\u4fbf\u7ef4\u62a4\u4e00\u4e0b[\u65b9\u6848\u6570](https://www.luogu.com.cn/problem/P1144)\uff0c\u94c2\u91d1\u6700\u5927\u503c\u548c\u94c2\u91d1\u65b9\u6848\u6570\u3002\u603b\u4f53\u601d\u8def\u548c P1606 \u51e0\u4e4e\u6ca1\u6709\u5dee\u522b\u3002\uff08\u6240\u4ee5\u6211\u6628\u5929\u4e3a\u4ec0\u4e48\u95f2\u7684\u6ca1\u4e8b\u5728\u90a3\u91cc\u6572 A\\*\uff09\n\nCode:\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define pid(x, y) ((x - 1) * n + (y - 1))\nint m, n, p;\nstruct Edge {\n\tint to, next, w;\n} e[200005];\nint head[905], len;\nvoid Insert(int u, int v, int w) {\n\te[++len].to = v;\n\te[len].next = head[u];\n\te[len].w = w;\n\thead[u] = len;\n}\nint mp[905];\nint sx, sy, tx, ty;\nint d[905], pt[905];\nll f[905], g[905];\nbool vis[905], mkd[905];\nstruct ND {\n\tint num, dis;\n\tbool operator<(const ND &o) const {\n\t\treturn dis > o.dis;\n\t}\n};\nvoid dfs(int x, int y, int rx, int ry) {\n\tvis[pid(x, y)] = true;\n\tint dx[] = {2, 2, -2, -2, 1, 1, -1, -1};\n\tint dy[] = {1, -1, 1, -1, 2, -2, 2, -2};\n\tfor (int i = 0; i < 8; i++) {\n\t\tif (x + dx[i] < 1 || x + dx[i] > m || y + dy[i] < 1 || y + dy[i] > n) continue;\n\t\tif (mp[pid(x + dx[i], y + dy[i])] == 0) {\n\t\t\tif (!mkd[pid(x + dx[i], y + dy[i])]) Insert(pid(rx, ry), pid(x + dx[i], y + dy[i]), 1);\n\t\t\tmkd[pid(x + dx[i], y + dy[i])] = true;\n\t\t}\n\t\telse if (mp[pid(x + dx[i], y + dy[i])] == 4) {\n\t\t\tif (!mkd[pid(x + dx[i], y + dy[i])]) Insert(pid(rx, ry), pid(x + dx[i], y + dy[i]), 0);\n\t\t\tmkd[pid(x + dx[i], y + dy[i])] = true;\n\t\t}\n\t\telse if (mp[pid(x + dx[i], y + dy[i])] == 5) {\n\t\t\tif (!mkd[pid(x + dx[i], y + dy[i])]) Insert(pid(rx, ry), pid(x + dx[i], y + dy[i]), 2);\n\t\t\tmkd[pid(x + dx[i], y + dy[i])] = true;\n\t\t}\n\t\telse if (mp[pid(x + dx[i], y + dy[i])] == 1) {\n\t\t\tif (!vis[pid(x + dx[i], y + dy[i])]) dfs(x + dx[i], y + dy[i], rx, ry);\n\t\t}\n\t}\n}\nvoid Dijkstra() {\n\tpriority_queue<ND> q;\n\tq.push({pid(sx, sy), 0});\n\tmemset(d, 0x3f, sizeof(d));\n\td[pid(sx, sy)] = 0;\n\tf[pid(sx, sy)] = 1;\n\tg[pid(sx, sy)] = 1;\n\twhile (!q.empty()) {\n\t\tint u = q.top().num; q.pop();\n\t\tfor (int i = head[u]; i; i = e[i].next) {\n\t\t\tint v = e[i].to;\n\t\t\tif (d[v] == d[u] + e[i].w) {\n\t\t\t\tf[v] += f[u];\n\t\t\t\tif (pt[v] == pt[u] + (e[i].w == 2)) {\n\t\t\t\t\tg[v] += g[u];\n\t\t\t\t}\n\t\t\t\telse if (pt[v] < pt[u] + (e[i].w == 2)) {\n\t\t\t\t\tpt[v] = pt[u] + (e[i].w == 2);\n\t\t\t\t\tg[v] = g[u];\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (d[v] > d[u] + e[i].w) {\n\t\t\t\td[v] = d[u] + e[i].w;\n\t\t\t\tf[v] = f[u];\n\t\t\t\tg[v] = g[u];\n\t\t\t\tpt[v] = pt[u] + (e[i].w == 2);\n\t\t\t\tq.push({v, d[v]});\n\t\t\t}\n\t\t}\n\t}\n}\nint main() {\n\tscanf(\"%d%d%d\", &p, &m, &n);\n\tfor (int i = 1; i <= m; i++) {\n\t\tfor (int j = 1; j <= n; j++) {\n\t\t\tscanf(\"%d\", &mp[pid(i, j)]);\n\t\t\tif (mp[pid(i, j)] == 3) {\n\t\t\t\tsx = i; sy = j;\n\t\t\t\tmp[pid(i, j)] = 0;\n\t\t\t}\n\t\t\telse if (mp[pid(i, j)] == 4) {\n\t\t\t\ttx = i; ty = j;\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i = 1; i <= m; i++) {\n\t\tfor (int j = 1; j <= n; j++) {\n\t\t\tmemset(vis, 0, sizeof(vis));\n\t\t\tmemset(mkd, 0, sizeof(mkd));\n\t\t\tif (mp[pid(i, j)] == 0 || mp[pid(i, j)] == 5) dfs(i, j, i, j);\n\t\t}\n\t}\n\tDijkstra();\n\tif (d[pid(tx, ty)] > p) {\n\t\tputs(\"-1\");\n\t\treturn 0;\n\t}\n\tprintf(\"%d %lld\\n\", d[pid(tx, ty)], f[pid(tx, ty)]);\n\tif (!pt[pid(tx, ty)]) {\n\t\tputs(\"-1\");\n\t\treturn 0;\n\t}\n\tprintf(\"%d %lld\\n\", pt[pid(tx, ty)], g[pid(tx, ty)]);\n\treturn 0;\n}\n```",
        "postTime": 1671062803,
        "uid": 363415,
        "name": "251Sec",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2644 \u767d\u91d1\u83b2\u82b1\u6c60"
    }
]
[
    {
        "content": "[P8114 [Cnoi2021]\u516d\u8fb9\u5f62\u6218\u58eb](https://www.luogu.com.cn/problem/P8114) \u89e3\u9898\u62a5\u544a\uff1a\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/xiaoziyao/p/15882721.html)\n\n## \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a\u4e09\u6761\u8fb9\u5206\u522b\u6709 $a,b,c$ \u4e2a\u516d\u8fb9\u5f62\u7684\u516d\u8fb9\u5f62\u7f51\u7edc\uff0c\u6c42\u7f51\u7edc\u4e0a\u6240\u6709\u8fb9\u7ec4\u6210\u7684\u4e8c\u5206\u56fe\u7684\u5b8c\u7f8e\u5339\u914d\u6570\u91cf\u3002\n\n$1\\leqslant a,b,c\\leqslant 10^6$\u3002\n\n## \u5206\u6790\n\n\u975e\u4eba\u529b\u53ef\u53ca\u7684\u5de8\u5927\u795e\u4ed9\u9898\uff0c\u819c\u62dc bzy\u3002\n\n\u8003\u8651\u5c06\u5339\u914d\u6309\u7167\u671d\u5411\u5206\u6210\u4e09\u7c7b\uff1a\u5e73\u3001\u671d\u4e0a\u3001\u671d\u4e0b\uff0c\u5c06\u4e09\u79cd\u5339\u914d\u6309\u7167\u7c7b\u578b\u67d3\u4e0a\u4e0d\u540c\u7684\u989c\u8272\uff0c\u7136\u540e\u8003\u5bdf\u5176\u5bf9\u5e94\u7684\u4e09\u89d2\u5f62\u7f51\u7edc\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rptzphhh.png)\n\n\uff08\u56fe\u6765\u81ea [Solara570-\u5728\u4e8c\u7ef4\u4e16\u754c\u4e2d\u89e3\u51b3\u770b\u4f3c\u7acb\u4f53\u7684\u5e73\u9762\u95ee\u9898](https://www.bilibili.com/video/av200522733)\uff09\n\n\u53ef\u4ee5\u8bc1\u660e\u67d3\u8272\u65b9\u6cd5\u53ef\u4ee5\u4e0e\u5e73\u9762\u7684\u7acb\u65b9\u4f53\u51f8\u5806\u53e0\u4e00\u4e00\u5bf9\u5e94\u3002\n\n\u8003\u5bdf\u9ad8\u5ea6 $v$ \u4e0e\u9ad8\u5ea6 $v+1$ \u7684\u5206\u754c\u7ebf\uff0c\u5c06\u8fd9 $c$ \u6761\u5206\u754c\u7ebf\u753b\u51fa\u6765\uff0c\u53ef\u4ee5\u53d1\u73b0\u8def\u5f84 $i$ \u53ef\u4ee5\u4e0e\u8def\u5f84 $i+1$ \u91cd\u53e0\uff0c\u4f46\u662f\u4e0d\u80fd\u8d8a\u8fc7\u3002\n\n![](https://bzy369258147.github.io/CNOI/%E3%80%8CCNOI2021%E3%80%8DCirno's%20Easy%20Round%20II/F%20-%20Hexagon/p6.png)\n\n\uff08\u56fe\uff0c\u4ee5\u53ca\u4e0b\u9762\u7684\u56fe\u90fd\u6765\u81ea\u5b98\u65b9\u9898\u89e3\uff09\n\n\u5c06\u7b2c $i$ \u6761\u8def\u5f84\u5411\u53f3\u4e0a\u5e73\u79fb $i-1$ \u683c\uff0c\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u65b0\u7684\u7f51\u683c\uff0c\u53ef\u4ee5\u53d1\u73b0\u6b64\u65f6\u5df2\u7ecf\u8f6c\u5316\u6210 LGV \u80fd\u89e3\u51b3\u7684\u95ee\u9898\u4e86\uff0c\u76f4\u63a5\u5217\u51fa\u77e9\u9635\uff0c\u6c42\u884c\u5217\u5f0f\u5373\u53ef\u505a\u5230\u7acb\u65b9\u590d\u6742\u5ea6\u4e86\u3002\n\n![](https://bzy369258147.github.io/CNOI/%E3%80%8CCNOI2021%E3%80%8DCirno's%20Easy%20Round%20II/F%20-%20Hexagon/p7.png)\n\n\u5217\u51fa\u77e9\u9635\uff0c\u5bb9\u6613\u53d1\u73b0\u6bcf\u4e2a\u51fa\u53d1\u70b9\u5230\u6bcf\u4e2a\u7ed3\u675f\u70b9\u7684\u8ddd\u79bb\u90fd\u662f $a+b$\uff0c\u4e14\u7b2c $i$ \u4e2a\u51fa\u53d1\u70b9\u548c\u7b2c $j$ \u4e2a\u5230\u8fbe\u70b9\u7684\u6a2a\u5411\u8ddd\u79bb\u4e3a $a+(x-y)$\uff1a\n\n$$ans=\\det(M)\\\\M=\\begin{bmatrix}{a+b\\choose a}&{a+b\\choose a-1}&\\cdots&{a+b\\choose a+1-c}\\\\{a+b\\choose a+1}&{a+b\\choose a}&\\cdots&{a+b\\choose a+2-c}\\\\\\vdots&\\vdots&\\ddots&\\vdots\\\\{a+b\\choose a+c-1}&{a+b\\choose c-2}&\\cdots&{a+b\\choose a}\\end{bmatrix}$$\n\n\u4e0b\u9762\u5c31\u662f\u4e00\u4e9b dirty work \u4e86\uff1a\n\n$$\\det(M)=\\det(M')\\times\\prod_{i=1}^c\\frac{(a+b)!}{(a+c-i))!(b+i-1)!}\\\\=\\det(M'')\\times\\prod_{i=1}^c\\frac{(a+b)!}{(a+c-i))!(b+i-1)!}\\times(-1)^{\\frac{c(c-1)}{2}}\\\\M_{i,j}'=\\prod_{k=j+1}^c(a+k-i)\\prod_{k=2}^j(b+i-k+1)\\\\M''_{i,j}=\\prod_{k=j+1}^c(a+k-i)\\prod_{k=2}^j(k-b-1-i)$$\n\n\u6839\u636e\u9898\u9762\u63d0\u4f9b\u7684\u516c\u5f0f Krattenthaler\u2019s formula\uff1a\n\n$$\\det(\\prod_{k=2}^j(x_i+a_k)\\prod_{k=j+1}^m(x_i+b_k))_{i,j=1}^n=\\prod_{1\\leqslant i<j\\leqslant n}(x_i-x_j)\\prod_{2<i\\leqslant j\\leqslant n}(a_i-b_j)$$\n\n$$\\det(M'')=\\prod_{1\\leqslant i<j<c}(j-i)\\prod_{2\\leqslant i\\leqslant j\\leqslant c}(a+b+j-i-1)$$\n\n$$\\det(M)=\\prod_{1\\leqslant i<j<c}(i-j)\\prod_{2\\leqslant i\\leqslant j\\leqslant c}(a+b+j-i-1)\\times\\prod_{i=1}^c\\frac{(a+b)!}{(a+c-i))!(b+i-1)!}\\times(-1)^{\\frac{c(c-1)}{2}}\\\\=\\prod_{i=1}^{c-1}(i!)\\prod_{i=1}^{c-1}(a+b+i)^{\\underline i}\\prod_{i=1}^c\\frac{(a+b)!}{(a+c-i)!(b+i-1)!}\\\\=\\prod_{i=1}^{c-1}(i!)\\prod_{i=1}^{c-1}\\frac{(a+b+i)!}{(a+b)!}\\prod_{i=1}^c(a+b)!\\prod_{i=1}^c\\frac{1}{(a+c-i)!}\\prod_{i=1}^c\\frac{1}{(b+i-1)!}\\\\=\\prod_{i=1}^{c-1}(i!)((a+b)!\\times\\prod_{i=1}^c(a+b+i)!)\\frac{\\prod_{i=0}^{a-1}(i!)}{\\prod_{i=0}^{a+c-1}(i!)}\\frac{\\prod_{i=0}^{b-1}(i!)}{\\prod_{i=0}^{b+c-1}(i!)}\\\\=\\frac{H(a)H(b)H(c)H(a+b+c)}{H(a+b)H(b+c)H(a+c)}\\\\H(x)=\\prod_{i=0}^{x-1}(i!)$$\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u7ebf\u6027\u4e86\u3002\n\n## \u4ee3\u7801\n```\n#include<stdio.h>\nconst int maxn=3000005,mod=998244353;\nint a,b,c;\nint fac[maxn],ffac[maxn];\nint ksm(int a,int b){\n\tint res=1;\n\twhile(b){\n\t\tif(b&1)\n\t\t\tres=1ll*res*a%mod;\n\t\ta=1ll*a*a%mod,b>>=1;\n\t}\n\treturn res;\n}\nint main(){\n\tfac[0]=ffac[0]=1;\n\tfor(int i=1;i<maxn;i++)\n\t\tfac[i]=1ll*fac[i-1]*i%mod,ffac[i]=1ll*ffac[i-1]*fac[i]%mod;\n\tscanf(\"%d%d%d\",&a,&b,&c);\n\tprintf(\"%d\\n\",1ll*ffac[a-1]*ffac[b-1]%mod*ffac[c-1]%mod*ffac[a+b+c-1]%mod*ksm(ffac[a+b-1],mod-2)%mod*ksm(ffac[a+c-1],mod-2)%mod*ksm(ffac[b+c-1],mod-2)%mod);\n\treturn 0;\n}\n```",
        "postTime": 1644628604,
        "uid": 35754,
        "name": "Verdandi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P8114\u3010[Cnoi2021]\u516d\u8fb9\u5f62\u6218\u58eb\u3011"
    },
    {
        "content": "\u5f88\u663e\u7136\uff0c\u9898\u76ee\u7b49\u4ef7\u4e8e\u5c06\u4e09\u89d2\u5f62\u7f51\u683c\u5212\u5206\u4e3a\u82e5\u5e72\u4e2a\u83f1\u5f62\u7684\u65b9\u6848\u6570\uff0c\u6bcf\u4e2a\u83f1\u5f62\u7531\u4e24\u4e2a\u4e09\u89d2\u5f62\u7ec4\u6210\uff0c\u800c\u8fd9\u4e2a\u65b9\u6848\u53c8\u4e0e $a\\times b\\times c$ \u7684\u957f\u65b9\u4f53\u4e2d\uff0c\u5806\u53e0\u4e86\u4e00\u4e9b\u9760\u4e00\u5899\u89d2\u653e\u7f6e\u7684 $1\\times 1\\times 1$ \u7684\u5c0f\u6b63\u65b9\u4f53\u7684\u65b9\u6848\u6570\u76f8\u7b49\u3002\n\n\u8003\u8651\u6bcf\u4e2a\u4f4d\u7f6e\u7684\u9ad8\u5ea6\uff0c\u95ee\u9898\u7b49\u4ef7\u4e8e\uff0c\u7ed9\u4e00\u4e2a $a\\times b$ \u7684\u7f51\u683c $h$ \u5185\u586b\u6570\uff0c\u6bcf\u4e2a\u4f4d\u7f6e\u53ef\u4ee5\u586b $[0,c]$ \u4e2d\u7684\u6574\u6570\uff0c\u4e14\u8981\u6ee1\u8db3 $h_{i,j}\\le h_{i+1,j}\\land h_{i,j}\\le h_{i,j+1}$ \u7684\u65b9\u6848\u6570\u3002\n\n\u8bbe $g_{i,j}=h_{i,j}+i$\uff0c\u5219\u6709 $g_{i,j}< g_{i+1,j}\\land g_{i,j}\\le g_{i,j+1}$\uff0c\u4e14\u6240\u6709\u6ee1\u8db3 $g_{i,j}< g_{i+1,j}\\land g_{i,j}\\le g_{i,j+1}$ \u4e14\u6bcf\u4e2a\u4f4d\u7f6e\u90fd\u5728 $[1,a+c]$ \u4e2d\u7684 $g$ \u4e0e $h$ \u4e00\u4e00\u5bf9\u5e94\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c$g$ \u662f\u4e00\u4e2a\u534a\u6807\u51c6\u6768\u8868\uff0c\u6839\u636e\u94a9\u957f\u516c\u5f0f\uff0c\u6211\u4eec\u77e5\u9053\uff0c\u5176\u586b\u6570\u65b9\u6848\u6570\u5373\u4e3a\n\n$$\n\\prod\\limits_{i=1}^a\\prod\\limits_{j=1}^b\\frac{a+c+j-i}{a-i+b-j+1}\\\\\n=\\prod\\limits_{i=1}^a\\prod\\limits_{j=1}^b\\frac{(a+c-i)+j}{(a+b-i+1)-j}\\\\\n=\\prod\\limits_{i=1}^a\\frac{(a+c+b-i)!(a-i)!}{(a+c-i)!(a+b-i)!}\\\\\n=\\frac{f(a+b+c-1)f(a-1)f(c-1)f(b-1)}{f(b+c-1)f(a+c-1)f(a+b-1)}\\\\\nf(n)=\\prod\\limits_{i=1}^ni!\n$$\n\n\u9884\u5904\u7406 $O(a+b+c)$\uff0c\u5355\u6b21\u8be2\u95ee $O(1)$\u3002\n\n```cpp\n#include<iostream>\nusing std::cin;\nusing std::cout;\nint const mod=998244353;\nint fac[3000010],f[3000010],iv[3000010],a,b,c;\nint pow(int x,int y){\n\tint res=1;\n\twhile(y){\n\t\tif(y&1) res=1ll*res*x%mod;\n\t\tx=1ll*x*x%mod,y>>=1;\n\t}\n\treturn res;\n}\nint main(){\n\tstd::ios::sync_with_stdio(false),cin.tie(nullptr);\n\tcin>>a>>b>>c;\n\tint n=a+b+c;\n\tfac[0]=f[0]=1;\n\tfor(int i=1;i<=n;i++) fac[i]=1ll*i*fac[i-1]%mod;\n\tfor(int i=1;i<=n;i++) f[i]=1ll*f[i-1]*fac[i]%mod;\n\tiv[n]=pow(f[n],mod-2);\n\tfor(int i=n;i;i--) iv[i-1]=1ll*iv[i]*fac[i]%mod;\n\tcout<<(1ll*f[n-1]*f[a-1]%mod*f[b-1]%mod*f[c-1]%mod*iv[a+b-1]%mod*iv[a+c-1]%mod*iv[b+c-1]%mod)<<'\\n';\n\treturn 0;\n}\n```\n\n",
        "postTime": 1653830391,
        "uid": 55707,
        "name": "gxy001",
        "ccfLevel": 9,
        "title": "P8114 [Cnoi2021]\u516d\u8fb9\u5f62\u6218\u58eb"
    },
    {
        "content": "\u6b63\u4e09\u89d2\u5f62\u5339\u914d\u4f1a\u5f62\u6210\u4e00\u4e2a\u83f1\u5f62\uff0c\u4e5f\u5c31\u662f\u6c42\u5c06\u516d\u8fb9\u5f62\u5212\u5206\u6210\u82e5\u5e72\u83f1\u5f62\u7684\u65b9\u6848\u6570\u3002\n\n\u6839\u636e\u7ecf\u5178\u7684\u51e0\u4f55\u610f\u4e49\uff0c\u5176\u53c8\u7b49\u4ef7\u4e8e\u7acb\u65b9\u4f53\u7684\u51f8\u5806\u53e0\u65b9\u6848\u6570\u3002\u5c06\u6bcf\u4e2a\u4f4d\u7f6e\u7684\u9ad8\u5ea6\u5199\u6210\u4e00\u4e2a $a\\times b$ \u7684\u77e9\u9635\uff0c\u5176\u4e0e\u6768\u8868\u5f88\u7c7b\u4f3c\uff0c\u5c1d\u8bd5\u5411\u8fd9\u65b9\u9762\u9760\u3002\n\n\u5c06\u7b2c $i$ \u884c\u6240\u6709\u6570\u5b57\u52a0 $i$\uff0c\u77e9\u9635\u4f1a\u5f62\u6210\u503c\u57df $[1,a+c]$ \u7684\u534a\u6807\u51c6\u6768\u8868\uff0c\u4f7f\u7528\u534a\u6807\u51c6\u6768\u8868\u7684\u94a9\u5b50\u516c\u5f0f\uff1a\n\n$$\\prod_{i,j}\\frac{V+j-i}{h_{\\lambda}(i,j)}=\\prod_{i,j}\\frac{a+c+j-i}{(a-i)+(b-j)+1}$$\n\n$$=\\prod_{i,j}\\frac{(a+c-i)+j}{(a+b+1-i)-j}=\\prod_i\\frac{(a+c-i+b)!}{(a+c-i)!}\\cdot\\frac{(a-i)!}{(a+b-i)!}$$\n\n\u8fd9\u5df2\u7ecf\u662f\u53ef\u4ee5\u8ba1\u7b97\u7684\u5f62\u5f0f\u4e86\uff0c\u4f46\u7ed3\u679c\u6709\u4e00\u4e2a\u7279\u522b\u7b80\u6d01\u7684\u5f62\u5f0f\uff1a\uff08\u4ee4 $H(x)=\\sum_{i=0}^{x-1}i!$\uff09\n\n$$=\\frac{H(a+b+c)}{H(b+c)}\\cdot H(a)\\cdot\\frac{H(c)}{H(a+c)}\\cdot\\frac{H(b)}{H(a+b)}$$\n\n$$=\\frac{H(a+b+c)H(a)H(b)H(c)}{H(a+b)H(a+c)H(b+c)}$$\n\n\u4ee3\u7801\u4e0d\u8d34\u4e86\u3002",
        "postTime": 1669018304,
        "uid": 105611,
        "name": "IdnadRev",
        "ccfLevel": 0,
        "title": "\u3010\u6570\u5b66\u8bb0\u5f55\u3011P8114 [Cnoi2021]\u516d\u8fb9\u5f62\u6218\u58eb"
    }
]
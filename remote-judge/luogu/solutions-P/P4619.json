[
    {
        "content": "\u795e\u5947\u53cd\u6f14\u9898\u2026\u2026\n\n\u8003\u9a8c\u4eba\u7c7b\u667a\u6167\u7684\u5361\u5e38\u6570\u2026\u2026\n\n\u540c\u6837\u590d\u6742\u5ea6\u7684\u7b97\u6cd5\u4e00\u4e2a\u8dd130s\u4e00\u4e2a\u8dd12s\u2026\u2026\n\n\u7136\u540e\u76f8\u4fe1\u4f60\u7684\u4fe1\u4ef0\uff0c\u7528\u529b\u5361\u5e38\u6570\u5427\n\n____________________\n## \u672c\u9898\u9898\u89e3\n\n### \u524d\u7f6e\u829d\u58eb:\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n\n\u8bf7\u786e\u4fdd\u4f60\u719f\u7ec3\u638c\u63e1\u4e86\u4ea4\u6362\u03a3\u90a3\u4e00\u5957\u672c\u9898\u89e3\u4e0d\u518d\u8bb2\u53cd\u6f14\u7684\u57fa\u7840\u4e86\n\n_____________\n\n\u9898\u76ee\u8981\u6c42\n\n## $\\sum_{i=1}^{A}\\sum_{j=1}^{B}\\sum_{k=1}^{C}\\sigma_{0}(ijk)$\n\n\u5176\u4e2d$\\sigma_{0}(n)=\\sum_{d|n}1$\n\n\u7136\u540e\u8fd9\u662f\u4e00\u9053\u53cd\u6f14\u9664\u6570\u51fd\u6570$\\sigma$\u7684\u9898\uff0c\u90a3\u4e48\u8fd9\u91cc\u5176\u5b9e\u5bf9\u4e8e\u9664\u6570\u51fd\u6570\u91cc\u8fb9\u7684\u4e58\u79ef\u662f\u6709\u4e00\u4e2a\u5957\u8def\u7684\uff0c\u679a\u4e3e\u6765\u81ea\u4e8e\u5404\u4e2a\u56e0\u5b50\u7684\u4e92\u8d28\u7ea6\u6570\u5bf9\uff0c\u7136\u540e\u76f4\u63a5\u8ba1\u7b97\n\n\u6362\u53e5\u8bdd\u8bf4\uff0c\u5bf9\u4e8e\u5728\u51fd\u6570\u91cc\u8fb9\u7684ijk\u4e58\u79ef\u6765\u8bb2\uff0c\u6211\u4eec\u8003\u8651\u8fd9\u4e2aijk\u7684\u7ea6\u6570\u7684\u6784\u6210\uff0c\u663e\u7136\u662f\u6709\u6765\u81eai\u7684\uff0cj\u7684\uff0ck\u7684\u90e8\u5206\uff0c\u90a3\u4e48\u6211\u4eec\u76f4\u63a5\u679a\u4e3e\u7ea6\u6570\u4e09\u5143\u7ec4\u6c42lcm\u663e\u7136\u662f\u4e0d\u884c\u7684\uff0c\u56e0\u4e3a\u4f1a\u91cd\u590d\u4e00\u5927\u5806\uff0c\u4f46\u662f\u6211\u4eec\u89c2\u5bdf\u91cd\u590d\u7684\u90e8\u5206\u6bcf\u4e00\u4e2alcm\u76f8\u540c\u7684\u4e09\u5143\u7ec4\u96c6\u5f53\u4e2d\u603b\u662f\u6709\u4e00\u4e2a\u4e09\u4e2a\u7ea6\u6570\u4e24\u4e24\u4e92\u8d28\u7684\u90e8\u5206\uff0c\u56e0\u6b64\u53ef\u4ee5\u53ea\u679a\u4e3e\u4e24\u4e24\u4e92\u8d28\u7684\u7ea6\u6570\u4e09\u5143\u7ec4\u2026\u2026\n\n\u8bf4\u4e86\u8fd9\u4e48\u591a\uff0c\u53ea\u662f\u4e3a\u4e86\u8bf4\u660e\u521a\u624d\u7684\u5f0f\u5b50\u53ef\u4ee5\u88ab\u91cd\u5199\u4e3a\u4e0b\u9762\u7684\u8868\u8fbe\u5f0f\n\n### $\\sum_{i=1}^{A}\\sum_{j=1}^{B}\\sum_{k=1}^{C}\\sum_{d|i}\\sum_{t|j}\\sum_{p|k}\\epsilon((d,t))\\epsilon((t,p))\\epsilon((d,p))$\n\n\u4e2d$\\epsilon(x)$\u662f\u5143\u51fd\u6570\uff0c\u5f53\u4e14\u4ec5\u5f53$x=1\\epsilon(x)=1$\uff0c\u5176\u4ed6\u60c5\u51b5\u4e3a0\uff0c$(i,j)$\u662f$gcd(i,j)$\u7684\u7b80\u8bb0\u5f62\u5f0f\n\n\u4e0b\u9762\u662f\u559c\u95fb\u4e50\u89c1\u7684\u4ea4\u6362\u03a3\u73af\u8282\uff01\n\n\u5148\u628a\u8fd9\u4e2a\u5f0f\u5b50\u91cd\u5199\u6210\u8fd9\u6837:\n\n### $\\sum_{i=1}^{A}\\sum_{d|i}\\sum_{j=1}^{B}\\sum_{t|j}\\sum_{k=1}^{C}\\sum_{p|k}\\epsilon((d,t))\\epsilon((t,p))\\epsilon((d,p))$\n\n\u7136\u540e\u53c8\u662f\u7ecf\u5178\u7684\u524d\u8fb9\u662f$1~n$\u987a\u6b21\u679a\u4e3e\u540e\u8fb9\u662f$d|i$\u7ea6\u6570\u679a\u4e3e\u7684\u5f62\u5f0f\uff0c\u6211\u4eec\u4ee4$i/=d$\u5219$i=di$\uff0c\u4ea4\u6362\u6c42\u548c\u53f7\uff0c\u5f97\u5230\n\n## $\\sum_{d=1}^{A}\\sum_{i=1}^{\\lfloor\\frac{A}{d}\\rfloor}\\sum_{j=1}^{B}\\sum_{t|j}\\sum_{k=1}^{C}\\sum_{p|k}\\epsilon((d,t))\\epsilon((t,p))\\epsilon((d,p))$\n\n\u540c\u7406\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528\u76f8\u540c\u7684\u624b\u6cd5\u5904\u7406j\u4e0et,k\u4e0ep\uff0c\u5f97\u5230\n\n## $\\sum_{d=1}^{A}\\sum_{i=1}^{\\lfloor\\frac{A}{d}\\rfloor}\\sum_{t=1}^{B}\\sum_{j=1}^{\\lfloor\\frac{B}{t}\\rfloor}\\sum_{p=1}^{C}\\sum_{k=1}^{\\lfloor\\frac{C}{p}\\rfloor}\\epsilon((d,t))\\epsilon((t,p))\\epsilon((d,p))$\n\n\u7b80\u5355\u6574\u7406\u4e0b\u5f97\u5230\n\n## $\\sum_{d=1}^{A}\\sum_{t=1}^{B}\\sum_{p=1}^{C}\\lfloor\\frac{A}{d}\\rfloor\\lfloor\\frac{B}{t}\\rfloor\\lfloor\\frac{C}{p}\\rfloor\\epsilon((d,t))\\epsilon((t,p))\\epsilon((d,p))$\n\n\u7136\u540e\u6211\u4eec\u8fd0\u7528\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f144\u4e2a\u63a8\u8bba\u4e2d\u7684\u4e00\u4e2a\uff0c\u4f7f\u7528$\\mu$\u6765\u53cd\u6f14$\\epsilon$\u5f97\u5230\n\n### $\\sum_{d=1}^{A}\\sum_{t=1}^{B}\\sum_{p=1}^{C}\\lfloor\\frac{A}{d}\\rfloor\\lfloor\\frac{B}{t}\\rfloor\\lfloor\\frac{C}{p}\\rfloor\\sum_{u|t\\&u|d}\\mu(u)\\sum_{v|t\\&v|p}\\mu(v)\\sum_{w|d\\&w|p}\\mu(w)$\n\n\u597d\u4e86\u53c8\u662f\u5927\u5bb6\u559c\u95fb\u4e50\u89c1\u7684\u4ea4\u6362\u6c42\u548c\u53f7\u7684\u73af\u8282~\n\n\u7136\u540e\u8fd9\u4e00\u6b65\u4ea4\u6362\u6c42\u548c\u53f7\u548c\u5176\u4ed6\u7684\u4ea4\u6362\u6c42\u548c\u53f7\u4e0d\u540c\u7684\u662f\uff0c\u6211\u4eec\u5fc5\u987b\u540c\u65f6\u4ea4\u63623\u5bf9\u6c42\u548c\u53f7\uff0c\u6b64\u65f6\u539f\u6765\u5e38\u7528\u7684\u4ee4\u67d0\u4e00\u4e2a\u53d8\u91cf\u505a\u4e00\u4e2a\u53d8\u6362\u7684\u624b\u6cd5\u5df2\u7ecf\u5931\u6548\u4e86\n\n\u6b64\u65f6\u4ea4\u6362\u6c42\u548c\u53f7\u7684\u51c6\u5219\u5c31\u662f\uff0c\u4fdd\u8bc1\u6bcf\u4e00\u4e2a\u5355\u72ec\u7684\u53d8\u91cf\u88ab\u679a\u4e3e\u4e86\u76f8\u540c\u7684\u6b21\u6570\n\n\u89c2\u5bdf\u9650\u5236\u6761\u4ef6\uff0c\u53d1\u73b0$u|d\\&w|d$,$u|t\\&v|t$,$v|p\\&w|p$\n\n\u7136\u540e\u76f4\u63a5\u6309\u7167\u8fd9\u4e2a\u53d8\u91cf\u7684\u9650\u5236\u6761\u4ef6\u4ea4\u6362\u6c42\u548c\u53f7\u4f1a\u5f97\u5230\n\n## $\\sum_{u=1}^{min(A,B)}\\sum_{v=1}^{min(B,C)}\\sum_{w=1}^{min(A,C)}\\mu(u)\\mu(v)\\mu(w)\\sum_{u|d\\&w|d}\\lfloor\\frac{A}{d}\\rfloor\\sum_{u|t\\&v|t}\\lfloor\\frac{B}{t}\\rfloor\\sum_{v|p\\&w|p}\\lfloor\\frac{C}{p}\\rfloor$\n\n\u7531\u4e8e$u|d\\&w|d$\u5176\u5b9e\u5c31\u662f$lcm(u,w)|d$\uff0c\u6240\u4ee5\u91cd\u65b0\u5199\u4e00\u4e0b\u8868\u8fbe\u5f0f\u5c31\u662f\n\n## $\\sum_{u=1}^{min(A,B)}\\sum_{v=1}^{min(B,C)}\\sum_{w=1}^{min(A,C)}\\mu(u)\\mu(v)\\mu(w)\\sum_{lcm(u,w)|d}\\lfloor\\frac{A}{d}\\rfloor\\sum_{lcm(u,v)|t}\\lfloor\\frac{B}{t}\\rfloor\\sum_{lcm(v,w)|p}\\lfloor\\frac{C}{p}\\rfloor$\n\n\u90a3\u4e48\u51fd\u6570$f(n,x)=\\sum_{n|d}\\lfloor\\frac{x}{d}\\rfloor$\u5176\u5b9e\u662f\u53ef\u4ee5$O(nlogn)$\u7684\u679a\u4e3e\u7ea6\u6570\u5bf9\u4e8e\u67d0\u4e00\u4e2a\u53c2\u6570x\u5904\u7406\u51fa\u6765\u7684\uff0c\u56e0\u6b64\u521a\u624d\u7684\u5f0f\u5b50\u53ef\u4ee5\u5199\u6210\n\n## $\\sum_{u=1}^{min(A,B)}\\sum_{v=1}^{min(B,C)}\\sum_{w=1}^{min(A,C)}\\mu(u)\\mu(v)\\mu(w)f(lcm(u,w),A)f(lcm(u,v),B)f(lcm(v,w),C)$\n\n\u5230\u6b64\u4e3a\u6b62\u53cd\u6f14\u7684\u5de5\u4f5c\u5df2\u7ecf\u505a\u5b8c\u4e86\uff0c\u4e0b\u9762\u8bf7\u8ba9\u6211\u4eec\u6682\u65f6\u5fd8\u8bb0\u6211\u4eec\u4f1a\u5206\u6790\u7b97\u6cd5\u590d\u6742\u5ea6\u8fd9\u4e2a\u4e8b\u5b9e\uff0c\u56e0\u4e3a\u63a5\u4e0b\u6765\u4f60\u4f1a\u89c9\u5f97\u8fd9\u4e2a\u7b97\u6cd5\u7684\u7b97\u6cd5\u590d\u6742\u5ea6\u5341\u5206\u9b54\u5e7b\u2026\u2026\n\n### \u66b4\u529b1\n\n\u6211\u4f1a$O(n^3)$\u679a\u4e3eu,v,w\u6709\u5e8f\u4e09\u5143\u7ec4\uff01\n\n\u606d\u559c\u4f60\u767d\u53cd\u6f14\u4e86\u2026\u2026\n\n### \u66b4\u529b2\n\n\u6211\u4eec\u8003\u8651\u7ed9\u521a\u624d\u7684\u66b4\u529b\u526a\u4e00\u526a\u679d\uff0c\u6211\u4eec\u53d1\u73b0\u4e00\u4e2a\u975e\u5e38\u6709\u8da3\u7684\u4e8b\u5b9e\uff0c\u5c31\u662f\u5982\u679cn>x\u90a3\u4e48$f(n,x)=0$\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u8fd9\u4e2a\u6027\u8d28\u5efa\u51fa\u4e00\u5f20\u56fe\u6765,\u5728\u8fd9\u5f20\u56fe\u4e2d\u5f53\u4e2d\u4e24\u4e2a\u70b9$u,v$\u6709\u8fb9\u5f53\u4e14\u4ec5\u5f53$\\mu(u)!=0,\\mu(v)!=0,lcm(u,v)<max(A,B,C)$,\u7136\u540e\u8fde\u4e00\u6761\u8fb9\u6743\u4e3alcm\u7684\u8fb9\n\n\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u4f1a\u53d1\u73b0\u4e00\u4e2a\u60ca\u4eba\u7684\u4e8b\u5b9e\uff0c\u66b4\u529b1\u4e2d\u6240\u679a\u4e3e\u7684\u4e09\u5143\u7ec4**\u53ef\u80fd**\u6709\u6548\u5f53\u4e14\u4ec5\u5f53\u8fd9\u4e2a\u4e09\u5143\u7ec4\u5728\u8fd9\u5f20\u56fe\u5f53\u4e2d\u6784\u6210\u4e86\u4e00\u4e2a\u4e09\u5143\u73af\u2026\u2026\u4e8e\u662f\u6211\u4eec\u5f00\u59cb\u6d4b\u8bd5\u8fd9\u4e2a\u526a\u679d\u7684\u6548\u7387\n\n\u4f46\u662f\u9996\u5148\u6211\u4eec\u8be5\u5982\u4f55$O(m)$\u800c\u4e0d\u662f$O(n^3)$\u7684\u5efa\u56fe\u5462?\n\n\u7b54\u6848\u662f\u679a\u4e3e\u8fb9\u6743lcm\uff0c\u6211\u4eec\u4e00\u6b21\u6027\u8fde\u51fa\u8fb9\u6743\u4e3ai\u7684\u6240\u6709\u8fb9\uff0c\u90a3\u4e48\u9996\u5148\u6211\u4eec\u53ef\u4ee5$O(nloglogn)$\u7684\u7b5b\u51fa\u6bcf\u4e00\u4e2a\u6570\u7684\u4e92\u5f02\u8d28\u56e0\u5b50\n\n\u4e0b\u9762\u6211\u4eec\u4ece1\u5230max(A,B,C)\u679a\u4e3e\u8fb9\u6743i\uff0c\u9996\u5148\u56e0\u4e3a\u8fd9\u4e2a\u8fb9\u6743\u662f\u4e24\u4e2a$\\mu$\u503c\u4e0d\u4e3a0\n\u7684\u6570\u7684lcm\uff0c\u56e0\u6b64$\\mu(i)!=0$\uff0c\u4e0b\u9762\u6211\u4eec\u76f4\u63a5$2^k$\u7684\u679a\u4e3e\u8fd9\u4e2ai\u7684\u8d28\u56e0\u6570\u5206\u89e3\u96c6\u5408\u7684\u4e00\u4e2a\u5b50\u96c6\uff0c\u7531\u8fd9\u4e2a\u5b50\u96c6\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u5176\u4e2d\u7684\u4e00\u4e2a\u70b9\u7684\u7f16\u53f7u\uff0c\u4e4b\u540e\u6211\u4eec\u8981\u786e\u5b9a\u53e6\u5916\u4e00\u4e2a\u70b9v\u4f46\u662f\u6211\u4eec\u53d1\u73b0v\u4e0d\u662f\u975e\u5e38\u7684\u597d\u679a\u4e3e\u4e86\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u679a$gcd(u,v)$\u663e\u7136\u8fd9\u4e2agcd\u4e00\u5b9a\u662fu\u5bf9\u5e94\u7684\u96c6\u5408\u7684\u5b50\u96c6\uff0c\u56e0\u6b64\u6211\u4eec\u518d\u6b21\u679a\u4e3eu\u7684\u5b50\u96c6\n\u786e\u5b9a\u51fagcd\uff0c\u90a3\u4e48\u5bf9\u5e94\u7684v\u5c31\u662f$i\u00d7gcd/u$\u4e86\u4e4b\u540e\u6211\u4eec\u5c31\u5728u\u548cv\u95f4\u8fde\u4e00\u6761\u8fb9\n\n\u597d\u4e86\u542c\u8d77\u6765\u521a\u624d\u7684\u7b97\u6cd5\u590d\u6742\u5ea6\u76f8\u5f53\u4e0d\u9760\u8c31\uff0c\u5982\u679c\u8bb0$w(d)$\u4e3ad\u7684\u4e92\u5f02\u8d28\u56e0\u5b50\u4e2a\u6570\u7684\u8bdd\uff0c\u6211\u4eec\u7684\u7b97\u6cd5\u590d\u6742\u5ea6\u5c31\u662f$O(\\sum3^{w(d)})$\u6216\u8005$O(m)$\u7684\uff0c\u7136\u540e\u6211\u4eec\u5c1d\u8bd5\u7740\u7528\u8fd9\u4e2a\u7a0b\u5e8f\u8dd1\u4e86\u4e00\u904d$A=B=C=10^5$\u5e76\u4e14\u8bb0\u5f55\u4e00\u4e0b\u6211\u4eec\u5efa\u4e86\u591a\u5c11\u8fb9\uff0c\u7ed3\u679c\u53ef\u80fd\u6709\u4e9b\u4ee4\u4eba\u5403\u60ca\uff0c\u8fb9\u6570\u662f\n\n\n# $\\text{760\uff0c741}$\n\n\u8fd9\u610f\u5473\u7740\u8fd9\u5f20\u56fe\u5b9e\u9645\u4e0a\u76f8\u5f53\u7a00\u758f\u2026\u2026\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u679a\u4e3e\u8fd9\u5f20\u56fe\u7684\u4e09\u5143\u73af\u4e86\n\n\u90a3\u4e48\u8fd9\u91cc\u6211\u4eec\u91c7\u7528\u66b4\u529b\u8fdb\u884c\u679a\u4e3e\uff0c\u66b4\u529b\u7684\u904d\u5386\u6bcf\u4e2a\u7684\u51fa\u8fb9\uff0c\u904d\u5386\u53e6\u4e00\u4e2a\u7aef\u70b9\u7684\u51fa\u8fb9\uff0c\u91c7\u7528\u54c8\u5e0c\u8868\u5224\u65ad\u7b2c3\u4e2a\u70b9\u662f\u5426\u548c\u7b2c\u4e00\u4e2a\u70b9\u6709\u8fde\u8fb9\n\n\u663e\u7136\u8fd9\u4e2a\u7b97\u6cd5\u7684\u590d\u6742\u5ea6\u662f\u4e0d\u5bf9\u7684\uff0c\u968f\u968f\u4fbf\u4fbf\u5c31\u5361\u6210$O(nm)$\u4e86\uff0c\u7136\u540e\u6211\u4eec\u8003\u8651\u7ed9\u8fd9\u4e2a\u7b97\u6cd5\u52a0\u4e2a\u5c0f\u526a\u679d\uff0c\u5c06\u8fb9\u4ece\u65e0\u5411\u8fb9\u6539\u4e3a\u6709\u5411\u8fb9\uff0c\u65b9\u5411\u4e3a\u5ea6\u6570\u5927\u7684\u70b9\u6307\u5411\u5ea6\u6570\u5c0f\u7684\u70b9\uff0c\u4ee4\u4eba\u60ca\u8bb6\u7684\u662f\uff0c\u7b97\u6cd5\u590d\u6742\u5ea6\u9aa4\u51cf\u81f3$O(m\\sqrt{m})$\n\n\u4e0b\u9762\u7ed9\u51fa\u795e\u5947\u7684\u8bc1\u660e\n\n\u6211\u4eec\u79f0\u5ea6\u6570\u8d85\u8fc7$\\sqrt{m}$\u7684\u70b9\u4e3a\u5927\u5ea6\u70b9\uff0c\u5426\u5219\u5c31\u662f\u5c0f\u5ea6\u70b9\uff0c\u7136\u540e\u6211\u4eec\u53d1\u73b0\u4e24\u8fb9\u7aef\u70b9\u90fd\u662f\u5927\u5ea6\u70b9\u7684\u8fb9\u4e0d\u8d85\u8fc7$O(\\sqrt{m})$\u6761\uff0c\u56e0\u6b64\u8fd9\u90e8\u5206\u590d\u6742\u5ea6\u4e3a$O(m\\sqrt{m})$\u5bf9\u4e8e\u5176\u4f59\u7684\u8fb9\u6bcf\u6761\u8fb9\u8d21\u732e\u7684\u590d\u6742\u5ea6\u90fd\u4e0d\u8d85\u8fc7$\\sqrt{m}$\u6240\u4ee5\u603b\u590d\u6742\u5ea6\u4e3a$O(m\\sqrt{m})$\n\n\u90a3\u4e48\u6211\u4eec\u4fe1\u5fc3\u6ee1\u6ee1\u7684\u5199\u4e86\u8fd9\u4e2a\u7b97\u6cd5\u590d\u6742\u5ea6\u4e3a$O(m\\sqrt{m})$\u7684\u66b4\u529b\u4ea4\u4e0a\u53bb\u4e00\u770bT\u621040\u5206\uff0c\u7136\u540e\u6211\u4eec\u89c9\u5f97\u6ca1\u5565\u5927\u4e0d\u4e86\u7684\uff0c\u6bd5\u7adf\u662f\u66b4\u529b\u561b\n\n_________________________\n\n## \u6b63\u89e3\n\n\u4e8e\u662f\u4f60\u53bb\u7ffb\u4e86\u8fd9\u9053\u9898\u7684\u9898\u89e3\uff0c\u9898\u89e3\u544a\u8bc9\u4f60\u606d\u559c\u4f60\u521a\u624d\u7684\u66b4\u529b\u5c31\u662f\u6b63\u89e3\uff0c\u53ea\u662f\u4f60\u7684\u4e09\u5143\u73af\u679a\u4e3e\u53ef\u80fd\u6709\u70b9\u4e0d\u4f18\u7f8e\u4e8e\u662f\u5c31\u534e\u4e3d\u7684T\u98de\u4e86\n\n\u4f60\u53c8\u53bb\u521a\u624d\u7684\u7a0b\u5e8f\u8dd1\u4e86\u4e00\u904d$10^5$\u7684\u70b9\uff0c\u5927\u6982\u9700\u898112s\u2026\u2026\n\n\u53ef\u662f\u6211\u4eec\u4e00\u4e2a\u70b9\u6700\u591a\u8dd12.5s\u2026\u2026\n\n\u4e8e\u662f\u6211\u4eec\u5f00\u59cb\u4e86\u6311\u6218\u4eba\u7c7b\u667a\u6167\u7684\u5361\u5e38\u6570\u4e4b\u65c5\u2026\u2026\n\n\u9996\u5148\u6211\u4eec\u53d1\u73b0\u4e8b\u5b9e\u4e0a\u54c8\u5e0c\u8868\u662f\u4e0d\u5fc5\u8981\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u624b\u52a8\u8ba1\u7b97\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684lcm\u4ece\u800c\u5224\u65ad\u4e24\u4e2a\u70b9\u4e4b\u95f4\u662f\u5426\u6709\u8fde\u8fb9\uff0c\u4e8e\u662f\u4f60\u4fe1\u5fc3\u6ee1\u6ee1\u7684\u52a0\u4e0a\u4e86\u8fd9\u4e2a\u4f18\u5316\uff0c\u53d1\u73b0\u6ca1\u4ec0\u4e48\u5375\u7528\u7684\u5feb\u4e862s\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u53d1\u73b0\u679a\u4e3e\u4e09\u5143\u7ec4\u5176\u5b9e\u662f\u975e\u5e38\u6d88\u8017\u8ba1\u7b97\u8d44\u6e90\u7684\uff0c\u4e8e\u662f\u4f60\u53bb\u6389\u4e86\u539f\u6765\u7684\u56fe\u4e2d\u6240\u6709\u7684\u81ea\u73af\uff0c\u62c9\u51fa\u6765\u5355\u72ec\u679a\u4e3e\uff0c\u7136\u540e\u4f60\u53d1\u73b0\u8fd9\u4e2a\u4f18\u5316\u7684\u975e\u5e38\u7ed9\u529b\uff0c\u4f60\u7684\u7a0b\u5e8f\u53c8\u8dd1\u5feb\u4e861s\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u6211\u4eec\u4e8b\u5b9e\u4e0a\u662f\u679a\u4e3e\u4e86\u6240\u6709\u7684\u6709\u5e8f3\u5143\u7ec4\uff0c\u4e8e\u662f\u4f60\u51b3\u5b9a\u4e0d\u5728\u904d\u5386\u5230\u4e00\u6761\u8fb9\u7684\u65f6\u5019\u4e34\u65f6\u51b3\u5b9a\u8fd9\u4e2a\u8fb9\u7684\u65b9\u5411\uff0c\u800c\u662f\u4e00\u5f00\u59cb\u5c31\u628a\u8fd9\u4e2a\u8fb9\u7684\u65b9\u5411\u786e\u5b9a\u597d\n\n\u4f46\u662f\u8fd9\u6837\u4f1a\u6709\u4e00\u4e2a\u975e\u5e38\u8be1\u5f02\u7684\u95ee\u9898\u5c31\u662f\u6211\u4eec\u7684\u679a\u4e3e\u73b0\u5728\u53ea\u80fd\u679a\u4e3e\u65e0\u5e8f\u4e09\u5143\u7ec4\u4e86\u2026\u2026\n\u56e0\u6b64\u6211\u4eec\u6c42\u4e00\u4e2a3\u5143\u7ec4\u7684\u8d21\u732e\u5fc5\u987b\u8ba1\u7b976\u79cd\u4e0d\u540c\u7684\u8d21\u732e\u65b9\u5f0f\uff0c\u4f46\u662f\u8fd9\u4e2a\u4f18\u5316\u7684\u6548\u679c\u8fd8\u662f\u6709\u7684\uff0c\u4f60\u7684\u7a0b\u5e8f\u8dd1\u5230\u4e865s\n\n\u4e8e\u662f\u6211\u4eec\u4fe1\u5fc3\u6ee1\u6ee1\u7684\u4fee\u6539\u4e86\u4e00\u4e9b\u5965\u5999\u91cd\u91cd\u7684\u8fd0\u7b97\u65b9\u5f0f\uff0c\u4ece\u800c\u51cf\u5c11\u4e86\u4e00\u4e9b\u53d6\u819c\u548c\u52a0\u6cd5\u8fd0\u7b97\uff0c\u5f88\u597d\u4f60\u7684\u7a0b\u5e8f(\u5e76\u65e0\u5375\u7528\u7684)\u8dd1\u5230\u4e864.2s\n\n\u4f60\u5bf9\u7740\u8fd9\u4efd\u4ee3\u7801\u53c8\u5361\u4e86\u534a\u5929\u5e38\u6570\uff0c\u53d1\u73b0\u5e76\u65e0\u5375\u7528\uff0c\u6b63\u5f53\u4f60\u611f\u53f9\u5230\u5e95\u5565\u624d\u662f\u4f18\u7f8e\uff0c\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u5361\u5e38\u6570\uff0c\u6309\u4e0b$Ctrl+A$\u51c6\u5907\u91cd\u6784\u4ee3\u7801\u7684\u65f6\u5019\uff0c\u4f60\u7a81\u7136\u770b\u5230\u4e86\u4f60\u7684\u904d\u5386\u51fa\u8fb9\u7684\u4ee3\u7801\uff0c\u90a3\u662f\u518d\u5e73\u5e38\u4e0d\u8fc7\u7684\u4e00\u6bb5\u4ee3\u7801\uff0c\u5927\u5bb6\u5e38\u7528\u7684\n\n```C\nfor(int i=alist[u];i;i=nxt[i]){}\n```\n\u4f60\u7709\u5934\u4e00\u76b1\u53d1\u73b0\u4e8b\u60c5\u5e76\u4e0d\u5bf9\u52b2\uff0c\u56e0\u4e3a\u8fd9\u4efd\u4ee3\u7801\u5728\u904d\u5386\u51fa\u8fb9\u7684\u65f6\u5019\u8bbf\u95ee\u7684\u5185\u5b58\u5e76\u4e0d\u8fde\u7eed\u800c\u4e14\u8de8\u5ea6\u8fd8\u4e0d\u662f\u4e00\u822c\u7684\u5927\u2026\u2026\uff0c\u8fd9\u610f\u5473\u7740\u4f60\u7684\u7a0b\u5e8f\u5c06\u4f1a\u53d1\u751f$O(m\\sqrt{m})$\u6b21cache miss\uff0c\u8fd9\u90e8\u5206\u7684\u5e38\u6570\u5c31\u8981\u5360\u53bb2s\u2026\u2026\n\n\u4e8e\u662f\u4f60\u5feb\u901f\u7684\u628a\u90bb\u63a5\u94fe\u8868\u6362\u6210\u5927\u5bb6\u5e38\u7528\u7684vector\uff0c\u8fd9\u6837\u4f60\u5728\u904d\u5386\u4e00\u4e2a\u70b9\u7684\u51fa\u8fb9\u7684\u65f6\u5019\u5c06\u4f1a\u5feb\u901f\u8bbf\u95ee\u4e00\u6bb5\u8fde\u7eed\u7684\u5185\u5b58\uff0ccache miss\u5927\u5927\u51cf\u5c11\uff0c\u73b0\u5728\u4f60\u7684\u7a0b\u5e8f\u53ef\u4ee5\u57282.2s\u5185\u5b8c\u6210\u4efb\u52a1\u4e86~\n\n\u5f53\u7136\u4ee3\u4ef7\u5c31\u662f\u4f60\u7684\u4ee3\u7801\u57fa\u672c\u4e0d\u80fd\u770b\u4e86\uff0c\u6240\u4ee5\u4ee3\u7801\u4ec5\u4f9b\u53c2\u8003\n\n\u4e0a\u4ee3\u7801~\n\n```C\n#pragma GCC optimize(3)\n#include<cstdio>\n#include<algorithm>\n#include<ctime> \n#include<vector>\nusing namespace std;const int N=1e5+10;typedef long long ll;const ll mod=1e9+7;\nconst int E=1e6+10;const int U=1e5;int zhi[N];bool book[N];int miu[N];int hd;int T;int d[N];\nint a;int b;int c;int l1;int l2;int l3;int lim;int fj[N][15];int tp[N];int st;int edt;\nll ret=0;int fa[N];int fc[N];int fb[N];struct data{int v;int val;};vector <data> ed[N];\ninline int gcd(int a,int b){int c;while(b){c=a%b;a=b;b=c;}return a;}\nint eu[E];int ev[E];int et[E];int fr;\ninline void solve()\n{\n    scanf(\"%d%d%d\",&a,&b,&c);lim=max(max(a,b),c);st=clock();\n    if(a>b)swap(a,b);if(a>c)swap(a,c);if(b>c)swap(b,c);\n    for(int i=1;i<=a;i++)for(int j=1;j*i<=a;j++)(fa[i]+=a/(i*j))%=mod;\n    for(int i=1;i<=b;i++)for(int j=1;j*i<=b;j++)(fb[i]+=b/(i*j))%=mod;\n    for(int i=1;i<=c;i++)for(int j=1;j*i<=c;j++)(fc[i]+=c/(i*j))%=mod;\n    for(int i=1;i<=lim;i++)//\u5efa\u56fe\n    {\n        if(miu[i]==0)continue;\n        for(int j=0;j<=(1<<tp[i])-1;j++)\n        {\n            int ret=1;for(int k=0,p=j;p;p>>=1,k++)if(p&1)ret*=fj[i][k];\n            for(int k=j;;k=(k-1)&j)\n            {\n                int g=1;for(int t=0,p=k;p;p>>=1,t++)if(p&1)g*=fj[i][t];\n                int v=(ll)i*g/ret;d[ret]++;d[v]++;\n                if(ret<v){eu[++fr]=ret;ev[fr]=v;et[fr]=i;}if(k==0)break;//\u53bb\u6389\u91cd\u8fb9\n            }\n        }\n    }\n    for(int i=1;i<=fr;i++){if(d[eu[i]]<d[ev[i]])swap(eu[i],ev[i]);ed[eu[i]].push_back((data){ev[i],et[i]});}//\u53d8\u4e3a\u6709\u5411\u8fb9\n    vector <data> ::iterator it1,it2;\n    for(int u=1;u<=lim;u++)//vector\u5b58\u8fb9\n        for(it1=ed[u].begin();it1!=ed[u].end();++it1)\n            for(it2=ed[it1->v].begin();it2!=ed[it1->v].end();++it2)\n            {\n                int v3;if((v3=(ll)it2->v*u/gcd(it2->v,u))>lim)continue;\n                int v1=it1->val;int v2=it2->val;\n                if(miu[u]*miu[it1->v]*miu[it2->v]==1)\n                {\n                    (ret+=((ll)fb[v2]*fc[v3]+(ll)fb[v3]*fc[v2])*fa[v1]+\n                          ((ll)fb[v1]*fc[v3]+(ll)fb[v3]*fc[v1])*fa[v2]+\n                          ((ll)fb[v2]*fc[v1]+(ll)fb[v1]*fc[v2])*fa[v3])%=mod;//\u5904\u7406\u4e09\u5143\u73af\u8d21\u732e\uff0c\u57fa\u672c\u4e0d\u80fd\u770b\u4e86\n                }\n                else \n                {\n                    (ret-=((ll)fb[v2]*fc[v3]+(ll)fb[v3]*fc[v2])*fa[v1]+\n                          ((ll)fb[v1]*fc[v3]+(ll)fb[v3]*fc[v1])*fa[v2]+\n                          ((ll)fb[v2]*fc[v1]+(ll)fb[v1]*fc[v2])*fa[v3])%=mod;\n                    ret>0?ret:ret+mod;\n                }\n            }\t\n    for(int i=1;i<=fr;i++)//\u6709\u4e00\u4e2a\u91cd\u590d\u70b9\u7684\u4e09\u5143\u73af\n    {\n        if(miu[eu[i]]==1)\n            (ret+=(ll)fa[et[i]]*fb[et[i]]%mod*fc[ev[i]]+(ll)fa[et[i]]*fb[ev[i]]%mod*fc[et[i]]+(ll)fa[ev[i]]*fb[et[i]]%mod*fc[et[i]])%=mod;\n        else \n            (ret-=(ll)fa[et[i]]*fb[et[i]]%mod*fc[ev[i]]+(ll)fa[et[i]]*fb[ev[i]]%mod*fc[et[i]]+(ll)fa[ev[i]]*fb[et[i]]%mod*fc[et[i]])%=mod;\n        ret=ret>0?ret:ret+mod;\n        if(miu[ev[i]]==1)\n            (ret+=(ll)fa[et[i]]*fb[et[i]]%mod*fc[eu[i]]+(ll)fa[et[i]]*fb[eu[i]]%mod*fc[et[i]]+(ll)fa[eu[i]]*fb[et[i]]%mod*fc[et[i]])%=mod;\n        else \n            (ret-=(ll)fa[et[i]]*fb[et[i]]%mod*fc[eu[i]]+(ll)fa[et[i]]*fb[eu[i]]%mod*fc[et[i]]+(ll)fa[eu[i]]*fb[et[i]]%mod*fc[et[i]])%=mod;\n        ret=ret>0?ret:ret+mod;\n    }\n    for(int i=1;i<=min(min(a,b),c);i++)//\u4e09\u4e2a\u91cd\u590d\u70b9\u7684\u4e09\u5143\u73af\n    {\n        if(miu[i]==1)(ret+=(ll)fa[i]*fb[i]%mod*fc[i])%=mod;\n        else if(miu[i]==-1)(ret-=(ll)fa[i]*fb[i]%mod*fc[i])%=mod;ret=ret>0?ret:ret+mod;\n    }printf(\"%lld\\n\",ret);\n}\ninline void clear()\n{\n    for(int i=1;i<=a;i++)fa[i]=0;\n    for(int i=1;i<=b;i++)fb[i]=0;\n    for(int i=1;i<=c;i++)fc[i]=0;\n    for(int i=1;i<=lim;i++){vector <data> emp;swap(emp,ed[i]);}\n    ret=0;fr=0;\n}\nint main()\n{\n    miu[1]=1;for(int i=2;i<=U;i++)//\u7ebf\u6027\u7b5b\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\n    {\n        if(book[i]==false){zhi[++hd]=i;miu[i]=-1;}\n        for(int j=1;j<=hd&&zhi[j]*i<=U;j++)\n        {book[i*zhi[j]]=true;if(i%zhi[j]==0){break;}miu[i*zhi[j]]=miu[i]*-1;}\n    }\n    for(int i=1;i<=hd;i++)//\u7b5b\u8d28\u56e0\u6570\u5206\u89e3\n        for(int j=1;j*zhi[i]<=U;j++)\n            {int nw=j*zhi[i];fj[nw][tp[nw]]=zhi[i];++tp[nw];}\n    scanf(\"%d\",&T);for(int z=1;z<=T;z++){solve();clear();}return 0;//\u62dc\u62dc\u7a0b\u5e8f~\n}\n```\n\n\n\n\n\n\n\n\n\n",
        "postTime": 1526984323,
        "uid": 56384,
        "name": "shadowice1984",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4619 \u3010[SDOI2018]\u65e7\u8bd5\u9898\u3011"
    },
    {
        "content": "\u7ea6\u5b9a\uff1a\n\n$(i,j)$\u8868\u793a $[\\gcd(i,j)=1]$\n\n\u9996\u5148\u6709\uff1a\n\n$$d(ijk)=\\sum_{u|i}\\sum_{v|j}\\sum_{w|k}(u,v)(v,w)(w,u)$$\n\n\u4e8e\u662f\u9898\u76ee\u6240\u6c42\u5373\uff1a\n\n$$\\sum_{i=1}^A\\sum_{j=1}^B\\sum_{k=1}^C\\sum_{u|i}\\sum_{v|j}\\sum_{w|k}(u,v)(v,w)(w,u)$$\n\n\u7136\u540e\u6211\u4eec\u80af\u5b9a\u8981\u5148\u679a\u4e3e\u56e0\u6570\uff0c\u5c31\u6709\uff1a\n\n$$\\sum_{u=1}^A\\Big\\lfloor\\dfrac{A}{u}\\Big\\rfloor\\sum_{v=1}^B\\Big\\lfloor\\dfrac{B}{v}\\Big\\rfloor\\sum_{w=1}^C\\Big\\lfloor\\dfrac{C}{w}\\Big\\rfloor(u,v)(v,w)(w,u)$$\n\n\u8fd9\u4e2a\u65f6\u5019\u518d\u53cd\u6f14\u4e00\u6ce2\uff0c\u5f97\u5230\uff1a\n\n$$\\sum_{u=1}^A\\Big\\lfloor\\dfrac{A}{u}\\Big\\rfloor\\sum_{v=1}^B\\Big\\lfloor\\dfrac{B}{v}\\Big\\rfloor\\sum_{w=1}^C\\Big\\lfloor\\dfrac{C}{w}\\Big\\rfloor\\sum_{d|gcd(u,v)}\\mu(d)\\sum_{k|gcd(v,w)}\\mu(k)\\sum_{h|gcd(w,u)}\\mu(h)$$\n\n\u6211\u4eec\u80af\u5b9a\u8981\u6362\u4e2a\u679a\u4e3e\u987a\u5e8f\n\n\u4e8e\u662f\u6709\uff1a\n\n$$\\sum_{d=1}^{min(A,B)}\\mu(d)\\sum_{k=1}^{min(B,C)}\\mu(k)\\sum_{h=1}^{min(C,A)}\\mu(h)\\sum_{u|d\\&u|h}^{A}\\Big\\lfloor\\dfrac{A}{u}\\Big\\rfloor\\sum_{v|d\\&v|k}^{B}\\Big\\lfloor\\dfrac{B}{v}\\Big\\rfloor\\sum_{w|k\\&w|h}^{C}\\Big\\lfloor\\dfrac{C}{w}\\Big\\rfloor$$\n\n\u90a3\u4e2a\u540c\u65f6\u6574\u9664\u4e24\u4e2a\u592a\u4e11\u4e86\uff0c\u6211\u4eec\u6362\u6210$u|lcm(d,h)$\u7b97\u4e86\n\n\u63a5\u7740\u6709\uff1a\n\n\n$$\\sum_{d=1}^{min(A,B)}\\mu(d)\\sum_{k=1}^{min(B,C)}\\mu(k)\\sum_{h=1}^{min(C,A)}\\mu(h)\\sum_{u|lcm(d,h)}^{A}\\Big\\lfloor\\dfrac{A}{u}\\Big\\rfloor\\sum_{v|lcm(d,k)}^{B}\\Big\\lfloor\\dfrac{B}{v}\\Big\\rfloor\\sum_{w|lcm(k,h)}^{C}\\Big\\lfloor\\dfrac{C}{w}\\Big\\rfloor$$\n\n\u6211\u4eec\u53d1\u73b0\u540e\u9762\u90a3\u4e00\u5927\u5768\u8c8c\u4f3c\u90fd\u4e4b\u548c\u4e24\u4e2a\u91cf\u6709\u5173\n\n$A,lcm(d,h)$\u8fd9\u7c7b\u53d8\u91cf\n\n\u6211\u4eec\u628a\u5176\u4e2d\u6838\u5fc3\u7684\u5f0f\u5b50\u518d\u6539\u5199\u8bd5\u8bd5\uff1a\n\n$$\\sum_{u|\\textrm{lcm}(d,h)}^A\\Big\\lfloor\\dfrac{A}{u}\\Big\\rfloor$$\n\n$$=\\sum_{u=1}^{\\frac{A}{\\textrm{lcm}(d,h)}}\\Big\\lfloor \\dfrac{A}{u\\times \\textrm{lcm}(d,h)}\\Big\\rfloor$$\n\n\u6211\u4eec\u8003\u8651\u8bb0$f(n,x)$\u8868\u793a\uff1a\n\n$$\\sum_{i=1}^{\\frac{n}{x}}\\Big\\lfloor\\dfrac{n}{i\\times x}\\Big\\rfloor$$\n\n\u6ce8\u610f\u5230\u4e00\u4e2a\u5f15\u7406\uff1a\n\n$$\\Big\\lfloor\\dfrac{\\lfloor\\frac{n}{x}\\rfloor}{i}\\Big\\rfloor=\\Big\\lfloor\\dfrac{n}{ix}\\Big\\rfloor$$\n\n\u4e8e\u662f\u597d\u50cf\u6709\uff1a\n\n$$\\sum_{i=1}^{\\frac{n}{x}}\\Big\\lfloor\\dfrac{n}{i\\times x}\\Big\\rfloor=\\sum_{i=1}^{\\frac{n}{x}}\\Big\\lfloor\\dfrac{\\lfloor\\frac{n}{x}\\rfloor}{i}\\Big\\rfloor$$\n\n\u4e5f\u5c31\u662f\uff1a\n\n$$\\sum_{i=1}^x\\Big\\lfloor\\dfrac{x}{i}\\Big\\rfloor$$\n\n\u6240\u4ee5\u6211\u4eec\u8bb0$f(x)=\\sum_{i=1}^x \\Big\\lfloor\\dfrac{x}{i}\\Big\\rfloor$\n\n\u5c31\u6709\u539f\u9898\u6240\u6c42\u5373\uff1a\n\n$$\\sum_{d=1}^{\\min(A,B)}\\mu(d)\\sum_{k=1}^{\\min(B,C)}\\mu(k)\\sum_{h=1}^{\\min(C,A)}\\mu(h)\\cdot f(\\dfrac{A}{\\textrm{lcm}(d,h)})f(\\dfrac{B}{\\textrm{lcm}(d,k)})f(\\dfrac{C}{\\textrm{lcm}(h,k)})$$\n\n\u597d\u50cf $f(x)$ \u53ef\u4ee5\u5355\u6b21 $\\sqrt x$ \u7684\u6c42\u51fa\u6765\n\n\u6211\u4eec\u8003\u8651\u66f4\u5feb\u901f\u7684\u63a8\u597d\u4e86\n\n\u6ce8\u610f\u5230\u5bf9\u4e8e\u67d0\u4e00\u4e2a\u6570 $i\\le x$\uff0c\u5176\u5bf9\u4e8e $f(x)$ \u4f1a\u4ea7\u751f\u7684\u8d21\u732e\u4e3a $\\dfrac{x}{i}$ \u5373 $1\\sim x$ \u5185\u6709\u591a\u5c11\u4e2a\u6570\u4e3a\u5176\u500d\u6570\n\n\u6240\u4ee5 $f$ \u7684\u5b9e\u9645\u610f\u4e49\u5373 $1\\sim x$ \u5185\u7684\u7ea6\u6570\u548c\n\n\u597d\u4e86\u8fd9\u6837\u4f60\u5c31\u53ef\u4ee5 $\\mathcal O(n\\log n)/\\mathcal O(n)$ \u628a\u8fd9\u4e9b\u503c\u63a8\u51fa\u6765\u4e86\n\n\u5f53\u7136\u5c3d\u7ba1\u53cd\u6f14\u4e86\u8fd9\u4e48\u591a\u4f60\u7684\u590d\u6742\u5ea6\u8fd8\u662f $\\mathcal O(n^3\\log n)$ \u7684 qwq\n\n\u6211\u4eec\u53d1\u73b0\u6211\u4eec\u8981\u6c42\u7684\u5b9e\u9645\u4e0a\u662f\u6709\u5e8f\u5bf9 $(d,k,h)$ \u5bf9\u7b54\u6848\u9020\u6210\u7684\u8d21\u732e\n\n\u4e8e\u662f\u53ef\u4ee5\u8003\u8651\u8f6c\u5316\u95ee\u9898\u7684\u6a21\u578b\uff0c\u5efa\u51fa\u4e00\u5f20\u56fe\u6765\n\n\u8003\u8651\u7ed9\u4e24\u4e2a\u70b9 $(u,v)$ \u4e4b\u95f4\u8fde\u4e00\u6761\u8fb9\n\n\u8fd9\u662f\u4e00\u6761\u65e0\u5411\u8fb9\uff0c\u8fd9\u6761\u8fb9\u7684\u8fb9\u6743\u4e3a $\\textrm{lcm}(u,v)$\uff0c\u6211\u4eec\u8bb0\u8fb9 $u,v$ \u7684\u8fb9\u6743\u4e3a $w_{u,v}$\n\n\u4e8e\u662f\u597d\u50cf\u5bf9\u4e8e\u4e00\u4e2a\u6709\u5e8f\u5bf9 $(d,k,h)$\uff0c\u82e5\u5176\u4e24\u4e24\u4e0d\u76f8\u540c\uff0c\u5219\u5176\u53ef\u4ee5\u901a\u8fc7\u8fd9\u5f20\u56fe\u4e0a\u7684\u4e09\u5143\u73af\u6765\u8868\u793a\n\n\u5bf9\u4e8e\u4e00\u4e2a\u4e09\u5143\u73af $(d,k,h)$ \u5176\u5bf9\u7b54\u6848\u9020\u6210\u8d21\u732e\u5f53\u4e14\u4ec5\u5f53 $d\\le \\min(A,B),k\\le \\min(B,C),h\\le \\min(C,A)$\n\n\u90a3\u4e48\u5b83\u4f1a\u5bf9\u7b54\u6848\u9020\u6210 $\\mu(d)\\mu(k)\\mu(h)\\cdot f(\\dfrac{A}{w_{d,h}})f(\\dfrac{B}{w_{d,k}})f(\\dfrac{C}{w_{h,k}})$\n\n\u4e8e\u662f\u6211\u4eec\u597d\u50cf\u5c31\u53ef\u4ee5\u5728\u8fd9\u5f20\u56fe\u4e0a\u505a\u4e09\u5143\u73af\u8ba1\u6570\u7136\u540e\u7edf\u8ba1\u7b54\u6848\u4e86 qwq\n\n\u4f46\u597d\u50cf\u8fd9\u6837\u8fd8\u662f\u5f88\u66b4\u529b\n\n\u6211\u4eec\u5c1d\u8bd5\u7ed9\u8fd9\u5f20\u56fe\u526a\u4e00\u4e0b\u679d\n\n\u53d1\u73b0\u5927\u91cf\u7684\u4e09\u5143\u73af\u5bf9\u7b54\u6848\u9020\u6210\u7684\u8d21\u732e\u90fd\u662f $0$\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u628a $\\mu(x)=0$ \u6216\u8005 $\\textrm{lcm}(u,v)>\\max(A,B,C)$ \u7684\u70b9\u90fd\u5220\u53bb\n\n\u636e shadowice1984 \u805a\u805a\u8bf4\u7684\u8fd9\u6837\u526a\u4e4b\u540e\u539f\u56fe\u4e0a\u7684\u8fb9\u4f1a\u5f88\u5c11\n\n\u5f53\u7136\uff0c\u66b4\u529b\u5efa\u8fb9\u7684\u590d\u6742\u5ea6\u662f $\\mathcal O(n^2)$ \u7684 \u2014\u2014\u2014\u2014 $\\rm Step(1)$\n\n\u6211\u4eec\u6ce8\u610f\u5230\u8fd9\u4e2a\u5b9a\u4e49\u4e0b\u5efa\u51fa\u7684\u8fb9\u53ea\u80fd\u7edf\u8ba1\u4e24\u4e24\u4e0d\u76f8\u7b49\u7684\u4e09\u5143\u7ec4\u5bf9\u7b54\u6848\u9020\u6210\u7684\u8d21\u732e\n\n\u6211\u4eec\u5c31\u8003\u8651\u66b4\u529b\u7edf\u8ba1\uff0c\u6bcf\u6b21\u679a\u4e3e\u4e00\u4e2a\u70b9\u5e76\u679a\u4e3e\u5176\u51fa\u70b9\u548c\u5176\u51fa\u70b9\u7684\u51fa\u70b9\uff0c\u8fd9\u6837\u505a\u590d\u6742\u5ea6\u662f $\\mathcal O(nm)$ \u7684\u2014\u2014\u2014\u2014 $\\rm Step(2)$\n\n\u4e8e\u662f\u4f60\u8fd8\u9700\u8981\u989d\u5916\u5199\u4e2a\u7279\u5224\u53bb\u5224\u65ad\u4e24\u4e24\u76f8\u7b49\u7684\u4e09\u5143\u7ec4\u5bf9\u7b54\u6848\u9020\u6210\u7684\u8d21\u732e\n\n\u53ef\u4ee5\u53d1\u73b0\u7b97\u4e24\u4e24\u76f8\u7b49\u7684\u4e09\u5143\u7ec4\u7684\u590d\u6742\u5ea6\u662f $\\mathcal O(m)$ \u800c\u8ba1\u7b97\u4e09\u4e2a\u5168\u90e8\u76f8\u7b49\u7684\u590d\u6742\u5ea6\u5219\u662f $\\mathcal O(n)$\n\n\u6211\u4eec\u5c1d\u8bd5\u628a $5000$ \u7684\u70b9\u7684\u90e8\u5206\u7684\u8fb9\u6570\u6570\u51fa\u6765\uff0c\u53d1\u73b0\u5b83\u662f **$49528$**\n\n\u5982\u679c\u4f60\u5199\u4e86\u4e2a $\\rm map$ \u6765\u5224\u4e24\u70b9\u4e4b\u95f4\u6709\u6ca1\u6709\u8fde\u8fb9\u80af\u5b9a\u4f1a $\\rm T$ \u98de\u4ee5\u81f3\u4e8e\u4e00\u5206\u90fd\u65e0\u6cd5\u83b7\u5f97\n\n\u5426\u5219\u7684\u8bdd\u5982\u679c\u4f60\u4e0d\u5e26 $\\log$ \u800c\u662f\u5355\u7eaf\u7684\u975e\u4e25\u683c $nm$ \u4f60\u5e94\u8be5\u53ef\u4ee5\u83b7\u5f97 $\\rm 30pts$ \u7684\u9ad8\u5206\n\n### \u4e8e\u662f\u6211\u4eec\u8981\u8003\u8651\u4f18\u5316\n\n- \u4f18\u5316 $\\rm Step2$\n\n\u4e8e\u662f\u6211\u4eec\u628a\u4e09\u5143\u73af\u8ba1\u6570\u4e2d\u7684\u6280\u5de7\u62ff\u51fa\u6765\u7528\uff0c\u5c31\u53ef\u4ee5\u5c06\u590d\u6742\u5ea6\u53d8\u6210 $\\mathcal O(m\\sqrt m)$ \u4e86\n\n\u5f53\u7136\u4e09\u5143\u73af\u8ba1\u6570\u7edf\u8ba1\u7684\u662f\u65e0\u5411\u4e09\u5143\u73af\u8ba1\u6570\n\n\u6240\u4ee5\u4f60\u8fd8\u8981\u679a\u4e3e\u5176\u516d\u79cd\u4e0d\u540c\u7684\u6392\u5217\u6765\u786e\u4fdd\u6b63\u786e\u6027\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u5c06\u590d\u6742\u5ea6\u505a\u5230 $\\mathcal O(n^2+m\\sqrt m)$ \u4e86\n\n\u5982\u679c\u4f60\u5c1d\u8bd5\u5199\u4e86\u4e00\u53d1\u5e76\u4ea4\u4e86\u4e0a\u53bb\u4f60\u4f1a\u60ca\u4eba\u7684\u53d1\u73b0\u8fd9\u4e2a\u505a\u6cd5\u597d\u50cf\u8fd8\u662f$30$\u5206\n\n- \u4f18\u5316 $\\rm Step1$\n\n\u6211\u4eec\u8003\u8651\u4e0d\u4ee5 $n^2$ \u7684\u679a\u4e3e\u6765\u5efa\u8fb9\n\n\u8003\u8651\u679a\u4e3e\u4e00\u4e2a $\\gcd=x$\uff0c\u90a3\u4e48 $i=kx,j=px$\n\n\u5219 $\\gcd(k,p)=1$\n\n\u4e14 $\\mu(i)\\ne0,\\mu(j)\\ne0$ \u5e76\u4e14 $(kpx)\\le \\max(A,B, C)$\n\n\u6211\u4eec\u679a\u4e3e\u8fd9\u4e2a\u70b9\u5bf9 $(k,p)$ \u5c31\u884c\u4e86\n\n\u5f53\u7136\u8fd9\u6837\u7684\u5efa\u8fb9\u590d\u6742\u5ea6\u5e76\u4e0d\u662f $\\mathcal O(m)$\n\n\u4f46\u4e5f\u6bd4 $\\mathcal O(n^2)$ \u5feb\uff0c\u800c\u4e14\u5feb\u5f97\u591a\n\n\u5173\u4e8e\u8fd1\u4f3c $\\mathcal O(m)$ \u7684\u5efa\u8fb9\u5c31\u662f\u8003\u8651\u679a\u4e3e $\\rm lcm$\uff0c\u540c\u65f6 $\\mu(\\rm lcm)\\ne0$\uff0c\u7136\u540e\u8d28\u56e0\u6570\u5206\u89e3\u5176\uff0c\u679a\u4e3e\u53ef\u80fd\u7684 $\\mu(x)\\ne0$ \u7684\u70b9\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u5173\u4e8e\u56e0\u6570\u7684\u53d6\u6216\u4e0d\u53d6\u4e8c\u8fdb\u5236\u53bb\u6807\u53f7\u5b83\uff0c\u8bb0\u5f55\u4e00\u4e2a\u6876\uff0c\u7136\u540e\u679a\u4e3e\u5176\u5b50\u96c6\uff0c\u90a3\u4e48\u8981\u8fde\u7684\u8fb9\u5c31\u662f\u5176\u5b50\u96c6\u4e0e\u5176\u8865\u96c6 $\\&$ \u5f97\u5230\u7684\u7ed3\u679c\n\n\u4e8e\u662f\u4f60\u5c31\u5341\u5206\u5f00\u5fc3\u81ea\u4ee5\u4e3a\u80fd\u8fc7\u7684\u6253\u51fa\u4e86\u8fd9\u9053\u9898\u7684\u4ee3\u7801\n\n\u5f53\u7136\u5982\u679c\u4f60\u7528\u7684\u662f vector \u4f60\u662f\u771f\u7684\u80fd\u8fc7\u7684\n\n\u5426\u5219\u4f60\u5e94\u8be5\u4f1a T\n\n\u5173\u4e8e\u4ee3\u7801\u4e2d\u7279\u5224\u4e24\u4e2a\u76f8\u7b49\u7684\u4e09\u5143\u7ec4\u5bf9\u7b54\u6848\u7684\u8d21\u732e\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u83dc\u5f97\u8981\u6b7b\u7684\u7b14\u8005\u662f\u5148\u5199\u5b8c\u66b4\u529b\u518d\u628a\u4e24\u4e2a\u4f18\u5316\u52a0\u4e0a\u7684\uff0c\u6240\u4ee5\u4ed6\u6ca1\u6709\u5728\u8fde\u8fb9\u7684\u65f6\u5019\u628a\u8fd9\u4e2a\u60c5\u51b5\u5904\u7406\u6389\n\n\u5b9e\u9645\u4e0a\u662f\u53ef\u4ee5\u5728\u8fde\u8fb9\u7684\u8fc7\u7a0b\u4e2d\u5904\u7406\u6389\u7684qwq\n\n-----------------\n\n- \u5c0f\u63d0\u793a$1:$ \u8c8c\u4f3c\u679a\u4e3e\u4e09\u5143\u7ec4\u7684\u65f6\u5019\u53d7\u5230\u7684\u9650\u5236\u5f88\u9ebb\u70e6\u7684\u6837\u5b50$\\min(A,B),\\min(B,C),\\min(C,A)$\n\n- \u7136\u800c\u5b9e\u9645\u4e0a\u4f60\u5e76\u4e0d\u9700\u8981\u7ba1\uff0c\u7edf\u4e00\u628a\u9650\u5236\u8bbe\u6210 $\\max(A,B,C)$ \u5c31\u597d\u4e86\n\n- \u8fd9\u662f\u56e0\u4e3a\u5982\u679c $u>\\min(A,B)$ \u90a3\u4e48 $f(\\min(A,B)/u)=0$\n\n\u4e0b\u9762\u662f~~\u53c8\u4e11\u53c8\u957f\u7684~~\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define rep( i, s, t ) for( register int i = s; i <= t; ++ i )\n#define re register\n#define int long long\nint read() {\n\tchar cc = getchar(); int cn = 0, flus = 1;\n\twhile(cc < '0' || cc > '9') {  if( cc == '-' ) flus = -flus;  cc = getchar();  }\n\twhile(cc >= '0' && cc <= '9')  cn = cn * 10 + cc - '0', cc = getchar();\n\treturn cn * flus;\n}\nconst int N = 100000 + 500 ; \nconst int P = 1e9 + 7 ; \nint A, B, C, f[N], u[N], p[N], d[N], r[N], deg[N], vis[N], book[N], cnt, tot, top ;\nbool isp[N] ;\nstruct E { int to, w ; }; \nstruct node { int u, v, w ; } e[N * 10]; \nvector<E> mp[N] ; \ninline void init() {\n\tisp[1] = 1, u[1] = 1, r[++ tot] = 1, book[1] = tot ;\n\tfor( re int i = 2; i <= N - 5; ++ i ) {\n\t\tif( !isp[i] ) p[++ top] = i, u[i] = -1 ; \n\t\tfor( re int j = 1; j <= top && i * p[j] <= N - 5; ++ j ) {\n\t\t\tisp[i * p[j]] = 1 ; \n\t\t\tif( i % p[j] == 0 ) continue ;\n\t\t\tu[i * p[j]] = - u[i] ; \n\t\t}\n\t\tif( u[i] != 0 ) r[++ tot] = i, book[i] = tot ; \n\t}\n\tfor( re int i = 1; i <= N - 5; ++ i ) {\n\t\tfor( re int j = i; j <= N - 5; j += i ) ++ d[j] ; \n\t\tf[i] = ( f[i - 1] + d[i] ) % P ;\n\t} \n}\ninline int gcd( int x, int y ) {\n\tif( x == 0 ) return y ; \n\treturn gcd( y % x, x ) ;\n}\nsigned main()\n{\n\tint T = read() ; init() ; \n\twhile( T-- ) {\n\t\tmemset( mp, 0, sizeof(mp) ), memset( deg, 0, sizeof(deg) ) ;\n\t\tA = read(), B = read(), C = read(), cnt = 0 ; \n\t\tint Ans = 0, D = 0 ; D = max( A, max( B, C ) ) ;\n\t\t\n\t\t//\u8fde\u8fb9 \n\t\tfor( re int g = 1; r[g] <= D; ++ g ) {\n\t\t\tfor( re int i = 1; r[i] * r[g] <= D; ++ i ) {\n\t\t\t\tif( !u[r[i] * r[g]] ) continue ;  \n\t\t\t\tfor( re int j = i + 1; j <= tot && r[i] * r[j] * r[g] <= D; ++ j ) {\n\t\t\t\t\tif( !u[r[j] * r[g]] || gcd( r[i], r[j] ) != 1 ) continue ;\n\t\t\t\t\tint u = book[r[i] * r[g]], v = book[r[j] * r[g]], w = r[i] * r[j] * r[g] ;\n\t\t\t\t\t++ deg[u], ++ deg[v], e[++ cnt] = (node){ u, v, w } ;\n\t\t\t\t\tmp[u].push_back((E){v, w}), mp[v].push_back((E){u, w}) ; \n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t//\u4e24\u4e2a\u76f8\u7b49\n\t\tint rD = min( A, min( B, C ) ) ;\n\t\tfor( re int i = 1; r[i] <= min( A, B ); ++ i ) {\n\t\t\tint siz = mp[i].size() - 1 ; \n\t\t\trep( j, 0, siz ) {\n\t\t\t\tint u1 = mp[i][j].to ; \n\t\t\t\tAns += u[r[i]] * u[r[u1]] * u[r[u1]] * f[A / mp[i][j].w] * f[B / mp[i][j].w] * f[C / r[u1]] ;\n\t\t\t\tAns += u[r[i]] * u[r[i]] * u[r[u1]] * f[A / r[i]] * f[B / mp[i][j].w] * f[C / mp[i][j].w] ;\n\t\t\t\tAns += u[r[i]] * u[r[i]] * u[r[u1]] * f[A / mp[i][j].w] * f[B / r[i]] * f[C / mp[i][j].w] ;\n\t\t\t}\n\t\t}\n\t\t// \u4e09\u4e2a\u76f8\u7b49\n\t\tfor( re int i = 1; r[i] <= rD; ++ i ) Ans += u[r[i]] * u[r[i]] * u[r[i]] * f[A / r[i]] * f[B / r[i]] * f[C / r[i]] ;\n\t\t\n\t\t//\u4e92\u4e0d\u76f8\u7b49 \n\t\tmemset( mp, 0, sizeof(mp) ) ;\n\t\tfor( re int i = 1; i <= cnt; ++ i )\n\t\t\tif( deg[e[i].u] >= deg[e[i].v] ) mp[e[i].u].push_back((E){ e[i].v, e[i].w }) ;\n\t\t\telse mp[e[i].v].push_back((E){ e[i].u, e[i].w }) ;\n\t\tfor( re int i = 1; r[i] <= D; ++ i ) {\n\t\t\tint siz = mp[i].size() - 1 ; \n\t\t\trep( j, 0, siz ) vis[mp[i][j].to] = mp[i][j].w ; \n\t\t\trep( j, 0, siz ) {\n\t\t\t\tint u1 = mp[i][j].to, siz2 = mp[u1].size() - 1 ; \n\t\t\t\trep( k, 0, siz2 ) {\n\t\t\t\t\tint v = mp[u1][k].to ; \n\t\t\t\t\tif( !vis[v] ) continue ; \n\t\t\t\t\tint muu = u[r[i]] * u[r[u1]] * u[r[v]], b = mp[i][j].w, c = mp[u1][k].w, a = vis[v] ; \n\t\t\t\t\tint rc = f[A / a] * ( f[B / b] * f[C / c] + f[B / c] * f[C / b] )\n                            + f[A / b] * ( f[B / a] * f[C / c] + f[B / c] * f[C / a] )\n                            + f[A / c] * ( f[B / a] * f[C / b] + f[ B / b ] * f[C / a] ) ; \n\t\t\t\t\tAns += muu * rc ; \n\t\t\t\t}\n\t\t\t}\n\t\t\trep( j, 0, siz ) vis[mp[i][j].to] = 0 ; \n\t\t}\n\t\tprintf(\"%d\\n\", Ans % P ) ;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1567240159,
        "uid": 30036,
        "name": "Soulist",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4619 \u3010[SDOI2018]\u65e7\u8bd5\u9898\u3011"
    },
    {
        "content": "\u7b80\u5355\u53cd\u6f14+\u795e\u4ed9\u4f18\u5316\u9898\u3002\n\n\u9996\u5148\u6211\u4eec\u77e5\u9053\n\n$\\sigma_0(xy)=\\sum\\limits_{i|x}\\sum\\limits_{j|y}[(i,j)=1]$\n\n$\\sigma_0(xyz)=\\sum\\limits_{i|x}\\sum\\limits_{j|y}\\sum\\limits_{k|z}[(i,j)=1][(i,k)=1][(j,k)=1]$\n\n\uff08$\\sigma_0$\u662f\u9664\u6570\u51fd\u6570\uff0c\u76f8\u5f53\u4e8e\u9898\u76ee\u63cf\u8ff0\u4e2d\u7684$d$\uff09\n\n\u53ea\u8981\u5c06$x,y,z$\u7d20\u56e0\u5b50\u5206\u89e3\u540e\u89c2\u5bdf\u5373\u53ef\u5f97\u5230\u4e0a\u9762\u7684\u7ed3\u8bba\u3002\u5b83\u7684\u597d\u5904\u662f\u51fa\u73b0\u4e86\u6211\u4eec\u559c\u6b22\u7684$[a=1]$\n\n\u5c31\u53ef\u4ee5\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u4e86\n\n$\\sum\\limits_{i=1}^a\\sum\\limits_{j=1}^b\\sum\\limits_{k=1}^c\\sigma_0(ijk)$\n\n$=\\sum\\limits_{i=1}^a\\sum\\limits_{j=1}^b\\sum\\limits_{k=1}^c\\sum\\limits_{u|i}\\sum\\limits_{v|j}\\sum\\limits_{w|k}[(u,v)=1][(u,w)=1][(v,w)=1]$\n\n$=\\sum\\limits_{u=1}^a\\sum\\limits_{v=1}^b\\sum\\limits_{w=1}^c\\lfloor\\frac{a}{u}\\rfloor\\lfloor\\frac{b}{v}\\rfloor\\lfloor\\frac{c}{w}\\rfloor[(u,v)=1][(u,w)=1][(v,w)=1]$\n\n$=\\sum\\limits_{i=1}^a\\sum\\limits_{j=1}^b\\sum\\limits_{k=1}^c\\lfloor\\frac{a}{i}\\rfloor\\lfloor\\frac{b}{j}\\rfloor\\lfloor\\frac{c}{k}\\rfloor\\sum\\limits_{u|(i,j)}\\mu(u)\\sum\\limits_{v|(i,k)}\\mu(v)\\sum\\limits_{w|(j,k)}\\mu(w)$\n\n$=\\sum\\limits_{u=1}^{\\min(a,b)}\\mu(u)\\sum\\limits_{v=1}^{\\min(a,c)}\\mu(v)\\sum\\limits_{w=1}^{\\min(b,c)}\\mu(w)\\sum\\limits_{[u,v]|i}^a\\lfloor\\frac{a}{i}\\rfloor\\sum\\limits_{[u,w]|j}^b\\lfloor\\frac{b}{j}\\rfloor\\sum\\limits_{[v,w]|k}^c\\lfloor\\frac{c}{k}\\rfloor$\n\n\u8bbe$f_y(x)=\\sum\\limits_{x|i}^y\\lfloor\\frac{y}{i}\\rfloor$\uff0c\u53ef\u4ee5$O(n\\log n)$\u9884\u5904\u7406\u51fa$f_a,f_b,f_c$\u6240\u6709\u503c\n\n$ans=\\sum\\limits_{u=1}^{\\min(a,b)}\\mu(u)\\sum\\limits_{v=1}^{\\min(a,c)}\\mu(v)\\sum\\limits_{w=1}^{\\min(b,c)}\\mu(w)f_a([u,v])f_b([u,w])f_c([v,w])$\n\n\u7136\u800c\u75db\u82e6\u7684\u5730\u65b9\u5c31\u5728\u4e8e\u8fd9\u6837\u63a8\u5e76\u4e0d\u80fd\u964d\u590d\u6742\u5ea6\uff0c\u76ee\u524d\u4e3a\u6b62\u6211\u4eec\u7684\u590d\u6742\u5ea6\u4f9d\u7136\u662f$O(n^3)$\u3002\u4e8b\u5b9e\u4e0a\u53ef\u4ee5\u628a\u5b83\u63a8\u5230$O(n^2\\log n)$\u7684\uff0c\u90a3\u6837\u505a\u53ef\u4ee5\u8fc7cf\u539f\u9898\u4f46\u662f\u5e76\u4e0d\u5229\u4e8e\u6211\u4eec\u8fd9\u9898\u7684\u540e\u7eed\u4f18\u5316\u3002\n\n\u4f46\u662f\u4e5f\u8bb8\u6211\u4eec\u53ef\u4ee5\u4e0d$O(n^3)$\u5730\u679a\u4e3e$(u,v,w)$\u4e09\u5143\u7ec4\uff0c\u56e0\u4e3a\u4e8b\u5b9e\u4e0a\u8fd9\u6837\u679a\u4e3e\u7684\u8fc7\u7a0b\u4e2d\u6709\u5f88\u591a\u60c5\u51b5\u7684\u8d21\u732e\u662f$0$:\n\n- \u5982\u679c$\\mu(u),\\mu(v),\\mu(w)$\u4e2d\u6709\u4e00\u4e2a\u662f$0$\uff0c\u90a3\u4e48\u8d21\u732e\u662f$0$\u3002\u8fd9\u6837\u7684\u60c5\u51b5\u8fd8\u633a\u591a\u7684\u3002\n\n- \u5982\u679c$x>y$\uff0c\u90a3\u4e48$f_y(x)=0$\u3002\u4e5f\u5c31\u662f\u8bf4$[u,v]>a$\u6216\u8005$[u,w]>b$\u6216\u8005$[v,w]>c$\u90fd\u4f1a\u5bfc\u81f4\u8d21\u732e\u662f$0$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u6709\u4e00\u79cd\u505a\u6cd5\u5c31\u662f\u679a\u4e3e\u6700\u5927\u516c\u7ea6\u6570$g$\uff0c\u679a\u4e3e$u=ig,v=jg$\u5e76\u6ce8\u610f\u6ee1\u8db3\u6761\u4ef6$(i,j)=1,\\mu(u)\\neq0,\\mu(v)\\neq0,[u,v]=ijg\\leq\\max(a,b,c)$\uff0c\u8fde\u8fb9$(u,v)$\uff0c\u5efa\u51fa\u4e00\u5f20\u56fe\u3002\u8fd9\u5f20\u56fe\u7684\u4e09\u5143\u73af\u521a\u597d\u5bf9\u5e94\u5230$(u,v,w)$\u4e09\u5143\u7ec4\uff0c\u4e09\u5143\u73af\u8ba1\u6570\u7684\u540c\u65f6\u7edf\u8ba1\u7b54\u6848\u5373\u53ef\u3002\n\n\u81f3\u4e8e\u8fd9\u6837\u505a\u7684\u590d\u6742\u5ea6\u4e3a\u4ec0\u4e48\u662f\u5bf9\u7684\uff0c\u6211\u4eec\u5df2\u7ecf\u53d1\u73b0\u6709\u76f8\u5f53\u591a\u7684\u70b9\u5bf9$(u,v)$\u5e76\u4e0d\u6ee1\u8db3\u4e0a\u8ff0\u6761\u4ef6\uff08\u610f\u5473\u7740\u5b83\u4eec\u4ea7\u751f\u7684\u8d21\u732e\u662f$0$\uff09\uff0c\u9664\u53bb\u8fd9\u4e9b\u4e4b\u540e\u5269\u4e0b\u7684\u70b9\u5bf9\u8fde\u51fa\u7684\u8fb9\u4e0d\u4f1a\u592a\u591a\u3002\u6b63\u5982shadowice\u5927\u4f6c\u5df2\u7ecf\u8bf4\u4e86\u4ed6\u5b9e\u6d4b\u4e0b\u6765\u8fd9\u4e2a\u8fb9\u6570\u53ea\u6709\u4e03\u5341\u591a\u4e07\u3002\u90a3\u4e48\u53ea\u8981\u4f60\u7684\u4e09\u5143\u73af\u8ba1\u6570\u901f\u5ea6\u5408\u683c\u5c31\u597d\u3002\n\n\u5173\u4e8e\u4e09\u5143\u73af\u8ba1\u6570\uff0c\u53ef\u4ee5\u53c2\u8003[iki9\u7684\u8fd9\u7bc7\u535a\u5ba2](https://www.luogu.org/blog/KingSann/fou-chang-yong-di-hei-ke-ji-san-yuan-huan-post)\uff0c\u6211\u4eec\u53ef\u4ee5\u5728$O(m\\sqrt m)$\u7684\u65f6\u95f4\u5185\u5b8c\u6210\u4e09\u5143\u73af\u8ba1\u6570\u3002\n\n\u4f46\u662f\u6ce8\u610f\u5230\u4e0a\u8ff0\u8fde\u8fb9\u6ca1\u6709\u8003\u8651\u5230\u81ea\u73af\u3002\u4e5f\u5c31\u662f\u8bf4\u5982\u679c\u4e09\u5143\u7ec4$(u,v,w)$\u4e2d\u5b58\u5728\u4e24\u4e2a\u6570\u76f8\u7b49\u6216\u8005\u4e09\u4e2a\u6570\u90fd\u76f8\u7b49\uff0c\u6211\u4eec\u5e76\u6ca1\u6709\u5c06\u7b54\u6848\u8ba1\u7b97\u5728\u5185\u3002\u56e0\u6b64\u6211\u4eec\u9700\u8981\u5355\u72ec\u7b97\u3002\u8fd9\u4e2a\u5f88\u65b9\u4fbf\uff1a\u4e09\u4e2a\u6570\u90fd\u76f8\u7b49\u7684\u60c5\u51b5\u76f4\u63a5\u679a\u4e3e\u8fd9\u4e2a\u6570\u662f\u51e0\uff0c\u628a\u7b54\u6848\u52a0\u8d77\u6765\u5c31\u597d\uff1b\u6070\u597d\u6709\u4e24\u4e2a\u6570\u76f8\u7b49\u7684\u60c5\u51b5\u5c31\u5728\u6211\u4eec\u679a\u4e3e$(u,v)$\u8fde\u8fb9\u7684\u8fc7\u7a0b\u4e2d\u89e3\u51b3\uff0c\u53ea\u8981\u987a\u624b\u628a$(u,u,v)$\u548c$(u,v,v)$\u7684\u7b54\u6848\u90fd\u52a0\u8d77\u6765\u5373\u53ef\u3002\n\n\u5728\u505a\u7684\u8fc7\u7a0b\u4e2d\u65f6\u523b\u6ce8\u610f\u526a\u679d\uff0c\u53ea\u8981\u51fa\u73b0$\\mu$\u503c\u4e3a$0$\u5c31\u8df3\u8fc7\u3002\u53e6\u5916\u53ef\u4ee5\u987a\u624b\u52a0\u4e00\u4e9b\u5faa\u73af\u5c55\u5f00\u3001register\u4e4b\u7c7b\u7684\u5361\u5361\u5e38\u3002\u8fd8\u6709\u5927\u5bb6\u5e94\u8be5\u90fd\u6ce8\u610f\u5230\u7684cache miss\u95ee\u9898\uff0c\u6211\u4eec\u9009\u62e9\u4f7f\u7528vector\u800c\u4e0d\u662f\u90bb\u63a5\u8868\u5b58\u56fe\u4ee5\u8bbf\u95ee\u8fde\u7eed\u7684\u5185\u5b58\u6765\u52a0\u901f\u3002\n\n\u8fd8\u6709\u4e00\u4e2a\u5c0ftrick\uff1a\u6211\u4eec\u7edf\u8ba1\u7684\u662f$ijk$\u7684\u7ea6\u6570\u4e2a\u6570\u4e4b\u548c\uff0c\u4e00\u4e2a\u6570\u7684\u7ea6\u6570\u4e2a\u6570\u4e0d\u4f1a\u5f88\u591a\uff0c$i,j,k$\u53c8\u90fd\u5c0f\u4e8e\u7b49\u4e8e$10^5$\uff0c\u4f30\u8ba1\u6700\u7ec8\u7684\u7b54\u6848\u4e0d\u4f1a\u592a\u5927\u3002\u4e8b\u5b9e\u4e0a\u7b54\u6848\u662f\u4e0d\u4f1a\u8d85\u8fc7$\\text{long long}$\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u5728\u7edf\u8ba1\u7684\u8fc7\u7a0b\u4e2d\u5b8c\u5168\u4e0d\u9700\u8981\u53d6\u6a21\uff0c\u53ea\u8981\u5728\u6700\u540e\u8f93\u51fa\u7684\u65f6\u5019\u6a21\u4e00\u4e0b\u5373\u53ef\u3002\n\n\u7ed9\u4e00\u4efd\u7a0d\u5fae\u53ef\u8bfb\u4e00\u70b9\u7684\u4ee3\u7801\n\n```cpp\n#include <cctype>\n#include <cstdio>\n#include <climits>\n#include <algorithm>\n#include <vector>\n\ntemplate <typename T> inline void read(T& x) {\n    int f = 0, c = getchar(); x = 0;\n    while (!isdigit(c)) f |= c == '-', c = getchar();\n    while (isdigit(c)) x = x * 10 + c - 48, c = getchar();\n    if (f) x = -x;\n}\ntemplate <typename T> void write(T x) {\n    if (x < 0) putchar('-'), x = -x;\n    if (x > 9) write(x / 10);\n    putchar(x % 10 + 48);\n}\ntemplate <typename T> inline void writeln(T x) { write(x); puts(\"\"); }\ntemplate <typename T> inline bool chkmin(T &x, const T &y) { return y < x ? (x = y, 1) : 0; }\ntemplate <typename T> inline bool chkmax(T &x, const T &y) { return x > y ? (x = y, 1) : 0; }\n\n#if __cplusplus >= 201103L\n#define reg\n#else\n#define reg register\n#endif\n\ntypedef long long LL;\nconst int maxn = 1e5 + 207;\nconst LL mod = 1e9 + 7;\nint mu[maxn], pri[maxn];\nbool ff[maxn];\nLL fa[maxn], fb[maxn], fc[maxn];\nint a, b, c, mx, mn;\n\nstruct Edge {\n    int u, v, w;\n    Edge(int x, int y, int z = 0) : u(x), v(y), w(z) {}\n    Edge() : u(0), v(0), w(0) {}\n};\nstruct Node {\n    int to, w;\n    Node(int x, int y = 0) : to(x), w(y) {}\n    Node() : to(0), w(0) {}\n};\nstd::vector<Node> G[maxn];\nint deg[maxn];\nEdge es[maxn << 4];\nint vis[maxn];\nint etot;\n\nint gcd(int a, int b) { return b ? gcd(b, a % b) : a; }\ninline void sieve(int n) {\n    mu[1] = 1;\n    for (reg int i = 2; i <= n; ++i) {\n        if (!ff[i]) { pri[++pri[0]] = i; mu[i] = -1; }\n        for (reg int j = 1; j <= pri[0]; ++j) {\n            int x = i * pri[j];\n            if (x > n) break;\n            ff[x] = 1;\n            if (i % pri[j]) mu[x] = -mu[i];\n            else { mu[x] = 0; break; }\n        }\n    }\n}\n\nint main() {\n    int T; read(T);\n    sieve(1e5);\n    while (T--) {\n        read(a); read(b); read(c);\n        mx = std::max(std::max(a, b), c);\n        mn = std::min(std::min(a, b), c);\n        // \u9884\u5904\u7406 f \u51fd\u6570\u503c\n        for (reg int i = 1; i <= mx; i += 4) {\n            fa[i] = 0; fa[i + 1] = 0; fa[i + 2] = 0; fa[i + 3] = 0;\n            fb[i] = 0; fb[i + 1] = 0; fb[i + 2] = 0; fb[i + 3] = 0;\n            fc[i] = 0; fc[i + 1] = 0; fc[i + 2] = 0; fc[i + 3] = 0;\n        }\n        for (reg int i = 1; i <= a; ++i)\n            for (reg int j = i; j <= a; j += i)\n                fa[i] += a / j;\n        for (reg int i = 1; i <= b; ++i)\n            for (reg int j = i; j <= b; j += i)\n                fb[i] += b / j;\n        for (reg int i = 1; i <= c; ++i)\n            for (reg int j = i; j <= c; j += i)\n                fc[i] += c / j;\n\n        // u = v = w\n        LL ans = 0;\n        for (reg int i = 1; i <= mn; ++i)\n            if (mu[i])\n                ans += mu[i] * mu[i] * mu[i] * fa[i] * fb[i] * fc[i];\n\n        // u, v, w \u6709\u4e24\u4e2a\u76f8\u7b49\n        etot = 0;\n        for (reg int i = 1; i <= mx; i += 4) {\n            deg[i] = 0; deg[i + 1] = 0; deg[i + 2] = 0; deg[i + 3] = 0;\n        }\n        for (reg int g = 1; g <= mx; ++g)\n            for (reg int i = 1; i * g <= mx; ++i)\n                if (mu[i * g])\n                    for (reg int j = i + 1; 1ll * i * j * g <= mx; ++j)\n                        if (mu[j * g] && gcd(i, j) == 1) {\n                            int u = i * g, v = j * g, lcm = i * j * g;\n                            int uuv = mu[u] * mu[u] * mu[v], uvv = mu[u] * mu[v] * mu[v];\n                            ans += uuv * (fa[u] * fb[lcm] * fc[lcm] + fa[lcm] * fb[u] * fc[lcm] + fa[lcm] * fb[lcm] * fc[u]);\n                            ans += uvv * (fa[v] * fb[lcm] * fc[lcm] + fa[lcm] * fb[v] * fc[lcm] + fa[lcm] * fb[lcm] * fc[v]);\n                            ++deg[u]; ++deg[v];\n                            es[++etot] = Edge(u, v, lcm);\n                        }\n\n        // u, v, w \u4e24\u4e24\u4e0d\u540c\n        for (reg int i = 1; i <= mx; ++i) G[i].clear();\n        for (reg int i = 1; i <= etot; ++i) {\n            int u = es[i].u, v = es[i].v, w = es[i].w;\n            if (deg[u] > deg[v] || (deg[u] == deg[v] && u < v))\n                G[u].push_back(Node(v, w));\n            else G[v].push_back(Node(u, w));\n        }\n        for (reg int x = 1; x <= mx; ++x) if (mu[x]) {\n            unsigned sz = G[x].size();\n            for (reg unsigned i = 0; i < sz; ++i)\n                vis[G[x][i].to] = G[x][i].w;\n            for (reg unsigned i = 0; i < sz; ++i) {\n                int y = G[x][i].to, wxy = G[x][i].w;\n                if (!mu[y]) continue;\n                for (reg unsigned j = 0, sszz = G[y].size(); j < sszz; ++j) {\n                    int z = G[y][j].to;\n                    if (vis[z]) {\n                        int wyz = G[y][j].w, wxz = vis[z], mmuu = mu[x] * mu[y] * mu[z];\n                        if (!mmuu) continue;\n                        ans += mmuu * (fa[wxy] * fb[wyz] * fc[wxz]\n                                        + fa[wxy] * fb[wxz] * fc[wyz]\n                                        + fa[wyz] * fb[wxy] * fc[wxz]\n                                        + fa[wyz] * fb[wxz] * fc[wxy]\n                                        + fa[wxz] * fb[wxy] * fc[wyz]\n                                        + fa[wxz] * fb[wyz] * fc[wxy]);\n                    }\n                }\n            }\n            for (reg unsigned i = 0; i < sz; ++i)\n                vis[G[x][i].to] = 0;\n        }\n        writeln(ans % mod);\n    }\n    return 0;\n}\n```\n\n\u53e6\u9644$O(n^2\\log n)$\u7684\u505a\u6cd5\uff1a\n\n$ans=\\sum\\limits_{u=1}^a\\sum\\limits_{v=1}^b\\sum\\limits_{w=1}^c\\lfloor\\frac{a}{u}\\rfloor\\lfloor\\frac{b}{v}\\rfloor\\lfloor\\frac{c}{w}\\rfloor[(u,v)=1][(u,w)=1][(v,w)=1]$\n\n$=\\sum\\limits_{i=1}^a\\sum\\limits_{j=1}^b\\sum\\limits_{k=1}^c\\lfloor\\frac{a}{i}\\rfloor\\lfloor\\frac{b}{j}\\rfloor\\lfloor\\frac{c}{k}\\rfloor\\sum\\limits_{d|(i,j)}\\mu(d)[(i,k)=1][(j,k)=1]$\n\n$=\\sum\\limits_{d=1}^{\\min(a,b)}\\mu(d)\\sum\\limits_{d|i}^a\\sum\\limits_{d|j}^b\\lfloor\\frac{a}{i}\\rfloor\\lfloor\\frac{b}{j}\\rfloor\\sum\\limits_{k=1}^c\\lfloor\\frac{c}{k}\\rfloor[(i,k)=1][(j,k)=1]$\n\n$=\\sum\\limits_{d=1}^{\\min(a,b)}\\mu(d)\\sum\\limits_{i=1}^{\\lfloor\\frac{a}{d}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{b}{d}\\rfloor}\\lfloor\\frac{a}{id}\\rfloor\\lfloor\\frac{b}{jd}\\rfloor\\sum\\limits_{k=1}^c\\lfloor\\frac{c}{k}\\rfloor[(id,k)=1][(jd,k)=1]$\n\n$=\\sum\\limits_{k=1}^c\\lfloor\\frac{c}{k}\\rfloor\\sum\\limits_{d=1}^{\\min(a,b)}\\mu(d)[(d,k)=1]\\sum\\limits_{i=1}^{\\lfloor\\frac{a}{d}\\rfloor}\\lfloor\\frac{a}{id}\\rfloor[(i,k)=1]\\sum\\limits_{j=1}^{\\lfloor\\frac{b}{d}\\rfloor}\\lfloor\\frac{b}{jd}\\rfloor[(j,k)=1]$\n\n\u8bbe\u51fd\u6570$f(x,y)=\\sum\\limits_{i=1}^x\\lfloor\\frac{x}{i}\\rfloor[(i,y)=1]$\u90a3\u4e48\n\n$ans=\\sum\\limits_{k=1}^c\\lfloor\\frac{c}{k}\\rfloor\\sum\\limits_{d=1}^{\\min(a,b)}\\mu(d)[(d,k)=1]f(\\lfloor\\frac{a}{d}\\rfloor,k)f(\\lfloor\\frac{b}{d}\\rfloor,k)$\n\n\u679a\u4e3e$k$\uff0c\u679a\u4e3e$d$\uff0c\u8fd9\u4e2a$f$\u76f4\u63a5$O(x)$\u66b4\u529b\u5c31\u884c\u4e86\uff0c\u56e0\u4e3a$x=a/d$\u6240\u4ee5\u679a\u4e3e$d$\u548c\u8ba1\u7b97$f$\u7684\u603b\u590d\u6742\u5ea6\u662f$O(n\\log n)$\uff08\u8c03\u548c\u7ea7\u6570\u4e58\u4ee5$n$\uff09\uff0c\u603b\u590d\u6742\u5ea6$O(n^2\\log n)$",
        "postTime": 1556696585,
        "uid": 72071,
        "name": "GKxx",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4619 \u3010[SDOI2018]\u65e7\u8bd5\u9898\u3011"
    },
    {
        "content": "## \u849f\u84bb\u8bed\n\u7b2c **50** \u9053\u9ed1\u9898\uff0c\u5199\u7bc7\u9898\u89e3\u796d\u4e00\u4e0b /cy\n## \u849f\u84bb\u89e3\n$\n\\begin{aligned}\n&\\sum\\limits_{i=1}^{A} \\sum\\limits_{j=1}^{B} \\sum\\limits_{k=1}^{C} d(i, j, k)\\\\\n&= \\sum\\limits_{i=1}^{A} \\sum\\limits_{j=1}^{B} \\sum\\limits_{k=1}^{C} \\sum\\limits_{x|i} \\sum\\limits_{y|j} \\sum\\limits_{z|k} [\\gcd(x, y) = 1][\\gcd(y, z) = 1][\\gcd(z, x) = 1]\\\\\n&= \\sum\\limits_{x=1}^{A} \\sum\\limits_{y=1}^{B} \\sum\\limits_{z=1}^{C} [\\gcd(x, y) = 1][\\gcd(y, z) = 1][\\gcd(z, x) = 1] \\left\\lfloor\\frac{A}{x}\\right\\rfloor \\left\\lfloor\\frac{B}{y}\\right\\rfloor \\left\\lfloor\\frac{C}{z}\\right\\rfloor\\\\\n&= \\sum\\limits_{d_1=1}^{A} \\mu(d_1)\\sum\\limits_{d_2=1}^{B} \\mu(d_2) \\sum\\limits_{d_3=1}^{C} \\mu(d_3) \\sum\\limits_{x=1}^{ \\left\\lfloor\\frac{A}{\\operatorname{lcm}(d_1,d_2)}\\right\\rfloor} \\left\\lfloor\\frac{A}{\\operatorname{lcm}(d_1,d_2)x}\\right\\rfloor \\sum\\limits_{y=1}^{ \\left\\lfloor\\frac{B}{\\operatorname{lcm}(d_2,d_3)}\\right\\rfloor} \\left\\lfloor\\frac{B}{\\operatorname{lcm}(d_2,d_3)y}\\right\\rfloor \\sum\\limits_{z=1}^{ \\left\\lfloor\\frac{C}{\\operatorname{lcm}(d_3,d_1)}\\right\\rfloor} \\left\\lfloor\\frac{C}{\\operatorname{lcm}(d_3,d_1)z}\\right\\rfloor\\\\\n\\end{aligned}\n$\n\n(\u8bbe $Max = \\max (A, B, C)$)\n\n\u8003\u8651\u54ea\u4e9b\u4e09\u5143\u7ec4\u4f1a\u6709\u8d21\u732e\u3002\n\n1. $\\mu(d_1), \\mu(d_2), \\mu(d_3)$ \u4e0d\u4e3a $0$\u3002\n1. $\\operatorname{lcm}(d_1,d_2) , \\operatorname{lcm}(d_2,d_3), \\operatorname{lcm}(d_3,d_1) \\le Max$\n\n\u628a\u4e00\u4e2a\u6570\u770b\u6210\u4e00\u4e2a\u70b9\u3002\n\n\u9996\u5148\u6211\u4eec\u628a $\\mu(x)$ \u4e3a $0$ \u7684\u70b9\u6392\u9664\u5728\u5916\u3002\n\n\u7136\u540e\u628a $\\operatorname{lcm}(x, y) \\le Max$ \u7684\u70b9\u8fde\u63a5\u8d77\u6765\u3002\n\n\u7136\u540e\u518d\u505a\u4e00\u904d\u4e09\u5143\u73af\u8ba1\u6570\u5c31\u597d\u4e86\uff0c\u66b4\u529b\u679a\u4e3e\u6bcf\u4e00\u4e2a\u4e09\u5143\u73af\u7edf\u8ba1\u7b54\u6848\u3002\u4e3a\u4e86\u66f4\u5feb\u5730\u7edf\u8ba1\u7b54\u6848\uff0c\u53ef\u4ee5\u5148\u628a\u8fb9\u5b9a\u5411\u3002\n\n\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(m \\sqrt m)$ \u7684\u3002( $m$ \u662f\u8fb9\u6570)\n\n\u4e8b\u5b9e\u4e0a\uff0c\u8fb9\u6570\u6700\u591a\u53ea\u6709 $821535$ \u6761 (\u7528\u849f\u84bb\u52a3\u8d28\u7684\u7a0b\u5e8f\u7b97\u51fa\u6765)\n\n\u56e0\u6b64\u8fd9\u9053\u9898\u5c31\u88ab\u89e3\u51b3\u4e86\n\n## \u849f\u84bb\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define L(i, j, k) for(int i = j; i <= k; i++)\n#define R(i, j, k) for(int i = j; i >= k; i--)\n#define ll long long\nusing namespace std;\nconst int N = 1e5 + 7;\nconst int M = 1e6 + 7;\nconst int mod = 1e9 + 7;\nbool Prime[N];\nint tot, P[N >> 3], mu[N];\nvoid xxs() {\n\tmu[1] = 1;\n\tL(i, 2, 1e5)  {\n\t\tif(!Prime[i]) P[++tot] = i, mu[i] = -1;\n\t\tfor(int j = 1; P[j] * i <= 1e5 && j <= tot; j++) {\n\t\t\tPrime[P[j] * i] = 1;\n\t\t\tif(i % P[j] == 0) {\n\t\t\t\tmu[P[j] * i] = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmu[P[j] * i] = -mu[i];\n\t\t}\n\t}\n} \nvector<int> ve[N];\nunordered_map<int, bool> mp[N];\nint T, Max, A, B, C, ans, p[N];\nint sA[M], sB[M], sC[M], cnt, deg[N];\nint gcd(int x, int y) { return x == 0 ? y : gcd(y % x, x); }\nll lcm(int x, int y) { return 1ll * x / gcd(x, y) * y; }\nint ta, tb, tc, sum;\nvoid dh(int a, int b, int c) {\n\t(sum += 1ll * p[a / ta] * p[b / tb] % mod * p[c / tc] % mod) %= mod;\n}\nvoid get(int a, int b, int c) {\n\tsum = 0;\n\tif(a == b && b == c) dh(A, B, C);\n\telse if(a == b || b == c || c == a) dh(A, B, C), dh(C, A, B), dh(B, C, A);\n\telse dh(A, B, C), dh(A, C, B), dh(B, A, C), dh(B, C, A), dh(C, A, B), dh(C, B, A);\n\t(ans += (mu[a] * mu[b] * mu[c] * sum % mod + mod) % mod) %= mod;\n}\nint vis[N];\nvoid js() {\n\tL(i, 1, cnt) {\n\t\tint &u = sA[i], &v = sB[i];\n\t\tif(deg[u] > deg[v]) swap(u, v);\n\t\telse if(deg[u] == deg[v] && u > v) swap(u, v);\n\t\tve[u].push_back(i);\n\t}\n\tL(i, 1, Max) {\n\t\tfor(int j : ve[i]) vis[sB[j]] = sC[j];\n\t\tfor(int j : ve[i]) for(int k : ve[sB[j]]) \n\t\t\tif(vis[sB[k]]) ta = vis[sB[k]], tb = sC[j], tc = sC[k], get(i, sB[j], sB[k]);\n\t\tfor(int j : ve[i]) vis[sB[j]] = 0;\n\t}\n}\nvoid getans(int x) {\n\tfor(int l = 1, r; l <= x; l = r + 1) {\n\t\tr = (x / (x / l));\n\t\t(p[x] += 1ll * (r - l + 1) * (x / l) % mod) %= mod;\n\t}\n}\nint main() {\n\tscanf(\"%d\", &T);\n\txxs();\n\tL(i, 1, 1e5) getans(i);\n\twhile(T--) {\n\t\tscanf(\"%d%d%d\", &A, &B, &C);\n\t\tans = cnt = 0;\n\t\tMax = max(max(A, B), C);\n\t\tR(i, Max, 1) for(int j = i; j <= Max; j += i) {\n\t\t\t\tif(!mu[j]) continue;\n\t\t\t\tfor(int k = j; k <= 1ll * Max * i / j; k += i) {\n\t\t\t\t\tif(!mu[k]) continue;\n\t\t\t\t\tif(!mp[j][k]) ++cnt, sA[cnt] = j, sB[cnt] = k, sC[cnt] = j / i * k, deg[j] ++, deg[k] ++, mp[j][k] = 1;\n\t\t\t\t}\n\t\t\t}\n\t\tjs();\n\t\tL(i, 1, Max) ve[i].clear(), mp[i].clear(), deg[i] = 0;\n\t\tprintf(\"%d\\n\", (ans + mod) % mod);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1601183363,
        "uid": 173660,
        "name": "zhoukangyang",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4619 \u3010[SDOI2018]\u65e7\u8bd5\u9898\u3011"
    },
    {
        "content": "\u975e\u5e38\u795e\u4ed9\u7684\u9898\u76ee\uff0c\u4e09\u5143\u73af\u505a\u6cd5\u5df2\u7ecf\u975e\u5e38\u795e\u4ed9\uff0c\u4f46\u662f @big_news \u7684\u505a\u6cd5\u8ba9\u8fd9\u9898\u66f4\u52a0\u795e\u4ed9\u3002\n\n\u8fd9\u4e2a\u505a\u6cd5\u5927\u6982\u6ca1\u4ec0\u4e48\u4eba\u63d0\u5230\u5427\u3002\n\n\u9996\u5148\u6709\n\n$$d(ijk)=\\sum_{x|i}\\sum_{y|j}\\sum_{z|k}[x\\perp y][y\\perp z][x\\perp z] $$\n\n\u975e\u5e38\u663e\u7136\u6709 $d(ijk)=\\sum_{x|ijk}1$\uff0c\u5206\u5f00 $i,j,k$ \u6570\u4f1a\u91cd\u590d\uff0c\u4e8e\u662f\u6211\u4eec\u8ba9 $ijk$ \u76f8\u540c\u7684\u8d28\u56e0\u5b50\u5728 $x,y,z$ \u4e2d\u53ea\u51fa\u73b0\u4e00\u4e2a\u3002 [\t\nP3327 [SDOI2015]\u7ea6\u6570\u4e2a\u6570\u548c](www.luogu.com.cn/problem/P3327) \u4e2d\u6709\u4ecb\u7ecd\u3002\n\n$$\\begin{aligned}\n&\\ \\ \\ \\ \\sum_{x=1}^a\\sum_{y=1}^b\\sum_{z=1}^cd(xyz) \\\\\n&=\\sum_{x=1}^a\\sum_{y=1}^b\\sum_{z=1}^c\\sum_{i|x}\\sum_{j|y}\\sum_{k|z}[i\\perp j][j\\perp k][i\\perp k] \\\\\n&=\\sum_{x=1}^a\\sum_{y=1}^b\\sum_{z=1}^c \\lfloor\\frac ax\\rfloor \\lfloor\\frac by\\rfloor \\lfloor\\frac cz\\rfloor[x\\perp y][y\\perp z][x\\perp z] \\\\\n&=\\sum_{x=1}^a\\lfloor\\frac ax\\rfloor \\sum_{y=1}^b\\sum_{z=1}^c \\lfloor\\frac by\\rfloor \\lfloor\\frac cz\\rfloor[x\\perp y]\\sum_{d|y,d|z}\\mu(d)[x\\perp z] \\\\\n&=\\sum_{x=1}^a\\lfloor\\frac ax\\rfloor\\sum_{d=1}^{\\min(b,c)}\\mu(d)\\sum_{y=1}^{b/d}\\sum_{z=1}^{c/d}\\lfloor\\frac b{dy}\\rfloor\\lfloor\\frac c{dz}\\rfloor[x\\perp dy][x\\perp dz] \\\\\n&=\\sum_{x=1}^a\\lfloor\\frac ax\\rfloor\\sum_{d=1}^{\\min(b,c)}\\mu(d)[x\\perp d]\\sum_{y=1}^{b/d}\\sum_{z=1}^{c/d}\\lfloor\\frac b{dy}\\rfloor\\lfloor\\frac c{dz}\\rfloor[x\\perp y][x\\perp z] \\\\\n\\end{aligned}$$\n\n\u6ce8\u610f\u5230\u6211\u4eec\u5728\u4e09\u4e2a\u4e92\u8d28\u4e2d\u53ea\u53cd\u6f14\u4e86\u4e00\u4e2a\u3002\u4ece\u8fd9\u91cc\u5f00\u59cb\u5c31\u4e0d\u540c\u4e86\u3002\n\n\u540e\u9762\u5f0f\u5b50\u7684\u5f62\u5f0f\u5f15\u51fa\u4e86\u4e24\u4e2a\u51fd\u6570\u7684\u5b9a\u4e49\uff1a\n\n$$f(n,k)=\\sum_{i=1}^n \\lfloor\\frac ni\\rfloor[i\\perp k]$$\n\n$$g(n,k)=\\sum_{i=1}^n\\mu(i)[i\\perp k]$$\n\n\u5219\u539f\u5f0f\u53ef\u4ee5\u76f4\u63a5\u4ee3\u5165 $f$\uff1a\n\n$$\\sum_{x=1}^a \\lfloor\\frac ax\\rfloor\\sum_{d=1}^{\\min(b,c)}\\mu(d)[d\\perp x]f(\\lfloor\\frac b{d} \\rfloor,x)f(\\lfloor\\frac c{d} \\rfloor,x) $$\n\n\u5219\u5982\u679c\u627e\u51fa $f(n,k)$ \u5728\u6574\u9664\u70b9\u7684\u503c\u548c $g(n,k)$ \u5728\u5206\u5757\u53f3\u7aef\u70b9\u524d\u7f00\u548c\u7684\u8ba1\u7b97\u65b9\u6cd5\uff0c\u5f0f\u5b50\u540e\u4e00\u90e8\u5206\u53ef\u4ee5\u6574\u9664\u5206\u5757\u8ba1\u7b97\u3002\n\n$g(n,k)$ \u5728 [P1587 [NOI2016]\u5faa\u73af\u4e4b\u7f8e](https://www.luogu.com.cn/problem/P1587) \u4e2d\u7b14\u8005\u7684\u53e6\u4e00\u7bc7 [\u9898\u89e3](https://www.luogu.com.cn/blog/void-basic-learner/solution-p1587) \u6709\u8be6\u89e3\u3002\u672c\u9898\u505a\u6cd5\u4e5f\u4e0e\u5176\u6709\u90e8\u5206\u7c7b\u4f3c\u3002\n\n\u5ffd\u7565 $k$ \u4e2d\u5e73\u65b9\u56e0\u5b50\uff0c\u800c $p$ \u662f $k$ \u4e2d\u4e00\u4e2a\u8d28\u56e0\u5b50\uff08\u540c\u6837\u53c2\u89c1\u94fe\u63a5\uff09\uff0c\u6211\u4eec\u5f97\u5230\u7ed3\u8bba\uff1a\n\n$$g(n,k)=g(\\lfloor\\frac np\\rfloor,k)+g(n,\\frac kp)$$\n\n\u90a3\u6211\u4eec\u5c1d\u8bd5\u540c\u6837\u5206\u6790 $f(n,k)$\u3002\n\n$$\\begin{aligned}\n&\\ \\ \\ \\ \\ f(n,k)=\\sum_{i=1}^n\\lfloor\\frac ni\\rfloor[i\\perp k] \\\\\n&=\\sum_{i=1}^n \\lfloor\\frac ni\\rfloor[i\\perp\\frac kp]-\\sum_{i=1} ^n\\lfloor\\frac ni\\rfloor[i\\perp\\frac kp][p|i] \\\\\n&=f(n,\\frac kp)-\\sum_{i=1}^{n/p}\\lfloor\\frac n{ip}\\rfloor[i\\perp\\frac kp] \\\\\n&=f(n,\\frac kp)-f(\\lfloor\\frac np \\rfloor,\\frac kp)\n\\end{aligned}$$\n\n\u8fb9\u754c\u4e5f\u663e\u7136\u3002\n\n$$f(0,k)=0,f(n,1)=\\sum_{i=1}^n\\lfloor\\frac ni \\rfloor=\\sum_{i=1}^nd(i)$$\n\n$$g(0,k)=0,g(n,1)=\\sum_{i=1}^n\\mu(d)$$\n\n\u4e24\u8005\u53ef\u4ee5\u7b80\u5355\u5730\u7ebf\u6027\u7b5b\u51fa\u6765\u3002\n\n---\n\n$f(n,k),g(n,k)$ \u7684\u7b2c\u4e00\u7ef4\u5bf9\u4e8e\u4e00\u4e2a $n$\uff0c\u53d6\u904d $b,c$ \u7684\u6574\u9664\u70b9\u6709 $\\sqrt n$ \u4e2a\uff1b\n\n\u7b2c\u4e8c\u7ef4\u5bf9\u4e8e\u4e00\u4e2a $k$\uff0c\u6709\u53d6\u904d\u5176\u7d20\u56e0\u5b50\u4e2a\uff0c\u8fd9\u4e2a\u6570\u4f4e\u4e8e $\\log k$\u3002\u90a3 $[1,n]$ \u4e2d\u7684\u65e0\u5e73\u65b9\u56e0\u5b50\u6570\u6709\u591a\u5c11\u5462\uff1f\u6700\u7c97\u7565\u7684\u4f30\u8ba1\u4e0b\uff0c\u5b83\u6709 $O(n)$ \u4e2a\uff0c\u56e0\u4e3a\u5373\u4f7f\u6709 $\\log_2n$ \u4e2a $2$ \u4f5c\u4e3a\u7d20\u6570\u8fdb\u884c\u4e58\u79ef\uff0c\u4e5f\u4ec5\u6709 $2^{\\log_2n}=n$ \u4e2a\u3002\n\n\u663e\u7136\u5b9e\u9645\u8fdc\u4f4e\u4e8e $O(n)$\uff0c\u4f46\u662f\u4e0b\u6587\u4ecd\u5199\u4e3a $O(n)$\u3002\n\n\u5f97\u5230\u72b6\u6001\u662f $O(n\\sqrt n)$ \u7684\uff0c$O(1)$ \u8f6c\u79fb\uff0c\u52a0\u4e0a\u5206\u5757\uff0c\u603b\u590d\u6742\u5ea6\u662f $O(n\\sqrt n)$ \u7684\u3002\n\n\u4e8e\u662f\u7528 `unordered_map` \u7ef4\u62a4 $f,g$\uff0c\u679a\u4e3e\u65e0\u5e73\u65b9\u56e0\u5b50\u7684 $x$\uff0c\u5206\u5757\u65f6\u9012\u5f52\u8ba1\u7b97\u5f97\u5230\u7b54\u6848\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u6839\u636e $k$ \u7684\u672c\u8d28\u662f\u4e00\u4e2a\u7d20\u56e0\u5b50\u96c6\u5408\uff0c\u5bf9\u4e8e\u8be5\u96c6\u5408\u76f8\u540c\u7684 $x$\uff0c\u6ca1\u6709\u5fc5\u8981\u5168\u90e8\u679a\u4e3e\u3002\n\n\u8bb0 $sv(x)$ \u4e3a $x$ \u56e0\u5b50\u53bb\u91cd\u5f97\u5230\u7684\u6570\uff0c\u5b83\u53ef\u4ee5\u7ebf\u6027\u7b5b\u5f97\u51fa\u3002\n\n\u6211\u4eec\u7edf\u8ba1 $sv(x)$ \u76f8\u540c\u7684 $x$ \u7684 $\\lfloor\\dfrac ax\\rfloor $ \u4e4b\u548c\uff0c\u679a\u4e3e\u5b58\u5728\u7684 $sv(x)$ \u5373\u53ef\u3002\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n#include <cmath>\n#include <algorithm>\n#include <unordered_map>\n\n#define umap std::unordered_map\ntypedef long long ll;\nconst int V = 100001;\nconst int p = 1000000007;\n\ninline int read() {\n\tint x = 0, f = 1; char ch = getchar();\n\twhile(ch > '9' || ch < '0') { if(ch == '-') f = -1; ch = getchar(); }\n\tdo x = x * 10 + ch - 48, ch = getchar(); while(ch >= '0' && ch <= '9');\n\treturn x * f;\n}\n\nint df[V],P[V],tt; ll mu[V],d[V],sv[V];\n\nvoid Seive() {\n\tmu[1] = d[1] = sv[1] = 1;\n\tfor(int i = 2;i < V;i++) {\n\t\tif(!df[i]) P[++tt] = i, mu[i] = -1, d[i] = 2, sv[i] = i;\n\t\tfor(int j = 1;j <= tt && i * P[j] < V;j++) {\n\t\t\tint t = i * P[j]; df[t] = 1;\n\t\t\tif(i % P[j]) mu[t] = p - mu[i], d[t] = 2 * d[i] % p, sv[t] = sv[i] * P[j];\n\t\t\telse mu[t] = 0, d[t] = (2 * d[i] % p - d[i / P[j]] + p) % p, sv[t] = sv[i];\n\t\t}\n\t}\n\tfor(int i = 1;i < V;i++) mu[i] = (mu[i] + mu[i - 1]) % p;\n\tfor(int i = 1;i < V;i++) d[i] = (d[i] + d[i - 1]) % p;\n\treturn;\n}\n\nll pd[V],pdt,cl[V];\numap <int,umap <int,ll> > Fmap,Gmap;\n\nll F(int n,int k,int s) {\n\tif(!n) return 0;\n\telse if(k == 1) return d[n];\n\telse if(Fmap[n].count(k)) return Fmap[n][k];\n\treturn Fmap[n][k] = (F(n,k / pd[s],s + 1) - F(n / pd[s],k / pd[s],s + 1) + p) % p;\n}\n\nll G(int n,int k,int s) {\n\tif(!n) return 0;\n\telse if(k == 1) return mu[n];\n\telse if(Gmap[n].count(k)) return Gmap[n][k];\n\treturn Gmap[n][k] = (G(n / pd[s],k,s) + G(n,k / pd[s],s + 1)) % p;\n}\n\n\nint main() {\n\tSeive();\n\tint tc = read();\n\twhile(tc--) {\n\t\tint a = read(), b = read(), c = read(); ll ans = 0;\n\t\tif(b > c) std::swap(b,c); if(a > b) std::swap(a,b);\n\t\tfor(int i = 1;i <= a;i++) cl[i] = 0;\n\t\tfor(int i = 1;i <= a;i++) cl[sv[i]] += a / i;\n\t\tfor(int x = 1;x <= a;x++) if(cl[x]) {\n\t\t\tll res = 0; pdt = 0;\n\t\t\tfor(int i = 1;i <= tt && P[i] <= x;i++)\n\t\t\t\tif(!(x % P[i])) pd[++pdt] = P[i];\n\t\t\tfor(int i = 1;i <= b && i <= c;i++) {\n\t\t\t\tint j = std::min(b / (b / i),c / (c / i));\n\t\t\t\tres = (res + F(b / i,x,1) * F(c / i,x,1) % p * (G(j,x,1) - G(i - 1,x,1) + p) % p) % p;\n\t\t\t\ti = j;\n\t\t\t}\n\t\t\tans = (ans + cl[x] % p * res % p) % p;\n\t\t}\n\t\tstd::printf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n\n---\n\n\u7ed3\u679c $a=b=c=10000$ \u5c31\u8dd1\u4e86 $10s$\uff0c$a=b=c=100000$ \u7684\u6839\u672c\u51fa\u4e0d\u6765\u3002\n\n\u74f6\u9888\u5728\u5bf9 $f(n,k),g(n,k)$ \u7684\u7ef4\u62a4\u4e0a\u3002\u8003\u8651\u53bb\u6389\u4e8c\u7ef4\u7684 `unordered_map`\u3002\n\n\u7136\u540e\u4f3c\u4e4e\u65e0\u6cd5\u53ef\u60f3\uff1f$f,g$ \u7684\u7b2c\u4e00\u7ef4\u662f\u53d6\u6ee1\u7684 $O(\\sqrt n)$\uff0c\u4ecd\u7136\u8003\u8651\u7b2c\u4e8c\u7ef4\u3002\n\n\u5982\u679c\u5bf9\u8d28\u56e0\u5b50\u96c6\u5408\u7684\u8bbf\u95ee\u662f\u968f\u673a\u7684\uff0c\u5c31\u50cf\u6211\u4eec\u521d\u6b65\u5f97\u5230\u7684\u4ece\u5c0f\u5230\u5927\u679a\u4e3e\u7684\u65b9\u6cd5\uff0c\u65e0\u6cd5\u89e3\u51b3\u95ee\u9898\u3002\n\n\u90a3\u5982\u679c\u662f\u987a\u5e8f\u63d2\u5165\u5220\u9664\u5462\uff1f\n\n\u663e\u7136\u6211\u4eec\u9700\u8981\u7684\u662f\u4e00\u4e2a\u6309 Dfs \u5e8f\u904d\u5386\u8d28\u56e0\u5b50\u7684\u987a\u5e8f\u7ef4\u62a4\u7684 $f,g$ \u7684\u503c\u3002\n\n\u90a3\u4e48\u53ef\u4ee5\u628a\u72b6\u6001\u7b80\u5355\u5730\u987a\u5e8f\u5206\u5c42\u4e86\u3002\u5177\u4f53\u5730\uff0c\u5bf9\u4e8e\u8d28\u6570\u5e8f\u5217 $p_1,p_2,\\cdots p_s$ \u548c $k=\\prod p_i$\uff0c\u5c06 $f(n,k)$ \u548c $g(n,k)$ \u8bb0\u5f55\u5728\u7b2c $s$ \u5c42\uff0c\u8f6c\u79fb\u65f6\u6839\u636e $s-1$ \u5c42\u7684\u72b6\u6001\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $k$ \u7edf\u8ba1\u7b54\u6848\u3002\n\n$s$ \u6839\u636e\u4e0a\u9762\u7684\u5206\u6790\uff0c\u662f $O(\\log_2n)$ \u7684\uff0c\u7a7a\u95f4\u4e0a\u5b8c\u5168\u53ef\u4ee5\u627f\u53d7\u3002\n\n\u6ce8\u610f\u8f6c\u79fb\u4e2d $f$ \u548c $g$ \u7528\u5230\u7684\u7b2c\u4e00\u7ef4\u6c38\u8fdc\u53ea\u6709 $O(\\sqrt n)$ \u4e2a\u70b9\uff0c\u5982\u4e0a\u6240\u8ff0\uff0c$f$ \u7528\u5230\u4e86\u6574\u9664\u70b9\uff0c$g$ \u7528\u5230\u4e86\u6574\u9664\u70b9 $-1$ \u7684\u70b9\u3002\n\n\u5b9e\u9645\u590d\u6742\u5ea6\u6bd4 $O(n\\sqrt n)$ \u8981\u5c0f\u4e0d\u5c11\uff0c$100000$ \u7684\u6837\u4f8b\u5927\u7ea6 $4s$\u3002\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n#include <cmath>\n#include <algorithm>\n\ntypedef long long ll;\nconst int V = 100001;\nconst int p = 1000000007;\n\ninline int read() {\n\tint x = 0, f = 1; char ch = getchar();\n\twhile(ch > '9' || ch < '0') { if(ch == '-') f = -1; ch = getchar(); }\n\tdo x = x * 10 + ch - 48, ch = getchar(); while(ch >= '0' && ch <= '9');\n\treturn x * f;\n}\n\nint df[V],P[V],t;\nll mu[V],sv[V],d[V],cl[V];\n\nvoid Seive() {\n\tmu[1] = sv[1] = d[1] = 1;\n\tfor(int i = 2;i < V;i++) {\n\t\tif(!df[i]) P[++t] = i, mu[i] = -1, sv[i] = i, d[i] = 2;\n\t\tfor(int j = 1;j <= t && i * P[j] < V;j++) {\n\t\t\tint t = i * P[j]; df[t] = 1;\n\t\t\tif(i % P[j]) mu[t] = -mu[i], sv[t] = sv[i] * P[j], d[t] = 2 * d[i] % p;\n\t\t\telse mu[t] = 0, sv[t] = sv[i], d[t] = (2 * d[i] % p - d[i / P[j]] + p) % p;\n\t\t}\n\t}\n\tfor(int i = 1;i < V;i++) mu[i] = (mu[i - 1] + mu[i]) % p;\n\tfor(int i = 1;i < V;i++) d[i] = (d[i - 1] + d[i]) % p;\n}\n\nint a,b,c; ll ans;\nll f[V][20], g[V][20];\n\nvoid Dfs(ll x,int s,int k) {\n\tll res = 0;\n\tfor(int i = 1;i <= b && i <= c;i++) {\n\t\tint j = std::min(b / (b / i),c / (c / i));\n\t\tres = (res + (g[j][k] - g[i - 1][k] + p) % p * f[b / i][k] % p * f[c / i][k] % p) % p;\n\t\ti = j;\n\t}\n\tans = (ans + cl[x] * res % p) % p;\n\tfor(int r = s;r <= t && x * P[r] <= a;r++) {\n\t\tfor(int i = 1;i <= b && i <= c;i++) {\n\t\t\tint j = std::min(b / (b / i),c / (c / i));\n\t\t\tf[b / i][k + 1] = (f[b / i][k] - f[b / i / P[r]][k] + p) % p;\n\t\t\tf[c / i][k + 1] = (f[c / i][k] - f[c / i / P[r]][k] + p) % p;\n\t\t\tg[j][k + 1] = (g[j / P[r]][k + 1] + g[j][k]) % p;\n\t\t\ti = j;\n\t\t}\n\t\tDfs(x * P[r],r + 1,k + 1);\n\t}\n\treturn;\n}\n\nint main() {\n\tSeive();\n\tint t = read();\n\twhile(t--) {\n\t\ta = read(), b = read(), c = read();\n\t\tfor(int i = 1;i <= a;i++) cl[i] = 0;\n\t\tfor(int i = 1;i <= a;i++) cl[sv[i]] += a / i;\n\t\tfor(int i = 1;i <= b && i <= c;i++) {\n\t\t\tint j = std::min(b / (b / i),c / (c / i));\n\t\t\tf[b / i][1] = d[b / i], f[c / i][1] = d[c / i];\n\t\t\tg[j][1] = mu[j];\n\t\t\ti = j;\n\t\t}\n\t\tans = 0, Dfs(1,1,1);\n\t\tstd::printf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1597570784,
        "uid": 219595,
        "name": "Vocalise",
        "ccfLevel": 9,
        "title": "\u5361\u5e38\u9012\u63a8---\u9898\u89e3 P4619 \u3010[SDOI2018]\u65e7\u8bd5\u9898\u3011"
    },
    {
        "content": "### \u8b66\u544a\uff1a\u6b64\u9898\u5361\u5e38\n\u82b1\u4e86\u6211\u4e00\u5929\u534a\u7684\u65f6\u95f4\u624d\u5f04\u597d\u3002\n\n\u505a\u6cd5\uff1a\u7eaf\u6b63\u7684\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u3002\n$$\\sum_{i=1}^A\\sum_{j=1}^B\\sum_{k=1}^Cd(ijk)$$\n\u5148\u8003\u8651\u540e\u9762\u90a3\u4e2a\u51fd\u6570\n$$d(ijk)=\\sum_{x|i}\\sum_{y|j}\\sum_{z|k}[x\\perp y][y\\perp z][x\\perp z]$$\n\u8bc1\u660e\uff0c\u89c1 [[SDOI2015\u7ea6\u6570\u4e2a\u6570\u548c]](https://www.luogu.com.cn/problem/P3327)\n\u597d\u4e86\uff0c\u5e26\u56de\u53bb\u5f97\u5230\u539f\u5f0f\u5f97\u5230\n$$\\sum_{i=1}^A\\sum_{j=1}^B\\sum_{k=1}^C\\sum_{x|i}\\sum_{y|j}\\sum_{z|k}[x\\perp y][y\\perp z][x\\perp z]$$\n\u7136\u540e\u679a\u4e3e $x,y,z$ \u5f97\u5230\n$$\\sum_{x=1}^A\\sum_{y=1}^B\\sum_{z=1}^C\\lfloor\\frac{A}{x}\\rfloor\\lfloor\\frac{B}{y}\\rfloor\\lfloor\\frac{C}{z}\\rfloor[x\\perp y][y\\perp z][x\\perp z]$$\n\u8003\u8651\u62ce\u51fa\u6765\u5176\u4e2d\u4e00\u4e2a\u8fdb\u884c\u53cd\u6f14\uff0c\u5f97\u5230\n$$\\sum_{x=1}^A\\sum_{y=1}^B\\sum_{z=1}^C\\sum_{d|x,d|y}\\mu(d)\\lfloor\\frac{A}{x}\\rfloor\\lfloor\\frac{B}{y}\\rfloor\\lfloor\\frac{C}{z}\\rfloor[y\\perp z][x\\perp z]$$\n\u94a6\u5b9a $A\\le B$\n$$\\sum_{z=1}^C\\lfloor\\frac{C}{z}\\rfloor\\sum_{d=1}^A\\mu(d)\\sum_{x|d}^A\\lfloor\\frac{A}{x}\\rfloor[y\\perp z]\\sum_{y|d}^B\\lfloor\\frac{B}{y}\\rfloor[x\\perp z]$$\n\u8bbe $p=\\lfloor\\frac{A}{d}\\rfloor,q=\\lfloor\\frac{B}{d}\\rfloor$\n$$\\sum_{z=1}^C\\lfloor\\frac{C}{z}\\rfloor\\sum_{d=1}^A\\mu(d)\\sum_{x=1}^p\\lfloor\\frac{A}{x}\\rfloor[yd\\perp z]\\sum_{y|d}^B\\lfloor\\frac{B}{q}\\rfloor[xd\\perp z]$$\n$$\\sum_{z=1}^C\\lfloor\\frac{C}{z}\\rfloor\\sum_{d=1}^A\\mu(d)[d\\perp z]\\sum_{x=1}^p\\lfloor\\frac{A}{x}\\rfloor[y\\perp z]\\sum_{y|d}^B\\lfloor\\frac{B}{q}\\rfloor[x\\perp z]$$\n\u8bbe $f(x,y)=\\sum_{i=1}^x\\lfloor\\frac{x}{i}\\rfloor[i\\perp y]$\n$$\\sum_{z=1}^C\\lfloor\\frac{C}{z}\\rfloor\\sum_{d=1}^A\\mu(d)[d\\perp z]f(p,z)f(q,z)$$\n\u518d\u8bbe $g(x,y)=\\sum_{i=1}^x\\mu(i)[i\\perp y]$\n$$\\sum_{z=1}^C\\lfloor\\frac{C}{z}\\rfloor\\sum_{l,r}(g(r,z)-g(l-1,z))f(p,z)f(q,z)$$\n\u5176\u4e2d\u540e\u9762\u662f\u4e00\u4e2a\u6570\u8bba\u5206\u5757\u3002\n\n\u73b0\u5728\u8003\u8651\u8ba1\u7b97 $f(x,y)$ \u548c $g(x,y)$ \uff0c\u8bbe $p$ \u662f $y$ \u7684\u4e00\u4e2a\u8d28\u56e0\u6570\uff08\u548c\u4e0a\u6587\u7684 $p$ \u65e0\u5173\uff09\n\n\u90a3\u4e48\u8003\u8651 $y\u2192y/p$ \u4e4b\u540e\u7684\u7b54\u6848\uff0c\u518d\u7528\u5bb9\u65a5\u539f\u7406\u51cf\u56de\u53bb\n$$f(x,y)=\\sum_{i=1}^x\\lfloor\\frac{x}{i}\\rfloor[i\\perp y/p]-\\sum_{i=1}^x\\lfloor\\frac{x}{i}\\rfloor[i\\perp y/p][i|p]$$\n$$=f(x,y/p)-\\sum_{i=1}^{\\lfloor\\frac{x}{p}\\rfloor}\\lfloor\\frac{x}{ip}\\rfloor[ip\\perp y/p]$$\n$$=f(x,y/p)-[p\\perp y/p]\\sum_{i=1}^{\\lfloor\\frac{x}{p}\\rfloor}\\lfloor\\frac{x}{ip}\\rfloor[i\\perp y/p]$$\n$$=f(x,y/p)-[p\\perp y/p]f(\\lfloor\\frac{x}{p}\\rfloor,y/p)$$\n\u7136\u540e\u662f $g(x,y)$ \uff0c\u540c\u6837\u7684\u5957\u8def\uff0c\u8bbe $p$ \u662f $y$ \u7684\u4e00\u4e2a\u8d28\u56e0\u6570\uff08\u4e5f\u548c\u4e0a\u6587\u7684 $p$ \u65e0\u5173\uff09\n$$g(x,y)=\\sum_{i=1}^x\\mu(i)[i\\perp y/p]-\\sum_{i=1}^x\\mu(i)[i\\perp y/p][i|p]$$\n$$=g(x,y/p)-\\sum_{i=1}^{\\lfloor\\frac{x}{p}\\rfloor}\\mu(ip)[ip\\perp y/p]$$\n\u7136\u540e\u6839\u636e $\\mu(ab)=\\mu(a)\\mu(b)[a\\perp b]$ \u4ee5\u53ca $\\mu(p)=-1$ \u53ef\u5f97\n$$=g(x,y/p)+\\sum_{i=1}^{\\lfloor\\frac{x}{p}\\rfloor}\\mu(i)[i\\perp p][ip\\perp y/p]$$\n$$=g(x,y/p)+[p\\perp y/p]\\sum_{i=1}^{\\lfloor\\frac{x}{p}\\rfloor}\\mu(i)[i\\perp p][i\\perp y/p]$$\n$$=g(x,y/p)+[p\\perp y/p]\\sum_{i=1}^{\\lfloor\\frac{x}{p}\\rfloor}\\mu(i)[i\\perp y]$$\n$$=g(x,y/p)+[p\\perp y/p]g(\\lfloor\\frac{x}{p}\\rfloor,y)$$\n\u7136\u540e\u2026\u2026\n\u53ef\u4ee5\u6253\u51fa\u4e00\u79cd\u66b4\u529b\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\sqrt n)$ \uff0c\u8fd9\u91cc\u5047\u8bbe $n=\\max(A,B,C)$\u7a7a\u95f4\u590d\u6742\u5ea6\u4e5f\u662f $O(n\\sqrt n)$ \uff0c\u53ef\u4ee5\u62ff\u5230 70 \u5206\u3002\n```cpp\n#include<cstdio>\n#include<algorithm>\n#define N 100010\nusing namespace std;\nint pp[N],C,lx[N];\nconst int mod=1e9+7;\nstruct node{\n\tint f[640][N],id[N],d[N],len,l,r,i,j,x;\n\tvoid work(int n,int*h)\n\t{\n\t\tlen=0;\n\t\tfor(l=1;l<=n;l=r+1)\n\t\t{\n\t\t\tr=n/(n/l);\n\t\t\tid[r]=++len;\n\t\t\td[len]=r;\n\t\t}\n\t\tfor(i=1;i<=len;i++)\n\t\t{\n\t\t\tx=d[i];\n\t\t\tf[i][1]=(h[x]+mod)%mod;\n\t\t\tfor(j=2;j<=C;j++)\n\t\t\t\tf[i][j]=(f[i][j/lx[j]]-pp[j]*f[id[x/lx[j]]][j/lx[j]]+mod)%mod;\n\t\t}\n\t}\n\tinline int calc(int x,int y)\n\t{ return x?f[id[x]][y]:0; }\n}f1,f2;\nstruct node2{\n\tint f[1270][N],id[N],d[N],len,l,r,i,j,x;\n\tvoid work(int n,int m,int*h)\n\t{\n\t\tlen=0;\n\t\tx=min(n,m);\n\t\tfor(l=1;l<=x;l=r+1)\n\t\t{\n\t\t\tr=min(n/(n/l),m/(m/l));\n\t\t\tid[r]=++len;\n\t\t\td[len]=r;\n\t\t}\n\t\tfor(i=1;i<=len;i++)\n\t\t{\n\t\t\tx=d[i];\n\t\t\tf[i][1]=(h[x]+mod)%mod;\n\t\t\tfor(j=2;j<=C;j++)\n\t\t\t\tf[i][j]=(f[i][j/lx[j]]+pp[j]*f[id[x/lx[j]]][j])%mod;\n\t\t}\n\t}\n\tinline int calc(int x,int y)\n\t{ return x?f[id[x]][y]:0; }\n}g;\nint vis[N],p[N],mu[N],h[N],T,id[N],d[N],n,A,B,x,k[N],len;\nlong long ans,s1,s2,s3,s4,s5,s6,s7,s8;\nsigned main()\n{\n\tint i,j,l,r;\n\tn=N-10;\n\tmu[1]=k[1]=h[1]=1;\n\tfor(i=2;i<=n;i++)\n\t{\n\t\th[i]++;\n\t\tif(!vis[i]) p[++len]=i,mu[i]=-1,lx[i]=i;\n\t\tfor(j=1;j<=len&&i*p[j]<=n;j++)\n\t\t{\n\t\t\tlx[i*p[j]]=p[j];\n\t\t\tvis[i*p[j]]=1;\n\t\t\tif(i%p[j]==0) break;\n\t\t\tmu[i*p[j]]=-mu[i];\n\t\t}\n\t\tfor(j=i;j<=n;j+=i) h[j]++;\n\t\tk[i]=k[i-1]+mu[i];\n\t\tpp[i]=(i%(1ll*lx[i]*lx[i])!=0);\n\t}\n\tfor(i=2;i<=n;i++) h[i]+=h[i-1];\n\tscanf(\"%d\",&T);\n\twhile(T--)\n\t{\n\t\tscanf(\"%d%d%d\",&A,&B,&C);\n\t\tans=s1=s2=s3=s4=s5=s6=s7=s8=0;\n\t\tf1.work(A,h);\n\t\tf2.work(B,h);\n\t\tx=min(A,B);\n\t\tg.work(A,B,k);\n\t\tx=min(A,B);\n\t\t//\u5faa\u73af\u5c55\u5f00\n\t\tfor(i=1;i+8<=C;i+=8)\n\t\t{\n\t\t\tfor(l=1;l<=min(A,B);l=r+1)\n\t\t\t{\n\t\t\t\tr=min(A/(A/l),B/(B/l));\n\t\t\t\ts1+=1ll*(C/i)*(g.calc(r,i)-g.calc(l-1,i)+mod)%mod*f1.calc(A/r,i)%mod*f2.calc(B/r,i)%mod;\n\t\t\t\ts2+=1ll*(C/(i+1))*(g.calc(r,i+1)-g.calc(l-1,i+1)+mod)%mod*f1.calc(A/r,i+1)%mod*f2.calc(B/r,i+1)%mod;\n\t\t\t\ts3+=1ll*(C/(i+2))*(g.calc(r,i+2)-g.calc(l-1,i+2)+mod)%mod*f1.calc(A/r,i+2)%mod*f2.calc(B/r,i+2)%mod;\n\t\t\t\ts4+=1ll*(C/(i+3))*(g.calc(r,i+3)-g.calc(l-1,i+3)+mod)%mod*f1.calc(A/r,i+3)%mod*f2.calc(B/r,i+3)%mod;\n\t\t\t\ts5+=1ll*(C/(i+4))*(g.calc(r,i+4)-g.calc(l-1,i+4)+mod)%mod*f1.calc(A/r,i+4)%mod*f2.calc(B/r,i+4)%mod;\n\t\t\t\ts6+=1ll*(C/(i+5))*(g.calc(r,i+5)-g.calc(l-1,i+5)+mod)%mod*f1.calc(A/r,i+5)%mod*f2.calc(B/r,i+5)%mod;\n\t\t\t\ts7+=1ll*(C/(i+6))*(g.calc(r,i+6)-g.calc(l-1,i+6)+mod)%mod*f1.calc(A/r,i+6)%mod*f2.calc(B/r,i+6)%mod;\n\t\t\t\ts8+=1ll*(C/(i+7))*(g.calc(r,i+7)-g.calc(l-1,i+7)+mod)%mod*f1.calc(A/r,i+7)%mod*f2.calc(B/r,i+7)%mod;\n\t\t\t\ts1%=mod,s2%=mod,s3%=mod,s4%=mod,s5%=mod,s6%=mod,s7%=mod,s8%=mod;\n\t\t\t}\n\t\t}\n\t\tfor(;i<=C;i++)\n\t\t{\n\t\t\tfor(l=1;l<=min(A,B);l=r+1)\n\t\t\t{\n\t\t\t\tr=min(A/(A/l),B/(B/l));\n\t\t\t\tans+=1ll*(C/i)*(g.calc(r,i)-g.calc(l-1,i)+mod)%mod*f1.calc(A/r,i)%mod*f2.calc(B/r,i)%mod;\n\t\t\t\tans%=mod;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%lld\\n\",(ans+s1+s2+s3+s4+s5+s6+s7+s8)%mod);\n\t}\n}\n```\n\u7136\u540e\u4f60\u5c31\u53d1\u73b0\u6700\u540e\u51e0\u4e2a\u70b9\u6302\u6389\u4e86\u3002\n\n\u7a7a\u95f4\u592a\u5927\u4e86\u554a\u554a\u554a\u554a\u554a\u554a\u554a\uff01\uff01\uff01\n\n\u8003\u8651\u518d\u4f18\u5316\u3002\n\n\u5982\u679c $y$ \u542b\u6709\u67d0\u4e2a\u8d28\u6570\u7684\u5e73\u65b9\uff0c\u90a3\u4e48 $p$ \u6211\u4eec\u53ef\u4ee5\u53d6\u8be5\u8d28\u6570\uff0c\u90a3\u4e48 $f(x,y)=f(x,y/p)$\n\n\u56e0\u4e3a\u8fd9\u6837 $[p\\perp y/p]=0$\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f04\u4e00\u4e2a DFS \uff0c\u6765\u679a\u4e3e\u6bcf\u4e00\u4e2a\u4e0d\u542b\u67d0\u8d28\u6570\u7684\u5e73\u65b9\u56e0\u5b50\u7684\u6570\uff08\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3a $\\mu(x)\\not=0$ \u7684\u6570\uff09\uff0c\u4e0d\u4ec5\u65f6\u95f4\u51cf\u5c11\u4e86\uff0c\u7a7a\u95f4\u66f4\u662f\u5c11\u4e86\u4e0d\u5c11\u3002\n```cpp\n#include<cstdio>\n#define N 101010\n#define ri register int\nusing namespace std;\nconst int mod=1e9+7;\nint vis[N],p[N],mu[N],T,n,A,B,x,len;\nlong long g[N][12],f[N][12];\nint k[N],h[N],lw[N],s[N],ans,C;\ninline int min(int a,int b){return a<b?a:b;}\nvoid dfs(ri x,ri i,ri k)\n{\n\tri ss=0,l,r;\n\tfor(l=1;l<=A;l=r+1)\n\t{\n\t\tr=min(A/(A/l),B/(B/l));\n\t\tss=(ss+(g[r][k]-g[l-1][k]+mod)*f[A/r][k]%mod*f[B/r][k]%mod)%mod;\n\t}\n\tans=(ans+1ll*ss*s[x]%mod)%mod;\n\tfor(i=i+1;1ll*p[i]*x<=C&&i<=len;i++)\n\t{\n\t\tfor(l=1;l<=A;l=r+1)\n\t\t{\n\t\t\tr=min(A/(A/l),B/(B/l));\n\t\t\tg[r][k+1]=(g[r][k]+g[r/p[i]][k+1])%mod;\n\t\t\tf[A/r][k+1]=(f[A/r][k]-f[A/r/p[i]][k]+mod)%mod;\n\t\t\tf[B/r][k+1]=(f[B/r][k]-f[B/r/p[i]][k]+mod)%mod;\n\t\t}\n\t\tdfs(x*p[i],i,k+1);\n\t}\n}\nint main()\n{\n\tn=N-1010;\n\tmu[1]=k[1]=h[1]=lw[1]=1;\n\tint i,j,l,r;\n\tfor(i=2;i<=n;i++)\n\t{\n\t\tif(!vis[i]) p[++len]=lw[i]=i,mu[i]=-1,h[i]=2;\n\t\tfor(j=1;j<=len&&i*p[j]<=n;j++)\n\t\t{\n\t\t\tvis[i*p[j]]=1;\n\t\t\tlw[i*p[j]]=lw[i]*p[j];\n\t\t\th[i*p[j]]=h[i]*2;\n\t\t\tif(i%p[j]==0)\n\t\t\t{\n\t\t\t\th[i*p[j]]-=h[i/p[j]];\n\t\t\t\tlw[i*p[j]]=lw[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmu[i*p[j]]=-mu[i];\n\t\t}\n\t\tk[i]=k[i-1]+mu[i];\n\t}\n\tfor(i=2;i<=n;i++) h[i]+=h[i-1];\n\tscanf(\"%d\",&T);\n\twhile(T--)\n\t{\n\t\tans=0;\n\t\tscanf(\"%d%d%d\",&A,&B,&C);\n\t\tif(A>B) i=A,A=B,B=i;\n\t\tfor(l=1,r;l<=A;l=r+1)\n\t\t{\n\t\t\tr=min(A/(A/l),B/(B/l));\n\t\t\tg[r][1]=k[r];\n\t\t\tf[A/r][1]=h[A/r];\n\t\t\tf[B/r][1]=h[B/r];\n\t\t}\n\t\tfor(i=1;i<=C;i++) s[i]=0;\n\t\tfor(i=1;i<=C;i++) s[lw[i]]+=1ll*C/i,s[lw[i]]%=mod;\n\t\tdfs(1,0,1);\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n}\n```\n\u5361\u5e38\u5361\u5230\u6781\u81f4\u4e86\uff0c\u4f46\u4f60\u53d1\u73b0\u8fd8\u662fTLE\u4e86\u2026\u2026\n\n\u67d0\u5927\u4f6c\u544a\u8bc9\u6211\uff0c\u5982\u679c $a,b\\in[0,p)$ \uff0c\u90a3\u4e48\u53ef\u4ee5\u76f4\u63a5\u81ea\u5b9a\u4e49\u4e00\u4e2a\u53d6\u6a21\u51fd\u6570 `int Mod(int a){return a<p?a:a-p;}`\n\n\u7136\u540e\u5c31 AC \u4e86\u3002\n\n\u4ee3\u7801\u4e0d\u653e\u4e86\uff08\u4e2d\u56fd\u6b66\u529f\u8bb2\u7a76\u70b9\u5230\u4e3a\u6b62\uff09",
        "postTime": 1614745482,
        "uid": 99506,
        "name": "_LHF_",
        "ccfLevel": 0,
        "title": "\u65e7\u8bd5\u9898 \u89e3\u9898\u62a5\u544a"
    },
    {
        "content": "\u56e0\u4e3a\u4e0d\u77e5\u9053\u4ec0\u4e48\u539f\u56e0LateX\u65e0\u6cd5\u5728\u9898\u89e3\u754c\u9762\u6b63\u5e38\u663e\u793a\u3002  \n\u5efa\u8bae\u5230\u535a\u5ba2\u4e2d\u67e5\u770b\u3002  \n\u4e00\u9053\u5f88\u6709\u8da3\u7684\u9898\u76ee\u3002     \n\u9898\u76ee\u5927\u610f\uff1a\u6c42\n$$\\sum_{i=1}^A \\sum_{j=1}^B \\sum_{k=1}^C \\sigma_0(ijk)$$\n\u56e0\u4e3a\n$$\\sigma_0(ijk)=\\sum_{p|i}\\sum_{q|j}\\sum_{h|k}[\\epsilon(\\text{gcd}(p,q))][\\epsilon(\\text{gcd}(p,h))][\\epsilon(\\text{gcd}(q,h))]$$\n\u6240\u4ee5\u539f\u5f0f=\n$$\\sum_{i=1}^A\\sum_{j=1}^B\\sum_{k=1}^C\\sum_{p|i}\\sum_{q|j}\\sum_{h|k}[\\epsilon(\\text{gcd}(p,q))][\\epsilon(\\text{gcd}(p,h))][\\epsilon(\\text{gcd}(q,h))]$$\n\u4ea4\u6362\u679a\u4e3e\u987a\u5e8f\uff0c\u679a\u4e3e\u56e0\u6570\n$$\\sum_{p=1}^A\\sum_{q=1}^B\\sum_{h=1}^C\n\\lfloor \\frac{A}{p} \\rfloor \\lfloor \\frac{B}{q} \\rfloor \\lfloor \\frac{C}{h} \\rfloor [\\epsilon(\\text{gcd}(p,q))][\\epsilon(\\text{gcd}(p,h))][\\epsilon(\\text{gcd}(q,h))]$$\n\u628a\u540e\u9762\u90a3\u56e2$\\text{gcd}$\u7528$\\mu$\u51fd\u6570\u6362\u6389\n$$\\sum_{p=1}^A\\sum_{q=1}^B\\sum_{h=1}^C \\sum_{x|\\text{gcd}(p,q)}\\mu(x) \\sum_{y|\\text{gcd}(p,h)} \\mu(y) \\sum_{z|\\text{gcd}(q,h)}\\mu(z)$$\n\u518d\u6362\u4e00\u4e0b\u679a\u4e3e\u987a\u5e8f\n$$\\sum_{x=1}^{\\text{min(A,B)}}\\mu(x) \\sum_{y=1}^{\\text{min}(A,C)}\\mu(y) \\sum_{z=1}^{\\text{min}(B,C)}\\mu(z) \\sum_{x|p \\ \\& \\& \\ y|p} \\lfloor \\frac{A}{p} \\rfloor \\sum_{x|q \\ \\& \\& \\ z|q} \\lfloor \\frac{B}{q} \\rfloor \\sum_{y | h \\ \\& \\& z|h} \\lfloor \\frac{C}{h} \\rfloor$$\n$$\\sum_{x=1}^{\\text{min(A,B)}}\\mu(x) \\sum_{y=1}^{\\text{min}(A,C)}\\mu(y) \\sum_{z=1}^{\\text{min}(B,C)}\\mu(z) \\sum_{\\text{lcm}(x,y)|p} \\lfloor \\frac{A}{p} \\rfloor \\sum_{\\text{lcm}(x,z)|q} \\lfloor \\frac{B}{q} \\rfloor \\sum_{\\text{lcm}(y,z)|h} \\lfloor \\frac{C}{h} \\rfloor$$\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50\u5176\u5b9e\u4e0d\u4e00\u6837\u7684\u5730\u65b9\u53ea\u6709\u4e24\u90e8\u5206...  \n\u5f62\u5982$\\sum \\limits_{a|b}^c \\lfloor \\frac{c}{b} \\rfloor$\u7684\u90a3\u4e09\u9879\u53ef\u4ee5$\\mathcal{O}(n \\log n)$\u9884\u5904\u7406\u51fa\u6765\u3002   \n\u63a5\u4e0b\u6765\u624d\u662f\u8fd9\u9053\u9898\u7684\u7cbe\u9ad3\u3002   \n\u5728$\\mathcal{O}(n^3)$\u679a\u4e3e\u4e09\u5143\u7ec4$(x,y,z)$\u7684\u540c\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u6709\u5f88\u591a\u65f6\u5019\u4ed6\u4eec\u7684\u60c5\u51b5\u662f$0$\u3002   \n1\uff1a$\\mu(x)=0$\u6216$\\mu(y)=0$\u6216$\\mu(z)=0$\u3002   \n2\uff1a\u82e5$\\sum \\limits_{a|b}^c \\lfloor \\frac{c}{b} \\rfloor$\u4e2d\u7684$a$\u5927\u4e8e$c$\uff0c\u5219\u8fd9\u4e2a\u5f0f\u5b50\u7684\u8d21\u732e\u4e00\u5b9a\u4e3a$0$\uff0c\u4e5f\u5c31\u662f\u8bf4\u5f53$\\text{lcm}(x,y) \\geq A$\u6216$\\text{lcm}(x,z) \\geq B$\u6216$\\text{lcm}(y,z) \\geq C$\u65f6\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u7684\u8d21\u732e\u4e00\u5b9a\u4e3a$0$\u3002  \n\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u679a\u4e3e\u6700\u5927\u516c\u7ea6\u6570$g$\uff0c\u4f7f\u5f97$u=i \\times g,v = j \\times g, \\mu(u) \\neq 0,\\mu(v) \\neq 0$\u5e76\u4fdd\u8bc1$i$\u4e0e$j$\u4e92\u8d28\u4e14$\\text{lcm}(u,v)=i \\times j \\times g \\leq \\text{max}(A,B,C)$\uff0c\u8fde\u8fb9$(u,v)$\uff0c\u6700\u540e\u7edf\u8ba1\u4e09\u5143\u73af\u7684\u65f6\u5019\u987a\u4fbf\u8ba1\u6570\u5c31\u597d\u4e86\u3002   \n\u56e0\u4e3a$\\mathsf{s{\\color{red}hadowice1984}}$\u5927\u4f6c\u544a\u8bc9\u6211\u4eec\u8fb9\u6570\u6700\u591a\u53ea\u6709$760741$\u6761\uff0c\u6240\u4ee5$m \\sqrt m$\u662f\u53ef\u8fc7\u7684\u3002   \n\u4ee3\u7801\uff1a  \n```cpp\n#include <bits/stdc++.h>\n\ntypedef long long ll;\nconst int N = 1e5 + 200;\nconst ll mod = 1e9 + 7;\ntypedef std::pair<int, int> pii;\n\nint n, m, i, j, k, prim_tot, T, A, B, C, mx, mn, cnte;\nll _1[N], _2[N], _3[N];\nint vis[N], deg[N];\nint mu[N], prim[N]; \nbool _vis[N];\nll ans;\n\ninline void sieve(int n) {\n  mu[1] = 1;\n  for (int i = 2; i <= n; i++) {\n    if (!_vis[i]) prim[++prim_tot] = i, mu[i] = -1;\n    for (int j = 1; j <= prim_tot && i * prim[j] <= n; j++) {\n      _vis[i * prim[j]] = 1;\n      if (i % prim[j] == 0) break;\n      else mu[i * prim[j]] = -mu[i];\n    }\n  }\n}\n\nstruct edge {\n  int u, v, w;\n  edge() { u = v = w = 0; }\n  edge(int _u, int _v, int _w) {\n    u = _u, v = _v, w = _w;\n  }\n} edges[N << 4];\n\nstd::vector<pii> G[N];\n\ninline void init() {\n  scanf(\"%d %d %d\", &A, &B, &C), ans = 0, cnte = 0;\n  mx = std::max(std::max(A, B), C);\n  mn = std::min(std::min(A, B), C);\n  for (int i = 1; i <= mx; i += 8) {\n    _1[i] = _1[i + 1] = _1[i + 2] = _1[i + 3] = _1[i + 4] = _1[i + 5] = _1[i + 6] = _1[i + 7] = 0;\n    _2[i] = _2[i + 1] = _2[i + 2] = _2[i + 3] = _2[i + 4] = _2[i + 5] = _2[i + 6] = _2[i + 7] = 0;\n    _3[i] = _3[i + 1] = _3[i + 2] = _3[i + 3] = _3[i + 4] = _3[i + 5] = _3[i + 6] = _3[i + 7] = 0;\n    deg[i] = deg[i + 1] = deg[i + 2] = deg[i + 3] = deg[i + 4] = deg[i + 5] = deg[i + 6] = deg[i + 7] = 0;\n  }\n  for (int i = 1; i <= mx; i++) G[i].clear();\n  for (int i = 1; i <= A; i++) {\n    for (int j = i; j <= A; j += i)\n      _1[i] += A / j;\n  }\n  for (int i = 1; i <= B; i++) {\n    for (int j = i; j <= B; j += i) \n      _2[i] += B / j;\n  }\n  for (int i = 1; i <= C; i++) {\n    for (int j = i; j <= C; j += i)\n      _3[i] += C / j;\n  }\n}\ninline void solve() {\n  for (int i = 1; i <= mn; i++) {\n    if (mu[i]) ans += 1ll * mu[i] * mu[i] * mu[i] * _1[i] * _2[i] * _3[i];\n  }\n  for (int g = 1; g <= mx; g++) {\n    for (int i = 1; i * g <= mx; i++) {\n      if (!mu[i * g]) continue;\n      for (int j = i + 1; 1ll * i * j * g <= mx; j++) {\n        if (mu[j * g] && std::__gcd(i, j) == 1) {\n          int u = i * g, v = j * g, lcm = i * j * g;\n          int p = mu[u] * mu[u] * mu[v], q = mu[u] * mu[v] * mu[v];\n          ans += p * (_1[u] * _2[lcm] * _3[lcm] + _1[lcm] * _2[u] * _3[lcm] + _1[lcm] * _2[lcm] * _3[u]);\n          ans += q * (_1[v] * _2[lcm] * _3[lcm] + _1[lcm] * _2[v] * _3[lcm] + _1[lcm] * _2[lcm] * _3[v]);\n          deg[u]++, deg[v]++;\n          edges[++cnte] = edge(u, v, lcm);\n        }\n      }\n    }\n  }\n  for (int i = 1; i <= cnte; i++) {\n    int u = edges[i].u, v = edges[i].v, w = edges[i].w;\n    if (deg[u] < deg[v] || (deg[u] == deg[v] && u > v)) std::swap(u, v);\n    G[u].push_back(std::make_pair(v, w));\n  }\n  for (int k = 1; k <= mx; k++) {\n    if (!mu[k]) continue;\n    int SZ = G[k].size();\n    for (int i = 0; i < SZ; i++) vis[G[k][i].first] = G[k][i].second;\n    for (int i = 0; i < SZ; i++) {\n      int v = G[k][i].first, w = G[k][i].second;\n      if (!mu[v]) continue;\n      for (int j = 0, _SZ = G[v].size(); j < _SZ; j++) {\n        int vv = G[v][j].first;\n        if (!vis[vv]) continue;\n        int wyz = G[v][j].second, wxz = vis[vv], mmu = mu[k] * mu[v] * mu[vv];\n        if (!mmu) continue;\n        ans += mmu * (_1[w] * _2[wyz] * _3[wxz] + _1[w] * _2[wxz] * _3[wyz] \n                    + _1[wyz] * _2[w] * _3[wxz] + _1[wyz] * _2[wxz] * _3[w]\n                    + _1[wxz] * _2[w] * _3[wyz] + _1[wxz] * _2[wyz] * _3[w]);\n      }\n    }\n    for (int i = 0; i < SZ; i++) vis[G[k][i].first] = 0;\n  }\n  printf(\"%lld\\n\", ans % mod);\n}\n\nint main() {\n  sieve(100000);\n  scanf(\"%d\", &T);\n  while (T--) init(), solve();\n  return 0;\n}\n\n```\n\n\n",
        "postTime": 1581678220,
        "uid": 114320,
        "name": "\u843d\u6c50",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4619 \u3010[SDOI2018]\u65e7\u8bd5\u9898\u3011"
    },
    {
        "content": "\u5982\u679c $\\LaTeX$ \u5d29\u4e86\u5c31\u8bf7\u5230 [myblog](https://www.luogu.com.cn/blog/My-luoguBuoke-HZR/solution-p4619) \u67e5\u770b\u5427QAQ\n\n\u9898\u610f\uff1a\n\n\u6c42\n\n$$\\sum_{i=1}^A\\sum_{j=1}^B\\sum_{k=1}^Cd(ijk) \\mod (10^9+7)$$\n\n\u5176\u4e2d\uff0c$d(x)=\\sum\\limits_{p|x}1$ \uff0c\u5373\u80fd\u6574\u9664 $x$ \u7684\u6570\u7684\u6570\u76ee\u3002\n\n---\n\n\u7ed3\u8bba\uff1a \n\n$d(ijk)=\\sum\\limits_{d|i}\\sum\\limits_{t|j}\\sum\\limits_{p|k}[d \\perp t][d \\perp p][t \\perp p]$\n\n\u5176\u4e2d $a \\perp b$ \u76f8\u5f53\u4e8e $a$ \u548c $b$ \u4e92\u8d28\u3002\n\n(\u8fd9\u4e2a\u7ed3\u8bba\u8fd8\u6709\u8bb8\u591a\u6269\u5c55\uff0c\u6bd4\u5982  $d(ij)=\\sum\\limits_{d|i}\\sum\\limits_{t|j}[d \\perp t]$ )\n\n\u90a3\u4e48\u539f\u5f0f\u53ef\u4ee5\u8f6c\u5316\u6210\uff1a\n\n$$\n\\sum_{i=1}^A\n\\sum_{j=1}^B\n\\sum_{k=1}^C\n\\sum_{d|i}\n\\sum_{t|j}\n\\sum_{p|k}\n[d \\perp t][d \\perp p][t \\perp p]\n$$\n\n$$\n\\sum_{i=1}^A\n\\sum_{j=1}^B\n\\sum_{k=1}^C\n\\sum_{d|i}\n\\sum_{t|j}\n\\sum_{p|k}\n[\\gcd(d,t)=1][\\gcd(d,p)=1][\\gcd(t,p)=1]\n$$\n\n\u7136\u540e\u7ed9 $\\sum\\limits_{i=1}^A\\sum\\limits_{d|i}$ \u8fd9\u79cd\u4e1c\u897f\u51d1\u5230\u4e00\u8d77\uff1a\n\n$$\n\\sum_{i=1}^A\n\\sum_{d|i}\n\\sum_{j=1}^B\n\\sum_{t|j}\n\\sum_{k=1}^C\n\\sum_{p|k}\n[\\gcd(d,t)=1][\\gcd(d,p)=1][\\gcd(t,p)=1]\n$$\n\n\u7136\u540e\u51d1\u5230\u4e00\u8d77\u7684\u8fd9\u4e2a\u5f0f\u5b50\u975e\u5e38\u719f\u6089\u3002\u3002\u5b83\u53ef\u4ee5\u88ab\u8f6c\u5316\u6210 $\\sum\\limits_{d=1}^A\\sum\\limits_{i=1}^{\\left\\lfloor{\\frac{A}{d}}\\right\\rfloor}$ \u7684\u5f62\u5f0f\u3002\n\n$$\n\\sum\\limits_{d=1}^A\n\\sum\\limits_{i=1}^{\\left\\lfloor{\\frac{A}{d}}\\right\\rfloor}\n\\sum\\limits_{t=1}^B\n\\sum\\limits_{j=1}^{\\left\\lfloor{\\frac{B}{t}}\\right\\rfloor}\n\\sum\\limits_{p=1}^C\n\\sum\\limits_{k=1}^{\\left\\lfloor{\\frac{C}{p}}\\right\\rfloor}\n[\\gcd(d,t)=1][\\gcd(d,p)=1][\\gcd(t,p)=1]\n$$\n\n\u7136\u540e\u6211\u4eec\u5c31\u6d88\u6389\u4e09\u4e2a $\\sum$ \u4e86 QwQ\n\n$$\n\\sum\\limits_{d=1}^A\n\\sum\\limits_{t=1}^B\n\\sum\\limits_{p=1}^C\n[\\gcd(d,t)=1][\\gcd(d,p)=1][\\gcd(t,p)=1]\n{\\left\\lfloor{\\frac{A}{d}}\\right\\rfloor}\n{\\left\\lfloor{\\frac{B}{t}}\\right\\rfloor}\n{\\left\\lfloor{\\frac{C}{p}}\\right\\rfloor}\n$$\n\n\u90a3\u4e48\u5c31\u53ef\u4ee5\u53cd\u6f14\u4e86\uff1a\n\n$$\n\\sum_{d=1}^A\n\\sum_{t=1}^B\n\\sum_{p=1}^C\n{\\left\\lfloor{\\frac{A}{d}}\\right\\rfloor}\n{\\left\\lfloor{\\frac{B}{t}}\\right\\rfloor}\n{\\left\\lfloor{\\frac{C}{p}}\\right\\rfloor}\n\\sum_{a|d,t}\\mu(a)\n\\sum_{b|d,p}\\mu(b)\n\\sum_{c|t,p}\\mu(c)\n$$\n\n\u6839\u636e\u4e00\u8d2f\u5957\u8def\uff0c\u6539\u53d8\u679a\u4e3e\u987a\u5e8f\u5148\u679a\u4e3e $a,b,c$ \uff1a\n\n$$\n\\sum_{a=1}^{\\min(A,B)}\n\\sum_{b=1}^{\\min(A,C)}\n\\sum_{c=1}^{\\min(B,C)}\n\\mu(a)\\mu(b)\\mu(c)\n\\sum_{a,b|d}{\\left\\lfloor{\\frac{A}{d}}\\right\\rfloor}\n\\sum_{a,c|t}{\\left\\lfloor{\\frac{B}{t}}\\right\\rfloor}\n\\sum_{b,c|p}{\\left\\lfloor{\\frac{C}{p}}\\right\\rfloor}\n$$\n\n\u7136\u540e\u53d1\u73b0 $x,y|z \\Leftrightarrow \\text{lcm}(x,y)|z$ \u90a3\u4e48\n\n$$\n\\sum_{a=1}^{\\min(A,B)}\n\\sum_{b=1}^{\\min(A,C)}\n\\sum_{c=1}^{\\min(B,C)}\n\\mu(a)\\mu(b)\\mu(c)\n\\sum_{\\text{lcm}(a,b)|d}{\\left\\lfloor{\\frac{A}{d}}\\right\\rfloor}\n\\sum_{\\text{lcm}(a,c)|t}{\\left\\lfloor{\\frac{B}{t}}\\right\\rfloor}\n\\sum_{\\text{lcm}(b,c)|p}{\\left\\lfloor{\\frac{C}{p}}\\right\\rfloor}\n$$\n\n\u5bf9\u4e8e\u540e\u9762\u90a3\u4e00\u5927\u5768(?)\uff0c\u6bd4\u5982 $\n\\sum\\limits_{\\text{lcm}(a,b)|d}{\\left\\lfloor{\\frac{A}{d}}\\right\\rfloor}$ \u53ef\u4ee5 $O(n\\log n)$ \u9884\u5904\u7406\u3002\n\n\u73b0\u5728\u95ee\u9898\u662f\u600e\u4e48\u5904\u7406\u524d\u9762\u8fd9\u4e2a\u4e1c\u897f\u3002\n\n\u5047\u5982\u76f4\u63a5\u679a\u4e3e\u590d\u6742\u5ea6\u8fbe\u5230 $n^3$ \u80af\u5b9a\u8fc7\u4e0d\u4e86\u3002\u3002\n\n\u518d\u6b21\u89c2\u5bdf\u5f0f\u5b50 $\\sum\\limits_{\\text{lcm}(a,b)|d}{\\left\\lfloor{\\frac{A}{d}}\\right\\rfloor}$ \uff0c\u6709\uff1a\u82e5 $\\text{lcm}(a,b)>A$ \u90a3\u4e48\u8fd9\u4e2a\u5f0f\u5b50\u80af\u5b9a\u662f $0$ \u3002\n\n\u4e8e\u662f\u8003\u8651\u5efa\u4e00\u5f20\u56fe\uff0c\u7136\u540e\u5bf9\u6240\u6709\u4e8c\u5143\u7ec4 $(x,y)$ \u82e5 $\\text{lcm}(x,y)\\leq \\max(A,B,C)$ \u5c31\u7ed9\u5b83\u4eec\u8fde\u4e00\u6761\u8fb9\u3002\n\n\u7136\u540e\u4e09\u5143\u73af\u8ba1\u6570\u5373\u53ef\u3002 \u590d\u6742\u5ea6 $O(m\\sqrt m)$ \uff0c\u5176\u4e2d $m$ \u662f\u8fb9\u6570\u3002\u53ef\u4ee5\u8bc1\u660e $m$ \u975e\u5e38\u5c0f\u3002\n\n\u6ce8\u610f\u76f4\u63a5\u7528\u4e09\u5143\u73af\u8ba1\u6570\u7b97\u51fa\u7684 $(a,b,c)$ \u662f\u65e0\u5e8f\u7684\u3002\n\n\u53e6\u5916\u6ce8\u610f\u52a0\u4e0a $(a,a,*)$ \u548c $(a,a,a)$ \u7684\u60c5\u51b5\u3002\n\n\u6b64\u9898\uff08\u5341\u5206\uff09\u5361\u5e38\u3002\n\n\u8fd9\u79cd\u9898\u6211\u611f\u89c9\u8003\u573a\u5b8c\u5168\u60f3\u4e0d\u51fa\u6765\u5427\u3002\u3002\u592a\u6bd2\u7624\u4e86\uff08\u5176\u5b9e\u662f\u6211\u592a\u83dc\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define P pair<ll,ll>\nusing namespace std;\nconst int N=100010,mod=1000000007;\nint i,j,k,n,m,T;\nint prime[N],is_prime[N],num,mu[N];\nvector<int>V[N];\nint A,B,C,Max;\nvoid init(){\n    for(ll i=2;i<N;i++)is_prime[i]=1;\n    mu[1]=1;\n    for(ll i=2;i<N;i++){\n        if(is_prime[i])prime[++num]=i,mu[i]=-1;\n        for(ll j=1;j<=num && i*prime[j]<N;j++){\n            is_prime[i*prime[j]]=0;\n            if(i%prime[j]==0)break;\n            mu[i*prime[j]]=-mu[i];\n        }\n    }\n    for(ll i=1;i<N;i++)\n        for(ll j=1;prime[j]*i<N && j<=num;j++)\n        \tV[i*prime[j]].push_back(prime[j]);\n}\nstruct Edge{int x,y,Lcm;}E[35*N];ll len;\nll Du[N],Sum1[N],Sum2[N],Sum3[N];\nvoid work(){\n    for(int i=1;i<N;i++){\n        Sum1[i]=Sum2[i]=Sum3[i]=0;\n\t\tfor(int j=i;j<N;j+=i){ \n            Sum1[i]+=A/j;Sum2[i]+=B/j;Sum3[i]+=C/j;\n            Sum1[i]%=mod;Sum2[i]%=mod;Sum3[i]%=mod;\n        }\n\t}\n    for(int i=1;i<=Max;i++){\n    \tif(!mu[i])continue;\n        int Len=V[i].size();\n        for(int j=0;j<(1<<Len);j++){\n            int X=1,now=j;for(int k=0;k<Len;k++,now>>=1)if(now&1)X*=V[i][k];\n            for(int k=j;;k=(k-1)&j){\n                int Gcd=1,Now=k;\n                for(int h=0;h<Len;h++,Now>>=1)if(Now&1)Gcd*=V[i][h];\n                int Y=(ll)i*Gcd/X;\n                if(X<Y){\n\t                E[++len]=(Edge){X,Y,i};\n\t                Du[X]++;Du[Y]++;\n\t\t\t\t}\n\t\t\t\tif(!k)break;\n            }\n        }\n    }\n}\nstruct edge{\n    int next,to,Lcm;\n}a[N*35];\nint head[N],Len;\ninline void add(int x,int y,int z){\n    a[++Len]=(edge){head[x],y,z};\n    head[x]=Len;\n//    cout<<\"add : x=\"<<x<<\" y=\"<<y<<endl;\n}\nint Vis[N];\ninline int check(int a,int b,int c,int X,int Y,int Z){\n    return mu[a]*mu[b]*mu[c]*(Sum1[X]*Sum2[Y]%mod*Sum3[Z])%mod;\n}\nint main(){\n    cin>>T;\n    init();\n    while(T--){\n        Len=len=0;\n        memset(head,0,sizeof(head));\n        cin>>A>>B>>C;\n        Max=max(max(A,B),C);\n        work();\n        for(i=1;i<=len;i++){\n            if(Du[E[i].x]>=Du[E[i].y])add(E[i].x,E[i].y,E[i].Lcm);\n            else add(E[i].y,E[i].x,E[i].Lcm);\n        }\n        register ll ans=0;\n        for(i=1;i<=Max;i++){\n            for(j=head[i];j;j=a[j].next){\n                int u=a[j].to;\n                Vis[u]=a[j].Lcm;\n            }\n            for(j=head[i];j;j=a[j].next){\n                int u=a[j].to,Lcm=a[j].Lcm;\n                for(k=head[u];k;k=a[k].next)\n                    if(Vis[a[k].to]){\n                    \tint A=i,B=u,C=a[k].to,A_B=Lcm,A_C=Vis[a[k].to],B_C=a[k].Lcm;\n                        ans+=(\n\t\t\t\t\t\t\t(ll)check(A,B,C,A_B,A_C,B_C)+check(A,C,B,A_C,A_B,B_C)+\n\t\t\t\t\t\t\tcheck(B,A,C,A_B,B_C,A_C)+check(B,C,A,B_C,A_B,A_C)+\n\t\t\t\t\t\t\tcheck(C,A,B,A_C,B_C,A_B)+check(C,B,A,B_C,A_C,A_B)\n\t\t\t\t\t\t\t)%mod;\n\t\t\t\t\t\tans%=mod;\n\t\t\t\t\t}\n            }\n            for(j=head[i];j;j=a[j].next){\n                int u=a[j].to;\n                Vis[u]=0;\n            }\n        }\n        \n\t\tfor(i=1;i<=Max;i++){\n\t\t\tif(!mu[i])continue;\n\t\t\tfor(j=head[i];j;j=a[j].next){\n\t\t\t\tint u=a[j].to;\n\t\t\t\tans+=((ll)check(i,i,u,i,a[j].Lcm,a[j].Lcm)+check(i,u,i,a[j].Lcm,i,a[j].Lcm)+check(u,i,i,a[j].Lcm,a[j].Lcm,i)+\n\t\t\t\t\t  check(i,u,u,a[j].Lcm,a[j].Lcm,u)+check(u,u,i,u,a[j].Lcm,a[j].Lcm)+check(u,i,u,a[j].Lcm,u,a[j].Lcm))%mod;\n\t\t\t\tans%=mod;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\tfor(i=1;i<=Max;i++){\n\t\t\tif(!mu[i])continue;\n\t\t\tans+=check(i,i,i,i,i,i);\n\t\t\tans%=mod;\n\t\t}\n\t\t\n\t\tcout<<(ans+mod)%mod<<endl;\n    }return 0;\n}\n```",
        "postTime": 1584450349,
        "uid": 35891,
        "name": "huangzirui",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4619 \u3010[SDOI2018]\u65e7\u8bd5\u9898\u3011"
    },
    {
        "content": "~~\u4e00\u9053\u667a\u6167\u7684\u53cd\u6f14\u9898~~\n\n\u597d\u50cf\u4e0d\u7528\u4e09\u5143\u56fe\uff0c\u7eaf\u6570\u8bba\u4e5f\u80fd\u8fc7\uff0c\u4f46\u8dd1\u5f97\u6709\u70b9\u5c0f\u6162\n\n------------\n### \u524d\u7f6e\u829d\u58eb\n> 1.\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n>\n> 2.\u6574\u9664\u5206\u5757\n>\n> 3.\u53ef\u4ee5\u5148\u505a[P3327](https://www.luogu.com.cn/problem/P3327)\n\n### \u6b63\u9898\n\n\u4f17\u6240\u5468\u77e5\uff0c\u672c\u9898\u8981\u6211\u4eec\u6c42\u8fd9\u4e2a \n$$\\sum_{i=1}^{A}\\sum_{j=1}^{B}\\sum_{k=1}^{C}d(ijk)\\bmod(1e9+7)$$\n\n\u90a3\u4e48\u5bf9\u4e8e $d(ijk)$ \u6709\u8fd9\u6837\u6d45\u663e\u7684\u6027\u8d28 \n$$d(ijk)=\\sum_{x|i}\\sum_{y|j}\\sum_{z|k}{[x \\bot y]}{[x\\bot z]}{[y\\bot z]}$$\n\n\u6240\u4ee5\u6c42\u8fd9\u4e2a \n$$\\sum_{i=1}^{A}\\sum_{j=1}^{B}\\sum_{k=1}^{C}\\sum_{x|i}\\sum_{y|j}\\sum_{z|k}{[x \\bot y]}{[x\\bot z]}{[y\\bot z]}$$\n\u8be5\u679a\u4e3e\u7ea6\u6811\u4e3a\u679a\u4e3e\u500d\u6570 \n$$\\sum_{x=1}^{A}\\sum_{y=1}^{B}\\sum_{z=1}^{C}{\\left[ \\frac{A}{x} \\right]\\left[ \\frac{B}{y} \\right]\\left[ \\frac{C}{z} \\right]}{[x \\bot y]}{[x\\bot z]}{[y\\bot z]}$$\n\n\u7136\u540e\u6211\u4eec\u6311\u4e00\u4e2a $[y\\bot z]$ \u6765\u53cd\u6f14\uff08\u8fd9\u91cc\u5927\u5bb6\u968f\u610f\u6311\u54ea\u4e2a\uff09 \n$$\\sum_{x=1}^{A}{\\left[ \\frac{A}{x} \\right]}\\sum_{y=1}^{B}\\sum_{z=1}^{C}\\left[ \\frac{B}{y} \\right][y \\bot x]\\left[ \\frac{C}{z} \\right][z \\bot x]\\sum_{d|z,d|y}{\\mu(d)}$$\n\n\n$$\\sum_{x=1}^{A}{\\left[ \\frac{A}{x} \\right]}\\sum^{\\min(B,C)}_{d=1}{\\mu(d)[d \\bot x]}\\sum^{\\left[ \\frac{B}{d} \\right]}_{y=1}\\sum^{\\left[ \\frac{C}{d} \\right]}_{z=1}{\\left[ \\frac{B}{yd} \\right][y\\bot x]\\left[ \\frac{C}{zd} \\right][z\\bot x]}$$\n\n\n------------\n#### \u4ee5\u4e0a\u6211\u4eec\u8d70\u51fa\u4e86\u65b0\u624b\u6751\uff0c\u63a5\u4e0b\u6765\u7684\u63a8\u5bfc\u76f8\u5f53\u91cd\u8981\n\u6211\u4eec\u4ee4 $f(n,x)=\\sum_{d=1}^{n}\\left[ \\frac{n}{d} \\right][d \\bot x]$\n\u518d\u4ee4 $g(n,x)=\\sum_{d=1}^{n}{\\mu(d)[d \\bot x]}$\n\n$$\\sum_{x=1}^{A}{\\left[ \\frac{A}{x} \\right]}\\sum_{}^{}{(g(r,x)-g(l-1,x))f(\\left[ \\frac{B}{d} \\right],x)f(\\left[ \\frac{C}{d} \\right],x)}$$\n\u5176\u4e2d $l$ \u548c $r$ \u662f\u6574\u9664\u5206\u5757\u65f6\u7684\u53c2\u6570\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u8003\u8651\u4f18\u5316 $f$ \u548c $g$ \u7684\u6c42\u6cd5\n\n\u91cd\u8981\u6027\u8d28\uff1a\u8bbe $x_0$ \u662f\u53ea\u8003\u8651 $x$ \u4e2d\u4e0d\u540c\u7d20\u56e0\u5b50\u4e4b\u540e\u5f97\u5230\u7684\u6570\uff0c\u4e0e $x$ \u4e92\u8d28\u548c\u4e0e $x_0$\u4e92\u8d28\u7b49\u4ef7\uff0c\u56e0\u6b64\u53ef\u4ee5\u53ea\u8003\u8651\u65e0\u5e73\u65b9\u56e0\u5b50\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e $f$ \u548c $g$ \u6211\u4eec\u5c31\u53ef\u4ee5\u6839\u636e\u4ee5\u4e0a\u6027\u8d28\u5f97\u5230\u4ee5\u53bb\u6389\u67d0\u4e2a\u7d20\u56e0\u5b50\u4e3a\u9012\u63a8\u5173\u7cfb\u7684\u9012\u63a8\u5f0f \n$$f(n,x)=f(\\left[ \\frac{n}{p} \\right],x)-f(\\left[ \\frac{n}{p} \\right],\\frac{x}{p})$$\n$$g(n,x)=g(n,\\frac{x}{p})+g(\\left[ \\frac{x}{p} \\right],x)$$\n\n\u4ee5\u4e0a\u9012\u63a8\u5f0f\u5176\u5b9e\u4e5f\u662f\u6570\u8bba\u4f53\u4e2d\u7684\u5e38\u89c1\u5957\u8def\uff0c\u53ef\u4ee5\u7528\u6574\u9664\u5206\u5757 $O(\\sqrt n)$ \u641e\u51fa\u6765\uff0c\u6211\u770b\u89c1\u6709 dalao \u5199\u4e86\u5173\u4e8e\u5b83\u7684\u8bc1\u660e\uff0c \u800c\u4e14\u6211\u76f8\u5f53\u61d2\uff0c\u5c31\u4e0d\u5199\u8bc1\u660e\u4e86\n\n\u518d\u7528\u4e0a\u4e00\u4e2a\u5c0f\u6df1\u641c\u5c31\u53ef\u4ee5 AC \u4e86\n\n\n------------\n### \u4ee3\u7801\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define reg register\nconst int N=2*1e5;\nconst int mod=1e9+7;\nint vis[N],mul[N],d[N],saw[N],p[N],tot;\nll f[N][20],g[N][20],s[N],ans;\nint T,A,B,C;\n\ninline void ph(){\n\tmul[1]=1;\n\td[1]=1;\n\tsaw[1]=1;\n\tfor(reg int i=2;i<N;i++){\n\t\tif(!vis[i]){\n\t\t\tp[++tot]=i;\n\t\t\tmul[i]=-1;\n\t\t\td[i]=2;\n\t\t\tsaw[i]=i;\n\t\t}\n\t\tfor(reg int j=1;j<=tot&&p[j]*i<N;j++){\n\t\t\tvis[i*p[j]]=1;\n\t\t\tif(i%p[j]==0){\n\t\t\t\td[i*p[j]]=(d[i]<<1)-d[i/p[j]];\n\t\t\t\tsaw[i*p[j]]=saw[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\td[i*p[j]]=d[i]<<1;\n\t\t\tsaw[i*p[j]]=saw[i]*p[j];\n\t\t\tmul[i*p[j]]=-mul[i];\n\t\t}\n\t}\n\tfor(reg int i=1;i<N;i++){\n\t\td[i]+=d[i-1];\n\t\tmul[i]+=mul[i-1];\n\t}\n//\tfor(int i=1;i<=100;i++){\n//\t\tprintf(\"d--->%d mul---->%d\\n\",d[i],mul[i]);\n//\t}\n}\n\ninline void kasu(){\n\tg[0][1]=0;\n\tf[0][1]=0;\n\tfor(reg int l=1,r;l<=A;++l){\n\t\tr=min(A/(A/l),B/(B/l));\n\t\tg[r][1]=mul[r];\n\t\tf[A/l][1]=d[A/l];\n\t\tf[B/l][1]=d[B/l];\n\t\tl=r;\n\t}\n\tmemset(s,0,sizeof(s));\n\tfor(reg int i=1;i<=C;i++){\n\t\ts[saw[i]]+=C/i;\n\t}\n}\n\ninline void reset(int x,int k){\n\tfor(reg int l=1,r;l<=A;++l){\n\t\tr=min(A/(A/l),B/(B/l));\n\t\tg[r][k]=g[r][k-1]+g[r/x][k];\n\t\tf[A/l][k]=f[A/l][k-1]-f[(A/l)/x][k-1];\n\t\tf[B/l][k]=f[B/l][k-1]-f[(B/l)/x][k-1];\n\t\tl=r;\n\t}\n}\ninline void dfs(int re,int x,int k){\n    ll res=0;\n    for(reg int l=1,r;l<=A;++l){\n        r=min(A/(A/l),B/(B/l));\n        res+=((g[r][k]-g[l-1][k])*f[A/l][k]*f[B/l][k])%mod;\n        res=(res%mod+mod)%mod;\n        l=r;\n    }\n    ans+=(s[re]*res)%mod;\n    ans%=mod;\n    for(reg int i=x;1ll*p[i]*re<=C;i++){\n    \treset(p[i],k+1);\n\t\tdfs(re*p[i],i+1,k+1);\n\t}\n\treturn ;\n}\n\nint main(){\n\tios::sync_with_stdio(false);\n\tcin>>T;\n\tph();\n\twhile(T--){\n\t\tans=0;\n\t\tcin>>A>>B>>C;\n\t\tif(A>B) swap(A,B);\n\t\tkasu();\n\t\tdfs(1,1,1);\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1632982868,
        "uid": 307826,
        "name": "Lamorak",
        "ccfLevel": 0,
        "title": "P4619\u9898\u89e3"
    },
    {
        "content": "$$\\sum_{i=1}^A\\sum_{j=1}^B\\sum_{k=1}^Cd(ijk)$$\n\n$$\\sum_{i=1}^A\\sum_{j=1}^B\\sum_{k=1}^C\\sum_{x|i}\\sum_{y|j}\\sum_{z|k}[(x,y)=1][(y,z)=1][(x,z)=1]$$\n\n$$\\sum_{x=1}^A\\sum_{y=1}^B\\sum_{z=1}^C \\lfloor \\frac{A}{x} \\rfloor \\lfloor \\frac{B}{y} \\rfloor \\lfloor \\frac{C}{z} \\rfloor [(x,y)=1][(y,z)=1][(x,z)=1]$$\n\n$$\\sum_{x=1}^A\\sum_{y=1}^B\\sum_{z=1}^C \\lfloor \\frac{A}{x} \\rfloor \\lfloor \\frac{B}{y} \\rfloor \\lfloor \\frac{C}{z} \\rfloor \\sum_{d_1|(x,y)}\\mu(d_1)\\sum_{d_2|(y,z)}\\mu(d_2)\\sum_{d_3|(x,z)}\\mu(d_3)$$\n\n$$\\sum_{d_1=1}^{min(A,B)}\\sum_{d_2=1}^{min(B,C)}\\sum_{d_3=1}^{min(A,C)} \\mu(d_1)\\mu(d_2)\\mu(d_3) \\sum_{[d_1,d_3]|x} \\lfloor \\frac{A}{x} \\rfloor \\sum_{[d_1,d_2)]|y} \\lfloor \\frac{B}{y} \\rfloor \\sum_{[d_2,d_3]|z} \\lfloor \\frac{C}{z} \\rfloor $$\n\n\u4ee4 $f(n,A)=\\sum_{n|d} \\lfloor \\frac{A}{d} \\rfloor$ , \u53ef\u4ee5 $\\Theta(n \\ln n)$ \u9884\u5904\u7406 $f(n,A/B/C)$\n\n$$\\sum_{d_1=1}^{min(A,B)}\\sum_{d_2=1}^{min(B,C)}\\sum_{d_3=1}^{min(A,C)} \\mu(d_1)\\mu(d_2)\\mu(d_3) f([d_1,d_3],A) f([d_1,d_2],B) f([d_2,d_3],C)$$\n\n\u6ce8\u610f\u5230\u5f53 $[d_1,d_3]>A~,~[d_1,d_2]>B~,~[d_2,d_3]>C$ \u65f6\u51fd\u6570\u503c\u4e3a0 \uff0c $\\mu$ \u7684\u5927\u90e8\u5206\u503c\u4e3a $0$\uff0c\u6240\u4ee5\u6709\u8d21\u732e\u7684\u60c5\u51b5\u4e0d\u591a\u3002\n\n\u5bf9\u4e8e $(u,v)$\uff0c\u5f53 $\\mu(u)\\not=0, \\mu(v)\\not=0$ \u4e14 $[u,v] \\le \\max \\{A,B,C\\}$ \u65f6\u8fde\u8fb9\u3002\n\n$u,v$ \u53ef\u4ee5\u679a\u4e3e\u6700\u5927\u516c\u56e0\u6570 $d$ \u540e\u679a\u4e3e\u500d\u6570 $i,j$ \uff0c \u4f46\u8981\u4fdd\u8bc1 $(i,j)=1$\u3002\n\n\u8fd9\u6837\u56fe\u4e0a\u7684\u4e09\u5143\u73af\u4fbf\u5bf9\u5e94\u7740\u6bcf\u4e00\u79cd\u6709\u8d21\u732e\u7684\u60c5\u51b5\u3002\n\n\u6700\u540e\u7279\u6b8a\u7edf\u8ba1\u4e00\u4e0b\u4e09\u4e2a\u70b9\u76f8\u7b49\u548c\u4e24\u4e2a\u70b9\u76f8\u7b49\u7684\u60c5\u51b5\u3002\n\n```cpp\n#include <cstdio>\n#include <vector>\n#include <iostream>\nusing namespace std;\n\nconst int Mod = 1e9 + 7 , MAXN = 1e5;\nint t , A , B , C , n , m;\nint cnt , vt[ MAXN + 5 ] , Deg[ MAXN + 5 ];\nstruct node {\n\tint u , v , w;\n}E[ 8 * MAXN + 5 ];\nstruct Edge {\n\tint v , w; \n};\nvector< Edge > Graph[ MAXN + 5 ];\nint k , prime[ MAXN + 5 ] , mu[ MAXN + 5 ] , f[ 3 ][ MAXN + 5 ];\nbool vis[ MAXN + 5 ];\n\nvoid Init( ) {\n\tmu[ 1 ] = 1;\n\tfor( int i = 2 ; i <= n ; i ++ ) {\n\t\tif( !vis[ i ] ) {\n\t\t\tprime[ ++ k ] = i;\n\t\t\tmu[ i ] = -1;\n\t\t}\n\t\tfor( int j = 1 ; j <= k && 1ll * i * prime[ j ] <= MAXN ; j ++ ) {\n\t\t\tvis[ i * prime[ j ] ] = 1;\n\t\t\tif( i % prime[ j ] == 0 ) break;\n\t\t\tmu[ i * prime[ j ] ] = -mu[ i ];\n\t\t}\n\t}\n\tfor( int i = 1 ; i <= n ; i ++ ) {\n\t\tf[ 0 ][ i ] = f[ 1 ][ i ] = f[ 2 ][ i ] = 0;\n\t\tfor( int j = i ; j <= n ; j += i ) {\n\t\t\tf[ 0 ][ i ] = ( f[ 0 ][ i ] + A / j ) % Mod;\n\t\t\tf[ 1 ][ i ] = ( f[ 1 ][ i ] + B / j ) % Mod;\n\t\t\tf[ 2 ][ i ] = ( f[ 2 ][ i ] + C / j ) % Mod; \n\t\t}\n\t}\n}\n\nint chk( long long x ) {\n\treturn ( x % Mod + Mod ) % Mod;\n}\nint Calc( int u , int v , int w ) {\n\treturn chk( 1ll * f[ 0 ][ u ] * f[ 1 ][ v ] % Mod * f[ 2 ][ w ] % Mod );\n}\nint Gcd( int a , int b ) {\n\treturn !b ? a : Gcd( b , a % b );\n}\nint Solve( ) {\n\tint Ans = 0;\n\t\n\tfor( int i = 1 ; i <= m ; i ++ )\n\t\tAns = ( Ans + chk( mu[ i ] * mu[ i ] * mu[ i ] * Calc( i , i , i ) ) ) % Mod;\n\t\n\tcnt = 0;\n\tfor( int i = 1 ; i <= n ; i ++ ) Deg[ i ] = 0; \n\tfor( int d = 1 ; d <= n ; d ++ )\n\t\tfor( int i = 1 ; i <= n / d ; i ++ )\n\t\t\tfor( int j = i + 1 ; j <= n / i / d ; j ++ ) {\n\t\t\t\tint u = i * d , v = j * d , l = i * j * d;\n\t\t\t\tif( Gcd( i , j ) != 1 || !mu[ u ] || !mu[ v ] ) continue;\n\t\t\t\tAns = ( Ans + chk( mu[ u ] * mu[ u ] * mu[ v ] * chk( 1ll * Calc( u , l , l ) + Calc( l , u , l ) + Calc( l , l , u ) ) ) ) % Mod;\n\t\t\t\tAns = ( Ans + chk( mu[ u ] * mu[ v ] * mu[ v ] * chk( 1ll * Calc( v , l , l ) + Calc( l , v , l ) + Calc( l , l , v ) ) ) ) % Mod;\n\t\t\t\tE[ ++ cnt ] = { u , v , l };\n\t\t\t}\n\t\n\tfor( int i = 1 ; i <= n ; i ++ ) Graph[ i ].clear( );\n\tfor( int i = cnt , u , v , w ; i >= 1 ; i -- ) {\n\t\tu = E[ i ].u , v = E[ i ].v , w = E[ i ].w;\n\t\tif( Deg[ u ] < Deg[ v ] || ( Deg[ u ] == Deg[ v ] && u < v ) )\n\t\t\tGraph[ u ].push_back( { v , w } );\n\t\telse\n\t\t\tGraph[ v ].push_back( { u , w } );\n\t}\n\tfor( int u = 0 ; u <= n ; u ++ ) {\n\t\tif( !mu[ u ] ) continue;\n\t\tfor( int i = 0 ; i < Graph[ u ].size( ) ; i ++ ) vt[ Graph[ u ][ i ].v ] = Graph[ u ][ i ].w;\n\t\tfor( int i = 0 ; i < Graph[ u ].size( ) ; i ++ ) {\n\t\t\tint v = Graph[ u ][ i ].v , uw = Graph[ u ][ i ].w;\n\t\t\tif( !mu[ v ] ) continue;\n\t\t\tfor( int j = 0 ; j < Graph[ v ].size( ) ; j ++ ) {\n\t\t\t\tint w = Graph[ v ][ j ].v , vw = Graph[ v ][ j ].w;\n\t\t\t\tif( !mu[ w ] ) continue;\n\t\t\t\tif( vt[ w ] ) {\n\t\t\t\t\tint ww = vt[ w ];\n\t\t\t\t\tAns = ( Ans + chk( mu[ u ] * mu[ v ] * mu[ w ] * chk( 1ll * Calc( uw , vw , ww ) + Calc( uw , ww , vw ) + Calc( vw , uw , ww ) + Calc( vw , ww , uw ) + Calc( ww , uw , vw ) + Calc( ww , vw , uw ) ) ) ) % Mod;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor( int i = 0 ; i < Graph[ u ].size( ) ; i ++ ) vt[ Graph[ u ][ i ].v ] = 0;\n\t}\n\treturn Ans;\n}\n\nint main( ) {\n\tscanf(\"%d\", &t );\n\twhile( t -- ) {\n\t\tscanf(\"%d %d %d\", &A , &B , &C );\n\t\tn = max( A , max( B , C ) );\n\t\tm = min( A , min( B , C ) );\n\t\tInit( );\n\t\tprintf(\"%d\\n\", Solve( ) );\t\t\t\n\t} \n\treturn 0;\n} \n```\n",
        "postTime": 1589537918,
        "uid": 123802,
        "name": "chihik",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4619 \u3010[SDOI2018]\u65e7\u8bd5\u9898\u3011"
    },
    {
        "content": "[[SDOI2018]\u65e7\u8bd5\u9898](https://www.luogu.com.cn/problem/P4619)\u89e3\u9898\u62a5\u544a\uff1a\n\n\u9898\u610f\uff1a\u6c42$\\sum_{i=1}^A\\sum_{j=1}^B\\sum_{k=1}^C d(i\\cdot j\\cdot k)\\bmod (10^9+7)$\u5176\u4e2d$d(x)=\\sum_{w\\mid x}1$\u5373$x$\u7684\u56e0\u6570\u4e2a\u6570\n\n\u505a\u8fd9\u9053\u9898\u524d\uff0c\u8bf7\u4fdd\u8bc1\u4f60\u5df2\u7ecf\u5b66\u4f1a\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5e76\u4e14\u505a\u51fa\u4e86\u4e00\u90e8\u5206\u9898\u76ee\uff0c\u5426\u5219\u53ef\u4ee5\u5230\u6211[\u535a\u73c2](https://zybuluo.com/xiaoziyao/note/1687939)\u91cc\u5eb7\u5eb7\u3002\n\n\u6211\u4eec\u5148\u8bc1\u660e\u4e00\u4e2a\u6bd2\u7624\u5f0f\u5b50$d(x\\cdot y\\cdot y)=\\sum_{i\\mid x}\\sum_{j\\mid y}\\sum_{k\\mid z}[\\gcd(i,j,k)==1]$\n\n\u5f53$x=\\prod_{i=1}^s p_i^{k_i}$\u56e0\u4e3a$d(x)=\\prod_{i=1}^s(k_i+1)$\u4e3a$x$\u7684\u56e0\u6570\u4e2a\u6570\uff0c\u56e0\u6b64\u8003\u8651\u5c06$x\\cdot y\\cdot z$\u7684\u6bcf\u4e2a\u56e0\u6570\u5bf9\u5e94\u4e00\u7ec4\u4e92\u8d28\u7684\u56e0\u6570\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u8d28\u6570$p\\mid x\\cdot y\\cdot z$\uff0c\u4e14$x$\u4e2d$p$\u7684\u5e42\u6b21\u4e3a$a$\uff0c$y$\u4e2d$p$\u7684\u5e42\u6b21\u4e3a$b$\uff0c$z$\u4e2d$p$\u7684\u5e42\u6b21\u4e3a$c$\uff0c\u5219$x\\cdot y\\cdot z$\u4e2d$p$\u7684\u5e42\u6b21\u4e3a$a+b+c$\u3002\n\n\u6839\u636e$d$\u7684\u79ef\u6027\u4e0e$\\gcd(p^{a+b+c},\\frac{x\\cdot y\\cdot z}{p^{a+b+c}})==1$\uff0c\u5f97\uff1a$d(x\\cdot y\\cdot z)=d(\\frac{x\\cdot y\\cdot z}{p^{a+b+c}})\\cdot d(p^{a+b+c})=d(\\frac{x\\cdot y\\cdot z}{p^{a+b+c}})\\cdot(a+b+c+1)$\uff0c\u5373$p$\u5bf9\u5de6\u5f0f\u7684\u8d21\u732e\u4e3a$a+b+c+1$\n\n\u4ee4$i\\mid x,j\\mid y,k\\mid z$\u4e14$\\gcd(i,j,k)=1$\uff0c\u5219$i$\u4e2d$p$\u7684\u5e42\u6b21$u$\u4e0d\u8d85\u8fc7$a$\uff0c$j$\u4e2d$p$\u7684\u5e42\u6b21$v$\u4e0d\u8d85\u8fc7$b$\uff0c$k$\u4e2d$p$\u7684\u5e42\u6b21$w$\u4e0d\u8d85\u8fc7$c$\uff0c\u4e14$u$\uff0c$v$\uff0c$w$\u4e2d\u8d77\u7801\u6709\u4e24\u4e2a\u4e3a$0$\n\n- \u5f53$v=w=0,u\\ne 0$\u65f6\uff0c$u=1,2,\\cdots a$\uff0c\u5373\u6709$a$\u79cd\u53d6\u503c\n- \u5f53$u=w=0,v\\ne 0$\u65f6\uff0c$v=1,2,\\cdots b$\uff0c\u5373\u6709$b$\u79cd\u53d6\u503c\n- \u5f53$u=v=0,w\\ne 0$\u65f6\uff0c$w=1,2,\\cdots c$\uff0c\u5373\u6709$c$\u79cd\u53d6\u503c\n- \u5f53$u=v=w=0$\u65f6\uff0c\u53ea\u6709$1$\u79cd\u53d6\u503c\n\n\u5373\u6bcf\u4e2a$p$\u53ef\u4ee5\u5bf9\u53f3\u5f0f\u540c\u6837\u4ea7\u751f$a+b+c+1$\u7684\u8d21\u732e\uff0c\u56e0\u6b64\u5bf9\u4e8e\u6bcf\u4e2a$x\\cdot y\\cdot z$\u7684\u8d28\u56e0\u5b50$p$\uff0c\u5176\u4f1a\u5bf9\u5de6\u53f3\u4e24\u5f0f\u5747\u4ea7\u751f$a+b+c+1$\u5373$p$\u7684\u6307\u6570$+1$\u7684\u8d21\u732e\n\n\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u628a\u539f\u5f0f\u5316\u4e3a\uff1a$\\sum_{i=1}\\sum_{j=1}^B\\sum_{k=1}^C\\sum_{x\\mid i}\\sum_{y\\mid j}\\sum_{z\\mid k}[\\gcd(x,y,z)==1]$\n$=\\sum_{i=1}\\sum_{j=1}^B\\sum_{k=1}^C\\sum_{x\\mid i}\\sum_{y\\mid j}\\sum_{z\\mid k}[\\gcd(x,y)==1][\\gcd(y,z)==1][\\gcd(x,z)==1]$\n\n\u6539\u53d8\u679a\u4e3e\u987a\u5e8f\u53ef\u5f97\uff1a$\\sum_{x=1}^A\\lfloor\\frac{A}{x}\\rfloor\\sum_{y=1}^B\\lfloor\\frac{B}{y}\\rfloor\\sum_{z=1}^C\\lfloor\\frac{C}{z}\\rfloor[\\gcd(x,y)==1][\\gcd(y,z)==1][\\gcd(x,z)==1]$\n\n\u4f7f\u7528\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5f97\u539f\u5f0f\u53ef\u5f97\uff1a$\\sum_{x=1}^A\\lfloor\\frac{A}{x}\\rfloor\\sum_{y=1}^B\\lfloor\\frac{B}{y}\\rfloor\\sum_{z=1}^C\\lfloor\\frac{C}{z}\\rfloor\\sum_{u\\mid\\gcd(x,y)}\\mu(u)\\sum_{v\\mid\\gcd(y,z)}\\mu(v)\\sum_{w\\mid\\gcd(x,z)}\\mu(w)$\n\n\u7ee7\u7eed\u4ea4\u6362\u679a\u4e3e\u987a\u5e8f\u5f97\uff1a$\\sum_{u=1}^{min(A,B)}\\mu(u)\\sum_{v=1}^{min(B,C)}\\mu(v)\\sum_{w=1}^{min(A,C)}\\mu(w)\\sum_{i=1}^{\\lfloor\\frac{A}{lcm(u,v)}\\rfloor}\\lfloor\\frac{A}{lcm(u,v)\\cdot i}\\rfloor\\sum_{j=1}^{\\lfloor\\frac{B}{lcm(v,w)}\\rfloor}\\lfloor\\frac{B}{lcm(v,w)\\cdot j}\\rfloor\\sum_{k=1}^{\\lfloor\\frac{C}{lcm(u,w)}\\rfloor}\\lfloor\\frac{C}{lcm(u,w)\\cdot k}\\rfloor$\n\n\u7531\u5f15\u7406$\\lfloor\\frac{a}{b\\cdot c}\\rfloor=\\lfloor\\frac{\\lfloor\\frac{a}{b}\\rfloor}{c}\\rfloor$\u5f97\uff1a$\\sum_{i=1}^{\\lfloor\\frac{x}{y}\\rfloor}\\lfloor\\frac{x}{y\\cdot i}\\rfloor=\\sum_{i=1}^{\\lfloor\\frac{x}{y}\\rfloor}\\lfloor\\frac{\\lfloor\\frac{x}{y}\\rfloor}{i}\\rfloor$\uff0c\u539f\u5f0f\u5316\u4e3a\uff1a$\\sum_{u=1}^{min(A,B)}\\mu(u)\\sum_{v=1}^{min(B,C)}\\mu(v)\\sum_{w=1}^{min(A,C)}\\mu(w)\\sum_{i=1}^{\\lfloor\\frac{A}{lcm(u,v)}\\rfloor}\\lfloor\\frac{\\lfloor\\frac{A}{lcm(u,v)}\\rfloor}{i}\\rfloor\\sum_{j=1}^{\\lfloor\\frac{B}{lcm(v,w)}\\rfloor}\\lfloor\\frac{\\lfloor\\frac{B}{lcm(v,w)}\\rfloor}{j}\\rfloor\\sum_{k=1}^{\\lfloor\\frac{C}{lcm(u,w)}\\rfloor}\\lfloor\\frac{\\lfloor\\frac{C}{lcm(u,w)}\\rfloor}{k}\\rfloor$\n\n\u8bbe$f(x)=\\sum_{i=1}^x\\lfloor\\frac{x}{i}\\rfloor$\uff0c\u8003\u8651\u5982\u4f55\u9884\u5904\u7406$f(x)$\uff1a\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$i\\leqslant x$\uff0c$x$\u90fd\u4f1a\u5f97\u5230$i$\u7684\u8d21\u732e$\\lfloor\\frac{x}{i}\\rfloor$\uff0c\u5373\u5728$[1,x]$\u7684\u8303\u56f4\u5185$i$\u7684\u500d\u6570\u4e2a\u6570\u3002\n\n\u56e0\u6b64$f(x)=\\sigma(x)=\\sum_{d\\mid x}d$\u5373\u7ea6\u6570\u548c\u51fd\u6570\uff0c\u8fd9\u4e2a\u51fd\u6570\u901a\u8fc7\u53ef\u4ee5\u679a\u4e3e\u6bcf\u4e2a\u6570\u7684\u500d\u6570\u5728$O(n\\log n)$\u7684\u65f6\u95f4\u5185\u9884\u5904\u7406\u3002\n\n\u539f\u5f0f\u53ef\u5316\u4e3a\uff1a$\\sum_{u=1}^{min(A,B)}\\sum_{v=1}^{min(B,C)}\\sum_{w=1}^{min(A,C)}\\mu(u)\\cdot\\mu(v)\\cdot\\mu(w)\\cdot\\sigma(\\frac{A}{lcm(u,v)})\\cdot\\sigma(\\frac{B}{lcm(v,w)})\\cdot\\sigma(\\frac{C}{lcm(u,w)})$\n\n\u4f46\u662f\u6700\u540e\u7684\u5f0f\u5b50\u8fd8\u662f$O(n^3)$\u7684\uff0c\u5c31\u6bd4\u66b4\u529b\u5feb\u4e00\u70b9\u70b9\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u6240\u6709$\\mu(x)=0$\u7684$x$\u5220\u53bb\uff0c\u8fd9\u79cd$x$\u6709\u4e0d\u5c11\uff0c\u56e0\u6b64\u53ef\u4ee5\u5feb\u5f88\u591a\u3002\n\n\u5176\u6b21\uff0c\u56e0\u4e3a$\\sigma(0)=0$\uff0c\u56e0\u6b64\u6240\u6709\u7684$lcm(u,v)>A,lcm(v,w)>B,lcm(u,w)>C$\u53ef\u4ee5\u526a\u6389\u3002\uff08\u5176\u5b9e\u4e0d\u526a\u6389\u4e5f\u6ca1\u6709\u5173\u7cfb\uff0c\u5bf9\u7b54\u6848\u6ca1\u6709\u5f71\u54cd\uff0c\u56e0\u6b64\u6211\u4eec\u5c06$A,B,C$\u7edf\u4e00\u6539\u4e3a$max(A,B,C)$\uff09\n\n\u4e3a\u4e86\u8fbe\u5230\u66f4\u4f4e\u7684\u590d\u6742\u5ea6\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e00\u79cd\u6bd2\u7624\u7b97\u6cd5\uff1a\u4e09\u5143\u73af\u8ba1\u6570\u3002\u611f\u6027\u7406\u89e3\u4e00\u4e0b\uff0c\u679a\u4e3e\u4e09\u4e2a\u6570$u,v,w$\uff0c\u4e14\u6ee1\u8db3$lcm(u,v)\\leqslant A,lcm(v,w)\\leqslant B,lcm(u,w)\\leqslant C$\u5c31\u76f8\u5f53\u4e8e\u5728\u4e00\u5f20\u53ea\u8981\u4efb\u610f\u4e24\u4e2a\u70b9\u6ee1\u8db3\u5176\u6700\u5c0f\u516c\u500d\u6570\u5c0f\u4e8e\u7b49\u4e8e$max(A,B,C)$\u8fb9\u4f1a\u6709\u4e00\u6761\u8fb9\u7684\u56fe\u4e2d\u679a\u4e3e\u4e09\u5143\u73af\u3002\n\n\u4e09\u5143\u73af\u8ba1\u6570\u7b97\u6cd5\u53ef\u4ee5\u5728$O(m\\sqrt{m})$\u7684\u65f6\u95f4\u5185\u6c42\u51fa\u6240\u6709\u4e09\u5143\u73af\uff0c\u5177\u4f53\u89c1nekko\u7684\u535a\u5ba2\uff1a[\u4e0d\u5e38\u7528\u7684\u9ed1\u79d1\u6280\u2014\u2014\u300c\u4e09\u5143\u73af\u300d](https://www.luogu.com.cn/blog/KingSann/fou-chang-yong-di-hei-ke-ji-san-yuan-huan-post)\n\n\u4f46\u662f\u8fd8\u662f\u4f1aTLE\uff0c\u56e0\u6b64\u6211\u4eec\u8981\u8fdb\u884c\u5e38\u6570\u4f18\u5316\uff1a\n\n\u53bb\u9664\u6240\u6709\u7684\u81ea\u73af\uff0c\u679a\u4e3e\u4e09\u4e2a\u70b9\u76f8\u540c\u548c\u4e24\u4e2a\u70b9\u76f8\u540c\u7684\u60c5\u51b5\uff0c\u5e76\u7528$6$\u79cd\u6392\u5217\u8ba1\u7b97\u4e09\u4e2a\u70b9\u90fd\u4e0d\u76f8\u540c\u7684\u60c5\u51b5\u3002\n\n\u6539\u94fe\u5f0f\u524d\u5411\u661f\u53d8vector\uff0c\u56e0\u4e3avector\u7684\u5185\u5b58\u8bbf\u95ee\u662f\u8fde\u7eed\u7684\uff0c\u56e0\u6b64\u53ef\u4ee5\u52a0\u5feb\u4e00\u70b9\u901f\u5ea6\u3002\n\n~~\u5feb\u8bfb\uff0cO2\u4f18\u5316\u548c\u706b\u8f66\u5934\u4f18\u5316~~\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u62ff\u5230$100pts$\u7684\u597d\u6210\u7ee9\uff01\n\n\u53c8\u81ed\u53c8\u957f\u7684\u4ee3\u7801\uff1a\n```\n#include<stdio.h>\n#include<vector>\n#include<string.h>\nusing namespace std;\nconst long long maxn=1000005,maxm=1000005,mod=1000000007;\nlong long i,j,k,a,b,c,e,mx,mn,T,cnt,tot,ans;\nlong long lst[maxn],d[maxn],p[maxn],mu[maxn],ok[maxn],ord[maxn],deg[maxn],f[maxn],from[maxm],to[maxm],lcm[maxm],mrk[maxn];\nvector<long long>v[maxn],w[maxn];\ninline long long min(long long a,long long b){\n\treturn a<b? a:b;\n}\ninline long long max(long long a,long long b){\n\treturn a>b? a:b;\n}\ninline long long gcd(long long a,long long b){\n\treturn b==0? a:gcd(b,a%b);\n}\nint main(){\n\tp[1]=mu[1]=1;\n\tfor(i=2;i<maxn;i++){\n\t\tif(p[i]==0)\n\t\t\tlst[++cnt]=i,mu[i]=-1;\n\t\tfor(j=1;j<=cnt;j++){\n\t\t\tif(i*lst[j]>=maxn)\n\t\t\t\tbreak;\n\t\t\tp[i*lst[j]]=1;\n\t\t\tif(i%lst[j]==0){\n\t\t\t\tmu[i*lst[j]]=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmu[i*lst[j]]=-mu[i];\n\t\t}\n\t}\n\tfor(i=1;i<maxn;i++)\n\t\tif(mu[i]!=0)\n\t\t\tok[++tot]=i,ord[i]=tot;\n\tfor(i=1;i<maxn;i++){\n\t\tfor(j=1;i*j<maxn;j++)\n\t\t\td[i*j]++;\n\t\tf[i]=(f[i-1]+d[i])%mod;\n\t}\n\tscanf(\"%lld\",&T);\n\twhile(T--){\n\t\tmemset(deg,0,sizeof(deg));\n\t\tmemset(v,0,sizeof(v));\n\t\tmemset(w,0,sizeof(w));\n\t\tscanf(\"%lld%lld%lld\",&a,&b,&c);\n\t\tmn=min(min(a,b),c),mx=max(max(a,b),c);\n\t\te=ans=0;\n\t\tfor(i=1;i<=tot;i++){\n\t\t\tif(ok[i]>mx)\n\t\t\t\tbreak;\n\t\t\tfor(j=1;j<=tot;j++){\n\t\t\t\tif(ok[i]*ok[j]>mx)\n\t\t\t\t\tbreak;\n\t\t\t\tif(mu[ok[i]*ok[j]]==0)\n\t\t\t\t\tcontinue;\n\t\t\t\tfor(k=j+1;k<=tot;k++){\n\t\t\t\t\tif(ok[i]*ok[j]*ok[k]>mx)\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tif(mu[ok[i]*ok[k]]==0||gcd(ok[j],ok[k])>1)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tfrom[++e]=ord[ok[i]*ok[j]],to[e]=ord[ok[i]*ok[k]],lcm[e]=ok[i]*ok[j]*ok[k];\n\t\t\t\t\tdeg[from[e]]++,deg[to[e]]++;\n\t\t\t\t} \n\t\t\t}\n\t\t}\n\t\tfor(i=1;i<=tot;i++){\n\t\t\tif(ok[i]>mn)\n\t\t\t\tbreak;\n\t\t\tans+=mu[ok[i]]*mu[ok[i]]*mu[ok[i]]*f[a/ok[i]]*f[b/ok[i]]*f[c/ok[i]];\n\t\t}\n\t\tfor(i=1;i<=e;i++){\n\t\t\tv[from[i]].push_back(to[i]),w[from[i]].push_back(lcm[i]);\n\t\t\tv[to[i]].push_back(from[i]),w[to[i]].push_back(lcm[i]);\n\t\t}\n\t\tfor(i=1;i<=tot;i++){\n\t\t\tif(ok[i]>min(a,b))\n\t\t\t\tbreak;\n\t\t\tfor(j=0;j<v[i].size();j++){\n\t\t\t\tlong long x=ok[i],y=ok[v[i][j]],z=w[i][j];\n\t\t\t\tans=(ans+mu[x]*mu[y]*mu[y]*f[a/z]*f[b/z]*f[c/y]%mod+mod)%mod;\n\t\t\t\tans=(ans+mu[x]*mu[x]*mu[y]*f[a/x]*f[b/z]*f[c/z]%mod+mod)%mod;\n\t\t\t\tans=(ans+mu[x]*mu[x]*mu[y]*f[a/z]*f[b/x]*f[c/z]%mod+mod)%mod;\n\t\t\t}\n\t\t}\n\t\tmemset(v,0,sizeof(v));\n\t\tmemset(w,0,sizeof(w));\n\t\tfor(i=1;i<=e;i++){\n\t\t\tif(deg[from[i]]>=deg[to[i]])\n\t\t\t\tv[from[i]].push_back(to[i]),w[from[i]].push_back(lcm[i]);\n\t\t\telse v[to[i]].push_back(from[i]),w[to[i]].push_back(lcm[i]);\n\t\t}\n\t\tfor(i=1;i<=tot;i++){\n\t\t\tif(ok[i]>mx)\n\t\t\t\tbreak;\n\t\t\tfor(j=0;j<v[i].size();j++)\n\t\t\t\tmrk[v[i][j]]=w[i][j];\n\t\t\tfor(j=0;j<v[i].size();j++){\n\t\t\t\tlong long x=v[i][j];\n\t\t\t\tfor(k=0;k<v[x].size();k++){\n\t\t\t\t\tlong long y=v[x][k],p=mrk[y],q=w[i][j],r=w[x][k];\n\t\t\t\t\tif(mrk[y]==0)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tlong long st1,st2,st3,st4,st5,st6;\n\t\t\t\t\tst1=f[a/p]*f[b/q]*f[c/r]%mod;\n\t\t\t\t\tst2=f[a/p]*f[b/r]*f[c/q]%mod;\n\t\t\t\t\tst3=f[a/q]*f[b/p]*f[c/r]%mod;\n\t\t\t\t\tst4=f[a/q]*f[b/r]*f[c/p]%mod;\n\t\t\t\t\tst5=f[a/r]*f[b/p]*f[c/q]%mod;\n\t\t\t\t\tst6=f[a/r]*f[b/q]*f[c/p]%mod;\n\t\t\t\t\tans=(ans+mu[ok[i]]*mu[ok[x]]*mu[ok[y]]*(st1+st2+st3+st4+st5+st6)%mod+mod)%mod;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(j=0;j<v[i].size();j++)\n\t\t\t\tmrk[v[i][j]]=0;\n\t\t}\n\t\tprintf(\"%lld\\n\",(ans+mod)%mod);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1587278942,
        "uid": 35754,
        "name": "Verdandi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4619 \u3010[SDOI2018]\u65e7\u8bd5\u9898\u3011"
    }
]
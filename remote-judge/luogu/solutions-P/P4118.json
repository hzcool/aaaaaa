[
    {
        "content": "update\uff1a\u770b\u8fd9\u4e2a\u9898\u597d\u50cf\u4e0d\u548b\u6362\u6570\u636e\u4e86\u4e8e\u662f\u786e\u8ba4\u4ee3\u7801\u80fd\u8fc7\u4e4b\u540e\u518d\u6700\u540e\u6539\u4e00\u904d\u3002\u3002\u3002\u3002\n\n\u76ee\u524d\u770b\u6765\u6700\u5927\u70b9\u662f #21 1.16s\u3002\n\n\u522b\u518d\u6539\u6570\u636e\u4e86\u5427\uff0c\u8fd9\u4ee3\u7801\u6211\u5b9e\u5728\u4e0d\u60f3\u518d\u5361\u5e38\u4e86/dk\uff0c\u8fd9\u9898\u89e3\u6211\u4e5f\u4e0d\u60f3\u518d\u66f4\u65b0\u4e86/dk\n\n---\n\n> \u5728\u592a\u9633\u897f\u659c\u7684\u8fd9\u4e2a\u4e16\u754c\u91cc\uff0c\u7f6e\u8eab\u5929\u4e0a\u4e4b\u68ee\u3002\u7b49\u8fd9\u573a\u6218\u4e89\u7ed3\u675f\u4e4b\u540e\uff0c\u4e0d\u5f52\u4e4b\u4eba\u4e0e\u671b\u773c\u6b32\u7a7f\u7684\u4f17\u4eba\uff0c \u4eba\u4eba\u672c\u7740\u6b63\u4e49\u4e4b\u540d\uff0c\u957f\u5b58\u4e0d\u706d\u7684\u8fc7\u53bb\u3001\u9010\u6e10\u6d88\u901d\u7684\u672a\u6765\u3002\u6211\u56de\u6765\u4e86\uff0c\u7eb5\u4f7f\u65e5\u8584\u897f\u5c71\uff0c\u5373\u4fbf\u770b\u4e0d\u5230\u672a\u6765\uff0c\u6b64\u65f6\u6b64\u523b\u7684\u5149\u8f89\uff0c\u76fc\u541b\u52ff\u5fd8\u3002\u2014\u2014\u2014\u2014\u4e16\u754c\u4e0a\u6700\u5e78\u798f\u7684\u5973\u5b69\n\n\u73c2\u6735\u8389\u8981\u4e00\u76f4\u5e78\u798f\u4e0b\u53bb\u54e6~\n\n~~\u4ee3\u7801\u957f\u8fbe 12K\uff0c\u559c\u63d0\u6700\u957f\u89e3\u3002wtcl~~\n\n~~\u5e0c\u671b\u8fd9\u9053\u9898\u4e0d\u4f1a\u8ba9\u5404\u4f4d\u5bf9\u73c2\u5b66\u7684\u70ed\u7231\u4e27\u5931\u6b86\u5c3d\u3002~~\n\n---\n\n~~\u81ed\u540d\u662d\u8457\u7684\u7814\u7a76\u73c2\u5b66\u7684\u6700\u4f73\u65b9\u5f0f~~ \u4e3e\u4e16\u95fb\u540d\u7684\u300c\u6df1\u6f5c\u5faa\u85cf\u7b2c\u516d\u5206\u5757\u300d\u3002\n\n## $0$ \u524d\u7f6e\u77e5\u8bc6\n\n1.  SPOJ GSS \u7cfb\u5217\n\t- \u6700\u5927\u5b50\u6bb5\u548c\u7684\u505a\u6cd5\uff0c\u5199\u4e86\u4f60\u5c31\u77e5\u9053\u662f\u5565\u4e86\u3002\n2.  \u51f8\u5305\u3001\u95f5\u53ef\u592b\u65af\u57fa\u548c\u3001Jarvis\n\t- \u4e0d\u4f1a\u7684\u8bdd\u53ef\u4ee5\u53bb\u770b\u4e00\u4e0b\u4e8c\u7ef4\u51f8\u5305\u6a21\u677f\u91cc\u9762 ShineEternal \u795e\u4ed9\u7684\u9898\u89e3\u3002\n3.  \u7ebf\u6bb5\u6811\u3001\u5206\u5757\n\t- \u5982\u679c\u8fd9\u4e2a\u8fd8\u4e0d\u4f1a\u90a3\u5c31\u4e0d\u8981\u505a Ynoi \u4e86\u5427\n4.  \u57fa\u6570\u6392\u5e8f\n\t- \u8fd9\u4e2a\u5728 v5 \u91cc\u9762\u4e0d\u9700\u8981\uff0c\u4f46\u662f\u73b0\u5728\u8fd9\u9898\u662f v6\uff0c\u6240\u4ee5\u4e00\u4e2a\u9ad8\u901f\u7684\u57fa\u6570\u6392\u5e8f\u662f\u5f88\u91cd\u8981\u7684~\n\n\u597d\u4e86\uff0c\u786e\u8ba4\u4f60\u90fd\u4f1a\u4e86\uff1f\n\nThen~start!\n\n## $1$ \u5f31\u5316\n\n\u5982\u679c\u95ee\u9898\u5f31\u5316\u4e3a\u5168\u5c40\u52a0\u533a\u95f4\u6700\u5927\u5b50\u6bb5\u548c\uff0c\u8fd9\u9053\u9898\u600e\u4e48\u505a\uff1f\n\n\u5982\u679c\u4e0d\u5e26\u4fee\uff0c\u90a3\u4e48\u5c31\u662f\u4e00\u4e2a\u7ecf\u5178\u95ee\u9898\uff0c\u53ef\u4ee5\u7ef4\u62a4\u4e00\u68f5\u7ebf\u6bb5\u6811\uff0c\u6bcf\u4e00\u4e2a\u8282\u70b9\u4e0a\u9762\u7ef4\u62a4\u533a\u95f4\u548c\u3001\u533a\u95f4\u6700\u5927\u540e\u7f00\u548c\u3001\u533a\u95f4\u6700\u5927\u524d\u7f00\u548c\u3001\u533a\u95f4\u6700\u5927\u5b50\u6bb5\u548c\uff0c\u5408\u5e76\u7684\u65f6\u5019\u76f4\u63a5\u5206\u7c7b\u8ba8\u8bba\u5373\u53ef\u3002\n\n\u7136\u540e\u5982\u679c\u52a0\u4e0a\u5168\u5c40\u52a0\uff0c\u6211\u4eec\u8fd8\u662f\u8003\u8651\u5982\u4f55\u7ef4\u62a4\u4e0a\u9762\u7684\u56db\u4e2a\u4fe1\u606f\u3002\n\n\u9996\u5148\u533a\u95f4\u548c\u76f4\u63a5\u505a\u5c31\u53ef\u4ee5\u3002\n\n\u533a\u95f4\u524d\u7f00\u548c\u53ef\u4ee5\u7ef4\u62a4\u4e00\u4e2a\u51f8\u51fd\u6570 $f(x)$ \u8868\u793a\u957f\u5ea6\u4e3a $x$ \u7684\u524d\u7f00\u548c\u3002\n\n\u540e\u7f00\u548c\u540c\u7406\uff0c\u8bb0\u8fd9\u4e2a\u51fd\u6570\u4e3a $g(x)$\u3002\n\n\u5168\u5c40\u52a0 $d$ \u7136\u540e\u63d0\u53d6\u6700\u5927\u7684\u65f6\u5019\u662f\u6700\u5927\u5316 $f(x)+dx$\uff08$g(x)+dx$\uff09\uff0c\u663e\u7136\u53ef\u4ee5\u51f8\u5305\u4e8c\u5206\u3002\n\n\u7136\u540e\u6211\u4eec\u53bb\u8003\u8651\u5982\u4f55\u6c42\u533a\u95f4\u6700\u5927\u5b50\u6bb5\u548c\u3002\n\n\u8fd8\u662f\u7ef4\u62a4\u51f8\u5305\u7684\u601d\u8def\uff0c\u7ef4\u62a4\u4e00\u4e2a\u51f8\u51fd\u6570 $h(x)$\uff0c\u8868\u793a\u957f\u5ea6\u6070\u597d\u4e3a $x$ \u7684\u5b50\u6bb5\u548c\u6700\u5927\u4e3a\u591a\u5c11\u3002\n\n\u7136\u800c\u8fd9\u4e2a\u4e1c\u897f\u662f\u6ca1\u6cd5\u76f4\u63a5\u6c42\u7684\u2026\u2026\n\n\u6362\u4e00\u4e2a\u601d\u8def\uff0c\u6211\u4eec\u53d6\u5728\u7ebf\u6bb5\u6811\u4e0a\u4e24\u4e2a\u5b50\u8282\u70b9\u7684 $g_L(x)$ \u548c $f_R(y)$\uff0c\u7136\u540e\u6709\u5173\u7cfb\u5f0f $h(x+y)=g_L(x)+f_R(y)$\u3002\n\n\u6240\u4ee5\u8fd9\u4e2a $h$ \u5b9e\u9645\u4e0a\u5c31\u662f $g_L$ \u548c $f_R$ \u7684\u95f5\u53ef\u592b\u65af\u57fa\u548c\u518d\u5bf9 $h_L$ \u548c $h_R$ \u53d6 $\\max$\u3002\n\n\u53c8\u56e0\u4e3a\u6211\u4eec\u7684 $x$ \u662f\u533a\u95f4\u957f\u5ea6\uff0c\u5373\u5b9a\u4e49\u57df\u5927\u5c0f\u662f\u7ebf\u6027\u7684\uff0c\u90a3\u4e48\u51f8\u5305\u957f\u5ea6\u5c31\u4e5f\u662f\u7ebf\u6027\u7684\u3002\n\n\u6240\u4ee5\u6211\u4eec\u5bf9\u4e8e\u4e00\u4e2a\u5927\u5c0f\u4e3a $s$ \u7684\u8282\u70b9\u53ef\u4ee5 $O(s)$ \u6c42\u51fa\u8fd9\u4e2a\u70b9\u4e0a\u9762\u7684\u6240\u6709\u51f8\u5305\u3002\n\n\u65e2\u7136\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5 $O(n\\log n)$ \u5efa\u51fa\u7ebf\u6bb5\u6811\u3002\n\n\u63d0\u53d6\u7b54\u6848\u7684\u65f6\u5019\uff0c\u6bcf\u4e00\u4e2a\u8282\u70b9\u51f8\u5305\u4e8c\u5206\uff0c\u5171 $\\log n$ \u4e2a\u8282\u70b9\uff0c\u6545\u6bcf\u6b21\u8be2\u95ee\u7684\u590d\u6742\u5ea6\u4e3a $O(\\log^2 n)$\u3002\n\n**\u6ce8\u610f\uff1aP5073 \u7684\u89e3\u6cd5\u4e0e\u6b64\u7a0d\u6709\u4e0d\u540c\uff0c\u56e0\u4e3a P5073 \u53ef\u4ee5\u4e5f\u9700\u8981\u901a\u8fc7\u79bb\u7ebf\u8f6c\u6362\u4e3a\u53ea\u52a0\u6b63\u6570\u4ece\u800c\u8fbe\u5230\u5747\u644a\u5355\u6b21\u8be2\u95ee $O(\\log n)$\uff0c\u4f46\u662f\u8fd9\u9898\u5e76\u4e0d\u5b8c\u5168\u9700\u8981\uff0c\u540e\u9762\u4f1a\u8bb2\u5230\u3002**\n\n\u6211\u5c31\u662f\u56e0\u4e3a\u53d7 P5073 \u7684\u601d\u8def\u5236\u7ea6\u5bfc\u81f4\u5728\u8fd9\u9898\u4e0a\u9762\u5361\u4e86\u597d\u51e0\u5929\u2026\u2026\n\n## $2$ \u672c\u9898\u9ad8\u590d\u6742\u5ea6\u89e3\u6cd5\n\n\u6211\u4eec\u5bf9\u8fd9\u4e2a\u5e8f\u5217\u5206\u5757\uff0c\u5728\u6bcf\u4e00\u5757\u4e0a\u9762\u5efa $1$ \u4e2d\u6240\u8bf4\u7684\u7ebf\u6bb5\u6811\uff0c\u6bcf\u6b21\u6574\u4f53\u4fee\u6539\u53ef\u4ee5\u76f4\u63a5\u505a\uff0c\u96f6\u6563\u4fee\u6539\u91cd\u6784\u7ebf\u6bb5\u6811\uff0c\u6574\u4f53\u67e5\u8be2\u548c\u96f6\u6563\u67e5\u8be2\u90fd\u67e5\u8be2\u7ebf\u6bb5\u6811\u3002\n\n\u8fd9\u6837\u5982\u679c\u5757\u957f\u4e3a $s$\uff0c\u6574\u4f53\u4fee\u6539 $O(1)$\uff0c\u96f6\u6563\u4fee\u6539 $O(s\\log s)$\uff0c\u6574\u4f53\u67e5\u8be2 $O(\\log s)$\uff0c\u96f6\u6563\u67e5\u8be2 $O(\\log^2 s)$\uff0c\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u590d\u6742\u5ea6\u4e3a $O(n\\sqrt n\\log n)$ \u7684\u89e3\u6cd5\u3002\n\n\u7075\u9b42\u62f7\u95ee\uff1a\u80fd \u8fc7 \u5417\uff1f\n\n\u663e\u7136\u662f\u4e0d\u80fd\u7684\u3002\n\n\u4e8e\u662f\u5c31\u6709\u4e86\u2014\u2014\n\n## $3$ \u672c\u9898\u4f4e\u590d\u6742\u5ea6\u89e3\u6cd5\n\n\u6211\u4eec\u53d1\u73b0\u590d\u6742\u5ea6\u6709\u4e24\u4e2a\u74f6\u9888\uff1a\u4e00\u662f\u96f6\u6563\u4fee\u6539\uff0c\u4e8c\u662f\u6574\u4f53\u67e5\u8be2\u3002\u5206\u5f00\u8ba8\u8bba\u600e\u4e48\u4f18\u5316\u3002\n\n### $3.1$ \u96f6\u6563\u4fee\u6539\u4f18\u5316\n\n\u771f\u7684\u6709\u5fc5\u8981\u91cd\u6784\u6574\u68f5\u7ebf\u6bb5\u6811\u5417\uff1f\n\n\u4e0d\u8981\u5fd8\u4e86\uff1a\n\n1. \u7ebf\u6bb5\u6811\u7684\u5b50\u6811\u8fd8\u662f\u7ebf\u6bb5\u6811\n2. \u8fd9\u91cc\u7684\u7ebf\u6bb5\u6811\u652f\u6301\u6574\u4f53\u52a0\uff0c\u4e0d\u652f\u6301\u533a\u95f4\u52a0\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5728\u96f6\u6563\u4fee\u6539\u7684\u65f6\u5019\u5728\u7ec8\u6b62\u8282\u70b9\u4e0a\u9762\u6253\u6807\u8bb0\uff0c\u975e\u7ec8\u6b62\u8282\u70b9\u7ebf\u6027\u91cd\u6784\u3002\n\n\u5bf9\u4e8e\u6807\u8bb0\u7684\u4e0b\u653e\uff0c\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u5904\u7406\uff1a\u6211\u4eec\u5728\u7ebf\u6bb5\u6811\u4e0a\u641e\u4e00\u4e2a\u8282\u70b9\u6574\u4f53\u52a0\u7684\u6807\u8bb0\uff0c\u8fd9\u4e2a\u662f\u6b63\u5e38\u4e0b\u653e\u7684\uff1b\u7136\u540e\u518d\u5728\u51f8\u5305\u4e0a\u9762\u7ef4\u62a4\u4e00\u4e2a\u51f8\u5305\u6574\u4f53\u52a0\u7684\u6807\u8bb0\uff0c\u8fd9\u4e2a\u6807\u8bb0\u662f\u53ea\u53e0\u52a0\u4e0d\u4e0b\u653e\u7684\u3002\u53d6\u51f8\u5305\u5185\u8282\u70b9\u7684\u65f6\u5019\u8003\u8651\u53e0\u52a0\u7684\u6b63\u6bd4\u4f8b\u51fd\u6570\u5bf9\u70b9\u7684\u4f4d\u7f6e\u7684\u5f71\u54cd\u5373\u53ef\u3002\n\n\u56e0\u4e3a\u6bcf\u4e00\u5c42\u975e\u7ec8\u6b62\u8282\u70b9\u7684\u6570\u91cf\u662f $O(1)$ \u7684\uff0c\u6240\u4ee5\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u4e00\u4e0b\u96f6\u6563\u4fee\u6539\u5c31\u53d8\u6210 $O(s)$ \u7684\u4e86\uff0c\u4f46\u662f\u5e38\u6570\u6bd4\u8f83\u5927\u3002\n\n\u4f60\u53ef\u80fd\u4f1a\u95ee\uff0c\u8fd9\u91cc\u7684\u7ebf\u6bb5\u6811\u4e0d\u662f\u53ea\u652f\u6301\u52a0\u6b63\u6570\u7684\u5417\uff1f\u5982\u679c\u52a0\u8d1f\u6570\u600e\u4e48\u505a\u5462\uff1f\n\n\u4e8b\u5b9e\u662f\uff1a**\u8fd9\u4e2a\u7ebf\u6bb5\u6811\u652f\u6301\u52a0\u8d1f\u6570\u3002** \u56e0\u4e3a P5073 \u9650\u5236\u4e86\u6211\u4eec\u7684\u590d\u6742\u5ea6\u5230 $O(\\log n)$\uff0c**\u800c\u8fd9\u9898\u5e76\u6ca1\u6709\u3002** \u6240\u4ee5\u91c7\u7528\u4e8c\u5206\u7684\u65b9\u5f0f\u63d0\u53d6\u7b54\u6848\uff0c\u662f\u53ef\u4ee5\u652f\u6301\u52a0\u8d1f\u6570\u7684\u3002\n\n\u6240\u4ee5\u96f6\u6563\u4fee\u6539\u7684\u590d\u6742\u5ea6\u5c31\u4e0b\u964d\u5230\u4e86\u7ebf\u6027\u3002\n\n### $3.2$ \u6574\u4f53\u67e5\u8be2\u4f18\u5316\n\n\u9996\u5148\u6211\u4eec\u5f15\u5165\u4e00\u4e2a\u79d1\u6280\uff1a\u9010\u5757\u5904\u7406\u3002\n\n\u8fd9\u4e2a\u79d1\u6280\u9002\u7528\u4e8e\u4fee\u6539\u548c\u67e5\u8be2\u90fd\u6309\u5757\u72ec\u7acb\u4e14\u5141\u8bb8\u79bb\u7ebf\u7684\u95ee\u9898\u3002\n\n\u5bf9\u4e8e\u8fd9\u4e2a\u95ee\u9898\uff0c\u533a\u95f4\u52a0\u80af\u5b9a\u662f\u6309\u5757\u72ec\u7acb\u7684\u6ca1\u8bdd\u8bf4\uff0c\u6700\u5927\u5b50\u6bb5\u548c\u6211\u4eec\u4e5f\u6709\u529e\u6cd5\u5feb\u901f\u5408\u5e76\uff0c\u6240\u4ee5\u5c31\u53ef\u4ee5\u9010\u5757\u5904\u7406\u3002\n\n\u800c\u9010\u5757\u5904\u7406\u5c31\u662f\u79bb\u7ebf\u6bcf\u4e00\u4e2a\u8f93\u5165\u7684\u64cd\u4f5c\u5bf9\u8fd9\u4e2a\u5757\u7684\u64cd\u4f5c\uff0c\u7136\u540e\u4f9d\u6b21\u7b97\u4e00\u904d\u7b2c\u4e00\u5757\u7684\u6240\u6709\u64cd\u4f5c\uff0c\u7b97\u4e00\u904d\u7b2c\u4e8c\u5757\u7684\u6240\u6709\u64cd\u4f5c\u2026\u2026\n\n\u8fd9\u6837\u7684\u597d\u5904\u5728\u4e8e\uff0c\u5982\u679c\u6211\u4eec\u7684\u7b2c $i$ \u6b21\u64cd\u4f5c\u548c\u7b2c $j$ \u6b21\u64cd\u4f5c\u4fee\u6539\u4e86\u8fd9\u4e2a\u5757 $(i<j)$\uff0c\u90a3\u4e48\u6b64\u65f6\u8fd9\u4e24\u4e2a\u64cd\u4f5c\u4e4b\u95f4\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u53ef\u4ee5 **\u968f\u610f\u6539\u53d8\u987a\u5e8f**\uff0c\u800c\u4f20\u7edf\u5206\u5757\u662f\u505a\u4e0d\u5230\u8fd9\u4e00\u70b9\u7684\u3002\n\n---\n\n\u73b0\u5728\u6765\u770b\u5982\u4f55\u4f7f\u7528\u8fd9\u4e2a\u79d1\u6280\u89e3\u51b3\u8fd9\u9898\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u6574\u4f53\u67e5\u8be2\u4e00\u5b9a\u662f\u63d0\u53d6\u7ebf\u6bb5\u6811\u6839\u4e0a\u9762\u90a3\u4e2a\u51f8\u5305\uff0c\u800c\u56e0\u4e3a\u6574\u4f53\u4fee\u6539\u662f\u7528\u4e00\u4e2a\u5168\u5c40 tag \u4fdd\u5b58\uff0c\u6240\u4ee5 **\u6839\u4e0a\u4e00\u5b9a\u662f\u6ca1\u6709\u6807\u8bb0\u7684**\u3002\n\n\u65e2\u7136\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u6240\u6709\u67e5\u8be2\u6309\u7167\u67e5\u8be2\u65f6\u6574\u4f53\u52a0 tag \u7684\u503c\u5347\u5e8f\u6392\u5e8f\uff0c\u7136\u540e\u8f6c\u6362\u6210\u6574\u4f53\u52a0\u53ea\u52a0\u6b63\u6570\u3002\uff08\u8fd9\u91cc\u5c31\u662f\u9010\u5757\u5904\u7406\u7684\u5e94\u7528\u2014\u2014\u6539\u53d8\u8be2\u95ee\u987a\u5e8f\u3002\uff09\n\n\u8fd9\u6837\u5728\u6839\u4e0a\u9762\u63d0\u53d6\u7b54\u6848\u7684\u65f6\u5019\u53ef\u4ee5\u7c7b\u4f3c P5073 \u90a3\u6837\u641e\u4e2a\u6307\u9488\u5f80\u53f3\u722c\uff0c\u4ece\u800c $O(s)$ \u5904\u7406\u6240\u6709\u8be2\u95ee\u3002\u96f6\u6563\u4fee\u6539\u91cd\u6784\u51f8\u5305\u7684\u65f6\u5019\uff0c\u76f4\u63a5\u628a\u6307\u9488\u91cd\u7f6e\u4e3a $0$ \u5373\u53ef\u3002\n\n\u8fd9\u6837\u5904\u7406\u8be2\u95ee\u7684\u590d\u6742\u5ea6\u5c31\u662f $O(ms)$\u3002\n\n\u8bc1\u660e\uff1a\n\n\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u5757\u7684\u52bf\u80fd $E$ \u4e3a\u6839\u4e0a\u9762\u7684\u6307\u9488\u8ddd\u79bb\u5757\u53f3\u7aef\u70b9\u7684\u8ddd\u79bb\u3002\n\n\u90a3\u4e48\u663e\u7136\u521d\u59cb\u7684\u52bf\u80fd $\\sum E=O(n)$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u6bcf\u6b21\u96f6\u6563\u64cd\u4f5c\u4f1a\u628a\u6307\u9488\u7f6e\u56de $0$\uff0c\u5bfc\u81f4\u589e\u52a0 $O(s)$ \u7684\u52bf\u80fd\u3002\n\n\u800c\u6bcf\u4e00\u6b21\u64cd\u4f5c\u53ea\u4f1a\u5bfc\u81f4 $O(1)$ \u4e2a\u5757\u88ab\u96f6\u6563\u64cd\u4f5c\u3002\n\n\u6545\u603b\u96f6\u6563\u64cd\u4f5c\u7684\u6570\u91cf\u662f $O(m)$ \u91cf\u7ea7\u7684\u3002\n\n\u6240\u4ee5\u603b\u52bf\u80fd\u662f $O(ms)$ \u7684\u3002\n\n\u53c8\u56e0\u4e3a\u6bcf\u6b21\u722c\u6307\u9488\u7684\u65f6\u5019\u662f $O(1)$ \u65f6\u95f4\u51cf\u5c11 $O(1)$ \u52bf\u80fd\uff0c\u6545\u603b\u65f6\u95f4\u6700\u5927\u4e3a $O(ms)$\u3002\n\nQ.E.D.\n\n---\n\n\u4f46\u662f\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u6392\u5e8f\u7684\u590d\u6742\u5ea6\u4ecd\u7136\u662f $O(ms\\log m)$\u3002\n\n\u6240\u4ee5\u6362\u6210\u57fa\u6570\u6392\u5e8f\uff0c\u8fd9\u6837\u5c31\u5b9e\u5b9e\u5728\u5728\u5730\u4f18\u5316\u5230 $O(ms)$ \u4e86\u3002\n\n\u90a3\u4e48\uff0c\u73b0\u5728\u5f97\u5230\u4e86\u4e00\u4e2a\u96f6\u6563\u4fee\u6539 $O(s)$\uff0c\u96f6\u6563\u67e5\u8be2 $O(\\log^2s)$\uff08\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u7528\u66b4\u529b\u626b\u7684\u65b9\u5f0f\u6765 $O(s)$\uff0c\u4e0d\u8fc7\u6211\u89c9\u5f97\u8fd9\u6837\u6bd4\u8f83\u65b9\u4fbf\uff09\uff0c\u6574\u4f53\u4fee\u6539 $O(1)$\uff0c\u6574\u4f53\u67e5\u8be2\u5747\u644a $O(1)$\uff08\u56e0\u4e3a\u662f $O(ms)$ \u65f6\u95f4\uff0c $O(ms)$ \u6b21\u67e5\u8be2\uff09\u7684\u7b97\u6cd5\u3002\n\n\u53d6 $s=\\sqrt n$\uff0c\u5f97\u6b64\u65f6\u7b97\u6cd5\u7684\u590d\u6742\u5ea6\u4e3a $O(m\\sqrt n)$\u3002\n\n~~\u829c\u6e56\uff0c\u8d77\u98de\uff01~~\n\n## $4$ \u5e38\u6570\u4f18\u5316\n\n\u4f46\u662f lxl \u663e\u7136\u4e0d\u4f1a\u8ba9\u4f60\u5c31\u8fd9\u6837\u6109\u5feb\u5730\u8fc7\u6389\u8fd9\u9053\u9898\u2026\u2026\n\n\u4e8e\u662f\u6211\u4eec\u5f00\u59cb\u5361\u5e38\uff1a\n\n### $4.1$ \u4f18\u5316 1\n\n\u6211\u4eec\u53d1\u73b0\uff0c$\\log_{10}v$ \u548c $\\log_2n$ \u7684\u5dee\u8ddd\u4e0d\u662f\u5f88\u5927\uff0c\u9664 $10$ \u53c8\u4f1a\u6709\u5f88\u5927\u7684\u5e38\u6570\u3002\u6240\u4ee5\u57fa\u6570\u6392\u5e8f\u7684\u57fa\u6570\u53d6 $2048$\uff0c\u8fd9\u6837\u53ef\u4ee5\u4f4d\u8fd0\u7b97\uff0c$\\log_{2048}v$ \u4e5f\u5f88\u5c0f\uff0c\u901f\u5ea6\u5c31\u4f1a\u5feb\u4e0d\u5c11\u3002\n\n### $4.2$ \u4f18\u5316 2\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u6bcf\u6b21\u6392\u5e8f\u7684\u65f6\u5019\u7528 2048 \u4e2a vector \u6765\u4fdd\u5b58\u6876\u4f1a\u5bfc\u81f4\u52a8\u6001\u5206\u914d\u5185\u5b58\u5360\u7528\u5de8\u5927\u7684\u65f6\u95f4\u3002\n\n\u7136\u800c\u6211\u4eec\u5728\u6392\u6574\u6570\u5e8f\u5217\u7684\u65f6\u5019\uff0c\u662f\u7528 2048 \u4e2a int \u6765\u4fdd\u5b58\u6bcf\u4e00\u4e2a\u6570\u7684\u51fa\u73b0\u6b21\u6570\uff0c\u7136\u540e\u518d\u653e\u56de\u5230\u6570\u7ec4\u91cc\u9762\uff0c\u8fd9\u6837\u5c31\u907f\u514d\u4e86\u5206\u914d\u5185\u5b58\u7684\u538b\u529b\u3002\n\n\u8fd9\u91cc\u7684\u5e94\u7528\u662f\u5355\u5173\u952e\u5b57\u6392\u5e8f\u7ed3\u6784\u4f53\uff0c\u6240\u4ee5\u5982\u679c\u6211\u4eec\u80fd\u628a\u7ed3\u6784\u4f53\u7684\u4e0b\u6807\u5f3a\u884c\u9644\u52a0\u5230\u5168\u5c40 tag \u4e0a\uff0c\u4e00\u5207\u95ee\u9898\u5c31\u90fd\u89e3\u51b3\u4e86\u3002\n\n\u663e\u7136\u6211\u4eec\u53ef\u4ee5\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u628a\u4e0b\u6807\u4e58\u4e0a $2^{35}$ \u7136\u540e\u52a0\u5230\u5168\u5c40 tag \u4e0a\u9762\uff0c\u6392\u5e8f\u4ecd\u7136\u53ea\u6392 $3$ \u6b21\u3002\u8fd9\u6837\u56e0\u4e3a\u6392\u5e8f\u53ea\u4f1a\u8003\u8651\u5230 $33$ \u4f4d\u4ee5\u4e0b\u7684\u90e8\u5206\uff0c\u4e0b\u6807\u5c31\u4e0d\u4f1a\u53c2\u4e0e\u6392\u5e8f\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u6309\u7167\u5173\u952e\u5b57\u6392\u597d\u5e8f\u7684\u4e0b\u6807\u6570\u7ec4\uff0c\u5bf9\u5e94\u56de\u53bb\u5373\u53ef\u3002\u5168\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u5b8c\u5168\u907f\u514d\u52a8\u6001\u5206\u914d\u5185\u5b58\uff0c\u5c31\u4f1a\u6709\u5f88\u5927\u7684\u901f\u5ea6\u63d0\u5347\u3002\n\n\u800c\u4e14\u5728\u7ed3\u5408\u4e86\u4f18\u5316 $2$ \u4e4b\u540e\uff0c\u53ef\u4ee5\u5c06\u57fa\u6570\u6392\u5e8f\u7684\u57fa\u6570\u6539\u4e3a $256$\uff0c\u7531\u4e8e\u7f13\u5b58\u7684\u5f71\u54cd\uff0c\u901f\u5ea6\u4f1a\u6709\u6781\u5927\u7684\u63d0\u5347\u3002\n\n### $4.3$ \u4f18\u5316 3\n\n\u7ef4\u62a4\u51f8\u5305\u65f6\u4e0d\u8981\u4f7f\u7528 vector\uff0c\u4f7f\u7528\u6570\u7ec4\u548c\u6307\u9488\u9759\u6001\u5206\u914d\u5185\u5b58\u3002\u8fd9\u6837\u8fdb\u4e00\u6b65\u51cf\u5c11\u4e86 vector \u52a8\u6001\u5185\u5b58\u5206\u914d\u7684\u538b\u529b\u3002\n\n### $4.4$ \u4f18\u5316 4\n\n\u7531\u4e8e\u5728\u5757\u957f\u4e0d\u53d8\u7684\u65f6\u5019\u5185\u5b58\u5206\u914d\u60c5\u51b5\u4e00\u5b9a\u4e0d\u4f1a\u53d8\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u5728\u7b2c\u4e00\u4e2a\u5757\u5206\u914d\u4e00\u4e0b\u5185\u5b58\uff0c\u6700\u540e\u4e00\u4e2a\u5757\u91cd\u65b0\u5206\u914d\u4e00\u4e0b\u5185\u5b58\u5c31\u53ef\u4ee5\u4e86\uff0c\u4e0d\u9700\u8981\u6bcf\u6b21\u90fd\u91cd\u65b0\u5206\u914d\u3002\n\n### $4.5$ \u4f18\u5316 5\n\n\u4e00\u676f\u8336\uff0c\u4e00\u5305\u70df\uff0c\u4e00\u4e2a\u5757\u957f\u8c03\u4e00\u5929\u3002\n\n---\n\n\u52a0\u4e0a\u8fd9\u4e9b\u5e38\u6570\u4f18\u5316\uff0c\u6211\u5c31\u8f7b\u677e\uff08\uff1f\uff09\u8fc7\u6389\u4e86\u8fd9\u9898\u3002\n\n\u4e0a\u9762\u7684\u5e38\u6570\u4f18\u5316\u5927\u90e8\u5206\u90fd\u56f4\u7ed5\u7740\u6d88\u9664\u52a8\u6001\u5206\u914d\u5185\u5b58\u5bfc\u81f4\u7684\u5de8\u5927\u5e38\u6570\uff0c\u8fd9\u4e2a\u601d\u8def\u5728\u5176\u4ed6\u573a\u666f\u4e0b\u4e5f\u9002\u7528\u3002\n\n---\n\n[\u4e3a\u4e86\u9632\u6b62\u6284\u88ad\uff0c\u8fd9\u91cc\u4ec5\u8d34\u51fa\u6570\u636e\u7ed3\u6784\u6838\u5fc3\u90e8\u5206\u7684\u4ee3\u7801\uff0c\u8bf7\u8bfb\u8005\u81ea\u884c\u5b8c\u6210\u5176\u4f59\u90e8\u5206\uff08\u96fe\uff09](https://www.luogu.com.cn/paste/nbf0rpol)",
        "postTime": 1594651657,
        "uid": 61088,
        "name": "Solystic",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4118 \u3010[Ynoi2018]\u672b\u65e5\u65f6\u5728\u505a\u4ec0\u4e48?\u6709\u6ca1\u6709\u7a7a?\u53ef\u4ee5\u6765\u62ef\u6551\u5417?\u3011"
    },
    {
        "content": "## \u53c2\u8003\u6587\u732e\n\n[\u4e16\u754c\u4e0a\u6700\u5e78\u798f\u7684\u5973\u5b69](https://www.luogu.com.cn/problem/P5073)\u548c\u8fd9\u9053\u9898------[shadowice1984](https://www.luogu.com.cn/user/56384)\u5927\u4f6c\u7684\u4e24\u7bc7\u9898\u89e3\n\n\u8fd8\u6709\u4e00\u4e2a\u4e0d\u8bb0\u5f97\u5728\u54ea\u4e86\uff0c\u662flxl\u5728\u67d0\u4e2a\u5730\u65b9\u53d1\u7684\u6539\u7248\u524d\u7684\u9898\u89e3\n\n## \u5199\u5728\u524d\u9762\n\n\u6211\u4eec\u77e5\u9053\u201c\u5355\u70b9\u4fee\u533a\u95f4\u6700\u5927\u5b50\u6bb5\u548c\u201d\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\u56db\u4e2a\u503c\uff1a\u533a\u95f4\u548c\u3001\u6700\u5927\u524d\u7f00\u548c\u3001\u6700\u5927\u540e\u7f00\u548c\u3001\u6700\u5927\u5b50\u6bb5\u548c\uff0c\u4e0b\u9762\u5206\u522b\u7528 $s/ls/rs/mx$ \u8868\u793a\n\n\u8fd9\u9898\u4ee5\u524d\u7684\u7248\u672c\u662f\u53ea\u52a0\u6b63\u6570\uff0c\u5b98\u65b9\u89e3\u6cd5\u662f\u5148\u5206\u6210 $\\sqrt n$ \u4e2a\u5757\n\n\u7136\u540e\u5bf9\u6bcf\u4e2a\u5757\u5efa\u4e00\u9897\u51f8\u5305\u7ebf\u6bb5\u6811\uff0c\u7ef4\u62a4 $ls/rs/mx$ \u7684\u51f8\u5305 (\u4e0a\u51f8\u58f3)\uff08\u548c[$P5073$](https://www.luogu.com.cn/problem/P5073)\u7c7b\u4f3c\uff09\n\n\u51f8\u5305\u7684\u4e8b\u6211\u60f3[shadowice1984](https://www.luogu.com.cn/user/56384)\u5927\u4f6c\u7684\u9898\u89e3\u5f88\u6e05\u6670\uff0c\u8fd9\u91cc\u58f0\u660e\uff1a\u5fc5\u987b\u8981\u641e\u6e05\u695a\u4ed6\u662f\u600e\u4e48$O(N)$\u5408\u5e76\u4e24\u4e2a\u5b50\u51f8\u5305\u7684\n\n\u5bf9\u4e8e\u8986\u76d6\u4e86\u6574\u68f5\u6811\u7684\u4fee\u6539\uff0c\u7531\u4e8e\u52a0\u4e0a\u7684\u662f\u6b63\u6570\uff0c\u6240\u4ee5\u6307\u9488\u770b\u60c5\u51b5\u5f80\u540e\u62c9\u5c31\u884c\uff0c\u590d\u6742\u5ea6\u5747\u644a$O(1)$\n\n\u91cd\u70b9\u662f\u90e8\u5206\u4fee\u6539\uff0c\u5168\u90e8\u91cd\u9020\u7ebf\u6bb5\u6811\u4f1a\u8ba9\u4f60\u7684\u4ee3\u7801T\u6389\n\n\u8fd9\u91cc\u8981\u641e\u61c2\u7ebf\u6bb5\u6811\u6784\u5efa\u7684\u672c\u8d28\uff0c\u8fd9\u91cc\u4ee5\u957f\u65b9\u5f62\u7c7b\u6bd4\uff0c\u6bcf\u5c42\u957f$\\sqrt N$\uff0c\u5bbd$log\\sqrt N$\n\n\u51f8\u5305\u4ece\u5e95\u5c42\u5efa\u8d77\uff0c\u5408\u5e76\u4fe1\u606f\u662f$O(\\sqrt N)$\u7684\uff0c\u8fd9\u91cc\u7684$\\sqrt N$\u4e3a\u6574\u68f5\u7ebf\u6bb5\u6811\u7684\u670d\u52a1\u957f\u5ea6\u5373\u5757\u957f\n\nlxl\u7ed9\u51fa\u7684\u89e3\u51b3\u65b9\u6848\u548c\u7b2c\u4e8c\u7bc7\u9898\u89e3\u4e00\u6837\uff0c\u662f\u6309\u7167\u7ebf\u6bb5\u6811\u57fa\u672c\u64cd\u4f5c\uff0c\u5c06\u64cd\u4f5c\u4e0b\u4f20\u5230 $log$ \u4e2a\u5b50\u8282\u70b9\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5crfaatu.png)\n\n\u5982\u56fe\uff0c\u7ea2\u8272\u90e8\u5206\u4e3a\u4fee\u6539\u7684\u533a\u95f4\uff0c\u540c\u65f6\u5f15\u8d77\u7eff\u8272\u90e8\u5206\u7684\u6539\u53d8\uff0c\u7ea2\u8272\u90e8\u5206\u6253\u4e0a\u6807\u8bb0\u65e5\u540e\u5904\u7406\u5e95\u4e0b\u7684\uff0c\u9ed1\u8272\u90e8\u5206\u5c31\u4e0d\u7528\u52a8\u4e86\n\n\u7ed3\u5408$O(\\sqrt N)$\u5408\u5e76\u5b50\u51f8\u5305\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u8fd9\u6b21\u4fee\u6539\u7684\u590d\u6742\u5ea6\u5c31\u662f\u7ea2\u7eff\u8272\u7684\u957f\u5ea6\u548c\n\n\u590d\u6742\u5ea6$/$\u89c4\u6a21\u5c31\u662f$O(k\\sqrt N)$------$k$\u4e3a\u4e00\u5de8\u5927\u5e38\u6570\n\n\u641e\u5b9a\u4e86\u4fee\u6539\u64cd\u4f5c\uff0c\u8be2\u95ee\u5c31\u53d8\u5f97\u4e0d\u582a\u4e00\u51fb\uff0c\u4f46\u503c\u5f97\u4e00\u63d0\u7684\u4e8b\uff0c\u4fee\u6539\u64cd\u4f5c\u7279\u522b\u662f\u5bf9\u61d2\u6807\u8bb0\u7684\u5904\u7406\u5341\u5206\u7e41\u7410\n\n\u7531\u4e8e\u6280\u827a\u4e0d\u7cbe\uff0c\u6211\u7684\u5e38\u6570\u5de8\u5927\uff0cT\u5230\u98de\u8d77\uff0c\u5148\u540e\u591a\u6b21\u5c1d\u8bd5\u6b64\u9898\uff0c\u82b1\u8d39\u5927\u91cf\u7cbe\u529b\u4fee\u6539\u4ee3\u7801\uff0c\u5747\u4ee5\u5931\u8d25\u544a\u7ec8\n\n\u73b0\u5728\u7ed9\u51fa\u4e00\u4e2a\u4e2a\u4eba\u89c9\u5f97\u65b9\u4fbf\u7684\u5904\u7406\u65b9\u6cd5\uff1a\n\n\u7ebf\u6bb5\u6811\u53ea\u8bb0\u4e00\u4e2a $c$\uff0c\u8868\u793a\u8fd9\u4e00\u5c42\u6240\u6709\u70b9\u8981\u52a0 $c$\n\n\u4e0b\u5230\u76ee\u6807\u8282\u70b9\u65f6\uff1a\n```cpp\nif(l<=tr[now].l&&tr[now].r<=r){tr[now].c+=k;return ;}\n```\n\u61d2\u6807\u8bb0\u4e0b\u653e\u65f6\u4e5f\u53ea\u4f20\u4e2a $c$ \u4e0b\u53bb\n\n\u7136\u540e\u4e0a\u9762\u8282\u70b9\u5f15\u7528\u4e0b\u9762\u7684\u70b9\u96c6\u65f6\n```cpp\nstruct point{ll x,y;point operator+(ll const&AK47)const{return point{x,y+AK47*x};}};\npoint jia(point a,point b){return (point){a.x+b.x,a.y+b.y};}\n\nP=jia(A,B+tr[lc].c);\n```\n\u8fd9\u6837\u8bbe\u7f6e\u6bd4\u8f83\u65b9\u4fbf\uff0c\u4f46\u8981\u6ce8\u610f\u8fd0\u7b97\u987a\u5e8f\n\n## \u6b63\u7247\uff08\u5f88\u77ed\uff09\n\n\u73b0\u5728\u96be\u5ea6\u52a0\u5927\u4e86\uff0c\u53ef\u4ee5\u52a0\u8d1f\u6570\u4e86\u3002\u3002\u3002\u552f\u4e00\u4e0d\u53d8\u7684\u8fd8\u662f\u4e24\u4e2a\u5b57\uff1a\u5206\u5757\n\n\u4f46\u6709\u7684\u4e1c\u897f\u4f60\u60f3\u4e0d\u5230\u5c31\u771f\u7684\u60f3\u4e0d\u5230\u4e86\u3002\u3002\u3002\n\n\u5206\u5757\u505a\u533a\u95f4\u52a0\u533a\u95f4\u548c\u505a\u8fc7\u5417\uff1f\n\n\u662f\u4e0d\u662f\u6bcf\u4e2a\u64cd\u4f5c\u90fd\u662f\u4ece\u5de6\u5f80\u53f3\uff0c\u5c0f\u6bb5----\u5927\u6bb5----\u5c0f\u6bb5\uff0c\u8fd9\u6837\uff1f\n\n\u4f60\u8bd5\u8fc7\u6309\u5757\u5904\u7406\u95ee\u9898\u5417\uff1f\n\n\u5c31\u662f\u5bf9\u7b2c\u4e00\u5757\u626b\u63cf$n$\u4e2a\u95ee\u9898\uff0c\u7136\u540e\u518d\u53bb\u4e0b\u4e00\u4e2a\u5757\n\n\u8fd9\u91cc\u5c31\u6709\u4e00\u4e2a\u91cd\u8981\u7684\u601d\u60f3\uff0c\u524d\u63d0\u662f\u6570\u636e\u53ef\u4ee5\u5408\u5e76\uff0c\u52bf\u80fd\u53ef\u4ee5\u5747\u644a(\u8fd9\u91cc\u5f88\u62b1\u6b49\u7528\u4e86\u52bf\u80fd\uff0c\u53ef\u80fd\u4e0d\u592a\u4e25\u8c28)\n\n\u6211\u4eec\u77e5\u9053\u5c0f\u6bb5\u5171\u6709 $n$ \u4e2a\uff0c\u5355\u6b21\u64cd\u4f5c\u590d\u6742\u5ea6$O(\\sqrt n)$\n\n\u53c8\u6709\u5927\u6bb5 $n\\sqrt n$ \u4e2a\uff0c\u5355\u6b21\u64cd\u4f5c\u590d\u6742\u5ea6$O(1)$\n\n\u5747\u644a\u4e0b\u6765\u6bcf\u4e2a\u5757\u7684\u590d\u6742\u5ea6\u662f$O(n)$\u7684\uff0c\u521a\u597d\u6709$\\sqrt n$\u4e2a\u5757\n\n\u6240\u4ee5\u2014\u2014\u4f60\u61c2\u5f97\uff0c\u8fd9\u73a9\u610f\u7528\u5728\u8fd9\u91cc\u771f\u7684\u771f\u7684\u771f\u7684\uff0c\u5973\u5c11\u53e3\u963f\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/elzw5ge4.png)\n\n\u5982\u56fe\uff0c\u9ed1\u8272\u4e3a\u5757\u7684\u5206\u754c\uff0c\u7eff\u8272\u4e3a\u8be2\u95ee\uff0c\u7ea2\u8272\u4e3a\u4fee\u6539\uff0c\u4e0b\u9762\u4e00\u6bb5\u5b57\u7684 $n$ \u548c $m$ \u8868\u793a\u89c4\u6a21\n\n\u6211\u4eec\u77e5\u9053\uff0c\u6709 $m$ \u6761\u7ea2\u8272\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u5206\u5757\u53d8\u6210 $m$ \u6761\u5c0f\u5757\u7684\u7ea2\u8272\uff0c\u548c$m\\sqrt n$\u6761\u6574\u6bb5\u7684\u7ea2\u8272\n\n\u53c8\u6709 $m$ \u6761\u7eff\u8272\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u5206\u5757\u53d8\u6210 $m$ \u6761\u5c0f\u5757\u7684\u7eff\u8272\uff0c\u548c$m\\sqrt n$\u6761\u6574\u6bb5\u7684\u7eff\u8272\n\n\u5176\u4e2d\u7eff\u8272\u4e2d\u7684\u5c0f\u5757\u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u89e3\u51b3\n\n\u90a3\u4e48\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u5757\u4e2d\uff0c\u5c31\u4f1a\u51fa\u73b0\u5982\u4e0b\u60c5\u51b5\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qsp9abtl.png)\n\n\u4e0d\u59a8\u8bbe\u4e3a\u6700\u574f\u60c5\u51b5\uff0c\u6709\u6700\u591a$m$\u6761\u7eff\u8272\u5927\u6bb5\u548c\u6700\u591a$m$\u6761\u7ea2\u8272\u5927\u6bb5 \u4ea4\u9519 \u5728\u4e00\u4e2a\u5757\u91cc\n\n\u90a3\u7ea2\u8272\u5c0f\u6bb5\uff1f\u3002\u3002\u3002\n\n\u5927\u6bb5\u7684\u603b\u91cf\u662f\u7ea2\u8272\u5c0f\u6bb5\u603b\u91cf\u7684$\\sqrt n$\u500d\uff0c\u5373\u7ea2\u8272\u5c0f\u6bb5\u662f\u6781\u4e3a\u7a00\u758f\u7684\n\n\u7136\u540e\u53ea\u8981\u628a\u8fd9\u73a9\u610f\u4e00\u5708\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6ntjmiiv.png)\n\n\u5929\u54ea\u8fd9\u4e0d\u5c31\u662fP5073\uff01\uff01\uff1f\n\n\u4e0d\u8bf4\u4e86\u3002\u3002\u3002\u4f60\u4eec\u52a0\u6cb9 $\\color{white}\\text{\u522b\u95ee\u4e3a\u4ec0\u4e48\u6ca1\u4ee3\u7801\uff0c\u95ee\u5c31\u662fqwq}$\n\n## \u5199\u5728\u540e\u9762\uff08\u96fe\n\n\u53bb\u5e74\u6211\u770b\u5230\u8fd9\u9898\u5c31\u5f00\u59cb\u5728\u673a\u623f\u6ca1\u65e5\u6ca1\u591c\u7684\u5c1d\u8bd5\uff0c\u5c1d\u8bd5\u4e86\u597d\u591a\u4e2a3\u5929\uff0c\u90fd\u5feb\u618b\u51fa\u75c5\u4e86\u3002\u3002\u3002\u5982\u4eca\u7ec8\u4e8e\u6572\u51fa\u6765\u4e86\uff0c\u4f46\u662f\u7ec6\u8282\u8d85\u591a\uff0cRE\u534a\u5929\u53d1\u73b0\u81ea\u5df1\u5fd8memset\uff0cmax\u51fd\u6570\u6ca1\u5f00long long\u2026\u2026\n\n\u4e2a\u4eba\u611f\u53d7\uff1alxl\u7684\u4e00\u4e9b\u9898\u6700\u5999\u7684\u5730\u65b9\u5728\u4e8e\u201c\u603b\u91cf\u4e00\u5b9a\u201d\uff0c\u4ece\u800c\u8fbe\u5230\u5747\u644a\u7684\u590d\u6742\u5ea6\n\n\u6700\u540e\u7684\u6700\u540e\uff0c\u795d\u73c2\u6735\u8389\u7ee7\u7eed\u5e78\u798f\u4e0b\u53bb\u3002\n\n\u8fd8\u6709\uff0c\u7ba1\u4ed6\u4ec0\u4e48\u9898\u603b\u4e4blxl\u6bd2\u7624\u6570\u636e\u7ed3\u6784\u5929\u4e0b\u7b2c\u4e00\uff01\uff01",
        "postTime": 1591359847,
        "uid": 120634,
        "name": "2018heyuyang",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4118 \u3010[Ynoi2018]\u672b\u65e5\u65f6\u5728\u505a\u4ec0\u4e48?\u6709\u6ca1\u6709\u7a7a?\u53ef\u4ee5\u6765\u62ef\u6551\u5417?\u3011"
    },
    {
        "content": "\u9898\u610f\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u5e8f\u5217\uff0c\u652f\u6301\u533a\u95f4\u589e\u51cf\u533a\u95f4\u67e5\u8be2\u6700\u5927\u5b50\u6bb5\u548c\n\n~~\u4ee5\u4e0b\u6ce8\u610f\u90e8\u5206\u53ef\u80fd\u662f\u4e2a\u4eba\u5199\u6cd5\u95ee\u9898~~\n\n## \u524d\u7f6e\u77e5\u8bc6 1\uff1a\u7ebf\u6bb5\u6811\n\n~~\u80fd\u505a\u8fd9\u9898\u90fd\u4f1a\u7ebf\u6bb5\u6811\u4e86\u5427~~\n\n## \u524d\u7f6e\u77e5\u8bc6 2\uff1a\u5206\u5757\n\n\u4ee5\u5206\u5757\u505a\u533a\u95f4\u589e\u51cf\u533a\u95f4\u6c42\u548c\u4e3a\u4f8b\u3002\uff08\u5141\u8bb8\u79bb\u7ebf\uff09\u65f6\u6709\u4e24\u79cd\u505a\u6cd5\uff0c\u7b2c\u4e00\u79cd\u662f\u5bf9\u6bcf\u6b21\u64cd\u4f5c\u5206\u522b\u5904\u7406\u6bcf\u4e2a\u5757\uff0c\u7b2c\u4e8c\u79cd\u662f\u79bb\u7ebf\u6240\u6709\u64cd\u4f5c\uff0c\u5bf9\u6bcf\u4e2a\u5757\u5904\u7406\u6240\u6709\u64cd\u4f5c\u3002\u7b2c\u4e00\u79cd\u7684\u4f18\u52bf\u662f\u5728\u7ebf\uff0c\u7b2c\u4e8c\u79cd\u7684\u4f18\u52bf\u662f\u4e00\u5927\u5806\u64cd\u4f5c\u6709\u4e00\u5b9a\u7684\u6574\u4f53\u5904\u7406\u4f18\u5316\u7a7a\u95f4\u3002\u672c\u9898\u9700\u8981\u4f7f\u7528\u7684\u662f\u7b2c\u4e8c\u79cd\u64cd\u4f5c\n\n## \u524d\u7f6e\u77e5\u8bc6 3\uff1a\u95f5\u53ef\u592b\u65af\u57fa\u548c\n\n~~\u6ca1\u5b66\u8fc7\u5148\u53bb\u5199\u5199 [[JSOI2018]\u6218\u4e89](https://www.luogu.com.cn/problem/P4557)~~\n\n\u6ce8\u610f\u8fd9\u91cc\u7684\u51f8\u5305\u7528\u7684\u662f Jarris \u6b65\u8fdb\u6cd5\uff0c\u800c\u95f5\u53ef\u592b\u65af\u57fa\u548c\u8dd1\u51fa\u6765\u7684\u51f8\u5305\u53ef\u80fd\u771f\u7684\u662f\u51f8\u5305\u800c\u4e0d\u662f\u8fd9\u9898\u9700\u8981\u7684\u4e0a\u51f8\u58f3\uff0c\u6240\u4ee5\u9700\u8981\u8dd1\u5b8c\u4e4b\u540e\u518d\u8dd1\u4e00\u6b21\u51f8\u5305\n\n## \u524d\u7f6e\u77e5\u8bc6 4\uff1a\u57fa\u6570\u6392\u5e8f\n\n\u5efa\u8bae\u4f7f\u7528\u5757\u957f\u4e3a 256 \u7684\u677e\u5f0f\u57fa\u6392\uff0c\u6709\u53ef\u7528\u4f4d\u8fd0\u7b97\u3001\u5361 cache \u3001\u6070\u597d\u8fd0\u884c 4 \u6b21\u7684\u4f18\u52bf\n\n# \u672c\u9898\u6b63\u7247\n\n\u8fd9\u91cc\u9ed8\u8ba4\u5df2\u7ecf\u5199\u8fc7 [[Ynoi2015]\u4e16\u4e0a\u6700\u5e78\u798f\u7684\u5973\u5b69](https://www.luogu.com.cn/problem/P5073)\n\n\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u76f4\u63a5\u62d3\u5c55 5073 \u7684\u601d\u8def\uff1f\u539f\u56e0\u662f\u8fd9\u9053\u9898\u7ebf\u6bb5\u6811 pushup \u7684\u590d\u6742\u5ea6\u662f $O(n)$ \u7684\uff0c\u6253\u6807\u8bb0\u53ea\u8981\u4e0d\u662f\u6253\u5728\u6839\u8282\u70b9\u4e0a\u90fd\u7b49\u4e8e\u66b4\u529b\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u91cc\u7684\u7ebf\u6bb5\u6811\u5e76\u4e0d\u652f\u6301\u5feb\u901f\u533a\u95f4\u4fee\u6539\n\n\u5206\u5757\u5177\u6709\u7684\u7279\u6027\u4e4b\u4e00\u5c31\u662f\u5927\u90e8\u5206\u4fee\u6539\u9762\u5411\u6574\u5757\u800c\u6563\u5757\u975e\u5e38\u66b4\u529b\uff0c\u8fd9\u6b63\u597d\u7b26\u5408\u6211\u4eec\u8fd9\u9898\u7684\u9700\u8981\u3002\u8003\u8651\u5bf9\u539f\u5e8f\u5217\u5206\u5757\u3001\u5bf9\u6bcf\u4e2a\u5757\u5efa\u7ebf\u6bb5\u6811\uff0c\u90a3\u4e48\u6574\u5757\u4fee\u6539\u5c31\u53d8\u6210\u4e86 5073 \u4e86\n\n\u60f3\u5230\u8fd9\u91cc\u4f3c\u4e4e\u7ed3\u675f\u4e86\uff1f\n\n\u5206\u6790\u4e00\u4e0b\u590d\u6742\u5ea6\uff0c\u6574\u5757\u4fee\u6539\u590d\u6742\u5ea6 $O(m\\sqrt n)$\uff0c\u6563\u5757\u4fee\u6539\u66b4\u529b\u91cd\u6784 $O(m\\sqrt nlogn)$\uff0c\u8be2\u95ee\uff1f\n\n\u8be2\u95ee\u6309\u7167 5073 \u7684\u5957\u8def\u9700\u8981\u79bb\u7ebf\u8dd1\uff0c\u7136\u800c\u6563\u5757\u4fee\u6539\u66b4\u529b\u91cd\u6784\u4f1a\u5f3a\u884c\u51b2\u65ad\u6574\u4f53\u79bb\u7ebf\uff08\u4e0d\u518d\u53ea\u548c\u603b\u6807\u8bb0\u76f8\u5173\uff09\uff0c\u5bfc\u81f4\u5e76\u4e0d\u80fd\u6240\u6709\u8be2\u95ee\u4e00\u8d77\u79bb\u7ebf\u3002\u4f46\u662f\u8003\u8651\u5230\u6563\u5757\u4fee\u6539\u53ea\u6709 $O(m)$ \u6b21\uff0c\u6700\u591a\u4e5f\u53ea\u80fd\u628a\u8be2\u95ee\u51b2\u65ad\u6210 $O(m\\sqrt n)$ \u6bb5\uff0c\u5e76\u4e0d\u5bf9\u590d\u6742\u5ea6\u9020\u6210\u5f71\u54cd\n\n\u79bb\u7ebf\u8981\u540e\u5728 $log\\sqrt n$ \u5c42\u7ebf\u6bb5\u6811\u4e0a\u5411\u53f3\u722c\uff0c\u53ef\u4ee5\u8ba1\u7b97\u590d\u6742\u5ea6\u4e3a $O(m\\sqrt nlogn)$\n\n\u6b63\u5e38\u60c5\u51b5\u4e0b\u603b\u590d\u6742\u5ea6 $O(m\\sqrt nlogn)$ \u662f\u6709\u673a\u4f1a\u8dd1\u8fc7 $10^5$ \u7684\u8303\u56f4\u7684\uff0c\u7136\u800c\u8fd9\u9898\u7ebf\u6bb5\u6811\u4e0a\u7ef4\u62a4\u7684\u662f\u4e2a\u51f8\u5305\u663e\u7136\u5e38\u6570\u4e0a\u4e0d\u5141\u8bb8\u5361\u8fc7\u53bb\n\n~~\u770b\u5230 Ynoi \u9898\uff0c\u5957\u8def\u5361\u6389 log~~\n\n\u76ee\u524d\u74f6\u9888\u5728\u6563\u5757\u4fee\u6539\u548c\u8be2\u95ee\n\n\u9996\u5148\u662f\u6563\u5757\u4fee\u6539\uff0c\u8003\u8651\u5230\u8fd9\u91cc\u7684\u7ebf\u6bb5\u6811\u4f9d\u7136\u662f\u4e2a\u7ebf\u6bb5\u6811\uff0c\u867d\u7136\u4e0d\u80fd\u5feb\u901f\u533a\u95f4\u4fee\u6539\u4f46\u662f\u53ef\u4ee5\u9f9f\u901f\u533a\u95f4\u4fee\u6539\u800c\u4e0d\u9700\u66b4\u529b\u91cd\u6784\uff0c\u7531\u4e8e\u6bcf\u4e00\u5c42\u6700\u591a\u53ea\u6709 2 \u4e2a\u8282\u70b9\u9700\u8981 pushup \u5355\u6b21\u590d\u6742\u5ea6\u662f $O(\\sum\\limits_{i=0}^\\infty\\dfrac{\\sqrt n}{2^i})=O(\\sqrt n)$ \u4ece\u800c\u6d88\u53bb\u4e86 log\n\n\u533a\u95f4\u8be2\u95ee\u53ef\u4ee5\u76f4\u63a5\u66b4\u529b\u8ba1\u7b97\uff0c\u7531\u4e8e\u533a\u95f4\u8be2\u95ee\u53ea\u6709 $O(m)$ \u4e2a\u590d\u6742\u5ea6\u662f $O(m\\sqrt n)$ \u7684\n\n\u6240\u4ee5\u6700\u540e\u5269\u4e0b\u7684\u95ee\u9898\u5c31\u662f\uff1a\u5168\u5c40\u4fee\u6539\u3001\u5168\u5c40\u6700\u5927\u5b50\u6bb5\u548c\n\n\u8fd9\u65f6\u53ef\u4ee5\u53d1\u73b0\u5e76\u4e0d\u9700\u8981\u5728\u7ebf\u6bb5\u6811\u7684 log \u5c42\u4e0a\u5411\u53f3\u722c\u800c\u53ea\u9700\u8981\u5728\u6839\u8282\u70b9\u505a\u8fd9\u4e00\u6b65\uff0c\u8fd9\u6837\u8fd9\u4e00\u6b65\u590d\u6742\u5ea6\u4e5f\u6ca1\u6709 log \u4e86\n\n\u7136\u800c\u6392\u5e8f\u90e8\u5206\u8fd8\u662f\u6709\u4e2a log\uff0c\u53ef\u4ee5\u901a\u8fc7\u57fa\u6570\u6392\u5e8f\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\n\n\u89e3\u51b3\u5b8c\u8fd9\u4e9b\u95ee\u9898\u590d\u6742\u5ea6\u5c31\u53d8\u6210\u4e86 $O(m\\sqrt n)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\n\n~~TLE\uff0c0\u5206~~\n\n## \u771f\u00b7\u672c\u9898\u6b63\u7247\n\n\u63a5\u4e0b\u6765\u5c31\u662f\u5361\u5e38\u6570\u4e86\uff08\u4ee5\u4e0b\u6280\u5de7\u4e0d\u4fdd\u8bc1\u6709\u7528\uff09\n\n1. ~~\u6211\u4e5f\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u5c01\u88c5\u4e86\u8dd1\u5f97\u66f4\u5feb~~\n\n2. pushup \u65f6\uff0c\u6c42**\u6240\u6709**\u51f8\u5305\u90fd\u53ea\u9700\u8981\u8003\u8651\u5b50\u8282\u70b9\u51f8\u5305\u4e0a\u7684\u70b9\uff0c\u53ef\u4ee5\u8bc1\u660e\u8fd9\u662f\u6b63\u786e\u7684\n\n3. \u5408\u7406\u501f\u52a9\u81ea\u7136\u6ea2\u51fa\u53ef\u4ee5\u8ba9\u4f60\u5728\u67d0\u4e9b\u5730\u65b9\u4e0d\u9700\u8981\u5f00 long long\n\n4. \u57fa\u6570\u6392\u5e8f\u90e8\u5206\u53ef\u4ee5\u5faa\u73af\u5c55\u5f00\uff0c\u53ef\u4ee5\u8bbe\u5b9a\u4e00\u4e2a\u9608\u503c\u5c0f\u4e8e\u8fd9\u4e2a\u9608\u503c\u5c31\u66b4\u529b\u5feb\u6392\n\n5. \u5757\u957f\u4f3c\u4e4e\u4e0d\u9700\u8981\u5927\u8c03\uff0c\u6700\u591a\u7a0d\u5fae\u4fee\u6539\u4e00\u4e0b\u9632\u6b62\u88ab\u5361\u6ee1\n\n6. pushdown \u548c\u666e\u901a\u7684\u4e0d\u540c\uff0c\u666e\u901a\u7684\u5982\u679c\u52a0 if \u5224\u65ad\u53ef\u80fd\u4f1a\u66f4\u6162\uff0c\u4f46\u8fd9\u9898 pushdown \u7684\u4ee3\u4ef7\u662f\u5f88\u9ad8\u7684\uff0c\u8981\u5148\u5224\u65ad\u662f\u5426\u6709\u4fee\u6539\n\n\u4ee3\u7801\u53ea\u7ed9\u51fa\u6838\u5fc3\u90e8\u5206\n\n```\nstruct Q\n{\n\tint z,y,wz;\n\tll tot;\n\tQ(int a=0,int b=0,int c=0,ll d=0):z(a),y(b),wz(c),tot(d){}\n\tbool operator<(Q &o) {return tot<o.tot;}\n\tQ operator-(Q o) {return Q(z-o.z,y-o.y,wz-o.wz,tot-o.tot);}\n};\nstruct P\n{\n\tint wz;\n\tll tot;\n\tbool operator<(register P&o) const{return tot<o.tot;}\n};\nstruct pt\n{\n\tint x;\n\tll y;\n\tpt(register int a=0,register ll b=inf):x(a),y(b){}\n\tbool operator<(register pt o) {return (x*o.y<y*o.x);}//\u987a\u65f6\u9488\n\tpt operator+(register pt o) {return pt(x+o.x,y+o.y);}\n\tpt operator-(register pt &o) {return pt(x-o.x,y-o.y);}\n\tll operator*(register pt o) {return x*o.y-y*o.x;}\n\tll operator/(register pt o) {return x*o.x+y*o.y;}\n\tbool operator^(register ll k) {return (k*x+y>0);}\n\tvoid operator+=(register pt &o) {x+=o.x;y+=o.y;}\n\tvoid operator-=(register pt &o) {x-=o.x;y-=o.y;}\n};\nP stt[N],ls[N];\nQ q[N];\npt st[N],la[N],lb[N];\nll lsum[N],ans[N],qz[N];\nll mt;\nint bel[N],l[N],r[N],a[N],px[N],tot[bas];\nint n,m,ksiz,ks,x,y,z,qsum,i,j;\nvoid qs(register int tp)\n{\n\ttp-=4;register int i;\n\tfor (i=1;i<=tp;i+=4)\n\t{\n\t\tstt[i].tot-=mt;\n\t\tstt[i+1].tot-=mt;\n\t\tstt[i+2].tot-=mt;\n\t\tstt[i+3].tot-=mt;\n\t}tp+=4;\n\tfor (i;i<=tp;i++) stt[i].tot-=mt;\n\tmemset(tot,0,sizeof(tot));\n\tfor (register int i=1;i<=tp;i++) ++tot[stt[i].tot&bs];\n\tfor (register int i=1;i<bas;i++) tot[i]+=tot[i-1];\n\tfor (register int i=tp;i;i--) ls[tot[stt[i].tot&bs]--]=stt[i];\n\tmemset(tot,0,sizeof(tot));\n\tfor (register int i=1;i<=tp;i++) ++tot[ls[i].tot>>8&bs];\n\tfor (register int i=1;i<bas;i++) tot[i]+=tot[i-1];\n\tfor (register int i=tp;i;i--) stt[tot[ls[i].tot>>8&bs]--]=ls[i];\n\tmemset(tot,0,sizeof(tot));\n\tfor (register int i=1;i<=tp;i++) ++tot[stt[i].tot>>16&bs];\n\tfor (register int i=1;i<bas;i++) tot[i]+=tot[i-1];\n\tfor (register int i=tp;i;i--) ls[tot[stt[i].tot>>16&bs]--]=stt[i];\n\tmemset(tot,0,sizeof(tot));\n\tfor (register int i=1;i<=tp;i++) ++tot[ls[i].tot>>24&bs];\n\tfor (register int i=1;i<bas;i++) tot[i]+=tot[i-1];\n\tfor (register int i=tp;i;i--) stt[tot[ls[i].tot>>24&bs]--]=ls[i];\n\ttp-=4;\n\tfor (i=1;i<=tp;i+=4)\n\t{\n\t\tstt[i].tot+=mt;\n\t\tstt[i+1].tot+=mt;\n\t\tstt[i+2].tot+=mt;\n\t\tstt[i+3].tot+=mt;\n\t}tp+=4;\n\tfor (i;i<=tp;i++) stt[i].tot+=mt;\n}\ninline void mx(register ll &x,const ll y)\n{\n\tif (x<y) x=y;\n}\nvoid tb(register pt *a,register int pre,register int &n)\n{\n\tregister int i,tp=pre-1;\n\tfor (i=pre;i<n;i++)\n\t{\n\t\twhile ((tp)&&(a[i]-a[tp-1]<a[tp]-a[tp-1])) --tp;\n\t\ta[++tp]=a[i];\n\t}\n\tn=tp+1;\n}\nvoid maintain(register pt *a,const int n,const int m)//old:n new: m\n{\n\tregister int i;\n\tfor (i=m-1;i>=n;i--) a[i]=pt(i+1,inf);\n\tfor (i=n-1;~i;i--) if (a[i].x!=i+1) {a[a[i].x-1]=a[i];a[i]=pt(i+1,inf);}\n}\nvoid spemaintain(register pt *a,const int n,const int m)\n{\n\tregister int i;\n\tfor (i=0;i<m;i++) st[i]=pt(i+1,inf);\n\tfor (i=0;i<n;i++) mx(st[a[i].x-1].y,a[i].y);\n\tmemcpy(a,st,m*sizeof(pt));\n}\nint order(register pt *a,register int n)//old: n new: return\n{\n\tregister int i=1,tp=0;\n\tfor (i=0;i<n;i++) if (a[i].y>inf) a[tp++]=a[i];\n\ttb(a,1,tp);return tp;\n}\nint sum(pt *a,pt *b,pt *c,int n,int m,int len)//a+b=c\n{\n\tint i,j,tp=1;\n\tc[0]=a[0]+b[0];--n;--m;\n\tfor (i=0;i<n;i++) la[i]=a[i+1]-a[i];la[n]=a[0]-a[n];\n\tfor (i=0;i<m;i++) lb[i]=b[i+1]-b[i];lb[m]=b[0]-b[m];\n\tfor (i=j=0;(i<=n)&&(j<=m);++tp)\n\t{\n\t\tif (la[i]<lb[j]) c[tp]=c[tp-1]+la[i++]; \n\t\telse c[tp]=c[tp-1]+lb[j++];\n\t}--tp;\n\twhile (i<=n) c[tp]=c[tp-1]+la[i++],++tp;\n\twhile (j<=m) c[tp]=c[tp-1]+lb[j++],++tp;\n\tspemaintain(c,tp,len);\n\ttp=order(c,len);\n\treturn tp;\n}\nbool cmp(register int &x,register int &y)\n{\n\treturn qz[x]<qz[y];\n}\nstruct segmentree\n{\n\tpt sl[O][M],sr[O][M],ss[O][M],scf,lcf,rcf;\n\tll s[K],lz[M],ssum[M];\n\tll mlz;\n\tint l[M],r[M],cs[M],scd[M],tcd[M],lcd[M],rcd[M],a[K],b[K];\n\tint dt,sy,ly,ry,tp,y,z,n;\nprivate:\n\tvoid newpushup(const int x)\n\t{\n\t\tregister int c=x<<1,cd;\n\t\tregister ll ys;\n\t\tscd[x]=sum(sr[cs[c]]+l[c],sl[cs[c]]+l[c|1],ss[cs[x]]+l[x],rcd[c],lcd[c|1],tcd[x]);\n\t\tmaintain(ss[cs[x]]+l[x],scd[x],tcd[x]);\n\t\tregister pt *p1=ss[cs[x]]+l[x]-1,*p2=ss[cs[c]]+l[c];\n\t\tfor (register int i=0;i<scd[c];i++,p2++) mx((*(p1+(*p2).x)).y,(*p2).y);\n\t\tc|=1;\n\t\tp2=ss[cs[c]]+l[c];\n\t\tfor (register int i=0;i<scd[c];i++,p2++) mx((*(p1+(*p2).x)).y,(*p2).y);\n\t\tscd[x]=order(ss[cs[x]]+l[x],tcd[x]);//\u5b8c\u6210ss[x]\n\t\tc^=1;\n\t\tmemcpy(sl[cs[x]]+l[x],sl[cs[c]]+l[c],lcd[c]*sizeof(pt));\n\t\tys=ssum[c];cd=tcd[c];\n\t\tlcd[x]=lcd[c];c|=1;p1=sl[cs[x]]+l[x];p2=sl[cs[c]]+l[c];\n\t\tfor (register int i=0;i<lcd[c];i++,++p2) *(p1+(lcd[x]++))=pt((*p2).x+cd,(*p2).y+ys);\n\t\ttb(sl[cs[x]]+l[x],lcd[c^1],lcd[x]);//\u5b8c\u6210sl[x]\n\t\tmemcpy(sr[cs[x]]+l[x],sr[cs[c]]+l[c],rcd[c]*sizeof(pt));\n\t\tys=ssum[c];cd=tcd[c];\n\t\trcd[x]=rcd[c];c^=1;p1=sr[cs[x]]+l[x];p2=sr[cs[c]]+l[c];\n\t\tfor (register int i=0;i<rcd[c];i++,++p2) *(p1+(rcd[x]++))=pt((*p2).x+cd,(*p2).y+ys);\n\t\ttb(sr[cs[x]]+l[x],rcd[c|1],rcd[x]);\n\t\tssum[x]=ssum[c]+ssum[c^1];\n\t}\n\tinline void pushdown(register int x)\n\t{\n\t\tif (lz[x])\n\t\t{\n\t\t\tregister int c=x<<1;\n\t\t\tlz[c]+=lz[x];ssum[c]+=lz[x]*tcd[c];\n\t\t\tfor (register int i=0;i<scd[c];i++) ss[cs[c]][l[c]+i].y+=lz[x]*ss[cs[c]][l[c]+i].x;\n\t\t\tfor (register int i=0;i<lcd[c];i++) sl[cs[c]][l[c]+i].y+=lz[x]*sl[cs[c]][l[c]+i].x;\n\t\t\tfor (register int i=0;i<rcd[c];i++) sr[cs[c]][l[c]+i].y+=lz[x]*sr[cs[c]][l[c]+i].x;\n\t\t\tc|=1;\n\t\t\tlz[c]+=lz[x];ssum[c]+=lz[x]*tcd[c];\n\t\t\tfor (register int i=0;i<scd[c];i++) ss[cs[c]][l[c]+i].y+=lz[x]*ss[cs[c]][l[c]+i].x;\n\t\t\tfor (register int i=0;i<lcd[c];i++) sl[cs[c]][l[c]+i].y+=lz[x]*sl[cs[c]][l[c]+i].x;\n\t\t\tfor (register int i=0;i<rcd[c];i++) sr[cs[c]][l[c]+i].y+=lz[x]*sr[cs[c]][l[c]+i].x;\n\t\t\tlz[x]=0;\n\t\t}\n\t}\n\tvoid build(int x)\n\t{\n\t\tlz[x]=0;tcd[x]=r[x]-l[x]+1;\n\t\tif (l[x]==r[x])\n\t\t{\n\t\t\tscd[x]=lcd[x]=rcd[x]=1;\n\t\t\tsr[cs[x]][l[x]]=ss[cs[x]][l[x]]=sl[cs[x]][l[x]]=pt(1,ssum[x]=a[l[x]]);\n\t\t\treturn;\n\t\t}\n\t\tregister int c=x<<1;\n\t\tcs[c]=cs[c|1]=cs[x]+1;\n\t\tl[c]=l[x];r[c]=l[x]+r[x]>>1;\n\t\tl[c|1]=r[c]+1;r[c|1]=r[x];\n\t\tbuild(c);build(x<<1|1);\n\t\tnewpushup(x);\n\t}\n\tvoid modify(int x)\n\t{\n\t\tif ((z<=l[x])&&(r[x]<=y))\n\t\t{\n\t\t\tlz[x]+=dt;ssum[x]+=(ll)dt*tcd[x];\n\t\t\tfor (register int i=0;i<scd[x];i++) ss[cs[x]][l[x]+i].y+=(ll)dt*ss[cs[x]][l[x]+i].x;\n\t\t\tfor (register int i=0;i<lcd[x];i++) sl[cs[x]][l[x]+i].y+=(ll)dt*sl[cs[x]][l[x]+i].x;\n\t\t\tfor (register int i=0;i<rcd[x];i++) sr[cs[x]][l[x]+i].y+=(ll)dt*sr[cs[x]][l[x]+i].x;\n\t\t\treturn;\n\t\t}\n\t\tpushdown(x);\n\t\tif (z<=r[x<<1]) modify(x<<1);\n\t\tif (y>r[x<<1]) modify(x<<1|1);\n\t\tnewpushup(x);\n\t}\n\tvoid allpush(int x,int cnt)\n\t{\n\t\tcnt+=(int)lz[x];\n\t\tif (l[x]==r[x]) {b[l[x]]=a[l[x]]+cnt;return;}\n\t\tx<<=1;\n\t\tif (z<=r[x]) allpush(x,cnt);\n\t\tif (y>r[x]) allpush(x|1,cnt);\n\t}\npublic:\n\tvoid sol()\n\t{\n\t\tsy=ly=ry=1;\n\t\tscf=ss[0][2]-ss[0][1];\n\t\tlcf=sl[0][2]-sl[0][1];\n\t\trcf=sr[0][2]-sr[0][1];\n\t\tif (tp<=1500) sort(stt+1,stt+tp+1); else qs(tp);\n\t\t\tfor (register int i=1;i<=tp;i++)\n\t\t\t{\n\t\t\t\twhile ((sy<scd[1])&&(scf^stt[i].tot))\n\t\t\t\t{\n\t\t\t\t\t++sy;\n\t\t\t\t\tscf=ss[0][1+sy]-ss[0][sy];\n\t\t\t\t}\n\t\t\t\twhile ((ly<lcd[1])&&(lcf^stt[i].tot))\n\t\t\t\t{\n\t\t\t\t\t++ly;\n\t\t\t\t\tlcf=sl[0][1+ly]-sl[0][ly];\n\t\t\t\t}\n\t\t\t\twhile ((ry<rcd[1])&&(rcf^stt[i].tot))\n\t\t\t\t{\n\t\t\t\t\t++ry;\n\t\t\t\t\trcf=sr[0][1+ry]-sr[0][ry];\n\t\t\t\t}\n\t\t\t\tmx(ans[stt[i].wz],max(lsum[stt[i].wz]+sl[0][ly].y+sl[0][ly].x*stt[i].tot,ss[0][sy].y+ss[0][sy].x*stt[i].tot));\n\t\t\t\tlsum[stt[i].wz]=max(lsum[stt[i].wz]+stt[i].tot*n+ssum[1],sr[0][ry].y+sr[0][ry].x*stt[i].tot);\n\t\t\t}\n\t\ttp=0;mt=-inf;\n\t}\n\tvoid init(const int nn,int *b)\n\t{\n\t\tmlz=tp=s[0]=0;\n\t\tfor (register int i=1;i<=nn;i++) s[i]=s[i-1]+(a[i]=b[i]);\n\t\tr[l[1]=1]=n=nn;build(1);\n\t}\n\tvoid ask(int x)\n\t{\n\n\t}\n\tvoid mdf(const Q x)\n\t{\n\t\tif (x.tot)//\u8be2\u95ee\n\t\t{\n\t\t\tif ((x.y<n)||(x.z>1))\n\t\t\t{\n\t\t\t\tz=x.z;y=x.y;\n\t\t\t\tif ((x.y<n)&&(x.z>1))//\u5c0f\u95ee\n\t\t\t\t{\n\t\t\t\t\tregister ll ls=0,s=0;\n\t\t\t\t\tfor (register int i=x.z;i<=x.y;i++) s=max(s,ls=max(ls,0ll)+(a[i]+(int)mlz));\n\t\t\t\t\tans[x.wz]=s;\n\t\t\t\t}\n\t\t\t\telse if (x.y<n)\n\t\t\t\t{\n\t\t\t\t\tregister ll ls=lsum[x.wz],s=0;\n\t\t\t\t\tfor (register int i=x.z;i<=x.y;i++) s=max(s,ls=max(ls,0ll)+(a[i]+(int)mlz));\n\t\t\t\t\tmx(ans[x.wz],s);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tregister ll ls=0,s=0;\n\t\t\t\t\tfor (register int i=x.z;i<=x.y;i++) s=max(s,ls=max(ls,0ll)+(a[i]+(int)mlz));\n\t\t\t\t\tans[x.wz]=s;lsum[x.wz]=ls;\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmt=min(mt,stt[++tp].tot=mlz);stt[tp].wz=x.wz;\n\t\t\t}\n\t\t}\n\t\telse//\u4fee\u6539\n\t\t{\n\t\t\tif ((x.y==n)&&(x.z==1)) mlz+=x.wz;\n\t\t\telse\n\t\t\t{\n\t\t\t\tsol();\n\t\t\t\tz=x.z;y=x.y;\n\t\t\t\tif ((dt=x.wz)==INF) return;\n\t\t\t\tfor (register int i=z;i<=y;i++) a[i]+=dt;\n\t\t\t\tmodify(1);\n\t\t\t}\n\t\t}\n\t}\n};\n```",
        "postTime": 1602559426,
        "uid": 29826,
        "name": "SSerxhs",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4118 \u3010[Ynoi2018]\u672b\u65e5\u65f6\u5728\u505a\u4ec0\u4e48?\u6709\u6ca1\u6709\u7a7a?\u53ef\u4ee5\u6765\u62ef\u6551\u5417?\u3011"
    },
    {
        "content": "[\u63a8\u9500\u535a\u5ba2](https://foreverlasting1202.github.io/2019/06/05/YNOI2018%E6%9C%AB%E6%97%A5/)\n\n\u4e00\u9053\u503c\u5f97\u4e00\u60f3\u4e0d\u503c\u5f97\u4e00\u5199\u7684\u5206\u5757\u8ba1\u7b97\u51e0\u4f55\u9898\u3002\n\n\u5199\u4e86\u4e00\u661f\u671f\uff08\u867d\u7136\u5176\u5b9e\u662f\u56e0\u4e3a\u6bcf\u5929\u65f6\u95f4\u90fd\u662f\u96f6\u6563\u7684\uff09\uff0c\u4f46\u8fd8\u662f\u8c03\u5f97\u597d\u7d2f\u554a\u3002\u6700\u540e\u6210\u529f\u4ece\u81ea\u5df1\u7684\u4ee3\u7801\u8c03\u6210\u4e86\u522b\u4eba\u7684\u4ee3\u7801\uff08\u9003\uff09\u3002\n\n\u8bf4\u4e00\u4e0b\u601d\u8def\u3002\u9996\u5148\u8003\u8651\u6700\u5927\u5b50\u6bb5\u548c\u662f\u4e2a\u4ec0\u4e48\u4e1c\u897f\u3002\u9664\u4e86\u732b\u951f\u8001\u5e08\u7684$DDP$\u505a\u6cd5\uff0c\u53e6\u5916\u7684\u52a8\u6001\u505a\u6cd5\u5176\u5b9e\u5c31\u662f\u7ef4\u62a4\u4e00\u4e2a\u533a\u95f4\u7684\u6700\u5927\u524d\u7f00\u548c$(lm)$\uff0c\u6700\u5927\u540e\u7f00\u548c$(rm)$\uff0c\u533a\u95f4\u548c$(sum)$\uff0c\u6700\u5927\u5b50\u6bb5\u548c$(mx)$\u3002\u5982\u679c\u662f\u5355\u70b9\u4fee\u6539\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u505a\u4e86\u3002\u4f46\u5982\u679c\u662f\u533a\u95f4\u4fee\u6539\u5462\uff1f\u4e8e\u662f\u53d1\u73b0\u9664\u4e86$sum$\u4ee5\u5916\u90fd\u4e0d\u597d\u76f4\u63a5\u7ef4\u62a4\u3002\u5c31\u6bd4\u5982$lm$\uff0c\u6211\u4eec\u8fd8\u8981\u8003\u8651\u540e\u9762\u7684\u4e1c\u897f\u9009\u4e86\u7a76\u7adf\u4e8f\u4e0d\u4e8f\u7684\u95ee\u9898\u3002\u7136\u800c\u8fd9\u9898\u6709\u4e2a\u5f88\u597d\u7684\u6761\u4ef6\uff0c\u5c31\u662f\u5b83\u52a0\u4e0a\u7684\u6570\u90fd\u662f\u6b63\u6570\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u533a\u95f4\u5185\u7684\u6570\u800c\u8a00\uff0c\u53ea\u6709\u4ece\u8d1f\u53d8\u6210\u6b63\u6570\uff0c\u4e0d\u4f1a\u4ece\u6b63\u6570\u53d8\u6210\u8d1f\u6570\uff0c\u4e8e\u662f\u5c31\u6709\u70b9\u60f3\u6cd5\u3002\n\n\u5f88\u660e\u663e\uff0c\u6bcf\u5f53\u540e\u9762\u7684\u67d0\u4e2a\u6570\u53d8\u5927\u5230\u4e00\u5b9a\u7a0b\u5ea6\u65f6\uff0c\u5c31\u53ef\u4ee5\u9009\u62e9\u66f4\u591a\u7684\u6570\uff0c\u76f4\u5230\u5168\u90e8\u90fd\u53ef\u4ee5\u9009\u3002\u8fd9\u662f\u4e2a\u5206\u6bb5\u51fd\u6570\uff0c\u800c\u4e14\u6bb5\u6570\u6700\u591a\u662f\u533a\u95f4\u6570\u7684\u4e2a\u6570\u3002\u4e8e\u662f\u5c31\u6709\u4e9b\u529e\u6cd5\u4e86\u3002\u5982\u679c\u8fd9\u4e2a\u533a\u95f4\u5168\u90e8\u540c\u65f6\u52a0\u4e00\u4e2a\u6570\uff0c\u90a3\u5c31\u76f4\u63a5\u5728\u5206\u6bb5\u51fd\u6570\u627e\u73b0\u5728\u5728\u54ea\u4e00\u6bb5\u5c31\u597d\u4e86\u3002\u7531\u4e8e\u53ef\u9009\u62e9\u7684\u6570\u53ea\u4f1a\u53d8\u591a\u4e0d\u4f1a\u53d8\u5c11\uff0c\u6240\u4ee5\u8fd9\u4e2a\u4e00\u76f4\u662f\u5355\u8c03\u7684\u3002\u5982\u679c\u8fd9\u4e2a\u533a\u95f4\u7684\u957f\u5ea6\u662f$n$\uff0c\u5219\u8fd9\u91cc\u7684\u590d\u6742\u5ea6\u6700\u591a\u662f$O(n)$\u3002\n\n\u4f46\u662f\u6709\u4e2a\u95ee\u9898\u5c31\u662f\u5982\u679c\u4e0d\u662f\u5168\u90e8\u540c\u65f6\u52a0\u4e00\u4e2a\u6570\u5462\uff1f\u9996\u5148\u53ef\u4ee5\u8003\u8651\u4e00\u4e2a\u66b4\u529b\u7684\u505a\u6cd5\uff0c\u5c31\u662f\u76f4\u63a5\u91cd\u6784\u8fd9\u4e2a\u533a\u95f4\u3002\u8fd9\u4e5f\u662f$shadowice$\u7684\u505a\u6cd5\u3002\u901a\u8fc7\u95f5\u79d1\u592b\u65af\u57fa\u51f8\u5305\u548c\u7684\u529e\u6cd5\uff0c\u518d\u52a0\u4e0a\u7c7b\u4f3c\u7ebf\u6bb5\u6811\u7684\u5206\u6cbb\u7ed3\u6784\uff0c\u53ef\u4ee5\u8ba9\u590d\u6742\u5ea6\u8fbe\u5230$O(nlogn)$\u3002\u4f46\u8fd9\u6837\u5e76\u4e0d\u662f\u6b63\u89e3\u7684\u60f3\u6cd5\u3002\u6211\u4eec\u8003\u8651\u8ba9\u8fd9\u4e2a\u5206\u6cbb\u7ed3\u6784\u5b9e\u4f53\u5316\uff0c\u76f4\u63a5\u53d8\u6210\u7ebf\u6bb5\u6811\u7ef4\u62a4\u3002\u8fd9\u6837\u7684\u8bdd\u76f4\u63a5\u9009\u62e9\u6253\u6807\u8bb0\uff0c\u5b8c\u6574\u7684\u76f4\u63a5\u50cf\u4e0a\u9762\u90a3\u4e2a\u60f3\u6cd5\u4fee\u6539\uff0c\u7136\u540e\u518d\u7528\u95f5\u79d1\u592b\u65af\u57fa\u51f8\u5305\u548c\u5408\u5e76\u4e24\u4e2a\u5b50\u6811\u7684\u51f8\u5305\u4eec\u3002\u6211\u4eec\u5206\u6790\u4e00\u4e0b\u8fd9\u91cc\u7684\u590d\u6742\u5ea6\uff0c\u8fd9\u6837\u5408\u5e76\u7684\u590d\u6742\u5ea6\u968f\u7740\u7ebf\u6bb5\u6811\u7684\u4e0d\u65ad\u9012\u51cf\u662f$O(n+\\frac {n}{2}+\\frac {n}{4}+...+1)$\uff0c\u8fd9\u4e2a\u4e1c\u897f\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u4e00\u4e0b\u8fd8\u662f$O(n)$\u7684\uff0c\u4e8e\u662f\u6211\u4eec\u5c31\u5b8c\u6210\u4fee\u6539\u64cd\u4f5c\u3002\n\n\u8be2\u95ee\u7684\u529e\u6cd5\u5c31\u5f88\u7b80\u5355\u4e86\uff0c\u76f4\u63a5\u67e5\u8fd9\u4e2a\u65f6\u5019\u7684$lm$\uff0c$rm$\uff0c$mx$\uff0c$sum$\u3002\u7136\u540e\u7ecf\u5178\u7684\u505a\u6cd5\u5408\u5e76\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\u3002\u5982\u679c\u6211\u4eec\u5bf9\u8fd9\u4e2a\u5e8f\u5217\u5206\u5757\uff0c\u6bcf\u5757\u4e3a$\\sqrt{n}$\u7684\u8bdd\uff0c\u590d\u6742\u5ea6\u5c31\u662f$O(n\\sqrt{n})$\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u7684\u8bdd\uff0c\u6bcf\u6b21\u5bf9\u4e8e\u5b8c\u6574\u7684\u4fee\u6539\u6211\u4eec\u8fd8\u8981\u5e73\u79fb\u8fd9\u4e9b\u4e2a\u51f8\u5305\uff0c\u8fd8\u8981\u6c42\u51f8\u5305\uff0c\u8fd8\u8981\u95f5\u79d1\u592b\u65af\u57fa\u51f8\u5305\u548c\uff0c\u4ee5\u53ca\u7ebf\u6bb5\u6811\u7684\u57fa\u672c\u64cd\u4f5c\u5c31\u53ef\u4ee5\u4e86\u3002\u7136\u540e\u662f\u65f6\u5019\u7ec6\u8282\u8d85\u7ea7\u591a\uff0c\u6211\u968f\u968f\u4fbf\u4fbf\u5c31\u628a\u95f5\u79d1\u592b\u65af\u57fa\u51f8\u5305\u548c\u5199\u9519\u4e86\uff0c\u4e8e\u662f\u6539\u6210\u4e86\u522b\u4eba\u4ee3\u7801\u7684\u6a21\u6837\uff08\u5176\u5b9e\u5c31\u662f$yfz$\u795e\u4ed9\u7684\u4ee3\u7801\u5566\uff09\uff0c\u7136\u540e\u5361\u5e38\u7684\u529e\u6cd5\u5b66\u4e60\u4e86\u4e00\u4e0b$shadowice$\u7684\u529e\u6cd5\u3002\u8bf4\u767d\u4e86\uff0c\u6211\u7684\u4ee3\u7801\u5c31\u662f\u96c6\u5404\u5bb6\u4e4b\u957f\u7684\u7248\u672c\u5566\u3002\n\ncode:\n```cpp\n//2019.6.5 by ljz\n#pragma GCC optimize(2)\n#pragma GCC optimize(3)\n#pragma GCC optimize(\"Ofast\")\n#include<bits/stdc++.h>\nusing namespace std;\n#define res register int\n#define LL long long\n#define RG register\ntypedef pair<LL,LL> Pair;\n#define mp make_pair\n#define fi first\n#define se second\ninline char gc() {\n    static char buf[100000],*p1,*p2;\n    return p1==p2&&(p2=(p1=buf)+fread(buf,1,100000,stdin),p1==p2)?EOF:*p1++;\n}\ninline int read() {\n    res s=0,ch=gc(),w=1;\n    while(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=gc();}\n    while(ch>='0'&&ch<='9')s=s*10+ch-'0',ch=gc();\n    return s*w;\n}\nconst int N=1e5+10,B=510+10;\nnamespace MAIN {\n    inline LL cal(const RG Pair &x,const RG LL &val){\n        return x.fi*val+x.se;\n    }\n    inline Pair operator + (const RG Pair &A,const RG Pair &B){\n        return mp(A.fi+B.fi,A.se+B.se);\n    }\n    inline bool cmp(const RG Pair &A,const RG Pair &B,const RG LL &x){\n        return cal(A,x)<cal(B,x);\n    }\n    inline bool cmp(const RG Pair &A,const RG Pair &B,const RG Pair &C){\n        return (A.se-C.se)*(A.fi-B.fi)>=(A.se-B.se)*(A.fi-C.fi);\n    }\n    inline bool cmp(const RG Pair &A,const RG Pair &B,const RG Pair &C,const RG Pair &D){\n        return (C.se-D.se)*(A.fi-B.fi)>=(A.se-B.se)*(C.fi-D.fi);\n    }\n    inline bool cmp(const RG Pair &A,const RG Pair &B){\n        return A.fi!=B.fi?A.fi<B.fi:A.se>B.se;\n    }\n    Pair mem[N*100],*ptr=mem,st[N<<2],st0[N<<2],st1[N<<2];\n    struct TU{\n        Pair *a;\n        int siz;\n        TU() {siz=0;}\n        inline void Cover(const RG Pair *A,const res &sz){\n            siz=sz;\n            for(res i=1;i<=sz;i++)a[i]=A[i];\n        }\n        inline void mod(const RG LL &x){\n            res p=1;\n            while(p<siz&&cmp(a[p],a[p+1],x))p++;\n            for(res i=p;i<=siz;i++)a[i-p+1]=mp(a[i].fi,a[i].se+a[i].fi*x);\n            siz-=p-1;\n        }\n        inline void mod(const RG LL &x,res &p){\n            while(p<siz&&cmp(a[p],a[p+1],x))p++;\n        }\n        inline void get(const res &len){\n            a=ptr,ptr+=len+1;\n        }\n    };\n    inline void add_TU(res &top,const RG Pair &x){\n    \tif(top&&x.fi==st[top].fi){st[top].se=max(st[top].se,x.se);return;}\n    \twhile(top>1&&cmp(st[top-1],st[top],x))top--;\n    \tst[++top]=x;\n    }\n    inline void Minkowski(const RG TU &lm,const RG TU &rm,const RG TU &ansl,const RG TU &ansr,RG TU &ret){\n    \tres top0=0,top1=0,i=1,j=1,szl=lm.siz,szr=rm.siz,Top=0;\n    \tfor(;i<szl||j<szr;)st0[++top0]=lm.a[i]+rm.a[j],i==szl?j++:(j==szr?i++:(cmp(lm.a[i],lm.a[i+1],rm.a[j],rm.a[j+1])?j++:i++));\n        st0[++top0]=lm.a[szl]+rm.a[szr],i=j=1,szl=ansl.siz,szr=ansr.siz;\n        for(;i<=szl||j<=szr;)i==szl+1?st1[++top1]=ansr.a[j++]:(j==szr+1?st1[++top1]=ansl.a[i++]:(st1[++top1]=cmp(ansl.a[i],ansr.a[j])?ansl.a[i++]:ansr.a[j++]));\n        for(i=j=1,szl=top0,szr=top1;i<=szl||j<=szr;)i==szl+1?add_TU(Top,st1[j++]):(j==szr+1?add_TU(Top,st0[i++]):(add_TU(Top,cmp(st0[i],st1[j])?st0[i++]:st1[j++])));\n        ret.Cover(st,Top);\n    }\n    inline void merge(const RG TU &A,const RG TU &B,const RG LL &sum,const res &len,RG TU &ret){\n        res Top=0;\n        for(res i=1,sz=A.siz;i<=sz;i++)st[++Top]=A.a[i];\n        for(res i=1,sz=B.siz;i<=sz;i++)add_TU(Top,mp(len+B.a[i].fi,sum+B.a[i].se));\n        ret.Cover(st,Top);\n    }\n    struct TR{\n        int len;\n        TU pre,suf,ans;\n        LL sum,laz;\n        inline void init(const RG LL &val){\n            sum=val,pre.siz=1,pre.a[1]=mp(1,val),suf.siz=1,suf.a[1]=mp(1,val),ans.siz=1,ans.a[1]=mp(1,val);\n        }\n        inline void Change(const RG LL &val){\n        \tpre.mod(val),suf.mod(val),ans.mod(val);\n        }\n        inline void change(const RG LL &val){\n            pre.mod(val),suf.mod(val),ans.mod(val),sum+=len*val,laz+=val;\n        }\n        inline void mod(const RG LL &TG,const res &val,res &ansp,res &prep,res &sufp){\n            laz+=val,sum+=len*val,ans.mod(TG,ansp),pre.mod(TG,prep),suf.mod(TG,sufp);\n        }\n        inline void get(){\n            pre.get(len),suf.get(len),ans.get(len);\n        }\n    };\n    struct P{\n        LL lm,rm,sum,mx;\n        P() {}\n        P(RG LL lm,RG LL rm,RG LL sum,RG LL mx):lm(lm),rm(rm),sum(sum),mx(mx) {}\n    };\n    inline P operator + (const RG P &A,const RG P &B){\n        return P(max(A.lm,A.sum+B.lm),max(B.rm,B.sum+A.rm),A.sum+B.sum,max({A.rm+B.lm,A.mx,B.mx}));\n    }\n    LL qaq[B];\n    struct BL{\n        LL a[B],tag,mx,lm,rm;\n        int n,ansp,prep,sufp;\n        TR tr[B<<2];\n        inline void pushup(const res &rt){\n            res ls=rt<<1,rs=rt<<1|1;\n            tr[rt].sum=tr[ls].sum+tr[rs].sum,merge(tr[ls].pre,tr[rs].pre,tr[ls].sum,tr[ls].len,tr[rt].pre),merge(tr[rs].suf,tr[ls].suf,tr[rs].sum,tr[rs].len,tr[rt].suf),Minkowski(tr[ls].suf,tr[rs].pre,tr[ls].ans,tr[rs].ans,tr[rt].ans);\n        }\n        void build(res rt,res l,res r){\n            tr[rt].len=r-l+1,tr[rt].laz=tr[rt].sum=0,tr[rt].get();\n            if(l==r){tr[rt].init(a[l]);return;}\n            res mid=(l+r)>>1;\n            build(rt<<1,l,mid),build(rt<<1|1,mid+1,r),pushup(rt);\n        }\n        inline void pushdown(const res &rt){\n            if(!tr[rt].laz)return;\n            tr[rt<<1].change(tr[rt].laz),tr[rt<<1|1].change(tr[rt].laz),tr[rt].laz=0;\n        }\n        void modify(res rt,res l,res r,const res &L,const res &R,const res &val){\n            if(L<=l&&r<=R){tr[rt].change(val);return;}\n            pushdown(rt);\n            res mid=(l+r)>>1;\n            if(L<=mid)modify(rt<<1,l,mid,L,R,val);\n            if(R>mid)modify(rt<<1|1,mid+1,r,L,R,val);\n            pushup(rt);\n        }\n        inline void push(){\n            ansp=prep=sufp=1;\n            if(!tag)return;\n            for(res i=1;i<=n;i++)a[i]+=tag;\n            tr[1].Change(tag),tag=0;\n        }\n        inline void blmod(const res &l,const res &r,const res &val){\n            for(res i=l;i<=r;i++)a[i]+=val;\n        }\n        inline void mod(const res &val){\n            tag+=val,tr[1].mod(tag,val,ansp,prep,sufp),mx=cal(tr[1].ans.a[ansp],tag),lm=cal(tr[1].pre.a[prep],tag),rm=cal(tr[1].suf.a[sufp],tag);\n        }\n        inline LL mxcalc(const res &l,const res &r){\n            res tot=0;\n            for(res i=l;i<=r;i++)qaq[++tot]=a[i]+tag;\n            for(res i=1;i<=tot;i++)qaq[i]+=qaq[i-1];\n            RG LL mn=0,ret=0;\n            for(res i=1;i<=tot;i++)ret=max(ret,qaq[i]-mn),mn=min(mn,qaq[i]);\n            return ret;\n        }\n        inline P calc(const res &l,const res &r){\n            RG P ret=P(0,0,0,0);\n            res tot=0;\n            for(res i=l;i<=r;i++)qaq[++tot]=a[i]+tag;\n            for(res i=1;i<=tot;i++)ret.sum+=qaq[i],ret.lm=max(ret.lm,ret.sum);\n            ret.sum=0;\n            for(res i=tot;i;i--)ret.sum+=qaq[i],ret.rm=max(ret.rm,ret.sum);\n            RG LL mn=0;\n            for(res i=1;i<=tot;i++)qaq[i]+=qaq[i-1];\n            for(res i=1;i<=tot;i++)ret.mx=max(ret.mx,qaq[i]-mn),mn=min(mn,qaq[i]);\n            return ret;\n        }\n        inline P calc(){\n        \treturn P(lm,rm,tr[1].sum,mx);\n        }\n    }A[B];\n    int a[N],pl[N],pr[N],Mp[N],n,m,block;\n    inline void MAIN(){\n        n=read(),m=read(),block=int(sqrt(n));\n        for(res i=1;i<=n;i++)a[i]=read();\n        for(res i=1;i<=n;i++)pr[i/block]=i;\n        for(res i=n;i;i--)pl[i/block]=i;\n        for(res i=0;i<=n/block;i++){\n            for(res j=pl[i];j<=pr[i];j++)A[i].a[j-pl[i]+1]=a[j],Mp[j]=j-pl[i]+1;\n            A[i].n=pr[i]-pl[i]+1,A[i].build(1,1,A[i].n),A[i].push(),A[i].mod(0);\n        }\n        while(m--){\n            res opt=read(),l=read(),r=read();\n            if(opt==1){\n                res x=read();\n                if(l/block==r/block){\n                    res ID=l/block;\n                    A[ID].push(),A[ID].blmod(Mp[l],Mp[r],x),A[ID].modify(1,1,A[ID].n,Mp[l],Mp[r],x),A[ID].mod(0);\n                }\n                else {\n                    res ID=l/block;\n                    A[ID].push(),A[ID].blmod(Mp[l],A[ID].n,x),A[ID].modify(1,1,A[ID].n,Mp[l],A[ID].n,x),A[ID].mod(0);\n                    ID=r/block,A[ID].push(),A[ID].blmod(1,Mp[r],x),A[ID].modify(1,1,A[ID].n,1,Mp[r],x),A[ID].mod(0);\n                    for(res i=l/block+1;i<ID;i++)A[i].mod(x);\n                }\n            }\n            else {\n                if(l/block==r/block)printf(\"%lld\\n\",A[l/block].mxcalc(Mp[l],Mp[r]));\n                else {\n                    RG P ret=A[l/block].calc(Mp[l],A[l/block].n);\n                    for(res i=l/block+1;i<r/block;i++)ret=ret+A[i].calc();\n                    ret=ret+A[r/block].calc(1,Mp[r]),printf(\"%lld\\n\",ret.mx);\n                }\n            }\n        }\n    }\n}\nint main() {\n    MAIN::MAIN();\n    return 0;\n}\n```",
        "postTime": 1559719633,
        "uid": 32878,
        "name": "foreverlasting",
        "ccfLevel": 7,
        "title": "\u3010Ynoi2018\u3011\u672b\u65e5\u65f6\u5728\u505a\u4ec0\u4e48?\u6709\u6ca1\u6709\u7a7a?\u53ef\u4ee5\u6765\u62ef\u6551\u5417?"
    },
    {
        "content": "2022.7.30upd: \u4fee\u6539\u4e86\u4e00\u4e2a\u5c0f\u9519\u8bef\u3002\n\n# \u6df1\u6d45\u503c\u85cf\u7684\u7b2c\u516d\u5206\u5757\n\n**\u6ce8\uff1a\u672c\u9898\u89e3\u5982\u65e0\u7279\u6b8a\u8bf4\u660e\u5747\u9ed8\u8ba4 $n,m$ \u540c\u9636**\n# \u524d\u7f6e\u77e5\u8bc6\n-  \u7ebf\u6bb5\u6811\u3001\u5206\u5757\n\n\u6765\u505a\u8fd9\u9898\u7684\u4eba\u5e94\u8be5\u90fd\u4f1a\u4e86\u5427\u3002\n- \u4e0d\u5e26\u4fee / \u5355\u70b9\u4fee\u6539\u533a\u95f4\u6700\u5927\u5b50\u6bb5\u548c\n\n\u8fd9\u662f\u4e2a\u7ecf\u5178\u95ee\u9898\uff0c\u4e0d\u4f1a\u7684\u53ef\u4ee5\u770b\u4e00\u770b [SP1043 GSS1](https://www.luogu.com.cn/problem/SP1043) \u6216\u8005 [P4513 \u5c0f\u767d\u901b\u516c\u56ed](https://www.luogu.com.cn/problem/P4513)\u3002\n- \u7ebf\u6bb5\u6811\u7ef4\u62a4\u5206\u6bb5\u51fd\u6570\n\n\u8fd9\u4e2a\u5176\u5b9e\u633a\u96be\u7684\u6211\u5f85\u4f1a\u7a0d\u5fae\u8bb2\u4e00\u8bb2\u3002\n- \u57fa\u6570\u6392\u5e8f\n\nVersion5 \u662f\u533a\u95f4\u52a0\u6b63\u6570\u6240\u4ee5\u7528\u4e0d\u7740\uff0c\u4f46\u662f\u8fd9\u9898\u662f Version6\uff0c\u4e5f\u5c31\u662f\u533a\u95f4\u52a0\u4efb\u610f\u6570\uff0c\u6240\u4ee5\u9700\u8981\u7528\u5230\u57fa\u6570\u6392\u5e8f\u3002\n\n# \u5f31\u5316\u7248\n\u5148\u8003\u8651\u5168\u5c40\u52a0\u533a\u95f4\u6700\u5927\u5b50\u6bb5\u548c\uff0c\u5373 [P5073 [Ynoi2015] \u4e16\u4e0a\u6700\u5e78\u798f\u7684\u5973\u5b69](https://www.luogu.com.cn/problem/P5073)\u3002\n\n\u8fd8\u8bb0\u5f97\u4e0d\u5e26\u4fee / \u5355\u70b9\u4fee\u6539\u533a\u95f4\u6700\u5927\u5b50\u6bb5\u548c\u600e\u4e48\u505a\u5417\uff1f\n\n\u5b9a\u4e49\uff1a\n\n- $sum_i$ \u4e3a\u8282\u70b9 $i$ \u5185\u90e8\u7684\u548c\u3002\n- $L_i$ \u4e3a $i$ \u8282\u70b9\u5185\u90e8\u7684\u6700\u5927\u524d\u7f00\u548c\u3002\n- $R_i$ \u4e3a $i$ \u8282\u70b9\u5185\u90e8\u7684\u6700\u5927\u540e\u7f00\u548c\u3002\n- $ans_i$ \u4e3a $i$ \u8282\u70b9\u5185\u90e8\u7684\u6700\u5927\u5b50\u6bb5\u548c\u3002\n\n\u90a3\u4e48\u663e\u7136\u6709\uff1a\n\n- $sum_i=sum_{lson}+sum_{rson}$\n- $L_i=\\max(L_{lson},sum_{lson}+L_{lson})$\n- $R_i=\\max(R_{rson},sum_{rson}+R_{lson})$\n- $ans_i=\\max(ans_{lson},ans_{rson},R_{lson}+L_{rson})$\n\n\u90a3\u4e48\u8fd9\u91cc\u6211\u4eec\u7ef4\u62a4\u7684\u662f\u540e\u4e09\u8005\u7684\u5206\u6bb5\u51fd\u6570\uff0c\u4ee4\uff1a\n\n- $L(x)$\n- $R(x)$\n- $ans(x)$\n\n\u5206\u522b\u4e3a\u8be5\u8282\u70b9\u6574\u4f53\u52a0\u4e86 $x$ \u540e\u7684\u6700\u5927\u524d\u7f00\u548c\uff0c\u6700\u5927\u540e\u7f00\u548c\uff0c\u6700\u5927\u5b50\u6bb5\u548c\u3002\u5b83\u4eec\u7684\u5408\u5e76\u65b9\u5f0f\u540c\u4e0a\u3002\n\n\u8fd9\u91cc\u7684\u5206\u6bb5\u51fd\u6570\u662f\u51e0\u6bb5\u4e00\u6b21\u51fd\u6570\u3002\u5728\u7ebf\u6bb5\u6811\u4e0a\u7684\u6bcf\u4e00\u4e2a\u8282\u70b9\u6211\u4eec\u7ef4\u62a4\u6bcf\u4e00\u6bb5\u7684\u65ad\u70b9\u548c\u4e00\u6b21\u51fd\u6570\u53c2\u6570\u3002\u56e0\u4e3a\u4e00\u6b21\u51fd\u6570\u7684\u6bb5\u6570\u662f\u4e0d\u540c\u4e14\u4e0e\u7ebf\u6bb5\u6811\u8282\u70b9\u6240\u4ee3\u8868\u7684\u533a\u95f4\u957f\u5ea6\u6709\u5173\uff0c\u6240\u4ee5\u8981\u57fa\u4e8e vector \u5b9e\u73b0\u3002\u6613\u8bc1\u7ebf\u6bb5\u6811\u8282\u70b9\u6240\u4ee3\u8868\u533a\u95f4\u957f\u5ea6\u7684\u603b\u548c\u4e3a $n\\log n$ \uff0c\u6240\u4ee5\u7a7a\u95f4\u590d\u6742\u5ea6\u662f $O(n\\log n)$\u3002\n\n\u4fee\u6539\u7684\u65f6\u5019\u6253\u4e00\u4e2a\u5168\u5c40\u7684 lazytag \uff0c\u67e5\u8be2\u7684\u65f6\u5019\u52a0\u4e0a\u53bb\u5373\u53ef\u3002\n\n\u67e5\u8be2\u7684\u65f6\u5019\u6211\u4eec\u627e\u5230\u8986\u76d6\u7684 $\\log$ \u4e2a\u8282\u70b9\uff0c\u5728\u6bcf\u4e2a\u8282\u70b9\u5185\u90e8\u4e8c\u5206\u67e5\u627e\u65ad\u70b9\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log^2n)$ \uff0c\u65e0\u6cd5\u901a\u8fc7\u672c\u9898\u3002\n\n\u7136\u540e\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u8fd9\u9898\u6ca1\u6709\u5f3a\u5236\u5728\u7ebf\u3002\n\n\u6240\u4ee5\u6211\u4eec\u628a\u64cd\u4f5c\u79bb\u7ebf\u4e0b\u6765\uff0c\u57fa\u6570\u6392\u5e8f\u540e\u8f6c\u6362\u4e3a\u5168\u5c40\u52a0\u6b63\u6570\u3002\n\n\u5728\u6bcf\u4e00\u4e2a\u8282\u70b9\u5185\u6211\u4eec\u8bbe\u7f6e\u4e00\u4e2a\u6307\u9488\u8bb0\u5f55\u4e0a\u6b21\u51fa\u73b0\u7684\u4e00\u6b21\u51fd\u6570\u6bb5\uff0c\u521d\u59cb\u6307\u5411\u6700\u5c0f\u6bb5\u3002\u8fd9\u6837\u6bcf\u6b21\u67e5\u627e\u65f6\u6307\u9488\u4ece\u4e0a\u6b21\u7684\u4f4d\u7f6e\u5f80\u53f3\u67e5\uff0c\u5747\u644a\u4e4b\u540e\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\log n)$\u3002\n\n# \u6b63\u7247\u5f00\u59cb\n\u4e0a\u8ff0\u7b97\u6cd5\u4e0d\u80fd\u652f\u6301\u533a\u95f4\u52a0\u662f\u56e0\u4e3a pushup \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n)$\uff0c\u90a3\u4e48\u521d\u59cb\u5316\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\log n)$ \uff0c\u4f46\u662f\u5982\u679c\u5355\u70b9 / \u533a\u95f4\u4fee\u6539\u7684\u8bdd\uff0c\u5355\u6b21\u64cd\u4f5c\u65f6\u95f4\u590d\u6742\u5ea6\u5c06\u8fbe\u5230 $O(n+\\frac{n}{2}+\\frac{n}{4}+\u00b7\u00b7\u00b7+1)=O(n)$\uff0c\u663e\u7136\u662f\u8fc7\u4e0d\u53bb\u7684\u3002\n\n**\u90a3\u4e48\u6211\u4eec\u60f3\u60f3\uff0c\u4ec0\u4e48\u6570\u636e\u7ed3\u6784\u662f\u4e0d\u7528 pushup \u7684\u5462\uff1f**\n\n\u5206\u5757\u3002\n\n\u5c06\u5e8f\u5217\u5206\u5757\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u5757\u6211\u4eec\u90fd\u5f00\u4e00\u68f5\u4e0a\u9762\u6240\u8bb2\u7684\u7ebf\u6bb5\u6811\u3002\u8bbe\u5757\u957f\u4e3a $m$\uff0c\u90a3\u4e48\uff1a\n\n- \u6574\u5757\u67e5\u8be2\n\n\u5728\u7ebf\u6bb5\u6811\u6839\u8282\u70b9\u4e0a\u4e8c\u5206\u67e5\u627e\u65ad\u70b9\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\log m)$\u3002\n\n- \u96f6\u6563\u5757\u67e5\u8be2\n\n\u5728\u7ebf\u6bb5\u6811\u4e0a\u6240\u8986\u76d6\u7684 $\\log m$ \u4e2a\u8282\u70b9\u4e0a\u4e8c\u5206\u67e5\u627e\u65ad\u70b9\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\log^2 m)$\u3002\n\n- \u6574\u5757\u4fee\u6539\n\n\u5bf9\u4e8e\u7ebf\u6bb5\u6811\u6765\u8bf4\u5c31\u662f\u5168\u5c40\u52a0\uff0c$O(1)$ \u6253\u61d2\u60f0\u6807\u8bb0\u5373\u53ef\u3002\n\n- \u96f6\u6563\u5757\u4fee\u6539\n\n\u91cd\u6784\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(m\\log m)$\u3002\n\n$m$ \u53d6 $\\sqrt{n}$ \u6700\u4f18\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\sqrt{n}\\log n)$\u3002\n\n# \u4f18\u5316\n\u96f6\u6563\u5757\u4fee\u6539\u7684\u65f6\u5019\u771f\u7684\u6709\u5fc5\u8981\u628a\u7ebf\u6bb5\u6811\u6574\u4e2a\u91cd\u6784\u5417\uff1f\n\n\u8fd8\u8bb0\u5f97\u6211\u4eec\u4e4b\u524d\u8bf4\u7684\u5417\uff1f\u8fd9\u4e2a\u7ebf\u6bb5\u6811\u533a\u95f4\u4fee\u6539\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n)$ \u7684\u3002\n\n\u6240\u4ee5\u96f6\u6563\u5757\u6211\u4eec\u76f4\u63a5\u533a\u95f4\u4fee\u6539\u5373\u53ef\uff0c\u6ce8\u610f\u7ebf\u6bb5\u6811\u4e0a\u7684\u61d2\u60f0\u6807\u8bb0\u522b\u548c\u5206\u5757\u7684\u641e\u6df7\u3002\n\n\u8fd9\u6837\u96f6\u6563\u5757\u4fee\u6539\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u6210\u529f\u4f18\u5316\u5230\u4e86 $O(m)$\u3002\n\n\u8fd8\u6709\u4e00\u4e2a\u57fa\u672c\u64cd\u4f5c\u5c31\u662f\u79bb\u7ebf\u7136\u540e\u9010\u5757\u5904\u7406\uff0c\u987a\u4fbf\u628a\u7a7a\u95f4\u4f18\u5316\u5230 $O(n)$\uff0c\u4e0d\u7136\u8fd9\u9898 64MB \u522b\u60f3\u8fc7\u4e86\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u5757\u90fd\u8fdb\u884c\u57fa\u6570\u6392\u5e8f\uff0c\u8fd9\u6837\u53ef\u4ee5\u628a\u6574\u5757\u67e5\u8be2\u4f18\u5316\u5230 $O(1)$\uff0c\u96f6\u6563\u5757\u67e5\u8be2\u4f18\u5316\u5230 $O(\\log n)$\uff0c\u4e0d\u8fc7\u96f6\u6563\u5757\u67e5\u8be2\u5e76\u4e0d\u662f\u590d\u6742\u5ea6\u74f6\u9888\uff0c\u6240\u4ee5\u4f60\u54ea\u6015\u5199\u4e2a $O(m)$ \u7684\u5927\u66b4\u529b\u90fd\u4e0d\u4f1a\u5bf9\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u6709\u5f71\u54cd\u3002\n\n\u8fd9\u91cc\u6709\u4e2a\u7ec6\u8282\u5c31\u662f\u56e0\u4e3a\u6709\u96f6\u6563\u5757\u4fee\u6539\u7684\u5b58\u5728\u6240\u4ee5\u4e0d\u80fd\u76f4\u63a5\u57fa\u6570\u6392\u5e8f\uff0c\u4f46\u662f\u6211\u4eec\u4ed4\u7ec6\u4e00\u60f3\uff0c\u5373\u4f7f\u5728\u96f6\u6563\u5757\u4fee\u6539\u65f6\u628a\u67e5\u8be2\u7684\u6307\u9488\u79fb\u5230\u6700\u5de6\u6bb5\u4e5f\u6ca1\u6709\u5173\u7cfb\uff0c\u56e0\u4e3a\u628a\u6307\u9488\u79fb\u5230\u6700\u5de6\u7aef\u5176\u5b9e\u5747\u644a\u4e00\u4e0b\u76f8\u5f53\u4e8e\u589e\u52a0 $O(\\sqrt{n})$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u4f46\u662f\u6bcf\u6b21\u4fee\u6539\u65f6\u6700\u591a\u4e5f\u53ea\u6709 $2$ \u4e2a\u96f6\u6563\u5757\u3002\u6240\u4ee5\u8fd9\u90e8\u5206\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u662f $O(n\\sqrt{n})$ \u7684\u3002\n\n\u53d6 $m=\\sqrt{n}$\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\sqrt{n})$\u3002\n\n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\u3002",
        "postTime": 1657529776,
        "uid": 264463,
        "name": "\u6dfb\u54e5",
        "ccfLevel": 4,
        "title": "P4118 [Ynoi2018] \u672b\u65e5\u65f6\u5728\u505a\u4ec0\u4e48\uff1f\u6709\u6ca1\u6709\u7a7a\uff1f\u53ef\u4ee5\u6765\u62ef\u6551\u5417\uff1f \u9898\u89e3"
    },
    {
        "content": "\u56e0\u4e3a\u5927\u5bb6\u5199\u7684\u90fd\u662f\u5e8f\u5217\u5206\u5757\u57fa\u6570\u6392\u5e8f\u5957\u95f5\u53ef\u592b\u65af\u57fa\u548c\uff0c\u4e8e\u662f\u6211\u6765\u5199\u4e00\u4e2a\u65e2\u4e0d\u7528\u5e8f\u5217\u5206\u5757\u4e5f\u4e0d\u7528\u95f5\u53ef\u592b\u7684\u5bf9\u65f6\u95f4\u8f74\u5206\u5757\u52a0\u666e\u901a\u51f8\u5305\u7684\u7248\u672c\u3002\n\n\u65f6\u95f4\u8f74\u5206\u5757\u662f\u597d\u6587\u660e\u3002\n\n## \u5f31\u5316\u7248\n\n\u9996\u5148\uff0c\u5148\u8003\u8651\u4e00\u4e2a\u5168\u5c40\u4fee\uff0c\u5168\u5c40\u67e5\u6700\u5927\u524d\u7f00\u548c\u3001\u6700\u5c0f\u524d\u7f00\u548c\uff0c\u4ee5\u53ca\u4e00\u4e2a\u5168\u5c40\u6700\u5927\u5b50\u6bb5\u548c\u7684\u7ed3\u6784\u600e\u4e48\u505a\uff1f\n\n\u5148\u5c06\u6574\u4e2a\u5e8f\u5217\u505a\u4e00\u4e2a\u524d\u7f00\u548c\u3002\u8003\u8651\u7b2c $i$ \u4e2a\u4f4d\u7f6e\uff0c\u5168\u5c40\u52a0\u4e86 $d$ \u4e4b\u540e\uff0c\u8fd9\u4e2a\u4f4d\u7f6e\u4e0a\u7684\u503c\u53d8\u4e3a $S_i={S_i}_0+i\\times d$\n\n\u8fd9\u662f\u4e00\u4e2a\u5173\u4e8e $d$ \u7684\u4e00\u6b21\u51fd\u6570\u3002\u4e8e\u662f\u6211\u4eec\u628a\u5b83\u5f53\u4f5c\u4e00\u6761\u76f4\u7ebf\uff0c\u4e8e\u662f\u6211\u4eec\u53ea\u9700\u8981\u7ef4\u62a4\u8fd9\u4e2a $S_i$ \u5373\u53ef\u3002\n\n\u6211\u4eec\u53d1\u73b0\u8fd9\u4e24\u4e2a\u4e1c\u897f\u53ef\u4ee5\u770b\u6210\u591a\u4e2a\u534a\u5e73\u9762\u7684\u4ea4\uff0c\u4e14\u534a\u5e73\u9762\u662f\u9012\u589e\u7684\u3002\u4e8e\u662f\u6211\u4eec\u8003\u8651\u6bcf\u4e2a\u70b9\u7ef4\u62a4\u7531\u8fd9\u591a\u4e2a\u76f4\u7ebf\u5206\u522b\u6784\u6210\u7684\u4e0a\u51f8\u58f3\u548c\u4e0b\u51f8\u58f3\u3002\n\n\u4e0b\u51f8\u58f3\u540c\u7406\u3002\n\n\u7136\u540e\u8003\u8651\u5168\u5c40\u6700\u5927\u5b50\u6bb5\u548c\u3002\n\n\u6211\u4eec\u5bf9\u6bcf\u4e2a\u70b9\u7ef4\u62a4 $R,L$ \u4e24\u4e2a\u6570\u7ec4\uff0c\u8868\u793a\u4ee5\u8fd9\u4e2a\u70b9\u4e3a\u5de6\u7aef\u70b9/\u53f3\u7aef\u70b9\u7684\u6240\u6709\u5e8f\u5217\u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u975e\u8d1f\u9700\u8981\u7684\u6700\u5c0f\u7684\u52a0\u503c\u3002\n\n\u8fd9\u4e2a\u53ef\u4ee5\u5728 $i-S$ \u56fe\u91cc\u8fc5\u901f\u7ebf\u6027\u7ef4\u62a4\u3002\u5177\u4f53\u7684\uff0c\u6211\u4eec\u8003\u8651 $L$\uff0c\u5219\u6709\n\n$$\n\tL(i)=\\min{\\dfrac{S_i-S_j}{j-i}}=-\\max \\dfrac{S_i-S_j}{i-j}\n$$\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u7ef4\u62a4\u4e00\u4e2a\u659c\u7387\u4f18\u5316\u4e86\u3002\u5177\u4f53\u7684\uff0c\u6211\u4eec\u4ece\u53f3\u5f80\u5de6\u626b\u63cf\u8fc7\u53bb\uff0c\u6bcf\u6b21\u5f80\u5f53\u524d\u7684\u51f8\u5305\u91cc\u52a0\u4e00\u4e2a\u6570\u7684\u540c\u65f6\u5728\u5f53\u524d\u51f8\u5305\u91cc\u505a\u4e00\u4e0b\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u7b54\u6848\u662f\u5355\u8c03\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u51f8\u5305\u4e0a\u66b4\u529b\u505a\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(N)$\n\n\u7136\u540e\u6211\u4eec\u8003\u8651\u5982\u4f55\u6839\u636e\u8fd9\u4e2a\u8ba1\u7b97\u6700\u5927\u5b50\u6bb5\u548c\u3002\u5bb9\u6613\u60f3\u5230\u7684\u662f\uff0c\u6700\u5927\u5b50\u6bb5\u4e00\u5b9a\u662f\u6781\u5927\u5b50\u6bb5\uff1a\u82e5\u6709\u4e00\u4e2a\u5b50\u6bb5 $B$ \u4e0e\u5b50\u6bb5 $A$ \u76f8\u4ea4\u3001\u76f8\u63a5\u89e6\u6216\u76f8\u5305\u542b\uff0c\u5219\u5408\u5e76 $A$ \u4e0e $B$ \u540e\u5f97\u5230\u7684\u5b50\u6bb5\u548c\u4e00\u5b9a\u5927\u4e8e $B$ \u7684\u5b50\u6bb5\u548c\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u8003\u8651\u5230\uff0c\u6781\u5927\u5b50\u6bb5\u4e2d\u4e00\u5b9a\u4e0d\u5b58\u5728\u8d1f\u6570\u524d\u7f00\u548c\u4e0e\u8d1f\u6570\u540e\u7f00\u548c\u3002\u5373\uff0c\u4e00\u4e2a\u6781\u5927\u5b50\u6bb5\u5185\u7684\u6240\u6709\u6570\uff0c\u90fd\u6ee1\u8db3\u4ee5\u5176\u4e3a\u5de6\u7aef\u70b9/\u53f3\u7aef\u70b9\u7684\u5b50\u6bb5\u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u6bd4\u4ed6\u5927\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u60f3\u5230\u7ef4\u62a4\u6309\u7167\u5de6\u53f3\u8fb9\u754c\u7ef4\u62a4\u6781\u5927\u5b50\u6bb5\uff0c\u7136\u540e\u968f\u7740 $d$ \u7684\u589e\u52a0\u6309\u987a\u5e8f\u5408\u5e76\u6781\u5927\u5b50\u6bb5\uff0c\u5e76\u4e14\u6700\u540e\u628a\u6240\u6709\u6781\u5927\u5b50\u6bb5\u8f6c\u4e00\u6b21\u51fd\u6570\u653e\u5230\u51f8\u5305\u91cc\u5c31\u884c\u3002\n\n\n## \u5f3a\u5316\u7248\n\n\u6211\u4eec\u53d1\u73b0\u8fd9\u6b21\u662f\u533a\u95f4\u4fee\u3002\n\n\u4e8e\u662f\u6211\u4eec\u6bcf $\\sqrt N$ \u4e2a\u8be2\u95ee\u5206\u4e00\u7ec4\u3002\n\n\u8fd9\u6837\u5b50\uff0c\u5e8f\u5217\u5c31\u88ab\u8fd9\u4e9b\u8be2\u95ee\u5206\u6210\u4e86 $O(\\sqrt N)$ \u4e2a\u90e8\u5206\u3002\u8003\u8651\u6bcf\u4e00\u90e8\u5206\uff0c\u53d1\u73b0\u90fd\u53ef\u4ee5\u770b\u4f5c\u4e00\u4e2a\u5168\u5c40\u4fee\uff0c\u5168\u5c40\u67e5\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u76f4\u63a5\u7ebf\u6027\u5730\u6c42\u51fa\u6bcf\u4e2a\u533a\u95f4\u7684\u6700\u5927\u524d\u7f00\u548c\uff0c\u6700\u5c0f\u524d\u7f00\u548c\uff0c\u6700\u5927\u5b50\u6bb5\u548c\u7684\u51f8\u5305\uff0c\u7136\u540e\u5bf9\u6bcf\u4e2a\u8be2\u95ee\u901a\u8fc7\u5168\u5c40\u7684\u6392\u5e8f\uff08\u8fd9\u91cc\u53ef\u4ee5\u76f4\u63a5\u6bcf\u7ec4\u6392\u5e8f\u4e00\u6b21\u6216\u8005\u6574\u4f53\u6392\u5e8f\uff0c\u56e0\u6b64\u4e0d\u9700\u8981\u57fa\u6570\u6392\u5e8f\u4e86\uff09\u5904\u7406\u6389\u7684\u60c5\u51b5\uff0c\u6700\u7ec8\u5c31\u76f4\u63a5\u666e\u901a\u7684\u9012\u63a8\u5408\u5e76\u5373\u53ef\u3002\n\n\u6700\u7ec8\u590d\u6742\u5ea6 $O(\\dfrac M{\\sqrt N}N+M\\sqrt N) =O(M\\sqrt N)$\n\n\u4ee3\u7801\u5495\u4e86\u3002",
        "postTime": 1666355600,
        "uid": 147670,
        "name": "\u91d1\u73c2\u62c9",
        "ccfLevel": 0,
        "title": "\u7b2c\u516d\u5206\u5757\u65f6\u95f4\u8f74\u5206\u5757\u9898\u89e3"
    }
]
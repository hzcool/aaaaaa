[
    {
        "content": "\u90a3\u4e2a\uff0c\u63a8\u5e7f\u4e00\u4e0b\u4e2a\u4eba\u7f51\u7ad9\u3002\u3002\n\n\n\nhttp://zory.cf/2017-12/\u9a6c\u62c9\u677e\u8d5b\u8dd1Marathon.html\n\n## \u6765\u6e90\u548c\u8bc4\u6d4b\u70b9\n\nUSACO14DEC Gold\n\n\n[Luogu3113](https://daniu.luogu.org/problemnew/show/3113)\n\n## \u9898\u76ee\n\n**\u3010\u9898\u76ee\u5927\u610f\u3011**\n\nN\u4e2a\u70b9\u7684\u8def\u7ebf(1<=N<=100,000)\uff0c\u5fc5\u987b\u6309\u987a\u5e8f\u7ecf\u8fc7\u3002\n\n\n\u8be2\u95ee\u7279\u5b9a\u7684\u5b50\u8def\u7ebf\u9700\u8981\u591a\u957f\u65f6\u95f4\u624d\u80fd\u8dd1\u5b8c\uff0c\n\n\u5176\u4e2d\u7684\u5b50\u8def\u7ebf\u662f\u4ece\u5b8c\u6574\u8def\u7ebf\u7684\u68c0\u67e5\u70b9\u4e2d\u622a\u53d6\u7684\u7684\u8fde\u7eed\u5b50\u5e8f\u5217\u3002\n\n\n\u725b\u53ef\u80fd\u4f1a\u9009\u62e9\u5728\u4efb\u4f55\u65f6\u5019\u8df3\u8fc7\u4e00\u4e2a\u68c0\u67e5\u70b9\uff0c\u4f46\u4e0d\u5141\u8bb8\u5728\u5b50\u8def\u7ebf\u4e2d\u8df3\u8fc7\u7b2c\u4e00\u4e2a\u6216\u6700\u540e\u4e00\u4e2a\u70b9\n\n\n\u53ef\u80fd\u4fee\u6539\u70b9\u7684\u5750\u6807\n\n\n\u7531\u4e8e\u8be5\u8bfe\u7a0b\u8bbe\u7f6e\u5728\u5e02\u4e2d\u5fc3\u7684\u8857\u9053\u7f51\u7edc\u4e2d\uff0c\n\n\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684\u8ddd\u79bb(x1,y1)\u548c(x2,y2)\u662f\u7531|x1-x2|+|y1-y2|\u5f97\u51fa\u7684\u3002\n**\u3010\u8f93\u5165\u683c\u5f0f\u3011**\n\n\u7b2c\u4e00\u884cN\u548cQ (1<=Q<=100,000).\n\n\n\u4e0b\u9762N\u884c \u6bcf\u4e2a\u70b9\u7684\u5750\u6807(x,y)\uff0c\u5927\u5c0f\u8303\u56f4\u662f-1000..1000\n\n\u4e0b\u9762Q\u884c \u6bcf\u884c\u4e00\u4e2a\u64cd\u4f5c\n\n\"U I X Y\" \u4fee\u6539 \u70b9I (1<=I<=N) \u7684\u5750\u6807\u4e3a(X, Y).\n\n\"Q I J\" \u8be2\u95ee\u4eceI\u5230J\u7684\u6700\u77ed\u8ddd\u79bb\uff08\u53ef\u4ee5\u8df3\u8fc7\u9664\u8d77\u70b9\u3001\u7ec8\u70b9\u5916\u7684\u5176\u4ed6\u70b9\uff09(I <= J)\n\n**\u3010\u8f93\u51fa\u683c\u5f0f\u3011**\n\n\u6bcf\u4e2aQ\u8f93\u51fa\u8ddd\u79bb\u503c\n\n**\u3010\u8f93\u5165\u6837\u4f8b\u3011**\n\n5 5\n-4 4\n-5 -3\n-1 5\n-3 4\n0 5\nQ 1 5\nU 4 0 1\n\nU 4 -1 1\n\nQ 2 4\nQ 1 4\n\n**\u3010\u8f93\u51fa\u6837\u4f8b\u3011**\n\n11\n8\n8\n\n## \u5206\u6790\n\n\u4f7f\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\u4e24\u4e2a\u5b8c\u5168\u4e0d\u540c\u7684\u4fe1\u606f\u3002\n\n\u503c1\u662f\u6bcf\u4e2a\u8282\u70b9\u5230\u4e0a\u4e00\u4e2a\u8282\u70b9\u7684\u8ddd\u79bb\n\n\u503c2\u662f\u6bcf\u4e2a\u8282\u70b9\u88ab\u5ffd\u7565\u540e\u7684\u6536\u76ca\uff08\u4e00\u822c\u662f\u8d1f\u6570\uff09\n\n\u7ef4\u62a4\u503c1\u7684\u548c\u3001\u503c2\u7684\u6700\u5c0f\u503c\n\n\n\u6bcf\u6b21\u4fee\u6539\u5f71\u54cd\u4e24\u4e2a\u503c1\uff0c\u4e09\u4e2a\u503c2\n\n\n\u4fe1\u606f\u7684\u7ef4\u62a4\u7528\u7ebf\u6bb5\u6811\u8fbe\u5230log\uff0c\u6811\u72b6\u6570\u7ec4\u5219\u6bd4\u8f83\u9ebb\u70e6\n\n\n\u7384\u5b66AC\u4e4b\n\n\u672c\u6765\u7ebf\u6bb5\u6811\u4e0d\u5ffd\u7565\u7f16\u53f71\uff0cwa\u51e0\u4e2a\u70b9\u90fd\u662f\u4e2a\u4f4d\u6570\u7ea7\u522b\u5dee\u5f02\n\n\u540e\u6765\u60f3\u7740\u987a\u4fbf\u52a0\u901f\uff08\u56e0\u4e3a\u7f16\u53f71\u4ece\u6765\u4e0d\u7528\uff09\uff0c\u7ed3\u679cAC\n\n\u5982\u679c\u6709\u4eba\u77e5\u9053\uff0c\u53ef\u4ee5\u5728\u8ba8\u8bba\u533a\u8bc4\u8bba\u4e00\u4e0b\n\n\n## \u4ee3\u7801\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\n\ntypedef long long ll;\nll myabs(ll x) {return x>0?x:-x;}\nll mymin(ll x,ll y) {return x<y?x:y;}\n\nconst int MAXN=110000;\nint n;\n\nstruct nod\n{\n    int l,r,mid,lc,rc;\n    ll s,mi;//\u5206\u522b\u7ef4\u62a4\u503c1\u7684\u548c\u3001\u503c2\u7684\u6700\u5c0f\u503c\n}s[MAXN*2];\nint ln=0;\nint build(int l,int r)\n{\n    int t=++ln;\n    s[t].l=l;s[t].r=r;s[t].mid=(l+r)>>1;\n    if(l<r)\n    {\n        s[t].lc=build(l,s[t].mid);\n        s[t].rc=build(s[t].mid+1,r);\n    }\n    return t;\n}\nvoid change1(int w,int x,ll c)\n{\n    if(s[w].l==s[w].r)\n    {\n        s[w].s=c;\n        return;\n    }\n    int lc=s[w].lc,rc=s[w].rc;\n    if(x<=s[w].mid) change1(lc,x,c);\n    else change1(rc,x,c);\n    s[w].s=s[lc].s+s[rc].s;\n}\nvoid change2(int w,int x,ll c)\n{\n    if(s[w].l==s[w].r)\n    {\n        s[w].mi=c;\n        return;\n    }\n    int lc=s[w].lc,rc=s[w].rc;\n    if(x<=s[w].mid) change2(lc,x,c);\n    else change2(rc,x,c);\n    s[w].mi=mymin(s[lc].mi,s[rc].mi);\n}\nll ask1(int w,int l,int r)\n{\n    if(s[w].l==l and s[w].r==r) return s[w].s;\n    int lc=s[w].lc,rc=s[w].rc;\n    if(r<=s[w].mid) return ask1(lc,l,r);\n    if(l>s[w].mid) return ask1(rc,l,r);\n    return ask1(lc,l,s[w].mid)+ask1(rc,s[w].mid+1,r);\n}\nll ask2(int w,int l,int r)\n{\n    if(l>r) return 0;\n    if(s[w].l==l and s[w].r==r) return s[w].mi;\n    int lc=s[w].lc,rc=s[w].rc;\n    if(r<=s[w].mid) return ask2(lc,l,r);\n    if(l>s[w].mid) return ask2(rc,l,r);\n    return mymin(ask2(lc,l,s[w].mid),ask2(rc,s[w].mid+1,r));\n}\n//\u503c1\u662f\u6bcf\u4e2a\u8282\u70b9\u5230\u4e0a\u4e00\u4e2a\u8282\u70b9\u7684\u8ddd\u79bb\n//\u503c2\u662f\u6bcf\u4e2a\u8282\u70b9\u88ab\u5ffd\u7565\u540e\u7684\u6536\u76ca\uff08\u4e00\u822c\u662f\u8d1f\u6570\uff09\n\nint xx[MAXN],yy[MAXN];\nll get(int x,int sf)//\u4e0e\u5f80\u524dsf\u4e2a\u8282\u70b9\u7684\u8ddd\u79bb\n{\n    return myabs(xx[x]-xx[x-sf])+myabs(yy[x]-yy[x-sf]);\n}\n\nll p[MAXN];//\u987a\u4fbf\u5b58\u50a8\u503c\nchar ss[10];\nint main()\n{\n    int q;scanf(\"%d%d\",&n,&q);\n    build(1,n);\n    for(int i=1;i<=n;i++)\n    {\n        scanf(\"%d%d\",&xx[i],&yy[i]);\n        if(i==1) continue;\n        change1(1,i-1,p[i]=get(i,1));\n    }\n    for(int i=2;i<=n-1;i++) change2(1,i-1,get(i+1,2)-p[i]-p[i+1]);\n    \n    while(q--)\n    {\n        scanf(\"%s\",ss);\n        if(ss[0]=='Q')\n        {\n            int x,y;scanf(\"%d%d\",&x,&y);\n            printf(\"%lld\\n\",ask1(1,x+1-1,y-1)+ask2(1,x+1-1,y-1-1));\n        }\n        else\n        {\n            int a;scanf(\"%d\",&a);\n            scanf(\"%d%d\",&xx[a],&yy[a]);\n            \n            //\u4fee\u6539\u503c1\u4e24\u5904\n            change1(1,a-1,p[a]=get(a,1));\n            change1(1,a+1-1,p[a+1]=get(a+1,1));\n            \n            //\u5bf9\u5e94\u503c2\u4e09\u5904\n            change2(1,a-1-1,get(a,2)-p[a-1]-p[a]);\n            change2(1,a-1,get(a+1,2)-p[a]-p[a+1]);\n            change2(1,a+1-1,get(a+2,2)-p[a+1]-p[a+2]);\n        }\n    }\n}\n```",
        "postTime": 1509629684,
        "uid": 30058,
        "name": "Zory",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3113 \u3010[USACO14DEC]\u9a6c\u62c9\u677e\u8d5b\u8dd1Marathon_Gold\u3011"
    },
    {
        "content": "# \u9898\u89e3 P3113 \u3010[USACO14DEC]Marathon G\u3011\n\n[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3113)\n\n\u6700\u540e\u51e0\u7bc7\u4e4b\u4e00...(\u5e73\u9759\uff09\n\n\u88f8\u7684\u7ebf\u6bb5\u6811a...\n\n\u8be5\u9898\u5305\u62ec\u8be2\u95ee\u4e0e\u66f4\u65b0\uff0c\u5f88\u5bb9\u6613\u60f3\u5230\u8981\u7528\u6570\u636e\u7ed3\u6784\u7ef4\u62a4\u3002 \n\n\u56e0\u4e3a\u5976\u725b\u8981\u6309\u5e8f\u7ecf\u8fc7\u68c0\u67e5\u70b9\u5e76\u4e14\u8be2\u95ee\u7684\u662f\u201c\u5b50\u5e8f\u5217\u201d\uff0c\u8003\u8651\u4f7f\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\u3002\n\n\u7ebf\u6bb5\u6811\u7684\u6bcf\u4e2a\u53f6\u5b50\u7ed3\u70b9\u7ef4\u62a4 $l$ \u4e0e $l+1$\u4e24\u70b9\u95f4\u8ddd\u79bb$sum$\u3002\n\n\u8003\u8651\u5982\u4f55\u7ef4\u62a4\u201c\u8df3\u8fc7\u68c0\u67e5\u70b9\u7684\u60c5\u51b5\u201d\uff0c\u6211\u4eec\u7528\u7ef4\u62a4\u70b9 $l$ \u7684\u53f6\u5b50\u7ed3\u70b9\u6765\u7ef4\u62a4\u8df3\u8fc7 $l+1$ \u8fd9\u4e2a\u70b9\u76f4\u63a5\u5230\u8fbe $l+2$\u70b9\u6240\u80fd\u7f29\u77ed\u7684\u8ddd\u79bb$del$\u3002\n\n\u8fd9\u6837$Pushup$\u65f6\u53ea\u9700\u628a\u513f\u5b50\u7684$sum$\u52a0\u8d77\u6765\uff0c\u628a\u513f\u5b50\u7684$del$\u53d6\u4e2a$max$\u5c31\u884c\u3002\u66f4\u65b0\u65f6\u5355\u70b9\u4fee\u6539\u5373\u53ef\u3002\n\n### \u4e0a\u4ee3\u7801\u300b\u300b\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int MAXN=1e5+10;\nint n,q;\nint px[MAXN],py[MAXN];\nint sum[MAXN<<2],del[MAXN<<2];\nchar ch[5];\ninline int Getd(int a,int b){\n    return fabs(px[a]-px[b])+fabs(py[a]-py[b]);\n}\ninline void Build(int k,int l,int r){\n    if(l==r){\n        if(l<n-1) del[k]=Getd(l,l+1)+Getd(l+1,l+2)-Getd(l,l+2);\n        else del[k]=0;\n        if(l<n) sum[k]=Getd(l,l+1);\n        else sum[k]=0;\n        return;\n    }\n    int mid=(l+r)>>1;    \n    Build(k<<1,l,mid);\n    Build(k<<1|1,mid+1,r);\n    sum[k]=sum[k<<1]+sum[k<<1|1];\n    del[k]=max(del[k<<1],del[k<<1|1]);\n}\ninline int Query_sum(int k,int l,int r,int x,int y){\n    if(l>y||r<x) return 0;\n    if(x<=l&&r<=y) return sum[k];\n    int mid=(l+r)>>1;\n    return Query_sum(k<<1,l,mid,x,y)+Query_sum(k<<1|1,mid+1,r,x,y);\n}\ninline int Query_del(int k,int l,int r,int x,int y){\n    if(l>y||r<x) return 0;\n    if(x<=l&&r<=y) return del[k];\n    int mid=(l+r)>>1;\n    return max(Query_del(k<<1,l,mid,x,y),Query_del(k<<1|1,mid+1,r,x,y));\n} \ninline void Update_sum(int k,int l,int r,int x){\n    if(l==r){\n        if(l>=1&&l<n) sum[k]=Getd(l,l+1);    \n        else sum[k]=0;\n        return;\n    }\n    int mid=(l+r)>>1;\n    if(x<=mid) Update_sum(k<<1,l,mid,x);\n    else Update_sum(k<<1|1,mid+1,r,x);\n    sum[k]=sum[k<<1]+sum[k<<1|1];\n}\ninline void Update_del(int k,int l,int r,int x){\n    if(l==r){\n        if(l>=1&&l<n-1) del[k]=Getd(l,l+1)+Getd(l+1,l+2)-Getd(l,l+2);\n        else del[k]=0;\n        return;\n    }\n    int mid=(l+r)>>1;\n    if(x<=mid) Update_del(k<<1,l,mid,x);\n    else Update_del(k<<1|1,mid+1,r,x);\n    del[k]=max(del[k<<1],del[k<<1|1]);\n}\nint main(){\n    scanf(\"%d%d\",&n,&q);\n    for(int i=1;i<=n;++i)\n        scanf(\"%d%d\",&px[i],&py[i]);\n    Build(1,1,n);\n    for(int i=1,p1,p2,p3;i<=q;++i){\n        scanf(\"%s\",ch);\n        if(ch[0]=='Q'){\n            scanf(\"%d%d\",&p1,&p2);\n            --p2;\n            int res=Query_sum(1,1,n,p1,p2);\n            --p2;\n            res-=Query_del(1,1,n,p1,p2);\n            printf(\"%d\\n\",res);\n        }\n        else{\n            scanf(\"%d%d%d\",&p1,&p2,&p3);\n            px[p1]=p2;\n            py[p1]=p3;\n            for(int j=p1-1;j<=p1;++j)\n                Update_sum(1,1,n,j);\n            for(int j=p1-2;j<=p1;++j)\n                Update_del(1,1,n,j);\n        }\n    }\n    return 0;\n} \n\n```\n\n\u829c\u6e56\uff0c\u6587\u5316\u8bfe\u51b2\u51b2\u51b2~\n",
        "postTime": 1603200689,
        "uid": 225703,
        "name": "jyz666",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3113 \u3010[USACO14DEC]Marathon G\u3011"
    }
]
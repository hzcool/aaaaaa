[
    {
        "content": "~~\u8bf7\u95eedalao\u4eec\u5706\u65b9\u6811\u662f\u4ec0\u4e48...~~  \n\u4e8e\u662f, \u4e0d\u59a8\u6765\u60f3\u4e00\u4e9b\u7b80\u5355\u7684\u64cd\u4f5c\u5427.  \n\n\u672c\u9898\u7684\u96be\u70b9\u662f, \u79fb\u52a8\u7684\u7bb1\u5b50\u9020\u6210\u4e86\u5730\u56fe\u7684\u4e0d\u65ad\u53d8\u5316, \u7bb1\u5b50\u6240\u5728\u7684\u70b9\u4f1a\u6210\u4e3a\u969c\u788d, \u53ef\u80fd\u5bfc\u81f4\u4e00\u4e9b\u672c\u80fd\u8d70\u5230\u7684\u4f4d\u7f6e\u4e0d\u518d\u76f8\u8fde...\u8fd9\u4e0d\u662f**\u5272\u70b9**\u5417$?!$  \n\u5728\u65e0\u5411\u8fde\u901a\u56fe\u4e2d, \u5bf9\u4e8e\u5272\u70b9\u7684\u5b9a\u4e49\u662f: \u82e5**\u5220\u53bb\u8be5\u70b9\u53ca\u5176\u8fde\u8fb9**, **\u56fe\u4e0d\u518d\u8fde\u901a**. \u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8bd5\u7740\u5f3a\u884c\u7528$Tarjan$\u8dd1\u51fa\u5730\u56fe\u4e0a\u6240\u6709\u5272\u70b9\u7684\u5750\u6807, \u987a\u4fbf\u53d6\u5f97\u6bcf\u4e2a\u70b9\u6240\u96b6\u5c5e\u7684\u70b9\u53cc\u8fde\u901a\u5206\u91cf\u7f16\u53f7 ( \u6240\u4ee5, \u5272\u70b9\u5e94\u8be5\u96b6\u5c5e\u4e8e\u591a\u4e2a\u70b9\u53cc ), \u63a5\u4e0b\u6765\u6211\u4eec\u8ba8\u8bba\u5982\u4f55\u5feb\u901f\u5224\u65ad\u80fd\u5426\u4ece\u67d0\u4e2a\u65b9\u5411\u63a8\u52a8\u7bb1\u5b50, \u5047\u8bbe\u73b0\u6709\u72b6\u6001\"$A-box-B$\" ( \u5177\u4f53\u6765\u8bf4, \u8bbe\u6709\u4e24\u4e2a\u4f4d\u7f6e$A$, $B$\u4e0e\u7bb1\u5b50$box$\u76f8\u90bb ):  \n1. \u9996\u5148\u7531\u9898\u610f, \u5728\u4e0d\u8003\u8651$box$\u7684\u963b\u6321\u65f6, $A$\u4e0e$B$\u5e94\u5f53**\u7531\u4e00\u6761\u7ecf\u8fc7$box$\u4f4d\u7f6e\u7684\u8def\u5f84\u76f8\u8fde**.  \n\n2. \u82e5\u8003\u8651$box$\u7684\u963b\u6321, $A$\u4e0e$B$\u4e0d\u518d\u76f8\u901a, \u5219\u7531\u8bba\u8ff0$1.$ $A$, $B$\u4e4b\u95f4**\u6709\u4e14\u4ec5\u6709\u4e00\u6761\u7ecf\u8fc7$box$\u4f4d\u7f6e\u7684\u8def\u5f84\u76f8\u8fde**. \u90a3\u4e48\u7531\u5272\u70b9\u7684\u5b9a\u4e49, $box$\u7684\u4f4d\u7f6e\u662f\u5272\u70b9, $A$, $B$\u4e00\u5b9a\u4e0d\u5c5e\u4e8e\u540c\u4e00\u4e2a\u70b9\u53cc.  \n\n3. \u53cd\u4e4b, \u5219$A$\u4e0e$B$\u7531\u81f3\u5c11\u4e24\u6761\u8def\u5f84$P=<A,v_1,v_2,...,B>$, $P'=<A,v_1',v_2',...,B>$\u76f8\u8fde, \u4e14\u6ee1\u8db3$P\\bigcap P'=\\lbrace A,B\\rbrace$. \u6240\u4ee5$A$, $B$\u4e00\u5b9a\u96b6\u5c5e\u4e8e\u540c\u4e00\u4e2a\u70b9\u53cc.  \n\n\u4e8e\u662f\u5f97\u51fa\u7ed3\u8bba:  \n**$A$\u5728$box$\u7684\u963b\u6321\u4e0b\u80fd\u5230\u8fbe$B\\iff A$, $B$\u96b6\u5c5e\u4e8e\u540c\u4e00\u4e2a\u70b9\u53cc**.  \n\n\u5269\u4e0b\u7684\u4e00\u5207\u597d\u8bf4. ~~\u6211\u5c31\u8c03\u4e86\u4fe9\u5c0f\u65f6~~. \u6240\u4ee5\u6211\u4eec\u518d\u634b\u4e00\u634b\u4ee3\u7801:  \n1. $Tarjan$, \u6c42\u51fa\u6bcf\u4e2a\u70b9\u96b6\u5c5e\u7684 ( \u4e00\u4e2a\u6216\u591a\u4e2a ) \u70b9\u53cc\u7f16\u53f7.  \n\n2. $BFS/DFS$, \u9884\u5904\u7406, \u5c1d\u8bd5\u8ba9\u4eba\u7269\u9760\u8fd1\u7bb1\u5b50\u7684\u56db\u4e2a\u65b9\u5411, \u5e76\u4fdd\u5b58\u80fd\u5230\u8fbe\u7684\u65b9\u5411.  \n3. $BFS$, \u5229\u7528\u4e0a\u8ff0\u5224\u522b\u65b9\u6cd5, \u6807\u8bb0\u6bcf\u4e2a\u7bb1\u5b50\u80fd\u5230\u8fbe\u7684\u4f4d\u7f6e.  \n\n$emmm$\u518d\u597d\u5fc3\u5730\u8bf4\u4e00\u4e0b\u7ec6\u8282\u95ee\u9898\u5427:\n\n- \u6709\u7684\u5c0f\u670b\u53cb\u4e3a\u4e86\u65b9\u4fbf\u5224\u65ad\u6709\u65e0\u76f8\u540c\u7684\u70b9\u53cc\u7f16\u53f7, \u4f1a\u9009\u62e9\u4f7f\u7528$set$\u7b49$STL$\u50a8\u5b58\u6bcf\u4e2a\u70b9\u6240\u96b6\u5c5e\u7684\u70b9\u53cc\u7f16\u53f7, $T$\u6389\u4e00\u5927\u534a, \u5f00$O2$\u5c31\u80fd$A$. ~~STL\u6781\u6b20\u8c03\u6559\u554a/\u6ed1\u7a3d~~.  \n\n- \u5173\u4e8e\u6700\u7ec8\u7684$BFS$\u5982\u4f55\u50a8\u5b58\u72b6\u6001, \u5b9a\u4e49$Vis[i][j][k]$\u8868\u793a\u7bb1\u5b50\u5728$(i,j)$, \u4eba\u7269\u5728\u7bb1\u5b50\u7684$k$\u65b9\u5411\u5373\u53ef.  \n\n- \u591a\u68c0\u67e5\u51e0\u904d~~\u90a3\u8be5\u6b7b\u7684~~$Tarjan$, ~~\u6211\u5e2e\u51e0\u4e2a\u8001\u94c1\u8c03, \u5168\u662fTarjan\u9519/\u518d\u6b21\u6ed1\u7a3d~~.  \n\n\u597d\u4e86, \u4e0a\u4ee3\u7801\u5427. \u6709\u8be6\u7ec6\u6ce8\u91ca\u54e6!\n```cpp\n#include <queue>\n#include <stack>\n#include <cstdio>\n\n#define Int register int\n\nusing namespace std;\n\n// \u5148\u89e3\u91ca\u4e00\u4e0b\u4e07\u6076\u53d8\u91cf\u540d... \nconst int MAXN = 1500, Move[4][2] = { { -1, 0 }, { 0, -1 }, { 1, 0 }, { 0, 1 } };\n// Move[0..3]\u5206\u522b\u5bf9\u5e94\u4e0a, \u5de6, \u4e0b, \u53f3 \nint n, m, q, px, py, bx, by, PDCC, InCpr[MAXN + 5][MAXN + 5][5] = {};\n// n, m, q\u4e3a\u8f93\u5165, (px,px)\u4e3a\u4eba\u7269\u8d77\u59cb\u5750\u6807, (bx,by)\u4e3a\u7bb1\u5b50\u8d77\u59cb\u5750\u6807, PDCC\u4e3a\u70b9\u53cc\u6570\u91cf, InCpr[i][j]\u4e3a\u7ed3\u70b9\u96b6\u5c5e\u4fe1\u606f, \u5176\u4e2dInCpr[i][j][0]\u4e3a\u96b6\u5c5e\u4e2a\u6570 \nint Indx, DFN[MAXN + 5][MAXN + 5] = {}, Low[MAXN + 5][MAXN + 5] = {};\n// Tarjan\u7684\u4e00\u5806\u4e1c\u897f \nbool Up, Left, Down, Right, Vis[MAXN + 5][MAXN + 5][4] = {}, B_vis[MAXN + 5][MAXN + 5] = {};\n// \u56db\u4e2a\u65b9\u5411\u80fd\u5426\u5230\u8fbe, \u4ee5\u53ca\u4e24\u4e2aBFS\u7684Vis\u6570\u7ec4 ( \u6808\u7a7a\u95f4\u5f00\u4e0d\u4e0b ) \nchar Map[MAXN + 5][MAXN + 5] = {};\n// \u5730\u56fe \nstack<pair<int, int> > S;\n// Tarjan\u7684\u6808 \n\nstruct Node { // BFS\u7ed3\u70b9 \n\tint px, py, bx, by;\n};\n\ninline bool Inside ( const int x, const int y ) { // \u51fa\u754c\u5224\u65ad \n\treturn 1 <= x && x <= n\n\t\t&& 1 <= y && y <= m;\n}\n\ninline void AddNear ( const int x, const int y, const int NearCprID ) { // \u6dfb\u52a0\u4e00\u4e2a\u96b6\u5c5e\u7684\u70b9\u53cc\u7f16\u53f7 \n\tInCpr[x][y][++ InCpr[x][y][0]] = NearCprID;\n}\n\ninline void Tarjan ( const int x, const int y, const int fax, const int fay ) { // \u4e07\u6076\u4e4b\u6e90Tarjan \n\tDFN[x][y] = Low[x][y] = ++ Indx; // \u8fd9\u91cc\u53ef\u4ee5\u9009\u62e9\u5c06\u5750\u6807Hash \n\tS.push ( make_pair ( x, y ) );\n\tfor ( Int i = 0; i < 4; ++ i ) {\n\t\tint nx = x + Move[i][0], ny = y + Move[i][1];\n\t\tif ( Inside ( nx, ny ) && Map[nx][ny] ^ '#' ) {\n\t\t\tif ( ! DFN[nx][ny] ) {\n\t\t\t\tTarjan ( nx, ny, x, y );\n\t\t\t\tif ( Low[nx][ny] >= DFN[x][y] ) {\n\t\t\t\t\t++ PDCC;\n\t\t\t\t\tAddNear ( x, y, PDCC );\n\t\t\t\t\twhile ( S.top ().first ^ nx || S.top ().second ^ ny ) { // \u6ce8\u610f\u51fa\u5165\u6808\u7684\u7ec6\u8282 \n\t\t\t\t\t\tAddNear ( S.top ().first, S.top ().second, PDCC );\n\t\t\t\t\t\tS.pop ();\n\t\t\t\t\t}\n\t\t\t\t\tAddNear ( nx, ny, PDCC );\n\t\t\t\t\tS.pop ();\n\t\t\t\t}\n\t\t\t\tLow[x][y] = min ( Low[x][y], Low[nx][ny] );\n\t\t\t} else if ( DFN[x][y] > DFN[nx][ny] && ( nx ^ fax || ny ^ fay ) ) {\n\t\t\t\tLow[x][y] = min ( Low[x][y], DFN[nx][ny] );\n\t\t\t}\n\t\t}\n\t}\n}\n\ninline void Beclose ( const int x, const int y, const int Boxx, const int Boxy ) { // \u8d34\u8fd1box(\u9884\u5904\u7406) \n\tqueue<pair<int, int> > Q;\n\tQ.push ( make_pair ( x, y ) );\n\tB_vis[x][y] = true;\n\twhile ( ! Q.empty () ) { // \u8fd9\u4e2axjb\u4e71\u641c\u5c31\u884c\u4e86, \u95ee\u9898\u4e0d\u5927 \n\t\tpair<int, int> p = Q.front ();\n\t\tQ.pop ();\n\t\tif ( p.first == Boxx - 1 && p.second == Boxy ) Up = true;\n\t\tif ( p.first == Boxx && p.second == Boxy - 1 ) Left = true;\n\t\tif ( p.first == Boxx + 1 && p.second == Boxy ) Down = true;\n\t\tif ( p.first == Boxx && p.second == Boxy + 1 ) Right = true;\n\t\tif ( Up && Left && Down && Right ) return ;\n\t\tfor ( Int i = 0; i < 4; ++ i ) {\n\t\t\tint nx = p.first + Move[i][0], ny = p.second + Move[i][1];\n\t\t\tif ( Inside ( nx, ny ) && Map[nx][ny] ^ '#' && Map[nx][ny] ^ 'B' && ! B_vis[nx][ny] ) {\n\t\t\t\tB_vis[nx][ny] = true;\n\t\t\t\tQ.push ( make_pair ( nx, ny ) );\n\t\t\t}\n\t\t}\n\t}\n}\n\ninline bool InSameCpr ( const int s, const int t, const int p, const int q ) { // \u66b4\u679a\u662f\u5426\u5c5e\u4e8e\u76f8\u540c\u70b9\u53cc \n\tfor ( Int i = 1; i <= InCpr[s][t][0]; ++ i ) {\n\t\tfor ( Int j = 1; j <= InCpr[p][q][0]; ++ j ) {\n\t\t\tif ( InCpr[s][t][i] == InCpr[p][q][j] ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\ninline void BFS () {\n\tqueue<Node> Q;\n\tif ( Up ) Q.push ( Node { bx - 1, by, bx, by } ), Vis[bx][by][0] = true; // \u961f\u5217\u521d\u59cb\u5316 \n\tif ( Left ) Q.push ( Node { bx, by - 1, bx, by } ), Vis[bx][by][1] = true;\n\tif ( Down ) Q.push ( Node { bx + 1, by, bx, by } ), Vis[bx][by][2] = true;\n\tif ( Right ) Q.push ( Node { bx, by + 1, bx, by } ), Vis[bx][by][3] = true;\n\twhile ( ! Q.empty () ) {\n\t\tNode p = Q.front ();\n\t\tQ.pop ();\n\t\tfor ( Int i = 0; i < 4; ++ i ) {\n\t\t\tint nbx = p.bx + Move[i][0], nby = p.by + Move[i][1];\n\t\t\tint bkx = p.bx + Move[i ^ 2][0], bky = p.by + Move[i ^ 2][1];\n\t\t\tif ( Inside ( nbx, nby ) && Map[nbx][nby] ^ '#' && ( ( bkx == p.px && bky == p.py ) || InSameCpr ( p.px, p.py, bkx, bky ) ) && ! Vis[nbx][nby][i ^ 2] ) {\n\t\t\t\t// \u5728\u754c\u5185 && \u4e0d\u662f\u969c\u788d && ( \u662f\u76f4\u63a5\u63a8\u8d70 || \u53ef\u4ee5\u6362\u65b9\u5411\u63a8 ) && \u8be5\u72b6\u6001\u672a\u5165\u961f \n\t\t\t\tVis[nbx][nby][i ^ 2] = true;\n\t\t\t\tQ.push ( Node { p.bx, p.by, nbx, nby } );\n\t\t\t}\n\t\t}\n\t}\n}\n\ninline void Work () {\n\tscanf ( \"%d %d %d\", &n, &m, &q );\n\tfor ( Int i = 1; i <= n; ++ i ) {\n\t\tfor ( Int j = 1; j <= m; ++ j ) {\n\t\t\tchar s = getchar ();\n\t\t\tif ( s ^ '.' && s ^ '#' && s ^ 'A' && s ^ 'B' ) { // \u5224' '\u4e0e'\\n' \n\t\t\t\t-- j; continue;\n\t\t\t}\n\t\t\tif ( s == 'A' ) px = i, py = j;\n\t\t\tif ( s == 'B' ) bx = i, by = j;\n\t\t\tMap[i][j] = s;\n\t\t}\n\t}\n\tTarjan ( px, py, 0, 0 );\n\tif ( ! DFN[bx][by] ) { // \u8fd9\u91cc\u9700\u8981\u6ce8\u610f, #3\u7684\u5751\u70b9, \u4eba\u7269\u672c\u6765\u5c31\u65e0\u6cd5\u9760\u8fd1\u7bb1\u5b50, \u7279\u5224\u6389 \n\t\twhile ( q -- ) {\n\t\t\tint x, y;\n\t\t\tscanf ( \"%d %d\", &x, &y );\n\t\t\tputs ( x == bx && y == by ? \"YES\" : \"NO\" );\n\t\t}\n\t\treturn ;\n\t}\n\tBeclose ( px, py, bx, by );\n\tBFS ();\n\twhile ( q -- ) {\n\t\tint x, y;\n\t\tscanf ( \"%d %d\", &x, &y );\n\t\tputs ( Vis[x][y][0] || Vis[x][y][1] || Vis[x][y][2] || Vis[x][y][3] ? \"YES\" : \"NO\" ); // \u8f7b\u677e\u5224\u65ad \n\t}\n}\n\nint main () {\n//\tfreopen ( \"pushbox.in\", \"r\", stdin );\n//\tfreopen ( \"pushbox.out\", \"w\", stdout );\n\tWork ();\n\treturn 0;\n}\n```\n\u611f\u8c22\u60a8\u7684\u9605\u8bfb. ~~\u6216\u8bb8\u662fcopy\u4ee3\u7801\u5462!~~",
        "postTime": 1563280113,
        "uid": 123807,
        "name": "Rainybunny",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4082 \u3010[USACO17DEC]Push a Box\u3011"
    },
    {
        "content": "\u8fd9\u4e2a\u9898\u8fd8\u662f\u633a\u503c\u5f97\u4e00\u505a\u7684\uff0c\u7b97\u7b80\u5355\uff0c~~\u867d\u7136\u6211\u8c03\u4e86\u56db\u4e2a\u665a\u4e0a~~\n\n\u4e00\u5f00\u59cb\u83ab\u540d**RE**\uff0c\u4e00\u76f4\u5361\u5728**66**\u5206\uff0c\u540e\u6765\u624d\u77e5\u9053\u662f\u7a7a\u95f4\u7684\u95ee\u9898;\n\n\u4e00\u5f00\u59cb\u6211\u505a\u7684\u65f6\u5019\u76f4\u63a5\u5efa\u7acb\u65b9\u70b9\uff0c\u628a\u8fb9**\u5168\u90e8\u8fde\u4e0a**(<---\u7a7a\u95f4\u7206\u70b8)\uff0c\u518d\u8dd1\u4e00\u904dDFS\u627e\u7236\u4eb2\u8282\u70b9\u3002\n\n\n\u540e\u6765\u624d\u53d1\u73b0\u6211\u53ef\u4ee5\u76f4\u63a5\u5728\u8dd1\u5706\u65b9\u6811\u7684\u65f6\u5019\u53ef\u4ee5\u76f4\u63a5\u628a\u7236\u4eb2\u8282\u70b9\u7ed9\u8fde\u4e0a\uff0c\u7701\u7a7a\u95f4\u53c8\u7701\u65f6\u95f4\uff08\u4e4b\u524d\u6211\u597d\u50bb\u554a~\uff09\n\n\u5e9f\u8bdd\u4e0d\u8bf4\u4e86\uff0c\u76f4\u63a5\u4e0a\u4ee3\u7801\uff08\u4ee3\u7801\u4e2d\u6709\u6ce8\u91ca\uff09\n\n\n**\u6ce8\u610f\uff1a\u5706\u65b9\u6811\u7a7a\u95f4\u5f00\u4e24\u500d\uff01\uff01\u4ee5\u53cacnt\u7684\u521d\u59cb\u5316\uff01\uff01**\n\n\n\n### **\u4e00\u5f00\u59cb\u7684\u4ee3\u7801,\u5982\u4e0b**\uff1a\n\n**\u5706\u65b9\u6811:**\n\n```cpp\nvoid CST(int u)\n{\n\tdfn[u]=low[u]=++deep;\n\t_stack[++tp]=u;\n\tfor (int i=0;i<G[u].size();i++){\n\t\tint v=G[u][i];\n\t\tif (!dfn[v]){\n\t\t\tCST(v);\n\t\t\tlow[u]=min(low[u],low[v]);\n\t\t\tif (low[v]==dfn[u]){\n\t\t\t\t++cnt;\n\t\t\t\tfor (int j=0;j!=v;--tp){\n\t\t\t\t\tj=_stack[tp];\n\t\t\t\t\tT[cnt].push_back(j);//\u5c45\u7136\u8fd8\u7528vector\u8fde\u8fb9\uff0c\u662f\u4e0d\u662f\u5f88\u50bb\n\t\t\t\t\tT[j].push_back(cnt);\n\t\t\t\t}\n\t\t\t\tT[cnt].push_back(u);\n\t\t\t\tT[u].push_back(cnt);\n\t\t\t}\n\t\t}\n\t\telse low[u]=min(low[u],dfn[v]);\n\t}\n\treturn;\n}\n```\n\n**\u5224\u8fde\u901a:**\n\n```cpp\nbool check(int x,int y,int z)\n{\n\tif (fa[x]==fa[y]) return 1;\n\tif (fa[fa[x]]==z&&fa[fa[y]]==z) return 0;\n\tif (fa[fa[x]]==z&&fa[fa[z]]==y) return 0;\n\tif (fa[fa[z]]==x&&fa[fa[y]]==z) return 0;\n\tif (fa[fa[z]]==fa[fa[x]]&&fa[fa[y]]==z) return 0;\n\tif (fa[fa[z]]==fa[fa[y]]&&fa[fa[x]]==z) return 0;\n\treturn 1;//\u597d\u591a\u554a\n}\n```\n\n### **\u6539\u4e86\u4e4b\u540e:**\n\n**\u5706\u65b9\u6811:**\n\n\n```cpp\nvoid CST(int u)\n{\n\tdfn[u]=low[u]=++deep;\n\t_stack[++tp]=u;\n\tfor (int i=0;i<G[u].size();i++){\n\t\tint v=G[u][i];\n\t\tif (!dfn[v]){\n\t\t\tCST(v);\n\t\t\tlow[u]=min(low[u],low[v]);\n\t\t\tif (low[v]==dfn[u]){\n\t\t\t\t++cnt;\n\t\t\t\tfa[cnt]=u;//\u76f4\u63a5\u8fde\u7236\u4eb2\n\t\t\t\tfor (int j=0;j!=v;--tp)\n\t\t\t\t{\n\t\t\t\t\tj=_stack[tp];\n\t\t\t\t\tpoint[j]=cnt;\n\t\t\t\t}\n\t\t\t\tpoint[u]=cnt;\n\t\t\t}\n\t\t}\n\t\telse low[u]=min(low[u],dfn[v]);\n\t}\n\treturn;\n}\n```\n**\u5224\u8fde\u901a\uff1a**\n\n```cpp\nbool check(int x,int y,int z)\n{\n\treturn point[x]==point[y]||fa[point[x]]==y||fa[point[y]]==x;\n    \t\t\t\t\t\t\t\t    //\u8fd9\u91cc\u4e24\u70b9\u7684\u8fde\u901a\u6027\u53ea\u4e0e\u7236\u4eb2\n    \t\t\t\t\t\t\t\t    //\u6216\u7236\u4eb2\u7684\u7236\u4eb2\u6709\u5173\uff0c\u53ef\u4ee5\u7b80\u4fbf\u4e9b\n\t\t\t\t\t\t\t            //\u4f46\u5176\u5b83\u7684\u9898\u8fd8\u662f\u5f97\u7528LCA\n}\n```\n\n\n\u5b8c\u6574\u4ee3\u7801\uff08~~\u9700\u8981\u5361\u4e00\u5361\u65f6\u95f4~~\uff09:\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,m,q;\nint begin_a,begin_b,end_a,end_b;\nint deep,tp,cnt;\nint dfn[2250010],low[2250010];\nint _stack[2250010];\nvector <int> G[2250010];//\u5706\u65b9\u6811\u57fa\u672c\u64cd\u4f5c\nint point[2250010];\nchar c[1510][1510];\nstring s1;\nbool p[1510][1510][4];//\u6807\u8bb0\u662f\u5426\u4ece\u56db\u4e2a\u65b9\u5411\u5206\u522b\u6765\u8fc7\nbool dis[1510][1510];//\u6807\u8bb0\u662f\u5426\u4ecei\u5230j\u8fc7\nint fa[4500020];\nint dx[4]={0,0,-1,1};//\u56db\u4e2a\u65b9\u5411\nint dy[4]={-1,1,0,0};\nint read()//\u4e11\u964b\u7684\u5feb\u8bfb\n{\n    char ch=getchar();\n    int s=0,w=1;\n    while (ch<'0'||ch>'9'){\n        if (ch=='-') w=-1;\n        ch=getchar();\n    }\n    while (ch>='0'&&ch<='9'){\n        s=(s<<1)+(s<<3)+ch-'0';\n        ch=getchar();\n    }\n    return s*w;\n}\nint tra(int x,int y) return (x-1)*m+y;//\u5c06\u4e8c\u7ef4\u538b\u7f29\u4e3a\u4e00\u7ef4\n\nint bk1(int x) return (x-1)/m+1;//\u5c06\u4e8c\u7ef4\u5c55\u5f00\u4e3a\u4e00\u7ef4\uff0c\u8fd9\u662f\u6a2a\u5750\u6807\n\nint bk2(int x)//\u5c06\u4e8c\u7ef4\u5c55\u5f00\u4e3a\u4e00\u7ef4\uff0c\u8fd9\u662f\u7eb5\u5750\u6807\n{\n\tint y=(x-1)/m+1;\n\treturn x-(y-1)*m;\n}\nvoid CST(int u)//\u5706\u65b9\u6811\n{\n\tdfn[u]=low[u]=++deep;//DFS\u5e8f\n\t_stack[++tp]=u;//\u628au\u52a0\u5165\u6808\n\tfor (int i=0;i<G[u].size();i++){\n\t\tint v=G[u][i];\n\t\tif (!dfn[v]){\n\t\t\tCST(v);\n\t\t\tlow[u]=min(low[u],low[v]);\n\t\t\tif (low[v]==dfn[u]){//\u8fd9\u4ee3\u8868\u6b64\u65f6\u627e\u5230\u4e00\u4e2a\u70b9\u53cc\u8fde\u901a\u5206\u91cf\n\t\t\t\t++cnt;\n\t\t\t\tfa[cnt]=u;//cnt\u8282\u70b9\u7684\u7236\u4eb2\u4e3au\n\t\t\t\tfor (int j=0;j!=v;--tp){\n\t\t\t\t\tj=_stack[tp];\n\t\t\t\t\tpoint[j]=cnt;//\u5747\u6307\u5411cnt\n\t\t\t\t}\n\t\t\t\tpoint[u]=cnt;\u540c\u65f6\u4e5f\u5f97\u628au\u6307\u5411cnt\n\t\t\t}\n\t\t}\n\t\telse low[u]=min(low[u],dfn[v]);\t\n\t}\n\treturn;\n}\nvoid BFS(int x,int y)//BFS\u627e\u80fd\u4ece\u8d77\u70b9\u5230\u8fbe\u7684\u4f4d\u7f6e\n{\n\tqueue<int> q;\n\tq.push(tra(x,y));\n\tdis[x][y]=1;//\u5c06\u5df2\u8d70\u5230\u7684\u6807\u8bb0\n\twhile (!q.empty()){\n\t\tint u=bk1(q.front()),v=bk2(q.front());\n\t\tq.pop();\n\t\tfor (int i=0;i<4;i++){\n\t\t\tint a=u+dx[i],b=v+dy[i];\n\t\t\tif(a>=1&&a<=n&&b>=1&&b<=m&&c[a][b]=='.'&&!dis[a][b]){\n                dis[a][b]=1;\n\t\t\t\tq.push(tra(a,b));//\u628a\u6ee1\u8db3\u80fd\u8d70\u5230\u7684\u8282\u70b9\u52a0\u5165\u6808\u4e2d\n            }\n\t\t}\n\t}\n}\nbool check(int x,int y,int z)//\u5224\u662f\u5426\u8fde\u901a\n{\n\treturn point[x]==point[y]||fa[point[x]]==y||fa[point[y]]==x;\n}\nstruct node{\n\tint x_,y_;\n};\nint main()\n{\n\tn=read();m=read();q=read();\n\tcnt=n*m;//\u8fd9\u91cc\u8bb0\u5f97\u628acnt\u521d\u59cb\u5316\u4e3an*m\n\tfor (int i=1;i<=n;i++){\n\t\tcin>>s1;//\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\uff0c\u76f4\u63a5\u8f93\u5165c[i][j]\u53cd\u800c\u6162\u4e00\u4e9b\n\t\tfor (int j=0;j<m;j++) c[i][j+1]=s1[j];\n\t\tfor (int j=1;j<=m;j++){//\u8fd9\u91cc\u662f\u4e3a\u5706\u65b9\u6811\u8fde\u8fb9\uff0c\u5373\u628a\u56db\u5468\u80fd\u5230\u8fbe\u7684\u90fd\u4e0e\u672c\u8eab\u8fde\u8fb9\n\t\t\n\t\t\tif (c[i][j]=='A'||c[i][j]=='.'||c[i][j]=='B'){\n\t\t\t\tif (c[i-1][j]=='A'||c[i-1][j]=='.'||c[i-1][j]=='B'){\n\t\t\t\t\tG[tra(i,j)].push_back(tra(i-1,j));\n\t\t\t\t\tG[tra(i-1,j)].push_back(tra(i,j));\n\t\t\t\t}\n\t\t\t\tif (c[i][j-1]=='A'||c[i][j-1]=='.'||c[i][j-1]=='B'){\n\t\t\t\t\tG[tra(i,j)].push_back(tra(i,j-1));\n\t\t\t\t\tG[tra(i,j-1)].push_back(tra(i,j));\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (c[i][j]=='A') begin_a=i,begin_b=j;//\u5b58A\u7684\u4f4d\u7f6e\n\t\t\tif (c[i][j]=='B') end_a=i,end_b=j;//\u5b58B\u7684\u4f4d\u7f6e\n\t\t}\n\t}\n\tCST(tra(begin_a,begin_b));//\u5706\u65b9\u6811\n\tBFS(begin_a,begin_b);//\u4ece\u8d77\u70b9\u8dd1\u4e00\u8fb9BFS\n\tqueue<node> Q;\n\tif (dis[end_a][end_b-1]) p[end_a][end_b][0]=1,Q.push(node{tra(end_a,end_b),0});\n    \t\t\t\t\t\t\t\t\t\t  //\u8fd9\u91cc\u662f\u5224\u4ece\u8d77\u70b9\u80fd\u5230\u7bb1\u5b50\n  \t\t\t\t\t\t \t\t\t\t      //\u521d\u59cb\u4f4d\u7f6e\u56db\u5468\u7684\u54ea\u4e9b\u5730\u65b9\n\tif (dis[end_a][end_b+1]) p[end_a][end_b][1]=1,Q.push(node{tra(end_a,end_b),1});\n\tif (dis[end_a-1][end_b]) p[end_a][end_b][2]=1,Q.push(node{tra(end_a,end_b),2});\n\tif (dis[end_a+1][end_b]) p[end_a][end_b][3]=1,Q.push(node{tra(end_a,end_b),3});//\u56db\u4e2a\u65b9\u5411\u90fd\u8981\u5b58\n\twhile (!Q.empty()){\n\t\tint u=bk1(Q.front().x_),v=bk2(Q.front().x_);\n\t\tint w=Q.front().y_;\n\t\tQ.pop();\n\t\tint x=u-dx[w],y=v-dy[w];//\u8ba1\u7b97\u4ece\u4e0a\u4e00\u72b6\u6001\u63a8\u6765\u7684\u4f4d\u7f6e\n\t\tif (x>=1&&x<=n&&y>=1&&y<=m&&c[x][y]!='#'&&p[x][y][w]==0){\n\t\t\tp[x][y][w]=1;\n\t\t\tQ.push(node{tra(x,y),w});//\u82e5\u80fd\u6ee1\u8db3\uff0c\u5219\u628a\u5750\u6807\u4e0e\u63a8\u7684\u65b9\u5411\u52a0\u5165\u6808\u4e2d\n\t\t}\n\t\tfor (int i=0;i<4;i++){\n\t\t\tif (p[u][v][i]==0&&i!=w&&check(tra(u+dx[w],v+dy[w]),tra(u+dx[i],v+dy[i]),tra(u,v))==1&&c[u+dx[i]][v+dy[i]]!='#'&&u+dx[i]>=1&&u+dx[i]<=n&&v+dy[i]>=1&&v+dy[i]<=m){//\u9632\u6b62\u6ea2\u51fa\u8fb9\u754c\n\t\t\t\tp[u][v][i]=1;\n\t\t\t\tQ.push(node{tra(u,v),i});//\u540c\u4e0a\n\t\t\t}\n\t\t}\n\t}\n\twhile (q--){\n\t\tint a1=read(),a2=read();\n\t\tif (c[a1][a2]=='B'||p[a1][a2][0]||p[a1][a2][1]||p[a1][a2][2]||p[a1][a2][3])\tputs(\"YES\");\n        \t\t\t\t\t\t\t\t//\u53ea\u8981\u6709\u4e00\u4e2a\u65b9\u5411\u80fd\u63a8\u8fc7\u6765\u5c31\u884c\u4e86\n        \t\t\t\t\t\t\t\t//\u6216\u5b83\u672c\u8eab\u5c31\u662fB\u70b9\n\t\telse puts(\"NO\");\n\t}\n\treturn 0;\n}\n```\n\n\n\u55ef\uff0c\u4ee3\u7801\u8fd8\u662f\u633a\u77ed\u7684\uff0c\u5927\u4f6c\u4eec\u8d76\u7d27\u53bb\u5207\u4e86\u8fd9\u9053\u9898\u5427\n\n![ss](https://s1.ax1x.com/2020/10/25/BeX3pd.jpg)\n",
        "postTime": 1604320765,
        "uid": 67692,
        "name": "Selfish_2U",
        "ccfLevel": 0,
        "title": "P4082 [USACO17DEC]Push a Box P"
    },
    {
        "content": "(\u5176\u5b9e\u8fd9\u9898\u4e0d\u96be\u554a\uff0c\u600e\u4e48\u5168\u7f51\u65e0\u4e2d\u6587\u9898\u89e3)\n\n$bfs$\uff0c\u72b6\u6001$(x,y,i)$\u8868\u793a\u59cb\u7ec8\u5408\u6cd5\u7684\u8d70\uff0c\u6700\u540e\u4e00\u6b21\u63a8\u7bb1\u64cd\u4f5c\u7684\u65b9\u5411\u4e3a$i$($i \\in [0,4) $)\uff0c\u63a8\u5b8c\u4e86\u7684\u7bb1\u5b50\u5750\u6807\u4e3a$(x,y)$\u3002\n\n\u73b0\u5728\u7684\u95ee\u9898\u5c31\u662f\u5982\u4f55\u5224\u65ad\u4e0d\u7ecf\u8fc7\u7bb1\u5b50\u6240\u5728\u7684\u70b9\uff0c\u4ece\u7bb1\u5b50\u7684\u4e00\u4e2a\u76f8\u90bb\u70b9\u8d70\u5230\u53e6\u4e00\u4e2a\u76f8\u90bb\u70b9\u3002\n\n\u8fd9\u6837\u7684\u8bdd\u8fd9\u4e24\u4e2a\u70b9\u5c31\u6709\u4e24\u6761\u70b9\u4e0d\u76f8\u4ea4\u7684\u8def\u5f84\u53ef\u4ee5\u76f8\u4e92\u5230\u8fbe\uff0c\u8fd9\u5c31\u7b49\u4ef7\u4e8e\u8fd9\u4e24\u4e2a\u70b9\u5c5e\u4e8e\u540c\u4e00\u4e2a\u70b9\u53cc\u8fde\u901a\u5206\u91cf\u3002\n\n\u7528\u5706\u65b9\u6811\u5224\u4e00\u4e0b\uff0c\u76f8\u540c\u7238\u7238\uff0c\u6216\u8005\u4e00\u4e2a\u70b9\u662f\u53e6\u4e00\u4e2a\u70b9\u7684\u7237\u7237\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\ntemplate <typename T> void chmin(T &x,const T &y)\n{\n\tif(x>y)x=y;\n}\n#define rep(i,l,r) for(int i=l;i<=r;++i)\nconst int N=1500+5,T=N*N,fx[4]={-N,N,-1,1};\nchar s[T];int sx,tx;\nnamespace DFS\n{\nint dfn[T],low[T],tot;\nint fa[T*2],bcnt;\nint st[T],top;\nvoid dfs(int x,int fr)\n{\n\tdfn[x]=low[x]=++tot;\n\tst[++top]=x;\n\trep(i,0,3)\n\tif(i!=fr)\n\t{\n\t\tint y=x+fx[i];\n\t\tif(s[y]!='.')continue;\n\t\tif(dfn[y]){chmin(low[x],dfn[y]);continue;}\n\t\tdfs(y,i^1);\n\t\tchmin(low[x],low[y]);\n\t\tif(low[y]>=dfn[x])\n\t\t{\n\t\t\t++bcnt;\n\t\t\tfa[T+bcnt]=x;\n\t\t\twhile(1)\n\t\t\t{\n\t\t\t\tfa[st[top]]=T+bcnt;\n\t\t\t\t--top;\n\t\t\t\tif(st[top+1]==y)break;\n\t\t\t}\n\t\t}\n\t}\n}\nvoid main()\n{\n\tdfs(sx,-1);\n}\nbool connected(int x,int y)\n{\n\treturn fa[x]==fa[y]||fa[fa[x]]==y||fa[fa[y]]==x;\n}\n};\n\nnamespace BFS1\n{\nbool vis[T];\nint q[T];\nvoid main()\n{\n\tint tail=1;\n\tvis[q[1]=sx]=1;\n\tvis[tx]=1;\n\trep(head,1,tail)\n\t{\n\t\tint x=q[head];\n\t\trep(i,0,3)\n\t\t{\n\t\t\tint y=x+fx[i];\n\t\t\tif(s[y]!='.')continue;\n\t\t\tif(vis[y])continue;\n\t\t\tvis[q[++tail]=y]=1;\n\t\t}\n\t}\n}\n};\n\nnamespace BFS2\n{\nbool vis[T][4];\nint q[4*T];\nvoid main()\n{\n\tint tail=0;\n\trep(i,0,3)\n\t{\n\t\tint x=tx+fx[i^1];\n\t\tif(!BFS1::vis[x])continue;\n\t\tvis[tx][i]=1;\n\t\tq[++tail]=tx*4+i;\n\t}\n\trep(head,1,tail)\n\t{\n\t\tint t=q[head]/4,i=q[head]%4;\n\t//\tcerr<<t/N<<\" \"<<t%N<<\" \"<<i<<endl;\n\t\tint y=t+fx[i];\n\t\tif(s[y]=='.'&&!vis[y][i])\n\t\t{\n\t\t\tvis[y][i]=1;\n\t\t\tq[++tail]=y*4+i;\n\t\t}\n\t\tint x=t+fx[i^1];\n\t\trep(j,0,3)\n\t\tif(!vis[t][j])\n\t\t{\n\t\t\tint y=t+fx[j^1];\n\t\t\tif(s[y]!='.'||!DFS::connected(x,y))continue;\n\t\t\tvis[t][j]=1;\n\t\t\tq[++tail]=t*4+j;\n\t\t}\n\t}\n}\nbool ok(int x)\n{\n\tif(x==tx)return 1;\n\trep(i,0,3)\n\tif(vis[x][i])return 1;\n\treturn 0;\n}\n};\n\nint main()\n{\n\tfreopen(\"1.in\",\"r\",stdin);freopen(\"1.out\",\"w\",stdout);\n\tint n,m,q;\n\tcin>>n>>m>>q;\n\trep(i,1,n)\n\t{\n\t\tscanf(\"%s\",s+i*N+1);\n\t\trep(j,i*N+1,i*N+m)\n\t\tif(s[j]=='A')\n\t\t{\n\t\t\tsx=j;\n\t\t\ts[j]='.';\n\t\t}\n\t\telse\n\t\tif(s[j]=='B')\n\t\t{\n\t\t\ttx=j;\n\t\t\ts[j]='.';\n\t\t}\n\t}\n\t\n\tDFS::main();\n\tBFS1::main();\n\tBFS2::main();\n\t\n\twhile(q--)\n\t{\n\t\tint x0,y0;\n\t\tscanf(\"%d%d\",&x0,&y0);\n\t\tint x=x0*N+y0;\n\t\tputs(BFS2::ok(x)?\"YES\":\"NO\");\n\t}\n}\n```\n\n",
        "postTime": 1526261993,
        "uid": 9168,
        "name": "kczno1",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4082 \u3010[USACO17DEC]Push a Box\u3011"
    },
    {
        "content": "\u770b\u5230\u53ea\u6709\u5706\u65b9\u6811\u7684\u9898\u89e3\uff0c\u6211\u6765\u53d1\u4e00\u4e2a\u70b9\u53cc\u7684\u3002\n\n\u663e\u7136\u8fd9\u9053\u9898\u5c31\u662f\u76f4\u63a5\u641c\u7d22\u3002\u5b9a\u4e49\u72b6\u6001\u4e3af[i][j][0~4]\u8868\u793a\u7bb1\u5b50\u5728(i,j)\uff0c\u4eba\u5728\u67d0\u4e2a\u65b9\u5411\u63a8\u3002\u7136\u540e\u95ee\u9898\u5c31\u662f\u600e\u4e48\u8f6c\u5411\u3002\u6211\u4eec\u53d1\u73b0\u5982\u679c\u8981\u8f6c\u5411\uff0c\u5fc5\u987b\u662f\u4eba\u8d70\u8fc7\u4e00\u6761\u4e0d\u5305\u62ec(i,j)\u7684\u8def\u5f84\u5230\u53e6\u4e00\u4e2a\u65b9\u5411\u3002\u90a3\u4e48\u76f4\u63a5\u6c42\u4e00\u4e2a\u70b9\u53cc\u8054\u901a\u5206\u91cf\u5c31\u5b8c\u4e8b\u4e86\u3002\u628a\u70b9\u53cc\u8054\u901a\u91cc\u9762\u7684\u70b9\u4e24\u4e24\u4e4b\u95f4\u90fd\u6709\u81f3\u5c11\u4e24\u6761\u4e0d\u7ecf\u8fc7\u91cd\u590d\u70b9\u7684\u8def\u5f84\uff0c\u8fd9\u6837\u5c31\u80fd\u8f6c\u5411\u4e86\u3002\n\n\u70b9\u53cc\u5185\uff0c\u5177\u4f53\u7684\u5904\u7406\u65b9\u6cd5\u662f\u5f00\u4e00\u4e2a\u6876\u3002\n\n\u5177\u4f53\u89c1\u4ee3\u7801\n\n\n\n```cpp// luogu-judger-enable-o2\n#include <bits/stdc++.h>\nusing namespace std;\nconst int MAXN = 1505;\nconst int MAXP = MAXN*MAXN;\nint n, m, q, id[MAXN][MAXN], tot, tmr;\nint fir[MAXP], to[MAXP<<2], nxt[MAXP<<2], cnt, A, B;\nint dfn[MAXP], low[MAXP], stk[MAXP], indx, scc[MAXP];\nchar s[MAXN][MAXN];\npair<int,int>pos[MAXP];\n\ninline void link(int u, int v) {\n    to[++cnt] = v; nxt[cnt] = fir[u]; fir[u] = cnt;\n    to[++cnt] = u; nxt[cnt] = fir[v]; fir[v] = cnt;\n}\nbool vis[MAXN][MAXN];\nbool can[MAXN][MAXN][4][4];\n//0 : L\n//1 : R\n//2 : U\n//3 : D\nconst int Dx[4] = { 0, 0, -1, 1 };\nconst int Dy[4] = { -1, 1, 0, 0 };\ninline void ins(int k) {\n    vis[pos[k].first][pos[k].second] = 1;\n    for(int u, v, i = 0; i < 4; ++i) {\n        u = pos[k].first - Dx[i];\n        v = pos[k].second - Dy[i];\n        if(u >= 1 && u <= n && v >= 1 && v <= m && s[u][v] != '#') {\n            for(int x, y, j = 0; j < 4; ++j) if(j!=i) {\n                x = u + Dx[j], y = v + Dy[j];\n                if(x >= 1 && x <= n && y >= 1 && y <= m && s[x][y] != '#' && vis[x][y])\n                    can[u][v][i][j] = can[u][v][j][i] = 1;\n            }\n        }\n    }\n}\ninline void del(int k) {\n    vis[pos[k].first][pos[k].second] = 0;\n}\ninline void tarjan(int u, int ff) {\n    dfn[u] = low[u] = ++tmr;\n    stk[++indx] = u;\n    for(int v, i = fir[u], j; i; i = nxt[i])\n        if((v=to[i]) != ff) {\n            if(!dfn[v]) {\n                tarjan(v, u), low[u] = min(low[u], low[v]);\n                if(low[v] >= dfn[u]) {\n                    for(j = indx; ; --j) {ins(stk[j]); if(stk[j] == v) break; } if(dfn[u]==low[v])ins(u);\n                    for(j = indx; ; --j) {del(stk[j]); if(stk[j] == v) break; } if(dfn[u]==low[v])del(u);\n                    indx = j-1;\n                }\n            }\n            else low[u] = min(low[u], dfn[v]);\n        }\n}\n\nbool dis[MAXN][MAXN];\ninline void bfs(int Sx, int Sy) {\n    queue<pair<int,int> >Q;\n    Q.push(pair<int, int>(Sx, Sy));\n    dis[Sx][Sy] = 1;\n    while(!Q.empty()) {\n        int u = Q.front().first, v = Q.front().second; Q.pop();\n        for(int x, y, i = 0; i < 4; ++i) {\n            x = u + Dx[i], y = v + Dy[i];\n            if(x >= 1 && x <= n && y >= 1 && y <= m && s[x][y] == '.' && !dis[x][y]) {\n                dis[x][y] = 1, Q.push(pair<int, int>(x, y));\n            }\n        }\n    }\n}\nstruct node {\n    int x, y, z;\n    node(){}\n    node(int x, int y, int z):x(x), y(y), z(z){}\n};\nbool f[MAXN][MAXN][4];\nqueue<node>que;\nint main () {\n    //freopen(\"pushbox.in\", \"r\", stdin);\n    //freopen(\"pushbox.out\", \"w\", stdout);\n    scanf(\"%d%d%d\", &n, &m, &q);\n    for(int i = 1; i <= n; ++i) {\n        scanf(\"%s\", s[i]+1);\n        for(int j = 1; j <= m; ++j) {\n            if(s[i][j] != '#') {\n                id[i][j] = ++tot;\n                pos[tot] = pair<int,int>(i, j);\n                if(j > 1 && s[i][j-1] != '#') link(id[i][j-1], id[i][j]);\n                if(i > 1 && s[i-1][j] != '#') link(id[i-1][j], id[i][j]);\n            }\n            if(s[i][j] == 'A') A = id[i][j];\n            if(s[i][j] == 'B') B = id[i][j];\n        }\n    }\n    tarjan(B, 0);\n    bfs(pos[A].first, pos[A].second);\n    int Sx = pos[B].first, Sy = pos[B].second;\n    if(dis[Sx][Sy-1]) f[Sx][Sy][0] = 1, que.push(node(Sx, Sy, 0));\n    if(dis[Sx][Sy+1]) f[Sx][Sy][1] = 1, que.push(node(Sx, Sy, 1));\n    if(dis[Sx-1][Sy]) f[Sx][Sy][2] = 1, que.push(node(Sx, Sy, 2));\n    if(dis[Sx+1][Sy]) f[Sx][Sy][3] = 1, que.push(node(Sx, Sy, 3));\n    while(!que.empty()) {\n        int u = que.front().x, v = que.front().y, w = que.front().z; que.pop();\n        int x = u - Dx[w], y = v - Dy[w];\n        if(x >= 1 && x <= n && y >= 1 && y <= m && s[x][y] != '#' && !f[x][y][w])\n            f[x][y][w] = 1, que.push(node(x, y, w));\n        for(int i = 0; i < 4; ++i)\n            if(i != w && can[u][v][w][i] && !f[u][v][i]) {\n                f[u][v][i] = 1, que.push(node(u, v, i));\n            }\n    }\n    int Tx, Ty;\n    while(q--) {\n        scanf(\"%d%d\", &Tx, &Ty);\n        puts((s[Tx][Ty] == 'B' || f[Tx][Ty][0] || f[Tx][Ty][1] || f[Tx][Ty][2] || f[Tx][Ty][3]) ? \"YES\" : \"NO\");\n    }\n}\n```\n",
        "postTime": 1563262165,
        "uid": 30433,
        "name": "Ark_",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4082 \u3010[USACO17DEC]Push a Box\u3011"
    },
    {
        "content": "\u7ecf\u5178\uff08\uff1f\uff09\u7684\u63a8\u7bb1\u5b50\u95ee\u9898\u3002\n\n\u8003\u8651\u8bb0\u5f55 (\u7bb1\u5b50\u7684\u4f4d\u7f6e, bessie \u7684\u4f4d\u7f6e) \u8fd9\u6837\u7684\u4e8c\u5143\u7ec4\u5f53\u4f5c\u72b6\u6001\uff0c\u6b63\u786e\u6027\u80af\u5b9a\u662f\u53ef\u4ee5\u7684\u3002\u4f46\u662f\u72b6\u6001\u662f $(nm)^2$ \u8fd9\u5c31\u4e0d\u597d\u4e86\u3002\u4f46\u662f\u5bb9\u6613\u89c2\u5bdf\u5230\u53ea\u6709\u5f53\u7bb1\u5b50\u548c bessie \u6328\u5728\u4e00\u8d77\u7684\u65f6\u5019\u7684\u72b6\u6001\u624d\u662f\u6211\u4eec\u9700\u8981\u5173\u5fc3\u7684\u5173\u952e\u72b6\u6001\uff0c\u56e0\u4e3a\u8fd9\u6837\u624d\u80fd\u63a8\u5f97\u52a8\u7bb1\u5b50\u3002\u4f60 bessie \u8981\u662f\u628a\u7bb1\u5b50\u653e\u7740\u4e0d\u52a8\uff0c\u81ea\u5df1\u5230\u5904\u6e38\u8d70\uff0c\u90a3\u8c01\u7ba1\u4f60\u53bb\u4e86\u90a3\u4e9b\u666f\u70b9\u65c5\u6e38\u554a\u3002\n\n\u63a5\u4e0b\u6765\u8981\u505a\u7684\u4e8b\u60c5\u5c31\u662f\u7ed9\u8fd9 $4nm$ \u4e2a\u72b6\u6001\u4e4b\u95f4\u8fde\u8fb9\uff0c\u628a\u5b83\u4eec\u7684\u8fde\u901a\u6027\u786e\u5b9a\u4e0b\u6765\u3002\u521d\u59cb\u72b6\u6001\u663e\u7136\u6700\u591a\u53ea\u6709 $4$ \u79cd\uff0c\u5bf9\u7ed3\u675f\u4f4d\u7f6e\u663e\u7136\u4e5f\u53ea\u6709\u6700\u591a $4$ \u79cd\u72b6\u6001\uff0c\u6700\u7ec8\u8fd9 $16$ \u5bf9\u4e2d\u81f3\u5c11\u4e00\u7ec4\u8fde\u901a\uff0c\u90a3\u7b54\u6848\u5c31\u662f `YES` \u5426\u5219\u662f `NO`\u3002\n\n\u72b6\u6001\u4e4b\u95f4\u7684\u8fde\u8fb9\u53ea\u6709\u4e24\u79cd\uff1a\u4e00\u79cd\u662f\u5f80\u5f53\u524d\u65b9\u5411\u63a8\u4e00\u683c\uff0c\u4e00\u79cd\u662f bessie \u6362\u4e2a\u65b9\u4f4d\u3002\u524d\u8005\u6bd4\u8f83\u7b80\u5355\uff0c\u5c31\u770b\u770b\u524d\u65b9\u6709\u6ca1\u6709\u969c\u788d\u7269\u5c31\u884c\u4e86\uff08\u8fde\u7684\u662f\u6709\u5411\u8fb9\u554a\uff01\uff09\u3002\u540e\u8005\u7684\u8bdd\uff0c\u5224\u7684\u5c31\u662f\u5728\u539f\u56fe\u57fa\u7840\u4e0a\uff0c\u628a\u7bb1\u5b50\u7684\u4f4d\u7f6e\u5835\u4f4f\uff08\u5176\u5b9e\u5c31\u662f\u5272\u6389\u8fd9\u4e2a\u70b9\uff09\u7136\u540e\u4e24\u79cd bessie \u7684\u4f4d\u7f6e\u662f\u5426\u8fde\u901a\u3002\u90a3\u8fd9\u5c31\u662f\u5706\u65b9\u6811\u7684\u62ff\u624b\u597d\u620f\u4e86\u2014\u2014\u56e0\u4e3a\u628a\u67d0\u4e2a\u70b9\u5272\u6389\u4e4b\u540e\u539f\u56fe\u7684\u5206\u88c2\u60c5\u51b5\u8ddf\u5706\u65b9\u6811\u4e00\u81f4\u3002\u6211\u4eec\u53ea\u9700\u8981\u627e\u51fa $4$ \u79cd\u4f4d\u7f6e\u5404\u5728\u54ea\u4e2a\u513f\u5b50\u6811\u91cc\uff08\u6216\u8005\u662f\u5272\u6389\u7684\u70b9\u7684\u5b50\u6811\u7684\u8865\u96c6\uff09\uff0c\u679a\u4e3e\u4e00\u4e0b\u7136\u540e\u7528\u5b50\u6811\u7684\u65f6\u95f4\u6233\u533a\u95f4\u5224\u5c31\u53ef\u4ee5\u4e86\u3002\u590d\u6742\u5ea6\u662f\u5747\u644a\u7684\uff0c\u4e0d\u7528\u62c5\u5fc3\uff0c\u867d\u7136\u5e38\u6570\u6709\u70b9\u5927\u4f46\u5e38\u6570\u74f6\u9888\u4e0d\u5728\u8fd9\u91cc\u3002\n\n\u4e0a\u9762\u7684\u540e\u8005\u8fde\u8fb9\u4e2d\uff0c\u5e76\u4e0d\u662f $4$ \u79cd\u60c5\u51b5\u7684\u6bcf\u4e00\u5bf9\u8fde\u901a\u5bf9\u90fd\u8981\u8fde\u53cc\u5411\u8fb9\uff0c\u5982\u679c\u8fd9\u6837\u7684\u8bdd\u6700\u591a\u8981\u8fde $2\\dbinom{4}{2}=12$ \u6761\u8fb9\uff0c\u5e73\u5747\u6bcf\u4e2a\u70b9\u8fde\u51fa $3$ \u6761\u3002\u5176\u5b9e\u53ef\u4ee5\u627e\u5230\u6bcf\u4e2a\u8fde\u901a\u7c7b\uff0c\u7136\u540e\u7528\u4e00\u4e2a\u6709\u5411\u73af\u8fde\u8d77\u6765\uff0c\u8fd9\u6837\u6bcf\u4e2a\u70b9\u8fde\u51fa $1$ \u6761\u3002\u4e0d\u96be\u53d1\u73b0\u7ed3\u5408\u524d\u8005\u548c\u540e\u8005\u4e00\u5171\u8981\u8fde $8nm$ \u6761\u8fb9\uff0c\u8fd9\u5927\u6982\u5230\u4e86 1e7 \u7ea7\u522b\u3002\u800c\u6211\u4e2a\u4eba\u4e0d\u592a\u559c\u6b22\u94fe\u5f0f\u524d\u5411\u661f\u90a3\u4e1c\u897f\uff0c\u8fd9\u9898\u4e00\u5f00\u59cb\u4e5f\u5c31\u7528 `vector` \u5199\u4e86\u3002\u90a3\u4e48\u88ab\u5361\u7a7a\u95f4\u3001\u5361\u65f6\u95f4\u65e0\u7591\u4e86\u3002\u628a `vector` \u6362\u6210\u94fe\u5f0f\u524d\u5411\u661f\u7acb\u523b\u5c31\u8fc7\u4e86\uff0c\u800c\u4e14\u8dd1\u5f97\u5f88\u5feb\uff0c\u4f7f\u7528\u7a7a\u95f4\u4e5f\u53ea\u6709 ML \u7684\u4e00\u534a\u2014\u2014STL\uff0c\u5c24\u5176\u662f `vector` `deque` \u4e4b\u6d41\uff0c\u786e\u5b9e\u662f\u5962\u4f88\u54c1\u3002\u4e0b\u6b21\u8981\u662f\u518d\u5728\u6709\u5361\u7a7a\u3001\u5361\u65f6\u98ce\u9669\u7684\u56fe\u8bba\u9898\u91cc\u4e0d\u679c\u65ad\u7528\u94fe\u5f0f\u524d\u5411\u661f\uff0c\u6211\u5c31 dlxt \u597d\u5427\uff01\uff01\uff08\u628a `vector` \u6362\u6210\u524d\u5411\u661f\u771f\u7684\u5f88\u9ebb\u70e6\uff0c\u8fd8\u4e0d\u5982\u4e00\u5f00\u59cb\u5c31\u5199\uff09\n\n\u53e6\u5916\u8fd9\u9898\u6709\u4e2a\u5c0f\u5751\u3002\u5982\u679c\u76ee\u7684\u5730\u5c31\u662f\u7bb1\u5b50\u672c\u6765\u5728\u7684\u5730\u65b9\u7684\u8bdd\uff0c\u4f60 bessie \u751a\u81f3\u4e0d\u9700\u8981\u80fd\u5230\u8fbe\u7bb1\u5b50\u5468\u56f4\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define pb push_back\nconst int N=1510;\nint n,m,qu;\nchar a[N][N];\nint id(int x,int y){return (x-1)*m+y;}\nstruct addedge_nei{\n\tint sz,head[N*N],nxt[4*N*N],val[4*N*N];\n\taddedge_nei(){sz=0,memset(head,0,sizeof(head));}\n\tvoid ae(int x,int y){\n\t\tsz++,nxt[sz]=head[x],head[x]=sz,val[sz]=y;\n\t}\n}nei;\nint dfn[2*N*N],low[N*N],nowdfn;\nint stk[N*N],top;\nint cnt;\nstruct addedge_cnei{\n\tint sz,head[2*N*N],nxt[4*N*N],val[4*N*N];\n\taddedge_cnei(){sz=0,memset(head,0,sizeof(head));}\n\tvoid ae(int x,int y){\n\t\tsz++,nxt[sz]=head[x],head[x]=sz,val[sz]=y;\n\t}\n}cnei;\nvoid tar(int x,int fa=0){\n\tstk[top++]=x;\n\tdfn[x]=low[x]=++nowdfn;\n\tif(!fa&&nei.head[x]==0)return cnt++,cnei.ae(n*m+cnt,x),cnei.ae(x,n*m+cnt),void();\n\tfor(int i=nei.head[x];i;i=nei.nxt[i]){\n\t\tint y=nei.val[i];\n\t\tif(y==fa){fa=-1;continue;}\n\t\tif(!dfn[y]){\n\t\t\ttar(y,x),low[x]=min(low[x],low[y]);\n\t\t\tif(dfn[x]<=low[y]){\n\t\t\t\tcnt++;\n\t\t\t\twhile(true){\n\t\t\t\t\tint z=stk[--top];\n\t\t\t\t\tcnei.ae(n*m+cnt,z),cnei.ae(z,n*m+cnt);\n\t\t\t\t\tif(z==y)break;\n\t\t\t\t}\n\t\t\t\tcnei.ae(n*m+cnt,x),cnei.ae(x,n*m+cnt);\n\t\t\t}\n\t\t}\n\t\telse low[x]=min(low[x],dfn[y]);\n\t}\n}\nint mxdfn[2*N*N];\nvoid dfs(int x,int fa=0){\n\tdfn[x]=mxdfn[x]=++nowdfn;\n\tfor(int i=cnei.head[x];i;i=cnei.nxt[i]){\n\t\tint y=cnei.val[i];\n\t\tif(y==fa)continue;\n\t\tdfs(y,x);\n\t\tmxdfn[x]=mxdfn[y];\n\t}\n}\nconst int dx[]={0,1,0,-1},dy[]={1,0,-1,0};\nconst string str[]={\"right\",\"down\",\"left\",\"up\"};\nint id0(int x,int y){return x*4-y;}\nstruct addedge_nei0{\n\tint sz,head[4*N*N],nxt[8*N*N],val[8*N*N];\n\taddedge_nei0(){sz=0,memset(head,0,sizeof(head));}\n\tvoid ae(int x,int y){\n\t\tsz++,nxt[sz]=head[x],head[x]=sz,val[sz]=y;\n\t}\n}nei0;\nbool vis0[4*N*N];\nvoid dfs1(int x){\n\tvis0[x]=true;\n\tfor(int i=nei0.head[x];i;i=nei0.nxt[i]){\n\t\tint y=nei0.val[i];\n\t\tif(!vis0[y])dfs1(y);\n\t}\n}\nbool ok(int x,int y){return 1<=x&&x<=n&&1<=y&&y<=m&&a[x][y]!='#';}\nbool vis[N*N];\nvoid dfs0(int x,int ban){\n\tvis[x]=true;\n\tfor(int i=nei.head[x];i;i=nei.nxt[i]){\n\t\tint y=nei.val[i];\n\t\tif(!vis[y]&&y!=ban)dfs0(y,ban);\n\t}\n}\nint main(){\n\tcin>>n>>m>>qu;\n\tfor(int i=1;i<=n;i++)scanf(\"%s\",a[i]+1);\n\tfor(int i=1;i<=n;i++)for(int j=1;j<=m;j++)if(a[i][j]!='#'){\n\t\tif(i<n&&a[i+1][j]!='#')nei.ae(id(i,j),id(i+1,j)),nei.ae(id(i+1,j),id(i,j));\n\t\tif(j<m&&a[i][j+1]!='#')nei.ae(id(i,j),id(i,j+1)),nei.ae(id(i,j+1),id(i,j));\n\t}\n\tfor(int i=1;i<=n*m;i++)if(!dfn[i])tar(i);\n\tmemset(dfn,0,sizeof(dfn));nowdfn=0;\n\tfor(int i=1;i<=n*m;i++)if(!dfn[i])dfs(i);\n\tint A,B;\n\tfor(int i=1;i<=n;i++)for(int j=1;j<=m;j++){\n\t\tif(a[i][j]=='A')A=id(i,j);\n\t\tif(a[i][j]=='B')B=id(i,j);\n\t}\n\tdfs0(A,B);\n\tvector<int> init;\n\tfor(int i=1;i<=n;i++)for(int j=1;j<=m;j++)if(a[i][j]!='#'){\n\t\tint x=id(i,j),in[4]={};\n\t\tfor(int k=0;k<4;k++){\n\t\t\tint xn=i+dx[k],yn=j+dy[k];\n\t\t\tif(!ok(xn,yn)){in[k]=-1;continue;}\n\t\t\tif(x==B&&vis[id(xn,yn)])init.pb(id0(x,k));\n\t\t\tint now=0;\n\t\t\tfor(int o=cnei.head[x];o;o=cnei.nxt[o]){\n\t\t\t\tnow++;\n\t\t\t\tint y=cnei.val[o];\n\t\t\t\tif(dfn[y]<dfn[x])continue;\n\t\t\t\tif(dfn[y]<=dfn[id(xn,yn)]&&dfn[id(xn,yn)]<=mxdfn[y])in[k]=now;\n\t\t\t}\n\t\t\tint xx=i-dx[k],yy=j-dy[k];\n\t\t\tif(!ok(xx,yy))continue;\n\t\t\tnei0.ae(id0(x,k),id0(id(xx,yy),k));\n\t\t}\n\t\tfor(int k=0;k<10;k++){\n\t\t\tvector<int> v;\n\t\t\tfor(int o=0;o<4;o++)if(in[o]==k)v.pb(id0(x,o));\n\t\t\tfor(int o=0;o+1<v.size();o++)nei0.ae(v[o],v[o+1]);\n\t\t\tif(v.size()>1)nei0.ae(v.back(),v[0]);\n\t\t}\n\t}\n\tfor(int i=0;i<init.size();i++)dfs1(init[i]);\n\twhile(qu--){\n\t\tint x,y;\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tbool yes=id(x,y)==B;\n\t\tfor(int i=0;i<4;i++)yes|=vis0[id0(id(x,y),i)];\n\t\tputs(yes?\"YES\":\"NO\");\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1628423926,
        "uid": 138400,
        "name": "chenxia25",
        "ccfLevel": 9,
        "title": "p4082"
    },
    {
        "content": "\u8fd9\u9053\u9898\u76ee\u6709\u4e24\u79cd\u51b3\u7b56\uff08\u5047\u8bbef[x][y][i]\u4ee3\u8868\u8868\u793ax,y\u7531i\u8fd9\u4e2adx,dy\u8f6c\u79fb\u8fc7\u6765\u7684\u53ef\u884c\u6027\uff09\uff1a   \n1. \u4ee5\u8fd9\u4e2a\u65b9\u5411\u7ee7\u7eed\u63a8   \n2. \u4ece\u8fd9\u4e2a\u76f8\u90bb\u70b9\u5230\u53e6\u4e00\u4e2a\u76f8\u90bb\u70b9\u4e14\u4e0d\u7ecf\u8fc7\u7bb1\u5b50\u6240\u5728\u7684\u70b9\n\n\u7b2c\u4e00\u79cd\u60c5\u51b5\u53ef\u4ee5\u7b80\u5355\u901a\u8fc7bfs\u8f6c\u79fb\n\n\u7b2c\u4e8c\u79cd\u60c5\u51b5\u53ef\u4ee5\u5efa\u5706\u65b9\u6811\u89e3\u51b3\uff0c\u4f46\u6211\u4eec\u53ea\u9700\u8981\u8bb0\u5f55\u70b9\u53cc\u8fde\u901a\u5206\u91cf\u7684\u7236\u4eb2\u3002\u5f53\u4e00\u4e2a\u76f8\u90bb\u70b9\u8f6c\u79fb\u5230\u53e6\u4e00\u4e2a\u76f8\u90bb\u70b9\u65f6\uff0c\u5982\u679c\u53ef\u4ee5\u4e0d\u7528\u7ecf\u8fc7\u683c\u5b50\u7684\u8bdd\uff0c\u7b49\u4ef7\u4e8e(pos\u4ee3\u8868x\u5c5e\u4e8e\u7684\u70b9\u53cc\u8fde\u901a\u5206\u91cf)fa[pos[x]]=y||fa[pos[y]]=x||x==y\n\n\u5728\u5904\u7406\u6240\u6709\u60c5\u51b5\u540e\uff0c\u6bcf\u6b21\u8be2\u95ee\u90fd\u662fO(1)\u7684\u3002\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6O(n*m);\n```\n#pragma GCC optimize(2)\n#pragma GCC optimize(3)\n#pragma GCC optimize(4)\n#pragma GCC optimize(\"Ofast,no-stack-protector\")\n#include <bits/stdc++.h>\n#define res register int\n#define N 1505\n#define M 2265025\nconst int dx[4]={0,-1,1,0};\nconst int dy[4]={-1,0,0,1};\nusing namespace std;\nint n,m,Q,st[M],f[N][N][4],q,top,id[N][N],tot,fa[M],tim,sx,sy,ex,ey,d[M],num,dfn[M],low[M],cnt,pos[M];\nchar s[N];\nbool vis[N][N];\ninline int read(){\n\tres w=0,X=0;char ch=0;\n\twhile(!isdigit(ch)){w|=ch=='-';ch=getchar();}\n\twhile(isdigit(ch)){X=(X<<1)+(X<<3)+(ch^48);ch=getchar();}\n\treturn w?-X:X;\n}\nstruct papa{\n\tint to,next;\n}e[M<<2];\nstruct point{\n\tint x,y,op;\n\tpoint():x(0),y(0),op(0){};\n\tpoint(int x0,int y0):x(x0),y(y0),op(-1){};\n\tpoint(int x0,int y0,int op0):x(x0),y(y0),op(op0){};\n};\nqueue<point> l;\ninline void add(res x,res y){\n\te[++tot].to=y;\n\te[tot].next=d[x];\n\td[x]=tot;\n}\ninline bool check(res x,res y){\n\treturn pos[x]==pos[y]||fa[pos[x]]==y||fa[pos[y]]==x;\n}\ninline void tarjan(res now,res fath){\n\tdfn[now]=low[now]=++tim;\n\tst[++top]=now;\n\tfor(res i=d[now];i;i=e[i].next){\n\t\tres x=e[i].to;\n\t\tif(x==fath) continue;\n\t\tif(!dfn[x]){\n\t\t\ttarjan(x,now);\n\t\t\tlow[now]=min(low[now],low[x]);\n\t\t\tif(dfn[now]>low[x]) continue;\n\t\t\tnum++;\n\t\t\tfa[num]=now;\n\t\t\tfor(;st[top]!=x;){\n\t\t\t\tpos[st[top]]=num;\n\t\t\t\ttop--;\n\t\t\t}\n\t\t\tpos[st[top]]=num;\n\t\t\ttop--;\n\t\t}\n\t\telse\n\t\t  low[now]=min(low[now],dfn[x]);\n\t}\n}\nint main(){\n\tn=read(),m=read(),q=read();\n\tfor(res i=1;i<=n;i++){\n\t\tscanf(\"%s\",s+1);\n\t\tfor(res j=1;j<=m;j++){\n\t\t\tif(s[j]=='#') continue;\n\t\t\tid[i][j]=++cnt;\n\t\t\tif(s[j]=='A') sx=i,sy=j;\n\t\t\tif(s[j]=='B') ex=i,ey=j;\n\t\t\tfor(res k=0;k<2;k++){\n\t\t\t\tres nx=i+dx[k],ny=j+dy[k];\n\t\t\t\tif(nx<1||nx>n||ny<1||ny>m||!id[nx][ny]) continue;\n\t\t\t\tadd(id[i][j],id[nx][ny]),add(id[nx][ny],id[i][j]);\n\t\t\t}\n\t\t}\n\t}\n\tnum=cnt;\n\tfor(res i=1;i<=cnt;i++)\n\t  if(!dfn[i])\n\t    tarjan(i,-1);\n\tl.push(point(sx,sy));\n\twhile(!l.empty()){\n\t\tres x=l.front().x,y=l.front().y;\n\t\tl.pop();\n\t\tfor(res i=0;i<4;i++){\n\t\t\tres nx=x+dx[i],ny=y+dy[i];\n\t\t\tif(nx<1||nx>n||ny<1||ny>m||!id[nx][ny]||vis[nx][ny]|(nx==ex&&ny==ey)) continue;\n\t\t\tvis[nx][ny]=1;\n\t\t\tl.push(point(nx,ny));\n\t\t}\n\t}\n\tmemset(f,-1,sizeof(f));\n\tfor(res i=0;i<4;i++){\n\t\tres nx=ex+dx[i],ny=ey+dy[i];\n\t\tif(nx<1||nx>n||ny<1||ny>n||!vis[nx][ny]) continue;\n\t\tf[ex][ey][i]=0;//f[x][y][i]\u8868\u793ax,y\u7531i\u8fd9\u4e2adx,dy\u8f6c\u79fb\u8fc7\u6765\u7684\u53ef\u884c\u6027 \n\t\tl.push(point(ex,ey,i));\n\t}\n\tmemset(vis,0,sizeof(vis));\n\tvis[ex][ey]=1;\n\twhile(!l.empty()){\n\t\tres x=l.front().x,y=l.front().y,op=l.front().op;\n\t\tl.pop();\n\t\tres nx=x+dx[3-op],ny=y+dy[3-op];\n\t\tvis[x][y]=1;\n\t\tif(nx>=1&&nx<=n&&ny>=1&&ny<=m&&id[nx][ny]&&f[nx][ny][op]==-1)\n\t\t  f[nx][ny][op]=f[x][y][op]+1,l.push(point(nx,ny,op));\n\t\tfor(res i=0;i<4;i++){\n\t\t\tif(f[x][y][i]!=-1) continue;\n\t\t\tnx=x+dx[i],ny=y+dy[i];\n\t\t\tif(!id[nx][ny]) continue;\n\t\t\tif(!check(id[nx][ny],id[x+dx[op]][y+dy[op]])) continue;\n\t\t\tf[x][y][i]=f[x][y][op];\n\t\t\tl.push(point(x,y,i));\n\t\t}\n\t}\n\tfor(;q;q--){\n\t\tres x=read(),y=read();\n\t\tvis[x][y]==1?puts(\"YES\"):puts(\"NO\"); \n\t}\n\treturn 0;\n}\n```",
        "postTime": 1538185236,
        "uid": 26848,
        "name": "miaokehao",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4082 \u3010[USACO17DEC]Push a Box\u3011"
    },
    {
        "content": "# \u9898\u76ee\uff1a\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[\u70b9\u8fd9\u91cc](https://www.luogu.org/problemnew/show/P4082)\u770b\u9898\u76ee\u3002\n# \u5206\u6790\uff1a\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u7ecf\u5178\u7684\u63a8\u7bb1\u5b50~~\u6e38\u620f~~\u95ee\u9898\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u5148\u7ed9\u51fa\u4e00\u79cd\u66b4\u529b\u505a\u6cd5\u5427\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u5bf9\u7bb1\u5b50\u8fdb\u884c$BFS$\u3002\u5728\u6bcf\u6b21\u8f6c\u79fb\u72b6\u6001\u7684\u65f6\u5019\uff0c\u518d\u7528\u4e00\u4e2a$BFS$\u68c0\u67e5\u4eba\u80fd\u4e0d\u80fd\u5230\u9700\u8981\u5230\u7684\u5730\u65b9\u53bb\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u53ef\u4ee5\u770b\u51fa\uff0c\u8fd9\u79cd~~\u50bb\u903c\u53c8\u667a\u969c~~\u7684\u65b9\u6cd5\u7684\u65f6\u95f4\u592a\u5927\uff0c\u8fbe\u5230\u4e86$O((X\\times Y)^2)$\uff0c\u5b8c\u5168\u65e0\u6cd5\u8fc7\u9898\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u6df1\u5165\u601d\u8003\u4e00\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u8be5\u65b9\u6cd5\u4e2d\u6700\u8017\u65f6\u95f4\u7684\u5730\u65b9\u5728\u4e8e\uff1a  \n\n> \u201c\u68c0\u67e5\u4eba\u80fd\u4e0d\u80fd\u5230\u9700\u8981\u5230\u7684\u5730\u65b9\u201d  \n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u8fd9\u4e5f\u662f\u6211\u4eec\u4f18\u5316\u7684\u8d77\u70b9\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u73b0\u5728\uff0c\u6211\u4eec\u628a\u539f\u6765\u7684\u5730\u56fe\u91cd\u6784\u6210\u4e00\u5f20\u56fe\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u7531\u4e8e\u7bb1\u5b50\u5728\u7684\u4f4d\u7f6e\u4eba\u65e0\u6cd5\u901a\u8fc7\uff0c\u76f8\u5f53\u4e8e\u65b0\u56fe\u4e2d**\u7bb1\u5b50\u4f4d\u7f6e\u7684\u70b9\u88ab\u53d6\u4e0b\u6765\u4e86**\u3002\u5173\u4e8e\u53d6\u70b9\u8fd9\u4e2a\u201c\u8bdd\u9898\u201d\uff0c\u6211\u4eec\u5f88\u81ea\u7136\u5730\u60f3\u5230\u4e86\u5272\u70b9\u3002\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5bf9\u7bb1\u5b50\u7684\u4f4d\u7f6e\u8fdb\u884c\u5982\u4e0b\u8ba8\u8bba\uff1a  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.\u7bb1\u5b50\u4e0d\u5728\u539f\u56fe\u7684\u5272\u70b9\u4e0a\u3002\u6b64\u65f6\u7bb1\u5b50\u6ca1\u6709\u4f7f\u539f\u56fe\u7684\u8fde\u901a\u6027\u6539\u53d8\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u68c0\u67e5\u8d77\u59cb\u70b9\u548c\u76ee\u6807\u70b9\u662f\u5426\u5728\u4e00\u4e2a\u8fde\u901a\u5757\u91cc\u5373\u53ef\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.\u7bb1\u5b50\u5728\u539f\u56fe\u7684\u5272\u70b9\u4e0a\u3002\u6b64\u65f6\u7bb1\u5b50\u5bf9\u539f\u56fe\u7684\u8fde\u901a\u6027\u6709\u5f71\u54cd\uff0c\u6240\u4ee5\u9700\u8981\u68c0\u67e5\u8d77\u59cb\u70b9\u548c\u76ee\u6807\u70b9\u662f\u5426\u5728\u4e00\u4e2a**\u70b9\u53cc\u8fde\u901a\u5206\u91cf**\u4e2d\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u7528$Tarjan$\u5904\u7406\u51fa\u4e0a\u9762\u7684\u4e1c\u897f\u4e4b\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6109\u5feb\u5730\u7528$BFS$\u8fc7\u9898\u5566\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\uff08$PS$\uff1a\u4e0d\u77e5\u9053$Tarjan$\u548c\u5272\u70b9\u7684\u670b\u53cb\u8bf7\u8fdb[\u4f20\u9001\u95e8](https://www.luogu.org/blog/styx-ferryman/chu-tan-tarjan-suan-fa-qiu-qiang-lian-tong-fen-liang-post)\uff09\n\n# \u4ee3\u7801\uff1a\n```cpp\n#include <stack>\n#include <queue>\n#include <cstdio>\n#include <cstring>\nusing namespace std;\n\nconst int MAXN = 1505, MAXM = 1505, MAXQ = 50005;\n\ntemplate<typename _T>\nvoid read( _T &x )\n{\n\tx = 0;char s = getchar();int f = 1;\n\twhile( s < '0' || '9' < s ){ if( s == '-' ) f = -1; s = getchar(); }\n\twhile( '0' <= s && s <= '9' ){ x = ( x << 3 ) + ( x << 1 ) + ( s - '0' ), s = getchar(); }\n\tx *= f;\n}\n\ntemplate<typename _T>\nvoid write( _T x )\n{\n\tif( x < 0 ){ x = -x, putchar( '-' ); }\n\tif( 9 < x ){ write( x / 10 ); }\n\tputchar( x % 10 + '0' );\n}\n\ntemplate<typename _T>\n_T MIN( const _T a, const _T b )\n{\n\treturn a < b ? a : b;\n}\n\nstruct node\n{\n\tint bx, by, side;\n\tnode(){}\n\tnode( const int Bx, const int By, const int type )\n\t{\n\t\tbx = Bx, by = By, side = type;\n\t}\n};\n\nqueue<node> q;\nstack<pair<int, int> > sta;\n\nint dir[4][2] = { { -1, 0 }, { 1, 0 }, { 0, -1 }, { 0, 1 } };\nint query[MAXN][MAXM];\nint DFN[MAXN][MAXM], LOW[MAXN][MAXM], color[MAXN][MAXM], beIn[MAXN][MAXM][5];\n//\u7531\u4e8e\u65b0\u56fe\u4e2d\u4e00\u4e2a\u70b9\u6700\u591a\u4f1a\u8fde\u51fa4\u6761\u8fb9\uff0c\u6240\u4ee5\u4e00\u4e2a\u70b9\u4e5f\u6700\u591a\u4f1a\u57284\u4e2a\u70b9\u53cc\u8fde\u901a\u5206\u91cf\u91cc\u9762\uff0c\u6545\u8bb0\u5f55\u70b9\u6240\u5904\u70b9\u53cc\u8fde\u901a\u5206\u91cf\u7f16\u53f7\u7684beIn\u6570\u7ec4\u5c31\u53ef\u4ee5\u53ea\u5f005\u4e2a\u3002\nint N, M, Q, sx, sy, bx, by, ID, tot, col;\nchar obs[MAXM];\nbool isCut[MAXN][MAXM];\nbool mp[MAXN][MAXM], visited[MAXN][MAXM][4] = {}, ans[MAXQ];\n\nbool inside( const int cx, const int cy )\n{\n\treturn 1 <= cx && cx <= N && 1 <= cy && cy <= M;\n}\n\nvoid Tarjan( const int x, const int y, const int fx, const int fy )\n{\n\tint tx, ty, cnt = 0;\n\tcolor[x][y] = col;\n    //\u7528\u67d3\u8272\u6cd5\u5904\u7406\u8fde\u901a\u5757\n\tDFN[x][y] = LOW[x][y] = ++ID;\n\tsta.push( make_pair( x, y ) );\n\tfor( int i = 0 ; i < 4 ; i ++ )\n\t{\n\t\ttx = dir[i][0] + x, ty = dir[i][1] + y;\n\t\tif ( inside( tx, ty ) && ! mp[tx][ty] )\n\t\t{\n\t\t\tif( ! DFN[tx][ty] )\n\t\t\t{\n\t\t\t\tcnt ++;\n\t\t\t\tTarjan( tx, ty, x, y );\n\t\t\t\tif ( DFN[x][y] <= LOW[tx][ty] )\n\t\t\t\t{\n\t\t\t\t\ttot ++;\n\t\t\t\t\tisCut[x][y] = true;\n\t\t\t\t\tpair<int, int> tar = make_pair( tx, ty ), tmp;\n\t\t\t\t\tdo\n\t\t\t\t\t{\n\t\t\t\t\t\ttmp = sta.top();sta.pop();\n\t\t\t\t\t\tbeIn[tmp.first][tmp.second][++beIn[tmp.first][tmp.second][0]] = tot;\n\t\t\t\t\t}while( tar != tmp );\n\t\t\t\t\tbeIn[x][y][++beIn[x][y][0]] = tot;\n\t\t\t\t}\n\t\t\t\tLOW[x][y] = MIN( LOW[x][y], LOW[tx][ty] );\n\t\t\t}\n\t\t\telse if( DFN[tx][ty] < DFN[x][y] && ( tx ^ fx || ty ^ fy ) )\n\t\t\t{\n\t\t\t\tLOW[x][y] = MIN( LOW[x][y], DFN[tx][ty] );\n\t\t\t}\n\t\t}\n\t}\n\tif( ! fx && ! fy && cnt == 1 ) isCut[x][y] = false;\n\tif( ! fx && ! fy && ! cnt ) beIn[x][y][++beIn[x][y][0]] = ++tot;\n}\n\n//\u4e8c\u7ef4\u60c5\u51b5\u4e0b\u7684Tarjan\n\nbool chk( const int obsX, const int obsY, const int fx, const int fy, const int tx, const int ty )\n{\n\tif( ! inside( fx, fy ) || ! inside( fx, fy ) ) return false;\n\tif( mp[fx][fy] || mp[tx][ty] ) return false;\n\tif( ! isCut[obsX][obsY] ) return color[fx][fy] == color[tx][ty];\n\tfor( int i = 1 ; i <= beIn[fx][fy][0] ; i ++ )\n\t{\n\t\tfor( int j = 1 ; j <= beIn[tx][ty][0] ; j ++ )\n\t\t{\n\t\t\tif( beIn[fx][fy][i] == beIn[tx][ty][j] ) return true;\n\t\t}\n\t}\n\treturn false;\n}\n\n//\u68c0\u67e5\u8d77\u70b9\u80fd\u5426\u5230\u8fbe\u7ec8\u70b9\n\nint sChk( const int cx, const int cy, const int px, const int py )\n{\n\tint tx, ty;\n\tfor( int i = 0 ; i < 4 ; i ++ )\n\t{\n\t\ttx = dir[i][0] + cx, ty = dir[i][1] + cy;\n\t\tif( tx == px && ty == py ) return i;\n\t}\n\treturn -1;\n}\n\nint trans( const int side )\n{\n\tif( side == 0 ) return 1;\n\tif( side == 1 ) return 0;\n\tif( side == 2 ) return 3;\n\tif( side == 3 ) return 2;\n}\n\nvoid BFS()\n{\n\twhile( ! q.empty() ) q.pop();\n\tint tx, ty;\n\tif( sChk( bx, by, sx, sy ) == -1 )\n\t{\n\t\tfor( int i = 0 ; i < 4 ; i ++ )\n\t\t{\n\t\t\ttx = dir[i][0] + bx, ty = dir[i][1] + by;\n\t\t\tif ( chk( bx, by, sx, sy, tx, ty ) )\n\t\t\t{\n\t\t\t\tq.push( node( bx, by, i ) );\n\t\t\t\tvisited[bx][by][i] = true;\n\t\t\t}\n\t\t}\n\t}\n\tnode head;\n\tint mx, my;\n\twhile( ! q.empty() )\n\t{\n\t\thead = q.front();\n\t\tq.pop();\n\t\tif( query[head.bx][head.by] ) ans[query[head.bx][head.by]] = true;\n\t\tfor( int i = 0 ; i < 4 ; i ++ )\n\t\t{\n\t\t\ttx = dir[i][0] + head.bx, ty = dir[i][1] + head.by;\n\t\t\tmx = dir[trans( i )][0] + head.bx, my = dir[trans( i )][1] + head.by;\n\t\t\tif( ! visited[tx][ty][trans( i )] && inside( tx, ty ) && ! mp[tx][ty] && chk( head.bx, head.by, head.bx + dir[head.side][0], head.by + dir[head.side][1], mx, my ) )\n\t\t\t{\n\t\t\t\tvisited[tx][ty][trans( i )] = true;\n\t\t\t\tq.push( node( tx, ty, trans( i ) ) );\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main()\n{\n//\tfreopen( \"pushbox.in\", \"r\", stdin );\n//\tfreopen( \"pushbox.out\", \"w\", stdout );\n\tread( N ), read( M ), read( Q );\n\tfor( int i = 1 ; i <= N ; i ++ )\n\t{\n\t\tscanf( \"%s\", obs + 1 );\n\t\tfor( int j = 1 ; j <= M ; j ++ )\n\t\t{\n\t\t\tswitch( obs[j] )\n\t\t\t{\n\t\t\t\tcase '#':\n\t\t\t\t{\n\t\t\t\t\tmp[i][j] = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase 'A':\n\t\t\t\t{\n\t\t\t\t\tsx = i, sy = j;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase 'B':\n\t\t\t\t{\n\t\t\t\t\tbx = i, by = j;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint qx, qy;\n\tfor( int i = 1 ; i <= Q ; i ++ )\n\t{\n\t\tread( qx ), read( qy );\n\t\tquery[qx][qy] = i;\n\t\tif( qx == bx && qy == by ) ans[i] = true;\n      //\u7279\u5224\u8d77\u70b9\u662f\u7ec8\u70b9\u7684\u60c5\u51b5\n\t}\n\tfor( int i = 1 ; i <= N ; i ++ )\n\t{\n\t\tfor( int j = 1 ; j <= M ; j ++ )\n\t\t{\n\t\t\tif( ! DFN[i][j] && ! mp[i][j] )\n\t\t\t{\n\t\t\t\tcol ++;\n\t\t\t\tTarjan( i, j, 0, 0 );\n\t\t\t}\n\t\t}\n\t}\n\tBFS();\n\tfor( int i = 1 ; i <= Q ; i ++ )\n\t{\n\t\tif( ans[i] ) puts( \"YES\" );\n\t\telse puts( \"NO\" );\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1563264961,
        "uid": 123809,
        "name": "crashed",
        "ccfLevel": 0,
        "title": "19\u5e74\u6691\u5047\u9ad8\u4e8c\u7b2c\u516d\u573a\u2014\u2014[USACODec. Platinum]Push a Box"
    }
]
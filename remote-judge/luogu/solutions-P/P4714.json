[
    {
        "content": "\u8fd9\u662f\u4e00\u7bc7 ~~\u5176\u5b9e\u6211\u4e0d\u600e\u4e48\u6562\u63d0\u4ea4\u7684~~ \u753b\u98ce\u4f18\u826f\uff0c\u8a00\u4e4b\u6210\u7406\uff0c\u8bed\u4e49\u6e05\u6670\uff0c\u8001\u5c11\u54b8\u5b9c\uff0c\u4e0d\u6d89\u53ca\u5230\u6570\u5b66\u540d\u8bcd ~~\u548c\u9ad8\u96be\u7b97\u6cd5\uff01~~\uff0c\u5e76\u4e14\u4e0d\u63ba\u6742\u5927\u91cf\u516c\u5f0f ~~\u662f\u4e2a\u4eba\u5c31\u80fd\u770b\u61c2~~ \u7684\u9898\u89e3\n\n~~\u672c\u9898\u89e3\u7684\u76ee\u7684\u5728\u4e8e\u8ba9\u8be5\u9898\u76ee\u6210\u4e3a\u6d45\u84dd\u9898~~ \u6211\u4f1a\u5c3d\u91cf\u6700\u6e05\u6670\u7684\u89e3\u91ca\u81ea\u5df1\u7684\u601d\u8def\uff0c\u5982\u679c\u8fd8\u662f\u4e0d\u61c2\uff0c\u53ef\u80fd\u4f60\u73b0\u5728\u4e0d\u9002\u5408\u8fd9\u6837\u7684\u9898\u76ee(~~\u7edd\u5bf9\u4e0d\u662f\u6211\u8bf4\u4e0d\u660e\u767d~~)\uff0c\u53ef\u4ee5\u8003\u8651\u52a0\u4efb\u52a1\u8ba1\u5212\u4ee5\u540e\u505a\u3002\u770b\u4e0d\u61c2\u4e2d\u6587\u770b\u5f0f\u5b50\uff0c\u770b\u4e0d\u61c2\u5f0f\u5b50\u8bfb\u4e2d\u6587\uff0c~~\u90fd\u770b\u4e0d\u61c2\u51fa\u95e8\u5de6\u8f6c~~\n\n(\u7528$\\prod_{i=1}^n$\u8868\u793a\u4ece$1$\u5230$n$\u4e58\u5728\u4e00\u8d77\uff0c\u7528$\\sum_{i=1}^n$\u8868\u793a\u52a0\u5728\u4e00\u8d77)\n\n~~\u5982\u679c\u4f60\u5df2\u7ecf\u77e5\u9053\u600e\u4e48\u505a\u5e76\u4e14\u53ea\u662f\u597d\u5947\u8fd9\u4e2a\u5947\u602a\u6807\u9898\u7684\u539f\u56e0\u5012\u7740\u770b\u5c31\u597d\u4e86~~\n\n\u9996\u5148\uff0c\u901a\u8fc7 ~~\u4e0d\u662f\u6570\u7ade\u751f\u6240\u4ee5\u53ef\u4ee5\u968f\u4fbf\u5927\u529b\u731c\u7ed3\u8bba\u7684\u66b4\u529b\u6253\u8868~~ \u4e25\u8c28\u7684\u8bc1\u660e\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\u3002\n\n~~\u81f3\u4e8e\u8bc1\u660e\u770b\u5176\u4ed6\u4eba\u7684\u5c31\u597d\u4e86(\u867d\u7136\u6211\u89c9\u5f97\u6ca1\u6709\u4ec0\u4e48\u7528\u53cd\u6b63\u4f60\u4e5f\u4f1a\u4e0d\u8bc1\u4f5c\u4e3aoier\u8981\u7528\u597d\u81ea\u5df1\u7684\u5de5\u5177\u5c31\u662f\u8ba1\u7b97\u673a\u4e56\u4e56\u6253\u8868\u554a\u5bf9\u5427~~\n\n\u4f60\u4e0d\u4f1a\u79ef\u6027\u51fd\u6570\uff1f\n\n![](https://cdn.luogu.com.cn/upload/pic/21438.png )\n\n(\u4e24\u8005\u6709\u533a\u522b\uff0c\u8981\u4ed4\u7ec6\u533a\u5206)\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c$n$ \u7684\u7b54\u6848 \u7b49\u4e8e $n$ \u8d28\u56e0\u6570\u5206\u89e3\u4e4b\u540e\uff0c\u6bcf\u4e00\u4e2a \u8d28\u6570\u7684\u6b21\u5e42 \u7684\u7b54\u6848 \u7684\u4e58\u79ef\u3002\u56e0\u4e3a\u5b83\u4eec\u90fd\u662f\u8d28\u6570\u6240\u4ee5\u81ea\u7136\u4e24\u4e24\u4e92\u8d28\u3002\n\n\u7528\u6570\u5b66\u6765\u8868\u793a\uff0c\u5373\u628a\u4e00\u4e2a\u4efb\u610f\u7684\u79ef\u6027\u51fd\u6570\u7684\u503c\u8bb0\u4e3a $G_a$ \uff0c\u628a $a$ \u8868\u793a\u4e3a$p_1^{q_1}p_2^{q_2}p_3^{q_3}...p_m^{q_m}$ (\u6211,\u6216\u8005\u8bf4\u5927\u5bb6\u4e60\u60ef\u7528p\u8868\u793a\u8d28\u6570\uff09\uff0c\u6709\n\n$$G_a=G_{p_1^{q_1}}G_{p_2^{q_2}}G_{p_3^{q_3}}...G_{p_m^{q_m}}$$\n\n\u6211\u4eec\u628a\u8fd9\u9053\u9898\u7684\u7b54\u6848\u8ba1\u4e3a $f_k^a$ , \u5bf9a\u8d28\u56e0\u6570\u5206\u89e3\u53ef\u4ee5\u5f97\u5230\n\n$$a=\\prod_{i=1}^m p_i^{qi}$$\n\n\u5c31\u6709\u4e86\n\n$$f_k^a=\\prod_{i=1}^mf_k^{(p_i^{qi})}$$\n\n\u4e3a\u4ec0\u4e48\u8981\u53d8\u6210\u8fd9\u6837\u7684\u5f62\u5f0f\u5462\uff1f\n\n\u56e0\u4e3a \u8003\u8651\u5bf9\u4e8e$f_k^{(p_i^{qi})}$\u600e\u4e48\u641e\u3002\n\n~~\u5982\u679c\u4f60\u771f\u7684\u8bfb\u9898\u4e86\u5c31\u80fd~~\u5199\u51fa\u8fd9\u6837\u7684\u5f0f\u5b50\n\n$$f_k^a=\\sum_{x|a}f_{k-1}^x$$\n\n$x|a$ \u610f\u4e49\u5373\u4e3a $x$ \u662f $a$ \u7684\u7ea6\u6570\uff0c$a$ \u7684 $k$ \u6b21\u7ea6\u6570\u548c\u7b49\u4e8e $a$ \u7684\u6240\u6709\u7ea6\u6570\u7684 $k-1$ \u6b21\u7684\u7ea6\u6570\u548c\u3002\n\n\u5f53\u8fd9\u4e2a\u5f0f\u5b50\u4e2d\u7684 $a=p_i^{qi}$ \u65f6\uff0c\u5c31\u53d8\u6210\u4e86\n\n$$f_k^{(p_i^{qi})}=\\sum_{t=1}^{qi}f_{k-1}^{(p_i^{t})}$$\n\n\u56e0\u4e3a\u663e\u7136\u5bf9\u4e8e\u4e00\u4e2a\u8d28\u6570\u7684 $q$ \u6b21\u5e42\uff0c\u662f\u4ed6\u7684\u7ea6\u6570\u7684\u53ea\u6709\u8fd9\u4e2a\u8d28\u6570\u7684 \u5927\u4e8e\u7b49\u4e8e $0$ \u5c0f\u4e8e\u7b49\u4e8e$p$ \u7684\u6b21\u5e42\u3002\n\n\u6ce8\u610f\u5230\u8fd9\u4e2a\u65f6\u5019\u5176\u5b9e $pi$ \u5df2\u7ecf\u6ca1\u6709\u7528\u4e86\uff0c\u53ea\u8981\u5b83\u662f\u4e00\u4e2a\u8d28\u6570\u5c31\u53ef\u4ee5\uff0c\u65e0\u8bba\u662f$2$\u6216\u8005$5$~~\u6216\u800519260817~~\u503c\u90fd\u662f\u4e00\u6837\u7684\u3002\u90a3\u6211\u4eec\u5e72\u8106\u628a $pi$ \u5220\u6389\u6765\u8868\u793a\u3002\n\n$$F_k^{n}=\\sum_{t=1}^{n}F_{k-1}^{t}$$\n\n\u8fd9\u4e2a\u5c31\u662f\u628a\u5f00\u59cb\u5316\u6210\u8fd9\u4e2a\u5f62\u5f0f\u7684\u539f\u56e0\u3002(\u6211\u8bf4\u7684\u6709\u70b9\u58a8\u8ff9\uff0c\u4e00\u822c\u60f3\u5230\u662f\u79ef\u6027\u51fd\u6570\u5c31\u80fd\u60f3\u5230\u8fd9\u91cc\u5427 $QAQ$ )\n\n\u770b\u8d77\u6765\u611f\u89c9\u597d\u591a\u4e86\u3002\u53ef\u4ee5\u975e\u5e38\u660e\u6670\u7684\u770b\u51fa\u6765\uff0c\u6bcf\u4e00\u7ef4\u7684 $k$ \u90fd\u662f\u5728\u6c42 $k-1$ \u7ef4\u7684\u524d\u7f00\u548c\u3002\u6240\u4ee5\u73b0\u5728~~\u5982\u679c\u4e0d\u662f\u5927\u5e38\u9009\u624b~~\u6211\u4eec\u5c31\u5df2\u7ecf\u6709\u4e86 $11$ \u5206\u3002\n\n\u8fd9\u4e2a\u8f6c\u79fb\u8fd9\u4e48\u8822\uff0c\u5b83\u4e00\u5b9a\u662f\u6709\u89c4\u5f8b\u7684\u3002~~(\u8981\u4e0d\u7136\u600e\u4e48A)~~\n\n\u6211\u4eec\u6765\u53cd\u7740\u8003\u8651\u8fd9\u4e2a\u95ee\u9898\u3002\n\n\u5047\u5982\u628a $k$ \u8fd9\u4e2a\u4e0b\u6807\u89c4\u5b9a\u4e3a\u6700\u5c0f\u503c\u4e3a$-2$ , \u4e14\u5f53 $k=-2$ \u65f6\u53ea\u6709\u4e00\u4e2a$F_{-2}^1$\u7684\u503c\u7b49\u4e8e$1$\uff0c$F_{-2}^x (x!=1)$\u7684\u503c\u5168\u90e8\u4e3a $0$ \u3002 \u90a3\u4e48\u6839\u636e\u5b9a\u4e49\u6211\u4eec\u5c31\u6709 $F_{-1}^x=1$\uff0c$F_0^x=x$\u3002\u8003\u8651 $F_{-2}^1$ \u5bf9\u7b54\u6848\u4f1a\u8d21\u732e\u591a\u5c11\u6b21\uff0c\u6216\u8005\u8bf4\u8003\u8651\u81ea\u4f4e\u5f80\u4e0a\u7684\u8f6c\u79fb\uff0c\u8fdb\u800c\u8003\u8651\u6700\u7ec8\u7684\u7b54\u6848\u3002\n\n\u6362\u53e5\u8bdd\u8bf4\uff0c\u628a\u6bcf\u4e00\u4e2a\u72b6\u6001\u770b\u505a\u4e00\u4e2a\u77e9\u9635\u4e0a\u7684\u70b9\u5bf9\uff0c\u628a\u6bcf\u4e00\u5c42\u7684\u8f6c\u79fb\u90fd\u60f3\u8c61\u6210 \u4e00\u6761\u6709\u5411\u8fb9 \u8fde\u5411\u8f6c\u79fb\u76ee\u6807\u70b9 \u7684\u8bdd\uff0c\uff08\u5373\u4ece $(x,t)$ \u8fde\u5411\uff08$(x,t+1)$ \u5230 $(n,t+1)$) \u7684\u6240\u6709\u7684\u70b9) , \u6211\u4eec\u5c31\u662f\u5728\u8003\u8651\u4e00\u4e2a\u5f00\u59cb\u7684\u70b9$(1,-2)$\u80fd\u6709\u591a\u5c11\u79cd\u65b9\u5f0f\u8d70\u5230\u6700\u540e\u7684\u76ee\u6807\u70b9 $n$ \u3002\n\nemmmmm\n\n\u5927\u6982\u50cf\u8fd9\u6837\n\n![](https://cdn.luogu.com.cn/upload/pic/21440.png )\n\n\u6211\u4eec\u53ef\u4ee5~~\u901a\u8fc7\u60ca\u4eba\u7684\u773c\u529b~~\u53d1\u73b0\u8def\u5f84\u6570\u76ee\u4e3a $6$\uff08\u7528\u7684\u662f\u753b\u56fe \u89c1\u8c05\u3002\u3002)\n\n(\u5176\u5b9e\u5f15\u5165\u56fe\u8bba\u53ea\u662f\u5e2e\u52a9\u7406\u89e3\uff0c\u4e0d\u662f\u6b63\u89e3\u975e\u5f97\u4ece\u56fe\u8bba\u4e0a\u8003\u8651\uff0c~~\u8bdd\u8bf4\u8fd9\u5176\u5b9e\u662f\u5c0f\u5b66\u5965\u6570\u9898\u554a~~)\n\n\u6211\u4eec\u53d1\u73b0\u4e00\u5171\u8f6c\u79fb\u4e86 $k+2$ \u6b21 \u3002\u6bcf\u4e00\u6b21\u8f6c\u79fb\u90fd\u7531*\u5f53\u524d\u72b6\u6001\u8f6c\u79fb\u5230\u76f8\u7b49\u6216\u66f4\u5927\u7684\u503c*\u3002\u5982\u679c\u628a\u6bcf\u4e00\u6b21\u8f6c\u79fb\u8003\u8651\u4e3a\u5728*\u5f53\u524d\u72b6\u6001\u4e0a\u52a0\u4e0a\u4e00\u4e2a\u975e\u8d1f\u6574\u6570*\uff0c\u5b83\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a\u4eba\u5c3d\u7686\u77e5\u901a\u4fd7\u6613\u61c2\u7684\u95ee\u9898\uff1a\n\n\u6709\n\n$$1+x_1+x_2+...+x_{k+2}=n,(xi>=0)$$\n\n\u6c42\u65b9\u6848\u6570\u3002\n\n\u5373\u53ef\u8fd0\u7528\u63d2\u677f\u6cd5\u89e3\u51b3\u5f97\u5230 $C_{n+k}^{k+1}$ \u3002\n\n(\u4ec0\u4e48\u662f\u63d2\u677f\u6cd5\uff1f......\uff09\n\n\u9996\u5148\u8003\u8651\u5728\u6bcf\u4e00\u4e2ax\u4e0a\u52a01\uff0c\u5c31\u53d8\u6210\u4e86\n\n$$x_1+x_2+...+x_{k+2}=n-1+(k+2),(xi>=1)$$\n\n\u8fd9\u4e2a\u95ee\u9898\u7b49\u4ef7\u4e8e\u628a\u957f\u5ea6\u4e3a $(n+k+1)$ \u7684\u533a\u95f4 \u5206\u6210 $(k+2)$ \u4efd > \u7b49\u4ef7\u4e8e\u5728 $(n+k)$ \u4e2a\u70b9\u4e2d\u9009\u53d6 $(k+1)$ \u4e2a\u6765\u5206\u5272\u8fd9\u4e2a\u533a\u95f4\u3002\n\n\u6765\u6574\u7406\u4e00\u4e0b\u7b54\u6848\u3002\n\n\u603b\u7684\u7b54\u6848\uff1a\n$$f_k^a=\\prod_{i=1}^mf_k^{(p_i^{qi})}$$\n\u7b54\u6848\u7684\u6bcf\u4e00\u9879\uff1a\n$$f_k^{(p_i^{qi})}=\\sum_{t=1}^{qi}f_{k-1}^{(p_i^{t})}$$\n\u8fdb\u884c\u4e24\u6b21\u95ee\u9898\u8f6c\u5316\uff0c\u53d8\u4e3a\u6c42\u7ec4\u5408\u6570\uff1a\n$$f_k^{(p_i^{qi})}=F_k^{qi}=\\sum_{t=1}^{qi}F_{k-1}^{t}=C_{qi+k}^{k+1}$$\n\n$$f_k^a=\\prod_{i=1}^m C_{qi+k}^{k+1}$$\n\n\u7b49\u7b49\uff0c\u6709\u4e00\u4e2a\u95ee\u9898\u3002\u8fd9\u4e2a\u7ec4\u5408\u6570\u600e\u4e48\u6c42\uff1f$qi$ \u662f\u4e00\u4e2a\u6570\u7684\u6307\u6570\uff0c\u518d\u5927\u4e5f\u4e0d\u4f1a\u5f88\u5927\uff0c\u5f53 $pi=2$ \u7684\u65f6\u5019 $qi$ \u7684\u6700\u5927\u503c\u624d\u4e3a $60$ \u5de6\u53f3\u3002\u4e0d\u8fc7 $k$ \u53ef\u662f\u5f02\u5e38\u7684\u5927\u554a\u3002\u80af\u5b9a\u4e0d\u80fd\u6c42\u51fa $(qi+k)$ \u7684\u9636\u4e58\u3002\n\n\u968f\u4fbf\u4e3e\u4e2a\u4f8b\u5b50\u3002\u8bbe\u60f3\u6c42 $C_8^6=C_8^2=\\frac{8!}{2!6!}=\\frac{7*8}{1*2}$ \u3002\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u6c42 $(qi+k)$ \u7684\u9636\u4e58\uff0c\u53ea\u9700\u8981\u6c42 $(qi+k)$ \u4e2d\u7684\u540e $(qi-1)$ \u9879\u9664\u53bb\u524d $(qi-1)$ \u9879\u5c31\u597d\u4e86\u3002 \u6240\u4ee5\u4e3a\u4e86\u5904\u7406\u9664\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u9006\u5143\u3002\u4e0d\u884c\uff0c\u6211\u5b9e\u5728\u5199\u4e0d\u52a8\u4e86\uff0c\u9006\u5143\u4e0d\u4f1a\u81ea\u884c\u767e\u5ea6\u5427....\n\n\u9006\u5143\u968f\u4fbf\u600e\u4e48\u6c42\u90fd\u53ef\u4ee5\u3002\u6211\u4eec\u53d1\u73b0\u6c42\u7ec4\u5408\u6570\u7684\u590d\u6742\u5ea6\u5176\u5b9e\u662f\u76f8\u5f53\u5c0f\u7684\uff0c\u800c\u590d\u6742\u5ea6\u5173\u952e\u5728\u4e8e\u54ea\u91cc\u5462\uff1f\n\n\u5206\u89e3\u8d28\u56e0\u6570\u3002\u6807\u51c6\u7684\u5206\u89e3\u8d28\u56e0\u6570\u662f\u679a\u4e3e\u8d28\u6570\uff0c\u5982\u679c\u53d1\u73b0 $n$ \u662f\u8fd9\u4e2a\u8d28\u6570\u7684\u500d\u6570\uff0c\u5c31\u9664\u5e72\u51c0\uff0c\u8ba1n\u4e0d\u662f\u8fd9\u4e2a\u8d28\u6570\u7684\u500d\u6570\u9664\u4e86\u51e0\u6b21\u5373\u4e3a\u8fd9\u4e00\u9879\u7684\u6b21\u6570\u3002\u4f18\u5316\u4e00\u4e0b\uff0c\u679a\u4e3e\u8d28\u6570\u7684\u65f6\u5019\u53ef\u4ee5\u679a\u4e3e\u5230 $\\sqrt n$ \u7684\u5927\u5c0f\u3002\u56e0\u4e3a\u5927\u4e8e\u8fd9\u4e2a\u6570\u7684\u8d28\u6570\uff0c\u5982\u679c\u662f $n$ \u7684\u7ea6\u6570\uff0c\u4e00\u5b9a\u662f\u4e00\u6b21\uff0c\u56e0\u4e3a\u5b83\u7684\u5e73\u65b9\u5c31\u5df2\u7ecf\u6bd4 $n$ \u5927\u4e86\u3002\u540c\u7406\u5927\u4e8e $\\sqrt n$ \u7684\u8d28\u6570\u4e5f\u4e00\u5b9a\u53ea\u6709\u4e00\u4e2a\u3002\n\n\u4f46\u662f\u5f53 $n$ \u4e3a $1e18$ \u7684\u65f6\u5019\u6211\u4eec\u53d1\u73b0 $1e9$ \u7684\u8303\u56f4\u662f\u4e0d\u53ef\u8fc7\u7684\n\n\u6240\u4ee5\u6211\u4eec\u9700\u8981Miller-Rabin\u6216Pollad-rho\u7b97\u6cd5 \u5417\uff1f\n\n~~no no no \u60f3\u60f3\u51fa\u9898\u4eba\u8981\u662f\u5361\u4f1a\u600e\u4e48\u5361\u4f60\uff1f \u80af\u5b9a\u653e\u51e0\u4e2a\u7b5b\u4e0d\u51fa\u6765\u7684\u5927\u8d28\u6570\u7684\u4e58\u79ef\u5bf9\u5427 \u56e0\u4e3a1s\u7ebf\u7b5b\u5927\u6982\u80fd\u7b5b1e7 \u6240\u4ee5\u8fd9\u51e0\u4e2a\u8d28\u6570\u663e\u7136\u90fd\u662f1e8 1e9 \u7684\u91cf\u7ea7 \u8fd9\u4e2a\u91cf\u7ea7\u7684\u8d28\u6570\u5e38\u7528\u7684\u6709\u51e0\u4e2a \u4f60\u8fd8\u4e0d\u660e\u767d\u5417~~\n\n```cpp\n#include <bits/stdc++.h>\n#define rap(i,s,n) for(int i=s;i<=n;i++)\n#define drap(i,s,n) for(int i=s;i>=n;i--)\n#define N 111111\n#define P 998244353\n#define ll long long\n#define m(s,k) memset(s,k,sizeof s)\nusing namespace std;\nll n,k;\nint prime[N],cnt;\nbool isnt[N];\nvoid Prime(int n){\n    rap(i,2,n){\n        if(!isnt[i]) prime[++cnt]=i;\n        rap(j,1,cnt){\n            if(prime[j]*i>cnt) break;\n            isnt[i*prime[j]]=1;\n            if(i%prime[j]==0) break;\n        }\n    }\n}\nll ans=1,inv[N];\nll C(int x){ll res=1; rap(i,1,x) res=res*inv[i]%P*((x+k%P+2-i)%P)%P; return res;}\nint main(){\n    cin>>n>>k; inv[1]=1; rap(i,2,100000) inv[i]=inv[P%i]*(P-P/i)%P;\n    Prime(100000); prime[++cnt]=998244353; prime[++cnt]=1000000007; prime[++cnt]=1000000009;\n    rap(j,1,cnt){\n        int v=prime[j]; if(v*v>n) break;\n        if(n%v==0){\n            int t=0;\n            while(n%v==0) n/=v,t++;\n            ans=ans*C(t)%P;\n        }\n    }\n    if(n>1) ans=ans*C(1)%P;\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n\n```\n\n~~sans:\u50cf\u4f60\u8fd9\u6837\u7684\u5b69\u5b50\u5e94\u8be5\u5728\u5730\u72f1\u91cc\u71c3\u70e7~~",
        "postTime": 1529502413,
        "uid": 98650,
        "name": "WinXP",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4714 \u3010\u300c\u6570\u5b66\u300d\u7ea6\u6570\u4e2a\u6570\u548c\u3011"
    },
    {
        "content": "**\u7528\u53e6\u4e00\u79cd\u65b9\u5f0f\u53bb\u63a8\u8fd9\u4e2a\u5f0f\u5b50\uff1a**\n\n\u7528 $f_{i}(x)$ \u8868\u793a\u5f53 $N=x,\\;K=i$ \u65f6\u7684\u7b54\u6848\u3002\n\n\u9996\u5148\u6709 $f_{0}(x)=\\sum_{d}[d|x]=\\sigma(x)$ \uff0c\u8fd9\u662f\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\u3002\n\n\u6839\u636e\u5b9a\u4e49\uff0c\u6709 $f_{i+1}(x)=\\sum_{d|x}f_{i}(d)$ \u3002\n\n\u5373 $x$ \u7684\u6bcf\u4e2a\u7ea6\u6570\u81ea\u8eab\u7684\u964d\u4e00\u6b21\u7ea6\u6570\u4e2a\u6570\u548c\u3002\n\n\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u72c4\u5229\u514b\u96f7\u5377\u79ef\u7684\u5f62\u5f0f\u3002\n\n\u5373 $f_{i+1}(x)=\\sum_{d|x}1\\cdot f_{i}(d)\\Leftrightarrow f_{i+1}(x)=(I\\ast f_{i})(x)$ \u3002\n\n\u8fd9\u91cc\u5b9a\u4e49 $I(x)=1$ \u3002\n\n\u6839\u636e\u72c4\u5229\u514b\u96f7\u5377\u79ef\u7684\u6027\u8d28\uff0c\u4e24\u4e2a\u79ef\u6027\u51fd\u6570\u7684\u5377\u79ef\u4e5f\u662f\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\u3002\n\n\u4e8e\u662f\u6709 $f_{i}(x)$ \u662f\u79ef\u6027\u51fd\u6570\u5bf9\u4efb\u610f\u7684 $i$ \u5747\u6210\u7acb\u3002\n\n\u4ee5\u4e0a\u8bc1\u660e\u4e86 $f_{K}$ \u662f\u79ef\u6027\u51fd\u6570\u3002\n\n\u90a3\u4e48\u8003\u8651\u8ba1\u7b97 $f_{K}(N)$ \u3002\n\n\u4ee4 $N$ \u7684\u6807\u51c6\u5206\u89e3\u5f0f\u4e3a $N=\\prod p_i^{q_i}$ \u3002\n\n\u8fd9\u91cc $p_i$ \u5747\u4e3a\u7d20\u6570\u3002\n\n\u90a3\u4e48\u6839\u636e\u79ef\u6027\u51fd\u6570\u7684\u6027\u8d28\uff0c\u6709 $f_{K}(N)=\\prod f_{K}(p_i^{q_i})$ \u3002\n\n\u8003\u8651\u8ba1\u7b97 $f_{K}(p^q)$ \u3002\n\n\u6839\u636e\u51fd\u6570\u7684\u5b9a\u4e49\uff0c\u6709 $f_{K}(p^q)=\\sum_{i=0}^{q}f_{K-1}(p^i)$ \u3002\n\n\u800c $f_{0}(p^q)=q+1$ \u3002\n\n\u8fd9\u53ef\u4ee5\u62bd\u8c61\u6210\u4e00\u4e2a\u7ec4\u5408\u95ee\u9898\uff1a\u5728 $q+1$ \u4e2a\u7a7a\u4f4d\u4e2d\u63d2 $K+1$ \u4e2a\u677f\uff0c\u677f\u53ef\u91cd\u53e0\u3002\n\n\u6839\u636e\u7ec4\u5408\u6570\u7684\u516c\u5f0f\uff0c\u5f3a\u5236\u5728\u6bcf\u4e24\u4e2a\u677f\u4e2d\u52a0\u4e00\u4e2a\u7269\u54c1\uff0c\u5f97\u5230\u516c\u5f0f\uff1a $f_{K}(p^q)=\\binom{q+K+1}{K+1}$ \u3002\n\n\u518d\u6839\u636e\u7ec4\u5408\u6570\u7684\u6027\u8d28\u5f97\u5230 $f_{K}(p^q)=\\binom{q+K+1}{q}$ \u3002\n\n\u6545\u7b54\u6848\u4e3a $\\prod \\binom{q_i+K+1}{q_i}$ \u3002\n\n------\n\n\u8fd9\u9898\u7684\u516c\u5f0f\u5c31\u63a8\u5230\u8fd9\u91cc\uff0c\u63a5\u4e0b\u6765\u770b\u5982\u4f55\u8ba1\u7b97\u3002\n\n\u8d28\u56e0\u6570\u5206\u89e3\u4ea4\u7ed9 Pollad-rho \u7b97\u6cd5\u3002\n\n\u7ec4\u5408\u6570\u90e8\u5206\uff0c\u8003\u8651\u5230 $q_i\\le 59$ \uff0c\u53ef\u4ee5\u76f4\u63a5 $\\binom{n}{m}=\\frac{n(n-1)\\cdots(n-m+1)}{1\\times 2\\times\\cdots\\times m}$ \u3002\n\n\u56e0\u4e3a\u6a21\u6570 $998244353$ \u4e3a\u7d20\u6570\uff0c\u9664\u6cd5\u90e8\u5206\u4f7f\u7528\u9006\u5143\u8ba1\u7b97\u3002",
        "postTime": 1529415763,
        "uid": 10703,
        "name": "\u5c0f\u7c89\u5154",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P4714 \u3010\u300c\u6570\u5b66\u300d\u7ea6\u6570\u4e2a\u6570\u548c\u3011"
    },
    {
        "content": "\u7ecf\u8fc7\u4ed4\u7ec6\u9605\u8bfb\u4e86\u4e09\u904d\u9898\u9762\uff0c\u53ef\u4ee5\u53d1\u73b0\u9898\u76ee\u8ba9\u6211\u4eec\u6c42\u8fd9\u4e2a\uff1a  \n\n$$[n^{-s}]\\zeta(s)^{k+1}$$  \n\u5176\u4e2d $\\zeta(s)$ \u4e3a Riemann-Zeta \u51fd\u6570\u3002  \n\n\u6839\u636e\u6570\u8bba\u7684\u57fa\u7840\u77e5\u8bc6\uff0c\u6211\u4eec\u77e5\u9053\u79ef\u6027\u51fd\u6570\u7684 Dirichlet \u5377\u79ef\u8fd8\u662f\u79ef\u6027\u51fd\u6570\uff0c\u6240\u4ee5\u8981\u8ba1\u7b97\u7b54\u6848\uff0c\u53ea\u9700\u8981\u5bf9\u4e8e\u6240\u6709\u8d28\u6570\u5e42\u7684\u7b54\u6848\u6c42\u79ef\u5373\u53ef\u3002  \n\uff08\u4ee5\u4e0b\u5b9a\u4e49 $p$ \u4e3a\u8d28\u6570\uff09\n\n\u8bbe $f(n,k)$ \u4e3a\u7b54\u6848\uff0c\u90a3\u4e48\u4e0d\u96be\u5f97\u5230\uff1a\n$$f(p^t,k)=\\sum_{i=0}^tf(p^i,k-1)$$\n\u7136\u540e\u4f60\u53d1\u73b0\u8fd9\u4e2a\u4e0d\u5c31\u662f\u666e\u901a\u7684\u524d\u7f00\u548c\u561b\uff0c\uff0c   \n\n$$f(p^t,k)=[x^t]\\left( \\frac{1}{1-x}\\right)^{k+1}=\\binom{t+k}{k}$$\n\u66b4\u529b\u7ebf\u6027\u7b5b\u4e00\u4e0b\uff0c\u540c\u65f6\u9884\u5904\u7406\u4e00\u4e0b\u8fd9\u4e2a\u7ec4\u5408\u6570\uff0c\u5c31\u80fd $\\text O(\\sqrt n)$ \u8ba1\u7b97\u4e86\u3002\n$$\\binom{t+k}{k}=\\binom{t-1+k}{k}\\frac{t+k}{t}$$\n\u7136\u800c\u6b63\u89e3\u662f\u5e94\u8be5\u7528 $\\text{pollard-rho}$ \u7b97\u6cd5\uff0c\uff0c\u771f\u6b63\u6bd4\u8d5b\u4f30\u8ba1\u6ca1\u51e0\u4e2a\u4eba\u613f\u610f\u5199\uff0c\u6240\u4ee5\u8fd9\u91cc\u76f4\u63a5\u7279\u5224\u8d28\u6570\u6c34\u8fc7\u4e86\uff08  \n```cpp\n#include<cstdio>\n#include<iostream>\n#include<cstring>\n#include<cmath>\n#define p 998244353\n#define ll long long\n#define reg register\n#define N 10000003\nusing namespace std;\n\nll n,k;\nint c[65],inv[65],pr[N];\nbool vis[N];\nint ans = 1,cnt,lim,pc;\n\nvoid solve(int i){\n    cnt = 0;\n    while(n%i==0) n /= i,++cnt;\n    ans = (ll)ans*c[cnt]%p;\n}\n\nint main(){\n    scanf(\"%lld%lld\",&n,&k);\n    k = (k+1)%p;\n    c[0] = inv[1] = 1;\n    for(reg int i=2;i<=64;++i) inv[i] = (ll)(p-p/i)*inv[p%i]%p;\n    for(reg int i=1;i<=64;++i) c[i] = c[i-1]*(i+k)%p*inv[i]%p;\n    lim = min((int)sqrt(n)+3,N-2);\n    for(reg int i=2;i<=lim;++i){\n        if(!vis[i]) pr[++pc] = i,solve(i);\n        for(reg int j=1;j<=pc&&i*pr[j]<=lim;++j){\n            vis[i*pr[j]] = true;\n            if(i%pr[j]==0) break;\n        }\n    }\n    solve(p); //\u6709\u4e00\u4e2a\u70b9\u6570\u636e 998244353|n ,\u76f4\u63a5\u5224\u4e00\u4e0b\n    if(n>1) ans = (ll)ans*(k+1)%p;\n    printf(\"%d\\n\",ans);\n\treturn 0;\t\n}\n```",
        "postTime": 1576333791,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4714 \u3010\u300c\u6570\u5b66\u300d\u7ea6\u6570\u4e2a\u6570\u548c\u3011"
    },
    {
        "content": "\u600e\u4e48\u8bf4\u5462\uff0c\u611f\u89c9\u9898\u89e3\u91cc\u7684\u4e24\u7bc7\u8fd8\u662f\u6709\u70b9\u6ca1\u8bf4\u6e05\u695a\n\n\u6240\u4ee5\u6211\u6253\u7b97\u518d\u6765\u89e3\u91ca\u4e00\u4e0b\n\n\u9996\u5148\u4e00\u4e2a\u6570:$n$ $=$ $\\prod P^{a_i}$\uff0c\u8fd9\u4e2a\u6570\u7684\u56e0\u5b50\u7684\u4e2a\u6570\u5219\u7b49\u4e8e$\\prod a_i$, \u8fd9\u662f\u662f$k = 0$\u65f6\u7684\u7b54\u6848\uff0c \u90a3\u4e48\u6211\u4eec\u73b0\u5728\u6765\u8003\u8651 $k = 1$\uff0c \u8fd9\u4e2a\u5c31\u76f8\u5f53\u4e8e\u5728\u6bcf\u4e2a$a_i$\u4e2d\u518d\u91cd\u65b0\u9009\u62e9\u7136\u540e\u7d2f\u4e58\uff0c\u6211\u4eec\u73b0\u5728\u8981\u6c42\u7684\u5c31\u662f\u8fd9\u4e2a\u91cd\u65b0\u9009\u62e9\u7684\u65b9\u6848\u662f\u591a\u5c11\n\n\u4e3e\u4e2a\u6817\u5b50\uff1a\n* $n = 900 = 2 ^ 2 * 3 ^ 2 * 5 ^ 2, k = 0$\u65f6\uff0c $ans = 3 * 3 * 3$\n\n* $n = 900, k = 1$\u65f6\uff0c $ans = (1 + 2 + 3) * (1 + 2 +3) * (1+ 2 +3)$\n\n\u6211\u4eec\u73b0\u5728\u6765\u63a2\u8ba8\u4e00\u4e0b\u8fd9\u4e2a\u662f\u600e\u4e48\u7b97\u51fa\u6765\u7684\u5bf9\u4e8e\u6bcf\u4e2a\u7d20\u56e0\u5b50,$k = 0$\u65f6\u6211\u4eec\u8fdb\u884c\u9009\u62e9\u53ef\u4ee5\u9009\u51fa\u6765$a_i ^ 0, a_i ^ 1, a_i ^ 2$\uff0c\u800c$k = 1$\u65f6\u518d\u9009\u62e9\u5c31\u76f8\u5f53\u4e8e\u5bf9$a_i ^ 0, a_i ^ 1, a_i ^ 2$\n\u518d\u6b21\u62c6\u5206\u53d8\u6210$(a_i^0,),(a_i^0, a_i^1), (a_i^0, a_i^1, a_i^2)$,\u65b9\u6848\u6570\u7531$(3) -> (1 + 2 + 3)$\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u518d\u5f52\u7eb3\u4e00\u4e0b\u5f53$k = 2$\u65f6\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u7d20\u56e0\u5b50\u7684\u65b9\u6848\u6570\u5e94\u8be5\u53d8\u4e3a$(1) + (1 +2) + (1 +2 + 3)$\n\n\u5176\u5b9e\u6700\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u7d20\u56e0\u5b50\u7684\u65b9\u6848\u6570\u5c31\u662f\u5c06$a_i$\u62c6\u5206$k$\u6b21\u7684\u548c\uff0c\u5173\u952e\u7684\u6765\u4e86\uff0c\u5bf9\u4e8e\u62c6\u5206$k$\u6b21\u7684\u548c\u6211\u4eec\u5e94\u8be5\u600e\u4e48\u6c42\u5462\uff0c\u7b54\u6848\u5176\u5b9e\u524d\u9762\u53d1\u9898\u89e3\u7684\u4e24\u4f4d\u805a\u805a\u5df2\u7ecf\u544a\u8bc9\u6211\u4eec\u4e86\uff0c\u5c31\u662f$C_{a_i + k + 1}^{k + 1}$\u73b0\u5728\u6211\u6765\u63a8\u5bfc\u4e00\u4e0b(\u4ee5\u4e0b\u63a8\u5bfc\u9488\u5bf9\u4e0a\u9762\u4e3e\u7684\u6817\u5b50)\n\n* $k = 0$, $ans = 3 = C_3^1$\n\n* $k = 1$,  $ans = (1 + 2) + 3 = C_4^2$\n\n$C_4^2 = C_3^1 + C_3^2$ , \u800c $C_3^2 = C_2^1 +  C^2_2$\n\n$2 = C_2^1, 1 = C_2^2 =  \\frac{2}{2} C_1^1 = C^1_1, 1 + 2 = C_2^1 + C_2^2 = C_3^2$\n\n\u6240\u4ee5$C_4^2 = C_3^1 + C_3^2 = 3 + 2 + 1$\n\n* $k = 2$, $ans = (1) + (1 + 2) + (1 + 2 + 3) = C_5^3$\n\n$1 = C_3^3, (1 + 2) = C_3^2, (1 + 2 + 3) = C_4^2$\n\n\u6240\u4ee5$(1) + (1 + 2) + (1 + 2 + 3) = C_5^3$\n\n\u5927\u6982\u63a8\u5bfc\u5c31\u662f\u8fd9\u4e9b\u4e86\uff0c\u968f\u7740$k$\u589e\u5927\u53ef\u4ee5\u4f9d\u6b21\u7c7b\u63a8\uff0c\u6700\u540e\u63a8\u5e7f\u4e00\u4e0b\u5c31\u662f$C_{a_i + k + 1}^{k + 1}$\n\n\u7b54\u6848\u5c31\u662f$\\prod_i C_{a_i + k + 1}^{k + 1}$, \u5173\u4e8e\u5f0f\u5b50\u7684\u63a8\u5bfc\u5c31\u8bb2\u5b8c\u4e86\uff0c\u5173\u4e8eMiller-Rabin\u7b97\u6cd5\u5927\u5bb6\u53ef\u4ee5\u53bb[Miskcoo\u7684\u535a\u5ba2](http://blog.miskcoo.com/2014/07/miller-rabin-primality-test)\u5b66\u4e00\u4e0b\n\n\n\u6700\u540e\u63a8\u5e7f\u4e00\u4e0b[\u6211\u7684\u535a\u5ba2](http://www.vixbob-lwc.pw)",
        "postTime": 1529462259,
        "uid": 50971,
        "name": "ViXbob",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4714 \u3010\u300c\u6570\u5b66\u300d\u7ea6\u6570\u4e2a\u6570\u548c\u3011"
    },
    {
        "content": "\u9996\u5148\u6211\u4eec\u53d1\u73b0\u8fd9\u9053\u9898\u76ee\u8981\u6c42\u7684\u662f\u5f62\u5982\u8fd9\u7c7b\u5f0f\u5b50\u7684\u65b9\u6848\u6570\uff1a\n\n$$\na_1\\times a_2\\times \\cdots \\times a_k=n\n$$\n\n\u5176\u4e2d $n,k$ \u7ed9\u5b9a\u3002\uff08 \u672c\u9898\u4e2d $k\\leftarrow k+2$ \uff09\n\n\u6211\u4eec\u5c06 $n$ \u5206\u89e3\u8d28\u56e0\u6570\uff0c\u8bbe $n=p_1^{r_1}\\times p_2^{r_2}\\times \\cdots \\times p_m^{r_m}$\uff0c$s=\\sum_{i=1}^mr_i$ \u3002\n\n\u8003\u8651\u5b83\u7684\u7ec4\u5408\u610f\u4e49\uff1a\u603b\u5171\u6709 $s$ \u4e2a\u5c0f\u7403\uff0c$m$ \u79cd\u989c\u8272\uff0c\u7b2c $i$ \u79cd\u989c\u8272\u7684\u5c0f\u7403\u5171\u6709 $r_i$ \u4e2a\uff0c\u6c42\u628a\u8fd9\u4e9b\u5c0f\u7403\u653e\u8fdb $k$ \u4e2a\u4e92\u4e0d\u76f8\u540c\u7684\u53ef\u4ee5\u4e3a\u7a7a\u7684\u76d2\u5b50\u7684\u65b9\u6848\u6570\u3002\n\n\u4e0d\u59a8\u5148\u679a\u4e3e\u5171\u6709\u51e0\u4e2a\u975e\u7a7a\u7684\u76d2\u5b50\u3002\u8bbe $ans_i$ \u8868\u793a\u6709 $i$ \u4e2a\u975e\u7a7a\u76d2\u5b50\u7684\u65b9\u6848\u6570\uff0c\u5219\u7b54\u6848\u7b49\u4e8e $\\sum_{i=1}^{\\min(k,s)}\\binom{k}{i}ans_i$ \u3002\n\n\u7531\u4e8e $10^{18}$ \u8303\u56f4\u5185 $s$ \u4e0d\u4f1a\u8d85\u8fc7 64\uff0c\u975e\u7a7a\u7684\u76d2\u5b50\u4e5f\u4e0d\u4f1a\u8d85\u8fc7 $s$ \u4e2a\uff0c\u6240\u4ee5\u4e0a\u5f0f\u4e2d $i$ \u7684\u4e0a\u9650\u4e5f\u4e0d\u4f1a\u8d85\u8fc7 64\u3002\n\n\u5bf9\u4e8e $ans_i$\uff0c\u53ef\u4ee5\u7528\u4e58\u6cd5\u539f\u7406\u6765\u89e3\u51b3\uff1a\n\n\u5c06 $r_t$ \u4e2a\u76f8\u540c\u989c\u8272\u7684\u5c0f\u7403\u653e\u5165 $i$ \u4e2a\u4e0d\u540c\u7684\u76d2\u5b50\u4e2d\uff0c\u76d2\u5b50\u53ef\u4ee5\u4e3a\u7a7a\u7684\u65b9\u6848\u6570\u53ef\u4ee5\u7528\u63d2\u677f\u6cd5\u6c42\u51fa\u6765\uff1a $\\binom{r_t+i-1}{i-1}$ \u3002\n\n\u8bbe $cur_i=\\prod_{t=1}^i\\binom{r_t+i-1}{i-1}$\uff0c\u5219 $cur_i$ \u8868\u793a\u628a\u6240\u6709\u5c0f\u7403\u653e\u5165 $i$ \u4e2a\u76d2\u5b50\u91cc\uff0c\u76d2\u5b50\u53ef\u4ee5\u4e3a\u7a7a\u7684\u65b9\u6848\u6570\u3002\u8fd8\u662f\u4e00\u6837\u7684\uff0c\u679a\u4e3e\u975e\u7a7a\u7684\u76d2\u5b50\uff0c\u6709\n\n$$\ncur_n=\\sum_{i=1}^n\\binom{n}{i}ans_i\n$$\n\n\u6839\u636e\u4e8c\u9879\u5f0f\u53cd\u6f14\uff0c\n\n$$\nans_n=\\sum_{i=1}^n(-1)^{n-i}\\binom{n}{i}cur_i\n$$\n\n\u81f3\u6b64\u5927\u529f\u544a\u6210\u3002\n\n\u5206\u89e3\u8d28\u56e0\u6570\u53ef\u4ee5\u5229\u7528 Pollard-Rho \u7b97\u6cd5\uff0c\u7ec4\u5408\u6570\u7684\u8ba1\u7b97\u53ef\u4ee5\u5229\u7528\u4e0b\u964d\u5e42\u3002\n\n```\n#include<bits/stdc++.h>\n#define For(i,a,b) for(int i=(a);i<=(b);++i)\n#define Rof(i,a,b) for(int i=(a);i>=(b);--i)\n#define int long long\n#define ll __int128\nusing namespace std;\ntypedef pair<int,int> Pair;\nconst int Mod=998244353;\n\ninline int gcd(int a,int b) {return b==0?a:gcd(b,a%b);}\ninline int f(int x,int c,int n) {return ((ll)x*x+c)%n;}\ninline int Pow(int x,int y,int z)\n{\n    int res=1;\n    while(y)\n    {\n        if(y&1) res=(ll)res*x%z;\n        x=(ll)x*x%z,y>>=1;\n    }\n    return res;\n}\ninline int Pol(int n)\n{\n    int s=0,t=0,c=rand()%(n-1)+1,val=1;\n    int tim=0,len=1;\n    for(len=1;;len<<=1,s=t,val=1)\n    {\n        for(tim=1;tim<=len;++tim)\n        {\n            t=f(t,c,n),val=(ll)val*abs(t-s)%n;\n            if(tim%127==0)\n            {\n                int d=gcd(val,n);\n                if(d>1) return d;\n            }\n        }\n        int d=gcd(val,n);\n        if(d>1) return d;\n    }\n}\ninline int Mil(int x)\n{\n    if(x<2) return 0;\n    if(x==2 || x==3) return 1;\n    if(x!=2 && x%2==0) return 0;\n    int a=x-1,b=0,j=0;\n    while(a%2==0) a>>=1,++b;\n    for(int i=1;i<=10;++i)\n    {\n        int p=rand()%(x-2)+2,q=Pow(p,a,x);\n        if(q==1 || q==x-1) continue;\n        for(j=0;j<b-1;++j)\n        {\n            q=(ll)q*q%x;\n            if(q==x-1) break;\n        }\n        if(q!=x-1) return 0;\n    }\n    return 1;\n}\nvector<Pair> Merge(vector<Pair> s1,vector<Pair> s2,int cnt)\n{\n    for(auto &i:s1) i.second*=cnt;\n    int l1=s1.size(),l2=s2.size(),it=0;\n    For(i,0,l1-1)\n    {\n        while(it<l2 && s2[it].first<s1[i].first) it++;\n        if(it<l2 && s2[it].first==s1[i].first) s1[i].second+=s2[it].second,s2[it].second=0;\n    }\n    for(auto i:s2) if(i.second) s1.push_back(i);\n    sort(s1.begin(),s1.end());\n    return s1;\n}\nvector<Pair> dfs(int x) // \u5206\u89e3\u8d28\u56e0\u6570\n{\n    vector<Pair> v; v.clear();\n    if(x<2) return v;\n    if(Mil(x)) {v.push_back(Pair(x,1ll)); return v;}\n    int res=x,cnt=0;\n    while(res>=x) res=Pol(x);\n    while(x%res==0) x/=res,cnt++;\n    vector<Pair> s1,s2,s3;\n    s1=dfs(res),s2=dfs(x);\n    return Merge(s1,s2,cnt);\n}\n\nint all,kazuha[105],fac[105],inv[105];\nvector<Pair> vec;\n\ninline void GetInv()\n{\n    fac[0]=inv[0]=1;\n    For(i,1,100) fac[i]=fac[i-1]*i%Mod;\n    inv[100]=Pow(fac[100],Mod-2,Mod);\n    Rof(i,99,1) inv[i]=inv[i+1]*(i+1)%Mod;\n}\ninline int C(int x,int y)\n{\n    int s1=1;\n    For(i,1,y) s1=(ll)s1*(x-i+1)%Mod;\n    return s1*inv[y]%Mod;\n}\ninline int Count(int x) // \u8ba1\u7b97 cur \u6570\u7ec4\u7684\u503c\n{\n    int s1=1;\n    for(auto i:vec) s1=s1*C(x+i.second-1,x-1)%Mod;\n    return s1;\n}\n\nsigned main()\n{\n    int n,k,ans=0;\n    scanf(\"%lld%lld\",&n,&k);\n    if(n==1) {printf(\"1\\n\"); return 0;}\n    vec=dfs(n);\n    for(auto i:vec) all+=i.second;\n    GetInv();\n    For(i,1,min(k+2,all)) kazuha[i]=Count(i);\n    For(i,1,min(k+2,all))\n        For(j,1,i-1) kazuha[i]=(kazuha[i]-C(i,j)*kazuha[j]%Mod+Mod)%Mod;\n    For(i,1,min(k+2,all)) // \u7edf\u8ba1\u7b54\u6848\n    {\n        int res=kazuha[i]*C(k+2,i)%Mod;\n        ans=(ans+res)%Mod;\n    }\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1657197963,
        "uid": 148913,
        "name": "Graphcity",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P4714\u3010\u300c\u6570\u5b66\u300d\u7ea6\u6570\u4e2a\u6570\u548c\u3011"
    },
    {
        "content": "\n\u7ea6\u6570\u4e2a\u6570\u51fd\u6570\u672c\u8eab\u5c31\u662f $I^2$\uff0c\u6211\u4eec\u7b49\u4ef7\u4e8e\u8ba1\u7b97 $I^{k+2}(n)$\n\n\u6ce8\u610f\u5230\u5176\u662f\u79ef\u6027\u51fd\u6570\uff0c\u53ea\u9700\u8981\u5bf9\u4e8e\u6bcf\u4e2a\u8d28\u56e0\u6570\u8003\u8651\u5176\u8d21\u732e\uff0c\u8003\u8651\u5f62\u5982 $I^{k}(p^r)$ \u7684\u7b54\u6848\uff0c\u901a\u8fc7 dp \u7edf\u8ba1\u53ef\u4ee5\u5199\u4e3a $f_{i,j}=\\sum_{k\\le j} f_{i-1,k}$\uff0c\u90a3\u4e48\u8f6c\u79fb\u662f\u4e00\u4e2a\u524d\u7f00\u548c\u51fd\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u8ba1\u7b97\u7684\u662f $\\frac{1}{(1-x)^k}[x^r]$\uff0c\u4e8e\u662f\u7b54\u6848\u5c31\u662f $\\binom{k+r-1}{r}$\uff0c\u76f4\u63a5\u5f53\u4f5c\u4e0b\u964d\u5e42\u5904\u7406\uff0c\u8ba1\u7b97\u7684 $r$ \u81f3\u591a\u5230 $\\log$\uff0c\u8003\u8651\u901a\u8fc7 PR \u5904\u7406\u56e0\u6570\u5206\u89e3\u6240\u4ee5\u590d\u6742\u5ea6\u662f $\\mathcal O(p^{\\frac{1}{4}}\\log+\\log)$ \u7684\n\ntips\uff1a\u5927\u6982\u5982\u679c\u4e0d\u7528 int128 \u4f60\u8981\u8bb0\u5f97\u5199\u8fc7\u9f9f\u901f\u4e58\uff0c\u800c\u4e14\u5230\u5904\u90fd\u5e94\u8be5\u8c03\u7528\u5b83\uff0c\u5426\u5219\u4f60\u4f1a\u6302\u5f97\u5f88\u60e8\u3002\n\n$Code:$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std ;\n#define Next( i, x ) for( register int i = head[x]; i; i = e[i].next )\n#define rep( i, s, t ) for( register int i = (s); i <= (t); ++ i )\n#define drep( i, s, t ) for( register int i = (t); i >= (s); -- i )\n#define re register\n#define int long long\nint gi() {\n\tchar cc = getchar() ; int cn = 0, flus = 1 ;\n\twhile( cc < '0' || cc > '9' ) {  if( cc == '-' ) flus = - flus ; cc = getchar() ; }\n\twhile( cc >= '0' && cc <= '9' )  cn = cn * 10 + cc - '0', cc = getchar() ;\n\treturn cn * flus ;\n}\nconst int N = 100 + 5 ; \nconst int P = 998244353 ; \nint n, k, st[N], top, w[N], cnt ; \nint mul( int a, int b, int p ) {\n\tint ans = 0, base = a ; \n\twhile(b) {\n\t\tif( b & 1 ) ans = ( ans + base ) % p ;\n\t\tbase = ( base + base ) % p, b >>= 1 ; \n\t} return ans ; \n}\nint fpow( int x, int k, int p ) {\n\tint ans = 1, base = x ; \n\twhile(k) {\n\t\tif( k & 1 ) ans = mul( ans, base, p ) ;\n\t\tbase = mul( base, base, p ), k >>= 1 ; \n\t} return ans ; \n}\nint Rand( int x ) {\n\treturn ( ( 1ll * rand() << 16ll ) | rand() ) % x + 1 ; \n}\nint Miller( int p ) {\n\tif( p == 2 || p == 3 ) return 1 ; \n\tif( p == 1 || p % 2 == 0 ) return 0 ; \n\tint d = p - 1, s = 0 ; while( !( d & 1 ) ) ++ s, d >>= 1 ; \n\trep( i, 0, 7 ) {\n\t\tre int a = rand() % ( p - 3 ) + 2 ; \n\t\tint x = fpow( a, d, p ), y = 0 ;\n\t\tfor( re int j = 0; j < s; ++ j ) {\n\t\t\ty = mul( x, x, p ) ; if( y == 1 && ( x != 1 ) && ( x != p - 1 ) ) return 0 ; \n\t\t\tx = y ; \n\t\t} if( y != 1 ) return 0 ; \n\t} return 1 ; \n}\nint gcd( int x, int y ) {\n\treturn ( x == 0 ) ? y : gcd( y % x, x ) ;\n}\nint solve(int p) {\n\tint k = 2, x = Rand(p - 1) + 1, y = x, d = 1, c = Rand(1097) + 992 ; \n\tfor( re int i = 1; d == 1; ++ i ) {\n\t\tx = ( mul( x, x, p ) + c ) % p ; \n\t\td = gcd( (x > y) ? x - y : y - x, p ) ;\n\t\tif( i == k ) k <<= 1, y = x ;\n\t} return d ; \n}\nvoid PR( int p ) {\n\tif( p == 1 ) return ; \n\tif( Miller(p) ) { st[++ top] = p ; return ; }\n\tint x = p ; while( x == p ) x = solve(x) ;\n\tPR(x), PR(p / x) ; \n}\nint C( int x, int y ) {\n\tint ans1 = 1, ans2 = 1 ; \n\tfor( re int i = 0; i < y; ++ i ) ans1 = mul( ans1, ( x - i ), P ), ans2 = mul( ans2, ( i + 1 ), P ) ; \n\treturn mul( ans1, fpow( ans2, P - 2, P ), P ) ;\n}\nsigned main()\n{\n\tsrand(time(NULL)) ; \n\tn = gi(), k = gi() + 2 ; \n\tPR(n) ; \n\tsort( st + 1, st + top + 1 ) ;\n\trep( i, 1, top ) {\n\t\tif( st[i] == st[i - 1] ) ++ w[cnt] ;\n\t\telse w[++ cnt] = 1 ; \n\t}\n\tint Ans = 1 ; \n\trep( i, 1, cnt ) Ans = Ans * C( w[i] + k - 1, w[i] ) % P ;\n\tprintf(\"%lld\\n\", (long long)Ans ) ;\n\treturn 0 ;\n} \n```",
        "postTime": 1591923548,
        "uid": 30036,
        "name": "Soulist",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4714 \u3010\u300c\u6570\u5b66\u300d\u7ea6\u6570\u4e2a\u6570\u548c\u3011"
    },
    {
        "content": "Emmm\u5173\u4e8e\u90a3\u4e2a\u5f0f\u5b50\u7684\u8bc1\u660e\u6211\u6765\u8bf4\u4e00\u79cd\u4e0d\u662f\u6570\u5b66\u5f52\u7eb3\u6cd5\u7684\u8bc1\u660e  \n\n\u6211\u4eec\u8003\u8651\u6700\u7ec8\u7ed3\u679c\u7684\u67d0\u4e2a\u6570x\uff0c\u4ed6\u7684\u67d0\u4e2a\u8d28\u6570p\u7684\u5e42\u662ft\n\n\u5bf9\u4e8en\u6765\u8bf4\u8fd9\u4e2a\u8d28\u6570p\u7684\u5e42\u662fb\n\n\u90a3\u4e48\u4e5f\u5c31\u662f\u7ecf\u8fc7\u8fd9k\u6b21\u53d8\u6362\u540e\uff0c\u8fd9\u4e2a\u8d28\u6570p\u7684\u5e42\u4eceb\u964d\u5230\u4e86t\n\n\u76f8\u5f53\u4e8e\u6211\u4eec\u8981\u628ak\u5212\u5206\u6210(b-t+1)\u4e2a\u533a\u95f4\uff0c\u6bcf\u4e2a\u533a\u95f4\u4ee3\u8868\u7740\u8fd9\u4e2a\u8d28\u6570\u7684\u5e42\u662f\u4ec0\u4e48\n\n\u90a3\u4e48\u56de\u8fc7\u5934\u6765\u770b\uff0c\u76f8\u5f53\u4e8e\u662f\u6211\u4eec\u8981\u628ak\u5212\u5206\u6210 ai+1 \u4e2a\u533a\u95f4 \uff0c\u6bcf\u4e2a\u533a\u95f4\u53ef\u4ee5\u4e3a\u7a7a\n\n\u90a3\u5c31\u662f\u7ecf\u5178\u7684\u7ec4\u5408\u6570\u63d2\u677f\u6cd5\u4e86\u3002\u8fd9\u6837\u5c31\u80fd\u8bc1\u660e\u90a3\u4e2a\u5f0f\u5b50\u7684\u6b63\u786e\u6027\u4e86\u3002",
        "postTime": 1529415884,
        "uid": 24559,
        "name": "Treeloveswater",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4714 \u3010\u300c\u6570\u5b66\u300d\u7ea6\u6570\u4e2a\u6570\u548c\u3011"
    },
    {
        "content": "\u770b\u5230\u6709\u4eba\u95ee\u8fd9\u4e2a\u5f0f\u5b50\u600e\u4e48\u63a8\u51fa\u6765\u6765\u7684\uff0c\u6211\u6765\u56de\u7b54\u4e00\u4e0b\uff0c\u4e0d\u77e5\u9053\u662f\u4e0d\u662f\u6b63\u89e3\uff0c\u7531\u4e8e\u6211\u4e0d\u4f1aMiller-Rabin\u548cPollard-Rho\u7b97\u6cd5\uff0c\u6240\u4ee5\u6682\u65f6\u53ea\u670983\u5206\uff0c\u8fd8\u6ca1A\u6389QAQ\uff0c\u6628\u5929\u5367\u5e8a\u60f3\u5230\u7684\u3002  \n\u5bf9\u4e8e\u4e00\u4e2a\u6574\u6570N\uff0c\u53ef\u4ee5\u5206\u89e3\u4e3a$P1^{a1}*P2^{a2}*\u2026\u2026Pm^{am}$\u3002\u5bf9\u4e8eK=0\u7684\u60c5\u51b5\uff0c\u7531\u6392\u5217\u7ec4\u5408\u53ef\u4ee5\u5f97\u5230a1\u6709\u53d60-a1\u7684\u60c5\u51b5\uff0ca2\u6709\u53d60-a2\u7684\u60c5\u51b5\u2026\u2026  \n\u7b54\u6848\u4e3a$(a1+1)*(a2+1)*\u2026\u2026*(am+1)$\u3002  \n\u8ba8\u8bba\u5bf9K=1\u7684\u60c5\u51b5\uff0c\u6bcf\u4e2a\u5206\u89e3\u51fa\u6765\u7684\u6570\u5b57\u90fd\u53ef\u4ee5\u8868\u793a\u4e3a$P1^{b1}*P2^{b2}*\u2026\u2026Pm^{bm}$,\u5176\u4e2d$b1\u2208[0,a1]$\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u4ee530\u4e3a\u4f8b\u5b50\n30=$2*3*5$,\u6240\u4ee5K=0\u65f6\u7b54\u6848\u4e3a$2*2*2=8$\u3002K=1\u65f6\uff0c\u5176\u4e2db1\u53ef\u4ee5\u53d60\uff0c\u4e5f\u53ef\u4ee5\u53d61\uff0c\u7531K=0\u7684\u60c5\u51b5\u6765\u770b\uff0c\u6700\u7ec8\u7b54\u6848\u5e94\u5f53\u662f$((0+1)+(1+1)*answer(b2,b3)$,\u8fd9\u6837\u9012\u63a8\uff0c\u5f97\u5230K=1\u65f6\uff0c\u6700\u7ec8\u7b54\u6848\u4e3a$(1+2)*(1+2)*(1+2)=27$,\u90a3\u4e48\uff0c\u5982\u679c\u662f60\uff0c\u7b54\u6848\u5c31\u662f$(1+2+3)*(1+2)*(1+2)=54$,\u7ecf\u8fc7\u7b80\u5355\u7684\u6570\u5b66\u63a8\u5bfc\uff0c\u5f53N=60\u65f6\u6700\u7ec8\u7b54\u6848\u5373\u4e3a$C^2_4*C^2_3*C^2_3=54$,\u800cK=0\u7684\u60c5\u51b5\u5373\u4e3a$C^1_3*C^1_2*C^1_2=12$\uff0c\u518d\u63a8\u5e7f\u5230\u4e00\u822c\u6765\u8bf4\u7684K=1\uff0c\u6700\u7ec8\u7b54\u6848\u5373\u4e3a$\\prod_{i=1}^mC_{a_i+2}^2$ ,\u518d\u8fdb\u884c\u63a8\u5e7f,\u5bf9\u4e8e\u4e00\u822c\u7684K\uff0c\u5373\u6700\u540e\u7684\u63a8\u5bfc\u5f0f\u5c31\u662f$\\prod_{i=1}^mC_{a_i+K+1}^{K+1}$,\u7531\u4e8e\u8fd9\u4e2a\u5f0f\u5b50\u6bd4\u8f83\u96be\u7b97\uff0c\u6211\u4eec\u7ed9\u4ed6\u6362\u4e00\u4e0b\uff0c\u5c31\u662f$\\prod_{i=1}^mC_{a_i+K+1}^{a_i}$\u3002\u5230\u8fd9\u91cc\u8bc1\u660e\u5c31\u7ed3\u675f\u5566\u3002\u81f3\u4e8e\u540e\u9762\u7684\u8d28\u56e0\u6570\u5904\u7406\u548c\u4ee3\u7801\uff0c\u5927\u5bb6\u53ef\u4ee5\u770b\u5176\u4ed6\u4eba\u7684\u4ee3\u7801\u7406\u89e3\u3002",
        "postTime": 1529389556,
        "uid": 58354,
        "name": "BLUE_EYE",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4714 \u3010\u300c\u6570\u5b66\u300d\u7ea6\u6570\u4e2a\u6570\u548c\u3011"
    },
    {
        "content": "\uff08\u5173\u4e8e $f(p^r,k)=\\sum\\limits_{i=0}^rf(p^i,k-1)$ \u8bf7\u53c2\u8003\u5176\u4ed6\u9898\u89e3\uff09\n\n\u8d3e\u5baa\u4e09\u89d2\uff1a\n\n    1\n    1  1\n    1  2  1\n    1  3  3  1\n    1  4  6  4  1\n    1  5  10 10 5  1\n    1  6  15 20 15 6  1\n\n\u5982\u679c\u7ad6\u7740\u770b\uff08\u884c\u5217\u5747\u6309\u7167\u4ece 0 \u5f00\u59cb\uff09\uff1a\n\n       \u884c\u6570\uff1a1  2  3  4  5  6\n    \u7b2c 1 \u5217\uff1a1  2  3  4  5  6\n    \u7b2c 2 \u5217\uff1a   1  3  6  10 15\u2026\u2026\uff08\u7b2c 1 \u5217\u524d\u7f00\u548c\uff09\n    \u7b2c 3 \u5217\uff1a      1  4  10 20\u2026\u2026\uff08\u7b2c 2 \u5217\u524d\u7f00\u548c\uff09\n    \u2026\u2026\n\n\u521a\u597d\u662f\u9ad8\u7ef4\u524d\u7f00\u548c\uff01\n\n\u518d\u796d\u51fa\u539f\u51fd\u6570\u8868\uff08\u884c\u4e3a $n$\uff0c\u5217\u4e3a $k$\uff09\uff1a\n\n       0    1    2    3\n    1  1    1    1    1\n    2  2    3    4    5\n    4  3    6    10   15\n    8  4    10   20   35\n\n\u4e0a\u4e0b\u6bd4\u5bf9\uff0c\u5373\u53ef\u770b\u5230\u5bf9\u5e94\u5173\u7cfb\uff1a$f(p^r,k)=\\mathrm C_{r+k+1}^{k+1}$\u3002\n\n\u56e0\u5f0f\u5206\u89e3\u7528 [\u67d0\u67d0\u8d28\u6570\u68c0\u9a8c](https://www.luogu.org/blog/lingchi/miller-rabin)\uff0c\u5927\u7ec4\u5408\u6570\u7528\u9006\u5143\uff0cjulao \u4e4b\u8ff0\u5907\u77e3\u3002\n\n\u6839\u636e\u8d3e\u5baa\u4e09\u89d2\u9012\u63a8\u65b9\u5f0f\uff0c\u5bb9\u6613\u7ed9\u51fa\u5177\u4f53\u8bc1\u660e\u3002\n",
        "postTime": 1534821632,
        "uid": 70578,
        "name": "\u7269\u7075",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4714 \u3010\u300c\u6570\u5b66\u300d\u7ea6\u6570\u4e2a\u6570\u548c\u3011"
    },
    {
        "content": "\u8fd9\u91cc\u7ed9\u51fa\u77e9\u9635\u5feb\u901f\u5e42\u7684\u505a\u6cd5\uff0c\u4e2a\u4eba\u8ba4\u4e3a\u77e9\u4e58\u6bd4\u7ec4\u5408\u6570\u597d\u7406\u89e3\u4e00\u4e9b\u3002  \n\u6211\u4eec\u5148\u8003\u8651\u5bf9\u4e8e$p^m(p\\text{\u4e3a\u8d28\u6570})$\u8fdb\u884c\u9898\u76ee\u6240\u63cf\u8ff0\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u5217\u51fa\u4e00\u4e2a\u521d\u59cb\u72b6\u6001\uff08\u7b2c\u4e00\u884c\u5e76\u4e0d\u5c5e\u4e8e\u77e9\u9635\uff0c\u53ea\u662f\u8868\u793a\u7b2c\u51e0\u5217\uff09\uff1a  \n\n$\\qquad\\qquad\\qquad\\qquad\\begin{pmatrix}0&1&2&3&\\cdots&m-1&m\\\\0&0&0&0&\\cdots&0&1\\end{pmatrix}$  \n\n\u8868\u793a\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$p^k(k\\in[0,m])$\uff0c\u5b83\u7684\u8d21\u732e\u662f\u591a\u5c11\uff0c\u8d77\u59cb\u53ea\u6709\u4e00\u4e2a\u6570$p^m$\uff0c\u5b83\u7684\u8d21\u732e\u5373\u4e3a$1$\uff0c\u5176\u5b83\u5747\u4e3a$0$\u3002  \n\u7136\u540e\u6211\u4eec\u8fdb\u884c\u4e00\u6b21\u6c42\u7ea6\u6570\u7684\u64cd\u4f5c\uff0c\u56e0\u4e3a$p^m$\u7684\u7ea6\u6570\u4e3a$p^0,p^1,p^2,\\dots,p^m$\uff0c\u6240\u4ee5\u77e9\u9635\u5c31\u53d8\u6210\u8fd9\u6837\uff1a  \n\n$\\qquad\\qquad\\qquad\\qquad\\begin{pmatrix}0&1&2&3&\\cdots&m-1&m\\\\1&1&1&1&\\cdots&1&1\\end{pmatrix}$  \n\n\u518d\u8fdb\u884c\u4e00\u6b21\u6c42\u7ea6\u6570\u64cd\u4f5c\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u4e4b\u524d\u4ea7\u751f\u7684\u7ea6\u6570$p^k$\uff0c\u5b83\u4ea7\u751f\u7684\u7ea6\u6570\u4e3a$p^0,p^1,p^2,\\dots,p^k$\uff0c\u6240\u4ee5\u77e9\u9635\u5c31\u53d8\u6210\u8fd9\u6837\uff1a  \n\n$\\qquad\\qquad\\qquad\\begin{pmatrix}0&1&2&3&\\cdots&m-1&m\\\\m&m-1&m-2&m-3&\\cdots&2&1\\end{pmatrix}$  \n\n\u4e8e\u662f\u6211\u4eec\u5c31\u627e\u5230\u4e86\u9012\u63a8\u7684\u516c\u5f0f\uff1a  \n\u8bbe\u77e9\u9635\u4e3a$f[i][j]$\uff0c$i$\u8868\u793a\u8fdb\u884c\u4e86\u51e0\u6b21\u6c42\u7ea6\u6570\u64cd\u4f5c\uff0c$j$\u5219\u8868\u793a$p^j$\u7684\u8d21\u732e\uff0c\u521d\u59cb\u72b6\u6001\u4e3a$f[0][0\\to m]=1$\uff0c\u56e0\u4e3a\u7b2c$0$\u6b21\u5373\u4e3a\u8fdb\u884c\u8fc7\u4e00\u6b21\u64cd\u4f5c\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u5c42$i(i>0)$\uff0c\u6709\u9012\u63a8\u5f0f$f[i][j]=\\sum\\limits_{k=j}^mf[i-1][k]$\uff0c\u6700\u540e\u9012\u63a8\u81f3$K$\u5c42\u65f6\uff0c\u663e\u7136$\\sum\\limits_{i=0}^mf[K][i]$\u5373\u4e3a$p^m$\u8fd9\u4e2a\u6570\u7684\u8d21\u732e\u3002  \n\u800c\u6839\u636e\u7b97\u672f\u57fa\u672c\u5b9a\u7406\uff0c$N=\\prod\\limits_{i=1}^mp_i^{c_i}$\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$p_i^{c_i}$\u7528\u4e0a\u8ff0\u65b9\u6cd5\u8ba1\u7b97\u51fa\u5b83\u7684\u8d21\u732e\uff0c\u800c\u6574\u4e2a\u6570$N$\u7684\u603b\u8d21\u732e\u5373\u4e3a$\\prod\\limits_{i=1}^m\\sum\\limits_{j=0}^mf[K][j]$\u3002  \n\u7136\u540e\u6211\u4eec\u8003\u8651\u7528\u77e9\u9635\u5feb\u901f\u5e42\u53bb\u52a0\u901f\u8fd9\u4e2a\u9012\u63a8\uff0c\u56e0\u4e3a\u539f\u77e9\u9635\u4e3a$1\\times (m+1)$\u5927\u5c0f\uff0c\u8981\u4f7f\u5f97\u4e58\u5b8c\u540e\u4ecd\u4e3a$1\\times (m+1)$\uff0c\u663e\u7136\u6211\u4eec\u9700\u8981\u4e00\u4e2a$(m+1)\\times (m+1)$\u7684\u9012\u63a8\u77e9\u9635\uff1a  \n$\\qquad\\qquad\\qquad\\quad\\begin{pmatrix}&0&1&2&\\cdots&m-1&m\\\\0&1&0&0&\\cdots&0&0\\\\1&1&1&0&\\cdots&0&0\\\\2&1&1&1&\\cdots&0&0\\\\\\vdots&\\vdots&\\vdots&\\vdots&\\ddots&\\vdots&\\vdots\\\\m-1&1&1&1&\\cdots&1&0\\\\m&1&1&1&\\cdots&1&1\\end{pmatrix}$  \n\u800c\u56e0\u4e3a$2^{60}=1,152,921,504,606,846,976>10^{18}$\uff0c\u6240\u4ee5$m<60$\uff0c\u8dd1\u7684\u8fd8\u662f\u633a\u5feb\u7684\uff0c\u4e8e\u662f\u5269\u4e0b\u7684\u65f6\u95f4\u5c31\u662f\u5c06$N$\u5206\u89e3\u8d28\u56e0\u6570\u7684\u65f6\u95f4\u4e86\uff0c\u5982\u679c\u4f7f\u7528\u6734\u7d20\u7684$\\sqrt{N}$\u7b97\u6cd5\u663e\u7136\u4f1a$T$\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u7528$Miller-Rabin$\u7b97\u6cd5\u548c$Pollard-Rho$\u7b97\u6cd5\u53bb\u5206\u89e3\uff0c\u8fd9\u91cc\u63a8\u8350\u4e2a\u8bb2\u8fd9\u4e24\u4e2a\u7b97\u6cd5\u7684\u535a\u5ba2[$Miller-Rabin$\u7b97\u6cd5](https://blog.csdn.net/sunshine_cfbsl/article/details/52425798)\u3001[$Pollard-Rho$\u7b97\u6cd5](https://blog.csdn.net/sunshine_cfbsl/article/details/52512706)\u3002  \n\u5728\u4e0a\u8ff0\u63a8\u5bfc\u4e2d\u5176\u5b9e\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u77e9\u9635\u53ea\u4e0e\u8fd9\u4e2a\u6b21\u6570$c_i$\u6709\u5173\uff0c\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u7a0d\u5fae\u4f18\u5316\u4e0b\uff0c\u8bb0\u5f55\u4e00\u4e2a\u6700\u5927\u7684$c_i$\uff0c\u7136\u540e\u7528\u77e9\u9635\u5feb\u901f\u5e42\u63a8\u51fa\u8fd9\u4e2a\u77e9\u9635\uff0c\u518d\u5c06\u5176\u524d\u7f00\u548c\u4e00\u4e0b\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u76f4\u63a5\u67e5\u627e\u6bcf\u4e2a$c_i$\u4e0b\u7684\u8d21\u732e\uff0c\u540c\u65f6\u5728\u9884\u5904\u7406\u65f6\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u628a\u76f8\u540c\u7684$c_i$\u5408\u5e76\uff0c\u8ba1\u7b97\u8d21\u732e\u65f6\u76f4\u63a5\u4e00\u4e2a\u6b21\u65b9\u4e0a\u53bb\u5373\u53ef\u3002  \n```cpp\n#include<cstdio>\n#include<cstring>\n#include<cstdlib>\n#include<ctime>\n#include<algorithm>\nusing namespace std;\ntypedef long long ll;\nconst int N=65;\nconst int mod=998244353;\nint a[N],b[N],l,L,ma;\n//a\u8bb0\u5f55\u4e0d\u540c\u7684\u6b21\u65b9\uff0cb\u8bb0\u5f55\u76f8\u540c\u7684\u6b21\u65b9\u4e2a\u6570,l\u4e3apr\u6570\u7ec4\u957f\u5ea6\uff0cL\u4e3ab\u6570\u7ec4\u957f\u5ea6\uff0cma\u4e3a\u6700\u5927\u6b21\u65b9\nll pr[N<<4];\n//pr\u4e3aN\u5206\u89e3\u51fa\u6765\u7684\u6240\u4ee5\u8d28\u56e0\u6570\nstruct dd{//(m+1)*(m+1)\u7684\u77e9\u9635\n\tll T[N][N];\n\tdd()\n\t{\n\t\tmemset(T,0,sizeof(T));\n\t}\n\tdd operator * (const dd& B)//\u81ea\u4e58\n\t{\n\t\tdd C;\n\t\tint i,j,k;\n\t\tfor(i=0;i<=ma;i++)\n\t\t\tfor(j=0;j<=ma;j++)\n\t\t\t\tfor(k=0;k<=ma;k++)\n\t\t\t\t\t(C.T[i][j]+=T[i][k]*B.T[k][j]%mod)%=mod;\n\t\treturn C;\n\t}\n};\nstruct jc{//1*(m+1)\u7684\u77e9\u9635\n\tll S[N];\n\tjc()\n\t{\n\t\tmemset(S,0,sizeof(S));\n\t}\n\tjc operator * (const dd& B)//\u4e58\u4e0a(m+1)*(m+1)\u7684\u77e9\u9635\n\t{\n\t\tjc C;\n\t\tint i,j;\n\t\tfor(i=0;i<=ma;i++)\n\t\t\tfor(j=0;j<=ma;j++)\n\t\t\t\t(C.S[i]+=S[j]*B.T[j][i]%mod)%=mod;\n\t\treturn C;\n\t}\n};\njc an;//\u50a8\u5b58\u7b54\u6848\ndd tf;//\u9012\u63a8\u77e9\u9635\nll re()//\u5feb\u8bfb\n{\n\tll x=0;\n\tchar c=getchar();\n\tfor(;c<'0'||c>'9';c=getchar());\n\tfor(;c>='0'&&c<='9';c=getchar())\n\t\tx=x*10+(c-'0');\n\treturn x;\n}\nvoid jc_ksm(ll y)//\u77e9\u9635\u5feb\u901f\u5e42\n{\n\tint i,j;\n\tmemset(tf.T,0,sizeof(tf.T));\n\tfor(i=0;i<=ma;i++)//\u521d\u59cb\u5316\u4e3a1\n\t\tan.S[i]=1;\n\tfor(i=0;i<=ma;i++)//\u521d\u59cb\u5316\u4e3a\u4e00\u4e2a\u5f62\u5982\u4e09\u89d2\u5f62\u76841\n\t\tfor(j=0;j<=i;j++)\n\t\t\ttf.T[i][j]=1;\n\tfor(;y;y>>=1,tf=tf*tf)//\u5feb\u901f\u5e42\n\t\tif(y&1)\n\t\t\tan=an*tf;\n}\nll n_ksm(ll x,int y)//\u4e00\u4e2a\u666e\u901a\u7684\u5feb\u901f\u5e42\n{\n\tll s=1;\n\tfor(;y;y>>=1,x=x*x%mod)\n\t\tif(y&1)\n\t\t\ts=s*x%mod;\n\treturn s;\n}\nvoid su()//\u5bf9\u7b54\u6848\u77e9\u9635\u8fdb\u884c\u524d\u7f00\u548c\u5904\u7406\n{\n\tint i;\n\tfor(i=ma;i;i--)\n\t\t(an.S[i-1]+=an.S[i])%=mod;\n}\n//\u4ee5\u4e0b\u4e3aMiller\u548cPorllard\nll mu(ll x,ll y,ll M)\n{\n\tll s=0;\n\tfor(;y;y>>=1,x=(x+x)%M)\n\t\tif(y&1)\n\t\t\ts=(s+x)%M;\n\treturn s;\n}\nll ksm(ll x,ll y,ll M)\n{\n\tll s=1;\n\tfor(;y;y>>=1,x=mu(x,x,M))\n\t\tif(y&1)\n\t\t\ts=mu(s,x,M);\n\treturn s;\n}\nbool miller(ll x)\n{\n\tint i,j,t=0;\n\tll y=x-1,X,Y;\n\tif(x==2)\n\t\treturn true;\n\tfor(;!(y&1);t++,y>>=1);\n\tfor(j=1;j<=20;j++)\n\t{\n\t\tX=ksm(2+rand()%(x-2),y,x);\n\t\tfor(i=1;i<=t;i++,X=Y)\n\t\t{\n\t\t\tY=mu(X,X,x);\n\t\t\tif(Y==1&&X!=1&&X!=x-1)\n\t\t\t\treturn false;\n\t\t}\n\t\tif(X!=1)\n\t\t\treturn false;\n\t}\n\treturn true;\n}\nll gcd(ll x,ll y)\n{\n\tif(!y)\n\t\treturn x;\n\treturn gcd(y,x%y);\n}\nll poll(ll x,ll c)\n{\n\tll i,k=2,X=1+rand()%(x-1),Y=X,G;\n\tfor(i=1;;i++)\n\t{\n\t\tX=(mu(X,X,x)+c)%x;\n\t\tG=gcd((Y-X+x)%x,x);\n\t\tif(G!=1&&G!=x)\n\t\t\treturn G;\n\t\tif(X==Y)\n\t\t\treturn x;\n\t\tif(i==k)\n\t\t{\n\t\t\tY=X;\n\t\t\tk<<=1;\n\t\t}\n\t}\n}\nvoid sch(ll x,ll c)\n{\n\tll k=c,p=x;\n\tif(x==1)\n\t\treturn;\n\tif(miller(x))\n\t{\n\t\tpr[++l]=x;\n\t\treturn;\n\t}\n\twhile(p>=x)\n\t\tp=poll(p,k--);\n\tsch(p,c);\n\tsch(x/p,c);\n}\n//\u4ee5\u4e0a\u4e3aMiller\u548cPorllard\nvoid ud(int k)//\u8bb0\u5f55\u6b21\u65b9\n{\n\tif(!b[k])//\u82e5\u6ca1\u6709\u51fa\u73b0\n\t{\n\t\ta[++L]=k;\n\t\tb[k]=1;\n\t\tma=ma>k?ma:k;\n\t}\n\telse//\u82e5\u51fa\u73b0\u8fc7\n\t\tb[k]++;\n}\nint main()\n{\n\tint i,k=0;\n\tll n,m,s=1;\n\tn=re();\n\tm=re();\n\tsch(n,113);//\u5206\u89e3\u8d28\u56e0\u6570\n\tsort(pr+1,pr+l+1);//\u6392\u5e8f\n\tfor(i=1;i<=l;i++)//\u8bb0\u5f55\n\t{\n\t\tif(i==1||pr[i]==pr[i-1])\n\t\t\tk++;\n\t\telse\n\t\t{\n\t\t\tud(k);\n\t\t\tk=1;\n\t\t}\n\t}\n\tif(k)\n\t\tud(k);\n\tjc_ksm(m);//\u77e9\u9635\u5feb\u901f\u5e42\n\tsu();//\u524d\u7f00\u548c\n\tfor(i=1;i<=L;i++)//\u6309\u4e0a\u8ff0\u8fdb\u884c\u7d2f\u4e58\u51fa\u7b54\u6848\n\t\t(s*=n_ksm(an.S[ma-a[i]],b[a[i]]))%=mod;\n\tprintf(\"%lld\",s);\n\treturn 0;\n}\n```",
        "postTime": 1529559915,
        "uid": 60181,
        "name": "Iowa_BattleShip",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4714 \u3010\u300c\u6570\u5b66\u300d\u7ea6\u6570\u4e2a\u6570\u548c\u3011"
    }
]
[
    {
        "content": "~~\u8fd9\u7bc7\u9898\u89e3\u5bf9\u4e8e\u8bb8\u591a\u9898\u89e3\u6253\u8868/\u4e00\u8a00\u6982\u62ec\u5f97\u5230\u7684\u7ed3\u8bba\u8fdb\u884c\u4e86\u5145\u5206\u7684\u8bc1\u660e~~\n\n\u6211\u4eec\u5c06\u5e8f\u5217$a$\u770b\u4f5c\u4e00\u4e2a$OGF$\n\n$$F(x)=\\sum_{i=0}^{\\infty} a_i x^i$$\n\n\u8003\u8651\u8ba1\u7b97\u524d\u7f00\u548c\uff0c\u4f17\u6240\u5468\u77e5\uff0c\u53ea\u9700\u8981\u62ff\u5b83\u4e58\u4ee5$G(x)=1+x^1+...+x^{\\infty}$\n\n\u6839\u636e\u4e00\u4e9b\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u7684\u829d\u58eb\u6211\u4eec\u77e5\u9053$G(x)=\\dfrac{1}{1-x}$\n\n\u7f6e\u4e8e\u6c42\u5b83\u7684\u5dee\u5206\uff0c\u5219\u62ff$F$\u548c$1-x$\u5377\u8d77\u6765\u5373\u53ef\n\n\u597d\u4e86\u90a3\u4e48$k$\u7ef4\u524d\u7f00\u548c\u5462\uff1f\n\n$$F\\times\\dfrac{1}{(1-x)^k}$$\n\n$k$\u7ef4\u5dee\u5206\u5462\uff1f\n\n$$F\\times (1-x)^k$$\n\n\u597d\u4e86\u7136\u540e\u6c42\u4e2a$\\ln$\uff0c\u4e58\u4e2a$k$\uff0c\u53d6\u4e2a$\\exp$\u8fd9\u9053\u9898\u5c31\u505a\u5b8c\u4e86\n\n\u4f46\u662f\u975e\u5e38\u4e0d\u5e78\u7684\u662f\u8fd9\u6837\u4f1a\u975e\u5e38\u96be\u5199\u800c\u4e14\u6211\u5df2\u7ecf\u4e0d\u4f1a\u6c42$\\ln$\u548c$\\exp$\u4e86\uff08\u4e0d\u8981\u95ee\u6211\u600e\u4e48\u6e05$0$\uff0c\u6211\u4e5f\u4e0d\u4f1a\u6e05$0$\uff09\n\n\u4e8e\u662f\u6211\u4eec\u8fd8\u662f\u7528\u70b9\u751f\u6210\u51fd\u6570\u7684\u6280\u5de7\u5427\n\n\u9996\u5148\u662f\u5dee\u5206\uff0c\u5b83\u975e\u5e38\u597d\u505a\uff1a\n\n$$(1-x)^k$$\n\n\u4e8c\u9879\u5f0f\u5b9a\u7406\u5f3a\u884c\u6253\u5f00\u4f7f\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff1a\n\n$$(1-x)^k=\\sum_{i=0}^{\\infty}(-1)^i\\dbinom{k}{i}x^i$$\n\n\u597d\u7684\u8fd9\u9053\u9898\u771f\u662f\u89c1\u4e86\u9b3c\u4e86$k$\u8fd9\u4e48\u5927\u641e\u4ec0\u4e48\u3002\u3002\u3002\n\n\u4e0d\u8fc7\u8fd9\u9053\u9898\u8981\u7528\u8fde\u7eed\u7684\u7ec4\u5408\u6570\u7136\u800c\u5b83\u53ef\u4ee5\u9012\u63a8\n\n$\\dbinom{k}{0}=1,\\dbinom{k}{i}=\\dbinom{k}{i-1}\\times\\dfrac{k-i+1}{i}$\n\n\u7136\u540e\u5927\u6982$k$\u662f\u53ef\u4ee5\u76f4\u63a5\u53d6\u6a21\u7684\u3002\u3002\u3002\n\n\u597d\u4e86\u63a5\u4e0b\u6765\u662f\uff1a\n\n$$\\dfrac{1}{(1-x)^k}$$\n\n\u8fd9\u4e2a\u6709\u70b9\u9ebb\u70e6\uff0c\u9700\u8981\u501f\u52a9\u5e7f\u4e49\u4e8c\u9879\u5f0f\u5b9a\u7406\uff1a\n\n\u6211\u4eec\u628a\u5b83\u770b\u4f5c$(1-x)^{-k}$\n\n\u6839\u636e\u5e7f\u4e49\u4e8c\u9879\u5f0f\u5b9a\u7406\u5b83\u7b49\u4ef7\u4e8e\uff1a\n\n$$(1-x)^a=\\sum_{i=0}^{\\infty}\\dbinom{a}{i}x^i$$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u770b\u4e0a\u53bb\u633a\u5bf9\u7684\u3002\u3002\u3002\u6bd5\u7adf\u5f53$i>a$\u7684\u65f6\u5019$\\dbinom{a}{i}=0..$\u4e0d\u8fc7\u73b0\u5728\u6211\u4eec\u4e0d\u80fd\u7528\u9636\u4e58\u6765\u5b9a\u4e49\u7ec4\u5408\u6570\u4e86\uff0c\u4e8e\u662f\u6211\u4eec\u9700\u8981\u628a\u5b83\u6539\u6210\u4e0b\u964d\u5e42\u7684\u5f62\u5f0f\uff1a\n\n$$\\dbinom{a}{i}=\\dfrac{a^{\\underline{i}}}{i!}$$\n\n\u6ce8\uff1a$a^{\\underline{i}}=a(a-1)(a-2)...(a-i+1)$\n\n\u597d\u7684\u6211\u4eec\u6765\u770b\u4e0b$-k$\u4ee3\u5165\u8fdb\u53bb\u662f\u4ec0\u4e48\u6837\u7684\uff1a\n\n$$(1-x)^{-k}=\\sum_{i=0}^{\\infty}(-1)^i\\dfrac{(-k)^{\\underline{i}}}{i!}x^i$$\n\n$$(1-x)^{-k}=\\sum_{i=0}^{\\infty}(-1)^{2i}\\dfrac{(k+i-1)^{\\underline{i}}}{i!}x^i$$\n\n\u6240\u4ee5\u6211\u4eec\u77e5\u9053\uff1a\n\n$$(1-x)^{-k}=\\sum_{i=0}^{\\infty}\\dbinom{k+i-1}{i}x^i$$\n\n\u597d\u4e86\u4e8e\u662f\u5bf9\u4e8e\u5dee\u5206\u6211\u4eec\u53ea\u9700\u8981\u62ff$F$\u548c$\\sum_{i=0}^{\\infty}(-1)^i\\dbinom{k}{i}x^i$\u5377\u8d77\u6765\u5373\u53ef\n\n\u5bf9\u4e8e\u524d\u7f00\u548c\u6211\u4eec\u53ea\u9700\u8981\u62ff$F$\u548c$\\sum_{i=0}^{\\infty}\\dbinom{k+i-1}{i}x^i$\u5377\u8d77\u6765\u5373\u53ef\n\n\u5f53\u7136\u8fd9\u4e2a\u4ec0\u4e48$\\dbinom{k+i-1}{i}$\u4e5f\u53ef\u4ee5\u9012\u63a8\uff0c\u56e0\u4e3a\u5b83\u662f$\\dfrac{(k+i-1)^{\\underline{i}}}{i!}$\uff0c\u8981\u9012\u63a8\u7684\u8bdd\u4e5f\u5f88\u7b80\u5355\uff0c\u6bcf\u6b21\u4e58\u4e00\u4e2a$(k+i-1)/i$\u5373\u53ef\n\n\u7136\u540e\u6a21\u6570\u8fd8\u662f$\\text{NTT}$\u6a21\u6570\u3002\u3002\u3002\n\n~~\u5b9e\u9645\u4e0a\u8fd9\u7bc7\u9898\u89e3\u662f\u5728\u505a\u4e00\u4e9b\u7279\u522b\u8822\u7684\u8bc1\u660e\u3002\u3002\u3002~~\n\n$Code:$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std ;\n#define rep( i, s, t ) for( register int i = s; i <= t; ++ i )\n#define re register\n#define int long long\nconst int P = 1004535809 ;\nconst int Gi = 334845270 ; \nconst int G = 3 ;\nint gi() {\n\tchar cc = getchar() ; int cn = 0, flus = 1 ;\n\twhile( cc < '0' || cc > '9' ) {  if( cc == '-' ) flus = - flus ; cc = getchar() ; }\n\twhile( cc >= '0' && cc <= '9' )  cn = ( cn * 10 + cc - '0' ) % P, cc = getchar() ;\n\treturn cn * flus ;\n}\nconst int N = 1e5 + 5 ; \nint n, m, A[N << 2], B[N << 2], limit, L, Inv, R[N << 2] ; \nint fpow( int x, int k ) {\n\tint ans = 1, base = x ; \n\twhile( k ) {\n\t\tif( k & 1 ) ans = ( ans * base ) % P ; \n\t\tbase = ( base * base ) % P, k >>= 1 ; \n\t} return ans ; \n}\nvoid init( int x ) {\n\tlimit = 1, L = 0 ; \n\twhile( limit <= x ) limit <<= 1, ++ L ; \n\trep( i, 0, limit ) R[i] = ( R[i >> 1] >> 1 ) | ( ( i & 1 ) << ( L - 1 ) ) ;\n\tInv = fpow( limit, P - 2 ) ;\n}\nvoid NTT( int *a, int type ) {\n\tfor( re int i = 0; i < limit; ++ i ) if( R[i] > i ) swap( a[i], a[R[i]] ) ;\n\tfor( re int k = 1; k < limit; k <<= 1 ) {\n\t\tint d = fpow( ( type == 1 ) ? G : Gi, ( P - 1 ) / ( k << 1 ) ) ; \n\t\tfor( re int i = 0; i < limit; i += ( k << 1 ) ) \n\t\tfor( re int j = i, g = 1 ; j < i + k; ++ j, g = ( g * d ) % P ) {\n\t\t\tint Nx = a[j], Ny = ( a[j + k] * g ) % P ;\n\t\t\ta[j] = ( Nx + Ny ) % P, a[j + k] = ( Nx - Ny + P ) % P ; \n\t\t} \n\t}\n\tif( type != 1 ) rep( i, 0, limit ) a[i] = a[i] * Inv % P ; \n}\nsigned main()\n{\n\tn = gi(), m = gi() ; int type = gi() ; \n\trep( i, 1, n ) A[i - 1] = gi() ; B[0] = 1 ; \n\tif( type == 0 ) rep( i, 1, n ) B[i] = B[i - 1] * ( m + i - 1 ) % P * fpow( i, P - 2 ) % P ; \n\tif( type == 1 ) rep( i, 1, n ) B[i] = ( -B[i - 1] * ( m - i + 1 + P ) % P * fpow( i, P - 2 ) % P + P ) % P ; \n\tinit( n + n ), NTT( A, 1 ), NTT( B, 1 ) ;\n\trep( i, 0, limit ) A[i] = A[i] * B[i] % P ;\n\tNTT( A, -1 ) ; rep( i, 1, n ) printf(\"%lld \", A[i - 1] ) ;  \n\treturn 0 ;\n}\n```",
        "postTime": 1575168365,
        "uid": 30036,
        "name": "Soulist",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5488 \u3010\u5dee\u5206\u4e0e\u524d\u7f00\u548c\u3011"
    },
    {
        "content": "\u5728\u6211\u7684\u591a\u9879\u5f0f\u5168\u5bb6\u6876\u91cc\u9762\u5199\u7684\u89e3\u6cd5\u592a\u8fc7\u7b80\u7565\u3002\u3002  \n\u8fd9\u91cc\u5199\u4e00\u4e2a\u8be6\u7ec6\u53c8\u597d\u7406\u89e3\u7684\u5427qwq\n****\n\n\u5148\u6765\u8003\u8651\u524d\u7f00\u548c\u3002  \n\n$$s_i=\\sum\\limits_{j=1}^ia_j$$  \n\u628a\u5b83\u548c\u5377\u79ef\u7684\u5f0f\u5b50\u6bd4\u8f83\u4e00\u4e0b\uff1a  \n$$s_i=\\sum\\limits_{j+k=i}a_jb_k$$  \n\u6211\u4eec\u53d1\u73b0\uff1a\u5bf9 $a$ \u505a\u4e00\u6b21\u524d\u7f00\u548c\uff0c\u76f8\u5f53\u4e8e\u548c\u4e00\u4e2a\u7cfb\u6570\u5168\u662f $1$ \u7684\u591a\u9879\u5f0f\u505a\u4e00\u6b21\u5377\u79ef\u3002  \n\n\u5377\u79ef\u662f\u6709\u7ed3\u5408\u5f8b\u7684\uff0c\u6240\u4ee5\u505a $k$ \u6b21\u524d\u7f00\u548c\uff0c\u8981\u4e58\u4e0a\u53bb\u7684\u591a\u9879\u5f0f\u5c31\u662f \n$$\\frac{1}{(1-x)^k}$$  \n\u5bb9\u6613\u8bc1\u660e\u8fd9\u4e2a\u5f0f\u5b50\u7684 $n$ \u6b21\u9879\u7cfb\u6570\u4e3a $\\binom{n+k-1}{k-1}$\uff0c\u4e8e\u662f\u76f4\u63a5\u8ba1\u7b97\u5c31\u53ef\u4ee5\u5566 \n****  \n\u7528\u7c7b\u4f3c\u7684\u601d\u8def\uff0c\u6765\u770b\u5dee\u5206\u7684\u505a\u6cd5\u3002  \n\n\u53ef\u4ee5\u5f97\u51fa\u505a\u4e00\u6b21\u5dee\u5206\u8981\u5377\u79ef\u7684\u5f0f\u5b50\u662f $1-x$\uff0c$k$ \u6b21\u5c31\u662f $(1-x)^k$\uff0c\u5c55\u5f00\u5c31\u662f  \n$$\\sum\\limits_{i=0}^k\\binom{k}{i}(-1)^ix^i$$\n\n\u8981\u6ce8\u610f\u7684\u662f $k$ \u975e\u5e38\u5927\uff0c\u6240\u4ee5\u8981\u5148\u53d6\u6a21\uff0c\u7136\u540e\u76f4\u63a5\u9012\u63a8\u8ba1\u7b97\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u3002  \n\u81f3\u4e8e\u5176\u6b63\u786e\u6027\uff0c\u7528 Lucas \u5b9a\u7406\u53ef\u4ee5\u7b80\u5355\u5730\u8bc1\u660e\u5728 $n<p$ \u7684\u65f6\u5019\u6b63\u786e\u3002\n\n~~\u662f\u4e0d\u662f\u5f88\u7b80\u5355\u5462\uff1f~~\n```cpp\n// luogu-judger-enable-o2\n#include<cstdio> \n#include<iostream>\n#include<cstring>\n#include<algorithm>\n#define ll long long\n#define N 262147\n#define LIM 262144\n#define reg register\n#define p 1004535809\nusing namespace std;\n\nstruct poly{\n    int a[N];\n    int t;\n};\n\nint rev[N],lg2[N],rt[N],irt[N],inv[N];\n\ninline void read(int &x);\nvoid print(int x);\ninline int power(int a,int t);\ninline int add(int a,int b);\ninline int dec(int a,int b);\nvoid init();\ninline void NTT(poly &f,int type,int lim);\n\ninline void mod_read(int &x){\n\tx = 0;\n\tchar c = getchar();\n\twhile(c<'0'||c>'9') c = getchar();\n\twhile(c>='0'&&c<='9'){\n\t\tx = (((ll)x<<3)+(x<<1)+(c^48))%p;\n\t\tc = getchar();\n\t}\n}\n\npoly F,G;\nint n,k,lim,type;\n\nint main(){\n    init();\n    inv[1] = 1;\n    read(n),mod_read(k),read(type);\n    for(reg int i=0;i<n;++i) read(F.a[i]); \n    for(reg int i=2;i<n;++i) inv[i] = (ll)(p-p/i)*inv[p%i]%p;\n    G.t = n-1,G.a[0] = 1;\n    if(type==1){\n        for(reg int i=1;i<n;++i)\n            G.a[i] = (ll)G.a[i-1]*(dec(k,i)+1)%p*inv[i]%p;\n        for(reg int i=1;i<n;++i)\n            if(i&1) G.a[i] = G.a[i]?p-G.a[i]:0;\n    }else{\n        for(reg int i=1;i<n;++i)\n            G.a[i] = (ll)G.a[i-1]*inv[i]%p*(i+k-1)%p;\n    }\n    lim = 1;\n    while(lim<=((n-1)<<1)) lim <<= 1;\n    NTT(F,1,lim),NTT(G,1,lim);\n    for(reg int i=0;i!=lim;++i) F.a[i] = (ll)F.a[i]*G.a[i]%p;\n    NTT(F,-1,lim);\n    for(reg int i=0;i<n;++i) print(F.a[i]),putchar(' ');\n    return 0;\n}\n\ninline void NTT(poly &f,int type,int lim){\n    reg int w,y,l = lg2[lim]-1;\n    for(reg int i=1;i!=lim;++i){\n        rev[i] = (rev[i>>1]>>1)|((i&1)<<l);\n        if(i>=rev[i]) continue;\n        swap(f.a[i],f.a[rev[i]]);\n    }\n    l = LIM>>1;\n    for(reg int mid=1;mid!=lim;mid<<=1){\n        for(reg int j=0;j!=lim;j+=(mid<<1)){\n            for(reg int k=0;k!=mid;++k){\n                w = type==1?rt[l*k]:irt[l*k];\n                y = (ll)w*f.a[j|k|mid]%p;\n                f.a[j|k|mid] = dec(f.a[j|k],y);\n                f.a[j|k] = add(f.a[j|k],y);\n            }\n        }\n        l >>= 1;\n    }\n    if(type==1) return;\n    y = power(lim,p-2);\n    for(reg int i=0;i!=lim;++i) f.a[i] = (ll)f.a[i]*y%p;\n}\n\nvoid init(){\n    for(reg int i=2;i<=LIM;++i) lg2[i] = lg2[i>>1]+1;\n    rt[0] = 1,rt[1] = power(3,(p-1)/LIM);\n    irt[0] = 1,irt[1] = power(rt[1],p-2);\n    for(reg int i=2;i<=LIM;++i){\n        rt[i] = (ll)rt[i-1]*rt[1]%p;\n        irt[i] = (ll)irt[i-1]*irt[1]%p;\n    }\n}\n\ninline int add(int a,int b){\n    return a+b>=p?a+b-p:a+b;\n}\n\ninline int dec(int a,int b){\n    return a<b?a-b+p:a-b;\n}\n\ninline int power(int a,int t){\n    int res = 1;\n    while(t){\n        if(t&1) res = (ll)res*a%p;\n        a = (ll)a*a%p;\n        t >>= 1;\n    }\n    return res;\n}\n\ninline void read(int &x){\n    x = 0;\n    char c = getchar();\n    while(c<'0'||c>'9') c = getchar();\n    while(c>='0'&&c<='9'){\n        x = (x<<3)+(x<<1)+(c^48);\n        c = getchar();\n    }\n}\n\nvoid print(int x){\n    if(x>9) print(x/10);\n    putchar(x%10+'0');\n}\n```",
        "postTime": 1564842021,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5488 \u3010\u5dee\u5206\u4e0e\u524d\u7f00\u548c\u3011"
    },
    {
        "content": "~~Karry\u6012\u9a82\u6b64\u9898\u662f\u591a\u9879\u5f0f\u677f\u5b50\uff1f\uff1f\uff1f~~\n\n\u4f60\u8981\u662f\u770b\u51fa\u8fd9\u9053\u9898\u662f\u591a\u9879\u5f0f\u4e86\u4e5f\u5c31\u4e0d\u9ebb\u70e6\u4e86\n\n$ps:$\u672c\u9898\u89e3\u5747\u75280\u4e3a\u6570\u7ec4\u4e0b\u6807\uff0c\u4ee5\u65b9\u4fbf\u591a\u9879\u5f0f\u8fd0\u7b97\uff0c\u6240\u4ee5\u516c\u5f0f\u53ef\u80fd\u548c\u5176\u4ed6\u9898\u89e3\u7565\u6709\u4e0d\u540c\n\n\u9996\u5148\u5148\u8003\u8651\u524d\u7f00\u548c\uff1a\n\n\u8003\u8651\u524d\u7f00\u548c\u7684\u5b9a\u4e49\u5f0f\uff1a$c_k=\\sum_{i=0}^ka_i$\n\n\u628a\u4ed6\u53d8\u4e0b\u578b\uff0c\u6211\u4eec\u6709\uff1a$c_k=\\sum_{i+j=k}a_i*b_j$\uff08\u5176\u4e2d$b_j=1$\uff09\n\n\u4e0d\u96be\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u7b49\u4ef7\u7684\u5f62\u5f0f\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5229\u7528$NTT$\u8fdb\u884c\u4f18\u5316\uff0c\u4e8e\u662f\u73b0\u5728\u95ee\u9898\u5c31\u8f6c\u5316\u6210\u6c42$b_i$\n\n\u5bf9\u4e8e$k=1$\u7684\u60c5\u51b5\uff0c\u90a3$b$\u662f\u4e00\u4e2a\u7cfb\u6570\u5168\u90e8\u4e3a1\u7684\u591a\u9879\u5f0f\uff0c\u7531\u4e8e\u5377\u79ef\u6ee1\u8db3\u7ed3\u5408\u5f8b\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u6c42\u51fab\u8fd9\u4e2a\u591a\u9879\u5f0f\u7684k\u6b21\u65b9\u540e\u4e0ea\u6570\u7ec4\u5377\u8d77\u6765\n\n\u8003\u8651\u6bcf\u4e00\u4f4d\u7684\u8d21\u732e\uff0c\u7528\u624b\u73a9\u4e00\u4e0b\uff0c\u4f1a\u53d1\u73b0\u8fd9\u5176\u5b9e\u662f\u4e00\u4e2a\u659c\u7740\u7684\u6768\u8f89\u4e09\u89d2\uff0c\u53ef\u4ee5\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bc1\u660e\uff0c\u6253\u51fa\u6765\u7684\u8868\u5982\u4e0b\uff1a\n```\n1   1   1   1   1   1\n1   2   3   4   5   6\n1   3   6   10  15  21\n1   4   10  20  35  56\n1   5   15  35  70  126\n1   6   21  56  126 252\n```\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5f97\u51fa\u9012\u63a8\u5f0f\uff1a\u5bf9\u4e8e\u7b2ci\u4f4d\u5bf9k\u7ef4\u524d\u7f00\u548c\u7684\u8d21\u732e\u4e3a$\\dbinom{k+i-1}{i}$\n\n\u7531\u4e8ek\u5f88\u5927\uff0c\u4f46\u662f\u6211\u4eec\u9700\u8981\u6c42\u5f97\u9879\u4e0d\u591a\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u9012\u63a8\u6c42\u51fa\u4e0a\u5f0f\uff0c\u8bfb\u5165k\u7684\u65f6\u5019\u53d6\u4e2a\u819c\u5c31\u884c\u4e86\n\n\u7136\u540e\u8003\u8651\u5dee\u5206\uff08\u5176\u5b9e\u6ca1\u6709\u672c\u8d28\u533a\u522b\uff09\uff1a\n\n\u8003\u8651\u5dee\u5206\u5b9a\u4e49\u5f0f\uff1a$c_k=a_k-a_{k-1}$\n\n\u8fd8\u662f\u8f6c\u5316\u4e00\u4e0b\uff1a$c_k=\\sum_{i+j=k}a_i*b_j$\uff08$b_0=1, b_1=-1$\uff09\n\n\u8fd8\u662f\u53ef\u4ee5\u7528\u5377\u79ef\u4f18\u5316\uff0c\u8fd8\u662f\u6253\u4e00\u4e2a\u8868\uff0c\u5bf9\u4e8e\u7b2ci\u4f4d\u5bf9k\u7ef4\u524d\u7f00\u548c\u7684\u8d21\u732e\u4e3a$\\dbinom{k}{i}*(-1)^i$\uff0c\u7528\u9012\u63a8\u6c42\u89e3\u5373\u53ef\n\n## $Code:$\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define il inline\n#define re register\n#define int long long\n#define mod 1004535809\nil int read() {\n    re int x = 0, f = 1; re char c = getchar();\n    while(c < '0' || c > '9') { if(c == '-') f = -1; c = getchar();}\n    while(c >= '0' && c <= '9') x = x * 10 + c - 48, x %= mod, c = getchar();\n    return x * f;\n}\n#define rep(i , a , b) for(int i = (a) , i##Limit = (b) ; i <= i##Limit ; ++ i)\n#define maxn 500005\nint n, k, opt, a[maxn], b[maxn], inv, lim, r[maxn];\nil int qpow(int a, int b)  {\n    int r = 1;\n    while(b) {\n        if(b & 1) r = (r * a) % mod;\n        a = (a * a) % mod, b >>= 1;\n    }\n    return r;\n}\nil int mul(int a, int b) { return a * b % mod; }\nil void NTT(int*a, int f) {\n\trep(i, 0, (1 << lim) - 1) if(r[i] > i) swap(a[i], a[r[i]]);\n\tfor(re int mid = 1; mid < (1 << lim); mid <<= 1) {\n\t\tint base = qpow(f == 1 ? 3 : inv, (mod - 1) / (mid << 1));\n\t\tfor(re int p = mid * 2, j = 0; j < (1 << lim); j += p) {\n\t\t\tint w = 1;\n\t\t\tfor(re int k = 0; k < mid; ++ k, w = mul(w, base)) {\n\t\t\t\tint x = a[j + k], y = mul(w, a[j + k + mid]);\n\t\t\t\ta[j + k] = (x + y) % mod, a[j + k + mid] = (x - y + mod) % mod;\n\t\t\t}\n\t\t}\n\t}\n}\nsigned main() {\n\tn = read(), k = read(), opt = read(), inv = qpow(3, mod - 2), b[0] = 1;\n\trep(i, 0, n - 1) a[i] = read();\n\tif(opt == 0) rep(i, 1, n - 1) b[i] = mul(mul(b[i - 1], qpow(i, mod - 2)), k + i - 1);\n\telse rep(i, 1, n - 1) b[i] = mul(mul(b[i - 1], qpow(i, mod - 2)), k - i + 1);\n\tif(opt == 1) for(re int i = 1; i < n; i += 2) b[i] = -b[i];\n\trep(i, 1, n - 1) b[i] = (b[i] + mod) % mod;\n\twhile((1ll << lim) < n * 2) ++ lim;\n\trep(i, 0, (1 << lim) - 1) r[i] = (r[i >> 1] >> 1) | ((i & 1) << (lim - 1));\n\tNTT(a, 1), NTT(b, 1);\n\trep(i, 0, (1 << lim) - 1) a[i] = mul(a[i], b[i]);\n\tNTT(a, -1), inv = qpow((1 << lim), mod - 2);\n\trep(i, 0, n - 1) printf(\"%lld \", (mul(a[i], inv) + mod) % mod);\n\treturn 0;\n}\n```",
        "postTime": 1575125628,
        "uid": 57014,
        "name": "Nemlit",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5488 \u3010\u5dee\u5206\u4e0e\u524d\u7f00\u548c\u3011"
    },
    {
        "content": "\u6765\u4e00\u53d1\u5927\u5e38\u6570 exp \u89e3\u6cd5\u3002\n\n\u6c42\u524d\u7f00\u548c\u76f8\u5f53\u4e8e $a_i\\leftarrow \\sum_{j<i} a_j$\uff0c\u4e5f\u5c31\u662f\u7ed9\u591a\u9879\u5f0f $A$ \u4e58\u4e0a $1+x+x^2+\\cdots$ \u5373 $\\dfrac{1}{1-x}$\u3002\u6c42 $k$ \u9636\u524d\u7f00\u548c\u5373\u662f\u6c42 $A\\times \\dfrac{1}{(1-x)^k}$\u3002\n\n\u6c42\u5dee\u5206\u76f8\u5f53\u4e8e $a_i\\leftarrow a_{i-1}-a_i$\uff0c\u4e5f\u5c31\u662f\u7ed9\u591a\u9879\u5f0f $A$ \u4e58\u4e0a $(1-x)$\u3002\u6c42 $k$ \u9636\u5dee\u5206\u5373\u662f\u6c42 $A\\times (1-x)^k$\u3002\n\n\u600e\u4e48\u7b97\u591a\u9879\u5f0f $k$ \u6b21\u65b9\uff1fln \u5316\u4e58\u4e3a\u52a0\u518d exp \u56de\u6765\u5373\u53ef\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<complex>\nconst int mod=1004535809,g=3,invg=1004535810/3;\nusing namespace std;\nint a[400005],b[400005],c[400005],k,t,n,m,tr[400005],wk[400005];\nint read() {\n    char ch=getchar();\n    int x=0;\n\twhile(ch<'0'||'9'<ch)ch=getchar();\n    while('0'<=ch&&ch<='9')x=(10ll*x+ch-'0')%mod,ch=getchar();\n    return x;\n}\nint Power(int x,int y,int mod) {\n\tint ret=1;\n\twhile(y) {\n\t\tif(y&1)ret=1ll*ret*x%mod;\n\t\tx=1ll*x*x%mod,y>>=1;\n\t}\n\treturn ret;\n}\nvoid GetTr(int l) {\n\tfor(int i=0; i<l; i++)tr[i]=(tr[i>>1]>>1)|((i&1)?(l>>1):0);\n}\nvoid NTT(int a[],int n,int flag) {\n\tfor(int i=0; i<n; i++)if(tr[i]<i)swap(a[i],a[tr[i]]);\n\tfor(int i=1; i<n; i<<=1) {\n\t\tint w=Power(flag==1?g:invg,(mod-1)/(i<<1),mod);\n\t\twk[0]=1;\n\t\tfor(int j=1; j<i; j++)wk[j]=1ll*wk[j-1]*w%mod;\n\t\tfor(int j=0; j<n; j+=(i<<1)) {\n\t\t\tfor(int k=0; k<i; k++) {\n\t\t\t\tint t=1ll*wk[k]*a[i+j+k]%mod;\n\t\t\t\ta[i+j+k]=(a[j+k]-t+mod)%mod;\n\t\t\t\ta[j+k]=(a[j+k]+t)%mod;\n\t\t\t}\n\t\t}\n\t}\n\tif(flag==-1)for(int i=0,t=Power(n,mod-2,mod); i<n; i++)a[i]=1ll*a[i]*t%mod;\n}\nvoid Calcinv(int a[],int b[],int l){\n\tif(l==1){\n\t\tb[0]=Power(a[0],mod-2,mod);\n\t\treturn ;\n\t}\n\tCalcinv(a,b,(l+1)/2);\n\tint len=1;\n\twhile(len<l*2)len<<=1;\n\tGetTr(len);\n\tstatic int tmp[400005]={0};\n\tmemcpy(tmp,a,sizeof(int)*l);\n\tfor(int i=l;i<len;i++)tmp[i]=0;\n\tNTT(tmp,len,1),NTT(b,len,1);\n\tfor(int i=0;i<len;i++)b[i]=(2-1ll*tmp[i]*b[i]%mod+mod)%mod*b[i]%mod;\n\tNTT(b,len,-1);\n\tfor(int i=l;i<len;i++)b[i]=0;\n}\nvoid Calcln(int a[],int b[],int l){\n\tstatic int tmp[400005]={0};\n\tmemcpy(tmp,a,sizeof(int)*l);\n\tfor(int i=1;i<l;i++)tmp[i-1]=1ll*tmp[i]*i%mod;\n\ttmp[l-1]=0;\n\tCalcinv(a,b,l);\n\tint len=1;\n\twhile(len<l*2)len<<=1;\n\tGetTr(len);\n\tfor(int i=l;i<len;i++)tmp[i]=0;\n\tNTT(b,len,1),NTT(tmp,len,1);\n\tfor(int i=0;i<len;i++)b[i]=1ll*tmp[i]*b[i]%mod;\n\tNTT(b,len,-1);\n\tfor(int i=l;i<len;i++)b[i]=0;\n\tfor(int i=l-1;i>0;i--)b[i]=1ll*b[i-1]*Power(i,mod-2,mod)%mod;\n\tb[0]=0;\n}\nvoid Calcexp(int a[],int b[],int l){\n\tif(l==1){\n\t\tb[0]=1;\n\t\treturn ;\n\t}\n\tstatic int tmp[400005]={0},ln[400005]={0};\n\tCalcexp(a,b,(l+1)/2);\n\tCalcln(b,ln,l);\n\tmemcpy(tmp,a,sizeof(int)*l);\n\tint len=1;\n\twhile(len<=l*1.5)len<<=1;\n\tGetTr(len);\n\tNTT(tmp,len,1),NTT(ln,len,1),NTT(b,len,1);\n\tfor(int i=0;i<len;i++)b[i]=1ll*b[i]*(1ll-ln[i]+tmp[i]+mod)%mod;\n\tNTT(b,len,-1);\n\tfill(b+l,b+len,0);\n\tfill(tmp,tmp+len,0);\n\tfill(ln,ln+len,0);\n}\nint main() {\n\tscanf(\"%d\",&n);\n\tk=read();\n\tscanf(\"%d\",&t); \n\tfor(int i=0;i<n;i++)scanf(\"%d\",&a[i]);\n\tb[0]=1,b[1]=mod-1;\n\tCalcln(b,c,n);\n\tfor(int i=0;i<n;i++)c[i]=1ll*c[i]*k%mod;\n\tmemset(b,0,sizeof(b));\n\tCalcexp(c,b,n);\n\tif(!t)memset(c,0,sizeof(c)),Calcinv(b,c,n),memcpy(b,c,sizeof(c));\n\tint l=1;\n\twhile(l<n*2)l<<=1;\n\tNTT(a,l,1),NTT(b,l,1);\n\tfor(int i=0;i<l;i++)a[i]=1ll*a[i]*b[i]%mod;\n\tNTT(a,l,-1);\n\tfor(int i=0;i<n;i++)printf(\"%d \",a[i]);\n\treturn 0;\n}\n```",
        "postTime": 1585191700,
        "uid": 42156,
        "name": "feecle6418",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5488 \u3010\u5dee\u5206\u4e0e\u524d\u7f00\u548c\u3011"
    },
    {
        "content": "# P5488 \u5dee\u5206\u4e0e\u524d\u7f00\u548c \u9898\u89e3\n\n\u6807\u7b7e\uff1a \u591a\u9879\u5f0f\n\n---\n\n### \u524d\u8a00\n\n\u4e00\u4e2a\u725b\u987f\u4e8c\u9879\u5f0f\u5b9a\u7406\u7684\u5e94\u7528\uff0c\u638c\u63e1\u597d\u8fd9\u4e2a\u9898\u76ee\u5bf9\u7ec4\u5408\u6570\u5b66\u6709\u4e00\u5b9a\u7684\u5e2e\u52a9\u3002\n\n\u81ea\u8ba4\u4e3a\u662f\u7279\u522b\u8be6\u7ec6\u4e86\u3002\n\n### \u524d\u7f6e\u77e5\u8bc6\n\n1\u3001\u725b\u987f\u4e8c\u9879\u5f0f\u5b9a\u7406(\u52a0\u4e2a\u6b63\u53f7\u9632\u6b62\u6709\u6b67\u4e49)\u3002\n\n$$(1+x)^{\\alpha}=\\sum_{i=0}^{\\infty}\\binom{\\alpha}{i}(+x)^i$$\n\n$$\\binom{n}{m}=\\frac{n^{\\underline{m}}}{m!}=\\frac{\\frac{n!}{(n-m)!}}{m!}$$\n\n2\u3001NTT\u3002\n\n3\u3001\u751f\u6210\u51fd\u6570\uff08\u4f1a\u5c01\u95ed\u5f62\u5f0f\uff09\u3002\n\n4\u3001$n$ \u9636\u524d\u7f00\u548c\u4ee5\u53ca $n$ \u9636\u5dee\u5206\u3002\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff1a $1$ \u9636\u524d\u7f00\u548c\u662f\u6211\u4eec\u6240\u719f\u77e5\u7684\u4e00\u7ef4\u524d\u7f00\u548c\uff0c $2$ \u9636\u524d\u7f00\u548c\u5c31\u662f $1$ \u9636\u524d\u7f00\u548c\u7684\u524d\u7f00\u548c\uff0c\u4f9d\u6b21\u7c7b\u63a8\uff0c$n$ \u9636\u524d\u7f00\u548c\u662f $n-1$ \u9636\u524d\u7f00\u548c\u7684\u524d\u7f00\u548c\uff0c\u5dee\u5206\u540c\u7406\u53ef\u5f97\u3002 \n\n### \u601d\u8def\n\n\u9996\u5148\uff0c\u4f17\u6240\u5468\u77e5\u7684\u662f\uff0c\u5c06\u8981\u6c42\u524d\u7f00\u548c\u7684\u5e8f\u5217\u7684\u503c\u4f9d\u6b21\u4ee3\u5230 $F(x)$ \u7684\u7cfb\u6570\u4e2d\u53bb\uff0c\u901a\u8fc7\u4e0e $G(x)=\\sum_{i=0}^{\\infty}x^i$ \u76f8\u4e58\uff0c\u53ef\u4ee5\u5f97\u5230\u5e8f\u5217\u7684\u524d\u7f00\u548c\uff08\u6211\u4e00\u822c\u4e60\u60ef\u4ece $1$ \u5f00\u59cb\u4ee3\u5165\uff09\u3002\n\n\u5148\u4ece\u524d\u7f00\u548c\u5f00\u59cb\u8bb2\u8d77\uff1a\n\n\u8bbe $F(x)$ \u4e3a\u5f53\u524d\u5df2\u7ecf\u4ee3\u5165\u4e86\u7cfb\u6570\u7684\u591a\u9879\u5f0f\uff0c\u4e0e $G(x)$ \uff08\u610f\u4e49\u540c\u4e0a\uff09 \u76f8\u4e58\u5f97\u5230\uff1a\n\n$$F(x)\\times G(x)=F(x)\\times\\sum_{i=0}^{\\infty}x^i$$\n\n$$=F(x)\\times \\frac{1}{1-x}$$\n\n\u90a3\u4e48\u6bcf\u4e00\u9879\u7684\u7cfb\u6570\u5c31\u662f\u5e8f\u5217\u4ece $1 \u2026i$ \u7684 $1$ \u9636\u524d\u7f00\u548c\u5566\u3002\n\n\u81f3\u4e8e $k$ \u9636\u524d\u7f00\u548c\uff0c\u5373\u8981\u5bf9\u521d\u59cb\u7684\u591a\u9879\u5f0f\u505a $k$ \u6b21\u540c\u6837\u7684\u64cd\u4f5c\uff0c\u4e5f\u5c31\u662f\u4e0b\u9762\u7684\u5f0f\u5b50\u3002\n\n$$F(x)\\times (\\frac{1}{1-x})^k$$\n \n\u901a\u8fc7\u725b\u987f\u4e8c\u9879\u5f0f\u5b9a\u7406\u628a\u8fd9\u4e2a\u5f0f\u5b50\u7ed9\u62c6\u5f00\u3002\n\n$$F(x)\\times (\\frac{1}{1-x})^k=F(x)\\times (1-x)^{-k} $$\n\n$$=F(x)\\times \\sum_{i=0}^{\\infty}\\binom{-k}{i}(-x)^i$$\n\n$$=F(x)\\times \\sum_{i=0}^{\\infty}(-1)^i\\frac{\\frac{(-k)!}{(-k-i)!}}{i!}x^i$$\n\n$$=F(x)\\times \\sum_{i=0}^{\\infty}(-1)^i\\frac{(-k-i+1)(-k-i+2)(-k-i+3)\u2026(-k)}{i!}x^i$$\n\n\u5728\u8fd9\u91cc\u9700\u8981\u8bf4\u4e00\u4e0b\u7684\u662f,\u4e0a\u9762\u575f\u5893\u4e0a\uff0c\u5f53\u679a\u4e3e\u5230 $i$ \u7684\u65f6\u5019\uff0c\u4e0a\u9762\u4e00\u5171\u6709 $i$ \u4e2a\u6570\uff0c\u4e5f\u5c31\u662f\u5947\u6570\u65f6\u6709\u5947\u6570\u4e2a\uff0c\u5076\u6570\u65f6\u6709\u5076\u6570\u4e2a\uff0c\u5206\u4e24\u79cd\u60c5\u51b5\u8ba8\u8bba\u4e00\u4e0b:\n\n1\u3001\u5f53\u4e3a\u5947\u6570\u4e2a\u7684\u65f6\u5019\uff0c\u4e0a\u9762\u7684\u5f0f\u5b50\u4e00\u770b\u6bcf\u4e00\u9879\u4e00\u5b9a\u662f\u8d1f\u6570 $(k>0)$ \u7684\uff0c\u5947\u6570\u7684\u65f6\u5019\u63d0\u51fa\u5947\u6570\u4e2a\u8d1f\u53f7\u6765\uff0c\u6240\u4ee5\u4e0a\u9762\u8fd8\u5e26\u7740\u4e00\u4e2a\u8d1f\u53f7\u6ca1\u6709\u6d88\u53bb\uff0c\u800c\u6b64\u65f6\uff0c$(-1)^i=-1$  \u8d1f\u53f7\u5168\u90e8\u6d88\u6389\uff0c\u53d8\u4e3a\u6b63\u7684\u3002\n\n2\u3001\u5f53\u4e3a\u5076\u6570\u4e2a\u7684\u65f6\u5019\uff0c\u4e0a\u9762\u53ef\u4ee5\u63d0\u51fa\u5076\u6570\u4e2a\u8d1f\u53f7\u6765\uff0c\u5168\u90e8\u6d88\u6389\uff0c\u800c\u6b64\u65f6 $(-1)^i=1$ \u5ffd\u7565\u4e0d\u7ba1\u3002\n\n\u901a\u8fc7\u4e0a\u9762\u7684\u8ba8\u8bba\u53ef\u4ee5\u5f97\u5230\u7684\u662f\uff1a\n\n$$=F(x) \\times \\sum_{i=0}^{\\infty}\\frac{(k+i-1)(k+i-2)\u2026[k+i-(i-1)]k}{i!}x^i$$\n\n$$=F(x) \\times \\sum_{i=0}^{\\infty}\\frac{\\frac{(k+i-1)!}{(k+i-1-i)!}}{i!}x^i$$\n\n$$=F(x) \\times \\sum_{i=0}^{\\infty}\\binom{k+i-1}{i}x^{i}$$\n\n\u7531\u6b64\u53ef\u4ee5\u5f97\u5230\u6700\u7ec8\u5f0f\u5b50\uff0c\u7531\u4e8e $k$ \u8fc7\u5927\uff0c\u80af\u5b9a\u4e0d\u53ef\u4ee5\u76f4\u63a5\u7b97\u51fa\u6765\uff0c\u6240\u4ee5\u8981\u8003\u8651\u9012\u63a8\u6c42\u89e3\u5566\uff0c\u987a\u4fbf\u628a\u9012\u63a8\u5f0f\u6254\u5728\u4e0b\u9762\uff1a\n\n$$\\binom{k-1}{0}=1$$\n\n$$\\binom{k}{1}=\\frac{k!}{(k-1)!}=k$$\n\n$$\\binom{k+1}{2}=\\frac{(k+1)!}{2!(k-1)!}=\\frac{k(k+1)}{2}$$\n\n$$\\binom{k+2}{3}=\\frac{(k+2)!}{3!(k-1)!}=\\frac{k(k+1)(k+2)}{2\\times 3}$$\n\n\u7531\u6b64\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$\\binom{k+i-1}{i}=\\binom{k+i-2}{i-2}\\times \\frac{k+i-1}{i}$$\n\n\u5f0f\u5b50\u548c\u9012\u63a8\u5f0f\u90fd\u63a8\u51fa\u6765\u4e86\uff0c\u7334\u5b50\u5e94\u8be5\u4e5f\u4f1a\u505a\u4e86\uff0c\u4e00\u8fb9\u88f8\u7684 $\\text{NTT}$ \u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u63a5\u4e0b\u6765\u770b\u5dee\u5206\uff0c\u65e2\u7136\u524d\u7f00\u548c\u662f $\\dfrac{1}{1-x}$\uff0c\u90a3\u4e48\u5dee\u5206\u5c31\u662f $(1-x)$ \u5566\u3002\n\n\u5dee\u5206\u5176\u5b9e\u548c\u524d\u7f00\u548c\u5dee\u4e0d\u591a\uff0c\u4e0d\u8fc7\u8fd8\u662f\u6765\u8be6\u7ec6\u63a8\u5bfc\u4e00\u4e0b\u516c\u5f0f\u5427\u3002\n\n$$F(x)\\times (1-x)^k=F(x)\\times \\sum_{i=0}^{\\infty} \\binom{k}{i}(-x)^i$$\n\n$$=F(x)\\times \\sum_{i=0}^{\\infty}(-1)^i \\binom{k}{i}\\ x^i  $$\n\n\u5df2\u7ecf\u5316\u4e3a\u6700\u7b80\u5f62\u5f0f\u4e86\uff0c\u6240\u4ee5\u6700\u540e\u518d\u6254\u4e00\u4e2a\u9012\u63a8\u5f0f\u9a8c\u7b97\u8fc7\u7a0b\uff1a\n\n$$\\binom{k}{0}=1$$\n\n$$\\binom{k}{1}=\\frac{k!}{(k-1)!}=k$$\n\n$$\\binom{k}{2}=\\frac{k!}{2!(k-2)!}=\\frac{k(k-1)}{2}$$\n\n$$\\binom{k}{3}=\\frac{k!}{3!(k-3)!}=\\frac{k(k-1)(k-2)}{2\\times 3}$$\n\n$$\\binom{k}{i}=\\binom{k}{i-1}\\times \\frac{(k-i+1)}{i}$$\n\n\u6700\u540e\uff0c\u8fd9\u4e2a\u9898\u5c31\u5706\u6ee1\u7ed3\u675f\u5566\uff01\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<stack>\n#define int long long \nusing namespace std;\nconst int N=4e5+9;\nconst int mod=1004535809;\nconst int g[]={3,334845270};\nint a[N],b[N];\nint r[N];\nint term=1,l;\nint n,k,t;\nint inv[N];\nint read()//\u5feb\u8bfb\u8981\u7ecf\u8fc7\u6a21\u5904\u7406\n{\n\tint f=1,x=0;\n\tchar s=getchar();\n\twhile(s<'0'||s>'9'){if(s=='-')f=-1;s=getchar();}\n\twhile(s>='0'&&s<='9'){x=((x<<1)+(x<<3)+(s^'0'))%mod;s=getchar();}\n\treturn f*x%mod;\n}\nint quick(int x,int p)\n{\n\tint ret=1;\n\twhile(p)\n\t{\n\t\tif(p&1) ret=ret*x%mod;\n\t\tx=x*x%mod;\n\t\tp>>=1;\n\t}\n\treturn ret%mod;\n}\nvoid NTT(int *A,int type)\n{\n\tfor(int i=0;i<term;i++)\n\t\tif(i<r[i])\n\t\t\tswap(A[i],A[r[i]]);\n\tfor(int mid=1;mid<term;mid<<=1)\n\t{\n\t\tint R=mid<<1;\n\t\tint Wn=quick(g[type],(mod-1)/R);\n\t\tfor(int j=0;j<term;j+=R)\n\t\t{\n\t\t\tint w=1;\n\t\t\tfor(int k=0;k<mid;k++,w=w*Wn%mod)\n\t\t\t{\n\t\t\t\tint x=A[j+k]%mod;\n\t\t\t\tint y=w*A[j+k+mid]%mod;\n\t\t\t\tA[j+k]=(x+y)%mod;\n\t\t\t\tA[j+k+mid]=(x-y+mod)%mod;\n\t\t\t}\n\t\t}\t\n\t}\n\tif(type==1)\n\t{\n\t\tint inv=quick(term,mod-2);\n\t\tfor(int i=0;i<term;i++)\n\t\t\tA[i]=A[i]*inv%mod; \n\t}\n\treturn;\n}\nvoid less_than_break()()//\u5dee\u5206\n{\n\tb[0]=1;\n\tinv[1]=1;\n\tfor(int i=2;i<=n;i++)\n\t\tinv[i]=(mod-mod/i)*inv[mod%i]%mod;\n\tfor(int i=1;i<=n;i++)\n\t\tb[i]=-b[i-1]*(k-i+1+mod)%mod*inv[i]%mod;\n\tNTT(a,0);\n\tNTT(b,0);\n\tfor(int i=0;i<term;i++)\n\t\ta[i]=a[i]*b[i]%mod;\n\tNTT(a,1);\n\tfor(int i=1;i<=n;i++)\n\t\tprintf(\"%lld \",a[i-1]);\n}\nvoid frontsum()//\u524d\u7f00\u548c\n{\n\tb[0]=1;\n\tinv[1]=1;\n\tfor(int i=2;i<=n;i++)\n\t\tinv[i]=(mod-mod/i)*inv[mod%i]%mod;\n\tfor(int i=1;i<=n;i++)\n\t\tb[i]=b[i-1]*(k+i-1)%mod*inv[i]%mod;\n\tNTT(a,0);\n\tNTT(b,0);\n\tfor(int i=0;i<term;i++)\n\t\ta[i]=a[i]*b[i]%mod;\n\tNTT(a,1);\n\tfor(int i=1;i<=n;i++)\n\t\tprintf(\"%lld \",a[i-1]);\n}\nsigned main()\n{\n\tn=read();\n\tk=read();\n\tt=read();\n\tfor(int i=1;i<=n;i++)\n\t\ta[i-1]=read();\n\twhile(term<=2*n)\n\t{\n\t\tterm<<=1;\n\t\tl++;\n\t}\n\tfor(int i=0;i<term;i++)\n\t\tr[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\tif(t==1) less_than_break();\n\telse frontsum();\n\treturn 0;\n}\n```\n",
        "postTime": 1615123513,
        "uid": 230804,
        "name": "Durancer",
        "ccfLevel": 4,
        "title": "\u3010P5488 \u5dee\u5206\u4e0e\u524d\u7f00\u548c\u3011\u2014Monkey can\u2018t understands this solution"
    },
    {
        "content": "\u5148 % \u4e00\u6ce2\u4eba\n\n% NaCly_Fish \u603b\u662f\u51fa\u6bd2\u7624\u6a21\u677f\uff08\u4e0d\u8fc7\u8fd9\u9053\u9898\u633a\u826f\u5fc3\u7684\uff09\n\n% iostream \u76ee\u524d rk1\n\n% AThousandMoon 5 \u5206\u949f\u7801\u5b8c\n\n---\n\u53c8\u6709\u65b0\u6a21\u677f\u4e86\u5462\u3002\n\n\u4e0d\u8fc7\u8fd9\u4e1c\u897f\u4e3a\u4ec0\u4e48\u8981\u53eb\u6a21\u677f\u2026\u2026\n\n\u6ce8\u610f\uff0c\u6211\u611f\u89c9\u6211\u63a8\u7684\u6bd4\u8f83\u81c3\u80bf\uff0c\u53ef\u4ee5\u770b\u522b\u7684\u795e\u4ed9\u7684\u9898\u89e3\uff0c\u6bd5\u7adf\u6211\u662f\u83dc\u9e21\u2026\u2026\n\n---\n\u5148\u770b\u524d\u7f00\u548c\u90e8\u5206\u3002\n\n\u8003\u8651 $j$ \u5bf9 $i$ \u7684\u8d21\u732e\u7cfb\u6570\uff0c\u53ef\u4ee5\u7406\u89e3\u6210\u7b2c\u4e00\u6b21\u524d\u7f00\u548c\u65f6 $j$ \u5bf9 $p_1$ \u6709\u8d21\u732e\uff0c\u7b2c\u4e8c\u6b21\u524d\u7f00\u548c\u65f6 $p_1$ \u5bf9 $p_2$ \u6709\u8d21\u732e\u2026\u2026\u7b2c $k$ \u6b21\u524d\u7f00\u548c\u65f6 $p_{k-1}$ \u5bf9 $i$ \u6709\u8d21\u732e\u3002\n\n\u90a3\u4e48\u5c31\u662f\u6c42\u957f\u5ea6\u4e3a $k-1$ \u7684\u5e8f\u5217 $p$ \u4f7f\u5f97 $j\\le p_1\\le p_2\\le\\dots\\le p_{k-1}\\le i$\uff0c\u6c42\u4e2a\u6570\u3002\n\n\u6839\u636e~~\u5c0f\u5b66\u5965\u6570~~\u9694\u677f\u6cd5\u53ef\u5f97 $\\binom{i-j+k-1}{k-1}$\u3002\n\n\u90a3\u4e48\u6709\uff1a\uff08\u8fd9\u91cc\u6211\u8ba9\u4e0b\u6807\u4ece $0$ \u5f00\u59cb\uff09\n$$b_i=\\sum\\limits_{j=0}^ia_j\\binom{i-j+k-1}{k-1}$$\n$$b_i=\\frac{1}{(k-1)!}\\sum\\limits_{j=0}^ia_j\\frac{(i-j+k-1)!}{(i-j)!}$$\n\n\u540e\u9762\u5377\u79ef\u4e00\u6ce2\u5e26\u8d70\u3002\n\n---\n\u5dee\u5206\u4e5f\u5f88\u7b80\u5355\u3002\n\n\u8003\u8651 $j$ \u5bf9 $i$ \u7684\u8d21\u732e\u7cfb\u6570\uff0c\u4e5f\u5c31\u662f $0$ \u5bf9 $i-j$ \u7684\u8d21\u732e\u7cfb\u6570\u3002\u6211\u5c31\u76f4\u63a5\u5199\u9012\u63a8\u5f0f\u4e86\uff1a\n\n$f_{i,j}$ \u8868\u793a $i$ \u9636\u5dee\u5206\u65f6 $0$ \u5bf9 $j$ \u7684\u8d21\u732e\u7cfb\u6570\u3002\n\n$$f_{i,j}=f_{i-1,j}-f_{i-1,j-1}$$\n\n\u770b\u5230\u8fd9\u4e2a\u5f0f\u5b50\u5f88\u5bb9\u6613\uff08\u771f\u7684\u5f88\u5bb9\u6613\uff09\u60f3\u5230\u4ee4 $g_{i,j}=(-1)^jf_{i,j}$\u3002\n\n$$(-1)^jg_{i,j}=(-1)^jg_{i-1,j}-(-1)^{j-1}g_{i-1,j-1}$$\n\n$$g_{i,j}=g_{i-1,j}+g_{i-1,j-1}=\\binom{i}{j}$$\n\n\u6240\u4ee5\u6709 $f_{i,j}=(-1)^j\\binom{i}{j}$\u3002\n\n\uff08\u7406\u89e3\u4e0d\u4e86\u4e0a\u9762\u7684\u5f0f\u5b50\u7684\uff0c\u53ef\u4ee5\u7ec4\u5408\u610f\u4e49\u6765\u7406\u89e3\u3002\u4ece\u5de6\u4e0a\u89d2\u5f00\u59cb\u8d70\uff0c\u6bcf\u6b21\u53ef\u4ee5\u5f80\u4e0b\u6216\u5f80\u53f3\u4e0b\u8d70\uff0c\u5f80\u4e0b\u7684\u8d21\u732e\u7cfb\u6570\u4e0d\u53d8\uff0c\u5f80\u53f3\u4e0b\u7684\u8d21\u732e\u7cfb\u6570\u53d6\u76f8\u53cd\u6570\u3002\u95ee\u8d70\u5230 $(i,j)$ \u7684\u8d21\u732e\u7cfb\u6570\u3002\u5982\u679c\u6ca1\u6709\u53d6\u76f8\u53cd\u6570\uff0c\u5927\u5bb6\u90fd\u77e5\u9053\u662f $\\binom{i}{j}$\u3002\u56e0\u4e3a\u80af\u5b9a\u6070\u597d\u5f80\u53f3\u4e0b\u8d70\u4e86 $j$ \u6b21\uff0c\u6240\u4ee5\u5c31\u662f $(-1)^j\\binom{i}{j}$\u3002\uff09\n\n\u6240\u4ee5\u6709\uff1a\n$$b_i=\\sum\\limits_{j=0}^ia_jf_{k,i-j}$$\n$$b_i=\\sum\\limits_{j=0}^ia_j(-1)^{i-j}\\binom{k}{i-j}$$\n$$b_i=(-1)^ik!\\sum\\limits_{j=0}^ia_j(-1)^j\\frac{1}{(i-j)!(k-(i-j))!}$$\n\n\u540e\u9762\u8fd8\u662f\u4e00\u4e2a\u5377\u79ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u662f $O(n\\log n)$\u3002\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int maxn=333333,mod=1004535809;\n#define FOR(i,a,b) for(int i=(a);i<=(b);i++)\n#define ROF(i,a,b) for(int i=(a);i>=(b);i--)\n#define MEM(x,v) memset(x,v,sizeof(x))\ninline int read(){\n    int x=0,f=0;char ch=getchar();\n    while(ch<'0' || ch>'9') f|=ch=='-',ch=getchar();\n    while(ch>='0' && ch<='9') x=x*10+ch-'0',ch=getchar();\n    return f?-x:x;\n}\nint n,tp,k,a[maxn],lim,l,rev[maxn],b[maxn],fac[maxn],invfac[maxn];\ninline int add(int a,int b){return a+b<mod?a+b:a+b-mod;}\ninline int sub(int a,int b){return a<b?a-b+mod:a-b;}\ninline int mul(int a,int b){return 1ll*a*b%mod;}\ninline int qpow(int a,int b){\n\tint ans=1;\n\tfor(;b;b>>=1,a=mul(a,a)) if(b&1) ans=mul(ans,a);\n\treturn ans;\n}\nvoid init(int upr){\n\tfor(lim=1,l=0;lim<upr;lim<<=1,l++);\n\tFOR(i,0,lim-1) rev[i]=(rev[i>>1]>>1)|((i&1)<<(l-1)); \n}\nvoid NTT(int *A,int tp){\n\tFOR(i,0,lim-1) if(i<rev[i]) swap(A[i],A[rev[i]]);\n\tfor(int i=1;i<lim;i<<=1)\n\t\tfor(int j=0,r=i<<1,Wn=qpow(3,mod-1+tp*(mod-1)/r);j<lim;j+=r)\n\t\t\tfor(int k=0,w=1;k<i;k++,w=mul(w,Wn)){\n\t\t\t\tint x=A[j+k],y=mul(A[i+j+k],w);\n\t\t\t\tA[j+k]=add(x,y);A[i+j+k]=sub(x,y);\n\t\t\t}\n\tif(tp==-1){\n\t\tint linv=qpow(lim,mod-2);\n\t\tFOR(i,0,lim-1) A[i]=mul(A[i],linv);\n\t}\n}\nnamespace DIF{\n\tvoid solve(){\n\t\tFOR(i,0,n-1) if(i&1) a[i]=(mod-a[i])%mod;\n\t\tFOR(i,0,k) b[i]=mul(invfac[i],invfac[k-i]);\n\t\tinit(n<<1);\n\t\tNTT(a,1);NTT(b,1);\n\t\tFOR(i,0,lim-1) a[i]=mul(a[i],b[i]);\n\t\tNTT(a,-1);\n\t\tFOR(i,0,n-1){\n\t\t\tint prod=mul(fac[k],a[i]);\n\t\t\tif(i&1) prod=(mod-prod)%mod;\n\t\t\tprintf(\"%d \",prod);\n\t\t} \n\t}\n}\nnamespace PRE{\n\tvoid solve(){\n\t\tFOR(i,0,n-1) b[i]=mul(fac[i+k-1],invfac[i]);\n\t\tinit(n<<1);\n\t\tNTT(a,1);NTT(b,1);\n\t\tFOR(i,0,lim-1) a[i]=mul(a[i],b[i]);\n\t\tNTT(a,-1);\n\t\tFOR(i,0,n-1) printf(\"%d \",mul(a[i],invfac[k-1]));\n\t}\n}\nint main(){\n\tn=read();k=read();tp=read();\n\tFOR(i,0,n-1) a[i]=read();\n\tfac[0]=1;\n\tFOR(i,1,n+k) fac[i]=mul(fac[i-1],i);\n\tinvfac[n+k]=qpow(fac[n+k],mod-2);\n\tROF(i,n+k-1,0) invfac[i]=mul(invfac[i+1],i+1);\n\tif(tp) DIF::solve();\n\telse PRE::solve();\n}\n```",
        "postTime": 1564722982,
        "uid": 72118,
        "name": "AThousandSuns",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5488 \u3010\u3010\u6a21\u677f\u3011\u5dee\u5206\u4e0e\u524d\u7f00\u548c\u3011"
    },
    {
        "content": "\u4ee5\u540e\u4e00\u5b9a\u5f00\u8b66\u544a\u3002\n\n\u8003\u8651\u5229\u7528\u751f\u6210\u51fd\u6570\uff0c\u9996\u5148\u5c06 $\\text F$ \u5199\u6210\u751f\u6210\u51fd\u6570\u7684\u5f62\u5f0f\uff1a\n\n$F(x) = \\sum_{i = 0}^{+\\infty}a_ix ^ i$\n\n\u63a5\u7740\u8003\u8651\u5982\u4f55\u5f97\u5230\u4e00\u9636\u524d\u7f00\u548c\uff0c\u663e\u7136\u5c31\u662f\u8ba9 $F(x)$ \u5377\u4e0a $G(x) = \\sum_{i = 0} ^{+\\infty}x^i = \\frac{1}{1 - x}$\u3002\n\n\u800c\u7531\u4e8e\u5dee\u5206\u548c\u524d\u7f00\u548c\u4e3a\u9006\u8fd0\u7b97\u6240\u4ee5\u5dee\u5206\u7684\u751f\u6210\u51fd\u6570\u5c31\u662f $G'(x) = 1 - x$\u3002\n\n\u7531\u4e8e\u51e0\u9636\u5c31\u662f\u6eda\u51e0\u6b21\u524d\u7f00\u548c/\u5dee\u5206\uff0c\u6240\u4ee5\u6211\u4eec\u6700\u540e\u5f97\u5230\u7684\u4e24\u4e2a\u751f\u6210\u51fd\u6570\u5c31\u662f $\\frac{1}{(1 - x) ^ k}$ \u4ee5\u53ca $(1 - x) ^ k$\u3002\n\n\u5c06 $\\frac{1}{(1 - x) ^ k}$ \u5199\u6210 $(1 - x) ^ {-k}$\uff0c\u6839\u636e\u5e7f\u4e49\u4e8c\u9879\u5f0f\u5b9a\u7406\u76f4\u63a5\u5c55\u5f00\u4e24\u4e2a\u751f\u6210\u51fd\u6570\uff1a\n\n$(1 - x) ^ k = \\sum_{i = 0} ^ {+\\infty} (-1) ^ iC_k^ix^i$\n\n\u7531\u4e8e\u53ea\u6c42\u5e8f\u5217\u524d $n$ \u9879\u524d\u7f00\u548c\uff0c\u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u9012\u63a8 $(-1)^iC_k^i$ \u9012\u63a8\u5230\u7b2c $n$\n\u9879\u5373\u53ef\u3002\n\n$(1 - x) ^ {-k} = \\sum_{i = 0} ^ {+\\infty} (-1)^iC_{-k}^ix^i = \\sum_{i = 0} ^ {+\\infty}(-1)^i\\frac{(-k)^{\\underline i}}{i!}x^i = \\sum_{i=0} ^ {+\\infty} (-1)^{2i}\\frac{(k + i - 1)^{\\underline i}}{i!}x^i$\n\n\u53d1\u73b0\u4ecd\u7136\u53ef\u4ee5\u9012\u63a8\u5f97\u5230\u7cfb\u6570\u3002\n\n\u6700\u540e\u5c06\u7cfb\u6570\u591a\u9879\u5f0f\u4e0e\u539f\u5e8f\u5217\u5bf9\u5e94\u7684\u591a\u9879\u5f0f\u5377\u5728\u4e00\u8d77\u5373\u53ef\u3002\n\n",
        "postTime": 1657528162,
        "uid": 132533,
        "name": "Hakuoro",
        "ccfLevel": 0,
        "title": "\u65b0\u964d\u7684\u751f\u547d\u662f\u65e0\u7f6a\u7684"
    },
    {
        "content": "### \u524d\u7f6e\u77e5\u8bc6\n\n1.\u751f\u6210\u51fd\u6570\u3002\n\n2.\u5e7f\u4e49\u4e8c\u9879\u5f0f\u5b9a\u7406\uff1a$(1-x)^a=\\sum\\limits_{i=0}^{\\infty}\\dbinom{a}{i}x^i$\u3002\n\n3.\u5feb\u901f\u6570\u8bba\u53d8\u6362\uff0c$NTT$\u3002\n\n\n\n(1)\u524d\u7f00\u548c\u3002\n\n\u8bbe\u539f\u5e8f\u5217\u7684\u666e\u901a\u751f\u6210\u51fd\u6570\u4e3a $F(x)=\\sum\\limits_{i=0}^\\infty a_ix^i$\u3002\n\n\u5bf9\u539f\u5e8f\u5217\u8fdb\u884c\u4e00\u6b21\u524d\u7f00\u548c,\u8bbe $p_k=\\sum\\limits_{i=0}^ka_i$\uff0c\u5176\u4e2d $a_0=0$\u3002\n\n\u628a$p_k$\u53d8\u6362\u4e3a\u5377\u79ef\u7684\u5f62\u5f0f\uff1a $p_k=\\sum\\limits_{i=0}^k a_ib_{k-i}$\u3002\n\n\u5bf9\u6bd4\u539f\u5f0f\u53ef\u4ee5\u53d1\u73b0\uff0c$b_i$ \u4e3a\u4efb\u610f\u4e00\u9879\u90fd\u662f $1$ \u7684\u591a\u9879\u5f0f,\u5219 $b$ \u7684\u751f\u6210\u51fd\u6570\u4e3a $G(x)=\\sum\\limits_{i=0}^\\infty x^i$\u3002\n\n\u8f6c\u6362\u4e3a\u5c01\u95ed\u5f62\u5f0f:\u5de6\u53f3\u4e24\u8fb9\u540c\u65f6\u4e58 $x$\uff0c\u5f97\u5230 $x\\times G(x)=\\sum\\limits_{i=1}^\\infty x^i$\u3002\n\n\u52a0\u5165 $x^0$\uff0c\u5f97\u5230: $x\\times G(x)=\\sum\\limits_{i=0}^\\infty x^i-1=G(x)-1$\u3002\n\n$x\\times G(x)=G(x)-1,1=(1-x)\\times G(x)$\u3002\n\n\u4ece\u800c $G(x)=\\frac1{1-x}$\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u6b21\u524d\u7f00\u548c,\u90fd\u76f8\u5f53\u4e8e\u4e0e $\\frac1{1-x}$ \u8fdb\u884c\u5377\u79ef,\u5219 $k$ \u6b21\u76f8\u5f53\u4e8e\u4e0e $\\frac{1}{(1-x)^k}$ \u8fdb\u884c\u5377\u79ef\u3002\n\n\u7b54\u6848\u4e3a $F \u00d7 \\frac1{(1-x)^k}=F\u00d7(1-x)^{-k}$\u3002\n\n\u6b64\u65f6\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 exp \u89e3\u51b3,\u7136\u800c\u4ee3\u7801\u5197\u957f,\u5e38\u6570\u5de8\u5927\u3002\n\n\u8003\u8651\u7528\u5e7f\u4e49\u4e8c\u9879\u5f0f\u5b9a\u7406\u5316\u7b80\uff1a$(1-x)^{-k}=\\sum\\limits_{i=0}^\\infty(-1)^i\\dbinom{-k}{i}x^i$\n\n$=\\sum\\limits_{i=0}^\\infty(-1)^{2i}\\dbinom{k+i-1}{i}x^i$\n\n$=\\sum\\limits_{i=0}^\\infty\\dbinom{k+i-1}{i}x^i$\n\n\u53ef\u4ee5\u9012\u63a8\u9884\u5904\u7406\uff1a$\\dbinom{k-1}{0}=1,\\dbinom{k+i-2}{i-1}\u00d7\\frac{k+i-1}{i}=\\dbinom{k-i+1}{i}$\u3002\n\n\n(2)\u5dee\u5206\u3002\n\n\u7531\u4e8e\u5dee\u5206\u4e0e\u524d\u7f00\u548c\u7684\u7279\u6b8a\u5173\u7cfb,\u5dee\u5206\u7684\u751f\u6210\u51fd\u6570\u662f $(1-x)^k$\u3002\n\n\u4f7f\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\u5c55\u5f00: $(1-x)^k=\\sum\\limits_{i=0}^k\\dbinom{k}{i}(-1)^ix^i$\u3002\n\u540c\u6837\u9012\u63a8\u9884\u5904\u7406: $\\dbinom{k}{i}=\\dbinom{k}{i-1}*\\frac{n-i+1}{i}$\u3002\n\n\u8fd8\u6709\u6700\u540e\u4e00\u4e2a\u95ee\u9898\uff0c$k\\le10^{2333}$\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u77e5\u9053,\u5f53 $k\u22610(\\bmod p),\\dbinom{k}{x}\u22610(\\bmod p)$\u3002\n\n\u4e3a\u5565?\u7531\u7ec4\u5408\u6570\u7684\u5b9a\u4e49\u5f0f\u53ef\u4ee5\u77e5\u9053\uff0c$\\dbinom{k}{x}=\\frac{k!}{x!(k-x)!}=k!\u00d7(x!(k-x)!)^{-1},\u2235k\u22610\\pmod{p},\u2234k!\u22610\\pmod{p}$\uff0c\u4ece\u800c $\\dbinom{k}{x}\u22610(mod\\ p)$\u3002\n\n\u53ef\u4ee5\u505a\u51fa\u8d21\u732e\u7684\u53ea\u6709 $\\dbinom{k \\bmod p}{x}$\u3002\n\n\u6211\u4eec\u7528\u5feb\u8bfb\u7684\u601d\u60f3,\u8fb9\u8bfb\u8fb9\u6a21,\u5c31\u53ef\u4ee5\u89e3\u51b3\u95ee\u9898\u4e86\u3002\n\n\u4ee3\u7801\u5982\u4e0b:\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nconst int P=1004535809,G=3,Gi=334845270;\ninline int qpow(int a,int b){\n\tint ans=1;\n\twhile(b){\n\t\tif(b&1) ans=1ll*ans*a%P;\n\t\ta=1ll*a*a%P;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\ninline int read(){\n\tint s=0;\n\tbool f=1;\n\tstatic char ch=getchar();\n\twhile(ch<'0'||ch>'9'){\n\t\tif(ch=='-') f=-1;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0'&&ch<='9'){\n\t\ts=(s<<3)+(s<<1)+(ch^48);\n\t\tch=getchar();\n\t}\n\treturn f==1?s:-s;\n}\ninline int mod_read(){\n\tint s=0;\n\tbool f=1;\n\tstatic char ch=getchar();\n\twhile(ch<'0'||ch>'9'){\n\t\tif(ch=='-') f=-1;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0'&&ch<='9'){\n\t\ts=(s<<3)+(s<<1)+(ch^48);\n\t\ts%=P;\n\t\tch=getchar();\n\t}\n\treturn f==1?s:-s;\n}\nint Lim=1,L=0;\nint inv[1<<18],rev[1<<18];\ninline void init(int n){\n\twhile(Lim<=(n<<1)) Lim<<=1,++L;\n\tfor(int i=1;i<Lim;i++) rev[i]=(rev[i>>1]>>1)|((i&1)<<(L-1));\n\tinv[1]=1;\n\tfor(int i=2;i<=n;i++) inv[i]=1ll*(P-P/i)*inv[P%i]%P;\n}\ninline void NTT(int *A,int Lim,int on){\n\tfor(int i=0;i<Lim;i++)\n\t\tif(i<rev[i]) swap(A[i],A[rev[i]]);\n\tfor(int h=1;h<Lim;h<<=1){\n\t\tint wn=qpow(on==1?G:Gi,(P-1)/(h<<1));\n\t\tfor(int j=0;j<Lim;j+=(h<<1)){\n\t\t\tint w=1;\n\t\t\tfor(int k=0;k<h;k++){\n\t\t\t\tint x=A[j|k],y=w*A[j|k|h]%P;\n\t\t\t\tA[j|k]=(x+y)%P;\n\t\t\t\tA[j|k|h]=(x-y+P)%P;\n\t\t\t\tw=w*wn%P;\n\t\t\t}\n\t\t}\n\t}\n\tif(on==-1){\n\t\tint inv=qpow(Lim,P-2);\n\t\tfor(int i=0;i<Lim;i++) A[i]=A[i]*inv%P;\n\t}\n}\nint A[1<<18],B[1<<18];\nsigned main(){\n\tint n,k,type;\n\tn=read(),k=mod_read(),type=read();\n\tinit(n);\n\tfor(int i=0;i<n;i++) A[i]=read();\n\tB[0]=1;\n\tif(type==0)\n\t\tfor(int i=1;i<=n;i++) B[i]=B[i-1]*(k+i-1)%P*inv[i]%P;\n\telse for(int i=1;i<=n;i++) B[i]=(-B[i-1]*(k-i+1+P)%P*inv[i]%P+P)%P;\n\tNTT(A,Lim,1);NTT(B,Lim,1);\n\tfor(int i=0;i<Lim;i++) A[i]=A[i]*B[i]%P;\n\tNTT(A,Lim,-1);\n\tfor(int i=0;i<n;i++) printf(\"%lld \",A[i]);\n\treturn 0;\n} \n\n```\n\n~~\u849f\u84bb\u7b2c\u4e00\u6b21\u5199\u9898\u89e3,\u6c42\u901a\u8fc7~~",
        "postTime": 1651495845,
        "uid": 430283,
        "name": "W123789",
        "ccfLevel": 0,
        "title": "P5488\u9898\u89e3"
    },
    {
        "content": "\uff08\u591a\u9879\u5f0f\u597d\u9898\uff09\n\n\u6211\u4eec\u5047\u8bbe\u539f\u6570\u5217\u6709\u65e0\u7a77\u591a\u9879\uff08\u4e0b\u6807\u4ece $0$ \u5f00\u59cb\uff09\uff0c\u4e3a\n\n$a_0,a_1,a_2,a_3,  \\cdots ,a_n \\cdots$\n\n\u6784\u9020\u4e00\u4e2a\u591a\u9879\u5f0f\n\n$A(x) = a_0+a_1x+a_2x^2+ \\cdots+a_nx^n+ \\cdots$\n\n\u518d\u6784\u9020\u4e00\u4e2a\u5173\u4e8e\u524d\u7f00\u548c\u7684\u591a\u9879\u5f0f      \n$f(x) = sum_0+sum_1x+sum_2x^2+ \\cdots +sum_nx^n+ \\cdots$\n\n\u5176\u4e2d    $sum_i = \\sum_{j=0}^{k} a_j$ \uff08\u5c31\u662f\u524d\u7f00\u548c\uff09\n\n\u5c1d\u8bd5\u7528  $A(x)$  \u6c42  $f(x)$ \uff0c\u6211\u4eec\u5148\u628a $f(x)$ \u4e58\u4e0a $x$ \uff0c\u7136\u540e\u518d\u9519\u4f4d\u76f8\u51cf\n\n$xf(x) =sum_0x+sum_1x^2+sum_2x^3+\\cdots +sum_nx^{n+1}+\\cdots$\n\n\u7136\u540e\u9519\u4f4d\u76f8\u51cf\u4fbf\u53ef\u4ee5\u5f97\u5230\t\t\t\uff08$sum_i - sum_{i-1} = a_i$\uff09:\n\n$f(x) - xf(x) = A(x)$\n\n\n\n\u7565\u89e3\u4e00\u4e0b\u4fbf\u53ef\u4ee5\u5f97\u5230\uff1a\n\n $f(x)=\\frac{A(x)}{1-x}$\n\n $1$  \u9636\u524d\u7f00\u548c\u5c31\u662f  $\\frac{A(x)}{1-x}$\uff0c$k$ \u9636\u524d\u7f00\u548c\u53ea\u8981\u8fed\u4ee3\u4e0b\u53bb\uff0c\u5c31\u5f88\u5bb9\u6613\u5f97\u5230    $\\frac{A(x)}{(1-x)^k}$\n\n\u5269\u4e0b\u7684\u5c31\u662f  $NTT$ \t\u5feb\u901f\u5e42\uff0c\u9006\u5143\uff0c\u4e58\u6cd5\u7684\u677f\u5b50\u4e86\n\n\u540c\u6837\u7684\u65b9\u6cd5\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u5173\u4e8e\u5dee\u5206\u7684\u591a\u9879\u5f0f\n$g(x) = d_0+d_1x+d_2x^2+\\cdots +d_nx^n+\\cdots$\n\n\u5176\u4e2d\t$d_0=a_0,d_i = a_i-a_{i-1}$\n\n\u7a0d\u5fae\u4e0d\u4e00\u6837\u7684\u65b9\u6cd5\u9519\u4f4d\u76f8\u51cf\uff0c\u6211\u4eec\u628a\t$A(x)$\t \u4e58\u4e0a \t$x$ \t\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\n\n$xA(x)= a_0x+a_1x^2+a_2x^3+\\cdots+a_nx^{n+1}+\\cdots$\n\n$A(x) - xA(x) = g(x)$\n\n$g(x)=A(x) \\cdot (1-x)$\n\n\u4e00\u9636\u5dee\u5206\u5c31\u662f\t\n\n$g(x)=A(x) \\cdot (1-x)$\t\uff0c\n\n\u8fed\u4ee3\u4e0b\u53bb\u5c31\u53ef\u4ee5\u5f97\u5230 $k$ \u9636\u5dee\u5206\u5c31\u662f \t\n\n$g(x)=A(x) \\cdot (1-x)^k$\n\n\u8fd9\u6b21\u5c31\u4e0d\u7528\u6c42\u9006\u5143\u4e86\n\n\u4ee3\u7801\u7684\u8bdd\u4e24\u767e\u591a\u884c\uff0c\u653e\u4e2a\u94fe\u63a5\u5427\uff08\u4e0d\u5f00  O2 \u4f1a T  \uff0c\u4f46\u73b0\u5728\u6bd4\u8d5b\u5e94\u8be5\u4f1a\u5f00   O2  \u5427\uff09\n[https://www.luogu.com.cn/paste/tecgwa4x](https://www.luogu.com.cn/paste/tecgwa4x)\n\n",
        "postTime": 1658210043,
        "uid": 210138,
        "name": "zhanxianyun",
        "ccfLevel": 6,
        "title": "P5488"
    },
    {
        "content": "## Tag\n\n\u591a\u9879\u5f0f\uff0c\u751f\u6210\u51fd\u6570\u3002\n\n## Preface\n\n\u8fd9\u91cc\u662f $\\exp$ \u7684\u66b4\u529b\u505a\u6cd5\u89e3\u91ca\uff0c\u4e0d\u5f00 $\\text{O2}$ \u4f1a T \u98de\u3002\n\n## Description\n\n\u6c42\u51fa\u4e00\u4e2a\u6570\u5217 $\\{a_n\\}$ \u7684 $k$ \u7ef4\u524d\u7f00\u548c\u6216\u8005\u5dee\u5206\u3002\n\n## Solution\n\n\u5bf9\u4e8e\u524d\u7f00\u548c\u6211\u4eec\u5f88\u5bb9\u6613\u5c31\u53ef\u4ee5\u77e5\u9053\u524d\u7f00\u548c\u7684\u751f\u6210\u51fd\u6570\u662f\n\n$$\nF(x)=\\dfrac{1}{1-x}=\\sum_{i=0}^\\infty x^i\n$$\n\n\u5dee\u5206\u7684\u751f\u6210\u51fd\u6570\u5c31\u662f\n\n$$\nG(x)=1-x\n$$\n\n\u90a3\u4e48\u6211\u4eec\u501f\u7528\u4e00\u4e0b\u77e9\u9635\u5feb\u901f\u5e42\u7684\u60f3\u6cd5\uff0c\u662f\u4e0d\u662f\u8bf4\u5c06\u8fd9\u4e2a\u524d\u7f00\u548c\u6216\u8005\u5dee\u5206\u7684\u751f\u6210\u51fd\u6570 $k$ \u6b21\u65b9\uff0c\u7136\u540e\u76f4\u63a5\u4e58\u4e0a\u539f\u6570\u5217\u5c31\u53ef\u4ee5\u5f97\u5230\u7b54\u6848\u4e86\u3002\n\n\u5177\u4f53\u4e00\u70b9\uff0c\u6211\u4eec\u8bbe\u539f\u5e8f\u5217\u7684\u751f\u6210\u51fd\u6570\u4e3a\n\n$$\nH(x)=\\sum_{i=0}^na_ix^i\n$$\n\n\u90a3\u4e48\u7b54\u6848\u7684\u751f\u6210\u51fd\u6570\u5c31\u662f\n\n$$\nA(x)=H(x)\\times F(x)^k\n$$\n\n\u6216\u8005\n\n$$\nA(x)=H(x)\\times G(x)^k\n$$\n\n\u90a3\u4e48\u6839\u636e\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u7684\u505a\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u5148 $\\ln$\uff0c\u7136\u540e\u6bcf\u4e2a\u6570\u4e58\u4e0a $k$\uff0c\u6700\u540e $\\exp$ \u56de\u53bb\uff0c\u5c31\u505a\u5b8c\u4e86\u3002\n\n$$\nA(x)=H(x)\\exp(k\\ln F(x))\n$$\n\n\u6240\u4ee5\u4ee3\u7801\u5f02\u5e38\u7684\u66b4\u529b\uff0c\u867d\u7136\u590d\u6742\u5ea6\u662f $O(n\\lg n)$ \u7684\uff0c\u4f46\u662f\u7531\u4e8e $\\exp$ \u7684\u5e38\u6570\u5de8\u5927\uff0c\u5bfc\u81f4\u8dd1\u7684\u5f02\u5e38\u6162\uff0c\u4e0d\u8fc7\u7531\u4e8e\u6211\u662f `vector` \u5b9e\u73b0\u7684\uff0c\u6240\u4ee5\u5f00\u4e86 $\\text{O2}$ \u4e4b\u540e\u5e38\u6570\u5c31\u5c0f\u4e86\u4e00\u4e9b\u3002~~\u4e0d\u8fc7\u8fd8\u662f\u8d85\u7ea7\u6162\u554a~~\u3002\n\n## Code\n~~~cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define int long long\n\n#define FOR(i,a,b) for(int i=(a),i##i=(b);i<=i##i;i++)\n#define ROF(i,a,b) for(int i=(a),i##i=(b);i>=i##i;i--)\n\nconst int N = 5e5 + 1;\nconst int mod = 1004535809, g = 3;\n\n#define gc (p1==p2&&(p2=(p1=buf)+fread(buf,1,100000,stdin),p1==p2)?EOF:*p1++)\nchar buf[100000], *p1(buf), *p2(buf);\n#define rd read()\ninline int read() {\n    int x = 0, f = 1;\n    char ch = gc;\n    while(!isdigit(ch)) {\n        if(ch == '-') f = 0;\n        ch = gc;\n    }\n    while(isdigit(ch)) {\n        x = ((x << 1) + (x << 3) + (ch ^ 48)) % mod;\n        ch = gc;\n    }\n    return f ? x : -x;\n}\n\ntypedef vector<int> poly;\n\ninline int ksm(int x, int y) {\n    int ret = 1;\n    for(; y; y >>= 1, x = x * x % mod)\n        if(y & 1) ret = ret * x % mod;\n    return ret;\n}\n\npoly NTT(poly F, int typ) {\n    int n = F.size();\n    vector<int> rev(n);\n    FOR(i, 1, n - 1) rev[i] = rev[i >> 1] >> 1 | ((i & 1) ? n >> 1 : 0);\n    FOR(i, 0, n - 1) if(i < rev[i]) swap(F[i], F[rev[i]]);\n    for(int i = 1; i < n; i <<= 1) {\n        int gn = ksm(g, (mod - 1) / (i << 1));\n        for(int j = 0, g0 = 1, x, y; j < n; j += (i << 1), g0 = 1)\n        for(int k = 0; k < i; k++, g0 = gn * g0 % mod) {\n            x = F[j + k], y = F[i + j + k] * g0 % mod;\n            F[j + k] = (x + y) % mod;\n            F[i + j + k] = (x - y + mod) % mod;\n        }\n    }\n    if(typ == 1) return F;\n    int inv = ksm(n, mod - 2); reverse(F.begin() + 1, F.end());\n    for(int i = 0; i < n; i++) F[i] = F[i] * inv % mod;\n    return F;\n}\n\npoly MUL(poly F, poly G) {\n    int n = F.size(), m = G.size();\n    int len = 1; while(len < (n + m) - 1) len <<= 1;\n    F.resize(len), G.resize(len);\n    F = NTT(F, 1), G = NTT(G, 1);\n    FOR(i, 0, len - 1) F[i] = G[i] * F[i] % mod;\n    F = NTT(F, 0), F.resize(n + m);\n    return F;\n}\n\npoly INV(poly F) {\n    int n = F.size();\n    if(n == 1) return {ksm(F[0], mod - 2)};\n    poly G = INV(poly(F.begin(), F.begin() + (n + 1) / 2));\n    int len = 1; while(len < (n << 1) - 1) len <<= 1;\n    F.resize(len), G.resize(len);\n    F = NTT(F, 1), G = NTT(G, 1);\n    FOR(i, 0, len - 1) F[i] = (2 - F[i] * G[i] % mod + mod) % mod * G[i] % mod;\n    F = NTT(F, 0), F.resize(n);\n    return F;\n}\n\npoly DI(poly F) {\n    int n = F.size();\n    FOR(i, 1, n - 1) F[i - 1] = F[i] * i % mod;\n    F.resize(n - 1); return F;\n}\n\npoly IG(poly F) {\n    int n = F.size();\n    F.resize(n + 1);\n    ROF(i, n, 1) F[i] = F[i - 1] * ksm(i, mod - 2) % mod;\n    F[0] = 0; return F;\n}\n\npoly LN(poly F) {\n    int n = F.size(); poly G = INV(F); F = DI(F);\n    F = IG( MUL(F, G) );\n    F.resize(n); return F;\n}\n\npoly EXP(poly F) {\n    int n = F.size();\n    if(n == 1) return {1};\n    poly G = EXP(poly(F.begin(), F.begin() + (n + 1) / 2));\n    G.resize(n); poly H = LN(G);\n    int len = 1; while(len < (n << 1) - 1) len <<= 1;\n    F.resize(len), G.resize(len), H.resize(len);\n    F = NTT(F, 1), G = NTT(G, 1), H = NTT(H, 1);\n    FOR(i, 0, len - 1) F[i] = (1 + F[i] - H[i] + mod) % mod * G[i] % mod;\n    F = NTT(F, 0), F.resize(n);\n    return F;\n}\n\nint n, k, t;\n\ninline void solve() {\n    n = rd, k = rd, t = rd;\n    poly F(n), G(n);\n    for(int i = 0; i < n; i++) F[i] = rd;\n    G[0] = 1, G[1] = mod - 1, G = LN(G);\n    for(int i = 0; i < n; i++) G[i] = G[i] * k % mod;\n    G = EXP(G);\n    if(t == 0) G = INV(G);\n    F = MUL(F, G);\n    for(int i = 0; i < n; i++) cout << F[i] << ' ';\n    return ;\n}\n\n#undef int \n\n#define local freopen(\"in.txt\",\"r\",stdin);freopen(\"out.txt\",\"w\",stdout)\n\nint main() {\n#ifdef LOCAL\n    local;\n#endif\n    solve();\n    return 0;\n}\n~~~\n\n## Final\n\n\u6b63\u597d\u5b89\u5229\u4e00\u4e0b\u591a\u9879\u5f0f\u7684 `vector` \u5199\u6cd5\uff0c\u6e05\u7a7a\u4e0d\u9ebb\u70e6\uff0c\u5199\u8d77\u6765\u4e5f\u6ca1\u6709\u4ec0\u4e48\u969c\u788d\uff0c\u975e\u5e38\u7684\u8212\u670d\uff01",
        "postTime": 1631702774,
        "uid": 366935,
        "name": "KAMIYA_KINA",
        "ccfLevel": 7,
        "title": "P5488 \u5dee\u5206\u4e0e\u524d\u7f00\u548c \u9898\u89e3"
    },
    {
        "content": "### \u5206\u6790\uff1a\n\u8003\u8651\u5e8f\u5217 $A$  \u7684 OGF \uff0c $F=\\sum\\limits_{i=0}^{\\infty} a_ix^i$ \u3002\n\n\u5148\u8003\u8651 $k=1$ \u7684\u60c5\u51b5\u3002\n\n\u5bf9\u4e8e\u6c42\u524d\u7f00\u548c\uff0c\u53ef\u4ee5\u76f4\u63a5\u5c06 $F$ \u4e58\u4e0a $G=\\sum\\limits_{i=0}^{\\infty}x_i$ \u3002\u6839\u636e $G$ \u7684\u6027\u8d28\uff0c\u5217\u51fa\u65b9\u7a0b\uff1a $G-x\\cdot G= 1$ \u3002\u89e3\u4e4b\uff0c\u6613\u5f97 $G=\\frac{1}{1-x}$ \u3002\n\n\u5bf9\u4e8e\u6c42\u5dee\u5206\uff0c\u53ef\u4ee5\u76f4\u63a5\u6c42\u51fa $F$ \u4e0e $1-x$ \u7684\u5377\u79ef\u3002\n\n\u8003\u8651 $k > 1$ \u7684\u60c5\u51b5\u3002\n\n\u5bf9\u4e8e\u6c42\u524d\u7f00\u548c\uff0c\u53ef\u4ee5\u5c06 $F$ \u4e58\u4e0a $G^k$ \uff08\u6709\u70b9\u50cf\u77e9\u9635\u5feb\u901f\u5e42\uff09\u3002\n\u4f46\u8fd9\u6837\u4ee3\u7801\u4f1a\u975e\u5e38\u96be\u5199\uff0c\u6240\u4ee5\u8003\u8651\u4f7f\u7528\u5e7f\u4e49\u4e8c\u9879\u5f0f\u5b9a\u7406\uff0c$G^k=(1-x)^{-k}=\\sum\\limits_{i=0}^{\\infty}{{i+k-1}\\choose i}x^i$\u3002\n\n\u5bf9\u4e8e\u6c42\u5dee\u5206\uff0c\u4f7f\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\uff0c$G^k=(1-x)^k=\\sum\\limits_{i=0}^{\\infty}(-1)^i {k \\choose i}x^i$\u3002\n\n### \u5177\u4f53\u5b9e\u73b0\uff1a\n\u7531\u4e8e $k$ \u7684\u8303\u56f4\u5f88\u5927\uff0c\u8f93\u5165\u90fd\u662f\u4e2a\u95ee\u9898\uff0c\u8fd9\u91cc\u53ef\u4ee5\u6839\u636e Lucas \u5b9a\u7406\u5728\u8f93\u5165\u7684\u65f6\u5019\u5bf9 k \u8fdb\u884c\u53d6\u6a21\u3002\n\n\u56e0\u4e3a\u8be5\u9898\u6240\u7528\u5230\u7684\u7ec4\u5408\u6570\u6709\u4e00\u5b9a\u7684\u89c4\u5f8b\uff0c\u6240\u4ee5\u8003\u8651\u9012\u63a8\u3002(\u8fd9\u91cc\u53ef\u4ee5\u5148\u7ebf\u6027\u9884\u5904\u7406\u51fa\u9006\u5143\u3002)\n\n\u524d\u7f00\u548c\uff1a\n\n${i+k-1 \\choose i}=\\frac{i+k-1!}{i!k-1!}=\\frac{i+k-2!}{i-1!k-1!}\\cdot \\frac{i+k-1}{i}={i+k-2\\choose i-1}\\cdot \\frac{i+k-1}{i}$\n\n\u5dee\u5206:   \n\n${k \\choose i}=\\frac{k!}{i!k-i!}=\\frac{k!}{i-1!k-i+1!}\\cdot \\frac{k-i+1}{i}={k\\choose i-1}\\cdot \\frac{k-i+1}{i}$\n\n\u8ba1\u7b97\u5377\u79ef:\n\n\u7531\u4e8e\u8fd9\u9898\u5bf9\u7cbe\u5ea6\u8981\u6c42\u8f83\u5927\uff0c\u8ba1\u7b97\u5377\u79ef\u65f6\u5e94\u4f7f\u7528 NTT \u8fdb\u884c\u8ba1\u7b97\uff0c FFT \u5927\u6982\u7387\u4f1a\u88ab\u5361\u3002\n### Code\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define N (int)(3e5+1)\n#define M 5001\n#define R register\n#define x first\n#define y second\n#define g 3\n#define ig 334845270\n#define ll long long\n#define db double\n#define mp make_pair\n#define pb push_back\n#define pi pair<int,int>\n#define lb(x) (x&-x)\n#define mod 1004535809\n#define wt(x) write(x),puts(\"\")\n#define ot(x) write(x),putchar(' ')\n#define INF 0x7fffffff\n#define F(i,start,end) for(R int (i)=(start);(i)<=(end);i++)\n#define T(i,end,start) for(R int (i)=(start);(i)>=(end);i--)\nusing namespace std;\ntemplate<typename T> void read(T &x)\n{\n\tint f=1;\n\tx=0;\n\tchar c=getchar();\n\twhile(!isdigit(c))\n\t{\n\t\tif(c=='-')\n\t\t\tf=-1;\n\t\tc=getchar();\n\t}\n\twhile(isdigit(c))\n\t{\n\t\tx=((x<<3)%mod+(x<<1)%mod+c-'0')%mod;\n\t\tc=getchar();\n\t}\n\tx*=f;\n\treturn;\n}\nvoid write(R ll x)\n{\n\tif(x<0)\n\t{\n\t\tx=~x+1;\n\t\tputchar('-');\n \t}\n\tif(x>9)\n\t\twrite(x/10);\n\tputchar(x%10+'0');\n\treturn;\n}\nint n,lim=1,bit,rev[N];\nll k,a[N],b[N],inv[N];\nbool f;\nll power(ll x,int y)\n{\n\tll ret=1;\n\tfor(;y;y>>=1,x=x*x%mod)\n\t\t(ret*=y&1?x:1)%=mod;\n\treturn ret;\n}\nvoid init()\n{\n\tfor(;lim<n<<1;lim<<=1,bit++);\n\tF(i,0,lim)\n\t\trev[i]=rev[i>>1]>>1|(i&1)<<bit-1;\n\tinv[1]=1;\n\tF(i,2,lim)\n\t\tinv[i]=inv[mod%i]*(mod-mod/i)%mod;\n\treturn;\n}\nvoid ntt(ll a[],bool fg)\n{\n\tF(i,0,lim-1)\n\t\tif(i<rev[i])\n\t\t\tswap(a[i],a[rev[i]]);\n\tfor(int mid=1;mid<lim;mid<<=1)\n\t{\n\t\tll size=mid<<1,wn=power(fg?ig:g,(mod-1)/size);\n\t\tfor(int j=0;j<lim;j+=size)\n\t\t{\n\t\t\tll w=1;\n\t\t\tfor(int k=0;k<mid;k++,w=w*wn%mod)\n\t\t\t{\n\t\t\t\tll a0=a[j+k],a1=a[j+k+mid]*w%mod;\n\t\t\t\ta[j+k]=(a0+a1)%mod,a[j+k+mid]=(a0-a1+mod)%mod;\n\t\t\t}\n\t\t}\n\t}\n\treturn;\n}\nint main()\n{\n\tread(n),read(k),read(f);\n\tinit();\n\tF(i,0,n-1)\n\t\tread(a[i]);\n\tb[0]=1;\n\tif(f)\n\t{\n\t\tF(i,1,n-1)\n\t\t\tb[i]=b[i-1]*(k-i+1+mod)%mod*inv[i]%mod;\n\t\tfor(int i=1;i<n;i+=2)\n\t\t\tb[i]=mod-b[i];\n\t}\n\telse\n\t\tF(i,1,n-1)\n\t\t\tb[i]=b[i-1]*(k+i-1)%mod*inv[i]%mod;\n\tntt(a,0),ntt(b,0);\n\tF(i,0,lim-1)\n\t\ta[i]=a[i]*b[i]%mod;\n\tntt(a,1);\n\tF(i,0,n-1)\n\t\tot(a[i]*inv[lim]%mod);\n\treturn 0;\n}\n```\n",
        "postTime": 1627475759,
        "uid": 219402,
        "name": "FANTASTlC",
        "ccfLevel": 0,
        "title": "\u9898\u89e3P5488"
    },
    {
        "content": "\u8bbe\u5e8f\u5217 $a$ \u7684\u666e\u901a\u751f\u6210\u51fd\u6570 $f(x)$ \u4e3a $\\sum\\limits^{\\infty}_{n=0}a_nx^n$\uff0c$g(x)=\\sum\\limits^\\infty_{n=0}b_nx^n$ \u662f\u53e6\u4e00\u4e2a\u65b0\u7684\u6570\u5217 $\\{b_n\\}^\\infty_{n=0}$ \u7684\u751f\u6210\u51fd\u6570\u3002\n\n## \u524d\u7f00\u548c\n\n\u9996\u5148\u5199\u51fa\u524d\u7f00\u548c\u7684\u8ba1\u7b97\u65b9\u6cd5\uff1a$sum_i=\\sum\\limits_{k=1}^ia_k$\u3002\n\n\u719f\u77e5 $f(x)g(x)$ \u662f\u6570\u5217 $\\left\\{\\sum\\limits^n_{k=0}a_kb_{n-k}\\right\\}_{n=0}^\\infty$ \u7684\u751f\u6210\u51fd\u6570 **\uff08\u6027\u8d281\uff09** \u3002\n\n\u5f53 $b$ \u7684\u6bcf\u4e00\u9879 $b_i$ \u90fd\u7b49\u4e8e $1$ \u65f6\uff0c$\\dfrac{f(x)}{1-x}$ \u5373\u4e3a\u5176\u4e00\u9636\u524d\u7f00\u548c\u3002\n\n\u540c\u7406\uff0c\u4e8c\u9636\u524d\u7f00\u548c\u662f\u5728\u4e00\u9636\u524d\u7f00\u548c\u7684\u57fa\u7840\u4e0a\u5f97\u5230\u7684\uff0c$k$ \u9636\u524d\u7f00\u548c\u662f\u5728 $k-1$ \u9636\u524d\u7f00\u548c\u7684\u57fa\u7840\u4e0a\u5f97\u5230\u7684\uff0c\u6211\u4eec\u7528 $\\dfrac{1}{1-x}$ \u4e0d\u65ad\u76f8\u4e58\u5373\u53ef\u3002\n\n\u6240\u4ee5 $k$ \u9636\u524d\u7f00\u548c\u5373\u4e3a $f\\times\\dfrac{1}{(1-x)^k}$\u3002\n\n\u6839\u636e\u4e0a\u6587\u6027\u8d281\uff0c$\\dfrac{1}{(1-x)^k}$ \u5373\u4e3a $\\left\\{\\sum\\limits_{n_1+n_2+\\dots+n_k=n}1\\right\\}_{n=0}^\\infty$ \u7684OGF\u3002\n\n\u8003\u8651\u7ec4\u5408\u610f\u4e49\uff0c\u5373 $\\left\\{\\dbinom{n+k-1}{n}\\right\\}_{n=0}^\\infty$ \u7684OGF\u3002\n\n\u9012\u63a8\u7ec4\u5408\u6570\uff1a\n\n$\\dbinom{i+k-1}{i}=\\dbinom{i+k-2}{i-1}\\dfrac{k+i-1}{i}$\n\n\u7136\u540e\u8ddf $f$ NTT\u5377\u4e00\u4e0b\u5c31\u53ef\u4ee5\u3002\n\n## \u4efb\u52a12\uff1a\u5dee\u5206\n\n\u9996\u5148\u5199\u51fa\u5dee\u5206\u7684\u8ba1\u7b97\u65b9\u6cd5\uff1a$dif_i=a_i-a_{i-1}$\u3002\n\n\u4f9d\u7136\u8003\u8651\u6027\u8d281\uff0c\u5982\u679c $b_0=1,b_1=-1,b_i=0\\;(i>1)$\u3002\n\n\u6b64\u65f6 $f\\times g=\\sum\\limits_{n=0}^\\infty\\left(\\sum\\limits^n_{k=0}a_kb_{n-k}\\right)x^n=\\sum\\limits_{n=0}^\\infty(a_n-a_{n-1})x^n$\u3002\n\n\u663e\u7136\u6211\u4eec\u4f9d\u7136\u80fd\u5c06\u5dee\u5206\u6570\u7ec4\u7684\u8ba1\u7b97\u65b9\u6cd5\u5199\u6210\u751f\u6210\u51fd\u6570\u76f8\u4e58\u7684\u5f62\u5f0f\u3002\n\n\u6b64\u65f6\u6570\u5217 $b$ \u5373\u4e3a $1-x$\u3002\n\n\u6240\u4ee5 $k$ \u9636\u5dee\u5206\u5373\u4e3a $f\\times(1-x)^k$\u3002\n\n\u5bf9\u4e8e $(1-x)^k$ \u76f4\u63a5\u4e8c\u9879\u5f0f\u5b9a\u7406\u62c6\u5f00\u3002\n\n$(1-x)^k$ \u7684\u6bcf\u9879\u7cfb\u6570\u662f $\\sum\\limits_{i=0}^k(-1)^i\\dbinom{k}{i}$\n\n\u9012\u63a8\u7ec4\u5408\u6570\uff1a\n\n$\\dbinom{k}{i}=\\dbinom{k}{i-1}\\dfrac{k-i+1}{i}$\n\n\u7136\u540e\u62ff $f$ NTT\u5377\u4e00\u4e0b\u5c31\u53ef\u4ee5\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<queue>\n#define N 1000001\n#define INF 1100000000\n#define Kafuu return\n#define Chino 0\n#define fx(l,n) inline l n\n#define set(l,n,ty,len) memset(l,n,sizeof(ty)*len)\n#define cpy(f,t,ty,len) memcpy(t,f,sizeof(ty)*len)\n#define R register int\n#define int long long\nusing namespace std;\nconst int mod=1004535809,pr=3;\nint n,k,t,ori[N],invp,invx,x=1,br[N],prp[N],binom[N],T[N];\nfx(int,gi)(){\n\tchar C=getchar();long long n=0,f=1;\n\twhile(C<'0'||C>'9'){\n\t\tif(C=='-') f=-f;\n\t\tC=getchar();\n\t}\n\twhile(C>='0'&&C<='9') ((n*=10)+=C-'0')%=mod,C=getchar();\n\treturn (n*f)%mod;\n}\nfx(int,pow)(int a,int b=mod-2){\n\tint sum=1;\n\twhile(b){\n\t\tif(b&1) (sum*=a)%=mod;\n\t\t(a*=a)%=mod;\n\t\tb>>=1;\n\t}\n\treturn sum;\n}\nfx(void,NTT)(int *f,short r){\n\tR len,hl,exp,uni,st,i;\n\tfor(i=0;i<x;i++) if(i<br[i]) swap(f[i],f[br[i]]);\n\tfor(len=2,hl=1;len<=x;hl=len,len<<=1){\n\t\texp=pow(r==1?pr:invp,(mod-1)/len);\n\t\tfor(i=1;i<hl;i++) prp[i]=prp[i-1]*exp%mod;\n\t\tfor(st=0;st<x;st+=len){\n\t\t\tfor(i=0;i<hl;i++){\n\t\t\t\tuni=prp[i]*f[i|st|hl]%mod;\n\t\t\t\tf[i|st|hl]=(f[i|st]-uni+mod)%mod;\n\t\t\t\tf[i|st]=(f[i|st]+uni)%mod;\n\t\t\t}\n\t\t}\n\t}\n}\nsigned main(){\n\tn=gi(),k=gi(),t=gi();\n\tfor(R i=0;i<n;i++) T[i]=ori[i]=gi();\n\twhile(x<=n+n) x<<=1;\n\tfor(R i=0;i<x;i++) br[i]=(br[i>>1]>>1)|((i&1)?x>>1:0);\n\tinvx=pow(x);invp=pow(pr);binom[0]=1;\n\tif(!t) for(int i=1;i<=n;i++) binom[i]=binom[i-1]*(k+i-1)%mod*pow(i)%mod;\n\telse for(int i=1;i<=n;i++) binom[i]=-binom[i-1]*(k-i+1)%mod*pow(i)%mod;\n\tprp[0]=1;NTT(ori,1);NTT(binom,1);\n\tfor(int i=0;i<x;i++) (ori[i]*=binom[i])%=mod;\n\tNTT(ori,-1);\n\tfor(int i=0;i<n;i++) cout<<ori[i]*invx%mod<<\" \";\n\tKafuu Chino;\n}\n```",
        "postTime": 1613739668,
        "uid": 215573,
        "name": "zythonc",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5488 \u3010\u5dee\u5206\u4e0e\u524d\u7f00\u548c\u3011"
    },
    {
        "content": "\u524d\u7f6e\u829d\u58eb\u70b9\uff1a\n- NTT\uff08\u5feb\u901f\u6570\u8bba\u53d8\u6362\uff09\n\n\u5e0c\u671b\u5404\u4f4d\u795e\u4ed9\u4e0d\u8981\u56e0\u4e3a\u6211\u6ca1\u5199\u524d\u7f6e\u829d\u58eb\u70b9\uff0c\u5c31\u76f4\u63a5\u8bf4\u4ec0\u4e48TNT\uff0c\u4e0d\u77e5\u9053\u7684\u829d\u58eb\u70b9\u53ef\u4ee5\u4e0a\u7f51\u67e5\u767e\u5ea6\uff0c\u6c42\u653e\u8fc7\u849f\u84bb!............\n\n---\n\n\u6253\u8868+\u627e\u89c4\u5f8b+\u6570\u5b66\u5f52\u7eb3\u6cd5\u53ef\u4ee5\u8bc1\u660e\n\n\u5bf9\u4e8e$k$\u9636\u524d\u7f00\u548c\n$$b_i=\\sum_{j=0}^{i-1}\\binom{j+k-1}{k-1}a_{i-j}$$\n\u5bf9\u4e8e$k$\u9636\u5dee\u5206\n$$b_i=\\sum_{j=0}^{k}(-1)^j\\binom{k}{j}a_{i-j}$$\n\u4f7f\u7528NTT\u4f18\u5316\u8ba1\u7b97\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\log n)$\n\n```cpp\n#include<bits/stdc++.h>\n#define Rint register int\nusing namespace std;\ntypedef long long LL;\nconst int N = 1 << 18, mod = 1004535809, G = 3, Gi = 334845270;\nint n, k, t, a[N], b[N], fac[N], inv[N];\ninline int kasumi(int a, int b){\n\tint res = 1;\n\twhile(b){\n\t\tif(b & 1) res = (LL) res * a % mod;\n\t\ta = (LL) a * a % mod;\n\t\tb >>= 1;\n\t}\n\treturn res;\n}\ninline void init(int m){\n\tfac[0] = 1;\n\tfor(Rint i = 1;i <= m;i ++) fac[i] = (LL) i * fac[i - 1] % mod;\n\tinv[m] = kasumi(fac[m], mod - 2);\n\tfor(Rint i = m;i;i --) inv[i - 1] = (LL) inv[i] * i % mod;\n}\nint rev[N];\ninline int calrev(int len){\n\tint limit = 1, L = -1;\n\twhile(limit <= len){limit <<= 1; L ++;}\n\tfor(Rint i = 0;i < limit;i ++)\n\t\trev[i] = (rev[i >> 1] >> 1) | ((i & 1) << L);\n\treturn limit;\n}\ninline int sub(int x, int y){int z = x - y; if(z < 0) z += mod; return z;}\ninline int add(int x, int y){int z = x + y; if(z >= mod) z -= mod; return z;}\ninline void NTT(int *A, int limit, int type){\n\tfor(Rint i = 0;i < limit;i ++)\n\t\tif(i < rev[i]) swap(A[i], A[rev[i]]);\n\tfor(Rint mid = 1;mid < limit;mid <<= 1){\n\t\tint Wn = kasumi(type == 1 ? G : Gi, (mod - 1) / (mid << 1));\n\t\tfor(Rint j = 0;j < limit;j += mid << 1){\n\t\t\tint w = 1;\n\t\t\tfor(Rint k = 0;k < mid;k ++, w = (LL) w * Wn % mod){\n\t\t\t\tint x = A[j + k], y = (LL) A[j + k + mid] * w % mod;\n\t\t\t\tA[j + k] = add(x, y); A[j + k + mid] = sub(x, y);\n\t\t\t}\n\t\t}\n\t}\n\tif(type == -1){\n\t\tint inv = kasumi(limit, mod - 2);\n\t\tfor(Rint i = 0;i < limit;i ++)\n\t\t\tA[i] = (LL) A[i] * inv % mod;\n\t}\n}\nint main(){\n\tscanf(\"%d%d%d\", &n, &k, &t);\n\tfor(Rint i = 1;i <= n;i ++) scanf(\"%d\", a + i);\n\tif(!t){\n\t\tinit(n + k);\n\t\tfor(Rint i = 0;i <= n;i ++) b[i] = (LL) fac[i + k - 1] * inv[i] % mod * inv[k - 1] % mod;\n\t\tint limit = calrev(n << 1 | 1);\n\t\tNTT(a, limit, 1); NTT(b, limit, 1);\n\t\tfor(Rint i = 0;i < limit;i ++) a[i] = (LL) a[i] * b[i] % mod;\n\t\tNTT(a, limit, -1);\n\t\tfor(Rint i = 1;i <= n;i ++) printf(\"%d \", a[i]);\n\t} else {\n\t\tinit(k);\n\t\tfor(Rint i = 0;i <= k;i ++){\n\t\t\tb[i] = (LL) fac[k] * inv[i] % mod * inv[k - i] % mod;\n\t\t\tif(i & 1) b[i] = mod - b[i];\n\t\t}\n\t\tint limit = calrev(n + k + 1);\n\t\tNTT(a, limit, 1); NTT(b, limit, 1);\n\t\tfor(Rint i = 0;i < limit;i ++) a[i] = (LL) a[i] * b[i] % mod;\n\t\tNTT(a, limit, -1);\n\t\tfor(Rint i = 1;i <= n;i ++) printf(\"%d \", a[i]);\n\t}\n}\n```",
        "postTime": 1564718781,
        "uid": 68148,
        "name": "watermoon",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5488 \u3010\u3010\u6a21\u677f\u3011\u5dee\u5206\u4e0e\u524d\u7f00\u548c\u3011"
    },
    {
        "content": "### \u9898\u76ee\u63cf\u8ff0\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u4e3a $n$ \u7684\u5e8f\u5217 $a$\uff0c\u6c42\u51fa\u5176 $k$ \u9636\u5dee\u5206\u6216\u524d\u7f00\u548c\uff0c\u6bcf\u4e00\u9879\u5bf9 $1004535809$ \u53d6\u6a21\n\n\u6570\u636e\u8303\u56f4 $1\\leq n\\leq 10^5$ \uff0c $0\\leq a_i\\leq 10^9$ \uff0c $1\\leq k\\leq 10^{2333}$ \uff0c $k\\not\\equiv 0$ $(mod$ $1004535809)$\n\n### \u524d\u7f6e\u829d\u58eb\n\u591a\u9879\u5f0f\u5feb\u901f\u5e42\n\n### solution\n\n1.\u524d\u7f00\u548c\n\n\u5df2\u7ecf\u77e5\u9053\u539f\u59cb\u6570\u7ec4\u5176\u5b9e\u5c31\u662f\u4e00\u9636\u524d\u7f00\u548c\u3002\n\n\u8bbe\u539f\u59cb\u6570\u7ec4\u4e3a $f(x)$ \u3002\n\n\u90a3\u4e48\u5982\u679c\u518d\u8bbe\u4e00\u4e2a\u51fd\u6570\uff1a\n\n$g(x)=\\sum_{i=0}^{n}x^i$\n\n\u751f\u6210\u51fd\u6570\u91cc\uff0c $g$ \u5c31\u662f\u90a3\u4e2a\u7684 $\\large\\frac{1}{1-x}$ \u3002\n\n\u5982\u679c\u8981\u8fbe\u5230 $a_i\\Longrightarrow \\sum_{id<i} a_{id}$ \n\n\u90a3\u4e48 $f$ \u5377 $k$ \u6b21 $g$ \u5377\u8d77\u6765\u5c31\u662f $k$ \u9636\u524d\u7f00\u548c\u5566\u3002\n\n2.\u5dee\u5206\n\n\u5176\u5b9e\u6253\u6253\u8868\u4f1a\u53d1\u73b0\uff1a\u4e58 $k$ \u6b21 $(1-x)$ \u5c31\u884c\u4e86\n\n\u8bed\u6587\u592a\u5dee\u5f62\u5bb9\u4e0d\u6765\u3002\u3002\u3002\n\n\u5269\u4e0b\u7684\u4ea4\u7ed9\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u5427\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N=4e5+10;\ntypedef ll arr[N];\nconst int mod=1004535809;\nconst int inv3=334845270;\nint n,k,ty,inv[N],lim=1,fre,id[N],T[N];\narr a,f,g,h,ans,tmp,ln;\ninline ll inc(ll x,ll y){return x+y>=mod?x+y-mod:x+y;}\ninline ll dec(ll x,ll y){return x-y<0?x-y+mod:x-y;}\ninline ll mul(ll x,ll y){return 1ll*x*y%mod;}\ninline int read()\n{\n\tint s=0,w=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9') s=s*10+ch-'0',ch=getchar();\n\treturn s*w;\n}\ninline int ksm(int a,int b)\n{\n\tint tmp=1;\n\twhile(b)\n\t{\n\t\tif(b&1)tmp=(1ll*tmp*a)%mod;\n\t\tb>>=1,a=(1ll*a*a)%mod;\n\t}\n\treturn tmp;\n}\ninline void Never_Tell_TLE(ll* NTT,int sign)\n{\n\tfor(int i=0;i<=lim;++i)if(i<id[i])\n\t{\n\t\tll NTt=NTT[i];\n\t\tNTT[i]=NTT[id[i]];\n\t\tNTT[id[i]]=NTt;\n\t}\n\tfor(int mid=1;mid<lim;mid<<=1)\n\t{\n\t\tint Unit_root;\n\t\tif(sign==1)Unit_root=ksm(3,(mod-1)/(mid<<1));\n\t\telse Unit_root=ksm(inv3,(mod-1)/(mid<<1));\n\t\tfor(int R=mid<<1,r=0;r<lim;r+=R)\n\t\t{\n\t\t\tint pw=1;\n\t\t\tfor(int l=0;l<mid;++l,pw=(1ll*pw*Unit_root)%mod)\n\t\t\t{\n\t\t\t\tint butt=NTT[l+r],rfly=(1ll*pw*NTT[l+r+mid])%mod;\n\t\t\t\tNTT[l+r]=inc(butt,rfly);\n\t\t\t\tNTT[l+r+mid]=dec(butt,rfly);\n\t\t\t}\n\t\t}\n\t}\n\tif(sign==-1)\n\t{\n\t\tint inv_lim=ksm(lim,mod-2);\n\t\tfor(int i=0;i<=lim;++i)NTT[i]=mul(NTT[i],inv_lim);\n\t}\n}\ninline void Derivation(ll* F,ll* G,int nm)\n{\n\tfor(int i=1;i<nm;++i)\n\tG[i-1]=mul(1ll*i,F[i]);\n\tG[nm-1]=0;\n}\ninline void Inv(ll* F,ll* G,int nm)\n{\n\tif(nm==1)\n\t{\n\t\tG[0]=ksm(F[0],mod-2);\n\t\treturn;\n\t}\n\tInv(F,G,(nm+1)>>1);\n\tlim=1,fre=0;\n\tfor(;lim<(nm<<1);lim<<=1)++fre;\n\tfor(int i=0;i<=lim;++i)id[i]=(id[i>>1]>>1)|((i&1)<<(fre-1));\n\tfor(int i=0;i<nm;++i)ans[i]=F[i];\n\tfor(int i=nm;i<=lim;++i)ans[i]=0;\n\tNever_Tell_TLE(ans,1),Never_Tell_TLE(G,1);\n\tfor(int i=0;i<=lim;++i)G[i]=mul(inc(2ll,-mul(ans[i],G[i])+mod),G[i]);\n\tNever_Tell_TLE(G,-1);\n\tfor(int i=nm;i<=lim;++i)G[i]=0;\n}\ninline void Mul(ll* F,ll* G,int nm)\n{\n\tlim=1,fre=0;\n\tfor(;lim<(nm<<1);lim<<=1)++fre;\n\tfor(int i=0;i<=lim;++i)id[i]=(id[i>>1]>>1)|((i&1)<<(fre-1));\n\tint inv_lim=ksm(lim,mod-2);\n\tNever_Tell_TLE(G,1),Never_Tell_TLE(F,1);\n\tfor(int i=0;i<=lim;++i)G[i]=mul(F[i],G[i]);\n\tNever_Tell_TLE(G,-1);\n}\ninline void Integral(ll* F,ll* G,int nm)\n{\n\tfor(int i=1;i<nm;++i)\n\tG[i]=mul(F[i-1],inv[i]);\n\tG[0]=0;\n}\ninline void Ln(ll* F,ll* G,int nm)\n{\n\tInv(F,tmp,nm);\n\tfor(int i=0;i<=lim;++i)ans[i]=0;\n\tDerivation(F,ans,nm);\n\tMul(tmp,ans,nm);\n\tIntegral(ans,G,nm);\n\tfor(int i=0;i<=lim;++i)ans[i]=tmp[i]=0;\n}\ninline void solve(ll* F,ll* G,int nm)\n{\n\tif(nm==1)\n\t{\n\t\tG[0]=1;\n\t\treturn;\n\t}\n\tsolve(F,G,(nm+1)>>1);\n\tlim=1,fre=0;\n\tfor(;lim<(nm<<1);lim<<=1)++fre;\n\tfor(int i=0;i<=lim;++i)id[i]=(id[i>>1]>>1)|((i&1)<<(fre-1));\n\tfor(int i=0;i<=lim;++i)ln[i]=0;\n\tLn(G,ln,nm);\n\tfor(int i=0;i<nm;++i)ans[i]=F[i];\n\tfor(int i=nm;i<=lim;++i)ans[i]=0;\n\tNever_Tell_TLE(ans,1),Never_Tell_TLE(G,1),Never_Tell_TLE(ln,1);\n\tfor(int i=0;i<=lim;++i)G[i]=mul(inc(1ll,inc(ans[i],-ln[i]+mod)),G[i]);\n\tNever_Tell_TLE(G,-1);\n\tfor(int i=nm;i<=lim;++i)G[i]=0;\n}\ninline void pre()\n{\n\tinv[1]=1;\n\tfor(int i=2;i<=n;++i)inv[i]=(-(ll)(mod/i)*inv[mod%i]%mod+mod)%mod;\n}\nint main()\n{\n\tn=read();pre();\n\tint c=getchar();while(isspace(c))c=getchar();\n\tfor(;isdigit(c);c=getchar())k=(k*10LL+(c^'0'))%mod;\n\tty=read();\n\tfor(int i=0;i<n;++i)a[i]=read();\n\tf[0]=1,f[1]=-1+mod;\n\tLn(f,g,n);\n\tfor(int i=0;i<=lim;++i)g[i]=mul(g[i],k),f[i]=0;\n\tsolve(g,f,n);\n\tif(ty)memcpy(h,f,sizeof(h));\n\telse Inv(f,h,n);\n\tlim=1,fre=0;\n\tfor(;lim<(n<<1);lim<<=1)++fre;\n\tfor(int i=0;i<=lim;++i)id[i]=(id[i>>1]>>1)|((i&1)<<(fre-1));\n\tNever_Tell_TLE(a,1),Never_Tell_TLE(h,1);\n\tfor(int i=0;i<=lim;++i)h[i]=mul(a[i],h[i]);\n\tNever_Tell_TLE(h,-1);\n\tfor(int i=0;i<n;++i)printf(\"%d \",h[i]);\n\tgetchar();\n\treturn 0;\n}\n```\n\u53ea\u6c42\u80fd\u5e2e\u52a9\u5230\u51e0\u4e2a\u4eba\u7f62\u3002\u3002",
        "postTime": 1617544879,
        "uid": 206024,
        "name": "Illusory_dimes",
        "ccfLevel": 7,
        "title": "P5488 \u5dee\u5206\u4e0e\u524d\u7f00\u548c \u9898\u89e3"
    },
    {
        "content": "[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/P5488)\n\n\u9898\u76ee\u63cf\u8ff0\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u957f\u4e3a $n$ \u7684\u5e8f\u5217 $a$\uff0c\u6c42\u5b83\u7684 $k$ \u9636\u5dee\u5206\u6216\u524d\u7f00\u548c\u3002\u5bf9 $1004535809$ \u53d6\u6a21\u3002\n\n$1\\le n\\le10^5$\n\n$0\\le a_i\\le10^9$\n\n$1\\le k\\le10^{2333},k\\not\\equiv0\\pmod{1004535809}$\n\n\u591a\u9879\u5f0f\u57fa\u7840\u5e94\u7528\u677f\u5b50\u9898\u3002\n\n\u4e00\u770b $1004535808=2^{21}\\times479$ \u53d1\u73b0\u662f\u4e2a $\\text{NTT}$ \u6a21\u6570\uff0c\u518d\u4e00\u770b\u9898\u9762\uff0c\u53d1\u73b0\u662f\u4e2a\u591a\u9879\u5f0f\u677f\u5b50\u9898\u3002\n\n\u9996\u5148\uff0c\u8bbe\u591a\u9879\u5f0f $F(x)=\\sum\\limits_{i=1}^na_ix^i$\u3002\n\n\u7136\u540e\uff0c\u5b9a\u4e49\u5e73\u79fb\u7b97\u5b50 $[x^n]\\operatorname{E}f=[x^{n-1}]f$\u3002\n\n\u5219\u5dee\u5206\u7b97\u5b50 $[x^n]\\Delta f=[x^n]f-[x^{n-1}]f=[x^n]f-[x^n]\\operatorname{E}f$\uff0c\n\n\u53ef\u4ee5\u63a8\u51fa $\\Delta=1-\\operatorname{E}$\uff0c\u6545 $\\Delta^k=(1-\\operatorname{E})^k$\u3002\n\n\u7136\u540e\u53d1\u73b0\u5728\u591a\u9879\u5f0f\u610f\u4e49\u4e0b $\\operatorname{E}$ \u5c31\u662f\u4e58\u4ee5 $x$\uff0c\u6545 $\\Delta^k=(1-x)^k$\uff0c\u5373 $[x^n]\\Delta^kF=[x^n](1-x)^kF$\u3002\n\n\u800c\u524d\u7f00\u548c\u7b97\u5b50 $\\Sigma=\\Delta^{-1}$\uff0c\u6545 $\\Sigma^k=\\Delta^{-k}$\uff0c\u5373 $[x^n]\\Sigma^kF=[x^n](1-x)^{-k}F$\u3002\n\n\u5982\u679c\u60a8\u4e0d\u4f1a\u591a\u9879\u5f0f\u4e58\u6cd5\uff0c\u5efa\u8bae\u60a8\u5148\u53bb\u5b66\u5b66\u3002\n\n\u5982\u679c\u60a8\u4f1a\u591a\u9879\u5f0f\u5feb\u901f\u5e42\uff0c\u76f4\u63a5\u6c42 $(1-x)^k$ \u6216 $(1-x)^{-k}$ \u518d\u628a\u5b83\u548c $F$ \u5377\u8d77\u6765\u5c31\u884c\u4e86\u3002\n\n\u5426\u5219\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u9012\u63a8\u6c42\u51fa $(1-x)^k$ \u6216 $(1-x)^{-k}$ \u7684\u7cfb\u6570\u3002\n\n\u6839\u636e\u725b\u987f\u4e8c\u9879\u5f0f\u5b9a\u7406\uff0c\n\n$(1-x)^k=\\sum\\limits_{i\\ge0}\\dbinom ki(-1)^ix^i$\n\n$=\\sum\\limits_{i\\ge0}\\dfrac{k^{\\underline i}}{i!}(-1)^ix^i$\n\n$=\\sum\\limits_{i\\ge0}-\\dfrac{k-i+1}{i}\\times\\dfrac{k^{\\underline {i-1}}}{(i-1)!}(-1)^{i-1}x^i$\n\n\u6545\u5982\u679c\u8bbe $(1-x)^k=\\sum\\limits_{i\\ge0}b_ix^i$\uff0c\u5219\u6709 $b_i=-\\dfrac{k-i+1}{i}b_{i-1}$\u3002\n\n\u7c7b\u4f3c\u7684\uff0c\u5982\u679c\u8bbe $(1-x)^{-k}=\\sum\\limits_{i\\ge0}c_ix^i$\uff0c\u5219\u6709 $c_i=-\\dfrac{-k-i+1}{i}c_{i-1}$\u3002\n\n\u540c\u6837\uff0c\u9012\u63a8\u6c42\u51fa $(1-x)^k$ \u6216 $(1-x)^{-k}$ \u7684\u7cfb\u6570\u540e\u518d\u628a\u5b83\u548c $F$ \u5377\u8d77\u6765\u5c31\u884c\u4e86\u3002\n\n\u6700\u540e\u4e00\u4e2a\u5c0f\u95ee\u9898\uff0c\u7531\u4e8e $k$ \u7279\u522b\u5927\uff08$10^{2333}$ \u7ea7\u522b\uff09\uff0c\u6240\u4ee5\u8981\u8fb9\u8f93\u5165\u8fb9\u53d6\u6a21\u3002\u6a21 $1004535809$ \u800c\u4e0d\u662f $1004535808$ \u662f\u56e0\u4e3a $(1-x)^{1004535808}\\equiv1(\\bmod\\ 1004535809)$ \u4f46\u662f $(1-x)^{1004535808}\\not\\equiv1(\\bmod\\ x^{1004535809})$ \u800c\u662f $(1-x)^{1004535809}\\equiv1(\\bmod\\ x^{1004535809})$\uff0c\u5f53\u7136\u4e5f\u6709 $(1-x)^{1004535809}\\not\\equiv1(\\bmod\\ x^n)$\u3002\n\n\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u7248\u672c\uff08\u4e0d\u5f00 $\\text{O2}$ \u5c31\u4f1a $\\text{TLE}$\uff09\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\n#define P 1004535809ll\n#define G 615614863ll\n#define N 18ll\nusing namespace std;\nnamespace QYB {\n    ll g[1 << N], r[1 << N];\n    ll read_huge_int() {\n        static char s[1 << 20];\n        scanf(\"%s\", s); ll len = strlen(s), res = 0;\n        reverse(s, s + len);\n        for (ll i = 0, h = 1; i < len; i++, (h *= 10) %= P) {\n            (res += h * (s[i] - '0') % P) %= P;\n        } return res;\n    } void exgcd(ll a, ll b, ll &x, ll &y) {\n        if (!b) return x = 1, y = 0, void();\n        exgcd(b, a % b, y, x); y -= a / b * x;\n    } ll inv(ll a) { ll ra, rp; exgcd(a, P, ra, rp); return ((ra % P) + P) % P; }\n    void init() {\n        g[0] = 1; r[0] = 0;\n        for (int i = 1; i < (1 << N); i++) {\n            g[i] = g[i - 1] * G % P;\n            r[i] = (r[i >> 1] >> 1) | ((i & 1) << N - 1);\n        }\n    } ll w(ll k, ll n) { return g[(k & ((1 << n) - 1)) << N - n]; }\n    void NTT(ll *a, ll d) {\n        for (ll i = 0; i < (1 << d); i++) {\n            if (i < (r[i] >> N - d)) {\n                swap(a[i], a[r[i] >> N - d]);\n            }\n        } for (ll i = 1; i <= d; i++) {\n            for (ll j = 0; j < (1 << d); j += (1 << i)) {\n                for (ll k = 0; k < (1 << i - 1); k++) {\n                    ll _0 = a[j + k], _1 = a[j + k + (1 << i - 1)] * w(k, i) % P;\n                    a[j + k] = (_0 + _1) % P; a[j + k + (1 << i - 1)] = (_0 - _1 + P) % P;\n                }\n            }\n        }\n    } void INTT(ll *a, ll d) {\n        for (ll i = 0; i < (1 << d); i++) {\n            if (i < (r[i] >> N - d)) {\n                swap(a[i], a[r[i] >> N - d]);\n            }\n        } for (ll i = 1; i <= d; i++) {\n            for (ll j = 0; j < (1 << d); j += (1 << i)) {\n                for (ll k = 0; k < (1 << i - 1); k++) {\n                    ll _0 = a[j + k], _1 = a[j + k + (1 << i - 1)] * w(-k, i) % P;\n                    a[j + k] = (_0 + _1) % P; a[j + k + (1 << i - 1)] = (_0 - _1 + P) % P;\n                }\n            }\n        } for (ll i = 0, rn = inv(1 << d); i < (1 << d); i++) {\n            (a[i] *= rn) %= P;\n        }\n    } void DIF(ll *a, ll *b, ll d) {\n        for (ll i = 1; i < (1 << d); i++) {\n            b[i - 1] = a[i] * i % P;\n        } b[(1 << d) - 1] = 0;\n    } void INT(ll *a, ll *b, ll d) {\n        for (ll i = (1 << d) - 1; i > 0; i--) {\n            b[i] = a[i - 1] * inv(i) % P;\n        } b[0] = 0;\n    } void INV(ll *a, ll *b, ll d) {\n        if (d == 0) return b[0] = inv(a[0]), void();\n        INV(a, b, d - 1);\n        ll *tmp = new ll[1 << d + 1];\n        memset(tmp, 0X00, sizeof(ll) << d + 1);\n        for (ll i = 0; i < (1 << d); i++) tmp[i] = a[i];\n        NTT(tmp, d + 1); NTT(b, d + 1);\n        for (ll i = 0; i < (1 << d + 1); i++) b[i] = (2 * b[i] - b[i] * b[i] % P * tmp[i] % P + P) % P;\n        INTT(b, d + 1);\n        for (ll i = (1 << d); i < (1 << d + 1); i++) b[i] = 0;\n        delete[] tmp;\n    } void LN(ll *a, ll *b, ll d) {\n        ll *tmp1 = new ll[1 << d + 1], *tmp2 = new ll[1 << d + 1];\n        memset(tmp1, 0X00, sizeof(ll) << d + 1);\n        memset(tmp2, 0X00, sizeof(ll) << d + 1);\n        DIF(a, tmp1, d); INV(a, tmp2, d);\n        NTT(tmp1, d + 1); NTT(tmp2, d + 1);\n        for (ll i = 0; i < (1 << d + 1); i++) b[i] = tmp1[i] * tmp2[i] % P;\n        INTT(b, d + 1); INT(b, b, d);\n        for (ll i = (1 << d); i < (1 << d + 1); i++) b[i] = 0;\n        delete[] tmp1; delete[] tmp2;\n    } void EXP(ll *a, ll *b, ll d) {\n        if (d == 0) return b[0] = 1, void();\n        EXP(a, b, d - 1);\n        ll *tmp1 = new ll[1 << d + 1], *tmp2 = new ll[1 << d + 1];\n        memset(tmp1, 0X00, sizeof(ll) << d + 1);\n        memset(tmp2, 0X00, sizeof(ll) << d + 1);\n        for (ll i = 0; i < (1 << d); i++) tmp1[i] = a[i];\n        LN(b, tmp2, d);\n        NTT(tmp1, d + 1); NTT(tmp2, d + 1); NTT(b, d + 1);\n        for (ll i = 0; i < (1 << d + 1); i++) b[i] = b[i] * (1 + tmp1[i] - tmp2[i] + P) % P;\n        INTT(b, d + 1);\n        for (ll i = (1 << d); i < (1 << d + 1); i++) b[i] = 0;\n        delete[] tmp1; delete[] tmp2;\n    } void POW(ll *a, ll *b, ll k, ll d) {\n        ll *tmp = new ll[1 << d + 1];\n        memset(tmp, 0X00, sizeof(ll) << d + 1);\n        LN(a, tmp, d);\n        for (ll i = 0; i < (1 << d); i++) (tmp[i] *= k) %= P;\n        EXP(tmp, b, d); for (ll i = (1 << d); i < (1 << d + 1); i++) b[i] = 0;\n        delete[] tmp;\n    } int main() {\n        ll n, opt; scanf(\"%lld\", &n); ll k = read_huge_int(); scanf(\"%lld\", &opt); init();\n        ll *a = new ll[1 << N], *b = new ll[1 << N], *c = new ll[1 << N];\n        memset(a, 0X00, sizeof(ll) << N); memset(b, 0X00, sizeof(ll) << N); memset(c, 0X00, sizeof(ll) << N);\n        for (ll i = 0; i < n; i++) scanf(\"%lld\", a + i);\n        b[0] = 1; b[1] = P - 1;\n        memset(c, 0X00, sizeof(ll) << N); POW(b, c, opt? k: P - k, N - 1); NTT(a, N); NTT(c, N);\n        for (ll i = 0; i < (1 << N); i++) (a[i] *= c[i]) %= P;\n        INTT(a, N); for (ll i = 0; i < n; i++) printf(\"%lld%c\", a[i], \" \\n\"[i == n - 1]);\n        return 0;\n    }\n} int main() {\n    return QYB::main();\n}\n```\n\n\u9012\u63a8\u7248\u672c\uff08\u4e0d\u5f00 $\\text{O2}$ \u4e5f\u8dd1\u5f97\u98de\u5feb\uff09\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\n#define P 1004535809ll\n#define G 615614863ll\n#define N 18ll\nusing namespace std;\nnamespace QYB {\n    ll g[1 << N], r[1 << N], a[1 << N], b[1 << N];\n    ll read_huge_int() {\n        static char s[1 << 20];\n        scanf(\"%s\", s); ll len = strlen(s), res = 0;\n        reverse(s, s + len);\n        for (ll i = 0, h = 1; i < len; i++, (h *= 10) %= P) {\n            (res += h * (s[i] - '0') % P) %= P;\n        } return res;\n    } void exgcd(ll a, ll b, ll &x, ll &y) {\n        if (!b) return x = 1, y = 0, void();\n        exgcd(b, a % b, y, x); y -= a / b * x;\n    } ll inv(ll a) { ll ra, rp; exgcd(a, P, ra, rp); return ((ra % P) + P) % P; }\n    void init() {\n        g[0] = 1; r[0] = 0;\n        for (int i = 1; i < (1 << N); i++) {\n            g[i] = g[i - 1] * G % P;\n            r[i] = (r[i >> 1] >> 1) | ((i & 1) << N - 1);\n        }\n    } ll w(ll k, ll n) { return g[(k & ((1 << n) - 1)) << N - n]; }\n    void NTT(ll *a, ll d) {\n        for (ll i = 0; i < (1 << d); i++) {\n            if (i < (r[i] >> N - d)) {\n                swap(a[i], a[r[i] >> N - d]);\n            }\n        } for (ll i = 1; i <= d; i++) {\n            for (ll j = 0; j < (1 << d); j += (1 << i)) {\n                for (ll k = 0; k < (1 << i - 1); k++) {\n                    ll _0 = a[j + k], _1 = a[j + k + (1 << i - 1)] * w(k, i) % P;\n                    a[j + k] = (_0 + _1) % P; a[j + k + (1 << i - 1)] = (_0 - _1 + P) % P;\n                }\n            }\n        }\n    } void INTT(ll *a, ll d) {\n        for (ll i = 0; i < (1 << d); i++) {\n            if (i < (r[i] >> N - d)) {\n                swap(a[i], a[r[i] >> N - d]);\n            }\n        } for (ll i = 1; i <= d; i++) {\n            for (ll j = 0; j < (1 << d); j += (1 << i)) {\n                for (ll k = 0; k < (1 << i - 1); k++) {\n                    ll _0 = a[j + k], _1 = a[j + k + (1 << i - 1)] * w(-k, i) % P;\n                    a[j + k] = (_0 + _1) % P; a[j + k + (1 << i - 1)] = (_0 - _1 + P) % P;\n                }\n            }\n        } for (ll i = 0, rn = inv(1 << d); i < (1 << d); i++) {\n            (a[i] *= rn) %= P;\n        }\n    } int main() {\n        ll n, opt; scanf(\"%lld\", &n); ll k = read_huge_int();\n        scanf(\"%lld\", &opt); init(); if (!opt) k = P - k;\n        for (ll i = 0; i < n; i++) scanf(\"%lld\", a + i); b[0] = 1;\n        for (int i = 1; i < n; i++) b[i] = b[i - 1] * (P - (k - i + 1 + P) % P * inv(i) % P) % P;\n        NTT(a, N); NTT(b, N); for (ll i = 0; i < (1 << N); i++) (a[i] *= b[i]) %= P; INTT(a, N);\n        for (ll i = 0; i < n; i++) printf(\"%lld%c\", a[i], \" \\n\"[i == n - 1]);\n        return 0;\n    }\n} int main() {\n    return QYB::main();\n}\n```\n\n\u5e0c\u671b\u5927\u5bb6\u80fd\u5bf9\u591a\u9879\u5f0f\u6709\u66f4\u591a\u4e86\u89e3\u3002",
        "postTime": 1668433715,
        "uid": 172003,
        "name": "qinyubo",
        "ccfLevel": 7,
        "title": "P5488 \u9898\u89e3"
    }
]
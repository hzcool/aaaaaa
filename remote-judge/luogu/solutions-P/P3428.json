[
    {
        "content": "\u672c\u6587\u5c06\u540c\u6b65\u53d1\u5e03\u4e8e\uff1a\n\n- [\u6d1b\u8c37\u535a\u5ba2](https://www.luogu.com.cn/blog/Lu-Anlai/solution-p3428)\uff1b\n- [csdn](https://blog.csdn.net/Lu_Anlai/article/details/117793228)\uff1b\n- [\u535a\u5ba2\u56ed](https://www.cnblogs.com/Lu-Anlai/p/14873274.html)\uff1b\n- [\u7b80\u4e66](https://www.jianshu.com/p/a29e0510e321)\u3002\n\n## \u9898\u76ee\n\n\u9898\u76ee\u94fe\u63a5\uff1a[\u6d1b\u8c37 P3428](https://www.luogu.com.cn/problem/P3428)\u3001[\u5b98\u7f51](https://szkopul.edu.pl/problemset/problem/Cyqv1x7xJRdcwj24GKoOZyl3/site/?key=statement)\u3002\n\n### \u9898\u610f\u7b80\u8ff0\n\n\u7ed9\u5b9a $n$ \u4e2a\u5706 $(x_i,y_i,r_i)$\uff0c\u6bcf\u4e2a\u5706\u5bf9\u5e94\u4e00\u4e2a\u70b9\u96c6 $S_i=\\left\\{(x,y)\\mid (x-x_i)^2+(y-y_i)^2\\leq r_i^2\\right\\}$\u3002\n\n\u6c42\u4e00\u4e2a\u6700\u5c0f\u7684 $i$ \u6ee1\u8db3 $\\cap_{j=1}^i S_j=\\varnothing$\uff1b\u5982\u679c\u65e0\u89e3\u8f93\u51fa `NIE`\u3002\n\n## \u9898\u89e3\n\n### \u7b80\u5355\u53c8\u81ea\u7136\u7684\u968f\u673a\u5316\n\n\u6211\u4eec\u8003\u8651\u679a\u4e3e $i$\uff0c\u7136\u540e\u5224\u5b9a $S_{1\\sim i}$ \u7684\u4ea4\u96c6\u662f\u5426\u4e3a\u7a7a\u3002\n\n\u5982\u4f55\u5224\u5b9a\u5462\uff1f\u6211\u4eec\u60f3\u5230\u4e00\u4e2a\u7b80\u5355\u7684\u65b9\u6cd5\uff0c\u6211\u4eec\u968f\u673a\u4e00\u4e9b\u5728\u5706\u7684\u8fb9\u754c\u4e0a\u7684\u70b9\uff0c\u53ea\u9700\u8981\u5224\u5b9a\u8fd9\u4e9b\u70b9\u662f\u5426\u5b58\u81f3\u5c11\u5728\u4e00\u4e2a\u70b9\u5728\u6240\u6709\u5706\u5185\u5373\u53ef\u3002\n\n\u8fd9\u79cd\u65b9\u6cd5\u7b80\u5355\u53c8\u81ea\u7136\uff0c\u4f46\u662f\u968f\u673a\u5316\u7b97\u6cd5\u6b63\u786e\u7387\u4e0d\u9ad8\uff0c\u8fd9\u8fdc\u8fdc\u4e0d\u591f\u3002\n\n### \u7814\u7a76\u51e0\u4f55\u6027\u8d28\n\n\u5982\u679c\u505a\u8ba1\u7b97\u51e0\u4f55\u9898\u800c\u629b\u5f03\u51e0\u4f55\u6027\u8d28\uff0c\u6240\u5f97\u5230\u7684\u505a\u6cd5\u5f80\u5f80\u662f\u52a3\u89e3\u3002\n\n\u7ee7\u7eed\u6cbf\u7740\u4e0a\u9762\u7684\u601d\u8def\uff0c\u6211\u4eec\u540c\u6837\u8003\u8651\u679a\u4e3e $i$\uff0c\u7136\u540e\u5224\u5b9a $S_{1\\sim i}$ \u7684\u4ea4\u96c6\u662f\u5426\u4e3a\u7a7a\u3002\n\n\u4e0d\u540c\u7684\u662f\uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u4ea4\u96c6\u4e2d\u6a2a\u5750\u6807\u6700\u5927\u7684\u70b9\u4e3a\u4ee3\u8868\u70b9\uff08\u4ee3\u8868\u70b9\u53ea\u4f1a\u6709\u4e00\u4e2a\uff0c\u8fd9\u662f\u56e0\u4e3a\u5706\u662f\u51f8\u96c6\uff0c\u51f8\u96c6\u7684\u4ea4\u96c6\u8fd8\u662f\u51f8\u96c6\uff09\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u679c\u4e00\u4e9b\u5706\u7684\u4ea4\u96c6\u975e\u7a7a\uff0c\u90a3\u4e48\u5176\u4ee3\u8868\u70b9\u4e00\u5b9a\u6ee1\u8db3\uff1a\u5b83\u662f\u6240\u6709\u5706\u4e24\u4e24\u4ea4\u96c6\u7684\u4ee3\u8868\u4e2d\u6a2a\u5750\u6807\u6700\u5c0f\u7684\u90a3\u4e2a\u3002\n\n\u8bc1\u660e\u5341\u5206\u663e\u7136\uff0c\u8003\u8651\u4ea4\u96c6\u7684\u610f\u4e49\u5373\u53ef\u3002\n\n### \u6700\u540e\u7684\u7ed3\u8bba\n\n\u7efc\u4e0a\u6240\u8ff0\uff0c\u5bf9\u4e8e\u4e00\u4e2a $i$\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa $1\\sim i-1$ \u4e0e $i$ \u7684\u4ee3\u8868\u70b9\u5373\u53ef\uff0c\u5982\u679c\u6240\u6709\u4ee3\u8868\u70b9\u4e2d\u6a2a\u5750\u6807\u6700\u5c0f\u7684\u90a3\u4e00\u4e2a\u5728\u6240\u6709\u7684\u5706\u5185\uff0c\u90a3\u4e48\u5176\u5408\u6cd5\uff0c\u5426\u5219\u4e0d\u5408\u6cd5\uff0c\u6362\u8a00\u4e4b\uff0c\u7b54\u6848\u4e3a $i$\u3002\n\n\u6211\u4eec\u8003\u8651\u8bc1\u660e\u8fd9\u4e2a\u7ed3\u8bba\uff1a\n\n- \u82e5\u6ca1\u6709\u4ea4\u96c6\uff0c\u5219\u8fd9\u4e2a\u70b9\u5fc5\u7136\u4e0d\u5408\u6cd5\uff0c\u7b26\u5408\u6211\u4eec\u7684\u9884\u671f\uff1b\n- \u82e5\u6709\u4ea4\u96c6\uff0c\u5219\u6211\u4eec\u9700\u8981\u8bc1\u660e\u8fd9\u4e2a\u70b9\u662f\u4ea4\u96c6\u7684\u4ee3\u8868\u70b9\u3002\n\t- \u5047\u8bbe\u5176\u4e0d\u662f\u4ea4\u96c6\u7684\u4ee3\u8868\u70b9\uff0c\u5219\u4ea4\u96c6\u7684\u4ee3\u8868\u70b9\u53ef\u80fd\u5728\u5176\u5de6\u53f3\uff1b\n    - \u5de6\u8fb9\uff1a\u4e0d\u53ef\u80fd\uff0c\u82e5\u4ea4\u96c6\u5b58\u5728\uff0c\u5219\u4ee3\u8868\u70b9\u7684\u6a2a\u5750\u6807 $\\geq$ \u5f53\u524d\u70b9\u6a2a\u5750\u6807\u3002\n    - \u53f3\u8fb9\uff1a\u4e0d\u53ef\u80fd\uff0c\u8003\u8651\u5f53\u524d\u70b9\u5728 $S_a\\cap S_b$ \u4e2d\u5f97\u5230\uff0c\u90a3\u4e48\u6240\u6709 $x\\geq$ \u5f53\u524d\u70b9\u6a2a\u5750\u6807\u7684\u70b9\u5747\u88ab\u4ea4\u96c6\u629b\u5f03\uff0c\u56e0\u6b64\u4ee3\u8868\u70b9\u7684\u6a2a\u5750\u6807 $\\leq$ \u5f53\u524d\u70b9\u6a2a\u5750\u6807\u3002\n    - \u7531\u5939\u903c\u8fc7\u7a0b\u53ef\u77e5\u7ed3\u8bba\u6b63\u786e\u3002\n\n\u8fd9\u4e2a\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\Theta(n^2)$\u3002\n\n### \u53c2\u8003\u7a0b\u5e8f\n\n\u4e0b\u9762\u6211\u4eec\u6765\u89e3\u51b3\u4e24\u5706\u6c42\u4ea4\u7684\u95ee\u9898\u3002\n\n\u4e0b\u9762\u4ecb\u7ecd\u4e00\u4e0b\u4e24\u79cd\u65b9\u6cd5\uff1a\u4f59\u5f26\u5b9a\u7406\u548c\u76f8\u4f3c\u4e09\u89d2\u5f62\u3002\n\n#### \u4f59\u5f26\u5b9a\u7406\n\n\u7528\u4f59\u5f26\u5b9a\u7406\u6c42\u89e3\u9700\u8981\u7528\u5230\u4e09\u89d2\u51fd\u6570\uff0c\u5e38\u6570\u5927\uff0c\u7cbe\u5ea6\u5dee\u3002\n\n\u6211\u4eec\u8003\u8651\u4e0b\u56fe\uff1a\n\n[![2WRtN4.png](https://z3.ax1x.com/2021/06/11/2WRtN4.png)](https://imgtu.com/i/2WRtN4)\n\n\u5bf9 $\\triangle{ACB}$ \u8fd0\u7528\u4f59\u5f26\u5b9a\u7406\uff0c\u5f97\u5230 $r_a^2+d^2-2dr_a\\cos\\alpha=r_b^2$\uff0c\u8fdb\u800c\u6c42\u51fa $\\alpha=\\arccos\\left(\\frac{r_a^2+d^2-r_b2}{2dr_a}\\right)$\u3002\n\n\u7136\u540e\u6211\u4eec\u518d\u6c42\u51fa\u57fa\u51c6\u89d2 $\\beta$\uff0c\u663e\u7136 $\\beta=\\texttt{atan2}(y_b-y_a,x_b-x_a)$\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u5f97\u5230\u4e86 $C,D$ \u4e24\u70b9\u7684\u5bf9 $A$ \u7684\u6781\u89d2\u4e3a $\\beta+\\alpha$\uff0c$\\beta-\\alpha$\u3002\n\n\u5bf9\u4e8e\u6781\u89d2\u4e3a $\\theta$\uff0c\u6781\u5f84\u4e3a $r_a$ \u7684\u70b9\uff0c\u6211\u4eec\u5f97\u51fa\u5176\u5bf9\u5e94\u70b9\u7684\u5750\u6807\u4e3a $(r_a\\cos\\theta,r_a\\sin\\theta)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define reg register\ntypedef long long ll;\n\nconst double eps=1e-6;\n\ninline int sgn(reg double x){\n\tif(fabs(x)<eps)\n\t\treturn 0;\n\telse\n\t\treturn x<0?-1:1;\n}\n\ninline double sqr(reg double x){\n\treturn x*x;\n}\n\nconst int MAXN=2e3+5;\n\nstruct Vector{\n\tdouble x,y;\n\tinline Vector(reg double x=0,reg double y=0):x(x),y(y){\n\t\treturn;\n\t}\n\tinline Vector operator+(const Vector& a)const{\n\t\treturn Vector(x+a.x,y+a.y);\n\t}\n\tinline Vector operator-(const Vector& a)const{\n\t\treturn Vector(x-a.x,y-a.y);\n\t}\n\tinline Vector operator*(const double a)const{\n\t\treturn Vector(x*a,y*a);\n\t}\n};\n\ninline double dot(const Vector& a,const Vector& b){\n\treturn a.x*b.x+a.y*b.y;\n}\n\ninline double cross(const Vector& a,const Vector& b){\n\treturn a.x*b.y-a.y*b.x;\n}\n\ntypedef Vector Point;\n\ninline double getDis2(const Point& a,const Point& b){\n\treturn dot(a-b,a-b);\n}\n\ninline double getDis(const Point& a,const Point& b){\n\treturn sqrt(getDis2(a,b));\n}\n\ninline bool isEmpty(const Point& a){\n\treturn a.x!=a.x||a.y!=a.y;\n}\n\nstruct Circle{\n\tPoint o;\n\tdouble r;\n\tinline bool contain(const Point& x)const{\n\t\treturn sgn(sqr(r)-getDis2(x,o))>=0;\n\t}\n\tinline Point getRig(void)const{\n\t\treturn o+Vector(r,0);\n\t}\n};\n\ninline bool isCon(const Circle& a,const Circle& b){\n\treturn sgn(sqr(a.r-b.r)-getDis2(a.o,b.o))>=0;\n}\n\ninline bool isSep(const Circle& a,const Circle& b){\n\treturn sgn(getDis2(a.o,b.o)-sqr(a.r+b.r))>0;\n}\n\ninline Point getPot(const Circle &a,const Circle &b){\n\tif(isCon(a,b))\n\t\tif(sgn(b.getRig().x-a.getRig().x)>0)\n\t\t\treturn a.getRig();\n\t\telse\n\t\t\treturn b.getRig();\n\telse if(isSep(a,b))\n\t\treturn Point(nan(\"\"),nan(\"\"));\n\telse{\n\t\tif(a.contain(b.getRig()))\n\t\t\treturn b.getRig();\n\t\telse if(b.contain(a.getRig()))\n\t\t\treturn a.getRig();\n\t\telse{\n\t\t\treg double d=getDis(a.o,b.o);\n\t\t\treg double ang=acos(((sqr(a.r)+sqr(d))-sqr(b.r))/(2*a.r*d));\n\t\t\treg double delta=atan2(b.o.y-a.o.y,b.o.x-a.o.x);\n\t\t\treg double ang1=delta+ang,ang2=delta-ang;\n\t\t\tPoint p1=a.o+Vector(cos(ang1)*a.r,sin(ang1)*a.r);\n\t\t\tPoint p2=a.o+Vector(cos(ang2)*a.r,sin(ang2)*a.r);\n\t\t\tPoint res;\n\t\t\tif(sgn(p2.x-p1.x)>0)\n\t\t\t\tres=p2;\n\t\t\telse\n\t\t\t\tres=p1;\n\t\t\treturn res;\n\t\t}\n\t}\n}\n\nint n;\nCircle a[MAXN];\n\nint main(void){\n\tscanf(\"%d\",&n);\n\tPoint lef(0,0);\n\tfor(reg int i=1;i<=n;++i){\n\t\tstatic int x,y,r;\n\t\tscanf(\"%d%d%d\",&x,&y,&r);\n\t\ta[i].o=Point(x,y),a[i].r=r;\n\t\tif(i==2)\n\t\t\tlef=getPot(a[1],a[2]);\n\t\telse if(i>2){\n\t\t\tfor(reg int j=1;j<i&&!isEmpty(lef);++j){\n\t\t\t\tPoint tmp=getPot(a[i],a[j]);\n\t\t\t\tif(isEmpty(tmp)||tmp.x<=lef.x)\n\t\t\t\t\tlef=tmp;\n\t\t\t}\n\t\t\tfor(reg int j=1;j<=i&&!isEmpty(lef);++j)\n\t\t\t\tif(!a[j].contain(lef))\n\t\t\t\t\tlef=Point(nan(\"\"),nan(\"\"));\n\t\t}\n\t\tif(isEmpty(lef)){\n\t\t\tprintf(\"%d\\n\",i);\n\t\t\treturn 0;\n\t\t}\n\t}\n\tputs(\"NIE\");\n\treturn 0;\n}\n```\n\n#### \u76f8\u4f3c\u4e09\u89d2\u5f62\n\n[![2WRN4J.png](https://z3.ax1x.com/2021/06/11/2WRN4J.png)](https://imgtu.com/i/2WRN4J)\n\n\u5982\u4e0a\u56fe\uff0c\u6211\u4eec\u8bbe $a=|AG|$\uff0c$b=|BG|$\uff0c$h=|CG|$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u6709\uff1a\n\n$$\\begin{cases}r_a^2=a^2+h^2\\\\r_b^2=b^2+h^2\\\\a+b=d\\end{cases}$$\n\n\u90a3\u4e48\u6211\u4eec\u6709\uff1a\n\n$$a=\\frac{r_a^2+d^2-r_b^2}{2d}$$\n\n\u7136\u540e\u8003\u8651 $\\triangle AIB\\sim\\triangle CHG$\uff0c\u6211\u4eec\u6709\uff1a\n\n$$(y_b-y_a)h=d(y_c-y_g)$$\n\n\u6211\u4eec\u53ef\u7531\u6b64\u89e3\u51fa\u5750\u6807\uff0c\u5176\u4ed6\u540c\u7406\u53ef\u7b97\u51fa\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define reg register\ntypedef long long ll;\n\nconst double eps=1e-6;\n\ninline int sgn(reg double x){\n\tif(fabs(x)<eps)\n\t\treturn 0;\n\telse\n\t\treturn x<0?-1:1;\n}\n\ninline double sqr(reg double x){\n\treturn x*x;\n}\n\nconst int MAXN=2e3+5;\n\nstruct Vector{\n\tdouble x,y;\n\tinline Vector(reg double x=0,reg double y=0):x(x),y(y){\n\t\treturn;\n\t}\n\tinline Vector operator+(const Vector& a)const{\n\t\treturn Vector(x+a.x,y+a.y);\n\t}\n\tinline Vector operator-(const Vector& a)const{\n\t\treturn Vector(x-a.x,y-a.y);\n\t}\n\tinline Vector operator*(const double a)const{\n\t\treturn Vector(x*a,y*a);\n\t}\n};\n\ninline double dot(const Vector& a,const Vector& b){\n\treturn a.x*b.x+a.y*b.y;\n}\n\ninline double cross(const Vector& a,const Vector& b){\n\treturn a.x*b.y-a.y*b.x;\n}\n\ntypedef Vector Point;\n\ninline double getDis2(const Point& a,const Point& b){\n\treturn dot(a-b,a-b);\n}\n\ninline double getDis(const Point& a,const Point& b){\n\treturn sqrt(getDis2(a,b));\n}\n\ninline bool isEmpty(const Point& a){\n\treturn isnan(a.x)||isnan(a.y);\n}\n\nstruct Circle{\n\tPoint o;\n\tdouble r;\n\tinline bool contain(const Point& x)const{\n\t\treturn sgn(sqr(r)-getDis2(x,o))>=0;\n\t}\n\tinline Point getRig(void)const{\n\t\treturn o+Vector(r,0);\n\t}\n};\n\ninline bool isCon(const Circle& a,const Circle& b){\n\treturn sgn(sqr(a.r-b.r)-getDis2(a.o,b.o))>=0;\n}\n\ninline bool isSep(const Circle& a,const Circle& b){\n\treturn sgn(getDis2(a.o,b.o)-sqr(a.r+b.r))>0;\n}\n\ninline Point getPot(const Circle &a,const Circle &b){\n\tif(isCon(a,b))\n\t\tif(sgn(b.getRig().x-a.getRig().x)>0)\n\t\t\treturn a.getRig();\n\t\telse\n\t\t\treturn b.getRig();\n\telse if(isSep(a,b))\n\t\treturn Point(nan(\"\"),nan(\"\"));\n\telse{\n\t\tif(a.contain(b.getRig()))\n\t\t\treturn b.getRig();\n\t\telse if(b.contain(a.getRig()))\n\t\t\treturn a.getRig();\n\t\telse{\n\t\t\treg double d=getDis(a.o,b.o);\n\t\t\treg double val=(sqr(a.r)+sqr(d)-sqr(b.r))/(2*d);\n\t\t\treg double h=sqrt(sqr(a.r)-sqr(val));\n\t\t\tPoint bas=a.o+(b.o-a.o)*(val/d);\n\t\t\tVector tmp=Vector(b.o.y-a.o.y,a.o.x-b.o.x)*(h/d);\n\t\t\tPoint p1=bas-tmp,p2=bas+tmp;\n\t\t\tif(sgn(p2.x-p1.x)>0)\n\t\t\t\treturn p2;\n\t\t\telse\n\t\t\t\treturn p1;\n\t\t}\n\t}\n}\n\nint n;\nCircle a[MAXN];\n\nint main(void){\n\tscanf(\"%d\",&n);\n\tPoint lef(0,0);\n\tfor(reg int i=1;i<=n;++i){\n\t\tstatic int x,y,r;\n\t\tscanf(\"%d%d%d\",&x,&y,&r);\n\t\ta[i].o=Point(x,y),a[i].r=r;\n\t\tif(i==2)\n\t\t\tlef=getPot(a[1],a[2]);\n\t\telse if(i>2){\n\t\t\tfor(reg int j=1;j<i&&!isEmpty(lef);++j){\n\t\t\t\tPoint tmp=getPot(a[i],a[j]);\n\t\t\t\tif(isEmpty(tmp)||tmp.x<=lef.x)\n\t\t\t\t\tlef=tmp;\n\t\t\t}\n\t\t\tfor(reg int j=1;j<=i&&!isEmpty(lef);++j)\n\t\t\t\tif(!a[j].contain(lef))\n\t\t\t\t\tlef=Point(nan(\"\"),nan(\"\"));\n\t\t}\n\t\tif(isEmpty(lef)){\n\t\t\tprintf(\"%d\\n\",i);\n\t\t\treturn 0;\n\t\t}\n\t}\n\tputs(\"NIE\");\n\treturn 0;\n}\n```\n",
        "postTime": 1623334917,
        "uid": 38502,
        "name": "agicy",
        "ccfLevel": 9,
        "title": "\u300c\u9898\u89e3\u300dPOI2005 AKC-Special Forces Manoeuvres"
    },
    {
        "content": "\u8fd9\u9898\u53ef\u80fd\u6709\u5f88\u591a\u79cd\u5947\u5947\u602a\u602a\u7684\u505a\u6cd5X\n\n\u8fd9\u91cc\u4e3b\u8981\u662f\u4ecb\u7ecd\u4e0b std \u7684\u505a\u6cd5\uff0c\u76f8\u6bd4\u5176\u5b83\u505a\u6cd5\u5e94\u8be5\u4f1a\u7b80\u5355\u548c\u597d\u5199\u8bb8\u591a\n\n\uff08\u6ce2\u5170\u8bed\u771f\u96be\u8bfb\uff09\n\n[\u53c2\u8003](https://oi.edu.pl/static/attachment/20110811/oi12.pdf) - P149\n\n## \u89e3\u6790\n\n\u9996\u5148\u9898\u610f\u53ef\u4ee5\u8f6c\u5316\u4e3a\uff0c\u6309\u7ed9\u51fa\u7684\u987a\u5e8f\u6dfb\u52a0\u5706\uff08\u58eb\u5175\uff09\uff0c\u7ef4\u62a4\u5b83\u4eec\u7684\u4ea4\u96c6\uff0c\u5f53\u4ea4\u96c6\u9996\u6b21\u4e3a\u7a7a\u65f6\u8f93\u51fa\u5df2\u6dfb\u52a0\u7684\u5706\u7684\u6570\u91cf\uff08\u4e0d\u542b\u6700\u540e\u6dfb\u52a0\u7684\u90a3\u4e2a\u5706\uff09\n\n\u8bbe\u5df2\u6dfb\u52a0\u7684\u5706 $K_1, K_2, \\cdots K_n$\uff0c\u5373\u6211\u4eec\u8981\u7ef4\u62a4\u4ea4\u96c6 $S=K_1\\cap K_2 \\cap \\cdots \\cap K_n$\n\n\u8003\u8651\u7ef4\u62a4\u5f53\u524d\u4ea4\u96c6\u6700\u53f3\uff08$\\text{x}$ \u5750\u6807\u6700\u5927\uff09\u7684\u90a3\u4e2a\u70b9\uff0c\u8bbe\u5176\u4e3a $X$\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u5f53 $S$ \u4e0d\u4e3a\u7a7a\u65f6\uff0c$X$ \u6709\u5982\u4e0b\u6027\u8d28\uff1a\n\n> $\\text{\u5f15\u7406 1.}$ $X$ \u4e00\u5b9a\u5b58\u5728\u4e14\u552f\u4e00\n\n> $\\text{\u5f15\u7406 2.}$ $X$ \u4e00\u5b9a\u4e3a\u67d0\u4e24\u4e2a\u5706\u7684\u4ea4\u96c6 $K_i\\cap K_j$ \u7684\u6700\u53f3\u70b9\uff08\u53ef\u4ee5\u6709 $i=j$\uff09\n\n$\\text{1.}$ \u7684\u5176\u4e2d\u4e00\u79cd\u8bc1\u660e\u65b9\u5f0f\u4e3a\uff0c\u5148\u8bc1\u660e\u4ea4\u96c6\u662f\u51f8\u7684\uff0c\u518d\u6839\u636e\u5706\u7684\u6027\u8d28\u8ba8\u8bba\u5373\u53ef\u3002\u5177\u4f53\u8ba8\u8bba\u6b64\u5904\u7565\u8fc7\n\n$\\text{2.}$ \u7684\u8bc1\u660e\u4e5f\u662f\u5f88\u663e\u7136\u7684\u3002\u9996\u5148 $X$ \u4e0d\u53ef\u80fd\u4e0d\u5728\u4efb\u4f55\u5706\u7684\u8fb9\u7f18\u4e0a\uff0c\u5426\u5219\u6211\u4eec\u53ea\u9700\u5355\u7eaf\u5730\u589e\u5927 $X$ \u7684 $\\text{x}$ \u5750\u6807\u5c31\u80fd\u5f97\u5230\u4e00\u4e2a\u66f4\u53f3\u8fb9\u7684\u70b9\u3002\u5982\u679c $X$ \u5728\u67d0\u4e2a\u5706 $K_i$ \u7684\u8fb9\u7f18\u4e0a\uff0c\u8fd9\u610f\u5473\u7740\uff1a\n\n- $X$ \u4e3a $K_i$ \u7684\u6700\u53f3\u70b9\n- \u5b58\u5728\u53e6\u4e00\u4e2a\u5706 $K_j$\uff0c\u4f7f\u5f97 $X$ \u4e3a\u4ea4\u96c6 $K_i\\cap K_j$ \u7684\u6700\u53f3\u70b9\n\n\u7684\u81f3\u5c11\u5176\u4e2d\u4e4b\u4e00\u6ee1\u8db3\u3002\u4e0d\u7136\u7684\u8bdd\u4e00\u5b9a\u5b58\u5728\u67d0\u4e2a\u5706 $K_k$\uff0c\u53ea\u8981\u6211\u4eec\u6cbf $K_k$ \u7684\u8fb9\u7f18\u589e\u5927 $X$ \u7684 $\\text{x}$ \u5750\u6807\u5c31\u80fd\u5f97\u5230\u77db\u76fe\u3002\u6ce8\u610f\u5230\u8fd9\u4e24\u4e2a\u6761\u4ef6\u548c $\\text{\\text{2.}}$ \u662f\u7b49\u4ef7\u7684\uff0c\u4e8e\u662f\u7531\u6b64\u5bfc\u51fa\u4e86 $\\text{2.}$ \u7684\u8bc1\u660e\n\n\u8bbe\u96c6\u5408 $P$ \u7531\u6240\u6709\u53ef\u80fd\u7684\u4e24\u4e2a\u5706\u7684\u4ea4 $K_i\\cap K_j$ \u7684\u6700\u53f3\u70b9\u6784\u6210\u3002\u63a5\u7740\u8fd8\u80fd\u6ce8\u610f\u5230\uff1a\n\n> $\\text{\u5f15\u7406 3.}$ $X$ \u4e00\u5b9a\u4e3a $P$ \u4e2d $\\text{x}$ \u5750\u6807\u6700\u5c0f\u7684\u90a3\u4e2a\u70b9\n\n\u8bc1\u660e\u53ea\u9700\u8003\u8651\u5706\u7684\u6027\u8d28\u3001\u4ea4\u96c6\u7684\u57fa\u672c\u6027\u8d28\u4ee5\u53ca $1.$ \u5373\u53ef\n\n\u7531\u6b64\u95ee\u9898\u5c31\u5df2\u7ecf\u8f6c\u5316\u6210\uff0c\u68c0\u67e5\u4e00\u4e2a\u7279\u5b9a\u7684\u70b9\u2014\u2014\u96c6\u5408 $P$ \u6700\u5de6\u8fb9\u7684\u70b9\u2014\u2014\u662f\u5426\u5728\u5f53\u524d\u7684\u6240\u6709\u5706\u4e2d\uff08$S$ \u662f\u5426\u4e3a\u7a7a\uff09\u3002$P$ \u6bd4 $S$ \u66f4\u5bb9\u6613\u63cf\u8ff0\u548c\u8ba1\u7b97\uff1b\u8981\u505a\u5230\u8fd9\u70b9\uff0c\u6211\u4eec\u53ea\u9700\u5728\u6bcf\u6dfb\u52a0\u4e00\u4e2a\u5706\u65f6\u7b80\u5355\u5730 $O(n)$ \u7ef4\u62a4\u96c6\u5408 $P$\uff08\u6c42\u4e24\u4e2a\u5706\u7684\u4ea4\u7684\u6700\u53f3\u70b9\u662f\u53ef\u4ee5 $O(1)$ \u505a\u5230\u7684\uff0c\u4f46\u5177\u4f53\u6b64\u5904\u7565\u8fc7\uff09\u4e0e\u68c0\u67e5 $P$ \u6700\u5de6\u8fb9\u7684\u70b9\u662f\u5426\u5408\u6cd5\u3002\u7b97\u6cd5\u603b\u7684\u590d\u6742\u5ea6\u662f $O(n^2)$ \u7684\n\n## \u4ee3\u7801\n\n```cpp\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#define nan 0.0/0\n#define double long double\nusing std::vector;\nusing std::max;\n\nconst double eps =1e-14;\n\nstruct point{\n\tdouble x, y;\n\t\n\tpoint(){}\n\tpoint(const double &_x, const double &_y)\n\t\t:x(_x), y(_y){}\n\t\n\tinline bool Null() const{\n\t\treturn (x != x || y != y);\n\t}\n};\nstruct circle{\n\tpoint O;\n\tdouble r;\n\t\n\tcircle(){}\n\tcircle(const double &_x, const double &_y, const double &_r)\n\t\t:O(point(_x, _y)), r(_r){}\n};\n\nconst point Null(nan, nan);\n\nbool inCircle(const point &x, const circle &K){\n//\treturn (sqrt((x.x-K.O.x)*(x.x-K.O.x)+(x.y-K.O.y)*(x.y-K.O.y)) < K.r);\n\treturn ((x.x-K.O.x)*(x.x-K.O.x)+(x.y-K.O.y)*(x.y-K.O.y) <= K.r*K.r+1e-7);\n}\n\n// \u8fd4\u56de\u4e24\u4e2a\u5706\u4ea4\u96c6\u7684 x \u5750\u6807\u6700\u5927\u70b9 //\npoint prawyPunkt(const circle &K1, const circle &K2){\n\tif((K1.O.x-K2.O.x)*(K1.O.x-K2.O.x)+(K1.O.y-K2.O.y)*(K1.O.y-K2.O.y) < (K1.r-K2.r)*(K1.r-K2.r)+eps){ // \u5305\u542b\u7684\u60c5\u51b5 //\n\t\tif((K1.O.x+K1.r <= K2.O.x+K2.r+eps && K1.O.x-K1.r >= K2.O.x-K2.r-eps) && (K1.O.y+K1.r <= K2.O.y+K2.r+eps && K1.O.y-K1.r >= K2.O.y-K2.r-eps))\n\t\t\treturn point(K1.O.x+K1.r, K1.O.y);\n\t\telse if((K2.O.x+K2.r <= K1.O.x+K1.r+eps && K2.O.x-K2.r >= K1.O.x-K1.r-eps) && (K2.O.y+K2.r <= K1.O.y+K1.r+eps && K2.O.y-K2.r >= K1.O.y-K1.r-eps))\n\t\t\treturn point(K2.O.x+K2.r, K2.O.y);\n\t}\n\telse{ // \u6c42\u4e24\u5706\u4ea4\u70b9\uff1b\u4e0b\u9762\u7684\u5f0f\u5b50\u4e8b\u5b9e\u4e0a\u90fd\u662f\u7528 matlab \u63a8\u7684\uff0c\u6240\u4ee5\u522b\u8bd5\u7740\u641e\u61c2 ( //\n\t\tdouble a1 =K1.O.x, b1 =K1.O.y, R1 =K1.r, a2 =K2.O.x, b2 =K2.O.y, R2 =K2.r;\n\t\n\t\tdouble R1R1 =R1*R1;\n\t\tdouble a1a1 =a1*a1;\n\t\tdouble b1b1 =b1*b1;\n\t\n\t\tdouble a2a2 =a2*a2;\n\t\tdouble b2b2 =b2*b2;\n\t\tdouble R2R2 =R2*R2;\n\t\n\t\tdouble subs1 = a1a1 - 2 * a1*a2 + a2a2 + b1b1 - 2 * b1*b2 + b2b2;\n\t\tdouble subs2 = -R1R1 * a1 + R1R1 * a2 + R2R2 * a1 - R2R2 * a2 + a1a1*a1 - a1a1 * a2 - a1*a2a2 + a1*b1b1 - 2 * a1*b1*b2 + a1*b2b2 + a2a2*a2 + a2*b1b1 - 2 * a2*b1*b2 + a2*b2b2;\n\t\tdouble subs3 = -R1R1 * b1 + R1R1 * b2 + R2R2 * b1 - R2R2 * b2 + a1a1*b1 + a1a1 * b2 - 2 * a1*a2*b1 - 2 * a1*a2*b2 + a2a2 * b1 + a2a2 * b2 + b1b1*b1 - b1b1 * b2 - b1*b2b2 + b2b2*b2;\n\t\tdouble sigma = sqrt((R1R1 + 2 * R1*R2 + R2R2 - a1a1 + 2 * a1*a2 - a2a2 - b1b1 + 2 * b1*b2 - b2b2)*(-R1R1 + 2 * R1*R2 - R2R2 + subs1));\n\t\t\n\t\tif(abs(subs1) > eps){\n\t\t\tpoint P1, P2;\n\t\t\tP1.x = (subs2 - sigma*b1 + sigma*b2) / (2 * subs1);\n\t\t\tP2.x = (subs2 + sigma*b1 - sigma*b2) / (2 * subs1);\n\t\t\n\t\t\tP1.y = (subs3 + sigma*a1 - sigma*a2) / (2 * subs1);\n\t\t\tP2.y = (subs3 - sigma*a1 + sigma*a2) / (2 * subs1);\n\t\t\t\n\t\t\tpoint P =((P1.x > P2.x) ? P1 : P2);\n\t\t\t\n\t\t\t// \u82e5\u4e0d\u4e3a\u4ea4\u70b9\uff0c\u5219\u4e3a\u5176\u4e2d\u4e00\u4e2a\u5706\u7684\u6700\u53f3\u70b9 //\n\t\t\tconst point Q1 =point(K1.O.x+K1.r, K1.O.y);\n\t\t\tif(inCircle(Q1, K2) && Q1.x > P.x-eps)\n\t\t\t\tP =Q1;\n\t\t\tconst point Q2 =point(K2.O.x+K2.r, K2.O.y);\n\t\t\tif(inCircle(Q2, K1) && Q2.x > P.x-eps)\n\t\t\t\tP =Q2;\n\t\t\t\n\t\t\treturn P;\n\t\t}\n\t\telse\n\t\t\treturn Null;\n\t}\n}\n\nint main(){\n\tint n;\n\tscanf(\"%d\", &n);\n\tvector<circle> arr(n);\n\tpoint x(0, 0);\n\tfor(int i =0; i < n; ++i){\n\t\tint _x, _y, _r;\n\t\tscanf(\"%d%d%d\", &_x, &_y, &_r);\n\t\tarr[i] =circle(_x, _y, _r);\n\t\t\n\t\tif(i == 1)\n\t\t\tx =prawyPunkt(arr[0], arr[1]);\n\t\telse if(i > 1){\n\t\t\tfor(int j =0; j < i && !x.Null(); ++j){\n\t\t\t\tconst point y =prawyPunkt(arr[i], arr[j]);\n\t\t\t\tif(y.Null() || y.x < x.x+eps)\n\t\t\t\t\tx =y;\n\t\t\t}\n\t\t\tfor(int j =0; j <= i && !x.Null(); ++j)\n\t\t\t\tif(!inCircle(x, arr[j]))\n\t\t\t\t\tx =Null;\n\t\t}\n\t\tif(x.Null())\n\t\t\treturn printf(\"%d\", i+1) && 0;\n\t}\n\tputs(\"NIE\");\n}\n```",
        "postTime": 1623473955,
        "uid": 105254,
        "name": "Piwry",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3428 [POI2005] AKC-Special Forces Manoeuvres"
    }
]
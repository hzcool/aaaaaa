[
    {
        "content": "\u540c\u6b65\u8d5b\u5f53\u573a\u964d\u667a\u4e86\uff0c\u8ba4\u4e3a\u8d2a\u5fc3\u662f\u5047\u7684\u3002\u3002\u3002\u3002\u7136\u540e\u3002\u3002\u3002\u3002\u5c31\u5199\u4e86\u4e2a\u66b4\u529b\u3002\u3002\u3002\u3002\n\n\u5f00\u9898\u4e00\u770b\uff0c\u8fd9\u4e0d\u662f~~\u6a21\u62df~~\u8d39\u7528\u6d41\u5417\uff1f\n\n\u7136\u800c\u8fd9\u4e2a\u8d39\u7528\u6d41\u5e76\u4e0d\u663e\u7136\u3002\u3002\u3002\u3002\u6240\u4ee5\u6211\u5f53\u65f6~~\u653e\u5f03\u4e86T3\u90e8\u5206\u5206~~\u6ca1\u60f3~~\u5230~~\u3002\n\n\u5f53\u7136\u4e5f\u5e0c\u671b\u8fd9\u4e2a\u9898\u89e3\u80fd\u8ba9\u5927\u5bb6\u61c2\u5f97**\u4ec0\u4e48\u662f\u771f\u6b63\u7684\u6a21\u62df\u8d39\u7528\u6d41**\u5566\n\n# Part1:\u8d39\u7528\u6d41\n\n\u5927\u6982\u662f\u8fd9\u4e48\u4e00\u5f20\u56fe\u2026\u2026\n\n![](https://cdn.luogu.com.cn/upload/pic/64127.png)\n\n\u6b63\u786e\u6027\u561b\u2026\u2026\u5c31\u662f\u5982\u679c\u9009\u4e0b\u6807\u4e0d\u540c\u7684\u4e00\u5bf9\u6570\u7684\u8bdd\u5fc5\u987b\u8d70$C -> D$ \u8fd9\u6761\u8def\u5f84\n\n\u90a3\u4e48\u5c31\u4fdd\u8bc1\u4e86\u4e0b\u6807\u4e0d\u540c\u7684\u6570\u7684\u5bf9\u6570\u4f1a$<= K - L$,\u90a3\u4e48\u76f8\u540c\u7684\u5c31\u81f3\u5c11\u6709$L$\u5bf9\u4e86\u3002\n\n\u7136\u540e\u4f60\u6309\u4e0a\u8ff0\u65b9\u6cd5\u5efa\u56fe\uff0c\u5199\u4e2a\u8d39\u7528\u6d41\u5c31\u53ef\u4ee5\u62ff\u5230$n = 150$\u6216\u8005$n = 2000$\u7684\u5206\u4e86\u3002\n\n# Part2:\u8d2a\u5fc3(\u6a21\u62df\u8d39\u7528\u6d41)\n\n\u8003\u8651\u4e00\u70b9\u4e00\u70b9\u7684\u589e\u52a0\u6d41\u91cf\u3002\n\n\u5982\u679c\u5f27$CD$\u6ca1\u6709\u6d41\u6ee1\uff0c\u6211\u4eec\u5c31\u6d41\u5f27$CD$\uff0c\u56e0\u4e3a\u5b83\u7684\u9009\u62e9\u6700\u201c\u81ea\u7531\u201d\uff0c\u5f97\u5230\u7684\u7b54\u6848\u4e5f\u6700\u4f18\u3002\n\n\u600e\u4e48\u6d41\u6700\u4f18\u5462\uff1f\u5f53\u7136\u662f**\u5f53\u524d\u6ca1\u6709\u88ab\u9009\u4e2d\u7684\u6570\u4e2d\uff0cA/B\u5404\u53d6\u4e00\u4e2amax**\n\n\u5f53\u7136**\u5982\u679c\u6211\u4eec\u9009\u7684\u6570\u4e2d\u6709\u4e0b\u6807\u76f8\u7b49\u7684\uff0c\u5c31\u4e0d\u7528\u5360\u636e\u5f27CD\u7684\u6d41\u91cf\u4e86**\uff0c\u8fd9\u4e2a\u9700\u8981\u6ce8\u610f\u3002\n\n\u5728\u5f27$CD$\u6d41\u6ee1\u4e4b\u540e\uff0c\u6211\u4eec\u8003\u8651\u589e\u52a0\u5176\u4ed6\u5f27\u7684\u6d41\u91cf\uff0c\u4e5f\u5c31\u662f\u8981\u7ec4\u6210**\u65b0\u7684\u4e00\u5bf9\u4e0b\u6807\u76f8\u7b49\u7684\u6570**\n\n\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5**\u627e\u4e00\u4e2aAB\u90fd\u6ca1\u88ab\u9009\u8fc7\u7684\u4e0b\u6807\uff0c\u9009\u51fa\u4e00\u4e2a$A_i+B_i$ \u6700\u5927\u7684**\uff0c\u53cd\u6620\u5230\u56fe\u4e0a\u5c31\u662f\u628a $S->A_i ->B_i ->T$ \u6d41\u4e00\u904d\n\n\u6211\u4eec\u8fd8\u53ef\u4ee5\u7ed9\u4e00\u4e2a\u5df2\u7ecf\u9009\u4e2d\u7684$A$\u627e\u4e00\u4e2a$B$\u548c\u5b83\u914d\u5bf9\uff0c\u7136\u540e\u4f60\u4f1a\u53d1\u73b0\u8fd9\u4f1a\u4f7f\u5f97$C$\u5c11\u4e00\u70b9\u6d41\u91cf\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u7ed9$C$\u4e00\u70b9\u6d41\u91cf\uff0c\u4e0d\u7136\u5c31\u4e0d\u6ee1\u8db3\u6d41\u91cf\u5e73\u8861\u4e86\n\n\u6240\u4ee5\u6211\u4eec\u8fd8\u5f97\u518d\u627e\u4e00\u4e2a**\u6700\u5927\u7684\u6ca1\u9009\u8fc7\u7684**$A$\u2026\u2026\n\n\u540c\u6837\u7684\u6211\u4e5f\u53ef\u4ee5\u7ed9\u4e00\u4e2a**\u6ca1\u914d\u8fc7\u5bf9\u7684**$B$\u914d\u5bf9\uff0c\u518d\u8865\u4e00\u4e2a\u6700\u5927\u7684$B$\u4e0a\u53bb\u2026\u2026\n\n\u53cd\u6620\u5230\u56fe\u4e0a\uff0c\u5c31\u662f\u628a\u4e00\u6761$A_i->C$\u7684\u6d41\u91cf\u64a4\u56de\uff0c\u6539\u4e3a\u4ece$A_i->B_i->T$\n\n\u7136\u540e\u6362\u4e00\u4e2a$A_j$\u8865\u4e0a\uff0c\u6d41\u4e00\u4e0b$S - >A_j - >C$\u8fd9\u6761\u8fb9\u3002\n\n**\u8fc7\u7a0b\u4e2d\u5982\u679c\u53d1\u73b0\u5f27CD\u53ef\u4ee5\u4e0d\u6d41\u6ee1\uff0c\u6bd4\u5982\u4e0a\u8ff0\u914d\u5bf9\u7684\u8fc7\u7a0b\u4e2d\u5982\u679c\u914d\u51fa\u4e86\u4e24\u5bf9\u7684\u8bdd\uff0c\u6211\u4eec\u5c31\u5728\u5269\u4e0b\u7684A\u548cB\u4e2d\u5206\u522b\u9009\u53d6\u4e00\u4e2a\u6700\u5927\u503c\uff0c\u4fdd\u8bc1CD\u6d41\u6ee1\u3002**\n\n\u8fd9\u4e2a\u5c31\u662f\u4e00\u4e9b\u4eba\u7684\u8d2a\u5fc3\u2026\u2026\u5728\u6b64\u5904orz@_rqy\u63d0\u4f9b\u7684\u8d2a\u5fc3\u601d\u8def\u2026\u2026\n\n\u4e0d\u8fc7\u6211\u628a\u5b83\u7528\u8d39\u7528\u6d41\u7684\u89d2\u5ea6\u89e3\u91ca\u7684\u8bdd\u2026\u2026\u5b83\u5c31\u662f\u6a21\u62df\u8d39\u7528\u6d41\u5440\uff01\n\n\u6240\u4ee5\u8fd9\u4e2a\u8d2a\u5fc3\uff08\u6a21\u62df\u8d39\u7528\u6d41\uff09\u662f\u6b63\u786e\u7684\uff01\n\n# Part3\uff1a\u4ee3\u7801\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u6211\u4eec\u53ea\u8981\u6c42\u4e00\u4e2a\u6700\u5927\u503c\u2026\u2026\u7528\u5806\u7ef4\u62a4\u5c31\u53ef\u4ee5\u4e86\u2026\u2026\n\n(\u4ee3\u7801\u884c\u6570\u6709\u70b9\u591a\uff0c\u52ff\u55b7)\n\n\u4ee3\u7801\u91cc\u6709\u8be6\u7ec6\u6ce8\u91ca~~~\n\n```cpp\n\n// F1,F2\u8868\u793a\u53ef\u4ee5\u7528\u6765\u505a\u914d\u5bf9\u64cd\u4f5c\u7684\u5806\uff0cH1\uff0cH2\u8868\u793aA\u3001B\u4e24\u4e2a\u6570\u7ec4\u4e2d\u5269\u4f59\u7684\u6570\n// H3\u5b58\u7684\u662fA\u3001B\u90fd\u6ca1\u9009\u7684\u90a3\u4e9bi(\u4e5f\u662f\u5806)\n#include <bits/stdc++.h>\n#define LL long long\nusing namespace std;\ninline int read(){\n    static int x; x = 0; static char c; c = getchar();\n    while (!isdigit(c)) c = getchar();\n    while (isdigit(c)) x = x * 10 + c - '0',c = getchar();\n    return x;\n}\ninline void write(LL x){ if (x > 9) write(x/10); putchar(x%10+'0'); }\ninline void writeln(LL x){ write(x),putchar('\\n'); }\n\nconst int N = 1000050;\nLL ans;\nint T,n,L,K,a[N],b[N],s[N]; // 0 -> () 1 -> (a) 2 -> (b) 3 -> (ab)\n\nint id[N];\ninline bool cmpa(int x,int y){ return a[x] > a[y]; }\ninline bool cmpb(int x,int y){ return b[x] > b[y]; }\ninline void work(int m){\n\tans = 0;\n\tstatic int i; \n\tfor (i = 1; i <= n; ++i) id[i] = i;\n\tsort(id+1,id+n+1,cmpa); for (i = 1; i <= m; ++i) ++s[id[i]],ans += a[id[i]];\n\tsort(id+1,id+n+1,cmpb); for (i = 1; i <= m; ++i) s[id[i]] += 2,ans += b[id[i]];\n}\n\nstruct NodeA{ int id; bool operator < (const NodeA x) const{ return a[id] < a[x.id]; } }tmp1;\nstruct NodeB{ int id; bool operator < (const NodeB x) const{ return b[id] < b[x.id]; } }tmp2;\nstruct NodeAB{ int id; bool operator < (const NodeAB x) const{ return a[id] + b[id] < a[x.id] + b[x.id]; } }tmp3;\npriority_queue<NodeA>H1,F1;\npriority_queue<NodeB>H2,F2;\npriority_queue<NodeAB>H3;\n\nint main(){\n\tLL v1,v2,v3,vmx;\n\tint i,j,now,c1,c2;\n\tT = read();\n\twhile (T--){\n\t\tn = read(),K = read(),L = read();\n\t\tfor (i = 1; i <= n; ++i) a[i] = read();\n\t\tfor (i = 1; i <= n; ++i) b[i] = read(),s[i] = 0;\n\t\twork(K-L); //\u5b9e\u9645\u64cd\u4f5c\u4e2d\u6211\u5e76\u6ca1\u6709\u9009\u62e9\u6d41\u6ee1CD\uff0c\u53ea\u662f\u5148\u6d41K-L\n\t\t\n\t\twhile (!H1.empty()) H1.pop();\n\t\twhile (!F1.empty()) F1.pop();\n\t\twhile (!H2.empty()) H2.pop();\n\t\twhile (!F2.empty()) F2.pop();\n\t\twhile (!H3.empty()) H3.pop();\n\t\tnow = 0;\n\t\tfor (i = 1; i <= n; ++i){\n\t\t\tif (!s[i]){\n\t\t\t\ttmp1.id = i,H1.push(tmp1);\n\t\t\t\ttmp2.id = i,H2.push(tmp2);\n\t\t\t\ttmp3.id = i,H3.push(tmp3);\n\t\t\t}\n\t\t\telse if (s[i] == 1) tmp2.id = i,H2.push(tmp2),F2.push(tmp2);\n\t\t\telse if (s[i] == 2) tmp1.id = i,H1.push(tmp1),F1.push(tmp1);\n\t\t\telse ++now;\n        //A\u3001B\u90fd\u9009\u4e86\u7684\uff0c\u6211\u4f1a\u8ba1\u5230now\u4e2d\u53bb\uff0cnow\u8868\u793aCD\u5f27\u5269\u4f59\u7684\u6d41\u91cf\u3002\n\t\t}\n\t\t\n\t\twhile (L--){ //\u6bcf\u6b21\u589e\u52a0\u4e00\u70b9\u6d41\u91cf\n\t\t\twhile (!H1.empty() && (s[H1.top().id] & 1)) H1.pop();\n\t\t\twhile (!F1.empty() && (s[F1.top().id] ^ 2)) F1.pop();\n\t\t\twhile (!H2.empty() && (s[H2.top().id] & 2)) H2.pop();\n\t\t\twhile (!F2.empty() && (s[F2.top().id] ^ 1)) F2.pop();\n\t\t\twhile (!H3.empty() && s[H3.top().id]) H3.pop();\n\t\t\t\n\t\t\tif (now){ //\u5982\u679cCD\u5f27\u6709\u6d41\u91cf\uff0c\u5c31\u9009\u4e24\u4e2a\u6700\u5927\u503c\n\t\t\t\t--now;\n\t\t\t\ti = H1.top().id,j = H2.top().id;\n\t\t\t\tans += a[i] + b[j];\n\t\t\t\ts[i] |= 1,s[j] |= 2;\n\t\t\t\tif (s[i] ^ 3) tmp2.id = i,F2.push(tmp2);\n\t\t\t\tif (s[j] ^ 3) tmp1.id = j,F1.push(tmp1); \n\t\t\t\t\n\t\t\t\tif (i == j) ++now;\n\t\t\t\telse{\n\t\t\t\t\tif (s[i] == 3) ++now; \n\t\t\t\t\tif (s[j] == 3) ++now; \n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tv1 = v2 = v3 = c1 = c2 = 0;\n\t\t\tif (!F2.empty()){ //\u7ed9B\u914d\u5bf9\n\t\t\t\ti = H1.top().id,j = F2.top().id; v1 = a[i] + b[j]; c1 = s[i] != 2 ? 1 : 0;\n\t\t\t}\n\t\t\tif (!F1.empty()){ //\u7ed9A\u914d\u5bf9\n\t\t\t\ti = F1.top().id,j = H2.top().id; v2 = a[i] + b[j]; c2 = s[j] != 3 ? 1 : 0;\n\t\t\t}\n\t\t\tif (!H3.empty()){ i = H3.top().id,v3 = a[i] + b[i]; } //\u9009\u4e00\u5bf9A+B\n\t\t\tvmx = max(v1,max(v2,v3));\n\t\t\tans += vmx;\n\t\t\t\n\t\t\t\n\t\t\tif (v1 == v2 && v1 == vmx){ \n         //\u89e3\u91ca\u4e00\u4e0b\u8fd9\u4e2a\u5224\u65ad\uff1a\n         //\u56e0\u4e3a\u5728\u8d39\u7528\u76f8\u540c\u65f6\uff0c\u7ed9CD\u5f27\u589e\u52a0\u7a7a\u4f59\u7684\u6d41\u91cf\u662f\u6bd4\u8f83\u4f18\u7684\n         //\u6240\u4ee5\u6211\u8fd8\u6bd4\u8f83\u4e86c1\u548cc2(\u4f18\u5148\u7ed9CD\u5f27\u589e\u52a0\u7a7a\u4f59\u6d41\u91cf)\n\t\t\t\tif (c1 >= c2){\n\t\t\t\t\ti = H1.top().id,j = F2.top().id;\n\t\t\t\t\ts[i] |= 1,s[j] |= 2;\n\t\t\t\t\tif (s[i] ^ 3) tmp2.id = i,F2.push(tmp2); else ++now;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\ti = F1.top().id,j = H2.top().id;\n\t\t\t\t\ts[i] |= 1,s[j] |= 2;\n\t\t\t\t\tif (s[j] ^ 3) tmp1.id = j,F1.push(tmp1); else ++now;\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (v1 == vmx){\n\t\t\t\ti = H1.top().id,j = F2.top().id;\n\t\t\t\ts[i] |= 1,s[j] |= 2;\n\t\t\t\tif (s[i] ^ 3) tmp2.id = i,F2.push(tmp2); else ++now;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (v2 == vmx){\n\t\t\t\ti = F1.top().id,j = H2.top().id;\n\t\t\t\ts[i] |= 1,s[j] |= 2;\n\t\t\t\tif (s[j] ^ 3) tmp1.id = j,F1.push(tmp1); else ++now;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (v3 == vmx) {i = H3.top().id,H3.pop(),s[i] = 3; continue;}\n\t\t}\n\t\t\n\t\twriteln(ans);\n\t}\n    return 0;\n}\n```\n\n$Upd:$ \u5bf9\u4e0d\u8d77\u4e86\u7ba1\u7406\u5458\u2026\u2026\u4e0d\u4f1a\u5199\u9898\u89e3\u6539\u4e86\u597d\u591a\u6b21\u2026\u2026\u9ebb\u70e6\u5ba1\u9898\u89e3\u7684\u7ba1\u7406\u5458\u4e86qwq\u2026\u2026",
        "postTime": 1563328462,
        "uid": 52518,
        "name": "s_r_f",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5470 \u3010[NOI2019]\u5e8f\u5217\u3011"
    },
    {
        "content": "\u8bba\u5728\u770b\u4e0d\u61c2\u9898\u89e3\u7684\u65f6\u5019\u5982\u4f55\u5316\u60b2\u6124\u4e3a\u529b\u91cf\u2026\u2026\n\n**\u672c\u7bc7\u9898\u89e3\u4f1a\u5c3d\u53ef\u80fd\u7ec6\u81f4\u5177\u4f53\u5730\u89e3\u91ca\u601d\u8def\u548c\u5199\u6cd5\uff0c\u5e76\u987a\u5e26\u63d0\u4e00\u4e0b\u6211\u81ea\u5df1\u8c03\u8bd5\u8fc7\u7a0b\u53d1\u73b0\u7684\u4e00\u4e9b\u4ee3\u7801\u7ec6\u8282\uff0c\u5e0c\u671b\u80fd\u5e2e\u5230\u5927\u5bb6\u3002**\uff08\u5e0c\u671b\u4eb2\u7231\u7684\u7ba1\u7406\u5458\u901a\u8fc7\u4e00\u4e0b\u54c8\uff09\n\n**\u7b97\u6cd5\uff1a\u8d2a\u5fc3\u6a21\u62df\u8d39\u7528\u6d41**\n\n# \u8d39\u7528\u6d41\u505a\u6cd5\n\n\u8fd9\u4e2a\u9898\u7684\u8d39\u7528\u6d41\u505a\u6cd5\u5df2\u7ecf\u6709\u4e24\u7bc7\u9898\u89e3\u90fd\u8bb2\u5230\u4e86\uff0c\u6700\u5173\u952e\u7684\u601d\u8def\u70b9\u5c31\u5728\u4e8e\u628a **\u201c\u5fc5\u987b\u81f3\u5c11\u6709 $L$ \u5bf9\u4e0b\u6807\u76f8\u540c\u201d** \u8fd9\u4e2a\u6761\u4ef6\u8f6c\u5316\u6210 **\u201c\u6700\u591a\u6709 $K-L$ \u5bf9\u4e0b\u6807\u4e0d\u76f8\u540c\u201d**\u3002\u8fd9\u5e94\u8be5\u4e5f\u662f\u672c\u9898\u6700\u5173\u952e\u7684\u7a81\u7834\u70b9\u4e86\u3002\u60f3\u5230\u4e86\u8fd9\u4e00\u70b9\uff0c\u76f8\u4fe1\u80fd\u53bb\u53c2\u52a0NOI\u7684\u9009\u624b\u4eec\u90fd\u4e0d\u96be\u60f3\u5230\u5efa\u56fe\u53d8\u6210\u7c7b\u4f3c\u4e8e\u4e8c\u5206\u56fe\u7684\u5339\u914d\u6a21\u578b\uff0c\u7136\u540e\u7528\u8d39\u7528\u6d41\u89e3\u51b3\u3002\n\n\u7136\u800c\u5f88\u663e\u7136\u65f6\u95f4\u590d\u6742\u5ea6\u8fc7\u9ad8\uff0c\u4f60\u7684\u8d39\u7528\u6d41\u662f\u4e0d\u5927\u53ef\u80fd\u8dd1\u8fc7\u6240\u6709\u6570\u636e\u7684\u3002\u5b9e\u9645\u4e0a\u666e\u901a\u7684spfa\u6c42\u6700\u77ed\u8def\u7684MCMF\u7b97\u6cd5\u5c31\u53ef\u4ee5\u8f7b\u677e\u62ff\u523064\u5206\uff08~~\u5f53\u7136\u5982\u679c\u4f60\u5728luogu\u8bc4\u6d4b\u673a\u4e0a\u8dd1\u5c31\u522b\u60f3\u4e86QAQ~~\uff09\u3002\u6240\u4ee5\u8fd9\u9053\u9898\u7684\u90e8\u5206\u5206\u7ed9\u7684\u8fd8\u662f\u633a\u53cb\u5584\u7684\u4e86\u3002\n\nLOJ 64\u5206\u4ee3\u7801\uff08\u5982\u679c\u4f60\u53bbLOJ\u63d0\u4ea4\u8981\u8bb0\u5f97\u52a0\u4e0a\u6587\u4ef6\u8f93\u5165\u8f93\u51fa\u54e6\uff09\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll; \n\ntemplate<typename T> inline void read(T &x){\n\tchar c=getchar();x=0;\n\twhile(!isdigit(c))c=getchar();\n\twhile(isdigit(c))x=x*10+c-'0',c=getchar();\n}\n\nconst int MAXN=2e5+5;\nint T, n, m1, m2;\nll a[MAXN], b[MAXN];\n\nnamespace NF{\n\tconst int N=4e3+5, V=N<<1, E=V*20;\n\tint s, t, head[V], e, to[E], fl[E], dis[E], nxt[E];\n\tint flow[E], pv[V], pe[V];\n\tll d[E], MC, MF;\n\t\n\tinline void init(int _s, int _t){\n\t\te=1;\n\t\ts=_s, t=_t;\n\t\tmemset(head, 0, sizeof(head));\n\t}\n\t\n\tinline void add_path(int u, int v, int w, ll c){\n\t\tto[++e]=v, fl[e]=w, dis[e]=c;\n\t\tnxt[e]=head[u], head[u]=e;\n\t}\n\t\n\tinline void add_edge(int u, int v, int w, ll c){\n\t\tadd_path(u, v, w, c);\n\t\tadd_path(v, u, 0, -c);\n\t}\n\t\n\tinline bool spfa(){\n\t\tstatic bool inq[N];\n\t\tstatic queue<int> q;\n\t\tmemset(d, 0x3f, sizeof(d));\n\t\td[s]=pv[s]=pv[t]=0;\n\t\tflow[s]=0x3f3f3f3f;\n\t\tq.push(s);\n\t\tinq[s]=true;\n\t\twhile(!q.empty()){\n\t\t\tint u=q.front(); q.pop(), inq[u]=false;\n\t\t\tfor(int i=head[u]; i; i=nxt[i]) if(fl[i]){\n\t\t\t\tint v=to[i], w=fl[i], c=dis[i];\n\t\t\t\tif(d[v]>d[u]+c){\n\t\t\t\t\td[v]=d[u]+c;\n\t\t\t\t\tflow[v]=min(flow[u], w);\n\t\t\t\t\tpv[v]=u, pe[v]=i;\n\t\t\t\t\tif(!inq[v]){\n\t\t\t\t\t\tq.push(v);\n\t\t\t\t\t\tinq[v]=true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn pv[t];\n\t}\n\t\n\tinline ll MCMF(){\n\t\tMF=MC=0;\n\t\twhile(spfa()){\n\t\t\tint tmp=flow[t];\n\t\t\tMF+=tmp;\n\t\t\tMC+=1ll*tmp*d[t];\n\t\t\tfor(int u=t; pv[u]; u=pv[u]){\n\t\t\t\tint i=pe[u];\n\t\t\t\tfl[i]-=tmp;\n\t\t\t\tfl[i^1]+=tmp;\n\t\t\t}\n\t\t}\n\t\treturn MC;\n\t}\n}\n\nnamespace bruteforce{\n\tint main(){\n\t\tint s=n*2+1, t=n*2+2, _s=n*2+3, p1=n*2+4, p2=n*2+5;\n\t\tNF::init(s, t);\n\t\tNF::add_edge(s, _s, m1, 0);\n\t\tNF::add_edge(p1, p2, m1-m2, 0);\n\t\tfor(int i=1; i<=n; ++i){\n\t\t\tNF::add_edge(_s, i, 1, -a[i]);\n\t\t\tNF::add_edge(i, p1, 1, 0);\n\t\t\tNF::add_edge(i+n, t, 1, -b[i]);\n\t\t\tNF::add_edge(p2, i+n, 1, 0);\n\t\t\tNF::add_edge(i, i+n, 1, 0);\n\t\t}\n\t\tprintf(\"%lld\\n\", -NF::MCMF());\n\t\treturn 0;\n\t}\n}\n\nint main(){\n//\tfreopen(\"sequence.in\", \"r\", stdin);\n//\tfreopen(\"sequence.out\", \"w\", stdout);\n\tread(T);\n\twhile(T--){\n\t\tread(n);read(m1);read(m2);\n\t\tfor(int i=1; i<=n; ++i)\n\t\t\tread(a[i]);\n\t\tfor(int i=1; i<=n; ++i)\n\t\t\tread(b[i]);\n\t\tif(n<=2000) bruteforce::main();\n\t}\n\treturn 0;\n}\n```\n\n\n# \u8d2a\u5fc3\u6a21\u62df\u8d39\u7528\u6d41\n\n\u5982\u4f55\u63d0\u9ad8\u8d39\u7528\u6d41\u6548\u7387\uff1f\u6211\u4eec\u6709\u4e2a\u53eb\u201c\u6a21\u62df\u8d39\u7528\u6d41\u201d\u7684\u4e1c\u897f\u3002\u8bf4\u767d\u4e86\uff0c\u6211\u5bf9\u6a21\u62df\u8d39\u7528\u6d41\u7684\u7406\u89e3\u5c31\u662f\uff0c\u5728\u7279\u6b8a\u6761\u4ef6\u5141\u8bb8\u4e0b\uff0c**\u7528\u8d2a\u5fc3\u6765\u53d6\u4ee3spfa\u627e\u6700\u77ed\u8def\uff0c\u7528\u5404\u79cd\u624b\u6bb5\uff08\u4ee3\u4ef7\u53d6\u53cd\u3001\u5206\u7c7b\u8ba8\u8bba\u7b49\u7b49\uff09\u6765\u6a21\u62df\u9000\u6d41\u8fc7\u7a0b**\u3002\n\n\u90a3\u4e48\u6765\u770b\u4e00\u4e0b\u8fd9\u9053\u9898\u5982\u4f55\u6a21\u62df\u8d39\u7528\u6d41\u3002\n\n- \u9996\u5148\uff0c\u4e0d\u96be\u5f97\u51fa\uff0c**\u201c\u81ea\u7531\u6d41\u201d\u4e5f\u5c31\u662f\u968f\u610f\u914d\u5bf9\u7684\u65b9\u6848\u4e00\u5b9a\u4e0d\u4f1a\u6bd4\u5176\u4ed6\u65b9\u6848\u66f4\u52a3**\uff0c\u90a3\u4e48\u6211\u4eec\u5728\u80fd\u6d41\u81ea\u7531\u6d41\u7684\u65f6\u5019\u5c31\u6d41\u81ea\u7531\u6d41\u3002\n\n\u5982\u4f55\u6a21\u62df\u6d41\u81ea\u7531\u6d41\uff1f\u663e\u7136\u5728\u8fd8\u672a\u88ab\u914d\u5bf9\u7684 $a$ \u548c $b$ \u91cc\u5934\u5404\u9009\u4e00\u4e2a\u6700\u5927\u503c\u5c31\u597d\u4e86\u3002\n\n\u4f46\u662f\uff0c\u5982\u679c\u9009\u51fa\u6765\u7684 $a_i$ \u548c $b_j$ \u6ee1\u8db3 $i=j$ \u7684\u8bdd\uff0c\u6839\u636e\u4e0a\u9762\u7684\u81ea\u7531\u6d41\u6700\u4f18\u5b9a\u7406\uff0c\u8fd9\u65f6\u5019\u6362\u6210\u6d41\u201c\u9650\u5236\u6d41\u201d\uff0c\u800c\u628a\u8fd9\u4e2a\u81ea\u7531\u6d41\u7684\u673a\u4f1a\u7559\u7ed9\u540e\u9762\uff0c\u4e00\u5b9a\u4e0d\u4f1a\u66f4\u52a3\u3002\n\n- \u7b2c\u4e8c\uff0c\u8003\u8651\u6d41\u201c\u9650\u5236\u6d41\u201d\uff0c\u4e5f\u5c31\u662f\u9009\u53d6\u6700\u5927\u7684\u4e00\u5bf9\u4e0b\u6807\u76f8\u7b49\u7684 $a_i$ \u548c $b_i$\u3002\n\n\u5982\u4f55\u6a21\u62df\uff1f\u663e\u7136\u5728 $a_i$ \u548c $b_i$ \u5747\u8fd8\u672a\u88ab\u914d\u5bf9\u7684\u4e0b\u6807 $i$ \u4e2d\u9009\u62e9\u4e00\u4e2a  $a_i+b_i$ \u6700\u5927\u7684\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u8bf7\u6ce8\u610f\uff0c\u4e0b\u9762\u7684\u4e24\u79cd\u65b9\u5f0f\u6d89\u53ca\u5230**\u6a21\u62df\u9000\u6d41**\u4e86\uff01\n\n- \u7b2c\u4e09\uff0c**\u9009\u62e9\u4e00\u4e2a $a_i$ \u5df2\u88ab\u914d\u5bf9\uff0c\u800c $b_i$ \u8fd8\u672a\u88ab\u914d\u5bf9\u7684\u4e0b\u6807 $i$ \uff0c\u5e26\u4e0a\u4e00\u4e2a $a_k$ \u8fd8\u672a\u88ab\u914d\u5bf9\u7684\u4e0b\u6807 $k$ \u3002** \uff08\u8ba4\u771f\u7406\u89e3\uff09\n\n\u6b64\u6b65\u975e\u5e38\u5173\u952e\uff0c\u8ba9\u6211\u4eec\u597d\u597d\u5206\u6790\u4e00\u4e0b\u7a76\u7adf\u53d1\u751f\u4e86\u4ec0\u4e48\u3002\n\n\u753b\u4e2a\u56fe\u5c31\u5f88\u6e05\u6670\u4e86\u3002\u6700\u5f00\u59cb\u662f\u8fd9\u6837\u7684\uff1a\n\n![1](https://cdn.luogu.com.cn/upload/image_hosting/ue55md72.png)\n\n\u7136\u800c\u4e4b\u540e\u53d8\u6210\u4e86\u8fd9\u6837\uff1a\n\n![2](https://cdn.luogu.com.cn/upload/image_hosting/a0rbl2lw.png)\n\n\u90a3\u4e48\u5206\u6790\u6613\u5f97\uff0c\u8fd9\u4e00\u6b21\u8f6c\u53d8\u7684\u7ed3\u679c\u662f\u589e\u52a0\u4e86\u4e00\u5bf9\u4e0b\u6807\u76f8\u540c\u7684\u5339\u914d\uff0c\u800c\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e3a $a_k+b_i$ \uff0c\u90a3\u4e48\u6839\u636e\u201c\u8d2a\u5fc3\u201d\u7684\u539f\u5219\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5206\u522b\u627e\u5230\u6700\u5927\u7684 $a_k$ \u548c $b_i$ \u5373\u53ef\u3002\n\n- \u7b2c\u56db\uff0c\u4e5f\u5c31\u662f\u60c5\u51b5\u4e09\u7684\u5bf9\u5076\u60c5\u51b5\uff0c**\u9009\u62e9\u4e00\u4e2a $b_j$ \u5df2\u88ab\u914d\u5bf9\uff0c\u800c $a_j$ \u8fd8\u672a\u88ab\u914d\u5bf9\u7684\u4e0b\u6807 $j$ \uff0c\u5e26\u4e0a\u4e00\u4e2a $b_k$ \u8fd8\u672a\u88ab\u914d\u5bf9\u7684\u4e0b\u6807 $k$ \u3002**\n\n\u540c\u6837\u8fd8\u662f\u7ed9\u4e2a\u56fe\u65b9\u4fbf\u7406\u89e3\u3002\u5148\u662f\u8fd9\u6837\uff1a\n\n![3](https://cdn.luogu.com.cn/upload/image_hosting/7nunwm1e.png)\n\n\u53d8\u6210\u4e86\u8fd9\u6837\uff1a\n\n![4](https://cdn.luogu.com.cn/upload/image_hosting/6eooptmy.png)\n\n\u540c\u60c5\u51b5\u4e09\uff0c\u8fd9\u4e00\u6b21\u8f6c\u53d8\u7684\u7ed3\u679c\u4e5f\u662f\u589e\u52a0\u4e86\u4e00\u5bf9\u4e0b\u6807\u76f8\u540c\u7684\u5339\u914d\uff0c\u800c\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e3a $a_j+b_k$ \uff0c\u90a3\u4e48\u6839\u636e\u201c\u8d2a\u5fc3\u201d\u7684\u539f\u5219\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5206\u522b\u627e\u5230\u6700\u5927\u7684 $a_j$ \u548c $b_k$ \u5373\u53ef\u3002\n\n\u8fd9\u4e2a\u65f6\u5019\uff0c\u6211\u4eec\u4e5f\u5c31\u8003\u8651\u5468\u5168\u4e86\u5b9e\u9645\u8d39\u7528\u4e2d\u7684\u51e0\u79cd\u6d41\u60c5\u51b5\uff0c\u6a21\u62df\u51fa\u4e86\u201c\u9000\u6d41\u201d\u8fc7\u7a0b\uff0c\u8fbe\u5230\u4e86\u4e0d\u65ad\u201c\u4f18\u5316\u8c03\u6574\u5339\u914d\u201d\u7684\u76ee\u7684\uff0c\u6545\u6b63\u786e\u6027\u5f97\u5230\u4fdd\u8bc1\uff0c\u53ef\u4ee5\u5f00\u59cb\u5199\u4e86\u3002\n\n\u7136\u800c\u6211\u8ba4\u4e3a\u8fd9\u9053\u9898\u7684\u96be\u5ea6\u8fd8\u4e0d\u5c11\u5728\u5b9e\u73b0\u4e0a\uff08~~\u5426\u5219\u8fdb\u4e0d\u4e86NOI~~\uff09\uff0c\u8ba9\u6211\u4eec\u4e00\u8d77\u4ed4\u7ec6\u60f3\u4e00\u60f3\u600e\u4e48\u5b9e\u73b0\u4e0a\u8ff0\u7b97\u6cd5\u3002\n\n- \u6709\u9891\u7e41\u5730\u6839\u636e\u503c\u6765\u9009\u4e0b\u6807\u7684\u64cd\u4f5c\uff0c\u4e8e\u662f\u53ef\u4ee5\u7528stl\u4f18\u5148\u961f\u5217\u6a21\u62df\u6b64\u64cd\u4f5c\uff0c\u5177\u4f53\u5730\u5c31\u662f\n\n```cpp\npriority_queue< pair<int, int> >  \n```\n\npair\u7b2c\u4e00\u7ef4\u5b58\u6743\u503c\uff0c\u7b2c\u4e8c\u7ef4\u5b58\u4e0b\u6807\u3002\n\n- \u60c5\u51b5\u4e00\uff0c\u9700\u8981\u77e5\u9053\u672a\u88ab\u5339\u914d\u7684\u6700\u5927\u7684 $a$ \u548c $b$ \u53ca\u5176\u4e0b\u6807\uff0c\u4e8e\u662f\u6211\u4eec\u4ee4\u5806 A0 \uff0cB0 \u5206\u522b\u5b58\u8fd8\u672a\u88ab\u914d\u5bf9\u7684 $a$ \u548c $b$ \u3002\n\n- \u60c5\u51b5\u4e8c\uff0c\u9700\u8981\u77e5\u9053\u672a\u88ab\u914d\u5bf9\u7684\u6700\u5927\u7684 $a_i+b_i$ \uff0c\u4e8e\u662f\u6211\u4eec\u4ee4\u5806 AB \u5b58\u672a\u88ab\u914d\u5bf9\u7684 $a_i+b_i$\n\n- \u60c5\u51b5\u4e09\u548c\u56db\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u77e5\u9053\u201c$b_i/a_i$ \u5df2\u7ecf\u88ab\u914d\u5bf9\u800c $a_i/b_i$ \u8fd8\u672a\u88ab\u914d\u5bf9\u4e14 $a_i/b_i$ \u6700\u5927\u7684\u4e0b\u6807 $i$\u201d\uff0c\u4e8e\u662f\u6211\u4eec\u5206\u522b\u7528\u5806 A1, B1 \u6765\u5b58\u4e0a\u8ff0\u4e24\u79cd\u60c5\u51b5\n\n\u7efc\u4e0a\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4f18\u5316\u5230\u4e86 $O(n\\log n)$\n\n\u597d\uff0c\u8fd9\u65f6\u5019\u6211\u5c31\u5174\u51b2\u51b2\u5730\u6253\u5b8c\u4e86\u4ee3\u7801\uff0c\u4e00\u6b21\u8fc7\u4e86~~\u51fa\u9898\u4eba\u62ff\u811a\u51fa\u7684~~\u6837\u4f8b\uff0c\u7136\u540e\u63d0\u4ea4\u2026\u2026\u554a\uff0c\u53ea\u67094 pts \uff1f\uff1f\uff01\uff1f\n\n\u8fd9\u592a\u620f\u5267\u6027\u4e86\uff0c\u4f46\u662f\u4e0d\u8981\u614c\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u62cd\uff0c\u6211\u5c31\u628a\u6211\u5199\u7684\u8d39\u7528\u6d41\u62ff\u6765\u5bf9\u62cd\uff0c\u7ecf\u8fc7\u534a\u4e2a\u4e0b\u5348+\u4e00\u4e2a\u665a\u4e0a\u7684\u8270\u82e6\u594b\u6597\uff0c\u7ec8\u4e8e\u628a\u8fd9\u4efd\u6f0f\u6d1e\u767e\u51fa\u7684\u4ee3\u7801\u8c03 AC \u4e86\u3002\u4e8e\u662f\u4e0b\u9762\u8bb2\u51e0\u4e2a\u5b9e\u73b0\u7684\u7ec6\u8282\u3002\n\n- \u6211\u4eec\u4e2d\u95f4\u4f1a\u6d89\u53ca\u5230\u4e00\u4e9b\u5143\u7d20\u88ab\u914d\u5bf9\uff0c\u90a3\u4e48\u4ed6\u4eec\u5c31\u5e94\u8be5\u4ece\u4ed6\u4eec\u6240\u5728\u7684\u5806\u4e2d\u5220\u9664\uff0c\u8fd9\u4e2a\u65f6\u5019\u53ef\u4ee5\u7528\u4e00\u4e2a\u6570\u7ec4\u6253\u6807\u8bb0\uff0c\u60f0\u6027\u5220\u9664\u3002\n\n- **\u6ce8\u610f\uff0c\u8fd9\u4e00\u70b9\u975e\u5e38\u91cd\u8981\uff01**\n\n\u6211\u4eec\u4f1a\u53d1\u73b0\u6709\u65f6\u5019\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\uff1a\n\n![5](https://cdn.luogu.com.cn/upload/image_hosting/9ksggcr0.png)\n\n\u663e\u7136\u8fd9\u6837\u6539\u4e00\u4e0b\u4f1a\u66f4\u4f18\uff0c\u817e\u51fa\u4e00\u4e2a\u81ea\u7531\u6d41\uff1a\n\n![6](https://cdn.luogu.com.cn/upload/image_hosting/shxragtp.png)\n\n**\u8fd9\u79cd\u8c03\u6574\u4e0d\u4f1a\u6539\u53d8\u5f53\u524d\u7684\u7b54\u6848\uff0c\u4e5f\u4e0d\u4f1a\u6539\u53d8\u5143\u7d20\u5728\u5806\u4e2d\u7684\u5206\u5e03\u60c5\u51b5\uff0c\u53ea\u4f1a\u8fd8\u4e00\u4e2a\u4e00\u4e2a\u81ea\u7531\u6d41\u3002**\n\n\u6211\u4eec\u628a\u8fd9\u4e2a\u64cd\u4f5c\u53eb\u505a\u201cadjust\u201d\uff0c\u5728\u4ee3\u7801\u4e2d\u5c31\u662f\u8fd9\u4e2a\u51fd\u6570\u3002\n\n\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u64cd\u4f5c\u4e0d\u5149\u9700\u8981\u77e5\u9053\u54ea\u4e9b\u70b9\u88ab\u914d\u5bf9\u4e86\uff0c\u8fd8\u8981\u77e5\u9053\u6bcf\u4e2a\u914d\u5bf9\u7684\u70b9\u5339\u914d\u7684\u662f\u54ea\u4e2a\u70b9\u3002\u4e8e\u662f\uff0c\u6211\u4eec\u628a\u4e0a\u4e00\u70b9\u8bf4\u5230\u7684\u6253\u6807\u8bb0\u7528\u6765\u60f0\u6027\u5220\u9664\u7684\u6570\u7ec4\u6539\u6210\u4e00\u4e2a int \u578b\u7684\u5339\u914d\u6570\u7ec4\u5c31\u53ef\u4ee5\u4e86\uff0c\u90a3\u4e48\u6ce8\u610f\u5728\u5176\u4ed6\u7684\u64cd\u4f5c\u4e2d\u90fd\u8981\u5bf9\u8fd9\u4e2a\u6570\u7ec4\u5c0f\u5fc3\u5730\u8fdb\u884c\u7ef4\u62a4\uff0c\u800c\u4e0d\u662f\u50cf\u4ee5\u524d\u4e00\u6837\u53ea\u7b80\u5355\u7684\u6253\u4e2a\u6807\u8bb0\u5c31\u884c\u3002\n\n\u5728\u8003\u8651\u4ec0\u4e48\u65f6\u5019\u8981 adjust \uff0c\u5f88\u663e\u7136\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u9488\u5bf9\u7684\u662f\u88ab\u81ea\u7531\u5339\u914d\u7684\u70b9\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u5728\u6bcf\u51fa\u73b0\u81ea\u7531\u6d41\u7684\u65f6\u5019\u505a\u8fd9\u4e2a\u64cd\u4f5c\u5c31\u884c\u4e86\u3002\u89c2\u5bdf\u4e4b\u524d\u753b\u7684\u56fe\uff0c\u53d1\u73b0\u60c5\u51b5\u4e00\u76f4\u63a5\u6d41\u81ea\u7531\u6d41\u548c\u60c5\u51b5\u4e09\u548c\u56db\u4f1a\u6539\u53d8\u539f\u6765\u7684\u81ea\u7531\u6d41\uff0c\u5728\u8fd9\u51e0\u4e2a\u60c5\u51b5\u5904\u7406\u540e\u5bf9\u76f8\u5e94\u7684\u4e0b\u6807 adjust \u4e00\u4e0b\u5c31\u597d\u4e86\u3002\n\n- \u5173\u4e8e\u7ef4\u62a4\u81ea\u7531\u6d41\u6d41\u91cf\uff1a\n\n\u56e0\u4e3a\u6211\u4eec\u64cd\u4f5c\u65f6\u6709\u4e00\u4e2a**\u4f18\u5148\u6d41\u81ea\u7531\u6d41**\u7684\u51b3\u7b56 \u6240\u4ee5\u8981\u5f00\u4e00\u4e2a\u53d8\u91cf Free \u6765\u8bb0\u5f55**\u5f53\u524d\u8fd8\u6709\u591a\u5c11\u4e2a\u81ea\u7531\u6d41\u53ef\u4ee5\u6d41**\u3002\n\n1. \u6bcf\u6b21\u60c5\u51b5\u4e00\u6d41\u4e00\u4e2a\u81ea\u7531\u6d41\u7684\u65f6\u5019\uff0c\u5224\u65ad\u5982\u679c\u4e24\u8fb9\u9009\u7684\u662f\u4e0d\u76f8\u7b49\u7684\u4e0b\u6807\u5c31\u8981\u628a Free \u51cf\u4e00\u3002\n\n2. \u6bcf\u6b21 adjust \u65f6\u5019\uff0c\u6ce8\u610f Free **\u81f3\u5c11\u4f1a+1**\uff0c\u5982\u679c $j=k$ \uff0c\u5c31\u8fd8\u8981\u518d +1\u3002\n\n3. \u4f46\u662f\uff0c\u60c5\u51b5\u4e09\u548c\u56db\uff0c\u4e5f\u8981\u6ce8\u610f\uff01\u5206\u522b\u5bf9\u5e94\u4e4b\u524d\u8bb2\u8fd9\u4e24\u79cd\u60c5\u51b5\u7684\u60c5\u666f\u56fe\uff0c\u5f53 $j=k$ \u6216 $i=k$ \u7684\u65f6\u5019\uff0c\u8fd0\u6c14\u975e\u5e38\u597d\u5730\u628a\u81ea\u7531\u6d41\u6d88\u6389\u4e86\uff0cFree\u4e5f\u8981+1\u3002\n\n\u597d\u5566\uff0c\u5176\u4ed6\u5c31\u6ca1\u4ec0\u4e48\u96be\u70b9\u4e86\uff0c\u628a\u4ee3\u7801\u653e\u51fa\u6765\uff0c\u91cc\u5934\u6709\u5f88\u591a\u6ce8\u91ca\uff0c\u8fd9\u4e5f\u5e94\u8be5\u662f\u6bd4\u8f83\u597d\u61c2\u7684\u4e00\u4efd\u4ee3\u7801\u4e86\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define mkp make_pair\n#define ft first\n#define sd second\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef priority_queue< pair<int, int> > heap;\n\ntemplate<class T> inline void read(T& x){\n\tchar c=getchar();x=0;\n\twhile(!isdigit(c))c=getchar();\n\twhile(isdigit(c))x=x*10+c-'0',c=getchar();\n}\n\nconst int N=2e5+5;\n\nint T, n, K, L, a[N], b[N], Free, now, type;\nll ans;\nheap A0, A1, B0, B1, AB;\n//A0, B0: \u6ca1\u88ab\u9009\u7684\u7684a,b\n//A1, B1: \u5df2\u7ecf\u88ab\u9009\u4e86\u5bf9\u5e94\u7684b/a\u4f46\u81ea\u5df1\u6ca1\u88ab\u9009\u7684a/b\n//AB: a,b\u90fd\u6ca1\u88ab\u9009\u7684\u7ec4\u5408\nint mcha[N], mchb[N];\n//mcha[i]: a[i]\u5339\u914d\u7684b[j]\u7684\u4e0b\u6807j\n//mchb[i]: b[i]\u5339\u914d\u7684a[j]\u7684\u4e0b\u6807j\n\ninline void del_AB(){//\u540c\u65f6\u6839\u636ea\uff0cb\u7684\u5339\u914d\u60c5\u51b5\u6765\u5220\u9664\u5806AB\u4e2d\u7684\u5143\u7d20 \n\twhile(!AB.empty()){\n\t\tint i=AB.top().sd;\n\t\tif(mcha[i]||mchb[i]) AB.pop();\n\t\telse break;\n\t}\n}\ninline void del_A(heap& A){//\u6839\u636ea\u7684\u5339\u914d\u60c5\u51b5\u6765\u5220\u9664\u5806A0\u6216A1\u4e2d\u7684\u5143\u7d20 \n\twhile(!A.empty()){\n\t\tint i=A.top().sd;\n\t\tif(mcha[i]) A.pop();\n\t\telse break;\n\t}\n}\ninline void del_B(heap& B){//\u6839\u636eb\u7684\u5339\u914d\u60c5\u51b5\u6765\u5220\u9664\u5806B0\u6216B1\u4e2d\u7684\u5143\u7d20 \n\twhile(!B.empty()){\n\t\tint i=B.top().sd;\n\t\tif(mchb[i]) B.pop();\n\t\telse break; \n\t}\n}\n\ninline void adjust(int i){//\u6838\u5fc3\uff1a\u8c03\u6574\u64cd\u4f5c \n\tif(!mcha[i]||!mchb[i]||mcha[i]==i) return;\n\tint j=mcha[i], k=mchb[i];\n\tmcha[i]=mchb[i]=i, ++Free;//\u817e\u51fa\u81ea\u7531\u6d41 \n\tmcha[k]=j, mchb[j]=k;\n\tif(k==j) ++Free;\n}\ninline void free_match(){//\u81ea\u7531\u914d\u5bf9\n\tdel_A(A0), del_B(B0);\n\tint i=A0.top().sd, j=B0.top().sd;\n\tans+=1ll*(a[i]+b[j]);\n\tmcha[i]=j, mchb[j]=i;\n\tif(i!=j){\n\t\t--Free;//\u6d88\u8017\u81ea\u7531\u6d41 \n\t\tif(!mcha[j]) A1.push(mkp(a[j], j));\n\t\tif(!mchb[i]) B1.push(mkp(b[i], i));\n\t}\n\tadjust(i), adjust(j);//\u8bb0\u5f97\u505a\u8c03\u6574 \n}\ninline void work1(){//\u9009\u4e00\u5bf9a[i]+b[i]\n\tdel_AB();\n\tif(!AB.empty()){\n\t\tint i=AB.top().sd;\n\t\tif(a[i]+b[i]>now){\n\t\t\tnow=a[i]+b[i];\n\t\t\ttype=1;\n\t\t}\n\t}\n}\ninline void work2(){//a[i]+b[j] -> a[i]+b[i], a[k]+b[j]\n\tdel_B(B1), del_A(A0);\n\tif(B1.empty()) return;\n\tint i=B1.top().sd, k=A0.top().sd;\n\tif(a[k]+b[i]>now){\n\t\tnow=a[k]+b[i];\n\t\ttype=2;\n\t}\n}\ninline void work3(){//a[i]+b[j] -> a[j]+b[j], a[i]+b[k]\n\tdel_A(A1), del_B(B0);\n\tif(A1.empty()) return;\n\tint j=A1.top().sd, k=B0.top().sd;\n\tif(a[j]+b[k]>now){\n\t\tnow=a[j]+b[k];\n\t\ttype=3;\n\t}\n}\ninline void update1(){//\u9009\u62e9\u4e86\u60c5\u51b5\u4e00\u540e\u7684\u66f4\u65b0\u64cd\u4f5c \n\tint i=AB.top().sd;\n\tmcha[i]=mchb[i]=i;\n}\ninline void update2(){//\u9009\u62e9\u4e86\u60c5\u51b5\u4e8c\u540e\u7684\u66f4\u65b0\u64cd\u4f5c \n\tint i=B1.top().sd, k=A0.top().sd, j=mcha[i];\n\tmcha[i]=mchb[i]=i;\n\tmcha[k]=j, mchb[j]=k;\n\tif(j==k) ++Free;//\u817e\u51fa\u81ea\u7531\u6d41 \n\tif(!mchb[k]) B1.push(mkp(b[k], k));\n\tadjust(j), adjust(k); \n}\ninline void update3(){//\u9009\u62e9\u4e86\u60c5\u51b5\u4e09\u540e\u7684\u66f4\u65b0\u64cd\u4f5c \n\tint j=A1.top().sd, k=B0.top().sd, i=mchb[j];\n\tmcha[j]=mchb[j]=j;\n\tmcha[i]=k, mchb[k]=i;\n\tif(i==k) ++Free;\n\tif(!mcha[k]) A1.push(mkp(a[k], k));\n\tadjust(i), adjust(k);\n}\n\ninline void cls(){//\u591a\u6d4b\u6e05\u7a7a \n\tans=0;\n\twhile(!A0.empty()) A0.pop();\n\twhile(!A1.empty()) A1.pop();\n\twhile(!B0.empty()) B0.pop();\n\twhile(!B1.empty()) B1.pop();\n\twhile(!AB.empty()) AB.pop();\n\tmemset(mcha, 0, sizeof(mcha));\n\tmemset(mchb, 0, sizeof(mchb));\n}\n\nint main(){\n//\tfreopen(\"sequence.in\", \"r\", stdin);\n//\tfreopen(\"sequence.out\", \"w\", stdout);\n\n\tread(T);\n\twhile(T--){\n\n\t\tcls();\n\n\t\tread(n);read(K);read(L);\n\t\tfor(int i=1; i<=n; ++i)\n\t\t\tread(a[i]);\n\t\tfor(int i=1; i<=n; ++i)\n\t\t\tread(b[i]);\n\t\t\n\t\tFree=K-L;//\u521d\u59cb\u5316\u81ea\u7531\u6d41\u6570\u91cf \n\t\tfor(int i=1; i<=n; ++i){\n\t\t\tA0.push(mkp(a[i], i));\n\t\t\tB0.push(mkp(b[i], i));\n\t\t\tAB.push(mkp(a[i]+b[i], i));\n\t\t}\n\t\t\n\t\twhile(K--){\n\t\t\tif(Free){//\u4f18\u5148\u81ea\u7531\u914d\u5bf9\n\t\t\t\tfree_match();\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tnow=0, type=0;\n\t\t\twork1();//\u9009\u4e00\u5bf9a[i]+b[i]\n\t\t\twork2();//a[i]+b[j] -> a[i]+b[i], a[k]+b[j]\n\t\t\twork3();//a[i]+b[j] -> a[j]+b[j], a[i]+b[k]\n\t\t\tans+=1ll*now;\n\t\t\tif(type==1) update1();\n\t\t\telse if(type==2) update2();\n\t\t\telse update3();\n\t\t}\n\t\t\n\t\tprintf(\"%lld\\n\", ans);\n\n\t}\n\n\treturn 0;\n}\n```\n\n# \u540e\u8bb0\n\n\u8fd9\u662f\u6211NOI2019\u7684\u9898\u76ee\u4e2dAC\u7684\u7b2c\u56db\u9053\u9898\uff0c\u867d\u7136\u5728NOI\u91cc\u4e0d\u80fd\u7b97\u96be\u9898\uff0c\u53ef\u80fd\u5927\u4f6c\u4eec\u5199\u8d77\u6765\u89c9\u5f97\u633a\u8f7b\u677e\uff08\u6240\u4ee5\u5927\u4f6c\u7684\u9898\u89e3\u8bed\u8a00\u7b80\u6d01\u4ee3\u7801\u7075\u52a8\uff0c\u849f\u84bb\u770b\u4e0d\u61c2QAQ\uff09\uff0c\u4f46\u662f\u8fd8\u662f\u633a\u6709\u611f\u89e6\u7684\u3002\u6709\u65f6\u5019\u4f60\u4e00\u5473\u60f3\u7740\u770b\u9898\u89e3\u5374\u53ef\u80fd\u4e00\u65e0\u6240\u83b7\uff08\u9003\uff09\u3002\u6240\u4ee5\u5199\u4e86\u8fd9\u7bc7\u6bd4\u8f83\u5b8c\u6574\u800c\u7ec6\u81f4\u7684\u9898\u89e3\uff0c\u5e0c\u671b\u80fd\u5e2e\u5230\u5927\u5bb6\u3002\u7136\u800c\u5982\u679c\u770b\u4e86\u8fd9\u7bc7\u9898\u89e3\u4f60\u8fd8\u662f\u6ca1\u6709\u61c2\uff08~~\u5e94\u8be5\u4e0d\u4f1a\u5427\u554a\uff1f~~\uff09\uff0c\u90a3\u4f60\u4e0d\u59a8\u60f3\uff1a\n\n**\u6709\u65f6\u56f0\u5883\u4e0d\u4f1a\u5bf9\u4f60\u7684\u5782\u9996\u4e5e\u601c\u5fc3\u751f\u607b\u9690\uff0c\u53ea\u4f1a\u56e0\u4f60\u7684\u8fce\u96be\u800c\u4e0a\u8083\u7136\u8d77\u656c\u3002**\n\n\u597d\u5566\uff0c\u8fd9\u7bc7\u9898\u89e3\u5230\u6b64\u7ed3\u675f\u4e86\uff0c\u6765\u4e86\u5c31\u70b9\u4e2a\u8d5e\uff08~~\u6216\u8005\u8e29\u4e00\u811a~~\uff09\u518d\u8d70\u5457\u3002\n\n\u7531\u4e8e\u8fd9\u662f\u6211\u81ea\u5df1\u80e1\u641e\u51fa\u6765\u7684\u89e3\u6cd5\uff0c\u5982\u679c\u60a8\u8fd8\u6709\u4ec0\u4e48\u7591\u95ee\u6216\u662f\u5efa\u8bae\uff0c\u6b22\u8fce\u5230\u8bc4\u8bba\u533a\u7559\u8a00\uff0c\u6211\u4f1a\u5c3d\u529b\u56de\u590d\uff1b\u5982\u679c\u60a8\u53d1\u73b0\u4e86\u6211\u7684\u6f0f\u6d1e\uff0c\u4e5f\u6b22\u8fce\u5230\u8bc4\u8bba\u533a\u6307\u51fa\u6216 hack \uff0c\u6211\u4f1a\u8ba4\u771f\u6539\u6b63\uff01\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "postTime": 1594564157,
        "uid": 68203,
        "name": "wyt2357",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5470 \u3010[NOI2019]\u5e8f\u5217\u3011"
    },
    {
        "content": "\u611f\u89c9\u8fd9\u9898\u8ddfCF436E\u5dee\u4e0d\u591a ~~\uff08\u751a\u81f3\u66f4\u7b80\u5355\uff09~~\n\n### \u4e00\u4e36\u601d\u8def\n\n\u9996\u5148\u6709\u4e00\u79cd\u6bd4\u8f83\u7b28\u6bd4\u7684\u8d2a\u5fc3\uff0c\u5c31\u662f\u76f4\u63a5\u628a$a$\u6570\u7ec4\u548c$b$\u6570\u7ec4\u7684\u6700\u5927\u7684$K$\u4e2a\u9009\u51fa\u6765\uff0c\u4f46\u662f\u8fd9\u6837\u5e76\u4e0d\u80fd\u6ee1\u8db3\u6709$L$\u4e2a\u4e0b\u6807\u76f8\u540c\u7684\u6761\u4ef6\u3002\n\n\u6309\u7167\u53cd\u6094\u8d2a\u5fc3\u7684\u5957\u8def\uff0c\u8003\u8651\u6784\u9020\u51e0\u79cd\u66ff\u6362\u65b9\u6848\uff0c\u4f7f\u5f97**\u6bcf\u6b21\u4ea4\u96c6+1\uff0c\u5e76\u4e14\u80fd\u591f\u8986\u76d6\u6240\u6709\u53ef\u80fd\u7684\u60c5\u51b5**\uff0c\u4ed4\u7ec6\u601d\u8003\u6709\u8fd9\u4e48\u51e0\u79cd\u60c5\u51b5\uff1a\n\n1.\u5c06\u4e00\u4e2a\u9009\u4e86$b$\u4f46\u6ca1\u9009$a$\u7684\u4f4d\u7f6e$x$\u5c06$a$\u9009\u4e0a\uff0c\u5e76\u627e\u5230\u4e00\u4e2a\u6ca1\u9009$b$\u4f46\u9009\u4e86$a$\u7684\u4f4d\u7f6e$y$\u5c06$a$\u9000\u6389\u3002\u8fd9\u6837\u7684\u4ee3\u4ef7\u662f$a_x-a_y$\u3002\n\n2.\u5c06\u4e00\u4e2a\u9009\u4e86$a$\u4f46\u6ca1\u9009$b$\u7684\u4f4d\u7f6e$x$\u5c06$b$\u9009\u4e0a\uff0c\u5e76\u627e\u5230\u4e00\u4e2a\u6ca1\u9009$a$\u4f46\u9009\u4e86$b$\u7684\u4f4d\u7f6e$y$\u5c06$b$\u9000\u6389\u3002\u8fd9\u6837\u7684\u4ee3\u4ef7\u662f$b_x-b_y$\u3002\n\n\n3.\u627e\u5230\u4e00\u4e2a\u9009\u4e86$a$\u4f46\u6ca1\u9009$b$\u7684\u4f4d\u7f6e$x$\uff0c\u4e00\u4e2a\u9009\u4e86$b$\u4f46\u6ca1\u9009$a$\u7684\u4f4d\u7f6e$y$\uff0c\u4ee5\u53ca$a,b$\u90fd\u6ca1\u9009\u7684\u4f4d\u7f6e$z$\uff0c\u5c06$x,y$\u9009\u7684\u90fd\u9000\u6389\uff0c\u5e76\u5c06$z$\u7684$a,b$\u90fd\u9009\u4e0a\u3002\u8fd9\u6837\u7684\u4ee3\u4ef7\u662f$a_z+b_z-a_x-b_y$\n\n4.\u627e\u5230\u4e00\u4e2a\u9009\u4e86$a$\u4f46\u6ca1\u9009$b$\u7684\u4f4d\u7f6e$x$\uff0c\u4e00\u4e2a\u9009\u4e86$b$\u4f46\u6ca1\u9009$a$\u7684\u4f4d\u7f6e$y$\uff0c\u4ee5\u53ca$a,b$\u90fd\u9009\u4e86\u7684\u4f4d\u7f6e$z$\uff0c\u5c06$z$\u7684$a,b$\u90fd\u9000\u6389\uff0c\u5e76\u9009\u4e0a$x$\u7684$b$\uff0c$y$\u7684$a$\u3002\u8fd9\u6837\u7684\u4ee3\u4ef7\u662f$b_x+a_y-(a_z+b_z)$\u3002\n\n\n\u5bf9\u4e8e\u8fd9\u51e0\u79cd\u60c5\u51b5\u5206\u522b\u7ef4\u62a4\u4f18\u5148\u961f\u5217\u5373\u53ef\u3002\u6ce8\u610f\u5728\u5199\u7684\u65f6\u5019\u5efa\u8bae\u4e0d\u8981\u5728\u6539\u53d8\u72b6\u6001\u65f6pop\uff0c\u800c\u662f\u5728\u53d6\u51fa\u6781\u503c\u65f6\u5c06\u4e0d\u5408\u6cd5\u60c5\u51b5pop\u6389\u3002\n\n\u5177\u4f53\u7ef4\u62a4\u53ef\u4ee5\u770b\u4ee3\u7801\u3002\n\n### \u4e8c\u4e36\u4ee3\u7801\n\n```cpp\n//W4P3R\n#include<bits/stdc++.h>\n#define inf 1e18\n#define eps 1e-6\n#define mp make_pair\n#define pb push_back\n#define re register ll\n#define fr first\n#define sd second\n#define pa pair<ll,ll>\n#define FOR(i,a,b) for(re i=a;i<=b;i++)\n#define REP(i,a,b) for(re i=a;i>=b;i--)\n#define lowbit(x) (x&(-x))\n#define Z(x) (x>=mod?x-mod:x)\n#define N 200010\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ninline ll read()\n{\n\tchar ch=getchar();\n\tll s=0,w=1;\n\twhile(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){s=s*10+ch-'0';ch=getchar();}\n\treturn s*w;\n}\npriority_queue<pa,vector<pa>,less<pa> >q1,q2,q3,q4,q5,q6,q7;\n/*\nq1:\u53ea\u9009\u4e86b\u7684x\u7684a[x]\nq2:\u53ea\u9009\u4e86a\u7684x\u7684-a[x]\nq3:\u53ea\u9009\u4e86a\u7684x\u7684b[x]\nq4:\u53ea\u9009\u4e86b\u7684x\u7684-b[x]\nq5:a,b\u90fd\u6ca1\u9009\u7684x\u7684a[x]+b[x]\nq6:a,b\u90fd\u9009\u4e86\u7684x\u7684-(a[x]+b[x])\n*/\nll n,k,l;\nll a[N],b[N],ans[N];\n//ans\u6570\u7ec4\uff1a0\u8868\u793aa,b\u90fd\u6ca1\u9009\uff0c1\u8868\u793aa\u6ca1\u9009b\u9009\u4e86,2\u8868\u793aa\u9009\u4e86b\u6ca1\u9009\uff0c3\u8868\u793aa,b\u90fd\u9009\u4e86\npa p[N];\ninline void add(ll x,ll op)\n{\n\tif(op==0){q5.push(mp(a[x]+b[x],x));}\n\tif(op==1){q1.push(mp(a[x],x));q4.push(mp(-b[x],x));}\n\tif(op==2){q2.push(mp(-a[x],x));q3.push(mp(b[x],x));}\n\tif(op==3){q6.push(mp(-a[x]-b[x],x));}\n}\nint main()\n{\n\t//ios::sync_with_stdio(false);\n\t//freopen(\".in\",\"r\",stdin);\n\t//freopen(\".out\",\"w\",stdout);\n\tll w4p3r=read();\n\twhile(w4p3r--)\n\t{\n\t\tn=read(),k=read(),l=read();\n\t\twhile(!q1.empty())q1.pop();\n\t\twhile(!q2.empty())q2.pop();\n\t\twhile(!q3.empty())q3.pop();\n\t\twhile(!q4.empty())q4.pop();\n\t\twhile(!q5.empty())q5.pop();\n\t\twhile(!q6.empty())q6.pop();\n\t\tq1.push(mp(-inf,0));q2.push(mp(-inf,0));q3.push(mp(-inf,0));q4.push(mp(-inf,0));q5.push(mp(-inf,0));q6.push(mp(-inf,0));\n\t\tFOR(i,1,n)a[i]=read();\n\t\tFOR(i,1,n)b[i]=read();\n\t\tFOR(i,1,n)ans[i]=0;ll answer=0;\n\t\tFOR(i,1,n)p[i]=mp(a[i],i);\n\t\tsort(p+1,p+n+1);reverse(p+1,p+n+1);\n\t\tFOR(i,1,k){answer+=p[i].fr;ans[p[i].sd]|=2;}\n\t\tFOR(i,1,n)p[i]=mp(b[i],i);\n\t\tsort(p+1,p+n+1);reverse(p+1,p+n+1);\n\t\tFOR(i,1,k){answer+=p[i].fr;ans[p[i].sd]|=1;}\n\t\tFOR(i,1,n)add(i,ans[i]);\n\t\tFOR(i,1,n)l-=(ans[i]==3);l=max(l,0LL);\n\t\t//cout<<\"WTF:\"<<answer<<\" \"<<l<<endl;\n\t\twhile(l--)\n\t\t{\n\t\t\twhile(!q1.empty()){ll x=q1.top().sd;if(!x||ans[x]==1)break;q1.pop();}\n\t\t\twhile(!q2.empty()){ll x=q2.top().sd;if(!x||ans[x]==2)break;q2.pop();}\n\t\t\twhile(!q3.empty()){ll x=q3.top().sd;if(!x||ans[x]==2)break;q3.pop();}\n\t\t\twhile(!q4.empty()){ll x=q4.top().sd;if(!x||ans[x]==1)break;q4.pop();}\n\t\t\twhile(!q5.empty()){ll x=q5.top().sd;if(!x||ans[x]==0)break;q5.pop();}\n\t\t\twhile(!q6.empty()){ll x=q6.top().sd;if(!x||ans[x]==3)break;q6.pop();}\n\t\t\tll v1=q1.top().fr,v2=q2.top().fr,v3=q3.top().fr,v4=q4.top().fr,v5=q5.top().fr,v6=q6.top().fr;\n\t\t\tll t1=v1+v2,t2=v3+v4,t3=v5+v2+v4,t4=v1+v3+v6;\n\t\t\tll maxn=-inf;\n\t\t\tif(t1>maxn)maxn=t1;if(t2>maxn)maxn=t2;if(t3>maxn)maxn=t3;if(t4>maxn)maxn=t4;\n\t\t\tif(t1==maxn)\n\t\t\t{\n\t\t\t\tll x=q1.top().sd,y=q2.top().sd;\n\t\t\t\tans[x]=3,ans[y]=0;answer+=a[x]-a[y];\n\t\t\t\tadd(x,ans[x]);add(y,ans[y]);\n\t\t\t}//\u60c5\u51b51\n\t\t\telse if(t2==maxn)\n\t\t\t{\n\t\t\t\tll x=q3.top().sd,y=q4.top().sd;\n\t\t\t\tans[x]=3,ans[y]=0;answer+=b[x]-b[y];\n\t\t\t\tadd(x,ans[x]);add(y,ans[y]);\n\t\t\t}//\u60c5\u51b52\n\t\t\telse if(t3==maxn)\n\t\t\t{\n\t\t\t\tll x=q5.top().sd,y=q2.top().sd,z=q4.top().sd;\n\t\t\t\tans[x]=3;ans[y]=0;ans[z]=0;answer+=a[x]+b[x]-a[y]-b[z];\n\t\t\t\tadd(x,ans[x]);add(y,ans[y]);add(z,ans[z]);\n\t\t\t}//\u60c5\u51b53\n\t\t\telse\n\t\t\t{\n\t\t\t\tll x=q1.top().sd,y=q3.top().sd,z=q6.top().sd;\n\t\t\t\tans[x]=3,ans[y]=3;ans[z]=0;answer+=a[x]+b[y]-(a[z]+b[z]);\n\t\t\t\tadd(x,ans[x]);add(y,ans[y]);add(z,ans[z]);\n\t\t\t}//\u60c5\u51b54\n\t\t}\n\t\tprintf(\"%lld\\n\",answer);\n\t}\n\treturn 0;\n}\n//gl\n```\n\n**\u5982\u679c\u4f60\u89c9\u5f97\u8fd9\u7bc7\u9898\u89e3\u5bf9\u4f60\u6709\u5e2e\u52a9\uff0c\u90a3\u4f60\u53ef\u4ee5\u70b9\u4e2a\u8d5e\u652f\u6301\u6211\u4e00\u4e0bqwq\u3002\u5982\u679c\u4f60\u5bf9\u9898\u89e3\u6709\u4efb\u4f55\u95ee\u9898/\u8ba4\u4e3a\u6211\u7684\u9898\u89e3\u6709\u4efb\u4f55\u95ee\u9898\uff0c\u53ef\u4ee5\u79c1\u4fe1/\u5728\u8bc4\u8bba\u533a\u53d1\u51fa\u6765\uff0c\u5f53\u7136\u5982\u679c\u4f60\u5bf9\u6211\u7684\u9898\u89e3\u6709\u4efb\u4f55\u610f\u89c1/\u5efa\u8bae\u4e5f\u6b22\u8fce\u6307\u51fa\u3002\u6211\u4f1a\u5c3d\u6211\u5168\u529b\u628a\u6211\u9898\u89e3\u5199\u5230\u6700\u597d\u7684qwq**",
        "postTime": 1605616058,
        "uid": 72419,
        "name": "WAPER4EVER",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5470 \u3010[NOI2019]\u5e8f\u5217\u3011"
    },
    {
        "content": "\u66f4\u4e25\u8c28\u7684\u6b63\u786e\u6027\u5206\u6790\u3002\n\n\u66f4\u81ea\u7136\u7684\u975e\u542f\u53d1\u5f0f\u601d\u8def\u3002\n\n\u66f4\u5f3a\u7684\u6269\u5c55\u6027\u3002\n\n**\u5e7f\u544a** \uff1a \n\n- [\u6a21\u62df\u8d39\u7528\u6d41\u5c0f\u8bb0](https://www.luogu.com.cn/blog/command-block/mu-ni-fei-yong-liu-xiao-ji) \uff08\u5efa\u8bae\u9605\u8bfb\uff09\n\n- [NOI2019 \u7b80\u8981\u9898\u89e3](https://www.luogu.com.cn/blog/command-block/noi2019-jian-yao-ti-xie)\n\n------------\n\n**\u9898\u610f** : \u7ed9\u5b9a\u4e24\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6b63\u6574\u6570\u5e8f\u5217 $\\{a_i\\}$ \u4e0e $\\{b_i\\}$\u3002\n  \n\u5206\u522b\u5bf9\u4e24\u4e2a\u5e8f\u5217\u5404\u6307\u5b9a**\u6070\u597d** $K$ \u4e2a\u4e0b\u6807\uff0c\u8981\u6c42**\u81f3\u5c11**\u6709 $L$ \u4e2a\u4e0b\u6807\u5728\u4e24\u4e2a\u5e8f\u5217\u4e2d\u90fd\u88ab\u6307\u5b9a\uff0c\u4f7f\u5f97\u8fd9 $2K$ \u4e2a\u4e0b\u6807\u5728\u5e8f\u5217\u4e2d\u5bf9\u5e94\u7684\u5143\u7d20\u7684\u603b\u548c**\u6700\u5927**\u3002\n\n\u591a\u7ec4\u6570\u636e\uff0c $T\\leq 10,n\\leq 2\\times 10^5,\\sum n\\leq 10^6$\u3002\n\n------------\n\n- **\u8d39\u7528\u6d41\u6a21\u578b**\n\n\u81f3\u5c11\u6709 $L$ \u4e2a\u4e0b\u6807\u76f8\u540c\uff0c\u5373\u81f3\u591a\u6709 $K-L$ \u4e2a\u4e0b\u6807\u4e0d\u540c\u3002\n\n- \u5bf9\u6bcf\u4e2a $i$ :\n\n  \u8fde\u8fb9 $S\\rightarrow a_i$ \uff0c\u5bb9\u91cf\u4e3a $1$ \uff0c\u8fb9\u6743\u4e3a $a_i$\u3002\n  \n  \u8fde\u8fb9 $b_i\\rightarrow T$ \uff0c\u5bb9\u91cf\u4e3a $1$ \uff0c\u8fb9\u6743\u4e3a $b_i$\u3002\n  \n  \u8fde\u8fb9 $a_i\\rightarrow b_i$ \uff0c\u65e0\u6743\uff0c\u8868\u793a\u9009\u62e9\u4e00\u5bf9\u76f8\u540c\u7684\u4e0b\u6807\u3002\n  \n\u65b0\u5efa\u70b9 $U,V$ \uff0c\u8fde\u8fb9 $U\\rightarrow V$ \uff0c\u65e0\u6743\uff0c\u5bb9\u91cf\u4e3a $K-L$ \uff08\u79f0\u4e3a\u81ea\u7531\u6d41\u91cf\uff09\uff0c\u8868\u793a\u4e0d\u540c\u7684\u4e0b\u6807\u3002\n\n\u5bf9\u6bcf\u4e2a $i$ \uff0c\u8fde\u8fb9 $a_i\\rightarrow U,\\ V\\rightarrow b_i$\u3002\n\n\u9650\u5236\u6d41\u91cf\u4e3a $K$ \uff0c\u6c42\u89e3\u6700\u5927\u8d39\u7528\u6700\u5927\u6d41\u5373\u53ef\u3002\n\n\u76f4\u63a5\u8dd1\u8d39\u7528\u6d41\u53ef\u4ee5\u83b7\u5f97 $40\\sim 64$ \u5206\u3002\n\n------------\n\n- **\u6a21\u62df\u8d39\u7528\u6d41**\n\n\u9996\u5148\u89c2\u5bdf\u5efa\u56fe :\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5863chlh.png)\n\n\u9664\u4e86\u548c $S,T$ \u76f4\u63a5\u76f8\u8fde\u7684\u8fb9\u4ee5\u5916\uff0c\u5176\u4ed6\u8fb9\u7684\u8fb9\u6743\u5747\u4e3a $0$\u3002\n\n\u8003\u8651\u76f4\u63a5\u6a21\u62df EK \u7b97\u6cd5\u7684\u8fc7\u7a0b\u3002\n\n\u6240\u6709\u548c $S,T$ \u76f4\u63a5\u76f8\u8fde\u7684\u8fb9\u4e0d\u4f1a\u9000\u6d41\uff08\u53ef\u4ee5\u5ffd\u7565\u53cd\u5411\u8fb9\uff09\uff0c\u800c\u4e2d\u95f4\u7684\u8fb9\u53ef\u80fd\u56e0\u4e3a\u9000\u6d41\u800c\u53d1\u751f\u65b9\u5411\u7684\u6539\u53d8\uff08\u6dfb\u52a0\uff09\u3002\n\n\u8003\u8651\u6240\u6709\u53ef\u80fd\u7684\u589e\u5e7f\u8def\u5f62\u6001\uff0c\u4ee5\u53ca\u5b83\u4eec\u7684\u5b9e\u9645\u610f\u4e49\u3002\n\n\u7531\u4e8e\u540c\u4e00\u4e2a\u70b9\u81f3\u591a\u7ecf\u8fc7\u4e00\u6b21\uff0c\u589e\u5e7f\u8def\u5f62\u6001\u4e0d\u4f1a\u5f88\u591a\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xe956808.png)\n\n\u5176\u4e2d\u7ea2\u8272\u4e3a\u589e\u5e7f\u8def\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/o0hmwgac.png)\n\n\u5176\u4e2d\u7ea2\u8272\u4e3a\u65b0\u9009\u62e9\u7684\u70b9\uff0c\u9ed1\u8272\u4e3a\u5df2\u9009\u7684\u70b9\u3002\u7eff\u8272\u8fb9\u4e3a\u539f\u6765\u7684\u914d\u5bf9\uff0c\u7ea2\u8272\u8fb9\u4e3a\u65b0\u7684\u914d\u5bf9\u3002\n\n\u5177\u4f53\u65b9\u6848\u5982\u4e0b\u3002\u8bb0\u8fd9\u4e00\u8f6e\u9009\u62e9\u4e00\u5bf9 $(a_i,b_j)$\u3002\n\n- \u2460 : $i=j$\u3002\n\n- \u2461 : $i\\neq j$ \uff0c\u6d88\u8017\u4e00\u5355\u4f4d\u81ea\u7531\u6d41\u91cf\u3002\n\n- \u2462 : \u5c06 $a_i$ \u4e0e $b_i$ \uff08\u5fc5\u987b\u5df2\u9009\uff09\u914d\u5bf9\uff0c\u5c06 $b_j$ \u4e0e $a_j$ \uff08\u5fc5\u987b\u5df2\u9009\uff09 \u914d\u5bf9\u3002\u589e\u52a0\u4e00\u5355\u4f4d\u81ea\u7531\u6d41\u91cf\u3002\n\n- \u2463 \uff1a\u5c06 $a_i$ \u4e0e $b_i$ \uff08\u5fc5\u987b\u5df2\u9009\uff09\u914d\u5bf9\uff0c\u5c06 $b_j$ \u4e0e\u539f\u6765\u4e0e $b_i$ \u914d\u5bf9\u7684 $a_k$ \u914d\u5bf9\u3002\n\n- \u2464 \uff1a\u5c06 $b_i$ \u4e0e $a_i$ \uff08\u5fc5\u987b\u5df2\u9009\uff09\u914d\u5bf9\uff0c\u5c06 $a_j$ \u4e0e\u539f\u6765\u4e0e $a_i$ \u914d\u5bf9\u7684 $b_k$ \u914d\u5bf9\u3002\n\n\u5355\u89c2\u5bdf\u56fe\u7684\u8bdd\uff0c\u8fd8\u53ef\u80fd\u6709\u4e0b\u9762\u7684\u8fd9\u79cd\u589e\u5e7f\u8def \uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tgoycu71.png)\n\n\uff08\u6b64\u65f6 $u,v$ \u90fd\u88ab\u7ecf\u8fc7\u4e86\uff0c\u6545\u4e0d\u53ef\u80fd\u6709\u66f4\u590d\u6742\u7684\u589e\u5e7f\u8def\uff09\n\n\u8003\u8651\u8fd9\u7c7b\u589e\u5e7f\u8def\u7684\u5b9e\u9645\u610f\u4e49\uff0c\u5982\u53f3\u56fe\u3002\u5176\u4e2d\u7eff\u8272\u662f\u539f\u6765\u7684\u8fde\u63a5\u60c5\u51b5\uff0c\u7ea2\u8272\u662f\u540e\u6765\u7684\u8fde\u63a5\u60c5\u51b5\u3002\n\n\u7136\u800c\uff0c\u603b\u662f\u5b58\u5728\u66f4\u4f18\u7684\u8fde\u63a5\u65b9\u5f0f\uff08\u5982\u84dd\u8272\uff09\uff0c\u6545\u8fd9\u7c7b\u589e\u5e7f\u8def\u4e0d\u4f18\u3002\n\n\u6211\u4eec\u7528\u5806\u7ef4\u62a4\u4e0a\u8ff0\u4e94\u79cd\u8f6c\u79fb\u3002\n\n\u4e24\u4fa7\u5206\u522b\u7528\u4e24\u4e2a\u5806 $q_a,q_b$ \u7ef4\u62a4\u672a\u9009\u7684\u6570\u7684 $\\max$\u3002\n\n\u7528\u5806 $q$ \u7ef4\u62a4\u672a\u9009\u7684\u6570\u7684 $a_i+b_i$ \u7684 $\\max$\u3002\n\n\u518d\u7528\u4e24\u4e2a\u5806 $q_a',q_b'$ \u7ef4\u62a4\u201c\u672c\u4fa7\u672a\u9009\u4e2d\uff0c\u4f46\u53e6\u4e00\u4fa7\u9009\u4e2d\u201d\u7684\u6570\u7684 $\\max$\u3002\n\n\u8bb0 $q,q_a,q_b,q_a',q_b'$ \u5806\u9876\u4e3a $s,a,b,a',b'$\u3002\uff08\u82e5\u4e0d\u5b58\u5728\u5219\u4e3a $-\\infty$\uff09\n\n- \u2460 \uff1a $s$\u3002\n\n- \u2461 \uff1a $a+b$\u3002\u5f53\u6709\u81ea\u7531\u6d41\u91cf\u65f6\u624d\u751f\u6548\u3002\n\n- \u2462 \uff1a $a'+b'$\u3002\u81ea\u7531\u6d41\u91cf\u52a0\u4e00\u3002\n\n- \u2463 \uff1a $a'+b$\u3002\n\n- \u2464 \uff1a $a+b'$\u3002\n\n\u4e94\u79cd\u65b9\u6848\u53d6 $\\max$ \u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6\u4e3a $O(n\\log n)$\u3002\n\n\u7406\u6e05\u601d\u8def\u540e\u4ee3\u7801\u975e\u5e38\u597d\u5199\u3002\n\n```cpp\n#include<algorithm>\n#include<cstdio>\n#include<queue>\n#define Pr pair<int,int>\n#define fir first\n#define sec second\n#define mp make_pair\n#define ll long long\n#define MaxN 200500\nusing namespace std;\nconst int INF=1000000000;\npriority_queue<Pr> q,qa,qb,qa2,qb2;\nint n,k,l,a[MaxN],b[MaxN];\nbool visa[MaxN],visb[MaxN];\nvoid seta(int p)\n{visa[p]=1;if (!visb[p])qb2.push(mp(b[p],p));}\nvoid setb(int p)\n{visb[p]=1;if (!visa[p])qa2.push(mp(a[p],p));}\nvoid solve()\n{\n  scanf(\"%d%d%d\",&n,&k,&l);l=k-l;\n  for (int i=1;i<=n;i++)scanf(\"%d\",&a[i]);\n  for (int i=1;i<=n;i++)scanf(\"%d\",&b[i]);\n  for (int i=1;i<=n;i++){\n    visa[i]=visb[i]=0;\n    q.push(mp(a[i]+b[i],i));\n    qa.push(mp(a[i],i));\n    qb.push(mp(b[i],i));\n  }\n  q.push(mp(-INF,0));\n  qa.push(mp(-INF,0));qb.push(mp(-INF,0));\n  qa2.push(mp(-INF,0));qb2.push(mp(-INF,0));\n  ll ans=0;\n  for (int i=1;i<=k;i++){\n    while(visa[q.top().sec]||visb[q.top().sec])q.pop();\n    while(visa[qa.top().sec])qa.pop();\n    while(visb[qb.top().sec])qb.pop();\n    while(visa[qa2.top().sec])qa2.pop();\n    while(visb[qb2.top().sec])qb2.pop();\n    Pr now=q.top(),nowa=qa.top(),nowb=qb.top();\n    int op=1,mx=now.fir;\n    Pr nowa2=qa2.top(),nowb2=qb2.top();\n    if (mx<nowa2.fir+nowb2.fir){\n      mx=nowa2.fir+nowb2.fir;\n      op=3;\n    }\n    if (mx<nowa2.fir+nowb.fir){\n      mx=nowa2.fir+nowb.fir;\n      op=4;\n    }\n    if (mx<nowa.fir+nowb2.fir){\n      mx=nowa.fir+nowb2.fir;\n      op=5;\n    }\n    if (nowa.sec!=nowb.sec&&l)\n      if (mx<nowa.fir+nowb.fir){\n        mx=nowa.fir+nowb.fir;\n        op=2;\n      }\n    ans+=mx;\n    if (op==1){seta(now.sec);setb(now.sec);}\n    if (op==2){seta(nowa.sec);setb(nowb.sec);l--;}\n    if (op==3){seta(nowa2.sec);setb(nowb2.sec);l++;}\n    if (op==4){seta(nowa2.sec);setb(nowb.sec);}\n    if (op==5){seta(nowa.sec);setb(nowb2.sec);}\n  }\n  printf(\"%lld\\n\",ans);\n  while(!q.empty())q.pop();\n  while(!qa.empty())qa.pop();while(!qb.empty())qb.pop();\n  while(!qa2.empty())qa2.pop();while(!qb2.empty())qb2.pop();\n}\nint main()\n{\n  freopen(\"sequence3.in\",\"r\",stdin);\n  int T;scanf(\"%d\",&T);\n  while(T--)solve();\n  return 0;\n}\n```",
        "postTime": 1623767256,
        "uid": 58705,
        "name": "command_block",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 \u3010P5470 [NOI2019] \u5e8f\u5217\u3011"
    },
    {
        "content": "~~\u4e0d\u77e5\u9053\u6211\u662f\u4e0d\u662f\u7b2c\u4e00\u4e2a\u7528wqs\u4e8c\u5206\u8fc7\u8fd9\u9898\u7684\u4eba~~    \n  \n\u8003\u8651\u5982\u679c\u6ca1\u6709 $k$ \u8fd9\u4e2a\u9650\u5236\u8be5\u600e\u4e48\u505a\u3002  \n\u5982\u679c\u73b0\u5728 $a,b$ \u4e2d\u90fd\u6709\u6b63\u6709\u8d1f\uff0c\u90a3\u4e48\u6709\u4ee5\u4e0b\u56db\u7c7b\uff1a  \n1. $a_i\\geq 0,b_i\\geq 0$  \n\u8fd9\u79cd\u60c5\u51b5\u4e0b\u80af\u5b9a\u90fd\u9009\uff0c\u5339\u914d\u7684\u4f4d\u6570 $+1$  \n2. $a_i\\geq 0,b_i < 0$  \n$a_i$ \u662f\u80af\u5b9a\u9009\u62e9\u7684\uff0c\u90a3\u4e48\u73b0\u5728\u6709\u4e00\u79cd\u9009\u62e9\u662f\u9009 $b_i$ \u4f7f\u5339\u914d\u7684\u4f4d\u6570 $+1$  \n3. $a_i< 0,b_i \\geq 0$  \n\u540c2  \n4. $a_i< 0,b_i < 0$    \n\u90a3\u4e48\u6709\u4e00\u79cd\u9009\u62e9\u662f\u9009 $a_i+b_i$ \u4f7f\u5339\u914d\u7684\u4f4d\u6570 $+1$  \n\n\u5bf9\u5f97\u5230\u7684\u6240\u6709\u9009\u62e9\u65b9\u6848\u6392\u5e8f\uff0c\u4f7f\u5f97\u81f3\u5c11\u6709 $L$ \u4f4d\u5339\u914d\u4e0a\uff0c\u590d\u6742\u5ea6$O(n \\log n)$  \n\n\n\u4ee4 $f_{i,j}$ \u8868\u793a\u5728\u9009\u6070\u597d $i$ \u4e2a $a$\uff0c\u6070\u597d $j$ \u4e2a $b$ \u7684\u6ee1\u8db3 $L$ \u9650\u5236\u7684\u6700\u5927\u9009\u62e9\u65b9\u6848\uff0c~~\u611f\u6027\u7406\u89e3~~ \u4e0d\u96be\u53d1\u73b0\u5728 $i$ \u786e\u5b9a\u7684\u60c5\u51b5\u4e0b $f_{i,j}$ \u7684\u56fe\u50cf\u5173\u4e8e $j$ \u662f\u4e00\u4e2a\u4e0a\u51f8\u51fd\u6570\u3002   \n\u540c\u7406\u5728 $j$ \u786e\u5b9a\u7684\u60c5\u51b5\u4e0b $i$ \u4e5f\u6ee1\u8db3\u8fd9\u4e2a\u6027\u8d28\u3002  \n\u90a3\u4e48~~\u6309\u7167\u5957\u8def~~\u53ef\u4ee5\u5148\u53bb\u4e8c\u5206 $i$ \u7684\u659c\u7387,\u518d\u53bb\u4e8c\u5206 $j$ \u7684\u659c\u7387\uff0c\u4f7f\u5f97 $i=1,j=1$\u3002  \n\u590d\u6742\u5ea6$O(n\\log n \\log^2 V)$\uff0c\u663e\u7136\u8fc7\u4e0d\u4e86\uff0c\u53ea\u80fd\u62ff\u5230 $64$ \u5206~~\u4e0d\u8fc7\u4ee3\u7801\u5f88\u597d\u5199\uff0c\u8003\u573a\u4e0a\u6027\u4ef7\u6bd4\u5f88\u9ad8~~    \n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define il inline\n#define ri register int\n#define ll long long\n#define ui unsigned int\nil ll read(){\n    bool f=true;ll x=0;\n    register char ch=getchar();\n    while(ch<'0'||ch>'9') {if(ch=='-') f=false;ch=getchar();}\n    while(ch>='0'&&ch<='9') x=(x<<3)+(x<<1)+(ch^48),ch=getchar();\n    if(f) return x;\n    return ~(--x);\n}\nil int read(char *s){\n    int len=0;\n    register char ch=getchar();\n    while(ch==' '||ch=='\\n') ch=getchar();\n    while(ch!=' '&&ch!='\\n'&&ch!=EOF) s[++len]=ch,ch=getchar();\n    return len;\n}\nil void write(const ll &x){if(x>9) write(x/10);putchar(x%10+'0');}\nil void print(const ll &x) {x<0?putchar('-'),write(~(x-1)):write(x);putchar('\\n');}\nil ll max(const ll &a,const ll &b){return a>b?a:b;}\nil ll min(const ll &a,const ll &b){return a<b?a:b;}\nconst int MAXN=2e5+7;\nstruct node\n{\n    ll x,y;\n}a[MAXN];\nint n,k,L;\nll ma,mb,cnta,cntb,tot;\nint mark[MAXN];\n#define pll pair<ll,ll> \n#define fir first\n#define sec second\npll vec[MAXN];\nll top;\nbool checkb(){\n    ll cnt=0;tot=cnta=cntb=top=0;\n    for(ri i=1;i<=n;++i){\n        if(a[i].x+ma>=0&&a[i].y+mb>=0) ++cnt,tot+=a[i].x+a[i].y+ma+mb,cnta++,cntb++;\n        else if(a[i].x+ma>0) cnta++,tot+=a[i].x+ma,vec[++top]=(pll){a[i].y+mb,1};\n        else if(a[i].y+mb>0) cntb++,tot+=a[i].y+mb,vec[++top]=(pll){a[i].x+ma,2};\n        else vec[++top]=(pll){a[i].x+ma+a[i].y+mb,3};\n    }\n    sort(vec+1,vec+top+1);\n    for(ri i=top;i&&cnt<L;--i){\n        tot+=vec[i].fir;\n        if(vec[i].sec&1) ++cntb;\n        if(vec[i].sec&2) ++cnta;\n        ++cnt;\n    }\n    return cntb<=k;\n}\nbool checka(){\n    ll sav=0;\n    ll l=-mx,r=-mn;\n    while(l<=r){\n        mb=(l+r)>>1;\n        if(checkb()){\n            l=mb+1;\n            sav=mb;\n        }\n        else r=mb-1;\n    }\n    mb=sav;\n    checkb();\n    return cnta<=k;\n}\nll mn=1e18,mx;\nint main(){\n    // freopen(\"sequence3.in\",\"r\",stdin);\n    // freopen(\"1.out\",\"w\",stdout);\n    for(ri T=read();T;--T){\n        mn=1e18,mx=0;\n        n=read(),k=read(),L=read();\n        for(ri i=1;i<=n;++i) a[i].x=read(),mn=min(a[i].x,mn),mx=max(a[i].x,mx);\n        for(ri i=1;i<=n;++i) a[i].y=read(),mn=min(a[i].y,mn),mx=max(a[i].y,mx);\n        ll l=-mx,r=-mn,ans=0;\n        while(l<=r){\n            ma=(l+r)>>1;\n            if(checka()){\n                l=ma+1;\n                ans=tot-ma*k-mb*k;\n            }\n            else r=ma-1;\n        }\n        print(ans);\n    }\n    return 0;\n}\n```\n\n\n\u89e3\u9898\u601d\u8def\u5230\u6b21\u4e3a\u6b62\uff0c\u5269\u4e0b\u7684\u662f\u5361\u5e38\u6280\u5de7\u3002\n\n------------\n\n### 1.\u6307\u9488\u4f18\u5316\u5bfb\u5740  \n\u4f8b\u5982\u8fd9\u6837\u4e00\u4efd\u4ee3\u7801\uff1a  \n```cpp\nfor(int i=1;i<=n;++i){\n\ta[i]++;                      \n}\n```\n\u53ef\u4ee5\u7528\u6307\u9488\u7684\u5f62\u5f0f\u5bf9\u5176\u8fdb\u884c\u4f18\u5316\u3002  \n\n```cpp\nfor(int i=1,*p=&a[i];i<=n;++i,++p){\n\t(*p)++;                      \n}\n```  \n\u5728\u6709\u5927\u91cf\u679a\u4e3e\u64cd\u4f5c\u7684\u65f6\u5019\u8fd9\u79cd\u65b9\u5f0f\u7684\u4f18\u5316\u5f88\u5927\u3002  \n### 2.\u63d0\u65e9\u7ed3\u675f\u4e8c\u5206  \n\u5982\u679c\u5728\u4e8c\u5206\u7684\u8fc7\u7a0b\u5f53\u4e2d\u5df2\u7ecf\u4f7f\u5f97\u5f53\u524d\u7684\u6b21\u6570\u6070\u597d\u4e3a $K$ \u4e86\uff0c\u90a3\u4e48\u53ef\u4ee5\u76f4\u63a5break\uff0c\u8fd9\u662f\u4e2a\u6548\u679c\u5f88\u597d\u7684\u4f18\u5316\n\n### 3.\u51cf\u5c11\u4e8c\u5206\u8303\u56f4  \n\u4e0d\u4e00\u5b9a\u975e\u8981\u628a\u4e8c\u5206\u7684\u8303\u56f4\u5f00\u6210$[0,1e9]$\uff0c\u53ef\u4ee5\u8bb0\u5f55\u4e00\u4e0b\u6574\u4e2a\u5e8f\u5217\u7684\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\uff0c\u628a\u8303\u56f4\u7f29\u5c0f\u6210 $[min,max]$\u3002    \n\n### 4.\u51cf\u5c11\u4e8c\u5206\u6b21\u6570  \n\u7b2c\u4e00\u4e2a\u4e8c\u5206\u7684\u6b21\u6570\u663e\u7136\u5df2\u7ecf\u6ca1\u4ec0\u4e48\u529e\u6cd5\u4f18\u5316\u4e86\uff0c\u90a3\u4e48\u8003\u8651\u4f18\u5316\u7b2c\u4e8c\u4e2a\u4e8c\u5206  \n~~\u4e0d\u96be\u53d1\u73b0~~ $f_{i,j}$ \u6709\u4e00\u4e2a\u663e\u7136\u5374\u96be\u4ee5\u53d1\u73b0\u7684\u6027\u8d28\uff0c\u968f\u7740 $i$ \u7684\u659c\u7387\u7684\u9012\u589e\uff0c$j$ \u7684\u659c\u7387\u662f\u9012\u51cf\u7684\u3002  \n~~\u611f\u6027\u7406\u89e3\u4e00\u4e0b\uff0c\u8fd9\u91cc\u7a7a\u767d\u592a\u5c0f\uff0c\u6211\u5199\u4e0d\u4e0b~~  \n\u90a3\u4e48\u6bcf\u5b8c\u6210\u4e00\u6b21 $j$ \u7684\u4e8c\u5206\uff0c\u90fd\u53ef\u4ee5\u6839\u636e\u53cd\u9988\u7684\u7ed3\u679c\u6765\u7f29\u5c0f\u4e8c\u5206 $j$ \u7684\u659c\u7387\u7684\u8303\u56f4\u3002  \n\u5177\u4f53\u5b9e\u73b0\u5982\u4e0b\uff1a  \n```cpp\nbool checka(node p){\n    int l=p.x,r=p.y,sav=0;\n    while(l<=r){\n        mb=(l+r)>>1;\n        if(checkb()){\n            l=mb+1;\n            sav=mb;\n            if(cntb==k) break;\n        }\n        else r=mb-1;\n    }\n    mb=sav;\n    checkb();\n    return cnta<=k;\n}  \n.\n.\n.\nnode now=(node){-mx,-mn};\nwhile(l<=r){\n    ma=(l+r)>>1;\n    if(checka(now)){\n        l=ma+1;\n        ans=tot-1ll*ma*k-1ll*mb*k;\n        now.x=mb-10;\n        if(cnta==k)break;\n    }\n    else r=ma-1,now.y=mb+10;\n}\n```  \n\u4e0d\u77e5\u9053\u8fd9\u6837\u4e4b\u540e\u8fd9\u4e24\u4e2a\u4e8c\u5206\u7684\u590d\u6742\u5ea6\u53d8\u6210\u4e86\u591a\u5c11\uff0c\u4f46\u662f\u5b9e\u6d4b\u5feb\u4e86\u5c06\u8fdb $6$ \u500d\u5de6\u53f3\uff0c\u5927\u6982\u662f\u53d8\u6210\u4e86$O(\\log V \\log \\log V)$ \u7684\u6837\u5b50\uff1f  \n\n### 5.\u677e\u5f0f\u57fa\u6392  \n\u5728\u7ecf\u8fc7\u4e0a\u9762\u56db\u91cd\u4f18\u5316\u4e4b\u540e\uff0c\u4f9d\u65e7\u5361\u5728 $84$ \u5206\uff0c\u7b2c $22$ \u4e2a\u70b9\u672c\u5730\u8981\u8dd1 $5s$   \n\u5b9e\u9645\u4e0a\uff0c\u8fd8\u6709\u4e00\u4e2a\u91cd\u8981\u7684\u590d\u6742\u5ea6\u74f6\u9888\u6ca1\u6709\u4f18\u5316\u8fc7\uff1a\u6392\u5e8f\u7684$n\\log n$  \n\u8bf4\u5230\u6392\u5e8f\u4f18\u5316\uff0c\u90a3\u5c31\u4e0d\u5f97\u4e0d\u63d0\u5230**\u677e\u5f0f\u57fa\u6392**\u4e86\uff0c\u53ef\u60dc\u6211\u5e76\u4e0d\u4f1a\u8fd9\u4e2a\uff0c\u4e8e\u662f\u5728**\u795eDpair**\u7684\u5e2e\u52a9\u4e0b\uff0c\u4ece\u4ed6\u90a3\u91cc\u5f97\u5230\u4e86\u4e00\u4e2a\u677f\u5b50\uff0c\u53c8\u5feb\u4e86\u5927\u6982 $4$ \u500d\uff0c\u6210\u529f\u677e\u8fc7  \n\n```cpp\n\nnamespace DPair{\n    int cnt1[256], cnt2[256], cnt3[256], cnt4[256];\n    pll temp[MAXN];\n    inline void RadixSort(pll a[], int l, int r){\n        memset(cnt1, 0, sizeof(cnt1));\n        memset(cnt2, 0, sizeof(cnt2));\n        memset(cnt3, 0, sizeof(cnt3));\n        memset(cnt4, 0, sizeof(cnt4));\n        for (int i = l;i <= r;++ i){\n            ++ cnt1[a[i].fir & 255];\n            ++ cnt2[a[i].fir >> 8 & 255];\n            ++ cnt3[a[i].fir >> 16 & 255];\n            ++ cnt4[a[i].fir >> 24 & 255];\n        }\n        for (int i = 1;i <= 255;++ i){\n            cnt1[i] += cnt1[i - 1];\n            cnt2[i] += cnt2[i - 1];\n            cnt3[i] += cnt3[i - 1];\n            cnt4[i] += cnt4[i - 1];\n        }\n        for (int i = r;i >= l;-- i) temp[cnt1[a[i].fir & 255] --] = a[i];\n        for (int i = r;i >= l;-- i) a[cnt2[temp[i].fir >> 8 & 255] --] = temp[i];\n        for (int i = r;i >= l;-- i) temp[cnt3[a[i].fir >> 16 & 255] --] = a[i];\n        for (int i = r;i >= l;-- i) a[cnt4[temp[i].fir >> 24 & 255] --] = temp[i];\n    }\n}\n\n```\n\n\u6700\u540e\u7684\u590d\u6742\u5ea6\u5927\u6982\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a$O(n \\log_{256}n \\log V \\log \\log V)$\u7684\u4e1c\u897f\uff0c\u8fd8\u662f\u6bd4\u8f83\u52c9\u5f3a\u5730\u8dd1\u8fc7\u53bb\u4e86~~\u559c\u9898\u7b2c\u4e8c\u52a3\u89e3~~\n\n_Code_  \n------------  \n```cpp\n#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4.1,sse4.2,avx,avx2,popcnt,tune=native\")\n#include<bits/stdc++.h>\nusing namespace std;\n#define il inline\n#define ri register int\n#define ll long long\n#define ui unsigned int\nil ll read(){\n    bool f=true;ll x=0;\n    register char ch=getchar();\n    while(ch<'0'||ch>'9') {if(ch=='-') f=false;ch=getchar();}\n    while(ch>='0'&&ch<='9') x=(x<<3)+(x<<1)+(ch^48),ch=getchar();\n    if(f) return x;\n    return ~(--x);\n}\nil int read(char *s){\n    int len=0;\n    register char ch=getchar();\n    while(ch==' '||ch=='\\n') ch=getchar();\n    while(ch!=' '&&ch!='\\n'&&ch!=EOF) s[++len]=ch,ch=getchar();\n    return len;\n}\nil void write(const ll &x){if(x>9) write(x/10);putchar(x%10+'0');}\nil void print(const ll &x) {x<0?putchar('-'),write(~(x-1)):write(x);putchar('\\n');}\nil ll max(const ll &a,const ll &b){return a>b?a:b;}\nil ll min(const ll &a,const ll &b){return a<b?a:b;}\nconst int MAXN=2e5+7;\nstruct node\n{\n    int x,y;\n    bool operator <(const node &p)const{\n        return x==p.x?y>p.y:x>p.x;\n    }\n}a[MAXN];\nint n,k,L;\nint ma,mb,cnta,cntb,top;\nll tot;\nint mark[MAXN];\nstruct pll\n{\n    int fir,sec;\n};\npll vec[MAXN];\nll rmn=1e18;\nnamespace DPair{\n    int cnt1[256], cnt2[256], cnt3[256], cnt4[256];\n    pll temp[MAXN];\n    inline void RadixSort(pll a[], int l, int r){\n        memset(cnt1, 0, sizeof(cnt1));\n        memset(cnt2, 0, sizeof(cnt2));\n        memset(cnt3, 0, sizeof(cnt3));\n        memset(cnt4, 0, sizeof(cnt4));\n        for (int i = l;i <= r;++ i){\n            ++ cnt1[a[i].fir & 255];\n            ++ cnt2[a[i].fir >> 8 & 255];\n            ++ cnt3[a[i].fir >> 16 & 255];\n            ++ cnt4[a[i].fir >> 24 & 255];\n        }\n        for (int i = 1;i <= 255;++ i){\n            cnt1[i] += cnt1[i - 1];\n            cnt2[i] += cnt2[i - 1];\n            cnt3[i] += cnt3[i - 1];\n            cnt4[i] += cnt4[i - 1];\n        }\n        for (int i = r;i >= l;-- i) temp[cnt1[a[i].fir & 255] --] = a[i];\n        for (int i = r;i >= l;-- i) a[cnt2[temp[i].fir >> 8 & 255] --] = temp[i];\n        for (int i = r;i >= l;-- i) temp[cnt3[a[i].fir >> 16 & 255] --] = a[i];\n        for (int i = r;i >= l;-- i) a[cnt4[temp[i].fir >> 24 & 255] --] = temp[i];\n    }\n}\n\n\nbool checkb(){\n    int cnt=0;tot=cnta=cntb=top=0;\n    node *p=&a[1];\n    for(ri i=1;i<=n;++i,++p){\n        if(p->x+ma>=0&&p->y+mb>=0) ++cnt,tot+=p->x+p->y+ma+mb,cnta++,cntb++;\n        else if(p->x+ma>0){\n            cnta++,tot+=p->x+ma;\n            if(p->y+mb<rmn){\n                if(cnt+top<L) vec[++top]=(pll){p->y+mb,1};\n                rmn=p->y+mb;\n            }\n            else vec[++top]=(pll){p->y+mb,1};\n        }\n        else if(p->y+mb>0){\n            cntb++,tot+=p->y+mb;\n            if(p->x+ma<rmn){\n                if(cnt+top<L) vec[++top]=(pll){p->x+ma,2};\n                rmn=p->x+ma;\n            }\n            else vec[++top]=(pll){p->x+ma,2};\n        }\n        else{\n            if(p->x+ma+p->y+mb<rmn){\n                if(cnt+top<L) vec[++top]=(pll){p->x+ma+p->y+mb,3};\n                rmn=p->x+ma+p->y+mb;\n            }\n            else vec[++top]=(pll){p->x+ma+p->y+mb,3};\n        }\n    }\n    if(cnt<L){ \n        DPair :: RadixSort(vec, 1,top);\n        for(ri i=top;i&&cnt<L;--i){\n            tot+=vec[i].fir;\n            if(vec[i].sec&1) ++cntb;\n            if(vec[i].sec&2) ++cnta;\n            ++cnt;\n        }\n    }\n    return cntb<=k;\n}\nint mn=1e9,mx;\nbool checka(node p){\n    int l=p.x,r=p.y,sav=0;\n    while(l<=r){\n        mb=(l+r)>>1;\n        if(checkb()){\n            l=mb+1;\n            sav=mb;\n            if(cntb==k) break;\n        }\n        else r=mb-1;\n    }\n    mb=sav;\n    checkb();\n    return cnta<=k;\n}\nint main(){\n    // freopen(\"P5470_22.in\",\"r\",stdin);\n    // freopen(\"1.out\",\"w\",stdout);\n    for(ri T=read();T;--T){\n        mn=1e9,mx=0;\n        n=read(),k=read(),L=read();\n        for(ri i=1;i<=n;++i) a[i].x=read(),mn=min(a[i].x,mn),mx=max(a[i].x,mx);\n        for(ri i=1;i<=n;++i) a[i].y=read(),mn=min(a[i].y,mn),mx=max(a[i].y,mx);\n        sort(a+1,a+n+1);\n        int l=-mx,r=-mn;\n        ll ans=0;\n        node now=(node){-mx,-mn};\n        while(l<=r){\n            ma=(l+r)>>1;\n            if(checka(now)){\n                l=ma+1;\n                ans=tot-1ll*ma*k-1ll*mb*k;\n                now.x=mb-10;\n                if(cnta==k)break;\n            }\n            else r=ma-1,now.y=mb+10;\n        }\n        print(ans);\n    }\n    return 0;\n}\n```\n",
        "postTime": 1616767454,
        "uid": 206998,
        "name": "Krimson",
        "ccfLevel": 0,
        "title": "[NOI2019] \u5e8f\u5217"
    },
    {
        "content": "\u9996\u5148\uff0c\u5047\u8bbe $l$ \u4e2a\u516c\u5171\u90e8\u5206\u5df2\u7ecf\u786e\u5b9a\u4e86\uff0c\u663e\u7136\u76f4\u63a5\u9009 $k-l$ \u4e2a\u6700\u5927\u7684\u5c31\u662f\u6700\u4f18\u7684\u3002\n\n\u90a3\u4e48\u6211\u4eec\u628a $k$ \u4e2a\u90fd\u5148\u6309\u7167\u5927\u7684\u9009\uff0c\u7136\u540e\u901a\u8fc7\u53cd\u6094\u8d2a\u5fc3\uff0c\u6bcf\u4e00\u6b65\u8ba9\u516c\u5171\u90e8\u5206\u591a\u4e00\u4e2a\uff0c\u76f4\u5230\u53d8\u6210 $l$ \u4e2a\uff0c\u8fd9\u6837\u5c31\u662f\u6700\u4f18\u7684\u3002\n\n\u8003\u8651\u51e0\u79cd\u64cd\u4f5c\u80fd\u8ba9\u516c\u5171\u90e8\u5206\u591a\u4e00\u4e2a\u3002\n\n1. \u627e\u4e00\u4e2a\u9009\u4e86\u7684 $a_i$\uff0c\u548c\u4e00\u4e2a\u9009\u4e86\u7684 $b_j$\uff0c\u7136\u540e\u7528 $b_i$ \u4ee3\u66ff $b_j$\uff0c\u4ee3\u4ef7\u662f $b_i-b_j$\u3002\n2. \u627e\u4e00\u4e2a\u9009\u4e86\u7684 $b_i$\uff0c\u548c\u4e00\u4e2a\u9009\u4e86\u7684 $a_j$\uff0c\u7136\u540e\u7528 $a_i$ \u4ee3\u66ff $a_j$\uff0c\u4ee3\u4ef7\u662f $a_i-a_j$\u3002\n3. \u627e\u4e00\u4e2a\u9009\u4e86\u7684 $a_i$ \u548c $b_j$\uff0c\u518d\u627e\u4e00\u4e2a\u6ca1\u9009\u7684\u4f4d\u7f6e $k$\uff0c\u9009 $a_k$ \u548c $b_k$ \u4ee3\u66ff $a_i$ \u548c $b_j$\uff0c\u4ee3\u4ef7\u662f $a_k+b_k-a_i-b_j$\u3002\n4. \u627e\u4e00\u4e2a\u9009\u4e86\u7684 $a_i$ \u548c $b_j$\uff0c\u518d\u627e\u4e00\u4e2a\u90fd\u9009\u7684\u4f4d\u7f6e $k$\uff0c\u9009 $a_j$ \u548c $b_i$ \u4ee3\u66ff $a_k$ \u548c $b_k$\uff0c\u4ee3\u4ef7\u662f $a_j+b_i-a_k-b_k$\u3002\n\n\u62c6\u4e00\u4e0b\u4e0a\u9762\u7684\u5f0f\u5b50\uff0c\u7528 $6$ \u4e2a\u5806\u7ef4\u62a4 $a_i,-a_i,b_i,-b_i,a_i+b_i,-a_i-b_i$\u3002~~\u6bd4 CF436E \u8fd8\u6076\u5fc3\u3002~~\n\n[\u53cd\u6094\u8d2a\u5fc3\u7ec3\u4e60\u9898\u5355qwq](https://www.luogu.com.cn/training/8793)\n\n~~\u53c8\u81ed\u53c8\u957f\u7684~~\u4ee3\u7801\uff08\u9644\u5e26\u7b2c\u4e00\u4e2a\u6d4b\u8bd5\u70b9\u6570\u636e\uff09\n\n```cpp\n#include<iostream>\n#include<cstdio> \n#include<queue>\n#include<algorithm>\n#include<cstring>\n#define int long long\nusing namespace std;\ninline int read()\n{\n    char c=getchar();int x=0;bool f=0;\n    for(;!isdigit(c);c=getchar())f^=!(c^45);\n    for(;isdigit(c);c=getchar())x=(x<<1)+(x<<3)+(c^48);\n    if(f)x=-x;return x;\n}\nconst int N=2e5+5;\nstruct node\n{\n\tint id,num;\n\tnode(int x=0,int y=0)\n\t{\n\t\tid=x;\n\t\tnum=y;\n\t}\n\tbool operator <(const node &p)\n\tconst{\n\t\treturn num>p.num;\n\t}\n\tbool operator >(const node &p)\n\tconst{\n\t\treturn num<p.num;\n\t}\n}a[N],b[N];\nbool cmp(node x,node y)\n{\n\treturn x.id<y.id;\n}\nint n,l,K,op[N];\npriority_queue<node,vector<node>,greater<node> > q1,q2,q3,q4,q5,q6;\nint ans;\nvoid clear()\n{\n\twhile(!q1.empty()) q1.pop();\n\twhile(!q2.empty()) q2.pop();\n\twhile(!q3.empty()) q3.pop();\n\twhile(!q4.empty()) q4.pop();\n\twhile(!q5.empty()) q5.pop();\n\twhile(!q6.empty()) q6.pop();\n\tmemset(op,0,sizeof op);\n\tans=0;\n}\nvoid solve()\n{\n\tn=read();K=read();l=read();\n\tfor(int i=1;i<=n;i++)\n\ta[i].num=read(),a[i].id=i;\n\tfor(int i=1;i<=n;i++)\n\tb[i].num=read(),b[i].id=i;\n\tsort(a+1,a+n+1);\n\tsort(b+1,b+n+1);\n\tfor(int i=1;i<=K;i++)\n\tans+=a[i].num,op[a[i].id]++;\n\tfor(int i=1;i<=K;i++)\n\tans+=b[i].num,op[b[i].id]+=2;\n\tint cnt=0;\n\tfor(int i=1;i<=n;i++)\n\tif(op[i]==3) cnt++;\n\tsort(a+1,a+n+1,cmp);\n\tsort(b+1,b+n+1,cmp);\t\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tq1.push(node(i,a[i].num));\n\t\tq2.push(node(i,-a[i].num));\n\t\tq3.push(node(i,b[i].num));\n\t\tq4.push(node(i,-b[i].num));\n\t\tq5.push(node(i,a[i].num+b[i].num));\n\t\tq6.push(node(i,-a[i].num-b[i].num));\n\t}\n//\tfor(int i=1;i<=n;i++)\n//\tcout<<op[i];\n//\tcout<<endl;\n\tfor(int zwz=1;zwz<=l-cnt;zwz++)\n\t{\n\t//\tcout<<zwz<<endl;\n\t\tint now=-1e15,opt=0,i=0,j=0,k=0;\n\t//\tcout<<q3.size()<<endl;\n\t\twhile(!q3.empty()&&op[q3.top().id]!=1) q3.pop();\n\t\twhile(!q4.empty()&&op[q4.top().id]!=2) q4.pop();\n\t\tif(!q3.empty()&&!q4.empty())\n\t\t{\n\t\t\tint sum=b[q3.top().id].num-b[q4.top().id].num;\n\t\t\tif(sum>now)\n\t\t\t{\n\t\t\t\tnow=sum;\n\t\t\t\ti=q3.top().id;\n\t\t\t\tj=q4.top().id;\n\t\t\t\topt=1;\n\t\t\t}\n\t\t}\n\t\twhile(!q1.empty()&&op[q1.top().id]!=2) q1.pop();\n\t\twhile(!q2.empty()&&op[q2.top().id]!=1) q2.pop();\n\t\tif(!q1.empty()&&!q2.empty())\n\t\t{\n\t\t\tint sum=a[q1.top().id].num-a[q2.top().id].num;\n\t\t\tif(sum>now)\n\t\t\t{\n\t\t\t\tnow=sum;\n\t\t\t\ti=q1.top().id;\n\t\t\t\tj=q2.top().id;\n\t\t\t\topt=2;\n\t\t\t}\n\t\t}\n\t//\tcout<<zwz<<endl;\n\t\twhile(!q5.empty()&&op[q5.top().id]!=0) q5.pop();\n\t\twhile(!q2.empty()&&op[q2.top().id]!=1) q2.pop();\n\t\twhile(!q4.empty()&&op[q4.top().id]!=2) q4.pop();\n\t\tif(!q5.empty()&&!q4.empty()&&!q2.empty())\n\t\t{\n\t\t\tint sum=a[q5.top().id].num+b[q5.top().id].num-a[q2.top().id].num-b[q4.top().id].num;\n\t\t\tif(sum>now)\n\t\t\t{\n\t\t\t\tnow=sum;\n\t\t\t\ti=q2.top().id;\n\t\t\t\tj=q4.top().id;\n\t\t\t\tk=q5.top().id;\n\t\t\t\topt=3;\n\t\t\t}\n\t\t}\n\t//\tcout<<zwz<<endl;\n\t\twhile(!q6.empty()&&op[q6.top().id]!=3) q6.pop();\n\t\twhile(!q1.empty()&&op[q1.top().id]!=2) q1.pop();\n\t\twhile(!q3.empty()&&op[q3.top().id]!=1) q3.pop();\n\t\tif(!q6.empty()&&!q3.empty()&&!q1.empty())\n\t\t{\n\t\t\tint sum=a[q1.top().id].num+b[q3.top().id].num-a[q6.top().id].num-b[q6.top().id].num;\n\t\t\tif(sum>now)\n\t\t\t{\n\t\t\t\tnow=sum;\n\t\t\t\ti=q3.top().id;\n\t\t\t\tj=q1.top().id;\n\t\t\t\tk=q6.top().id;\n\t\t\t\topt=4;\n\t\t\t}\n\t\t}\n\t//\tcout<<zwz<<endl;\n\t\tans+=now;\n\t//\tcout<<now<<\" \"<<opt<<endl;\n\t//\tcout<<i<<\" \"<<j<<\" \"<<k<<endl;\n\t\tif(opt==1)\n\t\t{\n\t\t\top[i]=3;\n\t\t\top[j]=0;\n\t\t\t//cout<<q3.size()<<endl;\n\t\t\tq3.pop();q4.pop();\n\t\t//\tcout<<q3.size()<<endl;\n\t\t\tq6.push(node(i,-a[i].num-b[i].num));\n\t\t\tq5.push(node(j,a[j].num+b[j].num));\n\t\t}\n\t\telse if(opt==2)\n\t\t{\n\t\t\top[i]=3;\n\t\t\top[j]=0;\n\t\t\tq1.pop();q2.pop();\n\t\t\tq6.push(node(i,-a[i].num-b[i].num));\n\t\t\tq5.push(node(j,a[j].num+b[j].num));\t\t\t\n\t\t}\n\t\telse if(opt==3)\n\t\t{\n\t\t\top[k]=3;\n\t\t\top[i]=op[j]=0;\n\t\t\tq2.pop();q4.pop();q5.pop();\n\t\t\tq6.push(node(k,-a[k].num-b[k].num));\n\t\t\tq5.push(node(i,a[i].num+b[i].num));\n\t\t\tq5.push(node(j,a[j].num+b[j].num));\n\t\t}\n\t\telse\n\t\t{\n\t\t\top[k]=0;\n\t\t\top[i]=op[j]=3;\n\t\t\tq1.pop();q3.pop();q6.pop();\n\t\t\tq6.push(node(i,-a[i].num-b[i].num));\n\t\t\tq6.push(node(j,-a[j].num-b[j].num));\n\t\t\tq5.push(node(k,a[k].num+b[k].num));\n\t\t}\n\t//\tcout<<q3.size()<<endl;\n\t//\tsystem(\"pause\");\n\t}\n\tcout<<ans<<endl;\n}\nsigned main()\n{\n\tint T=read();\n\twhile(T--)\n\t{\n\t\tclear();\n\t\tsolve();\n\t}\n \treturn 0;\n}\n/*\n10\n5 2 1\n965603156 594151484 137421888 511721918 163053182\n239833925 530765178 939584446 407283748 456390712\n6 3 1\n563597651 744310197 650756091 459159791 905965537 501095539\n436402349 255689803 349243909 650771685 210810349 498904461\n5 2 1\n22583989 839924760 708231676 112954530 76654839\n903218601 411750909 214760058 460569766 162867801\n3 1 1\n152517359 551481336 649305529\n141934634 773929513 350494617\n6 3 1\n464020128 779739924 684448073 705217786 801717091 157102288\n568955227 245753356 441864136 294782214 313154002 935222153\n1 1 1\n699242980\n459838444\n7 4 1\n887100126 373954728 331917628 425297229 570948801 702368573 545916379\n143951398 675892241 674371136 619857308 429051199 297631427 454083621\n5 2 2\n40869605 220229669 66179050 924234004 522215952\n547926918 283456228 534215193 131503240 145556018\n3 1 1\n746003558 889997254 514823835\n318446236 133597131 526467792\n4 2 2\n946692615 576958060 193743104 148410523\n939939583 524058103 475154057 418784570\n\n*/\n/*\n3030104264\n3799951880\n2863125946\n1325410849\n4211946604\n1159081424\n5130538185\n1723509214\n1064449794\n2987648361\n*/\n```\n",
        "postTime": 1611495308,
        "uid": 196899,
        "name": "lndjy",
        "ccfLevel": 9,
        "title": "P5470 \u3010[NOI2019] \u5e8f\u5217\u3011\u505a\u9898\u8bb0\u5f55/\u9898\u89e3"
    },
    {
        "content": "\u662f myy \u7684\u9898 orz\r\n\r\n\u7b97\u662f\u4e00\u9053\u5bf9\u524d\u7f6e\u77e5\u8bc6\u8981\u6c42\u4e0d\u7b97\u9ad8\uff0c\u4e3b\u8981\u8003\u9a8c\u601d\u7ef4\u4ee5\u53ca\u5efa\u6a21\u80fd\u529b\u7684\u597d\u9898\u3002\r\n\r\n## \u8d39\u7528\u6d41\r\n\r\n\u7a0d\u52a0\u601d\u8003\u540e\u6211\u4eec\u5efa\u7acb\u4e86\u4e00\u4e2a\u8fd9\u6837\u7684\u6a21\u578b\uff1a\r\n\r\n![](https://cdn.luogu.com.cn/upload/image_hosting/knocjpbv.png)\r\n\r\n\u6ce8\uff1a\u6211\u4eec\u8bb0 $(x,y)$ \u8868\u793a\u8fd9\u662f\u4e00\u6761\u6d41\u91cf\u4e3a $x$\uff0c\u8d39\u7528\u4e3a $y$ \u7684\u8fb9\uff0c\u7279\u522b\u5730\uff0c\u6ca1\u6709\u6807\u8bb0\u8fb9\u6743\u7684\u8fb9\u5168\u90e8\u9ed8\u8ba4\u4e3a $(1,0)$\u3002\r\n\r\n\u8fd9\u4e2a\u56fe\u7684\u542b\u4e49\u6bd4\u8f83\u663e\u7136\u3002\r\n\r\n1. \u5982\u679c\u6211\u4eec\u9009\u62e9\u4e86\u6d41 $a_i \\to b_i$ \u7684\u8fb9\uff0c\u5219\u8868\u793a\u540c\u65f6\u9009 $a_i$ \u548c $b_i$ \u8fd9\u6837\u4e00\u7ec4\u4e0b\u6807\u76f8\u7b49\u7684\u6570\u3002\r\n2. \u5982\u679c\u6211\u4eec\u9009\u62e9\u4e86\u6d41 $a_p \\to b_p$ \u7684\u8fb9\uff08\u4e0b\u6587\u6211\u4eec\u79f0\u8fd9\u6837\u7684\u6d41\u4e3a\u300c\u81ea\u7531\u6d41\u300d\uff09\uff0c\u5219\u4ee3\u8868\u6211\u4eec\u9009\u4e86\u4e24\u4e2a\u4e0b\u6807\u4e0d\u540c\u7684\u6570\u3002\u7531\u6d41\u91cf\u9650\u5236\u53ef\u77e5\u6211\u4eec\u6700\u591a\u9009 $k-l$ \u5bf9\u8fd9\u6837\u7684\u6570\uff0c\u521a\u597d\u7b26\u5408\u9898\u76ee\u8981\u6c42\u3002\r\n\r\n\u6211\u4eec\u7684\u76ee\u6807\u662f\u6c42\u51fa\u5176\u6d41\u91cf\u4e0d\u8d85\u8fc7 $k$ \u7684\u524d\u63d0\u4e0b\u7684\u6700\u5927\u8d39\u7528\u3002\r\n\r\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(k \\times \\operatorname{SSSP}(n))$\uff08$\\operatorname{SSSP}(n)$ \u4ee3\u8868\u6c42\u6709 $n$ \u4e2a\u70b9\u7684\u7a00\u758f\u56fe\uff08\u5373 $n$ \u4e0e $m$ \u540c\u9636\uff09\u7684\u5355\u6e90\u6700\u77ed\u8def\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff09\uff0c\u671f\u671b\u5f97\u5206 $64$ pts\u3002\r\n\r\n## \u8d39\u7528\u6d41 Ex\uff08\u6a21\u62df\u8d39\u7528\u6d41\uff09\r\n\r\n\u4e0a\u9762\u8fd9\u4e2a\u505a\u6cd5\u6548\u7387\u4e0d\u4f73\u7684\u539f\u56e0\uff0c\u4e3b\u8981\u662f\u5728\u627e\u589e\u5e7f\u8def\u4e0a\u3002\r\n\r\n\u6ce8\u610f\u5230 EK \u7b97\u6cd5\u7684\u5b9e\u8d28\u662f\u627e\u56fe\u4e2d\u4ece $s$ \u5230 $t$ \u7684\u6700\u77ed\uff08\u957f\uff09\u8def\uff0c\u5982\u679c\u6211\u4eec\u80fd\u7528\u6570\u636e\u7ed3\u6784\uff08\u4f8b\u5982\u4e8c\u53c9\u5806\uff09\u6765\u7ef4\u62a4\u8fd9\u4e2a\u4fe1\u606f\uff0c\u6bcf\u6b21\u627e\u589e\u5e7f\u8def\u7684\u65f6\u95f4\u5c31\u53ef\u4ee5\u505a\u5230 $O(\\log n)$\u3002\r\n\r\n\u8fd9\u5c31\u662f**\u6a21\u62df\u8d39\u7528\u6d41**\u7684\u601d\u60f3\u3002\u5373\u6211\u4eec\u901a\u8fc7\u4e8c\u53c9\u5806\u8fd9\u6837\u7684\u6570\u636e\u7ed3\u6784\u66f4\u9ad8\u6548\u5730\u627e\u5230\u589e\u5e7f\u8def\uff0c\u76f8\u8f83\u4e8e\u7528\u6700\u77ed\u8def\u7b97\u6cd5\u627e\u589e\u5e7f\u8def\u6548\u7387\u9ad8\u4e86\u4e0d\u5c11\u3002\r\n\r\n\u73b0\u5728\u6211\u4eec\u6765\u7406\u7406\u601d\u8def\u3002\u4e00\u6761\u589e\u5e7f\u8def\u53ef\u80fd\u662f\u600e\u6837\u7684\u5462\uff1f\r\n\r\n1. \u81ea\u7531\u6d41\uff1b\r\n2. \u76f4\u63a5\u627e\u4e00\u5bf9\u4e0b\u6807\u76f8\u540c\u4e14\u5747\u6ca1\u6709\u88ab\u9009\u62e9\u7684\u6570\u5b57\uff1b\r\n3. \u7ed9 $a$ \u6570\u7ec4\u4e2d\u5df2\u7ecf\u9009\u62e9\u4f46\u5c1a\u672a\u914d\u5bf9\u7684\u6570\u8fdb\u884c\u4e00\u6b21\u914d\u5bf9\uff1b\r\n4. \u7ed9 $b$ \u6570\u7ec4\u4e2d\u5df2\u7ecf\u9009\u62e9\u4f46\u5c1a\u672a\u914d\u5bf9\u7684\u6570\u8fdb\u884c\u4e00\u6b21\u914d\u5bf9\uff1b\r\n\r\n\u4e00\u4e2a\u663e\u7136\u7684\u4e8b\u5b9e\u662f\uff1a**\u81ea\u7531\u6d41\u5728\u56db\u79cd\u51b3\u7b56\u4e2d\u4e00\u5b9a\u662f\u6700\u4f18\u7684**\u3002\u56e0\u6b64\u6211\u4eec\u5728\u6761\u4ef6\u5141\u8bb8\u7684\u60c5\u51b5\u4e0b\u5148\u8003\u8651\u81ea\u7531\u6d41\u3002\r\n\r\n\u81ea\u7531\u6d41\u6d41\u6ee1\u4e86\u600e\u4e48\u529e\uff1f\u8003\u8651\u5269\u4e0b\u4e09\u79cd\u51b3\u7b56\u3002\r\n\r\n\u5bf9\u4e8e\u7b2c\u4e8c\u79cd\u51b3\u7b56\uff0c\u6211\u4eec\u663e\u7136\u6311 $a_i+b_i$ \u6700\u5927\u7684\u3002\r\n\r\n\u5bf9\u4e8e\u7b2c\u4e09\u79cd\u51b3\u7b56\uff0c\u53cd\u6620\u5728\u56fe\u4e0a\u7684\u5b9e\u8d28\u662f\uff1a\u6211\u4eec\u5c06 $a_i \\to a_p$ \u7684\u6d41\u64a4\u9500\uff0c\u6539\u4e3a\u6d41 $a_i \\to b_i \\to t$\u3002\u8fd9\u6837\u4f1a\u4f7f\u5f97 $a_p$ \u7684\u5165\u6d41\u91cf\u5c11\u4e00\uff0c\u56e0\u6b64\u6211\u4eec\u8fd8\u8981\u518d\u6d41 $a_j \\to a_p$ \u4ee5\u6ee1\u8db3\u6d41\u91cf\u5e73\u8861\u3002\r\n\r\n\u4e0a\u9762\u4e24\u4e2a\u6b65\u9aa4\u662f\u72ec\u7acb\u7684\uff0c\u56e0\u6b64\u6700\u660e\u667a\u7684\u505a\u6cd5\u662f\u6311 $a$ \u6570\u7ec4\u4e2d\u5df2\u7ecf\u9009\u62e9\u4f46\u5c1a\u672a\u914d\u5bf9\u7684\u6570\u5b57\u4e2d\uff0c\u76f8\u5e94\u7684 $b$ \u6700\u5927\u7684\u6570\u8fdb\u884c\u914d\u5bf9\uff0c\u968f\u540e\u518d\u6311\u4e00\u4e2a\u6700\u5927\u7684\uff0c\u4e4b\u524d\u672a\u88ab\u9009\u7684 $a_j$ \u52a0\u5165\u7b54\u6848\u3002\r\n\r\n\u51b3\u7b56\u56db\u4e0e\u51b3\u7b56\u4e09\u540c\u7406\u3002\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u3002\r\n\r\n\u6211\u4eec\u53d1\u73b0\u6211\u4eec\u53ea\u9700\u7ef4\u62a4\u6700\u5927\u503c\uff0c\u56e0\u6b64\u7528\u5806\u6765\u7ef4\u62a4\u6211\u4eec\u6240\u9700\u7684\u4fe1\u606f\u5373\u53ef\u3002\r\n\r\n\u5230\u8fd9\u91cc\u5c31\u5b8c\u4e86\uff1f\u4e8b\u5b9e\u4e0a\uff0c\u5728\u589e\u5e7f\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u53ef\u80fd\u9047\u5230\u8fd9\u4e9b\u7ec6\u8282\u95ee\u9898\uff1a\r\n\r\n1. \u81ea\u7531\u6d41\u521a\u597d\u9009\u4e86\u4e0b\u6807\u76f8\u540c\u7684\u4e24\u4e2a\u6570\u3002\u8fd9\u65f6\u5019\u89c6\u4e3a\u4f5c\u51b3\u7b56\u4e8c\u5373\u53ef\uff08\u6d41 $a_i \\to b_i$\uff09\uff0c\u5c06\u81ea\u7531\u6d41\u7684\u6d41\u91cf\u7559\u7ed9\u540e\u9762\u7684\u6570\u5b57\u3002\u5e76\u4e14\uff0c\u5982\u679c\u540e\u6765\u7684\u81ea\u7531\u6d41\u521a\u597d\u80fd\u4f7f\u5f97\u4e00\u4e9b\u6570\u914d\u5bf9\uff0c\u6211\u4eec\u4e5f\u8be5\u5c06\u81ea\u7531\u6d41\u7684\u6d41\u91cf\u53ca\u65f6\u91ca\u653e\u3002\r\n2. \u6ce8\u610f\u5230\u51b3\u7b56\u4e8c**\u4e00\u5b9a**\u4e0d\u4f1a\u91ca\u653e\u81ea\u7531\u6d41\uff0c\u56e0\u6b64\u51fa\u4e8e\u8ba9\u81ea\u7531\u6d41\u6700\u5927\u5316\u5229\u7528\u7684\u76ee\u7684\uff0c\u6211\u4eec\u5148\u8003\u8651\u51b3\u7b56\u4e09\u548c\u51b3\u7b56\u56db\u3002\r\n3. \u51b3\u7b56\u4e09\u548c\u51b3\u7b56\u56db\u7684\u589e\u5e7f\u8def\u5747\u4e3a\u6700\u4f18\uff1f\u8fd8\u662f\u51fa\u4e8e\u8ba9\u81ea\u7531\u6d41\u6700\u5927\u5316\u5229\u7528\u7684\u76ee\u7684\uff0c\u9009\u62e9\u80fd\u91ca\u653e\u51fa\u81ea\u7531\u6d41\u7684\u51b3\u7b56\u3002\r\n\r\n\u8fd9\u6837\u6211\u4eec\u5c31\u5c06\u672c\u9898\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4f18\u5316\u5230\u4e86 $O(n \\log n)$\u3002\r\n\r\n\u66f4\u591a\u7ec6\u8282\u53ef\u4ee5\u770b\u6211\u4ee3\u7801\u91cc\u7684\u6ce8\u91ca\u3002\r\n\r\n```cpp\r\n// Problem : P5470 [NOI2019]\u5e8f\u5217\r\n// Contest : Luogu\r\n// URL : https://www.luogu.com.cn/problem/P5470\r\n// Memory Limit : 500 MB\r\n// Time Limit : 1000 ms\r\n// Powered by CP Editor (https://github.com/cpeditor/cpeditor)\r\n\r\n#include <cstring>\r\n#include <iostream>\r\n#include <queue>\r\nusing namespace std;\r\nstruct node {\r\n  int id, x;\r\n  bool operator<(const node& a) const { return x < a.x; }\r\n};\r\npriority_queue<node> q1, q2;  //\u7ef4\u62a4\u5c1a\u672a\u9009\u62e9\u7684\u6570\u5b57\r\npriority_queue<node> q3;      //\u7ef4\u62a4\u5c1a\u672a\u9009\u62e9\u7684\u5bf9\r\npriority_queue<node> q4, q5;  //\u7ef4\u62a4\u5f85\u914d\u5bf9\u7684\u6570\r\n//\u6ce8\u610f\u4ee3\u7801\u4e2d\u7528\u4e86\u61d2\u60f0\u5220\u9664\uff0c\u4e00\u4e2a\u6570\u5b57\u5982\u679c\u4e0d\u7b26\u5408\u6761\u4ef6\u4e0d\u4f1a\u88ab\u7acb\u523b\u4ece\u5806\u4e2d\u5220\u9664\uff0c\u800c\u662f\u5728\u5176\u88ab\u53d6\u51fa\u5806\u65f6\u518d\u8fdb\u884c\u5220\u9664\r\nint a[200005], b[200005];\r\nint vis1[200005], vis2[200005];\r\nint main() {\r\n  ios::sync_with_stdio(false);\r\n  int T;\r\n  cin >> T;\r\n  while (T--) {\r\n    memset(vis1, 0, sizeof(vis1));\r\n    memset(vis2, 0, sizeof(vis2));\r\n    while (!q1.empty()) q1.pop();\r\n    while (!q2.empty()) q2.pop();\r\n    while (!q3.empty()) q3.pop();\r\n    while (!q4.empty()) q4.pop();\r\n    while (!q5.empty()) q5.pop();\r\n    int n, k, l;\r\n    long long ans = 0;\r\n    cin >> n >> k >> l;\r\n    for (int i = 1; i <= n; i++) {\r\n      cin >> a[i];\r\n      q1.push({i, a[i]});\r\n    }\r\n    for (int i = 1; i <= n; i++) {\r\n      cin >> b[i];\r\n      q2.push({i, b[i]});\r\n    }\r\n    int cnt = 0, rem = k - l;\r\n    for (int i = 1; i <= n; i++) q3.push({i, a[i] + b[i]});\r\n\r\n    while (cnt < k) {\r\n      //\u81ea\u7531\u6d41\u4e00\u5b9a\u6700\u4f18\uff0c\u56e0\u6b64\u5148\u8003\u8651\u81ea\u7531\u6d41\r\n      if (rem) {\r\n        while (vis1[q1.top().id])  //\u61d2\u60f0\u5220\u9664\r\n          q1.pop();\r\n        while (vis2[q2.top().id]) q2.pop();\r\n        int u = q1.top().id, v = q2.top().id;\r\n        ans += a[u] + b[v];\r\n        vis1[u] = vis2[v] = 1;\r\n        cnt++;\r\n        if (u != v) {\r\n          rem--;\r\n          rem += (vis1[u] && vis2[u]) + (vis1[v] && vis2[v]);\r\n          //\u91ca\u653e\u81ea\u7531\u6d41\u7684\u6d41\u91cf\r\n        }\r\n        if (!vis2[u])  //\u52a0\u5165\u5f85\u914d\u5bf9\u5217\u8868\r\n          q4.push({u, b[u]});\r\n        if (!vis1[v]) q5.push({v, a[v]});\r\n        q1.pop(), q2.pop();\r\n        continue;\r\n      }\r\n\r\n      //\u76f4\u63a5\u52a0\u4e00\u5bf9\r\n      int num1 = 0, id1 = 0;\r\n      while (!q3.empty()) {\r\n        int id = q3.top().id, x = q3.top().x;\r\n        if (vis1[id] || vis2[id])  //\u8fd8\u662f\u61d2\u60f0\u5220\u9664\r\n          q3.pop();\r\n        else {\r\n          num1 = x, id1 = id;\r\n          break;\r\n        }\r\n      }\r\n\r\n      //\u7ed9 a \u6570\u7ec4\u4e2d\u7684\u6570\u914d\u5bf9\r\n      int num2 = 0, id2a = 0, id2b = 0;\r\n      while (!q4.empty() && vis2[q4.top().id]) q4.pop();\r\n      if (!q4.empty()) id2b = q4.top().id, num2 += q4.top().x;\r\n      while (vis1[q1.top().id]) q1.pop();\r\n      id2a = q1.top().id, num2 += q1.top().x;\r\n\r\n      //\u7ed9 b \u6570\u7ec4\u4e2d\u7684\u6570\u914d\u5bf9\r\n      int num3 = 0, id3a = 0, id3b = 0;\r\n      while (!q5.empty() && vis1[q5.top().id]) q5.pop();\r\n      if (!q5.empty()) id3a = q5.top().id, num3 += q5.top().x;\r\n      while (vis2[q2.top().id]) q2.pop();\r\n      id3b = q2.top().id, num3 += q2.top().x;\r\n\r\n      int maxa = max(num1, max(num2, num3));\r\n      ans += maxa;\r\n      if (num2 == num3 && maxa == num2) {\r\n        if (vis2[id2a])  //\u8003\u8651\u4f18\u5148\u91ca\u653e\u81ea\u7531\u6d41\r\n        {\r\n          rem++;\r\n          vis1[id2a] = 1, q1.pop();\r\n          vis2[id2b] = 1, q4.pop();\r\n        } else if (vis1[id3b]) {\r\n          rem++;\r\n          vis2[id3b] = 1, q2.pop();\r\n          vis1[id3a] = 1, q5.pop();\r\n        } else {\r\n          vis1[id2a] = 1, q1.pop();\r\n          vis2[id2b] = 1, q4.pop();\r\n          q4.push({id2a, b[id2a]});\r\n        }\r\n      } else if (maxa == num2) {\r\n        vis1[id2a] = 1, q1.pop();\r\n        vis2[id2b] = 1, q4.pop();\r\n        if (vis2[id2a])\r\n          rem++;  //\u91ca\u653e\u81ea\u7531\u6d41\r\n        else\r\n          q4.push({id2a, b[id2a]});  //\u8bb0\u5f97\u7ef4\u62a4\u5f85\u914d\u5bf9\u6570\u5217\u8868\r\n      } else if (maxa == num3) {\r\n        vis2[id3b] = 1, q2.pop();\r\n        vis1[id3a] = 1, q5.pop();\r\n        if (vis1[id3b])\r\n          rem++;\r\n        else\r\n          q5.push({id3b, a[id3b]});\r\n      } else if (maxa == num1) {\r\n        vis1[id1] = vis2[id1] = 1;\r\n        q3.pop();\r\n      }\r\n      cnt++;\r\n    }\r\n    cout << ans << endl;\r\n  }\r\n  return 0;\r\n}\r\n```",
        "postTime": 1592931151,
        "uid": 22030,
        "name": "StudyingFather",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5470 \u3010[NOI2019]\u5e8f\u5217\u3011"
    },
    {
        "content": "[\u539f\u9898\u4f20\u9001\u95e8](https://www.luogu.org/problemnew/solution/P5468)\n\n[\u66f4\u597d\u7684\u9605\u8bfb](https://www.cnblogs.com/yzhang-rp-inf/p/11200711.html)\n\n\u540c\u6b65\u8d5b\u4e0a\u6211\u4e00\u5f00\u59cb\u60f3\u4e86\u4e2a\u770b\u4f3c\u6b63\u786e\u5374\u6f0f\u6d1e\u767e\u51fa\u7684\u8d2a\u5fc3\uff1a\u6309$a_i+b_i$\u7684\u548c\u4ece\u5927\u5411\u5c0f\u8d2a\u5fc3\n\n\u968f\u4fbf\u60f3\u60f3\u53d1\u73b0\u662f\u5047\u7684\uff0c\u7136\u540e\u5c31\u5199\u4e86\u4e2a28pts\u7684\u66b4\u529bdp\n\n\u675c\u795e\u540e\u534a\u7a0b\u8bf4\u8fd9\u9898\u5c31\u662f\u4e2a\u8d2a\u5fc3\uff0c\u4f46\u6211\u6ca1\u65f6\u95f4\u5199\u4e86 ~~\uff08\u5b9e\u9645\u662f\u6ca1\u60f3\u660e\u767d\uff09~~\n\n\u6211\u4eec\u6765\u8bf4\u8fd9\u9053\u9898\u7684\u6b63\u89e3\uff1a\n\n\u6211\u4eec\u5148\u73c2\u4ee5\u6ee1\u8db3\u548c\u6700\u5927\uff0c\u518d\u6ee1\u8db3\u5e76\u96c6\u5927\u5c0f\u5927\u4e8e\u7b49\u4e8e$l$\u3002\u6240\u4ee5\u6211\u4eec\u5148\u5c06$a$\u5e8f\u5217\u548c$b$\u5e8f\u5217\u6392\u5e8f\uff0c\u53d6\u51fa\u4e24\u4e2a\u5e8f\u5217\u7684\u524d$k$\u5927\n\n\u5982\u679c\u5e76\u96c6\u5927\u5c0f\u5927\u4e8e\u7b49\u4e8e$l$\u5c31\u76f4\u63a5\u7edf\u8ba1\u7b54\u6848\n\n\u5426\u5219\u6211\u4eec\u8981\u51d1\u6ee1$l$\u4e2a\u90fd\u5305\u542b\u7684\uff0c\u5728\u51d1\u7684\u8fc7\u7a0b\u4e2d\u52a8\u6001\u66f4\u65b0\u7b54\u6848\n\n\u6211\u4eec\u5728\u4e24\u4e2a\u5e8f\u5217\u4e2d\u90fd\u9009\u4e2d\u524d$k-l$\u4e2a\u4e0d\u542b\u6709\u5e76\u96c6\u7684\u6570\uff0c\u5e76\u52a0\u5165\u7b54\u6848\u4e2d\uff0c\u6613\u77e5\u8fd9\u4e9b\u6570\u4e00\u5b9a\u542b\u5728\u7b54\u6848\u4e2d\uff08\u8fd9\u4e2a\u73c2\u4ee5\u5728\u8349\u7a3f\u7eb8\u4e0a\u63a8\u4e00\u63a8\uff09\u3002\u63a5\u4e0b\u6765\u8003\u8651\u5982\u4f55\u51d1\u5e76\u96c6\u5143\u7d20\uff0c\u4e00\u6b21\u51d1\u4e00\u7ec4\uff1a\n\n1.\u4e24\u4e2a\u90fd\u6ca1\u88ab\u9009\u4e2d\u7684\u60c5\u51b5\u4e0b\u7684\u6700\u5927\u503c\uff0c\u5e76\u5c06\u5b83\u4eec\u9009\u4e2d\n\n2.\u4e00\u4e2a\u88ab\u9009\u4e2d\u7684\u60c5\u51b5\u4e0b\u7684\u6700\u5927\u503c\u3002\u5047\u8bbe$a[rk[i]]$\u9009\u4e2d\u4e86\uff0c\u4f46$b[rk[i]]$\u6ca1\u9009\u4e2d\uff0c\u6211\u4eec\u5c31\u8981\u627e\u5230\u4e00\u4e2a\u6700\u5c0f\u7684j\u4f7f\u5f97$a[rk[j]]$\u6ca1\u88ab\u9009\u4e2d\uff0c\u6211\u4eec\u5c31\u73c2\u4ee5\u9009\u4e2d$b[rk[i]$\u548c$a[rk[j]]$\uff0c\u4f7f\u5f97a\u4e2d\u4e0d\u6210\u5bf9\u7684\u8fd8\u662f$k-l$\u4e2a\u3002a,b\u53cd\u4e4b\u4ea6\u7136\n\n\u6211\u4eec\u6c42\u51fa1\u30012\u4e24\u79cd\u60c5\u51b5\u8d21\u732e\u6700\u5927\u503c\u5e76\u66f4\u65b0\u9009\u4e2d\u72b6\u6001\uff08\u90fd\u7528\u5806\u7ef4\u62a4\uff0c\u5177\u4f53\u7ec6\u8282\u89c1\u4ee3\u7801\uff09\uff0c\u91cd\u590d$l$\u6b21\u5373\u53ef\u6c42\u51fa\u7b54\u6848\n\n\u6ce8\u610f\uff1a\u4e24\u6b212\u4e5f\u8bb8\u5c31\u4f1a\u5c06\u4e24\u4e2a\u90fd\u6ca1\u9009\u4e2d\u7684\u53d8\u6210\u90fd\u9009\u4e2d\uff0c\u6240\u4ee5**\u8981\u53ca\u65f6\u820d\u6389\u4e0d\u5408\u6cd5\u7684**\n\n```cpp\n#include <bits/stdc++.h>\n#define N 200005\n#define ll long long\n#define getchar nc\nusing namespace std;\ninline char nc(){\n    static char buf[100000],*p1=buf,*p2=buf;\n    return p1==p2&&(p2=(p1=buf)+fread(buf,1,100000,stdin),p1==p2)?EOF:*p1++;\n}\ninline int read()\n{\n    register int x=0,f=1;register char ch=getchar();\n    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n    while(ch>='0'&&ch<='9')x=(x<<3)+(x<<1)+ch-'0',ch=getchar();\n    return x*f;\n}\ninline void write(register ll x)\n{\n    if(!x)putchar('0');if(x<0)x=-x,putchar('-');\n    static int sta[20];register int tot=0;\n    while(x)sta[tot++]=x%10,x/=10;\n    while(tot)putchar(sta[--tot]+48);\n}\nint T,n,k,l,a[N],b[N],ar[N],br[N],va[N],vb[N],vis[N];\nll ans;\ninline bool cmpa(register int x,register int y)\n{\n    return a[x]>a[y];\n}\ninline bool cmpb(register int x,register int y)\n{\n    return b[x]>b[y];\n}\nstruct node{\n    int pos,val;\n    inline bool operator < (const node &it) const {\n        return val<it.val;\n    }\n};\ninline bool chkmax(register int &a,register int b)\n{\n    return a<b?a=b,1:0;\n}\nint main()\n{\n    T=read();\n    while(T--)\n    {\n        n=read(),k=read(),l=read();\n        for(register int i=1;i<=n;++i)\n            a[i]=read(),ar[i]=i,va[i]=vb[i]=vis[i]=0;\n        for(register int i=1;i<=n;++i)\n            b[i]=read(),br[i]=i;\n        sort(ar+1,ar+1+n,cmpa);\n        sort(br+1,br+1+n,cmpb);\n        for(register int i=1;i<=k;++i)\n            va[ar[i]]=1,vb[br[i]]=1;\n        ans=0;\n        priority_queue<int> pa,pb;\n        priority_queue<node> qa,qb;\n        for(register int i=1;i<=n;++i)\n            if(va[i]&&vb[i])\n                qb.push((node){i,a[i]+b[i]}),vis[i]=1;\n        if(qb.size()>=l)\n        {\n            for(register int i=1;i<=n;++i)\n            {\n                if(va[i])\n                    ans+=a[i];\n                if(vb[i])\n                    ans+=b[i];\n            }\n        }\n        else\n        {\n            for(register int i=1,tot=0;i<=k;++i)\n                if(!vb[ar[i]])\n                {\n                    if(tot<k-l)\n                        ans+=a[ar[i]],vis[ar[i]]=1,pa.push(b[ar[i]]);\n                    else\n                        qa.push((node){ar[i],a[ar[i]]+b[ar[i]]});\n                    ++tot;\n                }\n            for(register int i=1,tot=0;i<=n;++i)\n                if(!va[br[i]])\n                {\n                    if(tot<k-l)\n                        ans+=b[br[i]],vis[br[i]]=1,pb.push(a[br[i]]);\n                    else\n                        qb.push((node){br[i],a[br[i]]+b[br[i]]});\n                    ++tot;\n                }\n            int af=1,bf=1;\n            while(l--)\n            {\n                while(af<=k&&vis[ar[af]])\n                    ++af;\n                while(bf<=k&&vis[br[bf]])\n                    ++bf;\n                while(!qa.empty()&&vis[qa.top().pos]&&!(va[qa.top().pos]&&vb[qa.top().pos]))\n                    qa.pop();\n                while(!qb.empty()&&vis[qb.top().pos]&&!(va[qb.top().pos]&&vb[qb.top().pos]))\n                    qb.pop();\n                int maxx=0,typ=-1;\n                if(!qa.empty())\n                    maxx=qa.top().val,typ=0;\n                if(!qb.empty()&&chkmax(maxx,qb.top().val))\n                    typ=1;\n                if(!pa.empty()&&af<=k&&chkmax(maxx,pa.top()+a[ar[af]]))\n                    typ=2;\n                if(!pb.empty()&&bf<=k&&chkmax(maxx,pb.top()+b[br[bf]]))\n                    typ=3;\n                ans+=maxx;\n                if(typ==0)\n                    vis[qa.top().pos]=1,qa.pop();\n                else if(typ==1)\n                    vis[qb.top().pos]=1,qb.pop();\n                else if(typ==2)\n                    vis[ar[af]]=1,pa.pop(),pa.push(b[ar[af]]);\n                else\n                    vis[br[bf]]=1,pb.pop(),pb.push(a[br[bf]]);\n            }\n        }\n        write(ans),puts(\"\");\n    }\n    return 0;\n}\n```\n\n\n",
        "postTime": 1563344140,
        "uid": 37881,
        "name": "yzhang",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5470 \u3010[NOI2019]\u5e8f\u5217\u3011"
    },
    {
        "content": "\u8fd9\u91cc\u4f7f\u7528\u4e00\u79cd\u53cd\u6094\u8d2a\u5fc3\u505a\u6cd5\u3002\n\n**\u9898\u5916\u8bdd\uff1a**\n\n\u9274\u4e8e\u6ca1\u6709\u4eba\u5bf9\u53cd\u6094\u8d2a\u5fc3\u5177\u4f53\u4ee3\u7801\u5b9e\u73b0\u8fc7\u591a\u4ecb\u7ecd\uff0c\u5bfc\u81f4\u6211\u8fd9\u4e2a\u4ee3\u7801\u80fd\u529b\u4f4e\u4e0b\u7684\u5783\u573e OIer \u5341\u5206\u56f0\u6270\uff0c\u6240\u4ee5\u8fd9\u91cc\u6839\u636e\u4ee3\u7801\u6765\u8bb2\u8bb2\u53cd\u6094\u8d2a\u5fc3\u5728\u8fd9\u9898\u7684\u5177\u4f53\u5b9e\u73b0\u3002\n\n**\u5927\u6982\u601d\u8def\uff1a**\n\n\u9996\u5148\u6211\u4eec\u5c31\u786c\u8d2a\uff0c$a,b$ \u4e24\u4e2a\u5e8f\u5217\u4e2d\u5206\u522b\u9009\u51fa $K$ \u4e2a\u6700\u5927\u7684\u3002\n\n\u63a5\u7740\u6211\u4eec\u8003\u8651\u6bcf\u6b21\u53d6\u589e\u91cf\u5c3d\u53ef\u80fd\u5927\uff08\u6700\u4f18\uff09\u7684\u90a3\u79cd\u64cd\u4f5c\u6765\u53cd\u6094\uff0c\u4f7f\u5f97\u6bcf\u6b21\u64cd\u4f5c\u540e\u90fd\u80fd\u4f7f\u5f53\u524d\u540c\u65f6\u51fa\u73b0\u5728\u4e24\u4e2a\u5e8f\u5217\u4e2d\u7684\u70b9\u6570\u591a\u4e00\u3002\n\n\u53cd\u6094\u64cd\u4f5c\u5206\u4e3a\u4ee5\u4e0b\u56db\u79cd\uff1a\uff08\u7a9d\u8bed\u6587\u592a\u83dc\u76f4\u63a5\u84af\u4e86\uff09\n\n+ \u627e\u4e00\u4e2a\u9009\u4e86\u7684 $a_i$\uff0c\u548c\u4e00\u4e2a\u9009\u4e86\u7684 $b_j$\uff0c\u7136\u540e\u7528 $b_i$ \u4ee3\u66ff $b_j$\uff0c\u589e\u91cf\u662f $b_i-b_j$\u3002 \uff08\u4ee3\u7801\u4e2d\u64cd\u4f5c3\uff09\n\n+ \u627e\u4e00\u4e2a\u9009\u4e86\u7684 $b_i$\uff0c\u548c\u4e00\u4e2a\u9009\u4e86\u7684 $a_j$\uff0c\u7136\u540e\u7528 $a_i$ \u4ee3\u66ff $a_j$\uff0c\u589e\u91cf\u662f $a_i-a_j$\u3002 \uff08\u4ee3\u7801\u4e2d\u64cd\u4f5c2\uff09\n\n+ \u627e\u4e00\u4e2a\u9009\u4e86\u7684 $a_i$ \u548c $b_j$\uff0c\u518d\u627e\u4e00\u4e2a\u6ca1\u9009\u7684\u4f4d\u7f6e $k$\uff0c\u9009 $a_k$ \u548c $b_k$ \u4ee3\u66ff $a_i$ \u548c $b_j$\uff0c\u589e\u91cf\u662f $a_k+b_k-a_i-b_j$\u3002 \uff08\u4ee3\u7801\u4e2d\u64cd\u4f5c4\uff09\n\n+ \u627e\u4e00\u4e2a\u9009\u4e86\u7684 $a_i$ \u548c $b_j$\uff0c\u518d\u627e\u4e00\u4e2a\u90fd\u9009\u7684\u4f4d\u7f6e $k$\uff0c\u9009 $a_j$ \u548c $b_i$ \u4ee3\u66ff $a_k$ \u548c $b_k$\uff0c\u589e\u91cf\u662f $a_j+b_i-a_k-b_k$\u3002 \uff08\u4ee3\u7801\u4e2d\u64cd\u4f5c1\uff09\n\n\u6240\u4ee5\u6211\u4eec\u5f00 $6$ \u4e2a\u5806\u5206\u522b\u7ef4\u62a4\uff1a$-ai-bi$\uff0c$-ai$\uff0c$bi$\uff0c$ai$\uff0c$-bi$\uff0c$ai+bi$ \u5373\u53ef\u7b97\u51fa\u589e\u91cf\uff0c\u8fdb\u884c\u53cd\u6094\u64cd\u4f5c\u3002\n\n**\u7c7b\u4f3c\u795e\u9898\uff1a**[CF436E](https://www.luogu.com.cn/problem/CF436E) \n\n\u4ee3\u7801\u4e2d\u5bf9\u4e8e\u4e00\u4e9b\u5751\u70b9\u548c\u5177\u4f53\u5b9e\u73b0\u6b65\u9aa4\u90fd\u6709\u5e94\u8be5\u5927\u6982\u53ef\u80fd\u6bd4\u8f83\u8be6\u7ec6\u7684\u6807\u6ce8\u3002\uff08\u84af\u7684lsy\u795e\u4ed9\u7684\uff09\n\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ninline int read(){\n\tint ans=0,f=0;char ch=getchar();\n\twhile(!isdigit(ch)) f|=(ch=='-'),ch=getchar();\n\twhile(isdigit(ch)) ans=(ans<<3)+(ans<<1)+(ch^48),ch=getchar();\n\treturn f?-ans:ans;\n}\nconst int N=1e6+5;\nconst long long INF=1e18;\nstruct zfz{\n\tint id,val;\n\tbool operator <(const zfz x)const{return val<x.val;}\n};\nint topop[N];//\u8868\u793a\u5806\u4e2d\uff0c\u5728\u539f\u5e8f\u5217\u7f16\u53f7\u4e3ai\u7684\u5143\u7d20\u7684a,b\u9009\u62e9\u72b6\u6001 \nstruct lsyOrz{ \n\tint op;\n\tpriority_queue<zfz> q;\n\tvoid upd(){while(!q.empty()&&topop[q.top().id]!=op) q.pop();}\n\tbool empty(){upd();return q.empty();}\n\tzfz top(){upd();return q.top();}\n\tvoid push(zfz x){q.push(x);}\n\tvoid clear(){while(!q.empty())q.pop();}\n}q1,q2,q3,q4,q5,q6;\n//q1: -ai-bi; q2: -ai; q3: bi; q4: ai; q5: -bi; q6: ai+bi; \nint T;\nint n,K,L;\nint a[N],b[N];\nint pa[N],pb[N];//\u6392\u5e8f\u6570\u7ec4 \nint visa[N],visb[N];\nbool cmp1(int x,int y){return a[x]<a[y];}\nbool cmp2(int x,int y){return b[x]<b[y];}\nvoid push0(int x){//\u8bbe\u4e3aa,b\u90fd\u4e0d\u9009\n\ttopop[x]=0;q6.push((zfz){x,a[x]+b[x]});\n}\nvoid push1(int x){//\u8bbe\u4e3aa,b\u90fd\u9009 \n\ttopop[x]=3;q1.push((zfz){x,-a[x]-b[x]});\n}\nsigned main(){\n\tfor(T=read();T;--T){\n\t\tlong long ans=0;\n\t\tq1.op=3,q2.op=q3.op=2,q4.op=q5.op=1,q6.op=0;\n\t\tq1.clear();q2.clear();q3.clear();q4.clear();q5.clear();q6.clear();\n\t\tmemset(visa,0,sizeof(visa)),memset(visb,0,sizeof(visb));\n\t\tn=read(),K=read(),L=read();\n\t\tfor(int i=1;i<=n;++i) a[i]=read(),pa[i]=i;\n\t\tfor(int i=1;i<=n;++i) b[i]=read(),pb[i]=i;\n\t\tsort(pa+1,pa+1+n,cmp1);//\u6392\u4e2a\u5e8f\uff0c\u9009\u524dK\u5927\u7684 \n\t\tsort(pb+1,pb+1+n,cmp2);\n\t\t//\u6ce8\u610f\u6392\u5e8f\u6709\u4e2a\u5751\u70b9\uff0c\u5982\u679c\u4f60\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\u53d6\u524dK\u4e2a\u7684\u8bdd\uff0c\n\t\t//\u5f53\u6709\u591a\u4e2a\u503c\u76f8\u540c\u4e14\u90fd\u7b26\u5408\u524dK\u5927\uff0c\u4f60\u53ef\u80fd\u4f1a\u9009\u62e9\u7f16\u53f7\u4e0d\u540c\u4f46\u672c\u8d28\uff08\u503c\uff09\u76f8\u540c\u7684\u70b9\uff0c\n\t\t//\u539f\u672c\u53ef\u4ee5\u6ee1\u8db3\u540c\u65f6\u5728a,b\u4e24\u4e2a\u5e8f\u5217\u91cc\u7684\u70b9\u5c31\u4f1a\u88ab\u62c6\u6563\uff0c\u6837\u4f8b\u4e2d\u7684\u7b2c\u4e09\u4e2a\u70b9\u5c31\u5b8c\u7f8e\u7684hack\u6389\u4e86\u8fd9\u79cd\u505a\u6cd5 \n\t\t//\u4ece\u5c0f\u5230\u5927\u53d6\u540eK\u4e2a\u5c31\u4e0d\u4f1a\uff0c\u5bf9\u4e8e\u6ee1\u8db3\u524dK\u5927\u7684\u53d6\u503c\uff0c\u4f60\u90fd\u4f1a\u9009\u5c3d\u53ef\u80fd\u9760\u540e\u7684\u70b9\uff08sort\u7279\u6027\uff09\n\t\tfor(int i=n-K+1;i<=n;++i) visa[pa[i]]=visb[pb[i]]=1; \n\t\tint tot=0;//\u8bb0\u5f55\u90fd\u9009\u4e86\u51e0\u4e2a\uff0c\u65b9\u4fbf\u53cd\u6094\u7528\n\t\tfor(int i=1;i<=n;++i){//\u5148\u8d2a\u5fc3\u9009K\u4e2a\uff0c\u80fd\u9009\u5c31\u9009\uff0c\u5e76\u628a\u5143\u7d20\u653e\u8fdb\u5806\u91cc\u65b9\u4fbf\u53cd\u6094 \n\t\t\tif(visa[i]) ans+=a[i];\n\t\t\tif(visb[i]) ans+=b[i];\n\t\t\ttopop[i]=visa[i]<<1|visb[i];//\u72b6\u538ba\uff0cb\u7684\u9009\u62e9\u60c5\u51b5 \n\t\t\tif(topop[i]==3) q1.push((zfz){i,-a[i]-b[i]}),tot++;//\u90fd\u9009\n\t\t\telse if(topop[i]==2) q2.push((zfz){i,-a[i]}),q3.push((zfz){i,b[i]});//\u53ea\u9009a \n\t\t\telse if(topop[i]==1) q4.push((zfz){i,a[i]}),q5.push((zfz){i,-b[i]});//\u53ea\u9009b \n\t\t\telse q6.push((zfz){i,a[i]+b[i]});//\u90fd\u4e0d\u9009 \n\t\t}\n\t\twhile(tot<L){//\u5982\u679c\u6ca1\u6709\u9009\u591fL\u4e2a\u5728\u4e24\u4e2a\u5e8f\u5217\u4e2d\u90fd\u88ab\u6307\u5b9a\u7684\uff0c\u5c31\u7ee7\u7eed\u9009 \n\t\t\tlong long Max=-INF,tmp;//Max\u7ef4\u62a4\u589e\u91cf\uff0c\u8d2a\u5fc3\u4f7f\u589e\u91cf\u5c3d\u53ef\u80fd\u5927 \n\t\t\tint opt=-1,t,a,b;//opt\u9009\u62e9\u7684\u53cd\u6094\u64cd\u4f5c\uff0ct,a,b\u53cd\u6094\u7684\u4f4d\u7f6e \n\t\t\tif(!q1.empty()&&(tmp=q1.top().val+q3.top().val+q4.top().val)>Max) Max=tmp,t=q1.top().id,a=q3.top().id,b=q4.top().id,opt=1;//\u4e0a\u8ff01\u64cd\u4f5c \n\t\t\tif((tmp=q2.top().val+q4.top().val)>Max) Max=tmp,a=q2.top().id,b=q4.top().id,opt=2;//\u4e0a\u8ff02\u64cd\u4f5c\n\t\t\tif((tmp=q5.top().val+q3.top().val)>Max) Max=tmp,a=q5.top().id,b=q3.top().id,opt=3;//\u4e0a\u8ff03\u64cd\u4f5c\n\t\t\tif(!q6.empty()&&(tmp=q2.top().val+q5.top().val+q6.top().val)>Max) Max=tmp,t=q6.top().id,a=q2.top().id,b=q5.top().id,opt=4;//\u4e0a\u8ff04\u64cd\u4f5c\n\t\t\tif(opt==1) push0(t),push1(a),push1(b);\n\t\t\telse if(opt==2||opt==3) push0(a),push1(b);\n\t\t\telse push1(t),push0(a),push0(b);\n\t\t\ttot++;\n\t\t\tans+=Max;\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n\n```\n",
        "postTime": 1626875802,
        "uid": 186045,
        "name": "itisover",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 [NOI2019] \u5e8f\u5217"
    },
    {
        "content": "\u7ed9\u5b9a\u4e24\u4e2a\u957f\u4e3a $n$ \u7684\u6b63\u6574\u6570\u5e8f\u5217 $\\{a_n\\},\\{b_n\\}$\uff0c\u73b0\u5728\u8ba9\u4f60\u5728\u6bcf\u4e2a\u5e8f\u5217\u4e2d\u90fd\u9009 $k$ \u4e2a\u4e0b\u6807\uff0c\u5e76\u4e14\u5728\u4e24\u4e2a\u5e8f\u5217\u4e2d\u90fd\u88ab\u9009\u4e2d\u7684\u4e0b\u6807\u4e2a\u6570\u4e0d\u5c11\u4e8e $L$\uff0c\u6700\u5927\u5316\u9009\u4e2d\u7684\u4e0b\u6807\u5bf9\u5e94\u7684\u6570\u4e4b\u548c\u3002$n\\leqslant 2\\times 10^5$\u3002\n\n\n\n\u6211\u4eec\u8ba4\u4e3a\u4e00\u6b21\u64cd\u4f5c\u4e3a\u5404\u9009\u4e2d $a$ \u548c $b$ \u4e2d\u7684\u4e00\u4e2a\u672a\u88ab\u9009\u4e2d\u7684\u4e0b\u6807\u3002\u6211\u4eec\u53d1\u73b0\u4e24\u4e2a\u5e8f\u5217\u4e2d\u90fd\u88ab\u9009\u4e2d\u7684\u4e0b\u6807\u4e2a\u6570\u4e0d\u5c11\u4e8e $L$\uff0c\u7b49\u4ef7\u4e8e\u6700\u591a $k-L$ \u6b21\u64cd\u4f5c\u9009\u4e2d\u7684\u4e0b\u6807\u4e0d\u540c\u3002\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u5efa\u51fa\u4e00\u4e2a\u8d39\u7528\u6d41\u6a21\u578b\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/87lx0o3h.png)\n\n\u62ec\u53f7\u91cc\u7684\u662f\u8fb9\u6743\uff0c\u7b2c\u4e00\u4e2a\u6570\u662f\u6d41\u91cf\u5927\u5c0f\uff0c\u7b2c\u4e8c\u4e2a\u6570\u662f\u8d39\u7528\uff0c\u540c\u7c7b\u8fb9\u53ea\u6807\u6ce8\u4e86\u4e00\u6b21\u8fb9\u6743\uff0c\u8fd9\u6837 $s$ \u5230 $t$ \u7684\u6d41\u91cf\u6070\u597d\u4e3a $k$ \u65f6\u7684\u8d39\u7528\u5c31\u662f\u7b54\u6848\u3002\u8fd9\u4e2a\u7b97\u6cd5\u7684\u6b63\u786e\u6027\u6bd4\u8f83\u663e\u7136\uff0c\u53ea\u6709\u901a\u8fc7\u7ea2\u8272\u8fb9\u624d\u80fd\u589e\u5e7f\u51fa $a$ \u4e0e $b$ \u4e0b\u6807\u4e0d\u540c\u7684\u60c5\u51b5\uff0c\u800c\u6700\u591a\u53ea\u80fd\u8fdb\u884c $k-L$ \u6b21\u8fd9\u6837\u7684\u589e\u5e7f\uff0c\u800c\u4e14\u6211\u4eec\u6bcf\u4e00\u6b21\u5355\u8def\u589e\u5e7f\u589e\u52a0\u7684\u6d41\u91cf\u4e00\u5b9a\u4e3a 1\u3002\n\n\u5982\u679c\u76f4\u63a5\u5199\u4e00\u4e2a SPFA \u8d39\u7528\u6d41\uff0c\u8fd9\u6837\u7684\u590d\u6742\u5ea6\u4e3a $O(nmk)$\uff0c\u5b9e\u9645\u8dd1\u4e0d\u6ee1\u4f3c\u4e4e\u53ef\u4ee5\u62ff\u5230 64 \u5206\u3002\n\n\n\n\u7136\u540e\u662f\u91cd\u5934\u620f\u6a21\u62df\u8d39\u7528\u6d41\u90e8\u5206\u3002\u9996\u5148\u6211\u4eec\u5b9a\u4e49\u7ea2\u8fb9\u7684\u5269\u4f59\u6d41\u91cf\u4e3a\u81ea\u7531\u6d41\u7684\u5927\u5c0f\u3002\u5f88\u663e\u7136\uff0c\u5982\u679c\u81ea\u7531\u6d41\u6709\u5269\u4f59\uff0c\u90a3\u4e48\u4e00\u6b21\u589e\u5e7f\u901a\u8fc7\u7ea2\u8fb9\u589e\u5e7f\u7684\u6743\u503c\u4e00\u5b9a\u6700\u5927\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u8986\u76d6\u4efb\u4f55\u5339\u914d\u3002\n\n\u6211\u4eec\u8003\u8651\u589e\u5e7f\u7684\u60c5\u51b5\uff1a\n\n1. \u901a\u8fc7 $C,D$ \u589e\u5e7f\u4e86\u4e00\u6761 $a$ \u548c $b$ \u7684\u4e0b\u6807\u4e0d\u540c\u7684\u60c5\u51b5\u3002\uff08\u5982\u679c\u589e\u5e7f\u4e86\u4e0b\u6807\u76f8\u540c\u7684\u70b9\u6211\u4eec\u53ef\u4ee5\u5f52\u4e3a\u7b2c\u4e8c\u79cd\u60c5\u51b5\uff0c\u4e5f\u5c31\u662f\u4e0d\u8981\u767d\u6d88\u8017\u81ea\u7531\u6d41\u4e86\uff09\uff0c\u8fd9\u7b49\u4ef7\u4e8e\u5339\u914d\u4e86\u4e00\u5bf9\u4e0b\u6807\u4e0d\u540c\u7684\u6570\u3002\n\n2. \u76f4\u63a5\u8d70\u4e00\u6761 $s\\rightarrow a_i\\rightarrow b_i\\rightarrow t$ \u7684\u589e\u5e7f\u8def\uff0c\u8fd9\u7b49\u4ef7\u4e8e\u5339\u914d\u4e86\u4e00\u5bf9\u4e0b\u6807\u76f8\u540c\u7684\u6570\u3002\n\n3. \u8003\u8651\u9000\u6d41\uff0c\u8d70\u4e86\u4e00\u6761 $s\\rightarrow a_i\\rightarrow C\\rightarrow a_j\\rightarrow b_j\\rightarrow t$ \u7684\u589e\u5e7f\u8def\uff0c\u8bbe\u539f\u6765\u548c $a_j$ \u5339\u914d\u7684\u4e3a $b_k$\uff0c\u90a3\u4e48\u8fd9\u7b49\u4ef7\u4e8e\u628a\u539f\u6765\u7684 $a_j-b_k$ \u8fd9\u4e2a\u5339\u914d\u53d6\u6d88\uff0c\u7136\u540e\u65b0\u6dfb\u52a0 $a_j-b_j$ \u548c $a_i-b_k$ \u4e24\u5bf9\u5339\u914d\u3002\u8fd9\u6837\u4f1a\u4f7f\u5339\u914d\u6570\u91cf\u589e\u52a0 1\uff0c\u81ea\u7531\u6d41\u6570\u91cf\u4e0d\u53d8\u6216 $+1$\uff08\u5177\u4f53\u60c5\u51b5\u89c1\u540e\u9762\uff09\u3002\n\n4. \u7c7b\u4f3c\u60c5\u51b5 3\uff0c\u8d70\u4e00\u6761 $s\\rightarrow a_j\\rightarrow b_j\\rightarrow D\\rightarrow b_i\\rightarrow t$ \u7684\u589e\u5e7f\u8def\uff0c\u8fd9\u7b49\u4ef7\u4e8e\u628a $a_k-b_j$ \u8fd9\u4e2a\u5339\u914d\u53d6\u6d88\uff0c\u65b0\u589e $a_j-b_j$ \u548c $a_k-b_i$ \u4e24\u5bf9\u5339\u914d\u3002\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u5f00\u4e00\u4e2a\u53d8\u91cf `left` \u8bb0\u5f55\u81ea\u7531\u6d41\u7684\u5927\u5c0f\uff0c\u5982\u679c\u8fd8\u6709\u81ea\u7531\u6d41\uff0c\u6211\u4eec\u4f18\u5148\u7528\u81ea\u7531\u6d41\uff0c\u56e0\u4e3a\u4e00\u5b9a\u4e0d\u52a3\u3002\u5426\u5219\uff0c\u6211\u4eec\u9009\u62e9\u5269\u4e0b\u51e0\u79cd\u65b9\u6848\u4e2d\u6743\u503c\u6700\u9ad8\u7684\u90a3\u4e2a\u3002\n\n\u5b9e\u73b0\u4e0a\uff0c\u6211\u4eec\u9700\u8981\u5f00 5 \u4e2a\u5806\uff0c\u5206\u522b\u7ef4\u62a4\u672a\u5339\u914d\u7684 $a_i/b_i$ \u7684\u503c\uff0c\u672a\u5339\u914d\u7684 $a_i+b_i$ \u7684\u503c\uff0c\u5339\u914d\u8fc7\u4f46\u662f\u6ca1\u6709\u56fa\u5b9a\uff08\u6307\u8fd9\u4e2a\u70b9\u4e0d\u901a\u8fc7\u7ea2\u8272\u8fb9\u589e\u5e7f\uff0c\u663e\u7136\uff0c\u5982\u679c\u4e00\u4e2a\u70b9\u901a\u8fc7\u4e86\u84dd\u8272\u8fb9\u589e\u5e7f\uff0c\u90a3\u4e48\u5b83\u7684\u5339\u914d\u4e00\u5b9a\u4e0d\u4f1a\u53d8\uff09\u7684 $a_i/b_i$ \u6240\u5bf9\u5e94\u7684 $b_i/a_i$ \u7684\u503c\u3002\u7136\u540e\u6709\u4e00\u4e9b\u64cd\u4f5c\u4f1a\u5bfc\u81f4\u81ea\u7531\u6d41\u53d8\u591a\uff0c\u4e0b\u9762\u5217\u51fa\u6765\uff1a\n\n\u4e0b\u9762\u8ba4\u4e3a\u6a59\u8272\u4e3a\u73b0\u5728\u5339\u914d\u7684\u4e24\u4e2a\u70b9\uff1a\n\n![\u60c5\u51b51](https://cdn.luogu.com.cn/upload/image_hosting/5ds07mj5.png)\n\n![\u60c5\u51b52](https://cdn.luogu.com.cn/upload/image_hosting/f6g71siu.png)\n\n\u5982\u679c\u662f\u7c7b\u578b 1\uff0c\u90a3\u4e48\u81ea\u7531\u6d41\u989d\u5916 +1\uff08\u6211\u4eec\u8ba4\u4e3a\u53ea\u8981\u51fa\u73b0\u4e00\u6b21\u7c7b\u578b 1\uff0c\u81ea\u7531\u6d41\u90fd\u51cf\u5c0f 1\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u6837\u7b49\u4ef7\u4e8e\u81ea\u7531\u6d41\u5927\u5c0f\u6700\u7ec8\u6ca1\u6709\u53d8\u5316\uff09\uff0c\u8981\u4e0d\u7136\u5c31\u662f\u7c7b\u578b 3 \u6216 4\uff0c\u8fd9\u79cd\u60c5\u51b5\u81ea\u7531\u6d41\u4e0d\u53d8\u3002\n\n![\u60c5\u51b53](https://cdn.luogu.com.cn/upload/image_hosting/be1tyw9o.png)\n\n![\u60c5\u51b54](https://cdn.luogu.com.cn/upload/image_hosting/59xw38y0.png)\n\n\u8fd9\u4e24\u79cd\u60c5\u51b5\uff08\u672c\u8d28\u4e0a\u662f\u4e00\u79cd\uff0c\u5373\u73b0\u5728\u5339\u914d\u7684\u4e24\u4e2a\u70b9\u5728\u53e6\u5916\u4e00\u4e2a\u5e8f\u5217\u4e2d\u90fd\u88ab\u5339\u914d\u8fc7\u4e86\uff09\u51fa\u73b0\u5728\u7c7b\u578b 1 \u65f6\uff0c\u81ea\u7531\u6d41\u989d\u5916 +2\uff1b\u51fa\u73b0\u5728\u7c7b\u578b 3 \u6216 4 \u65f6\uff0c\u81ea\u7531\u6d41\u989d\u5916 +1\u3002\n\n\u81f3\u4e8e\u5982\u4f55\u5224\u65ad\uff0c\u6211\u4eec\u5f00\u4e24\u4e2a\u6570\u7ec4\u8bb0\u5f55\u6bcf\u4e2a\u6570\u662f\u5426\u88ab\u589e\u5e7f\u8fc7\uff0c\u540c\u65f6\u8fd9\u4e2a\u4f5c\u4e3a\u61d2\u60f0\u5220\u9664\u7684\u6807\u8bb0\uff0c\u5982\u679c\u4e0d\u660e\u767d\u4ee3\u7801\u4e0d\u662f\u5f88\u957f\u53ef\u4ee5\u770b\u4ee3\u7801\u3002\n\n\u7531\u4e8e\u6211\u4eec\u6bcf\u4e00\u6b21\u7684\u64cd\u4f5c\u90fd\u7b49\u4ef7\u4e8e\u5728\u8d39\u7528\u6d41\u56fe\u4e2d\u7684\u589e\u5e7f\uff0c\u4e14\u6bcf\u6b21\u90fd\u662f\u6700\u957f\u8def\uff0c\u6240\u4ee5\u8fd9\u4e2a\u7b97\u6cd5\u662f\u6b63\u786e\u7684\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define mp make_pair\nusing namespace std;\nnamespace input\n{\n    const int InputBufferSize=(1<<25)+5;\n    char buffer[InputBufferSize],*s,*eof;\n    inline void init()\n    {\n        assert(stdin!=NULL);\n        s=buffer;\n        eof=s+fread(buffer,1,InputBufferSize,stdin);\n    }\n    inline bool read(int &x)\n    {\n        x=0;\n        int flag=1;\n        while(!isdigit(*s)&&*s!='-')s++;\n        if(eof<=s)return false;\n        if(*s=='-')flag=-1,s++;\n        while(isdigit(*s))x=x*10+*s++-'0';\n        x*=flag;\n        return true;\n    }\n}\nusing namespace input;\ntypedef long long ll;\ntypedef pair<int,int> pii;\npriority_queue<pii>q1,q2,q3,q4,q5;\nint a[200005],b[200005];\nbool visited[200005],visited2[200005];\nint main()\n{\n    init();\n    int _;\n    read(_);\n    while(_--)\n    {\n        a[0]=b[0]=-1e9;\n        while(!q1.empty())q1.pop();\n        while(!q2.empty())q2.pop();\n        while(!q3.empty())q3.pop();\n        while(!q4.empty())q4.pop();\n        while(!q5.empty())q5.pop();\n        int n,k,l,left;\n        ll ans=0;\n        read(n),read(k),read(l);\n        left=k-l;\n        for(int i=1;i<=n;i++)read(a[i]),q1.push(mp(a[i],i)),visited[i]=visited2[i]=0;\n        for(int i=1;i<=n;i++)read(b[i]),q2.push(mp(b[i],i)),q3.push(mp(a[i]+b[i],i));\n        while(k--)\n        {\n            if(left)//\u7c7b\u578b 1\n            {\n                while(visited[q1.top().second])q1.pop();\n                while(visited2[q2.top().second])q2.pop();\n                int x=q1.top().second,y=q2.top().second;\n                q1.pop(),q2.pop();\n                ans+=a[x]+b[y];\n                if(x!=y)\n                {\n                    left--,left+=visited2[x]+visited[y];\n                    if(!visited2[x])q5.push(mp(b[x],x));\n                    else q4.pop();\n                    if(!visited[y])q4.push(mp(a[y],y));\n                    else q5.pop();\n                }\n                visited[x]=visited2[y]=1;\n            }\n            else\n            {\n                while(visited[q1.top().second])q1.pop();\n                while(visited2[q2.top().second])q2.pop();\n                while(visited[q3.top().second]||visited2[q3.top().second])q3.pop();\n                int r=q3.top().second,s1=q4.empty()?0:q4.top().second,s2=q2.top().second,t1=q5.empty()?0:q5.top().second,t2=q1.top().second;\n                if(a[r]+b[r]>=a[s1]+b[s2]&&a[r]+b[r]>=b[t1]+a[t2])//\u7c7b\u578b2\n                {\n                    visited[r]=visited2[r]=1;\n                    ans+=a[r]+b[r];\n                }\n                else if(a[s1]+b[s2]>=b[t1]+a[t2])//\u7c7b\u578b3\n                {\n                    ans+=a[s1]+b[s2];\n                    visited[s1]=visited2[s2]=1;\n                    q2.pop(),q4.pop();\n                    if(visited[s2])left++,q5.pop();\n                    else q4.push(mp(a[s2],s2));\n                }\n                else//\u7c7b\u578b4\n                {\n                    ans+=b[t1]+a[t2];\n                    visited2[t1]=visited[t2]=1;\n                    q1.pop(),q5.pop();\n                    if(visited2[t2])left++,q4.pop();\n                    else q5.push(mp(b[t2],t2));\n                }\n            }\n        }\n        printf(\"%lld\\n\",ans);\n    }\n    return 0;\n}\n```\n\n",
        "postTime": 1596447621,
        "uid": 96912,
        "name": "AzusaCat",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5470 \u3010[NOI2019]\u5e8f\u5217\u3011"
    },
    {
        "content": "\u5148\u628a\u7f51\u7edc\u6d41\u5efa\u51fa\u6765\uff1a\n\n- \u8bb0\u56db\u5143\u7ec4 $(u,v,w,ww)$ \u4ee3\u8868\u7f51\u7edc\u6d41\u4e0a $u$ \u5411 $v$ \u5bb9\u91cf\u4e3a $w$ \u6743\u503c\u4e3a $ww$ \u7684\u8fb9\uff1b\u8bb0 $id_{x,0/1}$ \u4ee3\u8868 $a,b$ \u4e2d\u7b2c $x$ \u4e2a\u6570\u5728\u7f51\u7edc\u6d41\u4e0a\u7684\u4f4d\u7f6e\uff1b\n\n- \u8fde $(S,ss,K,0)$ \u9650\u5236\u603b\u6d41\u91cf\uff1b\u8fde $(ss,id_{i,0},1,a_i),(id_{i,1},T,1,b_i)$ \u4ee3\u8868\u4e00\u6b21\u5bf9\u4f4d\u7f6e\u7684\u9009\u62e9\uff1b\u8fde $(id_{i,0},id_{i,1},1,0)$ \u4ee3\u8868\u4e00\u6b21\u6709\u4ea4\u7684\u5339\u914d\u3002\n\n- \u5efa\u7acb\u865a\u70b9 $m,M$ \u8fde $(m,M,K - L,0)$ \u4ee3\u8868\u9009\u62e9\u975e\u4ea4\u5339\u914d\uff0c\u8fde $(id_{i,0},m,1,0),(M,id_{i,1},1,0)$\u3002\n\n\u53d1\u73b0\u8fd9\u672c\u8d28\u4e0a\u4e5f\u662f\u4e2a\u5339\u914d\u6a21\u578b\uff0c\u6ce8\u610f\u8fd9\u4e2a\u60f3\u6cd5\u5728\u540e\u9762\u7684\u6a21\u62df\u8d39\u7528\u6d41\u4e2d\u6709\u7528\u3002\n\n\u8003\u8651 $n$ \u5f88\u5927\uff0c\u51ed\u611f\u89c9\u5c31\u662f\u6a21\u62df\u8d39\u7528\u6d41\uff0c\u90a3\u81ea\u7136\u53cd\u6094\u8d2a\u5fc3\u3002\n\n\u6839\u636e\u5957\u8def\uff0c\u6211\u4eec\u5148\u6a21\u62df EK\uff0c\u6bcf\u6b21\u627e\u4e00\u6761\u589e\u5e7f\u8def\uff0c\u7136\u540e\u6784\u9020\u53cd\u6094\uff1b\u53cd\u6094\u7684\u65f6\u5019\u9700\u8981\u786e\u5b9a\u4e00\u4e2a\u53d8\u91cf $x$ \u4f7f\u5f97\u6bcf\u6b21\u6d41\u7ecf\u589e\u5e7f\u8def\u540e $x$ \u53ea\u4f1a $+1$ \u4e00\u76f4\u8fbe\u5230\u4e0a\u754c\u4e3a\u6b62\u3002\n\n\u56de\u5f52\u6b64\u9898\uff0c\u6211\u4eec\u4e0d\u96be\u60f3\u5230\u5148\u66b4\u529b\u5728 $a,b$ \u91cc\u9762\u9009 $K$ \u4e2a\u51fa\u6765\u7136\u540e\u82e5\u6ca1\u8fbe\u5230 $L$ \u7684\u8981\u6c42\u5c31\u6bcf\u6b21\u627e\u4e00\u6761**\u5728\u7f51\u7edc\u6d41\u4e0a\u5fc5\u7ecf\u8fc7 $(m,M)$ \u8fb9\u7684\u589e\u5e7f\u8def**\u53bb\u53cd\u6094\uff0c\u5373\u6bcf\u6b21\u5fc5\u987b\u4f7f\u5f97\u6709\u4ea4\u5339\u914d\u7684\u4e2a\u6570 $+1$ \u4e14\u603b\u7684\u6700\u5927\u6d41\u91cf\u4e0d\u53d8\u3002\u6ee1\u8db3\u9700\u8981\u7684\u53cd\u6094\u8d2a\u5fc3\u6a21\u578b\u3002\n\n\u4f60\u53ef\u4ee5\u7406\u89e3\u6210\u672a\u6ee1\u8db3 $L$ \u7684\u6761\u4ef6\u4e0b\uff0c\u6211\u4eec\u5c06 $m \\rightarrow M$ \u7684\u8fb9\u53cd\u5411\u4e86\u53d8\u6210 $M \\rightarrow m$ \u4e86\uff08\u672c\u8d28\u4e0a\u662f\u6d41\u591a\u4e86\uff09\u4e14\u5bf9\u4e8e\u8be5\u8fb9\u7684\u6d41\u91cf\u9650\u5236\u662f\u4e0a\u4e0b\u754c\uff0c\u800c\u5176\u5b83\u8fb9\u7684\u6d41\u91cf\u5408\u6cd5\u65f6\u6b8b\u4f59\u7f51\u7edc\u4e0a\u7684\u6700\u5927\u6d41\u6700\u5927\u8d39\u7528\u95ee\u9898\u3002\n\n- \u8bb0\u4e8c\u5206\u56fe\u5de6\u4fa7\u70b9\u8868\u793a $a$ \u6570\u7ec4\u7684\u70b9\uff0c\u53f3\u4fa7\u70b9\u8868\u793a $b$ \u6570\u7ec4\u7684\u70b9\uff1b\n\n- \u5de6\u4fa7\u70b9\u6709\u4e00\u4e2a\u70b9\u5f62\u6210\u975e\u4ea4\u5339\u914d\uff0c\u627e\u5230\u4e0e\u5b83\u5339\u914d\u7684\u53f3\u4fa7\u8282\u70b9\uff0c\u8bbe\u5de6\u53f3\u4e24\u70b9\u7684\u4f4d\u7f6e\u4e3a $a,b$\uff0c\u5219\u53cd\u6094\u8def\u5f84\u4e3a $id_{b,1} \\rightarrow M \\rightarrow m \\rightarrow id_{a,0} \\rightarrow id_{a,1}$ \u5f62\u6210\u4e00\u6b21\u6709\u4ea4\u5339\u914d\uff1b\n\n- \u53f3\u4fa7\u70b9\u6709\u4e00\u4e2a\u70b9\u5f62\u6210\u975e\u4ea4\u5339\u914d\uff0c\u627e\u5230\u4e0e\u5b83\u5339\u914d\u7684\u5de6\u4fa7\u8282\u70b9\uff0c\u8bbe\u5de6\u53f3\u4e24\u70b9\u7684\u4f4d\u7f6e\u4e3a $a,b$\uff0c\u5219\u53cd\u6094\u8def\u5f84\u4e3a $id_{b,1} \\rightarrow M \\rightarrow m \\rightarrow id_{a,0} \\rightarrow id_{a,1}$ \u5f62\u6210\u4e00\u6b21\u6709\u4ea4\u5339\u914d\uff1b\n\n- \u5b58\u5728\u4e00\u4e2a\u975e\u4ea4\u5339\u914d\uff0c\u8bbe\u5de6\u53f3\u4e24\u70b9\u4e3a $a,b$\uff0c\u5bfb\u627e\u4e00\u4e2a\u6ee1\u8db3\u5b58\u5728 $S \\rightarrow ss \\rightarrow id_{x,0} \\rightarrow id_{x,1} \\rightarrow T$ \u7684\u8282\u70b9 $x$\uff0c\u5219\u53cd\u6094\u8def\u5f84\u4e3a $id_{b,1} \\rightarrow M \\rightarrow m \\rightarrow id_{a,0} \\rightarrow ss \\rightarrow id_{x,0} \\rightarrow id_{x,1} \\rightarrow T$\uff1b\n\n- \u8fd8\u6709\u4e00\u4e2a\u6bd4\u8f83\u590d\u6742\u7684\u63a8\u6d41\uff1a\u627e\u5230\u4e00\u4e2a\u6709\u4ea4\u5339\u914d\uff0c\u7c7b\u4f3c\u4e0a\u4e00\u79cd\u60c5\u51b5\u5148\u628a\u8fd9\u4e2a\u6709\u4ea4\u5339\u914d\u9000\u56de\u5230 $ss$ \u7136\u540e\u505a\u4e00\u6b21\u60c5\u51b5 $1/2$ \u7684\u53cd\u6094\u518d\u627e\u5230\u4e00\u4e2a\u6ca1\u6709\u6709\u4ea4\u7684\u5339\u914d\u4ece $ss$ \u628a\u9000\u56de\u53bb\u7684\u6709\u4ea4\u5339\u914d\u5206\u914d\u7ed9\u8be5\u6709\u4ea4\u5339\u914d\u3002\n\n\u8f6c\u5316\u6210\u6b63\u5e38\u7684\u53cd\u6094\u64cd\u4f5c\uff1a\n\n- \u627e\u5230\u4e00\u4e2a\u53ea\u9009\u4e86 $a$ \u6570\u7ec4\u6ca1\u9009 $b$ \u6570\u7ec4\u7684\u4f4d\u7f6e\u548c\u53ea\u9009\u4e86 $b$ \u6570\u7ec4\u6ca1\u9009 $a$ \u6570\u7ec4\u7684\u4f4d\u7f6e\uff0c\u8bb0\u4e3a $A,B$\uff0c\u53cd\u6094 $B$ \u7684\u9009\u62e9\u8ba9 $A$ \u5f62\u6210\u6709\u4ea4\u5339\u914d\uff1b\n\n- \u627e\u5230\u4e00\u4e2a\u53ea\u9009\u4e86 $a$ \u6570\u7ec4\u6ca1\u9009 $b$ \u6570\u7ec4\u7684\u4f4d\u7f6e\u548c\u53ea\u9009\u4e86 $b$ \u6570\u7ec4\u6ca1\u9009 $a$ \u6570\u7ec4\u7684\u4f4d\u7f6e\uff0c\u8bb0\u4e3a $A,B$\uff0c\u53cd\u6094 $A$ \u7684\u9009\u62e9\u8ba9 $B$ \u5f62\u6210\u6709\u4ea4\u5339\u914d\uff1b\n\n- \u627e\u5230\u4e00\u4e2a\u53ea\u9009\u4e86 $a$ \u6570\u7ec4\u6ca1\u9009 $b$ \u6570\u7ec4\u7684\u4f4d\u7f6e\u548c\u53ea\u9009\u4e86 $b$ \u6570\u7ec4\u6ca1\u9009 $a$ \u6570\u7ec4\u7684\u4f4d\u7f6e\uff0c\u4ee5\u53ca\u4e00\u4e2a $a$ \u6570\u7ec4\u548c $b$ \u6570\u7ec4\u90fd\u6ca1\u9009\u7684\u4f4d\u7f6e\uff0c\u8bb0\u4e3a $A,B,C$ \u53cd\u6094 $A,B$ \u7684\u9009\u62e9\u8ba9 $C$ \u5f62\u6210\u6709\u4ea4\u5339\u914d\uff1b\n\n- \u627e\u5230\u4e00\u4e2a\u53ea\u9009\u4e86 $a$ \u6570\u7ec4\u6ca1\u9009 $b$ \u6570\u7ec4\u7684\u4f4d\u7f6e\u548c\u53ea\u9009\u4e86 $b$ \u6570\u7ec4\u6ca1\u9009 $a$ \u6570\u7ec4\u7684\u4f4d\u7f6e\uff0c\u4ee5\u53ca\u4e00\u4e2a $a$ \u6570\u7ec4\u548c $b$ \u6570\u7ec4\u90fd\u9009\u4e86\u7684\u4f4d\u7f6e\uff0c\u8bb0\u4e3a $A,B,C$ \u53cd\u6094 $C$ \u7684\u9009\u62e9\u8ba9 $A,B$ \u5f62\u6210\u6709\u4ea4\u5339\u914d\u3002\n\n\u7528\u5806\u7ef4\u62a4\u4e0a\u8ff0\u64cd\u4f5c\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n \\log n)$\u3002\n\n```cpp\n/*\n\u8003\u8651\u66b4\u529b\u5efa\u56fe\u8d39\u7528\u6d41\u3002\n\u7531\u4e8e\u603b\u6d41\u91cf\u662f\u786e\u5b9a\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u62c6\u4e0a\u4e0b\u754c\u53d8\u6210\u6700\u5927\u8d39\u7528\u6700\u5927\u6d41 \nS -> i , i' -> T , \ni -> O(K - L) , O -> i'\n\u8003\u8651\u600e\u4e48\u6a21\u62df\u8d39\u7528\u6d41\uff0c\u80af\u5b9a\u8981\u53cd\u6094\u8d2a\u5fc3\u7684\u3002\n\u8003\u8651\u5206\u6790\u624b\u6bb5\uff0c\u53ef\u4e0d\u53ef\u4ee5\u76f4\u63a5\u66b4\u529b\u53cd\u6094\n\u662f\u53ef\u4ee5\u7684\u3002\u76f4\u63a5\u6a21\u62df\u6240\u6709\u7684\u56de\u9000\u548c\u9009\u62e9\u64cd\u4f5c\u5c31\u53ef\u4ee5\u4e86\u3002 \n*/\n#include \"bits/stdc++.h\"\nusing namespace std;\nconst int Len = 2e5 + 5 , Inf = 2e9 + 1;\n#define ll long long\n#define mk(x , y) make_pair(x , y)\n#define pll pair<ll,ll> \n#define fr first\n#define sc second\nint n,K,L,a[Len],b[Len],flag[Len];\npriority_queue<pll,vector<pll>,less<pll> > Q[6];\nint p[Len],psy[15];\nll mx[15];\n//\u53ea b +a 0\n//\u53ea b -b 1\n//\u53ea a +b 2\n//\u53ea a -a 3\n//a,b none (a + b) 4\n//a,b both -(a + b) 5\n//\u538b\u4f4d\uff0c0 \u8868\u793a\u90fd\u6ca1\u9009\uff0c1 \u8868\u793a a\uff0c2 \u8868\u793a b\uff0c3 \u8868\u793a a,b \n/*\u56db\u79cd\u60c5\u51b5\uff1a\n\u6709a\u65e0b+\u65e0a\u6709b -> \u6709 a,b \n\u65e0a\u6709b+\u6709a\u65e0b -> \u6709 a,b\n\u53cd\u6094\u4e00\u4e2a\u4e24\u4e2a\u90fd\u6ca1\u6709\u7684\uff0c\u4ece\u6709a\u65e0b+\u65e0a\u6709b\u4e2d\u62bd\u51fa\u6765\n\u53cd\u6094\u4e00\u4e2a\u4e24\u4e2a\u6ca1\u6709\u7684\uff0c\u4ece\u6709a\u65e0b+\u65e0a\u6709b\u4e2d\u62bd\u51fa\u6765\n*/\ninline void push(int x)\n{\n\tint op = flag[x];\n\tif(!op){Q[4].push(mk(a[x] + b[x] , x));}\n\telse if(op == 1){Q[2].push(mk(b[x] , x)) , Q[3].push(mk(-a[x] , x));}\n\telse if(op == 2){Q[0].push(mk(a[x] , x)) , Q[1].push(mk(-b[x] , x));}\n\telse Q[5].push(mk(-(a[x] + b[x]) , x));\n}\ninline int read() {\n    char ch = getchar();\n    int x = 0, f = 1;\n    while (ch < '0' || ch > '9') {\n        if (ch == '-')\n            f = -1;\n        ch = getchar();\n    }\n    while ('0' <= ch && ch <= '9') {\n        x = x * 10 + ch - '0';\n        ch = getchar();\n    }\n    return x * f;\n}\ninline bool cmp1(int x,int y){return a[x] > a[y];}\ninline bool cmp2(int x,int y){return b[x] > b[y];}\nint main()\n{\n\tpsy[0] = psy[1] = 2 , psy[2] = psy[3] = 1 , psy[4] = 0 , psy[5] = 3;\n\tint T;T = read();\n\twhile(T --)\n\t{\n\t\tn = read() , K = read() , L = read();ll as = 0;for(int i = 0 ; i < 6 ; i ++){while(!Q[i].empty()) Q[i].pop();Q[i].push(mk(-Inf , 0));}\n\t\tfor(int i = 1 ; i <= n ; i ++) flag[i] = 0 , a[i] = read() , p[i] = i;for(int i = 1 ; i <= n ; i ++) b[i] = read(); \n\t\tsort(p + 1 , p + 1 + n , cmp1);for(int i = 1 ; i <= K ; i ++) as += a[p[i]] , flag[p[i]] |= 1;\n\t\tsort(p + 1 , p + 1 + n , cmp2);for(int i = 1 ; i <= K ; i ++) as += b[p[i]] , flag[p[i]] |= 2;\n\t\tfor(int i = 1 ; i <= n ; i ++) L -= (flag[i] == 3) , push(i);\n\t\twhile(L > 0)\n\t\t{\n\t\t\tfor(int i = 0 ; i < 6 ; i ++)\n\t\t\t{\n\t\t\t\twhile(!Q[i].empty() && flag[Q[i].top().sc] != psy[i]) Q[i].pop();\n\t\t\t\tmx[i] = Q[i].top().fr;\n\t\t\t}\n\t\t\tll V[5],mxn;\n\t\t\tV[1] = mx[0] + mx[3] , V[2] = mx[1] + mx[2] , V[3] = mx[4] + mx[3] + mx[1] , V[4] = mx[0] + mx[2] + mx[5];\n\t\t\tmxn = V[1];\n\t\t\tfor(int i = 2 ; i <= 4 ; i ++) mxn = max(mxn , V[i]);\n\t\t\tas += mxn;\n\t\t\tif(mxn == V[1]){int x = Q[0].top().sc , y = Q[3].top().sc;flag[x] = 3 , flag[y] = 0;push(x) , push(y);}\n\t\t\telse if(mxn == V[2]){int x = Q[1].top().sc , y = Q[2].top().sc;flag[x] = 0 , flag[y] = 3;push(x) , push(y);}\n\t\t\telse if(mxn == V[3]){int x = Q[4].top().sc , y = Q[3].top().sc , z = Q[1].top().sc;flag[x] = 3 , flag[y] = flag[z] = 0;push(x) , push(y) , push(z);}\n\t\t\telse{int x = Q[0].top().sc , y = Q[2].top().sc , z = Q[5].top().sc;flag[x] = flag[y] = 3 , flag[z] = 0;push(x) , push(y) , push(z);}\n\t\t\tL --;\n\t\t}\n\t\tprintf(\"%lld\\n\",as);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1668400074,
        "uid": 132533,
        "name": "Hakuoro",
        "ccfLevel": 0,
        "title": "P5470 [NOI2019] \u5e8f\u5217"
    },
    {
        "content": "[CF436E Cardboard Box](https://www.luogu.com.cn/problem/CF436E)\u7684\u5347\u7ea7\u7248\u3002\n\n\u76f4\u63a5\u4e0a\u6765\u641e\u516d\u4e2a\u5806\u7684\u53cd\u6094\u8d2a\u5fc3\u3002\n\n### \u601d\u8def\n\n\u9996\u5148\u6309\u7167\u8d2a\u5fc3\u7684\u601d\u8def\uff0c\u5c06\u4e24\u4e2a\u5e8f\u5217\u4e2d\u6700\u5927 $k$ \u4e2a\u76f4\u63a5\u9009\u3002\n\n\u5982\u679c\u5176\u4e2d\u76f8\u540c\u7684\u5c0f\u4e8e $l$\uff0c\u6211\u4eec\u8003\u8651\u8fdb\u884c\u53cd\u6094\u8d2a\u5fc3\u3002\n\n\u6211\u4eec\u8bbe\u5f53\u524d\u5e8f\u5217\u76f8\u540c\u7684\u4e2a\u6570\u4e3a $res$\u3002\n\n\u6211\u4eec\u6bcf\u4e00\u56de\u5408\u90fd\u8981\u8ba9 $res+1$\u3002\n\n\u5e94\u8be5\u6709\u56db\u79cd\u60c5\u51b5\uff1a\n\n1. \u9009\u62e9\u4e00\u4e2a\u4e4b\u524d\u9009\u4e86 $b$ \u6ca1\u9009 $a$ \u7684\u4f4d\u7f6e\uff0c\u5c06 $a$ \u9009\u4e0a\uff0c\u518d\u4e22\u6389\u4e00\u4e2a\u53ea\u9009\u4e86 $a$ \u7684\u4f4d\u7f6e\u4e0a\u7684 $a$\u3002\n\n1. \u9009\u62e9\u4e00\u4e2a\u4e4b\u524d\u9009\u4e86 $a$ \u6ca1\u9009 $b$ \u7684\u4f4d\u7f6e\uff0c\u5c06 $b$ \u9009\u4e0a\uff0c\u518d\u4e22\u6389\u4e00\u4e2a\u53ea\u9009\u4e86 $b$ \u7684\u4f4d\u7f6e\u4e0a\u7684 $b$\u3002\n\n1. \u9009\u62e9\u4e00\u4e2a\u4e4b\u524d\u9009\u4e86 $b$ \u6ca1\u9009 $a$ \u7684\u4f4d\u7f6e\uff0c\u548c\u4e00\u4e2a\u4e4b\u524d\u9009\u4e86 $a$ \u6ca1\u9009 $b$ \u7684\u4f4d\u7f6e\uff0c\u5c06 $a,b$ \u9009\u4e0a\uff0c\u518d\u4e22\u6389\u4e00\u4e2a\u9009\u4e86 $a,b$ \u7684\u4f4d\u7f6e\u4e0a\u7684 $a,b$\u3002\n\n1. \u9009\u62e9\u4e00\u4e2a\u4ec0\u4e48\u90fd\u6ca1\u9009\u4f4d\u7f6e\u4e0a\u7684 $a,b$\uff0c\u5c06\u4ed6\u4eec\u9009\u4e0a\uff0c\u518d\u9009\u62e9\u4e00\u4e2a\u4e4b\u524d\u9009\u4e86 $b$ \u6ca1\u9009 $a$ \u7684\u4f4d\u7f6e\uff0c\u548c\u4e00\u4e2a\u4e4b\u524d\u9009\u4e86 $a$ \u6ca1\u9009 $b$ \u7684\u4f4d\u7f6e\uff0c\u5c06 $a,b$ \u4e22\u6389\u3002\n\n\u5217\u6210\u5f0f\u5b50\u5c31\u662f\uff1a\n\n* $a_{max}-a_{min}$\n* $b_{max}-b_{min}$\n* $(a+b)_{max}-a_min-b_min$\n* $a_{max}+b_{max}-(a+b)_{min}$\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u5f00\u516d\u4e2a\u5806\u6765\u7ef4\u62a4\u8fd9\u4e9b\u5f0f\u5b50\u3002\n\n\u6700\u540e\uff0c\u5c31\u662f\u677f\u5b50\u4e86\u3002\n\n### Code\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\ninline int read()\n{\n    int s = 0 , f = 1; char ch;\n    while(!isdigit(ch = getchar())) if(ch == '-') f = -1;\n    while(isdigit(ch)) s = s * 10 + ch - '0' , ch = getchar();\n    return s * f;\n}\n\nconst int maxn = 200010;\n\nint t , n , k , l , vis[maxn] , a[maxn] , b[maxn];\n\nstruct edge\n{\n\tint id , num;\n}al[maxn] , bl[maxn];\n\ninline bool cmp(edge x , edge y)\n{\n\treturn x.num > y.num;\n}\n\nstruct qwq\n{\n\tint sum , id;\n\tinline bool operator<(const qwq &tmp) const\n\t{\n\t\treturn sum < tmp.sum;\n\t}\n\t\n\tinline bool operator>(const qwq &tmp) const\n\t{\n\t\treturn sum > tmp.sum;\n\t}\n};\n\npriority_queue<qwq , vector<qwq> , less<qwq> > q1 , q2 , q6;\npriority_queue<qwq , vector<qwq> , greater<qwq> > q3 , q4 , q5;\n\n/*\nq1 -> a_i          q2 -> b_i\nq3 -> a_i          q4 -> b_i\nq5 -> a_i + b_i    q6 -> a_i + b_i\n*/\n\ninline void solve(int i)\n{\n\tif(vis[i] == 0) q6.push({a[i] + b[i] , i});\n\tif(vis[i] == 1) q2.push({b[i] , i}) , q3.push({a[i] , i});\n\tif(vis[i] == 2) q1.push({a[i] , i}) , q4.push({b[i] , i});\n\tif(vis[i] == 3) q5.push({a[i] + b[i] , i});\n}\n\ninline void init()\n{\n\tmemset(vis , 0 , sizeof(vis));\n\twhile(q1.empty() == 0) q1.pop();\n\twhile(q2.empty() == 0) q2.pop();\n\twhile(q3.empty() == 0) q3.pop();\n\twhile(q4.empty() == 0) q4.pop();\n\twhile(q5.empty() == 0) q5.pop();\n\twhile(q6.empty() == 0) q6.pop();\n}\n\nsigned main()\n{\n\tt = read();\n\twhile(t--)\n\t{\n\t\tinit();\n\t\tlong long sum = 0 , res = 0;\n\t\t//sum\u5f53\u524d\u548c,res\u5f53\u524d\u5339\u914d\u6570\u91cf. \n\t\tn = read() , k = read() , l = read();\n\t\tfor(int i = 1;i <= n;i++) a[i] = read() , al[i] = {i , a[i]};\n\t\tfor(int i = 1;i <= n;i++) b[i] = read() , bl[i] = {i , b[i]};\n\t\tsort(al + 1 , al + n + 1 , cmp);\n\t\tsort(bl + 1 , bl + n + 1 , cmp);\n\t\tfor(int i = 1;i <= k;i++)\n\t\t\tsum += al[i].num , vis[al[i].id] = (vis[al[i].id] > 0 ? 3 : 1),\n\t\t\tsum += bl[i].num , vis[bl[i].id] = (vis[bl[i].id] > 0 ? 3 : 2);\n\t\t//vis_i == 1 \u53ea\u9009 a_i\n\t\t//vis_i == 2 \u53ea\u9009 b_i\n\t\t//vis_i == 3 \u90fd\u9009\u4e86. \n\t\tfor(int i = 1;i <= n;i++)\n\t\t\tres += (vis[i] == 3);\n\t\tfor(int i = 1;i <= n;i++) solve(i);\n\t\twhile(res < l)\n\t\t{\n\t\t\tlong long lsum = -10000000000 , casel = 0;\n\t\t\t\n\t\t\twhile(q1.empty() == 0 && vis[q1.top().id] != 2) q1.pop();\n\t\t\twhile(q2.empty() == 0 && vis[q2.top().id] != 1) q2.pop();\n\t\t\twhile(q3.empty() == 0 && vis[q3.top().id] != 1) q3.pop();\n\t\t\twhile(q4.empty() == 0 && vis[q4.top().id] != 2) q4.pop();\n\t\t\twhile(q5.empty() == 0 && vis[q5.top().id] != 3) q5.pop();\n\t\t\twhile(q6.empty() == 0 && vis[q6.top().id] != 0) q6.pop();\n\t\t\t\n\t\t\tif(q1.empty() == 0 && q3.empty() == 0)\n\t\t\t{\n\t\t\t\tif(lsum < q1.top().sum - q3.top().sum)\n\t\t\t\t\tlsum = q1.top().sum - q3.top().sum , casel = 1;\n\t\t\t}\n\t\t\t\n\t\t\tif(q2.empty() == 0 && q4.empty() == 0)\n\t\t\t{\n\t\t\t\tif(lsum < q2.top().sum - q4.top().sum)\n\t\t\t\t\tlsum = q2.top().sum - q4.top().sum , casel = 2;\n\t\t\t}\n\t\t\t\n\t\t\tif(q1.empty() == 0 && q2.empty() == 0 && q5.empty() == 0)\n\t\t\t{\n\t\t\t\tif(lsum < q1.top().sum + q2.top().sum - q5.top().sum)\n\t\t\t\t\tlsum = q1.top().sum + q2.top().sum - q5.top().sum , casel = 3;\n\t\t\t}\n\t\t\t\n\t\t\tif(q3.empty() == 0 && q4.empty() == 0 && q6.empty() == 0)\n\t\t\t{\n\t\t\t\tif(lsum < q6.top().sum - q3.top().sum - q4.top().sum)\n\t\t\t\t\tlsum = q6.top().sum - q3.top().sum - q4.top().sum , casel = 4;\n\t\t\t}\n\t\t\t\n\t\t\tif(casel == 1)\n\t\t\t\tvis[q1.top().id] = 3 , vis[q3.top().id] = 0,\n\t\t\t\tsolve(q1.top().id) , solve(q3.top().id),\n\t\t\t\tq1.pop() , q3.pop();\n\t\t\t\t\n\t\t\tif(casel == 2)\n\t\t\t\tvis[q2.top().id] = 3 , vis[q4.top().id] = 0,\n\t\t\t\tsolve(q2.top().id) , solve(q4.top().id),\n\t\t\t\tq2.pop() , q4.pop();\n\t\t\t\t\n\t\t\tif(casel == 3)\n\t\t\t\tvis[q1.top().id] = 3 , vis[q2.top().id] = 3 , vis[q5.top().id] = 0,\n\t\t\t\tsolve(q1.top().id) , solve(q2.top().id) , solve(q5.top().id),\n\t\t\t\tq1.pop() , q2.pop() , q5.pop();\n\t\t\t\t\n\t\t\tif(casel == 4)\n\t\t\t\tvis[q3.top().id] = 0 , vis[q4.top().id] = 0 , vis[q6.top().id] = 3,\n\t\t\t\tsolve(q3.top().id) , solve(q4.top().id) , solve(q6.top().id),\n\t\t\t\tq3.pop() , q4.pop() , q6.pop();\n\t\t\t\n\t\t\tsum += lsum , res++;\n\t\t}\n\t\tcout << sum << endl;\n\t}\n    return 0;\n}\n```",
        "postTime": 1645145988,
        "uid": 320933,
        "name": "Mfeitveer",
        "ccfLevel": 0,
        "title": "[NOI2019] \u5e8f\u5217 \u9898\u89e3"
    },
    {
        "content": "[\u6d1b\u8c37\u9898\u9762\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5470)\n\n\u597d\u51e0\u5929\u6ca1\u5199\u9898\u89e3\u4e86\uff0c\u5199\u7bc7\u9898\u89e3\u610f\u601d\u4e00\u4e0b\uff08\u5927\u96fe\n\n\u8003\u8651\u53cd\u6094\u8d2a\u5fc3\uff0c\u9996\u5148\u6211\u4eec\u8003\u8651\u53d6\u51fa $a,b$ \u5e8f\u5217\u4e2d\u6700\u5927\u7684 $k$ \u4e2a\u6570\uff0c\u4f46\u8fd9\u6837\u5e76\u4e0d\u4e00\u5b9a\u6ee1\u8db3\u4ea4\u96c6 $\\ge L$ \u7684\u9650\u5236\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u8c03\u6574\uff0c\u6211\u4eec\u5047\u8bbe $L-$ $a,b$ \u5e8f\u5217\u4e2d\u6700\u5927\u7684 $k$ \u4e2a\u6570\u7684\u4ea4\u96c6\u4e3a $L'$\uff0c\u5982\u679c $L'\\le 0$ \u90a3\u4e0d\u7528\u8c03\u6574\u76f4\u63a5\u8f93\u51fa\u5373\u53ef\u3002\u5426\u5219\u6211\u4eec\u8003\u8651\u6bcf\u6b21\u8c03\u6574\u90e8\u5206 $a_i,b_i$ \u7684\u53d6\u503c\u4f7f\u5f97 $a,b$ \u7684\u4ea4\u96c6\u52a0 $1$\uff0c\u4e0d\u96be\u53d1\u73b0\u6bcf\u6b21\u8c03\u6574\u53ef\u80fd\u6709\u4ee5\u4e0b\u53ef\u80fd\uff1a\n\n1. \u9009\u62e9\u4e24\u4e2a\u4e0b\u6807 $x,y$\uff0c\u6ee1\u8db3\u9009\u62e9\u4e86 $a_x$ \u6ca1\u9009 $b_x$\uff0c\u4ee5\u53ca\u9009\u62e9\u4e86 $b_y$ \u6ca1\u9009 $a_y$\uff0c\u5c06 $a_x$ \u6539\u4e3a $a_y$\uff0c\u7b54\u6848\u589e\u52a0 $a_y-a_x$\n2. \u9009\u62e9\u4e24\u4e2a\u4e0b\u6807 $x,y$\uff0c\u6ee1\u8db3\u9009\u62e9\u4e86 $b_x$ \u6ca1\u9009 $a_x$\uff0c\u4ee5\u53ca\u9009\u62e9\u4e86 $a_y$ \u6ca1\u9009 $b_y$\uff0c\u5c06 $b_x$ \u6539\u4e3a $b_y$\uff0c\u7b54\u6848\u589e\u52a0 $b_y-b_x$\n3. \u9009\u62e9\u4e09\u4e2a\u4e0b\u6807 $x,y,z$\uff0c\u6ee1\u8db3\u9009\u62e9\u4e86 $a_x$ \u6ca1\u9009 $b_x$\uff0c\u9009\u62e9\u4e86 $b_y$ \u6ca1\u9009 $a_y$\uff0c$a_z,b_z$ \u90fd\u6ca1\u9009\uff0c\u5c06 $a_x$ \u6539\u4e3a $a_z$\uff0c$b_y$ \u6539\u4e3a $a_z$\uff0c\u7b54\u6848\u589e\u52a0 $(a_z+b_z)-a_x-b_y$\n4. \u9009\u62e9\u4e09\u4e2a\u4e0b\u6807 $x,y,z$\uff0c\u6ee1\u8db3\u9009\u62e9\u4e86 $a_x$ \u6ca1\u9009 $b_x$\uff0c\u9009\u62e9\u4e86 $b_y$ \u6ca1\u9009 $a_y$\uff0c$a_z,b_z$ \u90fd\u88ab\u9009\u62e9\u4e86\uff0c\u5c06 $a_z$ \u6539\u4e3a $a_y$\uff0c$b_z$ \u6539\u4e3a $b_x$\uff0c\u7b54\u6848\u589e\u52a0 $a_y+b_x-(a_z+b_z)$\n\n\u601d\u8def\u7406\u5230\u8fd9\u91cc\uff0c\u806a\u660e\u7684\u8bfb\u8005\u4e00\u5b9a\u80fd\u591f\u53d1\u73b0\uff0c\u63a5\u4e0b\u6765\u7684\u6b65\u9aa4\u4e0e[\u6b64\u9898](https://www.cnblogs.com/ET2006/p/Codeforces-436E.html)\u7b2c\u4e8c\u4e2a\u89e3\u6cd5\u5927\u540c\u5c0f\u5f02\u4e86\uff0c\u6211\u4eec\u8bb0 $st_i$ \u8868\u793a\u4e0b\u6807\u4e3a $i$ \u7684\u4f4d\u7f6e\u88ab\u9009\u62e9\u7684\u60c5\u51b5\uff0c$st_i=0$ \u8868\u793a $a_i,b_i$ \u90fd\u6ca1\u9009\uff0c$st_i=1$ \u8868\u793a $a_i$ \u88ab\u9009 $b_i$ \u6ca1\u9009\uff0c$st_i=2$ \u8868\u793a $b_i$ \u88ab\u9009 $a_i$ \u6ca1\u9009\uff0c$st_i=3$ \u8868\u793a $a_i,b_i$ \u90fd\u88ab\u9009\u3002\n\n\u90a3\u4e48\u8003\u8651\u7ef4\u62a4\u516d\u4e2a\u5927\u6839\u5806\uff1a\n\n- $q_1=\\{a_i|st_i=2\\}$\n- $q_2=\\{b_i|st_i=1\\}$\n- $q_3=\\{-a_i|st_i=1\\}$\n- $q_4=\\{-b_i|st_i=2\\}$\n- $q_5=\\{a_i+b_i|st_i=0\\}$\n- $q_6=\\{-a_i-b_i|st_i=3\\}$\n\n\u5bf9\u4e8e\u60c5\u51b5 $1$ \u76f8\u5f53\u4e8e\u662f\u53d6\u51fa $q_1,q_3$ \u7684\u6839\u8282\u70b9\uff0c\u60c5\u51b5 $2$ \u76f8\u5f53\u4e8e\u662f\u53d6\u51fa $q_2,q_4$ \u7684\u6839\u8282\u70b9\uff0c\u60c5\u51b5 $3$ \u76f8\u5f53\u4e8e\u662f\u53d6\u51fa $q_3,q_4,q_5$ \u7684\u6839\u8282\u70b9\uff0c\u60c5\u51b5 $4$ \u76f8\u5f53\u4e8e\u662f\u53d6\u51fa $q_1,q_2,q_6$ \u7684\u6839\u8282\u70b9\uff0c\u7136\u540e xjb \u4e71\u641e\u4e00\u4e0b\u5c31\u884c\u4e86\uff08\u786e\u4fe1\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u7ebf\u5bf9\u3002\n\n~~\u611f\u89c9\u8fd9\u4e2a D1T3 \u6bd4 D1T2 \u7b80\u5355\uff0c\u867d\u7136\u6211\u90fd\u4e0d\u4f1a\u505a~~\n\n```cpp\nconst int MAXN=2e5;\nint n,k,l,a[MAXN+5],b[MAXN+5],st[MAXN+5];\npii ap[MAXN+5],bp[MAXN+5]; \npriority_queue<pii> q1,q2,q3,q4,q5,q6;\n/*\nq1: maximum a[i] with st[i]=2\nq2: maximum b[i] with st[i]=1\nq3: maximum -a[i] with st[i]=1\nq4: maximum -b[i] with st[i]=2\nq5: maximum a[i]+b[i] with st[i]=0\nq6: maximum -a[i]-b[i] with st[i]=3\n*/\nvoid solve(){\n\tscanf(\"%d%d%d\",&n,&k,&l);memset(st,0,sizeof(st));\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&a[i]),ap[i]=mp(a[i],i);\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&b[i]),bp[i]=mp(b[i],i);\n\tsort(ap+1,ap+n+1);reverse(ap+1,ap+n+1);\n\tsort(bp+1,bp+n+1);reverse(bp+1,bp+n+1);ll ans=0;\n\tfor(int i=1;i<=k;i++) st[ap[i].se]|=1,ans+=ap[i].fi;\n\tfor(int i=1;i<=k;i++) st[bp[i].se]|=2,ans+=bp[i].fi;\n\tfor(int i=1;i<=n;i++) l-=(st[i]==3);chkmax(l,0);\n\tq1.push(mp(-2e9,0));q2.push(mp(-2e9,0));q3.push(mp(-2e9,0));\n\tq4.push(mp(-2e9,0));q5.push(mp(-2e9,0));q6.push(mp(-2e9,0));\n\tfor(int i=1;i<=n;i++){\n\t\tif(st[i]==2){\n\t\t\tq1.push(mp(a[i],i));\n\t\t\tq4.push(mp(-b[i],i));\n\t\t} if(st[i]==1){\n\t\t\tq2.push(mp(b[i],i));\n\t\t\tq3.push(mp(-a[i],i));\n\t\t} if(!st[i]){\n\t\t\tq5.push(mp(a[i]+b[i],i));\n\t\t} if(st[i]==3){\n\t\t\tq6.push(mp(-a[i]-b[i],i));\n\t\t}\n\t}\n\twhile(l--){\n\t\t#define qpop(a,b)\\\n\t\t\twhile(!q##a.empty()){\\\n\t\t\t\tint x=q##a.top().se;\\\n\t\t\t\tif(!x||st[x]==b) break;\\\n\t\t\t\tq##a.pop();\\\n\t\t\t}\n\t\tqpop(1,2);qpop(2,1);qpop(3,1);\n\t\tqpop(4,2);qpop(5,0);qpop(6,3);\n\t\tll res1=0ll+q1.top().fi+q3.top().fi;\n\t\tll res2=0ll+q2.top().fi+q4.top().fi;\n\t\tll res3=0ll+q3.top().fi+q4.top().fi+q5.top().fi;\n\t\tll res4=0ll+q1.top().fi+q2.top().fi+q6.top().fi;\n\t\tll mx=max(max(res1,res2),max(res3,res4));ans+=mx;\n\t\tif(res1==mx){\n\t\t\tint x=q1.top().se,y=q3.top().se;\n\t\t\tq1.pop();q3.pop();st[x]=3;st[y]=0;\n\t\t\tq5.push(mp(a[y]+b[y],y));\n\t\t\tq6.push(mp(-a[x]-b[x],x));\n\t\t} else if(res2==mx){\n\t\t\tint x=q2.top().se,y=q4.top().se;\n\t\t\tq2.pop();q4.pop();st[x]=3;st[y]=0;\n\t\t\tq5.push(mp(a[y]+b[y],y));\n\t\t\tq6.push(mp(-a[x]-b[x],x));\n\t\t} else if(res3==mx){\n\t\t\tint x=q3.top().se,y=q4.top().se,z=q5.top().se;\n\t\t\tq3.pop();q4.pop();q5.pop();st[x]=st[y]=0;st[z]=3;\n\t\t\tq5.push(mp(a[x]+b[x],x));\n\t\t\tq5.push(mp(a[y]+b[y],y));\n\t\t\tq6.push(mp(-a[z]-b[z],z));\n\t\t} else{\n\t\t\tint x=q1.top().se,y=q2.top().se,z=q6.top().se;\n\t\t\tq1.pop();q2.pop();q6.pop();st[x]=st[y]=3;st[z]=0;\n\t\t\tq6.push(mp(-a[x]-b[x],x));\n\t\t\tq6.push(mp(-a[y]-b[y],y));\n\t\t\tq5.push(mp(a[z]+b[z],z));\n\t\t}\n\t} printf(\"%lld\\n\",ans);\n\t#define clr(x) while(!q##x.empty()) q##x.pop();\n\tclr(1);clr(2);clr(3);clr(4);clr(5);clr(6);\n}\nint main(){\n\tfreopen(\"sequence.in\",\"r\",stdin);\n\tfreopen(\"sequence.out\",\"w\",stdout);\n\tint qu;scanf(\"%d\",&qu);\n\twhile(qu--) solve();\n\treturn 0;\n}\n```\n\n\n\n",
        "postTime": 1626915883,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5470 [NOI2019] \u5e8f\u5217"
    },
    {
        "content": "\u9996\u5148\u6211\u4eec\u6709\u4e00\u4e2a\u975e\u5e38 naive \u60f3\u6cd5\uff1a\u8bbe$c_i=a_i+b_i$\uff0c\u628a\u8fd9\u4e2a$c$\u964d\u5e8f\u6392\u5e8f\u540e\u53d6\u524d$\\text{L}$\u4e2a\u5269\u4e0b\u7684$\\text{K-L}$\u5728\u5206\u522b\u5728$a,b$\u4e2d\u8d2a\u5fc3\u7684\u9009\u53d6\u5373\u53ef\u3002\u7136\u540e\u4f60\u53d1\u73b0\u5c0f\u6837\u4f8b\u7684\u7b2c\u4e09\u7ec4\u6570\u636e\u90fd\u8fc7\u4e0d\u53bb\u3002\n\n\u95ee\u9898\u5728\u54ea\uff1f\n\n\u4e8b\u5b9e\u4e0a\u6211\u4eec\u4ece\u5927\u5230\u5c0f\u6bcf\u9009\u53d6\u4e00\u4e2a$c$\u4e2d\u7684\u5143\u7d20\uff0c\u5c31**\u53ef\u80fd\u4f1a\u5f71\u54cd**\u6700\u540e\u6211\u4eec\u9009\u62e9\u7684$\\text{2(K-L)}$\u4e2a\u5143\u7d20\u7684\u548c\u7684\u5927\u5c0f\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8003\u8651\u5728\u9009\u62e9$c$\u4e2d\u7684\u5143\u7d20\u65f6\u63d0\u524d\u5c06\u540e\u9762\u7684\u8d21\u732e\u8ba1\u7b97\u8fdb\u6765\u518d\u53d6\u6700\u5927\u503c\u3002\u6240\u4ee5\u5f53\u6211\u4eec\u5df2\u7ecf\u9009\u62e9\u7684\u5143\u7d20\u7684\u96c6\u5408\u4e3a$S$\u662f,$a$\u4e2d\u4e0d\u5c5e\u4e8e$S$\u7684\u524d$\\text{K-L}$\u5927\u7684\u5143\u7d20\u7684\u96c6\u5408\u4e3a$S_a$\uff0c$b$\u4e2d\u4e0d\u5c5e\u4e8e$S$\u7684\u524d$\\text{K-L}$\u5927\u7684\u5143\u7d20\u7684\u96c6\u5408\u4e3a$S_b$\u65f6\uff0c\u6211\u4eec\u8fd9\u6b21\u64cd\u4f5c\u7684\u6700\u5927\u503c\u4e3a\uff1a\n\n$$\\max_{1\\le i \\le n,i \\not\\in S}\\{a_i+b_i-[i\\in S_a](a_i-A)-[i\\in S_b](b_i-B)\\}$$\n\n$A$\u4e3a$a$\u4e2d\u6ca1\u88ab\u9009\u62e9\u7684\u7b2c$\\text{K-L+1}$\u5927\u7684\u503c\uff0c$B$\u540c\u7406\u3002\n\n\u8fd9\u4e2a\u4e1c\u897f\u66b4\u529b\u7b97\u662f$O(nL)$\uff0c\u53ef\u4ee5\u83b7\u5f97$64$\u5206\u7684\u597d\u6210\u7ee9\u3002\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u6211\u4eec\u6bcf\u6b21\u53d6\u51fa\u4e00\u5bf9\u503c\uff0c\u5bf9\u4e8e$S_a,S_b$\u7684\u96c6\u5408\u5927\u5c0f\u5f71\u54cd$\\le 1$\u3002\u5206\u7c7b\u8ba8\u8bba\u540e\u7ef4\u62a4\u56db\u4e2a\u5806\u5c31\u597d\u4e86\uff0c\u5206\u522b\u7ef4\u62a4$i$\u540c\u65f6\u5c5e\u4e8e$S_a,S_b$\uff0c\u53ea\u5c5e\u4e8e\u4e00\u4e2a\uff0c\u4e24\u4e2a\u90fd\u4e0d\u5c5e\u4e8e\u7684\u6700\u5927\u503c\u3002\u7136\u540e\u56db\u4e2a\u6700\u5927\u503c\u53d6\u4e2a$\\max$\u3002\u5b9e\u9645\u4e0a\u6211\u4eec\u8fd8\u8981\u7ef4\u62a4\u4e00\u4e2a\u652f\u6301\u5220\u9664\u7684\u6709\u5e8f\u8868\uff0c\u76f4\u63a5\u6392\u4e2a\u5e8f\u5efa\u4e00\u4e2a\u94fe\u8868\u5c31\u884c\u4e86\u3002\u6ce8\u610f\u53d6\u51fa\u6765\u7684\u6700\u5927\u503c\u5c5e\u4e8e\u4e0d\u540c\u72b6\u6001\u65f6\u5bf9$a,b$\u4e2d\u7b2c$\\text{K-L+1}$\u5927\u7684\u5143\u7d20\u7684\u5f71\u54cd\u3002\n\n\u590d\u6742\u5ea6$O(L\\log n)$\u3002\n\n\u672c\u8d28\u4e0a\u5e94\u8be5\u548c\u6bdb\u7237\u7237\u7684 ppt \u91cc\u8bb2\u5f97\u65b9\u6cd5\u5dee\u4e0d\u591a\uff0c\u4f46\u597d\u50cf\u7b80\u6d01\u4e00\u70b9\uff0c\u6211\u8fd9\u4e2a\u5c11\u7ef4\u62a4\u4e86\u4e24\u4e2a\u5806\u3002(2333\n\n\u6240\u4ee5\u6211\u8fd9\u4e2a\u5f31\u667a\u513f\u7ae5\u4e3a\u5565\u5728\u8003\u8bd5\u7684\u65f6\u5019\u653e\u5f03\u4e86\u540e\u9762\u7684$36$\u5206\u554a\uff0c\u8349\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, j, k) for(int i = j; i <= k; ++i)\n#define dep(i, j, k) for(int i = j; i >= k; --i)\n#define mp make_pair\n#define fi first\n#define se second\n#define SIZE(x) ((int)x.size())\n\ntypedef long long ll;\n\nusing namespace std;\n\nconst int maxn = 2e5 + 5;\nconst int inf = 0x3f3f3f3f;\n\nint n, L, K, a[maxn], b[maxn], c[maxn];\n\ninline int read() {\n\tchar ch = getchar(); int u = 0, f = 1;\n\twhile(!isdigit(ch)) { if(ch == '-') f = -1; ch = getchar(); }\n\twhile(isdigit(ch))  { u = u * 10 + ch - 48; ch = getchar(); } return u * f;\n}\n\nnamespace n_2000 {\n\tconst int maxn = 2e3 + 5;\n\tpair<int, int> A[maxn], B[maxn], rA[maxn], rB[maxn];\n\tll ans = 0;\n\tbool visa[maxn], visb[maxn], ca[maxn], cb[maxn];\n\tinline bool check() { return n < 0; }\n\tint main() {\n\t\tans = 0;\n\t\tmemset(ca, 0, sizeof(ca)); memset(cb, 0, sizeof(cb));\n\t\tint Z = K - L;\n\t\trep(i, 1, n) rA[i] = mp(a[i], i);\n\t\trep(i, 1, n) rB[i] = mp(b[i], i);\n\t\tsort(rA + 1, rA + 1 + n, greater<pair<int, int> >());\n\t\tsort(rB + 1, rB + 1 + n, greater<pair<int, int> >());\n\t\twhile(L) {\n\t\t\tint tot = 0, now = -inf, M = 0, rl = 0;\n\t\t\trep(i, 1, n) visa[i] = visb[i] = 0;\n\t\t\ttot = 0;\n\t\t\trep(i, 1, n) if(!ca[rA[i].se]) A[++tot] = rA[i];\n\t\t\ttot = 0;\n\t\t\trep(i, 1, n) if(!cb[rB[i].se]) B[++tot] = rB[i];\n\t\t\tint basea = A[Z + 1].fi, baseb = B[Z + 1].fi;\n\t\t\trep(i, 1, Z) visa[A[i].se] = visb[B[i].se] = 1;\n\t\t\trep(i, 1, n) if(!ca[i] && !cb[i]) {\n\t\t\t\tint tmp = a[i] + b[i] + (visa[i]) * (basea - a[i]) + (visb[i]) * (baseb - b[i]);\n\t\t\t\tif(tmp > now) { now = tmp; M = i; rl = a[i] + b[i]; }\n\t\t\t}\n\t\t\tans += rl; ca[M] = cb[M] = 1;\n\t\t\tL--; K--;\n\t\t}\n\t\tcerr << ans << endl;\n\t\tint tot = 0;\n\t\ttot = 0;\n\t\trep(i, 1, n) if(!ca[rA[i].se]) A[++tot] = rA[i];\n\t\ttot = 0;\n\t\trep(i, 1, n) if(!cb[rB[i].se]) B[++tot] = rB[i];\n\t\trep(i, 1, K) ans += A[i].fi + B[i].fi;\n\t\tcout << ans << endl;\n\t\treturn 0;\n\t}\n}\n\nnamespace ViXbob {\n\tconst int maxn = ::maxn;\n\tpair<int, int> A[maxn], B[maxn], rA[maxn], rB[maxn];\n\tint nxta[maxn], prea[maxn], nxtb[maxn], preb[maxn], Z, nowa, nowb, posa[maxn], posb[maxn];\n\tll ans = 0;\n\tbool visa[maxn], visb[maxn], ca[maxn], cb[maxn];\n\tpriority_queue<pair<int, int> > q[4];\n\tinline bool check() { return n < maxn; }\n\tinline void cleartag() {\n\t\twhile(q[0].size() && !(visa[q[0].top().se] && visb[q[0].top().se])) q[0].pop();\n\t\twhile(q[1].size() && !(visa[q[1].top().se] && !visb[q[1].top().se])) q[1].pop();\n\t\twhile(q[2].size() && !(!visa[q[2].top().se] && visb[q[2].top().se])) q[2].pop();\n\t\twhile(q[3].size() && !(!visa[q[3].top().se] && !visb[q[3].top().se])) q[3].pop(); \n\t}\n\tinline int getmax() {\n\t\tint rnt = -inf, M = -1;\n\t\tcleartag();\n\t\tif(q[0].size()) rnt = a[nowa] + b[nowb], M = 0;\n\t\tif(q[1].size() && q[1].top().fi + a[nowa] > rnt) rnt = q[1].top().fi + a[nowa], M = 1;\n\t\tif(q[2].size() && q[2].top().fi + b[nowb] > rnt) rnt = q[2].top().fi + b[nowb], M = 2;\n\t\tif(q[3].size() && q[3].top().fi > rnt) rnt = q[3].top().fi, M = 3;\n\t\treturn M;\n\t}\n\tint main() {\n\t\tans = 0; Z = K - L;\n\t\tmemset(visa, 0, sizeof(visa)); memset(visb, 0, sizeof(visb));\n\t\tmemset(nxta, 0, sizeof(nxta)); memset(prea, 0, sizeof(prea));\n\t\tmemset(nxtb, 0, sizeof(nxtb)); memset(preb, 0, sizeof(preb));\n\t\trep(i, 1, n) A[i] = mp(a[i], i), B[i] = mp(b[i], i);\n\t\tsort(A + 1, A + 1 + n, greater<pair<int, int> >());\n\t\tsort(B + 1, B + 1 + n, greater<pair<int, int> >());\n//\t\trep(i, 1, n) cerr << A[i].fi << \" \"; cerr << endl;\n//\t\trep(i, 1, n) cerr << B[i].fi << \" \"; cerr << endl;\n\t\tnowa = A[Z + 1].se; nowb = B[Z + 1].se;\n\t\trep(i, 1, Z) visa[A[i].se] = visb[B[i].se] = 1;\n\t\twhile(q[0].size()) q[0].pop();\n\t\twhile(q[1].size()) q[1].pop();\n\t\twhile(q[2].size()) q[2].pop();\n\t\twhile(q[3].size()) q[3].pop();\n\t\trep(i, 1, n) {\n\t\t\tprea[i] = i - 1; nxta[i] = i + 1;\n\t\t\tpreb[i] = i - 1; nxtb[i] = i + 1;\n\t\t\tposa[A[i].se] = i; posb[B[i].se] = i;\n\t\t\tif(visa[i] && visb[i]) q[0].push(mp(0, i));\n\t\t\telse if(visa[i] && !visb[i]) q[1].push(mp(b[i], i));\n\t\t\telse if(!visa[i] && visb[i]) q[2].push(mp(a[i], i));\t\n\t\t\telse q[3].push(mp(a[i] + b[i], i));\n\t\t}\n\t\tnxta[0] = nxtb[0] = 1;\n\t\twhile(L) {\n//\t\t\tcerr << \"----------------------\" << endl;\n\t\t\tint M = getmax(), tmp = q[M].top().se; q[M].pop();\n\t\t\tans += a[tmp] + b[tmp];\n\t\t\tint pa = posa[tmp], pb = posb[tmp];\n\t\t\tnxta[prea[pa]] = nxta[pa]; prea[nxta[pa]] = prea[pa];\n\t\t\tnxtb[preb[pb]] = nxtb[pb]; preb[nxtb[pb]] = preb[pb];\t\n\t\t\tint Na = nxta[posa[nowa]], Nb = nxtb[posb[nowb]];\n//\t\t\tcerr << tmp << \" \" << M << endl;\n//\t\t\tcerr << nowa << \" \" << nowb << endl;\n//\t\t\tcerr << pa << \" \" << pb << endl;\n\t\t\tif(M == 0) {\n\t\t\t\tif(nowa != nowb) {\n\t\t\t\t\tif(visb[nowa]) q[0].push(mp(0, nowa));\n\t\t\t\t\telse q[1].push(mp(b[nowa], nowa));\n\t\t\t\t\tif(visa[nowb]) q[0].push(mp(0, nowb));\n\t\t\t\t\telse q[2].push(mp(a[nowb], nowb));\n\t\t\t\t} else q[0].push(mp(0, nowa));\n\t\t\t\tvisa[nowa] = visb[nowb] = 1;\n\t\t\t\tnowa = A[Na].se; nowb = B[Nb].se;\n\t\t\t} else if(M == 1) {\n\t\t\t\tif(visb[nowa]) q[0].push(mp(0, nowa));\n\t\t\t\telse q[1].push(mp(b[nowa], nowa));\n\t\t\t\tvisa[nowa] = 1; nowa = A[Na].se;\n\t\t\t\tif(nowb == tmp) nowb = B[Nb].se;\n\t\t\t} else if(M == 2) {\n\t\t\t\tif(visa[nowb]) q[0].push(mp(0, nowb));\n\t\t\t\telse q[2].push(mp(a[nowb], nowb));\n\t\t\t\tvisb[nowb] = 1; nowb = B[Nb].se;\n\t\t\t\tif(nowa == tmp) nowa = A[Na].se;\n\t\t\t} else {\n\t\t\t\tif(nowa == tmp) nowa = A[Na].se;\n\t\t\t\tif(nowb == tmp) nowb = B[Nb].se;\n\t\t\t} L--;\n//\t\t\tcerr << nowa << \" \" << nowb << endl;\n\t\t}\n//\t\tcerr << ans << endl;\n\t\tfor(int i = 1, u = 0, v = 0; i <= Z; i++) {\n\t\t\tu = nxta[u]; v = nxtb[v];\n\t\t\tans += A[u].fi + B[v].fi;\n\t\t}\n\t\tcout << ans << endl;\n\t\treturn 0;\n\t}\n}\n\nint main() {\n\tfreopen(\"sequence.in\", \"r\", stdin);\n\tfreopen(\"sequence.out\", \"w\", stdout);\n\tfor(int CASE_NUM = read(), CASE_CON = 1; CASE_CON <= CASE_NUM; ++CASE_CON) {\n\t\tn = read(); K = read(); L = read();\n\t\trep(i, 1, n) a[i] = read();\n\t\trep(i, 1, n) b[i] = read();\n\t\tif(n_2000 :: check()) n_2000 :: main();\n\t\telse if(ViXbob :: check()) ViXbob :: main();\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1563292745,
        "uid": 50971,
        "name": "ViXbob",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5470 \u3010[NOI2019]\u5e8f\u5217\u3011"
    },
    {
        "content": "\u725b\u903c\u7684\u8d2a\u5fc3\u3002\n\n\u8003\u8651\u6bd4\u8f83\u66b4\u529b\u7684\u505a\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u5efa\u5982\u4e0b\u7684\u56fe\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8b685634.png)\n\n\u6bcf\u4e2a\u8fb9\u4e0a\u7b2c\u4e00\u4e2a\u6570\u662f\u6d41\u91cf\uff0c\u7b2c\u4e8c\u4e2a\u6570\u662f\u8d39\u7528\uff0c\u4e2d\u95f4$(1,0)$\u7684\u9ed1\u8fb9\u4ee3\u8868\u9009\u62e9\u4e0b\u6807\u76f8\u540c\u7684\u6570\uff0c\u6d45\u84dd\u8272\u7684\u8fb9\u4ee3\u8868\u6700\u591a\u53ef\u4ee5\u9009$K-L$\u4e2a\u4e0b\u6807\u4e0d\u540c\u7684\u6570\uff0c\u6700\u540e\u8fde\u5411$t$\u7684\u662f\u6700\u591a\u9009$K$\u4e2a\u6570\u3002\n\n\u7136\u540e\u5728\u8fd9\u4e2a\u56fe\u4e0a\u8dd1\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\u5c31\u53ef\u4ee5\u5f97\u5230\u7b54\u6848\u3002\n\n\u5982\u4f55\u4f18\u5316\u590d\u6742\u5ea6\uff0c\u8003\u8651\u6a21\u62df\u8d39\u7528\u6d41\uff0c\u9996\u5148$K-L$\u8fd9\u6761\u8fb9\u7684\u6d41\u6bd4\u8f83\u597d\u6a21\u62df\uff0c\u56e0\u4e3a\u662f\u968f\u4fbf\u9009\uff0c\u6240\u4ee5\u8003\u8651\u9009$a,b$\u4e2d\u524d$K-L$\u5927\u7684\u6570\uff0c\u7136\u540e\u5982\u679c\u9009\u5230\u4e0b\u6807\u76f8\u540c\u7684\u6570\uff0c\u90a3\u4e48\u5c31\u4e0d\u6d41\u8fd9\u6761\uff0c\u8ba9\u4ed6\u5728\u5bf9\u5e94\u7684\u8fb9\u4e2d\u6d41\u662f\u6700\u4f18\u7684\u3002\n\n\u6211\u4eec\u9009\u5b8c\u4e4b\u540e\u5c31\u8981\u8003\u8651\u5982\u4f55\u6d41\u5bf9\u5e94\u7684\u8fb9\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u9009\u62e9$a_i,b_i$\u90fd\u6ca1\u88ab\u9009\u8fc7\u7684\u6d41\u8fc7\u53bb\uff1b\u8fd8\u53ef\u4ee5\u9009\u62e9\u4e00\u4e2a$a_i$\u88ab\u9009\u8fc7\u4e86\uff0c\u9009\u4e00\u4e2a$b_i$\u8865\u4e0a$a_i$\uff0c\u7136\u540e$K-L$\u8fd9\u6761\u8fb9\u5c11\u4e86\u4e00\u70b9\u6d41\u91cf\uff0c\u6240\u4ee5\u518d\u9009\u4e00\u4e2a\u6700\u5927\u7684\u6ca1\u6709\u88ab\u9009\u7684$a_i$\u6765\u4f5c\u4e3a\u72ec\u7acb\u7684\u6765\u8865\u5145\u6d41\u91cf\uff1b$b_i$\u4e5f\u662f\u540c\u7406\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8d2a\u5fc3\u5730\u627e\u6700\u4f18\u7684\u6d41\u6cd5\u5f80\u540e\u6d41\uff0c\u8fd9\u6837\u4e00\u5b9a\u662f\u6700\u4f18\u7684\uff0c\u56e0\u4e3a\u6bcf\u6b21\u90fd\u53ea\u4f1a\u8ba9\u5bf9\u5e94\u7684\u6d41\u91cf\u589e\u52a01\uff0c\u6240\u4ee5\u8d2a\u5fc3\u663e\u7136\u6b63\u786e\u3002\n\n\u7136\u540e\u6709\u4e00\u70b9\u9700\u8981\u6ce8\u610f\uff0c\u5c31\u662f\u5982\u679c$K-L$\u8fd9\u6761\u8fb9\u7684\u6d41\u91cf\u4e0d\u6ee1\uff0c\u90a3\u4e48\u6211\u4eec\u4e00\u5b9a\u8981\u6bcf\u6b21\u9009$a,b$\u4e2d\u5404\u6700\u5927\u7684\u6765\u8865\u5145\u6d41\u91cf\uff0c\u6bd4\u5982\u8fd9\u6837\u5b50\uff1a\n\n$$a_1,(a_2),a_3,(a_4),a_5,a_6$$\n$$b_1,b_2,(b_3),b_4,b_5,(b_6)$$\n\n\u52a0\u4e86\u62ec\u53f7\u7684\u662f\u88ab\u9009\u8fc7\u4e86\u3002\n\n\u5047\u8bbe\u6211\u4eec\u4e0b\u4e00\u6b21\u9009$a_3,b_2$\uff0c\u90a3\u4e48$K-L$\u7684\u6d41\u91cf\u5c31\u4f1a\u4e0d\u6ee1\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u5728\u5269\u4e0b\u7684\u5c40\u9762\u4e2d\u5404\u9009\u4e00\u4e2a\u6700\u5927\u7684$a,b$\uff0c\u5047\u5982\u662f$a_5,b_1$\uff0c\u8fd9\u6837\u5c31\u6ee1\u8db3\u6ee1\u6d41\u4e86\uff0c\u4f46\u5982\u679c\u6700\u5927\u7684$a,b$\u662f$a_5,b_5$\uff0c\u90a3\u5c31\u8fd8\u5f97\u7ee7\u7eed\u9009\u76f4\u5230\u6ee1\u6d41\u3002\n\n**Code**\n``` cpp\n#include <iostream>\n#include <cstring>\n#include <cstdio>\n#include <algorithm>\n#include <queue>\n#define mp make_pair\n#define fi first\n#define se second\nconst int N = 2e5;\nlong long inf = 1e17;\nusing namespace std;\nint T,n,K,L,a[N + 5],b[N + 5],va[N + 5],vb[N + 5],ll,kk;\npriority_queue <pair<int,int> > q,qa,qb,qqa,qqb;\nlong long ans,res;\nint main()\n{\n    scanf(\"%d\",&T);\n    while (T--)\n    {\n        scanf(\"%d%d%d\",&n,&K,&L);\n        for (int i = 1;i <= n;i++)\n            scanf(\"%d\",&a[i]);\n        for (int i = 1;i <= n;i++)\n            scanf(\"%d\",&b[i]);\n        for (int i = 1;i <= n;i++)\n            va[i] = vb[i] = 0;\n        ans = 0;\n        while (!q.empty())\n            q.pop();\n        while (!qa.empty())\n            qa.pop();\n        while (!qb.empty())\n            qb.pop();\n        for (int i = 1;i <= n;i++)\n        {\n            qa.push(mp(a[i],i));\n            qb.push(mp(b[i],i));\n        }\n        ll = 0;\n        for (int i = 1;i <= K && ll / 2 < K - L;i++)\n        {\n            if (qa.empty())\n                break;\n            int ua = qa.top().se,ub = qb.top().se;\n            qa.pop();qb.pop();\n            if (ua == ub)\n                continue;\n            if (vb[ua])\n                ll--,ans -= b[ua],vb[ua] = 0;\n            else\n                ll++,ans += a[ua],va[ua] = 1;\n            if (va[ub])\n                ll--,ans -= a[ub],va[ub] = 0;\n            else\n                ll++,ans += b[ub],vb[ub] = 1;\n        }\n        while (!qa.empty())\n            qa.pop();\n        while (!qb.empty())\n            qb.pop();\n        while (!qqa.empty())\n            qqa.pop();\n        while (!qqb.empty())\n            qqb.pop();\n        for (int i = 1;i <= n;i++)\n        {\n            if (!va[i] && vb[i])\n                qa.push(mp(a[i],i));\n            if (!vb[i] && va[i])\n                qb.push(mp(b[i],i));\n            if (!va[i] && !vb[i])\n                q.push(mp(a[i] + b[i],i));\n            if (!va[i])\n                qqa.push(mp(a[i],i));\n            if (!vb[i])\n                qqb.push(mp(b[i],i));\n        }\n        int mx = 0,typ = 0,ub,ua;\n        for (int i = 1;i <= K - ll / 2;i++)\n        {\n            mx = 0;\n            while (!q.empty() && (va[q.top().se] || vb[q.top().se]))\n                q.pop();\n            if (!q.empty())\n            {\n                if (mx < q.top().fi)\n                    mx = q.top().fi,typ = 1;\n            }\n            while (!qa.empty() && va[qa.top().se])\n                qa.pop();\n            if (!qa.empty())\n            {\n                while (vb[qqb.top().se])\n                    qqb.pop();\n                ub = qqb.top().se;\n                if (mx < qa.top().fi + b[ub])\n                    mx = qa.top().fi + b[ub],typ = 2;\n            }\n            while (!qb.empty() && vb[qb.top().se])\n                qb.pop();\n            if (!qb.empty())\n            {\n                while (va[qqa.top().se])\n                    qqa.pop();\n                ua = qqa.top().se;\n                if (mx < qb.top().fi + a[ua])\n                    mx = qb.top().fi + a[ua],typ = 3;\n            }\n            ans += mx;\n            if (typ == 1)\n            {\n                va[q.top().se] = vb[q.top().se] = 1;\n                q.pop();\n            }\n            if (typ == 2)\n            {\n                ua = qa.top().se;\n                va[qa.top().se] = 1;\n                qa.pop();\n                vb[ub] = 1;\n                qqb.pop();\n                if (!va[ub])\n                    qa.push(mp(a[ub],ub));\n                else\n                {\n                    int sm = 1;\n                    while (i != K - ll / 2 && sm)\n                    {\n                        sm--;\n                        while (vb[qqb.top().se])\n                            qqb.pop();\n                        while (va[qqa.top().se])\n                            qqa.pop();\n                        ua = qqa.top().se,ub = qqb.top().se;\n                        qqa.pop(),qqb.pop();\n                        ans += a[ua] + b[ub];\n                        va[ua] = vb[ub] = 1;\n                        if (!vb[ua])\n                            qb.push(mp(b[ua],ua));\n                        else\n                            sm++;\n                        if (!va[ub])\n                            qa.push(mp(a[ub],ub));\n                        else\n                            sm++;\n                        i++;\n                    }\n                }\n            }\n            if (typ == 3)\n            {\n                ub = qb.top().se;\n                vb[qb.top().se] = 1;\n                qb.pop();\n                va[ua] = 1;\n                qqa.pop();\n                if (!vb[ua])\n                    qb.push(mp(b[ua],ua));\n                else\n                {\n                    int sm = 1;\n                    while (i != K - ll / 2 && sm)\n                    {\n                        sm--;\n                        while (vb[qqb.top().se])\n                            qqb.pop();\n                        while (va[qqa.top().se])\n                            qqa.pop();\n                        ua = qqa.top().se,ub = qqb.top().se;\n                        qqa.pop(),qqb.pop();\n                        ans += a[ua] + b[ub];\n                        va[ua] = vb[ub] = 1;\n                        if (!vb[ua])\n                            qb.push(mp(b[ua],ua));\n                        else\n                            sm++;\n                        if (!va[ub])\n                            qa.push(mp(a[ub],ub));\n                        else\n                            sm++;\n                        i++;\n                    }\n                }\n            }\n        }\n        cout<<ans<<endl;\n    }\n    return 0;\n}\n```",
        "postTime": 1605099927,
        "uid": 73231,
        "name": "eee_hoho",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5470 \u3010[NOI2019]\u5e8f\u5217\u3011"
    }
]
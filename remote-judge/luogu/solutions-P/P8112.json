[
    {
        "content": "\u573a\u4e0a\u7684\u5c0f\u4e11\u505a\u6cd5\u4e0d\u8bf7\u81ea\u6765\u3002\r\n\r\n\u5f00\u9898\uff1aSAM \u7684\u840c\u840c\u9898\uff1f\u8fd9\u6570\u636e\u8303\u56f4\u7684\u4e0d\u5bf9\u52b2\u554a\u3002\u54e6\uff0cZ \u51fd\u6570\u5c31\u80fd\u505a\u4e86\uff0c\u6211\u964d\u667a\u4e86\u3002\uff08\u6b64\u65f6\u8fd8\u6ca1\u610f\u8bc6\u5230\u81ea\u5df1\u8fd8\u662f\u964d\u667a\u4e86\uff09\r\n\r\n------------\r\n\r\n#### problem\r\n\r\n\u7ed9\u5b9a\u5b57\u7b26\u4e32 $\\texttt{S}$ \u548c $\\texttt{T}$\uff0c\u8981\u6c42\u5c06 $\\texttt{S}$ \u5212\u5206\u6210\u6700\u5c11\u7684\u6bb5\uff0c\u4e14\u6bcf\u6bb5\u662f $\\texttt{T}$ \u7684\u524d\u7f00\u3002\uff08$1\\leq|\\texttt{S}||\\texttt{T}|\\leq 10^7$\uff09\r\n\r\n\r\n------------\r\n\r\n\r\n#### solution\r\n\r\n\u6b63\u7740\u4e0d\u597d\u505a\uff0c\u8003\u8651\u5012\u7740 dp\uff0c$lim_i$ \u8868\u793a $\\texttt{S}_{[i,n]}$ \u4e0e $\\texttt{T}$ \u7684\u6700\u957f\u516c\u5171\u524d\u7f00\uff0c\u8bbe $f_i$ \u8868\u793a $\\texttt{S}_{[i,n]}$ \u6700\u5c11\u7684\u5212\u5206\uff0c\u5219\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a$f_i=\\min_{i<j\\leq i+lim_i}\\{f_j\\}+1$\u3002\r\n\r\n$lim$ \u53ef\u4ee5\u7528 Z-box \u6c42\uff0c\u7136\u540e $O(n^2)$ \u548c $O(n\\log n)$ \u505a\u6cd5\u5c31\u663e\u7136\u4e86\uff0c\u4f46\u662f\u8fd9\u9898\u8981\u6c42\u7ebf\u6027\u3002\r\n\r\n\u5206\u6790\u4e00\u4e0b\uff0c\u82e5\uff1a$i<i^{\\prime}$ \u4e14 $i+lim_i>i^{\\prime}+lim_{i^{\\prime}}$\uff0c\u90a3\u4e48\u4ece $i^{\\prime}$ \u8fdb\u884c\u5212\u5206\u4e00\u5b9a\u4e0d\u4f18\uff0c\u8fd9\u91cc\u7684 $i^{\\prime}$ \u53ef\u4ee5\u76f4\u63a5\u4e0d\u7528\u8003\u8651\u3002\r\n\r\n\u628a\u4e0a\u8ff0\u7684\u4f4d\u7f6e\u6254\u6389\u540e\uff0c$i+lim_i$ \u5c31\u662f\u5355\u8c03\u7684\u4e86\uff0c\u53ef\u4ee5\u4f7f\u7528\u5355\u8c03\u961f\u5217\u8fdb\u884c\u4f18\u5316\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$\u3002\r\n\r\n~~\u6bd4 kmp \u66f4\u4f18\u7f8e\u3002~~\r\n\r\n\r\n------------\r\n\r\n\r\n#### code\r\n```cpp\r\n#include<bits/stdc++.h>\r\nusing namespace std;\r\n#define rg register\r\n#define ll long long\r\n#define ull unsigned ll\r\n#define inf 0x3f3f3f3f\r\n#define djq 998244353\r\n#define lowbit(x) (x&(-x))\r\ninline void file(){\r\n\tfreopen(\"baka.in\",\"r\",stdin);\r\n\tfreopen(\"baka.out\",\"w\",stdout);\r\n}\r\nchar buf[1<<21],*p1=buf,*p2=buf;\r\ninline int getc(){\r\n    return p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++;\r\n}\r\ninline int read(){\r\n\trg int ret=0,f=0;char ch=getc();\r\n    while(!isdigit(ch)){if(ch==EOF)exit(0);if(ch=='-')f=1;ch=getc();}\r\n    while(isdigit(ch)){ret=ret*10+ch-48;ch=getc();}\r\n    return f?-ret:ret;\r\n}\r\nint n,m,lim[10000005],z[10000005],f[10000005];;\r\nchar s[10000005],t[10000005];\r\nint q[10000005],fr,re;\r\nsigned main(){\r\n\t//file();\r\n\tscanf(\"%d%d%s%s\",&m,&n,t+1,s+1);\r\n\tz[1]=m;\r\n\tfor(rg int i=2,l=0,r=0;i<=m;++i){\r\n\t\tif(i<=r) z[i]=min(r-i+1,z[i-l+1]);\r\n\t\telse z[i]=0;\r\n\t\twhile(i+z[i]<=m&&t[1+z[i]]==t[i+z[i]]) ++z[i];\r\n\t\tif(r<i+z[i]-1) l=i,r=i+z[i]-1;\r\n\t}\r\n\tfor(rg int i=1,l=0,r=0;i<=n;++i){\r\n\t\tif(i<=r) lim[i]=min(r-i+1,z[i-l+1]);\r\n\t\telse lim[i]=0;\r\n\t\twhile(i+lim[i]<=n&&1+lim[i]<=m&&t[1+lim[i]]==s[i+lim[i]]) ++lim[i];\r\n\t\tif(r<i+lim[i]-1) l=i,r=i+lim[i]-1;\r\n\t}\r\n\tfor(rg int i=1,j=0;i<=n;++i) j>i+lim[i]?lim[i]=inf:j=i+lim[i];\r\n\tmemset(f,0x3f,sizeof(f));\r\n\tf[n+1]=0; q[fr=re=1]=n+1;\r\n\tfor(rg int i=n;i>=1;--i){\r\n\t\tif(lim[i]==inf) continue;\r\n\t\twhile(fr-1!=re&&q[fr]>i+lim[i]) ++fr; \r\n\t\tconst int j=q[fr];\r\n\t\tf[i]=f[j]+1;\r\n\t\twhile(fr-1!=re&&f[q[re]]>=f[i]) --re;\r\n\t\tq[++re]=i;\r\n\t}\r\n\tif(f[1]>=0x3f3f3f3f) puts(\"Fake\");\r\n\telse printf(\"%d\",f[1]);\r\n\treturn 0;\r\n}\r\n/*\r\n\r\n*/\r\n```\r\n",
        "postTime": 1644150989,
        "uid": 241977,
        "name": "Legitimity",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P8112"
    },
    {
        "content": "### \u4e00\u4e9b\u5e9f\u8bdd\uff1a\n\n\u849f\u84bb\u5728\u7ec3\u4e60\u5b57\u7b26\u4e32\u7684\u65f6\u5019\u770b\u5230\u7684\u9898\uff0c\u8bd5\u4e86\u8bd5\u7528 KMP + DP \u505a\uff0c\n\n\u7136\u540e ~~\u7adf\u7136~~ AC \u4e86\u3002\n\n\u597d\u5947\u7ffb\u770b\u4e86\u4e00\u4e0b\u9898\u89e3\uff0c\u53d1\u73b0 ~~\u597d\u50cf~~ \u6ca1\u4eba\u5199\u6211\u8fd9\u79cd\u505a\u6cd5\uff0c\u6545\u5199\u4e00\u4e0b\u9898\u89e3\u3002\n\n\n---\n### \u601d\u8def\n\u672c\u9898\u8981\u6c42\u6211\u4eec\u5c06 $S$ \u4e32\u5206\u5272\u6210 **\u5c3d\u53ef\u80fd\u5c11\u7684** $T$ \u4e32\u7684\u975e\u7a7a\u524d\u7f00\u3002\n\n\u663e\u7136\uff0c\u5047\u5982 $S$ \u4e32\u53ef\u4ee5\u7531 $T$ \u4e32\u7684\u975e\u7a7a\u524d\u7f00\u7ec4\u6210\uff0c\u5219 $S$ \u4e32\u7684\u524d\u7f00\u80af\u5b9a\u53ef\u5206\u6210\u4e24\u90e8\u5206\uff1a\u4e00\u90e8\u5206\u7531\u8bb8\u591a\uff08\u5047\u8bbe\u5df2\u77e5\uff09 $T$ \u4e32\u7684\u975e\u7a7a\u524d\u7f00\u7ec4\u6210\u7684\u90e8\u5206\uff0c\u53e6\u4e00\u90e8\u5206\u5219\u662f\u7531\u4e00\u4e2a $T$ \u4e32\u7684\u975e\u7a7a\u524d\u7f00\u7ec4\u6210\u3002\n\n\n\u6362\u8a00\u4e4b\uff0c\n**\u82e5 $S$ \u4e32\u53ef\u4ee5\u7531 $T$ \u4e32\u7684\u975e\u7a7a\u524d\u7f00\u7ec4\u6210**\uff0c\n\u5219\u5bf9\u4e8e $S[1, i]$ \uff0c\u80af\u5b9a\u5b58\u5728\u65ad\u70b9 $1 \\le j \\le i$\uff0c\u6ee1\u8db3\n$$S[1, i] \\leftarrow {S[1, j]}+T[1,k]$$\n\u5176\u4e2d\u6709\uff0c \n$$T[1, k] =S[j+1,i]$$\n\n\u8bf4\u4eba\u8bdd\u5c31\u662f\uff0c**\u4e32 $S[1, i]$ \u7684\u540e\u7f00\u4e00\u5b9a\u662f\u4e32 $T$ \u7684\u67d0\u4e2a\u524d\u7f00\u3002**\n\n\u60f3\u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f00\u59cb\u60f3 DP \u7684\u72b6\u6001\u8868\u793a\u4ee5\u53ca\u8f6c\u79fb\u65b9\u7a0b\u4e86\u3002\n\n### \u89e3\u6cd5\n\u4e0d\u59a8\u8bbe\u5b57\u7b26\u4e32\u7684\u4e0b\u6807\u4ece 1 \u5f00\u59cb\u3002\n\n\u6211\u4eec\u8bbe $dp[i]$ \u8868\u793a\u4e32 $S[1, i]$ \u6700\u5c11\u80fd\u88ab\u5206\u6210\u591a\u5c11\u4e2a\u4e32 $T$ \u7684\u975e\u7a7a\u524d\u7f00\u3002\n\n\u663e\u7136\u6709\u8f6c\u79fb\u5f0f\uff08\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u53ef\u4ee5\u91cd\u65b0\u770b\u770b **\u601d\u8def**\uff09\n$$dp[i] \\leftarrow {\\min{{(dp[j] + 1)}}}, S[j+1,i] = T[1,i-j]$$\n\u91cd\u65b0\u770b\u770b $S[j+1,i] = T[1,i-j]$ \u8fd9\u4e2a\u5f0f\u5b50\uff0c**\u8fd9\u4e0d\u5c31\u662f KMP \u53cc\u4e32\u5339\u914d\u7684\u7ecf\u5178\u5f62\u5f0f\u5417\uff1f**\n\n\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5148\u6c42\u51fa\u4e32 $T$ \u7684 $nxt$ \u6570\u7ec4\uff0c\u7136\u540e\u518d\u5bf9 \u4e32 $S$ \u548c\u4e32 $T$ \u8dd1\u4e00\u904d KMP \u53cc\u4e32\u5339\u914d\uff0c\u4e00\u8fb9\u8dd1\uff0c\u4e00\u8fb9\u66f4\u65b0 $dp$ \u6570\u7ec4\u5373\u53ef\u3002\n\n\u7b54\u6848\u662f $dp[m]$ \u3002\n\n\u8fb9\u754c\u663e\u7136\u662f $dp[0] \\leftarrow 0$\uff0c\u7531\u4e8e\u5b58\u5728 No solution \u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u5f97\u6ce8\u610f\u65e0\u6cd5\u8f6c\u79fb\u7684\u60c5\u51b5\u3002\n\n\u4ee5\u4e0b\u662f**\u4ee3\u7801\u65f6\u95f4**\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<ctime>\n#include<cmath>\n#include<cstring>\nusing namespace std;\n//========================================\n\nconst int MAXN = 1e7 + 10;\nchar s[MAXN], t[MAXN];\nint nxt[MAXN];\nint dp[MAXN];\n\nvoid getnxt(char *str, int n)\n{\n    for(int i = 2, j = 0; i <= n; i++)\n    {\n        while(j && str[i] != str[j + 1]) j = nxt[j];\n        if(str[i] == str[j + 1]) j++;\n        nxt[i] = j;\n    }\n}\n\nint main(int argc, char const *argv[])\n{\n    clock_t c1 = clock();\n#ifdef CHAYI\n    freopen(\"in.in\", \"r\", stdin);\n    freopen(\"out.out\", \"w\", stdout);\n#endif\n    //=========================================\n    int n, m; scanf(\"%d%d\", &n, &m);\n    scanf(\"%s%s\", t + 1, s + 1);\n    getnxt(t, n); t[n + 1] = '#'; nxt[n + 1] = 1;\n    for(int i = 0; i <= m; i++) dp[i] = 0x3f3f3f3f;\n    int INF = dp[0]; dp[0] = 0;\n    for(int i = 1, j = 0; i <= m; i++)\n    {\n        while(j && s[i] != t[j + 1]) j = nxt[j];\n        if(s[i] == t[j + 1]) j++;\n        dp[i] = min(dp[i], dp[i - j] + 1);\n    }\n    if(dp[m] < INF) printf(\"%d\\n\", dp[m]);\n    else puts(\"Fake\");\n    //=========================================\n#ifdef CHAYI\nend:\n    cerr << \"Time Used:\" << clock() - c1 << \"ms\" << endl;\n#endif\n    return 0;\n}\n```\n",
        "postTime": 1662640180,
        "uid": 144659,
        "name": "chayi",
        "ccfLevel": 0,
        "title": "P8112 [Cnoi2021]\u7b26\u6587\u7834\u8bd1 \u9898\u89e3"
    },
    {
        "content": "\u8d5b\u65f6 $O(n\\log{n})$ \u8fc7\u4e86 $10^7$\uff0c\u6765\u6c34\u7bc7\u9898\u89e3\uff08\n\n\u8bbe $g_i$ \u4ee3\u8868\u5b57\u7b26\u4e32 $\\texttt{S}$ \u4ee5 $i$ \u4e3a\u5f00\u5934\u4e0e $\\texttt{T}$ \u5339\u914d\u7684\u6700\u957f\u957f\u5ea6\uff0c\u53ef\u4ee5\u7528 exkmp \u6c42\u51fa\u3002\n\n\u8003\u8651 dp\uff0c\u8bbe $f_i$ \u8868\u793a\u4ee5 $i$ \u7ed3\u5c3e\u7684\u6700\u5c11\u5212\u5206\u6b21\u6570\uff0c\u6bcf\u6b21\u7528 $i$ \u66f4\u65b0 $j\\in\\left[i+1,i+g_i-1\\right]$\u3002\n\n~~\u8fd9\u4e2a dp \u53ef\u80fd\u53ef\u4ee5\u7528\u5409\u53f8\u673a\u7ebf\u6bb5\u6811\u4f18\u5316\uff0c\u4e0d\u77e5\u9053\u8fc7\u4e0d\u8fc7\u7684\u53bb\u3002~~\n\n\u8003\u8651\u5c06\u8fd9\u4e2a dp \u5012\u8fc7\u6765\uff0c\u8bbe $f_i$ \u8868\u793a\u4ee5 $i$ \u5f00\u59cb\u7684\u6700\u5c11\u5212\u5206\u6b21\u6570\uff0c\u6bcf\u6b21\u7528 $j\\in\\left[i+1,i+g_i-1\\right]$ \u66f4\u65b0 $i$\u3002\n\n\u8fd9\u4e2a dp \u53ef\u4ee5\u7528\u666e\u901a\u7684\u7ebf\u6bb5\u6811\u6765\u4f18\u5316\uff0c\u652f\u6301\u5355\u70b9\u4fee\u6539\u533a\u95f4\u6c42 min \u5373\u53ef\uff0c\u7528 zkw \u80fd 900+ms \u5361\u8fc7\u53bb\u3002\n\n[Code](https://www.luogu.com.cn/paste/uqz0pd8c)",
        "postTime": 1644043385,
        "uid": 639649,
        "name": "KemononeRou",
        "ccfLevel": 0,
        "title": "P8112"
    },
    {
        "content": "### \u5f53\u4f60\u4e0d\u4f1a KMP \u53ca\u66f4\u9ad8\u7ea7\u7684\u5b57\u7b26\u4e32\u7b97\u6cd5\u65f6\uff0c\u770b\u8fd9\u91cc\n\n\u8bbe $f(S)$ \u8868\u793a\u5c06\u4e00\u4e2a\u5b57\u7b26\u4e32 $S$ \u8868\u793a\u6210 $T$ \u7684\u524d\u7f00\u76f8\u8fde\u6700\u5c11\u9700\u8981\u5212\u5206\u51e0\u6bb5\u3002\n\n\u9996\u5148\u7531\u4e00\u4e2a\u5e73\u51e1\u7684\u8d2a\u5fc3\uff08\u5f15\u7406\uff09\uff0c\u6bcf\u4e2a\u5b57\u7b26\u4e32\u62c6\u6210 $T$ \u7684\u524d\u7f00\u76f8\u8fde\u65f6\uff0c\u6700\u540e\u4e00\u4e2a\u5b50\u4e32\u5e94\u8be5\u5c3d\u53ef\u80fd\u957f\u3002\u53ea\u8981\u6ce8\u610f\u5230\u5f53 $A$ \u4e3a $B$ \u7684\u524d\u7f00\u65f6\uff0c\u5fc5\u6709 $f(A)<=f(B)$\uff0c\u518d\u53cd\u8bc1\u5373\u5f97\u3002\n\n\u6240\u4ee5\u6211\u4eec\u4ece\u524d\u5f80\u540e\u5bf9\u9898\u76ee\u6240\u7ed9 $S$ \u7684\u6240\u6709\u524d\u7f00\u6c42 $f$\uff1a\u9996\u5148\u5904\u7406\u51fa $f=1$ \u7684\u524d\u9762\u4e00\u4e9b\u524d\u7f00\u4e32\uff0c\u518d\u4ece\u524d\u5f80\u540e\u7528\u5df2\u7ecf\u5904\u7406\u51fa $f$ \u7684\u524d\u7f00\u4e32\u901a\u8fc7\u540e\u9762\u63a5\u4e0a\u4e00\u6bb5 $T$  \u7684\u524d\u7f00\uff0c\u5411\u540e\u9762\u672a\u5904\u7406\u7684\u8f6c\u79fb\uff1b\u7531\u5f15\u7406\u6bcf\u4e2a\u524d\u7f00\u4e32 $S_i$ \u7b2c\u4e00\u6b21\u88ab\u8f6c\u79fb\u5230\u65f6\uff0c\u53ef\u4ee5\u53d6\u5230 $f(S_i)$ \u7684\u6700\u5c0f\u503c\u3002\n\n\u5982\u679c\u7528\u6bcf\u4e2a\u524d\u7f00 $S_i$ \u5411\u540e\u8f6c\u79fb\u65f6\uff0c\u90fd\u66b4\u529b\u52a0\u6bcf\u4e2a $T$ \u7684\u524d\u7f00\uff0c\u662f $O(n^2)$ \u7684\u3002\n\n##### \u4f18\u5316\n\n\u6211\u4eec\u53d1\u73b0\u6bcf\u6b21\u8f6c\u79fb\u5b8c\u540e\uff0c\u5f53\u524d\u5df2\u7ecf\u5904\u7406\u597d\u7684\u4f4d\u7f6e\u5fc5\u7136\u662f\u6700\u524d\u9762\u8fde\u7eed\u4e00\u6bb5\uff08\u5373\u5df2\u7b97\u51fa $S$ \u6700\u524d\u9762\u51e0\u4e2a\u524d\u7f00\u4e32\u7684 $f$\uff09\uff0c\u6240\u4ee5\u7528\u4e00\u4e2a\u6307\u6807 $pos$ \u6307\u793a\u5f53\u524d\u5df2\u7ecf\u5904\u7406\u5230\u54ea\u4e2a\u4f4d\u7f6e\uff0c\u4e0b\u6b21\u76f4\u63a5\u4ece $pos+1$ \u5f00\u59cb\u8fdb\u884c\u8f6c\u79fb\u5373\u53ef\u3002\u7531\u4e8e\u6574\u4e2a\u8fc7\u7a0b $pos$ \u4ece $1$ \u53d8\u5230 $n$\uff0c\u590d\u6742\u5ea6\u4e3a $O(n)$\n\n##### \u95ee\u9898\u6765\u4e86\n\n\u5982\u4f55\u5224\u65ad $pos+1$ \u4f4d\u7f6e\u80fd\u5426\u6210\u529f\u8f6c\u79fb\uff1f\u4e5f\u5c31\u662f\u8bf4\uff0c\u5224\u65ad $S$ \u7684\u4ece\u201c\u5f53\u524d\u6b63\u5728\u5411\u540e\u8f6c\u79fb\u7684 $S$ \u524d\u7f00\u201d\u7684\u4e0b\u4e00\u4f4d\u5230 $pos+1$ \u4f4d\u7f6e\u8fd9\u6bb5\u5b50\u4e32\u662f\u5426\u4e3a $T$ \u7684\u524d\u7f00\uff1f\n\n**\u4e0d\u4f1a KMP \u65f6\uff0c\u6211\u4eec\u8981\u60f3\u5230\u5b57\u7b26\u4e32 Hash\uff01**\n\nHash\u89c1\u4ee3\u7801\n\n\u5982\u679c $pos+1$ \u4f4d\u53ef\u4ee5\u8f6c\u79fb\uff0c\u4e4b\u540e\u7684\u4f4d\u7f6e\u5224\u65ad\u80fd\u5426\u8f6c\u79fb\u65f6\u53ea\u9700\u5c06\u8be5\u4f4d\u7f6e\u548c $T$ \u7684\u5bf9\u5e94\u4f4d\u7f6e\u6bd4\u8f83\u5373\u53ef\u3002\n\n\u90a3\u6574\u4e2a\u8fc7\u7a0b\u5c31\u68b3\u7406\u5b8c\u4e86\u3002\n\n```cpp\n//coder: YB-Elsa of Ahtohallan\n#include<bits/stdc++.h>\n#define fu(i,a,b) for(register int i = a, I = (b) + 1; i < I; ++i)\n#define fd(i,a,b) for(register int i = a, I = (b) - 1; i > I; --i)\nusing namespace std;\ntypedef long long ll;\nconst int N=1e7+10;\nconst int base=131;\nconst int mod=19491001;\ninline int read(){\n    int x=0;char ch=getchar();\n    while(!isdigit(ch))ch=getchar();\n    while(isdigit(ch))x=(x<<1)+(x<<3)+ch-'0',ch=getchar();\n    return x;\n}int n,m;\nstring s,t;\nint dp[N],pt,pos;\nint hs1[N],hs2[N],p[N];\nvoid init1(){//\u6ce8\u610fS\u548cT\u8981\u5206\u5f00Hash \n    p[0]=1;\n    fu(i,1,N-5)p[i]=1LL*p[i-1]*base%mod;\n    fu(i,1,m)hs1[i]=(1LL*hs1[i-1]*base%mod+(s[i-1]-'a'))%mod;\n}void init2(){\n    fu(i,1,n)hs2[i]=(1LL*hs2[i-1]*base%mod+(t[i-1]-'a'))%mod;\n}\ninline int get1(int l,int r){\n    return ((hs1[r]-1LL*hs1[l-1]*p[r-l+1]%mod)%mod+mod)%mod;\n}inline int get2(int l,int r){\n    return ((hs2[r]-1LL*hs2[l-1]*p[r-l+1]%mod)%mod+mod)%mod;//Beware\uff01\u53ef\u80fd\u662f\u8d1f\u6570\u53d6\u6a21\uff01\u8981\u8f6c\u4e3a\u6b63\u6570\u5224\u65ad\uff01 \n}\nsigned main(){\n//\tfreopen(\"frozen.in\",\"r\",stdin);\n\tn=read(),m=read();\n\tcin>>t>>s;\n\tinit1();init2();\n\tmemset(dp,0x7f,sizeof(dp));\n\tfu(i,0,m-1){//\u5904\u7406\u6700\u524d\u9762\u7684\u4f4d\u7f6e \n\t\tpos=i;\n\t\tif(pt==n)break;\n\t\tif(s[i]==t[pt]){\n\t\t\tdp[i]=1;\n\t\t\tpt++;\n\t\t}else break;\n\t}\n\tfu(i,0,m-1){\n\t//\tcout<<i<<' '<<dp[i]<<endl;\n\t\tif(pos>=m || pos-i>n || dp[i]==dp[m])continue;\n\t\tif(get1(i+2,pos+1)!=get2(1,pos-i))continue;//\u5224\u65ad\u7b2c pos+1 \u4f4d\u80fd\u5426\u8f6c\u79fb \n\t\tpt=pos-i-1;//\u6307\u793a\u5bf9\u5e94 T \u7684\u54ea\u4e00\u4f4d \n\t\tfu(j,pos-i,m-1-i){\n\t\t\tpos=i+j;\n\t\t\tif(pt>=n || s[i+j]!=t[pt])break;\n\t\t\tif(dp[i+j]==dp[m])dp[i+j]=dp[i]+1;\n\t\t\tpt++;\n\t\t}\n\t}if(dp[m-1]==dp[m])puts(\"Fake\");//\u65e0\u89e3 \n\telse printf(\"%d\\n\",dp[m-1]);\n    return 0;\n}\n```\n\n",
        "postTime": 1645758971,
        "uid": 104292,
        "name": "YellowBean_Elsa",
        "ccfLevel": 7,
        "title": "\u9898\u89e3P8112"
    },
    {
        "content": "\u4e0d\u9519\u7684 **Z \u51fd\u6570**\u7ec3\u4e60\u9898\u3002\n\n\u5f88\u660e\u663e\u6b63\u7740\u505a\u4e0d\u597d\u641e\uff0c\u56e0\u4e3a\u5047\u5982\u9009\u53d6\u4e86\u5f53\u524d\u67d0\u4e2a\u524d\u7f00\uff0c\u5f88\u5bb9\u6613\u5f71\u54cd\u5230\u540e\u9762\u7684\u9009\u53d6\uff0c\u5e76\u4e14\u4e0d\u597d\u4f18\u5316\u3002\n\n\u7ecf\u5178**\u6b63\u96be\u5219\u53cd**\u7684\u601d\u60f3\uff0c\u8003\u8651\u4ece\u540e\u9762\u9010\u6e10\u9009\u53d6\u6a21\u5f0f\u4e32\u7684\u524d\u7f00\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u5f71\u54cd\u5230\u524d\u9762\u524d\u7f00\u7684\u9009\u53d6\uff08\u611f\u6027\u7406\u89e3\uff09\u3002\u4e5f\u5c31\u610f\u5473\u7740\uff0c\u6211\u4eec\u6bcf\u6b21\u5c1d\u8bd5\u9009\u53d6\u4e00\u4e2a\u6587\u672c\u4e32\u7684\u4e00\u4e2a**\u540e\u7f00**\uff0c\u4f7f\u5176\u7b49\u4e8e\u6a21\u5f0f\u4e32\u7684**\u524d\u7f00**\uff0c\u7136\u540e\u8fdb\u884c\u4e0b\u4e00\u6b65\u64cd\u4f5c\u3002\n\n\u8fd9\u662f\u6211\u4eec\u60f3\u5230\u4ec0\u4e48\uff1f **Z \u51fd\u6570**\u4e0d\u5c31\u662f\u7528\u6765\u6c42\u51fa\u8fd9\u4e1c\u897f\u7684\u5417\u3002\u8003\u8651 **DP**\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u5199\u51fa\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$f_i=min_{i+1\\le j\\le i+p_i}{f[j]+1}$\u3002\n\n\u6709\u4e86\u8fd9\u4e2a\uff0c\u76f4\u63a5\u66b4\u529bDP\u662f $\\mathcal O(N^2)$ \u7684\uff0c\u663e\u7136\u53ef\u4ee5\u7528\u7ebf\u6bb5\u6811\u6765\u7ef4\u62a4\uff0c\u4f46 $\\mathcal O(N\\log N)$ \u590d\u6742\u5ea6\u4ecd\u4e0d\u5141\u8bb8\u6211\u4eec\u901a\u8fc7\u6b64\u9898\u3002\n\n\u8fd8\u80fd\u7ee7\u7eed\u4f18\u5316\u5417\uff1f\u6ce8\u610f\u5230\u5bf9\u4e8e\u6240\u4ee5\u53ef\u4ee5\u8f6c\u79fb\u5230\u7684 $f_i$  \u4e00\u5b9a\u662f\u5177\u6709**\u5355\u8c03\u6027**\uff0c\u56e0\u4e3a\u8f83\u77ed\u7684\u540e\u7f00\u7684\u4ee3\u4ef7\u4e00\u5b9a\u4e0d\u4f1a\u5927\u4e8e\u8f83\u957f\u7684\u540e\u7f00\u7684\u4ee3\u4ef7\u3002\u800c\u4e14\u6839\u636e **Z \u51fd\u6570**\u7684\u6027\u8d28\uff0c\u5bf9\u4e8e\u6240\u6709\u53ef\u4ee5\u8f6c\u79fb\u5230\u7684 $i$\uff0c$i+p_i$ \u660e\u663e\u662f**\u5355\u8c03\u9012\u51cf**\u7684\u3002\u8fd9\u77ac\u95f4\u5c31\u8f6c\u5316\u4e3a\u7ecf\u5178\u6a21\u578b\u4e86\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u7528**\u5355\u8c03\u961f\u5217**\u6765\u4f18\u5316\uff0c\u4e8e\u662f\u590d\u6742\u5ea6\u5c31\u53d8\u4e3a\u4e86\u4f18\u79c0\u7684 $\\mathcal O(N)$\u3002\n\n\u56e0\u4e3a $f_i$ \u5177\u6709**\u5355\u8c03\u6027**\uff0c\u6bcf\u6b21\u6211\u4eec\u76f4\u63a5\u5c06\u5176\u52a0\u5165\u961f\u5c3e\u5c31\u53ef\u4ee5\u4e86\u3002\u7136\u540e\u6ce8\u610f\u4e00\u4e9b\u7ec6\u8282\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\nconst int N=1e7+10,INF=1e9;\nint n,m;\nchar a[N],b[N];\nint z[N],p[N],f[N];\nint l,r,q[N];\nvoid Z(char *s,int n)\n{\n    z[1]=n;\n    for(int i=2,l=0,r=0;i<=n;i++)\n    {\n        if(i<=r)z[i]=min(z[i-l+1],r-i+1);\n        while(i+z[i]<=n&&s[i+z[i]]==s[z[i]+1])z[i]++;\n        if(i+z[i]-1>r)l=i,r=i+z[i]-1;\n    }\n}\nvoid exkmp(char *s,int n,char *t,int m)\n{\n    Z(t,m);\n    for(int i=1,l=0,r=0;i<=n;i++)\n    {\n        if(i<=r)p[i]=min(z[i-l+1],r-i+1);\n        while(i+p[i]<=n&&s[i+p[i]]==t[p[i]+1])p[i]++;\n        if(i+p[i]-1>r)l=i,r=i+p[i]-1;\n    }\n}//Z\u51fd\u6570\u6a21\u677f\nint main()\n{\n    scanf(\"%d %d %s %s\",&m,&n,b+1,a+1);\n    exkmp(a,n,b,m);\n    for(int i=1,j=0;i<=n;i++)\n        j>i+p[i]?p[i]=0:j=i+p[i];//\u6ce8\u610f\u5904\u7406\u4e0d\u53ef\u80fd\u8f6c\u79fb\u5230\u7684\u60c5\u51b5\n    memset(f,0x3f,sizeof(f));\n    f[q[l=r=1]=n+1]=0;\n    for(int i=n;i;i--)\n    {\n        if(!p[i])continue;\n        while(l<=r&&q[l]>i+p[i])l++;\n        f[i]=f[q[l]]+1;\n        // while(l<=r&&f[q[r]]>=f[i])r--;\n        //\u8fd9\u91cc\u76f4\u63a5\u5165\u961f\u5c31\u53ef\u4ee5\u4e86\n        q[++r]=i;\n    }\n    if(f[1]<=INF)printf(\"%d\\n\",f[1]);\n    else puts(\"Fake\");\n    return 0;\n}\n```\n\n\u5e0c\u671b\u6ca1\u6709\u8bef\u4eba\u5b50\u5f1f qwq\u3002",
        "postTime": 1660831243,
        "uid": 109659,
        "name": "KevinLive",
        "ccfLevel": 0,
        "title": "P8112 [Cnoi2021]\u7b26\u6587\u7834\u8bd1"
    },
    {
        "content": "[P8112 [Cnoi2021]\u7b26\u6587\u7834\u8bd1](https://www.luogu.com.cn/problem/P8112)\n\n\u501f\u7528 KMP \u601d\u60f3\u4f18\u5316\u7684\u52a8\u6001\u89c4\u5212\u3002\n\n\u9996\u5148\uff0c\u7528 $dp[i]$ \u8868\u793a\u628a\u524d $i$ \u4f4d\u7684\u5b57\u7b26\u5b8c\u5168\u5339\u914d\u9700\u8981\u7684\u6700\u5c11\u8bcd\u7f00\u6570\uff08\u4e0b\u6807\u5747\u4ece $1$ \u5f00\u59cb\uff09\u3002\u90a3\u4e48\uff0c\u6211\u4eec\u53ef\u4ee5\u4ece\u70b9 $i+1$ \u5f00\u59cb\uff0c\u5411\u540e\u9010\u4f4d\u4e0e\u5b57\u7b26\u4e32 $T$ \u6bd4\u8f83\u3002\u8bbe\u6b64\u65f6\u5339\u914d\u5230\u4e86 $T$ \u4e2d\u7684\u7b2c $j$ \u4f4d\uff0c\u5982\u679c\u76f8\u7b49\uff0c\u5219\u6613\u5f97\u8f6c\u79fb\u65b9\u7a0b\uff1a \n\n$$dp[i+j]=\\min(dp[i+j],dp[i]+1)$$\n\n\u5982\u679c\u4e0d\u76f8\u7b49\u6216\u5230\u8fbe\u4e86\u5b57\u7b26\u4e32 $T$ \u672b\u5c3e\uff0c\u5219\u8bc1\u660e\u5728\u6b64\u4e4b\u540e\u4e0d\u4f1a\u66f4\u957f\u7684\u6709\u9b54\u6cd5\u8bcd\u7f00\uff0c\u53ef\u4ee5\u7ed3\u675f\u8fd9\u4e00\u6b21\u5339\u914d\uff0c\u4ee4 $i=i+1$ \u8ba1\u7b97\u4e0b\u4e00\u4f4d\u5373\u53ef\u3002\n\n\u5f88\u660e\u663e\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(|S||T|)$ \u7684\uff0c\u5f53\u6570\u636e\u8303\u56f4\u8fbe\u5230 $|S|,|T|\\le10^6$ \u65f6\uff0c\u7b97\u6cd5\u5fc5\u7136\u8d85\u65f6\u3002\n\n\u8003\u8651\u4f18\u5316\u8fd9\u4e2a\u7b97\u6cd5\uff0c\u6211\u4eec\u77e5\u9053\uff0c\u5982\u679c\u4e0d\u76f8\u7b49\u6216\u5230\u8fbe\u4e86\u5b57\u7b26\u4e32 $T$ \u672b\u5c3e\uff0c\u5931\u914d\u540e\u662f\u53ef\u4ee5\u76f4\u63a5\u8df3\u8fc7\u4e00\u90e8\u5206\u4e0d\u53ef\u80fd\u4ea7\u751f\u65b0\u7684\u89e3\u7684\u6570\u636e\u3002\u8fd9\u6837\u5c31\u81ea\u7136\u800c\u7136\u5730\u60f3\u5230\u4e86\u7528\u8fd9\u4e2a\u601d\u60f3\u628a\u5355\u6a21\u5b57\u7b26\u4e32\u5339\u914d\u4f18\u5316\u5230 $O(|S|+|T|)$ \u7684 KMP \u7b97\u6cd5\u3002\n\n\u501f\u52a9 KMP \u7684\u601d\u60f3\uff0c\u9996\u5148\u6c42\u51fa\u5b57\u7b26\u4e32 $T$ \u7684 $next$ \u6570\u7ec4\uff0c\u7136\u540e\u5f00\u59cb\u6309\u7167 KMP \u7684\u65b9\u5f0f\u5339\u914d\uff1a\uff08\u8bbe\u6b64\u65f6\u6587\u672c\u4e32\u5339\u914d\u5230\u7b2c $i$ \u9879\uff0c\u6a21\u5f0f\u4e32\u5339\u914d\u5230\u7b2c $j$ \u9879\uff09\n\n\u8bbe\u7f6e\u4e00\u4e2a\u540d\u4e3a $now$ \u7684\u4e34\u65f6\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u5982\u679c\u5339\u914d\u7684\u6700\u5c11\u8bcd\u7f00\u6570\u3002\n\n\u53ef\u4ee5\u76f4\u63a5\u9010\u4f4d\u6bd4\u8f83\u3002\u5982\u679c\u76f8\u7b49\uff0c\u5219\u6309\u7167 KMP \u601d\u60f3\uff0c\u5c06\u6a21\u5f0f\u4e32\u548c\u6587\u672c\u4e32\u6307\u9488\u4e00\u8d77\u540e\u79fb\uff0c\u4ee4 $dp[i]=now$ \u540e\u6bd4\u8f83\u4e0b\u4e00\u4f4d\u3002\n\n\u5982\u679c\u4e0d\u76f8\u7b49\uff0c\u53ef\u4ee5\u4ee4 $j=next[j]$ \u4e4b\u540e\u91cd\u65b0\u8ba1\u7b97 $now$ \u7684\u503c\u3002\u56e0\u4e3a\u4e00\u65e6\u5339\u914d\u5931\u8d25\uff0c\u53ea\u80fd\u518d\u6b21\u9009\u62e9\u4e00\u4e2a\u8bcd\u7f00\u3002\u6bcf\u6b21 KMP \u7b97\u6cd5\u5728\u5339\u914d\u5931\u8d25\u540e\uff0c\u4f1a\u5229\u7528\u6700\u957f\u516c\u5171\u524d\u540e\u7f00\u7684\u6027\u8d28\u4f7f\u5f97\u6587\u672c\u4e32\u6307\u9488 $i$ \u4e0d\u5f80\u524d\u8df3\u3002\u800c\u6bcf\u6b21\u5229\u7528\u6700\u957f\u516c\u5171\u524d\u540e\u7f00\u7684\u6027\u8d28\uff0c\u4f1a\u6539\u53d8\u6a21\u5f0f\u4e32\u5339\u914d\u7684\u8d77\u59cb\u4f4d\u7f6e\uff0c\u6240\u4ee5\u9700\u8981\u91cd\u65b0\u8ba1\u7b97 $now$ \u7684\u503c\u3002\u53ef\u4ee5\u76f4\u63a5\u7528 $dp[i-j]$ \u8ba1\u7b97\u51fa\u6a21\u5f0f\u4e32\u5339\u914d\u7684\u8d77\u59cb\u4f4d\u7f6e\u7684\u524d\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u628a $now$ \u7684\u503c\u66f4\u65b0\u4e3a $dp[i-j]+1$ \u4ee5\u4fdd\u8bc1\u6b63\u786e\u6027\u3002\u6a21\u5f0f\u4e32\u5339\u914d\u5230\u672b\u5c3e\u4e5f\u662f\u540c\u7406\u3002\n\nDP \u8fb9\u754c\uff1a$dp[0]=1$\u3002 \n\nDP \u76ee\u6807\uff1a$dp[|S|]$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(|S|+|T|)$\u3002\n\n\u6ce8\u610f\uff0c\u7531\u4e8e\u6709\u65e0\u89e3\u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u5f53 $next$ \u6570\u7ec4\u8df3\u5230 $-1$ \u65f6\uff0c\u5e94\u8be5\u76f4\u63a5\u5224\u5b9a\u65e0\u89e3\u5e76\u8f93\u51fa `Fake`\u3002\u56e0\u4e3a\u5982\u679c $next$ \u6570\u7ec4\u8df3\u5230 $-1$ \u8bc1\u660e\u5339\u914d\u7b2c\u4e00\u4e2a\u5b57\u7b26\u5c31\u5931\u914d\u4e86\uff0c\u6b64\u65f6\u540e\u9762\u6ca1\u6709\u529e\u6cd5\u518d\u8fdb\u884c\u5339\u914d\uff0c\u65e0\u89e3\u3002\n\n\u5b8c\u6574\u4ee3\u7801\uff1a\uff08\u7531\u4e8e\u4ee3\u7801\u4e2d\u7684\u5b57\u7b26\u4e32\u4e0b\u6807\u662f\u4ece $0$ \u5f00\u59cb\u7684\uff0c\u6240\u4ee5\u53ef\u80fd\u4f1a\u548c\u4e0a\u6587\u7684\u8bb2\u89e3\u6709\u4e9b\u51fa\u5165\uff09\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint lt,ls,next1[10000010],f[10000010];\nchar t[10000010],s[10000010]; \nvoid get_next(char t[],int next[])\n{\n\tint i=0,j=-1;\n\tnext[0]=-1;\n\twhile(i<lt)\n\t   {\n\t   \tif(j==-1||t[i]==t[j])i++,j++,next[i]=j;\n\t   \telse j=next[j];\n\t   }\n}\n\nbool kmp(char s[],char t[],int next[])\n{\n\tint i=0,j=0,now=1;\n\tf[0]=1;\n\twhile(i<ls)\n\t   {\n\t   \tif(j==-1)return 0;\n\t   \tif(s[i]==t[j])i++,j++,f[i]=now;\n\t   \telse j=next[j],now=f[i-j]+1;\n\t   \tif(j==lt)now=f[i-j]+1,j=next[j];\n\t   }\n\treturn 1;\n}\n\nint main()\n{\n\tscanf(\"%d%d%s%s\",&lt,&ls,t,s);\n\tget_next(t,next1);\n\tif(!kmp(s,t,next1))printf(\"Fake\");\n\telse printf(\"%d\",f[ls]);\n    return 0;\n}\n\n```\n\n[AC\u8bb0\u5f55](https://www.luogu.com.cn/record/105966531)",
        "postTime": 1682130823,
        "uid": 569235,
        "name": "w9095",
        "ccfLevel": 0,
        "title": "P8112 [Cnoi2021]\u7b26\u6587\u7834\u8bd1 \u9898\u89e3-\u518d\u518d\u6539"
    }
]
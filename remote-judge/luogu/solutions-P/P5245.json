[
    {
        "content": "\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u505a\u591a\u9879\u5f0f $\\ln$ \u5e76\u4e58\u4ee5 $k$ \u7136\u540e\u8fdb\u884c\u591a\u9879\u5f0f $\\exp$\n\n\u4e3a\u6b64\u4f1a\u5bfc\u51fa\u4e00\u4e2a\u95ee\u9898\uff1a\u6211\u4eec\u5c06 $k$ \u5bf9 $p$\uff08\u6a21\u6570\uff09\u8fdb\u884c\u4e86\u53d6\u6a21\uff0c\u4f3c\u4e4e\u65e0\u8bba $k$ \u591a\u5927\u8fd9\u90fd\u662f\u6b63\u786e\u7684\u3002\n\n-----\n\n\u4ee5\u4e0b\u5185\u5bb9\u8282\u9009\u81ea EI \u9e3d\u9e3d\u7684\u96c6\u8bad\u961f\u8bba\u6587\uff1a\n\n\u4e0b\u9762\u8bf4\u660e\u4e00\u4e2a\u66f4\u4e00\u822c\u7684\u60c5\u51b5\uff1a\n\n\u8bbe $f(x)$ \u4e3a\u4e00\u4e2a $n$ \u6b21\u591a\u9879\u5f0f\uff0c$p$ \u4e3a\u8d28\u6570\u3002\n\n$$f(x)^p\\equiv f(x^p)\\pmod p$$\n\n\u5f53\u6211\u4eec\u8ba1\u7b97 $f(x)^p\\bmod x^n$ \u65f6\uff0c\u7531\u4e8e\u4e00\u822c\u60c5\u51b5\u4e0b $n<p$\uff0c\u6240\u4ee5 $f(x)^p\\equiv a_0=1(\\text{\u672c\u9898})$\uff0c\u6545\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06 $k$ \u5bf9 $p$ \u53d6\u6a21\u3002\n\n\u8bc1\u660e\u7684\u8bdd\u53ef\u4ee5\u8003\u8651\u5230 $(a+b)^p\\equiv a^p+b^p\\pmod p$\n\n\u4f7f\u7528\u5f52\u7eb3\u8bc1\u660e\uff1a\n\n\u8bbe $f(x)$ \u4e3a $k$ \u9636\u591a\u9879\u5f0f\uff0c$a_k$ \u4e3a\u5176\u7b2c $k$ \u9879\u7cfb\u6570\uff0c\u8bbe $f(x)=g(x)+a_kx^k$\uff0c\u4e14\u4e0a\u8ff0\u7ed3\u8bba\u5bf9\u4e8e $k-1$ \u9636\u591a\u9879\u5f0f\u6210\u7acb\u3002\n\n\u8003\u8651\u5230\uff1a$f(x)^p=g(x)^p+a_k^px^{pk}=g(x^p)+a_kx^{pk}=f(x^p)$",
        "postTime": 1610454731,
        "uid": 95275,
        "name": "Light_Poet",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5245 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u3011"
    },
    {
        "content": "### \u9898\u610f\n\u7ed9\u5b9a$n-1$\u6b21\u591a\u9879\u5f0f$F(x)$\u4e0e\u6574\u6570$k$\uff0c\u6c42$\\bmod\\ x^n$\u610f\u4e49\u4e0b\u7684$(F(x))^k$\u3002\n\n$\\texttt{Data Range:}n\\leq 10^5,2\\leq k\\leq 10^{10^5}$\n\n### \u524d\u7f6e\u77e5\u8bc6\n\n\u591a\u9879\u5f0f\u57fa\u672c\u64cd\u4f5c\uff0c\u4e0d\u4f1a\u8bf7\u53f3\u8f6c\u6a21\u677f\u533aqwq\u3002\n\n### \u9898\u89e3\n\nupd\uff1a\u4fee\u6539\u4e86\u51e0\u5904\u9519\u8bef\u7684\u516c\u5f0f\u3002\n\n\u800c\u4e14\u8fd9\u662f\u65e9\u5e74\u9898\u89e3\uff0c\u591a\u9879\u5f0f\u677f\u5b50\u5199\u5f97\u4e0d\u77e5\u9053\u6bd4\u73b0\u5728\u6162\u591a\u5c11\u500d\uff0c\u677f\u5b50\u5feb\u7684\u53ef\u4ee5\u5ffd\u7565\u540e\u9762\u7684\u5bf9\u677f\u5b50\u8fdb\u884c\u5361\u5e38\u5185\u5bb9\u3002\n\n\u9996\u5148\u5927\u529b\u63a8\u4e00\u6ce2\u5f0f\u5b50\n\n$$G(x)\\equiv(F(x))^k\\pmod{x^n}$$\n\n\u53d6\u4e0b\u5bf9\u6570\n\n$$\\ln G(x)\\equiv k\\ln F(x)\\pmod{x^n}$$\n\n\u518d\u53d6\u4e00\u4e0b\u6307\u6570\n\n$$G(x)\\equiv e^{k\\ln F(x)}\\pmod {x^n}$$\n\n\u5f88\u660e\u663e\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f$O(n\\log n)$\uff0c\u4f46\u662f\u5982\u679c\u50cf\u6211\u4e00\u6837\u5199\u4ee3\u7801\u4f1a$\\color{#2e468c}\\texttt{TLE 8-20}$\uff0c\u4e8e\u662f\u6765~~\u8df5\u884cOI\u754c\u7684\u4f18\u826f\u4f20\u7edf~~\u5361\u5e38\u6570\u3002\n\n**\u524d\u65b9\u5927\u56fe\u8b66\u544a**\n\n![](https://cdn.luogu.com.cn/upload/pic/54414.png)\n![](https://cdn.luogu.com.cn/upload/pic/54412.png)\n![](https://cdn.luogu.com.cn/upload/pic/54411.png)\n![](https://cdn.luogu.com.cn/upload/pic/54410.png)\n![](https://cdn.luogu.com.cn/upload/pic/54409.png)\n\n\u4e2d\u95f4\u6709$\\texttt{selftest}$\u7684\u662f\u6211\u7684\u81ea\u6d4b\uff0c\u6570\u636e\u6bd4\u8fd9\u4e00\u9898\u5f3a\u3002\n\n\u9996\u5148\u770b\u4e00\u4efd\u6bd4\u8f83$\\texttt{naive}$\u7684\u4ee3\u7801\uff08\u53ea\u6709$\\color{#e67e22}\\texttt{35 pts}$\uff0c\u5438\u6c27\u540e\u5728$\\texttt{selftest}$\u4e0a\u8dd1\u8fd8\u53ea\u6709$\\texttt{45070ms}$\uff09\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef int ll;\ntypedef long long int li;\nconst ll MAXN=3e5+51,MOD=998244353,G=3,INVG=332748118;\nll fd,exponent;\nll f[MAXN],res[MAXN],tmp[MAXN],pinv[MAXN],der[MAXN],texp[MAXN],texp2[MAXN];\nll g[MAXN],rev[MAXN],root[MAXN],invl[MAXN];\ninline ll read()\n{\n    register ll num=0,neg=1;\n    register char ch=getchar();\n    while(!isdigit(ch)&&ch!='-')\n    {\n        ch=getchar();\n    }\n    if(ch=='-')\n    {\n        neg=-1;\n        ch=getchar();\n    }\n    while(isdigit(ch))\n    {\n        num=(num<<3)+(num<<1)+(ch-'0');\n        ch=getchar();\n    }\n    return num*neg;\n}\ninline ll readm(ll mod)\n{\n    register li num=0,neg=1;\n    register char ch=getchar();\n    while(!isdigit(ch)&&ch!='-')\n    {\n        ch=getchar();\n    }\n    if(ch=='-')\n    {\n        neg=-1;\n        ch=getchar();\n    }\n    while(isdigit(ch))\n    {\n        num=(((num<<3)+(num<<1))%MOD+(ch-'0'))%MOD;\n        ch=getchar();\n    }\n    return num*neg;\n}                                   \ninline ll qadd(ll x,ll y,ll mod)\n{\n    return x+y>mod?x+y-mod:x+y;\n}\ninline ll qmin(ll x,ll y,ll mod)\n{\n    return x-y<0?x-y+mod:x-y;\n}\ninline ll qpow(ll base,ll exponent,ll mod)\n{\n    li res=1;\n    while(exponent)\n    {\n        if(exponent&1)\n        {\n            res=(li)res*base%mod;\n        }\n        base=(li)base*base%mod,exponent>>=1;\n    }\n    return res;\n}\ninline void NTT(ll *cp,ll cnt,ll inv,ll mod)\n{\n    ll cur=0,res=0,omg=0;\n    for(register int i=0;i<cnt;++i)\n    {\n        if(i<rev[i])\n        {\n            swap(cp[i],cp[rev[i]]);\n        }\n    }\n    for(register int i=2;i<=cnt;i<<=1)\n    {\n        cur=i>>1,res=qpow(inv==1?G:INVG,(mod-1)/i,mod);\n        for(register ll *p=cp;p!=cp+cnt;p+=i)\n        {\n            omg=1;\n            for(register int j=0;j<cur;++j)\n            {\n                ll t=(li)omg*p[j+cur]%mod;\n                p[j+cur]=qmin(p[j],t,mod),p[j]=qadd(p[j],t,mod);\n                omg=(li)omg*res%mod;\n            }\n        }\n    }\n    if(inv==-1)\n    {\n        ll invl=qpow(cnt,mod-2,mod);\n        for(register int i=0;i<=cnt;++i)\n        {\n            cp[i]=(li)cp[i]*invl%mod;\n        }\n    }\n}\ninline void deriv(ll fd,ll *f,ll *res,ll mod)\n{\n    for(register int i=1;i<fd;++i)\n    {\n        res[i-1]=(li)f[i]*i%mod;\n    }\n    res[fd-1]=0;\n}\ninline void integ(ll fd,ll *f,ll *res,ll mod)\n{\n    for(register int i=1;i<fd;++i)\n    {\n        res[i]=(li)f[i-1]*qpow(i,mod-2,mod)%mod;\n    }\n    res[0]=0;\n}\ninline void inv(ll fd,ll *f,ll *res,ll mod)\n{\n    if(fd==1)\n    {\n        res[0]=qpow(f[0],mod-2,mod);\n        return;\n    }\n    inv((fd+1)>>1,f,res,mod);\n    ll cnt=1,limit=-1;\n    while(cnt<(fd<<1))\n    {\n        cnt<<=1,limit++;\n    }\n    for(register int i=0;i<cnt;++i)\n    {\n        tmp[i]=i<fd?f[i]:0;\n        rev[i]=(rev[i>>1]>>1)|((i&1)<<limit);\n    }\n    NTT(tmp,cnt,1,mod),NTT(res,cnt,1,mod);\n    for(register int i=0;i<cnt;++i)\n    {\n        res[i]=(li)qmin(2,(li)tmp[i]*res[i]%mod,mod)*res[i]%mod;\n    }\n    NTT(res,cnt,-1,mod);\n    for(register int i=fd;i<cnt;++i)\n    {\n        res[i]=0;\n    }\n}\ninline void ln(ll fd,ll *f,ll *res,ll mod)\n{\n    ll cnt=1,limit=-1;\n    while(cnt<(fd<<1))\n    {\n        cnt<<=1,limit++;\n    }\n    inv(fd,f,pinv,mod),deriv(fd,f,der,mod);\n    for(register int i=0;i<cnt;++i)\n    {\n        rev[i]=(rev[i>>1]>>1)|((i&1)<<limit);\n    }\n    NTT(pinv,cnt,1,mod),NTT(der,cnt,1,mod);\n    for(register int i=0;i<cnt;++i)\n    {\n        der[i]=(li)der[i]*pinv[i]%mod;\n    }\n    NTT(der,cnt,-1,mod),integ(fd,der,res,mod);\n    for(register int i=0;i<cnt;++i)\n    {\n        der[i]=pinv[i]=0;\n    }\n}\ninline void exp(ll fd,ll *f,ll *res,ll mod)\n{\n    if(fd==1)\n    {\n        res[0]=1;\n        return;\n    }\n    ll cnt=1,limit=-1;\n    while(cnt<(fd<<1))\n    {\n        cnt<<=1,limit++;\n    }\n    exp((fd+1)>>1,f,res,mod),ln(fd,res,texp,mod);\n    for(register int i=0;i<cnt;++i)\n    {\n \t\trev[i]=(rev[i>>1]>>1)|((i&1)<<limit);\n    }\n    texp[0]=qmin(f[0]+1,texp[0],mod);\n    for(register int i=1;i<fd;++i)\n    {\n        texp[i]=qmin(f[i],texp[i],mod);\n    }\n    NTT(texp,cnt,1,mod),NTT(res,cnt,1,mod);\n    for(register int i=0;i<cnt;++i)\n    {\n        res[i]=(li)res[i]*texp[i]%mod;\n    }\n    NTT(res,cnt,-1,mod);\n    for(register int i=0;i<cnt;++i)\n    {\n        texp[i]=0,res[i]=i<fd?res[i]:0;\n    }\n}\nint main()\n{\n    fd=read(),exponent=readm(MOD);\n    for(register int i=0;i<fd;++i)\n    {\n        f[i]=read();\n    }\n    ln(fd,f,g,MOD);\n    for(register int i=0;i<fd;++i)\n    {\n        g[i]=(li)g[i]*exponent%MOD;\n    }\n    exp(fd,g,res,MOD);\n    for(register int i=0;i<fd;++i)\n    {\n        printf(\"%d \",res[i]);\n    }\n}\n```\n\u9996\u5148\u8003\u8651\u628a\u4e00\u4e9b\u8c03\u7528\u6b21\u6570\u591a\u800c\u77ed\u7684\u51fd\u6570\u7ed9\u641e\u6389\u3002\n\n\n\u4e00\u773c\u770b\u8fc7\u53bb\uff0c\u8c03\u7528\u6b21\u6570\u6700\u591a\u7684\u662f$\\texttt{qadd}$\u548c$\\texttt{qmin}$\uff0c\u4e8e\u662f\u8003\u8651\u5427\u8fd9\u4e24\u4e2a\u51fd\u6570\u641e\u6389\uff0c\u628a\u4e00\u4e9b\u526f\u672c\u653e\u5230\u51fd\u6570\u91cc\u9762\u5f00$\\texttt{static}$\uff0c\u4e8e\u662f\u5c31\u4f18\u5316\u5230\u4e86$\\texttt{31078ms}$\u3002\n\n\u63a5\u4e0b\u6765\uff0c\u5c31\u53ef\u4ee5\u8003\u8651\u538b\u7f29$\\texttt{deriv}$\u548c$\\texttt{integ}$\u4e86\uff0c\u5c3d\u7ba1\u4ee3\u7801\u91cc\u53ea\u6709\u8c03\u7528\u4e00\u6b21\uff0c\u4f46\u662f$\\texttt{exp}$\u4e2d\u4f1a\u8c03\u7528$\\log n$\u6b21\uff0c\u6240\u4ee5\u679c\u65ad\u641e\u6389\uff0c\u73b0\u5728\u65f6\u95f4\u662f$\\texttt{28972ms}$\u3002\n\n\u63a5\u7740\u8003\u8651\u5220\u6389\u4e00\u4e9b\u4e0d\u5fc5\u8981\u7684\u53c2\u6570\uff0c\u56e0\u4e3a\u4f20$\\texttt{int}$\u662f$O(32)$\u7684\u3002\u4e8e\u662f\u53ef\u4ee5\u8003\u8651\u5220\u6389$\\texttt{mod}$\uff0c\u56e0\u4e3a\u8fd9\u9898\u53ea\u6709\u4e00\u4e2a\u6a21\u6570\uff0c\u7528\u4e0d\u7740\u52a0\u8fd9\u6837\u4e00\u4e2a\u53c2\u3002\n\n\u7ecf\u8fc7\u6bd2\u7624\u5361\u5e38\u540e\uff0c\u4e00\u4e2a$\\texttt{45000+ms}$\u7684\u4ee3\u7801\u88ab\u4f18\u5316\u6210\u4e86$\\texttt{12000-ms}$\uff0c\u53ef\u4ee5\u89c1\u5f97\u5361\u5e38\u662f\u4e2a\u597d\u4e1c\u897f\u3002\n\n\u9644\u8d60[$\\texttt{selftest}$](https://www.luogu.org/problemnew/show/U65286)\n\n### \u4ee3\u7801\n```\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef int ll;\ntypedef long long int li;\nconst ll MAXN=3e5+51,MOD=998244353,G=3,INVG=332748118;\nll fd,exponent;\nll f[MAXN],res[MAXN],g[MAXN],rev[MAXN];\ninline ll read()\n{\n    register ll num=0,neg=1;\n    register char ch=getchar();\n    while(!isdigit(ch)&&ch!='-')\n    {\n        ch=getchar();\n    }\n    if(ch=='-')\n    {\n        neg=-1;\n        ch=getchar();\n    }\n    while(isdigit(ch))\n    {\n        num=(num<<3)+(num<<1)+(ch-'0');\n        ch=getchar();\n    }\n    return num*neg;\n}\ninline ll readm()\n{\n    register li num=0,neg=1;\n    register char ch=getchar();\n    while(!isdigit(ch)&&ch!='-')\n    {\n        ch=getchar();\n    }\n    if(ch=='-')\n    {\n        neg=-1;\n        ch=getchar();\n    }\n    while(isdigit(ch))\n    {\n        num=((num<<3)+(num<<1)+(ch-'0'))%MOD;\n        ch=getchar();\n    }\n    return num*neg;\n}                                   \ninline ll qpow(ll base,ll exponent)\n{\n    li res=1;\n    while(exponent)\n    {\n        if(exponent&1)\n        {\n            res=(li)res*base%MOD;\n        }\n        base=(li)base*base%MOD,exponent>>=1;\n    }\n    return res;\n}\ninline void NTT(ll *cp,ll cnt,ll inv)\n{\n    ll cur=0,res=0,omg=0;\n    for(register int i=0;i<cnt;++i)\n    {\n        if(i<rev[i])\n        {\n            swap(cp[i],cp[rev[i]]);\n        }\n    }\n    for(register int i=2;i<=cnt;i<<=1)\n    {\n        cur=i>>1,res=qpow(inv==1?G:INVG,(MOD-1)/i);\n        for(register ll *p=cp;p!=cp+cnt;p+=i)\n        {\n            omg=1;\n            for(register int j=0;j<cur;++j)\n            {\n                ll t=(li)omg*p[j+cur]%MOD,t2=p[j];\n                p[j+cur]=(t2-t+MOD)%MOD,p[j]=(t2+t)%MOD;\n                omg=(li)omg*res%MOD;\n            }\n        }\n    }\n    if(inv==-1)\n    {\n        ll invl=qpow(cnt,MOD-2);\n        for(register int i=0;i<=cnt;++i)\n        {\n            cp[i]=(li)cp[i]*invl%MOD;\n        }\n    }\n}\ninline void inv(ll fd,ll *f,ll *res)\n{\n    static ll tmp[MAXN];\n    if(fd==1)\n    {\n        res[0]=qpow(f[0],MOD-2);\n        return;\n    }\n    inv((fd+1)>>1,f,res);\n    ll cnt=1,limit=-1;\n    while(cnt<(fd<<1))\n    {\n        cnt<<=1,limit++;\n    }\n    for(register int i=0;i<cnt;++i)\n    {\n        tmp[i]=i<fd?f[i]:0;\n        rev[i]=(rev[i>>1]>>1)|((i&1)<<limit);\n    }\n    NTT(tmp,cnt,1),NTT(res,cnt,1);\n    for(register int i=0;i<cnt;++i)\n    {\n        res[i]=(li)(2-(li)tmp[i]*res[i]%MOD+MOD)%MOD*res[i]%MOD;\n    }\n    NTT(res,cnt,-1);\n    for(register int i=fd;i<cnt;++i)\n    {\n        res[i]=0;\n    }\n}\ninline void ln(ll fd,ll *f,ll *res)\n{\n    static ll pinv[MAXN],der[MAXN];\n    ll cnt=1,limit=-1;\n    while(cnt<(fd<<1))\n    {\n        cnt<<=1,limit++;\n    }\n    inv(fd,f,pinv);\n    for(register int i=1;i<fd;++i)\n    {\n        der[i-1]=(li)f[i]*i%MOD;\n    }\n    der[fd-1]=0;\n    for(register int i=0;i<cnt;++i)\n    {\n        rev[i]=(rev[i>>1]>>1)|((i&1)<<limit);\n    }\n    NTT(pinv,cnt,1),NTT(der,cnt,1);\n    for(register int i=0;i<cnt;++i)\n    {\n        der[i]=(li)der[i]*pinv[i]%MOD;\n    }\n    NTT(der,cnt,-1);\n    for(register int i=1;i<fd;++i)\n    {\n        res[i]=(li)der[i-1]*qpow(i,MOD-2)%MOD;\n    }\n    res[0]=0;\n    for(register int i=0;i<cnt;++i)\n    {\n        der[i]=pinv[i]=0;\n    }\n}\ninline void exp(ll fd,ll *f,ll *res)\n{\n    static ll texp[MAXN];\n    if(fd==1)\n    {\n        res[0]=1;\n        return;\n    }\n    ll cnt=1,limit=-1;\n    while(cnt<(fd<<1))\n    {\n        cnt<<=1,limit++;\n    }\n    exp((fd+1)>>1,f,res),ln(fd,res,texp);\n    for(register int i=0;i<cnt;++i)\n    {\n \t\trev[i]=(rev[i>>1]>>1)|((i&1)<<limit);\n    }\n    texp[0]=(f[0]+1-texp[0]+MOD)%MOD;\n    for(register int i=1;i<fd;++i)\n    {\n        texp[i]=(f[i]-texp[i]+MOD)%MOD;\n    }\n    NTT(texp,cnt,1),NTT(res,cnt,1);\n    for(register int i=0;i<cnt;++i)\n    {\n        res[i]=(li)res[i]*texp[i]%MOD;\n    }\n    NTT(res,cnt,-1);\n    for(register int i=0;i<cnt;++i)\n    {\n        texp[i]=0,res[i]=i<fd?res[i]:0;\n    }\n}\nint main()\n{\n    fd=read(),exponent=readm();\n    for(register int i=0;i<fd;++i)\n    {\n        f[i]=read();\n    }\n    ln(fd,f,g);\n    for(register int i=0;i<fd;++i)\n    {\n        g[i]=(li)g[i]*exponent%MOD;\n    }\n    exp(fd,g,res);\n    for(register int i=0;i<fd;++i)\n    {\n        printf(\"%d \",res[i]);\n    }\n}\n```\n\n",
        "postTime": 1552915851,
        "uid": 60990,
        "name": "Karry5307",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5245 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u3011"
    },
    {
        "content": "### \u7b97\u6cd5\u4e00\uff1a\n\n\u7531\u4e8e$a^b=e^{b\\ln a}$\uff0c\u6240\u4ee5\u53ef\u4ee5\u5148\u6c42$k\\ln A(x)$\uff0c\u7136\u540e\u518d$\\exp$\u56de\u6765\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u53d6\u6a21\u4e86\u3002\n\n\u591a\u9879\u5f0f\u6c42\u9006+\u591a\u9879\u5f0f\u6307\u6570\u51fd\u6570+\u591a\u9879\u5f0f\u5bf9\u6570\u51fd\u6570\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\log n)$\u3002\n\n## Code\uff1a\n```cpp\n#include<cstdio>\n#include<cctype>\n#include<algorithm>\nconst int md=998244353,N=262145,g3=(md+1)/3;\ntypedef long long LL;\nint n,k,a[N],A[N],G[N];\ninline void upd(int&a){a+=a>>31&md;}\ninline int pow(int a,int b){\n\tint r=1;\n\tfor(;b;b>>=1,a=(LL)a*a%md)if(b&1)r=(LL)r*a%md;return r;\n}\nnamespace poly{\n\tint lim,rev[N],inv[N];\n\tinline int poly_start(){\n\t\tinv[1]=1;\n\t\tfor(int i=2;i<N;++i)inv[i]=(md-md/i)*(LL)inv[md%i]%md;\n\t\treturn 1;\n\t}\n\tint __START__=poly_start();\n\tinline void init(int n){\n\t\tint l=-1;\n\t\tfor(lim=1;lim<n;lim<<=1)++l;\n\t\tfor(int i=1;i<lim;++i)rev[i]=(rev[i>>1]>>1)|((i&1)<<l);\n\t}\n\tvoid NTT(int*a,int f){\n\t\tfor(int i=1;i<lim;++i)if(i<rev[i])std::swap(a[i],a[rev[i]]);\n\t\tfor(int i=1;i<lim;i<<=1){\n\t\t\tconst int gi=pow(f?3:g3,(md-1)/(i<<1));\n\t\t\tfor(int j=0;j<lim;j+=i<<1)\n\t\t\tfor(int k=0,g=1;k<i;++k,g=(LL)g*gi%md){\n\t\t\t\tconst int x=a[j+k],y=a[j+k+i]*(LL)g%md;\n\t\t\t\tupd(a[j+k]+=y-md),upd(a[j+k+i]=x-y);\n\t\t\t}\n\t\t}\n\t\tif(!f){\n\t\t\tconst LL iv=inv[lim];\n\t\t\tfor(int i=0;i<lim;++i)a[i]=a[i]*iv%md;\n\t\t}\n\t}\n\tvoid INV(const int*a,int*B,int n){\n\t\tif(n==1)*B=pow(*a,md-2);else{\n\t\t\tINV(a,B,n+1>>1);\n\t\t\tinit(n<<1);\n\t\t\tstatic int A[N];\n\t\t\tfor(int i=0;i<n;++i)A[i]=a[i];\n\t\t\tfor(int i=n;i<lim;++i)A[i]=0;\n\t\t\tNTT(A,1),NTT(B,1);\n\t\t\tfor(int i=0;i<lim;++i)B[i]=B[i]*((2-(LL)A[i]*B[i]%md+md)%md)%md;\n\t\t\tNTT(B,0);\n\t\t\tfor(int i=n;i<lim;++i)B[i]=0;\n\t\t}\n\t}\n\tvoid dao(const int*a,int*G,int n){\n\t\tG[n-1]=0;\n\t\tfor(int i=1;i<n;++i)\n\t\tG[i-1]=(LL)i*a[i]%md;\n\t}\n\tvoid INT(const int*a,int*G,int n){\n\t\t*G=0;\n\t\tfor(int i=n-1;~i;--i)G[i+1]=a[i]*(LL)inv[i+1]%md;\n\t}\n\tvoid LN(const int*a,int*B,int n){\n\t\tstatic int F[N];\n\t\tdao(a,F,n),INV(a,B,n);\n\t\tinit(n<<1);\n\t\tfor(int i=n;i<lim;++i)B[i]=F[i]=0;\n\t\tNTT(F,1),NTT(B,1);\n\t\tfor(int i=0;i<lim;++i)F[i]=(LL)B[i]*F[i]%md;\n\t\tNTT(F,0);\n\t\tINT(F,B,n);\n\t\tfor(int i=n;i<lim;++i)B[i]=0;\n\t}\n\tvoid EXP(const int*a,int*F,int n){\n\t\tif(n==1)*F=1;else{\n\t\t\tEXP(a,F,n+1>>1);\n\t\t\tstatic int F0[N],A[N];\n\t\t\tfor(int i=0;i<=n<<1;++i)F0[i]=0,A[i]=a[i];\n\t\t\tLN(F,F0,n);\n\t\t\tinit(n<<1);\n\t\t\tfor(int i=n;i<lim;++i)A[i]=0;\n\t\t\tNTT(A,1),NTT(F0,1),NTT(F,1);\n\t\t\tfor(int i=0;i<lim;++i)F[i]=F[i]*(A[i]+1LL-F0[i]+md)%md;\n\t\t\tNTT(F,0);\n\t\t\tfor(int i=n;i<lim;++i)F[i]=0;\n\t\t}\n\t}\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tint c=getchar();while(isspace(c))c=getchar();\n\tfor(;isdigit(c);c=getchar())k=(k*10LL+(c^'0'))%md;\n\tfor(int i=0;i<n;++i)scanf(\"%d\",a+i);\n\tpoly::LN(a,A,n);\n\tfor(int i=0;i<n;++i)A[i]=A[i]*(LL)k%md;\n\tfor(int i=0;i<n;++i)a[i]=0;\n\tpoly::EXP(A,a,n);\n\tfor(int i=0;i<n;++i)printf(\"%d \",a[i]);\n\treturn 0;\n}\n```\n\n### \u7b97\u6cd5\u4e8c\uff1a\n\n\u53d1\u73b0$e^{k\\ln A(x)}\\equiv e^{(k\\bmod{998244353})\\ln A(x)}\\equiv A(x)^{k\\bmod{998244353}}\\pmod{x^n}$\uff0c\u6240\u4ee5\u5148\u5bf9$k$\u53d6\u6a21\uff0c\u7136\u540e\u76f4\u63a5\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\log n\\log(k\\bmod{998244353}))$\u3002\n\n## Code\uff1a\n```cpp\n#include<cstdio>\n#include<cctype>\n#include<algorithm>\nconst int md=998244353,N=262145,g3=(md+1)/3;\ntypedef long long LL;\nint n,k,a[N],A[N];\ninline void upd(int&a){a+=a>>31&md;}\ninline int pow(int a,int b){\n\tint r=1;\n\tfor(;b;b>>=1,a=(LL)a*a%md)if(b&1)r=(LL)r*a%md;return r;\n}\nint lim,rev[N];\ninline void init(int n){\n\tint l=-1;\n\tfor(lim=1;lim<n;lim<<=1)++l;\n\tfor(int i=1;i<lim;++i)rev[i]=(rev[i>>1]>>1)|((i&1)<<l);\n}\nvoid NTT(int*a,int f){\n\tfor(int i=1;i<lim;++i)if(i<rev[i])std::swap(a[i],a[rev[i]]);\n\tfor(int i=1;i<lim;i<<=1){\n\t\tconst int gi=pow(f?3:g3,(md-1)/(i<<1));\n\t\tfor(int j=0;j<lim;j+=i<<1)\n\t\tfor(int k=0,g=1;k<i;++k,g=(LL)g*gi%md){\n\t\t\tconst int x=a[j+k],y=a[j+k+i]*(LL)g%md;\n\t\t\tupd(a[j+k]+=y-md),upd(a[j+k+i]=x-y);\n\t\t}\n\t}\n\tif(!f){\n\t\tconst LL iv=pow(lim,md-2);\n\t\tfor(int i=0;i<lim;++i)a[i]=a[i]*iv%md;\n\t}\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tint c=getchar();while(isspace(c))c=getchar();\n\tfor(;isdigit(c);c=getchar())k=(k*10LL+(c^'0'))%md;\n\tfor(int i=0;i<n;++i)scanf(\"%d\",a+i);\n\t*A=1;\n\tinit(n<<1);\n\tNTT(A,1),NTT(a,1);\n\tfor(;k;k>>=1){\n\t\tif(k&1){\n\t\t\tfor(int i=0;i<lim;++i)A[i]=(LL)A[i]*a[i]%md;\n\t\t\tNTT(A,0);\n\t\t\tfor(int i=n;i<lim;++i)A[i]=0;\n\t\t\tNTT(A,1);\n\t\t}\n\t\tfor(int i=0;i<lim;++i)a[i]=(LL)a[i]*a[i]%md;\n\t\tNTT(a,0);\n\t\tfor(int i=n;i<lim;++i)a[i]=0;\n\t\tNTT(a,1);\n\t}\n\tNTT(A,0);\n\tfor(int i=0;i<n;++i)printf(\"%d \",A[i]);\n\treturn 0;\n}\n```",
        "postTime": 1551847268,
        "uid": 6813,
        "name": "mrsrz",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5245 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u3011"
    },
    {
        "content": "## \u524d\u8a00:\n\n\u6211\u8981\u5f3a\u70c8\u8c34\u8d23\u4e00\u4e9b\u6ca1\u6709\u8bb2\u6e05\u695a\u4e3a\u4ec0\u4e48\u6700\u540e\u5316\u7b80\u51fa\u6765\u7684\u7cfb\u6570 $k$ \u53ef\u4ee5\u53d6\u6a21\u7684\u9898\u89e3\uff0c\n\n\u8fd9\u662f\u5341\u5206\u4e0d\u8d1f\u8d23\u4efb\u7684\u884c\u4e3a\uff0c\u8fd9\u4e9b\u591a\u9879\u5f0f\u9898\u76ee\u4e0d\u4ec5\u4ec5\u662f\u80cc\u4e2a\u677f\u5b50\uff0c\u8d70\u9a6c\u89c2\u82b1\u5730\u770b\u4e00\n\n\u4e9b\uff0c\u4e86\u89e3\u6a21\u677f\u7684\u63a8\u5bfc\u8fc7\u7a0b\u624d\u662f\u5b66\u4e60\u591a\u9879\u5f0f\u7684\u76ee\u7684\uff0c\u9898\u76ee\u610f\u601d\u5c31\u4e0d\u8bb2\u4e86\uff0c\u5df2\u7ecf\u5f88\u6e05\u695a\n\n\u4e86\uff0c\u4e0b\u9762\u8bb2\u89e3\u6cd5\u3002\n\n## \u524d\u7f6e\u77e5\u8bc6\uff1a\n\n\u591a\u9879\u5f0f $ln$ \uff0c\u591a\u9879\u5f0f $exp$ \uff0c\u591a\u9879\u5f0f\u4e58\u6cd5\u9006\u3002\n\n## Solution:\n\n\u9996\u5148\u77e5\u9053: $B(x)\u2261A^k(x)$  $(mod$ $x^n)$  \n\n\u8003\u8651\u600e\u4e48\u6d88\u53bb\u6b21\u6570 $k$ \uff0c\u60f3\u5230\u5bf9\u6570\u516c\u5f0f\u3002\n\n\u4e8e\u662f\u6709: $ln$ $B(x)\u2261 $ $ln$ $A^k(x)$  $(mod$ $x^n)$ \n\n\u4e5f\u5373: $ln$ $B(x)\u2261 $ $k\u00d7ln$ $A(x)$  $(mod$ $x^n)$\n\n\u4e8e\u662f\uff0c\u5148\u5bf9\u591a\u9879\u5f0f $A(x)$ \u6c42\u51fa\u5b83\u7684 $ln$ \uff0c\u4e58\u4ee5 $k$ \uff0c\u5c31\u6c42\u51fa\u4e86 $ln$ $B(x)$ \n\n\u503c\uff0c\u5bf9 $ln$ $B(x)$ \u505a\u4e00\u904d\u591a\u9879\u5f0f $exp$ \u5c31\u662f $B(x)$ \u4e86\u3002\n\n\u4f46\u662f\u6b21\u6570 $k$ \u771f\u7684\u5f88\u5927\uff0c\u9700\u8981\u4e00\u8fb9\u8bfb\u5165\u4e00\u8fb9\u53d6\u6a21\uff0c\u4e0b\u8bc1\u53d6\u6a21\u4ecd\u7136\u4f7f\u5f97\u7b54\u6848\u6b63\u786e\u3002\n\n\u7531\u6cf0\u52d2\u5c55\u5f00\u53ef\u5f97\uff0c $e^x=\\sum{\\frac{x^i}{i!}}$ \u3002\n\n\u628a\u4e0a\u5f0f\u7684 $x$ \u7528 ${k\u00d7lnB(x)}$ \u66ff\u6362\u3002\n\n\u4e8e\u662f\u6c42\u548c\u5f0f\u5b50\u7684\u5206\u6bcd\u5904\u5c31\u662f $k^i\u00d7ln^iB(x)$ \u3002\n\n\u663e\u7136\u53d6\u6a21\u540e\u4e0d\u53d8\u3002\n\n\u4e0b\u9762\u662f\u4ee3\u7801\uff0c\u6709\u70b9\u957f\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define N 400050\n#define p 998244353\n#define ll long long\nusing namespace std;\nchar ch[N];\nll n,k;\nll a[N],b[N];\nll bit,pre[N],len;\nll g1=3,g2=332748118,c[N],tmp[N],lx[N],inv_num[N],Z[N],ans[N];\nll ksm(ll a,ll b)\n{\n\tll s=1;\n\twhile(b)\n\t{\n\t\tif(b&1) s=(s*a)%p;\n\t\ta=(a*a)%p;\n\t\tb=b>>1;\n\t}\n\treturn s;\n} \nvoid NTT(ll* a,ll len,ll pd)\n{\n    for(register ll i=0;i<len;i++) \n\t{\n        if(i<pre[i]) swap(a[i],a[pre[i]]);\n    }\n    for (register ll mid=1;mid<=len-1;mid=(mid<<1)) \n\t{\n        ll gn;\n\t\tif(pd==1) gn=ksm(g1,(p-1)/(mid<<1));\n        if(pd==-1) gn=ksm(g2,(p-1)/(mid<<1));\t\n        for(register ll i=0;i<=len-1;i+=(mid<<1)) \n\t\t{\n            ll g=1,x,y;\n            for(register ll j=0;j<=mid-1;j++,g=(g*gn)%p) \n\t\t\t{    \n\t\t\t\tx=a[i+j];\n\t\t\t\ty=g*a[i+j+mid]%p; \n                a[i+j]=(x+y)%p;\n                a[i+j+mid]=(x-y+p)%p; \n            }\n        }\n    }\t \n    if(pd==-1)\n    {\n        ll inv=ksm(len,p-2);\n        for(ll i=0;i<len;i++)\n        {\n        \ta[i]=(a[i]*inv)%p;\n\t\t}\n\t}\n}\nvoid inv(ll L,ll* a,ll* b)\n{\n\tif(L==1)\n\t{\n\t\tb[0]=ksm(a[0],p-2);\n\t\treturn;\n\t}\n\tinv((L+1)>>1,a,b);\n    bit=0;\t\n\twhile((1<<bit)<(L<<1)) \n\t{\n        bit++;\n    }\n    len=(1<<bit);\n\tfor(register ll i=0;i<len;i++) \n\t{\n        pre[i]=((pre[i>>1]>>1)|((i&1)<<(bit-1)));\n    }\n    for(register ll i=0;i<=L-1;i++) c[i]=a[i];\n\tfor(register ll i=L;i<len;i++) c[i]=0;\n\tNTT(b,len,1);\n\tNTT(c,len,1);\n\tfor(register ll i=0;i<len;i++)\n\t{\n\t\tb[i]=(2-c[i]*b[i]%p+p)*b[i]%p;\t\n\t}\n\tNTT(b,len,-1);\n\tfor(register ll i=L;i<len;i++) b[i]=0;\n}\nvoid Add(ll L,ll *a,ll *b)\n{\n\tbit=0;\n\twhile((1<<bit)<(L<<1)) \n\t{\n        bit++;\n    }\n    len=(1<<bit);\n\tfor(register ll i=0;i<len;i++) \n\t{\n        pre[i]=((pre[i>>1]>>1)|((i&1)<<(bit-1)));\n    }\n\tNTT(a,len,1);\n\tNTT(b,len,1);\n\tfor(register ll i=0;i<len;i++) \n\t{\n\t    b[i]=(a[i]*b[i])%p;\t\n\t}\n\tNTT(b,len,-1);\n}\nvoid D(ll *a,ll *b,ll L)\n{\n\tfor(register ll i=1;i<=L-1;i++)\n\t{\n\t\tb[i-1]=i*a[i]%p;\n\t}\t\n\tb[L-1]=0;\n}\nvoid I(ll* a,ll* b,ll L)\n{\n\tfor(register ll i=1;i<=L-1;i++)\n\t{\n\t    b[i]=a[i-1]*inv_num[i]%p;\t\n\t}\t\n\tb[0]=0;\n}\nvoid ln(ll L,ll* a,ll* b)\n{\n\tfor(ll i=0;i<(L<<2);i++)\n\t{\n\t\tb[i]=0;\n\t}\n\tinv(L,a,b);\n\tlen=1; \n\tbit=0;\n\twhile(len<(L<<1))\n\t{\n\t    bit++;\n\t    len=(len<<1);\n\t}\n\tfor(ll i=0;i<=len-1;i++)\n\t{\n\t\tpre[i]=(pre[i>>1]>>1)|((i&1)<<(bit-1));\n\t}\n\tfor(ll i=0;i<L-1;i++) \n\t{\n\t\tZ[i]=a[i+1]*(i+1)%p;\n\t}\n\tfor(ll i=L-1;i<=len-1;i++) \n\t{\n\t\tZ[i]=0;\n\t}\n\tNTT(Z,len,1);\n\tNTT(b,len,1);\n\tfor(ll i=0;i<=len-1;i++)\n\t{\n\t\tb[i]=b[i]*Z[i]%p;\n\t}\t  \n\tNTT(b,len,-1);\n\tfor(ll i=L-1;i>0;i--)\n\t{\n\t\tb[i]=b[i-1]*inv_num[i]%p;\n\t}  \n\tfor(ll i=L;i<len;i++) \n\t{\n\t\tb[i]=0;\n\t}\n\tb[0]=0;\n}\nvoid exp(ll* a,ll* b,ll L)\n{\n\tif(L==1)\n\t{\n\t\tb[0]=1;\n\t\treturn;\n\t}\n\texp(a,b,(L+1)>>1);\n\tln(L,b,lx);\n\tbit=0;\n\twhile((1<<bit)<(L<<1)) \n\t{\n        bit++;\n    }\n    len=(1<<bit);\n\tfor(register ll i=0;i<len;i++) \n\t{\n        pre[i]=((pre[i>>1]>>1)|((i&1)<<(bit-1)));\n    }\n    for(register ll i=0;i<=L-1;i++)\n\t{\n\t    lx[i]=a[i]>=lx[i]?a[i]-lx[i]:a[i]-lx[i]+p;\n\t} \n\tlx[0]++;\n\tfor(register ll i=L;i<len;i++)\n\t{\n\t\tlx[i]=0;\n\t\tb[i]=0;\n\t}\t\n\tNTT(lx,len,1);\n\tNTT(b,len,1);\n\tfor(register ll i=0;i<len;i++)\n\t{\n\t    b[i]=(b[i]*lx[i])%p; \n\t}\n\tNTT(b,len,-1);\n\tfor(register ll i=L;i<len;i++)\n\t{\n\t\tb[i]=0;\n\t}\n}\ninline ll read()\n{\n    ll x=0,f=1;char ch=getchar();\n    while (!isdigit(ch)){if (ch=='-') f=-1;ch=getchar();}\n    while (isdigit(ch)){x=(x*10+ch-48)%p;ch=getchar();}\n    return x*f;\n}\nint main()\n{\n    scanf(\"%lld\",&n);\n    k=read();\n    inv_num[1]=1;\n    for(register ll i=0;i<=n-1;i++)\n    {\n       \tscanf(\"%lld\",&a[i]);\n       \tinv_num[i+2]=p-(p/(i+2))*inv_num[p%(i+2)]%p;\n\t} \n\tln(n,a,b);\n\tfor(register ll i=0;i<=n-1;i++)\n    {\n        b[i]=b[i]*k%p;\n    }\n    exp(b,ans,n);\n\tfor(register ll i=0;i<=n-1;i++) printf(\"%lld \",ans[i]);\n    return 0;\n}\n```\n\n\n\n\n\n\n\n\n\n",
        "postTime": 1617622655,
        "uid": 213256,
        "name": "Constant",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5245 \u591a\u9879\u5f0f\u5feb\u901f\u5e42"
    },
    {
        "content": "A\u4e86\u8fd9\u9898\u4e4b\u540e\uff0c\u6765\u53d1\u7bc7\u9898\u89e3\u6765\u8b66\u793a\u540e\u4eba\u3002\u3002\u3002\n\n\u5148\u63a8\u4e00\u6ce2\u5f0f\u5b50\uff1a\n$$ F^k(x) \\equiv G(x) \\pmod {x^n} $$\n\u4e24\u8fb9\u540c\u65f6\u53d6Ln\uff1a\n$$ k \\times Ln(f(x)) \\equiv Ln(G(x)) \\pmod {x^n} $$\n\u540c\u65f6Exp\uff1a\n$$ e^{k \\times Ln(f(x))} \\equiv G(x) \\pmod {x^n} $$\n\u7136\u540e\u5c31\u6ca1\u4ec0\u4e48\u53ef\u8bf4\u7684\u4e86\u3002\u3002\u3002\n\n\u6211\u5f88\u597d\u5947\u4e3a\u4ec0\u4e48\u5f88\u591a\u4eba\u90fd\u5728\u5361\u5e38\uff0c\u6211\u5199\u7684\u4ee3\u7801\u4e0d\u5438\u6c27\u8dd1\u4e867.5s\u5de6\u53f3\u3002\n\nCode\uff1a\n```cpp\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<cctype>\n#define clr(f,len) memset(f,0,(len)<<3)\n#define cpy(f,g,len) memcpy(f,g,(len)<<3)\ntypedef long long ll;\nconst ll M=5e5+5,G=3,invG=332748118ll,mod=998244353ll;\nll n,f[M],t[M],inv[M];\nvoid swap(ll&a,ll&b){\n    a^=b^=a^=b;\n}\nll pow(ll a,ll b=mod-2){\n    ll ans=1;for(;b;b>>=1,a=a*a%mod)if(b&1)ans=ans*a%mod;\n    return ans;\n}\nvoid px(ll*f,ll*g,int len){\n    for(int i=0;i<len;++i)f[i]=f[i]*g[i]%mod;\n}\nvoid dao(ll*f,int n){\n    for(int i=1;i<n;++i)f[i-1]=f[i]*i%mod;\n    f[n-1]=0;\n}\nvoid jifen(ll*f,int n){\n    for(int i=n;i;--i)f[i]=f[i-1]*inv[i]%mod;\n    f[0]=0;\n}\nvoid NTT(ll*f,bool flag,int n){\n\tstatic int fl,t[M];\n\tint i,k,p,len;ll w,w1;\n\tif(n!=fl){\n\t\tfor(i=0;i<n;++i)t[i]=t[i>>1]>>1|(i&1?n>>1:0);\n\t\tfl=n;\n\t}\n    for(i=0;i<n;++i)if(i<t[i])swap(f[i],f[t[i]]);\n    for(p=2;p<=n;p<<=1){\n        len=p>>1;w1=pow(flag?G:invG,(mod-1)/p);\n        for(k=0;k<n;k+=p){\n            w=1;\n            for(i=k;i<k+len;++i){\n                ll t=f[i+len]*w%mod;\n                if((f[i+len]=f[i]-t)<0)f[i+len]+=mod;\n                if((f[i]=f[i]+t)>mod)f[i]-=mod;\n                w=w*w1%mod;\n            }\n        }\n    }\n    if(flag)return;\n    ll invn=pow(n);\n    for(i=0;i<n;++i)f[i]=f[i]*invn%mod;\n}\nvoid times(ll* f, ll* g, int l1, int l2) {\n    static ll sav[M];\n    int n;\n    for(n=1;n<=(l1+l2);n<<=1);\n    cpy(sav,g,l2);clr(f+l1,n-l1);clr(sav+l2,n-l2);\n    NTT(f,1,n);NTT(sav,1,n);\n    px(f,sav,n);NTT(f,0,n);\n    clr(sav,n);\n}\nvoid invp(ll*f,int m){\n    static ll b1[M],b2[M],b3[M];\n    int i,n,len;\n    for(n=1;n<m;n<<=1);b1[0]=pow(f[0]);\n    for(len=2;len<=n;len<<=1){\n        for(i=0;i<(len>>1);++i)b3[i]=(b1[i]<<1)%mod;\n        cpy(b2,f,len);\n        NTT(b1,1,len<<1);px(b1,b1,len<<1);\n        NTT(b2,1,len<<1);px(b1,b2,len<<1);\n        NTT(b1,0,len<<1);clr(b1+len,len);\n        for(i=0;i<len;++i)b1[i]=(b3[i]-b1[i]+mod)%mod;\n    }\n    cpy(f,b1,m);clr(b1,n+n);clr(b2,n+n);clr(b3,n+n);\n}\nvoid lnp(ll*f,int m){\n    static ll g[M];int n;\n    for(n=1;n<m;n<<=1);\n    cpy(g,f,m);\n    invp(g,m);dao(f,m);\n    NTT(f,1,n<<1);NTT(g,1,n<<1);\n    px(f,g,n<<1);NTT(f,0,n<<1);\n    jifen(f,m-1);\n    clr(g,n+n);\n}\nvoid exp(ll*f,int m){\n    static ll b1[M],b2[M];int n,i,len;\n    for(n=1;n<m;n<<=1);b1[0]=1;\n    for(len=2;len<=n;len<<=1){\n        cpy(b2,b1,len>>1);clr(b2+len/2,len/2);lnp(b2,len);\n        for(i=0;i<len;++i)b2[i]=(f[i]-b2[i]+mod)%mod;\n        b2[0]=(b2[0]+1)%mod;\n        times(b1,b2,len/2,len);\n    }\n    cpy(f,b1,m);clr(b1,n+n);clr(b2,n+n);\n}\nvoid powp(ll*f,ll n,ll k){\n    lnp(f,n);\n    for(int i=0;i<n;++i)f[i]=f[i]*k%mod;\n    exp(f,n);\n}\nsigned main(void){\n    char s;ll i,k=0;\n    scanf(\"%lld%s\",&n,s);//\u8fd9\u91cc\u6539\u6210%c\u5c31\u4f1aWA\uff0c\u5f88\u795e\u5947\u5427\u3002\u3002\u3002\n    inv[1]=1;\n    while(isdigit(s=getchar()))k=(k*10+(s^48))%mod;\n    for(int i=2;i<M;++i)inv[i]=(mod-mod/i)*inv[mod%i]%mod;\n    for(i=0;i<n;++i)scanf(\"%lld\",f+i);\n    powp(f,n,k);\n    for(i=0;i<n;++i)printf(\"%lld \",f[i]);\n}\n```",
        "postTime": 1590244731,
        "uid": 160839,
        "name": "Prean",
        "ccfLevel": 7,
        "title": "\u6570\u8bba \u591a\u9879\u5f0f P5235\u9898\u89e3"
    },
    {
        "content": "\u76f4\u63a5\u5957\u516c\u5f0f\u3002\n$$A^k(x)=\\exp(k\\ln A(x))$$\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\log n)$\n\n\u500d\u589e\u5feb\u901f\u5e42\uff1f\u53c8\u96be\u5199\u53c8\u6162\u3002\u3002\u3002\u8fd8\u662f\u7b97\u4e86\n```cpp\n#include<cstdio>\n#include<algorithm>\n#define Rint register int\nusing namespace std;\ntypedef long long LL;\nconst int N = 400003, mod = 998244353, G = 3, Gi = 332748118;\nint n, k, A[N];\ninline int read(){\n    int ch = getchar(), res = 0;\n    while(ch < '0' || ch > '9') ch = getchar();\n    while(ch >= '0' && ch <= '9'){\n        res = (res * 10ll + ch - '0') % mod;\n        ch = getchar();\n    }\n    return res;\n}\ninline int kasumi(int a, int b){\n    int res = 1;\n    while(b){\n        if(b & 1) res = (LL) res * a % mod;\n        a = (LL) a * a % mod;\n        b >>= 1;\n    }\n    return res;\n}\nint rev[N];\ninline void NTT(int *A, int limit, int type){\n    for(Rint i = 0;i < limit;i ++)\n        if(i < rev[i]) swap(A[i], A[rev[i]]);\n    for(Rint mid = 1;mid < limit;mid <<= 1){\n        int Wn = kasumi(type == 1 ? G : Gi, (mod - 1) / (mid << 1));\n        for(Rint j = 0;j < limit;j += mid << 1){\n            int w = 1;\n            for(Rint k = 0;k < mid;k ++, w = (LL) w * Wn % mod){\n                int x = A[j + k], y = (LL) w * A[j + k + mid] % mod;\n                A[j + k] = (x + y) % mod;\n                A[j + k + mid] = (x - y + mod) % mod; \n            }\n        }\n    }\n    if(type == -1){\n        int inv = kasumi(limit, mod - 2);\n        for(Rint i = 0;i < limit;i ++) A[i] = (LL) A[i] * inv % mod;\n    }\n}\nint ans[N];\ninline void poly_inv(int *A, int deg){\n    static int tmp[N];\n    if(deg == 1){\n        ans[0] = kasumi(A[0], mod - 2);\n        return;\n    }\n    poly_inv(A, deg + 1 >> 1);\n    int limit = 1, L = -1;\n    while(limit <= (deg << 1)){limit <<= 1; L ++;}\n    for(Rint i = 0;i < limit;i ++)\n        rev[i] = (rev[i >> 1] >> 1) | ((i & 1) << L);\n    for(Rint i = 0;i < deg;i ++) tmp[i] = A[i];\n    for(Rint i = deg;i < limit;i ++) tmp[i] = 0;\n    NTT(tmp, limit, 1); NTT(ans, limit, 1);\n    for(Rint i = 0;i < limit;i ++) ans[i] = (2 - (LL) ans[i] * tmp[i] % mod + mod) % mod * ans[i] % mod;\n    NTT(ans, limit, -1);\n    for(Rint i = deg;i < limit;i ++) ans[i] = 0;\n}\nint Ln[N];\ninline void poly_Ln(int *A, int deg){\n    static int tmp[N];\n    poly_inv(A, deg);\n    for(Rint i = 1;i < deg;i ++) tmp[i - 1] = (LL) i * A[i] % mod;\n    tmp[deg - 1] = 0;\n    int limit = 1, L = -1;\n    while(limit <= (deg << 1)){limit <<= 1; L ++;}\n    for(Rint i = 0;i < limit;i ++)\n        rev[i] = (rev[i >> 1] >> 1) | ((i & 1) << L);\n    NTT(ans, limit, 1); NTT(tmp, limit, 1);\n    for(Rint i = 0;i < limit;i ++) Ln[i] = (LL) ans[i] * tmp[i] % mod;\n    NTT(Ln, limit, -1);\n    for(Rint i = deg + 1;i < limit;i ++) Ln[i] = 0;\n    for(Rint i = deg;i;i --) Ln[i] = (LL) Ln[i - 1] * kasumi(i, mod - 2) % mod;\n    Ln[0] = 0;\n    for(Rint i = 0;i < limit;i ++) ans[i] = tmp[i] = 0;\n}\nint Exp[N];\ninline void poly_Exp(int *A, int deg){\n    if(deg == 1){\n        Exp[0] = 1;\n        return;\n    }\n    poly_Exp(A, deg + 1 >> 1);\n    poly_Ln(Exp, deg);\n    for(Rint i = 0;i < deg;i ++) Ln[i] = (A[i] + (i == 0) - Ln[i] + mod) % mod;\n    int limit = 1, L = -1;\n    while(limit <= (deg << 1)){limit <<= 1; L ++;}\n    for(Rint i = 0;i < limit;i ++)\n        rev[i] = (rev[i >> 1] >> 1) | ((i & 1) << L);\n    NTT(Exp, limit, 1); NTT(Ln, limit, 1);\n    for(Rint i = 0;i < limit;i ++) Exp[i] = (LL) Exp[i] * Ln[i] % mod;\n    NTT(Exp, limit, -1);\n    for(Rint i = deg;i < limit;i ++) Exp[i] = 0;\n    for(Rint i = 0;i < limit;i ++) Ln[i] = ans[i] = 0;\n}\nint main(){\n    n = read(); k = read();\n    for(Rint i = 0;i < n;i ++) A[i] = read();\n    poly_Ln(A, n);\n    for(Rint i = 0;i < n;i ++) A[i] = (LL) Ln[i] * k % mod, Ln[i] = 0;\n    poly_Exp(A, n);\n    for(Rint i = 0;i < n;i ++) printf(\"%d \", Exp[i]);\n}\n```",
        "postTime": 1552091609,
        "uid": 68148,
        "name": "watermoon",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5245 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u3011"
    },
    {
        "content": "[\u53ef\u80fd\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.luogu.com.cn/blog/happydef-blog/duo-xiang-shi-quan-jia-tong-xue-xi-bi-ji)\n\n\u9996\u5148\u5410\u69fd\u4e00\u6ce2\u3002\u3002\u3002\u591a\u9879\u5f0f$\\exp$\u90fd\u662f\u9ed1\u7684\u8fd9\u9898\u600e\u4e48\u7d2b\u7684\u3002\u3002\u3002\n\n~~\u5f53\u7136\u4e0d\u6392\u9664\u5206\u6cbbNTT\u8279\u8fc7\u53bb\u7684\u53ef\u80fd\uff0c\u4e0d\u8fc7\u8fd9\u79cd\u505a\u6cd5\u6211\u4eec\u4e0d\u8bb2~~\n\n\u524d\u7f6e\u829d\u58eb\uff1a\u591a\u9879\u5f0f$\\ln$\uff0c\u591a\u9879\u5f0f$\\exp$\n\n$$G\\equiv F^k\\pmod {x^n}$$\n$$\\ln G\\equiv k\\ln F\\pmod {x^n}$$\n$$G\\equiv e^{k\\ln F}\\pmod {x^n}$$\nover\n\n\u590d\u6742\u5ea6$O(n\\log n)$\n\n\u4ee3\u7801\uff1a\n```cpp\nvoid getpow(ll*f,ll*g,ll len,ll k){\n   getln(f,h,len);\n   for(ll i=0;i<len;i++)h[i]=h[i]*k%P;\n   getexp(h,g,len);\n   clear(h);\n}\n```\n\u5b8c\u6574\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll; \nconst ll N=100005*3;\nll n,k,f[N],g[N];\nchar s[100000]; \nnamespace Poly{\n\tconst ll P=998244353,G=3;\n\tll lmt,rev[N],a[N],b[N],c[N],d[N],e[N],h[N];\n\tinline ll qpow(ll a,ll k){\n\t\tll ret=1;\n\t\twhile(k){\n\t\t\tif(k&1)ret=ret*a%P;\n\t\t\ta=(a*a)%P;\n\t\t\tk>>=1;\n\t\t}\n\t\treturn ret%P;\n\t}\n\tinline void init(ll n){\n\t\tlmt=1;ll t=0;\n\t\twhile(lmt<n)lmt<<=1,t++;\n\t\tfor(ll i=1;i<lmt;i++)rev[i]=(rev[i>>1]>>1)|(i&1)<<(t-1);\n\t}\n\tinline void NTT(ll *A,ll lmt,ll tp){\n\t\tfor(ll i=0;i<lmt;i++)if(i<rev[i])swap(A[i],A[rev[i]]);\n\t\tfor(ll m=1;m<lmt;m<<=1)\n\t\t\tfor(ll j=0,Wn=qpow(G,(P-1)/(m<<1));j<lmt;j+=m<<1)\n\t\t\t\tfor(ll k=0,w=1,x,y;k<m;k++,w=w*Wn%P)\n\t\t\t\t\tx=A[j+k],y=w*A[j+k+m]%P,A[j+k]=(x+y)%P,A[j+k+m]=(x-y+P)%P;\n\t\tif(tp==1)return;\n\t\treverse(A+1,A+lmt);\n\t\tfor(ll i=0,inv=qpow(lmt,P-2);i<=lmt;i++)A[i]=A[i]*inv%P;\n\t} \n\tinline void mul(ll *f,ll *g,ll len){\n\t\tinit(len);\n\t\tNTT(f,lmt,1);NTT(g,lmt,1);\n\t\tfor(ll i=0;i<lmt;i++)f[i]=(f[i]*g[i])%P;\n\t\tNTT(f,lmt,-1);\n\t} \n\tvoid getinv(ll*f,ll*g,ll len){\n\t\tif(len==1){g[0]=qpow(f[0],P-2);return;}\n\t\tgetinv(f,g,len+1>>1);\n\t\tinit(len<<1);\n\t\tfor(ll i=0;i<len;i++)c[i]=f[i];\n\t\tfor(ll i=len;i<lmt;i++)c[i]=0;\n\t\tNTT(c,lmt,1),NTT(g,lmt,1);\n\t\tfor(ll i=0;i<lmt;i++)g[i]=(2LL-g[i]*c[i]%P+P)%P*g[i]%P;\n\t\tNTT(g,lmt,-1);\n\t\tfor(ll i=len;i<lmt;i++)g[i]=0; \n\t}\n\tvoid getdev(ll*f,ll*g,ll len){\n\t\tfor(ll i=1;i<len;i++)g[i-1]=i*f[i]%P;\n\t\tg[len-1]=0;\n\t}\n\tvoid getinvdev(ll*f,ll*g,ll len){\n\t\tfor(ll i=1;i<len;i++)g[i]=f[i-1]*qpow(i,P-2)%P;\n\t\tg[0]=0;\n\t}\n\tvoid getln(ll*f,ll*g,ll len){\n\t\tmemset(a,0,sizeof(a));\n\t\tmemset(b,0,sizeof(b));\n\t\tgetdev(f,a,len);\n\t\tgetinv(f,b,len);\n\t\tmul(a,b,len<<1);\n\t\tgetinvdev(a,g,len);\n\t}\n\tvoid getexp(ll*f,ll*g,ll len){\n\t\tif(len==1){g[0]=1;return;}\n\t\tgetexp(f,g,len+1>>1);\n\t\tinit(len<<1);\n\t\tfor(ll i=0;i<(len<<1);i++)d[i]=e[i]=0;\n\t\tgetln(g,d,len);\n\t\tfor(ll i=0;i<len;i++)e[i]=f[i];\n\t    NTT(g,lmt,1),NTT(d,lmt,1),NTT(e,lmt,1);\n    \tfor(ll i=0;i<lmt;i++)g[i]=(1-d[i]+e[i]+P)*g[i]%P;\n    \tNTT(g,lmt,-1);\n    \tfor(ll i=len;i<lmt;i++)g[i]=0; \n\t}\n\tvoid getpow(ll*f,ll*g,ll len,ll k){\n\t\tgetln(f,h,n);\n\t\tfor(ll i=0;i<len;i++)h[i]=h[i]*k%P;\n\t\tgetexp(h,g,n);\n\t}\n}\nusing Poly::P;\nusing Poly::getpow;\nint main(){\n\tscanf(\"%lld%s\",&n,s+1);\n\tfor(ll i=1,l=strlen(s+1);i<=l;i++)k=(k*10+s[i]-'0')%P;\n\tfor(ll i=0;i<n;i++)scanf(\"%lld\",&f[i]);\n\tgetpow(f,g,n,k);\n\tfor(ll i=0;i<n;i++)printf(\"%lld \",g[i]);\n\treturn 0;\n}\n```\n\uff08\u8fd9\u4e2a\u5e38\u6570\u4f3c\u4e4e\u4e0d\u662f\u5f88\u5927\uff1f\u5728[Karry\u7684selftest](https://www.luogu.com.cn/problem/U65286)\u91cc\u65e0\u9700\u6539\u52a8\u5c31\u53ef\u4ee5\u8dd1\u5230\u7b2c\u4e8c\u9875\u3002\uff08\u96fe",
        "postTime": 1594910060,
        "uid": 121027,
        "name": "Spasmodic",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5245 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u3011"
    },
    {
        "content": "\u4e00\u5f00\u59cb\u672c\u6765\u60f3\u5c01\u88c5\u591a\u9879\u5f0f\u4e58\u6cd5\uff0c\u6309\u7167\u666e\u901a\u5feb\u901f\u5e42\u7684\u601d\u8def\u53bb\u505a\u7684\n$$A^k=\\left(A^{\\left\\lfloor\\frac{k}{2}\\right\\rfloor}\\right)^2A^{\\left[(2,n)=1\\right]}$$\n\u4f46$\\log k$\u8fd8\u662f\u592a\u5927\uff0c\u53ea\u597d\u8003\u8651\u5c06$k$\u8f6c\u5316\u4e3a\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u4e86\u3002\n\n\u9996\u5148\n$$B(x)=A^k(x)$$\n\u4e24\u8fb9\u540c\u65f6\u53d6\u5bf9\u6570\n$$\\ln B(x)=\\ln A^k(x)$$\n\u7531\u5bf9\u6570\u51fd\u6570\u7684\u6027\u8d28\uff0c\u6211\u4eec\u6709\n$$\\ln B(x)=k\\ln A(x)$$\n\u8f6c\u5316\u4e00\u4e0b\uff0c\u5c31\u6210\u677f\u5b50\u9898\u4e86\n$$B(x)=e^{k\\ln A(x)}=\\exp\\left(k\\ln A(x)\\right)$$\n\u7531\u4e8e$k$\u4e3a\u7cfb\u6570\uff0c\u8fb9\u8f93\u5165\u8fb9\u53d6\u6a21\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <csstring>\n#include <algorithm>\ntypedef long long ll;\nconst int P = 998244353, N = 262145, g3 = (P + 1) / 3;\nusing namespace std;\nint n, k, a[N], A[N], G[N];\n\nint pow(int a,int b)\n{\n\tint r = 1;\n\twhile(b)\n\t{\n\t\tif(b & 1) r = (ll)r * a % P;\n\t\ta = (ll)a * a % P;\n\t\tb >>= 1;\n\t}\n\treturn r;\n}\nnamespace poly\n{\n    int rev[N];\n\tvoid NTT(int *A, int n, int inv) \n\t{\n\t\tfor(int i = 0; i < n; ++i)\n\t\t\tif(i < rev[i]) swap(A[i], A[rev[i]]);\n\t\tfor(int mid = 1; mid < n; mid <<= 1) \n\t\t{\n\t\t\tint tmp = pow(inv == 1 ? 3 : g3, (P - 1) / (mid << 1));\n\t\t\tfor(int j = 0; j < n; j += (mid << 1)) \n\t\t\t{\n\t\t\t\tint omega = 1;\n\t\t\t\tfor(int k = 0; k < mid; ++k, omega = (ll)omega * tmp % P) \n\t\t\t\t{\n\t\t\t\t\tint x = A[j + k], y = (ll)omega * A[j + k + mid] % P;\n\t\t\t\t\tA[j + k] = (x + y) % P;\n\t\t\t\t\tA[j + k + mid] = (ll)(x - y + P) % P;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(inv == 1) return;\n\t\tint invn = pow(n, P - 2);\n\t\tfor(int i = 0; i < n; ++i)\n\t\t\tA[i] = (ll)A[i] * invn % P;\n\t}\n    void Inv(int *a, int *b, int n) \n\t{\n\t\tstatic int B[N], A[N];\n\t\tb[0] = pow(a[0], P - 2);\n\t\tint len, lim;\n\t\tfor(len = 1; len < (n << 1); len <<= 1)\n\t\t{\n\t\t\tlim = len << 1;\n\t\t\tfor(int i = 0; i < len; i++)\n\t\t\t\tA[i] = a[i], B[i] = b[i];\n\t\t\tfor(int i = 0; i < lim; i++)\n\t\t\t\trev[i] = (rev[i >> 1] >> 1) | ((i & 1) ? len : 0);\n\t\t\tNTT(A, lim, 1), NTT(B, lim, 1);\n\t\t\tfor(int i = 0; i < lim; i++)\n\t\t\t\tb[i] = ((2LL - 1LL * A[i] * B[i] % P) * B[i] % P + P) % P;\n\t\t\tNTT(b, lim, -1);\n\t\t\tfor(int i = len; i < lim; i++)\n\t\t\t\tb[i] = 0;\n\t\t}\n\t\tfor(int i = 0; i < len; i++) \n\t\t\tA[i] = B[i] = 0;\n\t\tfor(int i = n; i < len; i++)\n\t\t\tb[i] = 0;\n\t}\n    void derivative(int *a, int *b, int n)\n\t{\n        b[n - 1] = 0;\n        for(int i = 1; i < n; ++i)\n        \tb[i - 1] = (ll)a[i] * i % P;\n    }\n    void inter(int *a, int *b, int n)\n\t{\n        *b = 0;\n        for(int i = n - 1; i >= 0; --i)\n\t\t\tb[i + 1] = a[i] * (ll)pow(i + 1, P - 2) % P;\n    }\n    void ln(int *a, int *b, int n)\n\t{\n        static int F[N];\n        derivative(a, F, n);\n\t\tInv(a, b, n);\n        int lim = 1;\n        while(lim < (n << 1)) lim <<= 1;\n        for(int i = 1; i < lim; i++)\n        \trev[i] = (rev[i >> 1] >> 1) | ((i & 1) ? (lim >> 1) : 0);\n        for(int i = n; i < lim; ++i)\n\t\t\tb[i] = F[i] = 0;\n        NTT(F, lim, 1), NTT(b, lim, 1);\n        for(int i = 0; i < lim; ++i)\n\t\t\tF[i] = (ll)b[i] * F[i] % P;\n        NTT(F, lim, 0);\n        inter(F, b, n);\n        for(int i = n; i < lim; ++i)\n\t\t\tb[i] = 0;\n    }\n    void exp(int*a, int*F, int n)\n\t{\n        if(n == 1)\n\t\t\t*F = 1;\n\t\telse\n\t\t{\n            exp(a, F, n + 1 >> 1);\n            static int F0[N], A[N];\n            for(int i = 0; i <= (n << 1); ++i)\n\t\t\t\tF0[i] = 0, A[i] = a[i];\n            ln(F, F0, n);\n            int lim = 1;\n            while(lim < (n << 1)) lim <<= 1;\n            for(int i = 1; i < lim; i++)\n            \trev[i] = (rev[i >> 1] >> 1) | ((i & 1) ? (lim >> 1) : 0);\n            for(int i = n; i < lim; ++i)\n\t\t\t\tA[i] = 0;\n            NTT(A, lim, 1), NTT(F0, lim, 1), NTT(F, lim, 1);\n            for(int i = 0; i < lim; ++i)\n\t\t\t\tF[i] = F[i] * (A[i] + 1LL - F0[i] + P) % P;\n            NTT(F, lim, 0);\n            for(int i = n; i < lim; ++i)\n\t\t\t\tF[i] = 0;\n        }\n    }\n}\nusing namespace poly;\nint main()\n{\n    scanf(\"%d\", &n);\n    int c=getchar();while(isspace(c))c=getchar();\n    for(;isdigit(c);c=getchar())k=(k*10LL+(c^'0'))%P;\n    for(int i = 0; i < n; ++i)\t\n\t\tscanf(\"%d\", a + i);\n    ln(a, A, n);\n    for(int i = 0; i < n; ++i)\n\t\tA[i] = A[i] * (ll)k % P;\n    for(int i = 0; i < n; ++i)\n\t\ta[i] = 0;\n    exp(A, a, n);\n    for(int i = 0; i < n; ++i)\n\t\tprintf(\"%d \", a[i]);\n    return 0;\n}\n```\n",
        "postTime": 1559190448,
        "uid": 139340,
        "name": "Gauss0320",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5245 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5feb\u901f\u5e42"
    },
    {
        "content": "\u672c\u6587\u6536\u5f55\u4e8e\uff1a[\u591a\u9879\u5f0f\u7b97\u6cd5\u5b66\u4e60\u7b14\u8bb0](https://venusnero.github.io/2019/03/19/poly_algorithm_note/)\u3002\n\n\u8fd9\u4e2a\u597d\u201c\u7b80\u5355\u201d\u7684\u2026\u2026\n\n\u524d\u7f6e\u829d\u58eb\u4e3a \u591a\u9879\u5f0f $\\exp$ \u548c \u591a\u9879\u5f0f $\\ln$\u2026\u2026\n\n\u8003\u8651\u5bf9\u6570\u51fd\u6570\u7684\u6027\u8d28\uff0c\u5373\uff1a$log_ab^k=klog_ab$\uff0c\u8fd9\u4e2a\u5bf9\u591a\u9879\u5f0f\u4e5f\u9002\u7528\u3002\n\n\u90a3\u4e48\u6211\u4eec\u77e5\u9053\uff0c$\\exp$ \u5176\u5b9e\u5c31\u662f $e^x$\uff0c$\\ln$ \u5176\u5b9e\u5c31\u662f $log_ex$\uff0c\u90a3\u4e48\u2026\u2026\n\n\u8981\u6c42 $G(x)$ \u4f7f\u5f97 $G(x)=F^k(x)$\uff0c\u4e24\u8fb9\u53d6\u81ea\u7136\u5bf9\u6570\uff0c\u5f97\uff1a\n\n$$\\ln G(x)=k\\ln F(x)$$\n\n\u6240\u4ee5\u6211\u4eec\u628a $F(x)$ \u6c42 $\\ln$\uff0c\u628a\u7cfb\u6570\u4e58\u4e0a $k$\uff0c\u7136\u540e\u505a\u4e00\u904d $\\exp$ \u5c31\u5f97\u5230\u4e86 $G(x)$\u3002\n\n~~\uff08\u7b80\u4e0d\u7b80\u5355\u5416~\uff09~~\n\n```cpp\nsigned main()\n{\n    scanf(\"%lld %s\",&n,s+1);\n    int l=strlen(s+1);\n    for(int i=1;i<=l;i++) k=((k<<3)+(k<<1)+(s[i]-48))%Mod;\n    for(int i=0;i<n;i++) scanf(\"%lld\",&F[i]);\n    GetLn(F,G,n);\n    for(int i=0;i<n;i++) G[i]=G[i]*k%Mod;\n    memset(b,0,sizeof(b));\n    GetExp(G,T,n);\n    for(int i=0;i<n;i++) printf(\"%lld \",T[i]);\n    return 0;\n}\n```",
        "postTime": 1553087396,
        "uid": 23243,
        "name": "VenusM1nT",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5245 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u3011"
    },
    {
        "content": "# \u591a\u9879\u5f0f\u5feb\u901f\u5e42\n\n## \u9898\u76ee\u5927\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a $n-1$ \u6b21\u7684\u591a\u9879\u5f0f $A(x)$ \uff0c\u6c42\u4e00\u4e2a\u5728 $mod x^n$ \u610f\u4e49\u4e0b\u7684\u591a\u9879\u5f0f $B(x)$ \uff0c\u4f7f\u5f97 $B(x) \\equiv A^k(x) (mod x^n)$ \u3002\n\n\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u5728 $mod$ $998244353$ \u7684\u610f\u4e49\u4e0b\u8fdb\u884c\u8fd0\u7b97\u3002\n\n## \u5206\u6790\n\n### \u601d\u8def\u4e00\uff1a\u500d\u589e\n\n\u8fd9\u9898\u65e2\u7136\u53eb\u5feb\u901f\u5e42\uff0c\u90a3\u4e48\u548c\u6211\u4eec\u6b63\u5e38\u7684\u5feb\u901f\u5e42\u80af\u5b9a\u662f\u6709\u67d0\u79cd\u5173\u8054\u7684\uff0c\u4e8b\u5b9e\u4e0a\u4ed6\u4eec\u5c31\u662f\u5b8c\u5168\u4e00\u6837\u7684\u3002\n\n\u6211\u4eec\u5e73\u65f6\u7684\u5feb\u901f\u5e42\u662f\u600e\u4e48\u505a\u7684\uff1f\n\n```cpp\ninline int power(int x,int k){\n    int res=1;\n    while(k){\n        if(k&1) res=res*x%MOD;\n        k>>=1,x=x*x%MOD;\n    }\n    return res;\n}\n```\n\u5176\u5b9e\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u5c31\u662f\u5728\u8fd9\u4e2a\u7684\u57fa\u7840\u4e0a\u628a\u4e58\u6cd5\u6362\u6210\u591a\u9879\u5f0f\u7684 $NTT$ \u5c31\u884c\u4e86\uff0c\u8fd9\u91cc\u5c31\u4e0d\u52a0\u8d58\u8ff0\u3002\n\n\u8fd9\u79cd\u505a\u6cd5\u6bd4\u8f83\u7b80\u5355\uff0c\u4e5f\u5f88\u5bb9\u6613\u7406\u89e3\uff0c\u552f\u4e00\u9700\u8981\u6ce8\u610f\u7684\u5730\u65b9\u5c31\u662f\u7b54\u6848\u6570\u7ec4\u7684**\u96f6\u6b21\u9879\u6570**\u9700\u8981\u521d\u59cb\u5316\u4e3a $1$ \u3002\n\n\u7136\u540e\u5c31\u662f\u8fd9\u4e48\u505a\u597d\u50cf\u6709\u70b9**\u6162**\uff0c\u5355\u6b21\u5377\u79ef\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(nlog_2n)$ \uff0c\u90a3\u663e\u7136\u4e00\u4e2a\u5feb\u901f\u5e42\u591a\u4e00\u4e2a $log$ \u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f $O(nlog^2_2n)$ \u3002\n\n\u5230\u6b64\u8fd9\u79cd\u505a\u6cd5\u5c31\u7ed3\u675f\u4e86\uff0c\u4f46\u662f\u6211\u4e0d\u60f3\u628a\u4ee3\u7801\u8d34\u51fa\u6765~~\u6211\u6ca1\u6709\u6253\u8fd9\u79cd\u505a\u6cd5\u7684\u4ee3\u7801~~\uff0c\u90a3\u5c31\u8d34\u4e0a $NTT$ \u7684\u5427\uff0c\u53ea\u9700\u8981\u5957\u4e00\u4e0b\u5c31\u884c\u4e86\u3002\n\n\n```cpp\ninline void NTT(int *P,int flag)\n{\n    for(register int i=0;i<l;i++) if(i<r[i]) swap(P[i],P[r[i]]);\n    for(register int i=1;i<l;i<<=1){\n        int W=power(3,(MOD-1)/(i<<1));\n        if(flag<0) W=power(W,MOD-2);\n        for(register int j=0,p=i<<1;j<l;j+=p)\n            for(register int k=0,w=1;k<i;k++,w=1ll*w*W%MOD){\n                int x=P[j+k],y=1ll*P[j+k+i]*w%MOD;\n                P[j+k]=(x+y)%MOD;P[j+k+i]=((x-y)%MOD+MOD)%MOD;\n            }\n    }\n    if(flag<0) for(register int i=0,t=power(l,MOD-2);i<l;i++) P[i]=1ll*P[i]*t%MOD;\n}\n```\n\n### \u601d\u8def\u4e8c\uff1a\n\n\u4e0a\u9762\u4e5f\u8bf4\u5230\u4e86\uff0c\u500d\u589e\u662f\u4e00\u79cd\u6bd4\u8f83\u6162\u7684\u505a\u6cd5\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u8fdb\u884c\u4e00\u4e9b\u7b80\u5355\u7684**\u6570\u5b66\u63a8\u5bfc**\u3002\n\n\u5bf9\u539f\u5f0f\u4e24\u8fb9\u540c\u65f6\u53d6**\u5bf9\u6570**\uff0c\u6709\uff1a\n\n$$ ln f(x)\\equiv k \\times ln g(x) $$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u4f3c\u66fe\u76f8\u8bc6\uff1f\n\n\u6ca1\u9519\uff0c\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u7528 [\u591a\u9879\u5f0f$exp$](https://www.luogu.com.cn/problem/P4726) \u6765\u6c42\u89e3\u3002\n\n\u4e5f\u5c31\u662f(\u6ce8\uff1a\u4e0b\u9762 $exp()$ \u7684\u610f\u601d\u5c31\u662f\u628a\u62ec\u53f7\u5185\u591a\u9879\u5f0f\u6309\u7167\u4e0a\u9762\u94fe\u63a5\u7684\u90a3\u4e2a\u9898\u76ee\u505a\u4e00\u904d\u5373\u53ef\uff0c\u4e0d\u4f1a\u7684\u540c\u5b66\u53ef\u4ee5\u5148\u53bb\u770b\u770b):\n\n$$ f(x)\\equiv exp(k\\times ln g(x)) $$\n\n\u90a3\u9053\u8fd9\u91cc\u8fd9\u9053\u9898\u5176\u5b9e\u4e5f\u5c31\u505a\u5b8c\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4f1a\u6bd4\u4e0a\u4e00\u4e2a\u4f18\u79c0\u4e00\u70b9\uff0c\u4e3a $O(log_2n)$ \u3002\n\n## \u601d\u8def\u4e8cCODE\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\n#define mul(x,y) (1ll*x*y%MOD)\n#define add(x,y) (x+y>=MOD?x+y-MOD:x+y)\n#define dec(x,y) (x-y<0?x-y+MOD:x-y)\nusing namespace std;\nconst int N=1e6+10,MOD=998244353;\nint n,m,k;\nint l,Time;\nint r[N],A[N],B[N],C[N],D[N],F[N],G[N],O[N],f[N],g[N],inv[N];\ninline int read()\n{\n\tint s=0,w=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9') { if(ch=='-') w*=-1; ch=getchar(); }\n\twhile(ch>='0'&&ch<='9') s=(s*10%MOD+ch-'0'+MOD)%MOD,ch=getchar();\n\treturn s*w;\n}\nint a[N];\ninline int power(int x,int k){\n    int res=1;\n    while(k){\n        if(k&1) res=mul(res,x);\n        k>>=1,x=mul(x,x);\n    }\n    return res;\n}\ninline void Deri(int *A,int *B,int len) { for(register int i=1;i<len;i++) B[i-1]=1ll*i*A[i]%MOD;B[len-1]=0; }\ninline void Inte(int *A,int *B,int len) { for(register int i=1;i<len;i++) B[i]=1ll*A[i-1]*power(i,MOD-2)%MOD;B[0]=0; }\ninline void NTT(int *A,int flag,int len){\n    int limit=1,l=0;\n    while(limit<len) limit<<=1,++l;\n    for(register int i=0;i<limit;i++) r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n    for(register int i=0;i<limit;i++) if(i<r[i]) swap(A[i],A[r[i]]);\n    for(register int mid=1;mid<limit;mid<<=1){\n        int R=mid<<1,Wn=power(3,(MOD-1)/R);O[0]=1;\n        for(register int j=1;j<mid;++j) O[j]=mul(O[j-1],Wn);\n        for(register int j=0;j<limit;j+=R){\n            for(register int k=0;k<mid;++k){\n                int x=A[j+k],y=mul(O[k],A[j+k+mid]);\n                A[j+k]=add(x,y),A[j+k+mid]=dec(x,y);\n            }\n        }\n    }\n    if(flag==-1) { reverse(A+1,A+limit); for(register int i=0,invl=inv[limit];i<limit;i++) A[i]=mul(A[i],invl); }\n}\ninline void Inv(int *a,int *b,int len){\n    if(len==1) return (void)(b[0]=inv[a[0]]);\n    Inv(a,b,len>>1);\n    for(register int i=0;i<len;i++) C[i]=a[i],D[i]=b[i];\n    NTT(C,1,len<<1),NTT(D,1,len<<1);\n    for(register int i=0,l=(len<<1);i<l;i++) C[i]=mul(mul(C[i],D[i]),D[i]);\n    NTT(C,-1,len<<1);\n    for(register int i=0;i<len;i++) b[i]=dec(add(b[i],b[i]),C[i]);\n    for(register int i=0,l=(len<<1);i<l;i++) C[i]=D[i]=0;\n}\ninline void Ln(int *a,int *b,int len){\n    Deri(a,A,len),Inv(a,B,len);\n    NTT(A,1,len<<1),NTT(B,1,len<<1);\n    for(register int i=0,l=len<<1;i<l;i++) A[i]=mul(A[i],B[i]);\n    NTT(A,-1,len<<1),Inte(A,b,len<<1);\n    for(register int i=0,l=len<<1;i<l;i++) A[i]=B[i]=0;\n}\ninline void Exp(int *a,int *b,int len){\n    if(len==1) return (void)(b[0]=1);\n    Exp(a,b,len>>1),Ln(b,F,len);\n    F[0]=dec(a[0]+1,F[0]);\n    for(register int i=1;i<len;i++) F[i]=dec(a[i],F[i]);\n    NTT(F,1,len<<1),NTT(b,1,len<<1);\n    for(register int i=0,l=len<<1;i<l;i++) b[i]=mul(b[i],F[i]);\n    NTT(b,-1,len<<1);\n    for(register int i=len,l=(len<<1);i<l;i++) b[i]=F[i]=0;\n}\ninline void Deri1(int *A,int *B,int len) { for(register int i=1;i<len;i++) B[i-1]=1ll*i*A[i]%MOD;B[len-1]=0; }\ninline void Inte1(int *A,int *B,int len) { for(register int i=1;i<len;i++) B[i]=1ll*A[i-1]*power(i,MOD-2)%MOD;B[0]=0; }\ninline void ntt(int *P,int flag)\n{\n    for(register int i=0;i<l;i++) if(i<r[i]) swap(P[i],P[r[i]]);\n    for(register int i=1;i<l;i<<=1){\n        int W=power(3,(MOD-1)/(i<<1));\n        if(flag<0) W=power(W,MOD-2);\n        for(register int j=0,p=i<<1;j<l;j+=p)\n            for(register int k=0,w=1;k<i;k++,w=1ll*w*W%MOD){\n                int x=P[j+k],y=1ll*P[j+k+i]*w%MOD;\n                P[j+k]=(x+y)%MOD;P[j+k+i]=((x-y)%MOD+MOD)%MOD;\n            }\n    }\n    if(flag<0) for(register int i=0,t=power(l,MOD-2);i<l;i++) P[i]=1ll*P[i]*t%MOD;\n}\ninline void Reverse(int *f,int *g,int n)\n{\n    if(n==1) { g[0]=power(f[0],MOD-2); return; }\n    Reverse(f,g,n>>1);\n    for(l=1,Time=0;l<=n;l<<=1) Time++;Time--;\n    for(register int i=0;i<l;i++) r[i]=(r[i>>1]>>1)|((i&1)<<Time);\n    for(register int i=0;i<n;i++) C[i]=f[i],D[i]=g[i];\n    for(register int i=n;i<l;i++) C[i]=D[i]=0; ntt(C,1);ntt(D,1);\n    for(register int i=0;i<l;i++) C[i]=1ll*C[i]*D[i]%MOD*D[i]%MOD; ntt(C,-1);\n    for(register int i=0;i<n;i++) g[i]=((2ll*g[i]%MOD-C[i])%MOD+MOD)%MOD;\n}\ninline void Solve(int *f,int *g,int n)\n{\n    Deri1(f,A,n); Reverse(f,B,n);\n    for(l=1,Time=0;l<=n;l<<=1) Time++;\n    Time--;\n    for(register int i=0;i<l;i++) r[i]=(r[i>>1]>>1)|((i&1)<<Time);\n    ntt(A,1),ntt(B,1);\n    for(register int i=0;i<l;i++) A[i]=1ll*A[i]*B[i]%MOD;\n    ntt(A,-1);\n    Inte1(A,g,n);\n}\ninline void clear()\n{\n\tmemset(A,0,sizeof(A));\n\tmemset(B,0,sizeof(B));\n\tmemset(C,0,sizeof(A));\n\tmemset(D,0,sizeof(B));\n\tmemset(F,0,sizeof(A));\n\tmemset(G,0,sizeof(B));\n\tmemset(r,0,sizeof(A));\n}\nsigned main()\n{\n\tn=read(),k=read();\n\tfor(register int i=0;i<n;i++) F[i]=read();\n\tfor(m=1;m<=n;m<<=1);\n\tSolve(F,G,m);\n\tfor(register int i=0;i<n;i++) \n\t\tf[i]=G[i]*k%MOD;\n\tclear();\n\tfor(register int i=0,l=m<<1;i<=l;i++) inv[i]=power(i,MOD-2);\n\tExp(f,g,m);\n\tfor(register int i=0;i<n;i++) printf(\"%lld \",g[i]);\n\treturn 0;\n}\n```\n",
        "postTime": 1617623642,
        "uid": 258460,
        "name": "Booksnow",
        "ccfLevel": 0,
        "title": "P5245 [\u6a21\u677f]\u591a\u9879\u5f0f\u5feb\u901f\u5e42[\u9898\u89e3]"
    },
    {
        "content": "\u8003\u8651\u591a\u9879\u5f0f $\\ln$ \u548c $\\exp$ \u8fd0\u7b97\u5947\u5999\u7684\u590d\u6742\u5ea6\uff0c\u4e8e\u662f\u663e\u7136\u53ef\u4ee5\u8fd0\u7528\u4ee5\u4e0a\u4e24\u8005\u89e3\u51b3\u8fd9\u9053\u9898\u3002\n\n***`cmath` \u5e93\u4e2d\u7684 `pow` \u51fd\u6570\u5c31\u662f\u4f7f\u7528\u4e86\u8fd9\u79cd\u65b9\u6cd5\u5b9e\u73b0\u7684\u3002***\n\n\u4e8e\u662f\u6709\u5341\u5206\u7b80\u5355\u7684\u5f0f\u5b50\uff1a\n\n$$G(x)\\equiv F^k(x)\\pmod{x^n}$$\n\n$$\\ln G(x)\\equiv k\\ln F(x)\\pmod{x^n}$$\n\n\u540c\u65f6\u53d6 $\\exp$ \u5f97\n\n$$G(x)\\equiv e^{k\\ln F(x)}\\pmod{x^n}$$\n\n\u4e8e\u662f\u8003\u8651\u642c\u6765 $\\ln$ \u548c $\\exp$ \u7684\u677f\u5b50\uff0c\u53d6\u5b8c $\\ln$ \u540e\u4e58 $k$ \u518d $\\exp$ \u4e8e\u662f\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u6ce8\u610f\u6e05\u96f6\u3002\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n#include <algorithm>\n\ntypedef long long ll;\nconst int p = 998244353;\nconst int MAXN = 400001;\n\ninline ll read() {\n    ll x = 0,f = 1; char ch = getchar();\n    while(ch > '9' || ch < '0') { if(ch == '-') f = -1; ch = getchar(); }\n    do x = (x * 10 + ch - 48) % p, ch = getchar(); while(ch >= '0' && ch <= '9');\n    return (x * f % p + p) % p;\n}\n\nint n,k,r[MAXN];\nll f[MAXN],g[MAXN],inv[MAXN];\n\nll fastpow(ll a,int b) {\n    ll res = 1; a %= p;\n    while(b) {\n        if(b & 1) res = res * a % p;\n        a = a * a % p;\n        b >>= 1;\n    }\n    return res;\n}\n\nvoid NTT(ll *a,int N) {\n    for(int i = 0;i < N;i++) if(i < r[i]) std::swap(a[i],a[r[i]]);\n    for(int n = 2,m = 1;n <= N;m = n, n <<= 1) {\n        ll g1 = fastpow(3,(p - 1) / n);\n        for(int l = 0;l < N;l += n) {\n            ll g = 1,t1,t2;\n            for(int i = l;i < l + m;i++) {\n                t1 = a[i], t2 = g * a[i + m] % p;\n                a[i] = (t1 + t2) % p;\n                a[i + m] = (t1 - t2 + p) % p;\n                g = g * g1 % p;\n            }\n        }\n    }\n    return;\n}\n\nvoid INTT(ll *a,int N) {\n    NTT(a,N);\n    std::reverse(a + 1,a + N);\n    int invN = fastpow(N,p - 2);\n    for(int i = 0;i < N;i++) a[i] = a[i] * invN % p;\n}\n\nvoid Dervt(ll *a,ll *b,int n) {\n    for(int i = 1;i < n;i++) b[i - 1] = a[i] * i % p;\n    b[n - 1] = 0;\n    return;\n}\n\nvoid Integ(ll *a,ll *b,int n) {\n    for(int i = 1;i < n;i++) b[i] = a[i - 1] * inv[i] % p;\n    b[0] =  0;\n    return;\n}\n\nll a1[MAXN];\n\nvoid Inv(ll *a,ll *b,int n) {\n    if(n == 1) return void(b[0] = fastpow(a[0],p - 2));\n    Inv(a,b,(n + 1) >> 1);\n    int N = 1, l = -1; while(N <= n << 1) N <<= 1, l++;\n    for(int i = 1;i < N;i++) r[i] = (r[i >> 1] >> 1) | ((i & 1) << l);\n    for(int i = 0;i < n;i++) a1[i] = a[i];\n    for(int i = n;i < N;i++) a1[i] = 0;\n    NTT(a1,N); NTT(b,N);\n    for(int i = 0;i < N;i++) b[i] = ((b[i] << 1) % p + p - a1[i] * b[i] % p * b[i] % p) % p;\n    INTT(b,N);\n    for(int i = n;i < N;i++) b[i] = 0;\n    return;\n}\n\nll f1[MAXN],f2[MAXN];\n\nvoid Ln(ll *f,ll *g,int n) {\n    memset(f1,0,sizeof(f1)); memset(f2,0,sizeof(f2));\n    Dervt(f,f1,n); Inv(f,f2,n);\n    int N = 1, l = -1; while(N <= n << 1) N <<= 1, l++;\n    for(int i = 1;i < N;i++) r[i] = (r[i >> 1] >> 1) | ((i & 1) << l);\n    NTT(f1,N); NTT(f2,N);\n    for(int i = 0;i < N;i++) f1[i] = f1[i] * f2[i] % p;\n    INTT(f1,N); Integ(f1,g,n);\n    return;\n}\n\nll g1[MAXN];\n\nvoid Exp(ll *f,ll *g,int n) {\n    if(n == 1) return void(g[0] = 1);\n    Exp(f,g,(n + 1) >> 1);\n    Ln(g,g1,n);\n    int N = 1, l = -1; while(N <= n << 1) N <<= 1, l++;\n    for(int i = 1;i < N;i++) r[i] = (r[i >> 1] >> 1) | ((i & 1) << l);\n    for(int i = 0;i < n;i++) f1[i] = f[i];\n    for(int i = n;i < N;i++) g1[i] = f1[i] = 0;\n    for(int i = 0;i < N;i++) f1[i] = ((f1[i] - g1[i]) % p + p) % p;\n    f1[0] = (f1[0] + 1) % p;\n    NTT(f1,N); NTT(g,N);\n    for(int i = 0;i < N;i++) g[i] = f1[i] * g[i] % p;\n    INTT(g,N);\n    for(int i = n;i < N;i++) g[i] = 0;\n    return;\n}\n\nll lnf[MAXN];\n\nvoid Pow(ll *f,ll *g,int n,int k) {\n    Ln(f,lnf,n);\n    for(int i = 0;i < n;i++) lnf[i] = lnf[i] * k % p;\n    Exp(lnf,g,n);\n    return;\n}\n\nint main() {\n    n = read(), k = read();\n    for(int i = 0;i < n;i++) f[i] = read();\n    inv[1] = 1;\n    for(int i = 2;i < MAXN;i++) inv[i] = inv[p % i] * (p - p / i) % p;\n    Pow(f,g,n,k);\n    for(int i = 0;i < n;i++) std::printf(\"%lld \",g[i]);\n    return 0;\n}\n\n```",
        "postTime": 1594258499,
        "uid": 219595,
        "name": "Vocalise",
        "ccfLevel": 9,
        "title": "\u591a\u9879\u5f0f\u5e42--\u9898\u89e3 P5245 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u3011"
    },
    {
        "content": "\u524d\u7f6e\u829d\u58eb\uff1a\u591a\u9879\u5f0fexp\u3001\u591a\u9879\u5f0fln\n\n\u63a8\u5f0f\u5b50\n$$B(x)\\equiv A^m(x)(\\mathrm{mod\\:}x^n)$$\n\u540c\u65f6\u53d6\u5bf9\u6570\n$$lnB(x)\\equiv mlnA(x)(\\mathrm{mod\\:}x^n)$$\n\u6240\u4ee5\u5bf9A(x)\u53d6ln\uff0c\u7cfb\u6570\u4e58\u4e0am\uff0c\u518dexp\u5c31\u53ef\u4ee5\u4e86\u3002\u7531\u4e8e\u8fd9\u9898\u4fdd\u8bc1a0==1\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u8003\u8651\u53d6ln\u65f6\u7684\u7279\u6b8a\u60c5\u51b5\u3002\u7279\u6b8a\u60c5\u51b5\u53ef\u4ee5\u53c2\u8003https://www.luogu.org/problemnew/show/U63679\n\nupd:\u5df2\u7ecf\u4e3aP5273\n\n\u8be6\u89c1\u4ee3\u7801\uff0c\u7279\u6b8a\u5904\u7406\u7684\u662fksm1\uff0c\u66b4\u529b\u662fksm2\uff0c\u8fd9\u9898\u53ea\u9700\u8981ksm3\n```cpp\n#include <stdio.h>\n#include <string.h>\n#include <algorithm>\n#include <stdlib.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pa;\nconst int N=2.7e5,p=998244353;\nint r[N],ig[N],yg[N],invf[N],sqrtf[N],sqrtg[N],cdqf[N],cdqg[N],lnf[N],expf[N],expg[N];\nint ksmf[N],inv[N],f[N],g[N],y[N];\nint n,m,i,j,l,limit,biglimit,c,w;\npa ys,yys;\ninline int sj()\n{\n    return rand()<<15|rand();\n}\npa operator *(pa x,pa y)\n{\n    ys.first=((ll)x.first*y.first+(ll)x.second*y.second%p*w)%p;\n    ys.second=((ll)x.first*y.second+(ll)x.second*y.first)%p;\n    return ys;\n}\ninline void dbug(int *a,int n)\n{\n    for (int i=0;i<n;i++) printf(\"%d \",a[i]);puts(\"\");\n}\ninline void read(int &x)\n{\n    c=getchar();\n    while ((c<48)||(c>57)) c=getchar();\n    x=c^48;c=getchar();\n    while ((c>=48)&&(c<=57))\n    {\n        x=x*10+(c^48);\n        c=getchar();\n    }\n}\ninline void readd(int &x)\n{\n    c=getchar();\n    while ((c<48)||(c>57)) c=getchar();\n    x=c^48;c=getchar();\n    while ((c>=48)&&(c<=57))\n    {\n        x=((ll)x*10+(c^48))%p;\n        c=getchar();\n    }\n}\ninline int ksm(int x,int y)\n{\n    int r=1;\n    while (y)\n    {\n        if (y&1) r=(ll)r*x%p;\n        x=(ll)x*x%p;\n        y>>=1;\n    }\n    return r;\n}\ninline pa ksm(pa x,int y)\n{\n    yys.first=1;yys.second=0;\n    while (y)\n    {\n        if (y&1) yys=yys*x;\n        x=x*x;\n        y>>=1;\n    }\n    return yys;\n}\ninline int mosqrt(int x)\n{\n    pa a;\n    int y=rand()%p;\n    while (ksm(w=((ll)y*y%p-x+p)%p,p-1>>1)<=1) y=rand()%p;\n    if (w<0) w+=p;\n    a.first=y;a.second=1;\n    a=ksm(a,p+1>>1);\n    return min(a.first,p-a.first);\n}\ninline void ycl(int l,int limit)\n{\n    for (int i=1;i<limit;i++) r[i]=r[i>>1]>>1|(i&1)<<l;\n}\ninline void gg(int limit)\n{\n    int i;\n    ig[limit]=ksm(yg[limit]=ksm(3,(p-1)/limit),p-2);\n    for (i=limit>>1;i;i>>=1)\n    {\n        yg[i]=(ll)yg[i<<1]*yg[i<<1]%p;\n        ig[i]=(ll)ig[i<<1]*ig[i<<1]%p;\n    }\n    inv[1]=1;\n    for (i=2;i<limit;i++) inv[i]=p-(ll)p/i*inv[p%i]%p;\n}\ninline void reverse(int limit,int *f)\n{\n    int lim=limit>>1;\n    for (i=0;i<lim;i++) swap(f[i],f[limit-i-1]);\n}\ninline void dao(int *a,int n)\n{\n    for (i=1;i<n;i++) a[i-1]=(ll)a[i]*i%p;a[n-1]=0;\n}\ninline void ji(int *a,int n)\n{\n    for (i=n-1;~i;i--) a[i+1]=(ll)a[i]*inv[i+1]%p;\n    a[0]=0;\n}\nvoid dft(int *a,int xs,int limit)\n{\n    int i,j,k,l,w,wn,b,c;\n    for (i=1;i<limit;i++) if (i<r[i]) swap(a[i],a[r[i]]);\n    for (i=1;i<limit;i=l)\n    {\n        l=i<<1;\n        if (xs) wn=ig[l]; else wn=yg[l];\n        for (j=0;j<limit;j+=l)\n        {\n            w=1;\n            for (k=0;k<i;k++,w=(ll)w*wn%p)\n            {\n                b=a[j|k];c=(ll)w*a[j|k|i]%p;\n                a[j|k]=(b+c)%p;\n                a[j|k|i]=(b-c+p)%p;\n            }\n        }\n    }\n    if (xs)\n    {\n        limit=ksm(limit,p-2);\n        for (i=0;i<xs;i++) a[i]=(ll)a[i]*limit%p;\n    }\n}\nvoid polymultiply(int *f,int *g,int limit)\n{\n    int i;\n    dft(f,0,limit<<1);dft(g,0,limit<<1); \n    for (i=0;i<limit<<1;i++) f[i]=(ll)f[i]*g[i]%p;\n    dft(f,limit,limit<<1);\n}\nvoid polyinv(int *f,int *g,int biglim)\n{\n    int i,j,l=1,limit;\n    memset(g,0,biglim<<3);\n    memset(invf,0,biglim<<3);\n    g[0]=ksm(f[0],p-2);\n    for (i=2;i<=biglim;i=limit,l++)\n    {\n        limit=i<<1;\n        memcpy(invf,f,limit<<1);\n        for (j=1;j<limit;j++) r[j]=r[j>>1]>>1|(j&1)<<l;\n        dft(invf,0,limit);dft(g,0,limit);\n        for (j=0;j<limit;j++) g[j]=(ll)g[j]*(p+2-(ll)g[j]*invf[j]%p)%p;\n        dft(g,i,limit);\n        memset(g+i,0,limit<<1);\n    }\n}\nvoid polysqrt(int *f,int *g,int biglim)//\u4e0d\u52a8f\n{\n    memset(sqrtf,0,biglim<<3);\n    memset(sqrtg,0,biglim<<3);\n    memset(g,0,biglim<<3);\n    int i,j,l=1,limit;\n    g[0]=mosqrt(f[0]);\n    if ((ll)g[0]*g[0]%p!=f[0]) while (1);\n    for (i=2;i<=biglim;i=limit,l++)\n    {\n        limit=i<<1;\n        polyinv(g,sqrtg,i);\n        memcpy(sqrtf,f,limit<<1);\n        dft(sqrtf,0,limit);dft(sqrtg,0,limit);dft(g,0,limit);\n        for (j=0;j<limit;j++)\n        {\n            g[j]=(ll)sqrtg[j]*((ll)g[j]*g[j]%p+sqrtf[j])%p;\n            if (g[j]&1) g[j]=g[j]+p>>1; else g[j]>>=1;\n        }\n        dft(g,i,limit);\n        memset(g+i,0,limit<<1);\n    }\n}\n/*void polycdq(int l,int r,int *f,int *g)\n{\n    if (l==r) return;\n    int mid=l+r>>1;\n    polycdq(l,mid,f,g);\n    int i,limit,li,siz=r-l;\n    limit=1;li=-1;\n    while (limit<=siz)\n    {\n        limit<<=1;++li;\n    }\n    for (i=l;i<=mid;i++) cdqf[i-l]=f[i];\n    for (i=mid-l+1;i<lim;i++) cdqf[i]=0;\n    for (i=1;i<=r-l;i++) cdqg[i]=g[i];G[0]=0;\n    for (i=r-l+1;i<lim;i++) cdqg[i]=0;\n    polymultiply(cdqf,cdqg,li,limit);\n    for (i=mid+1;i<=r;i++)\n    {\n        f[i]+=cdqf[i-l];\n        if (f[i]>=p) f[i]-=p;\n    }\n    polycdq(mid+1,r,f,g);\n}*/\nvoid polydivide(int *f,int *g,int *q,int *r,int limit)\n{\n\n}\nvoid polyln(int *f,int *g,int biglim)\n{\n    int i,limit=biglim<<1;\n    memcpy(lnf,f,biglim<<2);\n    memset(lnf+biglim,0,biglim<<2);\n    polyinv(f,g,biglim);\n    dao(lnf,biglim);\n    dft(lnf,0,limit);dft(g,0,limit);\n    for (i=0;i<limit;i++) g[i]=(ll)g[i]*lnf[i]%p;\n    dft(g,biglim,limit);\n    memset(g+biglim,0,biglim<<2);\n    ji(g,biglim);\n}\nvoid polyexp(int *f,int *g,int biglim)\n{\n    memset(g,0,biglim<<3);\n    memset(expf,0,biglim<<3);\n    memset(expg,0,biglim<<3);\n    g[0]=1;\n    int i,j,l=1,limit;\n    for (i=2;i<=biglim;i=limit,l++)\n    {\n        limit=i<<1;\n        memcpy(expf,f,limit<<1);\n        polyln(g,expg,i);\n        dft(expf,0,limit);dft(g,0,limit);dft(expg,0,limit);\n        for (j=0;j<limit;j++) g[j]=(ll)g[j]*(1+expf[j]-expg[j]+p)%p;\n        dft(g,i,limit);\n        memset(g+i,0,limit<<1);\n    }\n}\nvoid polyksm1(int *f,int *g,int biglim,int cs)\n{\n    if (cs==0)\n    {\n        g[0]=1;\n        return;\n    }\n    int i,j,k=1,wy=0;\n    if (f[0]==0)\n    {\n        for (i=1;i<biglim;i++) if (f[i]) break;\n        for (j=0;j<biglim-i;j++) f[j]=f[j+i];\n        memset(f+biglim-i,0,i<<2);\n        if ((ll)i*cs>=biglim) return;\n        wy=i*cs;\n    }\n    if (f[0]>1)\n    {\n        k=ksm(f[0],p-2);\n        for (i=1;i<biglim;i++) f[i]=(ll)f[i]*k%p;\n        k=ksm(f[0],cs);f[0]=1;\n    }\n    polyln(f,ksmf,biglim);\n    for (i=0;i<biglim;i++) ksmf[i]=(ll)ksmf[i]*cs%p;\n    polyexp(ksmf,g,biglim);\n    if (k!=1)\n    {\n        for (i=0;i<biglim;i++) g[i]=(ll)g[i]*k%p;\n    }\n    if (wy)\n    {\n        for (i=biglim-1;i>=wy;i--) g[i]=g[i-wy];\n        memset(g,0,wy<<2);  \n    }\n}\nvoid polyksm2(int *f,int *g,int biglim,int cs)\n{\n    int limit=1,i,l=-1;\n    while (limit<=biglim)\n    {\n        limit<<=1;++l;\n    }\n    for (i=1;i<limit;i++) r[i]=r[i>>1]>>1|(i&1)<<l;g[0]=1;\n    while (cs)\n    {\n        if (cs&1)\n        {\n            memcpy(ksmf,f,biglim<<2);\n            memset(ksmf+biglim,0,biglim<<2);\n            polymultiply(g,ksmf,biglim);\n            memset(g+biglim,0,biglim<<2);\n        }\n        dft(f,0,limit);\n        for (i=0;i<limit;i++) f[i]=(ll)f[i]*f[i]%p;\n        dft(f,biglim,limit);\n        memset(f+biglim,0,biglim<<2);\n        cs>>=1;\n    }\n}\nvoid polyksm3(int *f,int *g,int biglim,int cs)\n{\n    int i;\n    memset(ksmf,0,biglim<<3);\n    memset(g,0,biglim<<3);\n    polyln(f,ksmf,biglim);\n    for (i=0;i<biglim;i++) ksmf[i]=(ll)ksmf[i]*cs%p;\n    polyexp(ksmf,g,biglim);\n}\nint main()\n{\n    read(n);readd(m);\n    limit=1;\n    while (limit<n) limit<<=1;\n    for (i=0;i<n;i++) read(f[i]);gg(limit<<1);\n    polyksm1(f,g,limit,m);\n    for (i=0;i<n;i++) printf(\"%d \",g[i]);\n}\n```\n",
        "postTime": 1551879634,
        "uid": 29826,
        "name": "SSerxhs",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5245 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u3011"
    },
    {
        "content": "\u76f4\u63a5 [$Ln$](https://www.luogu.org/problemnew/show/P4725) \u540e\u7cfb\u6570\u4e58 $k$ \u518d [$Exp$](https://www.luogu.org/problemnew/show/P4726) \u5373\u53ef\u3002 $k$ \u53ef\u4ee5\u76f4\u63a5\u819c $mod$ \u3002\n\n\u590d\u6742\u5ea6 $O(n\\log n)$ \u3002\n\n\u4f60\u4e5f\u53ef\u4ee5\u5199\u4e00\u4e2a\u5feb\u901f\u5e42\uff0c\u7ec3\u4e60\u4e00\u4e0b\u5361\u5e38\u3002\u8fd9\u91cc\u7684 $k$ \u9700\u8981\u819c $mod-1$ \u3002\n\n\u590d\u6742\u5ea6 $O(n\\log n\\log mod)$ \u3002",
        "postTime": 1551860745,
        "uid": 7035,
        "name": "Great_Influence",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5245 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u3011"
    },
    {
        "content": "### \u9898\u76ee\u5927\u610f\n\u7ed9\u5b9a $n-1$ \u6b21\u591a\u9879\u5f0f $g(x)$ \uff0c\u6c42\u591a\u9879\u5f0f $f(x)$ \u6ee1\u8db3\uff1a\n\n$f(x)\\equiv g^k(x)$ $(mod$ $x^n)$\n\n\u7cfb\u6570\u5bf9 $998244353$ \u53d6\u6a21\u3002\n\n\u6570\u636e\u8303\u56f4 $1\\leq n\\leq 10^5$ \uff0c $1\\leq k\\leq 10^{10^5}$ \u3002\n\n### \u524d\u7f6e\u829d\u58eb\uff1a\n\u591a\u9879\u5f0f $\\ln$ \uff0c\u591a\u9879\u5f0f $\\exp$ \uff0c~~\u975e\u5e38\u5165\u95e8\u7684~~\u6c42\u5bfc\uff0c\u79ef\u5206\u548c\u6076\u4fd7\u7684\u725b\u987f\u8fed\u4ee3\u3002\n\n\u7b2c\u4e00\u4e2a\u4e0d\u4f1a\u51fa\u95e8\u5de6\u62d0\uff0c\u6700\u540e\u4e24\u4e2a\u7684\u8bdd\uff0c\u8fd9\u91cc\u53ea\u8981\uff1a\n\n\u6c42\u5bfc\u516c\u5f0f $\\mathrm{d}$ $x^{a}=ax^{a-1}$ \u3002\n\n\u6c42\u5bfc\u6cd5\u5219 $\\mathrm{d}$ $f[g(x)]=f^{'}[g(x)]\\cdot g^{'}(x)$ \u3002\n\n\u79ef\u5206\u516c\u5f0f $\\int x^a=\\frac{1}{a+1}x^{a+1}$ \u3002\n\n\u725b\u987f\u8fed\u4ee3\u7684\u8bdd\uff0c\u73c2\u4ee5\u770b\u770b[\u6211\u7684\u6587\u7ae0](https://www.luogu.com.cn/blog/ngzzgzz/yi-ge-niu-dun-die-dai-hao-xiang-bi-jiao-neng-dong-di-li-xie)\uff08\u867d\u7136\u4e0d\u548b\u5730\u3002\u3002\uff09\uff0c\u5927\u6982\u4e86\u89e3\u4e00\u4e0b\u539f\u7406\u5c31\u597d\n\n### solution\n\u5bf9\u4e8e\u591a\u9879\u5f0f\u521a\u521a\u6760\u5230\u8fd9\u9898\u7684\u6211\u4eec\u6765\u8bf4\uff0c $k$ \u6b21\u5e42\u5b9e\u5728\u6709\u70b9\u964c\u751f\uff0c\u4f46\u3002\u3002\u3002\n\n\u7b97\u4e86\u770b\u5f0f\u5b50\u5427\uff0c\n\n$f(x)\\equiv g^k(x)$ $(mod$ $x^n)$\n\n\u4f17\u6240\u5468\u77e5\u201c\u7529\u8111\u58f3\u516c\u5f0f\u201d\uff1a\n\n$\\ln{g^n(x)}=n\\cdot\\ln{g(x)}$\n\n\u518d\u770b\u5230\u539f\u5f0f\uff0c\u6709\u90a3\u4e48\u4e00\u90e8\u5206\u76f8\u540c\uff0c\u4e8e\u662f\u73c2\u4ee5\u7c7b\u6bd4\uff0c\u6211\u4eec\u5c06\u539f\u5f0f\u4e24\u8fb9\u540c\u65f6\u53d6 $\\ln$ \uff0c\u5f97\u5230\uff1a\n\n$\\ln{f(x)}\\equiv k\\cdot\\ln{g(x)}$ $(mod$ $x^n)$\n\n\u6ce8\u610f\u4e0a\u5f0f $k$ \u662f\u4f5c\u4e3a\u4e00\u4e2a\u7cfb\u6570\u5b58\u5728\u7684\uff0c\u6240\u4ee5\u6839\u636e\u9898\u610f\uff0c\u5728\u8ba1\u7b97\u7684\u65f6\u5019 $k$ \u662f\u53ef\u4ee5\u76f4\u63a5\u5bf9\u6a21\u6570\u53d6\u6a21\u3002~~\u6240\u4ee5\u53ea\u8981\u6570\u7ec4\u5b58\u7684\u4e0b\uff0c\u518d\u5927\u90fd\u4e0d\u614c~~\n\n\u56e0\u6b64\uff0c\u7528\u6c42 $\\ln$ \u7684\u505a\u6cd5\u5c31\u53ef\u4ee5\u5f97\u5230\u5de6\u8fb9\u7684 $\\ln{f(x)}$ ,\u518d\u5bf9\u5176\u8ba1\u7b97 $\\exp$ \u5373\u53ef\u3002\n\n\uff08\u6ce8\uff1a\u7531\u4e8e $k$ \u8fc7\u5927\uff0c\u9700\u8981\u8fb9\u8bfb\u5165\u8fb9\u53d6\u6a21\uff09\n\n~~\uff08\u5f53\u7136\u4f60\u8981\u53d6\u5b8c\u819c\u540e\u76f4\u63a5\u500d\u589e\u6211\u4e5f\u6ca1\u529e\u6cd5\uff09~~\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log_{2}{n})$ \u3002\n\n\u4eba\u50bb\u5e38\u719f\u5927 wtcl \u3002\u3002\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N=4e5+10;\ntypedef ll arr[N];\nconst int mod=998244353;\nconst int inv3=332748118;\nint n,k,inv,lim=1,fre,id[N];\narr f,g,h,ans,tmp,ln;\ninline ll inc(ll x,ll y){return x+y>=mod?x+y-mod:x+y;}\ninline ll dec(ll x,ll y){return x-y<0?x-y+mod:x-y;}\ninline ll mul(ll x,ll y){return 1ll*x*y%mod;}\ninline int read()\n{\n\tint s=0,w=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9') s=s*10+ch-'0',ch=getchar();\n\treturn s*w;\n}\ninline int ksm(int a,int b)\n{\n\tint tmp=1;\n\twhile(b)\n\t{\n\t\tif(b&1)tmp=(1ll*tmp*a)%mod;\n\t\tb>>=1,a=(1ll*a*a)%mod;\n\t}\n\treturn tmp;\n}\ninline void Never_Tell_TLE(ll* NTT,int sign)\n{\n\tfor(int i=0;i<=lim;++i)if(i<id[i])\n\t{\n\t\tll NTt=NTT[i];\n\t\tNTT[i]=NTT[id[i]];\n\t\tNTT[id[i]]=NTt;\n\t}\n\tfor(int mid=1;mid<lim;mid<<=1)\n\t{\n\t\tint Unit_root;\n\t\tif(sign==1)Unit_root=ksm(3,(mod-1)/(mid<<1));\n\t\telse Unit_root=ksm(inv3,(mod-1)/(mid<<1));\n\t\tfor(int R=mid<<1,r=0;r<lim;r+=R)\n\t\t{\n\t\t\tint pw=1;\n\t\t\tfor(int l=0;l<mid;++l,pw=(1ll*pw*Unit_root)%mod)\n\t\t\t{\n\t\t\t\tint butt=NTT[l+r],rfly=(1ll*pw*NTT[l+r+mid])%mod;\n\t\t\t\tNTT[l+r]=inc(butt,rfly);\n\t\t\t\tNTT[l+r+mid]=dec(butt,rfly);\n\t\t\t}\n\t\t}\n\t}\n\tif(sign==-1)\n\t{\n\t\tint inv_lim=ksm(lim,mod-2);\n\t\tfor(int i=0;i<=lim;++i)NTT[i]=(1ll*NTT[i]*inv_lim)%mod;\n\t}\n}\ninline void Derivation(ll* F,ll* G,int nm)\n{\n\tfor(int i=1;i<nm;++i)\n\tG[i-1]=mul(1ll*i,F[i]);\n\tG[nm-1]=0;\n}\ninline void Inv(ll* F,ll* G,int nm)\n{\n\tif(nm==1)\n\t{\n\t\tG[0]=ksm(F[0],mod-2);\n\t\treturn;\n\t}\n\tInv(F,G,(nm+1)>>1);\n\tlim=1,fre=0;\n\tfor(;lim<(nm<<1);lim<<=1)++fre;\n\tfor(int i=0;i<=lim;++i)id[i]=(id[i>>1]>>1)|((i&1)<<(fre-1));\n\tfor(int i=0;i<nm;++i)ans[i]=F[i];\n\tfor(int i=nm;i<=lim;++i)ans[i]=0;\n\tNever_Tell_TLE(ans,1),Never_Tell_TLE(G,1);\n\tfor(int i=0;i<=lim;++i)G[i]=mul(inc(2ll,-mul(ans[i],G[i])+mod),G[i]);\n\tNever_Tell_TLE(G,-1);\n\tfor(int i=nm;i<=lim;++i)G[i]=0;\n}\ninline void Mul(ll* F,ll* G,int nm)\n{\n\tlim=1,fre=0;\n\tfor(;lim<(nm<<1);lim<<=1)++fre;\n\tfor(int i=0;i<=lim;++i)id[i]=(id[i>>1]>>1)|((i&1)<<(fre-1));\n\tint inv_lim=ksm(lim,mod-2);\n\tNever_Tell_TLE(G,1),Never_Tell_TLE(F,1);\n\tfor(int i=0;i<=lim;++i)G[i]=mul(F[i],G[i]);\n\tNever_Tell_TLE(G,-1);\n}\ninline void Integral(ll* F,ll* G,int nm)\n{\n\tfor(int i=1;i<nm;++i)\n\tG[i]=mul(F[i-1],ksm(i,mod-2));\n\tG[0]=0;\n}\ninline void Ln(ll* F,ll* G,int nm)\n{\n\tInv(F,tmp,nm);\n\tfor(int i=0;i<=lim;++i)ans[i]=0;\n\tDerivation(F,ans,nm);\n\tMul(tmp,ans,nm);\n\tIntegral(ans,G,nm);\n\tfor(int i=0;i<=lim;++i)ans[i]=tmp[i]=0;\n}\ninline void solve(ll* F,ll* G,int nm)\n{\n\tif(nm==1)\n\t{\n\t\tG[0]=1;\n\t\treturn;\n\t}\n\tsolve(F,G,(nm+1)>>1);\n\tlim=1,fre=0;\n\tfor(;lim<(nm<<1);lim<<=1)++fre;\n\tfor(int i=0;i<=lim;++i)id[i]=(id[i>>1]>>1)|((i&1)<<(fre-1));\n\tfor(int i=0;i<=lim;++i)ln[i]=0;\n\tLn(G,ln,nm);\n\tfor(int i=0;i<nm;++i)ans[i]=F[i];\n\tfor(int i=nm;i<=lim;++i)ans[i]=0;\n\tNever_Tell_TLE(ans,1),Never_Tell_TLE(G,1),Never_Tell_TLE(ln,1);\n\tfor(int i=0;i<=lim;++i)G[i]=mul(inc(1ll,inc(ans[i],-ln[i]+mod)),G[i]);\n\tNever_Tell_TLE(G,-1);\n\tfor(int i=nm;i<=lim;++i)G[i]=0;\n}\nint main()\n{\n\tn=read();\n\tint c=getchar();while(isspace(c))c=getchar();\n\tfor(;isdigit(c);c=getchar())k=(k*10LL+(c^'0'))%mod;\n\tfor(int i=0;i<n;++i)f[i]=read();\n\tLn(f,g,n);\n\tfor(int i=0;i<=lim;++i)g[i]=mul(g[i],k);\n\tsolve(g,h,n);\n\tfor(int i=0;i<n;++i)printf(\"%d \",h[i]);\n\tgetchar();\n\treturn 0;\n}\n```\n\u53ea\u6c42\u80fd\u5e2e\u52a9\u5230\u51e0\u4e2a\u4eba\u7f62\u3002\u3002",
        "postTime": 1617505753,
        "uid": 206024,
        "name": "Illusory_dimes",
        "ccfLevel": 7,
        "title": "\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5feb\u901f\u5e42 \u9898\u89e3"
    }
]
[
    {
        "content": "\u7531\u4e8e Latex \u6302\u4e86\uff0c\u5efa\u8bae\u5230 Luogu \u535a\u5ba2\u6216\u8005 [\u8fd9\u91cc](https://www.yijan.co/noiol-t3-match/) \u67e5\u770b\u3002\n\n\u6211\u4eec\u8bb0 \u201c\u6070\u597d\u6709 $k$ \u6b21\u975e\u5e73\u5c40\u201d \u7684\u65b9\u6848\u6570\u662f $g(k)$ \uff0c\u201c\u94a6\u5b9a\u6709 $k$ \u6b21\u975e\u5e73\u5c40\u201d \u7684\u65b9\u6848\u6570\u662f $f(k)$ \u3002\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u4e8c\u9879\u5f0f\u53cd\u6f14\u7684\u5f62\u5f0f\uff0c\u7531\u4e8c\u9879\u5f0f\u53cd\u6f14\u6709\u516c\u5f0f\uff1a\uff08\u4e0d\u4f1a\u53ef\u4ee5\u767e\u5ea6\uff09\n$$\nf(n)=\\sum\\limits_{i=n}^m{i\\choose n}g(i)\\Leftrightarrow g(n)=\\sum\\limits_{i=n}^m(-1)^{i-n}{i\\choose n}f(i)\n$$\n\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u6c42\u51fa $f(k)$ \u5c31\u505a\u5b8c\u4e86\u8fd9\u4e2a\u9898\u3002\u6211\u4eec\u53ef\u4ee5 dp \u6c42\u51fa $f$ \uff0c\u8bbe $dp[u][x]$ \u8868\u793a $u$ \u5b50\u6811\u5185\u94a6\u5b9a\u9009\u62e9\u4e86 $x$ \u5bf9\u70b9\uff0c\u8fd9 $x$ \u5bf9\u70b9\u5747\u5448 \u7956\u5148 - \u5b50\u5b59 \u7684\u5173\u7cfb\uff08\u4e5f\u5c31\u662f\u8fd9 $x$ \u5c40\u94a6\u5b9a\u4f1a\u6bd4\u51fa\u80dc\u8d1f\uff09\u3002\u4e8e\u662f\u53d1\u73b0\u8fd9\u4e1c\u897f\u53ef\u4ee5\u76f4\u63a5\u6811\u5f62\u80cc\u5305\u7b97\u3002\n\n\u8f6c\u79fb\u5c31\u662f\u6b63\u5e38\u7684\u6811\u5f62\u80cc\u5305\uff0c\u6700\u540e\u8fd8\u9700\u8981\u8003\u8651\u94a6\u5b9a\u8fd9\u4e2a\u70b9\u548c\u67d0\u4e2a\u540e\u4ee3\u7684\u60c5\u51b5\uff0c\u8fd9\u79cd\u60c5\u51b5\u7684\u8f6c\u79fb\u5c31\u662f\u4ece\u5b50\u6811\u5185\u672a\u88ab\u94a6\u5b9a\u7684\u70b9\u4e2d\u9009\u62e9\u4e00\u4e2a\u70b9\u3002\n\n\u7136\u540e\u6211\u4ea4\u4e0a\u53bb\u7684\u4ee3\u7801\u591a\u8f93\u51fa\u4e86\u4e2a $0$ \u8003\u8bd5\u7684\u65f6\u5019\u6ca1\u770b\u5230 /kk\n\n```cpp\n#include \"iostream\"\n#include \"algorithm\"\n#include \"cstring\"\n#include \"cstdio\"\n#include \"cmath\"\n#include \"vector\"\n#include \"map\"\n#include \"set\"\n#include \"queue\"\nusing namespace std;\n#define MAXN 5006\n//#define int long long\n#define rep(i, a, b) for (int i = (a), i##end = (b); i <= i##end; ++i)\n#define per(i, a, b) for (int i = (a), i##end = (b); i >= i##end; --i)\n#define pii pair<int,int>\n#define fi first\n#define se second\n#define mp make_pair\n#define pb push_back\n#define eb emplace_back\n#define vi vector<int>\n#define all(x) (x).begin() , (x).end()\n#define mem( a ) memset( a , 0 , sizeof a )\ntypedef long long ll;\n#define P 998244353\nint n;\nint A[MAXN];\n\nint head[MAXN] , to[MAXN << 1] , nex[MAXN << 1] , ecn;\nvoid ade( int u , int v ) {\n    to[++ ecn] = v , nex[ecn] = head[u] , head[u] = ecn;\n}\n\nint dp[MAXN][MAXN] , siz[MAXN] , sz[MAXN];\nint pd[MAXN];\nvoid dfs( int u , int fa ) {\n    siz[u] = 1 , sz[u] = A[u];\n    dp[u][0] = 1;\n    for( int i = head[u] , v ; i ; i = nex[i] ) {\n        v = to[i];\n        if( v == fa ) continue;\n        dfs( v , u );\n        rep( k , 0 , siz[u] + siz[v] ) pd[k] = 0;\n        rep( j , 0 , min( siz[u] , n / 2 ) ) if( dp[u][j] )\n            rep( k , 0 , min( siz[v] , n / 2 - j ) ) if( dp[v][k] )\n                pd[j + k] = ( pd[j + k] + dp[u][j] * 1ll * dp[v][k] % P ) % P;\n        rep( k , 0 , siz[u] + siz[v] ) dp[u][k] = pd[k];\n        siz[u] += siz[v] , sz[u] += sz[v];\n    }\n    per( i , min( sz[u] , siz[u] - sz[u] ) , 1 ) dp[u][i] = ( dp[u][i] + dp[u][i - 1] * 1ll * ( ( A[u] ? ( siz[u] - sz[u] ) : ( sz[u] ) ) - ( i - 1 ) ) % P ) % P;\n}\n\nint J[MAXN] , iJ[MAXN];\nint Pow( int x , int a ) {\n    int ret = 1;\n    while( a ) {\n        if( a & 1 ) ret = 1ll * ret * x % P;\n        x = 1ll * x * x % P , a >>= 1;\n    }\n    return ret;\n}\nint C( int a , int b ) {\n    return J[a] * 1ll * iJ[b] % P * iJ[a - b] % P;\n}\n\nvoid solve() {\n    cin >> n;\n    J[0] = iJ[0] = 1;\n    rep( i , 1 , MAXN - 1 ) J[i] = J[i - 1] * 1ll * i % P , iJ[i] = Pow( J[i] , P - 2 );\n    rep( i , 1 , n )\n        scanf(\"%1d\",A + i);\n    int u , v;\n    rep( i , 2 , n ) scanf(\"%d%d\",&u,&v) , ade( u , v ) , ade( v , u );\n    dfs( 1 , 1 );\n    int re = 0;\n    rep( i , 0 , n / 2 + 1 ) dp[1][i] = dp[1][i] * 1ll * J[n / 2 - i] % P;\n    rep( i , 0 , n / 2 ) {\n        re = 0;\n        rep( j , i , n / 2 )\n            re += C( j , i ) * 1ll * ( ( j - i & 1 ) ? P - 1 : 1 ) % P * dp[1][j] % P , re %= P;\n        printf(\"%d \",re);\n    }\n}\n\nsigned main() {\n//    freopen(\"match.in\",\"r\",stdin);\n//    freopen(\"match.out\",\"w\",stdout);\n//    int T;cin >> T;while( T-- ) solve();\n    solve();\n}\n\n\n```\n\n\n\n",
        "postTime": 1587788868,
        "uid": 63398,
        "name": "yijan",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P6478 \u3010[NOI Online 2 \u63d0\u9ad8\u7ec4]\u6e38\u620fmatch\uff08\u6682\u65e0\u6570\u636e\uff0c\u7981\u6b62\u63d0\u4ea4\uff09\u3011"
    },
    {
        "content": "\u4e0d\u77e5\u9053\u600e\u4e48\u516c\u5f0f\u6e32\u67d3\u70b8\u4e86\u2026\u2026\u53ef\u80fd\u662f\u4e0d\u652f\u6301\u4e24\u4e2a\u7f8e\u5143\u7684\u516c\u5f0f\u5427\uff08\u5df2\u5c3d\u529b\u4fee\u6539\uff09\u2026\u2026\u53ef\u4ee5\u624b\u52a8\u8fdb\u5165[\u535a\u5ba2](https://www.luogu.com.cn/blog/wageneral/solution-p6478)\u770b\u770b\u3002\uff08\u9020\u6210\u7684\u4e0d\u4fbf\u656c\u8bf7\u8c05\u89e3\uff09\n\n\u5148\u5b89\u5229\u4e00\u4e2a\u4e8c\u9879\u5f0f\u53cd\u6f14\u7684\u516c\u5f0f\uff1a\n\n$g(k)=\\sum_{i=k}^nC_i^k\\cdot f(i)$ \u7b49\u4ef7\u4e8e $f(i)=\\sum_{k=i}^n(-1)^{k-i}\\cdot C_k^i\\cdot g(k)$\n\n**\u6ce8\uff1a\u5341\u5206\u62b1\u6b49\uff0c\u8fd9\u4e2a\u516c\u5f0f\u4e4b\u524d\u662f\u9519\u7684\uff0c\u8bf7\u6ce8\u610f\u53f3\u4fa7 $(-1)$ \u7684\u6307\u6570\u662f $(k-i)$\uff0c\u4e0e $n$ \u662f\u65e0\u5173\u7684\uff0c\u5b9e\u9645\u4e0a\u8fd9\u91cc\u7684 $n$ \u662f\u53ef\u4ee5\u679a\u4e3e\u5230\u6b63\u65e0\u7a77\u7684\u3002**\n\n\u4e0d\u4f1a\u8bc1\u660e\uff0c\u4f46\u662f\u4f1a\u7528\u5c31\u884c\u3002\n\n\u8fd9\u4e2a\u9898\u5148\u8bbe $f[i][j]$ \u8868\u793a $i$ \u5b50\u6811\u5185\uff0c\u975e\u5e73\u5c40\u5bf9\u4e3a $j$ \u5bf9\u7684\u65b9\u6848\u6570\u3002\n\n\u8003\u8651\u600e\u4e48\u8f6c\u79fb\uff0c\u5148\u4e0d\u8003\u8651 $i$\uff0c\u53ea\u8003\u8651\u5b83\u7684\u5b50\u6811\uff0c\u90a3\u4e48\u65b9\u6848\u6570\u5c31\u662f\n\n$f[i][j]=\\sum_{k_1+k_2+...+k_n=j} f[son_1][k_1]\\times f[son_2][k_2] \\times...\\times f[son_n][k_n]$\n\n\u76f4\u63a5\u679a\u4e3e\u663e\u7136\u4e0d\u884c\uff0c\u8003\u8651\u6bcf\u904d\u5386\u4e00\u68f5\u5b50\u6811\u5c31\u628a\u7b54\u6848\u5e76\u8fdb\u53bb\uff0c\u90a3\u4e48\u5c31\u662f $f[i][j+k]=\\sum_{son}f[son][j]\\times f[i][k]$ \u3002\n\n\u8fd9\u4e2a\u5f0f\u5b50\u4e4d\u4e00\u770b\u662f $n^3$ \u7684\uff0c\u4f46\u662f\u5982\u679c\u5361 $j,k$ \u7684\u4e0a\u754c\u5c31\u4f1a\u53d8\u6210 $n^2$\uff0c\u7c97\u7565\u7684\u8bc1\u660e\u662f\u6bcf\u4e2a\u70b9\u5bf9 $(x,y)$ \u53ea\u4f1a\u5728 $\\text{LCA}(x,y)$ \u6709\u4e00\u4e2a\u590d\u6742\u5ea6\u7684\u8d21\u732e\u3002\u5177\u4f53\u7684\u8bc1\u660e\u53ef\u4ee5\u95ee\u95ee\u767e\u5ea6\u3002\uff08\u6211\u4e5f\u4e0d\u8bb0\u5f97\u662f\u4ec0\u4e48\u65f6\u5019\u770b\u5230\u8fc7\u8fd9\u4e2a\u4e1c\u897f\u4e86\uff09\n\n\u6700\u540e\u7684\u65f6\u5019\u518d\u628a $i$ \u4e2a\u8d21\u732e\u52a0\u8fdb\u53bb\uff0c\u5206\u522b\u8bbe $A[i],B[i]$ \u4e3a $i$ \u5b50\u6811\u5185\u5c0f A/B \u7684\u8282\u70b9\u4e2a\u6570\uff0c\u5047\u8bbe\u5f53\u524d\u8282\u70b9\u662f\u5c0f A \u7684\u8282\u70b9\uff0c\u90a3\u4e48\u5c31\u6709 $f[i][j]=f[i][j]+f[i][j-1]\\times \\max((B[i]-(j-1),0)$ \u3002\u5373\u4e4b\u524d\u6709 $j-1$ \u4e2a\u975e\u5e73\u5c40\u5bf9\uff0c\u90a3\u4e48\u5c31\u4f1a\u6d88\u8017\u6389 $j-1$ \u4e2a\u5c0f B \u7684\u8282\u70b9\uff0c\u6240\u4ee5\u73b0\u5728\u8fd8\u5269 $B[i]-(j-1)$ \u4e2a\u5c0f B \u7684\u8282\u70b9\u53ef\u7528\u3002\u7c7b\u4f3c\u7684\uff0c\u5982\u679c\u5f53\u524d\u7684\u8282\u70b9\u662f\u5c0f B \u7684\u8282\u70b9\u5c31\u628a\u4e0a\u6587\u7684 $B$ \u6362\u6210 $A$ \u5373\u53ef\u3002\n\n\u81f3\u6b64\u6211\u4eec\u5c31\u53ef\u4ee5\u5728 $n^2$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u7b97\u51fa\u6240\u6709\u5b50\u6811\u5185\u9009 $k$ \u4e2a\u975e\u5e73\u5c40\u5bf9\u7684\u65b9\u6848\u6570\u3002\n\n\u6211\u4eec\u5148\u8bbe $G(k)=f[1][k]\\times (\\frac{n}{2}-k)!$\uff0c\u4e5f\u5c31\u662f\u8bf4\u5148\u56fa\u5b9a\u9009\u51fa\u6765\u7684 $k$ \u4e2a\u975e\u5e73\u5c40\u5bf9\uff0c\u7136\u540e\u628a\u5269\u4e0b\u7684\u81ea\u7531\u7ec4\u5408\u3002\n\n\u4f46\u662f\u8fd9\u6837\u5b50\u4f1a\u7b97\u91cd\uff0c\u56e0\u4e3a\u81ea\u7531\u7ec4\u5408\u4e5f\u53ef\u80fd\u8d21\u732e\u975e\u5e73\u5c40\u5bf9\u3002\u6211\u4eec\u8bbe $H(i)$ \u8868\u793a\u6070\u597d\u6709 $i$ \u4e2a\u975e\u5e73\u5c40\u5bf9\u7684\u65b9\u6848\u6570\uff0c\u53ef\u4ee5\u53d1\u73b0\u5bf9\u4e8e\u6bcf\u4e2a $H(i)$\uff0c\u5b83\u5bf9 $G(k)$ \u7684\u8d21\u732e\u662f $C_i^k\\times H(i)$\u3002\n\n\u4e3e\u4e2a\u6817\u5b50\uff0c\u5047\u8bbe $i=4,k=3$ \u8bbe\u8fd9 $i$ \u4e2a\u975e\u5e73\u5c40\u5bf9\u7684\u7f16\u53f7\u4e3a $1,2,3,4$\uff0c\u90a3\u4e48\u5c31\u6709\u53ef\u80fd $1,2,3$ \u88ab\u8ba1\u7b97\u5728 $f[1][k]$ \u5185\uff0c$4$ \u662f\u81ea\u7531\u7ec4\u5408\u51fa\u6765\u7684\uff1b\u4e5f\u53ef\u80fd\u662f $1,2,4$ \u88ab\u8ba1\u7b97\u5728 $f[1][k]$ \u5185\uff0c$3$ \u662f\u81ea\u7531\u7ec4\u5408\u51fa\u6765\u7684\u2026\u2026\u5373\u4e00\u5171\u6709 $C_i^k$ \u79cd\u60c5\u51b5\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u6709 $G(k)=\\sum_{i=k}^m C_i^k\\cdot H(i) $\uff0c\u56de\u5230\u4e00\u5f00\u59cb\u63d0\u5230\u7684\u4e8c\u9879\u5f0f\u53cd\u6f14\uff0c\u5957\u8fdb\u53bb\u5c31\u53ef\u4ee5\u8ba1\u7b97\u5f97\u5230 $H(i)$ \u3002\n\n\u4e0d\u592a\u4f1a\u8bc1\u660e\u4e3a\u4ec0\u4e48\u53ef\u4ee5\u8fd9\u6837\uff0c\u6211\u53ea\u80fd\u901a\u8fc7\u8fd9\u79cd\u5957\u5f0f\u5b50\u7684\u65b9\u6cd5\u6765\u505a\uff0c\u800c\u4e14\u6211\u8ba4\u4e3a $G(k)$ \u662f\u6ca1\u6709\u5b9e\u9645\u542b\u4e49\u7684\uff0c\u53ea\u662f\u4e00\u4e2a\u7528\u6765\u53cd\u6f14\u7684\u5de5\u5177\u3002\uff08\u6bd5\u7adf\u8bf4\u5b83\u662f\u81f3\u5c11 $k$ \u4e2a\u975e\u5e73\u5c40\u5bf9\u8fc7\u4e8e\u7275\u5f3a\uff0c\u56e0\u4e3a\u5355\u62ff\u6070\u597d $k+1$ \u4e2a\u975e\u5e73\u5c40\u5bf9\u6765\u770b\uff0c\u5c31\u4f1a\u88ab\u7b97\u8fdb\u53bb $k+1$ \u6b21\uff09\n\n\u4ee3\u7801\u5982\u4e0b\uff1a~~\u8003\u573a\u4ee3\u7801\u6c42\u8f7b\u55b7~~\n\n```cpp\n#include <bits/stdc++.h>\n#define RI register int\ntypedef long long LL;\n#define int LL\n\n#define FILEIO(name) freopen(name\".in\", \"r\", stdin), freopen(name\".out\", \"w\", stdout);\n\nusing namespace std;\n\nint const mod = 998244353, MAXN = 5005;\nint f[MAXN][MAXN], g[MAXN];\nint A[MAXN], B[MAXN];\nchar s[MAXN];\nstruct Edges { int to, next; } e[MAXN * 2];\nint head[MAXN], tot;\nint size[MAXN];\nint frac[MAXN], invfrac[MAXN], inv[MAXN];\n\ninline LL C(int n, int m) { return frac[n] * invfrac[m] % mod * invfrac[n - m] % mod; }\n\nvoid Init(int Max) {\n  frac[0] = invfrac[0] = 1;\n  frac[1] = invfrac[1] = inv[1] = 1;\n  for (RI i = 2; i <= Max; ++i) {\n    frac[i] = frac[i - 1] * i % mod;\n    inv[i] = (mod - mod / i) * inv[mod % i] % mod;\n    invfrac[i] = invfrac[i - 1] * inv[i] % mod;\n  }\n}\n\ninline void addedge(int from, int to) {\n  e[++tot] = (Edges){to, head[from]};\n  head[from] = tot;\n  e[++tot] = (Edges){from, head[to]};\n  head[to] = tot;\n}\n\nvoid Dfs(int now, int fa) {\n  if (s[now] == '0') ++A[now];\n  else ++B[now];\n  for (RI i = head[now]; i; i = e[i].next)\n    if (e[i].to != fa) {\n      Dfs(e[i].to, now);\n      A[now] += A[e[i].to];\n      B[now] += B[e[i].to];\n    }\n}\n\nvoid Solve(int now, int fa) {\n  size[now] = 0;\n  f[now][0] = 1;\n  for (RI i = head[now]; i; i = e[i].next)\n    if (e[i].to != fa) {\n      Solve(e[i].to, now);\n      for (RI j = 0; j <= size[now] + size[e[i].to]; ++j) g[j] = 0;\n      \n      for (RI j = 0; j <= size[now]; ++j)\n        for (RI k = 0; k <= size[e[i].to]; ++k)\n          g[j + k] = (g[j + k] + f[now][j] * f[e[i].to][k] % mod) % mod;\n      \n      size[now] += size[e[i].to];\n      for (RI j = 0; j <= size[now]; ++j)\n        f[now][j] = g[j];\n    }\n  \n  if (s[now] == '0') {\n    for (RI i = size[now]; i >= 0; --i)\n      if (B[now] - i > 0)\n        f[now][i + 1] = (f[now][i + 1] + f[now][i] * (B[now] - i) % mod) % mod;\n    if (f[now][size[now] + 1]) ++size[now];\n  }\n  else {\n    for (RI i = size[now]; i >= 0; --i)\n      if (A[now] - i > 0)\n        f[now][i + 1] = (f[now][i + 1] + f[now][i] * (A[now] - i) % mod) % mod;\n    if (f[now][size[now] + 1]) ++size[now];\n  }\n}\n\nsigned main() {\n  \n  FILEIO(\"match\");\n\n  ios :: sync_with_stdio(0);\n  cin.tie(0), cout.tie(0);\n  int n; cin >> n; Init(n);\n  cin >> (s + 1);\n  for (RI i = 1, x, y; i < n; ++i)\n    cin >> x >> y, addedge(x, y);\n  Dfs(1, 0);\n  Solve(1, 0);\n  for (RI i = 0; i <= size[1]; ++i)\n    g[i] = f[1][i] * frac[n / 2 - i] % mod;\n  for (RI i = 0; i <= n / 2; ++i) {\n    int Ans = 0;\n    for (RI j = i, op = 1; j <= size[1]; ++j, op = op * (mod - 1) % mod)\n      Ans = (Ans + op * C(j, i) % mod * g[j] % mod) % mod;\n    cout << Ans << \" \";\n  }\n  cout << endl;\n\n  return 0;\n}\n\n// created by Daniel yuan\n\n```\n",
        "postTime": 1587801005,
        "uid": 71955,
        "name": "Daniel_yuan",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6478 \u3010[NOI Online #2 \u63d0\u9ad8\u7ec4]\u6e38\u620f\u3011"
    },
    {
        "content": "# P6478 \u9898\u89e3\n\n\u53ef\u80fd\u5de8\u4f6c\u4eec\u90fd\u89c9\u5f97\u6811\u5f62\u80cc\u5305\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790\u592a\u7b80\u5355\u4e86\uff0c\n\n~~\uff08\u53ea\u6709\u6211\u60f3\u4e86\u82e5\u5e72\u5c0f\u65f6\u8fd8\u5f88\u6655\uff09~~\n\n\u597d\u50cf\u90fd\u6ca1\u5199\u6216\u8005\u53ea\u662f\u70b9\u4e86\u4e00\u53e5\u8bdd\uff0c\u90a3\u6211\u5c31\u6765\u8865\u5145\u4e00\u4e0b\u3002\n\n**\u9898\u610f\uff1a**\n\n\u7ed9\u5b9a\u4e00\u68f5\u70b9\u6570\u4e3a $n=2m$ \u7684\u6709\u6839\u6811\uff0c\u6bcf\u4e2a\u70b9\u6709 $0,1$ \u4e24\u79cd\u8fb9\u6743\u3002\n\n\u73b0\u5728\u8981\u4e3a\u6bcf\u4e00\u4e2a\u6743\u4e3a $0$ \u7684\u70b9\u627e\u4e00\u4e2a\u6743\u4e3a $1$ \u7684\u70b9\u4e0e\u4e4b\u914d\u5bf9\uff0c\u5e76\u5bf9\u6bcf\u4e2a $k \\in [0,\\frac {n}{2}]$\uff0c\n\n\u6c42\u51fa\u6070\u6709 $k$ \u5bf9\u70b9\u7684\u5173\u7cfb\u662f\u7956\u5148\u548c\u540e\u4ee3\u7684\u914d\u5bf9\u65b9\u6848\u6570\u3002\n\n**\u505a\u6cd5\uff1a**\n\n\u6211\u4eec\u8bb0 $f_k$ \u4e3a\u6070\u6709 $k$ \u5bf9\u70b9\u7684\u5173\u7cfb\u662f\u7956\u5148\u548c\u540e\u4ee3\u7684\u914d\u5bf9\u65b9\u6848\u6570\uff0c\n\n\u8bb0 $g_k$ \u4e3a\u94a6\u5b9a $k$ \u5bf9\u70b9\u7684\u5173\u7cfb\u662f\u7956\u5148\u548c\u540e\u4ee3\u7684\u914d\u5bf9\u65b9\u6848\u6570\uff0c\n\n\u90a3\u4e48\u6211\u4eec\u6709\uff1a$g_k= \\sum\\limits_{i=k}^{m}\\dbinom{i}{k}f_i$\uff0c\u5f0f\u5b50\u7684\u542b\u4e49\u662f\uff1a\n\n\u5148\u679a\u4e3e\u4e00\u5171\u6709\u591a\u5c11\u5bf9\u7956\u5148-\u540e\u4ee3\u70b9\u5bf9\uff0c\u518d\u679a\u4e3e\u5728\u8fd9\u4e9b\u70b9\u5bf9\u4e2d\uff0c\u6211\u4eec\u94a6\u5b9a\u7684\u662f\u54ea $k$ \u5bf9\u70b9\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u662f\u4e00\u4e2a\u4e8c\u9879\u5f0f\u53cd\u6f14\u7684\u7ecf\u5178\u5f62\u5f0f\uff0c\u6545\u6211\u4eec\u6709\uff1a\n\n$f_k=\\sum\\limits_{i=k}^{m}\\dbinom{i}{k}(-1)^{i-k}g_i$\uff0c\u81f3\u4e8e\u4e8c\u9879\u5f0f\u53cd\u6f14\u7684\u8bc1\u660e\u6211\u5c31\u4e0d\u8bb2\u4e86\uff0c\u76f8\u4fe1\u5927\u5bb6\u4e5f\u90fd\u4f1a\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u5c06\u95ee\u9898\u8f6c\u5316\u4e3a\u4e86\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $k \\in [0,\\frac {n}{2}]$\uff0c\n\n\u6c42\u51fa\u94a6\u5b9a $k$ \u5bf9\u70b9\u7684\u5173\u7cfb\u662f\u7956\u5148\u548c\u540e\u4ee3\u7684\u914d\u5bf9\u65b9\u6848\u6570\u3002\n\n\u8fd9\u4e2a\u95ee\u9898\u5c31\u5f88\u597d\u89e3\u51b3\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6811\u4e0a\u80cc\u5305\u89e3\u51b3\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u5c31\u662f\uff1a\n\n\u8bbe $f_{u,i}$ \u4e3a\u5b50\u6811 $u$ \u4e2d\u9009\u62e9\u4e86 $i$ \u5bf9\u7956\u5148-\u540e\u4ee3\u70b9\u5bf9\u7684\u65b9\u6848\u6570\uff0c\u5219\u6211\u4eec\u6709\u4e00\u4e2a\u663e\u7136\u7684\u8f6c\u79fb\uff1a\n\n$f_{u,i}=\\sum\\limits_{v,j\\le i} f_{v,j}f_{u,i-j}$\uff0c\u4ee3\u8868\u5728\u5b50\u6811 $v$ \u4e2d\u9009\u62e9 $j$ \u5bf9\u7956\u5148-\u540e\u4ee3\u70b9\uff0c\u5176\u4f59\u7684\u5728\u5b50\u6811 $u$ \u5176\u4ed6\u90e8\u4f4d\u9009\u3002\n\n\u5f53\u7136\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u5728\u5b50\u6811 $u$ \u5185\u9009\u62e9\u4e00\u4e2a\u70b9\u4e0e $u$ \u914d\u5bf9\uff0c\u5373\uff1a\n\n$f_{u,i}=f_{u,i-1}+siz_{u,1-col_u}$\uff0c\u5176\u4e2d $col_u$ \u4ee3\u8868\u70b9 $u$ \u5c5e\u4e8e\u8c01\uff0c$siz_{u,c}$ \u4ee3\u8868\u5b50\u6811 $u$ \u4e2d $col$ \u503c\u4e3a $c$ \u7684\u70b9\u6570\u3002\n\n\u6ce8\u610f\u8fd9\u91cc\u9700\u8981\u5012\u5e8f\u679a\u4e3e $i$\uff0c\u56e0\u4e3a\u70b9 $u$ \u53ea\u80fd\u88ab\u914d\u5bf9\u4e00\u6b21\uff0c\u6545\u5e94\u8be5\u505a $01$ \u80cc\u5305\u3002\n\n\u770b\u4e0a\u53bb\u8fd9\u4e2a\u505a\u6cd5\u662f\u7acb\u65b9\u7ea7\u522b\u7684\u505a\u6cd5\uff0c\u4f46\u5b9e\u9645\u4e0a\u5e76\u4e0d\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u590d\u6742\u5ea6\u7684\u5f0f\u5b50\u5199\u4e0b\u6765\u3002\n\n\u5148\u8bb0 $son_{u,x}$ \u4e3a $u$ \u7684\u7b2c $x$ \u4e2a\u5b50\u8282\u70b9\uff0c\u4ee5\u53ca $s(u)$ \u4e3a\u5b50\u6811 $u$ \u7684\u5927\u5c0f\uff0c\u5219\u6211\u4eec\u6709\uff1a\n\n$T(n)=\\sum\\limits_{u}\\sum\\limits_{v=son_{u,i}}((\\sum\\limits_{j=1}^{i-1}s(son_{u,j})) \\times s(v))$.\n\n\u6211\u4eec\u53ef\u4ee5\u5c06\u4e0a\u5f0f\u7406\u89e3\u6210\uff0c\u5728\u679a\u4e3e\u5230 $u$ \u548c $u$ \u7684\u7b2c $i$ \u4e2a\u513f\u5b50 $v$ \u65f6\uff0c\u5bf9\u4e8e $u$ \u7684\u6240\u6709\u5df2\u7ecf\u679a\u4e3e\u8fc7\u7684\u513f\u5b50\uff0c\n\n\u8fd9\u4e9b\u70b9\u4ee5\u53ca\u5b83\u4eec\u5b50\u6811\u4e2d\u7684\u6240\u6709\u70b9\u6784\u6210\u4e86\u4e00\u4e2a\u70b9\u96c6 $V$\uff1b\n\n\u800c\u6211\u4eec\u6b63\u5728\u8fdb\u884c\u7684\u8fd9\u4e00\u6b21\u679a\u4e3e\uff0c\u4f1a\u5bf9\u65f6\u95f4\u590d\u6742\u5ea6\u9020\u6210 $|V| \\times s(v)$ \u7684\u8d21\u732e\uff0c\n\n\u5e76\u5c06\u70b9 $v$ \u548c $v$ \u7684\u5b50\u6811\u4e2d\u6240\u6709\u70b9\u5408\u5e76\u8fdb\u70b9\u96c6 $V$ \u4e2d\u3002\n\n\u6211\u4eec\u8003\u8651\u62c6\u5f00\u8d21\u732e\u8ba1\u7b97\uff0c\u5177\u4f53\u6765\u8bf4\uff0c\u662f\uff1a\n\n\u56e0\u4e3a\u6bcf\u6b21\u679a\u4e3e\u65f6\uff0c\u4efb\u4e00\u70b9\u96c6 $V$ \u4e2d\u7684\u70b9 $p$\uff0c\u548c\u4efb\u4e00\u70b9 $v$ \u53ca\u5176\u5b50\u6811\u4e2d\u7684\u70b9 $q$\uff0c\n\n\u90fd\u4f1a\u5bf9\u4e0a\u9762\u65f6\u95f4\u590d\u6742\u5ea6\u4e2d\u7684 $|V| \\times s(v)$ \u9020\u6210\u503c\u4e3a $1$ \u7684\u8d21\u732e\u3002\n\n\u53c8\u56e0\u4e3a $p$ \u548c $q$ \u5728\u6811\u4e0a\u7684\u6700\u8fd1\u516c\u5171\u7956\u5148\u5fc5\u7136\u662f $u$\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u8fd9\u6b21\u679a\u4e3e\u4e4b\u524d\uff0c\n\n\u6211\u4eec\u4e00\u5b9a\u6ca1\u6709\u679a\u4e3e\u5230\u8fc7 $u,v$\uff0c\u6545\u8fd9\u662f\u70b9\u5bf9 $p,q$ \u7b2c\u4e00\u6b21\u9020\u6210\u8d21\u732e\uff0c\n\n\u4f46\u6211\u4eec\u5728\u679a\u4e3e\u5b8c $u,v$ \u540e\uff0c\u4f1a\u628a\u70b9 $v$ \u548c $v$ \u7684\u5b50\u6811\u4e2d\u6240\u6709\u70b9\u5408\u5e76\u8fdb\u70b9\u96c6 $V$ \u4e2d\uff0c\n\n\u90a3\u4e48\u8fd9\u4e5f\u662f\u662f\u70b9\u5bf9 $p,q$ \u6700\u540e\u4e00\u6b21\u9020\u6210\u8d21\u732e\uff0c\u56e0\u4e3a\u70b9\u96c6 $V$ \u4e0d\u4f1a\u5206\u88c2\uff0c\n\n\u4e14\u4efb\u610f\u540c\u5c5e\u4e8e\u70b9\u96c6 $V$ \u4e2d\u7684\u4e24\u70b9\u4e0d\u4f1a\u9020\u6210\u8d21\u732e\u3002\n\n\u4ee5\u4e0a\u8bc1\u660e\u8bf4\u660e\u4e86\uff0c\u5bf9 $\\forall u,v \\in [1,n]$\uff0c\u70b9\u5bf9 $u,v$ \u53ea\u4f1a\u5bf9\u65f6\u95f4\u590d\u6742\u5ea6\u9020\u6210\u4e00\u6b21\u503c\u4e3a $1$ \u7684\u8d21\u732e\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6700\u540e\u65f6\u95f4\u590d\u6742\u5ea6\u53ea\u4f1a\u88ab\u7d2f\u52a0 $O(n^2)$ \u6b21\uff0c\u5373 $T(n)=O(n^2)$.\n\n**code\uff1a**\n\n```\n#include<bits/stdc++.h>\n\n#define fi first\n#define se second\n#define mp make_pair\n#define pb push_back\n#define int long long\n#define pii pair < int , int >\n#define swap(u, v) u ^= v, v ^= u, u ^= v\n#define ckmax(a, b) ((a) = max((a), (b)))\n#define ckmin(a, b) ((a) = min((a), (b)))\n#define rep(i, a, b) for (int i = (a); i <= (b); i++)\n#define per(i, a, b) for (int i = (a); i >= (b); i--)\n#define edg(i, v, u) for (int i = head[u], v = e[i].to; i; i = e[i].nxt, v = e[i].to)\n\nusing namespace std;\n\ninline int read() {\n\tint x = 0, f = 1; char ch = getchar();\n\twhile (ch < '0' || ch > '9') f = ch == '-' ? -1 : 1, ch = getchar();\n\twhile (ch >= '0' && ch <= '9') x = x * 10 + ch - 48, ch = getchar();\n\treturn x * f;\n}\n\nconst int N (5e3 + 10);\nconst int mod (998244353);\n\nvoid add (int &x, int y) { x = (x + y) % mod; }\n\nint ksm (int a, int b) {\n\tint r = 1;\n\tfor (; b; a = a * a % mod, b >>= 1) if (b & 1) r = r * a % mod;\n\treturn r;\n}\n\nint n;\nint cnt;\nint g[N];\nchar s[N];\nint fac[N];\nint inv[N];\nint head[N];\nint f[N][N];\nint siz[N][2];\n\nstruct Edge { int to, nxt; } e[N << 1];\n\nvoid adde (int u, int v) {\n\te[++cnt] = (Edge) {v, head[u]}, head[u] = cnt;\n}\n\nint Siz (int x) { return siz[x][0] + siz[x][1]; }\n\nint C (int bi, int sm) {\n\treturn fac[bi] * inv[sm] % mod * inv[bi - sm] % mod;\n}\n\nvoid dfs (int u, int fa) {\n\tf[u][0] = 1;\n\trep (c, 0, 1) siz[u][c] = (s[u] == ('0' + c));\n\tedg (pth, v, u) if (v ^ fa) {\n\t\tdfs (v, u); int Su = Siz(u), Sv = Siz(v);\n\t\trep (i, 0, Su + Sv) g[i] = 0;\n\t\trep (i, 0, min (Su, n / 2)) rep (j, 0, min (Sv, n / 2 - i))\n\t\t  add (g[i + j], f[v][j] * f[u][i] % mod);\n\t\trep (i, 0, Su + Sv) f[u][i] = g[i];\n\t\trep (c, 0, 1) siz[u][c] += siz[v][c];\n\t}\n\tper (i, min (siz[u][0], siz[u][1]), 1) {\n\t\tint x = ((s[u] == '1') ? siz[u][0] : siz[u][1]) - (i - 1);\n\t\tadd (f[u][i], f[u][i - 1] * x % mod);\n\t}\n}\n\nsigned main() {\n\tn = read(), cin >> (s + 1);\n\trep (i, 2, n) {\n\t\tint u = read(), v = read();\n\t\tadde (u, v), adde (v, u);\n\t}\n\tfac[0] = inv[0] = 1;\n\trep (i, 1, n + 2) fac[i] = fac[i - 1] * i % mod, \n\t\t\t\t\t  inv[i] = ksm (fac[i], mod - 2);\n\tdfs (1, 0);\n\trep (k, 0, n / 2 + 1) (f[1][k] *= fac[n / 2 - k]) %= mod;\n\trep (k, 0, n / 2) {\n\t\tint res = 0, sgn = mod - 1;\n\t\trep (i, k, n / 2) {\n\t\t\tint tmp = C (i, k) * ((i - k & 1) ? mod - 1 : 1) % mod;\n\t\t\tres = (res + tmp * f[1][i] % mod) % mod;\n\t\t}\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1638686802,
        "uid": 100091,
        "name": "GaryH",
        "ccfLevel": 6,
        "title": "P6478 \u9898\u89e3"
    },
    {
        "content": "UPD\uff1a\u9898\u9762\u4f20\u9001\u9519\u4e86/gg/gg\n\n[\u9898\u9762\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P6478)\n\n\u6ca1\u9519\u8fd9\u5c31\u662f\u6211 boom0 \u7684[\u90a3\u573a NOIOL](https://www.cnblogs.com/ET2006/p/12775259.html) \u7684 T3\n\n~~\u4e00\u5e74\u524d\uff0c\u6211\u5728 NOIOL #2 \u7684\u8d5b\u573a\u4e0a\u6298\u621f\u6c89\u6c99\uff0c\u4e00\u5e74\u540e\uff0c\u6211\u4ece\u5012\u4e0b\u7684\u5730\u65b9\u722c\u8d77\u3002~~\n\n~~\u6211\u6210\u529f\u4e86\uff0c\u6211\u4e0d\u518d\u662f\u4ece\u524d\u90a3\u4e2a\u6211\u4e86~~\n\n\u6211\u4eec\u9996\u5148\u5047\u8bbe A \u62e5\u6709\u7684\u70b9\u4e3a $p_1,p_2,\\cdots,p_m$\uff0cB \u62e5\u6709\u7684\u70b9\u4e3a $q_1,q_2,\\cdots,q_m$\uff0c\u663e\u7136 A\u3001B \u51fa\u724c\u7684\u987a\u5e8f\u662f\u65e0\u5173\u7d27\u8981\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u4e0d\u59a8\u5047\u8bbe A \u5c31\u6309 $p_1,p_2,\\cdots,p_m$ \u7684\u987a\u5e8f\u51fa\u724c\uff0c\u9898\u76ee\u5c31\u7b49\u4ef7\u4e8e\u6709\u591a\u5c11\u4e2a $q$ \u7684\u6392\u5217 $r$ \u6ee1\u8db3\u6070\u597d\u5b58\u5728 $k$ \u5bf9 $(p_i,r_i)$ \u662f\u7956\u5148\u5173\u7cfb\u3002\n\n\u5176\u6b21\uff0c\u6ce8\u610f\u5230\u8fd9\u4e2a\u201c\u6070\u597d\u201d\u975e\u5e38\u96be\u53d7\uff0c\u56e0\u4e3a\u5b83\u65e2\u5305\u542b\u5339\u914d\u4e5f\u5305\u542b\u4e0d\u5339\u914d\u7684\u60c5\u51b5\uff0c\u800c\u8fd9\u4e24\u79cd\u60c5\u51b5\u662f\u5f88\u96be\u5728\u4e00\u8d77\u8003\u8651\u7684\u3002\n\n\u8fd9\u65f6\u5019\u6211\u4eec\u5c31\u53ef\u4ee5\u5f88\u81ea\u7136\u5730\u60f3\u5230\u4e00\u4e2a\u5957\u8def\u53eb\u201c\u4e8c\u9879\u5f0f\u53cd\u6f14\u201d\uff0c\u6211\u4eec\u8003\u8651**\u4efb\u610f\u94a6\u5b9a $k$ \u5bf9\u5fc5\u987b\u5339\u914d\u7684\u70b9**\uff0c\u5373\u8bb0 $f_k$ \u4e3a\u94a6\u5b9a $k$ \u5bf9\u5fc5\u987b\u5339\u914d\u7684\u70b9\uff0c\u5269\u4f59\u968f\u4fbf\u6392\u5217\u7684\u65b9\u6848\u6570\uff0c\u518d\u8bb0 $g_k$ \u4e3a\u6070\u597d\u5b58\u5728 $k$ \u5bf9 $(p_i,r_i)$ \u662f\u7956\u5148\u5173\u7cfb\u7684\u65b9\u6848\u6570\u3002\u90a3\u4e48\u6709 $f_k=\\sum\\limits_{i=k}\\dbinom{i}{k}g_i$\uff0c\u53cd\u6f14\u4ee5\u4e0b\u5373\u53ef $g_k=\\sum\\limits_{i=k}\\dbinom{i}{k}(-1)^{i-k}f_i$\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u600e\u6837\u6c42 $f_i$\uff0c\u8fd9\u663e\u7136\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u6811\u5f62\u80cc\u5305\u95ee\u9898\uff0c\u8bbe $dp_{u,j}$ \u8868\u793a $u$ \u7684\u5b50\u6811\u5185\u94a6\u5b9a\u4e86 $j$ \u5bf9\u8981\u5339\u914d\u7684\u70b9\u7684\u65b9\u6848\u6570\u3002\u8003\u8651\u8f6c\u79fb\uff0c\u6211\u4eec\u9996\u5148\u6309\u7167\u6811\u5f62\u80cc\u5305\u7684\u5957\u8def\u5c06 $u$ \u6240\u6709\u5b50\u6811\u7684 $dp$ \u503c\u5408\u5e76\u8d77\u6765\uff0c\u5408\u5e76\u5b8c\u4e4b\u540e\u7684 $dp_{u,j}$ \u7684\u663e\u7136\u5c31\u662f\u5728 $u$ \u6240\u6709\u513f\u5b50\u7684\u5b50\u6811\u4e2d\u94a6\u5b9a $j$ \u5bf9\u9700\u5339\u914d\u7684\u70b9\u7684\u65b9\u6848\u6570\uff0c\u6b64\u65f6\u6211\u4eec\u8fd8\u9700\u518d\u8003\u8651 $u$ \u7684\u5339\u914d\u60c5\u51b5\uff0c\u5982\u679c $u$ \u5c5e\u4e8e A\uff0c\u90a3\u4e48\u6211\u4eec\u4ee4 $dp_{u,j+1}\\leftarrow dp_{u,j}\\times(c1_u-j)$\uff0c\u5176\u4e2d $c1_u$ \u8868\u793a $u$ \u5b50\u6811\u5185\u6709\u591a\u5c11\u4e2a\u70b9\u5c5e\u4e8e B\uff0c$u$ \u5c5e\u4e8e B \u7684\u60c5\u51b5\u4e5f\u540c\u7406\uff0c\u6ce8\u610f\uff0c\u8fd9\u91cc\u7684 $j$ \u9700\u8981\u5012\u5e8f\u679a\u4e3e\u3002\u6700\u7ec8 $f_k=dp_{1,k}\\times(\\dfrac{n}{2}-k)!$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n^2)$\n\n~~\u603b\u4e4b\u5f53\u65f6\u89c9\u5f97\u8fd9\u9053\u9898\u662f\u9053 dlt\uff0c\u73b0\u5728\u770b\u6765\uff0c\u4e5f\u5c31 just so so \u7f62\uff08~~\n\n```cpp\nconst int MAXN=5e3;\nconst int MOD=998244353;\nchar s[MAXN+5];\nint n,c0[MAXN+5],c1[MAXN+5],dp[MAXN+5][MAXN+5];\nint hd[MAXN+5],to[MAXN*2+10],nxt[MAXN*2+10],ec=0;\nvoid adde(int u,int v){to[++ec]=v;nxt[ec]=hd[u];hd[u]=ec;}\nint tmp[MAXN+5];\nvoid dfs(int x,int f){\n\tdp[x][0]=1;\n\tfor(int e=hd[x];e;e=nxt[e]){\n\t\tint y=to[e];if(y==f) continue;dfs(y,x);\n\t\tmemset(tmp,0,sizeof(tmp));\n\t\tfor(int u=0;u<=min(c0[x],c1[x]);u++)\n\t\t\tfor(int v=0;v<=min(c0[y],c1[y]);v++){\n\t\t\t\ttmp[u+v]=(tmp[u+v]+1ll*dp[x][u]*dp[y][v])%MOD;\n\t\t\t}\n\t\tc0[x]+=c0[y];c1[x]+=c1[y];\n\t\tfor(int u=0;u<=min(c0[x],c1[x]);u++) dp[x][u]=tmp[u];\n\t}\n\tif(s[x]=='0'){\n\t\tfor(int u=min(c0[x],c1[x]);~u;u--){\n\t\t\tdp[x][u+1]=(dp[x][u+1]+1ll*dp[x][u]*(c1[x]-u))%MOD;\n\t\t} c0[x]++;\n\t} else {\n\t\tfor(int u=min(c0[x],c1[x]);~u;u--){\n\t\t\tdp[x][u+1]=(dp[x][u+1]+1ll*dp[x][u]*(c0[x]-u))%MOD;\n\t\t} c1[x]++;\n\t}\n//\tfor(int u=0;u<=min(c0[x],c1[x]);u++) printf(\"%d %d %d\\n\",x,u,dp[x][u]);\n}\nint fac[MAXN+5],ifac[MAXN+5];\nvoid init_fac(int n){\n\tfor(int i=(fac[0]=ifac[0]=ifac[1]=1)+1;i<=n;i++) ifac[i]=1ll*ifac[MOD%i]*(MOD-MOD/i)%MOD;\n\tfor(int i=1;i<=n;i++) fac[i]=1ll*fac[i-1]*i%MOD,ifac[i]=1ll*ifac[i-1]*ifac[i]%MOD;\n}\nint binom(int n,int k){return 1ll*fac[n]*ifac[k]%MOD*ifac[n-k]%MOD;}\nint f[MAXN+5],g[MAXN+5];\nint main(){\n\tscanf(\"%d%s\",&n,s+1);\n\tfor(int i=1,u,v;i<n;i++) scanf(\"%d%d\",&u,&v),adde(u,v),adde(v,u);\n\tdfs(1,0);init_fac(n);\n\tfor(int i=0;i<=n/2;i++) f[i]=1ll*fac[n/2-i]*dp[1][i]%MOD;\n\tfor(int i=0;i<=n/2;i++){\n\t\tfor(int j=i;j<=n/2;j++){\n\t\t\tif((j-i)&1) g[i]=(g[i]-1ll*binom(j,i)*f[j]%MOD+MOD)%MOD;\n\t\t\telse g[i]=(g[i]+1ll*binom(j,i)*f[j])%MOD;\n\t\t} printf(\"%d\\n\",g[i]);\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1620133790,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P6478 [NOI Online #2 \u63d0\u9ad8\u7ec4] \u6e38\u620f"
    },
    {
        "content": "\u5148\u770bP1595\n\n\u6211\u4eec\u628a\u6570\u636e\u8303\u56f4\u5f00\u5230 $n\\leq114514$\n\n\u6211\u4eec\u5148\u8bbe $f(n,k)$ \u4e3a**\u521a\u597d** $k$ \u4e2a\u70b9**\u5728**\u539f\u6765\u7684\u4f4d\u7f6e\u4e0a\uff0c\u7b54\u6848\u4e3a $f(n,0)$\n\n\u518d\u8bbe $g(n,k)$ \u4e3a**\u94a6\u5b9a** $k$ \u4e2a\u70b9**\u5728**\u539f\u6765\u7684\u4f4d\u7f6e\u4e0a\uff0c\u5176\u4ed6\u968f\u610f\u6392\uff0c\u663e\u7136\uff0c$g(n,k)=\\dbinom{n}{k}(n-k)!=n!/k!$\n\n\u53d1\u73b0 $g(n,k)=\\sum\\limits_{i=k}^{}\\dbinom{i}{k}f(n,i)$\n\n\u4f7f\u7528\u4e8c\u9879\u5f0f\u53cd\u6f14\n\n$f(n,k)=\\sum\\limits_{i=k}^{}(-1)^{i-k}\\dbinom{i}{k}g(n,i)=\\sum\\limits_{i=k}^{}(-1)^{i-k}\\dbinom{i}{k}\\dfrac{n!}{i!}$\n\n$ans=f(n,0)=n!\\sum\\limits_{i=0}^{}\\dfrac{(-1)^{i}}{i!}$\n\n\u7ed3\u675f\n\nP6478\n\n\u53d1\u73b0\u521a\u597d\u4e0d\u4f1a\u505a\uff0c\u4f7f\u7528\u4e0a\u9898\u5957\u8def\uff0c\u90a3\u4e48\u5c31\u8bbe**\u94a6\u5b9a** $k$ \u4e2a\u70b9\u662f $f(n,k)$\uff0c\u521a\u597d $k$ \u4e2a\u70b9\u662f $g(n,k)$\n\n\u540c\u4e0a\u9898\uff0c\u53cd\u6f14\u5f97$f(n,k)=\\sum\\limits_{i=k}^{}(-1)^{i-k}\\dbinom{i}{k}g(n,i)$\n\n\u7136\u540e $f(n,k)$ \u5f88\u597d\u6c42\uff0c\u7528\u80cc\u5305+\u5b50\u6811\u5927\u5c0f\u4f18\u5316\u4e00\u4e0b\n\n\u8003\u8651\u81ea\u5df1\u7684\u8f6c\u79fb\uff0c\u76f4\u63a5\u8dd1\u4e00\u904d\n\n\u8dd1\u51fa\u6765\u7684 $f(1,k)$ \u6254\u8fdb\u53bb\u53cd\u6f14\u4e00\u4e0b\u5c31\u5f97\u5230\u4e86 $g(1,k)$\n\n[\u4ee3\u7801](https://www.luogu.com.cn/paste/2nz8fq72)",
        "postTime": 1613369928,
        "uid": 359952,
        "name": "_lbw_",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P6478 \u3010[NOI Online #2 \u63d0\u9ad8\u7ec4] \u6e38\u620f\u3011"
    },
    {
        "content": "**\u6070\u597d**\u8fd9\u4e2a\u8bcd\u770b\u4e0a\u53bb\u6bd4\u8f83\u5934\u75bc\uff0c\u8003\u8651\u5927\u529b\u5bb9\u65a5\u4e00\u4e0b\u3002\n\n\u6211\u4eec\u8bbe $f(i)$ \u8868\u793a**\u5b58\u5728** $i$ \u56de\u5408\u5206\u51fa\u5e73\u5c40\u7684\u65b9\u6848\u6570\uff0c$g(i)$ \u8868\u793a**\u6070\u597d** $i$ \u56de\u5408\u5206\u51fa\u5e73\u5c40\u7684\u65b9\u6848\u6570\uff0c\u663e\u7136\u6709\uff1a\n\n$$\nf(i)=\\sum_{k=i}^m \\binom{k}{i} g(k)\n$$\n\n\u7531\u4e8c\u9879\u5f0f\u53cd\u6f14\u53ef\u77e5\uff0c\n\n$$\ng(i)=\\sum_{k=i}^m (-1)^{k-i} \\binom{k}{i} f(k)\n$$\n\n\u8003\u8651\u628a $f(i)$ \u6c42\u51fa\u6765\u3002\n\n\u8bbe $f(i,j)$ \u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\u4e2d\uff0c**\u5b58\u5728** $j$ \u5bf9\u7956\u5148 - \u540e\u4ee3\u5173\u7cfb\uff0c\u4e14\u989c\u8272\u4e0d\u540c\u7684\u70b9\u5bf9\u3002\n\n\u6709\u4e24\u79cd\u8f6c\u79fb\uff1a\n\n- \u5b50\u6811\u5185\u7684\u7ed3\u679c\u5408\u5e76\uff0c\u6811\u5f62\u80cc\u5305\u8dd1\u4e00\u4e0b\u5c31\u884c\u3002\n- \u6839\u8282\u70b9\u4e0e\u672a\u88ab\u9009\u7684\u4e00\u4e2a\u70b9\u914d\u5bf9\uff0c\u8fd9\u4e2a\u5728\u5b50\u6811\u5408\u5e76\u540e\u8dd1\u4e00\u904d\u5c31\u884c\u3002\n\n```cpp\n// Problem: P6478 [NOI Online #2 \u63d0\u9ad8\u7ec4]\u6e38\u620f\uff08\u6c11\u95f4\u6570\u636e\uff09\n// Contest: Luogu\n// URL: https://www.luogu.com.cn/problem/P6478\n// Memory Limit: 512 MB\n// Time Limit: 1000 ms\n// Powered by CP Editor (https://github.com/cpeditor/cpeditor)\n\n#include <iostream>\n#include <vector>\n#define MOD 998244353\nusing namespace std;\nvector<int> e[5005];\nchar s[5005];\nint siz[5005],siz1[5005],n;\nlong long f[5005][5005],g[5005],fr[5005];\nint c[5005][5005];\nvoid dfs(int u,int fa)\n{\n siz[u]=1,siz1[u]=(s[u]-'0');\n f[u][0]=1;\n for(auto v:e[u])\n {\n  if(v==fa)continue;\n  dfs(v,u);\n  for(int i=0;i<=siz[u]+siz[v];i++)\n   g[i]=0;\n  for(int i=0;i<=min(siz[u],n/2);i++)//\u6811\u5f62\u80cc\u5305\u5408\u5e76\u7ed3\u679c\n   for(int j=0;j<=min(siz[v],n/2-i);j++)\n    g[i+j]=(g[i+j]+f[u][i]*f[v][j])%MOD;\n  for(int i=0;i<=siz[u]+siz[v];i++)\n   f[u][i]=g[i];\n  siz[u]+=siz[v],siz1[u]+=siz1[v];\n }\n for(int i=min(siz1[u],siz[u]-siz1[u]);i;i--)//\u6839\u8282\u70b9\u4e0e\u5b50\u6811\u5185\u67d0\u4e2a\u672a\u88ab\u9009\u7684\u70b9\u914d\u5bf9\n  if(s[u]=='1')\n   f[u][i]=(f[u][i]+f[u][i-1]*(siz[u]-siz1[u]-(i-1)))%MOD;\n  else\n   f[u][i]=(f[u][i]+f[u][i-1]*(siz1[u]-(i-1)))%MOD;\n}\nint main()\n{\n cin>>n;\n cin>>(s+1);\n fr[0]=1;\n for(int i=1;i<=n;i++)\n  fr[i]=fr[i-1]*i%MOD,c[i][0]=1;\n c[0][0]=1;\n for(int i=1;i<=n;i++)\n  for(int j=1;j<=i;j++)\n   c[i][j]=(c[i-1][j-1]+c[i-1][j])%MOD;\n for(int i=1;i<n;i++)\n {\n  int u,v;\n  cin>>u>>v;\n  e[u].push_back(v);\n  e[v].push_back(u);\n }\n dfs(1,0);\n for(int i=0;i<=n/2;i++)\n  f[1][i]=f[1][i]*fr[n/2-i]%MOD;\n for(int i=0;i<=n/2;i++)\n {\n  long long ans=0;\n  for(int j=i;j<=n/2;j++)//\u4e8c\u9879\u5f0f\u53cd\u6f14\n   if((j-i)&1)ans=(ans-c[j][i]*f[1][j]%MOD+MOD)%MOD;\n   else ans=(ans+c[j][i]*f[1][j])%MOD;\n  cout<<ans<<endl;\n }\n return 0;\n}",
        "postTime": 1596950607,
        "uid": 22030,
        "name": "StudyingFather",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P6478 \u3010[NOI Online #2 \u63d0\u9ad8\u7ec4]\u6e38\u620f\uff08\u6c11\u95f4\u6570\u636e\uff09\u3011"
    },
    {
        "content": "[P6478 [NOI Online #2 \u63d0\u9ad8\u7ec4]\u6e38\u620f](https://www.luogu.com.cn/problem/P6478)\n\n\u201c\u6070\u597d\u201d\u7684\u65b9\u6848\u6570\u4e0d\u597d\u6c42\uff0c\u6211\u4eec\u5bf9\u8fd9\u4e2a\u95ee\u9898\u8fdb\u884c\u8f6c\u5316\uff1a\u8bbe $f_i$ \u8868\u793a\u975e\u5e73\u5c40\u56de\u5408\u6570\u6070\u597d\u4e3a $i$ \u7684\u65b9\u6848\u6570\uff0c  $g_i$ \u8868\u793a\u975e\u5e73\u5c40\u56de\u5408\u6570\u81f3\u5c11\u4e3a $i$ \u7684\u65b9\u6848\u6570\u3002\u6839\u636e\u4e8c\u9879\u5f0f\u53cd\u6f14\uff08\u5e7f\u4e49\u5bb9\u65a5\uff09\uff0c\n$$\ng_i=\\sum_{j=i}^{m}\\tbinom{j}{i}f_j\\Rightarrow f_i=\\sum_{j=i}^{m}(-1)^{j-i}\\tbinom{j}{i}g_j\n$$\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5728 $O(n^2 )$ \u7684\u65f6\u95f4\u5185\u628a $g$ \u8f6c\u5316\u4e3a $f$\u3002\u63a5\u4e0b\u6765\u8003\u8651\u5982\u4f55\u6c42 $g$\u3002\n\n\u8bbe $dp_{u,i}$ \u8868\u793a\u5728 $u$ \u5b50\u6811\u5185\u975e\u5e73\u5c40\u56de\u5408\u6570\u81f3\u5c11\u4e3a $i$ \uff08\u5373\u9009 $ i$ \u5bf9\u6709\u201c\u7956\u5b59\u5173\u7cfb\u201d\u7684\u70b9\u5bf9\uff09\u7684\u65b9\u6848\u6570\u3002\u8f6c\u79fb\u65f6\uff0c\u6bcf\u904d\u5386\u4e00\u68f5\u5b50\u6811\u5c31\u628a\u7b54\u6848\u5e76\u8fdb\u53bb $dp_{u,j+k}=\\sum_{v\\in son_u}dp_{u,j}\\times dp_{v,k}$\uff0c\u7136\u540e\u518d\u8003\u8651 $u$ \u548c\u5176\u5b50\u6811\u5185\u4e00\u70b9\u914d\u5bf9\u7684\u60c5\u51b5 \u3002\u6839\u636e\u6811\u5f62\u80cc\u5305\u7684\u590d\u6742\u5ea6\u5206\u6790\uff0c\u8fd9\u4e2a\u8f6c\u79fb\u7684\u590d\u6742\u5ea6\u662f $O(n^2)$ \u7684\u3002\n\n\u6c42\u51fa $dp$ \u6570\u7ec4\u540e\uff0c\u6709 $g_i=dp_{1,k}\\times(m-k)!$\uff0c\u4e5f\u5c31\u662f\u5728\u5df2\u9009\u7684 $k$ \u4e2a\u70b9\u5bf9\u4ee5\u5916\uff0c\u5176\u4ed6\u7684\u81ea\u7531\u7ec4\u5408\u3002\u6700\u540e\u76f4\u63a5\u5957\u4e8c\u9879\u5f0f\u53cd\u6f14\u7684\u5f0f\u5b50\u6c42 $f$ \u5373\u53ef\u3002\n\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nnamespace FGF\n{\n\tint n,m;\n\tconst int N=5005;\n\tconst int mo=998244353;\n\tchar s[N]; \n\tstruct edg{\n\t\tint to,nxt;\n\t}e[N<<1];\n\tint cnt,head[N],siz[N],sz[2][N],a[N];\n\tll dp[N][N],tmp[N],fac[N],g[N],f[N],C[N][N];\n\tvoid add(int u,int v)\n\t{\n\t\tcnt++;\n\t\te[cnt].to=v;\n\t\te[cnt].nxt=head[u];\n\t\thead[u]=cnt;\n\t}\n\tvoid dfs(int u,int fa)\n\t{\n\t\tsiz[u]=1,sz[a[u]][u]=1,dp[u][0]=1;\n\t\tfor(int i=head[u];i;i=e[i].nxt)\n\t\t{\n\t\t\tint v=e[i].to;\n\t\t\tif(v==fa)continue;\n\t\t\tdfs(v,u);\n\t\t\tfor(int j=0;j<=min(siz[u]+siz[v],m);j++)tmp[j]=0;\n\t\t\tfor(int j=0;j<=min(siz[u],m);j++)\n\t\t\t\tfor(int k=0;k<=min(siz[v],m-j);k++)\n\t\t\t\t\ttmp[j+k]=(tmp[j+k]+dp[u][j]*dp[v][k]%mo)%mo;\n\t\t\tsiz[u]+=siz[v];\n\t\t\tsz[0][u]+=sz[0][v],sz[1][u]+=sz[1][v];\n\t\t\tfor(int j=0;j<=min(siz[u],m);j++)dp[u][j]=tmp[j];\n\t\t}\n\t\tfor(int i=sz[a[u]^1][u];i>=0;i--)\n\t\t\tdp[u][i+1]=(dp[u][i+1]+dp[u][i]*(sz[a[u]^1][u]-i)%mo)%mo;\n\t}\n\tvoid init()\n\t{\n\t\tfor(int i=0;i<=n;i++)\n\t\t{\n\t\t\tC[i][0]=1;\n\t\t\tfor(int j=1;j<=i;j++)\n\t\t\t\tC[i][j]=(C[i-1][j]+C[i-1][j-1])%mo;\n\t\t}\n\t\tfac[0]=1;\n\t\tfor(int i=1;i<=n;i++)fac[i]=fac[i-1]*i%mo;\n\t}\n\tvoid work()\n\t{\n\t\tscanf(\"%d\",&n);m=n>>1;\n\t\tscanf(\"%s\",s+1);\n\t\tfor(int i=1;i<=n;i++)a[i]=s[i]-'0';\n\t\tfor(int i=1;i<n;i++)\n\t\t{\n\t\t\tint u,v;\n\t\t\tscanf(\"%d%d\",&u,&v);\n\t\t\tadd(u,v),add(v,u); \n\t\t}\n\t\tdfs(1,0);\n\t\tinit();\n\t\tfor(int i=0;i<=m;i++)g[i]=dp[1][i]*fac[m-i]%mo;\n\t\tfor(int i=0;i<=m;i++)\n\t\t\tfor(int j=i;j<=m;j++)\n\t\t\t\tif((j-i)&1)f[i]=(f[i]-C[j][i]*g[j]%mo+mo)%mo;\n\t\t\t\t\telse f[i]=(f[i]+C[j][i]*g[j]%mo)%mo;\t\t\n\t\tfor(int i=0;i<=m;i++)\n\t\t\tprintf(\"%lld\\n\",f[i]);\n\t}\n}\nint main()\n{\n\tFGF::work();\n\treturn 0;\n}\n```",
        "postTime": 1606996228,
        "uid": 224403,
        "name": "\u6728xx\u6728\u5927",
        "ccfLevel": 9,
        "title": "P6478 [NOI Online #2 \u63d0\u9ad8\u7ec4]\u6e38\u620f\uff08\u6811dp+\u5e7f\u4e49\u5bb9\u65a5\uff09"
    },
    {
        "content": "\u6811\u5f62\u80cc\u5305 + \u4e8c\u9879\u5f0f\u53cd\u6f14 \u597d\u9898\u3002\n\n**\u6ce8\u610f\u8fd9\u9053\u9898\u5224\u60c5\u51b5\u4e0d\u540c\u7684\u65b9\u6cd5\uff0c\u56de\u5408\u4e4b\u95f4\u4ea4\u6362\u987a\u5e8f\u7b97\u540c\u4e00\u79cd\u60c5\u51b5\u3002**\n\n\u53d1\u73b0\u300c\u975e\u5e73\u5c40\u56de\u5408\u300d\u7b49\u4ef7\u4e8e\u4e24\u4eba\u9009\u7684\u70b9\u5b58\u5728\u7956\u5b59\u5173\u7cfb\u3002\n\n\u6211\u4eec\u8bbe $f(i)$ \u8868\u793a**\u6070\u597d**\u6709 $i$ \u5c40\u975e\u5e73\u5c40\u7684\u65b9\u6848\u6570\uff08\u4e5f\u5c31\u662f\u6211\u4eec\u6700\u7ec8\u7684\u7b54\u6848\uff09\uff0c\u8bbe $g(i)$ \u8868\u793a**\u94a6\u5b9a**\u6709 $i$ \u5c40\u975e\u5e73\u5c40\u7684\u65b9\u6848\u6570\n\n\u5f53\u4f5c\u60a8\u4f1a\u4e86\u4e8c\u9879\u5f0f\u53cd\u6f14\uff0c\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0**\u94a6\u5b9a**\u548c**\u81f3\u5c11**\u7684\u533a\u522b\u4e86\u3002\n\n\u7531\u5b9a\u4e49\u5f97\u5230\n$$\ng(i)=\\sum_{j=i}^m\\binom{j}{i}f(j)\n$$\n\u4e8c\u9879\u5f0f\u53cd\u6f14\n$$\nf(i)=\\sum_{j=i}^m(-1)^{j-i}\\binom{j}{i}g(j)\n$$\n\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ea\u8981\u6c42\u51fa $g(0),g(1),\\dots,g(m)$ \u5373\u53ef\u3002\n\n\u8bbe $dp^{(1)}_i$ \u8868\u793a\u6811\u4e0a\u9009\u62e9 $i$ \u5bf9\u7956\u5b59\u5173\u7cfb\u5f02\u8272\u70b9\u7684\u65b9\u6848\u6570\uff08\u70b9\u5bf9\u4e4b\u95f4\u987a\u5e8f\u65e0\u5173\uff09\u3002\n\n\u6211\u4eec\u6709\n$$\ng(i)=(m-i)!dp^{(1)}_i\n$$\n\u63a5\u4e0b\u6765\u538b\u529b\u8f6c\u5230 $dp^{(1)}$\u3002\u663e\u7136\u662f\u6811\u5f62\u80cc\u5305\u3002\uff08\u56e0\u4e3a $^{(1)}$ \u6839\u8282\u70b9\u89d2\u6807\u90fd\u6807\u597d\u4e86\uff09\n\n\u80cc\u5305\u8f6c\u79fb\u65f6\uff0c\u6211\u4eec\u5148\u7c7b\u4f3c\u666e\u901a\u80cc\u5305\uff0c\u518d\u8ba1\u7b97\u5b50\u6811\u6839\u8282\u70b9\u80fd\u548c\u5b50\u6811\u5185\u591a\u5c11\u70b9\u914d\u5bf9\u3002\n\n\u8bb0\u5f97\u7528\u5237\u8868\u6cd5\u3002\n\n```cpp\n//We'll be counting stars.\n//#pragma GCC optimize(\"Ofast\")\n#include<bits/stdc++.h>\nusing namespace std;\n#define fir first\n#define sec second\n#define mkp make_pair\n#define pb emplace_back\n#define For(i,j,k) for(int i=(j),i##_=(k);i<=i##_;i++)\n#define Rof(i,j,k) for(int i=(j),i##_=(k);i>=i##_;i--)\n#define ckmx(a,b) a=max(a,b)\n#define ckmn(a,b) a=min(a,b)\n#define Fi(s) freopen(s,\"r\",stdin)\n#define Fo(s) freopen(s,\"w\",stdout)\n#define Fre(s) Fi(s\".in\"),Fo(s\".out\")\n#define debug cerr<<\"Line#\"<<__LINE__<<endl\n#define ll long long\nconst ll mod=998244353;\ninline ll pw(ll x,ll y){ll r=1;while(y){if(y&1)r=r*x%mod;x=x*x%mod;y>>=1;}return r;}\n#define int long long\n#define N 5006\nchar c[N];\nint dp[N][N/2],s0[N],s1[N],lim[N],n,f[N/2],ivf[N/2];\nvector<int> e[N];\nvoid dfs(int rt,int fa){\n\ts1[rt]=c[rt]-'0';\n\ts0[rt]=s1[rt]^1;\n\tdp[rt][0]=1;\n\tfor(int i:e[rt]) if(i!=fa){\n\t\tdfs(i,rt);\n\t\ts0[rt]+=s0[i];\n\t\ts1[rt]+=s1[i];\n\t\tRof(j,lim[rt],0) For(k,1,lim[i]) (dp[rt][j+k]+=dp[rt][j]*dp[i][k]%mod)%=mod;\n\t\tlim[rt]+=lim[i];\n\t}\n\tint lst=(c[rt]=='0'?s1[rt]:s0[rt]);\n\tRof(i,lim[rt],0) (dp[rt][i+1]+=dp[rt][i]*max(0ll,lst-i)%mod)%=mod;\n\tlim[rt]++;\n\twhile(!dp[rt][lim[rt]]) lim[rt]--;\n}\ninline int P(int x){return (x&1)?mod-1:1;}\ninline int C(int x,int y){return f[x]*ivf[y]%mod*ivf[x-y]%mod;}\nint32_t main(){\n\tios::sync_with_stdio(false);\n\tcin.tie(nullptr);\n\tcin>>n>>(c+1);\n\tint x,y,m=n/2;\n\tf[0]=1; For(i,1,m) f[i]=f[i-1]*i%mod;\n\tivf[m]=pw(f[m],mod-2); Rof(i,m,1) ivf[i-1]=ivf[i]*i%mod;\n\tFor(i,1,n-1){\n\t\tcin>>x>>y;\n\t\te[x].pb(y);\n\t\te[y].pb(x);\n\t}\n\tdfs(1,0);\n//\tFor(i,0,lim[1]) cout<<dp[1][i]<<\" \"; cout<<endl;\n\tint ans;\n\tFor(i,0,m){\n\t\tans=0;\n\t\tFor(j,i,m) (ans+=P(i+j)*C(j,i)%mod*dp[1][j]%mod*f[m-j]%mod)%=mod;\n\t\tcout<<ans<<endl;\n\t}\nreturn 0;}\n```",
        "postTime": 1657017037,
        "uid": 101868,
        "name": "I_am_Accepted",
        "ccfLevel": 0,
        "title": "P6478 [NOI Online #2 \u63d0\u9ad8\u7ec4] \u6e38\u620f"
    },
    {
        "content": "\u770b\u89c1 **\u6070\u597d** \u8fd9\u79cd\u8bcd\u7684\u8bdd\u53ef\u4ee5\u8003\u8651\u7528\u4e8c\u9879\u5f0f\u53cd\u6f14\u6765\u5927\u529b\u5bb9\u65a5\u3002\n\n**\u6ce8\uff1a\u4e0b\u6587\u63a8\u5f0f\u5b50\u7684 $n,m$ \u4e0e\u9898\u610f\u5e76\u4e0d\u7b26\u3002**\n\n\u8bbe $f_m$ \u4e3a\u6070\u597d $m$ \u5c40\u975e\u5e73\u5c40\u7684\u65b9\u6848\u6570\uff0c$g_m$ \u4e3a\u81f3\u5c11 $m$ \u5c40\u975e\u5e73\u5c40\u7684\u65b9\u6848\u6570\u3002\n\n\u5219\u5bf9\u4e8e\u4efb\u610f\u7684 $i\\geq m$\uff0c$f_i$ \u5728 $g_m$ \u4e2d\u88ab\u8ba1\u7b97\u4e86 $\\binom{i}{m}$ \u6b21\uff0c\u6545\u6709\uff1a\n\n$$g_m=\\sum\\limits_{i=m}^{n}\\binom{i}{m}f_i$$\n\n\u7136\u540e\u4e8c\u9879\u5f0f\u53cd\u6f14\u4e00\u6ce2\uff0c\u6709\uff1a\n\n$$f_m=\\sum_{i=m}^{n}(-1)^{i-m}\\binom{i}{m}g_i$$\n\n\u8003\u8651\u6c42\u51fa $g$\u3002\n\n\u8bbe $dp_{u,i}$ \u4e3a\u5728\u4ee5 $u$ \u4e3a\u6839\u7684\u5b50\u6811\u4e2d\uff0c\u6709 $i$ \u4e2a\u7956\u5148-\u540e\u4ee3\u975e\u540c\u4e00\u65b9\u5173\u7cfb\u5bf9\u7684\u65b9\u6848\u6570\u3002\n\n\u6ce8\u610f\u9898\u4e2d\u7684\u53bb\u91cd\u6761\u4ef6\u7c7b\u4f3c\u4e8e\u7ec4\u5408\u7684\u610f\u5473\uff0c\u90a3\u4e48\u53ef\u4ee5\u5bf9\u4e00\u65b9\u6392\u5e8f\uff0c\u5bf9\u53e6\u4e00\u65b9\u6392\u5217\uff0c\u6709\uff1a\n\n$$g_i=dp_{1,i}\\times (m-i)!$$\n\n\u6309\u7167\u6811\u5f62\u80cc\u5305\u7684\u5957\u8def\u53ef\u4ee5\u5148\u628a\u5b50\u6811\u90fd\u5408\u5e76\u8d77\u6765\uff0c\u6709\uff1a\n\n$$dp_{u,j+k}=\\sum_{v\\in son_u}\\sum_{j=0}^{m}\\sum_{k=0}^{m-j} dp_{v,j}\\times dp_{v,k}$$\n\n\u518d\u8003\u8651 $u$ \u70b9\u81ea\u8eab\u7684\u8d21\u732e\uff0c\u6709\uff1a\n\n$$dp_{u,i+1}=dp_{u,i}\\times (c_u-i)$$\n\n\u5176\u4e2d $c_u$ \u662f $u$ \u5b50\u6811\u5185\u4e0e $u$ \u6240\u5c5e\u76f8\u53cd\u65b9\u7684\u70b9\u7684\u6570\u91cf\u3002\n\n\u7528\u5b50\u6811\u5927\u5c0f\u5361\u4e00\u4e0b\u4e0a\u754c\u80fd\u628a\u590d\u6742\u5ea6\u964d\u5230 $O(n^2)$\u3002\n\n$\\texttt{Code:}$\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\n#define ull unsigned long long\n#define rint register int\n#define int long long\nusing namespace std;\nnamespace IO{\n\t#define File(x,y) freopen(#x,\"r\",stdin),freopen(#y,\"w\",stdout)\n\tinline int read(){\n\t\tint w=0,f=1; char ch=getchar();\n\t\twhile(ch<'0'||ch>'9'){if(ch=='-') f=-1; ch=getchar();}\n\t\twhile(ch>='0'&&ch<='9'){w=(w<<3)+(w<<1)+(ch^48); ch=getchar();}\n\t\treturn w*f;\n\t}\n\tinline void write(int x){\n  \t\tstatic int sta[35]; int top=0;\n  \t\tif(x<0) putchar('-'),x=-x;\n  \t\tdo{sta[++top]=x%10,x/=10;}while(x);\n  \t\twhile(top) putchar(sta[top--]+48); puts(\"\");\n\t}\n}\nusing namespace IO;\nnamespace CL{\n\t#define fill(x,y) memset(x,y,sizeof(x))\n\t#define copy(x,y) memcpy(x,y,sizeof(y))\n\t\n\tconst int maxn=5e3+5,mod=998244353;\n\t\n\tint n,m;\n\tint a[maxn],dp[maxn][maxn],g[maxn],f[maxn],size[maxn],siz[maxn][2],tmp[maxn];\n\tchar s[maxn];\n\tnamespace Graph{\n\t\tint head[maxn],id;\n\t\tstruct e{int v,next;}edge[maxn<<1];\n\t\tinline void add(int u,int v){\n\t\t\tedge[++id].v=v;\n\t\t\tedge[id].next=head[u];\n\t\t\thead[u]=id;\n\t\t}\n\t}using namespace Graph;\n\tnamespace Math{\n\t\tint fac[maxn];\n\t\tinline void init(){\n\t\t\tfac[0]=1;\n\t\t\tfor(int i=1;i<=n;i++) fac[i]=fac[i-1]*i%mod;\n\t\t}\n\t\tinline int qpow(int x,int y){\n\t\t\tint res=1; x%=mod;\n\t\t\twhile(y){\n\t\t\t\tif(y&1) res=res*x%mod;\n\t\t\t\tx=x*x%mod;\n\t\t\t\ty>>=1;\n\t\t\t}\n\t\t\treturn res;\n\t\t}\n\t\tinline int C(int n,int m){\n\t\t\tif(n<m || m<0) return 0;\n\t\t\treturn fac[n]*qpow(fac[m]*fac[n-m],mod-2)%mod;\n\t\t}\n\t}using namespace Math;\n\tvoid dfs(int u,int fa){\n\t\tsize[u]=siz[u][a[u]]=dp[u][0]=1;\n\t\tfor(int i=head[u];i;i=edge[i].next){\n\t\t\tint v=edge[i].v;\n\t\t\tif(v==fa) continue;\n\t\t\tdfs(v,u);\n\t\t\tfor(int j=0;j<=min(size[u]+size[v],m);j++) tmp[j]=0;\n\t\t\tfor(int j=0;j<=min(size[u],m);j++)\n\t\t\t\tfor(int k=0;k<=min(size[v],m-j);k++)\n\t\t\t\t\ttmp[j+k]=(tmp[j+k]+dp[u][j]*dp[v][k]%mod)%mod;\n\t\t\tsize[u]+=size[v];\n\t\t\tsiz[u][0]+=siz[v][0],siz[u][1]+=siz[v][1];\n\t\t\tfor(int j=0;j<=min(size[u],m);j++) dp[u][j]=tmp[j];\n\t\t}\n\t\tfor(int i=siz[u][a[u]^1];i>=0;i--)\n\t\t\tdp[u][i+1]=(dp[u][i+1]+dp[u][i]*(siz[u][a[u]^1]-i)%mod)%mod;\n\t}\n\t\n\tinline int main(){\n\t\tn=read(); m=n>>1; init();\n\t\tscanf(\"%s\",s+1);\n\t\tfor(int i=1;i<=n;i++) a[i]=(s[i]=='1');\n\t\tfor(int i=1;i<n;i++){\n\t\t\tint x=read(),y=read();\n\t\t\tadd(x,y); add(y,x);\n\t\t}\n\t\tdfs(1,0);\n\t\tfor(int i=0;i<=m;i++) g[i]=dp[1][i]*fac[m-i]%mod;\n\t\tfor(int i=0;i<=m;i++)\n\t\t\tfor(int j=i;j<=m;j++){\n\t\t\t\tif((j-i)&1) f[i]=(f[i]-C(j,i)*g[j]%mod+mod)%mod;\n\t\t\t\telse f[i]=(f[i]+C(j,i)*g[j]%mod)%mod;\n\t\t\t}\n\t\tfor(int i=0;i<=m;i++) printf(\"%lld\\n\",f[i]);\n\t\treturn 0;\n\t}\n}\nsigned main(){return CL::main();}\n```",
        "postTime": 1627884147,
        "uid": 226113,
        "name": "\u706b\u7fbd\u767d\u65e5\u751f",
        "ccfLevel": 0,
        "title": "\u300c\u9898\u89e3\u300d P6478 [NOI Online #2 \u63d0\u9ad8\u7ec4] \u6e38\u620f"
    },
    {
        "content": "$\\text{NOI online round2 T3}$ \uff0c\u53bb\u5e74\u770b\u662f\u795e\u4ed9\u9898\uff0c\u5230\u4e86\u4eca\u5e74~~\u4f9d\u7136\u662f\u795e\u4ed9\u9898~~\u3002\n\n\u4e3b\u8981\u662f\u6700\u8fd1\u521a\u5b66\u4e8c\u9879\u5f0f\u53cd\u6f14\uff0c\u4e8e\u662f\u6765\u7ec3\u7ec3\u624b\u3002\n\n\u8fd9\u79cd\u9898\u4e5f\u662f\u6709\u5957\u8def\u7684\uff0c\u770b\u5230\u201c\u6070\u597d\u4e3a $k$\u201d\uff0c\u53d1\u73b0\u81ea\u5df1\u4e0d\u4f1a\u505a\uff0c\u4e8e\u662f\u8003\u8651\u5148\u94a6\u5b9a $k$ \u4e2a\u975e\u5e73\u5c40\u7684\u573a\u6b21\uff0c\u7136\u540e\u8fdb\u884c\u4e8c\u9879\u5f0f\u53cd\u6f14\u3002\n\n\u6240\u4ee5\u6211\u4eec\u5c31\u5c06\u8fd9\u9898\u8f6c\u5316\u4e3a\u4e86\uff0c\u81f3\u5c11\u6709 $k$ \u4e2a\u975e\u5e73\u5c40\u7684\u573a\u6b21\u7684\u60c5\u51b5\u6570\u3002~~\u53d1\u73b0\u81ea\u5df1\u4ecd\u7136\u4e0d\u4f1a\u505a~~\n\n\u65e2\u7136\u662f\u6811\u4e0a\u95ee\u9898\uff0c\u8003\u8651 $f[i][j]$ \u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u94a6\u5b9a\u4e86 $j$ \u4e2a\u975e\u5e73\u5c40\u7684\u573a\u6b21\uff0c\u90a3\u4e48\u53ef\u4ee5\u5f97\u5230 $f$ \u7684\u8f6c\u79fb\u5f0f\u5b50\uff1a\n\n$$f_{i,j}=\\sum_{k_1+k_2+...+k_m=j}\\prod_{t=1}^m f_{son_t,k_t}$$\n\n\u7136\u540e\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u662f\u4e00\u4e2a\u7ecf\u5178\u7684\u6811\u5f62\u80cc\u5305\u7684\u5f0f\u5b50\uff0c\u76f4\u63a5\u8003\u8651\u6bcf\u4e00\u68f5\u5b50\u6811\u53d6\u51e0\u5c31\u597d\u4e86\u3002\n\n\u4f46\u662f\u4e00\u822c\u6811\u5f62\u80cc\u5305\u770b\u8d77\u6765\u662f $n^3$ \u7684\uff0c\u5982\u679c\u60f3\u8981\u53d8\u6210 $n^2$ \u53ea\u7528\u5148\u505a\uff0c\u5728\u628a $siz$ \u52a0\u4e0a\u5373\u53ef\u3002\n\n\u4f46\u662f\u90a3\u4e2a\u5f0f\u5b50\u4e0d\u8db3\u4ee5\u63a8\u51fa\u7b54\u6848\uff0c\u56e0\u4e3a\u8fd8\u6709\u4e00\u4e2a\u91cd\u8981\u7684\u4e1c\u897f\uff0c\u90a3\u5c31\u662f\u6ca1\u6709\u8003\u8651 $i$ \u7684\u8d21\u732e\uff0c\u7136\u540e\u6211\u4eec\u8bb0\u5f55\u4e00\u4e0b\u4e00\u68f5\u5b50\u6811\u4e2d\u6709\u591a\u5c11\u4e2a\u548c $i$ \u989c\u8272\u76f8\u53cd\u7684\u7ed3\u70b9\uff0c\u7136\u540e\u7edf\u8ba1\u7b54\u6848\u5373\u53ef\u3002\n\n\u6700\u540e\u8bb0\u5f55\u4e0b\u6765\u94a6\u5b9a $k$ \u573a\u7684\u65b9\u6848\u6570\uff0c\u76f4\u63a5\u53cd\u6f14\u5373\u53ef\u3002\n\n\u53ea\u653e\u91cd\u8981\u90e8\u5206\u7684\u4ee3\u7801\u4e86\uff0c\u5206\u90e8\u662f $dfs$ \u8fdb\u884c\u6811\u4e0a\u80cc\u5305\u7684\u90e8\u5206\u4ee5\u53ca\u4e8c\u9879\u5f0f\u53cd\u6f14\u7684\u90e8\u5206\u3002\n\n```\nvoid dfs(int x,int fa_)\n{\n\tsiz[a[x]][x]=1;dp[x][0]=1;\n\tfor(int i=head[x];i;i=nxt[i])\n\t{\n\t\tint y=to[i];if(y==fa_)continue;dfs(y,x);\n\t\tint lim=min(siz[0][x]+siz[0][y],siz[1][x]+siz[1][y]);\n\t\tfor(int j=0;j<=lim;j++)f[j]=0;\n\t\tfor(int j=0;j<=min(siz[0][x],siz[1][x]);j++)for(int k=0;k<=min(siz[0][y],siz[1][y]);k++)\n\t\t\tif(j+k<=lim)f[j+k]=(f[j+k]+dp[x][j]*dp[y][k]%mod)%mod;\n\t\tfor(int j=0;j<=lim;j++)dp[x][j]=f[j];\n\t\tfor(int j=0;j<=1;j++)siz[j][x]+=siz[j][y];\n\t}\n\tfor(int j=0;j<=min(siz[0][x],siz[1][x]);j++)f[j]=dp[x][j];\n\tfor(int j=1;j<=min(siz[0][x],siz[1][x]);j++)dp[x][j]=(f[j-1]*max(0ll,siz[a[x]^1][x]-j+1)%mod+f[j])%mod;\n\tif(x==1)for(int j=0;j<=n/2;j++)F[j]=dp[x][j];\n}\n```\n\n```\nfor(int i=0;i<=n/2;i++)\n{\n\tint ans=0,now=1;\n\tfor(int j=i;j<=n/2;j++)\n\t{\n\t\tans=(ans+now*F[j]*fac[n/2-j]%mod*C(i,j)%mod)%mod;\n\t\tnow=now*-1;ans=(ans%mod+mod)%mod;\n\t}\n\tprintf(\"%lld\\n\",ans);\n}\n```",
        "postTime": 1611756627,
        "uid": 97136,
        "name": "chenzida",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6478 \u3010[NOI Online #2 \u63d0\u9ad8\u7ec4] \u6e38\u620f\u3011"
    },
    {
        "content": "\u770b\u5230\u9898\u9762\u95ee \u201c\u6070\u597d\u201d\uff0c\u81ea\u7136\u7684\u60f3\u5230\u5bb9\u65a5\u6216\u8005\u4e8c\u9879\u5f0f\u53cd\u6f14\u3002\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u4e8c\u9879\u5f0f\u53cd\u6f14\u3002\n\n\u8bbe $f(k)$ \u8868\u793a\u5b58\u5728 $k$ \u4e2a\u80dc\u8d1f\u5c40\u7684\u65b9\u6848\u6570\uff0c$g(k)$ \u8868\u793a\u6070\u597d $k$ \u4e2a\u80dc\u8d1f\u5c40\u7684\u65b9\u6848\u6570\u3002\u90a3\u4e48 $f(k)=\\sum\\limits_{i=k}^n\\binom{i}{k}g(i) \\Leftrightarrow g(k)=\\sum\\limits_{i=k}^n(-1)^{i-k}\\binom{i}{k}f(i)$\u3002\u6211\u4eec\u8981\u6c42\u7684\u5c31\u662f $g$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u4e3b\u8981\u4efb\u52a1\u662f\u6c42 $f$\uff0c\u60f3\u5230\u7528\u6811\u4e0a\u80cc\u5305\u3002\n\n\u8bbe $f(x,j)$ \u8868\u793a $x$ \u4e3a\u6839\u7684\u5b50\u6811\u5185\u9009\u51fa $j$ \u5bf9\u80dc\u8d1f\u70b9\u7684\u65b9\u6848\u6570\u3002\u8f6c\u79fb\u6709\u4e24\u79cd\u60c5\u51b5\uff0c\u7b2c\u4e00\u662f\u5b50\u6811\u4e4b\u95f4\u5408\u5e76\uff0c\u7b2c\u4e8c\u662f $x$ \u70b9\u8ddf\u5b50\u6811\u5185\u7684\u70b9\u914d\u5bf9\uff0c\u8fd9\u5728\u5b50\u6811\u5408\u5e76\u540e\u505a\u4e00\u6b21\u5c31\u884c\u3002\n\n\u6700\u540e\uff0c\u6bcf\u4e00\u4e2a $f(1,j)$ \u8981\u4e58\u4e0a $(n/2-j)!$\uff0c\u56e0\u4e3a\u9009\u70b9\u6709\u5148\u540e\u5173\u7cfb\u3002\n\n\u4e0b\u9762\u662f AC \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\nconst int M = 998244353ll;\n\nint n,a[5005],g[5005],f[5005][5005],f1[5005];\nint ee,h[5005],nex[5005<<1],to[5005<<1];\nint siz[5005][3],c[5005][5005],fac[5005];\n\nvoid addedge(int x,int y)\n{\n\tnex[++ee] = h[x], to[ee] = y, h[x] = ee;\n}\n\nvoid dfs(int x,int pre)\n{\n\tsiz[x][a[x]] = siz[x][2] = 1;\n\tf[x][0] = 1;\n\tfor(int i=h[x];i;i=nex[i])\n\t\tif(to[i]!=pre)\n\t\t{\n\t\t\tdfs(to[i],x);\n\t\t\tint y=to[i];\n\t\t\tfor(int j=0;j<=siz[x][2]+siz[y][2];j++)\n\t\t\t\tf1[j] = 0;\n\t\t\tfor(int j=0;j<=min(siz[x][2],n/2);j++)\n\t\t\t\tfor(int k=0;k<=min(siz[y][2],n/2);k++)\n\t\t\t\t\tf1[j+k] = (f1[j+k]+f[x][j]*f[y][k])%M;\n\t\t\tfor(int j=0;j<=siz[x][2]+siz[y][2];j++)\n\t\t\t\tf[x][j] = f1[j];\n\t\t\tsiz[x][0] += siz[y][0], siz[x][1] += siz[y][1], siz[x][2] += siz[y][2];\n\t\t}\n\tif(a[x]==0)\n\t{\n\t\tfor(int j=min(siz[x][0],siz[x][1]);j>=1;j--)\n\t\t\tf[x][j] = (f[x][j]+f[x][j-1]*(siz[x][1]-(j-1)))%M;\n\t}\n\tif(a[x]==1)\n\t{\n\t\tfor(int j=min(siz[x][0],siz[x][1]);j>=1;j--)\n\t\t\tf[x][j] = (f[x][j]+f[x][j-1]*(siz[x][0]-(j-1)))%M;\n\t}\n}\n\nsigned main()\n{\n\tcin>>n;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tchar ch;\n\t\tcin>>ch;\n\t\ta[i] = ch-'0';\n\t}\n\tfor(int i=1,x,y;i<n&&cin>>x>>y;i++)\n\t\taddedge(x,y), addedge(y,x);\n\tfor(int i=0;i<=n;i++)\n\t\tc[i][0] = 1;\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=i;j++)\n\t\t\tc[i][j] = (c[i-1][j-1]+c[i-1][j])%M;\n\tfac[0] = 1;\n\tfor(int i=1;i<=n;i++)\n\t\tfac[i] = fac[i-1]*i%M;\n\tdfs(1,0);\n\tfor(int i=0;i<=n/2;i++)\n\t\tf[1][i] = f[1][i]*fac[n/2-i]%M;\n\tfor(int k=0;k<=n/2;k++)\n\t{\n\t\tfor(int i=k;i<=n/2;i++)\n\t\t{\n\t\t\tif((i-k)%2==0)\n\t\t\t\tg[k] = (g[k]+c[i][k]*f[1][i]%M+M)%M;\n\t\t\telse\n\t\t\t\tg[k] = (g[k]-c[i][k]*f[1][i]%M+M)%M;\n\t\t}\n\t}\n\tfor(int i=0;i<=n/2;i++)\n\t\tcout<<g[i]<<endl;\n\t\n\treturn 0;\n}\n```\n\n\u795d\u5927\u5bb6 AC \u6109\u5feb\uff01",
        "postTime": 1628411065,
        "uid": 123298,
        "name": "kouylty",
        "ccfLevel": 7,
        "title": "\u9898\u89e3\u3010P6478 [NOI Online #2 \u63d0\u9ad8\u7ec4] \u6e38\u620f\u3011"
    }
]
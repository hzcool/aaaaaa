[
    {
        "content": "\u9996\u5148\uff0c\u8fd9\u662f\u9053\u6784\u9020\u9898~~\u5e9f\u8bdd~~\u3002\u5176\u4e2d 50 \u5206\u7684\u90e8\u5206\u5206\u53ef\u4ee5\u7528\u5dee\u5206\u7ea6\u675f\u6765\u505a\uff08\u4e0e\u6b63\u89e3\u65e0\u5173\uff09\u3002\n\n\u7ecf\u8fc7\u5b9e\u8df5\uff0c\u6211\u4eec\u53d1\u73b0\u9898\u76ee\u7ed9\u7684\u8fd9\u4e2a $j_i$ \u76f8\u5f53\u4e0d\u53cb\u597d\uff0c\u4e0d\u5982\u7edf\u7edf\u52a0\u4e0a $1$\uff0c\u8fd9\u6837\u5b83\u5c31\u4ee3\u8868\u7b2c\u4e00\u4e2a\u5927\u4e8e $x_i+K$ \u7684\u6570\u6240\u5728\u4f4d\u7f6e\uff0c\u8fd9\u4e2a\u6761\u4ef6\u76f8\u5bf9\u6bd4\u8f83\u597d\u8f6c\u5316\u3002\n\n~~\u4f46\u4e5f\u8fd8\u662f\u6ca1\u90a3\u4e48\u597d\u60f3\u3002~~\n\n\u6211\u4eec\u5efa\u7acb\u4e00\u68f5\u6709 $n+1$ \u4e2a\u8282\u70b9\u7684\u6811\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9\uff0c\u4e0e\u7236\u4eb2 $j_i+1$ \u8fde\u4e00\u6761\u8fb9\u3002\u6613\u77e5\u6839\u4e3a $n + 1$\u3002\n\n![\u6837\u4f8b\u89e3\u91ca\uff0c\u6765\u81ea\u5b98\u65b9\u9898\u89e3\uff08\u597d\u4e11\uff09](https://cdn.luogu.com.cn/upload/image_hosting/a0onictu.png)\n\n~~\u8fd9\u662f\u6709\u591a\u7ecf\u8d39\u4e0d\u8db3\u624d\u753b\u51fa\u8fd9\u79cd\u4e1c\u897f\uff08\u607c\uff09~~\n\n\u7531\u4e8e $j_i$ \u4e0d\u964d\uff0c\u53ef\u4ee5\u53d1\u73b0\u5c42\u6b21\u9ad8\uff08\u5373\u9760\u8fd1\u6839\u8282\u70b9\uff0c\u89c1\u56fe\uff09\u7684\u8282\u70b9\u7f16\u53f7\u4e00\u5b9a\u5927\u4e8e\u5c42\u6b21\u4f4e\u7684\u8282\u70b9\u3002\u5e76\u4e14 $j_i+1$ \u5c42\u6b21\u6070\u597d\u6bd4 $i$ \u5927 $1$ ~~\u8fd8\u662f\u5e9f\u8bdd\u3002~~\n\n\u53c8\u6839\u636e\u6784\u9020\u6761\u4ef6\uff0c$x[j_i+1]$ \u5e94\u5f53\u5927\u7ea6\u6bd4 $x[i]$ \u5927 $K$\u3002\u7531\u6b64\u53ef\u4ee5\u731c\u6d4b\u6bcf\u4e2a\u8282\u70b9\u6743\u503c\u4e3a $d[i] * K + x'(0 \\le x' < K)$\u3002\n\n\u63a5\u4e0b\u6765\u786e\u5b9a $x'$ \u5982\u4f55\u8d4b\u503c\u3002\u9996\u5148\u6211\u4eec\u5bf9\u4e8e\u540c\u4e00\u5c42\u7684\u8282\u70b9\uff0c\u6309\u7167\u7f16\u53f7\u4ece\u5927\u5230\u5c0f\u8003\u8651\uff0c\u7531\u4e8e\u52a0\u8fb9\u987a\u5e8f\u4ece\u5c0f\u5230\u5927\uff0c\u7528\u94fe\u5f0f\u524d\u5411\u661f\u53ef\u4ee5\u81ea\u7136\u5730\u5b9e\u73b0\u8fd9\u4e00\u70b9\uff08\u5f53\u7136 vector \u4e5f\u65e0\u975e\u5c31\u662f\u5012\u5e8f\u5faa\u73af\u7684\u4e8b\u60c5\uff09\u3002\n\n\u6211\u4eec\u8981\u4f7f\u5f97\u540c\u4e00\u5c42\u6392\u5728\u540e\u9762\u7684\u8282\u70b9\uff0c$x'$ \u90fd\u5c0f\u4e8e\u5b83\u7684\u4efb\u610f\u5b50\u8282\u70b9\uff0c\u4e0e\u6b64\u540c\u65f6\uff0c\u5b83\u81ea\u5df1\u7684 $x'$ \u8981\u5927\u4e8e\u5b83\u7684\u4efb\u610f\u513f\u5b50\u3002\n\n~~\u81ea\u5df1\u7684\u5b69\u5b50\u5f52\u81ea\u5df1\u7ba1\uff0c\u522b\u4eba\u7ba1\u4e0d\u7740~~\n\n\u6211\u4eec\u53d1\u73b0 $dfs$ \u5e8f\u5b8c\u7f8e\u5730**\u4e0d**\u7b26\u5408\u8fd9\u4e2a\u6761\u4ef6\u3002\u4e8e\u662f\u6211\u4eec\u4ee4 $x' = K - dfn[i]$\u3002~~\uff08\u9003~~\n\n\uff08\u5b98\u65b9\u6837\u4f8b\u89e3\u91ca\u5b9e\u5728\u592a\u4e11\uff0c\u4e0d\u653e\u4e86\uff09\n\n\u7531\u4e8e $x' \\ge 0$\uff0c\u4ee4 $K \\ge n + 1$ \u5373\u53ef\u3002~~\u4e0d\u8fc7\u8981\u6ce8\u610f\u89c4\u5b9a\u7684 $x_i$ \u8303\u56f4\u3002~~\n\n```cpp\n#include<algorithm>\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<queue>\n#include<vector>\n#define miu 100007\nusing namespace std;\ninline int read() {\n    register int x = 0; register char ch = getchar();\n    while(ch < '0' || ch > '9') ch = getchar();\n    while(ch >= '0' && ch <= '9') {x = x * 10 + ch - 48; ch = getchar();}\n    return x;\n}\nstruct edge {\n    int v, nxt;\n}e[miu];\nint head[miu], eid;\ninline void insert(int x, int y) {\n    e[++eid].v = y; e[eid].nxt = head[x]; head[x] = eid;\n}\nint ans[miu], d[miu], bonus, n, k;\nvoid dfs(int x) {\n    ans[x] = bonus--;\n    for(int i = head[x]; i; i = e[i].nxt) {\n        int to = e[i].v;\n        d[to] = d[x] + 1;\n        dfs(to);\n    }\n}\nint suc;\nsigned main() {\n    n = read(); k = n + 2; bonus = n + 1;\n    for(int i = 1; i <= n; ++i) {\n        suc = read(); insert(++suc, i);\n    }\n    dfs(n + 1);\n    printf(\"%d\\n\", k);\n    for(int i = 1; i <= n; ++i) {\n        printf(\"%lld\\n\", 1ll * k * (d[1] - d[i]) + ans[i]);\n    }\n    return 0;\n}\n\n```\n",
        "postTime": 1644232747,
        "uid": 145994,
        "name": "\u8036\u68a6\u52a0\u5f97",
        "ccfLevel": 8,
        "title": "P8098 [USACO22JAN] Tests for Haybales G"
    },
    {
        "content": "\u7b2c\u4e00\u773c\u62ff\u5230\u8fd9\u9898\uff0c\u60f3\u5230\u7684\u5e94\u8be5\u76f4\u63a5\u5c31\u662f\u5dee\u5206\u7ea6\u675f\uff01\u4e0d\u59a8\u4ee4 $K=n+1$\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u6761\u4ef6\uff08\u7b2c $i$ \u4e2a\u70b9\u8f93\u5165\u662f $j$\uff09\u662f\u8fd9\u6837\u7684\u7ea6\u675f\u5173\u7cfb\uff1a\n\n$$a_j-a_i\\le K(1)$$\n\n$$a_{j+1}-a_i\\ge K+1(2)$$\n\n\n\u518d\u8865\u5145\u4e0a\uff1a\n\n$$a_{i+1}-a_i \\ge 0(3)$$\n\n\u6309\u7167\u4ee5\u4e0a\u4e09\u4e2a\u6761\u4ef6\u8fde\u8fb9\u5373\u53ef\u3002\u4e8e\u662f\u4f60\u53d1\u73b0\u6837\u4f8b\u5c31\u8fc7\u4e86\uff0c\u63d0\u4ea4\u53d1\u73b0\u5c45\u7136 $50\\%$\u3002\u7136\u540e\u53d1\u73b0 SPFA \u6b7b\u4e86\u3002\u4ee5\u4e0b\u662f Luogu $48$ \u5206\u4ee3\u7801\uff08\u901a\u8fc7 $50\\%$\uff09\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nconst int N=5e5+5;\nconst ll inf=100000000000000000;\nll dis[N],v[2*N];\nint vis[N],n,m,k;\nint cnt,nxt[2*N],t[2*N],h[2*N],num[2*N];\ninline void add(int x,int y,int z) //x-y<=z\n{\n\tswap(x,y);\n\tt[++cnt]=y;\n\tv[cnt]=z;\n\tnxt[cnt]=h[x];\n\th[x]=cnt;\n}\nqueue <int> q;\nvoid spfa(int s)\n{\n\tfor (int i=1;i<=n;i++) dis[i]=inf,vis[i]=0;\n\tdis[s]=0,vis[s]=1,num[s]=1;\n\tq.push(s);\n\twhile (!q.empty())\n\t{\n\t\tint u=q.front();\n\t\tq.pop();\n\t\tvis[u]=0;\n\t\tfor (int i=h[u];i;i=nxt[i])\n\t\t{\n\t\t\tif (dis[t[i]]>dis[u]+v[i])\n\t\t\t{\n\t\t\t\tdis[t[i]]=dis[u]+v[i];\n\t\t\t\tif (vis[t[i]]==0)\n\t\t\t\t{\n\t\t\t\t\tvis[t[i]]=1;\n\t\t\t\t\tnum[t[i]]++;\n\t\t\t\t\tif (num[t[i]]>n)\n\t\t\t\t\t{\n\t\t\t\t\t\tprintf(\"NO\");\n\t\t\t\t\t\texit(0);\n\t\t\t\t\t}\n\t\t\t\t\tq.push(t[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\ninline int read()\n{\n\tchar C=getchar();\n\tint F=1,ANS=0;\n\twhile (C<'0'||C>'9')\n\t{\n\t\tif (C=='-') F=-1;\n\t\tC=getchar();\n\t}\n\twhile (C>='0'&&C<='9')\n\t{\n\t\tANS=ANS*10+C-'0';\n\t\tC=getchar();\n\t}\n\treturn F*ANS;\n} \nint main()\n{\n\tn=read(),k=n+1;\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tint x=read();\n\t\tif (x!=i) add(x,i,k);\n\t\tif (x!=n) add(i,x+1,-k-1);\n\t}\n\tfor (int i=1;i<=n;i++) add(i,0,0);\n\tfor (int i=1;i<n;i++) add(i,i+1,0);\n\tspfa(0);\n\tprintf(\"%d\\n\",k);\n\tfor (int i=1;i<=n;i++) printf(\"%lld\\n\",dis[i]+inf);\n\treturn 0;\n}\n```\n\n\u56e0\u4e3a\u5b58\u5728\u8d1f\u6743\u8fb9\uff0c\u6240\u4ee5\u4e0d\u80fd\u4f7f\u7528 Dij \u7b49\u5176\u4ed6\u6700\u77ed\u8def\u7b97\u6cd5\u3002\u90a3\u4e48\u600e\u4e48\u89e3\u51b3\u8d1f\u6743\uff1f\n\n\u5148\u628a\u539f\u5e8f\u5217\u5207\u6210\u51e0\u6bb5\uff0c\u6bcf\u78b0\u5230\u4e00\u4e2a $i=j_i$ \u7684\u5c31\u5207\u4e00\u4e0b\u3002\u663e\u7136\u6bb5\u548c\u6bb5\u4e4b\u95f4\u4e0d\u5f71\u54cd\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u6bb5\uff0c\u6211\u4eec\u518d\u8003\u8651\u5206\u5c42\u3002\u6700\u540e\u4e00\u4e2a\u662f\u7b2c $0$ \u5c42\uff0c\u5176\u4ed6\u7684\u7b2c $i$ \u4e2a\u5c31\u662f $j_i$ \u7684\u5c42\u6570\u518d\u52a0\u4e00\u3002\n\n\u6211\u4eec\u4ee4\u7b2c $i$ \u5c42\u7684\u521d\u59cb\u6743\u503c\u4e3a $-iK$\u3002\u8fd9\u6837\u4f1a\u53d1\u73b0\uff0c\u6761\u4ef6 $(1)$ \u4e2d\u7684 $i,j$ \u5fc5\u7136\u9694\u4e00\u5c42\uff0c\u90a3\u4e48 $K$ \u5c31\u6d88\u6389\u4e86\u3002\u6761\u4ef6 $(2)$ \u4e2d $i,j+1$ \u5272\u4e00\u5c42\u6216\u4e24\u5c42\uff0c\u4e24\u5c42\u7684\u8bdd\u5c31\u4e0d\u7528\u8003\u8651\uff0c\u5426\u5219 $K$ \u4e5f\u6d88\u6389\u4e86\u3002\u6761\u4ef6 $(3)$ \u5bf9\u4e8e\u540c\u4e00\u5c42\u7684\u7167\u6837\u505a\u5c31\u884c\u4e86\u3002\n\n\u4e8e\u662f\u539f\u6765\u7684\u6761\u4ef6\u7684\u6743\u503c\u53ea\u6709 $0$ \u548c $1$ \u4e86\uff0c\u5bb9\u6613\u53d1\u73b0\u56fe\u53d8\u6210\u4e86 DAG\uff0c\u56e0\u6b64\u53ef\u4ee5\u7ebf\u6027\u6c42\u51fa\u6700\u957f\u8def\u3002\n\n\u8bb0\u5f97\u628a\u6bcf\u4e2a\u6570\u6539\u4e3a\u975e\u8d1f\u6574\u6570\uff0c\u8fd8\u6709\u6bb5\u548c\u6bb5\u4e4b\u95f4\u7684\u95f4\u9694\u8981\u6ce8\u610f\u3002\n\n```cpp\n// By: Little09\n// Problem: P8098 [USACO22JAN] Tests for Haybales G\n// Contest: Luogu\n// URL: https://www.luogu.com.cn/problem/P8098\n// Memory Limit: 256 MB\n// Time Limit: 2000 ms\n// \n// Powered by CP Editor (https://cpeditor.org)\n\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nconst int N=5e5+5;\nconst ll inf=100000000000000000;\nll dis[N],v[2*N],k;\nint a[N];\nbool used[N];\nint n,m;\nint cnt,nxt[2*N],t[2*N],h[2*N],d[N];\ninline void add(int x,int y,int z) //x-y>=z\n{\n\tswap(x,y);\n\tt[++cnt]=y;\n\tv[cnt]=z;\n\tnxt[cnt]=h[x];\n\th[x]=cnt;\n\td[y]++;\n}\nqueue<int>q;\nvoid topo(int s,int l,int r)\n{\n\tfor (int i=l;i<=r;i++) dis[i]=0,used[i]=0;\n    q.push(s);\n    dis[s]=0;\n    for (int i=l;i<=r;i++) if (d[i]==0) q.push(i);\n    while (!q.empty())\n    {\n    \tint u=q.front();\n    \tq.pop();\n    \tfor (int i=h[u];i;i=nxt[i])\n    \t{\n    \t\td[t[i]]--;\n    \t\tdis[t[i]]=max(dis[t[i]],dis[u]+v[i]);\n    \t\tif (d[t[i]]==0) q.push(t[i]);\n    \t}\n    }\n}\ninline int read()\n{\n\tchar C=getchar();\n\tint F=1,ANS=0;\n\twhile (C<'0'||C>'9')\n\t{\n\t\tif (C=='-') F=-1;\n\t\tC=getchar();\n\t}\n\twhile (C>='0'&&C<='9')\n\t{\n\t\tANS=ANS*10+C-'0';\n\t\tC=getchar();\n\t}\n\treturn F*ANS;\n} \nint deth[N];\nvoid work(int l,int r,ll qwq)\n{\n\tdeth[r]=0;\n\tfor (int i=0;i<=cnt;i++)\n\t{\n\t\tnxt[i]=0,v[i]=0,t[i]=0;\n\t}\n\tfor (int i=l;i<=r;i++) h[i]=0,d[i]=0;\n\th[0]=0,d[0]=0;\n\tcnt=0;\n\tfor (int i=r-1;i>=l;i--) deth[i]=deth[a[i]]+1;\n\tfor (int i=l;i<r;i++)\n\t{\n\t\tif (deth[i]==deth[i+1])\n\t\t{\n\t\t\tadd(i+1,i,0);\n\t\t}\n\t}\n\tfor (int i=l;i<r;i++)\n\t{\n\t\tadd(i,a[i],0);\n\t\tif (a[i]+1<=r&&deth[a[i]+1]==deth[a[i]]) \n\t\t\tadd(a[i]+1,i,1);\n\t}\n\tfor (int i=l;i<=r;i++) add(i,0,0);\n\ttopo(0,l,r);\n\tfor (int i=l;i<=r;i++) dis[i]-=1ll*deth[i]*k;\n\tfor (int i=r;i>=l;i--) dis[i]-=dis[l];\n\tfor (int i=l;i<=r;i++) dis[i]+=qwq;\n\t\n}\nint main()\n{\n\tn=read(),k=n+1;\n\tfor (int i=1;i<=n;i++) a[i]=read();\n\tint las=1;\n\tll tmp=0;\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tif (a[i]==i) \n\t\t{\n\t\t\twork(las,i,tmp+k+1);\n\t\t\tlas=i+1,tmp=dis[i];\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",k);\n\tfor (int i=1;i<=n;i++) printf(\"%lld\\n\",dis[i]);\n\treturn 0;\n}\n```\n",
        "postTime": 1644054718,
        "uid": 151475,
        "name": "Little09",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P8098 [USACO22JAN] Tests for Haybales G"
    },
    {
        "content": "> \u6709\u4e00\u4e2a\u957f\u4e3a $n$ \u7684\u9012\u589e\u7684\u6574\u6570\u6570\u7ec4\u6ee1\u8db3 $x_1\\le x_2\\le \\cdots\\le x_n$ \u548c\u4e00\u4e2a\u6574\u6570 $k$\u3002\u4f60\u4e0d\u77e5\u9053\u8fd9\u4e2a\u6570\u7ec4 $x$ \u548c\u8fd9\u4e2a\u6574\u6570 $k$\uff0c\u4f46\u4f60\u77e5\u9053\u5bf9\u4e8e\u6bcf\u4e2a\u4e0b\u6807 $i$ \u6ee1\u8db3 $x_{j_i}\\le x_i+k$ \u7684\u6700\u5927\u4e0b\u6807 $j_i$\u3002\u4fdd\u8bc1 $i\\le j_i$\uff0c\u4e14 $j_1\\le j_2\\le \\cdots\\le j_n\\le n$\u3002\u901a\u8fc7 $j$ \u6570\u7ec4\uff0c\u6784\u9020\u4e00\u4e2a\u4efb\u610f\u6570\u7ec4 $x$ \u548c\u6574\u6570 $k$ \u6ee1\u8db3\u4e0a\u8ff0\u6761\u4ef6\uff0c\u9700\u8981\u6ee1\u8db3 $1\\le x_i,k\\le 10^{18}$\uff0c\u53ef\u4ee5\u8bc1\u660e\u7b54\u6848\u4e00\u5b9a\u5b58\u5728\u3002($1\\le n\\le 10^5$)\n\n\u795e\u4ed9\u6784\u9020\u9898\u3002\u8003\u8651\u628a\u9898\u76ee\u4e2d\u7684\u5173\u7cfb\u63cf\u8ff0\u4e3a\u6811\u5f62\u7684\u5173\u7cfb\uff0c\u5177\u4f53\u6765\u8bb2\u662f\u8fde $j_i+1\\rightarrow i$ \u7684\u8fb9\uff0c\u8fd9\u6837\u80fd\u5f62\u6210\u4e00\u68f5\u5916\u5411\u6811\uff0c\u5176\u4e2d\u7236\u5b50\u5173\u7cfb $u\\rightarrow v$ \u8868\u793a $u$ \u662f\u7b2c\u4e00\u4e2a\u6ee1\u8db3 $x_u>x_v+k$ \u7684\u4e0b\u6807\u3002\u663e\u7136\u8fd9\u6837\u4f1a\u591a\u51fa\u4e00\u4e2a\u865a\u8282\u70b9 $n+1$\uff0c\u5b83\u5c31\u662f\u6839\uff0c\u4e14\u4e0d\u7ba1\u600e\u4e48\u6837\u90fd\u53ef\u4ee5\u9632\u6b62\u5f62\u6210\u68ee\u6797\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u53d1\u73b0\u5bf9\u4e8e\u6811\u4e0a\u540c\u4e00\u5c42\u7684\u7ed3\u70b9\uff0c\u6211\u4eec\u5173\u5fc3\u7684\u662f\u5b83\u4eec\u4e4b\u95f4\u6bd4\u8f83\u201c\u5fae\u5c0f\u201d\u7684\u6570\u91cf\u53d8\u5316\uff0c\u800c\u5bf9\u4e8e\u4e0d\u540c\u5c42\u7684\u7ed3\u70b9\u6211\u4eec\u5173\u5fc3\u7684\u662f\u201c\u8f83\u5927\u201d\u7684\u6570\u91cf\u53d8\u5316\u3002\u80fd\u53d1\u73b0\uff0c\u8fd9\u91cc\u5927\u5c0f\u7684\u5b9a\u4e49\u5c31\u662f\u4e0e $k$ \u7684\u5173\u7cfb\uff0c\u7236\u4eb2\u7ed3\u70b9\u548c\u513f\u5b50\u7ed3\u70b9\u4e4b\u95f4\u7684\u5dee\u201c\u5927\u7ea6\u201d\u662f $k$\uff0c\u800c\u540c\u5c42\u53ea\u9700\u8981\u8003\u8651\u9012\u589e\u7684\u6761\u4ef6\u5fae\u8c03\u4e00\u4e0b\u5373\u53ef\u3002\n\n\u6709\u4e86\u8fd9\u4e2a\u53d1\u73b0\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5b9a\u4e49\u6bcf\u4e2a\u7ed3\u70b9\u7684\u6743\u503c\u662f $h_ik+y_i(0\\le x_i<k)$\uff0c\u5176\u4e2d $h_i$ \u662f\u8be5\u70b9\u8ddd\u79bb\u6700\u6df1\u7684\u53f6\u5b50\u7ed3\u70b9\u7684\u8ddd\u79bb\uff0c\u53ef\u4ee5\u5f62\u8c61\u7406\u89e3\u4e3a\u9ad8\u5ea6\u3002\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u6743\u503c\u5b8c\u5168\u7b26\u5408\u521a\u521a\u7684\u5206\u6790\uff0c\u4e0d\u540c\u5c42\u4e4b\u95f4\u5dee\u7684\u5927\u7ea6\u662f $k$\uff0c\u8fd8\u6709 $y_i$ \u4e4b\u95f4\u7684\u5c0f\u5c0f\u8c03\u6574\uff0c\u800c\u540c\u5c42\u4e4b\u95f4\u53ea\u6709 $y_i$ \u4e4b\u95f4\u7684\u5c0f\u5c0f\u8c03\u6574\u3002\u73b0\u5728\u7684\u76ee\u6807\u5c31\u662f\u6070\u5f53\u7684\u7ed9 $y_i$ \u8d4b\u503c\u4e86\u3002\n\n\u7ed9 $y_i$ \u8d4b\u503c\u7684\u9650\u5236\u5728\u4e8e\u6ee1\u8db3\u539f\u9898\u9012\u589e\u7684\u9650\u5236\uff0c\u56e0\u4e3a\u4e00\u65e6\u6570\u7ec4\u9012\u589e\uff0c\u5176\u4ed6\u7684\u9650\u5236\u90fd\u80fd\u88ab\u6ee1\u8db3\u3002\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u679c\u4ece\u6839\u8282\u70b9\u5f00\u59cb $\\rm dfs$\uff0c\u6bcf\u6b21\u8bbf\u95ee\u5b50\u8282\u70b9\u90fd\u6309\u7167\u7f16\u53f7\u4ece\u5927\u5230\u8bbf\u95ee\uff0c\u6ee1\u8db3 $y_i$ \u6309\u7167\u8bbf\u95ee\u6b21\u5e8f\u9012\u51cf\uff0c\u5c31\u80fd\u6ee1\u8db3\u6761\u4ef6\u3002\u9996\u5148\u56e0\u4e3a $h_ik$\uff0c\u9ad8\u5c42\u4e00\u5b9a\u5927\u4e8e\u4f4e\u5c42\uff0c\u800c\u53c8\u56e0\u4e3a $i\\le j_i$\uff0c\u9ad8\u5c42\u7f16\u53f7\u4e00\u5b9a\u5927\u4e8e\u4f4e\u5c42\u7f16\u53f7\uff0c\u6240\u4ee5\u5927\u4f53\u4e0a\u7684\u9012\u589e\u662f\u6ee1\u8db3\u7684\u3002\u800c\u6bcf\u6b21\u6211\u4eec\u53c8\u662f\u6309\u7167\u7f16\u53f7\u4ece\u5927\u5230\u5c0f\u8bbf\u95ee\u5b50\u8282\u70b9\u7684\uff0c\u540c\u5c42\u7684\u53c8\u80fd\u4fdd\u8bc1\u9012\u589e\uff08\u5bb9\u6613\u53d1\u73b0\u4e0d\u540c\u7684\u7236\u4eb2\u7ed3\u70b9\u5bf9\u5e94\u7684\u513f\u5b50\u96c6\u5408\u7684\u7f16\u53f7\u662f\u4e2a\u533a\u95f4\u4e14\u4e0d\u4f1a\u76f8\u4ea4\uff0c\u4e14\u662f\u6309\u7167\u7236\u4eb2\u7ed3\u70b9\u7684\u5927\u5c0f\u6392\u5217\u7684\uff09\uff0c\u6240\u4ee5\u6574\u4f53\u6ee1\u8db3\u9012\u589e\u3002\n\n\u81f3\u4e8e $k$ \u7684\u9009\u62e9\uff0c\u56e0\u4e3a $y_i$ \u8981 $n$ \u4e2a\u7ed3\u70b9\u4eba\u624b\u4e00\u4e2a\uff0c\u8fd8\u8981\u4fdd\u8bc1\u5355\u8c03\u9012\u51cf\uff08\u8fd9\u662f\u56e0\u4e3a\u7236\u4eb2\u7ed3\u70b9\u548c\u513f\u5b50\u7ed3\u70b9\u4e4b\u95f4\u7684\u5173\u7cfb\u662f $<$\uff0c\u6240\u4ee5 $y_i$ \u4e5f\u8981\u5355\u8c03\u9012\u51cf\uff09\uff0c\u6240\u4ee5 $k$ \u9009 $n+1$ \u5c31\u597d\uff0c\u6bcf\u6b21 $-1$\u3002\u597d\u4e86\uff0c\u5206\u6790\u5b8c\u8fd9\u4e48\u591a\uff0c\u5b9e\u73b0\u4e00\u904d $\\rm dfs$ \u5c31\u80fd\u641e\u5b9a\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n)$\u3002\n```cpp\n#include <cstdio>\n#include <vector>\n#include <algorithm>\nconst int N = 1e5 + 10; std::vector<int> T[N]; int dep[N], x[N], now, mx;\nvoid dfs(int u, int depth)\n{\n\tdep[u] = depth; x[u] = now--;\n\tfor (auto v : T[u]) dfs(v, depth + 1);\n}\nint main()\n{\n\tint n; scanf(\"%d\", &n);\n\tfor (int i = 1, j; i <= n; ++i) scanf(\"%d\", &j), T[j + 1].push_back(i);\n\tfor (int i = 1; i <= n + 1; ++i) std::sort(T[i].begin(), T[i].end(), [](const int& a, const int& b) { return a > b; });\n\tnow = n + 1; dfs(n + 1, 0); for (int i = 1; i <= n + 1; ++i) mx = std::max(mx, dep[i]);\n\tprintf(\"%d\\n\", n + 1);\n\tfor (int i = 1; i <= n; ++i) printf(\"%lld\\n\", 1ll * (mx - dep[i]) * (n + 1) + x[i]);\n\treturn 0;\n}\n```",
        "postTime": 1643982084,
        "uid": 137603,
        "name": "zhiyangfan",
        "ccfLevel": 9,
        "title": "P8098 [USACO22JAN] Tests for Haybales G \u9898\u89e3"
    },
    {
        "content": "# [[USACO22JAN] Tests for Haybales G](https://www.luogu.com.cn/problem/P8098)\n\n\u8fd9\u662f\u4e00\u9053\u6781\u4e3a\u7b80\u5355\u7684\u6784\u9020\u9898\u3002\n\n# Solution\n\n>- \u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u6700\u5927\u7d22\u5f15 $j_i$\uff0c\u5982\u679c $j_i \\neq i$\uff0c\u6211\u4eec\u8fde\u4e00\u6761 $j_i$ \u5411 $i$ \u7684\u8fb9\uff0c\u6700\u540e\u5f88\u5bb9\u6613\u5c31\u53d1\u73b0\u5f62\u6210\u4e86\u82e5\u5e72\u68f5\u6811\uff08\u6839\u8282\u70b9\u4e3a $j_i = i$ \u7684\u8282\u70b9\uff09\u3002\n\n>- \u5982\u679c\u7528 vector \u5b58\u8fb9\uff0c\u5f88\u5bb9\u6613\u5c31\u53ef\u4ee5\u53d1\u73b0\u5bf9\u4e8e\u4e00\u68f5\u6811\uff0c\u8282\u70b9\u7f16\u53f7\u662f\u4ece\u4e0b\u5230\u4e0a\uff0c\u4ece\u5de6\u5230\u53f3\u4f9d\u6b21\u52a0\u4e00\u7684\u3002\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5bf9\u4e8e \n\n`5 5 5 6 7 7 7`\n\n\u5efa\u51fa\u6765\u7684\u6811\u5982\u4e0b\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8gl6shfv.png)\n\n>- \u5bf9\u4e8e\u6811\u4e0a\u7684\u6bcf\u4e00\u4e2a\u70b9\uff0c\u5c06\u503c\u8bbe\u4e3a\n$$Ans_i = diff - depth_i \\times k + dfn_i$$\n\n>> \u5176\u4e2d $diff$\uff0c$k$ \u53ef\u4ee5\u968f\u4fbf\u8bbe\uff08\u53ea\u8981\u591f\u5927\u5c31\u884c\uff09\uff0c$depth_i$ \u4e3a $i$ \u8282\u70b9\u7684\u6df1\u5ea6\uff0c$dfn_i$ \u4e3a $i$ \u8282\u70b9\u7684 dfs \u5e8f\u3002\n\n>- \u8bc1\u660e\u6b63\u786e\u6027\uff1a~~\u663e\u7136\u6613\u8bc1~~\n\n>- \u6bcf\u5904\u7406\u5b8c\u4e00\u68f5\u6811 $diff$ \u90fd\u8981\u52a0\u4e0a\u4e00\u4e2a\u8f83\u5927\u7684\u6570\uff0c\u4ee5\u514d\u4e24\u68f5\u6811\u4e4b\u95f4\u4e92\u76f8\u5e72\u6270\u3002\n\n# Code\n\n```\n#include<bits/stdc++.h>\n#define rep(i , m , n) for(register int i = m; i <= n; i++)\n#define int long long\n\nusing namespace std;\nconst int Dif = 1e12;\nint k = 1e6 , diff = 1e12;\nvector<int> e[100005];\nint n , a[100005] , tot = 0;\nvoid Change(int u , int dep){\n\tfor(int i = 0; i < e[u].size(); i++)a[e[u][i]] = diff - k * dep + tot , tot++ , Change(e[u][i] , dep + 1);\n}\nsigned main(){\n\tscanf(\"%lld\" , &n);\n\trep(i , 1 , n){\n\t\tint x;\n\t\tscanf(\"%lld\" , &x);\n\t\tif(x != i)e[x].push_back(i);\n\t\telse a[i] = diff , tot = 1 , Change(i , 1) , diff += Dif;\n\t}\n\tprintf(\"%lld\\n\" , k);\n\trep(i , 1 , n)printf(\"%lld\\n\" , a[i]);\n\treturn 0;\n}\n```\n",
        "postTime": 1685018807,
        "uid": 59691,
        "name": "\u51d1\u4e2a\u70ed\u95f9\u5416",
        "ccfLevel": 7,
        "title": "[USACO22JAN] Tests for Haybales G"
    },
    {
        "content": "\u5bf9\u4e8e\u6240\u6709\u7684 $i$\uff0c\u4ece\u70b9 $i$ \u5f80\u70b9 $j_i$ \u8fde\u8fb9\uff08$i=j_i$ \u7684\u4e0d\u8fde\uff09\uff0c\u4e8e\u662f\u6709\u82e5\u5e72\u4e2a\u6811\uff0c\u4e14\u6bcf\u68f5\u6811\u5185\u5305\u542b\u7684\u70b9\u5e8f\u53f7\u4e3a\u4e00\u4e2a\u8fde\u7eed\u6bb5\u3002\n\n\u5bf9\u6bcf\u68f5\u6811\u5206\u522b\u5904\u7406\u3002\n\n\u628a\u5e8f\u53f7\u6700\u5927\u7684\u70b9\uff08\u4e5f\u5c31\u662f\u6ee1\u8db3 $i=j_i$ \u7684\u70b9\uff09\u770b\u4f5c\u6839\uff0c\u5bf9\u4e8e\u6240\u6709\u70b9\uff0c\u5c06\u5176\u7684\u6240\u6709\u513f\u5b50\u6309\u5e8f\u53f7\u4ece\u5c0f\u5230\u5927\u7684\u987a\u5e8f\u4ece\u5de6\u5f80\u53f3\u653e\u7f6e\uff0c\u6df1\u5ea6\u76f8\u540c\u7684\u70b9\u653e\u5728\u540c\u4e00\u884c\u3002\u53ef\u4ee5\u53d1\u73b0\u5e8f\u53f7\u5927\u5c0f\u6ee1\u8db3\u4ece\u6700\u5e95\u884c\u5f80\u4e0a\uff0c\u4ece\u5de6\u5f80\u53f3\u70b9\u7684\u5e8f\u53f7\u4f9d\u6b21 $+1$\u3002\n\n\u4ece\u6839\u5f00\u59cb\u6309\u4ece\u5de6\u5f80\u53f3\u7684\u987a\u5e8f\u8fdb\u884c dfs\uff0c\u8bbe $dep_i$ \u8868\u793a\u70b9 $i$ \u7684\u6df1\u5ea6\uff0c$dfn_i$ \u8868\u793a dfs \u5e8f\uff0c\u5c06\u70b9 $i$ \u7684\u6743\u503c\u8bbe\u4e3a $-dep_i\\times K+dfn_i$ \u5373\u53ef\u6ee1\u8db3\uff08$K$ \u5373\u4e3a\u9898\u610f\u4e2d\u7684 $K$\uff0c\u5176\u503c\u53ea\u8981\u8db3\u591f\u5927\u5373\u53ef\uff09\u3002\n\n\u6839\u636e\u8fd9\u68f5\u6811\u7684\u7ed3\u6784\u5bb9\u6613\u8bc1\u660e\u662f\u5bf9\u7684\u3002\n\n\u6700\u540e\u8c03\u8282\u4e00\u4e0b\uff0c\u5c06\u70b9\u6743\u5168\u90e8\u6539\u4e3a\u975e\u8d1f\uff0c\u76f8\u90bb\u6811\u4e4b\u95f4\u8c03\u8282\u4e00\u4e0b\u5dee\u503c\u5373\u53ef\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nint n,j[100005],lt;\nll x[100005],d=3e12;\nint dr()\n{\n\tint xx=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9')xx=xx*10+ch-'0',ch=getchar();\n\treturn xx*f;\n}\nvector<int> b[100005];int dfn;\nvoid work(int xh,ll dd)\n{\n\t++dfn,x[xh]=dd+dfn;\n\tsort(b[xh].begin(),b[xh].end());\n\tfor(int i=0,in=b[xh].size();i<in;i++)\n\t{\n\t\tint v=b[xh][i];work(v,dd-d);\n\t}\n}\nint main()\n{\n\tn=dr();\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tj[i]=dr();\n\t\tif(j[i]==i)\n\t\t{\n\t\t\twork(i,0);\n\t\t\tll mn=x[lt+1];\n\t\t\tfor(int k=lt+1;k<=i;k++)x[k]-=mn;\n\t\t\tif(lt)for(int k=lt+1;k<=i;k++)x[k]+=x[lt]+d+1;\n\t\t\tlt=i;\n\t\t}\n\t\telse b[j[i]].push_back(i);\n\t}\n\tprintf(\"%lld\\n\",d);\n\tfor(int i=1;i<=n;i++)printf(\"%lld\\n\",x[i]);\n}\n```\n",
        "postTime": 1643814725,
        "uid": 104581,
        "name": "kkk\u7684\u5c0f\u8214\u72d7",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P8098 \u3010[USACO22JAN] Tests for Haybales G\u3011"
    }
]
[
    {
        "content": "\u8fd9\u91cc\u7528 $m$ \u8868\u793a\u76f8\u540c\u5927\u5c0f\u7684\u76d8\u5b50\u6570\u3002\n\n\u5982\u679c\u4e0d\u5bf9\u6700\u7ec8\u72b6\u6001\u8fdb\u884c\u9650\u5236\uff0c\u90a3\u4e48\u6700\u4f18\u89e3\u663e\u7136\u548c\u666e\u901a\u7684\u6c49\u8bfa\u5854\u4e00\u6837\uff0c\u6bcf\u4e00\u5c42\u90fd\u5206\u4e09\u6b65\uff1a\u628a\u4e0a\u9762\u4e00\u4e9b\u5c0f\u7684\u79fb\u5230\u4e2d\u95f4\uff0c\u628a\u5927\u5c0f\u76f8\u540c\u7684 $m$ \u4e2a\u79fb\u5230\u6700\u540e\uff0c\u628a\u4e2d\u95f4\u5c0f\u7684\u79fb\u52a8\u5230\u6700\u540e\u3002\u53ef\u4ee5\u53d1\u73b0\uff0c\u6bcf\u4e00\u6b65\u79fb\u52a8\u7684\u6240\u6709\u76d8\u5b50\u7684\u76f8\u5bf9\u987a\u5e8f\u90fd\u4f1a\u53cd\u8fc7\u6765\u3002\u6211\u4eec\u628a\u8fd9\u6837\u7684\u79fb\u5230\u79f0\u4e3a\u521d\u59cb\u7684\u3002\n\n\u73b0\u5728\u5bf9\u7ec8\u6b62\u72b6\u6001\u8fdb\u884c\u9650\u5236\uff0c\u8fd9\u5c31\u610f\u5473\u7740\u6bcf\u4e00\u5c42\u5728\u67d0\u51e0\u6b21\u79fb\u52a8\u7684\u65f6\u5019\u4e0e\u4e0a\u8ff0\u8868\u73b0\u51fa\u6765\u7684\u884c\u4e3a\u4e0d\u540c\u3002\u6211\u4eec\u53ef\u4ee5\u628a\u6bcf\u4e00\u6b21\u79fb\u52a8\u770b\u6210\u5bf9\u5f53\u524d\u76d8\u5b50\u7684\u76f8\u5bf9\u987a\u5e8f\u8fdb\u884c\u7f6e\u6362\u3002\u5373\u5bf9\u4e8e\u7b2c $i$ \u5c42\uff0c\u5047\u8bbe\u5b83\u88ab\u79fb\u52a8\u4e86 $K$ \u6b21\uff0c\u90a3\u4e48\u6211\u4eec\u8981\u505a\u7684\u662f\u627e\u5230\u4e00\u4e9b\u7f6e\u6362 $p_1,p_2,...,p_K$\uff0c\u4f7f\u5f97\u4ed6\u4eec\u4e58\u8d77\u6765\u7b49\u4e8e\u6211\u4eec\u9700\u8981\u7684\u6392\u5217\u3002\n\n\u5728\u6c49\u8bfa\u5854\u4e2d\u8fd9\u4e2a $K$ \u53ef\u80fd\u5f88\u5927\uff0c\u4f46\u662f\u4e0d\u96be\u53d1\u73b0\u5176\u5b9e\u5927\u90e8\u5206\u79fb\u52a8\u90fd\u662f\u521d\u59cb\u7684\uff08\u65e0\u9650\u5236\u65f6\u7684\u6700\u4f18\uff09\uff0c\u6bcf\u6b21\u81f3\u591a\u53ea\u6709 $m!$ \u79cd\u53d8\u5316\uff08\u8d85\u8fc7 $m!$ \u4e00\u5b9a\u4f1a\u51fa\u73b0\u91cd\u590d\u72b6\u6001\uff09\u3002\n\n\u6211\u4eec\u7684\u601d\u8def\u5c31\u662f\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u4f7f\u7528\u521d\u59cb\u7684\u79fb\u52a8\uff0c\u540c\u65f6 $\\text{DP}$ \u53d1\u751f\u53d8\u5316\u7684\u90e8\u5206\u3002\n\n\u73b0\u5728\u8003\u8651\u5e95\u5c42\u7684\u79fb\u52a8\u5bf9\u9ad8\u5c42\u7684\u5f71\u54cd\uff0c\u5728\u5047\u8bbe\u9ad8\u5c42\u90fd\u662f\u521d\u59cb\u7684\u79fb\u52a8\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u53d1\u73b0\u6bcf\u4e00\u5c42\u5bf9\u9ad8\u7684\u5c42\u7684\u5f71\u54cd\u53ea\u505c\u7559\u5728\u9ad8\u7684\u5c42\u79fb\u52a8\u7684\u5947\u5076\u6027\uff08\u5947\u6570\u7684\u65f6\u5019\u5728\u521d\u59cb\u79fb\u52a8\u4e0b\u662f\u5012\u7f6e\u7684\uff09\u3002\n\n\u8fd9\u91cc\u4e3e\u4e2a\u4f8b\u5b50\uff1a\n\n\u8f93\u5165\n\n```\n1\n2 2\n1 2\n2 1\n```\n\n\u8f93\u51fa\n\n```\n10\n```\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/k6vkuikx.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f5mz6t3h.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3ei0t7vk.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fzfpvhbo.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rodwiga3.png)\n\n\u672c\u7ec4\u6570\u636e\u5728\u65e0\u9650\u5236\u7684\u6761\u4ef6\u4e0b\u6700\u7ec8\u72b6\u6001\u662f\uff1a\n\n```\n2 1\n1 2\n```\n\n\u6211\u4eec\u6539\u53d8\u4e86\u7b2c $1$ \u5c42\u7684\u79fb\u52a8\u65b9\u5f0f\uff0c\u5f71\u54cd\u5230\u4e86\u7b2c $2$ \u5c42\u3002\n\n\u518d\u4e3e\u4e2a\u4f8b\u5b50\uff1a\n\n$n=3,m=2$ \u65f6\uff0c\u6211\u4eec\u4ec5\u8981\u6c42\u7b2c $1$ \u5c42\u7684\u6700\u7ec8\u72b6\u6001\u4e3a \"1 2\"\uff08\u4e0e\u65e0\u9650\u5236\u65f6\u7684\u6700\u4f18\u89e3\u76f8\u53cd\uff09\u6c42\u6700\u5c11\u6b65\u6570\uff0c\u89c2\u5bdf\u6539\u53d8\u7b2c $1$ \u5c42\u5bf9\u9ad8\u5c42\u7684\u5f71\u54cd\uff1a\n\n\u5373\uff1a\n\n\u8f93\u5165\n\n```\n1\n3 2\n1 2\n2 1\n1 2\n```\n\n\u8f93\u51fa\n\n```\n22\n```\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5twsnbdg.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ryr62j1x.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lyd4p21q.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6v7nko0s.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0ru2hyth.png)\n\n\u6211\u4eec\u53d1\u73b0\u6539\u53d8\u4e86\u7b2c $1$ \u5c42\u53ea\u5bf9\u7b2c $2$ \u5c42\u6709\u5f71\u54cd\u3002\n\n\u4e0e\u65e0\u9650\u5236\u7684\u6761\u4ef6\u4e0b\u6700\u4f18\u79fb\u52a8\u65b9\u6848\u6bd4\uff0c\u7b2c $2$ \u5c42\u591a\u79fb\u52a8\u4e86 $1$ \u6b21\uff0c\u7b2c $3$ \u5c42\u591a\u79fb\u52a8\u4e86 $2$ \u6b21\uff08\u7b2c $3$ \u5c42\u53ef\u4ee5\u62bd\u8c61\u4e3a\u82e5\u5e72\u66f4\u9ad8\u5c42\uff0c\u4ee3\u7801\u5b9e\u73b0\u65f6\u5c06\u66f4\u9ad8\u7684\u62bd\u8c61\u4e3a\u4e00\u4e2a\u70b9\uff09\u3002\n\n\u4e8e\u662f\u66f4\u8fd1\u4e00\u6b65\u7684\u8bf4\uff0c\u7b2c $i$ \u5c42\u53ea\u5bf9\u7b2c $i+1$ \u5c42\u6709\u5f71\u54cd\uff08\u66f4\u9ad8\u5c42\u5728\u521d\u59cb\u79fb\u52a8\u7684\u60c5\u51b5\u4e0b\u5f71\u54cd\u7684\u6b65\u6570\u90fd\u662f\u5076\u6570\uff09\u3002\n\n\u540c\u65f6\u56e0\u4e3a\u6211\u4eec\u7684 $\\text{DP}$ \u662f\u5bf9\u521d\u59cb\u7684\u79fb\u52a8\u8fdb\u884c\u4fee\u6539\uff0c\u56e0\u6b64\u6211\u4eec\u8fd8\u9700\u8981\u8bb0\u5f55\u7b2c $i+1$ \u5c42\u603b\u5171\u79fb\u52a8\u4e86\u591a\u5c11\u6b65\uff0c\u6b65\u6570\u4e0d\u9700\u8981\u786e\u5207\u8bb0\u4e0b\u6765\uff0c\u53ea\u8981\u5bf9 $m!$ \u53d6 $\\min$ \u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u56e0\u6b64\u6211\u4eec\u7684 $DP$ \u72b6\u6001\u5c31\u662f $f[i][t][b]$ \u8868\u793a\u5f53\u524d $\\text{DP}$ \u5230\u7b2c $i$ \u5c42\uff0c\u7b2c $i$ \u5c42\u79fb\u52a8\u4e86 $t$ \u6b65\uff0c\u4ee5\u53ca\u79fb\u52a8\u6b21\u6570\u7684\u5947\u5076\u6027\u662f $b$\u3002\u5728\u8f6c\u79fb\u7684\u65f6\u5019\u6211\u4eec\u9700\u8981\u5904\u7406\u8fd9\u6837\u7684\u503c $w[i][t][p][t']$ \u8868\u793a\u5728\u7b2c $i$ \u5c42\u7528 $t$ \u6b65\u79fb\u52a8\u51fa\u6392\u5217 $p$ \u540c\u65f6\u4e0a\u4e00\u5c42\u79fb\u52a8\u6b21\u6570\u589e\u52a0\u4e86 $t'$ \u7684\u6700\u5c0f\u6b65\u6570\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651\u600e\u4e48\u5904\u7406\u8fd9\u4e2a\u503c\u3002\n\n\u9996\u5148\u6211\u4eec\u9700\u8981\u8ba1\u7b97 $g[i][p][t']$ \u8868\u793a\u5728\u7b2c $i$ \u5c42\u4ec5\u4fee\u6539\u4e00\u6b21\u521d\u59cb\u7684\u79fb\u52a8\u5f97\u5230\u7f6e\u6362 $p$\uff0c\u540c\u65f6\u4e0a\u4e00\u5c42\u7684\u79fb\u52a8\u6b21\u6570\u589e\u52a0\u4e86 $t'$ \u7684\u6700\u5c0f\u6b65\u6570\u3002\u8fd9\u4e00\u6b65\u4e2d\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651\u5f53\u524d\u5c42\u7684\u76d8\u5b50\u4ee5\u53ca\u4e0a\u9762\u7684\u90a3\u4e00\u5806\u5728\u54ea\u91cc\u5c31\u53ef\u4ee5\u4e86\uff0c\u72b6\u6001\u6570 $S$ \u53ea\u6709\u4e0d\u5230 $2000$ \u79cd\uff0c\u628a\u8f6c\u79fb\u56fe\u5efa\u51fa\u6765\u4e4b\u540e\u679a\u4e3e $i$ \u8dd1\u6700\u77ed\u8def\u5c31\u53ef\u4ee5\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u7ea6\u4e3a $O(m!nS)$\u3002\n\n\u63a5\u7740\u4ece $g$ \u5f97\u5230 $w$ \u5c31\u662f\u80cc\u5305\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u7ea6\u4e3a $O(n(m!)^4)$\u3002\n\n\u6700\u540e\u7531 $w$ $\\text{DP}$ \u51fa $f$\uff0c\u6839\u636e\u5b9a\u4e49\u5c31\u53ef\u4ee5\u4e86\uff0c\u7a0d\u52a0\u4f18\u5316\u65f6\u95f4\u590d\u6742\u5ea6\u53ef\u4ee5\u964d\u5230 $O(m!Tn)$\u3002\n\n\u53c2\u8003ZJOI2017 Day2\u9898\u89e3\uff1ahttps://wenku.baidu.com/view/4f242987d0f34693daef5ef7ba0d4a7302766ca6.html?_wkts_=1674962588966\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define rep(i,a,b) for(int i=a;i<=b;i++)\n#define per(i,a,b) for(int i=a;i>=b;i--)\nll rd() {\n\tll x = 0, f = 1;\n\tchar ch = getchar();\n\twhile (ch > '9' || ch < '0') {\n\t\tif (ch == '-') f = -1;\n\t\tch = getchar();\n\t}\n\tdo x = x * 10 + ch - 48, ch = getchar();\n\twhile (ch >= '0' && ch <= '9');\n\treturn x * f;\n}\nvoid wr(ll x) {\n\tif (x > 9) wr(x / 10);\n\tputchar(x % 10 + 48);\n}\nconst int K = 7, N = 25, p[6] = {0, 1, 2, 3, 4, 0};\nint t, n, k, fac[5] = {0, 1, 2, 6, 24};\nmap<vector<vector<int>>, int> mp[N];\nint tr[N][N], mul[N][N], f[N][N][N];\nll g[55][N];\nstruct P {\n\tint a[K];\n\tvoid in() {\n\t\trep(i, 1, k) a[i] = rd();\n\t}\n\tint getid() {\n\t\tint res = 0;\n\t\trep(i, 1, k) {\n\t\t\tint sum = 0;\n\t\t\trep(j, i, k) sum += a[i] > a[j];\n\t\t\tres += sum * fac[k - i];\n\t\t}\n\t\treturn res + 1;\n\t}\n\tbool operator < (const P&x) const {\n\t\tint i = 1;\n\t\tfor (; i <= k && a[i] == x.a[i]; i++);\n\t\treturn i <= k && a[i] < x.a[i];\n\t}\n\tint&operator[](const int&i) {\n\t\treturn a[i];\n\t}\n\tP operator * (const P&x) {\n\t\tP ans;\n\t\trep(i, 1, k) ans[i] = a[x.a[i]];\n\t\treturn ans;\n\t}\n} pre[N], a[55];\nstruct sta {\n\tvector<int> a[3];\n\tint x, y;\n\t// \u6700\u77ed\u8def\n\tbool work() {\n\t\tper(i, x, 0) {\n\t\t\tauto it = mp[i].find(vector<vector<int>>(a, a + 3));\n\t\t\tif (it != mp[i].end() && it->second <= y) return 0;\n\t\t}\n\t\tmp[x][vector<vector<int>>(a, a + 3)] = y;\n\t\treturn 1;\n\t}\n};\nqueue<sta> q;\nll F(int x) {\n\treturn x < 1 << 24 ? x : 1ll << 60;\n}\nvoid solve() {\n\tmemset(g[n + 1], 0, sizeof g[n + 1]);\n\tper(i, n, 1) {\n\t\tmemset(g[i], 50, sizeof g[i]);\n\t\tint id = a[i].getid();\n\t\trep(j, 0, N - 1)\n\t\trep(p, 0, N - 1)\n\t\tfor (int l = 0; p + l < N; l += 2)\n\t\t\tg[i][j] = min(g[i][j], g[i + 1][p] + ((1ll << (n - i)) - 1) * l * k + F(f[j][id][p + l]));\n\t}\n\tll ans = 1ll << 60;\n\trep(i, 0, N - 1) ans = min(ans, g[1][i]);\n\twr(ans), putchar('\\n');\n}\nsigned main() {\n\tt = rd(), n = rd(), k = rd();\n\tmemcpy(pre[1].a + 1, p + 1, k << 2);\n\trep(i, 2, fac[k]) pre[i] = pre[i - 1], next_permutation(pre[i].a + 1, pre[i].a + k + 1);\n\t//\u672b\u5c3e\u7684 0 \u8868\u793a\u66f4\u9ad8\u7684\u82e5\u5e72\u6570\n\tq.push((sta) {\n\t\tvector<int>(pre[1].a + 1, pre[1].a + k + 2), {}, {}, 0, 0\n\t});\n\tq.front().work();\n\twhile (q.size()) {\n\t\tsta u = q.front(), v;\n\t\tq.pop();\n\t\trep(i, 0, 2) if (!u.a[i].empty()) rep(j, 0, 2) if (i != j && (u.a[i].back() == 0 || (u.a[j].empty() ||\tu.a[j].back() > 0))) {\n\t\t\t\tv = u;\n\t\t\t\tv.a[j].push_back(v.a[i].back());\n\t\t\t\t(v.a[i].back() ? v.y : v.x)++;\n\t\t\t\tv.a[i].pop_back();\n\t\t\t\tif (v.work()) q.push(v);\n\t\t\t}\n\t}\n\tint a[6];\n\tmemcpy(a, p, sizeof a);\n\tmemset(tr, 10, sizeof tr);\n\trep(j, 1, fac[k])\n\trep(i, 0, N - 1) {\n\t\tauto it = mp[i].find({{}, {}, vector<int>(pre[j].a + 1, pre[j].a + k + 2)});\n\t\tif (it != mp[i].end()) tr[i][j] = it->second;\n\t}\n\trep(i, 1, fac[k])\n\trep(j, 1, fac[k])\n\tmul[i][j] = (pre[i] * pre[j]).getid();\n\t//\u80cc\u5305\n\tmemset(f, 10, sizeof f);\n\trep(i, 1, fac[k]) rep(j, 0, N - 1) f[1][i][j] = tr[j][i];\n\trep(i, 1, N - 1)\n\trep(j, 1, fac[k])\n\trep(l, 1, N - 1)\n\trep(r, 0, N - 1 - l)\n\trep(p, 1, fac[k])\n\tf[i + 1][mul[j][p]][l + r] = min(f[i + 1][mul[j][p]][l + r], f[i][j][l] + tr[r][p]);\n\twhile (t--) {\n\t\trep(i, 1, n) ::a[i].in();\n\t\tsolve();\n\t\tif (t) n = rd(), k = rd();\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1675128077,
        "uid": 400151,
        "name": "SSVoV",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5209 \u6c49\u8bfa\u5854"
    }
]
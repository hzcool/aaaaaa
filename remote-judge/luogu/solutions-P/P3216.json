[
    {
        "content": "/\\*\n\\* P:3216\n\n\\* Au:Small\\_Ash\n\n\\* \u55ef\uff0c\u4e00\u5f00\u59cb\u770b\u9898\u7684\u65f6\u5019\u5c31\u89c9\u5f97\u80af\u5b9a\u662fO\uff08N\uff09\u7684\u5947\u602a\u7b97\u6cd5\uff08\u6bd5\u7adf\u662f\u4e00\u76f4\u8fde\u63a5\u4e00\u4e2a\u6570\u554a\uff0c\u80af\u5b9a\u8981\u8fde\u63a5\u4e00\u6b21\u53d6\u6a21\u4e00\u6b21\uff09\n\n\\* \u7136\u540e\u6570\u636e\u8303\u56f4\u7ed9\u4e86\u6211\u4e00\u5df4\u638c\uff0110^18 Are you sure? \u55ef\uff0c\u90a3\u5c31\u662fO(logN)\u6ca1\u8dd1\u4e86\n\n\\* \u7b49\u7b49\u554a\uff0c\u6211\u4eec\u770b\u770b\u7b2cN\u4e2a\u6570\u7684\u8ba1\u7b97\u65b9\u6cd5\u554a\uff0c\u5c31\u662f\u524d\u4e00\u4e2a\u6570\u63a5\u6570\u561b\u3002\u3002\n\n\\* \u7b49\u7b49\uff0c\u63a5\u6570\uff0c\u7b49\u7b49 \uff0c\u524d\u4e00\u4e2a\uff1f N-1=>N \u3002\u3002\u3002\n\n\\* \u6211\u597d\u60f3\u53d1\u73b0\u4e86\u4ec0\u4e48\uff0c\u9012\u63a8\uff1f\uff1f f[N]=f[N-1]\\*10^k+N;\uff08k\u662fN\u7684\u4f4d\u6570\uff09\n\n\\* \u7b49\u7b49\uff0cf[N]\u54ea\u95e8\u5b50\u5f00\u7684\u51fa\u6765\u554a\u3002\u3002\u3002\n\n\\* \u7b49\u7b49\uff0c\u9012\u63a8\uff0clogN\u3002\u3002\u3002\n\n\\* \u3002\u3002\u3002\n\n\\* \u54e6\uff0c\u77e9\u9635\u5feb\u901f\u5e42\uff01\n\n\\* \u7136\u540e\u5c31\u6709\u4e86\u601d\u8def\u3002\u3002\u3002\n\n \\*             {10^k,0,0}\n\n \\* {F[n],n,1}= {  1, 1,0} \\* {F[n-1],n-1,1}  (f[N]=f[N-1]\\*10^k+N\u53ef\u53d8\u5f62\u4e3af[N]=f[N-1]\\*10^k+(N-1)+1) \n\n \\*             {  1, 1,1}\n\n\\*\n\\* OK\uff01\u7136\u540e\u5c31\u662f\u5b9e\u73b0\u4e86\u3002\u3002\u3002\n\n\\* \u4e09\u70b9\u63d0\u9192\n\n\\* 1.\u5168\u90e8\u7528long long\uff0c\u4e0d\u8981\u541d\u556c\u5185\u5b58\u3002\n\n\\* 2.\u51e1\u662f\u6709 long long\\*long long \u7684\u8ba1\u7b97\u5168\u90e8\u6539\u6210 ((long long)%p\\*(long long)%p)%p\n\n\\* (\u522b\u95ee\u6211\u4e3a\u4ec0\u4e48\u4f1a\u77e5\u9053\uff0c\u6211\u4f1a\u8bf4\u6211\u4e4b\u524d\u6240\u6709\u5e26\u53d6\u6a21\u7684\u9012\u63a8\u90fd\u662f\u6b7b\u5728\u53d6\u6a21\u4e0d\u591f\u5f7b\u5e95\u4e0a\u5417\u3002\u3002\u3002)\n\n\\* 3.10^k\u7684\u8ba1\u7b97\u8981\u5206\u6bb5\uff0c\u8fd9\u6bb5\u7684\u5b9e\u73b0\u53ef\u80fd\u4f1a\u8ba9\u4f60\u6293\u72c2\uff0c\u5fcd\u4f4f\u6162\u6162\u6539\uff0c\u8fd9\u91cc\u7ed9\u4e00\u7ec4\u5927\u6570\u636e\u4f9b\u5404\u4f4d\u8c03\u8bd5\u3002\n\n\\* Input : 948177742992423376 819143553  Output : 578278753\n\n\\* \u4ee5\u4e0a\uff0c\u4e0b\u9762\u662f\u4ee3\u7801\u3002\n\n\\*/\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <algorithm>\nusing namespace std;\nlong long n,p;\nstruct zj{\n    long long a[5][5];\n    zj operator = (int k){\n        a[1][1]=1;\n        for (int i=1;i<=k;i++)\n        a[1][1]*=10;\n        a[1][1]%=p;\n        a[1][2]=0;\n        a[1][3]=0;\n        a[2][1]=1;\n        a[2][2]=1;\n        a[2][3]=0;\n        a[3][1]=1;\n        a[3][2]=1;\n        a[3][3]=1;\n        return *this;\n    }\n    zj operator * (zj b){\n        zj c;\n           for (int i=1;i<=3;i++)\n             for (int j=1;j<=3;j++){\n                 c.a[i][j]=0;\n                 for (int k=1;k<=3;k++){\n                    c.a[i][j]+=(a[i][k])%p*(b.a[k][j])%p;  \n                    c.a[i][j]%=p;\n                }\n            }\n        return c;\n    }\n    zj operator ^ (long long x){\n        zj c,a;a=*this;\n           for(int i=1;i<=3;i++)\n            for(int j=1;j<=3;j++)\n                c.a[i][j]=(i==j); \n        for(;x;x>>=1){\n            if(x&1) c=c*a;\n               a=a*a;\n        }\n        return c;\n    }\n}A[20],B;\nlong long pow10(int x){\n    long long out=1;\n    for (int i=1;i<=x;i++) out*=10;\n    return out;\n}\nint main(){\n    scanf(\"%lld%lld\",&n,&p);\n    int k=0;long long nn=n;\n    while (nn) {k++;nn/=10;}\n    for (int i=1;i<k;i++){\n        A[i]=i;\n        A[i]=A[i]^(pow10(i-1)*9);\n    }\n    nn=n-pow10(k-1)+1;\n    A[k]=k;\n    A[k]=A[k]^nn;\n    for(int i=1;i<=3;i++)\n        for(int j=1;j<=3;j++)\n            B.a[i][j]=(i==j);\n    for (int i=1;i<=k;i++) B=B*A[i];\n    printf(\"%lld\",B.a[3][1]);\n    return 0;\n}\n\n```",
        "postTime": 1477620625,
        "uid": 745,
        "name": "dph754132771",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3216 \u3010[HNOI2011]\u6570\u5b66\u4f5c\u4e1a\u3011"
    },
    {
        "content": "[$$\\Large\\texttt{My Blog}$$](https://hydingsy.github.io/articles/problem-HNOI-2011-Math-Homework/)\n\n---\n\n## Description\n\n> \u9898\u76ee\u94fe\u63a5\uff1a[Luogu 3216](https://www.luogu.org/problemnew/show/P3216)\n\n\u5c0f C \u6570\u5b66\u6210\u7ee9\u4f18\u5f02\uff0c\u4e8e\u662f\u8001\u5e08\u7ed9\u5c0f C \u7559\u4e86\u4e00\u9053\u975e\u5e38\u96be\u7684\u6570\u5b66\u4f5c\u4e1a\u9898\uff1a\n\n\u7ed9\u5b9a\u6b63\u6574\u6570 $n$ \u548c $m$\uff0c\u8981\u6c42\u8ba1\u7b97 $\\text{Concatenate}(1\\dots n)\\bmod m$ \u7684\u503c\uff0c\u5176\u4e2d $\\text{Concatenate}(1\\dots n)$ \u662f\u5c06\u6240\u6709\u6b63\u6574\u6570 $1,2,\\dots,n$ \u987a\u5e8f\u8fde\u63a5\u8d77\u6765\u5f97\u5230\u7684\u6570\u3002\u5c0f C \u60f3\u4e86\u5927\u534a\u5929\u7ec8\u4e8e\u610f\u8bc6\u5230\u8fd9\u662f\u4e00\u9053\u4e0d\u53ef\u80fd\u624b\u7b97\u51fa\u6765\u7684\u9898\u76ee\uff0c\u4e8e\u662f\u4ed6\u53ea\u597d\u5411\u4f60\u6c42\u52a9\uff0c\u5e0c\u671b\u4f60\u80fd\u7f16\u5199\u4e00\u4e2a\u7a0b\u5e8f\u5e2e\u4ed6\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\le n\\le 10^{18}$\uff0c$1\\le m\\le 10^9$\n\n------\n\n## Solution\n\n\u6211\u4eec\u8bbe\u524d $i$ \u4e2a\u6570\u7684\u7b54\u6848\u4e3a $f_i$\uff0c\u90a3\u4e48\u53ef\u4ee5\u5217\u51fa\u5982\u4e0b\u8f6c\u79fb\u65b9\u7a0b\uff1a\n$$f_i=f_{i-1}+10^{\\left\\lfloor\\log_{10}i\\right\\rfloor+1}+i$$\n\u53d1\u73b0\u7b2c $i$ \u9879\u4e4b\u548c\u7b2c $i-1$ \u9879\u6709\u5173\uff0c\u53ef\u4ee5\u8003\u8651**\u77e9\u9635\u5feb\u901f\u5e42**\u4f18\u5316\u9012\u63a8\u3002\n\n\u8f6c\u79fb\u77e9\u9635\u4e3a\uff1a\n$$\\begin{bmatrix}f_n \\\\n \\\\1\\end{bmatrix}=\\begin{bmatrix}10^k & 1 & 1 \\\\0 & 1 & 1 \\\\0 & 0 & 1\\end{bmatrix}\\times\\begin{bmatrix}f_{n-1} \\\\n-1 \\\\1\\end{bmatrix}$$\n\u4f46\u662f\u6211\u4eec\u53d1\u73b0\uff0c\u6307\u6570 $k$ \u7684\u503c\u4e3a $\\left\\lfloor\\log_{10}i\\right\\rfloor+1$\uff08\u4e5f\u5c31\u662f $len(i)$\uff09\u7684\u503c\u662f\u4f1a\u53d8\u5316\u7684\uff0c\u6ca1\u6cd5\u76f4\u63a5\u77e9\u4e58\u3002\u7531\u4e8e $len(i)$ \u7684\u503c\u4e00\u5171\u53ea\u6709 $18$ \u79cd\u5de6\u53f3\uff0c\u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u679a\u4e3e $len(i)$ \u7136\u540e\u5206\u5757\u77e9\u4e58\u540e\u5408\u5e76\u3002\n\n**\u6ce8\u610f**\uff1a\u5408\u5e76\u65f6\uff0c\u5fc5\u987b\u7528\u8f6c\u79fb\u77e9\u9635\u7684\u82e5\u5e72\u6b21\u65b9**\u5de6\u4e58**\u7b54\u6848\u77e9\u9635\uff01\n\n**\u65f6\u95f4\u590d\u6742\u5ea6**\uff1a$O(3^3\\log^2 n)$\n\n------\n\n## Code\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n\nconst int N=4;\nint mod;\n\nvoid upd(int &x,int y) {\n\t(x+=y)>=mod&&(x-=mod);\n}\nstruct Matrix {\n\tint n,A[N][N];\n\tMatrix(int _n=0) {n=_n,memset(A,0,sizeof(A));}\n\tvoid operator ~ () {\n\t\tfor(int i=0;i<n;++i) A[i][i]=1;\n\t}\n\tMatrix operator * (const Matrix &b) const {\n\t\tMatrix ret(n);\n\t\tfor(int i=0;i<n;++i) for(int j=0;j<n;++j) for(int k=0;k<n;++k) {\n\t\t\tupd(ret.A[i][k],1LL*A[i][j]*b.A[j][k]%mod);\n\t\t}\n\t\treturn ret;\n\t}\n\tMatrix operator ^ (const long long &b) const {\n\t\tMatrix ret(n),x=*this; ~ret;\n\t\tfor(long long p=b;p;p>>=1,x=x*x) if(p&1) ret=ret*x;\n\t\treturn ret;\n\t}\n};\n\nMatrix ans(3);\nvoid calc(long long p,long long b) {\n\tMatrix x(3);\n\tx.A[0][0]=p%mod,x.A[0][1]=x.A[0][2]=x.A[1][1]=x.A[1][2]=x.A[2][2]=1;\n\tans=(x^b)*ans;\n}\nint main() {\n\tlong long n;\n\tscanf(\"%lld%d\",&n,&mod);\n\t~ans;\n\tlong long r=10;\n\twhile(r<=n) calc(r,r-(r/10)),r*=10;\n\tcalc(r,n-r/10+1);\n\tprintf(\"%d\\n\",ans.A[0][2]);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1549595430,
        "uid": 49725,
        "name": "Siyuan",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3216 \u3010[HNOI2011]\u6570\u5b66\u4f5c\u4e1a\u3011"
    },
    {
        "content": "40 pts\n\n\u9996\u5148\u6211\u4eec\u6709fn=fn-1*10^k+i;\n\n\u8fd9\u6837\u6211\u4eec\u6253\u4e2a\u66b4\u529b\u5f97\u624b\n\n100 pts\n\n\u6211\u4eec\u8003\u8651\u4f18\u5316\uff0c\u5373\u53d1\u73b0\u5176\u5b9ek\u7684\u53d8\u5316\u6700\u591a18\u4ee5\u5185\n\n\u6240\u4ee5\u6211\u4eec\u8003\u8651\u5bf9\u4e8e\u4e0d\u540c\u7684k\u5206\u6bb5\u8003\u8651\n\n\u5bf9\u4e8e\u6bcf\u4e2ak\u65e2\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u77e9\u9635\n\n\u6211\u4eec\u8003\u8651\u5982\u4f55\u5efa\u7acb\u8fd9\u4e2a\u77e9\u9635\n\n\u4e8e\u662f\u6211\u4eec\u601d\u8003\u8fd9\u4e2a\u77e9\u9635\u662f\n\n[ f[i] i + 1 1] \u4e58 \u4e00\u4e2a3\u4e583\u7684\u77e9\u9635 \n\n\u5f97\u5230[ f[i + 1] i + 2 1]\n\n\u6211\u4eec\u53ef\u4ee5\u63a8\u51fa\u77e9\u9635\u4e3a\n\n[ 10 ^ k   0     0]\n\n[ 1       1     0]\n\n[0        1     1]\n\n\u6240\u4ee5\u5206\u6bb5\u8003\u8651\u77e9\u9635\u4e58\u6cd5\n\n\u540c\u65f6\u5efa\u7acb\u4e00\u4e2a\u521d\u59cb\u77e9\u9635\u5373\u53ef\n\n\u653e\u4e0a\u6211\u7684\u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nstruct mat {\n\tll a[3][3];\n} c, ans;\nll n, m, tmp, t[20];\nmat operator *(mat a, mat b) {\n\tmat c;\n\tint i, j, k;\n\tfor (i = 0; i < 3; ++i)\n\t\tfor (j = 0; j < 3; ++j) c.a[i][j] = 0;\n\tfor (i = 0; i < 3; ++i)\n\t\tfor (j = 0; j < 3; ++j)\n\t\t\tfor (k = 0; k < 3; ++k) c.a[i][j] = (c.a[i][j] + a.a[i][k] * b.a[k][j]) % m;\n\treturn c; \n}\nmat pw(mat x, ll y) {\n\tif (y == 1) return x;\n\tmat z = pw(x, y / 2);\n\tz = z * z;\n\tif (y & 1) z = z * x;\n\treturn z;\n}\nint main() {\n\tint i;\n\tscanf(\"%lld%lld\", &n, &m);\n\tans.a[0][1] = ans.a[0][2] = c.a[1][0] = c.a[1][1] = c.a[2][1] = c.a[2][2] = 1;\n\tfor (t[0] = i = 1; i <= 18; ++i) t[i] = t[i - 1] * 10;\n\tfor (i = 1;; ++i) {\n\t\tc.a[0][0] = t[i] % m;\n\t\ttmp = min(n, t[i] - 1) - t[i - 1] + 1;\n\t\tans = ans * pw(c, tmp);\n\t\tif (t[i] - 1 >= n) break;\n\t}\n\tprintf(\"%lld\\n\", ans.a[0][0]);\n\treturn 0;\n}\n\n```",
        "postTime": 1549423127,
        "uid": 30817,
        "name": "muller",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3216 \u3010[HNOI2011]\u6570\u5b66\u4f5c\u4e1a\u3011"
    },
    {
        "content": "\u8fd9\u9898\u6298\u817e\u6b7b\u4eba\u5566\\_(:\u0437\u309d\u2220)\\_\n\n\u9996\u5148\u770b\u8fd9\u9898\u7b2c\u4e00\u773c\uff1a(\u2299v\u2299)\u55ef\uff0c\u627e\u89c4\u5f8b\uff1f\n\n\u7136\u800c\u9898\u76ee\u544a\u8bc9\u6211\uff1a1\u2264N\u22641018\u4e141\u2264M\u2264109\n\n\u8fd9\u4e0d\u592a\u5bf9\u5427\uff0c\u597d\u50cf\u662fN<=10^18\uff0cM<=10^9\n\n(\u2299o\u2299)\u2026\u600e\u4e48\u8fd8\u6709\u6a21\uff1f\uff1f\uff1f\n\n\u597d\u5427\uff0c\u90a3\u4e48logn\u7684\u7b97\u6cd5\u5c31\u53ea\u6709\u5feb\u901f\u5e42\u4e86\n\n~~\uff08\u500d\u589e\u88ab\u6211\u5403\u4e86233\uff09~~\n\n\n\u597d\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u6765\u60f3\u4e00\u60f3\u9012\u63a8\u65b9\u7a0b\uff0c\u9012\u63a8\u65b9\u7a0b\u8fd8\u662f\u5f88\u597d\u5199\u51fa\u6765\u7684\u3002\n\n$$f[n]=f[n-1] \\times 10^{len(n)}+n$$\n\n\u5f88\u597d\uff0c\u9012\u63a8\u5f0f\u51fa\u6765\u4e86\uff0c\u63a5\u7740\u6211\u4eec\u6784\u9020\u77e9\u9635\n\n$$ \\begin{pmatrix} f[n] & n & 1 \\end{pmatrix} = \\begin{pmatrix} f[n-1] & n-1 & 1 \\end{pmatrix} \\times \\begin{bmatrix} 10^{len(n)} & 0 & 0 \\\\ 1 & 1 & 0 \\\\ 1 & 1 & 1 \\end{bmatrix}  $$\n\n$$=\\begin{pmatrix} f[1] & 1 & 1 \\end{pmatrix} \\times \\begin{bmatrix} 10^{len(n)} & 0 & 0 \\\\ 1 & 1 & 0 \\\\ 1 & 1 & 1 \\end{bmatrix}^{n-1}$$\n\n\u63a5\u7740\u95ee\u9898\u5c31\u6765\u4e86\\_( \uff9f\u0414\uff9f)\uff89\n\n\u6211\u4eec\u5e73\u65f6\u505a\u7684\u77e9\u9635\u5feb\u901f\u5e42\u6839\u672c\u6ca1\u6709\u8fd9\u4e2a\u5947\u602a\u7684$10^{len(n)}$\u7684\u5947\u602a\u7684\u53d8\u91cf\u554a\uff0c\u600e\u4e48\u641e\u30fd(\\*\u3002>\u0414<)o\u309c\n\n\n\u56de\u5230\u6570\u636e\u8303\u56f4\uff1a~~N\u22641018~~ N<=10^18\n\nlog\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u7ef0\u7ef0\u6709\u4f59\uff0c\u90a3\u4e48\u6211\u4eec\u80fd\u5426\u628a$10^{len(n)}$\u53d8\u6210\u5e38\u6570\uff1f\n\n\u5f53\u7136\u53ef\u4ee5\uff0c\u6211\u4eec\u679a\u4e3e\u4f4d\u6570\uff0c\u4ece1\u4f4d\u6570\u679a\u4e3e\u5230n\u7684\u4f4d\u6570\uff0c\u5bf9\u6bcf\u4e00\u4e2a\u4f4d\u6570\u8fdb\u884c\u77e9\u9635\u5feb\u901f\u5e42\u3002\n\n(\u2299v\u2299)\u55ef\uff0c\u7406\u8bba\u5f88\u7b80\u5355\uff0c\u5b9e\u9645\u5b9e\u73b0\u5462\uff1f\n\n\u4ece\u6bcf\u4e00\u4f4d\u5230\u6bcf\u4e00\u4f4d\u7684\u8854\u63a5\u53ef\u4ee5\u6298\u817e\u6b7b\u4eba\uff0c\u800c\u4e14\u5bf9\u4e8e\u6700\u540e\u7684n\u7684\u4f4d\u6570\u5e76\u4e0d\u662f\u6574\u7684\uff0c\u7ec6\u8282\u5904\u7406\u53ef\u4ee5\u4f7f\u4eba\u4e0a\u5929 \u51f8(\u8279\u76bf\u8279 )\n\n\u5177\u4f53\u6b65\u9aa4\uff1a\n\n\u2460\u679a\u4e3e\u4f4d\u6570 \u2461\u6784\u9020\u77e9\u9635 \u2462\u8ba1\u7b97\u77e9\u9635\n\n**\u6ce8\u610f\u4e8b\u9879\uff1a\u4e0d\u8981\u4f7f\u7528log10\u51fd\u6570\u8ba1\u7b97\u4f4d\u6570\uff0c\u4e0d\u8981\u4f7f\u7528pow\u51fd\u6570\u8ba1\u7b97\u6b21\u65b9\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u5728long long\u8303\u56f4\u5185\u90fd\u4f1a\u7206\u70b8**\n\n\u4ee3\u7801\u5982\u4e0b\n\n```cpp\n#include<algorithm>\n#include<iostream>\n#include<iomanip>\n#include<cstring>\n#include<cstdlib>\n#include<vector>\n#include<cstdio>\n#include<cmath>\n#include<queue>\nusing namespace std;\ntypedef long long LL;\ninline const LL Get_Int() {\n    LL num=0,bj=1;\n    char x=getchar();\n    while(x<'0'||x>'9') {\n        if(x=='-')bj=-1;\n        x=getchar();\n    }\n    while(x>='0'&&x<='9') {\n        num=num*10+x-'0';\n        x=getchar();\n    }\n    return num*bj;\n}\nconst int maxn=5;\nLL mod;\nstruct Matrix {\n    LL n,m,a[maxn][maxn];\n    Matrix(LL n,LL m) {\n        this->n=n;\n        this->m=m;\n        memset(a,0,sizeof(a));\n    }\n    Matrix(LL n,LL m,char E) { //\u5355\u4f4d\u77e9\u9635\n        this->n=n;\n        this->m=m;\n        memset(a,0,sizeof(a));\n        for(int i=1; i<=n; i++)a[i][i]=1;\n    }\n    LL* operator [] (const LL x) {\n        return a[x];\n    }\n    Matrix operator * (Matrix b) {\n        Matrix c(n,b.m);\n        for(int i=1; i<=n; i++)\n            for(int j=1; j<=b.m; j++)\n                for(int k=1; k<=m; k++)\n                    c[i][j]=(c[i][j]+a[i][k]%mod*b[k][j]%mod)%mod;\n        return c;\n    }\n    void operator *= (Matrix& b) {\n        *this=*this*b;\n    }\n    Matrix operator ^ (LL b) {\n        Matrix ans(n,m,'e'),a=*this;\n        while(b>0) {\n            if(b&1)ans=ans*a;\n            a*=a;\n            b>>=1;\n        }\n        return ans;\n    }\n};\nLL n;\nint Get_Len(LL x) {\n    int len=0;\n    while(x) {\n        len++;\n        x/=10;\n    }\n    return len;\n}\nLL pow10(int x) {\n    LL ans=1;\n    for(int i=1; i<=x; i++)ans*=10;\n    return ans;\n}\nint main() {\n    n=Get_Int();\n    mod=Get_Int();\n    Matrix A(1,3);\n    int len=Get_Len(n);\n    A[1][1]=A[1][2]=A[1][3]=1;\n    for(int i=0; i<len-1; i++) { //\u679a\u4e3e\u4f4d\u6570\n        Matrix B(3,3);\n        B[1][1]=pow10(i+1)%mod;\n        B[2][1]=B[2][2]=B[3][1]=B[3][2]=B[3][3]=1;\n        LL m=pow10(i+1)-pow10(i);\n        A=A*(B^(m-(i==0?1:0)));\n    }\n    Matrix B(3,3);\n    B[1][1]=pow10(len)%mod;\n    B[2][1]=B[2][2]=B[3][1]=B[3][2]=B[3][3]=1;\n    LL m=n-pow10(len-1)+1;\n    A=A*(B^(m-(len-1==0?1:0)));\n    printf(\"%lld\\n\",A[1][1]);\n    return 0;\n}\n\n```",
        "postTime": 1501157238,
        "uid": 31877,
        "name": "BillYang",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3216 \u3010[HNOI2011]\u6570\u5b66\u4f5c\u4e1a\u3011"
    },
    {
        "content": "\u300e\u77e9\u9635\u4e58\u6cd5\u300f\u7684\u597d\u9898\uff01\n\n\u9898\u610f\u770b\u8d77\u6765\u5341\u5206\u7b80\u5355\uff0c\u5c31\u662f\u8981\u6c42$\uff11$\u5230$n$\u9996\u5c3e\u62fc\u8d77\u6765$ \\mod m \\ $\u7684\u503c\u3002\n\n\u53ef\u662f$n$\u7684\u503c\u90a3\u4e48\u5927\uff0c\u611f\u89c9\u65e0\u4ece\u4e0b\u624b\u3002\u3002\u3002\n\n\u6211\u4eec\u4ed4\u7ec6\u6765\u5206\u6790\u4e00\u4e0b\u66b4\u529b\u8ba1\u7b97\u7684\u65f6\u5019\uff0c\u5b83\u7684\u6d41\u7a0b\u5230\u5e95\u662f\u4ec0\u4e48\u6837\u7684?\n\u5bf9\u4e8e\u5f53\u524d\u7684\u503c$val$\uff0c\u52a0\u5165\u4e00\u4e2a$v$\u540e\uff0c$val$\u7684\u503c\u53d8\u6210\uff1a$val*10^k+v$\uff08$\uff4b$\u4e3a$v$\u7684\u4f4d\u6570\uff09\u3002\n\n\u6211\u4eec\u5e94\u8be5\u77e5\u9053\u4e00\u4ef6\u4e8b\uff1a**\u77e9\u9635\u4e58\u6cd5\u7ecf\u5e38\u7528\u6765\u4f18\u5316\u7ebf\u6027\u9012\u63a8\u5f0f\u3002**\n\n\u5bf9\u4e8e\u4e0a\u9762\u7684\u5f0f\u5b50\uff0c\u5176\u5b9e\u5c31\u662f\uff1a$a[i]=a[i-1]*10^k+a[i]$\uff0e\u5982\u679c$k$\u4e0d\u53d8\u7684\u8bdd\uff0c\u90a3\u597d\u529e\uff0c\u6211\u5b9a\u4e49\u4e00\u4e2a\u77e9\u9635\u4e3a$(dp[i-1],i,1)$\uff0c\u901a\u8fc7\u4e0e\u53e6\u4e00\u4e2a\u77e9\u9635\u76f8\u4e58\u5f97\u5230\u5230$(dp[i],i+1,1)$\u7684\u77e9\u9635\uff0c\u6700\u540e\u7b54\u6848\u53d6\u7b2c\u4e00\u9879\u5373\u53ef\u3002\n\n\u4f46\u95ee\u9898\u6765\u4e86\uff0c$k$\u5e76\u4e0d\u662f\u4e00\u4e2a\u5b9a\u503c\u600e\u4e48\u529e\uff1f\n\n\u4e5f\u597d\u529e\uff0c\u53d1\u73b0\u4e00\u4e2a\u91cd\u8981\u4fe1\u606f\uff1a$k$\u5728\u67d0\u4e00\u6bb5\u5185\u662f\u4e0d\u4f1a\u53d8\u7684\uff0c\u4e8e\u662f\u6211\u4eec\u6709\u4e00\u4e2a\u7b28\u62d9\u7684\u65b9\u6cd5\uff1a\u6309$k$\u5206\u4e3a\u82e5\u5e72\u6bb5\uff0c\u5c06\u6bcf\u4e00\u6bb5\u5185\u7684\u7b54\u6848\u7528\u77e9\u9635\u5355\u72ec\u5904\u7406\uff0c\u518d\u5408\u5e76\u3002\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\uff0c\u5b9e\u9645\u4e0a\u6700\u591a\u4e5f\u5c31\u5206\u621018\u6bb5\uff0c\u6240\u4ee5\u6211\u4eec\u77e5\u9053\uff1a\u5b83\u5c31\u662f\u6b63\u89e3\uff01\n\n\u4e8e\u662f\u5bf9\u4e8e\u6bcf\u4e00\u6bb5\uff0c\u6211\u4eec\u53ef\u4ee5\u63a8\u51fa\u53e6\u4e00\u4e2a\u77e9\u9635\u5c31\u662f\uff1a\n\n$\\ 10^k \\  0 \\ 0 $\n\n$\\ \\ 1    \\ \\ \\ 1    \\ 0$\n\n$\\ \\ 0    \\ \\ \\ 1    \\ 1$\n\n\u53ea\u6709$k$\u662f\u9700\u8981\u6539\u53d8\u7684\u3002\n\n\u603b\u7ed3\uff1a\u77e9\u9635\u4e58\u6cd5\u4e2d\u5206\u6bb5\u5904\u7406\u7684\u601d\u60f3\u662f\u5341\u5206\u5e38\u89c1\u7684\uff08\u6bd4\u5982$NOI2020Day1T1$\uff09\uff0c\u5e0c\u671b\u901a\u8fc7\u8fd9\u5230\u9898\uff0c\u81ea\u5df1\u80fd\u591f\u6709\u6240\u4f53\u4f1a\u3002\n\n$code:$\n```cpp\n#include<cmath>\n#include<cstring>\n#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<queue>\n#include<vector>\n#include<map>\n#include<bitset>\n#define int long long\n#define reg register\nusing namespace std;\nconst int maxn=4e5+5;\n//const int mod=1e9+7;\nconst int INF=0x3f3f3f3f;\ninline int read()\n{\n    int x=0,f=1;\n    char ch=getchar();\n    while(ch<'0' || ch>'9')\n    {\n        if(ch=='-')\n        f=-1;\n        ch=getchar();\n    }\n    while(ch>='0' && ch<='9')\n    {\n        x=x*10+ch-'0';\n        ch=getchar();\n    }\n    return x*f;\n}\nstruct Matrix\n{\n\tint a[5][5];\n}ans,wns;\nint n,mod;\nint v[25];\nMatrix Work(Matrix x,Matrix y)\n{\n\tMatrix c;\n\tmemset(c.a,0,sizeof(c.a));\n\tfor(reg int i=1;i<=3;i++)\n\t{\n\t\tfor(reg int j=1;j<=3;j++)\n\t\t{\n\t\t\tfor(reg int k=1;k<=3;k++)\n\t\t\t{\t\n\t\t\t\tc.a[i][j]=(c.a[i][j]+x.a[i][k]%mod*y.a[k][j]%mod)%mod;\n\t\t\t}\n\t\t}\n\t}\n\treturn c;\n}\t\nMatrix mul(Matrix x,int y)\n{\n\tMatrix res;\n\tmemset(res.a,0,sizeof(res.a));\n\tfor(reg int i=1;i<=3;i++)\n\t\tres.a[i][i]=1;\n\twhile(y)\n\t{\n\t\tif(y & 1)\n\t\tres=Work(x,res);\n\t\tx=Work(x,x);\n\t\ty>>=1;\n\t}\n\treturn res;\n}\nsigned main()\n{\n\tn=read(),mod=read();\n\tv[0]=1;\n\tfor(reg int i=1;i<=18;i++)\n\tv[i]=v[i-1]*10;\n\tans.a[1][1]=0,ans.a[1][2]=1,ans.a[1][3]=1;\n\twns.a[2][1]=wns.a[2][2]=wns.a[3][2]=wns.a[3][3]=1;\n\tfor(int i=1;;i++)\n\t{\n\t\twns.a[1][1]=v[i]%mod;\n\t\tint tot=min(n,v[i]-1)-v[i-1]+1;\n\t\tMatrix val=mul(wns,tot);\n\t\tans=Work(ans,val);\n\t\tif(v[i]-1>=n)\n\t\tbreak;\n\t}\n\tprintf(\"%lld\\n\",ans.a[1][1]%mod);\n\treturn 0;\n}\n/*\n1 0 10\n1 1\n1 1\n1 1\n1 1\n1 1\n1 1\n1 1\n1 1\n1 1\n1 1\n*/\n```\n\n\n\n\n",
        "postTime": 1610500217,
        "uid": 114514,
        "name": "zzr8178541919",
        "ccfLevel": 7,
        "title": "P3216 [HNOI2011]\u6570\u5b66\u4f5c\u4e1a"
    },
    {
        "content": "\uff08\u65e5\u5e38\u804a\u5929\uff09\u8868\u793a\u849f\u84bb\u7684\u6211\uff0c\u5e76\u4e0d\u592a\u8bb0\u5f97\u4f4f\u77e9\u9635\u662f\u600e\u6837\u4e58\u7684\uff0c\u4f46\u6211\u8bb0\u4f4f\u4e86\u4ee3\u7801\uff0c\u6240\u4ee5\u6709\u6ca1\u6709\u54ea\u4f4d\u5927\u4f6c\u6559\u4e00\u4e0b\u6211\u77e9\u9635\u4e58\u6cd5\uff0c\u4e07\u5206\u611f\u8c22\u3002\n\n###  ~~\u660e\u5929\u53c8\u53ef\u4ee5\u6765\u673a\u623f\u5566\uff0c\u597d\u5f00\u5fc3\uff0c\u6700\u8fd1\u5728\u5b66\u6570\u4f4dDP\uff0c\u6709\u6ca1\u6709\u5927\u4f6c\u6559\u4e0b\u6211\uff0c\u8c22\u8c22\uff01\uff01\uff01~~\n\n\n\n------------\n\u9996\u5148\uff0c\u770b\u9898\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u4ed6\u6709\u4e00\u4e2a\u795e\u5947\u7684\u6570\u636e\u8303\u56f4\uff0c\u7136\u540e\u6211\u4eec\u5f80\u4e00\u4e2a\u795e\u5947\u7684\u65b9\u5411\u60f3\uff0c\u5ffd\u7136\uff0c\u60f3\u5230\u4e86\uff08~~\u70b9\u5f00\u6807\u7b7e~~\uff09\u77e9\u9635\u4e58\u6cd5\u3002\n\n\u7136\u540e\u5f00\u59cb\uff0c\u6211\u4eec\u7684\u63a8\u5f0f\u5b50\u4e4b\u65c5\u3002\n\n# \u539f\u59cb\u77e9\u9635\n\n\u9996\u5148\uff0c\u6211\u4eec\u6784\u5efa\u539f\u59cb\u77e9\u9635\uff0c\u5148\u5c06\u6211\u4eec\u7684\u8981\u6c42\u7684\u6570**fn**\u653e\u5165\u77e9\u9635\u4e2d\uff0c\u7136\u540e\uff0c\u518d\u5c06\u9898\u91cc\u6240\u7ed9\u4fe1\u606f\uff0c\u5c06**n**\u8fd9\u4e2a\u6570\u653e\u5165\u77e9\u9635\u4e2d\uff0c\u5982\u679c\u8fd9\u65f6\uff0c\u6211\u4eec\u5f00\u59cb\u6784\u5efa\u8f6c\u79fb\u65b9\u7a0b\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u5728\u4e0b\u4e00\u4e2a\u77e9\u9635\u4e2d\u51fa\u4e0d\u6765**n+1**\u8fd9\u4e2a\u6570\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u518d\u5c06**\u4e00\u4e2a\u5e38\u65701\u653e\u5165\u539f\u59cb\u77e9\u9635\u4e2d**\u3002\u8fd9\u6837\u539f\u59cb\u77e9\u9635\u5c31\u6784\u9020\u597d\u4e86\u3002\n\n# \u8f6c\u79fb\u77e9\u9635\n\n\u4e4b\u540e\u6211\u4eec\u60f3\u5982\u4f55\u5c06**fn**\u53d8\u4e3a**f\uff08n+1\uff09**\uff0c\u5f88\u5bb9\u6613\u60f3\u5230\uff0c\u5c06**f\uff08n\uff09** * **n**\u8fd9\u4e2a\u6570\u7684\u4f4d\u6570\uff0c\u518d\u52a0\u4e0a**n**\uff0c\n\n\u7b2c\u4e00\u5c42\uff0c\u5373\u662f\uff08$10^{k}$ ,1,0\uff09;\n\n\u4e4b\u540e\u6211\u4eec\u60f3\u5982\u4f55\u5c06**n**\u53d8\u4e3a**n+1**\uff0c\u8fd9\u4e2a\u4e5f\u5f88\u5bb9\u6613\u60f3\u5230\uff0c\u5373\u501f\u7528\u4e00\u4e0b\u90a3\u4e2a\u5e38\u6570**1**\uff1b\n\n\u7b2c\u4e8c\u5c42\uff0c\u5373\u662f\uff080,1,1\uff09\uff1b\n\n\u7b2c\u4e09\u5c42\uff0c\u4e0d\u518d\u5e9f\u8bdd\uff0c\u5373\u662f\uff080,0,1\uff09\uff1b\n\n\u6700\u540e\u5373\u662f!\n![](https://cdn.luogu.com.cn/upload/image_hosting/m4ctn8xh.png)\n\n### \u7136\u540e\uff0c\u7528\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316\u4e00\u4e0b\u3002\n\n\u597d\u7684\uff0c\u4e0b\u9762\u4e0a\u4ee3\u7801\u3002\n\n```cpp\n#include<bits/stdc++.h>\n\n#define int long long\n\nusing namespace std;\n\nstruct node{\n\tint num[5][5],x,y;\n}ma;\n\nint n,num,cnt,m;\n\nnode ans;\n\nnode mul(node a,node b)\n{\n\tnode anss;\n\t\n\tmemset(anss.num,0,sizeof(anss.num));\n\t\n\tanss.x=a.x;\n\t\n\tanss.y=b.y;\n\t\n\tfor(int i=1;i<=a.y;i++)\n\t{\n\t\tfor(int j=1;j<=a.x;j++)\n\t\t{\n\t\t\tfor(int k=1;k<=b.y;k++)\n\t\t\t{\n\t\t\t\tanss.num[j][k]=(anss.num[j][k]+(a.num[j][i]*b.num[i][k])%m)%m;\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn anss;\n}\n\nsigned main()\n{\n\tcin>>n>>m;\n\t\n\tint nn=n;\n\t\n\twhile(nn!=0)\n\t{\n\t\tcnt++;\n\t\t\n\t\tnn=nn/10;\n\t}\n\t\n\tint num=1;\n\t\n\tans.num[2][1]=1;\n\t\n\tans.num[3][1]=1;\n\t\n\tans.x=3; ans.y=1;\n\t\n\tma.x=ma.y=3;\n\t\n\tfor(int i=1;i<=cnt;i++)\n\t{\n\t\tmemset(ma.num,0,sizeof(ma.num));\n\t\t\n\t\tnum=num*10;\n\t\t\n\t\tma.num[1][1]=num%m;\n\t\t\n\t\tma.num[1][2]=ma.num[2][2]=ma.num[2][3]=ma.num[3][3]=1;\n\t\t\n\t\tint numm=num-num/10;\n\t\t\n\t\tif(i==cnt) numm=n-num/10+1;\n\t\t\n\t\twhile(numm!=0)\n\t\t{\n\t\t\tif(numm%2==1) ans=mul(ma,ans);\n\t\t\t\n\t\t\tma=mul(ma,ma);\n\t\t\t\n\t\t\tnumm/=2;\n\t\t}\n\t\t\n\t}\n\t\n\tcout<<ans.num[1][1]%m<<'\\n';\n\t\n\treturn 0;\n\t\n}\n```\n\n# \u8bf7\u4e0d\u8981\u5410\u69fd\u4ee3\u7801\u7801\u98ce\uff0c\u6211\u7684\u7801\u98ce\u6211\u505a\u4e3b\u3002",
        "postTime": 1568985168,
        "uid": 174026,
        "name": "\u6b27\u9e70",
        "ccfLevel": 0,
        "title": "P3216 [HNOI2011]\u6570\u5b66\u4f5c\u4e1a\u9898\u89e3"
    },
    {
        "content": "\u849f\u84bb\u770b\u5230\u8fd9\u9898\u9898\u89e3\u745f\u745f\u53d1\u6296\n\n\u62c6\u5f00\u77e9\u4e58\u5c82\u4e0d\u662f\u8981\u70e6\u6b7b\u4eba\n\n\u90a3\u6211\u4eec\u6765\u89c2\u5bdf\u4e00\u4e0b\u8fd9\u4e2a\u4e1c\u897f\n\n\u5982\u679c\u6211\u4eec\u6709\u4e00\u4e2a\u51fd\u6570\u53ef\u4ee5\u8ba1\u7b97\u51fa\u6765\u628a$[l,r]$(l\uff0cr\u4f4d\u6570\u76f8\u540c)\u4e32\u5230\u4e00\u8d77\u7684\u503c\uff0c\u90a3\u7b54\u6848\u5c31\u975e\u5e38\u663e\u7136\u4e86\n\n\u6309\u7167\u4f4d\u6570\u5206\u6bb5\u505a\uff0c\u6bcf\u4e00\u6bb5\u7684\u4f4d\u6570\u662f\u5bb9\u6613\u6c42\u7684\uff0c\u5c31\u7528\u539f\u6765\u7684\u7b54\u6848\u4e58\u4e0a10\u7684\u4f4d\u6570\u6b21\u65b9\u518d\u52a0\u4e0a$[l,r]$\u7684\u7b54\u6848\n\n\u5982\u679c\u6211\u4eec\u8bbe\u8fd9\u6bb5\u533a\u95f4\u5185\u7684\u4f4d\u6570\u90fd\u4e3a$k$\uff0c\u90a3\u4e48\u8fd9\u4e00\u6bb5\u7684\u503c\u5c31\u662f\n\n$r+(r-1)*10+(r-2)*10^2+...+l*10^{r-l}$\n\n\u8fd9\u662f\u4e2a\u7b49\u5dee\u6bd4\u6570\u5217\uff0c\u7136\u800c\u6c42\u548c\u516c\u5f0f\u663e\u7136\u4e0d\u80fd\u7528\u56e0\u4e3a$m$\u4e0d\u4e00\u5b9a\u662f\u7d20\u6570\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u8003\u8651\u6309\u7167\u5206\u6cbb\u6cd5\u6c42\u548c\u7b49\u6bd4\u6570\u5217\u7684\u529e\u6cd5\u6765\u505a\n\n\u5047\u8bbe$S(l,r,n)=l+(l-1)r+(l-2)r^2+...(l-n)r^n$\n\n\u663e\u7136$S(l,r,0)=l$\n\n\u7136\u540e\u6309\u7167$n$\u7684\u5947\u5076\u6027\u5206\u7c7b\n\n$n$\u662f\u5947\u6570:\n$S(l,r,n)=[l+(l-1)r+...+(l-\\frac{n-1}{2})r^{\\frac{n-1}{2}}]+r^\\frac{n+1}{2}[(l-\\frac{n+1}{2})+...(l-n)^\\frac{n-1}{2}]$\n\n$=(1+r^\\frac{n+1}{2})[l+(l-1)r+...+(l-\\frac{n-1}{2})r^{\\frac{n-1}{2}}]-\\frac{n+1}{2}r^\\frac{n+1}{2}(1+r+...r^\\frac{n-1}{2})$\n\n$=(1+r^\\frac{n+1}{2})S(l,r,\\frac{n-1}{2})-\\frac{n+1}{2}r^\\frac{n+1}{2}(1+r+...r^\\frac{n-1}{2})$\n\n\u540e\u9762\u7684\u8fd9\u4e00\u957f\u4e32\u53ef\u4ee5\u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\u5206\u6cbb\u6c42\u89e3\n\n$n$\u662f\u5076\u6570:$S(l,r,n)=S(l,r,n-1)+(l-n)r^n$\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u5f97\u5230\u4e86$O(log^3n)$\u7684\u505a\u6cd5[\u9012\u5f52$log$\u6b21\uff0c\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u662f$log^2$\u7684(\u9012\u5f52$log$\u6b21\uff0c\u5feb\u901f\u5e42\u662f$log$\u7684)]\n\n\u7ec6\u8282:unsigned long long\u5728\u5904\u7406\u51cf\u6cd5\u7684\u65f6\u5019\u8981\u6781\u4e3a\u5c0f\u5fc3\uff0c\u8fd8\u6709\u6ce8\u610f\u4e58\u6cd5\u53d6\u6a21\u7684\u95ee\u9898\n\n```\n#include<iostream> \n#include<cstdio>\n#include<cstring>\n#define ull unsigned long long\nusing namespace std;\null n,m;\null length(ull l,ull r,ull len){return (r-l+1)*len;}\null qpower(ull a,ull b,ull m)\n{\n\tull ans=1%m;a%=m;\n\twhile(b)\n\t{\n\t\tif(b&1)ans=ans*a%m;\n\t\ta=a*a%m;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\null s(ull r,ull n)\n{\n\tif(!n)return 1;\n\tif(n&1)return (1+qpower(r,(n+1)>>1,m))%m*s(r,n>>1)%m;\n\treturn ((1+qpower(r,n>>1,m))%m*s(r,(n>>1)-1)%m+qpower(r,n,m))%m;\n}\null calc(ull l,ull r,ull n)\n{\n\tif(!n)return l;\n\tif(n&1)return ((1+qpower(r,(n+1)>>1,m))*calc(l,r,n>>1)%m-qpower(r,(n+1)>>1,m)*(((n+1)>>1)%m)%m*s(r,n>>1)%m+m)%m;\n\treturn ((1+qpower(r,n>>1,m))*calc(l,r,(n>>1)-1)%m+m-qpower(r,n>>1,m)*((n>>1)%m)%m*s(r,(n>>1)-1)%m+((l+m-n%m)%m)*qpower(r,n,m)%m+m)%m;\n}\nint main()\n{\n\tscanf(\"%lld%lld\",&n,&m);\n\tull i,l,len;\n\tull ans=0;\n\tfor(i=1,l=1;i*10<=n;i*=10,l++)\n\t{\n\t\tlen=length(i,i*10-1,l);\n\t\tans=(ans*qpower(10,len,m)%m+calc((i*10-1)%m,i*10%m,i*9-1))%m;\n\t}\n\tlen=length(i,n,l);\n\tans=(ans*qpower(10,len,m)%m+calc(n%m,i*10%m,n-i))%m;\n\tcout<<ans<<endl;\n}\n```",
        "postTime": 1540553660,
        "uid": 22136,
        "name": "qwaszx",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P3216 \u3010[HNOI2011]\u6570\u5b66\u4f5c\u4e1a\u3011"
    },
    {
        "content": "## \u63d0\u4f9b\u4e00\u4e2a\u5947\u5999\u7684\u6784\u9020\u77e9\u9635\u65b9\u6cd5\n$ \\begin{bmatrix} dp[i]  \\\\ i  \\\\i+1 \\end{bmatrix} = \\begin{bmatrix} dp[i-1]  \\\\ i-1  \\\\i \\end{bmatrix} \\begin{bmatrix} 10^k &0 &1 \\\\ 0&0&1  \\\\0&-1&2 \\end{bmatrix}  $\n\n\u4f60\u8bf4\u4f5c\u8005\u4e00\u5f00\u59cb\u600e\u4e48\u6ca1\u6709\u60f3\u5230\u5377\u4e00\u4e2a$1$\u8fdb\u6765\uff0c\u771f\u662f\u7b28\u6b7b\u4e86\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nint n,mod;\nstruct matrix{\n\tint s[3][3];\n\tmatrix operator*(matrix a){\n\t\tmatrix ans;\n\t\tmemset(ans.s,0,sizeof ans.s);\n\t\tfor(int i=0;i<3;i++)\n\t\tfor(int j=0;j<3;j++)\n\t\tfor(int k=0;k<3;k++)\n\t\tans.s[i][j]=((ans.s[i][j]+a.s[i][k]*s[k][j])%mod+mod)%mod;\n\t\treturn ans;\n\t}\n}ans,base,k;\nmatrix one(){\n\tmatrix a;\n\tmemset(a.s,0,sizeof a.s);\n\tfor(int i=0;i<3;i++)a.s[i][i]=1;\n\treturn a;\n}\nmatrix ksm(matrix a,int b){\n\tmatrix ans=one();\n\tfor(;b;b>>=1,a=a*a)\n\tif(b&1)ans=ans*a;\n\treturn ans;\n}\n__int128 ten[22];\nsigned main(){\n\tcin>>n>>mod;\n\tn++;\n\tten[0]=1;\n\tfor(int i=1;i<=20;i++)ten[i]=ten[i-1]*10;\n\tmemset(base.s,0,sizeof base.s);\n\tk.s[0][0]=0,k.s[1][0]=0,k.s[2][0]=1;\n\tbase.s[0][2]=1,base.s[1][2]=1,base.s[2][1]=-1,base.s[2][2]=2;\n\tfor(int i=1;i<=(int)ceil(1+log(n)/log(10.0));i++){\n\t\tbase.s[0][0]=ten[i]%mod;\n\t\tif(n<ten[i]){\n\t\t\tk=k*ksm(base,n-ten[i-1]);\n\t\t\tcout<<k.s[0][0];\n\t\t\treturn 0;\n\t\t}k=k*ksm(base,ten[i]-ten[i-1]);\n\t}\n}\n```\n",
        "postTime": 1604154396,
        "uid": 100325,
        "name": "peterwuyihong",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3216 \u3010[HNOI2011]\u6570\u5b66\u4f5c\u4e1a\u3011"
    },
    {
        "content": "## \u9898\u610f\n$ \\text{Concatenate}(n)$ \u662f\u5c06 $1 \\sim n$ \u6240\u6709\u6b63\u6574\u6570 \u987a\u5e8f\u8fde\u63a5\u8d77\u6765\u5f97\u5230\u7684\u6570\uff0c\u8ba1\u7b97 $\\text{Concatenate}(n) \\bmod m$ \u7684\u503c\u3002\n## \u9898\u89e3\n\u5bf9\u4e0e\u4f4d\u6570\u76f8\u540c\u7684\u6570\uff0c\u7528$k$\u8868\u793a\u4f4d\u6570\uff0c\u7528$f[x]$\u8868\u793a\u4ece$10^k$\u4e00\u76f4\u5199\u5230$x$\u7684\u503c\uff0c\u5219\u6709:\n$$\nf[x]=f[x-1]\\times 10^{k+1}+x\\pmod m\n$$\n\u5c31\u76f8\u5f53\u4e8e\u5728\u539f\u4e32\u4e0a\u62fc\u63a5\u4e86$x$\uff0c\u4f46\u770b\u5230$1\\le n \\le 10^{18}$\u7684\u6570\u636e\u8303\u56f4~~\u5f53\u573a\u5c31\u653e\u5f03\u4e86~~\uff0c\u5f88\u660e\u663e\u6211\u4eec\u5fc5\u987b\u4f18\u5316\u4e0a\u9762\u7684\u67ff\u5b50\uff0c\u4e0d\u7136\u7a0b\u5e8f\u80fdT\u98de\u5230\u5929\u4e0a\u53bb\n\n\u8fd9\u91cc\u6211\u4eec\u9700\u8981\u5f15\u5165\u77e9\u9635\u4e58\u6cd5\u7684\u6982\u5ff5\n>\u77e9\u9635\u76f8\u4e58\u6700\u91cd\u8981\u7684\u65b9\u6cd5\u662f\u4e00\u822c\u77e9\u9635\u4e58\u79ef\u3002\u5b83\u53ea\u6709\u5728\u7b2c\u4e00\u4e2a\u77e9\u9635\u7684\u5217\u6570\uff08column\uff09\u548c\u7b2c\u4e8c\u4e2a\u77e9\u9635\u7684\u884c\u6570\uff08row\uff09\u76f8\u540c\u65f6\u624d\u6709\u610f\u4e49 [1]  \u3002\u4e00\u822c\u5355\u6307\u77e9\u9635\u4e58\u79ef\u65f6\uff0c\u6307\u7684\u4fbf\u662f\u4e00\u822c\u77e9\u9635\u4e58\u79ef\u3002\u4e00\u4e2a$m\u00d7n$\u7684\u77e9\u9635\u5c31\u662f$m\u00d7n$\u4e2a\u6570\u6392\u6210$m$\u884c$n$\u5217\u7684\u4e00\u4e2a\u6570\u9635\u3002\u7531\u4e8e\u5b83\u628a\u8bb8\u591a\u6570\u636e\u7d27\u51d1\u5730\u96c6\u4e2d\u5230\u4e86\u4e00\u8d77\uff0c\u6240\u4ee5\u6709\u65f6\u5019\u53ef\u4ee5\u7b80\u4fbf\u5730\u8868\u793a\u4e00\u4e9b\u590d\u6742\u7684\u6a21\u578b\uff0c\u5982\u7535\u529b\u7cfb\u7edf\u7f51\u7edc\u6a21\u578b\u3002 [2] --\u767e\u5ea6\u767e\u79d1\n\n>\u8bbe$A$\u4e3a$m\\times p$ \u7684\u77e9\u9635\uff0c$B$\u4e3a$p\\times n$ \u7684\u77e9\u9635\uff0c\u90a3\u4e48\u79f0$m\\times n$\u7684\u77e9\u9635$C$\u4e3a\u77e9\u9635$A$\u4e0e$B$\u7684\u4e58\u79ef\uff0c\u8bb0\u4f5c $C=AB$\uff0c\u5176\u4e2d\u77e9\u9635C\u4e2d\u7684\u7b2c $i$\u884c\u7b2c$j$ \u5217\u5143\u7d20\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a$(AB)_{ij}=\\sum_{k=1}^pa_{ik}b_{kj}$\n\n\n\u5f88\u660e\u663e\uff1a\n$$\\begin{matrix}\n f[x+1]&=&f[x]\\times 10^{k+1}  &+x&+1 \\\\ \n x+1&=&0  &+x&+1 \\\\ \n 1&=&0  &+0&+1 \\\\ \n\\end{matrix}\n   $$\n\u90a3\u4e48\u77e9\u9635\u4e5f\u5f88\u5bb9\u6613\u6784\u9020\u4e86\n$$\n\\text{\u8bbe}P=\\begin{bmatrix}\n10^{k+1}&1&1\\\\\n0 &1&1\\\\\n0&0&1\n\\end{bmatrix}\n$$\n\n$$\n\\begin{pmatrix}\ng[x]\\\\ x\\\\ 1\n\\end{pmatrix}\n\n=P\\times \n\\begin{pmatrix}\ng[x-1]\\\\ x-1\\\\ 1\n\\end{pmatrix}\n\n=P \\times P \\times \n\\begin{pmatrix}\ng[x-2]\\\\ \nx-2\\\\  \n1\n\\end{pmatrix}\n=\n\\dots=\nP^{x-10^k}\\times \n\\begin{pmatrix}\n10^k\\\\ 10^k\\\\ 1\n\\end{pmatrix}\n$$\n\u5bf9\u4e8e\u7531\u4e8e\u77e9\u9635\u4e5f\u6709\u7ed3\u5408\u5f8b\uff0c\u5f0f\u4e2d\u7528\u5feb\u901f\u5e42\u5904\u7406$P$\u7684\u6b21\u65b9\u5c31\u884c\u4e86\n## \u4ee3\u7801\n```cpp\n //#pragma GCC optimize(3,\"Ofast\",\"inline\")\n#include<bits/stdc++.h>\nnamespace in{\n\tchar buf[1<<21],*p1=buf,*p2=buf;\n\tinline int getc(){\n\t    return p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++;\n\t}\n\ttemplate <typename T>inline void read(T& t){\n\t    t=0;int f=0;char ch=getc();\n\t    while (!isdigit(ch)){\n\t        if(ch=='-')f = 1;\n\t        ch=getc();\n\t    }\n\t    while(isdigit(ch)){\n   \t    \tt=t*10+ch-48;\n   \t    \tch = getc();\n   \t\t}\n\t\tif(f)t=-t;\n\t}\n\ttemplate <typename T,typename... Args> inline void read(T& t, Args&... args){\n\t    read(t);read(args...);\n\t}\n}\nnamespace out{\n\tchar buffer[1<<21];\n\tint p1=-1;\n\tconst int p2 = (1<<21)-1;\n\tinline void flush() {\n\t\tfwrite(buffer,1,p1+1,stdout),\n\t\tp1=-1;\n\t}\n\tinline void putc(const char &x) {\n\t\tif(p1==p2)flush();\n\t\tbuffer[++p1]=x;\n\t}\n\ttemplate <typename T>void write(T x) {\n\t\tstatic char buf[15];\n\t\tstatic int len=-1;\n\t\tif(x>=0){\n\t\t\tdo{\n    \t\t\tbuf[++len]=x%10+48,x/=10;\n    \t\t}while (x);\n\t\t}else{\n    \t\tputc('-');\n\t\t\tdo {\n    \t\t\tbuf[++len]=-(x%10)+48,x/=10;\n\t\t\t}while(x);\n\t\t}\n\t\twhile (len>=0)\n\t\t\tputc(buf[len]),--len;\n\t}\n}\n//fread\u5feb\u8bfb\u5feb\u8f93\n//\u8ba9\u4f60\u7684\u4ee3\u7801\u770b\u4e0a\u53bb\u66f4\u9ad8\u7ea7\uff08\u9003 \n#define int unsigned long long\nusing namespace std;\nint mod;\nstruct mat{//\u77e9\u9635\n\tint m,n;//\u77e9\u9635\u7684\u884c\u6570\u3001\u5217\u6570\n\tint a[10][10];\n\tint *operator[](const int i){\n\t\treturn a[i];\n\t}\n\tmat(){\n\t\tmemset(a,0,sizeof a);\n\t\tm=n=3;\n\t}\n\tmat(int hang,int lie,int *num){\n\t\tm=hang,n=lie;\n\t\tfor(int i=1,tot=0;i<=hang;i++)\n\t\t\tfor(int j=1;j<=lie;j++)\n\t\t\t\ta[i][j]=num[tot++];\n\t} \n\tmat(int hang,int lie){\n\t\tm=hang,n=lie;\n\t\tmemset(a,0,sizeof a);\n\t} \n\tmat operator*(mat b)const{//\u91cd\u8f7d\u4e58\u53f7 \n\t\t//\u4fdd\u8bc1n=b.m\n\t\tmat c(m,b.n);\n\t\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=b.n;j++)\n\t\tfor(int k=1;k<=m;k++) \n\t\t\tc[i][j]+=a[i][k]*b[k][j]%mod,c[i][j]%=mod;\n\t\treturn c;\n\t}\n};\nint n;\nmat fpow(mat a,int b){//\u77e9\u9635\u5feb\u901f\u5e42 \n\tint tmp[]={1,0,0,0,1,0,0,0,1};//\u5355\u4f4d\u77e9\u9635 \n\tmat ans(3,3,tmp);\n\twhile(b){\n\t\tif(b&1)ans=ans*a;\n\t\ta=a*a;b>>=1;\n\t}return ans;\n}\nint fpow(int a,int b){//\u6574\u6570\u5feb\u901f\u5e42 \n\tint ans=1;\n\twhile(b){\n\t\tif(b&1)ans=ans*a%mod;\n\t\ta=a*a%mod;b>>=1;\n\t}return ans;\n}\nint ans=0,already=0;\n//   \u7b54\u6848 \u5df2\u6709\u4f4d\u6570 \n#define pow lpow\nint lpow(int a,int b){\n\tint ans=1;\n\twhile(b){\n\t\tif(b&1)ans=ans*a;\n\t\ta=a*a;b>>=1;\n\t}return ans;\n\t\n}\nsigned main(){\n\tin::read(n,mod);\n\tfor(int k=0;pow(10,k)<=n;k++){//\u679a\u4e3eK \n\t\t//printf(\"%d\\n\",k);\n\t\tint t[]={fpow(10,k),fpow(10,k),1};\n\t\tmat tmp(3,1,t);\n\t\tint tt[]={fpow(10,k+1),1,1,0,1,1,0,0,1};\n\t\tmat p(3,3,tt);\n\t\t//printf(\" %lld\\n\",(min(pow(10,k+1),n+1)-pow(10,k))*(k+1));\n\t\tans*=fpow(10,(min((int)pow(10,k+1),n+1)-(int)pow(10,k))*(k+1));\n\t\tans%=mod;\n\t\t//printf(\" %lld\\n\",min((int)pow(10,k+1)-1,n)-(int)pow(10,k));\n\t\tans+=((fpow(p,(int)min((int)pow(10,k+1)-1,n)-(int)pow(10,k))*tmp))[1][1];\n\t\tans%=mod;\n\t}\n\tout::write(ans);\n\tout::flush();\n\treturn 0;\n}\n```\n\u5176\u5b9e\u8fd9\u9898\u601d\u7ef4\u96be\u5ea6\u5e76\u4e0d\u5927\uff0c\u53ea\u662f\u4ee3\u7801\u7ec6\u8282**\u6709\u70b9**\u591a",
        "postTime": 1595775512,
        "uid": 174304,
        "name": "jun\u5934\u5409\u5409",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P3216 \u3010[HNOI2011]\u6570\u5b66\u4f5c\u4e1a\u3011"
    },
    {
        "content": "\u7b2c\u4e00\u7bc7\u9898\u89e3\uff01QwQ~\n\n*\u8fd9\u9053\u9898\u9996\u5148\u662f\u8981\u660e\u767d\u77e9\u9635\u5feb\u901f\u5e42\u7684\u4f5c\u7528\uff1a\u5c061e18\u7684N\u8f6c\u6362\u4e3a\u53ef\u4ee5\u7528\u5feb\u901f\u5e42\u505a\u7684\u5feb\u901f\u8fd0\u7b97\u3002\u3002\u3002\n\n*\u5176\u6b21\u662f\u672c\u9898\u849f\u84bb\u8ba4\u4e3a\u7684\u4e00\u4e2a\u5751\u70b9\u2014\u2014\u88abMOD\u8fc7\u7684LL\u7c7b\u578b\u7684\u76f8\u4e58\u867d\u7136\u611f\u89c9\u4e0a\u662f\u4e0d\u4f1a\u201c\u7206\u70b8\u201d\u7684\uff0c\u4f46\u5728\u672c\u9898\u548c\u4e00\u4e9b\u5176\u5b83\u7684\u77e9\u9635\u7c7b\u578b\u9898\u4e2d\u662f\u5f88\u6709\u53ef\u80fd\u7684\uff0c\u6240\u4ee5\u5f88\u9700\u8981\u4e00\u4e2aQ_Mul\u51fd\u6570\u6765\u5feb\u901f\u4e58\uff0c\u9632\u6b62LL\u7c7b\u578b\u7206\u70b8\u3002\u3002\u3002\n\n*\u8fd8\u6709\u4e00\u4e2a\u672c\u9898\u7684\u5751\u70b9\u2014\u2014\u9700\u8981\u5c06Ten\u7684Ten[0]\uff0c\u53730\u4f4d\u6570\u8bbe\u4e3a1\uff0c\u8be6\u60c5\u8bf7\u770b\u4ee3\u7801\u3002\n\n*\u672c\u9898\u7684\u4e00\u4e2a\u96be\u70b9\u2014\u2014\u9700\u8981\u7528A[20]\u6765\u5b58\u50a8\u6bcf\u4e00\u4e2d\u4f4d\u6570\u6240\u9700\u8981\u7684A\u77e9\u9635\n   \n\u4f8b\u5982\uff1a\u82e5Ans\u6b64\u65f6\u4e3a\u4e24\u4f4d\u6570\uff0c\u90a3\u6211\u6211\u4eec\u5c31\u9700\u8981\u4e00\u4e2aA[2],\u5373{{LL,LL,LL,LL},{LL,10^2,1,1},{LL,0,1,1},{LL,LL,0,1}}\u6765\u4f5c\u4e3a\nAns\u4e58\u7684\u5bf9\u8c61\uff0c\u662f\u7684Ans\u4e58\u4ee5A[2]\u4e86\u4e4b\u540e\u53ef\u4ee5\u5f97\u5230Ans\u7684\u4e0b\u4e00\u6b21\u5904\u7406\u540e\u7684\u6570\u3002\n\n\uff08\u4ee3\u7801\u6709\u70b9\u3002\u3002\u3002\uff09\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cmath> \n\n#define INF 0x3f3f3f3f\nusing namespace std;\n\nlong long Total,MOD;\n\ninline long long Q_Mul(long long L,long long R,long long P)\n{\n\tL=(L%P+P)%P; \n\tR=(R%P+P)%P;\n\tlong long Res=L*R-(long long)((long double)L/P*R+1e-8)*P; \n\treturn Res < 0?Res+P:Res;  \n}//\u5feb\u901f\u4e58\uff0c\u9632\u6b62LL\u7206\u70b8\n\nstruct Node{\n\tlong long Squ[4][4];\n\t\n\tinline void Clear_S(long long X)\n\t{\n\t\tfor(int i=1;i<=3;i++)\n\t\t  for(int j=1;j<=3;j++)\n\t\t    Squ[i][j]=X;\n\t}//\u6e05\u7a7aNode\u7528\n\t\n\tfriend Node operator * (Node A,Node B){\n\t\tNode Get;\n\t\tGet.Clear_S(0);\n\t\tfor(int i=1;i<=3;i++)\n\t\t  for(int j=1;j<=3;j++)\n\t\t    for(int k=1;k<=3;k++){\n\t\t    \tGet.Squ[i][j]=(Get.Squ[i][j]%MOD+Q_Mul(A.Squ[i][k],B.Squ[k][j],MOD))%MOD;\n\t\t    }\n\t\treturn Get;\n\t}//\u91cd\u8f7d\u77e9\u9635\u4e58\u6cd5\uff0c\u5373\u4e24\u77e9\u9635\u76f8\u4e58\n\t\n}A[20],Ans;//\u9700\u8981\u7528\u6765\u8f6c\u6362\u7684\u77e9\u9635\u4ee5\u53ca\u6211\u4eec\u7684Ans\n\nlong long Ten[20];//\u5176\u5b9e\u6ca1\u4ec0\u4e48\u7528\uff0c\u521d\u59cb\u5316A\u65f6\u53ef\u4ee5\u7528\n\ninline long long read()\n{\n\tunsigned long long x=0,f=1;\n\tchar c=getchar();\n\twhile(c<'0' || c>'9'){\n\t\tif(c=='-') f=-1;\n\t\tc=getchar();\n\t}\n\twhile(c>='0' && c<='9'){\n\t\tx=x*10+c-'0';\n\t\tc=getchar();\n\t}\n\treturn x*f;\n}//\u5feb\u8bfb\uff0cemm\u3002\u3002\u3002\n\ninline long long Fpow(long long x,long long y)\n{\n\tlong long step=x;\n\tlong long ans=1;\n\twhile(y){\n\t\tif(y&1)ans=ans*step;\n\t\ty>>=1;\n\t\tstep=step*step;\n\t}\n\treturn ans;\n}//\u5feb\u901f\u5e42\uff0c\u7b97Ten\u65f6\u7528\n\ninline void Sta()\n{\n\tTotal=read();MOD=read();\n\tfor(int i=1;i<=19;i++){ \n\t    Ten[i]=Fpow(10,i);\n\t\tA[i].Clear_S(1);\n\t\tA[i].Squ[2][1]=0;A[i].Squ[1][1]=Ten[i];\n\t    A[i].Squ[3][1]=0;A[i].Squ[3][2]=0;\n\t}//\u6bcf\u4e00\u4f4d\u6570\u7684A\u521d\u59cb\u5316\n\tAns.Clear_S(0);\n\tAns.Squ[3][1]=1;//Ans\u7684\u521d\u59cb\u5316emm\u3002\u3002\u3002\n\tTen[0]=1;//\u55ef\n}//\u521d\u59cb\u5316\n\ninline void Node_Pow(int X)\n{\n\tlong long Sum;\n\tif(X==(floor(log10(Total))+1)) Sum=(Total-Ten[X-1]+1);\n\telse Sum=Ten[X]-Ten[X-1];//\u6bcf\u6b21\u9700\u8981\u5b8c\u6210\u7684\u5feb\u5e42\u6570Sum\n\twhile(Sum){\n\t\tif(Sum&1) Ans=A[X]*Ans;\n\t\tSum>>=1;\n\t\tA[X]=A[X]*A[X];\n\t}//\u77e9\u9635\u5feb\u901f\u5e42\n}\n\nint main()\n{\n\tSta();//\u6574\u4f53\u521d\u59cb\u5316\uff08\u849f\u84bb\u7684\u4e60\u60ef\uff09\n\tfor(int i=1;i<=floor(log10(Total))+1;i++){\n\t\tNode_Pow(i);//\u5b8c\u6210\u6bcf\u4e00\u4f4d\u6570\u7684\u77e9\u9635\u5feb\u901f\u5e42\n\t}\n\tprintf(\"%lld\",Ans.Squ[1][1]);//\u8f93\u51fa\u7b54\u6848\n\treturn 0;\n}\n```\n*\u975e\u5e38OJBKQwQ~\n",
        "postTime": 1569388974,
        "uid": 38171,
        "name": "DeNeRATe",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3216 \u3010[HNOI2011]\u6570\u5b66\u4f5c\u4e1a\u3011"
    },
    {
        "content": "$n<=10^{18}$\u7684\u8303\u56f4\u63d0\u9192\u6211\u4eec\uff0c\u8fd9\u9898\u5e94\u8be5\u5f80\u500d\u589e/\u5feb\u901f\u5e42\u7b49\u65b9\u5411\u8003\u8651\u3002\n\n\n\u7531\u9012\u63a8\u5f0f\uff1a$f[i]*10^k+i+1=f[i+1]$\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\u8ba1\u51fa\u4ee5\u4e0b\u8f6c\u79fb\u77e9\u9635\uff1a\n\n\n$ com=\\begin{bmatrix}\n\n10^k & 0 & 0 \\\\\\\n\n1 & 1 & 0 \\\\\\\n\n1 & 1 & 1\n\n\n  \\end{bmatrix}$\n\n\u8bbe$ans=\\begin{bmatrix}f[i]&i&1\\end{bmatrix}$\u3002\n\n\u5219\uff1a$ans \\times com=\\begin{bmatrix}f[i+1]&i+1&1\\end{bmatrix}$\n\n\u5176\u4e2d$k=\\lfloor\\log{i}\\rfloor+1$\u3002\n\n\u7531\u77e9\u9635\u4e58\u6cd5\u7684\u7ed3\u5408\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u5feb\u901f\u5e42\u52a0\u901f\u8fd9\u4e2a\u8fc7\u7a0b\u3002\n\n\u56e0\u4e3ak\u7684\u53d6\u503c\u53ea\u6709\u4e0d\u523020\u79cd\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u679a\u4e3e\u5904\u7406\u3002\n\n\u5b9e\u73b0\u7ec6\u8282\u8be6\u89c1\u4ee3\u7801\u3002\n\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#define lld \"%lld\"\n#define Lovelive long long\nLovelive mod;\n\nstruct matrix{\n    int n, m;\n    Lovelive mat[10][10];\n\n    matrix(int n = 0, int m = 0): n(n), m(m) {}\n\n    void clear() {\n        memset(mat, 0, sizeof mat);\n    }\n\n    void iden() {\n        memset(mat, 0, sizeof mat);\n        for(int i = 0; i < n; i++) mat[i][i] = 1; \n    }\n\n    matrix operator * (const matrix& b) const {\n        if(m != b.n) exit(2333);\n        int p = b.m;\n        matrix c(n, b.m);\n        c.clear();\n        for(int i = 0; i < n; i++) {\n            for(int j = 0; j < p; j++) {\n                for(int k = 0; k < m; k++) {\n                    c.mat[i][j] += mat[i][k] * b.mat[k][j];\n                    c.mat[i][j] %= mod;\n                }\n            }\n        }\n        return c;\n    }\n\n    matrix operator ^ (Lovelive p) {\n        matrix ret(n, n), tmp;\n        ret.iden();\n        for(tmp = *this; p; p>>=1, tmp = tmp * tmp) {\n            if(p & 1) ret = ret * tmp;\n        }\n        return ret;\n    }\n};\n\nchar buf[2333];\nint main() {\n    Lovelive n, bit;\n    scanf(lld lld, &n, &mod);\n\n    sprintf(buf, lld, n);\n    bit = strlen(buf);\n\n    matrix ans(1, 3);\n    ans.clear();\n    ans.mat[0][2] = 1;\n\n    for(int i = 1; i <= bit; i++) {\n        Lovelive unit = pow(10, i - 1);\n\n        matrix com(3, 3);\n        com.clear();\n        com.mat[0][0] = unit % mod * 10 % mod;\n        com.mat[1][0] = com.mat[1][1] = com.mat[2][0] = com.mat[2][1] = com.mat[2][2] = 1;\n\n        if(i != bit) ans = ans * (com ^ (unit * 9));\n        else ans = ans * (com ^ (n - unit + 1));\n    }\n\n    printf(lld, ans.mat[0][0]);\n}\n```",
        "postTime": 1515174324,
        "uid": 21421,
        "name": "pantw",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3216 \u3010[HNOI2011]\u6570\u5b66\u4f5c\u4e1a\u3011"
    },
    {
        "content": "\u9898\u610f:https://www.luogu.org/problem/P3216\n\n\u4e00\u5f00\u59cb\u6ca1\u6709\u601d\u8def,\u540e\u6765\u53d1\u73b0\u4e86\u9012\u63a8\u5f0f:f[n]=f[n-1]*10^k+n(k\u662fn\u7684\u4f4d\u6570)\n\n\u60f3\u5230\u77e9\u9635\u52a0\u901f\u6570\u5217\u9012\u63a8,\u81ea\u7136\u5c31\u53ef\u4ee5\u5199\u51fa\u8f6c\u79fb\u77e9\u9635\uff1a\n\n```\n[f[i],i-1,1] * [10^k,0,0]=[f[i+1],i,1]\n\t\t[1,1,0]\n\t\t[1,1,1]\n```\n\n\u5bf910^k\u5206\u5e03\u77e9\u9635\u4e58\u6cd5\u5373\u53ef\n\ncode\uff1a\n```\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nstruct Mat\n{\n\tll a[4][4];\n\tll* operator[](int i){return a[i];}\n\tMat(int x=0){for(int i=1;i<=3;i++)for(int j=1;j<=3;j++)a[i][j]=x;}\n\tinline void idx(){for(int i=1;i<=3;i++)a[i][i]=1;}\n};\nll n,mod;\nMat A(0);\nMat operator *(Mat a,Mat b)\n{\n\tMat res(0);\n\tfor(int i=1;i<=3;i++)\n\t\tfor(int j=1;j<=3;j++)\n\t\t\tfor(int k=1;k<=3;k++)\n\t\t\t\tres[i][j]=(res[i][j]+a[i][k]*b[k][j]%mod)%mod;\n\treturn res;\t\n}\t\nMat operator ^(Mat x,ll k)\n{\n\tMat res(0);res.idx();\n\twhile(k)\n\t{\n\t\tif(k&1)res=res*x;\n\t\tx=x*x;k>>=1;\n\t}\n\treturn res;\n}\ninline ll read()\n{\n\tchar c=getchar();ll res=0,f=1;\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9')res=res*10+c-'0',c=getchar();\n\treturn res*f;\n}\ninline void calc(ll base,ll k)\n{\n\t//printf(\"%lld %lld\\n\",base,k);\n\tMat B(0);\n\tB[1][1]=base%mod;B[2][1]=B[2][2]=B[3][1]=B[3][2]=B[3][3]=1;\n\tB=B^k;A=A*B; \n}\nint main()\n{\n\tn=read(),mod=read();\n\t//printf(\"%lld %lld\\n\",n,mod);\n\tA[1][1]=0;A[1][2]=0;A[1][3]=1;//\u521d\u59cb\u4e3af[0]\n\t/*\n\tfor(int i=1;i<=3;i++,puts(\"\"))\n\t\tfor(int j=1;j<=3;j++)\n\t\t\tcout<<A[i][j]<<' ';\n\t*/\n\tll base=10;\n\twhile(base<=n)calc(base,base-(base/10)),base*=10;\n\t//printf(\"%lld\\n\",A[1][1]);\n\tcalc(base,n-(base/10)+1);\n\tprintf(\"%lld\",A[1][1]);\n\treturn 0;\n}\n```\n",
        "postTime": 1565718952,
        "uid": 145441,
        "name": "nofind",
        "ccfLevel": 6,
        "title": "P3216 [HNOI2011]\u6570\u5b66\u4f5c\u4e1a(\u77e9\u9635\u5feb\u901f\u5e42)"
    },
    {
        "content": "\u9996\u5148\u5199\u51fa\u9012\u63a8\u5173\u7cfb\u5f0f\uff1a\u4ee4s[i]\u4e3a\u524di\u4e2a\u6570\u8fde\u63a5\u5f97\u5230\u7684\u6570\uff0cc(i)\u8868\u793ai\u7684\u4f4d\u6570\uff0c\u6709s[i]= 10^c(i)+s[i-1]+i;\n\nc(i)\u968fi\u53d8\u5316\uff0c\u65e0\u6cd5\u5728\u8f6c\u79fb\u77e9\u9635T\u4e2d\u8868\u793a\u3002\u5982\u679cc(i)\u56fa\u5b9a\uff0c\u5c31\u53ef\u4ee5\u5957\u7528\u77e9\u9635\u5feb\u901f\u5e42\u7684\u65b9\u6cd5\u8fdb\u884c\u4f18\u5316\u4e86\uff01\n\n\u8003\u8651\u4f4d\u6570\u968f\u7740i\u7684\u53d8\u5316\u6700\u591a\u53ea\u4f1a\u53d8\u531618\u6b21\uff0c\u56e0\u6b64\u53ef\u4ee5\u6309\u4f4d\u6570\u5206\u6bb5\u8fdb\u884c\u77e9\u9635\u5feb\u901f\u5e42\u3002\n\n\u679a\u4e3e\u4f4d\u6570\uff0c\u90a3\u4e48\u6709:\n\n                     {10^k,     0   ,0   \n\n{f[i-1],i-1,1}\\*          1,     1   ,0  = {f[i],i,1}\n\n                             1,     1  ,1}\n\n\u8fd9\u91cc\u5728\u72b6\u6001\u77e9\u9635\u4e2d\u52a0\u4e86\u4e00\u4e2a\u6c38\u8fdc\u4e3a1\u7684\u503c\uff0c\u7528\u4e8e\u8f85\u52a9i\u6bcf\u6b21\u52a0\u4e00\u3002\n\n\u5c06\u591a\u4f4d\u6570\u6309\u6bcf\u6b21\u52a0\u6570\u65f6\u524d\u4e00\u4e2a\u6570\u6240\u4e58\u768410\u7684\u4e2a\u6570\u5206\u4e3a10-99,100-999\u3002\u3002\u3002\u7684\u6570\u5b57\u6bb5\uff0c\u65b9\u4fbf\u8fdb\u884c\u77e9\u9635\u4e58\u6cd5 \u3002\n\n\u5b9e\u73b0\u4ee3\u7801\u65f6\u5957\u6a21\u62df\u77e9\u9635\u4e58\u6cd5\u6a21\u677f\u548c\u5feb\u901f\u5e42\u6a21\u677f\u5373\u53ef\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cstdlib>\n#include<cmath>\n#include<algorithm>\n#define ll long long\nusing namespace std;\nll n,m,S[3][3]={},T[3][3]={}; \nvoid mmul(ll a[3][3],ll b[3][3],ll s[3][3])//\u6a21\u62df\u77e9\u9635\u4e58\u6cd5 \n{\n    ll tmp[3][3]={};//\u6b64\u5904a\u548cs\u662f\u540c\u4e00\u6570\u7ec4\uff0c\u5fc5\u987b\u5f00\u4e00\u4e2a\u6570\u7ec4\u4f5c\u4e2d\u8f6c\u7ad9\uff08\u800c\u4e0d\u662f\u50cf\u5728\u91cd\u8f7d\u8fd0\u7b97\u7b26\u4e2d\u7ed3\u679c\u6570\u7ec4\u662f\u72ec\u7acb\u7684\uff0c\u4e0d\u53d7\u4e58\u6570\u5f71\u54cd\uff09 \n    for(int i=0;i<3;i++)\n       for(int j=0;j<3;j++)\n          for(int k=0;k<3;k++)\n             tmp[i][j]=(tmp[i][j]+(a[i][k]%m)*(b[k][j]%m))%m;//\u4e24\u4e2a\u957f\u6574\u578b\u6570\u76f8\u4e58\uff0c\u4e00\u5b9a\u8981\u5206\u522b\u53d6\u4f59,\u5426\u5219\u4f1a\u7206\u8d1f\u6570\uff08\u8d85\u8303\u56f4\u4e86\uff09 \n    for(int i=0;i<3;i++)\n       for(int j=0;j<3;j++)\n          s[i][j]=tmp[i][j];//\u5728\u4e0d\u5f71\u54cd\u4e58\u6570\u7684\u524d\u63d0\u4e0b\u5f97\u51fa\u7ed3\u679c \n}\nvoid cal(ll t,ll last)\n{\n    memset(T,0,sizeof(T));\n    T[0][0]=t;//\u6bcf\u6b21\u52a0\u6570\u65f6\u524d\u4e00\u4e2a\u6570\u5e94\u8fdb\u7684\u4f4d\u6570 \n    T[1][0]=T[1][1]=T[2][0]=T[2][1]=T[2][2]=1;\n    ll y=last-t/10+1;//y\u51b3\u5b9a\u5728\u8be5\u6570\u5b57\u6bb5\u4e0b\u52a0\u6570\u7684\u6b21\u6570 \n    while(y)//\u5feb\u901f\u5e42\u6a21\u677f \n    {\n        if(y&1)mmul(S,T,S);//\u6a21\u62df\u77e9\u9635\u4e58\u6cd5 \n        mmul(T,T,T);\n        y>>=1;\n    }\n}\nint main()\n{\n    scanf(\"%lld%lld\",&n,&m);\n    S[0][0]=S[1][1]=S[2][2]=1;//\u521d\u59cb\u5316\n    ll t=10;\n    while(n>=t)\n    {\n        cal(t,t-1);//\u5c06\u591a\u4f4d\u6570\u6309\u6bcf\u6b21\u52a0\u6570\u65f6\u524d\u4e00\u4e2a\u6570\u6240\u4e58\u768410\u7684\u4e2a\u6570\u5206\u4e3a10-99,100-999\u3002\u3002\u3002\u7684\u6570\u5b57\u6bb5\uff0c\u65b9\u4fbf\u8fdb\u884c\u77e9\u9635\u4e58\u6cd5 \n        t*=10;\n    }\n    cal(t,n);//\u5982\u679cn<10\uff0c\u5c31\u8bf4\u660e\u6bcf\u6b21\u52a0\u6570\u65f6\u53ea\u8981\u8fdb\u4e00\u4f4d\u5373\u53ef \n    printf(\"%lld\",S[2][0]);\n    return 0;\n}\nps\uff1a\u7ba1\u7406\u5458\u7ed9\u4e2a\u901a\u8fc7\u5427\uff0c\u4e0a\u4e2a\u9898\u89e3\u7a0b\u5e8f\u8fde\u6ce8\u91ca\u90fd\u6ca1\u6709\n```",
        "postTime": 1499911433,
        "uid": 21534,
        "name": "ysner",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3216 \u3010[HNOI2011]\u6570\u5b66\u4f5c\u4e1a\u3011"
    },
    {
        "content": "### \u9898\u610f\n>\u6c42$1,2,3,\\cdots,n$\u62fc\u5728\u4e00\u8d77$\\pmod{m}$\u610f\u4e49\u4e0b\u7684\u503c\n\n### Solution\n\n\u9996\u5148\u628a\u8fd9\u4e2a\u4e1c\u897f\u8868\u793a\u51fa\u6765$f_i$\u8868\u793a$1,2,3,\\cdots,i$\u62fc\u8d77\u6765\u7684\u6570,\u56e0\u4e3a\u662f\u62fc\u8d77\u6765\u90a3\u4e48\u5c31\u662f$i$\u548c$i-1$\u7684\u8f6c\u79fb\n\n$f_i=10^{\\lfloor\\lg n\\rfloor+1}f_{i-1}+i$\n\n\u7136\u540e\u5c06\u5176\u5199\u6210\u77e9\u9635\u4e58\u6cd5\u5f62\u5f0f,\u8981\u5e26\u7740$i$\u8d70\n\n$\\begin{bmatrix}f_n\\\\n\\\\1\\end{bmatrix}=\n\\begin{bmatrix}10^{\\lfloor\\lg n\\rfloor+1}&&1&&&1\\\\\\\\\n0&&1&&&1\\\\\\\\0&&0&&&1\\end{bmatrix}\\begin{bmatrix}f_{n-1}\\\\n-1\\\\1\\end{bmatrix}$\u5373\u53ef",
        "postTime": 1596254273,
        "uid": 40629,
        "name": "zzw4257",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3216 \u3010[HNOI2011]\u6570\u5b66\u4f5c\u4e1a\u3011"
    },
    {
        "content": "\u8003\u8651\u6c42$Concatenate(L...R)$\u7684\u503c\uff0c\u5176\u4e2d$[L,R]$\u4e4b\u95f4\u7684\u6570\u90fd\u662f$x$\u4f4d\u6570\u3002\n\n\u53ef\u4ee5\u5f97\u5230\uff0c$Concatenate(L...i)$\u53ef\u4ee5\u7528\u9012\u63a8\u5f0f\u8868\u793a\u3002\u4ee5\u4e0b\u8bbe$Concatenate(L...i)$\u4e3a$f[i]$\u3002\n\n\u5219\u6709\uff1a\n\n$f[L]=L$\n\n$f[i]=f[i-1]*10^x+i$\n\n\u5efa\u7acb\u4e00\u4e2a$3*3$\u7684\u8f6c\u79fb\u77e9\u9635$P$\uff0c\u7b2c\u4e00\u884c\u4ee3\u8868$f[i]$\uff0c\u7b2c\u4e8c\u884c\u4ee3\u8868$i$\uff0c\u7b2c\u4e09\u884c\u4ee3\u8868$1$\u3002\u5219\u5bb9\u6613\u5f97\u51fa\u77e9\u9635\u5185\u5bb9\uff1a\n\n$$\n\\begin{bmatrix}\n\n10^x & 1 & 1 \\\\\n\n0 & 1 & 1 \\\\\n\n0 & 0 & 1\n\n\\end{bmatrix}\n\n$$\n$3*1$\u7684\u8fb9\u754c\u77e9\u9635$F$\uff1a\n\n$$\n\\begin{bmatrix}\n\nL \\\\\nL  \\\\\n1\n\\end{bmatrix}\n\n$$\n\u6b64\u65f6\u53ef\u4ee5\u5f97\u51fa\uff0c$f[R]=(P^{R-L}*F)[1][1]$\u3002\n\n\u7528\u8fd9\u6837\u7684\u65b9\u6cd5\uff0c\u5c31\u53ef\u4ee5\u6c42\u51fa$Concatenate(1...9)$\uff0c$Concatenate(10...99)$\uff0c$Concatenate(100...999)$\uff0c...\uff0c$Concatenate(10^k,N)$\u7684\u503c\uff0c\u7136\u540e\u4e71\u641e\u5373\u53ef\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\ntypedef long long ll;\nll nn, E10[1005]; int CYX, Exp[1005], np[25];\nstruct cyx {\n    int m, n, a[15][15];\n    cyx() {}\n    cyx(int _m, int _n) :\n        m(_m), n(_n) {memset(a, 0, sizeof(a));}\n    friend inline cyx operator * (cyx x, cyx y) {\n        cyx z = cyx(x.m, y.n); int i, j, k;\n        for (i = 1; i <= z.m; i++) for (j = 1; j <= z.n; j++)\n        for (k = 1; k <= x.n; k++)\n            (z.a[i][j] += 1ll * x.a[i][k] * y.a[k][j] % CYX)\n                %= CYX;\n        return z;\n    }\n    friend inline cyx operator ^ (cyx x, ll y) {\n        cyx aa = x, z = cyx(x.m, x.n); int i;\n        for (i = 1; i <= z.m; i++) z.a[i][i] = 1;\n        while (y) {\n            if (y & 1) z = z * aa;\n            aa = aa * aa;\n            y >>= 1;\n        }\n        return z;\n    }\n} F, P;\nint qpow(int a, ll b) {\n    int res = 1;\n    while (b) {\n        if (b & 1) res = 1ll * res * a % CYX;\n        a = 1ll * a * a % CYX;\n        b >>= 1;\n    }\n    return res;\n}\nint solve(int w, ll mx) {\n    F.a[1][1] = F.a[2][1] = Exp[w - 1];\n    F.a[3][1] = 1; P.a[1][1] = Exp[w];\n    F = (P ^ mx - E10[w - 1]) * F;\n    return F.a[1][1];\n}\ninline int read() {\n    int res = 0; bool bo = 0; char c;\n    while (((c = getchar()) < '0' || c > '9') && c != '-');\n    if (c == '-') bo = 1; else res = c - 48;\n    while ((c = getchar()) >= '0' && c <= '9')\n        res = (res << 3) + (res << 1) + (c - 48);\n    return bo ? ~res + 1 : res;\n}\nint main() {\n    int i, cnt = 0, res = 0;\n    cin >> nn; CYX = read(); Exp[0] = E10[0] = 1;\n    for (i = 1; i <= 1000; i++)\n        Exp[i] = 1ll * Exp[i - 1] * 10 % CYX;\n    for (i = 1; i <= 18; i++) E10[i] = E10[i - 1] * 10;\n    F = cyx(3, 1); P = cyx(3, 3);\n    P.a[1][2] = P.a[1][3] = P.a[2][2]\n    = P.a[2][3] = P.a[3][3] = 1; ll bb = nn;\n    while (bb) cnt++, bb /= 10;\n    for (i = 1; i <= cnt; i++) {\n        ll mx = i == cnt ? nn : E10[i] - 1;\n        res = 1ll * res *\n            qpow(qpow(10, mx - E10[i - 1] + 1), i) % CYX;\n        (res += solve(i, mx)) %= CYX;\n    }\n    printf(\"%d\\n\", res);\n    return 0;\n}\n```",
        "postTime": 1508640850,
        "uid": 29936,
        "name": "xyz32768",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3216 \u3010[HNOI2011]\u6570\u5b66\u4f5c\u4e1a\u3011"
    },
    {
        "content": "/\\*\u8fd9\u4e2a\u9898\u76ee\u5176\u5b9e\u5c31\u662f\u72b6\u6001\u8f6c\u79fb\u77e9\u9635\u5e76\u975e\u4e00\u6210\u4e0d\u53d8\u7684\uff0c\u800c\u662f\u901a\u8fc7\u8f93\u5165n\u7684\u4f4d\u6570\u53d8\u5316\u800c\u53d8\u5316\u7684\uff0c\u4f8b\u5982\uff0c\u5f53n\u57281-9\u4e4b\u95f4\u65f6\uff0c\u4f4d\u6570\u53ea\u6709\u4e00\u4f4d\uff0c\u5f53n\u572810-99\u4e4b\u95f4\u65f6\uff0c\u4f4d\u6570\u5c31\u53d8\u6210\u4e86\u4e24\u4f4d\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff0c\u5148\u5f97\u5230\u5b83\u57fa\u672c\u7684\u9012\u63a8\u5f0f\uff1afi=fi-1\\*10+i\uff08\u5f53n\u57281-9\u4e4b\u95f4\uff09fi=fi-1\\*100+i\uff08\u5f53n\u572810-99\u4e4b\u95f4\uff09,\u56e0\u6b64\u6211\u4eec\u9700\u8981\u7528nd\u6765\u8bb0\u5f55n\u7684\u4f4d\u6570\uff0c\u7528k\u6765\u5f53\u505afi-1\u4e58\u7684\u90a3\u4e2a\u6570\u503c\u3002\u4f46\u662f\u7528\u57fa\u672c\u9012\u63a8\u5f0f\u80af\u5b9a\u4f1a\u8d85\u65f6\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u7528\u77e9\u9635\u4e58\u6cd5\u6765\u505a\u5230\u5feb\u901f\u5e42\u3002\u4e0d\u4f1a\u7684\u540c\u5b66\u53ef\u4ee5\u53bb\u770b\u4e0b\u5feb\u901f\u5e42\u548c\u77e9\u9635\u5feb\u901f\u5e42\u554a\uff08\u8fd9\u5176\u5b9e\u5c31\u662f\u80cc\u80cc\u6a21\u677f\u7684\u95ee\u9898\uff09\uff0c\u597d\u4e86\uff0c\u8bdd\u4e0d\u591a\u8bf4\uff0c\u4e0a\u4ee3\u7801\\*/\n\n/\\*\u5148\u4e0a\u7b2c\u4e00\u6b65\u77e9\u9635\u7528\u7684\u72b6\u6001\n\nS\uff08fi,i,1\uff09T\uff0810,0,0    S'(fi+1,i+1,1)\n\n1,1,0\n1,1,1\uff09\\*/\n\n```cpp\n#include<iostream>\nusing namespace std;\n#define ll long long\nll n,now=0,mod;\nstruct hand//\u672c\u4eba\u4e60\u60ef\u6765\u5b9a\u4e49\u8fd9\u6837\u7684\u7ed3\u6784\u4f53\n{\n    ll s[3][3];\n    hand()\n    {\n        for(int i=0;i<3;i++)\n        {\n            for(int j=0;j<3;j++)\n            {\n                s[i][j]=0;\n            }\n        }\n```\n}//\u5feb\u901f\u6e05\u96f6\u6570\u7ec4\n```cpp\n    hand(ll arr[3][3])\n    {\n        for(int i=0;i<3;i++)\n        {\n            for(int j=0;j<3;j++)\n            {\n                s[i][j]=arr[i][j];\n            }\n        }\n```\n}//\u5feb\u901f\u5bf9\u6570\u7ec4\u8d4b\u503c\n```cpp\n};\nhand operator *(hand A,hand B)//\u91cd\u8f7d\u4e58\u6cd5\u8fd0\u7b97\u7b26\uff0c\u56e0\u4e3a\u77e9\u9635\u4e58\u6cd5\u7684\u8fd0\u7b97\u89c4\u5f8b\u5e76\u4e0d\u540c\u4e8e\u666e\u901a\u7684\u6570\u4e0e\u6570\u4e4b\u95f4\u7684\u4e58\u6cd5\n{\n    hand ans;\n    for(int i=0;i<3;i++)\n        for(int j=0;j<3;j++)\n            for(int k=0;k<3;k++)\n                {\n                    ans.s[i][j]=(ans.s[i][j]+A.s[i][k]*B.s[k][j])%mod;\n                }\n    return ans;\n}\nint main()\n{\n    cin>>n>>mod;\n    hand S;\n    hand T;\n    S.s[0][1]=S.s[0][2]=1;\n    for(ll k=10;now<n;k*=10)\n    {\n        T.s[1][0]=T.s[1][1]=T.s[2][1]=T.s[2][2]=1;\n        T.s[0][1]=T.s[0][2]=T.s[1][2]=T.s[2][0]=0;\n        T.s[0][0]=k%mod;//\u8fd9\u91cc\u5bf9k\u53d6mod\u4e0d\u80fd\u4e22 \n        ll nd=min(k-1,n)-now;//\u6765\u8fd0\u884c\u6240\u6709\u7684\u5c0f\u4e8en\u7684\u4e00\u4f4d\u3001\u4e24\u4f4d\u6570\u00b7\u00b7\u00b7 \n        while(nd)\n        {\n            if(nd&1)S=S*T;\n            T=T*T;\n            nd>>=1;\n        }\n        now=min(k-1,n);//\u4ee5\u9632\u8d85\u8fc7n\u503c \n    }\n    printf(\"%d\",S.s[0][0]);\n    return 0;\n}\n```",
        "postTime": 1499988671,
        "uid": 47901,
        "name": "\u9f99\u795e\u54c8\u8fea\u65af",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3216 \u3010[HNOI2011]\u6570\u5b66\u4f5c\u4e1a\u3011"
    },
    {
        "content": "### \u7b80\u5355\u7684\u77e9\u9635\u9012\u63a8\u7ec3\u624b\u9898\n\u524d\u8a00\uff1a\u542c\u5b8c\u4e86\u77e9\u9635\u9012\u63a8\u7684\u7f51\u8bfe\u540e\u6211\u6253\u5f00\u4e86\u56e2\u961f\u7ec3\u4e60\u9898\u5355\uff0c\u53d1\u73b0\u81ea\u5df1\u5e76\u4e0d\u4f1a[\u77e9\u9635\u6e38\u620f](https://www.luogu.com.cn/problem/P1397)\u4e2d\u77e9\u9635\u6ee1\u8db3\u8d39\u9a6c\u5c0f\u5b9a\u7406\u7684\u8bc1\u660e\uff0c\u4e8e\u662f\u53ea\u597d\u6765\u5207\u8fd9\u9053\u9898\uff0c\u4f46\u4e8b\u5b9e\u4e0a\uff0c\u629b\u5f00\u7ec6\u8282\u5bf9\u4ee3\u7801\u6784\u7b51\u80fd\u529b\u7684\u8003\u9a8c\uff0c\u8fd9\u9053\u9898\u6bd4\u77e9\u9635\u6e38\u620f\u7b80\u5355\uff0c\u751a\u81f3\u53ef\u4ee5\u8bf4\u5728\u4f60\u660e\u767d\u8fd9\u662f\u9053\u77e9\u9635\u9012\u63a8\u7684\u9898\u540e\uff0c\u7b80\u76f4\u5c31\u662f\u6c34\u9898\u3002\\\n\u4e00\u5f00\u59cb\u5148\u4e0d\u60f3\u77e9\u9635\u9012\u63a8\uff0c\u4e0d\u96be\u63a8\u51fa\u516c\u5f0f\uff1a\n```\nlong long ans=0; \nfor(long long i=1;i<=n;i++)\n{\n\t//ws[i]\u662fi\u7684\u4f4d\u6570 \n\tans=ans*ws[i]+i;//\u4e0d\u6a21\u7684\u7b80\u6d01\u7248 \n\tans=(ans*ws[i]%mod+i)%mod;//\u53d6\u6a21\u7684\u7ec6\u8282\u7248 \n}\n \n```\n\n\u660e\u663e\u4f1a\u7206longlong\uff0c $n$ \u53ef\u662f\u5c0f\u4e8e\u7b49\u4e8e $10^{18}$ \u7684\u554a\u3002\\\n\u601d\u8003\u77e9\u9635\u9012\u63a8\uff0c\u53d1\u73b0\u5728\u77e9\u9635\u91cc\u9762\u641e\u4f4d\u6570\u8fd9\u73a9\u610f\u513f\u5b9e\u5c5e\u4e0d\u4f1a\uff0c\u770b\u770b $n$ \u7684\u8303\u56f4\uff0c\u60f3\u5230\u6309\u4f4d\u6570\u6765\u641e\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u603b\u5171\u505a $18$ \u6b21\uff0c\u8fd9\u6837\u5c31\u4e0d\u96be\u5904\u7406\u4f4d\u6570\u4e86\uff0c\u800c\u4e14\u4ee3\u7801\u8dd1\u7684\u6bd4\u9999\u6e2f\u8bb0\u8005\u8fd8\u5feb\u3002\n\u7136\u540e\u60f3\u51fa\u77e9\u9635\u5982\u4e0b\uff08\u4ee5\u4e0b\u4ee5\u4f4d\u6570\u4e3a $1$ \u65f6\u4e3a\u4f8b\u5b50\uff09\uff1a\n\n$\\begin{vmatrix}\n10 & 1 & 0 \\\\\n0 & 1 & 1 \\\\\n0 & 0 & 1\n\\end{vmatrix}$\n$\\times$\n$\\begin{vmatrix}\nsum[i-1] \\\\\ni \\\\\n1 \n\\end{vmatrix}$\n$=$\n$\\begin{vmatrix}\nsum[i]\\times10+i \\\\\ni+1 \\\\\n1\n\\end{vmatrix}$\n$=$\n$\\begin{vmatrix}\nsum[i] \\\\\ni+1 \\\\\n1 \n\\end{vmatrix}$\n\n\u53c8\u6bd4\u5982\u4f4d\u6570\u4e3a3\u65f6\uff1a\n\n$\\begin{vmatrix} \n1000 & 1 & 0 \\\\\n0 & 1 & 1 \\\\\n0 & 0 & 1 \n\\end{vmatrix}$ \n$\\times$\n$\\begin{vmatrix}\nsum[i-1] \\\\\ni \\\\\n1 \n\\end{vmatrix}$\n$=$\n$\\begin{vmatrix}sum[i]\\times 1000+i \\\\\ni+1 \\\\\n1 \n\\end{vmatrix}$\n$=$\n$\\begin{vmatrix}\nsum[i] \\\\\ni+1 \\\\\n1 \n\\end{vmatrix}$\n\n\u4e3e\u4e86\u4e24\u4e2a\u4f8b\u5b50\u540e\u601d\u8def\u5c31\u6e05\u6670\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u6c421\u523010\uff0c\u518d\u6c4210\u5230100\uff0c\u7136\u540e\u662f100\u52301000\u7b49\u7b49\u3002\n\n```\nstruct node\n{\n\tint x,y;//\u884c\u5217\u6570 \n\tint a[5][5];\n\tvoid empty()//\u6e05\u7a7a\u54e6 \n\t{\n\t\tx=y=0;\n\t\tfor(int i=0;i<=4;i++)\n\t\tfor(int j=0;j<=4;j++)\n\t\t{\n\t\t\ta[i][j]=0;\n\t\t}\n\t}\n\tvoid check()//\u9a8c\u9519\u7528\u7684\n\t{\n\t\tfor(int i=1;i<=x;i++)\n\t\t{\n\t\t\tfor(int j=1;j<=y;j++)\n\t\t\tprintf(\"%lld \",a[i][j]);\n\t\t\tprintf(\"\\n\");\n\t\t}\n\t}\n}q[20],p,p2;//q\u8868\u793a\u5bf9\u5e94\u4f4d\u6570\u4e0b\u4f7f\u7528\u76843X1\u521d\u59cb\u77e9\u9635,p\u662f\u7528\u6765\u7ef4\u62a4\u9012\u63a8\u5173\u7cfb\u7684\u67ff\u5b50\uff0cp\u662f\u5355\u4f4d\u77e9\u96350. \n/*\n\tq[1]\uff1a\n\t0\n\t1\n\t1\n\tq[2]\uff1a \n\t123456789\n\t10\n\t1 \n*/ \nvoid pre()//\u521d\u59cb\u5316 \n{\n\tint temp=1;\n\tfor(int i=1;i<=18;i++)\n\t{\n\t\tq[i].x=3,q[i].y=1;\n\t\tq[i].a[2][1]=temp;\n\t\ttemp=temp*10;\n\t\tq[i].a[3][1]=1;\n\t}\n\tp.x=p.y=p2.x=p2.y=3;\n\tp.a[1][1]=10;\n\tp.a[2][2]=p.a[1][2]=p.a[2][3]=p.a[3][3]=1;\n\tp2.a[1][1]=p2.a[2][2]=p2.a[3][3]=1;\n}\nvoid work(int now,int pre,int to)//\u73b0\u5728\u7684\u4f4d\u6570,\u4e0a\u4e00\u6b21\u8ba1\u7b97\u5230\u7684\u4f4d\u7f6e\uff0c\u8fd9\u4e00\u6b21\u8be5\u8ba1\u7b97\u5230\u7684\u4f4d\u7f6e \n{\n\t//q[now]\u662f\u9012\u63a8\u51fa\u6765\u76843X1\u77e9\u9635\uff0cp\u662f\u5de6\u8fb9\u7528\u4e8e\u9012\u63a8\u76843X3\u77e9\u9635 \n\tint temp=q[now-1].a[1][1];//\u7ee7\u627f \n\tq[now].a[1][1]=temp;\n\tif(now==ws_ans)//\u5982\u679c\u5f53\u524d\u4f4d\u6570\u548c\u7b54\u6848\u4e00\u81f4,\u53ef\u4ee5\u5408\u6cd5\u7684\u5230\u8fbe\u7b54\u6848\u4e86 \n\t{\n\t\tnode b=quickpow(p,n-pre);//\u77e9\u9635\u5feb\u901f\u5e42 \n\t\tq[now]=b*q[now];//\u8ba1\u7b97\u51fa\u6700\u7ec8\u7684\u77e9\u9635 \n\t\tprintf(\"%lld\",q[now].a[1][1]);\n\t\treturn;\n\t}\n\telse q[now]=quickpow(p,to-pre)*q[now];//\u76f4\u63a5\u6c42\u89e3\u4e0b\u4e00\u4e2a\u4f4d\u6570\u7684\u7b2c\u4e00\u4e2a\u77e9\u9635 \n\tp.a[1][1]=p.a[1][1]*10%mod;//\u6b64\u5904\u8bb0\u5f97\u53d6\u6a21 \n\twork(now+1,to,(to+1)*10-1);//\u9012\u5f52\u4e0b\u4e00\u4f4d\u6570 \n} \n```\n\u7136\u540e\u8fd8\u8981\u6ce8\u610f\u53d6\u6a21\u7684\u95ee\u9898\uff0c\u4e0d\u8981\u7206longlong\uff0c\u57fa\u672c\u4e0a\u81ea\u5df1\u624b\u6d4b\u51e0\u4e2a\u6837\u4f8b\u4e4b\u540e\u5c31\u80fd\u8fc7\u4e86\u3002\\\n\u9001\u4e00\u7ec4\u5927\u6837\u4f8b\uff0c\u8f93\u516519191145141919 415411 \uff0c\u8f93\u51fa246506\u3002\\\n\u539f\u4ee3\u7801\u5982\u4e0b\uff1a\uff08\u6709\u4e9b\u53d8\u91cf\u540d\u4e0e\u4e0a\u9762\u4e0d\u4e00\u6837\uff0c\u6ce8\u610f\u533a\u5206\uff09\n\n```\n#include<cstdio>\n#define int unsigned long long\nusing namespace std;\nint n,m,ws;\nstruct node\n{\n\tint x,y; \n\tint a[5][5];\n\tvoid empty()\n\t{\n\t\tx=y=0;\n\t\tfor(int i=0;i<=4;i++)\n\t\tfor(int j=0;j<=4;j++)\n\t\t{\n\t\t\ta[i][j]=0;\n\t\t}\n\t}\n\tvoid check()\n\t{\n\t\tfor(int i=1;i<=x;i++)\n\t\t{\n\t\t\tfor(int j=1;j<=y;j++)\n\t\t\tprintf(\"%lld \",a[i][j]);\n\t\t\tprintf(\"\\n\");\n\t\t}\n\t}\n}q[20],p,p2;\nvoid pre()\n{\n\tint temp=1;\n\tfor(int i=1;i<=18;i++)\n\t{\n\t\tq[i].x=3,q[i].y=1;\n\t\tq[i].a[2][1]=temp;\n\t\ttemp=temp*10;\n\t\tq[i].a[3][1]=1;\n\t}\n\tp.x=p.y=p2.x=p2.y=3;\n\tp.a[1][1]=10;\n\tp.a[2][2]=p.a[1][2]=p.a[2][3]=p.a[3][3]=1;\n\tp2.a[1][1]=p2.a[2][2]=p2.a[3][3]=1;\n}\nnode operator*(node a,node b)\n{\n\tnode o;\n\to.empty();\n\tint x=a.x;\n\tint y=a.y;\n\tint z=b.y;\n\tfor(int i=1;i<=x;i++)\n\tfor(int j=1;j<=y;j++)\n\tfor(int k=1;k<=z;k++)\n\t\to.a[i][k]=(o.a[i][k]+(a.a[i][j]%m)*(b.a[j][k]%m))%m;\n\to.x=x;\n\to.y=z;\n\treturn o;\n}\nnode quickpow(node a,int b)\n{\n\tnode ans=p2,temp=a;\n\twhile(b)\n\t{\n\t\tif(b&1)ans=ans*temp;\n\t\ttemp=temp*temp;\n\t\tb/=2;\n\t}\n\treturn ans;\n}\nvoid work(int now,int pre,int to)\n{\n\tint vra=q[now-1].a[1][1];\n\tq[now].a[1][1]=vra;\n\tif(now==ws)\n\t{\n\t\tnode b=quickpow(p,n-pre);\n\t\tq[now]=b*q[now];\n\t\tprintf(\"%lld\",q[now].a[1][1]);\n\t\treturn;\n\t}\n\telse q[now]=quickpow(p,to-pre)*q[now];\n\tp.a[1][1]=p.a[1][1]*10%m;\n\twork(now+1,to,(to+1)*10-1);\n} \nsigned main()\n{\n\tscanf(\"%lld%lld\",&n,&m);\n\tpre();\n\tint temp=n;\n\twhile(temp)\n\t{\n\t\ttemp/=10;\n\t\tws++;\n\t}\n\twork(1,0,9);\n}\n```\n\n\u64b0\u5199\u4e0d\u6613\uff0c\u6c42\u901a\u8fc7\u3002\n",
        "postTime": 1599733836,
        "uid": 246785,
        "name": "\u9614\u7761\u738b\u5b50",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P3216 \u3010[HNOI2011]\u6570\u5b66\u4f5c\u4e1a\u3011"
    },
    {
        "content": "## \u601d\u8def\uff1a\n\n### \u5176\u5b9e\u5f88\u5bb9\u6613\u53ef\u4ee5\u60f3\u5230\uff0c\u5f53\u6211\u4eec\u6240\u8981\u8fde\u63a5\u7684\u6570\u7684\u4f4d\u6570\u4e0d\u540c\u7684\u65f6\u5019\uff0c\u6211\u4eec\u9700\u8981\u628a\u539f\u6765\u7684\u6570\u589e\u5927\u7684\u500d\u6570\u662f\u4e0d\u4e00\u6837\u7684\u3002\n\n### \u6240\u4ee5\u6211\u4eec\u9700\u8981\u5206\u9636\u6bb5\u6765\u505a\u77e9\u4e58\u3002\n\n**\u6839\u636e\u6570\u7684\u4f4d\u6570\u5206\u4e3a$1->9;10->99\u2026\u2026\u202610^k->10^(k+1)-1$\u5c31\u53ef\u4ee5\u4e86\u3002 **\n\n**\u4f46\u662f\u6211\u4eec\u8fd8\u9700\u8981\u6ce8\u610f\u4e00\u4e2a\u95ee\u9898\uff0c\u5c31\u662f\u7531\u4e8e\u6211\u4eec\u6bcf\u4e2a\u9636\u6bb5\u5feb\u901f\u5e42\u7684\u77e9\u9635\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u6bcf\u4e2a\u9636\u6bb5\u505a\u5b8c\u4ee5\u540e\u6211\u4eec\u90fd\u9700\u8981\u8ddf\u65b0\u7b54\u6848\uff0c\u56e0\u4e3a\u77e9\u4e58\u6ca1\u6709\u5206\u914d\u7387\uff01**\n\n**\u8fd9\u6837\u4ee5\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u505a\u4e86\uff0c\u77e9\u9635\u662f\uff1a**\n\n![](https://img-blog.csdn.net/20150526072058040)\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\nlong long n,m,a[3][3],c[3][3],ans[3][3],aa[3],bb[3];\nlong long quickcheng(long long x,long long y)\n{\n    long long out=0;\n    x=x%m;y=y%m;\n    if(x>y) swap(x,y);\n    while(y)\n    {\n        if(y&1) out=(out+x)%m;\n        y>>=1;\n        x=(x+x)%m;\n    }\n    return out;\n}\nvoid mul(long long x,long long z)\n{\n    long long y=z-x/10+1,i,j,k;\n    bool f=true;\n    if(x==10) y-=1;\n    a[0][0]=x;\n    a[0][1]=a[1][1]=a[1][2]=a[2][2]=1;\n    a[0][2]=a[1][0]=a[2][0]=a[2][1]=0;\n    while(y)\n\t{\n        if(y&1)\n\t\t{\n            if(f)\n\t\t\t{\n                for(i=0;i<=2;++i)\n                  \tfor(j=0;j<=2;++j)\n                    \tans[i][j]=a[i][j];\n                f=false;\n            }\n            else\n\t\t\t{\n                for(i=0;i<=2;++i)\n                  \tfor(j=0;j<=2;++j)\n\t\t\t\t\t{\n                    \tc[i][j]=0;\n                    \tfor(k=0;k<=2;++k)\n                      \t\tc[i][j]=(c[i][j]+quickcheng(a[i][k],ans[k][j]))%m;\n                  \t}\n                for(i=0;i<=2;++i)\n                  \tfor(j=0;j<=2;++j)\n                    \tans[i][j]=c[i][j];\n            }\n        }\n        y>>=1;\n        for(i=0;i<=2;++i)\n          \tfor(j=0;j<=2;++j)\n\t\t\t{\n            \tc[i][j]=0;\n            \tfor(k=0;k<=2;++k)\n              \t\tc[i][j]=(c[i][j]+quickcheng(a[i][k],a[k][j]))%m;\n          \t}\n        for(i=0;i<=2;++i)\n          \tfor(j=0;j<=2;++j)\n            \ta[i][j]=c[i][j];\n    }\n    for(i=0;i<=2;++i)\n\t{\n        bb[i]=0;\n        for(j=0;j<=2;++j)\n\t\t{\n            bb[i]=(bb[i]+quickcheng(ans[i][j],aa[j]))%m;\n        }\n   \t}\n   \tfor(i=0;i<=2;++i)\n     \taa[i]=bb[i];\n}\nint main()\n{\n    long long t=10;\n    scanf(\"%d%d\",&n,&m);\n    aa[0]=1;aa[1]=2;aa[2]=1;\n    while(n>=t)\n\t{\n        mul(t,t-1);\n        t*=10;\n    }\n    mul(t,n);\n    printf(\"%d\\n\",aa[0]);\n}\n```\n**PS\uff1a\u56e0\u4e3a\u6015\u6709\u4eba\u6284\u88ad\u6211\u505a\u4e86\u4e00\u70b9\u70b9\u6539\u52a8~QWQ~**",
        "postTime": 1542805393,
        "uid": 98954,
        "name": "\u4e0d\u5b58\u5728\u4e4b\u4eba",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3216 \u3010[HNOI2011]\u6570\u5b66\u4f5c\u4e1a\u3011"
    },
    {
        "content": "/\\*\nluogu P3216 [HNOI2011]\u6570\u5b66\u4f5c\u4e1a\n\n    \n\u6b64\u9898\u7684\u9012\u63a8\u5f0f\u5f88\u663e\u7136\u3002\u3002\u3002\n\n    \n    \n    f(n) = len (n) \\* 10 \\* f (n - 1) + n;\n\n\u53d8\u4e3a\u77e9\u9635\u5219\u4e3a\n\n    \n        f(n)     len(n)\\*10   1  1   f(n-1)\n\n          n   =       0          1  1     n-1\n\n1            0          1  1      1\n\n        \n\u90a3\u4e48\u5c31\u77e9\u4e58\u641e\u4e00\u641e\u5c31\u597d\n\n\u5bf9\u4e8elen(n)\u6bcf\u6b21\u5219\u6bcf\u6b21\u5206\u5f00\u4e58\u8fdb\u53bb\u5c31\u884c\n\n\\*/\n```cpp\n#include <cstdio>\n#include <cstring>\n\n\nvoid read (long long &now)\n{\n    register char word = getchar ();\n    for (now = 0; word < '0' || word > '9'; word = getchar ());\n    for (; word >= '0' && word <= '9'; now = now * 10 + word - '0', word = getchar ());\n}\n\nlong long N;\nlong long Mod;\n\nstruct Martix\n{\n    \n    static const int _L = 3;\n    long long data[_L][_L];\n    \n    inline void Fill ()\n    {\n        memset (this->data, 0, sizeof this->data);\n        this->data[1][0] = this->data[2][0] = 1;\n        this->data[1][1] = this->data[2][1] = 1;\n        this->data[2][2] = 1;\n    }\n    \n    Martix operator * (const Martix &now) const\n    {\n        Martix res;\n        \n        for (register int i = 0, j, k; i < _L; i ++)\n            for (j = 0; j < _L; j ++)\n            {\n                res.data[i][j] = 0;\n                for (k = 0; k < _L; k ++)\n                    res.data[i][j] = (res.data[i][j] + this->data[i][k] * now.data[k][j]) % Mod;\n            }\n        return res;\n    }\n};\n\nMartix operator ^ (Martix now, long long P)\n{\n    Martix res;\n    for (register int i = 0, j; i < Martix :: _L; i ++)\n        for (j = 0; j < Martix :: _L; j ++)\n            res.data[i][j] = (i == j);\n    for (; P; P >>= 1)\n    {\n        if (P & 1)\n            res = res * now;\n        now = now * now;\n    }\n    return res;\n}\n\nMartix Answer;\n\ninline void Solve (long long t, long long P)\n{\n    Martix res;\n    res.Fill ();\n    res.data[0][0] = t % Mod;\n    Answer = Answer * (res ^ (P - t / 10 + 1));\n}\n\nint main (int argc, char *argv[])\n{\n    read (N);\n    read (Mod);\n    \n    for (int i = 0; i < Martix :: _L; i ++)\n        Answer.data[i][i] = 1;\n    long long T = 10;\n    for (; N >= T; Solve (T, T - 1), T *= 10);\n    \n    Solve (T, N);\n    printf (\"%lld\", Answer.data[2][0]);\n    return 0;\n}\n```",
        "postTime": 1502283606,
        "uid": 21123,
        "name": "ZlycerQan",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3216 \u3010[HNOI2011]\u6570\u5b66\u4f5c\u4e1a\u3011"
    }
]
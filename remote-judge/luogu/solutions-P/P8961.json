[
    {
        "content": "# ggcd \u9898\u89e3\n\n## Solution\n\n\u8fd9\u91cc\u7ed9\u51fa\u4e00\u79cd\u6b63\u786e\u6027\u4fdd\u8bc1\u5e76\u4e14\u4e25\u683c $O(n\\log m+\\sqrt m)$ \u7684\u505a\u6cd5\u3002\n\n\u8bbe $\\gcd(x_1,x_2,\\cdots,x_n)=g$\u3002\n\n\u53ef\u4ee5\u5f97\u5230 $\\gcd(y_i,m)\\mid g$\u3002\n\n\u6240\u4ee5 $\\gcd(y_1,y_2,\\cdots ,y_n,m)\\mid g$\u3002\n\n\u6240\u4ee5 $g\\bmod m=m-\\gcd(y_1,y_2,\\cdots,y_n,m)$ \u4e3a\u53ef\u80fd\u6700\u5927\u3002\n\n\u9996\u5148\uff0c\u5f53 $n=1$ \u65f6\uff0c\u7b54\u6848\u53ea\u80fd\u662f $y_1$ \u6216\u662f $m-y_1$\u3002\n\n\u63a5\u4e0b\u6765\u8ba8\u8bba $n\\ge 2$ \u7684\u60c5\u51b5\u3002\n\n\u4e0d\u59a8\u8ba9 $\\gcd(y_1,\\cdots,y_n,m)=1$\uff0c\u4e0b\u9762\u8bc1\u660e\u7b54\u6848\u53ef\u4ee5\u53d6\u5230 $m-1$\u3002\n\n\u8981\u53d6\u5230\uff0c\u5fc5\u987b\u8981 $(m-1)\\mid x_i$\uff0c\u6240\u4ee5 $x_i$ \u53ef\u4ee5\u8868\u793a\u4e3a $(m-1)(k_im-y_i)$ \u7684\u5f62\u5f0f\uff0c$k_i\\in\\mathbb Z$\u3002\u4e0d\u59a8\u8ba9\u5bf9\u4e8e $2\\le i\\le n$\uff0c$k_i=0$\u3002\n\n\u90a3\u4e48\u7b54\u6848\u4e3a $\\gcd((m-1)(k_1m-y_1),-(m-1)y_2,\\cdots,-(m-1)y_n)=(m-1)\\gcd(k_1m-y_1,y_2,\\cdots,y_n)$\u3002\n\n\u90a3\u4e48\u95ee\u9898\u5c31\u8f6c\u5316\u6210\u4e86\u627e\u5230\u4e00\u4e2a $k_1$\uff0c\u4f7f\u5f97 $\\gcd(k_1m-y_1,y_2,\\cdots,y_n)=1$\u3002\u4e0d\u59a8\u8ba9 $\\gcd(y_2,\\cdots,y_n)\\ne0$\u3002\n\n\u4e0d\u59a8\u8bb0 $\\gcd(y_2,\\cdots,y_n)=d$\u3002\u6b64\u65f6\u5373\u627e\u5230\u4e00\u4e2a $k_1$\uff0c\u4f7f\u5f97 $\\gcd(k_1m-y_1,d)=1$\u3002\u800c\u53c8\u6709\u6761\u4ef6 $\\gcd(y_1,m,d)=1$\u3002\n\n\u8bbe $f=\\gcd(m,y_1)$\uff0c\u90a3\u4e48 $\\gcd(f\\cdot(\\frac{m}{f}\\cdot k_1-\\frac{y_1}f),d)=1$\uff0c\u5219 $\\gcd(\\frac mf\\cdot k_1-\\frac{y_1}f,d)=1$\u3002\n\n\u8003\u8651 $d$ \u7684\u6240\u6709\u8d28\u56e0\u5b50 $p$\uff1a\n\n\u5982\u679c $p\\mid \\frac mf$\uff0c\u5219 $p\\nmid\\frac{y_1}f$\uff0c\u90a3\u4e48\u4e00\u5b9a\u6709 $p\\nmid(\\frac mf\\cdot k_1-\\frac{y_1}f)$\u3002\n\n\u5982\u679c $p\\mid\\frac{y_1}f$\uff0c\u5219 $p\\nmid\\frac mf$\uff0c\u5219 $p\\nmid k_1$ \u5373\u53ef\u4fdd\u8bc1 $p\\nmid(\\frac mf\\cdot k_1-\\frac{y_1}f)$\u3002\n\n\u5982\u679c $p\\nmid\\frac mf$ \u4e14 $p\\nmid\\frac{y_1}f$\uff0c\u5219 $p\\mid k_1$ \u4e00\u5b9a\u53ef\u4ee5\u4fdd\u8bc1 $p\\nmid(\\frac mf\\cdot k_1-\\frac{y_1}f)$\u3002\n\n\u6240\u4ee5\u6784\u9020\u51fa $k_1=\\prod\\limits_{p\\mid d,p\\nmid\\frac mf,p\\nmid\\frac{y_1}f}p$ \u5373\u53ef\u3002\n\n\u6b64\u65f6 $k_1\\le d<m$\uff0c\u90a3\u4e48 $k_1m-y_1\\le m^2-m$\uff0c\u6240\u4ee5 $x_1\\le m^3-2m^2+m$\uff0c\u53ef\u4ee5\u63a7\u5236\u5728 `__int128` \u8303\u56f4\u5185\u3002\n\n## Code\n\n```cpp\n#include <iostream>\n#include <algorithm>\n\nint n;\n__int128 m;\n__int128 y[1000007];\n__int128 x[1000007];\n__int128 read() {\n  char c = getchar();\n  __int128 x = 0;\n  bool f = 0;\n  for (; !isdigit(c); c = getchar()) f ^= !(c ^ 45);\n  for (; isdigit(c); c = getchar()) x = (x << 1) + (x << 3) + (c ^ 48);\n  if (f) x = -x;\n  return x;\n}\nvoid write(__int128 x, char c = '\\0') {\n  if (x < 0) putchar('-'), x = -x;\n  if (x > 9) write(x / 10);\n  putchar(x % 10 + '0');\n  if (c != '\\0') putchar(c);\n}\nint main() {\n  n = read(), m = read();\n  if (n == 1) {\n    y[1] = read();\n    if (m - y[1] > y[1] && y[1]) {\n      write(m - y[1], '\\n'), write(y[1] - m, '\\n');\n    } else {\n      write(y[1], '\\n'), write(y[1], '\\n');\n    }\n    return 0;\n  }\n  __int128 g = m;\n  int f1 = -1;\n  for (int i = 1; i <= n; ++i) {\n    y[i] = read();\n    if (y[i]) {\n      if (f1 == -1) {\n        f1 = i;\n      }\n    }\n    g = std::__gcd(g, y[i]);\n  }\n  write(m - g, '\\n');\n  m /= g;\n  if (f1 == -1) {\n    for (int i = 1; i <= n; ++i) {\n      write(0, ' ');\n    }\n    return 0;\n  }\n  int one = -1;\n  for (int i = 1; i <= n; ++i) {\n    if (i != f1) {\n      one = i;\n      break;\n    }\n  }\n  __int128 d = 0;\n  for (int i = 1; i <= n; ++i) {\n    y[i] /= g;\n    if (i != one) d = std::__gcd(d, y[i]);\n    x[i] = y[i] * (1 - m);\n  }\n  __int128 f = std::__gcd(m, y[one]);\n  __int128 k1 = 1;\n  auto check = [&](int p) {\n    bool p1 = (m / f) % p == 0;\n    bool p2 = (y[one] / f) % p == 0;\n    if (!p1 && !p2) k1 *= p;\n  };\n  for (int i = 2; i * i <= d; ++i) {\n    if (d % i == 0) {\n      check(i);\n      while (d % i == 0) d /= i;\n    }\n  }\n  if (d != 1) check(d);\n  x[one] = (k1 * m - y[one]) * (m - 1);\n  for (int i = 1; i <= n; ++i) {\n    write(x[i] * g, ' ');\n  }\n  return 0;\n}\n```\n\n\u5b9e\u9645\u4e0a\uff0c\u66b4\u529b\u6c42\u89e3\u662f\u53ef\u80fd\u7684\u3002",
        "postTime": 1669906218,
        "uid": 306090,
        "name": "0x3b800001",
        "ccfLevel": 5,
        "title": "ggcd \u9898\u89e3"
    }
]
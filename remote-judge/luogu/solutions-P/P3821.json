[
    {
        "content": "~~\u8bdd\u8bf4\u6211\u521a\u5f00\u59cb\u5199\u65f6\u8fd8\u662f\u7d2b\u9898\u600e\u4e48\u5199\u5230\u4e00\u534a\u5c31\u9ed1\u4e86~~\n\n\u8a00\u5f52\u6b63\u4f20\uff0c\u8bbe$f[t][i][j]$\u4e3a$t$\u65f6\u523b\u4ece$i$\u5230$j$\u7684\u8def\u5f84\u4e2d\u6700\u957f\u8fb9\u7684\u6700\u5c0f\u503c\uff0c$l[i][j]$\u8868\u793a\u623f\u95f4$i$\u5230\u623f\u95f4$j$\u7684\u901a\u9053\u957f\u5ea6\uff08\u4e4b\u95f4\u6ca1\u6709\u901a\u9053\u5c31\u7b97\u4f5c\u65e0\u9650\u5927\uff09\n\n\u53ef\u4ee5\u5f97\u5230\u9012\u63a8\u5f0f$f[t][i][j]=min(max(f[t-1][i][u],l[u][j])|1<=u<=n)$\uff0c\u7279\u522b\u7684\uff0c$f[1][i][j]=l[i][j]$\uff0c$f[k][s][t]$\u5373\u4e3a\u7b54\u6848\n\n\u56e0\u4e3a\u6ee1\u8db3\u7ed3\u5408\u5f8b\uff0c\u6240\u4ee5\u7528\u77e9\u9635\u6765\u4f18\u5316\n\n\u81f3\u4e8e\u602a\u7269\u7684\u60c5\u51b5\u53ef\u4ee5\u7528\u548c[\u8fd9\u9898](https://www.luogu.org/problem/P2579)\u7c7b\u4f3c\u7684\u65b9\u6cd5\u5904\u7406\uff0c\u628a12\u4e2a\u65f6\u523b\u4f5c\u4e3a\u4e00\u4e2a\u8f6e\u56de\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u65f6\u523b\u5efa\u7acb\u4e00\u4e2a\u90bb\u63a5\u77e9\u9635$bzjx$\uff0c\u82e5$T(1<=T<=12)$\u65f6\u523b\u623f\u95f4$j$\u6709\u602a\u7269\uff0c\u5219$bzjx[T][i][j]=$\u65e0\u9650\u5927\uff0c\u5e76\u8ba1\u7b97\u524d$T$\u4e2a$bzjx$\u8fd0\u7b97\u7684\u7ed3\u679c\uff0c\u7528$jx[T]$\u50a8\u5b58\n\n\u8bbe$k=p*12+q$\uff0c\u8ba1\u7b97${(jx[12])}^{p}*jx[q]$($p$\u4e3a0\u5219$jx[q]\u5373\u4e3a\u7b54\u6848$\uff0c$q$\u4e3a0\u5219\u76f4\u63a5\u8ba1\u7b97${(jx[12])}^{p}$)\n\n\u6ce8\u610f\u4e0d\u5b58\u5728\u8def\u5f84\u65f6\u8f93\u51fa'IMP0SSBLE!!'\uff08\u8981\u8f93\u51fa\u5f15\u53f7\u4e14\u4e2d\u95f4O\u4e3a0\uff09\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u5927\u6982$O(n^{3}logk)$~~(\u53cd\u6b63\u80fd\u8fc7\u7ba1\u90a3\u4e48\u591a\u5e72\u561b)~~\n\n\u4ee3\u7801\u5c31\u51d1\u5408\u7740\u770b\u5427\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=50;\nconst int M=12;\nconst long long oo=2e10;\nlong long bzjx[M+1][N+1][N+1],jx[M+1][N+1][N+1];\nlong long ans[N+1][N+1],b[N+1][N+1],l[N+1][N+1],ll[N+1][N+1];\nint n,m,s,t,k,a;\nvoid POW(int x)//\u77e9\u9635\n{\n\tif(x==1){memcpy(b,jx[M],sizeof(jx[M]));return;}\n\tPOW(x>>1);\n\tmemcpy(l,b,sizeof(b));\n\tfor(int i=1;i<=n;i++)\n\t  for(int j=1;j<=n;j++)\n\t    b[i][j]=oo;\n\tif(x&1)\n\t{\n\t\tfor(int i=1;i<=n;i++)\n\t\t  for(int j=1;j<=n;j++)\n\t\t    ll[i][j]=oo;\n\t\tfor(int i=1;i<=n;i++)\n\t\t  for(int j=1;j<=n;j++)\n\t\t    for(int p=1;p<=n;p++)\n\t\t      ll[i][j]=min(ll[i][j],max(l[i][p],l[p][j]));\n\t\tfor(int i=1;i<=n;i++)\n\t\t  for(int j=1;j<=n;j++)\n\t\t    for(int p=1;p<=n;p++)\n\t\t      b[i][j]=min(b[i][j],max(ll[i][p],jx[M][p][j]));\n\t}\n\telse\n\t{\n\t\tfor(int i=1;i<=n;i++)\n\t\t  for(int j=1;j<=n;j++)\n\t\t    for(int p=1;p<=n;p++)\n\t\t      b[i][j]=min(b[i][j],max(l[i][p],l[p][j]));\n\t}\n}\nint main()\n{\n\tscanf(\"%d%d%d%d%d\",&n,&m,&s,&t,&k);\n\tfor(int i=1;i<=M;i++)\n\t  for(int j=1;j<=n;j++)\n\t    for(int p=1;p<=n;p++)\n\t      jx[i][j][p]=bzjx[i][j][p]=oo;\n\twhile(m--)//\u521d\u59cb\u5316\u77e9\u9635\n\t{\n\t\tint u,v,w;\n\t\tscanf(\"%d%d%d\",&u,&v,&w);\n\t\tfor(int i=1;i<=M;i++)bzjx[i][u][v]=bzjx[i][v][u]=(long long)w;\n\t}\n\tscanf(\"%d\",&a);\n\twhile(a--)//\u5904\u7406\u6709\u602a\u7269\u7684\u60c5\u51b5\n\t{\n\t\tint T;\n\t\tscanf(\"%d\",&T);\n\t\tint ro[4];\n\t\tfor(int i=0;i<T;i++)scanf(\"%d\",ro+i);\n\t\tfor(int i=1;i<=M;i++)\n\t\t  for(int j=1;j<=n;j++)\n\t\t    bzjx[i][j][ro[i%T]]=oo;\n\t}\n\tmemcpy(jx[1],bzjx[1],sizeof(bzjx[1]));\n\tfor(int i=2;i<=M;i++)\n\t  for(int j=1;j<=n;j++)\n\t    for(int p=1;p<=n;p++)\n\t      for(int l=1;l<=n;l++)\n\t        jx[i][j][p]=min(jx[i][j][p],max(jx[i-1][j][l],bzjx[i][l][p]));\n\tif(k/M)\n\t{\n\t\tPOW(k/M);\n\t\tint r=k%M;\n\t\tif(r)\n\t\t{\n\t\t\tfor(int i=1;i<=n;i++)\n\t\t\t  for(int j=1;j<=n;j++)\n\t\t\t    ans[i][j]=oo;\n\t\t\tfor(int i=1;i<=n;i++)\n\t\t\t  for(int j=1;j<=n;j++)\n\t\t\t    for(int p=1;p<=n;p++)\n\t\t\t\t  ans[i][j]=min(ans[i][j],max(b[i][p],jx[r][p][j]));\n\t\t}//\u6709\u4f59\u6570\uff0c\u6240\u5f97\u7ed3\u679c\u518d\u548cjx[r]\u8fdb\u884c\u8fd0\u7b97\u5f97\u5230\u7b54\u6848\n\t\telse memcpy(ans,b,sizeof(b));//\u521a\u597d\u9664\u5c3d\uff0c\u5c06\u77e9\u9635\u5feb\u901f\u51a5\u540e\u7684\u7ed3\u679c\u76f4\u63a5\u590d\u5236\n\t}\n\telse memcpy(ans,jx[k],sizeof(jx[k]));//\u4e0d\u8db312\uff0c\u76f4\u63a5\u590d\u5236\n\tif(ans[s][t]==oo)printf(\"'IMP0SSBLE!!'\");\n\telse printf(\"%lld\",ans[s][t]);\n}\n```\n\u53ef\u80fd\u8bb2\u7684\u4e0d\u662f\u5f88\u6e05\u695a\u8bf7\u89c1\u8c05\uff0c\u6bd5\u7adf\u849f\u84bb\u8bed\u6587\u4e0d\u597d",
        "postTime": 1564383968,
        "uid": 104581,
        "name": "kkk\u7684\u5c0f\u8214\u72d7",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3821 \u3010Isaac\u3011"
    },
    {
        "content": " _**\u5173\u952e\u8bcd\uff1a\u4e8c\u5206\u7b54\u6848\uff0c\u77e9\u9635\u5feb\u901f\u5e42**_ \n\n# \u8fd9\u662f\u4e00\u9053\u6bd4\u8f83\u5957\u8def\u7684\u9898\u76ee\n\u5982\u679c\u60f3\u66f4\u5bb9\u6613\u7406\u89e3\u8fd9\u9898\uff0c\u53ef\u4ee5\u5148\u53bb\u770b [P1948 Telephone Lines](https://www.luogu.org/problem/P1948) \u548c [P2579 \u6cbc\u6cfd\u9cc4\u9c7c](https://www.luogu.org/problem/P2579) \u4e24\u9053\u9898\n\n\u7136\u540e\u4f60\u5c31\u4f1a\u53d1\u73b0\uff1a\n\n~~\u628a\u4e0a\u9762\u4e24\u9898\u52a0\u8d77\u6765\u5c31\u597d\u4e86~~\n\n## \u5177\u4f53\u5b9e\u73b0\uff1a\n\n1. \u4e8c\u5206\u5176\u8840\u91cf\uff0c\u5c06 \u8fb9\u6743\u2264\u8840\u91cf \u7684\u8fb9\u8bbe\u4e3a1\uff0c\u5176\u4ed6\u8bbe\u4e3a0\uff0c\u5f97\u5230\u4e00\u4e2a\u90bb\u63a5\u77e9\u9635\uff1b\n\n2. \u5efa\u5b8c\u90bb\u63a5\u77e9\u9635\u540e\uff0c\u53ef\u4ee5\u60f3\u5230\u901a\u8fc7\u77e9\u9635\u5feb\u901f\u5e42\u6c42\u51fa\u56fa\u5b9a\u6b65\u6570\u80fd\u5230\u8fbe\u7684\u70b9\n\n3. \u5982\u679c\u53ef\u4ee5\u5230\u8fbe\uff0c\u8fd9\u8bf4\u660e\u662f\u53ef\u4ee5\u5728\u5f53\u524d\u8840\u91cf\u4e0b\u4ece\u8d77\u70b9\u5230\u8fbe\u7ec8\u70b9\u7684\uff0c\u5426\u5219\u4e0d\u80fd\uff0c\u66f4\u65b0\u5de6\u53f3\u7aef\u70b9\u3002\n\n\uff08\u53c2\u8003\u56fd\u5bb6\u96c6\u8bad\u961f\u8bba\u6587\uff1a\u4fde\u534e\u7a0b\u300a\u77e9\u9635\u4e58\u6cd5\u5728\u4fe1\u606f\u5b66\u4e2d\u7684\u5e94\u7528\u300b\uff09\n\n### BUT\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff01\n\n\u602a\u7269\u7684\u4f4d\u7f6e\u4f1a\u968f\u65f6\u95f4\u53d8\u5316\uff0c\u5bfc\u81f4\u4e0d\u540c\u65f6\u95f4\u7684\u77e9\u9635\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u90a3\u4e48\u77e9\u9635\u5feb\u901f\u5e42\u5c31\u65e0\u6cd5\u76f4\u63a5\u4f7f\u7528\u3002\n\n\u6b64\u65f6\u6211\u4eec\u53d1\u73b0\uff0c\u602a\u7269\u7684\u5468\u671fT\u57282\u52304\u4e4b\u95f4\uff0c\u7531\u6b64\u53ef\u4ee5\u770b\u51fa\u2026\u2026\n\n\u5bf9\u4e8e\u5468\u671f\u4e3a2\u7684\u602a\u7269\uff0c2\u5355\u4f4d\u4e4b\u95f4\u540e\u5c06\u91cd\u65b0\u56de\u5230\u539f\u6837\uff1b\n\n\u5bf9\u4e8e\u5468\u671f\u4e3a3\u7684\u602a\u7269\uff0c3\u5355\u4f4d\u4e4b\u95f4\u540e\u5c06\u91cd\u65b0\u56de\u5230\u539f\u6837\uff1b\n\n\u5bf9\u4e8e\u5468\u671f\u4e3a4\u7684\u602a\u7269\uff0c4\u5355\u4f4d\u4e4b\u95f4\u540e\u5c06\u91cd\u65b0\u56de\u5230\u539f\u6837\uff1b\n\n~~\u8fd9\u4e0d\u5e9f\u8bdd\u5417~~\n\n#### **\u91cd\u70b9\u5728\u4e0b\u9762\uff01**\n\n\u5728 lcm(2,3,4)=12 \u5355\u4f4d\u65f6\u95f4\u540e\uff0c\u90bb\u63a5\u77e9\u9635\u5c06\u56de\u5230\u539f\u6837\uff01\uff01\uff01\n\n~~\u55b5\u554a\u55b5~~\n\n\u56e0\u6b64\uff1a\n\n- \u5904\u7406\u51fa \n`tmp = map[1] * map[2] * map[3] * \u2026\u2026 * map[11] * map[0] `\n\u8fd9\u4e2a\u91cd\u590d\u51fa\u73b0\u7684\u77e9\u9635\n\n(**\u6ce8\u610f\uff1a\u77e9\u9635\u4e58\u6cd5\u4e0d\u6ee1\u8db3\u4ea4\u6362\u5f8b\uff0c\u6240\u4ee5\u4e0d\u80fd\u6539\u53d8\u987a\u5e8f\uff01**)\n\n- \u6c42\u51fatmp^(k / 12) \u7684\u503c\uff0c\u5c06\u4f59\u4e0b\u7684map[1] ~ map[(k % 12)]\n\u4e58\u4e0a\u53bb\uff0c\u5c31\u5f97\u5230\u4e86\u6700\u7ec8\u7b54\u6848\uff01\n\n\u5b8c\u4e86\uff1f\u5b8c\u4e86\u3002\n\n## \u65f6\u7a7a\u590d\u6742\u5ea6\u5206\u6790\uff1a\n\n\u4e8c\u5206\u7b54\u6848\uff1alog(W) \u867d\u7136\u6ca1\u6709\u8fb9\u6743\u7684\u8303\u56f4\uff0c\u4f46\u662f\u56e0\u4e3a\u4e00\u5b9a\u5728int\u4e4b\u5185\uff0c\u6240\u4ee5\u8fd9\u4e0d\u6210\u95ee\u9898:-D\n\n\u77e9\u9635\u4e58\u6cd5\uff1an^3 \n\n\u77e9\u9635\u5feb\u901f\u5e42\uff1alog(k)\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u603b\u548c\uff1aO(n^3 * log(K) * log(W)),\u8dd1\u5f97\u98de\u5feb\n\n\u7a7a\u95f4\u590d\u6742\u5ea6\uff1aO(n^2) ~~\u5c31\u662f\u4e2a\u77e9\u9635\u561b~~\n\n### \uff08\u4f2a\uff09\u603b\u7ed3\uff1a\n\u5c31\u8fd9\u6837\uff0c\u8fd9\u9053\u9898\u5c31\u88ab\u5207\u4e86\u2026\u2026\u5417\uff1f\n\n# \u8bf7\u6ce8\u610f\uff01\u8bf7\u6ce8\u610f\uff01\u8bf7\u6ce8\u610f\uff01\n\n~~\u672c\u9898\u6700\u96be\u7684\u5730\u65b9~~\n\n1.\u65e0\u89e3\u65f6\uff0c\u8f93\u51fa\u7684\u662fIMP **0** SSBLE \u800c\u975e IMP **O** SSBLE\n\n2.IMP0SSIBLE\u4e24\u8fb9\u7684 **\u611f\u53f9\u53f7 \u548c \u5355\u5f15\u53f7 \u90fd\u4e0d\u80fd\u53bb\u6389\uff01\uff01\uff01**\n\n~~\uff08\u6211\u5c31\u8fd9\u6837\u88ab\u5751\u4e86\uff09~~\n\n\u6700\u540e\uff0c\u4e0a\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\nlong long n, m, s, e, k, nfish;\n\nstruct mat\n{\n\tlong long a[51][51]; //\u90bb\u63a5\u77e9\u9635\n\tvoid unit() //\u6784\u9020\u5355\u4f4d\u77e9\u9635\n\t{\n\t\tmemset(a, 0, sizeof(a));\n\t\tfor (long long i = 1; i <= n; i++) a[i][i] = 1;\n\t}\n\tmat operator *(const mat &b) const //\u77e9\u9635\u4e58\u6cd5\n\t{\n\t\tmat c; memset(c.a, 0, sizeof(c.a));\n\t\tfor (long long i = 1; i <= n; i++)\n\t\t\tfor (long long k = 1; k <= n; k++)\n\t\t\t\tfor (long long j = 1; j <= n; j++)\n\t\t\t\t\tc.a[i][j] |= a[i][k] & b.a[k][j];//\u53ea\u9700\u77e5\u9053\u4e24\u70b9\u4e4b\u95f4\u662f\u5426\u8054\u901a\uff0c\u56e0\u6b64\u4f7f\u7528\u4f4d\u8fd0\u7b97\n\t\treturn c;\n\t}\n\tmat operator ^(const long long &b) const //\u77e9\u9635\u5feb\u901f\u5e42\n\t{\n\t\tmat t, res;\n\t\tres.unit();\n\t\tt = *this;\n\t\tlong long qwq = b;\n\t\twhile (qwq)\n\t\t{\n\t\t\tif (qwq & 1) res = res * t;\n\t\t\tt = t * t;\n\t\t\tqwq >>= 1;\n\t\t}\n\t\treturn res;\n\t}\n} tmp, ans, qaq[12], mp;\n\nsigned main()\n{\n\tscanf(\"%lld%lld%lld%lld%lld\", &n, &m, &s, &e, &k);\n\tfor (long long i = 1; i <= m; i++)\n\t{\n\t\tlong long x, y, z;\n\t\tscanf(\"%lld%lld%lld\", &x, &y, &z);\n\t\tmp.a[x][y] = mp.a[y][x] = z;\n\t}\n\tfor (long long i = 0; i < 12; i++) qaq[i] = mp;\n\tscanf(\"%lld\", &nfish);\n\tfor (long long i = 1; i <= nfish; i++)\n\t{\n\t\tlong long t;\n\t\tscanf(\"%lld\", &t);\n\t\tfor (long long j = 0; j < t; j++)\n\t\t{\n\t\t\tlong long x;\n\t\t\tscanf(\"%lld\", &x);\n\t\t\tfor (long long k = j; k < 12; k += t)\n\t\t\t\tfor (long long o = 1; o <= n; o++)\n\t\t\t\t\tqaq[k].a[o][x] = 0; //\u5f97\u51fa\u5728\u602a\u7269\u5f71\u54cd\u4e0b\u7684\u56fe\n\t\t}\n\t}\t\n\tlong long l = -1, r = 1ll << 60;\n\twhile (l + 1 < r) //\u4e8c\u5206\u7b54\u6848\n\t{\n\t\tlong long mid = (l + r) >> 1;\n\t\ttmp.unit();\n\t\tmat ouo[12]; \n\t\tfor (long long i = 0; i <= 11; i++) ouo[i] = qaq[i];\n\t\tfor (long long i = 0; i < 12; i++)\n\t\t\tfor (long long j = 1; j <= n; j++)\n\t\t\t \tfor (long long l = 1; l <= n; l++) if (ouo[i].a[j][l]) ouo[i].a[j][l] = ouo[i].a[j][l] <= mid;\n\t\tfor (long long i = 1; i < 12; i++) tmp = tmp * ouo[i];//12\u4e2a\u5355\u4f4d\u65f6\u95f4\u4e3a\u4e00\u7ec4\uff0c\u5904\u7406tmp\n\t\ttmp = tmp * ouo[0];\n\t\tlong long cnt = (k / 12);\n\t\tans.unit();\n\t\tans = ans * (tmp ^ cnt);\n\t\tfor (long long i = 1; i <= k % 12; i++) ans = ans * ouo[i];//\u5c06\u4f59\u4e0b\u7684\u4e5f\u4e58\u4e0a\u53bb\n\t\tif (ans.a[s][e]) r = mid; else l = mid; //\u5224\u65ad\u662f\u5426\u80fd\u591f\u5230\u8fbe\n\t}\n\tif (l > 1ll << 30) puts(\"'IMP0SSBLE!!'\"); //\u65e0\u89e3\u60c5\u51b5\n\t\telse printf(\"%lld\", r);\n}\n```\n\u6c42\u8fc7\uff0c\u6c42\u8d5eQwQ",
        "postTime": 1564390930,
        "uid": 36908,
        "name": "Gu_Pigeon",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3821 \u3010Isaac\u3011"
    },
    {
        "content": "## \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a $n$ \u4e2a\u70b9 $m$ \u6761\u8fb9\u7684\u65e0\u5411\u56fe\uff0c\u6bcf\u6761\u8fb9\u6709\u4e00\u4e2a\u8fb9\u6743 $w$\uff0c\u7ecf\u8fc7\u6bcf\u6761\u8fb9\u9700\u8981 $1$ \u5355\u4f4d\u65f6\u95f4\uff0c\u8981\u6c42\u4ece\u70b9 $s$ \u8d70\u5230\u70b9 $t$ \u6070\u597d $k$ \u5355\u4f4d\u65f6\u95f4\u5185\u6240\u7ecf\u8fc7\u7684\u8fb9\u7684\u8fb9\u6743\u6700\u5927\u503c\u6700\u5c0f\uff0c\u95ee\u6700\u5c0f\u662f\u591a\u5c11\u3002\u6b64\u5916\uff0c\u8fd8\u5468\u671f\u6027\u5730\u6709\u4e00\u4e9b\u70b9\u4e0d\u80fd\u7ecf\u8fc7\uff0c\u6bcf\u79cd\u5468\u671f\u53ea\u53ef\u80fd\u4e3a $2,3,4$ \u4e2d\u7684 $1$ \u4e2a\uff0c\u603b\u5171\u6709 $a$ \u4e2a\u5468\u671f\u3002\n\n## \u601d\u8def\n\n\u8fd9\u9053\u9898\u4e0e [P2579 \u6cbc\u6cfd\u9cc4\u9c7c](https://www.luogu.com.cn/problem/P2579) \u5341\u5206\u7c7b\u4f3c\uff0c\u552f\u4e00\u7684\u533a\u522b\u5c31\u5728\u4e8e\u8fb9\u6743\u7684\u4e0d\u540c\u3002\n\n\u9996\u5148\u8003\u8651\u6ca1\u6709\u4efb\u4f55\u70b9\u4e0d\u80fd\u7ecf\u8fc7\uff0c\u5373 $a = 0$ \u7684\u60c5\u51b5\uff1a\n\n\u8003\u8651\u4f7f\u7528\u4e00\u4e2a\u90bb\u63a5\u77e9\u9635 $G$ \u6765\u8868\u793a\u8fd9\u4e2a\u56fe\uff0c\u5176\u4e2d $G_{i,j}$ \u8868\u793a\u70b9 $i$ \u5230\u70b9 $j$ \u6240\u7ecf\u8fc7\u7684\u6240\u6709\u8fb9\u4e2d\u8fb9\u6743\u6700\u5927\u503c\u6700\u5c0f\u7684\u503c\u3002\n\n\u7136\u540e\u8003\u8651\u8f6c\u79fb\u3002\n\n\u5bf9\u4e8e $i$ \u5230 $j$\uff0c\u679a\u4e3e\u4e2d\u95f4\u70b9 $k$\u3002\u56e0\u4e3a\u8981\u6c42\u6700\u5927\u503c\u6700\u5c0f\uff0c\u6240\u4ee5 $G_{i, j} = \\min(G_{i, j}, \\max(G_{i, k}, G_{k,j}))$\u3002\n\n\u7136\u540e\u5c06\u666e\u901a\u7684\u77e9\u9635\u4e58\u6cd5\u6539\u6210\u4e0a\u9762\u7684\u8f6c\u79fb\u5c31\u597d\u4e86\uff0c\u5177\u4f53\u8be6\u89c1\u4ee3\u7801\u3002\n\n\u518d\u8003\u8651\u6709\u70b9\u4e0d\u80fd\u7ecf\u8fc7\u7684\u60c5\u51b5\uff1a\n\n\u56e0\u4e3a\u5468\u671f\u53ea\u6709 $2, 3, 4$\uff0c\u6240\u4ee5\u7528\u4e00\u4e2a\u957f\u5ea6\u4e3a $\\operatorname{lcm}(2,3,4) = 12$ \u7684\u5468\u671f\u5373\u53ef\u3002\n\n\u628a $1$ \u5230 $12$ \u65f6\u523b\u7684\u77e9\u9635\u7ed9\u5904\u7406\u51fa\u6765\uff0c\u5206\u522b\u4e3a  $G_1, G_2, G_3 \\dots G_n$\uff0c\u4ee4 $H = \\prod\\limits_{i=1}^{12} G_i$\uff0c\u6700\u7ec8\u7684\u77e9\u9635\u5c31\u662f $H^{k/12} \\times \\prod\\limits_{i=1}^{k \\bmod 12} G_i$\u3002\n\n\u6700\u540e\u8bb0\u5f97\u77e9\u9635\u521d\u59cb\u503c\u5e94\u5168\u90e8\u4e3a\u65e0\u9650\u5927\uff0c\u56e0\u4e3a\u8981\u53d6\u6700\u5c0f\u503c\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^3 \\log k)$\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define _rep(i, x, y) for(int i = x; i <= y; ++i)\n#define _req(i, x, y) for(int i = x; i >= y; --i)\n#define _rev(i, u) for(int i = head[u]; i; i = e[i].nxt)\n#define pb(x) push_back(x)\n#define mst(f, i) memset(f, i, sizeof f)\nusing namespace std;\n#ifdef ONLINE_JUDGE\n#define debug(...) 0\n#else\n#define debug(...) fprintf(stderr, __VA_ARGS__), fflush(stderr)\n#endif\nnamespace fastio{\n    template<typename T> inline void read(T &t){\n        T x = 0, f = 1;\n        char c = getchar();\n        while(!isdigit(c)){\n            if(c == '-') f = -f;\n            c = getchar();\n        }\n        while(isdigit(c)) x = x * 10 + c - '0', c = getchar();\n        t = x * f;\n    }\n    template<typename T, typename ... Args> inline void read(T &t, Args&... args){\n        read(t);\n        read(args...);\n    }\n    template<typename T> void write(T t){\n        if(t < 0) putchar('-'), t = -t;\n        if(t >= 10) write(t / 10);\n        putchar(t % 10 + '0');\n    }\n    template<typename T, typename ... Args> void write(T t, Args... args){\n        write(t), putchar(' '), write(args...);\n    }\n    template<typename T> void writeln(T t){\n        write(t);\n        puts(\"\");\n    }\n    template<typename T> void writes(T t){\n        write(t), putchar(' ');\n    }\n};\nusing namespace fastio;\ntypedef long long ll;\ntypedef pair<int, int> PII;\nconst int N = 55, inf = 0x3f3f3f3f;\nint n, m, s, t, k;\nint T, num, p[5];\nstruct matrix{\n\tint c[N][N];\n\tvoid clear(){\n\t\tmst(c, inf);\n\t}\n\tvoid output(){\n\t\t_rep(i, 1, n){\n\t\t\t_rep(j, 1, n) cout << setw(15) << c[i][j];\n\t\t\tputs(\"\");\n\t\t}\n\t\tputs(\"==========\");\n\t}\n}G[13], H, A;\nmatrix operator*(matrix a, matrix b){\n\tmatrix x; x.clear();\n\t_rep(k, 1, n){\n\t\t_rep(i, 1, n){\n\t\t\t_rep(j, 1, n){\n\t\t\t\tx.c[i][j] = min(x.c[i][j], max(a.c[i][k], b.c[k][j]));\n\t\t\t}\n\t\t}\n\t}\n\treturn x;\n}\nmatrix ksm(matrix base, int h){\n\tmatrix res = base; h--;\n\twhile(h){\n\t\tif(h & 1) res = res * base;\n\t\tbase = base * base, h >>= 1;\n\t}\n\treturn res;\n}\nvoid out(int x){\n\tif(x == inf) puts(\"'IMP0SSBLE!!'\");\n\telse writeln(x);\n}\nint main(){\n\tG[0].clear();\n\tread(n, m, s, t, k);\n\t_rep(i, 1, m){\n\t\tint u, v, w; read(u, v, w);\n\t\tG[0].c[u][v] = G[0].c[v][u] = w;\n\t}\n\t_rep(i, 1, 12) G[i] = G[0];\n\tread(num);\n\tbool flag = !num;\n\twhile(num--){\n\t\tread(T);\n\t\t_rep(i, 0, T - 1) read(p[i]);\n\t\t_rep(i, 1, 12){\n\t\t\t_rep(j, 1, n){\n\t\t\t\tG[i].c[j][p[i % T]] = inf;\n\t\t\t}\n\t\t}\t\t\n\t}\n\tif(flag){\n\t\tA = ksm(G[0], k);\n\t\tout(A.c[s][t]);\n\t\treturn 0;\n\t}\n\tH = G[1];\n\t_rep(i, 2, 12) H = H * G[i];\n\tA = ksm(H, k / 12), k %= 12;\n\t_rep(i, 1, k) A = A * G[i];\n\tout(A.c[s][t]);\n    return 0;\n}\n```",
        "postTime": 1676008869,
        "uid": 573341,
        "name": "MiniLong",
        "ccfLevel": 0,
        "title": "P3821 Isaac \u9898\u89e3"
    },
    {
        "content": "## \u60f3\u6cd5\n\n\u9996\u5148\uff0c\u4f60\u53ef\u4ee5\u53bb\u770b\u4e00\u4e0b[\u6cbc\u6cfd\u9cc4\u9c7c](https://www.luogu.com.cn/problem/P2579)\u8fd9\u9053\u9898\n\n\u6211\u4eec\u53d1\u73b0\u8fd9\u4e24\u9898\u975e\u5e38\u76f8\u4f3c\uff0c\u4f46\u662f\u6cbc\u6cfd\u9cc4\u9c7c\u662f\u6709\u8fb9\u5c31\u53ef\u4ee5\u76f4\u63a5\u8d70\uff0c\u8fd9\u9898\u8fd8\u6d89\u53ca\u5230\u8fb9\u6743  \n\u4f46\u662f\u4e3b\u4f53\u601d\u8def\u4e0d\u7528\u53d8\uff0c\u9884\u8ba1\u628a\u77e9\u9635\u4e58\u6cd5\u6539\u4e00\u4e0b\u5c31\u80fd\u8fc7\n\n----\n\n## \u56de\u987e\n\n\u56de\u987e\u6cbc\u6cfd\u9cc4\u9c7c\u90a3\u9898\u7684\u89e3\u6cd5\uff1a  \n\u4e0d\u8003\u8651\u98df\u4eba\u9c7c\uff0c\u7528\u90bb\u63a5\u77e9\u9635 $a$ \u5b58\u50a8\u8fd9\u4e2a\u56fe\uff0c\u90a3\u4e48 $a$ \u53ef\u8868\u793a $k=1$ \u65f6\u7684\u7b54\u6848\uff0c$b=a^2$ \u5219\u53ef\u4ee5\u8868\u793a $k=2$ \u65f6\u7684\u7b54\u6848\u3002   \n\u524d\u8005\u5f88\u663e\u7136\uff0c\u5bf9\u4e8e\u540e\u8005\uff0c\u8003\u8651\u6bcf\u6761\u8def\u7ebf $i\\rightarrow k\\rightarrow j$ \uff0c$b_{i,j}$ \u5728\u4e58\u6cd5\u65f6\u90fd\u521a\u597d\u52a0\u4e86\u4e00\u6b21 $a_{i,k}\\times a_{k,j}$ \uff0c\u8fd9\u6837\u7b97\u51fa\u6765\u7684\u521a\u597d\u5c31\u662f\u603b\u65b9\u6848\u6570\u3002  \n\n\u52a0\u4e0a\u98df\u4eba\u9c7c\uff0c\u53d1\u73b0\u6240\u6709\u98df\u4eba\u9c7c\u7684\u8fd0\u52a8\u5fc5\u5b9a\u4ee5 $lcm(2,3,4)=12$ \u4e2a\u5355\u4f4d\u65f6\u95f4\u4e3a\u4e00\u5468\u671f\u3002  \n\u9884\u5904\u7406\u51fa12\u4e2a\u65f6\u523b\u56fe\u7684\u72b6\u6001\uff08\u67d0\u6761\u8fb9\u7ec8\u70b9\u6709\u98df\u4eba\u9c7c\u5219\u8be5\u8fb9\u4e0d\u53ef\u8d70\uff09\uff0c\u8bb0\u4e3a $f_1\\sim f_{11},f_0$ \uff08\u53ef\u5c06 $f_0$ \u7406\u89e3\u4e3a $f_{12}$ \uff09 \n\n\u8bbe $Q=f_1\\times f_2\\times \\dots \\times f_{11}\\times f_0$ \uff0c\u6613\u5f97\u7b54\u6848\u4e3a $Q^{k/12}\\times \\prod\\limits_{i=1}^{k\\%12}f_i$   \n\uff08\u63d0\u793a\uff1a\u7b54\u6848\u521a\u597d\u7531 $k$ \u4e2a\u77e9\u9635\u76f8\u4e58\u5f97\u5230\uff09\n\n\u8003\u8651\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n^3 \\log k)$ \u3002\n\n----\n\n## \u9898\u89e3\n\n\u4e0d\u8003\u8651\u602a\u7269\uff0c\u7528\u90bb\u63a5\u77e9\u9635 $a$ \u5b58\u50a8\u8fd9\u4e2a\u56fe\u7684\u8fb9\u6743\uff0c\u6211\u4eec\u5e0c\u671b\u4fee\u6539\u77e9\u9635\u4e58\u6cd5\u7684\u5b9a\u4e49\uff0c\u4f7f $b=a^2$ \u53ef\u4ee5\u4f5c\u4e3a $k=2$ \u65f6\u7684\u7b54\u6848\u3002  \n\u5bf9\u4e8e\u6bcf\u6761\u8def\u5f84 $i\\rightarrow k\\rightarrow j$ \uff0c\u8d70\u8fc7\u8fd9\u6761\u8def\u5f84\u9700\u8981\u7684\u8840\u91cf\u4e3a $\\max(a_{i,k},a_{k,j})$ \u3002  \n\u9898\u76ee\u8981\u6c42\u8840\u91cf\u6700\u5c0f\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u8ba9 $b_{i,j}=\\min\\{\\max(a_{i,k},a_{k,j})\\}$\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u77e9\u9635\u4e58\u6cd5\u5c31\u6539\u597d\u4e86\uff1a\n\n```cpp\n#define rep(i,x) for (int i=1; i<=x; ++i)\n//\u6b64\u5904\u81ea\u884c\u8111\u8865\u5b9a\u4e49\uff0c\u6216\u8005\u5f80\u4e0b\u7ffb\u770b\u5b8c\u6574\u4ee3\u7801\nnode operator * (node x,node y) {\n\tstatic node t; memset(t.c,0x7f,sizeof t.c);\n\trep(i,n) rep(k,n) rep(j,n)\n\t\tt.c[i][j]=min(t.c[i][j],max(x.c[i][k],y.c[k][j]));\n\treturn t;\n}\n```\n\n\uff08\u56e0\u4e3a\u8981\u6c42\u6700\u5c0f\u503c\uff0c\u6240\u4ee5 $t$ \u8981\u521d\u59cb\u5316\u6210\u65e0\u7a77\u5927\uff0c\u672c\u9898\u6570\u636e\u4e0d\u5f3a\uff0c\u4f3c\u4e4e0x7f7f7f7f\u591f\u4e86\uff09\n\n\u8fd9\u4e2a\u77e9\u9635\u4e58\u6cd5\u6ee1\u8db3\u7ed3\u5408\u5f8b\uff08\u6211\u4e0d\u4f1a\u8bc1\uff0c\u8fd9\u91cc\u6316\u4e2a\u5751\uff09\uff0c\u90a3\u4e48\u53ef\u4ee5\u7528\u5feb\u901f\u5e42\u4f18\u5316    \n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n^3 \\log k)$\n\n----\n\n## \u4ee3\u7801\n\n\u6211\u5e76\u6ca1\u6709\u627e\u5230\u8fd9\u79cd\u5b9a\u4e49\u4e0b\u7684\u5355\u4f4d\u77e9\u9635\uff0c\u6240\u4ee5\u5728\u4e00\u4e9b\u5b9e\u73b0\u7684\u5730\u65b9\u9700\u8981\u907f\u514d\u4f7f\u7528\u5355\u4f4d\u77e9\u9635\uff08\u4ee3\u7801\u4e2d\u7528 `/*_*/` \u6807\u8bb0\u4e86\uff09\u3002\n\n```cpp\n#include<cstdio>\n#include<cstring> \n#define rep(i,x) for (int i=1; i<=x; ++i)\nint inf,n,m,p1,p2,k,M,T,x,y,w,a[52][52];\ninline int min(int x,int y) { return x<y?x:y; }\ninline int max(int x,int y) { return x>y?x:y; }\nstruct node { int c[52][52]; }Q,Q1,f[12];\nnode operator * (node x,node y) { //\u77e9\u9635\u4e58\u6cd5\n\tstatic node t; memset(t.c,0x7f,sizeof t.c);\n\trep(i,n) rep(k,n) rep(j,n)\n\t\tt.c[i][j]=min(t.c[i][j],max(x.c[i][k],y.c[k][j]));\n\treturn t;\n}\n\nint main() {\n\tscanf(\"%d%d%d%d%d\",&n,&m,&p1,&p2,&k);\n\tmemset(a,0x7f,sizeof a); inf=a[0][0]; \n\t//\u4fdd\u9669\u5199\u6cd5\uff0c\u5176\u5b9e\u76f4\u63a5\u5b9a\u4e49inf=0x7f7f7f7f\u5e94\u8be5\u6ca1\u95ee\u9898\n\twhile (m--) scanf(\"%d%d%d\",&x,&y,&w),a[x][y]=a[y][x]=w; //\u5b58\u56fe\n\tfor (int i=0; i<12; ++i) memcpy(f[i].c,a,sizeof a);\n\tfor (scanf(\"%d\",&M); M; --M) {\n\t\tscanf(\"%d\",&T);\n\t\tfor (int i=0; i<T; ++i) { \n\t\t\tscanf(\"%d\",&x);\n\t\t\tfor (int j=i; j<12; j+=T) rep(k,n) f[j].c[k][x]=inf; //\u8003\u8651\u602a\u7269\u7684\u5f71\u54cd\n\t\t}\n\t}\n\tQ=f[1];/*_*/ for (int i=2; i<12; ++i) Q=Q*f[i]; Q=Q*f[0];\n\tif (k/12) {\n\t\tfor (y=k/12-1,Q1=Q/*_*/; y; y>>=1) (y&1)&&(Q1=Q1*Q,0),Q=Q*Q;\n\t\tfor (int i=1,mx=k%12; i<=mx; ++i) Q1=Q1*f[i];\n\t}\n\telse { Q1=f[1];/*_*/ for (int i=2; i<=k; ++i) Q1=Q1*f[i]; }\n\t(x=Q1.c[p1][p2])==inf?puts(\"'IMP0SSBLE!!'\"):printf(\"%d\",x);\n\t//\u65e0\u89e3\u65f6\u8f93\u51fa\u6709\u5f15\u53f7\uff0cO\u53d8\u62100. \u76f4\u63a5\u590d\u5236\u9898\u76ee\u91cc\u7684\u5c31\u597d\u4e86\n\treturn 0;\n}\n```",
        "postTime": 1587255940,
        "uid": 38785,
        "name": "icyM3tra",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3821 \u3010Isaac\u3011"
    },
    {
        "content": "~~\u6c34\u4e00\u6ce2\u9898\u89e3~~\n\n------------\n\n\u672c\u849f\u84bb\u662f\u770b\u7740\u697c\u4e0b\u51e0\u4f4d\u5927\u4f6c\u7684\u9898\u89e3\u5199\u7684\uff0c\u7531\u4e8e\u697c\u4e0b\u51e0\u4f4d\u5927\u4f6c\u7684\u9898\u89e3\u5df2\u7ecf\u5199\u5f97\u5f88\u8be6\u7ec6\u4e86\uff0c\u518d\u6b21\u5c31\u4e0d\u518d\u7ec6\u8bb2\u3002\n\n\u6b64\u9898\u4e0e[\u6cbc\u6cfd\u9cc4\u9c7c](https://www.luogu.org/problem/P2579)\u8f83\u4e3a\u7c7b\u4f3c\u3002\u7531\u4e8e2<=t<=4 , \u6240\u4ee5\u6bcf\u4e2a\u602a\u7269\u5728gcd( 2 , 3 , 4 )=12\u5468\u671f\u7684\u4f4d\u7f6e\u662f\u4e0d\u53d8\u7684\uff0c\u53ea\u9700\u9884\u5904\u7406\u6bcf12\u4e2a\u5355\u4f4d\u65f6\u95f4\u5185\u7684\u77e9\u9635mat\uff0c\u518d\u5feb\u901f\u5e42mat^([k/12]),\u6700\u540e\u5c06\u7b54\u6848\u4e58\u4e0a\uff08k%12\uff09\u7684\u77e9\u9635\u5373\u53ef\u3002\n\n\u8981\u6ce8\u610f\uff1a\n1.\u77e9\u9635\u4e58\u6cd5\u6ca1\u6709\u4ea4\u6362\u5f8b\uff0c\u5f97\u5148\u9884\u5904\u7406Q=A[1]*A[2]*......*A[11]*A[0]\uff0c\u518d\u7528\u7b97\u51faQ^[K/12]\uff0c\u5bf9\u4e8e\u5269\u4e0b\u7684\uff0c\u4eceA[1]\u5f00\u59cb\u4e58\u5b8cK%12\u4e2a\n\n\n2.\u6b64\u9898\u7684\u77e9\u9635\u4e58\u6cd5\u7565\u6709\u4e9b\u4e0d\u540c\uff0c\u5728\u6a21\u677f\u4e0a\u9700\u8981\u8fdb\u884c\u6539\u8fdb\uff0c\u8fd8\u8981\u5bf9\u77e9\u9635\u8fdb\u884c\u9002\u5f53\u7684\u9884\u5904\u7406\u3002\n\n\n\n\n\n\n~~\u4e3b\u8981\u7684\u8fd8\u662f\u4e0a\u4ee3\u7801~~\n```cpp\n#include<bits/stdc++.h>\n\nusing namespace std ;\n\nint n , m , x , y , z , t , st , en ;\n\nint danger[ 33 ][ 5 ] ;\n\nstruct mat \n{\n\t\n\tint num[ 55 ][ 55 ] ;\n\n} ans , sum[ 4 ] ;\n\nmat operator * ( const mat &a , const mat &b )\n{\n\t\n\tmat ans1 ;\n\t\n\tmemset( ans1.num , - 1 , sizeof( ans1.num ) ) ;\n\t\n\tfor ( int i = 1 ; i <= n ; i ++ )\n\t\tfor ( int j = 1 ; j <= n ; j ++ )\n\t\t\tfor ( int k = 1 ; k <= n ; k ++ ) \n\t\t\t\tif ( ( a.num[ i ][ k ] + 1 ) && ( b.num[ k ][ j ] + 1 ) ) \n\t\t\t\t{\n\t\t\t\t \n\t\t\t\t\tif ( ans1.num[ i ][ j ] + 1 ) ans1.num[ i ][ j ] = min( ans1.num[ i ][ j ] , max( a.num[ i ][ k ] , b.num[ k ][ j ] ) ) ;\n\t\t\t\t\telse ans1.num[ i ][ j ] = max( a.num[ i ][ k ] , b.num[ k ][ j ] ) ;\n\t\t\t\t\t\n\t\t\t\t} \n\t\t\t\n\treturn ans1 ;\n\t\n}\n\nint main()\n{\n\t\n\tscanf( \"%d%d%d%d%d\" , &n , &m , &st , &en , &t ) ;\n\t\n\tmemset( sum[ 0 ].num , - 1 , sizeof( sum[ 0 ].num ) ) ;\n\t\n\tmemset( sum[ 1 ].num , - 1 , sizeof( sum[ 1 ].num ) ) ;\n\t\n\tmemset( sum[ 2 ].num , - 1 , sizeof( sum[ 2 ].num ) ) ;\n\t\n\tmemset( sum[ 3 ].num , - 1 , sizeof( sum[ 3 ].num ) ) ;\n\t\n\tmemset( ans.num , - 1 , sizeof( ans.num ) ) ;\n\n\tfor ( int i = 1 ; i <= m ; i ++ ) scanf( \"%d%d%d\" , &x , &y , &z ) , sum[ 0 ].num[ x ][ y ] = sum[ 0 ].num[ y ][ x ] = z ;\n\t\n\tscanf( \"%d\" , &m ) ;\n\t\n\tfor ( int i = 1 ; i <= m ; i ++ ) \n\t{\n\t\t\n\t\tscanf( \"%d\" , &danger[ i ][ 0 ] ) ;\n\t\t\n\t\tfor ( int j = 1 ; j <= danger[ i ][ 0 ] ; j ++ ) scanf( \"%d\" , &danger[ i ][ j ] ) ;\t\t\n\t\t\n\t}\n\t\n\tfor ( int i = 1 ; i <= n ; i ++ ) sum[ 1 ].num[ i ][ i ] = ans.num[ i ][ i ] = 0 ;\n\t\n\tfor ( int i = 1 ; i <= 12 ; i ++ )\n\t{\n\t\t\n\t\tsum[ 2 ] = sum[ 0 ] ;\n\t\t\n\t\tfor ( int j = 1 ; j <= m ; j ++ ) \n\t\t\tfor ( int k = 1 ; k <= n ; k ++ ) sum[ 2 ].num[ k ][ danger[ j ][ 1 + ( i % danger[ j ][ 0 ] ) ] ] = - 1 ;\n\t\t\t\n\t\tsum[ 1 ] = sum[ 1 ] * sum[ 2 ] ;\n\t\t\n\t\tif ( ( i % 12 == t % 12 ) && ( t % 12 ) ) sum[ 3 ] = sum[ 1 ] ; \n\t\t\t\t\n\t}\n\t\n\tm = t % 12 ;\n\t\n\tt /= 12 ;\n\t\n\tif ( t ) ans = ans * sum[ 1 ] , t -- ;\n\t\n\twhile ( t )\n\t{\n\t\t\n\t\tif ( t % 2 ) ans = ans * sum[ 1 ] ;\n\t\t\n\t\tt >>= 1 ;\n\t\t\n\t\tsum[ 1 ] = sum[ 1 ] * sum[ 1 ] ;\n\t\t\n\t}\n\t\n\tif ( m ) ans = ans * sum[ 3 ] ;\n\t\n\tif ( ans.num[ st ][ en ] + 1 ) printf( \"%d\" , ans.num[ st ][ en ] ) ;\n\telse printf( \"'IMP0SSBLE!!'\" ) ;\n\t\n\treturn 0 ;\t\n\t\n} \n \n \n \n \n \n \n \n```\n",
        "postTime": 1564976475,
        "uid": 36949,
        "name": "Ydkwia",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3821 \u3010Isaac\u3011"
    }
]
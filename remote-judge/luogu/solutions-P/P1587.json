[
    {
        "content": "\u9898\u610f:\u6c42$\\sum_{x=1}^n\\sum_{y=1}^m\\frac{x}{y}$\u5728$k$\u8fdb\u5236\u4e0b\u80fd\u8868\u793a\u6210\u5faa\u73af\u8282\u4ece\u7b2c\u4e00\u4f4d\u5c0f\u6570\u5f00\u59cb\u7684\u65e0\u9650\u5faa\u73af\u5c0f\u6570\u6216\u6574\u6570\u7684\u6700\u7b80\u5206\u6570\u4e2a\u6570\n\n\n\u5047\u8bbe$\\frac{x}{y}$\u7684\u5faa\u73af\u8282\u957f\u5ea6\u4e3a$l$\n\n\n$\\Rightarrow [\\frac{xk^l}{y}]=[\\frac{x}{y}]$\n\n\n\u8fd9\u91cc\u4e2d\u62ec\u53f7\u8868\u793a\u5176\u5c0f\u6570\u90e8\u5206,\u610f\u601d\u5c31\u662f\u628a\u5c0f\u6570\u70b9\u5f80\u540e\u632a$l$\u4f4d,\u5c0f\u6570\u90e8\u5206\u8fd8\u662f\u76f8\u540c\n\n\n\u6bd4\u5982$1.123123\\ldots$\u5c0f\u6570\u70b9\u5f80\u540e\u632a3\u4f4d\u53d8\u6210$1123.123\\ldots$\n\n\n\u53c2\u716710\u8fdb\u5236\u4e0b\u5c0f\u6570\u70b9\u5f80\u540e\u632a$l$\u4f4d\u5c31\u662f\u4e58\u4ee5$10^l$\n\n\n\u90a3\u4e48$k$\u8fdb\u5236\u4e0b\u5c0f\u6570\u70b9\u5f80\u540e\u632a$l$\u4f4d\u5c31\u662f\u4e58\u4ee5$k^l$\n\n\n$\\Rightarrow \\frac{xk^l}{y}-\\lfloor\\frac{xk^l}{y}\\rfloor=\\frac{x}{y}-\\lfloor\\frac{x}{y}\\rfloor$\n\n\n$\\Rightarrow xk^l-\\lfloor\\frac{xk^l}{y}\\rfloor*y=x-\\lfloor\\frac{x}{y}\\rfloor*y$\n\n\n$\\Rightarrow xk^l\\equiv x\\mod y$\n\n\n\u9898\u76ee\u8981\u6c42\u6700\u7b80\u5206\u6570,\u6240\u4ee5$(x,y)=1$\n\n\n$\\Rightarrow k^l\\equiv1\\mod y$\n\n\n$\\Rightarrow (k,y)=1$\n\n\n$\\Rightarrow Ans=\\sum_{i=1}^n\\sum_{j=1}^m[(i,j)=1][(j,k)=1]$\n\n\n\u90a3\u4e48\u63a5\u4e0b\u6765\u5c31\u6709\u4e24\u6761\u8def\u53ef\u4ee5\u8d70\u4e86\n\n\n## \u4e00:\u8003\u8651\u5904\u7406$[(i,j)=1]$\n\n(\u6709\u516c\u5f0f\u6050\u60e7\u75c7\u4e0b\u8f6c\u6cd5\u4e8c)\n\n\n$\\sum_{i=1}^n\\sum_{j=1}^m[(i,j)=1][(j,k)=1]$\n\n\n$=\\sum_{j=1}^m[(j,k)=1]\\sum_{i=1}^n[(i,j)=1]$\n\n\n$=\\sum_{j=1}^m[(j,k)=1]\\sum_{i=1}^n\\sum_{d|(i,j)}\\mu(d)$\n\n\n$=\\sum_{j=1}^m[(j,k)=1]\\sum_{i=1}^n\\sum_{d|i,d|j}\\mu(d)$\n\n$=\\sum_{j=1}^m[(j,k)=1]\\sum_{d|j}^n\\mu(d)\\frac{n}{d}$\n\n\n$=\\sum_{d=1}^n\\mu(d)\\frac{n}{d}\\sum_{j=1}^m[d|j][(j,k)=1]$\n\n\n$=\\sum_{d=1}^n\\mu(d)\\frac{n}{d}\\sum_{jd=1}^m[d|jd][(jd,k)=1]$\n\n\n$j$\u7528$jd$\u66ff\u6362\u4e00\u4e0b\u6765\u51cf\u5c11\u9650\u5236(\u4e0b\u540c)\n\n\n$=\\sum_{d=1}^n\\mu(d)\\frac{n}{d}\\sum_{j=1}^{\\frac{m}{d}}[(jd,k)=1]$\n\n\n$=\\sum_{d=1}^n\\mu(d)[(d,k)=1]\\frac{n}{d}\\sum_{j=1}^{\\frac{m}{d}}[(j,k)=1]$\n\n\n \n\u8003\u8651$f(n)=\\sum_{i=1}^n[(i,k)=1]=\\frac{n}{k}\\phi(k)+f(n\\mod k)$\n\n\n\u66b4\u529b$O(k\\log k)\\gcd$\u7b97\u4e00\u4e0b$f(1)\\ldots f(k)$\n\n\n\u63a5\u4e0b\u6765\u8c8c\u4f3c\u53c8\u6709\u4e24\u6761\u8def\u53ef\u4ee5\u8d70\u4e86\n\n\n#### \u2460:\u8003\u8651\u5316\u7b80\u5f0f\u5b50\n\n\n\u8003\u8651$g(n,k)=\\sum_{d=1}^n\\mu(d)[(d,k)=1]$\n\n\n$=\\sum_{d=1}^n\\mu(d)\\sum_{p|(d,k)}\\mu(p)$\n\n\n$=\\sum_{d=1}^n\\mu(d)\\sum_{p|d,p|k}\\mu(p)$\n\n$=\\sum_{d=1}^n\\sum_{p|d}\\mu(d)\\sum_{p|k}\\mu(p)$\n\n$=\\sum_{p|k}\\mu(p)\\sum_{dp=1}^n\\sum_{p|dp}\\mu(dp)$\n\n$=\\sum_{p|k}\\mu(p)\\sum_{d=1}^{\\frac{n}{p}}\\mu(dp)$\n\n\n\u5982\u679c$(d,p)\\neq1$,\u90a3\u4e48$\\mu(dp)=0$\n\n\n$=\\sum_{p|k}\\mu(p)\\sum_{d=1}^{\\frac{n}{p}}\\mu(dp)[(d,p)=1]$\n\n\n$=\\sum_{p|k}\\mu(p)\\sum_{d=1}^{\\frac{n}{p}}\\mu(d)\\mu(p)[(d,p)=1]$\n\n\n$=\\sum_{p|k}\\mu(p)^2\\sum_{d=1}^{\\frac{n}{p}}\\mu(d)[(d,p)=1]$\n\n\n$=\\sum_{p|k}\\mu(p)^2g(\\frac{n}{p},p)$\n\n\n\u8fb9\u754c$g(0,k)=0$\n\n\n$g(n,1)=\\sum_{d=1}^n\\mu(d)$\u76f4\u63a5\u675c\u6559\u7b5b\n\n\n\u590d\u6742\u5ea6\u662f$O$(($k$\u7684\u8d28\u56e0\u5b50\u4e2a\u6570)$\\sqrt n+n^{\\frac{2}{3}}$)\n\n```c++\n#include<map>\n#include<cmath>\n#include<cstdio>\n#include<algorithm>\n#define fp(i,a,b) for(int i=a,I=b;i<=I;++i)\n#define file(s) freopen(s\".in\",\"r\",stdin),freopen(s\".out\",\"w\",stdout)\nusing namespace std;\nconst int N=7e5+5,E=2e6+5;\ntypedef int arr[N];typedef long long ll;\nstruct Am{int nx,x,w;}e1[E];\nstruct Ans{int nx,n,m,k;ll w;}e2[E];\nint n,m,k,M,c1,c2,K[2000],f1[E],f2[E];arr is,pr,mu,Smu;\nint Sm(int x){\n    if(x<=M)return Smu[x];\n    int u=(x+2017)%E;\n    for(int i=f1[u];i;i=e1[i].nx)if(e1[i].x==x)return e1[i].w;\n    e1[++c1]=Am{f1[u],x,1};f1[u]=c1;\n    int&w=e1[c1].w,i=2,j=sqrt(x);\n    for(;i<=j;++i)w-=Sm(x/i);\n    for(;i<=x;i=j+1)j=x/(x/i),w-=(j-i+1)*Sm(x/i);\n    return w;\n}\nll sol(int n,int m,int k){\n    if(!n||!m)return 0;\n    int u=(2017ll*n+m+k)%E;\n    for(int i=f2[u];i;i=e2[i].nx)if(e2[i].n==n&&e2[i].m==m&&e2[i].k==k)return e2[i].w;\n    e2[++c2]=Ans{f2[u],n,m,k,0};f2[u]=c2;ll&w=e2[c2].w;\n    if(k==1){\n        if(n>m)swap(n,m);\n        int i=1,j=sqrt(n),s,t=0,x,y;\n        for(;i<=j;++i,t=s)s=Sm(i),w+=1ll*(n/i)*(m/i)*(s-t);\n        for(;i<=n;i=j+1,t=s)x=n/i,y=m/i,j=min(n/x,m/y),s=Sm(j),w+=1ll*x*y*(s-t);\n        u=(2017ll*m+n+k)%E;e2[++c2]=Ans{f2[u],m,n,k,w};f2[u]=c2;\n    }else for(int i=1;i<=K[0]&&K[i]<=k;++i)\n            if(k%K[i]==0&&mu[K[i]])\n                w+=sol(m/K[i],n,K[i])*mu[K[i]];\n    return w;\n}\nint main(){\n    #ifndef ONLINE_JUDGE\n        file(\"s\");\n    #endif\n    scanf(\"%d%d%d\",&n,&m,&k);\n    M=min(N-5,max(k,min(n,m)));Smu[1]=mu[1]=1;\n    fp(i,2,M){\n        if(!is[i])pr[++pr[0]]=i,mu[i]=-1;\n        for(int j=1,x;j<=pr[0]&&(x=i*pr[j])<=M;++j){\n            is[x]=1;if(i%pr[j])mu[x]=-mu[i];else break; \n        }Smu[i]=Smu[i-1]+mu[i];\n    }\n    fp(i,1,k)if(k%i==0)K[++K[0]]=i;\n    printf(\"%lld\",sol(n,m,k));\nreturn 0;\n}\n```\n \n#### \u2461:\u8003\u8651\u5206\u6790\u5f0f\u5b50\n\n\n\u6211\u4eec\u53ef\u4ee5\u628a$k$\u8868\u793a\u6210$p^aq$,\u5047\u8bbe$p$\u662f$k$\u6700\u5c0f\u7684\u8d28\u56e0\u5b50\n\n\n\u5bf9\u4e8e1\u5230$k$\u4e2d\u6bcf\u4e00\u4e2a\u6570\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u4ed6\u7684$p,q$\n\n\n$g(n,k)=\\sum_{d=1}^n\\mu(d)[(d,k)=1]=\\sum_{d=1}^n\\mu(d)[(d,p)=1][(d,q)=1]$\n\n\n\u5f53$(d,q)=1$\u65f6\u53ea\u6709$(d,p)=1,(d,p)=p$\u4e24\u79cd\u60c5\u51b5\n\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8f6c\u5316\u4e3a\u6c42\u6ee1\u8db3$(d,q)=1$\u7684$\\mu(d)$\u51cf\u53bb$(d,q)=1$\u4e2d\u6ee1\u8db3$(d,p)=p$\u7684$\\mu(d)$\n\n\n\u5373$g(n,k)=\\sum_{d=1}^n\\mu(d)[(d,q)=1]-\\sum_{d=1}^n\\mu(d)[(d,q)=1][(d,p)=p]$\n\n\n$=g(n,q)-\\sum_{dp=1}^n\\mu(dp)[(dp,q)=1][(dp,p)=p]$\n\n\n$=g(n,q)-\\sum_{d=1}^{\\frac{n}{p}}\\mu(dp)[(d,q)=1]$\n\n\n\u5f53$(d,p)\\neq1$\u65f6$\\mu(dp)=0$,\u6240\u4ee5$d$\u8981\u6ee1\u8db3$(d,p)=1$\n\n\n$=g(n,q)-\\sum_{d=1}^{\\frac{n}{p}}\\mu(dp)[(d,p)=1][(d,q)=1]$\n\n\n$=g(n,q)-\\sum_{d=1}^{\\frac{n}{p}}\\mu(d)\\mu(p)[(d,k)=1]$\n\n\n$=g(n,q)-\\mu(p)\\sum_{d=1}^{\\frac{n}{p}}\\mu(d)[(d,k)=1]$\n\n\n$=g(n,q)+g(\\frac{n}{p},k)$\n\n\n\u8fb9\u754c\u548c\u590d\u6742\u5ea6\u662f\u540c\u4e0a\n```c++\n#include<cmath>\n#include<cstdio>\n#include<algorithm>\n#define fp(i,a,b) for(int i=a,I=b;i<=I;++i)\n#define file(s) freopen(s\".in\",\"r\",stdin),freopen(s\".out\",\"w\",stdout)\nusing namespace std;\nconst int N=1e6+5,E=2.2*N;\ntypedef int arr[N];\nstruct eg{int nx,n,k,w;}e[E];\nint n,m,k,M,ce,fi[E],p[2001],q[2001];arr is,pr,mu,Smu,f;\nint g(int n,int k){\n    if(!n||(n<=M&&k==1))return Smu[n];\n    int x=(1LL*n*2017+k)%E;\n    for(int i=fi[x];i;i=e[i].nx)if(e[i].n==n&&e[i].k==k)return e[i].w;\n    e[++ce]=eg{fi[x],n,k,0};fi[x]=ce;int&w=e[ce].w;\n    if(k==1){\n        w=1;int i=2,j=sqrt(n),x;\n        for(;i<=j;++i)w-=g(n/i,1);\n        for(;i<=n;i=j+1)x=n/i,j=n/x,w-=(j-i+1)*g(x,1);\n    }else w=g(n,q[k])+g(n/p[k],k);\n    return w;\n}\nint gcd(int a,int b){return!b?a:gcd(b,a%b);}\ninline int Sf(int x){return x/k*f[k]+f[x%k];}\nint main(){\n    #ifndef ONLINE_JUDGE\n        file(\"s\");\n    #endif\n    scanf(\"%d%d%d\",&n,&m,&k);\n    M=min(N-5,min(n,m));Smu[1]=mu[1]=1;\n    fp(i,2,M){\n        if(!is[i])pr[++pr[0]]=i,mu[i]=-1;\n        for(int j=1,x;j<=pr[0]&&(x=i*pr[j])<=M;++j){\n            is[x]=1;if(i%pr[j])mu[x]=-mu[i];else break;\n        }Smu[i]=Smu[i-1]+mu[i];\n    }\n    fp(i,1,k)f[i]=f[i-1]+(gcd(i,k)==1);\n    fp(i,2,k){\n        for(int j=2;;++j)if(i%j==0&&!is[j]){p[i]=j;break;}\n        for(q[i]=i;q[i]%p[i]==0;)q[i]/=p[i];\n    }\n    int i=1,j=sqrt(min(n,m)),x,y,s,t=0;long long w=0;\n    for(;i<=j;++i,t=s)s=g(i,k),w+=1ll*(n/i)*Sf(m/i)*(s-t);\n    for(;i<=min(n,m);i=j+1,t=s)x=n/i,y=m/i,j=min(n/x,m/y),\n        s=g(j,k),w+=1ll*x*Sf(y)*(s-t);\n    printf(\"%lld\",w);\nreturn 0;\n}\n```\n\n \n## \u4e8c:\u8003\u8651\u5904\u7406$[(j,k)=1]$\n\n\n\u4ee4$f(n,m,k)=\\sum_{i=1}^n\\sum_{j=1}^m[(i,j)=1][(j,k)=1]$\n\n\n$=\\sum_{i=1}^n\\sum_{j=1}^m[(i,j)=1]\\sum_{d|(j,k)}\\mu(d) $\n\n\n$=\\sum_{i=1}^n\\sum_{jd=1}^m[(i,jd)=1]\\sum_{d|jd,d|k}\\mu(d) $\n\n$=\\sum_{d|k}\\mu(d)\\sum_{i=1}^n\\sum_{j=1}^{\\frac{m}{d}}[(i,jd)=1]$\n\n\n$=\\sum_{d|k}\\mu(d)\\sum_{i=1}^n\\sum_{j=1}^{\\frac{m}{d}}[(i,j)=1][(i,d)=1]$\n\n\n$=\\sum_{d|k}\\mu(d)f(\\frac{m}{d},n,d)$\n\n\n\u8fb9\u754c$f(0,m,k)=f(n,0,k)=0$\n\n\n\u7136\u540e$k=1$\u5c31\u662f\u7b80\u5355\u5904\u7406\u4e00\u4e0b$\\sum_{i=1}^n\\sum_{j=1}^m[(i,j)=1]=\\sum_{d=1}^n\\mu(d)\\frac{n}{d}\\frac{m}{d}$\u5c31$ok$\u4e86\n\n\n\u590d\u6742\u5ea6\u662f$O(\\log n\\log m\\sqrt n+n^{\\frac{2}{3}})$\n\n```c++\n#include<map>\n#include<cmath>\n#include<cstdio>\n#include<algorithm>\n#define fp(i,a,b) for(int i=a,I=b;i<=I;++i)\n#define fd(i,a,b) for(int i=a,I=b;i>=I;--i)\n#define file(s) freopen(s\".in\",\"r\",stdin),freopen(s\".out\",\"w\",stdout)\nusing namespace std;\nconst int N=1e7+5;\ntypedef int arr[N];\ntypedef long long ll;\nstruct da{int n,m,k;inline bool operator<(const da&b)const{return n==b.n?(m==b.m?k<b.k:m<b.m):n<b.n;}};\nint n,m,k,M,K[2000];arr is,pr,mu,Smu;map<int,int>Am;map<da,ll>Ans;\nint Sm(int x){\n    if(x<=M)return Smu[x];\n    if(Am[x])return Am[x];\n    int w=1,i=2,j=sqrt(x);\n    for(;i<=j;++i)w-=Sm(x/i);\n    for(;i<=x;i=j+1)j=x/(x/i),w-=(j-i+1)*Sm(x/i);\n    return Am[x]=w;\n}\nll sol(int n,int m,int k){\n    if(!n||!m)return 0;\n    da now=da{n,m,k};\n    if(Ans[now])return Ans[now];ll w=0;\n    if(k==1){\n        if(n>m)swap(n,m);\n        int i=1,j=sqrt(n),s,t=0,x,y;\n        for(;i<=j;++i,t=s)s=Sm(i),w+=1ll*(n/i)*(m/i)*(s-t);\n        for(;i<=n;i=j+1,t=s)x=n/i,y=m/i,j=min(n/x,m/y),s=Sm(j),w+=1ll*x*y*(s-t);\n        Ans[da{m,n,k}]=w;\n    }else for(int i=1;i<=K[0]&&K[i]<=k;++i)\n            if(k%K[i]==0&&mu[K[i]])\n                w+=sol(m/K[i],n,K[i])*mu[K[i]];\n    return Ans[now]=w;\n}\nint main(){\n    #ifndef ONLINE_JUDGE\n        file(\"s\");\n    #endif\n    scanf(\"%d%d%d\",&n,&m,&k);\n    M=min((int)1e7,max(k,min(n,m)));mu[1]=1;\n    fp(i,2,M){\n        if(!is[i])pr[++pr[0]]=i,mu[i]=-1;\n        for(int j=1,x;j<=pr[0]&&(x=i*pr[j])<=M;++j){\n            is[x]=1;\n            if(i%pr[j])mu[x]=-mu[i];\n            else{mu[x]=0;break;}\n        }\n    }fp(i,1,M)Smu[i]=Smu[i-1]+mu[i];\n    fp(i,1,k)if(k%i==0)K[++K[0]]=i;\n    printf(\"%lld\",sol(n,m,k));\nreturn 0;\n}\n```\n\n\u5982\u679c\u662f\u8003\u573a\u6211\u8fd8\u662f\u4f1a\u9009\u62e9\u6cd5\u4e8c\u7684\n",
        "postTime": 1516885465,
        "uid": 20156,
        "name": "Kelin",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P1587 \u3010[NOI2016]\u5faa\u73af\u4e4b\u7f8e\u3011"
    },
    {
        "content": "upd\uff1a\u4e00\u4e2a\u66f4\u7b80\u5355\u7684\u505a\u6cd5\u3002\n\n\u76f8\u7b49\u7684\u7eaf\u5faa\u73af\u5c0f\u6570\u53ea\u7b97\u4e00\u6b21\uff0c\u5373\u5bf9\u4e8e\u4e00\u4e2a\u5206\u6570 $\\frac{x}{y}$ \u53ea\u5728 $x\\perp y$ \u65f6\u7edf\u8ba1\u3002\n\n\u5982\u679c\u4e00\u4e2a $k$ \u8fdb\u5236\u6700\u7b80\u5206\u6570 $\\frac{x}{y}$ \u662f\u7eaf\u5faa\u73af\u5c0f\u6570\uff0c\u8bbe\u5176\u5faa\u73af\u8282\u957f\u5ea6\u4e3a $l$\uff0c\u5fc5\u7136\u6709 \n$$\\left\\{\\frac{xk^l}{y}\\right\\}=\\left\\{\\frac{x}{y}\\right\\}$$\n\u5176\u4e2d $\\{x\\}$ \u8868\u793a\u53d6 $x$ \u7684\u5c0f\u6570\u90e8\u5206\u3002\u5373\n$$\\begin{aligned}\\frac{xk^l}{y}-\\left\\lfloor\\frac{xk^l}{y}\\right\\rfloor&=\\frac{x}{y}-\\left\\lfloor\\frac{x}{y}\\right\\rfloor \\\\ xk^l-y\\left\\lfloor\\frac{xk^l}{y}\\right\\rfloor&=x-y\\left\\lfloor\\frac{x}{y}\\right\\rfloor \\\\ xk^l&\\equiv x\\pmod y \\\\ k^l &\\equiv 1\\pmod y \\end{aligned}$$\n\n\u8fd9\u63a8\u51fa $k\\perp y$\u3002\n\n\u4e8e\u662f\u7b54\u6848\u4e3a\n$$\\sum_{i=1}^n\\sum_{j=1}^m [i\\perp j][k\\perp j]$$\n\u63a5\u4e0b\u6765\u662f\u4f20\u7edf\u827a\u80fd\n$$\\begin{aligned}\\sum_{i=1}^n\\sum_{j=1}^m [i\\perp j][k\\perp j]&=\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{d|i,d|j}\\mu(d)[k\\perp j] \\\\ &=\\sum_{d=1}^{\\min(n,m)} \\mu(d)\\sum_{i=1}^{\\lfloor n/d \\rfloor}\\sum_{j=1}^{\\lfloor m/d \\rfloor}[jd\\perp k] \\\\ &=\\sum_{d=1}^{\\min(n,m)} \\mu(d)\\left\\lfloor \\frac{n}{d}\\right\\rfloor\\sum_{j=1}^{\\lfloor m/d \\rfloor}[j\\perp k][d\\perp k] \\\\ &=\\sum_{d=1}^{\\min(n,m)} \\mu(d)[d\\perp k]\\left\\lfloor \\frac{n}{d}\\right\\rfloor\\sum_{j=1}^{\\lfloor m/d \\rfloor}[j\\perp k]\\end{aligned}$$\n\n\u8003\u8651\u540e\u9762\u7684\u90a3\u4e2a\u548c\u5f0f\u600e\u4e48\u6c42\uff0c\u4e0d\u59a8\u8bbe $g(n)=\\sum\\limits_{i=1}^n[i\\perp k]$\uff0c\u5bb9\u6613\u53d1\u73b0\u5f53 $i>k$ \u65f6\u6839\u636e $\\gcd(i,k)=\\gcd(i+k,k)$\uff0c\u7b54\u6848\u5448\u73b0\u4e00\u4e2a\u957f\u4e3a $k$ \u7684\u5faa\u73af\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\u5c31\u662f\n$$g(n)=\\left\\lfloor\\frac{n}{k}\\right\\rfloor\\varphi(k)+g(n\\bmod k)$$\n\u8fd9\u4e00\u90e8\u5206\u53ef\u4ee5\u505a\u5230 $O(k)-O(1)$\u3002\n\n\u4ee3\u56de\u539f\u5f0f\n$$\\sum_{d=1}^{\\min(n,m)} \\left\\lfloor \\frac{n}{d}\\right\\rfloor g\\left(\\left\\lfloor \\frac{m}{d} \\right\\rfloor\\right)\\mu(d)[d\\perp k]$$\n\n\u524d\u9762\u4e24\u9879\u53ef\u4ee5\u6574\u9664\u5206\u5757\uff0c\u77db\u76fe\u8f6c\u79fb\u4e3a\u6c42\u540e\u9762\u4e24\u9879\u7684\u524d\u7f00\u548c\uff0c\u4e0d\u59a8\u8bbe $f(n)=\\sum\\limits_{i=1}^n\\mu(i)[i\\perp k]$\uff0c\u7ee7\u7eed\u5e72\u82e6\u529b\u6d3b\n$$\\begin{aligned} f(n)&=\\sum_{i=1}^n\\mu(i)[i\\perp k] \\\\ &=\\sum_{i=1}^n[i\\perp k]f\\left(\\left\\lfloor \\frac{n}{i} \\right\\rfloor\\right)-\\sum_{i=2}^n[i\\perp k]f\\left(\\left\\lfloor \\frac{n}{i} \\right\\rfloor\\right)\\end{aligned}$$\n\n\u8003\u8651\u524d\u4e00\u4e2a\u600e\u4e48\u6c42\n$$\\begin{aligned}\\sum_{i=1}^n[i\\perp k]f\\left(\\left\\lfloor \\frac{n}{i} \\right\\rfloor\\right)&=\\sum_{i=1}^n[i\\perp k]\\sum_{j=1}^{\\lfloor n/i\\rfloor}[j\\perp k]\\mu(j) \\\\ &=\\sum_{i=1}^n\\sum_{j=1}^{\\lfloor n/i\\rfloor}[ij\\perp k]\\mu(j)\\end{aligned}$$\n\n\u6362\u4e00\u79cd\u5199\u6cd5\uff0c\u679a\u4e3e $ij$\n$$\\begin{aligned}\\sum_{i=1}^n\\sum_{j=1}^{\\lfloor n/i\\rfloor}[ij\\perp k]\\mu(j)&= \\sum_{i=1}^n\\sum_{d|i}[i\\perp k]\\mu(d) \\\\ &=\\sum_{i=1}^n[i\\perp k][i=1] \\\\ &=1\\end{aligned}$$\n\n\u6700\u7ec8\u6709\n$$f(n)=1-\\sum_{i=2}^n[i\\perp k]f\\left(\\left\\lfloor\\frac{n}{i}\\right\\rfloor\\right)$$\n\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u662f\u4e00\u4e2a\u675c\u6559\u7b5b\u7684\u5f62\u5f0f\uff0c\u800c $[i\\perp k]$ \u7684\u524d\u7f00\u548c\u6211\u4eec\u5df2\u7ecf\u6c42\u51fa\u6765\u4e86\uff0c\u5c31\u662f $g$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u5927\u6982\u662f $O(n^{\\frac{2}{3}}+k)$\u3002\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\nconst int N=2005,M=1e6+5;\nint n,m,k,mu[M],p[M],v[M],g[N],f[M];\nll ans; map<int,int> ro;\n\ninline int G(int x) {return x/k*g[k]+g[x%k];}\n\nvoid init()\n{\n\tfor(int i=1;i<=k;++i) g[i]=g[i-1]+(__gcd(i,k)==1);\n\tmu[1]=f[1]=1;\n\tfor(int i=2;i<=M-5;++i)\n\t{\n\t\tif(!v[i]) p[++p[0]]=i,mu[i]=-1;\n\t\tfor(int j=1;j<=p[0]&&i*p[j]<=M-5;++j)\n\t\t{\n\t\t\tv[i*p[j]]=1;\n\t\t\tif(i%p[j]==0) break;\n\t\t\tmu[i*p[j]]=-mu[i];\n\t\t}\n\t\tf[i]=f[i-1]+mu[i]*(G(i)-G(i-1));\n\t}\n}\n\nint F(int x)\n{\n\tif(x<=M-5) return f[x];\n\tif(ro.find(x)!=ro.end()) return ro[x];\n\tint res=1;\n\tfor(int l=2,r;l<=x;l=r+1)\n\t\tr=x/(x/l),res-=F(x/l)*(G(r)-G(l-1));\n\treturn ro[x]=res;\n}\n\nint main()\n{\n\tscanf(\"%d%d%d\",&n,&m,&k),init();\n\tfor(int l=1,r;l<=min(n,m);l=r+1)\n\t{\n\t\tr=min(n/(n/l),m/(m/l));\n\t\tans+=1LL*(n/l)*G(m/l)*(F(r)-F(l-1));\n\t}\n\tprintf(\"%lld\",ans);\n\treturn 0;\n} \n```",
        "postTime": 1603089266,
        "uid": 88207,
        "name": "MKCCT",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1587 \u3010[NOI2016]\u5faa\u73af\u4e4b\u7f8e\u3011"
    },
    {
        "content": "##\u9898\u89e3\n\n\u5230\u5e95\u5728\u6c42\u4ec0\u4e48\u5462\u3002\u3002\u3002\n\n\u9996\u5148\u4e0d\u7ba1\u4ed6$K$\u8fdb\u5236\u7684\u95ee\u9898\u5566\uff0c\u771f\u662f\u70e6\u6b7b\u5566\n\n\n\u6240\u4ee5\uff0c\u76f8\u5f53\u4e8e\u6709\u4e00\u4e2a\u5206\u6570$\\frac{i}{j}$\n\n\u56e0\u4e3a\u503c\u8981\u4e0d\u76f8\u7b49\n\n\u6240\u4ee5\u6709$i \\perp j$\uff0c\u4e5f\u5c31\u662f$gcd(i,j)=1$\n\n\n\u73b0\u5728\u8003\u8651$K$\u8fdb\u5236\n\n\u5148\u4ece\u719f\u6089\u7684$10$\u8fdb\u5236\u5165\u624b\n\n\u5982\u679c\u4e00\u4e2a\u6700\u7b80\u5206\u6570\u662f\u7eaf\u5faa\u73af\u5c0f\u6570\n\n\u6211\u4eec\u77e5\u9053\uff0c\u4ed6\u7684\u5206\u6bcd\u91cc\u9762\u4e0d\u542b$2,5$\n\n\u800c\u4e14\uff0c\u5de7\u6781\u4e86$10=2*5$\n\n\u4e8e\u662f\u4e4e\uff0c$YY$\u4e00\u4e0b\n\n\u5982\u679c$K$\u8fdb\u5236\u4e2d\u4e00\u4e2a\u5206\u6570\u662f\u7eaf\u5faa\u73af\u5c0f\u6570\n\n\u90a3\u4e48\u5206\u6bcd\u4e0e$K$\u4e92\u8d28\n\n[\u8bc1\u660e\u6233\u8fd9\u91cc(orz LCF \u5b66\u957f)](https://www.cnblogs.com/lcf-2000/p/6250330.html)\n\n\n\u6240\u4ee5\uff0c\u95ee\u9898\u5c31\u53d8\u6210\u5566\n\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m[i \\perp j][j \\perp k]$$\n\n\u4e5f\u5c31\u662f\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m[gcd(i,j)==1][gcd(j,k)==1]$$\n\n\u6362\u4e2a\u987a\u5e8f\u7b97\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m[gcd(j,k)==1][gcd(i,j)==1]$$\n\n$$\\sum_{j=1}^m[gcd(j,k)==1]\\sum_{i=1}^n[gcd(i,j)==1]$$\n\n\n$$\\sum_{j=1}^m[gcd(j,k)==1]\\sum_{i=1}^n\\sum_{d|i,d|j}\\mu(d)$$\n\u628a$d$\u63d0\u51fa\u6765\n\n$$\\sum_{d=1}^n\\mu(d)\\sum_{d|i}^n\\sum_{d|j}^m[gcd(j,k)==1]$$\n$$\\sum_{d=1}^n[d \\perp k ]\\mu(d)\\sum_{i=1}^{n/d}\\sum_{j=1}^{m/d}[gcd(j,k)==1]$$\n\n$$\\sum_{d=1}^n[d \\perp k ]\\mu(d)[\\frac{n}{d}]\\sum_{j=1}^{m/d}[gcd(j,k)==1]$$\n\n\n\n\u73b0\u5728\u76f8\u5f53\u4e8e\u8981\u6c42\u4e24\u4e2a\u4e1c\u897f\u7684\u524d\u7f00\u548c\uff1a\n\n$$f(x)=\\sum_{i=1}^x[gcd(i,k)=1]$$\n\n$$S(x)=\\sum_{i=1}^x[i \\perp k]\\mu(i)$$\n\n\n\u5148\u770b$f(x)$\n\n$x$\u76f8\u5f53\u4e8e\u88ab\u5206\u4e3a\u4e86\u82e5\u5e72\u4e2a\u5927\u5c0f\u4e3a$k$\u7684\u6bb5\n\n\u82e5\u5728\u7b2c\u4e00\u6bb5\u4e2d\uff0c$a \\perp k$\n\n\u5219 $(a+nk) \\perp k$\n\n\u540c\u6837\u7684\uff0c\u6700\u540e\u4e00\u6bb5\u53ef\u80fd\u4e0d\u6ee1\uff0c\u6240\u4ee5\u53ef\u4ee5\u5355\u72ec\u62ce\u51fa\u6765\u8003\u8651\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u63a8\u51fa\uff1a\n\n$$f(x)=[\\frac{x}{k}]f(k)+f(x\\%k)$$\n\n$k<=2000$\n\n\u6240\u4ee5\u9884\u5904\u7406\u51fa$k$\u4ee5\u5185\u7684\u503c\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u7b97\u4e86\n\n\n---\n\n\u73b0\u5728\u7684\u95ee\u9898\u5728\u4e8e\u7b2c\u4e8c\u4e2a$S(x)$\n\n$$S(x,k)=\\sum_{i=1}^x[i \\perp k]\\mu(i) $$\n\n$$=\\sum_{i=1}^x\\mu(i)[gcd(i,k)==1]$$\n\n$$=\\sum_{i=1}^x\\mu(i)\\sum_{d|gcd(i,k)}\\mu(d)$$\n\n$$=\\sum_{i=1}^x\\mu(i)\\sum_{d|i,d|k}\\mu(d)$$\n$$=\\sum_{d|k}\\mu(d)\\sum_{d|i}\\mu(i)$$\n$$=\\sum_{d|k}\\mu(d)\\sum_{i=1}^{x/d}\\mu(id)$$\n\n\u5982\u679c$gcd(i,d)\\neq1$\uff0c\u90a3\u4e48\n\n$\\mu(id)=0$\uff0c\u5bf9\u7b54\u6848\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u5f71\u54cd\n\n$$=\\sum_{d|k}\\mu(d)\\sum_{i=1,i \\perp d}^{x/d}\\mu(i)\\mu(d)$$\n\n$$=\\sum_{d|k}\\mu(d)^2\\sum_{i=1,i \\perp d}^{x/d}\\mu(i)$$\n\n\n$$=\\sum_{d|k}\\mu(d)^2\\sum_{i=1}^{x/d}[i \\perp d]\\mu(i)$$\n\n$$=\\sum_{d|k}\\mu(d)^2S([\\frac{x}{d}],d)$$\n\n\u8fd9\u6837\u5b50\u5f53$k=1$\u53d1\u73b0\u6ca1\u6cd5\u9012\u5f52\u5566\uff1f\uff1f\uff1f\n\n\u4e0d\u8bb0\u5f97[\u8fd9\u9053\u9898\u76ee\u91cc\u9762](http://www.cnblogs.com/cjyyb/p/8295896.html)\u63a8\u51fa\u6765\u7684$\\mu$\u7684\u524d\u7f00\u548c\u662f\u5565\u4e86\uff1f\uff1f\n\n\u6240\u4ee5\u675c\u6559\u7b5b\u4e00\u53d1\u5440\n\n\n---\n\n\u73b0\u5728\uff0c\u8981\u6c42\u7684\u7b54\u6848\u5c31\u662f\uff1a\n\n$$\\sum_{d=1}^n[d \\perp k ]\\mu(d)[\\frac{n}{d}]\\sum_{j=1}^{m/d}[gcd(j,k)==1]$$\n\n\n\u540e\u9762\u7684$\\sum_j$\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5$O(1)$\u6c42\u5566\n\n\u524d\u9762\u7684\u5229\u7528\u8bb0\u5fc6\u5316\u4e5f\u53ef\u4ee5\u5f88\u5f00\u5fc3\u7684\u6c42\u4e86\n\n\u590d\u6742\u5ea6\uff1f\uff1f\n\n\u6211\u4e5f\u4e0d\u77e5\u9053\u3002\u3002\n\n\u53cd\u6b63\u80fd\u8fc7\u5c31\u884c\u5566\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<vector>\n#include<queue>\nusing namespace std;\n#define MAX 10000000\n#define ll long long\ninline int read()\n{\n    int x=0,t=1;char ch=getchar();\n    while((ch<'0'||ch>'9')&&ch!='-')ch=getchar();\n    if(ch=='-')t=-1,ch=getchar();\n    while(ch<='9'&&ch>='0')x=x*10+ch-48,ch=getchar();\n    return x*t;\n}\nint n,K,N,m;\nbool pp[5000];\nint F[5000];\nbool zs[MAX+10];\nint tot,pri[MAX],mu[MAX],smu[MAX];\nmap<pair<int,int>,int> M;\nvoid pre()\n{\n    for(int i=1;i<=K;++i)pp[i]=__gcd(i,K)==1;\n    for(int i=1;i<=K;++i)F[i]=F[i-1]+pp[i];\n    zs[1]=true;mu[1]=1;\n    for(int i=2;i<=N;++i)\n    {\n        if(!zs[i])pri[++tot]=i,mu[i]=-1;\n        for(int j=1;j<=tot&&i*pri[j]<=N;++j)\n        {\n            zs[i*pri[j]]=true;\n            if(i%pri[j])mu[i*pri[j]]=-mu[i];\n            else break;\n        }\n    }\n    for(int i=1;i<=N;++i)smu[i]=smu[i-1]+mu[i];\n}\nint SF(int x){return (x/K)*F[K]+F[x%K];}\nint SS(int x,int k)\n{\n    if((k==1&&x<=N)||(!x))return smu[x];\n    if(M[make_pair(x,k)])return M[make_pair(x,k)];\n    int ret=0;\n    if(k==1)\n    {\n        ret=1;\n        for(int i=2,j;i<=x;i=j+1)\n        {\n            j=x/(x/i);\n            ret-=(j-i+1)*SS(x/i,1);\n        }\n    }\n    else\n    {\n        for(int i=1;i*i<=k;++i)\n            if(k%i==0)\n            {\n                if(mu[i])ret+=SS(x/i,i);\n                if(i*i!=k&&mu[k/i])\n                    ret+=SS(x/(k/i),k/i);\n            }\n    }\n    return M[make_pair(x,k)]=ret;\n}\nint main()\n{\n    n=read();m=read();K=read();\n    N=MAX;pre();\n    ll ans=0,lt=0,nw=0;\n    for(int i=1,j;i<=min(n,m);i=j+1)\n    {\n        j=min(n/(n/i),m/(m/i));\n        nw=SS(j,K);\n        ans+=1ll*(nw-lt)*(n/i)*SF(m/i);\n        lt=nw;\n    }\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n\n```",
        "postTime": 1516154438,
        "uid": 21283,
        "name": "yybyyb",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P1587 \u3010[NOI2016]\u5faa\u73af\u4e4b\u7f8e\u3011"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u9053\u4e00\u9898\u591a\u89e3\u7684\u9898\u3002\n\n\u4e3a\u4e86\u9632\u6b62\u7b97\u91cd\uff0c\u6211\u4eec\u53ef\u4ee5\u53ea\u8ba1\u7b97\u6700\u7b80\u5206\u6570\u7684\u8d21\u732e\u3002\u6839\u636e\u5c0f\u5965\u5b66\u4e60\u7684\u77e5\u8bc6\uff0c\u5982\u679c $x/y$ \u662f\u6700\u7b80\u5206\u6570\u5f53\u4e14\u4ec5\u5f53 $x\\perp y$\u3002\uff08\u8fd9\u91cc\u7684 $\\perp$ \u662f\u4e92\u8d28\u7684\u610f\u601d\uff09\n\n\u7136\u540e\u8003\u8651\u5230\u662f $k$ \u8fdb\u5236\u4e0b\u7eaf\u5faa\u73af\u5c0f\u6570\uff0c\u6240\u4ee5\u4e00\u5b9a\u6709 $y\\perp k$\u3002\n\n\u4e8e\u662f\u9898\u76ee\u5c31\u53d8\u6210\u4e86\u6c42\n$$\\sum_{i=1}^n\\sum_{j=1}^m[i\\perp j][j\\perp k]$$\n\u4e0b\u9762\u7ed9\u51fa\u4e00\u5927\u6ce2\u89e3\u6cd5\uff1a\n## \u6cd5\u4e00\uff1a\n$$\\sum_{i=1}^n\\sum_{j=1}^m[i\\perp j][j\\perp k]$$\n$$=\\sum_{d=1}^n\\mu(d)\\sum_{i=1}^\\frac{n}{d}\\sum_{j=1}^\\frac{m}{d}[jd\\perp k]$$\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u8fd9\u91cc\u7684\u5206\u6570\u9ed8\u8ba4\u5411\u4e0b\u53d6\u6574\u3002\n$$=\\sum_{d=1}^n\\mu(d)\\frac{n}{d}[d\\perp k]\\sum_{j=1}^\\frac{m}{d}[j\\perp k]$$\n\u8bbe $g(x)=\\sum_{i=1}^x[i\\perp k]$\uff0c\u90a3\u4e48\u663e\u7136\uff0c$g(x)=g(x\\mod k)+\\frac{x}{k}\\varphi(k)$\n\n\u8fd9\u4e00\u5768\u53ef\u4ee5\u5feb\u901f\u7b97\u51fa\uff0c\u90a3\u4e48\u539f\u5f0f\n$$=\\sum_{d=1}^n\\mu(d)\\frac{n}{d}[d\\perp k]g(\\frac{m}{d})$$\n\u518d\u8bbe$f(n,k)=\\sum_{i=1}^n\\mu(i)[i\\perp k]$\uff0c\u90a3\u4e48\u539f\u5f0f\n$$=\\sum_{l,r}(f(r,k)-f(l-1,k))\\frac{n}{d}g(\\frac{m}{d})$$\n\u5176\u4e2d $l,r$ \u662f\u6570\u8bba\u5206\u5757\u7684\u6bcf\u4e2a\u533a\u95f4\u3002\n\n\u73b0\u5728\u8003\u8651\u5982\u4f55\u8ba1\u7b97$f$\n\n$$f(n,k)=\\sum_{i=1}^n\\mu(i)[i\\perp k]$$\n$$=\\sum_{d|k}\\mu(d)\\sum_{i=1}^\\frac{n}{d}\\mu(id)$$\n\u7531 $\\mu(ab)=\\mu(a)\\mu(b)[a\\perp b]$ \u5f97\uff1a\n$$=\\sum_{d|k}\\mu^2(d)\\sum_{i=1}^\\frac{n}{d}\\mu(i)[i\\perp d]$$\n$$=\\sum_{d|k}\\mu^2(d)f(\\frac{n}{d},d)$$\n\u8fb9\u754c\u7528\u675c\u6559\u7b5b\u7b97\u4e00\u7b97\u5373\u53ef\u3002\n## \u6cd5\u4e8c\uff1a\n\u8003\u8651\u6cd5\u4e00\u7684 $f(n,k)$ \u6709\u6ca1\u6709\u4ec0\u4e48\u66f4\u597d\u7684\u8ba1\u7b97\u65b9\u6cd5\u3002\n\n\u8bbe $p$ \u662f $k$ \u7684\u4e00\u4e2a\u8d28\u56e0\u5b50\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u6211\u4eec\u5176\u5b9e\u5e76\u4e0d\u5173\u6ce8 $k$ \u4e2d\u6bcf\u4e00\u4e2a\u8d28\u56e0\u5b50\u51fa\u73b0\u7684\u4e2a\u6570\uff0c\u6211\u4eec\u53ea\u5173\u6ce8\u5176\u662f\u5426\u51fa\u73b0\uff0c\u90a3\u4e48\u6211\u4eec\u5148\u628a $k$ \u4e2d\u7684\u6bcf\u4e2a\u8d85\u8fc7\u4e00\u6b21\u7684\u8d28\u56e0\u5b50\u53d8\u6210\u4e00\u6b21\uff0c\u7136\u540e\u6839\u636e\u5bb9\u65a5\u53ef\u5f97\uff1a\n$$f(n,k)=\\sum_{i=1}^n\\mu(i)[i\\perp k/p]-\\sum_{i=1}^n\\mu(i)[i\\perp k/p][p|i]$$\n$$=f(n,k/p)-\\sum_{i=1}^\\frac{n}{p}\\mu(ip)[ip\\perp k/p]$$\n\u663e\u7136 $\\mu(p)=-1$\uff0c\u8fd8\u662f\u6309\u7167\u521a\u624d\u7684\u5957\u8def\uff1a\n$$=f(n,k/p)+\\sum_{i=1}^\\frac{n}{p}\\mu(i)[i\\perp k/p][i\\perp p]$$\n$$=f(n,k/p)+f(\\frac{n}{p},k)$$\n## \u6cd5\u4e09\uff1a\n\u6211\u4eec\u53d1\u73b0\u6cd5\u4e00\u548c\u6cd5\u4e8c\u90fd\u9700\u8981\u591a\u6b21\u8ba1\u7b97 $f$\uff0c\u80fd\u4e0d\u80fd\u51cf\u5c11\u4e00\u70b9\u5462\uff1f\n\n\u5f53\u7136\u80fd\uff0c\u9996\u5148\u56de\u5230\u6cd5\u4e00\u7684\u67d0\u4e00\u6b65\uff0c\u5f97\u5230\u539f\u5f0f\n$$=\\sum_{d=1}^n\\mu(d)\\frac{n}{d}[d\\perp k]g(\\frac{m}{d})$$\n\u76ef\u7740\u8fd9\u8d27\u770b\uff0c\u53d1\u73b0\u597d\u50cf\u6709\u4ec0\u4e48\u4e1c\u897f\u2026\u2026\n\n\u6211\u4eec\u8bbe $\\displaystyle F(x,k)=\\sum_{d=1}^\\frac{n}{x}\\mu(d)\\frac{n}{xd}[d\\perp k]g(\\frac{m}{xd})$\n\u90a3\u4e48\u7b54\u6848\u5c31\u662f $F(1,k)$\n\n$$F(x,k)=\\sum_{d=1}^\\frac{n}{x}\\mu(d)\\frac{n}{xd}\\sum_{a|d,a|x}\\mu(a)g(\\frac{m}{xd})$$\n$$=\\sum_{a|x}\\mu(a)\\sum_{d=1}^\\frac{n}{ax}\\frac{n}{axd}\\mu(ad)g(\\frac{m}{axd})$$\n$$=\\sum_{a|x}\\mu^2(a)\\sum_{d=1}^\\frac{n}{ax}\\frac{n}{axd}\\mu(d)[a\\perp d]g(\\frac{m}{axd})$$\n$$=\\sum_{a=1}^x\\mu^2(a)F(ax,a)$$\n\u8fb9\u754c\u4e3a $a=1$ \u6216\u8005 $x>\\min(n,m)$\uff0c\u675c\u6559\u7b5b\u968f\u4fbf\u641e\u641e\u5c31\u53ef\u4ee5\u4e86\u3002\n## \u6cd5\u56db\uff1a\n\u6765\u81ea\u4e00\u4f4d\u5927\u4f6c\u7684\u795e\u4ed9\u505a\u6cd5\n\u8fd8\u662f\u8003\u8651\u8ba1\u7b97 $f(n,k)$ \uff0c\u4e0d\u8fc7\u8fd9\u6b21\u6211\u4eec\u8bbe\u7684\u662f\u4e00\u5143\u51fd\u6570\uff0c\u5373 $f(n)=\\sum_{i=1}^n\\mu(i)[i\\perp k]$\uff0c\u5f00\u59cb\u641e\u4e8b\u60c5\u3002\n\n$$f(n)=\\sum_{i=1}^n[i\\perp k]f(\\frac{n}{i})-\\sum_{i=2}^n[i\\perp k]f(\\frac{n}{i})$$\n\u8003\u8651\u5982\u4f55\u8ba1\u7b97 $\\sum_{i=1}^n[i\\perp k]f(\\frac{n}{i})$\n\n$$=\\sum_{i=1}^nf(\\frac{n}{i})=\\sum_{i=1}^n[i\\perp k]\\sum_{j=1}^\\frac{n}{i}[j\\perp k]\\mu(j)$$\n$$=\\sum_{i=1}^nf(\\frac{n}{i})=\\sum_{i=1}^n\\sum_{j=1}^\\frac{n}{i}[ij\\perp k]\\mu(j)$$\n$$\\sum_{T=1}^n[T\\perp k]\\sum_{d|T}\\mu(d)$$\n\u663e\u7136\uff0c\u540e\u9762\u90a3\u4e00\u5768\u53ea\u6709\u5728 $T=1$ \u65f6\u503c\u4e3a $1$\uff0c\u5176\u4ed6\u65f6\u5019\u503c\u4e3a $0$\uff0c\u4e8e\u662f\u5c31\u53d8\u6210\u4e86\n$$f(n)=1-\\sum_{i=2}^n[i\\perp k]f(\\frac{n}{i})$$\n\u6ce8\u610f\u5230\u540e\u9762\u90a3\u4e00\u5768\u8ddf $g$ \u6709\u5173\uff0c\u53ef\u4ee5\u5feb\u901f\u7b97\u51fa\uff0c\u4e8e\u662f\u675c\u6559\u7b5b\u5373\u53ef\u3002\n## \u6cd5\u4e94\uff1a\n\u521a\u624d\u6211\u4eec\u4e00\u76f4\u5728 $[i\\perp j]$ \u4e0a\u4e0b\u529f\u592b\uff0c\u6211\u4eec\u80fd\u4e0d\u80fd\u5728 $[j\\perp k]$ \u4e0a\u4e0b\u529f\u592b\u5462\uff1f\u5f53\u7136\u53ef\u4ee5\uff0c\u4e8e\u662f\u539f\u5f0f\n$$=\\sum_{i=1}^n\\sum_{j=1}^m[i\\perp j]\\sum_{d|k,d|j}\\mu(d)$$\n$$=\\sum_{d|k}\\mu(d)\\sum_{i=1}^n\\sum_{j=1}^\\frac{m}{d}[i\\perp jd]$$\n$$=\\sum_{d|k}\\mu(d)\\sum_{i=1}^n\\sum_{j=1}^\\frac{m}{d}[i\\perp j][i\\perp d]$$\n\u54a6\uff0c\u597d\u50cf\u2026\u2026\n\n\u6211\u4eec\u8bbe $\\displaystyle S(n,m,k)=\\sum_{i=1}^n\\sum_{j=1}^m[i\\perp j][j\\perp k]$\n\n\u90a3\u4e48\u5c31\u6709\n$$S(n,m,k)=\\sum_{d|k}\\mu(d)S(\\frac{m}{d},n,d)$$\n\u9012\u5f52\u8ba1\u7b97\u5373\u53ef\u3002\n## \u6cd5\u516d\uff1a\n\u521a\u624d\u6211\u4eec\u4e00\u76f4\u90fd\u53ea\u53cd\u6f14\u4e86\u4e00\u4e2a\uff0c\u80fd\u4e0d\u80fd\u540c\u65f6\u53cd\u6f14\u4e24\u4e2a\u5462\uff1f\u663e\u7136\u662f\u53ef\u4ee5\u7684\u3002\n\n\u5f0f\u5b50\u6bd4\u8f83\u677f\uff0c\u4e14\u548c\u7b2c\u4e00\u79cd\u76f8\u4f3c\uff0c\u8fc7\u7a0b\u8f83\u957f\uff0c\u7559\u7ed9\u8bfb\u8005\u81ea\u884c\u601d\u8003\u3002\n\n---\n\n~~\uff08\u5982\u679c\u4f60\u8fd8\u6709\u4ec0\u4e48\u65b0\u65b9\u6cd5\u53ef\u4ee5\u6765\u544a\u8bc9\u672c\u849f\u84bb\u54e6\uff09~~\n\nupdate 2021.7.15 \u7ea0\u6b63\u4e86 \ntommy0103 \u63d0\u51fa\u7684\u4e00\u4e2a\u9519\u8bef\n\nupdate 4.6 \u4fee\u6539\u4e86\u4e00\u5904\u5c0f\u9519\u8bef\uff08\u8bdd\u8bf4\u7adf\u7136\u6ca1\u6709\u4eba\u53d1\u73b0\uff09",
        "postTime": 1616237880,
        "uid": 99506,
        "name": "_LHF_",
        "ccfLevel": 0,
        "title": "\u3010\u5faa\u73af\u4e4b\u7f8e\u3011\u7684\u591a\u79cd\u89e3\u6cd5\u8be6\u89e3"
    },
    {
        "content": "\u5728\u535a\u5ba2\u56ed\u98df\u7528\u66f4\u4f73\uff1a[https://www.cnblogs.com/PinkRabbit/p/NOI2016D1T3.html](https://www.cnblogs.com/PinkRabbit/p/NOI2016D1T3.html)\u3002\n\n\u4e24\u4e2a\u6708\u4e4b\u524d\u505a\u7684\uff0c\u8fd8\u662f\u6709\u5fc5\u8981\u8865\u4e00\u4e0b\u535a\u5ba2\u3002\n\n### \u9898\u610f\u7b80\u8ff0\uff1a\n\n\u6c42\u5206\u5b50\u4e3a\u4e0d\u8d85\u8fc7 $n$ \u7684\u6b63\u6574\u6570\uff0c\u5206\u6bcd\u4e3a\u4e0d\u8d85\u8fc7 $m$ \u7684\u6b63\u6574\u6570\u7684\u6240\u6709\u4e92\u4e0d\u76f8\u7b49\u7684\u5206\u6570\u4e2d\uff0c\u6709\u591a\u5c11\u5728 $k$ \u8fdb\u5236\u4e0b\u7684\u7eaf\u5faa\u73af\u5c0f\u6570\u3002\n\n### \u9898\u89e3\uff1a\n\n\u8bbe\u5206\u5b50\u4e3a $x$\uff0c\u5206\u6bcd\u4e3a $y$\u3002\n\n\u9996\u5148\uff0c\u56e0\u4e3a\u8981\u6c42\u7684\u662f\u4e92\u4e0d\u76f8\u7b49\u7684\u5206\u6570\uff0c\u53d6\u6700\u7b80\u5206\u6570\uff0c\u5373 $x\\perp y$\u3002\n\n\u5176\u6b21\uff0c\u8981\u6c42\u662f\u7eaf\u5faa\u73af\u5c0f\u6570\uff0c\u8003\u8651\u7ad6\u5f0f\u9664\u6cd5\u7684\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u53d1\u73b0 $\\displaystyle\\frac{x}{y}$ \u5728 $k$ \u8fdb\u5236\u4e0b\u7eaf\u5faa\u73af\u76f8\u5f53\u4e8e\u5b58\u5728\u6b63\u6574\u6570 $l$ \u4f7f\u5f97 $x\\equiv x\\cdot k^l\\pmod{y}$\u3002\n\n\u7531\u4e8e $x\\perp y$\uff0c\u4e24\u8fb9\u7ea6\u53bb $x$ \u5f97\u5230 $k^l\\equiv 1\\pmod{y}$\uff0c\u663e\u7136\u5f53 $k$ \u5c5e\u4e8e $y$ \u7684\u7f29\u7cfb\u4e2d\u65f6\u53ef\u80fd\u6210\u7acb\uff0c\u5373 $y\\perp k$\u3002\n\n\u7efc\u4e0a\uff0c\u7b54\u6848\u4e3a $\\displaystyle\\sum_{i=1}^{n}\\sum_{j=1}^{m}[i\\perp j][j\\perp k]$\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u4ee5\u4e0b\u7528 $a\\div b$ \u8868\u793a $\\displaystyle\\left\\lfloor\\frac{a}{b}\\right\\rfloor$\u3002\u7b54\u6848\u4e3a\uff1a\n\n$$\\begin{aligned}\\mathbf{Ans}&=\\sum_{i=1}^{n}\\sum_{j=1}^{m}[i\\perp j][j\\perp k]\\\\&=\\sum_{i=1}^{n}\\sum_{j=1}^{m}\\sum_{d|i,d|j}\\mu(d)[j\\perp k]\\\\&=\\sum_{d=1}^{\\min(n,m)}\\mu(d)\\sum_{i=1}^{n\\div d}\\sum_{j=1}^{m\\div d}[jd\\perp k]\\\\&=\\sum_{d=1}^{\\min(n,m)}\\mu(d)(n\\div d)\\sum_{j=1}^{m\\div d}[j\\perp k][d\\perp k]\\\\&=\\sum_{d=1}^{\\min(n,m)}\\mu(d)[d\\perp k](n\\div d)S_{[x\\perp k]}(m\\div d)\\end{aligned}$$\n\n\u5176\u4e2d $S_{f}(n)$ \u8868\u793a $\\displaystyle\\sum_{i=1}^{n}f(i)$\u3002  \n$S_{[x\\perp k]}(n)=(n\\div k)\\varphi(k)+S_{[x\\perp k]}(n\\bmod k)$ \u53ef\u4ee5 $\\mathcal{O}(k)$ \u9884\u5904\u7406\uff0c$\\mathcal{O}(1)$ \u56de\u7b54\u8be2\u95ee\u3002\n\n\u5bf9\u5916\u5c42 $n\\div d$ \u548c $m\\div d$ \u8fdb\u884c\u6574\u9664\u5206\u5757\uff0c\u95ee\u9898\u8f6c\u5316\u4e3a\u8ba1\u7b97 $\\displaystyle\\sum_{i=1}^{n}\\mu(i)[i\\perp k]$\u3002\n\n\u8bbe $\\displaystyle S(n,k)=\\sum_{i=1}^{n}\\mu(i)[i\\perp k]$\uff0c\u5219\u6709\uff1a\n\n$$\\begin{aligned}S(n,k)&=\\sum_{i=1}^{n}\\mu(i)[i\\perp k]\\\\&=\\sum_{i=1}^{n}\\mu(i)\\sum_{d|i,d|k}\\mu(d)\\\\&=\\sum_{d|k}\\mu(d)\\sum_{i=1}^{n\\div d}\\mu(id)\\\\&=\\sum_{d|k}\\mu(d)\\sum_{i=1}^{n\\div d}\\mu(i)\\mu(d)[i\\perp d]\\\\&=\\sum_{d|k}\\mu^2(d)\\sum_{i=1}^{n\\div d}\\mu(i)[i\\perp d]\\\\&=\\sum_{d|k}\\mu^2(d)S(n\\div d,d)\\end{aligned}$$\n\n\u9012\u5f52\uff0c\u8bb0\u5fc6\u5316\u641c\u7d22\u5373\u53ef\u3002\u8fb9\u754c\uff1a$S(0,k)=0$ \u548c $\\displaystyle S(n,1)=\\sum_{i=1}^{n}\\mu(i)$ \u4f7f\u7528\u675c\u6559\u7b5b\u8ba1\u7b97\u3002\n\n\u590d\u6742\u5ea6\u5927\u7ea6\u4e3a $\\mathcal{O}\\left(n^{2/3}+\\sigma_0(k)\\sqrt{n}+k\\right)$\u3002\n\n```cpp\n#include <cstdio>\n#include <cmath>\n#include <algorithm>\n#include <map>\n\ntypedef long long LL;\nconst int MK = 2005;\nconst int S = 31622;\nconst int MN23 = 1000005;\nconst int MP = 78505;\nconst int MD = 25;\n\nint gcd(int a, int b) { return b ? gcd(b, a % b) : a; }\n\nbool ip[MN23];\nint p[MP], pc;\nint mu[MN23], Smu[MN23];\n\ninline void Init(int N) {\n\tmu[1] = 1;\n\tfor (int i = 2; i <= N; ++i) {\n\t\tif (!ip[i]) p[++pc] = i, mu[i] = -1;\n\t\tfor (int j = 1; j <= pc && p[j] * i <= N; ++j) {\n\t\t\tip[p[j] * i] = 1;\n\t\t\tif (i % p[j]) mu[p[j] * i] = -mu[i];\n\t\t\telse break;\n\t\t}\n\t}\n\tfor (int i = 1; i <= N; ++i) Smu[i] = Smu[i - 1] + mu[i];\n}\n\nint N, M, K, N23;\nint A[MK], Vl[MD], cd;\n\nstd::map<int, LL> mp[MD];\n\nLL Sum(int N, int K) {\n\tif (!N) return 0;\n\tif (K == 1 && N <= N23) return Smu[N];\n\tif (mp[K].count(N)) return mp[K][N];\n\tif (K > 1) {\n\t\tLL Ans = 0;\n\t\tfor (int j = 1; j <= K; ++j)\n\t\t\tif (Vl[K] % Vl[j] == 0 && mu[Vl[j]])\n\t\t\t\tAns += Sum(N / Vl[j], j);\n\t\treturn mp[K][N] = Ans;\n\t}\n\tLL Ans = 1;\n\tfor (int i = 2, j; i <= N; i = j + 1) {\n\t\tj = N / (N / i);\n\t\tAns -= (j - i + 1) * Sum(N / i, 1);\n\t}\n\treturn mp[1][N] = Ans;\n}\n\nLL Ans;\n\nint main() {\n\tscanf(\"%d%d%d\", &N, &M, &K);\n\tfor (int i = 1; i <= K; ++i) A[i] = A[i - 1] + (gcd(i, K) == 1);\n\tInit(N23 = std::max((int)pow(N, 2./3), K));\n\tfor (int i = 1; i <= K; ++i) if (K % i == 0 && (mu[i] || i == K)) Vl[++cd] = i;\n\tfor (int i = 1, kN, kM, j; i <= N && i <= M; i = j + 1) {\n\t\tkN = N / i, kM = M / i;\n\t\tj = std::min(N / kN, M / kM);\n\t\tAns = Ans + kN * ((LL)kM / K * A[K] + A[kM % K]) * (Sum(j, cd) - Sum(i - 1, cd));\n\t}\n\tprintf(\"%lld\\n\", Ans);\n\treturn 0;\n}\n```",
        "postTime": 1562697547,
        "uid": 10703,
        "name": "\u5c0f\u7c89\u5154",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P1587 \u3010[NOI2016]\u5faa\u73af\u4e4b\u7f8e\u3011"
    },
    {
        "content": "\u8fd9\u4e2a\u5199\u7684\u6bd4\u8f83\u8be6\u7ec6\uff0c\u6240\u4ee5\u770b\u4e0d\u61c2\u5176\u4ed6\u795e\u4ed9\u9898\u89e3\u7684\u53ef\u4ee5\u770b\u6211\u7684\n\n\u770b\u4e86\u9898\u89e3\u624d\u77e5\u9053\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u6709\u8fd9\u4e48\u4e00\u4e2anb\u7684\u6027\u8d28\u2026\u2026\n\n\u6211\u8fd8\u662f\u592a$naive$\u4e86\n\n\u7136\u540e\u81ea\u5df1\u778e\u641e\u2026\u2026\n\n\u8fd9\u9898\u76ee\u592a\u795e\u4ed9\u4e86\uff01\n\n\u539f\u5f0f\u7b49\u4ef7\u4e8e\u6c42\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m[gcd(j,k)==1][gcd(j,i)==1]$$\n\n~~\u8fd9\u4e2a\u5f88\u597d\u60f3\u7684\uff0c\u627e\u627e\u89c4\u5f8b\u5c31\u597d\u4e86\u5440~~\u7cbe\u9ad3\u5728\u63a8\u5bfc\u91cc\n\n\u7136\u540e\u4e0a\u5957\u8def\n\n\u7531\u4e8e\u662f$\\sum\\sum ab$\u5f62\u5f0f\u7684\uff0c\u4e0d\u597d\u770b\u4e5f\u4e0d\u597d\u62c6\uff0c\u6240\u4ee5\n\n\n$$\\Leftrightarrow \\sum_{j=1}^m\\sum_{i=1}^n[gcd(j,k)==1][gcd(j,i)==1]$$\n\n\u63d0\u4e00\u4e0b\n\n$$\\Leftrightarrow \\sum_{j=1}^m[gcd(j,k)==1]\\sum_{i=1}^n[gcd(j,i)==1]$$\n\n\u5de6\u8fb9$k$\u662f\u4e2a\u5b9a\u503c\uff0c\u6076\u5fc3\uff0c\u6240\u4ee5\u770b\u53f3\u8fb9\uff1a\n\n$$\\sum_{i=1}^n[gcd(j,i)==1]$$\n\n\u592a\u660e\u663e\u4e86\n\n$$=\\sum_{i=1}^n\\sum_{x|i,x|j}\\mu(x)$$\n\n$$\\text{\u8bbe}n>m$$\n\n$$\u2234\\Leftrightarrow \\sum_{i=1}^n\\sum_{x=1}^{n}\\mu(x)[x|i,x|j]$$\n\n$$\\Leftrightarrow \\sum_{x=1}^{n}\\mu(x)\\sum_{i=1}^n[x|i,x|j]$$\n\n\u7136\u540e\u548c\u5de6\u8fb9\u5408\u5e76\u4e00\u4e0b\n\n$$\\sum_{j=1}^m[gcd(j,k)==1]\\sum_{j=1}^m[gcd(j,i)==1]$$\n\n$$\\Leftrightarrow \\sum_{j=1}^m[gcd(j,k)==1]\\sum_{x=1}^{n}\\mu(x)\\sum_{i=1}^n[x|i,x|j]$$\n\n$$\\Leftrightarrow \\sum_{x=1}^{n}\\mu(x)\\sum_{i=1}^n\\sum_{j=1}^m[gcd(j,k)==1][x|i,x|j]$$\n\n\u4e0a\u5957\u8def\uff0c$\\text{\u8bbe}i=ix,j=jx$\n\n$$\u2234\\Leftrightarrow \\sum_{x=1}^{n}\\mu(x)\\sum_{i=1}^{\\frac nx}\\sum_{j=1}^{\\frac mx}[gcd(jx,k)==1]$$\n\n\u53f3\u8fb9$[gcd(ix,k)==1]\\Leftrightarrow [gcd(j,k)==1][gcd(x,k)==1]$\n\n$$\u2234\\Leftrightarrow \\sum_{x=1}^{n}[gcd(x,k)==1]\\mu(x)\\sum_{i=1}^{\\frac nx}\\sum_{j=1}^{\\frac mx}[gcd(j,k)==1]$$\n\n$i$\u662f\u65e0\u5173\u7d27\u8981\u7684\uff0c\u6254\u4e86\n\n$$\u2234\\Leftrightarrow \\sum_{x=1}^{n}\\lfloor{\\frac nx}\\rfloor[gcd(x,k)==1]\\cdot\\mu(x)\\sum_{j=1}^{\\frac mx}[gcd(j,k)==1]$$\n\n\u7136\u540e\uff1f\u5c31\u4e0d\u4f1a\u4e86\u3002\u3002\u3002\u3002\u3002\u3002\n\n$[gcd(j,k)==1]$\n\n\u60f3\u5230\u4e86\u4ec0\u4e48\uff1f\n\n\u6b27\u62c9\u51fd\u6570$\\varphi$\n\n~~\u6240\u4ee5\u5173\u952e\u65f6\u523b$\\varphi$\u8fd8\u662f\u78be\u538b\u4e00\u5207\u7684~~\n\n\u6839\u636e\u6b27\u62c9\u51fd\u6570\u7684\u6027\u8d28\n\n$$\\varphi(k)=\\sum_{i=1}^k[gcd(i,k)==1]$$\n\n\u7531\u4e8e$gcd(i,k)=gcd(i+k,k)$\n\n\u6240\u4ee5\u53ef\u4ee5\u628a$n$\u5207\u6210\u4e00\u4e9b\u957f\u5ea6\u4e3a$n$\u7684\u6bb5\uff0c\u6bcf\u4e00\u6bb5\u4e92\u8d28\u7684\u4e2a\u6570\u5c31\u662f$\\varphi(k)$\n\n\u8bbe\n$$f(i)=\\sum_{j=1}^{i}[gcd(j,k)==1]$$\n\n$$\u2234f(i)=(\\varphi(k)\\times \\lfloor\\frac ik\\rfloor)+f(i\\ mod\\ k)$$\n\n\u66b4\u529b\u6c42\u51fa$1$~$k-1$\u7684$f$\u503c\u5c31\u53ef\u4ee5$O(1)$\u6c42$f(i)$\u4e86\u3002\n\n\u5176\u5b9e$\\varphi(k)$\u5c31\u662f$f(k)$\n\n$\u2234\\Leftrightarrow \\sum_{x=1}^{n}\\lfloor{\\frac nx}\\rfloor f(\\lfloor\\frac mx\\rfloor)\\cdot[gcd(x,k)==1]\\mu(x)$\n\n\u8fd9\u65f6\u5019\u6211\u4eec\u53d1\u73b0\u53ef\u4ee5\u4e8c\u7ef4\u6574\u9664\u5206\u5757\u4e86\n\n\u524d\u9762\u8fd9\u4e24\u4e2a\u4e1c\u897f\u53ef\u4ee5$O(1)$\u6c42\uff0c\u8fd9\u65f6\u5019\u53ea\u9700\u8981\u6c42\u540e\u9762\u7684\u4e24\u4e2a\u4e1c\u897f\u7684\u524d\u7f00\u548c\u5c31\u597d\u4e86\n\n\u6211\u4eec\u8bbe\n\n$$\\lambda(i)=\\sum_{j=1}^{i}[gcd(j,k)==1]\\mu(j)$$\n\n\u53c8\u662f\u5957\u8def\n\n$$=\\sum_{j=1}^{i}\\sum_{y|j,y|k}\\mu(y)\\mu(j)$$\n\n$$\\Leftrightarrow \\sum_{j=1}^{i}\\sum_{y=1}^{k}\\mu(y)[y|j,y|k]\\mu(j)$$\n\n$$\\Leftrightarrow \\sum_{y=1}^{k}\\sum_{j=1}^{i}\\mu(y)[y|j,y|k]\\mu(j)$$\n\n$\\text{\u8bbe}j=jy$\n\n$$\u2234\\ =\\sum_{y=1}^{k}\\sum_{j=1}^{\\frac iy}\\mu(y)[y|k]\\mu(yj)$$\n\n$$\\Leftrightarrow \\sum_{y=1}^{k}\\mu(y)\\sum_{j=1}^{\\frac iy}[y|k]\\mu(yj)$$\n\n## \u6b64\u5904\u975e\u5e38\u795e\u4ed9\uff1a\n\n\u6839\u636e[\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u7684\u5b9a\u4e49](https://baike.baidu.com/item/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%87%BD%E6%95%B0/2567473)\uff0c\n\n$\\texttt{\u590d\u4e60\uff1a}$\n\n$\\texttt{\u5f53}\\ n\\ \\texttt{\u5b58\u5728\u5e73\u65b9\u56e0\u5b50\u65f6}\\ \u03bc(n)=0$\n\n$\\texttt{\u5f53}\\ n\\ \\texttt{\u662f\u7d20\u6570\u6216\u5947\u6570\u4e2a\u4e0d\u540c\u7d20\u6570\u4e4b\u79ef\u65f6}\\ \u03bc(n)=-1$\n\n$\\texttt{\u5f53}\\ n\\ \\texttt{\u662f\u5076\u6570\u4e2a\u4e0d\u540c\u7d20\u6570\u4e4b\u79ef\u65f6}\\ \u03bc(n)=1$\n\n$-----------------------$\n\n$\\mu(yj)!=0$\u5fc5\u6709$[gcd(y,j)==1]!!!!!!$\n\n\u6240\u4ee5$[gcd(y,j)!=1]$\u7684\u8bdd\u5bf9\u7b54\u6848\u5c31\u6ca1\u6709\u8d21\u732e\u4e86\n\n\u56e0\u6b64\u53ef\u4ee5\u4e58\u4e0a$[gcd(y,j)==1]$\n\n$$\u2234\\Leftrightarrow \\sum_{y=1}^{k}\\mu(y)\\sum_{j=1}^{\\frac iy}[y|k]\\mu(yj)[gcd(y,j)==1]$$\n\n\u7531\u4e8e\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u662f[\u79ef\u6027\u51fd\u6570](https://baike.baidu.com/item/%E7%A7%AF%E6%80%A7%E5%87%BD%E6%95%B0/8354949?fr=aladdin)\n\n\u6240\u4ee5\u6b64\u65f6\u53ef\u4ee5\u628a$\\mu(yj)$\u7ed9\u62c6\u6210$\\mu(y)\\times\\mu(j)$\n\n$$\u2234\\Leftrightarrow \\sum_{y=1}^{k}\\mu^2(y)\\sum_{j=1}^{\\frac iy}[y|k]\\mu(j)[gcd(y,j)==1]$$\n\n$k$\u592a\u5c0f\u4e86\uff0c\u6240\u4ee5\u53ef\u4ee5\u66b4\u529b\u679a\u4e3e\u56e0\u6570\u3002$[y|k]$\u63d0\u5230\u524d\u9762\n\n$$\\Leftrightarrow \\sum_{y|k}^{k}\\mu^2(y)\\ \\ \\sum_{j=1}^{\\frac iy}\\mu(j)[gcd(y,j)==1]$$\n\n\u7b49\u7b49\u6211\u4eec\u6c42\u7684\u662f\u4ec0\u4e48\uff1f\n\n\u662f$\\lambda(i)=\\sum_{j=1}^{i}[gcd(j,k)==1]\\mu(j)$\n\n\u540e\u9762\u7684\u4e1c\u897f\u597d\u50cf\u5c31\u662f$\\lambda(\\frac iy)!!$\n\n\u4e0d\u4e0d\u4e0d\uff0c$k$\u53d8\u6210$j$\u4e86\n\n\u6240\u4ee5\u6211\u4eec\u6539\u4e00\u4e0b\u5b9a\u4e49\u8bbe$\\lambda(i,k)=\\sum_{j=1}^{i}[gcd(j,k)==1]\\mu(j)$\n\n\u6240\u4ee5\u5c31\u4f1a\u51fa\u73b0$\\lambda(i,k)=\\sum_{y|k}^{k}\\mu^2(y)\\lambda(\\frac iy,y)!!!$\n\n\u8fd9\u597d\u50cf\u5c31\u53ef\u4ee5\u9012\u5f52\u8ba1\u7b97\u4e86qwq\n\n\u6240\u4ee5\u5229\u7528\u8bb0\u5fc6\u5316\u641c\u7d22\u5b8c\u6210\u9012\u5f52\uff0c\u5c31\u597d\u4e86\u5417\uff1f\n\n\u9012\u5f52\u8fb9\u754c\u662f$\\lambda(i,1)!$\n\n\u8fd9\u662f\u4ec0\u4e48\uff1f\n\n$$\\lambda(i,1)=\\sum_{j=1}^{i}[gcd(j,1)==1]\\mu(j)=\\sum_{j=1}^{i}\\mu(j)$$\n\n\u5c31\u662f\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u7684\u524d\u7f00\u548c\u5566\uff01\n\n\u7528\u53ef\u7231\u7684[\u675c\u6559\u7b5b](https://www.luogu.org/problemnew/show/P4213)\u5c31\u53ef\u4ee5\u4e86\uff01\uff01\uff01\n\n\u6211\u4eec\u4e8e\u662f\u5c31\u77e5\u9053\u4e86$\\lambda$\n\n\u91cd\u65b0\u770b\u4e00\u4e0b\u4e8c\u7ef4\u6574\u9664\u5206\u5757\u7684\u90a3\u4e2a\u5f62\u5f0f\n\n$$\u2234\\Leftrightarrow \\sum_{x=1}^{n}\\lfloor{\\frac nx}\\rfloor f(\\lfloor\\frac mx\\rfloor)\\cdot[gcd(x,k)==1]\\mu(x)$$\n\n\u524d\u9762\u8fd9\u4e24\u4e2a\u4e1c\u897f\u662f\u76f8\u540c\u7684\u63d0\u5230\u524d\u9762\u53bb\n\n\u540e\u9762\u8fd9\u4e2a\u4e1c\u897f\u6211\u4eec\u9700\u8981\u524d\u7f00\u548c\n\n\u8fd9\u5c31\u662f$\\lambda(x,k)$\n\n\u6240\u4ee5\u8fd9\u9053\u9898\u76ee\u5c31\u597d\u4e86\u3002\n\n\u6574\u9664\u5206\u5757\u90e8\u5206\uff1a\n```\nfor (int l=1,r;l<=min(n,m);l=r+1){\n    r=min(n/(n/l),m/(m/l));//\u4e8c\u7ef4\n    ans+=(long long)*(lambda(r,k)-lambda(l-1,k)/*\u524d\u7f00\u548c*/)*(n/l)*F(m/l)/*f\u51fd\u6570*/;\n}\n```\n\n\u5b8c\u6574\u4ee3\u7801\uff1a\n```\n#include<bits/stdc++.h>\n#define ll long long\n#define maxn 1000000\nusing namespace std;\nint vis[2000001],cnt,p[2000001];\nll mu[2000001],n,m,k,smu[2000001],f[20001];\nmap<ll,ll> dlm;\nmap<pair<ll,ll>,ll> ANS;\nvoid get(int n){//\u6b27\u62c9\u7b5b\n    mu[1]=1;\n    for (register int i=2;i<=n;i++){\n        if (!vis[i]){\n            p[++cnt]=i;mu[i]=-1;\n        }\n        for (int j=1;i*p[j]<=n&&j<=cnt;j++){\n            vis[i*p[j]]=1;\n            if (i%p[j]==0) break;\n            mu[i*p[j]]=-mu[i];\n        }\n    }\n    for (register int i=1;i<=n;i++){\n        smu[i]=mu[i]+smu[i-1];\n    }\n}\nll gcd(ll a,ll b){\n    if (b==0) return a;\n    return gcd(b,a%b);\n}\nll mus(ll n){//\u675c\u6559\u7b5b\n    if (n<=maxn) return smu[n];\n    if (dlm[n]) return dlm[n];\n    ll ans=1;\n    for (register ll l=2,r;l<=n;l=r+1){\n        r=n/(n/l);\n        ans-=1LL*(r-l+1)*mus(n/l);\n    }\n    return dlm[n]=ans;\n}\ninline void f_init(int k){//\u66b4\u529b\u679a\u4e3e\u8ba1\u7b97\u6570\u7ec4f\n     for (int i=1;i<=k;i++){\n         f[i]=f[i-1];\n         if (gcd(i,k)==1) f[i]++;\n     }\n}\ninline ll F(ll x){\n    return f[k]*(x/k)+f[x%k];\n}\nll lambda(ll x,ll k){\n    if (x==0) return 0;\n    if (x==1) return 1;\n    if (k==1) return mus(x);\n    if (ANS[make_pair(x,k)]) return ANS[make_pair(x,k)];//\u7528map\u548cpair\u8bb0\u5fc6\u5316\u641c\u7d22\n    ll ans=0;\n    for (ll i=1;i*i<=k;i++){\n        if (k%i) continue;\n        if (1LL*i*i==k){\n            ans+=1LL*lambda(x/i,i)*mu[i]*mu[i];\n        }else{\n            ans+=1LL*lambda(x/(k/i),k/i)*mu[k/i]*mu[k/i]+lambda(x/i,i)*mu[i]*mu[i];//\u9012\u5f52\n        }\n    }\n    return ANS[make_pair(x,k)]=ans;\n}\nint main(){\n    cin>>n>>m>>k;\n    get(maxn);\n    f_init(k);\n    ll Ans=0;\n    for (ll l=1,r;l<=min(n,m);l=r+1){\n        r=min(n/(n/l),m/(m/l));\n        Ans+=1LL*(lambda(r,k)-lambda(l-1,k))*(n/l)*F(m/l);\n    }\n    cout<<Ans<<endl;\n}\n```\n\n\u7136\u540e\u4f60\u53d1\u73b0\uff0c\u4f60\n# TLE\u4e86\n\n\u6240\u4ee5\u4f60\u9700\u8981\u5361\u5e38\n\n\u6709$1$\u4e2a\u5361\u5e38\u7684\u7a7a\u95f4\uff1a\n\n\u9012\u5f52\u7b97$\\lambda$\u7684\u5730\u65b9,\u5982\u679c$\\mu[i]=0$\u5c31\u4e0d\u9700\u8981\u9012\u5f52\u4e86\n\n\u7136\u540e\u5c31\u6109\u5feb\u7684$A$\u4e86\u6b64\u9898\n\n\u5361\u5e38\u540e\u7684\u6c42$\\lambda$\n```\nll lambda(ll x,ll k){\n    if (x==0) return 0;\n    if (x==1) return 1;\n    if (k==1) return mus(x);\n    if (ANS[make_pair(x,k)]) return ANS[make_pair(x,k)];\n    ll ans=0;\n    for (ll i=1;i*i<=k;i++){\n        if (k%i) continue;\n        if (1LL*i*i==k){\n            ans+=1LL*lambda(x/i,i)*mu[i]*mu[i];\n        }else{\n            if (mu[k/i]) ans+=1LL*lambda(x/(k/i),k/i)*mu[k/i]*mu[k/i];\n            if (mu[i]) ans+=1LL*lambda(x/i,i)*mu[i]*mu[i];\n        }\n    }\n    return ANS[make_pair(x,k)]=ans;\n}\n```",
        "postTime": 1546698103,
        "uid": 20309,
        "name": "Fading",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P1587 \u3010[NOI2016]\u5faa\u73af\u4e4b\u7f8e\u3011"
    },
    {
        "content": "[~~\u83b7\u5f97\u66f4\u5dee\u7684\u9605\u8bfb\u4f53\u9a8c~~](https://ignotusjee.github.io/post/luo-gu-1587-noi2016xun-huan-zhi-mei-ti-jie/)\n\n# \u9898\u610f\uff1a\n\n\u7ed9\u5b9a$n,m,k$,\u6c42\u5bf9\u4e8e$1\\le x \\le n,1\\le y\\le m$\uff0c$\\frac{x}{y}$\u6ee1\u8db3\u6570\u503c\u4e0a\u4e92\u4e0d\u76f8\u7b49\u4e14\u5728$k$\u8fdb\u5236\u4e0b\u4e3a\u7eaf\u5faa\u73af\u5c0f\u6570\u7684\u4e2a\u6570\u3002\n\n\u4ece\u5c0f\u6570\u90e8\u5206\u7b2c\u4e00\u4f4d\u5f00\u59cb\u7684\u5faa\u73af\u5c0f\u6570\uff0c\u79f0\u4e3a\u7eaf\u5faa\u73af\u5c0f\u6570\u3002\u7279\u522b\u5730\uff0c\u6574\u6570\u4e3a\u7eaf\u5faa\u73af\u5c0f\u6570\u3002\n\n# \u89e3\u6cd5\uff1a\n\n\n\n\u8981\u6ee1\u8db3\u6570\u503c\u4e0a\u4e92\u4e0d\u76f8\u7b49\uff0c\u53ea\u9700\u7edf\u8ba1\u6700\u7b80\u5206\u6570\uff0c\u5373$x\\perp y$\u5373\u53ef\u3002\n\n\u63a5\u4e0b\u6765\u8981\u5224\u5b9a\u7eaf\u5faa\u73af\u5c0f\u6570\u3002\n\n* \u5f15\u7406\uff1a$\\frac{x}{y},(x\\perp y)$\u5728$k$\u8fdb\u5236\u4e0b\u662f\u5faa\u73af\u5c0f\u6570\u5f53\u4e14\u4ec5\u5f53$y\\perp k$\n\n\u8bc1\u660e\uff1a\n\n\u8bbe$\\frac{x}{y}$\u4e3a\u7eaf\u5faa\u73af\u6700\u7b80\u5c0f\u6570\uff0c\u5728$k$\u8fdb\u5236\u4e0b\u5176\u5faa\u73af\u8282\u957f\u4e3a$l$\u3002\n\n\u7531\u7eaf\u5faa\u73af\u5c0f\u6570\u5b9a\u4e49\u53ef\u77e5$\\frac{x}{y}k^l-\\frac{x}{y}=\\frac{x}{y}\\left(k^l-1\\right)\\in Z$\uff08$Z$\u4e3a\u6574\u6570\u96c6\uff09\u3002\n\n\u53c8$x\\perp y$\uff0c\u5219$y|\\left(k^l-1\\right)$\u3002\n\n\u63a5\u4e0b\u6765\u53cd\u8bc1\u3002\u5047\u8bbe$y\\not\\perp k$\u3002\u56e0\u4e3a\u6709$k^l \\not\\perp \\left(k^l-1\\right)$\uff0c\u5373$k\\not\\perp \\left(k^l-1\\right)$\uff0c\u53ef\u63a8\u51fa$y\\not \\perp \\left(k^l-1\\right)$\uff0c\u4e0e\u4e0a\u6587\u7ed3\u8bba\u77db\u76fe\u3002\n\n\u8bc1\u6bd5\u3002\n\n\u4e8e\u662f\uff0c\u95ee\u9898\u8f6c\u5316\u4e3a\u4e86\u6c42$\\sum_{x=1}^n\\sum_{y=1}^m\\left[x\\perp y\\right]\\left[y\\perp k\\right]$\u3002\n\n\u53cd\u6f14\u5e76\u6539\u53d8\u679a\u4e3e\u987a\u5e8f\u53ef\u5f97\n$$\n\\sum_{x=1}^n\\sum_{y=1}^m\\left[x\\perp y\\right]\\left[y\\perp k\\right]\n$$\n$$\n=\\sum_{x=1}^n\\sum_{y=1}^m\\left[y\\perp k\\right]\\sum_{d|x,d|y}\\mu(d)\n$$\n$$\n=\\sum_{d=1}^{min(n,m)}\\mu(d)\\left[d\\perp k\\right]\\lfloor\\frac{n}{d}\\rfloor\\sum_{y=1}^{\\lfloor\\frac{m}{d}\\rfloor}\\left[y\\perp k\\right]\n$$\n\n\u8bbe$f\\left(n,k\\right)=\\sum_{i=1}^n\\left[i\\perp k\\right],g\\left(n,k\\right)=\\sum_{i-1}^n\\mu(i)\\left[i\\perp k\\right]$\uff0c\u5219$\\sum_{x=1}^n\\sum_{y=1}^m\\left[x\\perp y\\right]\\left[y\\perp k\\right]=\\sum_{d=1}^{min(n,m)}\\mu(d)\\left[d\\perp k\\right]\\lfloor\\frac{n}{d}\\rfloor f\\left(\\lfloor\\frac{m}{d}\\rfloor,k\\right)$\n\n\u56e0\u4e3a\u7d20\u56e0\u5b50\u7684\u6b21\u6570\u4e0e\u5176\u4ed6\u6570\u4e0e\u5b83\u662f\u5426\u4e92\u8d28\u65e0\u5173,\u4e0d\u59a8\u8bbe$k$\u65e0\u5b8c\u5168\u5e73\u65b9\u56e0\u5b50\uff08\u82e5\u6709\u5c06\u5176\u9664\u6389\uff09\u3002\u8bbe$p$\u4e3a$k$\u7684\u4e00\u4e2a\u8d28\u56e0\u5b50\uff0c\u5219\u5bf9\u4e8e$f$\u6709\n$$\nf(n,1)=\\sum_{i=1}^n1=n,\n$$\n$$\nf(n,k)=\\sum_{i=1}^n\\left[i\\perp k\\right]=\\sum_{i=1}^n\\left[i\\perp \\frac{k}{p}\\right]-\\sum_{i=1}^n\\left[i\\perp \\frac{k}{p}\\right]\\left[p|i\\right]\n$$\n$$\n=f\\left(i,\\frac{k}{p}\\right)-\\sum_{i=1}^{\\lfloor\\frac{n}{p}\\rfloor}\\left[ip\\perp \\frac{k}{p}\\right]=f\\left(i,\\frac{k}{p}\\right)-\\sum_{i=1}^{\\lfloor\\frac{n}{p}\\rfloor}\\left[i\\perp \\frac{k}{p}\\right]\n$$\n$$=f\\left(i,\\frac{k}{p}\\right)-f\\left(\\lfloor\\frac{n}{p}\\rfloor,\\frac{k}{p}\\right),\\qquad \\left(p|k,p\\in P\\right)\n$$\n\n\u5bf9\u4e8e$g$\u6709\uff1a\n\n$$\ng\\left(n,1\\right)=\\sum_{i=1}^n\\mu(i),\n$$\n$$\ng\\left(n,k\\right)=\\sum_{i=1}^n\\mu(i)\\left[i\\perp k\\right]=\\sum_{i=1}^n\\mu(i)\\left[i\\perp \\frac{k}{p}\\right]-\\sum_{i=1}^n\\mu(i)\\left[i\\perp \\frac{k}{p}\\right]\\left[p|i\\right]\n$$\n$$\n=g\\left(n,\\frac{k}{p}\\right)-\\sum_{i=1}^{\\lfloor\\frac{n}{p}\\rfloor}\\mu(ip)\\left[ip\\perp \\frac{k}{p}\\right]\n$$\n$$\n=g\\left(n,\\frac{k}{p}\\right)-\\sum_{i=1}^{\\lfloor\\frac{n}{p}\\rfloor}\\mu(i)\\mu(p)\\left[i\\perp p\\right]\\left[i\\perp \\frac{k}{p}\\right]\n$$\n$$\n=g\\left(n,\\frac{k}{p}\\right)-\\mu(p)\\sum_{i=1}^{\\lfloor\\frac{n}{p}\\rfloor}\\mu(i)\\left[i\\perp k\\right]\n$$\n$$\n=g\\left(n,\\frac{k}{p}\\right)+g\\left(\\lfloor\\frac{n}{p}\\rfloor,k\\right)\\qquad \\left(p|k,p\\in P\\right)\n$$\n$$\n\\left(\\quad \\mu(p)=-1 \\quad \\right)\n$$\n\n\u4ee5\u4e0a$P$\u4e3a\u8d28\u6570\u96c6\uff0c\u5229\u7528\u4e86\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u7684\u6027\u8d28$\\mu(ab)=\\mu(a)\\mu(b)\\left[a\\perp b\\right]$\n\n\u4e8e\u662f\uff0c\u5bf9\u4e8e$k=1$\u7684\u60c5\u51b5\uff0c$f$\u53ef$O(1)$\u6c42\u89e3\uff0c$g$\u4f7f\u7528\u675c\u6559\u7b5b\u5373\u53ef\u3002\n\n\u5bf9\u4e8e$k>1$\u7684\u60c5\u51b5\uff0c\u9012\u5f52\u6c42\u89e3\u5373\u53ef\u3002\n\n\u6700\u540e\u6570\u8bba\u5206\u5757\u5373\u53ef\u6c42\u89e3\u3002\u9012\u5f52\u90e8\u5206\u65f6\u95f4\u590d\u6742\u5ea6$O\\left(\\sqrt n\\frac{logk}{loglogk}\\right)$\uff0c\u675c\u6559\u7b5b\u90e8\u5206\u65f6\u95f4\u590d\u6742\u5ea6$O(n^{\\frac{2}{3}})$\u3002\n\n\u601d\u8def\u6765\u81ea\u4e8e11Dimensions\u3002\n\n# \u4ee3\u7801\uff1a\n\n```cpp\n#include <cstdio>\n#include <cctype>\n#include <cstring>\n#include <unordered_map>\n#define R register int\nusing std::unordered_map;\n\nnamespace quick {\n#define tp template<typename Type>\n\tnamespace in {\n\t\tinline char getc() {\n\t\t\tstatic char buf[1<<21],*p1=buf,*p2=buf;\n\t\t\treturn p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++;\n\t\t}\n\t\tinline int read(char *s) {\n\t\t\t*s=getc();\n\t\t\twhile(isspace(*s)) {*s=getc();if(*s==EOF) return 0;}\n\t\t\twhile(!isspace(*s)&&*s!=EOF) {s++;*s=getc();}\n\t\t\t*s='\\0'; return 1;\n\t\t}\n\t\ttp inline int read(Type &x) {\n\t\t\tx=0;bool k=false;char c=getc();\n\t\t\twhile(!isdigit(c)) {k|=(c=='-');c=getc();if(c==EOF) return 0;}\n\t\t\twhile(isdigit(c)) {x=(x<<1)+(x<<3)+(c^48);c=getc();}\n\t\t\tx*=(k?-1:1); return 1;\n\t\t}\n\t\ttemplate <typename Type,typename... Args>\n\t\tinline int read(Type &t,Args &...args) {\n\t\t\tint res=0;\n\t\t\tres+=read(t);res+=read(args...);\n\t\t\treturn res;\n\t\t}\n\t}\n\tusing in::read;\n\tnamespace out {\n\t\tchar buf[1<<21];int p1=-1;const int p2=(1<<21)-1;\n\t\tinline void flush() {\n\t\t\tfwrite(buf,1,p1+1,stdout);\n\t\t\tp1=-1;\n\t\t}\n\t\tinline void putc(const char &c) {\n\t\t\tif(p1==p2) flush();\n\t\t\tbuf[++p1]=c;\n\t\t}\n\t\tinline void write(char *s) {\n\t\t\twhile(*s!='\\0') putc(*s),s++;\n\t\t}\n\t\tinline void write(const char *s) {\n\t\t\twhile(*s!='\\0') putc(*s),s++;\n\t\t}\n\t\ttp inline void write(Type x) {\n\t\t\tstatic char buf[30];int p=-1;\n\t\t\tif(x<0) {putc('-');x=-x;}\n\t\t\tif(x==0) putc('0');\n\t\t\telse for(;x;x/=10) buf[++p]=x%10+48;\n\t\t\tfor(;p!=-1;p--) putc(buf[p]);\n\t\t}\n\t\tinline void write(const char &c) {putc(c);}\n\t\ttemplate <typename Type,typename... Args>\n\t\tinline void write(Type t,Args ...args) {\n\t\t\twrite(t);write(args...);\n\t\t}\n\t}\n\tusing out::write;\n\tusing out::flush;\n\ttp inline Type max(const Type &a,const Type &b) {\n\t\tif(a<b) return b;\n\t\treturn a;\n\t}\n\ttp inline Type min(const Type &a,const Type &b) {\n\t\tif(a<b) return a;\n\t\treturn b;\n\t}\n\ttp inline void swap(Type &a,Type &b) {\n\t\ta^=b^=a^=b;\n\t}\n\ttp inline Type abs(const Type &a) {\n\t\treturn a>=0?a:-a;\n\t}\n#undef tp\n}\nusing namespace quick;\n\ntypedef long long ll;\nconst int maxn=1e6+20,limit=1e6,inf=0x3f3f3f3f;\nint n,m,k;\n\nint mu[maxn];//g\u7684\u7b2c\u4e00\u7ef4\nint prime[maxn],cnt,pk[maxn],tot;\nvoid Init(int &k) {\n\tstatic char not_prime[maxn];\n\tmu[1]=1;\n\tfor(R i(2);i<=limit;i++) {\n\t\tif(~not_prime[i]) prime[cnt++]=i,mu[i]=-1;\n\t\tfor(R j(0);j<cnt&&prime[j]<=limit/i;j++) {\n\t\t\tnot_prime[i*prime[j]]=0xff;\n\t\t\tif(i%prime[j]==0) break;\n\t\t\tmu[i*prime[j]]=-mu[i];\n\t\t}\n\t}\n\tfor(R i(1);i<=limit;i++) mu[i]+=mu[i-1];\n\tfor(R i(0);i<cnt&&prime[i]<=k;i++) {\n\t\twhile(k%(prime[i]*prime[i])==0) k/=prime[i];\n\t\tif(k%prime[i]==0) pk[tot++]=prime[i];\n\t}\n}\n#define f1(i) i\n#define g1(i) mu[i]\nunordered_map<int,ll> G1;\nll GetG1(const int &n) {\n\tif(n<=limit) return g1(n);\n\tif(G1[n]) return G1[n];\n\tll ans=1;\n\tfor(R i(2),j;i<=n;i=j+1) {\n\t\tj=n/(n/i);\n\t\tans-=(ll)(j-i+1)*GetG1(n/i);\n\t}\n\treturn G1[n]=ans;\n}\n\nunordered_map <int,unordered_map <int,ll> > F,G;\nll f(const int &n,const int &k,const int &now=0) {\n\tif(!n) return 0;\n\tif(k==1) return ll(f1(n));\n\tif(F[n][k]) return F[n][k];\n\treturn F[n][k]=f(n,k/pk[now],now+1)-f(n/pk[now],k/pk[now],now+1);\n}\n\nll g(const int &n,const int &k,const int &now=0) {\n\tif(!n) return 0;\n\tif(k==1) return GetG1(n);\n\tif(G[n][k]) return G[n][k];\n\treturn G[n][k]=g(n,k/pk[now],now+1)+g(n/pk[now],k,now);\n}\n\nint main(void) {\n#ifndef ONLINE_JUDGE\n\tfreopen(\"bea.in\",\"r\",stdin);\n#endif\n\tread(n,m,k);\n\tInit(k);\n\tll ans=0;\n\tfor(R i(1),j;i<=n&&i<=m;i=j+1) {\n\t\tj=min(n/(n/i),m/(m/i));\n\t\tans+=(ll)(g(j,k)-g(i-1,k))*(n/i)*f(m/i,k);\n\t}\n\twrite(ans,'\\n');\n\tflush();\n\treturn 0;\n}\n\n```\n\n\n~~\u6ce8\u610fn\u548cm\u4e0d\u8981\u4ea4\u6362\uff0c\u6211\u5c31\u662f\u56e0\u4e3a\u8fd9\u4e2a\u8c03\u4e86\u4e00\u4e0a\u5348~~\n\n~~\u8bdd\u8bf4\u4f60\u8c37latex\u600e\u4e48\u4e0d\u652f\u6301\u6362\u884c\u554a~~",
        "postTime": 1598000427,
        "uid": 226485,
        "name": "\u67f3\u82cf\u660e",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1587 \u3010[NOI2016]\u5faa\u73af\u4e4b\u7f8e\u3011"
    },
    {
        "content": "### P1587 [NOI2016]\u5faa\u73af\u4e4b\u7f8e\n\n\u9898\u76ee\u5927\u610f\uff1a\n\n\u200b\t\u7ed9\u5b9an\uff0cm\uff0ck\u3002\u6c42$K$\u8fdb\u5236\u4e0b\u65e2\u7ea6\u5206\u6570$\\frac{x}{y}(1\\leq x\\leq n, 1\\leq y\\leq m)$\u4e14\u4e3a\u7eaf\u5faa\u73af\u5c0f\u6570\u7684\u4e2a\u6570\u3002\n\n\u9898\u89e3\uff1a\n\n\u9996\u5148\u662f\u5224\u65ad\u5206\u6570$\\displaystyle \\frac{x}{y}$\u662f\u5426\u4e3a\u7eaf\u5faa\u73af\u5c0f\u6570\u7684\u65b9\u6cd5\uff0c\n\n\u6839\u636e**\u6253\u8868**\u53ef\u4ee5\u5f97\u5230\u7ed3\u8bba\uff1a\n\n\u200b\t$K$\u8fdb\u5236\u4e0b\uff0c$\\displaystyle \\frac{x}{y}$\u4e3a\u7eaf\u5faa\u73af\u5c0f\u6570\u5f53\u4e14\u4ec5\u5f53$y$\u4e0e$k$\u4e92\u8d28\u3002\n\n\u8bc1\u660e\uff1a\n\n$K$\u8fdb\u5236\u4e0b\uff0c$\\displaystyle \\frac{x}{y}$\u4e3a\u7eaf\u5faa\u73af\u5c0f\u6570\uff0c\u5219\u6709\n$$\nx*k^l\\equiv x(mod\\ y)(l \\neq 0)\n$$\n\u4e24\u8fb9\u540c\u9664$x$.\n$$\nk^l\\equiv1(mod\\ y)\n$$\n\u5f97$k, y$\u4e92\u8d28\u3002\n\n\u8bc1\u6bd5\u3002\n\n\u9898\u76ee\u8f6c\u5316\u4e3a\u6c42\n$$\n\\displaystyle \\sum_{x=1}^{n} \\displaystyle \\sum_{y=1}^{m}[gcd(x, y)==1][gcd(y, k)==1]\n$$\n\n$$\n\\displaystyle \\sum_{x=1}^{n} \\displaystyle \\sum_{y=1}^{m}[gcd(y, k)==1][gcd(x, y)==1]\n$$\n\n\n\n\u66f4\u6362\u679a\u4e3e\u987a\u5e8f\n$$\n\\displaystyle \\sum_{y=1}^{m}[gcd(y, k)==1]\\displaystyle \\sum_{x=1}^{n} [gcd(x, y)==1]\n$$\n\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5f97\n$$\n\\displaystyle \\sum_{y=1}^{m}[gcd(y, k)==1]\\displaystyle \\sum_{x=1}^{n} \\displaystyle \\sum_{d|gcd(x, y)}\\mu(d)\n$$\n\u679a\u4e3e\u7ea6\u6570$d$\u5f97\n$$\n\\displaystyle \\sum_{d=1}^{n}\\mu(d) \\displaystyle \\sum_{d|x}^{n} \\displaystyle \\sum_{d|y}^{m}[gcd(y,k)==1]\n$$\n\n$$\n\\displaystyle \\sum_{d=1}^{n}[gcd(d,k)==1]\\mu(d) \\displaystyle \\sum_{x=1}^{\\displaystyle \\displaystyle \\lfloor\\frac{n}{d}\\displaystyle \\rfloor} \\displaystyle \\sum_{y=1}^{\\displaystyle \\displaystyle \\lfloor \\frac{m}{d}\\displaystyle \\rfloor}[gcd(y,k)==1]\n$$\n\n$$\n\\displaystyle \\sum_{d=1}^{n}[gcd(d,k)==1]\\mu(d) \\displaystyle \\displaystyle \\lfloor \\frac{n}{d} \\displaystyle \\rfloor \\displaystyle \\sum_{y=1}^{\\displaystyle \\displaystyle \\lfloor \\frac{m}{d}\\displaystyle \\rfloor}[gcd(y,k)==1]\n$$\n\n\u4ee4$f(x)=\\displaystyle \\sum_{i=1}^{x}[gcd(i,k)==1],s(x,k)=\\displaystyle \\sum_{i=1}^{x}[gcd(i,k)==1]\\mu(i)$.\n\n\u8003\u8651\u6c42$f(x)$\uff0c\u82e5$i$\u4e0e$k$\u4e92\u8d28\uff0c\u5219\u6709$i+k$\u4e0e$k$\u4e92\u8d28\u3002\n\n\u6240\u4ee5\n$\nf(x)=\\lfloor \\frac{x}{k}\\displaystyle \\rfloor f(k) + f(x\n$\n%\n$\nk)\n$\n\n\u9884\u5904\u7406$f(x)$\u6ee1\u8db3$1\\leq x\\leq k$\u7684$f(x)$,\u5269\u4e0b\u7684\u9012\u5f52\u5904\u7406\u5373\u53ef\u3002\n\n\u8003\u8651\u6c42$s(x, k)$.\n$$\ns(x,k)=\\sum_{i=1}^{x}[gcd(i,k)==1]\\mu(i)\n$$\n$$\n=\\sum_{i=1}^{x}\\mu(i)[gcd(i,k)==1]\n$$\n$$\n=\\sum_{i=1}^{x}\\mu(i)\\sum_{d|gcd(i,k)}\\mu(d)\n$$\n$$\n=\\sum_{i=1}^{x}\\mu(i)\\sum_{d|i,d|k}\\mu(d)\n$$\n$$\n=\\sum_{d|k}\\mu(d)\\sum_{d|i}\\mu(i)\n$$\n$$\n=\\sum_{d|k}\\mu(d)\\sum_{i=1}^{\\lfloor\\frac{x}{d}\\rfloor}\\mu(i*d)\n$$\n\u82e5$gcd(i,d)\\neq 1$\u65f6\uff0c$\\mu(i*d)=0$\uff0c\u5bf9\u7b54\u6848\u6ca1\u6709\u8d21\u732e.\n\n\u7531\u79ef\u6027\u51fd\u6570\u7684\u6027\u8d28$f(ab)=f(a)*f(b)$\u5f97\n$$\n=\\sum_{d|k}\\mu(d)\\sum_{i=1}^{\\lfloor \\frac{x}{d}\\rfloor}[gcd(i,d)==1]\\mu(i)\\mu(d)\n$$\n$$\n=\\sum_{d|k}\\mu(d)^2\\sum_{i=1}^{\\lfloor \\frac{x}{d}\\rfloor}[gcd(i,d)==1]\\mu(i)\n$$\n$$\n=\\sum_{d|k}\\mu(d)^2\\sum_{i=1}^{\\lfloor \\frac{x}{d}\\rfloor}[gcd(i,d)==1]\\mu(i)\n$$\n$$\n=\\sum_{d|k}\\mu(d)^2*s(\\lfloor \\frac{x}{d}\\rfloor,d)\n$$\n\u9012\u5f52\u5904\u7406\u5373\u53ef\u3002\n\n\u4f46\u5f53$k=1$\u65f6\uff0c$s(x,k)$\u7684\u503c\u65e0\u6cd5\u901a\u8fc7\u9012\u5f52\u5f97\u51fa\u3002\n\n\u8003\u8651$k=1$\u7684\u60c5\u51b5\uff0c\n$$\ns(x,1)=\\sum_{i=1}^{x}[gcd(i,1)==1]\\mu(i)\n$$\n$$\n=\\sum_{i=1}^{x}\\mu(i)\n$$\n\u7531\u4e8e$1\\leq x\\leq 1e8$\uff0c\u675c\u6559\u7b5b\u6c42\u524d\u7f00\u548c\u5373\u53ef\u3002\n\n\u9898\u76ee\u4e2d\u6240\u6c42\u7684\n$$\nans=\\displaystyle \\sum_{d=1}^{n}[gcd(d,k)==1]\\mu(d) \\displaystyle \\displaystyle \\lfloor \\frac{n}{d} \\displaystyle \\rfloor \\displaystyle \\sum_{y=1}^{\\displaystyle \\displaystyle \\lfloor \\frac{m}{d}\\displaystyle \\rfloor}[gcd(y,k)==1]\n$$\n\u6574\u9664\u5206\u5757\u5904\u7406\u3002\n\ncode\uff1a\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <map>\n#include <algorithm>\n#define int long long\nusing namespace std;\nconst int N = 1e6 + 5;\nint read() {\n\tint x = 0, f = 1; char ch;\n\twhile(! isdigit(ch = getchar())) (ch == '-') && (f = -f);\n\tfor(x = ch ^ 48; isdigit(ch = getchar()); x = (x << 3) + (x << 1) + (ch ^ 48));\n\treturn x * f;\n}\nmap <pair <int, int>, int> mp;\nint n, m, K, ans;\nint tot, gcd_k[N], f[N], mu[N], Smu[N], vis[N], pri[N];\nvoid init() {\n\tfor(int i = 1; i <= K; ++ i) gcd_k[i] = __gcd(i, K) == 1;\n\tfor(int i = 1; i <= K; ++ i) f[i] = f[i - 1] + gcd_k[i];\n\tmu[1] = 1;\n\tfor(int i = 2; i < N; ++ i) {\n\t\tif(! vis[i]) pri[++ tot] = i, mu[i] = -1;\n\t\tfor(int j = 1; j <= tot && i * pri[j] < N; ++ j) {\n\t\t\tvis[i * pri[j]] = 1;\n\t\t\tif(i % pri[j] == 0) break;\n\t\t\tmu[i * pri[j]] = - mu[i];\n\t\t}\n\t}\n\tfor(int i = 1; i < N; ++ i) Smu[i] = Smu[i - 1] + mu[i];\n}\nint Sf(int x) {\n\treturn (x / K) * f[K] + f[x % K];\n}\nint Ss(int x, int k){\n\tif((k == 1 && x <= N) || x == 0) return Smu[x];\n\tif(mp[make_pair(x, k)]) return mp[make_pair(x, k)];\n\tint res = 0;\n\tif(k == 1) {\n\t\tres = 1;\n\t\tfor(int i = 2, j; i <= x; i = j + 1) {\n\t\t\tj = x / (x / i);\n\t\t\tres -= (j - i + 1) * Ss(x / i, k);\n\t\t}\n\t}\n\telse {\n\t\tfor(int i = 1; i * i <= k; ++ i) {\n\t\t\tif(k % i) continue;\n\t\t\tif(mu[i]) res += Ss(x / i, i);\n\t\t\tif(i * i != k && mu[k / i]) {\n\t\t\t\tres += Ss(x / (k / i), k / i);\n\t\t\t}\n\t\t}\n\t}\n\treturn mp[make_pair(x, k)] = res;\n}\nsigned main() {\n\tn = read(); m = read(); K = read();\n\tinit();\n\tfor(int i = 1, j, nw = 0, lst = 0; i <= min(n, m); i = j + 1) {\n\t\tj = min(n / (n / i), m / (m / i));\n\t\tnw = Ss(j, K);\n\t\tans = ans + (nw - lst) * (n / i) * Sf(m / i);\n\t\tlst = nw;\n\t}\n\tprintf(\"%lld\\n\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1579181236,
        "uid": 151852,
        "name": "Paranoid\u4e36\u79bb\u6b87",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P1587 \u3010[NOI2016]\u5faa\u73af\u4e4b\u7f8e\u3011"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P1587)\r\n\r\n## 0. \u524d\u8a00\r\n\r\n\u63d0\u4f9b\u4e00\u79cd\u5f0f\u5b50\u8f83\u4e3a\u7b80\u6d01\u4e14\u4e0d\u7b97\u96be\u5199\u7684\u505a\u6cd5\u3002\r\n\r\n\u4ee5\u53ca\u4ecb\u7ecd\u4e00\u79cd\u8f83\u4e3a\u4f18\u79c0\u7684 dp \u7248\u675c\u6559\u7b5b\u5b9e\u73b0\u3002\r\n\r\n## 1. \u5f0f\u5b50\u63a8\u5bfc\r\n\r\n\u6211\u4eec\u77e5\u9053\u7eaf\u5faa\u73af\u5c0f\u6570\u4e00\u5b9a\u53ef\u4ee5\u5199\u6210\u5206\u6bcd\u5f62\u5982 $k^a-1$ \u7684\u5206\u6570\u3002\r\n\r\n\u56e0\u6b64\u7ea6\u5206\u540e\u7684\u5206\u6bcd\u4e00\u5b9a\u662f $k^a-1$ \u7684\u7ea6\u6570\u3002\u90a3\u4e48\u7b54\u6848\u5373\u4e3a\uff1a\r\n\r\n$$\\sum_{x=1}^n\\sum_{y=1}^m[x\\perp y][y|k^a-1]$$\r\n\r\n\u65b9\u62ec\u53f7\u4e2d\u7684\u4e24\u4e2a\u6761\u4ef6\u5206\u522b\u662f $x,y$ \u4e92\u8d28\u3001$y|k^a-1$ \u6709\u6b63\u6574\u6570\u89e3 $a$\u3002\r\n\r\n\u5bb9\u6613\u8bc1\u660e\u540e\u4e00\u6761\u7b49\u4ef7\u4e8e $y\\perp k$\u3002\r\n\r\n$$\\sum_{x=1}^n\\sum_{y=1}^m[x\\perp y][y\\perp k]$$\r\n\r\n\u8003\u8651\u5bf9\u5176\u8fdb\u884c\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff1a\r\n\r\n$$\\sum_{x=1}^n\\sum_{y=1}^m\\sum_{d|x,d|y}\\mu(d)[y\\perp k]$$\r\n\r\n$$\\sum_{d=1}^n\\mu(d)\\left\\lfloor\\dfrac nd\\right\\rfloor\\sum_{y=1}^{m/d}[yd\\perp k]$$\r\n\r\n$$\\sum_{d=1}^n\\mu(d)[d\\perp k]\\left\\lfloor\\dfrac nd\\right\\rfloor\\sum_{y=1}^{m/d}[y\\perp k]$$\r\n\r\n\u6ce8\u610f\u5230\u53ef\u4ee5\u5bf9 $d$ \u505a\u6574\u9664\u5206\u5757\u3002\r\n\r\n\u63a5\u4e0b\u6765\u6211\u4eec\u5e0c\u671b\u5b9e\u73b0\uff1a\r\n\r\n- \u5bf9 $f(n)=\\mu(n)[n\\perp k]$ \u6c42\u548c\uff1b\r\n- \u5bf9 $g(n)=[n\\perp k]$ \u6c42\u548c\u3002\r\n\r\n\u540e\u8005\u6bd4\u8f83\u597d\u5904\u7406\u3002  \r\n\u5bb9\u6613\u53d1\u73b0 $k$ \u662f $g$ \u7684\u5468\u671f\u3002  \r\n\u6211\u4eec $O(k\\log k)$ \u66b4\u529b\u8ba1\u7b97 $g(1)\\sim g(k)$\uff0c\u5e76\u9884\u5904\u7406\u8fd9\u4e00\u6bb5\u524d\u7f00\u548c\uff0c\u7136\u540e\u5373\u53ef $O(1)$ \u5b9e\u73b0\u5bf9 $g$ \u6c42\u548c\u3002\r\n\r\n\u524d\u8005\u4e8b\u5b9e\u4e0a\u662f\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\u6c42\u548c\u95ee\u9898\u3002  \r\n\u6070\u597d\u6211\u4eec\u6ce8\u610f\u5230 $f*g=\\varepsilon$\uff0c\u56e0\u6b64\u53ef\u4ee5\u76f4\u63a5\u7528\u675c\u6559\u7b5b\u5904\u7406\u3002\r\n\r\n\u6ce8\u610f\u4e0d\u5230\u7684\u8bdd\uff0c\u8fd9\u91cc\u662f\u8bc1\u660e\uff1a\r\n\r\n$$\\begin{aligned}\r\n(f*g)(n)&=\\sum_{d|n}f(d)g(\\tfrac nd)\\\\\r\n&=\\sum_{d|n}\\mu(d)[d\\perp k][\\tfrac nd\\perp k]\\\\\r\n&=\\sum_{d|n}\\mu(d)[n\\perp k]\\\\\r\n&=[n=1][n\\perp k]\\\\\r\n&=[n=1]\\end{aligned}$$\r\n\r\n\u672c\u8d28\u4e0a\u662f\u56e0\u4e3a $f(n)=\\mu(n)g(n)$ \u4e14 $g$ \u4e3a\u5b8c\u5168\u79ef\u6027\u51fd\u6570\u3002  \r\n\u6240\u4ee5\u901a\u6cd5\u662f\u518d\u5377\u4e00\u4e2a $g$\uff0c\u5c31\u53ef\u4ee5\u628a $g$ \u5168\u90e8\u914d\u6210 $g(n)$ \u7136\u540e\u63d0\u5230\u5377\u79ef\u5916\u9762\u4e86\u3002\r\n\r\n\u603b\u4e4b\u8fd9\u6837\u5c31\u505a\u5b8c\u4e86\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^{2/3}+k\\log k)$\u3002\r\n\r\n## 2. \u675c\u6559\u7b5b\u7684 dp \u5b9e\u73b0 & \u6574\u9664\u5206\u5757\u4f18\u5316\r\n\r\n\u6211\u4eec\u5148\u4ece\u5934\u63a8\u4e00\u904d\u675c\u6559\u7b5b\u7684\u6838\u5fc3\u5f0f\u5b50\u3002\r\n\r\n$$\\begin{aligned}\r\n&\\sum_{k=1}^n(f*g)(k)\\\\\r\n=&\\sum_{k=1}^n\\sum_{ij=k}f(i)g(j)\\\\\r\n=&\\sum_{ij\\le n}f(i)g(j)\r\n\\end{aligned}$$\r\n\r\n\u4e00\u822c\u662f\u5c06\u5b83\u5199\u6210 $\\displaystyle\\sum_{i=1}^nf(i)Sg(n/i)$\uff0c\u7136\u540e\u7528\u6574\u9664\u5206\u5757\u8ba1\u7b97\u3002\r\n\r\n\u8fd9\u91cc\u6211\u4eec\u6362\u4e00\u79cd\u505a\u6cd5\u3002\r\n\r\n\u6ce8\u610f\u5230 $ij\\le n$ \u8868\u660e $i\\le \\sqrt n$ \u6216 $j\\le \\sqrt n$\u3002\r\n\r\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u7b80\u5355\u7684\u5bb9\u65a5\u5f97\u5230\uff1a\r\n\r\n$$S(f*g)(n)=\\sum_{i=1}^{\\sqrt n}f(i)Sg(n/i)+\\sum_{i=1}^{\\sqrt n}g(i)Sf(n/i)-Sf(\\sqrt n)Sg(\\sqrt n)$$\r\n\r\n$\\sqrt n$ \u53ef\u80fd\u4e0d\u662f\u6574\u6570\uff0c\u4f46 $i$ \u4e00\u5b9a\u662f\u6574\u6570\uff0c\u6240\u4ee5\u53d6\u6c42\u548c\u4e0a\u754c\u4e3a $B=\\lfloor\\sqrt n\\rfloor$ \u5373\u53ef\u3002\r\n\r\n\u672c\u9898\u4e2d $f*g=\\varepsilon$\uff0c\u7b80\u5355\u6574\u7406\u4e00\u4e0b\u5f0f\u5b50\u5f97\u5230\uff1a\r\n\r\n$$Sf(n)=1-Sg(n)-\\sum_{d=2}^B(g(d)Sf(n/d)+f(d)Sg(n/d))+Sf(B)Sg(B)$$\r\n\r\n\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97\uff0c\u4e0d\u518d\u9700\u8981\u6574\u9664\u5206\u5757\u3002\r\n\r\n\u63a5\u4e0b\u6765\u662f\u5bf9\u675c\u6559\u7b5b\u672c\u8eab\u7684\u4f18\u5316\u3002\r\n\r\n\u8003\u8651\u719f\u77e5\u6027\u8d28 $(a/b)/c=a/(bc)$\uff0c\u53ef\u77e5\u6211\u4eec\u53ea\u9700\u7528\u5230 $Sf(1)\\sim Sf(B),Sf(n/B)\\sim Sf(n/1)$ \u7684\u503c\u3002\r\n\r\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u79f0\u4e4b\u4e3a $f$ \u7684\u5757\u7b5b\u3002  \r\n\u5757\u7b5b\u53ef\u4ee5\u7528\u4e24\u4e2a\u957f\u4e3a $B$ \u7684\u6570\u7ec4\u62fc\u8d77\u6765\u5b58\u50a8\u3002\u8fd9\u4e2a\u53ef\u4ee5\u770b\u4ee3\u7801\u5b9e\u73b0\u3002\r\n\r\n\u5148\u7528\u7ebf\u6027\u7b5b\u9884\u5904\u7406 $Sf(1)\\sim Sf(n^{2/3})$\u3002\r\n\r\n\u5bf9\u4e8e\u5757\u7b5b\u7684\u5269\u4f59\u90e8\u5206\uff0c\u53ea\u9700\u5e94\u7528\u4e0a\u9762\u7684\u5f0f\u5b50\uff0c\u4f9d\u6b21\u9012\u63a8\u6c42\u51fa\u3002\uff08\u8fd9\u90e8\u5206\u53ef\u89c6\u4f5c dp\uff09\r\n\r\n\u8fc7\u7a0b\u4e2d\u8fd8\u8981\u7528\u5230 $g$ \u7684\u5757\u7b5b\u3002\u8fd9\u4e2a\u663e\u7136\u53ef\u4ee5 $O(\\sqrt n)$ \u9884\u5904\u7406\u3002\r\n\r\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\displaystyle O\\left(n^{2/3}+\\sum_{i=1}^{n^{1/3}}\\sqrt{\\dfrac ni}\\right)=O(n^{2/3})$\uff0c\u4e0e\u539f\u7248\u675c\u6559\u7b5b\u76f8\u540c\u3002\uff08\u4f46\u5e38\u6570\u66f4\u4f18\uff09\r\n\r\n\u8fdb\u4e00\u6b65\u5730\uff0c\u4f7f\u7528\u8fd9\u79cd\u5199\u6cd5\u7684\u675c\u6559\u7b5b\u8fd8\u53ef\u4ee5\u7ed3\u5408\u5176\u5b83\u79d1\u6280\uff0c\u4f7f\u590d\u6742\u5ea6\u4f18\u5316\u81f3 $O\\left(\\dfrac{n^{2/3}}{\\log n}\\right)$\u3002\r\n\r\n~~\u4f46\u8fd9\u91cc\u7a7a\u767d\u592a\u5c0f\uff0c\u5199\u4e0d\u4e0b\u4e86\u3002\u6709\u5174\u8da3\u53ef\u4ee5\u81ea\u884c\u4e86\u89e3\u3002~~\r\n\r\n## 3. \u4ee3\u7801\u5b9e\u73b0\r\n\r\n\u9664\u4e86\u4e0a\u9762\u8bf4\u7684\u4f18\u5316\u4ee5\u5916\uff0c\u8fd8\u5bf9\u6574\u9664\u8fd0\u7b97\u672c\u8eab\u8fdb\u884c\u4e86\u4f18\u5316\u3002\uff08 `dv` \u51fd\u6570\u53ca\u5176\u76f8\u5173\u90e8\u5206\uff09\r\n\r\n\u5e38\u6570\u5f88\u5c0f\u3002\u76ee\u524d\u662f\u6700\u4f18\u89e3 rk1\u3002\r\n\r\n\u4e0b\u9762\u7ed9\u51fa\u5b8c\u6574\u4ee3\u7801\uff0c\u4ec5\u4f9b\u53c2\u8003\u3002\r\n\r\n```cpp\r\n#include<bits/stdc++.h>\r\n#define C const\r\n#define readc(x) (scanf(\"%d\",&x),x)\r\n#define rep(i,l,r) for (int i=l; i<=r; ++i)\r\ntypedef long long ll;\r\ntypedef __int128 Lll;\r\nusing namespace std;\r\n\r\nC int N=1e6+8,M=32000;\r\nC int n=readc(n),m=readc(m),K=readc(K);\r\nC int Mx=max(n,m),mx=pow(Mx,2./3);\r\nint k,t; ll s,inv[M]; bitset<M>g; int sg[M],p[80000];\r\nbitset<N>v; char f[N]; int sf[N],Sg[M],Sn[M],Sm[M];\r\n\r\ninline int dv(Lll x,int y) { return x*inv[y]>>56; } //\u8fd4\u56de x/y \u7684\u503c\r\ninline int mo(int x,int y) { return x-dv(x,y)*y; }\r\nint gcd(int x,int y) { return y?gcd(y,mo(x,y)):x; }\r\nvoid prework() {\r\n    C int sq=max(K,(int)sqrt(Mx));\r\n    C ll base=(1ll<<56);\r\n    rep(i,1,sq) inv[i]=base/i+1;\r\n    rep(i,1,K) sg[i]=sg[i-1]+(g[i]=(gcd(K,i)==1));\r\n    rep(i,K+1,sq) sg[i]=sg[i-1]+(g[i]=g[i-K]);\r\n    f[1]=1;\r\n    rep(i,2,mx) { //\u7ebf\u6027\u7b5b\u9884\u5904\u7406\u4e00\u90e8\u5206 f\r\n        if (!v[i]) f[i]=(g[mo(i,K)]?-1:0),p[++k]=i;\r\n        for (int j=1; j<=k&&(t=i*p[j])<=mx; ++j) {\r\n            v[t]=1;\r\n            if (!mo(i,p[j])) break;\r\n            f[t]=f[i]*f[p[j]];\r\n        }\r\n    }\r\n    rep(i,1,mx) sf[i]=sf[i-1]+f[i];\r\n}\r\nC int phiK=(prework(),sg[K]);\r\n\r\nvoid calc(C int n,int *S) { //\u7528\u675c\u6559\u7b5b\u6c42 f \u7684\u5757\u7b5b\u7684\u7b2c\u4e8c\u90e8\u5206\uff0c\u5e76\u5b58\u5165 S\r\n    C int sq=sqrt(n);\r\n    rep(i,n/mx+1,sq) S[i]=sf[dv(n,i)]; //\u5df2\u7ecf\u9884\u5904\u7406\u7684\u90e8\u5206\r\n    rep(i,1,sq) t=dv(n,i),Sg[i]=phiK*dv(t,K)+sg[mo(t,K)]; //\u6c42 g \u7684\u5757\u7b5b\r\n    for (int i=n/mx; i; --i) { // dp \u5b9e\u73b0\u675c\u6559\u7b5b\r\n        C int n2=dv(n,i),B=sqrt(n2),mid=dv(sq,i);\r\n        int s=1+sg[B]*sf[B]-Sg[i];\r\n        rep(j,2,mid) s-=g[j]*S[i*j]+f[j]*Sg[i*j];\r\n        rep(j,mid+1,B) t=dv(n2,j),s-=g[j]*sf[t]+f[j]*sg[t];\r\n        S[i]=s;\r\n    }\r\n}\r\nvoid solve() { //\u6574\u9664\u5206\u5757\u8ba1\u7b97\u7b54\u6848\r\n    C int Mn=min(n,m),sq=min(n,(int)sqrt(Mx)),Sq=sqrt(m);\r\n    rep(i,1,sq) s+=ll(dv(n,i))*f[i]*(i<=Sq?Sg[i]:sg[dv(m,i)]);\r\n    if (sq==Mn) { printf(\"%lld\\n\",s); return ; }\r\n    int t1=dv(n,sq),r1=dv(n,t1);\r\n    int t2=dv(m,sq),r2=dv(m,t2);\r\n    for (int l=sq+1,lst=sf[sq],cur; l<=Mn; l=min(r1,r2)+1) {\r\n        if (l>r1) r1=dv(n,--t1);\r\n        if (l>r2) r2=dv(m,--t2);\r\n        cur=(r1<r2?Sn[t1]:Sm[t2]);\r\n        s+=t1*ll(cur-lst)*sg[t2],lst=cur;\r\n    }\r\n    printf(\"%lld\\n\",s);\r\n}\r\nmain() { calc(n,Sn),calc(m,Sm),solve(); }\r\n```",
        "postTime": 1684922534,
        "uid": 38785,
        "name": "icyM3tra",
        "ccfLevel": 0,
        "title": "[sol] P1587 [NOI2016] \u5faa\u73af\u4e4b\u7f8e"
    },
    {
        "content": "$\\frac{x}{y}$\u5728$k$\u8fdb\u5236\u4e0b\u662f\u7eaf\u5faa\u73af\u5c0f\u6570$\\Leftarrow\\! =\\! \\Rightarrow \\exists \\ t $ \u4f7f\u5f97 $ y|k^t\\!-\\!1 $\n\n\u82e5$gcd(y,k)!=1$\u5219$y\\nmid k^t\\!-\\!1$\n\n\u82e5$gcd(y,k)=1$\u5219\u7531\u6b27\u62c9\u5b9a\u7406\u77e5:$y\\mid k^{\u03c6(y)}\\!-\\!1$\n\n\u6240\u4ee5$\\frac{x}{y}$\u5728$k$\u8fdb\u5236\u4e0b\u662f\u7eaf\u5faa\u73af\u5c0f\u6570$\\Leftarrow\\! =\\! \\Rightarrow gcd(y,k)\\!=\\!1$\n\n\u53c8\u56e0\u4e3a\u503c\u76f8\u7b49\u7b97\u4e00\u4e2a\u6240\u4ee5\u53ea\u9700\u770b$gcd(x,y)=1$\u7684\u60c5\u51b5\n\n$\\Rightarrow Ans=\\sum\\limits_{i=1}^n \\sum\\limits_{j=1}^m I[gcd(i,j)=1]\\! * \\!I[gcd(j,k)=1]$\n\n\u8bb0$f(d)=\\sum\\limits_{i=1}^n \\sum\\limits_{j=1}^m I[gcd(i,j)=d]\\! * \\!I[gcd(j,k)=1]$\n\n\u5219$\\begin{aligned}F(d)&=\\sum\\limits_{d|i} f(i)\\\\&=\\sum\\limits_{d|i}\\sum\\limits_{i=1}^n \\sum\\limits_{j=1}^m I[gcd(i,j)=d]\\! * \\!I[gcd(j,k)=1]\\\\&=\\sum\\limits_{d|i,d|j}\\sum\\limits_{i=1}^n \\sum\\limits_{j=1}^m I[gcd(j,k)=1]\\\\&=\\sum\\limits_{i=1}^{[\\frac{n}{d}]} \\sum\\limits_{j=1}^{[\\frac{m}{d}]} I[gcd(j*d,k)=1]\\end{aligned}$\n\n\u8bb0$\\delta(x)=I[gcd(x,k)=1]$\n\n\u5219$\\delta(x)$\u4e3a\u79ef\u6027\u51fd\u6570\n\n$\\begin{aligned}F(d)&=\\sum\\limits_{i=1}^{[\\frac{n}{d}]} \\sum\\limits_{j=1}^{[\\frac{m}{d}]} \\delta(j*d)\\\\&=\\sum\\limits_{i=1}^{[\\frac{n}{d}]} \\sum\\limits_{j=1}^{[\\frac{m}{d}]} \\delta(j)* \\delta(d)\\\\&=\\delta(d)\\!* \\![\\frac{n}{d}]\\!* \\! \\sum\\limits_{j=1}^{[\\frac{m}{d}]} \\delta(j)\\end{aligned}$\n\n\u8bb0$g(n)=\\sum\\limits_{j=1}^{n} \\delta(j)$\n\n$F(d)=\\delta(d)\\!* \\![\\frac{n}{d}]\\!* \\! g(n)$\n\n\u7531\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5f97:\n\n$f(1)=\\sum\\limits_{i=1}^{min(n,m)}\\mu(i)* \\delta(i)* [\\frac{n}{i}]* g([\\frac{m}{i}])$\n\n\u56e0\u4e3a$g(x+k)=g(x)+g(k)$\n\n\u6240\u4ee5$g(x)=[\\frac{x}{k}]* g[k]+g[x\\%k]$\n\n\u6c42$g$\u53ea\u9700\u9884\u5904\u7406\u51fa$g(1),g(2),\\cdots,g(k)$\n\n\u7efc\u4e0ag\u641e\u5b9a\u3002\n\n\u63a5\u4e0b\u6765\u53ea\u9700\u8981\u6c42$\\mu(i)* \\delta(i)$\u7684\u524d\u7f00\u548c\u5373\u53ef\u3002\n\n\u8bb0$S(n)=\\sum\\limits_{i=1}^{n} \\mu(i)* \\delta(i)$\n\n$\\begin{aligned}\\quad&\\sum\\limits_{i=1}^{n}\\delta(i)* S([\\frac{n}{i}])\\\\=&\\sum\\limits_{i=1}^{n} \\sum\\limits_{j=1}^{[\\frac{n}{i}]} \\delta(i)* \\mu(j)* \\delta(j) \\quad \\text{ \u53d6d\u4e3ai * j}\\downarrow\\\\=&\\sum \\limits_{d=1}^{n}\\sum\\limits_{i|d}\\delta(i)* \\mu(\\frac{d}{i})* \\delta(\\frac{d}{i})\\\\=&\\sum \\limits_{d=1}^{n}(\\sum\\limits_{i|d}\\mu(\\frac{d}{i}))* \\delta(d)\\\\=&\\delta(1)\\\\=&1\\end{aligned}$\n\n$\\therefore S(n)=1-\\sum\\limits_{i=2}^{n} \\delta(i)* S([\\frac{n}{i}])$\n\n$S([\\frac{n}{i}])$\u53ef\u4ee5\u5206\u5757\u505a\n\n\u6240\u4ee5\u53ea\u9700\u6c42$\\delta(i)$\u7684\u524d\u7f00\u548c\n\n\u54a6\uff1f\u6211\u4eec\u53d1\u73b0$\\delta(i)$\u7684\u524d\u7f00\u548c\u4e0d\u5c31\u662f$g(i)$\u5417\uff1f\n\n\u6211\u4eec\u4e4b\u524d\u5df2\u7ecf\u7b97\u8fc7\u4e86\u3002\n\n## \u81f3\u6b64\u5206\u6790\u7ed3\u675f\n\n\u4e0a\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define N 8000000\nusing namespace std;\nll n,m,k,p[N],mo[N],g[N],s[N];\nbool used[N];\nmap<ll,ll>f;\nll gcd(ll x,ll y)\n{\n    return y?gcd(y,x%y):x;\n}\nll gg(ll x)\n{\n    return x/k*g[k]+g[x%k];\n}\nvoid euler()\n{\n    for(int i=1;i<=k;i++)\n        g[i]=g[i-1]+(gcd(i,k)==1);\n    mo[1]=1;\n    for(ll i=2;i<N;i++)\n    {\n        if(used[i]==0)\n        {\n            p[++p[0]]=i;\n            mo[i]=-1;\n            used[i]=1;\n        }\n        for(int j=1;j<=p[0];j++)\n        {\n            if(i*p[j]>=N)\n                break;\n            used[i*p[j]]=1;\n            if(i%p[j]==0)\n            {\n                mo[i*p[j]]=0;\n                break;\n            }\n            mo[i*p[j]]=-mo[i];\n        }\n    }\n    for(ll i=1;i<N;i++)\n        s[i]=s[i-1]+mo[i]*(gg(i)-gg(i-1));\n}\nll ask(ll x)\n{\n    if(x<N)\n        return s[x];\n    if(f[x]!=0)\n        return f[x];\n    ll ans=1;\n    for(ll i=2,j;i<=x;i=j+1)\n    {\n        j=x/(x/i);\n        ans-=ask(x/i)*(gg(j)-gg(i-1));\n    }\n    f[x]=ans;\n    return ans;\n}\nint main()\n{\n    scanf(\"%lld%lld%lld\",&n,&m,&k);\n    euler();\n    ll ans=0;\n    for(ll i=1,j;i<=min(n,m);i=j+1)\n    {\n        j=min(n/(n/i),m/(m/i));\n        ans+=gg(m/i)*(n/i)*(ask(j)-ask(i-1));\n    }\n    printf(\"%lld\",ans);\n\n    return 0;\n}\n```",
        "postTime": 1552494753,
        "uid": 137610,
        "name": "\u7231\u8fea\u751f",
        "ccfLevel": 0,
        "title": "P1587 [NOI2016]\u5faa\u73af\u4e4b\u7f8e"
    },
    {
        "content": "~~\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u8111\u5b50\u62bd\u7b4b\u4e86\u60f3\u7528\u8fed\u4ee3\u6cd5\u5199\u8fd9\u9898\uff0c\u7136\u540e\u5c31\u628a\u81ea\u5df1\u5199\u6b7b\u4e86~~\n\n### \u524d\u7f6e\u829d\u58eb\uff1a\u675c\u6559\u7b5b/\u6d32\u9601\u7b5b\n\n\u86e4?\u4e0d\u4f1a\u675c\u6559\u7b5b\uff1f\u53ef\u4ee5\u51fa\u95e8\u5de6\u8f6c\u4f60\u7ad9\u819c\u677f\u533a\u53bb\u5b66\u4e60\u4e00\u4e0b\n\n\u4e0d\u8fc7\u53ef\u80fd\u4f60\u5b66\u7684\u662f\u9012\u5f52\u7248\u7684\u675c\u6559\u7b5b\u5e38\u6570\u4f1a\u5927\u4e00\u70b9\uff0c\u8fd9\u7bc7\u9898\u89e3\u4f1a\u4ecb\u7ecd\u4e00\u4e0b\u5982\u4f55\u7528\u8fed\u4ee3\u6cd5\u5199\u675c\u6559\u7b5b\n\n### \u524d\u7f6e\u829d\u58eb\uff1a\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n\n\u4e3a\u4e86\u505a\u8fd9\u9053\u9898\u6211\u4eec\u53ef\u80fd\u9700\u8981\u4e00\u4e9b\u6bd4\u8f83\u521d\u7ea7\u7684\u53cd\u6f14\u6280\u5de7\u548c\u4ea4\u6362\u6c42\u548c\u53f7\u7684\u6280\u5de7\uff0c\u6bd4\u5982\u6211\u4eec\u5e94\u8be5\u77e5\u9053\u8fd9\u4e9b\u7ed3\u8bba\u90fd\u662f\u5bf9\u7684\n\n\u8fd9\u7bc7\u9898\u89e3\u5f53\u4e2d\u6211\u4eec\u5c06\u4f1a\u7528$\\epsilon(i,j)$\u8868\u793a$gcd(i,j)==1$\u8fd9\u4e2a\u5f0f\u5b50\n\n$$\\lfloor \\frac{n}{d} \\rfloor$$\n\n$$\\sum_{i=1}^{n}g(i)\\sum_{d|n}f(d)=\\sum_{d=1}^{n}f(d)\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor}g(id)$$\n\n$$epsilon(i,j)=\\sum_{d|i,d|j}\\mu(d)$$\n\n$$\\epsilon(dt,j)=\\epsilon(d,j)\\epsilon(t,j)$$\n\n$$\\mu(dt)=\\mu(d)\\mu(t)\\epsilon(d,t)$$\n\n\u89e3\u91ca\u4e00\u4e0b\u7b2c3\u4e2a\u5f0f\u5b50\u5229\u7528\u4e86$\\mu$\u662f\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\u7684\u6027\u8d28\uff0c\u5982\u679c$d,t$\u4e0d\u4e92\u8d28\u7684\u8bdd$\\mu$\u5c31\u662f0\u5426\u5219\u5c31\u662f\u4e8c\u8005\u76f8\u4e58\n\n\u5e76\u4e14\u4f60\u8fd8\u9700\u8981\u77e5\u9053\u5bf9\u4e8e\u4e00\u4e2a$n$\u6765\u8bb2\uff0c$\\lfloor \\frac{n}{d} \\rfloor$\u6070\u597d\u6709$2\\sqrt{n}$\u4e2d\u53d6\u503c\uff0c\u5e76\u4e14\u5bf9\u4e8e\u540e$\\sqrt{n}$\u53d6\u503c\u6765\u8bb2\uff0c\u5982\u679c\u4ed6\u4eec\u7684\u503c\u662fx\uff0c\u90a3\u4e48$\\lfloor \\frac{n}{x} \\rfloor$\u7684\u503c\u4e92\u4e0d\u76f8\u540c\u8fd9\u4e2a\u7ed3\u8bba,\u5f53\u7136\u60a8\u53ef\u80fd\u4e5f\u9700\u8981\u77e5\u9053\u4ec0\u4e48\u53eb\u6570\u8bba\u5206\u5757(\u5c31\u662f\u5982\u4f55\u679a\u4e3e$\\lfloor \\frac{n}{d} \\rfloor$\u7684\u53d6\u503c\u7684\u4e00\u79cd\u6280\u5de7)\n\n\u5982\u679c\u60a8\u78b0\u5de7\u4e0d\u4f1a\u5f88\u61c2\u4e0a\u9762\u7684\u829d\u58eb\u53ef\u4ee5\u53bb\u5199\u51e0\u9053\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7136\u540e\u6765\u770b\u8fd9\u9898\n\n## \u672c\u9898\u9898\u89e3\n\n\u9996\u5148\u6211\u4eec\u9700\u8981\u901a\u8fc7\u9898\u9762\u5f97\u51fa\u7b54\u6848\u4e8b\u5b9e\u4e0a\u7b49\u4e8e\u8fd9\u4e2a\u795e\u5947\u7684\u5f0f\u5b50\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{m}\\epsilon(i,j)\\epsilon(j,k)$$\n\n\u4e3a\u4ec0\u4e48\u5462\uff1f\n\n\u9996\u5148$epsilon(i,j)$\u8fd9\u4e2a\u9650\u5236\u6761\u4ef6\u662f\u6bd4\u8f83\u597d\u7406\u89e3\u7684\uff0c\u4f46\u662f\u4e3a\u4ec0\u4e48\u7b2c\u4e8c\u4e2a\u9650\u5236\u6761\u4ef6\u662f\u5bf9\u7684\u5462\uff1f\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u7684\u5206\u6bcd\u4ec5\u4ec5\u548ck\u4e92\u8d28\u5c31\u80fd\u63a8\u51fa\u8fd9\u4e2a\u4e1c\u897f\u662f\u4e00\u4e2a\u7eaf\u5faa\u73af\u7684\u5c0f\u6570\u4e86\n\n\u9996\u5148\u6211\u4eec\u4e0d\u96be\u7406\u89e3\u5982\u679c$\\frac{1}{y}$\u662f\u4e00\u4e2a\u7eaf\u5faa\u73af\u7684\u5c0f\u6570\uff0c\u90a3\u4e48$\\frac{x}{y}$\u4e5f\u4f1a\u662f\u4e00\u4e2a\u7eaf\u5faa\u73af\u7684\u5c0f\u6570\uff0c\u5177\u4f53\u8bc1\u660e\u7684\u8bdd\u5c31\u662f\u4e24\u4e2a\u7eaf\u5faa\u73af\u5c0f\u6570\u76f8\u52a0\u8fd8\u662f\u7eaf\u5faa\u73af\u5c0f\u6570\uff0c\u6240\u4ee5\u4e00\u4e2a\u5206\u6570\u662f\u4e0d\u662f\u7eaf\u5faa\u73af\u5c0f\u6570\u770b\u8d77\u6765\u4ec5\u4ec5\u548c\u5206\u6bcd\u6709\u5173\n\n\u90a3\u4e48\u6211\u4eec\u5047\u8bbe\u8fd9\u4e2a\u7eaf\u5faa\u73af\u5c0f\u6570\u7684\u5faa\u73af\u8282\u957f\u5ea6\u4e3a$l$\u6211\u4eec\u53ef\u4ee5\u7528\u9519\u4f4d\u76f8\u51cf\u6cd5\u5f97\u5230\u4e0b\u9762\u7684\u5f0f\u5b50\n\n$$\\frac{k^l}{y}-\\lfloor \\frac{k^l}{y} \\rfloor=\\frac{1}{y}$$\n\n\u4e5f\u5c31\u662f\u8fd9\u4e2a\u5c0f\u6570\u5411\u53f3\u632a\u4e86$l$\u4f4d\u4e4b\u540e\u7684\u5c0f\u6570\u90e8\u5206\u4f9d\u7136\u548c\u539f\u6765\u4e00\u6837\n\n\u90a3\u4e48\u628a\u7b49\u5f0f\u4e24\u8fb9\u540c\u65f6\u4e58y\u53ef\u4ee5\u5f97\u5230\n\n$$k^l-\\lfloor \\frac{k^l}{y} \\rfloor y=1$$\n\n\u8fd9\u4e2a\u4e1c\u897f\u597d\u50cf\u5c31\u662f\u53d6\u4f59\u7684\u5b9a\u4e49\u5f0f\u5b50\u5427\uff1f\u8ba9\u6211\u4eec\u628a\u5f0f\u5b50\u5199\u6210\u8fd9\u6837\n\n$$ k^l \\equiv 1 \\mod y$$\n\n\u6839\u636e\u6b27\u62c9\u5b9a\u7406\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u5f53$k,y$\u4e92\u8d28\u7684\u65f6\u5019\u6211\u4eec\u5c31\u5b58\u5728\u8fd9\u6837\u7684$l$\u5426\u5219\u4e0d\u5b58\u5728\n\n\u6240\u4ee5\u6211\u4eec\u8bc1\u660e\u4e86\u4e00\u4e2a\u5206\u6570\u662f\u7eaf\u5faa\u73af\u7684\u5f53\u4e14\u4ec5\u5f53\u5b83\u7684\u5206\u6bcd\u548c\u8fdb\u5236\u4e92\u8d28\n\n\u6240\u4ee5\u7b54\u6848\u81ea\u7136\u5c31\u662f\u4e0a\u9762\u63d0\u5230\u7684\u5f0f\u5b50\u4e86\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{m}\\epsilon(i,j)\\epsilon(j,k)$$\n\n\u6211\u4eec\u53d1\u73b0$\\epsilon(j,k)$\u8fd9\u4e2a\u4e1c\u897f\u76f8\u5f53\u7684\u4e0d\u597d\u641e\u5b9a\uff0c\u56e0\u6b64\u8ba9\u6211\u4eec\u5148\u4e0d\u7740\u6025\u5c55\u5f00\u8fd9\u4e2a\u5f0f\u5b50,\u800c\u662f\u628a$\\epsilon(i,j)$\u7528$\\mu$\u5c55\u5f00\n\n$$\\sum_{j=1}^{m}\\epsilon(j,k)\\sum_{i=1}^{n}\\sum_{d|i,d|j}\\mu(d)$$\n\n\u4ea4\u6362\u4e00\u4e0b\u6c42\u548c\u53f7\u53ef\u4ee5\u5f97\u5230\n\n$$\\sum_{j=1}^{m}\\epsilon(j,k)\\sum_{d|j}\\mu(d)\\lfloor \\frac{n}{d} \\rfloor$$\n\n\u7136\u540e\u6211\u4eec\u7ee7\u7eed\u4ea4\u6362\u6c42\u548c\u53f7\u53ef\u4ee5\u5f97\u5230\n\n$$\\sum_{d=1}^{n}\\mu(d)\\lfloor \\frac{n}{d} \\rfloor\\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor}\\epsilon(jd,k)$$\n\n\u770b\u8d77\u6765\u53ef\u4ee5\u7528\u521a\u624d\u7684\u7ed3\u8bba\u4e86\uff0c\u8ba9\u6211\u4eec\u628a$\\epsilon(jd,k)$\u62c6\u5f00\n\n$$\\sum_{d=1}^{n}\\mu(d)\\lfloor \\frac{n}{d} \\rfloor\\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor}\\epsilon(j,k) \\epsilon(d,k)$$\n\n\u7136\u540e\u4f3c\u4e4e\u53ef\u4ee5\u628a$\\epsilon(d,k)$\u63d0\u5230\u524d\u9762\u53bb\n\n$$\\sum_{d=1}^{n}\\mu(d)\\epsilon(d,k)\\lfloor \\frac{n}{d} \\rfloor\\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor}\\epsilon(j,k)$$\n\n\u6211\u4eec\u53d1\u73b0\u51fd\u6570\n\n$$f(n)=\\sum_{i=1}^{n}\\epsilon(i,k)=\\sum_{i=1}^{n}\\epsilon(i\\%k,k)=\\lfloor \\frac{n}{k} \\rfloor f(k)+f(n\\%k)$$\n\n\u4f3c\u4e4e\u662f\u53ef\u4ee5\u5728\u66b4\u529b\u9884\u5904\u7406\u524d$k$\u9879\u4e4b\u540e\u5feb\u901f\u8ba1\u7b97\u7684\n\n\u90a3\u4e48\u6211\u4eec\u7684\u5f0f\u5b50\u5c31\u53d8\u6210\u4e86\n\n$$\\sum_{d=1}^{n}\\mu(d)\\epsilon(d,k)\\lfloor \\frac{n}{d} \\rfloor f(\\lfloor \\frac{m}{d} \\rfloor)$$\n\n\u770b\u8d77\u6765\u6211\u4eec\u4f3c\u4e4e\u53ef\u4ee5\u5bf9$\\lfloor \\frac{n}{d} \\rfloor,\\lfloor \\frac{m}{d} \\rfloor$\u7684\u503c\u8fdb\u884c\u6570\u8bba\u5206\u5757\u4e86\uff0c\u5f53\u7136\u524d\u63d0\u662f\u6211\u4eec\u9700\u8981\u6c42\u51fa\u8fd9\u4e2a\u4e1c\u897f\u7684\u524d\u7f00\u548c\n\n$$f(d)=\\mu(d)\\epsilon(d,k)$$\n\n\u600e\u4e48\u505a\u5462?\n\n\u6211\u4eec\u8bbe$S(n)$\u8868\u793a\u4e0b\u9762\u7684\u5f0f\u5b50\uff0c\u7136\u540e\u63a5\u4e0b\u6765\u6211\u4eec\u9700\u8981\u5bf9$\\lfloor \\frac{n}{d} \\rfloor$\u548c$\\lfloor \\frac{m}{d} \\rfloor$\u8fd9\u4e24\u4e2a\u5f0f\u5b50\u7684\u4e00\u5171$2\\sqrt{n}+2\\sqrt{m}$\u53ef\u80fd\u7684\u53d6\u503c\u5904\u7406\u51fa\u5bf9\u5e94\u7684$S$\u51fd\u6570\u503c\n\n$$S(n)=\\sum_{i=1}^{n}\\mu(d)\\epsilon(d,k)$$\n\n\u6b64\u65f6\u8ba9\u6211\u4eec\u7528$\\mu$\u628a$\\epsilon$\u5c55\u5f00\n\n$$S(n)=\\sum_{i=1}^{n}\\mu(d)\\sum_{T|d,T|k}\\mu(T)$$\n\n\u4ea4\u6362\u4e00\u4e0b\u6c42\u548c\u53f7\u53ef\u4ee5\u5f97\u5230\n\n$$S(n)=\\sum_{T|k}\\mu(T)\\sum_{d=1}^{\\lfloor \\frac{n}{T} \\rfloor}\\mu(dT)$$\n\n\u6839\u636e\u521a\u624d\u7684\u7ed3\u8bba\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\n\n$$S(n)=\\sum_{T|k}\\mu(T)\\sum_{d=1}^{\\lfloor \\frac{n}{T} \\rfloor}\\mu(d)\\mu(T)\\epsilon(d,T)$$\n\n\u628a$\\mu(T)$\u63d0\u51fa\u6765\u53ef\u4ee5\u5f97\u5230\n\n$$S(n)=\\sum_{T|k}\\mu^2(T)\\sum_{d=1}^{\\lfloor \\frac{n}{T} \\rfloor}\\mu(d)\\epsilon(d,T)$$\n\n\u770b\u8d77\u6765\u6211\u4eec\u4f3c\u4e4e\u5f97\u5230\u4e86\u4e00\u4e2a\u53ef\u4ee5\u4e0d\u65ad\u9012\u5f52\u7684\u5f0f\u5b50\uff1f\n\n\u6211\u4eec\u91cd\u65b0\u66f4\u6539\u4e00\u4e0b\u6211\u4eec\u9700\u8981\u6c42\u7684\u6570\u7684\u5b9a\u4e49\uff0c\u8bbe$G(n,k)$\u8868\u793a\n\n$$\\sum_{d=1}^{n}\\mu(d)\\epsilon(d,k)$$\n\n\u5219\u6211\u4eec\u53ef\u4ee5\u5217\u51fa\u9012\u5f52\u5f0f\n\n$$G(n,k)=\\sum_{T|k}\\mu^2(T)G(\\lfloor \\frac{n}{d} \\rfloor,T)$$\n\n\u90a3\u4e48\u6211\u4eec\u6253\u4e00\u4e0b\u8868\u4f1a\u53d1\u73b0$2000$\u4ee5\u5185\u4e00\u4e2a\u6570\u7684\u7ea6\u6570\u4e2a\u6570\u6700\u5927\u4e0d\u8d85\u8fc7$40$\u4e2a\n\n\u6240\u4ee5\u770b\u8d77\u6765\u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u9012\u5f52\u4e0b\u53bb\u7b97\u54af\uff1f\n\n\u6162\u7740\uff0c\u4f3c\u4e4e\u6211\u4eec\u8fd8\u6ca1\u6709\u5904\u7406\u8fb9\u754c\u6761\u4ef6\u662f\u4ec0\u4e48\u2026\u2026\n\n$$G(n,1)=\\sum_{d=1}^{n}\\mu(d),S(n)=G(n,k)$$\n\n\u86e4\uff1f$\\mu$\u51fd\u6570\u7684\u524d\u7f00\u548c\uff1f\u76f4\u63a5\u675c\u6559\u7b5b\u5c31\u884c\u4e86\n\n### trick:\u8fed\u4ee3\u7248\u675c\u6559\u7b5b\n\n\u4f17\u6240\u5468\u77e5\u675c\u6559\u7b5b\u5176\u5b9e\u662f\u4e00\u79cd\u8bb0\u5fc6\u5316\u641c\u7d22\u7684\u6280\u672f\n\n\u5047\u8bbe\u6211\u4eec\u4ee4$S(n)$\u8868\u793a\u8fd9\u4e2a\u5f0f\u5b50\n\n$$S(n)=\\sum_{d=1}^{n}\\mu(d)$$\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\n\n$$\\sum_{i=1}^{n}\\epsilon(i)=\\sum_{i=1}^{n}\\sum_{d|i}\\mu(\\frac{i}{d})=\\sum_{d=1}^{n}\\sum_{T=1}^{\\lfloor \\frac{n}{d} \\rfloor}\\mu(T)$$\n\n\u4e5f\u5c31\u662f\u8bf4\n\n$$1=\\sum_{i=1}^{n}S(\\lfloor \\frac{n}{d} \\rfloor)$$\n\n\u7a0d\u5fae\u6574\u7406\u4e00\u4e0b\u5f0f\u5b50\u5c31\u662f\n\n$$S(n)=1-\\sum_{i=2}^{n}S(\\lfloor \\frac{n}{d} \\rfloor)$$\n\n\u90a3\u4e48\u6211\u4eec\u53d1\u73b0\u8fd9\u4e1c\u897f\u5176\u5b9e\u5c31\u662f\u4e00\u4e2adp\u5f0f\u5b50\u554a\n\n\u6240\u4ee5\u4f5c\u4e3a\u4e00\u4e2adp\u6765\u8bb2\u6211\u4eec\u5f53\u7136\u53ef\u4ee5\u9012\u63a8\u7684\u5b9e\u73b0\u5b83\u54af\n\n\u4e0d\u8fc7\u95ee\u9898\u6765\u4e86\uff0c\u76f4\u63a5dp\u7684\u8bdd\u6211\u4eec\u4f3c\u4e4e\u5f00\u4e0d\u4e0b\u90a3\u4e48\u5927\u7684\u6570\u7ec4\uff0c\u600e\u4e48\u529e\u5462\uff1f\n\n\u6839\u636e$\\lfloor \\frac{n}{d} \\rfloor$\u7684\u4e00\u4e2a\u6027\u8d28\u662f\u5bf9\u4e8e\u540e$\\sqrt{n}$\u79cd\u503c,$n$\u9664\u4ed6\u4eec\u7684\u53d6\u503c\u5404\u4e0d\u76f8\u540c\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5c06\u4ed6\u4eec\u7684\u503c\u5b58\u50a8\u5728\u4e0b\u6807\u4e3a$\\frac{n}{x}$\u7684\u4f4d\u7f6e\u4e0a\n\n\u7136\u540e\u6211\u4eec\u4ece**\u5c0f\u5230\u5927**\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$\\lfloor \\frac{n}{d} \\rfloor$\u7684\u53d6\u503c\u5927\u529bdp\u4e00\u4e0b\u5c31\u641e\u5b9a\u4e86\uff0c\u5f53\u7136\u4e0d\u8981\u5fd8\u8bb0\u7ebf\u6027\u7b5b\u51fa\u6765\u524d$n^{0.67}$\u90e8\u5206\u7684\u70b9\u503c\uff0c\u5426\u5219\u6211\u4eec\u7684\u590d\u6742\u5ea6\u5c06\u4f1a\u9000\u5316\u5230$O(n^{0.75})$\n\n\u8fd9\u4e2a\u8fed\u4ee3\u5199\u6cd5\u4e5f\u8bc1\u660e\u4e86\u4e3a\u4ec0\u4e48\u675c\u6559\u7b5b\u590d\u6742\u5ea6\u8ba1\u7b97\u7684\u65f6\u5019\u53ea\u9700\u5c55\u5f00\u4e00\u5c42\uff0c\u56e0\u4e3a\u6bcf\u6761\u8f6c\u79fb\u7684\u8fb9\u53ea\u4f1a\u88ab\u8bbf\u95ee\u4e00\u6b21,\u540e\u9762\u7684\u90e8\u5206\u4e0d\u662f\u4ec0\u4e48\u9ad8\u9636\u65e0\u7a77\u5c0f\u800c\u5c31\u662f0\uff0c~~\u6069\uff0c\u5c31\u662f\u8fd9\u4e48\u66b4\u529b~~\n\n\u540c\u7406\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528\u8fd9\u4e2atrick\u53bb\u89e3\u51b3\u4e00\u4e0b\u5904\u7406$G$\u51fd\u6570\u7684\u95ee\u9898\uff0c\u6211\u4eec\u628ak\u7684\u7ea6\u6570\u4e4b\u95f4\u7684\u8f6c\u79fb\u8fb9\u5efa\u51fa\u6765\u4e4b\u540e\u5927\u529bdp\u4e5f\u53ef\u4ee5\u505a\u5230\u8fed\u4ee3\u8ba1\u7b97\u4e86\n\n\u4e0a\u4ee3\u7801~\n\n```C\n// luogu-judger-enable-o2\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\nusing namespace std;const int N=45;const int P=5*1e4+10;const int L=3*1e6+10;const int K=2010;\ntypedef long long ll;\nint zhi[L];bool book[L];int ct;int sum[L];int n;int m;int k;\ninline int gcd(int a,int b){if(a<b)swap(a,b);while(b){int c=a%b;a=b;b=c;}return a;}\nstruct arr//\u52a0\u4e86\u79d1\u6280\u7684\u6570\u7ec4\n{\n    ll v1[P];ll v2[P];int mx;int lim;\n    inline ll& operator[](const int& x){return (x<=lim)?v1[x]:v2[mx/x];}\n}dp1[N],gn,dp2[N],gm;ll f[K];int hd;\nint v[K];int x[K];int al[N];int nu[K];int val[N];int q[P<<1];int tot;\ninline void add(int u,int V){v[++ct]=V;x[ct]=al[u];al[u]=ct;}\ninline void sev(int n,arr& dp)//\u8fed\u4ee3\u7248\u675c\u6559\u7b5b\n{\n    tot=0;for(int i=1,r,t;i<=n;i=r+1)t=n/i,q[++tot]=t,r=n/t;\n    for(int i=tot;i>=1;i--)\n    {\n        int t=q[i];if(t<=L-10){dp[t]=sum[t];continue;}ll ret=1;\n        for(int j=2,pr;j<=t;j=pr+1)\n            pr=(t/(t/j)),ret-=(ll)(pr-j+1)*dp[t/j];dp[t]=ret;\n    }\n}\ninline void dypr(int n,arr* dp)//\u8fed\u4ee3\u7248dp\n{\n    tot=0;for(int i=1,r,t;i<=n;i=r+1)t=n/i,q[++tot]=t,r=n/t;\n    for(int i=2;i<=hd;i++)\n        for(int j=al[i];j;j=x[j])\n        {int lc=v[j];int dv=val[lc];for(int k=tot;k>=1;k--)dp[i][q[k]]+=dp[lc][q[k]/dv];}\n}inline ll getf(ll x){return (x/k)*f[k]+f[x%k];}\nint main()\n{\n    sum[1]=1;\n    for(int i=2;i<=L-10;i++)\n    {\n        if(book[i]==false){zhi[++ct]=i;sum[i]=-1;}\n        for(int j=1;j<=ct&&i*zhi[j]<=L-10;j++)\n        {\n            book[i*zhi[j]]=true;\n            if(i%zhi[j]==0)sum[i*zhi[j]]=0;else sum[i*zhi[j]]=-sum[i];\n        }\n    }scanf(\"%d%d%d\",&n,&m,&k);\n    for(int i=1;i<=k;i++)if(k%i==0&&sum[i]!=0)nu[i]=++hd,val[hd]=i;\n    for(int i=1;i<=L-10;i++)sum[i]+=sum[i-1];\n    for(int i=k;i>=1;i--)\n        if(nu[i])for(int j=i;j<=k;j+=i)if(nu[j])add(nu[j],nu[i]);\n    for(int i=1;i<=hd;i++)dp1[i].mx=n,dp1[i].lim=sqrt(n);\n    for(int i=1;i<=hd;i++)dp2[i].mx=m,dp2[i].lim=sqrt(m);\n    sev(n,dp1[1]);dypr(n,dp1);gn=dp1[hd];\n    sev(m,dp2[1]);dypr(m,dp2);gm=dp2[hd];\n    for(int i=1;i<=k;i++)f[i]=f[i-1]+(gcd(k,i)==1);ll ans=0;\n    for(int i=1,r,tp=1;i<=min(n,m);i=r+1)//\u5927\u529b\u6570\u8bba\u5206\u5757\u5c31\u884c\u4e86\n    {\n        int t1=n/i;int t2=m/i;int v1=n/t1;int v2=m/t2;\n        if(v1<v2)ans+=(ll)t1*getf(t2)*(gn[v1]-((tp)?gn[i-1]:gm[i-1])),tp=1,r=v1;\n        else ans+=(ll)t1*getf(t2)*(gm[v2]-((tp)?gn[i-1]:gm[i-1])),tp=0,r=v2;\n    }printf(\"%lld\\n\",ans);return 0;//\u62dc\u62dc\u7a0b\u5e8f~\n}\n```\n\n\n\n\n\n",
        "postTime": 1544337950,
        "uid": 56384,
        "name": "shadowice1984",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P1587 \u3010[NOI2016]\u5faa\u73af\u4e4b\u7f8e\u3011"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u79cd\u8f83\u7b80\u6d01\u7684\u505a\u6cd5\u3002\n\n\u6839\u636e\u5c0f\u5b66\u5965\u6570\uff0c$\\dfrac xy$ \u7b26\u5408\u8981\u6c42\u5f53\u4e14\u4ec5\u5f53 $x\\perp y,y\\perp k$\u3002\n$$\nans=\\sum_{i=1}^n\\sum_{j=1}^m[i\\perp j][j\\perp K]\n$$\n\u8be5\u63d0\u524d\u7684\u8d21\u732e\u90fd\u63d0\u524d\u4e86\uff1a\n$$\nans=\\sum_{i=1}^m[i\\perp K]\\sum_{j=1}^n[i\\perp j]\n$$\n\u4e24\u4e2a\u4e92\u8d28\uff0c\u90fd\u53ef\u4ee5\u83ab\u53cd\u5c55\u5f00\u3002\u4f46\u662f\u5bf9\u8fd9\u79cd\u4e00\u770b\u5c31\u4e0d\u662f\u5957\u8def\u7684\u83ab\u53cd\u9898\uff0c\u8fd8\u662f\u5c0f\u5fc3\u4e3a\u5999\uff0c\u76f4\u63a5\u83bd\u4f1a\u6b7b\u7684\u3002\u8003\u8651\u5148\u628a\u540e\u9762\u7684\u5c55\u5f00\uff08\u4e8b\u5b9e\u4e0a\u901a\u5f80\u4e86\u6b63\u786e\u7684\u9053\u8def\uff09\u3002\n$$\n\\begin{aligned}ans&=\\sum_{i=1}^m[i\\perp K]\\sum_{k\\mid i}\\mu(k)\\!\\left\\lfloor\\dfrac nk\\right\\rfloor\\\\&=\\sum_k\\mu(k)\\!\\left\\lfloor\\dfrac nk\\right\\rfloor\\![k\\perp K]\\sum_{i=1}^{\\left\\lfloor\\frac mk\\right\\rfloor}[i\\perp K]\\end{aligned}\n$$\n\u5230\u8fd9\u91cc\u5df2\u7ecf\u53ef\u4ee5\u505a\u4e86\u3002\u8003\u8651\u5bf9 $k$ \u6574\u9664\u5206\u5757\uff0c\u90a3\u4e48\u6700\u540e\u4e00\u4e2a $\\sum$ \u5c31\u662f\u5173\u4e8e $K$ \u7684\u4e92\u8d28\u51fd\u6570\u7684\u524d\u7f00\u548c\uff0c\u662f\u6709\u5468\u671f\u6027\u7684\uff0c\u9884\u5904\u7406\u524d $k$ \u9879\u5373\u53ef $\\mathrm O(1)$ \u56de\u7b54\u524d\u7f00\u548c\u3002\u73b0\u5728\u8981\u6c42\u7684\u662f $\\mu$ \u4e58\u4ee5\u4e92\u8d28\u51fd\u6570\u7684\u524d\u7f00\u548c\u3002\u5e78\u8fd0\u7684\u662f\uff0c\u4e92\u8d28\u51fd\u6570\u662f\u5b8c\u5168\u79ef\u6027\u7684\uff08\u90a3\u4e3a\u4ec0\u4e48\u4f60\u4e00\u5f00\u59cb\u4e0d $[i\\perp j][i\\perp K]=[i\\perp jK]$ \u5462\uff1f\u56e0\u4e3a\u4e00\u822c\u51fd\u6570\u91cc\u5957\u4e58\u79ef\u7684\u5f0f\u5b50\u90fd\u5f88\u4e0d\u597d\u641e\u3002\u3002\u3002gcd \u53ef\u4ee5\u679a\u4e3e\u7136\u540e\u83ab\u53cd\uff0c\u4e58\u79ef\u5462\uff1f\uff09\uff0c\u4e8e\u662f $(\\mu\\times P)*P=\\epsilon$\uff08\u5176\u4e2d $P$ \u662f\u4e92\u8d28\u51fd\u6570\uff09\u5373\u53ef\u675c\u6559\u7b5b\uff08\u5bf9 $n,m$ \u5404\u7b97\u4e00\u904d\uff09\u3002\u590d\u6742\u5ea6 $\\mathrm O\\!\\left(n^{\\frac 23}+K\\log K\\right)$\u3002",
        "postTime": 1614413030,
        "uid": 138400,
        "name": "chenxia25",
        "ccfLevel": 9,
        "title": "P1587 \u9898\u89e3"
    },
    {
        "content": "\u5728[\u6211\u7684 $\\rm csdn$ \u535a\u5ba2](https://blog.csdn.net/qq_42101694/article/details/113575751)\u4e0a\u4e5f\u53ef\u4ee5\u770b\u5230\u3002~~\u4e0d\u8fc7 csdn \u7684\u535a\u5ba2\u6392\u7248\u611f\u89c9\u6b63\u5728\u53d8\u4e11~~\u3002\n\n# \u9898\u76ee\n\u6c42 $p/q(1\\le p\\le n,\\;1\\le q\\le m,\\;\\gcd(p,q)=1)$ \u8f6c\u5316\u6210 $k$ \u8fdb\u5236\u5c0f\u6570\u540e\u662f\u7eaf\u5faa\u73af\u5c0f\u6570\u7684\u6570\u91cf\u3002\u6bd4\u5982 $10$ \u8fdb\u5236\u4e0b ${1\\over 3}=0.\\overset{.}{3}$ \u662f\uff0c\u800c ${1\\over 6}=0.1\\overset{.}{6}$ \u5219\u4e0d\u662f\u3002\n\n# \u601d\u8def\n~~\u4f17\u6240\u5468\u77e5~~\uff0c\u53ea\u8981\u662f ${x\\over k^L-1}$ \u5c31\u4f1a\u5faa\u73af\uff0c\u65e0\u8bba $x$ \u662f\u4f55\u503c\u3002\u5e76\u4e14\u5faa\u73af\u8282\u4e00\u5b9a\u662f $x\\bmod(k^L-1)$ \u7684\u6a21\u6837\u3002\u8fd9\u662f\u5bb9\u6613\u8bc1\u660e\u7684\u3002\n\n$$\\begin{aligned}\nans&=\\sum_{i=1}^{n}\\sum_{j=1}^{m}\\left[\\exists L,\\exists x,\\;\\frac{i}{j}=\\frac{x}{k^L-1}\\right]\\big[\\gcd(i,j)=1\\big]\\\\\n&=\\sum_{i=1}^{n}\\sum_{j=1}^{m}\\left[\\exists L,\\;j|(k^L-1)\\right]\\big[\\gcd(i,j)=1\\big]\n\\end{aligned}$$\n\n\u8bbe $f(j)=\\sum_{i=1}^{n}\\big[\\gcd(i,j)=1\\big],\\;g(j)=\\big[\\exists L,\\;j|(k^L-1)\\big]$ \uff0c\u90a3\u4e48\n\n$$\nans=\\sum_{j=1}^{m}f(j)g(j)\n$$\n\n\u6211\u4eec\u4e0d\u96be\u53d1\u73b0 $d|x$ \u5219 $(k^d-1)|(k^x-1)$ \u8fd9\u4e2a\u91cd\u8981\u7ed3\u8bba\u3002\u8bc1\u660e\u53ef\u4ee5\u5229\u7528\u56e0\u5f0f\u5b9a\u7406\uff0c\u6216\u8005\u7528\u795e\u5947\u7684\n\n$$\\begin{aligned}\n\\gcd(k^a-1,k^b-1)&=\\gcd(k^a-1,k^b-k^a)\\\\\n&=\\gcd\\big[k^a-1,k^a(k^{b-a}-1)\\big]\\\\\n&=\\gcd(k^a-1,k^{b-a}-1)\\\\\n&=k^{\\gcd(a,b)}-1\n\\end{aligned}$$\n\n\u6765\u5f88\u5bb9\u6613\u5730\u8bf4\u660e\u3002\n\n\u800c $\\gcd(a,b)=1$ \u65f6\uff0c$g(ab)=g(a)g(b)$ \u3002\u8bc1\u660e\uff1a\u5982\u679c $g(a)=g(b)=1$ \uff0c\u90a3\u4e48\u53d6 $L_{ab}=L_a\\times L_b$ \u5373\u53ef\uff1b\u5982\u679c $g(a)$ \u6216 $g(b)=0$ \uff0c\u90a3\u4e48 $k^L-1$ \u8fde $a$ \u6216 $b$ \u7684\u500d\u6570\u90fd\u5f97\u4e0d\u5230\uff0c\u8c08\u4f55 $ab$ \u7684\u500d\u6570\u5462\uff1f\n\n\u4e8e\u662f\u8003\u8651 $g(p)(p\\in\\Bbb{PRIME})$ \u7684\u503c\u3002\u53ea\u8981 $k$ \u4e0d\u662f $p$ \u7684\u500d\u6570\uff0c\u5c31\u4e00\u5b9a\u6709 $k^{\\varphi(p)}-1\\equiv 0\\pmod{p}$ \uff0c\u6545 $g(p)=\\big[\\gcd(k,p)=1\\big]$ \u3002\n\n\u8fdb\u4e00\u6b65\uff0c$k^{\\varphi(p^2)}-1\\equiv 0\\pmod{p^2}$ \uff0c\u53ea\u8981 $k$ \u4e0d\u662f $p$ \u7684\u500d\u6570\u3002\u90a3\u4e48\u6211\u4eec\u5199\u51fa\n\n$$\ng(p^x)=[\\gcd(k,p)=1]\n$$\n\n\u518d\u5229\u7528 $g$ \u662f\u79ef\u6027\u7684\uff0c\u6211\u4eec\u5f97\u5230\n$$\ng(x)=[\\gcd(k,x)=1]\n$$\n\n\u987a\u5e26\u63d0\u4e00\u53e5\uff0c\u8fd9\u91cc $g$ \u8fd8\u662f\u4e00\u4e2a **\u5b8c\u5168\u79ef\u6027** \u51fd\u6570\u5462\u2026\u2026\n\n\u90a3\u4e48 $f(j)$ \u600e\u4e48\u7b97\u634f\uff1f\u8bd5\u4e00\u8bd5\uff1a\n\n$$\\begin{aligned}\nf(j)&=\\sum_{i=1}^{n}\\big[\\gcd(i,j)=1\\big]\\\\\n&=\\sum_{i=1}^{n}\\sum_{p|i,p|j}\\mu(p)\\\\\n&=\\sum_{p|j}\\mu(p)\\left\\lfloor{n\\over p}\\right\\rfloor\n\\end{aligned}$$\n\n\u6240\u4ee5\u6211\u4eec\u91cd\u5199\u4e00\u4e0b\u5f00\u5934\u7684\u5f0f\u5b50\n$$\n\\begin{aligned}\nans&=\\sum_{j=1}^{m}\\sum_{p|j}\\mu(p)\\left\\lfloor{n\\over p}\\right\\rfloor g(j)\\\\\n&=\\sum_{p=1}^{m}\\left\\lfloor{n\\over p}\\right\\rfloor\\mu(p)\\sum_{p|j,\\;j\\le m}g(j)\\\\\n&=\\sum_{p=1}^{m}\\left\\lfloor{n\\over p}\\right\\rfloor \\mu(p)g(p)\\sum_{i=1}^{\\lfloor m/p\\rfloor}g(i)\n\\end{aligned}\n$$\n\n\u591a\u6570\u9898\u89e3\u90fd\u8bb2\u5230\u4e86\u8fd9\u91cc\u3002\u7136\u540e\u4ed6\u4eec\u4f1a\u8bb2\uff0c\u600e\u4e48\u628a $\\mu(p)g(p)$ \u62ff\u53bb\u9012\u63a8\u6c42\u524d\u7f00\u548c\u3002\u4f46\u662f\u6211\u662f\u4e00\u4e2a\u53ea\u559c\u6b22\u66b4\u529b\u7684\u4eba\uff0c\u4e0d\u6015\u4ee3\u7801\u53c8\u81ed\u53c8\u957f\uff0c\u53ea\u6015\u4e00\u884c\u53c8\u4e00\u884c\u7b49\u53f7\u5f00\u5934\uff01\n\n\u6574\u9664\u5206\u5757\uff0c\u5bf9 $\\mu(p)g(p)$ \u548c $g(p)$ \u7528 $\\tt min\\_25$ \u6c42\u524d\u7f00\u548c\u5373\u53ef\u3002\n\n\u5177\u4f53\u600e\u4e48\u6c42\u5462\uff1f\u7528 $f(x)=1$ \u5148\u53bb\u62df\u5408\u4e00\u6ce2\uff0c\u7136\u540e\u624b\u52a8\u628a $g(p)=0$ \u7684 $p$ \u7ed9\u6316\u6389\uff08\u8fd9\u6837\u7684 $p$ \u662f\u5f88\u5c11\u7684\u561b\uff09\u3002\n\n\u5f53\u7136\uff0c~~\u770b\u4e86\u770b\u6d1b\u8c37\u9898\u89e3~~\uff0c\u4f60\u4f1a\u53d1\u73b0 $g(x)$ \u7684\u524d\u7f00\u548c\u53ef\u4ee5\u66f4\u597d\u6c42\u3002\u4ee4 $G(x)=\\sum_{i=1}^{x}g(i)$ \u5219\n\n$$G(x)=\\left\\lfloor{x\\over k}\\right\\rfloor G(k)+G(x\\bmod k)$$\n\n\u6211\u4eec\u53ef\u4ee5 $\\mathcal O(k\\log k)$ \u66b4\u529b\u6c42\u51fa $G(x)(0\\le x\\le k)$ \uff0c\u800c\u540e\u53ef\u4ee5\u76f4\u63a5\u7b97\u3002\n\n# \u4ee3\u7801\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n#include <vector>\n#include <algorithm>\nusing namespace std;\ntypedef long long int_;\ninline int readint(){\n\tint a = 0; char c = getchar(), f = 1;\n\tfor(; c<'0'||c>'9'; c=getchar())\n\t\tif(c == '-') f = -f;\n\tfor(; '0'<=c&&c<='9'; c=getchar())\n\t\ta = (a<<3)+(a<<1)+(c^48);\n\treturn a*f;\n}\n\nconst int MaxN = 80005;\nbool isPrime[MaxN];\nvector< int > primes;\nint smu[MaxN]; // prefix sum of mu\nvector< int > sumf; // real F = mu*g\nvoid sieve(int k){\n\tmemset(isPrime+2,1,MaxN-2);\n\tsmu[1] = 1; // just don't forget it\n\tsumf.push_back(0); // to be bottom\n\tfor(int i=2,len=0; i<MaxN; ++i){\n\t\tif(isPrime[i]){\n\t\t\tprimes.push_back(i), ++ len;\n\t\t\tif(k%i == 0) // g(i) = 0\n\t\t\t\tsumf.push_back(0);\n\t\t\telse sumf.push_back(-1);\n\t\t}\n\t\tfor(int j=0; j<len&&primes[j]<=(MaxN-1)/i; ++j){\n\t\t\tisPrime[i*primes[j]] = false;\n\t\t\tif(i%primes[j] == 0) break;\n\t\t}\n\t}\n\tfor(int i=2,len=primes.size(); i<=len; ++i)\n\t\tsumf[i] += sumf[i-1];\n}\n\nstruct MIN_25{\n\tint haxi[2][MaxN], w[MaxN];\n# define index_(x) (((x) >= MaxN) ? haxi[1][n/(x)] : haxi[0][x])\n\tint g[MaxN]; // F = mu*g begin with F = 1\n\tvoid min_25(int n,int k){\n\t\tint id = 0; // allocate index\n\t\tfor(int i=1; i<=n; i=n/(n/i)+1){\n\t\t\tindex_(n/i) = ++ id;\n\t\t\tg[id] = (w[id] = n/i)-1;\n\t\t}\n\t\t/* Sieve number of primes */ ;\n\t\tfor(int j=0; primes[j]<=n/primes[j]; ++j)\n\t\t\tfor(int i=1; i<=id; ++i){\n\t\t\t\tif(primes[j] > w[i]/primes[j])\n\t\t\t\t\tbreak; // p_j <= sqrt(w)\n\t\t\t\tg[i] -= (g[index_(w[i]/primes[j])]-j);\n\t\t\t}\n\t\t/* Remove special primes */ ;\n\t\tfor(int i=id,j=0,x=0; i; --i){\n\t\t\tfor(; primes[j]<=k; ++j){\n\t\t\t\tif(primes[j] > w[i]) break;\n\t\t\t\tx += !(k%primes[j]); // calc\n\t\t\t}\n\t\t\tg[i] -= x; // remove them\n\t\t}\n\t\t# define FF(x) ((k%(x)) ? -1 : 0)\n\t\t/* Get all ans */ ;\n\t\tfor(int i=1; i<=id; ++i)\n\t\t\tg[i] = -g[i]; // mu(p)*g(p) = -1\n\t\tint j = primes.size();\n\t\tfor(--j; ~j; --j){ // from big to small\n\t\t\tif(primes[j] > n/primes[j])\n\t\t\t\tcontinue; // p_j <= sqrt(n)\n\t\t\tfor(int i=1; i<=id; ++i){\n\t\t\t\tif(primes[j] > w[i]/primes[j])\n\t\t\t\t\tbreak; // good cut branch\n\t\t\t\tg[i] += FF(primes[j])*(\n\t\t\t\t\tg[index_(w[i]/primes[j])]\n\t\t\t\t\t- sumf[j+1]); // JiXing\n\t\t\t}\n\t\t}\n\t}\n};\nMIN_25 fn, fm;\n\n# define sumG(x) (((x)/k)*sxy[k]+sxy[(x)%k])\nint sxy[MaxN];\nint main(){\n\tint n = readint(), m = readint();\n\tint k = readint();\n\tfor(int i=1; i<=k; ++i){\n\t\tsxy[i] = sxy[i-1]; // prefix sum\n\t\tif(__gcd(i,k) == 1) // coprime\n\t\t\t++ sxy[i]; // add one\n\t}\n\tsieve(k); fn.min_25(n,k);\n\tfm.min_25(m,k);\n\tint lst = 0, now; int_ ans = 0, fk;\n\tfor(int l=1,r; l<=m&&l<=n; l=r+1){\n\t\tr = min(n/(n/l),m/(m/l));\n\t\tfk = 1ll*sumG(m/l)*(n/l);\n\t\tif(r == n/(n/l)) if(r >= MaxN)\n\t\t\tnow = fn.g[fn.haxi[1][n/r]];\n\t\t\telse now = fn.g[fn.haxi[0][r]];\n\t\telse if(r >= MaxN)\n\t\t\tnow = fm.g[fm.haxi[1][m/r]];\n\t\telse now = fm.g[fm.haxi[0][r]];\n\t\tans += fk*(now+1-lst);\n\t\tlst = now+1; // mu(1)*g(1) = 1\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n\n# \u540e\u8bb0\n\u6ca1\u60f3\u5230 $\\mathcal O({n^{3/4}\\over \\ln n})$ \u8dd1\u4e86\u6700\u4f18\u89e3\uff1f\n\n$\\tt 2021/2/3\\;11:45$ \u6700\u4f18\u89e3\u7559\u5ff5 :)\n\n\u987a\u4fbf\u5410\u69fd\u4e00\u4e0b\uff0c$\\rm csdn$ \u662f\u652f\u6301\u4f7f\u7528 `\\exist` \u7684\uff0c\u800c\u67d0\u8c37\u53ea\u652f\u6301 `\\exists` \uff0c~~\u641e\u5f97\u6211\u8fd8\u67e5\u4e86\u4e00\u4e0b\u67d0\u8c37\u91cc\u600e\u4e48\u6253\u5b58\u5728\u7b26\u53f7~~\u3002\n",
        "postTime": 1612324281,
        "uid": 123796,
        "name": "Damo",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1587 \u3010[NOI2016] \u5faa\u73af\u4e4b\u7f8e\u3011"
    },
    {
        "content": "\u8fd9\u91cc\u5927\u6982\u6709\u4e00\u4e2a\u548c\u5927\u5bb6\u4e0d\u4e00\u6837\u7684\u505a\u6cd5\uff0c\u590f\u4ee4\u8425\u8bb2\u5230\u7684\u3002\n\n\u975e\u5e38\u6709\u8da3\u4e14\u5947\u5999\u7684\u4e00\u9053\u9898\u3002\n\n\u8fd8\u662f\u4ece\u5934\u5f00\u59cb\u8bb2\u3002\n\n$\\dfrac xy$ \u53ea\u8ba1\u7b97\u4e00\u6b21\uff0c\u6211\u4eec\u53ea\u7edf\u8ba1 $x\\perp y$ \u7684\u5c31\u597d\u3002\u5782\u76f4\u7b26\u53f7\u8868\u793a\u4e92\u8d28\uff0c\u540e\u9762\u8fd8\u4f1a\u7528\u5230\u3002\n\n\u540c\u65f6\u6709\u5206\u6bcd $y\\perp k$\uff0c\u53c2\u89c1\u5176\u4ed6\u4eba\u7684\u8bc1\u660e\u3002\u6c42\uff1a\n\n$$\\sum_{x=1}^n\\sum_{y=1}^m[x\\perp y][y\\perp k]$$\n\n\u6211\u4eec\u9996\u5148\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u63a8\u5bfc\u4e00\u4e0b\u3002\n\n$$\\begin{aligned}\n&\\ \\ \\ \\ \\sum_{x=1}^n\\sum_{y=1}^m[x\\perp y][y\\perp k] \\\\\n&=\\sum_{x=1}^n\\sum_{y=1}^m\\sum_{d|x,d|y}\\mu(d)[y\\perp k] \n=\\sum_{d=1}^{\\min(n,m)}\\mu(d)\\lfloor\\frac nd\\rfloor\\sum_{y=1}^{m/d}[dy\\perp k] \\\\\n&=\\sum_{d=1}^{\\min(n,m)}\\lfloor\\frac nd\\rfloor\\mu(d)[d\\perp k]\\sum_{y=1}^{m/d}[y\\perp k] \n\\end{aligned}$$\n\n\u5176\u4e2d $[dy\\perp k]$ \u53ef\u4ee5\u5206\u89e3\u4e3a $[d\\perp k][y\\perp k]$\u3002\n\n\u8bbe\n\n$$f(n)=\\sum_{i=1}^n[i\\perp k]$$\n\n\u539f\u5f0f\u4e3a\n\n$$\\sum_{d=1}^{\\min(n,m)}\\lfloor\\frac nd\\rfloor f(\\lfloor\\frac md\\rfloor)\\mu(d)[d\\perp k]$$\n\n\u663e\u7136\u53ef\u4ee5\u4e8c\u7ef4\u7684\u6574\u9664\u5206\u5757\uff1b\u7136\u540e\u6211\u4eec\u9700\u8981\u6c42\u51fa $f(n)$ \u7684\u5355\u70b9\u503c\u548c $\\mu(d)[d\\perp k]$ \u7684\u524d\u7f00\u548c\u3002\n\n---\n\n\u8003\u8651 $k$ \u7684\u8303\u56f4\u975e\u5e38\u5c0f\uff0c\u628a $n$ \u6309\u7167\u4e00\u6bb5\u957f $k$ \u5206\u6bb5\uff0c\u5bb9\u6613\u5f97\u5230\uff1a\n\n$$\\begin{aligned}\nf(n)&=\\lfloor\\frac nk\\rfloor\\sum_{i=1}^k[i\\perp k]+\\sum_{i=1}^{n\\bmod k}[i\\perp k]\\\\\n&=\\lfloor\\frac nk\\rfloor f(k) +f(n\\bmod k)\n\\end{aligned}$$\n\n\u4e8e\u662f\u751a\u81f3\u4e0d\u7528\u7ebf\u6027\u7b5b $\\varphi$\uff0c\u66b4\u529b\u6c42 $f(n)$ \u5230 $k$ \u5373\u53ef\u3002\n\n\u53d1\u73b0\u76f4\u5230\u8fd9\u91cc\u505a\u6cd5\u90fd\u5b8c\u5168\u4e00\u6837\u3002\n\n---\n\n\u8bbe\u6709\n\n$$g(n,k)=\\sum_{i=1}^n\\mu(i)[i\\perp k] $$\n\n\u4e00\u79cd\u65b9\u6cd5\u662f\u8003\u8651\u76f4\u63a5\u83ab\u53cd\u3002\n\n$$\\begin{aligned}\ng(n,k)&=\\sum_{i=1}^n\\mu(i)\\sum_{d|i,d|k}\\mu(d) \n=\\sum_{d|k}\\mu(d)\\sum_{d|i}\\mu(i) \\\\\n&=\\sum_{d|k}\\mu(d)\\sum_{i=1}^{n/d}\\mu(id)\n\\end{aligned}$$\n\n\u63a5\u4e0b\u6765\u6709\u6027\u8d28\uff1a$\\mu(xy)=\\mu(x)\\mu(y)[x\\perp y]$\uff0c\u6b63\u786e\u6027\u663e\u7136\u3002\n\n$$\\begin{aligned}\ng(n,k)&=\\sum_{d|k}\\mu(d)\\sum_{i=1}^{n/d}\\mu(i)\\mu(d)[i\\perp d]\n=\\sum_{d|k}\\mu^2(d)\\sum_{i=1}^{n/d}\\mu(i)[i\\perp d] \\\\\n&=\\sum_{d|k}\\mu^2(d)g(\\lfloor\\frac nd\\rfloor,d)\n\\end{aligned}$$\n\n\u679a\u4e3e\u56e0\u5b50\u9012\u5f52\u4e0b\u53bb\u3002\n\n\u53e6\u4e00\u79cd\u65b9\u6cd5\u4e2d\uff0c\u8003\u8651 $k$ \u4e2d\u7684\u8d28\u56e0\u5b50\uff0c\u53d1\u73b0\u6211\u4eec\u53ea\u5173\u5fc3\u662f\u5426\u6709\u8fd9\u4e2a\u56e0\u5b50\uff0c\u800c\u4e0d\u8003\u8651\u5b83\u7684\u6b21\u6570\u3002\n\n\u4e8e\u662f\u5f97\u5230\u65b0\u505a\u6cd5\uff1a\u4ece $k$ \u4e2d\u53d6\u51fa\u8d28\u56e0\u5b50\u9012\u5f52\u3002\n\n$p$ \u662f $k$ \u4e2d\u67d0\u4e00\u4e2a\u8d28\u56e0\u5b50\u3002\n\n$$\\begin{aligned}\ng(n,k)&=\\sum_{i=1}^n\\mu(i)[i\\perp k] \\\\\n&=\\sum_{i=1}^n\\mu(i)[i\\perp\\frac kp]-\\sum_{i=1}^n\\mu(i)[i\\perp\\frac kp][p|i]\n\\end{aligned}$$\n\n\u56e0\u4e3a $p\\not\\perp i$ \u7b49\u4ef7\u4e8e $p|i$\uff0c\u51cf\u53bb\u8fd9\u90e8\u5206\u4e0d\u5408\u6cd5\u7684\u3002\n\n$$\\begin{aligned}\ng(n,k)&=g(n,\\frac kp)-\\sum_{i=1}^{n/p}\\mu(ip)[ip\\perp\\frac kp] \\\\\n&=g(n,\\frac kp)-\\sum_{i=1}^{n/p}\\mu(i)\\mu(p)[i\\perp p][i\\perp\\frac kp] \\\\\n&=g(n,\\frac kp)-\\mu(p)\\sum_{i=1}^{n/p}\\mu(i)[i\\perp k] \\\\\n&=g(n,\\frac kp)+g(\\lfloor\\frac np\\rfloor,k)\n\\end{aligned}$$\n\n\u5176\u4e2d\u7528\u5230\u4e86 $\\mu(p)=(-1)^1=-1$\u3002\n\n\u4e8e\u662f\u5728\u5f00\u59cb\u53ef\u4ee5\u5c06 $k$ \u4e2d\u8d28\u56e0\u5b50\u53bb\u91cd\uff0c\u5e76\u8bb0\u5f55\u5176\u8d28\u56e0\u5b50\u3002\u9012\u5f52\u4e2d\u6807\u8bb0\u5269\u4e0b\u54ea\u4e9b\u5373\u53ef\uff0c\u540c\u6837\u7528\u4e8c\u7ef4\u7684 `unordered_map` \u53bb\u91cd\u3002\n\n\u8fb9\u754c\u4e5f\u5bb9\u6613\u5904\u7406\uff0c\u4e3a $g(0,k)=1$\uff0c\u53ca $g(n,1)=\\sum_{i=1}^n\\mu(i)$\uff0c\u675c\u6559\u7b5b\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u524d\u7f00\u5373\u53ef\u3002\n\n---\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790\uff1a\n\n\u5904\u7406 $f(n)$ \u590d\u6742\u5ea6 $O(k\\log k)$\uff1b\n\n\u675c\u6559\u7b5b $\\mu(n)$ \u524d\u7f00\u590d\u6742\u5ea6 $O(n^{\\frac 23})$\uff1b\n\n\u9012\u5f52\u6c42 $g(n,k)$ \u4e2d\uff0c\u7b2c\u4e00\u7ef4\u72b6\u6001\u6709 $O(\\sqrt n)$ \u4e2a\uff0c\u7b2c\u4e8c\u7ef4\u6709 $k$ \u7684\u7d20\u56e0\u5b50\u4e2a\u6570\uff0c\u7c97\u7565\u4f30\u8ba1\u6709 $O(\\dfrac{\\log k}{\\log\\log k})$ \u4e2a\u3002\u5927\u6982\u6bd4 $d(k)$ \u7684\u505a\u6cd5\u66f4\u4f18\uff1f\n\n\u6700\u540e\u7684\u6574\u9664\u5206\u5757\u662f $O(\\sqrt n)$ \u7684\u3002\n\n\u4e8e\u662f\u603b\u65f6\u95f4\u5927\u7ea6\u662f $O(k\\log k+n^{\\frac 23}+\\sqrt n\\dfrac{\\log k}{\\log\\log k})$ \u7684\u3002\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n#include <cmath>\n#include <algorithm>\n#include <unordered_map>\n\ntypedef long long ll;\nconst int V = 1000000001;\nconst int S = 1000001;\nconst int K = 2001;\n\ninline int read() {\n    int x = 0, f = 1; char ch = getchar();\n    while(ch > '9' || ch < '0') { if(ch == '-') f = -1; ch = getchar(); }\n    do x = x * 10 + ch - 48, ch = getchar(); while(ch >= '0' && ch <= '9');\n    return x * f;\n}\n\nint gcd(int a,int b) {\n\tint t;\n\twhile(b) { t = a, a = b, b = t % b; }\n\treturn a;\n}\n\nint n, m, k;\nint df[S],p[S],tt,mu[S];\n\nvoid Seive() {\n    mu[1] = 1;\n    for(int i = 2;i < S;i++) {\n        if(!df[i]) p[++tt] = i, mu[i] = -1;\n        for(int j = 1;j <= tt && i * p[j] < S;j++) {\n            int t = i * p[j]; df[t] = 1;\n            if(i % p[j]) mu[t] = -mu[i];\n\t\t\telse mu[t] = 0;\n        }\n    }\n    for(int i = 1;i < S;i++) mu[i] += mu[i - 1];\n    return;\n}\n\nll f[K];\nll F(int n) { return f[k] * (n / k) + f[n % k]; }\n\nstd::unordered_map <ll,int> Mu;\nint Mobius(ll n) {\n    if(n < S) return mu[n];\n    else if(Mu.count(n)) return Mu[n];\n    int ans = 1;\n    for(int i = 2;i <= n;i++) {\n        int j = n / (n / i);\n        ans -= (j - i + 1) * Mobius(n / i);\n        i = j;\n    }\n    return Mu[n] = ans;\n}\n\nstd::unordered_map <ll,std::unordered_map <ll,ll> > g;\nint pk[S],tot;\nll G(ll n,ll k,int now) {\n    if(!n) return 0; if(k == 1) return Mobius(n);\n    if(g[n].count(k)) return g[n][k];\n    return g[n][k] = G(n,k / pk[now],now + 1) + G(n / pk[now],k,now);\n}\n\nint main() {\n    Seive();\n    n = read(), m = read(), k = read();\n    for(int i = 1;i <= tt && p[i] <= k;i++) {\n        while(!(k % (p[i] * p[i]))) k /= p[i];\n        if(!(k % p[i])) pk[++tot] = p[i];\n    }\n\tfor(int i = 1;i <= k;i++) {\n\t\tif(gcd(i,k) == 1) f[i] = 1;\n\t\tf[i] += f[i - 1];\n\t}\n\tll ans = 0;\n\tfor(ll i = 1;i <= n && i <= m;i++) {\n\t\tll j = std::min(n / (n / i),m / (m / i));\n\t\t// std::printf(\"%lld %lld %lld\\n\",n / i,F(m / i),G(j,k,1));\n\t\tans += (n / i) * F(m / i) * (G(j,k,1) - G(i - 1,k,1));\n\t\ti = j;\n\t}\n\tstd::printf(\"%lld\\n\",ans);\n    return 0;\n}\n\n```\n\u611f\u8c22\u795e @11Dimensions \u7684\u601d\u8def\u3002",
        "postTime": 1597466014,
        "uid": 219595,
        "name": "Vocalise",
        "ccfLevel": 9,
        "title": "\u675c\u6559\u7b5b\u9012\u63a8---\u9898\u89e3 P1587 \u3010[NOI2016]\u5faa\u73af\u4e4b\u7f8e\u3011"
    },
    {
        "content": "\u5927\u6982\u6bd4\u8f83\u65e0\u8111\u7684\u505a\u6cd5\uff1f~~\u5176\u5b9e\u8fd8\u662f\u5ad6\u7684\u3002~~\n\n\u9898\u76ee\u5c31\u662f\u8ba9\u6211\u4eec\u6c42\n$$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m[\\gcd(i,j)=1][\\gcd(j,k)=1]$$\n\u628a $[\\gcd(j,k)=1]$ \u7528\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u5904\u7406\uff0c\u5f97\u5230\n$$=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m[\\gcd(i,j)=1]\\sum\\limits_{d|j,d|k}\\mu(d)$$\n\u63d0\u5230\u524d\u9762\u53bb\n$$=\\sum\\limits_{d|k}\\mu(d)\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^{\\lfloor\\frac md\\rfloor}[\\gcd(i,dj)=1]$$\n\u4f3c\u4e4e\u6709\u70b9\u773c\u719f\uff1f\u7ee7\u7eed\u53d8\u5f62\u4e00\u4e0b\uff1a\n$$=\\sum\\limits_{d|k}\\mu(d)\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^{\\lfloor\\frac md\\rfloor}[\\gcd(i,j)=1][\\gcd(i,d)=1]$$\n\u8fd9\u4e2a\u65f6\u5019\u4f60\u5927\u6982\u5c31\u770b\u51fa\u6765\u4e86\uff0c\u540e\u9762\u8fd9\u4e2a\u4e1c\u897f\u7684\u5f62\u5f0f\u4e0e\u4e00\u5f00\u59cb\u7684\u5f0f\u5b50\u662f\u4e00\u6a21\u4e00\u6837\u7684\u3002\u6211\u4eec\u8bbe\u7b54\u6848\u7b49\u4e8e $f(n,m,k)$\uff0c\u5219\u6709\n$$f(n,m,k)=\\sum\\limits_{d|k}\\mu(d)f(\\lfloor\\frac md\\rfloor,n,d)$$\n\u675c\u6559\u7b5b $\\mu$\uff0c\u9012\u5f52\u4e0b\u53bb\u7b97\u5373\u53ef\u3002\u7ecf\u8fc7\u7c7b\u4f3c\u4e8e\u675c\u6559\u7b5b\uff08\uff1f\uff09\u7684\u4e00\u4e9b\u5206\u6790\u53ef\u4ee5\u5f97\u5230\u590d\u6742\u5ea6\u662f $O(n^{\\frac23})$\uff08\uff1f\uff09\u3002\n\n\u7136\u540e\u76f4\u63a5\u5199\u7684\u8bdd\u4f1a\u88ab\u5361\u6210 $92$\u3002\u6709\u4e00\u4e2a\u4f18\u5316\u662f $\\mu(d)=0$ \u7684\u65f6\u5019\u5c31\u4e0d\u7528\u9012\u5f52\u4e0b\u53bb\u4e86\uff0c\u5c31\u8fc7\u4e86\u3002\n```cpp\n#include<algorithm>\n#include<unordered_map>\n#include<vector>\n#include<cctype>\n#include<cstdio>\nusing namespace std;\ninline int readint(){\n\tint x=0;\n\tbool f=0;\n\tchar c=getchar();\n\twhile(!isdigit(c)&&c!='-') c=getchar();\n\tif(c=='-'){\n\t\tf=1;\n\t\tc=getchar();\n\t}\n\twhile(isdigit(c)){\n\t\tx=x*10+c-'0';\n\t\tc=getchar();\n\t}\n\treturn f?-x:x;\n}\nconst int mm=1e6;\nint mf[mm];\nvector<int> p;\ntypedef long long ll;\nll mu[mm],s[mm];\nvector<int> fac;\nunordered_map<int,ll> dp;\nll sum(int n){\n\tif(n<mm) return s[n];\n\tif(dp.count(n)) return dp[n];\n\tll res=1;\n\tint l=2;\n\twhile(l<=n){\n\t\tint r=n/(n/l);\n\t\tres-=sum(n/l)*(r-l+1);\n\t\tl=r+1;\n\t}\n\treturn dp[n]=res;\n}\nll f(int n,int m,int k){\n\tif(!n||!m) return 0;\n\tif(k==1){\n\t\tint l=1;\n\t\tll ans=0;\n\t\twhile(l<=min(n,m)){\n\t\t\tint r=min(n/(n/l),m/(m/l));\n\t\t\tans+=(sum(r)-sum(l-1))*(n/l)*(m/l);\n\t\t\tl=r+1;\n\t\t}\n\t\treturn ans;\n\t}\n\tll ans=0;\n\tfor(int i=0;i<(int)fac.size();i++)\n\t\tif(k%fac[i]==0&&mu[fac[i]])\n\t\t\tans+=mu[fac[i]]*f(m/fac[i],n,fac[i]);\n\treturn ans;\n}\nint main(){\n\t#ifdef LOCAL\n\tfreopen(\"in.txt\",\"r\",stdin);\n\tfreopen(\"out.txt\",\"w\",stdout);\n\t#endif\n\tfor(int i=2;i<mm;i++){\n\t\tif(!mf[i]) p.push_back(i);\n\t\tfor(int j=0;j<(int)p.size()&&i*p[j]<mm;j++){\n\t\t\tmf[i*p[j]]=p[j];\n\t\t\tif(i%p[j]==0) break;\n\t\t}\n\t}\n\tmu[1]=1;\n\tfor(int i=2;i<mm;i++)\n\t\tif(!mf[i]) mu[i]=-1;\n\t\telse{\n\t\t\tif(i/mf[i]%mf[i]==0) mu[i]=0;\n\t\t\telse mu[i]=mu[mf[i]]*mu[i/mf[i]];\n\t\t}\n\tfor(int i=1;i<mm;i++) s[i]=s[i-1]+mu[i];\n\tint n,m,k;\n\tn=readint();\n\tm=readint();\n\tk=readint();\n\tfor(int i=1;i*i<=k;i++) if(k%i==0){\n\t\tfac.push_back(i);\n\t\tif(i*i!=k) fac.push_back(k/i);\n\t}\n\tprintf(\"%lld\\n\",f(n,m,k));\n\treturn 0;\n}\n```",
        "postTime": 1591521678,
        "uid": 174045,
        "name": "FZzzz",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1587 \u3010[NOI2016]\u5faa\u73af\u4e4b\u7f8e\u3011"
    },
    {
        "content": "&emsp;&emsp;\u9996\u5148\u6839\u636e\u5b9a\u4e49\uff0c\u53ef\u4ee5\u63a8\u51fa\u5f53\u4e14\u4ec5\u5f53\u5b58\u5728$x*k^l \\equiv x*k(mod$ $y)$\u7684\u65f6\u5019\u5206\u6570\u662f\u4e2a\u7eaf\u5faa\u73af\u7684\n\n&emsp;&emsp;\u90a3\u4e48\u5c31\u6709\u5b58\u5728$k^{l-1} \\equiv1(mod y)$\n\n&emsp;&emsp;\u4e8e\u662f\u5c31\u6709$gcd(k,y)=1$,\u53c8\u56e0\u4e3a\u8981\u6700\u7b80\u5206\u6570\uff0c\u53c8\u6709$gcd(x,y)=1$\n\n&emsp;&emsp;\u4e8e\u662f\u7b54\u6848\u5c31\u662f\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{m}[gcd(i,j)=1][gcd(j,k)=1]$$\n\n&emsp;&emsp;\u8003\u8651\u628a$i$\u63d0\u5230\u540e\u9762\uff0c\u5c31\u662f\n$$\\sum_{j=1}^{m}[gcd(j,k)=1]\\sum_{i=1}^{n}[gcd(i,j)=1]$$\n\n&emsp;&emsp;\u5bf9\u540e\u9762\u8fd9\u4e2a$\\sum_{i=1}^{n}[gcd(i,j)=1]$\u83ab\u53cd\u4e00\u53d1\uff1a\n\n$$f(x)=\\sum_{i=1}^{n}[gcd(i,j)=x]$$\n\n$$g(x)=\\sum_{x|d}f(d)=\\sum_{i=1}^{n}[x|i][x|j]$$\n\n$$f(x)=\\sum_{x|d}\\mu(\\frac{d}{x})g(d)$$\n\n$$f(1)=\\sum_{i=1}^{n}\\mu(i)\\sum_{d=1}^{n}[i|d][i|j]=\\sum_{i=1}^{n}\\mu(i)\\lfloor\\frac{n}{i}\\rfloor[i|j]$$\n\n&emsp;&emsp;\u90a3\u4e48\u539f\u5f0f\u5c31\u662f\n$$\\sum_{j=1}^{m}[gcd(j,k)=1]\\sum_{i=1}^{n}\\mu(i)\\lfloor\\frac{n}{i}\\rfloor[i|j]$$\n\n&emsp;&emsp;\u4fee\u6539\u679a\u4e3e$j$\u662f$i$\u7684\u591a\u5c11\u500d\u3002\n\n$$\\sum_{i=1}^{n}\\mu(i)\\lfloor\\frac{n}{i}\\rfloor\\sum_{j=1}^{\\lfloor\\frac{m}{i}\\rfloor}[gcd(ij,k)=1]$$\n\n&emsp;&emsp;\u628a$gcd$\u62c6\u51fa\u6765\n\n$$\\sum_{i=1}^{n}\\mu(i)\\lfloor\\frac{n}{i}\\rfloor[gcd(i,k)=1]\\sum_{j=1}^{\\lfloor\\frac{m}{i}\\rfloor}[gcd(j,k)=1]$$\n\n&emsp;&emsp;\u4ee4$f(x)=\\sum_{i=1}^{x}[gcd(i,k)=1]$\n\n&emsp;&emsp;\u56e0\u4e3a$gcd(a,b)=gcd(a$ $mod$ $b,b)$,\u6240\u4ee5\u6bcf$k$\u4e2a$[gcd(i,k)=1]$\u7684\u503c\u662f\u4e00\u6837\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4$f(x)=\\lfloor\\frac{x}{k}\\rfloor f(k)+f(x$ $mod$ $k)$,\u53ea\u8981\u66b4\u529b\u5904\u7406$k$\u4ee5\u5185\u7684$O(1)$\u6c42$f$\u4e86\uff0c\u800c$k<=2000$,\u6240\u4ee5\u663e\u7136\u53ef\u4ee5\u63a5\u53d7\u3002\n\n&emsp;&emsp;\u90a3\u4e48\u539f\u5f0f\u5c31\u662f\n\n$$\\sum_{i=1}^{n}\\mu(i)\\lfloor\\frac{n}{i}\\rfloor[gcd(i,k)=1]f(\\lfloor\\frac{m}{i}\\rfloor)$$\n\n&emsp;&emsp;\u518d\u8bbe$g(x)=\\sum_{i=1}^{x}\\mu(i)[gcd(i,k)=1]$\n\n$$\\sum_{i=1}^{n}\\lfloor\\frac{n}{i}\\rfloor g(\\lfloor\\frac{n}{i}\\rfloor)f(\\lfloor\\frac{m}{i}\\rfloor)$$\n\n&emsp;&emsp;\u8fd9\u91cc\u53ea\u8981$O(n)$\u5904\u7406$g(x)$,\u7136\u540e\u6570\u8bba\u5206\u5757\u5c31\u53ef\u4ee5\u62ff$84pts$\u4e86\uff0c\u8fd9\u5e94\u8be5\u662f\u8003\u573a\u4e0a\u80fd\u641e\u5230\u7684\u5206\u6570\u3002\n\n&emsp;&emsp;\u7136\u540e\u8003\u8651\u600e\u4e48\u5feb\u901f\u5904\u7406$g(x)$:\n\n$$[gcd(i,k)=1]=\\sum_{d|gcd(i,k)}\\mu(d)=\\sum_{d|i,d|k}\\mu(d)$$\n\n$$g(x)=\\sum_{i=1}^{x}\\mu(i)\\sum_{d|i,d|k}\\mu(d)$$\n\n&emsp;&emsp;$ps$:\u63a8\u5230\u8fd9\u91cc\u6211$sb$\u4e86\u4e00\u4e0b\uff0c\u60f3\u7740\u76f4\u63a5\u628a$\\mu(i)$\u548c$\\mu(d)$\u4e58\u8d77\u6765\uff0c\u5fd8\u4e86$\\mu$\u53ea\u662f\u79ef\u6027\u800c\u4e0d\u662f\u5b8c\u5168\u79ef\u6027\u3002\n\n&emsp;&emsp;\u90a3\u4e48\u66f4\u6539\u679a\u4e3e\u9879\u4e3a$d$,\u5e76\u679a\u4e3e$i$\u662f$d$\u7684\u51e0\u500d\uff0c\u4ece\u800c\u62b9\u6389$d|k$\u548c$d|i$\u7684\u9650\u5236:\n\n$$g(x)=\\sum_{d|k}\\mu(d)\\sum_{i=1}^{x/d}\\mu(id)$$\n\n&emsp;&emsp;\u8fd9\u91cc\u662f\u6700\u5999\u7684\u4e00\u6b65\uff0c\u6839\u636e\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u7684\u5b9a\u4e49\uff0c\u53ea\u6709$gcd(i,d)=1$\u7684\u65f6\u5019$\\mu(id)!=0$,\u90a3\u4e48\u53ef\u4ee5\u5f80\u540e\u6254\u4e00\u4e2a$[gcd(i,d)=1]$:\n\n$$g(x)=\\sum_{d|k}\\mu(d)\\sum_{i=1}^{x/d}\\mu(id)[gcd(i,d)=1]$$\n\n&emsp;&emsp;\u4e4b\u524d\u8bf4\u4e86\uff0c\u4e4b\u524d\u4e0d\u80fd\u62c6\u6216\u8005\u4e58\uff0c\u662f\u56e0\u4e3a$\\mu$\u4e0d\u662f\u5b8c\u5168\u79ef\u6027\u7684\uff0c\u53ea\u6709\u4e92\u8d28\u624d\u80fd\u64cd\u4f5c\uff0c\u800c\u73b0\u5728$gcd(i,d)=1$,\u6211\u4eec\u5c31\u53ef\u4ee5\u628a$d$\u6254\u5230\u524d\u9762\u53bb\uff1a\n\n$$g(x)=\\sum_{d|k}\\mu^2(d)\\sum_{i=1}^{x/d}\\mu(i)[gcd(i,d)=1]$$\n\n&emsp;&emsp;\u6211\u4eec\u628a$g(x)$\u6700\u521d\u7684\u5f0f\u5b50\u63d0\u51fa\u6765\uff1a\n\n$$g(x)=\\sum_{i=1}^{x}\\mu(i)[gcd(i,k)=1]$$\n\n&emsp;&emsp;\u5728\u770b\u4e0b\u73b0\u5728\u540e\u9762\u8fd9\u4e00\u5757\uff1a\n\n$$\\sum_{i=1}^{x/d}\\mu(i)[gcd(i,d)=1]$$\n\n&emsp;&emsp;\u552f\u4e00\u4e0d\u540c\u7684\u662f$x$\u53d8\u6210\u4e86$x/d$\uff0c$k$\u53d8\u6210\u4e86$d$\uff0c\u4e8e\u662f\u6211\u4eec\u5b9a\u4e49\uff1a\n\n$$g(x,k)=\\sum_{i=1}^{x}\\mu(i)[gcd(i,k)=1]$$\n\n&emsp;&emsp;\u5c31\u6709\uff1a\n\n$$g(x,k)=\\sum_{d|k}\\mu^2(d)g(x/d,d)$$\n\n&emsp;&emsp;\u8fb9\u754c\u662f\u4ec0\u4e48\u5462\uff0c\u76ef\u7740\u8fd9\u4e2a\u6700\u521d\u7684\u5f0f\u5b50\uff1a\n\n$$g(x,k)=\\sum_{i=1}^{x}\\mu(i)[gcd(i,k)=1]$$\n\n&emsp;&emsp;\u5f53$x=0$,\u65e0\u6cd5\u9012\u5f52\uff0c$g(x,k)=0$;\n\n&emsp;&emsp;\u5f53$x=1$,\u53ef\u4ee5\u9012\u5f52\u6210$x=0$\uff0c\u4e5f\u53ef\u4ee5\u770b\u51fa$g(1,k)=\\mu(1)=1$\n\n&emsp;&emsp;\u5f53$k=1$,\u65e0\u6cd5\u9012\u5f52\uff0c$g(x,k)=\\sum_{i=1}^{x}\\mu(i)$,\u4f46\u662f\u8fd9\u4e2a$x$\u53ef\u4ee5\u5f88\u5927\uff0c\u6211\u4eec\u675c\u6559\u7b5b\u8fd9\u4e2a\u524d\u7f00\u548c\u3002\n\n&emsp;&emsp;\u4f46\u662f\u6211\u8fd8\u4e0d\u4f1a\u8bc1\u660e\u66b4\u529b\u679a\u4e3e$k$\u7684\u7ea6\u6570\u9012\u5f52\u7b97$g(x)$\u590d\u6742\u5ea6\u4e3a\u4ec0\u4e48\u662f\u5bf9\u7684\uff0c\u5373\u4fbf\u5b83\u8bb0\u5fc6\u5316\u4e86(\u7136\u800c\u5b83\u5c31\u662f\u5bf9\u7684)\u3002\n\n&emsp;&emsp;$trick:$\u7b97$g(x,k)$\u7684\u65f6\u5019\u5982\u679c$\\mu(d)=0$\u5c31\u4e0d\u8981\u9012\u5f52\u4e86\uff0c\u4e0d\u7136\u4f1a$T$\u6389\u3002\n\n&emsp;&emsp;$ps:$\u8bb0\u5fc6\u5316\u4e8c\u5143\u7ec4$g(x,k)$\u7684\u65f6\u5019\u8bb0\u5f97\u5f00$pair$\uff0c$struct$\u4f3c\u4e4e\u5bf9\u4e0d\u4e0a$map$\u7ea2\u9ed1\u6811\u7684\u63a5\u53e3\u3002\n",
        "postTime": 1560148793,
        "uid": 130060,
        "name": "TopCarry",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1587 \u3010[NOI2016]\u5faa\u73af\u4e4b\u7f8e\u3011"
    },
    {
        "content": "\u6c42 $k$ \u8fdb\u5236\u4e0b\u53ef\u4ee5\u8868\u793a\u4e3a\u7eaf\u5faa\u73af\u5c0f\u6570\uff08\u8ba4\u4e3a\u6574\u6570\u4e5f\u662f\uff09\u7684\u65e2\u7ea6\u5206\u6570 $\\dfrac{i}{j}$\uff0c\u4e14 $1\\leqslant i\\leqslant n$\uff0c$1\\leqslant j\\leqslant m$ \u7684\u4e2a\u6570\u3002$n,m\\leqslant 10^9$\uff0c$k\\leqslant 2000$\u3002\n\n\u7ecf\u8fc7\u5c1d\u8bd5\u53ef\u4ee5\u53d1\u73b0\uff0c\u65e2\u7ea6\u5206\u6570 $\\dfrac{i}{j}$ \u5728 $k$ \u8fdb\u5236\u4e0b\u662f\u7eaf\u5faa\u73af\u7684\u5f53\u4e14\u4ec5\u5f53 $\\gcd(j,k)=1$\uff08\u8bc1\u660e\u53ef\u4ee5\u89c1\u5176\u5b83\u9898\u89e3\uff09\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6c42\n$$\n\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m[\\gcd(i,j)=1][\\gcd(j,k)=1]\n$$\n\u56e0\u4e3a\u8981\u65e2\u7ea6\u5206\u6570\uff0c\u6240\u4ee5\u8981\u4fdd\u8bc1 $\\gcd(i,j)=1$\u3002\n\n\u56e0\u4e3a\u4e24\u4e2a $\\gcd$ \u90fd\u4e0e $j$ \u6709\u5173\uff0c\u6211\u4eec\u8003\u8651\u628a $j$ \u63d0\u5230\u5916\u9762\n$$\nans=\\sum\\limits_{j=1}^m[\\gcd(j,k)=1]\\sum\\limits_{i=1}^n[\\gcd(i,j)=1]\n$$\n\u7136\u540e\u6211\u4eec\u5bf9\u540e\u9762\u6765\u4e00\u6b21\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n$$\n\\begin{aligned}\nans&=\\sum\\limits_{j=1}^m[\\gcd(j,k)=1]\\sum\\limits_{i=1}^n\\sum\\limits_{d\\mid i,d\\mid j}\\mu(d)\\\\\n&=\\sum\\limits_{j=1}^m[\\gcd(j,k)=1]\\sum\\limits_{d\\mid j}\\lfloor\\frac{n}{d}\\rfloor\\mu(d)\n\\end{aligned}\n$$\n\u7136\u540e\u6211\u4eec\u628a $d$ \u63d0\u5230\u524d\u9762\u53bb\n$$\nans=\\sum\\limits_{d=1}^n\\lfloor\\frac{n}{d}\\rfloor\\mu(d)\\sum\\limits_{d\\mid j,j\\leqslant m}[\\gcd(j,k)=1]\n$$\n\u6211\u4eec\u53d1\u73b0\uff0c$j$ \u53ef\u4ee5\u8868\u793a\u4e3a $xd$\uff0c\u90a3\u4e48 $\\gcd(j,k)=1$ \u7b49\u4ef7\u4e8e $\\gcd(x,k)=1$ \u4e14 $\\gcd(d,k)=1$ \uff0c\u4e8e\u662f\u6211\u4eec\u6709\n$$\nans=\\sum\\limits_{d=1}^n\\lfloor\\frac{n}{d}\\rfloor\\mu(d)[\\gcd(d,k)=1]\\sum\\limits_{x=1}^{\\lfloor\\frac{m}{d}\\rfloor}[\\gcd(x,k)=1]\n$$\n\u7136\u540e\u6211\u4eec\u89c2\u5bdf\u7b2c\u4e8c\u4e2a\u6c42\u548c\u53f7\uff0c\u5982\u679c\u6211\u4eec\u8bbe $f(z)=\\sum\\limits_{i=1}^z[\\gcd(i,z)=1]$\uff0c\u90a3\u4e48\u540e\u9762\u7684\u5c31\u662f $ f(\\lfloor\\dfrac{m}{d}\\rfloor)$\u3002\n\n\u6211\u4eec\u8003\u8651\u662f\u5426\u80fd\u591f\u5feb\u901f\u8ba1\u7b97 $f$\uff0c\u6839\u636e\u8f97\u8f6c\u76f8\u9664\uff08\u51cf\uff09\u6cd5\u7684\u539f\u7406\uff0c\u6211\u4eec\u6709 $\\gcd(x,k)=\\gcd(x+k,k)$\uff0c\u6240\u4ee5\u6211\u4eec\u6709\n$$\nf(z)=\\lfloor \\frac{z}{k}\\rfloor f(k)+f(z\\bmod k)\n$$\n\u5373\u6211\u4eec\u6309\u7167\u6bcf\u4e2a\u6570\u6a21 $k$ \u7684\u4f59\u6570\u5c06\u5176\u5206\u4e3a\u82e5\u5e72\u7b49\u4ef7\u7c7b\u3002\u8fd9\u6837\u6211\u4eec\u53ea\u9700\u8981\u9884\u5904\u7406 $f(1)\\dots f(k)$ \u5c31\u53ef\u4ee5\u5728 $O(1)$ \u65f6\u95f4\u5185\u8ba1\u7b97 $f(z)$\u3002\n\n\u90a3\u4e48\u6709\n$$\nans=\\sum\\limits_{d=1}^n\\lfloor\\frac{n}{d}\\rfloor f(\\lfloor\\frac{m}{d}\\rfloor)\\mu(d)[\\gcd(d,k)=1]\n$$\n\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u679c\u6211\u4eec\u53ef\u4ee5\u5feb\u901f\u8ba1\u7b97 $\\mu(d)[\\gcd(d,k)=1]$ \u7684\u524d\u7f00\u548c\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u6574\u9664\u5206\u5757\u8ba1\u7b97\u7b54\u6848\uff0c\u90a3\u4e48\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a\u4e86\u5feb\u901f\u8ba1\u7b97 $\\mu(d)[\\gcd(d,k)=1]$ \u7684\u524d\u7f00\u548c\u3002\n\n\u6211\u4eec\u8bbe $g(z)=\\sum\\limits_{d=1}^z\\mu(d)[\\gcd(d,k)=1]$\uff0c\u90a3\u4e48\u6211\u4eec\u518d\u6765\u4e00\u6b21\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff1a\n$$\n\\begin{aligned}\ng(z)&=\\sum\\limits_{d=1}^z\\mu(d)\\sum\\limits_{t\\mid d,t\\mid k}\\mu(t)\\\\\n&=\\sum\\limits_{t\\mid k}\\mu(t)\\sum\\limits_{t\\mid d,d\\leqslant z}\\mu(d)\\\\\n&=\\sum\\limits_{t\\mid k}\\mu(t)\\sum\\limits_{d=1}^{\\lfloor\\frac{z}{t}\\rfloor}\\mu(dt)\\\\\n\\end{aligned}\n$$\n\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u679c $\\gcd(d,t)\\not= 1$\uff0c\u90a3\u4e48 $dt$ \u4e00\u5b9a\u542b\u6709\u5e73\u65b9\u56e0\u5b50\uff08$\\gcd(d,t)^2$\uff09\uff0c\u6240\u4ee5\u8fd9\u65f6 $\\mu(dt)=0$\uff0c\u7531\u4e8e\u6211\u4eec\u53ea\u5728\u4e4e\u548c\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u53ea\u5bf9 $\\mu(dt)\\not=0$\uff0c\u5373 $\\gcd(d,t)=1$ \u7684\u60c5\u51b5\u8ba1\u7b97\u3002\u90a3\u4e48\u6709\uff1a\n$$\ng(z)=\\sum\\limits_{t\\mid k}\\mu(t)\\sum\\limits_{d=1}^{\\lfloor\\frac{z}{t}\\rfloor}\\mu(dt)[\\gcd(d,t)=1]\n$$\n\u8fd9\u6837\u7531\u4e8e\u6211\u4eec\u5f3a\u5236\u4ee4 $d,t$ \u4e92\u8d28\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628a $\\mu(dt)$ \u62c6\u6210 $\\mu(d)\\mu(t)$\uff1a\n$$\n\\begin{aligned}\ng(z)&=\\sum\\limits_{t\\mid k}\\mu(t)\\sum\\limits_{d=1}^{\\lfloor\\frac{z}{t}\\rfloor}\\mu(d)\\mu(t)[\\gcd(d,t)=1]\\\\\n&=\\sum\\limits_{t\\mid k}\\mu^2(t)\\sum\\limits_{d=1}^{\\lfloor\\frac{z}{t}\\rfloor}\\mu(d)[\\gcd(d,t)=1]\n\\end{aligned}\n$$\n\u6211\u4eec\u53d1\u73b0\u7b2c\u4e8c\u4e2a\u6c42\u548c\u53f7\u540e\u9762\u7684\u4e1c\u897f\u548c $g$ \u5f88\u50cf\uff0c\u4e0d\u8fc7\u662f $[\\gcd(d,t)=1]$ \u800c\u4e0d\u662f $[\\gcd(d,k)=1]$\uff0c\u4e3a\u6b64\u6211\u4eec\u6269\u5c55\u4e00\u4e0b $g$ \u7684\u5b9a\u4e49\uff0c\u8bbe $g(z,c)=\\sum\\limits_{i=1}^z\\mu(i)[\\gcd(i,c)=1]$\uff0c\u90a3\u4e48\n$$\ng(z,c)=\\sum\\limits_{t\\mid c}\\mu^2(t)g(\\lfloor\\frac{z}{t}\\rfloor,t)\n$$\n\u8fb9\u754c\u6761\u4ef6\u4e3a $c=1$\uff0c\u6b64\u65f6\u5c31\u662f\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u7684\u524d\u7f00\u548c\uff0c\u53ef\u4ee5\u675c\u6559\u7b5b\u6c42\u89e3\u3002\u6ce8\u610f\u8ba1\u7b97\u65f6\u8981\u8bb0\u5fc6\u5316\uff0c\u590d\u6742\u5ea6\u636e\u8bf4\u662f $O(n^{\\frac{2}{3}}+\\sigma_0(k)\\sqrt n)$ \u7684\uff0c\u4e0d\u4f1a\u8bc1\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nint const N=1000005;\nint k,p[N+5],mu[N+5],smu[N+5],cnt,F[2005];\nbool flag[N+5];\nvector<int>v[2005];\nint gcd(int x,int y){return y?gcd(y,x%y):x;}\nmap<pair<int,int>,int>mp;\nmap<int,int>mp2;\nint s(int n)\n{\n    if(n<=N)return smu[n];\n    if(mp2.find(n)!=mp2.end())return mp2[n];\n    int ans=1;\n    for(int l=2,r;l<=n;l=r+1)\n        r=(n/(n/l)),ans-=(r-l+1)*s(n/l);\n    return mp2[n]=ans;\n}\nint f(int n){return (n/k)*F[k]+F[n%k];}\nint g(int z,int c)\n{\n    if(c==1)return s(z);\n    if(!z)return 0;\n    if(mp.find(make_pair(z,c))!=mp.end())return mp[make_pair(z,c)];\n    int ans=0;\n    for(auto i:v[c])\n        if(mu[i])ans+=g(z/i,i);\n    return mp[make_pair(z,c)]=ans;\n}\nint main()\n{\n    mu[1]=1;\n    for(int i=2;i<=N;i++)\n    {\n        if(!flag[i]){p[++cnt]=i;mu[i]=-1;}\n        for(int j=1;j<=cnt&&i*p[j]<=N;j++)\n        {\n            flag[i*p[j]]=1;\n            if(!(i%p[j])){mu[i*p[j]]=0;break;}\n            mu[i*p[j]]=-mu[i];\n        }\n    }\n    for(int i=1;i<=N;i++)smu[i]=smu[i-1]+mu[i];\n    int n,m;\n    scanf(\"%d%d%d\",&n,&m,&k);\n    for(int i=1;i<=k;i++)F[i]=F[i-1]+(gcd(k,i)==1);\n    for(int i=1;i<=k;i++)\n        for(int j=i;j<=k;j+=i)\n            v[j].push_back(i);\n    long long ans=0;\n    for(int l=1,r;l<=min(n,m);l=r+1)\n    {\n        r=min(n/(n/l),m/(m/l));\n        ans+=1ll*(n/l)*f(m/l)*(g(r,k)-g(l-1,k));\n    }\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1597151735,
        "uid": 96912,
        "name": "AzusaCat",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P1587 \u3010[NOI2016]\u5faa\u73af\u4e4b\u7f8e\u3011"
    },
    {
        "content": "\u6c42$\\frac{x}{y}(1\\le x\\le n,1\\le y\\le m)$\u5728$k$\u8fdb\u5236\u4e0b\u4e3a\u7eaf\u5faa\u73af\u5c0f\u6570**\u503c**\u7684\u4e2a\u6570\n\u4e00\u4e2a\u5206\u6570\u5728k\u8fdb\u5236\u4e3a\u7eaf\u5faa\u73af\u5c0f\u6570\u5f53\u4e14\u4ec5\u5f53$\\exists t$\u4f7f\u5f97$y|k^t-1$                 \n\u53ef\u4ee5\u611f\u6027\u7406\u89e3\u4e3a\u8bd5\u9664\u4f59\u6570\u5faa\u73af\u8fc7\u7a0b\n\u540c\u65f6\u6211\u4eec\u7528\u6700\u5c0f\u8868\u793a\u6cd5:\u53ea\u6c42\u65e2\u7ea6\u5206\u6570\n\u5206\u7c7b\u8ba8\u8bba\u4e00\u4e0b\u53ef\u77e5\u4e00\u4e2a\u5206\u6570\u5728k\u8fdb\u5236\u4e3a\u7eaf\u5faa\u73af\u5c0f\u6570\u5f53\u4e14\u4ec5\u5f53$(y,k)=1$\n\u95ee\u9898\u8f6c\u4e3a\n$$\\sum_{i=1}^n\\sum_{j=1}^m[(i,j)=1][(j,k)=1]$$\n\n$84~pts'$(\u524d\u60c5\u5316\u7b80:\u5f88\u57fa\u7840,\u53ea\u6709\u6cd5\u4e94\u4e0d\u9700\u8981)\n\n$$\n\\begin{aligned}Ans\n&=\\sum_{i=1}^n\\sum_{j=1}^m[(i,j)=1][(j,k)=1]\n\\\\&=\\sum_{j=1}^m[(j,k)=1]\\sum_{i=1}^n[(i,j)=1]\n\\\\&=\\sum_{j=1}^m[(j,k)=1]\\sum_{d\\mid j}\\mu(d)\\lfloor\\frac{n}{d}\\rfloor\n\\\\&=\\sum_{d=1}^n\\left \\lfloor \\frac{n}{d} \\right \\rfloor\\mu(d)\\sum_{d|j}^m[(j,k)=1]\n\\\\&=\\sum_{d=1}^n\\left \\lfloor \\frac{n}{d} \\right \\rfloor\\mu(d)\\sum_{i=1}^{\\left \\lfloor \\frac{m}{d} \\right \\rfloor}[(id,k)=1]\n\\\\&=\\sum_{d=1}^n\\left \\lfloor \\frac{n}{d} \\right \\rfloor (\\sum_{i=1}^{\\lfloor \\frac{m}{d} \\rfloor}[(i,k)=1])\\mu(d)[(d,k)=1]\\end{aligned}\n$$\n\n\n\u8bbe$f(n)=\\sum_{i=1}^n[(i,k)=1]$\n\u5219$Ans=\\sum_{d=1}^n\\left \\lfloor \\frac{n}{d} \\right \\rfloor f(\\lfloor \\frac{m}{d} \\rfloor)\\mu(d)[(d,k)=1]$\n\u611f\u6027\u7406\u89e3\u4e00\u4e0b\u4e92\u8d28\u662f\u6709\u5faa\u73af\u8282\u7684\n$f(n)=\\lfloor\\frac{n}{k}\\rfloor f(k) + f(n~mod~k)$\u4e0e\u5904\u7406\u540e\u53ef\u4ee5$O(1)$\u6c42\n\n$100~pts'$(\u6cd5\u4e00)\n\n\u8bbe$S(n,k)=\\sum_{i=1}^n[(i,k)=1]\\mu(i)$\n$\\begin{aligned}S(n,k)\n&=\\sum\\limits_{i=1}^n\\mu(i)\\sum\\limits_{d|i,d|k}\\mu(d)\n\\\\&=\\sum\\limits_{d|k}\\mu(d)\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\mu(id)\n\\\\&=\\sum\\limits_{d|k}\\mu^2(d)\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}[(i,d)=1]\\mu(i)\n\\\\&=\\sum\\limits_{d|k}\\mu^2(d)S(\\lfloor\\frac{n}{d}\\rfloor,d)\n\\end{aligned}\n$\n\u9012\u5f52\u8fb9\u754c\u4e3a$k=1$\u662f\u76f4\u63a5\u6c42$\\mu$\u7684\u524d\u7f00\u548c\n\n$100~pts'$(\u6cd5\u4e8c)\n\n\u8003\u8651\u7b5b\u53bb\u4e92\u8d28\u7684\u6570\u7684\u8fc7\u7a0b\u53ef\u4ee5\u770b\u505a\u662f\u6bcf\u4e00\u4e2a\u8d28\u56e0\u5b50\u72ec\u7acb\u8fdb\u884c\u7684\n\n\u8bbe$S_i(n)=\\sum_{j=1}^n\\mu(j)[\\forall x\\in[1,i],P_x^{[k]}\\nmid j]$\n\n\u8003\u8651$i$\u53d8\u5316\u7684\u51cf\u5c11\u91cf\n\n$S_i(n)=S_{i-1}(n)-\\mu(P_i^{[k]})S_{i-1}(\\lfloor\\frac{n}{P_i^{[k]}}\\rfloor)$\n\n\u8fd9\u4e2a\u65b9\u6cd5\u7528\u5230\u4e86\u540e\u9762$\\mathtt{min\\_25}$\u7b5b\u7684\u4e00\u4e9b\u5206\u7c7b\u601d\u60f3\n\n$100~pts'$(\u6cd5\u4e09)\n\n(\u6700\u6162\u7684\u65b9\u6cd5)\n\n\u8bbe$f(n)=\\displaystyle{\\sum_{i=1}^n[(i,k=1)]\\mu(i)}$\n\u8003\u8651\u76f4\u63a5\u675c\u6559\u7b5b\u8fd9\u2642\u610f\u513f\n\u914d\u4ec0\u4e48\u5462\n\u5927\u5bb6\u81ea\u5df1\u5c1d\u8bd5\uff0c\u7b54\u6848\u5728\u4e0b\u9762\n$g(n)=[(n,k)=1]$\n$(f*g)(n)=\\sum_{d|n}[(d,k)=1][(\\frac{n}{d},k)=1]\\mu(d)$\n$=[(n,k)=1]\\sum_{d|n}\\mu(d)=\\iota(n)$\n\n$100~pts'$(\u6cd5\u56db)\n\n\u8bbe$p$\u662f$k$\u968f\u4fbf\u4e00\u4e2a\u7d20\u56e0\u5b50(\u53ef\u4ee5\u53d6$P_1^{[k]}$)$,k=p^x q$\n$g(n,k)=\\sum_{i=1}^n\\mu(i)[(i,p)=1][(i,q)=1]$\n\u5f53$(i,q)=1$\u5219$(i,p)=1$\u6216$p$\n$g(n,k)=\\sum_{i=1}^n\\mu(i)[(i,q)=1]-\\sum_{i=1}^n\\mu(i)[(i,q)=1][p\\mid i]$\n$=g(n,q)-\\sum_{d=1}^{\\lfloor\\frac{n}{p}\\rfloor}\\mu(ip)[(i,q)=1]$\n$=g(n,q)+\\sum_{i=1}^{\\lfloor\\frac{n}{p}\\rfloor}\\mu(i)[(i,k)=1]$\n$=g(n,q)+g(\\lfloor\\frac{n}{p}\\rfloor,k)$\n\n$100~pts'$(\u6cd5\u4e94)\n\n\u4ee4$S(n,m,k)=\\sum_{i=1}^n\\sum_{j=1}^m[(i,j)=1][(j,k)=1]$\n$=\\sum_{i=1}^n\\sum_{j=1}^m[(i,j)=1]\\sum_{d|j,d|k}\\mu(d)$\n$=\\sum_{d|k}\\mu(d)\\sum_{i=1}^n\\sum_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}[(i,j)=1][(i,d)=1]$\n$=\\sum_{d|k}\\mu(d)S(\\lfloor\\frac{m}{d}\\rfloor,n,d)$\n\n\u5bf9$k=1$\u5c31\u662f\u7b80\u5355\u6570\u8bba\u5206\u5757\u4e00\u4e0b\n\n\n#### \u672c\u9898\u5c0f\u7ed3\n\n\u8fd9\u662f\u6211\u4eec\u5904\u7406\u4e00\u4e2a\u4e92\u8d28\u6574\u9664\u7c7b\u51fd\u6570\u590d\u5408\u7684\u51e0\u4e2a\u89d2\u5ea6\n\n- \u770b\u662f\u4e0d\u662f\u79ef\u6027\u51fd\u6570\u6216\u8005\u6709\u7279\u6b8a\u6027\u8d28\u80fd\u7b5b\n- \u80fd\u5426\u4ece\u5fae\u89c2(\u8d28\u56e0\u6570)\u5c42\u9762\u5bb9\u65a5\u51fd\u6570\uff0c\u5f62\u6210\u9012\u63a8\u5f0f\n- \u60f3\u65b9\u8bbe\u6cd5\u628a\u6346\u7ed1\u5728\u4e00\u8d77\u7684\u626f\u5f00\n- \u66b4\u529b\u5c55\u5f00",
        "postTime": 1596253174,
        "uid": 40629,
        "name": "zzw4257",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1587 \u3010[NOI2016]\u5faa\u73af\u4e4b\u7f8e\u3011"
    },
    {
        "content": "\u7c7b\u6bd4\u5341\u8fdb\u5236\u4e0b\u7684\u7eaf\u5faa\u73af\u5c0f\u6570\uff0c$k$ \u8fdb\u5236\u4e0b\u7684\u7eaf\u5faa\u73af\u5c0f\u6570\u6ee1\u8db3\u6700\u7b80\u5206\u6570\u5206\u6bcd\u4e0e $k$ \u4e92\u8d28\u3002\n\n\u800c\u9898\u76ee\u8981\u6c42\u76f8\u540c\u6570\u503c\u53ea\u8ba1\u6570\u4e00\u6b21\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u8003\u8651\u6700\u7b80\u5206\u6570\u7684\u60c5\u51b5\u3002\n\n\u90a3\u4e48\u7b54\u6848\u4e3a\uff1a\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m[(i,j)=1][(j,k)=1]$$\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m[(i,j)=1]\\sum_{d|{(j,k)}}\\mu(d)$$\n\n$$\\sum_{d|k}\\mu(d)\\sum_{i=1}^n\\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor}[(i,jd)=1]$$\n\n$$\\sum_{d|k}\\mu(d)\\sum_{i=1}^n\\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor}[(i,j)=1][(i,d)=1]$$\n\n$$\\sum_{d|k}\\mu(d)\\sum_{i=1}^{\\lfloor \\frac{m}{d} \\rfloor}\\sum_{j=1}^n[(i,j)=1][(j,d)=1]$$\n\n\u540e\u9762\u7684\u6c42\u548c\u8ddf\u539f\u6765\u7684\u5f62\u5f0f\u76f8\u540c \uff0c \u4ee4 $f(n,m,k)=\\sum_{i=1}^n\\sum_{j=1}^m[(i,j)=1][(j,k)=1]$\n\n\u90a3\u4e48\uff1a\n\n$$f(n,m,k)=\\sum_{d|k}f(\\lfloor \\frac{m}{d} \\rfloor , n ,d)$$\n\n$n=0$ \u6216 $m=0$ \u65f6 $f(n,m,k)=0$\u3002\n\n$k=1$ \u65f6 $f(n,m,k)=\\sum_{i=1}^n\\sum_{j=1}^m [(i,j)=1]=\\sum_{d=1}^{\\min(n,m)}\\mu(d)\\lfloor\\frac{n}{d}\\rfloor\\rfloor\\frac{m}{d}\\lfloor$\n\n```cpp\n#include <map>\n#include <cstdio>\n#include <iostream>\nusing namespace std;\n#define LL long long\n\nconst int MAXN = 1e6;\nint n , m , k;\n\nint num , prime[ MAXN + 5 ] , mu[ MAXN + 5 ] , summ[ MAXN + 5 ];\nbool vis[ MAXN + 5 ];\nvoid sieve( ) {\n\tmu[ 1 ] = 1;\n\tfor( int i = 2 ; i <= MAXN ; i ++ ) {\n\t\tif( !vis[ i ] ) { prime[ ++ num ] = i; mu[ i ] = -1; }\n\t\tfor( int j = 1 ; j <= num && 1ll * i * prime[ j ] <= MAXN ; j ++ ) {\n\t\t\tvis[ i * prime[ j ] ] = 1;\n\t\t\tif( i % prime[ j ] == 0 ) break;\n\t\t\tmu[ i * prime[ j ] ] = -mu[ i ];\n\t\t}\n\t}\n\tfor( int i = 1 ; i <= MAXN ; i ++ ) summ[ i ] = summ[ i - 1 ] + mu[ i ];\n}\n\nmap< int , int > Mapm;\nint Summu( int n ) {\n\tif( n <= MAXN ) return summ[ n ];\n\tif( Mapm[ n ] ) return Mapm[ n ];\n\tint Ans = 1;\n\tfor( int l = 2 , r ; l <= n ; l = r + 1 ) {\n\t\tr = n / ( n / l );\n\t\tAns -= ( r - l + 1 ) * Summu( n / l ); \n\t}\n\treturn Mapm[ n ] = Ans;\n}\n\nLL f( int n , int m , int k ) {\n\tif( !n || !m ) return 0;\n\tif( k == 1 ) {\n\t\tlong long Ans = 0;\n\t\tfor( int l = 1 , r ; l <= min( n , m ) ; l = r + 1 ) {\n\t\t\tr = min( n / ( n / l ) , m / ( m / l ) );\n\t\t\tAns += 1ll * ( Summu( r ) - Summu( l - 1 ) ) * ( n / l ) * ( m / l );\n\t\t}\n\t\treturn Ans;\n\t}\n\tlong long Ans = 0;\n\tfor( int d = 1 ; d <= k ; d ++ )\n\t\tif( k % d == 0 && mu[ d ] ) Ans += mu[ d ] * f( m / d , n , d );\n\treturn Ans;\n}\n\nint main( ) {\n\tsieve( );\n\tscanf(\"%d %d %d\",&n,&m,&k);\n\tprintf(\"%lld\\n\", f( n , m , k ) );\n\treturn 0;\n} \n```\n",
        "postTime": 1593496474,
        "uid": 123802,
        "name": "chihik",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1587 \u3010[NOI2016]\u5faa\u73af\u4e4b\u7f8e\u3011"
    },
    {
        "content": "\u5982\u679c\u516c\u5f0f\u6302\u4e86\u8bf7\u5728[\u535a\u5ba2](https://www.luogu.com.cn/blog/m-sea/solution-p1587)\u4e2d\u67e5\u770b\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c$k$ \u8fdb\u5236\u5206\u6570 $\\frac{x}{y}$ \u662f\u7eaf\u5faa\u73af\u7684\u5f53\u4e14\u4ec5\u5f53 $\\gcd(y,k)=1$\u3002\u8bc1\u660e\u53ef\u4ee5\u70b9[\u8fd9\u91cc](https://www.cnblogs.com/butterflydew/p/10947506.html)\u3002\n\n\u53e6\u5916\u4e3a\u4e86\u907f\u514d\u7b97\u91cd\uff0c\u6211\u4eec\u53ea\u7edf\u8ba1\u6700\u7b80\u5206\u6570\u3002\n\n\u90a3\u4e48\u6211\u4eec\u8981\u6c42\u7684\u4e1c\u897f\u5c31\u662f\uff08\u8bbe $l=\\min(n,m)$\uff09\n\n$$\\begin{aligned}&\\sum_{x=1}^n\\sum_{y=1}^m[\\gcd(x,y)=1][\\gcd(y,k)=1]\\\\=&\\sum_{x=1}^n\\sum_{y=1}^m\\sum_{d|x,d|y}\\mu(d)[\\gcd(y,k)=1]\\\\=&\\sum_{d=1}^l\\mu(d)\\left\\lfloor\\frac{n}{d}\\right\\rfloor\\sum_{d|y}^m[\\gcd(y,k)=1]\\\\=&\\sum_{d=1}^l\\mu(d)\\left\\lfloor\\frac{n}{d}\\right\\rfloor\\sum_{y=1}^{m/d}[\\gcd(dy,k)=1]\\\\=&\\sum_{d=1}^l[\\gcd(d,k)=1]\\mu(d)\\left\\lfloor\\frac{n}{d}\\right\\rfloor\\sum_{y=1}^{m/d}[\\gcd(y,k)=1]\\end{aligned}$$\n\n\u53ef\u4ee5\u6570\u8bba\u5206\u5757\uff0c\u5219\u6211\u4eec\u9700\u8981\u8ba1\u7b97\u4e24\u4e2a\u524d\u7f00\u548c\n\n$$\\begin{aligned}f(n)&=\\sum_{i=1}^n[\\gcd(i,k)=1]\\\\g(n,k)&=\\sum_{i=1}^n[\\gcd(i,k)=1]\\mu(i)\\end{aligned}$$\n\n\u8fd9\u91cc\u4e3a\u4ec0\u4e48\u662f $g(n,k)$ \u800c\u4e0d\u662f $g(n)$ \u5462\uff1f\u8fd9\u91cc\u5148\u57cb\u4e00\u4e2a\u4f0f\u7b14\uff0c\u770b\u5230\u540e\u9762\u81ea\u7136\u5c31\u77e5\u9053\u4e86\uff08\n\n\u9996\u5148\u8003\u8651\u8ba1\u7b97 $f(n)$\u3002\u53ef\u4ee5\u53d1\u73b0\u5982\u679c $\\gcd(i,k)=1$ \u5219 $\\gcd(i+k,k)=1$\uff0c\u5982\u679c $\\gcd(i,k)\\neq 1$ \u5219 $\\gcd(i+k,k)\\neq 1$\u3002\u6240\u4ee5\u6709\n\n$$f(n)=\\left\\lfloor\\frac{n}{k}\\right\\rfloor f(k)+f(n\\bmod k)$$\n\n\u56e0\u4e3a $k\\leq 2000$\uff0c\u6240\u4ee5\u76f4\u63a5\u9884\u5904\u7406\u51fa $f(0\\sim k)$ \u7684\u503c\u5373\u53ef\u3002\n\n\u518d\u8003\u8651\u7b97 $g(n,k)$\uff0c\u6709\n\n$$\\begin{aligned}g(n,k)&=\\sum_{i=1}^n\\mu(i)\\sum_{d|i,d|k}\\mu(d)\\\\&=\\sum_{d|k}\\mu(d)\\sum_{d|i}^n\\mu(i)\\\\&=\\sum_{d|k}\\mu(d)\\sum_{i=1}^{n/d}\\mu(id)\\\\&=\\sum_{d|k}\\mu(d)\\sum_{i=1}^{n/d}[\\gcd(i,d)=1]\\mu(i)\\mu(d)\\\\&=\\sum_{d|k}\\mu(d)^2\\sum_{i=1}^{n/d}[\\gcd(i,d)=1]\\mu(i)\\\\&=\\sum_{d|k}\\mu(d)^2g\\left(\\left\\lfloor\\frac{n}{d}\\right\\rfloor,d\\right)\\end{aligned}$$\n\n\u8fd9\u6837\u5b50\u76f4\u63a5\u679a\u4e3e\u7ea6\u6570\u9012\u5f52\u4e0b\u53bb\u7b97\u5373\u53ef\uff1b\u5f53 $k=1$ \u65f6\u65e0\u6cd5\u7ee7\u7eed\u5f80\u4e0b\u9012\u5f52\uff0c\u4f46\u6b64\u65f6\u76f8\u5f53\u4e8e\u8981\u6c42 $\\mu(i)$ \u7684\u524d\u7f00\u548c\uff0c\u675c\u6559\u7b5b\u5373\u53ef\u3002\n\n```cpp\n// ====================================\n//   author: M_sea\n//   website: https://m-sea-blog.com/\n// ====================================\n#include <bits/stdc++.h>\n#define file(x) freopen(#x\".in\",\"r\",stdin); freopen(#x\".out\",\"w\",stdout)\n#define mp make_pair\nusing namespace std;\ntypedef long long ll;\n\nint read() {\n\tint X=0,w=1; char c=getchar();\n\twhile (c<'0'||c>'9') { if (c=='-') w=-1; c=getchar(); }\n\twhile (c>='0'&&c<='9') X=X*10+c-'0',c=getchar();\n\treturn X*w;\n}\n\nconst int K=2000+10,L=1000000+10;\n\nint n,m,k;\n\nll f[K];\nll F(int n) { return n/k*f[k]+f[n%k]; }\n\nint p[L],v[L],mu[L],smu[L],cnt;\nmap<pair<int,int>,ll> M;\nvoid sieve(int n) {\n\tmu[1]=1;\n\tfor (int i=2;i<=n;++i) {\n\t\tif (!v[i]) p[++cnt]=i,mu[i]=-1;\n\t\tfor (int j=1;j<=cnt&&i*p[j]<=n;++j) {\n\t\t\tv[i*p[j]]=1;\n\t\t\tif (i%p[j]) mu[i*p[j]]=-mu[i];\n\t\t\telse break;\n\t\t}\n\t}\n\tfor (int i=1;i<=n;++i) smu[i]=smu[i-1]+mu[i];\n}\nll G(int n,int k) {\n\tif (!n) return 0;\n\tif (k==1&&n<L) return smu[n];\n\tif (M.count(mp(n,k))) return M[mp(n,k)];\n\tif (k==1) {\n\t\tll res=1;\n\t\tfor (int l=2,r;l<=n;l=r+1) {\n\t\t\tr=n/(n/l);\n\t\t\tres-=(r-l+1)*G(n/l,k);\n\t\t}\n\t\treturn M[mp(n,k)]=res;\n\t} else {\n\t\tll res=0;\n\t\tfor (int d=1;d*d<=k;++d) {\n\t\t\tif (k%d) continue;\n\t\t\tif (mu[d]) res+=G(n/d,d);\n\t\t\tif (d*d!=k&&mu[k/d]) res+=G(n/(k/d),k/d);\n\t\t}\n\t\treturn M[mp(n,k)]=res;\n\t}\n}\n\nint main() {\n\tsieve(L-1);\n\tn=read(),m=read(),k=read();\n\tfor (int i=1;i<=k;++i) f[i]=f[i-1]+(__gcd(i,k)==1);\n\tll ans=0;\n\tfor (int l=1,r;l<=min(n,m);l=r+1) {\n\t\tr=min(n/(n/l),m/(m/l));\n\t\tans+=(G(r,k)-G(l-1,k))*(n/l)*F(m/l);\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1591685007,
        "uid": 38370,
        "name": "M_sea",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1587 \u3010[NOI2016]\u5faa\u73af\u4e4b\u7f8e\u3011"
    },
    {
        "content": "\u9898\u610f\uff1a\n\n\u6c42\u6709\u591a\u5c11\u4e2a\u4e0d\u540c\u7684 $\\dfrac{x}{y}$ \u7684\u53d6\u503c\u5728 $k$ \u8fdb\u5236\u4e0b\u662f\u7eaf\u5faa\u73af\u5c0f\u6570\u3002\n\n\u5176\u4e2d $1\\leq x \\leq n\\ ,\\ 1\\leq y \\leq m$\n\n\u7eaf\u5faa\u73af\u5c0f\u6570 \u5373\u4e00\u4e2a\u6570\u53ef\u4ee5\u88ab\u8868\u793a\u6210\u5f62\u5982\n$a.\\dot{c_1}c_2...\\dot{c_k}$\n\u7684\u5f62\u5f0f\u3002\n\n$n,m \\leq 10^9\\ \\ \\ 2 \\leq k\\leq 2\\times10^3$\n\n\u9e23\u8c22\uff1a [Kelin](https://www.luogu.com.cn/user/20156) \u7684\u9898\u89e3\u8ba9\u6211\u5b66\u4f1a\u4e86\u6b64\u9898\u3002\n\n---\n\u672c\u6587\u9700\u8981\u7528\u5230\u7684\u67d0\u4e9b\u7279\u6b8a\u7b26\u53f7\n\n$\\perp$ \u4e92\u8d28 $\\ \\ \\ *$ Dirichlet \u5377\u79ef $\\ \\ \\ \\epsilon$ \u5355\u4f4d\u6839 $\\ \\ \\ (a,b)$  $a$ \u548c $b$ \u7684\u6700\u5927\u516c\u7ea6\u6570\n\n---\n\u4e0b\u6587\u4e2d\u7684 $n$ \u5747\u5c0f\u4e8e\u7b49\u4e8e $m$ \u3002\n\n\u6027\u8d28\uff1a\n\n**\u82e5 $\\dfrac{x}{y}$ \u5728 $k$ \u8fdb\u5236\u4e0b\u662f\u7eaf\u5faa\u73af\u5c0f\u6570\u5f53\u4e14\u4ec5\u5f53 $y \\perp k$**\n\n\u90a3\u4e48\u9898\u76ee\u8981\u6c42\u7684\u5c31\u662f\uff1a\n\n$$\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{m}[i\\perp j][j\\perp k]$$\n\n\u7531 $[i \\perp j] \\Leftrightarrow [(i,j)=1]$\n\n$$\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{m}[(i,j)=1][(j,k)=1]$$\n\n\u7136\u540e\u62c6\u4e00\u4e0b\u5f0f\u5b50\uff0c\u4e0d\u59a8\u5148\u8003\u8651 $[i\\perp j]$ \uff0c\u7531 $\\epsilon = \\mu * 1$ :\n\n$$\\sum\\limits_{i=1}^n\\sum_{j=1}^m\\sum\\limits_{d|(i,j)}\\mu(d)\\ [(j,k)=1]$$\n\n\u8003\u8651\u628a $[(j,k)=1]$ \u632a\u5230\u524d\u9762\uff1a\n\n$$\\sum\\limits_{j=1}^m[(j,k)=1]\\sum_{i=1}^n\\sum\\limits_{d|(i,j)}\\mu(d)$$\n\n\uff08\u540e\u9762\u8fd9\u4e00\u6bb5\u5f88\u5957\u8def\uff09\n\n\u7531 $\\text{gcd}$ \u7684\u6027\u8d28\uff1a\n\n$$\\sum\\limits_{j=1}^m[(j,k)=1]\\sum_{i=1}^n\\sum\\limits_{d|i,j}\\mu(d)$$\n\n\u5148\u679a\u4e3e $d$ \uff1a\n\n$$\\sum\\limits_{j=1}^m[(j,k)=1]\\sum_{d | j\\ ,\\ d\\leq n}\\sum\\limits_{i=1}^{\\left\\lfloor{\\frac{n}{d}}\\right\\rfloor}\\mu(d)$$\n\n$$\\sum\\limits_{j=1}^m[(j,k)=1]\\sum_{d | j\\ ,\\ d\\leq n}\\left\\lfloor{\\frac{n}{d}}\\right\\rfloor\\mu(d)$$\n\n\u518d\u628a $d$ \u632a\u5230\u524d\u9762\u6765\uff1a\n\n$$\\sum\\limits_{d=1}^{n}\\left\\lfloor{\\frac{n}{d}}\\right\\rfloor\\mu(d)\\sum_{j=1}^{m}[d|j]\\ [(j,k)=1]$$\n\n\u7136\u540e\u4f60\u53d1\u73b0\u8fd9\u91cc\u6709\u70b9\u4e0d\u592a\u597d\u641e\u4e86\u3002\n\n\u8003\u8651\u6d88\u6389 $[d|j]$ \u8fd9\u4e2a\u9650\u5236\u3002\n\n\u628a $j$ \u6362\u6210 $dj$ \uff1a\n\n$$\\sum\\limits_{d=1}^{n}\\left\\lfloor{\\frac{n}{d}}\\right\\rfloor\\mu(d)\\sum_{j=1}^{\\left\\lfloor{\\frac{m}{d}}\\right\\rfloor}\\ [(dj,k)=1]$$\n\n\u4f60\u8003\u8651\u628a $[(dj,k=1)]$ \u62c6\u6210 $[(d,k)=1]$ \u548c $[(j,k)=1]$ \uff1a\n\n$$\\sum\\limits_{d=1}^{n}\\left\\lfloor{\\frac{n}{d}}\\right\\rfloor\\mu(d) [(d,k)=1] \\sum_{j=1}^{\\left\\lfloor{\\frac{m}{d}}\\right\\rfloor}\\ [(j,k)=1]$$\n\n\u7136\u540e\u540e\u9762\u8fd9\u4e00\u6bb5 $\\sum_{j=1}^{\\left\\lfloor{\\frac{m}{d}}\\right\\rfloor}\\ [(j,k)=1]$ \u53ef\u4ee5\u5148\u9884\u5904\u7406\u51fa\u503c\u3002\n\n\u8bbe $F(x) = \\sum\\limits_{i=1}^x[(i,k)=1]$\n\n\u6709 $F(x) = \\left\\lfloor{\\frac{x}{k}}\\right\\rfloor\\varphi(k)+F(x\\mod k)\\ \\ \\ \\ \\ \\ (x > k)$\n\n\u5bf9\u4e8e $x\\leq k$ \u53ef\u4ee5\u66b4\u529b\u7b97\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u89e3\u51b3\u4e86 $\\sum_{j=1}^{\\left\\lfloor{\\frac{m}{d}}\\right\\rfloor}\\ [(j,k)=1]$ \u90e8\u5206\u3002\n\n\u73b0\u5728\u8003\u8651\n\n$$\\sum\\limits_{d=1}^{n}\\left\\lfloor{\\frac{n}{d}}\\right\\rfloor\\mu(d) [(d,k)=1] $$\n\n\u7531\u4e8e $\\sum\\limits_{d=1}^{n}\\left\\lfloor{\\frac{n}{d}}\\right\\rfloor$ \u53ef\u4ee5\u76f4\u63a5\u6570\u8bba\u5206\u5757\uff0c\u53ea\u9700\u8981\u6c42 $\\sum\\limits_{d=1}^{n}\\mu(d) [(d,k)=1]$ \u7684\u524d\u7f00\u548c\u5373\u53ef\u3002\n\n\u8f6c\u5316\u4e00\u4e0b\uff1a\n\n$$\\sum\\limits_{d=1}^{n}\\mu(d) \\sum_{p|(d,k)}\\mu(p) $$\n\n$$\\sum\\limits_{d=1}^{n}\\mu(d) \\sum_{p|d,k}\\mu(p) $$\n\n$$\\sum\\limits_{d=1}^{n}\\sum_{p|d}\\mu(d) \\sum_{p|k}\\mu(p) $$\n\n\u518d\u628a $\\sum_{p|k}\\mu(p)$ \u632a\u5230\u524d\u9762\uff1a\n\n$$\\sum_{p|k}\\mu(p)\\sum\\limits_{d=1}^{n}\\sum_{p|d}\\mu(d) $$\n\n\u628a $d$ \u6362\u6210 $dp$ \u6d88\u6389 $\\sum_{p|d}$\n\n$$\\sum_{p|k}\\mu(p)\\sum\\limits_{d=1}^{\\left\\lfloor{\\frac{n}{p}}\\right\\rfloor}\\mu(dp) $$\n\n\u7531\u4e8e $\\mu$ \u7684\u6027\u8d28\uff0c\u82e5 $(d,p)\\not = 1$ \u5219 $\\mu(dp)=0$\n\n$$\\sum_{p|k}\\mu(p)\\sum\\limits_{d=1}^{\\left\\lfloor{\\frac{n}{p}}\\right\\rfloor}\\mu(dp)[d \\perp p] $$\n\n\u62c6\u4e00\u4e0b $\\mu(dp)$\n\n$$\\sum_{p|k}\\mu(p)\\sum\\limits_{d=1}^{\\left\\lfloor{\\frac{n}{p}}\\right\\rfloor}\\mu(p)\\mu(d)[d \\perp p] $$\n\n$$\\sum_{p|k}\\mu(p)^2\\sum\\limits_{d=1}^{\\left\\lfloor{\\frac{n}{p}}\\right\\rfloor}\\mu(d)[d \\perp p] $$\n\n\u540e\u9762\u7684\u8fd9\u4e2a\u5f0f\u5b50 $\\sum\\limits_{d=1}^{\\left\\lfloor{\\frac{n}{p}}\\right\\rfloor}\\mu(d)[d \\perp p] $ \u548c\u4e00\u5f00\u59cb\u7684 $\\sum\\limits_{d=1}^{n}\\mu(d) [d\\perp k]$ \u5f62\u5f0f\u5176\u5b9e\u662f\u4e00\u6837\u7684\u3002\n\n\u8bbe $g(a,b) = \\sum\\limits_{d=1}^a\\mu(d)[d \\perp b]$\n\n\u6709\uff1a \n\n$$g(a,b)=\\sum_{p|b}\\mu(p)^2g(\\left\\lfloor{\\frac{a}{p}}\\right\\rfloor,p)$$\n\n\u8003\u8651\u8fb9\u754c\u6761\u4ef6\u3002\n\n\u663e\u7136 $g(0,x) = 0$\n\n\u5bf9\u4e8e $g(x,1) = \\sum\\limits_{d=1}^x\\mu(d)[d\\perp 1]=\\sum\\limits_{d=1}^x\\mu(d)$\n\n\u53ef\u4ee5\u5229\u7528\u675c\u6559\u7b5b\u89e3\u51b3\u3002\n\n~~\u8fd9\u9053\u9898\u592a\u6bd2\u7624\u4e86~~\n\n\u7ec6\u8282\u5f88\u591a\uff0c\u800c\u4e14\u9700\u8981\u5361\u5e38\u3002\n\n```\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\ninline ll read(){\n\tchar c=getchar();ll x=0,f=1;\n    while(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n    while(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\n    return x*f;\n}\nconst int N=5000000;\nint i,j,k,n,m;\nint prime[N],phi[N],is_prime[N],mu[N],Mu[N],num,F[N];\nint gcd(int x,int y){return y==0?x:gcd(y,x%y);}\nvoid init(){\n\tmu[1]=1;\n\tfor(int i=2;i<N;i++)is_prime[i]=1;\n\tfor(int i=2;i<N;i++){\n\t\tif(is_prime[i])prime[++num]=i,mu[i]=-1;\n\t\tfor(int j=1;j<=num&&i*prime[j]<N;j++){\n\t\t\tis_prime[i*prime[j]]=0;\n\t\t\tif(i%prime[j]==0)break;\n\t\t\tmu[i*prime[j]]=-mu[i];\n\t\t}\n\t}\n\tfor(int i=1;i<N;i++)Mu[i]=Mu[i-1]+mu[i];\n\tfor(int i=1;i<=k;i++)F[i]=F[i-1]+(gcd(i,k)==1);\n}\nll get_F(int x){\n\treturn ((ll)x/k)*F[k]+F[x%k];\n}\nmap<int,int>MU;\nint get_Mu(int x){\n\tif(x<N)return Mu[x];\n\tif(MU[x])return MU[x];\n\tint ans=1;\n\tfor(int l=2,r=0;l<=x;l=r+1){\n\t\tr=x/(x/l);\n\t\tans-=1ll*(r-l+1)*get_Mu(x/l);\n\t}return MU[x]=ans;\n}\nmap<pair<int,int>,ll>mapG;\nll G(int a,int b){\n\tif(a==0)return 0;\n\tif(a==1)return 1ll;\n\tif(b==1)return get_Mu(a);\n\tif(mapG[make_pair(a,b)])return mapG[make_pair(a,b)];\n\tll ans=0;\n\tfor(int i=1;i*i<=b;i++)\n\t\tif(b%i==0){\n\t\t\tif(i*i==b){if(mu[i])ans+=mu[i]*mu[i]*G(a/i,i);}\n\t\t\telse{\n\t\t\t\tif(mu[i])ans+=mu[i]*mu[i]*G(a/i,i);\n\t\t\t\tif(mu[b/i])ans+=mu[b/i]*mu[b/i]*G(a/(b/i),b/i);\n\t\t\t}\n\t\t}\n\treturn mapG[make_pair(a,b)]=ans;\n}\nll ans=0;\nint main(){\n\tcin>>n>>m>>k;\n\tinit();\n\tfor(int l=1,r=0;l<=min(n,m);l=r+1){\n\t\tr=min(n/(n/l),m/(m/l));\n\t\tll Sum=G(r,k)-G(l-1,k),F=get_F(m/l);\n\t\tif(Sum!=0)ans+=(ll)(n/l)*F*Sum;\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1584012602,
        "uid": 35891,
        "name": "huangzirui",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1587 \u3010[NOI2016]\u5faa\u73af\u4e4b\u7f8e\u3011"
    },
    {
        "content": "## [NOI2016]\u5faa\u73af\u4e4b\u7f8e \u9898\u89e3\n\n##### $\\text{Description}$\n\n\u7ed9\u5b9a $n,m,k$\uff0c\u6c42\u6709\u591a\u5c11\u4e2a $(x,y)$ \u6ee1\u8db3 $1\\le x\\le n,1\\le y\\le m$\uff0c\u4e14 $\\frac{x}{y}$ \u5728 $k$ \u8fdb\u5236\u4e0b\u4e3a\u7eaf\u5faa\u73af\u5c0f\u6570\uff0c\u7279\u522b\u5730\uff0c\u6574\u6570\u4e5f\u7b97\u7eaf\u5faa\u73af\u5c0f\u6570\u3002\u540c\u4e00\u4e2a\u6570\u503c\u7684 $\\frac{x}{y}$ \u53ea\u7b97\u4e00\u6b21\u3002\n\n##### $\\text{Solution}$\n\n\u9996\u5148\uff0c\u4e3a\u4e86\u9650\u5b9a\u540c\u4e00\u4e2a\u6570\u503c\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a $x\\perp y$\u3002\u63a5\u7740\u6211\u4eec\u8003\u8651\u4ec0\u4e48\u60c5\u51b5\u4e0b\u4f1a\u662f\u7eaf\u5faa\u73af\u5c0f\u6570\u3002\u5728\u5341\u8fdb\u5236\u4e0b\u7684\u65e2\u7ea6\u5206\u6570\u4e2d\uff0c\u82e5\u5206\u6bcd\u5305\u542b $2$ \u6216 $5$\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5206\u6570\u8981\u4e48\u662f\u6709\u9650\u5c0f\u6570\uff0c\u8981\u4e48\u662f\u524d\u9762\u6709\u4e00\u6bb5\u975e\u5faa\u73af\u8282\u7684\u5faa\u73af\u5c0f\u6570\u3002\u63a8\u5e7f\u4e00\u4e0b\uff0c\u6211\u4eec\u53ea\u9700\u4ee4\u5206\u6bcd\u4e0e $k$ \u4e92\u8d28\u5373\u53ef\uff0c\u8fd9\u91cc\u5c31\u4e0d\u8bc1\u660e\u4e86\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u6211\u4eec\u8981\u6c42\u7684\u5f0f\u5b50\uff1a\n\n$\\sum_{i=1}^n\\sum_{j=1}^m[i\\perp j][j\\perp k]$\n\n\u6211\u4eec\u5bf9 $[i\\perp j]$ \u8fdb\u884c\u53cd\u6f14\uff1a\n\n$\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{d|i,d|j}\\mu(d)[j\\perp k]$\n\n\u5957\u8def\u5730\u679a\u4e3e $d$\uff0c\u90a3\u4e48 $i,j$ \u53d8\u4e3a $d$ \u7684\u500d\u6570\uff1a\n\n$\\sum_{d=1}^{\\min(n,m)}\\mu(d)[d\\perp k]\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}[j\\perp k]$\n\n\u53d1\u73b0\u548c $i$  \u65e0\u5173\uff0c\u628a\u5b83\u53d8\u6210\uff1a\n\n$\\sum_{d=1}^{\\min(n,m)}\\mu(d)[d\\perp k]\\lfloor\\frac{n}{d}\\rfloor\\sum_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}[j\\perp k]$\n\n\u6211\u4eec\u8bb0 $f(n,k)=\\sum_{d=1}^n\\mu(d)[d\\perp k],g(n,k)=\\sum_{j=1}^ n[j\\perp k]$\u3002\n\n\u539f\u5f0f\u5316\u4e3a\uff1a\n\n$\\sum_{d=1}^{\\min(n,m)}\\mu(d)[d\\perp k]\\lfloor\\frac{n}{d}\\rfloor g(\\lfloor\\frac{m}d\\rfloor,k)$\n\n\u90a3\u4e48\u53ea\u9700\u8ba1\u7b97\u51fa $f$ \u4e0e $g$ \u5728\u6570\u8bba\u5206\u5757\u4e2d\u9700\u8981\u8ba1\u7b97\u7684\u70b9\u5904\u7684\u53d6\u503c\uff0c\u5c31\u53ef\u4ee5\u7528\u6570\u8bba\u5206\u5757\u89e3\u51b3\u3002\n\n\u6211\u4eec\u5148\u8ba1\u7b97 $g$\uff0c\u8003\u8651\u5c06\u4e92\u8d28\u5199\u6210\u8fd9\u6837\u7684\u5f62\u5f0f $\\sum_{j=1}^n[\\gcd(j,k)=1]$\u3002\u6211\u4eec\u6709\u4e00\u4e2a $\\gcd$ \u7684\u6027\u8d28\uff1a$\\gcd(a,b)=\\gcd(a\\bmod b,b)$\u3002\u4e0a\u5f0f\u5b9e\u9645\u4e0a\u53ef\u4ee5\u53d8\u6210\u82e5\u5e72\u76f8\u540c\u6bb5\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u5f0f\u5b50\uff1a\n\n$g(n,k)=\\lfloor\\frac{n}{k}\\rfloor g(k,k)+g(n\\bmod k,k)$\n\n\u6ce8\u610f\u5230 $k\\le 2000$\uff0c\u90a3\u4e48\u9884\u5904\u7406 $g(1,k) $ \u5230 $ g(k,k)$ \u7684\u503c\u5373\u53ef\uff0c\u8fd9\u90e8\u5206\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(k\\log k)$ \u7684\uff0c\u4e4b\u540e\u6bcf\u6b21\u8be2\u95ee\u90fd\u662f $O(1)$\u3002\n\n\u73b0\u5728\u6765\u8ba1\u7b97 $f$ \u3002\u6211\u4eec\u6709\uff1a\n\n$\\sum_{i=1}^n\\mu(i)[i\\perp k]$\n\n\u5bf9\u540e\u9762\u5e94\u7528\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff1a\n\n$\\sum_{i=1}^n\\mu(i)\\sum_{d|i,d|k}\\mu(d)$\n\n\u679a\u4e3e $d$\uff0c\u6709\uff1a\n\n$\\sum_{d|k}\\mu(d)\\sum_{d|i}\\mu(i)$\n\n\u8fdb\u884c\u53d8\u91cf\u66ff\u6362\uff0c\u5c06\u539f\u5148\u7684 $i$ \u53d8\u4e3a $\\frac{i}{d}$\uff0c\u6709\uff1a\n\n$\\sum_{d|k}\\mu(d)\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\mu(id)$\n\n\u6211\u4eec\u6709 $\\mu(ab)=\\mu(a)\\mu(b)[a\\perp b]$\u3002\u5f53 $a\\perp b$ \u65f6\uff0c\u7531\u4e8e $\\mu$ \u662f\u79ef\u6027\u51fd\u6570\uff0c\u6240\u4ee5\u6ee1\u8db3\u3002\u5f53 $\\gcd(a,b)\\neq 1$ \u65f6\uff0c\u8bf4\u660e $a$ \u4e0e $b$ \u6709\u76f8\u540c\u7684\u8d28\u56e0\u5b50\uff0c\u90a3\u4e48\u4e24\u8005\u76f8\u4e58\u5c31\u4f1a\u4ea7\u751f\u6307\u6570\u5927\u4e8e $1$ \u7684\u8d28\u56e0\u5b50\uff0c\u6b64\u65f6 $\\mu(ab)=0$\uff0c\u4e5f\u6ee1\u8db3\u3002\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e0a\u5f0f\u8fdb\u884c\u8fd9\u6837\u7684\u53d8\u6362\uff1a\n\n$\\sum_{d|k}\\mu(d)\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\mu(i)\\mu(d)[i\\perp d]$\n\n\u7136\u540e\u5f88\u660e\u663e\u5730\u53ef\u4ee5\u628a $\\mu(d)$ \u63d0\u51fa\u53bb\uff1a\n\n$\\sum_{d|k}\\mu(d)^2\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\mu(i)[i\\perp d]$\n\n\u53d1\u73b0\u540e\u9762\u7684\u90e8\u5206\u5c31\u662f $f(\\lfloor\\frac{n}{d}\\rfloor,d)$\uff0c\u4ee3\u5165\uff1a\n\n$f(n,k)=\\sum_{d|k}\\mu(d)^2f(\\lfloor\\frac{n}{d}\\rfloor,d)$\n\n\u5f53 $k>1$ \u65f6\uff0c\u6211\u4eec\u9012\u5f52\u5730\u53bb\u6c42\u89e3\uff0c\u6ce8\u610f\u5230\u6211\u4eec\u90fd\u662f\u6c42\u5f62\u4f3c $\\lfloor\\frac{n}{i}\\rfloor$ \u5904\u7684\u5f0f\u5b50\uff0c\u90a3\u4e48\u8bb0\u5fc6\u5316\u53ea\u9700\u7528\u7c7b\u4f3c\u675c\u6559\u7b5b\u7684\u8bb0\u5fc6\u65b9\u5f0f\u5373\u53ef\u3002\n\n\u5f53 $k=1$ \u65f6\uff0c\u6709\uff1a\n\n$f(n,1)=\\sum_{i=1}^n\\mu(i)$\n\n\u675c\u6559\u7b5b\u5c31\u53ef\u4ee5\u89e3\u51b3\u3002\n\n\u4e8e\u662f\u539f\u5f0f\u5c31\u53ef\u4ee5\u5e94\u7528\u6570\u8bba\u5206\u5757\u6c42\u89e3\u3002\n\n##### $\\text{Code}$\n\n```cpp\n#include<bits/stdc++.h>\n#define REG register\n#define LL long long\n#define MAXN 2000005\n#define Up 2000000\nusing namespace std;\ninline LL Min(LL a,LL b){return a<b?a:b;}\ninline LL read(){\n    REG LL x(0);\n    REG char c=getchar();\n    while(!isdigit(c)) c=getchar();\n    while(isdigit(c)) x=(x*10)+(c^48),c=getchar();\n    return x;\n}\n\nLL n,m,k;\n\nint Prime[MAXN],vis[MAXN],Mu[MAXN],MuSum[MAXN],cnt,g[2005];\n\nLL gcd(LL a,LL b){return b?gcd(b,a%b):a;}\n\ninline void MakeSum(){\n    Mu[1]=1;\n    for(REG int i=2;i<=Up;++i){\n        if(!vis[i]) Prime[++cnt]=i,Mu[i]=-1;\n        for(REG int j=1;j<=cnt&&i*Prime[j]<=Up;++j){\n            vis[i*Prime[j]]=1;\n            if(!(i%Prime[j])) break;\n            Mu[i*Prime[j]]=-Mu[i];\n        }\n    }\n    for(REG int i=1;i<=Up;++i) MuSum[i]=MuSum[i-1]+Mu[i];\n\n    for(REG int i=1;i<=k;++i)\n        if(gcd(i,k)==1) g[i]=g[i-1]+1;\n        else g[i]=g[i-1];\n}\n\nmap<LL,LL> MemMu;\n\nLL SumMu(LL x){\n    if(x<=Up) return MuSum[x];\n    if(MemMu[x]) return MemMu[x];\n    LL res=0,l=2,r=0;\n    for(;l<=x;l=r+1)\n        r=x/(x/l),res+=(r-l+1)*SumMu(x/l);\n    return MemMu[x]=1ll-res;\n}\n\nmap< pair<LL,LL> ,LL> MemF;\n\nLL SumF(LL x,LL k){\n    if(x<=1) return x;\n    if(k==1) return SumMu(x);\n    if(MemF[make_pair(x,k)]) return MemF[make_pair(x,k)];\n    LL res=0;\n    for(REG LL i=1;i*i<=k;++i){\n        if((k%i)) continue;\n        if(i*i==k) res+=1ll*Mu[i]*Mu[i]*SumF(x/i,i);\n        else res+=1ll*Mu[i]*Mu[i]*(Mu[i]?SumF(x/i,i):0)+1ll*Mu[k/i]*Mu[k/i]*(Mu[k/i]?SumF(x/(k/i),k/i):0);\n    }\n    return MemF[make_pair(x,k)]=res;\n}\n\nLL G(LL x,LL k){return x/k*g[k]+g[x%k];}\n\nLL Divide(LL x,LL y,LL k){\n    LL res=0,l=1,r=0;\n    for(;l<=Min(x,y);l=r+1)\n        r=Min(x/(x/l),y/(y/l)),res+=(x/l)*G(y/l,k)*(SumF(r,k)-SumF(l-1,k));\n    return res;\n}\n\nvoid Work(){\n    n=read(),m=read(),k=read();\n    MakeSum();\n    printf(\"%lld\\n\",Divide(n,m,k));\n}\n\nint main(){Work();}\n```\n\n",
        "postTime": 1580025389,
        "uid": 83547,
        "name": "LCuter",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1587 \u3010[NOI2016]\u5faa\u73af\u4e4b\u7f8e\u3011"
    },
    {
        "content": "## \u63a8\u5bfc1\n\n\u9996\u5148\u6709\u4e00\u4e2a\u795e\u5947\u7684\u7ed3\u8bba\uff0c$x/y$\uff08$x$\uff0c$y$\u4e92\u8d28\uff09\u5728$k$\u8fdb\u5236\u4e0b\u4e3a\u7eaf\u5faa\u73af\u5c0f\u6570\u5f53\u4e14\u4ec5\u5f53$y$\u4e0e$k$\u4e92\u8d28\uff0c\u7406\u7531\u5982\u4e0b\n\n\u5f53$x/y$\u7eaf\u5faa\u73af\uff0c\u6700\u77ed\u5faa\u73af\u8282\u957f\u5ea6\u4e3a$L$\uff0c\u90a3\u4e48\u7b2c\u4e8c\u4e2a\u5faa\u73af\u8282\u5f00\u5934\u6570\u5b57\u662f$x*(k^L)%y$\u7684\u7ed3\u679c\uff0c\u7b2c\u4e00\u4e2a\u5faa\u73af\u8282\u5f00\u5934\u662f$x%y$\u7684\u7ed3\u679c\n\n\u56e0\u6b64\u6709$x*(k^L)=x(mod$ $y)$\n\n\u56e0\u4e3a$x$\u4e0e$y$\u4e92\u8d28\uff0c\u53ef\u4ee5\u6d88\u53bb$x$\uff0c\u5f97$k^L=1(mod$ $y)$\n\n\u5bb9\u6613\u5f97\u51fa$(k,y)=1$\n\n## \u63a8\u5bfc2\n\n\uff08\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff09\n![](https://i.loli.net/2019/01/01/5c2b6be8a8fd4.png)\n\u6700\u540e\u4e00\u6b65\u4e2d\u628a$y/d$\u5f53\u505a\u4e00\u4e2a\u53d8\u91cf\uff0c\u53ef\u4ee5\u770b\u505a\u662f$t=y/d$\uff0c\u679a\u4e3e$t=1~m/d$\n\n\u6309$n/d$\u548c$m/d$\u53ef\u4ee5\u5c06$d$\u5206\u6210$O(sqrt(n))$\u5757\n\n## \u63a8\u5bfc3\n\n\u8bbe![](https://i.loli.net/2019/01/01/5c2b6be90d5ee.jpg)\n\n\u5f53\u4f7f$n/d=a,m/d=b$\u7684\u6700\u5927$d$\u4e3a$q$\uff0c\u6700\u5c0f$d$\u4e3a$p$//\u5c31\u662f\u8bf4\u5206\u5757\u51fa\u6765\u662f$p$\u5230$q$\n\n\u8981\u5411\u7b54\u6848\u7d2f\u52a0$a*[S(q)-S(p-1)]*T(b)$\n\n$S(x)$\u548c$T(x)$\u8981\u901a\u8fc7\u9012\u5f52\u6c42\u5f97\n\n\u8bbek=p1^a1\u00d7p2^a2\u00d7...\u00d7pn^an\n\n\u8bbe$s(i,x)$\u4e3a\u5c0f\u4e8e\u7b49\u4e8e$x$\u7684\uff0c\u4e0e$k$\u7684\u524d$i$\u79cd\u8d28\u56e0\u5b50\u7684\u4e58\u79ef\u4e92\u8d28\u7684\u81ea\u7136\u6570\u7684$\u03bc$\u51fd\u6570\u7684\u548c\n\n$t(i,x)$\u4e3a\u5c0f\u4e8e\u7b49\u4e8e$x$\u7684\uff0c\u4e0e$k$\u7684\u524d$i$\u79cd\u8d28\u56e0\u5b50\u7684\u4e58\u79ef\u4e92\u8d28\u7684\u81ea\u7136\u6570\u7684\u4e2a\u6570\n\n\u4e8e\u662f$S(x)=s(n,x)$ \u00a0$T(x)=t(n,x)$//\u8fd9\u91cc$n$\u662f$k$\u7684\u8d28\u56e0\u5b50\u79cd\u6570\n\n\u9012\u63a8\u65b9\u6cd5$s(i,x)=s(i-1,x)-\u03bc(pi)s(i,[xpi])$\n\n\u5373\u51cf\u53bb\u4e0e$k$\u7684$gcd$\u4e3a$pi$\u7684\u5e42\u7684\u81ea\u7136\u6570\u7684$\u03bc$\u51fd\u6570\u503c\u4e4b\u548c\n\n\u5176\u4e2d\u5982\u679c$gcd$\u7684$pi$\u6307\u6570\u5927\u4e8e\u7b49\u4e8e$2$\uff0c\u90a3\u4e48\u5bf9\u5e94\u7684\u6570\u7684$\u03bc$\u51fd\u6570\u4e3a$0$\n\n\u6240\u4ee5\u5bf9\u51fd\u6570\u7684\u548c\u6709\u8d21\u732e\u7684\u6570\u53ea\u6709\u9664\u4ee5\u4e00\u4e2a$pi$\u4ee5\u540e\u4e0e$pi$\u4e92\u8d28\u7684\uff0c\u6545\u7531\u79ef\u6027\u51fd\u6570\u6027\u8d28\uff0c\u53ef\u4ee5\u7531\u9664$pi$\u4ee5\u540e\u7684$\u03bc$\u76f4\u63a5\u4e58\u4e0a$pi$\u7684$\u03bc$\u503c\uff08\u663e\u7136\u662f$-1$\uff09\n\n\u6240\u4ee5\u5316\u7b80\u4e00\u4e0b\u5176\u5b9e\u662f$s(i,x)=s(i-1,x)+s(i,[xpi])$\n\n\u7c7b\u6bd4\u4f46\u662f\u66f4\u7b80\u5355\u7684\uff0c$t$\u7684\u9012\u63a8\u5f0f\n$t(i,x)=t(i-1,x)-t(i-1,[xpi])$\n\n\u5176\u4e2d$t(i-1,x)$\u662f\u4e0d\u8003\u8651$i$\u53ca\u540e\u9762\u7684\u8d28\u56e0\u5b50\u7684\u4e92\u8d28\u6570\u4e2a\u6570\uff0c$t(i-1,[xpi])$\u662f$1$\u5230$x$\u4e2d\u4e0e\u524d$i$\u79cd\u8d28\u56e0\u5b50\u4e58\u79ef\u7684$gcd$\u4ec5\u4e3a$pi$\u7684\u6570\u7684\u4e2a\u6570\n\n\u5bf9\u4e8e\u6c42\u8fc7\u7684$s$\u548c$t$\u51fd\u6570\uff0c\u5efa\u8bae$map$\u4e00\u4e0b\uff0c\u5426\u5219\u53ef\u80fd\u4f1a\u8d85\u65f6\n\n\u9012\u5f52\u5e95\u5c42$i=0$\uff0c$t(0,x)=x$\uff0c$s$\u9700\u8981\u6c42$\u03bc$\u7684\u524d\u7f00\u548c\n\n$n<=1e9$\u8fd8\u633a\u5927\u7684\uff0c\u4f46\u662f\u6070\u597d\u6709\u4e2a\u4e1c\u897f\u53eb\u675c\u6559\u7b5b\uff0c\u4e13\u95e8\u6c42\u79ef\u6027\u51fd\u6570\u7684\u524d\u7f00\u548c\uff0c\u6548\u7387n^(2/3)\uff0c\u5b8c\u7ed3\u6492\u82b1\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<map>\n#define long long long\n#define to i*prime[j]\n#define maxn 1000005\nusing namespace std;\nlong n,m,k;\nint p;\nint miu[maxn],prime[maxn],sum[maxn],k_prf[10];\nbool sift[maxn];\nmap<int,int> mp;\nmap<int,int> ms[10];\nmap<int,int> mt[10];\nvoid init()\n{\n\tmiu[1]=sum[1]=1;\n\tfor(int i=2;i<maxn;i++)\n\t{\n\t\tif(!sift[i])\n\t\t{\n\t\t\tprime[++p]=i;\n\t\t\tmiu[i]=-1;\n\t\t}\n\t\tsum[i]=sum[i-1]+miu[i];\n\t\tfor(int j=1;j<=p&&to<maxn;j++)\n\t\t{\n\t\t\tsift[to]=true;\n\t\t\tif(i%prime[j]==0) \n\t\t\t{\n\t\t\t\tmiu[to]=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse miu[to]=-miu[i];\n\t\t}\n\t}\n}\nint sum_miu(int x)\n{\n\tif(x<maxn) return sum[x];\n\tif(mp.count(x)) return mp[x];\n\tint ans=1;\n\tfor(int i=2,p;p<x;i=p+1)\n\t{\n\t\tp=x/(x/i);\n\t\tans-=sum_miu(x/i)*(p-i+1);\n\t}\n\treturn mp[x]=ans;\n}\nlong S(int x,int r)\n{\n\tif(!x) return sum_miu(r);\n\tif(r<=1) return r;\n\tif(ms[x].count(r)) return ms[x][r];\n\treturn ms[x][r]=S(x-1,r)+S(x,r/k_prf[x]);\n}\nint T(int x,int r)\n{\n\tif(!x) return r;\n\tif(r<=1) return r;\n\tif(mt[x].count(r)) return mt[x][r];\n\treturn mt[x][r]=T(x-1,r)-T(x-1,r/k_prf[x]);\n}\nint main()\n{\n \tinit();\n \tscanf(\"%lld%lld%lld\",&n,&m,&k);\n \tint kk=k;\n \tp=0;\n \tfor(int i=1;kk>1;i++)\n \t{\n \t\tif(kk%prime[i]==0) \n \t\t{\n \t\t\tk_prf[++p]=prime[i];\n \t\t\twhile(kk%prime[i]==0) \n \t\t\t\tkk/=prime[i];\n\t\t}\n\t }\n\tlong ans=0ll;\n\tfor(int i=1,t;i<=n&&i<=m;i=t+1)\n\t{\n\t\tt=min(m/(m/i),n/(n/i));\n\t\tans+=(n/i)*(S(p,t)-S(p,i-1))*T(p,m/i);\n\t}\n\tprintf(\"%lld\",ans);\n}\n```",
        "postTime": 1546351029,
        "uid": 98954,
        "name": "\u4e0d\u5b58\u5728\u4e4b\u4eba",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1587 \u3010[NOI2016]\u5faa\u73af\u4e4b\u7f8e\u3011"
    }
]
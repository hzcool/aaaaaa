[
    {
        "content": "\u9996\u5148\u8fd9\u4e2a\u4fee\u6539\u5c31\u663e\u7136\u8981\u5dee\u5206\uff0c\u5bb9\u6613\u53d1\u73b0\u4fee\u6539\u7684\u56fe\u5f62\u505a\u4e8c\u7ef4\u5dee\u5206\u540e\u662f\u4e2a\u53c9\uff0c\u4e3b\u5bf9\u89d2\u7ebf\u662f\u6b63\u7684\uff0c\u526f\u5bf9\u89d2\u7ebf\u662f\u8d1f\u7684\u3002\n\n\u7136\u540e\u8fd9\u4e2a\u67e5\u8be2\u6211\u4eec\u7ed9\u4ed6\u62c6\u6210\u56db\u4e2a\u4e8c\u7ef4\u524d\u7f00\u548c\uff0c\u7136\u540e\u8003\u8651\u7b97\u8d21\u732e\u3002\u5bf9\u4e8e\u4e00\u4e2a\u4fee\u6539 $(x,y,w)$ \u548c\u4e00\u4e2a\u8be2\u95ee $(X,Y)$ \u6ee1\u8db3 $x\\le X,y\\le Y$\uff0c\u5176\u8d21\u732e\u663e\u7136\u4e3a $w(X-x+1)(Y-y+1)$\uff0c\u62c6\u5f00\u540e\u53d1\u73b0\u9700\u8981\u7ef4\u62a4\u7684\u5c31\u662f\u77e9\u5f62\u5185\u7684 $\\sum w,\\sum wx,\\sum wy,\\sum wxy$ \u56db\u4e2a\u4fe1\u606f\uff0c\u6211\u4eec\u5206\u522b\u89e3\u51b3\u4e3b\u5bf9\u89d2\u7ebf\u548c\u526f\u5bf9\u89d2\u7ebf\u7684\u60c5\u51b5\u3002\n\n\u5148\u770b\u4e3b\u5bf9\u89d2\u7ebf\uff0c\u663e\u7136\u4e00\u6b21\u4fee\u6539\u53ef\u4ee5\u62c6\u6210\u4e24\u6761\u5c04\u7ebf\u3002\u5047\u8bbe\u6211\u4eec\u73b0\u5728\u8981\u5728\u5c04\u7ebf $x-x_0=y-y_0\\ge 0$ \u4e0a\u7684\u6574\u70b9\u5904 $+w$\uff0c\u67e5\u8be2\u4f4d\u7f6e $(X,Y)$ \u6ee1\u8db3 $Y-X\\ge y_0-x_0$\uff0c\u5373\u5c04\u7ebf\u5148\u4ea4\u5230\u76f4\u7ebf $x=X$\uff0c\u63a8\u4e00\u63a8\u67ff\u5b50\u53ef\u4ee5\u5f97\u5230\n$$\\Delta w=-wx_0+(X+1)w$$\n$$\\Delta wx=-\\dfrac12wx_0^2+\\dfrac 12wx_0+\\dfrac{X(X+1)}2w$$\n$$\\Delta wy=\\dfrac12wx_0^2-wx_0y_0-(X+\\dfrac12)wx_0+(X+1)wy_0+\\dfrac{X(X+1)}2w$$\n$$\\Delta wxy=\\dfrac16wx_0^3-\\dfrac12wx_0^2y_0+\\dfrac12wx_0y_0-\\dfrac{3X^2+3X+1}6wx_0+\\dfrac{X(X+1)}2wy_0+\\dfrac{X(X+1)(2X+1)}6w$$\n$Y-X<y_0-x_0$ \u7684\u60c5\u51b5\u662f\u5bf9\u79f0\u7684\uff0c\u4e92\u6362 $x,y$ \u5373\u53ef\u3002\u5206\u6bcd\u7684\u5904\u7406\u5c31\u4e0d\u5fc5\u591a\u8bf4\u4e86\u5427\u3002\n\n\u53ef\u4ee5\u770b\u5230\uff0c\u9700\u8981\u7684\u4e1c\u897f\u90fd\u5f62\u5982 $wx^iy^j(0\\le i+j\\le 3)$\uff0c\u800c\u4e14\u662f\u4e00\u4e2a\u5173\u4e8e $y-x,x$ \u4ee5\u53ca\u65f6\u95f4\u7684\u4e09\u7ef4\u504f\u5e8f\uff0c\u79bb\u7ebf\u4e0b\u6765\u505a cdq \u5206\u6cbb\u5c31\u884c\u3002\n\n\u7136\u540e\u770b\u4e00\u4e0b\u526f\u5bf9\u89d2\u7ebf\u7684\u60c5\u51b5\uff0c\u663e\u7136 $x+y>X+Y$ \u7684\u70b9\u662f\u6ca1\u6709\u8d21\u732e\u7684\uff0c\u5269\u4e0b\u7684\u70b9\u6211\u4eec\u53ef\u4ee5\u5bb9\u65a5\u4e00\u4e0b\uff0c\u53d8\u6210 $x\\le X$ \u7684\u90e8\u5206\u52a0\u4e0a $y\\le Y$ \u7684\u90e8\u5206\u518d\u51cf\u53bb\u5168\u4f53\u3002\u5168\u4f53\u662f\u5f88\u5bb9\u6613\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\u7684\uff0c\u4e8e\u662f\u6211\u4eec\u53ea\u9700\u8981\u89e3\u51b3 $x\\le X$ \u7684\u90e8\u5206\u5373\u53ef\uff0c$y\\le Y$ \u7684\u90e8\u5206\u662f\u5bf9\u79f0\u7684\u3002\u540c\u6837\u5c06\u4fee\u6539\u62c6\u6210\u4e24\u6761\u5c04\u7ebf\uff0c\u63a8\u4e00\u4e0b\u67ff\u5b50\u53ef\u4ee5\u5f97\u5230\u7c7b\u4f3c\u7684\u7ed3\u8bba\uff0c\u662f\u5173\u4e8e $x+y,x$ \u4ee5\u53ca\u65f6\u95f4\u7684\u4e09\u7ef4\u504f\u5e8f\u3002\n\n\u7136\u540e\u5c31 $O(n\\log^2 n)$ \u505a\u5b8c\u4e86\u3002\n\n\u56e0\u4e3a\u9000\u5f79\u4e86\uff0c\u6240\u4ee5\u6ca1\u6709\u4ee3\u7801\u3002\n",
        "postTime": 1652166479,
        "uid": 77174,
        "name": "FunnyCreatress",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P8259\u3010[CTS2022] \u56de\u3011"
    }
]
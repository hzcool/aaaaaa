[
    {
        "content": "\u5728\u535a\u5ba2\u56ed\u98df\u7528\u66f4\u4f73\uff1a[https://www.cnblogs.com/PinkRabbit/p/CTS2019D1T2.html](https://www.cnblogs.com/PinkRabbit/p/CTS2019D1T2.html)\u3002\n\n### \u9898\u610f\u7b80\u8ff0\uff1a\n\n\u79f0\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$\uff0c\u5143\u7d20\u53d6\u503c\u4e3a $[1,D]$ \u7684\u6574\u6570\u5e8f\u5217\u662f\u5408\u6cd5\u7684\uff0c\u5f53\u4e14\u4ec5\u5f53\u5176\u4e2d\u80fd\u591f\u9009\u51fa\u81f3\u5c11 $m$ \u5bf9\u76f8\u540c\u5143\u7d20\uff08\u4e0d\u80fd\u91cd\u590d\u9009\u51fa\u5143\u7d20\uff09\u3002\n\n\u95ee\u5408\u6cd5\u5e8f\u5217\u4e2a\u6570\u3002\n\n### \u9898\u89e3\uff1a\n\n\u8bbe\u989c\u8272\u4e3a $c$ \u7684\u73cd\u73e0\u7684\u4e2a\u6570\u4e3a $\\mathrm{cnt}_c$\uff0c\u5219\u4e00\u4e2a\u65b9\u6848\u5408\u6cd5\u5f53\u4e14\u4ec5\u5f53\uff1a\n\n$$\\begin{aligned}\\sum_{c=1}^{D}\\left\\lfloor\\frac{\\mathrm{cnt}_c}{2}\\right\\rfloor&\\ge m\\\\\\sum_{c=1}^{D}\\frac{\\mathrm{cnt}_c-\\mathrm{cnt}_c\\bmod 2}{2}&\\ge m\\\\\\sum_{c=1}^{D}(\\mathrm{cnt}_c-\\mathrm{cnt}_c\\bmod 2)&\\ge 2m\\\\n-\\sum_{c=1}^{D}\\mathrm{cnt}_c\\bmod 2&\\ge 2m\\\\\\sum_{c=1}^{D}\\mathrm{cnt}_c\\bmod 2&\\le n-2m\\end{aligned}$$\n\n\u5148\u7279\u5224 $2m\\le n-D$ \u548c $2m>n$ \u7684\u60c5\u51b5\uff0c\u7b54\u6848\u5206\u522b\u4e3a $D^n$ \u548c $0$\u3002\n\n\u90a3\u4e48\u5047\u8bbe $\\mathrm{odd}_k$ \u4e3a\u6070\u597d\u6709 $k$ \u4e2a $\\mathrm{cnt}_c$ \u4e3a\u5947\u6570\u7684\u65b9\u6848\u6570\uff0c\u5219\u6700\u7ec8\u7b54\u6848\u4e3a $\\displaystyle\\sum_{i=0}^{n-2m}\\mathrm{odd}_i$\u3002\n\n\u8003\u8651\u5bb9\u65a5\uff0c\u8bbe $f_k$ \u4e3a\u81f3\u5c11\u6709 $k$ \u4e2a $\\mathrm{cnt}_c$ \u4e3a\u5947\u6570\u7684\u65b9\u6848\u6570\uff0c\u82e5\u6070\u597d\u6709 $j$ \u4e2a\u5947\u6570\uff0c\u4f1a\u88ab\u76f8\u5e94\u5730\u7edf\u8ba1 $\\displaystyle\\binom{j}{k}$ \u6b21\u3002\n\n\u5219\u6709\uff1a$\\displaystyle f_i=\\sum_{j}\\binom{j}{i}\\mathrm{odd}_j$\u3002\n\n\u6839\u636e\u4e8c\u9879\u5f0f\u53cd\u6f14\uff0c\u6709\uff1a\n\n$$\\begin{aligned}\\mathrm{odd}_i&=\\sum_{j}(-1)^{j-i}\\binom{j}{i}f_j\\\\&=\\sum_{j}(-1)^{i-j}\\frac{j!}{i!(j-i)!}f_j\\\\&=\\frac{1}{i!}\\sum_{j}\\frac{(-1)^{i-j}}{[-(i-j)]!}\\cdot j!f_j\\end{aligned}$$\n\n\u4e0a\u5f0f\u662f\u5377\u79ef\u5f62\u5f0f\uff0c\u95ee\u9898\u8f6c\u5316\u4e3a\u6c42\u51fa\u6bcf\u4e00\u4e2a $f_i$\u3002\n\n----\n\n\u8003\u8651\u51fa\u73b0\u6b21\u6570\u4e3a\u5947\u6570\u7684\u989c\u8272\u7684\u6392\u5217\u65b9\u6848\u6570\u7684\u6307\u6570\u578b\u751f\u6210\u51fd\u6570\uff1a$\\mathbf{EGF}\\{[0,1,0,1,\\ldots]\\}$\uff0c\u5373 $\\displaystyle\\frac{e^x-e^{-x}}{2}$\uff0c\u6545\u6709\uff1a\n\n$$\\begin{aligned}f_k&=\\binom{D}{k}n![x^n]\\left(\\frac{e^x-e^{-x}}{2}\\right)^k(e^x)^{D-k}\\\\&=\\binom{D}{k}\\frac{n!}{2^k}[x^n]\\left(e^x-e^{-x}\\right)^k(e^x)^{D-k}\\\\&=\\binom{D}{k}\\frac{n!}{2^k}[x^n]\\sum_{j=0}^{k}\\binom{k}{j}e^{jx}(-e^{-x})^{k-j}e^{(D-k)x}\\\\&=\\binom{D}{k}\\frac{n!}{2^k}\\sum_{j=0}^{k}\\binom{k}{j}(-1)^{k-j}[x^n]e^{(D-2(k-j))x}\\end{aligned}$$\n\n\u8003\u8651 $e^{ax}=\\mathbf{EGF}\\{[1,a,a^2,a^3,\\ldots]\\}$\uff0c\u6545\u6709 $\\displaystyle[x^n]e^{ax}=\\frac{a^n}{n!}$\uff0c\u5e26\u5165\u4e0a\u5f0f\u53ef\u5f97\uff1a\n\n$$\\begin{aligned}f_k&=\\binom{D}{k}\\frac{n!}{2^k}\\sum_{j=0}^{k}\\binom{k}{j}(-1)^{k-j}\\frac{(D-2(k-j))^n}{n!}\\\\&=\\frac{D!}{2^k(D-k)!}\\sum_{j=0}^{k}\\frac{(-1)^{j}(D-2j)^n}{j!}\\cdot\\frac{1}{(k-j)!}\\end{aligned}$$\n\n\u663e\u7136\u53f3\u8fb9\u662f\u5377\u79ef\u5f62\u5f0f\uff0c\u76f4\u63a5\u8ba1\u7b97\u5373\u53ef\u3002\u8ba1\u7b97\u5b8c $f$ \u518d\u4f7f\u7528\u5377\u79ef\u8ba1\u7b97 $\\mathrm{odd}$ \u5373\u53ef\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include <cstdio>\n#include <algorithm>\n\ntypedef long long LL;\nconst int Mod = 998244353, Inv2 = (Mod + 1) / 2;\nconst int G = 3, iG = 332748118;\nconst int MS = 1 << 18;\n\ninline int qPow(int b, int e) {\n\tint a = 1;\n\tfor (; e; e >>= 1, b = (LL)b * b % Mod)\n\t\tif (e & 1) a = (LL)a * b % Mod;\n\treturn a;\n}\n\ninline int gInv(int b) { return qPow(b, Mod - 2); }\n\nint Inv[MS], Fac[MS], iFac[MS];\n\ninline void Init(int N) {\n\tFac[0] = 1;\n\tfor (int i = 1; i < N; ++i) Fac[i] = (LL)Fac[i - 1] * i % Mod;\n\tiFac[N - 1] = gInv(Fac[N - 1]);\n\tfor (int i = N - 1; i >= 1; --i) iFac[i - 1] = (LL)iFac[i] * i % Mod;\n\tfor (int i = 1; i < N; ++i) Inv[i] = (LL)Fac[i - 1] * iFac[i] % Mod;\n}\n\nint Sz, InvSz, R[MS];\n\ninline int getB(int N) { int Bt = 0; while (1 << Bt < N) ++Bt; return Bt; }\n\ninline void InitFNTT(int N) {\n\tint Bt = getB(N);\n\tif (Sz == (1 << Bt)) return ;\n\tSz = 1 << Bt, InvSz = Mod - (Mod - 1) / Sz;\n\tfor (int i = 1; i < Sz; ++i) R[i] = R[i >> 1] >> 1 | (i & 1) << (Bt - 1);\n}\n\ninline void FNTT(int *A, int Ty) {\n\tfor (int i = 0; i < Sz; ++i) if (R[i] < i) std::swap(A[R[i]], A[i]);\n\tfor (int j = 1, j2 = 2; j < Sz; j <<= 1, j2 <<= 1) {\n\t\tint wn = qPow(~Ty ? G : iG, (Mod - 1) / j2), w, X, Y;\n\t\tfor (int i = 0, k; i < Sz; i += j2) {\n\t\t\tfor (k = 0, w = 1; k < j; ++k, w = (LL)w * wn % Mod) {\n\t\t\t\tX = A[i + k], Y = (LL)w * A[i + j + k] % Mod;\n\t\t\t\tA[i + k] -= (A[i + k] = X + Y) >= Mod ? Mod : 0;\n\t\t\t\tA[i + j + k] += (A[i + j + k] = X - Y) < 0 ? Mod : 0;\n\t\t\t}\n\t\t}\n\t}\n\tif (!~Ty) for (int i = 0; i < Sz; ++i) A[i] = (LL)A[i] * InvSz % Mod;\n}\n\ninline void PolyConv(int *_A, int N, int *_B, int M, int *_C) {\n\tstatic int A[MS], B[MS];\n\tInitFNTT(N + M - 1);\n\tfor (int i = 0; i < N; ++i) A[i] = _A[i];\n\tfor (int i = N; i < Sz; ++i) A[i] = 0;\n\tfor (int i = 0; i < M; ++i) B[i] = _B[i];\n\tfor (int i = M; i < Sz; ++i) B[i] = 0;\n\tFNTT(A, 1), FNTT(B, 1);\n\tfor (int i = 0; i < Sz; ++i) A[i] = (LL)A[i] * B[i] % Mod;\n\tFNTT(A, -1);\n\tfor (int i = 0; i < N + M - 1; ++i) _C[i] = A[i];\n}\n\nint D, N, M;\nint A[MS], B[MS], Ans;\n\nint main() {\n\tscanf(\"%d%d%d\", &D, &N, &M);\n\tif (M + M <= N - D) return printf(\"%d\\n\", qPow(D, N)), 0;\n\tif (M + M > N) return puts(\"0\"), 0;\n\tInit(D + 1);\n\tfor (int i = 0; i <= D; ++i) A[i] = (LL)qPow((D - i - i + Mod) % Mod, N) * (i & 1 ? Mod - iFac[i] : iFac[i]) % Mod;\n\tfor (int i = 0; i <= D; ++i) B[i] = iFac[i];\n\tPolyConv(A, D + 1, B, D + 1, A);\n\tfor (int i = 0; i <= D; ++i) A[i] = (LL)A[i] * Fac[D] % Mod * Fac[i] % Mod * iFac[D - i] % Mod * qPow(Inv2, i) % Mod;\n\tfor (int i = 0; i <= D; ++i) B[D - i] = i & 1 ? Mod - iFac[i] : iFac[i];\n\tPolyConv(A, D + 1, B, D + 1, A);\n\tfor (int i = 0; i <= N - M - M; ++i) Ans = (Ans + (LL)A[D + i] * iFac[i]) % Mod;\n\tprintf(\"%d\\n\", Ans);\n\treturn 0;\n}\n```",
        "postTime": 1562604621,
        "uid": 10703,
        "name": "\u5c0f\u7c89\u5154",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5401 \u3010[CTS2019]\u73cd\u73e0\u3011"
    },
    {
        "content": "djq \u63d0\u5230\u4e86\u4e00\u79cd\u65f6\u95f4\u590d\u6742\u5ea6\u66f4\u4f18\u7684\u89e3\u6cd5\uff0c\u770b\u5230\u6d1b\u8c37\u9898\u89e3\u533a\u8fd8\u6ca1\u6709\uff0c\u5c31\u6765\u590d\u8bfb\u4e00\u904d\u5427\uff08\n****\n\u7701\u7565\u4ebf\u70b9\u6b65\u9aa4\uff0c\u9898\u76ee\u4e2d\u8981\u6c42\u7684\u53ef\u4ee5\u8f6c\u5316\u4e3a\u5982\u4e0b\u95ee\u9898\uff1a\n$$\\frac{n!}{2^d}[x^n]\\sum_{i=0}^k \\binom di(\\text e^x-\\text e^{-x})^i(\\text e^x+\\text e^{-x})^{d-i}$$\n\u5176\u4e2d $k =  \\min(d,n-2m)$\u3002  \n\n\u7531\u4e8e EGF \u4e0d\u592a\u597d\u641e\uff0c\u800c\u5173\u4e8e $x$ \u7684\u5f0f\u5b50\u53ea\u6709 $\\text e^x$ \u8fd9\u6837\u7684\uff0c\u4e8e\u662f\u8003\u8651\u8f6c\u4e3a OGF\uff1a\n\n$$F(x)=\\sum_{i=0}^k \\binom di(x-x^{-1})^i(x+x^{-1})^{d-i}$$\n$$=x^{-d}\\sum_{i=0}^k \\binom di (x^2-1)^i(x^2+1)^{d-i}$$\n\u8fd9\u6837\u8981\u6c42\u7684\u5c31\u662f $[x^n]F(\\text e^x)$\uff0c\u4f46\u5f62\u5982 $(x^2+1)$ \u7684\u5f62\u5f0f\u8fd8\u662f\u4e0d\u597d\u770b\uff0c\u6539\u4e3a\uff1a\n\n$$G(x)=\\sum_{i=0}^k \\binom di(x-1)^i(x+1)^{d-i}$$\n\u7136\u540e\u7b54\u6848\u5c31\u80fd\u5199\u6210 \n$$\\frac{n!}{2^d}[x^n]G(\\text e^{2x})\\text e^{-dx}$$\n\u53ea\u8981\u6c42\u51fa $G(x)$ \u7684\u7cfb\u6570\uff0c\u90a3\u4e48\u5176\u5377\u79ef\u7684 $n$ \u6b21\u9879\u5c31\u80fd\u76f4\u63a5\u6c42\u51fa\u3002  \n\u5177\u4f53\u6765\u8bb2\uff0c\u7b54\u6848\u53ef\u4ee5\u5199\u4e3a\n\n$$2^{-d}\\sum_{i=0}^dg_i (2i-d)^n$$\n\u7ebf\u6027\u7b5b\u6c42\u5e42\uff0c\u662f $\\Theta(d \\log_d n)$ \u7684\u3002\n\n\n\u7136\u540e\u4f7f\u7528\u4e07\u80fd\u7684\uff08\u5e76\u4e0d\uff09\u6c42\u5bfc\u5927\u6cd5\uff0c\u5c31\u80fd\u63a8\u51fa\uff1a\n$$G'(x)=\\sum_{i=0}^k \\binom di(i(x-1)^{i-1}(x+1)^{d-i}+(d-i)(x-1)^i(x+1)^{d-i-1})$$\n\n$$2dG(x)-2xG'(x)=d\\binom{d-1}{k}((x-1)^k(x+1)^{d-k}-(x-1)^{k+1}(x+1)^{d-k-1})$$\n$$dG(x)-xG'(x)=d\\binom{d-1}{k}(x-1)^k(x+1)^{d-k-1}$$\n\u8bbe $H(x)=dG(x)-xG'(x)$\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u63d0\u53d6\u7cfb\u6570 $(d-n)g_n=h_n$ \u8ba1\u7b97 $G(x)$ \u7684\u7cfb\u6570\uff08\u6ce8\u610f\uff0c$h_d$ \u4e3a\u96f6\uff0c\u800c $g_d$ \u663e\u7136\u4e0d\u4e3a\u96f6\uff0c\u6240\u4ee5\u8981\u5355\u72ec\u7b97\u4e00\u4e0b\uff09\u3002\n\n\u8981\u7b97 $H(x)$ \u5f88\u7b80\u5355\uff0c\u53ea\u8981\u80fd\u5feb\u901f\u6c42\u5f62\u5982\n$$Q(x)=(x+1)^a(x-1)^b$$\n\u7684\u7cfb\u6570\u5c31\u597d\u4e86\u3002\n\n$$Q'(x)=a(x+1)^{a-1}(x-1)^b+b(x+1)^a(x-1)^{b-1}$$\n$$= \\frac{aQ(x)}{x+1}+\\frac{bQ(x)}{x-1}$$\n$$(x^2-1)Q'(x)=a(x-1)Q(x)+b(x+1)Q(x)$$\n$$-(n+1)q_{n+1}=a(q_{n-1}-q_n)+b(q_{n-1}+q_n)-(n-1)q_{n-1}$$\n\u663e\u7136\u53ef\u4ee5 $\\Theta(d)$ \u9012\u63a8\u8ba1\u7b97\u524d $d$ \u9879\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(d \\log_d n)$\u3002\n\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n#define N 100003\n#define ll long long\n#define reg register\n#define p 998244353\nusing namespace std;\n\ninline int add(const int& x,const int& y){ return x+y>=p?x+y-p:x+y; }\n\ninline int power(int a,int t){\n    int res = 1;\n    while(t){\n        if(t&1) res = (ll)res*a%p;\n        a = (ll)a*a%p;\n        t >>= 1;\n    }\n    return res;\n}\n\nint inv[N],pw[N],pr[N>>2],fac[N],ifac[N];\n\nvoid sieve(int n,int k){\n    int cnt = 0;\n    fac[0] = fac[1] = ifac[0] = ifac[1] = inv[1] = pw[1] = 1;\n    for(reg int i=2;i<=n;++i){\n        inv[i] = (ll)(p-p/i)*inv[p%i]%p;\n        fac[i] = (ll)fac[i-1]*i%p;\n        if(!pw[i]){\n            pr[++cnt] = i;\n            pw[i] = power(i,k);\n        }\n        for(reg int j=1;j<=cnt&&i*pr[j]<=n;++j){\n            pw[i*pr[j]] = (ll)pw[i]*pw[pr[j]]%p;\n            if(i%pr[j]==0) break;\n        }\n    }\n    ifac[n] = power(fac[n],p-2);\n    for(reg int i=n-1;i;--i) ifac[i] = (ll)ifac[i+1]*(i+1)%p;\n}\n\ninline int binom(int n,int m){ return (ll)fac[n]*ifac[m]%p*ifac[n-m]%p; }\n\nint d,n,k,ans,sgn,a,b,bm;\nint g[N],q[N];\n\nint main(){\n    scanf(\"%d%d%d\",&d,&n,&k);\n    if((k<<1)<=n-d){\n        printf(\"%d\",power(d,n));\n        return 0;\n    }else if((k<<1)>n){\n        putchar('0');\n        return 0;\n    }\n    k = min(d,n-(k<<1));\n    sgn = n&1?-1:1;\n    sieve(d+1,n);\n    bm = (ll)d*binom(d-1,k)%p;\n    a = d-k-1,b = k;\n    q[0] = b&1?-1:1,q[1] = (b&1?-1:1)*a+((b-1)&1?-b:b);\n    for(reg int i=1;i!=d;++i) q[i+1] = -((ll)a*(q[i-1]-q[i])%p+(ll)b*(q[i-1]+q[i])-(ll)(i-1)*q[i-1])%p*inv[i+1]%p;\n    for(reg int i=0;i!=d;++i) g[i] = (ll)q[i]*bm%p*inv[d-i]%p;\n    for(reg int i=0;i<=k;++i) g[d] = add(g[d],binom(d,i));\n    for(reg int i=0;i<=d;++i){\n        if((i<<1)<d) ans = (ans+(ll)g[i]*sgn*pw[d-(i<<1)])%p;\n        else ans = (ans+(ll)g[i]*pw[(i<<1)-d])%p;\n    }\n    ans = (ll)ans*power(2,p-1-d)%p;\n    printf(\"%d\",ans<0?ans+p:ans);\n    return 0;   \n}\n```",
        "postTime": 1590851866,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5401 \u3010[CTS2019]\u73cd\u73e0\u3011"
    },
    {
        "content": "\n\u66f4 $\\mu$ \u68d2\u7684\u4f53\u9a8c $\\to $ [`George1123`](https://www.cnblogs.com/George1123/p/13822601.html)\n\n---\n\n## \u9898\u9762\n\n> [CTS2019 \u73cd\u73e0](https://www.luogu.com.cn/problem/P5401)\n\n> \u6709 $n$ \u4e2a\u5728 $[1,d]$ \u5185\u7684\u6574\u6570\uff0c\u6c42\u4f7f\u53ef\u4ee5\u62ff\u51fa $2m$ \u4e2a\u6574\u6570\u51d1\u6210 $m$ \u4e2a\u76f8\u7b49\u7684\u6574\u6570\u5bf9\u7684\u65b9\u6848\u6570\u3002\n\n> \u6570\u636e\u8303\u56f4\uff1a$0\\le m\\le 10^9$\uff0c$1\\le n\\le 10^9$\uff0c$1\\le d\\le 10^5$\u3002\n\n---\n\n## \u849f\u84bb\u8bed\n\n\u975e\u5e38\u5de7\u5999\u7684\u9898\uff0c\u4e3b\u8981\u8981\u7528\u5230\u4e8c\u9879\u5f0f\u53cd\u6f14\u3001\u6307\u6570\u7ea7\u751f\u6210\u51fd\u6570\u548c `NTT`\u3002\n\n\u505a\u4e2a\u5e7f\u544a\uff0c\u8fd9\u662f\u6211\u8bfb\u8fc7\u6700\u597d\u7684\u751f\u6210\u51fd\u6570\u8bb2\u89e3\uff1a[`link`](https://www.luogu.com.cn/blog/pks-LOVING/sheng-cheng-han-shuo-luan-bian)\u3002\n\n---\n\n## \u849f\u84bb\u89e3\n\n\u8bbe $c_i$ \u8868\u793a $i$ \u8fd9\u4e2a\u6570\u7684\u51fa\u73b0\u6b21\u6570\u3002\n\n\u8bbe $odd=\\sum [c_i\\in {\\rm odd} ]$\uff0c\u5373 $c_i$ \u5947\u6570\u4e2a\u6570\u3002\n\n\u5f88\u660e\u663e\u6700\u591a\u80fd\u51d1\u6210 $\\frac{n-odd}{2}$ \u5bf9\uff0c\u6309\u9898\u610f\uff1a\n\n$$\n\\begin{aligned}\n\\frac{n-odd}{2}&\\ge m\\\\\nodd&\\le n-2m\n\\end{aligned}\n$$\n\n\u8fd9\u91cc\u6709\u4e24\u4e2a\u7279\u5224\uff0c\u5982\u679c $n-2m<0$ \u7b54\u6848\u662f $0$\uff0c\u5982\u679c $n-2m\\ge d$ \u7b54\u6848\u662f $d^n$\u3002\n\n\u8bbe $g(i)$ \u8868\u793a $odd=i$ \u7684\u65b9\u6848\u6570\u3002\n\n\u8bbe $f(i)$ \u8868\u793a\u94a6\u5b9a $i$ \u4e2a $c_i$ \u662f\u5947\u6570\uff0c\u5269\u4e0b\u968f\u610f\u7684\u65b9\u6848\u6570\uff08\u4e0d\u662f $odd\\ge i$ \u7684\u65b9\u6848\u6570\uff0c\u8fd9\u91cc\u5bf9\u4e00\u4e9b\u6392\u5217\u4f1a\u91cd\u590d\u7edf\u8ba1\uff0c\u4f46\u662f\u53cd\u6f14\u5b8c\u5c31\u6ca1\u4e8b\u4e86\uff09\u3002\n\n$$f(i)=\\sum_{x=i}^d{x\\choose i}g(x)\\Longleftrightarrow g(i)=\\sum_{x=i}^d(-1)^{x-i}{x\\choose i} f(x)$$\n\n\u6240\u4ee5\u53ef\u4ee5\u5148\u6c42 $f(i)$\uff0c\u7528\u5230\u4e86\u6307\u6570\u7ea7\u751f\u6210\u51fd\u6570\uff0c\u4e2d\u95f4\u628a\u6bcf\u4e2a $e$ \u7684\u5e42\u6b21\u9879\u5c55\u5f00\uff0c\u6700\u540e\u5f52\u6210\u5377\u79ef\u5f62\u5f0f\uff1a\n\n$$\n\\begin{aligned}\nf(i)=&{d \\choose i} \\left(\\frac{e^x-e^{-x}}{2}\\right)^i e^{(d-i)x} n![n]\\\\\n=&{d \\choose i} (e^x-e^{-x})^i e^{(d-i)x} \\frac{n!}{2^i}[n]\\\\\n=&{d \\choose i} e^{(d-i)x} \\sum_{j=0}^i(-1)^{i-j} {i\\choose j}e^{(j-(i-j))x}  \\frac{n!}{2^i}[n]\\\\\n=&{d \\choose i} e^{(d-i)x} \\sum_{j=0}^i(-1)^{i-j} {i\\choose j}e^{(2j-i)x}  \\frac{n!}{2^i}[n]\\\\\n=&{d \\choose i} \\frac{n!}{2^i}\\sum_{j=0}^i(-1)^{j} {i\\choose j}e^{(d-2j)x} [n]\\\\\n=&{d \\choose i} \\frac{n!}{2^i}\\sum_{j=0}^i(-1)^{j} {i\\choose j} \\frac{(d-2j)^n}{n!}\\\\\n=&\\frac{d!}{i!(d-i)!2^i}\\sum_{j=0}^i(-1)^{j} \\frac{i!}{j!(i-j)!} (d-2j)^n\\\\\n=&\\frac{d!}{(d-i)!2^i}\\sum_{j=0}^i\\frac{(-1)^{j}(d-2j)^n}{j!}\\cdot \\frac{1}{(i-j)!} \\\\\n\\end{aligned}\n$$\n\n\u6700\u540e\u4e00\u4e2a\u96be\u70b9\u662f\u5982\u4f55\u6c42\uff1a\n\n$$g(i)=\\sum_{x=i}^d(-1)^{x-i}{x\\choose i} f(x)$$\n\n\u611f\u89c9\u53ef\u4ee5\u51d1\u6210\u5377\u79ef\u5f62\u5f0f\uff0c\u4f46\u603b\u5dee\u4e00\u70b9\u3002\u5c1d\u8bd5\u628a $f$ \u548c $g$ \u90fd\u53cd\u8fc7\u6765\uff0c\u5373\u4ee4 $f'(x)=f(d-x)$\uff0c$g'(x)=g(d-x)$\uff1a\n\n$$\n\\begin{aligned}\ng(i)=&\\sum_{x=i}^d(-1)^{x-i}{x\\choose i} f(x)\\\\\n=&\\sum_{x=i}^d(-1)^{x-i}{x\\choose i} f'(d-x)\\\\\n=&\\sum_{x=0}^{d-i}(-1)^{d-x-i}{d-x\\choose i} f'(x)\\\\\n\\end{aligned}\\\\\ng'(d-i)=\\sum_{x=0}^{d-i}(-1)^{d-x-i}{d-x\\choose i} f'(x)\\\\\n\\begin{aligned}\ng'(i)=&\\sum_{x=0}^{i}(-1)^{i-x}{d-x\\choose d-i} f'(x)\\\\\n=&\\sum_{x=0}^{i}(-1)^{i-x}\\frac{(d-x)!}{(d-i)!(i-x)!} f'(x)\\\\\n=&\\frac{1}{(d-i)!}\\sum_{x=0}^{i} (-1)^{i-x}\\frac{1}{(i-x)!}\\cdot f'(x)(d-x)!\\\\\n\\end{aligned}\\\\\n$$\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u6c42 $g(i)$ \u4e86\u3002\n\n\u7b54\u6848\u4fbf\u662f $\\sum_{i=0}^{n-2m} g(i)$\u3002\n\n---\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n//Start\ntypedef long long ll;\ntypedef double db;\n#define mp(a,b) make_pair((a),(b))\n#define x first\n#define y second\n#define bg begin()\n#define ed end()\n#define sz(a) int((a).size())\n#define pb(a) push_back(a)\n#define R(i,a,b) for(int i=(a),i##E=(b);i<i##E;i++)\n#define L(i,a,b) for(int i=(b)-1,i##E=(a)-1;i>i##E;i--)\nconst int iinf=0x3f3f3f3f;\nconst ll linf=0x3f3f3f3f3f3f3f3f;\n\n//Data\nconst int N=1e5;\nint n,m,d,ans;\n\n//Math\nconst int mod=998244353;\nint Pow(int a,int x){\n    int res=1; for(;x;x>>=1,a=1ll*a*a%mod)\n    if(x&1) res=1ll*res*a%mod; return res;\n}\nconst int mN=N+1;\nint fac[mN],ifac[mN];\nvoid math_init(){\n    fac[0]=1;R(i,1,d+1) fac[i]=1ll*fac[i-1]*i%mod;\n    ifac[d]=Pow(fac[d],mod-2);\n    L(i,0,d) ifac[i]=1ll*ifac[i+1]*(i+1)%mod;\n}\n\n//Poly\nconst int pN=mN<<2;\nint f[pN],g[pN];\nconst int G=3,iG=Pow(3,mod-2);\nint rev[pN],pn;\nvoid poly_init(){\n    pn=1<<int(ceil(log2(d*2+2)));\n    R(i,0,pn) rev[i]=(rev[i>>1]>>1)|((i&1)*(pn>>1));\n}\nvoid NTT(int* a,int t){\n    R(i,0,pn)if(i<rev[i]) swap(a[i],a[rev[i]]);\n    for(int mid=1;mid<pn;mid<<=1){\n        int wn=Pow(~t?G:iG,(mod-1)/(mid<<1));\n        for(int i=0;i<pn;i+=(mid<<1)){\n            int w=1;\n            R(j,i,mid+i){\n                int x=a[j],y=1ll*a[mid+j]*w%mod;\n                a[j]=(x+y)%mod,a[mid+j]=(x-y+mod)%mod,w=1ll*w*wn%mod;\n            }\n        }\n    }\n    if(!~t){\n        int in=Pow(pn,mod-2);\n        R(i,0,pn) a[i]=1ll*a[i]*in%mod;\n    }\n}\n\n//Main\nint main(){\n    ios::sync_with_stdio(0);\n    cin.tie(0),cout.tie(0);\n    cin>>d>>n>>m;\n    if(n-2*m<0) return cout<<0<<'\\n',0;\n    if(d<=n-2*m) return cout<<Pow(d,n)<<'\\n',0;\n    math_init(),poly_init();\n    R(i,0,d+1){\n        f[i]=1ll*Pow((d-2*i+mod)%mod,n)*ifac[i]%mod;\n        if(i&1) f[i]=(mod-f[i])%mod;\n        g[i]=ifac[i];\n    }\n    R(i,d+1,pn) f[i]=g[i]=0;\n    NTT(f,1),NTT(g,1);\n    R(i,0,pn) f[i]=1ll*f[i]*g[i]%mod;\n    NTT(f,-1);\n    R(i,d+1,pn) f[i]=g[i]=0;\n    R(i,0,d+1) f[i]=1ll*f[i]*fac[d]%mod*ifac[d-i]%mod*Pow(2,mod-1-i)%mod;\n    reverse(f,f+d+1);\n    R(i,0,d+1) f[i]=1ll*f[i]*fac[d-i]%mod;\n    R(i,0,d+1){\n        g[i]=ifac[i];\n        if(i&1) g[i]=(mod-g[i])%mod;\n    }\n    R(i,d+1,pn) f[i]=g[i]=0;\n    NTT(f,1),NTT(g,1);\n    R(i,0,pn) g[i]=1ll*f[i]*g[i]%mod;\n    NTT(g,-1);\n    R(i,d+1,pn) f[i]=g[i]=0;\n    R(i,0,d+1) g[i]=1ll*g[i]*ifac[d-i]%mod;\n    reverse(g,g+d+1);\n    R(i,0,n-2*m+1) (ans+=g[i])%=mod;\n    cout<<ans<<'\\n';\n    return 0;\n}\n```\n\n---\n\n**\u795d\u5927\u5bb6\u5b66\u4e60\u6109\u5feb\uff01**",
        "postTime": 1602764057,
        "uid": 118365,
        "name": "George1123",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5401 \u3010[CTS2019]\u73cd\u73e0\u3011"
    },
    {
        "content": "[\u6765\u849f\u84bb\u65e0\u4eba\u95ee\u6d25\u7684\u535a\u5ba2\u56ed\u91cc\u6765\u770b /kel](https://www.cnblogs.com/zkyJuruo/p/13822584.html)\n\n## \u849f\u84bb\u8bed\n\u8fd9\u9898\u592a\u7384\u5b66\u4e86\uff0c\u849f\u84bb\u5199\u7bc7\u9898\u89e3\u6765\u8ba9\u4e4b\u540e\u590d\u4e60 = =\n## \u849f\u84bb\u89e3\n\u5047\u8bbe\u7b2c $i$ \u4e2a\u989c\u8272\u6709 $cnt_i$ \u4e2a\u73cd\u73e0\u3002\n\n$\\sum\\limits_{i=1}^{n} \\left\\lfloor\\frac{cnt_i}{2}\\right\\rfloor \\ge m$\n\n$\\sum\\limits_{i=1}^{n} cnt_i - cnt_i \\mod 2 \\ge 2m$\n\n$n - \\sum\\limits_{i=1}^{n} cnt_i \\mod 2 \\ge 2m$\n\n$\\sum\\limits_{i=1}^{n} cnt_i \\mod 2 \\le n-2m$\n\n\u5373 $cnt$ \u6570\u7ec4\u4e2d\u7684\u5947\u6570\u4e2a\u6570\u5c0f\u4e8e\u7b49\u4e8e $n-2m$\u3002\n\n\u5982\u679c $n-2m\\ge d$\uff0c\u90a3\u4e48\u7b54\u6848\u663e\u7136\u4e3a $d^n$ (\u6ca1\u6709\u4efb\u4f55\u9650\u5236\u4e86)\n\n\u5982\u679c $n-2m\\le 0$ \u90a3\u4e48\u7b54\u6848\u4e3a $0$\u3002\n\n\u4ee4 $g = n - 2 m$\n\n$odd_i$ : $cnt$ \u6570\u7ec4\u4e2d\u6070\u597d $i$ \u4e2a\u5947\u6570\u7684\u65b9\u6848\u6570\n\n$f_i$ : $cnt$ \u6570\u7ec4\u4e2d\u94a6\u5b9a $i$ \u4e2a\u5947\u6570\u7684\u65b9\u6848\u6570\n\n$$ans = \\sum\\limits_{i=0}^{g} odd_i$$\n\n$$f_x=\\sum\\limits_{i=x}^{d} C_i^x odd_i \\Leftrightarrow odd_x=\\sum\\limits_{i=x}^{d} (-1)^{i-x} C_i^x f_i$$\n\n\u6240\u4ee5\u8003\u8651\u901a\u8fc7\u7b97\u51fa f \u6765\u7b97\u51fa odd \u6570\u7ec4, \u4ece\u800c\u6c42\u5f97\u7b54\u6848\u3002\n\n$$f_i=n!(C_{D}^{i})(\\sum\\limits_{i=0} \\frac{x^i}{i!})^{D-i}(\\sum\\limits_{i=0} [i \\mod 2 = 1] \\frac{x^i}{i!})^i [x^n]$$\n\n$$f_i=n!(C_{D}^{i})e^{x(D-i)} (\\frac{e^{x} - e^{-x}}{2})^{i}[x^n]$$\n\n\u4e8c\u9879\u5f0f\u5c55\u5f00\uff1a\n\n$$f_i=n!(C_{D}^{i})\\frac{1}{2^i} \\sum\\limits_{j=0}^{i} C_i^j  e^{x(D-i)} e^{jx} (-e^{-x})^{i-j} [x^n]$$\n\n$$f_i=n!(C_{D}^{i})\\frac{1}{2^i} \\sum\\limits_{j=0}^{i} (-1)^j C_i^j  e^{x(D-i)} e^{(i-j)x} e^{-xj} [x^n]$$\n\n$$f_i=n!(C_{D}^{i})\\frac{1}{2^i} \\sum\\limits_{j=0}^{i} (-1)^j C_i^j e^{x(D-2j)} [x^n]$$\n\n$$f_i=n!(C_{D}^{i})\\frac{1}{2^i} \\sum\\limits_{j=0}^{i} (-1)^j C_i^j \\frac{(D-2j)^n}{n!}$$\n\n$$f_i=n!(C_{D}^{i})\\frac{1}{2^i} \\sum\\limits_{j=0}^{i} (-1)^j \\frac{i!}{j!(i-j)!} \\frac{(D-2j)^n}{n!}$$\n\n$$f_i=(C_{D}^{i})\\frac{1}{2^i} \\sum\\limits_{j=0}^{i} (-1)^j \\frac{i!}{j!(i-j)!} (D-2j)^n$$\n\n$$P_i=(-1)^i \\frac{1}{i!} (D-2i)^n$$\n\n$$f_i=i!(C_{D}^{i})\\frac{1}{2^i} \\sum\\limits_{j=0}^{i} P_j \\frac{1}{(i-j)!}$$\n\n$$\u8fd9\u5c31\u662f\u4e2a\u5377\u79ef\u5f0f\u4e86\uff01\u7136\u540e\u5c31\u6c42\u51fa\u4e86 f_i$$\n\n$$odd_x=\\sum\\limits_{i=x}^{d} (-1)^{i-x} C_i^x f_i$$\n\n$$odd_x=(-1)^x \\sum\\limits_{i=x}^{d} (-1)^i \\frac{i!}{x!(i-x)!} f_i$$\n\n$$odd_x=\\frac{1}{x!}(-1)^x \\sum\\limits_{i=x}^{d} (-1)^i \\frac{i!}{(i-x)!} f_i$$\n\n$$G_i =f_i(-1)^ii!$$\n\n$$odd_x=\\frac{1}{x!}(-1)^x \\sum\\limits_{i=x}^{d}  \\frac{1}{(i-x)!} G_i$$\n\n$$odd_x=\\frac{1}{x!}(-1)^x \\sum\\limits_{i=x}^{d}  \\frac{1}{(i-x)!} G_i$$\n\n$$odd_x=\\frac{1}{x!}(-1)^x \\sum\\limits_{i=0}^{d-x}  \\frac{1}{i!} G_{i+x}$$\n\n$$\u7ffb\u8f6c odd \u548c G$$\n\n$$odd_{d-x}=\\frac{1}{x!}(-1)^x \\sum\\limits_{i=0}^{d-x}  \\frac{1}{i!} G_{d-x-i}$$\n\n\u7136\u540e\u518d\u5377\u4e00\u5377\u7b54\u6848\u5c31\u6c42\u51fa\u6765\u4e86\uff01\uff01\uff01\n\n## \u849f\u84bb\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define L(i, j, k) for(int i = (j), i##E = (k); i <= i##E; i++) \n#define R(i, j, k) for(int i = (j), i##E = (k); i >= i##E; i--) \n#define ll long long \n#define db double\n#define make_pair mp \n#define first x\n#define second y\n#define pb push_back\n#define mod 998244353\n#define iG 3\n#define invG 332748118\n#define sz(x) (int)(x.size())\nconst int N = 4e5 + 7;\nint qpow(int x, int y) {\n    if(x == 0) return 0;\n    int res = 1;\n    for(; y; x = 1ll * x * x % mod, y >>= 1) if(y & 1) res = 1ll * res * x % mod;\n    return res;\n}\nint ny(int x) { return qpow(x, mod - 2); }\nint pp[N];\nvoid fft(int *f, int len, int flag) {\n    for(int i = 0; i < len; i++) if(i < pp[i]) swap(f[pp[i]], f[i]);\n    for(int i = 2; i <= len; i <<= 1) {\n        int l = (i >> 1);\n        for(int j = 0; j < len; j += i) {\n            int ch = qpow(flag == 1 ? iG : invG, (mod - 1) / i), now = 1;\n            for(int k = j; k < j + l; k++) {\n                int ta = f[k], tb = 1ll * f[k + l] * now % mod;\n                f[k] = (ta + tb) % mod;\n                f[k + l] = (ta - tb + mod) % mod;\n                now = 1ll * now * ch % mod;\n            }\n        }\n    }\n    if(flag == -1) {\n        int invn = ny(len);\n        for(int i = 0; i < len; i++) f[i] = 1ll * f[i] * invn % mod;\n    }\n}\nint n, m, d, g, ans, f[N], P[N], ml;\nint jc[N], njc[N];\nint C(int x, int y) { return 1ll * jc[x] * njc[y] % mod * njc[x - y] % mod; }\nint main() {\n    scanf(\"%d%d%d\", &d, &n, &m);\n    if(n - 2 * m < 0) return printf(\"0\\n\"), 0;\n    if(n - 2 * m >= d) return printf(\"%d\\n\", qpow(d, n)), 0;\n    jc[0] = njc[0] = 1;\n    L(i, 1, d) jc[i] = 1ll * jc[i - 1] * i % mod, njc[i] = ny(jc[i]);\n    for(ml = 1; ml <= d * 2; ml <<= 1);\n    L(i, 0, d) P[i] = 1ll * qpow((d - 2 * i + mod) % mod, n) * (i % 2 == 0 ? 1 : mod - 1) % mod * njc[i] % mod, f[i] = njc[i];\n    for(int i = 0; i < ml; i++) pp[i] = ((pp[i >> 1] >> 1) | ((i & 1) * (ml >> 1)));\n    fft(P, ml, 1), fft(f, ml, 1);\n    for(int i = 0; i < ml; i++) f[i] = 1ll * P[i] * f[i] % mod;\n    fft(f, ml, -1);\n    for(int i = d + 1; i < ml; i++) f[i] = 0;\n    int now = 1;\n    L(i, 0, d) f[i] = 1ll * f[i] * now % mod * jc[d] % mod * njc[d - i] % mod, now = 1ll * now * 499122177 % mod;\n    L(i, 0, d) f[i] = 1ll * f[i] * (i % 2 == 0 ? 1 : mod - 1) % mod * jc[i] % mod;\n    reverse(f, f + d + 1);\n    for(int i = 0; i < ml; i++) P[i] = 0;\n    L(i, 0, d) P[i] = njc[i];\n    fft(f, ml, 1), fft(P, ml, 1);\n    for(int i = 0; i < ml; i++) f[i] = 1ll * f[i] * P[i] % mod;\n    fft(f, ml, -1);\n    reverse(f, f + d + 1);\n    L(i, 0, d) f[i] = 1ll * f[i] * (i % 2 == 0 ? 1 : mod - 1) % mod * njc[i] % mod;\n    g = n - 2 * m;\n    L(i, 0, g) (ans += f[i]) %= mod;\n    printf(\"%d\\n\", ans);\n    return 0;\n}\n```",
        "postTime": 1602763678,
        "uid": 173660,
        "name": "zhoukangyang",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5401 \u3010[CTS2019]\u73cd\u73e0\u3011"
    },
    {
        "content": "# \u9898\u76ee\n\n&emsp;&emsp;[luogu](https://www.luogu.com.cn/problem/P5401).\n\n# \u9898\u89e3\n\n&emsp;&emsp;\u5148 % \u5154\u3002~~\u540c\u4e3a\u5154\u5b50\u4e3a\u4ec0\u4e48\u5c0f\u7c89\u5154\u8fa3\u4e48\u5f3aqwq\u3002~~ \u672c\u6587\u5927\u4f53\u8ddf\u968f[\u5c0f\u7c89\u5154\u7684\u9898\u89e3](https://www.cnblogs.com/PinkRabbit/p/CTS2019D1T2.html)\u7684\u601d\u8def\uff0c\u5e76\u4e3a~~\u50cf\u6211\u4e00\u6837~~\u591a\u9879\u5f0f\u8d85 poor \u7684\u8bfb\u8005\u4f5c\u4e86\u5f88\u8be6\u7ec6\u7684\u89e3\u91ca\u3002\u5982\u679c\u9898\u89e3\u754c\u9762\u516c\u5f0f\u51fa\u73b0\u95ee\u9898\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u201c\u5728 Ta \u7684\u535a\u5ba2\u67e5\u770b\u201dw~  \n\n&emsp;&emsp;\u751f\u6210\u51fd\u6570 + NTT\u3002  \n\n&emsp;&emsp;\u9996\u5148\uff0c\u8f6c\u5316\u9898\u610f\uff1a\u6c42\u957f\u5ea6\u4e3a $n$\uff0c\u5143\u7d20\u5c5e\u4e8e $[1,D]$ \u4e14\u5b58\u5728\u81f3\u5c11 $m$ \u5bf9\u4f4d\u7f6e\u4e0d\u91cd\u590d\u7684\u76f8\u540c\u5143\u7d20\u7684\u6574\u6570\u5e8f\u5217\u4e2a\u6570\u3002  \n\n&emsp;&emsp;\u4e0d\u59a8\u628a\u5143\u7d20\u7684\u503c\u5f62\u8c61\u5316\u4e3a\u989c\u8272\uff0c\u8bbe\u7b2c $c$ \u4e2d\u989c\u8272\u5728\u67d0\u4e2a\u5e8f\u5217\u4e2d\u51fa\u73b0\u6b21\u6570\u4e3a $cnt_c$\u3002\u5219\u8be5\u5e8f\u5217\u5408\u6cd5\uff0c\u5f53\u4e14\u4ec5\u5f53\uff1a  \n$$\n\\sum_{c=1}^D\\lfloor\\frac{cnt_c}2\\rfloor\\ge m\\tag1\n$$\n&emsp;&emsp;\u4e5f\u5373\u662f\uff0c\u6bcf\u79cd\u989c\u8272\u6700\u591a\u7ec4\u5408\u51fa $\\lfloor\\frac{cnt_c}2\\rfloor$ \u7ec4\u76f8\u540c\u5143\u7d20\u5bf9\uff0c\u5e76\u5c06\u5176\u6c42\u548c\u3002\u5bf9 $(1)$ \u53d8\u5f62\uff1a  \n$$\n(1)\\Rightarrow\\sum_{c=1}^D\\frac{cnt_c-(cnt_c\\bmod 2)}2\\ge m\n$$\n\n$$\n\\Rightarrow\\sum_{c=1}^Dcnt_c-(cnt_c\\bmod2)\\ge2m\n$$\n\n$$\n\\Rightarrow n-\\sum_{c=1}^Dcnt_c\\bmod 2\\ge2m\n$$\n\n$$\n\\Rightarrow\\sum_{c=1}^Dcnt_c\\bmod2\\le n-2m\\tag2\n$$\n\n&emsp;&emsp;\u7531 $(2)$\uff0c\u4ea7\u751f\u4e86\u4e00\u4e9b\u7279\u5224\uff1a\u5f53 $n<2m$\uff0c\u975e\u8d1f\u6570\u4e4b\u548c\u4e0d\u53ef\u80fd\u5c0f\u4e8e $0$\uff0c\u7b54\u6848\u4e3a $0$\uff1b\u5f53 $D\\le n-2m$\uff0c\u7b49\u5f0f\u6052\u6210\u7acb\uff08\u989c\u8272\u603b\u6570\u4ec5 $D$\uff09\uff0c\u7b54\u6848\u4e3a $D^n$\u3002  \n\n&emsp;&emsp;\u63a5\u4e0b\u6765\uff0c\u4ee4 $g_i$ \u8868\u793a**\u6070\u597d**\u6709 $i$ \u4e2a $cnt_c\\bmod2=1$ \u7684\u65b9\u6848\u6570\u3002\u5373 $g_i=\\sum_{cnt}[\\sum_{c=1}^Dcnt_c\\bmod2=i]$\u3002\u53ef\u4ee5\u53d1\u73b0\u6700\u7ec8\u7b54\u6848\u4e3a $\\sum_{c=0}^{n-2m}g_c$\uff0c\u5373 $(2)$ \u7684\u7b49\u5f0f\u5de6\u8fb9\u6240\u6709\u6ee1\u8db3\u6761\u4ef6\u7684\u53d6\u503c\u7684\u65b9\u6848\u6570\u4e4b\u548c\u3002  \n\n&emsp;&emsp;\u7136\u540e\u5bb9\u65a5 $g$\uff1a\u4ee4 $f_i$ \u4e3a**\u81f3\u5c11**\u6709 $i$ \u4e2a $cnt_c\\bmod2=1$ \u7684\u65b9\u6848\u6570\u3002\u6ce8\u610f\uff1a$f$ \u8003\u8651\u4e86\u4e0e $g$ \u7684\u5bb9\u65a5\u5173\u7cfb\u3002\u66f4\u7ec6\u81f4\u5730\u9610\u91ca\uff0c$f_i$ \u8868\u793a\u5148**\u4fdd\u8bc1\u6709 $i$ \u4e2a\u989c\u8272\u4e3a\u5947\u6570\u7684\u524d\u63d0\u4e0b\uff0c\u5176\u5b83\u989c\u8272\u4efb\u610f\u9009**\u7684\u65b9\u6848\u603b\u6570\u3002\u5982\u6b64\u4e00\u6765\uff0c\u5bf9\u4e8e\u4efb\u610f $i\\ge j$\uff0c $g_i$ \u4f1a\u5bf9 $f_j$ \u8d21\u732e $i\\choose j$ \u6b21\u2014\u2014\u5728 $i$ \u4e2d\u9009 $j$ \u4e2a\u201c\u4fdd\u5e95\u201d\uff0c\u5176\u4f59 $i-j$ \u4e2a\u6210\u4e3a\u201c\u4efb\u610f\u9009\u201d\u65b9\u6848\u4e2d\u7684\u82e5\u5e72\u79cd\u3002\u5219\uff1a  \n$$\nf_i=\\sum_{j}{j\\choose i}g_j\\tag3\n$$\n&emsp;&emsp;\u5229\u7528[\u4e8c\u9879\u5f0f\u53cd\u6f14](http://blog.miskcoo.com/2015/12/inversion-magic-binomial-inversion)\uff0c\u5bf9 $(3)$ \u53d8\u5f62\uff1a  \n$$\ng_i=\\sum_j(-1)^{j-i}{j\\choose i}f_j=\\sum_j(-1)^{i-j}\\frac{j!}{i!(j-i)!}f_j=\\frac{1}{i!}\\sum_j\\frac{(-1)^{i-j}}{[-(i-j)]!}\\cdot j!f_j\\tag4\n$$\n&emsp;&emsp;\u53ef\u4ee5\u53d1\u73b0\uff0c\u5728\u6700\u540e\u4e00\u4e2a\u5f0f\u5b50\u7684\u6c42\u548c\u4e2d\uff0c\u70b9\u4e58\u53f7\u5de6\u53f3\u4e24\u8fb9\u5206\u522b\u662f\u5173\u4e8e $j$ \u548c $i-j$ \u7684\u51fd\u6570\uff0c\u90a3\u4e48 $g$ \u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\u3002\u53ea\u8981\u6c42\u51fa $f$ \u5373\u53ef\u3002\n\n------------\n\n&emsp;&emsp;\u56de\u987e $f$ \u7684\u5b9a\u4e49\uff0c\u5e76\u5c1d\u8bd5\u5f15\u5165[\u6307\u6570\u578b\u751f\u6210\u51fd\u6570](https://www.cnblogs.com/Mychael/p/9187796.html)\u3002\u8003\u8651\u5230\u5bf9\u4e8e\u5e8f\u5217 $C=\\{1,1,1,\\dots\\}$\uff0c\u5176\u751f\u6210\u51fd\u6570\u4e3a $G_e(C)=\\sum_i\\frac{x^i}{i!}=e^x$\uff1b\u5bf9\u4e8e\u5e8f\u5217 $O=\\{0,1,0,1,\\dots\\}$\uff0c\u5176\u751f\u6210\u51fd\u6570\u4e3a $G_e(O)=\\frac{x_1}{1!}+\\frac{x_3}{3!}+\\frac{x_5}{5!}+\\cdots=\\frac{e^x-e^{-x}}2$\u3002\u540c\u65f6\uff0c\u8bb0 $[x^n]f(x)$ \u8868\u793a\u51fd\u6570 $f(x)$ \u7684 $n$ \u6b21\u9879\u7cfb\u6570\uff0c\u5219\u6709\uff1a  \n$$\nf_i={D\\choose i}n![x^n]\\left(G_e^i(O)G_e^{D-i}(C)\\right)\\tag5\n$$\n&emsp;&emsp;\u5148\u505c\u4e0b\u6765\u7406\u89e3\uff1a  \n\n- \u7b2c\u4e00\u9879 $D\\choose i$\uff0c\u5148\u94a6\u5b9a $D$ \u79cd\u989c\u8272\u4e2d\u7684 $i$ \u4e2a\u4e3a\u5fc5\u987b\u5947\u6570\u3002\u522b\u5fd8\u4e86 $f$ \u5b9a\u4e49\uff0c\u5176\u4f59\u989c\u8272\u4e5f\u53ef\u4ee5\u4e3a\u5947\u6570\uff0c\u5b83\u4eec\u662f\u4efb\u610f\u7684\u3002\n- \u7b2c\u4e8c\u9879 $n!$\uff0c\u662f\u7ea6\u6389\u6307\u6570\u751f\u6210\u51fd\u6570\u7b2c $n$ \u9879\u7684 $\\frac{1}{n!}$\u3002\u6bd4\u5982 $[x^3]G_e(C)=\\frac{1}{3!}$\uff0c\u9700\u8981\u4e58\u4e0a $\\frac{1}{3!}$ \u624d\u4e3a $1$\u3002\n\n- \u7b2c\u4e09\u9879 $[x^n]\\left(G_e^i(O)G_e^{D-i}(C)\\right)$\uff0c\u6b63\u5982\u4e00\u822c\u7684\u5377\u79ef\uff0c\u751f\u6210\u51fd\u6570\u7684\u5377\u79ef\u8868\u73b0\u4e86\u5728\u4e0d\u540c\u96c6\u5408\u4e2d\u9009\u62e9\u7684\u65b9\u6848\u3002\u8be5\u5f0f\u4e2d\u5377\u79ef\u7684\u7b2c $n$ \u9879\u5c31\u8868\u793a**\u9009\u62e9 $i$ \u4e2a\u5947\u6570\uff0c\u518d\u4efb\u9009 $D-i$ \u4e2a\u975e\u8d1f\u6570\uff0c\u4f7f\u5f97\u5176\u548c\u6070\u4e3a $n$** \u7684\u65b9\u6848\u6570\u3002\u53ef\u4ee5\u7ed3\u5408\u6700\u521d\u7684\u9898\u610f\u7406\u89e3\u3002\n\n&emsp;&emsp;\u7406\u89e3\u4e4b\u540e\uff0c\u7740\u624b\u5bf9 $(5)$ \u53d8\u5f62\uff08\u6ce8\u610f\u6240\u6709\u7684 $i$ \u5747\u4e3a\u4e0b\u6807\uff0c\u800c\u975e\u865a\u6570\u5355\u4f4d\uff09\uff1a  \n$$\nf_i={D\\choose i}n![x^n]\\left(\\frac{(e^x-e^{-x})^i}{2^i}\\cdot e^{x(D-i)}\\right)\n$$\n\n$$\n\\Rightarrow f_i={\\frac{1}{2^i}{D\\choose i}n![x^n]\\left((e^x-e^{-x})^ie^{x(D-i)}\\right)}\\tag6\n$$\n\n&emsp;&emsp;\u5229\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\uff0c\u5c55\u5f00 $(6)$ \u4e2d\u7684 $(e^x-e^{-x})^i$\uff0c\u5f97\uff1a  \n$$\n\\Rightarrow f_i=\\frac{1}{2^i}{D\\choose i}n![x^n]\\left(\\sum_{j=0}^i{i\\choose j}e^{jx}(-e^{-x})^{i-j}e^{x(D-i)}\\right)\n$$\n\n$$\n\\Rightarrow f_i=\\frac{1}{2^i}{D\\choose i}n!\\sum_{j=0}^i(-1)^{i-j}{i\\choose j}[x^n]e^{(D+2j-2i)x}\\tag7\n$$\n\n&emsp;&emsp;\u53d1\u73b0 $e^{(D+2j-2i)x}$ \u662f\u5f62\u5982 $e^{ax}$ \u7684\u5f62\u5f0f\uff0c\u800c $e^{ax}$ \u662f\u5e8f\u5217 $\\{a^0,a^1,a^2,\\dots\\}$ \u7684\u751f\u6210\u51fd\u6570\u3002\u6240\u4ee5\u5176 $n$ \u6b21\u9879\u5e94\u4e3a $\\frac{a^n}{n!}$\u3002\u5219 $[x^n]e^{(D+2j-2i)x}=\\frac{(D+2j-2i)^n}{n!}$\u3002\u5c06\u5176\u4ee3\u5165 $(7)$ \u5e76\u6574\u7406\uff1a  \n$$\n\\Rightarrow f_i=\\frac{1}{2^i}{D\\choose i}n!\\sum_{j=0}^i(-1)^{i-j}{i\\choose j}\\frac{(D+2j-2i)^n}{n!}\n$$\n\n$$\n\\Rightarrow f_i=\\frac{i!}{2^i}{D\\choose i}\\sum_{j=0}^i(-1)^{i-j}\\frac{(D+2j-2i)^n}{j!(i-j)!}\n$$\n\n$$\n\\Rightarrow f_i=\\frac{D!}{2^i(D-i)!}\\sum_{j=0}^i(-1)^{i-j}\\frac{(D+2j-2i)^n}{j!(i-j)!}\\tag8\n$$\n\n\n\n&emsp;&emsp;\u628a $(8)$ \u671d\u7740\u5377\u79ef\u7684\u5f62\u5f0f\u9760\u8fd1\uff0c\u5373\u5206\u5f00 $i-j$ \u4e0e $j$\u3002\u4e3a\u4e86\u7f8e\u89c2\uff0c\u4ee4 $k=i-j$\uff0c\u5219 $j=i-k$\u3002\u63a8\u51fa\uff1a  \n$$\n\\Rightarrow f_i=\\frac{D!}{2^i(D-i)!}\\sum_{k=0}^i\\frac{1}{(i-k)!}\\cdot\\frac{(-1)^k(D-2k)^n}{k!}\\tag9\n$$\n&emsp;&emsp;\u6b64\u65f6\uff0c\u548c\u5f0f\u5df2\u7ecf\u662f\u5377\u79ef\u7684\u5f62\u5f0f\u3002  \n&emsp;&emsp;\u5230\u6b64\uff0c\u5229\u7528 NTT\uff0c\u901a\u8fc7 $(9)$ \u6c42\u51fa $f$\uff0c\u518d\u901a\u8fc7 $(4)$ \u6c42\u51fa $g$\uff0c\u6700\u540e\u6c42\u5f97\u7b54\u6848\u4e3a $\\sum_{c=0}^{n-2m}g_c$\uff0c\u5e76\u8bb0\u5f97\u7279\u5224 $(2)$ \u6240\u5f15\u51fa\u7684\u4e24\u79cd\u60c5\u51b5\uff0c\u8fd9\u9053\u9898\u5c31\u89e3\u51b3\u5566~\n\n## \u4ee3\u7801\n\n```cpp\n#include <cstdio>\n\nconst int MOD = 998244353, G = 3, INV2 = ( MOD + 1 ) >> 1, MAXD = 1 << 18;\nint D, n, m, inv[MAXD + 5], fac[MAXD + 5], ifac[MAXD + 5];\nint A[MAXD + 5], B[MAXD + 5], rev[MAXD + 5];\n\ninline int qkpow ( int a, int b, const int p = MOD ) {\n\tint ret = 1;\n\tfor ( ; b; a = 1ll * a * a % p, b >>= 1 ) ret = 1ll * ret * ( b & 1 ? a : 1 ) % p;\n\treturn ret;\n}\n\ninline void NTT ( const int n, int* a, const int tp ) {\n\tfor ( int i = 0; i < n; ++ i ) {\n\t\tif ( i < rev[i] ) {\n\t\t\ta[i] ^= a[rev[i]] ^= a[i] ^= a[rev[i]];\n\t\t}\n\t}\n\tfor ( int i = 2, stp = 1; i <= n; i <<= 1, stp <<= 1 ) {\n\t\tint w = qkpow ( G, ( MOD - 1 ) / i );\n\t\tif ( ! ~ tp ) w = qkpow ( w, MOD - 2 );\n\t\tfor ( int j = 0; j < n; j += i ) {\n\t\t\tfor ( int k = j, r = 1; k < j + stp; ++ k, r = 1ll * r * w % MOD ) {\n\t\t\t\tint ev = a[k], ov = 1ll * a[k + stp] * r % MOD;\n\t\t\t\ta[k] = ( ev + ov ) % MOD, a[k + stp] = ( ev - ov + MOD ) % MOD;\n\t\t\t}\n\t\t}\n\t}\n\tif ( ! ~ tp ) {\n\t\tint rvn = qkpow ( n, MOD - 2 );\n\t\tfor ( int i = 0; i < n; ++ i ) a[i] = 1ll * a[i] * rvn % MOD;\n\t}\n}\n\ninline void polyConv ( int lenA, int lenB, int* A, int* B, int* C ) {\n\tint lenC = lenA + lenB - 1, len = 1, lg = 0;\n\tfor ( ; len < lenC; len <<= 1, ++ lg );\n\tfor ( int i = 0; i < len; ++ i ) rev[i] = ( rev[i >> 1] >> 1 ) | ( ( i & 1 ) << lg >> 1 );\n\tstatic int tmpA[MAXD + 5], tmpB[MAXD + 5];\n\tfor ( int i = 0; i < len; ++ i ) {\n\t\ttmpA[i] = i < lenA ? A[i] : 0;\n\t\ttmpB[i] = i < lenB ? B[i] : 0;\n\t}\n\tNTT ( len, tmpA, 1 ), NTT ( len, tmpB, 1 );\n\tfor ( int i = 0; i < len; ++ i ) C[i] = 1ll * tmpA[i] * tmpB[i] % MOD;\n\tNTT ( len, C, -1 );\n}\n\ninline void init () {\n\tinv[1] = fac[1] = ifac[1] = fac[0] = ifac[0] = 1;\n\tfor ( int i = 2; i <= D; ++ i ) {\n\t\tfac[i] = 1ll * i * fac[i - 1] % MOD;\n\t\tinv[i] = 1ll * ( MOD - MOD / i ) * inv[MOD % i] % MOD;\n\t\tifac[i] = 1ll * inv[i] * ifac[i - 1] % MOD;\n\t}\n}\n\nint main () {\n\tscanf ( \"%d %d %d\", &D, &n, &m );\n\tif ( m << 1 > n ) return puts ( \"0\" ), 0;\n\tif ( m << 1 <= n - D ) return printf ( \"%d\\n\", qkpow ( D, n ) ), 0;\n\tinit ();\n\tfor ( int i = 0; i <= D; ++ i ) {\n\t\tA[i] = 1ll * qkpow ( ( D - 2 * i + MOD ) % MOD, n ) * ( i & 1 ? MOD - ifac[i] : ifac[i] ) % MOD;\n\t\tB[i] = ifac[i];\n\t}\n\tpolyConv ( D + 1, D + 1, A, B, A );\n\tfor ( int i = 0; i <= D; ++ i ) {\n\t\tA[i] = 1ll * A[i] * fac[D] % MOD * fac[i] % MOD * qkpow ( INV2, i ) % MOD * ifac[D - i] % MOD;\n\t\tB[D - i] = i & 1 ? MOD - ifac[i] : ifac[i];\n\t}\n\tpolyConv ( D + 1, D + 1, A, B, A );\n\tint ans = 0;\n\tfor ( int i = 0; i <= n - 2 * m; ++ i ) ans = ( ans + 1ll * ifac[i] * A[D + i] ) % MOD;\n\tprintf ( \"%d\\n\", ans );\n\treturn 0;\n}\n```\n\n",
        "postTime": 1591322276,
        "uid": 123807,
        "name": "Rainybunny",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5401 \u3010[CTS2019]\u73cd\u73e0\u3011"
    },
    {
        "content": "\u7a0d\u5fae\u8bb2\u4e00\u4e0b\u9c7c\u9c7c\u9898\u89e3\u4e2d\u4ece\u8fd9\u4e00\u90e8\u5206\u5f00\u59cb\u7684\u63a8\u5bfc\uff1a\r\n$$\r\nF(x)=\\sum_{i=0}^k \\binom di (x+1)^i (x-1)^{d-i}\r\n$$\r\n\u8981\u5c1d\u8bd5\u6c42\u8fd9\u4e2a\u5f0f\u5b50\u7684\u7cfb\u6570\u3002\r\n\r\n\u8fd8\u662f\u5148\u6c42\u5bfc\uff1a\r\n$$\r\nF'(x)\r\n=\\sum_{i=0}^k \\binom di [(d-i)(x-1)^i(x+1)^{d-i-1}+i(x-1)^{i-1}(x+1)^{d-i}]\r\n$$\r\n\u5bf9\u6bd4\u4e00\u4e0b\u8fd9\u4e2a\u5f0f\u5b50\u548c\u4e0a\u9762\u7684 $F(x)$\uff0c\u6211\u4eec\u7684\u76ee\u7684\u662f\u7528 $F(x)$ \u8868\u793a\u51fa $F'(x)$\uff0c\u4f46\u662f $F'(x)$ \u4e2d\u7684\u8fd9\u4e2a $i$ \u770b\u8d77\u6765\u975e\u5e38\u4e0d\u53cb\u597d\u3002\u7136\u540e\u53d1\u73b0\u53ef\u4ee5\u628a\u5b83\u5438\u6536\u5230\u7ec4\u5408\u6570\u91cc\u9762\uff1a\r\n$$\r\nF'(x)\r\n=\\sum_{i=0}^k d[\r\n\\binom {d-1}{d-i-1} (x-1)^i(x+1)^{d-i-1}+\r\n\\binom {d-1}{i-1} (x-1)^{i-1}(x+1)^{d-i}]\r\n$$\r\n\u7136\u540e\u518d\u89c2\u5bdf\u4e00\u4e0b $\\binom di = \\binom {d-1}{d-i-1}+\\binom{d-1}{i-1}$\uff0c\u8fd9\u8bf1\u5bfc\u6211\u4eec\u628a $F(x)$ \u4e2d\u7684\u7ec4\u5408\u6570\u62c6\u5f00\u3002\r\n$$\r\nF(x)=\\sum_{i=0}^k \\binom {d-1}{d-i-1} (x+1)^i (x-1)^{d-i}+ \\binom {d-1}{i-1} (x+1)^i (x-1)^{d-i}\r\n$$\r\n\u7136\u540e\u5176\u5b9e\u8fd9\u4e2a\u65f6\u5019 $F(x)$ \u548c $F'(x)$ \u7684\u5f62\u5f0f\u5c31\u5f88\u50cf\u4e86\u3002\u56e0\u4e3a $F'(x)$ \u591a\u4e00\u4e2a $d$ \u7684\u5e38\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u7ed9 $F(x)$ \u914d\u4e00\u4e2a $d$ \u7684\u7cfb\u6570\uff1b\u56e0\u4e3a $F(x)$ \u9ad8\u4e00\u6b21\uff0c\u6240\u4ee5\u6211\u4eec\u7ed9 $F'(x)$ \u914d\u4e00\u4e2a $x$ \u7684\u7cfb\u6570\u3002\u7136\u540e\u8ba1\u7b97\u4e00\u4e0b\uff1a\r\n$$\r\ndF(x)-xF'(x)=\r\n\\sum_{i=0}^k \\binom {d-1}{i} (x-1)^{i}(x+1)^{d-i-1} \r\n\t\t\t-\\binom {d-1}{i-1} (x-1)^{i-1}(x+1)^{d-i}\r\n$$\r\n\u6211\u8349\uff0c\u770b\u8d77\u6765\u5b8c\u5168\u6ca1\u6709\u53d8\u5316\u3002\u5176\u5b9e\u4e0d\u7136\uff0c\u6ce8\u610f $i$ \u5bf9\u5e94\u7684\u5de6\u8fb9\u9879\u548c $i+1$ \u5bf9\u5e94\u7684\u53f3\u8fb9\u9879\u4e92\u4e3a\u76f8\u53cd\u6570\uff0c\u4ed6\u4eec\u4f1a\u5168\u90e8\u62b5\u6d88\u6389\uff1b\u5e76\u4e14 $i=0$ \u65f6\u53f3\u8fb9\u9879\u4e3a $0$\u3002\u6240\u4ee5\u6700\u540e\u53ea\u4f1a\u5269\u4e00\u4e2a\u9879\r\n$$\r\ndF(x)-xF'(x)=\\binom {d-1}{k} (x-1)^{k}(x+1)^{d-k-1}\r\n$$\r\n\u8fd9\u5c31\u662f\u4e86\u3002\r\n\r\n\u7136\u540e\u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2a\u7279\u522b\u597d\u7684\u70b9\uff0c\u5c31\u662f\u5de6\u8fb9\u7684 $F'(x)$ \u88ab\u4e58\u4e86 $x$\uff0c\u5bfc\u81f4\u5b83\u7684\u7cfb\u6570\u53c8\u548c $F(x)$ \u5bf9\u9f50\u4e86\u3002\u6240\u4ee5\u5de6\u8fb9\u8fd9\u4e2a\u591a\u9879\u5f0f\u7684 $n$ \u6b21\u9879\u7cfb\u6570\u5c31\u662f $(d-n)f_n$\uff0c\u90a3\u4e48\u53ea\u8981\u6c42\u51fa\u53f3\u8fb9\u8fd9\u4e2a\u591a\u9879\u5f0f\u7684\u7cfb\u6570\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230 $f_n$ \u4e86\u3002",
        "postTime": 1654601198,
        "uid": 79067,
        "name": "dottle",
        "ccfLevel": 10,
        "title": "5401 \u5bf9 Nacly_Fish \u9898\u89e3\u7684\u6ce8\u89e3"
    },
    {
        "content": "[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/P5401)\n\n\u5982\u679c\u6211\u4eec\u8bbe\u7b2c $i$ \u79cd\u989c\u8272\u4e00\u5171\u51fa\u73b0\u4e86 $cnt_i$ \u6b21\uff0c\u90a3\u4e48\u4e0d\u96be\u53d1\u73b0\u5982\u679c\u65b9\u6848\u5408\u6cd5\u5219\u6709\n$$\n\\sum\\limits_{i=1}^D\\lfloor \\frac{cnt_i}{2} \\rfloor\\geqslant m\n$$\n\u6211\u4eec\u7b80\u5355\u63a8\u4e00\u4e0b\u5f0f\u5b50\n$$\n\\begin{aligned}\n&\\sum\\limits_{i=1}^D\\lfloor \\frac{cnt_i}{2} \\rfloor\\geqslant m\\\\\n=&\\sum\\limits_{i=1}^D cnt_i-(cnt_i\\bmod 2) \\geqslant 2m\\\\\n=&\\sum\\limits_{i=1}^D cnt_i\\bmod 2\\leqslant n-2m\n\\end{aligned}\n$$\n\u5373\u6211\u4eec\u8981\u5173\u6ce8 $cnt_i$ \u7684\u5947\u5076\u6027\u3002\n\n\u5f53 $n-2m\\geqslant D$ \u6216 $n-2m<0$ \u65f6\u9700\u8981\u7279\u5224\u4e00\u4e0b\u3002\n\n\u6211\u4eec\u8bbe $f_i$ \u4e3a\u5728\u6ee1\u8db3 $\\sum cnt=n$ \u7684\u60c5\u51b5\u4e0b\uff0c$cnt$ \u4e3a\u5947\u6570\u7684\u989c\u8272\u6070\u597d\u6709 $i$ \u4e2a\u7684\u65b9\u6848\u6570\u3002\u7531\u4e8e\u96be\u4ee5\u76f4\u63a5\u7b97 $f$\uff0c\u8003\u8651\u4e8c\u9879\u5f0f\u53cd\u6f14\uff0c\u8bbe $g_i$ \u4e3a\u5728\u6ee1\u8db3 $\\sum cnt=n$ \u7684\u60c5\u51b5\u4e0b\uff0c\u94a6\u5b9a $i$ \u4e2a\u989c\u8272 $cnt$ \u4e3a\u5947\u6570\uff0c\u5269\u4e0b\u4efb\u610f\u7684\u65b9\u6848\u6570\u3002\n\n\u6211\u4eec\u8003\u8651\u5229\u7528\u751f\u6210\u51fd\u6570\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u5bf9\u4e8e\u67d0\u4e00\u4e2a\u989c\u8272\uff0c$cnt$ \u4e3a\u5947\u6570\u7684\u65b9\u6848\u6570\u6240\u5bf9\u5e94\u7684\u6307\u6570\u751f\u6210\u51fd\u6570\u4e3a $\\frac{e^x-e^{-x}}{2}$\uff0c$cnt$ \u4efb\u610f\u7684\u65b9\u6848\u6570\u5bf9\u5e94\u7684\u6307\u6570\u751f\u6210\u51fd\u6570\u4e3a $e^x$\uff08\u56e0\u4e3a\u6bcf\u4e2a\u73cd\u73e0\u662f\u6709\u7f16\u53f7\u7684\uff0c\u6240\u4ee5\u7528 EGF\uff09\u3002\u90a3\u4e48\u6709\n$$\n\\begin{aligned}\ng_i&=\\binom{D}{i}n![x^n](\\frac{e^x-e^{-x}}{2})^i(e^x)^{D-i}\\\\\n&=\\binom{D}{i}\\frac{n!}{2^i}[x^n](e^x-e^{-x})^i(e^x)^{D-i}\n\\end{aligned}\n$$\n\u7136\u540e\u6211\u4eec\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\u628a $(e^x-e^{-x})^i$ \u5c55\u5f00\u3002\n$$\n\\begin{aligned}\ng_i&=\\binom{D}{i}\\frac{n!}{2^i}[x^n]\\sum\\limits_{j=0}^i\\binom{i}{j}(e^x)^j(-e^x)^{i-j}(e^x)^{D-i}\\\\\n&=\\binom{D}{i}\\frac{n!}{2^i}[x^n]\\sum\\limits_{j=0}^i\\binom{i}{j}(-1) ^{i-j}(e^x)^j(e^{-x})^{i-j}(e^x)^{D-i}\\\\\n&=\\binom{D}{i}\\frac{n!}{2^i}[x^n]\\sum\\limits_{j=0}^i\\binom{i}{j}(-1) ^{i-j}(e^x)^j(e^x)^{j-i}(e^x)^{D-i}\\\\\n&=\\binom{D}{i}\\frac{n!}{2^i}[x^n]\\sum\\limits_{j=0}^i\\binom{i}{j}(-1) ^{i-j}(e^x)^{D-2(i-j)}\n\\end{aligned}\n$$\n\u7136\u540e\u6211\u4eec\u628a $(e^x)^{D-2(i-j)}$\uff08\u5b83\u7684\u7cfb\u6570\u4e3a $\\frac{(D-2(i-j))^n}{n!}$\uff09\u4e0e\u7ec4\u5408\u6570\u5c55\u5f00\n$$\n\\begin{aligned}\ng_i&=\\frac{D!}{i!(D-i)!}\\frac{n!}{2^i}\\sum\\limits_{j=0}^i\\frac{i!}{j!(i-j)!}(-1) ^{i-j}\\frac{(D-2(i-j))^n}{n!}\\\\\n&=\\frac{D!}{(D-i)!}\\frac{1}{2^i}\\sum\\limits_{j=0}^i\\frac{1}{j!(i-j)!}(-1) ^{i-j}(D-2(i-j))^n\\\\\n&=\\frac{D!}{(D-i)!}\\frac{1}{2^i}\\sum\\limits_{j=0}^i\\frac{1}{j!(i-j)!}(-1)^{j}(D-2j)^n\\\\\n\\end{aligned}\n$$\n\u6ce8\u610f\u6700\u540e\u4e00\u884c\u7528 $i-j$ \u66ff\u6362\u4e86 $j$\u3002\u6c42\u548c\u53f7\u5185\u90e8\u7684\u4e1c\u897f\u663e\u7136\u662f\u5377\u79ef\u5f62\u5f0f\uff0cNTT \u8ba1\u7b97\u5373\u53ef\u3002\n\n\u7136\u540e\u6211\u4eec\u9700\u8981\u53cd\u6f14\u56de\u53bb\uff0c\u4f46\u662f\u4e0d\u80fd\u76f4\u63a5\u4e24\u91cd `for`\uff0c\u590d\u6742\u5ea6\u7206\u70b8\uff0c\u6ce8\u610f\u5230\u4e8c\u9879\u5f0f\u53cd\u6f14\u7684\u5f0f\u5b50\n$$\n\\begin{aligned}\nf_i&=\\sum\\limits_{j=i}^d\\binom{j}{i}(-1)^{j-i}g_j\\\\\n&=\\frac{1}{i!}\\sum\\limits_{j=i}^d\\frac{j!}{(j-i)!}(-1)^{j-i}g_j\\\\\n\\end{aligned}\n$$\n\u6ce8\u610f\u5230\u6c42\u548c\u53f7\u540e\u9762\u662f\u5dee\u4e00\u5b9a\u7684\u5f62\u5f0f\uff0c\u628a $j!g_j$ \u7684\u591a\u9879\u5f0f\u7cfb\u6570\u53cd\u8f6c\u5c31\u53ef\u4ee5\u5377\u79ef\u4e86\u3002\n\n\u7b54\u6848\u4e3a $\\sum\\limits_{i=0}^{n-2m}f_i$\u3002\u6ce8\u610f\u4f60\u5dee\u4e00\u5b9a\u7684\u591a\u9879\u5f0f\u5377\u5b8c\u4e86\u4ee5\u540e\u7cfb\u6570\u4e5f\u662f\u53cd\u7684\uff0c\u6700\u540e\u5e94\u8be5\u53d6\u7684\u662f\u591a\u9879\u5f0f\u7684 $x^{d-n+2m}$ \u5230 $x^d$ \u9879\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff08\u4e24\u6b21 NTT \u4e4b\u95f4\u8bb0\u5f97\u6e05\u7a7a\uff09\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint const p=998244353,g=3,gi=(p+1)/3;\nint r[400005],F[400005],G[400005],fac[400005],inv[400005];\nint pw(int x,int y)\n{\n    int res=1;\n    while(y)\n    {\n        if(y&1)res=1ll*res*x%p;\n        x=1ll*x*x%p;\n        y>>=1;\n    }\n    return res;\n}\nvoid ntt(int *f,int n,int op)\n{\n    for(int i=1;i<n;i++)r[i]=(r[i>>1]>>1)+((i&1)?(n>>1):0);\n    for(int i=1;i<n;i++)if(i<r[i])swap(f[i],f[r[i]]);\n    for(int len=2;len<=n;len<<=1)\n    {\n        int q=len>>1,wn=pw(op==1?g:gi,(p-1)/len);\n        for(int i=0;i<n;i+=len)\n            for(int j=i,w=1;j<i+q;j++,w=1ll*w*wn%p)\n            {\n                int d=1ll*f[j+q]*w%p;\n                f[j+q]=(f[j]-d+p)%p;\n                f[j]+=d,f[j]%=p;\n            }\n    }\n    if(op==-1)\n    {\n        int t=pw(n,p-2);\n        for(int i=0;i<n;i++)f[i]=1ll*f[i]*t%p;\n    }\n}\nint main()\n{\n    int d,n,m;\n    scanf(\"%d%d%d\",&d,&n,&m);\n    if(n-2*m<0){puts(\"0\");return 0;}\n    if(n-2*m>=d){printf(\"%d\",pw(d,n));return 0;}\n    fac[0]=inv[0]=1;\n    for(int i=1;i<=d;i++)fac[i]=1ll*fac[i-1]*i%p,inv[i]=1ll*inv[i-1]*pw(i,p-2)%p;\n    for(int i=0;i<=d;i++)F[i]=inv[i],G[i]=1ll*((i&1)?p-1:1)*inv[i]%p*pw((d-2*i+p)%p,n)%p;\n    int lim=1;\n    while(lim<=(d<<1))lim<<=1;\n    ntt(F,lim,1),ntt(G,lim,1);\n    for(int i=0;i<lim;i++)G[i]=1ll*F[i]*G[i]%p;\n    ntt(G,lim,-1);\n    for(int i=0;i<=d;i++)G[i]=1ll*G[i]*fac[d]%p*inv[d-i]%p*pw(2,p-1-i)%p*fac[i]%p;\n    reverse(G,G+d+1);\n    for(int i=d+1;i<=lim;i++)F[i]=G[i]=0;\n    for(int i=0;i<=d;i++)F[i]=1ll*inv[i]*((i&1)?p-1:1)%p;\n    ntt(F,lim,1),ntt(G,lim,1);\n    for(int i=0;i<lim;i++)G[i]=1ll*F[i]*G[i]%p;\n    ntt(G,lim,-1);\n    int ans=0;\n    for(int i=d+2*m-n;i<=d;i++)ans+=1ll*G[i]*inv[d-i]%p,ans%=p;\n    printf(\"%d\",ans);\n    return 0;\n}\n```\n",
        "postTime": 1595897189,
        "uid": 96912,
        "name": "AzusaCat",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5401 \u3010[CTS2019]\u73cd\u73e0\u3011"
    },
    {
        "content": "\u6211\u6765\u8865\u4e00\u4e0b\u795e\u9c7c\u524d\u9762\u7701\u7565\u7684\u4e00\u70b9\u7ec6\u8282~~\u5176\u5b9e\u662f\u6211\u63a8\u5230\u90a3\u91cc\u4e0d\u4f1a\u505a\u4e86~~\n\n\u7b80\u5355\u63a8\u7406\u4e00\u4e0b\uff0c\u8bbe\u6709 $A$ \u4e2a\u989c\u8272\u51fa\u73b0\u4e86\u5947\u6570\u6b21\uff0c\u90a3\u4e48\u5e94\u8be5\u6ee1\u8db3 $n-A\\geq 2m$\uff0c\u5373\u8fd9 $A$ \u4e2a\u662f\u6ca1\u6709\u8d21\u732e\u7684\uff0c\u5269\u4e0b\u7684\u6bcf\u4e00\u5bf9\u8d21\u732e\u4e00\u6b21. \u4e8e\u662f\u9700\u8981\u5bf9 $0\\leq A\\leq n-2m$ \u6c42\u548c. \n\n\u7136\u540e\u8003\u8651\u6bcf\u79cd\u989c\u8272\u7684\u751f\u6210\u51fd\u6570\uff0c\u56e0\u4e3a\u5e26\u6807\u53f7\u6240\u4ee5\u7528 $EGF$. \u7136\u800c\u53d1\u73b0\u4e00\u5143\u7684\u751f\u6210\u51fd\u6570\u4e0d\u8db3\u4ee5\u8868\u8fbe\u5168\u90e8\u4fe1\u606f\uff0c\u4e8e\u662f\u6dfb\u52a0\u4e00\u4e2a\u5143 $y$ \u6765\u8868\u793a\u662f\u5426\u51fa\u73b0\u4e86\u5947\u6570\u6b21. \u90a3\u4e48\u4e00\u4e2a\u989c\u8272\u7684\u751f\u6210\u51fd\u6570\u5c31\u662f\n\n$$\n\\sum_{i\\geq 0}\\frac{x^iy^{i\\bmod 2}}{i!}\n$$\n\n\u663e\u7136\u53ef\u4ee5\u6309\u7167 $i$ \u7684\u5947\u5076\u6027\u5206\u5f00\uff0c\u53d8\u6210\n\n$$\n\\begin{aligned}&\\sum_{i\\geq 0}\\frac{x^iy}{i!}[i\\bmod 2=1]+\\sum_{i\\geq 0}\\frac{x^i}{i!}[i\\bmod 2=0]\\\\=&y\\sum_{i\\geq 0}\\frac{x^i}{i!}\\frac{1^i-(-1)^i}{2}+\\sum_{i\\geq 0}\\frac{x^i}{i!}\\frac{1^i+(-1)^i}{2}\\\\=&y\\frac{e^x-e^{-x}}{2}+\\frac{e^x+e^{-x}}{2}\\end{aligned}\n$$\n\n\u4e00\u5171\u6709 $D$ \u79cd\u989c\u8272\uff0c\u4e8e\u662f\u7b54\u6848\u5c31\u662f \n\n$$\n\\sum_{i=0}^{n-2m}[x^ny^i]\\left(y\\frac{e^x-e^{-x}}{2}+\\frac{e^x+e^{-x}}{2}\\right)^D\n$$\n\n\u5927\u529b\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\u5c55\u5f00\u5c31\u5f97\u5230\n\n$$\n[x^n]\\sum_{i=0}^{\\min(D,n-2m)}\\binom{D}{i}\\left(\\frac{e^x-e^{-x}}{2}\\right)^i\\left(\\frac{e^x+e^{-x}}{2}\\right)^{D-i}\n$$\n\n\u8fd9\u5c31\u662f\u795e\u9c7c\u90a3\u4e2a\u5f0f\u5b50\u4e86\uff0c\u5269\u4e0b\u7684\u53bb\u770b\u795e\u9c7c\u7684\u9898\u89e3\u597d\u4e86(",
        "postTime": 1591331626,
        "uid": 22136,
        "name": "qwaszx",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5401 \u3010[CTS2019]\u73cd\u73e0\u3011"
    },
    {
        "content": "update\uff1a\u4fee\u4e86\u4e00\u70b9\u5c0f\u9519\u8bef\uff0c\u628a $\\LaTeX$ \u6539\u5f97\u597d\u770b\u4e86\u4e00\u70b9\n\n---\n\n\u8bbe $cnt_i$ \u4e3a\u6570\u503c\u4e3a $i$ \u7684\u53d8\u91cf\u7684\u4e2a\u6570\uff0c\u5219 $\\sum\\limits_{i=1}^d=n$\n\n\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u65b9\u6848\u5408\u6cd5\uff0c\u5f53\u4e14\u4ec5\u5f53 $\\sum\\limits_{i=1}^d\\lfloor\\dfrac{cnt_i}2\\rfloor\\ge m$\uff0c\u6c42\u5408\u6cd5\u7684\u65b9\u6848\u6570\n\n\u6211\u4eec\u5bf9\u4e0a\u9762\u7684\u5f0f\u5b50\u53d8\u5f62\uff1a\n\n$$\\begin{aligned}\n\\sum\\limits_{i=1}^d\\dfrac{cnt_i-cnt_i\\bmod 2}2&\\ge m\\\\\n\n\\sum\\limits_{i=1}^d cnt_i-cnt_i\\bmod 2&\\ge 2m\n\\end{aligned}$$\n\n\u7531\u4e8e $\\sum\\limits_{i=1}^dcnt_i=n$\n\n$$\\begin{aligned}\nn-\\sum\\limits_{i=1}^d cnt_i\\bmod 2&\\ge 2m\\\\\n\n\\sum\\limits_{i=1}^dcnt_i\\bmod 2&\\le n - 2m\n\\end{aligned}$$\n\n\u90a3\u4e48\u53ef\u4ee5\u770b\u51fa\uff0c\u5f53 $n-2m\\ge d$ \u65f6\u4e0a\u5f0f\u6052\u6210\u7acb\uff0c\u7b54\u6848\u4e3a $d^n$\uff1b\u5f53 $n-2m<0$ \u65f6\uff0c\u4e0a\u5f0f\u6052\u4e0d\u6210\u7acb\uff0c\u7b54\u6848\u4e3a $0$\n\n\u7279\u5224\u6389\u8fd9\u4e24\u79cd\u60c5\u51b5\n\n---\n\n\u6211\u4eec\u5c06\u4e0a\u9762\u90a3\u4e2a\u5f0f\u5b50\u7ffb\u8bd1\u4e00\u4e0b\uff0c\u4e2a\u6570\u4e3a\u5947\u6570\u7684\u6570\u503c\u4e0d\u8d85\u8fc7 $n-2m$ \u4e2a\n\n\u8bbe\u6070\u597d\u6709 $i$ \u4e2a $cnt$ \u4e3a\u5947\u6570\u7684\u65b9\u6848\u6570\u4e3a $H_i$\n\n\u5219 $ans=\\sum\\limits_{i=0}^{n-2m}H_i$\n\n$H_i$ \u4e0d\u597d\u6c42\uff0c\u6211\u4eec\u5bb9\u65a5\u4e00\u4e0b\uff0c\u8bbe $F_i$ \u8868\u793a\u81f3\u5c11\u6709 $i$ \u4e2a $cnt$ \u4e3a\u5947\u6570\u7684\u65b9\u6848\u6570\uff0c\u5219 $F_i=\\sum\\limits_{j=i}^d\\dbinom jiH_j$\n\n\u4e8c\u9879\u5f0f\u53cd\u6f14\u4e00\u4e0b\uff1a\n\n$$\\begin{aligned}\nH_i&=\\sum\\limits_{j=i}^d(-1)^{j-i}\\binom ji F_j\\\\\n\n&=\\sum\\limits_{j=i}^d(-1)^{j-i}\\dfrac{j!}{i!(i-j)!} F_j\\\\\n\n&=\\sum\\limits_{j=i}^d\\dfrac{(-1)^{j-i}}{(-(i-j))!}\\cdot j!F_j\n\\end{aligned}$$\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u662f\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u53ef\u662f\u5377\u79ef\u7684\u4e24\u4e2a\u591a\u9879\u5f0f\u4e2d\u6709\u4e2a\u5947\u602a\u7684\u4e1c\u897f\uff1a\u8d1f\u6570\u7684\u9636\u4e58\uff0c\u800c\u4e14 $j$ \u5e76\u4e0d\u662f\u4ece $0$ \u679a\u4e3e\u5230 $i$\n\n\u6211\u4eec\u60f3\u529e\u6cd5\u89c4\u907f\u6389\u4ed6\uff0c\u5c06 $H$ \u53f3\u79fb $d$ \u4f4d\uff0c\u5373\u8bbe $H'_{i+d}=\\sum\\limits_{j=i}^d\\dfrac{(-1)^{j-i}}{(-(i-j))!}\\cdot j!F_j$\n\n\u8fd9\u4f9d\u7136\u662f\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u8fd9\u6b21\u4ed6\u662f\u7531 $A=\\sum\\limits_{i=0}^d\\dfrac{(-1)^{d-i}}{(d-i)!}x^i$ \u548c $B=\\sum\\limits_{i=0}^di!\\cdot F_ix^i$ \u5377\u79ef\u5f97\u5230\u7684\n\n$H'_{i+d}=\\sum\\limits_{j=0}^{i+d}A_{d+i-j}\\cdot B_j$\n\n\u5c06 $A$ \u548c $B$ \u4ee3\u5165\u53d1\u73b0\u548c\u8981\u6c42\u7684\u5f0f\u5b50\u53ea\u5dee\u4e86 $j$ \u7684\u8303\u56f4\uff0c\u5f53 $j<i$ \u65f6\uff0c$d+i-j>d$\uff0c$A_{d+i-j}=0$\uff1b\u5f53 $j>d$ \u65f6\uff0c$B_j=0$\uff0c\u6240\u4ee5\u8303\u56f4\u7684\u95ee\u9898\u4e5f\u88ab\u6211\u4eec\u89e3\u51b3\u4e86\n\n---\n\n\u95ee\u9898\u8f6c\u5316\u4e3a\u6c42 $F$\n\n\u7531\u4e8e\u662f\u6c42\u6392\u5217\u7684\u65b9\u6848\u6570\uff0c\u6240\u4ee5\u662f $EGF$ \u5377\u8d77\u6765\n\n$$F_i=\\dbinom dk n![x^n]\\left( \\dfrac{e^x-e^{-x}}2\\right)^i(e^x)^{d-i}$$\n\n\u8868\u793a\u94a6\u5b9a $i$ \u4e2a\u6570\u503c\u7684\u4e2a\u6570\u4e3a\u5947\u6570\uff0c\u5269\u4e0b\u7684\u968f\u610f\n\n\u4e8c\u9879\u5f0f\u66b4\u529b\u5c55\u5f00\uff1a\n\n$$\\begin{aligned}\n\nF_i&=\\dbinom dk \\dfrac{n!}{2^i}[x^n]\\sum\\limits_{j=0}^i\\dbinom ije^{jx}(-e)^{-(i-j)x}e^{(d-i)x}\\\\\n\n&=\\dbinom dk \\dfrac{n!}{2^i}\\sum\\limits_{j=0}^i\\dbinom ij (-1)^{i-j}[x^n]e^{(d-2i+2j)x}\n\\end{aligned}$$\n\n\u7531\u4e8e $[x^n]e^{ax}=\\dfrac{a^n}{n!}$\n\n$$\\begin{aligned}\nF_i&=\\dbinom dk \\dfrac{n!}{2^i}\\sum\\limits_{j=0}^i\\dbinom ij (-1)^{i-j}\\dfrac{(d-2i+2j)^n}{n!}\\\\\n\n&=\\dfrac{d!}{2^i\\cdot (d-i)!}\\sum\\limits_{j=0}^i\\dfrac{1}{j!}\\cdot \\dfrac{(-1)^{i-j}(d-2(i-j))^n}{(i-j)!}\n\\end{aligned}$$\n\n\u662f\u4e2a\u518d\u6b63\u5e38\u4e0d\u8fc7\u7684\u5377\u79ef\u5f62\u5f0f\uff0c\u505a\u5b8c\u5566\n\n```cpp\nconst int N = 400010,G = 3,Gi = 332748118,inv2 = qpow(2,mod - 2);\nint rev[N];\nvoid NTT(ll *a,int n,int type)\n{\n\tfor(int i = 0;i < n;i++) if(i < rev[i]) swap(a[i],a[rev[i]]);\n\tfor(int l = 2;l <= n;l <<= 1)\n\t{\n\t\tint m = l >> 1;\n\t\tll wn = qpow(~type ? G : Gi,(mod - 1) / l);\n\t\tfor(ll *p = a;p != a + n;p += l)\n\t\t{\n\t\t\tll w = 1;\n\t\t\tfor(int i = 0;i < m;i++,w = w * wn % mod)\n\t\t\t{\n\t\t\t\tll t = w * p[i + m] % mod;\n\t\t\t\tp[i + m] = Mod(p[i] - t + mod);\n\t\t\t\tp[i] = Mod(p[i] + t);\n\t\t\t}\n\t\t}\n\t}if(~type) return;\n\tll inv = qpow(n,mod - 2);\n\tfor(int i = 0;i < n;i++) a[i] = a[i] * inv % mod;\n}\nvoid calc_rev(int &n,int &lim,int m)\n{\n\tn = 1,lim = 0;while(n < m) n <<= 1,lim++;\n\tfor(int i = 1;i < n;i++) rev[i] = (rev[i >> 1] >> 1) | ((i & 1) << lim - 1);\n}\nvoid Mul(ll *a,ll *b,ll *c,int m1,int m2)\n{\n\tstatic ll x[N],y[N];\n\tint n,lim;calc_rev(n,lim,m1 + m2);\n\tfor(int i = 0;i < m1;i++) x[i] = a[i];for(int i = m1;i < n;i++) x[i] = 0;\n\tfor(int i = 0;i < m2;i++) y[i] = b[i];for(int i = m2;i < n;i++) y[i] = 0;\n\tNTT(x,n,1),NTT(y,n,1);\n\tfor(int i = 0;i < n;i++) c[i] = x[i] * y[i] % mod;\n\tNTT(c,n,-1);for(int i = m1 + m2 - 1;i < n;i++) c[i] = 0;\n}\nll fac[N],ifac[N],t[N],_1[N];\nll A[N],B[N],F[N],H[N],ans;\nint d,n,m;\nvoid init(int n)\n{\n\tfac[0] = 1;for(int i = 1;i <= n;i++) fac[i] = fac[i - 1] * i % mod;\n\tifac[n] = qpow(fac[n],mod - 2);for(int i = n;i;i--) ifac[i - 1] = ifac[i] * i % mod;\n\tt[0] = 1,_1[0] = 1;\n\tfor(int i = 1;i <= n;i++) t[i] = Mod(t[i - 1] + t[i - 1]),_1[i] = mod - _1[i - 1];\n}\nint main()\n{\n\td = read(),n = read(),m = read();\n\tif(2 * m <= n - d) { fprint(qpow(d,n));return 0; }\n\tif(2 * m > n) { puts(\"0\");return 0; }\n\tinit(d);\n\tfor(int i = 0;i <= d;i++)\n\t\tA[i] = qpow((d - 2 * i + mod) % mod,n) * _1[i] % mod * ifac[i] % mod;\n\tfor(int i = 0;i <= d;i++) B[i] = ifac[i];\n\tMul(A,B,F,d + 1,d + 1);\n\tfor(int i = 0;i <= d;i++)\n\t\tF[i] = F[i] * fac[d] % mod * qpow(inv2,i) % mod * ifac[d - i] % mod * fac[i] % mod;\n\tfor(int i = 0;i <= d;i++)\n\t\tA[d - i] = _1[i] * ifac[i] % mod;\n\tMul(A,F,H,d + 1,d + 1);\n\tfor(int i = 0;i <= n - 2 * m;i++) ans = (ans + H[d + i] * ifac[i]) % mod;\n\tfprint(ans);\n}\n```\n",
        "postTime": 1593942344,
        "uid": 53994,
        "name": "81179332_",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5401 \u3010[CTS2019]\u73cd\u73e0\u3011"
    },
    {
        "content": "\u5982\u679c\u516c\u5f0f\u6302\u4e86\uff0c\u5efa\u8bae\u5728 luogu \u535a\u5ba2\u6216\u8005 [\u8fd9\u91cc](https://www.yijan.co/cts2019-zhen-zhu/) \u67e5\u770b\u3002\n\n\u9898\u610f\uff1a\u5bf9\u4e8e\u4efb\u610f $n$ \u4e2a $[1,D]$ \u7684\u6570\uff0c\u6c42\u5176\u4e2d\u80fd\u627e\u51fa $m$ \u5bf9\u76f8\u540c\u7684\u6570\u7684\u65b9\u6848\u6570\u91cf\u3002\n\n\u9996\u5148\uff0c\u7279\u5224\u6389 $2m \\le n - D$ , $2m > n$ \u7684\u60c5\u51b5\uff0c\u660e\u663e\u7b54\u6848\u5206\u522b\u662f $D^n,0$\u3002\n\n\u7a0d\u5fae\u63a8\u4e0b\u5f0f\u5b50\uff0c\u4e0d\u96be\u53d1\u73b0\u9898\u8bbe\u6761\u4ef6\u5373\u4e3a\u51fa\u73b0\u6b21\u6570\u4e3a\u5947\u6570\u7684\u6570\u4e2a\u6570\u4e0d\u8d85\u8fc7 $n-2m$ \u7684\u65b9\u6848\u6570\u91cf\u3002\n\n\u6211\u4eec\u5047\u8bbe\u94a6\u5b9a $i$ \u4e2a\u6570\u5b57\u51fa\u73b0\u6b21\u6570\u662f\u5947\u6570\u7684\u65b9\u6848\u6570\u91cf\u662f $g_i$ \uff0c\u6070\u597d\u6709 $i$ \u4e2a\u6570\u88ab\u51fa\u73b0\u6b21\u6570\u4e3a\u5947\u6570\u7684\u65b9\u6848\u6570\u91cf\u662f $f_i$ \uff0c\u90a3\u4e48\u7531\u4e8c\u9879\u5f0f\u53cd\u6f14\u6211\u4eec\u6709\n$$\ng_i = \\sum_{j \\le i} f_i\\binom i j \\Rightarrow f_i = \\sum_{j \\ge i} (-1)^{j-i} \\binom{j}{i} g_j\n$$\n\u8fd9\u660e\u663e\u662f\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u4e8e\u662f\u6211\u4eec\u6700\u540e\u7684\u7b54\u6848\u5c31\u662f\n$$\n\\sum_{i=0}^{n-2m} f_i\n$$\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u53ea\u9700\u8981\u7b97\u51fa $g$ \u505a\u4e2a\u5dee\u5377\u79ef\u5373\u53ef\u7b97\u51fa $f$ \uff0c\u4ece\u800c\u7b97\u51fa\u7b54\u6848\u3002\n\n\u5982\u4f55\u6c42\u51fa $g$ \uff1f\n\n\u7531\u4e8e\u9700\u8981\u7ed9\u6570\u5b57\u505a\u6392\u5217\uff0c\u9700\u8981\u7b97 EGF \uff0c\u800c\u5076\u6570\u7684 EGF \u662f\n$$\n\\frac{e^x-e^{-x}}{2}\n$$\n\u6211\u4eec\u8003\u8651\u5982\u4f55\u6c42 $g_i$ \uff0c\u9700\u8981\u94a6\u5b9a $i$ \u4e2a\u6570\u662f\u5947\u6570\uff0c\u5199\u6210\u5f0f\u5b50\u5c31\u662f\n$$\n(\\frac{e^x-e^{-x}}{2})^i\n$$\n\u5269\u4e0b\u7684\u6570\u51fa\u73b0\u6b21\u6570\u4efb\u610f\uff0c\u4e5f\u5c31\u662f $e^{(D-i)x}$\uff0c\u6240\u4ee5\u53ef\u4ee5\u5199\u51fa $g$ \u7684\u5f0f\u5b50\n$$\n\\begin{aligned}g_i &= [x^n] n! \\binom n i (\\frac{e^x-e^{-x}}{2})^ie^{(D-i)x}\\\\&= [x^n] \\frac{n!}{2^i} \\binom n i (e^x-e^{-x}) e^{(D-i)x}\\\\&= [x^n] \\frac{n!}{2^i} \\binom n i \\sum_{j=0}^i \\binom i j e^{2xj-2ix+Dx} (-1)^{i-j}\\\\&= \\frac{n!}{2^i} \\binom D i \\sum_{j=0}^i \\binom i j \\frac{(2j-2i+D)^n}{n!} (-1)^{i-j}\\\\\\end{aligned}\n$$\n\u4e3a\u4e86\u597d\u770b\u53ef\u4ee5\u6539\u6210\u679a\u4e3e $i-j$ \uff0c\u4e8e\u662f\u5c31\u662f\n$$\ng_i = \\frac{n!}{2^i} \\binom D i \\sum_{j=0}^i\\binom i j \\frac{(D-2j)^n}{n!} (-1)^j\n$$\n\u76f4\u63a5\u5377\u79ef\u5373\u53ef\u3002\n\n```cpp\n#include \"iostream\"\n#include \"algorithm\"\n#include \"cstring\"\n#include \"cstdio\"\n#include \"cmath\"\n#include \"vector\"\n#include \"map\"\n#include \"set\"\n#include \"queue\"\nusing namespace std;\n#define MAXN 1000006\n//#define int long long\n#define rep(i, a, b) for (int i = (a), i##end = (b); i <= i##end; ++i)\n#define per(i, a, b) for (int i = (a), i##end = (b); i >= i##end; --i)\n#define pii pair<int,int>\n#define fi first\n#define se second\n#define mp make_pair\n#define pb push_back\n#define eb emplace_back\n#define vi vector<int>\n#define all(x) (x).begin() , (x).end()\n#define mem( a ) memset( a , 0 , sizeof a )\ntypedef long long ll;\n#define P 998244353\n#define lg2( x ) ( 31 - __builtin_clz( x ) )\nint n , m; ll q;\n\nint Pow( int x , int a ) {\n    int ans = 1 , cur = x % P;\n    while( a ) {\n        if( a & 1 ) ans = 1ll * ans * cur % P;\n        cur = 1ll * cur * cur % P , a >>= 1;\n    }\n    return ans;\n}\n\nint Wn[2][MAXN] , rev[MAXN];\nvoid getwn( int len ) {\n    for( int mid = 1 ; mid < len ; mid <<= 1 ) {\n        int w0 = Pow( 3 , ( P - 1 ) / ( mid << 1 ) ) , w1 = Pow( 3 , P - 1 - ( P - 1 ) / ( mid << 1 ) );\n        Wn[0][mid] = Wn[1][mid] = 1;\n        for( int i = 1 ; i < mid ; ++ i )\n            Wn[0][mid + i] = 1ll * Wn[0][mid + i - 1] * w0 % P,\n            Wn[1][mid + i] = 1ll * Wn[1][mid + i - 1] * w1 % P;\n    }\n}\nvoid getr( int len ) {\n    int t = __builtin_ctz( len ) - 1;\n    for( int i = 1 ; i < len ; ++ i ) rev[i] = ( rev[i >> 1] >> 1 ) | ( ( i & 1 ) << t );\n}\nvoid NTT( int* A , int len , int typ ) {\n    rep( i , 0 , len - 1 ) if( i < rev[i] ) swap( A[i] , A[rev[i]] );\n    for( int mid = 1 ; mid < len ; mid <<= 1 )\n        for( int i = 0 ; i < len ; i += ( mid << 1 ) )\n            for( int k = 0 ; k < mid ; ++ k ) {\n                int t1 = A[i + k] , t2 = 1ll * A[i + k + mid] * Wn[typ][mid + k] % P;\n                A[i + k] = (t1 + t2) % P , A[i + k + mid] = (t1 + P - t2) % P;\n            }\n    if( typ == 1 ) for( int inv = Pow( len , P - 2 ) , i = 0 ; i < len ; ++ i ) A[i] = 1ll * A[i] * inv % P;\n}\n\nint J[MAXN] , iJ[MAXN];\nint g[MAXN];\nint a[MAXN] , b[MAXN] , iv2;\ninline int pp( const int& x ) {\n\treturn ( x & 1 ) ? P - 1 : 1;\n}\ninline void mul( int *A , int *B , int n , int m , int bc = 0 ) {\n\tint len = 1;\n\twhile( len <= n + m ) len <<= 1;\n\trep( i , n + 1 , len ) A[i] = 0;\n\trep( j , m + 1 , len ) B[j] = 0;\n\tgetr( len ) , getwn( len );\n\tNTT( A , len , 0 ) , NTT( B , len , 0 );\n\trep( i , 0 , len - 1 ) A[i] = A[i] * 1ll * B[i] % P;\n\tNTT( A , len , 1 );\n\tif( !bc ) return;\n\tNTT( B , len , 1 );\n} \nint C( int a , int b ) {\n\treturn J[a] * 1ll * iJ[b] % P * iJ[a - b] % P;\n}\nvoid getg( int n ) {\n\trep( i , 0 , n ) a[i] = pp( i ) * 1ll * iJ[i] % P * ( Pow( n - 2 * i , q ) % P + P ) % P , b[i] = iJ[i];\n\tmul( a , b , n , n );\n\trep( i , 0 , n ) g[i] = a[i] * 1ll * J[i] % P * Pow( iv2 , i ) % P * C( n , i ) % P;\n}\n\nint f1[MAXN] , f2[MAXN] , s1[MAXN] , s2[MAXN];\n\nvoid solve() {\n\tcin >> n >> q >> m; \n\tif( 2 * m <= q - n ) return printf(\"%d\\n\",Pow( n , q ) ) , void();\n\tif( 2 * m > q ) return puts(\"0\") , void();\n\tint t = q - 2 * m;\n\tq %= ( P - 1 );\n\tiv2 = ( P + 1 ) / 2;\n\tJ[0] = 1;\n\tint mx = n;\n\trep( i , 1 , mx ) J[i] = J[i - 1] * 1ll * i % P;\n\tiJ[mx] = Pow( J[mx] , P - 2 );\n\tper( i , mx - 1 , 0 ) iJ[i] = iJ[i + 1] * 1ll * ( i + 1 ) % P;\n\t\n\tgetg( n );\n\trep( i , 0 , n ) a[i] = pp( n - i ) * 1ll * iJ[n - i] % P , b[i] = J[i] * 1ll * g[i] % P;\n\tint len = 1;\n\tmul( a , b , n , n );\n\tint res = 0;\n\trep( i , 0 , n ) if( i <= t ) f1[i] = a[i + n] * 1ll * iJ[i] % P , res = ( res + f1[i] ) % P;\n\tcout << res << endl;\n}\n\nsigned main() {\n//    int T;cin >> T;while( T-- ) solve();\n    solve();\n}\n```\n\n",
        "postTime": 1588167251,
        "uid": 63398,
        "name": "yijan",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P5401 \u3010[CTS2019]\u73cd\u73e0\u3011"
    },
    {
        "content": "\u81ea\u95ed\u4e86\uff0c\u8fd9\u79cd\u9898\u7b2c\u4e00\u6b65\u6f0f\u4e86\u4e00\u4e2a\u7ec4\u5408\u6570\u771f\u7684\u4e0d\u662f\u5f00\u73a9\u7b11\u7684...~~\u5f3a\u5236\u770b\u9898\u89e3\uff0c\u53ef\u6076~~\n\n\u7b2c\u4e00\u6b65\u8f6c\u5316\u9898\u610f\uff0c\u95ee\u9898\u7b49\u4ef7\u4e8e\u6c42\u4e0b\u5217\u5e8f\u5217\u7684\u6784\u9020\u65b9\u6848\u6570\n\n$$f(x)=\\sum_{i=1}^D[\\text{cnt}_i\\bmod2=1]=x$$\n\n\u7b54\u6848\u663e\u7136\u662f\n\n$$\\sum_{i=0}^{n-2m} f(i)$$\n\n\u63a5\u4e0b\u6765\u53ef\u4ee5\u76f4\u63a5\u505a\uff0c\u63a8\u5230\u540e\u9762\u53d1\u73b0\u662f\u4e24\u4e2a$\\text{EGF}$\u7684\u5377\u79ef\uff0c\u73a9\u4e0d\u8d77...~~\uff08\u542c\u8bf4\u53ef\u4ee5\u505a\uff0c\u5495\u5495\u5495\uff09~~\n\n\u8003\u8651\u628a\u4e24\u4e2a\u751f\u6210\u51fd\u6570\u53d8\u6210\u4e00\u4e2a\u3002\u5148\u4e8c\u9879\u5f0f\u53cd\u6f14\u4e00\u4e0b\uff0c\u8bbe$g_i$\u8868\u793a\u94a6\u5b9a$i$\u79cd\u989c\u8272\u4e2a\u6570$\\bmod\\ 2 = 1$\uff0c\u5176\u4ed6\u989c\u8272\u4e71\u67d3\u7684\u65b9\u6848\u6570\u3002\n\n\u663e\u7136$f_i$\u53ef\u4ee5\u7531$g_i$\u4e00\u4e2a NTT \u5e26\u8d70\u3002\u6211\u4eec\u76f4\u63a5\u770b$g_i$\uff1a\n\n\u5148\u5217\u5f0f\u5b50\uff0c\u6211\u4eec\u679a\u4e3e\u6bcf\u79cd\u94a6\u5b9a\u7684\u989c\u8272\u6709\u591a\u5c11\u4e2a\uff1a\n\n$$g_i=C_D^i\\sum_{j_1\\bmod 2=1}...\\sum_{j_i\\bmod 2=1}C_{n}^{\\sum j}(D-i)^{n-\\sum j}\\frac{(\\sum j)!}{\\prod j_i!}$$\n\n\u5206\u6790\u4e00\u4e0b\uff0c\u8fd9\u4e00\u5806$\\sum$\u5f88\u91cd\u590d\uff0c\u5982\u679c\u771f\u7684\u679a\u4e3e\u4f1a\u51fa\u4e8b\u60c5\uff08\u4e0d\u5982\u7206\u641c\uff09\u3002\u731c\u90fd\u53ef\u4ee5\u731c\u5f97\u5230\u8981\u5408\u5e76\u3002\n\n\u8fd9\u4e2a$\\sum j$\u4e5f\u5f88\u70e6\uff0c\u679a\u4e3e\u6389\u3002\n\n$$g_i=C_D^i\\sum_{j=0}^{\\infty}\\sum_{j_1\\bmod 2=1}\\frac {1}{j_1!}...\\sum_{j_i\\bmod 2=1}\\frac {1}{j_i!}C_{n}^{j}(D-i)^{n-j}j![\\sum j_i=j]$$\n\n$$g_i=C_D^i\\sum_{j=0}^{\\infty}C_{n}^{j}(D-i)^{n-j}j!\\sum_{j_1\\bmod 2=1}\\frac {1}{j_1!}...\\sum_{j_i\\bmod 2=1}\\frac {1}{j_i!}[\\sum j_i=j]$$\n\n\u540e\u9762\u5168\u90fd\u662f\u957f\u5f97\u4e00\u6837\u7684$\\text{EGF}$\u3002\u800c\u6211\u4eec\u53ef\u4ee5\u5bb9\u65a5\u4e00\u4e0b\uff0c\u53d1\u73b0\u8fd9\u4e2a$\\text{EGF}$\u662f$\\frac {e^x-e^{-x}}{2}$\n\n$$g_i=C_D^i\\sum_{j=0}^{\\infty}C_{n}^{j}(D-i)^{n-j}j!(\\frac {e^x-e^{-x}}{2})^i[x^j]$$\n\n\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u591a\u9879\u5f0f\u505a\u6cd5\uff1a\u5148\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u51fa\u540e\u9762\u7684\u751f\u6210\u51fd\u6570\uff0c\u518d\u4ee3\u5165\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u62ff\u4e00\u5806\u5206\u4e86\u3002\n\n\u53d1\u73b0\u7b97\u6cd5\u74f6\u9888\u5728\u4e8e\u751f\u6210\u51fd\u6570\uff0c\u4e14\u8fd9\u4e2a\u751f\u6210\u51fd\u6570\u4e0d\u65b9\u4fbf\u6c42\u503c\u3002\u4e00\u822c\u8fd9\u79cd\u9898\u90fd\u662f\u8f6c\u5316\uff0c\u518d\u8f6c\u5316\uff0c\u6700\u540e\u5316\u5230\u53ef\u4ee5\u4e00\u6b65\u5230\u4f4d\u5feb\u901f\u7b97\u3002\u800c\u5bf9\u4e8e$e^{cx}$\u6211\u4eec\u53ef\u4ee5\u5f88\u5feb\u7684\u8ba1\u7b97\u7b2c$k$\u9879\uff08$=\\frac {c^k}{k!}$\uff09\u3002\u90a3\u4e48\u4e0b\u4e00\u6b65\u5c31\u51fa\u6765\u4e86\uff1a\n\n\u8003\u8651\u4e8c\u9879\u5f0f\u5c55\u5f00\u3002\n\n$$g_i=2^{-i}C_D^i\\sum_{j=0}^{\\infty}C_{n}^{j}(D-i)^{n-j}j!(e^x-e^{-x})^i[x^j]$$\n\n$$g_i=2^{-i}C_D^i\\sum_{j=0}^{\\infty}C_{n}^{j}(D-i)^{n-j}j!\\sum_{k=0}^iC_i^ke^{x(2k-i)}(-1)^{i-k}[x^j]$$\n\n$$g_i=2^{-i}C_D^i\\sum_{k=0}^iC_i^k(-1)^{i-k}\\sum_{j=0}^{\\infty}C_{n}^{j}(D-i)^{n-j}j!e^{x(2k-i)}[x^j]$$\n\n\u5f97\u5230\u60f3\u8981\u7684\u4e1c\u897f\u4e86\u3002\u591a\u82b1\u4e86\u4e00\u4e2a$\\sum$\u53bb\u6389\u4e86\u5f88\u96be\u641e\u5b9a\u7684$\\text{EGF}$\uff0c\u770b\u770b\u80fd\u4e0d\u80fd\u518d\u5316\u7b80\uff1a\n\n$$g_i=2^{-i}C_D^i\\sum_{k=0}^iC_i^k(-1)^{i-k}\\sum_{j=0}^{\\infty}C_{n}^{j}(D-i)^{n-j}j!\\frac {(2k-i)^j}{j!}$$\n\n$$g_i=2^{-i}C_D^i\\sum_{k=0}^iC_i^k(-1)^{i-k}\\sum_{j=0}^{\\infty}C_{n}^{j}(D-i)^{n-j}(2k-i)^j$$\n\n\u540e\u9762\u53c8\u662f\u4e00\u4e2a\u4e8c\u9879\u5f0f\uff01\u5408\u5e76\u56de\u53bb\n\n$$g_i=2^{-i}C_D^i\\sum_{k=0}^iC_i^k(-1)^{i-k}(D+2k-2i)^n$$\n\n\u5c55\u5f00\u7ec4\u5408\u6570\n\n$$g_i=2^{-i}\\frac{D!}{(D-i)!}\\sum_{k=0}^i\\frac{(D+2k-2i)^n(-1)^{i-k}}{k!(i-k)!}$$\n\n\u8bbe\n\n$$F_i=\\frac {(D-2i)^n(-1)^i}{i!}$$\n\n$$G_i=\\frac{1}{i!}$$\n\n\u5377\u79ef\u5c31\u597d\u4e86\u3002\n\n\u6700\u540e\u6839\u636e\u4e8c\u9879\u5f0f\u53cd\u6f14\u5957\u8def\n\n$$f_i=\\sum_{j=i}^DC_j^i(-1)^{j-i}g_j$$\n\n$$f_ii!=\\sum_{j=i}^Dg_jj!\\frac{(-1)^{j-i}}{(j-i)!}$$\n\n\u8fd8\u662f\u4e00\u4e2a\u5377\u79ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\log_2n)$\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define ljc 998244353\nusing namespace std;\nint r[2010101];\nll w[2010101],pw[2010101],n,inv[1010101],fac[1010101],D,m;\nll ans[2020202],F[2020202],G[2020202],A[2020202];\ninline ll fast_pow(ll a,ll b,ll p){\n    ll t=1;a%=p;a+=p;a%=p;\n    while (b){\n        if (b&1ll) t=t*a%p;\n        b>>=1ll;a=a*a%p;\n    }\n    return t;\n}\ninline void NTT(ll f[],int lim,int id){\n    for (int i=0;i<lim;i++){\n        if (i<r[i]) swap(f[r[i]],f[i]);\n    }\n    w[0]=1;\n    for (int len=1;len<lim;len<<=1){\n    \tll gen=fast_pow(3,(ljc-1)/(len<<1)*id+ljc-1,ljc);\n    \tfor (int i=1;i<len;i++) w[i]=w[i-1]*gen%ljc;\n        for (int i=0;i<lim;i+=len<<1){\n            ll *f1=f+i,*f2=f1+len;\n            for (int j=0;j<len;j++){\n                ll x=f1[j]%ljc,y=f2[j]*w[j]%ljc;\n                f1[j]=(x+y)%ljc;f2[j]=(x-y+ljc)%ljc;\n            }\n        }\n    }\n    if (id==1) return;\n    ll Inv=fast_pow(lim,ljc-2,ljc);\n    for (int i=0;i<lim;i++) f[i]=f[i]*Inv%ljc;\n}\nll _inv[2010101];\nsigned main(){\n\tcin>>D>>n>>m;\n\tif (n-2*m<0){\n\t\tcout<<0<<endl;return 0;\n\t}\n\t_inv[0]=_inv[1]=inv[0]=inv[1]=fac[1]=fac[0]=1;\n\tfor (ll i=2;i<=D+2;i++) fac[i]=fac[i-1]*i%ljc;\n\tfor (ll i=2;i<=D+2;i++) inv[i]=(ljc-(ljc/i)*inv[ljc%i]%ljc)%ljc;\n\tfor (ll i=2;i<=D+2;i++) _inv[i]=_inv[i-1]*inv[i]%ljc;\n\tint lim=1,len=0;\n\twhile (lim<=2*(D+1)) lim<<=1,len++;\n\tfor (int i=0;i<lim;i++) r[i]=(r[i>>1]>>1)|((i&1)<<(len-1));\n\tfor (int i=0;i<=D;i++){\n\t\tF[i]=_inv[i]*(i%2==0?1:ljc-1)%ljc*fast_pow(D-2*i,n,ljc)%ljc;\n\t\tG[i]=_inv[i];\n\t}\n\tNTT(F,lim,1),NTT(G,lim,1);\n\tfor (int i=0;i<lim;i++) G[i]=G[i]*F[i]%ljc;\n\tNTT(G,lim,-1);\n\tfor (int i=0;i<lim;i++){\n\t\tif (i>D) G[i]=0;\n\t\telse G[i]=G[i]*fac[D]%ljc*_inv[D-i]%ljc*fast_pow(2,ljc-1-i,ljc)%ljc*fac[i]%ljc;\n\t}\n\treverse(G,G+D+1);\n\tfor (int i=0;i<lim;i++){\n\t\tif (i>D) F[i]=0;\n\t\telse F[i]=_inv[i]*(i%2==0?1:ljc-1)%ljc;\n\t}\n\tNTT(F,lim,1),NTT(G,lim,1);\n\tfor (int i=0;i<lim;i++) F[i]=F[i]*G[i]%ljc;\n\tNTT(F,lim,-1);\n\tll _=0;\n\tfor (int i=0;i<=min(D,n-2*m);i++){\n\t\t_=(_+F[D-i]*_inv[i]%ljc)%ljc;\n\t}\n\tcout<<_<<endl;\n    return 0;\n}\n\n```\n",
        "postTime": 1583572535,
        "uid": 20309,
        "name": "Fading",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5401 \u3010[CTS2019]\u73cd\u73e0\u3011"
    },
    {
        "content": "[\u5728\u535a\u5ba2\u770b\u6548\u679c\u66f4\u4f73](https://www.cnblogs.com/AThousandMoons/p/10956769.html)\uff08\u8fd9\u91cc\u7684\u6570\u5b66\u516c\u5f0f\u6ca1\u95ee\u9898\uff09\n\npb\u5927\u4f6c\u8bf4\u8fd9\u662fsb\u9898\u611f\u89c9\u597d\u50cf\u6709\u70b9\u8fc7fan\u3002\u3002\u3002\uff08\u6211\u8fd8\u662f\u592a\u5f31\u4e86\uff09\n\n\u9996\u5148\uff0c\u8bbe$i$\u8fd9\u4e2a\u6570\u5728\u5e8f\u5217\u4e2d\u51fa\u73b0$a_i$\u6b21\uff0c\u8981\u6c42$\\sum_{i=1}^D[a_i \\ mod \\ 2]\\leq n-2m$\n\n\u5982\u679c\u8981\u76f4\u63a5\u8ba1\u7b97$\\leq n-2m$\u7684\u6570\u91cf\u4f1a\u975e\u5e38\u9ebb\u70e6\uff0c\u6240\u4ee5\u8003\u8651\u8bbe$g_i$\u8868\u793a**\u6070\u597d**\u51fa\u73b0$i$\u4e2a\u5947\u6570\u7684\u65b9\u6848\u4e4b\u548c\u3002\n\n\u8fd9\u6837\u4e5f\u8fd8\u662f\u592a\u9ebb\u70e6\uff0c\u6211\u4eec\u8003\u8651\u4f7f\u7528\u53cd\u6f14\u6216\u5bb9\u65a5\u901a\u8fc7$\\geq i$\u7684\u6570\u91cf\u63a8\u7b97\u51fa\u6070\u597d\u7b49\u4e8e$i$\u7684\u6570\u91cf\uff0c\u5047\u8bbe$f_i$\u8868\u793a**\u81f3\u5c11**\u51fa\u73b0$i$\u4e2a\u5947\u6570\u7684\u65b9\u6848\u6570\u3002\n\n\u56e0\u4e3a\u8fd9\u662f\u6570\u7684\u6392\u5217\u95ee\u9898\uff0c\u6240\u4ee5\u8003\u8651\u4f7f\u7528\u6307\u6570\u578b\u751f\u6210\u51fd\u6570\u3002\n\n![](http://images.cnblogs.com/cnblogs_com/AThousandMoons/1474538/o_%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20190531182755.png)\n\n\u524d\u9762\u7cfb\u6570\u7684\u90e8\u5206\u53ef\u4ee5\u4e0d\u7528\u7ba1\u5b83\uff0c\u76f4\u63a5\u770b\u540e\u9762\u591a\u9879\u5f0f\u7684\u90e8\u5206\u3002\n\n![](http://images.cnblogs.com/cnblogs_com/AThousandMoons/1474538/o_%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20190531182827.png)\n\n\u53ef\u4ee5\u901a\u8fc7\u5377\u79ef$O(D\\log D)$\u8ba1\u7b97\u3002\n\n\u8ba1\u7b97$g_k$\u53ef\u4ee5\u4f7f\u7528\u4e8c\u9879\u5f0f\u53cd\u6f14\uff0c\u719f\u6089\u4e8c\u9879\u5f0f\u53cd\u6f14\u7684\u540c\u5b66\u53ef\u4ee5\u77e5\u9053\uff0c\u4e8c\u9879\u5f0f\u53cd\u6f14\u5176\u5b9e\u5c31\u662f\u6307\u6570\u578b\u751f\u6210\u51fd\u6570\u7684\u5e94\u7528\u3002\n\n![](http://images.cnblogs.com/cnblogs_com/AThousandMoons/1474538/o_%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20190531183217.png)\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(D\\log D)$.\n```cpp\n#include<bits/stdc++.h>\n#define Rint register int\nusing namespace std;\ntypedef long long LL;\nconst int N = 800003, mod = 998244353, g = 3, gi = 332748118;\ninline int kasumi(int a, int b){\n\tint res = 1;\n\twhile(b){\n\t\tif(b & 1) res = (LL) res * a % mod;\n\t\ta = (LL) a * a % mod;\n\t\tb >>= 1;\n\t}\n\treturn res;\n}\nint fac[N], inv[N], invfac[N], ans;\ninline void init(int n){\n\tfac[0] = 1;\n\tfor(Rint i = 1;i <= n;i ++) fac[i] = (LL) fac[i - 1] * i % mod;\n\tinvfac[n] = kasumi(fac[n], mod - 2);\n\tfor(Rint i = n;i;i --){\n\t\tinvfac[i - 1] = (LL) i * invfac[i] % mod;\n\t\tinv[i] = (LL) invfac[i] * fac[i - 1] % mod;\n\t}\n}\nint rev[N];\ninline int calrev(int n){\n\tint limit = 1, L = -1;\n\twhile(limit <= n){limit <<= 1; L ++;}\n\tfor(Rint i = 0;i < limit;i ++)\n\t\trev[i] = (rev[i >> 1] >> 1) | ((i & 1) << L);\n\treturn limit;\n}\ninline void NTT(int *A, int limit, int type){\n\tfor(Rint i = 0;i < limit;i ++)\n\t\tif(i < rev[i]) swap(A[i], A[rev[i]]);\n\tfor(Rint mid = 1;mid < limit;mid <<= 1){\n\t\tint Wn = kasumi(type == 1 ? g : gi, (mod - 1) / (mid << 1));\n\t\tfor(Rint j = 0;j < limit;j += (mid << 1)){\n\t\t\tint w = 1;\n\t\t\tfor(Rint k = 0;k < mid;k ++, w = (LL) w * Wn % mod){\n\t\t\t\tint x = A[j + k], y = (LL) w * A[j + k + mid] % mod;\n\t\t\t\tA[j + k] = (x + y) % mod;\n\t\t\t\tA[j + k + mid] = (x - y + mod) % mod;\n\t\t\t}\n\t\t}\n\t}\n\tif(type == -1){\n\t\tint inv = kasumi(limit, mod - 2);\n\t\tfor(Rint i = 0;i < limit;i ++) A[i] = (LL) A[i] * inv % mod;\n\t}\n}\nint D, n, m, F[N], G[N];\nint main(){\n\tscanf(\"%d%d%d\", &D, &n, &m);\n\tif(n < 2 * m){\n\t\tprintf(\"0\");\n\t\treturn 0;\n\t}\n\tif(D <= n - 2 * m){\n\t\tprintf(\"%d\", kasumi(D, n));\n\t\treturn 0;\n\t}\n\tinit(D);\n\tfor(Rint i = 0;i <= D;i ++){\n\t\tF[i] = (LL) kasumi((D - 2 * i + mod) % mod, n) * invfac[i] % mod;\n\t\tif(i & 1) F[i] = mod - F[i];\n\t\tG[i] = invfac[i];\n\t}\n\tint limit = calrev(D << 1);\n\tNTT(F, limit, 1); NTT(G, limit, 1);\n\tfor(Rint i = 0;i < limit;i ++) F[i] = (LL) F[i] * G[i] % mod;\n\tNTT(F, limit, -1);\n\tfor(Rint i = 0;i < limit;i ++) G[i] = 0;\n\tfor(Rint i = D + 1;i < limit;i ++) F[i] = 0;\n\tfor(Rint i = 0;i <= D;i ++){\n\t\tF[i] = (LL) F[i] * fac[i] % mod * fac[D] % mod * kasumi(2, mod - 1 - i) % mod * invfac[D - i] % mod;\n\t\tG[D - i] = (i & 1) ? (mod - invfac[i]) : invfac[i];\n\t}\n\tNTT(F, limit, 1); NTT(G, limit, 1);\n\tfor(Rint i = 0;i < limit;i ++) F[i] = (LL) F[i] * G[i] % mod;\n\tNTT(F, limit, -1);\n\tfor(Rint i = 0;i <= n - 2 * m;i ++) ans = (ans + (LL) F[i + D] * invfac[i] % mod) % mod;\n\tprintf(\"%d\", ans);\n}\n```",
        "postTime": 1559297713,
        "uid": 68148,
        "name": "watermoon",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5401 \u3010[CTS2019]\u73cd\u73e0\u3011"
    },
    {
        "content": "[\u6ecb\u78c1\u53bb\u6211\u7684\u535a\u5ba2\u770b\u5416](https://vixbob.moe/16.html)\n\n\n\u8bbe$cnt_i$\u8868\u793a\u7b2c$i$\u79cd\u989c\u8272\u7684\u73e0\u5b50\u7684\u6570\u91cf\uff0c\u90a3\u4e48\u5c31\u53d8\u6210\u4e86\u6c42$\\sum_{i=1}^D[cnt_i \\bmod 2] \\le n-2m$\u7684\u5e8f\u5217\u7684\u4e2a\u6570\u3002\u7136\u540e\u8fd9\u4e2a\u663e\u7136\u53ef\u4ee5$\\text{dp}$\uff0c\u4e0d\u8fc7\u6709\u4e24\u79cd\uff1a\n\n\u7b2c\u4e00\u79cd\uff1a\n\n$f_{i,j,k}$\u8868\u793a\u8003\u8651\u4e86\u524d$i$\u79cd\u73e0\u5b50\u4e00\u5171\u9009\u51fa\u4e86$j$\u4e2a\uff0c\u4e3a\u4e2a\u6570\u4e3a\u5947\u6570\u7684\u73e0\u5b50\u7684\u79cd\u6570\u4e3a$k$\u7684$\\frac{1}{\\prod_{j=1}^icnt_j}$\u7684\u548c\u3002\n\n\u6700\u540e\u7b54\u6848\u76f4\u63a5\u5c31\u662f\uff1a\n$$\nn!\\sum_{i=0}^{n-2m}f_{D,n,i}\n$$\n\u8fd9\u4e2a\u4e1c\u897f\u561b\uff0c\u73e0\u5b50\u663e\u7136\u90fd\u662f\u7b49\u4ef7\u7684\uff0c\u8f6c\u79fb\u53c8\u662f\u4e2a\u5377\u79ef\uff0c\u5e94\u8be5\u662f\u53ef\u4ee5\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u7684\u3002(\u6211\u5f53\u65f6\u662f\u8fd9\u4e48\u60f3\u5f97\uff0c\u4f46\u662f\u5e76\u4e0d\u4f1a\u5904\u7406\u540e\u9762\u7684\u90a3\u4e2a\u5947\u5076)\n\n\u590d\u6742\u5ea6$O(D^3n)$\u3002\n\n\u7b2c\u4e8c\u79cd\uff1a\n\n\u663e\u7136\u72b6\u6001\u4e0d\u9700\u8981\u8fd9\u4e48\u66b4\u529b\uff0c\u8bbe$f_{i,j}$\u8868\u793a\u9009\u4e86$i$\u4e2a\u73e0\u5b50\u6709$j$\u79cd\u73e0\u5b50\u7684\u4e2a\u6570\u4e3a\u5947\u6570\u7684\u65b9\u6848\u6570\u3002\u663e\u7136\u6709\u8f6c\u79fb\uff1a\n$$\n\\begin{cases}f_{i,j} \\times (D-j) \\to f_{i+1,j+1}&j \\le D\\\\f_{i,j} \\times j \\to f_{i+1,j-1}&j>0\\end{cases}\n$$\n\u590d\u6742\u5ea6$O(Dn)$\uff0c\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316\u4e00\u4e0b\u5c31\u662f$O(D^3\\log n)$\u3002\u4f46\u6211\u4e0d\u61c2$\\text{laofu}$\u90a3\u6863$D \\le 300$\u7684\u90e8\u5206\u5206\u662f\u4ec0\u4e48\u610f\u601d\uff0c\u8003\u600e\u4e48\u5361\u5e38\u5417\uff1f\n\n\u7136\u540e\u7b2c\u4e8c\u79cd$\\text{dp}$\u597d\u50cf\u5c31\u6ca1\u4ec0\u4e48\u4f18\u5316\u7a7a\u95f4\u4e86\u3002\u7136\u540e\u6211\u4e5f\u5c31\u4e0d\u4f1a\u4e86\u3002~~\u8f6c\u6218\u9898\u89e3~~\n\n\u5230\u5904\u5b66\u4e60\u4e86\u4e00\u4e0b\u59ff\u52bf\u53d1\u73b0\u7b2c\u4e00\u79cd$\\text{dp}$\u6709\u5f88\u5927\u7684\u4f18\u5316\u7a7a\u95f4\u3002\n\n\u5982\u679c\u628a\u7b2c\u4e00\u79cd$\\text{dp}$\u503c\u641e\u6210\u751f\u6210\u51fd\u6570\uff0c\u90a3\u4e48\u8f6c\u79fb\u663e\u7136\u5c31\u662f\u5377\u4e0a$e^x$\u3002\u4f46\u662f\u540e\u9762\u7684\u5947\u5076\u7684\u4e1c\u897f\u8981\u5bb9\u65a5\u4e00\u4e0b\u3002\n\n\u7136\u540e\u6211\u4eec\u5148\u4e86\u89e3\u4e00\u4e9b\u795e\u5947\u7684$\\text{EGF}$\uff1a\n$$\ne^{-x}=\\sum_{i=0}^{\\infin}(-1)^{i}\\frac{x^i}{i!}\n$$\n\n$$\n\\frac{e^{x}-e^{-x}}{2}=\\sum_{i=0}^{\\infin}\\frac{x^{2i+1}}{(2i+1)!}\n$$\n\n$$\n\\frac{e^{x}+e^{-x}}{2}=\\sum_{i=0}^{\\infin}\\frac{x^{2i}}{(2i)!}\n$$\n\n\u8bbe$f_i$\u8868\u793a\u81f3\u5c11\u6709$i$\u79cd\u73cd\u73e0\u7684\u4e2a\u6570\u4e3a\u5947\u6570\u7684$\\frac{1}{\\prod_{j=1}^icnt[j]}$\u7684\u548c\u3002\n\n\u8bbe$g_i$\u8868\u793a\u6070\u597d\u6709$i$\u79cd\u73cd\u73e0\u7684\u4e2a\u6570\u4e3a\u5947\u6570\u7684$\\frac{1}{\\prod_{j=1}^icnt[j]}$\u7684\u548c\u3002\n\n\u5219\u6709\uff1a\n$$\n\\begin{aligned}f_i&=\\binom{D}{i}[x^n]\\left(\\frac{e^x-e^{-x}}{2}\\right)^ie^{(D-i)x}\\\\&=\\frac{1}{2^i}\\binom{D}{i}[x^n](e^x-e^{-x})^ie^{(D-i)x}\\\\&=\\frac{1}{2^i}\\binom{D}{i}[x^n]\\sum_{j=0}^i\\binom{i}{j}(-1)^{i-j}e^{jx}e^{(j-i)x}e^{(D-i)x}\\\\&=\\frac{1}{2^i}\\binom{D}{i}[x^n]\\sum_{j=0}^i\\binom{i}{j}(-1)^{i-j}e^{(D-2(i-j))x}\\end{aligned}\n$$\n\u7136\u540e\u628a\u91cc\u9762\u7684$j$\u8bbe\u6210$i-j$\u7b49\u5f0f\u4e0d\u53d8\u3002\n$$\nf_i=\\frac{1}{2^i}\\binom{D}{i}[x^n]\\sum_{j=0}^i\\binom{i}{j}(-1)^{j}e^{(D-2j)x}\n$$\n\u7136\u540e\u73b0\u5728\u53c8\u6709\u4e00\u4e2a\u795e\u5947\u7684$\\text{EGF}$\uff1a\n$$\ne^{cx}=\\sum_{i=0}^{\\infin}c^i\\frac{x^i}{i!}\n$$\n\u53c8\u56e0\u4e3a\u6700\u540e\u7b54\u6848\u8981\u4e58\u4e0a$n$\u7684\u9636\u4e58\uff0c\u6211\u4eec\u73b0\u5728\u5148\u4e58\u8fdb\u53bb\uff1a\n$$\n\\begin{aligned}f_i&=\\frac{1}{2^i}\\binom{D}{i}\\sum_{j=0}^i\\binom{i}{j}(-1)^j(D-2j)^n\\\\\\frac{f_i}{i!}&=\\frac{1}{2^i}\\binom{D}{i}\\sum_{j=0}^i\\frac{(-1)^j(D-2j)^n}{j!}\\frac{1}{(i-j)!}\\end{aligned}\n$$\n\u663e\u7136\u662f\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\u3002\n\n\u6700\u540e\u4e8c\u9879\u5f0f\u53cd\u6f14\u4e00\u4e0b\u6709\uff1a\n$$\n\\begin{aligned}g_i&=\\sum_{j=i}^D(-1)^{j-i}\\binom{j}{i}f_j\\\\g_i \\times i!&=\\sum_{j=i}^D\\frac{(-1)^{j-i}}{(j-i)!}f_j\\times j!\\end{aligned}\n$$\n\u7136\u540e\u6211\u4eec\u628a$g_i \\times i!$\u548c$f_i \\times i!$\u90fd$\\text{reverse}$\u4e00\u4e0b\u5c31\u662f\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\u4e86\u3002\u6700\u540e\u7b54\u6848\u4e3a\uff1a\n$$\n\\sum_{i=0}^{n-2m}g_i\n$$\n\u590d\u6742\u5ea6\u4e3a$O(D \\log D)$\u3002\n\nPS \uff1a \u8981\u5148\u5224\u4e00\u4e0b$n - 2m < 0$\u548c$n - 2m \\ge D$\u7684\u60c5\u51b5\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n/*\n * 3120.cpp\n * This file is part of 3120\n *\n * Copyright (C) 2019 - ViXbob\n *\n * 3120 is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2.1 of the License, or (at your option) any later version.\n *\n * 3120 is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with 3120. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * There is no end though there is a start in space. ---Infinity.\n * It has own power, it ruins, and it goes though there is a start also in the star. ---Finite.\n * Only the person who was wisdom can read the most foolish one from the history.\n * The fish that lives in the sea doesn't know the world in the land.\n * It also ruins and goes if they have wisdom.\n * It is funnier that man exceeds the speed of light than fish start living in the land.\n * It can be said that this is an final ultimatum from the god to the people who can fight.\n *\n * Steins;Gate\n */\n#include <bits/stdc++.h>\n#define rep(i, j, k) for(int i = j; i <= k; ++i)\n#define dep(i, j, k) for(int i = j; i >= k; --i)\n#define SIZE(x) ((int)x.size())\n#define mp(x, y) make_pair(x, y)\n#define pb(x) push_back(x)\n#define inv(x) (ksm(x, P - 2))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\n\nusing namespace std;\n\nconst int maxn = 1e5 + 5;\nconst int P = 998244353;\nconst int inf = 0x3f3f3f3f;\nconst int maxm = maxn << 2;\n\ninline int read() {\n\tchar ch = getchar(); int u = 0, f = 1;\n\twhile(!isdigit(ch)) { if(ch == '-') f = -1; ch = getchar(); }\n\twhile(isdigit(ch))  { u = u * 10 + ch - 48; ch = getchar(); } return u * f;\n}\n\nint D, n, m, ans, fac[maxn], ifac[maxn], f[maxn], g[maxn], ipow2[maxn];\n\ninline int pls(int x, int y) { x += y; return x >= P ? x - P : x; }\ninline int dec(int x, int y) { x -= y; return x < 0 ? x + P : x; }\ninline int mul(int x, int y) { return 1ll * x * y % P; }\ninline int C(int n, int m) { return 1ll * fac[n] * ifac[m] % P * ifac[n - m] % P; }\ninline int ksm(int x, int k, int rnt = 1) { \n\tfor(int i = k; i; i >>= 1, x = 1ll * x * x % P) if(i & 1) rnt = 1ll * rnt * x % P;\n\treturn rnt;\n}\n\nnamespace NTT {\n\tconst int G = 3, invG = inv(G);\n\t\n\tint s, l, rev[maxm], E[maxm], H[maxm], inv;\n\t\n\tinline void init(int n) {\n\t\ts = 2; l = 1;\n\t\twhile(s <= n) s <<= 1, l++; inv = inv(s);\n\t\trep(i, 0, s - 1) rev[i] = rev[i >> 1] >> 1 | (i & 1) << l - 1;\n\t\tmemset(E, 0, sizeof(int) * (s + 5));\n\t\tmemset(H, 0, sizeof(int) * (s + 5));\n\t}\n\t\n\tinline void dft(int *a, int n, int f) {\n\t\trep(i, 0, n - 1) if(i < rev[i]) swap(a[i], a[rev[i]]);\n\t\tfor(int i = 1; i < n; i <<= 1) {\n\t\t\tint Wn = ksm(f, (P - 1) / (i << 1));\n\t\t\tfor(int j = 0; j < n; j += (i << 1)) {\n\t\t\t\tint w = 1;\n\t\t\t\tfor(int k = 0; k < i; k++, w = 1ll * w * Wn % P) {\n\t\t\t\t\tint A1 = a[j + k], A2 = 1ll * w * a[j + k + i] % P;\n\t\t\t\t\ta[j + k] = pls(A1, A2); a[j + k + i] = dec(A1, A2);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tinline void conv() {\n\t\tdft(E, s, G); dft(H, s, G);\n\t\trep(i, 0, s - 1) E[i] = 1ll * E[i] * H[i] % P;\n\t\tdft(E, s, invG);\n\t\trep(i, 0, s - 1) E[i] = 1ll * E[i] * inv % P;\n\t}\n}\n\nconst int inv2 = inv(2);\n\nint main() {\n//\tfreopen(\"1.in\", \"r\", stdin);\n//\tfreopen(\"my.out\", \"w\", stdout);\n\tD = read(); n = read(); m = read();\n\tif(n - 2 * m < 0) { cout << 0 << endl; return 0; }\n\tif(n - 2 * m >= D) { cout << ksm(D, n) << endl; return 0; }\n\tfac[0] = 1; ipow2[0] = 1;\n\trep(i, 1, D) fac[i] = 1ll * fac[i - 1] * i % P, ipow2[i] = 1ll * ipow2[i - 1] * inv2 % P;\n\tifac[D] = inv(fac[D]);\n\tdep(i, D - 1, 0) ifac[i] = 1ll * ifac[i + 1] * (i + 1) % P;\n\t\n\tNTT :: init(D << 1);\n\tfor(int i = 0, ty = 1; i <= D; i++, ty = (ty == 1 ? P - 1 : 1))\n\t\tNTT :: E[i] = 1ll * ty * ksm(pls(D - 2 * i, P), n) % P * ifac[i] % P, NTT :: H[i] = ifac[i];\n\tNTT :: conv();\n\trep(i, 0, D) f[i] = 1ll * ipow2[i] * fac[i] % P * C(D, i) % P * NTT :: E[i] % P;\n\t\n\tNTT :: init(D << 1);\n\tfor(int i = 0, ty = 1; i <= D; i++, ty = (ty == 1 ? P - 1 : 1))\n\t\tNTT :: E[i] = 1ll * f[D - i] * fac[D - i] % P, NTT :: H[i] = 1ll * ty * ifac[i] % P;\n\tNTT :: conv();\n\trep(i, 0, D) g[i] = 1ll * NTT :: E[D - i] * ifac[i] % P;\n\trep(i, 0, n - 2 * m) ans = pls(ans, g[i]);\n\tcout << ans << endl;\n\treturn 0;\n}\n/*\n*/\n```",
        "postTime": 1558281140,
        "uid": 50971,
        "name": "ViXbob",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5401 \u3010[CTS2019]\u73cd\u73e0\u3011"
    }
]
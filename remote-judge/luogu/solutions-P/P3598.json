[
    {
        "content": "\n\u611f\u89c9\u633a\u6709\u610f\u601d\u7684\u3002\n\n\u5b9a\u4e49 $f(n)=\\sum_{k=0}^n x^k$\uff0c\u5176\u4e2d $x$ \u4e3a\u5e38\u6570\u3002\n\n\u7ed9\u5b9a $x$ \u548c $N$ \u4e2a\u81ea\u7136\u6570 $a_i$\uff0c\u6c42 $\\textrm{lcm}\\{f(a_1),f(a_2)...f(a_n)\\}$\n\n$N\\le 100,a_i\\le 10^{9},2\\le x\\le 10^{18}$\n\n---\n\n$\\rm Sol:$\n\n$$f(n)=\\frac{x^n-1}{x-1}$$\n\n\u6ce8\u610f\u5230\uff1a\n\n$$\\textrm{lcm}(\\frac{a}{c}, \\frac{b}{c})=\\frac{\\textrm{lcm}(a,b)}{c}$$\n\n\u4e8e\u662f\u6240\u6c42\u4e3a\uff1a\n\n$$\\frac{\\textrm{lcm}\\{x^{a_1}-1,x^{a_2}-1\\cdots x^{a_n}-1\\}}{x-1}$$\n\n\u63a5\u4e0b\u6765\uff0c\u901a\u8fc7\u4e00\u5b9a\u7684\u624b\u73a9\uff0c\u6211\u4eec\u53ef\u4ee5\u8bc1\u660e~~\u778e\u731c~~\u4e00\u4e2a\u7ed3\u8bba\uff1a$\\gcd(x^{a}-1,x^{b}-1)=x^{\\gcd(a,b)}-1$\u3002\n\n\u53ef\u4ee5\u8fd9\u6837\u8003\u8651\uff0c\u8bbe $f(n)=x^n-1$\uff0c\u6211\u4eec\u5148\u8bc1\u660e $\\gcd(f(n),f(m+n))=\\gcd(f(n),f(m))$\n\n\u4e8b\u5b9e\u4e0a\uff0c\u6ce8\u610f\u5230\uff1a\n\n$$\\begin{aligned}\n    &\\gcd(x^n-1,x^{n+m}-1)\n    \\\\&=\\gcd(x^n-1,(x^n-1)(x^m-1)+(x^n-1)+(x^m-1))\n    \\\\&=\\gcd(x^n-1,x^m-1)\n\\end{aligned}$$\n\n\u4e8e\u662f\u5bf9\u4e8e $\\gcd(f(x),f(y))$\uff0c\u5982\u679c\u6709 $x<y$\uff0c\u90a3\u4e48 $\\gcd(f(x),f(y))=\\gcd(f(x), f(y-x))$\uff0c\u6362\u800c\u8a00\u4e4b\u8f97\u8f6c\u76f8\u9664\u6210\u7acb\uff0c\u4e8e\u662f\u6211\u4eec\u6709 $\\gcd(f(x),f(y))=f(\\gcd(x,y))$\n\n\u6b64\u65f6\u6211\u4eec\u6240\u6c42\u4e3a $\\textrm{lcm}$\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 $\\min-\\max$ \u53cd\u6f14\u6765\u901a\u8fc7 $\\gcd$ \u8ba1\u7b97\u7b54\u6848\uff08\u76f4\u63a5\u8003\u8651\u8d21\u732e\u5e76\u5bb9\u65a5\u53ef\u4ee5\u5f97\u5230\u76f8\u4f3c\u7684\u7ed3\u679c\uff0c\u4f46\u662f\u4e0e $\\min-\\max$ \u5bb9\u65a5\u7684\u63a8\u5bfc\u662f\u76f8\u4f3c\u7684\uff09\n\n\u6ce8\u610f\u5230 $\\rm lcm$ \u662f\u5bf9\u4e8e\u6bcf\u4e2a\u8d28\u56e0\u5b50\u6307\u6570\u53d6 $\\max$\uff0c\u800c $\\gcd$ \u4e3a\u5bf9\u4e8e\u6bcf\u4e2a\u8d28\u56e0\u5b50\u6307\u6570\u53d6 $\\min$\uff0c\u5728\u8003\u8651\u6bcf\u4e2a\u8d28\u56e0\u5b50\u4e0b\uff0c\u6211\u4eec\u8ba1\u7b97\u4e00\u4e9b\u6570\u7684 $\\rm lcm$ \u53ef\u4ee5\u8f7b\u6613\u7684\u901a\u8fc7 $\\gcd$ \u8868\u793a\uff1a\n\n$$\\begin{aligned}\n    &p^{\\max(k_1...k_n)}=\\prod_{S\\subseteq{T},S\\ne \\varnothing} p^{(-1)^{|S|+1}\\min(k\\in S)}\n    \\\\&\\textrm{lcm}(T)=\\prod p^{\\sum_{S\\subseteq T,S\\ne \\varnothing}(-1)^{|S|+1}\\min(k\\in S)}\n    \\\\&\\textrm{lcm}(T)=\\prod_{S\\subseteq T,S\\ne \\varnothing} \\prod p^{(-1)^{|S|+1}\\min(k\\in S)}\n    \\\\&\\textrm{lcm}(T)=\\prod_{S\\subseteq T,S\\ne \\varnothing} \\gcd(S)^{(-1)^{|S|+1}}\n\\end{aligned}$$\n\n\u5f53\u6211\u4eec\u8f6c\u6362\u4e3a $\\gcd$ \u7684\u5f62\u5f0f\u540e\uff0c\u6839\u636e\u4e00\u5f00\u59cb\u7684\u7ed3\u8bba\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0d\u8ba1\u7b97\u8fd9\u79cd\u6781\u5927\u7684\u6570\u7684 $\\gcd$ \u800c\u662f\u8f6c\u4e3a\u8ba1\u7b97\u4e0b\u6807\u7684 $\\gcd$ \u5e76\u505a\u4e58\u6cd5\u3002\n\n\u6bcf\u4e2a\u6570 $a$ \u53ef\u4ee5\u5f97\u5230\u7684 $\\gcd$ \u6709\u4e14\u4ec5\u6709\u5176\u7ea6\u6570\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u7ea6\u6570\uff0c\u5176\u8d21\u732e\u4e3a $\\sum (-1)^{|S|}[\\gcd(S)=x]$\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5957\u8def\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u8bbe $F(x)$ \u8868\u793a\u81f3\u5c11\uff0c\u90a3\u4e48 $F(x)=\\sum(-1)^{|S|+1}[x|k,\\forall k\\in S]$\uff0c\u8bbe $cnt$ \u4e3a\u8fd9\u79cd $k$ \u7684\u6570\u91cf\uff0c\u90a3\u4e48 $F(x)=\\sum_{j=1}^{cnt} \\binom{cnt}{j} (-1)^{j+1}$\uff0c\u5bb9\u6613\u77e5\u9053 $F(x)=1$\n\n\u7136\u540e\u6211\u4eec\u505a\u4e00\u8fb9\u5bb9\u65a5/\u53cd\u6f14\u5373\u53ef\u5f97\u5230\u7b54\u6848\uff0c\u590d\u6742\u5ea6\u4e3a $\\mathcal O((N\\cdot \\sigma(w))^2+N\\times \\sqrt{w})$\uff0c\u7136\u800c\u76f8\u540c\u7684\u7ea6\u6570\u6211\u4eec\u4e0d\u9700\u8981\u91cd\u590d\u904d\u5386\uff0c\u6240\u4ee5\u5b9e\u9645\u590d\u6742\u5ea6\u4f1a\u66f4\u5c0f\u3002~~\u8dd1\u5f97\u975e\u5e38\u5feb~~\n\n$Code:$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std ;\n#define Next( i, x ) for( register int i = head[x]; i; i = e[i].next )\n#define rep( i, s, t ) for( register int i = (s); i <= (t); ++ i )\n#define drep( i, s, t ) for( register int i = (t); i >= (s); -- i )\n#define re register\n#define int long long\nint gi() {\n\tchar cc = getchar() ; int cn = 0, flus = 1 ;\n\twhile( cc < '0' || cc > '9' ) {  if( cc == '-' ) flus = - flus ; cc = getchar() ; }\n\twhile( cc >= '0' && cc <= '9' )  cn = cn * 10 + cc - '0', cc = getchar() ;\n\treturn cn * flus ;\n}\nconst int N = 100 + 5 ; \nconst int M = 5000 + 5 ; \nconst int P = 1e9 + 7 ; \nconst int I = 1e9 + 6 ; \nint n, X, top, st[N * 1926], w[N], cnt, F[M] ; \nint fpow( int x, int k ) {\n\tint ans = 1, base = x ; \n\twhile(k) {\n\t\tif(k & 1) ans = ans * base % P ;\n\t\tbase = base * base % P, k >>= 1 ; \n\t} return ans ; \n}\nsigned main()\n{\n\tX = gi() % P, n = gi() ; \n\trep( i, 1, n ) {\n\t\tint x = gi() + 1, k = sqrt(x) ; \n\t\tfor( re int i = 1; i <= k; ++ i ) {\n\t\t\tif( x % i ) continue ; \n\t\t\tst[++ top] = i, st[++ top] = x / i ; \n\t\t}\n\t}\n\tsort( st + 1, st + top + 1 ) ;\n\trep( i, 1, top ) if( st[i] != st[i - 1] ) w[++ cnt] = st[i] ; \n\tdrep( i, 1, cnt ) {\n\t\tF[i] = 1 ; \n\t\trep( j, i + 1, cnt ) if( w[j] % w[i] == 0 ) F[i] = ( F[i] - F[j] + I ) % I  ;\n\t}\n\tint ans = 1 ; \n\trep( i, 1, cnt ) {\n\t\tint dx = fpow( X, w[i] ) - 1 ; \n\t\tF[i] = ( F[i] % I + I ) % I ; \n\t\tans = ans * fpow( dx, F[i] ) % P ; \n\t}\n\tcout << ans * fpow( X - 1, P - 2 ) % P << endl ; \n\treturn 0 ;\n}\n```",
        "postTime": 1595421674,
        "uid": 30036,
        "name": "Soulist",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3598 \u3010Koishi Loves Number Theory\u3011"
    },
    {
        "content": "\u5b98\u65b9\u9898\u89e3\uff1a https://www.luogu.org/discuss/show?postid=7867\n",
        "postTime": 1486036480,
        "uid": 141,
        "name": "w",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3598 \u3010Koishi Loves Number Theory\u3011"
    },
    {
        "content": "[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3598)\n\n## \u9898\u76ee\u5927\u610f\n\n\u4ee4 $\\operatorname{f}(n)=\\sum \\limits_{i=0}^n x^i$\uff0c\u6c42 $\n\\operatorname{lcm} (\\operatorname{f}(a_1),\\dots,\\operatorname{f}(a_n)) \\mod (10^9+7)\n$\uff0c\u5176\u4e2d $1 \\leqslant n \\leqslant 100$\uff0c$0 \\leqslant a_i \\leqslant10^9$\uff0c$2 \\leqslant x \\leqslant 10^{18}$\u3002\n\n## \u5206\u6790\n\n\u4e00\u9053~~\u4eba\u7c7b\u667a\u6167\u7684~~\u6570\u5b66\u9898\u3002\n\n\u51fa\u9898\u4eba\u8bf4\u8fc7\u6570\u636e\u4fdd\u8bc1 $x-1$ \u4e0d\u662f $10^9+7$ \u7684\u500d\u6570\uff0c\u6240\u4ee5\u5927\u80c6\u5c06 $\\operatorname{f}(n)$ \u5316\u7b80\u4e3a $\\dfrac{x^{n+1}-1}{x-1}$\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u53ef\u4ee5\u8868\u793a\u4e3a $\\dfrac{\\operatorname{lcm}(x^{a_1}-1,\\dots,x^{a_n}-1)}{x-1}$\u3002\n\n\u7136\u540e\u4f5c\u4e3a\u4e00\u540d\u849f\u84bb\uff0c~~\u663e\u7136\u6211\u6beb\u65e0\u601d\u8def~~\uff0c\u76f4\u63a5\u60f3 $n=2$ \u7684\u60c5\u51b5\uff0c\u663e\u7136\u8fd9\u65f6\u5019\u7b54\u6848\u53ef\u4ee5\u8868\u793a\u4e3a $\\dfrac{(x^{a_1}-1)(x^{a_2}-1)}{(x-1) \\cdot \\gcd (x^{a_1}-1,x^{a_2}-1)}$\uff0c\u5173\u952e\u5728\u4e8e\u600e\u4e48\u6c42 $\\gcd$\u3002\n\n\u624b\u73a9\u4e00\u4e0b $x=2$ \u7684\u60c5\u51b5\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/t4hu5vp7.png)\n\n\u89c2\u5bdf\u8fd9\u4e9b\u6570\u5b57\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230 $a_i=4$ \u548c $a_i=6$ \u7684 $\\gcd$ \u6070\u597d\u662f $3$\uff0c\u4e5f\u5c31\u662f $a_i=2$ \u7684\u60c5\u51b5\u3002\n\n\u800c\u8fd9\u4e09\u4e2a\u6570\u7684\u5173\u7cfb\u662f $\\gcd(4,6)=2$\uff0c\u4e8e\u662f\u6211\u4eec~~\u778e\u731c~~\u5408\u7406\u63a8\u65ad\uff1a\n\n$$\n\\gcd(x^a-1,x^b-1)=x^{\\gcd(a,b)}-1\n$$\n\n~~\u968f\u4fbf~~\u8bc1\u660e\u4e00\u4e0b $(a > b)$\uff1a\n\n$$\n\\begin{aligned}\n\\gcd(x^a-1,x^b-1) & = \\gcd(x^a-1-x^b+1,x^b-1) \\\\\n& = \\gcd((x^{a-b}-1)x^b,x^b-1) \\\\\n& = \\gcd(x^{a-b}-1,x^b-1)\n\\end{aligned}\n$$\n\n\u53ef\u4ee5\u8f97\u8f6c\u76f8\u9664\uff0c\u6240\u4ee5\u731c\u6d4b\u6210\u7acb\u3002\n\n\u4e0b\u4e00\u6b65\u8003\u8651\u5bf9\u4e8e $n > 2$ \u7684\u65f6\u5019\u600e\u4e48\u5c06 $\\operatorname{lcm}$ \u8f6c\u5316\u4e3a $\\gcd$\u3002\n\n\u8003\u8651\u8d28\u56e0\u6570\u5206\u89e3\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u7279\u5b9a\u7684\u8d28\u6570 $p$\uff0c\u8bbe\u5b83\u5728 $n$ \u8d28\u56e0\u6570\u5206\u89e3\u540e\u51fa\u73b0\u7684\u6b21\u6570\u4e3a $\\operatorname{v}_p(n)$\uff0c\u90a3\u4e48 $\\operatorname{v}_p(\\operatorname{lcm}(a_1,\\cdots,a_n))=\\max(\\operatorname{v}_p(a_1),\\cdots,\\operatorname{v}_p(a_n))$\uff0c$\\operatorname{v}_p(\\gcd(a_1,\\cdots,a_n))=\\min(\\operatorname{v}_p(a_1),\\cdots,\\operatorname{v}_p(a_n))$\u3002\n\n\u7531 $\\min-\\max$ \u5bb9\u65a5\u53ef\u5f97 $\\operatorname{v}_p(\\operatorname{lcm}(a_1,\\cdots,a_n))=\\sum \\limits_{S \\subseteq {\\{1,2,\\cdots,n\\}}} (-1)^{\\left| S\\right|-1} \\operatorname{v}_p(\\gcd \\limits_{k \\in S}(a_k))$\uff0c\u7efc\u5408\u8d77\u6765\u5c31\u662f $\\operatorname{lcm}(a_1,\\cdots,a_n)$ \u4e3a $\\{ a_i\\}$ \u4e2d\u6240\u6709\u5947\u6570\u5143\u5b50\u96c6\u5404\u81ea $\\gcd$ \u7684\u79ef\u9664\u4ee5\u6240\u6709\u5076\u6570\u5143\u5b50\u96c6\u5404\u81ea $\\gcd$ \u7684\u79ef\u3002\n\n\u6ce8\u610f\u5230 $\\gcd$ \u7684\u6570\u91cf\u4e0d\u591a\uff0c\u53ef\u4ee5\u4e0d\u65ad\u5c06\u65b0\u7684\u6570\u548c\u524d\u9762\u5df2\u6c42\u5f97\u7684\u6240\u6709 $\\gcd$ \u90fd\u64cd\u4f5c\u4e00\u6b21\uff0c\u66f4\u65b0 $\\gcd$ \u7684\u6570\u91cf\u4ee5\u53ca\u7b54\u6848\u3002",
        "postTime": 1675504560,
        "uid": 128433,
        "name": "C6H14",
        "ccfLevel": 7,
        "title": "\u3010\u9898\u89e3\u3011P3598"
    }
]
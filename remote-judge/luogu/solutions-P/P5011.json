[
    {
        "content": "\n\u5f88\u663e\u7136\u6bcf\u4e2a\u6570\u5728\u6c42\u548c\u65f6\u51fa\u73b0\u7684\u6b21\u6570\u76f8\u7b49\uff0c\u8bbe$d[i]$\u4e3a\u52a8\u4f5c\u603b\u6570\u4e3a$i$\u4e2a\u65f6\u67d0\u4e2a\u6570\u6c42\u548c\u65f6\u7684\u8d21\u732e\uff0c\u5219\n#### $ans=d[n]*sum/k^n( mod $ $19491001)$\n\u8bd5\u56fe\u9012\u63a8$d[n]$\uff0c\u9996\u5148\u653e\u5f0f\u5b50\n#### $d[i]=k^{i-1}+2*k^{i-2}+d[i-1]*k$\n\u7b2c\u4e00\u9879$k^{i-1}$\u8868\u793a\u52a8\u4f5c\u603b\u6570\u4e3a$i$\u65f6\u6392\u5217\u6570\u91cf\uff0c\u5728\u4e4b\u540e\u53ef\u4ee5\u653e$x$\u4f7f\u8ba1\u6570++\uff1b\n\n\u7b2c\u4e8c\u9879$2*k^{i-2}$\u8868\u793a\u6392\u5217\u4e2d\u4ee5$x$/$x-1$\u7ed3\u5c3e\u7684\u6570\u91cf\uff0c\u5728\u6b64\u4e4b\u540e\u4f1a\u4ea7\u751f\u7ec4\u5408\u6280\u6548\u679c\uff1b\n\n\u7b2c\u4e09\u9879$d[i-1]*k$\u8868\u793a\u6392\u5217\u524d$i-1$\u4f4d\u4e2d$x$\u7684\u8d21\u732e\uff1b\n\n\u7136\u540e\u7ecf\u8fc7~~\u627e\u89c4\u5f8b~~\u5f52\u7eb3\u63a8\u7406\uff0c\u53ef\u5f97\n#### $d[n]=n*k^{n-1}+2*(n-1)*k^{n-2}$\n\u4ee3\u5165\u8fdb$ans$\u4e2d\uff0c\u5f97\n#### $ans=sum*(n*k+2*(n-1))/k^2$\n\u6c42\u51fa$sum$%$mod$,$k$\u7684\u9006\u5143,$n$%$mod$\u5373\u53efAC\n## Code\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<cctype> \nusing namespace std;\ntypedef long long ll;\nll mod = 19491001;\nint n;\nchar s[1000010];\nint len; \nll N; \nll k;\nll tot;\n\n\nll quick_pow(ll x, int k) {\n    ll res = 1;\n    while(k) {\n        if(k & 1) res = res * x % mod;\n        x = x * x % mod;\n        k >>= 1;\n    }\n    return res;\n}\n\nll inv(long long x) {\n    return quick_pow(x, mod - 2);\n}\n\n \nint main(){\n    char ch=getchar();\n    while(isdigit(ch)){\n        s[++len]=ch;\n        N=(10*N+ch-'0')%mod;\n        ch=getchar();\n    }\n    scanf(\"%lld\",&k);\n    int i,val;\n    for(i=1;i<=k;i++){\n        scanf(\"%d\",&val);\n        tot=(tot+val)%mod;\n    }\n    ll invk=inv(k);\n    printf(\"%d\",(N*k%mod+2*N-2)%mod*tot%mod*invk%mod*invk%mod);\n    return 0;\n}\n```",
        "postTime": 1541671964,
        "uid": 91823,
        "name": "diltraser",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5011 \u3010\u6c34\u306e\u9020\u9898\u3011"
    },
    {
        "content": "\u6839\u636e**\u671f\u671b\u7684\u7ebf\u6027\u6027**\u53ef\u5f97\uff1a\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97\u6bcf\u4e00\u79cd\u7ec4\u5408\u7684\u671f\u671b\u7136\u540e\u52a0\u8d77\u6765\u3002\n\n\u663e\u7136\uff0c\u5728\u4f4d\u7f6e $i,i+1$ \u51fa\u73b0\u4e24\u4e2a\u7f16\u53f7\u8fde\u7eed\u7684\u52a8\u4f5c\u7684\u6982\u7387\u5c31\u662f $\\dfrac{1}{k^2}$\u3002\u56e0\u4e3a\u4e24\u4e2a\u4e8b\u4ef6\u72ec\u7acb\u3002\n\n\u6240\u4ee5\u5bf9\u4e8e\u67d0\u4e00\u79cd\u52a8\u4f5c\u7ec4\u5408\u51fa\u73b0\u7684\u671f\u671b\u6b21\u6570\u5c31\u662f $\\dfrac{n}{k^2}$\u3002\n\n\u6240\u4ee5\u52a8\u4f5c\u7ec4\u5408\u7684\u8d21\u732e\u5c31\u662f $\\dfrac{2(n-1)}{k^2}\\sum a_i$\u3002\n\n----\n\n\u6bcf\u4e00\u79cd\u52a8\u4f5c\u5355\u72ec\u7684\u8d21\u732e\u5c31\u66f4\u7b80\u5355\u4e86\u3002\u663e\u7136\u5728\u67d0\u4e2a\u4f4d\u7f6e\u51fa\u73b0 $i$ \u53f7\u52a8\u4f5c\u7684\u6982\u7387\u662f $\\dfrac{1}{k}$\u3002\n\n\u6240\u4ee5\u51fa\u73b0\u7684\u671f\u671b\u6b21\u6570\u5c31\u662f $\\dfrac{n}{k}$\u3002\n\n\u6240\u4ee5\u52a8\u4f5c\u5355\u72ec\u7684\u8d21\u732e\u5c31\u662f $\\dfrac{n}{k}\\sum a_i$\u3002\n\n----\n\n\u4e8e\u662f\u628a\u4e24\u79cd\u8d21\u732e\u90fd\u52a0\u8d77\u6765\u5c31\u597d\u5566\u3002\n\n$n$ \u90a3\u4e48\u5927\uff0c\u76f4\u63a5\u8bfb\u5165\u7684\u65f6\u5019\u53d6\u6a21\u5c31\u597d\u5566\uff01\n\n\u4ee3\u7801\u4e5f\u5f88\u7b80\u5355\uff5e\n\n\u65e0\u9650 orz \u51fa\u9898\u4eba CYJian\uff01\n\n```cpp\n#include <bits/stdc++.h>\n\n#define LL long long\n\nint read(int MOD = INT_MAX){\n\tchar k = getchar(); int x = 0;\n\twhile(k < '0' || k > '9') k = getchar();\n\twhile(k >= '0' && k <= '9') x = (x * 10 + k - '0') % MOD ,k = getchar();\n\treturn x;\n}\n\nLL n ,k;\nconst int MX = 1e6 + 23;\nconst LL MOD = 19491001;\n\nLL qpow(LL a ,LL b ,LL p = MOD){\n\tLL Ans = 1 % p;\n\twhile(b){if(b & 1) Ans = Ans * a % p;\n\t\ta = a * a % p ,b >>= 1;\n\t}return Ans;\n}\n\nint main(){\n\tn = read(MOD) ,k = read();\n\tLL sum = 0;\n\tfor(int i = 1 ; i <= k ; ++i){\n\t\tsum = (sum + read()) % MOD;\n\t}\n\n\tLL t = (n - 1 + MOD) * qpow(k * k % MOD ,MOD - 2) % MOD;\n\t\n\tLL ivk = qpow(k ,MOD - 2);\n\t\n\tLL Ans = sum * t % MOD * 2 % MOD;\n\tAns = (Ans + ivk * n % MOD * sum) % MOD;\n\n\t// fprintf(stderr ,\"%lld\\n\" ,Ans * qpow(k ,n) % MOD);\n\n\tprintf(\"%lld\\n\" ,Ans);\n\treturn 0;\n}\n```",
        "postTime": 1602595155,
        "uid": 47863,
        "name": "Imakf",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5011 \u3010\u6c34\u306e\u9020\u9898\u3011"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u79cd\u4e0d\u540c\u7684\u4f46\u66f4\u52a0\u663e\u7136\u4e0d\u7528\u52a8\u8111\u7684\u65b9\u6cd5\u3002\n\n\u9996\u5148\u8003\u8651\u4e00\u773c\u7684 DP\u3002\u6211\u4eec\u8bbe $f_i$ \u8868\u793a\u524d $i$ \u6b65\u7684\u53d6\u503c\u3002\uff08\u8bbe $j$ \u524d\u9762\u90a3\u4e2a\u5143\u7d20\u5c31\u662f $a_{j-1}$ \u4e86\uff0c$j=1$ \u65f6\u81ea\u52a8\u4ee3\u6210 $k$\uff09\n\n$$\n\\begin{aligned}\nf_i&=f_{i-1}+\\sum_{j=1}^{k}\\frac{a_j+\\frac{a_j+a_{j-1}}{k}}{k}\\\\\n&=f_{i-1}+\\frac{(\\sum a)+\\frac{2\\sum a}{k}}{k}\\\\\n&=f_{i-1}+\\frac{(k+2)\\sum a}{k^2}\n\\end{aligned}\n$$\n\n\u6211\u4eec\u6709\u9996\u9879 $f_1=\\frac{\\sum a}{k}$\uff0c\u4e8e\u662f\u6709\u7b54\u6848\n\n$$\n\\begin{aligned}\nf_n &= f_{1} + (n-1)\\times \\frac{(k+2)\\sum a}{k^2}\\\\\n&= \\frac{k+(n-1)(k+2)}{k^2} \\sum a\\\\\n&= \\frac{nk+2n-2}{k^2} \\sum a\n\\end{aligned}\n$$",
        "postTime": 1620108585,
        "uid": 180652,
        "name": "_lgswdn",
        "ccfLevel": 0,
        "title": "P5011 \u6c34\u306e\u9020\u9898"
    },
    {
        "content": "### \u9898\u76ee\u5730\u5740\u4e0e\u9898\u610f[\u89c1\u94fe\u63a5](https://www.luogu.org/problemnew/show/P5011)\n\n---\n\n\u66b4\u529b\u5c31\u662f$O(k^n)$\u5427\uff0c\u4e0d\u8fc7$n$\u975e\u5e38\u4e4b\u5927\uff0c\u6709$10^{10^6}$\uff08\u9ad8\u7cbe\u53ef\u6015.jpg\uff09\n\n\u4f46\u662f\u6211\u4eec\u53d1\u73b0\uff0c\u5bf9\u4e8e\u6c42\u671f\u671b\uff0c\u90a3\u4e48\u5c31\u662f\u6982\u7387$\\times$\u6743\u503c\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5148\u6c42\u51fa\u6bcf\u79cd\u52a8\u4f5c\u7684\u8d21\u732e\uff1a\n\n>\u6bcf\u79cd\u52a8\u4f5c\u51fa\u73b0\u5728\u67d0\u4e2a\u4f4d\u7f6e\u7684\u6982\u7387\u4e3a$\\frac{1}{k}$\uff0c\u8d21\u732e\u4e3a\u5b83\u7684$val$\uff0c\u603b\u5171\u6709$n$\u4e2a\u53ef\u4ee5\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u6240\u4ee5\u8d21\u732e\u4e3a$\\sum_{i=0}^{k-1}\\frac{n\\times val_i}{k}$\n\n\u63a5\u4e0b\u6765\u5c31\u662f\u7ec4\u5408\u6280\u7684\u591a\u7684\u8d21\u732e\uff0c\u6bcf\u4e2a\u7ec4\u5408\u6280\u8fd8\u4f1a\u518d\u8d21\u732e\u4e00\u6b21\uff0c\u6240\u4ee5\u6211\u4eec\u8fd9\u6837\u6765\u770b\uff1a\n\n>\u6bcf\u4e2a\u7ec4\u5408\u6280\u51fa\u73b0\u7684\u6982\u7387\u4e3a$\\frac{1}{k^2}$\uff0c\u6709$n-1$\u4e2a\u53ef\u4ee5\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u6bcf\u4e00\u79cd\u7684\u8d21\u732e\u4e3a$val_i+val_{(i+1)\\%k}$\uff0c\u6240\u4ee5\u603b\u8d21\u732e\u4e3a$\\sum_{i=0}^{k-1}\\frac{(n-1)\\times (val_i+val_{(i+1)\\%k})}{k^2}$\n\n\u90a3\u4e48\u6211\u4eec$O(k)$\u7684\u7b97\u4e00\u4e0b\u5c31\u597d\u5566\uff0c\u5173\u4e8e\u53d6\u6a21\u9664\u6cd5\u6211\u4eec\u7528\u8d39\u9a6c\u5c0f\u5b9a\u7406\u9006\u5143\u5c31\u53ef\u4ee5\u4e86\uff0c\u56e0\u4e3a$19491001$\u662f\u4e2a~~\u975e\u5e38\u795e\u5947\u4e14\u6709\u5de8\u5927\u610f\u4e49\u7684~~\u8d28\u6570\uff0c\u8bfb\u5165$n$\u65f6\u76f4\u63a5\u53d6\u6a21\u5c31\u597d\u5566\u3002\n\n\u4ee3\u7801\uff1a\n\n~~~cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define ll long long\nusing namespace std;\nconst int M=1e6+10;\nconst ll Mod=19491001;\nchar s[M];\nll k,A[M],n,w;\nll inv_k,inv_k2;\nvoid readin(){\n\tscanf(\"%s\",s);\n\tint len=strlen(s);\n\tfor(int i=0;i<len;i++){\n\t\tn=(n*10ll%Mod+(s[i]&15))%Mod;\n\t}\tw=(n-1+Mod)%Mod;\n}\nll Sqr(ll a){return a*a%Mod;}\nll fpow(ll a,ll b){\n\tll ans=1;\n\tfor(;b;b>>=1,a=(a*a)%Mod)if(b&1)ans=(ans*a)%Mod;\n\treturn ans;\n}\nll ans,sum1,sum2;\nint main(){\n\treadin();\n\tscanf(\"%lld\",&k);\n\tfor(int i=0;i<k;i++){\n\t\tscanf(\"%lld\",&A[i]);\n\t\tsum1=(sum1+A[i])%Mod;\n\t\tif(i)sum2=(sum2+(A[i-1]+A[i])%Mod)%Mod;\n\t}\tsum2=(sum2+(A[0]+A[k-1])%Mod)%Mod;\n\tinv_k=fpow(k,Mod-2);\n\tinv_k2=(Sqr(inv_k)%Mod*w)%Mod;inv_k=(inv_k*n)%Mod;\n\tans=(sum1*inv_k%Mod+sum2*inv_k2%Mod)%Mod;\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n~~~\n\n\u4e0b\u9762\u8fd8\u6709\u4e00\u79cd\u89e3\u6cd5\uff0c\u7531$\\rm hdxrie$|Orz|\u63d0\u4f9b\uff1a\n\n\u6211\u4eec\u5148\u4e0d\u8003\u8651\u5f00\u5934\u7ed3\u5c3e\uff0c\u90a3\u4e48\u6bcf\u4e2a\u6570\u90fd\u6709\u524d\u540e\uff1a\n\n\u6211\u4eec\u8003\u8651\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u4f4d\u7f6e\u7684\u52a8\u4f5c\uff0c\u5b83\u524d\u540e\u90fd\u4e0d\u662f\u7ec4\u5408\u6280\uff0c\u90a3\u4e48\u53ea\u4f1a\u8d21\u732e\u4e00\u6b21\uff0c\u90a3\u4e48\u524d\u9762\u4e0d\u662f\u548c\u5b83\u7ec4\u5408\u7684\u6982\u7387\u4e3a$\\frac{k-1}{k}$\uff0c\u540e\u9762\u4e0d\u662f\u548c\u5b83\u7ec4\u5408\u7684\u6982\u7387\u4e3a$\\frac{k-1}{k}$\uff0c\u7136\u540e\u5f53\u524d\u9009\u8fd9\u4e2a\u7684\u6982\u7387\u4e3a$\\frac{1}{k}$\uff0c\u6709$n-2$\u4e2a\u4f4d\u7f6e\u53ef\u4ee5\u8fd9\u6837\u9009\uff0c\u90a3\u4e48\u8d21\u732e\u4e3a$(\\frac{k-1}{k})^2\\times \\frac{1}{k}\\times val_i\\times (n-2)$\n\n\u5bf9\u4e8e\u53ef\u4ee5\u5f62\u6210\u7ec4\u5408\u6280\u7684\uff08\u8fd9\u91cc\u53ea\u8003\u8651\u7ec4\u6210\u4e00\u4e2a\uff09\uff0c\u90a3\u4e48\u5c31\u662f\u540e\u9762\u548c\u5b83\u7ec4\u5408\uff0c\u524d\u9762\u4e0d\u7ec4\u5408\uff1b\u6216\u8005\u524d\u9762\u7ec4\u5408\uff0c\u540e\u9762\u4e0d\u7ec4\u5408\u3002\u90a3\u4e48\u8d21\u732e\u5c31\u4e3a$\\left(\\frac{k-1}{k}\\times \\left(\\frac{1}{k}\\right)^2\\times val_i\\times 2\\times (n-2)\\right)\\times 2$\uff08\u8fd9\u65f6$val_i$\u8981\u7b97\u4e24\u6b21\u8d21\u732e\uff0c\u540c\u6837\u8fd8\u662f\u6709$n-2$\u4e2a\u53ef\u4ee5\u7684\u4f4d\u7f6e\uff09\n\n\u5bf9\u4e8e\u524d\u540e\u90fd\u53ef\u4ee5\u7ec4\u5408\u7684\uff0c\u6982\u7387\u4e3a$\\left(\\frac{1}{k}\\right)^3$\uff0c\u6240\u4ee5\u8d21\u732e\u4e3a$\\left(\\frac{1}{k}\\right)^3\\times val_i\\times 3\\times (n-2)$\uff08\u8fd9\u91cc\u8981\u7b97\u524d\u540e\u4e09\u6b21\uff09\n\n\u7136\u540e\u5bf9\u4e8e\u5f00\u59cb\u548c\u7ed3\u5c3e\u4e24\u4e2a\u5355\u72ec\u7684\uff0c\u6211\u4eec\u8003\u8651\u7ec4\u4e0d\u7ec4\u5408\uff0c\u90a3\u4e48\u7ec4\u5408\u8d21\u732e\u4e3a$\\frac{1}{k}\\times \\frac{1}{k}\\times val_i\\times 2$\uff0c\u4e0d\u7ec4\u5408\u7684\u4e3a$\\frac{1}{k}\\times \\frac{k-1}{k}\\times val_i\\times 2$\uff0c\u524d\u540e\u4e00\u6837\u6240\u4ee5$\u00d72$\u3002\n\n\u4e0b\u9762\u4e0a\u4ee3\u7801\n\n~~~cpp\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\n#define LL long long\nusing namespace std;\nconst int N=1000010;\nconst LL mod=19491001;\nchar num[N];int len;\nLL n,m,inv1,inv2,inv3,val,ans,sum;\nLL power(LL a,LL p)\n{\n    LL v=1;\n    for(;p;p>>=1,a=a*a%mod)\n     if(p&1)v=v*a%mod;\n    return v;\n}\nint main()\n{\n    scanf(\"%s%lld\",num+1,&m);\n    len=strlen(num+1);inv1=power(m,mod-2);\n    inv2=inv1*inv1%mod;inv3=inv2*inv1%mod;\n    for(int i=1;i<=len;i++)\n     n=(n*10+num[i]-'0')%mod;\n    for(int i=1;i<=m;i++)\n     scanf(\"%lld\",&val),(sum+=val)%=mod;\n    (ans+=2ll*sum%mod*(m-1)%mod*inv2%mod)%=mod;\n    (ans+=4ll*sum%mod*inv2%mod)%=mod;\n    (ans+=(n-2)*sum%mod*(m*m%mod-2*m+1)%mod*inv3%mod)%=mod;\n    (ans+=4ll*(n-2)%mod*sum%mod*(m-1)%mod*inv3%mod)%=mod;\n    (ans+=3ll*(n-2)%mod*sum%mod*inv3%mod)%=mod;\n    if(ans<0)ans+=mod;printf(\"%lld\\n\",ans);\n    return 0;\n}\n~~~\n\n---\n\n## End~",
        "postTime": 1541667763,
        "uid": 62235,
        "name": "TimeTraveller",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5011 \u3010\u6c34\u306e\u9020\u9898\u3011"
    },
    {
        "content": "\u6709\u4efb\u4f55\u5173\u4e8e\u6b64\u7bc7\u9898\u89e3\u7684\u95ee\u9898\u7686\u53ef\u79c1\u4fe1[\u6211](https://www.luogu.com.cn/user/101868)\u3002\n\n### \u9898\u76ee\u5206\u6790\n\n\u671f\u671b\u9898\u3002\n\n\u7531\u9898\u610f\u53ef\u77e5**\u6700\u540e\u7684\u5a01\u529b\u7b49\u4e8e\u4f7f\u7528\u7684\u52a8\u4f5c\u5a01\u529b\u503c\u4e4b\u548c\u52a0\u4e0a\u76f8\u90bb\u7684\u52a8\u4f5c\u8d21\u732e\u548c**\u3002\n\n\u63a5\u4e0b\u6765\u6709\u8bb8\u591a\u6982\u7387\u8bba\u672f\u8bed~~\u4e0d\u61c2\u8bf7\u51fa\u95e8\u53f3\u8f6c\u767e\u5ea6\u4e00\u4e0b~~\u3002\n\n\u7ffb\u5f00\u300a\u6982\u7387\u8bba\u4e0e\u6570\u7406\u7edf\u8ba1\u300b98 \u9875\u3002\n\n- \u8bbe $C$ \u662f\u5e38\u6570\uff0c\u5219\u6709\n$$E(C)=C.$$\n- \u8bbe $X$ \u662f\u4e00\u4e2a\u968f\u673a\u53d8\u91cf\uff0c$C$ \u662f\u5e38\u6570\uff0c\u5219\u6709\n$$E(CX)=CE(X).$$\n- \u8bbe $X$ \u548c $Y$ \u662f\u4e24\u4e2a\u968f\u673a\u53d8\u91cf\uff0c\u5219\u6709\n$$E(X+Y)=E(X)+E(Y).$$\n- \u8bbe $X$ \u548c $Y$ \u662f\u4e24\u4e2a**\u76f8\u4e92\u72ec\u7acb**\u7684\u968f\u673a\u53d8\u91cf\uff0c\u5219\u6709\n$$E(XY)=E(X)E(Y).$$\n\n\u4f9d\u7167\u6b64\u9898\u5f15\u5165\u968f\u673a\u53d8\u91cf\uff1a\n$$X_i=S(a_i+a_{i \\ mod \\ k+1}),i=1,2,\\cdots,k$$\n\u8868\u793a\u7b2c $i$ \u4e2a\u52a8\u4f5c\u540e\u7d27\u63a5\u7740\u7b2c $i \\ mod \\ k+1$ \u4e2a\u52a8\u4f5c\u4e8c\u5143\u7ec4\u5408\u5728\u640f\u51fb\u64cd\u4e2d\u7684\u671f\u671b\u8d21\u732e\u3002\n\n\u5176\u4e2d\n$$S=\\frac{n-1}{k^2}$$\n\u8868\u793a\u7b2c $i$ \u4e2a\u52a8\u4f5c\u540e\u7d27\u63a5\u7740\u7b2c $(i \\ mod \\ k+1)$ \u4e2a\u52a8\u4f5c\u4e8c\u5143\u7ec4\u5408\u5728\u640f\u51fb\u64cd\u4e2d\u51fa\u73b0\u7684\u671f\u671b\u6b21\u6570\u3002\n\n\u518d\u5f15\u5165\u968f\u673a\u53d8\u91cf\uff1a\n$$Y_i=\\frac{n}{k}a_i,i=1,2,\\cdots,k$$\n\u8868\u793a\u7b2c $i$ \u4e2a\u52a8\u4f5c\u5355\u4e2a\u5728\u640f\u51fb\u64cd\u4e2d\u7684\u671f\u671b\u8d21\u732e\u3002\n\n\u8bbe\u6700\u7ec8\u7b54\u6848\u7684\u968f\u673a\u53d8\u91cf\u4e3a $A$\u3002\n\n\u6240\u4ee5\u6700\u7ec8\u7b54\u6848\u7684\u671f\u671b\u4e3a\uff1a\n$$E(A)=E(\\sum_{i=1}^kX_i+\\sum_{i=1}^kY_i)$$\n\u5f00\u59cb\u7528\u5f00\u5934\u4ecb\u7ecd\u7684\u516c\u5f0f\u5316\u7b80\uff1a\n$$E(A)=E(\\sum_{i=1}^kS(a_i+a_{i \\ mod \\ k+1})+\\sum_{i=1}^k\\frac{n}{k}a_i)$$\n$$E(A)=E(2S\\sum_{i=1}^ka_i+\\frac{n}{k}\\sum_{i=1}^ka_i)$$\n$$E(A)=E((2S+\\frac{n}{k})\\sum_{i=1}^ka_i)$$\n$$E(A)=E(2S+\\frac{n}{k})\\times E(\\sum_{i=1}^ka_i)$$\n$$E(A)=(2E(S)+\\frac{n}{k})\\sum_{i=1}^ka_i$$\n\u8bbe\uff1a\n$$sum=\\sum_{i=1}^ka_i$$\n\u5219\uff1a\n$$E(A)=sum\\times(2E(\\frac{n-1}{k^2})+\\frac{n}{k})$$\n$$E(A)=sum\\times(\\frac{2n-2}{k^2}+\\frac{n}{k})$$\n$$E(A)=sum\\times(2n-2+kn)\\times inv(k^2)$$\n\u5176\u4e2d $inv(x)$ \u8868\u793a $x$ \u7684\u4e58\u6cd5\u9006\u5143\n### Details\n\n\u522b\u5fd8\u4e86\u5f00 `long long` \u548c\u53d6\u6a21\u3002\n\n$n\\leq 10^{10^6}$ \u4f46\u4e0d\u7528\u9ad8\u7cbe\u5ea6\uff0c\u5199\u4e2a\u5e26\u6a21\u5feb\u8bfb\u5373\u53ef\u3002\n\n### ACcode\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define FOR(i,j,k) for(register ll i=j;(j<k)?(i<=k):(i>=k);i+=(j<k)?1:(-1))\n#define mod 19491001\nll read(){//\u5e26\u6a21\u5feb\u8bfb \n\tchar k = getchar(); \n\tll x = 0;\n\twhile(k < '0' || k > '9') k = getchar();\n\twhile(k >= '0' && k <= '9') x = (x * 10 + k - '0') % mod ,k = getchar();\n\treturn x;\n}\n\nll n,k,sum=0,ans; \nll pw(ll x,ll y){//\u5feb\u901f\u5e42\uff08\u4e0e\u9898\u76ee\u7ed9\u7684\u7565\u6709\u4e0d\u540c\uff09 \n\tif(y==0)return 1ll;\n\tll res=pw(x,y/2);\n\tres=res*res%mod;\n\tif(y%2)res=res*x%mod;\n\treturn res;\n}\nll inv(ll x){//\u8d39\u9a6c\u5c0f\u5b9a\u7406\u6c42\u9006\u5143 \n\treturn pw(x,mod-2);\n}\nsigned main(){\n    n=read();\n    scanf(\"%lld\",&k);\n    ll x;\n    FOR(i,1,k){\n    \tscanf(\"%lld\",&x);\n    \tsum=(sum+x)%mod;\n\t}\n\tll ivk=inv(k);//inv of k\n\tans=(n*k%mod+2*n-2)%mod*sum%mod*ivk%mod*ivk%mod;\n\tprintf(\"%lld\",ans);\n    return 0;\n}\n```",
        "postTime": 1627213516,
        "uid": 101868,
        "name": "I_am_Accepted",
        "ccfLevel": 0,
        "title": "P5011\u9898\u89e3"
    }
]
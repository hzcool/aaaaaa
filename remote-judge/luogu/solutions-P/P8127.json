[
    {
        "content": "\u9898\u76ee\u94fe\u63a5\uff1a[https://www.luogu.com.cn/problem/P8127](https://www.luogu.com.cn/problem/P8127)\n\n\u9898\u76ee\u5927\u610f\uff1a\u7ed9\u5b9a\u4e00\u68f5\u5305\u542b $n$ \u4e2a\u8282\u70b9\u7684\u6811\uff0c\u6811\u4e0a\u6bcf\u4e2a\u70b9\u90fd\u6709\u4e00\u4e2a\u6743\u503c\uff0c\u8282\u70b9 $i$ \u7684\u6743\u503c\u4e3a $a_i(a_i \\in \\{0,1\\})$\u3002\u6bcf\u6b21\u53ef\u4ee5\u9009\u62e9\u6811\u4e0a\u4e00\u4e2a\u70b9\uff0c\u5c06\u8fd9\u4e2a\u70b9\u4ee5\u53ca\u4e0e\u5176\u76f8\u90bb\u7684\u6240\u6709\u70b9\u7684\u6743\u503c\u53d6\u53cd\uff08$0$ \u53d8\u6210 $1$\uff0c$1$ \u53d8\u6210 $0$\uff09\u3002\u95ee\uff1a\u6700\u5c11\u9700\u8981\u51e0\u6b21\u64cd\u4f5c\u80fd\u591f\u8ba9\u6811\u4e0a\u6240\u6709\u70b9\u7684\u6743\u503c\u90fd\u53d8\u4e3a $0$\uff1f  \n\n\u6211\u7684\u601d\u8def\uff1a\n\n\u9996\u5148\u662f\u6811\u5f62DP\uff0c\u6bcf\u4e2a\u8282\u70b9 $u$ \u5bf9\u5e94 $4$ \u4e2a\u72b6\u6001\uff1a\n- $f_{u,0}$ \u8868\u793a\u8282\u70b9\u6743\u503c\u4e3a $0$\uff0c\u6ca1\u6709\u5bf9\u8282\u70b9\u8fdb\u884c\u64cd\u4f5c\u65f6\u5bf9\u5e94\u7684\u6700\u5c0f\u64cd\u4f5c\u6b21\u6570\uff1b\n- $f_{u,1}$ \u8868\u793a\u8282\u70b9\u6743\u503c\u4e3a $1$\uff0c\u6ca1\u6709\u5bf9\u8282\u70b9\u8fdb\u884c\u64cd\u4f5c\u65f6\u5bf9\u5e94\u7684\u6700\u5c0f\u64cd\u4f5c\u6b21\u6570\uff1b\n- $f_{u,2}$ \u8868\u793a\u8282\u70b9\u6743\u503c\u4e3a $0$\uff0c\u6709\u5bf9\u8282\u70b9\u8fdb\u884c\u64cd\u4f5c\u65f6\u5bf9\u5e94\u7684\u6700\u5c0f\u64cd\u4f5c\u6b21\u6570\uff1b\n- $f_{u,3}$ \u8868\u793a\u8282\u70b9\u6743\u503c\u4e3a $1$\uff0c\u6709\u5bf9\u8282\u70b9\u8fdb\u884c\u64cd\u4f5c\u65f6\u5bf9\u5e94\u7684\u6700\u5c0f\u64cd\u4f5c\u6b21\u6570\u3002\n\n\u4e0a\u8ff0\u6240\u6709\u72b6\u6001\uff08\u5373 $f_{u,0},f_{u,1},f_{u,2},f_{u,3}$\uff09\u56e0\u4e3a\u5bf9\u4e8e\u8282\u70b9 $u$ \u7684\u975e\u5b50\u5b59\u8282\u70b9\u6765\u8bf4\uff0c\u5b83\u4eec\u662f\u6ca1\u6709\u529e\u6cd5\u4fee\u6539\u8282\u70b9 $u$ \u7684\u5b50\u5b59\u8282\u70b9\u7684\u72b6\u6001\u7684\uff0c\u6240\u4ee5\u6240\u6709\u7684 $f_{u,i}(0 \\le i \\le 3)$ \u5bf9\u5e94\u7684\u72b6\u6001\u8fd8\u5305\u542b\u7684\u4e00\u4e2a\u4fe1\u606f\u662f \u2014\u2014 \u8282\u70b9 $u$ \u7684\u6240\u6709\u5b50\u5b59\u8282\u70b9\u5f53\u524d\u7684\u6743\u503c\u90fd\u4e3a $0$\u3002\n\n\u540c\u65f6\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u90fd\u4e0d\u8003\u8651\u7236\u8282\u70b9\u7684\u5f71\u54cd\uff08\u56e0\u4e3a\u6211\u8fd9\u91cc\u7684\u72b6\u6001\u90fd\u662f\u6839\u636e\u5b50\u8282\u70b9\u7684\u72b6\u6001\u63a8\u5bfc\u5f53\u524d\u8282\u70b9\u7684\u72b6\u6001\uff09\u3002\n\n\u9664\u6b64\u4e4b\u5916\uff0c\u6211\u7528 $f_{u,i} = +\\infty$ \u6765\u8868\u793a\u72b6\u6001 $f_{u,i}$ \u4e0d\u5408\u6cd5\u3002   \n\n\u7136\u540e\u5c31\u53ef\u4ee5\u63a8\u5bfc\u6240\u6709\u7684\u72b6\u6001\u4e86\u3002  \n\n### \u53f6\u5b50\u8282\u70b9\n\n\u5bf9\u4e8e\u53f6\u5b50\u8282\u70b9 $u$ \u6765\u8bf4\uff1a\n- \u5982\u679c $a_u = 1$\uff08\u4e5f\u5c31\u662f\u539f\u59cb\u8282\u70b9\u7684\u6743\u503c\u4e3a $1$\uff09\uff0c\u5219\uff1a\n    - $f_{u,0} = +\\infty$\uff08\u56e0\u4e3a\u53f6\u5b50\u8282\u70b9\u4e0d\u64cd\u4f5c\u7684\u8bdd\u65e0\u6cd5\u8ba9\u8282\u70b9\u6743\u503c\u53d8\u6210 $0$\uff09\n    - $f_{u,1} = 0$\uff08\u56e0\u4e3a\u672c\u8eab\u8282\u70b9\u6743\u503c\u5c31\u4e3a $1$\uff09\n    - $f_{u,2} = 1$\uff08\u56e0\u4e3a\u64cd\u4f5c\u4e00\u6b21\u6070\u597d\u8ba9\u8282\u70b9\u6743\u503c\u53d8\u6210 $0$\uff09\n    - $f_{u,3} = +\\infty$\uff08\u56e0\u4e3a\u64cd\u4f5c\u4e00\u6b21\u4e4b\u540e\u8282\u70b9\u6743\u503c\u53d8\u6210\u4e86 $0$\uff0c\u800c\u4e0d\u662f $1$\uff09\n- \u5982\u679c $a_u = 0$\uff08\u4e5f\u5c31\u662f\u539f\u59cb\u8282\u70b9\u7684\u6743\u503c\u4e3a $0$\uff09\uff0c\u5219\uff1a\n    - $f_{u,0} = 0$\uff08\u56e0\u4e3a\u672c\u8eab\u8282\u70b9\u6743\u503c\u5c31\u4e3a $0$\uff09\n    - $f_{u,1} = +\\infty$\uff08\u56e0\u4e3a\u53f6\u5b50\u8282\u70b9\u4e0d\u64cd\u4f5c\u7684\u8bdd\u65e0\u6cd5\u8ba9\u8282\u70b9\u6743\u503c\u53d8\u6210 $1$\uff09\n    - $f_{u,2} = +\\infty$\uff08\u56e0\u4e3a\u64cd\u4f5c\u4e00\u6b21\u4e4b\u540e\u8282\u70b9\u6743\u503c\u53d8\u6210\u4e86 $1$\uff0c\u800c\u4e0d\u662f $0$\uff09\n    - $f_{u,3} = 1$\uff08\u56e0\u4e3a\u64cd\u4f5c\u4e00\u6b21\u6070\u597d\u8ba9\u8282\u70b9\u6743\u503c\u53d8\u6210 $1$\uff09\n\n### \u975e\u53f6\u5b50\u8282\u70b9\n\n\u5bf9\u4e8e\u5f53\u524d\u8282\u70b9 $u$ \u6765\u8bf4\uff0c\u53ea\u6709\u53ef\u80fd\u64cd\u4f5c\u6216\u8005\u4e0d\u64cd\u4f5c\u3002\n\n- \u5982\u679c\u9009\u62e9\u4e0d\u64cd\u4f5c\uff0c\u5219\u5b83\u7684\u5b50\u8282\u70b9\u7684\u72b6\u6001\u5fc5\u987b\u90fd\u662f $0$\uff08\u8bbe\u5b50\u8282\u70b9\u4e3a $v$\uff0c\u5219\u6b64\u65f6\u53ea\u8ddf $f_{v,0}$\u3001$f_{v,2}$ \u6709\u5173\uff09\n- \u5982\u679c\u9009\u62e9\u64cd\u4f5c\uff0c\u5219\u5b83\u7684\u5b50\u8282\u70b9\u7684\u72b6\u6001\u5fc5\u987b\u90fd\u662f $1$\uff08\u8bbe\u5b50\u8282\u70b9\u4e3a $v$\uff0c\u5219\u6b64\u65f6\u53ea\u8ddf $f_{v,1}$\u3001$f_{v,3}$ \u6709\u5173\uff09\n\n\u4f46\u662f\u8fd9\u91cc\u6709\u4e00\u4e2a\u9700\u8981\u601d\u8003\u7684\u95ee\u9898\uff0c\u5c31\u662f\uff1a\u5f53\u524d\u8282\u70b9 $u$ \u7684\u72b6\u6001\u53d7\u5b50\u8282\u70b9\u4e2d\u8282\u70b9\u7684\u72b6\u6001\u7684\u5f71\u54cd\uff01\n\n\u5f71\u54cd\u4e3b\u8981\u5728\u4e8e \u2014\u2014 \u5b50\u8282\u70b9\u4e2d\u64cd\u4f5c\u8fc7\u7684\u70b9\u662f\u5947\u6570\u4e2a\u8fd8\u662f\u5076\u6570\u4e2a\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u989d\u5916\u5b9a\u4e49\u56db\u4e2a\u72b6\u6001\uff1a$g_{i,0}, g_{i,1}, h_{i,0}, h_{i,1}$\uff0c\u8fd9\u56db\u4e2a\u72b6\u6001\u662f\u5bf9\u4e8e\u5f53\u524d\u8282\u70b9 $u$ \u6765\u8bf4\u7684\u3002\u5bf9\u4e8e\u5f53\u524d\u8282\u70b9 $u$\uff0c\u8bbe\u5176\u6709 $m$ \u4e2a\u5b50\u8282\u70b9\uff0c\u5219\uff1a  \n\n- $g_{i,0}$ \u8868\u793a\u8282\u70b9 $u$ \u7684\u524d $i$ \u4e2a\u5b50\u8282\u70b9\u5168\u90fd\u662f $0$ \u4e14\u6709\u5076\u6570\u4e2a\u64cd\u4f5c\u8fc7\u65f6\u5bf9\u5e94\u7684\u6700\u5c11\u64cd\u4f5c\u6b21\u6570\uff08\u5076\u6570\u4e2a\u64cd\u4f5c\u8fc7\u76f8\u5f53\u4e8e\u5bf9\u8282\u70b9 $u$ \u7684\u72b6\u6001\u6ca1\u5f71\u54cd\uff0c\u5947\u6570\u4e2a\u64cd\u4f5c\u8fc7\u5c31\u4f1a\u5bf9\u8282\u70b9 $u$ \u7684\u72b6\u6001\u9020\u6210\u5f71\u54cd\uff09\uff1b\n- $g_{i,1}$ \u8868\u793a\u8282\u70b9 $u$ \u7684\u524d $i$ \u4e2a\u5b50\u8282\u70b9\u5168\u90fd\u662f $0$ \u4e14\u6709\u5947\u6570\u4e2a\u64cd\u4f5c\u8fc7\u65f6\u5bf9\u5e94\u7684\u6700\u5c11\u64cd\u4f5c\u6b21\u6570\uff1b\n- $h_{i,0}$ \u8868\u793a\u8282\u70b9 $u$ \u7684\u524d $i$ \u4e2a\u5b50\u8282\u70b9\u5168\u90fd\u662f $1$ \u4e14\u6709\u5076\u6570\u4e2a\u64cd\u4f5c\u8fc7\u65f6\u5bf9\u5e94\u7684\u6700\u5c11\u64cd\u4f5c\u6b21\u6570\uff1b\n- $h_{i,1}$ \u8868\u793a\u8282\u70b9 $u$ \u7684\u524d $i$ \u4e2a\u5b50\u8282\u70b9\u5168\u90fd\u662f $1$ \u4e14\u6709\u5947\u6570\u4e2a\u64cd\u4f5c\u8fc7\u65f6\u5bf9\u5e94\u7684\u6700\u5c11\u64cd\u4f5c\u6b21\u6570\n\n\u9996\u5148\uff1a\n\n- $g_{0,0} = h_{0,0} = 0$\n- $g_{0,1} = h_{0,1} = +\\infty$\n\n\u5176\u6b21\uff0c\u5f53 $i \\gt 0$ \u65f6\uff0c\uff08\u8bbe\u8282\u70b9 $u$ \u7684\u7b2c $i$ \u4e2a\u5b50\u8282\u70b9\u4e3a $v$\uff0c\u5219\uff09\u6709\uff1a\n\n- $g_{i,0} = \\min \\{ g_{i-1,0} + f_{v,0}, g_{i-1,1} + f_{v,2} \\}$\n- $g_{i,1} = \\min \\{ g_{i-1,0} + f_{v,2}, g_{i-1,1} + f_{v,0} \\}$\n- $h_{i,0} = \\min \\{ h_{i-1,0} + f_{v,1}, h_{i-1,1} + f_{v,3} \\}$\n- $h_{i,1} = \\min \\{ h_{i-1,0} + f_{v,3}, h_{i-1,1} + f_{v,1} \\}$\n\n\u5f53\u7136\u6211\u4eec\u9700\u8981\u7684\u53ea\u6709\u6700\u7ec8\u8ba1\u7b97\u51fa\u6765\u7684 $g_{m,0}, g_{m,1}, h_{m,0}, h_{m,1}$ \u8fd9\u56db\u4e2a\u72b6\u6001\uff08\u5176\u4e2d $m$ \u662f\u5f53\u524d\u8282\u70b9 $u$ \u7684\u5b50\u8282\u70b9\u4e2a\u6570\uff09\u3002\n\n\u6b64\u65f6\u518d\u5206\u522b\u8ba8\u8bba $a_u$ \u662f $1$ \u8fd8\u662f $0$ \u7684\u60c5\u51b5\u3002  \n\n#### \u5f53 $a_u = 1$ \u65f6\uff1a\n- $f_{u,0} = g_{m,1}$\uff08\u56e0\u4e3a\u672c\u8eab\u662f $1$ \u4e14\u4e0d\u64cd\u4f5c\uff0c\u8981\u53d8\u6210 $0$\uff0c\u6240\u4ee5\u9700\u8981\u5b50\u8282\u70b9\u4e2d\u662f $0$ \u4e14\u64cd\u4f5c\u8fc7\u7684\u6570\u91cf\u662f\u5947\u6570\u4e2a\uff09\n- $f_{u,1} = g_{m,0}$\uff08\u56e0\u4e3a\u672c\u8eab\u5c31\u662f $1$ \u4e14\u4e0d\u64cd\u4f5c\uff0c\u6240\u4ee5\u9700\u8981\u5b50\u8282\u70b9\u4e2d\u662f $0$ \u4e14\u64cd\u4f5c\u8fc7\u7684\u6570\u91cf\u662f\u5076\u6570\u4e2a\uff09\n- $f_{u,2} = 1 + h_{m,0}$\uff08\u56e0\u4e3a\u672c\u8eab\u662f $1$\uff0c\u64cd\u4f5c\u4e00\u6b21\u81ea\u5df1\u53d8\u6210 $0$\uff0c\u6240\u4ee5\u9700\u8981\u5b50\u8282\u70b9\u662f $1$ \u4e14\u64cd\u4f5c\u8fc7\u7684\u6570\u91cf\u662f\u5076\u6570\u4e2a\uff09\n- $f_{u,3} = 1 + h_{m,1}$\uff08\u56e0\u4e3a\u672c\u8eab\u662f $1$\uff0c\u64cd\u4f5c\u4e00\u6b21\u4f1a\u53d8\u6210 $0$\uff0c\u6240\u4ee5\u9700\u8981\u5b50\u8282\u70b9\u662f $1$ \u4e14\u64cd\u4f5c\u8fc7\u7684\u6570\u91cf\u662f\u5947\u6570\u4e2a\uff09\n\n#### \u5f53 $a_u = 0$ \u65f6\uff1a\n- $f_{u,0} = g_{m,0}$\uff08\u56e0\u4e3a\u672c\u8eab\u662f $0$ \u4e14\u4e0d\u64cd\u4f5c\uff0c\u6240\u4ee5\u9700\u8981\u5b50\u8282\u70b9\u4e2d\u662f $0$ \u4e14\u64cd\u4f5c\u8fc7\u7684\u6570\u91cf\u662f\u5076\u6570\u4e2a\uff09\n- $f_{u,1} = g_{m,1}$\uff08\u56e0\u4e3a\u672c\u8eab\u662f $0$ \u4e14\u4e0d\u64cd\u4f5c\uff0c\u8981\u53d8\u6210 $1$\uff0c\u6240\u4ee5\u9700\u8981\u5b50\u8282\u70b9\u4e2d\u662f $0$ \u4e14\u64cd\u4f5c\u8fc7\u7684\u6570\u91cf\u662f\u5947\u6570\u4e2a\uff09\n- $f_{u,2} = 1 + h_{m,1}$\uff08\u56e0\u4e3a\u672c\u8eab\u662f $0$\uff0c\u64cd\u4f5c\u4e00\u6b21\u4f1a\u53d8\u6210 $1$\uff0c\u6240\u4ee5\u9700\u8981\u5b50\u8282\u70b9\u662f $1$ \u4e14\u64cd\u4f5c\u8fc7\u7684\u6570\u91cf\u662f\u5947\u6570\u4e2a\uff09\n- $f_{u,3} = 1 + h_{m,0}$\uff08\u56e0\u4e3a\u672c\u8eab\u662f $0$\uff0c\u64cd\u4f5c\u4e00\u6b21\u81ea\u5df1\u53d8\u6210 $1$\uff0c\u6240\u4ee5\u9700\u8981\u5b50\u8282\u70b9\u662f $1$ \u4e14\u64cd\u4f5c\u8fc7\u7684\u6570\u91cf\u662f\u5076\u6570\u4e2a\uff09\n\n\n\u793a\u4f8b\u7a0b\u5e8f\uff1a  \n\n```c++\n#include <bits/stdc++.h>\nusing namespace std;\nconst int maxn = 1e5 + 5;\nconst int INF = (1<<29);\nint n, a[maxn], f[maxn][4], g[maxn][2], h[maxn][2];\nvector<int> e[maxn];\n\n/**\nf[u][0] \u70b9\u6743\u4e3a 0\uff0c\u70b9\u672a\u64cd\u4f5c\nf[u][1] \u70b9\u6743\u4e3a 1\uff0c\u70b9\u672a\u64cd\u4f5c\nf[u][2] \u70b9\u6743\u4e3a 0\uff0c\u70b9\u6709\u64cd\u4f5c\nf[u][3] \u70b9\u6743\u4e3a 1\uff0c\u70b9\u6709\u64cd\u4f5c\n*/\n\nvoid dfs(int u, int p) {\n    int sz = e[u].size();\n    if (sz == 1 && u != 1) {    // \u53f6\u5b50\u8282\u70b9\n        if (a[u] == 1) {\n            f[u][0] = INF;\n            f[u][1] = 0;\n            f[u][2] = 1;\n            f[u][3] = INF;\n        }\n        else {  // a[u] == 0\n            f[u][0] = 0;\n            f[u][1] = INF;\n            f[u][2] = INF;\n            f[u][3] = 1;\n        }\n        return;\n    }\n    vector<int> tmp;\n    for (auto v : e[u])\n        if (v != p)\n            dfs(v, u), tmp.push_back(v);\n    int m = tmp.size();\n    g[0][0] = h[0][0] = 0;\n    g[0][1] = h[0][1] = INF;\n    for (int i = 1; i <= m; i++) {\n        int v = tmp[i-1];\n        g[i][0] = min(INF, min(g[i-1][0] + f[v][0], g[i-1][1] + f[v][2]));\n        g[i][1] = min(INF, min(g[i-1][0] + f[v][2], g[i-1][1] + f[v][0]));\n        h[i][0] = min(INF, min(h[i-1][0] + f[v][1], h[i-1][1] + f[v][3]));\n        h[i][1] = min(INF, min(h[i-1][0] + f[v][3], h[i-1][1] + f[v][1]));\n    }\n    if (a[u] == 1) {\n        f[u][0] = g[m][1];\n        f[u][1] = g[m][0];\n        f[u][2] = min(INF, 1 + h[m][0]);\n        f[u][3] = min(INF, 1 + h[m][1]);\n    }\n    else {\n        f[u][0] = g[m][0];\n        f[u][1] = g[m][1];\n        f[u][2] = min(INF, 1 + h[m][1]);\n        f[u][3] = min(INF, 1 + h[m][0]);\n    }\n}\n\nint main() {\n    scanf(\"%d\", &n);\n    for (int i = 1; i < n; i++) {\n        int u, v;\n        scanf(\"%d%d\", &u, &v);\n        e[u].push_back(v);\n        e[v].push_back(u);\n    }\n    for (int i = 1; i <= n; i++) scanf(\"%d\", a+i);\n    dfs(1, -1);\n    int ans = min(f[1][0], f[1][2]);\n    if (ans == INF) puts(\"impossible\");\n    else printf(\"%d\\n\", ans);\n    return 0;\n}\n```\n\n",
        "postTime": 1656314201,
        "uid": 291976,
        "name": "quanjun",
        "ccfLevel": 6,
        "title": "\u6d1b\u8c37P8127 [BalticOI 2021 Day2] The Xana coup \u9898\u89e3 \u6811\u5f62DP"
    },
    {
        "content": "## \u5206\u6790\n\n\u5f88\u660e\u663e\uff0c\u64cd\u4f5c\u987a\u5e8f\u5bf9\u7b54\u6848\u65e0\u5f71\u54cd\u3002\n\n\u90a3\u8fd9\u4e00\u9898\u5c31\u662f\u4e00\u4e2a\u5f88\u660e\u663e\u7684\u6811\u5f62dp\u3002\n\n\u8bbe $dp_{i,0/1,0/1}$\uff0c\u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\u4e2d,$i$ \u5728\u64cd\u4f5c\u5b8c\u540e\u503c\u662f\u96f6\u8fd8\u662f\u4e00\u548c\u662f\u5426\u5728 $i$ \u4e0a\u8fdb\u884c\u4e86\u64cd\u4f5c\u3002\n\n\u8003\u8651\u5b50\u6811\u5982\u4f55\u8f6c\u79fb\u5230\u6839\u3002\n\n\u5018\u82e5 $i$ \u4e0d\u8fdb\u884c\u64cd\u4f5c\uff0c\u4e14\u5b50\u6811\u7684\u6839\u4fdd\u6301\u539f\u6765\u7684\u72b6\u6001\uff0c\u90a3\u4e48\u5c31\u8981\u6ee1\u8db3\u5b83\u7684\u5b50\u6811\u7684\u6839\u90fd\u5fc5\u987b\u662f\u96f6\uff0c\u800c\u4e14\u6709\u5076\u6570\u4e2a\u8fdb\u884c\u4e86\u64cd\u4f5c\u3002\n\n\u5018\u82e5 $i$ \u4e0d\u8fdb\u884c\u64cd\u4f5c\uff0c\u4e14\u5b50\u6811\u7684\u6839\u4e0d\u4fdd\u6301\u539f\u6765\u7684\u72b6\u6001\uff0c\u90a3\u4e48\u5c31\u8981\u6ee1\u8db3\u5b83\u7684\u5b50\u6811\u7684\u6839\u90fd\u5fc5\u987b\u662f\u96f6\uff0c\u800c\u4e14\u6709\u5947\u6570\u4e2a\u8fdb\u884c\u4e86\u64cd\u4f5c\u3002\n\n\u5018\u82e5 $i$ \u8fdb\u884c\u64cd\u4f5c\uff0c\u4e14\u5b50\u6811\u7684\u6839\u4e0d\u4fdd\u6301\u539f\u6765\u7684\u72b6\u6001\uff0c\u90a3\u4e48\u5c31\u8981\u6ee1\u8db3\u5b83\u7684\u5b50\u6811\u7684\u6839\u90fd\u5fc5\u987b\u662f\u4e00\uff0c\u800c\u4e14\u6709\u5076\u6570\u4e2a\u8fdb\u884c\u4e86\u64cd\u4f5c\u3002\n\n\u5018\u82e5 $i$ \u8fdb\u884c\u64cd\u4f5c\uff0c\u4e14\u5b50\u6811\u7684\u6839\u4fdd\u6301\u539f\u6765\u7684\u72b6\u6001\uff0c\u90a3\u4e48\u5c31\u8981\u6ee1\u8db3\u5b83\u7684\u5b50\u6811\u7684\u6839\u90fd\u5fc5\u987b\u662f\u4e00\uff0c\u800c\u4e14\u6709\u5947\u6570\u4e2a\u8fdb\u884c\u4e86\u64cd\u4f5c\u3002\n\n\u90a3\u4e48\u5c31\u53ea\u8981\u89e3\u51b3\u7ef4\u62a4 $i$ \u7684\u5b50\u6811\u7684\u8d21\u732e\u548c\u3002\n\n\u8fd9\u91cc\u53ef\u4ee5\u518d\u8bbe\u4e00\u4e2a $f_{i,0/1,0/1}$\uff0c\u8868\u793a\u5904\u7406\u5b8c\u7b2c $i$ \u4e2a\u5b50\u6811\uff0c\u5f53\u524d\u64cd\u4f5c\u6570\u91cf\u4e3a\u5076\u6570\u8fd8\u662f\u5947\u6570\uff0c\u6839\u8981\u4e0d\u8981\u8fdb\u884c\u64cd\u4f5c\u3002\n\n\u90a3\u4e48\u5c31\u6709\uff1a\n\n$f_{i,0,0}=\\min(f_{i-1,1,0}+dp_{v,0,1},f_{i-1,0,0}+dp_{v,0,0})$\n\n$f_{i,1,0}=\\min(f_{i-1,1,0}+dp_{v,0,0},f_{i-1,0,0}+dp_{v,0,1})$\n\n$f_{i,0,1}=\\min(f_{i-1,1,1}+dp_{v,1,1},f_{i-1,0,1}+dp_{v,1,0})$\n\n$f_{i,1,1}=\\min(f_{i-1,1,1}+dp_{v,1,0},f_{i-1,1,0}+dp_{v,1,1})$\n\n\u6700\u540e\u518d\u628a $f$ \u7684\u8d21\u732e\u52a0\u5230 $dp$ \u91cc\u53bb\u4e86\u3002\n\n### code\n\n ```\n #include<bits/stdc++.h>\n#define in inline\n#define re register\n//#define int long long\nusing namespace std;\nin int read(){\n\tint x=0,f=1;\n\tchar c;\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\n\treturn x*f;\n}\nconst int N=1e5+10;\nint h[N],nex[N<<1],to[N<<1],tot,inf;\nint dp[N][2][2];\nbool a[N];\nint n;\nint out[N];\nint ans;\nvoid add(int x,int y){to[++tot]=y,nex[tot]=h[x],h[x]=tot;}\nin int gmin(int x){\n\treturn min(inf,x);\n}\nin void dfs(int u,int fa){\n\tif(out[u]==1&&fa!=0){\n\t\tdp[u][a[u]][0]=0;\n\t\tdp[u][a[u]^1][1]=1;\n\t\treturn;\n\t}\n\tre int f00,f10,h01,h11;\n\tre bool fl=0;\n\tfor(re int i=h[u];i;i=nex[i]){\n\t\tre int v=to[i];\n\t\tif(v==fa)continue;\n\t\tdfs(v,u);\n\t\tif(!fl){\n\t\t\tfl=1;\n\t\t\tf00=dp[v][0][0],f10=dp[v][0][1],h01=dp[v][1][0],h11=dp[v][1][1];\t\t//\u628a f \u521d\u59cb\u5316\u3002 \n\t\t\tcontinue;\n\t\t}\n\t\tre int bf00=f00,bf10=f10,bh01=h01,bh11=h11;\n\t\tf00=min(gmin(bf10+dp[v][0][1]),gmin(bf00+dp[v][0][0]));\t\t\t//\u8f6c\u79fb\u3002 \n\t\tf10=min(gmin(bf10+dp[v][0][0]),gmin(bf00+dp[v][0][1]));\n\t\th01=min(gmin(bh11+dp[v][1][1]),gmin(bh01+dp[v][1][0]));\n\t\th11=min(gmin(bh11+dp[v][1][0]),gmin(bh01+dp[v][1][1]));\n\t}\n\tdp[u][a[u]][0]=gmin(f00),dp[u][a[u]^1][0]=gmin(f10),dp[u][a[u]^1][1]=gmin(h01+1),dp[u][a[u]][1]=gmin(h11+1);\n}\nsigned main(){\n\tn=read();\n\tfor(re int i=1;i<n;i++){\n\t\tre int x=read(),y=read();\n\t\tadd(x,y),add(y,x);\n\t\tout[x]++,out[y]++;\n\t}\n\tfor(re int i=1;i<=n;i++)a[i]=read();\n\tmemset(dp,0x3f,sizeof(dp));\t\t\t\t//\u521d\u59cb\u8bbe\u4e3a\u65e0\u7a77\u3002 \n\tinf=dp[0][0][0];\n\tdfs(1,0);\n\tans=min(dp[1][0][0],dp[1][0][1]);\n\tif(ans!=inf)\n\tcout<<ans;\n\telse puts(\"impossible\");\n\treturn 0;\n}\n\n ```",
        "postTime": 1671850643,
        "uid": 186240,
        "name": "seanli",
        "ccfLevel": 0,
        "title": "P8127\u9898\u89e3"
    },
    {
        "content": "\u63d0\u4f9b\u4e0d\u540c\u7684\u72b6\u6001\u8bbe\u8ba1\uff1a\n\n\u8bbe $f_{u,0/1,0/1}$ \u8868\u793a $u$ \u8282\u70b9\u662f\u5426\u8fdb\u884c\u64cd\u4f5c\uff0c\u53ca\u5f53\u524d\u4e3a $0/1$ \u72b6\u6001\u3002\n\n\u53ef\u4ee5\u624b\u73a9\u51fa\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n1. $f_{u,0,0} =\\sum_{v \\in E_{u}} min(f_{v,0,0},f_{v,1,0})$\n\n2. $f_{u,0,1} =\\sum_{v \\in E_{u}} min(f_{v,0,0},f_{v,1,0})$\n\n3. $f_{u,1,0} =\\sum_{v \\in E_{u}} min(f_{v,0,1},f_{v,1,1})$\n\n4. $f_{u,1,1} =\\sum_{v \\in E_{u}} min(f_{v,0,1},f_{v,1,1})$\n\n\u4e14\u6709\u5f53\uff1a\n\n$if(cnt \\mod 2=0 \\&\\& a[u]=1|| cnt \\mod 2=1 \\&\\& a[u]=0) f_{u,1,0}+=\\min_{v \\in E_{u}} |f_{v,0,0}-f_{v,1,0}|$\n\n$if(cnt \\mod 2=1 \\&\\& a[u]=1|| cnt \\mod 2=0 \\&\\& a[u]=0) f_{u,1,0}+=\\min_{v \\in E_{u}} |f_{v,0,0}-f_{v,1,0}|$\n\n$if(cnt \\mod 2=1 \\&\\& a[u]=1|| cnt \\mod 2=0 \\&\\& a[u]=0) f_{u,1,0}+=\\min_{v \\in E_{u}} |f_{v,0,1}-f_{v,1,1}|$\n\n$if(cnt \\mod 2=0 \\&\\& a[u]=1|| cnt \\mod 2=1 \\&\\& a[u]=0) f_{u,1,0}+=\\min_{v \\in E_{u}} |f_{v,0,1}-f_{v,1,1}|$\n\n\u6700\u540e\u7b54\u6848\u4e3a\uff1a $min(f_{rt,0,0},f_{rt,1,0})$\n\nCode:\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<queue>\n#include<cstring>\n#define N 100010\n#define int long long\n#define Inf 0x3f3f3f3f\nusing namespace std;\n//typedef long long ll;\ninline int read(){\n\tregister int d=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){d = (d<<1)+(d<<3)+(ch^48);ch=getchar();}\n\treturn d*f;\n}\nstruct Edge{\n\tint v,w,nxt;\n}edge[N<<1];\nint head[N],ecnt;\ninline void add(int u,int v){\n\tedge[++ecnt].v=v;\n\tedge[ecnt].nxt=head[u];\n\thead[u]=ecnt;\n}\nint a[N],n,Flag;\nint f[N][2][2];\nvoid dfs(int u,int fa){\n//\tif(!edge[head[u]].nxt&&u!=1){\n\t\tf[u][0][0]=(a[u]==0)?0:Inf;\n\t\tf[u][0][1]=(a[u]==1)?0:Inf;\n\t\tf[u][1][1]=(a[u]==0)?1:Inf;\n\t\tf[u][1][0]=(a[u]==1)?1:Inf;\n//\t\tprintf(\"%d %d %d %d\\n\",f[u][0][0],f[u][0][1],f[u][1][0],f[u][1][1]);\n//\t\treturn ;\n//\t}\n\tfor(int i=head[u];i;i=edge[i].nxt){\n\t\tint v=edge[i].v;\n\t\tif(v==fa) continue;\n\t\tdfs(v,u);\n\t}\n\tint cnt=0,tmp1=0,tmp2=0,tmp3=0,tmp4=0;\n\tbool flag=false,Flag=false;\n\tfor(int i=head[u];i;i=edge[i].nxt){\n\t\tint v=edge[i].v;\n\t\tif(v==fa) continue;\n\t\tif(f[v][0][0]<f[v][1][0]){}\n\t\telse if(f[v][0][0]>f[v][1][0]) cnt++;\n\t\telse flag=true;\n\t\tif(min(f[v][0][0],f[v][1][0])>=Inf) Flag=true;\n\t\ttmp1+=min(f[v][0][0],f[v][1][0]);\n\t\ttmp2+=min(f[v][0][0],f[v][1][0]);\n\t}\n\tif(!flag){\n\t\tint minx=Inf;\n\t\tfor(int i=head[u];i;i=edge[i].nxt){\n\t\t\tint v=edge[i].v;\n\t\t\tif(v==fa) continue;\n\t\t\tminx=min(minx,abs(f[v][0][0]-f[v][1][0]));\n\t\t}\n\t\tif((cnt%2==0&&a[u]==1)||(cnt%2==1&&a[u]==0)){\n\t\t\ttmp1+=minx;\n\t\t}\n\t\tif((cnt%2==1&&a[u]==1)||(cnt%2==0&&a[u]==0)){\n\t\t\ttmp2+=minx;\n\t\t}\n\t}\n\tif(Flag){\n\t\tf[u][0][0]=f[u][0][1]=Inf;\n\t}\n\tf[u][0][0]=tmp1;\n\tf[u][0][1]=tmp2;\n\tcnt=0;\n\tflag=false;Flag=false;\n\tfor(int i=head[u];i;i=edge[i].nxt){\n\t\tint v=edge[i].v;\n\t\tif(v==fa) continue;\n\t\tif(f[v][0][1]<f[v][1][1]){}\n\t\telse if(f[v][0][1]>f[v][1][1]) cnt++;\n\t\telse flag=true;\n\t\tif(min(f[v][0][1],f[v][1][1])>=Inf) Flag=true;\n\t\ttmp3+=min(f[v][0][1],f[v][1][1]);\n\t\ttmp4+=min(f[v][0][1],f[v][1][1]);\n\t}\n\tif(!flag){\n\t\tint minx=Inf;\n\t\tfor(int i=head[u];i;i=edge[i].nxt){\n\t\t\tint v=edge[i].v;\n\t\t\tif(v==fa) continue;\n\t\t\tminx=min(minx,abs(f[v][0][1]-f[v][1][1]));\n\t\t}\n\t\tif((cnt%2==1&&a[u]==1)||(cnt%2==0&&a[u]==0)){\n\t\t\ttmp3+=minx;\n\t\t}\n\t\tif((cnt%2==0&&a[u]==1)||(cnt%2==1&&a[u]==0)){\n\t\t\ttmp4+=minx;\n\t\t}\n\t}\n\tif(Flag){\n\t\tf[u][1][0]=f[u][1][1]=Inf;\n\t}\n\tf[u][1][0]=tmp3+1;\n\tf[u][1][1]=tmp4+1;\n}\nsigned main(){\n\tn=read();\n\tfor(int i=1;i<n;i++){\n\t\tint u=read(),v=read();\n\t\tadd(u,v);add(v,u);\n\t}\n\tfor(int i=1;i<=n;i++) a[i]=read();\n\tdfs(1,0);\n//\tfor(int i=1;i<=n;i++){\n//\t\tprintf(\"%d %d %d %d\\n\",f[i][0][0],f[i][0][1],f[i][1][0],f[i][1][1]);\n//\t}\n\tif(min(f[1][0][0],f[1][1][0])>=Inf) printf(\"impossible\");\n\telse {\n\t\tprintf(\"%d\",min(f[1][0][0],f[1][1][0]));\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1648208662,
        "uid": 436389,
        "name": "Vidoliga",
        "ccfLevel": 6,
        "title": "P8127\u9898\u89e3"
    },
    {
        "content": "\u8003\u8651\u64cd\u4f5c\u65e0\u987a\u5e8f\u8981\u6c42\u4e0e\u5b50\u6811\u53ea\u6709\u513f\u5b50\u6709\u5f71\u54cd\uff0c\u8003\u8651\u6811\u5f62 DP\u3002  \n\u8bbe $f_{i,0/1,0/1}$ \u8868\u793a\u7b2c $i$ \u4e2a\u70b9\uff0c\u5bf9\u7236\u8282\u70b9\u6709\u65e0\u66f4\u6539\uff0c\u5bf9\u81ea\u5df1\u66f4\u6539\u7684 $0$ \u5076 $1$ \u5947\u6b21\u65f6\u7684\u6700\u5c0f\u66f4\u6539\u6b21\u6570\u3002  \n\u82e5\u5f53\u524d\u7ed3\u70b9\u4e3a $u$\uff0c\u5219\u4ece\u8282\u70b9 $son$ \u8f6c\u79fb\u6709\u8f6c\u79fb\u65b9\u7a0b\uff1a  \n$$\nf_{u,0,0}\\gets\\min (f_{u,0,0}+f_{son,0,a_{son}},f_{u,0,1}+f_{son,1,a_{son}}) $$\n$$\nf_{u,0,1}\\gets\\min(f_{u,0,1}+f_{son,0,a_{son}},f_{u,0,0}+f_{son,1,a_{son}})$$\n$$\nf_{u,1,0}\\gets \\min(f_{u,1,0}+f_{son,0,\\neg a_{son}},f_{u,1,1}+f_{son,1,\\neg a_{son}})$$\n$$\nf_{u,1,1}\\gets \\min(f_{u,1,1}+f_{son,0,\\neg a_{son}},f_{u,1,0}+f_{son,1,\\neg a_{son}})\n$$\n\u5373\u513f\u5b50\u5bf9\u5f53\u524d\u8282\u70b9\u6709\u65e0\u66f4\u6539\u7684\u4e24\u79cd\u60c5\u51b5\u53d6 min\u3002  \n\u521d\u59cb $f_{u,0,0}=0,f_{u,1,1}=1,f_{u,0,1}=f_{u,1,0}=-inf$\u3002  \n\u6700\u540e $\\min(f_{root,0,a_{root}},f_{root,1,a_{root}})$ \u5373\u4e3a\u7b54\u6848\u3002",
        "postTime": 1646307513,
        "uid": 145017,
        "name": "2018ty43",
        "ccfLevel": 7,
        "title": "P8127 [BalticOI 2021 Day2] The Xana coup\u9898\u89e3"
    }
]
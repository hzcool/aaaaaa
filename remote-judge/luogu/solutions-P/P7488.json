[
    {
        "content": "~~\u627e\u89c4\u5f8b~~\u7ed3\u8bba\u9898\u3002\u7b54\u6848\u4e3a $Q_n^m=C_n^m \\times A_n^m$\u3002\u76f4\u63a5\u63a8\u51e0\u9879\uff0c\u5927\u529b\u731c\u7ed3\u8bba\u3002\u53ef\u4ee5\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bc1\u660e\u5982\u4e0b\uff1a\n\n\u8bbe $\\forall i \\le n,j \\le i,Q_i^j=C_i^j \\times A_i^j,$\n\n\u5206\u7b2c $i+1$ \u53ea\u767d\u8272\u873b\u8713\u662f\u5426\u5728 $j$ \u53ea\u5f53\u4e2d\u8ba8\u8bba\uff08\u5176\u5b9e\u5c31\u662f\u8003\u8651 dp\uff09\u5f97\n\n$$\\begin{aligned}\nQ_{i+1}^j&=Q_i^j+Q_i^{j-1} \\times (2i-j+2)\\\\\n&=C_i^jA_i^j+(2i-j+2)C_i^{j-1}A_i^{j-1}\\\\\n&=\\frac{(i!)^2}{j![(i-j)!]^2}+\\frac{(i!)^2(2i-j+2)}{(j-1)![(i-j+1)!]^2}\\\\\n&=\\frac{(i!)^2[(i-j+1)^2+(2i-j+2)j]}{j![(i-j+1)!]^2}\\\\\n&=\\frac{[(i+1)!]^2}{j![(i+1-j)!]^2}\\\\\n&=C_{i+1}^jA_{i+1}^j.\n\\end{aligned}$$\n\n$p$ \u4e0d\u4e00\u5b9a\u662f\u8d28\u6570\uff0c\u76f4\u63a5\u4e0a exLucas\u3002\u6ce8\u610f $m \\ge p$ \u65f6\u7b54\u6848\u662f $p$ \u7684\u500d\u6570\uff0c\u6240\u4ee5\u4e8b\u5b9e\u4e0a\u53ea\u7528\u505a $n,m$ \u5f88\u5c0f\u7684\u60c5\u51b5\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(p\\log{p})$\u3002\n\nCode:\n```cpp\n#include<map>\n#include<list>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\n#define LL long long\nusing namespace std;\nLL n,m,p,ans;\ninline LL exgcd(LL a,LL b,LL &x,LL &y)\n{\n\tif(!b)\n\t{\n\t\tx=1;y=0;\n\t\treturn a;\n\t}\n\tLL r=exgcd(b,a%b,y,x);\n\ty-=(a/b)*x;\n\treturn r;\n}\ninline LL mul(LL a,LL b,LL n)\n{\n\treturn a*b%n;\n}\ninline LL qpw(LL n,LL k,LL m)\n{\n\tLL res=1;\n\twhile(k)\n\t{\n\t\tif(k&1)res=mul(res,n,m);\n\t\tn=mul(n,n,m);\n\t\tk>>=1;\n\t}\n\treturn res;\n}\ninline LL fac(LL n,LL pi,LL pk)\n{\n\tif(!n)return 1;\n\tLL res=1;\n\tfor(LL i=2;i<=pk;++i)\n\t{\n\t\tif(i%pi)res=mul(res,i,pk);\n\t}\n\tres=qpw(res,n/pk,pk);\n\tfor(LL i=2;i<=n%pk;++i)\n\t{\n\t\tif(i%pi)res=mul(res,i,pk);\n\t}\n\treturn mul(res,fac(n/pi,pi,pk),pk);\n}\ninline LL inv(LL n,LL m)\n{\n\tLL x,y;\n\texgcd(n,m,x,y);\n\treturn (x+m)%m;\n}\ninline LL crt(LL b,LL m)\n{\n\treturn mul(mul(b,inv(p/m,m),p),p/m,p);\n}\ninline LL C(LL n,LL m,LL pi,LL pk)\n{\n    LL so=fac(n,pi,pk),fa=fac(m,pi,pk),mo=fac(n-m,pi,pk);\n    LL k=0;\n    for(LL i=n;i;i/=pi)k+=i/pi;\n    for(LL i=m;i;i/=pi)k-=i/pi;\n    for(LL i=n-m;i;i/=pi)k-=i/pi;\n    return mul(mul(mul(so,inv(fa,pk),pk),inv(mo,pk),pk),qpw(pi,k,pk),pk);\n}\ninline LL exlucas(LL n,LL m)\n{\n\tLL res=0,k=p,pk;\n\tLL maxx=sqrt(p)+6;\n\tfor(LL i=2;i<maxx;++i)\n\t{\n\t\tif(k%i)continue;\n\t\tpk=1;while(k%i==0)pk*=i,k/=i;\n\t\tres=(res+crt(C(n,m,i,pk),pk))%p;\n\t}\n\tif(k>1)res=(res+crt(C(n,m,k,k),k))%p;\n\treturn res;\n}\nint main()\n{\n    scanf(\" %lld %lld %lld\",&n,&m,&p);\n    if(m>=p)return 0&puts(\"0\");\n    ans=exlucas(n,m);\n    ans=ans*ans%p;\n    for(int i=1;i<=m;++i)ans=ans*i%p;\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1616219859,
        "uid": 59388,
        "name": "VinstaG173",
        "ccfLevel": 7,
        "title": "D \u9ed1\u8272\u6bdb\u8863 \u9898\u89e3"
    },
    {
        "content": "\u53e6\u5916\u4e00\u79cd\u89e3\u6cd5\u3002\n\n\u9996\u5148\u5c06\u9898\u76ee\u8f6c\u5316\u4e3a\u5728\u7b2c $i$ \u884c\u6709 $1$ \u5230 $2i-1$ \u7684\u683c\u5b50\u7684\u68cb\u76d8\u4e0a\u653e $m$ \u4e2a\u8f66\u4f7f\u5b83\u4eec\u4e92\u4e0d\u653b\u51fb\u3002\n\n\u4ee4\u9898\u76ee\u4e2d\u7684\u68cb\u76d8 $S=(1,3,\\dots,2n-1)$\uff0c\u6b63\u65b9\u5f62\u68cb\u76d8 $S'=(n,n,\\dots,n)$\uff0c\u7531 Ferrers \u68cb\u76d8 $S=(a_1,a_2,\\dots,a_n)$ \u91cc\u653e\u8f66\u7684\u65b9\u6848\u6570\u6ee1\u8db3\n\n$$\\sum_{k=0}^{n}r_k(S)x^{\\underline{n-k}}=\\prod_{i=1}^{n}(x+a_i-i+1)$$\n\n\u6709\n\n$$\\sum_{k=0}^{n}r_k(S)x^{\\underline{n-k}}=\\prod_{i=1}^{n}(x+i)$$\n\n$$\\sum_{k=0}^{n}r_k(S')x^{\\underline{n-k}}=\\prod_{i=1}^{n}(x+n-i+1)$$\n\n\u5bb9\u6613\u53d1\u73b0\u4e24\u4e2a\u5f0f\u5b50\u7684\u53f3\u8fb9\u662f\u4e00\u6837\u7684\uff0c\u6240\u4ee5 $r_k(S)=r_k(S')$\u3002\n\n\u7136\u540e $r_k(S')=C_n^kA_n^k$ \u53ef\u4ee5\u7531\u9009 $k$ \u884c\u4e0a\u6709\u8f66\uff0c\u518d\u9009 $k$ \u5217\u7684\u6392\u5217\u4e0a\u6709\u8f66\u5f97\u5230\u3002",
        "postTime": 1619588237,
        "uid": 59388,
        "name": "VinstaG173",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P7488 \u3010\u9ed1\u8272\u6bdb\u8863\u3011"
    }
]
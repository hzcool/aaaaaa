[
    {
        "content": "\u7b1b\u5361\u5c14\u6811\u662f\u4e00\u79cd\u975e\u5e38\u7279\u6b8a\u7684\u4e8c\u53c9\u641c\u7d22\u6811\u3002\u6bcf\u4e2a\u8282\u70b9\u6709\u4e24\u4e2a\u4fe1\u606f $(x_i,y_i)$\uff0c\u5982\u679c\u53ea\u8003\u8651 $x$\uff0c\u5b83\u662f\u4e00\u68f5\u4e8c\u53c9\u641c\u7d22\u6811\uff0c\u5982\u679c\u53ea\u8003\u8651 $y$\uff0c\u5b83\u662f\u4e00\u4e2a\u5c0f\u6839\u5806\u3002\n\n\uff08\u6839\u636e\u4e0a\u9762\u7684\u5b9a\u4e49\uff0cTreap \u672c\u8d28\u4e0a\u4e5f\u662f\u4e00\u79cd\u7b1b\u5361\u5c14\u6811\uff09\n\n\u5728\u4fdd\u8bc1 $x_i$ \u9012\u589e\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u7ebf\u6027\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u6784\u9020\u4e00\u68f5\u7b1b\u5361\u5c14\u6811\u3002\n\n\u6bcf\u6b21\u63d2\u5165\u4e00\u4e2a\u65b0\u8282\u70b9\u65f6\uff0c\u4e3a\u4e86\u786e\u4fdd\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u6027\u8d28\u5f97\u5230\u6ee1\u8db3\uff08\u522b\u5fd8\u4e86\u6211\u4eec\u6309\u7167 $x$ \u9012\u589e\u7684\u987a\u5e8f\u63d2\u5165\uff09\uff0c\u6211\u4eec\u9700\u8981\u5c06\u65b0\u8282\u70b9\u63d2\u5165\u5230\u5c3d\u53ef\u80fd\u9760\u53f3\u7aef\u7684\u4f4d\u7f6e\u3002\n\n\n\u66f4\u5177\u4f53\u5730\u6765\u8bf4\uff0c\u6211\u4eec\u9700\u8981\u7ef4\u62a4\u4e00\u4e2a\u4ece\u6839\u8282\u70b9\u4e00\u76f4\u8d70\u53f3\u513f\u5b50\u5f62\u6210\u7684\u94fe\u3002\u6211\u4eec\u8bbe\u5f53\u524d\u8981\u63d2\u5165\u7684\u70b9\u4e3a $u$\uff0c\u5219\u6211\u4eec\u9700\u8981\u5728\u8fd9\u4e2a\u94fe\u4e0a\u627e\u5230\u7b2c\u4e00\u4e2a $y$ \u6743\u503c\u6bd4 $y_u$ \u5927\u7684\u70b9 $v$\uff0c\u5c06 $v$ \u7684\u53f3\u513f\u5b50\u8bbe\u7f6e\u4e3a $u$\uff08\u5982\u679c\u4e0d\u5b58\u5728\u8fd9\u6837\u7684\u70b9\uff0c\u90a3 $u$ \u5c31\u6210\u4e3a\u6839\u8282\u70b9\u4e86\uff09\uff1b\u5982\u679c $v$ \u5df2\u7ecf\u6709\u53f3\u5b50\u6811\u4e86\uff0c\u5c31\u5c06 $v$ \u7684\u53f3\u5b50\u6811\u63a5\u5728 $u$ \u7684\u5de6\u5b50\u6811\u4e0b\u9762\uff08\u56e0\u4e3a\u4e4b\u524d\u63d2\u5165\u7684\u70b9\u7684 $x$ \u6743\u503c\u90fd\u6bd4 $u_x$ \u5c0f\uff0c\u56e0\u6b64\u8fd9\u6837\u4e0d\u4f1a\u7834\u574f\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u6027\u8d28\uff09\u3002\n\n\u7ef4\u62a4\u8fd9\u6837\u4e00\u6761\u94fe\u53ef\u4ee5\u7528\u6808\u5b9e\u73b0\u3002\u56e0\u4e3a\u6bcf\u4e2a\u8282\u70b9\u6700\u591a\u8fdb\u6808\u51fa\u6808\u5404\u4e00\u6b21\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n)$ \u7684\u3002\n\n```cpp\nvoid build()\n{\n int top=0,cur=0;\n for(int i=1;i<=n;i++)\n {\n  cur=top;\n  while(cur&&p[sta[cur]]>p[i])\n   cur--;\n  if(cur)\n   rs[sta[cur]]=i;\n  if(cur<top)\n   ls[i]=sta[cur+1];\n  sta[++cur]=i;\n  top=cur;\n }\n}\n```",
        "postTime": 1577458207,
        "uid": 22030,
        "name": "StudyingFather",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5854 \u3010\u3010\u6a21\u677f\u3011\u7b1b\u5361\u5c14\u6811\u3011"
    },
    {
        "content": "# \u7b1b\u5361\u5c14\u6811\n\t\n#### \u901a\u8fc7\u4e24\u4e2a\u9898\u76ee\u66f4\u597d\u5730\u7406\u89e3\u7b1b\u5361\u5c14\u6811\n    \n## [\u3010\u6a21\u677f\u3011\u7b1b\u5361\u5c14\u6811](https://www.luogu.com.cn/problem/P5854)\n\n### Part 1\uff1a\u5b9a\u4e49\n\u5b9a\u4e49\u548c[Treap](https://www.luogu.com.cn/problem/P3369)\u76f8\u540c\uff1a\uff08Treap\u662f\u6743\u503c\u968f\u673a\u7684\u7b1b\u5361\u5c14\u6811\uff09\n\n- k\u6ee1\u8db3\u4e8c\u53c9\u641c\u7d22\u6811\u6027\u8d28\n\n- w\u6ee1\u8db3[\u5c0f\u6839\u5806](https://www.luogu.com.cn/problem/P3378)\u6027\u8d28\n\n\u672c\u9898\u4e0b\u6807\u4e3ak\uff0c\u5143\u7d20\u4e3aw\uff08\u9898\u76ee\u5b9a\u4e49\uff09\n\n\u6b63\u5e38\u6784\u5efa\u7684Treap\u5e94\u8be5\u662f\u4e0b\u6807\u4e3aw\uff0c\u5143\u7d20\u4e3ak\uff08\u53ef\u4ee5\u6a21\u62df\u63d2\u5165\u8fc7\u7a0b\u7406\u89e3\uff09 \u4f8b\u9898\uff1a[\u6811\u7684\u5e8f](https://www.luogu.com.cn/problem/P1377)\n\uff08\u4e0b\u9762\u6709\u4ee3\u7801\uff09\n\n### Part 2\uff1a\u6784\u5efa\n\n#### \u7528[\u5355\u8c03\u6808](https://www.luogu.com.cn/problem/P5788)\u7ef4\u62a4\u63d2\u5165\u7684\u4f4d\u7f6e\n\n\uff08\u4e0b\u6807\u5df2\u7ecf\u5355\u8c03\u9012\u589e\u4e86\uff0c\u6240\u4ee5\u65b0\u63d2\u5165\u7684\u70b9\u53ea\u80fd\u662f\u5df2\u524d\u9762\u70b9\u7684\u53f3\u513f\u5b50\u3001\u524d\u9762\u70b9\u53ea\u80fd\u662f\u5b83\u7684\u5de6\u513f\u5b50\uff09\n      \n- \u7528\u5355\u8c03\u6808\u7ef4\u62a4\u4e00\u4e2a\u6743\u503c\u5355\u8c03\u9012\u589e\u7684\u4e0b\u6807\u5e8f\u5217\uff0c\n\n- \u63d2\u5165\u4e00\u4e2a\u70b9\u65f6\u63d2\u5165\u5230\u7b2c\u4e00\u4e2a\u6bd4\u5b83\u5c0f\u7684\u70b9\uff08\u5982\u679c\u6709\u7684\u8bdd\uff09\uff08\u4f5c\u4e3a\u53f3\u513f\u5b50\uff09\u540e\uff0c\u5982\u679c\u9047\u5230\u4e86\u6bd4\u5b83\u5927\u7684\u70b9\uff0c\u5c06\u6700\u540e\u4e00\u4e2a\u6bd4\u5b83\u5927\u7684\u70b9\u4f5c\u4e3a\u5de6\u513f\u5b50\n\n### code\n\n```cpp\n#include<bits/stdc++.h>\n#define re register\n#define il inline\n#define LL long long\nusing namespace std;\ntemplate<typename T>il void read(T &ff){\n    T rr=1;ff=0;re char ch=getchar();\n    while(!isdigit(ch)){if(ch=='-')rr=-1;ch=getchar();}\n    while(isdigit(ch)){ff=(ff<<1)+(ff<<3)+(ch^48);ch=getchar();}\n    ff*=rr;\n}\nconst int N=1e7+7;\nint n,a[N],stk[N],ls[N],rs[N];\nLL L,R;\nsigned main(){\n    read(n);\n    for(re int i=1,pos=0,top=0;i<=n;++i){//\u8fd9\u662f\u6309\u4e0b\u6807\u987a\u5e8f\u63d2\u5165\u5143\u7d20\u7684\u4ee3\u7801\n        read(a[i]);\n        //\u9664\u4e86\u4e0a\u8ff0\u7684\u7ef4\u62a4\u5de6\u53f3\u513f\u5b50\u5c31\u662f\u666e\u901a\u5355\u8c03\u6808\u5566\n        pos=top;\n        while(pos&&a[stk[pos]]>a[i])pos--;\n        if(pos)rs[stk[pos]]=i;\n        if(pos<top)ls[i]=stk[pos+1];\n        stk[top=++pos]=i;\n    }\n    for(re int i=1;i<=n;++i)L^=1LL*i*(ls[i]+1),R^=1LL*i*(rs[i]+1);\n    printf(\"%lld %lld\",L,R);\n    return 0;\n}\n```\n\n## [\u6811\u7684\u5e8f](https://www.luogu.com.cn/problem/P1377)\n\n### \u9898\u610f\uff1a\n\n\u7ed9\u4e00\u4e2a\u751f\u6210\u5e8f\u5217\uff0c\u5efa\u51fa\u4e00\u68f5\u7b1b\u5361\u5c14\u6811\uff0c\u6c42\u5b57\u5178\u5e8f\u6700\u5c0f\u7684\u53ef\u4ee5\u5f97\u5230\u76f8\u540c\u7b1b\u5361\u5c14\u6811\u7684\u751f\u6210\u5e8f\u5217\n\n### \u9898\u89e3\n\n\u6309\u9898\u610f\u5efa\u597d\u6811\u4e4b\u540e\u8f93\u51fa[\u5148\u5e8f\u904d\u5386](https://baike.baidu.com/item/%E5%85%88%E5%BA%8F%E9%81%8D%E5%8E%86/6442839?fr=aladdin)\u5373\u53ef\n\n\u5efa\u6811\u7565\u6709\u4e0d\u540c\uff08\u4ee3\u7801\u4e2d\u6709\u6ce8\u91ca\uff09\n\n### code\n\n```cpp\n\u590d\u6742\u5ea6 O(N)\n#include<bits/stdc++.h>\n#define re register\n#define il inline\n#define LL long long\nusing namespace std;\ntemplate<typename T>il void read(T &ff){\n    T rr=1;ff=0;re char ch=getchar();\n    while(!isdigit(ch)){if(ch=='-')rr=-1;ch=getchar();}\n    while(isdigit(ch)){ff=(ff<<1)+(ff<<3)+(ch^48);ch=getchar();}\n    ff*=rr;\n}\nconst int N=1e5+7;\nint n,a[N],stk[N],ls[N],rs[N];\nvoid dfs(re int x){\n    if(x)printf(\"%d \",x),dfs(ls[x]),dfs(rs[x]);\n}\nsigned main(){\n    read(n);\n    for(re int i=1,x;i<=n;++i)read(x),a[x]=i;//\u4e0e\u7b1b\u5361\u5c14\u6811\u6a21\u677f\u4e0d\u540c\u4e4b\u5904\n                                            //\u8fd9\u91cc\u201c\u628a\u6743\u503c\u5f53\u505a\u4e0b\u6807\uff0c\u4ee5\u4e0b\u6807\u4e3a\u6743\u503c\u2018\u8f93\u5165\u2019a\u6570\u7ec4\u201d\uff0c\u5c31\u8f6c\u5316\u6210\u677f\u5b50\u5566\n    for(re int i=1,pos=0,top=0;i<=n;++i){\n        pos=top;\n        while(pos&&a[stk[pos]]>a[i])pos--;\n        if(pos)rs[stk[pos]]=i;\n        if(pos<top)ls[i]=stk[pos+1];\n        stk[top=++pos]=i;\n    }\n    dfs(stk[1]);\n    return 0;\n}\n```\n",
        "postTime": 1597978990,
        "uid": 286239,
        "name": "ql12345",
        "ccfLevel": 0,
        "title": "\u3010\u3010\u6a21\u677f\u3011\u7b1b\u5361\u5c14\u6811\u3011"
    },
    {
        "content": "[\u53ef\u80fd\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.luogu.com.cn/blog/MuYC/solution-p5854)\n\n#### \u7b1b\u5361\u5c14\u6811\u7684\u5b9a\u4e49\uff1a\n\n\u7b1b\u5361\u5c14\u6811\u662f\u4e00\u79cd\u4e8c\u53c9\u6811\uff0c\u6bcf\u4e00\u4e2a\u7ed3\u70b9\u7531\u4e00\u4e2a\u952e\u503c\u4e8c\u5143\u7ec4 $(k,w)$ \u6784\u6210\u3002\u8981\u6c42 $k$ \u6ee1\u8db3\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u6027\u8d28\uff0c\u800c $w$ \u6ee1\u8db3\u5806\u7684\u6027\u8d28\u3002\u4e00\u4e2a\u6709\u8da3\u7684\u4e8b\u5b9e\u662f\uff0c\u5982\u679c\u7b1b\u5361\u5c14\u6811\u7684 $(k,w)$ \u952e\u503c\u786e\u5b9a\u3001\u5e76\u4e14 $k$ \u4e0d\u76f8\u540c\uff0c $w$ \u4e0d\u76f8\u540c\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7b1b\u5361\u5c14\u6811\u7684\u7ed3\u6784\u662f\u552f\u4e00\u7684\u3002\n\n`--- \u6458\u53d6\u81ea OIWIKI`\n\n![](https://oi-wiki.org/ds/images/cartesian-tree1.png)\n\n\uff08\u7ef4\u57fa\u767e\u79d1\u4e0a\u9762\u7684\u56fe\u7247\uff09\n\n#### \u5982\u4f55\u5efa\u6811\n\n\u7ed9\u5b9a\u4e00\u4e2a\u5e8f\u5217 $A$ \uff08\u9ed8\u8ba4\u5176\u6ca1\u6709\u91cd\u590d\u5143\u7d20\uff09\uff0c\u4e0b\u9762\u5efa\u6811\u7684\u8fc7\u7a0b\u4ee5\u5c0f\u6839\u5806\u4e3a\u4f8b\uff0c\u5b9a\u4e49\u5e8f\u5217\u4e2d\u7b2c $i$ \u4e2a\u5143\u7d20\u7684\u952e\u503c\u4e3a $(i,A_i)$\uff0c\u4e5f\u5c31\u662f $i$ \u5bf9\u5e94 $k$ \uff0c $A_i$ \u5bf9\u5e94 $w$\u3002\n\n\u5b9a\u4e49\u4e00\u68f5\u6811\u7684**\u53f3\u94fe**\u4e3a\u4ece\u6839\u51fa\u53d1\u4e00\u76f4\u5f80\u53f3\u513f\u5b50\u65b9\u5411\u80fd\u591f\u5230\u8fbe\u7684\u6240\u6709\u70b9\u6309\u7167\u6df1\u5ea6\u4ece\u6d45\u5230\u6df1\u6392\u5e8f\u540e\u800c\u5f62\u6210\u7684\u4e00\u6761\u94fe\u3002\n\n\u56e0\u4e3a\u6211\u4eec\u7684\u952e\u503c $k$ \u662f\u6570\u7ec4\u4e0b\u6807\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u9700\u8981\u6392\u5e8f\uff0c\u76f4\u63a5\u4ece\u6570\u7ec4\u7684\u5de6\u8fb9\u5f80\u53f3\u8fb9\u63d2\u5165\u53ef\u4ee5\u3002\n\n\u5047\u8bbe\u6211\u4eec\u73b0\u5728\u63d2\u5165\u7684\u662f\u8282\u70b9 $u$\uff0c\u6211\u4eec\u4e3a\u4e86\u7ef4\u62a4\u4e0b\u6807\u6ee1\u8db3\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u6027\u8d28\uff0c\u80af\u5b9a\u6bcf\u6b21\u90fd\u662f\u5f80\u6811\u7684**\u53f3\u94fe**\u7684\u672b\u7aef\u63d2\u5165\uff0c\u4f46\u662f\u6211\u4eec\u6b64\u65f6\u8981\u7ef4\u62a4\u5806\u7684\u6027\u8d28\u3002\n\n+ $1.$ \u5982\u679c\u6070\u597d $w_u$ \u5927\u4e8e\u5f53\u524d\u53f3\u94fe\u672b\u7aef\u7aef\u70b9\u7684 $w$ \u5373\u76f4\u63a5\u5c06 $u$ \u63d2\u5165\u5230 \u53f3\u94fe\u7684\u672b\u7aef\u3002\n\n+ $2.$ \u5982\u679c $w_u$ \u5c0f\u4e8e\u5f53\u524d\u53f3\u94fe\u7684\u672b\u7aef\u7aef\u70b9\u7684 $w$\uff0c\u90a3\u4e48\u610f\u5473\u7740 $u$ \u5e94\u5f53\u5728\u6811\u4e0a\u662f **\u5f53\u524d\u53f3\u94fe** \u672b\u7aef\u7aef\u70b9\u7684\u7956\u5148\uff0c\u4e8e\u662f\u6211\u4eec\u7ee7\u7eed\u5f80\u4e0a\u627e\uff0c\u76f4\u5230\u9047\u5230\u6ee1\u8db3\u7b2c\u4e00\u79cd\u60c5\u51b5\u7684\u70b9\u3002\n\n\u5047\u5982\u6211\u4eec\u5728\u53f3\u94fe\u4e0a\u627e\u5230\u4e86\u4e00\u4e2a\u70b9 $j$ \u4f7f\u5f97 $w_j < w_u$ \uff0c\u90a3\u4e48\u5c31\u628a $j$ \u7684\u53f3\u513f\u5b50\u4f5c\u4e3a $u$ \u7684\u5de6\u513f\u5b50\uff0c$j$ \u7684\u53f3\u513f\u5b50\u53d8\u4e3a $u$\uff0c\u7136\u540e\u6211\u4eec\u5c31\u5b8c\u6210\u4e86\u63d2\u5165\u8fd9\u4e2a $u$\u3002\n\n\u5982\u679c\u6ca1\u6709\u627e\u5230\u4efb\u4f55\u4e00\u4e2a\u70b9\u53ef\u4ee5\u5c0f\u4e8e $w_u$\uff0c\u90a3\u4e48 $w_u$ \u5c31\u4f1a\u6210\u4e3a\u65b0\u7684\u53f3\u94fe\u7684\u6839\u8282\u70b9\u3002\n\n\u5177\u4f53\u5efa\u6811\u7684\u4f8b\u5b50\u53ef\u4ee5\u770b\u8fd9\u91cc\uff1a[OIWIKI - \u7b1b\u5361\u5c14\u6811](https://oi-wiki.org/ds/cartesian-tree/)\n\n\u53ef\u4ee5\u53d1\u73b0\u4e0a\u9762\u7684\u8fc7\u7a0b\u53ef\u4ee5\u7528\u5355\u8c03\u6808\u7ef4\u62a4\u53f3\u94fe\uff0c\u5177\u4f53\u53ef\u4ee5\u5eb7\u5eb7\u4ee3\u7801\u5440\u3002\n\n#### \u7b1b\u5361\u5c14\u6811\u7684\u4e00\u4e9b\u6027\u8d28\n\n+ \u5bf9\u4e8e\u539f\u6b63\u6574\u6570\u5e8f\u5217\u5efa\u6811\u4ee5\u540e\uff0c\u533a\u95f4 $[l,r]$ \u7684\u6781\u503c\u5373\u662f\u6811\u4e0a $l$ \u6240\u5728\u4f4d\u7f6e\u4ee5\u53ca $r$ \u6240\u5728\u4f4d\u7f6e\u7684 $LCA$\uff0c\u8fd0\u7528\u8fd9\u4e2a\u6027\u8d28\u53ef\u4ee5\u505a\u5230 $O(n)-O(1)$ \u7684**\u5728\u7ebf\u89e3\u51b3**\u533a\u95f4 `RMQ` \u95ee\u9898\uff08\u4f46\u662f\u5f97\u7ed3\u5408 `+1/-1 RMQ` \u6765\u505a\uff0c\u7f16\u7801\u590d\u6742\u5ea6\u5f88\u9ad8\uff0c\u4e0d\u5efa\u8bae\u4f7f\u7528\uff09\u3002\n\n    ps.\u5177\u4f53\u505a\u6cd5\u5373\u5148\u5bf9\u539f\u5e8f\u5217\u5efa\u4e00\u68f5\u7b1b\u5361\u5c14\u6811\uff0c\u968f\u540e\u5bf9\u8fd9\u68f5\u7b1b\u5361\u5c14\u6811\u505a `O(n) - O(1) LCA` \u5373\u53ef\uff0c `O(n) - O(1) LCA` \u5373\u53ef\u4ee5\u7528 `+1/-1 RMQ` \u89e3\u51b3\uff0c`+1/-1 RMQ` \u5177\u4f53\u53ef\u4ee5\u53c2\u89c1 `2017 - \u5f90\u660e\u5bbd \u300a\u975e\u5e38\u89c4\u5927\u5c0f\u5206\u5757\u7b97\u6cd5\u521d\u63a2\u300b` \u8bba\u6587\u4e2d\u63d0\u5230\u7684\u65b9\u6cd5\uff0c\u4e0d\u518d\u8d58\u8ff0\u3002\n\n+ \u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u7ef4\u62a4\u4e00\u4e2a\u6570\u5728\u539f\u5e8f\u5217\u7684\u524d\u9a71\u540e\u7ee7\uff0c\u56e0\u4e3a\u6070\u597d\u5b83\u7684\u4e0b\u6807\u952e\u503c\u6ee1\u8db3\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u6027\u8d28\uff0c\u800c\u4e14\u6743\u503c\u6ee1\u8db3\u5806\u7684\u6027\u8d28\uff0c\u6240\u4ee5\uff0c\u53ef\u4ee5\u901a\u8fc7 $DFS$ \u83b7\u53d6\u524d\u9a71\u540e\u7ee7\u7b49\uff0c\u4f46\u662f\u5e38\u6570\u8c8c\u4f3c\u6bd4\u5355\u8c03\u6808\u8fd8\u5927\u3002\n\n+ \u7efc\u4e0a\uff0c\u7b1b\u5361\u5c14\u6811\u7684\u4e3b\u8981\u4f5c\u7528\u8fd8\u662f\u5728\u4e8e\u5904\u7406\u533a\u95f4 `RMQ` \u95ee\u9898\uff0c\u5904\u7406\u5176\u5b83\u95ee\u9898\u5e76\u6ca1\u6709\u660e\u663e\u4f18\u52bf\u3002\n\n\n#### \u6a21\u677f\u4ee3\u7801\n\n\u5176\u5b9e\u5927\u5bb6\u5199\u5f97\u5e94\u8be5\u90fd\u5dee\u4e0d\u591a\u5427\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nchar buf[1 << 21], *p1 = buf, *p2 = buf;\n#define getchar() (p1 == p2 && (p2 = (p1 = buf) + fread(buf, 1, 1 << 21, stdin), p1 == p2) ? EOF : *p1 ++)\ninline int read() {\n    int x = 0, flag = 1;\n    char ch = getchar();\n    for( ; ch > '9' || ch < '0' ; ch = getchar()) if(ch == '-') flag = -1;\n    for( ; ch >= '0' && ch <= '9' ; ch = getchar()) x = (x << 3) + (x << 1) + ch - '0';\n    return x * flag;\n}\ntypedef long long LL;\nconst int MAXN = 1e7 + 50;\nint n, A[MAXN], tack[MAXN], top = 1, ls[MAXN], rs[MAXN];\nLL ans1, ans2;\n\nint main() {\n    n = read(); tack[1] = 1;\n    for(int i = 1 ; i <= n ; i ++) A[i] = read();\n    for(int i = 2 ; i <= n ; i ++) {\n        while(A[tack[top]] > A[i] && top) top --; // \u5f39\u6808\n        if(!top) ls[i] = tack[top + 1]; // \u5982\u679c\u53f3\u94fe\u4e2d\u6ca1\u6709\u4e00\u4e2a\u6bd4\u5b83\u5927\u7684\u5143\u7d20\uff0c\u5b83\u5c31\u6210\u4e86\u53f3\u94fe\u7684\u94fe\u9876\u5e76\u4e14\u539f\u6765\u7684\u94fe\u9876\u5c31\u662f\u5b83\u7684\u5de6\u513f\u5b50\n        else ls[i] = rs[tack[top]], rs[tack[top]] = i; // \u60f3\u8c61\u4e00\u4e0b\u628a\u70b9 i \u63d2\u5165\u5230\u67d0\u4e2a\u70b9\u7684\u4e0b\u65b9\uff0c\u4e5f\u5c31\u662f\u8bf4\u539f\u672c\u90a3\u4e2a\u70b9\u7684\u53f3\u513f\u5b50\u8981\u53d8\u6210 i \u7684\u5de6\u513f\u5b50\uff0c\u7136\u540e i \u6765\u5145\u5f53\u8fd9\u4e2a\u53f3\u513f\u5b50\n        tack[++ top] = i;\n    }\n    for(int i = 1 ; i <= n ; i ++) {\n        ans1 ^= (1ll * i * (ls[i] + 1));\n        ans2 ^= (1ll * i * (rs[i] + 1));\n    } printf(\"%lld %lld\", ans1, ans2);\n    return 0;\n}\n// Author : MuYC\n```",
        "postTime": 1624418107,
        "uid": 67817,
        "name": "MuYC",
        "ccfLevel": 6,
        "title": "\u7b1b\u5361\u5c14\u6811\u6a21\u677f \u9898\u89e3"
    },
    {
        "content": "# \u7b1b\u5361\u5c14\u6811\n\n## \u6027\u8d28\n\n\u7b1b\u5361\u5c14\u6811\u662f\u4e00\u79cd\u7531\u5bf9\u6570\u5217\u6784\u5efa\u6210\u7684\u4e8c\u53c9\u6811\u3002\u5b83\u6ee1\u8db3\u4e09\u4e2a\u6027\u8d28\uff1a\n\n1. \u5b83\u7684\u4e2d\u5e8f\u904d\u5386\u662f\u539f\u6570\u5217\n\n2. \u4efb\u610f\u4e00\u4e2a\u8282\u70b9\u7684\u503c\u90fd$>$\u5b83\u7684\u4e24\u4e2a\u513f\u5b50\u8282\u70b9\u7684\u503c\n\n3. \u4e24\u4e2a\u70b9\u7684$lca$\u5c31\u662f\u5b83\u4eec\u7684$RMQ$\n\n## \u6784\u5efa\n\n\u5982\u679c\u5b66\u8fc7`Treap`\uff0c\u90a3\u4e48\u5927\u5bb6\u90fd\u4f1a\u4ee5$n\\log n$\u7684\u590d\u6742\u5ea6\u6765\u6784\u5efa\u8fd9\u68f5\u6811\u3002\u4f46\u662f\u6211\u4eec\u7684\u6570\u636e\u8303\u56f4\u662f$10^7$\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981$O(n)$\u7684\u6784\u5efa\u65b9\u6cd5\uff0c\u5373\u5355\u8c03\u6808\u3002\n\n\u7531\u4e8e\u7b2c1\u6761\u6027\u8d28, \u63d2\u5165\u7684\u65b0\u8282\u70b9\u4e00\u5b9a\u5728\u4e8c\u53c9\u6811\u7684\u53f3\u5b50\u6811\u94fe\u4e0a.\n\n\u7ef4\u62a4\u4e00\u4e2a\u53f3\u5b50\u6811\u94fe\u7684\u6808, \u8fdb\u884c\u4ee5\u4e0b\u64cd\u4f5c:\n\n1. \u63d2\u5165\u4e00\u4e2a\u65b0\u8282\u70b9 $p$\n\n2. \u5982\u679c\u6808\u9876\u5143\u7d20 $u$ \u7684\u503c\u5c0f\u4e8e $p$, \u5f39\u51fa $u$, \u5e76\u5c06\u5176\u8bbe\u4e3a $p$ \u7684\u5de6\u513f\u5b50\uff0c\u5426\u5219, $p$ \u4e3a $u$ \u7684\u53f3\u513f\u5b50.\n\n3. \u6700\u540e, \u6808\u9876\u5143\u7d20\u5373\u4e3a\u6811\u7684\u6839.\n\n\u4ee3\u7801\u5982\u4e0b\n\n```cpp\nstruct Node{\n\tNode *ch[2];\n\tint id, val;\n\tNode() {}\n\t\n\tNode(int id, int val) : id(id), val(val) {\n\t\tch[0] = ch[1]  = NULL;\n\t}\n}npool[MAXN];\n\nNode *rt[MAXN], *root;\nint n;\nint a[MAXN];\nNode *sta[MAXN];\nint top;\n\nNode *Build() {\n\tNode *now = NULL, *nxt = NULL, *las = NULL;\n\tfor (int i = 1; i <= n; i++) {\n\t\tnpool[i] = Node(i, a[i]);\n\t\tnxt = rt[i] = &npool[i];\n\t\tlas = NULL;\n\t\twhile (top) {\n\t\t\tif (sta[top]->val < nxt->val) {\n\t\t\t\tnow = sta[top];\n\t\t\t\tif (now->ch[1]) {\n\t\t\t\t\tnxt->ch[0] = now->ch[1];\n\t\t\t\t}\n\t\t\t\tnow->ch[1] = nxt;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tlas = sta[top--];\n\t\t}\n\t\tif (!top && las) {\n\t\t\tnxt->ch[0] = las;\n\t\t}\n\t\tsta[++top] = nxt;\n\t}\n\twhile (!top) now = sta[top--];\n\treturn now;\n}\n\n```\n\n## \u4ee3\u7801\n\n\u7531\u4e8e~~\u67d0\u8c37\u5bf9\u6307\u9488\u7528\u6237\u6709\u4e25\u91cd\u79cd\u65cf\u6b67\u89c6~~\u8bc4\u6d4b\u59ec\u662f64\u4f4d\uff0c\u4e0d\u5728\u7a7a\u95f4\u5361\u5361\u5e38\u7684\u8bdd\u5c31\u4f1aMLE\uff0c\u6240\u4ee5\u6709\u4e9b\u5730\u65b9\u5199\u6cd5\u4f1a\u7565\u4e3a\u5947\u602a\uff0c\u4f46\u662f\u4ee5\u524d\u7684\u4ee3\u7801\u6ce8\u91ca\u4e0a\u4e86\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n\nusing namespace std;\nconst int MAXN = 1e7 + 5;\n\nint getc() {\n\tstatic char buf[100000];\n\tstatic int l = 0, r = 0;\n\tif (l == r) {\n\t\tl = 0;\n\t\tr = fread(buf, 1, 100000, stdin);\n\t}\n\treturn (l == r) ? EOF : buf[l++]; \n}\n\nint geti() {\n\tint f = 1, x = 0;\n\tchar c = getc();\n\twhile (c < '0' || c > '9') f = (c == '-' ? -1 : 1), c = getc();\n\twhile (c >= '0' && c <= '9') x = x * 10 + (c ^ '0'), c = getc();\n\treturn f * x;\n}\n\nstruct Node{\n\tNode *ch[2];\n\tint id, val;\n\tNode() {}\n\t\n\tNode(int id, int val) : id(id), val(val) {\n\t\tch[0] = ch[1] = NULL;\n\t}\n}npool[MAXN];\n\n//Node *rt[MAXN]\nNode *root;\nint n;\nNode *sta[MAXN];\nint top;\n\nNode *Build() {\n\tNode *now = NULL, *nxt = NULL, *las = NULL;\n\tfor (int i = 1; i <= n; i++) {\n\t\tnpool[i].id = i;\n//\t\tnxt = rt[i] = &npool[i];\n\t\tnxt = &npool[i];\n\t\tlas = NULL;\n\t\twhile (top) {\n\t\t\tif (sta[top]->val < nxt->val) {\n\t\t\t\tnow = sta[top];\n\t\t\t\tif (now->ch[1]) nxt->ch[0] = now->ch[1];\n\t\t\t\tnow->ch[1] = nxt;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tlas = sta[top--];\n\t\t}\n\t\tif (!top && las) nxt->ch[0] = las;\n\t\tsta[++top] = nxt;\n\t}\n\twhile (!top) now = sta[top--];\n\treturn now;\n}\n\nint main() {\n\tn = geti();\n//\tfor (int i = 1; i <= n; i++) a[i] = geti();\n\tfor (int i = 1; i <= n; i++) npool[i].val = geti();\n\troot = Build();\n\tlong long ans1 = 0, ans2 = 0;\n//\tfor (int i = 1; i <= n; i++) {\n//\t\tans1 ^= 1LL * rt[i]->id * ((rt[i]->ch[0] ? rt[i]->ch[0]->id : 0) + 1);\n//\t\tans2 ^= 1LL * rt[i]->id * ((rt[i]->ch[1] ? rt[i]->ch[1]->id : 0) + 1);\n//\t}\n\tfor (int i = 1; i <= n; i++) {\n\t\tans1 ^= 1LL * i * ((npool[i].ch[0] ? npool[i].ch[0]->id : 0) + 1);\n\t\tans2 ^= 1LL * i * ((npool[i].ch[1] ? npool[i].ch[1]->id : 0) + 1);\n\t}\n\tprintf(\"%lld %lld\\n\", ans1, ans2);\n\treturn 0;\n}\n```",
        "postTime": 1577503863,
        "uid": 126376,
        "name": "Irelia\u10e6",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5854 \u3010\u3010\u6a21\u677f\u3011\u7b1b\u5361\u5c14\u6811\u3011"
    },
    {
        "content": "\u7b1b\u5361\u5c14\u6811\u6a21\u677f\u3002\n\n### \u5173\u4e8e\u7b1b\u5361\u5c14\u6811\n\n\u5982\u9898\u9762\u4e2d\u6240\u8bf4\uff0c\u7b1b\u5361\u5c14\u6811\u662f\u4e00\u68f5\u4e8c\u53c9\u6811\uff0c\u6bcf\u4e2a\u7ed3\u70b9\u6709\u4e24\u4e2a\u6743\u503c\uff0c\u6ee1\u8db3\u4ee5\u4e0b\u6027\u8d28\uff1a\n\n1. \u6309\u7b2c\u4e00\u4e2a\u6743\u503c\u770b\u6ee1\u8db3\u4e8c\u53c9\u641c\u7d22\u6811\u6027\u8d28\uff08BST\u6027\u8d28\uff09\uff1b\n\n2. \u6309\u7b2c\u4e8c\u4e2a\u6743\u503c\u770b\u6ee1\u8db3\u5c0f\u6839\u5806\u6027\u8d28\u3002\n\n\u6709\u5173\u6027\u8d28\u89e3\u91ca\uff1a\n\n\u8fd9\u68f5\u6811\u7684\u6bcf\u4e2a\u7ed3\u70b9\u6709\u4e24\u4e2a\u5b50\u6811\uff0c\u5206\u4e3a\u5de6\u53f3\u5b50\u6811\uff0c\u5b50\u6811\u53ef\u4ee5\u4e3a\u7a7a\uff1b\n\n\u4e00\u4e2a\u7ed3\u70b9\u7684\u5de6\u5b50\u6811\u4e2d\u7684\u6240\u6709\u7ed3\u70b9\u7684\u7b2c\u4e00\u4e2a\u6743\u503c\u90fd\u5c0f\u4e8e\u5176\u7b2c\u4e00\u4e2a\u6743\u503c\uff08\u7a7a\u5b50\u6811\u4e5f\u6ee1\u8db3\uff09\uff1b\n\n\u4e00\u4e2a\u7ed3\u70b9\u7684\u53f3\u5b50\u6811\u4e2d\u7684\u6240\u6709\u7ed3\u70b9\u7684\u7b2c\u4e00\u4e2a\u6743\u503c\u90fd\u5927\u4e8e\u5176\u7b2c\u4e00\u4e2a\u6743\u503c\uff08\u7a7a\u5b50\u6811\u4e5f\u6ee1\u8db3\uff09\uff1b\n\n\u4e00\u4e2a\u7ed3\u70b9\u7684\u4e24\u68f5\u5b50\u6811\u4e2d\u7684\u6240\u6709\u7ed3\u70b9\u7684\u7b2c\u4e8c\u4e2a\u6743\u503c\u90fd\u5927\u4e8e\u5176\u7b2c\u4e8c\u4e2a\u6743\u503c\uff08\u7a7a\u5b50\u6811\u4e5f\u6ee1\u8db3\uff09\u3002\n\n\u9898\u76ee\u7ed3\u51fa\u4e86$1$\u81f3$N$\u7684\u4e00\u4e2a\u6392\u5217$p$\uff0c\u8868\u793a$i$\u53f7\u7ed3\u70b9\u7684\u7b2c\u4e00\u4e2a\u6743\u503c\u4e3a$i$\uff0c\u7b2c\u4e8c\u4e2a\u6743\u503c\u4e3a$p_i$\uff0c\u8981\u6c42\u6211\u4eec\u6784\u9020\u51fa\u5bf9\u5e94\u7684\u7b1b\u5361\u5c14\u6811\uff0c\u6807\u51fa\u6bcf\u4e2a\u7ed3\u70b9\u7684\u5de6\u513f\u5b50\u548c\u53f3\u513f\u5b50\u7684\u7f16\u53f7\u3002\n\n\u5982\u9898\u76ee\u6837\u4f8b\u7ed9\u51fa\u7684\u6392\u5217\u6784\u9020\u51fa\u7684\u6811\u662f\u8fd9\u6837\u7684\uff1a\n\n![\u7b1b\u5361\u5c14\u6811.png](https://i.loli.net/2019/12/27/LYTJBA8NnvHhxXC.png)\n\n\u6211\u4eec\u77e5\u9053\u7531\u4e8e\u6709\u5806\u6027\u8d28\uff0c\u6bcf\u4e2a\u7ed3\u70b9\u5230\u6839\u7684\u94fe\u4e0a\u6df1\u5ea6\u4ece\u5c0f\u5230\u5927\u7b2c\u4e8c\u4e2a\u6743\u503c\u662f\u5355\u8c03\u9012\u589e\u7684\u3002\n\n\u53c8\u56e0\u4e3aBST\u6027\u8d28\uff0c\u6240\u4ee5\u6bcf\u4e2a\u7ed3\u70b9\u5728\u7b2c\u4e00\u4e2a\u6743\u503c\u6bd4\u5176\u5c0f\u7684\u7ed3\u70b9\u90fd\u88ab\u63d2\u5165\u540e\u80af\u5b9a\u6ca1\u6709\u53f3\u5b50\u6811\uff0c\u800c\u4e14\u80af\u5b9a\u4e0d\u5728\u4efb\u610f\u4e00\u4e2a\u5df2\u6709\u7ed3\u70b9\u7684\u5de6\u5b50\u6811\u4e0a\u3002\n\n\u4e8e\u662f\u6211\u4eec\u60f3\u5230\u6309\u7b2c\u4e00\u4e2a\u6743\u503c\uff0c\u5728\u9898\u76ee\u4e2d\u5373\u7ed3\u70b9\u7f16\u53f7\uff0c\u4ece\u5c0f\u5230\u5927\u6bcf\u6b21\u63d2\u5165\u4e00\u4e2a\u7ed3\u70b9\uff0c\u80af\u5b9a\u4f1a\u63d2\u5165\u5230\u4ece\u6839\u5f00\u59cb\u4e00\u76f4\u8bbf\u95ee\u53f3\u513f\u5b50\u76f4\u5230\u6ca1\u6709\u53f3\u513f\u5b50\u4e3a\u6b62\u7684\u4e00\u6761\u94fe\u4e0a\u67d0\u4e2a\u4f4d\u7f6e\uff0c\u6ee1\u8db3\u8fd9\u4e2a\u4f4d\u7f6e\u539f\u6765\u7684\u7ed3\u70b9\u7b2c\u4e8c\u4e2a\u6743\u503c\u5927\u4e8e\u65b0\u63d2\u5165\u7684\u7ed3\u70b9\u7684\u7b2c\u4e8c\u4e2a\u6743\u503c\uff0c\u4e14\u539f\u6765\u7ed3\u70b9\u7684\u7236\u4eb2\u7ed3\u70b9\u7684\u7b2c\u4e8c\u4e2a\u6743\u503c\u5c0f\u4e8e\u65b0\u63d2\u5165\u7684\u7ed3\u70b9\u7684\u7b2c\u4e8c\u4e2a\u6743\u503c\u3002\n\n\u6211\u4eec\u53ea\u8981\u7528\u5355\u8c03\u6808\u5904\u7406\u8fd9\u6837\u7684\u4e00\u6761\u94fe\uff0c\u627e\u5230\u8fd9\u4e2a\u7ed3\u70b9\u540e\u5c06\u5b83\u7684\u4f4d\u7f6e\u8bbe\u7f6e\u4e3a\u65b0\u63d2\u5165\u7684\u7ed3\u70b9\u5e76\u5c06\u5176\u53d8\u6210\u65b0\u63d2\u5165\u7684\u7ed3\u70b9\u7684\u5de6\u5b50\u6811\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n)$\u3002\n\nCode:\n```cpp\n#include<cstdio>\n#define rg register\n#define ll long long\nint N;\nint a[10000007],d[10000007];\nint s[10000007],top;\nint ch[10000007][2];\nll lrs,rrs;\ninline char rc()\n{\n\tstatic char buf[1000000],*pn=buf,*pe=buf;\n\treturn (pn==pe)&&(pe=(pn=buf)+fread(buf,1,1000000,stdin),pn==pe)?EOF:*pn++;\n}\ninline int read()\n{\n\tint f=0;\n\tchar cc=rc();\n\twhile(cc<'0'||cc>'9')cc=rc();\n\twhile(cc>='0'&&cc<='9')f=f*10+cc-'0',cc=rc();\n\treturn f;\n}\nint main()\n{\n\tN=read();\n\tfor(rg int i=1;i<=N;++i)a[i]=read();\n\ttop=0;\n\ts[++top]=0;\n\tfor(rg int i=1;i<=N;++i)\n\t{\n\t\twhile(top&&a[s[top]]>a[i])ch[i][0]=s[top--];\n\t\tif(s[top])ch[s[top]][1]=i;\n\t\ts[++top]=i;\n\t}\n\tlrs=rrs=0;\n\tfor(rg int i=1;i<=N;++i)\n\t{\n\t\tlrs^=1ll*i*(ch[i][0]+1);rrs^=1ll*i*(ch[i][1]+1);\n\t}\n\tprintf(\"%lld %lld\\n\",lrs,rrs);\n\treturn 0;\n}\n```",
        "postTime": 1577455927,
        "uid": 59388,
        "name": "VinstaG173",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5854 \u3010\u3010\u6a21\u677f\u3011\u7b1b\u5361\u5c14\u6811\u3011"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8\u3002](https://www.luogu.com.cn/problem/P5854)\n\n\u524d\u7f6e\u77e5\u8bc6\uff1a BST \uff08\u4e8c\u53c9\u641c\u7d22\u6811\uff09+ \u5355\u8c03\u6808\u3002\n### \u7b1b\u5361\u5c14\u6811\n- \u6982\u5ff5\uff1a\u4e00\u68f5\u4e8c\u53c9\u6811\uff0c\u6bcf\u4e2a\u8282\u70b9\u7684\u7f16\u53f7\u6ee1\u8db3\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u6027\u8d28\uff0c\u6bcf\u4e2a\u8282\u70b9\u7684\u6743\u503c\u6ee1\u8db3\u5c0f\u6839\u5806\u7684\u6027\u8d28\uff08\u6765\u81ea\u9898\u76ee\uff09\u3002  \n\n- \u5efa\u6811\u65b9\u6cd5\uff1a\u56e0\u4e3a\u6bcf\u4e2a\u8282\u70b9\u7684\u7f16\u53f7\u6ee1\u8db3\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u6027\u8d28\uff0c\u540e\u9762\u7684\u70b9\u7f16\u53f7\u6bd4\u524d\u9762\u7684\u5927\uff0c\u6240\u4ee5\u8981\u4e48\u524d\u9762\u7684\u8282\u70b9\u662f\u540e\u6765\u7684\u8282\u70b9\u7684\u5de6\u513f\u5b50\uff0c\u8981\u4e48\u540e\u9762\u7684\u8282\u70b9\u662f\u524d\u9762\u8282\u70b9\u7684\u53f3\u513f\u5b50\u3002  \n- \u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u5355\u8c03\u6808\u6765\u7ef4\u62a4\u4e00\u4e2a\u6743\u503c\u5355\u8c03\u9012\u589e\u7684\u4e0b\u6807\u5e8f\u5217\uff0c\u63d2\u5165\u4e00\u4e2a\u70b9\u65f6\uff0c\u5982\u679c\u6bd4\u6808\u9876\u5143\u7d20\u5927\uff0c\u5219\u5c06\u6808\u9876\u5143\u7d20\u4f5c\u4e3a\u63d2\u5165\u70b9\u7684\u5de6\u513f\u5b50\uff0c\u5426\u5219\u5c06\u63d2\u5165\u70b9\u4f5c\u4e3a\u6808\u9876\u5143\u7d20\u7684\u5de6\u513f\u5b50\u3002\u8fc7\u7a0b\u7ed3\u675f\u540e\uff0c\u6808\u9876\u5143\u7d20\u5c31\u662f\u8fd9\u68f5\u7b1b\u5361\u5c14\u6811\u7684\u6839\u3002\n```cpp\n   for(register int i(1);i<=n;++i){\n \t while(top&&a[d[top]]>a[i]) tr[i][0]=d[top--];\n \t if(d[top]) tr[d[top]][1]=i;\n \t d[++top]=i;\n   }\n```\n\u4e86\u89e3\u5efa\u6811\u540e\uff0c\u5c31\u6309\u9898\u610f\u628a\u6811\u5efa\u597d\uff0c\u5c31\u53ef\u4ee5\u7edf\u8ba1\u7b54\u6848\u4e86\u3002  \n\n\u6ce8\u610f\u4e8b\u9879\uff1a\u672c\u9898\u9700\u8981\u5361\u5e38\uff0c\u8bf7\u4f7f\u7528\u5feb\u8bfb\u3002\n\nAC\u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int M(1e7+1);\nint a[M],d[M],tr[M][2];\ninline int read(){\n\tregister int x(0),f(1);register char c(getchar());\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9'){x=(x<<1)+(x<<3)+(c^'0');c=getchar();}\n\treturn x*f;\n}\nsigned main(){\n\tint n(read());\n\tfor(register int i(1);i<=n;++i) a[i]=read();\n\tint top(1);\n\tfor(register int i(1);i<=n;++i){\n\t\twhile(top&&a[d[top]]>a[i]) tr[i][0]=d[top--];\n\t\tif(d[top]) tr[d[top]][1]=i;\n\t\td[++top]=i;\n\t}\n\tlong long l(0),r(0);\n\tfor(register int i(1);i<=n;++i){\n\t\tl^=1ll*i*(tr[i][0]+1);r^=1ll*i*(tr[i][1]+1);\n\t}\n\tcout<<l<<' '<<r;\n\treturn 0;\n}\n```",
        "postTime": 1626684952,
        "uid": 192615,
        "name": "_Yoimiya_",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011P5854 \u7b1b\u5361\u5c14\u6811"
    },
    {
        "content": "## P5854 \u3010\u6a21\u677f\u3011\u7b1b\u5361\u5c14\u6811\n\n\u7b1b\u5361\u5c14\u6811\u662f\u4e00\u79cd\u7279\u522b\u7684\u4e8c\u53c9\u641c\u7d22\u6811\u3002\n\n\u5bf9\u4e8e\u6811\u4e0a\u7684\u6bcf\u4e00\u4e2a\u975e\u53f6\u5b50\u8282\u70b9\u5de6\u53f3\u513f\u5b50\uff1a\n\n\u6ee1\u8db3\u4e8c\u53c9\u641c\u7d22\u6811\u6027\u8d28\uff0c\u5373\uff1a$tree[ls[x]] < tree[x] < tree[rs[x]]$\uff1b\n\n\u540c\u6837\u4e5f\u6ee1\u8db3\u5c0f\u6839\u5806\u7684\u6027\u8d28\uff0c\u5373\uff1a$tree[x] < tree[ls[x]] \\ \\ \\ and \\ \\ \\ tree[x] < tree[rs[x]]$\u3002\n\n---\n\n\u8003\u8651\u7528\u6808\u5efa\u6811\uff0c\u6808\u4e2d\u5b58\u50a8\u6839\u8282\u70b9\u548c\u53f3\u8282\u70b9\u3002\n\n\u6bcf\u6b21\u63d2\u5165\u65b0\u8282\u70b9\u65f6\u9700\u770b\u662f\u5426\u6ee1\u8db3\u7b1b\u5361\u5c14\u6811\u7684\u6027\u8d28\uff1a\n\n$\\ \\ \\ \\ \\ \\ \\ $\u4e0d\u6ee1\u8db3\u65f6\uff0c\u539f\u6808\u9876\u5143\u7d20\u51fa\u6808\uff0c\u5e76\u5c06\u5176\u4f5c\u4e3a\u65b0\u8282\u70b9\u7684\u5de6\u513f\u5b50\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u82e5\u6ee1\u8db3\u65f6\uff0c\u628a\u65b0\u8282\u70b9\u5f53\u4f5c\u6808\u9876\u5143\u7d20\u7684\u53f3\u513f\u5b50\uff0c\u4e14\u5165\u6808\u3002\n\n\u7ef4\u62a4\u53ef\u4ee5\u7528\u94fe\u6765\u5b9e\u73b0\uff0c\u56e0\u4e3a\u4f1a\u679a\u4e3e\u52301\u6b21\u6240\u4ee5\u7684\u8282\u70b9\uff0c\u6240\u4ee5\u590d\u6742\u5ea6\u4e3a$O(n)$\u3002\n\n\u6ce8\u610f\uff0c\u672c\u9898\u4f1a\u5361\uff0c\u4e0d\u8981$define \\ \\ int$\uff0c\u4e0d\u7136\u4f1a\u54ed\u7684\u5f88\u6709\u8282\u594fQAQ\u3002\n```c\n#include <bits/stdc++.h>\n\ntypedef long long ll;\nconst int MAXN = 1e7 + 10;\nint n, size, p[MAXN];\nll ans1, ans2, son[MAXN][2], stack[MAXN];\n\ninline int read() {\n\tint X = 0, flag = 0;\n\tchar ch = 0;\n\twhile (!isdigit(ch))\n\t\tflag |= ch == '-', ch = getchar();\n\twhile (isdigit(ch))\n\t\tX = (X << 3) + (X << 1) + (ch ^ 48), ch = getchar();\n\treturn flag ? -X : X;\n}\n\nsigned main() {\n#ifndef ONLINE_JUDGE\n#ifdef LOCAL\n    freopen(\"testdata.in\", \"r\", stdin);\n    freopen(\"testdata.out\", \"w\", stdout);\n#endif\n#ifndef LOCAL\n    freopen(\"\u6a21\u677f\u7b1b\u5361\u5c14\u6811.in\", \"r\", stdin);\n    freopen(\"\u6a21\u677f\u7b1b\u5361\u5c14\u6811.out\", \"w\", stdout);\n#endif\n#endif\n\tn = read();\n\tfor (register int i = 1; i <= n; i++)\n\t\tp[i] = read();\n\tfor (register int i = 1; i <= n; i++) {\n\t\tint node = 0, j;\n\t\twhile (size > 0 and p[stack[size]] > p[i]) {\n\t\t\tj = stack[size--];\n\t\t\tson[j][1] = node, node = j;\n\t\t}\n\t\tson[i][0] = node, stack[++size] = i;\n\t}\n\tint node = 0, j;\n\twhile (size) {\n\t\tj = stack[size--];\n\t\tson[j][1] = node, node = j;\n\t}\n\tfor (register int i = 1; i <= n; i++) {\n\t\tans1 ^= (ll)(i * (son[i][0] + 1));\n\t\tans2 ^= (ll)(i * (son[i][1] + 1));\n\t}\n\tprintf(\"%lld %lld\", ans1, ans2);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1598258393,
        "uid": 84897,
        "name": "Hercules",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5854 \u3010\u3010\u6a21\u677f\u3011\u7b1b\u5361\u5c14\u6811\u3011"
    },
    {
        "content": "\u7b1b\u5361\u5c14\u6811\u7684\u5b9a\u4e49\u9898\u76ee\u5df2\u7ecf\u8bb2\u5f97\u6bd4\u8f83\u6e05\u695a\u4e86qwq\n\n\u82e5 $tree(i)_1$ \u8868\u793a\u7b1b\u5361\u5c14\u6811\u4e2d\u4e0b\u6807\u4e3a $i$\u7684\u6570\u7684\u5173\u952e\u5b57\u4e00(\u672c\u9898\u4e2d\u5373\u4e3a\u6570\u7ec4\u4e0b\u6807)\uff0c $tree(i)_2$ \u4e3a\u5173\u952e\u5b57\u4e8c\uff0c\u90a3\u4e48\u5bf9\u4e8e\u6570\u4e0a\u7684\u6bcf\u4e00\u4e2a\u975e\u53f6\u5b50\u8282\u70b9 $i$ \u4e0e\u5176\u5de6\u5b69\u5b50 $l$ \u4e0e\u53f3\u5b69\u5b50 $r$ \uff0c\u6709 $tree(l)_1<tree(i)_1< tree(r)_1$  (\u6ee1\u8db3**\u4e8c\u53c9\u641c\u7d22\u6811**)\uff0c\u4e14$tree(i)_2\\le tree(l)_2\\,$, $tree(i)_2\\le tree(r)_2$ (\u6ee1\u8db3**\u5c0f\u6839\u5806**)\u3002\n\n---\n\n\u90a3\u4e48\u5982\u4f55\u5efa\u7acb\u7b1b\u5361\u5c14\u6811\u5462\uff1f\n\n\u53ef\u4ee5\u8003\u8651**\u5efa\u7acb\u4e00\u4e2a\u6808**\uff0c\u6808\u4e2d\u5143\u7d20\u4e3a**\u6839\u8282\u70b9\u53ca\u5176\u53f3\u5b50\u6811**\uff0c\u6808\u5e95\u5143\u7d20\u4e3a\u6839\u8282\u70b9\u3002\n\n\u679a\u4e3e\u6bcf\u4e00\u4e2a\u5143\u7d20\uff0c\u82e5\u8be5\u5143\u7d20\u5927\u4e8e\u6808\u9876\u5143\u7d20\uff0c\u5373**\u4e0d\u6ee1\u8db3\u5c0f\u6839\u5806**\u65f6\uff0c\u53ef**\u5c06\u6808\u4e2d\u5927\u4e8e\u5b83\u7684\u5b50\u8282\u70b9\u4f5c\u4e3a\u5b83\u7684\u5de6\u5b69\u5b50**\u3002\n\n\u5373**\u5c06\u6808\u4e2d\u4e0d\u6ee1\u8db3\u6761\u4ef6\u7684\u5143\u7d20\u5f39\u51fa\uff0c\u5e76\u8bb0\u5f55\u6700\u9760\u8fd1\u6839\u8282\u70b9\u7684\u4e00\u4e2a\u8282\u70b9\uff0c\u5c06\u5176\u4f5c\u4e3a\u5f53\u524d\u8282\u70b9\u7684\u5b69\u5b50**\u3002\u6b64\u65f6\u5f53\u524d\u8282\u70b9\u7684**\u5de6**\u5b69\u5b50\u7a33\u5b9a\u4e14\u4e0d\u518d\u53d8\u52a8\uff0c\u76f4\u63a5\u8bb0\u5f55\u4e3a\u7b54\u6848\u3002\n\n\u5f39\u51fa\u8282\u70b9\u7684\u53f3\u5b69\u5b50**\u4e5f\u4e0d\u518d\u53d8\u52a8**\uff0c\u8bb0\u5f55\u7b54\u6848\u3002\n\n\u82e5\u6ee1\u8db3\u6761\u4ef6\uff0c\u5219\u5c06\u5176\u5165\u6808\uff0c\u4f46**\u6b64\u65f6\u65e0\u6cd5\u786e\u5b9a\u5176\u7236\u8282\u70b9\u53ca\u5176\u5b50\u8282\u70b9**\u3002\n\n\u679a\u4e3e\u5b8c\u4e4b\u540e\uff0c\u8bb0\u5f55\u6808\u4e2d\u5143\u7d20\u7684\u53f3\u5b69\u5b50\u3002\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u751f\u6210\u7684\u6811\u6ee1\u8db3\u7b1b\u5361\u5c14\u6811\u7684\u5b9a\u4e49\u3002\n\n\u6700\u540e\u5904\u7406\u4e00\u4e0b\u7b54\u6848\u5c31\u884c\u5566~\n\n\u9700\u8981\u6ce8\u610f\uff0c\u672c\u9898**\u8bfb\u5165\u91cf\u5de8\u5927**\uff0c\u9700\u8981\u4f7f\u7528**\u5feb\u901f\u8bfb\u5165**\uff01\n\n## \u4ee3\u7801\n\n```cpp\n//\u4e0d\u5f00long long\u89c1\u7956\u5b97\u554aqwq \n//\u8fd8\u6709\u5f00long long\u8981\u6ce8\u610f\u7a7a\u95f4 \n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=10000010;\nint val[maxn];\nlong long chi[maxn][2],stk[maxn];\n//chi[i][0]:i\u8282\u70b9\u5de6\u5b69\u5b50 \nint size,n;\n//\u8bfb\u5165\u4f18\u5316 \ninline char Getchar(){\n\tstatic char buf[1000000],*p1=buf,*p2=buf;\n\treturn ((p1==p2) && (p1=(p2=buf)+fread(buf,1,1000000,stdin),p1==p2))?EOF:*p2++;\n}\ninline int read(){\n\tint ans=0,f=1;\n\tchar c=Getchar();\n\twhile(c<'0' || c>'9'){if(c=='-') f=-1;c=Getchar();} \n\twhile(c>='0' && c<='9') ans=(ans<<3)+(ans<<1)+c-'0',c=Getchar();\n\treturn ans*f;\n}\nint main(){\n\tn=read();\n\tfor(int i=1;i<=n;i++){\n\t\tval[i]=read();\n\t}\n\t//\u679a\u4e3e\u6bcf\u4e00\u4e2a\u5b50\u8282\u70b9 \n\tfor(int i=1;i<=n;i++){\n\t\tint p=0,j;\n\t\t//\u5c06\u4e0d\u6ee1\u8db3\u5c0f\u6839\u5806\u7684\u8282\u70b9\u5f39\u51fa \n\t\twhile(size>0 && val[stk[size]]>val[i]){\n\t\t\tj=stk[size--];\n\t\t\t//\u8bb0\u5f55\u5f39\u51fa\u8282\u70b9\u7684\u53f3\u5b69\u5b50 \n\t\t\tchi[j][1]=p;\n\t\t\tp=j;\n\t\t}\n\t\t//\u5c06\u6700\u540e\u4e00\u4e2a\u4e0d\u6ee1\u8db3\u6761\u4ef6\u7684\u8282\u70b9\u4f5c\u4e3a\u5f53\u524d\u8282\u70b9\u7684\u5de6\u5b69\u5b50 \n\t\tchi[i][0]=p;\n\t\t//\u5165\u6808 \n\t\tstk[++size]=i;\n\t}\n\tint p=0,j;\n\t//\u5904\u7406\u6808\u4e2d\u5143\u7d20 \n\twhile(size>0){\n\t\tj=stk[size--];\n\t\t//\u8bb0\u5f55\u53f3\u5b69\u5b50 \n\t\tchi[j][1]=p;\n\t\tp=j;\n\t}\n\t//\u5904\u7406\u7b54\u6848 \n\tlong long ans1=0,ans2=0;\n\tfor(int i=1;i<=n;i++){\n\t\tans1^=(long long)(i*(chi[i][0]+1)),ans2^=(long long)(i*(chi[i][1]+1));\n\t}\n\tprintf(\"%lld %lld\",ans1,ans2);\n\treturn 0;\n}\n\n```\n\n\u6700\u540e\u5520\u53e8\u4e00\u53e5\uff1a\u7531\u4e8e\u6bcf\u4e2a\u8282\u70b9\u53ea\u8fdb\u6808\u4e00\u6b21\uff0c\u6240\u4ee5\u7b97\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(n)$\u3002",
        "postTime": 1596808238,
        "uid": 170890,
        "name": "Cxny",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5854 \u3010\u3010\u6a21\u677f\u3011\u7b1b\u5361\u5c14\u6811\u3011"
    },
    {
        "content": "\n\u4e3a\u5565\u8981\u5199\u5462\uff0c\u56e0\u4e3a\u4eca\u5e74CSP\u8003\u4e86\u3002\u4e0d\u80fd\u8bf4\u5b8c\u5168\u4e00\u6837\uff0c\u53ea\u80fd\u8bf4\u5dee\u4e0d\u591a\n\n\n\n----\n\n\u5176\u5b9e\uff0c\u7b1b\u5361\u5c14\u6811\u548c\u7b1b\u5361\u5c14\u7684\u5173\u7cfb\u5c31\u5982\u96f7\u5cf0\u5854\u548c\u96f7\u950b\u7684\u5173\u7cfb\u4e00\u6837\u6ca1\u6709\u4efb\u4f55\u5173\u7cfb\n\n---\n\n\u4ec0\u4e48\u662f\u7b1b\u5361\u5c14\u6811\uff1a\n\n1. \u7b1b\u5361\u5c14\u6811\u662f\u4e00\u79cd\u7279\u6b8a\u7684**\u4e8c\u53c9\u6811**\u6570\u636e\u7ed3\u6784\n2. \u53ef\u4ee5\u7528\u7ebf\u6027\u7684\u65f6\u95f4\u5b8c\u6210\u5efa\u6811\uff08\u7531\u6b64\u4e5f\u53ef\u4ee5\u770b\u51fa\uff0c\u5176\u5b9e\u5e73\u8861\u6811\u4e5f\u80fd\u7ebf\u6027\u65f6\u95f4\u5efa\u6811\uff09\n3. \u7b1b\u5361\u5c14\u6811\u662f\u7528\u6808\u8fdb\u884c\u6784\u5efa\u7684\uff08\n\n\u5927\u5bb6\u90fd\u5e94\u8be5\u5b66\u8fc7\u4e8c\u53c9\u67e5\u627e\u6811\uff0c\u7b1b\u5361\u5c14\u6811\u4e5f\u6ee1\u8db3\u4e8c\u53c9\u67e5\u627e\u6811\u7684\u6027\u8d28\uff1a\n\n**\u6811\u4e2d\u7684\u5143\u7d20\u6309\u7167\u4e2d\u5e8f\u904d\u5386\u5f97\u5230\u7684\u5e8f\u5217\u4e3a\u539f\u6570\u7ec4\u5e8f\u5217**\n\n\u8fd8\u8bb0\u5f97\u4e8c\u53c9\u67e5\u627e\u6811\u4e3a\u4ec0\u4e48\u6b7b\u4e86\u5417\uff1f\n\n\u56e0\u4e3a\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u7279\u6b8a\u624b\u6bb5\u5c06\u4e8c\u53c9\u67e5\u627e\u6811\u9000\u5316\u6210\u94fe\u3002\n\n\u89e3\u51b3\u529e\u6cd5\u662f\u53ef\u4ee5\u4f7f\u7528\u5e73\u8861\u6811\uff0c\u4f46\u662f\u5bf9\u4e8e\u4e00\u4e9b\u9898\u6765\u8bf4\u592a\u9ebb\u70e6\u4e86\u3002\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e0d\u6ee1\u8db3\u5e73\u8861\u6027\u8d28\u7684**\u7b1b\u5361\u5c14\u6811**\u6765\u89e3\u51b3\u4e00\u4e9b\u9898\u76ee\u3002\n\n---\n\n**\u5efa\u6811\u65b9\u6cd5\uff1a**\n\n\u5728\u6808\u4e2d\u5b58\u50a8\u6839\u8282\u70b9\u548c\u53f3\u8282\u70b9\u3002\n\n\u6bcf\u6b21\u63d2\u5165\u65b0\u8282\u70b9\u65f6\u9700\u770b\u662f\u5426\u6ee1\u8db3\u7b1b\u5361\u5c14\u6811\u7684\u6027\u8d28\uff1a\n\n\u5982\u4e0d\u6ee1\u8db3\uff0c\u5219\u5c06\u6808\u9876\u7684\u5143\u7d20\u5f39\u51fa\uff0c\u5e76\u5c06\u5176\u4f5c\u4e3a\u65b0\u8282\u70b9\u7684\u5de6\u513f\u5b50\u3002\n\n\u5982\u6ee1\u8db3\uff0c\u5219\u628a\u65b0\u8282\u70b9\u5f53\u4f5c\u6808\u9876\u7684\u5143\u7d20\u7684\u53f3\u513f\u5b50\uff0c\u5e76\u5c06\u5176\u5165\u6808\u3002\n\n\u603b\u4f53\u6765\u8bf4\uff0c\u5c31\u662f\u4e00\u4e2a\u6a21\u4eff\u5355\u8c03\u6808\u7684\u65b9\u6cd5\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define inf 0x3f3f3f3f\n#define ull unsigned long long\n#define ll long long\nusing namespace std;\ninline int read()\n{\n\tint s=0,w=1;\n\tchar ch=getchar();\n\twhile(!isdigit(ch))\n\t{\n\t\tif(ch=='-')\n\t\t{\n\t\t\tw=-1;\n\t\t}\n\t\tch=getchar();\n\t}\n\twhile(isdigit(ch))\n\t{\n\t\ts=s*10+(ch-'0');\n\t\tch=getchar();\n\t}\n\treturn w*s; \n}\nconst int Maxn=1e7+10;\nint n,Ar[Maxn];\nint siz;\n\nint ch[Maxn][2];\n\nlong long ans1,ans2;\nlong long st[Maxn];\n\nint main()\n{\n\tn=read();\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\t//scanf(\"%d\",&Ar[i]);\n\t\tAr[i]=read();\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint node=0,j;\n\t\twhile(siz>0 && Ar[st[siz]]>Ar[i])\n\t\t{\n\t\t\tj=st[siz--];\n\t\t\tch[j][1]=node;\n\t\t\tnode=j;\n\t\t}\n\t\tch[i][0]=node;\n\t\tst[++siz]=i;\n\t}\n\tint node=0,j;\n\twhile(siz)\n\t{\n\t\tj=st[siz--];\n\t\tch[j][1]=node;\n\t\tnode=j;\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tans1=ans1 xor (long long)(i*(long long)(ch[i][0]+1));\n\t\tans2=ans2 xor (long long)(i*(long long)(ch[i][1]+1));\n\t}\n\tprintf(\"%lld %lld\",ans1,ans2);\n\treturn 0;\n}\n\n```\n\n---\n\n\u6e29\u99a8\u63d0\u793a\uff1a\n\n1. \u4e0d\u5f00 long long \u89c1\u7956\u5b97\n2. \u4e0d\u5199\u5feb\u8bfb\u4f1aTLE\u7684\n\n\n---\n\n\u4f8b\u9898\uff1a\n\n[P1377](https://www.luogu.com.cn/problem/P1377) \uff08\u677f\u5b50\uff09\n\n[P4755](https://www.luogu.com.cn/problem/P4755) \uff08\u7b1b\u5361\u5c14\u6811+CDQ\u5206\u6cbb\uff09\n\n[P3246](https://www.luogu.com.cn/problem/P3246) \uff08\u7b1b\u5361\u5c14\u6811\u4e71\u641e\uff09",
        "postTime": 1632489990,
        "uid": 358739,
        "name": "BFSDFS123",
        "ccfLevel": 0,
        "title": "\u8be6\u89e3\u7b1b\u5361\u5c14\u6811"
    },
    {
        "content": "# \u4e00\u4e2a\u548c\u5176\u4ed6\u9898\u89e3\u90fd\u4e0d\u4e00\u6837\u7684~~\u4e71\u641e~~\u505a\u6cd5\n\u9996\u5148\u6211\u4eec\u8003\u8651\u76f4\u63a5\u6309\u7167\u7b1b\u5361\u5c14\u6811\u7684\u5b9a\u4e49\u53bb\u9012\u5f52\u5efa\u6811 , \u90a3\u4e48\u5c31\u9700\u8981\u7b97 $RMQ$ , \u8fd9\u6837\u505a\u662f $O(nlogn)$ \u7684 , \u663e\u7136\u4f1a\u8d85\u65f6..  \n\u76f4\u63a5\u53bb\u627e\u6bcf\u4e2a\u70b9\u7684\u5de6\u53f3\u513f\u5b50\u8c8c\u4f3c\u5f88\u56f0\u96be , \u4e8e\u662f\u5c31\u8003\u8651\u53bb\u627e\u6bcf\u4e2a\u70b9\u7684\u7236\u4eb2  \n\u7136\u540e\u6211\u753b\u4e86\u51e0\u4e2a\u4f8b\u5b50..\u8c8c\u4f3c\u627e\u5230\u4e86\u51e0\u4e2a\u7ed3\u8bbaqwq\n\n## \u7ed3\u8bba1\n**\u8003\u8651\u8282\u70b9 $x$ , \u4ee4 $a$ \u8868\u793a\u6ee1\u8db3 $a<x$ \u4e14 $p_a<p_x$ \u7684\u6700\u5927\u7684 $a$ (\u5373 $x$ \u5de6\u4fa7\u7b2c\u4e00\u4e2a\u5c0f\u4e8e\u5b83\u7684\u4f4d\u7f6e) , \u4ee4 $b$ \u8868\u793a\u6ee1\u8db3 $b>x$ \u4e14 $p_b<p_x$ \u7684\u6700\u5c0f $b$ (\u5373 $x$ \u53f3\u4fa7\u7b2c\u4e00\u4e2a\u5c0f\u4e8e\u5b83\u7684\u4f4d\u7f6e) , \u90a3\u4e48 $x$ \u5728\u7b1b\u5361\u5c14\u6811\u4e0a\u7684\u7684\u7236\u4eb2 $fa$ \u4e00\u5b9a\u662f $a$ \u6216\u8005 $b$**\n\n***\u8bc1\u660e*** : \u53cd\u8bc1\u6cd5 , \u82e5 $fa$ \u5728 $x$ \u5de6\u4fa7\u4e14\u4e0d\u662f $a$ , \u90a3\u4e48\u4e00\u5b9a\u6709 $p_{fa}<p_x$ , \u6545 $fa<a$ (\u56e0\u4e3a $(a,x)$ \u4e2d\u7684\u5143\u7d20\u6743\u503c\u90fd\u5927\u4e8e $p_x$ ) , \u53c8\u56e0\u4e3a\u8981\u6ee1\u8db3\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u6027\u8d28 , \u6545 $a$ \u4e00\u5b9a\u5728 $x$ \u7684\u5de6\u5b50\u6811\u4e2d , \u8fd9\u4e0e\u5c0f\u6839\u5806\u7684\u6027\u8d28\u77db\u76fe , \u6240\u4ee5\u82e5 $fa$ \u4f4d\u4e8e $x$ \u5de6\u4fa7 , \u4e00\u5b9a\u6709 $fa=a$   \n\u540c\u7406\u5982\u679c $fa$ \u4f4d\u4e8e $x$ \u53f3\u4fa7 , \u4e00\u5b9a\u6709 $fa=b$ , \u5f97\u8bc1\n\n![\u8bc1\u660e1\u56fe\u89e3](https://i.loli.net/2020/07/20/DJgsuoHpNkTWPrf.png)\n\n## \u7ed3\u8bba2\n**\u8fdb\u4e00\u6b65\u5730 , $fa$ \u4e00\u5b9a\u662f $a$ , $b$ \u4e2d\u6743\u503c\u8f83\u5927\u7684\u4e00\u4e2a**\n\n***\u8bc1\u660e*** : \u53cd\u8bc1\u6cd5 , \u4e0d\u59a8\u5047\u8bbe $p_a<p_b$ , \u4e14 $fa=a$ , \u90a3\u4e48\u4ece $a$ \u5411\u7956\u5148\u8d70 , \u82e5\u4ece\u53f3\u513f\u5b50\u8d70\u5411\u7236\u4eb2 , \u5c31\u8bb0\u4f5c ***\u5411\u5de6\u8d70*** , \u5426\u5219\u8bb0\u4f5c ***\u5411\u53f3\u8d70***  \n\u5c06\u7b2c\u4e00\u6b21\u5411\u53f3\u8d70\u65f6 , \u8d70\u5230\u7684\u70b9\u8bb0\u4f5c $c$ , \u90a3\u4e48\u6839\u636e\u4e2d\u5e8f\u904d\u5386\u7684\u539f\u7406 , $c$ \u4e00\u5b9a\u662f $x$ \u7684\u5b50\u6811\u4e4b\u540e\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20 , \u4e14\u6839\u636e\u5806\u7684\u6027\u8d28\u6709 $p_c<p_x$ , $x$ \u7684\u5b50\u6811\u4e2d\u7684\u70b9\u6743\u503c\u90fd\u5927\u4e8e\u7b49\u4e8e $x$ , \u6240\u4ee5 $c$ \u5c31\u662f $x$ \u53f3\u4fa7\u7b2c\u4e00\u4e2a\u5c0f\u4e8e\u4ed6\u7684\u4f4d\u7f6e , \u4e5f\u5c31\u662f $c=b$  \n\u6240\u4ee5\u6709 $p_a<p_b$ , \u4e14 $b$ \u4e3a $a$ \u7684\u7956\u5148 , \u8fd9\u4e0e\u5c0f\u6839\u5806\u7684\u6027\u8d28\u77db\u76fe , \u6545 $fa\\ne a$ , \u7ed3\u5408\u7ed3\u8bba1\u5f97\u77e5 $fa=b$  \n\u5f53 $p_a>p_b$ \u65f6 , \u540c\u7406\u53ef\u5f97 $fa=a$\n\n![\u8bc1\u660e2\u56fe\u89e3](https://i.loli.net/2020/07/20/2eOWMrPZG9hb1S7.png)\n\n## \u505a\u6cd5\n\u63a8\u51fa\u8fd9\u4e2a\u7ed3\u8bba\u4e4b\u540e , \u5c31\u53ef\u4ee5\u7528\u5355\u8c03\u6808\u53bb\u627e\u51fa\u6bcf\u4e2a\u70b9\u5de6\u4fa7 , \u53f3\u4fa7\u7b2c\u4e00\u4e2a\u6743\u503c\u5c0f\u4e8e\u5b83\u7684\u4f4d\u7f6e , \u7136\u540e\u627e\u51fa\u5b83\u7684\u7236\u4eb2 , \u518d\u5224\u65ad\u5b83\u662f\u5de6/\u53f3\u513f\u5b50\u5c31\u884c , \u6ce8\u610f\u5904\u7406\u7a7a\u513f\u5b50\u7684\u60c5\u51b5...\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$ ...\u6709\u70b9\u5361\u5e38\n\n## \u4ee3\u7801:\n```\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define LL long long\n#define GC() (p1==p2&&(p2=(p1=buf1)+fread(buf1,1,10000000,stdin),p1==p2)?EOF:*p1++)\nusing namespace std;\nchar *p1,*p2,buf1[10000009];\nint n;\nint p[10000009];\nint lm[10000009],rm[10000009],st[10000009];\nvoid rd(int &x)//\u5feb\u901f\u8bfb\u5165\n{\n\tchar c=0;\n\tx=0;\n\twhile(c<'0'||c>'9')\n\t\tc=GC();\n\twhile(c>='0'&&c<='9')\n\t\tx=x*10+(c&15),c=GC();\n}\nvoid init()//\u7528\u5355\u8c03\u6808\u5f97\u5230\u6bcf\u4e2a\u70b9\u5de6/\u53f3\u7b2c\u4e00\u4e2a\u5c0f\u4e8e\u5b83\u7684\u4f4d\u7f6e\n{\n\tint tp=0;\n\tfor(int i=n;i>=1;i--)//\u5de6\u4fa7\n\t{\n\t\twhile(tp&&p[i]<p[st[tp]])\n\t\t\tlm[st[tp--]]=i;\n\t\tst[++tp]=i;\n\t}\n\ttp=0;\n\tfor(int i=1;i<=n;i++)//\u53f3\u4fa7\n\t{\n\t\twhile(tp&&p[i]<p[st[tp]])\n\t\t\trm[st[tp--]]=i;\n\t\tst[++tp]=i;\n\t}\n}\nvoid solve()//\u8ba1\u7b97\u6bcf\u4e2a\u70b9\u7684\u7236\u4eb2,\u5224\u65ad\u5de6,\u53f3\u513f\u5b50,\u6ce8\u610f\u7a7a\u513f\u5b50\u7684\u60c5\u51b5\n{\n\tLL ansl=0,ansr=0;\n\tfor(int i=1;i<=n;i++)\n\t\tansl^=i,ansr^=i;//\u5148\u5f02\u6216\u4e0a\u6240\u6709\u7a7a\u513f\u5b50\u7684\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint tl=lm[i],tr=rm[i];\n\t\tif(tl&&tr)//\u5de6/\u53f3\u5747\u6709\u5c0f\u4e8e\u5b83\u7684\u4f4d\u7f6e\n\t\t{\n\t\t\tif(p[tl]>p[tr])\n\t\t\t\tansr^=tl^((LL)tl*(i+1));//\u518d\u6b21\u5f02\u6216,\u62b5\u6d88\u7a7a\u513f\u5b50\u7684\u5f02\u6216\u503c\n\t\t\telse\n\t\t\t\tansl^=tr^((LL)tr*(i+1));\n\t\t}\n\t\telse if(tl)//\u53ea\u6709\u5de6\u4fa7\u6709\n\t\t\tansr^=tl^((LL)tl*(i+1));\n\t\telse//\u53ea\u6709\u53f3\u4fa7\u6709\n\t\t\tansl^=tr^((LL)tr*(i+1));\n\t}\n\tprintf(\"%lld %lld\",ansl,ansr);\n}\nint main()\n{\n\trd(n);\n\tfor(int i=1;i<=n;i++)\n\t\trd(p[i]);\n\tinit();\n\tsolve();\n\treturn 0;\n}\n```",
        "postTime": 1595221126,
        "uid": 31988,
        "name": "cppascalinux",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5854 \u3010\u3010\u6a21\u677f\u3011\u7b1b\u5361\u5c14\u6811\u3011"
    },
    {
        "content": "\u7c97\u770b\u4e00\u773c\u9898\u9762\u8303\u56f4\u53d1\u73b0$n\\leq 10^7$,\u679c\u65ad\u8003\u8651\u5355\u8c03\u6808\n\n\u8bf4\u4e00\u4e0b\u5355\u8c03\u6808\u601d\u8def\n\n\u9996\u5148\u6211\u4eec\u8981\u4fdd\u8bc1\u7f16\u53f7\u6ee1\u8db3\u4e8c\u53c9\u641c\u7d22\u6811\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u8003\u8651\u7ef4\u62a4\u8fd9\u4e2a\u6811\u7684\u53f3\u5b50\u94fe\uff08\u8fd9\u91cc\u63d2\u5165\u624d\u80fd\u6709\u53ef\u80fd\u4e0d\u6539\u53d8\u8fd9\u4e2a\u6811\u7684\u4e2d\u5e8f\u904d\u5386\uff09\n\n\u6211\u4eec\u518d\u6765\u770b\u770b\u8fd9\u4e2a\u6811\uff0c\u800c\u4e14\u65b0\u63d2\u5165\u7684\u5f1f\u8fd9\u4e2a\u70b9$i$\u4e00\u5b9a\u6ca1\u6709\u5de6\u5b50\u6811\uff0c\u6211\u4eec\u4fdd\u6301\u8fd9\u4e2a\u6808\u7684\u5355\u8c03\u6027\uff08\u56e0\u4e3a\u5fc5\u987b\u4fdd\u8bc1\u4e00\u4e2a\u65b9\u5411\u4e0a\u7684\u8def\u5f84\u5355\u8c03\u9012\u589e\uff09\uff0c\u6240\u4ee5\u6211\u4eec\u4e00\u5b9a\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u4f4d\u7f6e$p$\uff08$p$\u5c31\u662f\u5f53\u524d\u5355\u8c03\u6808\u7684\u6808\u9876\uff09\uff0c\u6211\u4eec\u628a$p$\u7684\u53f3\u513f\u5b50\u7ed9\u5f53\u524d\u8282\u70b9$i$\u4f5c\u4e3a\u5de6\u513f\u5b50\uff08\u663e\u7136\u4e0d\u4f1a\u51fa\u95ee\u9898\uff09,\u56e0\u6b64\u6b63\u786e\u6027\u663e\u7136\uff0c\u800c\u4e14\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u53ef\u4ee5\u5f97\u5230\u662f$O(N)$(\u56e0\u4e3a\u5355\u8c03\u6808)\n\n\u540c\u65f6\u53d1\u73b0\u8fd9\u9053\u9898\u6ca1\u6709\u8d1f\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a\u8bfb\u5199\u7b80\u5355\u4e00\u70b9\n\n```cpp\n#include<touwenjian.h>\n\n#define int long long\n \nusing namespace std;\n\nconst int maxn=10001000;\nint l[maxn],r[maxn],a[maxn],s[maxn],stp;\nint n,m;\nint ans1,ans2;\n\ninline void qread(int &ans)\n{\n\tans=0; static char c=getchar();\n\twhile(!isdigit(c)) c=getchar();\n\twhile(isdigit(c)) {ans=ans*10+c-'0';c=getchar();}\n\treturn ;\n} \n\nsigned main()\n{\n\tregister int i;\n\tqread(n);\n\tfor(i=1;i<=n;i++)qread(a[i]);\n\ts[++stp]=0;\n\tfor(i=1;i<=n;i++)\n\t{\n\t\twhile(stp&&a[i]<a[s[stp]]) l[i]=s[stp--];\n\t\tif(stp) r[s[stp]]=i;\n\t\ts[++stp]=i;\n\t}\n\tfor(i=1;i<=n;i++)\n\t{\n\t\tans1=ans1^(1ll)*(i*(l[i]+1));\n\t\tans2=ans2^(1ll)*(i*(r[i]+1));\n\t}\n\tprintf(\"%lld %lld\",ans1,ans2);\n\treturn 0;\n}\n\n\n```\n",
        "postTime": 1591934413,
        "uid": 38636,
        "name": "\u5bd2\u51b0\u5927\u5927",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5854 \u3010\u3010\u6a21\u677f\u3011\u7b1b\u5361\u5c14\u6811\u3011"
    },
    {
        "content": "\u8fd9\u91cc\u662f\u7528\u5355\u8c03\u961f\u5217\u5199\u7684\uff0c\u4e13\u95e8\u8ba8\u8bba\u4e00\u4e0b\u8d8a\u754c\u7684\u95ee\u9898\u4ee5\u53ca\u54e8\u5175\u503c\u7684\u8bbe\u7f6e\u3002\n\n\u5173\u4e8e\u5177\u4f53\u600e\u4e48\u505a\uff0c\u9898\u89e3\u533a\u5176\u4ed6\u5927\u4f6c\u5df2\u7ecf\u8bb2\u5f97\u5f88\u6e05\u695a\u4e86\u3002\u6211\u4eec\u53d1\u73b0\u5728\u505a\u5355\u8c03\u961f\u5217\u7684\u65f6\u5019\uff0c\u5355\u8c03\u961f\u5217\u4e2d\u7684\u90a3\u4e2a\u4e1c\u897f\u5c31\u662f\u5e8f\u5217\u7b1b\u5361\u5c14\u6811\u7684\u53f3\u80a9\u3002\u6765\u4e00\u4e2a\u65b0\u6570\u7684\u65f6\u5019\uff0c\u627e\u5230\u5b83\u5728\u53f3\u80a9\u4e0a\u7684\u4f4d\u7f6e\uff0c\u6253\u65ad\u63a5\u8fdb\u53bb\u5c31\u597d\u3002\u5b83\u6210\u4e3a\u53f3\u80a9\u7684\u4e00\u90e8\u5206\uff0c\u53f3\u80a9\u7684\u5176\u4f59\u90e8\u5206\u6210\u4e3a\u5b83\u7684\u5de6\u513f\u5b50\u3002\n\n\u5bb9\u6613\u8bc1\u660e\uff0c\u8fd9\u79cd\u53d8\u6362\u4e0d\u5f71\u54cd\u7b1b\u5361\u5c14\u6811\u7684\u6027\u8d28\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\Theta(n)$\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\nint qhead = 0;\nfor(int i=1; i<=n; ++i)\n{\n\tint tmp = qhead;\n\twhile(qhead!=qi && vi[*qhead]>vi[i])\n\t{\n\t\t--qhead;\n\t}\n\t++qhead;\n\n\tif(qhead>1)\n\t\tri[qi[qhead-1]] = i;\n\tif(qhead<=tmp)\n\t\tli[i] = qi[qhead];\n\tqi[qhead] = i;\n}\n```\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u8fd9\u91cc\u6709\u4e24\u4e2a\u7279\u5224\u3002\u8ba4\u8bc6\u6211\u7684\u4eba\u5e94\u8be5\u90fd\u4e86\u89e3\uff0c\u6211\u8fd9\u4eba\u5e73\u5e38\u5f88\u5bbd\u5bb9\uff0c\u4f46\u662f\u6700\u70e6\u7279\u5224\u3002\u80fd\u901a\u8fc7\u8bbe\u7f6e\u5408\u9002\u54e8\u5175\u503c\u5e72\u6389\u7684\u7279\u5224\u6211\u4f1a\u4e0d\u9057\u4f59\u529b\u5e72\u6389\u5b83\u3002~~\u56e0\u4e3a\u8fd9\u4e2a\u539f\u56e0\u6a21\u62df\u8d5b\u6302\u7684\u5206\u4e5f\u6709\u767e\u516b\u5341\u4e86\u3002~~\n\n\u9996\u5148\u7b2c\u4e00\u4e2a `if` \u80af\u5b9a\u80fd\u5e72\u3002\u5982\u679c `qhead=1` \u7684\u8bdd\uff0c`qi[qhead-1]` \u5c31\u662f 0\uff0c\u800c\u6211\u4eec\u4e0d\u9700\u8981\u5173\u6ce8 `ri[0]` \u7684\u503c\u3002\u6240\u4ee5\u5c31\u53ef\u4ee5\u5e72\u6389\u4e00\u4e2a\u7279\u5224\u3002\n\n```cpp\nint qhead = 0;\nfor(int i=1; i<=n; ++i)\n{\n\tint tmp = qhead;\n\twhile(qhead!=qi && vi[*qhead]>vi[i])\n\t{\n\t\t--qhead;\n\t}\n\t++qhead;\n\n\tri[qi[qhead-1]] = i;\n\tif(qhead<=tmp)\n\t\tli[i] = qi[qhead];\n\tqi[qhead] = i;\n}\n```\n\n\u63a5\u4e0b\u6765\u770b\u4e0b\u4e00\u4e2a\u7279\u5224\u3002\u770b\u8d77\u6765\u5f88\u597d\u5e72\u7684\u6837\u5b50\uff0c\u56e0\u4e3a\u5982\u679c `qhead=tmp+1` \u7684\u8bdd\uff0c\u8fd9\u4e2a\u503c\u5e94\u8be5\u4e3a `0`\u2026\u2026\u5417\uff1f\n\n\u4e0d\u7792\u60a8\u8bf4\uff0c\u6211\u56e0\u4e3a\u8fd9\u4e2a\u539f\u56e0 WA \u4e86\u597d\u591a\u6b21\u3002\u56e0\u4e3a\u5355\u8c03\u961f\u5217\u4f1a\u540e\u9000\uff0c\u4e3a\u4e86\u6548\u7387\u5728\u540e\u9000\u7684\u65f6\u5019\u6211\u5e76\u6ca1\u6709\u6e05\u7a7a\u6570\u7ec4\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u518d\u524d\u8fdb\u7684\u65f6\u5019\u5c31\u4f1a\u53d6\u5230\u5783\u573e\u503c\u3002\n\n\u6700\u7b80\u5355\u7c97\u66b4\u7684\u89e3\u51b3\u65b9\u6cd5\u662f\u5728\u540e\u9000\u7684\u65f6\u5019\u6e05\u5783\u573e\u503c\u3002\u5f53\u7136\u8fd8\u6709\u66f4\u597d\u73a9\u7684\u65b9\u6cd5\u3002\n\n```cpp\nint qhead = 0;\nfor(int i=1; i<=n; ++i)\n{\n\twhile(qhead!=qi && vi[*qhead]>vi[i])\n\t{\n\t\t--qhead;\n\t}\n\t++qhead;\n\n\tri[qi[qhead-1]] = i;\n\tli[i] = qi[qhead];  \n\tqi[qhead+1] = 0  // \u5404\u4eba\u81ea\u626b\u95e8\u524d\u96ea\uff0c\u83ab\u7ba1\u4ed6\u4eba\u74e6\u4e0a\u971c\n\tqi[qhead] = i;\n}\n```\n\n\u53ef\u4ee5\u8bc1\u660e\uff0c\u6bcf\u4e00\u8f6e\u5faa\u73af\u53ea\u9700\u8981\u5c06 `qhead+1` \u6e05\u7a7a\uff0c\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u53d6\u5230\u7684\u662f\u6b63\u786e\u7684\u503c\uff0c\u5c31\u53ef\u4ee5\u907f\u514d\u6389\u7279\u5224\u7684\u540c\u65f6\u4fdd\u8bc1\u7b54\u6848\u6b63\u786e\u6027\u3002\n\n\u5982\u679c\u8fd9\u4e00\u9898\u51fa\u591a\u7ec4\u6570\u636e\u7684\u8bdd\uff0c\u6bcf\u7ec4\u6570\u636e\u9700\u8981\u521d\u59cb\u5316\u7684\u4e5f\u4ec5\u6709 `qi[1]`\u3002\n\n\u9644 AC \u4ee3\u7801\u3002\u4e3a\u4e86\u6548\u7387\u5c06\u6570\u7ec4\u8bbf\u95ee\u53d8\u6210\u6307\u9488\u4e86\u3002\n\n```cpp\n#include <cstdio>\nusing namespace std;\n\nchar buffer[100001],*S,*T; // \u5e73\u751f\u7b2c\u4e00\u4e2a fread\n\ninline char mgetchar()\n{\n\tif(S==T)\n\t{\n\t\tT = (S=buffer) + fread(buffer,1,100001,stdin);\n\t}\n\treturn *S++;\n}\n\ninline int getint()\n{\n\tchar c;\n\twhile((c=mgetchar())<'0' || c>'9')\n\t\t;\n\tint x = c^'0';\n\twhile((c=mgetchar())>='0' && c<='9')\n\t\tx = (x*10)+(c^'0');\n\treturn x;\n}\n\nint vi[10000005];\nint qi[10000005];\n\nint li[10000005];\nint ri[10000005];\n\nint main()\n{\n\tconst int n = getint();\n\tfor(int i=1; i<=n; ++i)\n\t{\n\t\tvi[i] = getint();\n\t}\n\n\tint* qhead = qi;\n\tfor(int i=1; i<=n; ++i)\n\t{\n\t\twhile(qhead!=qi && vi[*qhead]>vi[i])\n\t\t{\n\t\t\t--qhead;\n\t\t}\n\t\t++qhead;\n\n\t\tri[*(qhead-1)] = i;\n\t\tli[i] = *qhead;\n\t\t*(qhead+1) = 0;\n\t\t*qhead = i;\n\t}\n\n\tlong long lans = 0;\n\tlong long rans = 0;\n\tfor(int i=1; i<=n; ++i)\n\t{\n\t\tlans ^= 1LL*i*(li[i]+1);\n\t}\n\tfor(int i=1; i<=n; ++i)\n\t{\n\t\trans ^= 1LL*i*(ri[i]+1);\n\t}\n\n\tprintf(\"%lld %lld\\n\",lans,rans);\n}\n```",
        "postTime": 1580980705,
        "uid": 49458,
        "name": "\u6728\u6728\uff01",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5854 \u3010\u3010\u6a21\u677f\u3011\u7b1b\u5361\u5c14\u6811\u3011"
    },
    {
        "content": "[P5854 \u3010\u6a21\u677f\u3011\u7b1b\u5361\u5c14\u6811](//www.luogu.com.cn/problem/P5854)\n\n[$\\texttt{My Blog}$](//www.luogu.com.cn/blog/368107/solution-p5854)\n\n---\n\n~~\u83dc\u9e21\u4f5c\u8005\u662f\u4e0d\u53ef\u80fd\u5199\u5355\u8c03\u6808\u7684/kk~~\n\n\u9898\u76ee\u8981\u6c42\u7f16\u53f7\u6309 $\\tt BST$\uff0c\u6743\u503c\u6309\u5c0f\u6839\u5806\uff0c\u4e8e\u662f\u6211\u4eec\u60f3\u5230\u4e86 $\\tt Treap$\u3002\n\n\u6211\u7528\u7684\u662f $\\tt FHQ$\uff0c\u5e73\u8861\u6811\u91cc\u7684\u201c\u6743\u503c\u201d\u5c31\u662f\u9898\u76ee\u4e2d\u7684\u7f16\u53f7\uff0c\u5e73\u8861\u6811\u91cc\u7684\u201c\u4f18\u5148\u7ea7\u201d\u5c31\u662f\u6211\u4eec\u8fd9\u91cc\u7ed9\u5b9a\u7684\u6743\u503c\u3002\n\n\u7531\u4e8e\u7f16\u53f7\u662f\u6309\u987a\u5e8f\u6392\u5217\u7684 $1\\dots n$\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 $\\tt FHQ$ \u7684 $\\mathcal O(n)$ \u5efa\u6811\u3002\n\n\u5176\u4e2d\u7684 $\\mathcal O(n)$ \u5efa\u6811\u8fc7\u7a0b\u5c31\u662f\uff0c**\u9012\u5f52\u5efa $l\\to mid$ \u4ee5\u53ca $mid + 1\\to r$\uff0c\u5982\u679c $l\\ge r$ \u5c31\u6dfb\u52a0\u8282\u70b9 $l$**\u3002\n\n\u6ce8\u610f\u8f93\u51fa\u7684\u65f6\u5019\u8981\u8bb0\u5f55\u4e00\u4e2a\u6bcf\u4e2a\u8282\u70b9\u5bf9\u5e94\u5728\u6811\u4e0a\u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u8f93\u51fa\u7684\u65f6\u5019\u627e\u5230\u5bf9\u5e94\u7684\u4f4d\u7f6e\u518d\u53bb\u627e\u5de6\u53f3\u513f\u5b50\u3002\n\n## Code\n\n```cpp\n#include<stdio.h>\n#include<stdlib.h>\n#include<algorithm>\n\n#define int long long\n#define rint register int\n\ninline int read(){\n    register int x = 0;\n    register char c = getchar();\n    for(;c < '0' || c > '9';c = getchar());\n    for(;c >= '0' && c <= '9';c = getchar())\n        x = x * 10 + (c ^ '0');\n    return x;\n}\n\nconst int maxn = 1e7 + 1;\n\nsigned a[maxn];\nsigned lc[maxn],rc[maxn]; // \u677f\u5b50\nsigned val[maxn],heap[maxn]; // \u677f\u5b50\nsigned map[maxn];// \u6bcf\u4e2a\u8282\u70b9\u5bf9\u5e94\u5728\u6811\u4e0a\nint cnt,rt,x,y,z;\n\ninline int new_node(rint i,rint x){ // \u677f\u5b50\n\tval[++cnt] = i;\n\theap[cnt] = x;\n\tmap[i] = cnt;\n\treturn cnt;\n}\n\ninline int merge(rint x,rint y){ // \u677f\u5b50\n\tif(!x || !y) return x + y;\n\tif(heap[x] < heap[y]){\n\t\trc[x] = merge(rc[x],y);\n\t\treturn x;\n\t} else {\n\t\tlc[y] = merge(x,lc[y]);\n\t\treturn y;\n\t}\n}\n\n// \u6211\u4eec\u5e76\u4e0d\u9700\u8981 split\uff0c\u56e0\u4e3a\u53ea\u7528\u5efa\u6811\n\ninline int build(rint l,rint r){\n\tif(l >= r) return new_node(l,a[l]);// l >= r \u65f6\u65b0\u5efa\u8282\u70b9\n\trint mid = l + r >> 1;\n\treturn merge(build(l,mid),build(mid + 1,r));\n}\n\nsigned main(){\n\tint n = read();\n\tfor(int i = 1;i <= n;++i) a[i] = read();\n\t/* \u6ce8\u610f\uff1a\u4e00\u5b9a\u8981\u5148\u8bfb\u5165\u518d\u5efa\u6811\n\t\t\u4e0d\u80fd\u50cf\u7ebf\u6bb5\u6811\u4e00\u6837\u8fb9\u5efa\u8fb9\u8bfb\u5165 */\n\tbuild(1,n);\n\tlong long ansl = 0,ansr = 0;// \u9634\u95f4\u8f93\u51fa\n\tfor(int i = 1;i <= n;++i){\n\t\tansl ^= (i * (val[lc[map[i]]] + 1));\n\t\tansr ^= (i * (val[rc[map[i]]] + 1));\n\t}\n\tprintf(\"%lld %lld\\n\",ansl,ansr);\n\treturn 0;\n}\n",
        "postTime": 1634206869,
        "uid": 368107,
        "name": "xfrvq",
        "ccfLevel": 7,
        "title": "\u9898\u89e3-P5854"
    },
    {
        "content": "### P5854 \u3010\u6a21\u677f\u3011\u7b1b\u5361\u5c14\u6811 \u9898\u89e3\n\n------------\n\n\u524d\u7f6e\u77e5\u8bc6\uff1a\u60ac\u7ebf\u6cd5\n\n#### \u601d\u8def\n\n\u7ea6\u5b9a\uff1a\u672c\u6587\u4e2d\u7684\u201c\u7b1b\u5361\u5c14\u6811\u201d\u6307\u6743\u503c\u6ee1\u8db3**\u5c0f\u6839\u5806**\u6027\u8d28\u7684\u7b1b\u5361\u5c14\u6811\uff0c\u79f0\u4e00\u4e2a\u70b9\u7684\u5de6\u8fb9\u8ddd\u79bb\u5b83\u6700\u8fd1\u7684\u6743\u503c\u6bd4\u5b83\u5c0f\u7684\u7ed3\u70b9\u4e3a **\u201c\u6700\u8fd1\u5de6\u7956\u5148\u201d**\uff0c\u53f3\u8fb9\u8ddd\u79bb\u5b83\u6700\u8fd1\u7684\u6743\u503c\u6bd4\u5b83\u5c0f\u7684\u7ed3\u70b9\u4e3a **\u201c\u6700\u8fd1\u53f3\u7956\u5148\u201d**\uff0c\u70b9 $i$ \u7684\u6743\u503c\u4e3a $p_i$\uff1b\u4e3a\u4e86\u65b9\u4fbf\uff0c\u52a0\u5165\u4e00\u4e2a**\u54e8\u5175\u8282\u70b9** $0$\uff0c\u6ee1\u8db3\u5176\u6743\u503c\u5c0f\u4e8e\u5176\u4ed6\u6240\u6709\u8282\u70b9\u7684\u6743\u503c\uff0c\u5982\u679c\u67d0\u4e2a\u8282\u70b9\u7684\u6ca1\u6709\u67d0\u4e2a\u5173\u7cfb\u5bf9\u5e94\u7684\u8282\u70b9\uff0c\u5c06\u5176\u8bbe\u4e3a\u54e8\u5175\u8282\u70b9\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u4e00\u4e2a\u70b9\u5728\u7b1b\u5361\u5c14\u6811\u4e0a\u7684\u7236\u4eb2\u5fc5\u5b9a\u662f\u5176\u201c\u6700\u8fd1\u5de6\u7956\u5148\u201d\u4e0e\u201c\u6700\u8fd1\u53f3\u7956\u5148\u201d\u4e2d**\u6743\u503c\u8f83\u5927\u7684\u4e00\u4e2a**\uff08\u8bb0\u4e3a $f_i$\uff09\u3002\n\n\u8bc1\u660e\uff1a\u82e5\u4e0d\u6ee1\u8db3\u4e0a\u8ff0\u6761\u4ef6\uff0c\u5219\u8bb0\u5176\u7236\u4eb2\u4e3a $f'_i$\uff0c\u5219 $p_{f_i}>p_{f'_i}$\u3002\u82e5 $f'_i$ \u4e3a $f_i$ \u513f\u5b50\uff0c\u5219 $f'_i$ \u6709\u4e24\u4e2a\u4f4d\u4e8e\u5176\u540c\u4e00\u4fa7\u7684\u513f\u5b50\uff0c\u4e0d\u6ee1\u8db3\u7b1b\u5361\u5c14\u6811\u7684\u4e8c\u53c9\u641c\u7d22\u6811\u6027\u8d28\u3002\u4e8e\u662f $f'_i$ **\u4e0d\u662f $f_i$ \u513f\u5b50**\u3002$f_i$ \u4f4d\u4e8e $f'_i$ \u4e0e $i$\uff08\u5728 $f'_i$ \u5b50\u6811\u4e2d\uff09\u4e4b\u95f4\uff0c\u4f46\u662f**\u4e0d\u5728 $f'_i$ \u5b50\u6811\u4e2d**\uff0c\u4e0d\u6ee1\u8db3\u7b1b\u5361\u5c14\u6811\u7684\u4e8c\u53c9\u641c\u7d22\u6811\u6027\u8d28\u3002\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa\u6bcf\u4e2a\u8282\u70b9\u7684\u201c\u6700\u8fd1\u5de6\u7956\u5148\u201d\u4e0e\u201c\u6700\u8fd1\u53f3\u7956\u5148\u201d\uff0c\u518d\u9009\u62e9\u6743\u503c\u8f83\u5927\u8005\u4f5c\u4e3a\u8be5\u8282\u70b9\u7684\u7236\u4eb2\u5373\u53ef\u3002\n\n\u60ac\u7ebf\u6cd5\u53ef\u4ee5\u80dc\u4efb\u8fd9\u4e2a\u95ee\u9898\uff0c\u5e76\u4e14\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n\u4ee3\u7801\uff08\u8fd9\u9053\u9898\u5361\u5e38\uff0c\u9700\u628a `cin` \u6362\u4e3a `fread` \u5feb\u8bfb\u65b9\u53ef\u901a\u8fc7\uff09\uff1a\n\n\n```cpp\n#include<bits/stdc++.h>\n\ntypedef long long ll;\n\nconst int N=10001000;\nint p[N];\n//\u5206\u522b\u662f\u8fd9\u4e2a\u8282\u70b9\u201c\u6700\u8fd1\u5de6\u7956\u5148\u201d\uff0c\u201c\u6700\u8fd1\u53f3\u7956\u5148\u201d\uff0c\u5de6\u513f\u5b50\uff0c\u53f3\u513f\u5b50\u7684\u4f4d\u7f6e\uff0c\u82e5\u4e0d\u5b58\u5728\u8bbe\u4e3a0\nint la[N],ra[N],lc[N],rc[N];\n\nsigned main(){\n\tstd::ios::sync_with_stdio(0);\n\tstd::cin.tie(0);\n\t\n\tint n;\n\tstd::cin>>n;\n\tfor(int i=1;i<=n;i++)std::cin>>p[i],la[i]=i-1,ra[i]=i+1;\n\tra[n]=0,p[0]=-0x3f3f3f3f;\n\t\n\tfor(int i=1;i<=n;i++)while(la[i]&&p[i]<p[la[i]])la[i]=la[la[i]];\n\tfor(int i=n;i;i--)while(ra[i]&&p[i]<p[ra[i]])ra[i]=ra[ra[i]];\n\tfor(int i=1;i<=n;i++)(p[ra[i]]>p[la[i]]?lc[ra[i]]:rc[la[i]])=i;\n\tll ans1=0,ans2=0;\n\tfor(int i=1;i<=n;i++){\n//\t\tstd::cerr<<i<<' '<<lc[i]<<' '<<rc[i]<<'\\n';\n\t\tans1^=i*(lc[i]+1ll),ans2^=i*(rc[i]+1ll);\n\t}\n\tstd::cout<<ans1<<' '<<ans2;\n\treturn 0;\n}\n```",
        "postTime": 1629986961,
        "uid": 146416,
        "name": "TerryWang",
        "ccfLevel": 7,
        "title": "P5854 \u3010\u6a21\u677f\u3011\u7b1b\u5361\u5c14\u6811 \u9898\u89e3"
    }
]
[
    {
        "content": "\u9898\u610f\uff1a\u7ed9\u4e00\u4e2a\u957f\u5ea6\u4e3a $N$ \u7684\u6570\u7ec4 $a$ \uff0c\u82e5\u76f8\u90bb\u4e24\u6570\u4e4b\u5dee\u7684\u7edd\u5bf9\u503c\u4e0d\u8d85\u8fc7 $K$ \u5219\u53ef\u4ee5\u4ea4\u6362\uff0c\u95ee\u80fd\u5f97\u5230\u7684\u6240\u6709 $a$ \u4e2d\u5b57\u5178\u5e8f\u6700\u5c0f\u7684\u4e00\u4e2a\u3002 \n\n\u6570\u636e\u8303\u56f4\uff1a$1\\le N,K\\le 10^5,1\\le a_i\\le 10^9$\n\n\u53d1\u73b0 $|a_i-a_j| > K$ \u7684\u6570\u65e0\u6cd5\u4ea4\u6362\uff0c\u4e8e\u662f\u8fd9\u4e24\u4e2a\u6570\u7684\u76f8\u5bf9\u4f4d\u7f6e\u662f\u56fa\u5b9a\u7684\u3002\u6362\u8a00\u4e4b\uff0c\u4e0d\u59a8\u8bbe $i<j$ \uff0c\u90a3\u4e48 $a_i$ \u59cb\u7ec8\u4f1a\u5728 $a_j$ \u524d\u9762\u3002\u5bf9\u4e8e\u6240\u6709\u8fd9\u6837\u7684 $(i,j)$ \uff0c\u6211\u4eec\u5c06 $i$ \u5411 $j$ \u8fde\u4e00\u6761\u6709\u5411\u8fb9\uff0c\u6309\u7167\u9898\u76ee\u8981\u6c42\u505a\u62d3\u6251\u6392\u5e8f\u5373\u53ef\u3002\n\n\u5982\u4f55\u505a\uff1f\u6b63\u5e38\u6700\u5c0f\u62d3\u6251\u5e8f\u662f\u628a\u6240\u6709\u5165\u5ea6\u4e3a $0$ \u7684\u70b9\u653e\u5165\u4f18\u5148\u961f\u5217\u4e2d\uff0c\u7136\u540e\u6bcf\u6b21\u53d6\u5806\u9876\u7684\u70b9\u5e76\u5c06\u5176\u8fde\u51fa\u7684\u8fb9\u5220\u9664\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(NK)$ \uff0c\u74f6\u9888\u4e3a\u56fe\u4e2d\u53ef\u80fd\u7684\u8fb9\u6570\u3002\n\n\u601d\u8003\u4e00\u4e0b\u5982\u4f55\u4f18\u5316\uff0c\u9996\u5148\u53ef\u4ee5\u5bf9\u539f\u6570\u7ec4\u79bb\u6563\u5316\uff0c\u7528\u4e00\u4e2a\u7ebf\u6bb5\u6811\u6765\u7ef4\u62a4\u5f53\u524d\u53ef\u80fd\u7684\u6700\u5c0f\u4f4d\u7f6e\uff0c\u6bcf\u6b21\u53d6\u51fa\u4f5c\u4e3a\u7b54\u6848\u5e76\u66f4\u65b0\u4e0e\u5176\u6709\u8fde\u8fb9\u7684\u70b9\u7684\u5165\u5ea6\u5373\u53ef\u3002\u5177\u4f53\u5730\uff0c\u82e5\u5f53\u524d\u70b9\u7684\u6743\u503c\u4e3a $u$ \uff0c\u5219 $[1,m]\\setminus[u-K+1,u+K-1]$ \u4e2d\u7684\u6240\u6709\u6743\u503c\u5bf9\u5e94\u7684\u70b9\u7684\u5165\u5ea6 $-1$ \u3002\u9700\u8981\u4e00\u4e2a\u5e26\u61d2\u6807\u8bb0\u7ebf\u6bb5\u6811\u505a\u533a\u95f4\u66f4\u65b0\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(N\\log N)$\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i,a,b) for(int i=(a);i<=(b);++i)\n#define per(i,a,b) for(int i=(a);i>=(b);--i)\n#define pii pair<int,int>\n#define vi vector<int>\n#define fi first\n#define se second\n#define pb push_back\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n#define ALL(x) x.begin(),x.end()\n#define sz(x) int(x.size())\n#define ll long long\nusing namespace std;\ninline ll read(){\n    ll x=0,f=1;char ch=getchar();\n    while (!isdigit(ch)){if (ch=='-') f=-1;ch=getchar();}\n    while (isdigit(ch)){x=x*10+ch-48;ch=getchar();}\n    return x*f;\n}\nconst int N=2e5+5;\nint n,K,a[N],val[N],deg[N];\nunordered_map <int,int> vis;\n#define ls (p<<1)\n#define rs (ls|1)\n#define mid ((L+R)>>1)\npii t[N<<2];\nint tag[N<<2];\ninline pii Min(const pii a,const pii b){\n    if(a.se == b.se)return make_pair(min(a.fi,b.fi),a.se);\n    return a.se < b.se ? a : b;\n}\nvoid build(int p,int L,int R){\n    if(L == R){\n        t[p] = make_pair(L,deg[L]);\n        return;\n    }\n    build(ls,L,mid),build(rs,mid+1,R);\n    t[p] = Min(t[ls],t[rs]);\n}\nvoid push(int p,int v){tag[p] += v,t[p].se += v;}\nvoid down(int p){\n    if(!tag[p])return;\n    push(ls,tag[p]),push(rs,tag[p]);\n    tag[p] = 0;\n}\nvoid upd(int p,int L,int R,int l,int r,int v){\n    if(l > R || r < L)return;\n    if(l <= L && R <= r){\n        push(p,v);\n        return;\n    }\n    down(p);\n    upd(ls,L,mid,l,r,v),upd(rs,mid+1,R,l,r,v);\n    t[p] = Min(t[ls],t[rs]);\n}\nint T[N];\nvoid add(int x){for(;x <= n;x += x & -x)T[x]++;}\nint Q(int x){\n    int res = 0;\n    for(;x;x -= x & -x)res += T[x];\n    return res;\n} \nint main(){\n    n = read(),K = read();\n    rep(i,1,n)a[i] = read(),val[i] = a[i];\n    sort(val+1,val+n+1);\n    rep(i,1,n){\n        vis[a[i]]++;\n        a[i] = lower_bound(val+1,val+n+1,a[i]) - val + vis[a[i]] - 1;\n    }\n    //calculating in-degree\n    rep(i,1,n){\n        int x = lower_bound(val+1,val+n+1,val[a[i]]-K) - val - 1;\n        int y = lower_bound(val+1,val+n+1,val[a[i]]+K+1) - val - 1;\n        deg[a[i]] = (i-1) + Q(x) - Q(y);\n        add(a[i]);\n    }\n    build(1,1,n);\n    rep(i,1,n){\n        int u = t[1].fi;\n        cout << val[u] << '\\n';\n        int x = lower_bound(val+1,val+n+1,val[u]-K) - val - 1;\n        //cout << 1 << ' ' << x << '\\n';\n        int y = lower_bound(val+1,val+n+1,val[u]+K+1) - val - 1;\n        //cout << y+1 << ' ' << n << '\\n';\n        //cout << u << ' ' << u << '\\n';\n        upd(1,1,n,1,x,-1);\n        upd(1,1,n,y+1,n,-1);\n        upd(1,1,n,u,u,n);\n    }\n    return 0;\n}\n```",
        "postTime": 1643753247,
        "uid": 218501,
        "name": "ETHANK",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 [USACO22JAN] Minimizing Haybales P"
    },
    {
        "content": "\u8003\u8651\u4ece\u524d\u5230\u540e\u904d\u5386\u6bcf\u4e00\u4e2a\u8349\u5806\uff0c\u8bbe\u5f53\u524d\u8981\u52a0\u5165\u7b2c $i$ \u4e2a\u8349\u5806\uff0c\u524d $i-1$ \u4e2a\u8349\u5806\u5df2\u7ecf\u6ee1\u8db3\u5b57\u5178\u5e8f\u6700\u5c0f\uff0c\u4f4d\u7f6e $x$ \u662f\u539f\u6765\u7684\u7b2c $p_x$ \u4e2a\u8349\u5806\u3002\n\n\u82e5\u53ef\u4ee5\u5c06 $i$ \u63d2\u5230\u4f4d\u7f6e $x$ \u540e\u9762\uff0c\u5219\u9700\u8981\u6ee1\u8db3 $h_{p_{x+1}},h_{p_{x+2}}\\cdots h_{p_{i-1}}\\in[h_i-k,h_i+k]$\u3002\u627e\u5230\u6700\u5c0f\u7684\u6ee1\u8db3\u8fd9\u4e2a\u6027\u8d28\u7684 $x$\u3002\u5bb9\u6613\u53d1\u73b0\u63d2\u5230\u4f4d\u7f6e $x,x+1\\cdots i-1$ \u540e\u9762\u90fd\u662f\u53ef\u884c\u7684\u3002\n\n\u8003\u8651\u63d2\u5230\u54ea\u4e2a\u4f4d\u7f6e\u6700\u4f18\u3002\u82e5 $h_j>h_i$\uff0c\u5219\u5c06 $i$ \u63d2\u5230 $j$ \u7684\u524d\u9762\uff0c\u5b57\u5178\u5e8f\u4f1a\u53d8\u5c0f\u3002\u627e\u5230\u6700\u5c0f\u7684 $y$ \u6ee1\u8db3 $h_{y+1}>h_i$\uff0c\u5c06 $i$ \u63d2\u5230 $y$ \u540e\u9762\u5373\u53ef\u3002\n\n\u8003\u8651\u5e73\u8861\u6811\u7ef4\u62a4\u3002\u6bcf\u4e2a\u7ed3\u70b9\u7ef4\u62a4\u5b50\u6811 $size$\uff0c$h$ \u7684\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\u3002\u9700\u8981\u652f\u6301\u5408\u5e76\uff0c\u6309 $size$ \u5206\u88c2\uff0c\u4e24\u79cd\u5e73\u8861\u6811\u4e0a\u4e8c\u5206\uff08\u5206\u522b\u627e $x,y$\uff09\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nmt19937 rd(time(0));\nstruct T{\n\tint l,r,d,mn,mx,s,h;\n}s[100009];\nint n,k,h,r;\nvoid up(int x){//\u66f4\u65b0size\uff0c\u6700\u5927\u503c\uff0c\u6700\u5c0f\u503c\n\ts[x].mn=min(s[x].h,min(s[s[x].l].mn,s[s[x].r].mn));\n\ts[x].mx=max(s[x].h,max(s[s[x].l].mx,s[s[x].r].mx));\n\ts[x].s=s[s[x].l].s+s[s[x].r].s+1;\n}\nvoid sp(int x,int k,int&p,int&q){//\u5206\u88c2\n\tif(!x){p=q=0;return;}\n\tif(s[s[x].l].s<k)p=x,sp(s[x].r,k-s[s[x].l].s-1,s[x].r,q);else q=x,sp(s[x].l,k,p,s[x].l);\n\tup(x);\n}\nint mg(int x,int y){//\u5408\u5e76\n\tif(!x||!y)return x|y;\n\tif(s[x].d<s[y].d)return s[x].r=mg(s[x].r,y),up(x),x;\n\treturn s[y].l=mg(x,s[y].l),up(y),y;\n}\nint e1(int x){//\u6c42\u6700\u5c0f\u7684w\u6ee1\u8db3x\u5b50\u6811\u5185\u7b2cw+1~sizex\u4e2a\u5143\u7d20\u5c5e\u4e8e[h-k,h+k]\n\tint w=0;\n\twhile(x)if(min(s[x].h,s[s[x].r].mn)<h-k||max(s[x].h,s[s[x].r].mx)>h+k)w+=s[s[x].l].s+1,x=s[x].r;else x=s[x].l;\n\treturn w;\n}\nint e2(int x){//\u6c42\u6700\u5c0f\u7684w\u6ee1\u8db3x\u5b50\u6811\u5185\u7b2cw+1\u4e2a\u5143\u7d20\u5927\u4e8eh\n\tint w=0;\n\twhile(x)if(max(s[s[x].l].mx,s[x].h)>h)x=s[x].l;else w+=s[s[x].l].s+1,x=s[x].r;\n\treturn w;\n}\nvoid dfs(int x){if(x)dfs(s[x].l),cout<<s[x].h<<'\\n',dfs(s[x].r);}//\u4e2d\u5e8f\u904d\u5386\nint main(){ios::sync_with_stdio(0),cin.tie(0);\n\tint i,x,y;\n\tfor(cin>>n>>k,s[0].mn=2e9,s[0].mx=0,i=1;i<=n;++i){\n\t\tcin>>h,s[i]={0,0,(int)rd(),h,h,1,h};\n\t\tsp(r,e1(r),x,r),sp(r,e2(r),y,r),r=mg(mg(x,y),mg(i,r));\n\t}\n\tdfs(r);\n}\n```\n",
        "postTime": 1647423382,
        "uid": 221955,
        "name": "panyf",
        "ccfLevel": 10,
        "title": "P8099 [USACO22JAN] Minimizing Haybales P\uff08\u5e73\u8861\u6811\u4e0a\u4e8c\u5206\uff09"
    },
    {
        "content": "\u65e2\u7136\u8fd9\u9053\u9898 $N\\leqslant10^5$ \uff0c\u4e3a\u4ec0\u4e48\u6ca1\u6709\u4eba\u5199\u5206\u5757\u5462\uff1f\n\n\u9996\u5148\u8003\u8651\u5728\u6700\u7ec8\u6570\u5217\u4e2d\u5728\u7b2c\u4e00\u4e2a\u7684\u6570\uff0c\u5047\u8bbe\u5b83\u539f\u6765\u5728\u7b2c $i$ \u4f4d\uff0c\u4e5f\u5c31\u662f $h_i$ \uff0c\u90a3\u4e48\u5b83\u5fc5\u7136\u8981\u548c $h_1,h_2\\dots h_{i-1}$ \u4ea4\u6362\uff0c\u4e5f\u5c31\u662f\u8bf4 $h_1,h_2\\dots h_{I-1}\\in[h_i-K,h_i+K]$ \u3002\n\n\u8fd9\u65f6\u5019\u8d2a\u5fc3\u7684\u601d\u8def\u5c31\u51fa\u6765\u4e86\uff1a\u8003\u8651\u6240\u6709\u8fd8\u6ca1\u6709\u88ab\u9009\u7684\u6570\uff0c\u627e\u5230\u91cc\u9762\u6700\u5c0f\u7684 $h_i$ \uff0c\u4f7f\u5f97\u6240\u6709\u7684 $h_1,h_2\\dots h_{I-1}\\in[h_i-K,h_i+K]$ \uff0c\u5c06\u8fd9\u4e2a\u6570\u653e\u5728\u5f53\u524d\u7684\u6700\u524d\u9762\u4e00\u4f4d\uff0c\u4ece\u539f\u5e8f\u5217\u4e2d\u5254\u9664\u8fd9\u4e2a\u6570\uff0c\u7136\u540e\u9012\u5f52\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u8fd9\u6837\u6211\u4eec\u83b7\u5f97\u4e86 $O(N^2)$ \u7684\u505a\u6cd5\u3002\n\n\u63a5\u7740\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u5bf9\u4e8e $i<j$ \uff0c\u5982\u679c $h_i\\notin[h_j-K,h_j+K]$ \u90a3\u4e48 $h_i$ \u5fc5\u7136\u5728 $h_j$ \u524d\u9762\uff0c\u627e\u5230\u6240\u6709\u8fd9\u6837\u7684\u504f\u5e8f\u5173\u7cfb\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a DAG \uff0c\u53ea\u9700\u8981\u5728\u4e0a\u9762\u627e\u5b57\u5178\u5e8f\u6700\u5c0f\u62d3\u6251\u6392\u5e8f\u5373\u53ef\u3002\n\n\u4f46\u662f\u8003\u8651\u5230\u5b83\u7684\u8fb9\u6570\u4f1a\u8fbe\u5230 $O(N^2)$ \uff0c\u4ecd\u7136\u4f1a\u88ab\u5361\uff0c\u6240\u4ee5\u8003\u8651\u5206\u5757\u66b4\u529b\u7ef4\u62a4\u6bcf\u4e00\u6b21\u8d2a\u5fc3\u7684\u9009\u62e9\uff0c\u4e0b\u9762\u8bb0\u5757\u6570\u4e3a $B$ \u3002\n\n\u5bf9\u4e8e\u5757\u5185\u7684\u6570\uff0c\u66b4\u529b\u7ef4\u62a4\uff0c\u627e\u5230\u6240\u6709\u6ca1\u6709\u88ab\u5757\u5185\u5176\u4ed6\u6570\u9650\u5236\u7684\u6240\u6709\u6570\uff0c\u4ee5 $h_i$ \u4e3a\u7b2c\u4e00\u5173\u952e\u5b57\uff0c\u4ee5 $i$ \u4e3a\u7b2c\u4e8c\u5173\u952e\u5b57\u6392\u5e8f\uff0c\u5355\u6b21\u590d\u6742\u5ea6\u4e3a $O\\left(\\dfrac{n}{B}\\log(\\dfrac{n}{B})\\right)$ \u3002\n\n\u6bcf\u4e00\u6b21\u627e\u7b54\u6848\uff0c\u4ece\u7b2c\u4e00\u4e2a\u8fd8\u6709\u6570\u5b57\u6ca1\u9009\u7684\u5757\u5f00\u59cb\uff0c\u627e\u5230\u5f53\u524d\u7684\u6700\u5c0f\u503c\u4ee5\u53ca\u5757\u5185\u6240\u6709\u503c\u4e2d\u7684\u6700\u5927\u503c $maxn$ \u548c\u6700\u5c0f\u503c $minn$ \u3002\u63a5\u4e0b\u6765\u7684\u6bcf\u4e00\u4e2a\u5757\uff0c\u627e\u5230\u6240\u6709\u7684\u5728 $[max-K,min+K]$ \uff08\u8fd9\u4e2a\u533a\u95f4\u53ef\u80fd\u4e3a\u7a7a\uff09\u4e2d\u7684\u6700\u5c0f\u503c\uff0c\u53d6\u6240\u6709\u8fd9\u4e9b\u503c\u4e2d\u7684\u6700\u5c0f\u503c\u4e3a\u7b54\u6848\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u590d\u6742\u5ea6\u4e3a $O\\left(B\\log(\\dfrac{N}{B})\\right)$ \u3002\u6bcf\u4e00\u6b21\u627e\u5230\u8d2a\u5fc3\u503c\u4e4b\u540e\uff0c\u66b4\u529b\u91cd\u505a\u4e00\u904d\u8d2a\u5fc3\u503c\u6240\u5728\u5757\u5373\u53ef\u3002\n\n\u6240\u4ee5\u603b\u4f53\u590d\u6742\u5ea6\u4e3a $O\\left(N\\times \\dfrac{N}{B}\\log(\\dfrac{N}{B})+N\\times (B\\log(\\dfrac{N}{B})+\\dfrac{N}{B}\\log(\\dfrac{N}{B}))\\right)$ \u3002\u590d\u6742\u5ea6\u5728 $B=\\sqrt{N}$ \u65f6\u53d6\u6700\u4f18\uff0c\u4e3a $O(N\\sqrt{N}\\log N)$ \u3002\u5f00 O2 \u80fd\u8fc7\uff0c\u800c\u4e14\u7ebf\u6027\u7a7a\u95f4\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint Qread()\n{\n\tint x=0;char ch=getchar();\n\twhile(ch<'0'||ch>'9') ch=getchar();\n\twhile(ch>='0'&&ch<='9') x=x*10+(ch^48),ch=getchar();\n\treturn x; \n}\ntypedef pair<int,int> pr;\ntypedef pair<int,bool> ps;\nint n,k,i,bel,a;\nint B,Bnum;\nbool vis[100010];\nint ans[100010];\nvector<pr> abl[1010];//able num in block\nvector<ps> num[1010];//number in each block\npr qz[1010],gjz;//[maxn,minn] of each block\nint las[1010];//last number cnt in each block\nvoid Bsolv(int id)//solv in B\n{\n\tint lim=num[id].size();\n\tqz[id]=make_pair(-1,-1);bool hv=false;\n\tabl[id].clear();\n\tfor(int i=0;i<lim;i++)\n\t{\n\t\tif(num[id][i].second) continue;\n\t\tif(!hv) abl[id].push_back(make_pair(num[id][i].first,i)),qz[id].first=qz[id].second=num[id][i].first,hv=true;\n\t\telse\n\t\t{\n\t\t\tif(num[id][i].first-k<=qz[id].first&&qz[id].second<=num[id][i].first+k) abl[id].push_back(make_pair(num[id][i].first,i));\n\t\t\tqz[id].first=min(qz[id].first,num[id][i].first);\n\t\t\tqz[id].second=max(qz[id].second,num[id][i].first);\n\t\t}\n\t}\n\tsort(abl[id].begin(),abl[id].end());\n\tlim=abl[id].size();\n\treturn;\n}\nint solve()\n{\n\tint Bid=0,inBid=0,ret=20070610,d;\n\tpr lim;bool hv=false;\n\tfor(int i=1;i<=Bnum;i++)\n\t{\n\t\tif(las[i]==0) continue;\n\t\tif(!hv)\n\t\t{\n\t\t\tBid=i,inBid=0;\n\t\t\tret=abl[i][0].first;\n\t\t\tlim=qz[i];hv=true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(lim.second-lim.first>2*k) break;\n\t\t\tgjz=make_pair(lim.second-k,-1);\n\t\t\td=upper_bound(abl[i].begin(),abl[i].end(),gjz)-abl[i].begin();\n\t\t\tif(d!=(int)abl[i].size()&&abl[i][d].first<=lim.first+k&&ret>abl[i][d].first) Bid=i,inBid=d,ret=abl[i][d].first;\n\t\t\tlim.first=min(lim.first,qz[i].first);\n\t\t\tlim.second=max(lim.second,qz[i].second);\n\t\t}\n\t} \n\tnum[Bid][abl[Bid][inBid].second].second=true;las[Bid]--;\n\tBsolv(Bid);\n\treturn ret;\n}\nint main()\n{\n\tn=Qread(),k=Qread();\n\tB=sqrt(n);\n\tfor(i=1;i<=n;i++)\n\t{\n\t\tbel=(i-1)/B+1;\n\t\ta=Qread();\n\t\tnum[bel].push_back(make_pair(a,false));\n\t\tlas[bel]++;\n\t}\n\tBnum=(n-1)/B+1;\n\tfor(i=1;i<=Bnum;i++)\n\t\tBsolv(i);\n\tfor(i=1;i<=n;i++)\n\t\tans[i]=solve();\n\tfor(i=1;i<=n;i++)\n\t\tprintf(\"%d\\n\",ans[i]);\n\treturn 0;\n } \n```\n",
        "postTime": 1668841748,
        "uid": 263594,
        "name": "\u5bfb\u900d\u90652006",
        "ccfLevel": 8,
        "title": "P8099 [USACO22JAN] Minimizing Haybales P \u9898\u89e3"
    },
    {
        "content": "\u7531 `[AGC001F] Wide Swap` \u53ef\u77e5\u4e00\u4e2a\u7ed3\u8bba\uff0c\u82e5 $i < j,|h_i-h_j|> k$ \u5219\u65e0\u8bba\u600e\u4e48\u4ea4\u6362\uff0c$h_i,h_j$ \u7684\u76f8\u5bf9\u4f4d\u7f6e\u4e0d\u4f1a\u6539\u53d8\u3002\n\n\u636e\u6b64\uff0c\u6211\u4eec\u66b4\u529b\u8fde\u8fb9\uff0c\u6bcf\u6761\u8fb9\u8868\u793a $h_i$ \u5fc5\u987b\u5f97\u5728 $h_j$\uff0c\u7136\u540e\u7528\u4e00\u4e2a\u5806\u62d3\u6251\u4e00\u904d\u5373\u53ef\u5f97\u51fa\u6700\u5c0f\u5b57\u5178\u5e8f\n\n\u8003\u8651\u4f7f\u7528\u6570\u636e\u7ed3\u6784\u4f18\u5316\u8fd9\u4e2a\u5efa\u56fe\u65b9\u5f0f\n\n\u8003\u8651\u4f7f\u7528\u5efa\u4e00\u68f5\u6743\u503c\u4e3b\u5e2d\u6811\uff0c\u4e0a\u9762\u5168\u662f\u865a\u70b9\uff0c\u6bcf\u6b21\u52a0\u5165\u65b0\u7684 $h_i$ \u6211\u4eec\u5728\u53f6\u5b50\u4e0a\u5c06 $i$ \u8fde\u4e0a\u8fd9\u4e2a\u6743\u503c\uff0c\u518d\u4e00\u8def\u5411\u7956\u5148\u8fde\uff1b\u6bcf\u6b21\u8fde\u6240\u6709\u6ee1\u8db3 $i < j,|h_i-h_j|> k$  \u7684\u8fb9\u53ea\u9700\u5728\u6743\u503c\u4e3b\u5e2d\u6811\u4e0a\u5c06\u5bf9\u5e94\u7684\u533a\u95f4\u8fde\u4e00\u4e0b\u5373\u53ef\u3002\n\n\u6700\u540e\u8fd8\u662f\u7528\u4e00\u4e2a\u5806\u6765\u62d3\u6251\uff0c\u6709\u4e00\u4e2a\u7ec6\u8282\u662f\uff0c\u4f18\u5148\u5c06\u5806\uff08\u5373\u5f53\u524d\u5165\u5ea6\u4e3a $0$ \u7684\u70b9\uff09\u4e2d\u865a\u70b9\u62ff\u51fa\u6765\u5904\u7406\u3002\n\n\u6ce8\u610f\uff0c\u4e3b\u5e2d\u6811\u65b0\u5efa\u70b9\u65f6\u5e94\u5f53\u628a\u65e7\u7684\u70b9\u5411\u65b0\u7684\u70b9\u8fde\u8fb9\uff0c\u5426\u5219\u4f1a\u88ab\n\n```\n9 5\n2\n1\n6\n2\n2\n10\n6\n10\n3\n```\n\n\u8fd9\u7ec4\u6570\u636e hack \uff0c\u539f\u56e0\u662f\u4e3b\u5e2d\u6811\u4e0a\u65b0\u5efa\u4e00\u8fde\u4e32\u865a\u70b9\u7684\u540c\u65f6\uff0c\u539f\u6765\u7684\u9650\u5236\u53ef\u80fd\u4e22\u5931\uff0c~~\u7136\u9e45\u8fd9\u9898\u6570\u636e\u8fc7\u6c34\u6240\u4ee5\u7ec3\u4e60\u8d5b\u65f6\u6211\u6ca1\u6709\u8003\u8651\u5230\u8fd9\u4e2a\u95ee\u9898\u4e5fA\u4e86~~\u3002\n\n\n```cpp\n/* ==============================\n *  Author : Odalys \n *\n *  Blog : Odalys.xyz\n *\n *  Mail : minyuenu@gmail.com\n * =============================== */\n#include <bits/stdc++.h>\nusing namespace std;\ntemplate <typename T> inline void read(T &a){\n    T w = 1; a = 0;\n    char ch = getchar();\n    for(; ch < '0' || ch > '9'; ch = getchar()) if(ch == '-') w = -1;\n    for(; ch >= '0' && ch <= '9'; ch = getchar()) a = (a * 10) + (ch - '0');\n    a *= w;\n}\ntemplate <typename T> inline void ckmax(T &a, T b){a = a > b ? a : b;}\ntemplate <typename T> inline void ckmin(T &a, T b){a = a < b ? a : b;}\n#define fi first\n#define se second\n#define pb push_back\n#define mp make_pair\n#define mii map<int, int> \n#define pii pair<int, int> \n#define vi vector<int>\n#define si set<int> \n#define ins insert\n#define era erase\n#define Debug(x) cout << #x << \" = \" << x << endl\n#define For(i,l,r) for (int i = l; i <= r; ++i) \n#define foR(i,l,r) for (int i = l; i >= r; --i)\nconst int N = 1e5 + 10;\nvi to[N * 40];\nint du[N * 40];\nstruct SGT {\n\tint l, r, siz;\n} tr[N * 30];\n#define ls tr[x].l\n#define rs tr[x].r\n\nint rt[N];\nint total;\nint Id () { return ++total; }\ninline void pushup (int x) {\n\tif (tr[ls].siz) to[ls].pb(x), du[x]++;\n\tif (tr[rs].siz) to[rs].pb(x), du[x]++; \n\ttr[x].siz |= tr[ls].siz; \n\ttr[x].siz |= tr[rs].siz;\n}\nvoid Build (int &x, int l, int r) {\n\tif (!x) x = Id(); \n//\tDebug(x); cout << l << \" \" << r << endl; \n\tif (l == r) return;\n\tint mid = l + r >> 1;\n\tBuild(ls, l, mid), Build(rs, mid + 1, r);\n\tpushup(x); \n}\nvoid Insert (int &x, int y, int l, int r, int p, int id) {\n\tif (!x) x = Id(); \n\tif (l == r) return (du[x]++, to[id].pb(x), tr[x].siz = 1), void();\n\ttr[x] = tr[y];\n\tint mid = l + r >> 1;\n\tif (p <= mid) {\n\t\tls = 0, Insert(ls, tr[y].l, l, mid, p, id);\n\t\tif (tr[tr[y].l].siz) to[tr[y].l].pb(tr[x].l), du[tr[x].l]++;\n\t}\n\telse {\n\t\trs = 0, Insert(rs, tr[y].r, mid + 1, r, p, id);\n\t\tif (tr[tr[y].r].siz) to[tr[y].r].pb(tr[x].r), du[tr[x].r]++;\t\n\t}\n\tpushup(x);\n} \n\nvoid Link (int x, int l, int r, int ll, int rr, int p) {\n\tif (!x) return ;\n\tif (!tr[x].siz) return ;\n\tif (ll > rr) return ;\n\tif (ll <= l && r <= rr) return (du[p]++, to[x].pb(p)), void();\n\tint mid = l + r >> 1;\n\tif (ll <= mid) Link(ls, l, mid, ll, rr, p);\n\tif (rr > mid) Link(rs, mid + 1, r, ll, rr, p);\n}\n\nint a[N];\nint lsh[N], lshc;\ninline void Init () {\n\tsort (lsh + 1, lsh + lshc + 1);\n\tlshc = unique (lsh + 1, lsh + lshc + 1) - lsh - 1;\n}\nint GetId (int x) { return lower_bound(lsh + 1, lsh + lshc + 1, x) - lsh; }\nint Get (int x, bool op) {\n\tif (!op) \n\t\treturn lower_bound(lsh + 1, lsh + lshc + 1, x) - lsh - 1;\n\treturn upper_bound(lsh + 1, lsh + lshc + 1, x) - lsh; \n}\nint n, k; \nnamespace Topu {\n\tstruct Node {\n\t\tint id;\t\n\t\tNode (int Id = 0) { id = Id; }\n\t\tbool operator < (const Node x) const{ \n\t\t\tif (id > n || x.id > n) {\n\t\t\t\treturn !(id > n);\n\t\t\t}\n\t\t\treturn a[id] > a[x.id]; \n\t\n\t\t}\n\t};\n\tpriority_queue < Node > q;\n\n\tinline void main() {\n\t\tFor (i, 1, n) if (!du[i]) q.push(Node(i));\n\t\twhile (!q.empty()) {\n\t\t\tint u = q.top().id; q.pop();\n\t\t\tif (u <= n) \n\t\t\t\tprintf (\"%d\\n\", a[u]);\n\t\t\tfor (auto v : to[u]) {\n\t\t\t\tdu[v]--;\n\t\t\t\tif (!du[v]) q.push(Node(v)); \n\t\t\t}\n\t\t}\n\t}\n}\n\nint main() {\n//\tfreopen (\"prod1.in\", \"r\", stdin);\n//\tfreopen (\"prod1.out\", \"w\", stdout);\n\tread(n), read(k);\n\tFor (i, 1, n) read(a[i]), lsh[++lshc] = a[i];\n\tInit(); \n\ttotal = n;\n\tBuild(rt[0], 1, lshc);\n\tInsert(rt[1], rt[0], 1, lshc, GetId(a[1]), 1); \n\tFor (i, 2, n) {\n\t\tint l = Get(a[i] - k, 0), r = Get(a[i] + k, 1);\n\t\t//if (i == n) cout << r << \" \" << lshc << endl;\n\t\tLink(rt[i - 1], 1, lshc, r, lshc, i);\n\t\tLink(rt[i - 1], 1, lshc, 1, l, i);\n\t\tInsert(rt[i], rt[i - 1], 1, lshc, GetId(a[i]), i);\n\t}\t\n\tTopu :: main();\n\treturn 0;\n}\n```\n",
        "postTime": 1644757945,
        "uid": 400028,
        "name": "Odalys",
        "ccfLevel": 0,
        "title": "[USACO22JAN] Minimizing Haybales P"
    },
    {
        "content": "\u5f88\u5bb9\u6613\u60f3\u5230\u5bf9\u4e8e\u4e00\u4e2a\u6570 $a_i$\uff0c\u6211\u4eec\u627e\u5230\u524d\u9762\u7684\u7b2c\u4e00\u4e2a\u6570 $a_j(\\operatorname{abs}(a_i-a_j)>k)$\uff0c\u5bf9\u4e8e $j\\sim i$ \u8fd9\u6bb5\u533a\u95f4\u5185 $a_i$ \u662f\u53ef\u4ee5\u5728\u4efb\u610f\u4f4d\u7f6e\u7684\u3002\n\n\u8003\u8651\u8d2a\u5fc3\uff0c\u5373\u627e\u5230\u533a\u95f4 $j\\sim i$ \u5185\u6700\u5de6\u8fb9\u7b2c\u4e00\u4e2a\u5927\u4e8e $a_i$ \u7684\u6570\uff0c\u5c06 $a_i$ \u63d2\u5165\u5728\u8be5\u6570\u6700\u524d\u9762\u53ef\u4ee5\u4f7f\u5f53\u524d\u7684\u5e8f\u5217\u5b57\u5178\u5e8f\u6700\u5c0f\u3002\n\n\u663e\u7136\u9700\u8981\u4ee5\u4e0b\u4e24\u4e2a\u529f\u80fd\uff1a\n\n- \u533a\u95f4\u6700\u503c\u3002\n- \u5355\u70b9\u63d2\u5165\u3002\n\n\u8003\u8651\u4f7f\u7528\u5206\u5757\u6765\u7ef4\u62a4\uff0c\u5bf9\u4e8e\u6bcf\u6b21\u63d2\u5165\u4e00\u4e2a\u70b9\uff0c\u4ece\u6700\u53f3\u8fb9\u7684\u70b9\u66b4\u529b\u5f80\u5de6\u641c\u5230\u7b2c\u4e00\u4e2a\u4e0d\u53ef\u4ee5\u4ea4\u6362\u7684\u4f4d\u7f6e\uff0c\u5728\u4ece\u8fd9\u4e2a\u4f4d\u7f6e\u5f00\u59cb\u66b4\u529b\u5f80\u5de6\u626b\u627e\u5230\u7b2c\u4e00\u4e2a\u5927\u4e8e\u5f53\u524d\u70b9\u7684\u4f4d\u7f6e\uff0c\u63d2\u5165\u3002\n\n\u518d\u5b9a\u671f\u91cd\u6784\u9632\u6b62\u7206\u5757\u5c31\u884c\u3002\n\n\u4e8b\u5b9e\u4e0a\u5c31\u662f\u6a21\u62df\u6700\u4e0a\u9762\u7684\u4e2a\u66b4\u529b\u3002\n\n\n```cpp\n#include<bits/stdc++.h>\n//#define int long long\n#define mi(...) <%__VA_ARGS__%>\nusing namespace std;\nnamespace Faster {\ninline bool _u(char ch) { return ch >= '0' && ch <= '9'; }\n//char buf[1 << 23], *p1 = buf, *p2 = buf;\n//#define getchar() (p1 == p2 && (p2 = (p1 = buf) + fread(buf, 1, 1 << 23, stdin), p1 == p2) ? EOF : *p1++)\ninline int read() {int x = 0, f = 1;char ch = getchar();for (; !_u(ch); ch = getchar())if (ch == '-')f = -f;for (; _u(ch); ch = getchar()) x = (x << 1) + (x << 3) + (ch ^ 48);return x * f;}\ninline void write(int num) {static int sta[39], top = 0;if (num < 0)putchar('-'), num *= -1;do sta[++top] = num % 10, num /= 10;while (num);while (top) putchar(sta[top--] | 48);return;}\n}using namespace Faster;\nconst int N=1e5+5;\nint n,k,cnt,a[N],b[N],S,ma[N],mi[N];\nvector<int> v[N];\ninline void init(){\n\tint tot=0;\n\tfor(int i=1;i<=cnt;++i){\n\t\tfor(int j=0;j<v[i].size();++j)\n\t\t\tb[++tot]=v[i][j];\n\t\tv[i].clear();\n\t}\n\tmemset(ma,-0x3f,sizeof ma);\n\tmemset(mi,0x3f,sizeof mi);\n\tfor(int i=1;i<=tot;++i){\n\t\tv[(i-1)/S+1].push_back(b[i]);\n\t\tma[(i-1)/S+1]=max(ma[(i-1)/S+1],b[i]);\n\t\tmi[(i-1)/S+1]=min(mi[(i-1)/S+1],b[i]);\n\t}\n\tcnt=(tot-1)/S+1;\n\treturn;\n}\ninline void add(int x,int c){\n\tfor(int i=1;i<=cnt;++i){\n\t\tif(v[i].size()<x) x-=v[i].size();\n\t\telse{\n\t\t\tv[i].insert(v[i].begin()+x,c);\n\t\t\tma[i]=max(ma[i],c);\n\t\t\tmi[i]=min(mi[i],c);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn;\n}\ninline int fnd(int x,int c){\n\tfor(int i=cnt;i>=1;--i){\n\t\tif(abs(ma[i]-c)>k||abs(mi[i]-c)>k)\n\t\t\tfor(int j=v[i].size()-1;j>=0;j--)\n\t\t\t\tif(abs(v[i][j]-c)>k||abs(v[i][j]-c)>k)return x;\n\t\t\t\telse\n\t\t\t\t--x;\n\t\tx-=v[i].size();\n\t}\n\treturn x;\n}\ninline int query1(int x,int c){\n\tint now=0;\n\tfor(int i=1;i<=cnt;i++){\n\t\tif(now+v[i].size()>=x&&ma[i]>c){\n\t\t\tfor(int j=0;j<v[i].size();j++){\n\t\t\t\tnow++;\n\t\t\t\tif(now>=x&&v[i][j]>c)return now-1;\n\t\t\t}\n\t\t\tnow-=v[i].size();\n\t\t}\n\t\tnow+=v[i].size();\n\t}\n\treturn now;\n}\nint main(){\n\tn=read(),k=read();\n\tS=sqrt(n);\n\tfor(int i=1;i<=n;i++) a[i]=read();\n\tfor(int i=1;i<=n;i++){\n\t\tif((i-1)%S==0)init();\n\t\tint now=query1(fnd(i-1,a[i])+1,a[i]);\n\t\tadd(now,a[i]);\n\t}\n\tfor(int i=1;i<=n;++i)\n\t\tfor(int j:v[i])\n\t\t\twrite(j),puts(\"\");\n\treturn(0-0);\n}\n```",
        "postTime": 1684763893,
        "uid": 388414,
        "name": "comcopy",
        "ccfLevel": 0,
        "title": "P8099 [USACO22JAN] Minimizing Haybales P \u9898\u89e3"
    },
    {
        "content": "> [P8099 [USACO22JAN] Minimizing Haybales P](https://www.luogu.com.cn/problem/P8099)\n\n\u4e3a\u4f7f\u5b57\u5178\u5e8f\u5c3d\u91cf\u5c0f\uff0c\u6211\u4eec\u7684\u5927\u81f4\u601d\u8def\u662f\u5c06\u5c0f\u7684\u6570\u5c3d\u91cf\u5f80\u524d\u79fb\u3002\u5177\u4f53\u4e00\u70b9\uff0c\u4f9d\u6b21\u8003\u8651\u6bcf\u4e2a\u4f4d\u7f6e $i$\uff0c\u5c06 $h_i$ \u79fb\u5230\u4ece\u524d\u5f80\u540e\u7b2c\u4e00\u4e2a\u5927\u4e8e $h_i$ \u7684 **\u5408\u6cd5** \u4f4d\u7f6e $p\\ (p\\leq i)$ \u4e4b\u524d\uff0c\u5408\u6cd5\u5373\u6ee1\u8db3 $h_p\\sim h_i$ \u4e0e $h_i$ \u76f8\u5dee\u4e0d\u8d85\u8fc7 $k$\u3002\n\n\u518d\u5f80\u524d\u79fb\u53cd\u800c\u4f1a\u8ba9\u5b57\u5178\u5e8f\u53d8\u5927\uff1a\u524d\u9762\u80fd\u591f\u79fb\u5230\u7684\u4f4d\u7f6e\u4e0a\u7684\u6570\u5747\u4e0d\u5927\u4e8e $h_i$\uff0c\u4e0d\u5982\u4e0d\u79fb\u3002\u4f46\u6211\u4eec\u8fd8\u6709\u4e00\u4e2a\u987e\u8651\uff1a\u5f53\u524d\u51b3\u7b56\u662f\u5426\u4f1a\u5f71\u54cd\u5230\u5168\u5c40\u7ed3\u679c\uff1f\u5373\u662f\u5426\u5b58\u5728 $j > i$\uff0c\u4f7f\u5f97 $h_j$ \u5f88\u5c0f\u4e14\u672c\u6765\u80fd\u79fb\u5230\u5f88\u524d\u9762\uff0c\u4f46 $h_i$ \u8fd9\u6837\u4e00\u632a\uff0c\u5c31\u529e\u4e0d\u5230\u4e86\u5462\uff1f\u5e76\u4e0d\u4f1a\uff0c\u56e0\u4e3a\u82e5 $h_j < h_i$\uff0c\u963b\u6321\u5b83\u7684\u4ec5\u6709\u53ef\u80fd\u662f\u843d\u5728\u533a\u95f4 $(h_j + k, h_i + k]$ \u7684\u6570\uff08\u5bf9\u4e8e\u5c0f\u4e8e $h_j - k$ \u7684\u6570\uff0c$h_i$ \u672c\u6765\u4e5f\u8fc7\u4e0d\u53bb\uff09\uff0c\u8bf4\u660e\u5c31\u7b97 $h_i$ \u4e0d\u79fb\uff0c$h_j$ \u672c\u6765\u5c31\u53ea\u80fd\u5f85\u5728\u8fd9\u4e9b\u6570\u540e\u9762\uff0c\u4e0d\u4f1a\u6bd4\u79fb\u52a8 $h_i$ \u66f4\u4f18\u3002$h_j > h_i$ \u540c\u7406\u3002\n\n\u6839\u636e\u4e0a\u8ff0\u7ed3\u8bba\uff0c\u6211\u4eec\u9996\u5148\u4e8c\u5206\u627e\u5230\u6700\u5de6\u8fb9\u7684\u5408\u6cd5\u4f4d\u7f6e\uff0c\u518d\u4e8c\u5206\u627e\u5230\u6700\u5de6\u8fb9\u7684\u7b2c\u4e00\u4e2a\u5927\u4e8e $h_i$ \u7684\u5408\u6cd5\u4f4d\u7f6e $p$\uff0c\u7136\u540e\u628a $h_i$ \u632a\u5230 $h_p$ \u524d\u9762\u3002\u82e5\u76f4\u63a5\u5c06\u4e8c\u5206\u548c\u5e73\u8861\u6811\u751f\u786c\u5730\u7ed3\u5408\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u7ebf\u6027\u5bf9\u6570\u5e73\u65b9\uff0c\u4e0d\u5f00 O2 \u96be\u4ee5\u901a\u8fc7\uff0c\u751a\u81f3\u5f00\u4e86 O2 \u90fd\u8363\u81ba\u6700\u52a3\u89e3\uff0841.82s\uff09\u3002\u4f46\u82e5\u76f4\u63a5\u5728\u5e73\u8861\u6811\u4e0a\u4e8c\u5206\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u964d\u81f3\u7ebf\u6027\u5bf9\u6570\uff0c\u6bd4 $\\log ^ 2 n$ \u5feb\u4e86\u5c06\u8fd1 20 \u500d\uff082.21s\uff09\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\ninline int read() {\n\tint x = 0; char s = getchar();\n\twhile(!isdigit(s)) s = getchar();\n\twhile(isdigit(s)) x = x * 10 + s - '0', s = getchar();\n\treturn x;\n}\ninline void print(int x) {\n\tif(x >= 10) print(x / 10);\n\tputchar(x % 10 + '0');\n}\n\nconst int N = 1e5 + 5;\nint ls[N], rs[N], mn[N], mx[N], val[N];\nint n, k, R, node, rd[N], sz[N];\nvoid push(int x) {\n\tmn[x] = min(min(mn[ls[x]], mn[rs[x]]), val[x]);\n\tmx[x] = max(max(mx[ls[x]], mx[rs[x]]), val[x]);\n\tsz[x] = sz[ls[x]] + sz[rs[x]] + 1;\n}\nint nnode(int v) {\n\tint x = ++node;\n\tval[x] = mn[x] = mx[x] = v, sz[x] = 1;\n\treturn rd[x] = rand(), ls[x] = rs[x] = 0, x;\n}\nint merge(int x, int y) {\n\tif(!x || !y) return x | y;\n\tif(rd[x] > rd[y]) return rs[x] = merge(rs[x], y), push(x), x;\n\treturn ls[y] = merge(x, ls[y]), push(y), y;\n}\nvoid split(int p, int &x, int &y, int k) {\n\tif(!p) return x = y = 0, void();\n\tif(k <= sz[ls[p]]) split(ls[p], x, ls[y = p], k);\n\telse split(rs[p], rs[x = p], y, k - sz[ls[p]] - 1);\n\tpush(p);\n}\nvoid move(int i, int p) {\n\tint a, b, c, d; if(i == p) return;\n\tsplit(R, c, d, i), split(c, b, c, i - 1), split(b, a, b, p - 1);\n\tR = merge(a, merge(c, merge(b, d))); \n}\nvoid dfs(int x) {\n\tif(!x) return;\n\tdfs(ls[x]), print(val[x]), putchar('\\n'), dfs(rs[x]);\n}\n\nint main() {\n\tcin >> n >> k, mn[0] = 1e9;\n\tfor(int i = 1; i <= n; i++) {\n\t\tint p, x, tot = 0, l, h = read();\n\t\tp = R = merge(R, nnode(h));\n\t\twhile(p) {\n\t\t\tint r = rs[p];\n\t\t\tif(mx[r] - h > k || h - mn[r] > k) p = r;\n\t\t\telse if(val[p] - h > k || h - val[p] > k) {tot += sz[r]; break;}\n\t\t\telse p = ls[p], tot += sz[r] + 1;\n\t\t} if(tot == 1) continue;\n\t\tsplit(R, R, x, l = i - tot), tot = 0, p = x;\n\t\tif(mx[x] == h) {R = merge(R, x); continue;}\n\t\twhile(p) {\n\t\t\tint l = ls[p];\n\t\t\tif(mx[l] > h) p = l;\n\t\t\telse if(val[p] > h) {tot += sz[l]; break;}\n\t\t\telse p = rs[p], tot += sz[l] + 1;\n\t\t} R = merge(R, x), move(i, l + tot + 1);\n\t} dfs(R);\n\treturn 0;\n}\n```",
        "postTime": 1643982372,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "P8099 [USACO22JAN] Minimizing Haybales P"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u4e2a\u65e0\u8111\u505a\u6cd5\u3002\u662f\u76ee\u524d\u6700\u52a3\u89e3\u2026\u2026\n\n\u8003\u8651\u4e24\u4e2a\u8349\u5806 $x,y$ \u82e5\u6ee1\u8db3 $x<y$ \u4e14 $|h_x-h_y|>K$\uff0c\u90a3\u4e48\u663e\u7136\u65e0\u8bba\u600e\u4e48\u4ea4\u6362 $x$ \u6c38\u8fdc\u5728 $y$ \u524d\u9762\u3002\u56e0\u6b64\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8fd9\u6837\u7684 $x,y$\uff0c\u4ece $x$ \u5411 $y$ \u8fde\u8fb9\u3002\n\n\u7b54\u6848\u5e94\u8be5\u662f\u5efa\u51fa\u7684\u56fe\u7684\u6700\u5c0f\u5b57\u5178\u5e8f\uff08\u6743\u503c\u662f $h$\uff09\u7684\u62d3\u6251\u5e8f\u3002\u8fd9\u6837\u5f88\u660e\u663e\u662f $n^2$ \u7684\u7b97\u6cd5\uff0c\u6211\u4eec\u8003\u8651\u4f18\u5316\u5efa\u56fe\u3002\n\n\u8003\u8651\u7edd\u5bf9\u503c\u62c6\u5f00\u3002\u8003\u8651\u6309\u7167 $h$ \u7684\u5927\u5c0f\u4f9d\u6b21\u628a\u6bcf\u4e2a\u70b9\u52a0\u5165\u7ebf\u6bb5\u6811\uff0c\u4e8e\u662f\u5bf9\u4e8e $y$ \u8fd9\u4e2a\u70b9\u52a0\u8fb9\u7684\u65f6\u5019\uff0c\u53ea\u8981\u8003\u8651\u524d\u9762\u67d0\u68f5\u7ebf\u6bb5\u6811\uff08\u6ee1\u8db3\u6240\u6709 $h_i<h_y-K$\uff09\u7684\u533a\u95f4 $[1,y]$ \u52a0\u8fb9\u5c31\u884c\u4e86\u3002\u53ef\u4ee5\u7528 lower_bound \u627e\u5230\u8fd9\u68f5\u7ebf\u6bb5\u6811\u3002\n\n\u8fd9\u91cc\u6211\u5c31\u5199\u4e86\u4e3b\u5e2d\u6811\u3002\u5f53\u7136\u7531\u4e8e\u7edd\u5bf9\u503c\uff0c\u53cd\u8fc7\u6765\u4e5f\u8981\u8dd1\u4e00\u904d\u3002\u4e8e\u662f\u5efa\u5b8c\u56fe\u8dd1\u4e00\u4e0b\u62d3\u6251\u5e8f\u5c31\u884c\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u5e94\u5f53\u662f $O(n\\log n)$ \u7684\uff0c\u4f46\u662f\u5e38\u6570\u4f3c\u4e4e\u5de8\u5927\u3002",
        "postTime": 1643949268,
        "uid": 151475,
        "name": "Little09",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P8099 [USACO22JAN] Minimizing Haybales P"
    }
]
[
    {
        "content": "\u611f\u89c9\u8fd9\u9898\u6bd4[\u70ef\u70c3\u8ba1\u6570](https://www.luogu.com.cn/problem/P6597)\u96be\u4e00\u70b9\u554a\n\n\u524d\u7f6e\u77e5\u8bc6:[\u70f7\u57fa\u8ba1\u6570](https://loj.ac/problem/6538)\n\n## \u70f7\u70c3\u8ba1\u6570\n\n\u5df2\u77e5\u78b3\u539f\u5b50\u4e2a\u6570 $n$\uff0c\u6c42\u5bf9\u5e94\u7684\u70f7\u70c3\u6709\u591a\u5c11\u79cd\u540c\u5206\u5f02\u6784\u4f53\n\n\u4e0d\u8003\u8651\u7a7a\u95f4\u5f02\u6784\n\n### \u9898\u89e3\n\n\u5c31\u662f $n$ \u4e2a\u70b9\u7684\u6bcf\u4e2a\u70b9\u7684\u5ea6\u6570\u4e2a\u6570 $\\leq 4$ \u7684\u65e0\u6807\u53f7\u65e0\u6839\u6811\u8ba1\u6570\n\n\u53c2\u8003[\u535a\u5ba2](https://blog.csdn.net/qq_35950004/article/details/105228566)\n\n\u65e0\u6807\u53f7\u65e0\u6839\u6570\u8fd8\u662f\u5f88\u96be\u505a,\u8003\u8651\u600e\u4e48\u505a\u6210\u9664\u6839\u8282\u70b9\u5916\u6bcf\u4e2a\u70b9\u7684\u5b50\u8282\u70b9\u4e2a\u6570 $\\leq 3$,\u6839\u8282\u70b9\u7684\u5b50\u8282\u70b9\u4e2a\u6570 $\\leq 4$ \u7684\u65e0\u6807\u53f7\u6709\u6839\u6811\u8ba1\u6570\n\n>\u8003\u8651\u5bf9\u4e8e\u4e00\u68f5\u65e0\u6839\u6811,\u8bbe\u679a\u4e3e\u4e00\u4e2a\u70b9\u4e3a\u5173\u952e\u70b9,\u6574\u68f5\u6811\u7684\u70b9\u7b49\u4ef7\u7c7b\u6570\u4e3a $p$ ,\u679a\u4e3e\u4e00\u6761\u8fb9\u4e3a\u5173\u952e\u8fb9,\u6574\u68f5\u6811\u7684\u8fb9\u7b49\u4ef7\u7c7b\u6570\u4e3a $q$,\u8bbe $s=1$ \u5f53\u4e14\u4ec5\u5f53\u6709\u4e24\u4e2a\u91cd\u5fc3\u4e14\u4e24\u4e2a\u91cd\u5fc3\u7b49\u4ef7,\u90a3\u4e48\u6709 $p-q+s=1$\n\n$s=0$ \u65f6,\u8003\u8651\u9664\u91cd\u5fc3\u5916\u7684\u6bcf\u4e2a\u70b9\u4e0e\u5176\u7236\u4eb2\u8fb9(\u4ee5\u91cd\u5fc3\u4e3a\u6839)\u7684\u8d21\u732e.\u82e5\u4e24\u4e2a\u70b9\u7b49\u4ef7,\u90a3\u4e48\u8fd9\u4e24\u4e2a\u70b9\u7684\u7236\u4eb2\u8fb9(\u4ee5\u91cd\u5fc3\u4e3a\u6839)\u4e5f\u7b49\u4ef7,\u6240\u4ee5\u9664\u91cd\u5fc3\u5916\u7684\u8d21\u732e\u4e3a $0$\n\n\u5bf9\u4e8e\u91cd\u5fc3,\u5b83\u4e0d\u53ef\u80fd\u4e0e\u5176\u4ed6\u4efb\u4f55\u4e00\u4e2a\u70b9\u7b49\u4ef7,\u6240\u4ee5\u8d21\u732e\u4e3a $1$\n\n$s=1$ \u65f6,\u56e0\u4e3a\u4e24\u4e2a\u91cd\u5fc3\u7b49\u4ef7,\u6240\u4ee5 $p-q=-1$\n\n\u8fd9\u6837,\u5bf9\u4e8e\u6bcf\u68f5\u65e0\u6807\u53f7\u65e0\u6839\u6811\u7528 $p-q+s$ \u7edf\u8ba1\u7b54\u6848\u5373\u53ef\u505a\u5230\u4e0d\u91cd\u4e0d\u6f0f\n\n\u5bf9\u4e8e $\\sum p,\\sum q,\\sum s$ \u5206\u522b\u7edf\u8ba1\u7b54\u6848\n\n#### $\\sum p$\n\n\u679a\u4e3e\u65e0\u6807\u53f7\u65e0\u6839\u6811\u5e76\u7edf\u8ba1\u70b9\u7b49\u4ef7\u7c7b,\u5c06\u6bcf\u4e2a\u70b9\u4f5c\u4e3a\u6839,\u5c31\u76f8\u5f53\u4e8e\u6c42\u65e0\u6807\u53f7\u6709\u6839\u6811\n\n\u5373\u76f8\u5f53\u4e8e\u9664\u6839\u8282\u70b9\u5916\u6bcf\u4e2a\u70b9\u7684\u5b50\u8282\u70b9\u4e2a\u6570 $\\leq 3$,\u6839\u8282\u70b9\u7684\u5b50\u8282\u70b9\u4e2a\u6570 $\\leq 4$ \u7684\u65e0\u6807\u53f7\u6709\u6839\u6811\u8ba1\u6570\n\n\u9664\u6839\u5916\u7684\u8282\u70b9\u7684\u5b50\u8282\u70b9\u4e2a\u6570 $\\leq3$ ,\u5373\u76f8\u5f53\u4e8e\u524d\u9762\u505a\u8fc7\u7684\u70f7\u57fa\u8ba1\u6570\n\n\u8bbe\u70f7\u57fa\u8ba1\u6570\u7684 $OGF$ \u4e3a $A(x)$\n\n\u5bf9\u6839\u8282\u70b9\u518d\u505a\u4e00\u904d $Burnside$,\u8bbe $\\sum p$ \u7684 $OGF$ \u4e3a $P(x)$\n\n\u4e00\u5171\u6709 $4!=24$ \u79cd\u7f6e\u6362,\u5206\u7c7b\u8ba8\u8bba\u5373\u53ef\n\n$$p_{x+1}=\\frac{\\sum_{i_i+i_2+i_3+i_4=x}a_{i_1}a_{i_2}a_{i_3}a_{i_4}+6\\sum_{2i_1+i_2+i_3=x}a_{i_1}a_{i_2}a_{i_3}+3\\sum_{2i_1+2i_2=x}a_{i_1}a_{i_2}+8\\sum_{3i_1+i_2=x}a_{i_1}a_{i_2}+6\\sum_{4i_1=x}a_{i_1}}{24}$$\n\n$$P(x)=x\\frac{A^4(x)+6A(x^2)A^2(x)+3A(x^2)^2+8A(x^3)A(x)+6A(x^4)}{24}$$\n\n#### $\\sum q$\n\n\u5c31\u662f\u6c42\u4e24\u4e2a\u65e0\u6807\u53f7\u6709\u6839\u6811\u7684\u6839\u8fde\u8d77\u6765\u540e\u7684\u4e0d\u540c\u6784\u65b9\u6848\u6570\n\n\u8bbe\u7b54\u6848\u7684 $OGF$ \u4e3a $Q(x)$\n\n$$Q(x)=\\frac{(A(x)-1)^2+A(x^2)-1}{2}$$\n\n$-1$ \u662f\u56e0\u4e3a $0$ \u4e2a\u70b9\u5e76\u4e0d\u80fd\u88ab\u8ba1\u5165\u65b9\u6848\n\n#### $\\sum s$\n\n\u8bbe\u7b54\u6848\u7684 $OGF$ \u4e3a $S(x)$\n\n$$S(x)=A(x^2)$$\n\n\u90a3\u4e48\u7b54\u6848\u5c31\u662f $P(x)-Q(x)+S(x)$\n\n[\u4ee3\u7801](https://www.luogu.com.cn/paste/sp5ibubj)",
        "postTime": 1598507194,
        "uid": 114409,
        "name": "9AC8E2",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6598 \u3010\u70f7\u70c3\u8ba1\u6570\u3011"
    },
    {
        "content": "\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P6598)\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/Appleblue17/p/14440722.html)\n\n[\u6211\u7684\u751f\u6210\u51fd\u6570\u535a\u5ba2\uff08\u542b\u6709\u6b64\u9898\uff0c\u4e0e\u672c\u9898\u89e3\u7565\u6709\u4e0d\u540c\uff09](https://www.cnblogs.com/Appleblue17/p/14337965.html)\n\n#### \u9898\u610f\u7b80\u8ff0\n\n+ \u6c42 $n$ \u4e2a\u78b3\u539f\u5b50\u5bf9\u5e94\u7684\u70f7\u70c3\u7684\u540c\u5206\u5f02\u6784\u4f53\u6570\u91cf\u3002\n+ $n \\leq 10^5$\uff0c\u7b54\u6848\u5bf9 $998244353$ \u53d6\u6a21\u3002\n+ Tips\uff1a\u5373\u6c42\u6240\u6709\u8282\u70b9\u5ea6\u6570\u4e0d\u8d85\u8fc7 $4$ \u7684\u65e0\u6807\u53f7\u65e0\u6839\u6811\u6570\u91cf\u3002\n\n#### \u9898\u76ee\u5206\u6790\n\n\u524d\u7f6e\u77e5\u8bc6\uff1a[\u70f7\u57fa\u8ba1\u6570](https://loj.ac/p/6538)\u3002\n\n\u8bbe\u70f7\u57fa\u8ba1\u6570\u7684\u751f\u6210\u51fd\u6570\u4e3a $F(x)$\u3002\n\n\u70f7\u57fa\u8ba1\u6570\u662f\u65e0\u6807\u53f7\u6709\u6839\u6811\uff0c\u9700\u8981\u53bb\u91cd\u3002\n\n\u8fd8\u662f\u7528\u65e0\u6807\u53f7\u65e0\u6839\u6811\u8ba1\u6570\u7684\u5904\u7406\u65b9\u6cd5\uff1a**\u94a6\u5b9a\u6839\u4e3a\u91cd\u5fc3\uff0c\u51cf\u6389\u4e0d\u5408\u6cd5\u7684\u65b9\u6848\u6570**\u3002\n\n***\n\n**\u603b\u6570**\n\n\u603b\u6570\u5e76\u4e0d\u662f $f_n$\uff0c\u56e0\u4e3a\u6839\u8282\u70b9\u5141\u8bb8\u6709\u56db\u4e2a\u513f\u5b50\u3002\n\n\u5176\u5b9e\u53ea\u8981\u7279\u522b\u8003\u8651\u6839\u8282\u70b9\u5c31\u53ef\u4ee5\u4e86\uff0c\u8bbe\u6240\u6709\u8282\u70b9\u5ea6\u6570\u4e0d\u8d85\u8fc7 $4$ \u7684\u65e0\u6807\u53f7\u65e0\u6839\u6811\u7684\u751f\u6210\u51fd\u6570\u4e3a $P(x)$\u3002\n\n\u8ddf\u70ef\u70c3\u8ba1\u6570\u4e00\u6837\uff0c\u4f7f\u7528 `Burnside` \u5f15\u7406\u548c `Polya` \u5b9a\u7406\uff08\u62ec\u53f7\u91cc\u7684\u6570\u5b57\u4ee3\u8868\u6bcf\u4e2a\u5faa\u73af\u7684\u5927\u5c0f\uff09\uff1a\n\n+ $(1,1,1,1)$\uff1a$F^4(x)$\uff0c\u5171\u6709 $1$ \u79cd\u3002\n+ $(1,1,2)$\uff1a$F^2(x)F(x^2)$\uff0c\u5171\u6709 $6$ \u79cd\u3002\n+ $(1,3)$\uff1a$F(x)F(x^3)$\uff0c\u5171\u6709 $8$ \u79cd\u3002\n+ $(2,2)$\uff1a$F^2(x^2)$\uff0c\u5171\u6709 $3$ \u79cd\u3002\n+ $(4)$\uff1a$F(x^4)$\uff0c\u5171\u6709 $6$ \u79cd\u3002\n\n$$P(x)=x\\dfrac{F^4(x)+6F^2(x)F(x^2)+8F(x)F(x^3)+3F^2(x^2)+6F(x^4)}{24}$$\n\n***\n\n**\u53bb\u91cd**\n\n\u63a5\u4e0b\u6765\u8003\u8651\u53bb\u91cd\uff0c\u60ca\u559c\u5730\u53d1\u73b0\uff1a\n\n+ \u780d\u6389\u7684\u90a3\u4e00\u68f5\u5b50\u6811\u7684\u6839\u8282\u70b9\u7684\u513f\u5b50\u4e2a\u6570\u4e00\u5b9a\u4e0d\u8d85\u8fc7 $3$\u3002\n+ \u5269\u4e0b\u7684\u5b50\u6811\u7684\u6839\u8282\u70b9\uff08\u5c31\u662f\u539f\u6811\u7684\u6839\u8282\u70b9\uff09\u7684\u513f\u5b50\u4e2a\u6570\u4e5f\u4e00\u5b9a\u4e0d\u8d85\u8fc7 $3$\uff08\u56e0\u4e3a\u5df2\u7ecf\u780d\u6389\u4e00\u68f5\u4e86\uff09\u3002\n\n\u7136\u540e\u76f4\u63a5\u62ff $F(x)$ \u53bb\u91cd\u5373\u53ef\u3002\n\n$$ans=p_n-\\sum\\limits_{k=\\lfloor\\frac{n}{2}\\rfloor+1}^{n-1} f_kf_{n-k}-[2|n]C_{f_{\\lfloor\\frac{n}{2}\\rfloor}}^2$$\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(nlogn)$\u3002\n\n***\n\n#### \u4ee3\u7801\n\n\u5f88\u4e11\u964b\u7684\u4ee3\u7801\u2026\u2026\n\n```cpp\nint main(){\n\tNTT::pre();\n\tcin>>n;\n\tsolve();\n\tfor(long long i=0;i<=n;i++) SS[i]=S2[i*2]=S22[i*2]=S3[i*3]=S4[i*4]=S[i];\n\t\n\tNTT::solve(SS,SS,S,n,n);\n\tNTT::solve(SS,SS,S,n,n);\n\tNTT::solve(SS,SS,S,n,n);\n\t\n\tNTT::solve(S2,S2,S,n,n);\n\tNTT::solve(S2,S2,S,n,n);\n\t\n\tNTT::solve(S22,S22,S22,n,n);\n\t\n\tNTT::solve(S3,S3,S,n,n);\n\t\n\tanss=(SS[n-1]+S2[n-1]*6%mod+S22[n-1]*3%mod+S3[n-1]*8%mod+S4[n-1]*6%mod)%mod*ksm(24,mod-2)%mod;\n\tfor(long long i=n/2+1;i<n;i++) anss=(anss+mod-S[i]*S[n-i]%mod)%mod; \n\tif(n%2==0) anss=(anss+mod-S[n/2]*(S[n/2]-1)/2%mod)%mod;\n\tcout<<anss;\n}\n```\n\n[\u5b8c\u6574\u4ee3\u7801](https://www.luogu.com.cn/record/47006178)",
        "postTime": 1614141896,
        "uid": 225645,
        "name": "\u82f9\u679c\u84dd17",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P6598 \u3010\u70f7\u70c3\u8ba1\u6570\u3011"
    },
    {
        "content": "\u600e\u4e48\u6ca1\u6709\u7b26\u53f7\u5316\u65b9\u6cd5\u7684\u9898\u89e3\u3002\n\n\u5148\u8003\u8651\u70f7\u57fa\u8ba1\u6570\u3002\n\n\u8bb0\u70f7\u57fa\u6784\u6210\u7684\u7ec4\u5408\u7c7b\u4e3a $\\mathcal B$\uff0c\u5219\u6709 $\\mathcal B = \\mathcal Z\\times \\mathsf {MSET}_{\\le 3}(\\mathcal B)$\uff0c\u6b64\u5904 $\\mathsf {MSET}$ \u8868\u793a Multiset \u53d8\u6362\uff0c\u8868\u793a\u53d6\u82e5\u5e72\u4e2a $\\mathcal B$ \u4e2d\u5143\u7d20\u6784\u6210\u53ef\u91cd\u96c6\u7684\u65b9\u6848\uff0c\u800c $\\le 3$ \u8868\u793a\u4e0d\u80fd\u53d6\u8d85\u8fc7 $3$ \u4e2a\uff0c\u5373\u4e00\u4e2a\u70f7\u57fa\u76f8\u5f53\u4e8e\u4e00\u4e2a\u6839\u52a0\u4e0a\u4e0d\u8d85\u8fc7 $3$ \u4e2a\u70f7\u57fa\u6784\u6210\u7684\u53ef\u91cd\u96c6\u3002\n\n\u5728\u65e0\u6807\u53f7\u6709\u6839\u6811\u8ba1\u6570\u4e2d\uff0c\u6211\u4eec\u662f\u7531\u5982\u4e0b\u5f0f\u5b50\u5f97\u5230\u65e0\u9650\u5236\u7684 Multiset \u53d8\u6362\u7684\u5f0f\u5b50\u7684\uff08\u76f8\u5f53\u4e8e\u591a\u91cd\u80cc\u5305\uff09\uff1a\n$$\n\\mathcal A =\\mathsf {MSET}(\\mathcal B)\\implies A(z)=\\prod_{\\beta\\in\\mathcal B} \\frac 1{1-z^{|\\beta|}}=\\prod_{j=1}^{\\infty} \\frac 1{(1-z^j)^{B_j}}\n$$\n\u800c\u5982\u4f55\u52a0\u4e0a\u9650\u5236\u5462\uff1f\u4e00\u4e2a\u65b9\u6cd5\u662f\u8003\u8651\u4e8c\u5143\u751f\u6210\u51fd\u6570 $A(z,u)$\uff0c\u5176\u4e2d $u$ \u7684\u6b21\u6570\u4ee3\u8868\u4e86\u4f7f\u7528\u4e86\u591a\u5c11\u4e2a $\\mathcal B$ \u4e2d\u7684\u5143\u7d20\u3002\n$$\n\\mathcal A =\\mathsf {MSET}_{=k}(\\mathcal B)\\implies A(z)=[u^k]\\prod_{\\beta\\in\\mathcal B} \\frac 1{1-uz^{|\\beta|}}=[u^k]\\prod_{j=1}^{\\infty} \\frac 1{(1-uz^j)^{B_j}}\n$$\n\u5982\u4f55\u63a8\u5bfc $A(z,u)$ \u4f7f\u5f97\u6211\u4eec\u7684\u7ed3\u679c\u66f4\u597d\u8ba1\u7b97\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e24\u4fa7\u540c\u65f6\u53d6 $\\ln$ \u540e\u518d\u5904\u7406\uff0c\u5373\uff1a\n$$\n\\begin{aligned}\nA(z,u) &= \\exp\\left(\\sum_{j=1}^{\\infty}\\sum_{k=1}^{\\infty}\\frac{u^kz^{jk}B_j}{k}\\right)\\\\\n& = \\exp \\left(\\sum_{k=1}^{\\infty}\\frac{u^kB(z^k)}{k}\\right)\n\\end{aligned}\n$$\n\u5bf9\u4e8e\u53d6\u7684\u4e2a\u6570\u6709\u9650\u7684\u60c5\u51b5\uff0c\u5bf9\u7b54\u6848\u6709\u8d21\u732e\u7684\u9879\u6570\u4e5f\u662f\u6709\u9650\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c55\u5f00\u8fdb\u884c\u8ba1\u7b97\uff0c\u4f8b\u5982\u5047\u5982\u6211\u4eec\u8981\u6c42 $[u^2]A(z,u)$\uff0c\u5219\u6211\u4eec\u53ea\u9700\u8ba1\u7b97\uff1a\n$$\n[u^2]\\exp\\left(uB(z) + \\frac 12u^2B(z^2)\\right) = [u^2]\\left(1 + \\frac 1{1!}\\left(uB(z)+\\frac 12u^2B(z^2)\\right) + \\frac 1{2!}u^2B^2(z)\\right)\n$$\n\u800c\u70f7\u57fa\u7684\u5f0f\u5b50\u5373 $B(z)=z\\operatorname{Exp}_{\\le 3}( B(z))$\uff0c\u7ecf\u8fc7\u4e00\u4e9b\u8ba1\u7b97\u53ef\u4ee5\u5f97\u5230\uff1a\n$$\n\\operatorname{Exp}_{\\le 3}(B(z)) = 1 + B(z) + \\frac{B(z^2)}2 + \\frac {B^2(z)}2+\\frac{B(z^3)}3+\\frac {B(z)B(z^2)}2 + \\frac {B^3(z)}6\n$$\n\u7136\u540e\u6211\u4eec\u76f8\u5f53\u4e8e\u8981\u89e3\u65b9\u7a0b\uff1a\n$$\n\\frac {B(z)}z = 1 + B(z) + \\frac{B(z^2)}2 + \\frac {B^2(z)}2+\\frac{B(z^3)}3+\\frac {B(z)B(z^2)}2 + \\frac {B^3(z)}6\n$$\n\u5c55\u5f00\u6765\u6bd4\u5bf9\u7cfb\u6570\u5c31\u6709\uff1a\n$$\n\\begin{aligned}\nb_{n+1} = & [n=0] + b_n + [2\\mid n]\\frac {b_{n/2}}{2} + [3\\mid n]\\frac{b_{n/3}}3 \\\\\n& +\\frac 12\\sum_{i=0}^nb_ib_{n-i}+\n\\frac 12\\sum_{i=0}^nb_ib_{(n-i)/2}[2\\mid (n-i)]\\\\\n& + \\frac 16\\sum_{i=0}^n\\sum_{j=0}^{n-i} b_ib_jb_{n-i-j}\n\\end{aligned}\n$$\n\u518d\u8bb0\u4e00\u4e2a $f_n = \\sum_{i=0}^nb_ib_{n-i}$\uff0c\u5927\u6982\u5c31\u662f\u4e00\u4e2a\u5168\u5728\u7ebf\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u5206\u6cbb NTT \u5c31\u597d\u4e86\u3002\n\n\u7136\u540e\u8003\u8651\u70f7\u70c3\u600e\u4e48\u8ba1\u6570\u3002\u5148\u8003\u8651\u201c\u6709\u6839\u70f7\u70c3\u201d\uff0c\u4e5f\u5c31\u662f $\\mathcal A_r = \\mathcal Z\\times \\mathsf {MSET}_{\\le 4}(\\mathcal B)$\uff0c\u5373 $A_r(z) = z\\operatorname{Exp}_{\\le 4}(B(z))$\uff0c\u7136\u540e\u8fd8\u662f\u6709\u6839\u5230\u65e0\u6839\u7684\u5bb9\u65a5\uff0c\u6d88\u53bb\u6839\u4e0d\u662f\u91cd\u5fc3\u7684\u7b54\u6848\uff0c\u5e76\u5bf9\u5076\u6570\u518d\u5904\u7406\u4e00\u4e0b\u4e24\u68f5\u5b50\u6811\u88ab\u91cd\u590d\u8ba1\u7b97\u7684\u60c5\u51b5\u5c31\u597d\u4e86\u3002\n\n\u5f0f\u5b50\u662f\u7c7b\u4f3c\u7684\uff0c\u8fd9\u8fb9\u5c31\u4e0d\u518d\u8d58\u8ff0\u4e86\u3002\n\n",
        "postTime": 1649913605,
        "uid": 34238,
        "name": "zhylj",
        "ccfLevel": 9,
        "title": "P6598"
    },
    {
        "content": "\u524d\u7f6e\u829d\u58eb\uff1a[\u70f7\u57fa\u8ba1\u6570](https://loj.ac/p/6538)\n\n\u8fd9\u9898\u6bd4 loj6512 \u8981\u5f31\u4e00\u4e9b... \u53ea\u8981\u6c42\u4e00\u9879\u3002\n\n\u9ed8\u8ba4\u4ee5\u4e0b\u7684\u6811\u5747\u4e3a\u65e0\u6839\u6811\u3002\n\n\u70f7\u57fa\u7684\u751f\u6210\u51fd\u6570 $f(x)$ \u5df2\u7ecf\u6c42\u5f97\u4e86\u3002\n\n\u5bf9\u4e8e\u65e0\u6839\u6811\u7684\u60c5\u51b5\uff0c\u8003\u8651\u9009\u5b9a\u4e00\u4e2a\u6839\uff0c\u8f6c\u5316\u4e3a\u6709\u6839\u6811\u540e\u5bb9\u65a5\u3002\n\n\u5173\u4e8e\u6811\u7684\u91cd\u5fc3\u6709\u4ee5\u4e0b\u6027\u8d28\uff1a\n\n- \u4e00\u68f5\u6811\u7684\u91cd\u5fc3\u53ea\u6709\u4e00\u4e2a\u6216\u4e24\u4e2a\u3002\n- \u82e5\u6709\u4e24\u4e2a\u91cd\u5fc3\uff0c\u5219\u5b83\u4eec\u5fc5\u5b9a\u76f8\u90bb\u3002\n- \u67d0\u4e2a\u70b9\u4e3a\u65e0\u6839\u6811\u7684\u91cd\u5fc3**\u5f53\u4e14\u4ec5\u5f53**\u5176\u5b50\u6811\u5927\u5c0f\u4e0d\u8d85\u8fc7 $\\dfrac{n}{2}$\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u9009\u5b9a\u91cd\u5fc3\u4e3a\u6839\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5bb9\u65a5\u3002\n\n\u8bbe $g(x)=f(x)\\bmod{x^{\\lfloor\\frac{n}{2}\\rfloor}}$\uff0c\u901a\u8fc7 Burnside \u5f15\u7406\u5f88\u5feb\u53ef\u4ee5\u5f97\u5230\u4ee5\u91cd\u5fc3\u4e3a\u6839\u672c\u8d28\u4e0d\u540c\u7684\u65b9\u6848\u6570\n\n$$p=[x^{n-1}]\\dfrac{1}{24}(g^4(x)+6g(x^2)g^2(x)+3g^2(x^2)+8g(x^3)g(x)+6g(x^4))$$\n\n\u7136\u540e\u6211\u4eec\u53bb\u6389\u4e24\u4e2a\u672c\u8d28\u4e0d\u540c\u7684\u91cd\u5fc3\u7684\u60c5\u51b5\uff0c\u5373\n\n$$[2|n]\\dfrac{1}{2}(g_{\\frac{n}{2}}^2-g_\\frac{n}{2})$$\n\n\u56e0\u6b64\u7b54\u6848\u5c31\u662f\n\n$$p-[2|n]\\dfrac{1}{2}(g_{\\frac{n}{2}}^2-g_\\frac{n}{2})$$\n\n\u7f3a\u70b9\u662f\u53ea\u80fd\u6c42\u4e00\u9879... \u4e0d\u8fc7\u5e94\u4ed8\u8fd9\u9898\u8db3\u591f\u4e86\u3002\n\n```cpp\n#include<stdio.h>\n#include<string.h>\ntypedef unsigned char byte;\ntypedef unsigned long long ull;\ntypedef long long ll;\ntypedef unsigned int word;\nstruct READ{\n\tchar c;\n\tinline READ(){c=getchar();}\n\ttemplate<typename type>\n\tinline READ& operator>>(register type& num){\n\t\twhile('0'>c||c>'9') c=getchar();\n\t\tfor(num=0;'0'<=c&&c<='9';c=getchar())\n\t\t\tnum=num*10+(c-'0');\n\t\treturn *this;\n\t}\n}cin;\n#define mx 18\n#define mx_ 17\nword root[1<<mx],inv[1<<mx],realid[1<<(mx+1)];\null size;\nconst word mod=998244353;\nconstexpr ull pow(register ull a,register word b){\n\tregister ull ans=1;\n\tfor(;b;b>>=1){\n\t\tif(b&1) (ans*=a)%=mod;\n\t\t(a*=a)%=mod;\n\t}\n\treturn ans;\n}\nconst ull ni2=pow(2,mod-2),ni3=pow(3,mod-2);\n#define loading() do{\t\t\t\t\t\t\t\t\\\n\tconst ull num1=pow(3,(mod-1)>>mx);\t\t\t\t\\\n\tconst ull num2=pow(num1,mod-2);\t\t\t\t\t\\\n\tregister word head,i,floor;\t\t\t\t\t\t\\\n\troot[1<<mx_]=inv[1<<mx_]=1,realid[1]=0;\t\t\t\\\n\tfor(floor=1,i=2;floor<=mx;++floor)\t\t\t\t\\\n\t\tfor(;i^(1u<<(floor+1));++i)\t\t\t\t\t\\\n\t\t\trealid[i]=(i&1)<<(floor-1)|realid[i>>1];\\\n\tfor(i=(1<<mx_)+1;i<(1<<mx);++i){\t\t\t\t\\\n\t\troot[i]=num1*root[i-1]%mod;\t\\\n\t\tinv[i]=num2*inv[i-1]%mod;\t\\\n\t}\t\t\t\t\t\t\t\t\t\t\t\t\\\n\tfor(i=(1<<mx_)-1;i;--i)\t\t\t\t\t\t\t\\\n\t\troot[i]=root[i<<1],inv[i]=inv[i<<1];\t\t\\\n}while(0);\n#define load()\t\t\t\t\t\\\n\tregister ull num1,num2;\t\t\\\n\tregister word head,i,floor;\n#define nttfor(size)\t\t\t\t\t\t\t\\\n\tfor(floor=1;floor<(size);floor<<=1)\t\t\t\\\n\t\tfor(head=0;head<(size);head+=floor<<1)\t\\\n\t\t\tfor(i=0;i<floor;++i)\n//floor \u53d8\u6362\u533a\u95f4\u5927\u5c0f\n//head \u53d8\u6362\u533a\u95f4\u5934\u6307\u9488 \n//i \u53d8\u6362\u4f4d\u7f6e \n#define ntt(num,root)(\t\t\t\t\t\t\t\\\n\tnum1=num[head|i],num2=num[head|i|floor],\t\\\n    num1+=(num2=num2*root[i|floor]%mod),        \\\n\tnum[head|i]=num1>=mod? num1-mod:num1,\t    \\\n\tnum1-=num2,num1+=mod-num2,                  \\\n\tnum[head|i|floor]=num1>=mod? num1-mod:num1)\n#define id(size,i) (realid[(i)|(size)])\n#define modx(num,size) memset(num+(size),0,(size)<<2)\n#define set0(num,size) memset(num,0,(size)<<2)\n#define FOR(size) for(i=0;i<(size);i++)\n#define newton(size)\t\\\n\tull ni=ni2,size_=2;\t\\\n\twhile(size_<<=1,ni=ni*ni2%mod,size_>>2<(size))\nword in[1<<mx],eax[1<<mx],ebx[1<<mx],ecx[1<<mx],edx[1<<mx];\nword eex[1<<mx];\ninline void _1(word size){// \u6c42\u9006\u5143\n\tebx[0]=pow(eax[0],mod-2);\n    load()\n\tnewton(size){\n\t\tFOR(size_>>1){\n            head=id(size_,i);\n\t\t\tecx[head]=eax[i]? mod-eax[i]:0;\n\t\t\tedx[head]=ebx[i];\n            head=id(size_,i|(size_>>1));\n            ecx[head]=edx[head]=0;\n\t\t}\n\t\tnttfor(size_) ntt(ecx,root),ntt(edx,root);\n\t\tFOR(size_) ebx[id(size_,i)]=(ull)(ecx[i])*edx[i]%mod;\n\t\tnttfor(size_) ntt(ebx,inv);\n\t\tmodx(ebx,size_>>1);\n\t\tFOR(size_) ecx[id(size_,i)]=ni*ebx[i]%mod;\n\t\tecx[0]=(ecx[0]+2)%mod;\n\t\tnttfor(size_) ntt(ecx,root);\n\t\tFOR(size_) ebx[id(size_,i)]=(ull)(ecx[i])*edx[i]%mod;\n\t\tnttfor(size_) ntt(ebx,inv);\n\t\tmodx(ebx,size_>>1);\n\t\tFOR(size_>>1) ebx[i]=ni*ebx[i]%mod;\n\t}\n}\ninline void getans(word size){//\u725b\u987f\u8fed\u4ee3\u6c42\u70f7\u57fa\n\tin[0]=1;\n\tload()\n\tnewton(size){\n\t\tFOR(size_>>1){\n\t\t\tecx[id(size_,i)]=in[i];\n\t\t\tecx[id(size_,i|(size_>>1))]=0;\n\t\t}\n\t\tnttfor(size_) ntt(ecx,root);\n\t\tFOR(size_) eex[id(size_,i)]=1ull*ecx[i]*ecx[i]%mod;\n\t\tnttfor(size_) ntt(eex,inv);\n\t\tFOR(size_>>1){\n\t\t\tedx[id(size_,i)]=eex[i]=ni*eex[i]%mod;\n\t\t\teax[i+1]=(ull)(mod-ni2)*(eex[i]+(i&1? 0:in[i>>1]))%mod;\n\t\t\tedx[id(size_,i|(size_>>1))]=0;\n\t\t}\n\t\tnttfor(size_) ntt(edx,root);\n\t\tFOR(size_) eex[id(size_,i)]=1ull*ecx[i]*edx[i]%mod;\n\t\tnttfor(size_) ntt(eex,inv);\n\t\teax[0]=1,_1(size_>>1);\n\t\tFOR(size_>>1){\n\t\t\tecx[id(size_,i)]=ebx[i];\n\t\t\tedx[id(size_,i+1)]=ni3*((i%3? 0:in[i/3])+mod-(ni*eex[i]%mod))%mod;\n\t\t\thead=id(size_,i|(size_>>1));\n\t\t\tecx[head]=edx[head]=0;\n\t\t}\n\t\tedx[id(size_,size_>>1)]=0,edx[0]=1;\n\t\tnttfor(size_) ntt(ecx,root),ntt(edx,root);\n\t\tFOR(size_) in[id(size_,i)]=1ull*ecx[i]*edx[i]%mod;\n\t\tnttfor(size_) ntt(in,inv);\n\t\tmodx(in,size_>>1);\n\t\tFOR(size_>>1) in[i]=ni*in[i]%mod;\n\t}\n}\nint main(){\n\tloading();\n\tword n,size=1;\n\tfor(cin>>n;size<=n;size<<=1);\n\tgetans(size>>1);\n\tfor(register word i=(n>>1)+1;i<size;++i) in[i]=0;\n\tload()\n\tsize<<=1;\n\tFOR(size){//(mod x^{4n})\n\t\thead=id(size,i);\n\t\tecx[head]=in[i];//f(x)\n\t\tedx[head]=(i&1? 0:in[i>>1]);//f(x^2)\n\t\teex[head]=(i%3? 0:in[i/3]);//f(x^3)\n\t}\n\tnttfor(size) ntt(ecx,root),ntt(edx,root),ntt(eex,root);\n\tFOR(size){\n\t\tnum1=1ull*ecx[i]*ecx[i]%mod;\n\t\teax[id(size,i)]=(\n\t\t\t(6ull*edx[i]+num1)%mod*num1%mod\n\t\t\t+(3ull*edx[i]*edx[i]%mod)\n\t\t\t+(8ull*eex[i]*ecx[i]%mod))%mod;\n\t}\n\tnttfor(size) ntt(eax,inv);\n\tconst ull ni=pow(size,mod-2),ni24=pow(24,mod-2);\n\n\tFOR(size){\n\t\teax[i]=ni24*(ni*eax[i]%mod+\n\t\t(6ull*(i&3? 0:in[i>>2])%mod))%mod;\n\t}\n\tull ans=eax[n-1];\n\tif((n&1)==0){//\u5bb9\u65a5\n\t\tnum1=1ull*in[n>>1]*in[n>>1]%mod;\n\t\tnum2=(num1+mod-in[n>>1])*pow(2,mod-2)%mod;\n\t\tans=(ans+mod-num2)%mod;\n\t}\n\tprintf(\"%llu\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1633858940,
        "uid": 104726,
        "name": "wangrx",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P6598 \u70f7\u70c3\u8ba1\u6570"
    },
    {
        "content": "\u672c\u9898\u89e3\u91c7\u7528[\u7b26\u53f7\u5316](https://www.cnblogs.com/joke3579/p/symbolic_method.html)\u7684\u65b9\u5f0f\u63a8\u5bfc\u3002\n\n\u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u9996\u5148\u9700\u8981\u89e3\u51b3\u70f7\u57fa\u8ba1\u6570\u3002\u8bbe $\\mathcal T$ \u4e3a\u70f7\u57fa\u7684\u7ec4\u5408\u7c7b\uff0c\u6211\u4eec\u80fd\u5199\u51fa\n\n$$\\mathcal T = \\mathcal Z \\times \\text{MSET}_3(\\mathcal T) + \\mathcal E$$\n\n\u4e5f\u5c31\u662f\n\n$$T(z) = z\\left(\\frac{T(z)^3}{6} + \\frac{T(z)T(z^2)}{2} + \\frac{T(z^3)}{3}\\right) + 1$$\n\n\u6211\u4eec\u53ef\u4ee5\u5e94\u7528\u725b\u987f\u8fed\u4ee3\u6765\u505a\u8fd9\u4e2a\u3002\u8bbe\n\n$$G(T(z)) = z\\left(\\frac{T(z)^3}{6} + \\frac{T(z)T(z^2)}{2} + \\frac{T(z^3)}{3}\\right) - T(z) + 1 = 0$$\n\n\u7531\u4e8e\u6211\u4eec\u5e0c\u671b\u4ece $z^n$ \u7684\u622a\u53d6\u5f97\u5230 $z^{2n}$ \u7684\u622a\u53d6\uff0c\u73b0\u5728\u5df2\u77e5\u4e86 $\\forall k > 1, \\ T(z^k)$\uff0c\u56e0\u6b64\u4e0d\u59a8\u5c06\u5f0f\u5b50\u4e2d\u7684 $T(z^k)$ \u89c6\u4f5c\u5e38\u6570\uff0c\u8bb0\u4e3a $C_k$\u3002\u8bb0 $G$ \u51fd\u6570\u5bf9\u5e94\u7684\u81ea\u53d8\u91cf\u4e3a $x$\uff0c$z$ \u4e3a\u4e0e $x$ \u65e0\u5173\u7684\u5e38\u6570\uff0c\u53ef\u4ee5\u5199\u51fa\n\n$$G(x) = z\\left(\\frac{x^3}{6} + \\frac{C_2x}{2} + \\frac{C_3}{3}\\right) - x + 1$$\n\n\u4ece\u800c\n\n$$G'(x) = z\\left(\\frac{x^2}{2} + \\frac{C_2}{2}\\right) - 1$$\n\n\u8bb0\u5df2\u7ecf\u5f97\u5230\u7684\u622a\u53d6\u4e3a $T^*(z)$\uff0c\u9700\u8981\u5f97\u5230\u7684\u622a\u53d6\u4e3a $T(z)$\uff0c\u6839\u636e\u725b\u987f\u8fed\u4ee3\u53ef\u4ee5\u5f97\u5230\n\n$$T(z) = T^*(z) - \\frac{z\\left(T^*(z)^3 + 3C_2T^*(z) + 2C_3\\right) - 6T^*(z)  + 6}{z\\left(3T^*(z)^2 + 3C_2\\right) - 6}$$\n\n\u76f4\u63a5\u4f5c\u5373\u53ef\u3002\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n\u65e0\u6807\u53f7\u65e0\u6839\u6811\u4e0d\u662f\u5f88\u597d\u8ba1\u6570\uff0c\u8003\u8651\u94a6\u5b9a\u4e00\u4e9b\u4e1c\u897f\u7684\u60c5\u51b5\u3002  \n\u6211\u4eec\u8bbe\u4e00\u68f5\u65e0\u6807\u53f7\u65e0\u6839\u6811\u5728\u94a6\u5b9a\u4e00\u4e2a\u70b9\u4e3a\u6839\u65f6\u88ab\u8ba1\u6570\u4e86 $p$ \u6b21\uff0c\u94a6\u5b9a\u4e00\u6761\u8fb9\u4e3a\u6839\u65f6\u88ab\u8ba1\u6570\u4e86 $q$ \u6b21\uff0c\u94a6\u5b9a\u8ba1\u6570\u91cd\u5fc3\u65f6 $s = 1$ \u5f53\u4e14\u4ec5\u5f53\u91cd\u5fc3\u6709\u4e24\u4e2a\uff0c\u5219 $p - q + s = 1$\u3002  \n\u8bc1\u660e\u5176\u5b9e\u4e0d\u96be\u3002$s = 0$ \u65f6\u94a6\u5b9a\u8fb9\u5176\u5b9e\u7b49\u4e8e\u94a6\u5b9a\u4e86\u4e00\u4e2a\u7aef\u70b9\uff0c\u9700\u8981\u8fd9\u4e9b\u7aef\u70b9\u5f7c\u6b64\u4e0d\u540c\u3002\u5bb9\u6613\u53d1\u73b0\u88ab\u8ba1\u6570\u4e86 $n - (n - 1) + 0 = 1$ \u6b21\u3002$s = 1$ \u65f6\u66f4\u597d\u8bf4\u4e86\uff0c\u8fd9\u91cd\u5fc3\u80af\u5b9a\u662f\u4e00\u6761\u8fb9\u7684\u4e24\u4e2a\u7aef\u70b9\uff0c\u8fd9\u4fe9\u7aef\u70b9\u5f7c\u6b64\u7b49\u4ef7\uff0c\u56e0\u6b64\u88ab\u8ba1\u6570\u4e86 $(n - 1) - (n - 1) + 1 = 1$ \u6b21\u3002\n\n\u5047\u8bbe\u70f7\u57fa\u7684\u7ec4\u5408\u7c7b\u662f $\\mathcal T$\uff0c\u4e0a\u9762\u94a6\u5b9a\u4e09\u79cd\u4fe1\u606f\u65f6\u5bf9\u5e94\u7684\u7ec4\u5408\u7c7b\u662f $\\mathcal {P, Q, S}$\uff0c\u5219\u6709\n\n$$\\mathcal P = \\mathcal Z\\times \\text{MSET}_4(\\mathcal T) \\qquad \\mathcal Q = (\\mathcal T - \\mathcal E)^2 / \\textbf G \\qquad \\mathcal S = \\text{AMP}_2(\\mathcal T)$$\n\n$\\mathcal P$ \u7e41\u800c\u4e0d\u96be\uff0c\u7565\u53bb\u3002$\\mathcal S$ \u662f Amplification \u6784\u9020\uff0c\u7ffb\u8bd1\u5c31\u662f $T(z^2)$\uff0c\u6027\u8d28\u663e\u7136\u3002\n\n\u5bf9\u4e8e $\\mathcal Q$\uff0c\u6211\u4eec\u9700\u8981\u8003\u8651\u5c06\u4e24\u68f5\u6811\u7528\u4e00\u6761\u8fb9 $-$ \u62fc\u5408\u3002\u6211\u4eec\u8bbe\u5143\u7d20 $a\\in \\mathcal Q$ \u53ef\u4ee5\u88ab\u62c6\u89e3\u4e3a $\\{t, -, t'\\}$\uff0c\u5176\u4e2d $t, t' \\in \\mathcal T$\uff0c\u4e3a $a$ \u7684\u4e24\u68f5\u5b50\u6811\uff1b\u5e76\u8bb0 $a = (t, t')$\u3002\u5219\u6211\u4eec\u5b9a\u4e49\u7b49\u4ef7\u5173\u7cfb $\\textbf G$\uff1a\n\n$$a_1\\textbf G a_2 \\iff (t_1 = t_2 \\land t'_1 = t'_2) \\ \\lor \\ (t_1 = t'_2  \\land  t'_1 = t_2)$$ \n\n\u4e5f\u5c31\u662f\u5b50\u6811\u76f8\u540c\u4f46\u662f\u987a\u5e8f\u4e0d\u540c\u7684\u6811\u5728\u540c\u4e00\u7b49\u4ef7\u7c7b\u4e2d\u3002\n\n\u7136\u540e\u8003\u8651\u7ffb\u8bd1\u6210\u751f\u6210\u51fd\u6570\u7684\u5f62\u5f0f\u3002\u53ef\u4ee5\u53d1\u73b0\uff0c\u5bf9\u4e8e\u4e24\u68f5\u5b50\u6811\u4e0d\u540c\u7684\u5143\u7d20\uff0c\u4e58\u65b9\u65f6\u5b83\u88ab\u8ba1\u6570\u4e86\u4e24\u6b21\uff0c\u56e0\u6b64\u9700\u8981\u9664\u4ee5 $2$\uff1b\u800c\u4e24\u68f5\u5b50\u6811\u76f8\u540c\u7684\u5143\u7d20\u53ea\u88ab\u8ba1\u6570\u4e86\u4e00\u6b21\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u52a0\u5165\u8fd9\u4e00\u90e8\u5206\u5143\u7d20\uff0c\u518d\u6574\u4f53\u9664\u4ee5 $2$\u3002\u52a0\u5165\u7684\u5185\u5bb9\u53ef\u4ee5\u88ab\u7b26\u53f7\u5316\u5730\u5199\u4f5c $\\text{AMP}_2(\\mathcal T) - \\mathcal E$\uff1a\u65b0\u7ec4\u5408\u7c7b\u91cc\u6ca1\u6709\u7a7a\u5143\u7d20\uff0c\u9700\u8981\u51cf\u53bb\u3002\u4e5f\u5c31\u662f\n\n$$Q(z) = \\frac{(T(z) - 1)^2 + T(z^2) - 1}{2}$$\n\n\u6700\u540e $\\mathcal P - \\mathcal Q +\\mathcal S$ \u5c31\u662f\u7b54\u6848\u7684\u7ec4\u5408\u7c7b\u3002\n\n```cpp\npoly newton(int n) {\n    poly F(1, 1), A, B;\n    for (int k = 2; k < (n << 1); k <<= 1) {\n        F.resize(k);\n        A = F.shiftvar(2), B = F.shiftvar(3);\n        F = F - (((F * F * F + 3 * A * F + 2 * B) >> 1) - 6 * F + 6) * (3 * (( F * F + A ) >> 1) - 6).inv().resize(k);\n    } return F;\n}\n\npoly MSET(poly F, int cnt) {\n\tif (cnt == 1) return F;\n\tif (cnt == 2) return ginv(2) * ( (F * F).split(F.degree()) + F.shiftvar(2) );\n\tif (cnt == 3) {\n\t\tpoly F2 = (F * F).split(F.degree()), FS2 = F.shiftvar(2);\n\t\treturn ginv(6) * ( F2 * F ).split(F.degree()) + ginv(2) * (F * FS2).split(F.degree()) + ginv(3) * F.shiftvar(3);\n\t} \n\tif (cnt == 4) {\n\t\tpoly F2 = (F * F).split(F.degree()), FS2 = F.shiftvar(2);\n\t\treturn ginv(24) * (F2 * F2).split(F.degree()) + ginv(4) * (F2 * FS2).split(F.degree()) + ginv(3) * (F * F.shiftvar(3)).split(F.degree()) + ginv(8) * (FS2 * FS2).split(F.degree()) + ginv(4) * F.shiftvar(4);\n\t}\n}\n\nsigned main() {\n    cin >> n;\n\tpoly A = newton(n);\n\tpoly F = (MSET(A, 4) >> 1) - ginv(2) * (((A - 1) * (A - 1)).split(n + 1) + A.shiftvar(2) - 1 ) + A.shiftvar(2);\n\tcout << F[n] << '\\n';\n} \n```",
        "postTime": 1676070474,
        "uid": 631791,
        "name": "joke3579",
        "ccfLevel": 0,
        "title": "\u70f7\u70c3\u8ba1\u6570 \u9898\u89e3"
    }
]
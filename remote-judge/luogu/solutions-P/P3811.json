[
    {
        "content": "# \u4e58\u6cd5\u9006\u5143\u5c0f\u7ed3\n\n> \u4e58\u6cd5\u9006\u5143\uff0c\u4e00\u822c\u7528\u4e8e\u6c42 $$\\frac{a}{b} \\pmod p$$ \u7684\u503c\uff08$p$ \u901a\u5e38\u4e3a\u8d28\u6570\uff09\uff0c\u662f\u89e3\u51b3\u6a21\u610f\u4e49\u4e0b\u5206\u6570\u6570\u503c\u7684\u5fc5\u8981\u624b\u6bb5\u3002\n\n> [\u6709\u5174\u8da3\u53ef\u4ee5\u70b9\u8fdb\u6211\u7684\u535a\u5ba2\u770b\u770b\u554aqwq](https://www.cnblogs.com/zjp-shadow/p/7773566.html)\n\n## \u9006\u5143\u5b9a\u4e49\n\n> \u82e5$a*x\\equiv1 \\pmod {b}$\uff0c\u4e14$a$\u4e0e$b$\u4e92\u8d28\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u80fd\u5b9a\u4e49:\n$x$ \u4e3a $a$ \u7684\u9006\u5143\uff0c\u8bb0\u4e3a$a^{-1}$\uff0c\u6240\u4ee5\u6211\u4eec\u4e5f\u53ef\u4ee5\u79f0 $x$ \u4e3a $a$ \u5728 $\\bmod b$ \u610f\u4e49\u4e0b\u7684\u5012\u6570\uff0c\n\n> \u6240\u4ee5\u5bf9\u4e8e $\\displaystyle\\frac{a}{b} \\pmod {p}$ \uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6c42\u51fa $b$ \u5728 $\\bmod {p}$ \u4e0b\u7684\u9006\u5143\uff0c\u7136\u540e\u4e58\u4e0a $a$ \uff0c\u518d $\\bmod {p}$\uff0c\u5c31\u662f\u8fd9\u4e2a\u5206\u6570\u7684\u503c\u4e86\u3002\n\n\n## \u6c42\u89e3\u9006\u5143\u7684\u65b9\u5f0f\n\n### \u62d3\u5c55\u6b27\u51e0\u91cc\u5f97\n\n\u8fd9\u4e2a\u65b9\u6cd5\u5341\u5206\u5bb9\u6613\u7406\u89e3\uff0c\u800c\u4e14\u5bf9\u4e8e\u5355\u4e2a\u67e5\u627e\u6548\u7387\u4f3c\u4e4e\u4e5f\u8fd8\u4e0d\u9519\uff0c\u6bd4\u540e\u9762\u8981\u4ecb\u7ecd\u7684\u5927\u90e8\u5206\u65b9\u6cd5\u90fd\u8981\u5feb(\u5c24\u5176\u5bf9\u4e8e $\\bmod {p}$ \u6bd4\u8f83\u5927\u7684\u65f6\u5019)\u3002\n\n\u8fd9\u4e2a\u5c31\u662f\u5229\u7528\u62d3\u6b27\u6c42\u89e3 \u7ebf\u6027\u540c\u4f59\u65b9\u7a0b $a*x \\equiv c \\pmod {b}$ \u7684$c=1$\u7684\u60c5\u51b5\u3002\u6211\u4eec\u5c31\u53ef\u4ee5\u8f6c\u5316\u4e3a\u89e3 $a*x + b*y = 1$ \u8fd9\u4e2a\u65b9\u7a0b\u3002\n\n\u6c42\u89e3\u8fd9\u4e2a\u65b9\u7a0b\u7684\u89e3\u3002\u4e0d\u4f1a\u62d3\u6b27\u53ef\u4ee5\u70b9[\u8fd9\u91cc](https://www.cnblogs.com/zjp-shadow/p/9267675.html#autoid-3-3-0)~\n\n\u800c\u4e14\u8fd9\u4e2a\u505a\u6cd5\u8fd8\u6709\u4e2a\u597d\u5904\u5728\u4e8e\uff0c\u5f53 $a \\bot p$ \uff08\u4e92\u8d28\uff09\uff0c\u4f46 $p$ \u4e0d\u662f\u8d28\u6570\u7684\u65f6\u5019\u4e5f\u53ef\u4ee5\u4f7f\u7528\u3002\n\n\u4ee3\u7801\u6bd4\u8f83\u7b80\u5355\uff1a\n\n```cpp\nvoid Exgcd(ll a, ll b, ll &x, ll &y) {\n    if (!b) x = 1, y = 0;\n    else Exgcd(b, a % b, y, x), y -= a / b * x;\n}\nint main() {\n    ll x, y;\n    Exgcd (a, p, x, y);\n    x = (x % p + p) % p;\n    printf (\"%d\\n\", x); //x\u662fa\u5728mod p\u4e0b\u7684\u9006\u5143\n}\n```\n\n### \u5feb\u901f\u5e42\n\n\n\u8fd9\u4e2a\u505a\u6cd5\u8981\u5229\u7528 **\u8d39\u9a6c\u5c0f\u5b9a\u7406**\n\n> \u82e5$p$\u4e3a\u7d20\u6570\uff0c$a$\u4e3a\u6b63\u6574\u6570\uff0c\u4e14$a$\u3001$p$\u4e92\u8d28\u3002\n\u5219\u6709$a^{p-1} \\equiv 1 (\\bmod {p})$\u3002\n\n \n\u8fd9\u4e2a\u6211\u4eec\u5c31\u53ef\u4ee5\u53d1\u73b0\u5b83\u8fd9\u4e2a\u5f0f\u5b50\u53f3\u8fb9\u521a\u597d\u4e3a $1$ \u3002\n\n\n\u6240\u4ee5\u6211\u4eec\u5c31\u53ef\u4ee5\u653e\u5165\u539f\u5f0f\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\uff1a\n\n\n$$a*x\\equiv 1 \\pmod p$$\n\n\n$$a*x\\equiv a^{p-1} \\pmod p$$\n\n\n$$x \\equiv a^{p-2} \\pmod p$$\n\n\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528\u5feb\u901f\u5e42\u6765\u7b97\u51fa $a^{p-2} \\pmod p$\u7684\u503c\uff0c\u8fd9\u4e2a\u6570\u5c31\u662f\u5b83\u7684\u9006\u5143\u4e86\n\n\n\u4ee3\u7801\u4e5f\u5f88\u7b80\u5355\uff1a\n\n```cpp\nll fpm(ll x, ll power, ll mod) {\n    x %= mod;\n    ll ans = 1;\n    for (; power; power >>= 1, (x *= x) %= mod)\n    \tif(power & 1) (ans *= x) %= mod;\n    return ans;\n}\nint main() {\n\tll x = fpm(a, p - 2, p); //x\u4e3aa\u5728mod p\u610f\u4e49\u4e0b\u7684\u9006\u5143\n}\n```\n\n### \u7ebf\u6027\u7b97\u6cd5\n\n\n\u7528\u4e8e\u6c42\u4e00\u8fde\u4e32\u6570\u5b57\u5bf9\u4e8e\u4e00\u4e2a$\\bmod p$\u7684\u9006\u5143\u3002[\u6d1b\u8c37P3811](https://www.luogu.org/problem/show?pid=3811)\n\n\u53ea\u80fd\u7528\u8fd9\u79cd\u65b9\u6cd5\uff0c\u522b\u7684\u7b97\u6cd5\u90fd\u6bd4\u8fd9\u4e9b\u8981\u6c42\u4e00\u4e32\u8981\u6162\u3002\n\n\n\u9996\u5148\u6211\u4eec\u6709\u4e00\u4e2a,$1^{-1}\\equiv 1 \\pmod p$\n\n\u7136\u540e\u8bbe $p=k*i+r,(1<r<i<p)$ \u4e5f\u5c31\u662f $k$ \u662f $p / i$ \u7684\u5546\uff0c$r$ \u662f\u4f59\u6570 \u3002\n\n\u518d\u5c06\u8fd9\u4e2a\u5f0f\u5b50\u653e\u5230$\\pmod p$\u610f\u4e49\u4e0b\u5c31\u4f1a\u5f97\u5230\uff1a\n\n$$k*i+r \\equiv 0 \\pmod p$$\n\n\u7136\u540e\u4e58\u4e0a$i^{-1}$,$r^{-1}$\u5c31\u53ef\u4ee5\u5f97\u5230:\n\n$$k*r^{-1}+i^{-1}\\equiv 0 \\pmod p$$\n\n$$i^{-1}\\equiv -k*r^{-1}  \\pmod p$$\n\n$$i^{-1}\\equiv -\\lfloor \\frac{p}{i} \\rfloor*(p \\bmod i)^{-1} \\pmod p$$\n\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4ece\u524d\u9762\u63a8\u51fa\u5f53\u524d\u7684\u9006\u5143\u4e86\u3002\n\n\u4ee3\u7801\u4e5f\u5f88\u77ed\uff1a\n\n```cpp\ninv[1] = 1;\nfor(int i = 2; i < p; ++ i)\n    inv[i] = (p - p / i) * inv[p % i] % p;\n```\n\n\n### \u9636\u4e58\u9006\u5143 $O(n)$ \u6c42\n\n\u56e0\u4e3a\u6709\u5982\u4e0b\u4e00\u4e2a\u9012\u63a8\u5173\u7cfb\u3002\n\n$\\displaystyle inv[i+1]=\\frac{1}{(i+1)!}$\n\n$\\displaystyle inv[i+1]*(i+1)=\\frac{1}{i!}=inv[i]$\n\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u6c42\u51fa$n!$\u7684\u9006\u5143\uff0c\u7136\u540e\u9006\u63a8\uff0c\u5c31\u53ef\u4ee5\u6c42\u51fa$1...n!$\u6240\u6709\u7684\u9006\u5143\u4e86\u3002\n\n\n\u9012\u63a8\u5f0f\u4e3a\n\n$inv[i+1]*(i+1)=inv[i]$\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u6c42\u51fa $\\displaystyle \\forall i, i!,\\frac{1}{i!}$ \u7684\u53d6\u503c\u4e86\u3002\n\n\u7136\u540e\u8fd9\u4e2a\u4e5f\u53ef\u4ee5\u5bfc\u51fa $\\displaystyle \\frac{1}{i} \\pmod p$ \u7684\u53d6\u503c\uff0c\u4e5f\u5c31\u662f\n\n$$\\displaystyle \\frac{1}{i!} \\times (i - 1)! = \\frac{1}{i} \\pmod p$$\n\n\u5177\u4f53\u5b9e\u73b0\u53ef\u4ee5\u53c2\u8003\u6211[\u8fd9\u53d1\u63d0\u4ea4](https://www.luogu.org/record/show?rid=12236223)\uff08\u5361\u4e86\u5e38\u3002\u3002\uff09\n",
        "postTime": 1512866285,
        "uid": 19128,
        "name": "zjp_shadow",
        "ccfLevel": 9,
        "title": "\u4e58\u6cd5\u9006\u5143"
    },
    {
        "content": "\u5bb3\u6015\n\u4e0d\u61c2\u4e3a\u4ec0\u4e48\u5e95\u4e0b\u80fd\u626f\u5230\u7ebf\u6027\u7b5b\u4ec0\u4e48\u7684\u2026\u2026\n\n\u666e\u901a\u7403\u9006\u5143\u5c31\u662fnaive\u7684pow(x,mod-2)\u6ce8\u610f\u6b64\u65f6mod\u5fc5\u987b\u4e3a\u8d28\u6570\n\n\u8fd9\u9898\u4e00\u4e0b\u5b50\u53eb\u4f60\u6c42\u8fd9\u4e48\u591a\u5f88\u660e\u663e\u4e0d\u662f\u8fd9\u4e48\u505a\u7684\u561b\n\n\u9006\u5143\u6709\u7ebf\u6027\u9012\u63a8\u7684\u516c\u5f0f\uff0c\u63a8\u4e00\u4e0b\u5c31\u597d\u4e86\u5440\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define N 3000010\ntypedef long long ll;\nusing namespace std;\nint inv[N],n,p;\ninline int read(){\n    int f=1,x=0;char ch;\n    do{ch=getchar();if(ch=='-')f=-1;}while(ch<'0'||ch>'9');\n    do{x=x*10+ch-'0';ch=getchar();}while(ch>='0'&&ch<='9');\n    return f*x;\n}\nint main(){\n    n=read();p=read();inv[1]=1;puts(\"1\");\n    for(int i=2;i<=n;i++){\n        inv[i]=(ll)(p-p/i)*inv[p%i]%p;\n        printf(\"%d\\n\",inv[i]);\n    }\n}\n```",
        "postTime": 1499934519,
        "uid": 2978,
        "name": "zcysky",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "## \u9006\u5143\uff1a\n\u3000\u3000\u4e00\u822c\u7528\u4e8e\u6c42 $\\frac{a}{b}\\ \\;mod\\; p$ \n\n## \u5b9a\u4e49\uff1a\n\u3000\u3000\u82e5  $a*x \u2261 1 \\;(mod \\;p)$ \uff0c\u4e14 $a$ \u4e0e $p$ \u4e92\u8d28\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u80fd\u5b9a\u4e49: $x$ \u4e3a $a$ \u7684\u9006\u5143\uff0c\u8bb0\u4e3a $a^{-1}$ \uff0c\u6240\u4ee5\u6211\u4eec\u4e5f\u53ef\u4ee5\u79f0 $x$ \u4e3a $a$ \u7684\u5012\u6570( $mod \\;p$ \u610f\u4e49\u4e0b)\u3002\n\n\u3000\u3000\u6240\u4ee5\u5bf9\u4e8e $\\frac{a}{b}\\ \\; mod\\;p$ \uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6c42\u51fa $b$ \u5728 $mod\\; p$ \u610f\u4e49\u4e0b\u7684\u9006\u5143\uff0c\u7136\u540e\u4e58\u4e0a $a$ \uff0c\u518d $mod \\; p$ \uff0c\u5c31\u662f\u8fd9\u4e2a\u4e58\u6cd5\u9006\u5143\u7684\u503c\u4e86\u3002\n\n## \u6c42\u6cd5\uff1a\n### First\uff1a\u8d39\u9a6c\u5c0f\u5b9a\u7406\n\n\u5b9a\u7406\u5185\u5bb9\uff1a\u5982\u679c $a,p$ \u4e92\u8d28\uff0c\u90a3\u4e48 $a^{p-1} \u2261 1 \\;(mod\\; p)$\n\n\u3000\u3000\u7ed3\u5408\u9006\u5143\u65b9\u7a0b $a*x \u2261 1 \\;(mod\\; p)$ ,\u5f97\u5230 $a*x \u2261 a^{p-1}\\;(mod \\;p)$\n$\\;\\;\\;\\;\\;\\;$\u6839\u636e\u540c\u4f59\u7684\u6027\u8d28,\u82e5 $p$ \u4e3a\u8d28\u6570,\u5f97\u5230 $x \u2261 a^{p-2}\\; {mod \\; p}$\n  \n$\\;\\;\\;\\;\\;\\;$\u5373 $x = a^{p-2} \\;mod\\; p$, **\u5feb\u901f\u5e42** \u6c42\u89e3\u5373\u53ef\n\n### Second\uff1a\u6b27\u62c9\u5b9a\u7406\n\n\u5b9a\u7406\u5185\u5bb9\uff1a\u5982\u679c$a,p$\u4e92\u8d28\uff0c\u90a3\u4e48$a^\u03c6(p) \u2261 1 \\;(mod\\; p)$\uff0c\u5f53 $p$ \u4e3a\u8d28\u6570\u65f6\uff0c$\u03c6(p)=p-1$\u3002\n\n\u3000\u3000\u540c\u7406\uff0c\u7ed3\u5408\u540c\u4f59\u65b9\u7a0b\uff0c\u5f97 $x=a^{p-2} \\;mod \\;p$, **\u5feb\u901f\u5e42** \u6c42\u89e3\u5373\u53ef\n\n _\uff08\u8fd9\u53ea\u662f\u4e24\u79cd\u4e0d\u540c\u7684\u8bc1\u660e\uff0c\u4ee3\u7801\u662f\u76f8\u540c\u7684\uff09_ \n```cpp\n//TLE_83\u5206\n#include<cstdio> \n#define ll long long\nusing namespace std;\nint n,p;\ninline ll ksm(ll a,ll b){\n    ll ans=1;\n    a%=p;\n    while(b){\n        if(b&1) ans=ans*a%p;\n        a=a*a%p;\n        b>>=1;\n    }\n    return ans%p;\n}\nvoid write(ll x){\n    if(x<0) putchar('-'),x=-x;\n    if(x>9) write(x/10);putchar(x%10^48);\n}\nint main(){\n    scanf(\"%d%d\",&n,&p);\n    for(int i=1;i<=n;i++)\n        write(ksm(i,p-2)),putchar('\\n');\n    return 0;\n}\n```\n### Third:\u89e3\u4e0d\u5b9a\u65b9\u7a0b \n\n\u3000\u3000**\u89e3\u540c\u4f59\u65b9\u7a0b** $ax\u22611 \\;(mod \\;p)$ \u7b49\u4ef7\u4e8e **\u89e3\u4e0d\u5b9a\u65b9\u7a0b** $ax+py=1$\n\u3000\u3000**Exgcd**\u6c42\u89e3\u5373\u53ef\uff08\u4e0d\u4f1a \u8bf7\u5de6\u8f6c [](https://www.cnblogs.com/RisingGods/p/9497928.html) _Exgcd_  \uff09\n\u3000\u3000\n  \n$\\;\\;\\;\\;\\;\\;$\u7531\u4e8e $p$ \u662f\u8d28\u6570\uff0c\u90a3\u4e48$gcd(a,p)=1$;\n\u3000\u3000\n  \n$\\;\\;\\;\\;\\;\\;$\u5373\u6c42\u89e3\u4e0d\u5b9a\u65b9\u7a0b $ax+by=gcd(a,b)$;\n  ```cpp\n//AC_1240ms\n#include<cstdio>\nusing namespace std;\nint x,y;\nvoid exgcd(int a,int b){\n    if(!b){x=1,y=0;return ;}\n    exgcd(b,a%b);\n    int t=x;\n    x=y,y=t-a/b*y;\n}\nvoid write(int x){\n    if(x>9) write(x/10);\n    putchar(x%10^48);\n}\nint main(){\n    int n,p;\n    scanf(\"%d%d\",&n,&p);\n    for(int i=1;i<=n;++i)\n        exgcd(i,p),write((x%p+p)%p),putchar('\\n');\n    return 0;\n}\n```\n### Forth\uff1a\u7ebf\u6027\u9012\u63a8\n\n#### \u590d\u6742\u5ea6 $O(n)$\n \n #### \u9012\u63a8\u8fc7\u7a0b\uff1a\n\u3000\u3000\u4ee4 $p=ki+r$ ; {$\\;k=\\big\\lfloor\\frac pi\\big\\rfloor$, $r=p\\;mod\\;i\\;$} $(i<p,k<p,r<i)$\n\u3000\u3000\n  \n$\\;\\;\\;\\;\\;\\;$\u5219\u6709 $ki+r\u22610\\;(mod\\; p) $ \u2460\n  \n\u2460\u5f0f\u5de6\u53f3\u540c\u4e58$i^{-1}*r^{-1}$ \u5f97\uff1a\n \n\u3000\u3000$k*r^{-1}+i^{-1} \u2261 0 \\;(mod \\;p)$\n\n\u79fb\u9879 \u5f97\n\u3000\u3000\n  \n  $\\;\\;\\;\\;\\;\\;$ $i^{-1} \u2261 -k*r^{-1} \\;(mod\\; p)$\n\u3000\n \n \u5e26\u5165 $\\;k=\\big\\lfloor\\frac pi\\big\\rfloor$ , $r=p\\; mod\\; i$;\n\u3000\u3000\n  \n  $\\;\\;\\;\\;\\;\\;$ $i^{-1}$ \u2261 $\\;-\\big\\lfloor\\frac pi\\big\\rfloor$ $*(p\\; mod \\;i)^{-1} \\;\\;(mod\\; p)$ \u2461 \n\u3000\n \n \u7531\u4e8e $(p\\; mod\\; i) < i$ ,\n \n $\\;\\;\\;\\;\\;\\;$ \u6240\u4ee5,\u5728\u6c42\u51fa $i^{-1}$ \u4e4b\u524d,\u6211\u4eec\u65e9\u5df2\u6c42\u51fa $(p\\; mod \\;i)^{-1}$\uff1b\n\u3000\u3000\n  \n  $\\;\\;\\;\\;\\;\\;$ \u56e0\u6b64\u7528\u6570\u7ec4 $inv[i]$ \u8bb0\u5f55$i^{-1}$ ( $i$ \u7684\u9006\u5143)\n\u3000\u3000\n  \n  $\\;\\;\\;\\;\\;\\;$ \u5219$inv[i]=-\\frac{p}{i}\\ * inv[p\\;mod\\;i]\\;mod\\;p$ ;\n\n\u3000\u4e0d\u8981\u4ee5\u4e3a\u5230\u8fd9\u91cc\u5c31\u7ed3\u675f\u4e86\n\u3000\u3000\n  \n  $\\;\\;\\;\\;\\;\\;$ \u56e0\u4e3a\u6211\u4eec\u9700\u8981\u4fdd\u8bc1 $i^{-1}>0$\n\u3000\n \n $\\;\\;\\;\\;\\;\\;$ \u6240\u4ee5,\u6211\u4eec\u5728\u2461\u5f0f\u53f3\u8fb9$\\;+p\\; $( $p\\;mod\\; p=0$, \u7b54\u6848\u4e0d\u53d8)\n\u3000\u3000\n  \n  $\\;\\;\\;\\;\\;\\;$ \u5373 $inv[i]=p-\\frac{p}{i}\\ * inv[p\\;mod\\;i]\\;\\;mod\\;p$;\n\u3000\u3000\n  \n  $\\;\\;\\;\\;\\;\\;$ \u5f53\u7136 $inv[1]=1,inv[0]=tan90$\u00b0(\u8d4b\u503c\u4e3a$0$);\n\u3000\u3000\n  \n  $\\;\\;\\;\\;\\;\\;$\u800c\u4e14$for$\u5faa\u73af \u8981\u4ece$2$\u5f00\u59cb\uff0c\u9632\u6b62\u6539\u53d8 $inv[1]$ \u7684\u503c;\n\u3000\n \n \u81f3\u6b64,\u8bc1\u6bd5\u3002\n ```cpp\n//AC_664ms\n#include<cstdio>\n#define ll long long\nusing namespace std;\nconst int maxn=3e6+5;\nll inv[maxn]={0,1};\nint main(){\n    int n,p;\n    scanf(\"%d%d\",&n,&p);\n    printf(\"1\\n\");\n    for(int i=2;i<=n;i++)\n        inv[i]=(ll)p-(p/i)*inv[p%i]%p,printf(\"%d\\n\",inv[i]);\n    return 0;\n}\n```",
        "postTime": 1534586602,
        "uid": 49618,
        "name": "Rising_Date",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "\u5148\u65e0\u826f\u5ba3\u4f20\u4e00\u4e0b\u535a\u5ba2wwwwww  \n[\u6587\u7ae0\u5217\u8868 - \u6838\u878d\u5408\u7089\u5fc3 - \u6d1b\u8c37\u535a\u5ba2](https://www.luogu.org/blog/koishikoishi/)\n\n- ## \u4e58\u6cd5\u9006\u5143: \n    \n    \u5bf9\u4e8e\u4e00\u4e2a\u6a21\u6570 $p$ \u548c\u4e00\u4e2a\u9664\u6570 $x$ ,\u5f80\u5f80\u53ef\u4ee5\u627e\u5230\u4e00\u4e2a\u7279\u6b8a\u6570 $y$ ,   \n  \u5c06$\\div x$ \u6539\u4e3a $\\times y$ , \u5373\u53ef\u4ee3\u66ff\u3002\n  \n  \u8fd9\u4e2a\u6570 $y$ ,\u79f0\u4e3a $x$ \u7684\"\u9006\u5143\",\u8bb0\u4f5c $inv(x)$ \u3002\n  \n  \u4f8b:   \n  $3 \\div 3 \\times 4 (\\mod 11)$  \n  $=3 \\times 4 \\times 4 (\\mod 11)$  \n  $= 4$  \n  \u5176\u4e2d, $4$ \u5373\u4e3a\u6a21\u6570\u4e3a $11$ \u65f6 , $3$ \u7684 \u9006\u5143.\n\n\n  \u901a\u8fc7\u5b9a\u4e49\u4e0e\u4f8b\u5b50 , \u4e0d\u96be\u770b\u51fa\u9006\u5143\u4e0e\u539f\u6570\u4e4b\u95f4\u7684\u5173\u7cfb:  \n  $\\large x \\times inv(x) \\equiv 1(\\mod p)$\n\n  \n\n------------\n\n- ## \u6c42\u89e3\u6a21\u7684\u9006\u5143:\n\n[P3811 \u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143](https://www.luogu.org/problemnew/show/P3811)\n\n##### \u6709 $4$ \u79cd\u65b9\u6cd5\u53ef\u4ee5\u6c42\u5f97 **\u6a21\u7684\u9006\u5143**\n\n  \n  \n  1. ### **\u6839\u636e** \u6269\u5c55\u6b27\u51e0\u91cc\u5f97 : \n     \n     #### \u6a21\u6570\u53ef\u4ee5 \u4e0d\u4e3a\u8d28\u6570\n     \n     $x \\times inv(x) \\equiv 1(\\mod p)$ \u5176\u4e2d $x,p$ \u90fd\u662f\u5df2\u77e5\u7684\u3002\n\n     \u6709\u6ca1\u6709\u5f88\u773c\u719f \uff1f\n\n\t \u8fd9\u5c31\u662f\u4e00\u4e2a   \n     \u672a\u77e5\u6570\u4e3a $inv(x)$ ,   \u65b9\u7a0b\u53f3\u4fa7\u7684 $c=1$ \u7684\u540c\u4f59\u65b9\u7a0b , \n     \n     \u6c42 $inv(x)$ \u7684\u503c , \u89e3\u51fa\u6b64\u540c\u4f59\u65b9\u7a0b\u5373\u53ef\u3002\n     \n     \u5173\u4e8e **\u6269\u5c55\u6b27\u51e0\u91cc\u5f97** \u4e0e **\u89e3\u540c\u4f59\u65b9\u7a0b** \uff0c   \n     \u8be6\u89c1\uff1a [\u6b27\u51e0\u91cc\u5f97 \u4e0e \u6269\u5c55\u6b27\u51e0\u91cc\u5f97 - \u6838\u878d\u5408\u7089\u5fc3 - \u6d1b\u8c37\u535a\u5ba2](https://www.luogu.org/blog/koishikoishi/ou-ji-li-dei-yu-kuo-zhan-ou-ji-li-dei)\n\n------------\n\n\n2. ### **\u6839\u636e** \u8d39\u9a6c\u5c0f\u5b9a\u7406 :  \n\n    #### \u53ea\u9002\u7528\u4e8e\u6a21\u6570\u4e3a\u8d28\u6570\u7684\u60c5\u51b5\n\n   \u7531\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff1a   \n   $\\large x ^{p-1} \\equiv 1 \\pmod p$ \n\n   **\u6545\u6709 :** $ x ^{p-1}\\equiv x \\times inv(x) \\pmod p$\n\n   \u7b49\u5f0f\u4e24\u4fa7\u540c\u9664x , **\u6709:** $inv(x) \\equiv x ^{p-2} \\pmod p$\n\n   \u4e4b\u540e\u53ef\u4ee5\u901a\u8fc7\u5feb\u901f\u5e42\u6c42\u4f59 , \u6c42\u5f97 $(x ^{p-2} ) \\% p$ \u7684\u503c ,    \n   \u5373\u53ef\u76f4\u63a5\u5f97\u5230 $inv(x)$ \u7684\u503c\n   \n\n------------\n\n\n3. ### **\u9012\u63a8\u6cd5** : \n\n   #### \u53ea\u9002\u7528\u4e8e\u6a21\u6570\u4e3a\u8d28\u6570\u7684\u60c5\u51b5\n\t\n   \u5982\u679c\u8981\u89e3\u6a21\u7684\u9006\u5143\u7684\u6570 , \u6570\u91cf\u5f88\u591a\uff0c\u4f46\u662f\u8fde\u7eed , \u90a3\u8be5\u600e\u4e48\u529e ? \n\n   \u5c31\u53ef\u4ee5\u4f7f\u7528\u9012\u63a8\u6cd5 \u3002\n  \n   $i$ \u6a21 $p$ \u610f\u4e49\u4e0b\u7684\u9006\u5143 $inv(i)$ \u53ef\u8868\u793a\u4e3a :\u3000\n   \n   $\\large inv(i) = -\\lfloor \\frac{p}{i}\\rfloor \\times inv(p\\% i)\\% p$\n   \n   - ###### \u8bc1\u660e:\n     **\u8bbe** $p=k\\times i + r $ , $(k,r \\in Z)$\n     \n     **\u56e0\u4e3a :** $p \\equiv 0 (\\mod p)$ , \n     \n     **\u5219 :** $(k\\times i + r) \\equiv 0 (\\mod p)$\n     \n     \u4f7f\u65b9\u7a0b\u4e24\u8fb9\u540c\u4e58 : $inv(i)\\times inv(r)$ , \n     \n     \u6839\u636e \u9006\u5143\u7684\u6027\u8d28 \uff0c**\u5219:**\n     \n     $(inv(i) \\times i )\\% p=1$  \uff0c  $(inv(r) \\times r )\\% p=1$ ;\n     \n     **\u539f\u5f0f\u53d8\u4e3a \uff1a**\n     \n     $k \\times 1 \\times inv(r) + 1\\times inv(i) \\equiv 0 (\\mod p)$\n     \n     $inv(i) \\equiv -k\\times inv(r)$\n\n\t **\u53c8\u56e0\u4e3a :**  $p=k\\times i + r $ \n     \n     **\u539f\u5f0f\u53d8\u4e3a \uff1a** $inv(i) \\equiv -\\lfloor \\frac{p}{i}\\rfloor\\times inv(p\\%i) (\\mod p)$\n\n\t **\u5373 \uff1a** $inv(i) = -\\lfloor \\frac{p}{i}\\rfloor \\times inv(p\\% i) \\% p$\n\n\t \u53c8\u56e0\u4e3a : $(p\\% i) <i$ , \n     \n     **\u5219 :** $inv(p\\% i)$ \u5728\u6c42\u51fa $inv(i)$ \u524d\u4fbf\u5df2\u6c42 , \u53ef\u4ee5\u8fdb\u884c\u9012\u63a8\n\n     **\u539f\u5f0f\u5f97\u8bc1 \u3002**\n\t \n     \u663e\u7136 , \u6c42\u5f97\u7684 $inv(i)$ \u4e0d\u4e00\u5b9a\u4e3a\u6700\u5c0f\u6574\u6570\u89e3\n   \n     \u82e5\u8981\u83b7\u5f97\u6700\u5c0f\u6b63\u6574\u6570\u89e3,\u9700\u8981\u518d\u52a0\u8fd9\u6837\u4e00\u6b65\u64cd\u4f5c:\n\t\n     \u4f7f $-\\lfloor \\frac{p}{i}\\rfloor$ \u5148\u52a0\u4e0a\u4e00\u4e2a $p$ , \u518d\u5c06\u5176\u6a21\u6389 \u3002\n   \n     \u5373 : $inv(i) = (p - \\lfloor \\frac{p}{i}\\rfloor)\\times  inv(p \\% i) \\% p;$\n     \n\n------------\n\n\n4. ### **\u9636\u4e58\u9006\u5143\u6cd5\uff1a** \n\n\t#### \u53ea\u9002\u7528\u4e8e\u6a21\u6570\u4e3a\u8d28\u6570\u7684\u60c5\u51b5\n    \n    \u8bbe $f(i)=inv(i!)$ , $\\ \\ g(i)=i! $\n    \n    **\u5219\uff1a** $f(i-1) = f(i)\\times i$ \n    \n    - ###### \u8bc1\u660e:\n      \n      $f(i-1)=\\frac{1}{\\ (i-1)\\ !}=\\frac{1}{i\\ !}\\times i =f(i)\\times i$\n    \n    \u5047\u8bbe\u8981\u6c42 $[1,n]$ \u4e2d\u6240\u6709\u6570\u7684\u9006\u5143\n    \n    \u5148\u6c42\u5f97 $[1,n]$ \u4e2d\u6240\u6709\u6570\u7684\u9636\u4e58\n    \n    \u518d\u7528 \u8d39\u9a6c\u5c0f\u5b9a\u7406 \u6c42\u5f97 $f(n)$ \u7684\u503c\n    \n    \u4e4b\u540e\u9012\u63a8\u51fa $f(1 \\sim n)$ \u7684\u503c\n    \n    \u4f46\u662f $inv(1! \\sim n! )$ \u5e76\u4e0d\u662f\u6211\u4eec\u60f3\u8981\u7684\u7b54\u6848\n    \n    \u9700\u8981\u7ee7\u7eed\u8f6c\u5316\u3002\n    \n    \u53ef\u77e5 : $inv(i) = inv(i!) \\times(i-1)\\ ! $\n    \n    - ###### \u8bc1\u660e : \n      \n      $inv(i)=\\frac{1}{i}=\\frac{1}{i\\ !}\\times (i-1)\\ ! = inv(i!)\\times (i-1)!$\n       \n    \u6309\u7167\u4e0a\u8ff0\u65b9\u6cd5\u8f6c\u6362,  \n    \u53ef\u5f97:  \n    \n    $inv(i)=f(i)\\times (i-1)!$\n    \n    \u5373\u5f97\u7b54\u6848 \u3002\n    \n\n------------\n\n  - ## \u56de\u5230\u6b64\u9898\n  \n  \u5148\u770b\u4e00\u773c\u6570\u636e\u8303\u56f4:  \n  $1\\leqslant n \\leqslant 3\\times 10^6$ , $n<p<20000528$  \n  \u8f93\u5165\u4fdd\u8bc1 $p$ \u4e3a\u8d28\u6570. \n  \n  \u5f88\u660e\u663e, **\u6269\u6b27\u6cd5** \u548c **\u5feb\u901f\u5e42\u6cd5** \u90fd\u88ab\u5361\u4e86 .\n  \n  \u7531\u4e8e\u533a\u95f4\u8fde\u7eed , \u4e14\u6a21\u6570 $p$ \u4e3a\u8d28 ,   \n  \u5219\u53ef\u4ee5\u8fdb\u884c **\u7ebf\u6027\u9012\u63a8**\n  \n  \u539f\u7406\u4e0a\u9762\u8bb2\u7684\u975e\u5e38\u6e05\u695a.  \n  \n  \u4ee3\u7801\u5982\u4e0b:\n  \n  ### **\u9012\u63a8\u6cd5** :\n    \n ```cpp\n#include<cstdio>\nusing namespace std;\nlong long n,p;\nlong long ans[5000010]={0,1};\nint main()\n{\n    scanf(\"%lld%lld\",&n,&p);\n    printf(\"1\\n\");\n    for(long long i=2;i<=n;i++) //\u7ebf\u6027\u9012\u63a8\n      {\n      \tans[i]=(long long)(p-p/i)*ans[p%i]%p;\n        printf(\"%lld\\n\",ans[i]); \n      }\n}\n```\n  \n  ### **\u9636\u4e58\u9006\u5143\u6cd5\uff1a** \n\n  ```cpp\n#include<cstdio>\n#define ll long long\nusing namespace std;\nll mul(ll a,ll b,ll mod) //\u5feb\u901f\u5e42\u6a21\u677f\n{\n\tll ans=1;\n\twhile(b)\n\t  {\n\t  \tif(b&1) ans=ans*a%mod;\n\t  \ta=(a*a)%mod;\n\t  \tb>>=1;\n\t  }\n\treturn ans%mod;\n}\nll n,p;\nll c[5000010]={1};\nll f[5000010];\nint main()\n{\n\tscanf(\"%lld%lld\",&n,&p);\n\tfor(int i=1;i<=n;i++)\n\t  c[i]=(c[i-1]*i)%p;\n\t  \n\tf[n]=mul(c[n],p-2,p); //\u83b7\u5f97inv(n!)\n\t\n\tfor(int i=n-1;i>=1;i--) //\u9012\u63a8\u9636\u4e58\u7684\u9006\u5143\n\t  f[i]=(f[i+1]*(i+1))%p;\n\t  \n\tfor(int j=1;j<=n;j++) //\u8f6c\u5316\u5e76\u8f93\u51fa\n\t  printf(\"%lld\\n\",(f[j]*c[j-1])%p);\n}\n```\n------------",
        "postTime": 1558573474,
        "uid": 186186,
        "name": "\u7075\u4e4c\u8def\u7a7a",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "\u7ed9\u5b9a\u6a21\u6570p\uff1a\u6c42\u5982\u4e0b\u56db\u4e2a\u95ee\u9898\u3002\n\n\u89c4\u5b9a\uff1a  $inv[a]$ \u548c $a^{-1}$ \u90fd\u8868\u793aa\u7684\u9006\u5143\u3002\n\n## \u95ee\u98981\uff1a\n\n\u7ed9\u5b9a\u6570\u5b57a\uff0c\u5176\u4e2d$gcd(a,p)=1$\uff0c\u6c42a\u7684\u9006\u5143\u3002\n\n### \u6cd5\u4e00\uff1aexgcd\uff0c\u6269\u6b27\n```cpp\nvoid exgcd(int a,int b,int &x,int &y){\n\tif(b==0){\n\t\tx=1;y=0;\n\t\treturn;\n\t}\n\tint q=a/b,r=a%b;\n\texgcd(b,r,y,x);\n\ty-=q*x;\n}\nint inv(int a,int b){\n\tint x,y;\n\texgcd(a,b,x,y);\n\treturn x;\n}\n```\n### \u6cd5\u4e8c\uff1a\u5feb\u901f\u5e42+\u8d39\u9a6c\u5c0f\u5b9a\u7406\n\n$a^{p-1}\\equiv1 (mod \\ p)$  `\u5176\u4e2dp\u4e3a\u8d28\u6570`\n\n$a^{p-2}\\equiv a^{-1}(mod \\ p)$     \n\n\u53ef\u5f97a\u5728mod p\u610f\u4e49\u4e0b\u7684\u9006\u5143\u5373\u4e3aksm(2,p-2);\n\n#### \u4ee5\u4e0a\u4e24\u79cd\u65b9\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6\u7686\u4e3a$O(log_2N)$\n\n## \u95ee\u98982\uff1a\n\n\u7ed9\u5b9an,p\uff0c\u6c421\u2026\u2026n\u7684\u9006\u5143\uff1ap\u4e3a\u8d28\u6570\n\n\u65b9\u6cd5\uff1a $\\begin{cases}inv[1]=1\\\\inv[i]=(p-\\lfloor\\frac{p}{i}\\rfloor)*inv[p\\ mod\\ i] mod\\ p\\end{cases}$ \n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(N)$\n\n## \u95ee\u98983\uff1a\n\n\u7ed9\u5b9an\uff0c\u6c42$1!,2!,3!,4!\u2026\u2026,n!$\u5171n\u4e2a\u6570\u7684\u9006\u5143\u3002\n\n$f(n)\\equiv f(n-1)*n (mod\\ p)$\n\n$f(n-1)^{-1}\\equiv f(n)^{-1}*n$\n\n\u5373\uff1a\u6c42\u51fa$n!$\u7684\u9006\u5143\uff0c\u5012\u63a8\u6c42\u9006\u5143\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(N)$\n\n## $ \\color{red}\\text{\u95ee\u98984:(\u91cd\u70b9\uff01)}$\n\n\u7ed9\u5b9an\u4e2a\u6570$a_1$,$a_2$\u2026\u2026$a_n$,\u5206\u522b\u6c42\u51fa\u5b83\u4eec\u5728mod p\u610f\u4e49\u4e0b\u7684\u9006\u5143\u3002\n\n\u6211\u4eec\u8003\u8651\u6c42\u51fa$inv[a_x]$\uff1a\n\n\u5b9a\u4e49 $p0=\\prod\\limits_{i=1}^na_i$\n\n$p1=\\prod\\limits_{i=1}^{x-1} a_i$\n\n$p2=\\prod\\limits_{i=x+1}^n a_i$\n\n\u5373 p0\u662f\u5168\u79ef\uff0cp1\u662f\u524d\u7f00\u79ef\uff0cp2\u662f\u540e\u7f00\u79ef\u3002\u5f97\uff1a\n\n$a_x*p1*p2\\equiv p0$\n\n$a_x^{-1}\\equiv p1*p2*p0^{-1}$\n\n\u6c42\u51fa $p0^{-1},p1,p2$\u5373\u53ef\n\n\u8fd9\u662f\u4e00\u4e2a\u79bb\u7ebf\u7b97\u6cd5\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$O(N)$\n\n### \u64b0\u6587\u6211\u4e0d\u6613\uff0c\u7559\u8d5e\u5fc5\u611f\u6fc0\u3002",
        "postTime": 1573572023,
        "uid": 52487,
        "name": "Kai_Admin",
        "ccfLevel": 6,
        "title": "\u4e58\u6cd5\u9006\u5143some tricks"
    },
    {
        "content": "\u5148\u5f15\u5165\u4e00\u4e2a\u76f8\u5173\u95ee\u9898\uff1a\n\n\u5982\u4f55\u5feb\u901f\u6c42\u89e3$1$~$n$\u7684\u9636\u4e58\u9006\u5143\uff1f\n\n\u9996\u5148\u6c42\u51fa$n!$\u7684\u9006\u5143\uff0c$(n-1)!$\u7684\u9006\u5143\u662f\u7b49\u4e8e$n!$\u7684\u9006\u5143\u4e58$n$\u3002\n\n\u8bbe$P(x)$\u4e3a$x$\u7684\u9006\u5143\uff0c\u53ef\u4ee5\u8fd9\u6837\u7b80\u6d01\u7684\u8bc1\u660e\uff1a\n\n$P(n!)\\times x=\\frac{1}{n!} \\times x$\n\n$P(n!) \\times n=\\frac{1}{(n-1)!}$\n\n\u90a3\u4e48\u540c\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u6c42\u5230$1$~$n$\u7684\u6240\u6709\u6570\u7684\u9636\u4e58\u7684\u9006\u5143\u3002\n\n-------------------------------------------\n\n\u597d\u4e86\u76f8\u5173\u95ee\u9898\u7ed3\u675f\u3002\n\n\u90a3\u4e48\u6211\u4eec\u77e5\u9053\u4e86$n!$\u7684\u9006\u5143\uff0c\u6211\u4eec\u600e\u4e48\u6c42$n$\u7684\u9006\u5143\u5462\uff1f\n\n\u5f53\u7136\u76f4\u63a5\u4e58\u4e0a$(n-1)!$\u5c31\u53ef\u4ee5\u5566\uff01\n\n\u8bc1\u660e\u548c\u4e0a\u9762\u5dee\u4e0d\u591a\uff1a\n\n$\\frac{1}{n!}=P(n!)$\n\n$\\frac{1}{n!} \\times (n-1)!=\\frac{1}{n}=P(n)=P(n!)\\times (n-1)!$\n\n\u7efc\u4e0a\uff1a$P(n)=P(n!)\\times (n-1)!$\n\n$1$~$n$\u7684\u9636\u4e58\u53ef\u4ee5\u9884\u5904\u7406\u7b97\u51fa\u5427\uff01\n\n$n!$\u7684\u9006\u5143\u53ef\u4ee5\u4e00\u6b21\u5feb\u901f\u5e42\u6c42\u51fa\u5427\uff01\n\n\u6700\u540e\u4ece\u5927\u5230\u5c0f\u7528\u4e0a\u9762\u7efc\u4e0a\u91cc\u7684\u516c\u5f0f\u4f9d\u6b21\u6c42\u51fa\u9006\u5143\uff0c\u522b\u5fd8\u4e86$\\%p$\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nlong long n;\n\nlong long p;\nlong long c[3000006];\n\nlong long fast(long long x,long long y)\n{\n    long long an=1;\n    while(y)\n    {\n        if(y&1)\n            an=(an*x)%p;\n        x=(x*x)%p;\n        y>>=1;\n    }\n    return an;\n}\n\nlong long ans[3000006];\n\nint main()\n{\n    scanf(\"%lld%lld\",&n,&p);\n    c[0]=1;\n    for(long long i=1;i<=n;i++)\n        c[i]=(c[i-1]*i)%p;\n    long long last=fast(c[n],p-2);\n    long long k;\n    for(int i=n;i>=1;i--)\n    {\n        k=(last*i)%p;\n        ans[i]=(last*c[i-1])%p;\n        last=k;\n    }\n    for(int i=1;i<=n;i++)\n        printf(\"%lld\\n\",ans[i]);\n    return 0;\n}\n\n```",
        "postTime": 1541661249,
        "uid": 34663,
        "name": "redegg",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "### \u8fd9\u662f\u4e00\u7bc7pascal\u9898\u89e3\n\u6839\u636e\u6570\u636e\u8303\u56f4\uff0c\u672c\u9898\u662f\u8981\u6211\u4eec\u5728\u7ebf\u6027\u65f6\u95f4\u6c421~n\u7684\u9006\u5143\n\n- ##### \u9006\u5143:\n \u6c42\u9006\u5143\uff0c\u9996\u5148\u6211\u4eec\u8981\u4e86\u89e3\u4ec0\u4e48\u662f\u9006\u5143\n 1. \u53d6\u6a21\u8fd0\u7b97\u7684\u6027\u8d28\n \n   (a+b) mod n=(a mod n+b mod n)mod n\n\n   a*b mod n=((a mod n)*(b mod n))mod n\n   \n   \u6211\u4eec\u53d1\u73b0\u5728\u6a21\u57df\u4e0b\u52a0\u51cf\u4e58\u90fd\u662f\u6bd4\u8f83\u65b9\u4fbf\u7684\n 1. \u9664\u6cd5?\n \n   (a/b)mod p?=(a mod p)/(b mod p) mod p\n   \n   \u3002\u3002\u3002\n   \n   (12/6)mod 3=2\n   \n   (12 mod 3)/(6 mod 3)mod 3=0\n   \n   emmmmmmmm\n   \n   \u5f88\u660e\u663e\u9664\u6cd5\u4e0d\u6ee1\u8db3\u4e0a\u8ff0\u7684\u6027\u8d28~\n   \n   \u5047\u82e5\u6709b\u4f7f\u5f97ab\u22611(mod p)\n   \n   \u90a3\u4e48\u9664\u4ee5a\u5c31\u7b49\u4ef7\u4e8e\u4e58b,\u8fd9\u6837\u5c31\u628a\u9664\u6cd5\u8f6c\u6362\u6210\u4e86\u4e58\u6cd5\u5566\u5566\u5566~~~\n   \n   \u6211\u4eec\u628ab\u79f0\u4f5ca\u7684\u9006\u5143,\u8bb0\u4f5ca^-1\n  \n  1. \u6c42\u9006\u5143\n    ab\u22611(mod p)\n    \n    \u7b49\u7b49\uff0c\u8fd9\u4e2a\u5f62\u5f0f\u4e0d\u6b63\u50cfnoip2012\u7684\u540c\u4f59\u65b9\u7a0b\u5417~\n    \n    \u90a3\u4e48\u5c31\u53ef\u4ee5\u7528\u62d3\u6b27\u6c42\u5566\n    \n    https://www.luogu.org/problemnew/show/P1082\n    \n    \u6cd5\u4e8c\uff1a\u8d39\u9a6c\u5c0f\u5b9a\u7406\n      \n      ![](https://cdn.luogu.com.cn/upload/pic/14741.png)\n      \n      \u5f88\u660e\u663ea^-1=a^(p-2)\n      \n      \u55ef\u5462\u5462,\u600e\u4e48\u5feb\u901f\u6c42\u5462\n      \n      https://www.luogu.org/problemnew/show/P1226\n      \n      \u54c8\u54c8\n\n\u6211\u4eec\u56de\u5230\u672c\u9898\n\n\u62d3\u6b27\u548c\u8d39\u9a6c\u5c0f\u5b9a\u7406\u4e00\u4e2a\u4e00\u4e2a\u7684\u6c42\uff0c\u65f6\u95f4\u90fd\u662fO(nlogn)\n\n\u62d3\u6b27(83\u5206)\n\n```pascal\n var a,b,x,y,i:longint;\nprocedure gcd(a,b:longint;var x,y:longint);\nbegin\n  if b=0 then\n  begin\n    x:=1;\n    y:=2;\n    exit;\n  end;\n  gcd(b,a mod b,y,x);\n  y:=y-(a div b)*x;\nend;\nbegin\n  readln(a,b);\n  for i:=1 to a do\n  begin\n    gcd(i,b,x,y);\n    writeln((x mod b +b) mod b);\n  end;\nend.\n```\n\n\u8d39\u9a6c(66\u5206)\n```pascal\nfunction mo(b,p,k:longint):longint;\nvar mid,t:longint;\nbegin\n  if p=1 then exit(b mod k);\n  mid:=p div 2;\n  t:=mo(b,mid,k);\n  if mid=p-mid then mo:=t*t mod k\n    else mo:=(t*t mod k)*(b mod k) mod k;\nend;\nvar i,p,n:longint;\nbegin\n  readln(n,p);\n  for i:=1 to n do \n  writeln(mo(i,p-2,p));\nend.\n```\n\n#### \u6ce8\uff1a\u4ee5\u4e0b\u6570\u5747\u5728(mod p)\u7684\u610f\u4e49\u4e0b\n\u6839\u636e\u8d39\u9a6c\u5c0f\u5b9a\u7406,a\u7684\u9006\u5143\u4e3aa^(p-2)\uff0cb\u7684\u9006\u5143\u4e3ab^(p-2)\n\nab\u7684\u9006\u5143\u4e3a(ab)^(p-2)=a^(p-2)*b^(p-2)\n\n\u82e5\u7528f(a)\u8868\u793aa\u7684\u9006\u5143\uff0c\u90a3\u4e48f(ab)=f(a)*f(b)\n\n\u6362\u53e5\u8bdd\u8bf4\uff0c\u53ea\u7528\u6c42\u8d28\u6570\u7684\u9006\u5143\u5373\u53ef\u63a8\u51fa\u5176\u4ed6\u6570\u7684\u9006\u5143\n\n\u60f3\u5230\u8fd9\u91cc\uff0c\u672c\u849f\u84bb\u5957\u4e0a\u4e86\u57c3\u6c0f\u7b5b\uff0c\u5728\u7b5b\u8d28\u6570\u7684\u500d\u6570\u65f6\u628a\u9006\u5143\u7ed9\u4e58\u4e0a\u53bb(\u5176\u5b9e\u662f\u7d20\u6570\u7b5b\u90a3\u9898\u6570\u636e\u6bd4\u8f83\u6c34\uff0c\u8ba9\u6211\u7528\u57c3\u6c0f\u7b5b\u6c34\u8fc7\u53bb\uff0c\u6240\u4ee5\u849f\u84bb\u6211\u4e00\u76f4\u628a\u57c3\u6c0f\u7b5b\u5f53\u6b27\u62c9\u7b5b)\n\n\u57c3\u6c0f\u7b5b(83\u5206\uff09\n```pascal\nvar n,p,y:longint;\n    f:array[1..20000528]of longint;\n    b:array[1..20000528]of boolean;\n    cnt,j,i,k:longint;\nprocedure gcd(a,b:longint;var x,y:longint);\nbegin\n  if b=0 then\n  begin\n    x:=1;\n    y:=2;\n    exit;\n  end;\n  gcd(b,a mod b,y,x);\n  y:=y-(a div b)*x;\nend;\nbegin\n  readln(n,p);\n  for i:=1 to n do\n  begin\n    f[i]:=1;\n    b[i]:=true;\n  end;\n  b[1]:=false;\n  writeln(1);\n   for i:=2 to n do\n  begin\n    if b[i] then\n    begin\n      gcd(i,p,f[i],y);\n      f[i]:=(f[i] mod p+p)mod p; \n      j:=i+i;\n      while j<n do\n      begin\n        b[j]:=false;\n        k:=j;\n        while k mod i=0 do\n        begin\n          f[j]:=f[j]*f[i] mod p;\n          k:=k div i;\n        end;\n        j:=j+i;\n      end;\n    end;\n    writeln(f[i]);\n  end;\nend.\n```\n\u7531\u4e8e\u65f6\u95f4\u4e0a\u4efb\u662fnlogn\u7684\u7ea7\u522b\uff0c\u4f9d\u7136\u8fc7\u4e0d\u4e86\u6700\u540e\u4e00\u4e2a\u70b9\n\n\u65e2\u7136\u5982\u6b64\uff0c\u6211\u4eec\u9009\u62e9~~\u771f\u6b63\u7684~~\u6b27\u62c9\u7b5b\n\n\u6b27\u62c9\u7b5b\u5728\u7528\u6700\u5c0f\u8d28\u6570\u53bb\u6e05\u5408\u6570\u7684\u662f\u540e\u53ef\u4ee5\u66f4\u65b0\u5408\u6570\u7684\u9006\u5143\uff0cf(ap)=f(a)*f(p)\uff0c\u56e0\u4e3ap<a<ap\u6240\u4ee5f(a)\u548cf(p)\u90fd\u5df2\u7ecf\u662f\u5df2\u77e5\u7684\u5566\n\n\u6b27\u62c9\u7b5b(100\u5206)\n```pascal\nvar b:array[1..30000000]of boolean;\n    a:array[1..1000000]of int64;\n    f:array[1..30000000]of longint;\n    n,p,k,i,j,y:longint;\nprocedure gcd(a,b:longint;var x,y:longint);\nbegin\n  if b=0 then\n  begin\n    x:=1;\n    y:=2;\n    exit;\n  end;\n  gcd(b,a mod b,y,x);\n  y:=y-(a div b)*x;\nend;\nbegin\n  f[1]:=1;\n  readln(n,p);\n  b[1]:=true;\n  for i:=2 to n do\n  begin\n    if b[i]=false then\n    begin\n      inc(k);\n      a[k]:=i;\n      gcd(i,p,f[i],y);//\u5982\u679c\u662f\u8d28\u6570\u5c31\u6c42\u9006\u5143\n      f[i]:=(f[i] mod p+p)mod p;\n    end;\n    for j:=1 to k do\n      if i*a[j]<=n then\n      begin\n        b[i*a[j]]:=true;\n        f[i*a[j]]:=f[a[j]]*f[i]mod p;//\u7528\u8d28\u6570\u66f4\u65b0\u5408\u6570\n        if i mod a[j]=0 then break;\n      end\n      else break;\n  end;\n  for i:=1 to n do\n    writeln(f[i]);\nend.\n```\n\n\u5b8c\u7f8e\u7684\u5728O(n)\u65f6\u95f4\u5185\u89e3\u51b3\n\n\u7136\u800c\u795e\u7287qhy\u544a\u8bc9\u6211\u9006\u5143\u53ef\u4ee5\u9012\u63a8\u6c42~~~\n\ndalao\u7684\u624b\u7a3f\n![](https://cdn.luogu.com.cn/upload/pic/14743.png)\n\n\u55ef\uff0c\u8bc1\u660e\u5f88\u6e05\u6670\u5566\n\nf(a)=(p-p div a)*f(p mod i) mod p\n\n\u90a3\u4e48\u901a\u8fc7\u8fd9\u4e2a\u5f0f\u5b50\u9012\u63a8\u5c31\u597d\u5566\n\n\u9012\u63a8\u7248(100\u5206)\n```pascal\nvar n,p,y:longint;\n    f:array[1..20000528]of longint;\n    b:array[1..20000528]of boolean;\n    cnt,j,i,k:longint;\n\nbegin\n  readln(n,p);\n  f[1]:=1;\n  writeln(1);\n  for i:=2 to n do\n  begin\n    f[i]:=(p-p div i)*f[p mod i]mod p;\n    writeln(f[i]);\n  end;\nend.\n```\n\n\u662f\u4e0d\u662f\u7b80\u4fbf\u8bb8\u591a\u5462(\uffe3\u25bd\uffe3)~*\n\n~~\u8fd8\u662f\u8981\u63a5\u53d7dalao\u7684\u718f\u9676\u5462~~",
        "postTime": 1519360590,
        "uid": 29245,
        "name": "Henry_he",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "# \u3010\u6570\u8bba\u3011\u4e58\u6cd5\u9006\u5143\n\n## Definition\n\n\u5bf9\u4e8e\u4e00\u4e2a\u6570 $x$ \u548c\u4e00\u4e2a\u6a21\u6570 $p$\uff0c\u82e5\u5b58\u5728\u4e00\u4e2a\u6570\u5b57 $y$\uff0c\u6ee1\u8db3\n\n$$x \\times y \\equiv 1 \\pmod p$$\n\n\u5219\u79f0 $y$ \u662f $x$ \u5728\u6a21 $p$ \u610f\u4e49\u4e0b\u7684**\u9006\u5143**\uff0c\u8bb0\u505a $x^{-1}~\\equiv y \\pmod p$\u3002\n\n\u4e00\u4e2a\u6570\u5b57\u9006\u5143\u5728\u6a21\u610f\u4e49\u4e0b\u7684\u8fd0\u7b97\u4e2d\u53ef\u4ee5\u5b8c\u5168\u53d6\u4ee3\u8be5\u6570\u5b57\u7684\u5012\u6570\u3002\u4f8b\u5982 $\\frac{x}{y}~\\equiv x \\times y^{-1} \\pmod p$\uff0c\u5176\u4e2d $y^{-1}$ \u4ee3\u8868 $y$ \u7684\u9006\u5143\u3002\n\n## Algorithm\n\n#### Lemma\n\n\u9996\u5148\u9700\u8981\u6307\u51fa\u7684\u662f\uff0c\u4e00\u4e2a\u6570 $x$ \u5728\u6a21 $p$ \u610f\u4e49\u4e0b\u5b58\u5728\u9006\u5143\uff0c\u5f53\u4e14\u4ec5\u5f53 $x$ \u4e0e $p$ \u4e92\u8d28\u3002\n\n#### Proof\n\n\u8fd9\u91cc\u53ea\u8bc1\u660e\u5f53 $x$ \u4e0e $p$ \u4e0d\u4e92\u8d28\u65f6\u4e0d\u5b58\u5728\u9006\u5143\u3002\u5bf9\u4e8e\u9006\u5143\u7684\u5b58\u5728\u6027\uff0c\u7531\u4e8e\u4e0b\u9762\u7684\u90e8\u5206\u7ed9\u51fa\u4e86\u9006\u5143\u7684\u6784\u9020\u7b97\u6cd5\uff0c\u8fd9\u5c31\u5df2\u7ecf\u8bc1\u660e\u4e86\u5728\u4e92\u8d28\u65f6\u9006\u5143\u662f\u5b58\u5728\u7684\u3002\n\n\u53cd\u8bc1\u6cd5\uff0c\u8bbe\u5bf9\u4e8e\u4efb\u610f\u7684 $x \\in Z^+$\uff0c\u5b58\u5728 $x^{-1} \\in Z^+$\n\n$$x \\times x^{-1} \\equiv 1 \\pmod p~~~~~~(1)$$\n\n\u4e14\n\n$$\\gcd(x,~p) = d \\neq 1~~~~~~(2)$$\n\n\u6839\u636e\u540c\u4f59\u7684\u5b9a\u4e49\uff0c$(1)$ \u53ef\u4ee5\u5199\u6210\uff1a\n\n$$x \\times x^{-1} = k \\times p + 1~~~~~~(3)$$\n\n\u5176\u4e2d $k$ \u662f\u4e00\u4e2a\u975e\u8d1f\u6574\u6570\u3002\n\n\u5c06 $(3)$ \u7684\u7b49\u53f7\u4e24\u4fa7\u540c\u65f6\u9664\u4ee5 $(2)$ \u4e2d\u7684 $d$\uff1a\n\n$$\\frac{x \\times x^{-1}}{d}~=~\\frac{k \\times p + 1}{d}~~~~~~(4)$$\n\n\u6574\u7406\u5f97\u5230\n\n$$\\frac{x}{d} \\times x^{-1}~=~\\frac{p}{d} \\times k  + \\frac{1}{d}~~~~~~(5)$$\n\n\u56e0\u4e3a $d = \\gcd(x, p)$\uff0c\u6240\u4ee5 $d$ \u4e00\u5b9a\u662f $x$ \u548c $p$ \u7684\u56e0\u6570\u3002\u6240\u4ee5\n\n$\\frac{x}{d}$ \u548c $\\frac{p}{d}$ \u90fd\u662f\u6574\u6570\uff0c\u8fdb\u800c $\\frac{p}{d} \\times k$ \u662f\u6574\u6570\uff0c$\\frac{x}{d} \\times x^{-1}$ \u662f\u6574\u6570\u3002\n\n\u800c\u56e0\u4e3a $d \\neq 1$\uff0c\u6240\u4ee5 $\\frac{1}{d}$ \u4e00\u5b9a\u4e0d\u662f\u6574\u6570\uff0c\u56e0\u6b64 $\\frac{p}{d} \\times k + \\frac{1}{d}$ \u4e0d\u662f\u6574\u6570\u3002\n\n\u4e8e\u662f\u7b49\u53f7\u5de6\u4fa7\u662f\u6574\u6570\uff0c\u7b49\u53f7\u53f3\u4fa7\u4e0d\u662f\u6574\u6570\uff0c\u5de6\u4fa7\u4e00\u5b9a\u4e0d\u7b49\u4e8e\u53f3\u4fa7\uff0c\u4ea7\u751f\u77db\u76fe\u3002\u8fd9\u5c31\u77db\u76fe\u8bc1\u660e\u4e86 $x$ \u5728\u6a21 $p$ \u610f\u4e49\u4e0b\u5b58\u5728\u9006\u5143\u4ec5\u5f53 $x$ \u4e0e $p$ \u4e92\u8d28\u3002\n\n---\n\n\u4ee5\u4e0b\u4ecb\u7ecd\u6c42\u9006\u5143\u7684\u7b97\u6cd5\uff1a\n\n#### \u6c42\u5355\u4e2a\u6570\u5b57\u7684\u9006\u5143\n\n##### Algorithm 1\n\n$$x \\times x^{-1}~\\equiv 1 \\pmod p$$\n\n\u663e\u7136\u53ef\u4ee5\u8f6c\u5316\u6210\u65b9\u7a0b\n\n$x \\times x^-1 = 1 + kp$\n\n\u4ee4 $y = -k$\uff0c\u79fb\u9879\u5f97\u5230\n\n$$x \\times x^{-1} + y \\times p = 1$$\n\n\u6ce8\u610f\u5230\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u662f\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u6240\u6c42\u7684\u5f0f\u5b50\n\n$$ax + by = 1$$\n\n\u53ea\u4e0d\u8fc7 $x$ \u4f5c\u4e3a\u4e00\u4e2a\u5e38\u6570\uff0c\u662f\u6b27\u5f0f\u5f0f\u5b50\u91cc\u7684 $a$\uff0c\u540c\u7406 $p$ \u662f\u6b27\u5f0f\u5f0f\u5b50\u91cc\u7684 $b$\u3002\u4f7f\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u6c42\u89e3\u4e0a\u9762\u8fd9\u4e2a\u5f0f\u5b50\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\log x)$\u3002\n\n##### Algorithm 2\n\n\u6839\u636e\u6b27\u62c9\u5b9a\u7406\n\n$x^{\\phi(p)} \\equiv 1 \\pmod p$\n\n\u5176\u4e2d $\\phi$ \u4e3a\u6b27\u62c9\u51fd\u6570\uff0c$\\phi(p)$ \u8868\u793a\u5c0f\u4e8e $p$ \u7684\u6b63\u6574\u6570\u4e2d\u4e0e $p$ \u4e92\u8d28\u7684\u6570\u7684\u4e2a\u6570\u3002\n\n\u7b49\u5f0f\u4e24\u4fa7\u540c\u4e58 $x^{-1}$ \u53ef\u4ee5\u5f97\u5230\n\n$$x^{\\phi(p) - 1} \\equiv x^{-1} \\pmod p$$\n\n\u663e\u7136\u5f53 $p$ \u662f\u4e00\u4e2a\u8d28\u6570\u65f6\uff0c$\\phi(p) = p - 1$\uff0c\u8fd9\u65f6\u53ef\u4ee5 $O(1)$ \u7b97\u51fa $\\phi(p) - 1$ \u7684\u503c\uff0c\u5373\u53ef\u7528\u5feb\u901f\u5e42 $O(\\log x)$ \u6c42\u51fa $x$ \u7684\u9006\u5143\u3002\u8fd9\u4e2a\u7b97\u6cd5\u597d\u5199\u597d\u8bb0\uff0c\u5e38\u6570\u4e5f\u8f83\u5c0f\u3002\u4e00\u822c\u5f53 $p$ \u4e3a ``int`` \u8303\u56f4\u5185\u7684\u8d28\u6570\u65f6\u9009\u62e9\u6b64\u7b97\u6cd5\u3002\u5f53 $p$ \u4e0d\u5728 ``int`` \u8303\u56f4\u5185\u65f6\uff0c\u7531\u4e8e\u5feb\u901f\u5e42\u65f6\u9700\u8981\u4e24\u4e2a ``long long`` \u76f8\u4e58\uff0c\u4f1a\u7206\u7cbe\u5ea6\u3002\n\n\u6709\u5173\u6b27\u62c9\u5b9a\u7406\u7684\u8bc1\u660e\u53ef\u4ee5\u770b[\u8fd9\u91cc](https://www.cnblogs.com/zylAK/p/9569668.html)\n\n#### \u6c42 $n$ \u4ee5\u5185\u6240\u6709\u6b63\u6574\u6570\u6a21 $p$ \u7684\u9006\u5143\n\n\u663e\u7136\uff0c\u7531\u4e8e $n$ \u4ee5\u5185\u6240\u6709\u6b63\u6574\u6570\u90fd\u6709\u5728\u6a21 $p$ \u610f\u4e49\u4e0b\u7684\u9006\u5143\uff0c\u6240\u4ee5 $p$ \u548c $n$ \u4ee5\u5185\u7684\u6240\u6709\u6570\u4e92\u8d28\u3002\n\n\u7ed3\u8bba\uff1a\u8bbe $inv_i$ \u4e3a $i$ \u7684\u9006\u5143\uff0c\u5219\u6709\u9012\u63a8\u5f0f\n\n$$inv_i \\equiv -\\left\\lfloor\\frac{p}{i}\\right\\rfloor \\times inv_{p \\bmod i} \\pmod p$$\n\n\u8fb9\u754c\u6761\u4ef6\u4e3a\n\n$$inv_1 = 1$$\n\n##### Proof\n\n\u9996\u5148 $inv_1 = 1$ \u663e\u7136\u6210\u7acb\u3002\n\n\u5bf9\u4e8e $i > 1$\uff0c\u5199\u51fa $p$ \u9664\u4ee5 $i$ \u7684\u5e26\u4f59\u9664\u6cd5\u8868\u8fbe\u5f0f\uff1a\n\n$$p = ki + r$$\n\n\u5176\u4e2d $r \\in [0, i - 1]$\n\n\u7b49\u5f0f\u4e24\u4fa7\u5bf9 $p$ \u53d6\u4f59\u6570\uff0c\u6709 \n\n$$0 \\equiv ki + r \\pmod p$$\n\n\u79fb\u9879\u5f97\u5230\n\n$$r \\equiv -ki \\pmod p$$\n\n\u4e24\u4fa7\u540c\u4e58 $i^{-1} \\times r^{-1}$\uff0c\u6574\u7406\u5f97\u5230\n\n$$i^{-1} \\equiv -kr^{-1} \\pmod p$$\n\n\u7531\u4e8e $k = \\left\\lfloor\\frac{p}{i}\\right\\rfloor$\uff0c$r = p \\bmod i$\uff0c\u6240\u4ee5\u539f\u5f0f\u5f97\u8bc1\u3002\n\n\u53c8\u56e0\u4e3a $r < i$\uff0c\u6240\u4ee5\u5728\u8ba1\u7b97 $inv_i$ \u65f6\uff0c$inv_r$ \u5df2\u7ecf\u88ab\u8ba1\u7b97\u5b8c\u6210\uff0c\u6240\u4ee5\u4e0a\u8ff0\u9012\u63a8\u53ef\u4ee5\u5b8c\u6210\u3002\n\n\u8bc1\u6bd5\u3002\n\n\u8fd9\u6837\u505a\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u663e\u7136\u662f $O(n)$\n\n#### \u6c42 $n!$ \u7684\u9006\u5143\n\n\u56e0\u4e3a $(n!)^{-1} \\equiv \\frac{1}{n!} \\equiv \\prod_{i = 1}^n n^{-1}$\uff0c\u6240\u4ee5\u7ebf\u6027\u7b5b\u51fa $n$ \u4ee5\u5185\u6240\u6709\u6570\u5b57\u7684\u9006\u5143\u65f6\uff0c\u53ef\u4ee5\u987a\u4fbf\u6c42\u51fa $n!$ \u7684\u9006\u5143\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$\n\n## Code\n\n### Ex_Gcd\n\n```cpp\n#include <iostream>\n\ntypedef long long int ll;\n\nll x, p;\n\nvoid Ex_gcd(const ll a, const ll b, ll &X, ll &Y);\n\nint main() {\n  std::cin >> x >> p;\n  ll a, b;\n  Ex_gcd(x, p, a, b);\n  std::cout << (a % p + p) % p << std::endl;\n  return 0;\n}\n\nvoid Ex_gcd(const ll a, const ll b, ll &X, ll &Y) {\n  if (b == 0) {\n    X = 1; Y = 0;\n  } else {\n    Ex_gcd(b, a % b, Y, X);\n    Y -= a / b * X;\n  }\n}\n```\n\n### \u6b27\u62c9\u5b9a\u7406\n\n```cpp\n#include <iostream>\n\ntypedef long long int ll;\n\nll X, p;\n\nll mpow(ll x, ll y);\n\nint main() {\n  std::cin >> X >> p;\n  std::cout << mpow(X, p - 2) << std::endl;\n  return 0;\n}\n\nll mpow(ll x, ll y) {\n  ll _ret = 1;\n  while (y) {\n    if (y & 1) (_ret *= x) %= p;\n    y >>= 1;\n    (x *= x) %= p;\n  }\n  return _ret;\n}\n```\n\n### \u7ebf\u6027\u6c42\u9006\u5143\n\n\u8fd9\u91cc\u7684 ``factinv`` \u5373\u4e3a\u9636\u4e58\u9006\u5143\u3002\n\n```cpp\n#include <cstdio>\n\nconst int maxn = 3000005;\n\nint n, p;\nint inv[maxn], factinv[maxn];\n\nint main() {\n  scanf(\"%d%d\", &n, &p);\n  factinv[1] = inv[1] = 1;\n  printf(\"%d\\n\", 1);\n  for (int i = 2; i <= n; ++i) {\n    inv[i] = 1ll * (p - p / i) * inv[p % i] % p;\n    printf(\"%d\\n\", inv[i]);\n    factinv[i] = 1ll * factinv[i - 1] * inv[i] % p;\n  }\n  return 0;\n}\n```\n\n",
        "postTime": 1578315123,
        "uid": 65363,
        "name": "\u4e00\u6276\u82cf\u4e00",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "\u4e00\u53e5\u8bdd\u9898\u610f\uff1a\u6709\u4e00\u4e2a\u6570k\uff0c\u627e\u4e00\u4e2ainv[k]\u4f7f\u5f97\uff1a\n$$ k * inv[k] \\equiv 1 \\pmod p$$\n$$k\\in[1...n]$$\n\u8fd9\u9898\u8fd9\u4e48\u6bd2\u7624\u663e\u7136\u8981\u7ebf\u6027\u7684\u7b97\u6cd5\uff08\u6251\u54e7\uff09\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u6765yy\u4e00\u4e0b\n\n\u8bbe\u6709\uff1a$p=a*k+b$\n\n$$b*inv[b]\\equiv1\\pmod p $$\nyy\u4e00\u4e0b\uff0c\u628ab\u8f6c\u6362\u4e00\u4e0b\u8868\u8fbe\u65b9\u5f0f\n$$(p-a*k)*inv[b]\\equiv1 \\pmod p$$\n\u4e58\u6cd5\u5206\u914d\u7387\u4e00\u4e0b\u53ef\u4ee5\u5f97\u5230\uff1a\n$$p*inv[b]-a*k*inv[b]\\equiv 1 \\pmod p$$\n\u56e0\u4e3a\u7b2c\u4e00\u4e2a\u4e1c\u897f\u91cc\u9762\u6709p\u6240\u4ee5\u76f4\u63a5\u53d8\u62100\n$$-a*k*inv[b]\\equiv 1 \\pmod p$$\n\u628aa\uff0cb\u9b54\u6539\u4e00\u4e0b\u5f97\u5230\n$$-(p\\space div \\space k)*k*inv[p\\bmod k]\\equiv 1 \\pmod p$$\n\u4f46\u662f\u6709\u4e2a\u8d1f\u53f7\uff0c\u6240\u4ee5\u9b54\u6539\u4e00\u4e0b\u641e\u6389\uff0c\u628ak\u9664\u8fc7\u53bb\uff1a\n$$(p-(p\\space div\\space k))*inv[p\\bmod k]\\equiv inv[k]$$\nok O(n) \u6548\u7387\u641e\u8fc7\n\u61d2\u5f97\u8d34\u4ee3\u7801\n",
        "postTime": 1548579781,
        "uid": 88686,
        "name": "Shir\u03bf",
        "ccfLevel": 5,
        "title": "\u5982\u4f55\u6c42\u4e00\u6bb5\u6570\u7684\u9006\u5143"
    },
    {
        "content": "## \u8fd9\u662f\u4e00\u79cd\u4e0d\u4e00\u6837\u7684\u7ebf\u6027\u9006\u5143\u9012\u63a8\u6c42\u6cd5\n\n~~\u5176\u5b9e\u4e5f\u53ef\u4ee5\u7ebf\u6027\u6c42\u51fa\u6765\u4efb\u610f\u4e00\u5768\u76f8\u4e58\u5f97\u5230\u7684\u6570\u7684\u9006\u5143~~\n\n### \u601d\u8def\n\n\u6839\u636e\u9006\u5143\u7684\u610f\u4e49\uff0c\u6211\u4eec\u5bb9\u6613\u77e5\u9053\uff0c\u5982\u679c\u6211\u4eec\u77e5\u9053$(xy)^{-1}(mod p)$\uff0c\u90a3\u4e48\u6211\u4eec\u4e58\u4ee5$y$\uff0c\u5c31\u53ef\u4ee5$O(1)$\u5f97\u5230$x^{-1} (modp)$\u3002\n\n\u8fd9\u6837\uff0c$x$\u7684\u9006\u5143\uff0c\u53ef\u4ee5\u5229\u7528$(x!)^{-1} \\times (x - 1)!$\u8fd9\u4e2a\u5f0f\u5b50\u6c42\u51fa\u6765\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u9012\u63a8\u51fa$n!$\uff0c\u7136\u540e\u7528\u6269\u6b27\u6216\u8005\u5feb\u901f\u5e42\u6c42\u51fa$(n!)^{-1}(modp)$\uff0c\u5c31\u53ef\u4ee5\u53cd\u8fc7\u6765\u9012\u63a8\u51fa$1$\u5230$n$\u7684\u6240\u6709\u9006\u5143\n\n### \u4ee3\u7801\n\n`cout`\u4f1a\u8d85\u65f6\uff0c\u56e0\u4e3a\u53d6\u6d88\u6d41\u540c\u6b65\u548c\u7ed1\u5b9a\u53ea\u80fd\u52a0\u901f`cin`\n\n```cpp\n// luogu-judger-enable-o2\n#include <iostream>\n\nusing namespace std;\n\nconst int MAXN = 3e6 + 5;\n\nint fac[MAXN], inv[MAXN], n, p;\n\nint Exgcd(int a, int b, int &x, int &y) {\n    if (b == 0) {\n        x = 1;\n        y = 0;\n        return a;\n    }\n    int ret = Exgcd(b, a % b, y, x);\n    y -= 1LL * a / b * x;\n    return ret;\n}\n\nvoid GetInv(int x, int finv, int mod) {\n\tif (x == 0) return;\n\tint ninv = 1LL * finv * fac[x - 1] % mod;\n\tGetInv(x - 1, 1LL * finv * x % mod, mod);\n\t//cout << ninv << endl;\n\tprintf(\"%d\\n\", ninv);\n}\n\nint main() {\n\t//ios :: sync_with_stdio(false); cin.tie(NULL); cout.tie(NULL);\n\tcin >> n >> p;\n\tfac[0] = 1;\n\tfor (int i = 1; i <= n; i++) fac[i] = 1LL * fac[i - 1] * i % p;\n\tint x, y;\n\tExgcd(fac[n], p, x, y);\n\tGetInv(n, (x + p) % p, p);\n    return 0;\n}\n```",
        "postTime": 1563944854,
        "uid": 126376,
        "name": "Irelia\u10e6",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "## ~~\u975e\u5e38~~\u6bd4\u8f83\u5168\u7684\u6570\u8bba\u2014\u540c\u4f59\u5927\u793c\u5305\n\n\u9700\u8981\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\u8bf7\u6233\u672c\u849f\u84bb\u535a\u5ba2\uff1a\n\n[\u6d45\u8c08\u6b27\u62c9\u5b9a\u7406\u53ca\u4e58\u6cd5\u9006\u5143](https://www.cnblogs.com/fusiwei/p/12013269.html)\n\n# \u6d45\u8c08\u6b27\u62c9\u5b9a\u7406\n\n\u672c\u7bc7\u968f\u7b14\u7b80\u5355\u8bb2\u89e3\u4e00\u4e0b\u4fe1\u606f\u5b66\u5965\u6797\u5339\u514b\u7ade\u8d5b\u6570\u8bba\u90e8\u5206**\u6b27\u62c9\u5b9a\u7406**\u8fd9\u4e00\u77e5\u8bc6\u70b9\u3002\u4ecb\u7ecd\u7684\u5185\u5bb9\u5927\u81f4\u5206\u4e3a\u8fd9\u4e48\u51e0\u4e2a\u90e8\u5206\uff1a**\u201c\u540c\u4f59\u7684\u57fa\u672c\u6982\u5ff5\u3001\u8d39\u9a6c\u5c0f\u5b9a\u7406\u3001\u6b27\u62c9\u5b9a\u7406\u53ca\u5176\u63a8\u8bba\u3001\u4e58\u6cd5\u9006\u5143\u201d**\u3002\n\n## \u540c\u4f59\u7684\u57fa\u672c\u6982\u5ff5\n\n\u540c\u4f59\u7684\u6982\u5ff5\u554a\u975e\u5e38\u7b80\u5355\u5566\uff1a\u5982\u679c\u4e24\u4e2a\u6574\u6570$a,b$\u9664\u4ee5\u4e00\u4e2a\u6570$m$\u7684\u4f59\u6570\u76f8\u7b49\u7684\u8bdd\uff0c\u90a3\u4e48\u5c31\u53eb\u505a$a,b$\u5728\u6a21$m$\u7684\u610f\u4e49\u4e0a\u540c\u4f59\u3002\n\n\u8bb0\u4f5c\uff1a\n$$\na\\equiv b\\,\\,\\,(mod\\,\\,m)\n$$\n\u90a3\u4e48\u6839\u636e\u540c\u4f59\u7684\u8fd9\u4e2a\u5b9a\u4e49\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u80fd\u63a8\u5bfc\u51fa\u4e00\u4e2a\u6027\u8d28\uff1a\u5982\u679c\u4e24\u4e2a\u6570$a,b$\u5728\u6a21$m$\u7684\u610f\u4e49\u4e0b\u540c\u4f59\uff0c\u90a3\u4e48$a-b$\u5c31\u662f$m$\u7684\u500d\u6570\uff0c\u8fd9\u662f\u663e\u7136\u7684\u3002\n\n\u4ee5\u53ca\uff0c\u5982\u679c$a\\%m=1$\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u88ab\u6539\u5199\u6210\u8fd9\u6837\u7684\u5f0f\u5b50\uff1a\n$$\na\\equiv 1\\,\\,\\,(mod\\,\\,m)\n$$\n\u8fd9\u4e2a\u8f6c\u5316\u7684\u6b63\u786e\u6027\u4e5f\u662f\u663e\u7136\u7684\u3002\n\n## \u8d39\u9a6c\u5c0f\u5b9a\u7406\n\n\u8d39\u9a6c\u5c0f\u5b9a\u7406\u4e5f\u975e\u5e38\u7b80\u5355\u5566\uff01\u7528\u8bed\u8a00\u63cf\u8ff0\u5c31\u662f\uff0c\u5982\u679c\u4e00\u4e2a\u6570$p$\u662f\u8d28\u6570\uff0c\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e2a\u4e0d\u4e3a$p$\u7684\u500d\u6570\u7684\u6574\u6570$a$\uff0c\u6709$a^{p-1}\\equiv 1\\,\\,\\,(mod\\,\\,p)$\u3002\u90a3\u4e48\u628a\u8fd9\u4e2a\u7ed3\u8bba\u4e24\u8fb9\u540c\u65f6\u4e58\u4e0a\u4e00\u4e2a$a$\uff0c\u5373\u53ef\u5f97\u51fa\uff1a\u5bf9\u4e8e\u4efb\u610f\u7684\u6574\u6570$a$\uff0c$a$\u7684$p$\u6b21\u5e42\u4e0e$a$\u5728\u6a21$p$\u7684\u610f\u4e49\u4e0a\u540c\u4f59\u3002\n\n\u5373\uff1a\n$$\na^p\\equiv a\\,\\,\\,(mod\\,\\,p)\n$$\n\u8bc1\u660e\u8fc7\u7a0b\u7531\u4e8e\u7b14\u8005\u6c34\u5e73\u6709\u9650\uff0c\u8bf7\u53c2\u9605\u767e\u5ea6\u767e\u79d1\uff1a\n\n\u5f15\u74061\uff0e\n\u3000\u3000\u82e5a,b,c\u4e3a\u4efb\u610f3\u4e2a\u6574\u6570,m\u4e3a\u6b63\u6574\u6570\uff0c\u4e14(m,c)=1\uff0c\u5219\u5f53a\u00b7c\u2261b\u00b7c(mod m)\u65f6\uff0c\u6709a\u2261b(mod m)\u3002\n\u3000\u3000\u8bc1\u660e\uff1aa\u00b7c\u2261b\u00b7c(mod m)\u53ef\u5f97ac\u2013bc\u22610(mod m)\u53ef\u5f97(a-b)\u00b7c\u22610(mod m)\u3002\u56e0\u4e3a(m,c)=1\u5373m,c\u4e92\u8d28\uff0cc\u53ef\u4ee5\u7ea6\u53bb\uff0ca\u2013 b\u22610(mod m)\u53ef\u5f97a\u2261b(mod m)\u3002 [2] \n\n\u5f15\u74062\uff0e\n\u3000\u3000\u8bbem\u662f\u4e00\u4e2a[\u6574\u6570](https://baike.baidu.com/item/\u6574\u6570)\u4e14m>1\uff0cb\u662f\u4e00\u4e2a[\u6574\u6570](https://baike.baidu.com/item/\u6574\u6570)\u4e14(m,b)=1\u3002\u5982\u679ca[1],a[2],a[3],a[4],\u2026a[m]\u662f\u6a21m\u7684\u4e00\u4e2a\u5b8c\u5168\u5269\u4f59\u7cfb\uff0c\u5219b\u00b7a[1],b\u00b7a[2],b\u00b7a[3],b\u00b7a[4],\u2026b\u00b7a[m]\u4e5f\u6784\u6210\u6a21m\u7684\u4e00\u4e2a\u5b8c\u5168\u5269\u4f59\u7cfb\u3002\n\u3000\u3000\u8bc1\u660e:\u82e5\u5b58\u57282\u4e2a\u6574\u6570b\u00b7a[i]\u548cb\u00b7a[j]\u540c\u4f59\u5373b\u00b7a[i]\u2261b\u00b7a[j](mod m)..(i>=1 && j>=1)\uff0c\u6839\u636e\u5f15\u74061\u5219\u6709a[i]\u2261a[j](mod m)\u3002\u6839\u636e\u5b8c\u5168\u5269\u4f59\u7cfb\u7684[\u5b9a\u4e49](https://baike.baidu.com/item/\u5b9a\u4e49)\u53ef\u77e5\u8fd9\u662f\u4e0d\u53ef\u80fd\u7684\uff0c\u56e0\u6b64\u4e0d\u5b58\u57282\u4e2a[\u6574\u6570](https://baike.baidu.com/item/\u6574\u6570)b\u00b7a[i]\u548cb\u00b7a[j]\u540c\u4f59\u3002\n\n\u6240\u4ee5b\u00b7a[1],b\u00b7a[2],b\u00b7a[3],b\u00b7a[4],\u2026b\u00b7a[m]\u6784\u6210\u6a21m\u7684\u4e00\u4e2a\u5b8c\u5168\u5269\u4f59\u7cfb\u3002\n\n\u6784\u9020\u7d20\u6570\n\n![img](https://gss1.bdstatic.com/-vo3dSag_xI4khGkpoWK1HF6hhy/baike/pic/item/f603918fa0ec08faec6557995bee3d6d55fbdaa3.jpg)\n\n \u7684\u5b8c\u5168\n\n![img](https://gss1.bdstatic.com/9vo3dSag_xI4khGkpoWK1HF6hhy/baike/pic/item/9e3df8dcd100baa13c70ba174c10b912c8fc2e3a.jpg)\n\n\u56e0\u4e3a\n\n![img](https://gss1.bdstatic.com/-vo3dSag_xI4khGkpoWK1HF6hhy/baike/pic/item/ac345982b2b7d0a2f13640a3c9ef76094b369a15.jpg)\n\n \uff0c\u7531\u5f15\u74062\u53ef\u5f97\n\n![img](https://gss2.bdstatic.com/-fo3dSag_xI4khGkpoWK1HF6hhy/baike/pic/item/0824ab18972bd4073bdc2e5170899e510fb30906.jpg)\n\n\u4e5f\u662fp\u7684\u4e00\u4e2a\u5b8c\u5168[\u5269\u4f59\u7cfb](https://baike.baidu.com/item/\u5269\u4f59\u7cfb)\u3002\u7531\u5b8c\u5168\u5269\u4f59\u7cfb\u7684\u6027\u8d28\uff0c\n\n![img](https://gss3.bdstatic.com/7Po3dSag_xI4khGkpoWK1HF6hhy/baike/pic/item/83025aafa40f4bfbe4ad63f8084f78f0f7361818.jpg)\n\n\u5373\n\n![img](https://gss1.bdstatic.com/-vo3dSag_xI4khGkpoWK1HF6hhy/baike/pic/item/cc11728b4710b9123dbd0b52c8fdfc039245221a.jpg)\n\n\u6613\u77e5\n\n![img](https://gss0.bdstatic.com/94o3dSag_xI4khGkpoWK1HF6hhy/baike/pic/item/d01373f082025aafdc613df5f9edab64034f1ab8.jpg)\n\n \uff0c\u4e24\u8fb9\u53ef\u7ea6\u53bb \n\n![img](https://gss1.bdstatic.com/9vo3dSag_xI4khGkpoWK1HF6hhy/baike/pic/item/0dd7912397dda144345f911eb9b7d0a20df486cc.jpg)\n\n\u8fd9\u6837\u5c31\u8bc1\u660e\u4e86\u8d39\u9a6c\u5c0f\u5b9a\u7406\u3002\n\n**\uff08\u7ed3\u8bba\u5fc5\u987b\u8981\u8bb0\u4f4f\uff09**\uff1a\n$$\na^p\\equiv a\\,\\,\\,(mod\\,\\,p)\n$$\n\n## \u6b27\u62c9\u5b9a\u7406\n\n\u5728\u5b66\u4e60\u6b27\u62c9\u5b9a\u7406\u4e4b\u524d\uff0c\u9700\u8981\u5148\u5b66\u4e60\u4e00\u4e0b\u6b27\u62c9\u51fd\u6570\u3002\u63a8\u8350\u672c\u849f\u84bb\u7684\u8fd9\u7bc7\u535a\u5ba2\uff1a\n\n[\u6b27\u62c9\u51fd\u6570\u8be6\u89e3]( https://www.cnblogs.com/fusiwei/p/11726768.html )\n\n\u90a3\u4e48\u6709\u4e86\u8fd9\u4e2a\u77e5\u8bc6\u505a\u94fa\u57ab\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u51fa\u6b27\u62c9\u5b9a\u7406\u7684\u5f0f\u5b50\uff1a\n$$\na^{\\phi(p)}\\equiv1\\,\\,\\,(mod\\,\\,p)\n$$\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c$a,p$\u4e3a\u6574\u6570\u4e14$a,p$\u4e92\u8d28\uff0c\u90a3\u4e48$a$\u7684$p$\u7684\u6b27\u62c9\u51fd\u6570\u6b21\u5e42\u4e0e$1$\u5728\u6a21$p$\u610f\u4e49\u4e0b\u540c\u4f59\u3002\n\n\uff08\u4ee5\u4e0b\u8bc1\u660e\u6458\u81ea\u767e\u5ea6\u767e\u79d1\u3002\uff09\n\n### \u8bc1\u660e\n\n\u5c061~n\u4e2d\u4e0en\u4e92\u8d28\u7684\u6570\u6309\u987a\u5e8f\u6392\u5e03\uff1ax1,x2\u2026\u2026x\u03c6(n) \uff08\u663e\u7136\uff0c\u5171\u6709\u03c6(n)\u4e2a\u6570\uff09\n\n\u6211\u4eec\u8003\u8651\u8fd9\u4e48\u4e00\u4e9b\u6570\uff1a\n\nm1=a*x1;m2=a*x2;m3=a*x3\u2026\u2026m\u03c6(n)=a*x\u03c6(n)\n\n1\uff09\u8fd9\u4e9b\u6570\u4e2d\u7684\u4efb\u610f\u4e24\u4e2a\u90fd\u4e0d\u6a21n\u540c\u4f59\uff0c\u56e0\u4e3a\u5982\u679c\u6709mS\u2261mR (mod n) \uff08\u8fd9\u91cc\u5047\u5b9amS\u66f4\u5927\u4e00\u4e9b\uff09\uff0c\u5c31\u6709\uff1a\n\nmS-mR=a(xS-xR)=qn\uff0c\u5373n\u80fd\u6574\u9664a(xS-xR)\u3002\u4f46\u662fa\u4e0en\u4e92\u8d28\uff0ca\u4e0en\u7684\u6700\u5927\u516c\u56e0\u5b50\u662f1\uff0c\u800cxS-xR<n\uff0c\u56e0\u800c\u5de6\u5f0f\u4e0d\u53ef\u80fd\u88abn\u6574\u9664\u3002\u4e5f\u5c31\u662f\u8bf4\u8fd9\u4e9b\u6570\u4e2d\u7684\u4efb\u610f\u4e24\u4e2a\u90fd\u4e0d\u6a21n\u540c\u4f59\uff0c\u03c6(n)\u4e2a\u6570\u6709\u03c6(n)\u79cd\u4f59\u6570\u3002\n\n2\uff09\u8fd9\u4e9b\u6570\u9664n\u7684\u4f59\u6570\u90fd\u4e0en\u4e92\u8d28\uff0c\u56e0\u4e3a\u5982\u679c\u4f59\u6570\u4e0en\u6709\u516c\u56e0\u5b50r\uff0c\u90a3\u4e48a*xi=pn+qr=r(\u2026\u2026)\uff0ca*xi\u4e0en\u4e0d\u4e92\u8d28\uff0c\u800c\u8fd9\u662f\u4e0d\u53ef\u80fd\u7684\u3002(\u56e0\u4e3aa*xi=pn+qr=r(\u2026\u2026)\uff0c\u8bf4\u660ea*xi\u542b\u6709\u56e0\u5b50r\uff0c\u53c8\u56e0\u4e3a\u524d\u9762\u5047\u8bben\u542b\u6709\u56e0\u5b50r\uff0c\u6240\u4ee5a*xi\u548cn\u542b\u6709\u516c\u56e0\u5b50r\uff0c\u56e0\u6b64a*xi\u4e0en\u4e0d\u4e92\u8d28)\u90a3\u4e48\u8fd9\u4e9b\u6570\u9664n\u7684\u4f59\u6570\uff0c\u90fd\u5728x1,x2,x3\u2026\u2026x\u03c6(n)\u4e2d\uff0c\u56e0\u4e3a\u8fd9\u662f1~n\u4e2d\u4e0en\u4e92\u8d28\u7684\u6240\u6709\u6570\uff0c\u800c\u4f59\u6570\u53c8\u5c0f\u4e8en.\n\n\u75311\uff09\u548c2\uff09\u53ef\u77e5\uff0c\u6570m1,m2,m3\u2026\u2026m\u03c6(n)\uff08\u5982\u679c\u5c06\u5176\u6b21\u5e8f\u91cd\u65b0\u6392\u5217\uff09\u5fc5\u987b\u76f8\u5e94\u5730\u540c\u4f59\u4e8ex1,x2,x3\u2026\u2026x\u03c6(n).\n\n\u6545\u5f97\u51fa\uff1am1*m2*m3\u2026\u2026m\u03c6(n)\u2261x1*x2*x3\u2026\u2026x\u03c6(n) (mod n)\n\n\u6216\u8005\u8bf4a^[\u03c6(n)]*(x1*x2*x3\u2026\u2026x\u03c6(n))\u2261x1*x2*x3\u2026\u2026x\u03c6(n)(mod n)\n\n\u6216\u8005\u4e3a\u4e86\u65b9\u4fbf\uff1aK{a^[\u03c6(n)]-1}\u22610 ( mod n ) \u8fd9\u91ccK=x1*x2*x3\u2026\u2026x\u03c6(n)\u3002\n\n\u53ef\u77e5K{a^[\u03c6(n)]-1}\u88abn\u6574\u9664\u3002\u4f46K\u4e2d\u7684\u56e0\u5b50x1,x2\u2026\u2026\u90fd\u4e0en\u4e92\u8d28\uff0c\u6240\u4ee5K\u4e0en\u4e92\u8d28\u3002\u90a3\u4e48a^[\u03c6(n)]-1\u5fc5\u987b\u80fd\u88abn\u6574\u9664\uff0c\u5373a^[\u03c6(n)]-1\u22610 \uff08mod n\uff09\uff0c\u5373a^[\u03c6(n)]\u22611 \uff08mod n\uff09\uff0c\u5f97\u8bc1\u3002\n\n## \u6b27\u62c9\u5b9a\u7406\u7684\u63a8\u8bba\n\n\u6b27\u62c9\u5b9a\u7406\u80fd\u5e72\u4ec0\u4e48\u5462\uff1f\n\n\u6bd4\u5982\uff0c\u7b80\u5316\u5e42\u7684\u6a21\u8fd0\u7b97\u3002\n\n\u4f8b\u9898\uff1a\u8ba1\u7b97$7^{222}$\u7684\u4e2a\u4f4d\u6570\u3002\uff08\u4e5f\u5c31\u662f\u8ba1\u7b97$7^{222}mod\\,\\,10$\uff09\u3002\n\n\u90a3\u4e48\uff0c\u6839\u636e\u6b27\u62c9\u5b9a\u7406\uff0c$a^{\\phi(p)}\\equiv1\\,\\,\\,(mod\\,\\,p)$\uff0c\u6211\u4eec\u53ef\u4ee5\u6709\u4ee5\u4e0b\u7684\u63a8\u5bfc\uff1a\n\n\u9996\u5148\uff0c\u56e0\u4e3a$7,10$\u4e92\u8d28\uff0c\u4e14$\\phi (10)=4$\uff0c\u6240\u4ee5\u6709\uff1a$7^4\\equiv 1\\,\\,\\,(mod\\,\\,10)$\u3002\n\n\u90a3\u4e48\uff0c\u6839\u636e\u53d6\u4f59\u7684\u6027\u8d28\uff0c\u56e0\u4e3a$7^4mod\\,\\,10=1$\uff0c\u6240\u4ee5$7^4$\u7684$n$\u6b21\u5e42\u6a2110\u8fd8\u7b49\u4e8e1.\n\n\u90a3\u4e48\u5c31\u53ef\u4ee5\u6709\uff1a\n\n$7^{222}=7^{4\\times55+2}$\uff0c\u628a1\u5168\u90e8\u7ea6\u53bb\uff0c\u5f97\u5230\uff1a\n\n$7^2\\equiv7^{222}\\,\\,\\,(mod\\,\\,10)$\n\n\u8fd9\u6837\u5c31\u7b80\u5355\u591a\u4e86\u3002\n\n\u6240\u4ee5\u6211\u4eec\u5f97\u51fa\u4e86\u8fd9\u6837\u7684\u4e00\u4e2a\u7ed3\u8bba\uff1a\n$$\na^n\\,\\,mod\\,\\,p=a^{n\\%\\phi(p)}\\,\\,mod\\,\\,p\n$$\n\u4e5f\u5c31\u662f\u8bf4\uff1a\n$$\na^n\\equiv a^{n\\%\\phi(p)}\\,\\,\\,(mod\\,\\,p)\n$$\n\u8fd9\u4e2a\u7ed3\u8bba\u4e5f\u53eb\u505a\uff1a**\u6b27\u62c9\u5b9a\u7406\u7684\u63a8\u8bba**\uff0c\u6781\u5176\u91cd\u8981\u3002\n\n\u5bf9\u4e8e\u7ebf\u6027\u8ba1\u7b97\u7684\u5f0f\u5b50\uff08\u8fd9\u91cc**\u6307\u56db\u5219\u57fa\u672c\u8fd0\u7b97\u4e2d\u9664\u4e86\u9664\u6cd5\u4e4b\u5916\u7684\u4e09\u79cd\u8fd0\u7b97**\uff09\uff0c\u5982\u679c\u8981\u6c42\u6211\u4eec\u5bf9\u4e8e$a+b,a-b,a\\times b$\u7684\u7ed3\u679c\u53d6\u6a21\uff0c\u90a3\u4e48\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u5728\u8fdb\u884c\u8fd0\u7b97\u4e4b\u524d\u5148\u5bf9$a,b$\u53d6\u6a21\uff0c\u5bf9\u7ed3\u679c\u4e0d\u4f1a\u9020\u6210\u4efb\u4f55\u5f71\u54cd\u3002\n\n\u4f46\u662f\u5982\u679c\u8981\u6c42\u6211\u4eec\u5bf9$a^b$\u8fd9\u6837\u7684\u5f0f\u5b50\u53d6\u6a21\u5462\uff1f\n\n\u8fd9\u5c31\u7528\u5230\u4e86\u6b27\u62c9\u5b9a\u7406\u7684\u63a8\u8bba\uff1a\u6211\u4eec\u53ef\u4ee5\u628a\u5e95\u6570\u5bf9$p$\u53d6\u6a21\uff08\u8fd9\u4e2a\u64cd\u4f5c\u7684\u6b63\u786e\u6027\u5c31\u662f\u7531\u524d\u9762\u8bf4\u7684\u56db\u5219\u6df7\u5408\u8fd0\u7b97\u7684\u6b63\u786e\u6027\u63a8\u5bfc\u51fa\u6765\u7684\uff0c\u522b\u5fd8\u4e86\u4e58\u65b9\u8fd0\u7b97\u7684\u5b9e\u8d28\u662f\u4e00\u5806\u8fde\u4e58\uff09\u3002\u6307\u6570\u5bf9$\\phi(p)$\u53d6\u6a21\uff0c\u518d\u8fdb\u884c\u8fd0\u7b97\u5373\u53ef\uff08\u5feb\u901f\u5e42\u8d70\u8d77\uff09\u3002\n\n## \u6c42\u4e58\u6cd5\u9006\u5143\n\n#### \u4e58\u6cd5\u9006\u5143\u7684\u6982\u5ff5\n\n\u5176\u5b9e\u662f\u4e00\u4e2a\u4ecb\u7ecd\u5b9a\u4e49\u7684\u8fc7\u7a0b\uff1a\n\n\u5982\u679c$ax\\equiv1\\,\\,\\,(mod\\,\\,p)$\uff0c\u5e76\u4e14$a,p$\u4e92\u8d28\uff0c\u5219\u79f0$a$\u5173\u4e8e\u6a21$p$\u7684\u4e58\u6cd5\u9006\u5143\u4e3a$x$\u3002\n\n\u8fd8\u662f\u6bd4\u8f83\u5bb9\u6613\u8bb0\u4f4f\u7684\u3002\n\n#### \u4e58\u6cd5\u9006\u5143\u7684\u6c42\u89e3\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff1a\n\n\u5982\u679c\u9700\u8981\u6211\u4eec\u6c42\u89e3$4$\u5173\u4e8e\u6a21$7$\u7684\u4e58\u6cd5\u9006\u5143\u3002\u90a3\u4e48\u4e5f\u5c31\u662f\u8bf4\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u9700\u8981\u53bb\u6c42\u89e3\u7684\u4e58\u6cd5\u9006\u5143$x$\uff0c\u6211\u4eec\u53ea\u9700\u8981\u627e\u5230\u4e00\u4e2a$k$\uff0c\u4f7f\u5f97\u4e0b\u5f0f\u6210\u7acb\uff1a\n$$\n4x=7k+1\n$$\n\uff08\u8fd9\u4e2a\u5f0f\u5b50\u662f\u7531\u4e8e\u4e58\u6cd5\u9006\u5143\u7684\u5b9a\u4e49\uff1a$4x\\equiv 1\\,\\,\\,(mod\\,\\,7)$\u4ee5\u53ca\u540c\u4f59\u7684\u5b9a\u4e49\u5f97\u5230\u7684\uff09\u3002\n\n\u5173\u4e8e\u4e58\u6cd5\u9006\u5143\u7684\u6c42\u89e3\uff0c\u6211\u4eec\u9996\u5148\u8981\u5bf9\u5176\u8fdb\u884c\u5206\u7c7b\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u660e\u767d\u7684\u662f\uff0c\u5bf9\u4e8e$a$\u5173\u4e8e\u6a21$p$\u7684\u4e58\u6cd5\u9006\u5143\u7684\u6c42\u89e3\uff0c\u53ea\u6709\u5728$a,p$\u4e92\u8d28\u7684\u65f6\u5019\u624d\u6709\u89e3\uff0c\u5426\u5219\u5c31\u662f\u65e0\u89e3\u3002\u8fd9\u4e0d\u4ec5\u662f\u5b9a\u4e49\u89c4\u5b9a\u7684\uff0c\u66f4\u662f\u6ee1\u8db3\u5927\u524d\u63d0\u7684\u9996\u8981\u6761\u4ef6\uff08\u5927\u5bb6\u53ea\u9700\u8981\u7262\u7262\u8bb0\u4f4f\u5c31\u597d\uff09\u3002\n\n\u90a3\u4e48\uff0c\u73b0\u5728\uff0c$a,p$\u5df2\u7ecf\u4e92\u8d28\u4e86\u3002\u90a3\u4e48\u53c8\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\u6a21\u6570$p$\u662f\u5426\u4e3a\u7d20\u6570\u3002\n\n**\u5047\u5982$p$\u4e3a\u7d20\u6570\u3002**\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528**\u8d39\u9a6c\u5c0f\u5b9a\u7406**\u6765\u6c42\u89e3\u4e58\u6cd5\u9006\u5143\u3002\n\n\u6839\u636e\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff0c\u6709\uff1a$a^{p-1}\\equiv1\\,\\,\\,(mod\\,\\,p)$\uff0c\u90a3\u4e48\u7ed3\u5408\u4e58\u6cd5\u9006\u5143\u7684\u5b9a\u4e49\uff0c\u5982\u679c$a,p$\u4e92\u8d28\uff0c\u90a3\u4e48\u539f\u5f0f\u53ef\u4ee5\u62c6\u6210$a\\times a^{p-2}\\equiv1\\,\\,\\,(mod\\,\\,p)$\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9\u4e2a\u65f6\u5019\u7684\u4e58\u6cd5\u9006\u5143\u5c31\u662f$a^{p-2}$\u3002\n\n\n\n\u5047\u5982$p$\u4e0d\u662f\u7d20\u6570\uff0c\u5c31\u9700\u8981\u6211\u4eec\u4f7f\u7528**\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u6c42\u89e3**\uff0c\u5bf9\u4e8e\u6269\u5c55GCD\u8fd8\u6709\u4e0d\u660e\u767d\u7684\u5c0f\u4f19\u4f34\uff0c\u8bf7\u79fb\u6b65\u672c\u849f\u84bb\u7684\u8fd9\u7bc7\u535a\u5ba2\uff1a\n\n[\u6d45\u8c08\u6269\u5c55GCD]( https://www.cnblogs.com/fusiwei/p/11775503.html )\n\n\u5bf9\u4e8e\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\uff0c\u6211\u4eec\u77e5\u9053\u5b83\u53ef\u4ee5\u88ab\u7528\u4e8e\u6c42\u89e3\u540c\u4f59\u65b9\u7a0b\u3002\n\n\u90a3\u4e48\u5c31\u548c\u4e58\u6cd5\u9006\u5143\u7684\u6c42\u89e3\u5f88\u5339\u914d\u4e86\uff0c\u56e0\u4e3a\u4e58\u6cd5\u9006\u5143\u7684\u6c42\u89e3\u672c\u8d28\u4e0a\u5c31\u662f\u5728\u6c42\u89e3\u8fd9\u4e48\u4e00\u4e2a\u540c\u4f59\u65b9\u7a0b\uff1a\n$$\nax\\equiv 1\\,\\,\\,(mod\\,\\,p)\n$$\n\u4f46\u662f\uff0c\u6269\u5c55GCD\u89e3\u51b3\u7684\u662f\u5f62\u5982$ax+by=\\gcd(a,b)$\u7684\u4e1c\u897f\uff0c\u548c\u8fd9\u4e2a\u540c\u4f59\u5f0f\u5b50\u6709\u4ec0\u4e48\u5173\u7cfb\u5462\uff1f\n\n\u5982\u679c\u50cf\u6211\u4e00\u5f00\u59cb\u4e00\u6837\u4e0d\u592a\u4f1a\u53d8\u901a\u7684\u8bdd\uff0c\u8bf7\u770b\u4e0b\u9762\u7684\u8bc1\u660e\u8fc7\u7a0b\u3002\n\n\u6700\u88f8\u6700\u88f8\uff0c\u6211\u4eec\u4f1a\u6c42\u89e3\u5f62\u5982\uff1a$ax+by=\\gcd(a,b)$\uff0c\u8fd9\u6837\u7684\u65b9\u7a0b\u3002\n\n\u90a3\u4e48\uff0c\u6211\u4eec\u53ea\u9700\u8981\u628a\u8fd9\u4e2a$ax\\equiv1\\,\\,\\,(mod\\,\\,p)$\u8f6c\u6362\u6210\u8fd9\u6837\u7684\u5f62\u5f0f\u8fdb\u884c\u6c42\u89e3\u5373\u53ef\u3002\n\n\u5047\u8bbe\u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u4e2a\u540c\u4f59\u65b9\u7a0b\u8f6c\u6362\u6210$ax+by=\\gcd(a,b)$\u7684\u5f62\u5f0f\uff0c\u90a3\u4e48\u5f53$a,b$\u4e92\u8d28\u65f6\uff0c$\\gcd(a,b)=1$\uff0c\u54a6\uff1f\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u4e1c\u897f\u548c\u4e58\u6cd5\u9006\u5143\u7684\u5b9a\u4e49\uff1a$a,p$\u4e92\u8d28\u597d\u50cf\u554a\uff01\u90a3\u5c31\u8ba9$b=p$\u5427\uff01\n\n\u90a3\u4e48\uff0c\u6709$ax+by=1$\u3002\n\n\u4e24\u4fa7\u540c\u65f6\u5bf9$b$\u53d6\u6a21\uff08\u56e0\u4e3a\u8fd9\u4e2a\u65f6\u5019$b=p$\u4e86\uff09\uff0c\u6709$ax\\%b+by\\%b=1\\%b=1$\u3002\n\n\u56e0\u4e3a$by\\%b=0$\uff0c\u6240\u4ee5\u539f\u5f0f\u5c31\u53d8\u6210\u4e86\uff1a\n\n$ax\\equiv1\\,\\,\\,(mod\\,\\,p)$\uff0c\u5f97\u8bc1\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u8981\u6c42\u4e00\u4e2a\u6570$a$\u5173\u4e8e$p$\u7684\u4e58\u6cd5\u9006\u5143\uff0c\u76f4\u63a5\u5411\u6269\u5c55GCD\u7b97\u6cd5\u7684\u6a21\u677f\u91cc\u4f20$(a,p,x,y)$\uff0c\u6700\u540e\u7684$x$\u5c31\u662f\u6211\u4eec\u8981\u6c42\u7684\u4e58\u6cd5\u9006\u5143\u3002\n\n\u8fd9\u6837\u7684\u8bdd\u6709\u4e00\u9053~~\u7ecf\u5178\u88f8\u9898~~\u4f8b\u9898\uff1a[NOIP2012\u540c\u4f59\u65b9\u7a0b]( https://www.luogu.com.cn/problem/P1082 )\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5**\u6c42\u51fa\u4e00\u4e2a\u6570\u7684\u4e58\u6cd5\u9006\u5143**\u3002\n\n## \u7ebf\u6027\u6c42\u9006\u5143\n\n\u5176\u5b9e\u6211\u8ba4\u4e3a\uff0c\u524d\u9762\u7684\u201c\u6c42\u4e00\u4e2a\u6570\u7684\u9006\u5143\u201d\u7684\u90e8\u5206\u6700\u7ec8\u8fd8\u662f\u4e3a\u8fd9\u4e2a\u201c\u7ebf\u6027\u6c42\u9006\u5143\u201d\u505a\u94fa\u57ab\uff08\u7406\u8bba\u77e5\u8bc6\u5927\u4e8e\u5929\u561b\uff01\uff09\u3002\u6211\u4eec\u5728\u5b66\u6570\u8bba\u7684\u65f6\u5019\u53ef\u80fd\u90fd\u4f1a\u53d1\u73b0\uff0c\u6211\u4eec\u5728\u63a2\u7a76\u7684\u8fc7\u7a0b\u4e2d\u90fd\u662f\u4e00\u4e2a\u201c\u7531\u5c40\u90e8\u5230\u6574\u4f53\u201d\u7684\u6982\u5ff5\uff1a\u7531\u5224\u65ad\u4e00\u4e2a\u6570\u662f\u5426\u4e3a\u8d28\u6570\u5230\u5224\u65ad\u4e00\u7fa4\u6570\u662f\u5426\u4e3a\u8d28\u6570\uff0c\u7531\u6c42\u4e00\u4e2a\u6570\u7684\u7ea6\u6570\u96c6\u5408\u5230\u7b5b\u9009\u4e00\u7fa4\u6570\u7684\u7ea6\u6570\u96c6......\u540c\u6837\uff0c\u5728\u5b66\u4f1a\u4e86\u6c42\u4e00\u4e2a\u6570\u7684\u9006\u5143\u4e4b\u540e\uff0c\u6211\u4eec\u8981\u5b66\u4e60\u7ebf\u6027\u7b5b\u9006\u5143\u3002\n\n\u6c42\u4e00\u4e2a\u6570\u7684\u9006\u5143\u7684\u590d\u6742\u5ea6\u662f$O(\\log N)$\u7684\u3002\u5982\u679c\u6211\u4eec\u8981\u6c42\u5f88\u591a\u6570\u7684\u9006\u5143\u7684\u65f6\u5019\uff0c\u5982\u65e0\u610f\u5916\u5b83\u7684\u590d\u6742\u5ea6\u4f1a\u662f$O(N\\log N)$\u7684\uff0c\u8fd9\u663e\u7136\u4e0d\u7b26\u5408\u6211\u4eec\u7684\u9700\u6c42\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u8981\u5f00\u53d1\u4e00\u4e2a$O(n)$\u7684\u7ebf\u6027\u6c42\u9006\u5143\u7684\u7b97\u6cd5\u3002\n\n\u7ebf\u6027\u7b5b\u9006\u5143\u5176\u5b9e\u662f\u4e00\u4e2a\u9012\u63a8\u7684\u8fc7\u7a0b\uff0c\u6211\u4eec\u5728\u8fd9\u91cc\u7740\u91cd\u8bb2\u5176\u9012\u63a8\u5f0f\u7684\u5efa\u7acb\u4e0e\u8bc1\u660e\u3002\n\n\u9996\u5148\u6211\u4eec\u6709\uff1a\n$$\n1^{-1}\\equiv 1\\,\\,\\,(mod\\,\\,p)\n$$\n\u6211\u4eec\u628a$p$\u62c6\u5f00\uff0c\u62c6\u6210\u8fd9\u6837\u7684\u5f62\u5f0f\uff1a$p=k\\times m+n$\uff0c\u8fd9\u662f\u53ef\u4ee5\u6210\u7acb\u7684\uff0c\u56e0\u4e3a\u4efb\u610f\u4e00\u4e2a\u6b63\u6574\u6570\u90fd\u53ef\u4ee5\u88ab\u62c6\u6210\u8fd9\u6837\u7684\u5f62\u5f0f\u3002\n\n\u6240\u4ee5\u6211\u4eec\u6709\uff1a\n$$\nk\\times m+n\\equiv 0\\,\\,\\,(mod\\,\\,p)\n$$\n\uff08\u8fd9\u4e2a\u540c\u4f59\u5f0f\u5176\u5b9e\u8868\u793a\u7684\u610f\u4e49\u5c31\u662f\u6574\u9664\uff09\n\n\u90a3\u4e48\uff0c\u4e24\u8fb9\u540c\u65f6\u9664\u4ee5$m,n$\uff08\u5373\u540c\u65f6\u4e58$m^{-1},n^{-1}$\uff09\uff0c\u5219\u6709\n$$\n\\frac{k}{n}+\\frac{1}{m}\\equiv0\\,\\,\\,(mod\\,\\,p)\n$$\n\u79fb\u9879\u6709\uff1a\n$$\n\\frac{1}{m}\\equiv-\\frac{k}{n}\\,\\,\\,(mod\\,\\,p)\n$$\n\u56e0\u4e3a$k$\u5c31\u662f$\\lfloor\\frac{p}{m}\\rfloor$\uff0c$n$\u5c31\u662f$p\\,\\,\\,mod\\,\\,\\,m$\uff0c\u6240\u4ee5\u539f\u5f0f\u5c31\u53d8\u6210\u4e86\uff1a\n$$\nm^{-1}\\equiv-\\lfloor\\frac{p}{m}\\rfloor\\times(p\\,\\,\\,mod\\,\\,\\,m)^{-1}\\,\\,\\,(mod\\,\\,p)\n$$\n\u6839\u636e\u4e58\u6cd5\u9006\u5143\u7684\u5b9a\u4e49\uff0c\u5bf9\u4e8e\u4e00\u5bf9\u4e92\u8d28\u7684\u6570$a,p$\uff0c\u6709\u5b83\u7684\u4e00\u4e2a\u4e58\u6cd5\u9006\u5143$x$\u6ee1\u8db3\uff1a$ax\\equiv1\\,\\,\\,(mod\\,\\,p)$\uff0c\u90a3\u4e48$x\\equiv a^{-1}\\,\\,\\,(mod\\,\\,p)$\uff0c\u90a3\u4e48\uff0c\u6839\u636e\u4e0a\u9762\u7684\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u6211\u4eec\u5c31\u6c42\u51fa\u4e86\u6570$m$\u5173\u4e8e\u6a21$p$\u610f\u4e49\u4e0b\u7684\u9006\u5143\u3002\n\n\u9012\u63a8\u5f0f\u5982\u4e0b\uff08\u7528$inv[i]$\u6570\u7ec4\u8868\u793a\u4e00\u4e2a\u6570\u7684\u9006\u5143\uff09\uff1a\n$$\ninv[i]=-(p/i)\\times inv[p\\%i]\n$$\n\u4e3a\u4e86\u4e0d\u8ba9\u4e58\u6cd5\u9006\u5143\u51fa\u73b0\u4e00\u5806\u8d1f\u6570\uff0c\u6211\u4eec\u9700\u8981\u5bf9\u8fd9\u4e2a\u9012\u63a8\u5f0f\u7a0d\u505a\u5904\u7406\uff1a\n$$\ninv[i]=((p-p/i)*inv[p\\%i])\\%p\n$$\n\u5982\u679c\u80fd\u770b\u660e\u767d\u5e76\u4e14\u8bb0\u4f4f\u8fd9\u4e2a\u8bc1\u660e\u8fc7\u7a0b\u7684\u8bdd\u5f53\u7136\u662f\u6781\u597d\u7684\uff0c\u5982\u679c\u770b\u4e0d\u660e\u767d\uff0c\u76f4\u63a5\u8bb0\u7ed3\u8bba\u4e5f\u662f\u5b8c\u5168\u53ef\u4ee5\u7684\uff0c\u4f46\u662f\uff0c\u8bf7\u505a\u597d\u8003\u573a\u4e0a\u79d2\u5fd8\u81ea\u5df1\u53c8\u4e00\u70b9\u4e0d\u4f1a\u63a8\u7684\u51c6\u5907\uff08\u522b\u602a\u6211\u6ca1\u544a\u8bc9\u4f60\uff09\u3002\n\n---\n\n## \u603b\u7ed3\uff1a\n\n\u8fd9\u7bc7\u603b\u7ed3\u662f\u6211\u8017\u65f6\u5c06\u8fd1\u4e00\u5468\u76d8\u5b8c\u8fd9\u7bc7\u535a\u5ba2\u4e4b\u540e\u7684\u9644\u52a0\u4e4b\u4f5c\n\n\uff08\u672c\u6765\u8ba4\u4e3a\u4e58\u6cd5\u9006\u5143\u8fd9\u4e00\u5757\u4e00\u5929\u5c31\u80fd\u5b66\u5b8c\uff0c\u4f46\u662f\u6211\u597d\u50cf\u9ad8\u4f30\u4e86\u81ea\u5df1\u7684\u80fd\u529b\u3001\u4f4e\u4f30\u4e86\u6570\u5b66\u7684\u9b45\u529b\uff08\u5475\u5475\uff09\uff0c\u52a0\u4e4b\u5feb\u671f\u672b\u4e86\uff0c\u5404\u79cd\u6587\u5316\u8bfe\u4ee5\u53ca\u4e2a\u4eba\u70c2\u4e8b\u5c42\u51fa\u4e0d\u7a77\uff0c\u5bfc\u81f4\u66f4\u535a\u548c\u5de9\u56fa\u7684\u901f\u5ea6\u90fd\u6781\u4e3a\u5730\u7f13\u6162\uff09\u3002\n\n\u672c\u6765\u4ee5\u4e3a\u5b66\u5b8c\u4e86\u5e94\u8be5\u5c31\u4f1a\u4e86\uff0c\u4f46\u662f\u5728\u5b66\u6700\u540e\u7684\u7ebf\u6027\u6c42\u9006\u5143\u7684\u8fc7\u7a0b\u4e2d\u60ca\u559c\u5730\u53d1\u73b0\u524d\u9762\u7684\u4e1c\u897f\u5927\u591a\u53c8\u4e0d\u4f1a\u4e86\uff08\u7ed3\u8bba\u4e5f\u5c31\u5dee\u4e0d\u591a\u8bb0\u4f4f\uff0c\u81f3\u4e8e\u63a8\u5bfc\u8fc7\u7a0b\u5c31\u5168\u90e8\u5fd8\u5149\u5149\u4e86\uff09\uff0c\u4e8e\u662f\u624d\u771f\u6b63\u9886\u7565\u4e86\u4ec0\u4e48\u662f\u6570\u8bba\uff0c\u4ee5\u53ca\u4e3a\u4f55\u6570\u8bba\u8fd9\u4e00\u5757\u8ba9\u4e00\u4e9b\u6570\u7ade\u5927\u4f6c\u90fd\u7531\u8877\u5730\u611f\u89c9\u56f0\u96be\u3002\u4e8e\u662f\u53c8\u5239\u4e0b\u5fc3\u6765\u91cd\u65b0\u770b\u4e86\u4e00\u4e0b\uff0c\u987a\u4fbf\u5f52\u7eb3\u51fa\u6765\u4e86\u4e00\u4e9b\u91cd\u70b9\uff0c\u8fd9\u6837\u7684\u8bdd\uff0c\u6bcf\u6b21\u590d\u4e60\u7684\u65f6\u5019\u5c31\u4e0d\u7528\u901a\u7bc7\u6d4f\u89c8\uff0c\u53ea\u6838\u5bf9\u8fd9\u4e9b\u91cd\u8981\u7684\u77e5\u8bc6\u70b9\u5230\u5e95\u4f1a\u4e0d\u4f1a\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u90a3\u4e48\uff0c**\u5b66\u5b8c\u8fd9\u4e00\u8bfe\uff0c\u4f60\u9700\u8981\u4f1a\u7684\u2014\u2014**\n\n### 1\u3001\u540c\u4f59\u7684\u57fa\u672c\u6982\u5ff5\n\n\u4f60\u603b\u4e0d\u80fd\u5bf9\u522b\u4eba\u8bb2\uff0c\u6211\u5b66\u5b8c\u540c\u4f59\u4e86\uff0c\u4f46\u662f\u8fde\u5f0f\u5b50\u4e5f\u770b\u4e0d\u61c2...\n\n### 2\u3001\u8d39\u9a6c\u5c0f\u5b9a\u7406\n\n\u7ed3\u8bba\uff1a\n$$\na^{p-1}\\equiv 1\\,\\,\\,(mod\\,\\,p)\n$$\n\u5373\uff1a\n$$\na^p\\equiv a\\,\\,\\,(mod\\,\\,p)\n$$\n\u8fd9\u4e2a**\u5b9a\u7406\u7684\u9002\u7528\u6761\u4ef6**\u4e00\u5b9a\u8981\u8bb0\u4f4f\uff1a$p$\u4e3a\u8d28\u6570\uff0c\u5e76\u4e14$a$\u4e0d\u4e3a$p$\u7684\u500d\u6570\u3002\n\n### 3\u3001\u6b27\u62c9\u5b9a\u7406\n\n\u7ed3\u8bba\uff1a\n$$\na^{\\phi(p)}\\equiv 1\\,\\,\\,(mod\\,\\,p)\n$$\n\u5b83\u7684**\u9002\u7528\u6761\u4ef6**\u662f\uff1a$a,p$\u4e92\u8d28\u3002\n\n\u63a8\u8bba\uff1a\n$$\na^{n}\\equiv a^{n\\%\\phi(p)}\\,\\,\\,(mod\\,\\,p)\n$$\n\u5f53\u7136\uff0c\u8fd9\u4e2a\u5b9a\u7406\u4e0d\u662f\u4f9b\u4eba\u663e\u6446\u7528\u7684\uff0c\u77e5\u9053\u4e86\uff0c\u8fd8\u5f97\u4f1a\u7528\uff1a\n\n\u6b27\u62c9\u5b9a\u7406\u7684\u63a8\u8bba\u53ef\u4ee5\u7528\u6765\u89e3\u51b3\u5f62\u5982\u8fd9\u6837\u7684\u5f0f\u5b50\u7684\u6c42\u89e3\u7684\u95ee\u9898\uff1a\n$$\na^n\\,\\,\\,mod\\,\\,p\n$$\n\n### 4\u3001\u4e58\u6cd5\u9006\u5143\u7684\u6982\u5ff5\n\n### 5\u3001\u6c42\u5355\u4e2a\u6570\u7684\u4e58\u6cd5\u9006\u5143\u7684\u4e24\u79cd\u65b9\u5f0f\n\n\u77e5\u9053\u6c42\u5355\u4e2a\u6570\u7684\u4e58\u6cd5\u9006\u5143\u7684\u4e24\u79cd\u65b9\u5f0f\u53ca\u5176\u4f7f\u7528\u6761\u4ef6\uff1a\n\n\u5bf9\u4e8e\u6c42$ax\\equiv 1\\,\\,\\,(mod\\,\\,p)$\u4e2d\u7684$x$\uff0c\uff08\u5927\u524d\u63d0\u5f53\u7136\u662f$a,p$\u4e92\u8d28\uff09\u5982\u679c\uff1a\n\n**$p$\u4e3a\u8d28\u6570**\uff0c\u90a3\u4e48\u53ef\u4ee5\u4f7f\u7528\u8d39\u9a6c\u5c0f\u5b9a\u7406\u3002\n\n**$p$\u4e0d\u4e3a\u8d28\u6570**\uff0c\u90a3\u4e48\u9700\u8981\u4f7f\u7528\u6269\u5c55GCD\u5c06\u540c\u4f59\u5f0f\u8f6c\u6362\u6210\u5f62\u5982$ax+by=\\gcd(a,b)$\u7684\u540c\u4f59\u65b9\u7a0b\u6765\u6c42\u89e3\u3002\n\n### 6\u3001\u7ebf\u6027\u7b5b\u9006\u5143\n\n\u7ed3\u8bba\uff08\u9012\u63a8\u5f0f\uff09\uff1a\n$$\ninv[i]=((p-p/i)\\times inv[p\\%i])\\%p\n$$\n\n---\n\n\u90a3\u4e48\u4ee3\u7801\uff1a\n```cpp\n#include<cstdio>\n#define int long long\nusing namespace std;\nconst int maxn=3*1e6+10;\nint n,p;\nint inv[maxn];\nsigned main()\n{\n    scanf(\"%lld%lld\",&n,&p);\n    inv[1]=1;\n    printf(\"1\\n\");\n    for(int i=2;i<=n;i++)\n    {\n        inv[i]=((p-p/i)*inv[p%i])%p;\n        printf(\"%lld\\n\",inv[i]);\n    }\n    return 0;\n}\n```",
        "postTime": 1576496015,
        "uid": 175131,
        "name": "\u5085\u601d\u7ef4666",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "**\u4f20\u8bf4\u8d39\u9a6c\u5c0f\u5b9a\u7406\u4f1aTLE\u6389\u8fd9\u9053\u9898,\u6240\u4ee5\u6211\u8003\u8651\u4f18\u5316\u4e86\u4e00\u53d1,\u8fd9\u7c7b\u4f3c\u4e8e\u7b5b\u8d28\u6570\u7684\u601d\u8def?**\n\n**\u4f17\u6240\u5468\u77e5,\u7528\u8d39\u9a6c\u5c0f\u5b9a\u7406\u6c42\u4e00\u4e2a\u6570\u7684\u9006\u5143\u590d\u6742\u5ea6\u662fO(log p)\u7684,\u4f46\u662f\u5982\u679c\u6211\u4eec\u77e5\u9053inv[i],inv[j]\u6211\u4eec\u53ef\u4ee5\u7528O(1)\u7684\u590d\u6742\u5ea6\u8ba1\u7b97\u51fa\u6765inv[i*j],\u6240\u4ee5\u6211\u7528\u4e86\u4e00\u4e2a\u5947\u602a\u7684\u7b5b,O(\u7384\u5b66)\u7684a\u4e86\u8fd9\u9053\u9898,\u6211\u4e5f\u4e0d\u77e5\u9053\u590d\u6742\u5ea6\u662f\u591a\u5c11,\u5927\u6982\u5bf9\u4e8e,\u6bcf\u4e2a\u8d28\u6570\u662fO(logp),\u5bf9\u4e8e\u5408\u6570\u662f\u8fd1\u4f3cO(1)\u7684.\u53ef\u4ee5\u518d\u53bb\u6389\u4e00\u4e9b\u91cd\u590d,\u4f46\u6211\u61d2\u5f97\u5199\u4e86**\n\n**\u4ee3\u7801\u5982\u4e0b**\n\n```cpp\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nlong long inv[3000010],n,p,vis[3000010];\n\nlong long kasumi(long long a,long long b)\n{\n\tlong long ans=1;\n\twhile(b)\n\t{\n\t\tif(b&1)\n\t\t{\n\t\t\tans=ans*a%p;\n\t\t}\n\t\ta=a*a%p;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\n\nvoid get()\n{\n\tvis[1]=1;\n\tinv[1]=1;\n\tfor(int i=2; i<=n; i++)\n\t{\n\t\tif(!vis[i])\n\t\t{\n\t\t\tvis[i]=1;\n\t\t\tinv[i]=kasumi(i,p-2);\n\t\t\tfor(int j=2; j<=i&&j*i<=n; j++)\n\t\t\t{\n\t\t\t\tvis[i*j]=1;\n\t\t\t\tinv[i*j]=(inv[i]*inv[j])%p;\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main()\n{\n\tscanf(\"%lld%lld\",&n,&p);\n\tget();\n\tfor(int i=1; i<=n; i++)\n\t{\n\t\tprintf(\"%lld\\n\",inv[i]);\n\t}\n}\n```",
        "postTime": 1521113899,
        "uid": 48740,
        "name": "Styx",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "O(nlogn)\u80fd\u8fc7\u8fd9\u9053\u9898\u3002\n\n\u5f88\u795e\u5947\u5427\u3002\u3002\u3002\n\n\u8fd9\u91cc\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u6bd4\u5feb\u901f\u5e42\u8dd1\u5f97\u5feb\uff0c\u5feb\u901f\u5e42\u8fc7\u4e0d\u4e86\u3002\n\ncode\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\nusing namespace std;\nint l,m,n,s,p;\nvoid exgcd(int a,int b,int &x,int &y)\n{\n\tif (!b)\n\t{\n\t\tx=1;\n\t\ty=0;\n\t\treturn ;\n\t}\n\texgcd(b,a%b,x,y);\n\tint z=x;\n\tx=y;\n\ty=z-a/b*y;\n}\nint main()\n{\n\tregister int a,b,x,y;\n\tcin>>n>>p;\n\tfor (a=1;a<=n;++a)\n\t{\n\t\texgcd(a,p,x,y);\n\t\tcout<< (x%p+p)%p;\n\t\tputchar('\\n');\n\t}\n\treturn 0;\n}\n```\n\n2020.11.8\u66f4\u65b0\uff1a\n\u6709\u4e0d\u5c11\u4eba\u5728\u8bc4\u8bba\u533a\u8bf4exgcd\u8fc7\u4e0d\u4e86\uff0c\u7279\u6b64\u5361\u5e38\u3002\n```\n#include<cstdio>\ninline void exgcd(int a, int b, int &x, int &y)\n{\n\tif (b)\n\t{\n\t\texgcd(b, a % b, y, x);\n\t\ty = y- a / b * x;\n\t}\n\telse \n\t{\n\t\tx = 1;\n\t\ty = 0;\n\t}\n}\ninline void out(int &x)\n{\n\tregister int f[16],i=0;\n\twhile (x>0)\n\t{\n\t\t++i;\n\t\tf[i]=x%10+'0';\n\t\tx=x/10;\n\t}\n\twhile (i>0)\n\t{\n\t\tstd::putchar(f[i]);\n\t\t--i;\n\t}\n\tstd::putchar('\\n');\n}\ninline int reads()\n{\n\tregister int a=getchar(),b=0;\n\twhile (a>'9' || a<'0')\n\t\ta=std::getchar();\n\twhile (a>='0' && a<='9')\n\t{\n\t\tb=b*10+a-'0';\n\t\ta=std::getchar();\n\t}\n\treturn b;\n}\nint main()\n{\n\tregister int a,b,x,y;\n\tconst int n=reads();\n\tconst int p=reads();\n\tfor (a=1; a<=n; ++a)\n\t{\n\t\texgcd(a,p,x,y);\n\t \twhile (x>p)\n\t\t\tx=x-p;\n\t\twhile (x<0)\n\t\t\tx=x+p;\n\t\tout(x);\n\t}\n\treturn 0;\n}\n```\n\u672a\u5f00O2\uff0c\u6700\u540e\u4e00\u4e2a\u70b9\u7528\u65f6497ms\u3002\n![\u63d0\u4ea4\u8bb0\u5f55](https://cdn.luogu.com.cn/upload/image_hosting/9g1l4a6f.png)",
        "postTime": 1533889113,
        "uid": 38353,
        "name": "CYSCYS",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "###\u4e58\u6cd5\u9006\u5143###\n\n**\u601d\u8def\uff1a**\n\n\u6c42\u9006\u5143\u7684\u7ebf\u6027\u7b97\u6cd5\uff0c\u5177\u4f53\u8fc7\u7a0b\u5982\u4e0b\u3002\n\n\u9996\u5148\uff0c1-1\u22611(mod p)\u3002\n\n\u7136\u540e\uff0c\u6211\u4eec\u8bbep=k\\*i+r\uff0cr<i,1<i<p\uff0c\u518d\u5c06\u8fd9\u4e2a\u5f0f\u5b50\u653e\u5230mod p\u610f\u4e49\u4e0b\u5c31\u4f1a\u5f97\u5230\uff1ak\\*i+r\u22610(mod p)\n\n\u518d\u4e24\u8fb9\u540c\u65f6\u4e58\u4e0ai-1\u3001r-1\u5c31\u4f1a\u5f97\u5230\uff1a\n\nk\\*r-1+i-1\u22610(mod p)     -->   i-1\u2261-k\\*r-1(mod p)    -->    i-1\u2261-[p/i]\\*(p mod i)-1 (mod p)\n\n\u4e8e\u662f\uff0c\u5c31\u53ef\u4ee5\u4ece\u524d\u9762\u63a8\u51fa\u5f53\u524d\u7684\u9006\u5143\u3002\u4ee3\u7801\u4e5f\u5c31\u4e00\u884c\uff1a**a[i]=-(p/i)\\*a[p%i];**\n\n\u7136\u540e\u8fd9\u9053\u6a21\u677f\u9898\uff0c\u4fbf\u53ef\u4ee5\u7528\u4e0a\u8ff0\u65b9\u6cd5\u89e3\u51b3\u7684\u3002\u3002\n\n**\u4ee3\u7801\uff1a**\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define il inline\n#define inf 233333333333\nll n,p,a[3000600],b;\nint main()\n{\n    scanf(\"%lld%lld\",&n,&p);\n    a[1]=1;\n    for(int i=2;i<=n;i++){\n    a[i]=-(p/i)*a[p%i];\n    while(a[i]<0)a[i]+=p;\n    printf(\"%lld\\n\",a[i-1]);\n    }\n    printf(\"%lld\\n\",a[n]);\n    return 0;\n}\n```",
        "postTime": 1510036703,
        "uid": 44000,
        "name": "\u6d45\u8272\u8c03",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "# \u9006\u5143\n\n\u7531\u4e8e$(a/b)$\n$mod$\n$p\u2260(a$\n$mod$\n$p)/(b$\n$mod$\n$p)$\n$mod$\n$p$\n\n\u90a3\u4e48\u600e\u4e48\u529e\u5462\uff1f\n\n\u5c0f\u5b66\u6570\u5b66\u90fd\u5e94\u8be5\u5b66\u8fc7\u5012\u6570\u5427\n\n$x$\u7684\u5012\u6570\u662f$\\frac{1}{x}$\n\n$x\\times\\frac{1}{x}=1$\n\n\u90a3\u4e48$\\frac{1}{x}$\u5c31\u662f\u4e00\u4e2a\u4e58\u4e86\u5b83\u4e4b\u540e\u80fd\u53d8\u6210$1$\u7684\u6570\n\n\u5728\u6570\u8bba\u4e2d\u6709\u8fd9\u4e2a\u795e\u5947\u7684\u6570\u5417\uff1f\n\n\u8fd8\u771f\u6709\n\n\u5982\u679c$p$\u662f\u8d28\u6570\n\n\u90a3\u4e48\u89c4\u5b9a$inv(x,p)$\u4e3a$x$\u5173\u4e8e$p$\u7684\u9006\u5143\n\n\uff08\u4ee5\u540e\u5c31\u4e0d\u7528\u5199\u7b2c\u4e8c\u7ef4\u5566\uff0c\u9ed8\u8ba4\u4e3a$p$\uff09\n\n\u90a3\u4e48\u6709$x\\times inv(x)\\equiv1(mod$\n$p)$\n\n\u90a3\u4e48\u5c31\u53ef\u4ee5\u6109\u5feb\u5730\u8f6c\u5316\u4e86\n\n$(a/b)$\n$mod$\n$p=a\\times inv(b)$\n$mod$\n$p=(a$\n$mod$\n$p)\\times(inv(b)$\n$mod$\n$p)$\n$mod$\n$p$\n\n\u5988\u5988\u518d\u4e5f\u4e0d\u7528\u62c5\u5fc3\u6ca1\u6709\u9664\u6cd5\u540c\u4f59\u5b9a\u7406\u4e86\n\n- \u53ea\u6709$a,p$\u4e92\u8d28\u65f6\u6709$inv(a,p)$\n\n\n------------\n\n\u9006\u5143\u600e\u4e48\u6c42\uff1f\n\n\n#### $1$. ~~\u66b4\u529b~~ \u679a\u4e3e\n\n\u679a\u4e3e$1$~$n-1$\u6bcf\u4e2a\u6570\u770b\u770b\u6ee1\u4e0d\u6ee1\u8db3$(i\\times n)mod$ \n$p=1$\n\n\u590d\u6742\u5ea6\u70b8\u6389$O(n)$\n\n~~\u4f3c\u4e4e\u5e76\u6ca1\u6709\u4ec0\u4e48\u7528~~\n\n\n------------\n\n\n#### $2$.\u8d39\u9a6c\u5c0f\u5b9a\u7406\n\n- $a^{p-1} \u22611 (mod $\n$p)$\n\n- \u4e24\u8fb9\u540c\u9664\u4ee5$a$\n\n- $a^{p-2} \u22611/a (mod $\n$p) $\n\n- \u5e94\u8be5\u5199$a^{p-2} \u2261 inv(a) (mod $\n$p)$\n\n\u6240\u4ee5$inv(a) = a^{p-2} (mod$\n$p)$\n\n\u8fd9\u4e2a\u7528\u5feb\u901f\u5e42\u6c42\u4e00\u4e0b\uff0c\u590d\u6742\u5ea6$O(logn)$\n\n\n------------\n#### $3$.\u6269\u5c55\u6b27\u51e0\u91cc\u5fb7\u7b97\u6cd5\n\n\u5f53$a,b$\u4e92\u8d28\u65f6$gcd(a,b)=1$\n\n\u5219$a\\times x + b\\times y = 1$\n\n\u8fd9\u4e2a\u89e3\u7684$x$\u5c31\u662f$a$\u5173\u4e8e$b$\u7684\u9006\u5143\n\n$y$\u5c31\u662f$b$\u5173\u4e8e$a$\u7684\u9006\u5143\n\n\u4e3a\u4ec0\u4e48\u5462\uff1f\n\n\u4f60\u770b\uff0c\u4e24\u8fb9\u540c\u65f6\u6c42\u4f59$b$\n\u00a0\n \n$(a\\times x)$\n$mod$\n$b+(b\\times y)$\n$mod$\n$b=1$\n$mod$\n$b$\n\n$(a\\times x)$ \n$mod$\n$b = 1 $\n$mod$\n$b$\n\n$a\\times x = 1 (mod $\n$b)$\n\u00a0\n\n\u4f60\u770b\u4f60\u770b\uff0c\u51fa\u73b0\u4e86\uff01\uff01\uff01(/\u2265\u25bd\u2264/)\n\n\u6240\u4ee5$x$\u662f$a$\u5173\u4e8e$b$\u7684\u9006\u5143\n\n\u53cd\u4e4b\u53ef\u8bc1\u660e$y$\n\n\n------------\n#### 4.\u7ebf\u6027\u6c42\u9006\u5143\n\n\u5f53$p$\u662f\u4e2a\u8d28\u6570\u7684\u65f6\u5019\u6709$inv(a) = (p - p / a) \\times inv(p $\n$mod$\n$a) $\n$mod$\n$p$\n\n\u8fd9\u4e3a\u5565\u662f\u5bf9\u7684\u54a9\uff1f\n\n\u8bc1\u660e\u4e0d\u60f3\u770b\u7684\u5b69\u5b50\u53ef\u4ee5\u8df3\u8fc7\u3002\u3002\u3002\uff08\uffe30 \uffe3\uff09\n\n\n------------\n\n\u8bc1\u660e\uff1a\n\n\u8bbe$x = p $\n$mod$\n$a,y = p / a$\n\n\u4e8e\u662f\u6709 $x + y \\times a = p$\n\n$(x + y \\times a) $\n$mod$\n$p = 0$\n\n\u79fb\u9879\u5f97 $x $\n$mod$\n$p = (-y) \\times a $\n$mod$\n$p$\n\n$x \\times inv(a) $\n$mod$\n$p = (-y) $\n$mod$\n$p$\n\n$inv(a) = (p - y) \\times inv(x) $\n$mod$\n$p$\n\n\u4e8e\u662f $inv(a) = (p - p / a) * inv(p $\n$mod$\n$a) $\n$mod$\n$p$\n\n\n------------\n\n- \u8fd9\u4e2a\u65b9\u6cd5\u4e0d\u9650\u4e8e\u6c42\u5355\u4e2a\u9006\u5143\uff0c\u6bd4\u524d\u4e24\u4e2a\u597d\uff0c\u5b83\u53ef\u4ee5\u5728$O(n)$\u7684\u590d\u6742\u5ea6\u5185\u7b97\u51fan\u4e2a\u6570\u7684\u9006\u5143\n\n- \u9012\u63a8\u8fd9\u4e48\u5199\n\n\n\n```cpp\ninline void init()\n{\n    inv[1]=1;\n    for(re int i=2;i<=n;i++)\n        inv[i]=(p-p/i)*inv[p%i]%p;\n    return;\n}\n```\n\n\n------------\n\u6574\u4f53\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n#include<map>\n#include<vector>\n#include<stack>\n#include<queue>\n#define N 3001001\n#define MAX 2001\n#define re register\nusing namespace std;\ntypedef long long ll;\ntypedef double db;\ninline void read(re ll &ret)\n{\n    ret=0;re char c=getchar();re bool pd=false;\n    while(!isdigit(c)){pd|=c=='-';c=getchar();}\n    while(isdigit(c)){ret=(ret<<1)+(ret<<3)+(c&15);c=getchar();}\n    ret=pd?-ret:ret;\n    return;\n}\nll n,p,inv[N];\ninline void init()\n{\n    inv[1]=1;\n    printf(\"1\\n\");\n    for(re int i=2;i<=n;i++)\n    {\n        inv[i]=(p-p/i)*inv[p%i]%p;\n        printf(\"%lld\\n\",inv[i]);\n    }\n    return;\n}\nmain()\n{\n    read(n);\n    read(p);\n    init();\n\texit(0);\n} \n```\n\n",
        "postTime": 1576290355,
        "uid": 176990,
        "name": "Celtic",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "\n   \n\n\n    \nx\u7684\u9006\u5143\u5728\u6a21\u8d28\u6570\uff081--p-1\uff09\u4e2d\u53ea\u6709\u4e00\u4e2a\n\u6c42\u9006\u5143\u65b9\u6cd5\u6709\u56db\n \n\n 1. \n\n![](https://img-blog.csdnimg.cn/20190730103511892.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xvbmVseV9waW5uYQ==,size_16,color_FFFFFF,t_70)\n \uff08\u6765\u6e90\u4e8e\u962e\u884c\u6b62\u8001\u5e08\u8bfe\u4e0a\u7684PPT\uff09\n\n 2. \u7ebf\u6027\u9012\u63a8\n\n ![](https://img-blog.csdnimg.cn/20190801173548165.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xvbmVseV9waW5uYQ==,size_16,color_FFFFFF,t_70)\n \uff08\u6765\u6e90\u4e8e\u4f55\u6559\u7ec3\u8bfe\u4e0a\u7684PPT\uff09\n\u7136\u540e \u5de6\u5f0f\u518d\u52a0\u4e0aP \uff0c\u4ee5\u9632\u8d1f\u6570\uff0c\u800c\u4e14\u7ed3\u679c\u4e0d\u53d8\n\n3. \u9636\u4e58\n![](https://img-blog.csdnimg.cn/20190801211759970.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xvbmVseV9waW5uYQ==,size_16,color_FFFFFF,t_70)\n 4. \u6269\u6b27\uff1an*inv(n)=1(mod p)\n n*inv(n)+p*k=1\n \u628ainv(n)\u548ck\u770b\u6210x,y\u7528\u6269\u6b27\u89e3\u51fainv(n)\n \n\u4ee5**luoguP3811**\u4e3a\u4f8b\n\u6211\u6309\u56db\u4e2a\u65b9\u6cd5\u90fd\u5199\u4e86\u4ee3\u7801\uff0c\u4f46\u53ea\u6709\u7ebf\u6027\u9012\u63a8\u4e0dTLE\n1\u3001\n```\n#include <iostream>\nusing namespace std;\nint modd;\nint quickpow(int a,int b)\n{\n\tint ans=1;\n\twhile(b)\n\t{\n\t\tif(b&1)ans*=a%modd;\n\t\ta*=a%modd;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\nint main()\n{\n\tint n,p;\n\tcin>>n>>p;\n\tmodd=p;\n\tfor(register int i=1;i<=n;i++)\n\t\tcout<<quickpow(i,p-2)%modd<<endl;\n}\n```\n2\u3001\n\n```\n#include <cstdio>\nusing namespace std;\nint inv[5000000]={0,1};\nint main()\n{\n\tprintf(\"%d\\n\",1);\n\tint n,p; \n\tscanf(\"%d\",&n,&p);\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tinv[i]=p-(p/i)*inv[p%i]%p;\n\t\tprintf(\"%d\\n\",inv[i]);\n\t}\n\treturn 0;\n}\n```\n\n3\u3001\n\n```\n#include <cstdio>\n#define ll long long\nusing namespace std;\nll inv[5000000],f[5000000]={1,1},modd;\nll quickpow(ll a,ll b)\n{\n\tll ans=1;\n\twhile(b)\n\t{\n\t\tif(b&1)ans=ans*a%modd;\n\t\tb>>=1;\n\t\ta=a*a%modd;\n\t}\n\treturn ans%modd;\n}\nint main()\n{\n\tll n,p;\n\tscanf(\"%lld%lld\",&n,&p);\n\tmodd=p;\n\tfor(int i=2;i<=n;i++)\n\tf[i]=(f[i-1]*i)%modd;\n\tinv[n]=quickpow(f[n],p-2);//\u5148\u8d39\u5c0f+\u5feb\u901f\u5e42\u6c42inv[n]\n\t//inv[n]\u4ee3\u8868n\u7684\u9636\u4e58\u7684\u9006\u5143\n\tfor(int i=n-1;i>=1;i--)\n\tinv[i]=(inv[i+1]*(i+1))%modd;//\u6ce8\u610f\uff0cinv[!i] =inv[!(i+1)]*(i+1),\u662f\u628a(i+1)\u7684-1\u6b21\u65b9\u518d\u4e58\u4e0ai+1,\u62b5\u6d88\u4e3a1\uff0c\u5269\u4f59\u7684\u90e8\u5206\u4e3ainv[!i]\n\tfor(int i=1;i<=n;i++)\n\t  printf(\"%lld\\n\",(inv[i]*f[i-1]+modd)%modd);\n\treturn 0;\n}\n```\n\n4\u3001\n```\n#include <iostream>\n#include <algorithm>\n#define pr pair<int,int>\n#define x tmp.first\n#define y tmp.second\nusing namespace std;\nint gcd(int a,int b)\n{\n\treturn b?gcd(b,a%b):a;\n}\npr exgcd(int a,int b)\n{\n\tif(!b)return pr(1,0);\n\tpr tmp = exgcd(b,a%b);\n\treturn pr(y,x-a/b*y);\n}\nint main()\n{\n\tint n,p;\n\tcin>>n>>p;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tpr tmp = exgcd(i,p);\n\t\tcout<<(x+p)%p<<endl;\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1564711432,
        "uid": 116162,
        "name": "\u7fbd\u5107",
        "ccfLevel": 3,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "[P3811 \u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143](https://www.luogu.org/problemnew/show/P3811)\n\n\u4e00\u4e2a\u521a\u5b66\u6570\u8bba\u7684\u840c\u65b0\uff0c\u603b\u7ed3\u4e86\u4e00\u4e0b\u8fd9\u9898\u7684\u5927\u90e8\u5206\u505a\u6cd5\n\n```cpp\n//\u4e00\u3001\u8d39\u9a6c\u5c0f\u5b9a\u7406+\u5feb\u901f\u5e42  O(nlogn) 64\u5206\n#include<cstdio>\nusing namespace std;\ntypedef long long ll;\nint a,b;\ninline ll pow(ll x,ll p) {\n    ll ans=1;\n    x%=b;\n    while(p) {\n        if (p&1) ans=ans*x%b;\n        x=x*x%b;\n        p>>=1;\n    }\n    return ans%b;\n}\ninline void write(int x) {\n    if(x>9) write(x/10);\n    putchar(x%10^48);\n}\nint main() {\n    scanf(\"%d%d\",&a,&b);\n    for (int i=1; i<=a; i++) {\n        write(pow(i,b-2));\n        putchar('\\n');\n    }\n}\n```\n\n```cpp\n//\u4e8c\u3001exgcd O(nlogn)  80\u5206\n\n#include<cstdio>\nusing namespace std;\ntypedef int ll;\nll x,y,a,b;\ninline void exgcd(ll a,ll b) {\n    if (!b) x=1,y=0;\n    else {exgcd(b,a%b); int t=x; x=y,y=t-a/b*y;}\n}\ninline void write(int x){\n    if(x>9) write(x/10);\n    putchar(x%10^48);\n}\nint main() {\n    scanf(\"%d%d\",&a,&b);\n    for (int i=1; i<=a; i++) {\n        exgcd(i,b);\n        write((x%b+b)%b);\n        putchar('\\n');\n    }\n}\n```\n\n```cpp\n//\u4e09\u3001\u8d39\u9a6c\u5c0f\u5b9a\u7406+\u5feb\u901f\u5e42+\u7ebf\u6027\u7b5b \u5408\u6570O(1)\uff0c\u8d28\u6570O(nlogn) 80\u5206\n#include <cstdio>\nusing namespace std;\ntypedef long long ll;\nll n,p,inv[3000010],vis[3000010];\nll pow(ll x,int b) {\n    ll ans=1;\n    for (int i=b; i; i>>=1,x=x*x%p)\n        if (i&1) ans=ans*x%p;\n    return ans%p;\n}\nvoid work() {\n    inv[1]=vis[1]=1;\n    for (int i=2; i<=n; i++)\n        if (!vis[i]) {\n            vis[i]=1;\n            inv[i]=pow(i,p-2);\n            for (int j=2; j<=i && j*i<=n; j++)\n                vis[i*j]=1,inv[i*j]=(inv[i]*inv[j])%p;\n        }\n}\nint main() {\n    scanf(\"%lld%lld\",&n,&p);\n    work();\n    for (int i=1; i<=n; i++) printf(\"%lld\\n\",inv[i]);\n    return 0;\n}\n```\n\n```cpp\n//\u56db\u3001\u9636\u4e58+1\u6b21\u5feb\u901f\u5e42 O(n) 100\u5206 607ms\n\n#include<cstdio>\n#define ll long long\nusing namespace std;\nint n,p;\nll c[3000005],ans[3000005];\nll ksm(ll x,ll y)\n{\n    ll an=1;\n    while(y)\n    {\n        if(y&1)\n            an=(an*x)%p;\n        x=(x*x)%p;\n        y>>=1;\n    }\n    return an;\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&p);\n    c[0]=1;\n    for (int i=1;i<=n;i++) c[i]=(c[i-1]*i)%p;\n    ll pow=ksm(c[n],p-2),k;\n    for(int i=n;i;i--)\n    {\n        k=(pow*i)%p;\n        ans[i]=(pow*c[i-1])%p;\n        pow=k;\n    }\n    for(int i=1;i<=n;i++)\n        printf(\"%lld\\n\",ans[i]);\n}\n```\n\n```cpp\n//\u4e94\u3001\u7ebf\u6027\u9012\u63a8 O(n) 100\u5206 560ms\n#include<cstdio>\n#define ll long long\nusing namespace std;\nll inv[3000005]={0,1};\nint main()\n{\n    int n,p;\n    scanf(\"%d%d\",&n,&p);\n    printf(\"1\\n\");\n    for (int i=2;i<=n;i++)\n    printf(\"%d\\n\",inv[i]=(ll)p-(p/i)*inv[p%i]%p);\n    return 0;\n}\n```",
        "postTime": 1556768353,
        "uid": 68706,
        "name": "Randolph\u3001",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "### \u4e00\u4e2a\u795e\u5947\u7684\u89e3\u6cd5\n#### \u4ece\u7ec4\u5408\u6570\u90a3\u91cc\u98de\u8fc7\u6765\u7684\n##### \u601d\u8def\n\u6211\u4eec\u5148\u5904\u7406\u51fa\u4e00\u4e2a$s=1 * 2 * ... * n$\uff0c\u7136\u540e\u7528\u8d39\u9a6c\u5c0f\u5b9a\u7406\u6c42\u4e00\u4e0b\u5b83\u7684\u9006\u5143\u5c31\u662f$s=s^{p-2}$\uff0c\u7136\u540e\u73b0\u5728\u7684s\u5c31\u76f8\u5f53\u4e8e$\\frac{1}{1 * 2 * ... * n}$\uff0c\u6240\u4ee5\u6211\u4eec\u53d1\u73b01~n\u4e2d\u4efb\u610f\u4e00\u9879\u7684\u9006\u5143\u90fd\u53ef\u4ee5\u7531\u73b0\u5728\u7684s\u5728O(1)\u5f97\u5230\uff0c\u5982\u4f55\u5f97\u5230\uff1f\u5047\u5982\u6211\u4eec\u8981\u6c425\u7684\u9006\u5143\uff0c\u5c31\u76f8\u5f53\u4e8e$s * (1 * 2 * 3 * 4) * (6*...* n)$\u4e5f\u5c31\u662f\u628a\u5206\u6bcd\u91cc\u96645\u4ee5\u5916\u7684\u6240\u6709\u6570\u6d88\u53bb\uff0c\u5c31\u80fd\u5f97\u52305\u7684\u9006\u5143\u4e86\uff0c\u5982\u4f55\u5b9e\u73b0\u5462\uff1f\u6211\u4eec\u9884\u5904\u7406\u4e00\u4e2a\u524d\u7f00\u79ef\u6570\u7ec4\uff0c\u7136\u540e\u5012\u5e8f\u5904\u7406\uff0c\u4ed6\u524d\u9762\u7684\u6570\u7684\u79ef\u76f4\u63a5\u67e5\u8868\uff0c\u540e\u9762\u6570\u7684\u79ef\u4ea4\u7ed9\u4e00\u4e2atmp\uff0c\u521d\u59cb\u662f1\uff0c\u6bcf\u5904\u7406\u5b8c\u4e00\u4e2a\u6570\uff0c\u5c31\u4e58\u4e0a\u8fd9\u4e2a\u6570\u5c31\u597d\u4e86\n##### \u4ee3\u7801\n```cpp\n//By AcerMo\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nconst int M=3005000;\nint n,m,s[M];\ninline int fpow(int x,int y)\n{\n\tint z=1;\n\tfor (;y;x=(1LL*x*x)%m,y>>=1)\n\tif (y&1) z=(1LL*z*x)%m;\n\treturn z;\n}\nsigned main()\n{\n\tcin>>n>>m;s[0]=1;\n\tfor (int i=1;i<=n;i++)\n\ts[i]=(1LL*s[i-1]*i)%m;\n\tint s1=1,ni=fpow(s[n],m-2);\n\tfor (int i=n;i;i--)\n\t{\n\t\ts[i]=((1LL*ni*s[i-1])%m*1LL*s1)%m;\n\t\ts1=(1LL*i*s1)%m;\n\t}\n\tfor (int i=1;i<=n;i++) printf(\"%d\\n\",s[i]);\n\treturn 0;\n}\n```",
        "postTime": 1541635020,
        "uid": 71558,
        "name": "AcerMo",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "\u4e58\u6cd5\u9006\u5143\u7684\u6a21\u677f\u9898\u2026\u2026 \u5177\u4f53\u795e\u9a6c\u7684\u6211\u5c31\u4e0d\u8bf4\u4e86\uff0c\u7528\u6700\u57fa\u7840\u7684\u7b97\u6cd5\uff08\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\uff0cexgcd\uff09\uff0c\u4e3b\u8981\u7684\u6b65\u9aa4\u662f\u8fd9\u6837\u7684\uff1a\n\n\u5047\u8bbe\u6211\u4eec\u8981\u6c42\u6ee1\u8db3\n\n$ ax + by = gcd(a, b) $\n\n\u7684 $ x,y $\uff0c\u800c\u6211\u4eec\u5df2\u77e5\n\n$ bx' + (a\\ mod\\ b)y' = gcd(b, a\\ mod\\ b) $\n\n\u6211\u4eec\u5bf9\u6b64\u5f0f\u8fdb\u884c\u63a8\u5bfc\uff1a\n\n$ bx' + (a\\ mod\\ b)y' = gcd(b, a\\ mod\\ b) $\n\n$ \\Leftrightarrow bx' + (a - bq)y' = gcd(a, b) \\qquad (q = [\\frac a b],\\ gcd(b, a\\ mod\\ b) = gcd(a, b)$\n\n$ \\Leftrightarrow bx' + ay' - bqy' = gcd(a, b) $\n\n$ \\Leftrightarrow ay' + b(x' - qy') = gcd(a, b) $\n\n\u4e8e\u662f\u5c31\u6109\u5feb\u7684\u89e3\u51b3\u5566~\n\n\u5f53\u7136\u8fd8\u6709\u4e00\u79cd\u65b9\u6cd5\uff0c\u7528\u6765\u6c42\u8fde\u7eed\u6570\u7684\u4e58\u6cd5\u9006\u5143\uff08\u6a21\u6570\u76f8\u540c\uff09\uff0c\u590d\u6742\u5ea6\u66f4\u5c0f\uff0c\u53ef\u4ee5\u53c2\u8003[\u6211\u7684\u535a\u5ba2](https://www.luogu.org/blog/ztyluogucpp/sheng-fa-ni-yuan-ge-ren-li-xie)\u3002\n\n\u6240\u4ee5\u662f\u4e0d\u662f\u53ef\u4ee5\u4e0a\u4ee3\u7801\u4e86\u5462\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint inverse[20000600];\nint main()\n{\n\tint n,p;\n\tscanf(\"%d %d\",&n,&p);\n\tprintf(\"1\\n\");\n\tinverse[1]=1;\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tint t=p-(long long)(p/i)*inverse[p%i]%p;\n\t\tinverse[i]=t;\n\t\tprintf(\"%d\\n\",t);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1528371441,
        "uid": 73645,
        "name": "_ztyqwq",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "## \u5b9a\u4e49\n>\u82e5$a*x\u22611(mod (p))$\uff0c\u5176\u4e2d$a$\u4e0e$p$\u4e92\u8d28\uff0c\u5219\u79f0$x$\u4e3a$a$\u6a21$p$\u610f\u4e49\u4e0b\u7684\u9006\u5143.\n\n**\u4ee5\u4e0b\u7528$x^{-1}$\u8868\u793a$x$\u7684\u9006\u5143**\n## \u7528\u9014\n\u4e00\u822c\u7528\u4e8e\u6c42$(a/b)\\%p$\uff0c\u89e3\u51b3\u6a21\u610f\u4e49\u4e0b\u9664\u6cd5\u7684\u5fc5\u8981\u624b\u6bb5.\n\n## \u65b9\u6cd5\n\u6c42\u4e58\u6cd5\u9006\u5143\u6709\u5f88\u591a\u79cd\u65b9\u6cd5\uff0c\u6211\u53ea\u4f1a\u5176\u4e2d\u7684\u4e09\u79cd\uff08\u4e2a\u4eba\u8ba4\u4e3a\u8f83\u9ad8\u6548\uff0c\u6613\u7406\u89e3\u3002\uff09\n\n### \u4e00.\u6269\u6b27\u6c42\u4e58\u6cd5\u9006\u5143\u3002\n\n\u6211\u4eec\u8003\u8651\u5b9a\u4e49\u5f0f:\n\n$a*x\u22611(mod (p))$\n\n\u5199\u6210\u88f4\u8700\u7b49\u5f0f\u7684\u5f62\u5f0f\u5c31\u662f:\n\n$ax+yp = 1$\n\n\u5229\u7528\u6269\u6b27\u6c42\u89e3$x,y$\u5373\u53ef\u3002\n\n\u8bb0\u5f97\u6c42\u89e3\u7684$x$\u53ef\u80fd\u4f1a\u6709\u8d1f\u6570\uff0c\u53ef\u4ee5\u628a$x$\u505a\u6a21$p$\u610f\u4e49\u4e0b\u7684\u5904\u7406:\n\n```cpp\nx = ((x%p)+p)%p\n```\n$or$\n\n```cpp\nwhile(x<0) x+=p;\nx%=p;\n```\n\n### \u4e8c.\u7ebf\u6027\u9012\u63a8\u591a\u7ec4\u9006\u5143\u3002\n\n\u8003\u8651\u4e00\u4e0b\u5e26\u4f59\u9664\u6cd5\u3002\n\n\u8bbe$p =k*a+q$\n\n\n\u5219$k = [p/a]$\n\n\u5219\u6709:\n$$k*a+q\u22610\\ (mod\\ p)$$\n\n\u4e24\u8fb9\u540c\u65f6\u4e58\u4ee5$a$\u548c$q$\u7684\u9006\u5143\uff0c\u5f97\n\n$$ k*q^{-1}+a^{-1}\u22610\\ (mod\\ p) $$\n\n$$a^-\u2261-k*q^{-1}\\ (mod\\ p)$$\n\n$$a^-\u2261-(p/a)*q^{-1}\\ (mod\\ p)$$\n\n$$a^-\u2261-(p/a)*(p\\%a)^{-1}\\ (mod\\ p)$$\n\n\u6211\u4eec\u5c31\u987a\u5229\u7684\u5f97\u5230\u4e86\u4e00\u6b21\u9012\u63a8\u5f0f\u3002\n\n```cpp\ninv[1] = 1;\nfor(int i = 2; i <= n ; ++ i){\n\tinv[i] = (p - (p/i)) * inv[p % i] % p\n}\n```\n\n### \u4e09.\u8d39\u9a6c\u5c0f\u5b9a\u7406\u6c42\u89e3\u4e58\u6cd5\u9006\u5143\n\n#### \u5f15\u7406\n> $a^{p-1}\u22611(mod(p))$\n\n> $=>a^{p-2} *a \u22611(mod(p))$\n\n\u5373$a$\u6a21$p$\u610f\u4e49\u4e0b\u7684\u4e58\u6cd5\u9006\u5143\u4e3a$a^{p-2} \\%p$\n\n$Code$ :\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint p,n;\nint Pow(int x,int y)\n{\n\tint ans = 1 , base =x;\n\tfor(;y;y>>=1,base*=base , base %= p) if(y & 1) ans *= base , ans %= p;\n\treturn ans;  \n}\n\nsigned main ()\n{\n\tios::sync_with_stdio(0); \n\tcin >> n >> p;\n\tcout << Pow(n,p-2) % p << '\\n';\n\treturn 0;\t\n}\n```\n",
        "postTime": 1563869822,
        "uid": 134080,
        "name": "jins3599",
        "ccfLevel": 4,
        "title": "\u4e58\u6cd5\u9006\u5143"
    },
    {
        "content": "## **\u8bba\u5982\u4f55\u4f18\u5316\u4f60\u7684\u65f6\u95f4\uff1a**\n\n\u4f60\u53ea\u9700\u8981\u628acout<<endl;\u6539\u6210**cout<<'\\n';**\u5c31\u53ef\u4ee5\u5566\uff01\uff01\uff01\n\n\u6709\u4e86'\\n' \u8bfb\u5165\u4f18\u5316\u90fd\u4e0d\u7528\u4e86\n\n~~\u8bfb\u5165\u4f18\u5316\u53ea\u4f1a\u8ba9\u4f60\u591aA\u4e00\u4e2a\u70b9~~\n\n\u6ca1\u9519\uff0c\u5c31\u662f\u8fd9\u4e48\u7684\u795e\u5947\uff01\uff01\uff01\n\n\u8f7b\u677e49\u5206  \u5230  **AC\u7eff**\n\n[49\u5206](https://www.luogu.org/recordnew/show/9441425)\n\n[AC\u7eff](https://www.luogu.org/record/show?rid=9441694)\n\n### \u8bc1\u660e\u5982\u4e0b\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/27309.png)\n\n------------\n\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\nusing namespace std;\nlong long a,b,s[3000003]; //s[i]\u4ee3\u8868i\u5728mod p \u610f\u4e49\u4e0b\u7684\u9006\u5143\nint main ()\n{\n    cin>>a>>b;\n    s[1]=1;\n    cout<<s[1]<<'\\n';\n    for(int i=2;i<=a;i++)\n\t{\n\t\ts[i]=b-b/i*s[b%i]%b;//\u9012\u63a8\u516c\u5f0f\n\t\tcout<<s[i]<<'\\n';//\u7ebf\u6027\u8fb9\u63a8\u8fb9\u8f93\u51fa\uff0c\u8bb0\u4f4f\u4e00\u5b9a\u4e0d\u80fd\u7528endl!!!\n\t} \n    return 0;\n}\n```\n\n### \u5982\u679c\u4f60\u4e0d\u4f1a\u8fd9\u4e48VAN~~\u8fd9\u867e\u7c73\u73a9\u610f~~\u7684\u8bdd,ex_gcd\u4e5f\u662f\u53ef\u4ee5\u7684\n\n~~\u8fd9\u4e2a\u5730\u65b9\u6211\u4e5f\u88abendl\u5361\u4e86\u534a\u5c0f\u65f6~~\n\n[49\u5206ex_gcd](https://www.luogu.org/record/show?rid=9439603)\n\n[AC\u7effex_gcd](https://www.luogu.org/record/show?rid=9443190)\n\nex_gcd\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<iostream>\nusing namespace std;\nint a,b;\nvoid exgcd(int a,int b,int &x,int &y)\n{\n    if(b)\n    {\n        exgcd(b,a%b,y,x);\n        y-=(a/b)*x;\n    }\n    else\n    {\n        x=1;y=0;\n    }\n}\nint main ()\n{\n    int x,y;\n    cin>>a>>b;\n    for(int i=1;i<=a;i++)\n    {\n        exgcd(i,b,x,y);\n        cout<<(x+b)%b<<\"\\n\";\n    } \n    return 0;\n}\n\n```",
        "postTime": 1533696542,
        "uid": 36260,
        "name": "KDL_\u6a59\u5b50",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "\u5176\u5b9e\u6709\u4e00\u79cd\u975e\u5e38\u597d\u7406\u89e3\u7684\u7ebf\u6027\u505a\u6cd5\n\n\u9996\u5148\u7b97\u51fa1!~n!\n\n\u7136\u540e\u8d39\u9a6c\u5c0f\u7b97\u51fan!\u7684\u9006\u5143\uff0c\u518d\u7531$ n!^{-1}=(n+1)!^{-1}*(n+1) $ \u5012\u63a8 1!~(n-1)! \u7684\u9006\u5143\n\n\u6700\u540e\u7531 $ x^{-1}=x!*(x-1)!^{-1} $ \u6c42\u51fa1~n\u7684\u9006\u5143\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define For(i,j,k) for(register int i=j;i<=k;i++)\nusing namespace std;\nint read(){\n    int x=0,l=1; char ch=getchar();\n    while(!isdigit(ch)) {if (ch=='-') l=-1; ch=getchar();}\n    while(isdigit(ch)) x=x*10+(ch^48),ch=getchar();\n    return x*l;\n}\nint l,buf[10],mo,n; ll c;\nvoid write(int x){\n    l=0;\n    while(x) buf[++l]=x%10,x/=10;\n    if(!l) l=1,buf[1]=0;\n    while(l) putchar('0'+buf[l--]);\n    putchar('\\n');\n}\nint ksm(ll a,int b){\n    c=1;\n    while(b){\n    \tif (b&1) c=(c*a)%mo;\n    \ta=(a*a)%mo; b>>=1;\n    }\n    return c;\n}\nll a[3000005],ny[3000005];\nint main(){\n    n=read(),mo=read(); a[1]=1;\n    For(i,2,n) a[i]=a[i-1]*i%mo; ny[n]=ksm(a[n],mo-2);\n    for(int i=n-1;i>=1;--i) ny[i]=ny[i+1]*(i+1)%mo; printf(\"1\\n\");\n    For(i,2,n) write(a[i-1]*ny[i]%mo);\n    return 0;\n}\n```",
        "postTime": 1521277259,
        "uid": 20821,
        "name": "wjy666",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "\u7ecf\u8fc7\u597d\u51e0\u6b21T\u540e\u624d\u53d1\u73b0N\u662f3e6\n\nnlogn\u66b4\u529b\u65e0\u679c\u540e\u53ea\u80fd\u638f\u51fa\u73cd\u85cf\u5df2\u4e45\u7684\u7ebf\u6027\u7b5b\u4e86\n\n\u901a\u8fc7\u9006\u5143\u7684\u5b9a\u4e49\u53ef\u4ee5\u77e5\u9053\u5b83\u662f\u5728\u819cP\u4e0b\u7684\u5b8c\u5168\u79ef\u6027\u51fd\u6570\n\n\u6240\u4ee5\u53ef\u4ee5\u50cfPhi\u51fd\u6570\u4e00\u6837O(n)\u7b5b\u4e86\n\n\u7ebf\u6027\u7b5b\u53ea\u6709\u5728\u8d28\u6570\u65f6\u624d\u4f1alogn\u6c42\u9006\u5143\uff0c\u800c\u8d28\u6570\u5dee\u4e0d\u591a\u5c31\u662fn/lnn\u4e2a\uff0c\u8fd8\u662fO(n)\n\n\u867d\u8bf4\u8fc7\u4e86\uff0c\u4f46\u662f\u6700\u540e\u4e00\u4e2a\u70b9919ms\u770b\u7740\u602a\u5413\u4eba\u7684\n\n\n```cpp\n#include <stdio.h>\n#include <string.h>\ntypedef long long _L;\nvoid inline GCDEX(_L a,_L b,_L&x,_L&y)\n{\n    if(!b)\n    {x=1;y=0;return;}\n    GCDEX(b,a%b,y,x);\n    y-=x*(a/b);\n}\n_L Inverse(_L d,_L n)\n{\n    _L x,y;\n    GCDEX(d,n,x,y);\n    return (x+n)%n;\n}\nint N,P;\nbool NPr[3100000];\nint Prm[310000];\nint Prt;\nlong long Ivr[3100000];\nvoid Eular()\n{\n    int wi,wib;\n    Ivr[1]=1;\n    for(wi=2;wi<=N;++wi)\n    {\n        if(!NPr[wi])\n        {\n            Prm[++Prt]=wi;\n            Ivr[wi]=Inverse(wi,P);\n        }\n        for(wib=1;Prm[wib]*wi<=N;++wib)\n        {\n            Ivr[Prm[wib]*wi]=Ivr[wi]*Ivr[Prm[wib]]%P;\n            NPr[Prm[wib]*wi]=1;\n            if(wi%Prm[wib]==0)break;\n        }\n    }\n}\nint main()\n{\n    scanf(\"%d %d\",&N,&P);\n    int wi;\n    Eular();\n    for(wi=1;wi<=N;++wi)\n        printf(\"%d\\n\",(int)Ivr[wi]);\n    return 0;\n}\n```",
        "postTime": 1499250831,
        "uid": 25508,
        "name": "Night_Aurora",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "# \u770b\u5230\u5404\u4f4d\u7684\u4e58\u6cd5\u9006\u5143\u6211\u6709\u70b9\u6050\u60e7\u554a\n### \u516d\u884c\uff08~~\u5f3a\u884c\u538b\u884c~~\uff09AC\u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nlong long n, p, inv[3000010]; \nint main( void ){\n\tstd::scanf( \"%lld%lld\", &n, &p ); inv[1] = 1; std::printf( \"%lld\\n\", inv[1] );\n\tfor( int i = 2; i <= n; i++ ) std::printf( \"%lld\\n\", inv[i] = ( ( p - p / i ) * inv[p % i] ) % p );\n}\n```\n[\u535a\u5ba2\u5185\u89c2\u770b](https://www.cnblogs.com/with6676/p/11566059.html)~~\u8fd8\u53ef\u4ee5\u8c03\u620f\u770b\u677f\u5a18\u54e6~~\n\n## \u4e58\u6cd5\u9006\u5143\u662f\u5565\uff1f\n\n\u201c\u9006\u201d\u53ef\u4ee5\u7406\u89e3\u4e3a\u662f\u62b5\u6d88\u4e4b\u524d\u7684\u8fd0\u7b97\u6548\u679c\n\n### $ e. g. $\n\n$ a = a + b - b$  \u90a3\u4e48 $+ b$ \u5c31\u53eb\u505a $- b$ \u7684\u9006\n\n\u540c\u7406 $ a = a * b * \\frac{1}{b} $ \u90a3\u4e48 $\\frac{1}{b}$ \u5c31\u53eb\u505a $* b$ \u7684\u9006\n\n\u5f88\u597d\u7406\u89e3\u5427\n\n\u90a3\u4e48\u73b0\u5728\u8bf7\u601d\u8003\uff0c\u6211\u4eec\u77e5\u9053$ ( a * b )$ $mod$ $ p = \uff08 a $ $mod$ $p ) * ( b$ $mod$ $p )$\uff0c\u90a3\u4e48 $ \\frac{a}{b} $ mod $ p $ \u662f\u5426\u7b49\u4e8e $( a$ $mod$ $ p ) * ( b$ $mod$ $p )$\u5462\n\n\u663e\u7136\u4e0d\u7b49\u4e8e\n\n\u600e\u4e48\u529e\u5462\uff1f\u6211\u4eec\u53ea\u80fd\u627e\u4e00\u4e2a$x$\uff0c\u4f7f\u5f97$\\frac{a}{b}$ $mod$ $ p =   a * x $ mod $ p$ \n\n\u6b64\u65f6$ x$ \u53eb\u505a $b$\u7684\u4e58\u6cd5\u9006\u5143\uff0c \u8868\u793a\u4e3a$b * x\\equiv 1 $( $mod$ $p$ )\uff0c\u53eb\u505a$b * x$ \u4e0e 1 \u5173\u4e8e $ p $ \u540c\u4f59\uff0c $\\equiv$\u7684\u610f\u601d\u662f$b * x$ $mod$ $ p  = 1$ $mod$ $p$\uff0c \u4e5f\u53ef\u4ee5\u5199\u6210 $ ( b * x - 1 ) / p = 0 $\n\n#### \u4e3a\u5565\u662f$ b * x \\equiv 1$ \u800c\u4e0d\u662f$ a * x \\equiv 1 $\uff1f\uff1f\uff1f\n\n\u65e2\u7136$b * x$ \u548c 1 \u540c\u4f59\u4e86\uff0c \u90a3\u4e48\u6c42\u4f59\u65f6\u8fd9\u4fe9\u5c31\u662f\u7b49\u4ef7\u7684\u4e86\uff0c\u6240\u4ee5$ a / b * 1$ $mod$ $ p = a / b * b * x$ $mod$ $ p = a * x$ $mod$ $p$\n\n### **\u6ce8\u610f\uff1a\u5b58\u5728\u7684\u5145\u8981\u6761\u4ef6\u662f $a ,p$\u4e92\u8d28**\n## \u548b\u6c42\u4e58\u6cd5\u9006\u5143\uff1f\n\n\u6c42\u5355\u4e2a\u6570\u7684\u4e58\u6cd5\u9006\u5143\uff0c \u53ef\u4ee5\u7528\u62d3\u5c55\u6b27\u51e0\u91cc\u5f97\uff08\u4e0d\u77e5\u9053\u7684\u6233\u8fd9\u91cc\uff09\n\n$a * x \\equiv 1 ( mod $ $p)$ \u53ef\u5199\u6210 $ a * x - p * y = 1$\n\n\u6b64\u65f6\uff0c\u8fd9\u4e00\u4e0d\u5b9a\u65b9\u7a0b\u5c31\u53ef\u4ee5\u7528\u62d3\u5c55\u6b27\u51e0\u91cc\u5f97\u89e3\u4e86\n\n\u53e6\u5916\uff0c\u524d\u9762\u5f88$dalao$\u4e5f\u5199\u4e86\uff0c\u53ef\u4ee5\u7528\u8d39\u9a6c\u5c0f\u5b9a\u7406\u52a0\u901f\uff0c\n\n\u56e0\u4e3a$ a ^ {p- 1} \\equiv 1 (mod$ $p)$\uff0c\u5f88\u660e\u663e\u53ef\u4ee5\u5199\u6210\n\n$a * a ^ {p - 2} \\equiv 1 (mod$ $p)$\uff0c\u90a3\u4e48\u9006\u5143\u5c31\u6c42\u51fa\u6765\u4e86\uff0c\u53ef\u4ee5\u7528\u5feb\u901f\u5e42\u52a0\u901f\n\n## \u4f46\u662f\u592a\u9ebb\u70e6\u4e86\uff0c\u4e58\u6cd5\u9006\u5143\u53ef\u4ee5\u7ebf\u6027\u9884\u5904\u7406\n\n$ inv[i] = ( p - \\frac{q}{i} ) * inv[p $ $mod$ $i] $ $mod$ $p$\n\n#### \u8bd5\u7740\u8bc1\u660e\n\n$i * inv[i]$ $mod$ $p$\n\n$= i * (p - \\frac{p}{i}) * inv[p $ $mod$ $i]$ $ mod $ \n\n$= i * (p - \\frac{p-p MOD i}{i}) * inv[p $ $mod$ $i]$ $ mod $ \n\n//\u56e0\u4e3a\u5206\u5b50\u6253\u4e0d\u4e86$mod$,\u6240\u4ee5\u7528MOD\u8868\u793a\u4e86\n\n$=( p $ $mod$ $i )* inv[p $ $mod$ $i]$ $ mod $ $p$\n\n$= 1$\n\n#### \u9002\u7528\u8303\u56f4\n$i < p, p$\u4e3a\u8d28\u6570\uff08\u53ea\u6709p\u4e3a\u8d28\u6570\u65f6\u624d\u80fd\u4fdd\u8bc1\u5c0f\u4e8ep\u7684\u6570\u5168\u90e8\u4e0ep\u4e92\u8d28\uff09\n\n#### \u5bf9\u4e8e$ i > p $ \u4e14 $ i $ \u4e0d\u6574\u9664 $p$ \u65f6\n$inv[i] =  inv[i $ $mod$ $p]$ \n### \u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\n\n```cpp\ninv[1] = 1;\nfor ( int i = 2; i <= n; i++ ) {\n    inv[i] = ( p - p / i ) * inv[p % i] % p;\n}\n```\n_____________________________\n\n```cpp\nreturn; // \u529f\u5fb7\u5706\u6ee1\n```\n",
        "postTime": 1569118039,
        "uid": 149105,
        "name": "Indigo_Boy",
        "ccfLevel": 3,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "**\u9006\u5143\u7684\u6982\u5ff5**\n\n\u770b\u8fc7\u4e00\u4e9b\u4eba\u7684\u9898\u89e3\uff0c\u53d1\u73b0\u4ed6\u4eec\u5bf9\u9006\u5143\u7684\u5b9a\u7406\u6709\u6240\u4e0d\u540c\uff0c\u6211\u5728\u8fd9\u91cc\u6982\u62ec\u4e00\u4e0b\u6559\u79d1\u4e66\u4e0a\u7684\u5b9a\u4e49\u5427\n\n**\u9006\u5143**\n\n\u82e5\u6574\u6570b\uff0cm\u4e92\u8d28\uff0c\u5e76\u4e14b|a\uff0c\u5219\u5b58\u5728\u4e00\u4e2a\u6574\u6570x\uff0c\u4f7f\u5f97a/b\u2261a*x\uff08mod m\uff09\u3002\n\u79f0x\u4e3a**b\u7684\u6a21m\u4e58\u6cd5\u9006\u5143**\uff0c\u8bb0\u4e3ab^(-1)\uff08mod m\uff09\u3002\n\n**\u9006\u5143\u7684\u5e94\u7528**\n\n```\n\u7528\u4e8e\u6c42\u89e3a/b\u2261\uff08mod m\uff09\u7684\u503c\n```\n\n\n\n\u8fd9\u9053\u9898\u6709\u5f88\u591a\u89e3\u6cd5\uff0c\u521a\u770b\u5230\u9898\u76ee\u5c31\u60f3\u5230\u4e86**\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u5b9a\u7406\u6c42\u4e58\u6cd5\u9006\u5143**\n\n\u6c42\u89e3\u540c\u4f59\u65b9\u7a0b\u5373\u53ef\uff1ab*x\u22611\uff08mod m\uff09 \uff0c\u89e3\u6cd5\u4e0e\u540c\u4f59\u65b9\u7a0b\u90a3\u9898\u5c31\u4e00\u6837\u4e86\n\n\u4f46\u662f\u63d0\u4ea4\u4e0a\u53bb\u53d1\u73b0\u6700\u540e\u4e00\u4e2a\u70b9\u5b8c\u7f8e\u7684TLE\u4e86\uff0c\u53ea\u597d\u8f6c\u6362\u601d\u8def\n\n\u8bd5\u8bd5\u7528**\u8d39\u9a6c\u5c0f\u5b9a\u7406**\u6c42\u89e3\u4e00\u4e2a\u5feb\u901f\u5e42\uff1f\u663e\u7136**\u590d\u6742\u5ea6nlog\uff08p\uff09**\u4e0d\u5141\u8bb8\n\n\u4e0b\u9762\u6709\u4e00\u4e2a\u975e\u5e38\u4f18\u79c0\u7684\u89e3\u6cd5\uff0c\u590d\u6742\u5ea6O\uff08n\uff09\uff0c~~\u8c8c\u4f3c\u548cLucas\u5b9a\u7406\u6709\u70b9\u5173\u7cfb~~\n\n**\u7ebf\u6027\u6c42\u6240\u6709\u9006\u5143**\n\n~~\u7a81\u7136\u53d1\u73b0LaTeX\u771f\u662f\u4e2a\u597d\u4e1c\u897f\uff0c\u53ef\u60dc\u6211\u4e0d\u4f1a\uff0c\u4e0d\u8fc7\u5728\u5b66\uff0c\u73b0\u5c31\u653e\u4e2a\u622a\u56fe\u5427~~\n\n![](https://b2.bmp.ovh/imgs/2019/08/f1aaa100a24737d4.png)\n\n\n\n80\u5206\u6269\u6b27\u4ee3\u7801\uff1a\n\n\u7565\n\n100\u5206\u7ebf\u6027\u9012\u63a8\u4ee3\u7801\uff1a\n```\n#include<cstdio>\nusing namespace std;\nlong long inv[3000010],p,n;\nint main() {\n\tinv[1] = 1;\n\tscanf(\"%d%d\",&n,&p);\n\tprintf(\"1\\n\");\n\tfor(int i = 2; i <=n; i++)\n\t\tinv[i]=p-(p/i)*inv[p%i]%p,printf(\"%d\\n\",inv[i]);\n\t\t\n\treturn 0;\n}\n\n```\n\n",
        "postTime": 1565600810,
        "uid": 111289,
        "name": "Ryan_",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "\u524d\u9762\u7684\u5927\u4f6c\u4eec\u4f3c\u4e4e\u5bf9\u4e8e\u9006\u5143\u7684\u4f5c\u7528\u8bb2\u7684\u4e0d\u662f\u5f88\u6e05\u695a\u3002\u6211\u4fbf\u5bfb\u601d\u7740\u3002\u3002\u5199\u4e00\u7bc7\u65b9\u4fbf\u50cf\u6211\u8fd9\u79cd\u5927\u83dc\u9e21\u7406\u89e3\u7684\u9898\u89e3\u3002dalao\u8bf7\u81ea\u884c\u79fb\u6b65~\n\n# 1.\u4e58\u6cd5\u9006\u5143\u662f\u4ec0\u4e48\uff1f\n\n\u201c\u4e58\u6cd5\u9006\u5143\uff0c\u662f\u6307\u6570\u5b66\u9886\u57df\u7fa4G\u4e2d\u4efb\u610f\u4e00\u4e2a\u5143\u7d20a\uff0c\u90fd\u5728G\u4e2d\u6709\u552f\u4e00\u7684\u9006\u5143a'\uff0c\u5177\u6709\u6027\u8d28a\u00d7a'=a'\u00d7a=e\uff0c\u5176\u4e2de\u4e3a\u8be5\u7fa4\u7684\u5355\u4f4d\u5143\u3002\u201d--X\u5ea6\u767e\u79d1\n\n\u6ca1\u4e8b\uff0c\u6211\u77e5\u9053\u4f60\u770b\u4e0d\u61c2\u3002(\u53cd\u6b63\u6211\u662f\u770b\u4e0d\u61c2)\n\n\u7528\u73b0\u4ee3\u6c49\u8bed\u8868\u8ff0\uff0c\u4fbf\u662f\u6211\u4eec\u9700\u8981\u627e\u5230\u4e00\u4e2a\u6570\uff0c\u8ba9\u5b83\u53ef\u4ee5\u628a$a*b(mod\\ p)$\u7684$b$\u62b5\u6d88\u3002\n\n\u65e0\u6cd5\u7406\u89e3\uff1f\u6ca1\u4e8b\uff0c\u8ba9\u6211\u4eec\u5148\u770b\u4e24\u4e2a\u6545\u4e8b\u3002\n\n## 1.1.\u5173\u4e8e\u4e58\u6cd5\u9006\u5143\u7684\u7c7b\u6bd4\n\n**[\u642c\u8fd0&\u6539\u7f16\u81ea\u8fd9\u91cc](https://www.jianshu.com/p/e9e1c52bf6c9)**\n\n### 1.1.1.\u52a0\u6cd5\n\n\u9996\u5148\uff0c\u60f3\u50cf\u4e00\u4e0b\uff0c\u4f60\u5728\u6570\u5b66\u4e16\u754c\u7684\u52a0\u6cd5\u738b\u56fd\u91cc\u3002\u4f60\u662f\u90a3\u4f4d\u5fb7\u9ad8\u671b\u91cd\u7684\u56fd\u738b$a$\u3002\u4f60\u5728\u6570\u8f74\u7684\u5750\u6807$a$\u4e0a\u3002\n\n\u6709\u4e00\u5929\uff0c\u4f60\u88ab\u4e00\u80a1\u795e\u79d8\u529b\u91cf\u5f80\u6570\u8f74\u6b63\u65b9\u5411\u603c\u4e86$b$\u4e2a\u5355\u4f4d\u957f\u5ea6\uff01\u4f60\u73b0\u5728\u4e0d\u518d\u662f\u56fd\u738b$a$\uff0c\u800c\u662f\u4e0d\u77e5\u540d\u7684$a+b$\uff01\n\n\u4f60\u5f88\u751f\u6c14\uff0c\u60f3\u8981\u91cd\u56de\u5b9d\u5ea7\uff0c\u600e\u4e48\u529e\uff1f\n\n\u600e\u4e48\u6765\u7684\uff0c\u600e\u4e48\u56de\u53bb\u5457\uff01\n\n\u6ca1\u9519\uff0c\u4f60\u53ea\u9700\u8981\u5f80\u8d1f\u65b9\u5411\u8d70$b$\u4e2a\u5355\u4f4d\u957f\u5ea6\uff0c\u4f60\u5c31\u91cd\u56de\u4e86\u5b9d\u5ea7$a$\uff0c\u4f60\u53c8\u53ef\u4ee5\u6307\u70b9\u6c5f\u5c71\u3002\n\n\u5982\u679c\u90a3\u80a1\u795e\u79d8\u529b\u91cf\u53eb\u505a\u52a0\u6cd5\u3002\n\n\u6ca1\u9519\uff0c\u4f60\u91cd\u56de\u5b9d\u5ea7\u7684\u65b9\u6cd5\u53eb\u505a\u51cf\u6cd5\u3002\n\n\u90a3\u8ba9\u6211\u4eec\u7528\u6570\u5b66\u516c\u5f0f\u628a\u4e0a\u8ff0\u8fc7\u7a0b\u8868\u8ff0\u51fa\u6765\u5427\uff01\n\n$$(a+b)-b=a$$\n\n\n------------\n\n\n### 1.1.2.\u4e58\u6cd5\n\n\u8bf7\u518d\u60f3\u50cf\u4e00\u4e0b\uff0c\u4f60\u8fd8\u662f\u5728\u6570\u5b66\u4e16\u754c\uff0c\u53ea\u4e0d\u8fc7\u8fd9\u4e00\u6b21\u662f\u5728\u4e58\u6cd5\u738b\u56fd\u3002\n\n\u4f60\u662f\u56fd\u738b$a(a\\in N^*)$\u3002\u8fd9\u56de\uff0c\u90a3\u80a1\u795e\u79d8\u529b\u91cf\u53eb\u505a\u4e58\u6cd5\uff0c\u628a\u4f60\u5f80\u6570\u8f74\u6b63\u65b9\u5411\u603c\u4e86$(b-1)(b\\in N^*)$\u500d\u3002\u4e5f\u5c31\u662f\u4f60\u73b0\u5728\u5728$a*b$\u7684\u4f4d\u7f6e\u4e0a\u3002\n\n\u4f60\u91cd\u56de\u5b9d\u5ea7\u7684\u65b9\u6cd5\u4fbf\u662f\u9664\u6cd5\u3002\u4f60\u53ea\u9700\u8981\u627e\u5230\u4ece\u539f\u70b9\u5230\u73b0\u5728\u6240\u5728\u4f4d\u7f6e\u7684\u6700\u9760\u8fd1\u6570\u8f74\u7684$b$\u7b49\u5206\u70b9\u5c31\u5b8c\u4e8b\u513f\u4e86\u3002\n\n\u516c\u5f0f\u5982\u4e0b\uff1a\n\n$$(a*b)/b=a\\ \\ \\  (a,b \\in N^*) $$\n\n\n\n------------\n### 1.1.\u5c0f\u7ed3\uff1a\n\n\u5176\u5b9e\u4e0d\u96be\u53d1\u73b0\uff0c\u52a0\u6cd5\u7684\u9006\u64cd\u4f5c\u53eb\u4f5c\u51cf\u6cd5\uff0c\u4e58\u6cd5\u7684\u9006\u64cd\u4f5c\u53eb\u4f5c\u9664\u6cd5\u3002\n\n\u4f46\u662f\u5982\u679c\u4f60\u4ed4\u7ec6\u8bfb\u8fc7\u9898\uff0c\u4f60\u5c31\u4f1a\u53d1\u73b0\u201c\u4e58\u6cd5\u9006\u5143\u201d\u7684\u4e58\u6cd5\u597d\u50cf\u548c\u666e\u901a\u4e58\u6cd5\u4e0d\u592a\u4e00\u6837\u2014\u2014\u6ca1\u9519\uff0c\u6240\u6709\u7b97\u5f0f\u662f\u5728$(mod p)$\u6761\u4ef6\u4e0b\u7684\u3002\n\n\u90a3\u6211\u4eec\u8be5\u600e\u4e48\u529e\u5462\uff1f\n\n------------\n\n## 1.2 \u4e58\u6cd5\u9006\u5143\u7684\u6027\u8d28\n\n\u6211\u4eec\u5148\u5047\u8bbe\u5728$(mod\\ p)$\u6761\u4ef6\u4e0b\uff0c\u6b63\u6574\u6570i\u7684\u9006\u5143\u4e3a$inv[i]$\u3002\u5176\u4e2dinv\u662f\u82f1\u8bed\u9006\u5143(Inverse)\u7684\u7f29\u5199\u3002\n\n\u5bf9\u4e8e\u4efb\u610f\u5927\u4e8e\u7b49\u4e8e1\uff0c\u5c0f\u4e8e(\u6ce8\u610f\u6ca1\u6709\u7b49\u4e8e)$p$\u7684\u6b63\u6574\u6570$a$\uff0c\u90fd\u6709$a*inv[a] \\equiv 1 (mod \\ p)$\n\n$e.g.\\ \\ a=2,b=3,p=5,inv[a]=3,inv[b]=2.$\n\n### 1.2.1 \u8ba9\u6545\u4e8b\u7ee7\u7eed\uff1f\n\n\u73b0\u5728\uff0c\u4f60\u5728$(mod p)$\u610f\u4e49\u4e0b\u7684\u4e58\u6cd5\u738b\u56fd\u3002\u4f60\u662f\u56fd\u738b$a(a\\in N^*)$\u3002\u90a3\u80a1\u795e\u79d8\u529b\u91cf\u628a\u4f60\u5f80\u6570\u8f74\u6b63\u65b9\u5411\u603c\u4e86$(b-1)(b\\in N^*)$\u500d\u3002\n\n\u8fd9\u8fd8\u6ca1\u5b8c\uff01\u7531\u4e8e\u73b0\u5728\u662f\u5728$(mod\\ p)$\u610f\u4e49\u4e0b\u7684\u4e58\u6cd5\u738b\u56fd\uff0c\u4f60\u7684\u4f4d\u7f6e\u88ab$(mod\\ p)$\u4e86\n\u3002\n\n\u4e5f\u5c31\u662f\u4f60\u73b0\u5728\u5728$(a*b)mod\\ p$\u7684\u4f4d\u7f6e\u4e0a\u3002\n\n\u8fd9\u4e2a\u65f6\u5019\uff0c\u663e\u7136\u6211\u4eec\u4e0d\u80fd\u518d\u505a\u9664\u6cd5\u4e86\u3002\u4e3e\u4e00\u4e2a\u5f88\u7b80\u5355\u7684\u4f8b\u5b50:\n\n$$a=2,b=3,p=5$$\n\n\u4e58\u6cd5\u7684\u7b54\u6848\u662f$6$\uff0c$(mod\\ 5)$\u540e\u7b54\u6848\u662f$1$.\u6211\u4eec\u603b\u4e0d\u80fd\u8ba1\u7b97(1/3)\u5f97\u5230\u4e00\u4e2a\u5c0f\u6570\u4f5c\u4e3a\u7b54\u6848\u5427\uff1f\n\n\u6b64\u65f6\u4e58\u6cd5\u9006\u5143\u5c31\u5341\u5206\u6709\u7528\u4e86\u3002\n\n\u6211\u4eec\u53ea\u9700\u8981\u628a$1$\u4e58\u4e0a$inv[b]$\u5c31\u53ef\u4ee5\u5f97\u5230$2$,\u4fbf\u662fa\u7684\u521d\u59cb\u503c\u3002\n\n\u4e3a\u4ec0\u4e48\uff1f\n\n\u6211\u4eec\u6765\u63a8\u5bfc\u4e00\u4e0b\u516c\u5f0f\uff1a\n\n$$\\because b*inv[b]\\equiv 1(mod\\ p)$$\n\n$$\\therefore a*b*inv[b]\\equiv a(mod\\ p)$$\n\n\u662f\u4e0d\u662f\u5341\u5206\u7b80\u5355\u6613\u61c2\uff1f\n\n\u4e58\u6cd5\u9006\u5143\u7684\u672c\u8d28\uff0c\u4fbf\u662f\u5c06\u5728$mod\\ p$\u6761\u4ef6\u4e0b\u4e0d\u65b9\u4fbf\u64cd\u4f5c\u7684\u9664\u6cd5\uff0c\u806a\u660e\u5730\u8f6c\u5316\u6210\u201c\u62b5\u6d88\u4e58\u6cd5\u5e26\u6765\u7684\u5f71\u54cd\u201d\u3002\n\n# 2.\u4ee3\u7801\u5b9e\u73b0\n\n\u6a21\u677f\u7684\u4ee3\u7801\u4e5f\u5341\u5206\u7b80\u77ed\u3002\n\n\u7531\u4e8e\u672c\u6587\u4ee5\u89e3\u91ca\u4e3a\u4e3b\uff0c\u6240\u4ee5\u8bc1\u660e\u4e0d\u4f5c\u8d58\u8ff0\u3002\u82e5\u9700\u8981\u8bc1\u660e\uff0c\u8bf7\u5927\u5bb6\u79fb\u6b65dalao\u4eec\u7684\u9898\u89e3\u3002\n\n\u8fd9\u91cc\u662f\u4e00\u4e2a\u7ebf\u6027\u89e3\u6cd5\u3002\u516c\u5f0f\u5165\u4e0b\uff1a\n\n\n$$inv[i]=((p-p/i)*inv[p\\ mod\\ i])\\ mod\\ p;$$\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nlong long inv[3000005],n,p;\nint main(){\n\tinv[1]=1;\n    cin>>n>>p;\n\tfor(int i=2;i<=n;++i)\n        inv[i]=(long long)((p-p/i)*inv[p%i])%p;\n    for(int i=1;i<=n;++i)\n        printf(\"%lld\\n\",inv[i]);\n}\n```",
        "postTime": 1564126201,
        "uid": 53058,
        "name": "Algha_Porthos",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "nlogn\u679c\u65ad\u8dd1t\uff0c\u53c8\u4e0d\u4f1a\u7ebf\u6027\u6c42\u9006\u5143\uff0c\u4e8e\u662f\u778e\u63a8\u4e86\u4e00\u4e2a\u5f0f\u5b50\u51fa\u6765qwq\n\n\u770b\u4e86\u4e00\u5708\u597d\u50cf\u8fd8\u6ca1\u6709\u7c7b\u4f3c\u601d\u8def\u7684\u9898\u89e3\n\n\u8bbea[i] = 1\\*2\\*\u2026\u2026\\*i = i!\uff0cb[i] = i \\* (i+1) \\* \u2026\u2026 \\* n = n! / (i - 1)!\uff08\u539f\u8c05\u6211\u4e0d\u4f1a\u63d2\u5165\u516c\u5f0f\uff09\uff0c\u663e\u7136\u53ef\u4ee5O(n)\u9884\u5904\u7406\uff0c\u987a\u4fbf\u518d\u9884\u5904\u7406\u4e00\u4e2an!^-1\uff0c\u7528\u6269\u6b27\u6216\u8d39\u9a6c\u90fd\u884c\n\n\u90a3\u4e48\u6211\u4eec\u6709\uff1ai^-1 = a[i - 1] \\* b[i + 1] \\* n!^-1\n\n\u4e8e\u662f\u5c31\u80fd\u7ebf\u6027\u7b97\u5566\n\n\u4e0a\u4e11\u964b\u7684\u4ee3\u7801\uff1a\n\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,p;\nlong long a[3000010],b[3000010];\nlong long ksm(long long q,long long w){\n    long long z = 1;\n    while(w){\n        if(w & 1) z = z * q % p;\n        q = q * q % p;\n        w >>= 1;\n    }\n    return z;\n}\nint main(){\n    scanf(\"%d%d\",&n,&p);\n    int i,j,k;\n    a[0] = 1;\n    for(i = 1;i <= n;i++){\n        a[i] = a[i - 1] * i % p;\n    }\n    b[n + 1] = 1;\n    for(i = n;i;i--){\n        b[i] = b[i + 1] * i % p;\n    }\n    long long s = ksm(a[n],p - 2);\n    for(i = 1;i <= n;i++){\n        printf(\"%lld\\n\",s * a[i - 1] % p * b[i + 1] % p);\n    }\n    return 0;\n}\n```",
        "postTime": 1512745454,
        "uid": 45775,
        "name": "liuzhangfeiabc",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "\u8fd9\u9898\u6211\u4e5f\u662f\u9189\u4e86\u3002\u4e00\u5f00\u59cb\u6211\u5148\u662f\u6253\u4e86\u4e2a\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\uff0c\u7136\u540eT\u4e86\u4e24\u4e2a\u70b9\u540e\uff0c\u731b\u7136\u53d1\u73b0p\u4e3a\u7d20\u6570\u3002\u7136\u540e\u6211\u53c8\u6253\u4e86\u8d39\u9a6c\uff0c\u8fd8\u662fT\u3002\u4e00\u5f00\u67093\\*10^6\uff0c\u4f60\u5728\u9017\u6211\u3002\u8fd8\u662f\u53bb\u6253\u4e00\u4e2a\u7b5b\u6cd5\u5427\uff08\u849f\u84bb\u8fd8\u662f\u53bb\u7f51\u4e0a\u770b\u7684\uff09\u3002\u7136\u540e\u8fd8\u662fT\u4e86\u4e00\u4e2a\u70b9\u3002\u8fd9\u662f\u6211\u628a0..3000000\u7684\u6570\u7ec4\u5f00\u52305000000\u5c31\u53ef\u4ee5\u8fc7\u4e86\uff0c\u8fd8\u662f800ms\u7684\uff0c\u8fd9\u5c31\u662f\u4f20\u8bf4\u4e2d\u7684\u7a7a\u95f4\u6362\u65f6\u95f4\u5417\uff08233333\uff09\u3002\u4e0b\u9762\u5c31\u628a\u4ee3\u7801\u53d1\u4e00\u4e0b\u5427\uff0c\u6bd5\u7adf\u6a21\u677f\u9898\u3002\n\n\ncode\uff1a\n\n\n\n\n```cpp\nvar\n n,p,ans:longint;\n i:longint;\n inv:array [0..5000001] of longint;\nbegin\n readln(n,p);\n inv[1]:=1;\n for i:=2 to n do\n  inv[i]:=((p-p div i) mod p*inv[p mod i]) mod p;\n for i:=1 to n do\n  writeln(inv[i]);\nend.\n```\n\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7684\u7b97\u6cd5\uff08\u60f3TLE\u7684\u53ef\u4ee5\u8bd5\u8bd5\uff09\uff1a\n\n\n\n```cpp\nvar\n n,i,j,p,x,y:longint;\nprocedure exgcd(a,b:longint; var x,y:longint);\nvar x1,y1:longint;\n begin\n  if b=0 then\n   begin\n    x:=1;\n    y:=0;\n    exit;\n   end;\n  exgcd(b,a mod b,x1,y1);\n  x:=y1;\n  y:=x1-a div b*y1;\n end;\nbegin\n readln(n,p);\nfor i:=1 to n do\n begin\n  exgcd(i,p,x,y);\n  writeln((x+p) mod p);\n end;\nend.\n```\n\u8d39\u9a6c\u5c0f\u5b9a\u5f8b\u6c42\u9006\u5143\uff08\u4e5f\u4f1aTLE\u54e6\u54e6\uff09\uff1a\n\n\n\n```cpp\nvar\n i,n,p,ans:longint;\nfunction power(x,y:longint):longint;\n begin\n  if y=1 then\n   begin\n    ans:=x;\n    exit;\n   end;\n  power(x,y div 2);\n  ans:=(ans*ans) mod p;\n  if odd(y) then ans:=(ans*x) mod p;\n end;\nbegin\n readln(n,p);\n for i:=1 to n do\n  begin\n   power(i,p-2);\n   writeln(ans);\n  end;\nend.\n```",
        "postTime": 1499495207,
        "uid": 18895,
        "name": "liangzihao",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "# \u8c01\u8bf4\u6269\u6b27\u8fc7\u4e0d\u4e86(\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/p42383hv.png)\n\n\u9996\u5148\uff0c\u5373\u4f7f\u52a0\u4e0a\u8f93\u5165\u8f93\u51fa\u4f18\u5316\uff0c\u4e00\u822c\u9012\u5f52\u5f62\u5f0f\u7684\u6269\u6b27\u786e\u5b9e\u8fc7\u4e0d\u4e86(\u5c3e\u9012\u5f52\u5f62\u5f0f\u6216\u8bb8\u6709\u53ef\u80fd\uff0c\u6ca1\u6d4b\u8bd5\uff09\n\n\u4f46\u5982\u679c\u7528\u9012\u63a8\u5f62\u5f0f\u7684\u6269\u6b27\uff0c\u5bf9ax+by=gcd(a,b)\u53ea\u6c42x\u4e0d\u6c42y\uff0c\u53ef\u4ee5\u66f4\u5feb\u901f\u7684\u6c42\u9006\u5143\n\n\u8fd9\u65f6\u52a0\u4e0a\u8f93\u51fa\u4f18\u5316\uff0c\u51ed\u501f\u8bc4\u6d4b\u673a\u6027\u80fd\u7384\u5b66\uff0c\u5c31\u80fd\u52c9\u5f3a\u8fc7\u6700\u540e\u4e00\u4e2a\u6d4b\u8bd5\u70b9\uff08\n\n\u4ee5\u4e0b\u662f\u5b8c\u6574\u4ee3\u7801:\n\n```c\n#include <stdio.h>\n\nchar pc_buf[30000000], *pc_p= pc_buf;\n#define pc(c) *pc_p++= c;\n\nvoid write(int x) {\n    static int sta[9];\n    register int top= 0;\n    do { sta[++top]= x % 10, x/= 10; } while(x);\n    while(top) pc(sta[top--] ^ 48);\n}\n\nint inv(int a,int m){\n    register int x=1,y=0,q=0,mod=m;\n    while(1){\n        if(m) y-=q*x,q=a/m,a-=q*m;\n        else return a==1? (x<0? (x+mod)%mod : x) : 0;\n        if(a) x-=q*y,q=m/a,m-=q*a;\n        else return m==1? (y<0? (y+mod)%mod : y) : 0;\n    }\n}\nint main(){\n    int n,p;\n    scanf(\"%d %d\",&n,&p);\n    for(register int i=1;i<=n;i++)\n        write(inv(i,p)),pc('\\n');\n    fwrite(pc_buf,1,pc_p-pc_buf,stdout);\n    return 0;\n}   \n```\n\n\u6c42\u9006\u5143\u4ee3\u7801:\n\n```c\nint inv(int a,int m){\n    int x=1,y=0,q=0,mod=m;\n    while(1){\n        if(m) y-=q*x,q=a/m,a-=q*m;\n        else return a==1? (x<0? (x+mod)%mod : x) : 0;\n        if(a) x-=q*y,q=m/a,m-=q*a;\n        else return m==1? (y<0? (y+mod)%mod : y) : 0;\n    }\n}\n```\n\n\u5b8c\u6574\u7684\u9012\u63a8\u6269\u6b27\u4ee3\u7801:\n\n```c\nint gcdEx(int a,int b,int *x,int *y){\n    *x=1,*y=0;\n    int q=0,A=a,B=b;\n    while(1){\n        if(b) *y=*y-q**x,q=a/b,a-=q*b;\n        else {\n            *y=(a-A**x)/B;\n            return a;\n        }\n        if(a) *x=*x-q**y,q=b/a,b-=q*a;\n        else {\n            *x=*y;\n            *y=(b-A**x)/B;\n            return b; \n        }\n    }\n}\n```\n\n\u5176\u5c3e\u9012\u5f52\u5f62\u5f0f:\n\n```c\nint gcdExr(int A,int B,int *x,int *y){\n    int gcdExi(int a,int b,int q,int c,int d){\n        if(b==0){\n            *x=d,*y=(a-A*d)/B;\n            return a;\n        }\n        return gcdExi(b,a%b,a/b,d,c-q*d);\n    }\n    return gcdExi(A,B,0,0,1);\n}\n```\n",
        "postTime": 1574139154,
        "uid": 23420,
        "name": "Rumia",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "## \u4e58\u6cd5\u9006\u5143\n\u5b9a\u4e49\uff1a\u82e5\u6574\u6570$b$\uff0c$p$\u4e92\u8d28\uff0c\u5e76\u4e14$b|a$\uff0c\u5219\u5b58\u5728\u4e00\u4e2a\u6574\u6570$x$\uff0c\u4f7f\u5f97$a/b=ax(mod p)$\u3002\u79f0x\u4e3ab\u7684\u6a21$p$\u4e58\u6cd5\u9006\u5143\uff0c\u8bb0\u4e3a$b^{-1} (mod p$)\u3002\uff08\u5b9a\u4e49\u6765\u81ea\u300a\u4fe1\u606f\u5b66\u5965\u8d5b\u4e00\u672c\u901a\u63d0\u9ad8\u7bc7\u300b\uff09\n\n------------\n\n## \u6c42\u6cd5\n\u90a3\u4e48\u8be5\u5982\u4f55\u6c42\u51fa\u8fd9\u4e2ax\u5462?\n\n\u2460\n- \u7531\u5b9a\u4e49\uff0c$a/b=ax(mod\\ p)$\n- \u4e24\u8fb9\u540c\u65f6\u4e58$b/a$\uff0c\u5f97$1=bx(mod\\ p)$\n- \u5219$bx=1(mod\\ p)$\n\n\u8fd9\u4e2a\u540c\u4f59\u65b9\u7a0b\u53ef\u4ee5\u8f6c\u5316\u4e3a\u4e0d\u5b9a\u65b9\u7a0b$bx+py=1$\uff08\u5047\u8bbe$bx=-yp+1$\uff09\uff0c\u800c$b$\u4e0e$p$\u53c8\u4e92\u8d28\uff0c\u5373$gcd(b,p)=1$\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u6c42\u51fa$x$\u3002\n\n\u2461\n- \u8d39\u9a6c\u5c0f\u5b9a\u7406\uff1a$a^p=a(mod\\ p)$   \uff08p\u4e3a\u8d28\u6570\uff09\n- \u82e5$p$\u4e3a\u8d28\u6570\uff0c\u5219$b^p=b(mod\\ p)$\n- \u4e24\u8fb9\u540c\u65f6\u9664\u4ee5$b$\uff0c\u5f97$b^{p-1}=1(mod\\ p)$\n- \u4e24\u8fb9\u540c\u65f6\u4e58$a$\uff0c\u5f97$a=a*b^{p-1} (mod\\ p)$\n- \u4e24\u8fb9\u540c\u65f6\u9664\u4ee5b\uff0c\u5f97$a/b=a*b^{p-2} (mod\\ p)$\n- \u7531\u5b9a\u4e49\uff0c\u6b64\u65f6$x=b^{p-2}$\n\n\u5219\u76f4\u63a5\u6c42\u51fa$b^{p-2}$\u5373\u53ef\n\n\u2462\uff08\u6765\u81ea\u300a\u4fe1\u606f\u5b66\u5965\u8d5b\u6570\u5b66\u4e00\u672c\u901a\u300b\uff09\n- $1^{-1}=1(mod p)$\n- \u8bbe$p=k*i+r$,$r<i$,$l<i<p$\uff0c\u5c06\u6b64\u5f0f\u653e\u5230$mod\\ p$\u610f\u4e49\u4e0b\u4f1a\u5f97\u5230\uff1a$ki+r=0(mod\\ p)$\n- \u4e24\u8fb9\u540c\u65f6\u4e58$i^{-1}$\uff0c$r^{-1}$\uff0c\u53ef\u5f97\uff1a\n- $k*r^{-1}+i^{-1}=0 (mod\\ p)$\n- $i^{-1}=-k*r^{-1} (mod\\ p)$\n- $i^{-1}=-[p/i]*(p\\ mod\\ i)^{-1} (mod\\ p)$\n\n\u7531\u6b64\uff0c\u5047\u8bbe$A[i]$\u8868\u793ai\u7684\u9006\u5143\uff0c\u5219$A[i]=-[p/i]*A[p\\ mod\\ i]$\u3002\n\n------------\n\n### P3811 \u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\n\u2460 \u672c\u9898\u4fdd\u8bc1\u4e86$p$\u662f\u8d28\u6570\uff0c\u90a3\u4e48\u76f4\u63a5\u5c31\u53ef\u4ee5\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u6c42\u51fa$ix+py=1$\u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3x\u5373\u53ef\u3002$(1<=i<=n)$\n#### \u2460\u4ee3\u7801\n\uff08\u8d85\u65f6\uff0c48\u5206\uff09\n```cpp\n#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n,p;\n\nvoid Exgcd(int a,int b,int& d,int& x,int& y) {\n\tif(b==0) {\n\t\td=a;\n\t\tx=1;\n\t\ty=0;\n\t}\n\telse {\n\t\tExgcd(b,a%b,d,x,y);\n\t\tint t=x;\n\t\tx=y;\n\t\ty=t-a/b*y;\n\t}\n}\n\nint main() {\n\tcin>>n>>p;\n\t\n\tfor(int i=1;i<=n;i++) {\n\t\tint d,x,y;\n\t\tExgcd(i,p,d,x,y);\n\t\tcout<<((x%p)+p)%p<<endl;\n\t}\n\t\n\treturn 0;\n}\n```\n\n------------\n\n\u2461\u4fdd\u8bc1p\u662f\u8d28\u6570\u4e86\uff0c\u76f4\u63a5\u5229\u7528\u5feb\u901f\u5e42\u6c42\u51fai^(p-2)\u5373\u53ef\uff0c\u6c42\u7684\u8fc7\u7a0b\u4e2d\u6ce8\u610f\u53d6\u6a21p\n#### \u2461\u4ee3\u7801\n\uff08\u8d85\u65f6\uff0c48\u5206\uff09\n```cpp\n#include<bits/stdc++.h>\n\nusing namespace std;\n\nlong long n,p;\n\nlong long quickpow(long long x,long long y) {\n\tif(y==0) return 1;\n\tlong long t=quickpow(x,y/2)%p;\n\tif(y%2) return (t*t*x)%p;\n\telse return (t*t)%p;\n}\n\nint main() {\n\tcin>>n>>p;\n\t\n\tfor(int i=1;i<=n;i++) cout<<quickpow(i,p-2)<<endl;\n\t\n\treturn 0;\n}\n```\n\n------------\n\u2462\u521d\u59cb\u5316$A[1]=1$\uff0c\u7136\u540e\u9012\u63a8\u6c42\u89e3\u5373\u53ef\n\n\u8fd9\u9053\u9898\u5f88\u80fd\u4f53\u73b0cout\u548cprintf\u7684\u901f\u5ea6\uff0c\u4e00\u5f00\u59cb\u6211\u7528\u7684cout\u8f93\u51fa\u7ed3\u679c\u8d85\u65f664\u5206\uff0c\u6539\u4e3aprintf\u5c31\u6ee1\u5206\u4e86\n\n\uff08\u6ee1\u5206\uff09\n```cpp\n#include<bits/stdc++.h>\n\nusing namespace std;\n\nint n,p;\nlong long a[3000010];\n\nint main() {\n\tcin>>n>>p;\n\t\n\ta[1]=1;\n\tfor(int i=2;i<=n;i++) {\n\t\ta[i]=-(p/i)*a[p%i];\n\t\tif(a[i]<0) a[i]=a[i]%p+p;\n\t}\n\t\n\tfor(int i=1;i<=n;i++) printf(\"%d\\n\",a[i]);\n\t\n\treturn 0;\n}\n```\n\n------------\n\n\n## \u603b\u7ed3\n\u4e58\u6cd5\u9006\u5143\u7684\u7528\u5904\u5728\u54ea\u5462\uff1f\n\n\u5f53\u5728\u9898\u76ee\u4e2d\u9047\u5230\u4e86$a/b$\u8fd9\u6837\u7684\u9664\u6cd5\u7b97\u5f0f\u8981\u6c42\u5bf9p\u53d6\u6a21\u65f6\uff0c\u53ef\u4ee5\u5148\u5c06$a$\uff0c$b$\u5206\u522b\u5bf9$p$\u53d6\u6a21\uff0c\u7136\u540e\u518d\u8ba1\u7b97\u51fa$b^{-1}$\uff0c\u90a3\u4e48$(a/b)\\ mod \\ p$\u5c31\u53ef\u4ee5\u8f6c\u5316\u4e3a$(a*b^{-1})\\ mod\\ p$\uff0c\u4f5c\u4e3a\u6700\u540e\u7684\u7ed3\u679c\uff0c\u4f46\u524d\u63d0\u6761\u4ef6\u662f$b$\u4e0e$p$\u4e92\u8d28\u3002",
        "postTime": 1566142802,
        "uid": 71936,
        "name": "HoshiuZ",
        "ccfLevel": 6,
        "title": "\u4e58\u6cd5\u9006\u5143"
    },
    {
        "content": "[\u9898\u76ee](https://www.luogu.org/problem/P3811)\n\n\u7ebf\u6027\u9012\u63a8\u9006\u5143\u6ca1\u5fc5\u8981\u8fd9\u4e48\u590d\u6742\u5427......\n\n**\u3010\u5206\u6790\u3011**\n---\n\n\u8bbe$Inv_i$ \u4e3a $i$ \u7684\u9006\u5143\uff0c $Fac_i$ \u8868\u793a\u5728\u819c $p$ \u610f\u4e49\u4e0b\u7684 $i!$ \uff0c$InFac_i$ \u4e3a $Fac_i$ \u7684\u9006\u5143\n\n\u7531\u4e8e $n<p,p\\in prime$ \uff0c\u6240\u4ee5 $Fac_1$ ~ $Fac_n$ \u80af\u5b9a\u662f\u53ef\u4ee5\u9012\u63a8\u7684\n\n\u516c\u5f0f\uff1a $Fac_i=Fac_{i-1}\\times i\\% p,Fac_0=1$\n\n\u5176\u6b21\uff0c\u6839\u636e\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff0c\u6613\u5f97\uff1a\n\n${Fac_n}^{p-1}\\equiv 1(\\mod p)$\n\n\u53c8$\\ \\because\\quad InFac_n\\times Fac_n\\equiv 1(\\mod p)$\n\n$\\therefore InFac_n={Fac_n}^{p-2}\\%p$\n\n\u7528\u5feb\u901f\u5e42\u7b97\u51fa $InFac_n$ \uff0c\u5c31\u53ef\u4ee5\u9012\u63a8\u51fa $InFac_1$ ~ $InFac_n$ \u4e86\n\n\u516c\u5f0f\uff1a$InFac_i={Fac_i}^{-1}=[Fac_{i+1}\\times (i+1)^{-1}]^{-1}={Fac_{i+1}}^{-1}\\times (i+1)$\n\n\u5373\uff1a$InFac_i=InFac_{i+1}\\times (i+1)\\% p$\n\n\u6545 $Inv_i=i^{-1}=[i!\\times{(i-1)!}^{-1}]^{-1}={i!}^{-1}\\times (i-1)!$\n\n\u5373 $Inv_i=InFac_i\\times Fac_{i-1}\\% p$\n\n\u7b2c\u4e00\u6b21\u63a8 $Fac_i$ \u662f $O(n)$ \u7684\n\n\u7b2c\u4e8c\u6b21\u7b97 $InFac_n$ \u662f $O(\\log p)$ \u7684\n\n\u7b2c\u4e09\u6b21\u63a8 $InFac_i$ \u662f $O(n)$ \u7684\n\n\u7b2c\u56db\u6b21\u63a8 $Inv_i$ \u4e5f\u662f $O(n)$ \u7684\n\n\u603b\u590d\u6742\u5ea6\u4e3a $O(n)+O(\\log p)+O(n)+O(n)=O(n)$\n\n---\n\n**\u3010\u4ee3\u7801\u3011**\n---\n\n\u90a3\u672c\u849f\u84bb\u5c31\u653e  ~~\u6211\u7801\u98ce\u6781\u4e11\u7684~~  \u4ee3\u7801\u4e86\n\n```cpp\n#include<cstdio>\nusing namespace std;\n#define f(a,b,c,d) for(register int a=b,c=d;a<=c;a++)\n#define g(a,b,c,d) for(register int a=b,c=d;a>=c;a--)\ntypedef long long int i64;\nconst i64 MAXN=3000010;\ntypedef i64 ar[MAXN];\ni64 d_N,d_P;\nar ar_d_Fac,ar_d_InFac;\n\ninline i64 pow(i64 a,i64 x,i64 MOD){\n    i64 d_Ans=1;\n    while(x){\n        if(x&1) d_Ans=d_Ans*a%MOD;\n        x>>=1;\n        a=a*a%MOD;\n    }\n    return d_Ans;\n}\n\nint main(){\n    scanf(\"%lld %lld\",&d_N,&d_P);\n    ar_d_Fac[0]=1;\n    f(i,1,I,d_N) ar_d_Fac[i]=ar_d_Fac[i-1]*i%d_P;\n    ar_d_InFac[d_N]=pow(ar_d_Fac[d_N],d_P-2,d_P);\n    g(i,d_N-1,I,0) ar_d_InFac[i]=ar_d_InFac[i+1]*(i+1)%d_P;\n    f(i,1,I,d_N) printf(\"%lld\\n\",ar_d_InFac[i]*ar_d_Fac[i-1]%d_P);\n    return 0;\n}\n```\n\n\u6700\u540e\u5b89\u5229\u4e00\u4e0b [\u672c\u849f\u84bb\u7684\u535a\u5ba2](https://www.luogu.org/blog/JustinRochester/)",
        "postTime": 1565504734,
        "uid": 36031,
        "name": "JustinRochester",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "\u5173\u4e8e\u8fd9\u9053\u9898\uff0c\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u6c42\u9006\u5143\u7684\u6a21\u677f\u9898\uff0c\u5e38\u89c1\u7684\u6709\u4e09\u79cd\u65b9\u6cd5\uff0c\u5728\u8fd9\u91cc\u53ea\u4ecb\u7ecd\u4e24\u79cd\u65b9\u6cd5\uff1a\n\n1.\u8d39\u9a6c\u5c0f\u5b9a\u7406+\u5feb\u901f\u5e42\uff08\u80fd\u6c3464\u5206\uff09\n\n\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff1a\u82e5p\u4e3a\u7d20\u6570\uff0ca\u4e3a\u6b63\u6574\u6570\uff0c\u4e14a\u3001p\u4e92\u8d28\u3002 \n\n\u5219\u6709a^(p\u22121)\u22611(mod p)\n\n\u53c8\u56e0\u4e3aa* a\u7684\u9006\u5143\uff08w\uff09\u7b49\u4e8e1\uff0c\u6240\u4ee5a^(p\u22121)\u2261a* w\uff08mod p\uff09\n\n\u6545w\u5728\u6a21p\u610f\u4e49\u4e0b\u662f\u7b49\u4e8ea^(p-2)\u7684\uff08\u8bb0\u4f4f\u5c31\u597d\uff09\n\n\u6240\u4ee5\u95ee\u9898\u5c31\u8f6c\u5316\u6210\u4e86\u6c42a^(p-2)\uff0c\u6211\u4eec\u5c31\u8054\u60f3\u5230\u4e86\u5feb\u901f\u5e42\uff08\u5982\u679c\u4e0d\u77e5\u9053\u4ec0\u4e48\u662f\u5feb\u901f\u5e42\uff0c\u6211\u4e5f\u6ca1\u62db\uff09\n\n\u8fd9\u4e2a\u7b97\u6cd5\u7531\u4e8e\u5feb\u901f\u5e42\u7684\u4f18\u5316\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u8fd8\u662f\u6bd4\u8f83\u53ef\u89c2\u7684\uff0c\u57fa\u672c\u53ef\u4ee5\u7a33\u5b9a\u5728\uff08nlogn\uff09\n\n\u9644\u4e0a\u8be5\u65b9\u6cd5\u7684\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\nusing namespace std;\nlong long p;\nlong long qpow(long long x,long long y)\n{\n    long long ans=1;\n    while(y!=0)\n    {\n        if(y&1)\n        {\n            ans=((ans%p)*(x%p))%p;\n        }\n        x=((x%p)*(x%p))%p;\n        y>>=1;\n    }\n    return ans;\n}\nint main()\n{\n    long long n;\n    scanf(\"%lld%lld\",&n,&p);\n    for(register int i=1;i<=n;i++)\n    {\n        printf(\"%lld\\n\",(qpow(i,p-2))%p);\n    }\n    return 0;\n}\n```\n\n2.\u7ebf\u6027\u9012\u63a8\uff08100\u5206O\uff08n\uff09\u7684\u795e\u7ea7\u7b97\u6cd5\uff09\n\n\u4ee4 p=ki+r k=\u230ap/i\u200b\u230b,r=p mod i (i<p,k<p,r<i)\n\n\u90a3\u4e48\u663e\u7136 ki+r\u22610\uff08mod p\uff09\u3000\u3000\n\n\u6211\u4eec\u5c06\u5de6\u53f3\u540c\u65f6\u4e58\u4ee5i\u548cr\u7684\u9006\u5143\u5373\u53ef\u5f97\u5230\n\nk\u2217r^\u22121+i^\u22121\u22610(modp)\n\ni^\u22121\u2261\u2212k\u2217r^\u22121(modp)\n\n\u4ee3\u5165k\u548cr\n\ni^\u22121\u2261\u2212\u230ap/i\u230b\u2217(p mod i)^-1   (modp)\n\n\u7531\u4e8e\u9006\u5143\u4e00\u5b9a\u662f\u6574\u6570\uff0c\u90a3\u4e48\u6211\u4eec\u5728\u7b49\u5f0f\u5de6\u53f3\u540c\u65f6\u4e58\u4ee5(p mod i)^-1\u500d\u7684p\uff0c\u7531\u4e8e\u5728\u6a21p\u610f\u4e49\u4e0b\uff0c\u7b49\u5f0f\u4f9d\u7136\u6210\u7acb\n\n\u6700\u7ec8\u72b6\u6001\uff1a\n\ninv[i] = (p - p / i) * inv[p % i] % p;\uff08inv\u6307\u9006\u5143\uff09\n\n\u9644\u4e0a\u672c\u7b97\u6cd5\u7684\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\nusing namespace std;\nlong long p,c[3000005];\nint main()\n{\n    long long n;\n    scanf(\"%lld%lld\",&n,&p);\n    c[1]=1;\n    printf(\"1\\n\");\n    for(register int i=2; i<=n; i++)\n    {\n        c[i]=(p-p/i)*c[p%i]%p;\n        printf(\"%lld\\n\",c[i]);\n    }\n    return 0;\n}\n```\n\n\u770b\u4f3c\u7b2c\u4e8c\u79cd\u7b97\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6\u5341\u5206\u53ef\u89c2\uff0c\u4f46\u662f\u9012\u63a8\u7b97\u6cd5\u6bd5\u7adf\u6709\u5b83\u7684\u5c40\u9650\u6027\uff0c\u5982\u679c\u8ba1\u7b97\u5927\u6570\u636e\u5c31\u4f1a\u7206\u7a7a\u95f4\uff0c\u5982\u679c\u4e0d\u5f00\u6570\u7ec4\u5c31\u4f1a\u8017\u8d39\u5927\u91cf\u7684\u65f6\u95f4\uff0c\u8003\u573a\u4e0a\u8fd8\u662f\u8981\u9009\u62e9\u9002\u5408\u7684\u8fdb\u884c\u4f7f\u7528\u561e\uff01\uff01",
        "postTime": 1550400653,
        "uid": 133227,
        "name": "\u4e8e\u4e30\u6797",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "# \u5b9a\u4e49\n\n\u5728  mod p\u7684\u610f\u4e49\u4e0b\u6211\u4eec\u628a xx \u7684\u4e58\u6cd5\u9006\u5143\u5199\u4f5c x ^ {-1}x\n\n\u4e58\u6cd5\u9006\u5143\u6709\u5982\u4e0b\u7684\u6027\u8d28\uff1a\n\n![](https://img-blog.csdn.net/20161115133003092)\n\n\u4e58\u6cd5\u9006\u5143\u7684\u4e00\u5927\u5e94\u7528\u662f\u6a21\u610f\u4e49\u4e0b\u7684\u9664\u6cd5\uff0c\u9664\u6cd5\u5728\u6a21\u610f\u4e49\u4e0b\u5e76\u4e0d\u662f\u5c01\u95ed\u7684\uff0c\u4f46\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u4e0a\u8ff0\u516c\u5f0f\uff0c\u5c06\u5176\u8f6c\u5316\u4e3a\u4e58\u6cd5\u3002\n\n![](https://img-blog.csdn.net/20161115133024514)\n\n# \u89e3\u6cd5\u4e00\uff1a\u3010\u6269\u5c55\u7684\u6b27\u51e0\u91cc\u5f97\uff08exgcd\uff09\u3011\n\n## \u6c42\u5355\u4e2a\u6570\u7684\u4e58\u6cd5\u9006\u5143\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO\uff08log N\uff09\n\n![](https://img-blog.csdn.net/20161115133307705)\n\u7684\u4e00\u7ec4\u6574\u6570\u89e3\n\n\u5f53 b \u4e3a\u7d20\u6570\u65f6\uff0cgcd(a,b)=1  gcd(a,b)=1\uff0c\u6b64\u65f6\u6709\n\n![](https://img-blog.csdn.net/20161115133427062)\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nint n,p;\nint exgcd (ll a,ll b,ll &x,ll &y)\n{\n    if(b==0)\n    {\n        x=1;\n        y=0;\n        return a;\n    }\n    int r=exgcd (b,a%b,x,y);\n    int tmp=x;\n    x=y;\n    y=tmp-a/b*y;\n    return r;\n}\nint main()\n{\n    scanf (\"%d%d\",&n,&p);\n    for (int i=1;i<=n;i++)\n    {\n        ll x,y;\n        exgcd (i,p,x,y);\n        x=(x+p)%p;\n        printf (\"%d\\n\",x);\n    }\n    return 0;\n}\n```\n\n# \u89e3\u6cd5\u4e8c\uff1a\u3010\u7ebf\u6027\u9012\u63a8\u6cd5\u3011\n\n## \u5728\u6c42\u4e00\u4e2a\u5e8f\u5217\u6240\u6709\u9006\u5143\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO\uff08N\uff09\n\n![](https://img-blog.csdn.net/20161115133621303)\n\n\n![](https://cdn.luogu.com.cn/upload/pic/19724.png)\n\n\n\u4ee5\u4e0a\u6458\u81ea[\u4e58\u6cd5\u9006\u5143\u7684\u51e0\u79cd\u8ba1\u7b97\u65b9\u6cd5](https://blog.csdn.net/rain722/article/details/53170288)\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nint inv[3000010];\nint n,p;\nint main()\n{\n\tscanf (\"%d%d\",&n,&p);\n\tinv[1]=1;  \n\tfor (int i=2;i<=n;i++)\n\t\tinv[i]=(ll)(p-p/i)*inv[p%i]%p;\n\tfor (int i=1;i<=n;i++)\n\t\tprintf (\"%d\\n\",inv[i]);\n\treturn 0;\n}\n```",
        "postTime": 1526892858,
        "uid": 24024,
        "name": "Paul\u00b7Shi",
        "ccfLevel": 0,
        "title": "\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143"
    },
    {
        "content": "\u611f\u89c9\u8fd9\u9053\u9898\u7528\u9636\u4e58\u505a\u633a\u5de7\u5999\u7684\uff0c\u6240\u4ee5\u8bf4\u51b3\u5b9a\u6c34\u4e00\u53d1\uff1a\n\n\n\u8bbe$f(i) = i!\\ mod\\ p$ , $g(i) = i!^{-1}\\ mod\\ p$\n\n\n$g(i) = g(i+1) * (i+1) $\n\n\n$i^{-1} = f(i-1) * g(i)$\n\n\n\u7b97\u51fa$f_n$\u7136\u540e\u6c42\u51fa$f_n$\u7684\u9006\u5143$g_n$\uff0c\u9012\u63a8\u5373\u53ef\u3002\n\n\n\u987a\u4fbf\u5ba3\u4f20\u4e00\u6ce2[\u535a\u5ba2](http://blog.csdn.net/charlie\\_jilei/article/details/77122700)\n\n\n\u4ee3\u7801\uff1a\n\n```cpp\n\n#include<cstdio>\n#include<iostream>\nusing namespace std;\nint mi[3000010];\nint n,p;\nint anss[3000100],g;\nint fast_pow(int a,int x)\n{\n    int ans=1;\n    for (;x;x>>=1,a=(1ll*a*a)%p)\n        if (x&1) ans=(1ll*ans*a)%p;\n    return ans;\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&p);\n    mi[0]=1; \n    for (int i=1;i<=n;i++)\n        mi[i]=(1ll*mi[i-1]*i)%p;\n    g=fast_pow(mi[n],p-2);\n    anss[n]=(1ll*g*mi[n-1])%p;\n    for (int i=n-1;i;i--)\n    {\n        g=(1ll*g*(i+1))%p;\n        anss[i]=(1ll*g*mi[i-1])%p;\n    }\n    for (int i=1;i<=n;i++)\n        printf(\"%d\\n\",anss[i]);\n}\n```",
        "postTime": 1509632593,
        "uid": 17800,
        "name": "Fizzmy",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "\u53ef\u4ee5\u5012\u7740\u6765\u3002\n\n\u5148\u6c42\u51fan\uff01\u7684\u9006\u5143\uff08\u7528\u5feb\u901f\u5e42\u6216\u6269\u6b27\uff09\uff0c\u5229\u7528((k-1)!)^-1\u2261k\u00b7(k!)^-1 (mod p)\uff0c\u63a8\u51fa\uff08n-1\uff09\uff01~1\uff01\u7684\u9006\u5143\uff0c\u518d\u5229\u7528k^-1\u2261(k-1)!\u00b7(k!)^-1 (mod p),\u6c42\u51fa\u6bcf\u4e2a\u6570\u7684\u9006\u5143\u4e86\n",
        "postTime": 1500290041,
        "uid": 23623,
        "name": "ASC_8384",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    },
    {
        "content": "\u6269\u6b27\u7a33\u8fc7\u4e0d\u7528\u4f18\u5316\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\nint exgcd(int a,int b,int &x,int &y)\n{\n    if(a==0) {x=0;y=1;return b;}\n    else\n    {\n      int tx,ty;\n      int d=exgcd(b%a,a,tx,ty);\n      x=ty-(b/a)*tx;\n      y=tx;\n      return d;\n    }\n}\nint main()\n{\n    int n,p;scanf(\"%d%d\",&n,&p);\n    for(int i=1;i<=n;i++)\n      {\n        int x,y;\n        exgcd(i,p,x,y);\n        while(x<0) x+=p;\n        printf(\"%d\\n\",x);\n      }\n    return 0;\n}\n```",
        "postTime": 1510220216,
        "uid": 53712,
        "name": "orange1287",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3811 \u3010\u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143\u3011"
    }
]
[
    {
        "content": "\u672c\u9898\u6ca1\u6709\u5267\u60c5\u7248\u9898\u89e3qwq\n\n\u53ef\u8bfb\u9898\u9762\uff1a\n\n\u6c42\u6240\u6709n\u4e2a\u70b9\u5e26\u6807\u53f7\u5f3a\u8fde\u901a\u7ade\u8d5b\u56fe\u4e2d\u54c8\u5bc6\u987f\u56de\u8def\u6570\u91cf\u7684\u5e73\u5747\u503c\n\n\u89e3\u6cd50\uff1a\n\n\u6837\u4f8b\u600e\u4e48\u5168\u662f1\u548c-1\u554a\n\n\u6211```if(i==2)puts(\"-1\");else puts(\"1\");```\u543c\u4e0d\u543c\u554a\n\n\u671f\u671b\u5f97\u52060\u5206\uff0c\u5b9e\u9645\u5f97\u52060\u5206\n\n\u89e3\u6cd51\uff1a\n\n\u6211\u4f1a\u679a\u4e3e\uff01\n\n\u679a\u4e3e\u6240\u6709n\u4e2a\u70b9\u7684\u7ade\u8d5b\u56fe\uff0c\u7edf\u8ba1\u7b54\u6848\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(2^{C(n,2)}n!)$\uff0c\u671f\u671b\u5f97\u520612\u5206\uff0c\u5b9e\u9645\u5f97\u52068~12\u5206\n\n\u89e3\u6cd52\uff1a\n\n\u6211\u4f1a\u526a\u679d\uff01\n\n\u5728\u89e3\u6cd51\u7684\u57fa\u7840\u4e0a\u52a0\u4e00\u4e9b\u7384\u5b66\u526a\u679d\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O($\u7384\u5b66$)$\uff0c\u671f\u671b\u5f97\u520624\u5206\uff0c\u5b9e\u9645\u5f97\u520612~24\u5206\n\n\u89e3\u6cd53\uff1a\n\n\u6211\u4f1a\u6253\u8868\uff01\n\n\u7528\u89e3\u6cd51\u5728\u81ea\u5df1\u7535\u8111\u4e0a\u591a\u8dd1\u4e00\u4f1a\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u540c\u89e3\u6cd51\uff0c\u671f\u671b\u5f97\u520624\u5206\uff0c\u5b9e\u9645\u5f97\u520612~16\u5206\n\n8\u7684\u60c5\u51b5\u5728\u6211\u7684\u7535\u8111\u4e0a\u8981\u8dd13\u5929QWQ\n\n\u89e3\u6cd54\uff1a\n\n\u6211\u4f1adp\uff01\n\n\u8003\u8651\u6240\u6709n\u4e2a\u70b9\u7684\u7ade\u8d5b\u56fe\u4e2d\u54c8\u5bc6\u987f\u56de\u8def\u7684\u603b\u6570\uff0c\u53d1\u73b0\u5f88\u597d\u6c42\uff0c\u7b54\u6848\u4e3a$\\frac{n!}{n}\\cdot 2^{C(n,2)-n}$\uff08\u4e00\u5171\u6709$\\frac{n!}{n}$\u79cd\u54c8\u5bc6\u987f\u56de\u8def\uff0c\u6bcf\u79cd\u54c8\u5bc6\u987f\u56de\u8def\u51fa\u73b0\u5728$2^{C(n,2)-n}$\u79cd\u7ade\u8d5b\u56fe\u91cc\uff09\n\n\u4e8e\u662f\u95ee\u9898\u8f6c\u5316\u4e3a\u4e86\u6c42\u5f3a\u8fde\u901a\u7ade\u8d5b\u56fe\u7684\u6570\u91cf$f[n]$\n\n\u968f\u4fbf\u63a8\u4e00\u63a8\u5f0f\u5b50\uff0c\u53d1\u73b0$f[n]=2^{C(n,2)}-\\sum_{i=1}^{n-1}{f[i]\\cdot C(n,i)\\cdot 2^{C(n-i,2)}}$\uff08\u603b\u7ade\u8d5b\u56fe\u6570\u51cf\u53bb\u4e0d\u5f3a\u8054\u901a\u7684\u7ade\u8d5b\u56fe\u6570\uff09\n\n\uff08\u7edf\u8ba1\u4e0d\u5f3a\u8fde\u901a\u7684\u7ade\u8d5b\u56fe\u6570\u65f6\u53ef\u4ee5\u679a\u4e3e\u62d3\u6251\u5e8f\u6700\u5c0f\u7684\u5f3a\u8fde\u901a\u5206\u91cf\uff0c\u5269\u4e0b\u7684\u8fb9\u968f\u4fbf\u8fde\uff0c\u5c31\u51fa\u73b0\u4e0a\u9762\u7684\u5f0f\u5b50\u5566$QwQ$\uff09\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n^2)$\uff0c\u671f\u671b\u5f97\u520664\u5206\uff0c\u5b9e\u9645\u5f97\u520652~64\u5206\n\nFAQ\uff1a\u4e3a\u4ec0\u4e48\u6211\u53ea\u5f97\u4e8652\u5206\uff1f\n\nA\uff1a\u60f3\u5230\u6b63\u89e3\u4e0d\u9884\u5904\u7406\u4e0d\u8fd8\u662f$O(n^2log(n))$\uff08facepalm\uff09\n\n\u89e3\u6cd55\uff1a\n\n\u6211\u4f1a\u5206\u6cbbfft/\u591a\u9879\u5f0f\u6c42\u9006\uff01\n\n\u4f18\u5316\u4e00\u4e0b\u4e0a\u9762\u7684\u8fc7\u7a0b\u5c31\u597d\u5566\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(nlog^2(n))$\u6216$O(nlog(n))$\uff0c\u671f\u671b\u5f97\u5206100\u5206\uff0c\u5b9e\u9645\u5f97\u5206100\u5206\n\nFAQ\uff1a\u4e3a\u4ec0\u4e48\u6211\u5199\u4e86\u6b63\u89e3\u53ea\u5f97\u4e8676\u5206\n\nA\uff1a\u4f60\u5f88\u53ef\u80fd\u6ca1\u5f00long long\u3002\u3002",
        "postTime": 1518669896,
        "uid": 3346,
        "name": "oscar",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4233 \u3010\u5c04\u547d\u4e38\u6587\u7684\u7b14\u8bb0\u3011"
    },
    {
        "content": "### \u524d\u8a00\n\n\u4f3c\u4e4e\u53c8\u662f\u9053\u4e0d\u9519\u7684 Symbolic Method \u7ec3\u4e60\u9898\uff1f\n\n\u5927\u529b\u5ba3\u4f20\u4e00\u4e0b[\u7b26\u53f7\u5316\u65b9\u6cd5](https://xyix.github.io/posts/?postname=combinatorics)\uff0c\u4f7f\u7528\u8fd9\u4e00\u65b9\u6cd5\u53ef\u4ee5\u79d2\u6389\u8bb8\u591a\u56f0\u96be\u7684\u6570\u6570\u9898\u3002\n\n### \u601d\u8def\n\n\u4e0d\u662f\u8ba9\u4f60\u6c42\u671f\u671b\u5417\uff1f\u76f4\u63a5\u6c42\u6bd4\u503c\u5373\u53ef\u3002\n\n\u6ce8\u610f\u5bf9 $i=1,2$ \u7684\u60c5\u51b5\u7279\u5224\u3002\n\n#### \u5206\u5b50\n\n\u5373\u7ade\u8d5b\u56fe\u54c8\u5bc6\u987f\u56de\u8def\u8ba1\u6570\u3002\n\n\u4e0d\u59a8\u94a6\u5b9a $1$ \u4e3a\u8d77\u70b9\uff0c\u7136\u540e\u76f4\u63a5\u679a\u4e3e\u63a5\u4e0b\u6765\u7684\u8def\u5f84\u4e2d $n-1$ \u4e2a\u70b9\uff0c\u6700\u540e\u8fde\u56de\u8d77\u70b9\u3002\n\n\u7136\u540e\u76f4\u63a5\u628a\u5269\u4e0b ${n(n-1)\\over2}-n$ \u6761\u8fb9\u4efb\u610f\u5b9a\u5411\u3002\n\n\u5373\uff0c\u603b\u54c8\u5bc6\u987f\u56de\u8def\u6570\u4e3a $(n-1)!2^{{n(n-1)\\over2}-n}$\u3002\n\n#### \u5206\u6bcd\n\n\u4e00\u4e2a\u7ed3\u8bba\uff1a\u7ade\u8d5b\u56fe\u7f29\u70b9\u540e\u4f1a\u53d8\u6210\u4e00\u6761\u94fe\u72b6 DAG\uff0c\u5176\u4e2d\u6bcf\u4e2a\u70b9\u5f80\u5176\u540e\u7684**\u6240\u6709**\u70b9\u5f15\u51fa\u4e00\u6761\u8fb9\u3002\n\n\u53e6\u4e00\u4e2a\u7ed3\u8bba\uff1a\u7ade\u8d5b\u56fe\u6709\u54c8\u5bc6\u987f\u56de\u8def\u7b49\u4ef7\u4e8e\u5176\u5f3a\u8fde\u901a\uff0c\u5373\u53ef\u4ee5\u7f29\u6210\u5355\u4e2a\u70b9\u3002\n\n\u6211\u4eec\u8bb0 $\\mathcal T$ \u8868\u793a\u5e26\u6807\u53f7\u5f3a\u8fde\u901a\u7ade\u8d5b\u56fe\u6240\u5bf9\u5e94\u7684\u7ec4\u5408\u7c7b\uff0c\u8bb0 $\\mathcal U$ \u8868\u793a\u5e26\u6807\u53f7\u7ade\u8d5b\u56fe\u6240\u5bf9\u5e94\u7684\u7ec4\u5408\u7c7b\u3002\n\n\u7acb\u523b\u7531\u7ed3\u8bba\u5f97\u5230\uff1a\n\n$$\\mathcal U=\\operatorname{SEQ}(\\mathcal T)$$\n\n\u5176\u4e2d $\\operatorname{SEQ}$ \u8868\u793a**\u5e26\u6807\u53f7 Sequence \u6784\u9020**\u3002\n\n\u4e8e\u662f\u7acb\u523b\u6709\uff1a\n\n$$\\hat U={1\\over1-\\hat T}$$\n\n\u6545\uff1a\n\n$$\\hat T=1-\\hat U^{-1}$$\n\n\u76f4\u63a5\u505a\u5c31\u597d\u4e86\u3002\n",
        "postTime": 1648110078,
        "uid": 105050,
        "name": "myee",
        "ccfLevel": 7,
        "title": "4233"
    },
    {
        "content": "\u521a\u5b66\u4e86\u591a\u9879\u5f0f\u6c42\u9006\uff0c\u627e\u4e86\u4e00\u9053\u4f8b\u9898\u3002\n\n---\n\n\u9996\u5148n\u4e2a\u70b9\u7684\u7ade\u8d5b\u56fe\u4e2d\u54c8\u5bc6\u987f\u56de\u8def\u7684\u603b\u6570\u662f$(n-1)!\\ 2^{\\frac{n(n-1)}{2}-n}\\ $\u6761\u3002\n\n\u6211\u4eec\u4ece\u8d77\u70b9\u51fa\u53d1\uff0c\u7ecf\u8fc7\u6240\u6709\u70b9\uff0c\u56de\u5230\u8d77\u70b9\uff0c\u7ec4\u6210\u4e00\u4e2a1~n\u7684\u6392\u5217\u3002\u5171\u6709$n!$\u4e2a\u6392\u5217\u3002\u800c\u8def\u5f84\u662f\u4e00\u4e2a\u73af\uff0c\u6240\u4ee5\u6bcf\u6761\u8def\u5f84\u88ab\u8ba1\u7b97\u4e86$n$\u6b21\u3002\n\n\u4e00\u5171\u6709$\\frac{n(n-1)}{2}$\u6761\u8fb9\uff0c\u53bb\u6389\u7ec4\u6210\u73af\u7684$n$\u6761\uff0c\u5269\u4f59\u7684\u8fb9\u7684\u65b9\u5411\u4efb\u610f\u3002\n\n\u6545\u603b\u6709$\\frac{n!}{n}2^{\\frac{n(n-1)}{2}-n}=(n-1)!\\ 2^{\\frac{n(n-1)}{2}-n}$\u6761\u3002\n\n---\n\n\u4e0b\u9762\u662f\u6c42n\u4e2a\u70b9\u7684\u503c\u5f97\u8bb0\u5f55\u7684\u7ade\u8d5b\u56fe\u7684\u6570\u91cf\u3002\n\n\u5373\u5b58\u5728n\u4e2a\u70b9\u5b58\u5728\u54c8\u5bc6\u987f\u56de\u8def\u7684\u7ade\u8d5b\u56fe\u7684\u6570\u91cf\uff08\u5f3a\u8054\u901a\u7ade\u8d5b\u56fe\uff09\uff0c\u4ee4\u5176\u4e3a$f[n]$\u3002\n\n\u8003\u8651\u7ade\u8d5b\u56fe\u603b\u6570\u662f$2^{\\frac{n(n-1)}{2}}$\uff0c\u4ee4\u5176\u4e3a$g[n]$\u3002\n\n\u5219\u679a\u4e3e\u62d3\u6251\u5e8f\u6700\u5c0f\u7684\u5f3a\u8fde\u901a\u5206\u91cf\u5927\u5c0f\u4e3a$i$\uff0c\u5219\u5176\u4ed6\u7684\u70b9\u5411\u8be5\u5f3a\u8fde\u901a\u5206\u91cf\u8fde\u8fb9\u7684\u65b9\u5411\u662f\u56fa\u5b9a\u7684\uff0c\u5269\u4e0b$(n-i)$\u4e2a\u70b9\u7684\u8fb9\u4efb\u610f\u8fde\uff0c\u6240\u4ee5\n\n$f[i]=g[i]-\\sum_{j=1}^{i-1}f[j]\\binom{i}{j}g[i-j]$\n\n$g[i]=\\sum_{j=1}^{i}f[j]\\binom{i}{j}g[i-j]=\\sum_{j=1}^ii!\\frac{f[j]}{j!}\\frac{g[i-j]}{(i-j)!}$\n\n$\\frac{g[i]}{i!}=\\sum_{j=1}^i\\frac{f[j]}{j!}\\frac{g[i-j]}{(i-j)!}$\n\n\u4ee4$g'[n]=\\frac{g[n]}{n!},f'[n]=\\frac{f[n]}{n!}$\n\n\u5f97\u5230$g'[i]=\\sum_{j=1}^ig'[i-j]f'[j]$\u3002\n\n\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u6807\u51c6\u7684\u5206\u6cbbFFT\u3002\u4e8e\u662f\u4ee4$F[x]=\\sum_{i=0}^{\\infty}f'[i]x^i,G[x]=\\sum_{i=0}^{\\infty}g'[i]x^i$\n\n\u4e8e\u662f$G[n]=\\frac{g'[0]}{1-F[n]}$\n\n$F[n]=1-\\frac{g'[0]}{G[n]}$\n\n\u591a\u9879\u5f0f\u6c42\u9006\u89e3\u51b3\u3002\n\n```\n#include<cstdio>\nconst int N=262150;\nconst int mod=998244353;\nint fac[N],inv[N];\nint ksm(int u,int v){\n\tint res=1;\n\tfor(;v;v>>=1,u=1ll*u*u%mod)\n\tif(v&1)res=1ll*res*u%mod;\n\treturn res;\n}\ninline void swap(int &u,int &v){int o=u;u=v;v=o;}\nvoid pre(int u){\n\tfac[0]=fac[1]=inv[0]=inv[1]=1;\n\tfor(int i=2;i<=u;i++)fac[i]=1ll*fac[i-1]*i%mod;\n\tinv[u]=ksm(fac[u],mod-2);\n\tfor(int i=u-1;i>=2;i--)inv[i]=1ll*inv[i+1]*(i+1)%mod;\n}\nint f[N],g[N],c[N],rnk[N],n;\nvoid Ntt(int *t,int opt,int len){\n\tint g=3,g_=ksm(3,mod-2);\n\tfor(int i=0;i<len;i++)if(i<rnk[i])swap(t[i],t[rnk[i]]);\n\tfor(int i=1;i<len;i<<=1){\n\t\tint wn=ksm(~opt?g:g_,(mod-1)/(i<<1));\n\t\tfor(int j=0,J=i<<1;j<len;j+=J){\n\t\t\tint w=1;\n\t\t\tfor(int k=j;k<i+j;k++,w=1ll*w*wn%mod){\n\t\t\t\tint r=1ll*w*t[i+k]%mod;\n\t\t\t\tt[i+k]=(t[k]-r+mod)%mod;\n\t\t\t\tt[k]=(t[k]+r)%mod;\n\t\t\t}\n\t\t}\n\t}\n\tif(~opt)return;\n\tint ny=ksm(len,mod-2);\n\tfor(int i=0;i<len;i++)t[i]=1ll*t[i]*ny%mod;\n}\nvoid Inv(int Len,int *a,int *b){\n\tif(Len==1){b[0]=ksm(a[0],mod-2);return;}\n\tInv((Len+1)>>1,a,b);\n\tint len=1,_2=-1;\n\twhile(len<Len+Len)len<<=1,_2++;\n\tfor(int i=0;i<len;i++)rnk[i]=(rnk[i>>1]>>1)|((i&1)<<_2);\n\tfor(int i=0;i<Len;i++)c[i]=a[i];\n\tfor(int i=Len;i<len;i++)c[i]=0;\n\tNtt(c,1,len);Ntt(b,1,len);\n\tfor(int i=0;i<len;i++)\n\tb[i]=1ll*(2-1ll*c[i]*b[i]%mod+mod)*b[i]%mod;\n\tNtt(b,-1,len);\n\tfor(int i=Len;i<len;i++)b[i]=0;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tpre(n);\n\tfor(int i=0;i<=n;i++)g[i]=ksm(2,1ll*i*(i-1)/2%(mod-1));//\u5f97\u5230g[i]\n\tfor(int i=0;i<=n;i++)g[i]=1ll*g[i]*inv[i]%mod;//\u8fd9\u91cc\u5c31\u662fg'[i]\u4e86\n\tInv(n+1,g,f);\n\tfor(int i=0;i<=n;i++)f[i]=(mod-f[i])%mod;\n\tf[0]=(f[0]+1)%mod;//\u5f97\u5230f'[i]\n\tfor(int i=0;i<=n;i++)f[i]=1ll*f[i]*fac[i]%mod;//\u5f97\u5230f[i]\n\tif(n>=1)puts(\"1\");\n    if(n>=2)puts(\"-1\");//\u7279\u5224\u8fd9\u4e24\u4e2a\u8f93\u51fa\n\tfor(int i=3;i<=n;i++)\n\tprintf(\"%d\\n\",1ll*fac[i-1]*ksm(2,1ll*i*(i-3)/2%(mod-1))%mod*ksm(f[i],mod-2)%mod);\n    //\u6700\u540e\u7528\u8def\u5f84\u603b\u6761\u6570/\u56fe\u6570\u91cf\n}\n```",
        "postTime": 1551065821,
        "uid": 50092,
        "name": "da32s1da",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P4233 \u3010\u5c04\u547d\u4e38\u6587\u7684\u7b14\u8bb0\u3011"
    },
    {
        "content": "### \u9898\u76ee\u63cf\u8ff0\n\u7ed9\u5b9a $n$\uff0c\u6c42 $n$ \u4e2a\u70b9\u7684\u6240\u6709\u6709\u54c8\u5bc6\u987f\u56de\u8def\u7684\u7ade\u8d5b\u56fe\u4e2d\u54c8\u5bc6\u987f\u56de\u8def\u4e2a\u6570\u7684\u671f\u671b\u503c\uff0c\u5bf9 $998244353$ \u53d6\u6a21\u3002\n\n - \u7ade\u8d5b\u56fe\uff1a\u4efb\u610f\u4e24\u70b9\u95f4\u6709\u4e14\u4ec5\u6709\u4e00\u6761\u6709\u5411\u8fb9\u7684\u56fe\u3002\n - \u54c8\u5bc6\u987f\u56de\u8def\uff1a\u7ecf\u8fc7\u56fe\u4e0a\u6240\u6709\u70b9\u6070\u597d\u4e00\u6b21\u7684\u73af\u3002\n### Solution\n\u9996\u5148\u7b97\u51fa\u4e0d\u540c\u7684\u54c8\u5bc6\u987f\u56de\u8def\u7684\u603b\u6570\u91cf\uff0c\u4efb\u610f\u5730\u9009\u53d6\u4e00\u4e2a\u73af\uff0c\u65b9\u6848\u6570\u4e3a $(n-1)!\\times 2^{\\binom{n}{2}-n}$\uff0c\u5373\u5706\u6392\u5217\u6570\u4e58\u8fb9\u6570\u3002\n\n\u8bbe $g_i$ \u8868\u793a\u6709 $i$ \u4e2a\u70b9\u7684\u7ade\u8d5b\u56fe\u7684\u6570\u91cf\uff0c$g_i=2^{\\binom{i}{2}}$\u3002\n\n\u8bbe $f_i$ \u8868\u793a\u6709 $i$ \u4e2a\u70b9\u7684\u7ade\u8d5b\u56fe\u5f3a\u8054\u901a\u7684\u65b9\u6848\u6570\u3002\n\n\u7531\u4e8e\u7ade\u8d5b\u56fe\u7f29\u70b9\u540e\u4f1a\u5f62\u6210\u94fe\u72b6 DAG\uff0c\u679a\u4e3e\u7b2c\u4e00\u4e2a\u8fde\u901a\u5757\u7684\u5927\u5c0f\u6765\u8f6c\u79fb\u3002\n$$g_i=\\sum_{j=1}^{i}\\binom{i}{j}f_jg_{i-j}$$\n$$g_i=\\sum_{i=1}^{i}\\frac{i!}{j!(i-j)!}f_jg_{i-j}$$\n$$\\frac{g_i}{i!}=\\sum_{j=1}^{i}{\\frac{f_j}{j!}\\times\\frac{g_{i-j}}{(i-j)!}}$$\n\u8bbe $F(x)=\\sum_{i=1}^{n}{\\frac{f_i}{i!}x^i}$\uff0c$G(x)=\\sum_{i=0}^{n}{\\frac{g_i}{i!}}$\u3002\n$$G(x)=F(x)G(x)+1$$\n$$F(x)=1-\\frac{1}{G(x)}$$\n\u591a\u9879\u5f0f\u6c42\u9006\u5373\u53ef\u89e3\u51b3\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\log n)$\u3002\n## Code\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\nconst int maxn=500010,MLY=998244353,g=3;\nint bit,tot,rev[maxn];\ninline int power(int a,int b){\n\tint ans=1;\n\twhile(b){\n\t\tif(b&1)ans=1ll*ans*a%MLY;\n\t\ta=1ll*a*a%MLY;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\ninline void Init(int n){\n\tfor(bit=0;(1<<bit)<=(n<<1);++bit);tot=1<<bit;\n\tfor(int i=1;i<tot;++i)rev[i]=(rev[i>>1]>>1)|((i&1)<<(bit-1));\n}\ninline void NTT(int *a,int inv){\n\tfor(int i=0;i<tot;++i)\n\t\tif(i<rev[i])\n\t\t\tswap(a[i],a[rev[i]]);\n\tfor(int mid=1;mid<tot;mid<<=1){\n\t\tint tmp=power(g,(MLY-1)/(mid<<1));\n\t\tif(!~inv)tmp=power(tmp,MLY-2);\n\t\tfor(int i=0;i<tot;i+=mid<<1)\n\t\t\tfor(int j=0,w=1;j<mid;++j,w=1ll*w*tmp%MLY){\n\t\t\t\tint x=a[i+j],y=1ll*a[i+j+mid]*w%MLY;\n\t\t\t\ta[i+j]=(x+y)%MLY;a[i+j+mid]=(x-y+MLY)%MLY;\n\t\t\t}\n\t}\n\tif(!~inv){\n\t\tinv=power(tot,MLY-2);\n\t\tfor(int i=0;i<tot;++i)a[i]=1ll*a[i]*inv%MLY;\n\t}\n}\ninline void PolyMul(int *F,int *G,int n,int inv=0){\n\tInit(n);\n\tstatic int a[maxn],b[maxn];\n\tfor(int i=0;i<n;++i)a[i]=F[i],b[i]=G[i];\n\tfor(int i=n;i<tot;++i)a[i]=b[i]=0;\n\tNTT(a,1);NTT(b,1);\n\tfor(int i=0;i<tot;++i){\n\t\tif(inv)a[i]=b[i]*(2-1ll*a[i]*b[i]%MLY+MLY)%MLY;\n\t\telse a[i]=1ll*a[i]*b[i]%MLY;\n\t}\n\tNTT(a,-1);\n\tfor(int i=0;i<n;++i)G[i]=a[i];\n}\ninline void PolyInv(int *F,int *G,int n){\n\tif(n==1){\n\t\tG[0]=power(F[0],MLY-2);\n\t\treturn;\n\t}\n\tPolyInv(F,G,(n+1)>>1);\n\tPolyMul(F,G,n,1);\n}\nint invG[maxn],G[maxn],F[maxn],fac[maxn],invfac[maxn],n;\nint main(){\n\tscanf(\"%d\",&n);\n\tfac[0]=invfac[0]=1;\n\tfor(int i=1;i<=n;++i)fac[i]=1ll*fac[i-1]*i%MLY;\n\tinvfac[n]=power(fac[n],MLY-2);\n\tfor(int i=n-1;i;--i)invfac[i]=invfac[i+1]*(i+1ll)%MLY;\n\tfor(int i=1;i<=n;++i)G[i]=1ll*power(2,i*(i-1ll)/2%(MLY-1))*invfac[i]%MLY;G[0]=1;\n\tPolyInv(G,invG,n+1);\n\tfor(int i=0;i<=n;++i)F[i]=(MLY-invG[i])%MLY;\n\tF[0]=(F[0]+1)%MLY;\n\tif(n>=1)puts(\"1\");\n\tif(n>=2)puts(\"-1\");\n\tfor(int i=3;i<=n;++i){\n\t\tint ans=1ll*fac[i-1]*power(2,i*(i-3ll)/2%(MLY-1))%MLY*power(1ll*F[i]*fac[i]%MLY,MLY-2)%MLY;\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1619615648,
        "uid": 375785,
        "name": "x7103",
        "ccfLevel": 9,
        "title": "P4233 \u5c04\u547d\u4e38\u6587\u7684\u7b14\u8bb0"
    },
    {
        "content": "\u611f\u89c9\u5176\u4ed6\u5f88\u591a\u9898\u89e3\u90fd\u6ca1\u8bb2\u592a\u6e05\u695a\uff1f\u6211\u6765\u6c34\u7bc7\u9898\u89e3\u8bb2\u4e00\u4e0b\u3002\n\n\u9996\u5148\u6211\u4eec\u8003\u8651\u6c42\u51fa\u6240\u6709\u7ade\u8d5b\u56fe\u7684\u54c8\u5bc6\u987f\u56de\u8def\u7684\u603b\u6570\u3002\u4e00\u4e2a\u54c8\u5bc6\u987f\u56de\u8def\u53ef\u4ee5\u7528\u6240\u6709\u70b9\u7684\u4e00\u4e2a\u5706\u6392\u5217\u8868\u793a\uff0c\u7136\u540e\u4e0d\u5728\u56de\u8def\u4e0a\u7684\u8fb9\u53ef\u4ee5\u968f\u4fbf\u53d6\u65b9\u5411\uff0c\u4e8e\u662f\u6211\u4eec\u5f97\u5230\u8fd9\u4e00\u90e8\u5206\u662f\uff1a\n$$(n-1)!2^{\\frac{n(n-1)}2-n}$$\n\n\u7136\u540e\u95ee\u9898\u8f6c\u5316\u4e3a\u6c42\u6709\u54c8\u5bc6\u987f\u56de\u8def\u7684\u7ade\u8d5b\u56fe\u7684\u6570\u91cf\u3002\u4e0b\u4e00\u6b65\u8f6c\u5316\u5c31\u662f\u8fd9\u4e2a\u5c31\u76f8\u5f53\u4e8e\u6c42\u5f3a\u8fde\u901a\u7ade\u8d5b\u56fe\u7684\u6570\u91cf\uff0c\u8bc1\u660e\u53ef\u4ee5\u770b[\u8fd9\u7bc7](https://www.luogu.com.cn/blog/Ahaaaaaaaaaa/luogu-p4233-ye-ming-wan-wen-di-bi-ji)\u9898\u89e3\uff0c\u8fd9\u662f\u6211\u76ee\u524d\u770b\u5230\u552f\u4e00\u7684\u8bb2\u4e86\u8bc1\u660e\u7684\u9898\u89e3\u3002\n\n\u7136\u540e\u6211\u4eec\u8fd8\u6709\u4e00\u4e2a\u7ed3\u8bba\uff1a\u4e00\u4e2a\u7ade\u8d5b\u56fe\u7684\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u62d3\u6251\u5e8f\u662f\u552f\u4e00\u7684\u3002\u8bc1\u660e\u561b\u4e5f\u6bd4\u8f83\u663e\u7136\uff0c\u7ade\u8d5b\u56fe\u7f29\u70b9\u540e\u5fc5\u5b9a\u8fd8\u662f\u4e00\u4e2a\u7ade\u8d5b\u56fe\uff0c\u6bcf\u4e24\u4e2a\u70b9\u4e4b\u95f4\u90fd\u6709\u8fde\u8fb9\u3002\n\n\u8bbe $f_n=2^\\frac{n(n-1)}2$ \u4e3a $n$ \u4e2a\u70b9\u7684\u7ade\u8d5b\u56fe\u6570\u91cf\uff0c$g_n$ \u4e3a $n$ \u4e2a\u70b9\u7684\u5f3a\u8fde\u901a\u7ade\u8d5b\u56fe\u6570\u91cf\uff0c\u90a3\u4e48\u6211\u4eec\u63a5\u4e0b\u6765\u6709\u4e09\u6761\u8def\u53ef\u8d70\uff1a\n\n------------\n\u5176\u4e00\uff0c\u5c06 $g$ \u770b\u4f5c\u5e38\u91cf\uff0c\u5bf9 $f$ \u8fdb\u884c dp\uff0c\u5efa\u7acb\u4e8c\u8005\u4e4b\u95f4\u7684\u5173\u7cfb\u3002\u6211\u4eec\u679a\u4e3e\u4e00\u4e2a\u7ade\u8d5b\u56fe\u62d3\u6251\u5e8f\u6700\u5c0f\u7684\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u5927\u5c0f\uff0c\u5219\u6839\u636e\u4e4b\u524d\u7684\u7ed3\u8bba\uff0c\u5176\u4ed6\u5f3a\u8fde\u901a\u5206\u91cf\u4e0e\u5b83\u4e4b\u95f4\u7684\u8fb9\u90fd\u5df2\u552f\u4e00\u786e\u5b9a\u3002\u52a0\u4e0a\u6574\u4e2a\u56fe\u5f3a\u8fde\u901a\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u5f97\u5230\uff1a\n$$f_n=\\sum\\limits_{i=1}^n\\binom nif_{n-i}g_i$$\n\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u5206\u6cbb FFT \u7684\u5f62\u5f0f\uff0c\u4e5f\u662f\u4e00\u4e2a\u4e8c\u9879\u5377\u79ef\u7684\u5f62\u5f0f\u3002\u8bbe $f$\uff0c$g$ \u7684 EGF \u5206\u522b\u4e3a $F$ \u548c $G$\uff0c\u5219\u6211\u4eec~~\u6839\u636e\u5957\u8def\u663e\u7136~~\u6709\uff1a\n$$F(x)G(x)=F(x)-1\\Rightarrow G(x)=1-\\frac1{F(x)}$$\n\u6c42\u9006\u5373\u53ef\u3002\u8bc1\u660e\u7565\uff0c\u53ef\u4ee5\u53bb\u5206\u6cbb FFT \u677f\u5b50\u9898\u7684\u9898\u89e3\u533a\u770b\u3002\n\n------------\n\u5176\u4e8c\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5bf9 $g$ \u8fdb\u884c dp\u3002\n\n\u7136\u540e\u5176\u5b9e\u4f60\u4f1a\u53d1\u73b0\u8fd9\u4e2a\u65b9\u6cd5\u8ddf\u4e0a\u9762\u7684\u65b9\u6cd5\u672c\u8d28\u76f8\u540c\u2026\u2026\u6240\u4ee5\u6211\u4eec\u5c31\u4e0d\u8bb2\u4e86\uff08\n\n------------\n\u5176\u4e09\uff0c\u6211\u4eec\u76f4\u63a5\u6839\u636e EGF \u7684\u591a\u9879\u5f0f\u64cd\u4f5c\u7684\u7ec4\u5408\u610f\u4e49\uff0c\u627e\u51fa $F$ \u4e0e $G$ \u7684\u5173\u7cfb\u3002\n\n\u4e0e\u524d\u4e24\u79cd\u65b9\u6cd5\u4e0d\u540c\uff0c\u6211\u4eec\u8f6c\u800c\u679a\u4e3e\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u6570\u91cf\u3002\u6211\u4eec\u53ef\u4ee5\u628a\u5f3a\u8fde\u901a\u5206\u91cf\u770b\u6210\u76d2\u5b50\uff0c\u800c\u70b9\u770b\u6210\u7403\uff0c\u5219\u4e0d\u96be\u53d1\u73b0\u6211\u4eec\u53ea\u9700\u8981\u786e\u5b9a\u4e86\u54ea\u4e2a\u76d2\u5b50\u88c5\u54ea\u4e2a\u7403\uff0c\u5e76\u4e14\u6bcf\u4e2a\u76d2\u5b50\u91cc\u600e\u4e48\u88c5\uff0c\u5c31\u80fd\u786e\u5b9a\u8fd9\u4e2a\u7ade\u8d5b\u56fe\u3002\u7531\u4e8e\u6709\u62d3\u6251\u5e8f\uff0c\u6240\u4ee5\u76d2\u5b50\u662f\u4e0d\u540c\u7684\uff1b\u7531\u4e8e\u6709\u6807\u53f7\uff0c\u6240\u4ee5\u7403\u662f\u4e0d\u540c\u7684\u3002\u4e0d\u540c\u7684\u7403\u88c5\u5230\u4e0d\u540c\u7684\u76d2\u5b50\u91cc\uff0c\u6bcf\u4e2a\u76d2\u5b50\u5185\u5982\u679c\u6709\u4e00\u5b9a\u6570\u91cf\u7684\u7403\u5c31\u4f1a\u5bf9\u7b54\u6848\u9020\u6210\u4e00\u5b9a\u6570\u91cf\u7684\u8d21\u732e\uff1a\u8fd9\u6b63\u662f EGF \u7684\u4e58\u65b9\u7684\u7ec4\u5408\u610f\u4e49\uff01\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\uff1a\n$$F(x)=\\sum\\limits_{i=1}^nG(x)^i=\\frac1{1-G(x)}\\Rightarrow G(x)=1-\\frac1{F(x)}$$\n\u6c42\u9006\u5373\u53ef\u3002\n\n------------\n~~\u8fd9\u7bc7\u9898\u89e3\u4e0d\u5c31\u662f\u628a\u5176\u4ed6\u51e0\u7bc7\u9898\u89e3\u4e1c\u62fc\u897f\u51d1\u4e86\u4e00\u4e0b\u600e\u4e48\u53ef\u80fd\u8fc7\u5ba1\u561b\u3002~~",
        "postTime": 1594313964,
        "uid": 174045,
        "name": "FZzzz",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4233 \u3010\u5c04\u547d\u4e38\u6587\u7684\u7b14\u8bb0\u3011"
    },
    {
        "content": "\u60f3\u6211\u7b2c\u4e00\u6b21\u5199\u8fd9\u9898\u8fd8\u662f\u5728\u6070\u597d\u4e24\u5e74\u524d\uff0c\u73b0\u5728\u8fd9\u4e1c\u897f\u5e94\u8be5\u53d8\u6210 $\\mathbf{EGF}$ \u4f8b\u9898\u4e86\uff0c\u5199\u4e00\u70b9\u57fa\u7840\u6559\u5b66\u3002\n\n![](https://i.loli.net/2020/05/27/CczxqK6M5wV7t4n.png)\n\n\u663e\u7136\u9898\u76ee\u7684\u6a21\u578b\u7b49\u4ef7\u4e8e\u6c42\u81f3\u5c11\u6709\u4e00\u6761 $\\text{Hamilton}$ \u56de\u8def\u7684\u7ade\u8d5b\u56fe\u6570\u91cf\u3002\u800c\u8fd9\u6837\u7684\u56fe\u6709\u4e14\u53ea\u6709\u4e00\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u3002\n\n\u8003\u8651\u666e\u901a\u7ade\u8d5b\u56fe\u7684 $\\mathbf{EGF}$\uff1a\n\n$$F(x)=\\sum_{i=1}^\\infty 2^{\\mathrm C_i^2}\\cdot\\frac{x^i}{i!}$$\n\n\u4e00\u4e2a\u7ade\u8d5b\u56fe\u7f29\u70b9\u4e4b\u540e\u4f1a\u53d8\u6210\u4e00\u6761\u94fe\uff0c\u5f3a\u8fde\u901a\u5206\u91cf\u4e4b\u95f4\u7684\u8fb9\u53ea\u53ef\u80fd\u7531\u524d\u9762\u8fde\u5411\u540e\u9762\u3002\u90a3\u4e48\u4ee4 $G(x)$ \u4e3a\u5f3a\u8fde\u901a\u7ade\u8d5b\u56fe\u7684 $\\mathbf{EGF}$\uff1a\n\n$$\\begin{aligned}F(x)&=\\sum_{i=0}^\\infty G(x)^i\\\\&=\\frac{1}{1-G(x)}\\\\\\frac{1}{F(x)}&=1-G(x)\\\\G(x)&=1-\\frac{1}{F(x)}\\end{aligned}$$\n\n\u6c42\u9006\u5373\u53ef\u3002\n\n\u70b9\u540d\u8868\u626c\u51fa\u9898\u4eba @oscar",
        "postTime": 1590588234,
        "uid": 34354,
        "name": "gorokokoro",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4233 \u3010\u5c04\u547d\u4e38\u6587\u7684\u7b14\u8bb0\u3011"
    },
    {
        "content": "[\u9898\u76ee](https://www.luogu.org/problem/P4233)\n\n\u9898\u610f\uff1a\u7ed9\u51fa $n$\uff0c\u5728 __\u6709\u54c8\u5bc6\u987f\u56de\u8def\u7684__ $n$ \u4e2a\u70b9\u7684\u7ade\u8d5b\u56fe\u4e2d\u7b49\u6982\u7387\u9009\u51fa\u4e00\u4e2a\uff0c\u6c42\u54c8\u5bc6\u987f\u56de\u8def\u4e2a\u6570\u7684\u671f\u671b\u3002\n\n\u7b54\u6848\u5c31\u662f \u54c8\u5bc6\u987f\u56de\u8def\u7684\u603b\u6761\u6570 \u9664\u4ee5 \u6709\u54c8\u5bc6\u987f\u56de\u8def\u7684\u7ade\u8d5b\u56fe\u7684\u4e2a\u6570\u3002\n\n\u54c8\u5bc6\u987f\u56de\u8def\u7684\u603b\u6761\u6570\u662f\u5f88\u597d\u6c42\u7684\uff0c\u5bf9\u6bcf\u4e2a\u73af\u7b97\u8d21\u732e\uff0c\u7b97\u51fa $(n-1)!2^{C_n^2-n}$\u3002\n\n\u6709\u54c8\u5bc6\u987f\u56de\u8def\u7684\u7ade\u8d5b\u56fe\u7684\u4e2a\u6570\uff0c\u8fd9\u4e2a\u6709\u70b9\u96be\u529e\u3002\n\n\u7ed3\u8bba\uff1a\u4e00\u4e2a\u7ade\u8d5b\u56fe\u6709\u54c8\u5bc6\u987f\u56de\u8def \u7684\u5145\u8981\u6761\u4ef6\u662f \u5b83\u5f3a\u8fde\u901a\u3002\n\n\u5fc5\u8981\u6027\u663e\u7136\uff0c\u7b80\u5355\u8bc1\u8bc1\u5145\u5206\u6027\u3002\uff08\u5982\u679c\u5047\u4e86\u6216\u8005\u6709\u66f4\u597d\u7684\u8bc1\u6cd5\u8bf7\u544a\u8bc9\u6211qwq\uff09\n\n>\u5f52\u7eb3\u8bc1\u660e\u3002\u5bf9\u4e8e\u70b9\u6570\u5f88\u5c0f\u7684\u60c5\u51b5\uff0c\u5bb9\u6613\u9a8c\u8bc1\u662f\u5bf9\u7684\u3002\u73b0\u5728\u5047\u8bbe\u5df2\u7ecf\u8bc1\u660e\u4e86\u70b9\u6570\u5728 $n-1$ \u4ee5\u5185\u65f6\u7ed3\u8bba\u662f\u5bf9\u7684\u3002\n\u5047\u8bbe\u53bb\u6389 $n$ \u53f7\u70b9\uff0c\u8fd9\u65f6\u56fe\u4ecd\u662f\u7ade\u8d5b\u56fe\u4f46\u4e0d\u4e00\u5b9a\u5f3a\u8fde\u901a\uff0c\u6b64\u65f6\u56fe\u4e2d\u6709\u82e5\u5e72\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u3002\n\u628a\u5f3a\u8fde\u901a\u5206\u91cf\u7f29\u70b9\u53d8\u6210\u62d3\u6251\u56fe\u540e\uff0c\u663e\u7136\u62d3\u6251\u5e8f\u662f\u552f\u4e00\u7684\uff0c\u8bbe\u4e3a $(S_1\\rightarrow S_2\\rightarrow \\cdots\\rightarrow S_k)$\uff0c\u5176\u4e2d $S_i$\u4e3a\u4e00\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u3002\n\u56e0\u4e3a\u8981\u5f3a\u8fde\u901a\uff0c$n$ \u548c $S_1$ \u4e4b\u95f4\u6709\u81f3\u5c11\u4e00\u6761\u8fb9\u65b9\u5411\u662f $(n\\rightarrow S_1)$\uff0c\u800c $n$ \u548c $S_k$ \u4e4b\u95f4\u6709\u81f3\u5c11\u4e00\u6761\u8fb9\u65b9\u5411\u662f $(S_k\\rightarrow n)$\u3002\n\u7531\u4e8e $S_i$ \u7684\u70b9\u6570 $|S_i|$ \u5c0f\u4e8e $n$ \uff0c\u6240\u4ee5\u6211\u4eec\u5df2\u7ecf\u8bc1\u660e\u4e86\u5b83\u6709\u54c8\u5bc6\u987f\u56de\u8def\u3002\n\u8003\u8651\u4ece\u6bcf\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u54c8\u5bc6\u987f\u56de\u8def\u4e2d\u9009\u51fa\u4e00\u6761\u8fb9 $(u\\rightarrow v)$ \u5220\u6389\uff0c\u7136\u540e\u8ba9 $v$ \u6210\u4e3a\u8fd9\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u5165\u70b9\uff0c$u$ \u6210\u4e3a\u8fd9\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u51fa\u70b9\u3002\n\u5bf9\u4e8e\u4e00\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u53ea\u6709\u4e00\u4e2a\u70b9\u7684\u60c5\u51b5\uff0c\u8fd9\u4e2a\u70b9\u65e2\u662f\u5165\u70b9\u53c8\u662f\u51fa\u70b9\u3002\n\u6211\u4eec\u6309\u7167 $(n\\rightarrow S_1\\rightarrow S_2\\rightarrow \\cdots\\rightarrow S_k\\rightarrow n)$ \u7684\u987a\u5e8f\uff0c\u4e0a\u4e00\u4e2a\u5206\u91cf\u7684\u51fa\u70b9\u5411\u8fd9\u4e00\u4e2a\u5206\u91cf\u7684\u5165\u70b9\u8fde\u4e0a\u8fb9\uff0c\u5373\u6784\u9020\u51fa\u4e00\u4e2a\u54c8\u5bc6\u987f\u56de\u8def\u3002\n\u4e8e\u662f\u8bc1\u5b8c\u4e86\u3002\n\n\u6240\u4ee5\u53ea\u8981\u6c42\u5f3a\u8fde\u901a\u7ade\u8d5b\u56fe\u7684\u4e2a\u6570\u3002\n\n\u8003\u8651\u5bb9\u65a5\uff0c\u7528 $n$ \u4e2a\u70b9\u7ade\u8d5b\u56fe\u603b\u6570\u51cf\u53bb\u4e0d\u8fde\u901a\u7684\u4e2a\u6570\u3002\n\n\u4e0d\u8fde\u901a\u7684\u4e2a\u6570\u53c8\u600e\u4e48\u7b97\uff1f\u6211\u4eec\u679a\u4e3e\u7f29\u70b9\u540e\u62d3\u6251\u5e8f\u6700\u9760\u524d\u7684\u90a3\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u5927\u5c0f\uff0c\u5219\u5f97\u51fa\u5f0f\u5b50\uff1a\n\n$f_n=2^{C_n^2}-\\sum_{i=1}^{n-1} C_n^{i}f_i 2^{C_{n-i}^{2}}$\n\n\u4e8e\u662f\u5f97\u5230\u4e00\u4e2a\u5e73\u65b9\u505a\u6cd5\u3002\n\n\u79fb\u9879\u4e00\u4e0b\uff0c\u5bb9\u6613\u5f97\u5230 $2^{C_n^2}=\\sum_{i=1}^{n} C_n^{i}f_i 2^{C_{n-i}^{2}}$\n\n\u6784\u9020 $F(x)=\\sum_i \\frac{2^{C_i^2}}{i!}x^i,G(x)=\\sum_i \\frac{f_i}{i!}x^i$\uff0c\u7531\u4e0a\u9762\u5f0f\u5b50\u53ef\u4ee5\u5f97\u5230 $F(x)=F(x)G(x)+1$\u3002\n\n$G(x)=\\frac{F(x)-1}{F(x)}$\n\n\u591a\u9879\u5f0f\u6c42\u9006\u89e3\u51b3\u3002\n\n$n$ \u7279\u522b\u5c0f\u7684\u60c5\u51b5\u8981\u5224\u4e00\u5224\u3002\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\ntypedef long long ll;\nconst int K=18,M=998244353,G=3;\ninline int Pow(int a,ll m){int s=1;for(;m;m>>=1)m&1?s=(ll)s*a%M:0,a=(ll)a*a%M;return s;}\nnamespace poly{\nint rev[1<<K],t0[1<<K];\ninline void Init(int K){\n\tfor(int i=0;i<(1<<K);i++)rev[i]=rev[i>>1]>>1|(i&1)*(1<<K-1);\n}\ninline void Ntt(int*a,int f,int K){\n\tint s,omega,tmp0,tmp1;\n\tfor(int i=0;i<(1<<K);i++)if(i<rev[i])std::swap(a[i],a[rev[i]]);\n\tfor(int k=1;k<(1<<K);k<<=1){\n\t  omega=Pow(G,f>0?M/2/k:M-1-M/2/k);\n\t  for(int i=0;i<(1<<K);i+=k+k){\n\t\ts=1;\n\t\tfor(int j=0;j<k;j++,s=(ll)s*omega%M)\n\t\t  tmp0=a[i+j],tmp1=(ll)a[i+k+j]*s%M,\n\t\t  a[i+j]=(tmp0+tmp1)%M,a[i+k+j]=(tmp0-tmp1+M)%M;\n\t  }\n\t}\n\tif(f<0){\n\t  tmp0=Pow(1<<K,M-2);\n\t  for(int i=0;i<(1<<K);i++)a[i]=(ll)a[i]*tmp0%M;\n\t}\n}\ninline void Inv(int*c,int*a){\n\tc[0]=Pow(a[0],M-2);\n\tfor(int i=1;i<(1<<K);i++)c[i]=0;\n\tfor(int j=0;j<K;j++){//\n\t  Init(j+1);\n\t  memcpy(t0,a,sizeof(int)*(1<<j));\n\t  memset(t0+(1<<j),0,sizeof(int)*(1<<j));\n\t  Ntt(c,1,j+1),Ntt(t0,1,j+1);\n\t  for(int i=0;i<(1<<K);i++)c[i]=(2ll*c[i]-(ll)c[i]*c[i]%M*t0[i]%M+M)%M;\n\t  Ntt(c,-1,j+1);\n\t  memset(c+(1<<j),0,sizeof(int)*(1<<j));\n\t}\n}\ninline void Mult(int*c,int*a,int*b){\n\tInit(K);\n\tNtt(a,1,K),Ntt(b,1,K);\n\tfor(int i=0;i<(1<<K);i++)c[i]=(ll)a[i]*b[i]%M;\n\tNtt(c,-1,K);\n}\n}\nint t[1<<K],a[1<<K],g[1<<K],f[1<<K],invf[1<<K],k,n;\ninline int C(int n,int m){return(ll)f[n]*invf[m]%M*invf[n-m]%M;}\nint main(){\n\tf[0]=1;\n\tfor(int i=1;i<(1<<K);i++)f[i]=(ll)f[i-1]*i%M;\n\tinvf[(1<<K)-1]=Pow(f[(1<<K)-1],M-2);\n\tfor(int i=(1<<K)-1;i;i--)invf[i-1]=(ll)invf[i]*i%M;\n\tfor(int i=0;i<(1<<K-1);i++)a[i]=(ll)Pow(2,(ll)i*(i-1)/2)*invf[i]%M;\n\tpoly::Inv(t,a);\n\tfor(int i=0;i<(1<<K-1);i++)g[i]=!i?1:(ll)Pow(2,(ll)i*(i-1)/2+1)*invf[i]%M;\n\tmemset(g+(1<<K-1),0,sizeof(int)*(1<<K-1));\n\tmemset(t+(1<<K-1),0,sizeof(int)*(1<<K-1));\n\tpoly::Mult(g,t,g);\n\tmemset(g+(1<<K-1),0,sizeof(int)*(1<<K-1));\n\tfor(int i=0;i<(1<<K);i++)g[i]=(ll)g[i]*f[i]%M;\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++){\n\t  if(i==1){ puts(\"1\");continue;}\n\t  if(i==2){puts(\"-1\");continue;}\n\t  printf(\"%lld\\n\",(ll)f[i-1]*Pow(2,(ll)i*(i-1)/2-i)%M*Pow(g[i],M-2)%M);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1581350130,
        "uid": 72487,
        "name": "Dreamunk",
        "ccfLevel": 9,
        "title": "luogu P4233 \u5c04\u547d\u4e38\u6587\u7684\u7b14\u8bb0"
    },
    {
        "content": "+ \u8003\u8651\u6bcf\u4e00\u6761\u54c8\u5bc6\u987f\u56de\u8def\u5728\u6240\u6709\u7ade\u8d5b\u56fe\u4e2d\u7684\u51fa\u73b0\u6b21\u6570\u3002\n+ \u53d1\u73b0\u5982\u679c\u786e\u5b9a\u4e00\u4e2a\u73af\uff0c \u5176\u4ed6\u7684\u8fb9\u4e71\u9009\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u51fa\u73b0\u54c8\u5bc6\u987f\u56de\u8def\u3002\u6240\u4ee5\u5bf9\u4e8e\u4e00\u6761\u54c8\u5bc6\u987f\u56de\u8def\uff0c \u51fa\u73b0\u6b21\u6570\u4e3a$2^{C_n^2-n}$, \u51cf\u53bb\u7684$n$\u4e3a\u90a3$n$\u6761\u8fb9\u3002\u54c8\u5bc6\u987f\u56de\u8def\u662f$1-n$\u7684\u4e00\u4e2a\u6392\u5217\u9996\u5c3e\u62fc\u5728\u4e00\u8d77\uff0c \u5171\u6709$n!/n$\u79cd\u3002\u4e8e\u662f\u603b\u8d21\u732e\u53ef\u4ee5\u76f4\u63a5\u5f97\u51fa\u3002\n+ \u603b\u8d21\u732e\u7b97\u597d\u4e86\uff0c \u95ee\u9898\u8f6c\u5316\u4e3a\u6c42\u6709\u591a\u5c11\u4e2a\u5b58\u5728\u54c8\u5bc6\u987f\u56de\u8def\u7684\u7ade\u8d5b\u56fe\u3002\n+ \u663e\u7136\uff0c \u5b58\u5728\u54c8\u5bc6\u987f\u56de\u8def\u7684\u7ade\u8d5b\u56fe\u4e00\u5b9a\u5f3a\u8fde\u901a\uff0c \u5f3a\u8fde\u901a\u7684\u7ade\u8d5b\u56fe\u4e00\u5b9a\u6709\u54c8\u5bc6\u987f\u56de\u8def\u3002\n+ \u6240\u4ee5\u95ee\u9898\u5c31\u662f\u6c42\u6709\u591a\u5c11\u4e2a\u5f3a\u8fde\u901a\u7684$n$\u4e2a\u70b9\u7684\u7ade\u8d5b\u56fe\u3002\n+ \u8bbe$n$\u4e2a\u70b9\u7684\u5f3a\u8fde\u901a\u7684\u7ade\u8d5b\u56fe\u4e2a\u6570\u4e3a$f_n$\u3002\n+ \u8003\u8651\u7528\u6240\u6709\u56fe\u51cf\u53bb\u4e0d\u662f\u5f3a\u8fde\u901a\u7684\u7ade\u8d5b\u56fe\uff0c \u53ef\u4ee5\u5f97\u5230:\n\t$$ f_n =2^{C_n^2} - \\sum_{i=1}^{n - 1}f_i\\times C_n^i\\times 2^{C_{n - i}^2}$$\n+ \u8fd9\u4e2a\u5f0f\u5b50\u7684\u610f\u601d\u662f\u679a\u4e3e\u4e00\u4e2a\u5176\u4ed6\u70b9\u65e0\u6cd5\u5230\u8fbe\u7684\u5f3a\u8fde\u901a\u56fe\uff0c\u4e5f\u5c31\u662f\u7f29\u70b9\u4e4b\u540e\u62d3\u6251\u5e8f\u6700\u5c0f\u7684\u5f3a\u8fde\u901a\u56fe\uff0c\u7531\u4e8e\u662f\u4efb\u610f\u7684\uff0c \u6240\u4ee5\u4e58\u4ee5\u7ec4\u5408\u6570\uff0c \u7136\u540e\u5269\u4e0b\u7684\u70b9\u6570\u4e3a$n - i$\u7684\u56fe\u4e71\u9009\u3002\u4e4b\u6240\u4ee5\u53ef\u4ee5\u8fd9\u6837\u662f\u56e0\u4e3a\u6bcf\u4e2a\u56fe\u4e00\u5b9a\u4f1a\u6709\u4e00\u4e2a\u6700\u5c0f\u7684\u5f3a\u8fde\u901a\u56fe\uff0c \u800c\u4e14\u7531\u4e8e\u5bf9\u4e8e\u6bcf\u4e2a\u56fe\u6211\u4eec\u53ea\u7edf\u8ba1\u6700\u5c0f\u7684\uff0c \u6240\u4ee5\u505a\u5230\u4e0d\u91cd\u4e0d\u6f0f\u3002\n+ \u8003\u8651\u5982\u4f55\u8ba1\u7b97$f_i$\n+ \u8bbe$g_i=2^{C_i^2}$, \u6709\uff1a\n$$ f_n=g_n-\\sum_{i=1}^{n-1}f_i\\times C_n^i\\times g_{n-i}$$\n$$g_n=\\sum_{i=1}^nf_i\\times C_n^i\\times g_{n-i}$$\n$$\\frac{g_n}{n!}=\\sum_{i=1}^n\\frac{f_i}{i!}\\times \\frac{g_{n-i}}{(n-i)!}$$\n+ \u8bbe$G_n=\\frac{g_n}{n!}$, $F_n=\\frac{f_n}{n!}$\u3002\n+ \u6240\u4ee5\u6709\uff1a\n  $$ G_n = \\sum_{i=1}^nF_iG_{n-i}$$\n+ \u8bbe$A=\\sum_{i = 0}^{inf}F_ix^i$, $B=\\sum_{i=0}^{inf}G_ix^i$, \u7136\u540e\u6709\uff1a\n$$ A * B=\\sum_{i=0}^{inf}x^i\\sum_{j+k=i}F_j\\times G_k = B - G_0$$\n+ \u8fd9\u91cc$F_0 = 0$\n+ \u79fb\u9879\uff0c\u591a\u9879\u5f0f\u6c42\u9006\u5c31\u597d\u4e86\u3002\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <vector>\n#include <cstring>\n#include <algorithm>\n#include <iostream>\nusing namespace std;\n#define R register\nconst int N = 4e5 + 10;\nconst int P = 998244353;\nconst int G = 3;\ninline int read() {\n\tint x = 0, f = 1; char a = getchar();\n\tfor(; a > '9' || a < '0'; a = getchar()) if(a == '-') f = -1;\n\tfor(; a >= '0' && a <= '9'; a = getchar()) x = x * 10 + a - '0';\n\treturn x * f;\n}\ntemplate <typename T>\ninline int qpow(int x, T k) {\n\tint res = 1;\n\twhile(k) {\n\t\tif(k & 1) res = 1LL * res * x % P;\n\t\tx = 1LL * x * x % P; k >>= 1;\n\t} return res;\n} \nstruct Poly {\n\tint lim, rev[N];\n\tinline void init(int Lim) {\n\t\tlim = Lim;\n\t\tfor(R int i = 0; i < lim; i ++)\n\t\t\trev[i] = (rev[i >> 1] >> 1) | ((i & 1) ? lim >> 1 : 0);\n\t}\n\tinline void NTT(int *A, int type = 1) {\n\t\tfor(R int i = 0; i < lim; i ++) if(i > rev[i]) swap(A[i], A[rev[i]]);\n\t\tfor(R int dep = 1; dep < lim; dep <<= 1) {\n\t\t\tint Wn = qpow(type == 1 ? G : qpow(G, P - 2), (P - 1) / (dep << 1));\n\t\t\tfor(R int j = 0, len = dep << 1; j < lim; j += len) {\n\t\t\t\tint w = 1;\n\t\t\t\tfor(R int k = 0; k < dep; k ++, w = 1LL * w * Wn % P) {\n\t\t\t\t\tint x = A[j + k], y = 1LL * w * A[j + k + dep] % P;\n\t\t\t\t\tA[j + k] = (x + y) % P;\n\t\t\t\t\tA[j + k + dep] = (x - y + P) % P;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(type == -1) {\n\t\t\tint inv = qpow(lim, P - 2);\n\t\t\tfor(R int i = 0; i < lim; i ++) A[i] = 1LL * A[i] * inv % P;\n\t\t}\n\t}\n\tint C[N];\n\tinline void getinv(int dep, int *F, int *G) {\n\t\tif(dep == 1) {\n\t\t\tG[0] = qpow(F[0], P - 2); return ;\n\t\t}\n\t\tgetinv((dep + 1) >> 1, F, G);\n\t\tint lim = 1;\n\t\twhile(lim < (dep << 1)) lim <<= 1; init(lim);\n\t\tfor(R int i = 0; i < dep; i ++) C[i] = F[i]; \n\t\tfor(R int i = dep + 1; i < lim; i ++) C[i] = 0;\n\t\tNTT(C); NTT(G);\n\t\tfor(R int i = 0; i < lim; i ++) \n\t\t\tG[i] = 1LL * (2 - 1LL * C[i] * G[i] % P + P) % P * G[i] % P;\n\t\tNTT(G, -1);\n\t\tfor(R int i = dep; i < lim; i ++) G[i] = 0;\n\t}\n}T;\nint n;\nint f[N], g[N], F[N];\nint fac[N], ifac[N];\nint main() {\n\t\tfreopen(\"hamilton.in\", \"r\", stdin);\n\t\tfreopen(\"hamilton.out\", \"w\", stdout);\n\t\tn = read(); fac[0] = 1;\n\t\tif(n >= 1) cout << 1 << endl;\n\t\tif(n >= 2) cout << -1 << endl;\n\t\tfor(R int i = 1; i <= n; i ++) fac[i] = 1LL * fac[i - 1] * i % P;\n\t\t\tifac[n] = qpow(fac[n], P - 2);\n\t\tfor(R int i = n - 1; i >= 0; i --) ifac[i] = 1LL * ifac[i + 1] * (i + 1) % P;\n\t\tfor(R int i = 0; i <= n; i ++) g[i] = 1LL * qpow(2, 1LL * i * (i - 1) / 2) * ifac[i] % P;\n\t\tT.getinv(n + 1, g, F);\n\t\tfor(R int i = 0; i <= n; i ++) F[i] = (P - F[i]) % P;\n\t\tfor(R int i = 0; i <= n; i ++) f[i] = 1LL * F[i] * fac[i] % P;\n\t\tfor(R int i = 0; i <= n; i ++) g[i] = 1LL * g[i] * fac[i] % P;\n\t\tfor(R int i = 3; i <= n; i ++) \n\t\t\tprintf(\"%lld\\n\", 1LL * fac[i] * qpow(i, P - 2) % P * qpow(2, 1LL * i * (i - 1) / 2 - i) % P * qpow(f[i], P - 2) % P) ;\n\treturn 0;\n}\n\n```\n",
        "postTime": 1597416155,
        "uid": 139012,
        "name": "______OvO______",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P4233 \u3010\u5c04\u547d\u4e38\u6587\u7684\u7b14\u8bb0\u3011 && \u8003\u8bd5T3"
    },
    {
        "content": "# P4233 \u5c04\u547d\u4e38\u6587\u7684\u7b14\u8bb0    \n\n## \u9898\u76ee\u5927\u610f   \n\u6c42 $1\\to n$ \u5927\u5c0f\u4e3a $i$ \u7684\u7ade\u8d5b\u56fe\u4e2d\u5f3a\u8fde\u901a\u7684\u4e2a\u6570 \u3002   \n\n## $solution$    \n\u7ade\u8d5b\u56fe \uff1a\u70b9\u4e0e\u70b9\u4e24\u4e24\u4e4b\u95f4\u90fd\u6709\u4e14\u53ea\u6709\u4e00\u6761\u6709\u5411\u8fb9 \u3002   \n\u7ade\u8d5b\u56fe\u7684\u5f3a\u8fde\u901a\u56fe \uff1a\u663e\u7136\u4f1a\u6709\u4e00\u6761\u54c8\u5bc6\u987f\u56de\u8def \u3002    \n\u597d\uff0c\u6211\u4eec\u5148\u7b97\u4e00\u4e0b\u6211\u4eec\u6709\u591a\u5c11\u79cd\u56de\u8def \u3002\u4e5f\u5c31\u662f\u5927\u5c0f\u4e3a $n$ \u7684\u7ade\u8d5b\u56fe\u4e2d\u4e0d\u540c\u54c8\u5bc6\u987f\u56de\u8def\u4e2a\u6570 \u3002    \n\u9996\u9009\u5148\u56e0\u4e3a\u6211\u4eec\u7684\u6bcf\u4e2a\u70b9\u90fd\u662f\u4e0d\u540c\u7684 \uff0c\u6240\u4ee5\u6bcf\u4e00\u4e2a\u56de\u8def\u90fd\u662f\u4e00\u4e2a\u6392\u5217 \uff0c\u5462\u4e48\u4e2a\u6570\u5c31\u662f $\\frac{n!}{n}2^{\\frac{(n)* (n-1)}{2}-n}$       \n\u56e0\u4e3a\u4ed6\u662f\u4e00\u4e2a\u73af\u6240\u4ee5\u6bcf\u4e2a\u4f1a\u91cd\u590d $n$ \u6b21 \u3002\u5176\u4ed6\u7684\u8fb9\u7684\u65b9\u5411\u53ef\u4ee5\u968f\u4fbf\u9009 \u3002\u4ed4\u7ec6\u60f3\u60f3\uff0c\u5f53\u6211\u4eec\u7684\u73af\u5df2\u7ecf\u786e\u5b9a\u65f6\uff0c\u4ed6\u5176\u4ed6\u7684\u8fb9\u968f\u610f\u9009\u540e\u4e0d\u53ef\u80fd\u4e0e\u4e4b\u524d\u91cd\u590d\uff0c\u56e0\u4e3a\u5176\u4ed6\u7684\u8fb9\u4e0d\u53ef\u80fd\u518d\u628a\u7ec4\u6210\u4e00\u4e2a\u73af\u4e86 .      \n $Let's~go~on~!$   \n\u6211\u4eec\u8bbe $g[n]$ \u4e3a\u5927\u5c0f\u4e3a $n$ \u7684\u7ade\u8d5b\u56fe\u7684\u4e2a\u6570 $2^{\\frac{n(n-1)}{2}}$ \u3002     \n\u6211\u4eec\u8bbe $f[n]$ \u4e3a\u5927\u5c0f\u4e3a $n$ \u7684\u7ade\u8d5b\u56fe\u5f3a\u8fde\u901a\u7684\u65b9\u6848\u6570 \u3002    \n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5f53\u6211\u4eec\u5bf9\u4e00\u4e2a\u7ade\u8d5b\u56fe\u7f29\u70b9\u540e\uff0c\u4f1a\u5f62\u6210\u4e00\u4e2a $DAG$ , $DAG$ \u5448\u94fe\u72b6 \u3002 \u6240\u4ee5\u6211\u4eec\u679a\u4e3e\u4ed6\u7684\u62d3\u6251\u5e8f\u4e2d\u7684\u7b2c\u4e00\u4e2a\u8054\u901a\u5757\u7684\u5927\u5c0f \uff0c\u7136\u540e\u80af\u5b9a\u662f\u4ed6\u5411\u5176\u4ed6\u7684\u6240\u6709\u70b9\u8fde\u8fb9\uff0c\u5176\u4ed6\u7684\u70b9\u968f\u4fbf\u8fde\u5c31\u597d\u5566 \u3002   \n\n$$g[i]=\\sum_{j=1}^{i}C_{i}^{j}f[j]* g[i-j]$$    \n$$g[i]=\\sum_{j=1}^{i}\\frac{i!}{j!(i-j)!}f[j]* g[i-j]$$   \n\n$$\\frac{g[i]}{i!}=\\sum_{j=1}^{i}\\frac{f[j]}{j!}\\frac{g[i-j]}{(i-j)!}$$\n\n\u597d\uff0c\u6211\u4eec\u8bbe $g{'}[i]$ \u4e3a $\\frac{g[i]}{i!}$ ,$f{'}[i]$ \u4e3a $\\frac{f[i]}{i!}$       \n$F$ \u4e3a $f$ \u7684\u591a\u9879\u5f0f\uff0c $G$ \u4e3a $g$ \u7684\u591a\u9879\u5f0f \u3002   \n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0    \n$$g{'}[i]=\\sum_{j=1}^{i}f{'}[j]g{'}[i-j]$$   \n\u56e0\u4e3a\u4e0a\u9762\u662f $1\\to i$ \u7684\u5c11\u4e86 \u7b2c $0$ \u9879\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u5f97\u52a0\u56de\u6765 \u3002\n$$G(x)=G(x)* F(x)+g{'} _ 0$$     \n$$F(x)=\\frac{G(x)-g{'}_ 0}{G(x)}$$   \n$$F(x)=1-\\frac{g{'}_ 0}{G(x)}$$      \n\n\u597d\uff0c\u6211\u4eec\u6574\u7406\u51fa\u6765 $G$ \u6c42\u4e2a\u9006\uff0c\u7136\u540e\u6309\u9898\u76ee\u5904\u7406\u4e00\u4e0b\u5c31\u597d\u5566 \u3002   \n\n* $code$    \n\n```cpp\n// luogu-judger-enable-o2\n#include<bits/stdc++.h>\n#define ll long long\n#define add(x,y) (x+y)%mod\n#define dec(x,y) (x-y+mod)%mod\n#define mul(x,y) x*y%mod\nusing namespace std;\nconst ll mod=998244353,G=3,Gi=332748118;\nconst ll maxn=2e6+10;\ninline ll read() {\n\tll data=0,f=1;char c=getchar();\n\twhile('0'>c||c>'9') {\n\t\tif(c=='-') f=-1;c=getchar();\n\t} while('0'<=c&&c<='9') {\n\t\tdata=data*10+c-'0';c=getchar(); \n\t} return data*f; \n}\nll n;\nll poww(ll x,ll k) {\n\tll ans=1;\n\twhile(k) {\n\t\tif(k&1) ans=mul(ans,x);\n\t\tx=mul(x,x);\n\t\tk>>=1;\n\t}\n\treturn ans;\n}\nll X[maxn],Y[maxn],l,r[maxn],limit=1,A[maxn],B[maxn];\nvoid NTT(ll *A,ll type,ll len) {\n\tlimit=1,l=0;\n\twhile(limit<=len) limit<<=1,l++;\n\tfor(ll i=0;i<limit;++i) r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\tfor(ll i=0;i<limit;++i) if(i<r[i]) swap(A[i],A[r[i]]);\n\tfor(ll mid=1;mid<limit;mid<<=1) {\n\t\tll Wn=poww(type==1?G:Gi,(mod-1)/(mid<<1));\n\t\tfor(ll R=mid<<1,j=0;j<limit;j+=R) {\n\t\t\tll w=1;\n\t\t\tfor(ll k=0;k<mid;++k,w=mul(w,Wn)) {\n\t\t\t\tll x=A[j+k],y=mul(w,A[j+k+mid]);\n\t\t\t\tA[j+k]=add(x,y);A[j+k+mid]=dec(x,y);\n\t\t\t}\n\t\t}\n\t}\n\tif(type==-1) {\n\t\tfor(ll inv=poww(len<<1,mod-2),i=0;i<limit;++i) A[i]=mul(A[i],inv);\n\t}\n}\n\nvoid Inv(ll *a,ll *b,ll len) {\n\tif(len==1) {\n\t\tb[0]=poww(a[0],mod-2);\n\t\treturn ;\n\t}\n\tInv(a,b,len>>1);\n\tfor(ll i=0;i<len;++i) A[i]=a[i],B[i]=b[i]; \n\tNTT(A,1,len);NTT(B,1,len);\n\tfor(int i=0;i<=limit;++i) A[i]=mul(mul(A[i],B[i]),B[i]);\n\tNTT(A,-1,len);\n\tfor(int i=0;i<len;++i) b[i]=dec(mul(2,b[i]),A[i]);\n}\nll jc[maxn],inv[maxn],g[maxn],f[maxn];\nint main() {\n\tn=read();\n\tjc[0]=1;\n\tfor(int i=1;i<=n;++i) jc[i]=jc[i-1]*i%mod;\n\tinv[n]=poww(jc[n],mod-2);\n\tfor(int i=n;i;i--) inv[i-1]=inv[i]*i%mod;\n\tinv[0]=1;\n\tfor(int i=0;i<=n;++i) g[i]=poww(2,1ll*(i-1)*i/2)*inv[i]%mod;\n\tll Len;for(Len=1;Len<=n;Len<<=1);\n\tInv(g,f,Len);\n\tfor(int i=0;i<=n;++i) f[i]=(mod-f[i]);\n\tf[0]=(f[0]+1)%mod;\n\tfor(int i=0;i<=n;++i) f[i]=f[i]*jc[i]%mod;\n\tif(n>=1) cout<<\"1\"<<\"\\n\";\n\tif(n>=2) cout<<\"-1\"<<\"\\n\";\n\tfor(int i=3;i<=n;++i) cout<<jc[i-1]*poww(2,1ll*i*(i-3)/2)%mod*poww(f[i],mod-2)%mod<<\"\\n\";\n\treturn 0;\n}\n\n```\n\n",
        "postTime": 1561470733,
        "uid": 102786,
        "name": "Sym_Je",
        "ccfLevel": 0,
        "title": "P4233 \u5c04\u547d\u4e38\u6587\u7684\u7b14\u8bb0"
    },
    {
        "content": "> $n$\u70b9\u5e26\u6807\u53f7\u5f3a\u8fde\u901a**\u7ade\u8d5b\u56fe**\u4e2d\u54c8\u5bc6\u987f\u56de\u8def\u6570\u91cf\u671f\u671b\n\n\u671f\u671b\u7684\u7ebf\u6027\u6027\u9ebb\u70e6\u4e86\uff0c\u76f4\u63a5\u5f53\u6210\u5e73\u5747\u6570\n\n\u5bf9\u603b\u4e2a\u6570\u8003\u8651\u6709$n$\u8fb9\u5df2\u5b9a\u5411,\u5176\u4f59\u8fb9\u65b9\u6848$2^{\\binom{n}{2}-n}$\n\n\u603b\u7684$\\displaystyle \\frac{n 2^{\\binom{n}{2}-n}}{n!}$\n\n\u8003\u8651\u4e2a\u6570\u7528\u4e4b\u524d\u8ba1\u6570$dp$\u679a\u4e3e\u4e0d\u5408\u6cd5\u70b9\u7684\u601d\u8def\n\n\u5bf9$i$\u4e2a\u70b9\u7684\u5f3a\u8fde\u901a**\u7ade\u8d5b\u56fe**\u53ef\u4ee5\u5f3a\u5236\u9009\u51fa$j$\u4e2a\u70b9\u8054\u901a\uff0c\u5269\u4e0b\u7684\u70b9\u968f\u4fbf\n$$\nf_i=2^{\\binom{i}{2}}-\\sum\\limits_{j}\\binom{i}{j}f_j2^{\\binom{i-j}{2}}\n$$\n\u8003\u8651\u5f15\u5165$g_i$\u8868\u793a\u65e0\u9650\u5236**\u7ade\u8d5b\u56fe**\u4e2a\u6570\n\n\u5219\n$$\nf_i=g_i-\\sum\\limits_{j=0}^{i-1}\\binom{i}{j}f_jg_{i-j}$$\n\n$$g_i=\\sum\\limits_{j=0}^{i}\\binom{i}{j}f_jg_{i-j}$$\n\n\u5f3a\u62c6C,\u8fd9\u91cc\u662f\u4e00\u4e2aEDF\u6280\u5de7\u53ef\u4ee5\u8ba9\u4e24\u8fb9\u5bf9\u79f0\n$$\n\\begin{aligned}\ng_i=\\sum\\limits_{j=0}^{i}i!\\frac{f_j}{j!}\\frac{g_{i-j}}{(i-j)!}\\\\\n\\frac{g_i}{i!}=\\sum\\limits_{j=0}^{i}\\frac{f_j}{j!}\\frac{g_{i-j}}{(i-j)!}\\\\\n\\end{aligned}\n$$\n\u7136\u540e$G=FG+1$\n\n$G=1-\\frac{1}{F}$\n\n\u53d1\u73b0\u5b8c\u7f8e\u7684\u66ff\u4ee3\u4e86\u5206\u6cbbFFT",
        "postTime": 1596164724,
        "uid": 40629,
        "name": "zzw4257",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4233 \u3010\u5c04\u547d\u4e38\u6587\u7684\u7b14\u8bb0\u3011"
    },
    {
        "content": "\u9898\u76ee\u7684\u80cc\u666f\u5199\u5f97\u5f88\u4f18\u79c0......\n\n\u4e00\u76f4\u89c9\u5f97\u6d1b\u8c37\u7684\u80cc\u666f\u76f8\u5f53\u8d70\u5fc3\uff08hhhhh)\n\n\u8bb0\u5f97\u4e4b\u524d\u6709\u4e00\u6761\u9898\u76ee\u53eb\u6709\u673a\u5316\u5b66\u4e4b\u795e\u4e5f\u4f1a\u4f5c\u5f0a  \uff08\u4e00\u4e2a\u88ab\u6709\u673a\u5316\u5b66\u6298\u78e8\u5f97\u75db\u4e0d\n\n\u6b32\u751f\u7684\u849f\u84bb\u5dee\u70b9\u7b11\u6b7b\uff01\uff09\n\n\u8a00\u5f52\u6b63\u4f20\n\n\u5927\u6982\u89e3\u91ca\u4e00\u4e0b\u9898\u610f\uff1a\u6c42n\u4e2a\u70b9\u7684\u5f3a\u8fde\u901a\u56fe\u7684\u54c8\u5bc6\u987f\u56de\u8def\u6761\u6570\u7684\u671f\u671b\u3002\n\n\u4e00\u6761\u6bd4\u8f83\u6c34\u7684\u6570\u5b66\u9898\uff0c\u697c\u4e0a\u7684\u9898\u89e3\u5df2\u7ecf\u6bd4\u8f83\u8be6\u7ec6\u4e86\uff0c\u5728\u8fd9\u4e2a\u8d34\u4e00\u4e0b\u4ee3\u7801\u5df2\u7ecf\n\n\u81ea\u5df1\u7684\u8ba1\u7b97\u601d\u8def\u3002\uff08ntt)\n\n\u8fd9\u4e2a\u671f\u671b\u5c31\u662f\u6240\u6709\u7ade\u8d5b\u56fe\u7684 \u54c8\u5bc6\u987f\u56de\u8def\u6570\u91cf/\u5b58\u5728\u54c8\u5bc6\u987f\u56de\u8def\u7684\u7ade\u8d5b\u56fe\u7684\u6570\n\n\u91cf\u3002 \n\n\u524d\u9762\u90a3\u4e2a\u633a\u597d\u505a\uff0c\u8003\u8651\u6bcf\u6761\u54c8\u5bc6\u987f\u56de\u8def\u7684\u8d21\u732e\uff0c\u5c31\u662f\n\n[![P8Y3i4.png](https://s1.ax1x.com/2018/07/21/P8Y3i4.png)](https://imgchr.com/i/P8Y3i4)\n\n\u90a3\u4e48\u5c31\u662f\u8981\u627e\u5b58\u5728\u54c8\u5bc6\u987f\u56de\u8def\u7684\u7ade\u8d5b\u56fe\u7684\u6570\u91cf\u3002 \n\n\u56fe\u7684\u4e00\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u4e00\u5b9a\u80fd\u627e\u5230\u4e00\u4e2a\u7b80\u5355\u73af\u3002 \n\n\u6240\u4ee5\u5c31\u662f\u6c42\u5f3a\u8054\u901a\u7684\u7ade\u8d5b\u56fe\u4e2a\u6570\u3002\u800c\u5c06\u4e00\u4e2a\u7ade\u8d5b\n\n\u56fe\u5f3a\u8054\u901a\u7f29\u70b9\u540e\u663e\u7136\u662f\u4e00\u6761\u94fe\u3002 \n\n\u8003\u8651\u5bb9\u65a5\uff0c\u679a\u4e3e\u8fd9\u6761\u94fe\u6700\u4e0b\u9762\u7684\u7684scc\u7684\u5927\u5c0f\uff0c\u4e8e\u662f\u5f97\u5230\u5f0f\u5b50\uff1a \n\n[![P8Y8JJ.png](https://s1.ax1x.com/2018/07/21/P8Y8JJ.png)](https://imgchr.com/i/P8Y8JJ)\n\n\u5c06\u7ec4\u5408\u6570\u5c55\u5f00\uff0c\u6c42\u9006\u5373\u53ef\u3002\n\n\u4ee3\u7801\u5982\u4e0b\n\n```cpp\n#include<bits/stdc++.h>\n \nusing namespace std;\n\nconst int maxn=1000000;\nconst long long M=998244353;\nconst long long g=3;\ntypedef long long LL;\n\nLL A[maxn];\nLL B[maxn];\n\nint Rev[maxn];\nint N,Lg;\n\nLL F[maxn];\nLL G[maxn];\n\nLL fac[maxn];\nLL nfac[maxn];\nint n;\n\nLL Pow(LL x,LL y)\n{\n    if (!y) return 1LL;\n    LL temp=Pow(x,y>>1);\n    temp=temp*temp%M;\n    if (y&1) temp=temp*x%M;\n    return temp;\n}\n\nvoid DFT(LL *a,int f)\n{\n    for (int i=0; i<N; i++)\n        if (i<Rev[i]) swap(a[i],a[ Rev[i] ]);\n\n    for (int len=2; len<=N; len<<=1)\n    {\n        int mid=(len>>1);\n        LL e=Pow(g,(M-1)/len);\n        if (f==-1) e=Pow(e,M-2);\n\n        for (LL *p=a; p!=a+N; p+=len)\n        {\n            LL wn=1;\n            for (int i=0; i<mid; i++)\n            {\n                LL temp=wn*p[mid+i]%M;\n                p[mid+i]=(p[i]-temp+M)%M;\n                p[i]=(p[i]+temp)%M;\n                wn=wn*e%M;\n            }\n        }\n    }\n}\n\nvoid NTT(bool rev)\n{\n    for (int i=0; i<N; i++)\n    {\n        Rev[i]=0;\n        for (int j=0; j<Lg; j++)\n            if (i&(1<<j)) Rev[i]|=(1<<(Lg-j-1));\n    }\n\n    DFT(A,1);\n    DFT(B,1);\n    if (rev) for (int i=0; i<N; i++) A[i]=A[i]*A[i]%M;\n    for (int i=0; i<N; i++) A[i]=A[i]*B[i]%M;\n    DFT(A,-1);\n\n    LL inv=Pow(N,M-2);\n    for (int i=0; i<N; i++) A[i]=A[i]*inv%M;\n}\n\nvoid Poly_Rev(int m)\n{\n    if (m==1) F[0]=Pow(G[0],M-2);\n    else\n    {\n        Poly_Rev(m>>1);\n\n        N=2*m,Lg=0;\n        while ((1<<Lg)!=N) Lg++;\n        for (int i=0; i<m; i++) A[i]=F[i],B[i]=G[i];\n        for (int i=m; i<N; i++) A[i]=B[i]=0;\n        NTT(true);\n\n        for (int i=0; i<m; i++) F[i]=2LL*F[i]%M,F[i]=(F[i]-A[i]+M)%M;\n    }\n}\n\nint main()\n{\n    freopen(\"4233.in\",\"r\",stdin);\n    freopen(\"4233.out\",\"w\",stdout);\n\n    scanf(\"%d\",&n);\n\n    N=1;\n    while (N<=n+2) N<<=1;\n    fac[0]=1;\n    for (LL i=1; i<N; i++) fac[i]=fac[i-1]*i%M;\n    for (int i=0; i<N; i++) nfac[i]=Pow(fac[i],M-2);\n    for (LL i=0; i<N; i++) G[i]=Pow(2LL, i*(i-1LL)/2LL )*nfac[i]%M;\n    Poly_Rev(N);\n\n    N=1,Lg=0;\n    while (N<2*n+2) N<<=1,Lg++;\n    for (int i=0; i<=n; i++) A[i]=F[i],B[i]=G[i];\n    for (int i=n+1; i<N; i++) A[i]=B[i]=0;\n    B[0]=0;\n    NTT(false);\n    for (LL i=1; i<=n; i++)\n    {\n        A[i]=A[i]*fac[i]%M;\n        if (!A[i]) printf(\"-1\\n\");\n        else\n        {\n            LL ans=fac[i-1]*Pow(2LL, max(i*(i-1LL)/2LL-i,0LL) )%M;\n            ans=ans*Pow(A[i],M-2)%M;\n            printf(\"%I64d\\n\",ans);\n        }\n    }\n\n    return 0;\n}\n```\n\n\u5e0c\u671b\u8fd9\u6b21\u5ba1\u6838\u80fd\u8fc7......\n",
        "postTime": 1532129824,
        "uid": 99460,
        "name": "Hiraeth",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4233 \u3010\u5c04\u547d\u4e38\u6587\u7684\u7b14\u8bb0\u3011"
    },
    {
        "content": "[\u6b22\u8fce\u5230\u6211\u7684\u535a\u5ba2\u67e5\u770b](https://mivik.gitee.io/2020/solution/notes-of-syameimaru-aya/)\n\n> \u5bf9\u4e8e\u6240\u6709 $1\\le i\\le n$ \u6c42\u51fa $i$ \u4e2a\u70b9\u7684\u6709\u54c8\u5bc6\u987f\u56de\u8def\u7684\u7ade\u8d5b\u56fe\u7684\u54c8\u5bc6\u987f\u56de\u8def\u6570\u91cf\u7684\u671f\u671b\u3002\n>\n> $1\\le n\\le 100000$\n\n\uff08\u8fd9\u7bc7\u9898\u89e3\u4e3b\u8981\u5c31\u662f\u8865\u4e00\u4e0b\u5927\u591a\u6570\u9898\u89e3\u4e0d\u5c51\u4e8e\u63d0\u5230\u7684\u8bc1\u660e\uff09\n\n\u9996\u5148 $n$ \u4e2a\u70b9\u6240\u6709\u56fe\u7684\u54c8\u5bc6\u987f\u56de\u8def\u603b\u6570\u53ef\u6c42\uff0c\u5c31\u662f $(n-1)!\\cdot2^{\\binom n2-n}$\u3002\u56e0\u4e3a\u54c8\u5bc6\u987f\u56de\u8def\u4e00\u5171\u6709 $(n-1)!$ \u79cd\uff0c\u7136\u540e\u5b9a\u4e0b\u4e00\u4e2a\u54c8\u5bc6\u987f\u56de\u8def\u5176\u5b83\u7684\u8fb9\u968f\u4fbf\u5b9a\u5411\u5373\u53ef\u3002\n\n\u6211\u4eec\u8003\u8651\u6c42\u6709\u54c8\u5bc6\u987f\u56de\u8def\u7684\u56fe\u7684\u6570\u91cf\u3002\u9996\u5148\u6709\u4e2a\u5b9a\u7406\uff1a\n$$\n\\text{\u7ade\u8d5b\u56fe\u6709\u54c8\u5bc6\u987f\u56de\u8def}\\iff\\text{\u7ade\u8d5b\u56fe\u5f3a\u8054\u901a}\n$$\n\u5145\u5206\u6027\u663e\u7136\uff0c\u8003\u8651\u8bc1\u5fc5\u8981\u6027\u3002\u6211\u4eec\u8003\u8651\u5f52\u7eb3\uff0c\u5220\u6389 $n$ \u53f7\u70b9\u540e\u5269\u4e0b\u7684\u70b9\u4f1a\u5f62\u6210\u4e00\u4e9b\u6781\u5927\u7684\u5f3a\u8054\u901a\u5757\uff0c\u5e76\u4e14\u6709\u552f\u4e00\u7684\u62d3\u6251\u5e8f\uff0c\u5047\u8bbe\u6309\u8fd9\u4e2a\u5e8f\u6392\u51fa\u6765\u662f $S_1,S_2,\\cdots,S_k$\uff0c\u4e14 $S_i$ \u7684\u6bcf\u4e2a\u70b9\u90fd\u5411 $S_{i+1}$ \u7684\u6bcf\u4e2a\u70b9\u6709\u8fde\u8fb9\u3002\n\n\u9996\u5148\u8003\u8651 $k>1$ \u7684\u60c5\u51b5\uff0c\u90a3\u4e48\u7531\u4e8e\u6574\u4e2a\u56fe\u5f3a\u8054\u901a\uff0c\u6240\u4ee5 $n$ \u53f7\u70b9\u5fc5\u7136\u5411 $S_1$ \u4e2d\u81f3\u5c11\u8fde\u4e86\u4e00\u6761\u8fb9\uff0c$S_k$ \u4e2d\u81f3\u5c11\u5411 $n$ \u8fde\u4e86\u4e00\u6761\u8fb9\uff0c\u53c8\u7531\u4e8e\u5bf9\u4e8e\u6240\u6709 $S_i$ \u6211\u4eec\u5df2\u7ecf\u5f52\u7eb3\u8bc1\u660e\u4e86\u5b83\u6709\u4e00\u6761\u54c8\u5bc6\u987f\u56de\u8def\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u51fa $n\\rightarrow S_1\\rightarrow S_2\\rightarrow\\cdots\\rightarrow S_k\\rightarrow n$ \u7684\u4e00\u6761\u54c8\u5bc6\u987f\u56de\u8def\u3002\n\n\u7136\u540e\u662f $k=1$ \u7684\u60c5\u51b5\u3002\u6211\u4eec\u8003\u8651\u5230\u7531\u4e8e\u81f3\u5c11\u6709\u4e00\u6761 $S_1\\rightarrow n$ \u7684\u8fb9\u548c\u4e00\u6761 $n\\rightarrow S_1$ \u7684\u8fb9\uff0c\u90a3\u4e48\u8bbe $S_1$ \u7684\u54c8\u5bc6\u987f\u56de\u8def\u5e8f\u5217 $a_i$\uff08\u5faa\u73af\uff09\uff0c\u90a3\u4e48\u5fc5\u5b9a\u6709\u4e00\u4e2a $i$ \u4f7f\u5f97\u5b58\u5728 $a_i\\rightarrow n$ \u4e14\u5b58\u5728 $a_{i+1}\\leftarrow n$\uff0c\u90a3\u4e48\u8fd9\u6837\u5b50\u6211\u4eec\u5c31\u53ef\u4ee5\u6784\u9020\u51fa\u4e00\u6761\u54c8\u5bc6\u987f\u56de\u8def\u3002\n\n\u8bc1\u660e\u5b8c\u6bd5\u3002\u73b0\u5728\u6211\u4eec\u5c31\u662f\u8981\u6c42 $n$ \u4e2a\u70b9\u7684\u5f3a\u8054\u901a\u7ade\u8d5b\u56fe\u6570\u91cf\u3002\u6211\u4eec\u8003\u8651\u8ba1\u7b97\u975e\u5f3a\u8054\u901a\u7ade\u8d5b\u56fe\u7684\u6570\u91cf\uff0c\u53d1\u73b0\u4e00\u4e2a\u975e\u5f3a\u8054\u901a\u7ade\u8d5b\u56fe\u662f\u552f\u4e00\u5730\u7531\u4e00\u4e2a **\u6781\u5927\u7684** \u5f3a\u8054\u901a\u7ade\u8d5b\u56fe\u548c\u5176\u5b83\u70b9\u4efb\u610f\u8fde\u8fb9\u6784\u6210\u7684\u3002\u5199\u51fa\u6765\u662f\uff1a\n$$\nf_i=2^{\\binom i2}-\\sum_{j=0}^{i-1} \\binom ij f_j\\cdot 2^{\\binom{i-j}2}\n$$\n\u7136\u540e\u62c6\u4e00\u4e0b\u518d\u79fb\u9879\uff1a\n$$\n\\sum_{j=0}^i\\frac{f_j}{j!}2^{\\binom {i-j}2}=2^{\\binom i2}\n$$\n\u7136\u540e\u8bbe $f_i$ \u7684 EGF $F(x)$\uff0c$G(x)=\\sum_{i=0}^\\infty 2^{\\binom i2}x^i$\uff0c\u90a3\u4e48\u6211\u4eec\u6709\uff08\u6ce8\u610f\u5e38\u6570\u9879\uff09\uff1a\n$$\n\\begin{aligned}\nF(x)\\cdot G(x)+1&=G(x)\\\\\nF(x)&=\\frac{G(x)-1}{G(x)}\n\\end{aligned}\n$$\n\u7136\u540e\u591a\u9879\u5f0f\u6c42\u9006\u5c31\u505a\u5b8c\u4e86\u3002\u6ce8\u610f $n$ \u6bd4\u8f83\u5c0f\u8981\u7279\u5224\u3002\n\n[mivik.h](https://mivik.gitee.io/mivik.h)\n\n[\u4ee3\u7801](https://paste.ubuntu.com/p/hYYg8KwYzj/)",
        "postTime": 1608200590,
        "uid": 45182,
        "name": "Mivik",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4233 \u3010\u5c04\u547d\u4e38\u6587\u7684\u7b14\u8bb0\u3011"
    },
    {
        "content": "\u6ca1\u6709\u300c\u5206\u6cbb NTT\u300d\u7684\u9898\u89e3\uff1f\u6765\u4e00\u53d1\u3002\n\n## \u9898\u610f\n\n\u6c42\u5728 $n$ \u4e2a\u70b9\u5e26\u6807\u53f7\u5f3a\u8fde\u901a\u7ade\u8d5b\u56fe\u4e2d\uff0c\u54c8\u5bc6\u987f\u56de\u8def\u6570\u91cf\u7684\u671f\u671b\u3002\n\n## \u601d\u8def\n\n\u5728 @oscar \u7684\u9898\u89e3\u4e2d\uff0c\u5df2\u7ecf\u5199\u51fa\uff1a\n\n>- $n$ \u4e2a\u70b9\u7684\u7ade\u8d5b\u56fe\u4e2d\u54c8\u5bc6\u987f\u56de\u8def\u7684\u603b\u6570\u4e3a $\\frac{n!}n\\cdot2^{C(n,2)-n}$\uff1b\n>- $n$ \u4e2a\u70b9\u7684\u5f3a\u8fde\u901a\u7ade\u8d5b\u56fe\u7684\u6570\u91cf\u4e3a $f_n=2^{C(n,2)}-\\sum_{i=1}^{n-1}f_i\\cdot2^{C(n-i,2)}\\cdot C(n,i)$\u3002\n\n\u554a\uff01\u8fd9\u4e0d\u662f\u4e2a\u6807\u51c6\u7684\u300c\u5206\u6cbb NTT\u300d\u5417\uff1f\n\n\u63a8\u4e00\u6ce2\u5f0f\u5b50\uff1a\n\n$$\n\\begin{aligned}\nf_i&=2^{C(i,2)}-\\sum_{j=1}^{i-1}f_j\\cdot C(i,j)\\cdot2^{C(i-j,2)}\\\\\nf_i&=2^{C(i,2)}-\\sum_{j=1}^{i-1}f_j\\cdot2^{C(i-j,2)}\\cdot\\frac{i!}{j!\\cdot(i-j)!}\\\\\nf_i&=2^{C(i,2)}-i!\\cdot\\sum_{j=1}^{i-1}\\frac{f_j}{j!}\\cdot\\frac{2^{C(i-j,2)}}{(i-j)!}\\\\\n\\frac{f_i}{i!}&=\\frac{2^{C(i,2)}}{i!}-\\sum_{j=1}^{i-1}\\frac{f_j}{j!}\\cdot\\frac{2^{C(i-j,2)}}{(i-j)!}\n\\end{aligned}\n$$\n\n\u8bbe\uff1a\n\n$$\n\\begin{aligned}\nF(i)&=\\frac{f_i}{i!}\\\\\nG(i)&=\\frac{2^{C(i,2)}}{i!}\\\\\nH(i)&=\\sum_{j=1}^{i-1}F(j)G(i-j)\\\\\nF(i)&=G(i)-H(i)\n\\end{aligned}\n$$\n\n\u4fbf\u53ef\u4ee5\u6109\u5feb\u7684\u300c\u5206\u6cbb NTT\u300d\u4e86\uff01\n\n\u7b54\u6848\u4e3a $\\large\\frac{(i-1)!\\cdot2^{C(i,2)-i}}{F(i)\\cdot i!}$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log^2n)$\uff0c\u81ea\u5df1\u7684\u4ee3\u7801\u6700\u5927\u70b9\u8dd1\u4e86 `430ms`\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include<cstdio>\nusing namespace std;\nconst int N=1<<18,G=3,mod=998244353,invG=(mod+1)/G;\nint n,fac[N],invf[N];\nint rev[N],f[N],g[N],h[N];\ninline void swap(int &x,int &y)\n{\n\tx^=y^=x^=y;\n\treturn;\n}\nint pow(int x,int times)\n{\n\tint ret=1;\n\twhile(times) {\n\t\tif(times&1) {\n\t\t\tret=1ll*ret*x%mod;\n\t\t}\n\t\ttimes>>=1,x=1ll*x*x%mod;\n\t}\n\treturn ret;\n}\nvoid init_pow()\n{\n\tfac[0]=1;\n\tfor(int i=1;i<=n;++i) {\n\t\tfac[i]=1ll*fac[i-1]*i%mod;\n\t}\n\tinvf[n]=pow(fac[n],mod-2);\n\tfor(int i=n;i;--i) {\n\t\tinvf[i-1]=1ll*invf[i]*i%mod;\n\t}\n\treturn;\n}\nvoid init(int len)\n{\n\tfor(int i=0;i<len;++i) {\n\t\trev[i]=(rev[i>>1]>>1)|(i&1?len>>1:0);\n\t}\n\treturn;\n}\nvoid ntt(int f[],int n,bool flag)\n{\n\tfor(int i=0;i<n;++i) {\n\t\tif(i<rev[i]) {\n\t\t\tswap(f[i],f[rev[i]]);\n\t\t}\n\t}\n\tfor(int len=2,k=1;len<=n;len<<=1,k<<=1) {\n\t\tfor(int i=0,uni=pow(flag?G:invG,(mod-1)/len);i<n;i+=len) {\n\t\t\tfor(int j=i,w=1;j<i+k;++j,w=1ll*w*uni%mod) {\n\t\t\t\tint tem=1ll*w*f[j+k]%mod;\n\t\t\t\tf[j+k]=(f[j]-tem)%mod,f[j]=(f[j]+tem)%mod;\n\t\t\t}\n\t\t}\n\t}\n\treturn;\n}\nvoid cdq(int l,int r)\n{\n\tstatic int temf[N],temg[N];\n\tif(r-l==1) {\n\t\tf[l]=(g[l]-h[l])%mod;\n\t\treturn;\n\t}\n\tint mid=(l+r)/2,siz=r-l;\n\tcdq(l,mid);\n\tint len;\n\tfor(len=1;len<siz;len<<=1);\n\tinit(len);\n\tfor(int i=l;i<mid;++i) {\n\t\ttemf[i-l]=f[i];\n\t}\n\tfor(int i=mid-l;i<len;++i) {\n\t\ttemf[i]=0;\n\t}\n\tfor(int i=0;i<siz;++i) {\n\t\ttemg[i]=g[i];\n\t}\n\tfor(int i=siz;i<len;++i) {\n\t\ttemg[i]=0;\n\t}\n\tntt(temf,len,true),ntt(temg,len,true);\n\tfor(int i=0;i<len;++i) {\n\t\ttemf[i]=1ll*temf[i]*temg[i]%mod;\n\t}\n\tntt(temf,len,false);\n\tfor(int i=0,invlen=pow(len,mod-2);i<len;++i) {\n\t\ttemf[i]=1ll*temf[i]*invlen%mod;\n\t}\n\tfor(int i=mid;i<r;++i) {\n\t\th[i]=(h[i]+temf[i-l])%mod;\n\t}\n\tcdq(mid,r);\n\treturn;\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tinit_pow();\n\tfor(int i=1;i<=n;++i) {\n\t\tg[i]=1ll*pow(2,1ll*i*(i-1)/2%(mod-1))*invf[i]%mod;\n\t}\n\tcdq(0,n+1);\n\tif(n>=1) {\n\t\tputs(\"1\");\n\t}\n\tif(n>=2) {\n\t\tputs(\"-1\");\n\t}\n\tfor(int i=3;i<=n;++i) {\n\t\tprintf(\"%d\\n\",(int)(1ll*fac[i-1]*pow(2,(1ll*i*(i-1)/2-i)%(mod-1))%mod*pow(1ll*f[i]*fac[i]%mod,mod-2)%mod+mod)%mod);\n\t}\n\treturn 0;\n}\n```\n\n~~\u987a\u4fbf\u819c\u6211\u6821 @Dreamunk \u5927\u4f6c\u7528\u300c\u591a\u9879\u5f0f\u6c42\u9006\u300d\u5207\u4e86\u672c\u9898\u3002~~",
        "postTime": 1592467919,
        "uid": 77022,
        "name": "Early",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4233 \u3010\u5c04\u547d\u4e38\u6587\u7684\u7b14\u8bb0\u3011"
    }
]
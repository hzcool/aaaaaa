[
    {
        "content": "\u9996\u5148\u9898\u76ee\u91cc\u8bf4$f(a,b)=f(b,a)$\uff0c\u8bf4\u660e\u6211\u4eec\u53ea\u7528\u7ef4\u62a4\u534a\u4e2a\u68cb\u76d8\u7684\u4fe1\u606f\u5c31\u591f\u4e86\u3002\n\n\u7136\u540e$b *f(a,a+b)=(a+b)*f(a,b)$\u8fd9\u4e2a\u5f0f\u5b50\u6211\u4eec\u5316\u6210$\\frac{f(a,b)}{a*b}=\\frac{f(a,a+b)}{a*(a+b)}$\n\n\u90a3\u4e48\u5c31\u6709$\\frac{f(a,b)}{a*b}=\\frac{f(a,a \\% b)}{a*(a \\% b)}$\n\n\u53d1\u73b0\u8fd9\u4e2a\u5f62\u5f0f\u5f88\u50cf\u8f97\u8f6c\u76f8\u9664\u6cd5\u6c42$\\gcd$\u7684\u8fc7\u7a0b\uff0c\u6240\u4ee5\u6211\u4eec\u5982\u679c\u4e00\u76f4\u8fd9\u6837\u9012\u5f52\u4e0b\u53bb\u7684\u8bdd\u53ef\u4ee5\u5f97\u5230$\\frac{f(a,b)}{a*b}=\\frac{f(\\gcd(a,b),\\gcd(a,b))}{\\gcd^2(a,b)}$\u3002\n\n\u5373$f(a,b)=\\frac{a*b}{d^2}*f(d,d)$\uff0c\u4ee4$d=\\gcd(a,b)$\n\n\u53d1\u73b0\u5982\u679c\u4fee\u6539\u503c\u7684\u8bdd\uff0c$\\gcd$\u4e0d\u540c\u7684\u4f4d\u7f6e\u7684$f$\u503c\u76f8\u4e92\u72ec\u7acb\u3002\u4e5f\u5c31\u662f\u8bf4\u4fee\u6539\u4e00\u4e2a\u4f4d\u7f6e$(a,b)$\u7684\u503c\u540e\u6709\u4e14\u4ec5\u6709$\\gcd(x,y)=d$\u7684$(x,y)$\u4f4d\u7f6e\u7684$f$\u503c\u4f1a\u8ddf\u7740\u53d8\u5316\u3002\uff08\u8fd9\u53e5\u8bdd\u5bf9\u6c42\u7b54\u6848\u6ca1\u4ec0\u4e48\u7528\uff0c\u662f\u4e3a\u65b9\u4fbf\u7406\u89e3\u5199\u7684\uff09\n\n\u7136\u540e\u56de\u53bb\u770b$ans$\uff0c\n\n$$\\sum \\limits ^{k}_{i=1}\\sum \\limits ^{k}_{j=1} f(i,j)$$\n\n$$= \\sum \\limits ^{k}_{d=1} f(d,d) \\sum \\limits _{d|i} \\sum \\limits _{d|j} \\frac{i*j}{d^2} \\varepsilon(\\gcd(i,j)==d)$$\n\n$$= \\sum \\limits ^{k}_{d=1} f(d,d) \\sum \\limits^{\\lfloor \\frac{k}{d} \\rfloor} _{i=1} \\sum \\limits^{\\lfloor \\frac{k}{d} \\rfloor} _{j=1} i*j* \\varepsilon(\\gcd(i,j))$$\n\n\u6240\u4ee5\u8bf4\u6211\u4eec\u53ef\u4ee5\u6839\u636e$k/d$\u5206\u5757\uff0c\u8fd9\u6837\u9700\u8981\u52a8\u6001\u7ef4\u62a4$f(i,i)$\u7684\u524d\u7f00\u548c\u3002\u89c2\u5bdf\u5230$n$\u4e3a\n$4*10^6$\u800c$m$\u4e3a$10^4$\uff0c\u6240\u4ee5\u6211\u4eec\u5927\u6982\u9700\u8981\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\uff0c\u652f\u6301\u5355\u70b9\u4fee\u6539$O(\\sqrt{n})$\uff0c\u67e5\u524d\u7f00\u548c$O(1)$\u3002\u5206\u5757\u6b63\u597d\u53ef\u4ee5\u505a\u5230\u8fd9\u4e2a\u3002\u5177\u4f53\u5c31\u662f\u5757\u5185\u6bcf\u4e2a\u4f4d\u7f6e\u7ef4\u62a4\u672c\u5757\u5185\u7684\u524d\u7f00\u548c\uff0c\u7136\u540e\u6bcf\u4e2a\u5757\u672b\u5c3e\u7ef4\u62a4\u4e00\u4e0b\u603b\u7684\u524d\u7f00\u548c\uff0c\u8fd9\u6837\u67e5\u8be2\u7684\u65f6\u5019\u7b49\u4e8e\u4e0a\u4e00\u5757\u7684\u603b\u7b54\u6848\u52a0\u4e0a\u8fd9\u4e2a\u4f4d\u7f6e\u7684\u5757\u7b54\u6848\u3002\u4fee\u6539\u66b4\u529b\u91cd\u6784\uff0c\u53ea\u4f1a\u5f71\u54cd\u5230$\\sqrt{n}$\u5de6\u53f3\u4e2a\u503c\u3002\n\n\u8bbe$G(x)=\\sum \\limits^{x} _{i=1} \\sum \\limits^{x} _{j=1} i*j* \\varepsilon(\\gcd(i,j))$\u3002\u90a3\u4e48\u6839\u636e$\\sum \\limits ^{x}_{i=1}i*\\varepsilon(\\gcd(i,x))=\\frac{x*(\\varphi(x)+\\varepsilon(x))}{2}$\uff0c\u6709$G(x)=\\sum \\limits ^{x}_{i=1} i^2 *\\varphi(i)$\uff08\u8003\u8651$G(x)$\u6bd4$G(x-1)$\u591a\u4e86\u4ec0\u4e48\uff09\uff0c\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u7ebf\u6027\u7b5b\u9884\u5904\u7406\u3002\uff08\u7136\u800c\u849f\u84bb\u8fd9\u4e00\u6b65\u53ea\u4f1a$n \\sqrt{n}$\u7684\u7b97\u6cd5\u5bfc\u81f4\u505a\u4e0d\u51fa\u6765\u4e86..QAQ\uff09\n\n\u6ce8\u610f\u4e0d\u8981\u7206$int$\n\n\u4ee3\u7801\u7565\u4e11\uff0c\u7ef4\u62a4\u5757\u7684\u65b9\u5f0f\u6bd4\u8f83\u6e05\u5947\n``` cpp\n%:pragma GCC optimize(2)\n#include<bits/stdc++.h>\n#define maxn 4000010\n#define ll long long\nusing namespace std;\n\nint pri[maxn/8],phi[maxn],pricnt=0;\nint bel[maxn],bpos[2010],epos[2010],size,tn,n,q;\n//bel\u4e3a\u6bcf\u4e2a\u4f4d\u7f6e\u5c5e\u4e8e\u54ea\u4e2a\u5757\uff0cbpos,epos\u4e3a\u6bcf\u4e2a\u5757\u7684\u521d\u59cb\u4f4d\u7f6e\u548c\u672b\u5c3e\u4f4d\u7f6e\nll val[maxn],ans[maxn],ANS[2010],f[maxn];\n//ans\u4e3a\u5757\u5185\u524d\u7f00\u548c\uff0cANS\u4e3a\u603b\u524d\u7f00\u548c\nconst ll p=1e9+7;\nbool notpri[maxn];\ninline int gcd(int x,int y){\n    if(!x||!y)\n        return x|y;\n    return x>y?gcd(y,x%y):gcd(x,y%x);\n}\ninline ll sum(int x){\n    if(!x)\n        return 0;\n    return (ANS[bel[x]-1]+ans[x])%p;\n}\ninline ll pw(ll a,ll b){\n    ll ret=1;\n    while(b){\n        if(b&1)\n            ret=ret*a%p;\n        a=a*a%p;\n        b>>=1;\n    }\n    return ret;\n}\nvoid init(){\n    phi[1]=1;\n    for(int i=2;i<=n;i++){\n        if(!notpri[i]){\n            pri[++pricnt]=i;\n            phi[i]=i-1;\n        }\n        for(int j=1;j<=pricnt;j++){\n            if(i*pri[j]>n)\n                break;\n            notpri[i*pri[j]]=true;\n            if(i%pri[j]==0){\n            \tphi[i*pri[j]]=phi[i]*pri[j];\n            \tbreak;\n            }\n            phi[i*pri[j]]=phi[i]*(pri[j]-1);\n        }\n    }\n    for(int i=1;i<=n;i++)\n        f[i]=(f[i-1]+1LL*phi[i]*i%p*i%p)%p;\n}\nint main(){\n    scanf(\"%d%d\",&q,&n),size=sqrt(n),init();\n    for(int i=1;i<=n;i++){\n        bel[i]=i/size+1;\n        if(bel[i]>bel[i-1])\t\n            bpos[bel[i]]=i,epos[bel[i]-1]=i-1;\n    }\n    tn=bel[n],epos[tn]=n;\n    for(int i=1;i<=n;i++)\n        val[i]=1LL*i*i%p;\n    for(int i=1;i<=tn;i++){\n        for(int j=bpos[i];j<=epos[i];j++)\n            ans[j]=(ans[j-1]*(j>bpos[i])+val[j])%p;\n        ANS[i]=(ANS[i-1]+ans[epos[i]])%p;\n    }\n    for(int i=1;i<=q;i++){\n        int a,b,k,d,pos;\n        ll x,Ans=0;\n        scanf(\"%d%d%lld%d\",&a,&b,&x,&k),x%=p,d=gcd(a,b);\n        val[d]=x*d%p*d%p*pw(1LL*a*b%p,p-2)%p;\n        for(int j=d;j<=epos[bel[d]];j++)\n            ans[j]=(ans[j-1]*(j>bpos[bel[d]])+val[j])%p;\n        for(int j=bel[d];j<=tn;j++)\n            ANS[j]=(ANS[j-1]+ans[epos[j]])%p;\n        for(int j=1;j<=k;j=pos+1){\n            pos=k/(k/j);\n            Ans=(Ans+f[k/j]*(sum(pos)-sum(j-1)+p)%p)%p;\n        }\t \n        printf(\"%lld\\n\",Ans);\n    }\n    return 0;\n}\n```",
        "postTime": 1523497752,
        "uid": 31564,
        "name": "zhoutb2333",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P3700 \u3010[CQOI2017]\u5c0fQ\u7684\u8868\u683c\u3011"
    },
    {
        "content": "[\u9898\u76ee](https://www.luogu.org/problemnew/show/P3700)\n\n\u795e\u4ed9\u9898\uff0c\u795e\u4ed9\u9898\n\n\u8fd9\u662f\u4e00\u9053\u5f88\u9002\u5408\u76ef\u7740\u53d1\u5446\u7684\u9898\u76ee\n\n\u770b\u5230\u8fd9\u4e2a\u89c4\u5f8b\n\n$$\nf(a,b)=f(b,a)\n$$\n\n$$\nb\\times f(a,a+b)=(a+b)\\times f(a,b)\n$$\n\n\u8fd9\u4e5f\u6ca1\u4ec0\u4e48\u89c4\u5f8b\u554a\n\n\u4e8e\u662f\u81ea\u95ed\u4e86\n\n\u76ef\u7740\u53d1\u5446\u4e00\u4e2a\u5c0f\u65f6\u4e4b\u540e\u53d1\u73b0\uff0c\u8fd9\u4e2a$f(a,a+b)$\u548c$f(a,b)$\u6709\u5173\u7cfb\n\n\u56e0\u4e3a\u4fee\u6539$(a,b)$\u5c31\u4e00\u5b9a\u4f1a\u5f71\u54cd$(a,a+b)$\uff0c\u540c\u65f6\u4e5f\u4f1a\u5f71\u54cd$(a,a+2b)...$\n\n\u505c\n\n$$\ngcd(a,a+b)=gcd(a+b,a)=gcd(a,a+b-a)=gcd(a,b)\n$$\n\n\u8fd9\u4e0d\u662f\u66f4\u76f8\u51cf\u635f\u672f\u5417\n\n\u4e8e\u662f\u6211\u4eec\u5f97\u51fa\u4e86\u7b2c\u4e00\u4e2a\u7ed3\u8bba\n\n**\u4fee\u6539$a,b$\u8fd9\u4e2a\u503c\u53ea\u4f1a\u5f71\u54cd$gcd(x,y)=gcd(a,b)$\u7684$f(x,y)$\u7684\u503c**\n\n\u4f46\u662f\u8fd9\u6837\u6211\u4eec\u8fd8\u662f\u6ca1\u6709\u4ec0\u4e48\u529e\u6cd5\u6765\u7ef4\u62a4\u554a\uff0c\u6bd5\u7adf\u77e9\u9635\u90a3\u4e48\u5927\uff0c\u6211\u4eec\u4fee\u6539\u4e00\u6b21\u5f71\u54cd\u7684\u6570\u90a3\u4e48\u591a\n\n\u6211\u4eec\u5927\u80c6\u731c\u60f3\u683c\u5b50\u7684\u503c\u5b58\u5728\u67d0\u79cd\u5173\u7cfb\uff0c\u5982\u679c$gcd(a,b)=d$\uff0c\u90a3\u4e48$f(a,b)$\u80af\u5b9a\u548c$f(d,d)$\u5b58\u5728\u67d0\u79cd\u5173\u7cfb\n\n\u5c1d\u8bd5\u53bb\u6c42\u4e00\u4e0b\u8fd9\u4e2a\u5173\u7cfb\n\n$$f(d,d)\\times 2d=f(d,2d)\\times d$$\n\n$$\nf(d,2d)\\times 3d=f(d,3d)\\times 2d\n$$\n\n\u663e\u7136$f(d,kd)=\\frac{k}{(k-1)}f(d,(k-1)d)=k\\times f(d,kd)$\n\n\u663e\u7136\u7eb5\u5750\u6807\u4e5f\u4f1a\u6709\u8fd9\u6837\u7684\u6027\u8d28\n\n\u4e8e\u662f$f(k_1d,k_2d),k_1\\perp  k_2$\uff0c\u5c31\u4f1a\u6709$k_1\\times k_2\\times f(d,d)=f(k_1d,k_2d)$\n\n\u5176\u5b9e\u4e5f\u5c31\u662f\u8fd9\u6837\n\n$$f(a,b)=\\frac{a\\times b}{(a,b)^2}f((a,b),(a,b))$$\n\n\u8003\u8651\u628a$f(a,b)$\u5199\u6210$\\frac{ab}{d^2}f(d,d)$\n\n\u4e8e\u662f\u6211\u4eec\u53ea\u9700\u8981\u8bb0\u5f55$f(d,d)$\u7684\u503c\u4e86\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5904\u7406\u4fee\u6539\u64cd\u4f5c\u4e86\n\n\u63a5\u4e0b\u6765\u628a$f(d,d)$\u7b80\u8bb0\u505a$f(d)$\n\n\u73b0\u5728\u6211\u4eec\u8981\u6c42\u7684\u67ff\u5b50\u662f\n\n$$\\sum_{i=1}^n\\sum_{j=1}^n\\frac{i\\times j}{(i,j)^2}f((i,j)$$\n\n\u8003\u8651\u4e00\u4e0b\u679a\u4e3e$gcd$\n\n$$\\sum_{d=1}^nf(d)\\sum_{i=1}^{\\left \\lfloor \\frac{n}{d} \\right \\rfloor}\\sum_{j=1}^{\\left \\lfloor \\frac{n}{d} \\right \\rfloor}[(i,j)=1]i\\times j$$\n\n\u90a3\u4e2a\u9664\u4ee5$(i,j)^2$\u6d88\u5931\u4e86\u662f\u56e0\u4e3a\u6211\u4eec\u540e\u9762\u4e58\u4e0a\u7684\u662f$i,j$\uff0c\u672c\u6765\u5c31\u662f\u90fd\u9664\u4ee5$d$\u4e86\u7684\n\n\u4e4b\u540e\u53ea\u8981\u8bb0\u4f4f\u4e00\u6761\uff0c\u5343\u4e07\u522b\u53cd\u6f14\u5c31\u597d\u4e86\n\n\u6211\u4eec\u80fd\u901a\u8fc7\u6b27\u62c9\u51fd\u6570\u628a\u4e0a\u9762\u7684\u67ff\u5b50\u5199\u6210\u8fd9\u4e2a\u6837\u5b50\n\n$$\\sum_{d=1}^nf(d)\\sum_{i=1}^{\\left \\lfloor \\frac{n}{d} \\right \\rfloor}i^2\\varphi(i)$$\n\n\u81f3\u4e8e\u4e3a\u4ec0\u4e48\uff0c\u6211\u4eec\u9700\u8981\u8fd9\u4e2a\u67ff\u5b50\n\n$$\\sum_{i=1}^n[(i,n)=1]i=\\frac{n\\varphi(n)+[n=1]}{2}$$\n\n\u81f3\u4e8e\u8fd9\u4e2a\u67ff\u5b50\u8fd9\u4e48\u6765\u7684\uff0c\u6211\u4eec\u8bc1\u660e\u4e00\u4e0b\n\n$$\\sum_{i=1}^n[(i,n)=1]i=\\sum_{i=1}^ni\\sum_{d|i,d|n}\\mu(d)$$\n\n\u4ea4\u6362\u4e00\u4e0b\u6c42\u548c\u7b26\u53f7\n\n$$=\\sum_{d|n}\\mu(d)\\sum_{d|i}i=\\sum_{d|n}\\mu(d)\\sum_{i=1}^{\\frac{n}{d}}i\\times d$$\n\n$$=\\sum_{d|n}\\mu(d)d\\sum_{i=1}^{\\frac{n}{d}}i=\\sum_{d|n}\\mu(d)d\\frac{(\\frac{n}{d}+1)\\frac{n}{d}}{2}$$\n\n$$=\\frac{n}{2}\\sum_{d|n}\\mu(d)(\\frac{n}{d}+1)=\\frac{n}{2}(n\\sum_{d|n}\\frac{\\mu(d)}{d}+\\sum_{d|n}\\mu(d))$$\n\n\u6211\u4eec\u73b0\u5728\u9700\u8981\u4e24\u6761\u5f88\u57fa\u7840\u7684\u7ed3\u8bba\n\n$$\\sum_{d|n}\\mu(d)=[n=1],\\sum_{d|n}\\frac{\\mu(d)}{d}=\\frac{\\varphi(n)}{n}$$\n\u8fd9\u91cc\u5c31\u4e0d\u518d\u8bc1\u660e\u4e86\n\n\u6839\u636e\u4e0a\u9762\u90a3\u6761\u7ed3\u8bba\u6211\u4eec\u6709\n\n$$\\sum_{i=1}^n\\sum_{j=1}^n[(i,j)=1]i\\times j=\\sum_{i=1}^ni^2\\times \\varphi(i)$$\n\n\u6211\u4eec\u8bbe$S(n)=\\sum_{i=1}^ni^2\\times \\varphi(i)$\n\n\u7b54\u6848\u5c31\u662f\n\n$$\\sum_{i=1}^nS(\\left \\lfloor \\frac{n}{d} \\right \\rfloor)f(d)$$\n\n\u6211\u4eec\u73b0\u5728\u5c31\u53ef\u4ee5\u5c3d\u60c5\u7684\u6574\u9664\u5206\u5757\u4e86\n\n\u4f46\u662f\u7531\u4e8e$f$\u9700\u8981\u652f\u6301\u4fee\u6539\u6211\u4eec\u8fd8\u8981\u67e5\u8be2\u524d\u7f00\u548c\uff0c\u4e8e\u662f\u770b\u8d77\u6765\u6709\u70b9\u81ea\u95ed\uff0c\u56e0\u4e3a\u6811\u72b6\u6570\u7ec4\u7684\u590d\u6742\u5ea6\u9ad8\u8fbe$O(m\\sqrt{n}logn)$\uff0c\u597d\u50cf\u4e0d\u662f\u5f88\u79d1\u5b66\n\n\u4f46\u662f\u4fee\u6539\u5374\u5feb\u7684\u4e00\u6279\uff0c\u4f4e\u5230$O(mlogn)$\uff0c\u8003\u8651\u4e00\u4e2a\u795e\u5947\u7684\u6570\u636e\u7ed3\u6784\uff0c\u53ef\u4ee5\u505a\u5230$O(1)$\u5355\u70b9\u6c42\u548c\n\n\u81ea\u7136\u662f\u795e\u5947\u7684\u5206\u5757\u4e86\uff0c\u6211\u4eec\u76f4\u63a5\u628a$f$\u505a\u6210\u524d\u7f00\u548c\uff0c\u5355\u70b9\u4fee\u6539\u6211\u4eec\u76f4\u63a5\u641e\u6210\u533a\u95f4\u4fee\u6539\uff0c\u4e4b\u540e\u6211\u4eec\u5355\u70b9\u67e5\u8be2\u524d\u7f00\u548c\u5c31\u53ef\u4ee5\u5f88\u5feb\u4e86\n\n\u4ee3\u7801\n\n```cpp\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\n#define re register\n#define LL long long\n#define max(a,b) ((a)>(b)?(a):(b))\n#define min(a,b) ((a)<(b)?(a):(b))\nconst int maxn=4e6+5;\nconst LL mod=1e9+7;\ninline int gcd(int a,int b) {return !b?a:gcd(b,a%b);}\ninline LL read() {\n\tchar c=getchar();LL x=0;while(c<'0'||c>'9') c=getchar();\n\twhile(c>='0'&&c<='9') x=(x<<3)+(x<<1)+c-48,c=getchar();return x;\n}\nint f[maxn],p[maxn>>1];\nLL phi[maxn],pre[maxn],F[maxn];\nint n,m;\nstruct Block {\n\tint sz,tot;\n\tint l[3005],r[3005],id[maxn];\n\tLL tag[3005];\n\tinline void Build() {\n\t\tsz=std::sqrt(n);\n\t\tfor(re int i=1;i<=n;i+=sz) {\n\t\t\tl[++tot]=i,r[tot]=min(i+sz-1,n);\n\t\t\tfor(re int j=l[tot];j<=r[tot];j++) id[j]=tot;\n\t\t}\n\t}\n\tinline LL ask(int x) {return (pre[x]+tag[id[x]])%mod;}\n\tinline void change(int x,LL val) {\n\t\tint j=id[x];\n\t\tif(x==l[j]) tag[j]+=val,tag[j]=(tag[j]+mod)%mod;\n\t\telse for(re int i=x;i<=r[j];i++) pre[i]=(pre[i]+val+mod)%mod;\n\t\tj++;while(j<=tot) tag[j]+=val,tag[j]=(tag[j]+mod)%mod,j++;\n\t}\n}B;\nint main() {\n\tm=read(),n=read();\n\tphi[1]=1;\n\tfor(re int i=2;i<=n;i++) {\n\t\tif(!f[i]) p[++p[0]]=i,phi[i]=i-1;\n\t\tfor(re int j=1;j<=p[0]&&p[j]*i<=n;j++) {\n\t\t\tf[p[j]*i]=1;\n\t\t\tif(i%p[j]==0) {phi[p[j]*i]=p[j]*phi[i];break;}\n\t\t\tphi[p[j]*i]=phi[p[j]]*phi[i];\n\t\t}\n\t}\n\tfor(re LL i=1;i<=n;i++) phi[i]=phi[i-1]+i*i%mod*phi[i]%mod,phi[i]%=mod;\n\tfor(re LL i=1;i<=n;i++) F[i]=(i*i)%mod;\n\tfor(re int i=1;i<=n;i++) pre[i]=pre[i-1]+F[i],pre[i]%=mod;\n\tB.Build();\n\tint a,b,k;LL v;\n\twhile(m--) {\n\t\ta=read(),b=read(),v=read(),k=read();\n\t\tint t=gcd(a,b);LL ans=0;\n\t\tB.change(t,-1ll*F[t]);\n\t\tF[t]=v/((LL)(a/t)*(LL)(b/t));\n\t\tB.change(t,F[t]);\n\t\tfor(re int l=1,r;l<=k;l=r+1) {\n\t\t\tr=k/(k/l);\n\t\t\tans+=phi[k/l]*(B.ask(r)-B.ask(l-1)+mod)%mod,ans%=mod;\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1552901837,
        "uid": 35178,
        "name": "asuldb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3700 \u3010[CQOI2017]\u5c0fQ\u7684\u8868\u683c\u3011"
    },
    {
        "content": "\u795e\u4ed9\u6570\u8bba\u9898\n\n\u7531$bf(a,a+b)=(a+b)f(a,b)$\u5f97\u5230$\\frac{f(a,a+b)}{a(a+b)}=\\frac{f(a,b)}{ab}$\n\n\u7136\u540e\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50\u5f88\u50cf\u8f97\u8f6c\u76f8\u51cf...\u4e8e\u662f\u4e00\u76f4\u8f97\u8f6c\u76f8\u9664\u4e0b\u53bb\n\n$\\frac{f(a,b)}{ab}=\\frac{f(a,a\\mod b)}{a(a\\mod b)}=\\cdots =\\frac{f(\\gcd(a,b),\\gcd(a,b))}{\\gcd(a,b)\\times\\gcd(a,b)}$\n\n\u6362\u53e5\u8bdd\u8bf4\u8bbe$d=\\gcd(a,b)$\uff0c\u90a3\u4e48$f(a,b)=\\frac{abf(d,d)}{d^2}$\n\n\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u7528\u5bf9\u89d2\u7ebf\u4e0a\u7684$f$\u6765\u8868\u793a\u6574\u4e2a\u8868\u683c\u4e86\n\n\u8981\u6c42\u524d$n$\u884c\u524d$n$\u5217\u7684\u7b54\u6848(\u4ee5\u4e0b\u9664\u6cd5\u5747\u5411\u4e0b\u53d6\u6574):\n\n$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^n\\frac{ijf(\\gcd(i,j),\\gcd(i,j)}{\\gcd(i,j)^2}$\n\n$=\\sum\\limits_{d=1}^n\\frac{f(d,d)}{d^2}\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^nij[\\gcd(i,j)=d]$\n\n$=\\sum\\limits_{d=1}^nf(d,d)\\sum\\limits_{i=1}^{n/d}\\sum\\limits_{j=1}^{n/d}ij[\\gcd(i,j)=1]$\n\n$=\\sum\\limits_{d=1}^nf(d,d)\\sum\\limits_{k=1}^{n/d}k^2\\mu(k)(S(n/d/k))^2$\n\n\u5176\u4e2d$S(n)=\\sum\\limits_{i=1}^n=\\frac{n(n+1)}{2}$\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5bf9$n/d$\u5206\u5757\uff0c\u7136\u540e\u7ef4\u62a4$f$\u7684\u524d\u7f00\u548c\u4ee5\u53ca\u540e\u9762\u7684\u4e00\u5768\u4e1c\u897f\n\n\u63d0\u51fa\u6765\u540e\u9762\u7684\u4e00\u5757\uff0c\u6211\u4eec\u9700\u8981\u9884\u5904\u7406\u5b83\n\n$G(n)=\\sum\\limits_{i=1}^ni^2\\mu(i)(S(\\left\\lfloor\\frac{n}{i}\\right\\rfloor))^2$\n\n\u73b0\u5728\u6211\u4eec\u662f\u6570\u5b66\u7ade\u8d5b\u751f\u4e86(\u96fe\n\n\u4f7f\u7528\u5173\u4e8e\u4e0b\u53d6\u6574\u7684\u6280\u5de7\u2014\u2014\u5dee\u5206\n\n$\\left\\lfloor\\frac{n}{i}\\right\\rfloor-\\left\\lfloor\\frac{n-1}{i}\\right\\rfloor=[i\\mid n]$\n\n\u4e8e\u662f$G(n)-G(n-1)=\\sum\\limits_{i\\mid n}i^2\\mu(i)(S(n/i)^2-S(n/i-1)^2)$\n\n$=\\sum\\limits_{i|n}i^2\\mu(i)\\left(\\frac{n}{i}\\right)^3=n^2\\sum\\limits_{i|n}\\mu(i)\\frac{n}{i}=n^2\\varphi(n)$\n\n\u6240\u4ee5$G(n)=\\sum\\limits_{i=1}^ni^2\\varphi(i)$\n\n\u7136\u540e\u76f4\u63a5$O(n)$\u9884\u5904\u7406$G$\u5c31\u597d\u4e86\n\n\u8fd8\u9700\u8981\u4fee\u6539\u600e\u4e48\u529e\n\n\u5982\u679c\u4fee\u6539$f(a,b)=w$\uff0c\u90a3\u4e48\u6839\u636e\u4e00\u5f00\u59cb\u7684\u7b49\u5f0f\u6211\u4eec\u5f97\u5230$f(d,d)=\\frac{d^2f(a,b)}{ab}$\n\n\u6240\u4ee5\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u652f\u6301\u5355\u70b9\u4fee\u6539\u548c\u524d\u7f00\u67e5\u8be2\u7684\u6570\u636e\u7ed3\u6784\n\n\u603b\u7684\u590d\u6742\u5ea6\u662f$\\sqrt{n}\\times\\text{\u67e5\u8be2\u590d\u6742\u5ea6}+\\text{\u4fee\u6539\u590d\u6742\u5ea6}$\n\n\u90a3\u5f53\u7136\u662f\u5206\u5757\u4e86\uff0c\u7ef4\u62a4\u4e00\u4e2a\u524d\u7f00\u548c\u5c31\u597d\u4e86\uff0c$O(\\sqrt{n})-O(\\sqrt{n})$\n\n\u4e5f\u53ef\u4ee5\u505a\u5230$O(\\sqrt{n})-O(n^\\frac{1}{3})$\uff0c\u4e0d\u8fc7\u4eb2\u6d4b\u6ca1\u4ec0\u4e48\u7528\n\n\u6700\u4f18\u89e3\u8dd1\u4e86\u4e2a\u57fa\u4e8e\u4fee\u6539\u4e2d\u4e0d\u540c$gcd$\u4e2a\u6570\u7684\u505a\u6cd5...\u8fd9\u6ce2\u4e71\u641e\u6211\u670d(\u867d\u7136\u53ef\u4ee5\u5361\u6389)\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\nusing namespace std;\nconst int mod=1e9+7;\nconst int N=5e6;\nint a[N],s[N],ss[N],prime[N],p[N],phi[N],cnt,f[N],bl[N],blo,n,m;\nvoid make(int n)\n{\n\tphi[1]=1;\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tif(!p[i])prime[++cnt]=i,phi[i]=i-1;\n\t\tfor(int j=1;j<=cnt&&i*prime[j]<=n;j++)\n\t\t{\n\t\t\tint x=i*prime[j];p[x]=1;\n\t\t\tif(i%prime[j])phi[x]=phi[i]*(prime[j]-1);\n\t\t\telse{phi[x]=phi[i]*prime[j];break;}\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)f[i]=(f[i-1]+1ll*i*i%mod*phi[i])%mod;\n\t\n\tblo=sqrt(n);\n\tfor(int i=1;i<=n;i++)bl[i]=(i-1)/blo+1,a[i]=1ll*i*i%mod;\n\tfor(int i=1;i<=bl[n];i++)\n\t{\n\t\tint l=(i-1)*blo+1,r=min(i*blo,n);s[l]=a[l];\n\t\tfor(int j=l+1;j<=r;j++)s[j]=(s[j-1]+a[j])%mod;\n\t\tss[i]=(ss[i-1]+s[r])%mod;\n\t}\n}\nint query(int n){return (s[n]+ss[bl[n]-1])%mod;}\nvoid update(int x,int w)\n{\n\tint blx=bl[x],r=min(blx*blo,n);\n\tint tw=(w-a[x]+mod)%mod;a[x]=w;\n\tfor(int i=x;i<=r;i++)s[i]=(s[i]+tw)%mod;\n\tfor(int i=blx;i<=bl[n];i++)ss[i]=(ss[i]+tw)%mod;\n}\nint solve(int n)\n{\n\tint i=1,lt=sqrt(n);\n\tint ans=0;\n\n\tfor(;i<=lt;i++)ans=(ans+1ll*a[i]*f[n/i])%mod;\n\tfor(;i<=n;i=lt+1)\n\t{\n\t\tlt=n/(n/i);\n\t\tans=(ans+1ll*(query(lt)-query(i-1))*f[n/i])%mod;\n\t}\n\treturn (ans+mod)%mod;\n}\nint gcd(int x,int y){return y?gcd(y,x%y):x;}\nint main()\n{\n\tscanf(\"%d%d\",&m,&n);\n\tmake(n);\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint u,v,k;long long x;\n\t\tscanf(\"%d%d%lld%d\",&u,&v,&x,&k);\n\t\tint d=gcd(u,v);\n\t\tupdate(gcd(u,v),(x/(u/d)/(v/d))%mod);\n\t\tprintf(\"%d\\n\",solve(k));\n\t}\n}\n```",
        "postTime": 1557709253,
        "uid": 22136,
        "name": "qwaszx",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P3700 \u3010[CQOI2017]\u5c0fQ\u7684\u8868\u683c\u3011"
    },
    {
        "content": "\u53c8\u662f\u4e00\u9053\u6570\u8bba\u795e\u9898\u2026\u2026\n\n\u8fd9\u79cd\u6570\u5b66\u9898\uff0c\u7b2c\u4e00\u8981\u8010\u5fc3\u63a8\u7ed3\u8bba\uff0c\u7b2c\u4e8c\u8981\u52a8\u8d77\u624b\u6765\u5316\u7b80\u5f0f\u5b50\n\n\u6240\u4ee5\u2026\u2026\n\n#### \u5f00\u59cb\u6109\u5feb\u7684\u63a8\u5012\u7ed3\u8bba\u5427~\n\n\u5df2\u77e5 f(a,b)=f(b,a) && b\\*(f(a,a+b))=(a+b)\\*f(a,b)\n\n\u90a3\u4e48\u6211\u4eec\u53d1\u73b0\u7b80\u5355\u53d8\u6362\u4e00\u4e0b\u5c31\u662f\n\n**f(a,a+b)/f(a,b)=(a+b)/b**\n\n\u4e5f\u5c31\u662f\u8bf4 f(a,a+b)\u221df(a,b)\uff0c\u6211\u4eec\u53d1\u73b0\u53ef\u4ee5\u4ee4 b=a+b\uff0c\u6bd4\u4f8b\u5f0f\u4ecd\u7136\u6210\u7acb\n\n\u53e6\u5916\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u6bd4\u503c\u7b49\u4e8e a\\*(a+b)/a\\*b,\uff0c\u540e\u8fb9\u4f1a\u5f88\u6709\u7528\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u9012\u63a8\u51fa\u6765\u8fd9\u4e2a\u7b49\u5f0f\n\n**f(a,k\\*a+b)\u221df(a,b) k\u2208Z+**\n\n\u6b64\u65f6\u6211\u4eec\u8003\u8651\u4e00\u4e0b%\u8fd0\u7b97\u7684\u5b9a\u4e49\uff0c\u82e5 a=Kx+b(k,b\u2208Z)\uff0c\u90a3\u4e48 a%K=b\n\n\u53c8\u56e0\u4e3af(a,b)=f(b,a)\uff0c\u53ef\u4ee5\u5f97\u5230\u8fd9\u4e2a\u7b49\u5f0f\n\n**f(a,b)\u221df(b,a%b)**\n\n\u7136\u540e\u6211\u4eec\u6765\u770b\u53e6\u5916\u4e00\u4e2a\u7b49\u5f0f\n\n**gcd(a,b)=gcd(b,a%b)**\n\n\u6240\u4ee5\u8fd9\u4e2af\u51fd\u6570\u7684\u53d8\u5316\u60c5\u51b5\u548c\u5176\u5b9egcd\u51fd\u6570\u5b8c\u5168\u4e00\u6837\uff0c\u53ea\u662f\u6bcf\u4e00\u6b65\u90fd\u662f\u6210\u6b63\u6bd4\u7684\u4f20\u9012\uff0cgcd\u662f\u7b49\u5f0f\u4f20\u9012\n\n\u6240\u4ee5\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u82b1\u91cc\u80e1\u54e8\u7684\u51fd\u6570\uff0c\u5176\u5b9e\u662f\u5957\u4e86\u4e00\u4e2agcd\u51fd\u6570\u5728\u91cc\u9762\uff0c\u521a\u624d\u7684\u63a8\u5012\u5173\u952e\u5728\u5c06 k\\*a+b b\u4ee3\u6362\u4e3a a%b,b\u7684\u5173\u7cfb\uff0c\u4ece\u800c\u8ba9\u6211\u4eec\u60f3\u5230\u4e86gcd\u51fd\u6570\n\n\u53e6\u5916\uff0c\u7531\u521a\u624d\u7684\u6bd4\u503c\u5b9a\u4e49\u53ef\u4ee5\u5f97\u5230\u8fd9\u4e2a\u4e1c\u897f\n\n**f(a,b)/f(gcd(a,b),gcd(a,b))=a\\*b/gcd(a,b)^2**\n\n\u5316\u7b80\u4e0b\u5c31\u662f(\u4ee5\u4e0b\u8fc7\u7a0b\u5168\u90e8\u7528(i,j)\u4ee3\u6307gcd(i,j)) \n\n**f(i,j)=f((i,j),(i,j))\\*i\\*j/(i,j)^2**\n\n\u8fd8\u8bb0\u5f97\u6211\u4eec\u6c42\u7684\u662f\u4ec0\u4e48\u5f0f\u5b50\u5417\uff1f\n\n**\u03a3(1~k)\u03a3(1~k)f(i,j)**,\u597d\u50cf\u662f\u2026\u2026\u53cd\u6f14\uff1f\n\n\u7531\u4e8e\u731d\u4e0d\u53ca\u9632\u5c31\u662f\u4e00\u53e3\u53cd\u6f14\uff0c\u6211\u4eec\u8fd9\u91cc\u4f1a\u7b80\uff08xiang\uff09\u5355\uff08xi\uff09\u7684\u4ecb\u7ecd\u4e00\u4e0b\u4ec0\u4e48\u662f\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u5e0c\u671b\u5927\u5bb6\u53ef\u4ee5\u770b\u61c2\n\n## \u524d\u7f6e\u829d\u58eb\uff1a\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n\n### \u524d\u7f6e\u829d\u58eb\u7684\u829d\u58eb\uff1a\u72c4\u5229\u514b\u96f7\u5377\u79efX\u79ef\u6027\u51fd\u6570\n\n\u6240\u8c13\u6570\u8bba\u51fd\u6570\uff0c\u662f\u4e00\u7c7b\u5b9a\u4e49\u57df\u5728\u81ea\u7136\u6570\u4e0a\u7684\u51fd\u6570,\u7136\u540e\u6211\u4eec\u4f1a\u628a\u81ea\u7136\u6570\u6620\u5c04\u5230\u590d\u6570\u57df\u53bb\uff0c\u4f46\u662fOI\u4e2d\u5e38\u7528\u7684\u6570\u8bba\u51fd\u6570\u90fd\u662f**\u81ea\u7136\u6570**\u6620\u5c04\u5230**\u6574\u6570**\u4e0a\u7684\u51fd\u6570\n\n\u90a3\u4e48\u6211\u4eec\u5b9a\u4e49\u4e00\u79cd\u795e\u5947\u7684\u8fd0\u7b97\uff0c\u79f0\u4e4b\u4e3a**Dirichlet\u5377\u79ef**\n\n\u5bf9\u4e8e\u4e24\u4e2a\u6570\u8bba\u51fd\u6570 f\uff0cg\uff0c\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e00\u4e2an,**\u679a\u4e3en\u7684\u6240\u6709\u7ea6\u6570\u5bf9**\uff0c\u5206\u522b\u8ba1\u7b97f\u503c\u548cg\u503c\u540e**\u76f8\u4e58\u518d\u76f8\u52a0**\uff0c\u4f1a\u5f97\u5230\u4e00\u4e2a\u503c\uff0c\u8bb0\u4e3aF(n)\u90a3\u4e48\u901a\u8fc7\u8fd9\u6837\u7684\u624b\u6bb5\u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97\u51fa\u6240\u6709\u7684F()\u503c\uff0c\u90a3\u4e48\u5c31\u79f0F\u662ff\u548cg\u8fdb\u884c\u72c4\u5229\u514b\u96f7\u5377\u79ef\u7684\u7ed3\u679c\uff0c\u6570\u5b66\u8868\u8fbe\u5f0f\u5927\u6982\u662f\u8fd9\u4e2a\u6837\u5b50\uff0c(\u72c4\u5229\u514b\u96f7\u5377\u79ef\u7684\u7b26\u53f7\u8bb0\u505aX)\n\n**(fXg)(n)=\u03a3(d|n)f(d)\\*g(n/d)**\n\n\u4e0b\u9762\u6211\u4eec\u6765\u4ecb\u7ecd\u53e6\u4e00\u4e9b\u6709\u8da3\u7684\u51fd\u6570\uff0c\u5b83\u4eec\u88ab\u79f0\u4e4b\u4e3a**\u79ef\u6027\u51fd\u6570**\uff0c\u6240\u8c13\u79ef\u6027\u51fd\u6570\uff0c\u5c31\u662f\u4e00\u4e2a\u51fd\u6570f\u6ee1\u8db3\u4e0b\u5217\u6027\u8d28\n\n1.f(1)=1\n\n**2.\u82e5(i,j)=1,\u5219\u6709f(i\\*j)=f(i)\\*f(j)**\n\n\u4e0b\u9762\u662f\u4e00\u4e9b\u5e38\u7528\u7684\u79ef\u6027\u51fd\u6570\n\n1.\u03c6\u51fd\u6570\uff0c\u03c6(n)\u8868\u793a1~n\u4e2d\u6709\u591a\u5c11\u6570\u548ci\u4e92\u8d28\n\n2.\u03bc\u51fd\u6570\uff0c\u82e5n\u6709\u591a\u4e2a\u76f8\u540c\u7684\u8d28\u56e0\u5b50\uff0c\u03bc(n)=0\uff0c\u82e5n=1,\u03bc(n)=1,\u82e5n\u6709\u591a\u4e2a\u76f8\u5f02\u7684\u8d28\u56e0\u5b50\uff0c\u03bc(n)=(-1)^\u8d28\u56e0\u5b50\u4e2a\u6570\n\n3.\u5e38\u51fd\u6570 1(n)=1\n\n4.id\u51fd\u6570 id(n)=n\n\n5.\u03b5\u51fd\u6570 \u03b5(n)\u4ec5\u5728n=1\u65f6\u4e3a1\uff0c\u5176\u4ed6\u60c5\u51b5\u5747\u4e3a\u96f6\uff0c\u03b5\u662fX\u8fd0\u7b97\u7684\u5355\u4f4d\u5143\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4efb\u610f fX\u03b5=f\n\n### \u4e0b\u9762\u662f\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n------------------------\n\n\u6240\u8c13\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5462\uff0c\u5c31\u662f\u6709\u8fd9\u6837\u4e00\u4e2a\u516c\u5f0f\n\nfX1=g<->\u03bcXg=f\n\n\u4f46\u662f\u8fd9\u4e2a\u516c\u5f0f\u5728OI\u4e2d\u7684\u5e94\u7528\u66f4\u4e3b\u8981\u4f53\u73b0\u5728\u4e0b\u9762\u56db\u4e2a\u516c\u5f0f\u4e0a\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u4f60\u7684\u53cd\u6f14\u5341\u5206\u7684\u4e0d**\u719f\u7ec3**\u7684\u8bdd\uff0c\u53ef\u4ee5\u7528\u8fd94\u4e2a\u516c\u5f0f\u6765**\u66ff\u4ee3**\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u516c\u5f0f(\u800c\u4e14\u597d\u591a\u9898\u57fa\u672c\u5957\u5b8c\u5c31\u7ed3\u675f\u4e86\uff0c\u53cd\u6f14\u4ee4\u4eba\u5934\u5927\u7684\u5730\u65b9\u662f\u5404\u79cd\u9a9a\u6c14\u7684\u4ee3\u6570\u53d8\u6362\uff0c\u4f8b\u5982\u4ea4\u6362\u03a3\uff0c\u4f8b\u5982\u5077\u6362\u53d8\u91cf\uff0c\u53cd\u6f14\u96be\u7406\u89e3\u7684\u4e3b\u8981\u539f\u56e0\u5c31\u662f\u6362\u03a3\uff0c\u540c\u65f6\u5077\u6362\u53d8\u91cf\u610f\u4e49)\n\n**1.id=\u03c6X1**\n\n**2.\u03b5=\u03bcX1**\n\n**3.\u03c6=\u03bcXid**\n\n**4.\u03b5X1=1**\n\n\u597d\u4e86\uff0c\u6709\u4e86\u8fd9\u56db\u4e2a\u516c\u5f0f\u8f85\u4ee5**\u9002(sao)\u5f53(qi)**\u7684\u4ee3\u6570\u53d8\u6362\u6211\u4eec\u5c31\u53ef\u4ee5\u89e3\u51b3\u5927\u90e8\u5206\u7684\u53cd\u6f14\u95ee\u9898\u4e86\n\n-------------------\n\n### \u5f00\u59cb\u63a8\u5012\u540e\u8fb9\u7684\u5f0f\u5b50\u5427~\n\n\u9898\u76ee\u8ba9\u6c42\u7684\u662f\n\n**\u03a3(1~k)\u03a3(1~k)f(i,j)**\n\n\u5957\u4e0a\u6211\u4eec\u4e4b\u524d\u7684\u516c\u5f0f\uff0c\u4f1a\u6709\n\n**\u03a3(1~k)\u03a3(1~k)i\\*j\\*f((i,j),(i,j))/(i,j)^2**\n\n\u8fd9\u91cc\u4f7f\u7528\u4e00\u4e2a\u975e\u5e38\u4f20\u7edf\u7684\u6280\u5de7\uff0c\u53eb**\u679a\u4e3egcd**\uff0c\u4ee4gcd=d\uff0c\u7edf\u8ba1\u6709\u591a\u5c11\u540e\u8fb9\u7684\u5f0f\u5b50\u5bf9\u8fd9\u4e2ad\u503c\u505a\u51fa\u4e86\u8d21\u732e\uff0c\u90a3\u4e48\u6211\u4eec\u53d1\u73b0\uff0c**\u4ee4i=i/d\uff0cj=j/d**\uff0c\u539f\u6765\u7684\u5f0f\u5b50\u53ef\u4ee5\u53d8\u5f62\u6210\u8fd9\u6837\n\n**\u03a3\\[d](1~k) f(d,d)\\*\u03a3(1~k/d)\u03a3(1~k/d)i\\*j\\*\u03b5((i,j))**\n\n _(\u5982\u679cd\u662fi\\*d\u548cj\\*d\u7684gcd\uff0c\u90a3\u4e48(i,j)\u5fc5\u987b\u7b49\u4e8e1\uff0c\u5426\u5219gcd\u662fd\\*(i,j))_\n \n \u4e0b\u9762\u6211\u4eec\u4e0d\u8981\u7740\u6025\u53cd\u6f14\u03b5\uff0c\u4e3a\u4ec0\u4e48\uff1f\u56e0\u4e3a\u73b0\u5728\u5c31\u53cd\u6f14\u4f60\u5c31\u8d70\u8fdc\u4e86\uff0c\u6700\u540e\u63a8\u51fa\u6765\u7684\u5f0f\u5b50\u590d\u6742\u5ea6\u4e0d\u5bf9\u7136\u540egg\n \n \u6211\u4eec\u89c2\u5bdf\u5f97\u5230\u540e\u8fb9\u7684\u5f0f\u5b50\uff0c\u8fd0\u7b97\u5f0f\u662fi\\*j\\*\u03b5((i,j)),\u53d1\u73b0**\u4ea4\u6362i\uff0cj\u540e\u5f0f\u5b50\u7684\u503c\u662f\u4e0d\u53d8\u7684**\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5**\u53ea\u679a\u4e3e\u4e00\u534a(i,j)**\uff0c\u7136\u540e\\*2\uff0c\u7f8e\u4e2d\u4e0d\u8db3\u7684\u662f\u6211\u4eec\u53d1\u73b0i=j\u7684\u60c5\u51b5\u4f1a\u88ab\u8ba1\u7b97\u4e24\u6b21\uff0c\u56e0\u6b64\u6211\u4eec\u8981\u518d\u51cf\u53bbi==j\u7684\u60c5\u51b5\uff0c\u53d8\u5316\u4e4b\u540e\u5f97\u5230\u4e0b\u9762\u7684\u5f0f\u5b50\uff0c(\u8fd9\u4e2a\u662f\u9898\u6700\u96be\u60f3\u7684\u53d8\u6362\uff0c\u56e0\u4e3a\u770b\u5230\u4e86\u03b5\u4e4b\u540e\u7acb\u5373\u53cd\u6f14\u4f1a\u5bfc\u81f4gg\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u8fd9\u6837\u53d8\u6362\u4e00\u4e0b)\n \n** \u03a3\\[d](1~k)f(d,d)\\*(2\\*\u03a3\\[i](1~k/d)\u03a3(1~i)i\\*j\\*\u03b5((i,j))-\u03a3\\[i](1~k/d)i^2\\*\u03b5(i))**\n\n\u53d1\u73b0\u03a3(1~k/d)i^2\\*\u03b5(i)\u4ec5\u5728i==1\u7684\u65f6\u5019\u6709\u503c\uff0c\u6240\u4ee5\uff0c\u53ef\u4ee5\u6362\u62101\uff0c\u518d\u6b21\u5c0f\u5c0f\u7684\u53d8\u6362\u4e0b\u5c31\u662f\n\n** \u03a3\\[d](1~k)f(d,d)\\*(2\\*\u03a3\\[i](1~k/d)i\\*\u03a3(1~i)j\\*\u03b5((i,j))-1)**\n\n\u6b64\u65f6\u6211\u4eec\u53cd\u6f14\u03b5\uff0c\u4f1a\u5f97\u5230\n\n** \u03a3\\[d](1~k)f(d,d)\\*(2\\*\u03a3\\[i](1~k/d)i\\*\u03a3(1~i)j\\*\u03a3\\[t](t|i&t|j)\u03bc(t)-1)**\n\n\u4e0b\u9762\u662f\u53e6\u4e00\u6b65\u86c7\u76ae\u64cd\u4f5c\uff0c**\u4ea4\u6362\u03a3**\uff0c\u6211\u4eec\u5148\u679a\u4e3et,\u770b\u6709\u591a\u5c11\u4e2aj\u53ef\u4ee5\u548c\u03bc(t)\u76f8\u4e58\u53d1\u73b0\u5bf9\u4e00\u4e2at\uff0c**\u4ee4j/=t**\uff0c\u6b64\u65f6j\u57281~i/t\u91cc\u90fd\u53ef\u4ee5\u6ee1\u8db3\u539f\u5148\u679a\u4e3e\u65f6\u7684\u7ea6\u675f\uff0c\u6240\u4ee5\u5c31\u662f\u53d8\u5316\u51fa\u6765\u8fd9\u4e2a\u5f0f\u5b50\n\n** \u03a3\\[d](1~k)f(d,d)\\*(2\\*\u03a3\\[i](1~k/d)i\\*\u03a3\\[t](t|i)\u03bc(t)\\*\u03a3(1~i/t)j-1)**\n\n\u53d1\u73b0\u03a3(1~i/t)j\u662f\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\u6c42\u548c\u516c\u5f0f\uff0c\u53ef\u4ee5\u5feb\u901f\u6c42\u51fa\u503c\uff0c\u8ba9\u6211\u4eec\u7ee7\u7eed\u53d8\u6362~\n\n** \u03a3\\[d](1~k)f(d,d)\\*(2\\*\u03a3\\[i](1~k/d)i\\*\u03a3\\[t](t|i)\u03bc(t)\\*(i*(i/t+1))/2-1)**\n\n\u6211\u4eec\u53d1\u73b0i\u548c\u90a3\u4e2a/2\u90fd\u53ef\u4ee5\u901a\u8fc7**\u4e58\u6cd5\u5206\u914d\u5f8b**\u63d0\u51fa\u53bb\uff0c\u6b64\u65f6\u5f97\u5230\n\n** \u03a3\\[d](1~k)f(d,d)\\*(\u03a3\\[i](1~k/d)i^2\\*\u03a3\\[t](t|i)\u03bc(t)\\*(i/t+1)-1)**\n\n\u6211\u4eec\u4ee4i/t=id(i/t),1=1(i/t),\u6b64\u65f6\u5f97\u5230\n\n** \u03a3\\[d](1~k)f(d,d)\\*(\u03a3\\[i](1~k/d)i^2\\*(\u03a3\\[t](t|i)\u03bc(t)\\*id(i/t)+\u03a3\\[t](t|i)\u03bc(t)\\*1(i/t)))-1)**\n\n\u6211\u4eec\u53d1\u73b0\u8fd9\u91cc\u597d\u50cf\u6709\u4e24\u4e2a**\u6807\u51c6\u72c4\u5229\u514b\u96f7\u5377\u79ef\u7684\u5f62\u5f0f**\uff1f\u2018\n\n** \u03a3\\[d](1~k)f(d,d)\\*(\u03a3\\[i](1~k/d)i^2\\*((\u03bcXid)(i)+(\u03bcX1)(i))-1)**\n\n\u6b64\u65f6\u81ea\u884c\u56de\u53bb\u770b\u516c\u5f0f\u5427\uff0c\u8fd9\u4e24\u4e2a\u5377\u79ef\u90fd\u662f\u53ef\u4ee5\u5316\u7b80\u7684\n\n** \u03a3\\[d](1~k)f(d,d)\\*(\u03a3\\[i](1~k/d)i^2\\*((\u03c6(i)+\u03b5(i))-1)**\n\n\u53d1\u73b0\u03b5(i)\\*i^2\u4ec5\u5728i=1\u7684\u65f6\u5019\u7b49\u4e8e1\uff0c\u53ef\u4ee5\u5316\u7b80\uff0c\u53d8\u6210\u4e00\u4e2a1\u63d0\u51fa\u53bb\u548c\u5916\u9762\u7684-1\u6d88\u6389\n\n** \u03a3\\[d](1~k)f(d,d)\\*\u03a3\\[i](1~k/d)i^2\\*\u03c6(i)**\n\n\u5230\u6b64\u4e3a\u6b62\uff0c\u6570\u5b66\u7ade\u8d5b\u751f\u7684\u5de5\u4f5c\u5b8c\u6210\u4e86\uff0c\u73b0\u5728\u8ba9\u6211\u4eec**\u6b63\u5f0f\u56de\u5230OI**\u4e0a\u6765\n\n----------------------\n\n\u6211\u4eec\u53d1\u73b0\u66b4\u529b\u7684\u6548\u7387\u5341\u5206\u7684\u5dee\u52b2\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651**\u4ea4\u6362\u03a3**\uff0c\u679a\u4e3ek/d\u7684\u503c\uff0c\u90a3\u4e48\u6211\u4eec\u53d1\u73b0\uff0c\u82e5k/d=p\uff0c\u90a3\u4e48\u6ee1\u8db3\u6761\u4ef6\u7684d\u662f\u8fde\u7eed\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c**\u662f\u4e00\u6bb5\u533a\u95f4**\uff0c\n\u800c\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u6bb5\u533a\u95f4\u91ccp\u7684\u503c\u90fd\u662f\u4e00\u6837\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u03a3\\[i](1~k/d)i^2\\*\u03c6(i)\u8fd9\u4e00\u5768\u7684\u7684\u503c\u662f\u4e2a\u5b9a\u503c\uff0c\u56e0\u6b64\u6211\u4eec\u67e5\u51faf(d,d)\u533a\u95f4\u548c\uff0c\u518d\u4e58\u4e0a\u8fd9\u4e2a\u503c\u5c31\u597d\u4e86\n\n\u6211\u4eec\u53d1\u73b0\u03a3\\[i](1~k/d)i^2\\*\u03c6(i)\uff0c\u8fd9\u4e2a\u4e1c\u897f\u7684\u503c\u554a\uff0c\u975e\u5e38\u7684\u597d\u6c42\uff0c\u7b97\u4e2a\u524d\u7f00\u548c\u5c31\u597d\u4e86\uff0c\u4f46\u662f\u6211\u4eec\u67e5\u533a\u95f4\u548c\u7684\u64cd\u4f5c\u5c31\u4f1a\u5341\u5206\u7684\u8fa3\u624b\uff0c\u7b2c\u4e00\u6211\u4eec\u6839\u672c\u4e0d\u77e5\u9053\u67e5\u90a3\u4e00\u6bb5\uff0c\u8fd9\u4e2a\u540e\u8fb9\u4f1a\u901a\u8fc7\u4e00\u4e9b\u5947\u6280\u6deb\u5de7\u89e3\u51b3\uff0c\u4f46\u662f\u6211\u4eec\u77e5\u9053\u4e00\u4e2a\u7ed3\u8bban/d\u7684\u503c\u79cd\u7c7b\u662fn^0.5\u7ea7\u522b\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u4e0d\u7ba1\u600e\u6837\u90fd\u8981\u67e5n^0.5\u6b21\u533a\u95f4\u548c\n\n\u800c\u4fee\u6539\u64cd\u4f5c\uff0c\u5176\u5b9e\u7531\u6700\u65e9\u63a8\u51fa\u7684\u6210\u6bd4\u4f8b\u7ed3\u8bba\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u5176\u5b9e\u5c31\u662f\u628af((a,b),(a,b))\u7684\u503c\u4fee\u6539\u4e3a x/(a/(a,b))/(b/(a,b)) \u8fd9\u91cc\u6211\u4eec\u5343\u4e07\u522b\u72af\u50bb\u53bb\u6c42\u9006\u5143\uff0c\u5e38\u6570\u8d3c\u5927\u4e0d\u8bf4\uff0c\u819c\u7684\u8fd8\u8d3c\u591a\uff0c\u6ce8\u610f\u8fd9\u662f\u4e24\u4e2alonglong\u6574\u9664\uff0c\u662f\u53ef\u4ee5\u9664\u7684\uff01\n\n\u6b64\u65f6\u6211\u4eec\u9700\u8981\u7684\u6570\u636e\u7ed3\u6784\u5c31\u5341\u5206\u660e\u4e86\u4e86\uff0c\u6211\u4eec\u53d1\u73b0\u6211\u4eec\u9700\u8981\u8d44\u74f7**\u5355\u70b9\u4fee\u6539\u533a\u95f4\u6c42\u548c**\uff0c\u53ef\u80fd\u4f60\u4f1a\u77ac\u95f4\u60f3\u5230\u5927\u5bb6\u6240\u70ed\u7231\u7684**\u6811\u72b6\u6570\u7ec4**\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u4f1a\u6709logN\u7684\u4f18\u79c0\u590d\u6742\u5ea6\u2026\u2026\n\n## \u9192\u9192\uff01\u8fd9\u4e2a\u505a\u6cd5\u7684\u590d\u6742\u5ea6\u662fO(N+MlogN\u221aN)!\n\n\u6811\u72b6\u6570\u7ec4\u7684\u4f18\u79c0\u590d\u6742\u5ea6\u662f\u5efa\u7acb\u5728\u53ea\u6709M\u4e2a\u4fee\u6539/\u67e5\u8be2\u64cd\u4f5c\u7684\u57fa\u7840\u4e0a\u7684\uff0c\u95ee\u9898\u662f\uff0c\u8fd9\u9053\u9898\u6709M\u4e2a\u4fee\u6539\uff0c\u5374\u6709M\u221aN\u4e2a\u67e5\u8be2\u2026\u2026\u51fa\u9898\u4eba\u628a\u6570\u636e\u8303\u56f4\u5f00\u52304\\*1e6\u5c31\u662f\u4e3a\u4e86\u5361\u6389\u8fd9\u4e2a\u6b21\u4f18\u7b97\u6cd5\u2026\u2026\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u65e2\u7136\u64cd\u4f5c\u90fd\u4e0d\u5e73\u8861\u4e86\uff0c\u6211\u4eec\u7684\u590d\u6742\u5ea6\u4e5f\u4e0d\u5e94\u8be5\u5e73\u8861\uff0c\u4e00\u79cd\u4fee\u6539\u4e3a\u221aN\uff0c\u67e5\u8be2O(1)\u7684\u6570\u636e\u7ed3\u6784\u5c31\u53ef\u4ee5\u5f88\u597d\u7684\u6ee1\u8db3\u6211\u4eec\u7684\u8981\u6c42\n\n\u518d\u5177\u4f53\u6765\u8bb2\uff0c\u6211\u4eec\u66b4\u529b\u5bf9f\u5efa\u4e00\u4e2a\u524d\u7f00\u548c\uff0c\u4e4b\u540e\u6211\u4eec\u6bcf\u6b21\u5355\u70b9\u4fee\u6539\u5728\u524d\u7f00\u548c\u4e0a\u90fd\u76f8\u5f53\u4e8e\u4e00\u4e2a\u533a\u95f4\u52a0\uff0c\u90a3\u4e48\u6211\u4eec\u66b4\u529b\u7684\u5206\u5757\u6253\u6807\u8bb0\u5373\u53ef\u3002\u7b97\u6cd5\u590d\u6742\u5ea6O(N+M\u221aN)\uff0c\u4f46\u662f\u5176\u5b9e\u8fd8\u662f\u6709\u4e9b\u5403\u4e0d\u6d88\u7684\uff0c\u6ce8\u610f\u5361\u5e38\u6570\u5427\uff0c\u81f3\u4e8e\u90a3\u4e2a\u679a\u4e3ek/d\u7684\u5947\u6280\u6deb\u5de7\uff0c\u6211\u4eec\u8fd8\u662f\u89c1\u4ee3\u7801\u5427\uff0c\u5bf9\u4e86\uff0c\u6211\u4eec\u7684\u679a\u4e3e\u7684\u5c0f\u6280\u5de7\u53ef\u4ee5\u4e5f\u53ef\u4ee5\u5904\u7406\u51fa\u5bf9\u5e94\u7684\u533a\u95f4\n\n\u4e0a\u4ee3\u7801~(\u5176\u5b9e\u4ee3\u7801\u975e\u5e38\u77ed)\n\n```c\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\nusing namespace std;//unsigned long long \u7684\u5e38\u6570\u8f83\u5c0f\u2026\u2026 \ntypedef unsigned long long ll;const int N=4000010;ll mod=1e9+7;\ninline ll gcd(ll a,ll b){if(a<b)swap(a,b);while(b){ll c=a%b;a=b;b=c;}return a;}\nint n;int m;int bs;ll add[N];ll f[N];\ninline void ih(){for(ll i=1;i<=n;i++){f[i]=(f[i-1]+(i*i)%mod)%mod;}}\ninline ll fb(ll p){return (p)?p-(p-1)%bs:0;}//\u8fd9\u91cc\u52a8\u6001\u627e\u51fa\u5206\u5757\u5de6\u7aef\u70b9 \ninline ll sum(int l,int r){return (f[r]+add[fb(r)]+2LL*mod-f[l-1]-add[fb(l-1)])%mod;}\ninline void setval(ll p,ll val)\n{\n    val=(val+mod-sum(p,p))%mod;\n    for(;fb(p)==fb(p-1);p++){f[p]=(f[p]+val)%mod;}//\u5148\u679a\u4e3e\u5de6\u8fb9\u7684\u6563\u70b9 \n    for(;p+bs-1<=n;p+=bs){add[p]=(add[p]+val)%mod;}//\u4e2d\u95f4\u7684\u533a\u95f4\uff0c\u679a\u4e3e\u5de6\u7aef\u70b9 \n    for(;p<=n;p++){f[p]=(f[p]+val)%mod;}//\u518d\u679a\u4e3e\u53f3\u8fb9\u7684\u6563\u70b9 \n}\nbool book[N];int zhi[N];int cnt;ll phi[N];ll sump[N];\nint main()\n{\n    scanf(\"%d%d\",&m,&n);bs=sqrt(n);ih();phi[1]=1;\n    for(int i=2;i<=n;i++)//\u6b27\u62c9\u7b5bphi \n    {\n        if(!book[i]){zhi[++cnt]=i;phi[i]=i-1;}\n        for(int j=1;j<=cnt&&i*zhi[j]<=n;j++)\n        {\n            book[i*zhi[j]]=true;\n            if(i%zhi[j]==0){phi[i*zhi[j]]=phi[i]*zhi[j];break;}\n            else {phi[i*zhi[j]]=phi[i]*phi[zhi[j]];}\n        }\n    }\n    for(ll i=1;i<=n;i++){sump[i]=(sump[i-1]+phi[i]*((i*i)%mod))%mod;}//\u6253\u8868\u524d\u7f00\u548c \n    for(int i=1;i<=m;i++)\n    {\n        ll a;ll b;ll x;int k;scanf(\"%lld%lld%lld%d\",&a,&b,&x,&k);\n        ll g=gcd(a,b);x/=(a/g)*(b/g);setval(g,x);int p=1;ll res=0;//\u8fd9\u91cc\u5c31\u662f\u90a3\u4e2a\u679a\u4e3en/d\u7684\u9ed1\u79d1\u6280\u5566 \n        for(int i=1;i<=k;i=p+1){p=k/(k/i);res=(res+sum(i,p)*sump[k/i])%mod;}\n        printf(\"%llu\\n\",res); \n    }return 0;//\u62dc\u62dc\u7a0b\u5e8f~ \n}\n\n```\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n \n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "postTime": 1520344716,
        "uid": 56384,
        "name": "shadowice1984",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3700 \u3010[CQOI2017]\u5c0fQ\u7684\u8868\u683c\u3011"
    },
    {
        "content": "\u8fd9\u9898\u9ed1\uff1f2.04s \u62a2\u5230\u6700\u4f18\u89e3\u3002\n\n\u9898\u9762\u7ed9\u7684\u4e24\u4e2a\u6761\u4ef6\u5c31\u662f\u8f97\u8f6c\u76f8\u9664\uff08\u51cf\uff09\uff0c\u8fdb\u4e00\u6b65\u5f53 $\\gcd(x',y')=\\gcd(x,y)$\uff0c\u5219\n$$\\frac{f(x,y)}{xy}=\\frac{f(x',y')}{x'y'}$$\n\u6052\u6210\u7acb\u3002\n\n\u6240\u4ee5\u53d8\u91cf\u53ea\u6709 $\\forall x\\in[1,n]\\cap\\mathbb Z,f(x,x)$\u3002\n\n\u5bf9\u4e8e\u8be2\u95ee\u6709\n$$\\begin{aligned}\n&\n\\sum_{i=1}^m\\sum_{j=1}^mf(i,j)\n\\\\=&\n\\sum_{i=1}^mf(i,i)\\sum_{j=1}^{\\lfloor m/i\\rfloor}\\sum_{k=1}^{\\lfloor m/i\\rfloor}jk[\\gcd(j,k)=1]\n\\\\=&\n\\sum_{i=1}^mf(i,i)\\sum_{j=1}^{\\lfloor m/i\\rfloor}j^2\\varphi(j)\n\\end{aligned}$$\n\u540e\u9762\u53ef\u4ee5\u7ebf\u6027\u7b5b\u7ebf\u6027\u9884\u5904\u7406\uff0c\u524d\u9762\u6309\u9664 $m$ \u7684\u5546\u6574\u9664\u5206\u5757\u3002\n\n$f(i,i)$ \u7528\u5206\u5757\uff0c\u8bb0\u5f55\u5757\u5185\u524d\u7f00\u548c\uff0c\u5355\u70b9\u6539\u590d\u6742\u5ea6\u4e3a\u5757\u957f\uff0c\u533a\u95f4\u67e5\u8be2\u590d\u6742\u5ea6\u4e3a\u5305\u542b\u5728\u533a\u95f4\u5185\u6574\u5757\u4e2a\u6570\u3002\n\n\u5757\u957f\u53d6 $\\sqrt n$\uff0c\u590d\u6742\u5ea6 $O(n+m\\sqrt n)$\u3002",
        "postTime": 1677317429,
        "uid": 101868,
        "name": "I_am_Accepted",
        "ccfLevel": 0,
        "title": "P3700 [CQOI2017]\u5c0f Q \u7684\u8868\u683c\uff08gcd/\u6574\u9664\u5206\u5757/\u5206\u5757\uff09"
    },
    {
        "content": "\u8fd9\u771f\u662f\u4e00\u9053\u795e\u4ed9\u6570\u8bba\u9898\u3002\n\n\u8f6c\u5ff5\u4e00\u60f3\u8fd9\u660e\u663e\u53c8\u662f\u4e00\u9053\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u795e\u4ed9\u9898\u3002\n\n[\u6ca1\u6709\u5b66\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u670b\u53cb\u4eec\u6765\u770b\u4e00\u770b\u8fd9\u4e2a\u535a\u5ba2](https://www.cnblogs.com/Mobius-strip/p/15243609.html)\n\n\u9996\u5148\u6211\u4eec\u8981\u6574\u7406\u4e00\u4e0b\u9898\u76ee\u7ed9\u51fa\u7684\u6240\u6709\u6761\u4ef6\u3002\n\n\u6839\u636e\u6700\u5927\u516c\u7ea6\u6570\u7684\u6027\u8d28\u5f97\u5230\uff1a\n\n$$\\gcd(a+b,b)=\\gcd(a,b+a)=\\gcd(a,b)$$\n\n\u63a5\u7740\u6211\u4eec\u8fd8\u53d1\u73b0\u82e5\u6539\u53d8\u4e86 $(x,y)$\uff0c\u6240\u6709 $\\gcd(x,y)=\\gcd(l,j)$ \u4e2d\u7684 $(l,j)$ \u7684\u4f4d\u7f6e\u90fd\u4f1a\u53d1\u751f\u6539\u53d8\uff0c\u8fd9\u91cc\u4ee4 $d=\\gcd(l,j)$\uff0c\u5219\u6709\uff1a\n\n$$f(l,j)=\\frac{f(d,d)\\times i\\times j}{d^2}$$\n\n\u6211\u4eec\u4ee5\u53ea\u4fdd\u7559\u4e00\u7ef4\uff0c\u5bf9\u4e8e\u6240\u6709 $\\gcd(i,j)=d$ \u7684\u6570\u5bf9 $(i,j)$ \u90fd\u6709  $f(i,j)=f(d)\\times i\\times j$\n\n\u90a3\u4e48\u7b54\u6848\u5c31\u6709\uff1a\n\n$$ans=\\sum_{d=1}^{n}f(d) \\sum_{i=1}^{n} \\sum_{j=1}^{n}[\\gcd(i,j)=d]i\\times j$$\n\n$$ans=\\sum_{d=1}^{n}f(d)\\times d^2\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor} \\sum_{j=1}^{\\lfloor \\frac{n}{d} \\rfloor}[\\gcd(i,j)=1]i\\times j$$\n\n\u505a\u5230\u8fd9\u91cc\u5c31\u662f\u4e24\u79cd\u9014\u5f84\u4e86\u3002\n\n\u7b2c\u4e00\u79cd\u662f\u6839\u636e\uff1a\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{n}[\\gcd(i,j)=1]i\\times j\\Longleftrightarrow \\sum_{i=1}^{n}\\varphi(i)\\times i^2$$\n\n\u6765\u7b5b\u7834 $\\varphi$\uff0c\u7531\u4e8e\u672c\u4eba\u662f\u4e2a\u5927\u849f\u84bb\uff0c\u6240\u4ee5\u4e0d\u505a\u8fc7\u591a\u8bb2\u89e3\u3002\n\n\u7b2c\u4e8c\u79cd\u6bd4\u8f83\u590d\u6742\uff0c\u770b\u5230\u9898\u91cc\u9762\u6709\u5e03\u5c14\u8868\u8fbe\u5f0f\uff0c\u81ea\u7136\u800c\u7136\u60f3\u5230\u4e86\u5957 $\\mu$\u3002\n\n$$ans=\\sum_{d=1}^{n}f(d)\\times d^2\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor} \\sum_{j=1}^{\\lfloor \\frac{n}{d} \\rfloor}i\\times j\\sum_{x|\\gcd(i,j)}\\mu (x)$$\n\n\u63a5\u7740\u63a8\u5230\uff1a\n\n$$ans=\\sum_{d=1}^{n}f(d)\\times d^2\\sum_{x=1}^{\\lfloor \\frac{n}{d} \\rfloor} \\mu (x)\\times x^2\\times S(\\lfloor \\frac{n}{dx} \\rfloor)^2$$\n\n\u4ee4\n\n$$g(n)=\\sum_{i=1}^{n}\\mu (i)\\times i^2\\times S(\\lfloor \\frac{n}{i} \\rfloor)^2$$\n\n\u6211\u4eec\u4e0d\u96be\u53d1\u73b0 $g(n)$ \u662f\u53ef\u4ee5\u9012\u63a8\u53d1\u5c55\u7684\uff0c\u516c\u5f0f\u4e3a\uff1a\n\n$$g(n)=g(n-1)+n^3\\sum_{i|n}\\frac{\\mu (i)}{i}$$\n\n\u4e2d\u95f4\u53c8\u4ee4\n\n$$w(n)=\\sum_{i|n}\\frac{\\mu (i)}{i}$$\n\n\u53c8\u53d1\u73b0 $w(n)$ \u662f\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\uff0c\u53ef\u4ee5\u6765\u4e00\u6ce2\u7ebf\u6027\u7b5b\uff0c\u540c\u65f6 $g(n)$ \u4e5f\u53ef\u4ee5\u8f7b\u8f7b\u677e\u677e\u5730\u63a8\u7406\u51fa\u6765\u3002\n\n\u6700\u540e\u7528\u5206\u5757\u4f18\u5316\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u7528\u524d\u7f00\u548c\u589e\u6548\uff0c\u5c31\u5b8c\u6210\u4e86\u4e00\u9053\u9ed1\u9898\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define rep(i,st,ed) for(register int i=st;i<=ed;i++)\n#define drp(i,st,ed) for(register int i=st;i>=ed;i--)\ntypedef long long LL;\nconst int MOD=1000000007;\nLL inv[4000005],f[4000005],g[4000005],h[4000005];\nLL t[2005][2005],sum[2005];\nint st[2005],ed[2005],bel[2005],prime[4000005];\nint n,m;\nbool nprime[4000005];\nvoid mod(LL &x)\n{\n    x-=x>=MOD?MOD:0;\n}\ninline int gcd(int x,int y)\n{\n    return (!y)?(x):gcd(y,x%y);\n}\nvoid pre_work()\n{\n    inv[1]=f[1]=g[1]=h[1]=1;\n    rep(i,2,n)\n\t{\n        f[i]=1;\n        inv[i]=(MOD-MOD/i)*inv[MOD%i]%MOD;\n        if(!nprime[i])\n\t\t{\n            prime[++prime[0]]=i;\n            h[i]=(1-inv[i]+MOD)%MOD;\n        }\n        for(register int j=1,x=i*prime[j];i*prime[j]<=n&&j<=prime[0];x=i*prime[++j])\n\t\t{\n            nprime[x]=1;\n            if(i%prime[j]==0)\n\t\t\t{\n                h[x]=h[i];\n                break;\n            }\n            h[x]=(h[i]*h[prime[j]])%MOD;\n        }\n        mod(g[i]=g[i-1]+((LL)i%MOD*(LL)i%MOD*(LL)i%MOD*h[i]%MOD)%MOD);\n    }\n    int size=(int)ceil(sqrt(n));\n    rep(i,1,n)\n\t{\n        bel[i]=(i-1)/size+1;\n        if(!st[bel[i]]) st[bel[i]]=i;\n        ed[bel[i]]=std:: max(ed[bel[i]],i);\n    }\n    rep(b,1,bel[n])\n\t{\n        rep(i,st[b],ed[b])\n\t\t{\n            t[b][i-st[b]+1]=(t[b][i-st[b]]+f[i]*i%MOD*i%MOD)%MOD;\n        }\n    }\n    drp(b,bel[n],1)\n\t{\n        sum[b]=(sum[b+1]+t[b][ed[b]-st[b]+1])%MOD;\n    }\n}\ninline void modify(int x)\n{\n    int bx=bel[x];\n    rep(i,x,ed[bx]) t[bx][i-st[bx]+1]=(t[bx][i-st[bx]]+f[i]*(LL)i%MOD*(LL)i%MOD)%MOD;\n    drp(i,bx,1) sum[i]=(sum[i+1]+t[i][ed[i]-st[i]+1])%MOD;\n}\ninline LL query(int x,int y)\n{\n    int bx=bel[x],by=bel[y];\n    if(bx==by) return (t[bx][y-st[bx]+1]%MOD-t[bx][x-st[bx]]%MOD+MOD)%MOD;\n    LL ret=0;\n    mod(ret+=t[bx][ed[bx]-st[bx]+1]-t[bx][x-1-st[bx]+1]+MOD);\n    mod(ret+=t[by][y-st[by]+1]);\n    mod(ret+=sum[bx+1]-sum[by]+MOD);\n    return ret;\n}\ninline void solve(int n)\n{\n    LL ans=0;\n    for(register int i=1,j;i<=n;i=j+1)\n\t{\n        j=n/(n/i);\n        mod(ans+=query(i,j)*g[n/i]%MOD);\n    }\n    cout<<ans<<endl;\n}\nint main(void)\n{\n    cin>>m>>n;\n    pre_work();\n    int a,b,k,d;LL x;\n    while(m--)\n\t{\n        cin>>a>>b>>x>>k;\n        x=x%MOD;\n        f[d=gcd(a,b)]=x*inv[a]%MOD*inv[b]%MOD;\n        modify(d);solve(k);\n    }\n    return 0;\n}\n```",
        "postTime": 1644120435,
        "uid": 439177,
        "name": "Super_Sheep",
        "ccfLevel": 0,
        "title": "P3700\u9898\u89e3"
    },
    {
        "content": "[P3700 [CQOI2017]\u5c0fQ\u7684\u8868\u683c](https://www.luogu.com.cn/problem/P3700)\n\n## Description\n\n- \u6709\u4e00\u4e2a\u65e0\u7a77\u591a\u884c\uff0c\u65e0\u7a77\u591a\u5217\u7684\u8868\u683c\uff0c\u884c\u5217\u4ece $1$ \u5f00\u59cb\u6807\u53f7\uff0c\u7b2c $a$ \u884c $b$ \u5217\u6709\u4e00\u4e2a\u6574\u6570 $f(a, b)$\uff1b\n- $f(a, b)$ \u5e94\u6ee1\u8db3\uff1a\n  - $\\forall a, b \\in \\mathbb{N}^*, f(a, b) = f(b, a)$\uff1b\n  - $\\forall a, b\\in \\mathbb{N}^*, b\\cdot f(a, a + b) = (a + b) \\cdot f(a, b)$\u3002\n- \u521d\u59cb\u65f6\uff0c$\\forall a, b\\in \\mathbb{N}^*, f(a, b) = ab$\uff08\u663e\u7136\u8fd9\u6ee1\u8db3\u8981\u6c42\uff09\uff1b\n- $m$ \u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u7ed9\u51fa $4$ \u4e2a\u6574\u6570 $a, b, x, k$\uff0c\u8868\u793a\u4ee4 $f(a, b) \\gets x$\uff0c\u7136\u540e\u628a\u5b83\u80fd\u591f\u6ce2\u53ca\u5230\u7684\u6240\u6709\u683c\u5b50\u5168\u90e8\u4fee\u6539\uff0c\u4fdd\u8bc1\u4fee\u6539\u4e4b\u540e\u6240\u6709\u683c\u5b50\u7684\u6570\u4ecd\u7136\u90fd\u662f\u6574\u6570\uff0c\u4fee\u6539\u5b8c\u6210\u540e\u8ba1\u7b97\u524d $k$ \u884c\u524d $k$ \u5217\u91cc\u6240\u6709\u6570\u7684\u548c $\\bmod (10^9 + 7)$\uff1b\n- $1 \\le m \\le 10^4, 1 \\le a, b, k \\le n \\le 4 \\times 10^6, 0 \\le x < 10^{18}$\u3002\n\n## Solution\n\n\u5bf9\u4e8e\u6027\u8d28 $2$\uff0c\u76f4\u63a5\u770b\u662f\u4e0d\u4f1a\u6709\u4efb\u4f55\u601d\u8def\u7684\u3002\n\n\u6211\u4eec\u5c1d\u8bd5\u5bf9\u5f0f\u5b50\u8fdb\u884c\u79fb\u9879\uff1a\n\n$$b\\cdot f(a, a + b) = (a + b) \\cdot f(a, b)$$\n\n$$\\dfrac{f(a, a + b)}{a + b} = \\dfrac{f(a, b)}{b}$$\n\n\u6839\u636e\u6027\u8d28 $1$\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53 $a > b$ \u65f6\uff0c\u6709\n\n$$\\dfrac{f(a, b)}{a} = \\dfrac{f(b, a \\bmod b)}{a \\bmod b}$$\n\n\u56de\u5fc6\u8f97\u8f6c\u76f8\u9664\u6cd5\u7684\u516c\u5f0f\uff1a\n\n$$\\gcd(a, b) = \\gcd(b, a \\bmod b)$$\n\n\u53d1\u73b0\u548c\u4e0a\u9762\u957f\u7684\u5f88\u50cf\u3002\n\n\u6211\u4eec\u518d\u628a\u8fd9\u4e2a\u5f0f\u5b50\u6539\u9020\u4e00\u4e0b\uff1a\n\n$$\\dfrac{f(a, b)}{a \\cdot b} = \\dfrac{f(b, a\\bmod b)}{b\\cdot (a\\bmod b)}$$\n\n\u8f97\u8f6c\u76f8\u9664\u6cd5\u7684\u6700\u540e\u4e00\u6b65\u662f\n\n$$\\gcd(a, b) = \\gcd(\\gcd(a, b), 0)$$\n\n\u800c\u8fd9\u91cc\u8981\u6c42 $a, b > 0$\uff0c\u5373\n\n$$\\gcd(a, b) = \\gcd(\\gcd(a, b), \\gcd(a, b))$$\n\n\u4f53\u73b0\u5728\u539f\u5f0f\u4e2d\u5c31\u662f\n\n$$\\dfrac{f(a, b)}{a\\cdot b} = \\dfrac{f(\\gcd(a, b), \\gcd(a, b))}{\\gcd(a, b)^2}$$\n\n\u5373\n\n$$f(a, b) = \\dfrac{ab\\cdot f(\\gcd(a, b), \\gcd(a, b))}{\\gcd(a, b)^2}$$\n\n\u5bf9\u4e8e\u67e5\u8be2\u64cd\u4f5c\uff1a\n\n$$\n\\begin{aligned}\nans\n& = \\sum_{d = 1}^k \\sum_{i = 1}^k \\sum_{j = 1}^k \\dfrac{ij\\cdot f(d, d)}{d^2} [\\gcd(i, j) = d] \\\\\n& = \\sum_{d = 1}^k f(d, d) \\sum_{i = 1}^{\\left\\lfloor\\frac{k}{d}\\right\\rfloor} i \\sum_{j = 1}^{\\left\\lfloor\\frac{k}{d}\\right\\rfloor} j [\\gcd(i, j) = 1]\n\\end{aligned}\n$$\n\n\u6839\u636e\n\n$$n \\sum_{i = 1}^n i [\\gcd(i, n) = 1] = n \\cdot \\dfrac{n \\varphi(n) + \\varepsilon(n)}{2}$$\n\n\u53d1\u73b0\u8fd9\u91cc $j$ \u53ef\u80fd\u5927\u4e8e $i$\uff0c\u6839\u636e\u5bf9\u79f0\u6027\u4e58 $2$ \u5373\u53ef\u3002\n\n\u4f46\u6240\u6709 $i = j$ \u7684\u60c5\u51b5\u90fd\u88ab\u91cd\u590d\u7b97\u4e86 $2$ \u6b21\uff1b\u4e0d\u8fc7\u5bf9\u4e8e $i = j > 1$ \u7684\u60c5\u51b5\uff0c$\\gcd(i, j) \\ne 1$\uff0c\u672c\u8eab\u4e0d\u4f1a\u4ea7\u751f\u8d21\u732e\uff1b\u53ea\u6709 $i = j = 1$ \u7684\u60c5\u51b5\u88ab\u91cd\u590d\u7b97\u4e86\u3002\n\n\u5b9e\u9645\u4e0a $i = j = 1$ \u7684\u8d21\u732e\u662f $1\\times 1\\times 1 = 1$\uff0c\u800c $\\dfrac{1\\times \\varphi(1) + \\varepsilon(1)}{2} \\times 2 = 2$\uff0c\u89e3\u51b3\u65b9\u6848\u662f\u76f4\u63a5\u628a $\\varepsilon$ \u7ed9\u6254\u6389\uff0c\u8fd9\u6837 $\\dfrac{1\\times\\varphi(1)}{2} \\times 2 = 1$ \u800c\u4e14\u5bf9\u4e8e $i > 1$ \u7684\u60c5\u51b5\u53bb\u6389 $\\varepsilon$ \u6ca1\u6709\u5f71\u54cd\u3002\n\n\u7efc\u4e0a\uff0c\n\n$$\n\\begin{aligned}\n\\sum_{i = 1}^n i \\sum_{j = 1}^n  j [\\gcd(i, j)]\n& = \\sum_{i = 1}^n i\\cdot \\dfrac{i \\varphi(i)}{2} \\cdot 2 \\\\\n& = \\sum_{i = 1}^n i^2 \\varphi(i)\n\\end{aligned}\n$$\n\n\u8bbe\u5176\u4e3a $g(n)$\uff0c\u53d1\u73b0 $g$ \u53ef\u4ee5 $O(n)$ \u9884\u5904\u7406 $O(1)$ \u56de\u7b54\u3002\n\n\u4ee3\u56de\u539f\u5f0f\n\n$$\nans = \\sum_{d = 1}^k f(d, d) g\\left(\\left\\lfloor\\dfrac{k}{d}\\right\\rfloor \\right)\n$$\n\n\u6109\u5feb\u5730\u6574\u9664\u5206\u5757\u3002\n\n\u6574\u9664\u5206\u5757\u4e2d\u8981\u7528\u5230 $f(n, n)$ \u7684\u524d\u7f00\u548c\uff0c\u90a3\u4e48\u4fee\u6539\u76f4\u63a5\u7528\u6811\u72b6\u6570\u7ec4\u5355\u70b9\u4fee\u6539\u5373\u53ef\uff0c\u67e5\u8be2\u5c31\u662f\u533a\u95f4\u67e5\u8be2\u3002\n\n\u67e5\u8be2\u662f $O(m\\sqrt{n} \\log n)$ \u7684\uff0c\u800c\u4fee\u6539\u624d $O(m \\log n)$\uff0c\u867d\u7136\u80fd\u8fc7\u4f46\u5f88\u4e0d\u4f18\u3002\n\n\u8003\u8651\u6709\u4ec0\u4e48\u6570\u636e\u7ed3\u6784\u80fd\u505a\u5230 $O(1)$ \u67e5\u8be2\uff1a\u5206\u5757\u2014\u2014\u4f46\u53ea\u80fd\u5355\u70b9\u67e5\u8be2\u3002\n\n\u8fd9\u4e5f\u4e0d\u96be\uff0c\u628a\u7ef4\u62a4\u7684\u4e1c\u897f\u6539\u4e3a\u524d\u7f00\u548c\uff0c\u67e5\u8be2\u5c31\u662f $O(1)$\uff0c\u4fee\u6539\u5c31\u4fee\u6539 $\\gcd(a,b) \\sim n$\uff0c\u662f $O(\\sqrt{n})$ \u7684\u3002\n\n\u5177\u4f53\u5730\uff0c\u9898\u76ee\u4e2d\u8981 $f(a, b) \\gets x$\uff0c\u6839\u636e\u4e0a\u9762\u7684\u516c\u5f0f\u5c31\u662f\n\n$$\nf(\\gcd(a, b), \\gcd(a, b)) \\gets \\dfrac{x \\cdot \\gcd(a, b)^2}{ab}\n$$\n\n\u8fd9\u6837\u5c31\u505a\u5230\u4e86\u5e73\u8861\u2014\u2014\u4fee\u6539\u67e5\u8be2\u5747\u4e3a $O(m\\sqrt{n})$\uff0c\u6bd4\u6811\u72b6\u6570\u7ec4\u4e0d\u77e5\u9053\u5feb\u4e86\u591a\u5c11\u500d\u3002\n\n## Code\n\n```cpp\n//18 = 9 + 9 = 18.\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#define Debug(x) cout << #x << \"=\" << x << endl\ntypedef long long ll;\nusing namespace std;\n\nconst int MOD = 1e9 + 7;\nint add(int a, int b) {return (a + b) % MOD;}\nint sub(int a, int b) {return (a - b + MOD) % MOD;}\nint mul(int a, int b) {return (ll)a * b % MOD;}\n\nconst int MAXN = 4e6 + 5;\ntypedef int arr[MAXN];\n\nstruct DS\n{\n\tarr L, R, belong, val, tag, a;\n\t\n\tvoid build(int n)\n\t{\n\t\tint t = sqrt(n);\n\t\tfor (int i = 1; i <= t; i++)\n\t\t{\n\t\t\tL[i] = R[i - 1] + 1, R[i] = i * t;\n\t\t}\n\t\tif (R[t] < n)\n\t\t{\n\t\t\tt++;\n\t\t\tL[t] = R[t - 1] + 1, R[t] = n;\n\t\t}\n\t\tfor (int i = 1; i <= t; i++)\n\t\t{\n\t\t\tfor (int j = L[i]; j <= R[i]; j++)\n\t\t\t{\n\t\t\t\tbelong[j] = i;\n\t\t\t\ta[j] = mul(j, j);\n\t\t\t\tval[j] = add(val[j - 1], a[j]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tvoid update(int l, int r, int x)\n\t{\n\t\tint k = sub(x, a[l]);\n\t\ta[l] = x;\n\t\tint p = belong[l], q = belong[r];\n\t\tif (p == q)\n\t\t{\n\t\t\tfor (int i = l; i <= r; i++)\n\t\t\t{\n\t\t\t\tval[i] = add(val[i], k);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor (int i = l; i <= R[p]; i++)\n\t\t\t{\n\t\t\t\tval[i] = add(val[i], k);\n\t\t\t}\n\t\t\tfor (int i = L[q]; i <= r; i++)\n\t\t\t{\n\t\t\t\tval[i] = add(val[i], k);\n\t\t\t}\n\t\t\tfor (int i = p + 1; i < q; i++)\n\t\t\t{\n\t\t\t\ttag[i] = add(tag[i], k);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tint query(int x)\n\t{\n\t\treturn add(val[x], tag[belong[x]]);\n\t}\n\t\n\tint GetSum(int l, int r)\n\t{\n\t\treturn sub(query(r), query(l - 1));\n\t}\n}D;\n\nstruct Math\n{\n\tarr p, phi, g;\n\tbool vis[MAXN];\n\t\n\tvoid pre(int n)\n\t{\n\t\tphi[1] = 1;\n\t\tfor (int i = 2; i <= n; i++)\n\t\t{\n\t\t\tif (!vis[i])\n\t\t\t{\n\t\t\t\tp[++p[0]] = i;\n\t\t\t\tphi[i] = i - 1;\n\t\t\t}\n\t\t\tfor (int j = 1; j <= p[0] && i * p[j] <= n; j++)\n\t\t\t{\n\t\t\t\tvis[i * p[j]] = true;\n\t\t\t\tif (i % p[j] == 0)\n\t\t\t\t{\n\t\t\t\t\tphi[i * p[j]] = phi[i] * p[j];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tphi[i * p[j]] = phi[i] * phi[p[j]];\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor (int i = 1; i <= n; i++)\n\t\t{\n\t\t\tg[i] = add(g[i - 1], mul(mul(i, i), phi[i]));\n\t\t}\n\t}\n\t\n\tint gcd(int a, int b)\n\t{\n\t\tif (!b)\n\t\t{\n\t\t\treturn a;\n\t\t}\n\t\treturn gcd(b, a % b);\n\t}\n\t\n\tint block(int n)\n\t{\n\t\tint res = 0;\n\t\tfor (int l = 1, r; l <= n; l = r + 1)\n\t\t{\n\t\t\tint k = n / l;\n\t\t\tr = n / k;\n\t\t\tres = add(res, mul(D.GetSum(l, r), g[k]));\n\t\t}\n\t\treturn res;\n\t}\n}M;\n\nint main()\n{\n\tint m, n;\n\tscanf(\"%d%d\", &m, &n);\n\tD.build(n), M.pre(n);\n\twhile (m--)\n\t{\n\t\tint a, b, k; ll xx;\n\t\tscanf(\"%d%d%lld%d\", &a, &b, &xx, &k);\n\t\tint d = M.gcd(a, b);\n\t\txx = xx / (a / d) / (b / d);\n\t\tint x = xx % MOD;\n\t\tD.update(d, n, x);\n\t\tprintf(\"%d\\n\", M.block(k));\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1643723194,
        "uid": 305532,
        "name": "mango09",
        "ccfLevel": 0,
        "title": "\u300e\u9898\u89e3\u300fLuogu-P3700 [CQOI2017]\u5c0fQ\u7684\u8868\u683c"
    },
    {
        "content": "### [P3700 [CQOI2017]\u5c0fQ\u7684\u8868\u683c](https://www.luogu.com.cn/problem/P3700)\n\n\u6709\u4e00\u4e2a\u8868\u683c\uff0c\u6ee1\u8db3\uff1a\n$$\n\\begin{aligned}\n&f(a,b)=f(b,a)\\\\\n&b \\times f(a,a+b)=(a+b)\\times f(a,b)\n\\end{aligned}\n$$\n\n\u4e14\u4e00\u5f00\u59cb $f(a,b)=a\\times b$\uff0c\u7136\u540e\u5e26\u4e0a\u4e00\u4e2a\u5355\u70b9\u4fee\u6539\u64cd\u4f5c\u3002\n\n\u6bcf\u5f53\u4fee\u6539\u4e86\u4e00\u4e2a\u683c\u5b50\u7684\u6570\u4e4b\u540e\uff0c\u4e3a\u4e86\u8ba9\u8868\u683c\u7ee7\u7eed\u6ee1\u8db3\u4e0a\u8ff0\u4e24\u4e2a\u6761\u4ef6\uff0c\u4f60\u8fd8\u9700\u8981\u628a\u8fd9\u6b21\u4fee\u6539\u80fd\u591f\u6ce2\u53ca\u5230\u7684\u5168\u90e8\u683c\u5b50\u91cc\u90fd\u6539\u4e3a\u6070\u5f53\u7684\u6570\u3002\n\n\u4f60\u8fd8\u9700\u8981\u968f\u65f6\u8f93\u51fa\u524d $k$ \u884c\u524d $k$ \u5217\u8fd9\u4e2a\u6709\u9650\u533a\u57df\u5185\u6240\u6709\u6570\u7684\u548c $\\pmod {10^9+7}$\u3002\n\n\u8003\u8651\u4ece\u4e0b\u9762\u90a3\u4e2a\u5f0f\u5b50\u5f97\u51fa\u4e00\u4e9b\u53ef\u4ee5\u53cd\u6f14\u7684\u4e1c\u897f\uff0c\u6709\uff1a\n$$\n\\begin{aligned}\nb \\times f(a,a+b)&=(a+b)\\times f(a,b)\\\\\nab \\times f(a,a+b)&=a(a+b)\\times f(a,b)\\\\\n\\frac{f(a,a+b)}{a(a+b)}&=\\frac{f(a,b)}{ab}\\\\\n\\frac{f(a,b)}{ab}&=\\frac{f(\\gcd(a,b),\\gcd(a,b))}{\\gcd(a,b)^2}\n\\end{aligned}\n$$\n\u8bbe $\\gcd(a,b)=d$\uff0c\u5219\u6709\uff1a\n$$\n\\begin{aligned}\n\\frac{f(a,b)}{ab}&=\\frac{f(d,d)}{d^2}\\\\\nf(a,b)&=\\frac{f(d,d)\\times ab}{d^2}\n\\end{aligned}\n$$\n\u8003\u8651\u5230\u8fd9\u4e2a\u77e9\u9635\u8981\u53d8\u6362\uff0c\u56e0\u4e3a\u4fee\u6539\u4e00\u4e2a\u4f4d\u7f6e $(a,b)$ \u7684\u503c\u540e\u6709\u4e14\u4ec5\u6709 $\\gcd(x,y)=d$ \u7684 $(x,y)$ \u4f4d\u7f6e\u7684 $f$ \u503c\u4f1a\u8ddf\u7740\u53d8\u5316\uff0c\u90a3\u4e48\u7528\u4e00\u4e2a\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4 $f(d,d)$ \u5373\u53ef\u3002\n\n\u8bbe $f(d,d)=g(d)$\uff0c\u518d\u8003\u8651\u7b54\u6848\uff1a\n$$\n\\begin{aligned}\nans&=\\sum_{d=1}^{n}g(d)\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\frac{ij}{\\gcd(i,j)^2}[\\gcd(i,j)=d]\\\\\n&=\\sum_{d=1}^{n}g(d)\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}ij[\\gcd(i,j)=1]\\\\\n&=\\sum_{d=1}^{n}g(d)\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}ij\\sum_{p|\\gcd(i,j)}\\mu(p)\\\\\n&=\\sum_{d=1}^{n}g(d)\\sum_{p=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\mu(p) \\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}i[p|i]\\sum_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}j[p|j]\\\\\n&=\\sum_{d=1}^{n}g(d)\\sum_{p=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\mu(p)p^2\\left(\\sum_{i=1}^{\\lfloor\\frac{\\lfloor\\frac{n}{d}\\rfloor}{p}\\rfloor}i\\right)^2\\\\\n&=\\sum_{d=1}^{n}g(d)\\sum_{p=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\mu(p)p^2S(\\lfloor\\frac{\\lfloor\\frac{n}{d}\\rfloor}{p}\\rfloor) ^2\n\\end{aligned}\n$$\n\n\u8bbe $G(n)=\\sum\\limits_{i=1}^{n}i^2\\mu(i)S(\\lfloor\\frac{n}{i}\\rfloor)^2$\uff0c\u5219\u539f\u5f0f\u7b49\u4e8e\uff1a\n$$\n\\sum_{d=1}^{n}g(d)G(\\lfloor\\frac{n}{d}\\rfloor)\n$$\n\u6839\u636e $\\lfloor\\frac{n}{i}\\rfloor-\\lfloor\\frac{n-1}{i}\\rfloor=[i|n]$\uff0c\u6709\uff1a\n$$\n\\begin{aligned}\nG(n)-G(n-1)&=\\sum_{i|n}i^2\\mu(i)(S(\\lfloor\\frac{n}{i}\\rfloor)^2-S(\\lfloor\\frac{n}{i}\\rfloor-1)^2\\\\\n&=\\sum_{i|n}i^2\\mu(i)(\\frac{n}{i})^3\\\\\n&=n^2\\sum_{i|n}\\mu(i)\\frac{n}{i}\\\\\n&=n^2\\varphi(n)\n\\end{aligned}\n$$\n\u90a3\u4e48\u6709\uff1a\n$$\nG(n)=\\sum_{i=1}^{n}i^2\\varphi(i)\n$$\n\u90a3\u4e48\u539f\u5f0f\u7b49\u4e8e\uff1a\n$$\n\\sum_{d=1}^{n}g(d)\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}i^2\\varphi(i)\n$$\n\u7ebf\u6027\u7b5b\uff0c\u7ef4\u62a4\u524d\u7f00\u548c\uff0c\u518d\u6570\u8bba\u5206\u5757\u5373\u53ef\u3002\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define int long long\n\nconst int mod = 1e9 + 7;\n\ninline int read()\n{\n\tint x = 0, f = 1;\n\tchar c = getchar();\n\twhile(c < '0' || c > '9')\n\t{\n\t\tif(c == '-') f = -1;\n\t\tc = getchar();\n\t}\n\twhile(c >= '0' && c <= '9')\n\t{\n\t\tx = ((x << 1) + (x << 3) + (c ^ 48)) % mod;\n\t\tc = getchar();\n\t}\n\treturn x * f;\n}\n\ninline void write(int x)\n{\n\tif(x < 0)\n\t{\n\t\tputchar('-');\n\t\tx = -x;\n\t}\n\tif(x > 9)\n\t\twrite(x / 10);\n\tputchar(x % 10 + '0');\n}\n\nconst int _ = 4e6 + 10;\n\nint n, m;\n\nint cnt, pr[_], vis[_], phi[_];\n\nint f[_];\n\nint c[_];\n\nint val[_];\n\nint Gcd(int x, int y)\n{\n    if (!y)\n        return x;\n    return Gcd(y, x % y);\n}\n\nvoid inc(int &x, int y)\n{\n\tx += y;\n\tif(x >= mod) x -= mod;\n\telse if(x < 0) x += mod;\n}\n\nint add(int x, int y)\n{\n\tint temp = x + y;\n    if (temp >= mod)\n        temp -= mod;\n    else if (temp < 0)\n        temp += mod;\n    return temp;\n}\n\nint qpow(int x, int y)\n{\n\tint res = 1;\n\twhile(y)\n\t{\n\t\tif(y & 1) res = res * x % mod;\n\t\tx = x * x % mod;\n\t\ty >>= 1;\n\t}\n\treturn res;\n}\n\nvoid init()\n{\n\tphi[1] = 1;\n\tfor(int i = 2; i <= n; ++i)\n\t{\n\t\tif(!vis[i])\n\t\t{\n\t\t\tpr[++cnt] = i;\n\t\t\tphi[i] = i - 1;\n\t\t}\n\t\tfor(int j = 1; j <= cnt && i * pr[j] <= n; ++j)\n\t\t{\n\t\t\tvis[i * pr[j]] = 1;\n\t\t\tif(i % pr[j] == 0)\n\t\t\t{\n\t\t\t\tphi[i * pr[j]] = phi[i] * pr[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tphi[i * pr[j]] = phi[i] * (pr[j] - 1);\n\t\t}\n\t}\n\tfor(int i = 1; i <= n; ++i)\n\t\tf[i] = (f[i - 1] + i * i % mod * phi[i] % mod) % mod;\n}\n\n#define lowbit(x) (x & -x)\n\nvoid update(int x, int val)\n{\n\twhile(x <= n)\n\t{\n\t\tinc(c[x], val);\n\t\tx += (x & -x);\n\t}\n}\n\nint query(int x)\n{\n\tint res = 0;\n\twhile(x)\n\t{\n\t\tinc(res, c[x]);\n\t\tx -= (x & -x);\n\t}\n\treturn res;\n}\n\nint Query(int l, int r)\n{\n\treturn add(query(r), -query(l - 1));\n}\n\nsigned main()\n{\n\tm = read(), n = read();\n\tinit();\n\tfor(int i = 1; i <= n; ++i)\n\t{\n\t\tval[i] = i * i % mod;\n\t\tupdate(i, val[i]);\n\t}\n\twhile(m--)\n\t{\n\t\tint a = read(), b = read(), x = read(), k = read(), d = Gcd(a, b);\n        int upt = x * d % mod * d % mod * qpow(a * b % mod, mod - 2ll) % mod;\n        update(d, add(upt, -val[d]));\n        val[d] = upt;\n        int ans = 0;\n        int S = sqrt(k);\n        for(int i = 1; i < S; ++i) inc(ans, f[k / i] * Query(i, i) % mod);\n        for (int l = S, r; l <= k; l = r + 1) \n\t\t{\n            r = k / (k / l);\n            inc(ans, f[k / l] * Query(l, r) % mod);\n        }\n        write(ans);\n        putchar('\\n');\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1642046032,
        "uid": 257146,
        "name": "orz_z",
        "ccfLevel": 0,
        "title": "P3700 [CQOI2017]\u5c0fQ\u7684\u8868\u683c"
    },
    {
        "content": "\u524d\u7f6e\u829d\u58eb\uff1a[\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14](https://oi-wiki.org/math/mobius/)\n\n\u672c\u9898\u89e3\u7701\u7565\u90e8\u5206\u5206\u505a\u6cd5\u53ca\u5176\u4ee3\u7801\u3002\n\n\u5c06 $b f(a, a + b) = (a + b) f(a, b)$ \u53d8\u5f62\u4e3a $\\frac{f(a, b)}{b} = \\frac{f(a, a + b)}{a + b}$\u3002\n\n\u4e24\u8fb9\u5206\u6bcd\u90fd\u662f $f$ \u51fd\u6570\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u3002\u90a3\u6211\u8981\u662f\u628a\u52a0\u53f7\u53d8\u6210\u51cf\u53f7\u5e76\u4e00\u76f4\u8fd9\u6837\u505a\u5462\uff1f\n\n\u7136\u540e\u5c31\u53d8\u6210\u4e86\u8fd9\u4e2a\u5f62\u5f0f\uff1a$\\frac{f(a, b)}{b} = \\frac{f(a, a \\bmod b)}{a \\bmod b}$\u3002\n\n\u600e\u4e48\u8fd9\u4e48\u50cf\u8f97\u8f6c\u76f8\u9664\u6cd5\uff1f\n\n\u7531\u4e8e $f(a, b) = f(b, a)$\uff0c\u539f\u5f0f\u53ef\u4ee5\u53d8\u6210\u8fd9\u4e2a\u5f62\u5f0f\uff1a$\\frac{f(a, b)}{ab} = \\frac{f(a \\bmod b, a)}{a \\bmod b \\times a}$\u3002\n\n\u4ee5\u6b64\u7c7b\u63a8\uff1a$\\frac{f(a, b)}{ab} = \\frac{f(\\gcd(a, b), \\gcd(a, b))}{\\gcd^2(a, b)}$\u3002\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u53d1\u73b0\uff0c$f(a, b)$ \u7684\u503c\u53ea\u4e0e $f(\\gcd(a, b), \\gcd(a, b))$ \u6709\u5173\uff0c\u6bcf\u6b21\u4fee\u6539\u76f8\u5f53\u4e8e\u4fee\u6539\u4e86 $f(\\gcd(a, b), \\gcd(a, b))$\u3002\n\n\u8bbe\u4e00\u4e2a\u6700\u5927\u516c\u7ea6\u6570 $d$ \u88ab\u4e0a\u6b21\u4fee\u6539\u65f6\u7684 $a, b, x$ \u4e3a $a_d, b_d, x_d$\uff0c\u6211\u4eec\u53ef\u4ee5\u8fc5\u901f\u5199\u51fa\u6bcf\u4e2a\u6700\u5927\u516c\u7ea6\u6570 $d$ \u4fee\u6539\u540e\u5bf9\u6700\u521d\u7b54\u6848 $(\\frac{k(k + 1)}{2})^2$ \u7684\u8d21\u732e\uff1a\n\n$$(\\frac{x_d}{\\frac{a_d}{d} \\times \\frac{b_d}{d}} - d^2) \\sum_{i = 1}^k \\sum_{j = 1}^k [\\gcd(i, j) = d] \\frac{ij}{\\gcd^2(i, j)}$$\n\n\u524d\u9762\u90a3\u90e8\u5206\u7684\u4fe1\u606f\u662f\u53ef\u4ee5\u5728\u6bcf\u6b21\u4fee\u6539\u65f6\u4fdd\u5b58\u7684\u3002\u6211\u4eec\u8003\u8651\u540e\u9762\u90a3\u90e8\u5206\uff1a\n\n$\\displaystyle\\sum_{i = 1}^k \\sum_{j = 1}^k [\\gcd(i, j) = d] \\frac{ij}{\\gcd^2(i, j)}$\n\n$ = \\displaystyle\\sum_{i = 1}^{\\lfloor \\frac{k}{d} \\rfloor} \\sum_{j = 1}^{\\lfloor \\frac{k}{d} \\rfloor} [\\gcd(i, j) = 1] ij$\n\n\u8bbe $S_1(n) = \\frac{n(n + 1)}{2}$\uff0c\u6709\uff1a\n\n\u539f\u5f0f $= \\displaystyle\\sum_{p = 1}^{\\lfloor \\frac{k}{d} \\rfloor} \\mu(p) p^2 S_1^2(\\lfloor \\frac{k}{dp} \\rfloor)$\n\n\u8fd9\u4e2a\u4e1c\u897f\u9884\u5904\u7406 / \u5728\u7ebf\u8ba1\u7b97\u770b\u4e0a\u53bb\u90fd\u4f1a TLE\u3002\u4e8b\u5b9e\u4e0a\uff0c\u9047\u89c1\u6570\u8bba\u5206\u5757\u5f62\u5f0f\u7684\u4e0d\u597d\u5904\u7406\u7684\u5f0f\u5b50\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651**\u5dee\u5206**\uff0c\u56e0\u4e3a\u5b58\u5728\u4ee5\u4e0b\u5bf9\u6b63\u6574\u6570 $n, m$ \u6052\u6210\u7acb\u7684\u7b49\u5f0f\uff1a\n\n$$\\lfloor \\frac{n}{m} \\rfloor - \\lfloor \\frac{n - 1}{m} \\rfloor = [m\\ |\\ n]$$\n\n\u8bbe $g(n) = \\displaystyle\\sum_{p = 1}^n \\mu(p) p^2 S_1^2(\\lfloor \\frac{n}{p} \\rfloor)$\uff0c\u6709\uff1a\n\n$g(n) - g(n - 1) = \\displaystyle\\sum_{p\\ |\\ n} \\mu(p) p^2 (S_1^2(\\frac{n}{p}) - S_1^2(\\frac{n}{p} - 1))$\uff08\u56e0\u4e3a\u53ea\u6709 $n$ \u7684\u7ea6\u6570\u5904\u7684\u70b9\u503c\u4f1a\u53d1\u751f\u6539\u53d8\uff09\u3002\n\n$ = \\displaystyle\\sum_{p\\ |\\ n} \\mu(p) \\frac{n^3}{p}$\n\n$ = n^2 \\displaystyle\\sum_{p\\ |\\ n} \\mu(p) \\frac{n}{p}$\n\n$ = n^2 \\varphi(n)$\n\n\u4e8e\u662f\u6211\u4eec\u901a\u8fc7\u7ebf\u6027\u7b5b\u9884\u5904\u7406\u51fa\u5b83\u7684\u524d\u7f00\u548c\u5e76\u5728\u6bcf\u6b21\u67e5\u8be2\u65f6\u904d\u5386\u4e4b\u524d\u88ab\u4fee\u6539\u8fc7\u7684\u70b9\u503c\u5e76\u7edf\u8ba1\u8d21\u732e\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(m^2 + n)$\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <stdio.h>\n\ntypedef long long ll;\n\nconst int N = 4e6 + 7, M = 1e4 + 7, mod = 1e9 + 7;\nint prime[N], phi[N], f[N], modification[M];\nll sum[N];\nbool p[N], vis[N];\n\ninline void init(int n){\n\tint cnt = 0;\n\tp[0] = p[1] = true;\n\tphi[1] = 1;\n\tfor (register int i = 2; i <= n; i++){\n\t\tif (!p[i]){\n\t\t\tprime[++cnt] = i;\n\t\t\tphi[i] = i - 1;\n\t\t}\n\t\tfor (register int j = 1; j <= cnt && i * prime[j] <= n; j++){\n\t\t\tint t = i * prime[j];\n\t\t\tp[t] = true;\n\t\t\tif (i % prime[j] == 0){\n\t\t\t\tphi[t] = phi[i] * prime[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tphi[t] = phi[i] * (prime[j] - 1);\n\t\t}\n\t}\n\tfor (register int i = 1; i <= n; i++){\n\t\tsum[i] = (sum[i - 1] + (ll)i * i % mod * phi[i] % mod) % mod;\n\t}\n}\n\nint gcd(int a, int b){\n\treturn b == 0 ? a : gcd(b, a % b);\n}\n\ninline ll sqr(ll n){\n\treturn n * n % mod;\n}\n\nint main(){\n\tint m, n, modification_cnt = 0;\n\tscanf(\"%d %d\", &m, &n);\n\tinit(n);\n\tfor (register int i = 1; i <= m; i++){\n\t\tint a, b, k, d;\n\t\tll x, ans;\n\t\tscanf(\"%d %d %lld %d\", &a, &b, &x, &k);\n\t\td = gcd(a, b);\n\t\tf[d] = x / (a / d) / (b / d) % mod;\n\t\tans = sqr((ll)k * (k + 1) / 2 % mod);\n\t\tif (!vis[d]){\n\t\t\tvis[d] = true;\n\t\t\tmodification[++modification_cnt] = d;\n\t\t}\n\t\tfor (register int j = 1; j <= modification_cnt; j++){\n\t\t\tans = ((ans + sum[k / modification[j]] * (f[modification[j]] - (ll)modification[j] * modification[j] % mod) % mod) % mod + mod) % mod;\n\t\t}\n\t\tprintf(\"%lld\\n\", ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1627039015,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3700 \u3010[CQOI2017] \u5c0fQ\u7684\u8868\u683c\u3011"
    },
    {
        "content": "# [\u5c0fQ\u7684\u8868\u683c](https://www.luogu.com.cn/problem/P3700)\n\n## \u9898\u76ee\u63cf\u8ff0\n\n\u7ed9\u5b9a\u4e00\u4e2a\u8868\u683c\uff0c\u6ee1\u8db3\uff1a\n\n- $\\forall a,b\\;f(a,b)=f(b,a)$\n- $\\forall a,b\\;b\\cdot f(a,a+b)=(a+b)\\cdot f(a,b)$\n\n\u6709$m$\u6b21\u64cd\u4f5c\uff1a\n\n- \u6bcf\u6b21\u64cd\u4f5c\u4fee\u6539$f(a,b)$\u7684\u503c\uff0c\u4e3a\u4e86\u4f7f\u6574\u4e2a\u8868\u6ee1\u8db3\u6761\u4ef6\uff0c\u6240\u4ee5\u8981\u4fee\u6539\u7684\u70b9\u8fd8\u633a\u591a\u7684\u3002\n- \u7136\u540e\u8ba9\u4f60\u8f93\u51fa$k*k$\u7684\u8303\u56f4\u5185\u7684\u6570\u7684\u548c\u3002\n\n## Solution\n\n\u5bf9\u4e8e\u6027\u8d28$\\forall a,b\\;b\\cdot f(a,a+b)=(a+b)\\cdot f(a,b)$\uff0c\u89c2\u5bdf\u53d1\u73b0\u5b83\u53ef\u4ee5\u8f6c\u5316\u4e00\u4e0b\uff1a\n\n![](https://s1.ax1x.com/2020/09/21/wqmXWt.png)\n\n\u6240\u4ee5\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7ed3\u8bba\uff1a\n\n![](https://s1.ax1x.com/2020/09/21/wqmOJI.png)\n\n\u90a3\u4e48\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a\u7ebf\u6027\u7684\u8868\u4e86\u3002\n\n\u90a3\u4e48\u518d\u56de\u5934\u770b\u770b\u9898\u76ee\u8981\u6c42\u7684\u95ee\u9898\u3002\n\n![](https://s1.ax1x.com/2020/09/21/wqmvSP.png)\n\n\u8003\u8651:\n\n$$\n\\sum_{i=1}^ni[\\gcd(i,n)=1]=\\frac{n\\times\\varphi(n)}{2}\n$$\n\u6240\u4ee5\u539f\u5f0f\u53ef\u4ee5\u5316\u4e3a:\n\n$$\nans= \\sum_{d=1}^ng(d)\\sum_{i=1}^{\\left\\lfloor\\frac nd\\right\\rfloor}i^2\\varphi(i)\n$$\n\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53d1\u73b0\uff0c\u540e\u9762\u7684\u662f\u53ef\u4ee5\u76f4\u63a5$O(1)$\u6c42\u89e3\u7684\uff08\u5148\u9884\u5904\u7406\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u67e5\u8be2\uff09\u3002\n\n\u7136\u800c\u524d\u9762\u90a3\u4e2a$g(d)$\u662f\u4f1a\u53d1\u751f\u6539\u53d8\u7684\u3002\n\n\u8fd9\u4e2a\u53ef\u4ee5\u7528\u6811\u72b6\u6570\u7ec4\u6216\u8005\u662f\u5206\u5757\u6765\u7ef4\u62a4\u3002\n\n\u8fd9\u4e24\u4e2a\u7406\u8bba\u4e0a\u662f\u53ef\u4ee5\u8fc7\u7684\uff0c\u5b9e\u6d4b\u518d[loj](https://loj.ac)\u662f\u53ef\u4ee5\u8fc7\u7684\u3002\n\n\u6d1b\u8c37\u4f3c\u4e4e\u6709\u70b9\u5361\u5e38\uff0c\u8981$TLE$\u4e00\u4e24\u4e2a\u70b9\u3002\n\n[\u6811\u72b6\u6570\u7ec4\u5b9e\u73b0](https://loj.ac/submission/937220)\uff0c[\u5206\u5757\u5b9e\u73b0](https://loj.ac/submission/937110)\n\n\u56e0\u4e3a\u6709\u70b9\u6162\uff0c\u5c31\u4e0d\u7ec6\u8bf4\u4e86\uff0c\u4ee3\u7801\u94fe\u63a5\u91cc\u5e94\u8be5\u662f\u53ef\u4ee5\u770b\u7684\u3002\n\n## \u8fdb\u4e00\u6b65\u8003\u8651\n\n\u6211\u4eec\u6bcf\u6b21\u4fee\u6539\u7684\u503c\u5176\u5b9e\u662f$f(\\gcd(a,b))$\uff0c\u6240\u4ee5\u771f\u65f6\u8981\u6539\u7684\u503c\u5e76\u4e0d\u591a\u3002\n\n- \u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5148\u6c42\u51fa\u539f\u8868\u4e2d$k*k$\u8303\u56f4\u5185\u7684\u503c\n\n- \u518d\u6c42\u51fa\u4fee\u6539\u7684\u503c\u5bf9\u7b54\u6848\u8d21\u732e\u76f8\u5bf9\u539f\u6765\u7684\u504f\u79fb\u91cf\n\n$$\n\\Delta ans=\\sum_{i=1}^{cnt}(changed(i)-pre^2(i))\\sum_{j=1}^{\\left\\lfloor\\frac ki\\right\\rfloor}j^2\\varphi(j)\n$$\n\n\u6240\u4ee5\u8fd9\u4e2a\u5c31\u662f$O(cnt)$\u7684\u590d\u6742\u5ea6\u3002\n\n\u7136\u540e\u53c8\u662f\u53ef\u4ee5\u8bc1\u660e\u5bf9\u4e8e\u6240\u6709\u7684$\\gcd(n,m)$\u7684\u4e2a\u6570\u65f6\u5904\u4e8e$\\log n\\sim\\sqrt n$\u8fd9\u4e2a\u7ea7\u522b\u3002\n\n\u6240\u4ee5\u4fee\u6539\u5927\u6982\u5c31\u662f$O(m\\log n)\\sim O(m\\sqrt n)$\u3002\n\n\u7136\u800c\u5b9e\u9645\u8dd1\u4e0b\u6765\u8981\u6bd4\u8fd9\u5feb\u5f97\u3002\n\n## Code\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\nconst ll maxn = 4e6 + 10;\nconst ll mod = 1e9 + 7;\n\ninline ll __read() {\n    ll x(0);\n    char o(getchar());\n    while (o < '0' || o > '9') o = getchar();\n    for (; o >= '0' && o <= '9'; o = getchar()) x = (x << 1) + (x << 3) + (o ^ 48);\n    return x;\n}\n\nll size, n, q, len;\nll pr[maxn], phi[maxn], f[maxn], cnt;\nll stk[maxn], upt[maxn], top;\nbool vis[maxn], che[maxn];\n\ninline void init() {\n    phi[1] = 1;\n    for (ll i = 2; i <= n; ++i) {\n        if (!vis[i])\n            pr[++cnt] = i, phi[i] = i - 1;\n        for (ll j = 1; j <= cnt && i * pr[j] <= n; ++j) {\n            vis[i * pr[j]] = 1;\n            if (i % pr[j]) {\n                phi[i * pr[j]] = phi[i] * phi[pr[j]];\n            } else {\n                phi[i * pr[j]] = phi[i] * pr[j];\n                break;\n            }\n        }\n    }\n    for (ll i = 1; i <= n; ++i) f[i] = (f[i - 1] + i * i % mod * phi[i] % mod) % mod;\n}\n\ninline ll sum(ll x) { return x * (x + 1) / 2 % mod; }\n\nll gcd(ll x, ll y) {\n    if (!y)\n        return x;\n    return gcd(y, x % y);\n}\n\nsigned main() {\n    q = __read(), n = __read();\n    init();\n    while (q--) {\n        ll a = __read(), b = __read(), x = __read(), k = __read(), d = gcd(a, b);\n\n        upt[d] = x / (a / d) / (b / d) % mod;\n        if (!che[d]) {\n            stk[++top] = d;\n            che[d] = 1;\n        }\n\n        ll ans(sum(k));\n        ans = ans * ans % mod;\n\n        for (ll i = 1; i <= top; ++i) {\n            d = stk[i];\n            ans = (ans + ((upt[d] - d * d % mod) % mod + mod) % mod * f[k / d] % mod) % mod;\n        }\n        printf(\"%lld\\n\", ans);\n    }\n}\n```\n",
        "postTime": 1600694300,
        "uid": 57896,
        "name": "STPGUY",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3700 \u3010[CQOI]\u5c0fQ\u7684\u8868\u683c\u3011"
    },
    {
        "content": " \u6211\u4eec\u9996\u5148\u628a\u9898\u76ee\u4e2d\u7684\u7b2c\u4e8c\u4e2a\u5f0f\u5b50\u53d8\u4e00\u4e0b\u5f62\u5f0f\u6210 $\\frac{f(a,b)}{b}=\\frac{f(a,a+b)}{a+b}$\u3002\u518d\u7ed3\u5408\u7b2c\u4e00\u4e2a\u6761\u4ef6\uff0c\u518d\u6b21\u53d8\u5f62\u6210 $\\frac{f(b,a)}{a\\times b}=\\frac{f(a,b)}{a\\times b}=\\frac{f(a,a+b)}{a\\times (a+b)}$\uff0c\u63a5\u7740\u4e0d\u96be\u5f97\u5230\u5bf9\u4e8e\u6240\u6709 $\\gcd(a,b)$ \u76f8\u540c\u7684 $(a,b)$\uff0c\u90fd\u6709 $\\frac{f(a,b)}{a\\times b}$ \u4e3a\u5b9a\u503c\u3002\n \n\u8bb0 $g(d)=\\frac{f(a,b)}{a\\times b}|\\gcd(a,b)=d$\u3002\u6211\u4eec\u8003\u8651\u6700\u7ec8\u7b54\u6848\u7684\u5f62\u5f0f\uff0c\u5373\u4e3a $\\sum_{x=1}^k\\sum_{y=1}^k f(x,y)=\\sum_{d=1}^k g(d) \\sum_{x=1}^{ \\lfloor \\frac{k}{d} \\rfloor } \\sum_{y=1}^{ \\lfloor \\frac{k}{d} \\rfloor} xy[\\gcd(x,y)=1]$\u3002\n\n\u4e0d\u96be\u770b\u51fa\uff0c\u540e\u9762\u5f62\u5982 $\\sum_{x=1}^k\\sum_{y=1}^k xy[\\gcd(x,y)=1]$ \u8fd9\u4e2a\u4e1c\u897f\u901a\u8fc7\u7b97\u4e24\u6b21\u8f6c\u5316\u4e00\u4e0b\u5c31\u662f $P(k)=\\sum_{i=1}^k \\phi(i)\\times i^2$\u3002\u8fd9\u4e2a\u53ef\u4ee5\u7ebf\u6027\u9884\u5904\u7406\u51fa\u6765\u3002\n\n\u6211\u4eec\u8003\u8651\u6839\u53f7\u5206\u6cbb\u6c42\u7b54\u6848\uff0c\u4e0d\u96be\u53d1\u73b0\u6c42\u548c\u5f0f\u91cc\u9762\u7684 $d$ \u4e00\u5171\u53ea\u6709 $O(\\sqrt{k})$ \u79cd\u53d6\u503c\uff0c\u6240\u4ee5\u6211\u4eec\u679a\u4e3e\u6bcf\u4e2a\u53ef\u80fd\u7684\u53d6\u503c\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u53d6\u503c\uff0c\u6211\u4eec\u76f8\u5f53\u4e8e\u8981\u5bf9 $g(i)$ \u8fdb\u884c\u4e00\u6b21\u533a\u95f4\u6c42\u548c\u3002\n\n\u6211\u4eec\u603b\u5171\u5bf9 $g(i)$ \u8981\u8fdb\u884c $m$ \u6b21\u4fee\u6539\uff0c$O(m\\sqrt{n})$ \u6b21\u67e5\u8be2\u3002\u6211\u4eec\u76f4\u63a5\u4f7f\u7528 $O(\\sqrt{n})-O(1)$ \u7684\u5206\u5757\u5373\u53ef\u505a\u5230 $O(m\\sqrt{n})$ \u7684\u590d\u6742\u5ea6\u3002\n\n\uff08\u4e0b\u9762\u7684\u5b9e\u73b0\u662f $O(m\\sqrt{n}\\log n)$ \u7684\u6811\u72b6\u6570\u7ec4\uff09\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int NR=4e6+10;\n#define int long long\nconst int MOD=1e9+7;\nconst int Inv2=5e8+4;\nint n,q,a[NR],vis[NR],prime[NR],tot,sum[NR],phi[NR],cnt[NR];\n\nint qpow(int x,int y){\n\tint res=1;\n\twhile(y){\n\t\tif(y&1)res=res*x%MOD;\n\t\tx=x*x%MOD;y>>=1;\n\t}\n\treturn res;\n}\nint Inv(int x){return qpow(x%MOD,MOD-2);}\nint gcd(int x,int y){\n\tif(!x||!y)return x|y;\n\treturn gcd(y,x%y);\n}\nvoid init(){\n\tphi[1]=1;\n\tfor(int i=2;i<=n;i++){\n\t\tif(!vis[i])prime[++tot]=i,phi[i]=i-1;\n\t\tfor(int j=1;j<=tot&&i*prime[j]<=n;j++){\n\t\t\tvis[i*prime[j]]=1;\n\t\t\tif(i%prime[j]==0){\n\t\t\t\tphi[i*prime[j]]=phi[i]*prime[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tphi[i*prime[j]]=phi[i]*(prime[j]-1);\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tsum[i]=(sum[i-1]+phi[i]*i%MOD*i)%MOD,cnt[i]=(cnt[i-1]+i*i)%MOD;\n}\n\nint c[NR];\nint lowbit(int x){return x&(-x);}\nvoid modify(int x,int y){\n\twhile(x<=n){\n\t\tc[x]=(c[x]+y)%MOD;\n\t\tx+=lowbit(x);\n\t}\n}\nint ask(int x){\n\tint res=0;\n\twhile(x){\n\t\tres=(res+c[x])%MOD;\n\t\tx-=lowbit(x);\n\t}\n\treturn res;\n}\nint calc(int l,int r){return ask(r)-ask(l-1);}\n\nsigned main(){\n\tcin>>q>>n;init();\n\tfor(int i=1;i<=n;i++)modify(i,a[i]=i*i%MOD);\n\twhile(q--){\n\t\tint x,y,z,k;cin>>x>>y>>z>>k;\n\t\tint d=gcd(x,y),v=(z%MOD)*Inv(x*y)%MOD*(d*d%MOD)%MOD;\n\t\tmodify(d,v-a[d]);a[d]=v;\n\t\tint ans=0;\n\t\tfor(int l=1,now,r;l<=k;l=r+1){\n\t\t\tnow=k/l;r=k/now;\n\t\t\tans=(ans+calc(l,r)*sum[now]%MOD)%MOD;\n\t\t}\n\t\tcout<<(ans+MOD)%MOD<<endl;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1685278994,
        "uid": 117771,
        "name": "intel_core",
        "ccfLevel": 7,
        "title": "P3700 \u9898\u89e3"
    },
    {
        "content": "\u5148\u7b80\u5355\u7684\u5217\u51fa\u6027\u8d28\uff1a\n\n1. $f(a,b)=f(b,a)$\uff1b   \n2. $b f(a,a+b) = (a+b)f(a,b)$\u3002\n\n\u5148\u8003\u8651\u8fd9\u4e2a $f$ \u4e24\u4e2a\u6052\u7b49\u5f0f\u7684\u5f62\u5f0f\u3002\u5c06 $f$ \u89c6\u4f5c\u4e00\u4e2a\u72b6\u6001\uff0c\u90a3\u4e48\u6709\u8f6c\u79fb $(a,a+b) \\to (a,b)$\uff0c\u4e14 $(a,b) \\to (b,a)$\u3002\n\n\u4e0d\u96be\u8054\u60f3\u5230\u8f97\u8f6c\u76f8\u51cf\u6c42\u6700\u5927\u516c\u7ea6\u6570\u7684\u8fc7\u7a0b\uff0c\u6700\u7ec8 $(a,b)$ \u4e00\u5b9a\u53ef\u4ee5\u8f6c\u79fb\u5230 $(\\gcd(a,b),\\gcd(a,b))$ \u4e0a\u3002\n\n\u90a3\u4e48\uff0c\u8868\u683c\u4e0a\u7684\u6240\u6709\u6570\u90fd\u53ef\u4ee5\u7528\u5bf9\u5e94\u7684\u4e00\u4e2a\u5bf9\u89d2\u7ebf\u4e0a\u7684\u6570\u4e58\u4e0a\u4e00\u4e2a\u7cfb\u6570\u8868\u793a\u3002\u4fee\u6539\u4e00\u4e2a\u6570\u7684\u8bdd\uff0c\u6211\u4eec\u53ea\u7528\u7ba1\u5b83\u7684\u5bf9\u89d2\u7ebf\u5143\u7d20\u5c31\u884c\u4e86\u3002\n\n\u6ce8\u610f\u5230 $b f(a,a+b) = (a+b)f(a,b)$\uff0c\u8fdb\u884c\u7b80\u5355\u5904\u7406\u540e\u53ef\u4ee5\u5f97\u5230 $\\dfrac{f(a,a+b)}{a(a+b)} = \\dfrac{f(a,b)}{ab}$\u3002\u4e8e\u662f\u601d\u8003\u8f97\u8f6c\u76f8\u51cf\u7684\u8fc7\u7a0b\uff0c\u6613\u5f97 $\\dfrac{f(a,b)}{ab} = \\dfrac{f(\\gcd(a,b),\\gcd(a,b))}{\\gcd(a,b)^2}$\u3002\n\n\u4e0b\u9762\u7684 $i/j$ \u5747\u8868\u793a $\\left\\lfloor \\dfrac{i}{j} \\right\\rfloor$\u3002\n\n\u7136\u540e\u6c42\u548c\u7684\u5de5\u4f5c\u8bdd\uff0c\u6211\u4eec\u5148\u8bb0 $g(i) = f(i,i)$\uff0c\u76f4\u63a5\u63a8\u5f0f\u5b50\uff1a\n\n$$\n\\begin{aligned}\n\\sum_{i=1}^k \\sum_{j=1}^k f(i,j)\n&= \\sum_{d=1}^n g(d) \\sum_{i=1}^n \\dfrac{i}{d} \\sum_{j=1}^n \\dfrac{j}{d} [\\gcd(i,j)=d] \\\\\n&= \\sum_{d=1}^n g(d) \\sum_{i=1}^{n/d} i \\sum_{j=1}^{n/d} j[\\gcd(i,j)=1]\n\\end{aligned}\n$$\n\n\u6ce8\u610f\u5230\u540e\u9762\u7684 $\\displaystyle \\sum_{j=1}^{\\lfloor \\frac{n}{d} \\rfloor} j[\\gcd(i,j)=1]$ \u770b\u8d77\u6765\u5c31\u975e\u5e38\u53ef\u4ee5\u9884\u5904\u7406\u3002\u7814\u7a76\u4e00\u4e0b\u8fd9\u4e2a\u4e1c\u897f\u3002\n\n\u9996\u5148\u8fd9\u4e2a\u4e0a\u754c\u4e0d\u4f18\u7f8e\u3002\u6ce8\u610f\u5230\u5728\u539f\u5f0f\u4e2d\uff0c$i=j \\neq 1$ \u7684\u65f6\u5019\u4e0d\u4f1a\u9020\u6210\u8d21\u732e\uff0c\u5e76\u4e14 $i \\neq j$ \u7684\u8d21\u732e\u4f1a\u7b97\u4e24\u6b21\u3002\u6211\u4eec\u5f3a\u5236 $i>j$\uff0c\u7136\u540e\u4e58 $2$ \u5373\u53ef\u3002\uff08\u4e0b\u9762\u7528 $\\frac{i}{D}$ \u7684\u539f\u56e0\u662f\u5176\u4e00\u5b9a\u662f\u4e00\u4e2a\u6574\u6570\uff09\n\n$$\n\\begin{aligned}\n2\\sum_{j=1}^i j[\\gcd(i,j)=1]\n&= 2\\sum_{j=1}^i j \\sum_{D|\\gcd(i,j)} \\mu(D) \\\\\n&= 2\\sum_{D|i} \\mu(D) \\sum_{j=1}^{\\frac{i}{D}} jD \\\\\n&= 2\\sum_{D|i} \\mu(D) D \\sum_{j=1}^{\\frac{i}{D}} j \\\\\n&= 2\\sum_{D|i} \\mu(D) D \\dfrac{\\left(\\frac{i}{D}+1\\right)\\times \\frac{i}{D}}{2} \\\\\n&= \\sum_{D|i} \\mu(D) D \\left(\\frac{i}{D}+1\\right)\\times \\frac{i}{D} \\\\\n&= i\\sum_{D|i} \\mu(D) \\left(\\frac{i}{D}+1\\right)\n\\end{aligned}\n$$\n\n\u63a8\u5230\u8fd9\u91cc\u57fa\u672c\u53ef\u4ee5\u7ed3\u675f\u4e86\u3002\u6ce8\u610f\u5230\u548c\u5f0f\u662f $\\mu * (id+1)$ \u7684\u5f62\u5f0f\uff0c\u90a3\u4e48\u8fd9\u4e2a\u51fd\u6570\u5c31\u76f8\u5f53\u4e8e $\\varphi + \\epsilon$\u3002\u4f46\u662f\u6ce8\u610f\u5230\uff0c\u5728 $i=1$ \u7684\u65f6\u5019\uff0c\u6211\u4eec\u5c06 $i=j=1$ \u7684\u60c5\u51b5\u7b97\u4e86\u4e24\u6b21\u2026\u2026\u5904\u7406\u65b9\u5f0f\u662f\u76f4\u63a5\u628a $\\epsilon$ \u76f4\u63a5\u9609\u5272\u4e86\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u91cd\u4e86\u3002\n\n\u90a3\u4e48\u7ee7\u7eed\u63a8\u4e4b\u524d\u7684\u5f0f\u5b50\uff1a\n\n$$\n\\begin{aligned}\n\\sum_{i=1}^k \\sum_{j=1}^k f(i,j)\n&= \\sum_{d=1}^n g(d) \\sum_{i=1}^n \\dfrac{i}{d} \\sum_{j=1}^n \\dfrac{j}{d} [\\gcd(i,j)=d] \\\\\n&= \\sum_{d=1}^n g(d) \\sum_{i=1}^{n/d} i^2 \\varphi(i)\n\\end{aligned}\n$$\n\n\u540e\u9762\u7684\u548c\u5f0f\u662f\u4e2a\u524d\u7f00\u548c\u5f62\u5f0f\u3002\u7136\u540e\u9884\u5904\u7406 $i^2 \\varphi(i)$ \u7684\u524d\u7f00\u548c\u975e\u5e38\u7b80\u5355\uff0c\u5916\u5c42\u76f4\u63a5\u6574\u9664\u5206\u5757\u505a\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u4f46\u662f\u8fd8\u6709\u4e2a\u4fee\u6539\u3002\u8fd9\u662f\u4e2a\u65b9\u7a0b\u5f62\u5f0f\uff0c\u91c7\u7528\u4e4b\u524d\u7684\u90a3\u4e2a\u5173\u4e8e $f(a,b),g(\\gcd(a,b))$ \u7684\u7b49\u5f0f\uff0c\u91c7\u7528\u6811\u72b6\u6570\u7ec4\u6c42\u51fa\u65b0\u7684 $g(\\gcd(a,b))$\uff0c\u76f4\u63a5\u6539\u5c31\u884c\u4e86\u3002\u6c42 $g$ \u7684\u533a\u95f4\u548c\u4e5f\u53ef\u4ee5\u7528\u6811\u72b6\u6570\u7ec4\u3002\n\n\u4f46\u662f\u6709\u70b9\u6162\u2026\u2026\u8fd8\u51d1\u5408\uff0c\u5c31\u8fd9\u6837\u5427\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n \\sqrt n \\log n)$\u3002\u4e0d\u61c2\u8fd9\u4e2a\u9898\u7684\u795e\u6027\u5728\u54ea\u91cc\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\nchar buf[1<<18],*p1=buf,*p2=buf;\n#define getchar() (p1==p2 && (p2=(p1=buf)+fread(buf,1,1<<18,stdin),p1==p2)?EOF:*p1++)\nLL read()\n{\n\tLL x=0;\n\tchar c=getchar();\n\twhile(c<'0' || c>'9')\tc=getchar();\n\twhile(c>='0' && c<='9')\tx=(x<<1)+(x<<3)+(c^'0'),c=getchar();\n\treturn x;\n}\nvoid write(LL x)\n{\n\tif(x>9)\twrite(x/10);\n\tputchar(x%10+'0');\n}\nconst LL MOD=1e9+7;\ninline LL Add(LL x,LL y){return x+y>=MOD?x+y-MOD:x+y;}\ninline LL Sub(LL x,LL y){return x<y?x-y+MOD:x-y;}\ninline LL Mul(LL x,LL y){return 1ll*x*y%MOD;}\nLL QuickPow(LL x,LL p)\n{\n\tLL ans=1,base=x;\n\twhile(p)\n\t{\n\t\tif(p&1)\tans=Mul(ans,base);\n\t\tbase=Mul(base,base);\n\t\tp>>=1;\n\t}\n\treturn ans;\n}\nLL N,m;\ninline LL lowbit(LL x){return x&(-x);}\nstruct BinaryIndexedTree{\n\tLL tr[4000005];\n\tvoid modify(LL x,LL val){for(LL i=x;i<=N;i+=lowbit(i))\ttr[i]=Add(tr[i],val);}\n\tLL query(LL x){LL ans=0;for(LL i=x;i;i^=lowbit(i))\tans=Add(ans,tr[i]);return ans;}\n\tLL query(LL l,LL r){return Sub(query(r),query(l-1));}\n}bit;\nLL cnt,prime[4000005];\nbool vis[4000005];\nLL phi[4000005],f[4000005];\nvoid shai(LL up)\n{\n\tvis[phi[1]=1]=true;\n\tfor(LL i=2;i<=up;++i)\n\t{\n\t\tif(!vis[i])\tphi[i]=i-1,prime[++cnt]=i;\n\t\tfor(LL j=1;j<=cnt && i*prime[j]<=up;++j)\n\t\t{\n\t\t\tvis[i*prime[j]]=true;\n\t\t\tif(i%prime[j]==0)\n\t\t\t{\n\t\t\t\tphi[i*prime[j]]=Mul(phi[i],prime[j]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tphi[i*prime[j]]=Mul(phi[i],prime[j]-1);\n\t\t}\n\t}\n\tfor(LL i=1;i<=up;++i)\tf[i]=Mul(Mul(i,i),phi[i]),f[i]=Add(f[i],f[i-1]);\n}\nLL gcd(LL a,LL b){return !b?a:gcd(b,a%b);}\nLL g[4000005];\nint main(){\n\tshai(4000000);\n\tm=read(),N=read();\n\tfor(LL i=1;i<=N;++i)\tbit.modify(i,g[i]=Mul(i,i));\n\twhile(m-->0)\n\t{\n\t\tLL a=read(),b=read(),x=read(),n=read();\n\t\tLL d=gcd(a,b);\n\t\tbit.modify(d,MOD-g[d]);\n\t\tlong long tmp=x;\n\t\ttmp/=a/d;\n\t\ttmp/=b/d;\n\t\ttmp%=MOD;\n\t\tg[d]=tmp;\n\t\tbit.modify(d,g[d]);\n\t\tLL ans=0;\n\t\tfor(LL l=1,r;l<=n;l=r+1)\tr=n/(n/l),ans=Add(ans,Mul(f[n/l],bit.query(l,r)));\n\t\twrite(ans),puts(\"\");\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1640245188,
        "uid": 184977,
        "name": "pomelo_nene",
        "ccfLevel": 9,
        "title": "\u53ea\u597d\u78d5\u5934\u8d3a\u559c\uff0c\u8ba8\u4e00\u70b9\u6b8b\u7fb9\u51b7\u7099\u505a\u5956\u8d4f"
    }
]
[
    {
        "content": "\u672c~~\u849f\u84bb~~\u7b2c\u56db\u7bc7\u9898\u89e3\uff0c\u4e0a\u6b21\u63d0\u4ea4\u5199\u5f97\u592a\u5c11\u4e86\uff0c\u8fd9\u6b21\u671b\u7ba1\u7406\u7ed9\u8fc7\uff01\n\n~~\u8c8c\u4f3c\u662f\u4e2a\u6811\u72b6\u6570\u7ec4\u6a21\u677f\u9898~~\n\n## \u5199\u5728\u524d\u9762\n$Q$\uff1a\u6811\u72b6\u6570\u7ec4\u662f\u4ec0\u4e48\uff1f\n\n$A$\uff1a~~\u662f\u4e00\u79cd\u6570\u636e\u7ed3\u6784\u3002~~\n\n\u5b9a\u4e49\u539f\u4e00\u7ef4\u6570\u7ec4\u4e3a $A$ \uff0c\u5219\u6811\u72b6\u6570\u7ec4 $C$ \u7684\u503c\u4e3a\uff1a\n$$C_1=A_1$$\n$$C_2=A_1+A_2$$\n$$C_3=A_3$$\n$$C_4=A_1+A_2+A_3+A_4$$\n$$C_5=A_5$$\n$$C_6=A_5+A_6$$\n$$C_7=A_7$$\n$$C_8=A_1+A_2+A_3+A_4+A_5+A_6+A_7+A_8$$\n\u4ee5\u6b64\u7c7b\u63a8\u3002\n\n\u4ecb\u7ecd\u4e00\u4e0b\u8457\u540d\u7684 $lowbit$ \u51fd\u6570\u5427\u3002\n\n### lowbit\n$Q$\uff1a$lowbit$ \u6c42\u7684\u662f\u4ec0\u4e48\uff1f\n\n$A$\uff1a\u6574\u6570\u8f6c\u4e3a\u4e8c\u8fdb\u5236\u540e\uff0c\u6700\u540e\u4e00\u4f4d $1$ \u53ca\u4e4b\u540e\u7684\u6240\u6709 $0$ \u6240\u6784\u6210\u7684\u6570\u503c\u3002\n\n$lowbit$ \u770b\u4f3c\u9ebb\u70e6\uff0c\u4e00\u770b\u4ee3\u7801\uff0c\u53d1\u73b0\u4e5f\u53ea\u6709\u4e00\u884c\u5c31\u89e3\u51b3\u4e86\uff1a\n```cpp\nint lowbit(int x) {\n\treturn x & -x;\n}\n```\n\u8fd9\u91cc\u6d89\u53ca\u5230\u4e86\u4e8c\u8fdb\u5236\u8865\u7801\u7684\u77e5\u8bc6\u3002\n\n\u56de\u5230\u672c\u9898\uff0c\u4f60\u4f1a\u8c41\u7136\u5f00\u6717\uff01\n\n## \u601d\u8def\n- \u6570\u636e\u7ed3\u6784\uff1a\u6811\u72b6\u6570\u7ec4\n- \u53d8\u5316\uff1a\u591a\u8bb0\u4e00\u7ef4 $color$\n- \u5c31\u6ca1\u6709\u5176\u4ed6\u6539\u52a8\u4e86\n\n## CODE\n```cpp\n#include <stdio.h>\nint n, m;\nint a[301][301];\nint c[301][301][101];\ninline void add(int x, int y, int k, int color) {\n\tfor (int i = x; i <= n; i += i & -i)\n\t\tfor (int j = y; j <= m; j += j & -j)\n\t\t\tc[i][j][color] += k;\n}\ninline int query(int x, int y, int color) {\n\tint ret = 0;\n\tfor (int i = x; i; i -= i & -i)\n\t\tfor (int j = y; j; j -= j & -j)\n\t\t\tret += c[i][j][color];\n\treturn ret;\n}\nint main(void) {\n\tscanf(\"%d %d\", &n, &m);\n\tint Q, x1, y1, x2, y2, color;\n\tfor (int i = 1; i <= n; ++i)\n\t\tfor (int j = 1; j <= m; ++j) {\n\t\t\tscanf(\"%d\", &color);\n\t\t\ta[i][j] = color;\n\t\t\tadd(i, j, 1, color);\n\t\t} \n\tfor (scanf(\"%d\", &Q); Q--; ) {\n\t\tint op;\n\t\tscanf(\"%d\", &op);\n\t\tif (op == 1) {\n\t\t\tscanf(\"%d %d %d\", &x1, &y1, &color);\n\t\t\tadd(x1, y1, -1, a[x1][y1]);\n\t\t\ta[x1][y1] = color;\n\t\t\tadd(x1, y1, 1, color);\n\t\t}\n\t\telse {\n\t\t\tscanf(\"%d %d %d %d %d\", &x1, &x2, &y1, &y2, &color);\n\t\t\tprintf(\"%d\\n\", query(x2, y2, color) - query(x1 - 1, y2, color) - query(x2, y1 - 1, color) + query(x1 - 1, y1 - 1, color));\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n## \u63a8\u8350\u6811\u72b6\u6570\u7ec4\u9898\u5355\n### \u5b98\u65b9\u7cbe\u9009\n- [\u3010\u6570\u636e\u7ed3\u67842-2\u3011\u7ebf\u6bb5\u6811\u4e0e\u6811\u72b6\u6570\u7ec4](https://www.luogu.com.cn/training/206)\n\n### \u7528\u6237\u5206\u4eab\n- [\u6811\u72b6\u6570\u7ec4\u6a21\u677f\u9898](https://www.luogu.com.cn/training/3079)\n\n- [CM\u306e\u6811\u72b6\u6570\u7ec4](https://www.luogu.com.cn/training/1143)\n\n## The end. Thanks.\n\n~~\uff08\u8d70\u8fc7\u8def\u8fc7\u4e00\u5b9a\u8981\u8d5e\u8fc7\u554a~~",
        "postTime": 1591492968,
        "uid": 214696,
        "name": "Dry_ice",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4054 \u3010[JSOI2009]\u8ba1\u6570\u95ee\u9898\u3011"
    },
    {
        "content": "\u5148\u65e0\u826f\u5ba3\u4f20\u4e00\u4e0b\u535a\u5ba2 $wwwwww$    \n[\u6587\u7ae0\u5217\u8868 - \u5730\u7075\u6bbf - \u6d1b\u8c37\u535a\u5ba2](https://www.luogu.org/blog/koishikoishi/)\n\n\n---\n\n### \u77e5\u8bc6\u70b9 : \u591a\u7ef4\u6811\u72b6\u6570\u7ec4 . \n\n\n\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\u6a21\u677f\u9898 .   \n\n\u53ef\u4ee5\u53d1\u73b0 , \u77e9\u9635\u4e2d\u503c\u7684\u503c\u57df\u5f88\u5c0f   \n$w\\le 100$  \n\u8003\u8651\u66b4\u529b\u601d\u8def,  \n\t\n\u6784\u5efa $100$ \u4e2a\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4,  \n\u5206\u522b\u5b58\u50a8\u5404\u6570\u503c ,  \n\u5728\u77e9\u9635\u4e2d\u51fa\u73b0\u7684\u6b21\u6570.  \n\n---\n\n- \u5bf9\u4e8e\u5355\u70b9\u4fee\u6539\u64cd\u4f5c:    \n  \u5c06\u70b9 $(x,y)$ ,\u7531\u503c $a$ \u4fee\u6539\u4e3a $b$.  \n  \n  \u5148\u5bf9\u503c $a$ \u7684\u6811\u72b6\u6570\u7ec4 \u8fdb\u884c\u4fee\u6539,  \n  \u5bf9\u5e94\u4f4d\u7f6e\u7684\u51fa\u73b0\u6b21\u6570 $-1$ .    \n\t\t \n  \u518d\u5bf9\u503c $b$ \u7684\u6811\u72b6\u6570\u7ec4 \u8fdb\u884c\u4fee\u6539,    \n  \u5bf9\u5e94\u4f4d\u7f6e\u7684\u51fa\u73b0\u6b21\u6570 $+1$ .    \n   \n-  \u5bf9\u4e8e\u533a\u95f4\u67e5\u8be2\u64cd\u4f5c:   \n   \u76f4\u63a5\u67e5\u8be2 \u5bf9\u5e94\u5b50\u77e9\u9635\u4e2d  \n\t\u51fa\u73b0\u6b21\u6570\u5373\u53ef   \n\t  \n\u53e6\u5916 , $bzoj$ \u4e0a\u7684\u6b64\u9898\u7a7a\u95f4\u9650\u5236\u53ea\u6709 $64mb$  \n\u8981\u6ce8\u610f\u4e0d\u80fd\u628a\u6240\u6709\u53d8\u91cf,  \n\u90fd\u8bbe\u7f6e\u4e3a $long\\ long$ .     \n\n---\n\u9644 \u4ee3\u7801:\n\n```cpp\n#include<cstdio>\n#include<ctype.h>\n#define ll long long\n#define lowbit(x) -x&x\n//=============================================================\nint N,M,Q;\nint map[301][301];\nint tree[101][301][301];\n//=============================================================\ninline int read()\n{\n\tint fl=1,w=0;char ch=getchar();\n\twhile(!isdigit(ch) && ch!='-') ch=getchar();\n\tif(ch=='-') fl=-1;\n\twhile(isdigit(ch)){w=w*10+ch-'0',ch=getchar();}\n\treturn fl*w;\n}\ninline void add(int type,int x,int y,int z)//\u4fee\u6539\u64cd\u4f5c,\u5c06\u6b64\u70b9\u6743\u503c\u8bbe\u4e3atype,\u5e76\u4f7f\u5176\u6b21\u6570+=z \n{\n\tmap[x][y]=type;//\u66f4\u65b0 \n\tfor(int i=x;i<=N;i+=lowbit(i))//\u8fdb\u884c\u62c6\u5206 \n\t  for(int j=y;j<=M;j+=lowbit(j))\n\t    tree[type][i][j]+=z;\n}\ninline ll sum(int type,int x,int y)//\u67e5\u8be2\u77e9\u9635(1,1)--(x,y)\u4e2d\u503ctype\u7684\u51fa\u73b0\u6b21\u6570 \n{\t\n\tint ret=0;\n\tfor(int i=x;i;i-=lowbit(i))//\u8fdb\u884c\u62c6\u5206 \n\t  for(int j=y;j;j-=lowbit(j))\n\t    ret+=tree[type][i][j];//\u66f4\u65b0 \n\treturn ret;\n}\n//=============================================================\nsigned main()\n{\n\tN=read(),M=read();\n\tfor(int i=1;i<=N;i++)\n\t  for(int j=1;j<=M;j++)//\u6784\u9020\u521d\u59cb\u6811\u72b6\u6570\u7ec4 \n\t  {\n\t  \tint w=read();\n\t  \tadd(w,i,j,1);\n\t  }\n\t\n\tQ=read();\n\tfor(int i=0;i<Q;i++)\n\t{\n\t  int opt=read();\n\t  if(opt==1)//\u4fee\u6539\u64cd\u4f5c \n\t  {\n\t  \tint x=read(),y=read(),type=read();\n\t  \tadd(map[x][y],x,y,-1);//\u539f\u503c\u51fa\u73b0\u6b21\u6570-1 \n\t  \tadd(type,x,y,1);//\u65b0\u503c\u51fa\u73b0\u6b21\u6570+1 \n\t  }\n\t  else\n\t  {\n\t  \tint x1=read(),x2=read(),y1=read(),y2=read(),type=read();\n\t  \tll ans1=sum(type,x2,y2),ans2=sum(type,x1-1,y1-1);//\u8ba1\u7b97\u5b50\u77e9\u9635\u7684\u503c \n\t\tprintf(\"%lld\\n\",ans1-sum(type,x1-1,y2)-sum(type,x2,y1-1)+ans2);\n\t  }\n\t}\n}\n```\n",
        "postTime": 1565258366,
        "uid": 186186,
        "name": "\u7075\u4e4c\u8def\u7a7a",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4054 \u3010[JSOI2009]\u8ba1\u6570\u95ee\u9898\u3011"
    },
    {
        "content": "\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u8bc4\u5206\u662f\u7701\u9009\u96be\u5ea6\u3002\u3002\u3002\u3002\u8fd9\u9053\u9898\u7684\u601d\u8def\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u5efa\u9020col\u4e2a\u6811\u72b6\u6570\u7ec4\u5206\u522b\u7edf\u8ba1\uff0c\u56e0\u4e3a\u5404\u79cd\u989c\u8272\u4e4b\u95f4\u662f\u6ca1\u6709\u76f8\u4e92\u4f5c\u7528\u7684\uff0c\u6ce8\u610f\u5728\u6539\u989c\u8272\u7684\u65f6\u5019\u540c\u65f6\u8fd8\u8981\u628a\u4e4b\u524d\u7684\u5220\u6389\u518d\u52a0\u65b0\u7684\u3002\u3002\n\n\u8fd8\u6709\u6b64\u9898\u8f93\u5165\u5de8\u5751\u3002\u3002mmp\u5728\u5176\u4ed6oj\u4ea4\u4e86\u5341\u51e0\u6b21\u624d\u53d1\u73b0\u8f93\u5165\n\n2 x1 x2 y1 y1 c\n\n** x1 x2 y1 y2 c !!!! **\n\n\u7b80\u76f4\u6709\u6bd2\n\n\u4ee5\u4e0b\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int MAXN = 305;\nint tre[MAXN][MAXN][MAXN];\nint col[MAXN][MAXN];\nint n,m;\ninline int lowbit(int x){return  x  & (-x);}\ninline void add(int v,int x,int y,int z){\n\tfor(int i = x;i <= n; i += lowbit(i)){\n\t\tfor(int j = y; j <= m; j += lowbit(j)){\n\t\t\ttre[v][i][j] += z;\n\t\t}\n\t}\n\treturn ;\n}\ninline int sum(int v,int x,int y){\n\tint ans = 0;\n\tfor(int i = x; i > 0; i -= lowbit(i)){\n\t\tfor(int j = y; j > 0; j -= lowbit(j)){\n\t\t\tans += tre[v][i][j];\n\t\t}\n\t}\n\treturn ans;\n}\nint main()\n{\n\t//freopen(\"1.in\",\"r\",stdin);\n\t//freopen(\"1.out\",\"w\",stdout);\n\tscanf(\"%d %d\",&n,&m);\n\tfor(int i = 1; i <= n; i++){\n\t\tfor(int j = 1; j <= m; j++){\n\t\t\tint z;scanf(\"%d\",&z);\n\t\t\tcol[i][j] = z;\n\t\t\tadd(z,i,j,1);\n\t\t} \n\t}\n\tint q;scanf(\"%d\",&q);\n\tfor(int i = 1; i <= q; i++){\n\t\tint opt,x1,x2,c,y1,y2;scanf(\"%d\",&opt);\n\t\tif(opt == 1){\n\t\t\tscanf(\"%d %d %d\",&x1,&y1,&c);\n\t\t\tadd(col[x1][y1],x1,y1,-1);\n\t\t\tcol[x1][y1] = c;\n\t\t\tadd(col[x1][y1],x1,y1,1);\n\t\t}\n\t\telse{\n\t\t\tscanf(\"%d %d %d %d %d\",&x1,&x2,&y1,&y2,&c);\n\t\t\tprintf(\"%d\\n\",sum(c,x2,y2) - sum(c,x1 - 1,y2) - sum(c,x2,y1 - 1) + sum(c,x1 - 1,y1 - 1));\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1523244047,
        "uid": 52576,
        "name": "moye\u5230\u7897\u91cc\u6765",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4054 \u3010[JSOI2009]\u8ba1\u6570\u95ee\u9898\u3011"
    },
    {
        "content": "\u603b\u611f\u89c9\u597d\u5947\u602a\uff0c\u660e\u660e\u4e00\u9053 pj T2 \u7684\u9898\u76ee\u5374\u7528\u4e86\u8fd9\u4e48\u795e\u5947\u7684\u6570\u636e\u7ed3\u6784\u3002\u53e6\u5916\uff0c\u8bc4\u5206\u597d\u50cf\u4e5f\u4e0d\u592a\u5bf9\u5462\u3002\u3002\u3002\r\n\r\n\u9996\u5148\u6211\u4eec\u8003\u8651\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u77e9\u9635\u5b9e\u9645\u4e0a\u53ef\u4ee5\u770b\u6210\u51e0\u884c\u5355\u72ec\u7684\u3002\r\n\r\n\u8003\u8651\u5904\u7406\u4e00\u4e2a\u5b50\u95ee\u9898\uff0c\u5373 $n=1$ \u65f6\u5982\u4f55\u601d\u8003\uff0c\u663e\u7136\u53ef\u4ee5\u7ef4\u62a4\u4e00\u4e2a\u524d\u7f00\u548c\uff0c\u5bf9\u4e8e\u4fee\u6539\u64cd\u4f5c\u6765\u8bf4\uff0c\u53ea\u4f1a\u5f71\u54cd\u540e\u9762\u7684\u3002\r\n\r\n\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u641e\u4e00\u4e2a `sum[x][y][z]` \u8868\u793a $x$ \u79cd\u989c\u8272\u5728\u7b2c $y$ \u884c\u4ece\u7b2c $1$ \u5217\u5230\u7b2c $z$ \u5217\u51fa\u73b0\u6b21\u6570\u3002\r\n\r\n\u7136\u540e\u7edf\u8ba1\u7b54\u6848\u7684\u65f6\u5019\u53ef\u4ee5\u76f4\u63a5\u679a\u4e3e\u51e0\u884c\u5c31\u53ef\u4ee5\u4e86\u3002\r\n\r\n\u66f4\u52a0\u5177\u4f53\u4e00\u70b9\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u70b9\u6765\u8bf4\uff0c\u5b83\u7684\u6743\u503c\u6539\u53d8\u4f1a\u5f71\u54cd\u4ec0\u4e48\uff1f\r\n\r\n\u8bbe\u8fd9\u4e2a\u70b9\u4e3a $(x,y)$\r\n\r\n\u90a3\u4e48\u9996\u5148\uff0c\u5bf9\u4e8e\u5b83\u540e\u9762\u7684\u5373 `sum[a[x][y]][x][y~n]` \u662f\u4e0d\u662f\u90fd\u4f1a\u4ea7\u751f\u5f71\u54cd\uff0c\u8fd9\u4e2a\u5f71\u54cd\u662f $-1$\u3002\r\n\r\n\u540c\u7406\u5bf9\u4e8e\u6539\u53d8\u6743\u503c\u53d8\u5230\u7684\u90a3\u4e2a\u6743\u503c `sum[v][x][y~n]` \u90fd\u4f1a $+1$\u3002\r\n\r\n\u90a3\u4e48\u5bf9\u4e8e\u7edf\u8ba1\u7b54\u6848\u7684\u5462\uff1f\r\n\r\n\u90a3\u5c31\u662f $\\sum \\limits _{i=x}^{x1} sum[v][i][y]-sum[v][i][y-1]$ \u4e5f\u5c31\u662f\u5bf9\u4e8e\u6bcf\u4e00\u884c\u7684 $v$ \u6211\u4eec\u90fd\u66b4\u529b\u8fdb\u884c\u7edf\u8ba1\u3002\r\n\r\n\u603b\u7ed3\u4e00\u4e0b\uff0c\u5bf9\u4e8e\u5355\u70b9\u4fee\u6539\uff0c\u5176\u5b9e\u53ef\u4ee5\u76f4\u63a5\u505a\u5230 $O(1)$ \u4f46\u662f\u6211\u4eec\u5728\u8fd9\u9053\u9898\u76ee\u4e0a\uff0c\u5fc5\u987b\u62ff\u6389\u5b83\u7684 $O(1)$ \u6362\u67e5\u8be2\u7684 $O(n)$\u3002 \r\n\r\n\u5f53\u7136\uff0c\u8fd9\u9053\u9898\u76ee\u4e5f\u5b8c\u5168\u53ef\u4ee5\u7528\u6811\u72b6\u6570\u7ec4\u6765\u89e3\uff0c\u5e76\u4e14\u590d\u6742\u5ea6\u66f4\u4f18\u4e00\u70b9\u3002\r\n\r\n\u4e0d\u8fc7\u66f4\u63a8\u8350\u7684\u662f\u66b4\u529b\u597d\u60f3\u7684\u505a\u6cd5\uff0c\u6bd5\u7adf\u62ff\u5206\u624d\u662f\u5173\u952e\u3002\r\n\r\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n \\times q)$\u3002\r\n\r\n```cpp\r\n#include <iostream>\r\n#include <cstdio>\r\nusing namespace std;\r\nconst int INF=305;\r\nconst int INFN=105;\r\nint n,m,sum[INFN][INF][INF],a[INF][INF],q;\r\nsigned main()\r\n{\r\n\tscanf(\"%d %d\",&n,&m);\r\n\tfor (int i=1;i<=n;i++)\r\n\t\tfor (int j=1;j<=m;j++)\r\n\t\t\tscanf(\"%d\",&a[i][j]);\r\n\tfor (int k=1;k<=100;k++)\r\n\t\tfor (int i=1;i<=n;i++)\r\n\t\t\tfor (int j=1;j<=m;j++)\r\n\t\t\t\tsum[k][i][j]=sum[k][i][j-1]+(a[i][j]==k);\r\n\tscanf(\"%d\",&q);\r\n\twhile (q--) {\r\n\t\tint op=0,x=0,y=0,z=0,xx=0,yy=0;\r\n\t\tscanf(\"%d\",&op);\r\n\t\tif (op==1) {\r\n\t\t\tscanf(\"%d %d %d\",&x,&y,&z);\r\n//\t\t\tswap(x,y);\r\n\t\t\tfor (int i=y;i<=m;i++)\r\n\t\t\t\tsum[a[x][y]][x][i]--;\r\n\t\t\tfor (int i=y;i<=m;i++)\r\n\t\t\t\tsum[z][x][i]++;\r\n\t\t\ta[x][y]=z;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tscanf(\"%d %d %d %d %d\",&x,&xx,&y,&yy,&z);\r\n\t\t\tint ans=0;\r\n\t\t\tfor (int i=x;i<=xx;i++)\r\n\t\t\t\tans+=sum[z][i][yy]-sum[z][i][y-1];\r\n\t\t\tcout<<ans<<\"\\n\";\r\n\t\t}\r\n\t}\r\n\treturn 0;\r\n}\r\n```\r\n",
        "postTime": 1655548651,
        "uid": 208653,
        "name": "_edge_",
        "ccfLevel": 0,
        "title": "P4054"
    },
    {
        "content": "\u53ef\u4ee5\u8bf4\u662f\u4e8c\u7ef4$BIT$\u5355\u70b9\u4fee\u6539\u533a\u95f4\u67e5\u8be2\u7684\u677f\u5b50\u9898\u3002\u539f\u7406\u548c\u4e00\u7ef4$BIT$\u7c7b\u4f3c\u3002\u8003\u8651\u5230\u6570\u636e\u89c4\u6a21\u4e0d\u5927\uff0c\u53ef\u4ee5\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u6743\u503c\u5f00\u4e00\u4e2a$BIT$\uff0c\u7136\u540e\u4fee\u6539\u65f6\u5bf9\u4e8e\u539f\u6743\u503c\u7684$BIT$\u5bf9\u5e94\u4f4d\u7f6e$--$\uff0c\u65b0\u6743\u503c\u7684$BIT$\u5bf9\u5e94\u4f4d\u7f6e$++$\u3002\n\n\u4ee3\u7801\uff1a\n\n```\n#include<bits/stdc++.h>\n#define MXq 200005\nusing namespace std;\nint n,m,mat[305][305],ans[MXq],tree[105][305][305];\nint lowbit(int x){return x&-x;}\nvoid add(int type,int x,int y,int v){\n\twhile(x<=n){\n\t\tint _y=y;while(_y<=m){tree[type][x][_y]+=v;_y+=lowbit(_y);}x+=lowbit(x);\n\t}\n}\nint pref(int type,int x,int y){\n\tint tot=0;\n\twhile(x>=1){\n\t\tint _y=y;while(_y>=1){tot+=tree[type][x][_y];_y-=lowbit(_y);}x-=lowbit(x);\n\t}\n\treturn tot;\n}\nint query(int type,int x1,int y1,int x2,int y2){\n\treturn pref(type,x2,y2)+pref(type,x1-1,y1-1)-pref(type,x1-1,y2)-pref(type,x2,y1-1);\n}\nint main(){\n\tint q,_top=0;cin>>n>>m;\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++)\n\t\t\t{cin>>mat[i][j];add(mat[i][j],i,j,1);}\n\tcin>>q;\n\tfor(int i=1;i<=q;i++){\n\t\tint _q;cin>>_q;\n\t\tif(_q==1){\n\t\t\tint x,y,c;cin>>x>>y>>c;add(mat[x][y],x,y,-1);add(c,x,y,1);mat[x][y]=c;\n\t\t}\n\t\telse{\n\t\t\tint x1,y1,x2,y2,c;cin>>x1>>x2>>y1>>y2>>c;\n\t\t\tans[++_top]=query(c,x1,y1,x2,y2);\n\t\t}\n\t}\n\tfor(int i=1;i<=_top;i++)cout<<ans[i]<<endl;\n\treturn 0;\n}\n```\n",
        "postTime": 1593163096,
        "uid": 313892,
        "name": "sukimo",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4054 \u3010[JSOI2009]\u8ba1\u6570\u95ee\u9898\u3011"
    },
    {
        "content": "\u6700\u8fd1\u5b66\u4e60\u4e86\u6811\u72b6\u6570\u7ec4\uff0c\u611f\u89c9\u6709\u70b9\u6655![/yun](https://cdn.luogu.com.cn/upload/pic/62240.png)\u3002\n\n\u8fd9\u9898\u4e5f\u5c31\u662f\u4e8c\u7ef4\u7684\u5355\u70b9\u66f4\u65b0\u3001\u533a\u95f4\u6c42\u548c\u3002\uff08\u6ca1\u60f3\u5230\u7701\u9009\u4f1a\u8003\u6a21\u677f\u9898\u3002\n\n\u53ef\u4ee5\u628a\u5b83\u60f3\u6210\u7ebf\u6027\u7684\uff0c\u4e0b\u9762\u6211\u4eec\u6765\u4e3e\u4e2a\u6817\u5b50\uff0c\u4f8b\u5982\uff0c\u8fd9\u662f$A[][]$\u7b2c$1$\u884c\u7684\u4e00\u7ef4\u6811\u72b6\u6570\u7ec4\uff1a\n\n$C[1][1]=a_{1,1}$\uff0c\n\n$C[1][2]=a_{1,1}+a_{1,2}$\uff0c\n\n$C[1][3]=a_{1,3}$\uff0c\n\n$C[1][4]=a_{1,1}+a_{1,2}+a_{1,3}+a_{1,4}$\uff0c\n\n$C[1][5]=a_{1,5}$\uff0c\n\n$C[1][6]=a_{1,5}+a_{1,6}$\uff0c\u2026\u2026\n\n**~~\u4ee5\u6b64\u7c7b\u63a8\uff0c\u4e3e\u4e00\u53cd\u4e09~~**\n\n**\u7136\u540e\u5bf9\u4e8e\u533a\u95f4\u67e5\u8be2\u64cd\u4f5c:\u76f4\u63a5\u67e5\u8be2\u5bf9\u5e94\u5b50\u77e9\u9635\u4e2d\u51fa\u73b0\u6b21\u6570\u5373\u53ef\u3002**\n\n## Code\uff1a\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nint f[310][310][310],n,m,r,l,k,x,y,c,t,A[310][310],i,j;\nint Lowbit (int t) {\n\treturn t&(-t);\n}//\u8457\u540d\u7684Lowbit\u51fd\u6570\uff1alowbit(t)=2^k\u3002\nvoid Update (int x,int y,int v,int k) {\n\tint i,j;\n\tfor (i=x;i<=n;i+=Lowbit (i)) \n\t\tfor (j=y;j<=m;j+=Lowbit (j)) \n\t\t\tf[i][j][v]+=k;\n\treturn;\n}\nint Getans (int x,int y,int v) {\n\tint i,j,ans=0;\n\tfor (i=x;i>0;i-=Lowbit (i)) \n\t\tfor (j=y;j>0;j-=Lowbit (j)) \n\t\t\tans+=f[i][j][v];\n\treturn ans;\n}//\u533a\u95f4\u6c42\u548c\u3002\nint main () {\n\tscanf (\"%d%d\",&n,&m);\n\tfor (i=1;i<=n;i++){\n\t\tfor (j=1;j<=m;j++) {\n\t\t\tscanf (\"%d\",&A[i][j]);\n\t\t\tUpdate (i,j,A[i][j],1);\n\t\t}\n\t}\n\tscanf (\"%d\",&t);\n\twhile (t--) {\n\t\tscanf (\"%d%d%d%d\",&k,&x,&y,&c);\n\t\tif (k==1) {\n\t\t\tUpdate (x,y,A[x][y],-1);\n\t\t\tA[x][y]=c;\n\t\t\tUpdate (x,y,A[x][y],1);//\u64cd\u4f5c\u4e00\u3002\n\t\t}\n\t\telse {\n\t\t\tscanf (\"%d%d\",&r,&l);\n\t\t\tprintf (\"%d\\n\",Getans (y,r,l)-Getans (x-1,r,l)-Getans (y,c-1,l)+Getans (x-1,c-1,l));//\u8f93\u51fa\u77e9\u9635\u533a\u95f4\u548c\u3002\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\u7136\u540e\u8fd9\u9898\u662f\u4e0d\u662f\u53ef\u4ee5\u628a\u201c**\u6982\u7387\u8bba\uff0c\u7edf\u8ba1**\u201d\u8fd9\u4e2a\u6807\u7b7e\u53bb\u6389awa\u3002\n",
        "postTime": 1591458882,
        "uid": 239030,
        "name": "\u505a\u68a6\u60f3Peach",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4054 \u3010[JSOI2009]\u8ba1\u6570\u95ee\u9898\u3011"
    },
    {
        "content": "\u524d\u7f6e\u829d\u58eb\uff1a\n[P3374 \u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 1](https://www.luogu.com.cn/problem/P3374)\n\n\u770b\u5230\u8fd9\u9053\u9898\u6211\u7684\u7b2c\u4e00\u53cd\u5e94\uff1a\u6811\u72b6\u6570\u7ec4\u5957\u6811\u72b6\u6570\u7ec4\u3002\n\n\u4e3a\u4ec0\u4e48\u5462\uff1f\n\n\u56e0\u4e3a\u666e\u901a\u7684\u6811\u72b6\u6570\u7ec4\u8db3\u4ee5\u8fdb\u884c\u5355\u70b9\u4fee\u6539\u4e0e\u533a\u95f4\u67e5\u8be2\u7684\u64cd\u4f5c\uff0c\u800c\u4e14\u6811\u72b6\u6570\u7ec4\u7684\u5e38\u6570\u4e5f\u6bd4\u7ebf\u6bb5\u6811\u5c0f\u5f88\u591a\u3002\n\n\u4f46\u662f\u67e5\u8be2\u7684\u662f\u67d0\u4e00\u4e2a\u6570\u5b57\u5728\u533a\u95f4\u7684\u4e2a\u6570\uff0c\u6211\u4eec\u8be5\u600e\u4e48\u529e\u5462\uff1f\n\n\u6211\u4eec\u53ef\u4ee5\u6ce8\u610f\u5230\u67e5\u8be2\u6570\u5b57\u7684\u6570\u636e\u8303\u56f4 $ 1\\le c\\le 100 $,\u8fd9\u5c31\u610f\u5473\u7740\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u66b4\u529b\u5f00 $ 100 $ \u4e2a\u6811\u72b6\u6570\u7ec4\u5957\u6811\u72b6\u6570\u7ec4\u3002\n\n\u4e0b\u6765\u6211\u4eec\u6765\u5206\u6790\u590d\u6742\u5ea6\u3002\n\n\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a $ \\Theta\\left(100mn\\right) $,\u53ea\u9700\u8981\u4e0d\u5230 $ 35 $MB \u7684\u7a7a\u95f4\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u5462\uff1f\n\n\u5efa\u6811\u65f6\uff0c\u4e00\u5171\u4f1a\u5904\u7406 $ nm $ \u4e2a\u683c\u5b50\uff0c\u6240\u4ee5\u5efa\u6811\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $ \\Theta\\left(nm\\log_2m\\log_2n\\right) $\u3002\n\n\u6bcf\u6b21\u4fee\u6539\u4f1a\u540c\u65f6\u4fee\u6539\u4e24\u7ef4\uff0c\u6240\u4ee5\u5355\u6b21\u4fee\u6539\u4e3a $ \\Theta\\left(\\log_2m\\log_2n\\right) $\u3002\n\n\u67e5\u8be2\u65f6\u4e5f\u4f1a\u540c\u65f6\u67e5\u8be2\u4e24\u7ef4\uff0c\u6240\u4ee5\u5355\u6b21\u67e5\u8be2\u4e5f\u4e3a $ \\Theta\\left(\\log_2m\\log_2n\\right) $\u3002\n\n\u6700\u540e\u67e5\u8be2\u6b21\u6570\u4e3a $ Q $ \u6b21\uff0c\u6700\u574f\u60c5\u51b5\u4e0b\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $ \\Theta\\left(Q\\log_2m\\log_2n+nm\\log_2m\\log_2n\\right) $\uff0c\u5dee\u4e0d\u591a\u4e3a $ 2.4\\times 10^7 $,\u79bb\u8d85\u65f6\u8fd8\u6709\u4e00\u5b9a\u8ddd\u79bb\u3002\n\nAC\u4ee3\u7801\uff1a\n```\n#include<cstdio>\nusing namespace std;\nint tr[101][301][301];\nint a[301][301];\nint m,n,k;\nint lowbit(int i) {\n\treturn i&(-i);\n}\nvoid ji(int x,int y,int num,int k) {\n\tif(num<1||num>100)\n\t\treturn ;\n\tfor(int flag1=x; flag1<=m; flag1+=lowbit(flag1))\n\t\tfor(int flag2=y; flag2<=n; flag2+=lowbit(flag2))\n\t\t\ttr[num][flag1][flag2]+=k;\n}\nint get(int x,int y,int k) {\n\tif(k<1||k>100)\n\t\treturn 0;\n\tint ans=0;\n\tint flag1=x;\n\twhile(flag1) {\n\t\tint flag2=y;\n\t\twhile(flag2) {\n\t\t\tans+=tr[k][flag1][flag2];\n\t\t\tflag2-=lowbit(flag2);\n\t\t}\n\t\tflag1-=lowbit(flag1);\n\t}\n\t//printf(\"get(%d,%d,%d)=%d\\n\",x,y,k,ans);\n\treturn ans;\n}\nint main() {\n\tscanf(\"%d%d\",&m,&n);\n\tfor(int i=1; i<=m; i++)\n\t\tfor(int j=1; j<=n; j++) {\n\t\t\tint in;\n\t\t\tscanf(\"%d\",&in);\n\t\t\tji(i,j,in,1);\n\t\t\ta[i][j]=in;\n\t\t}\n\t/*for(int i=1; i<=m; i++) {\n\t\tfor(int j=1; j<=n; j++)\n\t\t\tprintf(\"%d \",tr[1][i][j]);\n\t\tprintf(\"\\n\");\n\t}*/\n\tscanf(\"%d\",&k);\n\tfor(int i=1; i<=k; i++) {\n\t\tint op;\n\t\tscanf(\"%d\",&op);\n\t\tif(op==1) {\n\t\t\tint x,y,k;\n\t\t\tscanf(\"%d%d%d\",&x,&y,&k);\n\t\t\tji(x,y,a[x][y],-1);\n\t\t\ta[x][y]=k;\n\t\t\tji(x,y,a[x][y],1);\n\t\t} else {\n\t\t\tint x1,x2,y1,y2,k;\n\t\t\tscanf(\"%d%d%d%d%d\",&x1,&x2,&y1,&y2,&k);\n\t\t\tprintf(\"%d\\n\",get(x2,y2,k)-get(x2,y1-1,k)-get(x1-1,y2,k)+get(x1-1,y1-1,k));\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\u6ce8\u610f\u4e8b\u9879\uff1a\n1.  \u5982\u679c\u4fee\u6539\u7684\u6570\u4e0d\u5728\u67e5\u8be2\u8303\u56f4\u4ee5\u5185\uff0c\u76f4\u63a5\u8c03\u51fa\u51fd\u6570\uff1b\n\n2.  \u5728\u5bf9\u6570\u5b57\u8fdb\u884c\u4fee\u6539\u7684\u65f6\u5019\u4e00\u5b9a\u8981\u628a\u4fee\u6539\u7684\u6570\u5b57\u51cf\u53bb\u3002\n\n\u611f\u8c22\u89c2\u770b\uff01",
        "postTime": 1622348268,
        "uid": 400201,
        "name": "Wuyanru",
        "ccfLevel": 7,
        "title": "P4054 [JSOI2009]\u8ba1\u6570\u95ee\u9898"
    },
    {
        "content": "## \u601d\u8def\n\n\u6b64\u9898\u662f\u4e00\u9053\u5178\u578b\u7684\u591a\u7ef4\u6811\u72b6\u6570\u7ec4\u3002\n\n\u5b9a\u4e49\u7b2c\u4e00\u4e2a\u7ef4\u5ea6\u4e3a $x$\uff0c\u7b2c\u4e8c\u4e2a\u7ef4\u5ea6\u4e3a $y$\uff0c\u7b2c\u4e09\u4e2a\u7ef4\u5ea6\u4e3a\u6743\u503c $c$\u3002\n\n\u5b9a\u4e49\u4e24\u4e2a\u51fd\u6570 $add(x,y,c,d)$ \u548c $sum(x,y,c)$\u3002\n\n- $add(x,y,c,d)$\uff1a\u5c06\u5de6\u4e0a\u89d2\u70b9\u5750\u6807\u4e3a $(1,1)$\uff0c\u53f3\u4e0b\u89d2\u70b9\u5750\u6807\u4e3a $(x,y)$ \u7684\u77e9\u5f62\u4e2d\u4e2d\u6743\u503c $c$ \u7684\u683c\u5b50\u7684\u4e2a\u6570\u589e\u52a0 $d$\n- $sum(x,y,c)$ \u7edf\u8ba1\u5de6\u4e0a\u89d2\u70b9\u5750\u6807\u4e3a $(1,1)$\uff0c\u53f3\u4e0b\u89d2\u70b9\u5750\u6807\u4e3a $(x,y)$ \u7684\u77e9\u5f62\u4e2d\u6743\u503c\u4e3a $c$ \u7684\u683c\u5b50\u7684\u4e2a\u6570\u3002\n\n\u56e0\u6b64\u5f53\u8fdb\u884c\u64cd\u4f5c 1 \u65f6\uff0c\u5c06\u539f\u5148\u7684\u6743\u503c\u51fa\u73b0\u6b21\u6570 $-1$\uff0c\u5c06\u4fee\u6539\u540e\u7684\u6743\u503c\u7684\u51fa\u73b0\u6b21\u6570 $+1$\uff1b\n\n\u5f53\u8fdb\u884c\u64cd\u4f5c 2 \u65f6\uff0c\u6839\u636e\u5bb9\u65a5\u539f\u7406\uff0c\u6613\u5f97\u7b54\u6848\u4e3a $sum(x2, y2, c) - sum(x2, y1 - 1, c) - sum(x1 - 1, y2, c) + sum(x1 - 1, y1 - 1, c)$\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nint tree[310][310][110], n, m, q, a[310][310];\n\nint lowbit(int x) {\n    return x & (-x);\n}\n\nvoid add(int x, int y, int c, int d) {\n    for (int i = x; i <= n; i += lowbit(i)) {\n        for (int j = y; j <= m; j += lowbit(j)) {\n            tree[i][j][c] += d;\n        }\n    }\n}\n\nint sum(int x, int y, int c) {\n    int ans = 0;\n    for (int i = x; i > 0; i -= lowbit(i)) {\n        for (int j = y; j > 0; j -= lowbit(j)) {\n            ans += tree[i][j][c];\n        }\n    }\n    return ans;\n}\n\nint main() {\n    scanf(\"%d%d\", &n, &m);\n    for (int i = 1; i <= n; ++i) {\n        for (int j = 1; j <= m; ++j) {\n            scanf(\"%d\", &a[i][j]);\n            add(i, j, a[i][j], 1);\n        }\n    }\n    scanf(\"%d\", &q);\n    while (q--) {\n        int t;\n        scanf(\"%d\", &t);\n        if (t == 1) {\n            int x, y, c;\n            scanf(\"%d%d%d\", &x, &y, &c);\n            add(x, y, a[x][y], -1);\n            a[x][y] = c;\n            add(x, y, c, 1);\n        } else {\n            int x1, x2, y1, y2, c;\n            scanf(\"%d%d%d%d%d\", &x1, &x2, &y1, &y2, &c);\n            printf(\"%d\\n\", sum(x2, y2, c) - sum(x2, y1 - 1, c) - sum(x1 - 1, y2, c) + sum(x1 - 1, y1 - 1, c));\n        }\n    }\n    return 0;\n}\n```\n",
        "postTime": 1614852183,
        "uid": 485611,
        "name": "Iron_Heart",
        "ccfLevel": 0,
        "title": "P4054 \u9898\u89e3"
    },
    {
        "content": "### \u9898\u610f\uff1a\n\n\u7ed9\u4f60\u4e00\u4e2a\u77e9\u9635\uff0c\u7ed9\u5b9a\u6bcf\u4e2a\u683c\u70b9\u7684\u521d\u59cb\u989c\u8272\uff0c\u7136\u540e\u8fdb\u884c\u4e24\u79cd\u64cd\u4f5c\uff08\u4e00\u79cd\u662f\u4fee\u6539\u5355\u4e2a\u683c\u70b9\u7684\u989c\u8272\uff0c\u53e6\u4e00\u79cd\u662f\u8be2\u95ee\u5b50\u77e9\u9635\u4e2d\u7279\u5b9a\u7684\u8be2\u95ee\u989c\u8272\u51fa\u73b0\u7684\u6b21\u6570\uff09\n\n### \u524d\u7f6e\u829d\u58eb\uff1a\n\n**\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\uff08\u4ee5\u6c42\u548c\u4e3a\u4f8b\uff09:**\n\u4e00\u822c\u662f\u6307\uff0c\u5047\u8bbe\u5f53\u524d\u8282\u70b9\u4e3a$(x, y)$\uff0c\n\u6240\u4ee5\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4$tr[x][y]=  \\displaystyle \\sum_{i=1}^{x} \\sum_{j = 1}^{y}a[i][j]$\uff0c\u5373\u6c42\u4ee5\u5f53\u524d\u8282\u70b9\u4e3a\u53f3\u4e0b\u89d2\uff0c\u4ee5\u77e9\u9635\u5de6\u4e0a\u89d2\u4f5c\u4e3a\u5de6\u4e0a\u89d2\u7684\u5b50\u77e9\u9635\u7684\u6743\u503c\u603b\u548c\uff08\u6700\u5927\u503c\uff0c\u6700\u5c0f\u503c\u540c\u7406\uff09\n\n### \u5927\u6982\u601d\u8def\uff1a\n\n\u56e0\u4e3a\u989c\u8272\u79cd\u7c7b$\\leq 100$\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f00$100$\u4e2a\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\n#### \u6ce8\uff1a\u4e0b\u9762\u51fa\u73b0\u7684$tr$\u6570\u7ec4\u5747\u6307\u6811\u72b6\u6570\u7ec4\u7684\u67e5\u8be2\u503c\n\n\n#### \u4fee\u6539\uff1a\n\n\u5f53\u6211\u4eec\u8981\u5c06$(x, y)$\u4f4d\u7f6e\u7684$a$\u989c\u8272\u4fee\u6539\u4e3a$b$\u989c\u8272\u65f6\uff0c\u6211\u4eec\u5e94\u8be5\u5148\u5c06$(x,y)$\u4f4d\u7f6e\u7684$a$\u989c\u8272\u7684\u4ef7\u503c\u5220\u53bb\uff0c\u5373\u5728$a$\u7684\u6811\u72b6\u6570\u7ec4\u4e2d\u8fdb\u884c\u4fee\u6539\uff08\u52a0\u4e0a$-1$\uff09\n\n#### \u67e5\u8be2\uff1a\n\n\n\u7ef4\u62a4\u6bcf\u4e00\u79cd\u989c\u8272\u51fa\u73b0\u7684\u6b21\u6570\uff0c\u6700\u540e\u5229\u7528\u524d\u7f00\u548c\u7684\u6027\u8d28\u6c42\u5dee\uff0c\u6c42\u5f97\u51fa\u73b0\u6b21\u6570\u5c31\u597d\u4e86\n\n\u5047\u8bbe\u6211\u4eec\u8981\u67e5\u8be2\u5de6\u4e0a\u89d2\u4e3a$(x0,y0)$\uff0c\u53f3\u4e0b\u89d2\u4e3a$(x1,y1)$\u7684\u5b50\u77e9\u9635\u4e2d(\u4fdd\u8bc1$x0\\leq x1$\u4e14$y0\\leq y1$)$a$\u989c\u8272\uff08\u5047\u8bbe\u6811\u72b6\u6570\u7ec4\u7684\u7f16\u53f7\u4e3a$1$\uff09\u51fa\u73b0\u7684\u6b21\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\n$ans= tr[1][x1][y1] - tr[1][x0 - 1][y1] - tr[1][x1][y0 - 1] + tr[1][x0 - 1][y0 - 1]$\n\n\n### \u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n\nnamespace Tethys{\n\tinline long long read(){\n\t\tlong long s = 0, f = 1; char ch;\n\t\twhile(!isdigit(ch = getchar())) (ch == '-') && (f = -f);\n\t\tfor(s = ch ^ 48; isdigit(ch = getchar()); s = (s << 1) + (s << 3) + (ch ^ 48));\n\t\treturn (s *= f);\n\t}\n}\n\nusing namespace std;\nusing namespace Tethys;\n\nint n, m, Q;\nint tr[105][305][305], s[305][305];\n\nint lowbit(int x){ return x & -x;}\n\nvoid change(int x, int y, int val, int col){\n    for(int i = x; i <= n; i += lowbit(i)){\n        for(int j = y; j <= m; j += lowbit(j)){\n            tr[col][i][j] += val;\n        }\n    }\n}\n\nint query(int x, int y, int col){\n    int res = 0;\n    for(int i = x; i >= 1; i -= lowbit(i)){\n        for(int j = y; j >= 1; j -= lowbit(j)){\n            res += tr[col][i][j];\n        }\n    }\n    return res;\n}\n\nsigned main(){\n\n    n = read(); m = read();\n    for(int i = 1; i <= n; i ++){\n        for(int j = 1, x; j <= m; j ++){\n            s[i][j] = read();\n            change(i, j, 1, s[i][j]);\n        }\n    }\n    \n    Q = read();\n\n    for(int i = 1, opt; i <= Q; i ++){\n        opt = read();\n        if(opt == 1){\n            int x = read(), y = read(), c = read();\n            change(x, y, -1, s[x][y]);\n            change(x, y, 1, c);\n            s[x][y] = c;\n        }else{\n            int x = read(), xx = read(), y = read(), yy = read(), c = read();\n            printf(\"%d\\n\", query(xx, yy, c) - query(xx, y - 1, c) - query(x - 1, yy, c) + query(x - 1, y - 1, c));\n        }\n    }\n    return 0;\n}\n```\n\u5b8c\u7f8e\u6492\u82b1\u273f\u273f\u30fd(\u00b0\u25bd\u00b0)\u30ce\u273f",
        "postTime": 1605307562,
        "uid": 93669,
        "name": "Tethys",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4054 \u3010[JSOI2009]\u8ba1\u6570\u95ee\u9898\u3011"
    },
    {
        "content": "\n\u62ff\u5230\u9898\u5148\u4e00\u770b\uff1a\u5728\u4e00\u7247\u8303\u56f4\u4e2d\u6c42\u67d0\u4e2a\u503c\u7684\u51fa\u73b0\u6b21\u6570!\n\n\u8fd9\u65f6\u6211\u4eec\u5f88\u5bb9\u6613\u5730\u4f1a\u8054\u60f3\u5230\u4e3b\u5e2d\u6811\uff1b\n\n\u2014\u2014\u5e26\u4fee\u6539\uff1f\u90a3\u5c31\u7528\u53ef\u4ee5\u4fee\u6539\u7684\u4e3b\u5e2d\u6811\uff0c\u6811\u5957\u6811\u3002\n\n\u4f46\u95ee\u9898\u6765\u4e86\uff1a\u6811\u5957\u6811\u53ea\u80fd\u7ef4\u62a4\u4e24\u4e2a\u4e1c\u897f\u7684\u9650\u5236\uff0c\u6bd4\u5982 $a\\leq x\\leq b$ \u4e14 $c \\leq y\\leq d$ \u5185 $(x,y)$ \u7684\u4e2a\u6570\uff0c\u6211\u4eec\u67e5\u8be2\u4e00\u4e2a\u533a\u95f4\u5185\u7684\u6240\u6709\u5e73\u8861\u6811\uff0c\u7136\u540e\u518d\u5728\u90a3\u4e9b\u6811\u4e0a\u67e5\u8be2\u53e6\u4e00\u4e2a\u533a\u95f4\uff1b\n\n\u800c\u6b64\u9898\u8981\u9650\u5236\u7684\u6709\u4e09\u4e2a\u4e1c\u897f\uff1a $x$ , $y$ \u548c $c$ \uff0c\u4e5f\u5c31\u662f\uff0c\u7528\u4e0a\u9762\u7ef4\u62a4\u70b9\u5bf9\u6570\u91cf\u7684\u4f8b\u5b50\uff0c\u6b64\u65f6\u53ea\u80fd\u7ef4\u62a4\u4e00\u79cd\u989c\u8272\u3002\u90a3\u8be5\u600e\u4e48\u529e\u5462\uff1f\n\n\u8fd9\u65f6\uff0c\u770b\u4e00\u4e0b\u6570\u636e\u8303\u56f4\uff1a $n,m\\leq 300$ , $c\\leq 100$ ; \u6211\u4eec\u53d1\u73b0\uff0c\u5c24\u5176\u662f\u989c\u8272\u6570\u91cf\uff0c\u90fd\u662f\u5f88\u5c0f\u7684\u89c4\u6a21\uff01\n\n\u90a3\u4e48\uff0c\u65e2\u7136\u4e00\u4e2a\u6811\u5957\u6811\u53ea\u80fd\u7ef4\u62a4\u4e00\u79cd\u989c\u8272\uff0c\u6b64\u65f6\u6709 $100$ \u79cd\u989c\u8272\uff0c\u6211\u4eec\u5f00 $100$ \u9897\u6811\u5957\u6811\u4e0d\u5c31\u884c\u4e86\u5417\uff1f\u4f46\u662f\uff1a\n\n\u5c1d\u8bd5\u5199\u6811\u5957\u6811\uff0c\u4f46\u4ea4\u4e86\u4e00\u6b21\u5c31\u53d1\u73b0\u7206\u7a7a\u95f4\u4e86\u3002\n\n\u4e8e\u662f\u5c31\u60f3\uff0c\u65e2\u7136\u6743\u503c\u7ebf\u6bb5\u6811\u7a7a\u95f4\u5927\uff0c\u90a3\u6362\u6210\u6743\u503c\u6811\u72b6\u6570\u7ec4\uff0c\u4e0d\u5c31\u53ef\u4ee5\u5c0f\u5f88\u591a\u4e86\u5417\uff1f\n\n\u5bf9\u4e8e\u6bcf\u4e00\u79cd\u989c\u8272\uff0c\u5916\u5c42\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u533a\u95f4\uff0c\u7528\u6765\u8ba1\u7b97\u8be2\u95ee $x$ \u5750\u6807\u6d89\u53ca\u5230\u54ea\u4e9b\u6811\uff1b\u5185\u5c42\u6811\u72b6\u6570\u7ec4\u8d1f\u8d23\u8bb0\u5f55\u5728 $y$ \u5750\u6807\u4e0a\u5b58\u4e0d\u5b58\u5728\u8fd9\u79cd\u989c\u8272\u3002\n\n\u5177\u4f53\u5c31\u628a\u6811\u5957\u6811\u7684\u6743\u503c\u7ebf\u6bb5\u6811\u6362\u6210\u6811\u72b6\u6570\u7ec4\u5373\u53ef\uff0c\u4ee3\u7801\u8fd8\u633a\u597d\u5199\u7684\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ninline int read(){\n\tint x=0,f=1;char ch=getchar();\n\twhile(!isdigit(ch)){if(ch=='-')f=-1;ch=getchar();}\n\twhile(isdigit(ch)){x=(x<<3)+(x<<1)+(ch&15);ch=getchar();}\n\treturn x*f;\n}\n\nconst int N=305;\n\nint n,m,q;\nint color[N][N];\n\nstruct BITBIT{\n\t\n\tint tree[N][N];\n\n\tinline int lowbit(int x){\n\t\treturn x&-x;\n\t}\n\n\tinline void update(int val,int sum,int t){\n\t\tfor(int i=val;i<=n;i+=lowbit(i))\n\t\t\ttree[t][i]+=sum;\n\t}\n\n\tinline int getsum(int val,int t){//sum of numbers<=val\n\t\tint ans=0;\n\t\tfor(int i=val;i;i-=lowbit(i))\n\t\t\tans+=tree[t][i];\n\t\treturn ans;\n\t}\n\n\tinline void insert(int idx,int val){\n\t\tfor(int i=idx;i<=n;i+=lowbit(i))\n\t\t\tupdate(val,1,i);\n\t}\n\t\n\tinline void erase(int idx,int val){\n\t\tfor(int i=idx;i<=n;i+=lowbit(i))\n\t\t\tupdate(val,-1,i);\n\t}\n\n\tint sta1[N],sta2[N],top1,top2;\n\tinline void gettree(int l,int r){\n\t\ttop1=top2=0;\n\t\tfor(int i=l-1;i;i-=lowbit(i)) sta1[++top1]=i;\n\t\tfor(int i=r;i;i-=lowbit(i)) sta2[++top2]=i;\n\t}\n\n\tinline int query(int l,int r){\n\t\tint sum=0;\n\t\tfor(int i=1;i<=top1;i++) sum-=getsum(r,sta1[i])-getsum(l-1,sta1[i]);\n\t\tfor(int i=1;i<=top2;i++) sum+=getsum(r,sta2[i])-getsum(l-1,sta2[i]);\n\t\treturn sum;\n\t}\n\n\tinline int calc(int x1,int x2,int y1,int y2){\n\t\tgettree(x1,x2);\n\t\treturn query(y1,y2);\n\t}\n\t\n}BIT[105];\n\ninline void modify(int x,int y,int c){\n\tBIT[color[x][y]].erase(x,y);\n\tBIT[color[x][y]=c].insert(x,y);\n}\n\ninline void query(int x,int x2,int y,int y2,int c){\n\tprintf(\"%d\\n\",BIT[c].calc(x,x2,y,y2));\n}\n\nint main(){\n\tn=read(),m=read();\n\tint c;\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++)\n\t\t\tc=read(),BIT[color[i][j]=c].insert(i,j);\n\t\t\t\n\tq=read();\n\tint opt,x,x2,y,y2;\n\tfor(int i=1;i<=q;i++){\n\t\topt=read();\n\t\tif(opt==1) x=read(),y=read(),c=read(),modify(x,y,c);\n\t\tif(opt==2) x=read(),x2=read(),y=read(),y2=read(),c=read(),query(x,x2,y,y2,c);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1635757382,
        "uid": 145119,
        "name": "WhiteLabs",
        "ccfLevel": 0,
        "title": "\u6811\u72b6\u6570\u7ec4\u5957\u6811\u72b6\u6570\u7ec4"
    },
    {
        "content": "\u8fd9\u9898\u5c31\u662f\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\u6a21\u677f\u9898\n\n\u601d\u8def\u4e0e\u4e00\u7ef4\u6811\u72b6\u6570\u7ec4\u5927\u81f4\u4e00\u6837\n\n- \u5355\u70b9\u95f4\u4fee\u6539\uff1a\u591a\u52a0\u4e00\u7ef4\n\n- \u533a\u95f4\u67e5\u8be2\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/t7z1j8vg.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ihtpvfnf.png)\n\n\u5f88\u660e\u663e\u53f3\u4e0b\u89d2\u90a3\u4e00\u5757\u591a\u51cf\u4e86\u4e00\u6b21\uff0c\u6240\u4ee5\u8981\u52a0\u4e0a\u53bb\n\n# Code:\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,m,q,a[305][305],c[305][305][305];\nvoid update(int x,int y,int z,int k) {\n\ta[x][y]=k;\n\tfor (int i=x; i<=n; i+=(i&(-i)))\n\t\tfor (int j=y; j<=m; j+=(j&(-j)))\n\t\t\tc[k][i][j]+=z;\n}\nint getsum(int x,int y,int k) {\n\tint ans=0;\n\tfor (int i=x; i; i-=(i&(-i)))\n\t\tfor (int j=y; j; j-=(j&(-j)))\n\t\t\tans+=c[k][i][j];\n\treturn ans;\n}\nint main() {\n\tscanf(\"%d%d\",&n,&m);\n\tfor (int i=1; i<=n; i++)\n\t\tfor (int j=1; j<=m; j++) {\n\t\t\tint k;\n\t\t\tscanf(\"%d\",&k);\n\t\t\tupdate(i,j,1,k);\n\t\t}\n\tscanf(\"%d\",&q);\n\twhile (q--) {\n\t\tint opt;\n\t\tscanf(\"%d\",&opt);\n\t\tif (opt==1) {\n\t\t\tint x,y,k;\n\t\t\tscanf(\"%d%d%d\",&x,&y,&k);\n\t\t\tupdate(x,y,-1,a[x][y]);\n\t\t\tupdate(x,y,1,k);\n\t\t} else {\n\t\t\tint x1,x2,y1,y2,k;\n\t\t\tscanf(\"%d%d%d%d%d\",&x1,&x2,&y1,&y2,&k);\n\t\t\tint ans1,ans2;\n\t\t\tprintf(\"%d\\n\",getsum(x2,y2,k)-getsum(x1-1,y2,k)-getsum(x2,y1-1,k)+getsum(x1-1,y1-1,k));\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1591366153,
        "uid": 195209,
        "name": "Cripple_Abyss",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4054 \u3010[JSOI2009]\u8ba1\u6570\u95ee\u9898\u3011"
    }
]
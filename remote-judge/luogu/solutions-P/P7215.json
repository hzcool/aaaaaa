[
    {
        "content": "\n## JOISC2020 \u9996\u90fd\n\n\u4e0a\u8bfe\u8bb2\u5230\u4e86\u8fd9\u9898\uff0c\u53e3\u80e1\u4e86\u4e00\u4e2a\u6811\u5256+\u7ebf\u6bb5\u6811\u4f18\u5316\u5efa\u56fe+\u7f29\u70b9+\u62d3\u6251\u6392\u5e8f\u7684 $O(n$ $log^2$ $n)$\u7684\u505a\u6cd5\uff0c\u4e0b\u8bfe\u540e\u53d1\u73b0\u8fd9\u79cd\u505a\u6cd5\u5df2\u7ecf\u6709\u4eba\u5199\u8fc7\u4e86\u3002\n\n\u90a3\u5c31\u518d\u8865\u4e00\u4e2a $zbk$ \u7684\u70b9\u5206\u6cbb\u505a\u6cd5\u3002\n\n### solution \uff1a\n\n\n\u4e0e\u62d3\u6251\u6392\u5e8f\u7684\u505a\u6cd5\u76f8\u540c\uff0c\u5982\u679c\u7b2c $i$ \u4e2a\u57ce\u5e02\u7684\u4e24\u4e2a\u57ce\u9547\u4e4b\u95f4\u7684\u8def\u5f84\u7ecf\u8fc7\u4e86\u7b2c $j$ \u4e2a\u57ce\u5e02\u7684\u4e00\u4e2a\u5c0f\u9547\uff0c\u90a3\u4e48\u6211\u4eec\u5982\u679c\u60f3\u8ba9\u7b2c $i$ \u4e2a\u57ce\u5e02\u8fde\u901a\uff0c\u5fc5\u987b\u628a $i$ \u548c $j$ \u5408\u5e76\u5728\u4e00\u8d77\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5bf9\u5206\u6cbb\u7684\u6bcf\u4e00\u5c42\uff0c\u6211\u4eec\u5047\u5b9a\u8981\u4f7f\u5206\u6cbb\u4e2d\u5fc3\u6240\u5728\u7684\u57ce\u5e02\u8fde\u901a\uff0c\u7136\u540e\u4e0d\u65ad\u5c06\u9700\u8981\u8fde\u901a\u7684\u8282\u70b9\u653e\u5165\u961f\u5217\u4e2d\uff0c\u5f53\u4e0d\u518d\u6709\u65b0\u8282\u70b9\u52a0\u5165\u961f\u5217\u65f6\uff0c\u8bf4\u660e\u8fd9\u4e9b\u70b9\u5df2\u7ecf\u8fde\u901a\u4e86\u3002\n\n\u5982\u679c\u8bf4\u9047\u5230\u4e86\u4e00\u4e2a\u9700\u8981\u8fde\u901a\u7684\u8282\u70b9\uff0c\u4f46\u5b83\u4e0d\u5728\u5f53\u524d\u5b50\u6811\u5185\uff0c\u76f4\u63a5\u9000\u51fa\u5373\u53ef\u3002\u56e0\u4e3a\u5b83\u5728\u522b\u7684\u5b50\u6811\u5185\uff0c\u90a3\u4e48\u5b83\u5230\u5f53\u524d\u5b50\u6811\u7684\u8def\u5f84\u4f1a\u8de8\u8fc7\u4e0a\u4e00\u5c42\u5206\u6cbb\u4e2d\u5fc3\uff0c\u56e0\u6b64\u5728\u8fd9\u5c42\u53d6\u5f97\u7684\u7b54\u6848\u4e0d\u4f1a\u6bd4\u4e0a\u4e00\u5c42\u66f4\u4f18\u3002\n\n\n### code \uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,k,rt;\nint ver[400005],ne[400005],head[400005],cnt;\nbool vis[200005],used[200005],vised[200005];\nint col[200005],ans=1e9,tot;\ninline void link(int x,int y){\n\tver[++cnt]=y;\n\tne[cnt]=head[x];\n\thead[x]=cnt;\n}\nint siz[200005],mxp[200005];\nvoid find(int x,int fi,int tot){\n\tsiz[x]=1;mxp[x]=0;\n\tfor(int i=head[x];i;i=ne[i]){\n\t\tint u=ver[i];\n\t\tif(u==fi||vis[u])continue;\n\t\tfind(u,x,tot);\n\t\tsiz[x]+=siz[u];mxp[x]=max(mxp[x],siz[u]);\n\t}\n\tmxp[x]=max(mxp[x],tot-siz[x]);\n\tif(mxp[x]<mxp[rt])rt=x;\n}\nvector<int> vec[200005];\nqueue<int> q;\ninline bool push(vector<int> &v){\n\tfor(int i=0;i<v.size();i++){\n\t\tif(!used[v[i]])return 1;\n\t\tq.push(v[i]);\n\t}tot++;\n\treturn 0;\n}\nint fa[200005];\nvoid dfs1(int x,int fi){\n\tfa[x]=fi;\n\tfor(int i=head[x];i;i=ne[i]){\n\t\tint u=ver[i];\n\t\tif(u==fi||vis[u])continue;\n\t\tdfs1(u,x);\n\t}\n}\nint stk[200005],top;\nvoid del(int x,int fi){\n\tstk[top++]=x;used[x]=1;\n\tfor(int i=head[x];i;i=ne[i]){\n\t\tint u=ver[i];\n\t\tif(u==fi||vis[u])continue;\n\t\tdel(u,x);\n\t}\n}\ninline void calc(int x){\n\ttot=0;\n\twhile(!q.empty())q.pop();\n\tvised[col[x]]=1;\n\tif(push(vec[col[x]]))return ;\n\tdfs1(x,x);\n\twhile(!q.empty()){\n\t\tint u=q.front();q.pop();\n\t\tif(!vised[col[fa[u]]]){\n\t\t\tvised[col[fa[u]]]=1;\n\t\t\tif(push(vec[col[fa[u]]]))return ;\n\t\t}\n\t}\n\tans=min(ans,tot);\n}\nvoid solve(int x){\n\tvis[x]=1;del(x,x);\n\tcalc(x);\n\twhile(top)--top,used[stk[top]]=vised[col[stk[top]]]=0;\n\tfor(int i=head[x];i;i=ne[i]){\n\t\tint u=ver[i];\n\t\tif(vis[u])continue;\n\t\trt=0;\n\t\tfind(u,x,siz[u]);\n\t\tsolve(rt);\n\t}\n}\nint main(){\n\tscanf(\"%d%d\",&n,&k);\n\tfor(int i=1;i<n;i++){\n\t\tint x,y;\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tlink(x,y);link(y,x);\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%d\",&col[i]);\n\t\tvec[col[i]].push_back(i);\n\t}\n\tmxp[rt=0]=n;\n\tfind(1,1,n);\n\tsolve(rt);\n\tprintf(\"%d\",ans-1);\n\n\treturn 0;\n}\n```\n\n\n",
        "postTime": 1627175970,
        "uid": 483966,
        "name": "\u4e00\u7c92\u5938\u514b",
        "ccfLevel": 0,
        "title": "JOISC2020 \u9996\u90fd \u9898\u89e3"
    },
    {
        "content": "## JOISC2020 Day4 T1 Capital City\n\n### \u9898\u610f\n\n\u6709 $n$ \u4e2a\u5c0f\u9547\u5f62\u6210\u4e00\u68f5\u6811\uff0c\u7b2c $i$ \u4e2a\u5c0f\u9547\u5c5e\u4e8e\u57ce\u5e02 $C_i$\u3002\u8981\u4ece\u57ce\u5e02\u91cc\u9762\u9009\u51fa\u4e00\u4e2a\u9996\u90fd\uff0c\u4f7f\u5f97\u4ece\u9996\u90fd\u4e2d\u7684\u4efb\u4e00\u4e2a\u57ce\u9547\u5230\u8fbe\u53e6\u4e00\u4e2a\u9996\u90fd\u4e2d\u7684\u57ce\u9547\u53ef\u4ee5\u53ea\u7ecf\u8fc7\u9996\u90fd\u4e2d\u7684\u57ce\u9547\u3002\u73b0\u5728\u53ef\u80fd\u4e0d\u5b58\u5728\u8fd9\u6837\u7684\u57ce\u5e02\uff0c\u6240\u4ee5\u6c42\u6700\u5c11\u5408\u5e76\u51e0\u4e2a\u57ce\u5e02\u624d\u80fd\u9009\u51fa\u4e00\u4e2a\u9996\u90fd\u3002\n\n### \u9898\u89e3\n\n\u8003\u8651\u5efa\u56fe\u3002\u82e5\u7b2c $i$ \u4e2a\u57ce\u5e02\u7684\u5c0f\u9547\u4e4b\u95f4\u7684\u8def\u5f84\u7ecf\u8fc7\u7b2c $j$ \u4e2a\u57ce\u5e02\u7684\u5c0f\u9547\uff0c\u5219\u6211\u4eec\u8fde\u4e00\u6761\u8fb9 $(i,j)$\u3002\n\n\u5728\u8fd9\u5f20\u56fe\u4e2d\u6c42\u51fa\u5f3a\u8fde\u901a\u5206\u91cf\uff0c\u4e0d\u96be\u53d1\u73b0\u51fa\u5ea6\u4e3a $0$ \u7684\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u8282\u70b9\u6570\u6700\u5c0f\u503c\u5c31\u662f\u7b54\u6848\u3002\n\n\u7ebf\u6bb5\u6811\u4f18\u5316\u5efa\u56fe+\u6811\u5256+\u7f29\u70b9\u4e0d\u96be\u89e3\u51b3\u3002\n\n```cpp\n#include <bits/stdc++.h>\n\nnamespace zghtyarecrenj\n{\n\t#define gc() getchar()\n\ttemplate <typename Ty>\n\tinline void read(Ty &t)\n\t{\n\t\tt = 0; bool neg = 0; char ch = gc();\n\t\twhile (ch != '-' && (ch < '0' || ch > '9')) ch = gc();\n\t\tif (ch == '-') neg = 1;\n\t\tdo { t = t * 10 + ch - '0'; ch = gc(); } while (ch >= '0' && ch <= '9');\n\t\tif (neg) t = -t;\n\t}\n} // namespace zghtyarecrenj\n\nusing zghtyarecrenj::read;\n\nconst int N = 2e5 + 5;\nconst int V = 1e6 + 5;\n\nint k, n, c[N], pool, rt;\nstd::vector<int> g[N], G[V], a[N];\nint dep[N], anc[N], siz[N], son[N], seg[N], rev[N], top[N], scnt;\nint dfn[V], low[V], vis[V], res[V], cnt, sz[V], du[V], tot;\nstd::stack<int> s;\n\nstruct Node\n{\n\tint L, R, ls, rs;\n} T[N << 2];\n\nint build(int l, int r)\n{\n\tint k = ++pool;\n\tT[k].L = l, T[k].R = r;\n\tif (l == r)\n\t{\n\t\tG[k].push_back(c[rev[l]]);\n\t\treturn k;\n\t}\n\tint mid = (l + r) / 2;\n\tT[k].ls = build(l, mid);\n\tT[k].rs = build(mid + 1, r);\n\tG[k].push_back(T[k].ls);\n\tG[k].push_back(T[k].rs);\n\treturn k;\n}\n\nvoid add(int k, int x, int y, int d)\n{\n\tif (x <= T[k].L && T[k].R <= y)\n\t{\n\t\tG[d].push_back(k);\n\t\treturn;\n\t}\n\tint mid = (T[k].L + T[k].R) / 2;\n\tif (x <= mid)\n\t\tadd(T[k].ls, x, y, d);\n\tif (y > mid)\n\t\tadd(T[k].rs, x, y, d);\n}\n\nvoid dfs1(int u, int fa)\n{\n\tdep[u] = dep[fa] + 1, anc[u] = fa, siz[u] = 1;\n\tfor (int v : g[u])\n\t\tif (v != fa)\n\t\t{\n\t\t\tdfs1(v, u);\n\t\t\tsiz[u] += siz[v];\n\t\t\tif (siz[v] > siz[son[u]])\n\t\t\t\tson[u] = v;\n\t\t}\n}\n\nvoid dfs2(int u, int tp)\n{\n\ttop[u] = tp, seg[u] = ++scnt, rev[scnt] = u;\n\tif (son[u]) dfs2(son[u], tp);\n\tfor (int v : g[u])\n\t\tif (v != anc[u] && v != son[u])\n\t\t\tdfs2(v, v);\n}\n\ninline int lca(int u, int v)\n{\n\twhile (top[u] != top[v])\n\t{\n\t\tif (dep[top[u]] < dep[top[v]]) \n\t\t\tstd::swap(u, v);\n\t\tu = anc[top[u]];\n\t}\n\treturn dep[u] < dep[v] ? u : v;\n}\n\nvoid modify(int u, int v)\n{\n\tint cx = c[u];\n\twhile (top[u] != top[v])\n\t{\n\t\tif (dep[top[u]] < dep[top[v]])\n\t\t\tstd::swap(u, v);\n\t\tadd(rt, seg[top[u]], seg[u], cx);\n\t\tu = anc[top[u]];\n\t}\n\tif (dep[v] > dep[u])\n\t\tstd::swap(u, v);\n\tadd(rt, seg[v], seg[u], cx);\n}\n\nvoid tarjan(int u)\n{\n\tdfn[u] = low[u] = ++tot, vis[u] = 1, s.push(u);\n\tfor (int v : G[u])\n\t{\n\t\tif (dfn[v] == -1)\n\t\t{\n\t\t\ttarjan(v);\n\t\t\tlow[u] = std::min(low[u], low[v]);\n\t\t}\n\t\telse if (vis[v])\n\t\t\tlow[u] = std::min(low[u], dfn[v]);\n\t}\n\tif (dfn[u] == low[u])\n\t{\n\t\t++cnt;\n\t\twhile (1)\n\t\t{\n\t\t\tint cur = s.top(); s.pop();\n\t\t\tvis[cur] = 0, res[cur] = cnt;\n\t\t\tif (u == cur) break;\n\t\t}\n\t}\n}\n\nint main()\n{\n\tread(n), read(k);\n\tfor (int i = 1; i < n; ++i)\n\t{\n\t\tint x, y;\n\t\tread(x), read(y);\n\t\tg[x].push_back(y), g[y].push_back(x);\n\t}\n\tfor (int i = 1; i <= n; ++i)\n\t\tread(c[i]), a[c[i]].push_back(i);\n\tpool = k;\n\tdfs1(1, 0);\n\tdfs2(1, 1);\n\trt = build(1, n);\n\tfor (int i = 1; i <= k; ++i)\n\t\tif (a[i].size() > 1)\n\t\t{\n\t\t\tint m = a[i][0];\n\t\t\tfor (int j = 1; j < a[i].size(); ++j)\n\t\t\t{\n\t\t\t\t\tint l = lca(a[i][0], a[i][j]);\n\t\t\t\t\tif (a[i][j] != l) \n\t\t\t\t\t\tmodify(a[i][j], l);\n\t\t\t\t\tif (dep[l] < dep[m])\n\t\t\t\t\t\tm = l;\n\t\t\t}\n\t\t\tif (a[i][0] != m)\n\t\t\t\tmodify(a[i][0], m);\n\t\t}\n//\tfor (int i = 1; i <= pool; ++i)\n//\t{\n//\t\tprintf(\"%d:\\n\", i);\n//\t\tfor (int j : G[i]) printf(\"%d \", j); printf(\"\\n\");\n//\t}\n\tmemset(dfn, -1, sizeof(dfn));\n\tfor (int i = 1; i <= pool; ++i)\n\t\tif (dfn[i] == -1)\n\t\t\ttarjan(i);\n\tfor (int i = 1; i <= k; ++i) \n\t\t++sz[res[i]];\n\tfor (int i = 1; i <= pool; ++i)\n\t\tfor (int j : G[i])\n\t\t\tif (res[i] != res[j]) ++du[res[i]];\n\tint ans = 2e9;\n\tfor (int i = 1; i <= k; ++i)\n\t\tif (!du[res[i]]) ans = std::min(ans, sz[res[i]] - 1);\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1616942089,
        "uid": 302509,
        "name": "zghtyarecrenj",
        "ccfLevel": 7,
        "title": "JOISC2020 D4T1 Capital City \u9898\u89e3"
    },
    {
        "content": "PKUSC \u4e4b\u524d\u53d1\u7bc7\u9898\u89e3\u6da8\u6da8 RP\uff0c\u548c\u5df2\u6709\u7684\u70b9\u5206\u6cbb\u7684\u601d\u8003\u65b9\u5411\u8c8c\u4f3c\u4e0d\u540c\u3002\n\n> \u7ed9\u5b9a\u6811\u4e0a\u6bcf\u4e2a\u70b9\u6240\u5c5e\u7684\u57ce\u5e02\uff0c\u8981\u6c42\u9009\u5219\u5c3d\u91cf\u5c11\u7684\u57ce\u5e02\uff0c\u4f7f\u5f97\u8fd9\u4e9b\u57ce\u5e02\u6240\u6709\u5f52\u5c5e\u8282\u70b9\u7684\u5e76\u4e3a\u4e00\u4e2a\u6811\u4e0a\u8fde\u901a\u5757\u3002\n\n\u4e3b\u8981\u601d\u8def\u6765\u6e90\u4e8e\u94fe\u7684\u90e8\u5206\u5206\u3002\u53d1\u73b0\u53ef\u4ee5\u5206\u6cbb\u505a\uff0c\u6bcf\u6b21\u94a6\u5b9a $\\text{mid}$ \u6240\u5c5e\u57ce\u5e02\u4e3a\u8fde\u901a\u5757\u4e2d\u5fc5\u9009\u7684\u57ce\u5e02\u3002\n\n\u56e0\u4e3a\u8de8\u8fc7\u5206\u6cbb\u4e2d\u5fc3\u7684\u70b9\u5fc5\u987b\u9009\u5b83\uff0c\u4e5f\u5c31\u5fc5\u987b\u9009\u5b83\u6240\u5c5e\u7684\u57ce\u5e02\u3002\u7136\u540e\u5b9e\u73b0\u4e00\u4e2a `expand` \u51fd\u6570\u4e0d\u65ad\u6269\u5c55\u3002\n\n\u6bcf\u4e2a\u57ce\u5e02\u53ea\u4f1a\u88ab\u6269\u5c55\u4e00\u6b21\uff0c\u6bcf\u6b21\u6269\u5c55\u679a\u4e3e\u57ce\u5e02\u4e2d\u7684\u6240\u6709\u70b9\uff0c\u5e76\u628a\u8be5\u70b9\u5230 $\\text{mid}$ \u7684\u533a\u95f4\u5185\u7684\u70b9\u90fd\u9009\u62e9\u4e0a\uff0c\u8fd9\u662f\u9898\u610f\u4f7f\u7136\u3002\n\n\u5b9e\u73b0\u65f6\u91c7\u7528\u5355\u70b9\u53d6\u6d88\u6765\u9650\u5236\uff0c\u5982\u679c\u4e00\u79cd\u57ce\u5e02\u7684\u70b9\u8de8\u8fc7\u4e86\u5f53\u524d\u5206\u6cbb\u4e2d\u5fc3\uff0c\u90a3\u4e48\u5c31\u628a\u5b83\u53d6\u6d88\u6389\u3002\n\n\u8fd9\u79cd\u57ce\u5e02\u663e\u7136\u4e0d\u53ef\u80fd\u4f5c\u4e3a\u7b54\u6848\u51b3\u7b56\u4e86\uff0c\u800c expand \u5408\u6cd5\u7684\u5145\u8981\u4e5f\u6070\u6070\u662f\u4e0d\u4f1a expand \u5230\u88ab\u53d6\u6d88\u7684\u70b9\u3002\n\n\u7c7b\u4f3c\u8fd9\u6837\uff1a\n\n```cpp\nbool vis[N], lim[N], used[N];\nint ans, cur;\n\nbool expand(int col, int mid) {\n\tvector<int> nxt;\n\n\tfor(int o : vec[col])\n\t\tif(o <= mid) {\n\t\t\tint p = o;\n\t\t\twhile(p <= mid) {\n\t\t\t\tif(vis[p]) break;\n\n\t\t\t\tvis[p] = true;\n\t\t\t\tif(lim[c[p]]) return false;\n\t\t\t\telse if(! used[c[p]]) nxt.push_back(c[p]), used[c[p]] = true, cur ++;\n\t\t\t\tp ++;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tint p = o;\n\t\t\twhile(p > mid) {\n\t\t\t\tif(vis[p]) break;\n\t\t\t\t\n\t\t\t\tvis[p] = true;\n\t\t\t\tif(lim[c[p]]) return false;\n\t\t\t\telse if(! used[c[p]]) nxt.push_back(c[p]), used[c[p]] = true, cur ++;\n\t\t\t\tp --;\n\t\t\t}\n\t\t}\n\n\tfor(int o : nxt) if(! expand(o, mid)) return false;\n\treturn true;\n}\n\nvoid solve(int l, int r) {\n\tif(l == r) {if(vec[c[l]].size() == 1) ans = 0; return;}\n\tint mid = (l + r) >> 1;\n\tif(! lim[c[mid]]) {\n\t\tused[c[mid]] = true, cur = 1;\n\t\tif(expand(c[mid], mid)) ans = min(ans, cur - 1);\n\t\tper(i, mid, l) vis[i] = false, used[c[i]] = false;\n\t\trep(i, mid + 1, r) vis[i] = false, used[c[i]] = false;\n\t}\n\trep(i, l, mid) if(las[c[i]] > mid) lim[c[i]] = true;\n\tsolve(l, mid);\n\tsolve(mid + 1, r);\n}\n```\n\n\u628a\u94fe\u8f6c\u5230\u6811\u4e0a\u5b9e\u9645\u4e0a\u66f4\u7b80\u5355\uff0c\u76f4\u63a5\u70b9\u5206\u6cbb\uff0c\u7136\u540e\u6bcf\u6b21\u5f3a\u5236\u9009\u6839\uff0c\u7c7b\u4f3c\u4e0a\u9762\u7684 expand \u8fc7\u7a0b\u5373\u53ef\u3002\n\n\u5b9e\u9645\u4e0a\u94fe\u5230\u6811\u7684\u8f6c\u6362\u8fd8\u4e00\u65f6\u7cca\u6d82\uff0c\u4ee5\u4e3a\u662f\u94a6\u5b9a\u67d0\u4e2a\u76f4\u63a5\u513f\u5b50\u4e3a\u51b3\u7b56\uff0c\u7136\u540e\u60f3\u4e86\u534a\u5929\u4ee5\u4e3a\u6811\u4e0a\u4e0d\u53ef\u505a\uff0c\u7136\u540e\u624d\u53d1\u73b0\u6709\u4e2a\u6839\u662f\u5fc5\u9009\u7684\uff08\n\n\u8fd8\u6709\u4e00\u79cd\u786c\u4e0a\u7ebf\u6bb5\u6811\u4f18\u5316\u5efa\u56fe + \u7f29\u70b9\u7684\u79d1\u6280\u611f\u6d53\u6d53\u7684\u65b9\u6cd5\uff0c\u611f\u89c9\u4e0a\u6ca1\u6709\u70b9\u5206\u6cbb\u4f18\u7f8e\u3002\n\n```cpp\nconst int N = 2e5 + 10;\nint n, k, c[N], ans;\nvector<int> G[N], vec[N];\n\nint Rt, Mx, siz[N], mxp[N];\nbool vis[N];\n\nvoid dfsRt(int u, int fa) {\n\tsiz[u] = mxp[u] = 1;\n\tfor(int v : G[u]) if(v != fa && ! vis[v])\n\t\tdfsRt(v, u), \n\t\tsiz[u] += siz[v], \n\t\tmxp[u] = max(mxp[u], siz[v]);\n\tmxp[u] = max(mxp[u], Mx - siz[u]);\n\tif(! Rt || mxp[u] < mxp[Rt]) Rt = u;\n}\n\nint cur, fa[N], blo[N];\nbool lim[N], exd[N], used[N];\n\nvoid dfsFa(int u, int Fa) {\n\tfa[u] = Fa, blo[c[u]] = 0;\n\tfor(int v : G[u]) if(v != Fa && ! vis[v]) dfsFa(v, u);\n}\n\nvector<int> arc;\n\nbool expand(int col) {\n\tvector<int> nxt;\n\tfor(int o : vec[col]) {\n\t\tint p = o;\n\t\twhile(p) {\n\t\t\tif(exd[p]) break; exd[p] = true, arc.push_back(p);\n\t\t\tif(lim[c[p]]) return false;\n\t\t\telse if(! used[c[p]]) used[c[p]] = true, cur ++, nxt.push_back(c[p]);\n\t\t\tp = fa[p];\n\t\t}\n\t}\n\tfor(int o : nxt) if(! expand(o)) return false;\n\treturn true;\n}\n\nvoid dfsCr(int u, int Fa, int top) {\n\tif(blo[c[u]] && blo[c[u]] != top) lim[c[u]] = true;\n\tblo[c[u]] = top, siz[u] = 1;\n\n\tfor(int v : G[u]) if(v != Fa && ! vis[v]) dfsCr(v, u, top), siz[u] += siz[v];\n}\n\nvoid calc(int u) {\n\tif(lim[c[u]]) return;\n\tif(vec[c[u]].size() == 1) {ans = 0; return;}\n\t\n\tfa[u] = 0;\n\tfor(int v : G[u]) if(! vis[v]) dfsFa(v, u);\n\tcur = 1, used[c[u]] = true;\n\n\tif(expand(c[u])) ans = min(ans, cur - 1);\n\tlim[c[u]] = true;\n\tfor(int v : G[u]) if(! vis[v]) dfsCr(v, u, v);\n\tfor(int v : arc) exd[v] = used[c[v]] = false;\n\tarc.clear();\n}\n\nvoid solve(int u) {\n\tvis[u] = true, calc(u);\n\tfor(int v : G[u]) if(! vis[v])\n\t\tRt = 0, Mx = siz[v], dfsRt(v, u), solve(Rt);\n}\n\nint main() {\n\tn = read(), k = read();\n\trep(i, 2, n) {\n\t\tint u = read(), v = read();\n\t\tG[u].push_back(v);\n\t\tG[v].push_back(u);\n\t}\n\trep(i, 1, n) c[i] = read(), vec[c[i]].push_back(i);\n\tans = n;\n\tRt = 0, Mx = n, dfsRt(1, 0), solve(Rt);\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1652966523,
        "uid": 117941,
        "name": "_LPF_",
        "ccfLevel": 9,
        "title": "P7215 [JOISC2020] \u9996\u90fd"
    },
    {
        "content": "\u7b54\u6848\u76f8\u5f53\u4e8e\u8981\u627e\u5230\u4e00\u4e2a\u5305\u542b\u989c\u8272\u6700\u5c11\u7684\u8fde\u901a\u5757\uff0c\u6ee1\u8db3\u8fde\u901a\u5757\u5185\u7684\u989c\u8272\u548c\u8fde\u901a\u5757\u5916\u7684\u989c\u8272\u4e24\u4e24\u4e0d\u540c\uff0c\u6211\u4eec\u79f0\u8fd9\u6837\u7684\u8fde\u901a\u5757\u4e3a**\u5408\u6cd5**\u8fde\u901a\u5757\u3002\n\n\u8003\u8651\u70b9\u5206\u6cbb\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u6b21\u70b9\u5206\u51fa\u6765\u7684\u91cd\u5fc3\u548c\u8fde\u901a\u5757\uff0c\u6211\u4eec\u5728\u8fde\u901a\u5757\u4e2d\u627e\u5230\u6700\u5c0f\u7684\u5305\u542b\u91cd\u5fc3\u7684\u5408\u6cd5\u8fde\u901a\u5757\uff0c\u7528\u8fd9\u4e2a\u8fde\u901a\u5757\u7684\u7b54\u6848\u53bb\u66f4\u65b0\u7b54\u6848\u3002\n\n\u8fd9\u6837\uff0c\u6700\u4f18\u89e3\u4e00\u5b9a\u4f1a\u88ab\u66f4\u65b0\u5230\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n \\log n)$\u3002\n\n```cpp\nconst int N = 2e5 + 7;\nint n, m, a[N], c[N], ans, f[N], s[N], rt, mn;\nvi e[N], b[N], p;\nbool u[N], v[N], w[N];\n\nvoid getrt(int x, int S) {\n\tv[x] = 1, s[x] = 1;\n\tif (!b[a[x]].size()) p.pb(a[x]);\n\tb[a[x]].pb(x); \n\tint o = 0;\n\tfor (int y : e[x])\n\t\tif (!v[y] && !w[y]) getrt(y, S), s[x] += s[y], o = max(o, s[y]);\n\to = max(o, S - s[x]);\n\tif (o < mn) rt = x, mn = o;\n\tv[x] = 0;\n}\n\nvoid dfs(int x) {\n\tv[x] = 1, s[x] = 1;\n\tfor (int y : e[x])\n\t\tif (!v[y] && !w[y]) f[y] = x, dfs(y), s[x] += s[y];\n\tv[x] = 0;\n}\n\nvoid solve(int x, int S) {\n\trt = x, mn = S, f[x] = 0, getrt(x, S), dfs(rt);\n\tqueue<int> q;\n\tq.push(a[rt]), u[a[rt]] = 1, v[rt] = 1;\n\tint cnt = 0;\n\tbool ok = (int)b[a[rt]].size() == c[a[rt]];\n\twhile (ok && q.size()) {\n\t\tint x = q.front();\n\t\tq.pop();\n\t\tfor (int y : b[x])\n\t\t\twhile (!v[y]) {\n\t\t\t\tv[y] = 1;\n\t\t\t\tif (!u[a[y]]) {\n\t\t\t\t\tif ((int)b[a[y]].size() != c[a[y]]) ok = 0;\n\t\t\t\t\tq.push(a[y]), u[a[y]] = 1, ++cnt;\n\t\t\t\t}\n\t\t\t\ty = f[y];\n\t\t\t}\n\t}\n\tif (ok) ans = min(ans, cnt);\n\tfor (int x : p) {\n\t\tfor (int y : b[x]) v[y] = 0;\n\t\tb[x].clear(), u[x] = 0;\n\t}\n\tp.clear();\n\tw[rt] = 1;\n\tint now = rt;\n\tfor (int nxt : e[now])\n\t\tif (!w[nxt]) solve(nxt, s[nxt]);\n}\n\nint main() {\n\trd(n), rd(m), ans = m;\n\tfor (int i = 1, x, y; i < n; i++)\n\t\trd(x), rd(y), e[x].pb(y), e[y].pb(x);\n\tfor (int i = 1; i <= n; i++) rd(a[i]), ++c[a[i]];\n\tsolve(1, n), print(ans);\n\treturn 0;\n}\n```",
        "postTime": 1681828252,
        "uid": 100544,
        "name": "xht",
        "ccfLevel": 9,
        "title": "P7215"
    },
    {
        "content": "\u53ef\u4ee5\u6839\u53f7\u3002\n\n\u8003\u8651\u7b80\u5355\u66b4\u529b\uff0c\u786e\u5b9a\u4e00\u79cd\u989c\u8272\u5728\u6700\u7ec8\u96c6\u5408\u540e\u600e\u4e48\u505a\u3002\u7ef4\u62a4\u5f53\u524d\u989c\u8272 $i$ \u7684\u7684\u6781\u5c0f\u8054\u901a\u5b50\u6811 $T_i$\uff0c\u8bbe\u5176\u6839\u4e3a $rt$\u3002\u5411\u5176\u4e2d\u52a0\u70b9 $x$ \u65f6\u5c06\u8def\u5f84 $(x,rt)$ \u4e0a\u7684\u672a\u52a0\u5165\u7684\u989c\u8272\u7684\u6240\u6709\u70b9\u52a0\u5165\u3002\u8fc7\u7a0b\u662f\u53ef\u4ee5\u770b\u6210\u5728\u7ebf\u7684\uff0c\u5373\u53ef\u4ee5\u5728 $O(k)$ \u7684\u65f6\u95f4\u5185\u6c42\u51fa\u52a0\u5165 $T$ \u7684\u524d $k$ \u4e2a\u70b9\u6784\u6210\u7684\u6781\u5c0f\u8054\u901a\u5b50\u6811\u3002 \n\n\u76f4\u63a5\u5bf9\u6bcf\u4e2a\u989c\u8272\u505a\u662f\u4e0d\u592a\u884c\u7684\uff0c\u8003\u8651\u6839\u53f7\u5206\u6cbb\u3002\u5bf9\u4e8e\u4e00\u79cd\u989c\u8272\uff0c\u53ea\u5904\u7406\u5176 $T$ \u7684\u524d $B$ \u4e2a\u70b9\uff0c\u5982\u679c\u80fd\u6784\u6210\u5c31\u8ba1\u5165\u7b54\u6848\u3002\u4e4b\u540e\u5269\u4e0b\u6ca1\u6709\u88ab\u8ba1\u7b97\u7684 $T_i$ \u90fd\u6ee1\u8db3 $|T_i|>B$\uff0c\u6bcf\u6b21\u968f\u673a\u70b9\u5e76\u8dd1\u4e00\u6b21\u8be5\u8fc7\u7a0b\uff0c\u671f\u671b $O(\\dfrac{n}{B})$ \u6b21\u80fd\u627e\u5230\u4e00\u4e2a\u5728\u6700\u7ec8\u96c6\u5408\u7684\u70b9\u3002\n\n\u590d\u6742\u5ea6\u662f $O(n\\sqrt{n})$\uff0c\u5b9e\u9645\u9608\u503c\u53ef\u4ee5\u53d6\u7684\u79bb\u8c31\u4e9b\uff0c\u53cd\u6b63\u6570\u636e\u5f88\u96be\u5361\u6389\u3002\n\n```cpp\nmt19937_64 rnd(chrono::steady_clock::now().time_since_epoch().count());\n\nint n,k,col[200005],used[200005],ord[200005];\nint fa[200005],dep[200005],vis[200005],inq[200005],tot;\nvec e[200005],vt[200005],q;\nvoid dfs(int x,int Fa){\n    fa[x]=Fa,dep[x]=dep[Fa]+1;\n    for(int y:e[x]) if(y^Fa) dfs(y,x);\n}\nint solve(int i,int op){\n    while(!q.empty()) vis[q.back()]=inq[col[q.back()]]=0,q.pop_back(); \n    for(int x:vt[i]) q.epb(x);\n    int rt=q.front(),nw=0; vis[rt]=1; inq[i]=1;\n    //printf(\"visbg %d %d\\n\",rt,col[rt]);\n    for(rg int l=1;l<q.size();++l){\n        int x=q[l]; \n        if(vis[x]) continue;\n        vis[x]=1;\n        //printf(\"vis %d %d\\n\",x,col[x]);\n        while(x!=rt){\n            if(dep[rt]>dep[x]){\n                rt=fa[rt];\n                if(vis[rt]) break;\n                vis[rt]=1;\n                if(inq[col[rt]]) continue;\n                ++nw; inq[col[rt]]=1;\n                for(int y:vt[col[rt]]){\n                    q.epb(y);\n                    if(op&&q.size()>200) return q.epb(rt),k+1;\n                }\n            }else{\n                x=fa[x];\n                if(vis[x]) break;\n                vis[x]=1;\n                if(inq[col[x]]) continue;\n                ++nw; inq[col[x]]=1;\n                for(int y:vt[col[x]]){\n                    q.epb(y);\n                    if(op&&q.size()>200) return q.epb(x),k+1;\n                }\n            }\n        }\n    }\n    used[i]=1;\n    return nw;\n}\nsigned main(){\n    n=read(),k=read();\n    rep(i,n-1){\n        const int u=read(),v=read();\n        e[u].epb(v),e[v].epb(u);\n    }\n    dfs(1,0);\n    rep(i,n) col[i]=read(),vt[col[i]].epb(i),ord[i]=i;\n    int ans(k+1);\n    rep(i,k){\n        if(!vt[i].size()){\n            used[i]=1;\n            continue;\n        }\n        if(vt[i].size()>200) continue;\n        ans=min(ans,solve(i,1));\n    }\n    //puts(\"done\");\n    rep(i,k) tot+=(!used[i]);\n    tot=min(tot,50);\n    shuffle(ord+1,ord+1+n,rnd);\n    for(rg int i=1;tot;++i){\n        if(used[col[ord[i]]]) continue;\n        --tot;\n        ans=min(ans,solve(col[ord[i]],0));\n    }\n    printf(\"%d\\n\",ans);\n    return 0;\n}\n\n```\n",
        "postTime": 1682313317,
        "uid": 241977,
        "name": "Legitimity",
        "ccfLevel": 8,
        "title": "\u6839\u53f7"
    },
    {
        "content": "\u70b9\u5206\u6cbb\u3002\n\n\u8003\u8651\u5f53\u524d\u7684\u5206\u6cbb\u91cd\u5fc3\u7684\u57ce\u5e02\u88ab\u5b8c\u5168\u8054\u901a\u3002\n\n\u8fd9\u53ef\u4ee5\u7528\u961f\u5217\u63a5\u89e3\u51b3\u3002\u6bcf\u6b21\u653e\u5165\u4e00\u79cd\u57ce\u5e02\uff0c\u5c31\u628a\u90a3\u4e9b\u57ce\u9547\u7684\u7236\u4eb2\u52a0\u5165\u961f\u5217\uff0c\u5982\u679c\u5b58\u5728\u57ce\u9547\u4e0d\u5728\u5f53\u524d\u5206\u6cbb\u91cd\u5fc3\u7684\u8054\u901a\u5757\u5185\uff0c\u90a3\u4e48\u8bf4\u660e\u5fc5\u5b9a\u5b58\u5728\u53e6\u4e00\u4e2a\u5206\u6cbb\u91cd\u5fc3\u80fd\u7b97\u5230\u5b83\uff0c\u76f4\u63a5\u9000\u51fa\u5373\u53ef\u3002\n\n\u5269\u4e0b\u7684\u548c\u6a21\u677f\u6ca1\u6709\u4efb\u4f55\u533a\u522b\u3002\n\n\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\ncode:\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=2e5+5;\nint n,k,co[N],f[N],siz[N],vis[N],vis2[N],vis3[N],tmp[N],fa[N],rt,ans=INT_MAX/2,tot=0,cnt=0;\nvector<int>adj[N],c[N];\nvoid dfs(int u,int lst,int sum){\n  siz[u]=1;f[u]=0;\n  for(int i=0;i<adj[u].size();++i){\n    int v=adj[u][i];if(v==lst||vis[v])continue;\n    dfs(v,u,sum);siz[u]+=siz[v];\n    f[u]=max(f[u],siz[v]);\n  }\n  f[u]=max(f[u],sum-siz[u]);\n  if(f[u]<f[rt])rt=u;\n}\nvoid dfs2(int u,int lst){\n  tmp[++tot]=u;vis2[u]=1;fa[u]=lst;\n  for(int i=0;i<adj[u].size();++i){\n    int v=adj[u][i];if(v==lst||vis[v])continue;\n    dfs2(v,u);\n  }\n}\nqueue<int>q;\nbool check(int w){\n  for(int i=0;i<c[w].size();++i){\n    int v=c[w][i];if(!vis2[v])return true;\n    q.push(v);\n  }\n  ++cnt;\n  return false;\n}\nvoid cal(int u){\n  while(!q.empty())q.pop();\n  vis3[co[u]]=1;\n  if(check(co[u]))return;\n  while(!q.empty()){\n    int u=q.front();q.pop();\n    if(!vis3[co[fa[u]]]){\n      vis3[co[fa[u]]]=1;\n      if(check(co[fa[u]]))return;\n    }\n  }\n  ans=min(ans,cnt-1);\n}\nvoid solve(int u){\n  vis[u]=1;tot=0;cnt=0;dfs2(u,u);cal(u);\n  for(int i=1;i<=tot;++i)vis2[tmp[i]]=vis3[co[tmp[i]]]=0;\n  for(int i=0;i<adj[u].size();++i){\n    int v=adj[u][i];if(vis[v])continue;\n    rt=0;dfs(v,u,siz[v]);solve(rt);\n  }\n}\nint main(){\n  ios::sync_with_stdio(false);cin.tie(0);cout.tie(0);\n  cin>>n>>k;\n  for(int i=1;i<n;++i){\n    int u,v;cin>>u>>v;\n    adj[u].push_back(v);adj[v].push_back(u);\n  }\n  for(int i=1;i<=n;++i){\n    cin>>co[i];\n    c[co[i]].push_back(i);\n  }\n  f[0]=1e9;dfs(1,0,n);solve(rt);\n  cout<<ans<<endl;\n  return 0;\n}\n\n```\n",
        "postTime": 1684836677,
        "uid": 173864,
        "name": "EstasTonne",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P7215"
    },
    {
        "content": "\u9996\u5148\u8003\u8651\u6211\u4eec\u4e00\u5b9a\u8981\u9009\u989c\u8272 $1$ \u65f6\u600e\u4e48\u505a\u3002\u663e\u7136\u6211\u4eec\u6b64\u65f6\u4e00\u5b9a\u8981\u9009\u62e9\u989c\u8272 $1$ \u865a\u6811\u4e2d\u6240\u6709\u7684\u70b9\uff0c\u7136\u540e\u6211\u4eec\u4f1a\u5f97\u5230\u4e00\u4e9b\u65b0\u7684\u989c\u8272\uff0c\u7136\u540e\u6211\u4eec\u53c8\u53ef\u4ee5\u627e\u5230\u4e00\u4e9b\u65b0\u7684\u5fc5\u987b\u8981\u9009\u7684\u70b9\u3002\u5177\u4f53\u7684\u5b9e\u73b0\u4e2d\u6211\u4eec\u53ef\u4ee5\u968f\u4fbf\u9009\u62e9\u4e00\u4e2a\u989c\u8272 $1$ \u7684\u70b9\u4e3a\u6839\uff0c\u7136\u540e\u8fdb\u884c BFS \u8fc7\u7a0b\uff1a\u9009\u989c\u8272 $x$ \u7684\u70b9\u4e4b\u540e\u8981\u628a\u5176\u4ed6\u6240\u6709\u989c\u8272 $x$ \u5168\u9009\u5b8c\u4e14\u9009\u70b9 $u$ \u4e00\u5b9a\u8981\u9009\u5b83\u7684\u7236\u4eb2\u3002\n\n\u76f4\u63a5\u66b4\u529b\u662f $O(n^2)$ \u7684\uff0c\u7136\u540e\u6211\u4eec\u628a\u5b83\u4fee\u6539\u6210\u70b9\u5206\u6cbb\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7b80\u5355\u7684 $O(n\\log n)$ \u505a\u6cd5\u4e86\u3002\u6709\u70b9\u5c0f\u7ec6\u8282\u3002",
        "postTime": 1682862864,
        "uid": 172020,
        "name": "Kevin090228",
        "ccfLevel": 8,
        "title": "JOISC2020 \u9996\u90fd"
    },
    {
        "content": "### [\u3010JOISC2020\u3011\u9996\u90fd](https://www.luogu.com.cn/problem/P7215)\n\n\u4ee4\u4e00\u4e2a\u70b9\u7684\u201c\u989c\u8272\u201d\u4e3a\u521d\u59cb\u65f6\u6240\u5c5e\u57ce\u5e02\u7f16\u53f7\u3002\n\n\u82e5\u6700\u7ec8\u9009\u62e9\u7684\u9996\u90fd\u5305\u542b\u989c\u8272\u4e3a $x$ \u7684\u8282\u70b9\uff0c\u5219\u4e00\u5b9a\u4f1a\u5305\u542b\u6240\u6709\u989c\u8272\u4e3a $x$ \u7684\u8282\u70b9\u4e2d\u4e24\u4e24\u8def\u5f84\u7684\u5e76\u4e0a\u7684\u8282\u70b9\uff0c\u4e5f\u5c31\u662f\u865a\u6811\u4e0a\u7684\u8282\u70b9\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u627e\u51fa\u82e5\u5e72\u4e2a\u4e8c\u5143\u7ec4 $(x,y)$\uff0c\u5373\u82e5\u5305\u542b\u989c\u8272\u4e3a $x$ \u7684\u8282\u70b9\uff0c\u4e00\u5b9a\u8981\u5305\u542b\u989c\u8272\u4e3a $y$ \u7684\u8282\u70b9\u3002\u5bf9\u4e8e\u6bcf\u4e2a $x$\uff0c\u5c06\u6240\u6709\u989c\u8272\u4e3a $x$ \u7684\u8282\u70b9\u5efa\u865a\u6811\uff0c\u5e76\u7528\u6811\u94fe\u5256\u5206\u62c6\u6210 $O(m \\log m)$ \u4e2a\u533a\u95f4\uff08$m$ \u662f\u989c\u8272\u4e3a $x$ \u7684\u8282\u70b9\u4e2a\u6570\uff09\uff0c\u8fd9\u4e9b\u533a\u95f4\u5185\u7684\u989c\u8272\u5c31\u662f\u5bf9\u5e94\u7684 $y$\uff0c\u5c06\u989c\u8272 $x$ \u5411\u8fd9\u4e9b $y$ \u8fde\u8fb9\uff0c\u5efa\u7acb\u65b0\u56fe $G'$\uff0c\u7528 ST \u8868\u4f18\u5316\u3002\n\n\u4ee4 $cnt(i)$ \u8868\u793a\u8282\u70b9 $i$ \u5728\u65b0\u56fe $G'$ \u4e2d\u80fd\u8d70\u5230\u7684\u8282\u70b9\u4e2a\u6570\uff0c\u95ee\u9898\u7b54\u6848\u5373\u4e3a $\\min\\{cnt(i)\\}-1$\uff0c\u5148\u5f3a\u8054\u901a\u7f29\u70b9\uff0c\u7b54\u6848\u4e00\u5b9a\u5728\u6ca1\u6709\u51fa\u5ea6\u7684\u82e5\u5e72\u8282\u70b9\u4e2d\u4ea7\u751f\u3002\n\n\u590d\u6742\u5ea6 $O(n \\log n)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define fi first\n#define se second\n#define pii pair<int,int>\n#define mp make_pair\n#define pb push_back\nconst int mod=998244353;\nconst int inf=0x3f3f3f3f;\nchar buf[1<<23],*p1=buf,*p2=buf,obuf[1<<23],*O=obuf;\n#define getchar() (p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\ninline int read() {\n\tint x=0,f=1;char ch=getchar();\n\twhile(!isdigit(ch)){if(ch=='-') f=-1;ch=getchar();}\n\twhile(isdigit(ch)) x=x*10+(ch^48),ch=getchar();\n\treturn x*f;\n}\nvoid print(long long x) {\n    if(x>9) print(x/10);\n    *O++=x%10+'0';\n}\nint to[400005];\nint eL[200005],eR[200005],deg[200005],eP[200005];\nstruct LCA\n{\n\tint dep[200005],dfn[200005],times;\n\tint st[20][400005],Lg[400005],Fa[200005];\n\tvoid dfs(int u,int fa)\n\t{\n\t\tFa[u]=fa;\n\t\tdfn[u]=++times,st[0][times]=u;\n\t\tfor(int i=eL[u];i<=eR[u];i++)\n\t\t{\n\t\t\tint v=to[i];\n\t\t\tif(v==fa) continue;\n\t\t\tdep[v]=dep[u]+1,dfs(v,u);\n\t\t\tst[0][++times]=u;\n\t\t}\n\t}\n\tint mindep(int x,int y)\n\t{\n\t\tif(dep[x]<dep[y]) return x;\n\t\treturn y;\n\t}\n\tvoid build()\n\t{\n\t\ttimes=0,dep[1]=0;\n\t\tdfs(1,-1);\n\t\tLg[1]=0,Lg[2]=1;\n\t\tfor(int i=3;i<=times;i++) Lg[i]=Lg[i/2]+1;\n\t\tfor(int k=1;k<20;k++) for(int i=1;i+(1<<k)-1<=times;i++) \n\t\t\tst[k][i]=mindep(st[k-1][i],st[k-1][i+(1<<(k-1))]);\n\t}\n\tint getlca(int u,int v)\n\t{\n\t\tu=dfn[u],v=dfn[v];\n\t\tif(u>v) swap(u,v);\n\t\tint s=Lg[v-u+1];\n\t\treturn mindep(st[s][u],st[s][v-(1<<s)+1]);\n\t}\n}Lca;\nint a[200005]; \nint dfn[200005],times,sz[200005],son[200005],val[200005],par[200005],dep[200005],top[200005];\nint n,K,uidx;\nvector <int> G[4000005];\nint idx[19][200005],Lg[200005];\nvoid init_graph_st()\n{\n\tuidx=K+1;\n\tfor(int i=1;i<=n;i++) idx[0][i]=val[i];\n\tLg[1]=0,Lg[2]=1;\n\tfor(int i=3;i<=n;i++) Lg[i]=Lg[i/2]+1;\n\tfor(int k=1;k<19;k++) for(int i=1;i+(1<<k)-1<=n;i++)\n\t{\n\t\tidx[k][i]=++uidx;\n\t\tG[idx[k][i]].pb(idx[k-1][i]),G[idx[k][i]].pb(idx[k-1][i+(1<<(k-1))]); \n\t} \n}\nvoid link_graph_st(int u,int L,int R)\n{\n\tint s=Lg[R-L+1];\n\tG[u].pb(idx[s][L]),G[u].pb(idx[s][R-(1<<s)+1]);\n}\nvoid link_HLD(int co,int u,int v)\n{\n\twhile(top[u]!=top[v])\n    {\n        if(dep[top[u]]<dep[top[v]]) swap(u,v);\n        link_graph_st(co,dfn[top[u]],dfn[u]);\n        u=par[top[u]];\n    }\n    if(dep[u]>dep[v]) swap(u,v);\n    link_graph_st(co,dfn[u],dfn[v]);\n}\nvoid dfs0(int u,int fa)\n{\n\tpar[u]=fa,son[u]=0,sz[u]=1;\n\tdep[u]=dep[fa]+1;\n\tint maxx=0;\n\tfor(int i=eL[u];i<=eR[u];i++)\n\t{\n\t\tint v=to[i];\n\t\tif(v==fa) continue;\n\t\tdfs0(v,u);\n\t\tsz[u]+=sz[v];\n\t\tif(sz[v]>maxx) maxx=sz[v],son[u]=v;\n\t}\n}\nvoid dfs1(int u,int fa)\n{\n\ttop[u]=fa,dfn[u]=++times;\n\tval[times]=a[u];\n\tif(son[u]) dfs1(son[u],fa);\n\tfor(int i=eL[u];i<=eR[u];i++)\n\t{\n\t\tint v=to[i];\n\t\tif(v==son[u]||v==par[u]) continue;\n\t\tdfs1(v,v);\n\t}\n}\nvector <int> has[200005];\nbool cmp(int x,int y)\n{\n\treturn dfn[x]<dfn[y];\n}\nint now[400005];\nvoid addedge(int col)\n{\n\tif(has[col].size()<=1)\n\t{\n\t\tputs(\"0\");\n\t\texit(0);\n\t}\n\tsort(has[col].begin(),has[col].end(),cmp);\n\tint len=0;\n\tfor(int i=0;i<has[col].size();i++)\n\t{\n\t\tnow[++len]=has[col][i];\n\t\tif(i) now[++len]=Lca.getlca(has[col][i-1],has[col][i]);\n\t}\n\tsort(now+1,now+len+1,cmp);\n\tlen=unique(now+1,now+len+1)-now-1;\n\tfor(int i=1;i<len;i++)\n\t{\n\t\tint l=Lca.getlca(now[i],now[i+1]);\n\t//\tcout<<\"add-path: \"<<col<<\" \"<<l<<\" \"<<now[i+1]<<endl;\n\t\tlink_HLD(col,l,now[i+1]);\n\t}\n\t//puts(\"ok\");\n}\nint Dfn[4000005],Low[4000005],scccnt,Bl[4000005],Sum[4000005],stk[4000005],Top;\nbool isend[4000005],vis[4000005];\nvoid tarjan(int u)\n{\n\tDfn[u]=Low[u]=++times;\n\tvis[u]=1,stk[++Top]=u;\n\tfor(int i=0;i<G[u].size();i++)\n\t{\n\t\tint v=G[u][i];\n\t\tif(!Dfn[v])\n\t\t{\n\t\t\ttarjan(v);\n\t\t\tLow[u]=min(Low[u],Low[v]);\n\t\t}\n\t\telse if(vis[v]) Low[u]=min(Low[u],Dfn[v]);\n\t}\n\tif(Low[u]==Dfn[u])\n\t{\n\t\tscccnt++;\n\t\twhile(1)\n\t\t{\n\t\t\tint x=stk[Top];\n\t\t\tTop--;\n\t\t\tif(x<=K) Sum[scccnt]++;\n\t\t\tBl[x]=scccnt,vis[x]=0;\n\t\t\tif(x==u) break;\n\t\t}\n\t}\n}\nint tU[200005],tV[200005];\nvoid solve()\n{\n\tn=read(),K=read();\n\tfor(int i=1;i<n;i++)\n\t{\n\t\ttU[i]=read(),tV[i]=read();\n\t\tdeg[tU[i]]++,deg[tV[i]]++;\n\t}\n\tfor(int i=1,j=0;i<=n;i++) eL[i]=eP[i]=j,eR[i]=j+deg[i]-1,j=j+deg[i];\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tto[eP[tU[i]]]=tV[i];\n\t\tto[eP[tV[i]]]=tU[i];\n\t\teP[tU[i]]++,eP[tV[i]]++;\n\t}\n\tfor(int i=1;i<=n;i++) a[i]=read(),has[a[i]].pb(i);\n\tLca.build();\n\tdfs0(1,1),dfs1(1,1);\n\tinit_graph_st();\n\tfor(int i=1;i<=K;i++) addedge(i);//,cout<<i<<endl;\n\tfor(int i=1;i<=uidx;i++) if(!Dfn[i]) tarjan(i);\n\tint ans=K-1;\n\tfor(int i=1;i<=uidx;i++) for(int j=0;j<G[i].size();j++) if(Bl[i]!=Bl[G[i][j]]) isend[Bl[i]]=1;\n\tfor(int i=1;i<=K;i++) if(!isend[Bl[i]]) ans=min(ans,Sum[Bl[i]]-1);\n\tprint(ans);\n\tfwrite(obuf,O-obuf,1,stdout);\n}\nsigned main()\n{\n\tint _=1;\n//\tcin>>_;\n\twhile(_--) solve();\n\treturn 0;\n}\n```\n",
        "postTime": 1682260964,
        "uid": 302837,
        "name": "znstz2018",
        "ccfLevel": 7,
        "title": "\u3010JOISC2020\u3011\u9996\u90fd \u9898\u89e3"
    },
    {
        "content": "\u6a21\u62df\u8d5b\u8d5b\u65f6 AC\uff0c\u5199\u4e00\u53d1\u9898\u89e3\u3002\n\n\u539f\u9898\u57ce\u9547\u57ce\u5e02\u592a\u5bb9\u6613\u6df7\u6dc6\u4e86\uff0c\u6240\u4ee5\u63cf\u8ff0\u6539\u6210 $k$ \u79cd\u989c\u8272\uff0c\u6bcf\u4e2a\u57ce\u9547\u67d3\u4e86\u4e00\u79cd\u3002\n\n\u9996\u5148\u4e0d\u96be\u53d1\u73b0\u5176\u5b9e\u5c31\u662f\u989c\u8272\u4e4b\u95f4\u6709\u4e00\u4e9b\u6709\u5411\u8fb9\uff0c\u6709\u5411\u8fb9 $(a,b)$ \u5b58\u5728\u8868\u793a $a$ \u4e2d\u7684\u57ce\u9547\u60f3\u4e24\u4e24\u4e92\u8fbe\u5fc5\u9700\u8981\u5408\u5e76 $b$\uff0c\u539f\u9898\u7684\u7b54\u6848\u5c31\u662f\u5728\u8fd9\u5e45\u6709\u5411\u56fe\u4e2d\u9009\u51fa\u6700\u5c11\u7684\u70b9\u4f7f\u5f97\u8fd9\u4e9b\u70b9\u6ca1\u6709\u51fa\u8fb9\u8fde\u5411\u5176\u4ed6\u70b9\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u5148 tarjan \u7f29\u70b9\u518d\u4ece\u51fa\u5ea6\u4e3a\u96f6\u7684\u70b9\u4e2d\u9009\u5305\u542b\u6700\u5c11\u989c\u8272\u7684\u70b9\uff0c\u95ee\u9898\u5728\u4e8e\u56fe\u8fb9\u6570\u53ef\u80fd\u8fbe\u5230 $k^2$\uff0c\u6240\u4ee5\u8003\u8651\u4f18\u5316\u5efa\u56fe\u3002\n\n\u8003\u8651\u70b9\u5206\u6cbb\uff0c\u4ee5\u91cd\u5fc3\u4e3a\u6839\u518d\u5bf9\u6811\u4e0a\u6bcf\u4e2a\u70b9\u5efa\u865a\u70b9\uff0c\u6811\u70b9\u5bf9\u5e94\u865a\u70b9\u5411\u7236\u4eb2\u5bf9\u5e94\u7684\u865a\u70b9\u8fde\u6709\u5411\u8fb9\uff0c\u6811\u70b9\u5bf9\u5e94\u7684\u865a\u70b9\u518d\u5411\u6811\u70b9\u5bf9\u5e94\u7684\u989c\u8272\u8fde\u6709\u5411\u8fb9\uff0c\u6700\u540e\u5982\u679c\u8fd9\u79cd\u989c\u8272\u540c\u65f6\u5b58\u5728\u4e0e\u91cd\u5fc3\u4e24\u4fa7\u90a3\u4e48\u8fd9\u79cd\u989c\u8272\u5411\u6811\u4e0a\u6240\u6709\u989c\u8272\u662f\u8fd9\u79cd\u989c\u8272\u7684\u6811\u70b9\u5bf9\u5e94\u7684\u865a\u70b9\u8fde\u6709\u5411\u8fb9\uff0c\u5728\u9012\u5f52\u5230\u5b50\u6811\u505a\u3002\n\n\u8fd9\u6837\u8fb9\u6570\u5c31\u662f $n \\log n$ \u7684\u4e86\uff0c\u603b\u590d\u6742\u5ea6 $O(n \\log n)$\uff0c\u5b9e\u73b0\u6709\u4e9b\u7ec6\u8282\u53ef\u4ee5\u770b\u4ee3\u7801\uff08\u6bd4\u5982\u600e\u4e48\u7ef4\u62a4\u989c\u8272\u662f\u4e0d\u662f\u540c\u65f6\u5b58\u5728\u91cd\u5fc3\u4e24\u4fa7\uff09\uff0c\u6a21\u62df\u8d5b\u65f6\u8fd9\u9898\u65f6\u9650\u662f $0.5s$\uff0c\u6240\u4ee5\u4ee3\u7801\u52a0\u4e86\u5361\u5e38\u628a dfs \u6362\u6210\u4e86 bfs\u3002\n\n\u4ee3\u7801\uff08\u81ed\u957f\uff09\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N = 200005;\nconst int V = N * 20;\nstruct Edge{\n\tint nxt,to;\n}e[V * 3];\nint head[V],cnt;\nvoid add(int x,int y){\n\te[++cnt].to = y;\n\te[cnt].nxt = head[x];\n\thead[x] = cnt;\n}\nstack<int>s;\nint tot1,dfn[V],low[V],v1[V],fa[V],scc,num[V],v2[V];\nint n,k,tot,c[N],v[N];\nvoid tarjan(int x){\n\ts.push(x);\n\tv1[x] = 1;\n\tdfn[x] = low[x] = ++tot1;\n\tfor(int i = head[x];i;i = e[i].nxt){\n\t\tint to = e[i].to;\n\t\tif(!dfn[to]){\n\t\t\ttarjan(to);\n\t\t\tlow[x] = min(low[x],low[to]);\n\t\t} else if(v1[to]) low[x] = min(low[x],dfn[to]);\n\t\t//else low[x] = min(low[x],dfn[to]);\n\t}\n\tif(dfn[x] == low[x]){\n\t\tint y;\n\t\t++scc;\n\t\tdo{\n\t\t\ty = s.top();\n\t\t\ts.pop();\n\t\t\tv1[y] = 0;\n\t\t\tfa[y] = scc;\n\t\t\tif(y <= k) ++num[scc];\n\t\t}while(y != x);\n\t}\n}\nvector<int>w[N];\nint siz[N],id[N];\ntypedef pair<int,int> pr;\nstruct mque{\n\tint tou = 1,wei = 0;\n\tpr a[N];\n\tvoid push(pr x){a[++wei] = x;}\n\tvoid pop(){++tou;}\n\tpr front(){return a[tou];}\n\tbool empty(){return tou > wei;}\t\n\tvoid clear(){tou = 1,wei = 0;}\n}q;\nvoid build(int x,int fa){\n\tsiz[x] = 1;\n\tfor(int to:w[x]){\n\t\tif(to == fa || v[to]) continue;\n\t\tbuild(to,x);\n\t\tsiz[x] += siz[to];\n\t}\n}\nint dfsz(int x,int sum){\n\tq.clear();\n\tq.push({x,0});\n\twhile(!q.empty()){\n\t\tpr tmp = q.front();\n\t\tq.pop();\n\t\tint x = tmp.first;\n\t\tint flag = (sum - siz[x] <= sum / 2);\n\t\tfor(int to:w[x]){\n\t\t\tif(to == tmp.second || v[to]) continue;\n\t\t\tif(siz[to] > sum / 2) flag = 0;\n\t\t\tq.push({to,x});\n\t\t}\n\t\tif(flag) return x;\n\t}\n//\tint flag = (sum - siz[x] <= sum / 2);\n//\tfor(int to:w[x]){\n//\t\tif(to == fa || v[to]) continue;\n//\t\tif(siz[to] > sum / 2) flag = 0;\n//\t\tint tmp = dfsz(to,x,sum);\n//\t\tif(tmp != -1) return tmp;\n//\t}\n//\tif(flag) return x;\n//\telse return -1;\n}\nint findz(int x){\n\tbuild(x,0);\n\tif(siz[x] == 1) return -1;\n\treturn dfsz(x,siz[x]);\n}\nint o[N],cnt1;\nvoid build1(int x){\n\tq.clear();\n\tq.push({x,0});\n\twhile(!q.empty()){\n\t\tpr tmp = q.front();\n\t\tq.pop();\n\t\tint x = tmp.first;\n\t\tid[x] = ++tot;\n\t\tadd(id[x],c[x]);\n\t\to[++cnt1] = c[x];\n\t\tif(tmp.second) add(id[x],id[tmp.second]);\n\t\tfor(int to:w[x]){\n\t\t\tif(to == tmp.second || v[to]) continue;\n\t\t\tq.push({to,x});\n\t\t}\n\t}\n//\tid[x] = ++tot;\n//\tadd(id[x],c[x]);\n//\to.push_back(c[x]);\n//\tfor(int to:w[x]){\n//\t\tif(to == fa || v[to]) continue;\n//\t\tbuild1(to,x);\n//\t\tadd(id[to],id[x]);\n//\t}\n}\nint t[N],_t[N],fi[N],ed[N];\nvoid count(int x){\n\tq.clear();\n\tq.push({x,0});\n\twhile(!q.empty()){\n\t\tpr tmp = q.front();\n\t\tq.pop();\n\t\tint x = tmp.first;\n\t\t++t[c[x]];\n\t\tfor(int to:w[x]){\n\t\t\tif(to == tmp.second || v[to]) continue;\n\t\t\tq.push({to,x});\n\t\t}\n\t}\n//\t++t[c[x]];\n//\tfor(int to:w[x]){\n//\t\tif(to == fa || v[to]) continue;\n//\t\tcount(to,x);\n//\t}\n}\nvoid count1(int x,int fa,int now){\n\tq.clear();\n\tq.push({x,0});\n\twhile(!q.empty()){\n\t\tpr tmp = q.front();\n\t\tq.pop();\n\t\tint x = tmp.first;\n\t\tif(_t[c[x]] == 0) fi[c[x]] = now;\n\t\t++_t[c[x]];\n\t\tif(_t[c[x]] == t[c[x]]) ed[c[x]] = now;\n\t\tfor(int to:w[x]){\n\t\t\tif(to == tmp.second || v[to] || to == fa) continue;\n\t\t\tq.push({to,x});\n\t\t}\n\t}\n//\tif(_t[c[x]] == 0) fi[c[x]] = now;\n//\t++_t[c[x]];\n//\tif(_t[c[x]] == t[c[x]]) ed[c[x]] = now;\n//\tfor(int to:w[x]){\n//\t\tif(to == fa || v[to]) continue;\n//\t\tcount1(to,x,now);\n//\t}\n}\nvoid dfs(int x){\n\tq.clear();\n\tq.push({x,0});\n\twhile(!q.empty()){\n\t\tpr tmp = q.front();\n\t\tq.pop();\n\t\tint x = tmp.first;\n\t\tif(fi[c[x]] != ed[c[x]]) add(c[x],id[x]);\n\t\tfor(int to:w[x]){\n\t\t\tif(to == tmp.second || v[to]) continue;\n\t\t\tq.push({to,x});\n\t\t}\n\t}\n//\tif(fi[c[x]] != ed[c[x]]) add(c[x],id[x]);\n//\tfor(int to:w[x]){\n//\t\tif(to == fa || v[to]) continue;\n//\t\tdfs(to,x);\n//\t}\n}\nvoid work(int x){\n\tcnt1 = 0;\n\tbuild1(x);\n\tfor(int i = 1;i <= cnt1;++i) t[o[i]] = _t[o[i]] = fi[o[i]] = ed[o[i]] = 0;\n\tcount(x);\n\tint tmp = 0;\n\tfor(int to:w[x]){\n\t\tif(v[to]) continue;\n\t\t++tmp;\n\t\tcount1(to,x,tmp);\n\t}\n\tdfs(x);\n}\nvoid df(int x){\n\t\n\tint root = findz(x);\n\tif(root == -1) return;\n\t//printf(\"k %d %d\\n\",x,root);\n\twork(root);\n\tv[root] = 1;\n\tfor(int to:w[root]) if(!v[to]) df(to);\n}\nnamespace INPUT_SPACE{\n\tconst int S=(1<<20)+5;char B[S],*H,*T;inline int gc() { if(H==T) T=(H=B)+fread(B,1,S,stdin);return (H==T)?EOF:*H++; }\n\tinline int inn() { int x = 0,f = 1,ch;while((ch=gc())<'0'||ch>'9') if(ch == '-') f = -1;x=ch^'0';while((ch=gc())>='0'&&ch<='9') x=x*10+(ch^'0');return x * f; }\n}using INPUT_SPACE::inn;\nint main(){\n\tfreopen(\"kingdom.in\",\"r\",stdin);\n\tfreopen(\"kingdom.out\",\"w\",stdout);\n\tn = inn(),k = inn();\n\ttot = k;\n\tfor(int i = 1,x,y;i < n;++i){\n\t\tx = inn(),y = inn();\n\t\tw[x].push_back(y);\n\t\tw[y].push_back(x);\n\t}\n\tfor(int i = 1;i <= n;++i) c[i] = inn();\n\tdf(1);\n\tfor(int i = 1;i <= tot;++i) if(!dfn[i]) tarjan(i);\n\tfor(int i = 1;i <= tot;++i){\n\t\tfor(int j = head[i];j;j = e[j].nxt){\n\t\t\tint to = e[j].to;\n\t\t\tif(fa[i] != fa[to]) v2[fa[i]] = 1;\n\t\t} \n\t}\n\tint ans = 1e9;\n\tfor(int i = 1;i <= scc;++i) if(!v2[i]) ans = min(ans,num[i]);\n\tprintf(\"%d\\n\",ans - 1);\n\treturn 0;\n}\n/*\n6 3\n2 1\n3 5\n6 2\n3 4\n2 3\n1\n3\n1\n2\n3\n2\n*/\n```\n",
        "postTime": 1682251452,
        "uid": 239433,
        "name": "WZKQWQ",
        "ccfLevel": 7,
        "title": "P7215 \u3010[JOISC2020] \u9996\u90fd\u3011\u9898\u89e3"
    },
    {
        "content": "\u6211\u6821\u6a21\u62df\u8d5b\u4e00\u573a\u642c\u4e86\u8fd9\u4e2a\u9898\uff0c\u975e\u5e38\u9ad8\u5174\u8d5b\u65f6\u8fc7\u4e86\u3002\n\n\u975e\u5e38\u4f18\u7f8e\u7684\u70b9\u5206\u6cbb\u505a\u6cd5\u3002\n\n\u5148\u60f3\u4e2a\u66b4\u529b\uff0c\u6211\u4eec\u679a\u4e3e\u6bcf\u4e2a\u70b9\uff0c\u7edf\u8ba1\u5305\u542b\u6bcf\u4e2a\u70b9 $u$ \u7684\u989c\u8272\u6570\u91cf\u6700\u5c11\u7684\u8fde\u901a\u5757\u3002\u4e00\u4e2a\u5f88\u6734\u7d20\u7684\u505a\u6cd5\u5c31\u662f\u4ee5\u8fd9\u4e2a\u70b9\u4e3a\u6839\u641c\u4e00\u6b21\uff0c\u5efa\u7acb\u4e00\u4e2a\u989c\u8272\u961f\u5217\uff0c\u9996\u5148\u628a\u8be5\u70b9\u7684\u989c\u8272\u5165\u961f\uff0c\u6bcf\u6b21\u5f39\u51fa\u4e00\u4e2a\u989c\u8272\uff0c\u628a\u6240\u6709\u662f\u8fd9\u4e2a\u989c\u8272\u7684\u70b9\u904d\u5386\u4e00\u6b21\uff0c\u6bcf\u6b21\u4ece\u8fd9\u4e2a\u70b9\u5f80\u7236\u4eb2\u8df3\uff0c\u5982\u679c\u51fa\u73b0\u65b0\u989c\u8272\u5c31\u628a\u5b83\u5165\u961f\uff0c\u5982\u679c\u51fa\u73b0\u5df2\u7ecf\u904d\u5386\u8fc7\u7684\u70b9\u8bf4\u660e\u5b83\u7f51\u4e0a\u7684\u70b9\u90fd\u904d\u5386\u8fc7\u4e86\uff0c\u5c31\u76f4\u63a5\u8df3\u3002\n\n\u5206\u6790\u590d\u6742\u5ea6\u6bcf\u6b21\u662f $O(n)$ \u7684\uff0c\u603b\u65f6\u95f4\u662f $O(n^2)$ \u7684\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u653e\u5230\u70b9\u5206\u6cbb\u4e0a\u7ef4\u62a4\u8fd9\u4e2a\u64cd\u4f5c\uff0c\u6bcf\u6b21\u4ee5\u5f53\u524d\u5206\u6cbb\u4e2d\u5fc3\u4e3a\u679a\u4e3e\u7684\u70b9\uff0c\u4e0d\u8fc7\u5982\u679c\u5728\u679a\u4e3e\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u5f53\u524d\u8fde\u901a\u5757\u5916\u7684\u70b9\u5c31\u76f4\u63a5\u7ed3\u675f\uff0c\u56e0\u4e3a\u5982\u679c\u7ecf\u8fc7\u5916\u9762\u7684\u70b9\uff0c\u90a3\u4e48\u76f8\u5f53\u4e8e\u7ecf\u8fc7\u4e86\u67d0\u4e00\u7ea7\u5206\u6cbb\u7956\u5148\uff0c\u90a3\u4e48\u90a3\u7ea7\u7684\u989c\u8272\u961f\u5217\u4e00\u5b9a\u4f1a\u88ab\u5f53\u524d\u7684\u904d\u5386\u5305\u542b\uff0c\u8981\u4e48\u76f8\u540c\uff0c\u8981\u4e48\u66f4\u52a3\uff0c\u6240\u4ee5\u76f4\u63a5\u4e0d\u7528\u8003\u8651\u3002\n\n\u53d1\u73b0\u6bcf\u4e00\u6b21\u7edf\u8ba1\u7b54\u6848\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u6700\u52a3\u662f $O(\u70b9\u6570)$ \u7684\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n\u7edf\u8ba1\u7b54\u6848\u90e8\u5206\u7684\u4ee3\u7801\uff1a\n\n```cpp\nvoid get_ans(int u){\n\tif(!c[u])return;\n\tdep[u]=1,fa[u]=0;\n\tget_fa(u,u);\n\tst[tp=1]=c[u],vic[c[u]]=u;\n\tfor(int k=1;k<=tp;k++){\n//\t\tprintf(\"Col:%d\\n\",st[k]);\n\t\tfor(int i=0;i<g[st[k]].size();i++){\n\t\t\tint v=g[st[k]][i];\n\t\t\tif(Vis[v]!=u)return;\n\t\t\twhile(dep[v]){\n\t\t\t\tif(!c[v])return;\n\t\t\t\tif(vic[c[v]]!=u)vic[c[v]]=u,st[++tp]=c[v];\n//\t\t\t\tprintf(\"Find:%d\\n\",v);\n\t\t\t\tdep[v]=0,v=fa[v];\n\t\t\t}\n\t\t}\n\t}\n\tans=min(ans,tp-1);\n//\tprintf(\"%d\\n\",tp-1);\n}\n```\n",
        "postTime": 1663915582,
        "uid": 310802,
        "name": "_Diu_",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P7215 [JOISC2020] \u9996\u90fd"
    }
]
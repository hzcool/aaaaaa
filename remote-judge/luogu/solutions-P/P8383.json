[
    {
        "content": "> [P8383 [POI2004] Bra](https://www.luogu.com.cn/problem/P8383)\n\n\u633a\u8da3\u5473\u7684\u4e00\u9053\u9898\u3002\n\n\u6ce8\u610f\u5230\u4e00\u4e2a\u95e8\u8f93\u5165\u7684 $0$ \u7684\u4e2a\u6570\u8d8a\u591a\uff0c\u5c31\u8d8a\u53ef\u80fd\u8f93\u51fa $0$\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u8f93\u5165\u7684\u6570\u8d8a\u5c0f\uff0c\u8f93\u51fa\u7684\u6570\u8d8a\u5c0f\u3002\u8fd9\u7ed9\u4e88\u6211\u4eec\u4e00\u4e2a\u91cd\u8981\u6027\u8d28\uff1a\u6240\u6709\u95e8\u7684\u6700\u5c0f\u8f93\u51fa\u503c\u5fc5\u7136\u5728\u540c\u4e00\u4e2a\u7535\u8def\u4e2d\u53d6\u5230\u3002\u56e0\u4e3a\u964d\u4f4e\u4e00\u4e2a\u95e8\u7684\u8f93\u51fa\u503c\u4e0d\u4f1a\u4f7f\u5f97\u522b\u7684\u95e8\u7684\u8f93\u51fa\u503c\u53d8\u5927\u3002\n\n\u56e0\u6b64\uff0c\u9996\u5148\u5047\u8bbe\u6240\u6709\u95e8\u7684\u8f93\u51fa\u5747\u4e3a $0$\uff0c\u518d\u8d2a\u5fc3\u8c03\u6574\u3002\u6bcf\u6b21\u8c03\u6574\u90fd\u662f\u5fc5\u8981\u7684\uff0c\u53ef\u4ee5\u901a\u8fc7\u7b2c\u4e00\u6b21\u8c03\u6574\u662f\u5fc5\u8981\u7684\u8fdb\u884c\u5f52\u7eb3\u8bc1\u660e\u3002\u6700\u7ec8\u8fbe\u5230\u7a33\u5b9a\u6001\u65f6\u6bcf\u4e2a\u4eec\u7684\u72b6\u6001\u5373\u6700\u5c0f\u8f93\u51fa\u503c\u3002\n\n\u540c\u7406\uff0c\u5047\u8bbe\u6240\u6709\u95e8\u7684\u8f93\u51fa\u5747\u4e3a $1$\uff0c\u8d2a\u5fc3\u8c03\u6574\u5f97\u5230\u6bcf\u4e2a\u4eec\u7684\u6700\u5927\u8f93\u51fa\u503c\u3002\u82e5\u6700\u5927\u8f93\u51fa\u503c\u548c\u6700\u5c0f\u8f93\u51fa\u503c\u4e0d\u7b49\uff0c\u5219\u8f93\u51fa\u4e0d\u786e\u5b9a\uff0c\u5426\u5219\u786e\u5b9a\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u7ebf\u6027\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#include <ext/pb_ds/assoc_container.hpp>\nusing namespace std;\nusing namespace __gnu_pbds;\n#define fi first\n#define se second\n#define TIME 1e3 * clock() / CLOCKS_PER_SEC\nusing ll = long long;\nusing pii = pair<int, int>;\nusing pll = pair<ll, ll>;\ninline int read() {\n  int x = 0;\n  char s = getchar();\n  while(!isdigit(s)) s = getchar();\n  while(isdigit(s)) x = x * 10 + s - '0', s = getchar();\n  return x;\n}\ninline void print(int x) {\n  if(x < 0) return putchar('-'), print(-x);\n  if(x >= 10) print(x / 10);\n  putchar(x % 10 + '0');\n}\nbool Mbe;\nconstexpr int N = 1e4 + 5;\nint n, m, st[N], cnt0[N], cnt1[N], mn[N], mx[N];\nvector<int> e[N], rev[N];\nvoid fix(int x, int v) {\n  if(st[x] != 2) for(int it : e[x]) st[x] ? cnt1[it]-- : cnt0[it]--;\n  st[x] = v;\n  if(st[x] != 2) for(int it : e[x]) st[x] ? cnt1[it]++ : cnt0[it]++;\n}\nvoid solve1() {\n  for(int i = 0; i < n; i++) st[i] = 2;\n  for(int i = 0; i < n; i++) fix(i, i == 1);\n  queue<pii> q;\n  auto check = [&](int id) {\n    if(cnt0[id] == cnt1[id] && st[id] != 2) q.push({id, 2});\n    if(cnt0[id] < cnt1[id] && st[id] != 1) q.push({id, 1});\n  };\n  for(int i = 2; i < n; i++) check(i);\n  while(!q.empty()) {\n    pii t = q.front();\n    q.pop(), fix(t.first, t.second);\n    for(int it : e[t.first]) check(it);\n  }\n}\nvoid solve2() {\n  for(int i = 0; i < n; i++) fix(i, i != 0);\n  queue<pii> q;\n  auto check = [&](int id) {\n    if(cnt0[id] == cnt1[id] && st[id] != 2) q.push({id, 2});\n    if(cnt0[id] > cnt1[id] && st[id] != 0) q.push({id, 0});\n  };\n  for(int i = 2; i < n; i++) check(i);\n  while(!q.empty()) {\n    pii t = q.front();\n    q.pop(), fix(t.first, t.second);\n    for(int it : e[t.first]) check(it);\n  }\n}\nbool Med;\nint main() {\n  fprintf(stderr, \"%.3lf MB\\n\", (&Mbe - &Med) / 1048576.0);\n  #ifdef ALEX_WEI\n    FILE* IN = freopen(\"1.in\", \"r\", stdin);\n    FILE* OUT = freopen(\"1.out\", \"w\", stdout);\n  #endif\n  cin >> n;\n  for(int i = 2; i < n; i++) {\n    int k = read(), x;\n    while(k--) e[x = read()].push_back(i), rev[i].push_back(x);\n  }\n  solve1(), memcpy(mn, st, sizeof(mn));\n  solve2(), memcpy(mx, st, sizeof(mx));\n  for(int i = 0; i < n; i++) {\n    if(mn[i] == mx[i]) cout << (mn[i] == 0 ? \"0\\n\" : mn[i] == 1 ? \"1\\n\" : \"1/2\\n\");\n    else cout << \"?\\n\";\n  }\n  cerr << TIME << \" ms\\n\";\n  return 0;\n}\n/*\n2022/9/13\nauthor: Alex_Wei\nstart coding at\nfinish debugging at\n*/\n```",
        "postTime": 1664935396,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "P8383 [POI2004] Bra"
    },
    {
        "content": "[\u53ef\u80fd\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/JCY-std/p/16688615.html)\n### \u9898\u76ee\u5927\u610f\n\u7ed9\u4f60\u4e00\u4e2a $n$ \u4e2a\u70b9 $m$ \u6761\u8fb9\u7684\u6709\u5411\u56fe\uff0c\u4ece $0$ \u5f00\u59cb\u6807\u53f7\uff0c\u6709\u91cd\u8fb9\uff0c\u6709\u81ea\u73af\uff08$n\\leq 10^4,m\\leq 2\\times 10^5$\uff09\uff0c\u6bcf\u4e2a\u70b9\u6709\u4e09\u79cd\u72b6\u6001 $0,\\frac{1}{2},1$\u3002\n\n\u8003\u5bdf\u70b9 $u$\uff0c\u8bbe\u5728\u5176\u6240\u6709\u524d\u9a71 $v$ \u4e2d\uff0c\u6709 $c_0$ \u4e2a\u70b9\u72b6\u6001\u4e3a $0$\uff0c$c_1$ \u4e2a\u70b9\u72b6\u6001\u4e3a $1$\uff0c$c_2$ \u4e2a\u70b9\u72b6\u6001\u4e3a $\\frac{1}{2}$\u3002\u82e5 $c_0>c_1$ \u5219\u70b9 $u$ \u72b6\u6001\u4e3a $0$\uff0c\u82e5 $c_0<c_1$ \u5219\u70b9 $u$ \u72b6\u6001\u4e3a $1$\uff0c\u5426\u5219\u70b9 $u$ \u72b6\u6001\u4e3a $\\frac{1}{2}$\u3002\n\n\u73b0\u5df2\u77e5\u70b9 $0$ \u7684\u72b6\u6001\u4e3a $0$\uff0c\u70b9 $1$ \u7684\u72b6\u6001\u4e3a $1$\uff0c\u4e14\u8fd9\u4e24\u4e2a\u70b9\u5165\u5ea6\u5747\u4e3a $0$\u3002\u6c42\u5728\u6240\u6709\u7b26\u5408\u4e0a\u8ff0\u89c4\u5219\u7684\u72b6\u6001\u5206\u914d\u4e2d\uff0c\u72b6\u6001\u5747\u76f8\u540c\u7684\u70b9\u7684\u6807\u53f7\uff0c\u4ee5\u53ca\u5b83\u4eec\u7684\u72b6\u6001\u3002\n### \u5206\u6790\n\u4e00\u773c\u770b\u4e0a\u53bb\u76f4\u63a5\u505a\u6709\u4e9b\u56f0\u96be\uff0c\u4e0d\u59a8\u8003\u8651\u6c42\u51fa\u6bcf\u4e2a\u70b9\u72b6\u6001\u5927\u5c0f\u7684\u4e0a\u754c\u548c\u4e0b\u754c\uff0c\u82e5\u4e0a\u4e0b\u754c\u76f8\u540c\u5219\u8bf4\u660e\u5176\u4e3a\u6240\u6c42\u70b9\u3002\u4e0a\u4e0b\u754c\u6c42\u6cd5\u7406\u5e94\u76f8\u540c\uff0c\u6240\u4ee5\u53ea\u8003\u8651\u5982\u4f55\u6c42\u51fa\u4e0b\u754c\u3002\n\n\u5148\u5c06\u70b9 $1$ \u7684\u72b6\u6001\u8d4b\u4e3a $1$\uff0c\u5176\u5b83\u70b9\u8d4b\u4e3a $0$\u3002\u5c06\u70b9 $1$ \u5165\u961f\uff0c\u7136\u540e\u5f00\u59cb\u8fdb\u884c\u7c7b\u4f3c BFS \u7684\u8c03\u6574\uff1a\u53d6\u51fa\u961f\u9996 $u$\uff0c\u904d\u5386\u5176\u6240\u6709\u540e\u7ee7 $v$\uff0c\u82e5\u6b64\u65f6 $v$ \u7684\u72b6\u6001\u4e0d\u7b26\u5408\u89c4\u5219\uff0c\u5219\u4fee\u6539 $v$ \u7684\u72b6\u6001\u5e76\u5c06\u5176\u5165\u961f\u3002\n\n\u6b63\u786e\u6027\u53ef\u4ee5\u611f\u6027\u7406\u89e3\uff0c\u56e0\u4e3a\u6bcf\u6b21\u8c03\u6574\u90fd\u662f\u5fc5\u987b\u7684\u3002\n\n\u8003\u8651\u5206\u6790\u8fd9\u4e00\u8fc7\u7a0b\u7684\u590d\u6742\u5ea6\uff0c\u4e0d\u96be\u53d1\u73b0\u6bcf\u4e2a\u70b9\u5165\u961f\u65f6\u72b6\u6001\u5927\u5c0f\u5fc5\u7136\u53d8\u5927\uff0c\u56e0\u6b64\u6bcf\u4e2a\u70b9\u5165\u961f\u4e0d\u8d85\u8fc7 $2$ \u6b21\uff0c\u590d\u6742\u5ea6\u4e3a $O(m)$\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u7ec6\u8282\u89c1\u4ee3\u7801\u3002\n### \u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int MAXN = 1e4 + 10;\nint n, in[MAXN], c[MAXN][3], val0[MAXN], val1[MAXN], hd, tl, qu[MAXN * 2];\nvector<int> g[MAXN];\ninline int calc(int x) {\n    if (c[x][0] > c[x][1]) return 0;\n    if (c[x][1] > c[x][0]) return 1;\n    return 2;\n}\nint main() {\n    ios::sync_with_stdio(false);\n    cin.tie(nullptr);\n    cin >> n;\n    for (int i = 2; i < n; ++i) {\n        cin >> in[i];\n        for (int j = 0, x; j < in[i]; ++j) {\n            cin >> x;\n            g[x].emplace_back(i);\n        }\n    }\n    for (int i = 0; i < n; ++i) c[i][0] = in[i];\n    val0[1] = 1;\n    for (auto v : g[1]) --c[v][0], ++c[v][1];\n    qu[hd = tl = 1] = 1;\n    while (hd <= tl) {\n        int u = qu[hd++];\n        for (auto v : g[u]) {\n            int t = calc(v);\n            if (val0[v] != t) {\n                for (auto w : g[v]) {\n                    --c[w][val0[v]];\n                    ++c[w][t];\n                }\n                qu[++tl] = v;\n                val0[v] = t;\n            }\n        }\n    }\n    for (int i = 0; i < n; ++i) {\n        c[i][1] = in[i];\n        c[i][0] = c[i][2] = 0;\n    }\n    fill(val1 + 1, val1 + n, 1);\n    val1[0] = 0;\n    for (auto v : g[0]) --c[v][1], ++c[v][0];\n    qu[hd = tl = 1] = 0;\n    while (hd <= tl) {\n        int u = qu[hd++];\n        for (auto v : g[u]) {\n            int t = calc(v);\n            if (val1[v] != t) {\n                for (auto w : g[v]) {\n                    --c[w][val1[v]];\n                    ++c[w][t];\n                }\n                qu[++tl] = v;\n                val1[v] = t;\n            }\n        }\n    }\n    for (int i = 0; i < n; ++i) {\n        if (val0[i] == val1[i]) {\n            if (val0[i] == 2) {\n                cout << \"1/2\";\n            } else {\n                cout << val0[i];\n            }\n        } else {\n            cout << '?';\n        }\n        cout << '\\n';\n    }\n    return 0;\n}",
        "postTime": 1663040245,
        "uid": 141572,
        "name": "JCY_",
        "ccfLevel": 7,
        "title": "[P8383] [BZOJ2070] [POI2004] Bra"
    }
]
[
    {
        "content": "\u597d\u50cf\u611f\u89c9\u6211\u7684\u505a\u6cd5\u548c\u5176\u4ed6\u4eba\u90fd\u4e0d\u4e00\u6837\uff0c\u5199\u4e00\u4e0b\u3002\n\n----\n\n\u6bcf\u6761\u8fb9\u6709\u4e2a\u88ab\u5220\u9664\u7684\u65f6\u95f4\uff0c\u90a3\u4e48\u4e00\u6761\u8def\u5f84\u53ea\u8981\u8003\u8651\u8fd9\u4e2a\u65f6\u95f4\u6700\u5c0f\u7684\u8fb9\u3002\n\n\u8003\u8651 meet-in-middle\uff0c\u90a3\u4e48\u8f6c\u5316\u6210 $k=4$\uff0c\u7136\u540e\u4ece $1$ \u5230\u8fbe\u4efb\u610f\u4e00\u4e2a\u70b9 $x$\uff0c\u7136\u540e\u6700\u5c0f\u65f6\u95f4\u4e3a $t$ \u7684\u7b54\u6848\uff08\u5230 $n$ \u7684\u540c\u7406\uff0c\u8fd9\u6837\u521a\u597d $\\mathcal{O}(n^3)$ \u4e2a\u8981\u6c42\u7684\u4e1c\u897f\uff09\u3002\n\n\u7136\u540e\u518d\u679a\u4e3e\u4e00\u904d\u4e2d\u95f4\u7684\u8fd9\u4e2a\u70b9 $y$\uff0c\u7136\u540e\u53d8\u6210 $1\\to y,y\\to x$ \u5e76\u4e14\u5404\u7ecf\u8fc7\u4e24\u6761\u8fb9\u7684\u60c5\u51b5\u3002\u8fd9\u4e2a\u65f6\u5019 $1\\to y$ \u53ea\u6709 $\\mathcal{O}(n)$ \u79cd\u65b9\u6848\uff0c$y \\to x$ \u4e5f\u53ea\u6709 $\\mathcal{O}(n)$ \u79cd\u65b9\u6848\u3002\u800c\u4e14\u6211\u4eec\u53ea\u6ce8\u610f\u6700\u5c0f\u503c\uff0c\u6700\u5c0f\u503c\u4e5f\u53ea\u6709 $\\mathcal{O}(n)$ \u79cd\uff0c\u90a3\u4e48\u628a\u8fd9 $\\mathcal{O}(n)$ \u79cd\u65b9\u6848\u5168\u90e8\u9884\u5904\u7406\u51fa\u6765\u7136\u540e\u6392\u5e8f\uff0c\u53cc\u6307\u9488\u5373\u53ef\u3002\n\n\u89c4\u907f\u6392\u5e8f\u7684 $\\log$ \u53ef\u4ee5\u57fa\u6392\uff0c\u6216\u8005\u9884\u5904\u7406\u4e00\u4e9b\u4e1c\u897f\uff0c\u53cd\u6b63\u90fd\u662f\u5f88\u5e73\u51e1\u7684\u4e1c\u897f\u3002\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n^3)$\u3002\u4e0d\u8fc7\u5199\u51fa\u6765\u5e38\u6570\u5f88\u5927\u3002[\u4ee3\u7801\u5b9e\u73b0](https://www.luogu.com.cn/paste/vqkb6n7l)\u3002",
        "postTime": 1672110683,
        "uid": 141179,
        "name": "pigstd",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P8906"
    },
    {
        "content": "\n# Part 1\uff1a\u524d\u8a00\n\u795e\u5947\u7684\u6298\u534a\uff0cBenQ \u7684\u795e\u4ed9\u9898/bx\uff08\u867d\u7136\u662f\u86ee\u5957\u8def\u7684\uff09\u3002\n# Part 2\uff1a\u6b63\u6587\n\n\u770b\u89c1\u5220\u8fb9\u76f4\u63a5\u65f6\u95f4\u5012\u6d41\uff0c\u4e0b\u9762\u7684\u8ba8\u8bba\u5168\u90e8\u662f\u5728\u52a0\u8fb9\u610f\u4e49\u4e0b\u7684\u3002\n\n\u9996\u5148\u770b\u5230 $k=8$ \u5c31\u77e5\u9053\u8fd9\u4e2a\u9898\u7684 $k$ \u53ef\u80fd\u662f\u5728\u6307\u6570\u4f4d\u7f6e\u4e86\u3002\u5bf9\u4e8e\u8fd9\u79cd\u7279\u5b9a\u6b65\u6570\u95ee\u9898\uff0c\u4e0d\u662f\u90bb\u63a5\u77e9\u9635\u5feb\u901f\u5e42\u5c31\u662f\u5bf9\u4e8e\u7ecf\u8fc7\u591a\u957f\u8def\u5f84\u7684\u5206\u7c7b\u7ef4\u62a4\uff0c\u7531\u4e8e\u8fd9\u91cc $k$ \u4e0d\u5927\uff0c\u6545\u8003\u8651\u7b2c\u4e8c\u79cd\u60c5\u51b5\u3002\n\n\u4e0d\u59a8\u6298\u534a\uff0c\u8bbe $f(k,i,0/1)$ \u8868\u793a\u4ece $1/i$ \u7ecf\u8fc7 $k$ \u6761\u9053\u8def\u5230\u8fbe $i/n$ \u7684\u6700\u77ed\u8def\u5f84\u957f\u5ea6\uff0c\u7b54\u6848\u4e3a\n$$\n\\min_{p+q=k}f(p,i,0)+f(p,i,1)\n$$\n\u8fd9\u4e2a\u4e1c\u897f\u4f3c\u4e4e\u6ca1\u6cd5\u505a\u3002\u5bf9\u7b2c $i$ \u5c42\u5355\u6b21\u8fdb\u884c\u8f6c\u79fb\u7684\u590d\u6742\u5ea6\u662f $O(n^{k-2})$ \u7684\uff0c\u800c\u4e00\u5171\u8f6c\u79fb $n^2$ \u6b21\uff0c\u603b\u590d\u6742\u5ea6\u8fbe\u5230\u4e86 $O(n^k)$\u3002\n\n\u8fd9\u91cc\u4f3c\u4e4e\u8981\u63d0\u53ca\u4e00\u4e0b\u8f6c\u79fb\uff0c\u6211\u4eec\u53ea\u8ba8\u8bba\u4ece $1$ \u5230 $i$ \u7684\u8f6c\u79fb\uff0c$i$ \u5230 $n$ \u540c\u7406\u3002\u4e00\u4e2a\u4e0d\u7cbe\u7ec6\u7684\u5355\u6b21 $O(n^k)$ \u7684\u5b9e\u73b0\u679a\u4e3e $1$ \u7ecf\u8fc7\u7684 $k$ \u4e2a\u70b9\u5e76\u66b4\u529b\u5bf9\u4e2d\u70b9\u53d6\u6700\u5c0f\u503c\uff0c\u4f46\u662f\u6211\u4eec\u4ed4\u7ec6\u60f3\u60f3\u4f1a\u53d1\u73b0\u5f53\u524d\u8fd9\u6761\u52a0\u7684\u8fb9\u5982\u679c\u5bf9\u7b54\u6848\u6709\u8d21\u732e\u5219\u5176\u4e00\u5b9a\u5b58\u5728\u4e8e\u66f4\u65b0\u7684\u8def\u5f84\u4e2d\uff0c\u4e5f\u5c31\u662f\u8bf4\u8def\u5f84\u4e0a\u5fc5\u5b9a\u6709\u4e24\u4e2a\u76f8\u90bb\u7684\u70b9\u662f $u,v$\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u80fd\u5c11\u679a\u4e3e\u4e24\u4e2a\u70b9\uff0c\u590d\u6742\u5ea6\u964d\u4f4e\u4e3a $O(n^{k-2})$\u3002\n\n\u5f53\u7136\u4e0a\u8ff0\u662f\u5b58\u5728\u4e00\u4e2a bug \u7684\uff0c\u5373\u5f53 $(u,v)$ \u662f\u7b2c\u4e00\u6761\u8fb9\u65f6\uff0c\u7531\u4e8e\u6b64\u65f6\u7b2c\u4e00\u4e2a\u70b9\u5df2\u7ecf\u786e\u5b9a\uff0c\u6240\u4ee5\u53ea\u80fd\u591a\u786e\u5b9a\u4e00\u4e2a\u70b9\u3002\u6211\u4eec\u4e0d\u96be\u53d1\u73b0\uff0c\u80fd\u5f62\u6210\u8fd9\u6837\u8f6c\u79fb\u7684\u8fb9\u6700\u591a\u6709 $n$ \u6761\uff08$u=1$\uff09\uff0c\u6545\u603b\u590d\u6742\u5ea6\u4ecd\u662f $O(n^k)$ \u7684\u3002\n\n\u7136\u540e\u6211\u5c31\u6b62\u6b65\u4e8e\u6b64\u4e86/cf\u3002\n\n\u80fd\u4e0d\u80fd\u66f4\u5feb\u4e00\u70b9\uff1f\u6211\u4eec\u4e0d\u59a8\u628a\u6b64\u65f6\u5355\u6b21\u7ef4\u62a4\u7684\u590d\u6742\u5ea6\u5217\u51fa\u6765\n\n$$\n\\begin{cases}\nk=1&O(1)\\\\\nk=2&O(1)\\\\\nk=3&O(n)\\\\\nk=4&O(n^2)\\\\\n\\end{cases}\n$$\n\n\u6ce8\u610f\u5230\u74f6\u9888\u662f $k=4$\uff0c\u6211\u4eec\u4e0d\u59a8\u5bf9 $k=2$ \u548c $k=4$ \u505a\u4e00\u4e2a\u590d\u6742\u5ea6\u5747\u644a\uff0c\u6211\u4eec\u4e0d\u6b62\u7ef4\u62a4\u5f53 $k=2$ \u65f6 $1/i$ \u5230 $i/n$ \u7ecf\u8fc7\u4e24\u6761\u8fb9\u7684\u6700\u77ed\u8def\u5f84\uff0c\u8f6c\u800c\u7ef4\u62a4\u6240\u6709\u70b9\u5bf9\u4e4b\u95f4\u7ecf\u8fc7\u4e24\u6761\u8fb9\u7684\u6700\u77ed\u8def\u5f84\uff0c\u6b64\u65f6 $k=2$ \u7684\u590d\u6742\u5ea6\u53d8\u4e3a $O(n)$\uff0c\u800c\u65e0\u8bba\u4e00\u6761\u8fb9\u662f\u4e00\u6761\u957f\u5ea6\u4e3a\u56db\u7684\u8def\u5f84\u7684\u7b2c\u51e0\u6761\u8fb9\uff0c\u4e00\u5b9a\u5b58\u5728\u4e00\u6761\u8be5\u8def\u5f84\u7684\u5b50\u8def\u5f84\uff0c\u6ee1\u8db3\u5176\u4e0d\u7ecf\u8fc7\u8be5\u8fb9\u7684\u524d\u63d0\u4e0b\u957f\u5ea6\u81f3\u5c11\u4e3a\u4e8c\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u4e00\u5b9a\u80fd\u591f\u5c11\u679a\u4e3e\u4e00\u4e2a\u70b9\uff0c\u6545\u65f6\u95f4\u590d\u6742\u5ea6\u5c06\u4e3a $O(n)$\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u56e0\u6b64\u662f $O(n^3)$\n\n# Part 3\uff1a\u4ee3\u7801\n\u4ee3\u7801\u611f\u89c9\u8fd8\u662f\u6bd4\u8f83\u597d\u61c2\u7684\n```cpp\nint Datas=0,T=1;\nconst int N=307;\nint n,K;\nvector<np>delt;\nll g[N][N];\nll ans[N*N];\nll dis1[N][N],dis2[N][N],dis3[N][2],dis4[N][2];\n\nvoid Main(){\n\tn=read(),K=read();\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tg[i][j]=read();\n\tfor(int i=1;i<=n*n;i++){\n\t\tint u=read(),v=read();\n\t\tdelt.eb(mp(u,v));\n\t}\n\tmemset(dis1,0x3f,sizeof(dis1));\n\tmemset(dis2,0x3f,sizeof(dis2));\n\tmemset(dis3,0x3f,sizeof(dis3));\n\tmemset(dis4,0x3f,sizeof(dis4));\n\tmemset(ans,0x3f,sizeof(ans));\n\tfor(int _=n*n;_>=1;_--){\n\t\tif(K==2)for(int i=1;i<=n;i++)ans[_]=min(ans[_],dis1[1][i]+dis1[i][n]);\n\t\tif(K==3)for(int i=1;i<=n;i++)ans[_]=min(ans[_],dis2[1][i]+dis1[i][n]);\n\t\tif(K==4)for(int i=1;i<=n;i++)ans[_]=min(ans[_],dis2[1][i]+dis2[i][n]);\n\t\tif(K==5)for(int i=1;i<=n;i++)ans[_]=min(ans[_],dis2[1][i]+dis3[i][1]);\n\t\tif(K==6)for(int i=1;i<=n;i++)ans[_]=min(ans[_],dis3[i][0]+dis3[i][1]);\n\t\tif(K==7)for(int i=1;i<=n;i++)ans[_]=min(ans[_],dis4[i][0]+dis3[i][1]);\n\t\tif(K==8)for(int i=1;i<=n;i++)ans[_]=min(ans[_],dis4[i][0]+dis4[i][1]);\n\t\tif(ans[0]==ans[_])ans[_]=-1;\n\t\tint u=delt.back().fi,v=delt.back().se;\n\t\tdelt.ppb();int w=g[u][v];\n\t\tdis1[u][v]=w;\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tdis2[u][i]=min(dis2[u][i],w+dis1[v][i]);\n\t\t\tdis2[i][v]=min(dis2[i][v],dis1[i][u]+w);\n\t\t}\n\t\tif(u==1)for(int i=1;i<=n;i++)dis3[i][0]=min(dis3[i][0],w+dis2[v][i]);\n\t\tif(v==n)for(int i=1;i<=n;i++)dis3[i][1]=min(dis3[i][1],dis2[i][u]+w);\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tdis3[i][0]=min(dis3[i][0],dis1[1][u]+w+dis1[v][i]);\n\t\t\tdis3[i][1]=min(dis3[i][1],dis1[i][u]+w+dis1[v][n]);\n\t\t}\n\t\tdis3[v][0]=min(dis3[v][0],dis2[1][u]+w);\n\t\tdis3[u][1]=min(dis3[u][1],w+dis2[v][n]);\n\t\tif(u==1)for(int i=1;i<=n;i++)for(int j=1;j<=n;j++)\n\t\t\tdis4[i][0]=min(dis4[i][0],w+dis1[v][j]+dis2[j][i]);\n\t\tif(v==n)for(int i=1;i<=n;i++)for(int j=1;j<=n;j++)\n\t\t\tdis4[i][1]=min(dis4[i][1],dis2[i][j]+dis1[j][u]+w);\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tdis4[i][0]=min(dis4[i][0],dis1[1][u]+w+dis2[v][i]);\n\t\t\tdis4[i][0]=min(dis4[i][0],dis2[1][u]+w+dis1[v][i]);\n\t\t\tdis4[i][1]=min(dis4[i][1],dis1[i][u]+w+dis2[v][n]);\n\t\t\tdis4[i][1]=min(dis4[i][1],dis2[i][u]+w+dis1[v][n]);\n\t\t}\n\t\tdis4[v][0]=min(dis4[v][0],dis3[u][0]+w);\n\t\tdis4[u][1]=min(dis4[u][1],w+dis3[v][1]);\n\t}\n\tfor(int i=1;i<=n*n;i++)printf(\"%lld\\n\",ans[i]);\n\treturn;\n}\n```",
        "postTime": 1671968301,
        "uid": 373699,
        "name": "EXODUS",
        "ccfLevel": 0,
        "title": "P8906\u9898\u89e3"
    },
    {
        "content": "\u5176\u5b9e\u4ece $k$ \u6781\u5c0f\u5c31\u80fd\u770b\u51fa\u662f\u5206\u5c42\u56fe\uff0c\u4e3a\u4e86\u4f18\u5316\u5e38\u6570\uff0c\u6211\u91c7\u7528\u4e86 $\\text{meet in the middle}$ \u7684\u4f18\u5316\uff0c\u5373\u7ef4\u62a4\u8d77\u70b9\u5230\u4efb\u610f\u70b9\u7ecf\u8fc7 $\\lfloor\\dfrac k 2\\rfloor$ \u548c\u4efb\u610f\u70b9\u5230\u7ec8\u70b9\u7ecf\u8fc7 $\\lceil\\dfrac k 2\\rceil$ \u6761\u8fb9\u7684\u6700\u77ed\u8def\uff0c\u5bf9\u4e8e\u6253\u5230 $\\text{P}$ \u7ec4\u7684\u4eba\u6765\u8bf4\u7406\u89e3\u8fd9\u5e94\u5f53\u4e0d\u96be\u3002\n\n\u4e0d\u8fc7\u9898\u76ee\u4e2d\u8981\u6c42\u7684\u662f\u5220\u8fb9\uff0c\u6240\u4ee5\u8fd9\u91cc\u9700\u8981\u8fd0\u7528\u7ecf\u5178\u7684\u5316\u5220\u4e3a\u52a0\u5957\u8def\uff0c\u5e94\u5f53\u5b66\u8fc7\u5e76\u67e5\u96c6\u5e94\u7528\u7684\u4eba\u90fd\u4f1a\uff0c\u5c31\u662f\u5c06\u8fb9\u53cd\u8fc7\u6765\uff0c\u4e0d\u662f\u53cd\u5411\uff0c\u662f\u5c06\u6240\u6709\u8fb9\u4e4b\u95f4\u7684\u987a\u5e8f\u53cd\u8fc7\u6765\u3002\n\n\u8003\u8651\u5982\u4f55\u6dfb\u52a0\u4e00\u6761\u8fb9\uff0c\u5728\u8fd9\u91cc\u53ea\u9700\u8981\u4f9d\u6b21\u626b\u8fc7\u5206\u5c42\u56fe\u7684\u6bcf\u4e00\u5c42\uff0c\u5982\u679c\u67d0\u4e00\u4e2a\u70b9\u5728\u4e4b\u524d\u5df2\u7ecf\u88ab\u677e\u9a70\u8fc7\uff0c\u5c31\u5c06\u5b83\u7684\u6240\u6709\u51fa\u8fb9\u90fd\u677e\u5f1b\u4e00\u904d\u3002\n\n\u8fd9\u6837\u6700\u574f\u590d\u6742\u5ea6\u662f $O(n^4k)$ \u7684\uff0c\u4f46\u662f\u6211\u4e0d\u4f1a\u5361\uff0c\u51fa\u9898\u4eba\u4e5f\u6ca1\u6709\u5361\uff0c\u5c31\u8fc7\u4e86\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=305;\nusing ll=long long;\nusing ul=unsigned long long;\nint n,k,_w[N][N];\nint _X[N*N],_Y[N*N];\nll w[N][N],ans[N*N];\nstruct spfa{\n\tll d[N][5];\n\tint vs[N][5],st,k;\n\tvoid init(int x,int p){\n\t\tmemset(d,0x1f,sizeof(d));\n\t\td[x][0]=0,st=x,k=p;\n\t}\n\tvoid upd(int x){\n\t\tmemset(vs,0,sizeof(vs));\n\t\tint i,y;\n\t\tfor(i=0;i<k;++i)vs[x][i]=1;\n\t\tfor(i=0;i<k;++i)\n\t\t\tfor(x=1;x<=n;++x)\n\t\t\t\tif(vs[x][i])\n\t\t\t\t\tfor(y=1;y<=n;++y)\n\t\t\t\t\t\tif(d[y][i+1]>d[x][i]+w[x][y]){\n\t\t\t\t\t\t\tvs[y][i+1]=1;\n\t\t\t\t\t\t\td[y][i+1]=d[x][i]+w[x][y];\n\t\t\t\t\t\t}\n\t}\n}p1;\nstruct spfa_{\n\tll d[N][5];\n\tint vs[N][5],st,k;\n\tvoid init(int x,int p){\n\t\tmemset(d,0x1f,sizeof(d));\n\t\td[x][0]=0,st=x,k=p;\n\t}\n\tvoid upd(int x){\n\t\tmemset(vs,0,sizeof(vs));\n\t\tint i,y;\n\t\tfor(i=0;i<k;++i)vs[x][i]=1;\n\t\tfor(i=0;i<k;++i)\n\t\t\tfor(x=1;x<=n;++x)\n\t\t\t\tif(vs[x][i])\n\t\t\t\t\tfor(y=1;y<=n;++y)\n\t\t\t\t\t\tif(d[y][i+1]>d[x][i]+w[y][x]){\n\t\t\t\t\t\t\tvs[y][i+1]=1;\n\t\t\t\t\t\t\td[y][i+1]=d[x][i]+w[y][x];\n\t\t\t\t\t\t}\n\t}\n}p2;\nint main(){\n#ifdef MYdef\n\tfreopen(\"a.in\",\"r\",stdin);\n\tfreopen(\"a.out\",\"w\",stdout);\n#endif\n\tios::sync_with_stdio(false);\n\tint i,j,k,l,r,x,y,X,Y;\n\tcin>>n>>k;\n\tfor(x=1;x<=n;++x)\n\t\tfor(y=1;y<=n;++y)\n\t\t\tcin>>_w[x][y],w[x][y]=1e18;\n\tfor(i=1;i<=n*n;++i)cin>>_X[i]>>_Y[i];\n\tp1.init(1,k>>1),p2.init(n,k+1>>1);\n\tfor(i=n*n;i;--i){\n\t\tans[i]=1e15;\n\t\tfor(x=1;x<=n;++x)\n\t\t\tans[i]=min(ans[i],p1.d[x][k>>1]+p2.d[x][k+1>>1]);\n\t\tif(ans[i]>=9e14)ans[i]=-1;\n\t\tw[_X[i]][_Y[i]]=_w[_X[i]][_Y[i]];\n//\t\tprintf(\"x:%d y:%d w:%lld\\n\",_X[i],_Y[i],w[_X[i]][_Y[i]]);\n\t\tp1.upd(_X[i]),p2.upd(_Y[i]);\n//\t\tfor(x=1;x<=n;++x)p1.upd(x),p2.upd(x);\n\t}\n\tfor(i=1;i<=n*n;++i)\n\t\tprintf(\"%lld\\n\",ans[i]);\n\treturn 0;\n}\n```",
        "postTime": 1671930563,
        "uid": 502410,
        "name": "EnofTaiPeople",
        "ccfLevel": 0,
        "title": "\u5206\u5c42\u56fe\u52a0\u8fb9\u6700\u77ed\u8def(USACO22DEC-P1)"
    },
    {
        "content": "[P8906 [USACO22DEC] Breakdown P](https://www.luogu.com.cn/problem/P8906)\n\n\u9996\u5148\u6298\u534a\u641c\uff0c\u5c06\u95ee\u9898\u5f62\u5f0f\u8f6c\u5316\u4e3a\u7ef4\u62a4 $1$ \u5230\u6bcf\u4e2a\u70b9\u7ecf\u8fc7 $k$ \u6761\u8fb9\u7684\u6700\u77ed\u8def $h_i$\uff0c\u5176\u4e2d $k\\leq 4$\u3002\u6211\u4eec\u53ea\u8003\u8651 $k = 4$\u3002\n\n\u5220\u8fb9\u5012\u8fc7\u6765\u53d8\u6210\u52a0\u8fb9\u3002\n\n\u8003\u8651\u65f6\u523b\u7ef4\u62a4\u4efb\u610f\u4e24\u70b9\u95f4\u7ecf\u8fc7\u4e24\u6761\u8fb9\u7684\u6700\u77ed\u8def $f_{i, j}$\u3002\u52a0\u8fb9\u65f6\u53ea\u4f1a\u5bf9 $i = u$ \u6216 $j = v$ \u7684 $f_{i, j}$ \u4ea7\u751f\u4fee\u6539\uff0c\u5171 $\\mathcal{O}(n)$ \u79cd\u60c5\u51b5\u3002\u5bf9\u4e8e $h_i$\uff0c\u679a\u4e3e\u4e2d\u8f6c\u70b9 $j$ \uff0c\u8ba1\u7b97 $f_{1, j} + f_{j, i}$\u3002\u6ce8\u610f\u5230\u5f53\u4e14\u4ec5\u5f53 $i$ \u6216 $j$ \u7b49\u4e8e $u$ \u6216 $v$ \u65f6\u624d\u4f1a\u56e0 $f$ \u7684\u4fee\u6539\u800c\u5bf9 $h$ \u4ea7\u751f\u8d21\u732e\uff0c\u56e0\u6b64\u5bf9\u4e8e $i\\neq u, v$\uff0c\u53ea\u9700\u7528 $f_{1, u / v} + f_{u / v, i}$ \u66f4\u65b0\uff0c\u5bf9\u4e8e $i = u$ \u6216 $v$ \u7528\u6240\u6709 $f_{1, j} + f_{j, i}$ \u66f4\u65b0\u3002\n\n\u5355\u6b21\u52a0\u8fb9\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5747\u644a $\\mathcal{O}(n)$\uff0c\u6ce8\u610f\u7279\u5224 $u = 1$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconstexpr int N = 300 + 5;\nconstexpr int M = 1e5 + 5;\nint n, m, k;\nint ans[M], u[M], v[M], e[N][N];\nvoid cmin(int &x, int y) {\n  x = x < y ? x : y;\n}\nstruct solver {\n  int st, k;\n  int e[N][N], f[N][N], h[N];\n  void init(int _k, int _st) {\n    k = _k, st = _st;\n    memset(e, 0x3f, sizeof(e));\n    memset(f, 0x3f, sizeof(f));\n    memset(h, 0x3f, sizeof(h));\n    if(!k) {\n      h[st] = 0;\n    }\n  }\n  void add(int u, int v, int w) {\n    e[u][v] = w;\n    if(!k) return;\n    if(k == 1) {\n      if(u == st) {\n        h[v] = w;\n      }\n      return;\n    }\n    for(int i = 1; i <= n; i++) {\n      cmin(f[i][v], e[i][u] + w);\n      cmin(f[u][i], w + e[v][i]);\n    }\n    if(k == 2) {\n      for(int i = 1; i <= n; i++) {\n        cmin(h[i], f[st][i]);\n      }\n    }\n    auto p = k == 3 ? e : f;\n    if(k > 2) {\n      if(u == st) {\n        for(int i = 1; i <= n; i++) {\n          for(int j = 1; j <= n; j++) {\n            cmin(h[j], f[st][i] + p[i][j]);\n          }\n        }\n      }\n      else {\n        for(int i = 1; i <= n; i++) {\n          cmin(h[i], f[st][v] + p[v][i]);\n          cmin(h[i], f[st][u] + p[u][i]);\n          cmin(h[u], f[st][i] + p[i][u]);\n          cmin(h[v], f[st][i] + p[i][v]);\n        }\n      }\n    }\n  }\n} _1, _n;\nint main() {\n  #ifdef ALEX_WEI\n    freopen(\"1.in\", \"r\", stdin);\n    freopen(\"1.out\", \"w\", stdout);\n  #endif\n  ios::sync_with_stdio(0);\n  cin.tie(0), cout.tie(0);\n  cin >> n >> k, m = n * n;\n  for(int i = 1; i <= n; i++) {\n    for(int j = 1; j <= n; j++) {\n      cin >> e[i][j];\n    }\n  }\n  for(int i = 1; i <= m; i++) {\n    cin >> u[i] >> v[i];\n  }\n  int L = k >> 1, R = k - L;\n  _1.init(L, 1), _n.init(R, n);\n  for(int i = m; i; i--) {\n    ans[i] = 0x3f3f3f3f;\n    for(int p = 1; p <= n; p++) {\n      cmin(ans[i], _1.h[p] + _n.h[p]);\n    }\n    _1.add(u[i], v[i], e[u[i]][v[i]]);\n    _n.add(v[i], u[i], e[u[i]][v[i]]);\n  }\n  for(int i = 1; i <= m; i++) {\n    if(ans[i] > 1e9) cout << \"-1\\n\";\n    else cout << ans[i] << \"\\n\";\n  }\n  return 0;\n}\n```",
        "postTime": 1675341117,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "P8906 [USACO22DEC] Breakdown P"
    },
    {
        "content": "\u5927\u5bb6\u597d\uff0c\u6211\u559c\u6b22\u5957\u5a03\u3002\n\n\u9996\u5148\u65f6\u95f4\u5012\u6d41\u53d8\u52a0\u8fb9+\u6298\u534a\u3002\n\n\u7136\u540e\u6211\u4e0d\u4f1a\u5904\u7406\u6298\u534a\uff0c\u4e8e\u662f\u6211\u8fdb\u884c\u4e00\u4e2a\u6298\u534a\u7684\u6298\u534a\u3002\n\n--------------\n\n\u8003\u8651\u5bf9\u4e8e\u6bcf\u4e2a\u65f6\u523b\u5904\u7406\u51fa $dis[i](1\\leq i \\leq n)$ \u8868\u793a\u5f53\u524d $1$ \u5230 $i$ \u8d70 $4$ \u6b65\u7684\u6700\u77ed\u8def\uff0c\u4e0d\u5b58\u5728\u5373\u4e3a $\\inf$\u3002\n\n\uff08$i$ \u5230 $n$ \u540c\u7406\uff0c\u8fd9\u91cc\u53ea\u8ba8\u8bba\u4e00\u534a\u3002\uff09\n\n\u7136\u540e\u6211\u4e0d\u4f1a\u7ef4\u62a4 $dis$\uff0c\u4e8e\u662f\u6211\u8fdb\u884c\u4e00\u4e2a**\u518d\u6b21\u6298\u534a**\u3002\n\n\u8bbe $D[i][j][k]$ \u8868\u793a\u4ece $i$ \u51fa\u53d1\uff0c\u4f9d\u6b21\u8d70 $(i,j)$ \u4e0e $(j,k)$ \u8fb9\u7684\u8ddd\u79bb\uff0c\u4e0d\u5b58\u5728\u8bb0\u4e3a $\\inf$\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\u5f53\u4e14\u4ec5\u5f53\u5728\u8fd9\u4e24\u6761\u8fb9\u8fdf**\u52a0\u5165**\uff08\u56e0\u4e3a\u65f6\u95f4\u5012\u6d41\u6240\u4ee5\u662f\u52a0\u8fb9\uff09\u7684\u90a3\u4e00\u6761\u52a0\u5165\u7684\u65f6\u523b\uff0c$D[i][j][k]$ \u4f1a\u53d1\u751f\u6539\u53d8\u3002\n\n\u4e8e\u662f\u7ef4\u62a4 $D$ \u7684**\u603b**\u590d\u6742\u5ea6\u4e3a $O(n^3)$\u3002\n\n\u8bbe $L[i][j]$ \u8868\u793a\u4ece $i$ \u51fa\u53d1\u8d70 $2$ \u6b65\u5230\u8fbe $j$ \u7684\u6700\u77ed\u8def\uff0c\u4e0d\u5b58\u5728\u540c\u6837\u8bb0\u4e3a $\\inf$\u3002\n\n\u4e8e\u662f\u6709 $L[i][j]=\\min_{k=1}^nD[i][k][j]$\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\u5f53 $D[i][j][k]$ \u88ab\u4fee\u6539\u65f6\uff0c$L[i][k]$ \u4f1a\u88ab\u53d6 $\\min$\u3002\u56e0\u6b64 $L$ \u603b\u7684\u4fee\u6539\u6b21\u6570\u4e0d\u8d85\u8fc7 $O(n^3)$\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u5982\u4f55\u7528 $L$ \u6765\u7ef4\u62a4 $dis$\u3002\n\n\u9996\u5148\uff0c\u5f53 $L[i][j]$ \u88ab\u4fee\u6539\u65f6\uff0c$dis[j]$ \u4f1a\u88ab\u4fee\u6539\uff0c\u56e0\u4e3a\u5b58\u5728\u4e00\u6761\u8def\u5f84 $(1,?,i,?,j)$\u3002\n\n\u6b64\u65f6\u53d8\u5316\u4e3a `dis[j]=min(dis[j],L[1][i]+L[i][j])`\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u8bb0\u4e3a \u2460\u3002\n\n\u4f46\u662f\u5f53 $i=1$ \u7684\u65f6\u5019\uff0c\u7531\u4e8e\u5b58\u5728 $(1,?,j,?,u)(1\\leq u \\leq n)$\uff0c\u6211\u4eec\u8981\u5bf9\u6bcf\u4e2a $1 \\leq u \\leq n$ \u6267\u884c `dis[u]=min(dis[u],L[1][j]+L[j][u])`\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u8bb0\u4e3a \u2461\u3002\n\n\u8fd9\u6837\u770b\u8d77\u6765\u590d\u6742\u5ea6\u4e0d\u662f\u5f88\u5bf9\uff0c\u8fbe\u5230\u4e86 $O(n^3 \\times n)=O(n^4)$\uff0c\u4f46\u662f\u5176\u5b9e\u4e0d\u662f\u3002\n\n\u6267\u884c \u2460 \u7684\u6b21\u6570\u7b49\u4e8e $L$ \u4fee\u6539\u7684\u6b21\u6570\uff0c\u4e3a $O(n^3)$\u3002\n\n\u4f46\u662f\u6267\u884c \u2461 \u7684\u6b21\u6570\u7b49\u4e8e $L[1][*]$ \u7684\u4fee\u6539\u6b21\u6570\uff0c\u518d\u5f80\u524d\u5bfc\u5c31\u662f $D[1][*][*]$ \u7684\u4fee\u6539\u6b21\u6570\uff0c\u4e3a $O(n^2)$\u3002\n\n\u6240\u4ee5 \u2461 \u7684\u603b\u590d\u6742\u5ea6\u4ecd\u4e3a $O(n^3)$\u3002\u7a0b\u5e8f\u7684\u603b\u590d\u6742\u5ea6\u4e3a $O(n^3)$\u3002",
        "postTime": 1673173124,
        "uid": 90706,
        "name": "_jimmywang_",
        "ccfLevel": 0,
        "title": "P8906 [USACO22DEC] Breakdown P"
    },
    {
        "content": "> \u8fd9\u662f\u4e00\u4e2a\u590d\u6742\u5ea6\u6ca1\u6709\u4fdd\u8bc1\u7684\u505a\u6cd5\u3002\n\n\u65f6\u95f4\u5012\u6d41\uff0c\u53d8\u5220\u8fb9\u4e3a\u52a0\u8fb9\u3002\u600e\u4e48\u9650\u5236\u8def\u5f84\u957f\u5ea6\uff1f\u65e0\u8111\u5206\u5c42\u56fe\u3002\u5c06\u56fe\u5206\u4e3a $k+1$ \u5c42\uff0c\u7b2c $i$ \u5c42\u5411\u7b2c $i+1$ \u5c42\u8fde\u8fb9\uff0c\u7136\u540e\u8dd1 spfa\u3002\n\n\u603b\u5171\u6709 $nk$ \u4e2a\u70b9\uff0c$n^2k$ \u6761\u8fb9\uff0c\u7406\u8bba\u590d\u6742\u5ea6\u98de\u5929\uff0c\u4f46\u662f\u6570\u636e\u6ca1\u5361\u3002\n\n```cpp\n#include<bits/stdc++.h>\nnamespace vectorwyx{\n#define pii pair<int,int>\n#define fi first\n#define se second\n#define pb push_back\n#define eb emplace_back\n#define mk make_pair\n#define sml(x,y) (x=min(x,y))\n#define big(x,y) (x=max(x,y))\n#define ll long long\n#define uint unsigned\n#define ull unsigned long long\n#define umap unordered_map\n#define db double\n#define fo(i,x,y) for(int i=(x);i<=(y);++i)\n#define go(i,x,y) for(int i=(x);i>=(y);--i)\n#define ptc putchar\n#define emp emplace\n#define re return\n#define co continue\n#define brk break\n#define HH (ptc('\\n'))\n#define bctz __builtin_ctz\n#define bclz __builtin_clz\n#define bppc __builtin_popcount\nusing namespace std;\nll seed=chrono::system_clock::now().time_since_epoch().count();\nmt19937 rnd(seed);\ninline int rm(int x,int y){return (int)(rnd()%(y-x+1ll)+x);}\ninline int read(){signed ch=getchar();int x=0,f=1;while(!isdigit(ch)){if(ch==(int)('-'))f=-1;ch=getchar();}while(isdigit(ch)){x=(x<<1)+(x<<3)+(ch^48);ch=getchar();}return x*f;}\ninline void out(int *a,int l,int r){fo(i,l,r) cout<<*(a+i)<<' ';puts(\"\");}\n\n//15:47~15:56~16:01\n\nconst int N=3005,M=301*301,inf=1e9;\nvector<pii> e[N];\nint n,k,mp[N][N],ans[M],dis[N],t,inq[N];\npii ee[M];\n\n#define upda(x,v,y){\\\n\tif(dis[x]+v<dis[y]){\\\n\t\tdis[y]=dis[x]+v;\\\n\t\tif(!inq[y]) inq[y]=1,q.push(y);\\\n\t}\\\n}\n\nsigned main(){\n\tcin>>n>>k;k++;t=n*k;\n\tfo(i,1,n) fo(j,1,n) mp[i][j]=read();\n\tfo(i,1,n*n){\n\t\tint x=read(),y=read();\n\t\tee[i]=mk(x,y);\n\t}\n\tfo(i,2,n*k) dis[i]=inf;\n\tgo(tt,n*n,1){\n//\t\tprintf(\"%d!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\\n\",tt);\n\t\tans[tt]=dis[t]<inf?dis[t]:-1;\n\t\tint x=ee[tt].fi,y=ee[tt].se;\n\t\tqueue<int> q;\n\t\tfo(j,0,k-1){\n\t\t\tint X=x+j*n,Y=y+(j+1)*n;\n\t\t\tupda(X,mp[x][y],Y);\n\t\t\te[X].eb(Y,mp[x][y]);\n\t\t}\n\t\twhile(!q.empty()){\n\t\t\tint xx=q.front();q.pop();\n\t\t\tinq[xx]=0;\n\t\t\tfor(auto i:e[xx]) upda(xx,i.se,i.fi);\n\t\t}\n\t}\n\tfo(i,1,n*n) cout<<ans[i]<<'\\n';\n\treturn 0;\n}\n}\n\n\n\n\n\n\n\n\n\n\nsigned main(){re vectorwyx::main();}\n\n\n```",
        "postTime": 1671882164,
        "uid": 238408,
        "name": "vectorwyx",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P8906 [USACO22DEC] Breakdown P"
    },
    {
        "content": "\u9760\u8c31\u505a\u6cd5\uff0c\u4e8b\u5b9e\u4e0a\u8fd9\u4e2a\u9898 $k\\ge 9$ \u662f\u6ca1\u6cd5\u505a\u7684\u3002\n\n\u8003\u573a\u4e0a\u9996\u5148\u89c2\u5bdf\u51fa $k\\le 8$\uff0c\u90a3\u4e00\u773c\u6307\u6570/meet in the middle\uff0c\u8fd9\u4e2a\u6307\u6570\u6ca1\u6709\u5f88\u597d\u53ef\u4ee5\u679a\u4e3e\u7684\u96c6\u5408\uff0c\u90a3\u8003\u8651 meet in the middle\u3002\n\n\u5e38\u89c1\u5957\u8def\uff0c\u5220\u8fb9\u53d8\u5012\u5e8f\u52a0\u8fb9\u3002\u8bb0 $d_{i,j}$ \u8868\u793a $1$ \u5230 $i$ \u6070\u7ecf\u8fc7 $j$ \u6761\u8fb9\uff08\u5176\u4e2d $j\\in [1,4]$\uff09\u7684\u6700\u77ed\u8def\uff0c\u8fd9\u662f\u8def\u5f84\u7684\u524d\u4e00\u534a\uff0c\u540e\u4e00\u534a\u4e5f\u540c\u7406\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728\u52a0\u8fb9\u8fc7\u7a0b\u4e2d\u52a8\u6001\u7ef4\u62a4\u8fd9\u73a9\u610f\u5c31\u884c\u4e86\u3002\n\n\u8003\u8651\u52a0\u7684\u4e00\u6761\u8fb9\u5728\u4ec0\u4e48\u4f4d\u7f6e\uff0c\u53ea\u6709\u4e24\u79cd\u60c5\u51b5\u4e0d\u80fd\u76f4\u63a5\u505a\uff0c\u4e00\u79cd\u662f\u5728\u7b2c\u4e00\u6761\u8fb9\uff08\u5373 $u=1$\uff09\uff0c\u4e00\u79cd\u662f\u5728\u7b2c\u4e8c\u6761\u8fb9\uff0c\u4e0b\u9762\u5206\u522b\u5206\u6790\u3002\n\n\u5f53\u5728\u7b2c\u4e00\u6761\u8fb9\u7684\u65f6\u5019\uff0c\u8def\u5f84\u662f $1=u\\stackrel{w}{\\rightarrow}v\\rightarrow x\\rightarrow y\\rightarrow z$\uff0c\u6ce8\u610f\u6b64\u65f6 $(u,v,w)$ \u603b\u5171\u53ea\u6709 $n$ \u4e2a\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u627f\u53d7 $O(n^2)$ \u7684\u679a\u4e3e\u91cf\u3002\u9664\u4e86 $d_{z,4}$ \u90fd\u662f\u597d\u505a\u7684\uff0c\u4e0d\u59a8\u679a\u4e3e $x,z$\uff0c\u53e6\u5916\u5904\u7406\u51fa $d'_{x,z}$ \u8868\u793a $x\\rightarrow y\\rightarrow z$ \u7684\u6700\u77ed\u8def\uff0c\u5904\u7406\u7684\u90e8\u5206\u52a0\u5165\u6bcf\u6761\u8fb9\u65f6\u53ef\u4ee5 $O(n)$ \u66f4\u65b0\uff0c\u8fd9\u6837\u590d\u6742\u5ea6\u662f\u4e00\u6761\u8fb9 $O(n^2)$\uff0c\u53ef\u4ee5\u63a5\u53d7\u3002\n\n\u5f53\u5728\u7b2c\u4e8c\u6761\u8fb9\u7684\u65f6\u5019\uff0c\u8def\u5f84\u662f $1\\rightarrow u\\stackrel{w}{\\rightarrow}v\\rightarrow x\\rightarrow y$\uff0c$d_{y,4}$ \u501f\u52a9 $d'$ \u66f4\u65b0\uff0c\u590d\u6742\u5ea6 $O(n)$\u3002\n\n\u8fd9\u6837\u603b\u590d\u6742\u5ea6 $O(n^3)$\uff0c\u6709\u7406\u6709\u636e\uff0c$k$ \u66f4\u5927\u65f6\u5c31\u4e0d\u80fd $O(n^3)$ \u4e86\u3002\n\n\u5269\u4e0b\u7684\u90e8\u5206\u6bd4\u8f83\u7b80\u5355\uff0c\u53c2\u8003\u4ee3\u7801\u4e0d\u96be\u3002\n\n\u8d5b\u65f6\u4ee3\u7801\uff1a\n\n```cpp\n// Problem: Problem 1. Breakdown\n// Contest: USACO - USACO 2022 December Contest, Platinum\n// URL: http://usaco.org/index.php?page=viewproblem&cpid=1248\n// Memory Limit: 256 MB\n// Time Limit: 4000 ms\n// Create Time: 2022-12-18 12:55:34\n// Input/Output: stdin/stdout\n// \n// Powered by CP Editor (https://cpeditor.org)\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n#define fi first\n#define se second\n#define mp make_pair\n#define pb push_back\n#define pf push_front\n#define rep(i, s, t) for (int i = s; i <= t; ++i)\n#define per(i, s, t) for (int i = t; i >= s; --i)\n\nconst int N = 305;\nconst ll inf = 1e18;\n\nint n, k; \nint du[N*N], dv[N*N];\nll d1[N][5], d2[N][5], d3[N][N], w[N][N], adj[N][N];;\nll ans[N*N];\n\nvoid upd1(int u, int v, ll d[N][5]) {\n\tint s = 1;\n\t//1\n\tif(u == s) {\n\t\td[v][1] = min(d[v][1], w[u][v]);\n\t\trep(i, 1, n) d[i][2] = min(d[i][2], w[u][v] + w[v][i]);\n\t\trep(i, 1, n) d[i][3] = min(d[i][3], w[u][v] + d3[v][i]);\n\t\trep(i, 1, n) rep(j, 1, n) d[j][4] = min(d[j][4], w[u][v] + w[v][i] + d3[i][j]);\n\t}\n\t//2\n\td[v][2] = min(d[v][2], w[s][u] + w[u][v]);\n\trep(i, 1, n) d[i][3] = min(d[i][3], w[s][u] + w[u][v] + w[v][i]);\n\trep(i, 1, n) d[i][4] = min(d[i][4], w[s][u] + w[u][v] + d3[v][i]);\n\t//3\n\td[v][3] = min(d[v][3], d[u][2] + w[u][v]);\n\trep(i, 1, n) d[i][4] = min(d[i][4], d[v][3] + w[v][i]);\n\t//4\n\td[v][4] = min(d[v][4], d[u][3] + w[u][v]);\n}\n\nvoid upd2(int u, int v, ll d[N][5]) {\n\tint t = n;\n\t//1\n\tif(v == n) {\n\t\td[u][1] = min(d[u][1], w[u][v]);\n\t\trep(i, 1, n) d[i][2] = min(d[i][2], w[i][u] + w[u][v]);\n\t\trep(i, 1, n) d[i][3] = min(d[i][3], d3[i][u] + w[u][v]);\n\t\trep(i, 1, n) rep(j, 1, n) d[i][4] = min(d[i][4], d3[i][j] + w[j][u] + w[u][v]);\n\t}\n\t//2\n\td[u][2] = min(d[u][2], w[u][v] + w[v][t]);\n\trep(i, 1, n) d[i][3] = min(d[i][3], w[i][u] + w[u][v] + w[v][t]);\n\trep(i, 1, n) d[i][4] = min(d[i][4], d3[i][u] + w[u][v] + w[v][t]);\n\t//3\n\td[u][3] = min(d[u][3], w[u][v] + d[v][2]);\n\trep(i, 1, n) d[i][4] = min(d[i][4], w[i][u] + d[u][3]);\n\t//4\n\td[u][4] = min(d[u][4], w[u][v] + d[v][3]);\n}\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(nullptr), cout.tie(nullptr);\n\tcout << fixed << setprecision(15); \n\tcerr << fixed << setprecision(15);\n\n\tcin >> n >> k;\n\trep(i, 1, n) rep(j, 1, n) cin >> adj[i][j];\n\trep(i, 1, n*n) cin >> du[i] >> dv[i];\n\t\n\trep(i, 1, n) rep(j, 1, n) w[i][j] = d3[i][j] = inf;\n\trep(i, 1, n) rep(j, 0, 4) d1[i][j] = d2[i][j] = inf;\n\trep(i, 1, n*n+1) ans[i] = inf;\n\n\tper(i, 1, n*n) {\n\t\tint u = du[i], v = dv[i];\n\t\tw[u][v] = adj[u][v];\n\t\trep(u0, 1, n) d3[u0][v] = min(d3[u0][v], w[u0][u] + w[u][v]);\n\t\trep(u0, 1, n) d3[u][u0] = min(d3[u][u0], w[u][v] + w[v][u0]);\n\t\tupd1(u, v, d1);\n\t\tupd2(u, v, d2);\n\t\tif(k <= 4) ans[i] = d1[n][k];\n\t\telse rep(j, 1, n) ans[i] = min(ans[i], d1[j][4] + d2[j][k-4]);\n\t}\n\n\trep(i, 2, n*n+1) cout << (ans[i] == inf ? -1 : ans[i]) << \"\\n\";\n\t\n\treturn 0;\n}\n\n```",
        "postTime": 1673609697,
        "uid": 95103,
        "name": "KellyFrog",
        "ccfLevel": 9,
        "title": "\u9898\u89e3\u3010P8906 [USACO22DEC] Breakdown P\u3011"
    },
    {
        "content": "\u6ca1\u592a\u5173\u6ce8\uff0c\u8fd9\u6b21 USACO \u7684\u9898\u642c\u8fdb\u4e3b\u9898\u5e93\u4e86\u73b0\u5728\u624d\u53d1\u73b0\u3002\n\n\u7ec8\u4e8e\u8c03\u8fc7\u4e86\uff0c\u53d1\u7bc7\u9898\u89e3\u7eaa\u5ff5\u4e00\u4e0b\u3002\n\n\u672c\u6765\u4ee5\u4e3a\u8fd9\u6b21\u7684 Pt \u7ec4\u4f1a\u8ddf\u4e8c\u6708\u90a3\u6b21\u4e00\u6837\u4e24\u9ed1\u4e00\u7d2b\u7684\uff0c\u6240\u4ee5\u5c31\u5e26\u7740\u521a T1 \u7684\u5fc3\u6001\u53bb\u6253\u7684\uff0c\u7ed3\u679c\u6ca1\u60f3\u5230\u4e24\u7d2b\u4e00\u84dd\u3002\u4e0a\u6765\u60f3\u4e86\u4e00\u4f1a\u5207\u4e86 T1 \u8fd8\u611f\u89c9\u4e0d\u9519\uff0c\u7ed3\u679c\u90a3\u65f6\u5019\u53ef\u80fd\u8111\u5b50\u6709\u70b9\u660f\uff0c\u7ec6\u8282\u9898\u5199\u5f97\u6f0f\u6d1e\u767e\u51fa\uff0c\u8c03\u4e86\u4e00\u6574\u573a\u90fd\u6ca1\u8c03\u51fa\u6765\u3002\n\n\u8d5b\u65f6\u7684\u5149\u8f89\u6218\u7ee9\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ww1lls7a.png?x-oss-process=image/resize,m_lfit,h_340,w_450)\n\n\u8d5b\u540e\u53c8\u6539\u4e86\u4e00\u4e0b\uff0c\u6700\u540e\u76f4\u5230\u4eca\u5929\u770b\u89c1\u6d1b\u8c37\u91cc\u7684\u8fd9\u9053\u9898\u540e\u53c8\u770b\u4e86\u770b\u4ee3\u7801\u624d\u6539\u8fc7\u6700\u540e $k=5,7$ \u7684\u60c5\u51b5\uff0c\u4e0d\u77e5\u9053\u5f53\u65f6\u5199\u4ee3\u7801\u7684\u65f6\u5019\u5728\u60f3\u5565\u80fd\u5199\u51fa\u8fd9\u4e48\u591a\u9519\u3002\n\n\u5927\u6982\u662f\u4e2a meet-in-middle \u5957 meet-in-middle\uff0c\u771f\u4e0d\u77e5\u9053 $\\color{black}B\\color{red}{enq}$ \u662f\u600e\u4e48\u51fa\u51fa\u8fd9\u79cd\u9634\u95f4\u9898\u7684\u3002\n\n$k \\le 8$\uff0c\u6240\u4ee5\u4e0b\u9762\u76f4\u63a5\u8003\u8651 $k=8$ \u7684\u60c5\u51b5\uff0c\u5176\u4ed6\u7684\u7c7b\u4f3c\u3002\n\n\u9996\u5148\u5148\u6765\u4e00\u4e2a meet-in-middle \u8bb0\u5f55 $dis_{1/n,i,j}$ \u8868\u793a\u4ece $1/n$ \u7ecf\u8fc7 4 \u6761\u8fb9\u5230 $i$ \u4e0d\u7528\u6700\u5148\u5220\u7684 $j$ \u6761\u8fb9\u7684\u6700\u5c0f\u4ee3\u4ef7\uff0c\u4e0d\u80fd\u8fbe\u5230\u8bb0\u4e3a INF\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7684\u72b6\u6001\u6570\u5c31\u662f\u521a\u597d $O(n^3)$ \u7684\u3002\u6700\u7ec8\u7b2c $i$ \u884c\u7684\u7b54\u6848\u5c31\u662f $\\min\\limits_{j=1}^n dis_{1,j,i}+dis_{n,j,i}$\u3002\n\n\u867d\u7136\u72b6\u6001\u6570\u6b63\u786e\uff0c\u4f46\u4e0b\u9762\u8fd8\u9700\u8981\u8003\u8651\u600e\u4e48\u6c42\uff0c\u8fd9\u65f6\u518d\u6765\u4e00\u4e2a meet-in-middle\u3002\u8bb0\u5f55 $dp_{i,j,k}$ \u8868\u793a\u4ece $i$ \u7ecf\u8fc7 2 \u6761\u8fb9\u5230 $j$ \u4e0d\u7528\u6700\u5148\u5220\u7684 $k$ \u6761\u8fb9\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\u90a3\u4e48\u8fd9\u4e2a\u662f $O(n^4)$ \u7684\uff0c\u4e0d\u884c\u3002\u4f46\u662f\u53d1\u73b0\u6709\u6548\u4f4d\u7f6e\u6700\u591a\u53ea\u6709 $n$ \u4e2a\uff0c\u56e0\u4e3a\u8003\u8651\u4e2d\u95f4\u7ecf\u8fc7\u7684\u90a3\u4e2a\u70b9\u53ea\u6709 $n$ \u4e2a\u53d6\u503c\uff0c\u6240\u4ee5\u53ea\u8bb0\u5f55\u8fd9 $O(n)$ \u4e2a\u4f4d\u7f6e\u3002\n\n\u7136\u540e\u5728\u6c42 $dis_{1/n,i,j} = \\min\\limits_{p=1}^n dp_{1/n,p,j} + dp{p,i,j}$ \u65f6\u53d1\u73b0\u786e\u5b9a $i$ \u540e\u4e00\u4e2a $p$ \u53ea\u4f1a\u8d21\u732e $O(n)$ \u79cd\u53d6\u503c\uff0c\u800c\u8fd9\u53ea\u9700\u8981\u5c06\u4e24\u8fb9\u7684 $dp$ \u505a\u4e00\u4e2a\u7c7b\u4f3c\u5f52\u5e76\u6392\u5e8f\u7684\u4e1c\u897f\u5c31\u884c\u4e86\u3002\u5bf9\u4e00\u6574\u6bb5\u53d6 $\\min$ \u7684\u64cd\u4f5c\u53ef\u4ee5\u5148\u53ea\u66f4\u65b0\u6700\u5927\u7684\u90a3\u4e2a\u6700\u540e\u6c42\u4e00\u904d\u540e\u7f00 $\\min$\u3002\n\n\u5b9e\u73b0\u7684\u65f6\u5019\u8fd8\u8981\u6ce8\u610f\u5982\u679c\u628a\u4e0a\u9762\u90a3\u4e09\u4e2a $n^3$ \u7684\u6570\u7ec4\u90fd\u5f00\u51fa\u6765\u4f1a MLE\uff08\u6211\u4e0d\u77e5\u9053\u522b\u4eba\u662f\u4e0d\u662f\uff0c\u53cd\u6b63\u6211\u662f\uff09\u3002\u6240\u4ee5\u6211\u662f\u6eda\u52a8\u4e86 $dis$\uff0c\u6bcf\u6b21\u6c42\u51fa\u5bf9\u4e8e\u4e00\u4e2a $i$ \u7684\u4e4b\u540e\u5c31\u76f4\u63a5\u66f4\u65b0\u7b54\u6848\u7136\u540e\u4e22\u5f03\u3002\n\n\u611f\u89c9 $\\color{black}B\\color{red}{enq}$ \u9020\u6570\u636e\u662f\u7528\u5fc3\u4e86\u7684\uff0c\u6211\u8d5b\u65f6\u6c42 $dis$ \u7684\u5730\u65b9\u51fa\u4e86\u4e2a\u95ee\u9898\u62cd\u4e86\u51e0\u5343\u7ec4\u624d\u62cd\u51fa\u6765\uff0c\u89c4\u6a21\u5f00\u6ee1\u4e5f\u6ca1\u7528\uff0c\u7ed3\u679c\u4ea4\u4e0a\u53bb\u4e00\u4e2a\u70b9\u4e5f\u8fc7\u4e0d\u4e86~~\u6211\u4e5f\u4e0d\u77e5\u9053\u4ed6\u4e3a\u5565\u4e0d\u5361\u4e00\u4e0bSPFA~~\u3002\n\n\u6781\u5176\u4e11\u964b\u7684\u4ee3\u7801\uff1a\n```\n#include<cstdio>\n#include<algorithm>\n#define TY int\n#define MAXN 302\n#define MAXM 90002\n#define debug if( 1 &&putchar('>'))\n#define FOR(i,a,b) for(TY i=(a);i<=(b);i=-~i)\n#define fOR(i,a,b) for(TY i=(a);i<(b);i=-~i)\n#define ROF(i,a,b) for(TY i=(a);i>=(b);i=~-i)\n#define rOF(i,a,b) for(TY i=(a);i>(b);i=~-i)\nusing namespace std;\ntypedef long long ll;\nconst TY M=998244353;//\u7b54\u6848\u4e0d\u4f1a\u8d85\u8fc7 8e8\uff0c\u6240\u4ee5\u9009\u62e9\u8fd9\u4e2a\u4f5c\u4e3a INF \u5373\u53ef\ntypedef unsigned long long ull;\nTY _abs(TY a){return a<0?-a:a;}\nTY maxn(TY a,TY b){return a>b?a:b;}\nTY minn(TY a,TY b){return a<b?a:b;}\nTY gcd(TY a,TY b){return b?gcd(b,a%b):a;}\nTY qp(TY a,TY b){TY ans=1;do{if(1&b)ans=ans*a%M;a=a*a%M;}while(b>>=1);return ans;}\nchar getc(){char ch=getchar();while(ch==' '||ch=='\\n'||ch=='\\r')ch=getchar();return ch;}\nTY qr(){\n\tchar ch=getchar();TY s=0,x=1;\n\tfor(;ch<'0'||ch>'9';ch=getchar())if(ch=='-')x=-1;\n\tfor(;ch>='0'&&ch<='9';ch=getchar())s=s*10+ch-'0';return x*s;\n}void qw1(TY a){if(a>9)qw1(a/10);putchar(a%10+'0');}\nvoid qw(TY a,char ch){\n\tif(a<0){a=-a;putchar('-');}\n\tif(a>9)qw1(a/10);putchar(a%10+'0');\n\tif(ch)putchar(ch);\n}TY n,m,k,u,p,q,w[MAXN][MAXN],id[MAXN][MAXN],t[MAXN],x[MAXN],l[MAXN][MAXN],ds1[MAXM],dsn[MAXM],ans[MAXM];\nstruct node{TY x,y;}ds[MAXN][MAXN][MAXN],ar[MAXN],tmp;bool operator<(node a,TY b){return a.x<b;}\nint main(){\n\tn=qr();k=qr();FOR(i,1,n)FOR(j,1,n)w[i][j]=qr();\n\tm=n*n;FOR(i,1,m){u=qr();id[u][qr()]=i;ans[i]=M;}\n\tif(k==2){\n\t\tFOR(i,1,n){\n\t\t\tu=minn(id[1][i],id[i][n]);\n\t\t\tans[u]=minn(ans[u],w[1][i]+w[i][n]);\n\t\t}ROF(i,m-1,1)ans[i]=minn(ans[i],ans[i+1]);\n\t\tFOR(i,1,m)if(ans[i]==M)ans[i]=-1;\n\t\tFOR(i,2,m)qw(ans[i],'\\n');printf(\"-1\");return 0;\n\t}if(k==3){//k<=3 \u7684\u53ef\u4ee5\u76f4\u63a5\u66b4\u529b\uff08\u5176\u5b9e k=4 \u4e5f\u53ef\u4ee5\u653e\u5728\u8fd9\u91cc\u89e3\u51b3\uff09 \n\t\tFOR(i,1,n)FOR(j,1,n){\n\t\t\tu=minn(id[1][i],minn(id[i][j],id[j][n]));\n\t\t\tans[u]=minn(ans[u],w[1][i]+w[i][j]+w[j][n]);\n\t\t}ROF(i,m-1,1)ans[i]=minn(ans[i],ans[i+1]);\n\t\tFOR(i,1,m)if(ans[i]==M)ans[i]=-1;\n\t\tFOR(i,2,m)qw(ans[i],'\\n');printf(\"-1\");return 0;\n\t}FOR(i,1,n)FOR(j,1,n){//\u6c42 dis \u6570\u7ec4 \n\t\tfOR(k,u=0,n)t[k]=0;\n\t\tFOR(k,1,n){\n\t\t\tar[k].x=minn(id[i][k],id[k][j]);\n\t\t\tar[k].y=w[i][k]+w[k][j];\n\t\t\t++t[ar[k].x%n];\n\t\t}fOR(k,1,n)t[k]+=t[k-1];\n\t\tFOR(k,1,n)x[t[ar[k].x%n]--]=k;\n\t\tFOR(k,0,n)t[k]=0;FOR(k,1,n)++t[ar[k].x/n];\n\t\tFOR(k,1,n)t[k]+=t[k-1];//\u7528 sort \u4f1a\u88ab\u5361 log\uff0c\u6240\u4ee5\u9700\u8981\u57fa\u6570\u6392\u5e8f \n\t\tROF(k,n,1)ds[i][j][t[ar[x[k]].x/n]--]=ar[x[k]];\n\t\tfOR(k,1,n)if(ds[i][j][k].x>ds[i][j][k+1].x){printf(\"!!!\");return 0;}\n\t\tFOR(k,1,n){//\u7528\u5355\u8c03\u6808\u53bb\u6389\u91cd\u590d\u5143\u7d20 \n\t\t\tif(u&&ds[i][j][u].x==ds[i][j][k].x){\n\t\t\t\tds[i][j][k].y=minn(ds[i][j][u].y,ds[i][j][k].y);u=~-u;\n\t\t\t}while(u&&ds[i][j][u].y>=ds[i][j][k].y)u=~-u;ds[i][j][u=-~u]=ds[i][j][k];\n\t\t}l[i][j]=u;\n\t}FOR(i,1,n){\n\t\tFOR(j,1,m)ds1[j]=dsn[j]=M;\n\t\tFOR(j,1,n){//\u6c42 dis \u6570\u7ec4 \n\t\t\tp=q=1;while(p<=l[1][j]&&q<=l[j][i]){\n\t\t\t\tu=minn(ds[1][j][p].x,ds[j][i][q].x);\n\t\t\t\tds1[u]=minn(ds1[u],ds[1][j][p].y+ds[j][i][q].y);\n\t\t\t\tif(ds[1][j][p].x<ds[j][i][q].x)p=-~p;\n\t\t\t\telse q=-~q;\n\t\t\t}\n\t\t}ROF(j,m-1,1)ds1[j]=minn(ds1[j],ds1[j+1]);\n\t\tif(k==4){if(i==n)FOR(j,1,m)ans[j]=ds1[j];continue;}//k=4 \u4e0d\u9700\u8981\u7b2c\u4e8c\u6b21 meet-in-middle\uff0c\u76f4\u63a5\u66f4\u65b0\u7b54\u6848\u5373\u53ef \n\t\tif(k==5){//k=5 \u7684\u53e6\u4e00\u8fb9\u5c31\u662f\u539f\u56fe\u7684\u8fb9 \n\t\t\tFOR(j,1,id[i][n])ans[j]=minn(ans[j],ds1[j]+w[i][n]);continue;\n\t\t}if(k==6)FOR(j,1,l[i][n])dsn[ds[i][n][j].x]=ds[i][n][j].y;//k=6 \u7684\u53e6\u4e00\u8fb9\u5c31\u662f dis \u6570\u7ec4 \n\t\telse if(k==7)FOR(j,1,n){\n\t\t\tu=lower_bound(ds[i][j]+1,ds[i][j]+l[i][j]+1,id[j][n])-ds[i][j];\n\t\t\tif(u<=l[i][j])dsn[id[j][n]]=minn(dsn[id[j][n]],ds[i][j][u].y+w[j][n]);\n\t\t\tfOR(k,0,u)dsn[ds[i][j][k].x]=minn(dsn[ds[i][j][k].x],ds[i][j][k].y+w[j][n]);\n\t\t}else FOR(j,1,n){//k=8 \u9700\u8981\u6c42\u7b2c\u4e8c\u904d dis \u6570\u7ec4 \n\t\t\tp=q=1;while(p<=l[i][j]&&q<=l[j][n]){\n\t\t\t\tu=minn(ds[i][j][p].x,ds[j][n][q].x);\n\t\t\t\tdsn[u]=minn(dsn[u],ds[i][j][p].y+ds[j][n][q].y);\n\t\t\t\tif(ds[i][j][p].x<ds[j][n][q].x)p=-~p;\n\t\t\t\telse q=-~q;\n\t\t\t}u=minn(ds[i][j][p].x,ds[j][n][q].x);\n\t\t\tdsn[u]=minn(dsn[u],ds[i][j][p].y+ds[j][n][q].y);\n\t\t}ROF(j,m-1,1)dsn[j]=minn(dsn[j],dsn[j+1]);\n\t\tFOR(j,1,m)ans[j]=minn(ans[j],ds1[j]+dsn[j]);\n\t}FOR(i,1,m)if(ans[i]==M)ans[i]=-1;\n\tFOR(i,2,m)qw(ans[i],'\\n');printf(\"-1\");return 0;\n}\n```",
        "postTime": 1672580798,
        "uid": 184168,
        "name": "xuanxuan001",
        "ccfLevel": 8,
        "title": "\u9898\u89e3P8906\u3010[USACO22DEC] Breakdown P\u3011"
    }
]
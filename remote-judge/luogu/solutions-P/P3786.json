[
    {
        "content": "\u6700\u77ed\u8def\u4f5c\u4e3a\u5e7f\u4e3a\u4eba\u77e5\u7684\u7b97\u6cd5\uff0c\u80af\u5b9a\u4e0d\u53ef\u80fd\u8003\u6a21\u677f\u7684\u5566\uff08~~\u6bd2\u5976\u4e00\u53e3~~\uff09\n\n### \u4eca\u5929\u770b\u5230p3786 \u8403\u9999\u62b1\u897f\u74dc\uff1a \n\n\u524d\u4e24\u5929\u7684\u80e1\u7b56\u9898\uff0c(~~\u6bd2\u7624\u51fa\u9898\u4eba,\u6839\u672c\u4e0d\u7406\u89e3\uff01\uff01\uff01~~\uff09\n\n\u5728\u4e00\u5929\u534a\u4e4b\u540e\uff0c\u6211\u7ec8\u4e8e\" \u505a \"\u6389\u4e86\u4ed6;\n\n\u5176\u5b9e\u5462\u8fd9\u4e2a\u9898\u5e76\u4e0d\u662f\u591a\u4e48\u6bd2\u7624\uff0c\u770b\u5230h ,w \u53ea\u67095\uff01\uff01\uff01, \u9700\u8981\u6740\u7684\u4eba\u5c0f\u4e8e10\u4e2a\uff01\uff01\n\n\u4f60\u6709\u4ec0\u4e48\u60f3\u6cd5\u5462\uff01\uff01\n\n\u72b6\u538b\u5c31\u5b8c\u4e86\n\n### \u4e3b\u9898\u601d\u8def\uff1a \u72b6\u538b+spfa\uff1b\n\n\u5173\u952e\u53d8\u91cf\uff1a\n\ndis[x][y][t][S]\n//\u524d\u4e09\u7ef4\u4e0d\u591a\u8bf4\u6700\u540e\u4e00\u7ef4\u8bb0\u72b6\u6001\uff1b\n\u6709\u4e86\u8fd9\u4e2a\uff01\uff01\n\u4f60\u4e5f\u53ef\u4ee5\u60f3\u5230vis\u6570\u7ec4\u7684\u9b54\u6539\u7248\uff1b\nvis[x][y][t][s];\n\n\u8fd9\u4e2a\u601d\u8def\u5462\u4f60\u53ef\u4ee5\u53bb\u505a\u505a\n\uff08bfs\u597d\u9898[p1301 \u9b54\u9b3c\u4e4b\u57ce](https://www.luogu.org/problem/P1301)\uff09\n\n\u7a7a\u95f4\u591f\u5927\u5c31\u7528\u7a7a\u95f4\u6765\u6362\u65f6\u95f4!!!\n\n\u5e76\u4e14\u8fd8\u80fd\u4fdd\u8bc1\u4f60\u7b54\u6848\u7684\u6b63\u786e\u6027\uff01\uff01\n\n\u8840\u8d5a\u4e0d\u4e8f\uff1b\n\n\u5269\u4e0b\u7684\u9700\u8981\u4e00\u4e2amap[x][y][t] \u6765\u8bb0\u5f55\u70b9\n\n\u6ce8\u610f\u4e0d\u80fd\u62b1\u8d70\u7684\u897f\u74dc \u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2awm_big\u968f\u4fbf\u5f00\u4e00\u4e2a\u503c\u53ea\u8981\u4e0d\u4f1a\u548c\u5c0f\u897f\u74dc\u91cd\u590d\n\n\u5269\u4e0b\u7684\u53ef\u4ee5\u62b1\u8d70\u7684\u897f\u74dc\u5c31\u53ef\u4ee5\u6309\u7167\u8f93\u5165\u7684\u987a\u5e8f\u6765\u7f16\u53f7cnt  \n\n\u7136\u540emap[x][y][t]=(1<<(cnt-1))\n\n\u6ce8\u610f\u4f4d\u8fd0\u7b97\u7684\u987a\u5e8f\n\n\u5269\u4e0b\u7684\u5c31\u53ef\u4ee5\u6839\u636e\u697c\u4e0a\u795e\u4ed9\u4eec\u7684\u9898\u89e3\u4ee3\u7801\u6765\u7406\u89e3\u4e86\n\u6211\u5c31\u4e0d\u8d34\u4e86\uff1b\n",
        "postTime": 1571145465,
        "uid": 123841,
        "name": "lwyz123",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3786 \u3010\u8403\u9999\u62b1\u897f\u74dc\u3011"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/LaoMang-no-blog/p/15379823.html)\r\n\r\n**\u7b97\u6cd5\uff1a\u72b6\u538b + \u4e09\u7ef4 bfs**\r\n\r\n\u8fd9\u9053\u9898\u76ee\u867d\u7136\u9876\u7740\u7d2b\u9898\u7684\u540d\u5934\uff0c\u4f46\u662f\u96be\u5ea6\u5374\u53ea\u6709\u9ec4\u9898\u6216\u7eff\u9898\u5de6\u53f3\uff0c\u601d\u7ef4\u548c\u7801\u91cf\u90fd\u9002\u4e2d\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u666e\u8f6c\u63d0\u7684\u9898\u76ee\u6765\u5237\u3002\r\n\r\n\u901a\u8fc7\u89c2\u5bdf\u6570\u636e\u89c4\u6a21\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u6574\u4e2a\u6570\u636e\u89c4\u6a21\u5f88\u5c0f\uff0c\u5730\u56fe\u548c\u65f6\u95f4\u90fd\u53ea\u6709 $100$ \uff0c\u8981\u62ff\u7684\u897f\u74dc\u53ea\u6709 $10$ \u4e2a\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u601d\u8003\u4e8c\u8fdb\u5236\u72b6\u538b\u5b58\u50a8\u67d0\u4e2a\u897f\u74dc\u6709\u6ca1\u6709\u88ab\u62ff\u8fc7\u3002\r\n\r\n\u89c2\u5bdf\u9898\u9762\uff0c\u628a\u65f6\u95f4\u8f6c\u5316\u6210\u4e00\u7ef4\u5b58\u8d77\u6765\uff0c\u53d1\u73b0\u8fd9\u9053\u9898\u662f\u4e00\u9053\u4e09\u7ef4\u6700\u77ed\u8def\uff0c\u5176\u4e2d\u8fb9\u6743\u53ea\u6709 $0$\uff08\u539f\u5730\u7b49\u5f85\uff09\u548c $1$\uff08\u5411\u56db\u4e2a\u65b9\u5411\u79fb\u52a8\uff09\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f88\u81ea\u7136\u5730\u60f3\u5230\u53cc\u7aef\u961f\u5217 bfs \u89e3\u51b3\uff0c\u63a5\u4e0b\u6765\u8fd9\u9053\u9898\u5c31\u89e3\u51b3\u4e86\u3002\r\n\r\n### \u590d\u6742\u5ea6\u5206\u6790\r\n\r\nbfs \u7684\u590d\u6742\u5ea6\u53d6\u51b3\u4e8e\u72b6\u6001\u6570\uff0c\u672c\u9898\u72b6\u6001\u5f00\u4e86\u56db\u7ef4\uff0c\u5206\u522b\u662f\u4e00\u7ef4\u65f6\u95f4\uff0c\u4e24\u7ef4\u5730\u56fe\uff0c\u518d\u52a0\u4e00\u7ef4\u72b6\u538b\u8868\u793a\u897f\u74dc\u6709\u6ca1\u6709\u62ff\u8fc7\uff0c\u4f46\u56e0\u4e3a\u5927\u897f\u74dc\u963b\u6321\u7b49\u56e0\u7d20\uff0c\u4e0d\u4e00\u5b9a\u8dd1\u6ee1\uff0c\u6240\u4ee5\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f $\\text{O}(nms\\cdot2^{c_2})$ \uff0c\u7a7a\u95f4\u590d\u6742\u5ea6\u662f $\\Theta(nms\\cdot2^{c_2})$\r\n\r\n[c++ \u4ee3\u7801](https://www.cnblogs.com/LaoMang-no-blog/p/15379823.html)",
        "postTime": 1633680625,
        "uid": 310525,
        "name": "\u8001\u83bd\u83bd\u7a7f\u4e00\u5207",
        "ccfLevel": 0,
        "title": "P3786 \u8403\u9999\u62b1\u897f\u74dc \u9898\u89e3"
    },
    {
        "content": "##\u72b6\u6001\u538b\u7f29+spfa\n\n\u8003\u8651\u5230\u897f\u74dc\u7684\u6570\u91cf\u5f88\u5c11,\u53ef\u884c\u7684\u897f\u74dcm<=10;\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u9700\u8981\u62ff\u8d70\u7684\u897f\u74dc\u6211\u4eec\u7ed9\u4ed6\u4e00\u4e2a\u91cd\u65b0\u7684\u7f16\u53f70~m-1;\u5bf9\u8fd9m\u4e2a\u897f\u74dc\u7528\u4e00\u4e2a\u5355\u72ec\u6ca1\u6709\u51fa\u73b0\u8fc7\u7684\u4e8c\u8fdb\u5236\u7684\u4e00\u4f4d\u8868\u793a\u3002\u4e8e\u662f\u62ff\u8d70\u897f\u74dc\u5e76\u5224\u65ad\u4ee5\u524d\u6709\u65e0\u62ff\u8fc7\u8fd9\u4e2a\u897f\u74dc\u5c31\u662f\u5f53\u524d\u5df2\u7ecf\u62ff\u7684\u72b6\u6001now\u6216**( | )**\u5f53\u524d\u897f\u74dc\u6240\u5728\u7684\u4e8c\u8fdb\u5236\u4f4d,\u6240\u5f97\u7684\u6570\u5c31\u662f\u5f53\u524d\u62ff\u5230\u897f\u74dc\u7684\u72b6\u6001\u3002\n\n\u5bf9\u4e8e\u6ca1\u6709\u897f\u74dc\u7684\u4f4d\u7f6e\u5f53\u524d\u4f4d\u7f6e\u662f0(\u5f53\u524d\u6570**\u6216(|)**0\u8fd8\u662f\u4ed6\u672c\u8eab),\u8d70\u5230\u6ca1\u6709\u897f\u74dc\u7684\u4f4d\u7f6e\u5bf9\u5f53\u524d\u7b54\u6848\u6ca1\u6709\u8d21\u732e\u3002\n\n\n###\u8f6c\u79fb\n\n\u7528dis[i][j][t][now]\u8868\u793a\u5f53\u524d\u6240\u5728\u70b9(i,j)\u65f6\u95f4\u4e3at,\u5f53\u524d\u5df2\u62ff\u5230\u897f\u74dc\u7684\u72b6\u6001\u4e3anow,\u5f53\u524d\u7684\u897f\u74dc\u7528x\u8868\u793a``(x=1<<y)y\u662f\u91cd\u65b0\u5206\u914d\u540e\u5f53\u524d\u897f\u74dc\u7684\u7f16\u53f7``\n\n- 1.\u5f53\u524d\u70b9\u7684\u72b6\u6001\u662fnow,\u5f53\u524d\u6240\u5728\u70b9\u4e0b\u4e00\u79d2\u6709\u4e00\u4e2a\u897f\u74dc,\u4e8e\u662f\u5c31\u6709dis[i][j][t+1][now|x]=dis[i][j][t][now](\u6ca1\u897f\u74dcx=0)\n\n- 2.\u5f53\u524d\u70b9\u7684\u72b6\u6001\u662fnow,\u8981\u5230\u8fbe\u7684\u5730\u70b9(to\\_x,to\\_y)\u4e0a\u6709\u4e00\u4e2a\u53ef\u83b7\u5f97\u7684\u897f\u74dc(x),\u90a3\u4e48\u5230\u8fbe\u8fd9\u4e2a\u70b9\u7684\u8f6c\u79fb\u662fdis[to\\_x][to\\_y][t+1][now|x]=dis[i][j][t][now]+1\n\n- 3.\u5f53\u524d\u70b9\u7684\u72b6\u6001\u662fnow,\u8981\u5230\u8fbe\u7684\u5730\u70b9(to\\_x,to\\_y)\u4e0a\u6709\u4e00\u4e2a\u4e0d\u53ef\u83b7\u5f97\u7684\u897f\u74dc,\u90a3\u4e48\u8fd9\u4e2a\u70b9\u4e0d\u80fd\u8f6c\u79fb.\n\n- 4.\u5f53\u524d\u70b9\u7684\u72b6\u6001\u662fnow,\u8981\u5230\u8fbe\u7684\u5730\u70b9(to\\_x,to\\_y)\u6ca1\u6709\u897f\u74dc,dis[to\\_x][to\\_y][t+1][now]=dis[i][j][t][now]+1\n\n- \u8fd9\u6837\u901a\u8fc7\u4e0a\u9762\u76844\u6b65\u5c31\u53ef\u4ee5\u4f7f\u5728\u5f53\u524d\u72b6\u6001\u5408\u6cd5,~~\u4e0d\u7528\u8003\u8651\u540e\u7eed~~\n\n\n\u4e8e\u662f\u60f3\u5230\u53ef\u884c\u7684\u72b6\u6001\u5f88\u5c11,\u5c31\u53ef\u4ee5\u91c7\u7528bfs,\u6765\u5b9e\u73b0\u8f6c\u79fb\u4f18\u5316,spfa,\u4ece(sx,sy)\u5f00\u59cb\u628a\u5f53\u524d\u72b6\u6001&\u65f6\u95f4,\u5f53\u524d\u6240\u5230\u7684\u70b9\u538b\u6210\u7ed3\u6784\u4f53\u653e\u8fdb\u961f\u5217.\u6700\u540e\u62ff\u5230\u6240\u6709\u897f\u74dc\u7684\u72b6\u6001\u5c31\u662fdis[1~h][1~w][T][(1<<m)-1]\n\n\u56e0\u4e3a\u7528\u5230\u4e86spfa,\u6240\u4ee5\u6700\u7ec8\u5f97\u5230\u7684\u4e00\u5b9a\u662f\u6700\u5c0f\u7684\u7b54\u6848\u3002\n\n\u7279\u6b8a\u7684,\u5f53\u521d\u59cb\u70b9\u6709\u4e00\u4e2a\u4e0d\u53ef\u83b7\u5f97\u7684\u897f\u74dc\u65f6\u6216\u6700\u540e\u5f97\u5230\u7684\u7b54\u6848\u662fINF,\u8f93\u51fa-1\u3002(\u4e0d\u53ef\u5230\u8fbe)\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<algorithm>\n#include<cstring>\n#include<queue>\n#define ll long long\nconst int Suika_big=2333333;\nconst int maxx=1<<20;\nusing namespace std;\nconst int tx[6]={0,0,0,1,-1};\nconst int ty[6]={0,1,-1,0,0};\ninline int read(){\n    int an=0,f=1;\n    char ch=getchar();\n    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n    while('0'<=ch&&ch<='9'){an=(an<<3)+(an<<1)+ch-'0';ch=getchar();}\n    return an*f;\n}\nint map[7][7][109],dis[7][7][109][1<<12];\nint n,m,h,w,sx,sy,T,cnt;\nint ans=maxx;\nbool flag;\nbool vis[7][7][109][1<<12];\nvoid prepare(){\n    h=read();w=read();T=read();sx=read();sy=read();\n    n=read();m=read();\n    for(int i=1;i<=n;i++){\n        int xx;\n        int t1=read(),t2=read(),Suika_p=read();\n        if(Suika_p)cnt++,xx=1<<cnt-1;\n        else xx=Suika_big;\n        for(int j=t1;j<=min(T,t2-1);j++){\n            int x=read(),y=read();\n            map[x][y][j]=xx;\n        }\n    }\n    if(map[sx][sy][1]==Suika_big){\n        cout<<\"-1\";flag=1;return;\n    }\n    for(int i=0;i<=h;i++)\n    for(int j=0;j<=w;j++)\n    for(int t=1;t<=T;t++)\n    for(int l=0;l<=(1<<m);l++)\n    dis[i][j][t][l]=maxx;\n}\nstruct saber{\nint x,y,Suika,t;\n}now;\nqueue<saber>q;\nvoid spfa(){\n    q.push((saber){sx,sy,map[sx][sy][1],1});\n    dis[sx][sy][1][map[sx][sy][1]]=0;\n    while(!q.empty()){\n        now=q.front();q.pop();\n        vis[now.x][now.y][now.t][now.Suika]=0;\n        if(now.t>T)continue;\n        for(int i=0;i<=4;i++){\n            int xx=now.x+tx[i];\n            int yy=now.y+ty[i];\n            int melon=now.Suika;\n            if(xx<1||yy<1)continue;\n            if(xx>h||yy>w)continue;\n            int t=now.t+1;\n            if(map[xx][yy][t]==Suika_big)continue;\n            int diss=dis[now.x][now.y][now.t][now.Suika]+(i!=0);\n            melon|=map[xx][yy][t];\n            if(dis[xx][yy][t][melon]>diss){\n                dis[xx][yy][t][melon]=diss;\n                if(!vis[xx][yy][t][melon]){\n                    q.push((saber){xx,yy,melon,t});\n                    vis[xx][yy][t][melon]=1;\n                }\n            }\n        }\n    }\n}\nint main(){\n    prepare();\n    if(flag){return 0;}\n    spfa();\n    for(int i=1;i<=h;i++)\n        for(int j=1;j<=w;j++)\n        ans=min(ans,dis[i][j][T][(1<<m)-1]);\n    if(ans==maxx)cout<<\"-1\";\n    else cout<<ans;\n    return 0;\n}\n```\n~~\u4f3c\u4e4e\u51fa\u9898\u4eba\u6ca1\u6709\u8003\u8651\u5230\u7ad9\u7684\u521d\u59cb\u4f4d\u7f6e\u6709\u4e00\u4e2a\u5c0f\u897f\u74dc\u7684\u70b9,\u88ab\u6ca1\u8003\u8651\u7684\u540c\u5b66\u8fc7\u53bb\u4e86,\u819c\u62dc\u51fa\u9898\u4eba~~\n",
        "postTime": 1508245366,
        "uid": 24570,
        "name": "s_a_b_e_r",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3786 \u3010\u8403\u9999\u62b1\u897f\u74dc\u3011"
    },
    {
        "content": "\u5b50\u4efb\u52a11:\u6240\u6709\u897f\u74dc\u59cb\u7ec8\u51fa\u73b0\u4e14\u4e0d\u52a8\uff0c\u5e76\u4e14\u6ca1\u6709\u8981\u62b1\u8d70\u7684\u3002\n\n\u89e3\u6cd5:\u53ea\u9700\u8981\u5224\u65ad\u521d\u59cb\u4f4d\u7f6e\u662f\u5426\u88ab\u5927\u897f\u74dc\u6321\u4f4f\uff0c\u6321\u4f4f\u8f93\u51fa-1\uff0c\u5426\u5219\u8f93\u51fa0\u5373\u53ef\n\n\u5b50\u4efb\u52a12~3:\u6240\u6709\u897f\u74dc\u59cb\u7ec8\u51fa\u73b0\u4e14\u4e0d\u52a8\u3002\n\n\u89e3\u6cd5:\u7531\u4e8e\u8981\u62b1\u8d70\u7684\u897f\u74dc\u6700\u591a\u4e3a10\u4e2a\uff0c\u8003\u8651\u7528\u957f\u5ea6\u4e3a10\u76840/1\u4e32\u6765\u8868\u793a\u67d0\u4e2a\u897f\u74dc\u662f\u5426\u5df2\u7ecf\u83b7\u53d6\u3002\u72b6\u538bspfa\u6216dp\u5373\u53ef\u89e3\u51b3\u3002\n\n\u5b50\u4efb\u52a14~5:\u6ca1\u6709\u9700\u8981\u62b1\u8d70\u7684\u897f\u74dc\n\n\u89e3\u6cd5:\u5c06\u65f6\u95f4\u770b\u505a\u4e00\u4e2a\u7ef4\u5ea6\uff0c\u6784\u5efa\u597d\u4e09\u7ef4\u7684\u5730\u56fe\uff0c\u628a\u897f\u74dc\u770b\u505a\u969c\u788d\uff0c\u505a\u4e09\u7ef4\u7684\u6700\u77ed\u8def\u6216dp\u5373\u53ef\u3002\n\n\u6b63\u89e3:\n\n\u7ed3\u5408\u5b50\u4efb\u52a12~3\u548c4~5\u7684\u505a\u6cd5\uff0c\u505a\u4e00\u4e2a\u56db\u7ef4\u7684\u72b6\u538b\u6700\u77ed\u8def\u6216dp\u5373\u53ef\u89e3\u51b3\u3002\n\n\u4ee3\u7801:\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<queue>\nusing namespace std;\nint mp[6][6][103];\nint dis[6][6][103][1024];\nbool vis[6][6][103][1024];\nconst int dx[5]={0,1,-1,0,0};\nconst int dy[5]={0,0,0,1,-1};\nint my,mx,T,sx,sy;\nint n,m;\n```\n/\\*0x3f3f3f3f empty\n233 big melon\n\n0~m-1 small melon\n\n\\*/\n```cpp\nint cnt=-1;\nqueue<int>q;\nvoid spfa()\n{\n    q.push(1*100+sx*10+sy);\n    memset(dis,0x3f,sizeof(dis));\n    dis[sx][sy][1][0]=0;\n    while(!q.empty())\n    {\n        int now=q.front();\n        q.pop();\n        int nows=now/100000;\n        int nowt=(now%100000)/100;\n        int nowx=(now%100)/10;\n        int nowy=now%10;\n        //cout<<nowx<<\" \"<<nowy<<\" \"<<nowt<<\" \"<<nows<<endl;\n        vis[nowx][nowy][nowt][nows]=0;\n        if(nowt==T)continue;\n        for(int f=0;f<5;++f)\n        {\n            int nexx=nowx+dx[f];\n            int nexy=nowy+dy[f];\n            int next=nowt+1;\n            int nexs;\n            if(nexx<1||nexx>mx)continue;\n            if(nexy<1||nexy>my)continue;\n            if(mp[nexx][nexy][next]==233)continue;\n            if(mp[nexx][nexy][next]==0x3f3f3f3f)nexs=nows;\n            else nexs=nows|(1<<mp[nexx][nexy][next]);\n            if(dis[nexx][nexy][next][nexs]<=dis[nowx][nowy][nowt][nows]+!!f)continue;\n            dis[nexx][nexy][next][nexs]=dis[nowx][nowy][nowt][nows]+!!f;\n            if(!vis[nexx][nexy][next][nexs])\n            {\n                vis[nexx][nexy][next][nexs]=true;\n                q.push(nexs*100000+next*100+nexx*10+nexy);\n            }\n        }\n    }\n}\nint main()\n{\n    scanf(\"%d%d%d%d%d\",&my,&mx,&T,&sx,&sy);\n    scanf(\"%d%d\",&n,&m);\n    memset(mp,0x3f,sizeof(mp));\n    for(int i=1;i<=n;++i)\n    {\n        int t1,t2,a;\n        scanf(\"%d%d\",&t1,&t2);\n        scanf(\"%d\",&a);\n        if(a==0)a=233;\n        else a=++cnt;\n        for(int i=t1;i<t2;++i)\n        {\n            int x,y;\n            scanf(\"%d%d\",&x,&y);\n            mp[x][y][i]=a;\n        }\n    }\n    if(mp[sx][sy][1]==233)\n    {\n        printf(\"-1\\n\");\n        return 0;\n    }\n    spfa();\n    int ans=0x3f3f3f3f;\n    for(int i=1;i<=mx;++i)\n        for(int j=1;j<=my;++j)\n            ans=min(ans,dis[i][j][T][(1<<m)-1]);\n    if(ans==0x3f3f3f3f)ans=-1;\n    printf(\"%d\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1495369429,
        "uid": 20322,
        "name": "orangebird",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3786 \u3010\u8403\u9999\u62b1\u897f\u74dc\u3011"
    },
    {
        "content": "\u6bcf\u4e2a\u65f6\u523b\u6bcf\u4e2a\u897f\u74dc\u90fd\u4e0d\u4e00\u6837\uff0c\u6240\u4ee5\u8981\u5206\u522b\u5904\u7406\u3002\u663e\u7136\u53ef\u4ee5\u72b6\u538b\u5f53\u524d\u5df2\u7ecf\u62b1\u8d70\u4e86\u54ea\u4e9b\u897f\u74dc\uff0c\u4e8e\u662f dp \u5373\u53ef\u3002\u72b6\u538b\u7684\u65f6\u5019\uff0c\u8981\u5904\u7406\u5f53\u524d\u4f4d\u7f6e\u4e0a\u6709\u897f\u74dc\u7684\u60c5\u51b5\uff0c\u8981\u62b1\u8d70\u3002\n\n$$f[t][x][y][S | 2^{m[x][y]}]=\\min \\{ f[t-1][dx][dy][S]+1,  f[t-1][x][y][S] \\} $$\n\n```cpp\nint dp[105][6][6][1 << 10];\nint flag[105][6][6];\nint h, w, T, sx, sy;\nint n, m;\nconst int dx[4] = {1, 0, -1, 0}, dy[4] = {0, 1, 0, -1};\n\nint main() {\n    ms(dp, 0x3f); ms(flag, 0xc0);\n    rd(h, w, T, sx, sy, n, m);\n    int mCnt = 0;\n    U (i, 1, n) {\n        int t1, t2, a; rd(t1, t2, a);\n        U (j, t1, t2 - 1) {\n            int x, y; rd(x, y);\n            flag[j][x][y] = a ? mCnt : -1;\n        }\n        mCnt += a;\n    }\n    dp[1][sx][sy][0] = 0 | ((flag[1][sx][sy] >= 0) ? (1 << (flag[1][sx][sy])) : 0);\n    U (t, 2, T) U (x, 1, w) U (y, 1, h) if (flag[t][x][y] != -1) \n        U (s, 0, (1 << m) - 1) {\n            int cs = s | ((flag[t][x][y] >= 0) ? (1 << flag[t][x][y]) : 0);\n            dp[t][x][y][cs] = min(dp[t][x][y][s], dp[t - 1][x][y][s]);\n            U (i, 0, 3) {\n                int cx = x + dx[i], cy = y + dy[i];\n                if (cx < 1 || cy < 1 || cx > w || cy > h) continue;\n                dp[t][x][y][cs] = min(dp[t][x][y][cs], dp[t - 1][cx][cy][s] + 1);\n            }\n        }\n    int ans = 0x3f3f3f3f;\n    U (x, 1, w) U (y, 1, h)\n        ans = min(ans, dp[T][x][y][(1 << m) - 1]);\n    printf(\"%d\", (ans == 0x3f3f3f3f) ? -1 : ans);\n    return 0;\n}\n```\n\n[~~\u968f\u4fbf\u5199\u5199\u5c31\u51b2\u5230\u6700\u4f18\u89e3\u699c\u4e8c\u4e86\u3002~~](https://www.luogu.com.cn/record/77870423)",
        "postTime": 1656133642,
        "uid": 120324,
        "name": "Yansuan_HCl",
        "ccfLevel": 7,
        "title": "[\u9898\u89e3] P3786 \u8403\u9999\u62b1\u897f\u74dc"
    },
    {
        "content": "## \u9898\u9762 \n- \u4e00\u4e2a $w\\times h$ \u7684\u77e9\u9635\uff0c\u77e9\u9635\u4e2d\u5b58\u5728\u53ef\u79fb\u52a8\u7684 $0$ \u70b9 \u548c $1$ \u70b9\n\n- $0$\u70b9\u4e0d\u53ef\u5230\u8fbe\uff0c$1$ \u53ef\u5230\u8fbe\n\n- \u7ed9\u5b9a\u4e00\u4e2a\u8d77\u70b9 $(sx,sy)$, \u6c42\u7ed9\u5b9a\u65f6\u95f4 $T$ \u5185\u53ef\u5230\u8fbe $m$ \u4e2a  $1$ \u6240\u7528\u7684\u6700\u5c0f\u6b65\u6570\n\n## \u6570\u636e\u8303\u56f4\n>> $1\\le h,\\  w\\le 5,\\  1\\le T\\le 100,\\ 1\\le t1\\le T$\n>> \n>> $2\\le t,\\ 2\\le T+1,\\ t1<t2$\n>> \n>> $1\\le n\\le 20,\\ 0\\le m\\le 10,\\ m\\le n$\n\n## \u601d\u8def\n- \u6570\u636e\u8303\u56f4\u4e0d\u5927\uff0c\u53ef\u4ee5\u72b6\u538b$DP$\n\n- \u7528\u4e8c\u8fdb\u5236\u6570\u8868\u793a\u5f53\u524d\u5df2\u6709\u897f\u74dc\u7684\u72b6\u6001\uff0c\u8f6c\u79fb\u65f6\u5c31\u9700\u8981\u4f4d\u8fd0\u7b97 \n\n- $$f[t][i][j][k]$$ \n\n- \u8868\u793a\u5728 $T$ \u65f6\u523b,\u5750\u6807\u4e3a\uff08$i ,j$\uff09\u70b9\u4e0a\u5df2\u7ecf\u83b7\u5f97 $k$ \u4e2a\u897f\u74dc\u7684\u6700\u5c0f\u6b65\u6570\n\n- \u6211\u4eec\u53ef\u7528\u4ee5\u4e2a $s[t][i][j]$ \u8bb0\u5f55 $T$ \u65f6\u523b,\u5750\u6807\u4e3a\uff08$i ,j$) \u70b9\u4e0a\u53ef\u83b7\u5f97\u897f\u74dc\u7684\u6570\u91cf\n\n- \u56e0\u6b64\u5c31\u53ef\u65b9\u7a0b\u8f6c\u79fb\u5566\n\n- $$f[t][i][j][k \\ |\\  s[t][i][j]] = min{(f[t - 1][qx][qy][k])+1}$$\n\n-  ($qx\\ qy$)\u8868\u793a $T - 1$ \u65f6\u523b\u7684\u4f4d\u7f6e\n\n- \u5b57\u9762\u4e0a\u8bf4\uff0c\u5f53\u524d\u72b6\u6001\u662f\u7531$f[t-1][i][j][k]$\u72b6\u6001 $+1$ \u8f6c\u79fb\u6765\u7684\n\n- \u521d\u59cb\u72b6\u6001\u662f$f[1][sx][sy][s[1][sx][sy]]\\ =\\ 0$,\u5176\u4ed6\u4e3a $INF$\n\n## Code\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <string.h>\nusing namespace std;\ntypedef long long ll;\nconst int inf = 0x3f3f3f3f;\ninline int read() {\n  char c = getchar(); int x = 0, f = 1;\n  for ( ; !isdigit(c); c = getchar()) if (c == '-') f = -1;\n  for ( ; isdigit(c); c = getchar()) x = x * 10 + (c ^ 48);\n  return x * f;\n}\nint sum,h,w,t,sx,sy,n,m,t1[manx],t2[manx];\nint dx[5] = {0, 0, 0, 1, -1};\nint dy[5] = {0, 1, -1, 0, 0};\nint s[109][10][10],f[109][10][10][(1 << 10) + 1];\nint main(){\n\th = read();w = read();t = read();sx = read();sy = read();n = read();m = read();\n\t//\u9884\u5904\u7406\u90e8\u5206 \n\tfor(int i = 1;i <= n; i++){\n\t\tt1[i] = read();t2[i] = read();\n\t\tint p = read();\n\t\tif(p) sum ++;\n\t\tfor(int j = t1[i];j < t2[i]; j++){\n\t\t\tint x = read(),y = read();\n\t\t\tif(p == 0) s[j][x][y] = -1;//\u53ea\u8981\u5f53\u524d\u65f6\u95f4\uff08x,y\uff09\u6709\u4e00\u4e2a\u662f\u5927\u897f\u74dc\uff0c\u90a3\u4e48\u8fd9\u4e2a\u683c\u5b50\u5c31\u4e0d\u80fd\u8d70 \n\t\t\telse s[j][x][y] = 1 << (sum - 1);//-1\u7684\u539f\u56e0\u540c\u4e0b \n\t\t} \n\t}\n\tif(s[1][sx][sy] == -1){cout<<-1;return 0;} //\u7279\u5224\uff1a\u843d\u5730\u6210\u76d2 \n\tll bz = (1 << m) - 1;//10000000000(10) - 1=111111111(9)\n\tmemset(f, 0x3f, sizeof (f)); //\u521d\u59cb\u5316 \n\tf[1][sx][sy][s[1][sx][sy]] = 0;//\u521d\u59cb\u5316 \n\t//\u6b63\u89e3\u5f00\u59cb \n\tfor(int i = 2; i <= t;i ++) \n\t\tfor(int x = 1;x <= w;x ++)\n\t\t\tfor(int y = 1; y <= h;y ++){\n\t\t\t\tif(s[i][x][y] == -1) continue;\n\t\t\t\tfor(int j = 0;j <=4; j++){\n\t\t\t\t\tint qx = x + dx[j],qy = y + dy[j];\n\t\t\t\t\tif(qx < 1||qy > h||qy < 1|| qx > w) continue;\n\t\t\t\t\tif(s[i - 1][qx][qy] == -1) continue; \n\t\t\t\t\tfor(int k = 0;k <= bz;k ++){\n\t\t\t\t\t\tf[i][x][y][k | s[i][x][y]] = min(f[i][x][y][k | s[i][x][y]],\n\t\t\t\t\t\t\t\t\t\t\t\t\t   f[i - 1][qx][qy][k] + (j > 0)); //\u8f6c\u79fb\u65b9\u7a0b\u5f0f \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\tint ans = f[0][0][0][0];\n\tfor(int x = 1;x <= w; x ++)\n\t\tfor(int y = 1;y <= h; y++){\n\t \t\tans = min(ans,f[t][x][y][bz]); //\u679a\u4e3e\u6ee1\u8db3\u6761\u4ef6\u7684f \n\t\t } \n\tif(ans < inf) cout<<ans;\n\telse cout<<-1;\t\t\t\n\treturn 0;\n}\n\n\n```\n",
        "postTime": 1604555381,
        "uid": 230808,
        "name": "Zxsoul",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P3786 \u3010\u8403\u9999\u62b1\u897f\u74dc\u3011"
    },
    {
        "content": "## \u7591\u70b9\u89e3\u91ca\uff1a\n\n1.\u8003\u8bd5\u7684\u65f6\u5019\u505a\u5230\u4e86\uff0c\u8003\u8bd5\u7684\u65f6\u5019\u6211\u60f3\u5230\u4e86\u72b6\u6001\u538b\u7f29$DP$\uff0c\u7136\u540e\u6211\u89c9\u5f97\uff0c\u897f\u74dc\u7684\u72b6\u6001\u6211\u5c31\u591a\u8bbe\u4e00\u7ef4\u6765\u8868\u5427\uff0c\u597d\u7406\u89e3\uff0c\u8fd8\u5bb9\u6613\u63a8\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff08\u7136\u800c\uff0c\u6211\u5e76\u6ca1\u6709\u63a8\u51fa\u6765\uff0c\u53ea\u597d\u6253\u4e86\u4e2a\u66b4\u529b\uff0c\u9a97\u4e86\u70b9\u5206\uff09\n\n2.\u9996\u5148\u8bf4\u4e00\u4e0b\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u591a\u8bbe\u4e00\u7ef4\u8868\u793a\u72b6\u6001\uff0c\u6309\u5b66\u957f\u7684\u8bdd\uff0c\u5c31\u662f\u591a\u8bbe\u4e00\u7ef4\u7684\u540e\u5bf9\u7b54\u6848\u6ca1\u6709\u8d21\u732e\uff0c\u53ea\u662f\u5224\u65ad\u4e86\u4e0b\u4e00\u4e2a\u70b9\u662f\u80fd\u591f\u8d70\u7f62\u4e86\n\n##   \u89e3\u9898\u601d\u8def\uff1a\n1.\u6211\u4eec\u5bf9\u897f\u74dc\u8fdb\u884c\u72b6\u6001\u538b\u7f29\uff0c\u7136\u540e\u6211\u4eec\u8bbe\u4e00\u4e2aall\u5c06m\u8f6c\u5316\u6210\u72b6\u6001\u538b\u7f29\uff0c\u7136\u540e\u6211\u4eec\u5728\u8bfb\u5165\u7684\u65f6\u5019\uff0c\u8fdb\u884c\u4e00\u4e0b\u9884\u5904\u7406\uff0c\u9884\u5904\u7406\u7684\u5c31\u662f\u7c7b\u4f3c\u4e8e\u753b\u4e00\u4e2a\u5730\u56fe $s$,\u7136\u540e$s_{t,x,y}$\u5c31\u8868\u793a\u5728t\u65f6\u523b,\u5750\u6807\u4e3a$\uff08x,y\uff09$\u7684\u897f\u74dc\u7684\u5b58\u5728\u72b6\u6001\uff1b\n\n 2.\u540c\u65f6\u6211\u4eec\u8bbe\u4e00\u4e2a $f_{time,x,y,sum}$\u8868\u793at\u65f6\u523b\uff0c\u5230\u5750\u6807$\uff08x,y\uff09$\u53d6\u5f97sum\u4e2a\u897f\u74dc\u7684\u6700\u5c0f\u7684\u6b65\u6570\n \n 3.\u540c\u65f6\u6211\u4eec\u6240\u6c42\u7684\u4e3a\u6700\u77ed\u8def\u5f84\uff0c\u90a3\u4e48\u6211\u4eec\u4e5f\u5c31\u53ef\u4ee5\u76f4\u63a5\u5c06$f$\u9884\u5904\u7406\u4e3a\u6700\u5927\u503c\uff0c\u65e2\u80fd\u8dd1\u6700\u77ed\u8def\u8fd8\u80fd\u5224\u65ad\u4e00\u4e0b\u662f\u5426\u80fd\u5f97\u5230 $m$\u4e2a\u897f\u74dc\uff0c\u81ea\u7136\u8981\u662f$ans==inf$ \u90a3\u5c31\u4ee3\u8868\u8d70\u4e0d\u4e86\uff0c\uff08\u65e2\u5305\u542b\u4e0d\u80fd\u5f97\u5230$m$\u4e2a\u897f\u74dc\uff0c\u4e5f\u5305\u542b\u65e0\u8def\u53ef\u8d70\u7684\u60c5\u51b5\uff08\u4e00\u6837\uff0c\u65e0\u8def\u53ef\u8d70\u4e5f\u5c31\u6ca1\u529e\u6cd5\u83b7\u5f97$m$\u4e2a\u897f\u74dc\u4e86\uff09\uff09\n\n4.\u8f6c\u79fb\u65f6\u679a\u4e3e\u6bcf\u4e2a\u65f6\u523b\u6bcf\u4e2a\u4f4d\u7f6e\uff0c\u4ece\u80fd\u5230\u8fbe\u8be5\u4f4d\u7f6e\u7684\u4e0a\u4e2a\u65f6\u523b\u7684\u4f4d\u7f6e (x\u2032,y\u2032) \u8f6c\u79fb\u8fc7\u6765\uff0c\u8fd8\u9700\u8981\u679a\u4e3e\u4e0a\u4e2a\u4f4d\u7f6e\u7684\u5c0f\u897f\u74dc\u72b6\u6001;\n\n\u6240\u4ee5\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5c31\u51fa\u6765\u4e86\uff1a\n### $f_{t,x,y, s| s_{t,x,y}}=min{f_{t-1,x',y's}+1}$;\n\n\u4ee3\u7801\uff1a\n```\n#include <algorithm>\n#include <cctype>\n#include <cstdio>\n#include <cstring>\n#define LL long long\nconst int maxn = 1024 + 1;\nconst int inf = 0x3f3f3f3f;\nconst int dx[5] = {0, 0, 0, 1, -1};\nconst int dy[5] = {0, 1, -1, 0, 0};\nint h, w, t, sx, sy;\nint n, m, all, t1, t2;\nint f[101][10][10][maxn];\nint sum, s[101][10][10];\ninline int read()\n{\n\tint x=0,f=1;char ch=getchar();\n\twhile(!isdigit(ch)){ if(ch=='-') f=-1;ch=getchar();}\n\twhile(isdigit(ch)){ x=x*10+ch-'0';ch=getchar();}\n\treturn x*f;\n}\nvoid swapmin(int &a, int b) \n{\n  if (b < a) a= b;\n}\nvoid prepare() \n{\n  h = read(), w = read(), t = read();\n  sx = read(), sy = read();\n  n = read(), m = read();\n  for (int i = 1; i <= n; ++ i) \n  {\n    t1 = read(), t2 = read();\n    int type = read();\n    if (type) sum ++;\n    for (int j = t1; j < t2; ++ j) \n\t{\n      int x = read(), y = read();\n      if(type)\n      {\n      \ts[j][x][y]=(1<<(sum-1));\n\t  }\n\t  else \n\t  {\n\t  \ts[j][x][y]=-1;\n\t  }\n    }\n  }\n}\nint main() \n{\n  prepare();\n  if (s[1][sx][sy] == -1) \n  {\n    printf(\"-1\");\n    return 0;\n  }\n  \n  all = (1 << m) - 1;\n  memset(f, 0x3f, sizeof (f));\n  f[1][sx][sy][s[1][sx][sy]] = 0;\n  for (int i = 2; i <= t; ++ i) \n  {\n    for (int x = 1; x <= w; ++ x) \n\t{\n      for (int y = 1; y <= h; ++ y) \n\t  {\n        if (s[i][x][y] == -1) continue ;\n        for (int j = 0; j <= 4; ++ j) \n\t\t{\n          int fx = x + dx[j], fy = y + dy[j];\n          if (fx < 1 || fx > w || fy < 1 || fy > h) continue ;\n          if (s[i - 1][fx][fy] == -1) continue ;\n          for (int k = 0; k <= all; ++ k) \n\t\t  {\n\t\t\t  \tswapmin(f[i][x][y][k | s[i][x][y]],f[i - 1][fx][fy][k]+(j>0));\n\t\t\t  //\u5426\u5219\u5c31\u662f\u539f\u5730\u4e0d\u52a8\uff0c \n          }\n        }\n      }\n    }\n  }\n  \n  int ans = f[0][0][0][0];\n  for (int x = 1; x <= w; ++ x) \n  {\n    for (int y = 1; y <= h; ++ y) \n\t{\n      swapmin(ans, f[t][x][y][all]);\n    }\n  }\n  printf(\"%d\\n\", ans < inf ? ans : -1);\n  return 0;\n}\n```",
        "postTime": 1604542566,
        "uid": 174683,
        "name": "\u7ea2\u5c18\u4ed9",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3786 \u3010\u8403\u9999\u62b1\u897f\u74dc\u3011"
    },
    {
        "content": "### \u53c8\u662f\u4e00\u9053\u5f88\u597d\u7684\u7ec3\u72b6\u538bDP\u7684\u9898\n\n\u9898\u76ee\u5927\u610f\u5c31\u662f\u6709\u4e00\u4e2a\u4eba\uff0c\u4ed6\u9700\u8981\u62b1\u8d70\u5168\u90e8m\u4e2a\u897f\u74dc\uff0c\u4f46\u662f\u8fd8\u6709n-m\u4e2a\u897f\u74dc\u4e0d\u53ef\u4ee5\u62b1\uff0c\u9700\u8981\u8eb2\u907f\u3002\u9898\u76ee\u4f1a\u7ed9\u51fa\u4f60\u5728\u6bcf\u4e2a\u65f6\u523b\u65f6\u897f\u74dc\u7684\u4f4d\u7f6e\uff0c\u800c\u8fd9\u4e2a\u4eba\u6bcf\u4e2a\u65f6\u523b\u53ef\u4ee5\u9009\u62e9\u4e0d\u52a8\u6216\u5411\u5468\u56f4\u56db\u4e2a\u65b9\u5411\u79fb\u52a8\u3002\n\n\u73b0\u7ed9\u5b9a\u4f60\u521d\u59cb\u4f4d\u7f6e\uff0c\u6c42t\u65f6\u523b\u540e\u4ed6\u80fd\u4e0d\u80fd\u62b1\u8d70\u6240\u6709\u897f\u74dc\uff1f\u5982\u679c\u80fd\u5c31\u8f93\u51fa\u6700\u5c11\u64cd\u4f5c\u6b21\u6570\u3002\n\n\u6570\u636e\u8303\u56f4\u5730\u56fe1<=x,y<=5,0<=m<=10,1<=n<=20\uff0c1<=t<=100\n\n\u662f\u4e0d\u662f\u6570\u636e\u8303\u56f4\u6781\u5c0f\uff01\uff01\uff01\n\n\u6b63\u5e38\u60c5\u51b5\u4e0b\u8bb0\u5fc6\u5316\u641c\u7d22+DP\u6216\u72b6\u538bDP\u6216\u4f18\u5316\u7684\u6700\u77ed\u8def+DP\u90fd\u662f\u53ef\u4ee5\u7684\n\n\u4f46\u662f\u5f52\u6839\u7ed3\u5e95\uff0c\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u662f\u4e00\u6837\u7684\n\n\u56e0\u4e3a\u6709t\u65f6\u523b\uff0c\u8fd8\u8981\u8bb0\u5f55\u6bcf\u4e2a\u65f6\u523b\u7684\u4f4d\u7f6e\u4e0e\u72b6\u6001\n\n\u6240\u4ee5dp[i][j][t][s]\u5e94\u7136\u800c\u751f\n\n\u4ed6\u8868\u793at\u65f6\u523b\u5230(i,j)\u8fd9\u4e2a\u4f4d\u7f6e\u5df2\u53d6\u8fc7\u7684\u897f\u74dc\u72b6\u6001\u4e3as\u7684\u6700\u77ed\u8def\n\n\u8bb0\u5f97\u662f\u5df2\u53d6\u8fc7\u7684\u897f\u74dc\uff01\uff01\uff01n-m\u4e2a\u9700\u8981\u8eb2\u907f\u7684\u5927\u897f\u74dc\u4e0d\u9700\u8981\u53d6\uff0c\u4e5f\u5c31\u4e0d\u9700\u8981\u72b6\u538b\uff0c\u6211\u4eec\u53ea\u9700\u5728\u8f6c\u79fb\u7684\u65f6\u5019\u5728\u5730\u56fe\u4e0a\u5224\u65ad\u4e00\u4e0b\u5c31\u597d\u4e86\n\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e5f\u5f88\u597d\u60f3\uff0c\n\ndp[ i ][ j ][ t ][ s ] = min(dp[ i-p ][ j-q ][ t-1 ][ s^k ])\n\n\u5176\u4e2dp={ 0 , -1 , 1 , 0 , 0 };\n\n\u76f8\u5e94q={ 1 , 0 , 0 , 1 , -1 , 1};\n\nk\u2208s\u4e14map[i-p][j-q]=k,\u4e5f\u5c31\u662f\u6709k\u53f7\u897f\u74dc\u53ef\u4ee5\u53d6\n\n\u4ee3\u7801\u5b9e\u73b0\u90e8\u5206\u53ef\u4ee5\u8003\u8651\u7528\u7eafO(h\u00d7w\u00d7t\u00d7(1<<10))\u66b4\u529bDP\u53ef\u4ee5\u5b9e\u73b0\n\n\uff08\u672c\u4eba\u5c31\u662f\u8fd9\u4e48\u505a\u7684\uff09\n\n\u6216s_a_b_e_r \u5927\u4f6c\u7684SPFA\u8f6c\u79fb\u4e5f\u662f\u4e00\u6837\u7684\uff0c\u56e0\u4e3a\u6570\u636e\u8303\u56f4\u5c0f\n\n\u597d\u4e86\u4e0d\u591a\u8bf4\uff0c\u4ee3\u7801\u90e8\u5206\uff08s_a_b_e_r\u5927\u4f6c\u961f\u5217\u5f0f\uff09\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<queue>\n#define ll long long\nusing namespace std;\nstruct node{\n\tint x,y,num,t;\n}now;\nqueue<node>q;\nconst int inf=0x3f3f3f3f;\nconst int tx[6]={0,0,0,1,-1};\nconst int ty[6]={0,1,-1,0,0};\nint map[10][10][110],dp[10][10][110][(1<<11)-1];\nint n,m,h,w,sx,sy,T,cnt,d,t1,t2,ans=inf;\nbool vis[10][10][110][(1<<11)-1],flag;\nint main(){\n    scanf(\"%d%d%d%d%d%d%d\",&h,&w,&T,&sx,&sy,&n,&m);\n    for(int i=1;i<=n;i++){\n        int f;\n        scanf(\"%d%d%d\",&t1,&t2,&d);\n        if(d) f=1<<((++cnt)-1);\n        else f=-1;\n        for(int j=t1;j<=t2-1;j++){\n            int x,y;\n            scanf(\"%d%d\",&x,&y);\n            map[x][y][j]=f;\n        }\n    }\n    if(map[sx][sy][1]==-1){\n    \tprintf(\"-1\");\n\t\treturn 0;\n    }//\u8d77\u59cb\u70b9\u7279\u5224\n    for(int i=1;i<=h;i++)\n    \tfor(int j=1;j<=w;j++)\n    \t\tfor(int t=1;t<=T;t++)\n    \t\t\tfor(int k=0;k<=(1<<m);k++)\n    \t\t\t\tdp[i][j][t][k]=inf;\n\tq.push((node){sx,sy,map[sx][sy][1],1});\n\tdp[sx][sy][1][map[sx][sy][1]]=0;\n\twhile(!q.empty()){\n        now=q.front();q.pop();\n        vis[now.x][now.y][now.t][now.num]=0;\n        if(now.t>T) continue;\n        for(int i=0;i<5;i++){\n            int xx=now.x+tx[i];\n            int yy=now.y+ty[i];\n            int melon=now.num;\n            if(xx<1||xx>h||yy<1||yy>w)continue;\n            int t=now.t+1;\n            if(map[xx][yy][t]==-1)continue;\n            int dis=dp[now.x][now.y][now.t][now.num]+(i!=0);\n            melon|=map[xx][yy][t];\n            if(dp[xx][yy][t][melon]>dis){\n                dp[xx][yy][t][melon]=dis;\n                if(!vis[xx][yy][t][melon]){\n                    q.push((node){xx,yy,melon,t});\n                    vis[xx][yy][t][melon]=1;\n                }\n            }\n        }\n    }   \n\tfor(int i=1;i<=h;i++)\n        for(int j=1;j<=w;j++)\n        \tans=min(ans,dp[i][j][T][(1<<m)-1]);\n    if(ans==inf) printf(\"-1\");\n    else printf(\"%d\",ans);\n    return 0;\n}\n```\n\n\u81ea\u5df1\u5199\u7684\u7eaf\u66b4\u529b\u8f6c\u79fb\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#define ll long long\nusing namespace std;\nconst int inf=0x3f3f3f3f;\nconst int tx[6]={0,0,0,1,-1};\nconst int ty[6]={0,1,-1,0,0};\nint map[10][10][110],dp[10][10][110][(1<<11)-1];\nint n,m,h,w,sx,sy,T,cnt,d,t1,t2,ans=inf;\nint main(){\n    scanf(\"%d%d%d%d%d%d%d\",&h,&w,&T,&sx,&sy,&n,&m);\n    for(int i=1;i<=n;i++){\n        int f;\n        scanf(\"%d%d%d\",&t1,&t2,&d);\n        if(d) f=1<<((++cnt)-1);\n        else f=-1;\n        for(int j=t1;j<=t2-1;j++){\n            int x,y;\n            scanf(\"%d%d\",&x,&y);\n            map[x][y][j]=f;\n        }\n    } \n    if(map[sx][sy][1]==-1){\n    \tprintf(\"-1\");\n\t\treturn 0;\n    }\n    for(int i=1;i<=h;i++)\n    \tfor(int j=1;j<=w;j++)\n    \t\tfor(int t=1;t<=T;t++)\n    \t\t\tfor(int k=0;k<=(1<<m);k++)\n    \t\t\t\tdp[i][j][t][k]=inf;\n\tdp[sx][sy][1][map[sx][sy][1]]=0;\n\tfor(int t=1;t<T;t++){\n\t\tfor(int i=1;i<=h;i++){\n\t\t\tfor(int j=1;j<=w;j++){\n\t\t\t\tfor(int s=0;s<=(1<<m)-1;s++){\n\t\t\t\t\tif(dp[i][j][t][s]!=inf){\n\t\t\t\t\t\tfor(int k=0;k<5;k++){\n\t\t\t\t\t\t\tint kx=i+tx[k];\n\t\t\t\t\t\t\tint ky=j+ty[k];\n\t\t\t\t\t\t\tif(kx>h||kx<1||ky>w||ky<1) continue;\n\t\t\t\t\t\t\tif(map[kx][ky][t+1]==-1) continue;\n\t\t\t\t\t\t\tdp[kx][ky][t+1][s|map[kx][ky][t+1]]=min(dp[kx][ky][t+1][s|map[kx][ky][t+1]],dp[i][j][t][s]+(k!=0));\n                            \t\t\t\t//\u4ee5\u6bcf\u4e00\u4e2a\u53ef\u4ee5\u8f6c\u79fb\u7684\u70b9\u5411\u56db\u4e2a\u65b9\u5411\u8f6c\u79fb\uff0c\u8bb0\u5f97\u5982\u679c\u6ca1\u52a8\u8def\u7a0b\u4e0d\u9700\u8981+1\uff0ctx[k]=ty[k]=0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=h;i++)\n        for(int j=1;j<=w;j++)\n        \tans=min(ans,dp[i][j][T][(1<<m)-1]);\n    if(ans==inf) printf(\"-1\");\n    else printf(\"%d\",ans);\n    return 0;\n}\n```\n### \u6700\u540e\u795d\u613f\u5927\u5bb62019CSP  NOI XXXXOI RP++! ! !\n",
        "postTime": 1570926550,
        "uid": 221615,
        "name": "S_S_H",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3786 \u3010\u8403\u9999\u62b1\u897f\u74dc\u3011"
    }
]
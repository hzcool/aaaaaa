[
    {
        "content": "~~\u8bf4\u770b\u4ee3\u7801\u7406\u89e3\u7684\u4f60\u4eec\u591f\u4e86~~\n\n\u76f8\u4fe1\u6ce5\u840c\u90fd\u662f\u4ece\u8bd5\u70bc\u573a\u5237\u8fc7\u6765\u7684\u5427\uff1f\u6240\u4ee5[\u8fd9\u9053\u9898](https://www.luogu.org/problemnew/show/P2216)\u6ce5\u840c\u4e00\u5b9a\u505a\u8fc7\u4e86\u3002\u56de\u987e\u4e00\u4e0b\u600e\u4e48\u505a\u7684\u5462\uff1f\u4e8c\u7ef4\u7684\u5355\u8c03\u961f\u5217\u505a\u6cd5\uff1a\u5148\u5c31\u67d0\u4e00\u7ef4\u4e0a\u5bf9\u539f\u59cb\u6570\u636e\u8fdb\u884c\u5904\u7406\uff0c\u5728\u5bf9\u53e6\u4e00\u7ef4\u4e0a\u5bf9\u524d\u4e00\u7ef4\u7684\u6570\u636e\u8fdb\u884c\u5904\u7406\uff0c\u5c31\u5f97\u5230\u4e86\u6240\u9700\u8981\u7684\u4e1c\u897f\u3002\n\n\u56de\u5230\u8fd9\u9898\uff0c\u4e5f\u662f\u540c\u6837\u7684\u505a\u6cd5\uff0c\u4e0b\u8fb9\u662f\u6211\u89e3\u9898\u65f6\u7684\u601d\u8def\uff1a\n\n1. \u9884\u5904\u7406\u51fa\u4ee5A\\[i,j\\]\u3001B\\[i,j\\]\u5206\u522b\u4e3a\u53f3\u4e0b\u89d2\u7684\u82b1\u575b(C\\*D)\u3001\u5927\u77e9\u5f62(A\\*B)\u7684\u80a5\u6c83\u5ea6\u548c\n\n2. \u6309\u884c\uff0c\u5229\u7528\u5355\u8c03\u961f\u5217\u6c42\u51faP\\[i,j\\]=\u4ee5A\\[i, j-B+1+D\u2192j-1\\]\u4e2d\u7684\u6700\u5c0f\u503c\uff0c\u5373\u4ee5(i, j-B+1+D\u2192j-1)\u4e3a\u53f3\u4e0b\u89d2\u7684\u82b1\u575b\u80a5\u6c83\u5ea6\u7684\u6700\u5c0f\u503c\u3002 \n\n3. \u6309\u5217\uff0c\u5229\u7528\u5355\u8c03\u961f\u5217\u6c42\u51faQ\\[i,j\\]=\u4ee5P\\[i-A+1+C\u2192i-1, j\\]\u4e2d\u7684\u6700\u5c0f\u503c\uff0c\u5373\u4ee5(i-A+1+C\u2192i-1, j-B+1+D\u2192j-1) \u4e3a\u53f3\u4e0b\u89d2\u7684\u82b1\u575b\u80a5\u6c83\u5ea6\u7684\u6700\u5c0f\u503c\uff0c\u663e\u7136\uff0c\u8fd9\u4e9b\u82b1\u575b\u5305\u542b\u5728\u4e86\u4ee5(i,j)\u4e3a\u53f3\u4e0b\u89d2\u7684\u5927\u77e9\u5f62\u4e2d\uff1b  \n\n4. \u663e\u7136B\\[i,j\\]-Q\\[i,j\\]\u5373\u4e3a\u4ee5(i,j)\u4e3a\u53f3\u4e0b\u89d2\u7684\u7eff\u5316\u5e26\u7684\u6700\u5927\u80a5\u6c83\u503c\u3002\n\n\n\u65f6\u95f4\u590d\u6742\u5ea6 O(nm)\u3002\u4ee3\u7801\u5b9e\u73b0\u4e2dn\u3001m\u4e0e\u9898\u610f\u662f\u53cd\u7684\u3002~~\u6b22\u8fce\u6765hack~~\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst int N=1005;\n\nint n,m,A,B,C,D,hd,tl,q[N];\nint s[N][N],a[N][N],b[N][N],P[N][N],Q[N][N];\n\nint main() {\n\tscanf(\"%d%d %d%d%d%d\",&n,&m,&A,&B,&C,&D);\n\tfor(int i=1; i<=n; ++i) {\n\t\tfor(int j=1; j<=m; ++j) {\n\t\t\tscanf(\"%d\",&s[i][j]);\n\t\t\ts[i][j]=s[i][j]+s[i-1][j]+s[i][j-1]-s[i-1][j-1];\n\t\t}\n\t}\n\tfor(int i=C+1; i<n; ++i) {\n\t\tfor(int j=D+1; j<m; ++j) {\n\t\t\ta[i][j]=s[i][j]-s[i-C][j]-s[i][j-D]+s[i-C][j-D];\n\t\t}\n\t}\n\tfor(int i=A; i<=n; ++i) {\n\t\tfor(int j=B; j<=m; ++j) {\n\t\t\tb[i][j]=s[i][j]-s[i-A][j]-s[i][j-B]+s[i-A][j-B];\n\t\t}\n\t}\n\tfor(int i=C+1; i<n; ++i) {\n\t\thd=1, tl=0;\n\t\tfor(int j=D+1; j<m; ++j) {\n\t\t\twhile(hd<=tl && q[hd]<j-B+2+D) hd++; //*\n\t\t\twhile(hd<=tl && a[i][q[tl]]>=a[i][j]) tl--;\n\t\t\tq[++tl]=j;\n\t\t\tif(j>=B-1) P[i][j+1]=a[i][q[hd]];\n\t\t}\n\t}\n\tfor(int j=B; j<=m; ++j) {\n\t\thd=1, tl=0;\n\t\tfor(int i=C+1; i<n; ++i) {\n\t\t\twhile(hd<=tl && q[hd]<i-A+2+C) hd++;\n\t\t\twhile(hd<=tl && P[q[tl]][j]>=P[i][j]) tl--;\n\t\t\tq[++tl]=i;\n\t\t\tif(i>=A-1) Q[i+1][j]=P[q[hd]][j];\n\t\t}\n\t}\n\tint ans=0;\n\tfor(int i=A; i<=n; ++i) {\n\t\tfor(int j=B; j<=m; ++j) {\n\t\t\tans=max(ans,b[i][j]-Q[i][j]);\n\t\t}\n\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n} \n```\n\\* \u539f\u6765\u7684\u533a\u95f4\\[j-B+1+D, j-1\\]\u662f\u5bf9\u4e8ej\u6765\u8bf4\u7684\uff1b\u4f46\u6b64\u5904\u6211\u4eec\u5728j\u7684\u4f4d\u7f6e\u65f6\u66f4\u65b0j+1\uff0c\u6240\u4ee5\u8303\u56f4\u8c03\u6574\u4e3a\\[j-B+2+D, j\\]\u3002\u4e0b\u540c\u3002",
        "postTime": 1544792059,
        "uid": 125139,
        "name": "nosta",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P2219 \u3010[HAOI2007]\u4fee\u7b51\u7eff\u5316\u5e26\u3011"
    },
    {
        "content": "### \u597d\u50cf\u4e4b\u524d\u7684\u4e24\u7bc7\u9898\u89e3\u90fd\u88ab$hack$\u4e86\uff0c\u7136\u800c\u6211\u7684\u4ee3\u7801\u5b8c\u597d\u65e0\u635f233\uff0c\u6b22\u8fce\u5404\u79cd\u5f3a\u6570\u636e\u6765$hack$\n### [\u8fd9\u91cc\u662f\u4e00\u9053\u7c7b\u4f3c\u7684\u9898\u76ee\uff08\u4e00\u5e74\u7adf\u7136\u8003\u4e24\u9053\u8fd9\u79cd\u9898\u76eeemmm\uff09](https://www.luogu.org/problemnew/show/P2216)\n### \u6838\u5fc3\u7b97\u6cd5\u5f53\u7136\u662f\u4e8c\u7ef4\u7684\u5355\u8c03\u961f\u5217\u52a0\u4e8c\u7ef4\u524d\u7f00\u548c\uff0c\u9996\u5148\u7528\u4e00\u4e2a\u5355\u8c03\u961f\u5217\u6570\u7ec4\u7ef4\u62a4\u5de6\u4e0a\u89d2\u5728\u67d0\u4e00\u884c\u4e0a\u7684$C \\times D$\u77e9\u5f62\u7684\u6700\u5c0f\u503c\uff0c\u7136\u540e\u7528\u4e00\u4e2a\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u5217\u4e0a\u5728\u4e00\u4e2a$A \\times B$\u77e9\u5f62\u4e2d\u53ef\u4ee5\u9009\u62e9\u7684$C \\times D$\u77e9\u5f62\u7684\u6700\u5c0f\u503c\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$O(NM)$\n### \u96be\u70b9\u662f\u5404\u79cd\u5404\u6837\u7684\u7ec6\u8282\u8c03\u4e86\u5f88\u591a\u6b21\u7ec6\u8282\u624d\u8c03\u597d\n### \u4e0d\u600e\u4e48\u597d\u7406\u89e3\u5c31\u770b\u4ee3\u7801\u5427$emmm$~~\u4ee3\u7801\u4e5f\u4e0d\u597d\u7406\u89e3~~\n```\n#include<bits/stdc++.h>\nusing namespace std;\n\ninline int read(){\n    int a = 0;\n    char c = getchar();\n    while(!isdigit(c))\n        c = getchar();\n    while(isdigit(c)){\n        a = (a << 3) + (a << 1) + (c ^ '0');\n        c = getchar();\n    }\n    return a;\n}\n\ndeque < int > q[1001] , Q;\n//\u5355\u8c03\u961f\u5217~\nint num[1001][1001] , sum[1001][1001];\nint M = read() , N = read() , A = read() , B = read() , C = read() , D = read() , ans = 0;\n\ninline int calc1(int x , int y){\n    return sum[x + C - 1][y + D - 1] - sum[x - 1][y + D - 1] - sum[x + C - 1][y - 1] + sum[x - 1][y - 1];\n}\n//\u8ba1\u7b97\u5de6\u4e0a\u89d2\u4e3a(x,y)\u7684C*D\u77e9\u5f62\u7684\u548c\n\ninline int calc2(int x , int y){\n    return sum[x + A - 1][y + B - 1] - sum[x - 1][y + B - 1] - sum[x + A - 1][y - 1] + sum[x - 1][y - 1];\n}\n//\u8ba1\u7b97\u5de6\u4e0a\u89d2\u4e3a(x,y)\u7684A*B\u77e9\u5f62\u7684\u548c\n\nint main(){\n    for(int i = 1 ; i <= M ; i++)\n        for(int j = 1 ; j <= N ; j++)\n            sum[i][j] = (num[i][j] = read()) + sum[i - 1][j] + sum[i][j - 1] - sum[i - 1][j - 1];\n    for(int i = 2 ; i <= N - D ; i++){\n        for(int j = 2 ; j <= M - C ; j++){\n            if(!q[j].empty() && q[j].front() == i + D - B + 1)\n                q[j].pop_front();\n            while(!q[j].empty() && calc1(j , q[j].back()) >= calc1(j , i))\n                q[j].pop_back();\n            q[j].push_back(i);\n            //\u8ba1\u7b97\u5de6\u4e0a\u89d2\u884c\u53f7\u4e3aj\u7684C*D\u77e9\u5f62\u7684\u6700\u5c0f\u503c\n        }\n        if(i + D - B >= 0){\n            //\u8ba1\u7b97\u5de6\u4e0a\u89d2\u5217\u53f7\u4e3ai + D - B + 1\u7684A*B\u77e9\u5f62\u7684\u7b54\u6848\n            Q.clear();\n            for(int k = 2 ; k <= M - C ; k++){\n                if(!Q.empty() && k + C - A + 1 == Q.front())\n                    Q.pop_front();\n                while(!Q.empty() && calc1(Q.back() , q[Q.back()].front()) >= calc1(k , q[k].front()))\n                    Q.pop_back();\n                Q.push_back(k);\n                if(k + C - A >= 0)\n                    ans = max(ans , calc2(k + C - A + 1 , i + D - B + 1) - calc1(Q.front() , q[Q.front()].front()));\n            }\n        }\n    }\n    cout << ans;\n    return 0;\n}\n```",
        "postTime": 1537017608,
        "uid": 96296,
        "name": "Itst",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2219 \u3010[HAOI2007]\u4fee\u7b51\u7eff\u5316\u5e26\u3011"
    },
    {
        "content": "\u5148\u5229\u7528\u524d\u7f00\u548c\uff0c\u9884\u5904\u7406\u51fa$ab[i][j]$\u548c$cd[i][j]$\uff0c\u5206\u522b\u8868\u793a\u4ee5$(i,j)$\u4e3a\u53f3\u4e0b\u89d2\u7684\u957f\u4e3a$A$\u5bbd\u4e3a$B$\u7684\u5b50\u77e9\u9635\u603b\u548c\u4ee5\u53ca\u4ee5$(i,j)$\u4e3a\u53f3\u4e0b\u89d2\u7684\u957f\u4e3a$C$\u5bbd\u4e3a$D$\u7684\u5b50\u77e9\u9635\u603b\u548c\u3002\n\n\u7136\u540e\uff0c\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u66b4\u529b\u679a\u4e3e\u7eff\u5316\u5e26\u7684\u53f3\u4e0b\u89d2\u4f4d\u7f6e$(i,j)$\uff0c\u90a3\u4e48\u9700\u8981\u5728\u4ee5$(i-1,j-1)$\u4e3a\u53f3\u4e0b\u89d2\u7684\u957f\u4e3a$A-2$\u5bbd\u4e3a$B-2$\u7684\u5b50\u77e9\u9635\u4e2d\uff0c\u53d6\u51fa\u4e00\u4e2a\u957f\u4e3a$C$\u5bbd\u4e3a$D$\u7684\u5b50\u77e9\u9635\uff0c\u8ba9\u8fd9\u4e2a\u957f\u4e3a$C$\u5bbd\u4e3a$D$\u7684\u5b50\u77e9\u9635\u603b\u548c\u6700\u5c0f\uff0c\u4e5f\u5c31\u662f\u6c42$cd[i-A+C+1...i-1][j-B+D+1...j-1]$\u7684\u6700\u5c0f\u503c\u3002\n\n\u8fd9\u6837\uff0c\u5c31\u53ef\u4ee5\u7528\u300c$HAOI2007$\u7406\u60f3\u7684\u6b63\u65b9\u5f62\u300d\u7684\u505a\u6cd5\u53bb\u505a\u3002\n\n\u505a\u6cd5\uff1a\n\n1\u3001\u5bf9\u4e8e\u6bcf\u4e2a$C<=i<=m$\uff0c\u5229\u7528\u5355\u8c03\u961f\u5217\uff0c\u8ba1\u7b97\u51fa\u6240\u6709$cd[i][j-B+D+2...j]$\u8303\u56f4\u7684\u6700\u5c0f\u503c$min1[i][j]$($B-2<=j<=n$)\u3002\n\n2\u3001\u5bf9\u4e8e\u6bcf\u4e2a$B-2<=j<=n$\uff0c\u518d\u5229\u7528\u5355\u8c03\u961f\u5217\uff0c\u8ba1\u7b97\u51fa\u6240\u6709$min1[i-A+C+2...i][j]$\u8303\u56f4\u7684\u6700\u5c0f\u503c$min2[i][j]$($A-2<=i<=m$)\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c$min2[i][j]$\u7684\u503c\u5c31\u662f$cd[i-A+C+2...i][j-B+D+2...j]$\u8303\u56f4\u7684\u6700\u5c0f\u503c\u3002\n\n\u6240\u4ee5\u5bf9\u4e8e\u4efb\u4f55\u4e00\u4e2a$A<=i<=m,B<=j<=n$\uff0c\u7eff\u5316\u5e26\u4ee5$(i,j)$\u4e3a\u53f3\u4e0b\u89d2\u7684\u6700\u5927\u80a5\u6c83\u5ea6\u4e3a$ab[i][j]-min2[i-1][j-1]$\uff0c\u66b4\u529b\u679a\u4e3e$i$\u548c$j$\u5373\u53ef\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\ninline int read() {\n    int res = 0; bool bo = 0; char c;\n    while (((c = getchar()) < '0' || c > '9') && c != '-');\n    if (c == '-') bo = 1; else res = c - 48;\n    while ((c = getchar()) >= '0' && c <= '9')\n        res = (res << 3) + (res << 1) + (c - 48);\n    return bo ? ~res + 1 : res;\n}\nconst int N = 1005;\nint m, n, A, B, C, D, sum[N][N], ab[N][N], cd[N][N], H, T, que[N], id[N],\npx[N][N], py[N][N], res;\nint main() {\n    int i, j; m = read(); n = read(); A = read();\n    B = read(); C = read(); D = read();\n    for (i = 1; i <= m; i++) for (j = 1; j <= n; j++)\n        sum[i][j] = sum[i - 1][j] + sum[i][j - 1] -\n            sum[i - 1][j - 1] + read();\n    for (i = A; i <= m; i++) for (j = B; j <= n; j++)\n        ab[i][j] = sum[i][j] - sum[i - A][j]\n            - sum[i][j - B] + sum[i - A][j - B];\n    for (i = C; i <= m; i++) for (j = D; j <= n; j++)\n        cd[i][j] = sum[i][j] - sum[i - C][j]\n            - sum[i][j - D] + sum[i - C][j - D];\n    for (i = C; i <= m; i++) {\n        H = T = 0;\n        for (j = D; j <= B - 2; j++) {\n            while (H < T && que[T] > cd[i][j]) T--;\n            que[++T] = cd[i][j]; id[T] = j;\n        }\n        px[i][B - 2] = que[H + 1];\n        for (j = D + 1; j - D + B - 2 <= n; j++) {\n            while (H < T && que[T] > cd[i][j - D + B - 2]) T--;\n            que[++T] = cd[i][j - D + B - 2]; id[T] = j - D + B - 2;\n            if (id[H + 1] == j - 1) H++;\n            px[i][j - D + B - 2] = que[H + 1];\n        }\n    }\n    for (j = B - 2; j <= n; j++) {\n        H = T = 0;\n        for (i = C; i < A; i++) {\n            while (H < T && que[T] > px[i][j]) T--;\n            que[++T] = px[i][j]; id[T] = i;\n        }\n        py[A - 2][j] = que[H + 1];\n        for (i = C + 1; i - C + A - 2 <= m; i++) {\n            while (H < T && que[T] > px[i - C + A - 2][j]) T--;\n            que[++T] = px[i - C + A - 2][j]; id[T] = i - C + A - 2;\n            if (id[H + 1] == i - 1) H++;\n            py[i - C + A - 2][j] = que[H + 1];\n        }\n    }\n    for (i = A; i <= m; i++) for (j = B; j <= n; j++)\n        res = max(res, ab[i][j] - py[i - 1][j - 1]);\n    printf(\"%d\\n\", res);\n    return 0;\n}\n```",
        "postTime": 1502704437,
        "uid": 29936,
        "name": "xyz32768",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2219 \u3010[HAOI2007]\u4fee\u7b51\u7eff\u5316\u5e26\u3011"
    },
    {
        "content": "\u6539\u4e86\u591a2\u4e2a\u5c0f\u65f6\u7ec8\u4e8eA\u4e86\uff08~~\u679c\u7136\u8fd8\u662f\u6211\u592a\u6c34\u4e86~~\uff09\n\n\u672c\u6765\u521a\u770b\u5230\u8fd9\u9053\u9898\u4e00\u70b9\u601d\u8def\u90fd\u6ca1\u6709\uff0c\u53ea\u77e5\u9053\u8ddfP2216\u5f88\u50cf\uff0c\u4e8e\u662f\u5c31\u6253\u5f00\u4e86~~\u7f6a\u6076\u7684~~\u9898\u89e3\uff0c\u77aa\u7740\u90a3\u4e2a\u552f\u4e00\u6ca1\u88abHack\u7684\u9898\u89e3\u770b\u4e86\u534a\u5929\uff0c\u5b8c\u5168\u770b\u4e0d\u61c2\uff0c\u4e8e\u662f\u53ea\u597d\u81ea\u5df1\u7814\u7a76\u7814\u7a76\uff0c\u6ca1\u60f3\u5230\u7adf\u7136\u641e\u51fa\u6765\u4e86\u3002\n\n\u4e3b\u8981\u601d\u8def\u5c31\u662f\u5148\u7528\u4e8c\u7ef4\u524d\u7f00\u548c\u641e\u51fa\u6bcf\u4e00\u4e2a\u4ee5i,j\u4e3a\u5de6\u4e0a\u89d2\u7684C\u00d7D\u5927\u7684\u80a5\u6c83\u5ea6\u4e4b\u548c\uff0c\u8bb0\u5f55\u5230\u4e00\u4e2a\u6570\u7ec4imap\u91cc\uff0c\u7136\u540e\u518d\u627e\u5230\u4ee5i,j\u4e3a\u5de6\u4e0a\u89d2\u7684A\u00d7B\u5927\u7684\u77e9\u5f62\u4e2d\u6700\u5c0f\u7684imap\u503c\uff0c\u6700\u540e\u518d\u626b\u4e00\u904d\u5c31\u884c\u4e86\u3002\u7136\u540e\u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2a\u5751\uff0c\u5c31\u662f\u82b1\u575b\u5fc5\u987b\u4e25\u683c\u88ab\u7eff\u5316\u5e26\u5305\u56f4\uff0c\u8fde\u8fb9\u91cd\u53e0\u90fd\u4e0d\u884c\u3002\n\n\u6a21\u62df\u4e00\u4e0b\u6837\u4f8b:\n\n\u539f\u6570\u636e\uff1a\n\n![undefined](https://cdn.luogu.com.cn/upload/pic/44476.png)\n\n\u8bb0\u5f55\u7684imap\u503c:\n\n![undefined](https://cdn.luogu.com.cn/upload/pic/44480.png)\n\n\u7136\u540e\u627e\u51fa\u6765\u7684minmap\u503c\uff1a\n\n![undefined](https://cdn.luogu.com.cn/upload/pic/44478.png)\n\n\u4e0a\u9762\u8fd9\u4e2aminmap\u5c31\u662f\u4ee5i,j\u4e3a\u5de6\u4e0a\u89d2\uff0c\u5927\u5c0f\u4e3a3\u00d73\u7684\u503c\u7684\u6700\u5c0f\u503c\uff08\u4e3a\u4ec0\u4e48\u662f3\u00d73,A\u548cB\u4e0d\u90fd\u662f4\u5417\uff1f\u4ed4\u7ec6\u60f3\u4e00\u4e0b\uff0cimap\u8bb0\u5f55\u7684\u5c31\u5df2\u7ecf\u662f\u4ee5i,j\u4e3a\u5de6\u4e0a\u89d2\uff0c\u5927\u5c0f\u4e3aC\u00d7D\u53732\u00d72\u7684\u548c\u4e86\uff0c\u5982\u679c\u8fd9\u91ccminmap\u53d64\u00d74\u7684\u8bdd\uff0c\u90a3\u4e48\u5b83\u5305\u542b\u7684\u771f\u5b9e\u8303\u56f4\u5c31\u662f(4-2+1)\u00d7(4-2+1)=5\u00d75\u4e86\uff09\n\n\u4ee4sumAB(i,j)\u8868\u793a\u5df2i,j\u4e3a\u5de6\u4e0a\u89d2\uff0c\u5927\u5c0f\u4e3aA\u00d7B\u7684\u77e9\u5f62\u548c,\u90a3\u4e48\u6700\u540e\u7b54\u6848\u5c31\u7b49\u4e8emax{sumAB(i,j)-minmap[i][j]}\u4e86\u3002\n\n\u81f3\u4e8e\u600e\u4e48\u901a\u8fc7imap\u8f6c\u79fb\u5230minmap\uff0c~~\u81ea\u5df1\u7814\u7a76\u5427~~\u505a\u4e00\u4e0bP2216\u4f60\u5c31\u77e5\u9053\u4e86\u3002\n\n\u653e\u4e00\u4e0b\u4ee3\u7801\uff1a\n\n```cpp\n\n#include <bits/stdc++.h>\n\n#define MAXN 1010\n#define re register\n#define INF 0x7fffffff\n\nusing namespace std;\n\nstruct mon_que //\u5355\u8c03\u961f\u5217\uff0c\u600e\u4e48\u5b9e\u73b0\u4ee5\u53ca\u5e72\u561b\u7684\u8be6\u89c1P4392\u548cP1886\n{\n\tint head,tail;\n\tint num[MAXN],p[MAXN];\n\tbool flag;\n\tvoid init(bool flg=false)\n\t{\n\t\thead=1,tail=0;\n\t\tflag=flg;\n\t}\n\tbool empty()\n\t{\n\t\treturn head>tail;\n\t}\n\tvoid insert(const int &x,const int &pos)\n\t{\n\t\tif(flag) while(x>=num[tail]&&!empty()) --tail;\n\t\telse while(x<=num[tail]&&!empty()) --tail;\n\t\tnum[++tail]=x;\n\t\tp[tail]=pos;\n\t}\n\tvoid del_p(const int &pos)\n\t{\n\t\twhile(p[head]<=pos) ++head;\n\t}\n\tint front()\n\t{\n\t\treturn num[head];\n\t}\n}q;\n\nint imap[MAXN][MAXN],sum[MAXN][MAXN];\nint rmin[MAXN][MAXN],minmap[MAXN][MAXN];\nint n,m,a,b,c,d,ans,ta,tb;\n\ninline int read()\n{\n\tre int res=0;re bool f=1;\n\tre char ch=getchar();\n\twhile(ch<'0'||ch>'9')\n\t{\n\t\tif(ch=='-') f=0;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0'&&ch<='9')\n\t{\n\t\tres=(res<<3)+(res<<1)+(ch&15);\n\t\tch=getchar();\n\t}\n\treturn f?res:-res;\n}\n\ninline int sumCD(const int &x,const int &y)//\u8ba1\u7b97\u4ee5x,y\u4e3a\u5de6\u4e0a\u89d2\uff0c\u5927\u5c0f\u4e3aC*D\u7684\u77e9\u5f62\u548c\n{\n\treturn sum[x+c-1][y+d-1]-sum[x-1][y+d-1]-sum[x+c-1][y-1]+sum[x-1][y-1];\n}\n\ninline int sumAB(const int &x,const int &y)//\u8ba1\u7b97\u4ee5x,y\u4e3a\u5de6\u4e0a\u89d2\uff0c\u5927\u5c0f\u4e3aA*B\u7684\u77e9\u5f62\u548c\n{\n\treturn sum[x+a-1][y+b-1]-sum[x-1][y+b-1]-sum[x+a-1][y-1]+sum[x-1][y-1];\n}\n\nint main()\n{\n\tn=read(),m=read(),a=read(),b=read(),c=read(),d=read();\n\tfor(re int i=1;i<=n;++i)\n\t\tfor(re int j=1;j<=m;++j)\n\t\t\tsum[i][j]=sum[i-1][j]+sum[i][j-1]-sum[i-1][j-1]+read();//\u4e8c\u7ef4\u524d\u7f00\u548c\n\tfor(re int i=1;i<=n-c+1;++i)\n\t\tfor(re int j=1;j<=m-d+1;++j)\n\t\t\timap[i][j]=sumCD(i,j);\n\tta=a,tb=b;\n\ta=a-c-1,b=b-d-1;//\u8fd9\u4e48\u641e\u7684\u76ee\u7684\u662f\u6392\u9664\u6389\u82b1\u575b\u4e0e\u7eff\u5316\u5e26\u8fb9\u91cd\u53e0\u7684\u60c5\u51b5\n\t\n\tfor(re int i=2;i<n-c+1;++i)\n\t{\n\t\tq.init();\n\t\tfor(re int j=2;j<m-d+1;++j)\n\t\t{\n\t\t\tq.insert(imap[i][j],j);\n\t\t\tq.del_p(j-b);\n\t\t \tif(j>=b) rmin[i-1][j-b]=q.front();\n\t\t}\n\t}//rmin[i][j]\u8bb0\u5f55\u7684\u662f\u4eceimap[i][j]\u5230imap[i][j+b-1]\u7684\u6700\u5c0f\u503c\n\tfor(re int i=2;i<m-d+1;++i)\n\t{\n\t\tq.init();\n\t\tfor(re int j=2;j<n-c+1;++j)\n\t\t{\n\t\t\tq.insert(rmin[j-1][i-1],j);\n\t\t\tq.del_p(j-a);\n\t\t\tif(j>=a) minmap[j-a][i-1]=q.front();\n\t\t}\n\t}//minmap[i][j]\u5c31\u662frmin[j][i]\u5230rmin[j+a-1][i]\u7684\u6700\u5c0f\u503c\n\t//\u4e0eP2216\u57fa\u672c\u4e00\u6837\n\t\n\ta=ta,b=tb;\n\tfor(re int i=1;i<=n-a+1;++i)\n\t\tfor(re int j=1;j<=m-b+1;++j)\n\t\t\tans=max(ans,sumAB(i,j)-minmap[i][j]);//\u6700\u540e\u8ba1\u7b97\u4e00\u4e0b\u53d6\u6700\u5927\u503c\n\tprintf(\"%d\\n\",ans-2333);//\u9632\u62842333\n\treturn 0;\n}\n```",
        "postTime": 1543075503,
        "uid": 112008,
        "name": "\u6211\u6ca1\u6709\u5f00\u6302",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2219 \u3010[HAOI2007]\u4fee\u7b51\u7eff\u5316\u5e26\u3011"
    },
    {
        "content": " ## \u8fc7\u4e86\u8fd9\u9053\u9898\uff0c\u53d1\u4e00\u4e2a\u9898\u89e3\uff0c\u6743\u5f53\u603b\u7ed3\u4e00\u4e9b\u5355\u8c03\u961f\u5217\u7684\u57fa\u672c\u5199\u6cd5\n \u6b64\u9898\u601d\u8def\uff1a\u679a\u4e3e\u6240\u6709\u7684A * B\u7684\u77e9\u5f62\uff0c\u5e76\u6c42\u51fa\u5176\u4e2d\u548c\u6700\u5c0f\u7684C*D\u77e9\u5f62\u3002\n \n\u5b9e\u73b0\u4e0a\u6211\u4eec\u5c31\u7528\u5230\u4e86\u5355\u8c03\u961f\u5217\n\n\u4e0b\u9762\u7684\u8bb2\u89e3\u4e2d\uff0cS\u8868\u793a\u4e8c\u4f4d\u524d\u7f00\u548c\uff0cx[i][j]\u8868\u793a\u4ee5(i, j)\u4e3a\u53f3\u4e0b\u89d2\uff0c\u5927\u5c0f\u4e3aC * D\u7684\u77e9\u5f62\uff0cu[i][j]\u8868\u793a(i, j-(B-D-1)+1)\u5230(i, j\uff09\u8fd9\u6761\u7ebf\u6bb5\u4e0a\u7684x\u7684\u6700\u5c0f\u503c\uff0cv[i][j]\u8868\u793a\u4ee5(i, j)\u4e3a\u53f3\u4e0b\u89d2\uff0c\u5927\u5c0f\u4e3a(A-C-1) * (B-D-1)\u7684\u77e9\u5f62\u4e2dx\u7684\u6700\u5c0f\u503c\u3002\n\n### \u95ee\u98981\uff1a\u4e3a\u4ec0\u4e48\u662fA-C-1\u548cB-D-1?\n\n\u8bbe\u77e9\u5f62\u7684\u5de6\u4e0a\u89d2\u4e3a(1, 1)\uff0c\u53f3\u4e0b\u89d2\u4e3a(A, B)\u3002\u5728\u5176\u4e2d\u9009\u51fa\u4e00\u4e2aC*D\u7684\u77e9\u5f62\uff0c\u4e14\u4e0d\u4e0e\u8fb9\u754c\u63a5\u89e6\u3002\u8fd9\u4e2a\u77e9\u5f62\u7684\u5de6\u4e0a\u89d2\u4e00\u5b9a\u662f\u6bd4(2, 2)\u66f4\u9760\u53f3\u4e0b\u7684\uff08\u6216\u8005\u4e00\u6837\uff09\uff0c\u53f3\u4e0b\u89d2\u4e00\u5b9a\u662f\u6bd4(A-1, B-1)\u66f4\u9760\u5750\u4e0a\u7684\uff08\u6216\u8005\u4e00\u6837\uff09\u3002\u90a3\u4e48\u53f3\u4e0b\u89d2\u7684\u5750\u6807\u8303\u56f4\u5c31\u662f(C+1, D+1)\u5230(A-1, B-1)\uff0c\u8fd9\u4e2a\u5927\u5c0f\u5c31\u662f(A-C-1)*(B-D-1)\u4e86\n\n### \u95ee\u98982\uff1a\u4e3a\u4ec0\u4e48\u8981\u5148\u6c42\u4e00\u7ef4\u7684\u518d\u6c42\u4e8c\u7ef4\u7684\uff1f\n\n\u56e0\u4e3a\u6211\u592a\u5f31\u4e86\u4e0d\u4f1a\u76f4\u63a5\u5199\u4e8c\u7ef4\n\n### \u95ee\u98983\uff1a\u5355\u8c03\u961f\u5217\u7684\u539f\u7406\u548c\u5b9e\u73b0\uff1f\n\n\u8003\u8651\u6ed1\u52a8\u7a97\u53e3\u95ee\u9898\u6c42\u6700\u5927\u503c\u3002\u5982\u679c\u70b9i\u7684\u6743\u503c\u662fai\uff0c\u70b9j\u7684\u6743\u503c\u662faj\u3002\u82e5i<j&&ai<aj\uff0c\u90a3\u4e48\u5728j\u70b9\u8fdb\u5165\u53ef\u884c\u533a\u95f4\u540e\uff0ci\u70b9\u5c31\u4e0d\u4f1a\u518d\u4f5c\u4e3a\u6700\u4f18\u89e3\u4e86\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u8e22\u51fa\u3002\n\n\u5b9e\u73b0\u4e0a\u505a\u4e00\u4e2a\u53cc\u7aef\u961f\u5217\uff0c\u5176\u4e2d\u4ece\u5de6\u5230\u53f3\u4e0b\u6807\u8d8a\u6765\u8d8a\u5927\uff08\u5373\u8d8a\u6765\u8d8a\u65b0\uff09\uff0c\u4ece\u53f3\u5230\u5de6\u6743\u503c\u8d8a\u6765\u8d8a\u5927\uff08\u5373\u8d8a\u6765\u8d8a\u4f18\uff09\u3002\u6240\u4ee5\u6bcf\u6b21\u52a0\u5165\u4e00\u4e2a\u70b9\u524d\u8981\u4ece\u5de6\u8fb9\u628a\u8fc7\u671f\u7684\u70b9\u5220\u9664\uff0c\u4ece\u53f3\u8fb9\u628a\u4e0d\u591f\u4f18\u7684\u70b9\u5220\u9664\u3002\u5728\u52a0\u5165\u65b0\u70b9\u540e\u5c31\u53ef\u4ee5\u7528\u6700\u5de6\u7aef\u7684\u6700\u4f18\u89e3\u6765\u5f97\u51fa\u6240\u6709\u503c\u4e86\u3002\n\n\u6700\u597d\u6bcf\u9053\u9898\u90fd\u5728\u7eb8\u4e0a\u63a8\u4e00\u4e0b\u5404\u79cd\u8fb9\u754c\u6761\u4ef6\uff0c\u4ee5\u514d\u5199\u9519\n\n### \u81f3\u6b64\uff0c\u8fd9\u9053\u9898\u89e3\u51b3\u5b8c\u6bd5\uff0c\u4f46\u6709\u4e00\u4e9b\u9898\u610f\u7406\u89e3\u548c\u5b9e\u73b0\u4e0a\u7684\u8bef\u533a\uff0c\u8fd9\u91cc\u6f84\u6e05\u4e00\u4e0b\uff1a\n\n### \u77e9\u5f62A * B\u548cC * D\u4e0d\u80fd\u7ffb\u8f6c\n\n### \u7eff\u5316\u5e26\u5fc5\u987b\u662f\u4e00\u4e2a\u95ed\u5408\u5708\n\n### \u6b64\u9898\u4e0d\u9700\u8981long long\n\n### \u7a97\u53e3\u957f\u4e3aa\u65f6\uff0c\u5224\u65ad\u7684\u6761\u4ef6\u662f>=a\u800c\u975e>a\n\n## \u4e0b\u9762\u662f(\u81ea\u8ba4\u4e3a\u5199\u5f97\u5f88\u4e11\u964b\u7684)\u4ee3\u7801\n```\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n#define int long long\nusing namespace std;\nint a[1005][1005], x[1005][1005], u[1005][1005], v[1005][1005], S[1005][1005];\nint q[1005], l, r;\nsigned main()\n{\n\tint n, m, A, B, C, D, i, j, ans = -1;\n\tscanf(\"%lld%lld%lld%lld%lld%lld\", &n, &m, &A, &B, &C, &D);\n\tfor(i = 1; i <= n; i++)\n\t\tfor(j = 1; j <= m; j++)\n\t\t\tscanf(\"%lld\", &a[i][j]), S[i][j] = S[i][j - 1] + S[i - 1][j] - S[i - 1][j - 1] + a[i][j];\n\tfor(i = C; i <= n; i++)\n\t\tfor(j = D; j <= m; j++)\n\t\t\tx[i][j] = S[i][j] - S[i - C][j] - S[i][j - D] + S[i - C][j - D];\n\tfor(i = 1; i <= n; i++)//\u70b9\u52a8\u6210\u7ebf \n\t{\n\t\tl = 1, r = 0;\n\t\tfor(j = 1; j <= m; j++)\n\t\t{\n\t\t\twhile(l <= r && j - q[l] >= B - D - 1) l++;\n\t\t\twhile(l <= r && x[i][q[r]] >= x[i][j]) r--;\n\t\t\tq[++r] = j;\n\t\t\tu[i][j] = x[i][q[l]];\n\t\t}\n\t}\n\tfor(i = 1; i <= m; i++)//\u7ebf\u52a8\u6210\u9762 \n\t{\n\t\tl = 1, r = 0;\n\t\tfor(j = 1; j <= n; j++)\n\t\t{\n\t\t\twhile(l <= r && j - q[l] >= A - C - 1) l++;\n\t\t\twhile(l <= r && u[q[r]][i] >= u[j][i]) r--;\n\t\t\tq[++r] = j;\n\t\t\tv[j][i] = u[q[l]][i];\n\t\t}\n\t}\n\tfor(i = A; i <= n; i++)\n\t\tfor(j = B; j <= m; j++)\n\t\t\tans = max(ans, S[i][j] - S[i - A][j] - S[i][j - B] + S[i - A][j - B] - v[i - 1][j - 1]);\n\tprintf(\"%lld\\n\", ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1552482184,
        "uid": 47140,
        "name": "\u65af\u8302",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2219 \u3010[HAOI2007]\u4fee\u7b51\u7eff\u5316\u5e26\u3011"
    },
    {
        "content": "~~\u6ca1\u60f3\u5230\u80fd\u5199\u5f97\u52a8\u7d2b\u9898\u3002~~\n\n\uff08\u5982\u679c\u82b1\u575b\u53ea\u662f\u4e00\u4e2a\u683c\u5b50\uff0c\u90a3\u4e48\u53ea\u8981\u679a\u4e3e\u4e00\u7ef4\uff0c\u5bf9\u53e6\u4e00\u7ef4\u7ef4\u62a4\u5355\u8c03\u961f\u5217\u5373\u53ef\uff1b\u65e2\u7136\u662f\u77e9\u5f62\uff0c\u4e0d\u59a8\u5229\u7528\u524d\u7f00\u548c\u628a\u5b83\u53d8\u4e3a\u4e00\u4e2a\u683c\u5b50\uff09\uff1a\n\n\u8fd9\u91cc\u7528$a[i][j]$\u8868\u793a\u524d\u7f00\u548c\uff0c\u7528$b[i][j]$(\u82b1\u575b)\u548c$c[i][j]$(\u7eff\u5316\u5e26)\u5206\u522b\u8868\u793a\u4ee5$(i,j)$\u4e3a\u5de6\u4e0a\u89d2\u7684$C*D$\u548c$A*B$\u7684\u77e9\u5f62\u548c\uff0c\u7528$d[i][j]$\u8868\u793a$(i,j)$\u5de6\u4e0a\u89d2\u3001\u8303\u56f4$C*B$\u5185\u6240\u6709$b$(\u82b1\u575b)\u7684\u6700\u5c0f\u503c\uff1b\u81f3\u4e8e\u6c42$d$\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e$i$\uff0c\u6bcf\u6b21\u5bf9$j$\u7ef4\u62a4\u4e00\u4e2a$b[i][j]$\u503c\u5355\u8c03\u9012\u589e\u4e14\u957f\u5ea6\u4e0d\u8d85\u8fc7$B$\u7684\u961f\u5217\u3002\n\n\u7136\u540e\u679a\u4e3e$j$\uff0c\u6bcf\u6b21\u5bf9$i$\u7ef4\u62a4\u4e00\u4e2a$d[i][j]$\u503c\u5355\u8c03\u9012\u589e\u4e14\u957f\u5ea6\u4e0d\u8d85\u8fc7$A$\u7684\u961f\u5217\uff0c\u4e0d\u65ad\u7528\u5f53\u524d$(c[i][j]-$\u961f\u5934$d[>i][j])$\u66f4\u65b0\u7b54\u6848\u5373\u53ef\u3002\n\n\u53e6\u5916\u6ce8\u610f\u82b1\u575b\u4e0d\u80fd\u4e0e\u7eff\u5316\u5e26\u91cd\u8fb9\uff0c\u7ec6\u8282\u89c1\u4ee3\u7801\uff1a\n\n```cpp\n#include <cstdio>\nusing namespace std;\n#define max(x,y) (x>y?x:y)\n#define min(x,y) (x<y?x:y)\n#define rep(t,l,r) for(int t=l;t<=r;t++)\n#define maxd 1005\nint M,N,A,B,C,D,ans;\nint a[maxd][maxd],b[maxd][maxd],c[maxd][maxd],d[maxd][maxd],mn[maxd];\n\nint main()\n{\n\tscanf(\"%d%d%d%d%d%d\", &M, &N, &A, &B, &C, &D);\n\trep(i,1,M) rep(j,1,N){\n\t\tscanf(\"%d\",&a[i][j]);\n\t\ta[i][j] = a[i][j] + a[i-1][j] + a[i][j-1] - a[i-1][j-1];\n\t}\n\trep(i,1,M-C+1) rep(j,1,N-D+1)\n\t\tb[i][j] = a[i+C-1][j+D-1] - a[i+C-1][j-1] - a[i-1][j+D-1] + a[i-1][j-1];\n\trep(i,1,M-A+1) rep(j,1,N-B+1)\n\t\tc[i][j] = a[i+A-1][j+B-1] - a[i+A-1][j-1] - a[i-1][j+B-1] + a[i-1][j-1];\n\trep(i,2,M-C){\tint h=1, t=0;\n\t\trep(j,2,N-D){\n\t\t\twhile(h <= t && b[i][j] <= b[i][mn[t]]) t--;\n\t\t\tmn[++t] = j; if(j+D >= B) d[i][j+D-B+1] = b[i][mn[h]];\n\t\t\th += (mn[h]+B-1 <= j+D)? 1: 0;\n\t\t}\n\t}\n\trep(j,1,N-B+1){\tint h=1, t=0;\n\t\trep(i,2,M-C){\n\t\t\twhile(h <= t && d[i][j] <= d[mn[t]][j]) t--;\n\t\t\tmn[++t] = i; if(i+C >= A) ans = max(ans, c[i+C-A+1][j] - d[mn[h]][j]);\n\t\t\th += (mn[h]+A-2 <= i+C)? 1: 0;\n\t\t}\n\t}\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1531296461,
        "uid": 9315,
        "name": "zhyh",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2219 \u3010[HAOI2007]\u4fee\u7b51\u7eff\u5316\u5e26\u3011"
    },
    {
        "content": "### \u5199\u4e00\u7bc7\u4e8c\u7ef4ST\u8868\u7684\u9898\u89e3\u5427...\u4e4b\u524dMLE\u548cRE\u90fd\u9047\u5230\u4e86\u51e0\u6b21\uff0c\u540e\u6765\u4fee\u6539\u4e86\u4e00\u4e0b\u5c31\u8fc7\u4e86\n\n**\u5176\u5b9e\u8fd9\u4e0d\u592a\u7b97\u771f\u6b63\u610f\u4e49\u4e0a\u7684\u4e8c\u7ef4ST\u8868\uff0c\u56e0\u4e3a\u8fd9\u9053\u9898\u7a7a\u95f4\u6709\u70b9\u5361\uff0c\u5f00$O(N^2log^2N)$\u662f\u5f88\u96be\u5361\u8fc7\u7684\uff0c\u6240\u4ee5\u9700\u8981\u628a\u4e24\u6b21ST\u5206\u5f00\uff0c\u4f46\u662f\u8fd9\u91cc\u4e5f\u7a0d\u5fae\u5199\u4e00\u4e0b\u4e8c\u7ef4ST**\n\n\u9996\u5148\u5148\u6765\u56de\u5fc6\u4e00\u7ef4\u7684ST\u8868\uff0c\u6211\u4eec\u662f\u7528\u500d\u589e\u4ee5\u53caDP\u7684\u601d\u60f3\uff0c\u5b9a\u4e49$f[i][j]$\u7684\u610f\u4e49\u4e3a\uff1a$\\min \\limits_{i \\leq x \\leq i+2^j-1} a[x]$\u3002\n\n\u90a3\u4e48\u521d\u59cb\u72b6\u6001\u5c31\u662f$f[i][0]=a[i]$\uff0c\u8f6c\u79fb\u65b9\u7a0b\u662f$f[i][j]=\\min (f[i][j-1],f[i+2^{j-1}-1][j-1])$\uff0c\u521d\u59cb\u5316\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(NlogN)$\u3002\n\n\u5728\u5904\u7406\u8be2\u95ee\u7684\u65f6\u5019\uff0c\u6211\u4eec\u4f7f\u7528\u62fc\u51d1\u7684\u65b9\u6cd5\uff0c\u4f8b\u5982\u8be2\u95ee$[x,y]$\u7684\u6700\u5c0f\u503c\u65f6\uff0c\u8bbe$k=log(y-x+1)$\uff0c\u7b54\u6848\u53ef\u4ee5$O(1)$\u5f97\u51fa\uff1a$ans=\\min (f[x][k],f[y-2^k+1][k])$\uff0c\u8fd9\u91cc\u662f\u901a\u8fc7\u5c06\u7b54\u6848\u533a\u95f4\u5206\u6210\u4e24\u4e2a\u5c3d\u91cf\u957f\u5374\u4e0d\u8d85\u51fa\u8303\u56f4\u7684\u533a\u95f4\uff0c\u5229\u7528\u6700\u5c0f\u503c\u65e0\u9700\u62c5\u5fc3\u91cd\u590d\u8ba1\u6570\u7684\u6027\u8d28\u5b8c\u6210\u7684\u3002\n\n\u90a3\u4e48\u4e8c\u7ef4ST\u8868\u5462\uff1f\n\n\u5728\u8fd9\u9898\u91cc\uff0c\u6240\u6709\u56fe\u5f62\u90fd\u662f\u77e9\u5f62\uff0c\u4e0d\u592a\u65b9\u4fbf\u8868\u793a\uff0c\u8fd9\u91cc\u4ee5[P2216\u7406\u60f3\u7684\u6b63\u65b9\u5f62](https://www.luogu.org/problemnew/show/P2216)\u4e3a\u4f8b\uff0c\u8fd9\u91cc\u7684\u56fe\u5f62\u90fd\u662f\u6b63\u65b9\u5f62\uff0c\u4e0d\u9700\u8981\u4e8c\u7ef4\u7684log\u8868\u793a\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49$f[i][j][k]=\\min \\limits_{i \\leq x \\leq i+2^k-1} (\\min \\limits_{j \\leq y \\leq j+2^k-1} a[x][y])$\uff0c\u5373\u4e00\u4e2a\u8fb9\u957f\u4e3a$2^k$\u7684\u6b63\u65b9\u5f62\u5185\u7684\u5143\u7d20\u6700\u5c0f\u503c\u3002\n\n\u6b64\u65f6\u521d\u59cb\u72b6\u6001$f[i][j][0]=a[i][j]$\uff0c\u8f6c\u79fb\u65b9\u7a0b\u6bd4\u8f83\u9ebb\u70e6\uff0c\u8981\u5c06\u4e00\u4e2a\u6b63\u65b9\u5f62\u62c6\u5206\u6210\u56db\u4e2a\u5c0f\u6b63\u65b9\u5f62\uff0c\u8fd9\u91cc\u6211\u4eec\u4ee4$l=2^{k-1}$\uff0c\u5219\u53ef\u4ee5\u5199\u51fa\u8f6c\u79fb\u65b9\u7a0b\uff1a$f[i][j][k]=\\min(f[i][j][k-1],f[i][j+l-1][k-1],f[i+l-1][j][k-1],f[i+l-1][j+l-1][k-1])$\uff08\u53ef\u4ee5\u753b\u56fe\u7406\u89e3\u4e00\u4e0b...\uff09\u8981\u6c42\u67d0\u4e00\u4e2a\u533a\u95f4\u7684\u6700\u503c\uff0c\u4e5f\u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\u62c6\u5206\u6210\u56db\u4e2a\u53ef\u4ee5\u91cd\u53e0\u7684\u6b63\u65b9\u5f62\uff0c\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u4e86\u3002\n\n\u8fd9\u9898\u662f\u8981\u6c42\u77e9\u5f62\uff0c\u53ef\u80fd\u5148\u4f1a\u60f3\u5230\u7528$f[i][j][k][l]$\u8868\u793a\u4ee5$(i,j)$\u4e3a\u5de6\u4e0a\u89d2\uff0c\u957f\u4e3a$2^k$\uff0c\u5bbd\u4e3a$2^l$\u7684\u77e9\u5f62\u6700\u5c0f\u503c\uff0c\u4f46\u662f\u4f1a\u53d1\u73b0\u8fd9\u6837\u65f6\u95f4\u548c\u7a7a\u95f4\u590d\u6742\u5ea6\u90fd\u662f$O(N^2log^2N)$\uff0c\u5728\u8fd9\u9898\u91cc\u53ef\u80fd\u65e0\u6cd5\u901a\u8fc7\uff0c\u4e8e\u662f\u60f3\u529e\u6cd5\u4f18\u5316\uff0c\u53ef\u4ee5\u8003\u8651\u7684\u4f18\u5316\u65b9\u6cd5\u5c31\u662f\u5c06\u4e24\u6b21ST\u7684\u8fc7\u7a0b\u62c6\u5f00\u3002\n\n\u8fd9\u91cc\u6211\u501f\u7528\u7684\u9898\u89e3\u4e2d\u67d0\u4e2a\u5355\u8c03\u961f\u5217\u89e3\u6cd5\u7684\u601d\u60f3\uff0c\u5c31\u662f\u9996\u5148\u7b97\u51fa**\u5728\u540c\u4e00\u884c\u5185\uff0c\u957f\u5ea6\u4e3aB-D-2\u7684\u6bcf\u4e2a\u533a\u95f4\u6700\u5c0f\u503c**\uff0c\u518d\u901a\u8fc7\u8fd9\u4e2a\u7ed3\u679c\u7b97\u51fa**\u5728\u540c\u4e00\u5217\u5185\uff0c\u957f\u5ea6\u4e3aA-C-2\u7684\u6bcf\u4e2a\u533a\u95f4\u6700\u5c0f\u503c\uff0c\u8fd9\u91cc\u7684\u533a\u95f4\u6307\u7684\u662f\u7531\u4e0a\u4e00\u4e2a\u6570\u7ec4\u7ec4\u6210\u7684\u533a\u95f4**\uff0c\u4e5f\u5c31\u662f\u5148\u5904\u7406\u884c\uff0c\u518d\u901a\u8fc7\u5df2\u77e5\u884c\u7684\u7ed3\u679c\u6c42\u89e3\u5217\uff0c\u8fd9\u4e24\u4e2a\u8fc7\u7a0b\u90fd\u53ef\u4ee5\u901a\u8fc7\u4e00\u7ef4\u7684ST\u8868\u6765\u5b8c\u6210\uff0c\u7c7b\u4f3c\u5730\u505a\u4e24\u6b21\uff0c\u5c31\u5b9e\u73b0\u4e86\u4e8c\u7ef4ST\u8868\u7684\u6548\u679c\uff0c\u65f6\u95f4\u548c\u7a7a\u95f4\u590d\u6742\u5ea6\u4ec5\u4e3a$O(N^2logN)$\uff08\u5982\u679c\u7a7a\u95f4\u4f7f\u7528\u6eda\u52a8\uff0c\u90a3\u4e48\u8fd8\u53ef\u4ee5\u53bb\u6389log\uff09\uff0c\u8fd9\u5c31\u53ef\u4ee5\u5b8c\u6210\u8fd9\u9898\u4e86\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int MAXN=1410;\nint n,m,a,b,c,d,v[MAXN][MAXN],sum[MAXN][MAXN];\nint p[MAXN][MAXN],minr[MAXN][MAXN],minc[MAXN][MAXN],f[MAXN][12],l[MAXN],ans;\nint calca (int i,int j) {\n\treturn sum[i+a-1][j+b-1]+sum[i-1][j-1]-sum[i-1][j+b-1]-sum[i+a-1][j-1];\n}\nint calcc (int i,int j) {\n\treturn sum[i+c-1][j+d-1]+sum[i-1][j-1]-sum[i-1][j+d-1]-sum[i+c-1][j-1];\n}\nint main () {\n\tmemset(f,0x3f,sizeof(f));\n\tscanf(\"%d%d%d%d%d%d\",&n,&m,&a,&b,&c,&d);\n\tfor (int i=1;i<=n;i++) {\n\t\tfor (int j=1;j<=m;j++) {\n\t\t\tscanf(\"%d\",&v[i][j]);\n\t\t\tsum[i][j]=sum[i-1][j]+sum[i][j-1]-sum[i-1][j-1]+v[i][j];\n\t\t}\n\t}\n\tl[0]=-1;\n\tfor (int i=1;i<=max(n,m);i++) {\n\t\tl[i]=l[i/2]+1;\n\t}\n\tfor (int i=2;i<=n-c;i++) {\n\t\tmemset(f,0x3f,sizeof(f));\n\t\tfor (int j=2;j<=m-d;j++) {\n\t\t\tf[j][0]=calcc(i,j);\n\t\t}\n\t\tfor (int k=1;k<=l[m];k++) {\n\t\t\tfor (int j=2;j+(1<<k)-1<=m-d;j++) {\n\t\t\t\tf[j][k]=min(f[j][k-1],f[j+(1<<(k-1))][k-1]);\n\t\t\t}\n\t\t}\n\t\tfor (int j=2;j<=m-d;j++) {\n\t\t\tint k=l[b-d-1];\n\t\t\tminr[i][j]=min(f[j][k],f[j+b-d-1-(1<<k)][k]);\n\t\t}\n\t}\n\tfor (int j=2;j<=m-d;j++) {\n\t\tmemset(f,0x3f,sizeof(f));\n\t\tfor (int i=2;i<=n-c;i++) {\n\t\t\tf[i][0]=minr[i][j];\n\t\t}\n\t\tfor (int k=1;k<=l[n];k++) {\n\t\t\tfor (int i=2;i+(1<<k)-1<=n-c;i++) {\n\t\t\t\tf[i][k]=min(f[i][k-1],f[i+(1<<(k-1))][k-1]);\n\t\t\t}\n\t\t}\n\t\tfor (int i=2;i<=n-c;i++) {\n\t\t\tint k=l[a-c-1];\n\t\t\tminc[i][j]=min(f[i][k],f[i+a-c-1-(1<<k)][k]);\n\t\t}\n\t}\n\tfor (int i=1;i<=n-a+1;i++) {\n\t\tfor (int j=1;j<=m-b+1;j++) {\n\t\t\tans=max(ans,calca(i,j)-minc[i+1][j+1]);\n\t\t}\n\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1550666476,
        "uid": 113546,
        "name": "ix35",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P2219 \u3010[HAOI2007]\u4fee\u7b51\u7eff\u5316\u5e26\u3011"
    },
    {
        "content": "# \u4fee\u7b51\u7eff\u5316\u5e26\u9898\u89e3\n\n\u6211\u7684\u505a\u6cd5\u5b9e\u9645\u4e0a\u795e\u5947\u4e14\u9ebb\u70e6\uff0c\u5927\u5bb6\u770b\u4e4b\u524d\u8bf7\u505a\u597d\u5fc3\u7406\u51c6\u5907\u3002\n\n\u8fd9\u662f\u4e00\u4e2a\u5355\u8c03\u961f\u5217\u4f18\u5316DP\u9898\uff08~~\u5e9f\u8bdd~~\uff09\u3002\n\n\u6211\u7684\u5927\u6982\u505a\u6cd5\u662f\uff1a\n\n\u5c06\u6bcf\u4e2ac\u4e58d\u7684\u77e9\u5f62\u5316\u6210\u4e00\u4e2a\u70b9\uff0c\u5c06\u4ecea\u4e58b\u7684\u77e9\u5f62\u4e2d\u9009\u4e00\u4e2ac\u4e58d\u7684\u77e9\u5f62\u8f6c\u5316\u4e3a\uff1a\u5728(a-c+1)*(b-d+1)\u7684\u77e9\u5f62\u4e2d\u9009\u4e00\u4e2a\u503c\u6700\u5c0f\u7684\u70b9\u3002\n\n\u5177\u4f53\u505a\u6cd5\u5982\u4e0b\uff1a\n\n1.\u6c42\u51fa\u4e8c\u7ef4\u524d\u7f00\u548cp\uff0c\u518d\u6c42\u51fa\u4ee5\u4e00\u4e2a\u70b9\u4e3a\u5de6\u4e0a\u89d2\u7684c\u4e58d\u7684\u77e9\u5f62\u7684\u503c\u4e4b\u548ca\u3002\n\n2.\u6c42\u51fa\u6bcf\u4e00\u4ee5\u67d0\u70b9\u5f00\u59cb\u7684\u957f\u5ea6\u4e3aa-c+1\u7684\u5217\u7684\u6700\u5c0f\u503csum\u3002\n\n3.\u5269\u4e0b\u7684\u5c31\u662f\u5728n-a+1\u884c\u4e0a\uff0c\n\n\u6bcf\u4e00\u884c\u6c42\u51fa\u957f\u5ea6\u4e3ab-d+1\u7684sum\u6700\u5c0f\u503c\n\n(\u5b9e\u9645\u4e0a\u5c31\u662f\u6bcf\u4e2aa\u4e58b\u7684\u77e9\u5f62\u4e2dc\u4e58d\u77e9\u5f62\u7684\u6700\u5c0f\u503c)\uff0c\n\nans\u8ddfa\u4e58b\u77e9\u5f62\u6743\u503c\u548c-\u6700\u5c0f\u503c\u53d6max\u5373\u53ef\u3002\n\n\u5177\u4f53\u770b\u4ee3\u7801\u5427\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1006;\nint n,m,t1,t2,t3,t4,t,head=1,tail=0,p[N][N],a[N][N],sum[N][N],q[N],ans=-1;\ninline int read(){\n   int T=0,F=1; char ch=getchar();\n   while(ch<'0'||ch>'9'){if(ch=='-') F=-1; ch=getchar();}\n   while(ch>='0'&&ch<='9') T=(T<<3)+(T<<1)+(ch-48),ch=getchar(); \n   return F*T; \n}\nint main(){\n    n=read(),m=read(),t1=read(),t2=read(),t3=read(),t4=read();\n    for(int i=1;i<=n;++i) for(int j=1;j<=m;++j) p[i][j]=read(),p[i][j]=p[i-1][j]+p[i][j-1]-p[i-1][j-1]+p[i][j];\n    for(int i=1;i<=n-t3+1;++i) for(int j=1;j<=m-t4+1;++j) a[i][j]=p[i+t3-1][j+t4-1]-p[i+t3-1][j-1]+p[i-1][j-1]-p[i-1][j+t4-1];\n    for(int i=1;i<=m-t4+1;++i){\n        tail=0,head=1;\n        for(int j=2;j<=t1-t3;++j){\n            while(tail&&a[q[tail]][i]>=a[j][i]) --tail;\n            q[++tail]=j;\n        }\n        for(int j=1;j<=n-t1+1;++j){ \n            sum[j][i]=a[q[head]][i];\n            while(q[head]<=j+1&&head<=tail) ++head;\n            while(tail>=head&&a[q[tail]][i]>=a[j+t1-t3][i]) --tail;\n            q[++tail]=j+t1-t3;\n        } \n    }\n    for(int i=1;i<=n-t1+1;++i){\n        head=1,tail=0;\n        for(int j=2;j<=t2-t4;++j){\n            while(tail&&sum[i][q[tail]]>=sum[i][j]) --tail;\n            q[++tail]=j;\n        }\n        for(int j=1;j<=m-t2+1;++j){ \n            ans=max(ans,p[i-1][j-1]-p[i-1][j+t2-1]+p[i+t1-1][j+t2-1]-p[i+t1-1][j-1]-sum[i][q[head]]);\n            while(q[head]<=j+1&&head<=tail) ++head;\n            while(tail>=head&&sum[i][q[tail]]>=sum[i][j+t2-t4]) --tail;\n            q[++tail]=j+t2-t4;\n        } \n    }\n    printf(\"%d\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1567777767,
        "uid": 44180,
        "name": "ljk123",
        "ccfLevel": 0,
        "title": "\u4fee\u7b51\u7eff\u5316\u5e26\u9898\u89e3"
    },
    {
        "content": " [$$ \\Large \\texttt{My Blog} $$](http://blog.flyinthesky.win/Luogu2219/)\n\n------------\n\n\u9898\u610f\uff1a\u5728$n \\times m$\u7684\u77e9\u9635\u4e2d\u627e\u51fa\u4e00\u5757$a \\times b$\u7684\u77e9\u5f62\uff0c\u5728\u8fd9\u4e2a\u77e9\u5f62\u4e2d\u627e\u51fa\u4e00\u5757$c \\times d$\u7684\u77e9\u5f62(\u5fc5\u987b\u5728\u5185\u90e8)\uff0c\u5f97\u5206\u4e3a$a \\times b$\u7684\u77e9\u5f62\u5206\u6570\u51cf\u53bb$c \\times d$\u7684\u77e9\u5f62\uff0c\u6c42\u5206\u6570\u6700\u5927\u7684$a \\times b$\u7684\u77e9\u5f62\uff0c\u8f93\u51fa\u5206\u6570\u3002\n\n\u7ec6\u8282\u9898\n\n\u8fd9\u9898\u611f\u89c9\u7c7b\u4f3c[Bzoj 1047](/bzoj1047)\uff0c\u95ee\u6cd5\u7c7b\u4f3c\uff0c\u5e76\u4e14\u90fd\u662f\u538b\u7f29\u4e86\u4e00\u6bb5\u533a\u95f4\u7136\u540e\u8fb9\u6210\u5e8f\u5217\u95ee\u9898\u3002\n\n\u8fd9\u9898\u53ef\u4ee5\u8003\u8651\u679a\u4e3e\u6bcf\u4e2a$a \\times b$\u7684\u77e9\u5f62\uff0c\u7136\u540e\u6bcf\u6b21\u5728\u77e9\u5f62\u4e2d\u627e\u51fa\u4e00\u5757\u5206\u6570\u6700\u5c0f\u7684$c \\times d$\u7684\u77e9\u5f62(\u6ce8\u610f\u5fc5\u987b\u5728\u5185\u90e8)\uff0c\u7136\u540e\u51cf\u6389\u5373\u53ef\u3002\n\n1\u3001 \u5148\u9884\u5904\u7406$n \\times m$\u7684\u77e9\u9635\u7684\u4e8c\u7ef4\u524d\u7f00\u548c\n\n2\u3001 \u7136\u540e\u9884\u5904\u7406\u6bcf\u4e2a$\\{(x,y) | x+c \\leq m, y+d \\leq n \\}$\u4e3a\u5de6\u4e0a\u89d2\u7684$c \\times d$\u7684\u77e9\u5f62\u7684\u5206\u503c\u548c\u8bb0\u4e3a$S(x,y)$\n\n3\u3001 \u5bf9\u4e8e\u6bcf\u4e2a$\\{(x,y) | x+c \\leq m, y+d \\leq n\\}$\uff0c\u8bb0\u5f55\n$$C(x,y)=\\min\\limits_{1 \\leq i \\leq a - 2 -c +1}\\{S(x+i-1,y)\\}$$\n\n\u8fd9\u4e2a\u76f8\u5f53\u4e8e\u628a\u8fd9\u4e2a$a \\times b$\u7684\u77e9\u5f62\u7684\u4e00\u5217\u51b3\u7b56\u70b9\u90fd\u538b\u7f29\u6210\u4e00\u4e2a\u5143\u7d20\n\n4\u3001\u5bf9\u4e8e\u6bcf\u884c$\\{x | x+a-1 \\leq m\\}$, \u6bcf\u5217$\\{y|y \\geq 2, y+d-1\\leq n\\}$\uff0c\u5355\u8c03\u961f\u5217\u8bb0\u5f55\n\n$$\\min\\limits_{y \\in [y-(b - 2 - d + 1 + 1), y]}\\{C(x+1,k)\\}$$\n\n\u7136\u540e\u5f97\u5230\u4e86\u6700\u5c0f\u503c\uff0c\u6309\u4e0a\u9762\u65b9\u6cd5\u8ba1\u7b97\u5373\u53ef\n\n( \u8303\u56f4\u4ec0\u4e48\u7684\u8fd8\u662f\u81ea\u5df1\u7b97\u7b97\u5427\uff0c\u592a\u6742\u4e71\u4e86\u53ef\u80fd\u4e0a\u9762\u7684\u516c\u5f0f\u4f1a\u6709\u9519\u8bef",
        "postTime": 1550491427,
        "uid": 12943,
        "name": "FlyInTheSky",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2219 \u3010[HAOI2007]\u4fee\u7b51\u7eff\u5316\u5e26\u3011"
    },
    {
        "content": "## Solution\n\n### \u524d\u8bb0\n\n\u4e00\u5f00\u59cb\u6ca1\u770b\u61c2\u9898\u610f\uff0c\u4ee5\u4e3a\u8981\u81ea\u5df1\u6c42A\uff0cB\uff0cC\uff0cD\u3002\u60f3\u4e86\u534a\u5929\uff0c\u7ed3\u679c\u6253\u5f00\u9898\u89e3\u4e00\u770b\u8bfb\u5165\uff0c\u5982\u68a6\u521d\u9192\uff0c\u7136\u540e\u5c31\u8f7b\u677e\u809d\u51fa\u6765\u4e86\u3002\n\n### \u8f6c\u5316\n\n\u6211\u4eec\u73b0\u5728\u628a\u9898\u610f\u6362\u79cd\u8bf4\u6cd5\uff0c\u76f8\u5f53\u4e8e\u8ba9\u6c42\u6bcf\u4e00\u4e2aA*B\u7684\u77e9\u9635\u91cc\u6700\u5c0f\u7684CxD\u7684\u5b50\u77e9\u9635\u548c\uff0c\u770b\u8d77\u6765\u4e0d\u592a\u597d\u6c42\uff0c\u4f46\u6211\u4eec\u5176\u5b9e\u53ef\u4ee5\u628a\u77e9\u9635\u548c\u8f6c\u5316\u4e3a\u4e00\u4e2a\u6570\uff0c\u65b0\u5f00\u4e00\u4e2a\u6570\u7ec4\u8bb0\u5f55\u4ee5\u5f53\u524d\u70b9\u4e3a\u53f3\u4e0b\u89d2\u7684CxD\u77e9\u9635\u548c\u3002\n\n\u6c42\u6cd5\uff0c\u4e8c\u7ef4\u524d\u7f00\u548c\uff0c\u5bb9\u65a5\uff0c\u5728\u6b64\u4e0d\u8d58\u8ff0\u4e86\u3002\n\n### \u5b9e\u73b0\n\n1. \u901a\u8fc7\u4e8c\u7ef4\u524d\u7f00\u548c\u7ef4\u62a4\u51fa\u6bcf\u4e2a\u53f3\u4e0b\u89d2\u77e9\u9635\u548c\u3002\n2. \u4e24\u6b21\u5355\u8c03\u961f\u5217\uff0c\u4e00\u6a2a\u4e00\u7ad6\uff0c\u8dd1\u51fa\u6bcf\u4e2a\u53f3\u4e0b\u89d2AxB\u77e9\u9635\u91cc\uff0c\u6700\u5c0f\u7684\u90a3\u4e2a\u5b50\u77e9\u9635\u548c\u3002\n3. \u6700\u540e\u904d\u5386\u4e00\u904d\u6bcf\u4e2a\u53f3\u4e0b\u89d2\uff0c\u7528\u8fd9\u4e2a\u77e9\u9635\u7684\u9762\u79ef-\u6700\u5c0f\u5b50\u77e9\u9635\u9762\u79ef\uff0c\u53d6max\u5373\u53ef\u3002\n\n### \u6ce8\u610f\n\n\u5305\u542b\u5173\u7cfb\uff0c\u8981\u6c42\u81f3\u5c11\u67091\u4e2a\u683c\u7684\u8fb9\u6846\uff0c\u5b9e\u73b0\u4e00\u4e9b\u7ec6\u8282\u4e0d\u591a\u8bf4\u4e86\uff0c\u4e0d\u7136\u6837\u4f8b\u90fd\u8fc7\u4e0d\u4e86\u3002\n\n## Code\n\n```c++\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <cmath>\nusing namespace std;\n\nint val[1005][1005],f[1005][1005],g[1005][1005];\nint M,N,A,B,C,D;\nint cal1(int x,int y)\n{\n    return val[x][y]-val[x-C][y]-val[x][y-D]+val[x-C][y-D];\n}\n\nint cal2(int x,int y)\n{\n    return val[x][y]-val[x-A][y]-val[x][y-B]+val[x-A][y-B];\n}\n\nint main()\n{\n    scanf(\"%d%d%d%d%d%d\",&M,&N,&A,&B,&C,&D);\n    for(int i=1;i<=M;i++)\n    {\n        for(int j=1;j<=N;j++)\n        {\n            scanf(\"%d\",&val[i][j]);\n            val[i][j]+=val[i-1][j]+val[i][j-1]-val[i-1][j-1];\n        }\n    }\n\n    int q[1005][2];\n    //memset(g,0x3f,sizeof(g));\n    //memset(f,0x3f,sizeof(f));\n    // printf(\"\\n\");\n    // for(int i=1;i<=M;i++)\n    // {\n    //     for(int j=1;j<=N;j++)\n    //     {\n    //         printf(\"%d \",val[i][j]);\n    //     }\n    //     printf(\"\\n\");\n    // }\n    // printf(\"\\n\");\n\n    for(int i=C+1;i<M;i++)\n    {\n        memset(q,0,sizeof(q));\n        int head=1,tail=0;\n        for(int j=D+1;j<N;j++)\n        {\n            while(head<=tail && q[head][0]-D<j+2-B)head++;\n            while(head<=tail && q[tail][1]>=cal1(i,j))tail--;\n            q[++tail][0]=j;\n            q[tail][1]=cal1(i,j);\n            if(j>=B-1)g[i][j+1]=q[head][1];\n        }\n    }\n    \n    // for(int i=1;i<=M;i++)\n    // {\n    //     for(int j=1;j<=N;j++)\n    //     {\n    //         printf(\"%d \",g[i][j]);\n    //     }\n    //     printf(\"\\n\");\n    // }\n    // printf(\"\\n\");\n\n    for(int j=B;j<=N;j++)\n    {\n        memset(q,0,sizeof(q));\n        int head=1,tail=0;\n        for(int i=C+1;i<M;i++)\n        {\n            while(head<=tail && q[head][0]-C<i+2-A)head++;\n            while(head<=tail && q[tail][1]>=g[i][j])tail--;\n            q[++tail][0]=i;\n            q[tail][1]=g[i][j];\n            if(i>=A-1)f[i+1][j]=q[head][1];\n        }\n    }\n    int res=0;\n    for(int i=A;i<=M;i++)\n    {\n        for(int j=B;j<=N;j++)\n        {\n            res=max(res,cal2(i,j)-f[i][j]);\n        }\n    }\n    // for(int i=1;i<=M;i++)\n    // {\n    //     for(int j=1;j<=N;j++)\n    //     {\n    //         printf(\"%d \",f[i][j]);\n    //     }\n    //     printf(\"\\n\");\n    // }\n    printf(\"%d\",res);\n    return 0;\n}\n```\n\n",
        "postTime": 1550414705,
        "uid": 63925,
        "name": "joe19025",
        "ccfLevel": 0,
        "title": "\u5355\u8c03\u961f\u5217\u2014\u2014P2219 [HAOI2007]\u4fee\u7b51\u7eff\u5316\u5e26"
    },
    {
        "content": "\u770b\u5230\u8fd9\u79cd\u95ee\u9898\uff0c\u9996\u5148\u60f3\u5230\u7684\u4e00\u5b9a\u662f\u901a\u8fc7\u5355\u8c03\u961f\u5217\u7528\u4e24\u6b21\uff0c\u5206\u522b\u7ef4\u62a4\u6a2a\u7ad6\u533a\u95f4\u4fe1\u606f\u3002\n\n\u672c\u9898\u7684\u8bdd\uff0c\u53ef\u4ee5\u5148\u5c06\u6240\u6709\u7684a*b\u4ee5\u53cac*d\u7684\u503c\u5904\u7406\u51fa\u6765\u3002\n\n\u9274\u4e8e\u662fab\u4e2d\u5d4c\u5957\u4e00\u4e2acd\u77e9\u9635\uff0c\u53ef\u4ee5\u5c06cd\u89c6\u4e3a\uff08a-2\uff09\uff08b-2\uff09\u4e2d\u5b50\u77e9\u9635\u4e2d\u7684\u6700\u5c0f\u503c\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u7ec4cd\u4e2d\u7684\uff08i\uff0cj\uff09\uff0c\u53ef\u4ee5\u5c06\u4ed6\u5bf9\u5e94\u5230\u76f8\u5e94\u7684ab\u4e2d\u7684\uff08i - 1\uff0cj - 1\uff09\uff0c\u7136\u540e\u5c06ab\u7684\u503c\u526a\u6389\u6700\u5c0f\u7684cd\u7684\u503c\uff0c\u5c31\u662f\u8fd9\u4e2aab\u77e9\u9635\u7684\u6700\u5927\u503c\uff0c\u6700\u540e\u5bf9\u6bcf\u4e2aab\u77e9\u9635\u90fd\u51cf\u4e00\u904d\uff0c\u53d6\u5230\u7684\u6700\u5927\u503c\u4fbf\u662f\u7b54\u6848\n\u4ee3\u7801\u5199\u7684\u5783\u573e\uff0c\u89c1\u8c05\uff0c\u51d1\u5408\u7740\u770b\n\n\n```\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\nconst int maxn = 1e3 + 5;\n\nint A[1005][1005];\nint sum1[maxn][maxn], sum2[maxn][maxn], sum3[maxn][maxn], sum4[maxn][maxn], cnt[maxn][maxn], C[maxn][maxn];\n\nint main () {\n#ifndef ONLINE_JUDGE\n    //int start = clock();\n    freopen(\"in.txt\", \"r\", stdin);\n    freopen(\"out.txt\", \"w\", stdout);\n#endif\n    int m, n, a, b, c, d;\n    cin >> n >> m >> a >> b >> c >> d;\n    for (int i = 1; i <= n; i++) {\n        for (int j = 1; j <= m; j++) {\n            cin >> A[i][j];\n        }\n    }\n    for (int i = 1; i <= n; i++) {\n        int now = 0;\n        for (int j = 1; j <= m; j++) {\n            now += A[i][j];\n            if (j >= b) {\n                sum1[i][j - b + 1] = now;\n                now -= A[i][j - b + 1];\n            }\n        }\n    }\n    for (int i = 1; i <= m - b + 1; i++) {\n        int now = 0;\n        for (int j = 1; j <= n; j++) {\n            now += sum1[j][i];\n            if (j >= a) {   \n                sum2[j - a + 1][i] = now;\n                now -= sum1[j - a + 1][i]; \n            }\n        }\n    }//\u5904\u7406\u51faab\u7684\u503c\n\n    for (int i = 1; i <= n; i++) {\n        int now = 0;\n        for (int j = 1; j <= m; j++) {\n            now += A[i][j];\n            if (j >= d) {\n                sum3[i][j - d + 1] = now;\n                // cout << sum3[i][j - d + 1] << \" \";\n                now -= A[i][j - d + 1];\n            } \n        }\n        // cout << endl;\n    }\n    // cout << endl;\n    for (int j = 1; j <= m - d + 1; j++) {\n        int now = 0;\n        for (int i = 1; i <= n; i++) {\n            now += sum3[i][j];\n            if (i >= c) {\n                sum4[i - c + 1][j] = now;\n                now -= sum3[i - c + 1][j];\n                // cout << sum4[i - c + 1][j] << \" \";\n            }\n        }\n    }//\u5904\u7406\u51facd\u7684\u503c\n    \n    // for (int i = 1; i <= n - c + 1; i++)  {\n    //     for (int j = 1; j <= m - d + 1; j++) {\n    //         cout << sum4[i][j] << \" \";\n    //     }\n    //     cout << endl;\n    // }\n    // cout << endl;\n\n    int len = b - d - 1;\n    for (int i = 2; i <= n - c; i++) {\n        int l = 1, r = 0;\n        int h[maxn];\n        for (int j = 2; j <= m - d; j++) {\n            while (r >= l && sum4[i][h[r]] >= sum4[i][j]) r--;\n            h[++r] = j;\n            while (h[l] <= j - len) ++l;\n            if (j >= len + 1) {\n                // cout << l << \" \" << r << endl;\n                // cout << h[l] << endl;\n                cnt[i - 1][j - len] = sum4[i][h[l]];\n            }\n        }\n        // cout << endl;\n    }//\u5904\u7406\u51faab\u4e2d\u7684cd\u6a2a\u884c\u4e2d\u7684\u6700\u5c0f\u503c\n    // for (int i = 1; i < n - c; i++) {\n    //     for (int j = 1; j <= m - d - len; j++) {\n    //         cout << cnt[i][j] << \" \";\n    //     }\n    //     cout << endl;\n    // }\n\n    int len2 = a - c - 1;\n    for (int j = 1; j <= m - d - len; j++) {\n        int l = 1, r = 0;\n        int h[maxn];\n        for (int i = 1; i <= n - c; i++) {\n            while (r >= l && cnt[i][j] <= cnt[h[r]][j]) r--;\n            h[++r] = i;\n            while (h[l] <= i - len2) ++l;\n            if (i >= len2) {\n                C[i - len2 + 1][j] = cnt[h[l]][j]; \n                // cout << cnt[i - len2][j] << \" \";\n            }\n            // cout << endl;\n\n        }\n    }//\u5408\u5e76\u6a2a\u884c\u4ee5\u53ca\u7ad6\u884c\u7684\u6700\u5c0f\u503c\n\n    int ans = 0;\n\n    for (int i = 1; i <= n - a + 1; i++) {\n        for (int j = 1; j <= m - b + 1; j++) {\n            ans = max(ans, sum2[i][j] - C[i][j]);\n        }\n    }\n    cout << ans << endl;\n\n    //cout << clock() - start;\n    return 0;\n}\n```",
        "postTime": 1572447619,
        "uid": 232955,
        "name": "mo_om",
        "ccfLevel": 0,
        "title": "\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u7ef4\u533a\u95f4"
    }
]
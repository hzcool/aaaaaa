[
    {
        "content": "\u8fd9\u662f\u300cDaniel13265 \u7684\u516c\u5f00\u8d5b\u300d\u7684\u5b98\u65b9\u9898\u89e3\u3002\n\n---\n\n## \u6d4b\u8bd5\u70b9 $1$\n\n$$M=\\left(a^2+b^2\\right)\\left(p^2+q^2\\right).$$\n\n\u4ee4  $p=1,q=r=s=0$ \u5373\u53ef\uff0c\u6b64\u65f6 $M=a^2+b^2$\u3002\n\n## \u6d4b\u8bd5\u70b9 $2$\n\n$$\\begin{aligned}M&=\\Big|b^2\\left(p^2+q^2\\right)+d^2\\left(r^2+s^2\\right)+2bd\\big(pr-qs\\big)\\Big|\\\\&=\\Big|\\big(b^2p^2+d^2r^2+2bdpr\\big)+\\big(b^2q^2+d^2s^2-2bdqs\\big)\\Big|\\\\&=\\Big|(bp+dr)^2+(bq-ds)^2\\Big|\\\\&=(bp+dr)^2+(bq-ds)^2.\\end{aligned}$$\n\n\u6545\u6709 $\\gcd^2(b,d)|M$ \u3002\n\n\u4ee4 $q=s=0$ \uff0c\u5219\u53ea\u8981\u627e\u51fa\u4e24\u4e2a\u6574\u6570 $p,r$ \u4f7f\u5f97 $bp+dr=\\gcd(b,d)$ \uff0c\u76f4\u63a5\u4f7f\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u5373\u53ef\u3002\u6b64\u65f6 $M=\\gcd^2(b,d)$ \u3002\n\n## \u6d4b\u8bd5\u70b9 $3$\n\n$$M=\\Big|a^2\\left(p^2+q^2\\right)+c^2\\left(r^2+s^2\\right)+2ac\\big(pr-qs\\big)\\Big|.$$\n\n\u4e0e\u6d4b\u8bd5\u70b9 $2$ \u76f8\u540c\uff0c\u7565\u3002\n\n## \u6d4b\u8bd5\u70b9 $4$\n\n\u8bbe $b=ka,d=kc$ \uff0c\u5219\u6709\n\n$$\\begin{aligned}M&=\\big(ap+cr\\big)^2+\\big(aq-cs\\big)^2+\\big(bq-ds\\big)^2+\\big(bp+dr\\big)^2\\\\&=\\big(k^2+1\\big)\\Big[(ap+cr\\big)^2+\\big(aq-cs\\big)^2\\Big].\\end{aligned}$$\n\n\u540c\u6d4b\u8bd5\u70b9 $2$ \uff0c\u7565\u3002\n\n## \u6d4b\u8bd5\u70b9 $5$\n\n\u731c\u6d4b $|p|,|q|,|r|,|s|\\leq10$ \uff0c\u76f4\u63a5\u679a\u4e3e\u5373\u53ef\u3002\n\n## \u6d4b\u8bd5\u70b9 $6\\sim10$ \n\n$$\\begin{aligned}M&=\\Big|(bq-ds)^2+(bp+dr)^2+(ap+cr)^2+(-aq+cs)^2+2(bc-ad)(ps+qr)\\Big|\\\\&=\\Big|(ap+bq+cr-ds)^2+(-aq+bp+cs+dr)^2\\Big|\\\\&=(ap+bq+cr-ds)^2+(-aq+bp+cs+dr)^2.\\end{aligned}$$\n\n\u6784\u9020\u590d\u6570 $A=a+bi,x=p-qi,B=c+di,y=r+si$ \uff0c\u5219 $M=\\big|Ax+By\\big|^2$\uff0c\u4f7f\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u6c42\u89e3\u5373\u53ef\u3002\u5982\u679c\u8ba4\u4e3a $|a|,|b|,|c|,|d|$ \u540c\u9636\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal O\\left(\\log|a|\\right)$\u3002\n\n\u53e6\u5916\uff0c\u89c2\u5bdf\u5927\u6837\u4f8b\u731c\u6d4b\u5230 $M=\\gcd\\left(a^2+b^2,c^2+d^2,2|ac+bd|,2|bc-ad|\\right)$ \u53ef\u4ee5\u5f97\u5230\u6bcf\u4e2a\u6d4b\u8bd5\u70b9 $40\\%$ \u7684\u5206\u6570\u3002\n\n## \u8865\u5145\uff1a\u9ad8\u65af\u6574\u6570\u7684\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\n\n\u7531\u4e8e\u9898\u89e3\u754c\u9762\u4e2d\u5e0c\u814a\u5b57\u6bcd\u7684\u6e32\u67d3\u5b9e\u5728\u79f0\u4e0d\u4e0a\u597d\u770b\uff0c\u56e0\u6b64\u5efa\u8bae\u6b64\u90e8\u5206\u5230[\u535a\u5ba2](/blog/daniel13265/solution-difference)\u4e2d\u67e5\u770b\u3002\n\n---\n\n#### \u5b9a\u4e49\uff08\u8303\u6570\uff09\n\n$\\alpha=a+bi\\in\\mathbb Q[i]$ \u7684\u8303\u6570 $N(\\alpha)=a^2+b^2=|\\alpha|^2$\u3002\n\n#### \u4e00\u4e2a\u5f15\u7406\n\n\u5bf9\u4e8e $\\alpha,\\beta\\in\\mathbb Q[i]$\uff0c\u6709 $N(\\alpha\\beta)=N(\\alpha)N(\\beta)$\u3002\n\n**\u8bc1\u660e\uff1a** \u8bbe $\\alpha=p+qi,\\beta=r+si$\uff0c\u5219\n\n$$\\begin{aligned}N(\\alpha\\beta)&=(pr-qs)^2+(ps+qr)^2\\\\&=p^2r^2+p^2s^2+q^2r^2+q^2s^2\\\\&=\\left(p^2+q^2\\right)\\left(r^2+s^2\\right)\\\\&=N(\\alpha)N(\\beta)\\end{aligned}$$\n\n#### \u5b9a\u7406\uff08\u5e26\u4f59\u9664\u6cd5\uff09\n\n\u5bf9\u4e8e $\\alpha,\\beta\\in\\mathbb Z[i],\\alpha\\neq0$\uff0c\u4e00\u5b9a\u5b58\u5728 $\\eta,\\gamma\\in\\mathbb Z[i]$ \u4f7f\u5f97\n\n$$\\beta=\\eta\\alpha+\\gamma,\\qquad0\\le N(\\gamma)\\leq\\frac12N(\\alpha)$$\n\n**\u8bc1\u660e\uff1a** \u8bbe $\\tau=p+qi=\\dfrac\\beta\\alpha\\in\\mathbb Q[i]$\uff0c\u53d6 $r,s\\in\\mathbb Z$ \u4e14 $|p-r|\\le\\dfrac12,|q-s|\\le\\dfrac12$\uff0c\u53d6 $\\eta=r+si$\uff0c\u5219\u6709\n\n$$N(\\tau-\\eta)=(p-r)^2+(q-s)^2\\le\\dfrac12$$\n\n\u56e0\u4e3a $\\gamma=\\beta-\\eta\\alpha=(\\tau-\\eta)\\alpha$\uff0c\u6240\u4ee5\u7531\u4e0a\u9762\u7684\u5f15\u7406\u6709\n\n$$N(\\gamma)=N(\\tau-\\eta)N(\\alpha)\\le\\frac12N(\\alpha)$$\n\n\u56e0\u6b64\uff0c\u4eff\u7167\u6574\u6570\u8bb0 $\\eta=\\left\\lfloor\\dfrac\\beta\\alpha\\right\\rfloor,\\gamma=\\beta\\mod\\alpha$\uff0c\u4e8e\u662f\u5c31\u53ef\u4ee5\u4f7f\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u4e86\u3002\n\n\u7531\u4e8e\u4f5c\u4e00\u6b21\u9664\u6cd5\u65f6\u8303\u6570\u5c06\u51cf\u5c0f\u81f3\u5c11\u4e00\u534a\uff0c\u56e0\u6b64\u590d\u6570\u57df\u7684\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal O\\left(\\log N(\\alpha)\\right)$\u3002",
        "postTime": 1584857396,
        "uid": 55251,
        "name": "Daniel13265",
        "ccfLevel": 10,
        "title": "\u300cDaniel13265 \u7684\u516c\u5f00\u8d5b\u300d\u9898\u89e3\u3010\u5dee\u522b\u3011"
    },
    {
        "content": "\u6211\u6765\u8865\u4e00\u4e2a\u4ee3\u7801\uff0c~~\u5e2e\u52a9\u90a3\u4e9b\u50cf\u6211\u4e00\u6837\u770b\u61c2\u4e86\u610f\u601d\u4f46\u4e0d\u77e5\u9053\u600e\u5199\u7684\u7ae5\u978b~~\n\n\u53ea\u9700\u8981\u6309\u7167\u9898\u89e3\u7684\u610f\u601d\u56db\u820d\u4e94\u5165\u4e00\u4e0b\u5c31\u53ef\u4ee5\u5c06\u539f\u6765\u7684\u590d\u6570\u9664\u6cd5\u53d8\u6210\u5e26\u4f59\u9664\u6cd5\uff0c\u7136\u540e\u53d6\u6a21\u64cd\u4f5c\u51cf\u4e00\u4e0b\u5c31\u6210\u4e86\n\n\u56db\u5219\u8fd0\u7b97\u91cd\u8f7d\u4e00\u4e0b\uff0c\u5269\u4e0b\u7684\u5c31\u548c\u666e\u901a\u6269\u6b27\u4e00\u6837\u4e86\uff0c\u9012\u5f52\u8fb9\u754c\u5c31\u662f\u6c42\u6700\u5c0f\u7684$N(Ax)$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef double ld;\nll a,b,c,d;\nll p,q,r,s,ans;\n\nstruct cpx\n{\n\tll x,y;\n\tcpx() { }\n\tcpx(ll x,ll y) : x(x),y(y) { }\n\tcpx operator + (const cpx &a)const { return cpx(x + a.x,y + a.y); }\n\tcpx operator - (const cpx &a)const { return cpx(x - a.x,y - a.y); }\n\tcpx operator * (const cpx &a)const { return cpx(x * a.x - y * a.y,x * a.y + y * a.x); }\n\tcpx operator / (const cpx &a)const\n\t{\n\t\tld A = x,B = y,C = a.x,D = a.y;\n\t\tld lf = (A * C + B * D) / (C * C + D * D);\n\t\tld ri = (B * C - A * D) / (C * C + D * D);\n\t\treturn cpx(round(lf),round(ri));\n\t}\n\tcpx operator % (const cpx &a)const\n\t{\n\t\tcpx ret = ((*this) / a) * a;\n\t\treturn cpx(x - ret.x,y - ret.y);\n\t}\n};\nvoid exgcd(cpx a,cpx b,cpx &x,cpx &y)\n{\n\tif(b.x == 0 && b.y == 0)\n\t{\n\t\tans = a.x * a.x + a.y * a.y;\n\t\tx.x = 1; x.y = 0;\n\t\treturn;\n\t}\n\texgcd(b,a % b,x,y);\n\tcpx t = x; x = y; y = t - a / b * y;\n}\n\n\nint main()\n{\n\tcin>>a>>b>>c>>d;\n\tcpx A = cpx(a,b),B = cpx(c,d);\n\tcpx x,y;\n\texgcd(A,B,x,y);\n\tcout<<x.x<<' '<<-x.y<<' '<<y.x<<' '<<y.y<<' '<<ans<<endl;\n\treturn 0;\n}\n```\n\n\u53e6\u5916\u611f\u8c22\u795e\u4ed9\u51fa\u9898\u4eba\u5e2e\u6211\u67e5\u9519orz\uff08~~y.y\u7b26\u53f7\u5199(\u6284)\u53cd\u4e86~~\uff09",
        "postTime": 1586249219,
        "uid": 115482,
        "name": "kkksx",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P6299 \u3010\u5dee\u522b\u3011"
    }
]
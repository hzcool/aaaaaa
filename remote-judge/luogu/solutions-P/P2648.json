[
    {
        "content": "\u6211\u4e0a\u6765\u4e00\u770b\n\n\u8fd9\u4e0d\u662f\u677f\u5b50\u9898\u5417\uff1f\n\n\u7136\u540e\u53c8\u4e00\u770b\n\n\u6700\u957f\u8def\n\n## \u6de6\u3002\n\n\u8fd8\u597d\u6709$SPFA$\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u8fb9\u6743\u53d6\u76f8\u53cd\u6570\u5b58\u8fb9\uff0c\u7136\u540e\u8dd1\u6700\u77ed\u8def\uff0c\u8f93\u51fa\u65f6\u518d\u6b21\u53d6\u76f8\u53cd\u6570\u5c31\u662f\u6700\u957f\u8def\u5566\n\n\u90a3\u4e48\u8003\u8651\u8fb9\u6743\u662f\u4ec0\u4e48\n\n\u663e\u7136\uff0c\u514d\u8d39\u8def\u8fb9\u6743\u662f$d$\uff0c\u6536\u8d39\u8def\u8fb9\u6743\u662f$d-w$\uff08\u90fd\u8981\u53d6\u76f8\u53cd\u6570\uff09\uff0c\u7136\u540e\u4e3a\u4e86\u8282\u7701\u65f6\u95f4\uff0c\u6211\u4eec\u5efa\u4e00\u4e2a\u8d85\u7ea7\u6e90\u70b9\uff0c\u548c\u6bcf\u4e2a\u70b9\u8fde\u4e00\u6761\u6743\u503c\u4e3a$d$\u7684\u8fb9\uff08\u4e5f\u8981\u53d6\u76f8\u53cd\u6570\uff09\uff0c\u7136\u540e\u8dd1\u4e00\u904d$SPFA$\uff0c\u5982\u679c\u6709\u8d1f\u73af\u5c31\u8f93\u51fa$orz$\n\n\u5c31\u662f\u8fd9\u6837\u5566\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<vector>\n#include<queue>\n#include<cstring>\nusing namespace std; \nstruct edge\n{\n\tint node,weight;\n\tedge(int node_,int weight_):\n\t\tnode(node_),weight(weight_){}\n};\nvector<edge> v[301];\nint d,p,c,f,r[301],dis[301];\nbool vis[301];\ninline bool SPFA()//\u677f\u5b50\n{\n\tmemset(dis,127/3,sizeof(dis));\n\tqueue<int> q;\n\tq.push(0);\n\tdis[0]=0;\n\tvis[0]=1;\n\twhile(!q.empty())\n\t{\n\t\tint k=q.front();\n\t\tq.pop();\n\t\tvis[k]=0;\n\t\t++r[k];\n\t\tif(r[k]>c)\n\t\t\treturn 1;\n\t\tfor(vector<edge>::iterator it=v[k].begin();it!=v[k].end();++it)\n\t\t\tif(dis[it->node]>dis[k]+it->weight)\n\t\t\t{\n\t\t\t\tdis[it->node]=dis[k]+it->weight;\n\t\t\t\t//cout<<it->node<<\" \"<<dis[it->node]<<endl;\n\t\t\t\tif(!vis[it->node])\n\t\t\t\t{\n\t\t\t\t\tvis[it->node]=1;\n\t\t\t\t\tq.push(it->node);\n\t\t\t\t}\n\t\t\t}\n\t}\n\treturn 0;\n}\nint main()\n{\n\tcin>>d>>p>>c>>f;\n\twhile(p--)\n\t{\n\t\tint x,y;\n\t\tcin>>x>>y;\n\t\tv[x].push_back(edge(y,-d));//\u514d\u8d39\u8fb9\n\t}\n\twhile(f--)\n\t{\n\t\tint x,y,w;\n\t\tcin>>x>>y>>w;\n\t\tv[x].push_back(edge(y,w-d));//\u6536\u8d39\u8fb9\n\t}\n\tfor(int i=1;i<=c;++i)\n\t\tv[0].push_back(edge(i,-d));//\u548c\u6e90\u70b9\u8fde\u8fb9\n\tif(SPFA())\n\t\tcout<<\"orz\\n\";//\u6709\u8d1f\u73af\n\telse\n\t{\n\t\tint ans=0;\n\t\tfor(int i=1;i<=c;++i)\n\t\t\tans=min(ans,dis[i]);//\u7edf\u8ba1\n\t\tcout<<-ans<<endl;//\u518d\u7528\u76f8\u53cd\u6570\u8f93\u51fa\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1564539500,
        "uid": 85682,
        "name": "\u7edd\u9876\u6211\u4e3a\u5cf0",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P2648 \u3010\u8d5a\u94b1\u3011"
    },
    {
        "content": "\u9996\u5148\u6dfb\u52a0\u4e00\u4e2a\u8d85\u7ea7\u6e90\uff0c\u7136\u540e\u4ece\u8d85\u7ea7\u6e90\u5f00\u59cb\u8dd1\u4e00\u904dSPFA\u6c42\u6700\u957f\u8def\u5e76\u4e14\u5224\u6b63\u6743\u73af\u5373\u53ef\u3002\n\n\u5b9e\u9645\u4e0a\u8fd9\u9898\u6570\u636e\u7279\u522b\u6c34\uff0c\u66b4\u529b\u5730\u4ece\u6bcf\u4e2a\u70b9\u51fa\u53d1\u90fd\u8dd1\u4e00\u904dSPFA\u4e5f\u53ef\u4ee5\u901a\u8fc7\u6240\u6709\u6d4b\u8bd5\u70b9\u3002\n",
        "postTime": 1451794896,
        "uid": 3182,
        "name": "Created_equal1",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P2648 \u3010\u8d5a\u94b1\u3011"
    },
    {
        "content": "### \u4e00\u9053 ~~\u7b80\uff08sha\uff09\u5355\uff08bi\uff09~~ \u6a21\u677f\u9898\n\n\u9996\u5148\uff0c\u5206\u6790\u5728\u4ec0\u4e48\u60c5\u51b5\u4e0b**orz**~~\uff08\u4f60\u5c31\u662forz\uff09~~\n\n\u56e0\u4e3a\u6709\u514d\u8d39\u7684\u8def\uff0c\u53c8\u6709\u53ef\u4ee5\u6709\u94b1\u518d\u4ea4\u94b1\u7684\u98de\u673a\uff0c\u6240\u4ee5\u53ea\u8981\u51fa\u73b0\u73af\u5c31orz\u4e86\n\n\u90a3\u4e48\u7528\u4ec0\u4e48\u5224\u73af\u5462\uff1f\u2014\u2014\u2014\u2014**SPFA\uff01**\uff08\u5176\u5b9e\u4e5f\u5c31\u8fd9\u6837\u4e86\uff09\n\n\u7136\u540e\uff0c\u6211\u4eec\u8003\u8651\u5982\u4f55\u6c42\u89e3\n\n\u65e2\u7136\u8981\u7528SPFA\uff0c\u90a3\u4e48\u5c31\u8981\u8003\u8651\u8fb9\u6743\u4e0e\u6e90\u70b9\u7684\u8bbe\u5b9a\n\n\u8bbe\u8fb9\u6743\u4e3a\u82b1\u8d39\u7684\u503c\n\n\u5982\u679c\u6bcf\u6b21\u5230\u8fbe\u4e00\u4e2a\u57ce\u5e02\uff0c\u5c31\u4e00\u5b9a\u8d5ad\u5143\uff0c\u90a3\u4e48\u6bcf\u6b21\u677e\u5f1b\u7684\u65f6\u5019\u5c31+d\u518d-\u8fb9\u6743\uff0c\u53d6\u5927\u503c\uff0c\u6e90\u70b9\u521d\u59cb\u5316\u4e3ad\n\n\u6216\u8005\uff0c\u5c06\u514d\u8d39\u8fb9\u7684\u8fb9\u6743\u8bbe\u4e3a-d\uff0c\u5176\u4f59\u7684\u8bbe\u4e3aw-d\uff0c\u90a3\u4e48\u6bcf\u6b21\u5c31\u53d6\u5c0f\u503c\uff0c\u6e90\u70b9\u521d\u59cb\u5316\u4e3a0\n\n\u9274\u4e8e\u6570\u636e\u5b9e\u5728\u662f\u592a\u6c34\u800c\u6211\u8fd8T\u4e86\u4e00\u4e2a\u70b9\uff0c\u6240\u4ee5\u5f97\u51fa\u4e24\u79cd\u8bbe\u7f6e\u6e90\u70b9\u7684\u65b9\u6cd5\n\n\u53ef\u4ee5\u6bcf\u4e2a\u70b9\u90fd\u8bbe\u7f6e\u4e3a\u6e90\u70b9\uff0cSPFA\u4e00\u904d\uff0c\u8bb0\u5f55\u6700\u5927\u6536\u76ca\u503c\n\n\u6216\u8005\u5efa\u7acb\u4e00\u4e2a\u8d85\u7ea7\u6e90\u70b9\uff0c\u53ea\u8981SPFA\u4e00\u904d\n\n#### \u4ee3\u7801\n\n\u4ee5\u4e0b\u4ee3\u7801\u91c7\u7528\u8d85\u7ea7\u6e90\u70b9+\u8d1f\u8fb9\u6743\uff08-d\u7684\u90a3\u79cd\uff09\uff0890\u5206\uff09\n~~~cpp\n#include<cstdio>\n#include<cstring>\n#include<queue>\nusing namespace std;\nstruct Edge{\n\tint v,w,nex;\n}edge[610];//\u90bb\u63a5\u8868\nint head[310],top=0;\nint d,p,c,f,dis[310],in[310];\nbool vis[310];\nvoid add(int u,int v,int w)\n{\n\tedge[++top].v=v;\n\tedge[top].w=w;\n\tedge[top].nex=head[u];\n\thead[u]=top;\n}\nbool SPFA()//\u677f\u5b50\n{\n\tmemset(dis,127/3,sizeof(dis));\n\tqueue<int>q;\n\tq.push(0);\n\tdis[0]=0;\n\tvis[0]=1;\n\twhile(!q.empty())\n\t{\n\t\tint u=q.front();\n\t\tq.pop();\n\t\tvis[u]=0;\n\t\tin[u]++;\n\t\tif(in[u]>c+1) return 1;//\u5224\u73af\n\t\tfor(int i=head[u];i;i=edge[i].nex)\n\t\t{\n\t\t\tint v=edge[i].v;\n\t\t\tif(dis[v]>dis[u]+edge[i].w)\n\t\t\t{\n\t\t\t\tdis[v]=dis[u]+edge[i].w;\n\t\t\t\tif(!vis[v])\n\t\t\t\t{\n\t\t\t\t\tvis[v]=1;\n\t\t\t\t\tq.push(v);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\nint main()\n{\n\tscanf(\"%d%d%d%d\",&d,&p,&c,&f);\n\tint u,v,w;\n\tfor(int i=1;i<=p;i++)\n\t{\n\t\tscanf(\"%d%d\",&u,&v);\n\t\tadd(u,v,-d);\n\t}\n\tfor(int i=1;i<=f;i++)\n\t{\n\t\tscanf(\"%d%d%d\",&u,&v,&w);\n\t\tadd(u,v,w-d);\n\t}\n\tfor(int i=1;i<=c;i++) add(0,i,-d);\n\tif(SPFA()) printf(\"orz\");\n\telse \n\t{\n\t\tint ans=0;\n\t\tfor(int i=1;i<=c;i++) ans=min(ans,dis[i]);\n\t\tprintf(\"%d\",-ans);\n\t}\n\treturn 0;\n}\n~~~\n\n\u4ee5\u4e0b\u91c7\u7528\u6bcf\u4e2a\u70b9\u90fdSPFA\u4e00\u904d+\u6b63\u8fb9\u6743\uff08\u514d\u8d39\u8fb9\u75280\u7684\u90a3\u79cd\uff09\uff08AC\uff09\n~~~cpp\n#include<cstdio>\n#include<cstring>\n#include<queue>\nusing namespace std;\nstruct Edge{\n\tint v,w,nex;\n}edge[610];\nint head[310],top=0;\nint d,p,c,f,dis[310],in[310];\nbool vis[310];\nvoid add(int u,int v,int w)\n{\n\tedge[++top].v=v;\n\tedge[top].w=w;\n\tedge[top].nex=head[u];\n\thead[u]=top;\n}\nbool SPFA(int x)\n{\n\tmemset(in,0,sizeof(in));\n\tmemset(vis,0,sizeof(vis));\n\tmemset(dis,-1e9,sizeof(dis));\n\tqueue<int>q;\n\tq.push(x);\n\tdis[x]=d;\n\tvis[x]=1;\n\twhile(!q.empty())\n\t{\n\t\tint u=q.front();\n\t\tq.pop();\n\t\tvis[u]=0;\n\t\tin[u]++;\n\t\tif(in[u]>c) return 1;\n\t\tfor(int i=head[u];i;i=edge[i].nex)\n\t\t{\n\t\t\tint v=edge[i].v;\n\t\t\tif(dis[v]<dis[u]-edge[i].w+d)\n\t\t\t{\n\t\t\t\tdis[v]=dis[u]-edge[i].w+d;\n\t\t\t\tif(!vis[v])\n\t\t\t\t{\n\t\t\t\t\tvis[v]=1;\n\t\t\t\t\tq.push(v);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\nint main()\n{\n\tint ans=0;\n\tscanf(\"%d%d%d%d\",&d,&p,&c,&f);\n\tint u,v,w;\n\tfor(int i=1;i<=p;i++)\n\t{\n\t\tscanf(\"%d%d\",&u,&v);\n\t\tadd(u,v,0);\n\t}\n\tfor(int i=1;i<=f;i++)\n\t{\n\t\tscanf(\"%d%d%d\",&u,&v,&w);\n\t\tadd(u,v,w);\n\t}\n\tfor(int i=1;i<=c;i++)\n\t{\n\t\tif(SPFA(i))//\u6bcf\u4e2a\u70b9\u90fd\u641e\u4e00\u6b21\n\t\t{\n\t\t\tprintf(\"orz\");\n\t\t\treturn 0;\n\t\t}\n\t\tfor(int j=1;j<=c;j++) ans=max(ans,dis[j]);\n\t}\n\tprintf(\"%d\",ans);\n\treturn 0;\n}\n~~~",
        "postTime": 1570327151,
        "uid": 144523,
        "name": "JohnJoeZhu",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2648 \u3010\u8d5a\u94b1\u3011"
    },
    {
        "content": "```\n#include <bits/stdc++.h>\nusing namespace std;\n\nint D, P, C, F;\nint g[310][310], d[310], v[310], cnt[310];\n\nvoid Floyed()\n{\n\tfor (int k = 1; k <= C; k++)\n\t\tfor (int i = 1; i <= C; i++)\n\t\t\tfor (int j = 1; j <= C; j++)\n\t\t\t\tg[i][j] = max(g[i][j], g[i][k] + g[k][j]);\n}\n\nint Find()\n{\n\tint ans = 0xc0c0c0c0;\n\tfor (int i = 1; i <= C; i++)\n\t\tfor (int j = 1; j <= C; j++)\n\t\t\tans = max(ans, g[i][j]);\n\treturn ans;\n}\n\nint main()\n{\n\tscanf(\"%d%d%d%d\", &D, &P, &C, &F);\n\tmemset(g, 0xc0, sizeof(g));\n\tfor (int x, y, i = 1; i <= P; i++)\n\t{\n\t\tscanf(\"%d%d\", &x, &y);\n\t\tg[x][y] = D;\n\t}\n\tfor (int x, y, z, i = 1; i <= F; i++)\n\t{\n\t\tscanf(\"%d%d%d\", &x, &y, &z);\n\t\tg[x][y] = D - z;\n\t}\n\tFloyed();\n\tint ans = Find();\n\tFloyed();\n\tint ans2 = Find();\n\tif (ans != ans2)\n\t\tputs(\"orz\");\n\telse\n\t\tprintf(\"%d\\n\", ans + D);\n\treturn 0;\n}\n/*\n\u7b80\u5316\u7248\u9898\u76ee\u5927\u610f\uff1a\n\u7ed9\u5b9a\u4e00\u4e2a\u6709\u5411\u56fe\uff0c\u70b9\u6709\u70b9\u6743(\u6bcf\u4e2a\u70b9\u70b9\u6743\u90fd\u4e00\u6837)\uff0c\u6709\u7684\u8fb9\u6709\u8d1f\u8fb9\u6743\uff0c\u6709\u7684\u8fb9\u67090\u8fb9\u6743\n\u5224\u65ad\u662f\u5426\u5b58\u5728\u6b63\u73af\uff0c\u5982\u679c\u6ca1\u6709\u5c31\u8f93\u51fa\u56fe\u4e2d\u6700\u957f\u8def\n--------------------------------------\n\u7531\u4e8e\u4e00\u6761\u8def\u5f84\u7684\u70b9\u6570\u7b49\u4e8e\u8fb9\u6570+1\n\u628a\u8fb9\u6743\u52a0\u7b49\u70b9\u6743\uff0c\u6700\u540e\u7b54\u6848\u52a0\u7b49\u4e8e\u4e00\u4e2ad\n\u5148\u8dd1\u4e00\u904dFloyed\u627e\u6700\u957f\u8def\n\u518d\u6765\u4e00\u904d\uff0c\u5982\u679c\u4e24\u6b21\u6700\u957f\u8def\u503c\u4e0d\u4e00\u6837\u90a3\u4e48\u5c31\u6709\u6b63\u73af\u3002\n*/\n```",
        "postTime": 1537427777,
        "uid": 13091,
        "name": "ghj1222",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2648 \u3010\u8d5a\u94b1\u3011"
    },
    {
        "content": "## \u6b63\u5982\u51fa\u9898\u4eba\u6240\u8bf4 ~~\u6570\u636e\u771f\u7684\u5f88\u6c34~~\n\u6bcf\u4e00\u4e2a\u70b9\u90fd\u8dd1\u4e00\u904dspfa\n\n\u63a5\u4e0b\u6765\u5c31\u662f~~\u677f\u5b50~~\u4e86\n\u5e9f\u8bdd\u4e0d\u591a\u8bf4\uff0c\u4e0a\u4ee3\u7801\n# ~~\u4e00\u6761\u534e\u4e3d\u7684\u5206\u5272\u7ebf~~\n\n\n------------\n\n\ncode\uff1a\n------------\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<queue>\n#define inf -1e9\n#define maxn 2001\nusing namespace std;\nint num,d,m1,n,m2,f,g,w,ans=-1; \nstruct node\n{\n\tint next,to,dis;\n}edge[maxn];\nint head[maxn],dis[maxn],vis[maxn],du[maxn];\nqueue <int> q;//stl\u6807\u51c6\u961f\u5217 \nvoid add(int from,int to,int dis)//\u94fe\u5f0f\u524d\u5411\u661f\u5b58\u8fb9 \n{\n\tedge[++num].next=head[from];\n\tedge[num].to=to;\n\tedge[num].dis=dis;\n\thead[from]=num;\n}\ninline void spfa(int x)//\u677f\u5b50 \n{\n\tmemset(dis,inf,sizeof(dis));\n\tmemset(vis,0,sizeof(vis));\n\tmemset(du,0,sizeof(du));\n\tq.push(x);\n\tdis[x]=d;//\u5f00\u59cb\u65f6d\u4e0d\u662f0\uff01\uff01 \n\tvis[x]=1;\n\twhile(!q.empty())\n\t{\n\t\tint u=q.front();\n\t\tvis[u]=0;\n\t\tq.pop();\n\t\tfor(int i=head[u];i;i=edge[i].next)//\u90bb\u63a5\u8868\u904d\u5386 \n\t\t{\n\t\t\tint v=edge[i].to;\n\t\t\tif(dis[v]<dis[u]-edge[i].dis+d)\n\t\t\t{\n\t\t\t\tdis[v]=dis[u]-edge[i].dis+d;\n\t\t\t\tdu[v]++;\n\t\t\t\tif(du[v]>n)//\u5224\u6b63\u73af \n\t\t\t\t{\n\t\t\t\t\tcout<<\"orz\"<<endl;\n\t\t\t\t\texit(0);//\u76f4\u63a5\u7ed3\u675f\u7a0b\u5e8f\u7684\u7384\u5b66\u4e1c\u4e1c \n\t\t\t\t}\n\t\t\t\tif(vis[v]==0)\n\t\t\t\t{\n\t\t\t\t\tvis[v]=1;\n\t\t\t\t\tq.push(v);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tans=max(ans,dis[i]);\n\t}\n}\nint main()\n{\n\tios::sync_with_stdio(false);//\u53ef\u4ee5\u52a0\u5febcin \n\tcin>>d>>m1>>n>>m2;//\u8f93\u5165\u4e0d\u89e3\u91ca \n\tfor(int i=1;i<=m1;i++)\n\t{\n\t\tcin>>f>>g;\n\t\tadd(f,g,0);\n\t}\n\tfor(int i=1;i<=m2;i++)\n\t{\n\t\tcin>>f>>g>>w;\n\t\tadd(f,g,w);\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tspfa(i);\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```\n\n#  **  _~~\u5b8c\u7f8e\u7ed3\u675f~~_** ",
        "postTime": 1526715021,
        "uid": 54017,
        "name": "loi_ys",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2648 \u3010\u8d5a\u94b1\u3011"
    },
    {
        "content": "\u9898\u76ee\u63cf\u8ff0--->[p2648 \u8d5a\u94b1](https://www.luogu.org/problemnew/show/P2648)\n\n\u5206\u6790\u5c31\u4e0d\u8bb2\u4e86 qwq\n\n\u4e4b\u524d  Created_equal1 \u5927\u4f6corz\u5df2\u7ecf\u8bb2\u8fc7\u4e86,\u53ea\u662f\u6765\u653e\u4e00\u4e0b\u52a0\u4e86\u8d85\u7ea7\u6e90\u7684\u4ee3\u7801\n\n**\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9**\n\n\u4e0e\u66b4\u529b\u7684\u4e0d\u540c\u7684\u662f,$dis[s]=0$\n\n(\u5373\u8d85\u7ea7\u6e90\u5904\u65e0\u57ce\u5e02,\u6211\u4eec\u4e0d\u80fd\u6253\u5de5\u8d5a\u94b1\n\nps:$dis[i]$\u7684\u5b9a\u4e49\u662f\u5230\u8fbei\u80fd\u8d5a\u7684\u94b1.\n\n\u56e0\u6b64\u6211\u4eec\u7684$ans$\u8981\u53d6$max$\n\n$24ms$\n\n-----------------\u4ee3\u7801------------------\n```cpp\n#include<bits/stdc++.h>\n#define IL inline\n#define RI register int\n#define N 666\nusing namespace std;\nIL void in(int &x)\n{\n\tint f=1;x=0;char s=getchar();\n\twhile(s>'9' or s<'0'){if(s=='-')f=-1;s=getchar();}\n\twhile(s>='0' and s<='9'){x=x*10+s-'0';s=getchar();}\n\tx*=f;\n}\nint head[N],tot,s,dis[N],cnt[N];\nbool vis[N];\nint n,m,f,D,ans;\nstruct cod{int u,v,w;}edge[N];\nIL void add(int x,int y,int z)\n{\n\tedge[++tot].u=head[x];\n\tedge[tot].v=y;\n\tedge[tot].w=z;\n\thead[x]=tot;\n}\nIL bool spfa(int s)\n{\n\tvis[s]=true;dis[s]=0;cnt[s]=0;\n\tqueue<int>q;\n\tq.push(s);\n\twhile(!q.empty())\n\t{\n\t\tint u=q.front();q.pop();vis[u]=false;\n\t\tif(cnt[u]>n+1)return true;\n\t\tfor(RI i=head[u];i;i=edge[i].u)\n\t\t{\n\t\t\tif(dis[edge[i].v]<dis[u]-edge[i].w+D)\n\t\t\t{\n\t\t\t\tdis[edge[i].v]=dis[u]-edge[i].w+D;\n\t\t\t\tif(cnt[edge[i].v]>n+1)return true;\n\t\t\t\tif(!vis[edge[i].v])\n\t\t\t\t{\n\t\t\t\t\tvis[edge[i].v]=true;\n\t\t\t\t\tcnt[edge[i].v]++;\n\t\t\t\t\tq.push(edge[i].v);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(RI i=1;i<=n;i++)\n\t\tans=max(ans,dis[i]);\n\treturn false;\n}\nint main()\n{\n\tin(D),in(m),in(n),in(f);s=n+1;\n\tfor(RI i=1,a,b;i<=m;i++)\n\t{\n\t\tin(a),in(b);\n\t\tadd(a,b,0);\n\t}\n\tfor(RI i=1,a,b,c;i<=f;i++)\n\t{\n\t\tin(a),in(b),in(c);\n\t\tadd(a,b,c);\n\t}\n\tfor(RI i=1;i<=n;i++)add(s,i,0),dis[i]=-2147483647;\n\tif(spfa(s)) puts(\"orz\");\n\telse printf(\"%d\",ans);\n}\n```",
        "postTime": 1537428710,
        "uid": 87960,
        "name": "\u987ez",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2648 \u3010\u8d5a\u94b1\u3011"
    }
]
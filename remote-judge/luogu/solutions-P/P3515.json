[
    {
        "content": "\u75af\u72c2%%%\u51e0\u4e2a\u6708\u524d\u5c31\u79d2\u4e86\u6b64\u9898\u7684Tyher\u5de8\u4f6c\n\n\u501f\u7740\u8fd9\u9898\u603b\u7ed3\u4e00\u4e0b\u51b3\u7b56\u5355\u8c03\u6027\u4f18\u5316DP\u5427\u3002\u849f\u84bb\u89c9\u5f97\u7528\u6570\u5f62\u7ed3\u5408\u7684\u601d\u60f3\u80fd\u591f\u8f7b\u677e\u5730\u7406\u89e3\u5b83\u3002\n\n\u9996\u5148\uff0c\u9898\u76ee\u8981\u6211\u4eec\u6c42\u6240\u6709\u7684$p_i$\uff0c\u90a3\u4e48\u628a\u5f0f\u5b50\u53d8\u4e00\u4e0b\n\n$$p_i\\ge a_j-a_i+\\sqrt{|i-j|}$$\n\n$$p_i=\\max\\limits_{j=1}^n\\{a_j+\\sqrt{|i-j|}\\}-a_i$$\n\n\u7edd\u5bf9\u503c\u770b\u7740\u5f88\u4e0d\u723d\uff0c\u6211\u4eec\u628a\u5b83\u62c6\u5f00\n\n$$p_i=\\max(\\max_{j=1}^i\\{a_j+\\sqrt{i-j}\\},\\max_{j=i}^n\\{a_j+\\sqrt{j-i}\\})-a_i$$\n\n\u5355\u72ec\u770b\u524d\u4e00\u90e8\u5206\n\n$$p_i=\\max_{j=1}^i\\{a_j+\\sqrt{i-j}\\}-a_i$$\n\n\u5f88\u660e\u663e\u662f\u4e2a\u8981\u7528\u51b3\u7b56\u5355\u8c03\u6027\u4f18\u5316\u7684\u5f0f\u5b50\u3002\u628a\u5e8f\u5217\u7ffb\u8f6c\u4ee5\u540e\uff0c\u540e\u4e00\u90e8\u5206\u7684\u7b97\u6cd5\u548c\u524d\u9762\u662f\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u53ea\u8ba8\u8bba\u524d\u4e00\u90e8\u5206\u4e86\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a$j$\uff0c\u628a$a_j+\\sqrt{i-j}$\u770b\u6210\u5173\u4e8e$i$\u7684\u51fd\u6570$f_j$\u3002\u6211\u4eec\u8981\u505a\u7684\u5c31\u662f\u5728\u6240\u6709$j\\leq i$\u7684\u51fd\u6570\u4e2d\u627e\u5230\u6700\u503c\u3002\u6bd4\u5982\u6837\u4f8b\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/28914.png)\n\n\u89c2\u5bdf\u53d1\u73b0\uff0c\u771f\u6b63\u6709\u7528\u7684\u51fd\u6570\u53ea\u6709\u6700\u4e0a\u9762\u90a3\u4e2a\uff01\u7136\u800c\u5b9e\u9645\u60c5\u51b5\u6bd4\u8fd9\u4e2a\u7a0d\u590d\u6742\u4e9b\u3002sqrt\u7684\u589e\u901f\u662f\u9012\u51cf\u7684\uff0c\u56e0\u6b64\u53ef\u80fd\u5b58\u5728\u4e00\u4e2a$j$\u6bd4\u8f83\u5c0f\u7684\u51fd\u6570\uff0c\u5728\u67d0\u4e00\u65f6\u523b\u88ab$j$\u6bd4\u8f83\u5927\u7684\u51fd\u6570\u53cd\u8d85\u3002\u6211\u4eec\u5927\u6982\u9700\u8981\u7ef4\u62a4\u8fd9\u6837\u7684\u82e5\u5e72\u4e2a\u51fd\u6570\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/28913.png)\n\n\u6211\u4eec\u7528\u961f\u5217\u5b9e\u73b0\u51b3\u7b56\u4e8c\u5206\u6808\uff08\u4e0d\u61c2\u7684\u53ef\u4ee5\u53c2\u8003\u4e00\u4e0b[\u849f\u84bb\u7684blog](https://www.cnblogs.com/flashhu/p/9480669.html)\uff09\uff0c\u6309$j$\u4ece\u5c0f\u5230\u5927\u4f9d\u6b21\u7ef4\u62a4\u8fd9\u4e9b\u51fd\u6570\u3002\u663e\u7136\uff0c\u5bf9\u4e8e\u5176\u4e2d\u4efb\u610f\u4e24\u4e2a\u76f8\u90bb\u7684\u51fd\u6570$f_t,f_{t+1}$\uff0c\u5b83\u4eec\u90fd\u6709\u4e00\u4e2a\u4e34\u754c\u503c$k_{t,t+1}$\u3002\u663e\u7136\u5e8f\u5217\u4e2d\u7684$k_{1,2},k_{2,3}...$\u4e5f\u8981\u4e25\u683c\u9012\u589e\u3002\u5426\u5219\uff0c\u5982\u679c$k_{t,t+1}\\ge k_{t+1,t+2}$\uff0c\u53ef\u4ee5\u60f3\u8c61$f_{t+1}$\u6839\u672c\u6ca1\u6709\u7528\u3002\n\n\u5148`for`\u4e00\u904d$i$\uff0c\u6211\u4eec\u5c1d\u8bd5\u7740\u628a$f_i$\u52a0\u5165\u961f\u5217\u3002\u8fd9\u65f6\u5019\u4e3a\u4e86\u4fdd\u8bc1$k$\u9012\u589e\uff0c\u8bbe\u961f\u5c3e\u51b3\u7b56\u4e3a$t$\uff0c\u6211\u4eec\u5224\u65ad\uff0c\u5982\u679c$k_{t-1,t}\\ge k_{t,i}$\uff08\u6b64\u65f6\u4f1a\u6709$f_t(k_{t-1,t})\\le f_i(k_{t-1,t})$\uff09\uff0c\u90a3\u4e48$t$\u6ca1\u7528\uff0c\u51fa\u961f\u3002\n\n\u8be5\u51fa\u53bb\u7684\u90fd\u51fa\u53bb\u540e\uff0c$i$\u5c31\u53ef\u4ee5\u52a0\u5165\u961f\u5c3e\u4e86\u3002\u8fd9\u65f6\u5019\u53ef\u4ee5\u6765\u6c42$p_i$\u4e86\u3002\u6211\u4eec\u68c0\u67e5\u4e00\u4e0b\u961f\u9996\u51b3\u7b56$h$\uff0c\u5982\u679c$t_{h,h+1}\\le i$\uff0c\u8bf4\u660e$h$\u7684\u5dc5\u5cf0\u65f6\u523b\u5df2\u7ecf\u8fc7\u53bb\uff0c\u51fa\u961f\u3002\u6700\u540e\u961f\u9996\u5c31\u662f\u6240\u6709\u51fd\u6570\u4e2d\u7684\u6700\u5927\u503c\u3002\n\n\u8c8c\u4f3c\u5e76\u6ca1\u6709\u7528\u5230\u4ec0\u4e48\u4e09\u5143\u7ec4\u554aqwq\n\nupdate:\u611f\u8c22\u5b64\u72ec\u00b7\u7cb2\u6cfd\u7684\u6307\u6b63\uff0c\u4e8c\u5206\u4e0a\u4e0b\u754c\u786e\u5b9e\u8be5\u8c03\u8c03\n\n\u4e0d\u8fc7\u8fd8\u662f\u6ca1\u6709\u7528\u5230\u4ec0\u4e48\u4e09\u5143\u7ec4\u554aqwq\uff0c\u849f\u84bb\u4e4b\u524d\u90fd\u628a\u4e34\u754c\u503c$k$\u5b58\u4e0b\u4e86\uff0c\u76f4\u63a5\u7528\u5c31\u53ef\u4ee5\u5566\n\n```cpp\n#include<bits/stdc++.h>\n#define RG register\n#define R RG int\n#define G if(++ip==iend)fread(ip=buf,1,N,stdin)\n#define calc(i,j) a[j]+sq[i-j]//\u8ba1\u7b97\u51fd\u6570\u503c\nusing namespace std;\nconst int N=5e5+9;\nchar buf[N],*iend=buf+N,*ip=iend-1;\nint n,a[N],q[N],k[N];\ndouble p[N],sq[N];\ninline int in(){\n    G;while(*ip<'-')G;\n    R x=*ip&15;G;\n    while(*ip>'-'){x*=10;x+=*ip&15;G;}\n    return x;\n}\ninline void chkmx(RG double&x,RG double y){\n    if(x<y)x=y;\n}\ninline int bound(R x,R y){//\u4e8c\u5206\u4e34\u754c\u503ck\n    R l=y,r=k[x]?k[x]:n,m,ret=r+1;//\u63a7\u5236\u4e8c\u5206\u4e0a\u4e0b\u754c\n    while(l<=r){\n        m=(l+r)>>1;\n        if(calc(m,x)<=calc(m,y))\n            ret=m,r=m-1;\n        else l=m+1;\n    }\n    return ret;\n}\nvoid work(){\n    for(R h=1,t=0,i=1;i<=n;++i){\n        while(h<t&&calc(k[t-1],q[t])<calc(k[t-1],i))--t;//\u7ef4\u62a4k\u5355\u8c03\n        k[t]=bound(q[t],i);q[++t]=i;\n        while(h<t&&k[h]<=i)++h;//\u5c06\u5df2\u7ecf\u4e0d\u4f18\u7684\u51b3\u7b56\u51fa\u961f\n        chkmx(p[i],calc(i,q[h]));//\u56e0\u4e3a\u505a\u4e24\u904d\u6240\u4ee5\u53d6max\n    }\n}\nint main(){\n    n=in();\n    R i,j;\n    for(i=1;i<=n;++i)\n        a[i]=in(),sq[i]=sqrt(i);\n    work();\n    for(i=1,j=n;i<j;++i,--j)//\u5e8f\u5217\u7ffb\u8f6c\n        swap(a[i],a[j]),swap(p[i],p[j]);\n    memset(k,0,(n+1)<<2);\n    work();\n    for(R i=n;i;--i)//\u7ffb\u8f6c\u8fc7\u4e86\u6240\u4ee5\u8981\u5012\u7740\u8f93\u51fa\n        printf(\"%d\\n\",max((int)ceil(p[i])-a[i],0));\n    return 0;\n}\n```",
        "postTime": 1534408945,
        "uid": 61325,
        "name": "FlashHu",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3515 \u3010[POI2011]Lightning Conductor\u3011"
    },
    {
        "content": "\u8bbe$w(x,y)$\u662f\u5b9a\u4e49\u5728\u6574\u6570\u96c6\u5408\u4e0a\u7684\u4e8c\u9662\u51fd\u6570\u3002\u82e5\u5bf9\u4e8e\u5b9a\u4e49\u57df\u4e0a\u7684\u4efb\u610f\u6574\u6570$a,b,c,d$\uff0c\u5176\u4e2d$a\\le b\\le c\\le d$\uff0c\u90fd\u6709$w(a,d)+w(b,c)\\ge w(a,c)+w(b,d)$\u6210\u7acb\uff0c\u5219\u79f0\u51fd\u6570$w$\u6ee1\u8db3**\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f**\u3002\n# \u5b9a\u7406\n\n\u8bbe$w(x,y)$\u662f\u5b9a\u4e49\u5728\u6574\u6570\u96c6\u5408\u4e0a\u7684\u4e8c\u5143\u51fd\u6570\u3002\u82e5\u5bf9\u4e8e\u5b9a\u4e49\u57df\u4e0a\u7684\u4efb\u610f\u6574\u6570$a,b$\uff0c\u5176\u4e2d$a<b$\uff0c\u90fd\u6709$w(a,b+1)+w(a+1,b)\\ge w(a,b)+w(a+1,b+1)$\u6210\u7acb\uff0c\u5219\u51fd\u6570$w$\u6ee1\u8db3\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\u3002\n\n## \u8bc1\u660e\n\n\u5bf9\u4e8e$a<c$\uff0c\u6709$w(a,c+1)+w(a+1,c)\\ge w(a,c)+w(a+1,c+1)$\n\n\u5bf9\u4e8e$a+1<c$\uff0c\u6709$w(a+1,c+1)+w(a+2,c)\\ge w(a+1,c)+w(a+2,c+1)$\n\n\u4e24\u5f0f\u76f8\u52a0\uff0c\u5f97\u5230$w(a,c+1)+w(a+2,c)\\ge w(a,c)+w(a+2,c+1)$\n\n\u4ee5\u6b64\u7c7b\u63a8\uff0c\u5bf9\u4e8e\u4efb\u610f\u7684$a\\le b\\le c$\uff0c\u6709$w(a,c+1)+w(b,c)\\ge w(a,c)+w(b,c+1)$\n\n\u540c\u7406\uff0c\u5bf9\u4efb\u610f\u7684$a\\le b\\le c\\le d$\uff0c\u6709$w(a,d)+w(b,c)\\ge w(a,c)+w(b,d)$\n\n# \u51b3\u7b56\u5355\u8c03\u6027\n\n\u5728\u72b6\u8f6c\u65b9\u7a0b$f[i]=\\min\\{f[j]+w(j,i)\\},j\\in[0,i)$\u4e2d\uff0c\u82e5\u51fd\u6570$w$\u6ee1\u8db3\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\uff0c\u5219$f$\u5177\u6709\u51b3\u7b56\u5355\u8c03\u6027\u3002\n\n## \u8bc1\u660e\n\n\u5b9a\u4e49$p[i]$\u8868\u793a$i$\u7684\u6700\u4f18\u51b3\u7b56\u70b9\u3002\n\n$\\forall i\\in[1,n],\\forall j\\in[0,p[i]-1]$\uff0c\u6839\u636e$p[i]$\u4e3a$i$\u7684\u6700\u4f18\u51b3\u7b56\u70b9\uff0c\u5219\u6709\n$$\nf[p[i]]+w(p[i],i)\\le f[j]+w(j,i)\n$$\n$\\forall i'\\in[i+1,n]$\uff0c\u56e0\u4e3a$w$\u6ee1\u8db3\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\uff0c\u5219\u6709\n$$\nw(j,i')+w(p[i],i)\\ge w(j,i)+w(p[i],i')\n$$\n\u79fb\u9879\uff0c\u53ef\u5f97\n$$\nv(p[i],i')-w(p[i],i)\\le w(j,i')-w(j,i)\n$$\n\u4e0e\u7b2c\u4e00\u4e2a\u4e0d\u7b49\u5f0f\u76f8\u52a0\uff0c\u53ef\u5f97\n$$\nf[p[i]]+w(p[i],i')\\le f[j]+w(j,i')\n$$\n\u5373$i'$\u7684\u6700\u4f18\u51b3\u7b56\u70b9\u4e00\u5b9a\u5927\u4e8e\u7b49\u4e8e$p[i]$\u3002\u6545$f$\u5177\u6709\u51b3\u7b56\u5355\u8c03\u6027\u3002\n\n## \u5e94\u7528\n\n\u90a3\u4e48\u77e5\u9053\u5176\u6709\u51b3\u7b56\u5355\u8c03\u6027\u540e\uff0c\u6709\u4ec0\u4e48\u5e94\u7528\u5462\uff1f\n\n\u65e2\u7136\u5176\u6709\u51b3\u7b56\u5355\u8c03\u6027\uff0c\u5b9a\u4e49$p[i]$\u8868\u793a$i$\u7684\u6700\u4f18\u51b3\u7b56\u70b9\uff0c\u5219$p$\u5185\u4e00\u5b9a\u662f\u975e\u4e25\u683c\u5355\u8c03\u9012\u589e\u7684\u3002\n\n\u90a3\u4e48\u6839\u636e\u6b64\u6027\u8d28\uff0c\u6ee1\u8db3\u51b3\u7b56\u5355\u8c03\u6027\u7684\u9898\u76ee\u4e3b\u8981\u6709\u4e24\u79cd\u5904\u7406\u624b\u6cd5\u3002\n\n### \u65b9\u6cd5\u4e00\uff1a\u5355\u8c03\u961f\u5217\n\n\u53ef\u4ee5\u7528\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u51b3\u7b56\u96c6\u5408$p$\u3002\n\n\u5f53\u6c42\u51fa\u4e00\u4e2a\u65b0\u7684$f[i]$\u65f6\uff0c\u8003\u8651$i$\u53ef\u4ee5\u4f5c\u4e3a\u54ea\u4e9b$f[i']\\ (i'>i)$\u7684\u6700\u4f18\u51b3\u7b56\u3002\u6839\u636e\u51b3\u7b56\u5355\u8c03\u6027\uff0c\u6211\u4eec\u4e00\u5b9a\u53ef\u4ee5\u627e\u5230\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u5728\u8be5\u4f4d\u7f6e\u4e4b\u524d\uff0c$p$\u5185\u5b58\u50a8\u7684\u51b3\u7b56\u90fd\u6bd4$i$\u8981\u4f18\uff0c\u5176\u540e\u90fd\u6bd4$i$\u5dee\u3002\u4e8e\u662f\u4fbf\u53ef\u4ee5\u5c06\u8be5\u4f4d\u7f6e\u53ca\u5176\u540e\u9762\u7684\u90e8\u5206\u5168\u90e8\u53d8\u4e3a$i$\uff0c\u5373\u6b64\u65f6\u5b83\u4eec\u7684\u6700\u4f18\u51b3\u7b56\u5747\u4e3a$i$\u3002\n\n\u4e00\u4e2a\u4f4d\u7f6e\u4e00\u4e2a\u4f4d\u7f6e\u7684\u4fee\u6539\u6548\u7387\u5f88\u4f4e\uff0c\u6240\u4ee5\u53ef\u4ee5\u5efa\u7acb\u4e00\u4e2a\u961f\u5217\uff0c\u4ee3\u66ff$p$\u3002\u961f\u5217\u4e2d\u4fdd\u5b58\u4e09\u4e2a\u91cf$(j,l,r)$\uff0c\u8868\u793a$p[l$~$r]$\u7684\u503c\u90fd\u662f$j$\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a$i\\in[1,n]$\uff0c\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n\n1. \u68c0\u67e5\u961f\u5934\uff1a\u8bbe\u961f\u5934\u4e3a$(j_0,l_0,r_0)$\uff0c\u82e5$r_0=i-1$\uff0c\u5219\u5220\u9664\u961f\u5934\uff08\u56e0\u4e3a\u961f\u5934\u4e0d\u9700\u8981\u4e86\uff0c$f[i]$\u4e4b\u524d\u7684\u503c\u5df2\u7ecf\u88ab\u6c42\u51fa\uff09\u3002\u5426\u5219\u5219\u4ee4$l_0=i$\u3002\n\n2. \u53d6\u961f\u5934\u4fdd\u5b58\u7684\u6700\u4f18\u51b3\u7b56$j$\u8fdb\u884c\u72b6\u6001\u8f6c\u79fb\uff0c\u8ba1\u7b97\u51fa$f[i]$\u3002\n\n3. \u5c1d\u8bd5\u63d2\u5165\u65b0\u51b3\u7b56$i$\uff0c\u6b65\u9aa4\u5982\u4e0b\n\n   (1) \u53d6\u51fa\u961f\u5c3e\uff0c\u5373\u4e3a$(j_t,l_t,r_t)$\n\n   (2) \u82e5\u5bf9\u4e8e$f[l_t]$\u6765\u8bf4\uff0c$i$\u662f\u6bd4$j_t$\u66f4\u4f18\u7684\u51b3\u7b56\uff0c\u5373$f[i]+w(i,l_t)\\le f[j_t]+w(j_t,l_t)$\uff0c\u8bb0$pos=l_t$\uff0c\u5220\u9664\u961f\u5c3e\uff0c\u8fd4\u56de\u6b65\u9aa4(1)\u3002\n\n   (3) \u82e5\u5bf9\u4e8e$f[r_t]$\u6765\u8bf4\uff0c$i$\u662f\u6bd4$j_t$\u66f4\u4f18\u7684\u51b3\u7b56\uff0c\u5373$f[j_t]+w(j_t,r_t)\\le f[i]+w(i,r_t)$\uff0c\u53bb\u5f80\u6b65\u9aa4(5)\u3002\n\n   (4) \u5426\u5219\uff0c\u5219\u5728$[l_t,r_t]$\u4e0a\u4e8c\u5206\u67e5\u627e\u51fa\u4f4d\u7f6e$pos$\uff0c\u5728\u6b64\u4e4b\u524d\u51b3\u7b56\u6bd4$i$\u4f18\uff0c\u5728\u6b64\u4e4b\u540e\u51b3\u7b56$i$\u66f4\u4f18\uff0c\u5c06$[l_t,r_t]$\u4fee\u6539\u4e3a$[l_t,pos-1]$\uff0c\u53bb\u5f80\u6b65\u9aa4(5)\u3002\n\n   (5) \u628a\u4e09\u5143\u7ec4$(i,pos,n)$\u63d2\u5165\u961f\u5c3e\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\ log\\ n)$\u3002\n\n### \u65b9\u6cd5\u4e8c\uff1a\u5206\u6cbb\n\n\u5047\u8bbe\u5df2\u77e5$[l,r]$\u7684\u6700\u4f18\u51b3\u7b56\u5728$[L,R]$\u4e0a\u3002\n\n\u5b9a\u4e49$mid=\\frac{l+r}{2}$\uff0c\u8bbe$dp[mid]$\u7684\u6700\u4f18\u51b3\u7b56\u4e3a$p$\uff0c\u6839\u636e\u51b3\u7b56\u5355\u8c03\u6027\uff0c\u53ef\u77e5$[l,mid-1]$\u7684\u6700\u4f18\u51b3\u7b56\u5728$[L,p]$\u5185\uff0c$[mid+1,r]$\u7684\u6700\u4f18\u51b3\u7b56\u5728$[p,R]$\u5185\u3002\n\n\u4e8e\u662f\u5c06\u95ee\u9898\u5206\u5272\u6210\u4e86\u540c\u7c7b\u578b\u7684\u89c4\u6a21\u66f4\u5c0f\u7684\u95ee\u9898\uff0c\u4fbf\u53ef\u9012\u5f52\u5206\u6cbb\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\ log\\ n)$\n\n## \u4f8b\u9898 [POI2011]Lightning Conductor\n\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a$ n$\u7684\u5e8f\u5217$\\{a_n\\}$\uff0c\u5bf9\u4e8e\u6bcf\u4e2a$i\\in [1,n]$\uff0c\u6c42\u51fa\u4e00\u4e2a\u6700\u5c0f\u7684\u975e\u8d1f\u6574\u6570$p$\uff0c\u4f7f\u5f97 $\\forall j\\in[1,n]$\uff0c\u90fd\u6709$a_j\\le a_i+p-\\sqrt{|i-j|}$\u3002\n\n### \u6570\u636e\u8303\u56f4\n\n$1 \\le n \\le 5\\times 10^{5}$\uff0c$0 \\le a_i \\le 10^{9}$\u3002\n\n### \u94fe\u63a5\n\n[[POI2011]Lightning Conductor](https://www.luogu.com.cn/problem/P3515)\n\n### \u601d\u8def\n\n$$\na_j \\le a_i+p-\\sqrt{|i-j|},\\forall j\\in[1,n] \n$$\n$$\np \\ge a_j+\\sqrt{|i-j|}-a_i,\\forall j\\in[1,n]\n$$\n\n\u800c$p$\u4e3a\u975e\u8d1f\u6574\u6570\uff0c\u5219\n$$\np=\\lceil \\max\\{ a_j+\\sqrt{|i-j|}\\}\\rceil-a_i,\\forall j\\in[1,n]\n$$\n\u90a3\u4e48\u95ee\u9898\u4fbf\u8f6c\u53d8\u4e3a\u6c42$\\lceil \\max\\{ a_j+\\sqrt{|i-j|}\\}\\rceil,\\forall j\\in[1,n]$\u3002\n\n\u53ef\u4ee5\u8003\u8651\u505a\u4e24\u6b21\uff0c\u6b63\u505a\u4e00\u6b21\uff0c\u5c06\u5e8f\u5217\u7ffb\u8f6c\u518d\u505a\u4e00\u6b21\uff0c\u7ed3\u679c\u53d6\u4e24\u6b21\u7684\u6700\u5927\u503c\uff0c\u8fd9\u6837\u4fbf\u53ef\u4ee5\u53bb\u6389\u7edd\u5bf9\u503c\n$$\n\\lceil \\max\\{ a_j+\\sqrt{i-j}\\}\\rceil,\\forall j\\in[1,i)\n$$\n\u5b9a\u4e49$dp[i]=\\lceil \\max\\{ a_j+\\sqrt{i-j}\\}\\rceil$\u3002\n\n\u6b64\u5904\u7684$w(j,i)$\u5373\u4e3a$\\sqrt{i-j}$\u3002\n\n\u5b9a\u4e49$a+1<c$\u3002\n$$\nw(a,c)=\\sqrt{c-a}\n$$\n\n$$\nw(a+1,c)=\\sqrt{c-a-1}\n$$\n\n$$\nw(a,c+1)=\\sqrt{c-a+1}\n$$\n\n$$\nw(a+1,c+1)=\\sqrt{c-a}\n$$\n\n\u5219\n$$\nw(a,c+1)+w(a+1,c)-[w(a,c)+w(a+1,c+1)]=\\sqrt{c-a-1}+\\sqrt{c-a+1}-2\\sqrt{c-a}\n$$\n\n\n\u4ee4$d=c-a$\uff0c\u539f\u5f0f\u53d8\u4e3a\n$$\n\\sqrt{d-1}+\\sqrt{d+1}-2\\sqrt{d}=(\\sqrt{d+1}-\\sqrt{d})-(\\sqrt{d}-\\sqrt{d-1})\n$$\n\u800c\u51fd\u6570$f(x)=\\sqrt{x}-\\sqrt{x-1}$\u5355\u8c03\u9012\u51cf\n\n\u5219\u8be5\u5f0f\u6052\u5c0f\u4e8e$0$\u3002\n\n\u5373$w(a,c+1)+w(a+1,c)\\le w(a,c)+w(a+1,c+1)$\u3002\n\n\u53ef\u63a8\u5e7f\u5230\u5bf9\u4e8e$a\\le b\\le c\\le d$\uff0c$w(a,d)+w(b,c) \\le w(a,c)+w(b,d)$\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u4e1c\u897f\u4e0e\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\u7684\u7b26\u53f7\u76f8\u53cd\u3002\u5c06\u4e0a\u9762\u7684\u8bc1\u660e\u8fc7\u7a0b\u7b26\u53f7\u53d6\u53cd\uff08\u56e0\u4e3a\u672c\u9898\u6c42\u7684\u662f$\\max$\uff09\uff0c\u4fbf\u53ef\u8bc1\u660e$dp$\u6ee1\u8db3\u51b3\u7b56\u5355\u8c03\u6027\u3002\n\n\u4e8e\u662f\u91c7\u7528\u4e0a\u9762\u4e24\u79cd\u65b9\u6cd5\u5b9e\u73b0\u5373\u53ef\u3002\n\n\u7531\u4e8e\u51fd\u6570$sqrt$\u8f83\u6162\uff0c\u4e14\u672c\u9898\u53cd\u590d\u8c03\u7528\uff0c\u53ef\u63d0\u524d\u9884\u5904\u7406\u51fa$\\sqrt{1}$~$\\sqrt{n}$\u3002\n\n### \u4ee3\u7801\uff08\u5355\u8c03\u961f\u5217\uff09\n\n```cpp\n#include<bits/stdc++.h>\n#define N 500010\n\nusing namespace std;\n\nint n,head,tail,a[N];\ndouble dp[N],sqr[N];\nstruct node{\n\tint l,r,p;\n}q[N];\n\ndouble w(int j,int i) {\n\treturn double(a[j])+sqr[i-j];\n}\n\nint binary_search(int t,int x) {\n\tint ans=q[t].r+1,l=q[t].l,r=q[t].r;\n\twhile(l<=r) {\n\t\tint mid=l+r>>1;\n\t\tif(w(q[t].p,mid)<=w(x,mid)) ans=mid,r=mid-1;\n\t\telse l=mid+1;\n\t}\n\treturn ans;\n}\n\nvoid insert(int i) {\n\tq[tail].l=max(q[tail].l,i);\n\twhile(head<=tail&&w(i,q[tail].l)>=w(q[tail].p,q[tail].l)) tail--;\n\tif(head>tail) {\n\t\tq[++tail].l=i;\n\t\tq[tail].r=n;\n\t\tq[tail].p=i;\n\t}\n\telse {\n\t\tint pos=binary_search(tail,i);\n\t\tif(pos>n) return ;\n\t\tq[tail].r=pos-1;\n\t\tq[++tail].l=pos;\n\t\tq[tail].r=n;\n\t\tq[tail].p=i;\n\t}\n}\n\nvoid work() {\n\thead=1,tail=0;\n\tfor(int i=1;i<=n;i++) {\n\t\tinsert(i);\n\t\tif(head<=tail&&q[head].r<i) head++;\n\t\telse q[head].l=i;\n\t\tdp[i]=max(dp[i],w(q[head].p,i));\n\t}\n}\n\nint main() {\n\tcin>>n;\n\tfor(int i=1;i<=n;i++) {\n\t\tcin>>a[i];\n\t\tsqr[i]=sqrt(i);\n\t}\n\t\n\twork();\n\tfor(int i=1;i<=n/2;i++) swap(a[i],a[n-i+1]),swap(dp[i],dp[n-i+1]);\n\twork();\n\t\n\tfor(int i=n;i>=1;i--) cout<<(int)ceil(dp[i])-a[i]<<endl;\n\t\n\treturn 0;\n}\n```\n\n### \u4ee3\u7801\uff08\u5206\u6cbb\uff09\n\n```cpp\n#include<bits/stdc++.h>\n#define N 500010\n\nusing namespace std;\n\nint n,a[N];\ndouble dp[N],sqr[N];\n\ndouble w(int j,int i) {\n\treturn double(a[j])+sqr[i-j];\n}\n\nvoid work(int l,int r,int L,int R) {\n\tif(l>r) return ;\n\tint mid=l+r>>1,p;\n\tdouble maxn=0;\n\tfor(int i=L;i<=min(mid,R);i++) {\n\t\tif(w(i,mid)>maxn) maxn=w(i,mid),p=i;\n\t}\n\tdp[mid]=max(dp[mid],maxn);\n\twork(l,mid-1,L,p);\n\twork(mid+1,r,p,R);\n}\n\nint main() {\n\tcin>>n;\n\tfor(int i=1;i<=n;i++) {\n\t\tcin>>a[i];\n\t\tsqr[i]=sqrt(i);\n\t}\n\t\n\twork(1,n,1,n);\n\tfor(int i=1;i<=n/2;i++) swap(a[i],a[n-i+1]),swap(dp[i],dp[n-i+1]);\n\twork(1,n,1,n);\n\t\n\tfor(int i=n;i>=1;i--) cout<<(int)ceil(dp[i])-a[i]<<endl;\n\t\n\treturn 0;\n}\n```\n\n# \u53c2\u8003\u8d44\u6599\n\n\u300a\u7b97\u6cd5\u7ade\u8d5b\u8fdb\u9636\u6307\u5357\u300b\n\n[\u3010\u5b66\u4e60\u7b14\u8bb0\u3011\u52a8\u6001\u89c4\u5212\u2014\u5404\u79cd DP \u4f18\u5316](https://www.cnblogs.com/Xing-Ling/p/11317315.html)\n\n",
        "postTime": 1582514866,
        "uid": 71936,
        "name": "HoshiuZ",
        "ccfLevel": 6,
        "title": "\u51b3\u7b56\u5355\u8c03\u6027\u4f18\u5316DP\u5b66\u4e60\u7b14\u8bb0"
    },
    {
        "content": "\u8003\u8651N^2\u5927\u66b4\u529b\nans[i]=max(a[j]+sqrt(|i-j|)-a[i] (1<=j<=n)\n\n\u628a\u7edd\u5bf9\u503c\u62c6\u5f00\uff1a\n\nans[i]=max(a[j]+sqrt(i-j))-a[i] (1<=j<=i)\n\nans[i]=max(a[j]+sqrt(j-i))-a[i] (i<j<=n)\n\n\u4e0a\u9762\u4e24\u4e2a\u5f0f\u5b50\u663e\u7136\u6bd4\u8f83\u5bf9\u79f0\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5148\u6b63\u7740\u505a\u4e00\u904d\u518d\u5012\u7740\u505a\u4e00\u904d\n\n\u6253\u8868\u8bfe\u8bc1\u660e\u5bf9\u4e8ef[i]\u7684\u6700\u4f18\u51b3\u7b56\u70b9g[i]\u662f\u5355\u8c03\u9012\u589e\u7684\uff0c\u5206\u6cbb\u5373\u53ef\n\nsolve(l,r,L,R)\u8868\u793af[l]~f[r]\u7684\u6700\u4f18\u51b3\u7b56\u70b9\u5728L~R\n\n\u4ee4mid=\uff08l+r\uff09/2,O\uff08n\uff09\u626b\u4e00\u904d\u53d6\u5230g[mid]\n\n\u7ee7\u7eed\u5206\u6cbb\n\nsolve\uff08l,mid-1,L,g[mid])\n\nsolve (mid+1,r,g[mid],R)\n\n\u4ee3\u7801\u5982\u4e0b:\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\nusing namespace std;\nlong double f1[6000000],f2[6000000];\nlong long a[6000000];\nlong long read()\n{\n\tlong long ret(0);\n\tchar ch=getchar();\n\twhile (ch<'0' || ch>'9') ch=getchar();\n\twhile (ch>='0' && ch<='9')\n\t{\n\t\tret=(ret<<1)+(ret<<3)+ch-48;\n\t\tch=getchar();\n\t}\n\treturn ret;\n}\nvoid solve1(int L,int R,int l,int r)\n{\n\tif (L>R) return;\n\tint mid=(L+R)>>1,g(0);\n\tlong double tmp(0);\n\tf1[mid]=a[mid];\n\tfor (int i=l;i<=min(r,mid);i++)\n\t{\n\t\ttmp=a[i]+sqrt(double(mid-i));\n\t\tif (tmp>f1[mid]) f1[mid]=tmp,g=i;\n\t}\n\tif (g==0) g=mid; f1[mid]-=a[mid];\n\tsolve1(L,mid-1,l,g); \n\tsolve1(mid+1,R,g,r);\n}\nvoid solve2(int L,int R,int l,int r)\n{\n\tif (L>R) return ;\n\tint mid=(L+R)>>1,g(0);\n\tlong double tmp(0);\n\tf2[mid]=a[mid];\n\tfor (int i=r;i>=max(mid,l);i--)\n\t{\n\t\ttmp=a[i]+sqrt(double(i-mid));\n\t\tif (tmp>f2[mid]) f2[mid]=tmp,g=i;\n\t}\n\tif (g==0) g=mid; f2[mid]-=a[mid];\n\tsolve2(L,mid-1,l,g);\n\tsolve2(mid+1,R,g,r);\n}\nint main()\n{\n\tint n=read();\n\tfor (int i=1;i<=n;i++) a[i]=read();\n\tsolve1(1,n,1,n);\n\tsolve2(1,n,1,n);\n\tfor (int i=1;i<=n;i++)\n\tprintf(\"%lld \\n\",(long long)ceil(max(f1[i],f2[i])));\n\treturn 0;\n}\n```\n",
        "postTime": 1552308724,
        "uid": 45955,
        "name": "QAQ_\u964c\u4e0a\u82b1\u5f00",
        "ccfLevel": 6,
        "title": "Lightning Conductort\u9898\u89e3"
    },
    {
        "content": "\u9996\u5148\u8fdb\u884c\u4e00\u6b65\u8f6c\u5316\n\n$a_j \\leq a_i + q - sqrt(abs(i - j))$\n\n$a_i + q \\geq a_j + sqrt(abs(i-j))$\n\n  \u5373 $q = max (a_j + sqrt(abs(i-j))) - a_i $\n\n\u6211\u4eec\u5bf9$i \\geq j$ \u548c $j > i$ \u5206\u7c7b\u8ba8\u8bba, \u5176\u5b9e\u89e3\u51b3\u4e00\u79cd\u60c5\u51b5\u540e\u5c06\u5e8f\u5217\u7ffb\u8f6c\u518d\u505a\u4e00\u904d\u5373\u53ef\n\n\u6709\u4e00\u79cdO($n^2$)\u7684dp\u66b4\u529b\u5e94\u8be5\u4e0d\u96be\u60f3\u5230\n\n\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u601d\u8003\u5982\u4f55\u4ee5\u6bd4\u8f83\u4f18\u79c0\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u89e3\u51b3\n\n\u8fd9\u91cc\u6d89\u53ca\u5230\u51b3\u7b56\u5355\u8c03\u6027\n\n\u7b80\u5355\u7684\u8bf4, \u5bf9\u4e8ei\u6765\u8bf4, \u5b83\u7684\u7b54\u6848\u6765\u6e90\u662f\u53e6\u4e00\u70b9j,\n\n\u90a3\u4e48\u6240\u6709\u7b54\u6848\u6765\u6e90\u6392\u6210\u7684\u5e8f\u5217$j_1,j_2,j_3,\\cdots j_n$ \u5177\u6709\u5355\u8c03\u6027\n\n\u6bd4\u5982: 1112255566666666678888\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5bf9\u4e8e\u6bcf\u4e00\u4e2ai, \u5b83\u53ef\u4ee5\u6210\u4e3a\u54ea\u4e00\u6bb5\u533a\u95f4\u7684\u7b54\u6848\n\n\u5373\u4e00\u4e2a\u4e09\u5143\u7ec4(l, r, i) \u5bf9\u5e94i\u63a7\u5236l\u5230r\n\n\u53ef\u4ee5\u4e8c\u5206+\u6808(\u6216\u961f\u5217)\u5904\u7406\n\n \u4e8c\u5206i\u548c\u6808\u9876\u7b54\u6848\u76f8\u7b49\u4e34\u754c, \u82e5\u4e34\u754c\u5c0f\u4e8el\u5219\u5f39\u6808\u91cd\u590d\u64cd\u4f5c\n\n\u5426\u5219\u5c06\u65b0\u7684(l, r, i) \u538b\u5012\u6808\u4e2d\n\n\u4ee3\u7801: \n\n```c++\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<queue>\n#include<cmath>\n#define ll long long\nusing namespace std;\nconst int N = 500080;\nstruct node{\n\tll l, r, x;\n};\ndeque<node> q;\nll read() {\n\tll x = 0, f = 1;\n\tchar c = getchar();\n\twhile (!isdigit(c)) {\n\t\tif (c == '-') f = -1;\n\t\tc = getchar();\n\t}\n\twhile (isdigit(c)) {\n\t\tx = (x << 3) + (x << 1) + c - '0';\n\t\tc = getchar();\n\t}\n\treturn x * f;\n} //\u5feb\u8bfb\nll n;\nlong double ans[N], a[N];\nbool check(ll x,ll y,ll k) {\n\treturn a[x] + sqrt(k - x) > a[y] + sqrt(k - y);\n}\nvoid work(void) {\n\tnode k = (node){1, n, 1}; \n\tfor (ll i = 2;i <= n; i++) {\n\t\tif (a[i] < a[k.x]) continue; //\u526a\u679d, \u5982\u679c\u6ee1\u8db3\u5219\u5b83\u4e00\u5b9a\u4e0d\u4f1a\u6709\u8d21\u732e\n\t\tll l = i, r = n, mid;\n\t\twhile (l <= r) {\n\t\t\tmid = (l + r) >> 1;\n\t\t\tif (check(k.x, i, mid)) l = mid + 1;\n\t\t\telse r = mid - 1;\n\t\t}//\u4e8c\u5206\n\t\tif (l == n + 1) continue;\n\t\tif (l <= k.l) {\n\t\t\tk = q.front();\n\t\t\tq.pop_front();\n\t\t\ti--;\n\t\t\tcontinue;\n\t\t}//\u5f39\u6808\n\t\tk.r = r;\n\t\tq.push_front(k);\n\t\tk = (node){l, n, i}; //\u538b\u6808\n\t}\n\tq.push_front(k);\n\tk = q.back();\n\tq.pop_back();\n\tfor (ll i = 1;i <= n; i++) {\n\t\tif (k.r < i) {\n\t\t\tk = q.back();\n\t\t\tq.pop_back();\n\t\t}\n\t\tans[i] = max(ans[i], a[k.x] + sqrt(i - k.x)); //\u8981\u505a\u4e24\u6b21,\u6240\u4ee5\u53d6max\n\t}\n}\n\t\t\nint main() {\n\tn = read();\n\tfor (int i = 1;i <= n; i++) \n\t\ta[i] = read(), ans[i] = a[i];\n\twork();\n\tfor (int j = 1;j << 1 <= n; j++) \n\tswap(a[j], a[n-j+1]), swap(ans[j], ans[n-j+1]);\n    //\u7ffb\u8f6c\n\twhile (q.size()) q.pop_front();\n\twork();\n\t///*\n\tfor (int i = n;i >= 1; i--)\n\t\tprintf (\"%d\\n\", int(ceil(ans[i]) - a[i]));\n\t\t//*/\n\treturn 0;\n}\n```\n\n",
        "postTime": 1568734632,
        "uid": 122144,
        "name": "hs_black",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3515 \u3010[POI2011]Lightning Conductor\u3011"
    },
    {
        "content": "### \u524d\u7f6e\u77e5\u8bc6\n\u4e00\u70b9\u57fa\u672c\u7684\u63a8\u5f0f\u5b50\u80fd\u529b\uff08\u5927\u6982\u662f\u9053\u51b3\u7b56\u5355\u8c03\u6027\u4f18\u5316dp\u597d\u9898\uff09\n\n### $\\texttt{Solution}$\n\n\u8003\u8651\u9898\u9762\u4e2d\u5947\u602a\u7684 $a_j\\leq a_i+p-\\sqrt{|i-j|}$\n\n\u628a $p$ \u5355\u72ec\u653e\u4e00\u8fb9\n\n$a_j-a_i+\\sqrt{|i-j|}\\leq p$\n\n\u6211\u4eec\u8981\u6c42 $p$ \u7684\u6700\u5c0f\u503c\n\n\u5373\u5bf9\u4e8e\u6bcf\u4e2a $i$ \u6c42 $\\max_{j=1}^n(a_j-a_i+\\sqrt{|i-j|})$\n\n\u8003\u8651\u628a\u5b83\u5206\u4e24\u90e8\u5206\u7b97\uff0c\u5206\u6210 $j\\leq i$ \u548c $j \\geq i$ \u4e24\u79cd\n\n\u7b2c\u4e8c\u79cd\u60c5\u51b5\u6211\u4eec\u53ea\u8981\u628a\u533a\u95f4\u7ffb\u8f6c\u4e00\u4e0b\u5c31\u884c\u4e86\uff0c\u6545\u8fd9\u91cc\u53ea\u8003\u8651\u7b2c\u4e00\u79cd\u60c5\u51b5\n\n$dp_i=\\max_{j=1}^i(a_j-a_i+\\sqrt{|i-j|})$\n\n\u6211\u7b80\u5355\u79f0 $a_j-a_i+\\sqrt{|i-j|}$ \u4e3aj\u7684\u6743\u503c\n\n\u8fd9\u5c31\u662f\u6211\u4eec\u7684dp\u5f0f\u4e86\uff0c\u6211\u4eec\u79f0\u6bcf\u4e2aj\u4e3a\u4e00\u4e2a**\u51b3\u7b56\u70b9**\n\n\u6211\u4eec\u8bbe $p_i$ \u8868\u793ai\u70b9\u7684\u6700\u4f18\u51b3\u7b56\u70b9\n\n\u8003\u8651\u5df2\u77e5 $p_i$ \uff0c\u5f97\u5230 $p_{i+1}$ \u7684\u60c5\u51b5\n\n\u5bf9\u4e8e $a_j-a_i$ \u8fd9\u4e2a\u90e8\u5206\u7684\u503c\uff0c\u6bcf\u4e2a\u51b3\u7b56\u70b9\u7684\u6743\u503c\u5dee\u662f\u4e0d\u53d8\u7684(\u5bf9\u4e8e\u4e24\u51b3\u7b56\u70b9j,k\u5176\u6743\u503c\u5dee\u4e3a $a_j-a_k$ \uff0c\u4e0ei\u65e0\u5173 \uff09\n\n\u6211\u4eec\u53ea\u8981\u8003\u8651 $\\sqrt{|i-j|}$ \u53d8\u5230 $\\sqrt{|i+1-j|}$ \u7684\u6743\u503c\u53d8\u5316\n\n\u6211\u4eec\u6613\u77e5 $a<b$ \u5219 $\\sqrt{a}-\\sqrt{a-1}>\\sqrt{b}-\\sqrt{b-1}$\n\n\u5bf9\u4e8e\u51b3\u7b56\u70b9j,k(j<k<=i)\n\n\u5176\u6743\u503c\u53d8\u5316\u91cf \n\n$\\Delta v_j=\\sqrt{|i+1-j|}-\\sqrt{|i-j|}$\n\n$\\Delta v_k=\\sqrt{|i+1-k|}-\\sqrt{|i-k|}$\n\n\u53c8 $i+1-j>i+1-k$\n\n\u6545 $\\Delta v_j<\\Delta v_k$\n\n\u90a3\u4e48\u5bf9\u4e8e $j<p_i$ \u7684\u51b3\u7b56\u70b9\u4f1a\u66f4\u52a0\u4e0d\u5982 $p_i$ \u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 $p_i<=p_{i+1}$\n\n\u90a3\u4e48\u6211\u4eec\u5df2\u7ecf\u5f97\u5230\u4e86\u8fd9\u4e2a\u4f18\u8d8a\u7684**\u51b3\u7b56\u5355\u8c03\u6027**\uff0c\u600e\u4e48\u7528\u5462\uff1f\n\n\u8003\u8651\u5206\u6cbb\u89e3\u51b3\u6b64\u7c7b\u6211\u4eec\u5bf9dp\u5f0f\u5b50\u6ca1\u6709\u597d\u529e\u6cd5\u53ea\u80fd\u626b\u51b3\u7b56\u70b9\u7684\u9898\u76ee\n\n\u5177\u4f53\u505a\u6cd5\u5982\u4e0b\uff1a\n\n1. \u5bf9\u4e8e\u4e00\u4e2a\u533a\u95f4[l,r]\uff0c\u6709\u4e00\u4e2a\u51b3\u7b56\u70b9\u8303\u56f4[x,y]\n\n2. \u628a[l,r]\u5207\u4e24\u534a\u627e\u5230\u4e00\u4e2amid\n\n3. \u626b\u4e00\u904d[x,y]\u6c42\u51famid\u7684dp\u503c\uff0c\u627e\u5230mid\u7684\u51b3\u7b56\u70b9\n\n4. \u5206\u6cbb\u533a\u95f4[l,mid-1]\uff0c\u51b3\u7b56\u70b9\u8303\u56f4[x,p]\n\n5. \u5206\u652f\u533a\u95f4[mid+1,r]\uff0c\u51b3\u7b56\u70b9\u8303\u56f4[p,y]\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790\u5982\u4e0b\uff1a\n\n\u9012\u5f52\u7684\u6bcf\u4e00\u5c42\u626b\u5b8c\u7684\u51b3\u7b56\u70b9\u8303\u56f4\u662f $O(n)$ \u7684\n\n$T(l,r,x,y)=T(l,mid-1,x,p)+T(mid+1,r,p,y)+y-x+1$\n\n$T(1,n,1,n)=O(nlogn)$\n\n\u5b8c\u7ed3\u6492\u82b1\uff08\u867d\u7136\u8bf4\u4e86\u5f88\u591a\uff0c\u4f46\u4ee3\u7801\u5f88\u77ed\uff09\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int maxn=5e5+5;\nconst double eps=1e-9;\nint a[maxn];\ndouble dp1[maxn],dp2[maxn];\nint read(){\n\tint x=0,y=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')y=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9')x=(x<<3)+(x<<1)+(ch^48),ch=getchar();\n\treturn x*y;\n}\nvoid solve(int l,int r,int x,int y,double *dp){\n\tif(l>r)return ;\n\tl=max(l,x);\n\tint mid=l+((r-l)>>1);\n\tint p;\n\tfor(int i=x;i<=min(mid,y);i++){\n\t\tdouble val=a[i]-a[mid]+sqrt(mid-i);\n\t\tif(dp[mid]-val<=eps){\n\t\t\tdp[mid]=val;\n\t\t\tp=i;\n\t\t}\n\t}\n\tsolve(l,mid-1,x,p,dp);\n\tsolve(mid+1,r,p,y,dp);\n\treturn ;\n}\nint main(){\n\tint n;\n\tn=read();\n\tfor(int i=1;i<=n;i++)a[i]=read();\n\tsolve(1,n,1,n,dp1);//j<=i\n\treverse(a+1,a+n+1);\n\tsolve(1,n,1,n,dp2);//j>=i\n\tfor(int i=1;i<=n;i++)printf(\"%d\\n\",(int)(ceil(max(dp1[i],dp2[n-i+1]))));\n\treturn 0;\n}\n\n```",
        "postTime": 1601044397,
        "uid": 98527,
        "name": "juju527",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3515 \u3010[POI2011]Lightning Conductor\u3011"
    },
    {
        "content": "## \u9898\u89e3\u4f3c\u4e4e\u5f88\u5c11\u554a\n### \u611f\u8c22zsy\u7684\u6307\u70b9 \u9898\u89e3\u53c2\u8003\u4e86\u5176\u4ed6\u4eba\u7684\u9898\u89e3\n\ndp\u7684\u65b9\u7a0b\u591a\u60f3\u4e00\u4e0b\u5c31\u53ef\u4ee5\u51fa\u6765\n\n```\ndp[i]=max(num[j]-num[i]+sqrt(abs(i-j)));\n```\n\n\u7136\u540e\u6211\u4eec\u8003\u8651\u600e\u4e48\u4f18\u5316\u5b83\n\n\u662f\u4e0d\u662f\u611f\u89c9abs\u6709\u70b9\u96be\u641e\uff1f\n\n\u6211\u4eec\u5148\u4ece\u524d\u5f80\u540e\u505a\u4e00\u904ddp\uff0c\u4ee4j<i\u3002\n\u518d\u4ece\u540e\u5f80\u524d\u505a\u4e00\u6b21\uff0c\u4ee4j>i\uff0c\u8fd9\u6837\u628aabs\u53bb\u6389\u3002\n\n\u5bf9\u4e8e\u51fd\u6570y=sqrt(x)\uff0c\u5b83\u589e\u957f\u7684\u901f\u5ea6\u5e94\u5f53\u662f\u8d8a\u6765\u8d8a\u6162\u7684\n\n\u6211\u4eec\u5148\u8003\u8651\u4ece\u524d\u5f80\u540e\u7684\u60c5\u51b5\uff0c\u5982\u679c\u51b3\u7b56\u70b9j\u4e0d\u53d8\u7684\u60c5\u51b5\u4e0b\uff0c\u5982\u679ci\u4e0d\u65ad\u589e\u5927\uff0c\u90a3\u4e48sqrt(i-j)\u7684\u589e\u957f\u901f\u5ea6\u662f\u4e0d\u662f\u4e0d\u65ad\u51cf\u5c0f\uff1f\n\n\u6ce8\u610f\u5230\u6211\u4eec\u7684dp\u65b9\u7a0b\u662f\u8981\u53d6\u6700\u5927\u503c\n\n\u5982\u679ci\u4e0d\u65ad\u589e\u5927\u7684\u60c5\u51b5\u4e0b\uff0c\u51b3\u7b56\u70b9j\u4ea7\u751f\u7684dp\u503c\u589e\u589e\u957f\u5e45\u5ea6\u4e0d\u65ad\u51cf\u5c0f\uff08\u6ce8\u610f\uff0c\u4ed6\u4ecd\u7136\u5728\u589e\u957f\uff09\uff0c\u662f\u4e0d\u662f\u53ef\u80fd\u5b58\u5728\u4e00\u4e2a\u51b3\u7b56\u70b9k\uff0c\u867d\u7136\u4ed6\u4e4b\u524d\u4ea7\u751f\u7684\u8d21\u732e\u6bd4\u8f83\u5c0f\uff0c\u4f46\u662f\u589e\u5e45\u8f83\u5927\uff0c\u5728\u6b64\u65f6\u51b3\u7b56\u70b9k\u5c06\u4ee3\u66ff\u51b3\u7b56\u70b9j\u5f62\u6210dp[i]\u7684\u6700\u4f18\u89e3\uff1f\n\n\u53ef\u80fd\u6709\u70b9\u7ed5\u53e3\uff0c\u7c7b\u6bd4\u901f\u5ea6\u548c\u52a0\u901f\u5ea6\u7684\u5173\u7cfb\u591a\u60f3\u4e00\u60f3\n\n\u90a3\u4e48\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u51b3\u7b56\u70b9j\uff0c\u4ed6\u53ef\u80fd\u5f62\u6210\u6700\u4f18\u89e3\u7684\u8303\u56f4\u5e94\u5f53\u662f\u4e00\u6bb5\u533a\u95f4l\u5230r\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u4f18\u5316dp\u7684\u601d\u8def\n\n\u6211\u4eec\u53ef\u4ee5\u5f00\u4e00\u4e2a\u5355\u8c03\u961f\u5217\uff0c\u961f\u5217\u91cc\u6bcf\u4e2a\u7ed3\u70b9\u4fdd\u5b58\u7684\u662f\u4e09\u5143\u7ec4{p,L,R};\n\n\u5c31\u662f\u5728\u5bf9\u4e8e\u51b3\u7b56\u70b9p\uff0c\u4ed6\u6240\u80fd\u7ba1\u8f96\u5230\u7684\u8303\u56f4\u662fl\u5230r\uff0c\u961f\u5217\u91cc\u6240\u6709l\u548cr\u62fc\u8d77\u6765\u5c31\u662f\u5f53\u524d\u7684i\u5230n\n\n\u6bcf\u6b21\u679a\u4e3e\u5230\u4e00\u4e2ai\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5c06\u961f\u5934\u7684l++\uff08\u6ee1\u8db3\u961f\u5217\u533a\u95f4\u4e4b\u548c\u4e3ai\u5230r\uff09\uff0c\u5982\u679c\u961f\u5934\u7684\u5143\u7d20\u6240\u7ba1\u8f96\u7684\u533a\u95f4\u4e3a\u7a7a\uff0c\u662f\u4e0d\u662f\u5c31\u53ef\u4ee5\u5220\u53bb\u4e86\uff1f\n\n\u6b64\u65f6\u5bf9\u4e8edp[i]\u800c\u8a00\uff0c\u961f\u5934\u5b58\u50a8\u7684p\u662f\u4e0d\u662f\u5c31\u662f\u6700\u4f18\u51b3\u7b56\u70b9\uff1f\n\n\u6b64\u65f6\u5982\u679c\u5bf9\u4e8edp[n]\u800c\u8a00\uff0c\u51b3\u7b56\u70b9p\u5e76\u6ca1\u6709\u51b3\u7b56\u70b9i\u4f18\uff0c\u6211\u4eec\u662f\u4e0d\u662f\u8981\u5728\u961f\u5c3e\u52a0\u5165\u51b3\u7b56\u70b9i\uff1f\n\n\u90a3\u4e48\u600e\u4e48\u6c42i\u7684\u7ba1\u8f96\u8303\u56f4\u5462\uff1f\n\n\u663e\u7136\uff0c\u6b64\u65f6\u7684r=n(\u60f3\u4e00\u60f3\u4e3a\u4ec0\u4e48)\uff0c\u6ce8\u610f\u5230\u589e\u957f\u901f\u5ea6\u662f\u5b58\u5728\u5355\u8c03\u6027\u7684\uff0c\u53ca\u5bf9\u4e8e\u67d0\u4e00\u65f6\u523b\uff0cp\u7a81\u7136\u5c31\u6ca1\u6709i\u4f18\u4e86\uff0c\u4ee5\u540e\u5c31\u4e00\u76f4\u6ca1\u6709i\u4f18\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4e8c\u5206\u4e34\u754c\u503c\n\n\u4e8c\u5206\u7684\u4e34\u754c\u503c\u4e3atemp\uff0c\u5219\u539f\u961f\u5c3e\u7684r\u66f4\u65b0\u4e3atemp-1\uff0c\u52a0\u5165\u65b0\u7684\u5143\u7d20i\uff0cplr\u4f9d\u6b21\u4e3ai\uff0ctemp\uff0cn\n\n\u7ed9\u4e2a\u4ee3\u7801\uff1a\n```\n#include<iostream>\n#include<cstdlib>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#define il inline\n#define rg register\n#define ll long long\n#define N 540000\n#define inf 2147483647\n#define ll_inf 9223372036854775807\nusing namespace std;\nint n,num[N];\ndouble F[N],G[N];\nstruct T{\n\tint p,l,r;\n}Q[N];\nil void re(rg int &x);\ndouble sol(rg int i,rg int j){\n\treturn (double)num[j]+sqrt((double)(1.0*abs(i-j)));\n}\nint find(rg int le,rg int ri,rg int p,rg int i){\n\trg int ans=-1;\n\twhile(le<=ri){\n\t\trg int mid=((le+ri)>>1);\n\t\tif(sol(mid,p)>sol(mid,i))le=mid+1;\n\t\telse ri=mid-1,ans=mid;\n\t}\n\treturn ans;\n}\nint main(){\n\tfreopen(\"s.in\",\"r\",stdin);\n\tre(n);\n\tfor(rg int i=1;i<=n;++i)\n\t\tre(num[i]);\n\t//dp[i]=max(num[j]-num[i]+sqrt(abs(i-j)));\n    //\u9700\u8981\u6c42\u51fa\u6700\u4f18\u7684\u89e3\n\trg int tail=0,head=1;\n\tfor(rg int i=1;i<=n;++i){\n\t\tQ[head].l++;\n\t\tif(head<=tail&&Q[head].r<Q[head].l)head++;\n\t\tif(head>tail||sol(n,i)>sol(n,Q[tail].p)){\n\t\t\twhile(head<=tail&&sol(Q[tail].l,Q[tail].p)<sol(Q[tail].l,i))tail--;\n\t\t\tif(head>tail)\n\t\t\t\tQ[++tail].p=i,Q[tail].l=i,Q[tail].r=n;\n\t\t\telse{\n\t\t\t\trg int temp=find(Q[tail].l,Q[tail].r,Q[tail].p,i);\n\t\t\t\tQ[tail].r=temp-1;\n\t\t\t\tQ[++tail].p=i,Q[tail].l=temp,Q[tail].r=n;\n\t\t\t}\n\t\t}\n\t\tF[i]=sol(i,Q[head].p)-num[i];\n\t}\n\treverse(num+1,num+n+1);\n\ttail=0,head=1;\n\tfor(rg int i=1;i<=n;++i){\n\t\tQ[head].l++;\n\t\tif(head<=tail&&Q[head].r<Q[head].l)head++;\n\t\tif(head>tail||sol(n,i)>sol(n,Q[tail].p)){\n\t\t\twhile(head<=tail&&sol(Q[tail].l,Q[tail].p)<sol(Q[tail].l,i))tail--;\n\t\t\tif(head>tail)\n\t\t\t\tQ[++tail].p=i,Q[tail].l=i,Q[tail].r=n;\n\t\t\telse{\n\t\t\t\trg int temp=find(Q[tail].l,Q[tail].r,Q[tail].p,i);\n\t\t\t\tQ[tail].r=temp-1;\n\t\t\t\tQ[++tail].p=i,Q[tail].l=temp,Q[tail].r=n;\n\t\t\t}\n\t\t}\n\t\tG[i]=sol(i,Q[head].p)-num[i];\n\t}\n\treverse(G+1,G+n+1);\n\tfor(rg int i=1;i<=n;++i)\n\t\tprintf(\"%d\\n\",max(0,(int)ceil(max(F[i],G[i]))));\n    return 0;\n}\nil void re(rg int &x){\n    rg int res=0;rg int w=1;char c=getchar();\n    while((c<'0'||c>'9')&&c!='-')c=getchar();\n    if(c=='-')w=-1,c=getchar();\n    while(c>='0'&&c<='9')res=(res<<3)+(res<<1)+c-'0',c=getchar();\n    x=w*res;\n}\n\n```",
        "postTime": 1523368770,
        "uid": 66915,
        "name": "Tyher",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3515 \u3010[POI2011]Lightning Conductor\u3011"
    },
    {
        "content": "> [P3515 [POI2011] Lightning Conductor](https://www.luogu.com.cn/problem/P3515)\r\n\r\n**\u7ebf\u6027\u505a\u6cd5\uff01**\r\n\r\n\u9898\u76ee\u76f8\u5f53\u4e8e\u5bf9\u6bcf\u4e2a $i$ \u6c42 $f_i = \\max\\limits_{j = 1} ^ n a_j + \\lceil\\sqrt {|i - j|} \\rceil$\u3002\u5206\u6210 $j < i$ \u548c $j > i$ \u5206\u522b\u6c42\u89e3\uff0c\u8003\u8651 $j < i$ \u7684\u60c5\u51b5\u3002\r\n\r\n\u56e0\u4e3a\u8d21\u732e\u51fd\u6570 $f = \\sqrt x$ \u4e8c\u9636\u5bfc\u6052\u4e3a\u8d1f\u4e14\u6c42\u6700\u5927\u503c\uff0c\u6240\u4ee5\u524d\u9762\u7684\u51b3\u7b56\u4f1a\u88ab\u540e\u9762\u7684\u51b3\u7b56\u53cd\u8d85\uff0c\u5177\u6709\u51b3\u7b56\u5355\u8c03\u6027\u3002\u8fd9\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e8c\u5206\u961f\u5217\u4f18\u5316 $\\max\\limits_{j = 1} ^ {i - 1} a_j + \\lceil\\sqrt {|i - j|} \\rceil$ \u7684\u6c42\u89e3\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n\\log n)$\u3002\r\n\r\n\u6211\u4eec\u53d1\u73b0\u4e8c\u5206\u961f\u5217\u6700\u8017\u65f6\u95f4\u7684\u90e8\u5206\u53ea\u6709\u4e8c\u5206\u53cd\u8d85\u70b9\u3002\u56e0\u4e3a\u672c\u9898\u8981\u6c42\u7684\u5f0f\u5b50\u8f83\u7279\u6b8a\uff0c\u6211\u4eec\u53ef\u4ee5 $\\mathcal{O}(1)$ \u8ba1\u7b97\u53cd\u8d85\u70b9\u3002\u8bbe\u4e24\u4e2a\u51b3\u7b56\u70b9 $k < j$\uff0c\u6211\u4eec\u5e0c\u671b\u6c42\u51fa\u6700\u5c0f\u7684 $i > j$ \u4f7f\u5f97 $k\\to i$ \u52a3\u4e8e $j\\to i$\u3002\r\n$$\r\n\\begin{aligned}\r\na_k + \\sqrt {i - k} & < a_j + \\sqrt {i - j} \\\\\r\n\\sqrt {i - k} - \\sqrt{i - j} & < a_j - a_k\r\n\\end{aligned}\r\n$$\r\n\u8bbe $d = a_j - a_k$\u3002\u5f53 $d \\leq 0$ \u65f6\uff0c\u4e0a\u5f0f\u6052\u4e0d\u6210\u7acb\uff0c$i$ \u4e0d\u5b58\u5728\u3002\u56e0\u6b64 $d > 0$\u3002\r\n$$\r\n\\begin{aligned}\r\n\\sqrt{i - k} & < d + \\sqrt{i - j} \\\\\r\ni - k & < d ^ 2 + i - j + 2d \\sqrt{i - j} \\\\\r\nj - k - d ^ 2 & < 2d \\sqrt{i - j}\r\n\\end{aligned}\r\n$$\r\n\u5f53 $j - k - d ^ 2 \\leq 0$\uff0c\u5373 $j - k \\leq d ^ 2$ \u65f6\uff0c\u4e0a\u5f0f\u6052\u6210\u7acb\uff0c$j$ \u4e00\u5b9a\u4f1a\u628a $k$ \u5f39\u51fa\u800c\u4e0d\u4f1a\u8fdb\u5165\u4e8c\u5206\u53cd\u8d85\u70b9\u7684\u8fc7\u7a0b\u3002\u56e0\u6b64 $j - k > d ^ 2$\u3002\u6839\u636e\u5b9e\u9645\u610f\u4e49\u4e5f\u5bb9\u6613\u7406\u89e3\uff0c\u5f53 $a_j$ \u8fc7\u5927\u65f6\uff0c$a_k\\to j$ \u751a\u81f3\u4e0d\u5982 $a_j$\u3002\r\n\r\n\u4e0d\u7b49\u53f7\u4e24\u4fa7\u540c\u65f6\u5e73\u65b9\u3002\u8bbe $v = \\dfrac {(j - k - d ^ 2) ^ 2} {4d ^ 2}$\uff0c\u5219 $v < i - j$\uff0c\u5373 $i > j + v$\u3002\u8fd9\u6837\uff0c\u6211\u4eec $\\mathcal{O}(1)$ \u5f97\u5230\u53cd\u8d85\u70b9 $j + \\lfloor v\\rfloor + 1$\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n)$\u3002\r\n\r\n\u83b7\u5f97\u4e86 Luogu \u548c LOJ \u6700\u4f18\u89e3\uff082022.10.27\uff09\u3002\r\n\r\n```cpp\r\n#include <bits/stdc++.h>\r\nusing namespace std;\r\n#define fi first\r\n#define se second\r\n#define TIME 1e3 * clock() / CLOCKS_PER_SEC\r\nusing ll = long long;\r\nusing ld = long double;\r\n// using lll = __int128;\r\nusing pii = pair<int, int>;\r\nusing pll = pair<ll, ll>;\r\nusing us = unsigned short;\r\n// using uint = unsigned int;\r\nusing ull = unsigned long long;\r\nchar buf[1 << 21], *p1 = buf, *p2 = buf, obuf[1 << 25], *O = obuf;\r\n#define gc (p1 == p2 && (p2 = (p1 = buf) + fread(buf, 1, 1 << 21, stdin), p1 == p2) ? EOF : *p1++)\r\n#define pc(x) (*O++ = x)\r\ninline int read() {\r\n  int x = 0;\r\n  char s = gc;\r\n  while(!isdigit(s)) s = gc;\r\n  while(isdigit(s)) x = x * 10 + s - '0', s = gc;\r\n  return x;\r\n}\r\ninline void print(int x) {\r\n  if(x >= 10) print(x / 10);\r\n  pc(x % 10 + '0');\r\n}\r\nbool Mbe;\r\nconstexpr int N = 5e5 + 5;\r\nint n, a[N], f[N];\r\ndouble sqr[N];\r\nstruct dat {int p, l, r;} q[N];\r\ndouble get(int u, int v) {return a[u] + sqr[v - u];}\r\nint hd, tl;\r\nvoid solve() {\r\n  f[1] = max(f[1], a[1]);\r\n  q[hd = tl = 0] = {1, 1, n};\r\n  for(int i = 2; i <= n; i++) {\r\n    if(q[hd].r < i) hd++;\r\n    q[hd].l = i;\r\n    while(hd <= tl && get(q[tl].p, q[tl].l) < get(i, q[tl].l)) tl--;\r\n    if(hd > tl) q[hd = tl = 0] = {i, i, n};\r\n    else {\r\n      int k = q[tl].p, j = i, d = a[j] - a[k];\r\n      ll pos;\r\n      if(d <= 0) pos = q[tl].r + 1;\r\n      else {\r\n        ll v = j - k - d * d;\r\n        pos = j + v * v / (d * d << 2) + 1;\r\n      }\r\n      if(pos <= n) q[tl].r = pos - 1, q[++tl] = {i, pos, n};\r\n    }\r\n    f[i] = max(f[i], (int) ceil(get(q[hd].p, i)));\r\n  }\r\n}\r\nbool Med;\r\nint main() {\r\n  fprintf(stderr, \"%.3lf MB\\n\", (&Mbe - &Med) / 1048576.0);\r\n  #ifdef ALEX_WEI\r\n    FILE* IN = freopen(\"1.in\", \"r\", stdin);\r\n    FILE* OUT = freopen(\"1.out\", \"w\", stdout);\r\n  #endif\r\n  cin >> n;\r\n  for(int i = 1; i <= n; i++) sqr[i] = sqrt(i);\r\n  for(int i = 1; i <= n; i++) a[i] = read();\r\n  solve();\r\n  reverse(a + 1, a + n + 1);\r\n  reverse(f + 1, f + n + 1);\r\n  solve();\r\n  for(int i = n; i; i--) print(f[i] - a[i]), pc('\\n');\r\n  cerr << TIME << \" ms\\n\";\r\n  return fwrite(obuf, 1, O - obuf, stdout), 0;\r\n}\r\n/*\r\n2022/10/27\r\nauthor: Alex_Wei\r\nstart coding at \r\nfinish debugging at \r\n*/\r\n```",
        "postTime": 1666847435,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "P3515 [POI2011] Lightning Conductor"
    },
    {
        "content": "**\u6b64\u9898\u66b4\u529b\u53ef\u8fc7**\u3002\n\n\u57fa\u672c\u601d\u8def\uff1a\u8d2a\u5fc3\u5730\uff0c\u4ece\u5927\u5230\u5c0f\u8003\u8651\u6bcf\u4e2a\u6570\uff0c\u53bb\u66f4\u65b0\u6bcf\u4e2a\u4f4d\u7f6e\u3002\u5982\u679c\u6709\u591a\u4e2a\u76f8\u540c\u7684\u6570\uff0c\u53ea\u9700\u8981\u7528\u6700\u5de6\u8fb9\u548c\u6700\u53f3\u8fb9\u7684\u6765\u66f4\u65b0\u5373\u53ef\u3002\n\n\u8fd9\u6837\u505a\u662f $O(n^2)$ \u7684\uff0c\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u8ddd\u79bb\u662f\u5f00\u4e86\u4e2a\u6839\u53f7\uff0c\u5373\u8ddd\u79bb\u7684\u5f71\u54cd\u4e0d\u8d85\u8fc7 $\\sqrt n$\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651 $\\sqrt n$ \u4e2a\u4e0d\u540c\u7684\u6570\u5373\u53ef\uff0c\u6b64\u65f6\u6570\u503c\u7684\u5f71\u54cd\u5df2\u7ecf\u8d85\u8fc7\u8ddd\u79bb\u7684\u5f71\u54cd\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\sqrt n)$ \uff0c\u9700\u8981\u4e00\u70b9\u5e38\u6570\u4f18\u5316\u5373\u53ef `AC` \u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define maxn 505050\nusing namespace std;\nchar buf[1 << 23], * p1 = buf, * p2 = buf;\n#define getchar() (p1 == p2 && (p2 = (p1 = buf) + fread(buf, 1, sizeof(buf), stdin), p1 == p2) ? EOF : *p1++)\ninline void read(int& ret)\n{\n\tret = 0;\n\tchar ch = getchar();\n\twhile (ch < '0' || ch>'9') ch = getchar();\n\twhile (ch >= '0' && ch <= '9') ret = ret * 10 + ch - '0', ch = getchar();\n}\nint n;\nint h[maxn];\npair<int, int>r[maxn];\nint p[maxn];\n#define max(a, b) (a > b ? a : b)\n\nvoid update(int a, int b)\n{\n\tp[b] = max(p[b], a);\n\tint k = b + 1;\n\tfor (int j = 1; k <= n; j++) {\n\t\tint u = a + j;\n\t\tint v = b + j * j;\n\t\twhile (k <= v) {\n\t\t\tif (k > n) break;\n\t\t\tp[k] = max(p[k], u), k++;\n\t\t}\n\t}\n\tk = b - 1;\n\tfor (int j = 1; k; j++) {\n\t\tint u = a + j;\n\t\tint v = b - j * j;\n\t\twhile (k >= v) {\n\t\t\tif (k <= 0) break;\n\t\t\tp[k] = max(p[k], u), k--;\n\t\t}\n\t}\n}\nint main()\n{\n\tread(n);\n\tfor (int i = 1; i <= n; i++) read(h[i]), r[i] = make_pair(h[i], i);\n\tsort(r + 1, r + n + 1);\n\tint i = n;\n\tr[n + 1].first = r[0].first = -1;\n\tint cnt = 0, v = 2 * sqrt(n);\n\twhile (i && cnt < v) {\n\t\tif (r[i].first == r[i + 1].first && r[i].first == r[i - 1].first) {\n\t\t\ti--;\n\t\t\tcontinue;\n\t\t}\n\t\tupdate(r[i].first, r[i].second);\n\t\ti--, cnt++;\n\t}\n\tfor (int i = 1; i <= n; i++) printf(\"%d\\n\", p[i] - h[i]);\n}\n```\n\n",
        "postTime": 1601634414,
        "uid": 148050,
        "name": "tuxiaobei",
        "ccfLevel": 7,
        "title": "P3515 [POI2011]Lightning Conductor"
    },
    {
        "content": "\u5f88\u597d\u7684\u4e00\u9053\u51b3\u7b56\u5355\u8c03\u6027\uff0c\u6574\u4f53\u4e8c\u5206\uff0c\u89c2\u5bdf\u6027\u8d28\uff0c\u6570\u5f62\u4fe1\u7ed3\u5408\u9898\uff08\u96fe\uff09\n\n\n---\n\n### \u9898\u89e3\uff1a\n\n\u9996\u5148\u662f\u5feb\u4e50\u63a8\u5f0f\u5b50\uff0c\u79fb\u9879\u540e\u5bb9\u6613\u5f97\u5230\uff1a\n\n$p_i=\\max\\limits_{j=1}^{n}\\{a_j+\\sqrt{| i-j |}\\}-a_i$\n\n\u7edd\u5bf9\u503c\u62c6\u5f00\uff0c\u53d1\u73b0\u662f\u4e24\u79cd\u6b63\u597d\u76f8\u53cd\u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ea\u5148\u8003\u8651$i\\ge j$\u7684\u60c5\u51b5\n\n\u628a$a_j+\\sqrt{i-j}$\u5355\u72ec\u62c9\u51fa\u6765\u5efa\u7acb\u51fd\u6570$f_j(i)=a_j+\\sqrt{i-j}$\n\n\u51fd\u6570\u56fe\u8c61\u5927\u81f4\u957f\u8fd9\u6837\n\n![](https://s1.ax1x.com/2020/07/03/NXMOAI.png)\n\n\u5bf9\u4e8e$p_i$\uff0c\u5b9e\u9645\u5c31\u662f\u8981\u7528\u4e00\u6761\u76f4\u7ebf$x=i$\u53bb\u622a\u65ad\uff0c\u770b\u770b\u6700\u9ad8\u4ea4\u70b9\u662f\u5565\n\n\u89c2\u5bdf\u6027\u8d28\uff0c\u5f88\u5bb9\u6613\u53d1\u73b0\u8fd9\u4e2a\u6700\u9ad8\u4ea4\u70b9\u662f\u5728\u4e0d\u65ad\u5411\u53f3\u4e0a\u65b9\u79fb\u52a8\u7684\n\n\u5f62\u5f0f\u7684\u8bf4\uff0c\u5177\u6709**\u51b3\u7b56\u5355\u8c03\u6027**\n\n\u6709\u4e86\u8fd9\u4e48\u4f18\u7f8e\u7684\u6027\u8d28\uff0c\u63a5\u4e0b\u6765\u5c31\u6709\u51e0\u79cd\u4e0d\u540c\u7684\u505a\u6cd5\uff0c\u8fd9\u91cc\u8bb2\u5f97\u662f\u4ee3\u7801\u6bd4\u8f83\u77ed\u7684\u6574\u4f53\u4e8c\u5206\u505a\u6cd5\n\n\u540c\u65f6\u4e8c\u5206\u51b3\u7b56\u70b9\u7684\u6a2a\u7eb5\u5750\u6807\uff0c\u6bcf\u6b21\u4e8c\u5206\u51fa\u4e00\u4e2a\u6a2a\u5750\u6807\u5c31\u66b4\u529b\u7b97\u51b3\u7b56\u70b9\uff0c\u7136\u540e\u7ee7\u7eed\u9012\u5f52\uff0c\u5c06\u7eb5\u5750\u6807\u5206\u6210\u53ef\u884c\u548c\u4e0d\u53ef\u884c\u4e24\u90e8\u5206\n\n\u590d\u6742\u5ea6\u662f\u4e00\u53ealog\u7684\n\n---\n\n### \u4ee3\u7801\uff1a\n\n```cpp\n#pragma GCC optimize(3,\"Ofast\",\"inline\")\n#pragma GCC target(\"avx,avx2\")\n#include <bits/stdc++.h>\nusing namespace std;\ntemplate<class t> inline t read(t &x){\n    char c=getchar();bool f=0;x=0;\n    while(!isdigit(c)) f|=c=='-',c=getchar();\n    while(isdigit(c)) x=(x<<1)+(x<<3)+(c^48),c=getchar();\n    if(f) x=-x;return x;\n}\ntemplate<class t> inline void write(t x){\n    if(x<0) putchar('-'),write(-x);\n    else{if(x>9) write(x/10);putchar('0'+x%10);}\n}\n\nconst int N=5e5+5;\nint n,id[N],a[N];\ndouble ans[N];\n\ndouble calc(int x,int y){\n\treturn a[x]+sqrt(abs(x-y)); //\u76f4\u63a5\u8ba1\u7b97\n}\n\nvoid divide(int l,int r,int p,int q){\n\tif(l>r) return ;\n\tint mid=l+r>>1,pos=0;\n\tdouble ma=0; //ma\u662f\u6700\u4f18\u51b3\u7b56\u70b9\n\tfor(int i=p;i<=q&&i<=mid;i++) if(calc(i,mid)>ma) ma=calc(i,mid),pos=i; //\u627e\u5230\u6700\u4f18\u70b9\n\tans[id[mid]]=max(ans[id[mid]],ma); //\u7531\u4e8e\u6709\u6b63\u53cd\u4e24\u6b21\uff0c\u6240\u4ee5\u6ce8\u610f\u53d6max\n\tdivide(l,mid-1,p,pos); //\u7ee7\u7eed\u5f80\u4e0b\u5206\n\tdivide(mid+1,r,pos,q);\n}\n\nsigned main(){\n\tread(n);\n\tfor(int i=1;i<=n;i++) read(a[i]),id[i]=i;\n\tdivide(1,n,1,n);\n\treverse(a+1,a+1+n); //\u7ffb\u8f6c\u518d\u505a\u4e00\u6b21\n\treverse(id+1,id+1+n);\n\tdivide(1,n,1,n);\n\tfor(int i=1;i<=n;i++) write((int)ceil(ans[i]-a[n-i+1])),puts(\"\"); //\u7531\u4e8e\u8981\u662f\u6574\u6570\u4e14\u5408\u6cd5\uff0c\u6240\u4ee5\u6ce8\u610f\u8981\u4e0a\u53d6\u6574\n}\n```",
        "postTime": 1593762884,
        "uid": 65735,
        "name": "yuzhechuan",
        "ccfLevel": 8,
        "title": "(No.100\u9898\u89e3)\u9898\u89e3 P3515 \u3010[POI2011]Lightning Conductor\u3011"
    },
    {
        "content": "[\u9898\u76ee](https://www.luogu.com.cn/problem/P3515)\n\n\u8fd9\u9635\u5b50\u5b66\u4e8c\u5206\u961f\u5217\uff0c\u5199\u4e2a\u9898\u89e3\u5427\u3002\n\n\u8981\u5bf9\u6bcf\u4e2a $i$\uff0c\u6c42\u51fa\u6700\u5c0f\u975e\u8d1f\u6574\u6570 $p$ \uff0c\u4f7f\u5f97 $\\forall j\\in[1,n],a_j\\le a_i+p-\\sqrt{|i-j|}$\u3002\n\n\u90a3\u4e48 $a_i+p\\ge \\max\\{\\max_{j<i}a_j+\\sqrt{i-j},\\max_{j>i}a_j+\\sqrt{j-i}\\}$\n\n\u6c42\u51fa\u5927\u4e8e\u7b49\u4e8e\u53f7\u53f3\u8fb9\u7684\u4e1c\u897f\u5373\u53ef\u3002\u8003\u8651\u6c42\u51fa $\\max_{j<i}a_j+\\sqrt{i-j}$\u3002\uff08$j>i$ \u7684\u4e1c\u897f\u7c7b\u4f3c\u505a\u5c31\u597d\uff09\n\n\u628a $a_j+\\sqrt{i-j}$ \u770b\u4f5c\u4ee5 $i$ \u4e3a\u81ea\u53d8\u91cf\u7684\u51fd\u6570\uff0c\u5bf9\u4e8e\u6240\u6709 $j<i$\uff0c\u6240\u6709\u51fd\u6570\u503c\u7684\u6700\u5927\u503c\u5c31\u662f\u8981\u6c42\u7684\u3002\n\n![_O_J4_XIWGI1__V2HCIO__Y.png](https://i.loli.net/2020/04/14/gU2kBaJDcryjZOd.png)\n\n\u8fd9\u4e9b\u51fd\u6570\u7684\u56fe\u50cf\u753b\u5728\u4e00\u8d77\uff0c\u5927\u6982\u957f\u8fd9\u6837\u3002\n\n\u8003\u8651\u5176\u4e2d\u7684\u4e00\u4e2a\u51fd\u6570\uff0c\u5728 $i$ \u589e\u5927\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6216\u8005\u662f\u4ece\u59cb\u81f3\u7ec8\u88ab\u540a\u6253\uff0c\u6216\u8005\u662f\u5f00\u59cb\u65f6\u4e0d\u5982\u522b\u4eba\uff0c\u4e2d\u95f4\u540a\u6253\u6240\u6709\u4eba\uff0c\u6700\u540e\u53c8\u88ab\u8d85\u8fc7\uff0c\u7136\u540e\u6c38\u4e16\u4e0d\u5f97\u7ffb\u8eab\u3002\n\n\u4e3a\u4ec0\u4e48\u6c38\u4e16\u4e0d\u5f97\u7ffb\u8eab\uff1f\u56e0\u4e3a\u8fd9\u91cc\u9762\u6240\u6709\u7684\u51fd\u6570\u90fd\u662f\u589e\u957f\u8d8a\u6765\u8d8a\u6162\uff08\u5927\u6982\u662f\u53d6\u503c\u8303\u56f4\u5185\u5bfc\u6570\u5c0f\u4e8e\u96f6\uff09\u7684\uff0c\u8003\u8651 \u540e\u9762\u7684\u51fd\u6570 \u8d85\u8fc7 \u524d\u9762\u7684\u51fd\u6570 \u7684\u65f6\u5019\uff0c\u540e\u9762\u7684\u51fd\u6570 \u7684\u589e\u957f\u5c31\u6bd4 \u524d\u9762\u7684\u51fd\u6570 \u5feb\uff0c\u5728\u8fd9\u4e4b\u540e \u540e\u9762\u7684\u51fd\u6570 \u8fd8\u662f\u4e00\u76f4\u6bd4 \u524d\u9762\u7684\u51fd\u6570 \u5feb\uff0c\u6240\u4ee5 \u524d\u9762\u7684\u51fd\u6570 \u5728\u6b64\u4e4b\u540e\u4e0d\u4f1a\u518d\u51fa\u5934\u3002\n\n\u6839\u636e\u8fd9\u4e2a\u6027\u8d28\uff0c\u8003\u8651\u7ef4\u62a4\u4e00\u4e2a\u961f\u5217\uff0c\u961f\u5217\u91cc\u9762\u662f\u4e00\u5806\u51fd\u6570\uff08\u8bbe\u4e3a $f_1,f_2,\\cdots,f_d$\uff09\uff0c\u4e14$\\forall k ,f_k$ \u8d85\u8fc7 $f_{k-1}$ \u7684\u65f6\u95f4\u8981\u65e9\u4e8e $f_{k+1}$ \u8d85\u8fc7 $f_k$ \u7684\u65f6\u95f4\u3002\n\n\uff08\u4ee5\u4e0b\u8ba4\u4e3a\u961f\u5c3e\u8fdb\u961f\u5934\u51fa\u3002\uff09\n\n\u5f53\u62ff\u5230\u4e00\u4e2a\u65b0\u51fd\u6570\u7684\u65f6\u5019\uff0c\u548c\u961f\u5c3e\u7684\u51fd\u6570\u6c42\u4e00\u4e0b\u4ea4\uff08\u53ef\u4ee5\u4e8c\u5206\uff0c\u672c\u9898\u4f3c\u4e4e\u4e5f\u53ef\u4ee5\u76f4\u63a5\u89e3\u65b9\u7a0b\uff09\uff0c\u5982\u679c\u6c38\u8fdc\u8d85\u4e0d\u8fc7\u961f\u5c3e\u5c31\u6254\u6389\uff1b\u5982\u679c\u65b0\u51fd\u6570\u4e0e\u961f\u5c3e\u7684\u76f8\u4ea4\u7684\u65f6\u95f4\u665a\u4e8e\u961f\u5c3e\u4e24\u4e2a\u51fd\u6570\u76f8\u4ea4\u7684\u65f6\u95f4\uff0c\u5c31\u76f4\u63a5\u585e\u5165\u961f\u5c3e\uff0c\u5426\u5219\u4e00\u76f4\u5f39\u961f\u5c3e\u76f4\u5230\u53ef\u4ee5\u4e3a\u6b62\u3002\n\n\u5f53\u4f60\u8981\u6c42\u7b54\u6848\u7684\u65f6\u5019\uff0c\u4e0d\u65ad\u5f39\u961f\u9996\uff0c\u76f4\u5230\u627e\u5230\u9700\u8981\u7684\u5373\u53ef\u3002\n\n\u4ece\u524d\u5f80\u540e\u505a\u4e00\u904d\u5c31\u6c42\u51fa\u7b54\u6848\u4e86\u3002\uff08\u53ef\u4ee5\u770b\u4ee3\u7801\uff0c\u5173\u952e\u90e8\u5206\u662f `Solve` \u51fd\u6570\u3002\uff09\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\nconst int N=5e5+3;\nint n,a[N],b[N],s[N],t[N],q[N],f[N],l,r;\ninline int Calc(int i,int j,int*a){//\u6c42\u4ea4\u70b9\u7684\u51fd\u6570\n\tint l=j+1,r=n+1,m;\n\tfor(;l<r;)m=l+r>>1,a[i]+sqrt(m-i)<a[j]+sqrt(m-j)?r=m:l=m+1;\n\treturn l;\n}\ninline int Solve(int*a,int*s){\n\tint tmp;\n\tq[l=r=0]=1;\n\tfor(int i=2;i<=n;i++){\n\t  for(;l<r&&f[l+1]<=i;l++);//\u5f39\u961f\u9996\n\t  s[i]=a[q[l]]+ceil(sqrt(i-q[l]));//\u6c42\u7b54\u6848\n\t  for(;l<r&&Calc(q[r],i,a)<f[r];r--);//\u5f39\u961f\u5c3e\n\t  if((tmp=Calc(q[r],i,a))<=n)q[++r]=i,f[r]=tmp;//\u52a0\u5165\u65b0\u51fd\u6570\n\t}\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)scanf(\"%d\",a+i),b[n-i+1]=a[i];\n\tSolve(a,s);\n\tSolve(b,t);\n\tfor(int i=1;i<=n;i++)\n\t  printf(\"%d\\n\",std::max(s[i],t[n-i+1])-a[i]>0?std::max(s[i],t[n-i+1])-a[i]:0);\n\treturn 0;\n}\n```",
        "postTime": 1586839811,
        "uid": 72487,
        "name": "Dreamunk",
        "ccfLevel": 9,
        "title": "[POI2011]Lightning Conductor"
    },
    {
        "content": "\u9898\u76ee\u8981\u6c42\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $i$ \u6709\uff1a\n\n$$ \\forall j \\in [1,n] \\quad a_{j} \\le a_{i} + p_{i} - \\sqrt{|i-j|} $$\n\n\u6211\u4eec\u628a\u5f0f\u5b50\u53d8\u6362\u4e00\u4e0b\n\n$$ \\forall j \\in [1,n] \\quad p_{i} \\ge a_{j} + \\sqrt{|i-j|} - a_{i} $$\n\n\u4e5f\u5c31\u662f\n\n$$ p_{i} = \\lceil max \\{ (a_{j} + \\sqrt{|i-j|}) \\} \\rceil - a_{i} $$\n\n\u6211\u4eec\u8003\u8651\u6b63\u53cd\u8f6c\u79fb\u4e24\u904d\uff0c\u5c06\u7edd\u5bf9\u503c\u53bb\u6389\n\n$$ p_{i} = \\lceil max \\{ (a_{j} + \\sqrt{i-j}) \\} \\rceil - a_{i} $$\n\n\u53ef\u4ee5\u53d1\u73b0\u6211\u4eec\u662f\u5728\u5bf9\u4e00\u4e9b\u5f62\u5982 $\\sqrt{x-a}+b$ \u7684\u51fd\u6570\u5728\u67d0\u4e2a\u70b9\u4e0a\u53d6 $max$\n\n\u7531\u4e8e\u4ece\u524d\u5f80\u540e\u51fd\u6570\u91cc\u7684 $a$ \u662f\u4e0d\u65ad\u9012\u589e\u7684\uff0c\u800c\u4e14 $\\sqrt{x}$ \u7684\u589e\u957f\u7387\u662f\u9010\u6e10\u51cf\u5c0f\u7684\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5982\u679c\u4e00\u4e2a\u51fd\u6570\u5728\u67d0\u4e2a\u70b9\u4e0a\u88ab\u9760\u540e\uff08$a$ \u66f4\u5927\uff09\u7684\u53e6\u4e00\u4e2a\u51fd\u6570\u8d85\u8d8a\u4e86\uff0c\u90a3\u4e48\u8fd9\u4e2a\u51fd\u6570\u5728\u540e\u9762\u662f\u4e0d\u53ef\u80fd\u518d\u6b21\u53cd\u8d85\u7684\n\n\u6362\u53e5\u8bdd\u8bf4\uff0c\u8f6c\u79fb\u6ee1\u8db3**\u51b3\u7b56\u5355\u8c03\u6027**\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u7ef4\u62a4\u4e00\u4e2a\u5355\u8c03\u961f\u5217\uff0c\u6bcf\u6b21\u6bd4\u8f83\u7684\u65f6\u5019 $O(logn)$ \u4e8c\u5206\u6c42\u51fa\u4e24\u4e2a\u51fd\u6570\u7684\u4ea4\u70b9\u3002\u5982\u679c\u961f\u5c3e\u7684\u51fd\u6570\u5b8c\u5168\u52a3\u4e8e\u65b0\u52a0\u5165\u7684\u51fd\u6570\uff08\u5373\u65b0\u52a0\u5165\u51fd\u6570\u4e0e\u961f\u5c3e\u51fd\u6570\u7684\u4ea4\u70b9\u5728\u961f\u5c3e\u51fd\u6570\u4e0e\u4e0a\u4e00\u4e2a\u51fd\u6570\u7684\u4ea4\u70b9\u4e4b\u524d\uff09\uff0c\u6211\u4eec\u5c31\u5c06\u5b83\u5f39\u51fa\u3002\u540c\u65f6\u5982\u679c\u5f53\u524d\u4f4d\u7f6e\u5df2\u7ecf\u8fc7\u4e86\u961f\u9996\u51fd\u6570\u4e0e\u4e0b\u4e00\u4e2a\u51fd\u6570\u7684\u4ea4\u70b9\uff0c\u6211\u4eec\u5c31\u5f39\u51fa\u961f\u9996\u51fd\u6570\u3002\u6bcf\u6b21\u8f6c\u79fb\u65f6\u76f4\u63a5\u53d6\u961f\u9996\u8f6c\u79fb\u5373\u53ef\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u6bcf\u6b21\u6bd4\u8f83\u8981\u4e48\u662f\u5220\u9664\u6389\u961f\u5c3e\u5143\u7d20\uff0c\u8981\u4e48\u662f\u505c\u6b62\u6bd4\u8f83\uff0c\u4e8e\u662f\u6bd4\u8f83\u7684\u6b21\u6570\u662f $O(n)$ \u7684\u3002\u6bcf\u6b21\u6bd4\u8f83\u590d\u6742\u5ea6\u4e3a $O(logn)$ \uff0c\u5355\u8c03\u961f\u5217\u4f18\u5316\u539f\u672c\u7684\u590d\u6742\u5ea6\u4e5f\u662f $O(n)$ \u7684\uff0c\u4e8e\u662f\u603b\u590d\u6742\u5ea6\u4e3a $O(nlogn)$\n\n\u5b8c\u6574\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include <cstdio>\n#include <algorithm>\n#include <cmath>\nusing namespace std;\n\ntypedef struct node{\n    int a,b;\n    node() {}\n    node(int _a,int _b):a(_a),b(_b) {}\n}node;\n\nnode q[500010];\nint n,a[500010],p[500010],head,tail,maxp[500010];\ndouble sq[500010];\n// \u9884\u5904\u7406 sqrt\n\ninline int read(){\n    int num=0,k=1; char c=getchar();\n    while(c>'9' || c<'0') k=(c=='-')?0:k,c=getchar();\n    while(c>='0' && c<='9') num=num*10+c-'0',c=getchar();\n    return k?num:-num;\n}\n\ndouble cal(node x,int p) {return (double)(x.a+sq[p-x.b]);}\n\nint get(node x,node y){\n    int l=y.b-1,r=n+1,mid;\n    while(l+1<r){\n        mid=(l+r)>>1;\n        if(cal(y,mid)>=cal(x,mid)) r=mid;\n        else l=mid;\n    }\n    return r;\n}\n\nint main(){\n    n=read();\n    for(int i=1;i<=n;i++) a[i]=read(),sq[i]=sqrt(i);\n    head=1; tail=0;\n    for(int i=1;i<=n;i++){\n        node cur(a[i],i);\n        while(head<=tail && get(q[tail],cur)<=p[tail]) tail--;\n        q[++tail]=cur; p[tail]=(head<tail)?get(q[tail-1],cur):1;\n        while(head<tail && i>=p[head+1]) head++;\n        maxp[i]=(int)ceil(cal(q[head],i))-a[i];\n    }\n    for(int i=1;n-i+1>i;i++) {swap(a[i],a[n-i+1]); swap(maxp[i],maxp[n-i+1]);}\n    head=1; tail=0;\n    for(int i=1;i<=n;i++){\n        node cur(a[i],i);\n        while(head<=tail && get(q[tail],cur)<=p[tail]) tail--;\n        q[++tail]=cur; p[tail]=(head<tail)?get(q[tail-1],cur):1;\n        while(head<tail && i>=p[head+1]) head++;\n        maxp[i]=max(maxp[i],(int)ceil(cal(q[head],i))-a[i]);\n    }\n    for(int i=n;i>=1;i--) printf(\"%d\\n\",maxp[i]);\n    return 0;\n}\n```",
        "postTime": 1553254712,
        "uid": 100037,
        "name": "kkxhh",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3515 \u3010[POI2011]Lightning Conductor\u3011"
    },
    {
        "content": "\u5199\u4e00\u7bc7\u9898\u89e3\u6765\u7eaa\u5ff5\u4e00\u4e0b\u81ea\u5df1\u5728\u8bed\u6587\u8bfe\u4e0a\u60f3\u51fa\u7684\u7b2c\u4e00\u9053\u975e\u659c\u7387\u4f18\u5316\u7684\u51b3\u7b56\u5355\u8c03\u6027\u3002\uff08\u5e94\u8be5\u662f\u6807\u51c6\u7684\u7528\u4e09\u5143\u7ec4\u7684\u51b3\u7b56\u4e8c\u5206\u6808\uff09\n\n\u9996\u5148\u8981\u6c42\u7684\u4e1c\u897f\u5c31\u662f\n\n$f_i=\\lceil \\max\\{a_j+\\sqrt{|i-j|}\\}-a_i\\rceil,1\\leq j\\leq n$\n\n\u867d\u7136\u8fd9\u4e2a\u5f0f\u5b50\u5e76\u6ca1\u6709\u4ec0\u4e48\u9012\u63a8\uff0c\u4f46\u4f9d\u7136\u53ef\u4ee5\u770b\u6210\u4e00\u4e2adp\u6765\u505a\u3002\n\n\u9996\u5148\u8fd9\u4e2a\u7edd\u5bf9\u503c\u975e\u5e38\u4e11\uff0c\u5e76\u4e14\u5176\u5b9e\u4e0a\u53d6\u6574\u7b26\u53f7\u53ef\u4ee5\u5ffd\u7565\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u6539\u5199\u6210\u6c42\n\n$f_i=\\max\\{a_j+\\sqrt{i-j}\\}-a_i,1\\leq j<i$\n\n\u53ea\u8981\u5148\u6c42\u4e00\u904d\u8fd9\u4e2a\uff0c\u7136\u540e\u628a\u5e8f\u5217\u5012\u8fc7\u6765\u518d\u505a\u4e00\u904d\uff0c\u53d6max\u5373\u53ef\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u770b\u8fd9\u4e2a\u600e\u4e48\u6c42\n\n\u5982\u679c\u8bbe$g_j(i)=a_j+\\sqrt{i-j}$\uff0c\u4e8b\u5b9e\u4e0a\u6211\u4eec\u5c31\u662f\u8981\u5728$j=1,2,...,i-1$\u7684\u8fd9$i-1$\u4e2a\u51fd\u6570$g_j(i)$\u4e2d\uff0c\u627e\u5230\u6700\u5927\u503c\u3002\n\n\u5982\u679c\u4f60\u5b66\u8fc7\u57fa\u672c\u521d\u7b49\u51fd\u6570\uff0c\u4f60\u4f1a\u77e5\u9053\u8fd9\u662f\u4e2a\u5e42\u51fd\u6570\u5e73\u79fb\u4e4b\u540e\u5f97\u5230\u7684\u51fd\u6570\uff1b\u5982\u679c\u4f60\u5b66\u8fc7\u5706\u9525\u66f2\u7ebf\uff0c\u4f60\u4f1a\u77e5\u9053\u8fd9\u662f\u4e2a\u629b\u7269\u7ebf\u5e73\u79fb\u5f97\u5230\u7684\u4e8c\u6b21\u66f2\u7ebf\uff1b\u4f46\u5176\u5b9e\u4f60\u53ea\u8981\u7528\u51e0\u4f55\u753b\u677f\u5c31\u53ef\u4ee5\u53d1\u73b0\n\n- $g_j(i)$\u5355\u8c03\u9012\u589e\n\n- $\\forall j,k, g_j(i)$\u4e0e$g_k(i)$\u81f3\u591a\u53ea\u6709\u4e00\u4e2a\u4ea4\u70b9\n\n\u7531\u4e8e\u672c\u4eba\u592a\u61d2\uff0c\u5c31\u4e0d\u753b\u56fe\u4e86\uff0c\u8981\u770b\u56fe\u8bf7\u770b\u697c\u4e0aFlashHu\u5927\u4f6c\u7684\u56fe\uff0c\u4f60\u5c31\u4f1a\u660e\u767d\u8fd9$i-1$\u4e2a\u66f2\u7ebf\u7684\u5173\u7cfb\n\n\u8fd9\u5c31\u662f\u6211\u4eec\u51b3\u7b56\u5355\u8c03\u6027\u7684\u57fa\u7840\u3002\n\n\u6709\u4e86\u5bf9\u8fd9\u4e2a\u51fd\u6570\u7684\u8ba4\u8bc6\uff0c\u5c31\u53ef\u4ee5\u53d1\u73b0\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u6700\u4f18\u51b3\u7b56$j$\uff0c\u4e00\u5b9a\u4f1a\u6709\u5bf9\u5e94\u7684\u533a\u95f4$[l_j,r_j]$\u6ee1\u8db3\uff1a\u5bf9\u4e8e\u4efb\u610f$i\\in[l_j,r_j]$\uff0c$f_i$\u7684\u6700\u4f18\u51b3\u7b56\u70b9\u662f$j$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a\u6808\u6765\u7ef4\u62a4\u4ee5\u4e0a\u4fe1\u606f\uff1a\u6808\u91cc\u9762\u7684\u5143\u7d20\u662f\u4e09\u5143\u7ec4$(j,l_j,r_j)$\uff0c\u542b\u4e49\u5982\u4e0a\u3002\u6211\u4eec\u8ba9\u6808\u91cc\u7684\u5143\u7d20\u6ee1\u8db3\uff1a\u4ece\u6808\u5e95\u5230\u6808\u9876\u7684\u6bcf\u4e2a\u533a\u95f4$[l_j,r_j]$\u7aef\u70b9\u662f\u9012\u589e\u7684\uff0c\u4e14\u4e0d\u91cd\u53e0\uff0c\u5e76\u4e14\u5b83\u4eec\u7684\u5e76\u5c31\u662f$[1,n]$\u3002\n\n\u8fd9\u65f6\u5019\u5bf9\u4e8e\u4e00\u4e2a$i$\uff0c\u53ea\u8981\u5728\u6808\u91cc\u9762\u4e8c\u5206\u5c31\u53ef\u4ee5\u627e\u5230$i$\u6240\u5c5e\u7684\u533a\u95f4$[l_j,r_j]$\uff0c\u5176\u6700\u4f18\u51b3\u7b56\u5c31\u662f$j$\u3002\n\n\u7136\u540e\u8003\u8651\u628a\u7b2c$i$\u4e2a\u6570\u52a0\u5165\u6808\uff0c\u4e8b\u5b9e\u4e0a\u5c31\u662f\u5728\u5c1d\u8bd5\u80fd\u4e0d\u80fd\u6bd4\u6808\u9876\u5143\u7d20\u66f4\u4f18\uff1a\u8bbe\u6808\u9876\u5143\u7d20\u4e3a$(k,l_k,r_k)$\uff0c\u53ea\u8981\u6c42\u51fd\u6570$g_i$\u4e0e$g_k$\u7684\u4ea4\u70b9\u6a2a\u5750\u6807$x$\uff0c\u7136\u540e\u5224\u65ad\u4e00\u4e0b\uff1a\n\n- \u5982\u679c$x>n$\u8bf4\u660e$i$\u4e0d\u53ef\u80fd\u6bd4\u6808\u9876\u5143\u7d20\u66f4\u4f18\uff0c\u5c31\u6ca1\u6709$i$\u4ec0\u4e48\u4e8b\u4e86\uff0c\u7ed3\u675f\u3002\n\n- \u5982\u679c$x\\leq l_k$\u5219\u8bf4\u660e\u5728$k$\u53d1\u6325\u4f5c\u7528\u4e4b\u524d$i$\u5c31\u6bd4\u5b83\u4f18\u4e86\uff0c\u90a3\u5c31\u5b8c\u5168\u53ef\u4ee5\u628a$k$\u5f39\u6389\uff0c\u518d\u5c06$i$\u53bb\u548c\u4e0b\u4e00\u4e2a\u6808\u9876\u5143\u7d20\u6bd4\u3002\n\n- \u5982\u679c$x$\u4ecb\u4e8e$l_k$\u4e0e$r_k$\u4e4b\u95f4\uff0c\u8bf4\u660e$i$\u5c06\u4ece$x$\u5904\u5f00\u59cb\u6bd4$k$\u4f18\uff0c\u628a$r_k$\u6539\u6210$x-1$\uff0c\u7136\u540e\u628a$(i,x,n)$\u52a0\u5165\u6808\u9876\uff0c\u7ed3\u675f\u3002\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u505a\u5b8c\u4e86\u3002\u5177\u4f53\u53ef\u4ee5\u770b\u4ee3\u7801\u3002\n\n\u53e6\u5916\u6ce8\u610f\uff0c\u4e0a\u8ff0\u8fc7\u7a0b\u505a\u7b2c\u4e00\u904d\u7684\u65f6\u5019\u662f$j<i$\u7684\u60c5\u51b5\uff0c\u7b2c\u4e8c\u904d\u662f$j>i$\u7684\u60c5\u51b5\uff0c\u4f46\u662f\u59cb\u7ec8\u6ca1\u6709$j=i$\u7684\u60c5\u51b5\uff0c\u56e0\u6b64\u8f93\u51fa\u7684\u65f6\u5019\u8981\u4e0e$0$\u53d6max\n\n```cpp\n#include <cctype>\n#include <cstdio>\n#include <climits>\n#include <algorithm>\n#include <cmath>\n\n#define rep(I, A, B) for (int I = (A); I <= (B); ++I)\n#define dwn(I, A, B) for (int I = (A); I >= (B); --I)\n#define erp(I, X) for (int I = head[X]; I; I = next[I])\n\ntemplate <typename T> inline void read(T& t) {\n    int f = 0, c = getchar(); t = 0;\n    while (!isdigit(c)) f |= c == '-', c = getchar();\n    while (isdigit(c)) t = t * 10 + c - 48, c = getchar();\n    if (f) t = -t;\n}\ntemplate <typename T, typename... Args>\ninline void read(T& t, Args&... args) {\n    read(t); read(args...); \n}\ntemplate <typename T> void write(T x) {\n    if (x < 0) x = -x, putchar('-');\n    if (x > 9) write(x / 10);\n    putchar(x % 10 + 48);\n}\ntemplate <typename T> void writeln(T x) {\n    write(x);\n    puts(\"\");\n}\ntemplate <typename T> inline bool chkMin(T& x, const T& y) { return y < x ? (x = y, true) : false; }\ntemplate <typename T> inline bool chkMax(T& x, const T& y) { return x < y ? (x = y, true) : false; }\n\nconst int maxn = 5e5 + 207;\nint a[maxn];\ndouble f[2][maxn];\nstruct P3 {\n    int j, lb, rb;\n    P3() : j(0), lb(0), rb(0) {}\n    P3(int i, int l, int r) : j(i), lb(l), rb(r) {}\n};\nP3 stk[maxn];\nint n, top;\n\ninline int inter(int i, int j) {\n    int left = 0, right = n + 1, ans = n + 1;\n    while (left <= right) {\n        int mid = (left + right) >> 1;\n        if (a[i] + sqrt(mid - i) > a[j] + sqrt(mid - j))\n            ans = mid, right = mid - 1;\n        else\n            left = mid + 1;\n    }\n    return ans;\n}\n\ninline void make(double *f) {\n    f[1] = 0; top = 0;\n    stk[++top] = P3(1, 2, n);\n    rep(i, 2, n) {\n        int left = 1, right = top, pos = top;\n        while (left <= right) {\n            int mid = (left + right) >> 1;\n            if (stk[mid].lb <= i && stk[mid].rb >= i) {\n                pos = mid;\n                break;\n            } else if (stk[mid].lb > i) right = mid - 1;\n            else left = mid + 1;\n        }\n        int j = stk[pos].j;\n        f[i] = a[j] + sqrt(i - j) - a[i];\n        int x;\n        while (top && (x = inter(i, stk[top].j)) <= n) {\n            if (x <= stk[top].lb) {\n                if (top == 1) {\n                    stk[top] = P3(i, 1, n);\n                    break;\n                } else stk[--top].rb = n;\n            } else {\n                stk[top].rb = x - 1;\n                stk[++top] = P3(i, x, n);\n                break;\n            }\n        }\n    }\n}\n\nint main() {\n    read(n);\n    rep(i, 1, n) read(a[i]);\n    make(f[0]);\n    std::reverse(a + 1, a + n + 1);\n    make(f[1]);\n    std::reverse(f[1] + 1, f[1] + n + 1);\n    rep(i, 1, n) writeln((int)std::max({(double)0, ceil(f[0][i]), ceil(f[1][i])}));\n    return 0;\n}\n```",
        "postTime": 1543941302,
        "uid": 72071,
        "name": "GKxx",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3515 \u3010[POI2011]Lightning Conductor\u3011"
    },
    {
        "content": "\u89c2\u5bdf$\\sqrt{x}$\uff0c\u8fd9\u662f\u4e00\u4e2a\u4e0a\u51f8\u51fd\u6570\uff0c\u6240\u4ee5\u8bf4\u5f53\u4e00\u4e2a\u70b9\u8ddd\u79bb\u8fdc\u8fd8\u6bd4\u8ddd\u79bb\u8fd1\u7684\u8282\u70b9\u5c0f\uff0c\u4ed6\u5c31\u4e00\u5b9a\u4e0d\u518d\u7b54\u6848\u533a\u95f4\u91cc\u4e86\uff0c\u4e8c\u5206\u4e00\u4e0b\u539f\u6570\u5217\uff0c\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\u505a\u4e00\u4e2a\u53ef\u884c\u7b54\u6848\u533a\u95f4\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u5728$O(nlg)$\u7684\u65f6\u95f4\u66f4\u65b0\u7b54\u6848\uff0c\u6ce8\u610f\u5230\u65b9\u7a0b\u4e0e\u540e\u9762\u7684\u503c\u6709\u5173\uff0c\u6211\u4eec\u53ef\u4ee5\u53cd\u5411\u518d\u505a\u4e00\u904d\u3002\n",
        "postTime": 1506089045,
        "uid": 27192,
        "name": "jjikkollp",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3515 \u3010[POI2011]PIO-Lightning Conductor\u3011"
    },
    {
        "content": "\u8ba9\u6211\u9996\u6b21\u63a5\u89e6\u5230\u51b3\u7b56\u5355\u8c03\u6027\u7684\u9898\uff0c\u8fd8\u662f\u53d1\u4e0b\u9898\u89e3X\n\n\u4e4b\u524d\u5728\u6a21\u62df\u8d5b\u78b0\u5230\u8fd9\u9053\uff0c\u5f53\u65f6\u53ea\u60f3\u51fa\u4e86\u4e2a $O(n\\sqrt n\\log n)$ \u7684\u7ebf\u6bb5\u6811\u505a\u6cd5\uff0c\u770b\u9898\u89e3\u624d\u53d1\u73b0\u6709 $O(n\\log n)$ \u7684\u505a\u6cd5\uff08\n\n## \u89e3\u6790\n\n\u9996\u5148\u53ef\u4ee5\u63a8\u51fa\u8fd9\u9898\u8ba9\u6211\u4eec\u6c42\u7684 $p_i$ \u5b9e\u9645\u4e0a\u5c31\u662f\u8fd9\u4e2a\u4e1c\u897f\uff1a$p_i=\\max\\limits_{1\\leq j\\leq n}\\{a_j+\\sqrt{|i-j|}\\}-a_i$\n\n\u5176\u4e2d\u7684\u7edd\u5bf9\u503c\u6709\u70b9\u70e6\uff0c\u4e8e\u662f\u53ef\u4ee5\u628a\u8fd9\u4e2a\u5f0f\u5b50\u62c6\u6210\u4e24\u4e2a\uff1a$p_i=\\max(\\max\\limits_{1\\leq j\\leq i}\\{a_j+\\sqrt{i-j}\\}-a_i, \\max\\limits_{i\\leq j\\leq n}\\{a_j+\\sqrt{j-i}\\}-a_i)$\n\n\u5b9e\u9645\u4e0a\u5c31\u662f\u6b63\u7740\u505a\u4e00\u904d\u518d\u53cd\u7740\u505a\u4e00\u904d\uff0c\u4e8e\u662f\u4e0b\u9762\u6211\u4eec\u53ea\u5173\u5fc3\u8fd9\u4e2a\u5f0f\u5b50\uff1a$p_i=\\max\\limits_{1\\leq j\\leq n}\\{a_j+\\sqrt{i-j}\\}-a_i$\n\n\u8fd9\u770b\u8d77\u6765\u6709\u70b9\u51b3\u7b56\u5355\u8c03\u6027\u7684\u5473\u9053\u3002\u6211\u4eec\u5148\u8bd5\u7740\u5bf9\u5b83\u8bc1\u660e\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\uff1a\n\n$$\\text{\u8bbe }f(i, j)=a_j+\\sqrt{i-j}$$\n\n$$f(i, j)+f(i+1, j+1) - (f(i+1, j)+f(i, j+1))$$\n\n$$=(a_j+\\sqrt{i-j})+(a_{j+1}+\\sqrt{i-j}) - ((a_j+\\sqrt{i-j+1})+(a_{j+1}+\\sqrt{i-j-1}))$$\n\n$$=2\\sqrt{i-j} - (\\sqrt{i-j+1}+\\sqrt{i-j-1})$$\n\n$$=(\\sqrt{i-j}-\\sqrt{i-j-1}) - (\\sqrt{i-j+1}-\\sqrt{i-j})$$\n\n\u89c2\u5bdf $\\sqrt x$ \u7684\u5bfc\u51fd\u6570\uff0c\u53d1\u73b0\u5b83\u662f\u9012\u51cf\u7684\uff1b\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e00\u5b9a\u6709 $\\sqrt{x}-\\sqrt{x-1} > \\sqrt{x+1}-\\sqrt{x}$\u3002\u7531\u6b64\u5f97\u8bc1\uff0c\u6709 $f(i, j)+f(i+1, j+1) \\geq f(i+1, j)+f(i, j+1)$\n\n&nbsp;\n\n\u8bc1\u5b8c\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\u540e\uff0c\u80fd\u7528\u7684\u65b9\u6cd5\u5c31\u591a\u4e86\n\n\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u7acb\u5373\u5f97\u51fa\uff1a\n\n> \u5b9a\u7406 $1.$ \u5f53 $k > 0$ \u65f6\uff0c\u6709 $f(i, j+k)-f(i, j)$ \u968f $i$ \u5355\u8c03\u4e0d\u964d\uff0c$f(i+k, j)-f(i, j)$ \u968f $j$ \u5355\u8c03\u4e0d\u964d\n\n&nbsp;\n\n\u8fd9\u65f6\u53ef\u4ee5\u8003\u8651\u679a\u4e3e $i$\uff0c\u5e76\u540c\u65f6\u7528\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u4e00\u4e2a\u51b3\u7b56\u96c6\uff1a\n\n\u6bcf\u6b21\u5faa\u73af\u5f00\u59cb\u65f6\uff0c\u6211\u4eec\u53cd\u590d\u5f39\u51fa\u961f\u5934\u76f4\u5230\u961f\u5217\u6b63\u6570\u7b2c\u4e8c\u4e2a\u5143\u7d20\u5728\u5f53\u524d\u679a\u4e3e $i$ \u4e0b\u4e0d\u6bd4\u961f\u5934\u66f4\u4f18\uff0c\u6b64\u65f6\u961f\u5934\u5c31\u662f\u5f53\u524d $i$ \u7684\u7b54\u6848\n\n\u63a5\u7740\u6211\u4eec\u5c06 $j=i$ \u7684\u51b3\u7b56\u52a0\u5165\u961f\u5217\uff0c\u52a0\u5165\u4e00\u4e2a\u65b0\u7684\u51b3\u7b56 $f_0$ \u65f6\uff0c\u6c42\u51fa $f_0$ \u6bd4\u961f\u5c3e\u51b3\u7b56 $f_1$ \u7b2c\u4e00\u6b21\u4f18\u7684\u65f6\u95f4 $t_1$\uff0c\u548c\u961f\u5c3e\u51b3\u7b56 $f_1$ \u6bd4\u961f\u5217\u5012\u6570\u7b2c\u4e8c\u4e2a\u51b3\u7b56 $f_2$ \u4f18\u7684\u65f6\u95f4 $t_2$\u3002\u5982\u679c\u6709 $t_2\\geq t_1$\uff0c\u6839\u636e\u5b9a\u7406 $1$\uff0c\u961f\u5c3e\u51b3\u7b56\u5c31\u4e0d\u518d\u53ef\u80fd\u6210\u4e3a\u6700\u4f18\u51b3\u7b56\u4e86\uff08$f_1$ \u5728\u4f18\u4e8e $f_2$ \u524d\u4e0d\u4f1a\u4f5c\u4e3a\u7b54\u6848\uff0c\u4e14\u4e00\u65e6 $f_0$ \u4f18\u4e8e $f_1$\uff0c\u5c31\u4f1a\u4e00\u76f4\u4fdd\u6301\u4e0b\u53bb\uff09\u3002\u4e0d\u505c\u9000\u961f\u76f4\u5230\u961f\u5c3e\u51b3\u7b56\u6709\u53ef\u80fd\u6210\u4e3a\u6700\u4f18\u51b3\u7b56\uff0c\u6700\u540e\u518d\u5c06\u65b0\u7684\u51b3\u7b56\u52a0\u5165\u961f\u5217\n\n\u5176\u4e2d\u786e\u5b9a\u51b3\u7b56\u4ea4\u70b9\u53ef\u80fd\u9700\u8981\u4e8c\u5206 $x$ \u8f74\uff08$i$\uff09\uff0c\u56e0\u6b64\u6bcf\u6b21\u6bd4\u8f83\u662f $O(\\log n)$ \u7684\n\n\uff08\u8fd9\u91cc\u5176\u5b9e\u53ef\u4ee5\u76f4\u63a5\u6574\u6570\u4e8c\u5206\uff0c\u6c42\u67d0\u4e2a\u51fd\u6570\u7684\u503c\u7b2c\u4e00\u6b21\u5927\u4e8e\u53e6\u4e00\u4e2a\u51fd\u6570\u7684\u503c\u7684\u6574\u6570\u70b9\uff09\n\n\u4e8e\u662f\u603b\u7684\u590d\u6742\u5ea6\u5c31\u662f $O(n\\log n)$\n\n&nbsp;\n\n\u7531\u4e8e $f(i, j)$ \u5728\u786e\u5b9a $i, j$ \u65f6\u5c31\u5df2\u7ecf\u786e\u5b9a\u4e86\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u7528\u6574\u4f53\u4e8c\u5206\uff1a\n\n\u6211\u4eec\u7531 \u5b9a\u7406 $1$ \u53d1\u73b0\uff0c\u968f\u7740 $i$ \u7684\u589e\u52a0\uff0c\u4e00\u4e2a\u51b3\u7b56 $f(i, j)$ \u4e00\u65e6\u4f18\u4e8e\u51b3\u7b56 $\\{f(i, k):k<j\\}$\uff0c\u5c31\u4f1a\u4e00\u76f4\u4fdd\u6301\u4e0b\u53bb\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5c06\u7b54\u6848\u533a\u95f4 $[l, r]$ \u548c\u51b3\u7b56\u533a\u95f4 $[p, q]$ \u4e00\u8d77\u5206\u6cbb\uff0c\u6bcf\u6b21\u53d6 `mid=(l+r)>>1`\u3002\u904d\u5386 $[p, q]$ \u627e\u5230\u5bf9\u4e8e $i=mid$ \u7684\u6700\u4f18\u51b3\u7b56 $f(mid, k)$\uff0c\u4e8e\u662f\u6211\u4eec\u6709\uff1a\n\n1. \u5bf9\u4e8e $i>mid$\uff0c\u5b83\u7684\u6700\u4f18\u51b3\u7b56 $f(k', i)$ \u4e00\u5b9a\u6ee1\u8db3 $k'\\geq k$\n2. \u5bf9\u4e8e $i<mid$\uff0c\u5b83\u7684\u6700\u4f18\u51b3\u7b56 $f(k', i)$ \u4e00\u5b9a\u6709 $k'\\leq k$\n\n\u5bf9\u4e8e $1.$\uff0c\u7531 \u5b9a\u7406 $1$ \u53ef\u4ee5\u8f7b\u6613\u5f97\u51fa\n\n\u5bf9\u4e8e $2.$\uff0c\u6211\u4eec\u53cd\u7740\u6765\uff1b\u5982\u679c\u5bf9\u4e8e $i<mid$\uff0c\u6709 $f(i, k'), k'>k$ \u6210\u4e3a\u6700\u4f18\u51b3\u7b56\uff0c\u90a3\u4e48\u6839\u636e \u5b9a\u7406 $1$\uff0c\u968f\u7740 $i$ \u7684\u9012\u589e\uff0c$f(i, k')-f(i, k)$ \u5355\u8c03\u4e0d\u964d\uff0c\u4e8e\u662f $k$ \u5c31\u4e0d\u53ef\u80fd\u6210\u4e3a $i=mid$ \u7684\u6700\u4f18\u51b3\u7b56\uff0c\u4ea7\u751f\u4e86\u77db\u76fe\n\n\u4e8e\u662f\u6211\u4eec\u53ea\u9700\u63a5\u7740\u9012\u5f52\u5904\u7406 $[l, mid-1], [p, k]$ \u548c $[mid+1, r], [k, q]$ \u5373\u53ef\n\n\u867d\u7136 $[p, q]$ \u5411\u4e0b\u9012\u5f52\u7684\u4e24\u4e2a\u533a\u95f4\u7684\u89c4\u6a21\u662f\u4e0d\u7b49\u7684\uff0c\u4f46\u82e5\u6211\u4eec\u5efa\u51fa\u9012\u5f52\u6811\uff0c\u53ef\u4ee5\u53d1\u73b0\u9012\u5f52\u6811\u663e\u7136\u662f $\\log n$ \u9ad8\u7684\uff0c\u56e0\u4e3a\u9012\u5f52\u5c42\u6570\u53d6\u51b3\u4e8e $[l, r]$ \u7684\u5206\u6cbb\uff1b\u800c\u6bcf\u5c42\u904d\u5386\u7684 $[p, q]$ \u7684\u603b\u590d\u6742\u5ea6\u53ef\u4ee5\u53d1\u73b0\u662f $O(n)$\uff0c\u4e8e\u662f\u603b\u590d\u6742\u5ea6\u5c31\u662f $O(n\\log n)$ \u7684\n\n## CODE\n\n\u8fd9\u91cc\u662f\u6574\u4f53\u4e8c\u5206\u7684\u4ee3\u7801\n\n```cpp\n#include <cstdio>\n#include <cmath>\n#include <algorithm>\n#pragma GCC optimize(\"O3\")\n#pragma GCC optimize(\"Ofast\", \"-funroll-loops\", \"-fdelete-null-pointer-checks\")\n#pragma GCC target(\"ssse3\", \"sse3\", \"sse2\", \"sse\", \"avx2\", \"avx\")\nusing std::max;\nusing std::reverse;\n\nconst int MAXN =5e5+50;\n\n/*------------------------------Parallel Binary Search------------------------------*/\n\nint a[MAXN], n;\nint ans[MAXN];\n\nvoid solve(int l, int r, int p, int q, bool opt){\n\tint mid =(l+r)>>1;\n\tdouble Ans =-(1e9+50); int m =0;\n\tfor(int i =p; i <= mid && i <= q; ++i){\n\t\tdouble res =a[i]-a[mid]+sqrt(mid-i);\n\t\tif(res > Ans){\n\t\t\tAns =res;\n\t\t\tm =i;\n\t\t}\n\t}\n\tif(opt)\n\t\tans[n-1-mid] =max(ans[n-1-mid], (int)ceil(Ans));\n\telse\n\t\tans[mid] =ceil(Ans);\n\tif(l <= mid-1)\n\t\tsolve(l, mid-1, p, m, opt);\n\tif(r >= mid+1)\n\t\tsolve(mid+1, r, m, q, opt);\n}\n\n/*------------------------------Main------------------------------*/\n\ninline int read(){\n\tint x =0; char c =getchar();\n\twhile(c < '0' || c > '9') c =getchar();\n\twhile(c >= '0' && c <= '9') x = (x<<3) + (x<<1) + (48^c), c =getchar();\n\treturn x;\n}\n\nint main(){\n\tn =read();\n\tfor(int i =0; i < n; ++i)\n\t\ta[i] =read();\n\tsolve(0, n-1, 0, n-1, 0);\n\treverse(a, a+n);/*\u7ffb\u8f6c a \u6570\u7ec4\u518d\u505a\u4e00\u904d\uff0c\u76f8\u5f53\u4e8e\u53cd\u7740\u505a\u4e00\u904d*/\n\tsolve(0, n-1, 0, n-1, 1);\n\tfor(int i =0; i < n; ++i)\n\t\tprintf(\"%d\\n\", ans[i]);\n}\n```",
        "postTime": 1601259972,
        "uid": 105254,
        "name": "Piwry",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3515 \u3010[POI2011]Lightning Conductor\u3011"
    },
    {
        "content": "# SP9070 \u955c\u50cf\u9898\u89e3\n~~\u4e3a\u4ec0\u4e48\u90a3\u9898\u662f\u9ed1\u7684\u8fd9\u9898\u662f\u7d2b\u7684~~\n# Part0.\u9898\u76ee\u5927\u610f\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217 $\\{a_n\\}$\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $i\\in [1,n]$ \uff0c\u6c42\u51fa\u4e00\u4e2a\u6700\u5c0f\u7684\u975e\u8d1f\u6574\u6570 $p$ \uff0c\u4f7f\u5f97 $\\forall j\\in[1,n]$\uff0c\u90fd\u6709 $a_j\\le a_i+p-\\sqrt{|i-j|}$  \n**~~\u53cc\u500d\u7ecf\u9a8c~~**  \n# Part1.\u66b4\u529b\u65b9\u7a0b\n\u201c\u4efb\u4f55\u4e00\u4e2aDp\u9898\uff0c\u4f60\u60f3\u8981\u53bb\u4f18\u5316\u5b83\uff0c\u4f60\u5f97\u5148\u6709\u4e00\u4e2a\u66b4\u529b\u7684\u65b9\u7a0b\uff0c\u624d\u80fd\u8bf4\u53bb\u4f18\u5316\uff0c\u5426\u5219\u66b4\u529b\u90fd\u5199\u4e0d\u51fa\u6765\uff0c\u4f60\u4f18\u5316\u4e2a\u5bc2\u5bde\u554a\u201d  \n$f_i=max(arr_j+\\sqrt{|i-j|})-arr_i$  \n# Part2.\u5f00\u59cb\u4f18\u5316\n\u9996\u5148\u770b\u5230\u7edd\u5bf9\u503c\u4e0d\u723d\uff0c\u90a3\u53bb\u6389\u7edd\u5bf9\u503c\u5c31$j$\u4ece$1$\u5230$i$\u8dd1\u4e00\u6b21$\\sqrt{i-j}$\u7684\uff0c\u7136\u540e\u518d\u4ece$n$\u5230$i$\u8dd1\u4e00\u6b21$\\sqrt{j-i}$\u7684\u3002    \n\u63a5\u4e0b\u6765\uff0c~~\u901a\u8fc7\u6253\u8868~~\u53ef\u4ee5\u53d1\u73b0\u51b3\u7b56\u5355\u8c03\u6027\u3002~~\u6211\u592a\u83dc\u4e86\u4e0d\u4f1a\u4e25\u683c\u8bc1\u660e\u3002~~  \n[\u8fd9\u7bc7\u535a\u5ba2](https://www.luogu.com.cn/blog/83547/zong-dong-tai-gui-hua-di-ben-zhi-kan-si-bian-xing-fou-deng-shi-you-hua)\u7684\u5f15\u4f8b2\u7684\u8bc1\u660e\u5199\u7684\u633a\u597d\u7684\u3002  \n\u7136\u540e~~\u6211\u592a\u83dc\u4e86\u4e0d\u4f1a\u659c\u7387\u4f18\u5316~~\uff0c\u9009\u62e9\u5206\u6cbb\u6765\u89e3\u51b3\u672c\u9898\u3002  \n# Part3.\u5206\u6cbb\u505a\u6cd5\n\u53ef\u4ee5\u5229\u7528\u51b3\u7b56\u5355\u8c03\u6027\uff0c\u5206\u6cbb\u89e3\u51b3\u3002\u5047\u8bbe\u6211\u4eec\u5f53\u524d\u8ba1\u7b97\u7684\u533a\u95f4\u662f$[l,r]$\uff0c\u4e2d\u70b9\u4e3a$mid$\uff0c$f_{mid}$\u53d6\u5f97\u6700\u4f18\u503c\u65f6\u7684\u51b3\u7b56\u70b9\u4e3a$x_{mid}$  \n$f_l$\u6700\u4f18\u65f6\uff0c$x_l \\leq x_{mid}$\u3002\u540c\u7406\uff0c$x_{mid} \\leq x_r$\u3002  \n\u6211\u4eec\u8bbe$solve(l,r,L,R)$\u8868\u793a$f_{mid}$\u7684\u51b3\u7b56\u70b9$x_{mid}$\u5728$[L,R]$\u91cc\uff0c\u90a3\u4e48\u6709\u5982\u4e0b\u4ee3\u7801\uff08\u6838\u5fc3\u90e8\u5206\uff09\uff1a  \n\u5176\u4e2d\uff0c\u51fd\u6570$solve1$\u89e3\u51b3\u7684\u662f$j$\u4ece$1$\u5230$i$\u8dd1\u4e00\u6b21$\\sqrt{i-j}$\u7684\uff0c\u51fd\u6570$solve2$\u89e3\u51b3\u7684\u662f$j$\u4ece$n$\u5230$i$\u8dd1\u4e00\u6b21$\\sqrt{j-i}$\u7684\u3002\n```cpp\n#define ll long long\n#define ld long double\nvoid solve1(int l,int r,int L,int R){\n\tif(l>r)return;\n\tint x=0,mid=(l+r)/2;\n\tfor(int i=L;i<=min(mid,R);++i){\n\t\tld tmp=(ld)arr[i]+(ld)sqrt((double)(mid-i));\n\t\tif(tmp>f1[mid])f1[mid]=tmp,x=i;\n\t}\n\tf1[mid]-=arr[mid];\n\tsolve1(l,mid-1,L,x);\n  \tsolve1(mid+1,r,x,R);\n}\nvoid solve2(int l,int r,int L,int R){\n\tif(l>r)return;\n\tint x=0,mid=(l+r)/2;\n\tfor(int i=R;i>=max(mid,L);--i){\n\t\tld tmp=(ld)arr[i]+sqrt((double)(i-mid));\n\t\tif(tmp>f2[mid])f2[mid]=tmp,x=i;\n\t}\n\tf2[mid]-=arr[mid];\n\tsolve2(l,mid-1,L,x);\n  \tsolve2(mid+1,r,x,R);\n}\n```\n# Part4.\u6700\u7ec8AC\u4ee3\u7801\n```cpp\n#include<cstdio>\n#include<cmath>\n#define ll long long\n#define ld long double\n//\u624b\u73a9\u5373\u53ef\u53d1\u73b0f[i]=max(arr[j]+sqrt(|i-j|))-arr[i] \n//\u8003\u8651\u53bb\u6389\u7edd\u5bf9\u503c\u7684\u8bdd\uff0c\u5206\u4e24\u8fb9\u6765\u4e24\u904d\u5c31\u597d\u4e86 \n//\u6253\u8868\u53ef\u4ee5\u8bc1\u660e\u51b3\u7b56\u5355\u8c03\u6027\u3002\u4e25\u683c\u8bc1\u660e\u6211\u4e0d\u4f1a\u3002 \nnamespace QiFeng233{\n\tconst int maxn=5e5+10;\n\tint arr[maxn];\n\tld f1[maxn],f2[maxn];\n\tint n;\n\tint read(){\n\t\tint x=0,c=getchar();\n\t\twhile(c<'0'||c>'9')c=getchar();\n\t\twhile(c>='0'&&c<='9')x=x*10+c-'0',c=getchar();\n\t\treturn x;\n\t}\n\tint max(int a,int b){\n\t\treturn a>b?a:b;\n\t}\n\tint min(int a,int b){\n\t\treturn a<b?a:b;\n\t}\n\tld max(ld a,ld b){\n\t\treturn a>b?a:b;\n\t}\n\t//\u6ce8\u610f\u5230\u51b3\u7b56\u5355\u8c03\u6027\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u4e8c\u5206\u89e3\u51b3\u4e86\uff0c\u548cCF868F\u662f\u4e00\u6837\u7684 \n\tvoid solve1(int l,int r,int L,int R){\n\t\tif(l>r)return;\n\t\tint x=0,mid=(l+r)/2;\n\t\tfor(int i=L;i<=min(mid,R);++i){\n\t\t\tld tmp=(ld)arr[i]+(ld)sqrt((double)(mid-i));\n\t\t\tif(tmp>f1[mid])f1[mid]=tmp,x=i;\n\t\t}\n\t\tf1[mid]-=arr[mid];\n\t\tsolve1(l,mid-1,L,x);\n\t    solve1(mid+1,r,x,R);\n\t}\n\tvoid solve2(int l,int r,int L,int R){\n\t\tif(l>r)return;\n\t\tint x=0,mid=(l+r)/2;\n\t\tfor(int i=R;i>=max(mid,L);--i){\n\t\t\tld tmp=(ld)arr[i]+sqrt((double)(i-mid));\n\t\t\tif(tmp>f2[mid])f2[mid]=tmp,x=i;\n\t\t}\n\t\tf2[mid]-=arr[mid];\n\t\tsolve2(l,mid-1,L,x);\n\t    solve2(mid+1,r,x,R);\n\t}\n\tvoid solve(){\n\t\tn=read();\n\t\tfor(int i=1;i<=n;++i)arr[i]=read();\n\t\tsolve1(1,n,1,n);\n    \tsolve2(1,n,1,n);\n    \tfor(int i=1;i<=n;++i)printf(\"%lld\\n\",(ll)ceil(max(f1[i],f2[i])));\n\t}\n}\nsigned main(){\n\tQiFeng233::solve();\n\treturn 0;\n} \n```",
        "postTime": 1578306376,
        "uid": 233357,
        "name": "QiFeng233",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3515 \u3010[POI2011]Lightning Conductor\u3011"
    },
    {
        "content": "\u9996\u5148\u7ed9\u4f60\u4eec\u666e\u53ca\u4e0b\u5355\u8c03\u961f\u5217\u77e5\u8bc6\u5427\n\u5355\u8c03\u961f\u5217\u987e\u540d\u601d\u4e49\u5c31\u662f\u4e00\u4e2a\u6709\u89c4\u5f8b\u7684\u961f\u5217\uff0c\u8fd9\u4e2a\u961f\u5217\u7684\u89c4\u5f8b\u662f\uff1a\u6240\u6709\u5728\u961f\u5217\u91cc\u7684\u6570\u90fd\u5fc5\u987b\u6309\u9012\u589e\uff08\u6216\u9012\u51cf\uff09\u7684\u987a\u5e8f\u5217\u961f\u3002\n\n**\u5355\u8c03\u961f\u5217\u7684\u539f\u7406\uff1a**\n\n\u5728\u5904\u7406f[i]\u65f6\uff0c\u53bb\u9664\u5197\u6742\u3001\u591a\u4f59\u7684\u72b6\u6001\uff0c\u4f7f\u5f97\u6bcf\u4e2a\u72b6\u6001\u5728\u961f\u5217\u4e2d\u53ea\u4f1a\u51fa\u73b0\u4e00\u6b21\uff1b\u540c\u65f6\u7ef4\u62a4\u4e00\u4e2a\u80fd\u77ac\u95f4\u5f97\u51fa\u6700\u4f18\u89e3\u7684\u961f\u5217\uff0c\u51cf\u5c11\u91cd\u65b0\u8bbf\u95ee\u7684\u65f6\u95f4\uff1b\u5728\u53d6\u5f97\u81ea\u5df1\u6240\u9700\u7684\u503c\u540e\uff0c\u4e3a\u540e\u7eed\u7684\u6c42\u89e3\u505a\u597d\u51c6\u5907\u3002\n\n**\u6574\u7406\u5f52\u7eb3\u5355\u8c03\u961f\u5217\u7684\u5b9a\u4e49\uff1a**\n\n1\u3001\u7ef4\u62a4\u533a\u95f4\u6700\u503c\uff1b\n\n2\u3001\u53bb\u9664\u5197\u6742\u72b6\u6001\uff1b\n\n3\u3001\u4fdd\u6301\u961f\u5217\u5355\u8c03\uff08\u6700\u5927\u503c\u662f\u5355\u8c03\u9012\u51cf\u5e8f\u5217\uff0c\u6700\u5c0f\u503c\u662f\u5355\u8c03\n\u9012\u589e\u5e8f\u5217\uff09\uff1b\n\n4\u3001\u6700\u4f18\u9009\u62e9\u5728\u961f\u9996\n\n**\u8fdb\u5165\u6b63\u9898\u73af\u8282\uff1a**\n\n\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u7ef4\u62a4\u4e00\u4e2a\u5355\u8c03\u961f\u5217\uff0c\u6bcf\u6b21\u6bd4\u8f83\u53ef\u4ee5\u901a\u8fc7find\u51fd\u6570\u8fdb\u884c\u4e09\u5206\u641c\u7d22\u4e24\u51fd\u6570\u7684\u4ea4\u70b9\uff0c\u4ece\u5f97\u5230\u961f\u5217\u91cc\u653e\u5165front\u6570\u7ec4\uff0c\u518d\u5c06a\u6570\u7ec4\u7ffb\u8f6c\u518d\u5355\u8c03\u961f\u5217\uff0c\u653e\u5165ed\u6570\u7ec4\uff0c\n\u4ece1\u5230n\u8fdb\u884c\u679a\u4e3emax(ceil(front[i].second+sqrt(i-front[i].first)-eps),ceil(ed[i].second+sqrt(ed[i].first-i)-eps))\n\u518d\u51cf\u53bb\u5bf9\u5e94\u7684a\u6570\u7ec4\u5c31\u662f\u7b54\u6848\u3002\n\u8be6\u7ec6\u770b\u4ee3\u7801\u5427\uff01\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\nstruct mode\n{\n\tint x,index,l,r;\n\tmode(){}\n\tmode(int x,int index,int l,int r):x(x),index(index),l(l),r(r){}\n};\n\nconst double eps=1e-8;\nconst int N=5e5+5;\ndeque<mode> q;\nint n;\nint a[N];\npair<int,int> front[N];\npair<int,int> ed[N]; \nint ans[N];\n\nint find(int x,int ix,int y,int iy)\n{\n\tint ans=-1;\n\tint l=iy,r=n;\n\twhile(l<=r)\n\t{\n\t\tint mid=(l+r)>>1;\n\t\tif(y+sqrt(mid-iy)+eps>=x+sqrt(mid-ix))\n\t\t{\n\t\t\tr=mid-1;\n\t\t\tans=mid;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tl=mid+1;\n\t\t}\n\t}\n\treturn ans;\n\t\n}\n\nvoid f()\n{\n\tq.emplace_back(a[1],1,2,n);\n\tfor(int i=2;i<n;i++)\n\t{\n\t\tint l,r=n;\n\t\tif(q.back().x>=a[i])\n\t\t\tcontinue;\n\t\twhile(q.back().l>i&&q.back().x+sqrt(q.back().l-q.back().index)+eps<=a[i]+sqrt(q.back().l-i))\n\t\t{\n\t\t\tl=q.back().l;\n\t\t\tq.pop_back();\n\t\t}\n\t\tif(q.back().x+sqrt(i-q.back().index)+eps<=a[i])\n\t\t{\n\t\t\tq.back().l=i;\n\t\t\tq.emplace_back(a[i],i,i+1,n);\n\t\t\tcontinue;\n\t\t}\n\t\tint id=find(q.back().x,q.back().index,a[i],i);\n\t\tif(id==-1)\n\t\t\tcontinue;\n\t\telse\n\t\t{\n\t\t\tq.back().r=id-1;\n\t\t\tq.emplace_back(a[i],i,id,n);\n\t\t}\n\t}\n}\n\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)\n\t\tscanf(\"%d\",a+i);\n\tif(n==1)\t\n\t{\n\t\tcout<<0<<endl;\n\t\treturn 0;\n\t}\n\tf();\n\tfor(auto m:q)\n\t{\n\t\tfor(int i=m.l;i<=m.r;i++)\n\t\t\tfront[i]=make_pair(m.index,m.x);\n\t}\n\twhile(q.size())\n\t\tq.pop_back();\t\n\treverse(a+1,a+n+1);\n\tf();\n\tfor(auto m:q)\n\t{\n\t\tfor(int i=m.l;i<=m.r;i++)\n\t\t\ted[n+1-i]=make_pair(n+1-m.index,m.x);\n\t}\n\treverse(a+1,a+n+1);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(i==1)\n\t\t\tans[i]=ceil(ed[1].second+sqrt(ed[1].first-i)-eps);\n\t\telse if(i==n)\n\t\t\tans[i]=ceil(front[n].second+sqrt(n-front[n].first)-eps);\n\t\telse\n\t\t{\n\t\t\tans[i]=max(ceil(front[i].second+sqrt(i-front[i].first)-eps),ceil(ed[i].second+sqrt(ed[i].first-i)-eps));\n\t\t}\n\t}\n\t\n\n\tfor(int i=1;i<=n;i++)\n\t\tprintf(\"%d\\n\",max(0,ans[i]-a[i]));\n\t\n    return 0;\n}\n\n```\n",
        "postTime": 1588694906,
        "uid": 278508,
        "name": "chenguanghui",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3515 \u3010[POI2011]Lightning Conductor\u3011"
    },
    {
        "content": "[\u9898\u76ee](https://www.luogu.com.cn/problem/P3515)\n\n\u9898\u610f\uff1a\u7ed9\u51fa$\\{a_n\\}$\uff0c\u5bf9\u4e8e$i\\in[1,n]$\uff0c\u6c42\u51fa\u6700\u5c0f\u7684$p$\uff0c\u4f7f\u5f97$\\forall j\\in [1,n]$\u6709$a_j\\leq a_i+p-\\sqrt{|i-j|}$\n\n\u5373\u6c42$f(i)=\\max_{j=1}^{n}\\{a_j-a_i+\\sqrt{|i-j|}\\}$\n\n\u56e0\u4e3a\u6709\u7edd\u5bf9\u503c\uff0c\u6240\u4ee5\u53ef\u4ee5\u6b63\u7740\u505a\u4e00\u904d\uff0c\u5012\u7740\u505a\u4e00\u904d\uff0c\u6240\u4ee5\u8f6c\u5316\u4e3a\u6c42\uff1a\n\n$f(i)=\\max_{j=1}^{i-1}\\{a_j+\\sqrt{i-j}\\}-a_i$\n\n\u8bd5\u7740\u8bc1\u4e00\u4e0b\u51b3\u7b56\u5355\u8c03\u6027\n\n\u8bbe$val(j,i)=a_j+\\sqrt{i-j}$\n\n\u8981\u8bc1\u5bf9\u4e8e$\\forall j<i$\uff0c\u6709$val(j,i+1)+val(j+1,i)\\geq val(j,i)+val(j+1,i+1)$\n\n\u5373$val(j,i+1)-val(j,i)\\geq val(j+1,i+1)-val(j+1,i)$\n\n\u76f4\u63a5\u5e26\u8fdb\u53bb\uff0c$a_j$\u5c31\u6ca1\u4e86\uff01\uff01\uff01\n\n$\\sqrt{i-j+1}-\\sqrt{i-j}\\geq \\sqrt{i-j}-\\sqrt{i-j-1}$\n\n\u5373$\\sqrt{u+1}-\\sqrt{u}\\geq \\sqrt{u}-\\sqrt{u-1}$\n\n\u8fd9\u4e0d\u663e\u7136\u662f\u9519\u7684\u5417\uff08\u4e5f\u53ef\u4ee5\u6c42\u5bfc\uff09\n\n\u60f3\u5230\u8fd9\u65f6\uff1a\u6211\u4e00\u5ea6\u6000\u7591\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\u7684\u6b63\u786e\u6027\u3002\u7167\u7406\u6765\u8bf4\u5e94\u8be5\u8981\u6ee1\u8db3\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\u5440\uff1f\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/v1s63p0p.png)\n\n\n~~\u6211\u6015\u4e0d\u662f\u5f31\u667a~~\n\n\u8fd9\u4e00\u5207\u7684\u4e00\u5207\u90fd\u662f\u5728$\\min$\u7684\u6761\u4ef6\u4e0b\u8ba8\u8bba\u7684\u3002\u800c\u8fd9\u9053\u9898\u6c42\u7684\u662f$max$\uff0c\u6240\u4ee5\u628a\u4e0a\u9762\u6240\u6709\u7684\u7b26\u53f7\u53d6\u53cd\uff0c\u5c31\u6ee1\u8db3\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\u4e86\u3002\n\n\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u7528\u6570\u5f62\u7ed3\u5408\u7684\u89d2\u5ea6\u6765\u7406\u89e3\u3002$a+\\sqrt{i-j}$\u8fd9\u4e2a\u51fd\u6570\u589e\u957f\u7387\u662f\u4e0d\u65ad\u51cf\u5c0f\u7684\n\n\u7136\u540e\u5957\u4e0a\u677f\u5b50\u5c31\u597d\u5566\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <algorithm>\nusing namespace std;\nconst int N=5e5+10;\nint n;\nint v[2][N],ans[2][N];//0\u662f\u6b63\u7740\u7684,1\u662f\u53cd\u7740\u7684 \nstruct node\n{\n\tint p;//\u6700\u4f18\u51b3\u7b56 \n\tint l,r;//\u7ba1\u8f96\u7684\u533a\u95f4 \n}que[N];\ninline double cal(int si,int j,int i)\n{\n\treturn v[si][j]+sqrt(i-j);\n}\ninline void solve(int si)\n{\n\tque[1]=(node){1,1,n};//\u4e0d\u8981\u4ece0\u5f00\u59cb \n\tint head=1,tail=1;\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\twhile(head<=tail&&que[head].r<i) head++;//\u6392\u9664\u8fc7\u65f6\u51b3\u7b56 \n\t\tque[head].l=i;\n\t\tif(cal(si,que[head].p,i)>cal(si,ans[si][i],i)) ans[si][i]=que[head].p;//\u8ddf\u539f\u6765\u7684\u6bd4\u8f83 \n\t\twhile(head<=tail&&cal(si,i,que[tail].l)>=cal(si,que[tail].p,que[tail].l)) tail--;//\u6574\u5757\u52a3\u7684\u5220\u6389 \n\t\tint low=que[tail].l,high=que[tail].r+1;//\u4e8c\u5206\u51fa\u7b2c\u4e00\u4e2a\u52a3\u7684\u4f4d\u7f6e \n\t\twhile(low+1<high)\n\t\t{\n\t\t\tint mid=(low+high)/2;\n\t\t\tif(cal(si,i,mid)>=cal(si,que[tail].p,mid)) high=mid;\n\t\t\telse low=mid;\n\t\t}\n\t\tque[tail].r=high-1;//\u4fee\u6539\u6700\u540e\u4e00\u5757 \n\t\tif(high<=n) que[++tail]=(node){i,high,n};//\u63d2\u5165\u65b0\u7684\u4e00\u5757 \n\t}\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&v[0][i]);\n\t\tv[1][n-i+1]=v[0][i];\n\t\tans[0][i]=ans[1][i]=i;//\u6709\u53ef\u80fd\u662f\u672c\u8eab\u4e3a\u6700\u4f18\u51b3\u7b56 \n\t}\n\tsolve(0),solve(1);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint maxn=ceil(max(cal(0,ans[0][i],i),cal(1,ans[1][n-i+1],n-i+1)));//\u6ce8\u610f\u53cd\u7684 \n\t\tprintf(\"%d\\n\",maxn-v[0][i]);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1586513855,
        "uid": 81238,
        "name": "MCAdam",
        "ccfLevel": 7,
        "title": "P3515 [POI2011]Lightning Conductor"
    },
    {
        "content": "## \u4e00\u3001\u9898\u76ee\n\u5df2\u77e5\u4e00\u4e2a\u957f\u5ea6\u4e3a$n$\u7684\u5e8f\u5217$a1,a2,...,an$\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a$1<=i<=n$\uff0c\u627e\u5230\u6700\u5c0f\u7684\u975e\u8d1f\u6574\u6570$pi$\u6ee1\u8db3\u5bf9\u4e8e\u4efb\u610f\u7684$j$\uff0c$aj\\leq ai+pi-\\sqrt{|i-j|}$\n\n\n$1\u2264n\u22645\\times10^5\uff0c0\u2264ai\u226410^9$\n\n## \u4e8c\u3001\u89e3\u6cd5\n\n\u6211\u4eec\u5148\u5bf9\u9898\u76ee\u7684\u5f0f\u5b50\u8fdb\u884c\u6539\u53d8\uff1a\n\n$\\Rightarrow pi>=aj+sqrt{|i-j|}-ai$\n\n\u6211\u4eec\u628a\u9898\u76ee\u62c6\u6210\u4e24\u4e2a\u5f0f\u5b50\uff0c\u518d\u53d6\u6700\u5927\u503c\uff1a\n\n$pi>=aj+\\sqrt {i-j} -ai$\n\n$pi>=aj+\\sqrt {j-i}-ai$\n\n\u6211\u4eec\u8003\u8651\u7b2c\u4e00\u4e2a\u5f0f\u5b50\uff0c\u7b2c\u4e8c\u4e2a\u5f0f\u5b50\u5c06\u4e4b\u53cd\u5411\u5373\u53ef\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a$j$\uff0c\u628a$aj+\\sqrt{i-j}$\uff0c\u770b\u6210\u5173\u4e8e$i$\u7684\u51fd\u6570$fj$\u200b\u3002\u6211\u4eec\u8981\u505a\u7684\u5c31\u662f\u5728\u6240\u6709$j\u2264i$\u7684\u51fd\u6570\u4e2d\u627e\u5230\u6700\u503c\u3002\n\n\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u51b3\u7b56\u4e8c\u5206\u6808\uff0c\u6309$j$\u4ece\u5927\u5230\u5c0f\u7ef4\u62a4\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u51fd\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u6c42\u51fa\u6808\u4e2d\u76f8\u90bb\u4e24\u4e2a\u5143\u7d20\uff0c\u540e\u9762\u7684\u5143\u7d20\u521a\u597d\u8d85\u8fc7\u524d\u9762\u5143\u7d20\u7684\u4e0b\u6807$k$\uff08\u4e34\u754c\u70b9\uff09\uff0c\u539f\u56e0\u662f$sqrt$\u7684\u589e\u901f\u4f1a\u8d8a\u6765\u8d8a\u6162\uff0c\u5f53\u5230\u4e34\u754c\u70b9\u65f6\uff0c\u52a0\u5165\u7684\u70b9\u5982\u679c\u6bd4\u961f\u5c3e\u5143\u7d20\u4f18\uff0c\u90a3\u5c31\u8e22\u51fa\u961f\u5c3e\u5143\u7d20\uff0c\u6240\u4ee5\u6211\u4eec\u7ef4\u62a4\u7684\u662f\u4e00\u4e2a$k$\u5355\u8c03\u9012\u51cf\u7684\u961f\u5217\uff0c\u5f53\u5904\u7406\u5b8c\u961f\u5c3e\u540e\uff0c\u4e8c\u5206\u7b97\u51fa\u5f53\u524d\u70b9\u7684$k$\uff0c\u628a\u5f53\u524d\u70b9\u52a0\u5165\u961f\u5217\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\uff0c\u6211\u4eec\u8e22\u51fa\u5df2\u4e0d\u4f18\u7684\u961f\u5934\uff0c\u518d\u7528\u961f\u5934\u66f4\u65b0\u7b54\u6848\u5373\u53ef\u3002\n\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <iostream>\n#include <cstring>\nusing namespace std;\n#define cal(i,j) (a[j]+sq[i-j])\nconst int MAXN = 5e5+5;\nint read()\n{\n    int num=0,flag=1;char c;\n    while((c=getchar())<'0'||c>'9') if(c=='-') flag=-1;\n    while(c>='0'&&c<='9')num=(num<<3)+(num<<1)+(c^48),c=getchar();\n    return num*flag;\n}\nint n,a[MAXN],k[MAXN],q[MAXN];\ndouble p[MAXN],sq[MAXN];\nint bound(int x,int y)\n{\n\tint l=y,r=k[x]?k[x]:n,mid,ret=r+1;\n\twhile(l<=r)\n\t{\n\t\tmid=(l+r)>>1;\n\t\tif(cal(mid,x)<=cal(mid,y))\n\t\t\tret=mid,r=mid-1;\n\t\telse\n\t\t\tl=mid+1;\n\t}\n\treturn ret;\n}\nvoid work()\n{\n\tint h=1,t=0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\twhile(h<t && cal(k[t-1],q[t])<cal(k[t-1],i)) t--;\n\t\tk[t]=bound(q[t],i),q[++t]=i;\n\t\twhile(h<t && k[h]<=i) ++h;\n\t\tp[i]=max(p[i],cal(i,q[h]));\n\t}\n}\nint main()\n{\n\tn=read();\n\tfor(int i=1;i<=n;i++)\n\t\ta[i]=read(),sq[i]=sqrt(i);\n\twork();\n\tfor(int i=1,j=n;i<j;i++,j--)\n\t\tswap(a[i],a[j]),swap(p[i],p[j]);\n\tmemset(k,0,sizeof k);\n\twork();\n\tfor(int i=n;i>=1;i--)\n\t\tprintf(\"%d\\n\",max((int)ceil(p[i])-a[i],0));\n}\n```\n\n",
        "postTime": 1566734252,
        "uid": 128239,
        "name": "C20203030",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3515 \u3010[POI2011]Lightning Conductor\u3011"
    },
    {
        "content": "\u6211\u89c9\u5f97\u9700\u8981\u4e25\u683c\u8bc1\u660e\u5355\u8c03\u6027\n\n\u6211\u4eec\u8981\u8bc1\u7684\u662f\u5bf9\u4e8e$F_i=\\max _{1\\le j<i}{\\{a_j+\\sqrt{i-j}\\}}$\uff0c\u8bb0$P_i$\u4e3a\u53e6$F_i$\u53d6\u5230\u6700\u5927\u503c\u7684$j$\uff0c\u6709$P$\u5355\u8c03\u4e0d\u51cf\n\n\u8003\u8651\u53cd\u8bc1\u6cd5\uff1a\u5047\u8bbe$\\exists j<i,P_j>P_i$\n\n\u4e5f\u5c31\u662f$P_i<P_j<j<i$\n\n\u6839\u636e$P$\u7684\u6700\u5927\u6027\uff0c\u6211\u4eec\u6709\u4ee5\u4e0b\u4e24\u4e2a\u5f0f\u5b50\n\n$$a_{P_j}+\\sqrt{j-P_j}> a_{P_i}+\\sqrt{j-P_i}$$\n\n$$a_{P_i}+\\sqrt{i-P_i}> a_{P_j}+\\sqrt{i-P_j}$$\n\n\u4e24\u5f0f\u76f8\u52a0\uff0c\u8bb0$w(j,i)=\\sqrt{i-j}$\uff0c\u6709\n\n$$w(P_j,j)+w(P_i,i)>w(j,P_i)+w(i,P_j)$$\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ea\u9700\u8bc1\u660e\n\n$$w(P_j,j)+w(P_i,i)\\le w(j,P_i)+w(i,P_j)$$\n\n\u4e5f\u5c31\u662f$\\forall a<b<c<d,w(a,d)+w(b,c)\\le w(a,c)+w(b,d)$\n\n\u5c31\u53ef\u4ee5\u63a8\u51fa\u77db\u76fe\uff0c\u4ece\u800c\u8bc1\u660e\u539f\u547d\u9898\u4e86\uff0c\u8fd9\u8fb9\u4ecb\u7ecd\u4e00\u4e2a\u5b9a\u7406\uff1a\n\n- **\u5b9a\u7406** \u82e5\u4e00\u4e2a\u5b9a\u4e49\u5728\u6574\u6570\u96c6\u4e0a\u7684\u4e8c\u5143\u51fd\u6570$w(x,y)$\u6ee1\u8db3\u5bf9\u4e8e\u4efb\u610f\u5b9a\u4e49\u57df\u5185\u7684$a<b$\uff0c\u90fd\u6709$w(a,b+1)+w(a+1,b)\\le w(a,b)+w(a+1,b+1)$\u6210\u7acb\uff0c\u5219$w(x,y)$\u6ee1\u8db3$\\forall a,b,c,d,w(a,d)+w(b,c)\\le w(a,c)+w(b,d)$\n\n- **\u8bc1\u660e** \n\n\t- \u8003\u8651\u6570\u5b66\u5f52\u7eb3\u6cd5\uff0c\u82e5$k$\u4e3a\u4e00\u975e\u8d1f\u6574\u6570\uff0c\u8bb0$b=a+k$\uff0c\u4e14$b=a+k<c$\n    \n   - \u5f53$k=1$\n\n\t- $$w(a-1,c+1)+w(a,c)\\le w(a-1,c)+w(a,c+1)$$\n\n\t- $$w(a,c+1)+w(a+1,c)\\le w(a,c)+w(a+1,c+1)$$\n\n\t- \u4e24\u5f0f\u76f8\u52a0\uff0c\u6709\n\n\t- $$w(a,c+1)+w(a+1,c)\\le w(a,c)+w(a+1,c+1)$$\n    \n   - \u5f53$k>1$\n   \n   - \u82e5\u6709\n   \n   - $$w(a,c+1)+w(a+k-1,c)\\le w(a,c)+w(a+k-1,c+1)$$\n\n\t- \u56e0\u4e3a$a+k<c$\n    \n   - $$w(a+k-1,c+1)+w(a+k,c)\\le w(a+k-1,c)+w(a+k,c+1)$$\n   \n   - \u4e24\u5f0f\u76f8\u52a0\uff0c\u6709\n\n\t- $$w(a,c+1)+w(a+k,c)\\le w(a,c)+w(a+k,c+1)$$\n    \n   - \u4e5f\u5c31\u662f$\\forall a<b<c,w(a,c+1)+w(b,c)\\le w(a,c)+w(b,c+1)$\n   \n   - \u7136\u540e\u8bb0$d=c+k$\n   \n   - \u5f53$k=1$\uff0c\u7531\u4e0a\u5f0f\n   \n   - $$w(a,c+1)+w(b+c)\\le w(a,c)+w(b,c+1)$$\n   \n   - $$w(a,c+2)+w(b,c+1)\\le w(a,c+1)+w(b,c+2)$$\n   \n   - \u4e24\u5f0f\u76f8\u52a0\uff0c\u6709\n   \n   - $$w(a,c+2)+w(b,c)\\le w(a,c)+w(b,c+2)$$\n   \n   - \u5f53$k>1$\n   \n   - \u5047\u8bbe\u6709\n   \n   - $$w(a,c+k-1)+w(b,c)\\le w(a,c)+w(b,c+k-1)$$\n   \n   - \u56e0\u4e3a$c+k>b$\n   \n   - $$w(a,c+k)+w(b,c+k-1)\\le w(a,c+k-1)+w(b,c+k)$$\n   \n   - \u4e24\u5f0f\u76f8\u52a0\uff0c\u6709\n   \n   - $$w(a,c+k)+w(b,c)\\le w(a,c)+w(b,c+k)$$\n   \n   - \u5373$\\forall a<b<c<d,w(a,d)+w(b,c)\\le w(a,c)+w(b,d)$\n   \n \u6240\u4ee5\u73b0\u5728\u6211\u4eec\u53ea\u9700\u8bc1\u660e\n \n $$\\forall a<b,w(a,b+1)+w(a+1,b)\\le w(a,b)+w(a+1,b+1)$$\n \n \u8bb0$d=b-a$\n \n \u5c06\u4e0a\u5f0f\u6362\u4e3a\u539f\u8868\u8fbe\u5f0f\u5e76\u5e26\u5165$d=b-a$\n \n $$\\sqrt{d+1}+\\sqrt{d-1}\\le \\sqrt{d}+\\sqrt{d}$$\n \n \u79fb\u9879\uff0c\u6709\n \n $$\\sqrt{d+1}-\\sqrt{d}\\le \\sqrt{d}-\\sqrt{d-1}$$\n \n \u6b64\u5904\u6709\u4e24\u79cd\u8bc1\u660e\u65b9\u6cd5\uff0c\u5148\u8bb2\u7b2c\u4e00\u79cd\n \n \u8bb0$f(x)=\\sqrt{x}-\\sqrt{x-1}$\uff0c\u6240\u4ee5\u53ea\u9700\u8bc1\u660e$f(x)$\u5355\u8c03\u9012\u51cf\u5373\u53ef\n \n \u6c42\u5bfc\u5f97$f'(x)=\\frac{1}{2\\sqrt{x}}-\\frac{1}{2\\sqrt{x-1}}$\uff0c\u663e\u7136\u6709\u5728$x\\ge 0$\u65f6\uff0c$f'(x)$\u6052\u975e\u6b63\uff0c\u6545$f(x)$\u5355\u8c03\u9012\u51cf\uff0c\u8bc1\u6bd5\u3002\n \n \u73b0\u5728\u8bb2\u7b2c\u4e8c\u79cd\u65b9\u6cd5\n \n \u4ecd\u7136\u662f\n \n $$\\sqrt{d+1}-\\sqrt{d}\\le \\sqrt{d}-\\sqrt{d-1}$$\n \n \u4e24\u8fb9\u540c\u65f6\u9664\u4ee5$1$\n \n $$\\frac{\\sqrt{d+1}-\\sqrt{d}}{1}\\leq \\frac{\\sqrt{d}-\\sqrt{d-1}}{1}$$\n \n \u8bb0$f(x)=\\sqrt{x}$\uff0c\u5bb9\u6613\u53d1\u73b0\u4e24\u8fb9\u90fd\u662f\u62c9\u683c\u6717\u65e5\u4e2d\u503c\u5b9a\u7406\u7684\u5f62\u5f0f\uff0c\u6240\u4ee5\u5b58\u5728$n\\in(d,d+1),m\\in(d-1,d)$\uff0c\u4f7f\u5f97$f'(n)=\\frac{\\sqrt{d+1}-\\sqrt{d}}{1},f'(m)=\\frac{\\sqrt{d}-\\sqrt{d-1}}{1}$\uff0c\u6ce8\u610f\u5230$f'(x)=\\frac{1}{2\\sqrt{x}}$\u5355\u8c03\u9012\u51cf\u4e14$n<m$\u6240\u4ee5\u4e0a\u5f0f\u5f97\u8bc1\u3002",
        "postTime": 1573104463,
        "uid": 83547,
        "name": "LCuter",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3515 \u3010[POI2011]Lightning Conductor\u3011"
    }
]
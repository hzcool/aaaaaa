[
    {
        "content": "\u65f6\u9694\u591a\u6708\u91cd\u89c1\u6b64\u9898\uff0c~~\u53d1\u73b0\u6ca1\u6709\u9898\u89e3~~\u53d1\u73b0\u5176\u5b9e\u8003\u573a\u4e0a\u7684\u601d\u8def\u662f\u5bf9\u7684\u628a\u91cd\u5fc3\u5f53\u6210\u6839\u5c31\u597d\u4e86\uff08\uff09\n\n- **\u601d\u8def**\n\n\u6211\u4eec\u4e00\u5f00\u59cb\u5e76\u4e0d\u80fd\u786e\u5b9a\u6839\u8282\u70b9\u662f\u54ea\u91cc\u6240\u4ee5\u6211\u4eec\u5148\u4e0d\u53bb\u7ba1\u5b83\u3002\n\n\u5047\u8bbe\u6211\u4eec\u627e\u5230\u4e86\u4e00\u4e2a\u6839\u8282\u70b9\uff0c\u5e76\u4e14\u5b83\u7684\u5ea6\u6570\u4e3a2\uff0c\u6211\u4eec\u8003\u8651\u600e\u4e48\u505a\u3002\n\n\u4e00\u4e2a\u663e\u7136\u7684\u60f3\u6cd5\uff0c\u6211\u4eec\u6bcf\u6b21\u4ece\u5b83\u7684\u5de6\u53f3\u4e24\u4e2a\u5b50\u6811\u4e2d\u9009\u53d6\u6df1\u5ea6\u6700\u5927\u7684\u4e00\u4e2a\uff0c\u56e0\u4e3a\u603b\u8def\u7a0b\u53ef\u4ee5\u770b\u6210\u4e00\u4e2a\u5b50\u6811->\u6839->\u53e6\u4e00\u4e2a\u5b50\u6811\uff0c\u800c\u56e0\u4e3a\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5b50\u6811\u91cc\u6211\u4eec\u9009\u53d6\u7684\u6df1\u5ea6\u90fd\u662f\u4e0d\u589e\u7684\uff0c\u6240\u4ee5\u4e00\u4e2a\u5b50\u6811->\u6839\u4e0e\u6839->\u53e6\u4e00\u4e2a\u5b50\u6811\u7684\u503c\u90fd\u662f\u4e0d\u589e\u7684\uff0c\u603b\u8def\u7a0b\u4e5f\u662f\u4e0d\u589e\u7684\u3002\n\n\u73b0\u5728\u7684\u95ee\u9898\u662f\u5982\u4f55\u627e\u5230\u8fd9\u6837\u7684\u4e00\u4e2a\u6839\u3002\u6211\u4eec\u53d1\u73b0\u6bcf\u4e24\u6b21\u64cd\u4f5c\u90fd\u4f1a\u4f7f\u4e24\u68f5\u5b50\u6811\u5927\u5c0f\u5404\u51cf\u4e00\uff0c\u800c\u5982\u679c\u4e00\u4e2a\u5b50\u6811\u7684\u5927\u5c0f\u4e0e\u53e6\u4e00\u9897\u5b50\u6811\u7684\u5927\u5c0f\u76f8\u5dee2\u53ca\u4ee5\u4e0a\uff0c\u90a3\u4e48\u5728\u6700\u540e\u5c31\u53ea\u4f1a\u5269\u4e0b\u6839->\u5b50\u6811\uff0c\u6211\u4eec\u4e0d\u80fd\u4fdd\u8bc1\u6709\u4e00\u4e2a\u5408\u9002\u7684\u65b9\u6848\u4f7f\u5176\u5728\u8def\u7a0b\u5c0f\u4e8e\u7b49\u4e8e\u4e4b\u524d\u7684\u540c\u65f6\u8d70\u7684\u8def\u7a0b\u4e0d\u589e\uff0c\u6240\u4ee5\u6700\u597d\u7684\u529e\u6cd5\u662f\u8ba9\u4e00\u4e2a\u5b50\u6811\u7684\u5927\u5c0f\u4e0e\u53e6\u4e00\u9897\u5b50\u6811\u7684\u5927\u5c0f\u76f8\u5dee1\u53ca\u4ee5\u4e0b\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u9009\u62e9\u7684\u70b9\u662f\u91cd\u5fc3\u3002\n\n\u4ee5\u4e0a\u662f\u91cd\u5fc3\u5ea6\u6570\u4e3a2\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u91cd\u5fc3\u4e3a\u6839\uff0c\u63a5\u4e0b\u6765\u8003\u8651\u91cd\u5fc3\u7684\u5ea6\u6570\u662f3\u8be5\u600e\u4e48\u5904\u7406\u3002\n\n\u56e0\u4e3a\u91cd\u5fc3\u7684\u5b50\u6811\u5927\u5c0f\u4e0d\u4f1a\u8d85\u8fc7 $\\left\\lfloor\\dfrac{n}{2}\\right\\rfloor$\uff0c\u6240\u4ee5\u5982\u679c\u5176\u4e2d\u6709\u4e00\u4e2a\u5b50\u6811\u5927\u4e8e\u7b49\u4e8e\u5176\u4ed6\u4e24\u4e2a\u5b50\u6811\u7684\u548c\uff0c\u90a3\u4e48\u5b83\u7684\u5927\u5c0f\u4e00\u5b9a\u662f$\\left\\lfloor\\dfrac{n}{2}\\right\\rfloor$\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5269\u4e0b\u7684\u4e24\u68f5\u5b50\u6811\u770b\u6210\u4e00\u68f5\u5b50\u6811\u6765\u5904\u7406\u3002\u8fd9\u5c31\u6210\u4e86\u5ea6\u6570\u4e3a2\u7684\u60c5\u51b5\u3002\n\n\u800c\u5982\u679c\u6700\u5927\u7684\u5b50\u6811\u5927\u5c0f\u5c0f\u4e8e\u5269\u4f59\u4e24\u4e2a\u7684\u548c\uff0c\u90a3\u4e48\u6211\u4eec\u6bcf\u6b21\u4ece\u975e\u4e0a\u4e00\u6b21\u9009\u7684\u5b50\u6811\u4e2d\u9009\u62e9\u4e00\u4e2a\u6700\u5927\u7684\uff08\u7b2c\u4e00\u6b21\u53ef\u4efb\u610f\u9009\uff09\uff0c\u8fd9\u6837\u4e5f\u80fd\u4fdd\u8bc1\u8def\u7a0b\u9012\u51cf\uff0c\u5982\u56fe\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8rmqef6l.png)\n\n\u4e00\u5f00\u59cb\u5148\u4ece\u9ec4\u8fb9\u8d70\u5230\u7b2c\u4e09\u68f5\u5b50\u6811\u5982\u679c\u63a5\u4e0b\u6765\u8d70\u84dd\u8fb9\u7684\u8bdd\u5c31\u548c\u5ea6\u6570\u4e3a2\u7684\u60c5\u51b5\u4e0b\u4e00\u6837\u5fc5\u7136\u662f\u4e0d\u589e\u7684\uff0c\u5047\u5982\u8d70\u7ea2\u8fb9\u6211\u4eec\u53ef\u4ee5\u7528\u53cd\u8bc1\u6cd5\uff0c\u5982\u679c\u5b83\u7684\u957f\u5ea6\u6bd4\u7b2c\u4e00\u68f5\u5b50\u6811\u91cc\u7684\u9ec4\u8fb9\u5927\uff0c\u90a3\u4e48\u5b83\u4eec\u7684\u957f\u5ea6\u987a\u5e8f\u4e3a\u7b2c\u4e00\u68f5\u5b50\u6811\u9ec4$<$\u8fb9\u7b2c\u4e8c\u68f5\u5b50\u6811\u7ea2\u8fb9$<$\u7b2c\u4e09\u68f5\u5b50\u6811\u9ec4\u8fb9\uff0c\u90a3\u4e48\u7b2c\u4e00\u68f5\u5b50\u6811\u9ec4\u8fb9\u5219\u662f\u6700\u77ed\u7684\uff0c\u90a3\u4e48\u4e4b\u524d\u7b2c\u4e00\u68f5\u5b50\u6811\u7684\u9ec4\u8fb9\u80af\u5b9a\u4e0d\u4f1a\u9009\u5230\uff0c\u9009\u62e9\u7684\u8282\u70b9\u4f1a\u5728\u7b2c\u4e8c\u68f5\u548c\u7b2c\u4e09\u68f5\u5b50\u6811\u4e4b\u95f4\uff0c\u4ed6\u4eec\u7684\u6df1\u5ea6\u4e00\u5b9a\u5927\u4e8e\u7b2c\u4e00\u68f5\u5b50\u6811\u7684\u9ec4\u8fb9\uff0c\u6240\u4ee5\u4e0d\u6210\u7acb\uff0c\u5373\u7b2c\u4e00\u68f5\u5b50\u6811\u9ec4$>$\u8fb9\u7b2c\u4e8c\u68f5\u5b50\u6811\u7ea2\u8fb9\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u6309\u7167\u8fd9\u6837\u7684\u65b9\u5f0f\u8fdb\u884c\u9009\u62e9\uff0c\u6bcf\u6b21\u90fd\u4f1a\u5728\u6700\u5927\u7684\u5b50\u6811\u548c\u5269\u4e0b\u7684\u4e24\u4e2a\u5b50\u6811\u91cc\u4ea4\u66ff\u9009\u62e9\uff0c\u800c\u5269\u4e0b\u7684\u4e24\u4e2a\u5b50\u6811\u4e5f\u53ef\u4ee5\u4ea4\u66ff\u9009\u62e9\uff0c\u6240\u4ee5\u5269\u4f59\u4e24\u4e2a\u5b50\u6811\u7684\u548c$-$\u6700\u5927\u7684\u5b50\u6811\u5927\u5c0f\u4f1a\u4e0d\u65ad\u53d8\u5c0f($\\Delta$\u524d\u8005\u7684\u5927\u5c0f\u59cb\u7ec8\u4f1a$\\ge$$\\Delta$\u540e\u8005\u7684\u5927\u5c0f),\u6700\u7ec8\u4ed6\u4eec\u4f1a\u76f8\u7b49,\u8fd9\u65f6\u5c31\u53ef\u4ee5\u5c06\u5269\u4f59\u4e24\u4e2a\u5b50\u6811\u5408\u5e76\u8d77\u6765,\u6210\u4e3a\u5ea6\u6570\u4e3a2\u7684\u60c5\u51b5\n\n\uff08\u6709\u4e00\u5904\u7ec6\u8282\u5728\u4ee3\u7801\u91cc\uff09\n\n```cpp\n#include <vector>\n#include <algorithm>\n#include <queue>\nusing namespace std;\nint hoursRequired(int X, int Y);\nint attractionsBehind(int X, int Y);\nstd::vector<int> createFunTour(int N, int Q);\nconst int N = 1e5 + 10;\nint siz[N], dep[N];\nint b[3], tot;\nstd::vector<pair<int, int> >q[7];\nstd::vector<int>ans;\nint root;\nvoid merge()\n{\n\twhile(q[2].size())\n\t{\n\t\tq[1].push_back(q[2][q[2].size() - 1]);\n\t\tq[2].pop_back();\n\t}\n\tsort(q[1].begin(), q[1].end());\n}\n\nvoid br2()\n{\n\twhile(q[0].size() + q[1].size())\n\t{\n\t\tpair<int, int>now = q[0][q[0].size() - 1];\n\t\tq[0].pop_back();\n\t\tans.push_back(now.second);\n\t\tq[0].swap(q[1]);\n\t}\n\tans.push_back(root);\n}\n\nint C(int a, int b, int c)\n{\n\treturn a + b + c - max(a, max(b, c));\n}\nint nn;\nvoid br3()\n{\n\tif(q[0].size() == nn / 2)\n\t{\n\t\tmerge();\n\t\tif(q[0].size() < q[1].size())\n\t\tq[0].swap(q[1]);\n\t\tbr2();\n\t\treturn;\n\t}\n\tint flag = 0;\n\twhile(1)\n\t{\n\t\tint to = flag;\n\t\tfor (int i = flag + 1; i <= 2; ++ i)\n\t\t{\n\t\t\tif(q[i][q[i].size() - 1] >= q[to][q[to].size() - 1])\n\t\t\tto = i;\n\t\t}\n\t\tflag = 1;\n\t\tpair<int, int>maxs = q[to][q[to].size() - 1];\n\t\tans.push_back(q[to][q[to].size() - 1].second);\n\t\tq[0].swap(q[to]);\n\t\tq[0].pop_back();\n\t\tif(max(max(q[0].size(), q[1].size()), q[2].size()) == C(q[0].size(), q[1].size(), q[2].size()))\n\t\t{\n\t\t\tint now = 0;\n\t\t\tif(q[0].size() < q[1].size())\n\t\t\tq[0].swap(q[1]), now = 1;\n\t\t\tif(q[0].size() < q[2].size())\n\t\t\tq[0].swap(q[2]), now = (now == 0 ? 2 : now);\n\t\t\tif(now != 0)\n\t\t\t{\n\t\t\t\tif(maxs < q[((now - 1) ^ 1) + 1][q[((now - 1) ^ 1) + 1].size() - 1])\n\t\t\t\tans.push_back(q[((now - 1) ^ 1) + 1][q[((now - 1) ^ 1) + 1].size() - 1].second), q[((now - 1) ^ 1) + 1].pop_back();\n\t\t\t}\n        //\u6b64\u5904\u6ce8\u610f\uff0c\u5047\u5982\u5408\u5e76\u7684\u4e24\u4e2a\u5b50\u6811\u4e2d\u6709\u4e00\u4e2a\u662f\u6700\u8fd1\u9009\u62e9\u7684\uff0c\u53e6\u4e00\u4e2a\u5b50\u6811\u7684\u6700\u5927\u6df1\u5ea6\u5927\u4e8e\u8fd9\u4e2a\uff0c\u90a3\u4e48\u8981\u518d\u9009\u62e9\u4e00\u6b21\uff0c\u5426\u5219\u5408\u5e76\u540e\u4e0b\u4e00\u6b21\u9009\u62e9\u7684\u6df1\u5ea6\u5c31\u4e0d\u80fd\u4fdd\u8bc1\u4e0d\u589e\u4e86\n\t\t\tmerge();\n\t\t\tif(now == 0)\n\t\t\tq[0].swap(q[1]);\n\t\t\tbr2();\n\t\t\treturn;\n\t\t}\n\t}\n\tans.push_back(root);\n}\n\nstd::vector<int> createFunTour(int n, int Q)\n{\n\tnn = n;\n\tfor (int i = 0; i < n; ++ i)\n\t{\n\t\tsiz[i] = attractionsBehind(0, i);\n\t}\n\tfor (int i = 0; i < n; ++ i)\n\t{\n\t\tif(siz[i] > (n >> 1) && siz[i] < siz[root])\n\t\troot = i;\n\t}\n\tfor (int i = 0; i < n; ++ i)\n\t{\n\t\tif((dep[i] = hoursRequired(root, i)) == 1)\n\t\t{\n\t\t\tb[tot] = i;\n\t\t\t++ tot;\n\t\t}\n\t}\n\t-- tot;\n\tfor (int i = 0; i < n; ++ i)\n\t{\n\t\tif(i != root)\n\t\t{\n\t\t\tint to = 0;\n\t\t\tfor (int j = 1; j <= tot; ++ j)\n\t\t\t{\n\t\t\t\tif(hoursRequired(b[j], i) <= dep[i])\n\t\t\t\tto = j;\n\t\t\t}\n\t\t\tq[to].push_back(make_pair(dep[i], i));\n\t\t}\n\t}\n\tfor (int i = 0; i <= tot; ++ i)\n\t{\n\t\tsort(q[i].begin(), q[i].end());\n\t\tprintf(\"%d\\n\", q[i][0].second);\n\t}\n\tif(tot == 1)\n\t{\n\t\tif(q[0].size() < q[1].size())\n\t\tq[0].swap(q[1]);\n\t\tbr2();\n\t}\n\telse\n\t{\n\t\tif(q[0].size() < q[1].size())\n\t\tq[0].swap(q[1]);\n\t\tif(q[0].size() < q[2].size())\n\t\tq[0].swap(q[2]);\n\t\tbr3();\n\t}\n\treturn ans;\n}\n```\n",
        "postTime": 1605238825,
        "uid": 111728,
        "name": "\u5e7b\u5f71\u661f\u575a\u5f3a",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P6766 \u3010[APIO2020]\u6709\u8da3\u7684\u65c5\u9014\u3011"
    },
    {
        "content": "\u4e00\u4e2a\u91cd\u8981\u7684\u95ee\u9898\u662f\u600e\u4e48\u5229\u7528\u597d\u5b50\u6811\u5927\u5c0f\u8fd9\u4e2a\u4fe1\u606f\uff0c\u8fd9\u6307\u5f15\u6211\u4eec\u53bb\u60f3**\u91cd\u5fc3**\u3002\u8003\u8651\u6c42\u51fa\u91cd\u5fc3\u4f5c\u4e3a\u6839\uff0c\u5148\u7279\u5224\u6389\u5b83\u53ea\u6709\u4e00\u9897\u5b50\u6811\uff08$n=2$\uff09\u7684\u60c5\u51b5\u3002\u5982\u679c\u5b83\u6709\u4e24\u68f5\u5b50\u6811\uff0c\u8fd9\u4e24\u68f5\u5b50\u6811\u5927\u5c0f\u4e4b\u5dee\u4e00\u5b9a $\\le 1$\u3002\u90a3\u4e48\u4ece\u8f83\u5927\u7684\u4e00\u9897\u5b50\u6811\u5185\u5f00\u59cb\uff0c\u4ea4\u66ff\u9009\u53d6\u6bcf\u68f5\u5b50\u6811\u4e2d\u6700\u6df1\u7684\u7ed3\u70b9\u5373\u53ef\u3002\u5982\u679c\u5b83\u6709\u4e09\u68f5\u5b50\u6811\uff0c\u9009\u53d6\u6700\u6df1\u7684\u4e00\u4e2a\u7ed3\u70b9\u4f5c\u4e3a\u8d77\u70b9\uff0c\u6bcf\u6b21\u4ece\u5176\u5b83\u5b50\u6811\u4e2d\u9009\u53d6\u6700\u6df1\u7684\u4e00\u4e2a\u8df3\u8fc7\u53bb\uff0c\u5728\u53ea\u5269\u4e00\u9897\u5b50\u6811\u4e4b\u524d\u8fd9\u6837\u8df3\u51fa\u6765\u7684\u5e8f\u5217\u4e00\u5b9a\u5408\u6cd5\u3002\u8bc1\u660e\u8003\u8651\u4e00\u4e2a\u5f15\u7406\uff1a\u4ee4 $P_i$ \u8868\u793a $p_i$ \u6240\u5c5e\u7684\u5b50\u6811\uff0c\u5bf9\u4e8e\u4efb\u610f\u7684 $i$\uff0c\u5982\u679c $j>i$ \u4e14 $P_j\\not=P_i,P_{i-1}$ \u5219 $dep_{p_i}\\ge dep_{p_j}$\u3002\u7136\u540e\u5bf9\u6bcf\u4e2a $i$ \u770b\u770b\u5b83\u4e0b\u4e24\u6b65\u7684\u6289\u62e9 $p_i,p_{i+1},p_{i+2}$\uff0c\u53ea\u9700\u8bc1\u660e $dep_{p_i}\\ge dep_{p_{i+2}}$\u3002$i=1$ \u65f6\u663e\u7136\u3002\u5982\u679c $p_i$ \u4e0e $p_{i+2}$ \u540c\u5b50\u6811\u90a3\u4e48\u6709 $dep_{p_{i+2}}\\le dep_{p_i}$\u3002\u5982\u679c $p_i,p_{i+2}$ \u4e0d\u540c\u5b50\u6811\u4e14 $P_{i+2}\\not= P_{i-1}$ \u90a3\u4e48\u6839\u636e\u5f15\u7406\u5f97\u8bc1\u3002\u5269\u4e0b\u7684\u60c5\u51b5\u53ea\u6709 $P_{i-1}=P_{i+2}\\not= P_i$\u3002\u6b64\u65f6 $P_{i-1},P_i,P_{i+1}$ \u4e92\u4e0d\u76f8\u540c\uff0c$P_{i},P_{i+1},P_{i+2}$ \u4e5f\u4e92\u4e0d\u76f8\u540c\u3002\u90a3\u4e48\u7531\u5f15\u7406\u5f97 $dep_{p_i}\\ge dep_{p_{i+1}}$\uff0c\u540c\u7406 $dep_{p_{i+1}}\\ge dep_{p_{i+2}}$\uff0c\u547d\u9898\u5f97\u8bc1\u3002\n\n\u8fd9\u6837\u6784\u9020\u7684\u95ee\u9898\u5728\u4e8e\uff0c\u4e2d\u9014\u53ef\u80fd\u4f1a\u51fa\u73b0\u53ea\u5269\u4e0b\u4e00\u9897\u5b50\u6811\u975e\u7a7a\u7684\u60c5\u51b5\uff0c\u8fd9\u65f6\u5bf9\u4e8e\u6b63\u786e\u6027\u7684\u5206\u6790\u5c31\u5931\u6548\u4e86\uff0c\u56e0\u4e3a $P_i$ \u4e0d\u4e00\u5b9a\u4e0d\u7b49\u4e8e $P_{i+1}$\u3002\u4e0d\u8fc7\u6211\u4eec\u53ef\u4ee5\u8bc1\u660e\uff1a\u5728\u6b63\u786e\u6027\u5931\u6548\u524d\u4e00\u5b9a\u5b58\u5728\u4e00\u4e2a\u65f6\u523b\uff0c\u4f7f\u5f97\u6700\u5927\u7684\u5b50\u6811\u7684\u5927\u5c0f\u4e0e\u5176\u4f59\u5b50\u6811\u7684\u5927\u5c0f\u4e4b\u548c\u76f8\u7b49\uff0c\u6b64\u65f6\u628a\u5176\u4f59\u5b50\u6811\u89c6\u4e3a\u4e00\u68f5\u5b50\u6811\u5957\u7528\u4e24\u68f5\u5b50\u6811\u7684\u505a\u6cd5\u5373\u53ef\u3002\u8bb0 $f$ \u4e3a\u6700\u5927\u7684\u90a3\u68f5\u5b50\u6811\u7684\u5927\u5c0f\u4e0e\u5176\u4f59\u5b50\u6811\u7684\u603b\u5927\u5c0f\u4e4b\u5dee\uff08$2\\max-\\mathit{cnt}$\uff09\uff0c\u7531\u91cd\u5fc3\u7684\u6027\u8d28\u77e5\u521d\u59cb\u65f6 $f\\le 1$\u3002\u5982\u679c $f=1$ \u7684\u8bdd\u53ef\u4ee5\u76f4\u63a5\u89c6\u4e3a\u4e24\u9897\u5b50\u6811\uff0c\u7279\u5224\u6389\u3002\u73b0\u5728\u6709 $f\\le 0$\uff0c\u7136\u540e\u6bcf\u6b21\u5220\u4e00\u4e2a\u70b9\u5bf9\u4e8e $\\max$ \u7684\u5f71\u54cd\u53ea\u6709\u53ef\u80fd\u662f $0,-1$ \u4e24\u79cd\uff0c\u800c $\\mathit{cnt}$ \u7684\u53d8\u5316\u4e00\u5b9a\u662f $-1$\uff0c\u6240\u4ee5 $f$ \u7684\u53d8\u5316\u91cf\u662f $\\pm 1$\u3002\u4e0d\u5408\u6cd5\u7684\u5c40\u9762\u4e00\u5b9a\u6709 $f\\ge 1$\uff0c\u90a3\u4e48\u4e2d\u9014\u4e00\u5b9a\u5b58\u5728\u4e00\u4e2a\u65f6\u523b\u6ee1\u8db3 $f=0$\u3002\u547d\u9898\u5f97\u8bc1\u3002\n\n\u4e8e\u662f\u6211\u4eec\u6784\u9020\u51fa\u7684\u5e8f\u5217\u6700\u7ec8\u7531\u4e24\u90e8\u5206\u62fc\u63a5\u800c\u6765\uff0c\u8fd9\u4e24\u90e8\u5206\u7684\u5185\u90e8\u90fd\u6ee1\u8db3\u6761\u4ef6\uff0c\u63a5\u58e4\u5904\u7684\u5904\u7406\u6709\u8bf8\u591a\u7ec6\u8282\u3002\u4e0d\u59a8\u4ee4\u8fd9\u4e24\u90e8\u5206\u7684\u957f\u5ea6\u90fd\u5927\u4e8e\u7b49\u4e8e $2$\uff08\u5426\u5219\u63a5\u58e4\u5904\u7684\u9650\u5236\u4f1a\u66f4\u5c11\uff09\u3002\u5047\u8bbe\u7b2c\u4e00\u90e8\u5206\u7684\u540e\u4e24\u4e2a\u5143\u7d20\u4f9d\u6b21\u662f $x,y$\u3002\u7b2c\u4e8c\u90e8\u5206\u7684\u524d\u4e24\u4e2a\u5143\u7d20\u4f9d\u6b21\u662f $s,t$\u3002\u9996\u5148 $y,s$ \u4e0d\u80fd\u540c\u5c5e\u4e00\u68f5\u5b50\u6811\uff08\u6761\u4ef6\u4e00\uff09\uff0c\u5176\u6b21 $dep_{s}\\le dep_x$\uff08\u6761\u4ef6\u4e8c\uff09\uff0c$dep_t\\le dep_y$\uff08\u6761\u4ef6\u4e09\uff09\u3002\u7531\u4e8e\u7b2c\u4e8c\u90e8\u5206\u662f\u4ea4\u66ff\u9009\u6700\u6df1\u7684\u7ed3\u70b9\u6240\u4ee5 $s,t$ \u7684\u53d6\u503c\u5df2\u786e\u5b9a\uff0c\u81ea\u7531\u7684\u53ea\u6709\u987a\u5e8f\u3002\u5206\u7c7b\u8ba8\u8bba\uff08\u4e0b\u9762\u89c6 $a=b$ \u5f53\u4e14\u4ec5\u5f53 $a,b$ \u540c\u5c5e\u4e00\u68f5\u5b50\u6811\uff0c\u6ce8\u610f\u7b2c\u4e00\u90e8\u5206\u4e2d\u7684\u5f15\u7406\u8fd8\u662f\u751f\u6548\u7684\uff09\uff1a\n\n* \u5982\u679c $s,t$ \u4e2d\u6709\u4e00\u4e2a\u7b49\u4e8e $y$\u3002\u4e0d\u59a8\u8bbe $t=y$\u3002\u5219\u6761\u4ef6\u4e00\u3001\u4e09\u5747\u88ab\u6ee1\u8db3\u3002\u5bf9\u4e8e\u6761\u4ef6\u4e8c\uff0c\u5982\u679c $s=x$ \u5219\u6210\u7acb\u3002\u5426\u5219 $s\\not=x,s\\not=y\\to dep_y\\ge dep_s$\uff0c\u8003\u8651 $ x$ \u7684\u524d\u4e00\u4e2a\u5143\u7d20 $z$\uff0c\u5982\u679c\u5b83\u4e0d\u7b49\u4e8e $s$ \u90a3\u4e48 $z,x\\not= s$ \u7531\u5f15\u7406\u77e5 $dep_x\\ge dep_s$\uff1b\u5426\u5219 $z,x\\not= y\\to dep_x\\ge dep_y\\ge dep_s$\u3002\n* \u5982\u679c $s,t\\not=y$\uff0c\u90a3\u4e48 $s,t$ \u4e2d\u4e00\u5b9a\u6709\u4e14\u4ec5\u6709\u4e00\u4e2a\u5143\u7d20\u7b49\u4e8e $x$\uff0c\u4e0d\u59a8\u8bbe\u4e3a $s$\u3002\u5219\u6761\u4ef6\u4e00\u3001\u4e8c\u5747\u88ab\u6ee1\u8db3\u3002\u5bf9\u4e8e\u6761\u4ef6\u4e09\uff0c$t\\not=x,y\\to dep_y\\ge dep_t$\uff0c\u6761\u4ef6\u4e09\u6210\u7acb\u3002 \n\n\u4e0d\u8fc7\u6211\u4eec\u5230\u73b0\u5728\u597d\u50cf\u8fd8\u6ca1\u7528\u5230\u5ea6\u6570 $\\le 3$ \u7684\u9650\u5236\u554a\uff1f\u5b9e\u9645\u4e0a\u8fd9\u4e2a\u9650\u5236\u662f\u7528\u6765\u7ea6\u675f\u8be2\u95ee\u6b21\u6570\u7684\uff0c\u56e0\u4e3a\u4f60\u9700\u8981\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\u5224\u65ad\u5b83\u5c5e\u4e8e\u54ea\u9897\u5b50\u6811\uff0c\u8fd9\u9700\u8981 $(D-1)(n-1)$ \u6b21\u8be2\u95ee\uff08$D$ \u4e3a\u6839\u7684\u5b50\u6811\u6570\u91cf\uff09\uff0c\u7136\u540e\u627e\u91cd\u5fc3\u9700\u8981 $n-1$ \u6b21\u8be2\u95ee\u5b50\u6811\u5927\u5c0f\uff0c\u6c42\u6df1\u5ea6\u9700\u8981 $n-1$ \u6b21\u8be2\u95ee\u3002\u603b\u8be2\u95ee\u6b21\u6570\u770b\u8d77\u6765\u662f $2n-2+(D-1)(n-1)\\le 4n-4$\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff08\u7801\u5b57\u4e0d\u6613\uff0c\u5e0c\u671b\u80fd\u7ed9\u4e2a\u8d5eQAQ\uff09\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#include<ext/pb_ds/assoc_container.hpp>\n#include<ext/pb_ds/priority_queue.hpp>\n//#include \"fun.h\"\n#define pii pair<int,int>\n#define fi first\n#define se second\n#define pb push_back\n#define eb emplace_back\n#define mk make_pair\n#define sml(x,y) (x=min(x,y))\n#define big(x,y) (x=max(x,y))\n#define ll long long\n#define uint unsigned\n#define ull unsigned long long\n#define umap unordered_map\n#define db double\n#define fo(i,x,y) for(int i=(x);i<=(y);++i)\n#define go(i,x,y) for(int i=(x);i>=(y);--i)\n#define ptc putchar\n#define emp emplace\n#define re return\n#define co continue\n#define brk break\n#define HH (ptc('\\n'))\n#define bctz __builtin_ctz\n#define bclz __builtin_clz\n#define bppc __builtin_popcount\nusing namespace std;\nll seed=chrono::system_clock::now().time_since_epoch().count();\nmt19937 rnd(seed);\ninline int rm(int x,int y){return (int)(rnd()%(y-x+1ll)+x);}\ninline int read(){signed ch=getchar();int x=0,f=1;while(!isdigit(ch)){if(ch==(int)('-'))f=-1;ch=getchar();}while(isdigit(ch)){x=(x<<1)+(x<<3)+(ch^48);ch=getchar();}return x*f;}\ninline void out(int *a,int l,int r){fo(i,l,r) cout<<*(a+i)<<' ';puts(\"\");}\n\nint hoursRequired(int,int);\nint attractionsBehind(int,int);\n#define dis(i,j) (hoursRequired(i-1,j-1))\n#define siz(i,j) (attractionsBehind(i-1,j-1))\n#define heap __gnu_pbds::priority_queue<pii>\n\nconst int N=1e5+5,D=3;\nint dep[N],p[D],id,bel[N],mp[N],lst;\nvector<int> ans;\n\nvoid solve(heap &x,heap &y){\n\tif(x.empty()) re;\n//\tputs(\"ok\");\n\tif(ans.size()==1){\n\t\tif(bel[x.top().se]==bel[ans[0]]) swap(x,y);\n\t}else if(!ans.empty()){\n\t\tint si=(int)ans.size();\n\t\tint X=bel[ans[si-2]],Y=bel[ans[si-1]];\n\t\tif(Y==bel[x.top().se]) swap(x,y);\n\t\tif(Y!=bel[y.top().se]){\n\t\t\tif(X!=bel[x.top().se]) swap(x,y);\t\t\t\n\t\t}\n\t}\n\twhile(1){\n\t\tif(x.empty()) re;\n//\t\tint X=x.top().se;printf(\"bel[%d]=%d dep=%d\\n\",X,bel[X],dep[X]);\n\t\tans.eb(x.top().se);x.pop();\n\t\tif(y.empty()) re;\n//\t\tint Y=y.top().se;printf(\"bel[%d]=%d dep=%d\\n\",Y,bel[Y],dep[Y]);\n\t\tans.eb(y.top().se);y.pop();\n\t}\n}\n\n#define print ans.eb(rt);for(int &i:ans) i--;re ans\n\nstd::vector<int> createFunTour(int n, int vcw) {\n\tif(n==2){\n//\t\tans[0]=0,ans[1]=1;\n\t\tans.eb(0),ans.eb(1);\n\t\tre ans;\n\t}\n\tint rt=1,mn=n;\n\tfo(i,2,n){\n\t\tint si=siz(1,i);\n\t\tif(n-si<=n/2&&mn>si) mn=si,rt=i;\n\t}\n\tfo(i,1,n) if(i!=rt){\n\t\tdep[i]=dis(rt,i);\n\t\tif(dep[i]==1) p[id]=i,mp[i]=id++;\n\t}\n\theap q[D];\n\tfo(i,1,n) if(i!=rt){\n\t\tfo(j,1,id-1) if(1+dis(p[j],i)==dep[i]){bel[i]=j;brk;}\n\t\tq[bel[i]].push(mk(dep[i],i));\n\t}\n\t{\n\t\tint x=(int)q[0].size(),y=(int)q[1].size(),z=(int)q[2].size();\n//\t\tprintf(\"%d,%d,%d\\n\",x,y,z);\n\t\tif(x>=y+z){q[1].join(q[2]),solve(q[0],q[1]);print;}\n\t\tif(y>=x+z){q[0].join(q[2]),solve(q[1],q[0]);print;}\n\t\tif(z>=x+y){q[0].join(q[1]),solve(q[2],q[0]);print;}\n\t}\n\tfo(i,1,id-1) if(q[i].top().fi>q[lst].top().fi) lst=i;\n\tans.eb(q[lst].top().se);q[lst].pop();\n\twhile(1){\n\t\tif(q[0].empty()&&q[1].empty()&&q[2].empty()) brk;\n\t\tint x=(int)q[0].size(),y=(int)q[1].size(),z=(int)q[2].size();\n//\t\tprintf(\"lst=%d x=%d y=%d z=%d\\n\",lst,x,y,z);\n\t\tif(x==y+z){q[1].join(q[2]);solve(q[0],q[1]);print;}\n\t\tif(y==x+z){q[0].join(q[2]);solve(q[1],q[0]);print;}\n\t\tif(z==x+y){q[0].join(q[1]);solve(q[2],q[0]);print;}\t\t\n//\t\tfo(i,0,id-1) if()\n\t\tint pos=-1,mx=-1;\n\t\tfo(i,0,id-1) if(!q[i].empty()&&i!=lst&&q[i].top().fi>mx) mx=q[i].top().fi,pos=i;\n\t\tlst=pos;\n//\t\tprintf(\"pos=%d dep=%d\\n\",q[lst].top().se,q[lst].top().fi);\n\t\tans.eb(q[lst].top().se);q[lst].pop();\t\n\t}\n\tprint;\n}\n/*\n-------------------------------------------------\n*/\n```\n\n",
        "postTime": 1671505251,
        "uid": 238408,
        "name": "vectorwyx",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P6766 [APIO2020] \u6709\u8da3\u7684\u65c5\u9014"
    },
    {
        "content": "- \u9996\u5148\u6211\u4eec\u8003\u8651\u662f\u5426\u53ef\u4ee5\u5728$4n$\u6b21\u64cd\u4f5c\u5185\u5c06\u6811\u8fd8\u539f\u51fa\u6765,\u7136\u540e\u63a5\u4e0b\u6765\u5c31\u53ef\u4ee5\u901a\u8fc7\u7ef4\u62a4\u76f4\u5f84\u7b49\u65b9\u6cd5\u901a\u8fc7\u8fd9\u9053\u9898\n- \u4f46\u662f\u5f88\u9057\u61be,\u6211\u4e0d\u4f1a$O(n^2)$\u4ee5\u4e0b\u7684\u505a\u6cd5,\u4e5f\u8bb8\u6709$O(n\\log n)$,\u4f46\u4e5f\u65e0\u6cd5\u6ee1\u8db3$4e5$\u6b21\u7684\u8be2\u95ee\u8981\u6c42\n- \u6211\u4eec\u771f\u7684\u9700\u8981\u77e5\u9053\u8fd9\u68f5\u6811\u957f\u4ec0\u4e48\u6837\u5417$?$\n- \u8003\u8651\u5047\u8bbe\u6211\u4eec\u77e5\u9053\u8fd9\u68f5\u6811\u957f\u4ec0\u4e48\u6837,\u6211\u4eec\u53ef\u4ee5\u600e\u4e48\u505a\n- \u627e\u91cd\u5fc3,\u6ce8\u610f\u6b64\u65f6\u4e0d\u540c\u7684\u5b50\u6811$siz \\leq floor(\\frac{n}{2})$\n- \u5047\u8bbe\u5ea6\u6570\u53ea\u6709$2$,\u90a3\u4e48\u663e\u7136\u8f6e\u6d41\u9009\u4e0d\u540c\u7684\u5b50\u6811\u4e2d**\u6df1\u5ea6\u6700\u5927**\u7684\u70b9\u5c31\u53ef\u4ee5\u4e86\n- \u82e5\u5ea6\u6570\u7b49\u4e8e$3$,(\u9898\u76ee\u4fdd\u8bc1\u4efb\u610f\u70b9\u5ea6\u6570$\\leq 3$),\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u6bcf\u6b21\u9009**\u548c\u4e0a\u4e00\u4e2a\u5b50\u6811\u4e0d\u540c\u7684\u5b50\u6811\u4e2d**\u6700\u6df1\u7684\u70b9,**\u5e76\u5c06\u5176\u5220\u53bb**\u90a3\u4e48\u4e00\u5b9a\u5b58\u5728\u4e00\u4e2a\u65f6\u523b\u4f7f\u5f97\u6700\u5927\u7684\u5b50\u6811\u7b49\u4e8e\u5176\u4f59\u5b50\u6811\u7684\u548c,\u90a3\u4e48\u6309\u4e0a\u9762\u7684\u65b9\u6cd5\u8f6e\u6d41\u9009\u5373\u53ef\n- \u4e3a\u4ec0\u4e48\u8fd9\u6837\u662f\u5bf9\u7684\u5462$?$\u8003\u8651\u6211\u4eec\u8fd9\u4e2a\u6784\u9020\u65b9\u6cd5\u5982\u679c\u4e0d\u6ee1\u8db3\u9898\u76ee\u8981\u6c42\u4f1a\u662f\u4ec0\u4e48\u60c5\u51b5,\u5373\u53ea\u5269\u4e00\u4e2a\u5b50\u6811\u4e0d\u4e3a\u7a7a,**\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8bc1\u660e\u5728\u8fd9\u79cd\u60c5\u51b5\u6765\u4e34\u524d,\u4e00\u5b9a\u4f1a\u5b58\u5728\u67d0\u4e00\u65f6\u523b\u4f7f\u5f97\u6700\u5927\u7684\u5b50\u6811\u7b49\u4e8e\u5176\u4f59\u5b50\u6811\u5927\u5c0f\u7684\u548c\u5373\u53ef**\n### $proof$\n\u8003\u8651\u8bbe\u51fd\u6570$V:Tree->N,V(T) = 2 * maxsize - sum$\n\n\u6ce8\u610f\u5230\u521d\u59cb\u65f6\u7531\u91cd\u5fc3\u5b9a\u4e49,$V(T) \\leq 0$\n\n\u82e5\u53ea\u5269\u4e00\u4e2a\u5b50\u6811\u4e0d\u4e3a\u7a7a\u90a3\u4e48\u663e\u7136$V(T) > 0$\n\n\u5982\u679c\u521d\u59cb\u65f6$V(T) = 0$,\u90a3\u4e48\u7531\u4e8e\u60c5\u51b5\u6bd4\u8f83\u7279\u6b8a,\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4ece\u53d6\u6700\u5927\u5b50\u6811\u4e2d\u6700\u6df1\u7684\u70b9\u8f6c\u5316\u4e3a$V(T) = -1$\n\n\u5426\u5219,\u6ce8\u610f\u5230\u82e5\u5b58\u5728\u4e00\u4e2a\u65f6\u523b\u6700\u5927\u7684\u5b50\u6811\u7b49\u4e8e\u5176\u4f59\u5b50\u6811\u7684\u548c,\u90a3\u4e48$V(T) = -1$\n\n\u6ce8\u610f\u5230\u6309\u6211\u4eec\u4e0a\u8ff0\u7684\u65b9\u6cd5,\u6bcf\u8fdb\u884c\u4e00\u6b21\u64cd\u4f5c,$|\\Delta V(T)| \\leq 1$,\u5373\u8fd9\u4e2a\u51fd\u6570\u5728\u6574\u503c\u4e0a\u662f\u8fde\u7eed\u7684,\u6240\u4ee5\u82e5\u4ece$<0$\u53d8\u6210$>0$\u4e00\u5b9a\u4f1a\u7ecf\u8fc7$V(T) = -1$\u8fd9\u4e00\u4e2a\u70b9,\u8bc1\u660e\u5b8c\u6bd5\n- \u90a3\u4e48\u6211\u4eec\u53d1\u73b0,\u6839\u636e\u8fd9\u79cd\u65b9\u6cd5,\u6211\u4eec\u771f\u7684\u9700\u8981\u77e5\u9053\u6574\u68f5\u6811\u957f\u4ec0\u4e48\u6837\u5417$?$\n- \u6211\u4eec\u53ea\u9700\u77e5\u9053\u4ee5\u4e0b\u51e0\u70b9\n- \u6811\u7684\u91cd\u5fc3,\u5e76\u4ee5\u5b83\u4e3a\u6839----$(1)$\n- \u6bcf\u4e2a\u70b9\u7684\u6df1\u5ea6----$(2)$\n- \u6bcf\u4e2a\u70b9\u5728\u6839\u7684\u54ea\u4e2a\u5b50\u6811\u5185----$(3)$\n- \u8003\u8651\u5982\u4f55\u6784\u9020,\u6ce8\u610f\u5230\u9898\u76ee\u4e2d\u63d0\u4f9b\u7b2c\u4e8c\u79cd\u4ea4\u4e92\u64cd\u4f5c``attractionsBehind(int X, int Y)``\u53ef\u4ee5\u77e5\u9053\u4ee5$x$\u4e3a\u6839,$y$\u7684\u5b50\u6811\u7684\u5927\u5c0f,\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u4ee5$0$\u4e3a\u6839,\u5f97\u5230$\\forall i,siz(i)$,\u90a3\u4e48\u6ee1\u8db3$n - siz_i \\leq floor(\\frac{n}{2})$\u4e14$siz_i$\u6700\u5c0f\u7684$i$\u5373\u4e3a\u91cd\u5fc3,\u8fd9\u6b65\u9700\u8981\u6d88\u8017\u7684\u64cd\u4f5c\u662f$n$\n- $(2)$\u64cd\u4f5c\u662f\u663e\u7136\u7684,\u4e5f\u8981\u82b1\u8d39$n$\n- \u7136\u540e\u63a5\u4e0b\u6765\u662f$(3)$\u64cd\u4f5c,\u8fd9\u4e2a\u6bd4\u8f83\u590d\u6742,\u6211\u4eec\u8003\u8651\u6700\u5dee\u60c5\u51b5\u6709$3$\u4e2a\u513f\u5b50,$p_1,p_2,p_3$\u53ef\u4ee5\u901a\u8fc7\u8be2\u95ee$dis(p_j,i)$\u548c$dep_j$\u4f5c\u6bd4\u8f83\u6765\u5224\u65ad$i$\u662f\u5426\u5728$p_j$\u7684\u5b50\u6811\u5185,\u4f46\u5f88\u9057\u61be\u5982\u679c\u76f4\u63a5\u8fd9\u6837\u505a\u662f$3 * n$\u7684,\u548c\u524d\u9762\u52a0\u8d77\u6765\u5c31\u7b49\u4e8e$5 * n \\ge 4e5$\n- \u4f46\u662f\u5047\u8bbe\u6211\u4eec\u8bbe$siz_{p_1} = a,siz_{p_2} = b,siz_{p_3} = c$,\u6309\u987a\u5e8f\u8be2\u95ee,\u7136\u540e\u5982\u679c\u786e\u5b9a\u4e86\u5c31$break$,\u90a3\u4e48\u8be2\u95ee\u6b21\u6570\u5c31\u662f$a * 1 + b * 2 + c * 3$,\u6839\u636e\u6392\u5e8f\u4e0d\u7b49\u5f0f,\u5982\u679c\u6211\u4eec\u5c06$p_j$\u6309\u7167\u5b50\u6811\u5927\u5c0f\u964d\u5e8f\u6392\u5e8f,\u90a3\u4e48\u662f\u53cd\u5e8f\u548c\u4ee5\u8fbe\u5230\u6700\u5c0f\u503c,\u4ee5\u6700\u6781\u7aef\u7684\u60c5\u51b5\u6765\u7b97,\u662f$a = b = c = \\frac{n}{3}$,\u90a3\u4e48\u53d6\u5230\u6700\u5dee\u60c5\u51b5\u5373$\\frac{n}{3} * (1 + 2 + 3) = 2 * n$,$2 * n + n + n = 4 * n \\leq 4e5$,\u53ef\u4ee5\u5361\u7740\u8be2\u95ee\u6b21\u6570\u901a\u8fc7\u672c\u9898\n- \u6709\u4e00\u4e9b\u7ec6\u8282\u8be6\u89c1\u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint hoursRequired(int X, int Y);\nint attractionsBehind(int X, int Y);\nvector<int> createFunTour(int N, int Q);\nvector<int>ans;\nconst int _ = 1e5 + 7;\nint dep[_],siz[_];\ntypedef pair<int,int> pii;\n#define mp make_pair\n#define pb push_back\n#define fi first\n#define se second\npriority_queue<pii>s[4];\nbool cmp(int x,int y){\n\treturn siz[x] > siz[y];\n}\nint opp(int x){\n\treturn (x == 1)?2:1;\n}\nbool cmps(int x,int y){\n\treturn s[x].size() > s[y].size();\n}\nvector<int> createFunTour(int n, int q){\n\tint rt = -1;\n\tsiz[0] = n;\n\tfor(int i = 1; i < n; ++i)\t\tsiz[i] = attractionsBehind(0,i);\n\tfor(int i = 0; i < n; ++i){\n\t\tif(n - siz[i] > n / 2)\tcontinue;\n\t\tif(rt == -1 || siz[rt] > siz[i])\t\trt = i;\n\t}\n\tfor(int i = 0; i < n; ++i)\t\tdep[i] = hoursRequired(rt,i);\n\tstatic int p[4];memset(p,0,sizeof(p));\n\tint tot = 0;\n\tfor(int i = 0; i < n; ++i){\n\t\tif(dep[i] == 1)\t\tp[++tot] = i,siz[i] = attractionsBehind(rt,i);\n\t}\n\tsort(p+1,p+tot+1,cmp);\n\tfor(int i = 0; i < n; ++i){\n\t\tfor(int j = 1; j <= tot; ++j){\n\t\t\tif(hoursRequired(p[j],i) + 1 == dep[i]){\n\t\t\t\ts[j].push(mp(dep[i],i));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\t\n\t}\n\tint Last = -1;\n\tp[1] = 1,p[2] = 2,p[3] = 3;\n\tfor(int k = 1; k < n; ++k){\n\t\tsort(p+1,p+tot+1,cmps);\n\t\tif(k == 1 && s[p[1]].size() == s[p[2]].size() + s[p[3]].size() + 1){\n\t\t\tLast = p[1];\n\t\t\tans.pb(s[p[1]].top().se) ;\n\t\t\ts[p[1]].pop();\n\t\t\tcontinue;\n\t\t}\n\t\tif(s[p[1]].size() == s[p[2]].size() + s[p[3]].size() || s[p[3]].size() == 0){\n\t\t\tint lst = 1,now = 2;\n\t\t\tint T = s[p[1]].size() + s[p[2]].size() + s[p[3]].size();\n\t\t\tif(Last == -1){\n\t\t\t\tif(s[p[now]].size() < s[p[lst]].size())\tswap(now,lst);\t\t\t\t\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif(Last == p[1])\tnow = 2;\n\t\t\t\telse{\n\t\t\t\t\tif(s[p[3]].size() && s[p[2]].top().fi < s[p[3]].top().fi)\t\tswap(p[2],p[3]);\n\t\t\t\t\tif(Last == p[1])\tnow = 2;\n\t\t\t\t\telse{\n\t\t\t\t\t\tnow = 1;\n\t\t\t\t\t\tif(Last == p[3]){\n\t\t\t\t\t\t\tif(s[p[2]].size()){\n\t\t\t\t\t\t\t\tT--;\n\t\t\t\t\t\t\t\tans.pb(s[p[2]].top().se);\n\t\t\t\t\t\t\t\ts[p[2]].pop();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile(s[p[3]].size()){\n\t\t\t\tpii nxt = s[p[3]].top();\n\t\t\t\ts[p[3]].pop();\n\t\t\t\ts[p[2]].push(nxt);\n\t\t\t}\n//\t\t\tif(Last == p[2] || Last == p[3])\tnow = 1;\n//\t\t\telse if(Last == p[1])\tnow = 2;\n\t\t\twhile(T--){\n\t\t\t\tans.pb(s[p[now]].top().se);\n\t\t\t\ts[p[now]].pop();\n\t\t\t\tnow = opp(now);\n\t\t\t}\n\t\t\tbreak;\t\n\t\t}\n\t\telse{\n\t\t\tint now = -1;\n\t\t\tfor(int i = 1; i <= tot; ++i){\n\t\t\t\tif(Last == i)\tcontinue;\n\t\t\t\tif(now == -1 || s[now].top().fi < s[i].top().fi){\n\t\t\t\t\tnow = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tLast = now;\n\t\t\tans.pb(s[now].top().se);\n\t\t\ts[now].pop();\n\t\t}\n\t}\n\tans.pb(rt);\n//\tassert(ans.size() == n);\n\treturn ans;\n}\n```",
        "postTime": 1619082342,
        "uid": 248872,
        "name": "y_dove",
        "ccfLevel": 9,
        "title": "P6766 [APIO2020]\u6709\u8da3\u7684\u65c5\u9014 \u9898\u89e3"
    }
]
[
    {
        "content": "\u54b8\u9c7c\u7684blog\uff1a[http://www.neptuuz.com/wordpress/?p=237](http://www.neptuuz.com/wordpress/?p=237)\n\n\u7ecf\u5178\u7684\u73af\u5f62dp\uff0c\u679a\u4e3e\u5f00\u5934\uff0c\u5bf9\u7ed3\u5c3e\u7684\u72b6\u6001\u8981\u4e0e\u5f00\u5934\u5224\u65ad\u4e00\u4e0b\u662f\u5426\u5408\u6cd5\n\n\ndp[i][j]\u8868\u793a\u7b2ci\u4e2a\u9876\u70b9\u67d3\u989c\u8272j\u7684\u65b9\u6848\u6570\uff0c\u53ef\u4ee5\u5f97\u5230\n\ndp[i][j] = \u2211dp[i-1][k] (\u989c\u8272j\u53ef\u4ee5\u88ab\u67d3\u4e0a && i\u548ci-1\u88ab\u6539\u53d8\u8fb9\u5c5e\u6027\u65f6\uff1aj=k\uff1b\u5426\u5219j != k)\n\n\u590d\u6742\u5ea6O(nc^3)\n\n\n\u7136\u540e\u8fd9\u9898\u5751\u7684\u5730\u65b9\u662f2\u64cd\u4f5c\u5bf9\u4e8e\u540c\u4e00\u9876\u70b9\u6709\u591a\u4e2a\uff0c\u4e5f\u5c31\u662f\u8bf4\u5bf9\u4e8e\u4e00\u4e2a\u9876\u70b9\u53ef\u80fd\u4e0d\u80fd\u67d3\u591a\u79cd\u989c\u8272\uff08\u5361\u4e86\u4e24\u4e2a\u70b9\u4e0d\u7136AK\u4e86QAQ\uff09\n\n```cpp\n#include<stdio.h>\n#include<iostream>\n#include<string.h>\n#define MAXN 50010\n#define MOD 987654321\nusing namespace std;\n\nint n, m, c, uncol[MAXN][15], e[MAXN], dp[MAXN][15], ans;\n\nint main() {\n    scanf(\"%d%d%d\", &n, &m, &c);\n    for (int i = 1, opt, x, y; i <= m; ++i) {\n        scanf(\"%d%d%d\", &opt, &x, &y);\n        if (opt == 1) {\n            for (int j = 1; j <= c; ++j) {\n                if (j != y) uncol[x][j] = 1;\n            }\n        } else if (opt == 2) {\n            uncol[x][y] = 1;\n        } else {\n            if (x > y) swap(x, y);\n            e[y] = x;\n        }\n    }\n    for (int p = 1; p <= c; ++p) {\n        if (uncol[1][p]) continue;\n        memset(dp, 0, sizeof(dp));\n        dp[1][p] = 1;\n        for (int i = 2; i < n; ++i) {\n            for (int j = 1; j <= c; ++j) {\n                if (uncol[i][j]) continue;\n                if (e[i]) {\n                    dp[i][j] += dp[i-1][j];\n                    dp[i][j] %= MOD;\n                } else for (int k = 1; k <= c; ++k) {\n                    if (j == k) continue;\n                    dp[i][j] += dp[i-1][k];\n                    dp[i][j] %= MOD;\n                }\n            }\n        }\n        for (int i = 1; i <= c; ++i) {\n            if (uncol[n][i] || i == p) continue;\n            if (e[n]) {\n                dp[n][i] += dp[n-1][i];\n                dp[n][i] %= MOD;\n            } else for (int j = 1; j <= c; ++j) {\n                if (i == j) continue;\n                dp[n][i] += dp[n-1][j];\n                dp[n][i] %= MOD;\n            }\n        }\n        for (int i = 1; i <= c; ++i) {\n            ans += dp[n][i];\n            ans %= MOD;\n        }\n    }\n    printf(\"%d\\n\", ans);\n    return 0;\n}```",
        "postTime": 1514043742,
        "uid": 2008,
        "name": "AmamiyaUmi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4019 \u3010\u591a\u8fb9\u5f62\u67d3\u8272\u3011"
    },
    {
        "content": "\u8fd9\u4e2a$dp$\u975e\u5e38\u65e0\u8111\uff0c\u968f\u4fbf\u4f18\u5316\u4e00\u4e0b\u5c31\u80fd\u53d8\u6210$O(nc^2)$\n\n\u6211\u4eec\u8bbe$dp[i][j]$\u8868\u793a\u7b2c$i$\u4e2a\u4f4d\u7f6e\u67d3\u6210$j$\u7684\u65b9\u6848\u6570\n\n\u4e8e\u662f\u5982\u679c\u6ca1\u6709\u9650\u5236\u5219\u6709\n\n$$dp[i][j]=\\sum_{k=1}^{c}dp[i-1][k]*[k!=j]$$\n\n\u540e\u9762\u7684\u90a3\u4e2a\u662f\u903b\u8f91\u8868\u8fbe\u5f0f\n\n\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u76f4\u63a5\u7ef4\u62a4\u4e00\u4e2a$sum$\u8868\u793a$\\sum_{k=1}^{c}dp[i-1][k]$\uff0c\u4e8e\u662f\u6211\u4eec\u8f6c\u79fb\u7684\u65f6\u5019\u5c31\u4e0d\u7528\u518d\u53bb\u4e00\u4e2a\u4e00\u4e2a\u52a0\u4e86\uff0c\u8f6c\u79fb$dp[i][j]$\u53ef\u4ee5\u76f4\u63a5\u7528\u8fd9\u4e2a$sum$\u51cf\u53bb$dp[i-1][j]$\n\n\u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<algorithm>\n#include<vector>\n#define re register\n#define maxn 50005\n#define LL long long\n#define max(a,b) ((a)>(b)?(a):(b))\nconst LL mod=987654321;\nstd::vector<int> b[maxn];\nint f[maxn],a[maxn];\ninline int read()\n{\n\tchar c=getchar();\n\tint x=0;\n\twhile(c<'0'||c>'9') c=getchar();\n\twhile(c>='0'&&c<='9')\n\t\tx=(x<<3)+(x<<1)+c-48,c=getchar();\n\treturn x;\n}\nLL dp[maxn][11];\nLL ans=0;\nint n,m,c;\nint main()\n{\n\tn=read();c=read();m=read();\n\tint opt,x,y;\n\tfor(re int i=1;i<=c;i++)\n\t{\n\t\topt=read(),x=read(),y=read();\n\t\tif(opt==1)\n\t\t{\n\t\t\tif(a[x]&&a[x]!=y) \n\t\t\t{\n\t\t\t\tputs(\"0\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\ta[x]=y;\n\t\t}\n\t\tif(opt==2) \n\t\t{\n\t\t\tif(a[x]&&a[x]==y) \n\t\t\t{\n\t\t\t\tputs(\"0\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tb[x].push_back(y);\n\t\t}\n\t\tif(opt==3) f[max(x,y)]=1; \n\t}\n\tfor(re int T=(a[1]?a[1]:1);T<=(a[1]?a[1]:m);T++)\n\t{\n\t\tif(find(b[1].begin(),b[1].end(),T)!=b[1].end()) continue;\n\t\tmemset(dp,0,sizeof(dp));\n\t\tdp[1][T]=1;\n\t\tLL sum=1;\n\t\tfor(re int i=2;i<=n;i++)\n\t\t{\n\t\t\tif(f[i])\n\t\t\t{\n\t\t\t\tfor(re int j=1;j<=m;j++)\n\t\t\t\t\tdp[i][j]=dp[i-1][j];\n\t\t\t\tif(a[i]) \n\t\t\t\t{\n\t\t\t\t\tfor(re int j=1;j<=m;j++)\n\t\t\t\t\tif(j!=a[i]) dp[i][j]=0;\n\t\t\t\t}\n\t\t\t\tfor(re int j=0;j<b[i].size();j++)\n\t\t\t\t\tdp[i][b[i][j]]=0;\n\t\t\t\tsum=0;\n\t\t\t\tfor(re int j=1;j<=m;j++)\n\t\t\t\t\tsum=(sum+dp[i][j])%mod;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tfor(re int j=(a[i]?a[i]:1);j<=(a[i]?a[i]:m);j++)\n\t\t\t{\n\t\t\t\tif(find(b[i].begin(),b[i].end(),j)!=b[i].end()) continue;\n\t\t\t\tdp[i][j]=(dp[i][j]+sum-dp[i-1][j]+mod)%mod;\n\t\t\t}\n\t\t\tsum=0;\n\t\t\tfor(re int j=(a[i]?a[i]:1);j<=(a[i]?a[i]:m);j++)\n\t\t\t{\n\t\t\t\tif(find(b[i].begin(),b[i].end(),j)!=b[i].end()) continue;\n\t\t\t\tsum=(sum+dp[i][j])%mod;\n\t\t\t}\n\t\t}\n\t\tfor(re int j=1;j<=m;j++)\n\t\t\tif(j!=T) ans=(ans+dp[n][j])%mod;\n\t}\n\tstd::cout<<ans;\n\treturn 0;\n}\n```",
        "postTime": 1537443884,
        "uid": 35178,
        "name": "asuldb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4019 \u3010\u591a\u8fb9\u5f62\u67d3\u8272\u3011"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u9053\u5f88\u597d\u7684 dp \u9898\u3002\n\n## \u9898\u76ee\u5927\u610f\uff1a\n\n\u7ed9\u5b9a $n$ \u4e2a\u9876\u70b9\uff0c\u5448\u73af\u72b6\uff0c\u6bcf\u4e2a\u9876\u70b9\u90fd\u53ef\u4ee5\u67d3 $p$ \u79cd\u989c\u8272 \u3002\u73b0\u7ed9\u51fa\u4e00\u4e9b\u67d3\u8272\u9650\u5236\uff0c\u6c42\u67d3\u8272\u7684\u65b9\u6848\u6709\u591a\u5c11\u79cd\u3002\n\n## \u601d\u8def\uff1a\n\n\u8fd9\u9898\u770b\u4f3c\u590d\u6742\uff0c\u5176\u5b9e\u53ea\u8981\u60f3\u5230\u4e86\u5c31\u633a\u7b80\u5355\u7684\u3002\n###### ~~\u5173\u952e\u662f\u60f3\u4e0d\u5230~~\u3002\n\n\u5b9a\u4e49 $f[i][j]$ \u8868\u793a\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u67d3\u989c\u8272 $j$ \u7684\u65b9\u6848\u6570\u3002\n\n\u5982\u679c\u6ca1\u6709\u9650\u5236\u6761\u4ef6\uff0c\u90a3\u4e48 $f[i][j]$ \u5c31\u5e94\u8be5\u662f\uff1a\n\n$f[i][j]=\\sum\\limits_{k=1}^cf[i-1][k]$\n\n\u90a3\u4e48\u52a0\u4e0a\u9650\u5236\u5462\uff1f\n\n\u9996\u5148\u52a0\u4e24\u4e2a\u8f85\u52a9\u6570\u7ec4\uff0c$vis[i][j]$ \u4ee3\u8868\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u80fd\u4e0d\u80fd\u67d3\u989c\u8272 $j$\uff0c$e[i]$ \u4ee3\u8868\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u548c\u7b2c $e[i]$ \u4e2a\u4f4d\u7f6e\u7684\u989c\u8272\u5fc5\u987b\u4e00\u6837\u3002\n\n\u90a3\u4e48\u5f53\u5fc5\u987b\u548c $e[i]$ \u4e00\u6837\u65f6\uff1a\n\n$f[i][j]=f[e[i]][j]$\n\n\u4e0d\u80fd\u67d3\u989c\u8272 $j$ \u65f6\uff1a\n\n$f[i][j]+=f[i-1][k]$\n\u4e14 $k\\neq j$\n\n\u8fd9\u91cc\u8981\u6ce8\u610f\uff0c\u56e0\u4e3a\u662f\u51f8\u591a\u8fb9\u5f62\u4e0a\u7684\u70b9\uff0c\u6240\u4ee5\u662f\u4e00\u4e2a\u73af\uff0c\u6240\u4ee5\u70b9 $n$ \u9700\u8981\u7279\u6b8a\u5904\u7406\u4e00\u4e0b\uff0c\u8981\u5224\u65ad\u548c\u7b2c $1$ \u4e2a\u70b9\u7684\u989c\u8272\u76f8\u4e0d\u76f8\u540c\u3002\n\n\u90a3\u4e48\u4ee5\u4e0a\u5c31\u662f\u672c\u9898\u7684\u601d\u8def\u4e86\uff0c\u5177\u4f53\u5b9e\u73b0\u8bf7\u770b\u4ee3\u7801\u5427\uff01\n\n### \u5207\u52ff\u6284\u88ad\uff01\uff01\uff01\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint vis[50005][15],n,m,f[50005][15],e[50005],c; \n//\u672c\u4ee3\u7801vis[i][j]=1\u8868\u793ai\u4e0d\u80fd\u67d3\u989c\u8272j\uff0c\u53cd\u4e4b\u4ea6\u7136 \nint ans=0;\ninline int read() {//\u5feb\u8bfb \n\tint a=0,f=1;\n\tchar c;\n\tc=getchar();\n\twhile(c<'0'||c>'9') {\n\t\tif  (c=='-') f=-1;\n\t\tc=getchar();\n\t}\n\twhile(c>='0'&&c<='9') {\n\t\ta=a*10+(c-'0');\n\t\tc=getchar();\n\t}\n\treturn f*a;\n}\nint main() {\n//\tfreopen(\".in\",\"r\",stdin);\n//\tfreopen(\".out\",\"w\",stdout);\n\tn=read(),m=read(),c=read();\n\tint mod=987654321;//\u8fd9\u9898\u8981\u53d6\u6a21 \n\tfor (int i=1; i<=m; i++) {\n\t\tint k=read();\n\t\tint x=read(),y=read();\n\t\tif(k==1) {\n\t\t\tfor (int j=1; j<=c; j++)\n\t\t\t\tif(j!=y)vis[x][j]=1;\n\t\t\t//\u5fc5\u987b\u662f\u989c\u8272y\uff0c\u6240\u4ee5\u5176\u4ed6\u7684\u90fd\u4e0d\u884c \n\t\t}\n\t\tif(k==2)\n\t\t\tvis[x][y]=1;//\u4e0d\u80fd\u662f\u989c\u8272y \n\t\tif(k==3) {\n\t\t\tif(x>y)swap(x,y);\n\t\t\te[y]=x;//\u8fd9\u91cc\u4e3a\u4e86\u65b9\u4fbf\uff0c\u4fdd\u8bc1x<y \n\t\t}\n\t}\n\tfor (int l=1; l<=c; l++) {//\u679a\u4e3e\u7b2c\u4e00\u4e2a\u4f4d\u7f6e\u7684\u989c\u8272 \n\t\tif(vis[1][l]==1)continue;\n\t\t//\u5982\u679c\u4e0d\u884c\uff0c\u5c31\u91cd\u6765 \n\t\tmemset(f,0,sizeof(f));\n\t\tf[1][l]=1;//\u5426\u5219\u5c31\u521d\u59cb\u5316\u62101 \n\t\tfor (int i=2; i<=n; i++) { \n\t\t\tfor  (int j=1; j<=c; j++) {//\u679a\u4e3e\u7b2ci\u4e2a\u4f4d\u7f6e\u7684\u989c\u8272 \n\t\t\t\tif(vis[i][j])continue;//\u5982\u679c\u4e0d\u884c\uff0c\u5c31\u91cd\u6765 \n\t\t\t\tif(i==n&&(vis[i][j]||j==l))continue;\n\t\t\t\t//i==n\uff0c\u7279\u5224j\u548cl\u7684\u5173\u7cfb \n\t\t\t\tif (e[i]) {//\u5982\u679c\u5fc5\u987b\u67d3e[i] \n\t\t\t\t\tf[i][j]=f[e[i]][j];\n\t\t\t\t\tf[i][j]%=mod;\n\t\t\t\t} else for (int k=1; k<=c; k++) { //\u679a\u4e3e\u7b2ci-1\u4e2a\u4f4d\u7f6e\u7684\u989c\u8272 \n\t\t\t\t\t\tif (j==k) continue;//i\u4e0d\u80fd\u67d3\u548c\u7b2ci-1\u4e2a\u4e00\u6837\u7684\u989c\u8272 \n\t\t\t\t\t\tf[i][j]+=f[i-1][k];\n\t\t\t\t\t\tf[i][j]%=mod;\n\t\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (int i=1;i<=c;i++)\n\t\t\tans=(ans+f[n][i])%mod;//\u7edf\u8ba1 \n\t}\n\tprintf(\"%d\\n\",ans);//\u6700\u540e\u8f93\u51fa \n\treturn 0;\n}\n\n\n```\n## \u603b\u7ed3\uff1a\n\n\u8fd9\u9053\u9898\u7684\u601d\u8def\u4e0d\u597d\u60f3\uff0c\u672c\u849f\u84bb\u4e5f\u662f\u770b\u4e86\u5927\u4f6c\u7684\u9898\u89e3\u624d\u61c2\u7684\u2026\u2026\u4f46\u5927\u4f6c\u7684\u9898\u89e3\u5f88\u96be\u61c2 \uff0c\u6240\u4ee5\u672c\u849f\u84bb\u5199\u4e86\u4e00\u7bc7\u66f4\u5bb9\u6613\u61c2\u7684\u9898\u89e3\uff0c\u5e0c\u671b\u53ef\u4ee5\u770b\u61c2\uff01",
        "postTime": 1679325973,
        "uid": 557270,
        "name": "2021sunzishan",
        "ccfLevel": 3,
        "title": "P4019 \u9898\u89e3"
    },
    {
        "content": "\u4e00\u9053 dp \u9898\u3002\n\n\u5047\u8bbe $f_{i,j}$ \u8868\u793a\u7b2c $i$ \u4e2a\u70b9\u67d3\u7b2c $j$ \u79cd\u989c\u8272\u7684\u65b9\u6848\u6570\uff0c$col_{i,j}$ \u8868\u793a\u7b2c $i$ \u4e2a\u70b9\u80fd\u5426\u4f7f\u7528\u989c\u8272 $j$\u3002\n\n\u5982\u679c\u8981\u6c42 $i,i+1$ \u989c\u8272\u76f8\u540c\uff0c\u5f97\u5230\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$f_{i,j}=f_{i-1,j}\\times col_{i,j}$$\n\n\u5982\u679c\u8981\u6c42\u4e0d\u76f8\u540c\uff0c\u5f97\u5230\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$f_{i,j}=(sum-f_{i-1,j})\\times col_{i,j}$$\n\n\u8fd9\u91cc\uff0c$sum=\\sum_{k=1}^cf_{i-1,k}$\u3002\n\n\u5f97\u5230\u8fd9\u4e9b\uff0c\u6211\u4eec\u8fd8\u8981\u8003\u8651\u7b2c $n$ \u70b9\u548c\u7b2c $1$ \u70b9\u4e4b\u95f4\u4e0d\u80fd\u76f8\u540c\u3002\u4e8e\u662f\u6211\u4eec\u5f00\u4e00\u4e2a\u989d\u5916\u70b9 $n+1$\u3002$col_{n+1,i}=col_{1,i}$\u3002\u679a\u4e3e\u7b2c\u4e00\u4e2a\u70b9\u7684\u989c\u8272\uff0c\u6bcf\u6b21\u7b54\u6848\u589e\u52a0 $f_{n+1,col}$ \u5373\u53ef\u3002\n\nTip. \u6ce8\u610f\u7279\u5224\u65e0\u89e3\u3002\n\n\u4ee3\u7801\n```cpp\n#include<iostream>\nusing namespace std;\n#define ll long long\nconst int MAXN=5e4+5;\nconst int MR=11;\nconst int MOD=987654321;\nint n,m,c;//block,CaoZuo Times,color. \nll f[MAXN][MR];//f[i][j] When i 's block,j color's FangAn.\nbool used[MAXN][MR];\nbool same[MAXN];//Is same from i-1 and i.\nvoid dp(){\n\tfor(int i=2;i<=n+1;i++)\n\t\tif(same[i]){\n\t\t\tfor(int j=1;j<=c;j++)\n\t\t\t\tif(used[i][j])\n\t\t\t\tf[i][j]=f[i-1][j];\n\t\t}\n\t\telse{\n\t\t\tll sum=0;\n\t\t\tfor(int j=1;j<=c;j++)\n\t\t\t\tsum=(sum+f[i-1][j])%MOD;\n\t\t\tfor(int j=1;j<=c;j++)\n\t\t\t\tif(used[i][j])\n\t\t\t\t\tf[i][j]=(sum-f[i-1][j]+MOD)%MOD;\n\t\t}\n\treturn;\n}\nint work(){\n\tll ans=0;\n\tfor(int i=1;i<=c;i++)\n\t\tif(used[1][i]){\n\t\t\t//cout<<\"OK\";\n\t\t\tfor(int j=1;j<=n;j++)\n\t\t\t\tfor(int k=1;k<=c;k++)\n\t\t\t\t\tf[j][k]=0;\n\t\t\tf[1][i]=1;\n\t\t\tdp();\n\t\t\tans=(ans+f[n+1][i])%MOD;\n\t\t}\n\treturn ans;\n}\nint main(){\n\tcin>>n>>m>>c;\n\tfor(int i=1;i<=n+1;i++)\n\t\tfor(int j=1;j<=c;j++)\n\t\t\tused[i][j]=true;\n\tfor(int i=1;i<=m;i++){\n\t\tint opt,x,y;\n\t\tcin>>opt>>x>>y;\n\t\tif(opt==1){\n\t\t\tif(used[x][y]==false){\n\t\t\t\tcout<<\"0\";\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tfor(int j=1;j<=c;j++)\n\t\t\t\tused[x][j]=false;\n\t\t\tused[x][y]=true;\n\t\t}\n\t\tif(opt==2)\n\t\t\tused[x][y]=false;\n\t\tif(opt==3)\n\t\t\tsame[max(x,y)]=true;\n\t}\n\tcout<<work();\n\treturn 0;\n}\n```\n",
        "postTime": 1636644187,
        "uid": 248400,
        "name": "Inaba_Meguru",
        "ccfLevel": 7,
        "title": "P4019 \u591a\u8fb9\u5f62\u67d3\u8272"
    },
    {
        "content": "\u8d5b\u524d\u4e00\u53d1\u9898\u89e3\uff0cCSP2021 RP++\uff01\n\n## \u5206\u6790\n\n\u5341\u5206~~\u677f\u5b50~~\u5178\u578b\u7684\u66b4\u529bdp\uff0c\u8981\u6ce8\u610f\u73af\u3001\u4e09\u79cd\u9650\u5236\u7684\u5904\u7406\u3002\n\n1. \u5904\u7406\u73af\uff1a\u8bbe\u8ba1\u72b6\u6001\u65f6\uff0c\u7528 $f_{i,c,c_1}$ \u8868\u793a\u524d $i$ \u4e2a\u70b9\uff0c$i$ \u53f7\u70b9\u989c\u8272\u4e3a $c$\uff0c$1$ \u53f7\u70b9\u989c\u8272\u4e3a $c_1$ \u7684\u65b9\u6848\u6570\uff0c\u6700\u7ec8\u7edf\u8ba1 $\\sum_{c_n \\neq c_1}f_{n,c_n,c_1}$ \u5373\u4e3a\u7b54\u6848\u3002\n\n2. \u9650\u5236\uff1a\u8bfb\u5165\u65f6\u8bb0\u5f55\uff0c\u6ce8\u610f1\u30012\u578b\u9650\u5236\u53ef\u80fd\u4e92\u76f8\u77db\u76fe\u3002\u8f6c\u79fb\u65f6\u6839\u636e\u70b9\u7684\u9650\u5236\u8ba8\u8bba\uff0c\u5177\u4f53\u5730\uff1a\n- \u82e5\u786e\u5b9a\u67d0\u70b9\u989c\u8272\u4e3a $c_i$\uff0c\u5219\u53ea\u9700\u679a\u4e3e\u4e0a\u4e00\u4e2a\u70b9\u7684\u989c\u8272\uff0c$f_{i,c_i,c_1} = \\sum_{c'\\neq c_i}f_{i-1,c',c1}$\u3002\n- \u82e5\u786e\u5b9a\u67d0\u70b9\u4e0e\u4e0a\u4e00\u4e2a\u70b9\u540c\u8272\uff0c\u4f53\u73b0\u5728\u8f6c\u79fb\u4e0a\u5c31\u662f $f_{i,c_i,c_1}=f_{i-1,c_i,c_1}$\u3002\n- \u81f3\u4e8e\u7b2c\u4e8c\u79cd\u9650\u5236\uff0c\u679a\u4e3e\u989c\u8272\u65f6\u5224\u65ad\u4e00\u4e0b\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\times c^3)$\uff0c\u6309\u7167\u7b2c\u4e8c\u7bc7\u9898\u89e3\u4e2d\u7684\u505a\u6cd5\u52a0\u4e2a\u524d\u7f00\u548c\u4f18\u5316\u53ef\u4ee5\u505a\u5230 $O(n\\times c^2)$\uff0c\u5f53\u7136\u90fd\u80fd\u8fc7\u5c31\u662f\u4e86\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <vector>\n\nusing namespace std;\n\nconst int MAXN = 50005;\nconst int P = 987654321;\nint n, m, c, f[MAXN][11][11], st[MAXN];\nbool sm[MAXN], ust[MAXN][11];\n\nint main() {\n\tscanf(\"%d %d %d\", &n, &m, &c);\n\tint op, x, y;\n\tfor (int i = 1; i <= m; i++) {\n\t\tscanf(\"%d %d %d\", &op, &x, &y);\n\t\tif (op==1) {\n\t\t\tif (ust[x][y] || (st[x]!=0&&st[x]!=y)) {\n\t\t\t\tprintf(\"0\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tst[x] = y;\n\t\t}\n\t\telse if (op==2) {\n\t\t\tust[x][y] = 1;\n\t\t\tif (st[x] == y) {\n\t\t\t\tprintf(\"0\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (x > y) swap(x, y);\n\t\t\tsm[y] = 1;\n\t\t}\n\t}\n\tfor (int i = 1; i <= c; i++) f[1][i][i] = 1;\n\tfor (int i = 2; i <= n; i++) {\n\t\tif (st[i]) {\n\t\t\tif (sm[i]) {\n\t\t\t\tfor (int c1 = 1; c1 <= c; c1++)\n\t\t\t\t\tf[i][st[i]][c1] = f[i-1][st[i]][c1];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (int c1 = 1; c1 <= c; c1++)\n\t\t\t\t\tfor (int _c = 1; _c <= c; _c++)\n\t\t\t\t\t\tif (st[i] != _c)\n\t\t\t\t\t\t\tf[i][st[i]][c1] = (f[i][st[i]][c1]+f[i-1][_c][c1])%P;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (sm[i]) {\n\t\t\t\tfor (int c1 = 1; c1 <= c; c1++)\n\t\t\t\t\tfor (int _c = 1; _c <= c; _c++)\n\t\t\t\t\t\tif (!ust[i][_c])\n\t\t\t\t\t\t\tf[i][_c][c1] = f[i-1][_c][c1];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (int ci = 1; ci <= c; ci++)\n\t\t\t\t\tfor (int c1 = 1; c1 <= c; c1++)\n\t\t\t\t\t\tfor (int _c = 1; _c <= c; _c++)\n\t\t\t\t\t\t\tif (!ust[i][ci] && ci != _c)\n\t\t\t\t\t\t\t\tf[i][ci][c1] = (f[i][ci][c1]+f[i-1][_c][c1])%P;\n\t\t\t}\n\t\t}\n\t}\n\tint ans = 0;\n\tfor (int i = 1; i <= c; i++)\n\t\tfor (int j = 1; j <= c; j++)\n\t\t\tif (i != j)\n\t\t\t\tans = (ans+f[n][i][j])%P;\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1634812331,
        "uid": 189044,
        "name": "Celebrimbor",
        "ccfLevel": 7,
        "title": "P4019 \u9898\u89e3"
    }
]
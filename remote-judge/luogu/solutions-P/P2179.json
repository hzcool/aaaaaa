[
    {
        "content": "\uff08\u672c\u9898\u89e3\u540c\u6b65\u53d1\u5e03\u4e8e http://www.cnblogs.com/RabbitHu/p/9019762.html, \u6b22\u8fce\u4ea4\u6d41\uff09\n\n\u697c\u4e0a\u8fd9\u5806\u9898\u89e3\u90fd\u592a\u96be\u4e86\uff01\u4f5c\u4e3a\u4e00\u4e2a\u6570\u5b66\u4e0d\u53ca\u683c\u9009\u624b\uff01\u6211\u6765\u63d0\u4f9b\u4e00\u4e2a\u80fd\u770b\u7684\u9898\u89e3\uff01\n\n\u9884\u5907\u77e5\u8bc6\u53ea\u6709\u9ad8\u4e2d\u6570\u5b66\u7684\u3010\u5bfc\u6570\u3011\u3002\u4e0d\u7528\u4ec0\u4e48\u504f\u5bfc\u6570/\u62c9\u683c\u6717\u65e5\u4e58\u5b50\u6cd5\u4e4b\u7c7b\u7684\u6211\u770b\u4e0d\u61c2\u7684\u4e1c\u897f( \u2022\u0300\u2200\u2022\u0301 )\uff01\n\n\u5982\u679c\u4f60\u4e0d\u77e5\u9053\u4ec0\u4e48\u662f\u5bfc\u6570\uff0c\u53ef\u4ee5\u627e\u672c\u9ad8\u4e2d\u6570\u5b66\u9009\u4fee2-2\u6765\u770b\u4e00\u4e0b\uff01\u770b\u7b2c\u4e00\u7ae0\u7b2c1\u30012\u8282\u5c31\u597d\u5566\u3002\u4f20\u9001\u95e8\uff1a[\u9009\u4fee2-2](http://jfpdf.yousi.com/160424030303585634.pdf)\n\n---\n\n\u611f\u6027\u7406\u89e3\u4e00\u4e0b\u8fd9\u9053\u9898\uff1a\n\n\u4e00\u5f00\u59cb\uff0c\u6211\u4eec\u53ef\u4ee5\u7ed9\u6240\u6709\u8def\u6bb5\u968f\u4fbf\u5206\u914d\u4e00\u4e2a\u901f\u5ea6\u3002\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u9700\u8981\u5728\u4e00\u4e9b\u8def\u6bb5\u4e0a**\u8017\u8d39\u4e00\u5b9a\u80fd\u91cf**\u7528\u6765\u63d0\u901f\uff0c\u4ee5\u6b64**\u7f29\u77ed\u4e00\u5b9a\u65f6\u95f4**\u3002\u4e0d\u540c\u8def\u6bb5\u4e0a\uff0c\u82b1\u8d39\u5355\u4f4d\u80fd\u91cf\u80fd\u7f29\u77ed\u7684\u65f6\u95f4\uff08\u7b80\u79f0\u201c**\u6027\u4ef7\u6bd4**\u201d\uff09\u662f\u4e0d\u540c\u7684\uff0c\u6240\u4ee5\u5982\u679c\u6211\u4eec\u8981\u6a21\u62df\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u4e00\u5b9a\u662f\u6bcf\u65f6\u6bcf\u523b\u90fd\u5728**\u5f53\u524d\u6027\u4ef7\u6bd4\u6700\u9ad8**\u7684\u8def\u6bb5\u4e0a\u82b1\u8d39\u80fd\u91cf\uff0c\u76f4\u5230\u80fd\u91cf\u82b1\u5b8c\u4e3a\u6b62\u3002\uff08\u4f3c\u4e4e\u2026\u2026\u4e5f\u53ef\u4ee5\u82b1\u8d39\u8d1f\u7684\u80fd\u91cf\uff0c\u589e\u52a0\u67d0\u8def\u6bb5\u6240\u9700\u65f6\u95f4\uff0c\u7136\u540e\u628a\u80fd\u91cf\u7528\u5230\u522b\u7684\u5730\u65b9\u53bb\u3002\uff09\n\n\u6ce8\u610f\u5230\u4e00\u4e2a\u6027\u8d28\uff1a\u968f\u7740\u82b1\u8d39\u80fd\u91cf\u589e\u52a0\uff0c\u6027\u4ef7\u6bd4\u4f1a\u8d8a\u6765\u8d8a\u4f4e\u3002\n\n\u8fd9\u6837\u7684\u8bdd\uff0c\u53ea\u8981\u6309\u7167\u4e0a\u9762\u8fd9\u79cd\u8d2a\u5fc3\u7b56\u7565\uff0c\u65f6\u65f6\u523b\u523b\u5728\u6027\u4ef7\u6bd4\u6700\u9ad8\u7684\u8def\u6bb5\u82b1\u8d39\u80fd\u91cf\uff08\u5e76\u4f7f\u5b83\u7684\u6027\u4ef7\u6bd4\u964d\u4f4e\uff09\uff0c\u6700\u540e\u8fbe\u5230\u6700\u4f18\u89e3\u65f6\uff0c**\u5404\u8def\u6bb5\u6027\u4ef7\u6bd4\u4f1a\u4e00\u6837**\u3002\n\n\u66b4\u529b\u6a21\u62df\u4f3c\u4e4e\u662f\u5199\u4e0d\u51fa\u6765\u7684\uff0c\u8003\u8651\u66f4\u6b63\u5e38\u7684\u505a\u6cd5\u3002\n\n\u8fd9\u4e2a\u6027\u4ef7\u6bd4\u662f\u4ec0\u4e48\u5462\uff1f\u5982\u679c\u6211\u4eec\u5bf9\u6bcf\u6bb5\u8def\u753b\u51fa\u4e00\u4e2a$t-E$\u51fd\u6570\u56fe\u8c61\uff0c\u8868\u793a\u8be5\u8def\u6bb5**\u9700\u8981\u7684\u65f6\u95f4$t$**\u4e0e**\u82b1\u8d39\u7684\u80fd\u91cf$E$**\u7684\u51fd\u6570\u5173\u7cfb\uff0c\u90a3\u4e48\u82b1\u8d39\u4e00\u5b9a\u80fd\u91cf$e$\u4e4b\u540e\u7684\u201c\u6027\u4ef7\u6bd4\u201d\u662f\u4ec0\u4e48\u5462\uff1f\u5c31\u662f\u51fd\u6570\u56fe\u50cf\u4e0a\u6a2a\u5750\u6807\u4e3a$e$\u5904\u5207\u7ebf\u7684\u659c\u7387\u2014\u2014\u5bfc\u6570\u3002\n\n\u90a3\u4e48\u6700\u4f18\u89e3\u5c31\u6ee1\u8db3\u2014\u2014**\u5404\u8def\u6bb5\u5bfc\u6570\u4e00\u6837\uff01**\n\n\u540c\u65f6\uff0c\u8fd9\u4e2a\u516c\u5171\u5bfc\u6570\uff08\u662f\u8d1f\u7684\uff09\u7edd\u5bf9\u503c\u8d8a\u5c0f\uff08\u6027\u4ef7\u6bd4\u8d8a\u4f4e\uff09\uff0c\u6240\u9700\u80fd\u91cf\u8d8a\u591a\uff0c\u603b\u65f6\u95f4\u8d8a\u5c0f\u3002\n\n\u4e8e\u662f\u4e8c\u5206\u8fd9\u4e2a\u5bfc\u6570\uff0c\u6c42\u51fa\u6bcf\u6bb5\u901f\u5ea6\uff0c\u4ee5\u6b64\u6c42\u51fa\u6240\u9700\u80fd\u91cf\uff0c\u548c\u624b\u91cc\u7684\u603b\u80fd\u91cf\u6bd4\u8f83\u4e00\u4e0b\uff0c\u5c31\u53ef\u4ee5\u4e8c\u5206\u5f97\u5230\u7b54\u6848\u4e86\uff01\n\n---\n\n\u4ee5\u4e0a\u662f\u601d\u8def\u3002\u73b0\u5728\u5f00\u59cb\u6570\u5b66\u3002\n\n\u8981\u6c42\u51fa\u6bcf\u6bb5\u5bfc\u6570\u5173\u4e8e$v$\u7684\u5173\u7cfb\u3002\n\n\u5bf9\u4e8e\u4e00\u6bb5\u8def\u6765\u8bf4\uff08\u65b9\u4fbf\u8d77\u89c1\uff0c\u628a$k$\u4e58\u4e0a$s$\u4f5c\u4e3a\u65b0\u7684$k$\uff0c\u5c31\u53ef\u4ee5\u5c11\u5199\u4e00\u4e2a\u5b57\u6bcd\u4e862333\uff09\uff1a\n\n$$E = k(v - v')^2$$\n$$t = \\frac{s}{v}$$\n\n\u90a3\u4e48\n\n$\\frac{dt}{dE}$\n\n$=\\frac{dt}{dv} / \\frac{dE}{dv} $\n\n$= -\\frac{s}{v^2} / 2k(v - v')$\n\n$= -\\frac{s}{2kv^2(v-v')}$\n\n\u7136\u540e\u4e8c\u5206\u516c\u5171\u5bfc\u6570$x$\uff0c\u5bf9\u4e8e\u6bcf\u6bb5\u8def\u89e3\u65b9\u7a0b$-\\frac{s}{2kv^2(v-v')} = x$\uff08\u53ef\u4e8c\u5206\uff09\u5f97\u5230$v$\uff0c\u8fdb\u800c\u6c42\u51fa\u9700\u8981\u7684\u80fd\u91cf\u3002\n\n---\n\n\u4ee3\u7801\uff1a\n\n```cpp\n// luogu-judger-enable-o2\n#include <cstdio>\n#include <cstring>\n#include <cmath>\n#include <algorithm>\n#include <iostream>\n#define enter putchar('\\n')\n#define space putchar(' ')\nusing namespace std;\ntypedef long long ll;\ntemplate <class T>\nvoid read(T &x){\n    char c;\n    bool op = 0;\n    while(c = getchar(), c < '0' || c > '9')\n        if(c == '-') op = 1;\n    x = c - '0';\n    while(c = getchar(), c >= '0' && c <= '9')\n        x = x * 10 + c - '0';\n    if(op == 1) x = -x;\n}\ntemplate <class T>\nvoid write(T x){\n    if(x < 0) putchar('-'), x = -x;\n    if(x >= 10) write(x / 10);\n    putchar('0' + x % 10);\n}\n\nconst int N = 10005, INF = 0x3f3f3f3f;\nint n;\ndouble E, s[N], k[N], u[N];\n\ndouble getv(double x, int i){\n    double l = max(u[i], double(0)), r = 100005, mid;\n    int cnt = 60;\n    while(cnt--){\n        mid = (l + r) / 2;\n        if(2 * k[i] * x * mid * mid * (mid - u[i]) > -s[i]) l = mid;\n        else r = mid;\n    }\n    mid = (l + r) / 2;\n    return (l + r) / 2;\n}\ndouble calc(double x){\n    double sum = 0;\n    for(int i = 1; i <= n; i++){\n        double v = getv(x, i);\n        sum += k[i] * (v - u[i]) * (v - u[i]);\n    }\n    return sum;\n}\n\nint main(){\n\n    scanf(\"%d%lf\", &n, &E);\n    for(int i = 1; i <= n; i++)\n        scanf(\"%lf%lf%lf\", &s[i], &k[i], &u[i]), k[i] *= s[i];\n    double l = -INF, r = 0, mid;\n    int cnt = 100;\n    while(cnt--){\n        mid = (l + r) / 2;\n        if(calc(mid) <= E) l = mid;\n        else r = mid;\n    }\n    mid = (l + r) / 2;\n    double ans = 0;\n    for(int i = 1; i <= n; i++)\n        ans += s[i] / getv(mid, i);\n    printf(\"%.10lf\\n\", ans);\n\n    return 0;\n}\n```",
        "postTime": 1525936275,
        "uid": 8947,
        "name": "RabbitHu",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P2179 \u3010[NOI2012]\u9a91\u884c\u5ddd\u85cf\u3011"
    },
    {
        "content": "### \u9898\u610f\n\n\u7ed9\u5b9a $n$ \u4e2a\u8def\u6bb5\uff0c\u6bcf\u4e2a\u8def\u6bb5\u7528\u4e09\u4e2a\u5b9e\u6570 $s_i,k_i,v^\\prime_i$ \u63cf\u8ff0\uff0c\u6700\u5c0f\u5316\n\n$$F(v_1,\\cdots v_n)=\\sum\\limits_{i=1}^{n}\\frac{s_i}{v_i}$$\n\n\u5176\u4e2d $v_1,\\cdots v_n$ \u5747\u4e3a\u975e\u8d1f\u5b9e\u6570\u800c\u4e14\u9700\u8981\u6ee1\u8db3\n\n$$\\varphi(v_1,\\cdots,v_n)=\\sum\\limits_{i=0}^{n}k_i(v_i-v^{\\prime}_i)^2s_i-E_U=0$$\n\n$\\texttt{Data Range:}1\\leq n\\leq 1000$\n\n### \u9898\u89e3\n\n[\u4e0d\u4e00\u5b9a\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/Karry5307/p/13860407.html)\n\n\u62c9\u683c\u6717\u65e5\u4e58\u5b50\u6cd5\u3002\n\n\u6211\u4eec\u6765\u5f62\u8c61\u7684\u8bb2\u4e00\u4e0b\u8fd9\u4e2a\u4e1c\u897f\u5230\u5e95\u662f\u4ec0\u4e48\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u4e00\u4e9b\u5173\u4e8e\u591a\u5143\u51fd\u6570\u5fae\u79ef\u5206\u7684\u77e5\u8bc6\u3002\n\n\u5047\u8bbe\u6211\u4eec\u73b0\u5728\u6709\u4e00\u4e2a\u4e8c\u5143\u51fd\u6570 $F(x,y)=x^2+y^2$\uff0c\u9700\u8981\u6c42\u8fd9\u4e2a\u4e1c\u897f\u7684\u6700\u5c0f\u503c\u3002\n\n\u5982\u679c\u6ca1\u6709\u9650\u5236\u7684\u8bdd\uff0c\u6700\u5c0f\u503c\u5c31\u662f $0$\u3002\u4f46\u662f\u6211\u5982\u679c\u9700\u8981\u8ba9 $x,y$ \u6ee1\u8db3 $x^2y=3$ \u7684\u8bdd\u5462\uff1f\n\n\u4e00\u4e2a\u5f88\u663e\u7136\u7684\u60f3\u6cd5\u5c31\u662f\u53bb\u9010\u4e00\u679a\u4e3e\u4e00\u4e2a\u6700\u5c0f\u503c $r$\uff0c\u7136\u540e\u770b\u8fd9\u4e2a $r$ \u6ee1\u4e0d\u6ee1\u8db3\u6761\u4ef6\u3002\u4e8e\u662f\u6211\u4eec\u53ea\u9700\u8981\u770b\u770b $x^2y=3$ \u548c $x^2+y^2=r$ \u662f\u5426\u76f8\u4ea4\u3002\n\n\u6ce8\u610f\u5230\u540e\u8005\u7684\u56fe\u50cf\u662f\u4e00\u4e2a\u5706\uff0c\u4ece\u5c0f\u5230\u5927\u679a\u4e3e $r$ \u7684\u8fc7\u7a0b\u53ef\u4ee5\u770b\u505a\u662f\u5706\u7684\u534a\u5f84\u9010\u6e10\u6269\u5927\u3002\u5982\u679c\u6269\u5927\u5230\u67d0\u4e2a $r$ \u521a\u597d\u4e0e $x^2y=3$ \u76f8\u4ea4\u4e86\u7684\u8bdd\u5c31\u53ef\u4ee5\u53d6\u8fd9\u4e2a $r$ \u4f5c\u4e3a\u6700\u5c0f\u503c\u3002\n\n\u8fd9\u91cc\u6709\u4e00\u4e2a [demo](https://www.desmos.com/calculator/2usqo7bbqu)\uff0c\u62d6\u52a8 $r_0$ \u7684\u6ed1\u52a8\u6761\u76f8\u5f53\u4e8e\u662f\u5706\u7684\u534a\u5f84\u9010\u6e10\u6269\u5927\u3002\u6ce8\u610f\u5230\u968f\u7740\u534a\u5f84\u7684\u6269\u5927\uff0c\u5706\u4e0e\u66f2\u7ebf\u7684\u4f4d\u7f6e\u5173\u7cfb\u662f\u5148\u76f8\u79bb\u518d\u76f8\u5207\u6700\u540e\u76f8\u4ea4\u3002\u6240\u4ee5\u8bf4\uff0c**\u5728\u6781\u503c\u70b9\uff0c\u5706\u4e0e\u66f2\u7ebf\u76f8\u5207**\u3002\n\n\u6ce8\u610f\u5230\u8fd9\u4e9b\u5706\u662f\u53ef\u4ee5\u770b\u505a $F(x,y)=x^2+y^2$ \u7684\u7b49\u9ad8\u7ebf\u7684\u3002\u6ce8\u610f\u5230 $\\nabla F$\uff08\u4e5f\u5c31\u662f\u68af\u5ea6\uff09\u662f\u7b49\u9ad8\u7ebf\u7684\u6cd5\u7ebf\u3002\u540c\u65f6 \u53e6\u4e00\u4e2a\u51fd\u6570 $G(x,y)=x^2y$ \u7684\u68af\u5ea6\u5411\u91cf $\\nabla G$ \u4e5f\u4f1a\u5782\u76f4\u4e8e $x^2y=3$ \u8fd9\u6761\u7b49\u9ad8\u7ebf\u3002\n\n\u56e0\u4e3a\u68af\u5ea6\u5411\u91cf\u662f\u7b49\u9ad8\u7ebf\u7684\u6cd5\u7ebf\uff0c\u6240\u4ee5**\u68af\u5ea6\u4e0e\u7b49\u9ad8\u7ebf\u7684\u5207\u7ebf\u5782\u76f4**\u3002\u7ed3\u5408\u4e24\u4e2a\u52a0\u7c97\u7684\u6761\u4ef6\u6211\u4eec\u53ef\u4ee5\u77e5\u9053**\u5728\u76f8\u5207\u70b9\uff0c\u5706\u7684\u68af\u5ea6\u5411\u91cf\u548c\u66f2\u7ebf\u7684\u68af\u5ea6\u5411\u91cf\u5e73\u884c**\u3002\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u5217\u65b9\u7a0b\u4e86\uff1a\n\n$$\\nabla F=\\lambda\\nabla G$$\n\n\u4e5f\u5c31\u662f\u8bf4\n\n$$\\begin{cases}\\frac{\\partial F}{\\partial x}=\\lambda\\frac{\\partial G}{\\partial x}\\\\\\frac{\\partial F}{\\partial y}=\\lambda\\frac{\\partial G}{\\partial y}\\\\x^2y=3\\end{cases}$$\n\n\u89e3\u51fa\u6765\u5373\u53ef\u3002\n\n\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u6784\u9020\u7ea6\u675f\u51fd\u6570 $\\varphi(x,y)=x^2y-3$\u3002\u7531\u4e8e $3$ \u662f\u5e38\u6570\u5728\u5bf9\u4efb\u4f55\u4e00\u4e2a\u53d8\u91cf\u6c42\u504f\u5bfc\u6570\u7684\u65f6\u5019\u90fd\u4f1a\u6d88\u53bb\u6240\u4ee5\u4e0d\u4f1a\u5bf9\u4e0a\u9762\u4e24\u4e2a\u65b9\u7a0b\u4ea7\u751f\u5f71\u54cd\u3002\n\n\u7531\u4e8e\u504f\u5bfc\u6570\u7684\u53ef\u52a0\u6027\uff0c\u6211\u4eec\u589e\u52a0\u4e00\u4e2a\u65b0\u7684\u53d8\u91cf $\\lambda$ \u5e76\u4e14\u5c06\u539f\u6765\u7684\u51fd\u6570\u5199\u6210\u8fd9\u6837\uff1a\uff08\u4e5f\u5c31\u662f\u5c06\u7b49\u5f0f\u7684\u53f3\u8fb9\u79fb\u5230\u4e86\u5de6\u8fb9\uff09\n\n$$F(x,y,\\lambda)=F(x,y)+\\lambda\\varphi(x,y)$$\n\n\u8fd9\u4e2a\u65f6\u5019\u5f88\u5bb9\u6613\u770b\u51fa\u5bf9 $F(x,y,\\lambda)$ \u6c42\u4e09\u4e2a\u504f\u5bfc\u6570\u5f97\u5230\u7684\u65b9\u7a0b\u4e0e\u4e0a\u9762\u7684\u65b9\u7a0b\u7ec4\u662f\u4e00\u6837\u7684\u3002\n\n\u5bf9\u4e8e\u8fd9\u4e2a\u9898\u76ee\u6765\u8bf4\uff0c\u6784\u9020\u51fd\u6570\n\n$$F(v_1,\\cdots,v_n,\\lambda)=F(v_1,\\cdots,v_n)+\\lambda\\varphi(v_1,\\cdots,v_n)=\\sum\\limits_{i=1}^{n}\\frac{s_i}{v_i}+\\lambda\\left(\\sum\\limits_{i=0}^{n}k_i(v_i-v^{\\prime}_i)^2s_i-E_U\\right)$$\n\n\u6839\u636e\u5bf9\u79f0\u6027\u6211\u4eec\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u6c42\u51fa\u8fd9\u4e2a\u4e1c\u897f\u5bf9 $v_i$ \u548c $\\lambda$ \u7684\u504f\u5bfc\u6570\uff1a\n\n$$\\frac{\\partial F}{\\partial v_i}=2\\lambda k_i(v_i-v^\\prime_i)s_i-\\frac{s_i}{v_i^2}$$\n\n$$\\frac{\\partial F}{\\partial \\lambda}=\\sum\\limits_{i=0}^{n}k_i(v_i-v^\\prime_i)^2s_i-E_U$$\n\n\u6309\u7167\u4e0a\u9762\u8bb2\u7684\u4e1c\u897f\uff0c\u8fd9\u4e9b\u504f\u5bfc\u6570\u90fd\u5e94\u8be5\u7b49\u4e8e $0$ \u7684\uff0c\u6240\u4ee5\u5f97\u5230\u4e24\u4e2a\u65b9\u7a0b\uff1a\n\n$$2\\lambda k_iv_i^2(v_i-v^\\prime_i)=1$$\n\n$$\\sum k_i(v_i-v^{\\prime})^2s_i=E_U$$\n\n\u5c06\u7b2c\u4e00\u4e2a\u65b9\u7a0b\u79fb\u9879\u5f97\u5230\n\n$$v_i^2(v_i-v^\\prime_i)=\\frac{1}{2\\lambda k_i}$$\n\n\u5de6\u8fb9\u90a3\u4e2a\u4e1c\u897f\u5f53 $v_i\\in [0,+\\infty)$ \u7684\u65f6\u5019\u901a\u8fc7\u5bf9\u5bfc\u6570\u8fdb\u884c\u5206\u6790\u53ef\u4ee5\u770b\u51fa\u662f\u5355\u8c03\u9012\u589e\u7684\u3002\n\n\u5f53 $\\lambda$ \u56fa\u5b9a\u7684\u65f6\u5019\uff0c$v_i\\uparrow$ \u5219\u7b49\u5f0f\u5de6\u8fb9 $\\uparrow$\u3002\u5f53 $\\lambda\\uparrow$ \u65f6\uff0c\u56e0\u4e3a\u7b49\u5f0f\u53f3\u8fb9 $\\downarrow$\uff0c\u6240\u4ee5 $v_i\\downarrow$\u3002\u56e0\u4e3a $v_i>v^\\prime_i$\uff0c\u6240\u4ee5\u7b2c\u4e8c\u4e2a\u7b49\u5f0f\u7684\u5de6\u8fb9\u6574\u4f53\u662f $\\downarrow$ \u7684\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4e8c\u5206 $\\lambda$\uff0c\u7136\u540e\u4e8c\u5206\u89e3\u51fa $v_i$ \u5229\u7528\u7b2c\u4e8c\u4e2a\u7b49\u5f0f\u518d check \u5373\u53ef\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef int ll;\ntypedef long long int li;\ntypedef long double db;\nconst ll MAXN=2e5+51;\nconst db eps=1e-12;\nll n;\ndb eu,l,r,mid,res;\ndb s[MAXN],kk[MAXN],v[MAXN],vl[MAXN];\ninline ll read()\n{\n    register ll num=0,neg=1;\n    register char ch=getchar();\n    while(!isdigit(ch)&&ch!='-')\n    {\n        ch=getchar();\n    }\n    if(ch=='-')\n    {\n    \tneg=-1;\n    \tch=getchar();\n\t}\n    while(isdigit(ch))\n    {\n        num=(num<<3)+(num<<1)+(ch-'0');\n        ch=getchar();\n    }\n    return num*neg;\n}\n#define sqr(x) (x)*(x)\ninline db calcDeriv(db lambda,db vel,ll x)\n{\n\treturn 2.0*lambda*kk[x]*sqr(vel)*(vel-v[x]);\n}\ninline ll check(db lambda)\n{\n\tdb e=0,l,r,mid;\n\tfor(register int i=1;i<=n;i++)\n\t{\n\t\tl=max(v[i],0.0L),r=100000;\n\t\twhile(l+eps<=r)\n\t\t{\n\t\t\tmid=(l+r)/2.0;\n\t\t\tcalcDeriv(lambda,mid,i)<=1?l=mid:r=mid;\n\t\t}\n\t\tvl[i]=l,e+=kk[i]*sqr(vl[i]-v[i])*s[i];\n\t}\n\treturn e<=eu;\n}\nint main()\n{\n\tn=read(),scanf(\"%Lf\",&eu),l=0,r=100000;\n\tfor(register int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%Lf%Lf%Lf\",&s[i],&kk[i],&v[i]);\n\t}\n\twhile(l+eps<=r)\n\t{\n\t\tmid=(l+r)/2.0;\n\t\tcheck(mid)?r=mid:l=mid;\n\t}\n\tfor(register int i=1;i<=n;i++)\n\t{\n\t\tres+=s[i]/vl[i];\n\t}\n\tprintf(\"%.9Lf\\n\",res);\n}\n```",
        "postTime": 1603336885,
        "uid": 60990,
        "name": "Karry5307",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2179 \u3010[NOI2012]\u9a91\u884c\u5ddd\u85cf\u3011"
    },
    {
        "content": "\u9898\u610f\u4e3a\u5728\u6ee1\u8db3$\\sum\\limits_{i=1}^nk_i(v_i-v_i^\\prime)^2s_i\\leqslant E_U$\u7684\u6761\u4ef6\u4e0b\u6700\u5c0f\u5316$\\sum\\limits_{i=1}^n\\frac{s_i}{v_i}$\n\n\u5148\u8003\u8651\u8d2a\u5fc3\uff0c\u56e0\u4e3a\u6700\u5c0f\u5316$\\sum\\limits_{i=1}^n\\frac{s_i}{v_i}$\uff0c\u6240\u4ee5$\\sum\\limits_{i=1}^nk_i(v_i-v_i^\\prime)^2s_i=E_U$\u65f6\u4e3a\u6700\u4f18\u60c5\u51b5\u3002\n\n\u53d1\u73b0\u662f\u4e00\u4e2a\u6709\u7ea6\u675f\u7684\u6781\u503c\u95ee\u9898\uff0c\u8003\u8651\u7528\u62c9\u683c\u6717\u65e5\u4e58\u6570\u6cd5\u6765\u89e3\u51b3\u3002\n\n\u8bbe$f(v)=\\sum\\limits_{i=1}^n\\frac{s_i}{v_i}$\uff0c$\u03c6(v)=\\sum\\limits_{i=1}^nk_i(v_i-v_i^\\prime)^2s_i-E_U$\n\n\u8bbe\u62c9\u683c\u6717\u65e5\u51fd\u6570\u4e3a$L(v,\u03bb)=f(v)+\u03bb\u03c6(v)$\n\n\u4ee3\u5165\u5f97$L(v,\u03bb)=\\sum\\limits_{i=1}^n\\frac{s_i}{v_i}+\u03bb[\\sum\\limits_{i=1}^nk_i(v_i-v_i^\\prime)^2s_i-E_U]$\n\n\u6839\u636e\u62c9\u683c\u6717\u65e5\u4e58\u6570\u6cd5\u5f97\uff0c\u5f53\u62c9\u683c\u6717\u65e5\u51fd\u6570$L$\u68af\u5ea6\u4e3a$0$\u65f6\uff0c$f(v)$\u6700\u4f18\n\n$$\\begin{cases}\\nabla_{v_1}L(v,\u03bb)=0\\\\\\nabla_{v_2}L(v,\u03bb)=0\\\\......\\\\\\nabla_{v_n}L(v,\u03bb)=0\\\\\\nabla_\u03bbL(v,\u03bb)=0\\end{cases}$$\n\n\u6c42\u504f\u5bfc\u540e\u53ef\u5f97\uff08\u8fd9\u91cc\u5c06\u6709\u5173$v$\u7684\u5199\u6210\u4e00\u4e2a\u5f0f\u5b50\u4e86\uff09\n\n$$\\begin{cases}\\nabla_vL(v,\u03bb)=2\u03bbk_i(v_i-v_i^\\prime)s_i-\\frac{s_i}{v_i^2}=0\\\\\\nabla_\u03bbL(v,\u03bb)=\\sum\\limits_{i=1}^nk_i(v_i-v_i^\\prime)^2s_i-E_U=0\\end{cases}$$\n\n\u8fdb\u4e00\u6b65\u5316\u7b80\u540e\u5f97\n\n$$\\begin{cases}2\u03bbk_iv_i^2(v_i-v_i^\\prime)=1\\ (1)\\\\\\sum\\limits_{i=1}^nk_i(v_i-v_i^\\prime)^2s_i=E_U\\ (2)\\end{cases}$$\n\n\u90a3\u4e48\u5c06\u4e0a\u9762\u7684\u65b9\u7a0b\u7ec4\u89e3\u51fa\u6765\uff0c\u5373\u4e3a\u6211\u4eec\u8981\u6c42\u7684\u7b54\u6848\u3002\n\n\u8003\u8651\u5230\u5728$(1)$\u5f0f\u4e2d$v_i$\u5fc5\u987b\u5927\u4e8e\u7b49\u4e8e$v_i^\\prime$\uff0c\u6240\u4ee5\u4e3a\u4fdd\u8bc1\u5f0f\u5b50\u6210\u7acb$\u03bb$\u5fc5\u987b\u5927\u4e8e$0$\uff0c\u540c\u65f6\u53d1\u73b0$(1)$\u5f0f\u5de6\u8fb9\u5173\u4e8e$v_i$\u5355\u8c03\u9012\u589e\uff0c\u6240\u4ee5\u6211\u4eec\u4e8c\u5206\u6c42\u51fa\u6bcf\u4e00\u4e2a$v_i$\uff0c\u518d\u4ee3\u5165$(1)$\u5f0f\u6765\u68c0\u9a8c\u3002\n\n\u4f46\u53d1\u73b0$\u03bb$\u7684\u503c\u4e5f\u4e0d\u786e\u5b9a\uff0c\u4e8e\u662f\u8981\u5728\u4e8c\u5206$v_i$\u7684\u5916\u5c42\u518d\u5957\u4e0a\u4e00\u5c42$\u03bb$\u7684\u4e8c\u5206\uff0c\u8fd9\u91cc\u4ee3\u5165$(2)$\u5f0f\u6765\u68c0\u9a8c\u3002\n\n\u5b9e\u73b0\u7ec6\u8282\u770b\u4ee3\u7801\u5427\u3002\n\n$code:$\n\n```cpp\n#include<bits/stdc++.h>\n#define maxn 10010\n#define eps 1e-12\nusing namespace std;\ntemplate<typename T> inline void read(T &x)\n{\n\tx=0;char c=getchar();bool flag=false;\n\twhile(!isdigit(c)){if(c=='-')flag=true;c=getchar();}\n\twhile(isdigit(c)){x=(x<<1)+(x<<3)+(c^48);c=getchar();}\n\tif(flag)x=-x;\n}\nint n;\ndouble E,ans;\ndouble s[maxn],k[maxn],v[maxn],u[maxn];\ndouble calc(double x)\n{\n    return x*x;\n}\nbool judge(double p,double v,double k,double u)\n{\n    return 2*p*k*calc(v)*(v-u)<=1;\n}\nbool check(double p)\n{\n    double e=0;\n    for(int i=1;i<=n;++i)\n    {\n        double l=max(u[i],(double)0),r=1e5,ans;\n        while(l+eps<=r)\n        {\n            double mid=(l+r)/2.0;\n            if(judge(p,mid,k[i],u[i])) ans=l=mid;\n            else r=mid;\n        }\n        v[i]=ans;\n        e+=k[i]*calc(v[i]-u[i])*s[i];\n    }\n    return e<=E;\n}\nint main()\n{\n\tread(n);\n    scanf(\"%lf\",&E);\n    for(int i=1;i<=n;++i)\n        scanf(\"%lf%lf%lf\",&s[i],&k[i],&u[i]);\n    double l=0,r=1e5;\n    while(l+eps<=r)\n    {\n        double mid=(l+r)/2.0;\n        if(check(mid)) r=mid;\n        else l=mid;\n    }\n    for(int i=1;i<=n;++i) ans+=s[i]/v[i];\n    printf(\"%.8lf\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1579674153,
        "uid": 172489,
        "name": "lhm_",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2179 \u3010[NOI2012]\u9a91\u884c\u5ddd\u85cf\u3011"
    },
    {
        "content": "\u9898\u89e3\u5168\u662f\u62c9\u683c\u6717\u65e5\u4e58\u6570\u6cd5......\u641e\u4e0d\u5012\u641e\u4e0d\u5012\uff0c\u6211\u4eec\u6765\u7b80\u5355\u7c97\u66b4\u4e00\u70b9\u7684\u3002  \n\n# \u6a21\u62df\u9000\u706b\uff01  \n\n\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u8f6c\u5316\u4e3a\u80fd\u91cf\u7684\u5206\u914d\u95ee\u9898\u3002\u4e00\u5171\u6709E\u7684\u80fd\u91cf\uff0c\u6211\u4eec\u8981\u7ed9\u6bcf\u6761\u8def\u5206\u914d\u82e5\u5e72\u80fd\u91cf\uff0c\u4f7f\u5f97\u5b83\u4eec\u5408\u8d77\u6765\u7684\u603b\u65f6\u95f4\u6700\u77ed\u3002\n\n\u5982\u679c\u98ce\u901f\u4e3a\u8d1f\u7684\u8bdd\uff0c\u60f3\u8981\u524d\u8fdb\u5c31\u5fc5\u987b\u8981\u6709\u4e00\u4e2a\u80fd\u91cf\u4e0b\u9650\u3002\u6211\u4eec\u628a\u8fd9\u4e9b\u80fd\u91cf\u63d0\u51fa\u6765\uff0c\u5269\u4e0b\u7684\u5c31\u662f\u53ef\u81ea\u7531\u5206\u914d\u7684\u80fd\u91cf\u4e86\u3002\n\n\u5148\u7ed9\u6bcf\u6761\u8def\u5e73\u5747\u5206\u914d\u81ea\u7531\u80fd\u91cf\uff0c\u4f5c\u4e3a\u521d\u59cb\u89e3\u3002\u7136\u540e\u6bcf\u6b21\u901a\u8fc7\u8fd9\u6837\u7684\u65b9\u5f0f\u4ea7\u751f\u51fa\u4e00\u4e2a\u65b0\u89e3\uff1a\n\n+ \u968f\u673a\u5f97\u5230\u4e24\u6761\u8defa\u548cb\u3002\n+ \u968f\u673a\u4e00\u4e2a\u5728(0 , a\u76ee\u524d\u81ea\u7531\u80fd\u91cf)\u4e4b\u95f4\u7684\u80fd\u91cf\u503c\uff0c\u628a\u8fd9\u4e9b\u80fd\u91cf\u7ed9b\n\n\u8fd9\u91cc\u6211\u4eec\u968f\u673a\u51fa\u6765\u7684\u80fd\u91cf\u503c\u8981\u968f\u7740\u6e29\u5ea6\u964d\u4f4e\u800c\u964d\u4f4e\uff0c\u4e8e\u662f\u6211\u91c7\u7528\u4e86\u8fd9\u4e2a\u516c\u5f0f\uff1a\n\n$ deltaE = min(nowE_{a},c * nowT) * Rand(0,1) $\n\nnowT\u662f\u6307\u5f53\u524d\u6e29\u5ea6\uff0cnowE\u662f\u76ee\u524d\u81ea\u7531\u80fd\u91cf\uff0cRand(0,1)\u662f\u4e00\u4e2a0~1\u4e4b\u95f4\u7684\u968f\u673a\u5b9e\u6570\uff0cc\u662f\u4e00\u4e2a\u81ea\u5df1\u51b3\u5b9a\u7684\u53c2\u6570\u3002\n\n\u7136\u540e\u7ecf\u8fc7\u4e00\u6ce2\u7384\u5b66\u8c03\u53c2\uff0c\u75af\u72c2\u5c1d\u8bd5\uff0c\u7ec8\u4e8e\u627e\u5230\u4e86\u4e00\u7ec4\u7cbe\u5ea6\u8f83\u9ad8\u7684\u53c2\u6570\uff0c\u8fc7\u6389\u4e86\u6b64\u9898......\n\n\u4ee3\u7801\uff1a\n```cpp\n// luogu-judger-enable-o2\n#include <bits/stdc++.h>\n\nconst int N = 10010, INF = 0x3f3f3f3f;\n\ndouble k[N], s[N], vv[N], E;\nint n;\n\nnamespace n1 {\n    inline void solve() {\n        double v = vv[1] + sqrt(E / s[1] / k[1]);\n        printf(\"%.10f\\n\", s[1] / v);\n        return;\n    }\n}\n\nnamespace n2 {\n\n    inline double cal(double v) {\n        double ans = s[1] / v;\n        double delta = k[1] * s[1] * (vv[1] - v) * (vv[1] - v);\n        double v2 = vv[2] + sqrt((E - delta) / s[2] / k[2]);\n        if(v2 < 0) return 1e14;\n        return ans + s[2] / v2;\n    }\n\n    inline void solve() {\n\n        double l = 0, r = vv[1] + sqrt(E / s[1] / k[1]);\n        for(int i = 1; i <= 100; i++) {\n            double mid = (l + r) / 2;\n            //printf(\"l = %.10f r = %.10f \\n\", l, r);\n            double ml = mid - (r - l) / 6, mr = mid + (r - l) / 6;\n            double vl = cal(ml), vr = cal(mr);\n            if(vl > vr) {\n                l = ml;\u3000\u3000\n            }\n            else {\n                r = mr;\u3000\n            }\n        }\n        printf(\"%.10f\\n\",\u3000cal(r));\n        return;\n    }\n}\n\nnamespace Fire {\n    const double eps = 1e-13;\n    double T = 1, dT = 0.999992;\n    double nowE[N], temp[N], lm[N];\n    int test[N];\u3000\n\n    inline int rd(int\u3000l, int\u3000r) {\n        return rand() % (r - l + 1) + l;\n    }\n\n    inline double Rand() {\n        return 1.0 * rand() / RAND_MAX;\n    }\n\n    inline double calv(int i, double e) {\n        return vv[i] + sqrt(e / k[i] / s[i]);\n    }\n\u3000\n    inline double calt(int i, double e) {\n        return s[i] / (vv[i] + sqrt(e / k[i] / s[i]));\n    }\n\u3000\n    inline double init() {\n        for(int\u3000i = 1; i <= n; i++) {\n            if(vv[i] < -eps) {\n                lm[i] = k[i] * s[i] * vv[i] * vv[i];\n                E -= lm[i];\n            }\n        }\n        double dt = E / n, ans = 0;\n        for(int i = 1; i <= n; i++) {\n            nowE[i] = dt;\n            ans += calt(i, lm[i] + nowE[i]);\n        }\n        return ans;\n    }\n\n    inline void solve() {\n        double ans, fin = 1e14;\n        srand(69);\n        for(int A = 1; A <= 1; A++) {\n            ans = init();\n            fin = std::min(ans, fin);\n            while(T > eps) {\n                /// Random a new solution\n                int a = rd(1, n), b = rd(1, n);\n                while(a == b) {\n                    a = rd(1, n), b = rd(1, n);\n                }\n                double deltaE = std::min((long double)nowE[a], (long double)T * 1e8) * Rand();\u3000\n                temp[a] = nowE[a] - deltaE;\n                temp[b] = nowE[b] + deltaE;\n\n                double New = ans - calt(a, lm[a] + nowE[a]) - calt(b, lm[b] + nowE[b])\n                                 + calt(a, lm[a] + temp[a]) + calt(b, lm[b] + temp[b]);\n\n                fin = std::min(fin, New);\n                if(New < ans || Rand() < exp((ans - New) / T)) {\n                    ans = New;\n                    nowE[a] = temp[a];\n                    nowE[b] = temp[b];\n                }\n                T = T * dT;\n            }\n        }\n        printf(\"%.10f\\n\", fin);\n        return;\n    }\n}\n\nint main() {\n\u3000\n    scanf(\"%d%lf\",\u3000&n,\u3000&E);\n    for(int i = 1; i <= n; i++) {\n        scanf(\"%lf%lf%lf\", &s[i], &k[i], &vv[i]);\n    }\n\n    if(n == 1) {\n        n1::solve();\n        return 0;\n    }\n\n    if(n == 2) {\n        n2::solve();\n        return 0;\n    }\n\n    Fire::solve();\n    return\u30000;\n}\n\n```\n",
        "postTime": 1556978683,
        "uid": 55600,
        "name": "huyufeifei",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P2179 \u3010[NOI2012]\u9a91\u884c\u5ddd\u85cf\u3011"
    },
    {
        "content": "## 0x01 \u5206\u6790\u9898\u76ee\n\n\u505a\u9898\u9996\u5148\u8981\u6392\u9664\u6587\u4e2d\u7684\u5197\u4f59\u4fe1\u606f\uff0c\u7528\u6700\u77ed\u7684\u8bed\u8a00\u63cf\u8ff0\u4e00\u9053\u9898\u3002\n\n\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u9605\u8bfb\u540e\u5f97\u5230\u8fd9\u6837\u7684\u4e09\u6761\u4fe1\u606f\uff1a\n\n> $E_i = k_i(v_i-v_i^{'})^2s_i$\n\n> $\\sum_{i=1}^{n}E_i \\leq E$\n\n> \u8981\u6c42 $t$ \u5c3d\u53ef\u80fd\u5c0f\u3002\n\n## 0x02 \u505a\u6cd5\u7684\u63a8\u5bfc\n\n\u521d\u6b65\u5206\u6790\u5b8c\u540e\uff0c\u6211\u4eec\u5c31\u8981\u7740\u624b\u4ece\u521d\u59cb\u6761\u4ef6\u5f00\u59cb\u63a8\u7b54\u6848\u3002\n\n\u5728\u4e24\u6761\u521d\u59cb\u4fe1\u606f\u4e2d\uff0c\u4fe1\u606f 3 \u662f\u548c\u7b54\u6848\u6709\u5173\u7684,\u4fe1\u606f 1\u30012 \u662f\u7ea6\u675f\u6761\u4ef6\uff0c\u6240\u4ee5\u6211\u4eec\u7684\u601d\u8def\u81ea\u7136\u8f6c\u79fb\u5230\u5982\u4f55\u5c06\u7ea6\u675f\u6761\u4ef6\u4e0e\u7b54\u6848\u5173\u8054\u5230\u4e00\u8d77\u3002\n\n\u4f7f\u7528~~\u8111\u5b50~~\u601d\u8003\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7ed3\u8bba\uff1a\n\n> \u6bcf\u6bb5\u8def\u4e0a\u6d88\u8017\u7684\u80fd\u91cf\uff08\u505a\u7684\u529f\uff09$E_i$ \u8d8a\u5927\uff0c\u6d88\u8017\u7684\u65f6\u95f4 $t_i$ \u8d8a\u5c0f\u3002\n\n\u4e0a\u9762\u8fd9\u53e5\u8bdd\u6362\u79cd\u65b9\u5f0f\u8868\u8fbe\uff0c\u5c31\u6709\u4e86\uff1a\n\n> \u6211\u4eec\u53ef\u4ee5\u5728\u67d0\u6bb5\u8def\u4e0a\u589e\u52a0\u80fd\u91cf\u4ee5\u7f29\u77ed\u65f6\u95f4\u3002\uff08\u63a8\u8bba 1\uff09\n\n\u6709\u4e86\u63a8\u8bba 1\uff0c\u6211\u4eec\u5c31\u5c06\u7ea6\u675f\u6761\u4ef6\u4e0e\u7b54\u6848\u5173\u8054\u5230\u4e00\u8d77\u4e86\u3002\n\n\u4f46\u53c8\u7531\u63a8\u8bba 1 \u5f15\u51fa\u4e86\u4e00\u4e2a\u65b0\u7684\u95ee\u9898\uff1a**\u5728\u54ea\u6761\u8def\u4e0a\u589e\u52a0\u80fd\u91cf\u5462\uff1f**\n\n\u7531\u4e8e\u589e\u52a0\u67d0\u6761\u8def\u7684\u80fd\u91cf\u4e0d\u4f1a\u5e72\u6270\u5230\u53e6\u4e00\u6761\u8def\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8d2a\u5fc3\u7684\u60f3\uff1a\n\n> \u628a\u80fd\u91cf\u52a0\u5230\u4ef7\u503c\uff08\u6216\u8bf4\u6027\u4ef7\u6bd4\uff09\u6700\u9ad8\u7684\u8def\u4e0a\u53bb\u3002\n\n\u90a3\u5bf9\u4e8e\u4e00\u6761\u8def\u6765\u8bf4\uff0c\u6b64\u523b\u589e\u52a0\u80fd\u91cf\u7684\u4ef7\u503c\u53c8\u5982\u4f55\u4f53\u73b0\u5462\uff1f\n\n\u663e\u7136\u662f\u589e\u52a0\u7684\u65f6\u95f4\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5f88\u5bb9\u6613\u60f3\u5230\uff1a\u82e5\u65f6\u95f4\u662f\u5173\u4e8e\u80fd\u91cf\u7684\u51fd\u6570\uff0c\u90a3\u4e48\u51fd\u6570\u5728 $E_i$ \u5904\u7684\u5207\u7ebf\u7684\u659c\u7387\uff0c\u4e5f\u5c31\u662f\u5bfc\u6570\uff0c\u5c31\u662f\u5728\u6b64\u6761\u8def\u589e\u52a0\u80fd\u91cf\u7684\u4ef7\u503c\uff08\u6027\u4ef7\u6bd4\uff09\u3002\n\n\u63a8\u8bba 1 \u544a\u8bc9\u6211\u4eec\uff1a$t$ \u968f $E$ \u7684\u589e\u5927\u800c\u51cf\u5c0f\u3002\n\n\u7531\u6b64\u53ef\u4ee5\u77e5\u9053\uff1a\u4ef7\u503c\uff08\u6216\u6027\u4ef7\u6bd4\uff09\u53ea\u4f1a\u8d8a\u6765\u8d8a\u5c0f\u3002\n\n\u6211\u4eec\u603b\u4f1a\u5c06\u80fd\u91cf\u52a0\u5230\u6027\u4ef7\u6bd4\u5927\u7684\u8def\u6bb5\u4e0a\u53bb\uff0c\u4e0d\u65ad\u5982\u6b64\u64cd\u4f5c\uff0c\u6211\u4eec\u53ef\u4ee5\u60f3\u8c61\u6700\u540e\u6240\u6709\u8def\u7684\u4ef7\u503c\uff08\u6216\u6027\u4ef7\u6bd4\uff09\u4f1a\u662f\u4e00\u4e2a\u76f8\u540c\u503c\uff01\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5f00\u59cb\u63a8\u5f0f\u5b50\u4e86\uff01\n\n$$\n\\frac{dt}{dE} = x\n$$\n\n$x$ \u4e3a\u6700\u540e\u7684\u516c\u5171\u5bfc\u6570\u3002\n\n\u56e0\u4e3a $E_i = k_i(v_i-v_i^{'})^2s_i$\uff0c\u4e14 $t$ \u4e5f\u53ef\u4ee5\u8868\u8fbe\u4e3a\u5173\u4e8e $v$ \u7684\u51fd\u6570 $t=\\frac{s}{v}$\u3002\n\n\u6240\u4ee5\uff1a\n\n$$\n\\frac{dt}{dE} = \\frac{dt}{dv}\\frac{dv}{dE} = \\frac{dt}{dv} / \\frac{dE}{dv} = x\n$$\n\n$$\n\\frac{dt}{dv} = -\\frac{s}{v^2} , \\frac{dE}{dv} = 2ks(v-v^{'})\n$$\n\n\u6240\u4ee5\uff1a\n\n$$\n-\\frac{s}{2ksv^2(v-v^{'})} = x\n$$\n\n\u5982\u679c\u6211\u4eec\u77e5\u9053\u4e86\u516c\u5171\u5bfc\u6570 $x$\uff0c\u5c31\u53ef\u4ee5\u89e3\u51fa\u6bcf\u6bb5\u8def\u7684 $v$ \u503c\uff08\u61d2\u5f97\u89e3\u65b9\u7a0b\uff1f\u76f4\u63a5\u4e8c\u5206 $v$ \u4e0d\u5c31\u884c\u4e86\uff09\u3002\n\n\u77e5\u9053\u4e86\u6bcf\u6bb5\u7684 $v$ \u503c\uff0c\u5c31\u53ef\u4ee5\u68c0\u9a8c\u5f53\u524d\u7684 $x$ \u662f\u5426\u53ef\u884c\u3002\n\n\u4e8e\u662f\uff0c$x$ \u4e5f\u53ef\u4ee5\u4e8c\u5206\u4e86\u3002\n\n\u6700\u540e\u770b\u770b\u4ee3\u7801\uff0c\u5c31\u5f88\u5bb9\u6613\u660e\u767d\u4e86\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint n;\ndouble s[10005], k[10005], u[10005];\ndouble e;\ndouble solve(double x, int i) { //\u516c\u5171\u5bfc\u6570x\u4e0e\u5f53\u524d\u8def\u6bb5i\n\tdouble l = 0, r = 100005, v;//\u9898\u76ee\u4fdd\u8bc1v<=100005\n\tint batch = 60;//\u6d6e\u70b9\u6570\u4e8c\u5206\u7684\u6279\u6b21\n\twhile(batch--) {\n\t\tv = (l + r) / 2;\n\t\tif(2 * k[i] * s[i] * x * v * v * (v - u[i]) > -s[i]) l = v;//\u521a\u63a8\u5bfc\u51fa\u6765\u7684\u5f0f\u5b50\u7a0d\u52a0\u53d8\u5f62\n\t\telse r = v;\n\t}\n\tv = (l + r) / 2;//\u6700\u540e\u5f97\u5230\u7ed3\u679c\n\treturn v;\n}\ndouble work(double x) {//\u4e8c\u5206\u51fa\u7684\u516c\u5171\u5bfc\u6570\u5f97\u5230\u7684\u80fd\u91cf\u603b\u503c\n\tdouble sum = 0;\n\tfor(int i = 1; i <= n; i++) {\n\t\tdouble v = solve(x, i);\n\t\tsum += k[i] * s[i] * (v - u[i]) * (v - u[i]);\n\t}\n\treturn sum;\n}\nsigned main() {\n\tcin>>n>>e;\n\tfor(int i = 1; i <= n; i++) {\n\t\tcin>>s[i]>>k[i]>>u[i];\n\t}\n\tdouble l = -0x3f3f3f, r = 0, dc;//\u6ce8\u610f\uff1a\u51fd\u6570t\u5448\u4e0b\u964d\u8d8b\u52bf\uff0c\u5bfc\u6570\u663e\u7136\u4e3a\u8d1f\n\tint batch = 100;\n\twhile(batch--) \n\t{\n\t\tdc = (l + r) / 2;\n\t\tif(work(dc) <= e) l = dc;\n\t\telse r = dc;\n\t}\n\tdc = (l + r) / 2;\n\tdouble ans = 0;\n\tfor(int i = 1; i <= n; i++)\n\t\tans += s[i] / solve(dc, i);\n\tprintf(\"%.12lf\\n\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1683379702,
        "uid": 747423,
        "name": "2021cjx",
        "ccfLevel": 0,
        "title": "P2179 [NOI2012] \u9a91\u884c\u5ddd\u85cf \u9898\u89e3"
    },
    {
        "content": "\u9884\u5907\u77e5\u8bc6:\n\n\t1.\u5728\u6570\u5b66\u4e2d\uff0c\u4e00\u4e2a\u591a\u53d8\u91cf\u7684\u51fd\u6570\u7684\u504f\u5bfc\u6570\uff0c\u5c31\u662f\u5b83\u5173\u4e8e\u5176\u4e2d\u4e00\u4e2a\u53d8\u91cf\u7684\u5bfc\u6570\u800c\u4fdd\u6301\u5176\u4ed6\u53d8\u91cf\u6052\u5b9a\uff08\u76f8\u5bf9\u4e8e\u5168\u5bfc\u6570\uff0c\u5728\u5176\u4e2d\u6240\u6709\u53d8\u91cf\u90fd\u5141\u8bb8\u53d8\u5316\uff09\u3002\n\n2.\u62c9\u683c\u6717\u65e5\u4e58\u6570\u6cd5:\n\n\u5bf9\u4e8e\u51fd\u6570 $f(x_1,x_2,x_3...x_n),$\u5b58\u5728\u7ea6\u675f$\\phi_1,\\phi_2......\\phi_m$ \u5219\u5f15\u5165$\\lambda_1,\\lambda_2...\\lambda_m$.\n\u4ee4\u51fd\u6570$g(x_1,x_2...,x_n,\\lambda_1,\\lambda_2,...,\\lambda_m)$=$f(x_1,x_2,...x_n)+\\sum\\limits_{i=1}^m\\lambda_i \\phi_i$\n\n\u5bf9\u51fd\u6570\u7684\u6bcf\u4e2a\u53d8\u91cf\u6c42\u51fa\u4e00\u9636\u504f\u5bfc\u6570.\u5f53\u4e14\u4ec5\u5f53\u51fd\u6570\u7684\u6bcf\u4e2a\u504f\u5bfc\u6570\u90fd\u7b49\u4e8e0\u65f6,\u51fd\u6570$g(x_1,x_2...x_n,\\lambda_1,\\lambda_2...\\lambda_m)$\u53d6\u5f97\u6781\u503c,\u5373\u6c42\u51fa\u6bcf\u4e2a\u53d8\u91cf\u7684\u4e00\u9636\u504f\u5bfc\u6570\u540e,\u4e00\u9636\u504f\u5bfc\u6570\u7b49\u4e8e0\u7684\u70b9\u662f\u65b9\u7a0b\u7684\u4e00\u4e2a\u89e3.\n\n$c(v_1,v_2,...,v_n)=\\sum\\limits_{i=1}^n k_i(v_i-v_i')^2 s_i \\leq E_0$ \u6ee1\u8db3\u4e0a\u8ff0\u6761\u4ef6\u4e0b\n\n\u4f7f\u5f97$t(v_1,v_2,...,v_n)=\\sum\\limits_{i=1}^n \\frac{s_i}{v_i}$ \u53d6\u6700\u5c0f\u503c\n\n\u7531\u8d2a\u5fc3\u53ef\u77e5,$c(v_1,v_2,...v_n)=E$\u6700\u4f18.\u6545$\\phi(x_1,...x_n)=c(v_1,v_2,...v_n)=E  $\n\n\nupd.\u672c\u9898\u7684\u9650\u5236\u6761\u4ef6\u53ea\u6709\u4e00\u4e2a,\u5373$\\sum E\\leq E_0$,\u6240\u4ee5\u4ee4m=1\u5373\u53ef.\n~~\u6211\u5c45\u7136zz\u5230\u8fd9\u79cd\u5730\u6b65~~\n\n\u8fd0\u7528\u62c9\u683c\u6717\u65e5\u4e58\u6570\u6cd5,\u4ee4\u9650\u5236\u4e3a$\\Lambda$,\n\n\u5219\u5f97\u5230\u5173\u4e8e$v_i$\u7684\u51fd\u6570:(\u5176\u4e2d$\\Lambda$\u4e5f\u662f\u53d8\u91cf)\n\n$s(v_1,v_2,...v_n,\\Lambda)=-E+\\sum\\limits_{i=1}^n(\\frac{s_i}{v_i}+\\Lambda k_i(v_i-v_i')^2s_i)$.\n\n\u5bf9\u4e0a\u5f0f\u7684$v_i$\u6c42\u504f\u5bfc\u5f97\u5230\u65b9\u7a0b\u7ec4:\n\n$-\\frac{s_i}{v_i^2}+\\Lambda k_i(2v_i-2v_i')s_i=0$\n\n\u5373:$2\\Lambda k_is_i(v_i-v_i')=\\frac{s_i}{v_i^2}$\n\n\u5373:$2\\Lambda k_i(v_i-v_i')=\\frac{1}{v_i^2}$\n\n\u5373$2\\Lambda k_i(v_i-v_i')v_i^2=1$ \n\n\u6ce8\u610f\u5230\u4e0a\u5f0f\u5173\u4e8e$v_i$\u5355\u8c03\u9012\u589e.\u6545\u5982\u679c$\\Lambda$\u5df2\u77e5\u4e8c\u5206\u6c42\u89e3$v_i$\u5373\u53ef.\n\n\n\n\u636e\u8d2a\u5fc3\u539f\u5219,\u5982\u679c\u5b58\u5728$u>v$,\u4f7f\u5f97$\\Delta E_u=\\Delta E_v$,\u8f66\u901f\u4e00\u5b9a\u4e3a $u$\n\n\u5373$c(v_i)$\u5173\u4e8e$v_i$\u9012\u589e,\u6545$\\Lambda$\u4e5f\u53ef\u4ee5\u4e8c\u5206\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n(log_2n)^2)$,\u867d\u7136\u56e0\u4e3a\u5b9e\u6570\u8fd0\u7b97\u6162,\u4f46\u662f\u8db3\u591f\u901a\u8fc7\u672c\u9898\n\n\n\nqwq\n\n\u5982\u679c\u89c9\u5f97\u8fd9\u4e2a\u9898\u5230\u8fd9\u91cc\u5c31\u5927\u529f\u544a\u6210\u7684\u8bdd...\u8fd8\u5dee\u4e00\u70b9,\u7cbe\u5ea6\u8bef\u5deeeps.\n\n\u672c\u849f\u84bb\u4eb2\u6d4b,$10^{-10}10$\u5206,$10^{-11}40$\u5206,$10^{-12}100$\u5206.\n\n\n\u4e0b\u9762\u662f\u672c\u849f\u84bb\u7684\u4ee3\u7801\n\n```\n#include<algorithm>\n#include<cctype>\n#include<cmath>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<iostream>\n#include<map>\n#include<queue>\n#include<stack>\n#include<vector>\n#define size 500010\n#define debug(x) cerr<<#x<<\"=\"<<x\n#define gc getchar()\n#define inf 1e5\n#define db double\n#define rep(i,s,n) for (register int i=s;i<=n;i++)\n#define drep(i,n,s) for (register int i=n;i>=s;i--)\n#define il inline\n#define eps 1e-12\nusing namespace std;\n\nil int read()\n{\n\tchar c; int x,f=1;\n\tfor (c=gc;!isdigit(c);c=gc) if (c=='-') f=-1; x=c-'0';\n\tfor (c=gc;isdigit(c);c=gc) x=(x<<1)+(x<<3)+c-'0';\n\treturn f*x;\n}\n\nint n;\ndb k[size],s[size],u[size],Eu,v[size],ans;\n\ndb solve(int i,db lam)\n{\n\tdb lb=max(u[i],0.0),rb=inf,mid;\n\twhile (rb-lb>eps)\n\t{\n\t\tmid=(lb+rb)/2; \n\t\tif (2.0*lam*k[i]*mid*mid*(mid-u[i])<=1.0) lb=mid; else rb=mid;\n\t}\n\treturn mid;\n}\n\nbool judge(db Lam)\n{\n\tdb Es=0;\n\trep(i,1,n) v[i]=solve(i,Lam);\n\trep(i,1,n) Es+=k[i]*s[i]*(v[i]-u[i])*(v[i]-u[i]);\n\treturn Es>=Eu;\n} \n\nint main()\n{\n\tn=read(); scanf(\"%lf\",&Eu); rep(i,1,n) scanf(\"%lf%lf%lf\",&s[i],&k[i],&u[i]);\n\tdb l=0.0,r=inf;\n\twhile (r-l>eps) \n\t{\n\t\tdb mid=(l+r)/2; if (judge(mid)) l=mid; else r=mid;\n\t}\n\trep(i,1,n) ans+=s[i]/v[i]; printf(\"%.11lf\\n\",ans);\n\treturn 0;\n}\n```\n\n\n\n\n",
        "postTime": 1520922762,
        "uid": 44273,
        "name": "\u786b\u4ee3\u786b\u9178\u94a0",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2179 \u3010[NOI2012]\u9a91\u884c\u5ddd\u85cf\u3011"
    },
    {
        "content": "# \u5bfc\u6570\u840c\u65b0\u4e5f\u80fd\u770b\u61c2\u7684\u9898\u89e3TwT\n\n\u8003\u573a\u4e0a\u7684\u5947\u5999\u8d2a\u5fc3\u505a\u6cd5\n\n\u8fd9\u662f\u7ed9\u5b8c\u5168\u6ca1\u6709\u63a5\u89e6\u8fc7\u9ad8\u4e2d\u6570\u5b66\u77e5\u8bc6\u7684\u4eba\u51c6\u5907\u7684\uff0c\u8bb2\u89e3\u8f83\u4e3a\u8be6\u7ec6\uff0c\u8bf7\u8010\u5fc3\u89c2\u770b\uff0c\u521d\u4e2d\u751f\u4e5f\u80fd\u61c2\u3002\n\n[\u9898\u76ee\u6307\u8def](https://www.luogu.com.cn/problem/P2179)\n\n## step 1:\u5bfc\u6570\n\ndalao\u53ef\u8df3\u8fc7\u672c\u8282\u3002\n\n\u4e00\u822c\u800c\u8a00\uff0c\u5bfc\u6570\u90fd\u4ee5\u4e0b\u9762\u7684\u4f8b\u5b50\u5f15\u5165\uff1a\n\n\u201c\u5047\u8bbe\u6709\u4e00\u8f86\u8f66\uff0c\u5b83\u901a\u8fc7\u7684\u8def\u7a0b $(m)$ \u4e0e\u65f6\u95f4 $(s)$ \u7684\u5173\u7cfb\u662f $y=x^2$\uff0c\u5219\u5b83\u5728 $t$ \u65f6\u523b\u7684\u901f\u5ea6\u662f\u591a\u5c11\uff1f\u201d\n\n\u8003\u8651\u4f7f\u7528\u901f\u5ea6\u516c\u5f0f $v=\\frac s t$\uff0c\u4f46\u76f4\u63a5\u9664\u80af\u5b9a\u4e0d\u5bf9\uff0c\u90a3\u6c42\u51fa\u6765\u7684\u662f\u6574\u6bb5\u8def\u7a0b\u7684\u5e73\u5747\u901f\u5ea6\uff0c\u90a3\u600e\u4e48\u6c42\u5462\uff1f\n\n\u6211\u4eec\u628a\u65f6\u95f4\u65e0\u9650\u7f29\u77ed\uff0c\u8f66\u901a\u8fc7\u7684\u8def\u7a0b\u4e5f\u65e0\u9650\u7f29\u77ed\uff0c\u4f46\u5b83\u4eec\u7684\u6bd4\u503c\u4e5f\u8d8a\u6765\u8d8a\u63a5\u8fd1\u90a3\u4e00\u77ac\u95f4\u7684\u901f\u5ea6\u3002\u5f53\u7f29\u5230\u4e0d\u80fd\u518d\u7f29\u540e\uff0c\u6c42\u51fa\u7684\u503c\u5c31\u662f\u5728\u90a3\u4e2a\u65f6\u523b\u7684\u901f\u5ea6\u3002\n\n\u600e\u4e48\u6c42\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u8ba9\u8f66\u518d\u8d70 $\\Delta x$ \u79d2\uff0c\u5b83\u5c31\u518d\u524d\u8fdb $\\Delta y$ \u7c73\uff0c\u8fd9\u4e24\u4e2a\u503c\u90fd\u662f\u65e0\u6cd5\u518d\u7f29\u5c0f\u7684\u65e0\u7a77\u5c0f\u91cf\u3002\u6b64\u65f6\u7684\u77ac\u95f4\u901f\u5ea6\u5c31\u662f $\\frac{\\Delta y}{\\Delta x}$ \u7c73\u6bcf\u79d2\u3002\n\n\u5e26\u56de\u539f\u5f0f\uff0c\u5c31\u662f\u5982\u4e0b\u7684\u8ba1\u7b97\u8fc7\u7a0b\n\n$y+\\Delta y=(x+\\Delta x)^2$\n\n$=x^2+2x\\Delta x+\\Delta x^2$\n\n\u56e0\u4e3a $\\Delta x^2$ \u76f8\u6bd4\u4e8e $x^2+2x\\Delta x$ \u6765\u8bf4\uff0c\u5b83\u7684\u5927\u5c0f\u4e0d\u503c\u4e00\u63d0\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u5ffd\u7565\u3002\u7b49\u5f0f\u4e24\u8fb9\u540c\u65f6\u51cf $y$\uff0c\u5373\u51cf $x^2$\u3002\n\n$\\Delta y=2x\\Delta x$\n\n\u4e24\u8fb9\u540c\u65f6\u9664\u4ee5 $\\Delta x$\uff0c\u5f97\n\n$\\frac{\\Delta y}{\\Delta x}=2x$\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728 $t$ \u65f6\u523b\uff0c\u8f66\u7684\u901f\u5ea6\u4e3a $2t$ \u7c73\u6bcf\u79d2\u3002\n\n\u5982\u679c\u8981\u5c55\u5f00\u8bb2\u5bfc\u6570\uff0c\u9700\u8981\u6781\u9650\u4e00\u7cfb\u5217\u524d\u7f6e\u77e5\u8bc6\uff0c\u5728\u6b64\u7bc7\u5e45\u53d7\u9650\uff0c\u65e0\u6cd5\u8be6\u7ec6\u8bb2\u89e3\u3002\u56e0\u6b64\uff0c\u4e0b\u9762\u76f4\u63a5\u7ed9\u51fa\u5bfc\u6570\u7684\u4e25\u8c28\u5b9a\u4e49\uff0c\u770b\u4e0d\u61c2\u4e5f\u6ca1\u5173\u7cfb\u3002\n\n$f'(x)=\\lim\\limits_{h \\to 0} \\dfrac{f(x+h)-f(x)} h$\n\n\u5176\u4e2d\uff0c$h$ \u5c31\u662f\u4e0a\u6587\u7684 $\\Delta x$\u3002\n\n\u4f9d\u7167\u540c\u6837\u7684\u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u518d\u5bf9\u901f\u5ea6\u6c42\u65f6\u95f4\u7684\u5bfc\u6570\u6765\u5f97\u51fa\u52a0\u901f\u5ea6\u548c\u65f6\u95f4\u7684\u5173\u7cfb\u3002\n\n\u8ba9\u6211\u4eec\u8003\u8651\u5bfc\u6570\u7684\u4ee3\u6570\u610f\u4e49\u3002\u901f\u5ea6\u662f\u8861\u91cf\u8def\u7a0b\u968f\u65f6\u95f4\u53d8\u5316\u5feb\u6162\u7684\u91cf\uff0c\u52a0\u901f\u5ea6\u662f\u8861\u91cf\u901f\u5ea6\u968f\u65f6\u95f4\u53d8\u5316\u5feb\u6162\u7684\u91cf\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u8bf4\uff0c\u5bfc\u6570\u7684\u4f5c\u7528\uff0c\u662f\u6c42\u51fa\u53d8\u5316\u7387\u3002\u81f3\u4e8e\u51e0\u4f55\u610f\u4e49\uff0c\u611f\u5174\u8da3\u7684\u540c\u5b66\u53ef\u4ee5\u518d\u5e73\u9762\u76f4\u89d2\u5750\u6807\u7cfb\u4e0a\u6a21\u62df\u8d70\u4e00\u6bb5\u65e0\u7a77\u5c0f\u7684\u65f6\u95f4\u7684\u8fc7\u7a0b\uff0c\u81ea\u884c\u89c2\u5bdf\u3002\n\n## step 2:\u8f6c\u5316\n\n\u8ba9\u6211\u4eec\u8003\u8651\u5728\u9053\u8def\u4e0a\u53d1\u751f\u4e86\u4ec0\u4e48\u3002\n\n\u9996\u5148\u8ba9\u6211\u4eec\u5217\u51fa\u5f0f\u5b50\uff0c\u8bb0 $E_i$ \u4e3a\u7b2c $i$ \u6bb5\u8def\u8017\u8d39\u7684\u80fd\u91cf\uff0c $t_i$ \u4e3a\u7b2c $i$ \u6bb5\u8def\u8017\u8d39\u7684\u65f6\u95f4\uff0c\u8bb0 $v_i$ \u4e3a\u7b2c $i$ \u6bb5\u8def\u7684\u901f\u5ea6\uff0c\u5219\u6709\u5982\u4e0b\u5f0f\u5b50:\n\n$E_i=k_i s(v_i-v_i')$\n\n$t_i=\\dfrac{s_i}{v_i}$\n\n\u5982\u679c\u6211\u4eec\u60f3\u7528\u66f4\u5c11\u7684\u65f6\u95f4\u901a\u8fc7\u8fd9\u4e2a\u8def\u7a0b\uff0c\u90a3\u4e48\u5c31\u8981\u901f\u5ea6\u66f4\u5927\uff0c\u90a3\u4e48\u6d88\u8017\u80fd\u91cf\u4e5f\u5c31\u8981\u66f4\u591a\u3002\u6709\u7684\u65f6\u5019\uff0c\u65f6\u95f4\u51cf\u5c11\u5f88\u591a\uff0c\u4f46\u80fd\u91cf\u6d88\u8017\u4e0d\u4e00\u5b9a\u589e\u52a0\u5f88\u591a\uff1b\u6709\u65f6\u65f6\u95f4\u51cf\u5c11\u4e00\u70b9\uff0c\u80fd\u91cf\u6d88\u8017\u5374\u589e\u52a0\u4e86\u5f88\u591a\u3002\u4f7f\u7528\u4f5c\u6bd4\u5b9a\u4e49\u6cd5\uff0c\u4e0d\u59a8\u8bb0 $w_i=\\frac{t_i\\text{\u53d8\u5316\u91cf}}{E_i\\text{\u53d8\u5316\u91cf}}$\uff0c\u663e\u7136\uff0c\u5176\u503c\u6c38\u8fdc\u4e3a\u8d1f\u3002$|w_i|$ \u8d8a\u5c0f\uff0c\u6211\u4eec\u5c06\u65f6\u95f4\u51cf\u5c11\uff0c\u589e\u5927\u7684\u80fd\u91cf\u5c31\u8d8a\u5c0f\u3002\u901f\u5ea6\u4e0d\u540c\u65f6\uff0c$w_i$ \u4e5f\u4e0d\u4e00\u6837\u3002\u5982\u679c\u80fd\u6c42\u51fa $t_i$ \u968f $E_i$ \u7684\u53d8\u5316\u7387\uff0c\u7528 $v_i$ \u8868\u793a\u51fa\u6765\uff0c\u6211\u4eec\u5c31\u80fd\u51b3\u5b9a\u51fa\u901f\u5ea6\u4e3a\u591a\u5c11\u65f6\uff0c\u6539\u53d8\u65f6\u95f4\u7684\u6536\u76ca\u6700\u5927\u3002\n\n\u65e2\u7136\u662f\u53d8\u5316\u7387\uff0c\u7acb\u523b\u60f3\u5230\u5bfc\u6570\u3002\u8fd9\u91cc\u8981\u6c42 $t_i$ \u5bf9\u4e8e $E_i$ \u7684\u5bfc\u6570\u3002\u5728\u8fd9\u91cc\u5c31\u8981\u7528\u5230\u5bfc\u6570\u7684\u7684\u53e6\u4e00\u4e2a\u6027\u8d28\u4e86\u3002\u770b\u5230\u4e0a\u9762\u5bfc\u6570\u65e2\u7136\u662f\u4e00\u79cd\u5546\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u7528\u4ee5\u4e0b\u6c42\u6cd5\u3002\n\n$\\dfrac{\\Delta t_i}{\\Delta E_i}=\\dfrac{\\frac{\\Delta t_i}{\\Delta v_i}}{\\frac{\\Delta E_i}{\\Delta v_i}}$\n\n\u8bfe\u5802\u7ec3\u4e60\uff0c\u7528step 1\u7684\u65b9\u6cd5\u6c42\u5bfc\u5e76\u7528 $v_i$ \u8868\u793a\u3002\n\n\u4e0b\u9762\u76f4\u63a5\u7ed9\u51fa\u7ed3\u8bba\uff1a\n\n$\\dfrac{\\Delta t_i}{\\Delta E_i}=-\\dfrac 1 {2k_i(v_i-v_i')v_i^2}$\n\n\u95ee\u9898\u662f\uff0c\u63a5\u4e0b\u6765\u600e\u4e48\u529e\uff1f\n\n## step 3:\u8d2a\u5fc3\u4e0e\u4e8c\u5206\n\n\u9a91\u884c\u7684\u8fc7\u7a0b\u53ef\u4ee5\u8fd9\u6837\u7406\u89e3\u3002\n\n\u6211\u4eec\u6bcf\u6b21\u9009\u51fa\u4e00\u4e2a\u65e0\u7a77\u5c0f\u7684\u80fd\u91cf $\\Delta E$\uff0c\u5c06\u5176\u5206\u7ed9\u6536\u76ca\u6700\u9ad8\u7684\u4e00\u6bb5\u4ee5\u51cf\u5c11\u65f6\u95f4\u3002\u6b64\u65f6\u6839\u636e\u516c\u5f0f\uff0c\u90a3\u6761\u8def\u6bb5\u7684\u6536\u76ca\u4f1a\u964d\u4f4e\u3002\u56e0\u6b64\u8fbe\u5230\u6700\u4f18\u89e3\u540e\uff0c\u6211\u4eec\u8981\u505a\u5230\u6bcf\u6bb5\u5bfc\u6570\u76f8\u7b49\u3002\u5426\u5219\uff0c\u6211\u4eec\u5728\u4e0a\u4e00\u6b65\u5206\u914d\u7ed9\u5bfc\u6570\u8f83\u5927\u7684\u90a3\u4e00\u6bb5\uff0c\u5c31\u53ef\u4ee5\u83b7\u5f97\u66f4\u4f18\u89e3\u3002\u8fd9\u4e0e\u6211\u4eec\u5df2\u627e\u5230\u6700\u4f18\u89e3\u7684\u5047\u8bbe\u77db\u76fe\u3002\u6240\u4ee5\uff0c\u6700\u7ec8\u72b6\u6001\u4e0b\uff0c\u6bcf\u6bb5\u7684\u901f\u5ea6\u5fc5\u7136\u4f7f\u6bcf\u6bb5\u7684\u5bfc\u6570\u76f8\u7b49\u3002\n\n\u518d\u770b\u5bfc\u6570\u56fe\u50cf\n![\u5bfc\u6570\u56fe\u50cf](https://cdn.luogu.com.cn/upload/image_hosting/s5c3h2y9.png)\n\n\u5176\u7455\u70b9\u4e3a $v_i=v_i'$\uff0c\u5f53 $v_i>v_i'$ \u65f6\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u9700\u8981\u7684\u8d1f\u6570\u503c\uff0c\u5bfc\u6570\u503c\u5355\u8c03\u9012\u589e\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u4e8c\u5206\u5bfc\u6570\u503c\uff0c\u4e0a\u8282\u53d60\uff0c\u4e0b\u754c\u53d6\u4e00\u4e2a\u5f88\u5c0f\u7684\u8d1f\u6570\u503c\uff0c\u5728\u672c\u9898\u53d6 $4\\times 10^6$ \u5373\u53ef\u3002\n\n\u4e8c\u5206\u51fa\u5bfc\u6570\u503c $d$ \u540e\uff0c\u89e3\u5173\u4e8e $v_i$ \u7684\u65b9\u7a0b $-\\dfrac 1 {2k_i(v_i-v_i')v_i^2}=d$\uff0c\u518d\u7528 $E_i=k_i s(v_i-v_i')$ \u6c42\u51fa\u80fd\u91cf\u3002\u5982\u679c $\\sum_{i=1}^n E_i\\le E_U$ \u5c31\u4e8c\u5206\u53f3\u533a\u95f4\uff0c\u53cd\u4e4b\u4e8c\u5206\u5de6\u533a\u95f4\uff0c\u5230\u8fbe\u7cbe\u5ea6\u5c31\u505c\u3002\u672c\u9898\u5bf9\u7cbe\u5ea6\u8981\u6c42\u8f83\u9ad8\uff0c\u5efa\u8bae\u53d6 $\\varepsilon=1\\times 10^{-12}$\u3002\n\n\u81f3\u4e8e\u600e\u4e48\u89e3\u65b9\u7a0b\uff0c\u65e9\u5728\u521d\u4e09\u8bfe\u672c\u4e8c\u6b21\u51fd\u6570\u90a3\u7ae0\u5c31\u5df2\u7ecf\u63a5\u89e6\u8fc7\u4e8c\u5206\u6cd5\uff0c\u9ad8\u4e2d\u5fc5\u4fee\u4e00\u6709\u8be6\u7ec6\u4ecb\u7ecd\u4e86\uff0c\u5728\u6b64\u4e0d\u505a\u8d58\u8ff0\uff0c\u5177\u4f53\u6b65\u9aa4\u5927\u6982\u662f:\n1. \u82e5 $f(l)\\times f(r)<0$\uff0c\u5219\u5728 $[l,r]$ \u533a\u95f4\u5185\u6709\u89e3\u3002\n2. \u8bb0 $m=\\dfrac {l+r} 2$\u3002\n3. \u82e5 $f(m)=0$\uff0c\u5219 $m$ \u5c31\u662f\u89e3\u3002\n4. \u82e5 $f(m)\\times f(l)<0$\uff0c\u4ee4 $r=m$\uff0c\u5426\u5219\u4ee4 $l=m$\uff0c\u91cd\u590d\u7b2c\u4e8c\u3001\u4e09\u3001\u56db\u6b65\uff0c\u76f4\u5230\u5230\u8fbe\u6307\u5b9a\u7cbe\u5ea6\uff0c\u5373 $|l-r|<\\varepsilon$\u3002\n\n## step 4:\u9644\u4e0a\u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define F(i,a,b) for(int i(a);i<=b;++i)\n#define R(i,a,b) for(int i(a);i>=b;--i)\n#define _ 0\nusing namespace std;\nconst double EPS=1e-12;\nconst int INF=4e6;\ndouble e,s[10001],v_wind[10001],k[10001],t;\nint n;\ninline double func(double x,int i,double right){\n\treturn -1.0/(2*k[i]*(x-v_wind[i])*x*x)-right;\n}\ninline bool check(double d){\n\tdouble energy(0);\n\tt=0;\n\tF(i,1,n){\n\t\tdouble l(max(v_wind[i],(double)0)),r(INF),mid=(l+r)/2,fl=func(l,i,d);\n\t\twhile(fabs(r-l)>EPS){\n\t\t\tdouble fmid=func(mid,i,d);\n\t\t\tif(fabs(fmid)<=EPS) break;\n\t\t\tif(fmid*fl<0) r=mid;\n\t\t\telse l=mid,fl=fmid;\n\t\t\tmid=(l+r)/2;\n\t\t}\n    \tmid=(l+r)/2;\n\t\tenergy+=k[i]*s[i]*(mid-v_wind[i])*(mid-v_wind[i]);\n\t\tt+=s[i]/mid;\n\t}\n\treturn energy<=e;\n}\nint main(){\n// \tfreopen(\"bicycling.in\",\"r\",stdin);\n// \tfreopen(\"bicycling.out\",\"w\",stdout);\n\tscanf(\"%d%lf\",&n,&e);\n\tF(i,1,n) scanf(\"%lf%lf%lf\",s+i,k+i,v_wind+i);\n\tdouble l(-INF),r(0),mid=(l+r)/2;\n\twhile(fabs(r-l)>EPS){\n\t\tif(check(mid)) l=mid;\n\t\telse r=mid;\n\t\tmid=(l+r)/2;\n\t}\n\tprintf(\"%.8lf\",t);\n\treturn ~~(0^_^0);//\u5356\u4e2a\u840cOwO\n}\n```\n\n\u4e0d\u559c\u52ff\u55b7awa~",
        "postTime": 1661493514,
        "uid": 486559,
        "name": "littlez_meow",
        "ccfLevel": 0,
        "title": "P2179 [NOI2012] \u9a91\u884c\u5ddd\u85cf \u9898\u89e3"
    },
    {
        "content": "### \u9898\u610f\uff1a\n\n\u7ed9\u51fa$u_1,u_2,\\cdots,u_n,k_1,k_2,\\cdots,k_n,s_1,s_2,\\cdots,s_n$\uff0c\n\n\u6700\u5c0f\u5316\u51fd\u6570$T=\\sum\\limits_{i=1}^n\\frac{s_i}{v_i}$\u7684\u503c\uff0c\u5e76\u6ee1\u8db3\u6761\u4ef6$\\varphi=\\sum\\limits_{i=1}^nk_is_i(v_i-u_i)^2-E_U=0$\u3002\n\n\u539f\u672c\u9898\u76ee\u63cf\u8ff0\u662f\u8bf4$\\varphi\\leq0$\uff0c\u4f46\u4e00\u4e2a\u7b80\u5355\u7684\u8d2a\u5fc3\u601d\u60f3\u5c31\u662f\u80fd\u91cf\u6d88\u8017\u8d8a\u591a\u65f6\u95f4\u80af\u5b9a\u8d8a\u5c11\uff0c\u6240\u4ee5\u76f4\u63a5\u4ee4$\\varphi=0$\u5373\u53ef\u3002\n\n### \u9898\u89e3\uff1a\n\n\u8fd9\u662f\u88f8\u7684\u6761\u4ef6\u6781\u503c\uff0c\u8003\u8651\u62c9\u683c\u6717\u65e5\u4e58\u6570\u6cd5\u3002\n\n\u9996\u5148\u4ecb\u7ecd\u504f\u5bfc\u6570\u7684\u6982\u5ff5\uff1a\u5bf9\u4e8e\u591a\u5143\u51fd\u6570$y=f(x_1,x_2,\\cdots,x_n)$\uff0c\u53ef\u4ee5\u9009\u5b9a\u5176\u4e2d\u4e00\u4e2a$x_i$\u89c6\u4e3a\u53d8\u91cf\uff0c\u5c06\u5176\u5b83\u7684$x_j(j\\neq i)$\u90fd\u89c6\u4e3a\u5e38\u6570\uff0c\u5c06$y$\u5173\u4e8e$x_i$\u6c42\u5bfc\uff0c\u79f0\u4e3a\u504f\u5bfc\u51fd\u6570\uff0c\u8bb0\u4f5c$\\frac{\\partial f}{\\partial x_i}$\u6216$f_{x_i}(x_1,x_2,\\cdots,x_n)$\u3002\n\n\u62c9\u683c\u6717\u65e5\u4e58\u6570\u6cd5\uff1a\u6c42\u51fd\u6570$f(x_1,x_2,\\cdots,x_n)$\u5728\u6ee1\u8db3\u6761\u4ef6$\\varphi(x_1,x_2,\\cdots,x_n)=0$\u7684\u60c5\u51b5\u4e0b\u7684\u53ef\u80fd\u6781\u503c\u70b9\uff0c\u53ef\u4ee5\u6784\u9020\u51fd\u6570$L=f(x_1,x_2,\\cdots,x_n)+\\lambda\\varphi(x_1,x_2,\\cdots,x_n)$\uff0c\u7136\u540e\u8054\u7acb\u65b9\u7a0b\u7ec4\uff1a\n\n$$\\begin{cases}\\frac{\\partial L}{\\partial x_1}=0\\\\\\frac{\\partial L}{\\partial x_2}=0\\\\\\cdots\\\\\\frac{\\partial L}{\\partial x_n}=0\\\\\\varphi(x_1,x_2,\\cdots,x_n)=0\\end{cases}$$\n\n\u8fd9\u91cc\u4e00\u5171\u6709$(n+1)$\u4e2a\u65b9\u7a0b\uff0c\u5e76\u4e14\u7b97\u4e0a$\\lambda$\u4e00\u5171\u6709$(n+1)$\u4e2a\u672a\u77e5\u6570\uff0c\u53ef\u4ee5\u89e3\u51fa\u82e5\u5e72\u7ec4\u89e3\uff0c\u5b83\u4eec\u5c31\u662f\u51fd\u6570$f$\u5728\u6ee1\u8db3\u6761\u4ef6$\\varphi=0$\u7684\u60c5\u51b5\u4e0b\u7684\u6240\u6709\u53ef\u80fd\u6781\u503c\u70b9\u3002\n\n\u5bf9\u4e8e\u672c\u9898\u800c\u8a00\uff0c\u8bbe$L=T+\\lambda\\varphi=\\sum\\limits_{i=1}^n\\frac{s_i}{v_i}+\\lambda\\left(\\sum\\limits_{i=1}^nk_is_i(v_i-u_i)^2-E_U\\right)$\n\n\u90a3\u4e48$L$\u5173\u4e8e$v_i$\u7684\u504f\u5bfc\u6570\u4e3a\n\n$$\n\\frac{\\partial L}{\\partial x_i}=-\\frac{s_i}{v_i^2}+2\\lambda k_is_i(v_i-u_i)\n$$\n\n\u4ee4\u4e0a\u5f0f\u4e3a$0$\uff0c\u7a0d\u4f5c\u53d8\u5f62\u5f97\u5230\u65b9\u7a0b\n\n$$\n2\\lambda k_i(v_i-u_i)v_i^2-1=0\n$$\n\n\u6ce8\u610f\u5230$v_i$\u5fc5\u987b\u5927\u4e8e\u7b49\u4e8e$u_i$\u3002\u56e0\u4e3a\u5982\u679c$u_i\\leq0$\uff0c$v_i>0>u_i$\u663e\u7136\uff1b\u800c\u5f53$u_i>0$\u65f6\uff0c$v_i<u_i$\u610f\u5473\u7740\u4f60\u5728\u53cd\u5411\u4f7f\u52b2\u3002\n\n\u5e76\u4e14\u8fd9\u4e2a\u65b9\u7a0b\u8981\u6709\u89e3\u5fc5\u987b$\\lambda>0$\uff0c\u56e0\u4e3a$\\lambda\\leq0$\u65f6\u5de6\u8fb9\u5fc5\u7136\u662f\u8d1f\u7684\u3002\n\n\u8003\u8651\u51fd\u6570$g(x)=2\\lambda k_i(x-u_i)x^2-1$\uff0c\u6c42\u5bfc$g'(x)=6\\lambda k_ix^2-4\\lambda k_iu_ix$\u3002\u5f53$\\lambda>0,x\\geq u_i$\u65f6$g'(x)>0$\uff0c$g(x)$\u5355\u8c03\u9012\u589e\u3002\n\n\u6240\u4ee5\u5bf9\u4e8e\u7ed9\u5b9a\u7684$\\lambda$\uff0c\u6211\u4eec\u53ef\u4ee5\u4e8c\u5206\u6765\u6c42\u89e3\u65b9\u7a0b$g(v_i)=0$\u7684\u89e3\u3002\n\n\u53ef\u662f$\\lambda$\u5e76\u6ca1\u6709\u7ed9\u5b9a\u600e\u4e48\u529e\uff1f\u6ca1\u6709\u5173\u7cfb\u3002\u4ece\u4e0a\u9762\u8fd9\u4e2a\u65b9\u7a0b\u6211\u4eec\u770b\u51fa\uff0c$\\lambda$\u8d8a\u5927\uff0c$v_i$\u8d8a\u5c0f\uff0c\u76f8\u5e94\u7684$\\varphi=\\sum\\limits_{i=1}^nk_is_i(v_i-u_i)^2-E_U$\u5c31\u8d8a\u5c0f\u3002\u73b0\u5728\u6211\u4eec\u8981\u4f7f\u5f97$\\varphi=0$\uff0c\u53ef\u4ee5\u4e8c\u5206$\\lambda$\u3002\n\n```cpp\n#include <cstdio>\n#include <climits>\n#include <cmath>\n#include <algorithm>\n\nconst int maxn = 1e4 + 7;\nconst double eps = 1e-12, inf = 1e5;\n\nint n;\ndouble eu, s[maxn], k[maxn], u[maxn], v[maxn];\n\ninline bool check(double lambda) {\n    double e = 0;\n    for (int i = 1; i <= n; ++i) {\n        double left = std::max(u[i], 0.0), right = inf;\n        while (right - left >= eps) {\n            double mid = (left + right) / 2.0;\n            if (2 * lambda * k[i] * (mid - u[i]) * mid * mid >= 1)\n                right = mid;\n            else left = mid;\n        }\n        v[i] = left;\n        e += k[i] * s[i] * (v[i] - u[i]) * (v[i] - u[i]);\n    }\n    return e >= eu;\n}\n\nint main() {\n    scanf(\"%d%lf\", &n, &eu);\n    for (int i = 1; i <= n; ++i) scanf(\"%lf%lf%lf\", s + i, k + i, u + i);\n    double left = 0, right = inf;\n    while (right - left >= eps) {\n        double mid = (left + right) / 2.0;\n        if (check(mid)) left = mid;\n        else right = mid;\n    }\n    double t = 0;\n    for (int i = 1; i <= n; ++i) t += s[i] / v[i];\n    printf(\"%.8lf\\n\", t);\n    return 0;\n}\n```\n\n\u6c42\u89e3\u90a3\u4e2a\u504f\u5bfc\u6570$=0$\u7684\u65b9\u7a0b\u53ef\u80fd\u8fd8\u53ef\u4ee5\u7528\u725b\u987f\u8fed\u4ee3\u6cd5\u6765\u63d0\u9ad8\u6548\u7387\uff0c\u53ef\u662f\u6211\u597d\u50cfWA\u4e86...",
        "postTime": 1560664859,
        "uid": 72071,
        "name": "GKxx",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2179 \u3010[NOI2012]\u9a91\u884c\u5ddd\u85cf\u3011"
    },
    {
        "content": "### \u9a91\u884c\u5ddd\u85cf\n\u56e0\u4e3a\u770b\u4e0d\u660e\u767d\u4e0b\u9762\u9898\u89e3\u7684\u6765\u9f99\u53bb\u8109\u56e0\u6b64\u94bb\u4e86\u4e00\u665a\u4e0a\u52a0\u4e00\u4e2a\u4e0a\u5348\u7684**\u62c9\u683c\u6717\u65e5\u4e58\u6570\u5b50\u6cd5**, \u53d1\u73b0\u8fd9\u91cc\u9762\u6c34\u5b9e\u5728\u662f\u592a\u6df1\u4e86, \u8bbe\u8ba1\u5230\u6570\u5b66\u591a\u4e2a\u65b9\u9762\u7684\u5185\u5bb9, \u592a\u5413\u4eba\u4e86.\n\n\u4f46\u662f\u56e0\u4e3a\u6211\u83dc\u7684\u4e0d\u884c\u56e0\u6b64\u53ea\u80fd\u5c06\u4e00\u4e9b**\u5173\u952e\u70b9**\u5199\u51fa\u6765.\u800c\u4e14\u6211\u5173\u6ce8\u7684\u53ea\u6709**\u6570\u5b66\u63a8\u5bfc\u8fc7\u7a0b**, \u5982\u679c\u60a8\u60f3**\u80cc\u8fc7\u7ed3\u8bba**\u800c\u4e14\u76f4\u63a5\u7528\u7684\u8bdd\u8bf7\u770b\u5176\u4ed6\u4eba\u7684\u9898\u89e3.\n#### \u591a\u5143\u51fd\u6570\u7684\u6781\u503c\u95ee\u9898\n\u8fd9\u5e94\u8be5\u662f\u5c5e\u4e8e**\u6570\u5b66\u5206\u6790**\u7684\u5185\u5bb9.\u5927\u6982\u662f\u6570\u5b66\u4e13\u4e1a\u7684\u4e13\u4e1a\u8bfe\u7a0b.\n\n\u6c42\u591a\u5143\u51fd\u6570$f(x_1,\\cdots,x_n)$\u6781\u503c\n$$df=0$$\n\n**\u6709\u7ea6\u675f\u7684\u6781\u503c**\u95ee\u9898, \u591a\u7ec4\u7ea6\u675f\u5f62\u5982$g(x_1,\\cdots,x_n)=0$\u53ef\u7528**\u62c9\u683c\u6717\u65e5\u4e58\u6570\u5b50\u6cd5**\u89e3\u51b3.\n\n- [Zhihu](https://www.zhihu.com/question/38586401)\n- [Cnblogs](http://www.cnblogs.com/maybe2030/p/4946256.html#undefined)\n- [WenKu](https://wenku.baidu.com/view/6dd13bef551810a6f52486e1.html?from=search)\n- [Baike](https://baike.baidu.com/item/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E4%B9%98%E5%AD%90%E6%B3%95/1946079?fr=aladdin)\n- \u6570\u5b66\u5206\u6790\u8bfe\u672c\n\n##### \u504f\u5bfc\u6570\n**\u5bfc\u6570\u5c5e\u4e8e\u5fae\u79ef\u5206\u7684\u5185\u5bb9, \u6c34\u5b9e\u5728\u662f\u592a\u6df1\u4e86, \u5b8c\u5168\u4e0d\u662f\u9ad8\u4e2d\u8bfe\u672c\u4e0a\u90a3\u4e9b\u4e00\u5143\u51fd\u6570.**\n\n\u4f8b\u5982:\n\u4e8c\u5143\u51fd\u6570$f(x,y)$\u5728\u67d0\u4e00\u70b9$(x_0,y_0)$\u5904\u5bf9$x$\u7684\u504f\u5bfc\u6570.\n$$f_x(x_0,y_0)=\\lim_{\\Delta x\\rightarrow 0}\\frac{f(x_0+\\Delta x,y_0)-f(x_0,y_0)}{\\Delta x}$$\n\u4e8c\u5143\u51fd\u6570$f(x,y)$\u5bf9$x$\u7684\u504f\u5bfc\u51fd\u6570\u8bb0\u4e3a\n$$\\frac{\\partial f}{\\partial x}\\text{ or }f_x(x,y).$$\n##### \u68af\u5ea6\n$\\nabla $\u662f\u5288\u578b\u7b97\u5b50, $\\nabla f$\u53ef\u8868\u793a\u51fd\u6570\u5728\u67d0\u4e00\u70b9\u7684\u68af\u5ea6,\u68af\u5ea6\u4e5f\u5c31\u662f\u67d0\u4e00\u70b9\u7684\u6cd5\u5411\u91cf.\u4e5f\u5c31\u662f\u5728\u8fd9\u4e2a\u65b9\u5411\u4e0a\u51fd\u6570\u503c\u4e0a\u5347\u6700\u5feb.\n$$\\nabla f=f_x(x_0,y_0)i+f_y(x_0,y_0)j$$\n$i,j$\u4e3a\u5355\u4f4d\u5411\u91cf.\n\u6839\u636e$f$\u5728$g$\u7684\u7ea6\u675f\u6761\u4ef6\u4e0b\u53d6\u5f97\u6781\u503c\u7b49\u4ef7\u4e8e(\u4e3a\u4ec0\u4e48?\u770b[\u4f8b\u5b50](https://www.luogu.org/blog/aiyoupass/li-zi))\n![png](https://cdn.luogu.com.cn/upload/pic/18873.png)\n\n\u5176\u4e2d$F$\u4e3a\u62c9\u683c\u6717\u65e5\u51fd\u6570, \u5b83\u62e5\u6709\u548c$f$\u4e00\u6837\u7684\u6781\u503c.\n\n##### Solution\n\u3000\u3000\u6240\u4ee5\u7ec8\u4e8e\u6b65\u5165\u6b63\u9898\u4e86, \u5206\u6790\u8fd9\u4e2a\u9898, \u4f1a\u53d1\u73b0\u5176\u65f6\u95f4$f$\u662f\u5173\u4e8e\u901f\u5ea6$v_1,v_2,\\cdots ,v_n$\u7684\u591a\u5143\u51fd\u6570.\u80fd\u91cf$g$\u662f\u4e5f\u662f\u5173\u4e8e$v_1,v_2,\\cdots,v_n$\u7684\u591a\u5143\u51fd\u6570.\u4f46\u662f\u8981\u6c42$g\\leq \\text{E}$\n\n\u3000\u3000\u63a5\u4e0b\u6765\u4f1a\u53d1\u73b0\u5982\u679c\u5982\u679c$g<\\text{E}$, \u90a3\u4e48\u589e\u5927\u80fd\u91cf$g$, $f$\u4e00\u5b9a\u4f1a\u51cf\u5c0f, \u4e5f\u5c31\u662f\u8bf4\u4f1a\u5f97\u5230\u66f4\u4f18\u79c0\u7684\u7b54\u6848, \u56e0\u6b64\u53d6\u5f97\u6700\u7ec8\u7b54\u6848$v_{01},v_{02},\\cdots ,v_{0n}$\u65f6\u80fd\u91cf$g$\u4e00\u5b9a\u7b49\u4e8e$E$.\n\n\u3000\u3000\u6240\u4ee5\u63a5\u4e0b\u6765\u95ee\u9898\u5c31\u8f6c\u53d8\u4e3a\u4e86\u4e3a\u4e86\n$$\\max\\ f(v_1,\\cdots,v_n)$$\n$$\\text{s.t. }\\ \\ g(v_1,\\cdots,v_n)-E=0$$\n\u6240\u4ee5\u5c31\u53ef\u4ee5\u6784\u9020\u51fa\u62c9\u683c\u6717\u65e5\u51fd\u6570\n$F(v_1,\\cdots,v_n,\\lambda)=f(v_1,\\cdots,v_n)+\\lambda \\left(g(v_1,\\cdots,v_n)\\right)$\n\n\u6c42\u5176\u6781\u503c.\n$\\text{d}F=0$\n\n\u5f97\u5230$n+1$\u4e2a\u5206\u91cf\u7684\u65b9\u7a0b.\n$$\\frac{\\partial F}{\\partial v_1}=0$$\n$$\\frac{\\partial F}{\\partial v_2}=0$$\n$$\\cdots \\cdots$$\n$$\\frac{\\partial F}{\\partial v_n}=0$$\n$$\\frac{\\partial F}{\\partial \\lambda}=0$$\n\n\u8fd9$n+1$\u4e2a\u65b9\u7a0b\u53ef\u7edf\u4e00\u8868\u793a\u6210\u4e00\u79cd\u5f62\u5f0f, \u5373\n$$\\frac{\\partial F}{\\partial v_i}=0\\text{\u548c}\\frac{\\partial F}{\\partial \\lambda}=0$$\n\u5728\u8fd9\u4e2a\u9898\u76ee\u4e2d\u53ef\u6839\u636e\u4e0a\u9762\u7684\u65b9\u7a0b\u6c42\u51fa$v_1,\\cdots,v_n,\\lambda$\u4ece\u800c\u5f97\u5230\u7b54\u6848.\n\n\n$$\\frac{\\partial F}{\\partial v_i}=(\\frac{s_i}{v_i})'+(\\lambda k_i(v_i-u_i)^2s_i)'=-\\frac{s_i}{v_i^2}+2\\lambda k_is_i(v_i-u_i)=0$$\n$$\\Rightarrow 2\\lambda k_i(v_i-u_i)k_i=1$$\n\u63a5\u4e0b\u6765\u5c31\u662f\u4e8c\u5206$\\lambda $\u7684\u503c,\u63a5\u7740\u6c42\u51fa$v_1,v_2,\\cdots,v_n$\u7684\u503c.\u7136\u540e\u5224\u65ad\u662f\u5426\u6ee1\u8db3$\\text{E=E}_u$\n\n\u8bf4\u5b9e\u8bdd, \u8fd9\u9053\u9898\u7684\u9700\u8981\u7684\u6570\u5b66\u7684\u96be\u5ea6\u8fdc\u8fdc\u5927\u4e8e\u4ee3\u7801\u96be\u5ea6.\u4ee3\u7801\u4e0d\u662f\u91cd\u70b9.\n#### \u4ee3\u7801\u5b9e\u73b0\n**\u5c0f\u6280\u5de7**: ***\u5b9e\u6570\u4e8c\u5206\u6700\u597d\u4e0d\u7528eps, \u4e8c\u5206\u4e2a50-100\u6b21\u57fa\u672c\u4e0a\u7cbe\u5ea6\u518d\u5927\u90fd\u591f\u4e86.***\n```c++\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#define N 500010\n#define inf 100000008\nusing namespace std;\n\nint n;\ndouble k[N],s[N],u[N],Eu,v[N];\n\nbool check(double a,double b,int i){\n    return 2.0*a*k[i]*b*b*(b-u[i])<=1.0?true:false;\n}\n\ndouble TwoPoint(int i,double lambda){\n    double l=max(u[i],0.0),r=inf,mid;\n    for(int j=1;j<=100;++j){\n        mid=(l+r)/2;\n        if(check(lambda,mid,i))l=mid;\n        else r=mid;\n    }\n    return mid;\n}\n\nbool Check(double mid){\n    double E=0;\n    for(int i=1;i<=n;++i)v[i]=TwoPoint(i,mid);\n    for(int i=1;i<=n;++i)E+=k[i]*s[i]*(v[i]-u[i])*(v[i]-u[i]);\n    return E>=Eu;\n}\n\nint main(){\n    scanf(\"%d\",&n);\n    scanf(\"%lf\",&Eu);\n    for(int i=1;i<=n;++i)\n        scanf(\"%lf%lf%lf\",&s[i],&k[i],&u[i]);\n    double l=0.0,r=inf,mid;\n    for(int j=1;j<=100;++j){\n        mid=(l+r)/2;\n        if(Check(mid))l=mid;\n        else r=mid;\n    }\n    double ans=0;\n    for(int i=1;i<=n;++i)\n        ans+=s[i]/v[i];\n    printf(\"%.8f\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1525834802,
        "uid": 39067,
        "name": "aiyougege",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2179 \u3010[NOI2012]\u9a91\u884c\u5ddd\u85cf\u3011"
    },
    {
        "content": "### \u9898\u610f\n\n\u5728\u6ee1\u8db3$\\sum_{i=1}^ns_ik_i(x_i-v_i)^2\\le E_U$\u7684\u6761\u4ef6\u4e0b\u6700\u5c0f\u5316$\\sum_{i=1}^n\\frac{s_i}{x_i}$\n\n---\n\n### \u9898\u89e3\n\n\u53ef\u4ee5\u8d2a\u5fc3\u5730\u60f3\u4e00\u5b9a\u662f\u5f53$\\sum_{i=1}^ns_ik_i(x_i-v_i)^2=E_U$\u65f6\u6700\u4f18\n\n\u56e0\u4e3a\u5982\u679c\u5c0f\u4e8e\u7684\u8bdd\u90a3\u4e48\u67d0\u4e2a$x_i$\u8fd8\u53ef\u4ee5\u5927\u4e00\u70b9,\u4f7f\u5f97\u7b54\u6848\u66f4\u5c0f\n\n\u6709\u9650\u5236\u7684\u6761\u4ef6\u6781\u503c\u901a\u5e38\u7528[\u62c9\u683c\u6717\u65e5\u4e58\u6570\u6cd5](https://blog.csdn.net/benoble_/article/details/79718758)\u6765\u89e3\u51b3\n\n\u8bbe$f(x_1,\\ldots,x_n)=\\sum_{i=1}^n\\frac{s_i}{x_i},g(x_1,\\ldots,x_n)=\\sum_{i=1}^ns_ik_i(x_i-v_i)^2=E_U$\n\n\u5728\u8fd9\u9898\u91cc\u9762\n\n$$\\frac{\\partial f+\\lambda g}{\\partial x_i}=-\\frac{s_i}{x_i^2}+2\\lambda s_ik_i(x_i-v_i)=0$$\n\n$$\\Rightarrow2\\lambda k_i(x_i-v_i)x_i^2-1=0$$\n\n$$\\Rightarrow\\lambda=\\frac1{2k_i(x_i-v_i)x_i^2}$$\n\n\u53ef\u4ee5\u770b\u51fa$\\lambda$\u662f\u5173\u4e8e$x_i$\u7684\u51fd\u6570\u662f\u4e00\u4e2a\u5355\u8c03\u51fd\u6570(\u4e0d\u7136\u6ca1\u6cd5\u6c42\u554a)\n\n\u800c\u4e14\u7531\u4e8e$x_i$\u4e00\u5b9a\u8981\u5927\u4e8e$v_i$\n\n(\u5982\u679c$x_i\\lt v_i$,\u6839\u636e$g$\u7684\u5f0f\u5b50\u53ef\u4ee5\u770b\u51fa\u4e00\u5b9a\u53ef\u4ee5\u627e\u5230\u4e00\u4e2a\u5bf9\u79f0\u7684$x_i'$\u4f7f\u5f97\u7b54\u6848\u66f4\u4f18,\u4e14\u4e0d\u8d85\u8fc7\u9650\u5236)\n\n\u53ef\u4ee5\u8ba4\u4e3a$g$\u5173\u4e8e$x_i$\u5355\u8c03\u9012\u589e,\u5373\u5173\u4e8e$\\lambda$\u5355\u8c03\u9012\u51cf\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4e8c\u5206$\\lambda$,\u7136\u540e\u518d\u89e3\u51fa$x_i$\n\n\u8fd9\u662f\u4e00\u4e2a\u5173\u4e8e$x_i$\u7684\u5355\u8c03\u9012\u589e\u7684\u51fd\u6570\n\n\u6240\u4ee5\u89e3$x_i$\u7684\u65b9\u6cd5\u53ef\u4ee5\u7528\u4e8c\u5206\u6cd5\u6216\u8005\u725b\u987f\u8fed\u4ee3\u6cd5\n\n```\n#include<bits/stdc++.h>\n#define fp(i,a,b) for(register int i=a,I=b+1;i<I;++i)\n#define fd(i,a,b) for(register int i=a,I=b-1;i>I;--i)\n#define go(u) for(register int i=fi[u],v=e[i].to;i;v=e[i=e[i].nx].to)\n#define file(s) freopen(s\".in\",\"r\",stdin),freopen(s\".out\",\"w\",stdout)\ntemplate<class T>inline bool cmax(T&a,const T&b){return a<b?a=b,1:0;}\ntemplate<class T>inline bool cmin(T&a,const T&b){return a>b?a=b,1:0;}\nusing namespace std;\nconst int N=1e4+5;\nconst double eps=1e-13,inf=1e5;\ntypedef double d;\nint n;d Eu,ans,s[N],k[N],x[N],v[N];\ninline d sqr(const d a){return a*a;}\ninline d bf(const int i,const d lb){\n\td L=max(v[i],0.0),R=inf,mid;\n\twhile(R-L>eps){\n\t\tmid=(L+R)*0.5;\n\t\tif(lb*k[i]*(mid-v[i])*sqr(mid)>1)R=mid;\n\t\telse L=mid;\n\t}return L;\n}\ninline bool chk(const d la){\n\td tp=0;\n\tfp(i,1,n)x[i]=bf(i,la);\n\tfp(i,1,n)tp+=k[i]*sqr(x[i]-v[i])*s[i];\n\treturn tp<Eu;\n}\nint main(){\n    #ifndef ONLINE_JUDGE\n        file(\"s\");\n    #endif\n    scanf(\"%d%lf\",&n,&Eu);\n    fp(i,1,n)scanf(\"%lf%lf%lf\",s+i,k+i,v+i);\n    d L=0,R=inf,mid;\n    while(R-L>eps){\n    \tmid=(L+R)*0.5;\n    \tif(chk(2*mid))R=mid;\n    \telse L=mid;\n    }\n    fp(i,1,n)ans+=s[i]/x[i];\n    printf(\"%.6lf\",ans);\nreturn 0;\n}\n```",
        "postTime": 1522165973,
        "uid": 20156,
        "name": "Kelin",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P2179 \u3010[NOI2012]\u9a91\u884c\u5ddd\u85cf\u3011"
    },
    {
        "content": "\u5148\u8bb2\u4e00\u8bb2\u62c9\u683c\u6717\u65e5\u4e58\u6570\u6cd5\uff1a\n\u62c9\u683c\u6717\u65e5\u4e58\u6570\u6cd5\u662f\u7528\u6765\u89e3\u51b3\u591a\u5143\u51fd\u6570\u7684\u6700\u4f18\u503c\u95ee\u9898\uff08\u6700\u5927\u3001\u6700\u5c0f\uff09\n\u4e00\u822c\u5f62\u5f0f\u4e3a\uff1a\u51fd\u6570$f(x_1,x_2,x_3..x_n)$\u6ee1\u8db3\u9650\u5236$g_i(x_1,x_2,x_3...x_n)=0,(i\\in 1,2,3....m)$  \n\u89e3\u6cd5\uff1a\u5b9a\u4e49$h(x_1,x_2,x_3...x_n,\\lambda_1,\\lambda_2,\\lambda_3...\\lambda_m)=f(x_1,x_2,x_3...x_n)+\\Sigma_{i=1}^m\\lambda_ig_i(x_1,x_2,x_3...x_n)$  \n\u51fd\u6570$h$\u7684\u6781\u503c\u5c31\u662f\u51fd\u6570$f$\u7684\u6700\u4f18\u503c\n$h$\u6781\u503c\u7528\u5bfc\u6570\u6c42  \n\n\u518d\u56de\u5230\u8fd9\u9053\u9898\uff0c\u53ea\u9700\u8981\u6ee1\u8db3\u4e00\u79cd\u9650\u5236\uff1a$g(x)=\\Sigma_{i=1}^n s_i\\ast k_i(x_i-v_i')^2\\leq Eu$\uff0c\u5e76\u4e14\uff0c\u5f53$g(x)=Eu$\u65f6\u6700\u4f18\uff1b\n\u4e8e\u662f\u5c31\u6709$g(x)$\u51fd\u6570\uff1a$g(x)=\\Sigma_{i=1}^n s_i\\ast k_i(x_i-v_i')^2-Eu=0$\n$f(x)$\u51fd\u6570\u4e3a\uff1a$f(x)=\\Sigma_{i=1}^n \\frac {s_i}{x_i}$\uff0c$x_i$\u4e3a\u6bcf\u6bb5\u8def\u7684\u9a91\u884c\u901f\u5ea6   \n\n\u5219$h(x)=\\Sigma_{i=1}^n \\frac{s_i}{x_i}+\\lambda\\ast\\Sigma s_i\\ast k_i(x_i-v_i')^2-Eu$  \n\u5c06\u5b83\u6c42\u5bfc\uff1a$h'(x)=-\\Sigma_{i=1}^n \\frac{s_i}{x_i^2}+2\\ast\\lambda\\ast\\Sigma_{i=1}^n s_i\\ast k_i(x_i-v_i')$\n\n\u4e8c\u5206\u6c42$h'(x)=0$\u65f6\u7684$x$\u503c\n\u4e8c\u5206\u65f6\u6bcf\u4e00\u4e2a$x_i$\u4e5f\u662f\u4e8c\u5206\u6c42\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\n#include<string>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<set>\n#include<bitset>\n#include<vector>\n#include<cstdlib>\n#define QAQ int\n#define TAT long long\n#define OwO bool\n#define ORZ double\n#define F(i,j,n) for(QAQ i=j;i<=n;++i)\n#define E(i,j,n) for(QAQ i=j;i>=n;--i)\n#define MES(i,j) memset(i,j,sizeof(i))\n#define MEC(i,j) memcpy(i,j,sizeof(j))\nusing namespace std;\nconst QAQ N=10005;\nQAQ n;\nORZ m;\nstruct data{\n    ORZ s,k,v;\n}a[N];\nORZ l,r,ans,v[N];\nOwO pd(ORZ lmd){\n    F(i,1,n){\n        ORZ l=a[i].v,r=1000000,ans=0;\n        F(j,1,100){\n            ORZ mid=(l+r)/2.0;\n            if(2*lmd*a[i].k*mid*mid*(mid-a[i].v)<=1.0) l=mid,ans=mid;\n            else r=mid;\n        }\n        v[i]=ans;\n    }\n    ORZ ans=0;\n    F(i,1,n) ans+=a[i].k*(v[i]-a[i].v)*(v[i]-a[i].v)*a[i].s;\n    return ans>=m;\n}\nQAQ main(){\n    scanf(\"%d%lf\",&n,&m);\n    F(i,1,n) scanf(\"%lf%lf%lf\",&a[i].s,&a[i].k,&a[i].v);\n    l=0;r=10000000;\n    F(i,1,100){\n        ORZ mid=(l+r)/2.0;\n        if(pd(mid)) l=mid;\n        else r=mid;\n    }\n    F(i,1,n) ans+=a[i].s/v[i];\n    printf(\"%.6lf\\n\",ans);\n    return 0;\n}\n```\n",
        "postTime": 1516706175,
        "uid": 36170,
        "name": "Fheiwn",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2179 \u3010[NOI2012]\u9a91\u884c\u5ddd\u85cf\u3011"
    },
    {
        "content": "**\u672c\u9898\u89e3\u7740\u91cd\u4e8e\u7406\u89e3\u638c\u63e1\u62c9\u683c\u6717\u65e5\u4e58\u6570\u6cd5\u7684\u5e94\u7528\uff01\uff01**\n\n# \u9898\u610f\n\u5728\u6ee1\u8db3 $\\sum_{i=1}^{n} {k_{i} \\times s_{i} \\times (v_{i} - v_{i}{}' )^2} \\le E_{U} $ \u7684\u6761\u4ef6\u4e0b\uff0c\n\u4f7f\u5f97 $\\sum_{i=1}^{n} {\\frac{s_{i}}{v{i}} } $ \u6700\u5c0f\uff0c\n\u5176\u4e2d $k_{i},s_{i},v_{i}{}'$ \u4e3a\u7ed9\u5b9a\u7684\u5e38\u6570\uff0c\u672a\u77e5\u91cf\u5c31\u662f $v_{i}$\u3002\n\n# \u5206\u6790\n\n\u5176\u5b9e\u5b66\u8fc7\u62c9\u683c\u6717\u65e5\u4e58\u6570\u6cd5\u7684\u5df2\u7ecf\u80fd\u770b\u51fa\u6765\u4e86\uff0c\u6c42\u8fd9\u79cd\u591a\u5143\u51fd\u6570\u7684\u6781\u503c\uff0c\u6709\u4e86\u7ed9\u5b9a\u7684\u7ea6\u675f\u6761\u4ef6\uff0c\u76f4\u63a5\u62c9\u4e58\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u90a3\u4e48**\u62c9\u683c\u6717\u65e5\u4e58\u6570\u6cd5**\u662f\u4ec0\u4e48\u5462\uff1f\n\n\u9996\u5148\u4f60\u5f97\u5b66\u4f1a\u5bfc\u6570([\u4f20\u9001\u95e8](http://www.gaosan.com/gaokao/244831.html)\uff09\uff0c\u53ea\u9700\u8981\u8bb0\u4f4f\u51e0\u4e2a\u57fa\u672c\u51fd\u6570\u7684\u6c42\u5bfc\u6cd5\u5219\u5c31\u884c\u4e86\uff0c\u6bd4\u5982\u5e42\u51fd\u6570\uff0c\u6307\u6570\u51fd\u6570\uff0c\u5bf9\u6570\u51fd\u6570\uff0c$sin$\uff0c$cos$\uff0c\u518d\u5b66\u4f1a\u51fd\u6570\u52a0\u548c\u3001\u4e58\u79ef\u3001\u4f5c\u6bd4\u7684\u6c42\u5bfc\u6cd5\u5219\uff0c\u57fa\u672c\u591f\u7528\u4e86\u3002\n\n\u5176\u5b9e\u4ece\u9ad8\u7b49\u6570\u5b66\u7684\u89d2\u5ea6\u6765\u8bb2\uff0c~~\u6211\u4e0d\u4f1a~~\uff0c\u5982\u679c\u597d\u5947\u53ef\u4ee5\u53bb[\u8fd9\u91cc](https://zhuanlan.zhihu.com/p/449683167)\u3002\n\n \u6240\u4ee5\u4ece\u901a\u4fd7\u89d2\u5ea6\u6765\u8bb2\uff0c\u6211\u4eec\u53ea\u9700\u8981\u638c\u63e1\u5957\u8def\uff0c\u77e5\u9053\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u6c42\u6781\u503c\u5c31\u884c\u4e86\u3002\n\n \u90a3\u4e48\u5957\u8def\u662f\u4ec0\u4e48\u5462\uff1f\n\n\u9996\u5148\u9898\u4e2d\u7ed9\u51fa\u4e86**\u7ea6\u675f\u6761\u4ef6**\uff0c\u4e5f\u5c31\u662f\u672a\u77e5\u91cf\u7684\u4e00\u4e2a\u7b49\u5f0f\uff0c\u5728\u672c\u9898\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u8d2a\u5fc3\u7684\u60f3\uff1a\n\n\u6211\u4eec\u6d88\u8017\u7684\u4f53\u529b\u8d8a\u591a\uff0c\u80af\u5b9a\u8dd1\u7684\u8d8a\u5feb\uff0c\u4e5f\u5c31\u662f\u90a3\u4e2a\u5f0f\u5b50\u8d8a\u5c0f\u3002\n\n\u6240\u4ee5\u6211\u4eec\u4e0d\u59a8\u4ee4\u7ea6\u675f\u6761\u4ef6\u4e3a $\\sum_{i=1}^{n} {k_{i} \\times s_{i} \\times (v_{i} - v_{i}{}' )^2} = E_{U}$\u3002\n\n\u63a5\u4e0b\u6765\u5f15\u51fa\u62c9\u683c\u6717\u65e5\u4e58\u6570\u6cd5\u6700\u6838\u5fc3\u7684\u90e8\u5206\uff1a\n\n \u6211\u4eec\u8981\u6c42\u4e0a\u9762\u5f0f\u5b50\u7684\u6781\u503c\uff0c\u5c31\u8981\u5f15\u5165\u4e00\u4e2a $\\lambda $\uff0c\n\n\u7136\u540e\u5f97\u5230\u8fd9\u6837\u7684\u4e00\u4e2a\u51fd\u6570\uff1a\n\n$\\sum_{i=1}^{n} {\\frac{s_{i}}{v{i}} }  + \\lambda (\\sum_{i=1}^{n} {k_{i} \\times s_{i} \\times (v_{i} - v_{i}{}' )^2} - E_{U})$\n\n\u89c2\u5bdf\u4e00\u4e0b\u662f\u600e\u4e48\u5f97\u6765\u7684\uff1f\n\n\u9996\u5148\u628a\u8981\u6c42\u6781\u503c\u7684\u5f0f\u5b50\u6284\u8fc7\u6765\uff0c\u518d\u5199\u4e00\u4e2a $\\lambda$\uff0c\u518d\u7528\u5b83\u4e58\u4e0a\u7ea6\u675f\u6761\u4ef6\u7684\u91cf\u90fd\u79fb\u9879\u5230\u5de6\u8fb9\u7684\u6837\u5b50\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u8981\u5bf9\u8fd9\u4e2a\u51fd\u6570\u4e2d\u7684\u6bcf\u4e00\u4e2a\u53d8\u91cf\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u8981\u6c42\u7684 $v_{i}$ \u548c $\\lambda$\uff0c\u6c42**\u504f\u5bfc**\u3002\n\n\u201c\u504f\u5bfc\u662f\u4ec0\u4e48\uff1f\u6211\u4e0d\u4f1a\u554a\u554a\u554a\uff01\uff01\uff01\u201d\n\n\u201c\u4e0d\uff0c\u4f60\u4f1a\uff01\u201d\n\n\u504f\u5bfc\u5176\u5b9e\u5c31\u662f\u53ea\u8003\u8651**\u5f53\u524d\u4e00\u4e2a**\u53d8\u91cf\uff0c\u628a\u5176\u4ed6\u6240\u6709\u7684**\u65e0\u5173\u53d8\u91cf**\u4ee5\u53ca\u539f\u6709\u7684\u5e38\u91cf**\u7edf\u4e00**\u8ba4\u4e3a\u662f**\u5e38\u91cf**\uff0c\u7136\u540e\u6c42\u5bfc\u3002\n\n\u6240\u4ee5\u6211\u4eec\u63a8\u5bfc\u7406\u89e3\u4e00\u4e0b\uff1a\n\n\u5bf9\u4e8e $v_{i}$\uff1a\n\n\u9996\u5148\u5ffd\u7565\u4e0e\u4ed6\u65e0\u5173\u7684\u5e38\u6570\u5f0f\u5b50\uff0c\u5f97\u5230:\n\n${\\frac{s_{i}}{v_{i}} }  + \\lambda \\times {k_{i} \\times s_{i} \\times (v_{i} - v_{i}{}' )^2}$\n\n\u6b64\u65f6\u8fdb\u884c\u6c42\u5bfc\uff0c\u53ef\u4ee5\u5f97\u5230:\n\n$-\\frac{s_{i}}{v_{i}^ {2}}  + 2\\times \\lambda \\times {k_{i} \\times s_{i} \\times (v_{i} - v_{i}{}' )}$\n\n\u6ce8\u610f\u8fd9\u91cc\u6709\u4e2a\u5c0f\u6280\u5de7\u5c31\u662f \n\n\u5982\u679c $f(x) = (x + b)^2$ \u90a3\u4e48 $ f{}'(x) = 2(x + b)$\uff0c\u624b\u63a8\u4e00\u4e0b\u5c31\u77e5\u9053\u4e86\u3002\n\n\u63a5\u4e0b\u6765\u5bf9 $\\lambda$ \u6c42\u5bfc\u5c31\u6ca1\u4ec0\u4e48\u4e86\uff0c\u628a\u7cfb\u6570\u6284\u4e0b\u6765\u5c31OK:\n\n$\\sum_{i=1}^{n} {k_{i} \\times s_{i} \\times (v_{i} - v_{i}{}' )^2} - E_{U}$\n\n\u4f17\u6240\u5468\u77e5\uff0c\u51fd\u6570\u6c42\u6781\u503c\u5728\u5bfc\u51fd\u6570\u7684\u96f6\u70b9\u5904\u53d6\u5f97\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u8ba9\u6240\u6709\u7684 $v_{i}$ \u8fd8\u6709 $\\lambda$ \u90fd\u4f7f\u5f97\u4ed6\u4eec\u7684\u5bfc\u51fd\u6570\u4e3a $0$\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u6240\u6c42\u7684\u5f0f\u5b50\u7684\u6781\u503c\uff0c\u5728\u6211\u4eec\u6c42\u504f\u5bfc\u5f97\u51fa\u7684\u6240\u6709\u5f0f\u5b50\u540c\u65f6\u4e3a $0$ \u65f6\u53d6\u5f97\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u600e\u4e48\u6c42\uff1a\n\n\u9996\u5148\u6211\u4eec\u53d1\u73b0\uff0c\u76f4\u63a5\u627e\u6bcf\u4e00\u4e2a $v_{i}$\uff0c\u5982\u540c\u6211\u4eec\u8131\u88e4\u5b50\u653e\u5c41\uff0c\u662f\u4e0d\u53ef\u884c\u7684\u3002\n\n\u6211\u4eec\u770b\u770b\u5bf9 $v_{i}$ \u5bfc\u6570\u7684\u5f0f\u5b50\u53ef\u4ee5\u5f97\u5230\u4ec0\u4e48\uff1f\n\n$2\\times \\lambda \\times {k_{i} \\times {v_{i}^2} \\times (v_{i} - v_{i}{}' )} = 1$ \n\n\u975e\u5e38\u6ef4amazing\u554a\uff0c\u8fd9\u4e0d\u53cd\u6bd4\u4f8b\u5417\uff1f\n\n\u5f53\u7136\u4e0d\u5168\u662f\uff0c\u81f3\u5c11\u6211\u4eec\u80af\u5b9a\u80fd\u770b\u51fa\u6765\u968f\u7740 $\\lambda$ \u9012\u589e\uff0c$v_{i}$ \u80af\u5b9a\u9012\u51cf\uff0c\u4e14\u8fd9\u4e2a\u65f6\u5019\u7684 $v_{i}$ \u6700\u4fbf\u4e8e\u786e\u5b9a\u3002\n\n\u597d\uff01\u90a3\u5c31\u4e8c\u5206 $\\lambda$ \u5427\uff01\n\n\u7136\u540e\u5728\u4e8c\u5206\u7b54\u6848\u7684\u65f6\u5019\uff0c\u5728\u91cc\u9762\u4e8c\u5206 $v_{i}$ \u5c31\u597d\u4e86\uff0c\u56e0\u4e3a\u5185\u5916\u90fd\u6709\u5355\u8c03\u6027\uff0c\u90fd\u53ef\u4ee5\u4e8c\u5206\uff0c\u8fd9\u6837\u6211\u4eec\u80af\u5b9a\u80fd\u903c\u8fd1\u5230\u6240\u6709\u65b9\u7a0b\u90fd\u4e3a $0$ \u4e5f\u5c31\u662f\u53d6\u5230\u6781\u503c\u7684\u65f6\u5019\u5566\u3002\n\n\u4ee3\u7801\u90e8\u5206\uff0c\u5176\u5b9e\u548c\u4e4b\u524d\u7684\u795e\u7287\u597d\u50cf\u90fd\u5dee\u4e0d\u591a\u5566\uff0c\u91cd\u5728\u7406\u89e3\u5b66\u4e60\uff01\n\n[\u4ee3\u7801\u5728\u8fd9\u91cc~](https://www.luogu.com.cn/paste/qj9q4e0a)\n\n\u7ba1\u7406\u5927\u5927\u6c42\u8fc7qwq\u3002",
        "postTime": 1650528583,
        "uid": 141058,
        "name": "Xu_brezza",
        "ccfLevel": 0,
        "title": "P2179 [NOI2012] \u9a91\u884c\u5ddd\u85cf"
    },
    {
        "content": "\u6700\u5c0f\u5316\n\n$$F(\\mathrm v)=\\sum \\frac{\\mathrm s^i}{\\mathrm v^i}$$\n\n\u5f53\n\n$$G(\\mathrm v)=\\sum \\mathrm k^i\\mathrm s^i(\\mathrm v^i-\\mathrm v'^i)^2-E_U=0$$\n\n\u4f7f\u7528 Lagrange \u4e58\u5b50\u6cd5\u3002\u4ee4 $H: \\mathbb R^n\\times \\mathbb R\\to \\mathbb R$ \u4e3a\n\n$$H(\\mathrm v, \\lambda)=F(\\mathrm v)-\\lambda G(\\mathrm v)$$\n\n\u5219\u9700\u8981\u6ee1\u8db3\n\n$$\\mathrm DH=0$$\n\n\u624d\u80fd\u6ee1\u8db3 $G$ \u7684\u9650\u5236\uff0c\u4e14 $F$ \u53d6\u5230\u4e34\u754c\u70b9\u3002\n\n$$\\frac{\\partial H}{\\mathrm v^i}=-\\frac {\\mathrm s^i}{(\\mathrm v^i)^2}-2\\lambda\\mathrm k^i\\mathrm s^i(\\mathrm v^i-\\mathrm v'^i)$$\n\n$$\\frac{\\partial H}{\\lambda}=-\\sum \\mathrm k^i\\mathrm s^i(\\mathrm v^i-\\mathrm v'^i)^2$$\n\n\u4e5f\u5c31\u662f\u89e3\u65b9\u7a0b\n\n$$\\begin{cases}A(\\mathrm v, \\lambda)=-\\frac {\\mathrm s^i}{(\\mathrm v^i)^2}-2\\lambda\\mathrm k^i\\mathrm s^i(\\mathrm v^i-\\mathrm v'^i)=0\\\\ B(\\mathrm v)=-\\sum \\mathrm k^i\\mathrm s^i(\\mathrm v^i-\\mathrm v'^i)^2=0\\end{cases}$$\n\n\u4e00\u5f0f\u5f97\uff1a\n\n$$\\lambda=\\frac 1{2\\mathrm k^i}(\\mathrm v^i)^2(\\mathrm v^i-\\mathrm v'^i)$$\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6240\u6709\u7684 $\\frac 1{2\\mathrm k^i}(\\mathrm v^i)^2(\\mathrm v^i-\\mathrm v'^i)$ \u5e94\u8be5\u76f8\u540c\u3002\u5728\u8fd9\u4e2a\u6761\u4ef6\u4e0b\uff0c\u6211\u4eec\u8fd8\u8981\u6c42\u5176\u6ee1\u8db3\u4e8c\u5f0f\u3002\n\n\u6839\u636e\u9690\u51fd\u6570\u5b9a\u7406\u53d1\u73b0\u4e00\u5f0f\u4e2d $\\frac{\\partial \\mathrm v^i}{\\partial \\lambda} > 0$\uff0c\u4e14\u4e8c\u5f0f\u4e2d $\\frac{\\partial B}{\\partial \\mathrm v^i} > 0$\u3002\u6545 $\\frac{\\partial B}{\\partial \\lambda}>0$\u3002\u5bf9 $\\lambda$ \u4e8c\u5206\u5373\u53ef\u3002",
        "postTime": 1649754400,
        "uid": 49093,
        "name": "_sys",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P2179 [NOI2012] \u9a91\u884c\u5ddd\u85cf"
    }
]
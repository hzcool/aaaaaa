[
    {
        "content": "\u539f\u9898\u94fe\u63a5\uff1a[P6094 [JSOI2015]\u5708\u5730](https://www.luogu.com.cn/problem/P6094)\n\n## \u9898\u610f\u7b80\u8ff0\n\n- \u628a\u4e00\u5757 $n \\times m$ \u7684\u5730\u5206\u7ed9\u4e24\u4e2a\u4eba\uff0c\u9009\u62e9\u5206\u51fa\u7b2c $i$ \u884c\u7b2c $j$ \u5217\u7684\u5730\u53ef\u4ee5\u83b7\u5f97 $a_{i,j}$ \u7684\u6536\u76ca\u3002\n\n- \u8981\u5728\u4e24\u4e2a\u4eba\u5206\u5230\u7684\u5730\u4e2d\u95f4\u5efa\u5899\uff0c\u4f7f\u5f97\u4e24\u4e2a\u4eba\u5206\u5230\u7684\u5730\u5b8c\u5168\u9694\u79bb\uff0c\u5efa\u4e24\u4e2a\u683c\u5b50\u4e4b\u95f4\u7684\u5899\u9700\u8981\u82b1\u8d39\u4e00\u5b9a\u4ee3\u4ef7\u3002\n\n- \u6700\u5927\u5316\u603b\u6536\u76ca\u4e0e\u603b\u4ee3\u4ef7\u7684\u5dee\n\n- $1 \\le n, m \\le 200$\n\n- ~~\u7ec6\u8282\u8fd8\u662f\u89c1\u539f\u9898\u5427QAQ~~\n\n## \u601d\u8def\u4e0e\u89e3\u7b54\n\n- ~~\u4f60\u770b\u5b83\u6570\u636e\u8303\u56f4\u8fd9\u4e48\u5c0f\u80af\u5b9a\u662f\u4e2a\u56fe\u8bba\u5efa\u6a21\uff0c\u800c\u4e14\u5927\u6982\u7387\u7f51\u7edc\u6d41~~\n\n- \u4f60\u770b\u8fd9\u9898\u76f8\u5f53\u4e8e\u8981\u628a\u5730\u5206\u6210\u4e24\u5757\uff0c\u5e76\u4e14\u4ee3\u4ef7\u6700\u5c0f\u3002\n\n- \u90a3\u5c31\u662f\u4e00\u4e2a\u6700\u5c0f\u5272\u561b\n\n- \u7136\u540e\u8003\u8651\u600e\u4e48\u5efa\u56fe\n\n- \u4f60\u5728\u5efa\u56fe\u65f6\u9700\u8981\u4fdd\u8bc1\u80fd\u9009\u6216\u4e0d\u9009\u4e00\u5757\u5730\uff0c\u5e76\u4e14\u8981\u80fd\u591f\u201c\u5272\u201d\u5f00\u4e24\u5757\u5c5e\u4e8e\u4e0d\u540c\u7684\u4eba\u7684\u5730\n\n- \u5047\u8bbe\u4e24\u4e2a\u4eba\u5206\u522b\u4e3a A \u548c B\uff0c\u90a3\u4e48\u9996\u5148\u628a\u76f8\u90bb\u4e24\u5757\u5730\u4e4b\u95f4\u8fde\u8fb9\uff0c\u6d41\u91cf\u4e3a\u5efa\u5899\u7684\u82b1\u8d39\uff0c\u8868\u793a\u5982\u679c\u8981\u201c\u5272\u201d\u5f00\u8fd9\u4e24\u5757\u5730\u5c31\u8981\u780d\u6389\u8fd9\u6761\u8fb9\uff0c\u5f53\u7136\u8981\u4e0d\u8981\u780d\u518d\u8bf4\uff1b\u6ce8\u610f\u8fd9\u91cc\u65e0\u6cd5\u4fdd\u8bc1\u4f60\u8981\u600e\u4e48\u201c\u5272\u201d\uff0c\u6240\u4ee5\u4e24\u5757\u5730\u8981**\u5206\u522b**\u5411\u5bf9\u65b9\u8fde\u8fb9\u3002\n\n- \u90a3\u4e48\u4e4b\u540e\u5efa\u4e00\u4e2a\u8d85\u7ea7\u6e90\u70b9 $S$\uff0c\u628a $S$ \u548c\u6240\u6709 A \u60f3\u8981\u7684\u5730\u8fde\u8fb9\uff0c\u6d41\u91cf\u4e3a\u8fd9\u5757\u5730\u7684\u6536\u76ca\uff0c\u5982\u679c\u5728\u6743\u8861\u4e4b\u540e\u4e0d\u9009\uff0c\u5c31\u628a\u8fd9\u6761\u8fb9\u201c\u5272\u201d\u6389\uff1b\u540c\u7406\uff0c\u628a\u6240\u6709 B \u60f3\u8981\u7684\u5730\u548c\u8d85\u7ea7\u6c47\u70b9 $T$ \u8fde\u8fb9\uff0c\u6d41\u91cf\u4e5f\u4e3a\u8fd9\u5757\u5730\u7684\u6536\u76ca\u3002\n\n- \u90a3\u4e48\u4f60\u5728\u8fd9\u5f20\u56fe\u4e2d\u8dd1\u4e00\u904d\u6700\u5c0f\u5272\uff0c\u5f97\u5230\u7684\u7ed3\u679c\u5c31\u662f\u4f60\u9700\u8981**\u4ed8\u51fa\u7684\u6700\u5c0f\u4ee3\u4ef7**\uff0c\u8fd9\u91cc\u662f\u5305\u62ec\u4e86\u9009\u6216\u8005\u4e0d\u9009\u4e00\u5757\u5730\u3002\n\n- \u6240\u4ee5\u4f60\u53ea\u9700\u8981\u628a\u603b\u6536\u76ca\uff0c\u5373**\u6240\u6709\u7ed3\u70b9\u7684\u6536\u76ca\u548c\u51cf\u53bb\u6700\u5c0f\u5272**\u5373\u53ef\u3002\n\n- \u6700\u540e\uff0c\u4f60\u53ea\u9700\u8981\u77e5\u9053\u6700\u5c0f\u5272\u7b49\u4e8e\u6700\u5927\u6d41\uff0c\u5c31\u53ef\u4ee5\u6109\u5feb\u7684\u5207\u9898\u4e86\n\n## Code \n\n```cpp\n#include <cstdio>\n#include <queue>\n#include <iostream>\n#include <cstring>\n#define abs(x) (x<0?-x:x)\n\nusing namespace std;\n\nconst int MAXN = 80010;\nconst int INF = 0x3f3f3f3f; \n\nint n, m;\n\ninline int id(int i, int j){return (i-1)*m+j;}\n\nstruct edge{\n\tint ne, to, fl;\n\tedge(int N=0,int T=0,int F=0):ne(N),to(T),fl(F){}\n}e[MAXN*6];\nint fir[MAXN], num = 1;\nint s, t;\ninline void adde(int a, int b, int c)\n{\n\te[++num] = edge(fir[a], b, c);\n\tfir[a] = num;\n}\ninline void join(int a, int b, int c)\n{\n\tadde(a, b, c);\n\tadde(b, a, 0);\n}\n\nint dep[MAXN], cur[MAXN];\nqueue<int> q;\nbool bfs(int s, int t)\n{\n\tfor(int i=0;i<=n*m+1;i++)\n\t\tdep[i] = 0, cur[i] = fir[i];\n\twhile(!q.empty()) q.pop();\n\tq.push(s);\n\tdep[s] = 1;\n\twhile(!q.empty())\n\t{\n\t\tint u = q.front();\n\t\tq.pop();\n\t\tfor(int i=fir[u];i;i=e[i].ne)\n\t\t{\n\t\t\tint v = e[i].to;\n\t\t\tif(dep[v] || !e[i].fl) continue;\n\t\t\tdep[v] = dep[u] + 1;\n\t\t\tq.push(v);\n\t\t}\n\t}\n\treturn dep[t];\n}\nint dfs(int u, int fln)\n{\n\tif(u == t) return fln;\n\tint res = 0;\n\tfor(int& i=cur[u];i;i=e[i].ne)\n\t{\n\t\tint v = e[i].to;\n\t\tif(!e[i].fl || dep[v] != dep[u]+1) continue;\n\t\tint sum = dfs(v, min(fln, e[i].fl));\n\t\te[i].fl -= sum;\n\t\te[i^1].fl += sum;\n\t\tfln -= sum;\n\t\tres += sum;\n\t\tif(!fln) break;\n\t}\n\tif(!res) dep[u] = 0;\n\treturn res;\n}\ninline int dinic()\n{\n\tint res = 0;\n\twhile(bfs(s, t)) res += dfs(s, INF);\n\treturn res;\n}\n\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\ts = 0; t = n*m+1;\n\tint sum = 0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=m;j++)\n\t\t{\n\t\t\tint a;\n\t\t\tscanf(\"%d\",&a);\n\t\t\tif(a > 0) join(s, id(i, j), a);\n\t\t\tif(a < 0) join(id(i, j), t, -a);\n\t\t\tsum += abs(a);\n\t\t}\n\t}\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tfor(int j=1;j<=m;j++)\n\t\t{\n\t\t\tint a;\n\t\t\tscanf(\"%d\",&a);\n\t\t\tjoin(id(i, j), id(i+1, j), a);\n\t\t\tjoin(id(i+1, j), id(i, j), a);\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<m;j++)\n\t\t{\n\t\t\tint a;\n\t\t\tscanf(\"%d\",&a);\n\t\t\tjoin(id(i, j), id(i, j+1), a);\n\t\t\tjoin(id(i, j+1), id(i, j), a);\n\t\t}\n\t}\n\tprintf(\"%d\\n\",sum-dinic());\n\treturn 0;\n}\n```",
        "postTime": 1595865092,
        "uid": 151601,
        "name": "Aphros",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6094 \u3010[JSOI2015]\u5708\u5730\u3011"
    },
    {
        "content": "# **\u3010\u9898\u89e3\u3011\u5708\u5730 [JSOI2015] [P6094] [Bzoj4485]**\n\n[$\\mathcal{My}\\ \\mathcal{Blog}$](https://www.cnblogs.com/Xing-Ling/p/12713249.html)\n\n\u4f20\u9001\u95e8\uff1a[\u5708\u5730 $\\text{[JSOI2015] [P6094]}$](https://www.luogu.com.cn/problem/P6094) [$\\text{[Bzoj4485]}$](http://www.lydsy.com/JudgeOnline/problem.php?id=4485)\n\n## **\u3010\u5206\u6790\u3011**\n\n\u4e00\u9053\u7070\u5e38\u7b80\u5355\u7684\u7f51\u7edc\u6d41\u3002\n\n\u8bbe\u7acb\u8d85\u6e90\u548c\u8d85\u6c47\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u4f4d\u7f6e $(i,j)$\uff1a\n\n- \u82e5 $a>0$\uff0c\u8d85\u6e90\u5411 $(i,j)$ \u8fde\u4e00\u6761\u5bb9\u91cf\u4e3a $a$ \u7684\u8fb9\n\n- \u82e5 $a<0$\uff0c$(i,j)$ \u5411\u8d85\u6c47\u8fde\u4e00\u6761\u5bb9\u91cf\u4e3a $-a$ \u7684\u8fb9\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u5899\uff0c\u5728\u88ab\u5b83\u9694\u79bb\u7684\u4e24\u4e2a\u4f4d\u7f6e\u4e4b\u95f4\u5206\u522b\u5411\u5bf9\u65b9\u8fde\u4e00\u6761\u5bb9\u91cf\u4e3a\u9020\u5899\u4ef7\u683c\u7684\u8fb9\u3002\n\n\u6700\u540e\u7b54\u6848\u4e3a $\\sum |a|$ \u51cf\u53bb \u6700\u5c0f\u5272\u3002\n\n\u8fd9\u9898 $Dinic$ \u53ef\u4ee5\u7a33\u8fc7\uff0c\u5199 $EK$ \u4f1a\u88ab\u5361\u5230 $70pts$\u3002\n\n## **\u3010Code\u3011**\n\n```cpp\n#include<algorithm>\n#include<cstring>\n#include<cstdio>\n#define LL long long\n#define Re register int\nusing namespace std;\nconst int N=160010,M=N*5,inf=2e9;\nint n,m,x,st,ed,ans;\ninline void in(Re &x){\n    int f=0;x=0;char c=getchar();\n    while(c<'0'||c>'9')f|=c=='-',c=getchar();\n    while(c>='0'&&c<='9')x=(x<<1)+(x<<3)+(c^48),c=getchar();\n    x=f?-x:x;\n}\nstruct Dinic{\n    int o,h,t,maxflow,Q[N],dis[N],cur[N],head[N];\n    Dinic(){o=1;}\n    struct QAQ{int to,next,flow;}a[M<<1];\n    inline void add_(Re x,Re y,Re flow){a[++o].to=y,a[o].flow=flow,a[o].next=head[x],head[x]=o;}\n    inline void add(Re x,Re y,Re flow){add_(x,y,flow),add_(y,x,0);}\n    inline int bfs(Re st,Re ed){\n        for(Re i=0;i<=ed;++i)dis[i]=0,cur[i]=head[i];\n        h=1,t=0,Q[++t]=st,dis[st]=1;\n        while(h<=t){\n            Re x=Q[h++];\n            for(Re i=head[x],to;i;i=a[i].next)\n                if(a[i].flow&&!dis[to=a[i].to]){\n                    dis[to]=dis[x]+1,Q[++t]=to;\n                    if(to==ed)return 1;\n                }\n        }\n        return 0;\n    }\n    inline int dfs(Re x,Re flow){\n        if(x==ed||!flow)return flow;\n        Re tmp=0,to,f;\n        for(Re i=cur[x];i;i=a[i].next){\n            cur[x]=i;\n            if(dis[to=a[i].to]==dis[x]+1&&(f=dfs(to,min(flow-tmp,a[i].flow)))){\n                a[i].flow-=f,a[i^1].flow+=f,tmp+=f;\n                if(flow==tmp)break;\n            }\n        }\n        return tmp;\n    }\n    inline void dinic(Re st,Re ed){while(bfs(st,ed))maxflow+=dfs(st,inf);}\n}T1;\ninline int Poi(Re i,Re j){return (i-1)*m+j;}\nint main(){\n//    freopen(\"123.txt\",\"r\",stdin);\n    in(n),in(m),st=n*m+1,ed=st+1;\n    for(Re i=1;i<=n;++i)\n        for(Re j=1;j<=m;++j){\n            in(x),ans+=(x>0?x:-x);\n            if(x>0)T1.add(st,Poi(i,j),x);\n            if(x<0)T1.add(Poi(i,j),ed,-x);\n        }\n    for(Re i=1;i<n;++i)\n        for(Re j=1;j<=m;++j)\n            in(x),T1.add(Poi(i,j),Poi(i+1,j),x),T1.add(Poi(i+1,j),Poi(i,j),x);\n    for(Re i=1;i<=n;++i)\n        for(Re j=1;j<m;++j)\n            in(x),T1.add(Poi(i,j),Poi(i,j+1),x),T1.add(Poi(i,j+1),Poi(i,j),x);\n    T1.dinic(st,ed),printf(\"%d\\n\",ans-T1.maxflow);\n}\n```\n",
        "postTime": 1587022568,
        "uid": 110985,
        "name": "\u8fb0\u661f\u51cc",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P6094 \u3010[JSOI2015]\u5708\u5730\u3011"
    },
    {
        "content": "###  1. \u7b97\u6cd5\u5206\u6790\uff1a\n\n  \u9898\u76ee\u8981\u6c42\u6211\u4eec\u628a\u56fe\u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\uff0c\u518d\u52a0\u4e0a\u6570\u636e\u8303\u56f4\uff0c\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u6700\u5c0f\u5272\u3002\n\n\u800c\u6839\u636e~~\u6211\u4e0d\u4f1a\u7684~~\u8bc1\u660e\u53ef\u77e5\uff0c\u6700\u5c0f\u5272\u7528\u6700\u5927\u6d41\u8dd1\u5c31\u884c\u4e86\u3002\n\n\n\n------------\n\n\n### 2.\u5efa\u56fe\uff1a\n\n  \u5bf9\u4e8e\u7b2c\u4e00\u7ec4 $n*m$ \u7684\u8f93\u5165\uff0c\u6211\u4eec\u60f3\u5230\u53ef\u4ee5\u5efa\u7acb\u8d85\u7ea7\u6e90\u70b9\u548c\u8d85\u7ea7\u6c47\u70b9\uff0c\u5206\u522b\u4e0e\u4e24\u4f4d\u4e70\u5bb6\u8fde\u4e00\u6761\u6d41\u91cf\u4e3a $a$ \u7684\u8fb9\uff0c\u5e76\u7528 $sum$ \u8bb0\u5f55 $a$ \u7684**\u7edd\u5bf9\u503c**\u4e4b\u548c\u3002\n  \n  \u5bf9\u4e8e\u7b2c\u4e8c\u7ec4 $(n-1)*m$ \u4e2a\u8f93\u5165\uff0c\u6211\u4eec\u5c06\u7b2c $i$ \u4e2a\u70b9\u4e0e\u7b2c $i+1$ \u4e2a\u70b9\u8fde\u4e00\u6761\u6d41\u91cf\u4e3a $a[i][j]$ \u7684\u8fb9\uff0c\u5bf9\u4e8e\u5bf9\u4e8e\u7b2c\u4e09\u7ec4 $n*(m-1)$ \u4e2a\u8f93\u5165\uff0c\u6211\u4eec\u5c06\u7b2c $j$ \u4e2a\u70b9\u4e0e\u7b2c $j+1$ \u4e2a\u70b9\u4e5f\u8fde\u4e00\u6761\u6d41\u91cf\u4e3a $a[i][j]$ \u7684\u8fb9\u3002\n  \n  \u5f88\u663e\u7136\uff0c\u6700\u5927\u6d41\uff08\u5373\u4e3aJYY\u51fa\u7684\u51a4\u6789\u94b1\uff09\u7531\u4e8e\u8fde\u63a5\u6e90\u6c47\u70b9\u7684\u8fb9\u7684\u6d41\u91cf\u9650\u5236\uff0c\u4f1a\u5c0f\u4e8e\u4ed6\u5356\u51fa\u623f\u5b50\u6070\u7684\u94b1\uff0c\u6700\u540e\u5c06 $sum$ \u51cf\u53bb $ans$ \u8f93\u51fa\u5373\u4e3a\u6700\u7ec8\u7684\u7b54\u6848\u3002\n  \n### 3.Code:\n\n  \u8fd9\u91cc\u7528\u7684\u662f **Dinic**\u3002\n  \n```\n#include<bits/stdc++.h>\nconst int N=5e5+10;\nconst int inf=0x3f3f3f3f;\ninline int read(){\n\tint x=0,w=1;\n\tchar ch=getchar();\n\tfor(;ch>'9'||ch<'0';ch=getchar()) if(ch=='-') w=-1;\n\tfor(;ch<='9'&&ch>='0';ch=getchar()) x=(x<<1)+(x<<3)+ch-'0';\n\treturn x*w;\n}\nint n,m,tot=1,head[N],s,t;\nint dep[N],ans,sum;\nstruct node{\n\tint nxt,to,val;\n}e[N];\ninline void add(int u,int v,int w){\n\te[++tot].to=v;\n\te[tot].val=w;\n\te[tot].nxt=head[u];\n\thead[u]=tot;\n\te[++tot].to=u;\n\te[tot].val=0;\n\te[tot].nxt=head[v];\n\thead[v]=tot;\n}\ninline bool bfs(){\n\tmemset(dep,0,sizeof(dep));\n\tstd::queue<int> Q;\n\tdep[s]=1;\n\tQ.push(s);\n\twhile(!Q.empty()){\n\t\tint u=Q.front();Q.pop();\n\t\tfor(register int i=head[u];i;i=e[i].nxt){\n\t\t\tint v=e[i].to;\n\t\t\tif(e[i].val&&!dep[v]){\n\t\t\t\tdep[v]=dep[u]+1;\n\t\t\t\tQ.push(v);\n\t\t\t}\n\t\t}\n\t}\n\treturn dep[t];\n}\nint dfs(int u,int in){\n\tif(u==t) return in;\n\tint out=0;\n\tfor(register int i=head[u];i&&in;i=e[i].nxt){\n\t\tint v=e[i].to;\n\t\tif(e[i].val&&dep[v]==dep[u]+1){\n\t\t\tint res=dfs(v,std::min(e[i].val,in));\n\t\t\te[i].val-=res;e[i^1].val+=res;\n\t\t\tin-=res;out+=res;\n\t\t}\n\t}\n\tif(!out) dep[u]=0;\n\treturn out;\n}\nvoid dinic(){\n\twhile(bfs()) ans+=dfs(s,inf);\n}\ninline int p(int x,int y){\n\treturn (x-1)*m+y;\n}\nsigned main(){\n\tn=read(),m=read();\n\ts=n*m+1,t=s+1;\n\tfor(register int i=1,x;i<=n;i++){\n\t\tfor(register int j=1;j<=m;j++){\n\t\t\tx=read();\n\t\t\tint v=p(i,j);\n\t\t\tif(x<0) add(s,v,-x);\n\t\t\telse if(x>0) add(v,t,x);\n\t\t\tsum+=abs(x);\n\t\t}\n\t}\n\tfor(register int i=1,x;i<n;i++){\n\t\tfor(register int j=1;j<=m;j++){\n\t\t\tx=read();\n\t\t\tint u=p(i,j),v=p(i+1,j);\n\t\t\tadd(u,v,x);\n\t\t\tadd(v,u,x);\n\t\t}\n\t}\n\tfor(register int i=1,x;i<=n;i++){\n\t\tfor(register int j=1;j<m;j++){\n\t\t\tx=read();\n\t\t\tint u=p(i,j),v=p(i,j+1);\n\t\t\tadd(u,v,x);\n\t\t\tadd(v,u,x);\n\t\t}\n\t}\n\tdinic();\n\tprintf(\"%d\\n\",sum-ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1652097885,
        "uid": 467203,
        "name": "Kaenbyou_Rin",
        "ccfLevel": 0,
        "title": "P6094 [JSOI2015]\u5708\u5730 \u9898\u89e3"
    },
    {
        "content": "\u9898\u89e3\u8fd9\u4e48\u5c11\u554aqwq\n\n~~\u5148\u819c @\u8fb0\u661f\u51cc \u5927\u4f6c~~\n\n[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P6094)\n\n## Solution\n\n[\u601d\u8def\u6e90\uff08\u5f31\u5316\u7248\uff09](https://www.luogu.com.cn/problem/P2598)\n\n##### \u7b97\u6cd5\n\n\u8fd9\u5c31\u662f\u7f51\u7edc\u6d41\u6ca1\u8dd1\u4e86\u5427\n\n\u90a3\u6211\u5c31\u8dd1\u6700\u5927\u6d41\n\n\u54a6\uff1f\u53d1\u73b0\u6ca1\u529e\u6cd5\u9009\u554a\n\n\u90a3\u6211\u5c31\u6765\u6700\u5c0f\u5272\u4e86\uff0c\u53cd\u6b63 \u6b63\u96be\u5219\u53cd \u561b\n\n##### \u5efa\u8fb9\n\n\u600e\u4e48\u5efa\u8fb9\uff1f\n\n- $a>0$ $add(s,i,a)$\n- $a<0$ $add(i,t,-a)$\n- $a=0$ \u5565\u90fd\u4e0d\u5e72\n\n\u7136\u540e\u628a\u6240\u6709\u56f4\u5899\u90fd\u5efa\u8d77\u6765\uff0c\u5373\n\n- $add(id(i,j),id(i,j+1),w)$ $add(id(i,j+1),id(i,j),w)$\n- $add(id(i,j),id(i+1,j),w)$ $add(id(i+1,j),id(i,j),w)$\n\n\u6ce8\u610f\u56f4\u5899\u4e0a\u4e0b\u6216\u5de6\u53f3\u4e00\u5b9a\u8981\u53cc\u5411\u5efa\u8fb9\uff0c\u56e0\u4e3a\u5272\u7684\u65f6\u5019\u80af\u5b9a\u8981\u4e24\u8fb9\u90fd\u5272\u6389\n\n##### \u5272\u8fb9\u7684\u542b\u4e49\n\n- \u5411\u6e90\u6c47\u70b9\u7684\u8fb9\n\n\u5272\u6389\u4e86\u5c31\u662f\u4e0d\u4e70\u4e86\u561b\uff0c\u7559\u4e0b\u4e86\u7684\u5c31\u662f\u5bf9\u7b54\u6848\u4ea7\u751f\u8d21\u732e\u7684\u561b\n\n- \u8868\u793a\u5899\u7684\u8fb9\n\n\u5272\u6389\u4e86\u5c31\u662f\u5efa\u5899\u561b\uff0c\u56e0\u4e3a\u5efa\u5899\u4e24\u5bb6\u4eba\u5c31\u4e0d\u8fde\u901a\u4e86\u561b\uff08\u6700\u5c0f\u5272\u7684\u76ee\u6807\u5c31\u662f\u6e90\u6c47\u65ad\u5f00\u6765\u561b\uff09\n\n##### \u7b54\u6848\u7684\u7edf\u8ba1\n\n\u600e\u4e48\u8ba1\u7b97\u603b\u6d41\u91cf\uff08\u5c31\u662f\u62ff\u53bb\u51cf\u6700\u5c0f\u5272\u7684\u603b\u548c\u7684\u503c\uff09\u5462\uff1f\n\n\u6211\u5c31\u628a\u6240\u6709\u8fb9\u6743\u5c31\u52a0\u8d77\u6765\u4e0d\u5c31\u53ef\u4ee5\u4e86\n\n\u54a6\uff1f\u600e\u4e48\u53c8\u4e0d\u5bf9\u554a\n\n\u56e0\u4e3a\u6211\u4eec\u5272\u6389\u7684\u5899\u90fd\u662f\u8981\u5efa\u7684\uff0c\u7559\u4e0b\u4e86\u7684\u90fd\u662f\u4e0d\u5efa\u7684\u5899\uff0c\u6240\u4ee5\u6700\u5c0f\u5272\u4e2d\u5899\u7684\u90e8\u5206\u662f\u4e0d\u80fd\u5148\u52a0\u8d77\u6765\u7684\uff0c\u5efa\u5899\u53ea\u4f1a\u82b1\u94b1\u4e0d\u4f1a\u8d5a\u94b1\u554a\n\n\u4e5f\u5c31\u662f\u8fd9\u4e2a\u603b\u6d41\u91cf\u5c31\u662f\u6240\u6709\u623f\u5b50\u5356\u4ef7\u7684\u7edd\u5bf9\u503c\u7684\u548c\n\n\u7136\u540e\u5c31AC\u4e86\n\n## code\n\n```cpp\n#include<cstdio>\n#include<cmath>\n#include<queue>\n#define maxn 160010\n#define inf 1e9\n#define min(A,B) A<B?A:B\nusing namespace std;\nstruct edge{\n    int nex,v,w;\n}edge[maxn<<4];\nint head[maxn],top=1,cur[maxn];\nint n,m,s,t,ans=0,maxflow=0;\nbool vs=0;\nint vis[maxn],deep[maxn];\nvoid addedge(int u,int v,int w)\n{\n    edge[++top].v=v;\n    edge[top].w=w;\n    edge[top].nex=head[u];\n    head[u]=top;\n}\nvoid add(int u,int v,int w){addedge(u,v,w),addedge(v,u,0);}\nbool bfs()\n{\n    for(int i=0;i<=t;i++) cur[i]=head[i],deep[i]=inf,vis[i]=0;\n    deep[s]=0;\n    queue<int> q;\n    q.push(s);\n    while(!q.empty())\n    {\n        int u=q.front();\n        q.pop();\n        vis[u]=0;\n        for(int i=cur[u];i;i=edge[i].nex)\n        {\n        \tcur[u]=i;\n            int v=edge[i].v;\n            if(deep[u]+1<deep[v]&&edge[i].w)\n            {\n                deep[v]=deep[u]+1;\n                if(!vis[v])\n                {\n                    q.push(v);\n                    vis[v]=1;\n                }\n            }\n        }\n    }\n    if(deep[t]!=inf) return 1;\n    return 0;\n}\nint dfs(int u,int lowest)\n{\n    int rlow=0;\n    if(u==t)\n\t{\n\t\tvs=1;\n\t\tmaxflow+=lowest;\n\t\treturn lowest;\n\t } \n\tint used=0;\n    for(int i=head[u];i;i=edge[i].nex)\n    {\n        int v=edge[i].v;\n        if(edge[i].w&&deep[u]+1==deep[v])\n        {\n            if((rlow=dfs(v,min(lowest-used,edge[i].w))))\n            {\n            \tused+=rlow;\n                edge[i].w-=rlow;\n                edge[i^1].w+=rlow;\n                if(used==lowest) break;\n            }\n            \n        }\n    }\n    return used;\n } \nvoid Dinic(){maxflow=0;while(bfs()) dfs(s,inf);}//\u6a21\u677f\u6765\u7684\nint gid(int x,int y){return m*(x-1)+y;}\nint main()\n{\n    scanf(\"%d%d\",&n,&m);\n    s=0,t=n*m+1;\n    for(int i=1,w;i<=n;i++)\n    \tfor(int j=1;j<=m;j++)\n    \t{\n    \t\tscanf(\"%d\",&w);\n    \t\tif(w>0) add(s,gid(i,j),w);\n    \t\tif(w<0) add(gid(i,j),t,-w);\n    \t\tans+=w>0?w:-w; \t//ans\u4e3a\u603b\u6d41\u91cf\n\t\t}\n        //\u4ee5\u4e0b\u662f\u5efa\u5899\u7684\u8fb9\n\tfor(int i=1,w;i<n;i++)\n\t\tfor(int j=1;j<=m;j++)\n\t\t\tscanf(\"%d\",&w),add(gid(i,j),gid(i+1,j),w),add(gid(i+1,j),gid(i,j),w);\n\tfor(int i=1,w;i<=n;i++)\n\t\tfor(int j=1;j<m;j++)\n\t\t\tscanf(\"%d\",&w),add(gid(i,j),gid(i,j+1),w),add(gid(i,j+1),gid(i,j),w);\n    Dinic();\n    printf(\"%d\",ans-maxflow);//\u603b\u6d41\u91cf-\u6700\u5c0f\u5272\n    return 0;\n } \n```\n~~\u8fd9\u5c31\u53ef\u4ee5\u6e9c\u4e86~~",
        "postTime": 1587132032,
        "uid": 144523,
        "name": "JohnJoeZhu",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P6094 \u3010[JSOI2015]\u5708\u5730\u3011"
    }
]
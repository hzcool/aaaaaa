[
    {
        "content": "\u6570\u636e\u8303\u56f4\uff1a$1 \\le k \\le n \\le 3 \\times 10^6,1 \\le S \\le 3 \\times 10^{17}$\u3002\n\n\u9996\u5148\u539f\u6765\u7684\u505a\u6cd5\u663e\u7136\u7528\u4e0d\u4e86\u4e86\u3002\u6211\u4eec\u8003\u8651\u627e\u4e00\u4e0b dSG \u51fd\u6570\uff08\u5373\u4ece SG \u503c\u5bf9\u5e94\u56de\u6700\u5c11\u77f3\u5b50\u6570\u7684\u51fd\u6570\uff09\u7684\u6027\u8d28\u3002\n\n\u6211\u4eec\u53d1\u73b0\u6570\u5217\u957f\u8fd9\u6837\uff08\u79f0\u4e3a\u6570\u5217 $0$\uff0c\u4e0b\u6807\u4ece $0$ \u5f00\u59cb\uff0c\u5176\u4f59\u6570\u5217\u4e0b\u6807\u5747\u4ece $1$ \u5f00\u59cb\uff09\uff1a\n\n$$0,4,11,20,32,46,62,80,100,123,148,\\dots$$\n\n\u5dee\u5206\u4e00\u4e0b\uff08\u5f97\u5230\u7684\u6570\u5217\u79f0\u4e3a\u6570\u5217 $1$\uff09\uff1a\n\n$$4,7,9,12,14,16,18,20,23,25,\\dots$$\n\n\u518d\u5dee\u5206\u4e00\u4e0b\uff08\u5f97\u5230\u7684\u6570\u5217\u79f0\u4e3a\u6570\u5217 $2$\uff09\uff1a\n\n$$3,2,3,2,2,2,2,3,2,\\dots$$\n\n\u53d1\u73b0\u6570\u5217 $2$ \u91cc\u5168\u662f $2$ \u6216 $3$\u3002\u591a\u7b97\u4e00\u4e9b\u4f1a\u53d1\u73b0\u5f53\u6211\u4eec\u4ee5\u6bcf\u4e2a $3$ \u4e3a\u7ed3\u5c3e\u5e26\u4e0a\u524d\u9762\u8fde\u7eed\u4e00\u4e9b $2$ \u7ec4\u6210\u4e00\u4e9b\u6bb5\u540e\uff0c\u8fd9\u4e9b\u6bb5\u7684\u957f\u5ea6\u5206\u522b\u662f $1,2,5,10,21,42,85,170,\\dots$\uff0c\u5373\u4e8c\u8fdb\u5236\u8868\u793a\u4e0b\u4e3a $0$ \u4e0e $1$ \u76f8\u95f4\u7684\u6570\u3002\u6211\u4eec\u8bbe\u7b2c $i$ \u4e2a\u8fd9\u6837\u7684\u6570\u4e3a $x_i$\u3002\n\n\u9996\u5148\u6211\u4eec\u5c1d\u8bd5\u89e3\u6570\u5217 $1$ \u7684\u901a\u5f0f\u3002\u7531\u4e8e\u6570\u5217 $2$ \u91cc\u53ea\u6709 $3$ \u548c $2$\uff0c\u6211\u4eec\u8003\u8651\u628a\u6570\u5217 $1$ \u91cc\u7684\u6570\u8868\u793a\u6210 $2a_i+b_i$ \u7684\u5f62\u5f0f\uff0c\u4ee4 $a_1=2,b_1=0$\u3002\u5219\u5bf9\u4e8e\u6bcf\u4e2a $i$ \u6709 $a_{i+1}=a_i+1$\uff0c\u5bf9\u4e8e\u6570\u5217 $2$ \u4e2d\u7b2c $i$ \u4e2a\u6570\u4e3a $3$ \u7684 $i$ \u6709 $b_{i+1}=b_i+1$\uff0c\u5426\u5219\u6709 $b_{i+1}=b_i$\u3002\n\n\u4ee4 $S_i$ \u4e3a $x_i$ \u7684\u524d\u7f00\u548c\uff0c\u5219\u5f53\u4e14\u4ec5\u5f53 $i=S_j$ \u6709\u6570\u5217 $2$ \u4e2d\u7b2c $i$ \u4e2a\u6570\u4e3a $3$\u3002\u4e8e\u662f $a_i=i+1$\uff0c$b_i=\\max\\{j:S_j \\le i\\}-1$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5206\u522b\u6c42 $a_i$ \u548c $b_i$ \u7684\u524d\u7f00\u548c\u5f97\u5230\u6570\u5217 $0$ \u4e2d\u7684\u6570\u3002\u8bbe\u6570\u5217 $0$ \u4e2d\u4e0b\u6807\u4e3a $i$ \u7684\u662f $2c_i+d_i$\uff0c\u5219 $c$ \u4e3a $a$ \u7684\u524d\u7f00\u548c\uff0c$d$ \u4e3a $b$ \u7684\u524d\u7f00\u548c\u3002\u56e0\u6b64\u6709\n\n$$c_v=\\sum_{i=1}^{v}a_i$$\n\n$$=\\sum_{i=1}^{v}(i+1)$$\n\n$$=\\dfrac{v(v+3)}{2}$$\n\n$$d_v=\\sum_{i=1}^{v}b_i$$\n\n$$=\\sum_{i=1}^{v}(\\max\\{j:S_j \\le i\\}-1)$$\n\n\u4ee4 $t=\\max\\{j:S_j \\le v\\}$\uff0c\u5219\u4e0a\u5f0f\n\n$$=t(v-S_t)+\\sum_{j=1}^{t}(j-1)x_j$$\n\n$$=\\sum_{i=1}^{t}(v-S_t)+\\sum_{j=1}^{t}\\sum_{i=1}^{j-1}x_j$$\n\n$$=\\sum_{i=1}^{t}\\left(v-S_t+\\sum_{j=i+1}^{t}x_j\\right)$$\n\n$$=\\sum_{i=1}^{t}(v-S_i)$$\n\n\u4ee4 $T_i$ \u4e3a $S_i$ \u7684\u524d\u7f00\u548c\uff0c\u5219 $d_v=tv-T_t$\u3002\n\n\u56e0\u6b64\u6570\u5217 $0$ \u7684\u7b2c $v$ \u9879\u4e3a $\\operatorname{dSG}(v)=2c_v+d_v=v^2+(3+t)v-T_t$\u3002\u7531\u4e8e $\\operatorname{dSG}(v)$ \u4e0d\u51cf\uff0c\u5e76\u4e14 $S_t \\le v < S_{t+1}$\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u8981\u4e8c\u5206\u51fa\u6700\u5927\u7684 $S_t^2+(3+t)S_t-T_t \\le s$ \u7684 $t$\uff0c\u518d\u6c42\u51fa\u6ee1\u8db3 $v^2+(3+t)v-T_t \\le s$ \u7684\u6700\u5927 $v$\uff0c\u90a3\u4e48 $v$ \u5c31\u662f $s$ \u7684 SG \u503c\u3002\u524d\u9762\u7684\u4e8c\u5206\u662f $O(\\log\\log{S})$ \u7684\uff0c\u540e\u9762\u6c42 $k$ \u7531\u4e8e\u5de6\u8fb9\u662f\u4e8c\u6b21\u51fd\u6570\u4e14\u5f00\u53e3\u671d\u4e0a\uff0c\u53ef\u4ee5\u76f4\u63a5\u89e3\u51fa\u65b9\u7a0b\u6b63\u6839\u7136\u540e\u4e0b\u53d6\u6574\uff0c\u663e\u7136\u5c31\u662f\u6240\u6c42\u3002\u8fd9\u4e00\u6b65\u662f $O(n\\log\\log{S})$ \u7684\u3002\n\n\u7136\u540e\u7531\u4e8e\u66b4\u529b\u6c42\u6bcf\u4e2a\u4e8c\u8fdb\u5236\u4f4d\u4e0a\u6570\u503c\u548c\u662f $O(n\\log{S})$ \u7684\uff0c\u4f1a\u88ab\u5361\uff0c\u6240\u4ee5\u8981\u4f18\u5316\uff08\u5982\u679c\u60a8\u80fd\u5361\u8fc7\u53bb\u53ef\u4ee5\u79c1\u4fe1\u6211\uff09\u3002\u4ee5\u4e0b\u4f18\u5316\u65b9\u6848\u7531\u6c38\u8fdc\u6ef4\u795e @[tiger2005](https://www.luogu.com.cn/user/60864) \u63d0\u51fa\u3002\uff08\u636e\u8bf4\u662f\u5e38\u89c1 trick\uff1f\u662f\u6211\u4e0d\u884c\uff09\n\n\u8003\u8651\u5206\u6cbb\u8ba1\u7b97\u8d21\u732e\u3002\u8bbe\u6240\u6709 SG \u503c\u6700\u5927\u7684\u4e8c\u8fdb\u5236\u4f4d\u6570\u4e3a $m$\uff0c\u6211\u4eec\u628a\u6bcf\u4e2a\u6570\u7684\u4e8c\u8fdb\u5236\u62c6\u6210 $w$ \u6bb5\uff0c\u6bcf\u6bb5\u4e0d\u8d85\u8fc7 $\\left\\lceil\\dfrac{m}{w}\\right\\rceil$ \u4f4d\u3002\uff08\u5c3d\u53ef\u80fd\u5e73\u5747\u5206\uff0c\u4e3a\u7b80\u4fbf\u63a5\u4e0b\u6765\u7701\u7565\u4e0a\u53d6\u6574\u7b26\u53f7\uff09\n\n\u5bf9\u4e8e\u6bcf\u6bb5\uff0c\u5148\u5c06\u6bcf\u4e2a\u6570\u8fd9\u4e00\u6bb5\u4e2d\u4e8c\u8fdb\u5236\u4f4d\u5bf9\u5e94\u7684\u6240\u6709\u53ef\u80fd\u53d6\u503c\u51fa\u73b0\u6b21\u6570\u7528\u4e00\u4e2a\u4e0b\u6807\u4e3a $[0,2^{\\frac{m}{w}})$ \u7684\u6876\u5b58\u8d77\u6765\u3002\u5982 $\\dfrac{m}{w}=5$\uff0c\u67d0\u4e2a\u6570\u7684\u4e8c\u8fdb\u5236\u7b2c $5 \\sim 9$ \u4f4d\u4e3a $01011$\uff0c\u5219\u5c06 $11$ \u4f4d\u7684\u8ba1\u6570\u5668\u52a0\u4e0a $1$\uff0c\u7c7b\u4f3c\u5904\u7406\u3002\n\n\u7136\u540e\u5bf9\u4e8e\u8fd9 $2^{\\frac{m}{w}}$ \u4e2a\u6570\u66b4\u529b\u679a\u4e3e\u6bcf\u4e2a\u6570\u4e8c\u8fdb\u5236\u8868\u793a\u91cc\u9762 $1$ \u7684\u4f4d\u7f6e\u8ba1\u7b97\u8d21\u732e\u3002\n\n\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(w(n+2^{\\frac{m}{w}-1}))$\uff0c\u7531\u4e8e SG \u503c\u4e0d\u8d85\u8fc7 $\\sqrt{S}$\uff0c\u53d6 $w=2$ \u65f6\u590d\u6742\u5ea6\u662f $O(n+S^{\\frac{1}{4}}\\log{S})$ \u7684\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n\\log\\log{S}+S^{\\frac{1}{4}}\\log{S})$\u3002\n\nCode:\n```cpp\n#include<cmath>\n#include<cstdio>\n#define rg register\n#define ll long long\n#define lb(x) (x&(-x))\ninline char gc()\n{\n\tstatic char buf[1048576],*pn=buf,*pe=buf;\n\treturn (pn==pe)&&(pe=(pn=buf)+fread(buf,1,1048576,stdin),pn==pe)?EOF:*pn++;\n}\ninline int read()\n{\n\tint x=0;\n\tchar cc=gc();\n\twhile(cc<'0'||cc>'9')cc=gc();\n\twhile(cc>='0'&&cc<='9')x=x*10+cc-'0',cc=gc();\n\treturn x;\n}\ninline ll _read()\n{\n\tll x=0;\n\tchar cc=gc();\n\twhile(cc<'0'||cc>'9')cc=gc();\n\twhile(cc>='0'&&cc<='9')x=x*10+cc-'0',cc=gc();\n\treturn x;\n}\nll S,s;\nint n,k;\nint t,w,m;\nint v,flag;\nll ssmv[37];\nint cnt[37],pw2[17];\nint x[37],sm[37],ssm[37];\nint cnt1[32773],cnt2[32773];\nint ans1[32773],ans2[32773];\nint main()\n{\n\tn=read(),k=read()+1,S=_read();\n\twhile(1ll<<(m<<1)<=S)++m;\n\t--m,t=(m>>1)+1,w=(1<<t)-1;\n\tpw2[0]=x[1]=sm[1]=ssm[1]=1;\n\tfor(rg int i=1;i<t;++i)pw2[i]=(pw2[i-1]<<1);\n\tfor(rg int i=2;i<=m;++i)\n\t{\n\t\tx[i]=(x[i-1]<<1)|(i&1),sm[i]=sm[i-1]+x[i];\n\t\tssm[i]=ssm[i-1]+sm[i],ssmv[i]=(sm[i]+3ll+i)*sm[i]-ssm[i];\n\t}\n\tfor(rg int i=0,l,r,mid;i<n;++i)\n\t{\n\t\ts=_read(),l=0,r=m;\n\t\twhile(l<r)mid=r-((r-l)>>1),(ssmv[mid]<=s)?(l=mid):(r=mid-1);\n\t\tv=int((sqrt((l+3)*(l+3)+((s+ssm[l])<<2))-l-3)/2),++cnt1[v&w],++cnt2[v>>t];\n\t}\n\tfor(rg int i=0;i<=w;++i)\n\t{\n\t\tfor(rg int j=i;j;j^=lb(j))\n\t\t{\n\t\t\tans1[lb(j)]+=cnt1[i];\n\t\t}\n\t}\n\tfor(rg int i=0;i<t;++i)cnt[i]=ans1[pw2[i]];\n\tfor(rg int i=0;i<=w;++i)\n\t{\n\t\tfor(rg int j=i;j;j^=lb(j))\n\t\t{\n\t\t\tans2[lb(j)]+=cnt2[i];\n\t\t}\n\t}\n\tfor(rg int i=0;i<t;++i)cnt[i+t]=ans2[pw2[i]];\n\tfor(rg int i=0;i<=m;++i)(cnt[i]%k)&&(flag=1);\n\tputs((flag)?\"YES\":\"NO\");\n\treturn 0;\n}\n```\n\n\u5173\u4e8e\u89e3\u6cd5\u4e2d\u5173\u4e8e $2,3$ \u4e2a\u6570\u7684\u7ed3\u8bba\u6211\u8fd8\u6ca1\u6709\u627e\u5230\u4e00\u4e2a\u8bc1\u660e\uff08\u4f46\u662f\u8dd1\u5b8c\u6574\u4e2a\u6570\u636e\u8303\u56f4\u9a8c\u8bc1\u786e\u5b9e\u6682\u65f6\u6ca1\u6709\u51fa\u9519\uff09\uff0c\u5982\u679c\u6709\u795e\u4ed9\u627e\u5230\u4e86\u8bc1\u660e\u65b9\u6cd5\u6216\u4e3e\u51fa\u4e86\u53cd\u4f8b\u6b22\u8fce\u79c1\u4fe1\u6211\u3002~~\u5982\u679c\u8bc1\u660e\u5f88\u7b80\u5355\u8bf7\u987a\u5e26\u628a\u6211\u8fd9\u4e2a\u5783\u573e\u7206\u8e29\u4e00\u987f~~",
        "postTime": 1619761955,
        "uid": 59388,
        "name": "VinstaG173",
        "ccfLevel": 7,
        "title": "\u4e16\u754c\u672a\u672b\u65e5 \u52a0\u5f3a\u7248 \u9898\u89e3"
    }
]
[
    {
        "content": "6^8\\*70\u7206\u641c\u662f\u5bb9\u6613\u7684\uff0c\n\n\u96be\u5ea6\u5728\u4e8e\u5982\u4f55\u5229\u7528\u6bcf\u4e2a\u70b9\u76f8\u90bb\u7684\u70b9\u7684\u7f16\u53f7\u5f97\u5230\u6bcf\u4e2a\u70b9\u7684\u5750\u6807\u3002\n\n\u7528(x,y,z)\u8868\u793a\u5728\u5e73\u9762\u4e0a\u5750\u6807(x,y)\uff0c\u9ad8\u5ea6z\u7684\u70b9\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u627e\u4e00\u4e2a\u5ea6\u6570\u4e3a3\u7684\u70b9\uff0c\u628a\u4ed6\u5f53\u6210(1,1,1)\u3002\n\n\u5047\u5982\u5f97\u5230\u9ad8\u5ea6\u4e3a1\u7684\u90a3\u4e00\u5c42\u5e73\u9762\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4e00\u5c42\u5c42\u63a8\u4e0a\u53bb\u3002\n\n\u8003\u8651\u5982\u4f55\u4ece\u5f53\u524d1-a,1-a\u8fd9\u6837\u7684\u4e00\u4e2a\u6b63\u65b9\u5f62\u6269\u5c55\u6210a+1\u7684\u3002\n\n\u9ad8\u5ea6\u4e3a1\u7684\u70b9\u7684\u7279\u70b9\u662f\u5ea6\u6570=4(\u5982\u679c\u5728\u8fb9\u7f18\u4e0a)\u62165\uff0c\u800c\u4e0a\u9762\u7684\u70b9\u7684\u5ea6\u6570\u662f5\u62166\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5148\u7528\u539f\u6765\u5ea6\u6570=4\u7684\u4e24\u4e2a\u70b9\u627e\u51fa\u73b0\u5728\u5ea6\u6570=4\u7684\u4e24\u4e2a\u70b9\uff0c\n\n\u4e4b\u540e\u4ece\u4ed6\u4eec\u5f00\u59cbbfs,\u53ea\u6709\u5f53\u4e00\u4e2a\u70b9\u6709\u4e24\u4e2a\u5df2\u8bbf\u95ee\u7684\u76f8\u90bb\u70b9\u65f6\u624d\u8bbf\u95ee\u5b83\u3002\n\n\u8fd8\u6709\u4e00\u70b9\uff0c\u5c31\u662f\u8bfb\u5165\u65f6\u4f60\u4e0d\u77e5\u9053\u8981\u8bfb\u51e0\u4e2a\uff0c\u5fc5\u987b\u8bfb\u5230\u6362\u884c\u4e3a\u6b62\uff0c\n\n\u4e8e\u662f\u6211\u76f4\u63a5\u7528\u4e86\u8bfb\u5165\u4f18\u5316\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing std::swap;\n\nconst int A=75,N=A*A*A+5;\nint a,n,x,y;\nint mn=1e9,mx=0;\nint g[N],du[N],link[N][7];\nstruct point\n{\n    int x,y,z;\n}p[N];\nint have[N];//\u6709\u591a\u5c11\u4e2a\u5df2\u8bbf\u95ee\u7684\u76f8\u90bb\u70b9 \n\nnamespace kcz\n{\n    const int ch_top=10000000;\n    char ch[ch_top],*p=ch;\n    void read(int &x)\n    {\n        while(*p<'0') ++p;\n        for(x=*p-'0';*++p>='0';) x=(x<<1)+(x<<3)+*p-'0';\n    }\n    void init()\n    {\n        ch[fread(ch,1,ch_top,stdin)]='\\n';\n    }\n    void init(int x)\n    {\n        read(g[x]);\n        int &i=du[x];\n        for(;;++i)\n        {\n            for(;*p<'0';++p)  \n            if(*p=='\\n') return ;\n            read(link[x][i]);\n        }\n    }\n};\n\nint q[N],head,tail;\n\nvoid Add(int x)\n{\n    for(int i=0,y;i<du[x];++i) \n    if(++have[y=link[x][i]]==2&&!p[y].x) q[++tail]=y;\n}\nvoid get(int x)\n{\n    int p1=0,p2,i;\n    for(i=0,y;i<du[x];++i) \n    if(p[y=link[x][i]].x) \n     if(!p1)p1=y;\n     else {p2=y;break;}\n    if(p[p1].x>p[p2].x) swap(p1,p2);\n    p[x]=(point){p[p2].x,p[p1].y,1};\n}\n\nconst int fx[6]={0,0,0,0,1,-1},fy[6]={0,0,1,-1,0,0},fz[6]={1,-1,0,0,0,0};\nint dy[A][A][A],mark[N],to;\nbool ok(int x)\n{\n    return x>0&&x<=a;\n}\nvoid dfs(int num,int ans)\n{\n    if(num>tail) \n    {\n      if(ans<mn)mn=ans;\n      if(ans>mx)mx=ans;    \n      return;\n    }\n    int k=q[num];\n    for(int i=0;i<6;++i)\n    {\n        int x=p[k].x,y=p[k].y,z=p[k].z,sum=0;\n        while(to=dy[x][y][z])\n        {\n            if(++mark[to]==1) sum+=g[to]; \n            x+=fx[i];y+=fy[i];z+=fz[i];\n        }\n        dfs(num+1,ans+sum);\n        x=p[k].x;y=p[k].y;z=p[k].z;\n        while(to=dy[x][y][z])\n        {\n           --mark[to];\n            x+=fx[i];y+=fy[i];z+=fz[i];\n        }\n    }\n}\n\nint main()\n{\n    freopen(\"1.in\",\"r\",stdin);\n    kcz::init();\n    kcz::read(a);n=a*a*a;\n    int i;\n    for(i=1;i<=n;++i) \n     kcz::init(i);\n    \n    for(i=1;du[i]!=3;++i);\n    p[i]=(point){1,1,1};Add(q[tail=1]=i);\n    p[q[++tail]=link[i][0]]=(point){1,2,1};\n    p[q[++tail]=link[i][1]]=(point){2,1,1};\n    Add(q[2]);Add(q[3]);\n    p[q[4]]=(point){2,2,1};\n    Add(q[4]);\n\n    int len=2,need,t0;\n    for(head=2;len<a;++len)\n    {\n        if(len==a-1) need=3;\n        else need=4;\n          x=q[head];\n          for(int i=0,y;i<du[x];++i) \n          if(du[y=link[x][i]]==need&&!p[y].x) \n          {\n               p[y]=(point){1,len+1,1};\n               q[++tail]=y;\n               break;\n          }\n          x=q[head+1];\n          for(int i=0,y;i<du[x];++i) \n          if(du[y=link[x][i]]==need&&!p[y].x) \n          {\n               p[y]=(point){len+1,1,1};\n               q[++tail]=y;\n               break;\n          }\n        head=tail-1;\n        for(int k=head;;++k)\n        {\n            x=q[k];\n            Add(x);\n            if(k==tail) break;\n            get(q[tail]);\n        }\n    }\n    \n    for(head=1;head<=tail;)\n    {\n        t0=tail;\n        for(;head<=t0;++head) \n        {\n            x=q[head];\n            for(i=0;y=link[x][i];++i)\n            if(!p[y].x) \n            {\n                q[++tail]=y;\n                p[y]=(point){p[x].x,p[x].y,p[x].z+1};\n                break;\n            }\n        }\n    }\n    \n    tail=0;\n    for(i=1;i<=n;++i)\n    {\n      dy[p[i].x][p[i].y][p[i].z]=i;\n      if(!g[i]) q[++tail]=i;\n    }\n    dfs(1,0);\n    printf(\"%d %d\\n\",mn,mx);\n}\n```",
        "postTime": 1490355002,
        "uid": 9168,
        "name": "kczno1",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3342 \u3010[ZJOI2014]\u7480\u707f\u5149\u534e\u3011"
    },
    {
        "content": "\u9996\u5148\uff0c\u4ecb\u7ecd\u4e00\u4e0bc++ stl\u91cc\u7684\u795e\u7269\u2014\u2014`stringstream`\u3002\n\n\u8fd9\u4e1c\u897f\u80fd\u50cf`cin`\u90a3\u6837\u8bfb\u5165\uff0c\u4f46\u662f\u662f\u4ece\u5b57\u7b26\u4e32\u4e2d\u8bfb\u5165\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u4e0d\u7528\u6253\u5feb\u8bfb\u4e86\uff08\u867d\u7136\u6162\u4e86\u4e00\u70b9\uff0c\u4f46\u5f00\u6c27\u6c14\u4e4b\u540e\u6d77\u661f\uff09\u3002\n\n\u5934\u6587\u4ef6`<sstream>`\n\n\u5927\u6982\u5c31\u662f\u8fd9\u6837\u8bfb\uff1a\n\n```cpp\nfor(int i = 1; i <= n; ++i)\n{\n\tgetline(cin, tmp);\n\tstringstream ss(tmp);\n\tss >> dep[i];\n\tint aa;\n\twhile(ss >> aa)\n\t\tadd_edge(i, aa);\n}\n```\n\n\u9898\u76ee\u4e2d\u7684\u7167\u5c04\u4e0d\u4ec5\u53ea\u7167\u5230\u4e86\u4e0e\u8be5\u6c34\u6676\u76f8\u90bb\u7684\u6c34\u6676\uff0c\u5b83\u628a\u6574\u6761\u5c04\u7ebf\u4e0a\u7684\u6c34\u6676\u5168\u7167\u5230\u4e86\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u80fd\u8003\u8651\u5efa\u51fa\u8fd9\u4e2a\u7acb\u65b9\u4f53\u540e\u91cd\u65b0\u5efa\u56fe\u3002\n\n\u6211\u7684\u601d\u8def\u662f\u8fd9\u6837\u7684\uff1a\n\n\u5148\u627e\u5230\u4e00\u4e2a\u5ea6\u4e3a3\u7684\u70b9\u4f5c\u4e3a\u4e00\u4e2a\u89d2\u7684\u70b9\uff0c\u7528bfs\u6c42\u51fa\u5176\u9053\u4e2a\u70b9\u7684\u6700\u77ed\u8def\u3002\u8bb0\u4ee5\u8be5\u70b9\u4e3a\u539f\u70b9\u7684\u7b2c$i$\u4e2a\u70b9\u5750\u6807\u4e3a$(x_{1, i}, y_{1, i}, z_{1, i})$\uff0c\u6700\u77ed\u8def\u4e3a$dist[0][i]$\uff0c\u663e\u7136\u6709$dist[0][i] = x_{1, i} - 1+ y_{1, i} - 1 + z_{1, i} - 1$\u3002\n\n\u6211\u4eec\u4efb\u9009\u4e00\u4e2a\u5e73\u9762\uff0c\u8981\u6c42\u5305\u542b\u521a\u624d\u90a3\u4e2a\u70b9\u3002\u6211\u4eec\u627e\u5230\u5728\u8be5\u5e73\u9762\u4e0a\u8be5\u70b9\u5bf9\u89d2\u7ebf\u4e0a\u7684\u70b9\uff0c\u5176\u5b9e\u5c31\u662f\u968f\u4fbf\u627e\u4e00\u4e2a\u5ea6\u4e3a3\uff08\u5728\u89d2\u4e0a\uff09\u4e14\u4e0e\u539f\u70b9\u8ddd\u79bb$2(n-1)$\uff08\u5728\u8be5\u5e73\u9762\u4e0a\u6700\u8fdc\uff09\u7684\u70b9\u3002\u4ee5\u8be5\u70b9\u4e3a\u539f\u70b9\u8dd1\u4e00\u904d\u6700\u77ed\u8def\uff0c\u8bb0$dist[1][i]$\u3002\n\n\u7531\u4e8e\u6211\u4eec\u8bbe\u8ba1\u6700\u77ed\u8def\u65f6\uff0c\u53ef\u4ee5\u5148\u8d70\u5230\u8be5\u70b9\u6b63\u4e0b\u65b9\uff0c\u518d\u5f80\u4e0a\u722c\uff0c\u540c\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\u8ba1\u6210\u5148\u8d70$y$\uff0c\u518d\u8d70$x$\uff0c\u6700\u540e\u8d70$z$\u3002\n\n![](https://github.com/pfypfypfy/images-in-blogs/blob/master/20180708001.png?raw=true)\n\n\u6211\u4eec\u53d1\u73b0$dist[0][i] +dist[1][i]=2(n-1)$\uff0c\u6211\u4eec\u628a\u5b83\u51cf\u53bb\uff0c\u5c31\u53ea\u5269\u4e0b$2z$\u4e86\uff0c\u4e8e\u662f$z$\u5c31\u6c42\u51fa\u6765\u4e86\uff1a\n\n```cpp\n/**\n ddn\u662f\u5ea6\u6570\n di\u662f\u539f\u70b9\n poi\u8bb0\u5f55\u70b9\u7684x, y, z\n \u8fd9\u91cc\u7684n\u5df2\u7ecf\u662f\u70b9\u7684\u4e2a\u6570\u4e86\n tn\u624d\u662f\u8fb9\u957f\n \u7531\u4e8e\u4ece1\u5f00\u59cb\uff0c\u6240\u4ee5\u6709\u4e9b\u5730\u65b9\u5fae\u8c03\u4e86\u4e00\u4e0b\n */\nfor(di[0] = 1; ddn[di[0]] > 3; ++di[0]);\nbfs(0);\nfor(int i = 1; i <= n; ++i)\n{\n\tif(ddn[i] == 3 && dist[0][i] == ((tn-1)<<1))\n\t{\n\t\tdi[1] = i;\n\t\tbreak;\n\t}\n}\nbfs(1);\nfor(int i = 1; i <= n; ++i)\n\tpoi[i].z = (dist[0][i] + dist[1][i] - ((tn-2)<<1)) >> 1;\n```\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u540c\u6837\u7684\u65b9\u6cd5\u628a$x$\u89e3\u51fa\u6765\uff0c\u6700\u540e\u7684$y$\u53ea\u8981\u51cf\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\u3002\u56e0\u4e3a\u6211\u7684\u5750\u6807\u662f\u4ece1\u5f00\u59cb\u7684\uff0c\u6240\u4ee5\u6211\u5bf9\u5750\u6807\u505a\u4e86\u4e00\u4e9b\u5fae\u8c03\uff0c\u4ece0\u5f00\u59cb\u5c31\u6ca1\u6709\u8fd9\u4e2a\u95ee\u9898\u3002\n\n\u7531\u4e8e\u4e4b\u524dbfs\u7684\u6570\u636e\u6211\u4eec\u8fd8\u80fd\u7528\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u518d\u4e00\u904dbfs\u5373\u53ef\n\n```cpp\nfor(int i = 1; i <= n; ++i)\n\tif(poi[i].z == tn && dist[0][i] == dist[1][i] && ddn[i] == 3)\n\t\tdi[2] = i;\nbfs(2);\nfor(int i = 1; i <= n; ++i)\n{\n\tpoi[i].x = (dist[0][i] + dist[2][i] - ((tn-1)<<1)) >> 1;\n\tpoi[i].y = (dist[0][i] - poi[i].x - poi[i].z) + 1;\n\tpoi[i].x++;\n\tpoi[i].y++;\n\tmmap[poi[i].x][poi[i].y][poi[i].z] = i;\n}\n```\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u5efa\u597d\u56fe\u4e86\u3002\n\n\u540e\u9762\u7684\u5927\u529bdfs\u4e5f\u6ca1\u4ec0\u4e48\u597d\u8bf4\u7684\u3002\n\n\u4e0b\u9762\u628aac\u4ee3\u7801\u8d34\u4e00\u4e0b\uff0c\u7531\u4e8e`stringstream`\u5728\u6ca1\u6709\u6c27\u6c14\u7684\u60c5\u51b5\u4e0b\u6781\u6162\uff0c\u6240\u4ee5\u5fc5\u987b\u5f00\u6c27\u6c14\u3002\n\n```cpp\n// luogu-judger-enable-o2\n#include <cstring>\n#include <iostream>\n#include <fstream>\n#include <sstream>//stringstream \n#include <queue>\n\nusing namespace std;\n\nconst int maxm = 2058000;//\u8fd9\u91cc\u7684\u6700\u5927\u8fb9\u6570\u6211\u662f\u628a\u70b9\u6570\u52a0\u8d77\u6765\u4e58\u4e866 \nconst int maxn = 75*75*75;\nconst int inf = 0x3f3f3f3f;\n\nint n;//\u603b\u4e2a\u6570 \nint tn;//\u8fb9\u957f \n\nstruct Edge\n{\n    int to, nxt;\n} e[maxm<<1];\n\nint first[maxn];\n\nint cnt;\ninline void add_edge(int f, int t)\n{\n    e[++cnt].nxt = first[f];\n    first[f] = cnt;\n    e[cnt].to = t;\n}\n\nint dirx[] = {1, -1, 0, 0, 0, 0};\nint diry[] = {0, 0, 1, -1, 0, 0};\nint dirz[] = {0, 0, 0, 0, 1, -1};\n\nint dep[maxn];//\"\u597d\u770b\u7a0b\u5ea6\" \nint vis[maxn];\nint minn = inf;\nint maxx = -inf;\nint ll[10];//\u4f1a\u53d1\u5149\u7684\u6c34\u6676\u7684\u7f16\u53f7 \nint ddn[maxn];//\u5ea6\u6570 \nint zl;//\u8fd9\u662f\u4e2addn\u7684cnt \nint mmap[73][73][73]; \n\nstruct zb\n{\n    int x, y, z;\n} poi[maxn];\n\n#define pan (x > 0 && x <= tn && y > 0 && y <= tn && z > 0 && z <= tn)\n#define nxxt x += dirx[i], y += diry[i], z += dirz[i]\n\ninline int getans(int i, zb a)//\u80fd\u52a0\u591a\u5c11\"\u597d\u770b\u7a0b\u5ea6\"\n{\n    int ans = 0;\n    int x = a.x, y = a.y, z = a.z;\n    for(; pan; nxxt)\n        if(!vis[mmap[x][y][z]]++)//\u7531\u4e8e\u5f85\u4f1a\u513f\u56de\u6eaf\u65f6\u8981\u5220\u9664\uff0c\u6240\u4ee5\u61d2\u5230\u5bb6\u7684\u6211\u5c31\u76f4\u63a5\u7528++,--\u4ee3\u66ff\u8bb0\u5f55\u4e86 \n            ans += dep[mmap[x][y][z]];\n    return ans;\n}\n\ninline void delvis(int i, zb a)//\u56de\u6eaf\u65f6\u628adfs\u524d\u52a0\u7684vis\u5220\u9664 \n{\n    int x = a.x, y = a.y, z = a.z;\n    for(; pan; nxxt)\n        vis[mmap[x][y][z]]--;\n}\n\ninline void dfs(int now, int ans)//\u5927\u529b\u679a\u4e3e\u6240\u6709\u60c5\u51b5 \n{\n    if(now > zl)\n    {\n        minn = min(minn, ans);\n        maxx = max(maxx, ans);\n        return;\n    }\n    for(int i = 0; i < 6; ++i)\n    {\n        dfs(now+1, ans + getans(i, poi[ll[now]]));\n        delvis(i, poi[ll[now]]);\n    }\n}\n\nint dist[4][maxn];\nint di[4];\nbool viss[maxn];\n\ninline void bfs(int id)//\u6c42\u6700\u77ed\u8def \n{\n    memset(viss, 0, sizeof(viss));\n    queue<int> q;\n    int from = di[id];\n    viss[from] = true;\n    q.push(from);\n    while(!q.empty())\n    {\n        int now = q.front();\n        q.pop();\n        for(int i = first[now]; i; i = e[i].nxt)\n        {\n            int to = e[i].to;\n            if(!viss[to])\n            {\n                viss[to] = true;\n                dist[id][to] = dist[id][now] + 1;\n                q.push(to);\n            }\n        }\n    }\n}\n\nint main() \n{\n    ios:: sync_with_stdio(false);\n    cin >> n;\n    tn = n;\n    string tmp;\n    getline(cin, tmp);\n    n *= n * n;\n    for(int i = 1; i <= n; ++i)\n    {\n        getline(cin, tmp);\n        stringstream ss(tmp);\n        ss >> dep[i];\n        int aa;\n        if(!dep[i])\n        {\n            vis[i] = true;\n            ll[++zl] = i;\n        }\n        while(ss >> aa)\n        {\n            add_edge(i, aa);\n            ddn[i]++;\n        }\n    }\n    for(di[0] = 1; ddn[di[0]] > 3; ++di[0]);\n    bfs(0);\n    for(int i = 1; i <= n; ++i)\n    {\n        if(ddn[i] == 3 && dist[0][i] == ((tn-1)<<1))\n        {\n            di[1] = i;\n            break;\n        }\n    }\n    bfs(1);\n    for(int i = 1; i <= n; ++i)//\u5f97\u5230z \n    {\n        poi[i].z = (dist[0][i] + dist[1][i] - ((tn-2)<<1)) >> 1;\n        if(poi[i].z == tn && dist[0][i] == dist[1][i] && ddn[i] == 3)\n            di[2] = i;\n    }\n    bfs(2);\n    for(int i = 1; i <= n; ++i)//\u5f97\u5230x, y \n    {\n        poi[i].x = (dist[0][i] + dist[2][i] - ((tn-1)<<1)) >> 1;\n        poi[i].y = (dist[0][i] - poi[i].x - poi[i].z) + 1;\n        poi[i].x++;\n        poi[i].y++;\n        mmap[poi[i].x][poi[i].y][poi[i].z] = i;\n    }\n    dfs(1, 0);\n    cout << minn << ' ' << maxx << endl;\n    fclose(stdin);\n    fclose(stdout);\n    return 0;\n}\n```\n\n",
        "postTime": 1531050738,
        "uid": 84088,
        "name": "pufanyi",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3342 \u3010[ZJOI2014]\u7480\u707f\u5149\u534e\u3011"
    },
    {
        "content": "\u96be\u70b9\u5728\u5982\u4f55\u5efa\u56fe\u3002\n\n\u5148\u968f\u4fbf\u627e\u4e2a\u68f1\u89d2\uff0c\u518d\u968f\u4fbf\u5efa\u4e24\u6761\u68f1\uff0c\u7136\u540e\u4e00\u5c42\u4e00\u5c42\u94fa\u4e0b\u53bb\u3002\u5f53\u94fa\u5230\u4e00\u4e2a\u65b0\u7684\u70b9\u65f6\uff0c\u80af\u5b9a\u5df2\u7ecf\u94fa\u597d\u4e86\u81f3\u5c11\u4e00\u4e2a\u4e0e\u5b83\u76f8\u90bb\u7684\u70b9\uff0c\u7136\u540e\u518d\u66b4\u529b\u7b97\u51fa\u5df2\u77e5\u4e0e\u5f53\u524d\u70b9\u76f8\u90bb\u7684\u70b9\u7ed9\u51fa\u7684\u6bcf\u4e2a\u76f8\u90bb\u7684\u70b9\u7684\u51fa\u73b0\u6b21\u6570\uff0c\u7136\u540e\u6ca1\u88ab\u586b\u8fc7\u4e14\u51fa\u73b0\u6b21\u6570\u6700\u591a\u7684\u90a3\u4e2a\u70b9\u7684\u7f16\u53f7\uff0c\u5c31\u662f\u5f53\u524d\u70b9\u7684\u7f16\u53f7\u3002\n\n\u5efa\u5b8c\u56fe\u8dd1\u4e2adfs\u5c31\u884c\u4e86\u3002\n\n```\n#include<cstdio>\n#include<algorithm>\n#include<string>\n#include<cstring>\n#include<iostream>\nusing namespace std;\n#define ll long long\n#define For(i,x,y) for (register int i=(x);i<=(y);i++)\n#define Dow(i,x,y) for (register int i=(x);i>=(y);i--)\n#define cross(i,k) for (register int i=first[k];i;i=last[i])\nchar c;\ninline ll read(){\n    ll x=0;int ch=getchar(),f=1;\n    while (!isdigit(ch)&&(ch!='-')&&(ch!=EOF)) ch=getchar();\n    if (ch=='-'){f=-1;ch=getchar();}\n    while (isdigit(ch)){x=(x<<1)+(x<<3)+ch-'0';ch=getchar();}\n    c=ch;return x*f;\n}\nconst int N = 70*70*70+10;\nconst int dx[6]={1,-1,0,0,0,0};\nconst int dy[6]={0,0,1,-1,0,0};\nconst int dz[6]={0,0,0,0,1,-1};\nstruct node{\n\tint x,y,z;\n}l[11];\nint n,rt,tot,g[N],next[N][7],a[75][75][75],vis[N],cnt[N];\nll Max,Min;\ninline bool check(int x,int y,int z){return x>0&&x<=n&&y>0&&y<=n&&z>0&&z<=n;}\ninline void dfs(int now,int x,int y,int z,int k){\n\ta[x][y][z]=now,vis[now]=1;\n\tif (z==n&&k==4||y==n&&k==2) return;\n\tif (z==n-1&&k==4||y==n-1&&k==2){\n\t\tFor(i,1,next[now][0]){\n\t\t\tint v=next[now][i];\n\t\t\tif (!vis[v]&&next[v][0]==3){dfs(v,x+dx[k],y+dy[k],z+dz[k],k);break;}\n\t\t}\n\t\treturn;\n\t}\n\tFor(i,1,next[now][0]){\n\t\tint v=next[now][i];\n\t\tif (!vis[v]&&next[v][0]==4){dfs(v,x+dx[k],y+dy[k],z+dz[k],k);break;}\n\t}\n}\nint x,y,z,Vis[75][75][75];\nll ans;\ninline ll min(ll a,ll b){return a<b?a:b;}\ninline ll max(ll a,ll b){return a>b?a:b;}\ninline void dfs(int k){\n\tif (k>tot){Max=max(Max,ans),Min=min(Min,ans);return;}\n\tFor(i,0,5){\n\t\tx=l[k].x,y=l[k].y,z=l[k].z;\n\t\twhile (check(x+dx[i],y+dy[i],z+dz[i])){\n\t\t\tx+=dx[i],y+=dy[i],z+=dz[i];\n\t\t\tif (!Vis[x][y][z]) ans+=1ll*g[a[x][y][z]];Vis[x][y][z]++;\n\t\t}\n\t\tdfs(k+1);\n\t\tx=l[k].x,y=l[k].y,z=l[k].z;\n\t\twhile (check(x+dx[i],y+dy[i],z+dz[i])){\n\t\t\tx+=dx[i],y+=dy[i],z+=dz[i],Vis[x][y][z]--;\n\t\t\tif (!Vis[x][y][z]) ans-=1ll*g[a[x][y][z]];\n\t\t}\n\t}\n}\ninline void Print(){\n\tFor(i,1,n){\n\t\tFor(j,1,n){\n\t\t\tFor(k,1,n) printf(\"%d \",a[i][j][k]);puts(\"\");\n\t\t}puts(\"\");\n\t}\n}\nint main(){\n\t//freopen(\"P3342.in\",\"r\",stdin);\n\t//freopen(\"P3342.out\",\"w\",stdout);\n\tn=read();\n\tFor(i,1,n*n*n){\n\t\tg[i]=read();\n\t\twhile (c==' ') next[i][++next[i][0]]=read();\n\t}\n\tFor(i,1,n*n*n) if (next[i][0]==3){rt=i;break;}\n\tdfs(rt,1,1,1,4),dfs(rt,1,1,1,2);\n\tFor(i,1,n) For(j,1,n) For(k,1,n){\n\t\tif (a[i][j][k]) continue;\n\t\tint Max=0,Max_id=0;\n\t\tfor (int d=0;d<6;d+=2){\n\t\t\tint v=a[i-dx[d]][j-dy[d]][k-dz[d]];\n\t\t\tFor(nxt,1,next[v][0]){\n\t\t\t\tcnt[next[v][nxt]]++;\n\t\t\t\tif (cnt[next[v][nxt]]>Max&&!vis[next[v][nxt]]) Max=cnt[next[v][nxt]],Max_id=next[v][nxt];\n\t\t\t}\n\t\t}\n\t\ta[i][j][k]=Max_id,vis[Max_id]=1;\n\t\tfor (int d=0;d<6;d+=2){\n\t\t\tint v=a[i-dx[d]][j-dy[d]][k-dz[d]];\n\t\t\tFor(nxt,1,next[v][0]) cnt[next[v][nxt]]--;\n\t\t}\n\t}\n\tFor(i,1,n) For(j,1,n) For(k,1,n) if (!g[a[i][j][k]]) l[++tot]=(node){i,j,k};\n\tMax=(ll)-1e18,Min=-Max;\n\tdfs(1);\n\tprintf(\"%lld %lld\",Min,Max);\n}\n```",
        "postTime": 1531031883,
        "uid": 25355,
        "name": "\u590f\u8272\u796d",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3342 \u3010[ZJOI2014]\u7480\u707f\u5149\u534e\u3011"
    },
    {
        "content": "# [P3342](https://www.luogu.com.cn/problem/P3342)\n\n## \u524d\u8a00\n\n3.11 \u7684\u6a21\u62df\u8003\u8bd5\u5c45\u7136\u653e\u4e86\u8fd9\u4e2a\u4ee4\u4eba\u65e0\u8bed\u7684\u9898\uff1a\u521a\u770b\u5230\u8f93\u5165\u5c31\u65e0\u8bed\u4e86\uff0c\u7406\u89e3\u9519\u9898\u610f\u540e\u4e5f\u65e0\u8bed\u4e86\uff0c\u8fd8\u539f\u7acb\u65b9\u4f53\u65f6\u4e5f\u65e0\u8bed\u4e86\uff0c\u8003\u540e\u53d1\u73b0\u88ab\u5361\u5e38\u4e86\u4e5f\u65e0\u8bed\u4e86\uff0c\u603b\u4f53\u6765\u8bf4~~\u4f9d\u6258\u7b54\u8fa9~~\u3002\u672c\u9898 [loj](https://loj.ac/p/2203) \u4e0a\u7684\u6570\u636e\u5bf9\u5e38\u6570\u5927\u7684\u4eba\u5f88\u4e0d\u53cb\u597d\uff0c\u5982\u679c\u88ab\u5361\u5e38\u4e86\uff0c\u53ef\u4ee5\u770b\u540e\u8a00-\u4f18\u5316\u3002\n\n## \u9898\u610f\n\n\u7ed9\u5b9a ${n}\\times{n}\\times{n}$ \u7684\u7acb\u65b9\u4f53\uff0c\u6bcf\u4e2a $1\\times1\\times1$ \u7684\u7acb\u65b9\u4f53\u6709\u4e00\u4e2a\u6743\u503c\uff0c\u5176\u4e2d $m(m\\leqslant8)$ \u4e2a\u70b9\u4f1a\u5411\u516d\u4e2a\u65b9\u5411\u5176\u4e2d\u4e4b\u4e00\u53d1\u5c04**\u7a7f\u900f**\u5149\uff0c\u95ee\u6700\u540e\u88ab\u5149\u7167\u5230\u7684\u6240\u6709 $1\\times1\\times1$ \u7684\u7acb\u65b9\u4f53\u6743\u503c\u548c\u6700\u5927\u4e3a\u591a\u5c11\uff1f\n\n## Solution\n\n\u8fd8\u539f\u51fa\u7acb\u65b9\u4f53\u540e\u66b4\u529b\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(k+n\\times{m^6})$\uff0c$k$ \u662f\u8fd8\u539f\u7acb\u65b9\u4f53\u7684\u5e38\u6570\u3002\n\n\u96be\u70b9\u5c31\u5728\u8fd8\u539f\u7acb\u65b9\u4f53~~\u548c\u8f93\u5165~~\uff0c\u8fd9\u91cc\u4e0d\u4ecb\u7ecd\u5982\u4f55\u66b4\u529b\u6c42\u89e3~~\u548c\u8f93\u5165~~\u3002\n\n\u5bf9 $1\\times1\\times1$ \u7684\u7acb\u65b9\u4f53\u7b80\u79f0\u4e3a**\u5c0f\u7acb\u65b9\u4f53**\uff0c\u5bf9\u4ec5\u8fde\u63a5 $3$ \u4e2a\u5c0f\u7acb\u65b9\u4f53\u7684\u7684\u5c0f\u7acb\u65b9\u4f53\u7b80\u79f0\u4e3a**\u89d2**\u3002\n\n\u6839\u636e\u9ad8\u4e2d**\u4e09\u7ef4\u5e73\u9762\u76f4\u89d2\u5750\u6807\u7cfb**\u7684\u77e5\u8bc6\uff0c\u9996\u5148\u53ef\u4ee5\u968f\u4fbf\u627e\u4e00\u4e2a**\u89d2**\u786e\u5b9a\u4e3a\u539f\u70b9 $O(1,1,1)$\u3002\n\n\u8bbe\u4e00\u4e2a\u70b9 $P(x,y,z)$ \u4e0e $O$ \u7684\u8ddd\u79bb\u4e3a $d$\uff0c\u5f97\u5230\u4e00\u4e2a\u65b9\u7a0b\uff1a\n\n$$\n(x-1)+(y-1)+(z-1)=d\n$$\n\n\u7136\u540e\u627e\u5230\u4e0e $O$ \u7684\u8ddd\u79bb\u4e3a $n-1$ \u7684\u53e6\u5916\u4e09\u4e2a\u7684**\u89d2**\uff0c\u6bcf\u4e2a**\u89d2**\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u65b9\u7a0b\uff0c\u5f97\u5230\u65b9\u7a0b\u7ec4\uff1a\n\n$$\n\\begin{aligned}\n    (n-x)+(y-1)+(z-1)=d\\\\\n    (x-1)+(n-y)+(z-1)=d\\\\\n    (x-1)+(y-1)+(n-z)=d\\\\\n\\end{aligned}\n$$\n\n\u4e09\u5143\u4e00\u6b21\u65b9\u7a0b\u6c42\u89e3\u9700\u8981\u81f3\u5c11 $3$ \u4e2a\u65b9\u7a0b\uff0c\u4e5f\u5c31\u662f\u8bf4\u641c\u7d22\u5b8c $O$ \u540e\u518d\u968f\u4fbf\u5bfb\u627e\u4e24\u4e2a\u4e0e $O$ \u7684\u8ddd\u79bb\u4e3a $n-1$ \u7684**\u89d2**\u5373\u53ef\u3002\n\n\u7b14\u8005\u9009\u62e9\u4e86\u4e0b\u9762 $3$ \u4e2a\u65b9\u7a0b\uff1a\n\n$$\n\\begin{aligned}\n&\\begin{cases}\n    (x-1)+(y-1)+(z-1)=d_1\\\\\n    (x-1)+(y-1)+(n-z)=d_2\\\\\n    (n-x)+(y-1)+(z-1)=d_3\\\\\n\\end{cases}\n\\\\&\\Downarrow\\\\\n&\\begin{cases}\n    +x+y+z=d_1+3&(1)\\\\\n    +x+y-z=d_2+2-n&(2)\\\\\n    -x+y+z=d_3+2-n&(3)\\\\\n\\end{cases}\n\\\\&\\Downarrow\\\\\n&\\begin{cases}\n    x=\\frac{(1)-(3)}{2}\\\\\n    y=\\frac{(2)+(3)}{2}\\\\\n    z=\\frac{(1)-(2)}{2}\\\\\n\\end{cases}\n\\end{aligned}\n$$\n\n\u8fd8\u539f\u7acb\u65b9\u4f53\u540e\u66b4\u529b\u6c42\u89e3\u5373\u53ef\u3002\n\n## Code\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nnamespace IO\n{\n    int cnt, sum;\n    const int K = 70 + 1;\n    const int M = 10;\n    const int N = K * K * K;\n    int read(){char c;int x=0;do cnt+=((c=getchar())=='\\n');while(c<'0'||c>'9');while(c>='0'&&c<='9')x=x*10+c-48,c=getchar();return --sum,cnt+=(c=='\\n'),x;}\n    void print(int x){static int t[20];int top=0;if(x<0)putchar('-'),x=-x;do{t[++top]=x%10,x/=10;}while(x);while(top)putchar(t[top--]+48);}\n}\nusing namespace IO;\nint minn = +2e9, maxn = -2e9;\nint n, m, res;\nint val[N], vis[N];\nint d[3][N]; /*3 \u4e2a\u89d2\u5230\u5176\u5b83\u5c0f\u7acb\u65b9\u4f53\u7684\u8ddd\u79bb*/\nint f[K][K][K]; /*\u7acb\u65b9\u4f53*/\nvector<int> e[N]; /*\u8fde\u63a5\u7684\u5c0f\u7acb\u65b9\u4f53*/\nvector<int> col[M][6]; /*\u9884\u5904\u7406\u653e\u5149\u7684\u5c0f\u7acb\u65b9\u4f53\u6bcf\u4e2a\u65b9\u5411\u53ef\u4ee5\u7167\u5230\u7684\u6240\u6709\u5c0f\u7acb\u65b9\u4f53\u7684\u7f16\u53f7*/\narray<int,3> a[M]; /*\u5b58\u50a8\u653e\u5149\u7684\u5c0f\u7acb\u65b9\u4f53\u7684\u5750\u6807*/\nvoid dfs(int step)\n{\n    if (step == cnt + 1)\n        return maxn = max(maxn, res), minn = min(minn, res), void();\n    for (int i = 0; i < 6; i++) /*\u4fbf\u9012\u5f52\u8fb9\u7b97\u7b54\u6848*/\n    {\n        for (const int &j : col[step][i])\n            if (!(vis[j]++))\n                res += val[j];\n        dfs(step + 1);\n        for (const int &j : col[step][i])\n            if (!(--vis[j]))\n                res -= val[j];\n    }\n}\nvoid shine(int p, int i, int x, vector<int> &v)\n{\n    for (auto g = a[p]; g[i] >= 1 && g[i] <= n; g[i] += x)\n        v.emplace_back(f[g[0]][g[1]][g[2]]);\n}\nvoid bfs(int s, int p)\n{\n    queue<int> q; q.push(s), d[p][s] = 0;\n    while (!q.empty())\n    {\n        int u = q.front(); q.pop();\n        for (const int &v : e[u])\n            if (d[p][v] > d[p][u] + 1)\n                d[p][v] = d[p][u] + 1, q.push(v);\n    }\n}\nsigned main()\n{\n    memset(d, 0x3f, sizeof(d)); /*\u8f93\u5165\u95ee\u9898\u81ea\u884c\u89e3\u51b3*/\n    n = read(), sum = 8 * 3 + (n - 2) * 12 * 4 + (n - 2) * (n - 2) * 6 * 5 + (n - 2) * (n - 2) * (n - 2) * 6 + n * n * n;\n    memset(val, -1, sizeof(val));\n    for (int i = 1, x; x = read(), i; i = cnt)\n    {\n        if (val[i] == -1)\n            val[i] = x;\n        else\n            e[i].emplace_back(x);\n        if (sum == 0) break;\n    }\n    vector<int> v; /*\u627e 3 \u4e2a\u89d2\u5e76\u904d\u5386*/\n    for (int i = 1; i <= n * n * n; i++)\n        if (e[i].size() == 3)\n            v.emplace_back(i);\n    bfs(d[0][0] = *v.begin(), 0);\n    for (int i = 1, j = 1; j <= 2; i++)\n        if (d[0][v[i]] == n - 1)\n            d[j++][0] = v[i];\n    bfs(d[1][0], 1);\n    bfs(d[2][0], 2);\n    cnt = 0;\n    for (int i = 1, x, y, z; i <= n * n * n; i++) /*\u89e3\u65b9\u7a0b*/\n    {\n        d[0][i] += 3, d[1][i] += 2 - n, d[2][i] += 2 - n;\n        x = (d[0][i] - d[2][i]) >> 1;\n        y = (d[1][i] + d[2][i]) >> 1;\n        z = (d[0][i] - d[1][i]) >> 1;\n        f[x][y][z] = i;\n        if (!val[i]) a[++cnt] = {x, y, z};\n    }\n    for (int i = 1; i <= cnt; i++) /*\u9884\u5904\u7406\u6bcf\u4e2a\u65b9\u5411\u53ef\u4ee5\u7167\u5230\u7684\u6240\u6709\u5c0f\u7acb\u65b9\u4f53*/\n    {\n        shine(i, 0, +1, col[i][0]);\n        shine(i, 0, -1, col[i][1]);\n        shine(i, 1, +1, col[i][2]);\n        shine(i, 1, -1, col[i][3]);\n        shine(i, 2, +1, col[i][4]);\n        shine(i, 2, -1, col[i][5]);\n    }\n    dfs(1); /*\u66b4\u529b\u6c42\u89e3*/\n    print(minn), putchar(' '), print(maxn);\n    return 0;\n}\n```\n\n## \u540e\u8a00-\u4f18\u5316\n\n- **\u4e09\u7ef4\u6570\u7ec4\u5185\u5b58\u8bbf\u95ee\u5f88\u4e0d\u8fde\u7eed**\uff0c\u6700\u597d\u7528 vector \u9884\u5904\u7406\u51fa\u6765\u6bcf\u4e2a\u653e\u5149\u7684\u5c0f\u7acb\u65b9\u4f53\u6bcf\u4e2a\u65b9\u5411\u53ef\u4ee5\u7167\u5230\u7684\u6240\u6709\u5c0f\u7acb\u65b9\u4f53\u7684\u7f16\u53f7\uff0c\u8fd9\u4e2a\u4f18\u5316\u6700\u5927\u3002~~\uff08\u622a\u81f3 3.11 \u6700\u4f18\u89e3\uff09~~\n\n- \u5bf9\u4e8e**\u591a\u6b21\u8c03\u7528**\u7684\u51fd\u6570\uff0c\u91cc\u9762\u7684\u5c40\u90e8\u53d8\u91cf\u6700\u597d\u6539\u4e3a\u5168\u5c40\u53d8\u91cf\uff0c\u5c24\u5176\u662f\u5f00\u6570\u7ec4\u7684\u3002\n\n- dfs \u65f6\u8fb9\u9012\u5f52\u8fb9\u7b97\u7b54\u6848\uff0c\u6700\u597d\u4e0d\u8981\u9012\u5f52\u7ed3\u675f\u540e\u518d\u8ba1\u7b97\u7b54\u6848\u3002\n\n- \u5c3d\u91cf\u907f\u514d\u6307\u9488\u6570\u7ec4\u4ee3\u66ff\u539f\u6570\u7ec4\u8fdb\u5165\u9012\u5f52\u51fd\u6570\u8fdb\u884c\u64cd\u4f5c\u3002",
        "postTime": 1678585156,
        "uid": 760799,
        "name": "MarchKid_J0e",
        "ccfLevel": 0,
        "title": "P3342 [ZJOI2014]\u7480\u707f\u5149\u534e"
    },
    {
        "content": "\u5176\u4ed6\u9898\u89e3\u5efa\u51fa\u6b63\u65b9\u4f53\u90fd\u4f7f\u7528\u4e86\u6bd4\u8f83\u9ebb\u70e6\u7684\u65b9\u6cd5\uff0c\u8fd9\u91cc\u63d0\u4f9b\u4e00\u79cd\u727a\u7272\u4e00\u70b9\u5e38\u6570\u6362\u53d6\u4e0d\u7528\u52a8\u8111\u5b50\u7684\u505a\u6cd5\u3002\n\n\u9996\u5148\u4efb\u627e\u4e00\u4e2a\u5ea6\u6570\u4e3a $3$ \u7684\u70b9\u6267\u884c BFS\uff0c\u628a\u5b83\u7684\u5750\u6807\u94a6\u5b9a\u4e3a $(1,1,1)$\u3002\n\n\u518d\u627e\u4e00\u4e2a\u5230 $(1,1,1)$ \u7684\u8ddd\u79bb\u6070\u4e3a $2n-2$ \u7684\u5ea6\u6570\u4e3a $3$ \u7684\u70b9\uff0c\u628a\u5b83\u7684\u5750\u6807\u94a6\u5b9a\u4e3a $(n,n,1)$\u3002\n\n\u518d\u4ece $(n,n,1)$ BFS\uff0c\u627e\u5230\u4e00\u4e2a\u70b9\uff0c\u4ed6\u79bb $(1,1,1),(n,n,1)$ \u8ddd\u79bb\u90fd\u6070\u597d\u4e3a $n-1$\u3002\u628a\u8fd9\u4e2a\u70b9\u94a6\u5b9a\u4e3a $(1,n,1)$\u3002\n\n\u518d\u4ece $(1,n,1)$ BFS \u4e00\u904d\u3002\u4ee5\u4e0a\u4e09\u6b21 BFS \u7b97\u51fa\u6765\u5230\u67d0\u4e2a\u70b9 $X$ \u7684\u8ddd\u79bb\uff0c\u5206\u522b\u79f0\u4e3a $dis(0/1/2,X)$\u3002\u8003\u8651\u6570\u5bf9 $(dis(1,X)-dis(0,X),dis(2,X)-dis(0,X))$\u3002\n\n- \u7ed3\u8bba $1$\uff1a\u8fd9\u4e2a\u6570\u5bf9\u4e0e $X$ \u7684 $z$ \u7ef4\u5750\u6807\u65e0\u5173\u3002\n- \u7ed3\u8bba $2$\uff1a\u8fd9\u4e2a\u6570\u5bf9\u4e0e $X$ \u7684 $x,y$ \u5750\u6807\u6709\u4e00\u4e00\u5bf9\u5e94\u5173\u7cfb\u3002\n\n\u56e0\u6b64\uff0c\u627e\u51fa\u8fd9\u4e2a\u4e00\u4e00\u5bf9\u5e94\u5173\u7cfb\u5c31\u80fd\u7b97\u51fa $X$ \u7684\u5750\u6807\u662f $(x,y,?)$\uff0c\u518d\u7ed3\u5408 $dis(0,X)=x+y+?-3$ \u5c31\u80fd\u7b97\u51fa $?$ \u7684\u503c\u3002\n\n\u8fd9\u4e2a\u5bf9\u5e94\u5173\u7cfb\u53ef\u4ee5 $n^2$ \u9884\u5904\u7406\uff0c\u4e5f\u4e0d\u9700\u8981\u624b\u7b97\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nstruct Triple{\n\tint x,y,z;\n}t[285][285];\nint n,m,a[500005],v[75][75][75],p1,p2,p3,dis[3][500005],mi=1e9,mx=0,u[75][75][75],f[8];\nvector<Triple> A;\nvector<int> g[500005];\nint D(int x,int y,int z,int w){\n\treturn abs(x-z)+abs(y-w);\n}\nvoid BFS(int s,int dis[]){\n\tqueue<int> q;\n\tdis[s]=0,q.push(s);\n\twhile(!q.empty()){\n\t\tint x=q.front();\n\t\tq.pop();\n\t\tfor(int y:g[x])if(dis[y]>dis[x]+1)dis[y]=dis[x]+1,q.push(y);\n\t}\n}\nvoid Calc(){\n\tint o=0,sum=0;\n\tfor(Triple i:A){\n\t\tint x=i.x,y=i.y,z=i.z;\n\t\tif(f[o]==0)for(int i=1;i<x;i++)if(!u[i][y][z])u[i][y][z]=1,sum+=v[i][y][z];\n\t\tif(f[o]==1)for(int i=x+1;i<=n;i++)if(!u[i][y][z])u[i][y][z]=1,sum+=v[i][y][z];\n\t\tif(f[o]==2)for(int i=1;i<y;i++)if(!u[x][i][z])u[x][i][z]=1,sum+=v[x][i][z];\n\t\tif(f[o]==3)for(int i=y+1;i<=n;i++)if(!u[x][i][z])u[x][i][z]=1,sum+=v[x][i][z];\n\t\tif(f[o]==4)for(int i=1;i<z;i++)if(!u[x][y][i])u[x][y][i]=1,sum+=v[x][y][i];\n\t\tif(f[o]==5)for(int i=z+1;i<=n;i++)if(!u[x][y][i])u[x][y][i]=1,sum+=v[x][y][i];\n\t\to++;\n\t}\n\tmi=min(mi,sum),mx=max(mx,sum),o=0;\n\tfor(Triple i:A){\n\t\tint x=i.x,y=i.y,z=i.z;\n\t\tif(f[o]==0)for(int i=1;i<x;i++)u[i][y][z]=0;\n\t\tif(f[o]==1)for(int i=x+1;i<=n;i++)u[i][y][z]=0;\n\t\tif(f[o]==2)for(int i=1;i<y;i++)u[x][i][z]=0;\n\t\tif(f[o]==3)for(int i=y+1;i<=n;i++)u[x][i][z]=0;\n\t\tif(f[o]==4)for(int i=1;i<z;i++)u[x][y][i]=0;\n\t\tif(f[o]==5)for(int i=z+1;i<=n;i++)u[x][y][i]=0;\n\t\to++;\n\t}\n}\nvoid dfs(int x){\n\tif(x==A.size())return Calc();\n\tfor(int i=0;i<6;i++)f[x]=i,dfs(x+1);\n}\nint main(){\n\tscanf(\"%d\",&n),m=n*n*n,memset(dis,0x3f,sizeof(dis));\n\tfor(int i=1,x;i<=m;i++){\n\t\tscanf(\"%d\",&a[i]);\n\t\tstringstream ss;\n\t\tstring s;\n\t\tgetline(cin,s),ss<<s;\n\t\twhile(ss>>x)g[i].push_back(x);\n\t}\n\tfor(int i=1;i<=m;i++)if(g[i].size()==3)p1=i;\n\tv[1][1][1]=a[p1],BFS(p1,dis[0]);\n\tfor(int i=1;i<=m;i++)if(g[i].size()==3&&dis[0][i]==2*(n-1))p2=i;\n\tv[n][n][1]=a[p2],BFS(p2,dis[1]);\n\tfor(int i=1;i<=m;i++)if(g[i].size()==3&&dis[0][i]==(n-1)&&dis[1][i]==(n-1))p3=i;\n\tv[n][1][1]=a[p3],BFS(p3,dis[2]);\n\tfor(int i=1;i<=n;i++)for(int j=1;j<=n;j++)t[142+D(i,j,n,n)-D(i,j,1,1)][142+D(i,j,n,1)-D(i,j,1,1)]={i,j,1};\n\tfor(int i=1;i<=m;i++){\n\t\tTriple w=t[142+dis[1][i]-dis[0][i]][142+dis[2][i]-dis[0][i]];\n\t\tw.z=dis[0][i]-D(w.x,w.y,1,1)+1,v[w.x][w.y][w.z]=a[i];\n\t\tif(!a[i])A.push_back(w);\n\t}\n\tdfs(0),cout<<mi<<' '<<mx;\n}\n```",
        "postTime": 1623734805,
        "uid": 42156,
        "name": "feecle6418",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3342\u3010[ZJOI2014]\u7480\u707f\u5149\u534e\u3011"
    }
]
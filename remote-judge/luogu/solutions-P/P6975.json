[
    {
        "content": "[\u539f\u9898\u94fe\u63a5](https://codeforces.com/gym/100851/problem/C)\n\n## \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a\u4ed9\u4eba\u638c\u56fe\uff0c\u95ee\u6709\u591a\u5c11\u79cd\u65b9\u6cd5\u79fb\u52a8\u4e00\u6761\u8fb9\u4f7f\u65b0\u56fe\u8fd8\u662f\u4ed9\u4eba\u638c\u56fe\u3002\n\n## \u601d\u8def\n\n\u5206\u522b\u8003\u8651\u6811\u4e0a\u7684\u8fb9\u548c\u73af\u4e0a\u7684\u8fb9\uff1a\n\n- \u5bf9\u4e8e\u6811\u4e0a\u7684\u8fb9\uff0c\u5220\u9664\u5b83\u540e\u539f\u56fe\u5206\u4e3a\u4e24\u90e8\u5206\uff0c\u53ea\u9700\u8fde\u63a5\u8fd9\u4e24\u90e8\u5206\u5373\u53ef\uff1b\n- \u5bf9\u4e8e\u73af\u4e0a\u7684\u8fb9\uff0c\u5220\u9664\u5b83\u540e\uff0c\u8fd9\u4e2a\u73af\u8fde\u540c\u539f\u6765\u8fde\u5728\u73af\u4e0a\u7684\u6240\u6709\u6811\u7ec4\u6210\u4e86\u4e00\u68f5\u65b0\u6811\uff0c\u518d\u4ece\u6240\u6709\u4e0d\u5728\u73af\u4e0a\u7684\u70b9\u4e2d\u4efb\u610f\u8fde\u8fb9\u5373\u53ef\u3002\n\n## \u5b9e\u73b0\n\n\u5728\u4e00\u68f5\u6709 $x$ \u4e2a\u70b9\u7684\u6811\u4e0a\u589e\u52a0\u4e00\u6761\u8fb9\u7684\u65b9\u6848\u6570\u4e3a $\\frac{x\\cdot(x-1)}2-(x-1)$\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include<cstdio>\n#include<cctype>\n#include<vector>\nusing namespace std;\nconst int N=50000;\ntypedef pair<int,int> pii;\nint n,m;\nvector<int>e[N+1];\nint cnt;\nvector<pii>sc[N+1];\nlong long sum;\nlong long res;\nint read()\n{\n    int ret=0;\n    char c=getchar();\n    while(!isdigit(c)) {\n        c=getchar();\n    }\n    while(isdigit(c)) {\n        ret=ret*10+c-'0';\n        c=getchar();\n    }\n    return ret;\n}\nvoid tarjan(int u,int fa)\n{\n    static int tot,dfn[N+1],low[N+1],siz[N+1];\n    static int top;\n    static pii stk[N+1];\n    dfn[u]=low[u]=++tot,siz[u]=1;\n    for(int v:e[u]) {\n        pii edg=pii{u,v};\n        if(!dfn[v]) {\n            stk[++top]=edg;\n            tarjan(v,u);\n            low[u]=min(low[u],low[v]);\n            siz[u]+=siz[v];\n            if(low[v]>dfn[u]) {\n                res+=1ll*siz[v]*(n-siz[v])-1;\n            }\n            if(low[v]>=dfn[u]) {\n                ++cnt;\n                do {\n                    sc[cnt].push_back(stk[top]);\n                } while(stk[top--]!=edg);\n            }\n        } else {\n            if((v!=fa)&&(dfn[v]<dfn[u])) {\n                stk[++top]=edg;\n                low[u]=min(low[u],dfn[v]);\n            }\n        }\n    }\n    return;\n}\nnamespace unionSet {\n    int fa[N+1],siz[N+1];\n    inline void init()\n    {\n        fill(siz+1,siz+n+1,1);\n        return;\n    }\n    int find(int x)\n    {\n        return fa[x]?fa[x]=find(fa[x]):x;\n    }\n    void merge(int u,int v)\n    {\n        u=find(u),v=find(v);\n        if(u!=v) {\n            fa[v]=u,siz[u]+=siz[v];\n        }\n        return;\n    }\n}\ninline long long calc(int x)\n{\n    return 1ll*x*(x-1)/2-(x-1);\n}\nint main()\n{\n    n=read(),m=read();\n    while(m--) {\n        int c=read(),u=read();\n        while(--c) {\n            int v=read();\n            e[u].push_back(v),e[v].push_back(u);\n            u=v;\n        }\n    }\n    tarjan(1,0);\n    unionSet::init();\n    for(int i=1;i<=cnt;++i) {\n        if(sc[i].size()==1) {\n            unionSet::merge(sc[i].front().first,sc[i].front().second);\n        }\n    }\n    for(int i=1;i<=n;++i) {\n        if(!unionSet::fa[i]) {\n            sum+=calc(unionSet::siz[i]);\n        }\n    }\n    for(int i=1;i<=cnt;++i) {\n        if(sc[i].size()==1) {\n            continue;\n        }\n        int s=0;\n        long long tem=sum;\n        for(pii edg:sc[i]) {\n            int u=unionSet::find(edg.first);\n            s+=unionSet::siz[u];\n            tem-=calc(unionSet::siz[u]);\n        }\n        res+=(tem+calc(s)-1)*sc[i].size();\n    }\n    printf(\"%lld\\n\",res);\n    return 0;\n}\n```",
        "postTime": 1605855330,
        "uid": 77022,
        "name": "Early",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P6975 \u3010\u300cNEERC2015\u300dCactus Jubilee\u3011"
    },
    {
        "content": "[\u5e7f\u544a](https://m-sea-blog.com/)\n\n---\n\n\u79fb\u52a8\u4e00\u6761\u8fb9\u7b49\u4ef7\u4e8e\u5148\u5220\u6389\u4e00\u6761\u8fb9\u518d\u52a0\u5165\u4e00\u6761\u4f4d\u7f6e\u4e0d\u540c\u7684\u8fb9\u3002\u4e0d\u59a8\u53bb\u6389\u4f4d\u7f6e\u4e0d\u540c\u7684\u9650\u5236\uff0c\u6700\u540e\u5c06\u7b54\u6848\u51cf\u53bb\u8fb9\u6570\u5373\u53ef\u3002\n\n\u90a3\u4e48\u6211\u4eec\u76f8\u5f53\u4e8e\u8981\u5bf9\u6bcf\u4e2a\u65ad\u6389\u4e00\u6761\u8fb9\u540e\u6c42\u51fa\u6709\u591a\u5c11\u79cd\u52a0\u8fb9\u7684\u65b9\u6848\uff0c\u6ee1\u8db3\u52a0\u8fb9\u540e\u662f\u4ed9\u4eba\u638c\u3002\n\n\u5206\u4e24\u79cd\u60c5\u51b5\u8ba8\u8bba\uff1a\n\n- \u5982\u679c\u65ad\u6389\u7684\u8fb9\u662f\u6865\uff0c\u90a3\u4e48\u5269\u4e0b\u7684\u4e24\u90e8\u5206\u4e4b\u95f4\u4efb\u610f\u8fde\u90fd\u53ef\u4ee5\uff0c\u65b9\u6848\u6570\u4e3a\u4e24\u90e8\u5206\u70b9\u6570\u4e4b\u79ef\u3002\n- \u5982\u679c\u65ad\u6389\u7684\u8fb9\u4e0d\u662f\u6865\uff0c\u6839\u636e *ZJOI2017 \u4ed9\u4eba\u638c* \u7684\u7ed3\u8bba\uff0c\u9700\u8981\u4fdd\u8bc1\u8fde\u8fb9\u7684\u4e24\u70b9\u8def\u5f84\u4e0a\u7684\u8fb9\u5168\u4e3a\u6865\u8fb9\u3002\u56e0\u6b64\u53ef\u4ee5\u53ea\u4fdd\u7559\u6865\u8fb9\u5f97\u5230\u4e00\u4e2a\u56fe\uff0c\u7b54\u6848\u4e3a $\\sum {sz_i-1\\choose 2}$\u3002\n\n\u6865\u7684\u60c5\u51b5\u53ef\u4ee5\u4e00\u904d DFS \u6c42\u51fa\uff0c\u800c\u975e\u6865\u7684\u60c5\u51b5\u4f3c\u4e4e\u4e0d\u597d\u5feb\u901f\u8ba1\u7b97\u3002\u6ce8\u610f\u5230\u540c\u4e00\u4e2a\u73af\u4e0a\u7684\u8fb9\u65ad\u6389\u540e\u4fdd\u7559\u6865\u8fb9\u5f97\u5230\u7684\u8fde\u901a\u5206\u91cf\u76f8\u540c\uff0c\u56e0\u6b64\u53ef\u4ee5\u6bcf\u6b21\u5bf9\u4e00\u4e2a\u73af\u8ba1\u7b97\u3002\u8fd9\u4e2a\u73af\u65ad\u6389\u4e00\u6761\u8fb9\u540e\u76f8\u5f53\u4e8e\u82e5\u5e72\u4e2a\u8fde\u901a\u5757\u5408\u5e76\u6210\u4e86\u4e00\u4e2a\uff0c\u53ea\u8981\u627e\u5230\u73af\u4e0a\u7684\u6240\u6709\u70b9\uff0c\u51cf\u53bb\u539f\u6765\u7684\u8d21\u732e\uff0c\u518d\u52a0\u4e0a\u5408\u5e76\u540e\u7684\u8d21\u732e\u5373\u53ef\u3002\n\n```cpp\n// ====================================\n//   author: M_sea\n//   website: https://m-sea-blog.com/\n// ====================================\n#include <bits/stdc++.h>\n#define file(x) freopen(#x\".in\",\"r\",stdin),freopen(#x\".out\",\"w\",stdout)\n#define debug(...) fprintf(stderr,__VA_ARGS__)\nusing namespace std;\ntypedef long long ll;\n\nint read() {\n\tint X=0,w=1; char c=getchar();\n\twhile (c<'0'||c>'9') { if (c=='-') w=-1; c=getchar(); }\n\twhile (c>='0'&&c<='9') X=X*10+c-'0',c=getchar();\n\treturn X*w;\n}\n\nconst int N=50000+10;\n\nint n,m;\nvector<int> E[N];\nll ans=0;\n\nint fa[N],sz[N],dfn[N],low[N],tim=0;\nvector<pair<int,int>> bridge,circ;\nvoid tarjan(int u,int f) {\n\tfa[u]=f,sz[u]=1,dfn[u]=low[u]=++tim;\n\tfor (int v:E[u]) {\n\t\tif (!dfn[v]) {\n\t\t\ttarjan(v,u),sz[u]+=sz[v],low[u]=min(low[u],low[v]);\n\t\t\tif (dfn[u]<low[v])\n\t\t\t\tbridge.emplace_back(u,v),ans+=1ll*sz[v]*(n-sz[v]);\n\t\t}\n\t\telse if (v!=f) low[u]=min(low[u],dfn[v]);\n\t}\n\tfor (int v:E[u])\n\t\tif (fa[v]!=u&&dfn[u]<dfn[v]) circ.emplace_back(u,v);\n}\n\nnamespace dsu {\n\tint f[N],sz[N];\n\tint find(int x) { return x==f[x]?x:f[x]=find(f[x]); }\n\tvoid merge(int u,int v) {\n\t\tu=find(u),v=find(v);\n\t\tif (u!=v) sz[u]+=sz[v],f[v]=u,sz[v]=0;\n\t}\n}\n\nint main() {\n\tn=read(),m=read(); int ec=0;\n\tfor (int i=1;i<=m;++i)\n\t\tfor (int k=read()-1,u=read(),v;k;--k,u=v)\n\t\t\tv=read(),E[u].emplace_back(v),E[v].emplace_back(u),++ec;\n\ttarjan(1,0);\n\tfor (int i=1;i<=n;++i) dsu::f[i]=i,dsu::sz[i]=1;\n\tfor (auto i:bridge) dsu::merge(i.first,i.second);\n\tll sum=0;\n\tfor (int i=1;i<=n;++i)\n\t\tif (i==dsu::f[i]) sum+=1ll*(dsu::sz[i]-1)*(dsu::sz[i]-2)/2;\n\tfor (auto i:circ) {\n\t\tint u=i.first,v=i.second,szc=0,cc=0; ll csum=0;\n\t\tfor (int t=v;t!=fa[u];t=fa[t]) {\n\t\t\tint s=dsu::sz[dsu::find(t)];\n\t\t\t++cc,szc+=s,csum+=1ll*(s-1)*(s-2)/2;\n\t\t}\n\t\tans+=cc*(sum-csum+1ll*(szc-1)*(szc-2)/2);\n\t}\n\tprintf(\"%lld\\n\",ans-ec);\n\treturn 0;\n}\n```",
        "postTime": 1609549429,
        "uid": 38370,
        "name": "M_sea",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P6975 \u3010[NEERC2015]Cactus Jubilee\u3011"
    }
]
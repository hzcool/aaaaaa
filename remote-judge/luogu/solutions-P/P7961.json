[
    {
        "content": "[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P7961)\n\n## $\\texttt{Description}$\n\n\u9898\u9762\u5f88\u53cb\u597d\uff0c\u7565\u3002\n\n$\\texttt{Data Range:}1\\le k\\le n\\le30,0\\le m\\le100,1\\le v_i<998244353$\n\n## $\\texttt{Solution}$\n\n\u770b\u5230\u8fd9\u79cd\u9898\u5bb9\u6613\u60f3\u5230 dp\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c$S$ \u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4f4d\u4e2d $1$ \u7684\u6570\u91cf\u4f1a\u6d89\u53ca\u8fdb\u4f4d\u7684\u95ee\u9898\u3002\u7531\u4e8e\u8fdb\u4f4d\u662f\u4ece\u4f4e\u4f4d\u5411\u9ad8\u4f4d\u8fdb\u884c\u7684\uff0c\u6240\u4ee5\u8003\u8651\u5728 $S$ \u4e2d\u4ece\u4f4e\u4f4d\u5230\u9ad8\u4f4d\u6309\u4f4d dp\uff08\u6700\u4f4e\u4f4d\u4e3a\u7b2c $0$ \u4f4d\uff09\u3002\n\n\u8bbe\u8ba1 dp \u72b6\u6001 $f(i,j,k,p)$ \u8868\u793a\uff1a\u8ba8\u8bba\u4e86 $S$ \u4ece\u4f4e\u5230\u9ad8\u7684\u524d $i$ \u4f4d\uff0c\u5df2\u7ecf\u786e\u5b9a\u4e86 $j$ \u4e2a\u5e8f\u5217 $a$ \u4e2d\u7684\u5143\u7d20\uff0c$S$ \u4ece\u4f4e\u5230\u9ad8\u524d $i$ \u4f4d\u4e2d\u6709 $k$ \u4e2a $1$\uff0c\u8981\u5411\u5f53\u524d\u8ba8\u8bba\u4f4d\u7684\u4e0b\u4e00\u4f4d\u8fdb\u4f4d $p$\u3002\n\n\u56e0\u4e3a\u4ece\u4e0a\u4e00\u4e2a\u72b6\u6001\u8f6c\u79fb\u5230 $f(i,j,k,p)$ \u7ec6\u8282\u592a\u591a\uff0c\u6240\u4ee5\u8003\u8651\u7528 $f(i,j,k,p)$ \u5f80\u540e\u8f6c\u79fb\u3002\n\n\u63a5\u4e0b\u6765\u8ba8\u8bba\u7b2c $i$ \u4f4d\uff08\u4f4d\u4ece $0$ \u5f00\u59cb\u7f16\u53f7\uff09\u3002\u5047\u8bbe\u5e8f\u5217 $a$ \u4e2d\u6709 $t$ \u4e2a\u5143\u7d20\u4e3a $i$\uff0c\u90a3\u4e48\u5c31\u76f8\u5f53\u4e8e\u7ed9 $S$ \u7684\u7b2c $i$ \u4f4d\u8d21\u732e\u4e86 $t$ \u4e2a $1$\uff0c\u518d\u52a0\u4e0a\u4e0a\u4e00\u4f4d\u8fdb\u8fc7\u6765\u7684 $p$ \u4e2a $1$\uff0c\u603b\u5171\u6709 $t+p$ \u4e2a $1$\u3002\n\n\u6211\u4eec\u77e5\u9053\uff0c\u5f53\u524d\u4f4d\u6bcf\u4e24\u4e2a $1$ \u53ef\u4ee5\u5411\u4e0b\u4e00\u4f4d\u8fdb\u4e00\u4e2a $1$\u3002\u6240\u4ee5 $(t+p)\\bmod2$ \u7684\u7ed3\u679c\u5373\u4e3a\u5168\u90e8\u8fdb\u4f4d\u540e\u5f53\u524d\u4f4d\u662f\u5426\u4e3a $1$\u3002\u540c\u7406\uff0c\u5411\u4e0b\u4e00\u4f4d\u8fdb\u7684 $1$ \u7684\u4e2a\u6570\u5373\u4e3a $\\left\\lfloor\\frac{t+\np}{2}\\right\\rfloor$\u3002\n\n\u6240\u4ee5 $f(i,j,k,p)$ \u5f80\u540e\u8f6c\u79fb\u7684\u72b6\u6001\u5e94\u8be5\u662f\n\n$$f(i+1,j+t,k+(t+p)\\bmod2,\\left\\lfloor\\frac{t+\np}{2}\\right\\rfloor)$$\n\n\u7531\u4e8e\u4e58\u79ef\u4e4b\u548c\u7684\u5f62\u5f0f\u6ee1\u8db3\u4e58\u6cd5\u5206\u914d\u5f8b\uff0c\u6240\u4ee5\u4e0d\u96be\u60f3\u5230 $f(i,j,k,p)$ \u5bf9\u65b0\u72b6\u6001\u7684\u8d21\u732e\u5e94\u8be5\u662f\n\n$$f(i,j,k,p)\\times v_i^t\\times\\binom{n-j}{t}$$\n\n\u521d\u59cb\u5316 $f(0,0,0,0)=1$\u3002\n\n\u5982\u4f55\u7edf\u8ba1\u7b54\u6848\u5462\uff1f\u5bf9\u4e8e $i$ \u8fd9\u4e00\u7ef4\uff0c\u7531\u4e8e $a$ \u4e2d\u5143\u7d20\u7684\u8303\u56f4\u662f $0\\sim m$\uff0c\u6240\u4ee5 $S$ \u53ea\u7528\u770b\u603b\u5171 $m+1$ \u4f4d\uff0c\u6240\u4ee5\u662f $m+1$\u3002\u5bf9\u4e8e $j$ \u8fd9\u4e00\u7ef4\uff0c\u6700\u7ec8 $n$ \u4e2a\u5143\u7d20\u90fd\u8981\u786e\u5b9a\uff0c\u6240\u4ee5\u662f $n$\u3002\u5bf9\u4e8e $k$ \u8fd9\u4e00\u7ef4\uff0c\u5e94\u8be5\u662f\u5728 $0\\sim k$ \u4e4b\u95f4\u7684\uff08\u540e\u9762\u8fd9\u4e2a $k$ \u662f\u8f93\u5165\u7684 $k$\uff09\u3002$p$ \u8fd9\u4e00\u7ef4\u5c31\u968f\u4fbf\u4e86\u3002\n\n\u4e0d\u8fc7\u6709\u4e00\u4e2a\u5c0f\u7ec6\u8282\uff0c\u5c31\u662f\u5728 $S$ \u7684\u7b2c $m$ \u4f4d\u6709\u53ef\u80fd\u8fd8\u8981\u5f80\u540e\u9762\u8fdb\u4f4d\uff0c\u6240\u4ee5\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a $\\mathrm{popcnt}(p)$ \u7684\u51fd\u6570\u5feb\u901f\u7edf\u8ba1\u51fa\u8fdb\u5b8c\u4f4d\u540e\u7b2c $m$ \u4f4d\u5f80\u540e\u7684 $1$ \u7684\u4e2a\u6570\uff0c\u518d\u52a0\u4e0a $k$ \u8fd9\u4e00\u7ef4\u7684\u6570\u91cf\uff0c\u5982\u679c\u5c0f\u4e8e\u7b49\u4e8e\u8f93\u5165\u7684 $k$\uff0c\u5c31\u53ef\u4ee5\u7edf\u8ba1\u8fdb\u7b54\u6848\u3002\n\n$\\mathrm{popcnt}$ \u51fd\u6570\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u4e00\u76f4 `res += x & 1, x >>= 1` \u5c31\u884c\u4e86\uff0c\u9053\u7406\u8ddf\u524d\u9762\u8f6c\u79fb\u7684\u65f6\u5019\u662f\u4e00\u6837\u7684\u3002\n\n\u6ce8\u610f\u8fd8\u8981\u9884\u5904\u7406\u6bcf\u4e2a $v$ \u7684\u5e42\u6b21\u65b9\u7ed3\u679c\u4ee5\u53ca\u7ec4\u5408\u6570\uff0c\u4ee3\u7801\u8fc7\u7a0b\u4e2d\u7684\u53d6\u6a21\u95ee\u9898\u7b49\u3002\n\n\u8fd9\u9053\u9898\u8fd8\u53ef\u4ee5\u7528\u6eda\u52a8\u6570\u7ec4\u8fdb\u884c\u7a7a\u95f4\u4f18\u5316\uff0c~~\u4e0d\u8fc7\u6211\u61d2~~\u3002\n\n**\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(n^4m)$**\n\n## $\\texttt{Code}$\n\n```cpp\n#include <cstdio>\n#include <iostream>\nusing namespace std;\ntypedef long long ll;\nconst ll mod = 998244353;\n\nll ans, v[105], dp[105][35][35][16], pv[105][35];\n\nll C[35][35];\ninline void init(int n) {\n\tfor (int i = 0; i <= n; i++) C[i][0] = 1;\n\tfor (int i = 1; i <= n; i++)\n\t\tfor (int j = 1; j <= i; j++) C[i][j] = (C[i - 1][j] + C[i - 1][j - 1]) % mod;\n}\n\ninline int popcnt(int n) {\n\tint res = 0;\n\twhile (n) res += n & 1, n >>= 1;\n\treturn res;\n}\n\nint main() {\n\tinit(30);\n\tint n, m, K;\n\tscanf(\"%d %d %d\", &n, &m, &K);\n\tfor (int i = 0; i <= m; i++) {\n\t\tscanf(\"%lld\", &v[i]);\n\t\tpv[i][0] = 1;\n\t\tfor (int j = 1; j <= n; j++) pv[i][j] = pv[i][j - 1] * v[i] % mod;\n\t}\n\tdp[0][0][0][0] = 1;\n\tfor (int i = 0; i <= m; i++)\n\t\tfor (int j = 0; j <= n; j++)\n\t\t\tfor (int k = 0; k <= K; k++)\n\t\t\t\tfor (int p = 0; p <= n >> 1; p++)\n\t\t\t\t\tfor (int t = 0; t <= n - j; t++) dp[i + 1][j + t][k + (t + p & 1)][t + p >> 1] = (dp[i + 1][j + t][k + (t + p & 1)][t + p >> 1] + dp[i][j][k][p] * pv[i][t] % mod * C[n - j][t] % mod) % mod;\n\tfor (int k = 0; k <= K; k++)\n\t\tfor (int p = 0; p <= n >> 1; p++)\n\t\t\tif (k + popcnt(p) <= K) ans = (ans + dp[m + 1][n][k][p]) % mod;\n\tprintf(\"%lld\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1638691322,
        "uid": 365542,
        "name": "SDqwq",
        "ccfLevel": 7,
        "title": "P7961 [NOIP2021] \u6570\u5217"
    },
    {
        "content": "## \u524d\u8a00&emo\r\n\r\n\u5173\u4e8e\u6211\u6ca1\u6709\u9884\u5904\u7406\u7ec4\u5408\u6570\u5bfc\u81f4 $100->85$ \u8fd9\u4ef6\u4e8b\u3002\r\n\r\n\u4e00\u9053\u9057\u6068\u5343\u5e74\u7684 NOIP2021 T2\u3002\r\n\r\n\u5199\u8fd9\u7bc7\u9898\u89e3\u65f6\u8fd8\u6ca1\u51fa\u5b98\u65b9\u6570\u636e\u548c\u6210\u7ee9\u3002\u5982\u679c\u56e0\u4e3a\u8fd9 $15pts$ \u800c\u540d\u843d\u5b59\u5c71\u7684\u8bdd\uff0c\u771f\u4e0d\u77e5\u9053\u8be5\u5982\u4f55\u9762\u5bf9\u81ea\u5df1\u5c06\u6765\u7684 OI \u751f\u6daf\u3002\r\n\r\n## \u89e3\u9898\u601d\u8def\r\n\r\n\u6211\u5c31\u6309\u7167\u6211\u8003\u573a\u4e0a\u7684\u601d\u8003\u8fc7\u7a0b\u8bb2\u5427\u3002\r\n\r\n\u8003\u8651 DP\u3002\uff08\u8ba1\u6570\u7c7b\u4e0d\u662f\u7ec4\u5408\u6570\u5c31\u662f DP \u5440\uff09\r\n\r\n\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u56db\u7ef4\u7684\u72b6\u6001 $f_{i,j,k,q}$ \u8868\u793a\u5df2\u7ecf\u586b\u597d\u4e86 $i$ \u4e2a\u6570\uff0c\u8003\u8651\u5b8c\u4e86 $v_{1...j}$\uff0c\u6b64\u65f6 $S$ \u4e8c\u8fdb\u5236\u4e0b\u6709 $k$ \u4e2a $1$\uff0c\u6709 $q$ \u4e2a\u5df2\u7ecf\u8d4b\u503c\u4e86\u7684 $a_i$ \u53d6\u4e86 $j$\uff0c**\u4e14 $q\\geq 1$ \u65f6**\u7684\u6743\u503c\u603b\u548c\u3002\r\n\r\n\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u72b6\u6001\u4e0d\u662f\u5f88\u597d\u8f6c\u79fb\uff0c\u56e0\u4e3a\u6211\u4eec\u65e0\u6cd5\u901a\u8fc7 $q$ \u8f6c\u79fb $k$\u3002\u95ee\u9898\u5c31\u5728\u4e8e\uff0c\u5982\u4f55\u8ba1\u7b97 $k$ \u5462\uff1f\r\n\r\n\u6bd4\u5982\u8bf4\u6211\u4eec\u73b0\u5728\u53d6\u4e86 $x$ \u4e2a $2^y$\uff0c\u90a3\u4e48\u82e5 $2^i \\operatorname{\\&} x>0$ \u5219\u7b49\u4ef7\u4e8e\u5728\u4e8c\u8fdb\u5236\u4e0b $S$ \u7684 $y+i$ \u4f4d\u4e0a\u6709\u4e00\u4e2a $1$ \u7684**\u8d21\u732e**\uff0c\u6240\u4ee5\u5bf9 $k$ \u7684\u8d21\u732e\u4e3a $\\operatorname{popcnt}(x)$\u3002$\\operatorname{popcnt} (x)$ \u8868\u793a $x$ \u5728\u4e8c\u8fdb\u5236\u4e0b $1$ \u7684\u4f4d\u6570\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u5982\u679c\u5355\u8003\u8651 $S$ \u4e8c\u8fdb\u5236\u4e0b $1$ \u7684\u4e2a\u6570\uff0c\u53d6 $x$ \u4e2a $2^i$ \u7b49\u4ef7\u4e8e\u53d6 $\\lfloor \\frac{x}{2^{j-i}}\\rfloor$ \u4e2a $2^j$\u3002 \u4e5f\u5c31\u662f\u8bf4\uff0c\u540e\u51e0\u4f4d\u7684\u6570\u5bf9\u4e8e\u524d\u9762\u53ef\u80fd\u4f1a\u6709\u5f71\u54cd\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u72b6\u6001\u6539\u6210\u8fd9\u6837\uff1a\r\n\r\n\u56db\u7ef4\u7684\u72b6\u6001 $f_{i,j,k,q}$ \u8868\u793a\u5df2\u7ecf\u586b\u597d\u4e86 $i$ \u4e2a\u6570\uff0c\u8003\u8651\u5b8c\u4e86 $v_{1...j}$\uff0c\u6b64\u65f6 $S$ \u4e8c\u8fdb\u5236\u4e0b\u6709 $k$ \u4e2a $1$\uff0c\u82e5\u4e0d\u8003\u8651 $j$ \u4ee5\u540e\u7684\u6570\uff0c**\u7b49\u4ef7\u4e8e**\u53d6\u4e86 $q$ \u4e2a $j$\uff0c**\u4e14\u81f3\u5c11\u6709\u4e00\u4e2a\u662f\u672c\u8eab\u5c31\u53d6\u4e86 $j$**\u3002\r\n\r\n\u8fd9\u4e2a\u5c31\u5f88\u597d\u8f6c\u79fb\u4e86\u3002\u6211\u4eec\u6709\u8f6c\u79fb\u65b9\u7a0b\uff1a\r\n\r\n$$f_{i,j,k,q}=\\sum\\limits_{x=0}^{i} (C_i^x\\cdot \\sum\\limits_{p=0}^{j-1} \\sum\\limits_{\\lfloor tmp/2^{i-p}\\rfloor+x=q}f_{i-x,p,k-\\operatorname{popcnt}(q)+\\operatorname{popcnt}(q-x)},tmp)$$\r\n\r\n\u5982\u4f55\u7406\u89e3\u8fd9\u4e2a\u65b9\u7a0b\u5462\uff1f $x$ \u8868\u793a\u6709\u591a\u5c11\u4e2a\u6570\u672c\u8eab\u5c31\u53d6\u4e86 $j$\uff0c$p$ \u662f\u4e0a\u4e00\u4e2a\u672c\u8eab\u88ab\u53d6\u7684\u6570\u5b57\uff0c\u7531\u4e8e\u6211\u4eec\u8981\u5012\u9000\u4e0a\u4e00\u4e2a\u72b6\u6001\u6211\u4eec\u7684 $k$ \u5c31\u4f1a\u6539\u53d8\u3002\u6211\u4eec\u5c11\u4e86 $x$ \u4e2a\u6570\uff0c\u4e0d\u4f1a\u5bf9\u66f4\u4f4e\u4f4d\u4e0a\u7684 $1$ \u4ea7\u751f\u5f71\u54cd\uff0c\u56e0\u6b64 $k'=k-\\operatorname{popcnt}(q)+\\operatorname{popcnt}(q-x)$\u3002\u800c $tmp$ \u5c31\u662f $p$ \u8fd9\u4e00\u4f4d\u7b49\u4ef7\u7684\u4e2a\u6570\u3002\r\n\r\n\u6211\u4eec\u5bb9\u6613\u53d1\u73b0\uff0c\u8fd9\u4e2a\u4ee3\u7801\u590d\u6742\u5ea6\u5927\u7ea6\u4e3a $O(n^5m^2)$\u3002\u4f46\u662f\u8dd1\u4e0d\u6ee1\u3002\u5176\u5b9e\u4e25\u91cd\u8dd1\u4e0d\u8fc7\uff0c\u53ea\u6709 $50pts$\u3002\r\n\r\n\u6211\u4eec\u8003\u8651\u4f18\u5316\uff0c\u6211\u4eec\u91cd\u65b0\u5b9a\u4e49\u4e00\u4e0b\u72b6\u6001\uff0c\u5982\u4e0b:\r\n\r\n\u56db\u7ef4\u7684\u72b6\u6001 $f_{i,j,k,q}$ \u8868\u793a\u5df2\u7ecf\u586b\u597d\u4e86 $i$ \u4e2a\u6570\uff0c\u8003\u8651\u5b8c\u4e86 $v_{1...j}$\uff0c\u6b64\u65f6 $S$ \u4e8c\u8fdb\u5236\u4e0b\u6709 $k$ \u4e2a $1$\uff0c\u82e5\u4e0d\u8003\u8651 $j$ \u4ee5\u540e\u7684\u6570\uff0c**\u7b49\u4ef7\u4e8e**\u53d6\u4e86 $q$ \u4e2a $j$\uff0c**\u4e14\u53ef\u4ee5\u6ca1\u6709\u4efb\u4f55\u662f\u672c\u8eab\u5c31\u53d6\u4e86 $j$**\u3002\r\n\r\n\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4e0d\u518d\u679a\u4e3e $p$ \u4e86\u3002\u65b9\u7a0b\u5982\u4e0b\uff1a\r\n\r\n$$f_{i,j,k,q}=\\sum\\limits_{x=0}^{i} (C_i^x\\cdot \\sum\\limits_{\\lfloor tmp/2\\rfloor+x=q}f_{i-x,j-1,k-\\operatorname{popcnt}(q)+\\operatorname{popcnt}(q-x)},tmp)$$\r\n\r\n\u5176\u4e2d $tmp$ \u53ea\u6709\u4e24\u79cd\u53d6\u503c\u3002\u8fd9\u6837\uff0c\u6211\u4eec\u7684\u590d\u6742\u5ea6\u5c31\u53d8\u6210\u4e86 $O(2n^4m)$\u3002\r\n\r\n\u4f3c\u4e4e\u80fd\u8fc7\uff1f\r\n\r\n\u8003\u573a\u4e0a\u662f\u8fd9\u4e48\u60f3\u7684\u3002\r\n\r\n\u5b9e\u9645\u4e0a\uff0c\u4e0d\u9884\u5904\u7406 $\\operatorname{popcnt}$ \u548c\u7ec4\u5408\u6570\u4f1a TLE \u4e09\u4e2a\u70b9\u3002\r\n\r\n\u9884\u5904\u7406\u4e00\u4e0b\u5c31\u8fc7\u4e86\uff0c\u9057\u6068\u5343\u5e74\u554a\u3002\u3002\u3002\u3002\r\n\r\n## \u4ee3\u7801\r\n\r\n```cpp\r\n#include<bits/stdc++.h>\r\nusing namespace std;\r\n\r\nconst int MAXN=33,MAXM=100+10,MOD=998244353;\r\n\r\nint n,m,k;\r\nlong long f[MAXN][MAXM][MAXN][MAXN];\r\nbool vis[MAXN][MAXM][MAXN][MAXN];\r\nlong long pop[MAXM],jc[MAXM],v[MAXM],c[MAXN][MAXN];\r\n\r\nlong long qpow(long long x,int y) {\r\n\tlong long ret=1;\r\n\twhile(y) {\r\n\t\tif(y&1) {\r\n\t\t\tret=ret*x%MOD;\r\n\t\t}\r\n\t\ty>>=1;\r\n\t\tx=x*x%MOD;\r\n\t}\r\n\treturn ret;\r\n}\r\nlong long inv(int x) {\r\n\treturn qpow(x,MOD-2);\r\n}\r\n\r\nlong long C(int n,int m) {\r\n\treturn jc[n]*inv(jc[m])%MOD*inv(jc[n-m])%MOD;\r\n}\r\n\r\nlong long dp(int i,int j,int k,int q) {\r\n\tif(k<0||i<0||j<0||q<0) {\r\n\t\treturn 0ll;\r\n\t}\r\n\tif(vis[i][j][k][q]) {\r\n\t\treturn f[i][j][k][q];\r\n\t}\r\n\tif(i==0) {\r\n\t\tif(q==0&&k==0) {\r\n\t\t\treturn 1ll;\r\n\t\t}\r\n\t\treturn 0ll;\r\n\t}\r\n\tif(j==0) {\r\n\t\treturn 0ll;\r\n\t}\r\n\tif(q>i) {\r\n\t\treturn 0ll;\r\n\t}\r\n\tlong long ans[MAXN]={},sum=0;\r\n\tfor(int x=0;x<=q;x++) {\r\n\t\tfor(int t=(q-x)*2;t<(q-x+1)*2&&t<=i-x;t++) {\r\n\t\t\tans[x]=(ans[x]+dp(i-x,j-1,k-pop[q]+pop[q-x],t))%MOD;\r\n\t\t}\r\n\t}\r\n\tfor(int x=0;x<=q;x++) {\r\n\t\tans[x]=ans[x]*c[i][x]%MOD;\r\n\t\tsum=(sum+ans[x]*qpow(v[j],x)%MOD)%MOD;\r\n\t}\r\n\tvis[i][j][k][q]=1;\r\n\treturn f[i][j][k][q]=sum;\r\n}\r\n\r\nint pop_c(int x) {\r\n\tint ret=0;\r\n\twhile(x) {\r\n\t\tif(x&1) {\r\n\t\t\tret++;\r\n\t\t}\r\n\t\tx>>=1;\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\nint main() {\r\n\t\r\n\tcin>>n>>m>>k;\r\n\tm++;\r\n\tfor(int i=1;i<=m;i++) {\r\n\t\tscanf(\"%lld\",&v[i]);\r\n\t}\r\n\tjc[0]=1;\r\n\tfor(int i=1;i<=n;i++) {\r\n\t\tpop[i]=pop_c(i);\r\n\t\tjc[i]=jc[i-1]*i%MOD;\r\n\t}\r\n\tfor(int i=1;i<=n;i++) {\r\n\t\tfor(int x=0;x<=i;x++) {\r\n\t\t\tc[i][x]=C(i,x);\r\n\t\t}\r\n\t}\r\n\t\r\n\tlong long ans=0;\r\n\tfor(int t=0;t<=k;t++) {\r\n\t\tfor(int i=0;i<=n;i++) {\r\n\t\t\tans=(ans+dp(n,m,t,i))%MOD;\r\n\t\t}\r\n\t}\r\n\t\r\n\tcout<<ans<<endl;\r\n\t\r\n}\r\n```\r\n\r\n## \u603b\u7ed3\r\n\r\n\u8fd9\u7bc7\u9898\u89e3\u5c31\u5199\u5b8c\u5566\uff01\u82b1\u4e86\u6211 1.5h\uff0c\u90fd\u770b\u5230\u8fd9\u91cc\u4e86\uff0c\u4e0d\u7ed9\u4e2a\u8d5e\u5417qwq\u3002\r\n\r\n\u7701\u9009\u7ee7\u7eed\u52a0\u6cb9\u5427\uff0c\u8fd8\u6709\u9006\u8f6c\u4e7e\u5764\u7684\u673a\u4f1a\uff01",
        "postTime": 1638343335,
        "uid": 132976,
        "name": "huayucaiji",
        "ccfLevel": 6,
        "title": "LG7961 [NOIP2021]\u6570\u5217"
    },
    {
        "content": "# \u9898\u76ee\u63cf\u8ff0\n\u7ed9\u5b9a\u6570\u5217 $\\left\\{a_i\\right\\}$\uff0c\u6ee1\u8db3 $\\forall a_i\\in\\left\\{x\\in \\mathbb{Z}|0\u2264x\u2264m\\right\\}$\u3002\u82e5 $\\sum_{i=1}^n2^{a_i}$\u7684\u4e8c\u8fdb\u5236\u4e2d $1$ \u7684\u4e2a\u6570\u4e0d\u8d85\u8fc7 $k$\uff0c\u5219\u4e3a\u4e00\u79cd\u65b9\u6848\u3002\u6c42 $\\sum(\\prod_{i=1}^nv_{a_i})$\u3002\n# \u9898\u89e3\n## 20pts\n\u76f4\u63a5\u679a\u4e3e\u6bcf\u4e2a $a_i$ \u7684\u53d6\u503c\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(m^n)$\u3002\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll mod=998244353;\nint n,m,k,v[105],a[105];\nll ans;\nint count(ll x)\n{\n\tint res=0;\n\twhile(x)\n\t{\n\t\tx-=(-x&x);\n\t\tres++;\n\t}\n\treturn res;\n}\nvoid dfs(int x,ll s,ll cnt)\n{\n\tif(x>=n+1)\n\t{\n\t\tint tmp=count(s);\n\t\tif(tmp<=k)\n\t\t\tans=(ans+cnt)%mod;\n\t\treturn;\n\t}\n\tfor(int i=0;i<=m;i++)\n\t{\n\t\ta[x]=i;\n\t\tdfs(x+1,s+(1<<i),cnt*v[i]%mod);\n\t}\n}\nint main()\n{\n\tscanf(\"%d%d%d\",&n,&m,&k);\n\tfor(int i=0;i<=m;i++)\n\t\tscanf(\"%d\",&v[i]);\n\tdfs(1,0,1);\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n## 50pts\n\u5c06\u7206\u641c\u6539\u6210\u8bb0\u5fc6\u5316\u5373\u53ef\uff0c$f(x,s)$ \u8868\u793a\u586b\u5230\u7b2c $x$ \u4e2a\u6570\uff0c\u603b\u548c\u4e3a $s$ \u65f6\u7684\u6743\u503c\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n^2\\times 2^m\\times m)$\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll mod=998244353;\nint n,m,k,v[105],a[105];\nll f[35][120005];\nint count(ll x)\n{\n\tint res=0;\n\twhile(x)\n\t{\n\t\tx-=(-x&x);\n\t\tres++;\n\t}\n\treturn res;\n}\nll dfs(int x,ll s)\n{\n\tif(x>=n+1)\n\t\treturn count(s)<=k;\n\tif(f[x][s]!=-1)\n\t\treturn f[x][s];\n\tlong long res=0;\n\tfor(int i=0;i<=m;i++)\n\t{\n\t\ta[x]=i;\n\t\tres=(res+dfs(x+1,s+(1<<i))*v[i]%mod)%mod;\n\t}\n\treturn f[x][s]=res;\n}\nint main()\n{\n\tmemset(f,-1,sizeof(f));\n\tscanf(\"%d%d%d\",&n,&m,&k);\n\tfor(int i=0;i<=m;i++)\n\t\tscanf(\"%d\",&v[i]);\n\tprintf(\"%lld\\n\",dfs(1,0));\n\treturn 0;\n}\n```\n## 100pts\n\u8003\u8651\u4e00\u79cd dp\uff0c\u5c06\u6240\u6709\u76f8\u540c\u6307\u6570\u7684\u6570\u4e00\u6b21\u6027\u52a0\u5165\u5230 $S$ \u4e2d\u3002\u4e0d\u96be\u60f3\u5230\uff0cdp \u5e94\u8be5\u4ece\u4f4e\u4f4d\u5f80\u9ad8\u4f4d\u679a\u4e3e\uff0c\u56e0\u4e3a\u4f4e\u4f4d\u7684\u8fdb\u4f4d\u4f1a\u5f71\u54cd\u9ad8\u4f4d\uff0c\u800c\u9ad8\u4f4d\u5219\u5bf9\u4f4e\u4f4d\u65e0\u5f71\u54cd\uff0c\u6ee1\u8db3 dp \u7684\u65e0\u540e\u6548\u6027\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(m\\times n^4)$\u3002  \n\u5219\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a  \n$dp(x,y,a,b)=\\sum_{i=0}^{n-y}dp(x+1,y+i,a+((b+i)\\mod2),\\lfloor\\dfrac{b+i}{2}\\rfloor)\\times v_x^i\\times C_{n-y}^i$  \n\u5176\u4e2d\u6743\u503c\u7684\u5e42\u548c\u7ec4\u5408\u6570\u5747\u53ef\u9884\u5904\u7406\u3002\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll mod=998244353;\nint n,m,k;\nll v[105],c[35][35],p[105][35],f[105][35][35][35];\nint count(ll x)\n{\n\tint res=0;\n\twhile(x)\n\t{\n\t\tx-=(-x&x);\n\t\tres++;\n\t}\n\treturn res;\n}//\u7edf\u8ba1x\u4e8c\u8fdb\u5236\u4e2d1\u7684\u4e2a\u6570\nll dfs(int x,int y,int a,int b)\n{\n\tif(y>=n)\n\t\treturn a+count(b)<=k;//1\u7684\u6570\u91cf\u4e0d\u8d85\u8fc7k\n\tif(x>m)\n\t\treturn 0;//\u5e8f\u5217\u4e0d\u591fn\u4e2a\u6570\u4e14\u4e0d\u5408\u6cd5\n\tif(f[x][y][a][b]!=-1)\n\t\treturn f[x][y][a][b];\n\tll res=0;\n\tfor(int i=0;i<=n-y;i++)\n\t\tres=(res+dfs(x+1,y+i,a+(b+i&1),b+i>>1)*p[x][i]%mod*c[n-y][i]%mod)%mod;\n\t//\u5728\u5269\u4e0bn-y\u4e2a\u4f4d\u7f6e\u4e2d\u653e\u5165i\u4e2a2^x\n\treturn f[x][y][a][b]=res;//\u8bb0\u5fc6\u5316\n}//\u679a\u4e3e\u52302^x\uff0c\u5df2\u7528\u4e86y\u4e2a\u6570\uff0ca\u4e2a\u4f4e\u4f4d1\uff0cb\u4e2a\u9ad8\u4f4d1\nint main()\n{\n\tmemset(f,-1,sizeof(f));\n\tscanf(\"%d%d%d\",&n,&m,&k);\n\tfor(int i=0;i<=m;i++)\n\t\tscanf(\"%d\",&v[i]);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tc[i][0]=c[i][i]=1;\n\t\tfor(int j=1;j<i;j++)\n\t\t\tc[i][j]=(c[i-1][j]+c[i-1][j-1])%mod;\n\t}//\u7ec4\u5408\u6570\n\tfor(int i=0;i<=m;i++)\n\t{\n\t\tp[i][0]=1;\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tp[i][j]=p[i][j-1]*v[i]%mod;\n\t}//v[i]^j\n\tprintf(\"%lld\\n\",dfs(0,0,0,0));\n\treturn 0;\n}\n```",
        "postTime": 1638112849,
        "uid": 379058,
        "name": "Ginger_he",
        "ccfLevel": 0,
        "title": "\u6d1b\u8c37P7961\u9898\u89e3"
    },
    {
        "content": "\u8003\u573a\u6eda\u52a8\u6570\u7ec4\u4f4d\u8fd0\u7b97\u5199\u9519\u96f6\u5206\u9009\u624b\u6765\u5199\u4e00\u7bc7\u9898\u89e3~\n~~QwQ\u8fd8\u6211100pts~~\n\n\u9996\u5148\uff0c\u53ef\u4ee5\u628a\u95ee\u9898\u8f6c\u5316\u4e3a\u5728 $2^0$ \u5230 $2^m$ \u8fd9 $m+1$ \u4e2a\u6570\u4e2d\u9009 $n$ \u4e2a\u6570\uff0c\u5bf9\u5e94\u5e8f\u5217 $a$\uff08\u53ef\u4ee5\u91cd\u590d\u9009\uff09\uff0c\u8981\u6c42\u8fd9\u4e9b\u6570\u4e4b\u548c\u7684 $S$ \u4e8c\u8fdb\u5236\u5171\u6709\u4e0d\u5927\u4e8e $k$ \u4f4d\u4e3a $1$\u3002\u6c42\u6240\u6709\u60c5\u51b5\u6bcf\u4e2a\u6240\u6709\u5bf9\u5e94 $v$ \u4e4b\u79ef\u7684\u548c\uff08`mod 998244353`\uff09\u3002\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u8fdb\u884c**\u8ba1\u6570 dp**\u3002\n\n\u5728\u672c\u9898\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0\u6709\u4e00\u4e2a\u6bd4\u8f83\u5934\u75bc\u7684\u4fe1\u606f\u662f\u9700\u8981 $S$ \u4e8c\u8fdb\u5236\u4e2d 1 \u7684\u4e2a\u6570\uff0c\u8fd9\u4e2a\u6570\u4e0d\u80fd\u8f7b\u6613\u7ef4\u62a4\uff0c\u56e0\u4e3a\u53ef\u80fd\u6709\u8bb8\u591a\u7684\u6765\u81ea\u4f4e\u4f4d\u7684\u8fdb\u4f4d\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4ece\u5c0f\u5230\u5927\u8003\u8651 $a$ \u4e2d\u7684\u5143\u7d20\uff0c\u5373\u4ece $0$ \u5230 $m$ \u4f9d\u6b21\u8003\u8651\u3002\u8fd9\u6837\u5728\u5904\u7406\u5f53\u524d\u4f4d\u65f6\uff0c\u53ef\u4ee5\u540c\u65f6\u786e\u5b9a\u66f4\u4f4e\u4f4d\u4e2d\u4e00\u5171\u6709\u51e0\u4e2a $1$\uff0c\u8fd9\u4e2a\u4fe1\u606f\u4e5f\u53ef\u4ee5\u52a0\u5165\u72b6\u6001\u4e2d\u3002\n\n\u6b64\u5916\uff0c\u4ece\u66f4\u4f4e\u4f4d\u53ef\u80fd\u8fdb\u4e0a\u6765\u8bb8\u591a\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u8fd8\u9700\u8981\u8bb0\u5f55\u4ece\u4e4b\u524d\u4f4d\u8fdb\u4e0a\u6765\u4e86\u591a\u5c11\u6570\u3002\u5f53\u7136\uff0c\u7531\u4e8e\u6709\u9009\u6570\u603b\u6570\u7684\u9650\u5236\uff0c\u4e5f\u9700\u8981\u8bb0\u5f55\u4e4b\u524d\u4e00\u5171\u9009\u4e86\u51e0\u4e2a\u6570\u3002\n\n\u7efc\u4e0a\uff0c\u8bbe\u8ba1 `dp[i][j][k][num][p]` \u8868\u793a $2^p$ \u9009\u62e9\u4e86 $i$ \u4e2a\uff0c\u4e4b\u524d\u4e00\u5171\u9009\u4e86 $j$ \u4e2a\u6570\uff0c\u66f4\u4f4e\u4f4d\u5411\u7b2c $p$ \u4f4d\u8fdb\u4e0a\u6765 $k$\uff0c\u622a\u6b62\u5230\u7b2c $p$ \u4f4d\u65f6\u5171\u786e\u5b9a\u6709 $num$ \u4f4d\u4e3a $1$ \u65f6\u6240\u6709\u60c5\u51b5\u7d2f\u79ef\u7684\u548c\uff0c\u6b64\u65f6\u5c06\u5411\u7b2c $p+1$ \u4f4d\u8fdb $(i+k)/2$\u3002\u663e\u7136\u5176\u53ef\u4ee5\u66f4\u65b0\u5f62\u5982 `dp[x][i+j][(i+k)/2][num+(x+(i+k)/2)%2][p+1]` \u7684\u72b6\u6001\uff0c\u5176\u4e2d $x$ \u5728\u72b6\u6001\u5408\u6cd5\u60c5\u51b5\u4e0b\u4efb\u610f\u3002\n\n\u6240\u4ee5\u989d\u5916\u5f00\u4e00\u4e2a\u6570\u7ec4 `f[j][k][num][p]` \u6765\u8bb0\u5f55\u622a\u6b62\u5230 $p-1$ \u4f4d\u5171\u9009\u4e86 $j$ \u4e2a\u6570\uff0c\u5176\u5c06\u5411\u7b2c $p$ \u4f4d\u8fdb $k$\uff0c\u5df2\u786e\u5b9a\u6709 $num$ \u4f4d\u4e3a $1$ \u7684\u6240\u6709\u60c5\u51b5\u4e4b\u548c\u3002\u8fd9\u6837\u53ef\u4ee5\u5f97\u5230\u4e24\u4e2a\u72b6\u6001\u8f6c\u79fb\u5f0f\uff1a\n\n$$dp[i][j][k][num][p]=f[j][k][num-(i+k)\\%2][p]\\times\\binom{n-j}{i}\\times v[p]^i$$\n\n$$f[i+j][(i+k)/2][num][p+1]+=dp[i][j][k][num][p]$$\n\n\u6700\u540e\u8fd8\u6709\u4e00\u4e2a\u7ec6\u8282\uff1a\u5728\u7edf\u8ba1\u7b54\u6848\u7684\u65f6\u5019\uff0c\u53ef\u80fd\u4f1a\u6709\u7b2c $m$ \u4f4d\u4ecd\u5411\u4e0a\u8fdb\u4f4d\u7684\u60c5\u51b5\uff0c\u9700\u8981\u901a\u8fc7\u4e00\u4e2a popcnt \u5f97\u5230\u6700\u7ec8\u603b\u5171\u6709\u51e0\u4f4d\u662f $1$\u3002\n\n\u6574\u4e2a\u590d\u6742\u5ea6 $O(n^4m)$\n\n\u4e8e\u662f\u53ef\u5f97\u4ee3\u7801\uff1a\uff08\u672a\u5361\u5e38\uff09\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\nconst int NR=35,MR=105,MOD=998244353;\nint N,M,K;\nint v[MR],powv[MR][NR],dp[NR][NR][NR][NR][MR],f[NR][NR][NR][MR];\nint fac[NR],inv[NR];\n\ninline int qpow(int x,int k){\n\tif(k==0) return 1;\n\tint tmp=qpow(x,k>>1);\n\ttmp=1ll*tmp*tmp%MOD;\n\tif(k&1) tmp=1ll*tmp*x%MOD;\n\treturn tmp;\n}\n\ninline void init(){//\u9884\u5904\u7406\u7ec4\u5408\u6570\n\tfac[0]=1;\n\tfor(int i=1;i<=N;i++) fac[i]=1ll*fac[i-1]*i%MOD;\n\tinv[N]=qpow(fac[N],MOD-2);\n\tfor(int i=N-1;i>=0;i--) inv[i]=1ll*inv[i+1]*(i+1)%MOD;\n}\n\ninline int C(int n,int m){//n\u4e2d\u9009m\n\treturn 1ll*fac[n]*inv[m]%MOD*inv[n-m]%MOD;\n}\n\ninline int popcnt(int x){\n\tint ret=0;\n\twhile(x){\n\t\tif(x&1) ret++;\n\t\tx>>=1;\n\t}\n\treturn ret;\n}\n\nint main(){\n\tcin>>N>>M>>K;\n\tinit();\n\tfor(int i=0;i<=M;i++){\n\t\tcin>>v[i];\n\t\tpowv[i][0]=1;\n\t\tfor(int j=1;j<=N;j++) powv[i][j]=1ll*powv[i][j-1]*v[i]%MOD;\n\t}\n\tf[0][0][0][0]=1;\n\tfor(int p=0;p<=M;p++){\n\t\tfor(int i=0;i<=N;i++){\n\t\t\tfor(int j=0;j<=N-i;j++){//\u9009\u62e9\u603b\u6570\u7684\u9650\u5236\n\t\t\t\tfor(int k=0;k<=N;k++){\n\t\t\t\t\tfor(int num=0;num<=K;num++){\n\t\t\t\t\t\tif(num-(i+k)%2<0) continue;\n\t\t\t\t\t\tdp[i][j][k][num][p]=1ll*f[j][k][num-(i+k)%2][p]*powv[p][i]%MOD*C(N-j,i)%MOD;\n\t\t\t\t\t\tf[i+j][(i+k)/2][num][p+1]+=dp[i][j][k][num][p];\n\t\t\t\t\t\tf[i+j][(i+k)/2][num][p+1]%=MOD;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint ans=0;\n\tfor(int i=0;i<=N;i++){\n\t\tfor(int k=0;k<=N;k++){\n\t\t\tfor(int num=0;num<=K;num++){\n\t\t\t\tif(num+popcnt((i+k)/2)<=K) ans=(ans+dp[i][N-i][k][num][M])%MOD;\n\t\t\t}\n\t\t}\n\t}\n\tcout<<ans<<'\\n';\n\treturn 0;\n}\n```\n\n\u5728\u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e9b\u4f18\u5316\u65b9\u5f0f\uff1a\n\n- \u5feb\u8bfb\u5feb\u5199\u4f18\u5316\u65f6\u95f4\n- $m$ \u90a3\u4e00\u7ef4\u53ef\u4ee5\u6eda\u6389\n- \u8f83\u4e3a\u5feb\u901f\u5730\u8ba1\u7b97\u7ec4\u5408\u6570\uff08\u867d\u7136\u8fd9\u4e2a\u672c\u8eab\u590d\u6742\u5ea6\u5c31\u6781\u5c0f\uff09",
        "postTime": 1637553024,
        "uid": 164580,
        "name": "YGB_XU",
        "ccfLevel": 6,
        "title": "\u3010P7961 [NOIP2021] \u6570\u5217\u3011\u9898\u89e3"
    },
    {
        "content": "# \u5e9f\u8bdd\n\u849f\u84bb\u7b2c\u4e00\u6b21\u8003 $noip$ orz\uff0c\u53ea\u4f1a\u8fd9\u4e00\u9898\uff0c\u5b9e\u5728\u662f\u592a\u83dc\u4e86\n\n# \u9898\u89e3\n\u8003\u8651\u4e00\u4e2a\u72b6\u538b $dp$ \uff0c\u6ce8\u610f\u5230\u5982\u679c\u6574\u4e2a\u72b6\u6001\u90fd\u5b58\u5230\u4e00\u7ef4\u4f1a\u7a7a\u95f4\u4e0d\u591f\uff0c\u800c\u72b6\u6001\u5e76\u4e0d\u4f1a\u5f71\u54cd\u5230\u8f6c\u79fb\u8fc7\u7a0b\uff0c\u5728\u8f6c\u79fb\u8fc7\u7a0b\u4e2d\u53ea\u4f1a\u5728\u88ab\u5c0f\u4e8e\u7684\u9879\u66f4\u65b0\uff0c\u4e14\u53ea\u4f1a\u5728\u6700\u540e\u7684\u7edf\u8ba1\u7b54\u6848\u4e2d\u4f7f\u7528\uff0c\u4e8e\u662f\u60f3\u5230\u53ef\u4ee5\u8fb9\u8f6c\u79fb\u8fb9 $popcnt$\uff0c\u53e6\u5916\u7531\u4e8e\u6570\u636e\u8f83\u5c0f\uff0c\u53ef\u4ee5\u4e0d\u7528\u5199 $O(log n)$ \u7684 $popcnt$ ,\u6734\u7d20\u7b97\u6cd5\u5373\u53ef\uff08\u5176\u5b9e\u662f\u6211\u4e0d\u4f1a\uff09\n\n\u5b9a\u4e49 $dp[i][j][k][l]$ \u4e3a\u8003\u8651\u5230\u6570\u5217 $a$ \u4e2d\u503c\u5c0f\u4e8e\u7b49\u4e8e $i$ \u7684\u9879\uff1b\u5176\u4e2d\u8fd8\u6709 $j$ \u4e2a\u7684\u503c\u6ca1\u6709\u786e\u5b9a $/$ \u503c\u5927\u4e8e $i$ \uff1b$S$\u7684\u4e8c\u8fdb\u5236\u5c55\u5f00\u4ece $2^i$ \u4f4d\u5f00\u59cb\u4e3a $k$\uff0c\u524d\u9762\u7684\u4e8c\u8fdb\u5236\u4f4d\u6709 $l$ \u4e2a1\n\n\u8f6c\u79fb\u5f88\u663e\u7136\uff0c\u8003\u8651\u4ece\u524d\u5f80\u540e\u8f6c\u79fb $dp[i+1][j-u][(k>>1)+u][l+(k\\&1)]+=dp[i][j][k][l]\\cdot C_j^u\\cdot v_{i+1}^u$\n\n\u5176\u4e2d $0\\le i<m,0\\le j,k,l<n,$ \uff0c\u590d\u6742\u5ea6 $O(n^3km)$ \n\n\u4e11\u964b\u4ee3\u7801\uff1a\n\n```\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst long long p = 998244353;\n\nlong long dp[120][50][50][120], v[120], c[50][50];\nint n, m, ik;\n\ninline int cnt(int x)\n{\n\tint res = 0;\n\twhile (x)\n\t{\n\t\tif (x & 1)\n\t\t\tres++;\n\t\tx >>= 1;\n\t}\n\treturn res;\n}\nlong long qpow(long long x, int y)\n{\n\tlong long res = 1;\n\twhile (y)\n\t{\n\t\tif (y & 1)\n\t\t\tres = res * x % p;\n\t\tx = x * x % p;\n\t\ty >>= 1;\n\t}\n\treturn res;\n}\n\nint main()\n{\n\tfreopen(\"sequence.in\", \"r\", stdin);\n\tfreopen(\"sequence.out\", \"w\", stdout);\n\tfor (int i = 0; i < 50; i++)\n\t\tc[i][0] = c[i][i] = 1;\n\tfor (int i = 1; i < 50; i++)\n\t\tfor (int j = 1; j < i; j++)\n\t\t\tc[i][j] = (c[i - 1][j - 1] + c[i - 1][j]) % p;\n\tscanf(\"%d%d%d\", &n, &m, &ik);\n\tfor (int i = 0; i <= m; i++)\n\t\tscanf(\"%lld\", v + i);\n\tfor (int i = 0; i <= n; i++)\n\t\tdp[0][i][n - i][0] = c[n][i] * qpow(v[0], n - i) % p;\n\tfor (int i = 0; i < m; i++)\n\t\tfor (int j = 0; j <= n; j++)\n\t\t\tfor (int k = 0; k <= n; k++)\n\t\t\t\tfor (int l = 0; l <= ik; l++)\n\t\t\t\t\tfor (int u = 0; u <= j; u++)\n\t\t\t\t\t\tdp[i + 1][j - u][(k >> 1) + u][l + (k & 1)] = (dp[i + 1][j - u][(k >> 1) + u][l + (k & 1)] + dp[i][j][k][l] * c[j][u] % p * qpow(v[i + 1], u) % p) % p;\n\tlong long ans = 0;\n\tfor (int k = 0; k <= n; k++)\n\t\tfor (int l = 0; l <= ik; l++)\n\t\t\tif (cnt(k) + l <= ik)\n\t\t\t\tans = (ans + dp[m][0][k][l]) % p;\n\tprintf(\"%lld\", ans % p);\n\treturn 0;\n}\n```\n\n# \u540e\u8bb0\n\u8003\u573a\u4e0a $dp$ \u6570\u7ec4\u8fd8\u5f00\u5927\u4e86\u2026\u2026\uff0c\u5f00\u5230\u4e86 $dp[120][50][50][120]$ \uff0c\u8e29\u7ebf\u6ca1\u6709\u8d85\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u5dee\u70b9\u53c8\u60e8\u906d\u72060",
        "postTime": 1637398020,
        "uid": 369207,
        "name": "Watware",
        "ccfLevel": 5,
        "title": "NOIP2021 T2"
    },
    {
        "content": "\u4eba\u8bdd\u7248\u9898\u610f\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $m$ \u7684\u6570\u5217\uff08\u4e0b\u6807\u4ece $0$ \u8d77\uff09\uff0c\u8ba9\u4f60\u9009 $m$\u4e2a\u6570\u7ec4\u6210\u4e00\u4e2a\u6743\u503c\u4e3a\u6240\u6709\u9009\u53d6\u7684\u503c\u7684\u79ef\u7684\u5e8f\u5217\uff0c\u8fd9\u4e2a\u5e8f\u5217\u201c\u5408\u6cd5\u201d\u5f53\u4e14\u4ec5\u5f53......\uff08\u53c2\u7167\u539f\u9898\uff0c\u628a $a_i$ \u6362\u6210\u7b2c $i$ \u4e2a\u9009\u62e9\u7684\u6570\u7684\u4e0b\u6807\uff09\uff0c\u6c42\u6240\u6709\u5408\u6cd5\u5e8f\u5217\u7684\u6743\u503c\u548c\u5bf9\u4e00\u4e2a\u5927\u8d28\u6570\u53d6\u6a21\u7684\u7ed3\u679c\u3002\n\n\u4e00\u822c\u957f\u8fd9\u6837\u7684\u8ba1\u6570\u9898\u4e0d\u662f\u6570\u5b66\u5c31\u662fDP\uff0c\u8fd9\u9053\u9898\u663e\u7136\u662f\u4e2aDP\u72b6\u7269\u3002\n\n\u4ec0\u4e48\uff1f\u6570\u4f4dDP\uff1f\u90a3\u662f\u5565\uff01\uff1f\u53cd\u6b63\u7b14\u8005\u4e0d\u4f1a\uff0c\u5c31\u6574\u4e86\u4e2a\u6bd4\u8f83\u5236\u6756\u7684\u5199\u6cd5\u3002\n\n\u4ee5\u4e0b\u662f\u4e00\u4e9b\u91cd\u8981\u7684\u7ed3\u8bba\u4e0e\u8f6c\u5316\uff1a\n\n1. $n$ \u4e2a\u4f4d\u7f6e\uff0c\u6709 $m$ \u4e2a\u5f85\u9009\u6570\u5b57\uff0c\u53ef\u4ee5\u91cd\u590d\u9009\u3002\n\n2. \u5173\u4e8e\u539f\u9898\u4e2d\u7684\u7ea6\u675f\uff1a\u628a $S$ \u6446\u6210\u4e8c\u8fdb\u5236\uff0c\u5f88\u5bb9\u6613\u53d1\u73b0\u5728 $S$ \u7684\u7ec4\u6210\u4e2d\uff0c\u6bcf\u9009\u4e00\u4e2a\u6570\uff0c\u5176\u4e0b\u6807\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u4f4d\uff08\u4ece\u53f3\u5411\u5de6\u4e3a\u9ad8\uff0c\u6700\u4f4e\u4e3a $0$ \u4f4d\uff09\u4e0a\u5c31\u4f1a $+1$\u3002\n\n\n\u7531\u7b2c\u4e00\u70b9\uff0c\u603b\u7ed3\u51fa\u4e00\u4e9b\u7279\u70b9\uff1a\u6570\u5b57\u53ef\u4ee5\u91cd\u590d\u9009\uff0c\u56e0\u6b64\u53ef\u4ee5\u679a\u4e3e\u67d0\u4e2a\u6570\u5b57\u9009\u591a\u5c11\u4e2a\uff0c\u800c\u6bcf\u4e00\u4e2a\u6570\u5b57\u548c\u9009\u62e9\u8be5\u6570\u5b57\u7684\u4e2a\u6570\uff08\u53ef\u4ee5\u4e3a $0$ \uff0c\u4ee3\u8868\u4e0d\u9009\uff09\u53ef\u4ee5\u770b\u6210\u4e00\u7c7b\u7269\u54c1\u4ee5\u53ca\u8fd9\u7c7b\u7269\u54c1\u4e2d\u5177\u4f53\u7684\u67d0\u4e00\u4e2a\uff0c\u7b26\u5408\u5206\u7ec4\u80cc\u5305\u7684\u7279\u70b9\u3002\u56e0\u6b64\uff0c\u8003\u8651\u5957\u5206\u7ec4\u80cc\u5305\u7684\u8f6c\u79fb\uff0c\u72b6\u6001\u4e0b\u8bbe\u5269\u4f59\u7a7a\u95f4\u548c\u51b3\u7b56\u7b2c\u591a\u5c11\u79cd\uff0c\u8f6c\u79fb\u65f6\u679a\u4e3e\u67d0\u4e00\u79cd\u9009\u54ea\u4e00\u4e2a\uff0c\u5bf9\u5e94\u5230\u8fd9\u9053\u9898\u4e0a\u5c31\u662f\u5f53\u524d\u6570\u5b57\u9009\u591a\u5c11\u4e2a\u3002\n\n\u7531\u7b2c\u4e8c\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5bf9 $S$ \u8fdb\u884c\u72b6\u538b\u6765\u8fdb\u884c\u4e8c\u8fdb\u5236\u76f8\u5173\u5904\u7406\uff0c\u4f46\u6700\u574f\u60c5\u51b5\u4e0b $S$ \u4f1a\u5f88\u957f\uff0c\u5e76\u4e14\u5176\u4e2d\u5f88\u5927\u7684\u4e00\u90e8\u5206\u90fd\u4e0d\u518d\u8fdb\u884c\u4fee\u6539\u4e86\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u8003\u8651\u5176\u4ed6\u7684\u4e00\u4e9b\u72b6\u6001\u8868\u793a\u3002\n\n3. \u6bcf\u6b21\u9009\u6570\u6700\u574f\u60c5\u51b5\u4e0b\u53ea\u4f1a\u5f71\u54cd\u5305\u62ec\u8fd9\u4e00\u4f4d\u4e0a\u7684\u4e8c\u8fdb\u5236\u7684 $5$ \u4f4d\u3002\n\n\u81f3\u4e8e\u4e3a\u4ec0\u4e48......\u5982\u679c\u5bf9\u72b6\u538b\u719f\u6089\u7684\u8bdd\uff0c\u5f88\u663e\u7136\u3002\u5982\u679c\u770b\u4e0d\u51fa\u6765\u7684\u8bdd\uff0c$2^5=32\\gt 30$ \uff0c\u4e4b\u540e\u8bf7\u81ea\u884c\u601d\u8003\u7f62\u3002\n\n\u56e0\u6b64\uff0c\u5bf9\u4e8e\u4e8c\u8fdb\u5236\u72b6\u6001\u7684\u8868\u793a\uff0c\u6211\u4eec\u53ef\u4ee5\u6539\u6210\u4e24\u7ef4\uff1a\u4e00\u7ef4\u4ee3\u8868\u5f53\u524d\u51b3\u7b56\u7684\u90a3\u4e00\u4e2a\u6570\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u4f4d\u7f6e\u548c\u524d\u9762\u7684 $4$ \u4f4d\uff08\u5171 $5$ \u4f4d\uff09\u7684\u4e8c\u8fdb\u5236\u72b6\u538b\uff0c\u53e6\u4e00\u4e2a\u8868\u793a\u5176\u4ed6\u4fe1\u606f\u2014\u2014\u6ce8\u610f\u5230\u8fd9\u9053\u9898\u5173\u5fc3\u7684\u662f\u4e8c\u8fdb\u5236\u8868\u793a\u4e2d $1$ \u7684\u4e2a\u6570\uff0c\u5e76\u4e14\u5982\u679c\u662f\u80cc\u5305\u7684\u987a\u5e8f\u8f6c\u79fb\uff0c\u5df2\u7ecf\u51b3\u7b56\u8fc7\u7684\u4e8c\u8fdb\u5236\u4f4e\u4f4d\u4e0d\u4f1a\u518d\u53d1\u751f\u53d8\u5316\uff0c\u56e0\u6b64\u8fd9\u4e00\u7ef4\u8868\u793a\u5f53\u524d\u4e8c\u8fdb\u5236\u4f4d\u7f6e\u7684\u6240\u6709\u6bd4\u5b83\u4f4e\u7684\u4f4d\u4e2d $1$ \u7684\u4e2a\u6570\uff0c\u663e\u7136\u8fd9\u4e2a\u6570\u4e0d\u4f1a\u8d85\u8fc7 $n$ \u3002\n\n\u56e0\u6b64\uff0c\u72b6\u6001\u51fa\u6765\u4e86\uff1a\u8bbe $dp_{i,j,k,l}$ \u4e3a\u5f53\u524d\u51b3\u7b56\u7684\u662f\u7b2c $i$ \u4e2a\u6570\uff0c\u5269\u4f59\u7a7a\u95f4\uff08\u8fd8\u5269\u591a\u5c11\u4e2a\u4f4d\u7f6e\u6ca1\u9009\uff09\u4e3a $j$ \uff0c $k$ \u4e0e $l$ \u5206\u522b\u662f\u524d\u9762\u8bf4\u7684\u90e8\u5206\u72b6\u538b\u548c\u4f4e\u4f4d $1$ \u7684\u4e2a\u6570\u65f6\u6240\u6709\u5e8f\u5217\uff08\u4e0d\u4e00\u5b9a\u5408\u6cd5\uff09\u7684\u6743\u503c\u548c\u3002\u8fd9\u91cc\u91c7\u7528\u53d1\u9001\u578b\u8f6c\u79fb\uff0c\u56e0\u4e3a\u5f53\u524d\u72b6\u6001\u7684\u524d\u7ee7\u96be\u4ee5\u679a\u4e3e\uff0c\u4f46\u540e\u7ee7\u72b6\u6001\u663e\u7136\uff1a\u679a\u4e3e\u4e0b\u4e00\u4e2a\u6570\u5b57\u9009\u7684\u4e2a\u6570 $s$ \uff0c\u5219\u5f53\u524d\u72b6\u6001\u53ef\u4ee5\u8f6c\u79fb\u5230 $dp_{i+1,j-s,(k>>1)+s,(k\\&1)+l}$ \u3002\u8fb9\u754c\u4e3a $i\\in[0,m-1]$ (\u56e0\u4e3a\u662f\u53d1\u9001\u578b) , $j\\in[0,n],s\\le j$ \uff08\u5269\u4f59\u7a7a\u95f4\u4e0d\u80fd\u4e3a\u8d1f\uff09 $ ,k \\in [0,n] ,l \\in [0,n]$ \u3002 \n\n\u7ee7\u7eed\u8003\u8651\u8f6c\u79fb\uff1a\u9009\u62e9 $s$ \u4e2a\u5f53\u524d\u6570\uff0c\u56e0\u6b64\u8981\u4e58\u4e0a $v_{i+1}^s$ \uff0c\u540c\u65f6\u6ce8\u610f\uff1a\u6211\u4eec\u8bbe\u7684\u72b6\u6001\u662f\u6743\u503c\u548c\uff0c\u9664\u4e86\u8f6c\u79fb\u4e0d\u80fd\u76f4\u63a5\u5199\u7b49\u53f7\u4e4b\u5916\uff0c\u5f53\u524d\u5143\u7d20\u7684\u6240\u6709\u6392\u5217\u90fd\u662f\u7b49\u4ef7\u7684\uff0c\u56e0\u6b64\u8981\u4e58\u4ee5\u6240\u6709\u6392\u5217\u7684\u6570\u91cf\uff0c\u8fd9\u5176\u5b9e\u662f\u4e00\u4e2a\u7ec4\u5408\u95ee\u9898\uff08\u56e0\u4e3a\u53ea\u8003\u8651\u9009\u6ca1\u9009\uff09\uff0c\u9009\u4e86 $s$ \u4e2a\u7684\u8d21\u732e\u4e3a $C_{j}^s$ \uff08\u5982\u679c\u4e0d\u61c2\uff0c\u5f53\u524d\u5269\u4f59\u7a7a\u95f4\u4e3a $j$ \uff0c\u8981\u4e22\u8fdb\u53bb $s$     \u4e2a\uff0c\u76f8\u5f53\u4e8e\u4ece $j$ \u4e2a\u4f4d\u7f6e\u91cc\u9009 $s$ \u4e2a\u4f4d\u7f6e\uff0c\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48 $j$ \u5b9a\u4e49\u4e3a\u201c\u5269\u4f59\u7a7a\u95f4\u201d\u800c\u4e0d\u662f\u201c\u5df2\u7528\u7a7a\u95f4\u201d\uff0c\u5982\u679c\u5b9a\u4e49\u662f\u540e\u8005\u5219\u6b64\u5904\u662f $C_{j+s}^s$ \uff0c\u548c\u4e0a\u5f0f\u7b49\u4ef7\uff09\u3002\n\n\u6700\u7ec8\u5f97\u5230\u7684\u603b\u7684DP\u65b9\u7a0b\u5c31\u662f\u628a\u4e0a\u9762\u51e0\u4e2a\u62fc\u8d77\u6765\uff0c\u8ba1\u6570\u7684\u65f6\u5019\u6309\u7167 $k$ \u4e0e $l$ \u53ef\u4ee5\u76f4\u63a5\u63a8\u51fa $popcount(S)$ \uff08\u63d0\u793a\uff1a\u9700\u8981\u5b9e\u73b0$popcount()$\uff09 \uff0c\u7d2f\u52a0\u5408\u6cd5\u7684\u5373\u53ef\u3002\n\n\u521d\u59cb\u72b6\u6001\u8bf7\u81ea\u884c\u601d\u8003\uff08\u63d0\u793a\uff1a\u53d1\u9001\u578b\u8f6c\u79fb\u7684\u7b2c\u4e00\u6b21\u8f6c\u79fb\u4f9d\u8d56\u54ea\u4e9b\u72b6\u6001\uff09\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta (n^4m)$ \uff0c\u6ce8\u610f\u5230DP\u8f6c\u79fb\u65f6\u5982\u679c $l$ \u8d85\u8fc7\u4e86\u9650\u5236\u5176\u540e\u7ee7\u72b6\u6001\u4e00\u5b9a\u4e0d\u5408\u6cd5\uff0c\u65e0\u9700\u679a\u4e3e\uff0c\u53ef\u4ee5\u526a\u679d\u526a\u5230 $\\Theta(n^3mk)$ \u3002\n\n\u522b\u5fd8\u4e86\u53d6\u6a21\u548c long long \uff0c\u8fd8\u6709\u9884\u5904\u7406\u7ec4\u5408\u6570\u4ee5\u53ca\u5feb\u901f\u5e42\u3002\n\nCode\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\nconst LL md=998244353;\nconst int N=37,M=101;\nint n,m,_k;\nLL dp[M+2][N][N][N],ct[N][M+2][N][N],C[N<<1][N<<1],v[M+2],ans;\n//dp[i+1][j-s][(k>>1)+s][(k&1)+l]+=dp[i][j][k][l]*v[i+1]^s*C[j][s]\ninline void init_C(int _n)\n{\n\tC[0][0]=1;\n\tfor(int i=1;i<=_n+1;++i) for(int j=0;j<=i;++j) C[i][j]=((j)?(C[i-1][j]+C[i-1][j-1]+md)%md:1)%md;\n}\ninline int pc(int __k)\n{\n\tint ans=0;while(__k) {if(__k&1) ++ans;__k>>=1;} return ans;\n}\ninline LL QP(LL a,LL b)\n{\n    LL ans=1;\n    while(b) {if(b&1) ans=ans*a%md;a=a*a%md,b>>=1;}\n    return ans%md;\n}\ninline LL qread()\n{\n\tLL a=0,f=1;char ch=getchar();\n\twhile(ch<'0' || ch>'9') {if(ch=='-') f*=-1;ch=getchar();}\n\twhile(ch>='0' && ch<='9') {a=a*10+(ch-'0');ch=getchar();}\n\treturn a*f;\n}\ninline void qwrite(LL x)\n{\n\tLL cnt=0;char w[128];\n\tif(x<0) x*=-1,putchar('-');\n\twhile(x) {w[cnt++]=(x%10)+'0';x/=10;}\n\twhile(cnt--) putchar(w[cnt]);\n}\nint main()\n{\n\tn=qread(),m=qread(),_k=qread();\n\tfor(int i=0;i<=m;++i) v[i]=qread();\n\tinit_C(n);\n\tfor(int i=0;i<=n;++i) dp[0][n-i][i][0]=QP(v[0],i)*C[n][i];\n\tfor(int i=0;i<m;++i)for(int j=0;j<=n;++j) for(int k=0;k<=n;++k) for(int l=0;l<=_k;++l)\n\t\tfor(int s=0;s<=j;++s) dp[i+1][j-s][(k>>1)+s][(k&1)+l]=(dp[i+1][j-s][(k>>1)+s][(k&1)+l]+dp[i][j][k][l]%md*QP(v[i+1],s)%md*C[j][s]%md)%md;\n\tfor(int k=0;k<=n;++k) for(int l=0;l<=_k;++l) if(pc(k)+l<=_k) ans=(ans+dp[m][0][k][l])%md;\n\tqwrite(ans);if(!ans) putchar(48);\n\treturn 0;\n}\n```\n",
        "postTime": 1657087933,
        "uid": 456724,
        "name": "2020kanade",
        "ccfLevel": 3,
        "title": "\u3010\u53eb\u4e0d\u4e0a\u540d\u5b57\u53cd\u6b63\u662f\u8ba1\u6570DP\u3011 NOIP2021 T2 \u6570\u5217 \u9898\u89e3"
    },
    {
        "content": "## \u9898\u610f\n\u9898\u9762\u975e\u5e38\u6e05\u695a\uff0c\u6ca1\u6709\u4ec0\u4e48\u80cc\u666f\uff0c\u7565\u3002\n## Solution\n\u89c2\u5bdf\u9898\u76ee\uff0c\u6211\u4eec\u53d1\u73b0 $a[i]$ \u7684\u987a\u5e8f\u4e0d\u540c\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u662f\u76f8\u540c\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u987a\u5e8f\u653e\u7f6e $a[i]$\uff0c\u7136\u540e\u5229\u7528\u7ec4\u5408\u6570\u6c42\u51fa\u5168\u90e8\u65b9\u6848\uff0c\u4e8e\u662f\u8fd9\u9898\u5c31\u53ef\u4ee5\u8fdb\u884c DP\u3002\n\n\u4ee5\u4e0b\u6211\u4eec\u89c4\u5b9a\u5173\u4e8e\u4f4d\u6570\u7684\u5168\u662f\u5728\u4e8c\u8fdb\u5236\u4e0b\u8ba8\u8bba\uff0c\u4e8c\u8fdb\u5236\u4e0b\u6700\u4f4e\u4f4d\u662f\u7b2c 0 \u4f4d\u3002\n\n\u8bbe $f[i][j][k][l]$ \u8868\u793a\u5df2\u7ecf\u586b\u5b8c\u4e86\u524d $i$ \u4e2a\u6570\uff0c\u5f53\u524d\u8fdb\u4f4d\u8fdb\u5230\u7684\u6700\u9ad8\u4f4d\u662f\u7b2c $j$ \u4f4d\uff08\u4e5f\u5c31\u662f\u8bf4\u4e4b\u524d\u7684 $a[i]$ \u6700\u5927\u586b\u5230 $j-1$ \uff0c\u5373\u6574\u6570 $S$ \u6700\u9ad8\u5728\u7b2c $j-1$ \u4f4d\u586b\u4e86 1\uff09,$a[i]$ \u4e2d\u586b\u4e86 $k$ \u4e2a $j$\uff0c\u5df2\u7ecf\u6709 $l$ \u4e2a\u4f4d\u662f1\u7684\u5408\u6cd5\u5e8f\u5217\u7684\u6743\u503c\u603b\u8d21\u732e\u3002\n\n\u8003\u8651\u8f6c\u79fb\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u5df2\u77e5\u7684$f[i][j][k][l]$\u5411\u5176\u4ed6\u72b6\u6001\u8f6c\u79fb\uff0c\u6211\u4eec\u5047\u8bbe\u5728 $a[i]$ \u4e2d\u586b $num$ \u4e2a $j$\uff0c\u90a3\u4e48\u8f6c\u79fb\u65b9\u7a0b\u5982\u4e0b\uff1a\n\n$f[i+num][j+1][(k+num)/2][l+(k+num)\\bmod 2]+=f[i][j][k][l]\\cdot v_{j}^{num}\\cdot C_{i+num}^{num}$\n\n\u5176\u4e2d $i+num$ \u8868\u793a\u586b\u4e86\u8fd9 $num$ \u4e2a\u6570\u540e\u4e00\u5171\u586b\u5b8c\u4e86\u591a\u5c11\u4e2a $a[i]$\uff0c$j+1$ \u8868\u793a\u5f80\u4e0b\u8fdb\u4e86\u4e00\u4f4d\uff08\u5c31\u7b97\u6ca1\u6709\u8fdb\u4f4d\u4e5f\u53ef\u4ee5\u9ed8\u8ba4\u8fdb\u4e86\u4f4d\uff0c\u56e0\u4e3a\u8fd9\u662f\u6ca1\u6709\u5f71\u54cd\u7684\uff09\uff0c$(k+num)/2$ \u8868\u793a\u5411\u4e0b\u4e00\u4f4d\u8fdb\u4e86\u51e0\u4e2a1\uff0c$(k+num)\\bmod 2$ \u5c31\u662f\u5224\u65ad\u8fd9\u4e2a\u4f4d\u7684\u6570\u662f 1 \u8fd8\u662f 0\uff0c\u7136\u540e\u518d\u4e58\u4e0a\u4e00\u4e2a\u7ec4\u5408\u6570\u3002\n\n\u6700\u540e\u7b54\u6848\u5373\u4e3a $\\sum {f[n][m+1][k][l]} (count(k)+l\u2264K)$\uff0c\u5176\u4e2d $count(k)$ \u8868\u793a\u6570\u5b57 $k$ \u5728\u4e8c\u8fdb\u5236\u4e0b\u6709\u591a\u5c11\u4e2a\u4f4d\u4e3a 1\uff0c$K$ \u662f\u9898\u76ee\u4e2d\u8f93\u5165\u7684 $k$\uff08\u5176\u5b9e\u5c31\u662f\u5904\u7406\u6700\u9ad8\u4f4d\u7684\u8fdb\u4f4d\uff09\u3002\n\n## CODE\n\n```cpp\n#include<bits/stdc++.h>\n#define LL long long\nusing namespace std;\nconst int N = 35, M = 105;\nconst LL MO = 998244353;\nint n, m, K;\nLL v[M][N], f[N][M][N][N], C[N][N], ans;\nint lowbit(int x) {\n\treturn x & (-x);\n}\nint count(int x) {\n\tLL res = 0;\n\tfor (; x; x -= lowbit(x)) ++res;\n\treturn res;\n}//\u7edf\u8ba1\u4e00\u4e2a\u6570\u5728\u4e8c\u8fdb\u5236\u4e0b\u6709\u591a\u5c11\u4f4d\u662f1\nint main() {\n\tfreopen(\"sequence.in\", \"r\", stdin); freopen(\"sequence.out\", \"w\", stdout);//\u6587\u4ef6\u8f93\u5165\u8f93\u51fa\n\tC[0][0] = 1;\n\tfor (int i = 1; i < N; ++i) {\n\t\tC[i][0] = 1;\n\t\tfor (int j = 1; j <= i; ++j)\n\t\t\tC[i][j] = (C[i - 1][j - 1] + C[i - 1][j]) % MO;\n\t}//\u9884\u5904\u7406\u7ec4\u5408\u6570\n\tscanf(\"%d%d%d\", &n, &m, &K);\n\tfor (int i = 0; i <= m; ++i) {\n\t\tLL vv; scanf(\"%lld\", &vv); v[i][0] = 1;\n\t\tfor (int j = 1; j <= n; ++j) v[i][j] = v[i][j - 1] * vv % MO;\n\t}//\u9884\u5904\u7406v[i]\u7684\u5e42\n\tf[0][0][0][0] = 1;\n\tfor (int i = 0; i <= n; ++i)\n\t\tfor (int j = 0; j <= m; ++j)\n\t\t\tfor (int k = 0; k <= i / 2; ++k)\n\t\t\t\tfor (int l = 0; l <= K; ++l)\n\t\t\t\t\tif (f[i][j][k][l])\n\t\t\t\t\t\tfor (int num = 0; num <= n - i; ++num)\n\t\t\t\t\t\t\tf[i + num][j + 1][k + num >> 1][l + (k + num & 1)] = (f[i + num][j + 1][k + num >> 1][l + (k + num & 1)] + f[i][j][k][l] * v[j][num] % MO * C[i + num][num] % MO) % MO;//\u8f6c\u79fb\n\tfor (int k = 0; k <= n; ++k)\n\t\tfor (int l = 0; l <= K; ++l)\n\t\t\tif (count(k) + l <= K) ans = (ans + f[n][m + 1][k][l]) % MO;//\u7edf\u8ba1\u7b54\u6848\n\tprintf(\"%lld\\n\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1642303695,
        "uid": 37885,
        "name": "\u51b7\u7b11\u53f9\u79cb\u8427",
        "ccfLevel": 0,
        "title": "\u3010NOIP2021 T2\u3011\u6570\u5217 \u9898\u89e3"
    },
    {
        "content": "# NOIP2021-\u6570\u5217\n\n\u663e\u7136\u662f\u4e2a DP \u9898\uff0c\u8fd9\u4e2a\u9898 $O(n^3mk)$ \u505a\u6cd5\u662f\u4e0d\u662f\u57ab\u5e95\u4e86\u554a\u3002\n\n## \u72b6\u6001\u8bbe\u8ba1\n\n\u9996\u5148\u53d1\u73b0\u8fd9\u4e2a\u5e8f\u5217\u7684\u5143\u7d20\u7684\u987a\u5e8f\u4e0d\u4f1a\u5f71\u54cd\u6743\u503c\u548c $S$ \u503c\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u5e8f\u5217\u4e3a\u7a7a\uff0c\u7136\u540e\u5c06\u503c\u586b\u5165\u5e8f\u5217\uff0c\u8ba1\u7b97\u5bf9\u6743\u503c\u548c $S$ \u7684\u8d21\u732e\uff0c\u5bf9\u8fd9\u4e2a\u8fc7\u7a0b\u8fdb\u884c DP\u3002\n\n\u56e0\u4e3a\u5bf9\u4e8e\u7b49\u4e8e $i - 1$ \u7684 $a$\uff0c\u5b83\u53ef\u4ee5\u5f71\u54cd $S$ \u7684\u7b2c $i$ \u4f4d\u53ca\u5176\u540e\u9762\u7684\u4f4d\uff0c\u6240\u4ee5\u6211\u4eec\u4ece\u5c0f\u5f80\u5927\u8ba8\u8bba $a$ \u7684\u503c\u3002\u4ee5\u5b83\u4f5c\u4e3a\u9636\u6bb5\u4ece\u5c0f\u5f80\u5927\u8003\u8651\uff0c\u53ef\u4ee5\u907f\u514d\u540e\u6548\u6027\u3002\n\n\u56e0\u4e3a\u786e\u5b9a\u4e86\u5c0f\u4e8e $i$ \u7684\u6240\u6709 $a$ \u540e\uff0c\u53ef\u4ee5\u786e\u5b9a $S$ \u524d $i$ \u4f4d\u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u6211\u4eec\u5bf9\u4e8e\u586b\u5b8c\u5c0f\u4e8e $i$ \u7684\u503c\u7684\u72b6\u6001\u53ea\u9700\u8981\u8bb0\u5f55 $S$ \u524d $i$ \u4f4d\u7684 $1$ \u7684\u6570\u91cf\uff0c\u53ef\u4ee5\u5ffd\u7565\u5177\u4f53\u54ea\u4e9b\u4f4d\u662f $1$\u3002\n\n\u5f53\u7136\uff0c\u5c0f\u4e8e $i$ \u7684 $a$ \u5bf9\u7b2c $i$ \u4f4d\u540e\u9762\u7684\u4f4d\u7f6e\u662f\u6709\u5f71\u54cd\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8bb0\u5f55\u4e00\u7ef4\u72b6\u6001\u8868\u793a\u5f53\u524d\u7684 $\\lfloor \\frac{S}{2^i} \\rfloor$\u3002\n\n\u73b0\u5728\u8fd8\u6709\u4e00\u4e2a\u72b6\u6001\u88ab\u5ffd\u7565\u4e86\uff0c\u4e5f\u5c31\u662f\u5f53\u524d\u5e8f\u5217\u5df2\u7ecf\u6709\u591a\u5c11\u4f4d\u7f6e\u4e0d\u662f\u7a7a\u4f4d\uff0c\u8fd9\u4e2a\u72b6\u6001\u8ba9\u6211\u4eec\u77e5\u9053\u6709\u591a\u5c11\u7a7a\u4f4d\u53ef\u4ee5\u8d4b\u503c\u3002\n\n\u8bbe\u8ba1 $f_{i, j, k, l}$ \u8868\u793a\u5df2\u7ecf\u586b\u4e86\u5c0f\u4e8e $i$ \u7684\u6240\u6709 $a$ \u503c\uff0c\u603b\u8ba1 $j$ \u4e2a\uff0c$S$ \u7684\u524d $i$ \u4f4d\u6709 $k$ \u4e2a $1$\uff0c$\\lfloor \\frac{S}{2^i} \\rfloor = l$\u3002\n\n## \u8f6c\u79fb\n\n\u5148\u5199\u65b9\u7a0b:\n\n$$\nf_{i, j, k, \\lfloor\\frac{x + y}2\\rfloor} = \\sum \\binom{n - j + x}{x} f_{i - 1, j - x, k - (x + y) \\bmod 2, y} \\cdot a^{x}\n$$\n\n\u53ef\u4ee5\u53d1\u73b0\u8fd9\u91cc\u76ee\u6807\u72b6\u6001\u53ea\u679a\u4e3e\u4e86 $i$\uff0c$j$\uff0c$k$ \u4e09\u7ef4\uff0c\u5269\u4e0b\u4e00\u7ef4\u662f\u7531\u8f6c\u79fb\u6240\u679a\u4e3e\u7684 $x$\uff0c$y$ \u51b3\u5b9a\u7684\u3002\u6211\u4e0d\u77e5\u9053\u5982\u4f55\u5b9a\u4e49\u6bcf\u4e2a\u72b6\u6001\u7684\u8f6c\u79fb\u590d\u6742\u5ea6\uff0c\u4f46\u662f\u603b\u590d\u6742\u5ea6\u4e00\u5b9a\u662f\u679a\u4e3e\u7684\u8fd9\u4e94\u4e2a\u53d8\u91cf\u7684\u8303\u56f4\u4e4b\u79ef\u3002\n\n\u63a5\u4e0b\u6765\u89e3\u91ca\u8fd9\u4e2a\u8f6c\u79fb\uff0c$x$ \u679a\u4e3e\u7684\u662f\u6570\u5b57 $i$ \u9009\u62e9\u7684\u6570\u91cf\uff0c$y$ \u679a\u4e3e\u7684\u662f\u8d77\u59cb\u72b6\u6001\u8fdb\u4f4d\u5230 $i$ \u7684\u6570\u5b57\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f53\u4f5c\u662f\u5728 $x$ \u7684\u57fa\u7840\u4e0a\uff0c\u989d\u5916\u9009\u62e9\u4e86 $y$ \u4e2a $i$\uff0c\u4f46\u662f\u4e0d\u82b1\u8d39\u7a7a\u4f4d\uff0c\u4e5f\u4e0d\u6d88\u8017\u6743\u503c\uff0c\u4ec5\u5bf9 $S$ \u4ea7\u751f\u5f71\u54cd\u3002\n\n\u8fd9\u6837\u524d\u9762\u7684\u4e8c\u9879\u5f0f\u7cfb\u6570\u7684\u610f\u4e49\u5c31\u5f88\u663e\u7136\u4e86\uff0c\u6211\u4eec\u8d77\u59cb\u72b6\u6001\u6709 $n - j + x$ \u4e2a\u7a7a\u4f4d\uff0c\u6211\u4eec\u4ece\u4e2d\u9009\u62e9 $x$ \u4e2a\u586b\u4e0a $i$ \u7684\u65b9\u6848\u6570\u5c31\u662f $\\binom{n - j + x}{x}$\u3002\n\n$a^x$ \u8868\u793a\u539f\u6765\u6bcf\u4e2a\u65b9\u6848\u7684\u57fa\u7840\u4e0a\u52a0 $x$ \u4e2a $i$\uff0c\u90fd\u4f1a\u4f7f\u65b9\u6848\u7684\u6743\u503c\u4e58 $a^x$\u3002\n\n$\\lfloor\\frac{x + y}2\\rfloor$ \u8868\u793a\u7684\u662f\u672c\u6b21\u586b\u5165 $i - 1$ \u5bf9 $S$ \u8d21\u732e\u7684 $x2^{i - 1}$ \u548c\u539f\u6765\u5df2\u7ecf\u5b58\u5728\u7684 $y2^{i - 1}$\uff0c\u5b83\u4eec\u7684\u548c\u9664\u4ee5 $2^i$ \u7684\u7ed3\u679c\uff0c\u4e5f\u5c31\u662f $\\lfloor \\frac{S}{2^i} \\rfloor$\u3002\n\n$(x + y) \\And 1$ \u7684\u610f\u4e49\u662f\u586b\u5165\u548c\u5408\u5e76\u5f97\u5230\u7684 $i - 1$\uff0c\u5bf9 $S$ \u4e2d\u524d $i$ \u4f4d $1$ \u7684\u6570\u91cf\u7684\u8d21\u732e\uff0c\u663e\u7136\uff0c\u5982\u679c $x + y$ \u662f\u5947\u6570\uff0c\u5c31\u4f1a\u4f7f\u5f97 $S$ \u7684\u7b2c $i$ \u4f4d\u662f $1$\u3002\n\n## \u4ee3\u7801\n\n> \u4ee3\u7801\u662f\u8003\u573a\u4ee3\u7801\u589e\u5220\u6ce8\u91ca\u5f97\u5230\u7684\uff0c\u6240\u4ee5\u7801\u98ce\u4fdd\u5b88\u3002\n\n\u4e3a\u4e86\u9632\u6b62\u53d8\u91cf\u540d\u51b2\u7a81\uff0c\u4e0a\u9762\u63d0\u5230\u7684 $x$\uff0c$y$ \u5728\u4ee3\u7801\u4e2d\u5206\u522b\u5199\u6210 $jj$ \u548c $ll$\uff0c\u9898\u76ee\u4e2d\u7684 $k$ \u7528 $t$ \u6765\u4ee3\u66ff\u3002\n\n\u4e3a\u4e86\u9632\u6b62\u6570\u7ec4\u8d8a\u754c\uff0c$f_{i}$ \u8868\u793a\u7b2c $i - 1$ \u4e2a\u9636\u6bb5\u7684 DP \u503c\uff0c\u4e5f\u5c31\u662f\u586b\u4e86\u6570\u5b57 $i - 1$ \u7684 DP \u503c\u3002\u56e0\u6b64\u9700\u8981\u5728\u8f93\u5165\u65f6\u628a $m$ \u53d8\u6210 $m + 1$\u3002\n\n```cpp\nconst unsigned long long Mod(998244353);\nunsigned long long Ans(0), C[35][35], a[105][35];\nunsigned f[105][35][35][35], Pop[105];\nunsigned n, m, t;\nunsigned A, B;\nunsigned Cnt(0);\nsigned main() {\n  n = RD(), m = RD() + 1, t = RD();\n  for (unsigned i(1); i <= m; ++i) {\n    a[i][0] = 1, a[i][1] = RD();\n    for (unsigned j(2); j <= n; ++j)\n      a[i][j] = a[i][j - 1] * a[i][1] % Mod;//\u9884\u5904\u7406\u6bcf\u4e2a\u503c\u6709\u4e0d\u540c\u4e2a\u6570\u7684\u6743\u503c (\u4e5f\u5c31\u662f\u9884\u5904\u7406 a \u7684\u5e42)\n  }\n  for (unsigned i(1); i <= 102; ++i) Pop[i] = Pop[i >> 1] + (i & 1);//\u9884\u5904\u7406 Popcount\n  C[0][0] = 1;\n  for (unsigned i(1); i <= n; ++i) {\n    C[i][0] = 1;\n    for (unsigned j(1); j <= n; ++j) {\n      C[i][j] = C[i - 1][j] + C[i - 1][j - 1];//\u9884\u5904\u7406\u4e8c\u9879\u5f0f\u7cfb\u6570\n      if(C[i][j] >= Mod) C[i][j] -= Mod;\n    }\n  }\n  for (unsigned i(0); i <= m; ++i) f[i][0][0][0] = 1;//\u521d\u59cb\u5316\n  for (unsigned i(1); i <= m; ++i) {\n    for (unsigned j(1); j <= n; ++j) {\n      for (unsigned k(0); k <= t; ++k) {\n        for (unsigned jj(0); jj <= j; ++jj) {\n          for (unsigned ll(0); ll <= n; ++ll) {\n            if((ll + jj) & 1) {\n              if(!k) continue;//\u9632\u6b62\u8d8a\u754c\n              f[i][j][k][(ll + jj) >> 1] = ((f[i][j][k][(ll + jj) >> 1] + (f[i - 1][j - jj][k - 1][ll] * C[n - j + jj][jj] % Mod) * a[i][jj]) % Mod);\n            } else {\n              f[i][j][k][(ll + jj) >> 1] = ((f[i][j][k][(ll + jj) >> 1] + (f[i - 1][j - jj][k][ll] * C[n - j + jj][jj] % Mod) * a[i][jj]) % Mod);\n            }\n          }\n        }\n      }\n    } \n  }\n  for (unsigned i(0); i <= t; ++i) {\n    for (unsigned j(0); j <= n; ++j) {\n      if(Pop[j] + i <= t) {//\u7b2c n \u4f4d\u540e\u9762\u7684 1 \u7684\u6570\u91cf\u548c\u524d n \u4f4d\u7684 1 \u7684\u6570\u91cf\u548c\n        Ans += f[m][n][i][j];//\u7edf\u8ba1\u7b54\u6848\n        if(Ans >= Mod) Ans -= Mod;\n      }\n    }\n  }\n  printf(\"%u\\n\", Ans);\n  return 0;\n}\n```",
        "postTime": 1637745649,
        "uid": 143771,
        "name": "\u6bd4\u5229\u2642\u6d77\u7075\u987f",
        "ccfLevel": 8,
        "title": "NOIP2021-\u6570\u5217"
    },
    {
        "content": "\u5c1d\u8bd5\u4e00\u96ea\u524d\u803b\uff0c\u7136\u540e\u7b2c\u4e00\u53d1\u80e1\u4e86\u4e2a\u8981\u7b97\u53ef\u91cd\u96c6\u7684\u95ee\u95ee\u95ee\u53cd\u6b63\u5c31\u53c8\u8981\u6eda\u4e24\u4e2a\u95ee\u95ee\u95ee\u7684\u524d\u7f00\u548c\u7684\u95ee\u95ee\u95ee\u4e1c\u897f\u3002\n\n\u4ec5\u4f7f\u7528\u4e86 1.5h \u5c31\u4e00\u96ea\u524d\u803b\uff0c\u8fd9\u662f\u597d\u4e8b\uff0c\u653e\u5728 NOIP \u8fd8\u662f\u6253\u4e0d\u5230 T4 \u66b4\u529b\uff0c\u5b9e\u5728\u662f\u592a\u597d\u4e86\u3002\n\n\u534a\u5e74\u524d\u6211\u5728 NOIP \u6298\u621f\u6c89\u6c99\uff0c\u534a\u5e74\u540e\u6211\u518d\u6b21\u5728 NOIP \u6298\u621f\u6c89\u6c99\u3002\n\n------------------------------------------------------------\n\n\u4e0d\u96be\u53d1\u73b0\u53ef\u4ee5\u5982\u679c\u5c06\u5e8f\u5217\u7684\u5143\u7d20\u56fa\u5b9a\u4e0d\u96be\u4f7f\u7528\u56fa\u5b9a\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u540e\u653e\u6570\u6570\u989c\u8272\u6bb5\u7684\u65b9\u6cd5 dp\uff0c\u7136\u540e\u5c31\u5f97\u8fb9\u5728\u72b6\u6001\u91cc\u9762\u8bbe\u4e00\u4e2a\u53ef\u91cd\u96c6\u6392\u5217\u8981\u7b97\u7684\u4e1c\u897f\u8fd8\u8981\u6eda\u4e24\u4e2a\u524d\u7f00\u548c\uff0c\u6bd4\u8f83\u590d\u6742\u3002\n\n\u53d1\u73b0\u662f\u987a\u5e8f\u76f8\u5173\u8f6c\u5316\u505a\u590d\u6742\u4e86\uff0c\u76f4\u63a5\u7528\u7ec4\u5408\u6570\u7b97\u4f4d\u7f6e\u7684\u9009\u62e9\u60c5\u51b5\u5c31\u53ef\u4ee5\u6b63\u5e38 dp \u4e86\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf\u8868\u8fbe\uff0c\u9898\u76ee\u4e2d\u7684 $k$ \u91c7\u7528 $K$ \u8868\u793a\u3002\n\n\u5177\u4f53\u7684\u53ef\u4ee5\u8bbe $dp_{i,j,k,l}$ \u8868\u793a\u503c\u57df\u4e0a\u524d $i$ \u4f4d\u5df2\u7ecf\u786e\u5b9a\uff0c\u9009\u4e86 $j$ \u4e2a\u4f4d\u7f6e\uff0c\u6b64\u65f6\u4e0d\u7b97\u4e0a\u5411\u540e\u8fdb\u4f4d\u7684 $1$ \u5df2\u7ecf\u6709\u4e86 $k$ \u4e2a $1$\uff0c\u6b64\u65f6\u5411\u540e\u9762\u7684\u4f4d\u4e00\u5171\u8fdb\u4e86 $l$ \u4e2a $1$ \u65f6\u7684\u5408\u6cd5\u5e8f\u5217\u603b\u6743\u503c\u548c\u3002\n\n\u8003\u8651\u8f6c\u79fb\u7684\u65f6\u5019\u6211\u4eec\u53ea\u9700\u8981\u679a\u4e3e\u7b2c $i + 1$ \u4f4d\u88ab\u9009\u62e9\u7684\u4e2a\u6570\u5373\u53ef\u8f6c\u79fb\u3002\n\n\u8f6c\u79fb\u65b9\u7a0b\uff0c\u679a\u4e3e\u88ab\u9009\u62e9\u7684\u4e2a\u6570 $p$\uff0c$delta$ \u8868\u793a\u5f53\u524d\u4f4d\u662f\u5426\u662f $1$\uff1a\n\n$dp_{i + 1,j + p,k+delta,\\lfloor\\frac{l+p}{2}\\rfloor} \\leftarrow dp_{i,j,k,l} \\times C_{n - j}^p \\times (a_{i + 1}) ^ p$\n\n\u76f8\u5f53\u4e8e\u662f\u5728\u5269\u4e0b\u6ca1\u88ab\u9009\u62e9\u7684\u4f4d\u7f6e\u91cc\u9762\u7684\u65b9\u6848\u6570\u518d\u4e58\u4e0a\u9009\u4e0a\u8fd9\u4e9b\u6570\u7684\u8d21\u732e\u5373\u65f6\u65b0\u7684\u5408\u6cd5\u5e8f\u5217\u603b\u6743\u503c\u548c\u3002\n\n\u6700\u540e\u5c06\u7b26\u5408\u9898\u610f\u7684 dp \u72b6\u6001\u52a0\u5165\u7b54\u6848\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n ^ 4 m)$\u3002\n\n```cpp\n/*\n\u8003\u8651 dp_{i,j,k,l} \u8868\u793a\u73b0\u5728\u9009\u5230\u4e86\u503c\u57df\u4e0a\u7684\u7b2c i \u4e2a\u6570\uff0c\u4e00\u5171\u9009\u4e86 j \u4e2a\u4f4d\u7f6e\uff0c\u4e00\u5171\u6709 k \u4e2a 1\uff08\u6ca1\u7b97 l \u7684\u8d21\u732e\uff09\uff0c\u5f53\u524d\u8fd9\u4e00\u4f4d\u88ab\u8fdb\u4e86 l \u4e2a 1\u65f6\u7684\u548c\n\u7136\u540e dp \u7684\u65f6\u5019\u7528\u7ec4\u5408\u6570\u8f85\u52a9\uff0c\u9700\u8981\u679a\u4e3e\u5f53\u524d\u9009\u4e86\u591a\u5c11\u6570\u2026\u2026\n*/\n#include \"bits/stdc++.h\"\nusing namespace std;\n#define int long long\n#define bpt __builtin_popcount \nconst int Len = 105 , mod = 998244353;\nint n,m,K,a[Len],C[Len][Len];\nint mul[Len][35];\nint dp[105][35][35][35];\nsigned main()\n{\n\tscanf(\"%lld %lld %lld\",&n,&m,&K);\n\tfor(int i = 1 ; i <= m + 2 ; i ++) \n\t{\n\t\tif(i <= m + 1) scanf(\"%lld\",&a[i]);\n\t\telse a[i] = 1;\n\t\tmul[i][0] = 1;\n\t\tfor(int j = 1 ; j <= n ; j ++) mul[i][j] = mul[i][j - 1] * a[i] % mod;\n\t}\n\tC[0][0] = C[1][0] = C[1][1] = 1;\n\tfor(int i = 2 ; i <= n ; i ++)\n\t{\n\t\tC[i][0] = 1;\t\n\t\tfor(int j = 1 ; j <= i ; j ++) C[i][j] = (C[i - 1][j] + C[i - 1][j - 1]) % mod;\n\t}\n\tdp[0][0][0][0] = 1;\n\tfor(int i = 0 ; i <= m + 1 ; i ++)\n\t{\n\t\tfor(int j = 0 ; j <= n ; j ++)\n\t\t\tfor(int k = 0 ; k <= n ; k ++) \n\t\t\t\tfor(int l = 0 ; l <= n ; l ++)\n\t\t\t\t{\n\t\t\t\t\t//printf(\"%lld %lld %lld %lld %lld\\n\",i,j,k,l,dp[i][j][k][l]);\t\n\t\t\t\t\tfor(int p = 0 ; p <= n - j ; p ++)//\u679a\u4e3e\u9009\u7684\u51e0\u4e2a\u6570 \n\t\t\t\t\t{\n\t\t\t\t\t\tint delta = (l + p) % 2;\n\t\t\t\t\t\tdp[i + 1][j + p][k + delta][(l + p) / 2] += dp[i][j][k][l] * C[n - j][p] % mod * mul[i + 1][p] % mod;\n\t\t\t\t\t\tdp[i + 1][j + p][k + delta][(l + p) / 2] %= mod;\n\t\t\t\t\t}\n\t\t\t\t}\n\t}\n\t//\u4ece dp_m + 2,n,?,? get \u7b54\u6848\n\tlong long ans = 0;\n\tfor(int i = 0 ; i <= K ; i ++)\n\t\tfor(int p = 0 ; p <= n ; p ++) if(bpt(p) + i <= K) ans = (ans + dp[m + 1][n][i][p]) % mod;\n\tprintf(\"%lld\\n\",ans);\t\t \n\treturn 0;\n}\n```",
        "postTime": 1649763949,
        "uid": 132533,
        "name": "Hakuoro",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P7961 [NOIP2021] \u6570\u5217"
    },
    {
        "content": "\u8003\u573a\u4e0d\u4f1a\u7ec4\u5408\u6570\uff0c\u5199\u4e86 50 \u5206\u66b4\u529b\u72b6\u538b\uff0c\u611f\u8c22 CCF \u7ed9\u4e86\u6211\u4e00\u4e2a\u4e00\u7b49\u3002\n\n\u6628\u5929\u6253 ABC243\uff0cF \u9898\u591a\u4e00\u4e2a\"+\"\u53f7\u6ca1\u80fd\u573a\u5207\uff0c\u90a3\u662f\u4e00\u9053 \u671f\u671b\u7ec4\u5408\u8ba1\u6570 dp\uff0c\u8ba9\u6211\u60f3\u5230\u4e86\u8fd9\u9898\uff0c\u5c31\u6765\u5199\u4e86\u4e00\u4e0b\uff0c\u611f\u53f9\u56db\u6708\u524d\u7684\u56f0\u6270\uff0c\u5982\u4eca\u534a\u5c0f\u65f6\u79d2\u6389\uff01\n\n\u5c06\u72b6\u6001\u8bbe\u4e00\u4e0b\uff08\u80af\u5b9a\u4e0d\u662f\u72b6\u538b\uff09\uff1a\u8bbe `f[i][j][k]` \u8868\u793a\u7528\u4e86 `i` \u4e2a\u6570\uff0c\u7ec4\u6210\u7684\u6570\u6709 `j` \u4f4d\uff0c\u5411\u9ad8\u4f4d\u8fdb\u4f4d\u4e3a `k`\u3002\n\n\u4f7f\u7528\u63d2\u677f\u8865\u5168\u6cd5\uff0c\u82e5\u539f\u6765\u6709 $p$ \u4e2a\u6570\uff0c\u73b0\u5728\u6709 $p'$ \u4e2a\u6570\uff0c\u5c06\u65b0\u589e\u7684\u6570\uff08\u65b0\u589e\u7684\u6570\u76f8\u4e92\u7b49\u4ef7\uff09\u63d2\u5165\u7684\u603b\u65b9\u6848\u6570\u4e3a $C_p^{p'}$\n\n\u901a\u8fc7\u63a8\u5bfc\u539f\u6765\u548c\u73b0\u5728\u7684\u6570\u5b57\u4f4d\u6570\uff0c\u53ef\u4ee5\u5f97\u5230\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n```\nq=l+((k+p-j)&1),r=(k+p-j)>>1;\nf[p][q][r]=(f[p][q][r]+(g[j][l][k]*ml%M)*C(p,j))%M;\n```\n\u6ce8\u610f\uff0c\u6700\u540e\u7edf\u8ba1\u7b54\u6848\u65f6\uff0c\u9700\u8981\u52a0\u4e0a\u8fdb\u4f4d\u6570\u5b57\u7684\u4e8c\u8fdb\u5236\u4f4d\u6570\uff0c\u4f7f\u7528\u5185\u7f6e\u51fd\u6570\u5373\u53ef\uff1a\n```\nfor(ml=j=0;j<=n;++j)\n\tfor(k=0;k<=n;++k)\n\t\tif(j+__builtin_popcount(k)<=K)\n\t\t\tml=(ml+f[n][j][k])%M;\n```",
        "postTime": 1647135449,
        "uid": 502410,
        "name": "EnofTaiPeople",
        "ccfLevel": 0,
        "title": "[NOIP2021] \u6570\u5217 \u9898\u89e3"
    },
    {
        "content": "## [NOIP2021] \u6570\u5217\n\n### \u9898\u610f\n\n\u7ed9\u5b9a\u6574\u6570 $n, m, k$ \u548c\u4e00\u4e2a\u957f\u5ea6\u4e3a $m + 1$ \u7684\u6b63\u6574\u6570\u6570\u7ec4 $v_0, v_1, \\ldots, v_m$ \u3002\n\n\u5b9a\u4e49\u4e00\u4e2a**\u5e8f\u5217** $ \\{a_n\\} $ \u7684\u6743\u503c\u4e3a $\\prod\\limits_{i=1}^nv_{a_i}$ \u3002\n\n\u6c42\u6240\u6709\u6ee1\u8db3 $Popcount\\left(\\sum\\limits_{i=1}^n2^{a_i}\\right) \\leq k$ \u7684\u5e8f\u5217 $ \\{a_n\\} $ \u6743\u503c\u4e4b\u548c\u3002\n\n### \u9898\u89e3\n\n#### \u7b97\u6cd5\u4e00\n\n\u66b4\u529b\u679a\u4e3e\u6bcf\u4e00\u4e2a $a_i$ \uff0c\u5bf9\u4e8e\u6bcf\u4e00\u79cd\u53ef\u80fd\u7684\u5e8f\u5217\u5355\u72ec\u8ba1\u7b97\u662f\u5426\u7b26\u5408\u8981\u6c42\u3001\u8ba1\u7b97\u6743\u503c\uff0c\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(m^n(logn+m))$ \u3002\n\n\u671f\u671b\u5f97\u5206 $20pts$ \u3002\n\n#### \u7b97\u6cd5\u4e8c\n\n\u3010\u6837\u4f8b\u89e3\u91ca #1\u3011\u542f\u53d1\u6211\u4eec\u5c06\u4e0a\u9762\u7684\u679a\u4e3e\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\u7684\u601d\u8def\u8f6c\u6362\u4e3a\u8003\u8651\u6bcf\u4e00\u4e2a $\\{a_n\\}$ \u4e2d\u53ef\u80fd\u7684\u53d6\u503c\u7684\u6570\u91cf\uff0c\u518d\u901a\u8fc7\u5feb\u901f\u5e42\u548c\u7ec4\u5408\u6570\u8ba1\u7b97\u6bcf\u4e00\u79cd\u65b9\u6848\u7684\u8d21\u732e\u3002\n\n\u6b64\u65f6\u679a\u4e3e\u7684\u590d\u6742\u5ea6\u5c31\u76f8\u5f53\u4e8e\u5c06 $n$ \u4e2a\u76f8\u540c\u7684\u7269\u54c1\u5212\u5206\u5230 $m+1$ \u4e2a\u4f4d\u7f6e\uff0c\u4e3a $O(C_{m+n}^m)$ \uff0c\u6b64\u65f6\u6070\u80fd\u901a\u8fc7\u7b2c\u4e8c\u7c7b\u6d4b\u8bd5\u70b9\u3002\n\n\u671f\u671b\u5f97\u5206 $35pts$ \u3002\n\n\u7531\u4e8e\u6b64\u601d\u8def\u6709\u52a9\u4e8e\u8fdb\u4e00\u6b65\u601d\u8003\u60f3\u51fa\u6b63\u89e3\uff0c\u6240\u4ee5\u653e\u51fa\u90e8\u5206\u6b64\u7b97\u6cd5\u7684\u5173\u952e\u4ee3\u7801\u3002\n\n```cpp\nvoid solve(int pos,int tot,ll cnt,ll val) {\n    // solve(0,n,0,1)\n    // pos \u8868\u793a\u5f53\u524d\u679a\u4e3e\u5230\u54ea\u4e00\u79cd\u53d6\u503c\n    // tot \u8868\u793a\u5269\u4f59\u591a\u5c11\u6ca1\u6709\u786e\u5b9a\u7684\u6570\n    // cnt \u6700\u7ec8\u5224\u65ad\u5e8f\u5217\u662f\u5426\u5408\u6cd5\n    // val \u8868\u793a\u5bf9\u4e8e\u7b54\u6848\u7684\u8d21\u732e\n    if(pos==m+1) {\n        if(Popcnt(cnt)<=k) {\n            if(tot==0) ans=(ans+val)%mod;\n        }\n        return;\n    }\n    for(int i=pos==m?tot:0;i<=tot;i++) {\n        solve(pos+1,tot-i,cnt+(i<<pos),val*fp(v[pos],i)%mod*C[tot][i]%mod);\n    }\n}\n```\n\n#### \u7b97\u6cd5\u4e09\n\n\u53d1\u73b0\u5bf9\u4e8e\u672c\u9898\u7684\u72b6\u6001\u7a7a\u95f4\u53ea\u9700\u7528\u679a\u4e3e\u5230\u7684\u4f4d\u6570 $pos$ \uff0c $\\{a_n\\}$ \u4e2d\u5df2\u7ecf\u786e\u5b9a\u4e86\u53d6\u503c\u7684\u6570\u91cf $tot$ \uff0c\u5e8f\u5217\u5408\u6cd5\u5224\u65ad\u503c $val$ \u5c31\u53ef\u4ee5\u8986\u76d6\u3002\u8003\u8651\u4f7f\u7528\u52a8\u6001\u89c4\u5212\u3002\n\n\u5982\u679c\u4f60\u4ed4\u7ec6\u8003\u8651\u4e0a\u9762\u7684\u601d\u8def\u5c31\u4f1a\u53d1\u73b0\u5e8f\u5217\u5408\u6cd5\u5224\u65ad\u503c $val$ \u7684\u53d6\u503c\u8303\u56f4\u5b9e\u5728\u662f\u592a\u5927\u4e86\uff0c\u6240\u4ee5\u601d\u8def\u6839\u672c\u4e0d\u6210\u7acb\u2014\u2014\u6211\u4eec\u63a5\u4e0b\u6765\u8981\u8003\u8651\u4f18\u5316\u7684\u5c31\u662f\u5e8f\u5217\u5408\u6cd5\u5224\u65ad\u503c $val$ \u3002\n\n\u8bbe $\\{a_n\\}$ \u4e2d\u53d6\u503c\u5728 $0$ \u5230 $i$ \u4e4b\u95f4\u7684\u6570\u6784\u6210\u7684\u5e8f\u5217\u5224\u65ad\u662f\u5426\u5408\u6cd5\u7684\u503c\u4e3a $val_i$ \uff0c\u4f8b\u5982 $\\{eg_n\\}$ \u5305\u542b $2$ \u4e2a $0$ \u548c $3$ \u4e2a $1$ \uff0c\u5176 $val_0=2\\times2^0=2,val_1=2\\times2^0+3\\times2^1=8$\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5df2\u7ecf\u786e\u5b9a $0$ \u5230 $i$ \u5404\u6570\u503c\u53d6\u503c\u6570\u91cf\u7684\u5e8f\u5217 $\\{a_n\\}$ \uff0c\u53d1\u73b0\u6700\u7ec8\u5224\u65ad\u5b83\u662f\u5426\u5408\u6cd5\u7684\u503c $val_n$ \u7684\u7b2c $0$ \u5230 $i$ \u4f4d\u4e8c\u8fdb\u5236\u4f4d\u5df2\u7ecf\u786e\u5b9a\uff0c\u6240\u4ee5\u53ef\u4ee5\u5c06 $val_i$ \u62c6\u89e3\u4e3a\u5176 $0$ \u5230 $i$ \u4f4d\u4e8c\u8fdb\u5236\u4f4d\u6240\u8868\u793a\u7684\u6570 $k_1$ \u548c\u5176 $i+1$ \u4f4d\u4ee5\u4e0a\u4e8c\u8fdb\u5236\u4f4d\u6240\u8868\u793a\u7684\u6570 $k_2$ \u3002\n\n\u5bf9\u4e8e $k_1$ \uff0c\u6700\u7ec8\u8ba1\u7b97 $Popcount(val_n)$ \u65f6\uff0c\u53ea\u9700\u7528\u5230 $Popcount(k_1)$ \uff1b\n\n\u800c $k_2$ \u6ee1\u8db3 $k_2=\\left\\lfloor\\dfrac{val_i}{2^i}\\right\\rfloor\\leq\\left\\lfloor\\dfrac{n\\sum^i_{j=0}2^j}{2^i}\\right\\rfloor\\leq2\\times{n}$ \u3002\n\n\u6240\u4ee5\u53ea\u9700\u7528 $Popcount(k_1),k2$ \u6765\u8868\u793a $val_i$ \u5373\u53ef\uff0c\u6b64\u65f6\u8868\u793a $val_i$ \u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a $O(nm)$ \u3002\n\n\u81f3\u6b64\uff0c\u52a8\u6001\u89c4\u5212\u6240\u9700\u7684\u72b6\u6001\u5c31\u5df2\u7ecf\u5f88\u660e\u786e\u4e86\uff1a\n\n $f(i,j,k,l)$ \u8868\u793a\u5df2\u7ecf\u786e\u5b9a\u4e86\u5e8f\u5217 $\\{a_n\\}$ \u4e2d $0$ \u5230 $i$ \u5404\u6570\u503c\u53d6\u503c\u6570\u91cf\uff0c\u6b64\u65f6\u5df2\u7ecf\u786e\u5b9a\u4e86 $j$ \u4e2a\u6570\u7684\u53d6\u503c\uff0c $k$ \u548c $l$ \u5206\u522b\u8868\u793a $val_i$ \u7684 $i+1$ \u4ee5\u4e0a\u7684\u4e8c\u8fdb\u5236\u4f4d\u7ec4\u6210\u7684\u6570\u548c $val_i$ \u7684\u7b2c $0$ \u5230 $i$ \u4f4d\u4e8c\u8fdb\u5236\u4f4d\u4e2d $1$ \u7684\u4e2a\u6570\u3002\n \n\u5229\u7528\u7b97\u6cd5\u4e8c\u7684\u601d\u8def\uff0c\u53ef\u4ee5\u5217\u51fa\u5982\u4e0b\u9012\u63a8\u65b9\u7a0b\uff1a\n\n$f(i,j,k,l) \\times v[i]^p \\times C^p_{n-j} \\rightarrow f(i+1,j+p,k/2+p,l+(k/2+p)\\bmod2)$\n\n\u5176\u4e2d\u7bad\u5934\u8868\u793a\u4f5c\u4e3a\u90e8\u5206\u8d21\u732e\uff0c $/2$ \u8868\u793a\u9664\u4ee52\u5411\u4e0b\u53d6\u6574\u3002\n\n\u672c\u7b97\u6cd5\u9700\u8981\u8d4b\u4e88\u6ee1\u8db3 $i=0$ \u7684 $f(i,j,k,l)$ \u521d\u503c\u4ee5\u4fbf\u8fdb\u884c\u9012\u63a8\uff0c\u8bf7\u5404\u4f4d\u8bfb\u8005\u81ea\u884c\u601d\u8003\u5982\u4f55\u8d4b\u4e88\u521d\u503c\u3002\n\n\u7edf\u8ba1\u7b54\u6848\u65f6\u9700\u8981\u7edf\u8ba1\u5df2\u7ecf\u786e\u5b9a\u4e86\u5e8f\u5217 $\\{a_n\\}$ \u4e2d $0$ \u5230 $m$ \u5404\u6570\u503c\u53d6\u503c\u6570\u91cf\u5171 $n$ \u4e2a\u7684\u6ee1\u8db3\u9898\u76ee\u6761\u4ef6\u7684\u5404\u5e8f\u5217\u8d21\u732e\u4e4b\u548c\uff0c\u4e5f\u9700\u8981\u8bfb\u8005\u81ea\u884c\u601d\u8003\u5982\u4f55\u7edf\u8ba1\u3002\n\n\u8fd9\u6837\u4e0b\u6765\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u4e00\u4e2a\u7a7a\u95f4\u590d\u6742\u5ea6 $O(n^2km)$  \uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3km)$ \u7684\u7b97\u6cd5\u901a\u8fc7\u672c\u9898\u4e86\u3002\n\n\u5982\u679c\u4f60\u5df2\u7ecf\u601d\u8003\u5b8c\u6bd5\uff0c\u53ef\u4ee5\u53c2\u8003\u5982\u4e0b\u4ee3\u7801\u9a8c\u8bc1\u4f60\u7684\u60f3\u6cd5\u3002\n\n```cpp\n#include<cstdio>\n#include<iostream>\n#define il inline\n#define gc getchar\nusing namespace std;\ntypedef long long ll;\nil ll read() {\n\tll x=0,sign=0;char ch=gc();\n\tfor(;ch>'9'||ch<'0';ch=gc())sign=ch=='-';\n\tfor(;ch<='9'&&ch>='0';ch=gc())x=(x<<3)+(x<<1)+ch-48;\n\treturn sign?-x:x;\n}\nconst int mod=998244353;\nconst int N=40;\nconst int M=1e2+10;\nint n,m,d;\nint v[M];\nll ans=0;\nll C[N][N];\nll f[M][N][N<<1][N];\nil ll fastPow(ll base,ll x) {\n\tll ret=1;\n\twhile(x) {\n\t\tif(x&1) ret=ret*base%mod;\n\t\tbase=base*base%mod;\n\t\tx>>=1;\n\t}\n\treturn ret;\n}\nil ll Popcount(int x) {\n    ll ret=0;\n\twhile(x) {\n\t\tret+=x&1;\n        x>>=1;\n\t}\n    return ret;\n}\nint main() {\n\tn=read(),m=read(),d=read();\n\tfor(int i=0;i<=m;i++)\n\t\tv[i]=read();\n\tfor(int i=0;i<=n;i++) C[i][0]=C[i][i]=1;\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<i;j++)\n\t\t\tC[i][j]=(C[i-1][j-1]+C[i-1][j])%mod; // \u9884\u5904\u7406\u7ec4\u5408\u6570\n\tfor(int i=0;i<=n;i++)\n\t\tf[0][i][i][i&1]=fastPow(v[0],i)*C[n][i]%mod; // i=0\u65f6\u7684\u521d\u503c\n\tfor(int i=0;i<m;i++)\n\t\tfor(int j=0;j<=n;j++)\n\t\t\tfor(int k=0;k<=n<<1;k++)\n\t\t\t\tfor(int l=0;l<=d;l++)\n\t\t\t\t\tfor(int p=0;j+p<=n;p++) {\n\t\t\t\t\t\tif(l+((k>>1+p)&1)>d) continue;\n\t\t\t\t\t\tf[i+1][j+p][(k>>1)+p][l+(((k>>1)+p)&1)]+=f[i][j][k][l]*fastPow(v[i+1],p)%mod*C[n-j][p]%mod;\n\t\t\t\t\t\tf[i+1][j+p][(k>>1)+p][l+(((k>>1)+p)&1)]%=mod; // \u8f6c\u79fb\u4e0e\u53d6\u6a21\n\t\t\t\t\t}\n\tfor(int i=0;i<=n<<1;i++)\n\t\tfor(int j=0;j<=d-Popcount(i>>1);j++)\n\t\t\tans=(ans+f[m][n][i][j])%mod; // \u7edf\u8ba1\u7b54\u6848\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1637854610,
        "uid": 115052,
        "name": "litim",
        "ccfLevel": 7,
        "title": "[NOIP2021] \u6570\u5217"
    },
    {
        "content": "\u8f6c\u5316\u4e00\u4e0b\u9898\u610f\uff1a\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5408\u6cd5\u7684 $a$ \u5e8f\u5217\uff0c\u53ef\u4ee5\u770b\u4f5c\u5bf9\u4e8e\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6570\u5728\u7b2c $a_x$ \u4f4d\u586b\u5165 $1$ \uff0c\u8981\u6c42\u6700\u7ec8\u7684\u6570 $1$ \u7684\u4e2a\u6570\u4e0d\u8d85\u8fc7 $k$ \u3002\n\n\u8003\u8651dp\u3002\n\n\u8bbe\u8ba1\u72b6\u6001 $f[i][j][p][q]$ \u8868\u793a\u524d $i$ \u4f4d\u586b\u5165\u4e86 $j$ \u4e2a $1$ \uff0c\u7b2c $i+1$ \u4f4d\u5806\u79ef\u4e86 $p$ \u4e2a $1$ \uff0c\u524d $i$ \u4f4d\u4e8c\u8fdb\u5236\u4e0b\u5171\u6709 $q$ \u4e2a$1$ \u7684\u7b54\u6848\u3002\n\n\u8f6c\u79fb\u5982\u4e0b\uff1a\n\n$f[i][j][p][q]=f[i-1][j-d][a][b]\\times val_i^d\\times\\binom{n-j+d}{d}$\n\n$d$ \u8868\u793a\u7b2c $i$ \u4f4d\u586b\u5165 $1$ \u7684\u4e2a\u6570\u3002\n\n$val_i^d$ \u8868\u793a $d$ \u4e2a $a_x$ \u53d6\u503c\u4e3a $i$ \u5e26\u6765\u7684\u8d21\u732e\u3002\n\n$\\binom{n-j+d}{d}$ \u8868\u793a $a$ \u5e8f\u5217\u7684\u7ec4\u5408\u60c5\u51b5\u3002\n\n$a b$ \u6ee1\u8db3\u4ee5\u4e0b\u7b49\u5f0f:\n\n$\\lfloor\\frac{a+d}{2}\\rfloor=p$\n\n$b+[a+d \\equiv1(mod\\space 2)]=q$\n\n\u5171\u6709\u4e24\u79cd\u60c5\u51b5\uff0c\u5206\u522b\u8f6c\u79fb\u5373\u53ef\u3002\n\n\u7b54\u6848\u7edf\u8ba1\uff1a\n\n$ans = \\sum f[m][n][i][0-(k-down(i))]$\n\n\u5176\u4e2d $down(i)$ \u8868\u793a $i$ \u4e8c\u8fdb\u5236\u8868\u793a\u4e0b $1$ \u7684\u4e2a\u6570\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^4m)$ \u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#define ll long long\nusing namespace std;\n\ntemplate<typename T>\n\ninline void read(T &x)\n{\n\tx = 0;\n\tbool tag = 0;\n\tchar c = getchar();\n\twhile(c<'0'||c>'9')\n\t{\n\t\tif(c=='-') tag = 1;\n\t\telse tag = 0;\n\t\tc = getchar();\n\t}\n\twhile(c>='0'&&c<='9') x = (x<<1) + (x<<3) + (c^48), c = getchar();\n\tif(tag) x = -x;\n}\n\ntemplate<typename T>\n\nvoid write(T x)\n{\n\tif(x<0) putchar('-'), x = -x;\n\tif(x>9) write(x/10);\n\tputchar('0'+x%10);\n}\n\nconst int N = 32, M = 102;\n\nconst int MOD = 998244353;\n\nll f[M][N][N][N];\n\nll v[M];\n\nll powv[M][N], c[N][N];\n\nint n,m,k;\n\nvoid pre()\n{\n\tfor(int i = 0;i<=m;i++)\n\t{\n\t\tpowv[i][0] = 1;\n\t\tfor(int j = 1;j<=n;j++)\n\t\t{\n\t\t\tpowv[i][j] = powv[i][j-1] * v[i] % MOD;\n\t\t}\n\t}\n\t\n\tfor(int i = 0;i<=n;i++)\n\t{\n\t\tc[i][0] = 1;\n\t\tfor(int j = 1;j<=i;j++)\n\t\t{\n\t\t\tc[i][j] = (c[i-1][j-1] + c[i-1][j]) % MOD;\n\t\t}\n\t}\n\t\n}\n\nint down(int x) \n{\n\tint cnt = 0;\n\twhile(x)\n\t{\n\t\tif(x&1) cnt++;\n\t\tx >>= 1;\n\t}\n\treturn cnt;\n}\n\nint main()\n{\n\tfreopen(\"sequence.in\",\"r\",stdin);\n\tfreopen(\"sequence.out\",\"w\",stdout);\n\tread(n), read(m), read(k);\n\tfor(int i = 0;i<=m;i++) read(v[i]);\n\tpre();\n\tfor(int j = 0;j<=n;j++)\n\t{\n\t\tf[0][j][j/2][j&1] = powv[0][j] * c[n][j] % MOD;\n\t}\n\tfor(int i = 1;i<=m;i++)\n\t{\n\t\tfor(int j = 0;j<=n;j++)\n\t\t{\n\t\t\tfor(int p = 0;p<=j/2;p++)\n\t\t\t{\n\t\t\t\tfor(int q = 0;q<=j;q++)\n\t\t\t\t{\n\t\t\t\t\tfor(int d = 0;d<=j;d++)\n\t\t\t\t\t{\n\t\t\t\t\t\tint a = 2*p - d;\n\t\t\t\t\t\tint b = q - (a+d)%2;\n\t\t\t\t\t\tif(a>=0&&b>=0)\tf[i][j][p][q] += f[i-1][j-d][a][b] * powv[i][d] % MOD * c[n-j+d][d] % MOD;\n\t\t\t\t\t\tf[i][j][p][q] %= MOD;\n\t\t\t\t\t\ta++;\n\t\t\t\t\t\tb = q - (a+d)%2;\n\t\t\t\t\t\tif(a>=0&&b>=0)\tf[i][j][p][q] += f[i-1][j-d][a][b] * powv[i][d] % MOD * c[n-j+d][d] % MOD;\n\t\t\t\t\t\tf[i][j][p][q] %= MOD;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint ans = 0;\n\tfor(int i = 0;i<=n;i++)\n\t{\n\t\tfor(int j = k-down(i);j>=0;j--)\n\t\t{\n\t\t\tans += f[m][n][i][j], ans %= MOD;\n\t\t}\n\t}\n\twrite(ans);\n\tputchar('\\n');\n\tfclose(stdin);\n\tfclose(stdout);\n\treturn 0;\n}\n\n```\n\n",
        "postTime": 1637572882,
        "uid": 113051,
        "name": "mofianger",
        "ccfLevel": 6,
        "title": "[NOIP2021] \u6570\u5217 \u9898\u89e3"
    },
    {
        "content": "\u539f\u6765\u8003\u573a\u4e0a\u63a8\u4e86\u4e24\u4e2a\u534a\u5c0f\u65f6\u7684 DP \u662f\u5bf9\u7684\uff0c\u53ea\u662f\u53cd\u63a8\u7ec6\u8282\u592a\u591a\uff0c\u56de\u5230\u5bb6\u7528\u6b63\u63a8\u5341\u5206\u949f\u5207\u3002\u5dee\u4e34\u95e8\u4e00\u811a\uff0c\u8fd8\u662f\u6c34\u5e73\u4e0d\u591f\u554a\u3002\n\n---\n\n\u9898\u610f\u5df2\u7ecf\u5f88\u6e05\u695a\u4e86\uff0c\u7ed3\u5408\u6837\u4f8b\u89e3\u91ca\u3001\u7b54\u6848\u53d6\u6a21\u3001\u6781\u5c0f\u7684\u6570\u636e\u8303\u56f4\uff0c\u53ef\u4ee5\u731c\u5230\u8fd9\u9898\u548c DP \u8131\u4e0d\u4e86\u5e72\u7cfb\u3002\n\n\u901a\u5e38\u800c\u8a00\uff0c\u5bf9\u4e8e\u8fd9\u79cd\u542b $k$ \u7684\u5f62\u4f3c DP \u7684\u9898\u76ee\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u5148\u53bb\u6389\u9898\u9762\u4e2d\u7684\u9650\u5236\u5bfb\u627e\u601d\u8def\u3002\u4f46\u56e0\u4e3a\u90e8\u5206\u5206\u6ca1\u6709\u7ed9\u8fd9\u4e00\u6863\uff0c\u5e76\u4e14\u4f3c\u4e4e\u53bb\u6389\u9650\u5236\u540e\u9898\u76ee\u6027\u8d28\u6709\u4e86\u8f83\u5927\u53d8\u5316\uff0c\u6545\u5148\u4e0d\u8003\u8651\u53bb\u6389 $k$ \u7684\u9650\u5236\u3002\n\n\u7a0d\u52a0\u601d\u8003\uff0c\u6211\u4eec\u53d1\u73b0\u4e00\u4e2a\u5408\u6cd5\u5e8f\u5217\u7684\u6743\u503c\u53ea\u548c\u8fd9\u4e2a\u5e8f\u5217\u4e2d\u6bcf\u4e2a\u6570\u7684**\u51fa\u73b0\u6b21\u6570**\u6709\u5173\uff0c\u800c\u548c\u5177\u4f53\u987a\u5e8f\u65e0\u5173\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5c06\u5e8f\u5217\u6392\u5e8f\uff0c\u4e58\u9002\u5f53\u7684\u7ec4\u5408\u7cfb\u6570\u540e\u5373\u53ef\u5f97\u5230\u672c\u8d28\u76f8\u540c\u7684\u5e8f\u5217\u7684\u6743\u503c\u548c\u3002\uff08\u8fd9\u91cc\u7684\u672c\u8d28\u76f8\u540c\u5373\u6307\u6392\u5e8f\u540e\u5404\u5143\u7d20\u5bf9\u5e94\u76f8\u540c\uff09\n\n\u89c2\u5bdf\u5230\u9898\u76ee\u4e2d\u7ed9\u7684\u9650\u5236\u548c\u4e8c\u8fdb\u5236\u6709\u5173\uff0c\u8054\u60f3\u5230\u4e8c\u8fdb\u5236\u7684\u6027\u8d28\u3002\u5982\u679c\u6211\u4eec\u6309\u7167**\u4e0b\u6807**\u4ece\u5c0f\u5230\u5927\u9009\uff0c\u90a3\u4e48\u5148\u9009\u7684\u6570\u53ef\u80fd\u8fdb\u4f4d\u5f71\u54cd\u5230\u540e\u9009\u7684\u6570\uff0c\u4f46\u540e\u9009\u7684\u6570\u7edd\u4e0d\u53ef\u80fd\u5f71\u54cd\u5230\u5148\u9009\u7684\u6570\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53\u7b2c $0$ \u4e2a\u6570\u5230\u7b2c $i$ \u4e2a\u6570\u9009\u7684\u6b21\u6570\u90fd\u5df2\u786e\u5b9a\uff0c\u90a3\u4e48\u5f53\u524d\u5e8f\u5217\u7684 $S$ \u524d $i+1$ \u4f4d\u968f\u4e4b\u56fa\u5b9a\u3002\u8fd9\u4f3c\u4e4e\u4f53\u73b0\u4e86**\u65e0\u540e\u6548\u6027**\uff1f\u4e0e\u6b64\u540c\u65f6\uff0c\u89c2\u5bdf\u5230\u5148\u9009\u7684\u6570\u5bf9\u540e\u9009\u7684\u6570\u5f71\u54cd\u6781\u4e3a\u6709\u9650\uff0c\u80fd\u5426\u628a\u5b83\u4e5f\u52a0\u5165 DP \u72b6\u6001\u4e2d\u5462\uff1f\n\n\u7ed3\u5408\u4ee5\u4e0a\u51e0\u70b9\uff0c\u4e00\u4e2a\u6a21\u7cca\u7684 DP \u601d\u8def\u6d6e\u51fa\u6c34\u9762\u3002\u8bbe $tot_{i,j,l,T}$ \u8868\u793a\u6743\u503c\u548c\uff0c\u7b2c\u4e00\u7ef4 $i$ \u8bb0\u5f55\u5f53\u524d\u9009\u5230\u4e86\u7b2c $i$ \u4e2a\u6570\uff0c\u7b2c\u4e8c\u7ef4 $j$ \u8bb0\u5f55\u4ece\u7b2c $0$ \u4e2a\u6570\u5230\u7b2c $i$ \u4e2a\u6570\u603b\u5171\u9009\u4e86 $j$ **\u6b21**\uff0c\u7b2c\u4e09\u7ef4 $l$ \u8bb0\u5f55\u76f4\u5230\u73b0\u5728 $S$ \u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e0b\u6700\u4f4e $i+1$ \u4f4d\u51fa\u73b0\u7684 $1$ \u7684\u4e2a\u6570\uff0c\u7b2c\u56db\u4f4d $T$ \u8bb0\u5f55\u76f4\u5230\u73b0\u5728 $S$ \u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e0b\u7b2c $i+2$ \u4f4d\u53ca\u4ee5\u4e0a\u7684\u6570\u8868\u793a\u7684\u5341\u8fdb\u5236\u6570\u3002\n\n\u4f46\u662f\u95ee\u9898\u6765\u4e86\uff1a\u5982\u4f55\u8f6c\u79fb\uff1f\u8003\u573a\u4e0a\u6211\u679a\u4e3e\u7684\u662f $i$\uff0c\u52a0\u5165 $i-1$ \u7684\u8d21\u732e\uff0c\u4f46\u662f\u5199\u8d77\u6765\u628a\u60c5\u51b5\u8003\u8651\u9519\u4e86\uff0c\u5bfc\u81f4\u7206\u96f6\u3002\u4e00\u79cd\u66f4\u597d\u7684\u5199\u6cd5\u662f\u679a\u4e3e $i$\uff0c\u8ba1\u7b97\u5176\u5bf9 $i+1$ \u7684\u8d21\u732e\u3002\n\n\u90a3\u4e48\u679a\u4e3e\u7b2c $i+1$ \u4e2a\u6570\u9009\u7684\u6b21\u6570 $t$\uff0c\u5bf9\u4e8e\u8f6c\u79fb\u7684\u7b54\u6848\u63a5\u53d7\u65b9\uff0c\u5176\u7b2c\u4e00\u7ef4\u5fc5\u5b9a\u662f $i+1$\uff0c\u7b2c\u4e8c\u7ef4\u662f $j+t$\u3002\u53d1\u73b0\u5f80\u53f3\u79fb\u52a8\u4e00\u4f4d\u4f1a\u5bfc\u81f4 $T$ \u7684\u6700\u4f4e\u4f4d\u4e22\u5931\u5e76\u88ab\u7edf\u8ba1\u5165 $l$\uff0c\u8bbe $T+t$ \u7684\u4e8c\u8fdb\u5236\u6700\u4f4e\u4f4d\u4e3a $p$\uff0c\u90a3\u4e48\u7b2c\u4e09\u7ef4\u662f $l+p$\uff0c\u7b2c\u56db\u7ef4\u4e3a $\\biggl \\lfloor \\dfrac{T+t}{2} \\biggr \\rfloor$\u3002\u8003\u8651\u6743\u503c\u7684\u8f6c\u79fb\uff0c\u7531\u4e8e\u7b2c $i+1$ \u4e2a\u6570\u9009\u4e86 $t$ \u6b21\uff0c\u8981\u4e58\u4e00\u4e2a $(val_{i+1})^t$\uff1b\u7531\u4e8e\u8fd9 $t$ \u4e2a $i+1$ \u8981\u88ab\u5206\u914d\u5230\u5269\u4e0b\u7684\u957f\u4e3a $n-j$ \u7684\u5e8f\u5217\u4e2d\uff0c\u90a3\u4e48\u8fd8\u8981\u518d\u4e58\u4e00\u4e2a $C(n-j,t)$ \u8ba1\u7b97\u987a\u5e8f\u3002\n\n\u7edf\u8ba1\u6700\u7ec8\u7b54\u6848\u65f6\u76f4\u63a5\u679a\u4e3e\u6700\u7ec8 $S$ \u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e0b $1$ \u7684\u4e2a\u6570\uff0c\u518d\u679a\u4e3e\u6700\u7ec8\u7684  $T$\uff0c\u5c06\u7b26\u5408\u6761\u4ef6\u7684\u52a0\u5165\u7b54\u6848\u5373\u53ef\u3002\n\n\u90a3\u4e48\u8fd9\u9898\u5c31\u505a\u5b8c\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(mn^4)$\u3002\n\n\u5177\u4f53\u53ef\u4ee5\u89c1\u4ee3\u7801\uff0c\u4e2a\u4eba\u4e60\u60ef\u5c06 $n,m$ \u4ea4\u6362\uff0c\u5faa\u73af\u53d8\u91cf\u4e5f\u7565\u6709\u4e0d\u540c\u3002\n\n```cpp\n#include<algorithm>\n#include<cstdio>\n#include<vector>\nconst int maxn=1e2+5;\nconst int maxm=3e1+5;\nconst int mod=998244353;\nint n,m,k;\nint val[maxn];\nint tot[maxn][maxm][maxm][maxm];\nint po[maxn][maxm];\nint lowbit(int x){return x&-x;}\nint inv[maxn],fact[maxn],finv[maxn];\nvoid init(){\n\tinv[0]=inv[1]=fact[0]=fact[1]=finv[0]=finv[1]=1;\n\tfor(int i=2;i<=maxm-2;i++){\n\t\tinv[i]=1ll*(mod-mod/i)*inv[mod%i]%mod;\n\t\tfact[i]=1ll*fact[i-1]*i%mod;\n\t\tfinv[i]=1ll*finv[i-1]*inv[i]%mod;\n\t}\n\treturn;\n}\nint bigc(int x,int y){return 1ll*fact[x]*finv[y]%mod*finv[x-y]%mod;}\nsigned main(){\n//\tfreopen(\"sequence.in\",\"r\",stdin);\n//\tfreopen(\"sequence.out\",\"w\",stdout);\n\tinit();\n\tscanf(\"%d%d%d\",&m,&n,&k);\n\tfor(int i=0;i<=n;i++){\n\t\tscanf(\"%d\",val+i);\n\t\tpo[i][0]=1;\n\t\tfor(int j=1;j<=m;j++)po[i][j]=1ll*po[i][j-1]*val[i]%mod;\n\t}\n\tfor(int j=0;j<=m;j++)tot[0][j][j&1][(j>>1)]=1ll*po[0][j]*bigc(m,j)%mod;\n\tfor(int i=0;i<=n-1;i++)\n\t\tfor(int j=0;j<=m;j++)\n\t\t\tfor(int l=0;l<=m;l++)\n\t\t\t\tfor(int nS=0;nS<=m;nS++)\n\t\t\t\t\tfor(int nc=0;nc<=m-j;nc++){\n\t\t\t\t\t\t(tot[i+1][j+nc][l+((nc+nS)&1)][(nS+nc)/2]+=\n\t\t\t\t\t\t\t1ll*tot[i][j][l][nS]*bigc(m-j,nc)%mod*po[i+1][nc]%mod)%=mod;\n//\t\t\t\t\t\tif(1ll*tot[i][j][l][nS]*bigc(m-j,nc)%mod*po[i+1][nc]%mod)\n//\t\t\t\t\t\t\tprintf(\"i=%d,j=%d,l=%d,nS=%d,nc=%d,tot[%d][%d][%d][%d]+=%lld\\n\",\n//\t\t\t\t\t\t\t\ti,j,l,nS,nc,i+1,j+nc,l+((nc+nS)&1),(nS+nc)/2,\n//\t\t\t\t\t\t\t\t1ll*tot[i][j][l][nS]*bigc(m-j,nc)%mod*po[i+1][nc]%mod);\n\t\t\t\t\t}\n\tint res=0;\n\tfor(int nk=1;nk<=k;nk++){\n\t\tfor(int nS=0;nS<=m;nS++){\n\t\t\tint ts=nS;\n\t\t\tint cou=0;\n\t\t\twhile(lowbit(ts))cou++,ts-=lowbit(ts);\n\t\t\tif(nk<cou)continue;\n//\t\t\tprintf(\"tot[n][m][%d][%d]=%d\\n\",nk-cou,nS,tot[n][m][nk-cou][nS]);\n\t\t\t(res+=tot[n][m][nk-cou][nS])%=mod;\n\t\t}\n\t}\n\tprintf(\"%d\",res);\n\treturn 0;\n}\n/*\ntot[i][j][l][S] means the total of:\nin first i+1 elements, choose j times, have l '1' before, the influence is S.\nTotally choose m, the len of the line is n.\n5 1 1\n2 1\n*/\n/*\n8 9 4\n934258593 150407625 187068439 162292791 219945760 512449588 803393963 983648121 484675481 412407699\n*/\n```\n\n\u611f\u8c22\u60a8\u7684\u9605\u8bfb\uff01",
        "postTime": 1637505159,
        "uid": 293810,
        "name": "serene_analysis",
        "ccfLevel": 7,
        "title": "P7961 [NOIP2021] \u6570\u5217"
    },
    {
        "content": "## \u9898\u76ee\u7b80\u8ff0\n\n[ P7961 [NOIP2021] \u6570\u5217](https://www.luogu.com.cn/problem/P7961)\n\n\u6c42\u6240\u6709\u6ee1\u8db3\u8981\u6c42\u7684\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217 $a$ \u7684\u6743\u503c\u603b\u548c\u3002\n- \u8981\u6c42\uff1a$2^{a_1} + 2^{a_2} + \\cdots + 2^{a_n}$ \u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e2d $1$ \u7684\u4e2a\u6570\u4e0d\u8d85\u8fc7 $k$\u3002\n- \u6743\u503c\uff1a$v_{a_1} \\times v_{a_2} \\times \\cdots \\times v_{a_n}$\uff0c\u56e0\u4e3a\u5e8f\u5217 $v$ \u7684\u957f\u5ea6\u4e3a $m+1$\uff0c\u6240\u4ee5\u5e8f\u5217 $a$ \u4e2d\u6240\u6709\u6570\u7684\u53d6\u503c\u5c0f\u4e8e\u7b49\u4e8e $m$\uff0c\u5927\u4e8e\u7b49\u4e8e $0$\u3002\n\n\n$1 \\leq k \\leq n \\leq 30$\uff0c$0 \\leq m \\leq 100$\uff0c\u7ed3\u679c\u5bf9 $998244353$ \u53d6\u6a21\u3002\n\n## \u9898\u76ee\u5206\u6790\n\n\u56e0\u4e3a\u8ddf\u4e8c\u8fdb\u5236\u626f\u4e0a\u5173\u7cfb\uff0c\u5e76\u4e14\u6574\u4f53\u7684\u6570\u636e\u8303\u56f4\u8f83\u5c0f\uff0c\u6240\u4ee5\u8003\u8651\u7528\u72b6\u6001\u538b\u7f29\u52a8\u6001\u89c4\u5212\u6765\u6c42\u89e3\u3002\n\n\u5148\u5199\u6700\u66b4\u529b\u7684\u65b9\u6cd5\uff0c\u76f4\u63a5\u628a $s$ \u7684\u503c\u653e\u5728\u72b6\u6001\u91cc\u3002\u4f9d\u6b21\u679a\u4e3e\u5e8f\u5217 $a$ \u7684\u6bcf\u4e2a\u4f4d\u7f6e\uff0c\u6bcf\u4e2a\u4f4d\u7f6e\u6709 $m+1$ \u79cd\u9009\u62e9\u3002\u90a3\u4e48\u5bb9\u6613\u5f97\u5230\u4ee5\u4e0b\u641c\u7d22\uff1a\n\n```cpp\n//now\u8868\u793aa\u4e2d\u7684\u4f4d\u7f6e\uff0ccnt\u662fs\u4e2d1\u7684\u4e2a\u6570\u3002\u56e0\u4e3as\u786e\u5b9a\u4e86cnt\u5c31\u786e\u5b9a\u4e86\uff0c\u6240\u4ee5\u4e0d\u7b97\u4e00\u4e2a\u72b6\u6001\uff0c\u53ea\u662f\u4e00\u4e2a\u8f85\u52a9\u53d8\u91cf\u3002\nll dfs(int now,ll s,int cnt){ \n\tif(now>n)return cnt<=k; //\u5230\u5934\u4e86\uff0c\u5982\u679c1\u7684\u6570\u91cf\u5c0f\u4e8e\u7b49\u4e8ek\uff0c\u5c31\u662f\u4e00\u79cd\u60c5\u51b5\uff0c\u5426\u5219\u4e0d\u662f\u3002\n\tif(vst[now][s])return f[now][s]; //\u8bb0\u5fc6\u5316\u641c\u7d22\n\tvst[now][s]=true;\n\tll res=0;\n\tfor(int i=0;i<=m;i++){ //m+1\u79cd\u9009\u62e9\u90fd\u8bd5\u4e00\u8bd5\n\t\tll buf=s+(1ll<<i),count=0; //s\u52a0\u4e0a2^a[now]\n\t\tfor(ll j=buf;j;j-=j&-j)count++; //\u6570\u4e00\u6570\u65b0s\u76841\u7684\u4e2a\u6570\n\t\tres=(res+dfs(now+1,buf,count)*v[i])%mod; //\u7d2f\u52a0\u6743\u503c\n\t}\n\treturn f[now][s]=res;\n}\n```\n[\u8fd9\u6837](https://www.luogu.com.cn/record/75982540)\u5c31\u53ef\u4ee5\u5f97 $50pts$ \u4e86\uff0c~~\u5df2\u7ecf\u662f\u5168\u56fd\u4e00\u7b49\u5956\u4e86~~\uff0c\u8ba9\u6211\u4eec\u7ee7\u7eed\u6539\u8fdb\u7b97\u6cd5\u3002\n\n\u6574\u4f53\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u9ad8\u5f88\u5927\u7a0b\u5ea6\u4e0a\u662f\u56e0\u4e3a\u72b6\u6001 $s$\uff0c\u4f46\u56e0\u4e3a\u8981\u8bb0\u5f55 $1$ \u7684\u4e2a\u6570\uff0c\u6211\u4eec\u53c8\u4e0d\u80fd\u5c06\u5176\u7701\u53bb\uff0c\u6240\u4ee5\u601d\u8003\u5982\u4f55**\u5316\u7b80**\u8fd9\u4e2a\u72b6\u6001\u3002\n\n\u4e8c\u8fdb\u5236\u4e2d $1$ \u7684\u4e2a\u6570\u662f\u6ee1\u8db3**\u65e0\u540e\u6548\u6027**\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u5728\u67d0\u4e2a\u4f4d\u7f6e\u4e00\u76f4\u52a0 $1$ \u53ea\u4f1a\u5bf9\u540e\u9762\u7684\u9ad8\u4f4d\u4ea7\u751f\u5370\u8c61\uff0c\u5bf9\u524d\u9762\u7684\u4f4e\u4f4d\u662f\u6ca1\u6709\u5f71\u54cd\u7684\uff08\u4f4e\u4f4d\u662f\u524d\uff0c\u9ad8\u4f4d\u662f\u540e\uff0c\u4e0d\u662f\u540e\u6548\u6027\u7684\"\u540e\"\uff09\u3002\n\n\u6211\u4eec\u77e5\u9053\u6700\u591a\u52a0 $n$ \u6b21 $1$\uff0c\u56e0\u4e3a\u5e8f\u5217 $a$ \u7684\u957f\u5ea6\u4e3a $n$\u3002\n\u6240\u4ee5 $s$ \u4e0d\u9700\u8981\u5168\u90e8\u8bb0\u5f55\uff0c**\u53ea\u9700\u8981\u8bb0\u5f55\u4f1a\u88ab\u5f71\u54cd\u7684\u540e\u51e0\u4f4d**\u5c31\u53ef\u4ee5\u4e86\uff0c\u56e0\u4e3a\u53ea\u6709\u8fd9\u4e9b\u4f4d\u4e0a $1$ \u7684\u4e2a\u6570\u4f1a\u53d1\u751f\u53d8\u5316\u3002\u56e0\u4e3a $n$ \u5c0f\u4e8e\u7b49\u4e8e $30$\uff0c\u6240\u4ee5 $s$ \u5f00 $30$ \u5c31\u8db3\u591f\u4e86\u3002\u6bcf\u6b21\u7b97\u5b8c\u628a\u6700\u4f4e\u4f4d\u53bb\u9664\uff0c\u4f4d\u7f6e\u8d21\u732e\u51fa\u6765\u8bb0\u5f55\u65b0\u7684\u6700\u9ad8\u4f4d\u3002\n\n\u6b64\u65f6\u4e4b\u524d\u7684\u865a\u5047\u72b6\u6001 $cnt$ \u53d8\u6210\u5b9e\u4f53\u72b6\u6001\u4e86\uff0c\u56e0\u4e3a $s$ \u4e2d\u7701\u7565\u7684\u4e0d\u53d8\u4fe1\u606f\uff0c\u4f4e\u4f4d\u7684 $1$ \u7684\u4e2a\u6570\uff0c\u9700\u8981\u4e00\u4e2a\u8f7d\u4f53\u3002\u6700\u5927\u503c\u4e5f\u662f $30$\uff0c\u4e5f\u5c31\u662f\u6240\u6709\u9009\u62e9\u90fd\u4e0d\u4e00\u6837\u7684\u65f6\u5019\u6709 $30$ \u4e2a $1$\u3002\n\n\u6709\u4e2a\u95ee\u9898\uff0c\u5982\u679c\u50cf\u4e4b\u524d\u4e00\u6837\u4f9d\u6b21\u679a\u4e3e\u5e8f\u5217 $a$ \u7684 $n$ \u4e2a\u4f4d\u7f6e\uff0c\u6bcf\u4e2a\u4f4d\u7f6e $m+1$ \u79cd\u9009\u62e9\uff0c\u5c31\u53ef\u80fd\u51fa\u73b0\u540e\u9762\u9009\u7684\u6bd4\u524d\u9762\u5c0f\u7684\u53ef\u80fd\uff0c\u65e0\u540e\u6548\u6027\u5c31\u88ab\u6253\u7834\u4e86\u3002\n\n\u6240\u4ee5\u9700\u8981\u7528\u65b0\u7684\u679a\u4e3e\u65b9\u6cd5\uff0c\u4f9d\u6b21\u679a\u4e3e $m+1$ \u79cd\u9009\u62e9\uff0c\u7136\u540e\u518d\u50cf\u80cc\u5305\u95ee\u9898\u4e00\u6837\u679a\u4e3e\u8be5\u9009\u62e9\u7684\u51fa\u73b0\u6b21\u6570\u3002\u8fd9\u6837\u53ea\u8981\u4ece\u5c0f\u5230\u5927\u679a\u4e3e $m+1$ \u79cd\u9009\u62e9\u5c31\u80fd\u6ee1\u8db3\u540e\u6548\u6027\u4e86\u3002\n\n\u53c8\u6709\u4e2a\u95ee\u9898\uff0c\u9898\u76ee\u4e2d\u8bf4\u7684\u662f\u5982\u679c\u5e8f\u5217 $a$ \u7684\u9009\u62e9\u4e00\u6837\u4f46\u987a\u5e8f\u4e0d\u540c\u4e5f\u7b97\u591a\u79cd\u60c5\u51b5\uff0c\u4f46\u7528\u4e0a\u9762\u7684\u679a\u4e3e\u65b9\u6cd5\u5c31\u53ea\u7b97\u4e00\u79cd\u60c5\u51b5\u4e86\u3002\u6240\u4ee5\u8981\u4e58\u4e0a\u4e2a\u7ec4\u5408\u6570\uff0c\u8868\u793a\u8fd9\u4e48\u591a\u4e2a\u4f4d\u7f6e\u4e2d**\u9009\u51e0\u4e2a\u7528\u6765\u653e\u5f53\u524d\u9009\u62e9**\u4e00\u5171\u6709\u591a\u5c11\u79cd\u65b9\u6cd5\u3002\u7ec4\u5408\u6570\u662f\u53ef\u4ee5\u9884\u5904\u7406\u7684\u3002\n\n\u6700\u7ec8\u5f97\u5230\u4e86\u6ee1\u5206\u6b63\u89e3\uff0c~~\u53ef\u4ee5\u8fdb\u5f31\u7701\u7701\u961f\u4e86~~\uff01\n\n## code\n```cpp\n#include<bits/stdc++.h>\n#define N 35\n#define M 105\n#define mod 998244353\n#define ll long long\nusing namespace std;\n\nll n,m,k,v[M],f[M][N][N][N],c[N][N];\nbool vst[M][N][N][N];\n\nvoid init(){ //\u7ec4\u5408\u6570\u521d\u59cb\u5316\n\tc[0][0]=1;\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=0;j<=i;j++)\n\t\t\tc[i][j]=(c[i-1][j]+c[i-1][j-1])%mod;\t\n}\n\n//\u5206\u522b\u8868\u793a\u7b2cnow\u4e2a\u9009\u62e9\uff08\u7b2cnow\u4e2a\u4f4d\u7f6e\u4e0a\u76841\uff09\uff0c\u5e8f\u5217a\u5269\u4f59size\u4e2a\u7a7a\u4f4d\u7f6e\uff0c\u5f53\u524dcnt\u4e2a1\nll dfs(int now,int size,int cnt,int s){\n\tif(now>m)return size==n?cnt<=k:0; //\u9009\u5b8c\u4e86\uff0c\u6ee1\u8db3\u8981\u6c42\u5e76\u4e14\u5e8f\u5217a\u90fd\u586b\u5b8c\u4e86\uff08\u53ef\u80fd\u6ca1\u586b\u5b8c\uff09\n\t\n\tif(vst[now][size][cnt][s])return f[now][size][cnt][s]; //\u8bb0\u5fc6\u5316\n\tvst[now][size][cnt][s]=true;\n\t\n\tint count1=0,count2=0,buf=s;\n\twhile(buf)buf-=buf&-buf,count1++; //\u8ba1\u7b97\u521d\u59cb\u60c5\u51b5\u4e0b\u7684s\u4e2d1\u7684\u4e2a\u6570\n\tll res=0,mul=1;\n\tfor(int i=0;i+size<=n;i++){ //\u679a\u4e3e\u5f53\u524d\u9009\u62e9\u5728\u5e8f\u5217\u4e2d\u7684\u51fa\u73b0\u6b21\u6570\n\t\tbuf=s+i,count2=0; //\u5f97\u5230\u65b0\u7684s\n\t\twhile(buf)buf-=buf&-buf,count2++; //\u8ba1\u7b97\u65b0\u7684s\u4e2d1\u7684\u4e2a\u6570\n\t\tres+=dfs(now+1,size+i,cnt-count1+count2,(s+i)/2)*mul%mod*c[i+size][i]%mod;\n        \t//\u96642\u5c31\u662f\u53bb\u6389\u4ee5\u540e\u4e0d\u4f1a\u518d\u53d8\u7684\u6700\u4f4e\u4f4d\uff0c\u628a\u4f4d\u7f6e\u8d21\u732e\u51fa\u6765\u8bb0\u5f55\u4ee5\u540e\u53ef\u80fd\u4f1a\u53d8\u7684\u65b0\u7684\u6700\u9ad8\u4f4d\u3002\n\t\tres%=mod; mul=mul*v[now]%mod;\n\t}\n\treturn f[now][size][cnt][s]=res;\n}\n\nint main(){\n\tcin>>n>>m>>k;\n\tinit();\n\tfor(int i=0;i<=m;i++)cin>>v[i];\n\tcout<<dfs(0,0,0,0);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1653490990,
        "uid": 438957,
        "name": "retep",
        "ccfLevel": 4,
        "title": "[NOIP2021] \u6570\u5217 \u9898\u89e3"
    },
    {
        "content": "- \u591a\u5199\u9898\u89e3\u4ece\u6211\u505a\u8d77\u3002\n- \u52ff\u505a\u659c\u6760\u9752\u5e74\u4ece\u6211\u505a\u8d77\u3002\n- \u5e0c\u671b\u4f5c\u8005\u4e0d\u8981\u7206\u96f6\u3002\n\n**\u9898\u610f**\n- [\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/P7961)\u3002\n- \u7ed9\u5b9a $n,m,k$\uff0c\u548c\u957f\u5ea6\u4e3a $m+1$ \u7684\u6b63\u6574\u6570\u6570\u5217 $v_0,v_1,v_2\\cdots v_m$\u3002\n- \u5b9a\u4e49\u4e00\u4e2a\u5408\u6cd5\u7684\u5e8f\u5217\u662f\u5f62\u5982\u957f\u5ea6\u4e3a $n$ \u7684\uff0c\u6bcf\u4e2a\u6570\u7684\u503c\u90fd\u662f $0$ \u548c $m$ \u95f4\u7684\u975e\u8d1f\u6574\u6570\u7684\u5e8f\u5217\uff08\u53ef\u4ee5\u91cd\u590d\u7684\u6392\u5217\uff09 $a_1,a_2,\\cdots,a_n$\uff0c\u4e14\u6ee1\u8db3 $S=2^{a_0}+2^{a_1}+\\cdots+2^{a_n}$ \u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e2d $1$ \u7684\u4e2a\u6570\u4e0d\u8d85\u8fc7 $k$\uff0c\u800c\u4e14\u5b9a\u4e49\u8be5\u5408\u6cd5\u5e8f\u5217\u7684\u6743\u503c\u4e3a $v_{a_1}\\times v_{a_2}\\times\\cdots\\times v_{a_n}$\u3002\n- \u6c42\u6240\u6709\u5408\u6cd5\u5e8f\u5217\u7684\u6743\u503c\u548c\u5bf9 $998244353$ \u53d6\u6a21\u7684\u7ed3\u679c\u3002\n\n**\u66b4\u529b\u5b9e\u73b0**\n- \u66b4\u529b\u5b9e\u73b0\u7684\u4f5c\u7528\u662f\u5bf9\u62cd\u548c\u4fdd\u8bc1\u81ea\u5df1\u7406\u89e3\u8be5\u9898\u76ee\u7684\u9898\u610f\u3002\n- \u5bf9\u7b14\u8005\u8fd9\u6837\u7684\u83dc\u9e21\u5f88\u6709\u6548\u3002\n- \u65f6\u95f4\u590d\u6742\u5ea6 $O((m+1)^n)$ \u4f46\u53ef\u4ee5\u8fc7\u5927\u6837\u4f8b\u3002\n- [\u66b4\u529b\u5b9e\u73b0](https://www.luogu.com.cn/paste/o4lu3epa)\u3002\n\n**\u601d\u8def**\n- \u9996\u5148\u8fd9\u4e2a\u6570\u5217 $a_i$ \u7684\u987a\u5e8f\u4e0d\u662f\u8d39\u4e25\u683c\u9012\u589e\u7684\u8ba9\u4eba\u611f\u5230\u5f88\u6076\u5fc3\uff0c\u7531\u4e8e\u5176\u5b83\u9650\u5236\u90fd\u4e0d\u8003\u8651\u987a\u5e8f\uff0c\u8003\u8651\u7528\u7ec4\u5408\u6570\u5b66\u5c06\u5b83\u8f6c\u5316\u4e3a\u4e00\u4e2a\u65e0\u540e\u6548\u6027\u7684 DP\u3002\n- \u7136\u540e\u6709\u4e00\u4e2a\u6027\u8d28\uff1a\u8ba9\u8fd9\u9898\u7684\u72b6\u6001\u6570\u8f6c\u53d8\u4e3a\u591a\u9879\u5f0f\u7ea7\u522b\u3002\n- \u770b\u8d77\u6765\u72b6\u6001\u6570\u662f $n\\times 2^n$ \u7684\uff0c\u4f46\u5b9e\u9645\u4e0a\u679a\u4e3e\u5230 $v_i$ \u7684\u65f6\u5019\uff0c$0$ \u5230 $i-1$ \u4f4d\u90fd\u4e0d\u9700\u8981\u5728\u610f\u4e86\uff0c\u53ef\u4ee5\u7528\u4e00\u4e2a\u6570\u7ec4\u4fdd\u5b58\u5b83\u7684\u4e2a\u6570\uff0c\u800c $\\lfloor S/2^i\\rfloor\\le n$ \u662f\u663e\u7136\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u518d\u7528\u4e00\u4e2a\u6570\u7ec4\u4fdd\u5b58\u3002\n- \u770b\u8d77\u6765\u5f88\u597d\u3002\n- \u63a5\u4e0b\u6765\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u7ec4\u5408\u6570\u5b66\u95ee\u9898\uff1a\u6709 $a$ \u4e2a\u9ed1\u7403\uff0c$b$ \u4e2a\u767d\u7403\uff0c\u6392\u5217\u603b\u5171\u6709\u591a\u5c11\u79cd\u53ef\u80fd\uff0c\u663e\u7136\u662f $C(a+b,a)$ \u79cd\u3002\n- \u4e8e\u662f\u6211\u4eec\u8bbe\u51fa\u72b6\u6001 $f(i,A,a,g)$ \u8868\u793a $a_1,a_2,\\cdots a_g$ \u53d6\u503c\u5728 $0$ \u5230 $i$ \u4e4b\u95f4\uff0c\u5176\u4e2d $S$ \u7684 $0$ \u5230 $i-1$ \u4f4d 1 \u7684\u4e2a\u6570\u4e3a $a$\uff0c$\\lfloor S/2^i\\rfloor$ \u503c\u4e3a $A$ \u7684\u5e8f\u5217\u6743\u503c\u548c\u3002\n- \u6709\u521d\u59cb\u72b6\u6001\uff1a\n$$f(0,j,0,j)=v_0^j$$\n- \u679a\u4e3e\u6570\u5217\u4e2d $v_{i+1}$ \u7684\u4e2a\u6570 $j$\uff0c\u6709\u8f6c\u79fb\u72b6\u6001\uff1a\n$$f(i,A,a,g)\\times C(g+j,j)\\times v_{i+1}^j\\rightarrow f(i+1,\\lfloor A/2\\rfloor+j,a+(A\\bmod 2),g+j)$$\n- \u5176\u5b9e\u6211\u4e00\u5f00\u59cb\u8fd8\u60f3\u5c94\u4e86\u591a\u5f00\u4e86\u4e00\u7ef4\uff0c~~\u7136\u540e\u5c31\u7206\u7a7a\u95f4\u3002~~\n- \u9884\u5904\u7406\u7ec4\u5408\u6570\u548c $v_i$ \u7684\u5e42\u7684\u8bdd\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(mn^4)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $\\Theta(mn^3)$\uff0c\u5b9e\u73b0\u8fc7\u5173\u7684\u8bdd\u662f\u4e0d\u4f1a\u51fa\u95ee\u9898\u7684\u3002\n- [\u4ee3\u7801\u5b9e\u73b0](https://www.luogu.com.cn/paste/ynql0wr7)\u3002\n- \u5982\u679c\u6015\u7a7a\u95f4\u95ee\u9898\u7684\u8fd8\u53ef\u4ee5\u6eda\u52a8\u6570\u7ec4\u6d88\u6389\u4e00\u7ef4\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $\\Theta(n^3+nm)$\uff0c\u5b9e\u6d4b\u65f6\u95f4\u590d\u6742\u5ea6\u6709\u63d0\u5347\u3002\n- [\u4ee3\u7801\u5b9e\u73b0](https://www.luogu.com.cn/paste/ljdimwz2)\u3002\n\n**\u540e\u8bdd**\n```cpp\n__builtin_popcount()\n```\n- \u8fd9\u662f\u4e2a\u597d\u4e1c\u897f\uff0c$\\text{CCF}$ \u5ffd\u7136\u5f00\u7981\u4e86\uff0c~~\u4e0d\u8fc7\u7b14\u8005\u76ee\u524d\u4e0d\u592a\u6562\u7528~~\u3002\n- [\u5173\u4e8eNOI\u7cfb\u5217\u6d3b\u52a8\u4e2d\u7f16\u7a0b\u8bed\u8a00\u4f7f\u7528\u9650\u5236\u7684\u8865\u5145\u8bf4\u660e](https://www.noi.cn/xw/2021-09-01/735729.shtml)\u3002\n- \u4f3c\u4e4e\u6709\u4eba\u8ba4\u4e3a\u8fd9\u9898 $n$ \u5f00\u5f97\u592a\u5c0f\u5bb9\u6613\u8ba9\u4eba\u60f3\u5230\u66b4\u529b\uff1f\u7b14\u8005\u89c9\u5f97 $m$ \u7684\u5927\u5c0f\u4f1a\u8ba9\u4eba\u6253\u6d88\u8fd9\u4e2a\u5ff5\u5934\u3002",
        "postTime": 1637830384,
        "uid": 260884,
        "name": "WeLikeStudying",
        "ccfLevel": 0,
        "title": "[NOIP2021]\u6570\u5217"
    },
    {
        "content": "[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P7961)\n\n\u9898\u76ee\u5927\u6982\u610f\u601d\u5728\u9898\u76ee\u63cf\u8ff0\u91cc\u5df2\u7ecf\u5f88\u6e05\u6670\u4e86\uff0c\u5728\u8fd9\u91cc\u4e0d\u505a\u8fc7\u591a\u89e3\u91ca\u3002\n\n\u9996\u5148\u4e00\u5f00\u59cb\u60f3\u7684\u601d\u8def\u80af\u5b9a\u662f\u66b4\u529b dfs\uff0c\u590d\u6742\u5ea6\u80af\u5b9a\u662f\u6307\u6570\u7ea7\u7684\uff0c\u770b\u4e00\u773c\u6570\u636e\u8303\u56f4 $n, k \\leq 30, m \\leq 100$ \u53ea\u80fd\u5f97\u90e8\u5206\u5206\u3002\u4f46\u662f\u8fd9\u9053\u9898\u7684\u6570\u636e\u8303\u56f4\u4e5f\u591f\u5c0f\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u72b6\u538b\uff08\u80af\u5b9a\u6ca1\u620f\uff09\u6216\u8005**\u591a\u7ef4 dp**\u3002\n\n- \u72b6\u6001\u8bbe\u5b9a\n\n\t\u8bbe $f[nn][mm][kk][i]$ \u8868\u793a\u5df2\u7ecf\u786e\u5b9a $nn$ \u4e2a $a_i$ \u786e\u5b9a\u4e3a $[0, mm)$ \u7684\u6570\uff0c\u73b0\u5728\u6211\u4eec\u8d4b $l$ \u4e2a $a_i$ \u4e3a $mm$\uff08$l$ \u679a\u4e3e\u5373\u53ef\uff09\uff0c\u73b0\u5728 $[0, mm)$ \u4f4d\u7684\u4e8c\u8fdb\u5236\u7528\u4e86 $k$ \u4e2a 1\uff0c\u5e76\u4e14\u7b2c $mm$ \u4f4d\u5411\u9ad8\u4f4d\u8fdb\u4f4d\u4e3a $i$ \u65f6\u7684\u5e8f\u5217\u6743\u503c\u4e4b\u548c\u3002\n\n- \u521d\u59cb\u5316\n\n\t$f[0][0][0][0] = 1$\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2a $a_i$ \u4e5f\u6ca1\u786e\u5b9a\uff0c\u73b0\u5728\u8981\u627e $l$ \u4e2a $a_i$ \u4e3a 0\uff0c\u73b0\u5728\u6ca1\u6709\u4e8c\u8fdb\u5236\u7528\u4e86 1\uff0c\u5411\u9ad8\u4f4d\u65e0\u8fdb\u4f4d\u3002\n    \n- \u72b6\u6001\u8f6c\u79fb\n\n\t\u8fd9\u9053\u9898\u7684\u72b6\u6001\u8f6c\u79fb\u6211\u662f\u4ece\u5c0f\u5230\u5927\u63a8\u7684\uff0c\u56e0\u4e3a\u8fd9\u6837\u66f4\u65b9\u4fbf\u4e00\u70b9\u3002\n    \n   \u9996\u5148\u6211\u4eec\u8981\u77e5\u9053 $f[nn][mm][kk][i]$ \u80fd\u63a8\u5230\u54ea\u4e2a\u72b6\u6001\uff1a\u9996\u5148\u56e0\u4e3a\u540e\u9762\u53c8\u786e\u5b9a\u4e86 $l$ \u4e2a\u6570\uff0c\u6240\u4ee5 $nn$ \u4f1a\u63a8\u5230 $nn + l$\uff0c$mm$ \u4f1a\u63a8\u5230 $mm + 1$\uff0c\u540e\u9762\u7684\u4e24\u4e2a\u4e0d\u592a\u786e\u5b9a\uff0c\u5047\u8bbe $k$ \u52a0\u4e86 $t1$\uff0c$i$ \u53d8\u6210\u4e86 $t2$\u3002\n   \n  \u9996\u5148\u6211\u4eec\u8981\u8ba1\u7b97 $t1$ \u548c $t2$\uff0c\u56e0\u4e3a\u6211\u4eec\u73b0\u5728\u53ea\u53bb\u8003\u8651\u4e8c\u8fdb\u5236\u4e0b\u7b2c $mm$ \u4f4d\u662f\u5426\u4e3a 1\uff0c\u6240\u4ee5 $t2$ \u53ea\u9700\u8981\u770b\u8fdb\u4f4d\uff08\u8fd9\u91cc\u7684 $\\dfrac{i}{2}$\uff09\u52a0\u4e0a\u5f53\u524d\u7b2c $mm$ \u4f4d\u52a0\u4e86\u51e0\u5373\u53ef\u3002\u5e76\u4e14\u5f53\u4e14\u4ec5\u5f53\u5982\u679c $t2$ \u662f\u5947\u6570\u7684\u8bdd\u90a3\u4e48 $t1 = 1$ \u5e76\u4e14 $t2 = t2 - 1$\u3002\n\n   \u4e0b\u9762\u5c31\u8981\u8003\u8651\u4e24\u4e2a\u72b6\u6001\u4e4b\u95f4\u7684\u5173\u7cfb\u4e86\u3002\u6211\u4eec\u77e5\u9053\u6211\u4eec\u8d4b\u4e86 $l$ \u4e2a\u6570\u4e3a $mm$\uff0c\u5bf9\u5e94\u7684\u6743\u503c\u53c8\u4e58\u4e86 ${v_{mm}}^{l}$\uff0c\u8fd9\u91cc\u5728\u679a\u4e3e $l$ \u7684\u8fc7\u7a0b\u4e2d\u4e58\u4e00\u4e0b\u5373\u53ef\uff1b\u53c8\u56e0\u4e3a\u6211\u4eec\u6700\u540e\u7684 $a_i$ \u662f\u6709\u987a\u5e8f\u7684\u800c\u4e0d\u662f\u5355\u7eaf\u7684\u8003\u8651 $a_i$ \u7684\u503c\u7684\u4e2a\u6570\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u5728 $nn + l$ \u4e2a\u6570\u7ec4\u4f4d\u7f6e\u4e2d\u9009\u51fa $l$ \u4e2a\u6570\u7ec4\u4f4d\u7f6e\u8d4b\u4e3a $mm$\uff0c\u6240\u4ee5\u6211\u4eec\u7684\u65b9\u6cd5\u6570\u53c8\u4f1a\u5bf9\u5e94\u7684\u4e58\u4e0a $\\binom{l}{nn + l}$\uff0c\u8fd9\u91cc\u7ec4\u5408\u6570\u521d\u59cb\u5316\u4e00\u4e0b\u5c31\u884c\uff0c\u6211\u7684\u4ee3\u7801\u662f\u8003\u573a\u4ee3\u7801\uff0c\u4e5f\u5c31\u662f[\u6253\u8868](https://www.luogu.com.cn/paste/klgu7vzq)\u505a\u7684\uff0c\u4e5f\u53ef\u4ee5\u7528\u6768\u8f89\u4e09\u89d2\u505a\u6cd5\uff0c[\u5728\u6b64\u4e0d\u518d\u8d58\u8ff0](https://zuochunmei.blog.luogu.org/zu-ge-shuo-yong-yang-hui-san-jiao-za-qiu)\u3002\n   \n   \u56e0\u6b64\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a\n   \n$$f[nn + l][mm + 1][t1][t2] = f[nn + l][mm + 1][t1][t2] + {v_{mm}}^{l} \\times \\binom{l}{nn + l} \\times f[nn][mm][kk][i]$$\n\n```cpp\nfor (int m = 0; m <= _m; m++) {\n\tfor (int n = 0; n <= _n; n++) {\n   \t\tfor (int k = 0; k <= _k; k++) {\n\t\t\tfor (int i = 0; i <= 200; i++) {\n\t\t\t\tif (!_f[n][m][k][i]) {\n    \t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tp = 1;\n\t\t\t\t\n\t\t\t\tfor (int l = 0; l <= _n - n; l++) {\n\t\t\t\t\tif (l) {\n    \t\t\t\t\tp *= _v[m];\n    \t\t\t\t\tp %= 998244353;\n    \t\t\t\t}\n\t\t\t\t\t\n    \t\t\t\tt1 = 0;\n    \t\t\t\tt2 = i / 2 + l;\n\t\t\t\t\n    \t\t\t\tif (t2 & 1) {\n    \t\t\t\t\tt1 = 1;\n    \t\t\t\t\tt2--;\n    \t\t\t\t}\n    \t\t\t\t\n    \t\t\t\t_f[n + l][m + 1][k + t1][t2] += (((_c[n + l][l] * p) % 998244353) * _f[n][m][k][i]) % 998244353;\n    \t\t\t\t_f[n + l][m + 1][k + t1][t2] %= 998244353;\n  \t\t\t\t}\n\t\t\t}\n   \t\t}\n   \t}\n}\n```\n\n\n- \u7ed3\u679c\u5904\u7406\n\n\t\u6211\u4eec\u6700\u540e\u7684\u7ed3\u679c\u4e00\u5b9a\u662f\u5df2\u7ecf\u786e\u5b9a $n$ \u4e2a\u6570\u662f $[0, m + 1)$ \u7684\u6570\uff0c\u540e\u9762\u7684\u4f4d\u679a\u4e3e\u7136\u540e\u5224\u65ad\u5e8f\u5217\u662f\u5426\u5408\u6cd5\u5373\u53ef\u3002\n    \n```cpp\nfor (int k = 0; k <= _k; k++) {\n\tfor (int i = 0; i <= 200; i++) {\n\t\tt1 = i;\n\t\tt2 = k;\n\t\t\n\t\twhile (t1) {\n\t\t\tif (t1 & 1) {\n  \t\t\t\tt2++;\n\t\t\t}\n\t\t\t\n\t\t\tt1 >>= 1;\n      }\n\t\n\t\tif (t2 <= _k) {\n\t\t\t_res += _f[_n][_m + 1][k][i];\n\t\t\t_res %= 998244353;\n\t\t}\n\t}\n}\n```\n\n\u5b8c\u6574\u4ee3\u7801\uff1a\n\n```cpp\n\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\nint _n, _m, _k;\nlong long _v[109], _f[39][109][39][209], _res;\nlong long _c[39][39];//\u7701\u7565\u6253\u8868\n\nvoid ParseIn () {\n\tcin >> _n >> _m >> _k;\n\t\n\tfor (int i = 0; i <= _m; i++) {\n\t\tcin >> _v[i];\n\t}\n}\n\nvoid Core () {\n  \tint t1, t2;\n  \tlong long p;\n  \t\n  \t_f[0][0][0][0] = 1;\n  \t\n  \tfor (int m = 0; m <= _m; m++) {\n   \t\tfor (int n = 0; n <= _n; n++) {\n    \t\tfor (int k = 0; k <= _k; k++) {\n\t\t\t\tfor (int i = 0; i <= 200; i++) {\n\t\t\t\t\tif (!_f[n][m][k][i]) {\n\t    \t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tp = 1;\n\t\t\t\t\t\n\t\t\t\t\tfor (int l = 0; l <= _n - n; l++) {\n\t\t\t\t\t\tif (l) {\n\t    \t\t\t\t\tp *= _v[m];\n\t    \t\t\t\t\tp %= 998244353;\n\t    \t\t\t\t}\n\t\t\t\t\t\t\n\t    \t\t\t\tt1 = 0;\n\t    \t\t\t\tt2 = i / 2 + l;\n\t\t\t\t\t\n\t    \t\t\t\tif (t2 & 1) {\n\t    \t\t\t\t\tt1 = 1;\n\t    \t\t\t\t\tt2--;\n\t    \t\t\t\t}\n\t    \t\t\t\t\n\t    \t\t\t\t_f[n + l][m + 1][k + t1][t2] += (((_c[n + l][l] * p) % 998244353) * _f[n][m][k][i]) % 998244353;\n\t    \t\t\t\t_f[n + l][m + 1][k + t1][t2] %= 998244353;\n\t  \t\t\t\t}\n\t\t\t\t}\n      \t\t}\n    \t}\n  \t}\n\t\n  \tfor (int k = 0; k <= _k; k++) {\n    \tfor (int i = 0; i <= 200; i++) {\n      \t\tt1 = i;\n      \t\tt2 = k;\n\t\t\t\n      \t\twhile (t1) {\n\t\t\t\tif (t1 & 1) {\n\t  \t\t\t\tt2++;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tt1 >>= 1;\n      \t\t}\n\t\t\t\n      \t\tif (t2 <= _k) {\n\t\t\t\t_res += _f[_n][_m + 1][k][i];\n\t\t\t\t_res %= 998244353;\n      \t\t}\n    \t}\n  \t}\n}\n\nvoid WriteOut () {\n \tcout << _res << endl;\n}\n\nint main () {\n  \tParseIn();\n  \tCore();\n  \tWriteOut();\n\t\n  \treturn 0;\n}\n```\n",
        "postTime": 1637454664,
        "uid": 299086,
        "name": "Mistybranch",
        "ccfLevel": 5,
        "title": "P7961 [NOIP2021] \u6570\u5217"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P7961)\n\n## \u505a\u6cd5\n\n\u8fd9\u9898\u5c5e\u4e8e\u662f\u6570\u4f4d dp \u91cc\u6bd4\u8f83\u597d\u7684\u9898\uff0c\u4e5f\u6bd4\u8f83\u5957\u8def\u3002\n\n\u8bbe $dp[i][j][k][l]$ \u8868\u793a\u5904\u7406\u5230\u4e8c\u8fdb\u5236\u7b2c $i$ \u4f4d\uff0c{$a_i$} \u5e8f\u5217\u4e2d\u6709 $j$ \u4e2a\u5143\u7d20\u76ee\u524d\u6709\u503c\uff0c$0\\sim i-1$ \u4f4d\u90fd\u8fdb\u5b8c\u4f4d\uff0c\u5728 $0\\sim i-1$ \u4f4d\u4e2d\u6709 $k$ \u4e2a $1$\uff0c\u7b2c $i$ \u4f4d\u76ee\u524d\u6709 $l$ \u4e2a $1$ \u7684\u6240\u6709\u60c5\u51b5\u3002\n\n\u5206\u6790\u8f6c\u79fb\u65b9\u7a0b\uff1a\u4ece $i-1$ \u4f4d\u8f6c\u79fb\uff0c\u5982\u679c $i-1$ \u4f4d\u6709\u5947\u6570\u4e2a\u6570\u8fd8\u6ca1\u6709\u8fdb\u4f4d\uff0c\u5219\u8fdb\u4f4d\u540e $1$ \u7684\u4e2a\u6570\u4f1a\u591a\u4e00\u4e2a\uff0c\u5426\u5219\u4e0d\u53d8\uff0c\u7136\u540e\u679a\u4e3e\u5f80\u8fd9\u4e2a\u4f4d\u7f6e\u653e\u591a\u5c11\u4e2a $1$\uff0c\u8f6c\u79fb\u5373\u53ef\uff0c\u6545\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a\n\n$$\ndp[i][j+l][x+1][l+(y>>1)]+=dp[i-1][j][x][y]\\times v[i]\\times \\tbinom{n-j}{l}\n$$\n$$\ndp[i][j+l][x][l+(y>>1)]+=dp[i-1][j][x][y]\\times v[i]\\times \\tbinom{n-j}{l}\n$$\n\n\u7b2c\u4e00\u4e2a\u8f6c\u79fb\u65b9\u7a0b $y$ \u662f\u5947\u6570\uff0c\u7b2c\u4e8c\u4e2a $y$ \u662f\u5076\u6570\u3002\u679a\u4e3e\u8f6c\u79fb\u5c31\u884c\u4e86\u3002\n\n## \u4ee3\u7801\n\n```cpp\n// Problem: P7961 [NOIP2021] \u6570\u5217\n// Contest: Luogu\n// URL: https://www.luogu.com.cn/problem/P7961\n// Memory Limit: 512 MB\n// Time Limit: 1000 ms\n//\n// Powered by CP Editor (https://cpeditor.org)\n\n#include <bits/stdc++.h>\n#define int long long\n#define mod 998244353\nusing namespace std;\nnamespace Std {\nint n, m, k, v[110], dp[210][40][40][40], c[110][110];\nint qp(int x, int y) {\n  int cmp = 1;\n  while (y) {\n    if (y & 1) {\n      cmp *= x;\n      cmp %= mod;\n    }\n    x *= x;\n    x %= mod;\n    y >>= 1;\n  }\n  return cmp;\n}\nint main() {\n  scanf(\"%lld%lld%lld\", &n, &m, &k);\n  for (int i = 0; i <= m; ++i) scanf(\"%lld\", v + i);\n  c[0][0] = 1;\n  for (int i = 1; i <= n; ++i) {\n    c[i][0] = 1;\n    for (int j = 1; j <= n; ++j) c[i][j] = c[i - 1][j - 1] + c[i - 1][j];\n  }\n  dp[0][0][0][0] = 1;\n  for (int i = 1; i <= n; ++i) dp[0][i][0][i] = qp(v[0], i) * c[n][i] % mod;\n  for (int i = 1; i <= m; ++i) {\n    for (int j = 0; j <= n; ++j) {\n      for (int l = 0; j + l <= n; ++l) {\n        for (int o = 0; o <= min(i - 1, k); ++o) {\n          for (int p = 0; p <= j; ++p)\n            if (p & 1)\n              (dp[i][j + l][o + 1][(p >> 1) + l] +=\n               (dp[i - 1][j][o][p] * qp(v[i], l) % mod * c[n - j][l] % mod)) %=\n                  mod;\n            else\n              (dp[i][j + l][o][(p >> 1) + l] +=\n               (dp[i - 1][j][o][p] * qp(v[i], l) % mod * c[n - j][l] % mod)) %=\n                  mod;\n        }\n      }\n    }\n  }\n  for (int i = m + 1; i <= m + 100; ++i) {\n    for (int j = 0; j <= k; ++j) {\n      for (int l = 0; l <= n; ++l) {\n        if (l & 1)\n          (dp[i][n][j + 1][l >> 1] += dp[i - 1][n][j][l]) %= mod;\n        else\n          (dp[i][n][j][l >> 1] += dp[i - 1][n][j][l]) %= mod;\n      }\n    }\n  }\n  int ans = 0;\n  for (int i = 0; i <= k; ++i) (ans += dp[m + 100][n][i][0]) %= mod;\n  printf(\"%lld\\n\", ans);\n  return 0;\n}\n}  // namespace Std\n#undef int\nint main() { return Std::main(); }\n```\n",
        "postTime": 1653043223,
        "uid": 576737,
        "name": "Wilson_Inversion",
        "ccfLevel": 7,
        "title": "P7961\u9898\u89e3"
    },
    {
        "content": "\u5927\u81f4\u9898\u610f\uff1a\u7ed9\u5b9a $0\\sim m$ \u6bcf\u4e2a\u6570\u7684\u6743\u503c\uff0c\u4ece\u4e2d\u9009\u51fa\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217 $a$\uff0c\u4f7f\u5f97 $S=\\sum\\limits_{i=1}^{n}2^{a_i}$ \u4e8c\u8fdb\u5236\u8868\u793a\u4e0b\u6709\u4e0d\u8d85\u8fc7 $k$ \u4f4d\u662f $1$\uff0c\u6bcf\u4e2a\u6570\u53ef\u9009\u591a\u6b21\uff0c\u6bcf\u79cd\u9009\u53d6\u65b9\u6848\u5f97\u4ef7\u503c\u4e3a\u6240\u9009\u7684\u6240\u6709\u6570\u7684\u6743\u503c\u79ef\uff0c\u6c42\u6240\u6709\u5408\u6cd5\u9009\u53d6\u65b9\u6848\u7684\u4ef7\u503c\u4e4b\u548c\u5bf9 $998244353$ \u53d6\u6a21\u7684\u7ed3\u679c\u3002\n\n\u5c1d\u8bd5\u8bbe\u8ba1\u4e00\u4e2a dp\uff0c\u8003\u8651\u5c06\u8981\u9009\u62e9\u7684\u6570\u4e2d\u76f8\u540c\u7684\u4e00\u6b21\u6027\u52a0\u5165\u6570\u5217\u4e2d\uff0c\u7528\u72b6\u6001\u8bb0\u5f55 $S$ \u7684\u4e8c\u8fdb\u5236\u60c5\u51b5\u3002\u4e0d\u96be\u53d1\u73b0\uff0c$\\forall a_i<a_j$\uff0c$a_j$ \u7684\u9009\u53d6\u60c5\u51b5\u4e0e $S$ \u4e8c\u8fdb\u5236\u8868\u793a\u4e0b\u4ece\u4f4e\u5230\u9ad8\u7b2c $0\\sim a_i$ \u4f4d\u7684\u53d6\u503c\u6ca1\u6709\u5f71\u54cd\uff0c\u4f46 $a_i$ \u7684\u9009\u62e9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8fdb\u4f4d\u800c\u5bf9 $S$ \u4e8c\u8fdb\u5236\u7b2c $a_j$ \u4f4d\u4ea7\u751f\u5f71\u54cd\u3002\u6240\u4ee5\u4ece\u5c0f\u5230\u5927\u52a0\u6570\uff0c\u8bb0\u5f55\u5df2\u9009\u7684\u6570\u7684\u4e2a\u6570\uff0c$S$ \u4e2d\u5df2\u7ecf\u786e\u5b9a\u7684\u4f4d\u4e2d\u6709\u51e0\u4e2a $1$\uff0c\u5e76\u8bb0\u5f55\u4f1a\u5411\u4e0b\u4e00\u4f4d\u8fdb\u591a\u5c11\u3002\n\n\u53ef\u5f97\u72b6\u6001 $f(i,j,v,w)$ \u8868\u793a\u4ece $0\\sim i$ \u4e2d\u9009\u4e86 $j$ \u4e2a\u6570\uff0c$S$ \u4e2d\u5df2\u7ecf\u786e\u5b9a\u7684\u4f4d\u4e2d\u6709 $v$ \u4e2a $1$\uff0c\u5411\u4e0b\u4e00\u4f4d\u8fdb $w$ \u7684\u60c5\u51b5\u4e0b\uff0c\u4ef7\u503c\u548c\u4e3a\u591a\u5c11\uff08\u6b64\u5904\u7684\u4ef7\u503c\u4e3a\u5df2\u7ecf\u9009\u51fa\u7684\u6570\u7684\u6743\u503c\u4e4b\u79ef\uff09\u3002\u679a\u4e3e\u6bcf\u4e2a\u6570\u9009\u53d6\u7684\u4e2a\u6570 $u$\uff0c\u90a3\u4e48\u6bcf\u6b21\u52a0\u6570\u76f8\u5f53\u4e8e\u4ece $k-j$ \u4e2a\u4f4d\u7f6e\u4e2d\u9009\u51fa $u$ \u4e2a\u653e\u4e0a\u6570\u5b57\uff0c\u65b9\u6848\u6570\u4e3a $C_{k-j}^u$\uff0c\u53ef\u5f97\u8f6c\u79fb\n$$\nf(i,j+u,v+(u+w)\\bmod 2,\\lfloor \\frac{w+u}{2}\\rfloor)\\gets f(i,j,v,w)\\times {v_i}^u\\times C_{k-j}^u\n$$\n\u5176\u4e2d $C_n^m$ \u8868\u793a\u7ec4\u5408\u6570\u3002\n\n\u7b54\u6848\u5373\u4e3a $\\sum f(m,n,v,w)\\times (v+\\text{bitcount}(w)\\le k)$\uff0c\u5176\u4e2d $\\text{bitcount}(w)$ \u8868\u793a $w$ \u4e8c\u8fdb\u5236\u8868\u793a\u4e0b $1$ \u7684\u4e2a\u6570\u3002\n\n\u4f7f\u7528\u9012\u63a8\u9884\u5904\u7406\u7ec4\u5408\u6570\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n^4m)$\uff1b\u6eda\u52a8\u6570\u7ec4\u4f18\u5316\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n^3)$\u3002\n\n\u8003\u573a\u4ee3\u7801\uff0c\u5176\u4e2d\u4e0a\u6587\u7684 $v$ \u5728\u4ee3\u7801\u4e2d\u7528 $k$ \u8868\u793a\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define re register\n#define ll long long\nusing namespace std;\ninline int read()\n{\n\tchar c=getchar();int x=0,f=1;\n\twhile(c>'9'||c<'0'){if(c=='-')f=-f;c=getchar();}\n\twhile(c<='9'&&c>='0'){x=x*10+c-'0';c=getchar();}\n\treturn x*f;\n}\nconst int N=35,M=110,mod=998244353;\nint n,m,K;\nll f[N][N][N],g[N][N][N],v[M],powerv[M][N],C[N][N],ans;\ninline void co()\n{//\u590d\u5236\u4e0a\u4e00\u5c42\u8f6c\u79fb\u7684\u7ed3\u679c\u8fdb\u884c\u6eda\u52a8\u3002\n\tfor(re int i=0;i<=n;i++)\n\t\tfor(re int j=0;j<=n;j++)\n\t\t\tfor(re int k=0;k<=n;k++)\n\t\t\t\tg[i][j][k]=f[i][j][k],f[i][j][k]=0;\n\treturn;\n}\ninline int getnum(int x)\n{//\u8ba1\u7b97bitcount\n\tint cnt=0;\n\twhile(x)\n\t{\n\t\tif(x&1)cnt++;\n\t\tx>>=1;\n\t}\n\treturn cnt;\n}\nint main()\n{\n\tn=read(),m=read()+1,K=read();\n\tfor(re int i=1;i<=m;i++)\n\t{\n\t\tpowerv[i][0]=1;\n\t\tv[i]=read();\n\t\tfor(re int j=1;j<=n;j++)\n\t\t\tpowerv[i][j]=powerv[i][j-1]*v[i]%mod;\n\t}\n\tC[0][0]=1;\n\tfor(re int i=1;i<=n;i++)\n\t{//\u9884\u5904\u7406\u7ec4\u5408\u6570\n\t\tC[i][0]=C[i-1][0];\n\t\tfor(re int j=1;j<=i;j++)\n\t\t\tC[i][j]=(C[i-1][j-1]+C[i-1][j])%mod;\n\t}\n\tf[0][0][0]=1;\n\tfor(re int i=1;i<=m;i++)\n\t{\n\t\tco();\n\t\tfor(re int j=0;j<=n;j++)\t\n\t\t\tfor(re int k=0;k<=j;k++)\n\t\t\t\tfor(re int p=0;p<=j;p++)\n\t\t\t\t\tfor(re int w=0;w+j<=n;w++)\n\t\t\t\t\t\tf[j+w][k+(w+p)%2][(w+p)/2]=(f[j+w][k+(w+p)%2][(w+p)/2]+powerv[i][w]*g[j][k][p]%mod*C[n-j][w]%mod)%mod;\n\t\tif(i==m)\n\t\t{//\u7edf\u8ba1\u7b54\u6848\n\t\t\tfor(re int j=0;j<=n;j++)\n\t\t\t\tfor(re int k=0;k<=n;k++)\n\t\t\t\t\tif(j+getnum(k)<=K)\n\t\t\t\t\t\tans=(ans+f[n][j][k])%mod;\n\t\t}\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```\n\n\n\n\n\n",
        "postTime": 1638262530,
        "uid": 130602,
        "name": "lzx2005",
        "ccfLevel": 9,
        "title": "[NOIP2021]\u6570\u5217\u9898\u89e3"
    },
    {
        "content": "\u5148\u4e0d\u8003\u8651\u5e8f\u5217\u91cc\u5177\u4f53\u6bcf\u4e2a\u4f4d\u7f6e\u586b\u54ea\u4e9b\u6570\uff0c\u800c\u662f\u8003\u8651\u6bcf\u79cd\u6570\u5728\u5e8f\u5217\u4e2d\u51fa\u73b0\u4e86\u591a\u5c11\u6b21\uff1a\n\n\u8bbe $x_i$ \u4e3a\u5e8f\u5217\u4e2d\u503c\u4e3a $i$ \u7684\u6570\u7684\u4e2a\u6570\uff0c\u5373\u8981\u6ee1\u8db3 $x_0+x_1+x_2+\\cdots +x_m=n$ \u3002\n\n\u8fd9\u4e2a\u4e0d\u5b9a\u65b9\u7a0b\u7684\u4e00\u4e2a\u975e\u8d1f\u6574\u6570\u89e3\uff0c\u5373\u4e3a\u4e00\u79cd\u4e0d\u8003\u8651\u5177\u4f53\u4f4d\u7f6e\u7684\u65b9\u6848\uff0c\u5982\u679c\u8981\u6c42\u771f\u6b63\u7684\u65b9\u6848\u6570\uff0c\u53ea\u9700\u4e58\u4ee5\u5bf9\u5e94\u7684\u7ec4\u5408\u6570\u5373\u53ef\u3002\n\n\u5177\u4f53\u6765\u8bf4\uff0c\u7b2c\u4e00\u6b65\u662f\u4ece $n$ \u4e2a\u4f4d\u7f6e\u91cc\u9009 $x_0$ \u4e2a\uff0c\u7b2c\u4e8c\u6b65\u662f\u4ece $n-x_0$ \u4e2a\u4f4d\u7f6e\u91cc\u9009 $x_1$ \u4e2a\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff0c\u65b9\u6848\u6570\u5c31\u4f1a\u4e58\u4ee5 $C_{n}^{x_0}C_{n-x_0}^{x_1}C_{n-x_0-x_1}^{x_1}\\cdots C_{x_m}^{x_m}$\u3002\n\n\u800c\u8fd9\u9898\u6bcf\u79cd\u65b9\u6848\u7684\u8d21\u732e\u662f $v_{a_{1}} \\times v_{a_{2}} \\times \\cdots \\times v_{a_{n}}$ \uff0c\u4e5f\u5c31\u662f\u8fd8\u8981\u518d\u4e58\u4ee5 $\\prod\\limits_{i=0}^{m} v_{i}^{x_i}$\u3002\n\n\u8fd9\u6837\u53ef\u4ee5\u9996\u5148\u9884\u5904\u7406\u7ec4\u5408\u6570\u4ee5\u53ca\u6bcf\u4e2a $v_i$ \u7684\u5e42\u6b21\uff0c\u7136\u540e\u5199\u4e00\u4e2a DFS \u7206\u641c\u628a\u6bcf\u4e2a\u4e0d\u5b9a\u65b9\u7a0b\u7684\u89e3\u6c42\u51fa\uff0c\u7136\u540e\u68c0\u67e5 $1$ \u7684\u4e2a\u6570\u662f\u5426\u5408\u6cd5\u3002\n\n\u7531\u9694\u677f\u6cd5\u53ef\u7b97\u51fa\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(C_{n+m}^m)$ \uff0c\u53ef\u62ff\u5230 $45$ \u5206\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\n\n ```c++\n #include <bits/stdc++.h>\n using namespace std;\n typedef long long LL;\n const int INF = 0x3f3f3f3f;\n const LL mod = 998244353;\n const int N = 100005;\n \n LL ans, c[40][40], a[105][40];\n int n, m, K;\n void dfs(int u, int x, LL now, LL s) {\n     if (u == m + 1) {\n         if (x == 0 && __builtin_popcountll(s) <= K) ans = (ans + now) % mod;\n         return;\n     }\n     for (int i = 0; i <= x; i++) {\n         dfs(u + 1, x - i, now * c[x][i] % mod * a[u][i] % mod, s + ((LL)i << u));\n     }\n }\n int main() {\n     for (int i = 0; i <= 30; i++) {\n         c[i][0] = 1;\n         for (int j = 1; j <= i; j++) c[i][j] = (c[i - 1][j] + c[i - 1][j - 1]) % mod;\n     }\n     scanf(\"%d%d%d\", &n, &m, &K);\n     for (int i = 0; i <= m; i++) {\n         int x;\n         scanf(\"%d\", &x);\n         a[i][0] = 1;\n         for (int j = 1; j <= n; j++) {\n             a[i][j] = a[i][j - 1] * x % mod;\n         }\n     }\n     dfs(0, n, 1, 0);\n     printf(\"%lld\\n\", ans);\n     return 0;\n }\n ```\n\n\u6ce8\u610f\u5230\u5728\u4ece\u5c0f\u5230\u5927\u679a\u4e3e $x_i$ \u65f6\u5019\uff0c\u53ef\u4ee5\u628a $S=2^{a_{1}}+2^{a_{2}}+\\cdots+2^{a_{n}}$ \u5206\u6210\u4e24\u4e2a\u90e8\u5206\uff1a\n\n- \u524d\u9762 $0\\sim i$ \u4f4d\u4e2d\u4e00\u5171\u51fa\u73b0\u4e86\u591a\u5c11\u4e2a $1$  \uff08\u4e0d\u4f1a\u8d85\u8fc7 $n$\uff09\n- \u5f53\u524d\u6709\u591a\u5c11\u4e2a\u6570\u8fdb\u4f4d\u5230\u7b2c $i+1$ \u4f4d  \uff08\u4e0d\u4f1a\u8d85\u8fc7 $n$\uff09\n\n\u4e4b\u6240\u4ee5\u80fd\u8fd9\u6837\u5206\uff0c\u662f\u56e0\u4e3a\u540e\u9762\u7684\u6240\u6709 $x_{i+1},x_{i+2},\\cdots,x_m $  \u90fd\u4e0d\u4f1a\u5f71\u54cd\u7b2c\u4e00\u90e8\u5206\u4e2d $1$ \u7684\u4e2a\u6570\u3002\n\n\u8fd9\u6837\u4e00\u6765\uff0c\u603b\u72b6\u6001\u5c31\u4ece\u539f\u6765\u7684 $S$ \u7f29\u5c0f\u4e3a $n^2$ \u4e2a\uff0c\u6211\u4eec\u5c31\u80fd\u5f00\u5fc3\u5730 DP \u4e86\u3002\n\n\u57fa\u672c\u601d\u8def\u548c\u4e0a\u9762\u7684\u641c\u7d22\u662f\u4e00\u6837\u7684\uff0c\u53ea\u662f\u5bf9\u91cd\u590d\u7684\u72b6\u6001\u53ea\u7b97\u4e00\u6b21\u3002\n\n\u8bbe $f[u][i][j][k]$ \u8868\u793a\u8003\u8651\u5b8c $\\le u$ \u7684\u6570\u7684\u4e2a\u6570\u540e\uff0c\u5df2\u7ecf\u7528\u4e86$i$ \u4e2a\u6570\uff0c\u8fdb\u4f4d\u4e3a $j$\uff0c$0\\sim u$ \u4f4d\u4e00\u5171\u6709 $k$ \u4e2a $1$ \u7684\u603b\u8d21\u732e\u3002\n\n\u8f6c\u79fb\u5f88\u7b80\u5355\uff0c\u679a\u4e3e\u5728\u5269\u4e0b $n-i$ \u4e2a\u6570\u4e2d\u7528\u4e86 $x$ \u4e2a\u6570\uff0c\u628a $f[u][i][j][k]$ \u4e58\u4e0a $C_{n-1}^xv_u^x$\uff0c\u52a0\u5230 $f[u+1][i-x][\\lfloor\\frac{j+x}{2}\\rfloor][k+(j+x)\\bmod 2]$ \u91cc\u3002\uff08\u8fdb\u4f4d\u548c $1$ \u7684\u4e2a\u6570\u7684\u53d8\u5316\u5e94\u8be5\u5f88\u597d\u7406\u89e3\u5427\uff09\n\n\u6700\u540e DP \u5b8c\u628a\u6240\u6709\u5408\u6cd5\u7684\u8d21\u732e\u52a0\u8d77\u6765\u5c31\u884c\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^4m)$\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```c++\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\nconst int INF = 0x3f3f3f3f;\nconst LL mod = 998244353;\nconst int N = 40;\n\nLL c[N][N], a[105][N], f[105][N][N][N];\n\nint main() {\n    int n, m, K;\n    for (int i = 0; i <= 30; i++) {\n        c[i][0] = 1;\n        for (int j = 1; j <= i; j++) c[i][j] = (c[i - 1][j] + c[i - 1][j - 1]) % mod;\n    }\n    scanf(\"%d%d%d\", &n, &m, &K);\n    for (int i = 0; i <= m; i++) {\n        int x;\n        scanf(\"%d\", &x);\n        a[i][0] = 1;\n        for (int j = 1; j <= n; j++) {\n            a[i][j] = a[i][j - 1] * x % mod;\n        }\n    };\n\n    f[0][0][0][0] = 1;\n    for (int u = 0; u <= m; u++) {\n        for (int i = 0; i <= n; i++) {\n            for (int j = 0; j <= i; j++) {\n                for (int k = 0; k <= i; k++) {\n                    for (int x = 0; x <= n - i; x++) {\n                        f[u + 1][i + x][(j + x) / 2][k + (j + x) % 2] += f[u][i][j][k] * a[u][x] % mod * c[n - i][x] % mod;\n                        f[u + 1][i + x][(j + x) / 2][k + (j + x) % 2] %= mod;\n                    }\n                }\n            }\n        }\n    }\n    LL ans = 0;\n    for (int j = 0; j <= n; j++) {\n        for (int k = 0; k <= n; k++) {\n            if (__builtin_popcount(j) + k <= K) ans += f[m + 1][n][j][k];\n        }\n    }\n    printf(\"%lld\\n\", ans % mod);\n    return 0;\n}\n```",
        "postTime": 1638256091,
        "uid": 54357,
        "name": "OMG_wc",
        "ccfLevel": 0,
        "title": "[NOIP2021] \u6570\u5217\u9898\u89e3"
    },
    {
        "content": "### \u9898\u610f\n\n\u7ed9\u51fa $v_0\\dots v_m$\uff0c\u5b9a\u4e49\u4e00\u4e2a\u503c $\\in[0,m]$ \u7684\u5e8f\u5217 $\\{a_n\\}$\uff0c\u5176\u6743\u503c\u4e3a $\\prod v_{a_i}$\n\n\u6c42\u6ee1\u8db3 $S=\\sum 2^{a_i}$ \u4e8c\u8fdb\u5236\u8868\u793a\u4e0d\u8d85\u8fc7 $k$ \u4e2a $1$ \u7684\u6240\u6709\u5e8f\u5217\u6743\u503c\u548c\u3002\n\n\u5176\u4e2d $n\\leq 30,m\\leq 100,k\\leq n$\u3002\n\n### \u89e3\u6cd5\n\n\u9996\u5148\uff0c\u4f60\u53ef\u4ee5\u60f3\u5230\u591a\u91cd\u6392\u5217\uff0c\u7ed9\u51fa\u503c $i$ \u51fa\u73b0\u4e86 $k_i$ \u6b21\uff0c\u5171\u6709 $\\frac{n!}{\\prod k_i}$ \u4e2a\u5e8f\u5217\u4e0e\u4e4b\u5bf9\u5e94\u3002\n\n\u6ce8\u610f\u5230\u5e8f\u5217\u7684\u6743\u503c\u548c\u5e8f\u5217\u4e2d\u6bcf\u4e2a\u5143\u7d20\u7684\u51fa\u73b0\u987a\u5e8f\u65e0\u5173\uff0c\u6240\u4ee5\u5bf9\u4e8e\u8fd9\u6837\u7684\u4e00\u4e9b\u5e8f\u5217\u5176\u6743\u503c\u548c\u53ef\u4ee5\u5199\u4f5c\n$$\n\\frac{n!}{\\prod k_i!}\\times v_i^{k_i}\n$$\n\u62c6\u4e00\u4e0b\u6bcf\u9879\u7684\u8d21\u732e\uff0c\u5c31\u53ef\u4ee5 $\\text{DP}$\n\n$$\nn!\\times \\prod \\frac{v_i^{k_i}}{k_i!}\n$$\n\n\u53ef\u4ee5\u60f3\u5230\u8bbe $f[i,j,k]$ \u4e3a\u5df2\u7ecf\u8003\u8651\u4e86\u503c $0\\sim i$\uff0c\u5f53\u524d\u7684 $S=j$\uff0c\u5206\u914d\u4e86 $k$ \u4e2a\u4f4d\u7f6e\u7684\u5e8f\u5217\u6743\u503c\u548c\u9664\u4ee5 $n!$\n\n$$\nf[i,j,k]=\\sum_x f[i-1,j-x\\times 2^i,k-x]\\times \\frac{v_i^x}{x!}\n$$\n\n\u7136\u540e\u4f60\u53d1\u73b0\u8fd9\u6837\u4e00\u4e2a\u4e8b\u5b9e\uff0c$S$ \u53ef\u4ee5\u88ab\u5199\u6210 $S=k_i\\times 2^i$\uff0c\u8fd9\u4e2a\u65f6\u5019 $S$ \u76f8\u5f53\u4e8e\u88ab\u5f88\u591a\u4e2a\u4e8c\u8fdb\u5236\u6570\u4f9d\u6b21\u9519\u4f4d\u76f8\u52a0\uff0c\u5bf9\u4e8e\u5df2\u7ecf\u8003\u8651\u4e86\u503c $0\\sim i$ \u800c\u8a00\uff0c\u4e8c\u8fdb\u5236\u6570 $S$ \u7684 $0\\sim i-1$ \u4f4d\u5df2\u7ecf\u4e0d\u4f1a\u518d\u6539\u53d8\u4e86\uff0c\u53ef\u4ee5\u7b80\u5355\u8bb0\u5f55\u4e2a\u6570\u3002\u800c\u5bf9\u4e8e $S$ \u7684 $i\\sim m$ \u4f4d\uff0c\u76f4\u63a5\u8bb0\u5f55\u3002\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53c8\u53d1\u73b0\uff0c$S$ \u9519\u4f4d\u52a0\u4e0a\u7684\u4e8c\u8fdb\u5236\u6570 $\\in [0,n]$\uff0c\u5176\u5b9e\u53ea\u9700\u8bb0\u5f55\u4e0b $S$ \u7684 $i\\sim i+4$ \u4f4d\u5373\u53ef\u3002\n\n\u91cd\u65b0\u8bbe\u8ba1\u72b6\u6001\uff0c\u8bbe $f[i,j,k,l]$ \u4e3a\u5df2\u7ecf\u8003\u8651\u4e86\u503c $0\\sim i$\uff0c\u5f53\u524d\u7684 $S$ \u7684 $i\\sim i+4$ \u4f4d\u4e8c\u8fdb\u5236\u8868\u793a\u4e3a $j$\uff0c$S$ \u7684 $0\\sim i-1$ \u4f4d\u4e2d\u6709 $k$ \u4e2a $1$\uff0c\u5df2\u7ecf\u5206\u914d\u4e86 $l$ \u4e2a\u4f4d\u7f6e\u7684\u5e8f\u5217\u6743\u503c\u548c\u9664\u4ee5 $n!$\uff0c\u7531\u4e8e\u586b\u8868\u6cd5\u4e0d\u597d\u8f6c\u79fb\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u5237\u8868\u6cd5\n$$\nf[i+1,\\left\\lfloor\\frac{j}{2}\\right\\rfloor+x,k+(j\\&1),l+x]=f[i,j,k,l]\\times \\frac{v_{i+1}^x}{x!}\n$$\n\u5f53\u7136\u6211\u8003\u8bd5\u7684\u65f6\u5019\u4e5f\u5199\u4e86\u586b\u8868\u6cd5\uff0c\u5de6\u79fb\u7136\u540e\u679a\u4e3e\u4e4b\u524d\u4e22\u5931\u7684\u90a3\u4e00\u4f4d\u662f $0/1$ \u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^4m)$\u3002\u53ef\u4ee5\u6210\u529f\u901a\u8fc7\u3002\n\n```cpp\n//Debug 2h+, then I find I code the module number in a wrong way.\n//Instead of 998244353,it's 99824353\n#include<cstdio>\ntypedef long long ll;\nconst int mod=998244353;\nint qwq[135];\nll fac[35],inv[35],v[105];\nint f[105][35][35][35];\ninline int read() {\n\tint x=0,f=1;char s=getchar();\n\twhile(s>'9'||s<'0') {if(s=='-') f=-1;s=getchar();}\n\twhile(s>='0'&&s<='9') {x=x*10+s-'0';s=getchar();}\n\treturn x*f;\n}\ninline ll pow(ll x,ll p) {\n\tll res=1;\n\tfor(;p;p>>=1) {\n\t\tif(p&1) res=res*1ll*x%mod;\n\t\tx=x*1ll*x%mod;\n\t}\n\treturn res;\n}\nint main() {\n\tint n=read(),m=read(),K=read();\n\tfor(int i=1;i<=m+1;++i) v[i]=read();\n\tinv[0]=fac[0]=1;\n\tfor(int i=1;i<=n;++i) inv[i]=pow(fac[i]=fac[i-1]*1ll*i%mod,mod-2);\n\tfor(int i=0;i<=127;++i) {\n\t\tint tmp=0;\n\t\tfor(int j=i;j;j-=j&(-j)) ++tmp;\n\t\tqwq[i]=tmp;\n\t}\n\tf[0][0][0][0]=1;\n\tfor(int i=0;i<=m;++i) {\n\t\tfor(int j=0;j<=n;++j) {\n\t\t\tfor(int k=0;k<=K;++k) {\n\t\t\t\tfor(int l=0;l<=n;++l) {\n\t\t\t\t\tfor(int tt=0;l+tt<=n;++tt) {\n\t\t\t\t\t\tint nxt=(j>>1)+tt;\n\t\t\t\t\t\tf[i+1][nxt][k+(j&1)][l+tt]=(f[i+1][nxt][k+(j&1)][l+tt]+(f[i][j][k][l]*1ll*pow(v[i+1],tt)%mod*1ll*inv[tt]%mod))%mod;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tll ans=0;\n\tfor(int j=0;j<=n;++j) {\n\t\tfor(int k=0;k<=K;++k) {\n\t\t\tif(qwq[j]+k>K) continue;\n\t\t\tans+=f[m+1][j][k][n];\n\t\t\tif(ans>=mod) ans-=mod;\n\t\t}\n\t}\n\t// printf(\"%lld\\n\",fac[n]);\n\tprintf(\"%lld\\n\",ans*1ll*fac[n]%mod);\n\treturn 0;\n}\n```",
        "postTime": 1638172979,
        "uid": 95244,
        "name": "tommymio",
        "ccfLevel": 6,
        "title": "NOIP T2 Sequence"
    },
    {
        "content": "## \u4e00\u70b9\u5e9f\u8bdd\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P7961)\n\n[My blog](https://www.luogu.com.cn/blog/128433/#)\n\n\u8003\u573a\u4e0a\u81ea\u4fe1\u6572\u5b8c\uff0c\u8003\u540e\u4e00\u6d4b\u53d1\u73b0\u7b54\u6848\u7edf\u8ba1\u987a\u5e8f+\u6ca1\u5220\u8c03\u8bd5\u76f4\u63a5\u7206\u5927\u96f6\n\n~~rnm\uff0c\u9000\u94b1\uff01~~\n\n\u4e0d\u8fc7\u6211\u8eab\u8fb9\u90a3\u4e48\u591a\u5927\u4f6c\u6ca1\u60f3\u51fa\u6765\u662f\u6ca1\u60f3\u5230\u7684\u2026\u2026\u8003\u524d\u505a\u8fc7\u4e00\u9053\u7c7b\u4f3c\u7684\u9898\n\n## \u601d\u8def\n\n\u5148\u770b\u6570\u636e\u8303\u56f4\uff1a$k \\leqslant n \\leqslant 30,m \\leqslant 100$\uff0c\u72b6\u538b\u4f1aT\u98de\uff0c\u6298\u534a\u60f3\u4e0d\u51fa\u6765\uff0c\u8d2a\u5fc3\u4e5f\u4e0d\u50cf\uff0c\u8f6c\u56fe\u8bba\u2026\u2026\u6709\u70b9\u626f\u6de1\u3002\n\n~~\u4fd7\u8bdd\u8bf4\uff1a\u4f60\u4e0d\u4f1a\u505a\u7684\u9898\u5f88\u6709\u53ef\u80fd\u5c31\u662fdp~~\uff0c\u4e8e\u662f\u8003\u8651\u975e\u72b6\u538bDP\u3002\n\n\u5148\u4e0d\u7ba1 $\\{ a_i \\}$ \u7684\u6709\u5e8f\u95ee\u9898\uff0c\u5c06\u5b83\u5f53\u505a\u65e0\u5e8f\u7684\u505a\u3002\n\n\u663e\u7136\u5728\u4e0b\u6807\u4e3a $0$ \u5230 $i$ \u7684\u6570\u4e2d\u9009\u5b8c\u60f3\u8981\u7684\u540e\uff0c\u540e\u9762\u65e0\u8bba\u600e\u4e48\u9009\u90fd\u4e0d\u4f1a\u8ba9 $S$ \u4e8c\u8fdb\u5236\u8868\u793a\u4e2d\u540e\u9762\u7684 $0$ \u5230 $i$ \u4f4d\uff0c\u4e5f\u5c31\u662f $S \\bmod 2^{i+1} $ \u7684\u503c\u53d1\u751f\u6539\u53d8\u3002\n\n\u90a3\u4e48\u53ef\u4ee5\u6309\u4e0b\u6807\u7684\u503c\u5212\u5206\u9636\u6bb5\uff0c\u5c06$S$ \u5df2\u786e\u5b9a\u76841\u7684\u4e2a\u6570\u4f5c\u4e3a\u72b6\u6001\u8f6c\u79fb\u3002\n\n\u5b9a\u4e49\u72b6\u6001 $f(i,j,l,r)$ \u8868\u793a**\u5728\u4e0b\u6807\u4e3a $0$ \u5230 $i$ \u7684 $v$ \u4e2d\u9009\u4e86 $j$ \u4e2a\u6570\uff0c$S$ \u7684 $0$ \u5230 $i$ \u4f4d\u4e2d\u6709 $l$ \u4e2a $1$\uff0c\u5411\u7b2c $i+1$ \u4f4d\u8fdb\u4f4d\u7684\u503c\u4e3a $r$** \u7684\u6743\u503c\u548c\u3002\n\n\u521d\u59cb\u72b6\u6001\u5373\u4e3a $f(0,j,j \\bmod 2,\\left \\lfloor \\dfrac{j}{2} \\right \\rfloor)=v^j_0$\uff0c\u7b54\u6848\u4e3a $\\sum \\limits^{i+digit(j) \\leqslant k}_{i=0,j=0} f(m,n,i,j)$\uff0c\u5176\u4e2d $digit(j)$ \u4e3a $j$ \u5728\u4e8c\u8fdb\u5236\u4e0b $1$ \u7684\u4e2a\u6570\u3002\n\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u597d\u50cf\u4e0d\u662f\u5f88\u597d\u5199\uff0c\u90a3\u4e48\u5c31\u6539\u6210\u201c\u6211\u8981\u5230\u54ea\u91cc\u53bb\u201d\u3002\n\n\u8003\u8651 $f(i,j,l,r)$ \uff0c\u5047\u5982\u6211\u4eec\u4e0b\u4e00\u6b65\u9009 $x$ \u4e2a $v_{i+1}$\uff0c\u90a3\u4e48 $S$ \u7684\u7b2c $i+1$ \u5c31\u662f $(x+l) \\bmod 2$\uff0c\u8fdb\u4f4d\u662f $\\left \\lfloor \\dfrac{x+l}{2} \\right \\rfloor$\uff0c\u6743\u503c\u548c\u53d8\u6210 $v^x_{i+1}f(i,j,l,r)$\uff0c\u8f6c\u79fb\u5230 $f(i+1,j+x,(x+l) \\bmod 2,\\left \\lfloor \\dfrac{x+l}{2} \\right \\rfloor)$ \u4e0a\u3002\n\n\u518d\u8003\u8651\u6392\u5217\u5bf9\u5176\u7684\u5f71\u54cd\uff0c\u6bcf\u6b21\u9009\u4e86 $x$ \u4e2a\u76f8\u540c\u7684\u503c\uff0c\u5c06\u6743\u503c\u9664\u4ee5 $x!$\uff0c\u7136\u540e\u5c06\u7edf\u8ba1\u5b8c\u7684\u7b54\u6848\u4e58\u4e0a $n!$ \u5373\u53ef\n\n## \u4ee3\u7801\n\n```cpp\nconst ll maxn=998244353;\nvoid exgcd(ll a,ll b,ll &x,ll &y)\n{\n\tif (b==0)\n\t{\n\t\tx=1,y=0;\n\t\treturn;\n\t}\n\texgcd(b,a%b,y,x);\n\ty-=(a/b)*x;\n}\ninline ll rev(ll x)\n{\n\tll ans,tmp;\n\texgcd(x,maxn,ans,tmp);\n\treturn (ans%maxn+maxn)%maxn;\n}\nll n,m,q,v[125],f[125][35][35][35],s[205],ans,r[105],fact[105];\ninline void READ()\n{\n\tn=read(),m=read(),q=read();\n\tfor (int i=0;i<=m;++i)\n\t\tv[i]=read();\n}\ninline void make_table()\n{\n\tfact[0]=r[0]=1;\n\tfor (ll i=1;i<=100;++i)\n\t\tfact[i]=fact[i-1]*i%maxn,r[i]=rev(fact[i]);\n\tfor (int i=0;i<=200;++i)\n\t{\n\t\tint t=i;\n\t\twhile (t)\n\t\t{\n\t\t\tif (t&1) ++s[i];\n\t\t\tt>>=1;\n\t\t}\n\t}\n}\ninline void do_it()\n{\n\tfor (ll i=0,j=1;i<=n;++i,j=j*v[0]%maxn)\n\t\tf[0][i][i&1][i/2]=j*r[i]%maxn;\n\tfor (int i=0;i<m;++i)\n\t\tfor (int j=0;j<=n;++j)\n\t\t\tfor (int k=0;k<=q;++k)\n\t\t\t\tfor (int l=0;l<=(j+1)>>1;++l)\n\t\t\t\t\tif (f[i][j][k][l])\n\t\t\t\t\t\tfor (ll x=0,y=1;x+j<=n;++x,y=y*v[i+1]%maxn)\n\t\t\t\t\t\t\tf[i+1][j+x][k+((l+x)&1)][l+x>>1]=(f[i+1][j+x][k+((l+x)&1)][l+x>>1]+f[i][j][k][l]*y%maxn*r[x]%maxn)%maxn;\n}\ninline void count_ans()\n{\n\tfor (int i=0;i<=q;++i)\n\t\tfor (int j=0;j<=(n+1)>>1;++j)\n\t\t\tif (i+s[j]<=q)\n\t\t\t\tans=(ans+f[m][n][i][j])%maxn;\n}\ninline void print()\n{\n\tfor (int i=0;i<=m;++i)\n\t\tfor (int j=0;j<=n;++j)\n\t\t\tfor (int k=0;k<=j;++k)\n\t\t\t\tfor (int l=0;l<=(j+1)>>1;++l)\n\t\t\t\t\tif (f[i][j][k][l])\n\t\t\t\t\t\tprintf(\"%d %d %d %d:%lld\\n\",i,j,k,l,f[i][j][k][l]*fact[j]%maxn);\n}\nint main()\n{\n\tfreopen(\"sequence.in\",\"r\",stdin);\n\tfreopen(\"sequence.out\",\"w\",stdout);\n\tREAD();\n\tmake_table();\n\tdo_it();\n\tcount_ans();\n\tprint();\n\tprintf(\"%lld\",ans*fact[n]%maxn);\n\treturn 0;\n}\n```\n",
        "postTime": 1637976799,
        "uid": 128433,
        "name": "C6H14",
        "ccfLevel": 7,
        "title": "\u3010\u9898\u89e3\u3011P7961"
    },
    {
        "content": "### Description\n\n$\\{a\\}$ \u4e3a\u503c\u57df $0,1,\\dots,m$ \u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217\uff0c\u5176\u6743\u503c\u4e3a\n\n$$\\prod\\limits_{i=1}^nv_{a_i}$$\n\n\u8f93\u51fa\u6240\u6709\u6ee1\u8db3 $popcnt(\\sum\\limits_{i=1}^n2^{a_i})\\leqslant k$ \u7684 $\\{a\\}$ \u7684\u6743\u503c\u548c\u3002\n\n### Analysis\n\n\u8fd9\u9898\u76ee\u770b\u8d77\u6765\u5c31\u4ee4\u4eba\u5934\u5927 qwq\u3002\n\n\u53d1\u73b0\u679a\u4e3e $\\{a\\}$ \u6bcf\u4e00\u4e2a\u4f4d\u7f6e\u7684\u503c\u4e0d\u53ef\u884c\uff08\u56e0\u4e3a\u6761\u4ef6\u662f\u5173\u4e8e\u6743\u503c\u7684 $popcnt$\uff09\uff0c\u8f6c\u800c\u679a\u4e3e $0,1,\\dots,m$ \u5404\u5728 $\\{a\\}$ \u4e2d\u51fa\u73b0\u7684\u6b21\u6570 $b_0,b_1,\\dots,b_m$\uff0c\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u8981\u518d\u4e58\u4e0a\u53ef\u91cd\u6392\u5217\u6570\n\n$$\\dfrac{n!}{b_0!b_1!\\dots b_m!}$$\n\n\u63a5\u4e0b\u6765\u53ea\u8981\u679a\u4e3e $\\{b\\}$ \u5373\u53ef\uff0c~~\u66b4\u641c~~ DP \u5373\u53ef\u3002\n\n\u72b6\u6001 $dp_{i,j,k,l}$ \u8868\u793a\u5f53\u524d\u904d\u5386\u4e86 $b_0\\to b_i$\uff0c$(S>>i)=j$\uff0c$popcnt(S\\&((1<<i)-1))=k$\uff0c$\\sum\\limits_{p=0}^ib_p=n-l$ \u7684\u6743\u503c\u548c\u3002\n\n\u5176\u4e2d $S=\\sum\\limits_{p=0}^ib_p2^p$\u3002\n\n\u54b8\u9c7c\u7bc7\u5e45\uff0c\u8f6c\u79fb\u89c1\u4ee3\u7801\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(m\\times n\\times n\\times n\\times n)$\uff0c\u524d\u56db\u9879\u5206\u522b\u5bf9\u5e94 DP \u4e2d\u7684\u6bcf\u4e00\u7ef4\uff0c\u6700\u540e\u8f6c\u79fb $O(n)$\u3002\n\n### Detail\n\n\u4ee3\u7801\u5b9e\u73b0\u4e2d\u5c06\u53ef\u91cd\u6392\u5217\u6570\u5d4c\u5165\u5230 DP \u4e2d\u3002\n\n\u6211\u5199\u7684\u8bb0\u5fc6\u5316\u641c\u7d22\u3002\n\n### Code\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define IOS ios::sync_with_stdio(0);cin.tie(0);cout.tie(0)\n#define For(i,j,k) for(register int i=j;i<=k;i++)\n#define Rof(i,j,k) for(register int i=j;i>=k;i--)\n\tconst ll mod=998244353;\n\tinline ll pw(ll x,ll y){//\u5feb\u901f\u5e42\n\t\tll r=1;\n\t    while(y){\n\t        if(y&1) r=r*x%mod;\n\t        x=x*x%mod;\n\t        y>>=1;\n\t    }\n\t    return r;\n\t}\n\t#define madd(a,b) {a=((a+b)%mod+mod)%mod;}\n\t#define inv(a) pw(a,mod-2)//\u9006\u5143\n#define N 33\n#define M 110\n\nint n,m,k;\nll dp[M][N][N][N];\nbool vis[M][N][N][N];//\u8bb0\u5fc6\u5316\nll v[M][N];//{v_i}^j\uff0c\u4e3a\u65b9\u4fbf\u9884\u5904\u7406\nll f[N],ivf[N];//f_i=i! ivf_i=inv(i!)\n#define D dp[id][bit][had][lst]\n#define V vis[id][bit][had][lst]\n#define ppcnt __builtin_popcount\nll dfs(int id,int bit,int had,int lst){\n\tif(V) return D;\n\tV=1;\n\tif(had>k) return D=0;\n\tif(id==m+1){\n\t\tD=(!lst && had+ppcnt(bit)<=k);\n\t\treturn D;\n\t}\n\tFor(i,0,lst)\n\t\tmadd(D,ivf[i]*v[id][i]%mod*dfs(id+1,(bit+i)>>1,had+((bit+i)&1),lst-i));\n\treturn D;\n}\nvoid init(){\n\tf[0]=1;\n\tFor(i,1,N-1)\n\t\tf[i]=f[i-1]*i%mod;\n\tivf[N-1]=inv(f[N-1]);\n\tRof(i,N-1,1)\n\t\tivf[i-1]=ivf[i]*i%mod;\n}\nsigned main(){\n\tIOS;\n\tinit();\n\tcin>>n>>m>>k;\n\tFor(i,0,m){\n\t\tv[i][0]=1; \n\t\tcin>>v[i][1];\n\t\tFor(j,2,N-1)\n\t\t\tv[i][j]=v[i][j-1]*v[i][1]%mod;\n\t}\n\tcout<<f[n]*dfs(0,0,0,n)%mod<<endl;\n    return 0;\n}\n```",
        "postTime": 1638365077,
        "uid": 101868,
        "name": "I_am_Accepted",
        "ccfLevel": 0,
        "title": "P7961 [NOIP2021] \u6570\u5217 \u9898\u89e3"
    },
    {
        "content": "\u8003\u573a\u6b63\u89e3\u5199\u6302\u559c\u63d0\u9000\u5f79\u3002\n\n\u4e00\u770b\u6570\u636e\u8303\u56f4\u53d1\u73b0\u957f\u5f97\u5f88\u50cf\u4e00\u4e2a dp\u3002\u663e\u7136\u6211\u4eec\u53ea\u5173\u5fc3\u5e8f\u5217 $a$ \u4e2d\u6bcf\u79cd\u5143\u7d20\u51fa\u73b0\u7684\u6b21\u6570\uff0c\u56e0\u6b64\u6211\u4eec\u8003\u8651\u6309\u5143\u7d20\u8fdb\u884c dp\uff0c\u5bf9\u4e8e\u540c\u79cd\u5143\u7d20\u4e00\u8d77\u8f6c\u79fb\uff0c\u8f6c\u79fb\u7684\u65f6\u5019\u4e58\u4e00\u4e2a\u7ec4\u5408\u6570\u5373\u53ef\uff08\u55ef\u5c31\u662f\u591a\u91cd\u96c6\u5168\u6392\u5217\u8ba1\u6570\uff09\u3002\n\n\u4ece\u4f4e\u4f4d\u5230\u9ad8\u4f4d\u8003\u8651 $S$ \u5f53\u524d\u4f4d\u653e\u591a\u5c11\u4e2a\u6570\uff0c\u4e4b\u524d\u6709\u591a\u5c11\u4e2a\u6570\u3001\u591a\u5c11\u4e2a $1$\uff0c\u4f1a\u53d1\u73b0\u5f53\u524d\u4f4d\u653e\u7684\u6570\u53ef\u80fd\u5bf9\u4e4b\u540e\u7684\u4f4d\u7f6e\u6709\u5f71\u54cd\uff0c\u56e0\u6b64\u53ef\u4ee5\u591a\u8bb0\u4e00\u7ef4\u8868\u793a\u5f53\u524d\u72b6\u6001\u7684\u8fdb\u4f4d\u662f\u591a\u5c11\uff0c\u5177\u4f53\u6765\u8bf4\u5c31\u662f\u8bbe $f_{i,S,j,k}$ \u8868\u793a\u653e\u5230\u7b2c $i$ \u4f4d\uff0c\u8fdb\u4f4d\u72b6\u6001\u4e3a $S$\uff0c\u653e\u4e86 $j$ \u4e2a\u6570\uff0c\u6709 $k$ \u4e2a $1$ \u7684\u6743\u503c\u548c\uff0c\u8f6c\u79fb\u65f6\u679a\u4e3e\u4e0a\u4e00\u4e2a\u653e\u7684\u4f4d\u7f6e\uff0c\u5f53\u524d\u653e\u591a\u5c11\u4e2a\u6570\uff0c\u4e4b\u524d\u6709\u591a\u5c11\u4e2a\u6570\u3001\u591a\u5c11\u4e2a $1$\uff0c\u628a\u8fdb\u4f4d\u72b6\u6001\u5408\u5e76\u4e00\u4e0b\u5373\u53ef\u3002\u8fd9\u6837\u662f $O(m^2n^4)$ \u7684\u3002\n\n\u4f46\u6211\u4eec\u53d1\u73b0\u56e0\u4e3a\u8fd9\u4e2a\u8fdb\u4f4d\u72b6\u6001\u6700\u591a\u662f $n$\uff0c\u90a3\u4e48\u6700\u591a\u53ea\u53ef\u80fd\u6709 $\\log_2n=4$ \u4e2a\u4f4d\u7f6e\u7684\u8fdb\u4f4d\u53ef\u80fd\u5bf9\u5f53\u524d\u4f4d\u7f6e\u7684\u8fdb\u4f4d\u72b6\u6001\u4ea7\u751f\u5f71\u54cd\u3002\u5bf9\u4e8e\u6709\u5f71\u54cd\u7684\u4f4d\u7f6e\u6211\u4eec\u6309\u7167\u521a\u624d\u7684\u505a\u6cd5\u628a\u8fdb\u4f4d\u72b6\u6001\u5408\u5e76\uff0c\u6ca1\u6709\u5f71\u54cd\u7684\u4f4d\u7f6e\u76f4\u63a5\u7528\u524d\u7f00\u548c\u4f18\u5316\u5373\u53ef\u3002\u7ec4\u5408\u6570\u548c\u6bcf\u4e2a $v_i$ \u7684\u82e5\u5e72\u6b21\u65b9\u90fd\u53ef\u4ee5\u9884\u5904\u7406\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(mn^4)$\u3002\n\n\n------------\n\n**Update**\uff1a\u770b\u4e86\u4e00\u5708\u53d1\u73b0\u8fd9\u4e2a\u505a\u6cd5\u6700\u5783\u573e\u4e86\uff0c\u65f6\u7a7a\u590d\u6742\u5ea6\u548c\u4ee3\u7801\u5b9e\u73b0\u96be\u5ea6\u90fd\u52a3\u4e8e\u5176\u4ed6\u9898\u89e3...\u8fd9\u4e2a\u505a\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5176\u5b9e\u662f $O(mn^4 \\log n)$\uff0c\u56e0\u4e3a $n$ \u6bd4\u8f83\u5c0f\u6240\u4ee5\u53ef\u4ee5\u8fd1\u4f3c\u770b\u505a\u5e38\u6570\uff1f\n\n```cpp\nconst int MN = 31, MM = 103, MK = 1 << 12, Mod = 998244353;\n\nint qPow(int a, int b) {\n\tint res = 1;\n\twhile (b) {\n\t\tif (b & 1) res = res * a % Mod;\n\t\ta = a * a % Mod, b >>= 1;\n\t}\n\treturn res;\n}\n\nint Fac[MN], Inv[MN];\ninline void init(int N) {\n\tFac[0] = 1;\n\tfor (int i = 1; i <= N; i++) Fac[i] = Fac[i - 1] * i % Mod;\n\tInv[N] = qPow(Fac[N], Mod - 2);\n\tfor (int i = N; i >= 1; i--) Inv[i - 1] = Inv[i] * i % Mod;\n}\ninline int C(int n, int m) {\n\treturn Fac[n] * Inv[m] % Mod * Inv[n - m] % Mod;\n}\n\nint N, M, K, f[MM][MN][MN][MN], w[MK], A[MM], g[MM][MN][MN], P[MM][MN];\n\nsigned main(void) {\n\tN = read(), M = read() + 1, K = read(), init(N);\n\tfor (int i = 1; i <= M; i++) A[i] = read();\n\tfor (int i = 1; i < MK; i++) w[i] = w[i >> 1] + (i & 1); \n    for (int i = 1; i <= M; i++) {\n        P[i][0] = 1;\n        for (int k = 1; k <= N; k++) {\n            P[i][k] = P[i][k - 1] * A[i] % Mod;\n        }\n    }\n\tfor (int i = 1; i <= M; i++) {\n\t\tfor (int k = 1; k <= N; k++) {\n\t\t\tf[i][k][k][w[k]] = P[i][k] * C(N, k) % Mod;\n\t\t}\n\t\tif (i >= 6) {\n\t\t\tfor (int k = 1; k <= N; k++) {\n\t\t\t\tfor (int p = k + 1; p <= N; p++) {\n\t\t\t\t\tfor (int q = w[k] + 1; q <= N; q++) {\n\t\t\t\t\t\tf[i][k][p][q] = (f[i][k][p][q] + g[i - 5][p - k][q - w[k]] * P[i][k] % Mod * C(N - (p - k), k) % Mod) % Mod;\n\t\t\t\t\t}\n\t\t\t\t} \n\t\t\t}\n\t\t}\n\t\tfor (int j = max(i - 4, 1); j < i; j++) {\n\t\t\tfor (int k = 1; k <= N; k++) {\n\t\t\t\tfor (int S = 1; S <= N - k; S++) {\n\t\t\t\t\tint x = w[(k << (i - j)) + S], T = k + (S >> (i - j));\n\t\t\t\t\tfor (int p = k + S; p <= N; p++) {\n\t\t\t\t\t\tfor (int q = 0; q <= min(N - w[S], N - x); q++) {\n\t\t\t\t\t\t\tf[i][T][p][q + x] = (f[i][T][p][q + x] + f[j][S][p - k][q + w[S]] * P[i][k] % Mod * C(N - (p - k), k) % Mod) % Mod;\n\t\t\t\t\t\t}\n\t\t\t\t\t} \n\t\t\t\t}\n\t\t\t}\n\t\t}\n        for (int p = 1; p <= N; p++) {\n            for (int q = 1; q <= N; q++) {\n                g[i][p][q] = g[i - 1][p][q];\n            }\n        }\n        for (int p = 1; p <= N; p++) {\n            for (int q = 1; q <= N; q++) {\n                for (int k = 1; k <= N; k++) {\n                    g[i][p][q] = (g[i][p][q] + f[i][k][p][q]) % Mod;\n                }\n            }\n        }\n\t}\n\tint Ans = 0;\n\tfor (int i = 1; i <= M; i++) {\n\t\tfor (int k = 1; k <= N; k++) {\n\t\t\tfor (int q = 1; q <= K; q++) {\n\t\t\t\tAns = (Ans + f[i][k][N][q]) % Mod;\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%lld\\n\", Ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1638246477,
        "uid": 246019,
        "name": "_came11ia_",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P7961 \u3010[NOIP2021] \u6570\u5217\u3011"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/Coros-Trusds/p/15632869.html)\n\n\u611f\u89c9\u8fd9\u9053\u9898\u7eaf\u52a8\u6001\u89c4\u5212\u7684\u8fb9\u754c\u7b49\u95ee\u9898\u975e\u5e38\u9ebb\u70e6\uff0c\u6240\u4ee5\u8fd9\u91cc\u91c7\u7528\u8bb0\u5fc6\u5316\u641c\u7d22\u3002\n\n# \u9898\u76ee\u5927\u610f\n\n\u7ed9\u51fa $n,m,k$ \u53ca $val_0\\cdots val_m$\uff0c\u5b9a\u4e49\u4e00\u4e2a\u503c $\\in [0,m]$ \u7684\u5e8f\u5217 $a$\uff0c\u5176\u6743\u503c\u4e3a $\\prod\\limits_{i=1}^{n} val_{a_i}$\n\n\u6211\u4eec\u79f0 $S$ \u6ee1\u8db3\u6761\u4ef6\u5f53\u4e14\u4ec5\u5f53 $S=\\sum\\limits_{i=1}^{n} 2^{a_i}$ \u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e2d\uff0c$1$ \u7684\u4e2a\u6570\u5c0f\u4e8e\u7b49\u4e8e $k$\u3002\u6b64\u65f6\uff0c\u4e5f\u79f0\u5e8f\u5217 $a$ \u4e3a\u5408\u6cd5\u5e8f\u5217\u3002\n\n\u6c42\u6240\u6709\u5408\u6cd5\u5e8f\u5217 $a$ \u7684\u6743\u503c\u548c $\\mod 998244353$ \u7684\u7ed3\u679c\u3002\n\n# \u9898\u76ee\u5206\u6790\n\n\u4ee4 $dfs(bit,now,x,y)$ \u8868\u793a\uff1a\n\n$S$ \u4ece\u4f4e\u5230\u9ad8\u4e8c\u8fdb\u5236\u7684 $bit$ \u4f4d\u4e2d\uff0c\u7528\u4e86\u5e8f\u5217 $a$ \u7684\u524d $now$ \u4e2a\u6570\uff0c\u6b64\u65f6 $S$ \u4e8c\u8fdb\u5236\u4e0b\u6709 $x$ \u4e2a $1$\uff0c\u4e0a\u4e00\u4f4d\uff08\u7b2c $bit+1$ \u4f4d\uff09\u8fdb\u4f4d\u4e3a $y$\u3002\n\n$mem[biw][now][x][y]$ \u5219\u50a8\u5b58\u7b54\u6848\u3002\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u6709\uff1a\n\n$$mem[bit][now][x][y]=\\sum\\limits_{i=0}^{n-now}{mem[bit][now+i][x+(y+i)\\%2][\\left\\lfloor\\frac{y+i}{2}\\right\\rfloor])\\times sum[bit][i]\\times C_{now+i}^{i}}$$\n\n\u5176\u4e2d $C_{i}^{j}$ \u8868\u793a\u7ec4\u5408\u6570\uff0c$sum[i][j]$ \u8868\u793a\uff1a\n\n```cpp\nfor(register int i=0;i<=m;i++)\n{\n\tsum[i][0]=1;\n\t\t\n\tfor(register int j=1;j<=n;j++)\n\t{\n\t\tsum[i][j]=sum[i][j-1]*val[i]%mod;\n\t}\n}\n```\n\n\u53ef\u4ee5\u770b\u5230\uff0c$sum[i][j]$ \u4e3b\u8981\u4f5c\u7528\u7c7b\u4f3c\u4e8e\u524d\u7f00\u548c\uff0c\u76ee\u7684\u662f\u7b80\u5316\u8ba1\u7b97\u3002\n\n----\n\n\u8fb9\u754c\u90e8\u5206\uff1a\n\n\u5f53\u524d\u8f6c\u79fb\u5230 $dfs(bit,now,x,y)$\u3002\n\n+ \u82e5 $now=n$\uff1a\n\n\u5f53 $x+getcnt(y)>k$ \u65f6\uff0c\u8fd4\u56de $0$\u3002\u8868\u793a\u4e0d\u9700\u8981\u7ee7\u7eed\u8f6c\u79fb\u4e86\u3002\n\n\u5426\u5219\u8fd4\u56de $1$\u3002\n\n+ \u82e5 $bit>m$ \u5219\u76f4\u63a5\u8fd4\u56de\u3002\n\n+ \u82e5 $mem[bit][now][x][y]$ \u6709\u6570\u5219\u76f4\u63a5\u8fd4\u56de\u8be5\u6570\u3002\n\n# \u4ee3\u7801\n\n\u4e0d\u77e5\u9053\u662f\u4e0d\u662f\u4f60\u8c37\u7684 $\\rm Key~Words$ \u95ee\u9898\uff0c\u653e\u4e0d\u4e0a\u6765\u3002\n\n\u8be6\u89c1\u535a\u5ba2\u5185\u3002",
        "postTime": 1638423279,
        "uid": 430409,
        "name": "Coros_Trusds",
        "ccfLevel": 6,
        "title": "P7961 [NOIP2021] \u6570\u5217"
    }
]
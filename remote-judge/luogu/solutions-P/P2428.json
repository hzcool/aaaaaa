[
    {
        "content": "# \u5206\u6790\uff1a\n\u770b\u5230\u8fd9\u9053\u9898\u6211\u8fd8\u4ee5\u4e3a\u662f\u9ad8\u65af\u6d88\u5143\uff0c\u53ef\u60dc**M\u2264100000**\uff0c~~**GG**~~\n\n\u600e\u4e48\u529e\u5462\uff1f\n\n#### \u5148\u5206\u6790\u6837\u4f8b\uff08\u5982\u679c\u6211\u4eec\u7528\u6570\u5b66\u7684\u65b9\u6cd5\u6765\u505a\u7684\u8bdd\uff0c\u6211\u4eec\u8be5\u600e\u4e48\u505a\u5462\uff1f\uff09\n\n![](https://cdn.luogu.com.cn/upload/pic/60712.png)\n\n1. \u5148\u8bbe\u7b2c\u4e00\u4e2a\u6570\u4e3ax\n\n2. \u7136\u540e\u6c42\u51fa\u53e6\u5916\u4e24\u4e2a\u70b9\u7684\u503c\n\n3. \u518d\u901a\u8fc7\u65b9\u7a0b\u6c42\u5f97x\u7684\u503c\uff0c\u5176\u5b83\u70b9\u7684\u503c\u8fce\u5203\u800c\u89e3\n\n#### \u5728\u56de\u5230\u672c\u9898\n\n\u5148\u8bbe\u51fax\uff0c\u518d\u4f9d\u6b21\u5199\u51fa\u5176\u5b83\u70b9\u7684\u503c\uff08kx+b\uff09\u5f53\u6709\u91cd\u65b0\u8fd4\u56de\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u7528\u65b9\u7a0b\u6765\u6c42\u51fax\u7684\u503c\n\n```cpp\nfor(int k=1;k<=n;k++){\n\tif(v[k])continue;\n        while(!q.empty())q.pop();\n        q.push(k);\n        f[k]=1;\n        v[k]=1;\n        b[k]=0;\n        while(!q.empty()){\n            int x=q.front();\n            q.pop();\n            for(int i=head[x];i;i=c[i].next){\n                int nf=-f[x],nb=c[i].l-b[x],y=c[i].to;\n                if(f[y]){\n                    if(nf==f[y]&&nb!=b[y]){cout<<\"jinitaimei\";return 0;}\n                    if(nf!=f[y]){ans[k]=(b[y]-nb)/(nf-f[y]);break;}\n                }\n                else{\n                    q.push(y);\n                    f[y]=nf;\n                    b[y]=nb;\n                }\n            }\n        }\n        q.push(k);\n        while(!q.empty()){\n            int x=q.front();\n            q.pop();\n            for(int i=head[x];i;i=c[i].next){\n            \tint y=c[i].to;\n                if(!v[y]){\n                    v[y]=1;\n                    ans[y]=c[i].l-ans[x];\n                    q.push(y);\n                }\n            }           \t\n        }\n    }\n```\n\n\u518d\u7ed9\u4e2a\u5b8c\u6574\u7684\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nbool v[1005];\nstruct note{\n    int next,to;\n\tdouble l;\n}c[200005];\nint n,m,cnt,head[1005];\ndouble ans[1005],f[1005],b[1005];\nqueue<int>q;\nvoid add(int x,int y,int z){\n    cnt++;\n    c[cnt].l=z;\n    c[cnt].to=y;\n    c[cnt].next=head[x];\n    head[x]=cnt;\n}\nint main(){\n    int aa,bb;\n\tdouble cc;\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=m;i++)scanf(\"%d%d%lf\",&aa,&bb,&cc),add(aa,bb,cc),add(bb,aa,cc);\n    for(int k=1;k<=n;k++){\n        if(v[k])continue;\n        while(!q.empty())q.pop();\n        q.push(k);\n        f[k]=1;\n        v[k]=1;\n        b[k]=0;\n        while(!q.empty()){\n            int x=q.front();\n            q.pop();\n            for(int i=head[x];i;i=c[i].next){\n                int nf=-f[x],nb=c[i].l-b[x],y=c[i].to;\n                if(f[y]){\n                    if(nf==f[y]&&nb!=b[y]){cout<<\"jinitaimei\";return 0;}\n                    if(nf!=f[y]){ans[k]=(b[y]-nb)/(nf-f[y]);break;}\n                }\n                else{\n                    q.push(y);\n                    f[y]=nf;\n                    b[y]=nb;\n                }\n            }\n        }\n        q.push(k);\n        while(!q.empty()){\n            int x=q.front();\n            q.pop();\n            for(int i=head[x];i;i=c[i].next){\n            \tint y=c[i].to;\n                if(!v[y]){\n                    v[y]=1;\n                    ans[y]=c[i].l-ans[x];\n                    q.push(y);\n                }\n            }           \t\n        }\n    }\n    for(int i=1;i<=n;i++)printf(\"%.2lf\\n\",ans[i]);\n    return 0;\n}\n```\n\n\n",
        "postTime": 1560393534,
        "uid": 88137,
        "name": "greenheadstrange",
        "ccfLevel": 7,
        "title": "\u6811\u4e0a\u64cd\u4f5c+\u6570\u5b66+\u65b9\u7a0b\u601d\u60f3 P2428\u3010\u503a\u52a1\u6e05\u5355\u3011"
    },
    {
        "content": "## \u9898\u610f\n\u7ed9\u4f60 $m$ \u4e2a\u6761\u4ef6 $val_a+val_b = W_i$ \uff0c\u6c42\u6ee1\u8db3\u8be5\u6761\u4ef6\u7684\u89e3\u3002\n## \u5206\u6790\n- \u5982\u679c\u6709\u89e3\uff1a\n\n\u5982\u679c\u76f4\u63a5\u4ee4\u51fa\u6bcf\u4e2a $val_a$ \uff0c\u518d\u901a\u8fc7\u9ad8\u65af\u6d88\u5143\u6c42\u89e3\uff0c\u5176\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^3)$ \u3002\u53d1\u73b0\u6bcf\u4e2a\u9650\u5236\u6761\u4ef6\u90fd\u53ea\u4e0e\u4e24\u4e2a\u5143\u7d20\u6709\u5173\u3002\u53ef\u4ee5\u91c7\u7528\u4e3b\u5143\u6cd5\u3002\n\u4ee4\u4e00\u4e2a $val_i = x$ \uff0c\u8fd9\u91cc $x=1$ \u3002\u5219\u6709\uff1a\n$$\nval_1+val_b = W_j \\Rightarrow val_b=W_j-val_1\n$$\n$$\nval_b=-x+W_j\n$$\n\u82e5\u6709 $val_b+val_c = W_i$ \uff0c\u5219\uff1a\n$$\nval_b+val_c=W_j\\Rightarrow val_c=W_i-val_b\n$$\n$$\nval_c=x+(W_i-W_j)\n$$\n\u4ee5\u6b64\u7c7b\u6bd4\u3002\u6bcf\u4e2a $val_i$ \u53ef\u4ee5\u5199\u4f5c\u8fd9\u6837\u7684\u5f62\u5f0f $val_i=x+b $ \u6216\u8005 $ val_i=-x+b$ \u3002\u90a3\u4e48\u5982\u679c\u51fa\u73b0 $val_1 = -x+b$ \u5219 $val_1=x=\\frac{b}{2}$ \u3002\u90a3\u4e48\u901a\u8fc7 $dfs$ \u641c\u7d22\u3002\u53ea\u8981\u51fa\u73b0\u73af\u5c31\u53ef\u4ee5\u8ba1\u7b97\u51fa\u4e00\u7ec4\u89e3\u3002\n\n- \u5982\u679c\u65e0\u89e3\uff1a\n\n\u4e00\uff1a\u6ca1\u6709\u627e\u5230\u73af\uff0c $val_1$ \u6ca1\u6709\u4e24\u79cd\u8868\u8fbe\u65b9\u5f0f\u3002\n\n\u4e8c\uff1a\u627e\u5230\u73af\u4e86\uff0c\u4f46\u662f $val_1$ \u8868\u793a\u6210 $val_1=x+b(b\\ne0)$ \u3002\u90a3\u4e48\u4e5f\u662f\u6ca1\u6709\u89e3\u7684\u3002\n\n\u4e09\uff1a\u6709\u591a\u7ec4\u89e3\uff08\u8fd9\u5e94\u8be5\u4e0d\u53eb\u65e0\u89e3\uff09\uff0c\u4f46\u662f\u6211\u5224\u4e86\u4e00\u4e0b\u5c31 $WA$ \u4e86\uff0c\u6c42\u5927\u4f6c\u4eec\u67e5\u9519\u3002\n## \u4ee3\u7801\n```cpp\n\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N = 10000010;\n#define int long long\nconst double eps = 1e-8;\nint read()\n{\n\tint x = 0,f = 0;char ch=getchar();\n\twhile(!isdigit(ch)){if(ch=='-')f=1;ch=getchar();}\n\twhile(isdigit(ch)){x=x*10+ch-'0';ch=getchar();}\n\treturn f?-x:x;\n}\nint n,m,cnt = 0,head[N];\nbool flag = 0,vis[N];\nint A[N],B[N];\ndouble Ans;\nstruct E{int to,nxt,w;}e[N];\nvoid add(int x,int y,int w)\n{\n\te[++cnt].to = y;e[cnt].w = w;e[cnt].nxt = head[x];head[x] = cnt;\n}\nvoid dfs(int x,int a,int b)\n{\n\tif(flag) return;\n\t//cout<<x<<\" ::x \"<<a<<\" ::a \"<<b<<\" ::b\"<<endl;\n\tif(vis[x] && x == 1)\n\t{\n\t\t//ax-x = -b;\n\t\t//x = (-b)/(a-1);\n\t\tif((a==1) && b) \n\t\t{\n\t\t\tflag = 1;\n\t\t\treturn;\n\t\t}\n\t\tdouble ans = b/2.0;\n\t\tif(!Ans) Ans = ans;\n//\t\tif(fabs(Ans - ans) != 0.0)\n//\t\t{\n//\t\t\tflag = 1;\n//\t\t\treturn ; \u5c31\u662f\u8fd9\u91cc\u4e86\u4e0d\u77e5\u9053\u4e3a\u5565WA\u4e86\n//\t\t}\n\t\treturn;\n\t}\n\tvis[x] = 1;\n\tfor(int i = head[x];i;i = e[i].nxt)\n\t{\n\t\tint w = e[i].w;\n\t\tint y = e[i].to;\n\t\tif(vis[y] && !(y==1)) continue;\n\t\tdfs(y,- a,w - b);\n\t//\tcout<<y<<\" ::y  \"<<-a<<\" \"<<w-b<<endl;\n\t\tA[y] = - a;\n\t\tB[y] = w - b;\n\t}\n}\nsigned main()\n{\n\tn = read();m = read();\n\n\tfor(int i = 1;i <= m;i++)\n\t{\n\t\tint a = read(),b = read(),c = read();\n\t\tadd(a,b,c);\n\t\tadd(b,a,c);\n\t}\n\tdfs(1,1,0);\n\tA[1] = 1;B[1] = 0;\n\tif(flag)\n\t{\n\t\tcout<<\"IMPOSSIBLE\"<<endl;\n\t\treturn 0;\n\t}\n\tfor(int i = 1;i <= n;i++)\n\t{\n\t\tprintf(\"%.2lf\\n\",A[i]*Ans+B[i]);\n\t}\n}\n```\n\n\n[\u6b22\u8fce\u6765\u8e29](https://www.luogu.com.cn/blog/xzc/solution-p2428)",
        "postTime": 1593002581,
        "uid": 227824,
        "name": "JK_LOVER",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2428 \u3010\u503a\u52a1\u6e05\u5355\u3011"
    },
    {
        "content": "**\u9898\u610f\uff1a**\n\n\u6c42\u89e3\u65b9\u7a0b\u7ec4\uff1a\n\n$$\n\\begin{cases}\n x_{u_1} + x_{v_1} = w_1 \\\\\n x_{u_2} + x_{v_2} = w_2 \\\\\n \\dots \\\\\n x_{u_m} + x_{v_m} = w_m\n\\end{cases}\n$$\n\n$n \\le 10^3, m \\le 10^5$\n\n**\u9898\u89e3\uff1a**\n\n\u76f4\u63a5\u6d88\u5143\u65f6\u95f4\u590d\u6742\u5ea6\u65e0\u6cd5\u63a5\u53d7\u3002\n\n\u8003\u8651\u4eba\u7c7b\u5982\u4f55\u89e3\u65b9\u7a0b\uff1a\n\n+ \u8bbe $x_1 = a$\uff1b\n\n+ \u5bf9\u4e8e $x_1 + x_i = w_1$\uff0c\u53ef\u4ee5\u5f97\u5230 $x_i = w_1 - x_1 = w_1 - a$\uff1b\n\n+ \u5bf9\u4e8e $x_i + x_j = w_2$\uff0c\u53ef\u4ee5\u5f97\u5230 $x_j = w_2 - x_i = w_2 - w_1 + a$\uff1b\n\n+ \u4e0d\u65ad\u91cd\u590d\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u53d1\u73b0\u5bf9\u4e8e\u6bcf\u4e2a $x_i$ \u90fd\u53ef\u4ee5\u7528 $k_i \\times a + b_i$ \u8868\u793a\uff1b\n\n+ \u5bf9\u4e8e $x_r + x_1 = w_3$\uff0c\u53ef\u4ee5\u5f97\u5230 $x_1 = w_3 - x_r$\uff0c\n  \n  \u7528 $x_1$ \u7684\u8868\u8fbe\u5f0f\u6c42\u89e3\uff1a\n  \n  $$\n  \\begin{aligned}\n   k_1' \\times a + b_1' &= a \\\\\n   a &= \\frac{b_1'}{1 - k_1'}\n  \\end{aligned}\n  $$\n  \n  \u65e0\u89e3\u7684\u60c5\u51b5\u4e3a $k_1' = 0 \\land b_1' \\not= 0$\uff0c\n  \n  \u53ef\u4ee5\u89e3\u5f97 $a$\uff0c\u56de\u4ee3\u5f97\u5230 $x_1 \\sim x_n$ \u7684\u503c\u3002\n  \n\u53d1\u73b0\u6574\u4e2a\u8fc7\u7a0b\u53ef\u4ee5\u7528 dfs\uff08\u6216 bfs\uff09\u5b9e\u73b0\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(m)$\u3002\n\n```cpp\nstruct edge {\n    int to, nxt, val;\n} e[M];\n\nstruct raip {\n    int k, b;\n} f[N];\n\nint cnt, head[N];\n\ndouble ans;\n\nstd::bitset<N> vis;\n\nvoid add(int u, int v, int w) {\n    e[++cnt] = {v, head[u], w}, head[u] = cnt;\n}\n\nvoid dfs(int u, raip g) {\n    if (u == 1 and vis[1]) {\n        if (g.k == 1 and g.b) {\n            io << \"IMPOSSIBLE\", exit(0);\n        } else {\n            if (g.b) ans = g.b / 2.;\n            // \u9632\u6b62\u65e0\u6570\u89e3\u7684\u60c5\u51b5\u8986\u76d6\u6389 ans\n        }\n        return;\n    }\n    vis[u] = true;\n    for (int i = head[u]; i; i = e[i].nxt) {\n        int v = e[i].to;\n        if (! vis[v] or v == 1) {\n            dfs(v, f[v] = {-g.k, e[i].val - g.b});\n        }\n    }\n}\n\nint main() {\n    int n, m; io >> n >> m;\n    for (int i = 1; i <= m; i++) {\n        int u, v, w; io >> u >> v >> w;\n        add(u, v, w), add(v, u, w);\n    }\n    dfs(1, f[1] = {1, 0});\n    for (int i = 1; i <= n; i++) {\n        io << f[i].k * ans + f[i].b << '\\n';\n    }\n}\n\n```\n\n\u6ce8\u610f\u4e00\u4e9b[\u5b9e\u73b0\u7ec6\u8282](https://www.luogu.com.cn/discuss/529090)\u5c31\u597d\u4e86\u3002",
        "postTime": 1668432212,
        "uid": 581312,
        "name": "zerc",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2428 \u503a\u52a1\u6e05\u5355"
    },
    {
        "content": "[$\\text{\u9898\u76ee\u4f20\u9001\u95e8}$](https://www.luogu.com.cn/problem/P2428) \n$|$ \n[$\\text{\u535a\u5ba2}$](https://www.luogu.com.cn/blog/481527/p2428-zhai-wu-qing-dan-ti-xie)\n\n## $\\text{\u9898\u76ee\u5927\u610f}$\n\n\u7ed9\u4f60 $m$ \u6761\u5bf9 $n$ \u4e2a\u53d8\u91cf\u7684\u9650\u5236\uff0c\u5f62\u5982 $x_a+x_b=c$\u3002\u540c\u65f6\u6ee1\u8db3 $\\forall i ,x_i \\ge 0 $\u3002\u6c42 $x_1\\sim x_n$ \u7684\u503c\u3002\u4fdd\u7559\u4e24\u4f4d\u5c0f\u6570\u3002\u65e0\u89e3\u62a5\u544a ```IMPOSSIBLE```\u3002\u5426\u5219\u4fdd\u8bc1\u6709\u552f\u4e00\u89e3\u3002\n\n## $\\text{Solution}$\n\n\u4e0d\u59a8\u5c1d\u8bd5\u7528 $x_1$ \u8868\u793a $x_2\\sim x_n$\u3002\n\n\u4ee5\u6837\u4f8b\u4e3a\u4f8b\u5b50\uff0c\u6211\u4eec\u6709\uff1a\n\n$\\begin{cases}x_1+x_2=2\\\\x_2+x_3=4\\\\x_1+x_3=6\\end{cases}$\n\n\u53d8\u6362\u4e00\u4e0b\u5f97\u5230\uff1a\n\n$\\begin{cases}x_1=x_1\\\\x_2=2-x_1=4-x_3=4-(6-x_1)=x_1-2\\\\x_3=6-x_1=4-x_2=4-(2-x_1)=x_1+2\\end{cases}$\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u5b58\u4e0b\u4e00\u4e2a\u53d8\u91cf\u7684\u67d0\u79cd\u8868\u793a\u65b9\u6cd5\u7684\u7cfb\u6570\u548c\u5e38\u6570\uff0c\u7136\u540e\u4e0b\u4e00\u6b21\u641c\u5230\u89e3\u65b9\u7a0b\u5373\u53ef\u3002\n\n\u8fd9\u91cc\u8981\u6ce8\u610f\u5224\u65ad\u65e0\u89e3\u7684\u60c5\u51b5\uff1a\n\n+ \u82e5\u4e00\u4e2a\u672a\u77e5\u6570\u7684\u67d0\u4e24\u79cd\u8868\u793a\u65b9\u5f0f $x$ \u7684\u7cfb\u6570\u76f8\u540c\u800c\u5e38\u6570\u4e0d\u540c\uff0c\u76f4\u63a5\u8f93\u51fa\u65e0\u89e3\u3002\n\n+ \u82e5\u4e00\u4e2a\u672a\u77e5\u6570\u7684\u67d0\u4e24\u79cd\u8868\u793a\u65b9\u5f0f\u7b97\u51fa\u7684\u7b54\u6848\u4e0e\u4e4b\u524d\u4e0d\u540c\uff0c\u76f4\u63a5\u8f93\u51fa\u65e0\u89e3\u3002\n\n+ \u82e5\u4e00\u4e2a\u672a\u77e5\u6570\u7684\u67d0\u4e24\u79cd\u8868\u793a\u65b9\u5f0f\u7cfb\u6570\u5e38\u6570\u90fd\u76f8\u540c\uff0c\u76f4\u63a5\u8df3\u8fc7\uff0c\u8ba1\u7b97\u5b8c\u6bd5\u540e\u5224\u65ad\u65e0\u89e3\uff08\u65e0\u6570\u89e3\uff09\u3002\n\n\u6ce8\u610f\u53ef\u80fd\u6709\u591a\u4e8e\u4e00\u4e2a\u7684\u8fde\u901a\u5757\u3002\n\n\u4f46\u662f\u4e0d\u8981\u5fd8\u4e86\u8fd8\u6709\u4e00\u79cd\u7279\u6b8a\u60c5\u51b5\uff1a\u82e5\u4e24\u4e2a\u53d8\u91cf\u548c\u4e3a\u96f6\uff0c\u90a3\u4e48\u8fd9\u4e24\u4e2a\u53d8\u91cf\u90fd\u4e3a\u96f6\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8fde\u901a\u5757\uff0c\u5982\u679c\u6709\u4e0a\u8ff0\u60c5\u51b5\u5b58\u5728\uff0c\u5373\u53ef\u76f4\u63a5\u66f4\u65b0\u7b54\u6848\uff0c\u4f46\u8981\u6ce8\u610f\u68c0\u67e5\u7b54\u6848\u3002\n\n\u5bf9\u4e8e\u65e0\u89e3\u7684\u5224\u65ad\u6837\u4f8b\u53c2\u8003[\u8fd9\u7bc7\u5e16\u5b50](https://www.luogu.com.cn/discuss/612064)\uff0c\u4e4b\u524d\u7684\u9898\u89e3\u5168\u90e8\u65e0\u6cd5\u901a\u8fc7\u3002\n\n\u8fd9\u91cc\u6211\u4f7f\u7528 bfs \u5b9e\u73b0\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n+m)$\u3002\n\n## $\\text{Code}$\n\n```cpp\n# include <bits/stdc++.h>\nusing namespace std ; \nconst int N = 1e3 + 7 ;\nconst int M = 1e5 + 7 ;\nstruct edge {\n    int nxt , v , w ;\n} e [ M << 1 ] ;  // \u53cc\u500d\u5185\u5b58 \nint h [ N ] , cnt ;\ninline void add_edge ( int u , int v , int w ) {\n    e [ ++ cnt ] = ( edge ) { h[u] , v , w } ;\n    h[u] = cnt ;\n}\nstruct node {\n    int pos , k , b ; // \u7cfb\u6570\uff0c\u5e38\u6570 \n} tmp ;\nint k[N] , b[N] ;\ndouble x = -114514 ; // \u5f00\u59cb\u4e00\u4e2a\u4e0d\u53ef\u80fd\u7684\u503c \nint n , m ; double ans[N] ;\nbool vis[N] , vis2[N] , vis3[N] ;\nint main () {\n    ios :: sync_with_stdio ( false ) , cin . tie ( 0 ) , cout . tie ( 0 ) ;\n    cin >> n >> m ;\n    for ( int i = 1 ; i <= m ; i ++ ) {\n        int u , v , w ; cin >> u >> v >> w ;\n        add_edge ( u , v , w ) , add_edge ( v , u , w ) ;\n    }\n    queue < int > qq ;\n    for ( int i = 1 ; i <= n ; i ++ ) {\n        if ( vis[i] ) continue ; x = -114514 ;\n        bool bo = 0 ; int y ;\n\t\tqueue < int > c ; c . push ( i ) ;\n\t\twhile ( ! c . empty () ) { // bfs \u6c42 w = 0 \n\t\t\tint u = c . front () ; c . pop () ; vis2[u] = 1 ;\n\t\t\tfor ( int j = h[u] ; j ; j = e[j] . nxt ) {\n\t\t\t\tint v = e[j] . v , w = e[j] . w ;\n\t\t\t\tif ( w == 0 ) bo = 1 , y = u ;\n\t\t\t\tif ( ! vis2[v] ) {\n\t\t\t\t\tvis2[v] = 1 ; \n\t\t\t\t\tc . push ( v ) ;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif ( bo == 1 ) {\n\t\t\tqueue < int > cc ; cc . push ( y ) ;\n\t\t\twhile ( ! cc . empty () ) { // bfs \u66f4\u65b0\u7b54\u6848 \n\t\t\t\tint u = cc . front () ; cc . pop () ; vis3[u] = 1 ;\n\t\t\t\tfor ( int j = h[u] ; j ; j = e[j] . nxt ) {\n\t\t\t\t\tint v = e[j] . v , w = e[j] . w ;\n\t\t\t\t\tif ( ans[v] == 0 ) ans[v] = w - ans[u] ; // \u66f4\u65b0\u5e76 check \n\t\t\t\t\telse {\n\t\t\t\t\t\tcout << \"IMPOSSIBLE\\n\" ; // \u77db\u76fe \n\t\t\t\t\t\treturn 0 ;\n\t\t\t\t\t}\n\t\t\t\t\tif ( ! vis3[v] ) {\n\t\t\t\t\t\tvis3[v] = 1 ;\n\t\t\t\t\t\tcc . push ( v ) ;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} \n        queue < node > q ; tmp = ( node ) { i , 1 , 0 } ; q . push ( tmp ) ;\n        while ( ! q . empty () ) {\n            node u = q . front () ; q . pop () ; vis [ u . pos ] = 1 ; qq . push ( u . pos ) ;\n            if ( k [ u . pos ] == 0 && b [ u . pos ] == 0 ) { // \u66f4\u65b0\u4e00\u4e2a\u65b0\u7684\u70b9 \n                k [ u . pos ] = u . k , b [ u . pos ] = u . b ;\n                for ( int i = h [ u . pos ] ; i ; i = e[i] . nxt ) {\n                    int v = e[i] . v , w = e[i] . w ;\n                    node _ = ( node ) { v , - u . k , w - u . b } ; // w - ( kx + b ) = - kx + w - b \n                    q . push ( _ ) ;\n                }\n            }\n            if ( k [ u . pos ] == u . k && b [ u . pos ] != u . b ) { // \u65e0\u89e3 \n                cout << \"IMPOSSIBLE\\n\" ;\n                return 0 ;\n            }\n            if ( k [ u . pos ] == u . k && b [ u . pos ] == u . b ) continue ; // \u65e0\u6570\u89e3 \n            double nx = -1.0 * ( b [ u . pos ] - u . b ) / ( k [ u . pos ] - u . k ) ; // \u65b0\u7684\u7b54\u6848 \n            if ( x == -114514 ) x = nx ; \n            if ( fabs ( x - nx ) > 0.0000001 ) { // \u77db\u76fe \n                cout << \"IMPOSSIBLE\\n\" ;\n                return 0 ;\n            }\n        }\n        if ( x == -114514 && ! bo ) { // \u65e0\u6570\u89e3 \n            cout << \"IMPOSSIBLE\\n\" ;\n            return 0 ;\n        }\n        if ( bo ) continue ; // \u4e4b\u524d w = 0 \u66f4\u65b0\u8fc7\u4e86 \n\t\twhile ( ! qq . empty () ) { // \u66f4\u65b0\u7b54\u6848 \n            int u = qq . front () ; qq . pop () ;\n            ans[u] = k[u] * x + b[u] ;\n        }\n    } \n    for ( int i = 1 ; i <= n ; i ++ ) {\n    \tif ( ans[i] < 0 ) { // \u4e0d\u80fd\u4e3a\u8d1f \uff01\uff01\uff01 \n    \t\tcout << \"IMPOSSIBLE\\n\" ;\n    \t\treturn 0 ;\n\t\t}\n\t}\n\tfor ( int i = 1 ; i <= n ; i ++ )\n    \tprintf ( \"%.2f\\n\" , ans[i] ) ;\n    return 0 ; \n}\n```\n",
        "postTime": 1685008986,
        "uid": 481527,
        "name": "AC_CSP",
        "ccfLevel": 5,
        "title": "P2428 \u503a\u52a1\u6e05\u5355 \u9898\u89e3"
    }
]
[
    {
        "content": "\u663e\u7136\u8fd9\u662f\u4e2a\u6700\u77ed\u8def\u95ee\u9898\u3002\u6211\u7528\u7684SPFA\u3002\n\n\u533a\u522b\u5728\u4e8e\uff0c\u5728\u677e\u5f1b\u65f6\u67092\u4e2a\u6807\u51c6\u3002\u5148\u770b\u4e22\u5931\u7387\u662f\u5426\u66f4\u5c0f\uff0c\u82e5\u4e22\u5931\u7387\u76f8\u540c\uff0c\u518d\u770b\u65f6\u5ef6\u662f\u5426\u66f4\u5c0f\u3002\n\n\u7531\u4e8e\u5c0f\u6570\u76f8\u4e58\u4f1a\u8d8a\u6765\u8d8a\u5c0f\uff0c\u4e0d\u4fbf\u4e8e\u677e\u5f1b\uff0c\u56e0\u6b64\u6211\u5c06\u4e22\u5931\u7387\u8f6c\u53d8\u4e3a\u201c\u4f20\u8f93\u7387\u201d(\u53731-\u4e22\u5931\u7387)\u3002\n\n\u4ee5\u4e0a\u3002\u4e0b\u9762\u8d34\u7a0b\u5e8f\uff1a\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nint n,Stt,End;\nint Time[203][203];\ndouble Loss[203][203];\nint Dist[203];\ndouble Tot[203];\nqueue<int> Que;\nset<int> Vis;\n\nvoid Init() {\n    cin>>n>>Stt>>End;\n    for (int i=1;i<=n;i++)\n        for (int j=1;j<=n;j++) cin>>Time[i][j];\n    for (int i=1;i<=n;i++)\n        for (int j=1;j<=n;j++) {\n            cin>>Loss[i][j]; \n            if (Loss[i][j]>=0) Loss[i][j]=1-Loss[i][j];\n        }\n    return;\n}\n\nvoid SPFA() {\n    memset(Dist,0x7f,sizeof(Dist)); \n    memset(Tot,0,sizeof(Tot));\n    Dist[Stt]=0; Tot[Stt]=1;\n    Que.push(Stt); Vis.insert(Stt);\n    while (!Que.empty()) {\n        int Frt=Que.front(); Que.pop(); Vis.erase(Frt); \n        for (int i=1;i<=n;i++) {\n            if (i==Frt) continue;\n            if (Time[Frt][i]==-1) continue;\n            if (Tot[Frt]*Loss[Frt][i]>Tot[i]) {\n                Tot[i]=Tot[Frt]*Loss[Frt][i];\n                Dist[i]=Dist[Frt]+Time[Frt][i];\n                if (Vis.count(i)) continue;\n                Que.push(i); Vis.insert(i);\n            }\n            else if (Tot[Frt]*Loss[Frt][i]==Tot[i]) {\n                if (Dist[Frt]+Time[Frt][i]<Dist[i]) {\n                    Dist[i]=Dist[Frt]+Time[Frt][i];\n                    if (Vis.count(i)) continue;\n                    Que.push(i); Vis.insert(i);\n                }\n            }\n        }\n    }\n    return;\n}\n\nint main() {\n    ios::sync_with_stdio(0);\n    Init();\n    SPFA();\n    cout<<Dist[End]<<' '<<fixed<<setprecision(4)<<1-Tot[End]<<endl;\n    return 0;\n}\n\n```",
        "postTime": 1525761765,
        "uid": 72520,
        "name": "\u5170\u4ead\u6155\u96e8",
        "ccfLevel": 0,
        "title": "P2269 \u89e3\u9898\u62a5\u544a By Dean"
    },
    {
        "content": "\u6c34\u4e00\u53d1\u6700\u77ed\u8def\u9898\u89e3~\n\n#### \u5173\u4e8e\u672c\u9898\u89e3\n\n\u9898\u76ee\u5f88\u7b80\u5355\uff0c\u4e3b\u8981\u662f\u770b\u5230\u5df2\u6709\u9898\u89e3\u5bf9\u4e8e\u9898\u76ee\u7684\u5206\u6790\u4e0d\u591f\u6570\u5b66\uff08\uff1f\uff09\uff0c\u770b\u7740\u6709\u70b9\u522b\u626d ~~\uff08\u4f60\u4e8b\u597d\u591a\u554a\uff09~~\uff0c\u5c31\u5199\u4e86\u8fd9\u7bc7\u9898\u89e3\u3002\n\n# \u6b63\u6587\n\n### \u9898\u76ee\u5927\u610f\uff1a\n\n\u7ed9\u51fa\u4e00\u4e2a\u65e0\u5411\u56fe\uff0c\u6bcf\u6761\u8fb9\u6709\u4e24\u4e2a\u6743\u503c\uff1a $t$ \u548c $p$ \u3002\u6c42\u56fe\u4e2d\u6307\u5b9a\u7684\u8d77\u70b9\u4e0e\u7ec8\u70b9\u4e4b\u95f4\u7684\u4e00\u6761\u8def\u5f84\uff0c\u8981\u6c42\u6ee1\u8db3\u4ee5\u4e0b\u4e24\u4e2a\u6761\u4ef6\uff1a\uff08\u8bbe\u8fd9\u6761\u8def\u5f84\u5171\u7ecf\u8fc7 $n$ \u6761\u8fb9\uff0c\u5206\u522b\u4e3a $v_1 \\dots v_n$\uff09\n\n1.  $1-\\prod\\limits_{i=1}^n(1-p_i)$ \u7684\u503c\u6700\u5c0f\u3002\n\n2. \u5728\u6ee1\u8db3`\u6761\u4ef61`\u7684\u524d\u63d0\u4e0b\uff0c$\\sum\\limits_{i=1}^n t_i$\u7684\u503c\u6700\u5c0f\u3002 \n\n### \u5206\u6790\n`\u6761\u4ef6\u4e8c`\u663e\u7136\u8981\u6c42\u6700\u77ed\u8def\uff0c~~\u4f46\u540c\u6837\u663e\u7136~~\uff0c\u6211\u4eec\u53d1\u73b0\u65e0\u6cd5\u901a\u8fc7\u6700\u77ed\u8def\u76f4\u63a5\u6c42\u51fa`\u6761\u4ef61`\u5f62\u5f0f\u7684\u6700\u5c0f\u503c\uff0c\u9700\u8981\u8f6c\u5316\u4e00\u4e0b\u3002\n\n\u8fd0\u7528**\u590d\u5408\u51fd\u6570**\u7684\u601d\u60f3\uff0c\u6211\u4eec\u5c06`\u6761\u4ef61`\u7ed9\u51fa\u7684\u5f0f\u5b50\u62c6\u5206\u4e00\u4e0b\uff0c\u5e76\u5206\u6790\u5176\u5355\u8c03\u6027\u3002\n\n\u8bbe$f(n)=1-g(n)$\uff0c$g(n)=\\prod \\limits_{i=1}^n(1-p_i)$\u3002\n\n\u5728$g(n)$\u53d6\u5230\u6700\u5927\u503c\u65f6\uff0c$f(n)$\u53d6\u5230\u6700\u5c0f\u503c\u3002\n\n\u89c2\u5bdf $g(n)$ \u51fd\u6570\uff0c\u53ef\u4ee5\u60f3\u5230\u7ed9\u6bcf\u6761\u8fb9\u8d4b\u4e0a\u4e00\u4e2a\u65b0\u7684\u6743\u503c $w_i=1-p_i$.\n\n\n\n`\u6761\u4ef61`\u5c31\u8f6c\u5316\u6210\u4e86\u4f7f$g(n)=\\prod\\limits_{i=1}^n w_i$\u53d6\u5230\u6700\u5927\u503c\u3002\n\n\u5230\u8fd9\u91cc\u5c31\u5f88\u7b80\u5355\u5566\uff0c\u7c7b\u4f3c\u7684\u9898\u76ee\u5e76\u4e0d\u5c11\u3002\u5c06**\u8def\u5f84\u957f\u5ea6**\u5b9a\u4e49\u4e3a\u8def\u5f84\u4e0a\u6bcf\u6761\u8fb9\u7684\u6743\u503c$w$\u7684\u4e58\u79ef\uff0c\u6c42**\u6700\u957f\u8def**\u5373\u53ef\u3002\n\n\n### \u5177\u4f53\u5b9e\u73b0\u7ec6\u8282\n\n\u5efa\u56fe\u5177\u4f53\u5728\u4ee3\u7801\u91cc\n\n\u6700\u957f\u8def\u8981\u7528SPFA\u6765\u6c42\u3002\n\n\u4e24\u4e2a\u6761\u4ef6\u662f\u6709\u4f18\u5148\u7ea7\u7684\uff0c\u6240\u4ee5\u677e\u5f1b\u65f6\u8981\u6ce8\u610f\uff1a\n\n- \u5f53`\u6761\u4ef61`\u53ef\u4ee5\u88ab\u66f4\u65b0\u65f6\uff0c\u4e24\u4e2a\u6761\u4ef6\u90fd\u8981\u66f4\u65b0\u3002\n\n- \u5f53`\u6761\u4ef61`\u76f8\u540c\uff0c`\u6761\u4ef62`\u53ef\u4ee5\u66f4\u65b0\u65f6\uff0c\u53ea\u66f4\u65b0`\u6761\u4ef62`\u3002\n\n\u5224\u65ad\u6d6e\u70b9\u6570\u7684\u76f8\u7b49\u65f6\uff0c\u4f1a\u6709\u7cbe\u5ea6\u8bef\u5dee\uff0c\u4e0d\u80fd\u76f4\u63a5\u7528`==`\u3002\u8bbe\u7f6e\u4e00\u4e2a\u7cbe\u5ea6 $eps$\uff0c\u4e00\u822c\u662f$10^{-6}$\uff0c\u5f53\u4e24\u4e2a\u6d6e\u70b9\u6570\u4e4b\u5dee\u7684\u7edd\u5bf9\u503c\u5c0f\u4e8e$eps$\u65f6\uff0c\u8ba4\u4e3a\u4e24\u6570\u76f8\u540c\u3002\n\n### Before the Code\n\n\u53d8\u91cf\u540d\u53ef\u80fd\u6709\u4e9b\u5947\u5947\u602a\u602a\u2026\u2026\u5e0c\u671b\u4e0d\u4f1a\u5f71\u54cd\u9605\u8bfb\u3002\u5982\u679c\u53d1\u73b0\u672c\u9898\u89e3\u6709\u9519\u8bef\u6216\u8005\u6709\u7591\u95ee\u6b22\u8fce\u8bc4\u8bba\u6216\u79c1\u4fe1\u4ea4\u6d41\uff01\n\n#### Enjoy the Code\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<cstring>\n#include<string>\n#include<algorithm>\n#include<queue>\n#include<cmath>\nusing namespace std;\n#define EPS 1e-6//\u7cbe\u5ea6\nconst int maxn=220;\nconst int maxm=50000;\nint n,u,v,tot;\nint lin[maxn],to[maxm],ne[maxm];\nint t[maxm],dis[maxn];\ndouble p[maxm],ti[maxn];\nvoid add(int x,int y,int k,double w)\n{//\u94fe\u5f0f\u524d\u5411\u661f\n\tto[++tot]=y;\n\tne[tot]=lin[x];\n\tlin[x]=tot;\n\tt[tot]=k;\n\tp[tot]=w;\n}\nint a[maxn][maxn];\ndouble b[maxn][maxn];\nqueue<int>q;\nint vis[maxn];\nvoid spfa(int s)\n{\n\tdis[s]=0;\n\tti[s]=1;\n\tvis[s]=1;\n\tq.push(s);\n\twhile(!q.empty())\n\t{\n\t\tint x=q.front();\n\t\tq.pop();\n\t\tvis[x]=0;\n\t\tfor(int i=lin[x];i;i=ne[i])\n\t\t{\n\t\t\tint y=to[i];\n\t\t\tif(ti[y]<ti[x]*p[i])//\u4f18\u5148\u7ea71\n\t\t\t{\n\t\t\t\tdis[y]=dis[x]+t[i];\n\t\t\t\tti[y]=ti[x]*p[i];\n\t\t\t\tif(!vis[y])\n\t\t\t\t{\n\t\t\t\t\tq.push(y);\n\t\t\t\t\tvis[y]=1;\n\t\t\t\t}\n\t\t\t}else//\u4f18\u5148\u7ea72\n\t\t\t{\n\t\t\t\tif(fabs(ti[y]-ti[x]*p[i])<EPS&&dis[y]>dis[x]+t[i])\n\t\t\t\t{\n\t\t\t\t\tdis[y]=dis[x]+t[i];\n\t\t\t\t\tif(!vis[y])\n\t\t\t\t\t{\n\t\t\t\t\t\tq.push(y);\n\t\t\t\t\t\tvis[y]=1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\nint main(){\n\tscanf(\"%d%d%d\",&n,&u,&v);\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tscanf(\"%d\",&a[i][j]);\n\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tscanf(\"%lf\",&b[i][j]);\n\t//\u5148\u8bfb\u8fdb\u6765\u4e24\u4e2a\u6743\u503c\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tdis[i]=0x3f3f3f3f;\n\t\tti[i]=-1;//\u521d\u59cb\u5316\n\t\tfor(int j=i+1;j<=n;j++)//\u56e0\u4e3a\u662f\u65e0\u5411\u8fb9\uff0c\u53ea\u9700\u8981\u534a\u4e2a\u90bb\u63a5\u77e9\u9635\n\t\t\tif(a[i][j]!=-1)\n\t\t\t{//\u6709\u8fb9\u5c31\u5efa\u8fb9\n\t\t\t\tadd(i,j,a[i][j],1-b[i][j]);\n\t\t\t\tadd(j,i,a[i][j],1-b[i][j]);//\u6ce8\u610f\u65b0\u7684\u8fb9\u6743\n\t\t\t}\t\n\t}\n\tspfa(u);\n\tprintf(\"%d %.4lf\",dis[v],1-ti[v]);\n\treturn 0;\n}\n```\n### See Ya\uff01\n",
        "postTime": 1606392321,
        "uid": 114012,
        "name": "chichichichi",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2269 \u3010[HNOI2002]\u9ad8\u8d28\u91cf\u7684\u6570\u636e\u4f20\u8f93\u3011"
    },
    {
        "content": "\u53cc\u5173\u952e\u5b57spfa+\u90bb\u63a5\u77e9\u9635 \n\n\u4e22\u5931\u7387\u4e3a\u7b2c\u4e00\u5173\u952e\u5b57\uff0c\u65f6\u5ef6\u662f\u7b2c\u4e8c\u5173\u952e\u5b57\u3002\n\n\u5982\u679c\u4e22\u5931\u7387\u4e00\u6837\uff0c\u65f6\u5ef6\u53ef\u66f4\u65b0\u5c31\u66f4\u65b0\u3002\n\n\u5982\u679c\u66f4\u65b0\u4e86\u4e22\u5931\u7387\u5f3a\u5236\u66f4\u65b0\u65f6\u5ef6\u3002\n\nfloyd\u4e5f\u53ef\u4ee5\u505a\u3002\n\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nint n,s,t;\nstruct node{\n\tlong double w1;\n\tlong long w2;\n}edge[220][220];\nlong double dis1[220];\nlong long dis2[220];\nint vis[220];\nvoid spfa(int s)\n{\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tdis1[i]=0;//\u4e22\u5305\u7387 \n\t\tdis2[i]=0x7f;//\u65f6\u5ef6 \n\t}\n\tqueue<int> q;\n\tq.push(s);\n\tvis[s]=1;\n\tdis1[s]=1;\n\tdis2[s]=0;\n\twhile(q.size())\n\t{\n\t\tint x=q.front();\n\t\tq.pop();\n\t\tvis[x]=0;\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tif(edge[x][i].w2==-1||x==i)//\u65e0\u8fb9\u6216\u8005\u91cd\u5408 \n\t\t\tcontinue;\n\t\t\tif(dis1[x]*edge[x][i].w1>dis1[i])\n\t\t\t{\n\t\t\t\tdis1[i]=dis1[x]*edge[x][i].w1;\n\t\t\t\tdis2[i]=dis2[x]+edge[x][i].w2;//\u5f3a\u5236\u66f4\u65b0\n\t\t\t\tif(!vis[i])\n\t\t\t\t{\n\t\t\t\t\tq.push(i);\n\t\t\t\t\tvis[i]=1;\n\t\t\t\t} \n\t\t\t}\n\t\t\telse if((dis1[x]*edge[x][i].w1==dis1[i])&&(dis2[i]>dis2[x]+edge[x][i].w2))//\u53ef\u4ee5\u66f4\u65b0\u65f6\u5ef6 \n\t\t\t{\n\t\t\t\tdis2[i]=dis2[x]+edge[x][i].w2;\n\t\t\t\tif(!vis[i])\n\t\t\t\t{\n\t\t\t\t\tq.push(i);\n\t\t\t\t\tvis[i]=1;\n\t\t\t\t} \n\t\t\t}\n\t\t}\n\t}\n}\nint main()\n{\n\tcin>>n>>s>>t;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tcin>>edge[i][j].w2;//\u65f6\u5ef6 \n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tlong double x;\n\t\t\tcin>>x;\n\t\t\tif(x>=0)\n\t\t\tedge[i][j].w1=(1-x);//\u4e22\u5931\u7387 \n\t\t}\n\t}\n\tspfa(s);\n\tcout<<dis2[t]<<\" \";\n\tprintf(\"%.4Lf\",(long double)1-dis1[t]);\n\treturn 0;\n} \n```",
        "postTime": 1606362022,
        "uid": 250699,
        "name": "Herkaii",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2269 \u3010[HNOI2002]\u9ad8\u8d28\u91cf\u7684\u6570\u636e\u4f20\u8f93\u3011"
    },
    {
        "content": "\u849f\u84bb\u62cd\u4e2aFloyd\u7684\u9898\u89e3qwq\u3002\n\n\u7531\u4e8e\u672c\u9898n\u624d`200`\uff0c\u5efa\u8bae\u679c\u65ad\u62cdFloyd\uff0c\u4e0d\u4ec5\u597d\u5199\uff0c\u8fd8\u597d\u8c03\uff0c\u4ee3\u7801\u8fde1kb\u90fd\u4e0d\u5230\u3002\n\n\u9b54\u6539\u4e00\u4e0b\u677f\u5b50\uff0c\u5b58i\u5230j\u7684$\\sum T_{ij}$\u548c$\\prod(1-p_{ij})$\uff0c\u7136\u540e\u677e\u5f1b\u7684\u65f6\u5019\uff0c\u5982\u679cPi\u76f8\u4e58\u8f83\u5927\u7684\u8bdd\u5c31\u66f4\u65b0\uff0c\u5426\u5219\u82e5Pi\u76f8\u4e58\u76f8\u7b49\u5c31\u6bd4\u8f83Ti\u3002\n\n\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6d6e\u70b9\u6570\u4e0d\u80fd\u76f4\u63a5\u7528`==`\uff0c\u4f1a\u6709\u7cbe\u5ea6\u8bef\u5dee\uff08\u4f46\u662f\u6211`long double`\u7adf\u7136\u6c34\u8fc7\u53bb\u4e86\uff09\u3002\n\n\u9644AC\u4ee3\u7801\n\n```cpp\n#include <cstdio>\nusing namespace std;\n\nint ti[205][205];\nlong double pi[205][205]; //long double\u9632\u5361\u7cbe\u4fdd\u5e73\u5b89\n\nint main()\n{\n\tint n,s,t;\n\tscanf(\"%d%d%d\",&n,&s,&t);\n\tfor(int i=1; i<=n; ++i)\n\t{\n\t\tfor(int j=1; j<=n; ++j)\n\t\t{\n\t\t\tscanf(\"%d\",ti[i]+j);\n\t\t}\n\t}\n\tfor(int i=1; i<=n; ++i)\n\t{\n\t\tfor(int j=1; j<=n; ++j)\n\t\t{\n\t\t\tscanf(\"%Lf\",pi[i]+j);\n\t\t\tpi[i][j] = 1-pi[i][j];\n\t\t}\n\t}\n\t\n\tfor(int k=1; k<=n; ++k)\n\t{\n\t\tfor(int i=1; i<=n; ++i)\n\t\t{\n\t\t\tfor(int j=1; j<=n; ++j)\n\t\t\t{\n\t\t\t\tif(~ti[i][k] && ~ti[k][j])\n\t\t\t\t{\n\t\t\t\t\tif(!~ti[i][j] || pi[i][j]<pi[i][k]*pi[k][j] ||\n\t\t\t\t\t\t\t(pi[i][j]==pi[i][k]*pi[k][j] && ti[i][j]>ti[i][k]+ti[k][j]))\n\t\t\t\t\t{\n\t\t\t\t\t\tti[i][j] = ti[i][k]+ti[k][j];\n\t\t\t\t\t\tpi[i][j] = pi[i][k]*pi[k][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tprintf(\"%d %.4Lf\\n\",ti[s][t],1-pi[s][t]);\n}\n```",
        "postTime": 1564921570,
        "uid": 49458,
        "name": "\u6728\u6728\uff01",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2269 \u3010[HNOI2002]\u9ad8\u8d28\u91cf\u7684\u6570\u636e\u4f20\u8f93\u3011"
    },
    {
        "content": "\u8fd9\u9898\u7ed9\u5927\u5bb6\u63d0\u4f9b\u4e00\u4e0b\u4e0d\u540c\u7684\u601d\u8def~\n\n**\u603b\u4f53\u601d\u8def**\n\n\u6c42\u4f20\u8f93\u5931\u8d25\u7387 $1-\\prod(1-p_{i})$ \u6700\u5c0f\u5c31\u662f\u6c42 \u4f20\u8f93\u6210\u529f\u7387 $\\prod(1-p_{i})$ \u6700\u5927\u3002\n\n\u6c42\u4e00\u4e2a\u6700\u77ed\u8def\uff0c\u4f7f\u5f97\u4f20\u8f93\u6210\u529f\u7387\uff081-\u5931\u8d25\u7387\uff09\u6700\u5927\u4e3a\u7b2c\u4e00\u5173\u952e\u5b57\uff0c\u65f6\u5ef6\u6700\u5c0f\u4e3a\u7b2c\u4e8c\u5173\u952e\u5b57\u3002\n\n**\u601d\u8def1**\n\n\u6b63\u5982\u53e6\u4e00\u7bc7\u9898\u89e3\u7684\u601d\u8def\uff0c\u6211\u4eec\u53ef\u4ee5\u7a0d\u5fae\u6539\u53d8\u4e00\u4e0b\u4f20\u7edf\u7684spfa\uff1a\n\n\u5728\u677e\u5f1b\u64cd\u4f5c\u65f6\uff0c\u5982\u679c\u4f20\u8f93\u6548\u7387\u66f4\u597d\uff0c\u5219\u677e\u5f1b**\u4f20\u8f93\u6548\u7387**\u53ca**\u8be5\u6548\u7387\u4e0b\u5bf9\u5e94\u7684\u65f6\u5ef6**\u3002\u5982\u679c\u4f20\u8f93\u6548\u7387\u4e00\u81f4\uff0c\u5219\u53ea\u677e\u5f1b**\u8be5\u6548\u7387\u4e0b\u5bf9\u5e94\u7684\u65f6\u5ef6**\u3002\u5982\u679c\u4f20\u8f93\u6548\u7387\u66f4\u5dee\uff0c\u4ec0\u4e48\u90fd\u4e0d\u66f4\u65b0\u3002\n\n\u8fd9\u6837\u5c31\u80fd\u4fdd\u8bc1\u4e24\u4e2a\u5173\u952e\u5b57\u7684\u6b21\u5e8f\u3002\n\n```cpp\n#include <cstdio>\n#include <queue>\n#include <cmath>\nusing namespace std; \nconst int S=80001,inf=(1<<30)-1,SS=201;\nconst double eps=1e-6;\nint n,m,is[S],ss,tt,dt[S],t[SS][SS];\ndouble g[SS][SS],dg[S];\nqueue<int> q;\nvoid init()\n{\n    int uu,vv;\n    scanf(\"%d%d%d\",&n,&ss,&tt);\n    for (int i=1;i<=n;i++)\n    \tfor (int j=1;j<=n;j++)\n    \t\tscanf(\"%d\",t[i]+j);\n    for (int i=1;i<=n;i++)\n    \tfor (int j=1;j<=n;j++)\n    \t{\n    \t\tscanf(\"%lf\",&g[i][j]);\n    \t\tif (g[i][j]!=-1)\n\t\t\t\tg[i][j]=1-g[i][j];\n    \t}\n    return;\n}\nvoid spfa()\n{\n    for (int i=1;i<=n;i++)\n\t{\n\t\tdg[i]=-inf;\n\t\tdt[i]=inf;\n\t}\n    dg[ss]=1;\n    dt[ss]=0;\n\tq.push(ss);\n\tis[ss]=1;\n    while (!q.empty())\n    {\n        int x=q.front();//printf(\"%d\\n\",top);\n        q.pop();is[x]=0;\n        for (int i=1;i<=n;i++)\n        \tif (x!=i && t[x][i]!=-1)\n            {\n            \tif (dg[i]<dg[x]*g[x][i])\n            \t{\n                \tdg[i]=dg[x]*g[x][i];\n                \tdt[i]=dt[x]+t[x][i];\n\t                if (!is[i])\n\t                {\n\t                    is[i]=1;\n\t\t\t\t\t\tq.push(i);\n\t\t\t\t\t}\n\t            }\n\t            else if (fabs(dg[i]-dg[x]*g[x][i])<=eps && \n                         dt[i]>dt[x]+t[x][i])\n\t            {\n\t            \tdt[i]=dt[x]+t[x][i];\n\t            \tif (!is[i])\n\t            \t{\n\t            \t\tis[i]=true;\n\t            \t\tq.push(i);\n\t            \t}\n\t            }\n            }\n    }\n    return;\n}\nvoid work()\n{\n    spfa();\n    printf(\"%d %.4f\",dt[tt],1-dg[tt]);\n    return;\n}\nint main()\n{\n    init();work();\n    return 0;\n}\n```\n\n**\u601d\u8def2(\u6b21\u597d)**\n\n\u6211\u4eec\u53ef\u4ee5\u5148spfa\u4e00\u4e0b\u4f20\u8f93\u6210\u529f\u7387\uff0c\u518dspfa\u65f6\u5ef6\u3002\n\n\u6211\u4eec\u7528$d$\u6570\u7ec4\u8bb0\u5f55\u4e00\u4e2a\u70b9\u7684\u6210\u529f\u7387,$e$\u4e8c\u7ef4\u6570\u7ec4\u8bb0\u5f55\u8fb9\u7684\u4e22\u5931\u7387\u3002\n\n\u5728spfa\u65f6\u5ef6\u65f6\uff0c\u677e\u5f1b\u65f6\u7684\u5224\u65ad\u662f\u5426\u66f4\u65b0\u7684\u6761\u4ef6\u8bed\u53e5\u4e2d\u52a0\u4e00\u4e2a\u5224\u65ad $(d_u \\times (1-e_{u,v})==d_v)$\n\n\u4e5f\u5c31\u662f\u53ef\u4ee5\u7406\u89e3\u4e3a\uff0c\u6cbf\u7740\u4f20\u8f93\u6210\u529f\u7387\u6700\u5927\u7684\u8fb9\uff08\u7b26\u5408\u7b2c\u4e00\u5173\u952e\u5b57\u7684\u8fb9\uff09\u6765\u66f4\u65b0\u5404\u4e2a\u8282\u70b9\u7684\u65f6\u5ef6\u3002\n\n\u8fd9\u6837\u4e5f\u53ef\u4ee5\u3002\n\n```cpp\n#include <cstdio>\n#include <queue>\n#include <cmath>\nusing namespace std; \nconst int S=80001,inf=(1<<30)-1,SS=203;\nconst double eps=1e-6;\nint n,m,s,ss,tt,d[S],g[SS][SS];\ndouble h[SS][SS],dh[SS];\nbool is[S];\nqueue<int> q;\nvoid init()\n{\n    int uu,vv;\n    scanf(\"%d%d%d\",&n,&ss,&tt);\n    for (int i=1;i<=n;i++)\n    \tfor (int j=1;j<=n;j++)\n    \t\tscanf(\"%d\",g[i]+j);\n    for (int i=1;i<=n;i++)\n    \tfor (int j=1;j<=n;j++)\n    \t{\n    \t\tscanf(\"%lf\",&h[i][j]);\n    \t\tif (h[i][j]!=-1)\n\t    \t\th[i][j]=1-h[i][j];\n    \t}\n    return;\n}\nvoid spfa_1()\n{\n    for (int i=1;i<=n;i++) dh[i]=-1;\n    dh[ss]=1;q.push(ss);is[ss]=true;\n    for (int x;!q.empty();q.pop())\n    {\n    \tx=q.front();\n    \tis[x]=false;\n    \tfor (int i=1;i<=n;i++)\n    \t\tif (x!=i && g[x][i]!=-1 && dh[i]<dh[x]*h[x][i])\n    \t\t{\n    \t\t\tdh[i]=dh[x]*h[x][i];\n    \t\t\tif (!is[i])\n    \t\t\t{\n    \t\t\t\tis[i]=true;\n    \t\t\t\tq.push(i);\n    \t\t\t}\n    \t\t}\n    }\n    return;\n}\nvoid spfa_2()\n{\n    for (int i=1;i<=n;i++) d[i]=inf;\n    d[ss]=0;q.push(ss);is[ss]=1;\n    for (int x;!q.empty();q.pop())\n    {\n        x=q.front();\n        is[x]=false;\n        for (int i=1;i<=n;i++)\n        \tif (x!=i && g[x][i]!=-1 && \n                fabs(dh[x]*h[x][i]-dh[i])<=eps && d[i]>d[x]+g[x][i])\n            {\n                d[i]=d[x]+g[x][i];\n                if (!is[i])\n                {\n                    is[i]=true;\n\t\t\t\t\tq.push(i);\n\t\t\t\t}\n            }\n    }\n    return;\n}\nvoid work()\n{\n    spfa_1();\n    spfa_2();\n    printf(\"%d %.4f\",d[tt],1-dh[tt]);\n    return;\n}\nint main()\n{\n    init();work();\n    return 0;\n}\n```\n\n**\u540e\u8bb0**\n\n\u8fd9\u9898\u662f\u6211\u65f6\u9694\u4e86\u534a\u5e74\u4e24\u6b21\u5199\u7684\u9898\u76ee\u3002\u90a3\u65f6\u662f\u601d\u8def2\uff0c\u8fd8\u6ca1\u5199\u5bf9\uff0c\u53ea\u670910\u5206\uff0c\u73b0\u5728\u6709\u4e86\u4e24\u4e2a\u601d\u8def\u3002\u4e0d\u540c\u7684\u6c34\u5e73\uff0c\u679c\u7136\u6709\u4e0d\u540c\u7684\u611f\u609f\u3002\u7b97\u6cd5\u6709\u65f6\u5019\uff0c\u8fd8\u771f\u7684\u662f\u4e00\u95e8\u503c\u5f97\u7814\u7a76\u7684\u827a\u672f\u3002",
        "postTime": 1543755207,
        "uid": 34907,
        "name": "Hygebra",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2269 \u3010[HNOI2002]\u9ad8\u8d28\u91cf\u7684\u6570\u636e\u4f20\u8f93\u3011"
    }
]
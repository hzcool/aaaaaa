[
    {
        "content": "\u4e00\u9053\u83ab\u961f\u5927\u6c34\u9898\u3002\n\n\u8ddf\u8fd9\u9053\u9898\u96be\u5ea6\u5dee\u4e0d\u591a\u7684\u677f\u5b50\u9898\u8fd8\u6709 [SP3267](https://www.luogu.com.cn/problem/SP3267)\n[P3901](https://www.luogu.com.cn/problem/P3901)\n[P2709](https://www.luogu.com.cn/problem/P2709) \u7b49\u3002\n\n~~\u603b\u4e4b\u83ab\u961f\u6c34\u9898\u6ee1\u5730\u8dd1\u3002~~\n\n[\u5173\u4e8e\u83ab\u961f\u7684\u77e5\u8bc6](https://baijiahao.baidu.com/s?id=1611364100257622493&wfr=spider&for=pc)\n\n\u6253\u597d\u677f\u5b50\u540e\uff0c\u6211\u4eec\u53ea\u8981\u6539\u8fd9\u4e9b\u5730\u65b9\u3002\n\n\u56e0\u4e3a\u9898\u76ee\u8981\u6c42\u6070\u597d\u51fa\u73b0\u4e24\u6b21\u7684\u81ea\u7136\u6570\u7684\u6570\u91cf\uff0c\u6240\u4ee5\u7b54\u6848\u7edf\u8ba1 $ans$ \u8981\u8fd9\u4e48\u5199\u3002\n\n**\u52a0\u5165\u4e00\u4e2a\u6570\u5b57**\uff1a\u5f53\u52a0\u5165\u8fd9\u4e2a\u6570\u5b57\u524d\uff0c\u8fd9\u4e2a\u6570\u5b57\u7684\u51fa\u73b0\u6b21\u6570\u4e3a $1$\uff0c\u7b54\u6848\u52a0\u4e00\u3002\n\n\u5f53\u52a0\u5165\u8fd9\u4e2a\u6570\u5b57\u524d\uff0c\u8fd9\u4e2a\u6570\u5b57\u7684\u51fa\u73b0\u6b21\u6570\u4e3a $2$\uff0c\u7b54\u6848\u51cf\u4e00\u3002\n\n**\u51cf\u53bb\u4e00\u4e2a\u6570\u5b57**\uff1a\u5f53\u51cf\u53bb\u8fd9\u4e2a\u6570\u5b57\u524d\uff0c\u8fd9\u4e2a\u6570\u5b57\u7684\u51fa\u73b0\u6b21\u6570\u4e3a $3$\uff0c\u7b54\u6848\u52a0\u4e00\u3002\n\n\u5f53\u51cf\u53bb\u8fd9\u4e2a\u6570\u5b57\u524d\uff0c\u8fd9\u4e2a\u6570\u5b57\u7684\u51fa\u73b0\u6b21\u6570\u4e3a $2$\uff0c\u7b54\u6848\u51cf\u4e00\u3002\n\n\u8fd9\u4e2a\u7ed3\u8bba\u5f88\u597d\u63a8\u5427\u3002\n\n\u53e6\u5916\u8fd9\u9898\u5176\u5b9e\u4e0d\u9700\u8981\u79bb\u6563\u5316\u4e5f\u80fd\u8fc7\uff08\u798f\u5229\uff09\u3002\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nstruct hhh{\n\tint l,r,id;\n}q[500010];\nint n,m,block,a[500010],sum[500010],ans,fans[500010];\nbool cmp(hhh a,hhh b){return (a.r/block)==(b.r/block)?a.l<b.l:a.r<b.r;}\nvoid add(int x){\n\tif(sum[a[x]]==1) ans++;\n\tif(sum[a[x]]==2) ans--;//\u6539\u52a81\n\tsum[a[x]]++;\n}\nvoid del(int x){\n\tif(sum[a[x]]==3) ans++;\n\tif(sum[a[x]]==2) ans--;//\u6539\u52a82\n\tsum[a[x]]--;\n}\nint main(){\n\tcin>>n>>m;\n\tfor(int i=1;i<=n;i++) cin>>a[i];\n\tfor(int i=1;i<=m;i++){\n\t\tcin>>q[i].l>>q[i].r;\n\t\tq[i].id=i;\n\t}\n\tblock=n/(sqrt(m*2/3));//\u7384\u5b66\u4f18\u5316\n\tsort(q+1,q+m+1,cmp);\n\tint l=0,r=0;\n\tfor(int i=1;i<=m;i++){\n\t\tint ql=q[i].l,qr=q[i].r;\n\t\twhile(l<ql) del(l++);\n\t\twhile(r>qr) del(r--);\n\t\twhile(l>ql) add(--l);\n\t\twhile(r<qr) add(++r);\n\t\tfans[q[i].id]=ans;\n\t}\n\tfor(int i=1;i<=m;i++) cout<<fans[i]<<endl;\n\treturn 0;\n}\n```\n",
        "postTime": 1642732720,
        "uid": 477118,
        "name": "Noby_Gld",
        "ccfLevel": 0,
        "title": "P7764 [COCI2016-2017#5] Poklon"
    },
    {
        "content": "[\u9898\u76ee](https://www.luogu.com.cn/problem/P7764)\n\n\u8fd9\u9053\u9898\u53ef\u4ee5\u7528\u79bb\u7ebf\u6811\u72b6\u6570\u7ec4\u6765\u505a\uff0c\u6211\u4eec\u5148\u5c06\u6bcf\u4e2a\u8be2\u95ee\u5b58\u4e0b\u6765\uff0c\u6392\u5e8f\u540e\u5bf9\u5176\u8fdb\u884c\u4fee\u6539\u4e0e\u6c42\u548c\u3002\n\n\u5bf9\u4e8e\u4fee\u6539\u65f6\u9047\u5230\u7684\u4e00\u4e2a\u6570\uff0c\u6709 4 \u79cd\u60c5\u51b5\u3002\n\n1. \u5f53\u8fd9\u4e2a\u6570\u7b2c\u4e00\u6b21\u51fa\u73b0\u3002\u8fd9\u65f6\u5b83\u8fd8\u4e0d\u80fd\u505a\u51fa\u8d21\u732e\uff0c\u53ea\u9700\u6807\u8bb0\u4e00\u4e0b\u5b83\u51fa\u73b0\u8fc7\u4e00\u6b21\u5c31\u884c\u4e86\u3002\n\n2. \u5f53\u8fd9\u4e2a\u6570\u7b2c\u4e8c\u6b21\u51fa\u73b0\u3002\u8fd9\u65f6\u6211\u4eec\u5982\u679c\u7ed9\u8fd9\u4e00\u4f4d\u7684\u8d21\u732e\u52a0 1\uff0c\u90a3\u5c31\u4f1a\u591a\u7b97\u4e00\u4e9b\uff0c\u6211\u4eec\u53ea\u80fd\u7ed9\u5b83\u524d\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\u52a0 1\uff0c\u540c\u65f6\u6807\u8bb0\u5b83\u51fa\u73b0\u4e86 2 \u6b21\u3002\n\n3. \u5f53\u8fd9\u4e2a\u6570\u7b2c\u4e09\u6b21\u51fa\u73b0\u3002\u540c\u7406\uff0c\u7ed9\u4e0a\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\u7684\u8d21\u732e\u52a0 1\u3002\u4f46\u662f\uff0c\u8fd9\u6837\u7684\u8bdd\u5f80\u524d 2 \u4f4d\u4ee5\u524d\u5c31\u4f1a\u591a\u51fa 1\uff0c\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u9700\u8981\u5c06\u4e0a\u4e0a\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\u7684\u8d21\u732e\u51cf\u6389 2\u3002\u8fd8\u6709\u8981\u8bb0\u5f97\u6807\u8bb0\u5b83\u51fa\u73b0 3 \u6b21\u4e86\u3002\n\n4. \u5f53\u8fd9\u4e2a\u6570\u51fa\u73b0\u4e86 4 \u6b21\u7ea7\u4ee5\u4e0a\u65f6\u3002\u5bf9\u4e8e\u524d\u4e24\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\u7684\u5904\u7406\u540c\u4e0a\uff0c\u4f46\u662f\u5982\u679c\u53ea\u8fd9\u6837\u4e5f\u4e0d\u884c\uff0c\u8fd8\u9700\u5c06\u4e0a\u4e0a\u4e0a\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\u7684\u8d21\u732e\u5f52\u96f6\uff0c\u5373\u52a0 1\u3002\n\n\u8fd8\u6709\u7684\u4e00\u4e9b\u7ec6\u8282\u5728\u4ee3\u7801\u4e2d\u8bb2\u89e3\u3002\n\n\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,q,b[500005];\nstruct Node{\n\tint a,b,c,x;//a\u8868\u793a\u4e0a\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0cb\u8868\u793a\u4e0a\u4e0a\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0cc\u8868\u793a\u4e0a\u4e0a\u4e0a\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0cx\u8868\u793a\u51fa\u73b0\u4e86\u51e0\u6b21\n};\nmap<int,Node>m;//Node\u7ed3\u6784\u4f53\u7528\u6765\u5b58\u50a8\u6bcf\u4e00\u4e2a\u503c\u7684\u51fa\u73b0\u6b21\u6570\u53ca\u524d\u51e0\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\nint lowbit(int x){return x&-x;}//lowbit\u51fd\u6570\uff0c\u6c42\u6b63\u6574\u6570\u7684\u4e8c\u8fdb\u5236\u72b6\u6001\u4e0b\u7684\u6700\u4f4e\u4f4d\u76841\u7684\u6743\u503c\nstruct node{\n\tint l,r,id,ans;\n\tbool operator<(const node &t)const{//\u91cd\u8f7dnode\u7ed3\u6784\u4f53\u7684\u201c<\u201d\u8fd0\u7b97\u7b26\n\t\treturn id<t.id;\n\t}\n}a[500005];//\u5b58\u50a8\u8be2\u95ee\nstruct BIT{//\u6811\u72b6\u6570\u7ec4\n\tint c[500005];//c\u662f\u6811\u72b6\u6570\u7ec4\u7684\u8282\u70b9\n\tvoid Add(int x,int y){//\u5c06x\u8fd9\u4e2a\u4f4d\u7f6e\u7684\u8d21\u732e\u52a0y\n\t\twhile(x<=n){\n\t\t\tc[x]+=y;\n\t\t\tx+=lowbit(x);\n\t\t}\n\t}\n\tint Getsum(int x){//\u6c42x\u4ee5\u524d\u7684\u524d\u7f00\u548c\n\t\tint ans=0;\n\t\twhile(x){\n\t\t\tans+=c[x];\n\t\t\tx-=lowbit(x);\n\t\t}\n\t\treturn ans;\n\t}\n\tint Getsum(int l,int r){//\u533a\u95f4\u67e5\u8be2\n\t\treturn Getsum(r)-Getsum(l-1);\n\t}\n}T;\nbool cmp(const node a,const node b){\n\treturn a.r<b.r;\n}\nint main()\n{\n\tscanf(\"%d%d\",&n,&q);\n\tfor(int i=1;i<=n;i++)scanf(\"%d\",&b[i]);//\u8bfb\u5165\u6570\u636e\n\tfor(int i=1;i<=q;i++){\n\t\tscanf(\"%d%d\",&a[i].l,&a[i].r);//\u8bfb\u5165\u8be2\u95ee\n\t\ta[i].id=i;\n\t}\n\tsort(a+1,a+q+1,cmp);//\u5c06\u8be2\u95ee\u6392\u5e8f\n\tint cnt=1;\n\tfor(int i=1;i<=q;i++){\n\t\tfor(;cnt<=a[i].r;cnt++){//\u5bf9\u6bcf\u4e2a\u8be2\u95ee\u7684\u53f3\u7aef\u70b9\u4ee5\u524d\u7684\u672a\u5904\u7406\u7684\u6240\u6709\u5143\u7d20\u8fdb\u884c\u5904\u7406\u64cd\u4f5c\n\t\t\tif(m.count(b[cnt])==1){\n\t\t\t\tif(m[b[cnt]].x==1){//\u5df2\u67091\u6b21\u51fa\u73b0\uff0c\u5373\u8fd9\u662f\u7b2c2\u6b21\u51fa\u73b0\n\t\t\t\t\tT.Add(m[b[cnt]].a,1);\n\t\t\t\t\tm[b[cnt]].x++;//\u6807\u8bb0\u6b21\u6570\n\t\t\t\t\tm[b[cnt]].b=m[b[cnt]].a;\n\t\t\t\t\tm[b[cnt]].a=cnt;\n\t\t\t\t}\n\t\t\t\telse if(m[b[cnt]].x==2){//\u5df2\u67092\u6b21\u51fa\u73b0\uff0c\u5373\u8fd9\u662f\u7b2c3\u6b21\u51fa\u73b0\n\t\t\t\t\tT.Add(m[b[cnt]].a,1);\n\t\t\t\t\tT.Add(m[b[cnt]].b,-2);\n\t\t\t\t\tm[b[cnt]].x++;//\u6807\u8bb0\u6b21\u6570\n\t\t\t\t\tm[b[cnt]].c=m[b[cnt]].b;\n\t\t\t\t\tm[b[cnt]].b=m[b[cnt]].a;\n\t\t\t\t\tm[b[cnt]].a=cnt;\n\t\t\t\t}\n\t\t\t\telse{//\u51fa\u73b0\u6b21\u6570\u5927\u4e8e\u7b49\u4e8e4\n\t\t\t\t\tT.Add(m[b[cnt]].a,1);\n\t\t\t\t\tT.Add(m[b[cnt]].b,-2);\n\t\t\t\t\tT.Add(m[b[cnt]].c,1);\n\t\t\t\t\tm[b[cnt]].c=m[b[cnt]].b;\n\t\t\t\t\tm[b[cnt]].b=m[b[cnt]].a;\n\t\t\t\t\tm[b[cnt]].a=cnt;\n\t\t\t\t\t//\u56e0\u4e3a\u51fa\u73b0\u7684\u6b21\u6570\u5927\u4e8e\u7b49\u4e8e4\u4e86\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u6807\u8bb0\u4e86\u3002\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{//\u4ee5\u524d\u8fd8\u6ca1\u51fa\u73b0\u8fc7\uff0c\u5373\u8fd9\u662f\u7b2c1\u6b21\u51fa\u73b0\n\t\t\t\tm[b[cnt]].x++;//\u6807\u8bb0\u6b21\u6570\n\t\t\t\tm[b[cnt]].a=cnt;\n\t\t\t}\n\t\t}\n\t\ta[i].ans=T.Getsum(a[i].l,a[i].r);\n\t}\n\tsort(a+1,a+q+1);\n\tfor(int i=1;i<=q;i++){\n\t\tprintf(\"%d\\n\",a[i].ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1638770728,
        "uid": 428358,
        "name": "cqbztzl",
        "ccfLevel": 5,
        "title": "P7764\u9898\u89e3"
    },
    {
        "content": "## \u9898\u610f\n[\u9898\u610f\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P7764)\n## Solution\n\u524d\u7f6e\u77e5\u8bc6\uff1a[\u666e\u901a\u83ab\u961f](https://oi-wiki.org/misc/mo-algo/)\u3002    \n\u8fd9\u662f\u4e00\u9053\u63a5\u8fd1\u4e8e\u83ab\u961f\u6a21\u677f\u9898\u7684\u7b80\u5355\u9898\uff0c\u96be\u5ea6\u8ddf- [P2709 \u5c0fB\u7684\u8be2\u95ee](https://www.luogu.com.cn/problem/P2709)\u5dee\u4e0d\u591a\uff0c\u8fd8\u6ca1\u83ab\u961f\u6a21\u677f\u9898- [P1494 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u5c0fZ\u7684\u889c\u5b50](https://www.luogu.com.cn/problem/P1494)\u96be\u3002   \n\u9996\u5148\u770b\u4e00\u773c\u6570\u636e\u8303\u56f4\uff0c$1\\leq a_i< 10^9$,\u9700\u8981\u5bf9\u8bfb\u5165\u7684\u6570\u7ec4\u79bb\u6563\u5316\u5904\u7406\u4e00\u4e0b\u3002\u7136\u540e\u5bf9\u8be2\u95ee\u5206\u5757\uff0c\u6309\u8be2\u95ee\u7684\u5de6\u7aef\u70b9\u6240\u5728\u7684\u5757\u7684\u7f16\u53f7\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u5982\u679c\u7f16\u53f7\u76f8\u540c\uff0c\u5219\u6309\u7f16\u53f7\u7684\u5947\u5076\u6027\u5bf9\u53f3\u7aef\u70b9\u6392\u5e8f\uff0c\u7f16\u53f7\u4e3a\u5947\u6570\u5219\u53f3\u7aef\u70b9\u5347\u5e8f\u6392\u5e8f\uff0c\u5426\u5219\u964d\u5e8f\u6392\u5e8f\u3002   \n\u7136\u540e\u5efa\u4e00\u4e2a $vis$ \u6570\u7ec4\uff0c\u7edf\u8ba1\u79bb\u6563\u5316\u540e\u7684 $a$ \u4e2d\u6bcf\u4e2a\u6570\u51fa\u73b0\u7684\u6b21\u6570\uff0c\u518d\u5efa\u4e00\u4e2a $v$ \u6570\u7ec4\uff0c\u8bb0\u5f55\u4e00\u4e2a\u6570\u662f\u5426\u5bf9\u7b54\u6848\u6709\u8d21\u732e\uff0c\u6269\u5c55\uff08add\uff09\u7684\u65f6\u5019\u5c31  $vis_{a_i}+=1$ ,\u5982\u679c $vis_{a_i}=2$ \u90a3\u4e48\u66f4\u65b0\u7b54\u6848\u5e76\u4e14\u4f7f $v_{a_i}=1$,\u7136\u540e\u5982\u679c $vis_{a_i}>2$ \u5e76\u4e14 $v_{a_i}=1$\uff0c\u8fd9\u8bf4\u660e\u5b83\u5df2\u7ecf\u5bf9\u7b54\u6848\u6709\u8fc7\u8d21\u732e\uff0c\u4f46\u73b0\u5728\u5b83\u5bf9\u7b54\u6848\u6ca1\u6709\u8d21\u732e\u4e86\uff0c\u90a3\u4e48 $v_{a_i}=0$, \u540c\u65f6\u66f4\u65b0\u7b54\u6848\uff0c\u5982\u679c\u4e4b\u524d\u5bf9\u7b54\u6848\u5c31\u6ca1\u6709\u8d21\u732e\uff0c\u90a3\u4e48\u65e0\u9700\u66f4\u6539\u7b54\u6848\u3002  \n\u5220\u9664(del) \u4e5f\u662f\u57fa\u672c\u4e00\u6837\u7684\uff0c\u628a\u521a\u624d\u7684 $vis_{a_i}>2$ \u6362\u6210 $vis_{a_i}<2$ \u5c31\u597d\u4e86\uff0c\u5177\u4f53\u5199\u6cd5\u53ef\u4ee5\u53c2\u8003\u4e0b\u9762\u7684\u4ee3\u7801\u3002\n## Code\n\u81ea\u6211\u611f\u89c9\u5f88\u80fd\u538b\u884c\uff08\u5e76\u4e14\u81ea\u5df1\u8fd8\u80fd\u770b\u61c2\uff09\uff0c~~\u4f46\u662f\u6559\u7ec3\u8ba4\u4e3a\u6211\u7684\u7801\u98ce\u5f88\u795e\u5947~~\u3002\n```c\n#include <bits/stdc++.h>\nusing namespace std;\n#define ll int\n#define rint register int\n#define pc(x) putchar(x)\n#define gc getchar\nll a[500001],b[500001],c[500001],fi[1000],se[1000],pos[500001],vis[500001],ans,d[500001];//b\uff0cc\u7528\u4e8e\u8f85\u52a9\u79bb\u6563\u5316\u548c\u53bb\u91cd\uff0cvis\u4e3a\u7edf\u8ba1\u6570\u7ec4\u3002\nbool v[500001];//\u6807\u8bb0\u6570\u7ec4\u3002\ninline ll read(){\n\tll x=0;\n\tchar ch=gc();\n\twhile(!isdigit(ch)) ch=gc();\n\twhile(isdigit(ch)) x=x*10+ch-48,ch=gc();\n\treturn x;\n}\ninline void write(ll x){\n\tif(x>9) write(x/10);\n\tpc('0'+x%10);\n}\nstruct query{\n\tll l,r,id;\n}q[500001];\ninline bool cmp(query a,query b){\n\tif(pos[a.l]^pos[b.l]) return a.l<b.l;//\u5982\u679c\u6240\u5728\u7684\u5757\u4e0d\u4e00\u6837\u5c31\u6309\u5757\u7684\u7f16\u53f7\u5347\u5e8f\u6392\uff0c\u6211\u8fd9\u4e2a\u5199\u6cd5\u662f\u4e00\u6837\u7684\uff0c\u5757\u7684\u7f16\u53f7\u5927\u4e86\u81ea\u7136\u5de6\u7aef\u70b9\u4e5f\u5927\u4e86\n\treturn (pos[a.l]&1)?a.r<b.r:a.r>b.r;//\u5426\u5219\u6309\u5947\u5076\u6027\u6392\u5e8f\uff0c\u5757\u7684\u7f16\u53f7\u4e3a\u5947\u6570\u5219\u6309\u53f3\u7aef\u70b9\u5347\u5e8f\u6392\uff0c\u5426\u5219\u6309\u53f3\u7aef\u70b9\u964d\u5e8f\u6392\n}//\u6392\u5e8f\u3002\ninline void add(ll col){\n\t++vis[col];//\u66f4\u65b0\u7edf\u8ba1\u6570\u7ec4vis\n\tif(vis[col]==2) ++ans,v[col]=1;//\u5982\u679c\u51fa\u73b0\u6b21\u6570\u6070\u597d\u4e3a2\u5219\u66f4\u65b0\u7b54\u6848\uff0c\u5e76\u5728\u6807\u8bb0\u6570\u7ec4\u91cc\u628a\u8be5\u6570\u6807\u8bb0\u4e3a1\uff0c\u4ee3\u8868\u8fd9\u4e2a\u6570\u5bf9\u7b54\u6848\u5df2\u7ecf\u6709\u8d21\u732e\n\tif(vis[col]>2&&v[col]) --ans,v[col]=0;//\u4e4b\u524d\u6709\u8d21\u732e\u5e76\u4e14\u51fa\u73b0\u6b21\u6570\u5927\u4e8e2\u5219\u6e05\u96f6\uff0c\u4e24\u4e2a\u6761\u4ef6\u7f3a\u4e00\u4e0d\u53ef\u3002\n}//\u6269\u5c55\u3002\ninline void del(ll col){\n\t--vis[col];\n\tif(vis[col]==2) ++ans,v[col]=1;\n\tif(vis[col]<2&&v[col]) --ans,v[col]=0;\n}//\u5220\u9664\uff0c\u57fa\u672c\u540c\u6269\u5c55\u3002\nint main(){\n\tll n=read(),m=read(),cnt=0,len=sqrt(n),num=n/len;//\u521d\u59cb\u5316\u5757\u957f\uff0c\u5757\u6570\u3002\n\tfor(rint i=1;i<=num;i++) fi[i]=se[i-1]+1,se[i]=se[i-1]+len;//\u521d\u59cb\u5316\u5757\u7684\u5de6\u53f3\u7aef\u70b9\u6570\u7ec4\uff0cfi\u4e3a\u5de6\u7aef\u70b9\u6570\u7ec4\uff0cse\u4e3a\u53f3\u7aef\u70b9\u6570\u7ec4\u3002\n\tif(se[num]^n) ++num,fi[num]=se[num-1]+1,se[num]=n;//\u5982\u679c\u6700\u540e\u4e00\u4e2a\u5757\u7684\u53f3\u7aef\u70b9\u6ca1\u6709\u5230n\uff0c\u90a3\u4e48\u5c31\u8981\u65b0\u5f00\u4e00\u4e2a\u5757\uff0c\u5de6\u7aef\u70b9\u4e3a\u4e0a\u4e00\u4e2a\u5757\u53f3\u7aef\u70b9\u7684\u4e0b\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u53f3\u7aef\u70b9\u5c31\u662fn\u3002\n\tfor(rint i=1;i<=num;i++){\n\t\tll li=fi[i],ri=se[i];\n\t\tfor(rint j=li;j<=ri;j++) a[j]=read(),pos[j]=i,b[j]=a[j];//\u8bfb\u5165\uff0c\u521d\u59cb\u5316\u6bcf\u4e2a\u4f4d\u7f6e\u6240\u5728\u7684\u5757\u7684\u7f16\u53f7\uff08pos\u6570\u7ec4\uff09\uff0c\u540c\u65f6\u590d\u5236\u4e00\u4efd\u539f\u6570\u7ec4\u3002\n\t}sort(b+1,b+n+1);//\u6392\u5e8f\n\tfor(rint i=1;i<=n;i++) if(b[i]!=b[i-1]) c[++cnt]=b[i];//\u53bb\u91cd\n\tfor(rint i=1;i<=n;i++) a[i]=lower_bound(c+1,c+cnt+1,a[i])-c;//\u79bb\u6563\u5316\n\tfor(rint i=1;i<=m;i++) q[i].l=read(),q[i].r=read(),q[i].id=i;//\u8bfb\u5165\u8be2\u95ee\n\tsort(q+1,q+m+1,cmp);\n\tll lal=q[1].l,lar=q[1].r;//lal\u4e3a\u4e0a\u4e00\u6b21\u8be2\u95ee\u7684\u5de6\u7aef\u70b9\uff0clar\u4e3a\u4e0a\u4e00\u6b21\u8be2\u95ee\u7684\u53f3\u7aef\u70b9\uff0c\u56e0\u4e3a\u7b2c\u4e00\u4e2a\u8be2\u95ee\u8981\u66b4\u529b\u5730\u53bb\u7edf\u8ba1\uff0c\u6240\u4ee5\u76f4\u63a5\u521d\u59cb\u5316\u4e3a\u7b2c\u4e00\u4e2a\u8be2\u95ee\u7684\u5de6\u53f3\u7aef\u70b9\n\tfor(rint i=lal;i<=lar;i++) add(a[i]);//\u7edf\u8ba1\n\td[q[1].id]=ans;//\u5b58\u4e0b\u7b54\u6848\n\tfor(rint i=2;i<=m;i++){\n\t\tll le=q[i].l,ri=q[i].r;\n\t\twhile(lal>le) add(a[--lal]);//\u5f53\u524d\u5de6\u7aef\u70b9\u5c0f\u4e8e\u4e0a\u4e00\u6b21\u7684\u5de6\u7aef\u70b9\u5219\u6269\u5c55\n\t\twhile(lar<ri) add(a[++lar]);//\u5f53\u524d\u53f3\u7aef\u70b9\u5927\u4e8e\u4e0a\u4e00\u6b21\u7684\u53f3\u7aef\u70b9\u5219\u6269\u5c55\n\t\twhile(lal<le) del(a[lal++]);//\u5f53\u524d\u5de6\u7aef\u70b9\u5927\u4e8e\u4e0a\u4e00\u6b21\u7684\u5de6\u7aef\u70b9\u5219\u5220\u9664\n\t\twhile(lar>ri) del(a[lar--]);//\u5f53\u524d\u53f3\u7aef\u70b9\u5c0f\u4e8e\u4e0a\u4e00\u6b21\u7684\u53f3\u7aef\u70b9\u5219\u5220\u9664\n\t\td[q[i].id]=ans;//\u5b58\u7b54\u6848\n\t}for(rint i=1;i<=m;i++) write(d[i]),pc('\\n');//\u8f93\u51fa\n\treturn 0;\n}\n```",
        "postTime": 1638603307,
        "uid": 438168,
        "name": "OldVagrant",
        "ccfLevel": 6,
        "title": "P7764"
    },
    {
        "content": "\u672c\u9898\u8ddf[P1494](https://www.luogu.com.cn/problem/P1494)\u4e00\u6837\uff0c\u90fd\u53ef\u4ee5\u4f5c\u4e3a\u83ab\u961f\u7684\u6a21\u677f\u9898\u6765\u7ec3\u4e60\u3002\n\n----\n\n\u672c\u9898\u76f4\u63a5\u53ef\u4ee5\u7528\u83ab\u961f\u786c\u4e0a\u3002\n\n\u8f6c\u79fb\u7684\u65f6\u5019\u4e0d\u7528\u8bb2\u4e86\uff0c\u6211\u4e3b\u8981\u662f\u8bb2\u5728\u8f6c\u79fb\u65f6\u5982\u4f55\u589e\u52a0\u51cf\u5c11\u7b54\u6848\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5efa\u4e00\u4e2a\u6876\uff0c\u6765\u5b58\u50a8\u6bcf\u4e2a\u6570\u51fa\u73b0\u7684\u6b21\u6570\u3002\n\n- \u589e\u52a0\u7b54\u6848\u65f6\uff1a\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u9898\u76ee\u662f\u8981\u6c42\u533a\u95f4\u6070\u597d\u51fa\u73b0\u4e24\u6b21\u7684\u81ea\u7136\u6570\u7684\u6570\u91cf\u3002\u5982\u679c\u52a0\u4e0a\u8fd9\u4e2a\u6570\u540e\uff0c\u8fd9\u4e2a\u6570\u51fa\u73b0\u4e86 2 \u6b21\uff0c\u90a3\u4e48\u76f4\u63a5\u589e\u52a0\u7b54\u6848\u3002\u5982\u679c\u52a0\u4e0a\u8fd9\u4e2a\u6570\u540e\uff0c\u8fd9\u4e2a\u6570\u51fa\u73b0\u4e86 3 \u6b21\uff0c\u8bf4\u660e\u5b83\u662f\u7531 2 \u6b21\u8f6c\u79fb\u8fc7\u6765\u7684\uff0c\u5c31\u76f4\u63a5\u8ba9\u7b54\u6848\u51cf\u4e00\u3002\n\n- \u51cf\u5c11\u7b54\u6848\u65f6\uff1a\n\n\u5982\u679c\u51cf\u53bb\u8fd9\u4e2a\u6570\u540e\uff0c\u8fd9\u4e2a\u6570\u51fa\u73b0\u4e86 2 \u6b21\uff0c\u5c31\u76f4\u63a5\u589e\u52a0\u7b54\u6848\uff1b\u82e5\u51fa\u73b0\u4e86 1 \u6b21\uff0c\u8bf4\u660e\u5b83\u662f\u7531 2 \u6b21\u8f6c\u79fb\u8fc7\u6765\u7684\uff0c\u5c31\u76f4\u63a5\u8ba9\u7b54\u6848\u51cf\u4e00\u3002\n\n-----\n\n\u987a\u4fbf\u8bf4\u4e00\u4e0b\uff0c\u6570\u7ec4\u5185\u6bcf\u4e2a\u6570\u90fd\u5341\u5206\u5927\uff0c\u800c\u6570\u7ec4\u957f\u5ea6\u53c8\u4e0e\u5143\u7d20\u5927\u5c0f\u4e4b\u5dee\u5341\u5206\u5927\uff0c\u6240\u4ee5\u6211\u4eec\u505a\u4e4b\u524d\u8fd8\u8981\u6ce8\u610f\u79bb\u6563\u5316\uff0c\u907f\u514d\u6876\u70b8\u6389\u3002\n\n----\n\n\u4e0b\u9762\u662f\u559c\u95fb\u4e50\u89c1\u7684\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define inf 0x3f3f3f3f\n//#define LL_inf 1145141919810\n#define ull unsigned long long\n#define ll long long\nusing namespace std;\nconst int Maxn=5e5+10;\nint tong[Maxn];\nint res=0;\nvoid add(int x)\n{ \n\ttong[x]++;\n//\tcout<<\"add\\n x=\"<<x<<\",tong[x]=\"<<tong[x]<<endl;\n\tif(tong[x]==2)\n\t{\n\t\tres++;\n\t}\n\tif(tong[x]==3)\n\t{\n\t\tres--;\n\t}\n}\nvoid del(int x)\n{\n\ttong[x]--;\n//\tcout<<\"del:\\n x=\"<<x<<\",tong[x]=\"<<tong[x]<<endl;\n\tif(tong[x]==2)\n\t{\n\t\tres++;\n\t}\n\tif(tong[x]==1)\n\t{\n\t\tres--;\n\t}\n}\nstruct Query{\n\tint l,r;\n\tint id;\n}Q[Maxn];\nint ans[Maxn];\nint block,belong[Maxn];\nint n,q,Ar[Maxn];\nbool cmp(Query a,Query b)\n{\n\tif(belong[a.l]!=belong[b.l])\n\t{\n\t\treturn belong[a.l]<belong[b.l];\n\t}\n\tif(belong[a.l]&1)\n\t{\n\t\treturn a.r>b.r;\n\t}\n\treturn a.r<b.r;\n}\nint Br[Maxn];\nint main()\n{\n\tscanf(\"%d%d\",&n,&q);\n\tblock=sqrt(n);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&Ar[i]);\n\t\tbelong[i]=(i-1)/block+1;\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tBr[i]=Ar[i];\n\t}\n\tsort(Br+1,Br+1+n);\n\tint newn=unique(Br+1,Br+1+n)-Br-1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tAr[i]=lower_bound(Br+1,Br+newn+1,Ar[i])-Br;\n\t}\n//\tputs(\"After lisanhua:\");\n//\tfor(int i=1;i<=n;i++)\n//\t{\n//\t\tprintf(\"%d \",Ar[i]);\n//\t}\n//\tputchar('\\n');\n\tfor(int i=1;i<=q;i++)\n\t{\n\t\tint l,r;\n\t\tscanf(\"%d%d\",&l,&r);\n\t\tQ[i].l=l,Q[i].r=r;\n\t\tQ[i].id=i;\n\t}\n\tsort(Q+1,Q+1+q,cmp);\n\tint l=1,r=0;\n\tfor(int i=1;i<=q;i++)\n\t{\n\t\twhile(Q[i].l<l)\n\t\t{\n\t\t\tadd(Ar[--l]);\n\t\t}\n\t\twhile(Q[i].l>l)\n\t\t{\n\t\t\tdel(Ar[l++]);\n\t\t}\n\t\twhile(Q[i].r<r)\n\t\t{\n\t\t\tdel(Ar[r--]);\n\t\t}\n\t\twhile(r<Q[i].r)\n\t\t{\n\t\t\tadd(Ar[++r]);\n\t\t}\n\t\tans[Q[i].id]=res;\n\t}\n\tfor(int i=1;i<=q;i++)\n\t{\n\t\tprintf(\"%d\\n\",ans[i]);\n\t}\n\treturn 0;\n}\n\n```\n\n\u5751\u70b9\u63d0\u9192\uff1a\n\n- \u83ab\u961f\u6392\u5e8f\u7684\u65f6\u5019\u8981\u4f7f\u7528\u5947\u5076\u6027\u6392\u5e8f\uff0c\u6765\u51cf\u5c11\u5e38\u6570\uff08\n\n\u8c22\u8c22\u5927\u5bb6\u89c2\u770b",
        "postTime": 1643007392,
        "uid": 358739,
        "name": "BFSDFS123",
        "ccfLevel": 0,
        "title": "P7764 \u9898\u89e3"
    },
    {
        "content": "# 0x00 \u524d\u7f6e\n\n\u524d\u7f6e\u77e5\u8bc6\uff1a\u83ab\u961f\uff0c\u79bb\u6563\u5316\uff08\u8fd9\u4e0d\u677f\u9898\uff1f\uff1f\uff1f\uff09\n\n# 0x01 \u79bb\u6563\u5316\n\n\u7531\u4e8e\u83ab\u961f\u9700\u8981\u6253\u4e00\u4e2a\u6876\uff0c\u4f46\u662f\u7531\u4e8e\u6570\u636e $10^9$ \u8fc7\u5927\u56e0\u6b64\u6211\u4eec\u9700\u8981\u79bb\u6563\u5316\uff0c\u4f7f\u7528\u5e93\u51fd\u6570\u5c31\u597d\u4e86\n\n# 0x02 \u83ab\u961f\n\n\u677f\u5b50\u81ea\u5df1\u53bb\u770b\u4f8b\u9898\uff0c\u8bb2\u4e00\u4e0b\u7ec6\u8282\uff0c\u56e0\u4e3a\u5fc5\u987b\u6070\u597d\u51fa\u73b0\u4e24\u6b21\uff0c\u56e0\u6b64\u4e00\u6b21\u548c\u4e09\u6b21\u90fd\u4e0d\u884c\u3002\n\n\u5f53\u5220\u9664\u65f6\uff0c\u5220\u5b8c\u540e\u4e3a\u4e8c\uff0c\u7b54\u6848\u52a0\u4e00\uff0c\u5220\u5b8c\u540e\u4e3a\u4e00\uff0c\u7b54\u6848\u51cf\u4e00\u3002\n\n\u5f53\u6dfb\u52a0\u65f6\uff0c\u6dfb\u52a0\u540e\u4e3a\u4e8c\uff0c\u7b54\u6848\u52a0\u4e00\uff0c\u6dfb\u52a0\u540e\u4e3a\u4e09\uff0c\u7b54\u6848\u51cf\u4e00\u3002\n\n# 0x03 \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=5e5+5;\nint n,m;\nint len,a[N],id[N],ans[N],res,d[N];\nstruct Q{\n\tint l,r,k;\n}q[N];\nstruct node{\n\tint id,val;\n}b[N];\nbool cmp(Q x,Q y){\n\treturn id[x.l]==id[y.l]?x.r<y.r:id[x.l]<id[y.l];\n}\nbool x(node x,node y){\n\treturn x.val<y.val;\n}\nvoid add(int p){\n\td[p]++;\n\tif(d[p]==2) res++;\n\tif(d[p]==3) res--;\n}\nvoid sub(int p){\n\td[p]--;\n\tif(d[p]==1) res--;\n\tif(d[p]==2) res++;\n}\nint main(){\n\tscanf(\"%d %d\",&n,&m);\n\tlen=sqrt(n);\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&a[i]),b[i].val=a[i],b[i].id=i,id[i]=(i+1)/len;\n\tsort(b+1,b+1+n,x);\n\tint c[N];\n\tfor(int i=1;i<=n;i++) c[i]=b[i].val;\n\tfor(int i=1;i<=n;i++) a[b[i].id]=lower_bound(c+1,c+1+n,c[i])-c;\n\tfor(int i=1;i<=m;i++) scanf(\"%d %d\",&q[i].l,&q[i].r),q[i].k=i;\n\tsort(q+1,q+1+m,cmp);\n\tint l=1,r=0;\n\tfor(int i=1;i<=m;i++){\n\t\twhile(q[i].l<l) add(a[--l]);\n\t\twhile(q[i].l>l) sub(a[l++]);\n\t\twhile(q[i].r<r) sub(a[r--]);\n\t\twhile(q[i].r>r) add(a[++r]);\n\t\tans[q[i].k]=res;\n\t}\n\tfor(int i=1;i<=m;i++) printf(\"%d\\n\",ans[i]);\n\treturn 0;\n} \n```",
        "postTime": 1637731760,
        "uid": 364122,
        "name": "BigJoker",
        "ccfLevel": 6,
        "title": "P7764 [COCI2016-2017#5] Poklon-\u9898\u89e3\u62a5\u544a"
    },
    {
        "content": "## Luogu P7764 \u9898\u89e3\n## Description\n\u7ed9\u51fa\u957f\u4e3a $N$ \u7684\u6b63\u6574\u6570\u5e8f\u5217 $a$\uff0c\u6bcf\u6b21\u6307\u5b9a\u533a\u95f4 $[l,r]$ \uff0c\u67e5\u8be2 $a_l$ \u5230 $a_r$ \u4e2d\u51fa\u73b0\u6b21\u6570\u7b49\u4e8e $2$ \u7684\u6570\u5b57\u4e2a\u6570\n## Solution\n\u6734\u7d20\u83ab\u961f\uff08\u83ab\u961f\u4e0d\u4f1a\u770b[\u8fd9\u91cc](https://blog.csdn.net/weixin_45697774/article/details/110006549?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162782411116780357268716%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=162782411116780357268716&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-110006549.first_rank_v2_pc_rank_v29&utm_term=%E8%8E%AB%E9%98%9F&spm=1018.2226.3001.4187)\uff09\uff0c\u5c06 $a$ \u5e8f\u5217\u79bb\u6563\u5316\u540e\u5f00\u6876\u50a8\u5b58\u5f53\u524d\u72b6\u6001\uff0c\u518d\u7ef4\u62a4\u51fa\u73b0\u6b21\u6570\u4e3a $2$ \u7684\u6570\u7684\u4e2a\u6570 $ans$\uff0c\u5728\u6b64\u7ed9\u51fa\u63d2\u5165\u5220\u9664\u64cd\u4f5c\u7684\u4ee3\u7801\uff1a\n\n\u63d2\u5165\uff1a\u6876\u5185\u8ba1\u6570\u81ea\u589e\uff0c\u5bf9\u63d2\u5165\u6570\u51fa\u73b0\u6b21\u6570\u8fdb\u884c\u5206\u7c7b\u8ba8\u8bba\u3002\n\u5220\u9664\uff1a\u6876\u5185\u8ba1\u6570\u81ea\u51cf\uff0c\u5bf9\u63d2\u5165\u6570\u51fa\u73b0\u6b21\u6570\u8fdb\u884c\u5206\u7c7b\u8ba8\u8bba\u3002\n```cpp\nvoid add(int x)\n{\n\tint t=m[a[x]];\n\tblk[t]++;\n\tif(blk[t]==3) ans--;//\u73b0\u5728\u4e3a3\uff0c\u4e4b\u524d\u4e3a2\uff0c2\u51fa\u73b0\u6b21\u6570\u51cf\u5c11\n\telse if(blk[t]==2) ans++;//\u73b0\u5728\u53d8\u4e3a2\uff0c2\u51fa\u73b0\u6b21\u6570\u589e\u591a \n}\nvoid del(int x)\n{\n\tint t=m[a[x]];\n\tblk[t]--;\n\tif(blk[t]==1) ans--;\n\telse if(blk[t]==2) ans++;//\u540c\u4e0a \n}\n```\n\n\u6734\u7d20\u83ab\u961f\u90e8\u5206\u6211\u5c31\u4e0d\u8be6\u5199\u4e86\uff0c\u4e0e\u6a21\u677f\u662f\u4e00\u6a21\u4e00\u6837\u7684\u3002",
        "postTime": 1627824257,
        "uid": 486187,
        "name": "2000VOLT",
        "ccfLevel": 0,
        "title": "Luogu P7764 \u9898\u89e3"
    },
    {
        "content": "# P7764 \u9898\u89e3\n\n\u673a\u623f\u5927\u4f6c\u90fd\u968f\u4fbf\u8fc7\u4e86\u8fd9\u9898\uff0c\u6211\u5374\u51a5\u601d\u82e6\u60f3\u4e86\u534a\u5929\u3002\n\n## \u9898\u610f\n\n\u5c31\u662f\u8bf4\u5bf9\u4e8e\u6bcf\u4e2a\u533a\u95f4 $[L,R]$\uff0c\u6211\u4eec\u9700\u8981\u627e\u5230\u6709\u591a\u5c11\u6570\u53ea\u51fa\u73b0\u4e24\u6b21\u3002\n\n## \u5206\u6790\n\n\u663e\u7136\uff0c\u6211\u4eec\u80af\u5b9a\u9700\u8981\u524d\u7f00\u548c\u6216\u533a\u95f4\u548c\u6765\u8fdb\u884c\u4f18\u5316\u3002\uff08\u6216\u8005\u7528[\u83ab\u961f](https://oi-wiki.org/misc/mo-algo-intro/)\uff09\n\n\uff08\u5173\u4e8e\u83ab\u961f\u7b97\u6cd5\uff0c\u53ef\u4ee5\u770b\u770b\u53e6\u4e00\u4f4d\u5927\u4f6c\u7684\u9898\u89e3\uff09\n\n## 40 \u5206\u505a\u6cd5\n\n\u53ef\u4ee5\u7528\u6570\u7ec4 $cs_{i,j}$ \u6765\u8868\u793a\u7b2c $i$ \u4f4d\u524d\u7684\u6570\u5b57 $j$ \u51fa\u73b0\u4e86\u591a\u5c11\u6b21\uff0c\u518d\u5728\u67e5\u8be2\u65f6\u7528 $O(n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u679a\u4e3e $j$\uff0c\u7b54\u6848\u76f4\u63a5\u7531\u524d\u7f00\u548c\u76f8\u51cf\u5224\u5b9a\u5373\u53ef\u3002\u603b\u65f6\u95f4\u548c\u7a7a\u95f4\u590d\u6742\u5ea6\u5747\u4e3a $O(n^2)$\u3002\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nstruct node{\n\tint num;\n\tint i;\n}a[5005];\nint n,tot,Q,l,r,ans;\nint aa[5005];\nint cs[5005][5005];\nbool cmp(node x,node y){return x.num<y.num;}\nint main()\n{\n\tcin>>n>>Q;\n\tfor(int i=1;i<=n;i++) cin>>a[i].num,a[i].i=i;\n\tsort(a+1,a+n+1,cmp);\n\taa[a[1].i]=1;tot=1;\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tif(a[i].num!=a[i-1].num) tot++;\n\t\taa[a[i].i]=tot;\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=tot;j++)\n\t\t\tcs[i][j]=cs[i-1][j];\n\t\tcs[i][aa[i]]++;\n\t}\n\twhile(Q--)\n\t{\n\t\tcin>>l>>r;ans=0;\n\t\tfor(int i=1;i<=tot;i++)\n\t\t\tif(cs[r][i]-cs[l-1][i]==2) ans++;\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}\n\n```\n## \u6ee1\u5206\u7b97\u6cd5\n\n\uff08\u8fd9\u91cc\u8ba8\u8bba\u7684\u662f\u5728\u4e00\u79d2\u65f6\u9650\u4e0b\u7684\u505a\u6cd5\uff0c\u7528\u7684\u662f\u524d\u7f00\u548c\uff09\n\n\u5bf9\u4e8e\u5728\u7ebf\u7b97\u6cd5\uff0c\u60f3\u8981\u76f4\u63a5\u8ba1\u7b97\u96be\u5ea6\u662f\u5f88\u5927\u7684\uff08\u4f46\u53ef\u4ee5\u8003\u8651\uff09\uff0c\u56e0\u6b64\u6211\u4eec\u9009\u62e9\u4e00\u79cd\u79bb\u7ebf\u7b97\u6cd5\u3002\u9996\u5148\uff0c\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee $q_i$\uff0c\u5c1d\u8bd5\u628a\u8fd9\u4e9b\u8be2\u95ee\u6309\u5de6\u7aef\u70b9\u4ece\u5c0f\u5230\u5927\u7684\u987a\u5e8f\u6392\u597d\u3002\u7136\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u5904\u7406\u51fa $a_1$ \u81f3 $a_n$ \u5185\u7b26\u5408\u9898\u610f\u7684\u81ea\u7136\u6570\u4e2a\u6570\uff0c\u518d\u4f9d\u6b21\u5904\u7406\u8be2\u95ee\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\uff0c\u5c06\u5b83\u7684\u5de6\u7aef\u70b9\u4e0e\u524d\u4e00\u4e2a\u8be2\u95ee\u7684\u5de6\u7aef\u70b9\u5f62\u6210\u7684\u533a\u95f4\u4e2d\u6bcf\u4e2a\u5143\u7d20\u505a\u5220\u9664\u5904\u7406\uff0c\u6700\u540e\u5bf9\u5f53\u524d\u8be2\u95ee\u7684\u53f3\u7aef\u70b9\u6c42\u4e00\u6b21\u524d\u7f00\u548c\u5373\u53ef\u3002\n\n\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c\u8fd9\u4e2a\u524d\u7f00\u548c\u5230\u5e95\u8be5\u600e\u4e48\u7ef4\u62a4\uff1f\u8003\u8651\u5bf9\u76ee\u524d\u533a\u95f4\u5185\u7684\u67d0\u4e2a\u5143\u7d20 $i$ \u7684\u4e0b\u4e00\u4e2a\u4e0e\u5b83\u76f8\u540c\u7684\u5143\u7d20\u5904\u52a0 1\uff0c\u5bf9\u4e0b\u4e0b\u4e2a\u76f8\u540c\u5143\u7d20\u51cf 1\uff0c\u5c31\u80fd\u5229\u7528\u7c7b\u4f3c\u5dee\u5206\u7684\u601d\u60f3\u7ef4\u62a4\u4e00\u4e2a\u6700\u7ec8\u7b54\u6848\u7684\u524d\u7f00\u6570\u7ec4\u3002\u8fd9\u91cc\u7528\u7684\u662f\u6811\u72b6\u6570\u7ec4\u3002\n\n\u7279\u522b\u6ce8\u610f\uff0c\u4e0a\u8ff0\u5220\u9664\u6216\u6dfb\u52a0\u64cd\u4f5c\u5fc5\u987b\u5bf9\u5f53\u524d\u533a\u95f4\u4e2d\u9996\u6b21\u51fa\u73b0\u7684\u5143\u7d20\u4f7f\u7528\u3002\n\n\u7531\u4e8e\u6bcf\u4e2a\u5143\u7d20\u6700\u591a\u53ea\u4f1a\u88ab\u904d\u5386\u4e09\u6b21\uff0c\u6574\u4f53\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\log n)$ \n\n```\n#include<bits/stdc++.h>\nusing namespace std;\n\nstruct node{\n\tint l,r,i;\n\tint ans;\n}q[500005];//\u8be2\u95ee \nstruct node2{\n\tint i;\n\tint num;\n}a[500005];//\u79bb\u6563\n\nint n,Q,tot,lstl;\nint nxtpos[500005];//\u4e0b\u4e00\u4e2a\u76f8\u540c\u6570\u5b57\u7684\u4f4d\u7f6e \nint tree[500005];//\u6811\u72b6\u6570\u7ec4 \nint pos[500005];//\u79bb\u6563\u540e\u6570\u7ec4 \nint po[500005];//\u67d0\u6570\u6700\u540e\u51fa\u73b0\u7684\u4f4d\u7f6e \nbool p[500005];//\u67d0\u6570\u662f\u5426\u662f\u8d77\u70b9 \n\nbool cmp(node x,node y){return x.l<y.l;}\nbool cmp2(node2 x,node2 y){return x.num<y.num;}\nbool cmp3(node x,node y){return x.i<y.i;}\n\nint lowbit(int x){return x&-x;}\nvoid add(int x,int y) {while(x<=n){tree[x]+=y;x+=lowbit(x);}}\nint find(int x){int s=0;while(x>=1){s+=tree[x];x-=lowbit(x);} return s;}\n\nvoid change(int x,int y)\n{\n\tint j=nxtpos[x];\n\tadd(j,y);\n\tadd(nxtpos[j],-y);\n}\nint main()\n{\n\tcin>>n>>Q;\n\tfor(int i=1;i<=n;i++) cin>>a[i].num,a[i].i=i;\n\tfor(int i=1;i<=Q;i++) cin>>q[i].l>>q[i].r,q[i].i=i;\n\t\n\tsort(a+1,a+n+1,cmp2);\n\tpos[a[1].i]=1;tot=1;po[1]=n+1;\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tif(a[i].num!=a[i-1].num) tot++;\n\t\tpos[a[i].i]=tot;\n\t\tpo[tot]=n+1;\n\t}//\u79bb\u6563 \n\n\tnxtpos[n+1]=n+1;\n\tfor(int i=n;i>=1;i--)\n\t{\n\t\tnxtpos[i]=po[pos[i]];\n\t\tpo[pos[i]]=i;\n\t}//\u6307\u9488\n\n\tsort(q+1,q+Q+1,cmp);\n\tfor(int i=1;i<=n;i++)\n\t\tif(po[pos[i]]==i)\n\t\t{p[i]=1;change(i,1);}\n\tlstl=1;\n\tfor(int i=1;i<=Q;i++)\n\t{\n\t\tfor(int j=lstl;j<q[i].l;j++)\n\t\t{\n\t\t\tif(!p[j]) continue;\n\t\t\tchange(j,-1);\n\t\t\tint z=nxtpos[j];\n\t\t\twhile(z<q[i].l) z=nxtpos[z];\n\t\t\tp[z]=1;\n\t\t\tchange(z,1);\n\t\t}\n\t\tq[i].ans=find(q[i].r);\n\t\tlstl=q[i].l;\n\t}//\u8ba1\u7b97 \n\t\n\tsort(q+1,q+Q+1,cmp3);\n\tfor(int i=1;i<=Q;i++)\n\t\tcout<<q[i].ans<<endl; \n\treturn 0;\n}\n\n```\n\n\u7a0d\u5fae\u6539\u4e0b\u8f93\u5165\u8f93\u51fa\u5c31\u53ef\u4ee5\u4e00\u79d2\u5185\u8fc7\u4e86\u3002\n\n## \u611f\u8c22\u89c2\u770b\uff01",
        "postTime": 1628482045,
        "uid": 230141,
        "name": "Figo17",
        "ccfLevel": 0,
        "title": "P7764 [COCI2016-2017#5] Poklon"
    }
]
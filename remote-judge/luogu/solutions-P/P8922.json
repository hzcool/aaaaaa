[
    {
        "content": "\u79f0\u4e00\u4e2a\u597d\u533a\u57df\u662f\u6781\u5927\u7684\u5f53\u4e14\u4ec5\u5f53\u5b83\u7684\u8fb9\u754c\u4e0a\u81f3\u5c11\u6709 $3$ \u4e2a\u70b9\u3002\u6709\u7ed3\u8bba\uff1a\u4e00\u5b9a\u5b58\u5728\u4e00\u7ec4\u6700\u4f18\u89e3\uff0c\u4f7f\u5f97\u5b83\u662f\u4e00\u4e2a\u6781\u5927\u597d\u533a\u57df\u3002\u4e0d\u59a8\u8bbe\u662f\u5de6\uff0c\u53f3\uff0c\u4e0b\u8fb9\u754c\u4e0a\u6709\u70b9\u3002\r\n\r\n\u679a\u4e3e\u4e0b\u8fb9\u754c\u4e0a\u7684\u70b9\uff0c\u6709\u7ed3\u8bba\uff1a\u6700\u591a\u53ea\u6709\u4e00\u4e2a\u5408\u6cd5\u7684\u6781\u5927\u597d\u533a\u57df\u3002\r\n\r\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u53ef\u80fd\u6210\u4e3a\u7b54\u6848\u7684\u6781\u5927\u597d\u533a\u57df\u53ea\u6709 $O(n)$ \u4e2a\u3002\r\n\r\n\u8003\u8651\u600e\u4e48\u627e\u5230\u4e00\u4e2a\u70b9 $(x,y)$ \u5bf9\u5e94\u7684\u6781\u5927\u597d\u533a\u57df\u3002\r\n\r\n\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u94a6\u5b9a\u8fd9\u4e2a\u533a\u57df\u7684\u8fb9\u957f $l$\uff0c\u5206\u522b\u627e\u5230\u5de6\u53f3\u4e24\u8fb9\u7b2c\u4e00\u4e2a\u7eb5\u5750\u6807\u5728 $(y,y+l)$ \u5185\u7684\u70b9\uff0c\u8bbe\u4e3a $(x_1,y_1),(x_2,y_2)$\u3002\r\n\r\n\u4e8c\u5206\u51fa\u6700\u5927\u7684 $l$ \u6ee1\u8db3 $x_2-x_1\\ge l$\u3002\u5982\u679c $x_2-x_1=l$ \u5219\u6211\u4eec\u5df2\u7ecf\u6c42\u51fa\u4e86\u6781\u5927\u597d\u533a\u57df\uff0c\u5426\u5219\u8981\u4e48\u4e0d\u5b58\u5728\u6781\u5927\u597d\u533a\u57df\uff0c\u8981\u4e48\u5b58\u5728\u4e00\u4e2a\u7eb5\u5750\u6807\u4e3a $y+l$ \u7684\u70b9\u5728\u6781\u5927\u597d\u533a\u57df\u7684\u89d2\u4e0a\uff0c\u627e\u5230\u8fd9\u4e2a\u70b9\u5373\u53ef\u6c42\u51fa\u6781\u5927\u597d\u533a\u57df\u3002\u53ef\u4ee5\u5728\u4e3b\u5e2d\u6811\u4e0a\u4e8c\u5206\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\r\n\r\n\u8fd9\u91cc\u6709\u4e00\u4e2a\u51cf\u5c0f\u5e38\u6570\u7684\u65b9\u6cd5\uff1a\u6ca1\u6709\u5fc5\u8981\u5bf9\u56db\u4e2a\u65b9\u5411\u5404\u505a\u4e00\u904d\uff0c\u53ea\u9700\u8981\u505a \u5de6\u53f3\u4e0a \u548c \u5de6\u53f3\u4e0b \u8fd9\u4e24\u79cd\u60c5\u51b5\u5373\u53ef\uff0c\u53ef\u4ee5\u8bc1\u660e\u8fd9\u6837\u4e0d\u4f1a\u6f0f\u6389\u4efb\u4f55\u6781\u5927\u597d\u533a\u57df\u3002\r\n\r\n\u6c42\u51fa\u8fd9 $O(n)$ \u4e2a\u6781\u5927\u597d\u533a\u57df\u4e4b\u540e\uff0c\u53ef\u4ee5\u8003\u8651\u7528\u626b\u63cf\u7ebf + \u7ebf\u6bb5\u6811\u6c42\u51fa\u7b54\u6848\u3002\u4e00\u822c\u7684\u505a\u6cd5\u662f\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9\u7ef4\u62a4\u4e00\u4e2a set\uff0c\u5176\u4e2d\u5305\u542b\u5f53\u524d\u8986\u76d6\u8fd9\u4e2a\u8282\u70b9\u7684\u6240\u6709\u6b63\u65b9\u5f62\u3002\u8fd9\u6837\u505a\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n\\log^2 n)$\u3002\r\n\r\n\u4f46\u5b9e\u9645\u4e0a\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u6b63\u65b9\u5f62\u7684\u6027\u8d28\u8fdb\u884c\u4f18\u5316\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9\uff0c\u5982\u679c\u5176\u4e2d\u6709\u4e24\u4e2a\u6b63\u65b9\u5f62 $S_1,S_2$ \u6ee1\u8db3 $|S_1|>|S_2|$ \u4e14 $S_1$ \u7684\u53f3\u8fb9\u754c\u5728 $S_2$ \u7684\u53f3\u8fb9\u754c\u7684\u53f3\u4fa7\uff0c\u90a3\u4e48\u663e\u7136 $S_2$ \u5c31\u6ca1\u7528\u4e86\u3002\r\n\r\n\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9\u7ef4\u62a4\u4e00\u4e2a deque\uff0c\u91cc\u9762\u5305\u542b\u5f53\u524d\u8986\u76d6\u8fd9\u4e2a\u8282\u70b9\u5e76\u4e14\u6709\u7528\u7684\u6b63\u65b9\u5f62\u3002\u8fd9\u4e2a deque \u4e2d\u7684\u6240\u6709\u6b63\u65b9\u5f62\u6ee1\u8db3\u8fb9\u957f\u5355\u8c03\u9012\u51cf\uff0c\u4e14\u53f3\u8fb9\u754c\u7684\u4f4d\u7f6e\u5355\u8c03\u9012\u589e\u3002\u52a0\u5165\u4e00\u4e2a\u65b0\u7684\u6b63\u65b9\u5f62\u65f6\u8fb9\u957f\u6bd4\u5b83\u5c0f\u7684\u6b63\u65b9\u5f62\u663e\u7136\u90fd\u6ca1\u7528\u4e86\uff0c\u76f4\u63a5\u4ece\u672b\u5c3e\u5f39\u51fa\u5373\u53ef\uff0c\u7136\u540e\u518d\u5224\u65ad\u5b83\u672c\u8eab\u662f\u5426\u6709\u7528\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u5747\u644a $O(n\\log n)$\u3002\r\n\r\n\u56e0\u6b64\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\log n)$\uff0c\u5e38\u6570\u5f88\u5927\u3002\r\n\r\n\u53c2\u8003\u4ee3\u7801\uff1a\r\n\r\n```cpp\r\n#include <bits/stdc++.h>\r\nusing namespace std;\r\n#define N 300005\r\n#define LIM 10000005\r\n#define mid ((l+r)/2)\r\n#define pb push_back\r\n#define po pop_back\r\n#define gc() (P1==P2 && (P2=(P1=buf)+fread(buf,1,LIM,stdin),P1==P2)?EOF:*P1++)\r\nconst int INF1=1e8,INF2=3e8,INF3=5e8;char buf[LIM],*P1=buf,*P2=buf;\r\nint n,m,dsX[N],dsY[N],X[N],Y[N],o[N],ans[N];struct Node {int x,w;};\r\nint tp;struct Sqr {int x,y,w;}z[N*4];vector<Sqr> vc[N];\r\nint cntS,rt1[N],rt2[N];struct Seg {int vl,ch[2];}sg[N*40];\r\nstruct Seg1 {int hd;vector<Node> vc;}sg1[N*4];\r\nbool cmp(Sqr x,Sqr y) {return x.x<y.x;}\r\nint rd()\r\n{\r\n\tint res=0;char c=0;while(!isdigit(c)) c=gc();\r\n\twhile(isdigit(c)) res=res*10+(c-48),c=gc();return res;\r\n}\r\nvoid upd(int p,int &p1,int l,int r,int x,int vl)\r\n{\r\n\tsg[p1=++cntS]=sg[p];sg[p1].vl=vl;if(l==r) return;\r\n\tif(x<=mid) upd(sg[p].ch[0],sg[p1].ch[0],l,mid,x,vl);\r\n\telse upd(sg[p].ch[1],sg[p1].ch[1],mid+1,r,x,vl);\r\n}\r\nint qry1(int p1,int p2,int l,int r,int x,int &vl1,int &vl2)\r\n{\r\n\tif(l>=x)\r\n\t{\r\n\t\tint t,t1=min(vl1,sg[p1].vl),t2=min(vl2,sg[p2].vl);\r\n\t\tif(dsY[r]-dsY[x]<t1+t2) {vl1=t1;vl2=t2;return -1;}if(l==r) return l;\r\n\t\tt=qry1(sg[p1].ch[0],sg[p2].ch[0],l,mid,x,vl1,vl2);if(~t) return t;\r\n\t\treturn qry1(sg[p1].ch[1],sg[p2].ch[1],mid+1,r,x,vl1,vl2);\r\n\t}int t=-1;if(x<=mid) t=qry1(sg[p1].ch[0],sg[p2].ch[0],l,mid,x,vl1,vl2);\r\n\tif(~t) return t;return qry1(sg[p1].ch[1],sg[p2].ch[1],mid+1,r,x,vl1,vl2); \r\n}\r\nint qry2(int p1,int p2,int l,int r,int x,int &vl1,int &vl2)\r\n{\r\n\tif(r<=x)\r\n\t{\r\n\t\tint t,t1=min(vl1,sg[p1].vl),t2=min(vl2,sg[p2].vl);\r\n\t\tif(dsY[x]-dsY[l]<t1+t2) {vl1=t1;vl2=t2;return -1;}if(l==r) return l;\r\n\t\tt=qry2(sg[p1].ch[1],sg[p2].ch[1],mid+1,r,x,vl1,vl2);if(~t) return t;\r\n\t\treturn qry2(sg[p1].ch[0],sg[p2].ch[0],l,mid,x,vl1,vl2);\r\n\t}int t=-1;if(x>mid) t=qry2(sg[p1].ch[1],sg[p2].ch[1],mid+1,r,x,vl1,vl2); \r\n\tif(~t) return t;return qry2(sg[p1].ch[0],sg[p2].ch[0],l,mid,x,vl1,vl2); \r\n}\r\nvoid upd1(int p,int l,int r,int qL,int qR,Node vl)\r\n{\r\n\tif(qL>qR) return;\r\n\tif(l>=qL && r<=qR)\r\n\t{\r\n\t\twhile(sg1[p].vc.size()>sg1[p].hd && vl.w>=(--sg1[p].vc.end())->w)\r\n\t\t\tsg1[p].vc.po();\r\n\t\tif(sg1[p].vc.size()<=sg1[p].hd || vl.x>(--sg1[p].vc.end())->x)\r\n\t\t\tsg1[p].vc.pb(vl);return;\r\n\t}if(qL<=mid) upd1(p*2,l,mid,qL,qR,vl);if(qR>mid) upd1(p*2+1,mid+1,r,qL,qR,vl);\r\n}\r\nint qry(int p,int l,int r,int x,int o)\r\n{\r\n\twhile(sg1[p].vc.size()>sg1[p].hd && sg1[p].vc[sg1[p].hd].x<o) ++sg1[p].hd;\r\n\tint t=0;if(sg1[p].vc.size()>sg1[p].hd) t=sg1[p].vc[sg1[p].hd].w;\r\n\tif(l==r) return t;if(x<=mid) return max(t,qry(p*2,l,mid,x,o));\r\n\treturn max(t,qry(p*2+1,mid+1,r,x,o));\r\n}\r\nint main()\r\n{\r\n\tn=rd();m=rd();sg[0].vl=INF2;dsX[0]=dsY[0]=-INF3;\r\n\tfor(int i=1;i<=n;++i) X[i]=rd(),Y[i]=rd(),dsX[i]=X[i],dsY[i]=Y[i];\r\n\tdsX[n+1]=dsY[n+1]=INF3;sort(dsX+1,dsX+n+1);sort(dsY+1,dsY+n+1);\r\n\tfor(int i=1;i<=n;++i)\r\n\t{\r\n\t\tX[i]=lower_bound(dsX+1,dsX+n+1,X[i])-dsX;\r\n\t\tY[i]=lower_bound(dsY+1,dsY+n+1,Y[i])-dsY;\t\r\n\t}for(int i=1;i<=n;++i) o[X[i]]=Y[i];\r\n\tupd(rt1[0],rt1[0],0,n+1,0,-INF2);upd(rt2[n+1],rt2[n+1],0,n+1,0,-INF2);\r\n\tupd(rt1[0],rt1[0],0,n+1,n+1,-INF2);upd(rt2[n+1],rt2[n+1],0,n+1,n+1,-INF2);\r\n\tfor(int i=1;i<=n;++i) upd(rt1[i-1],rt1[i],0,n+1,o[i],-dsX[i]);\r\n\tfor(int i=n;i;--i) upd(rt2[i+1],rt2[i],0,n+1,o[i],dsX[i]);\r\n\tfor(int i=1,vl1,vl2,t;i<=n;++i)\r\n\t{\r\n\t\tvl1=vl2=INF2;t=qry1(rt1[i-1],rt2[i+1],0,n+1,o[i],vl1,vl2);\r\n\t\tif(dsY[t]-dsY[o[i]]<vl1+vl2)\r\n\t\t{\r\n\t\t\tt=dsY[t]-dsY[o[i]];z[++tp]=(Sqr) {-vl1,dsY[o[i]],t};\r\n\t\t\tz[++tp]=(Sqr) {vl2-t,dsY[o[i]],t};\r\n\t\t}else z[++tp]=(Sqr) {-vl1,dsY[o[i]],vl1+vl2};\r\n\t\tvl1=vl2=INF2;t=qry2(rt1[i-1],rt2[i+1],0,n+1,o[i],vl1,vl2);\r\n\t\tif(dsY[o[i]]-dsY[t]<vl1+vl2)\r\n\t\t{\r\n\t\t\tt=dsY[o[i]]-dsY[t];z[++tp]=(Sqr) {-vl1,dsY[o[i]]-t,t};\r\n\t\t\tz[++tp]=(Sqr) {vl2-t,dsY[o[i]]-t,t};\r\n\t\t}else z[++tp]=(Sqr) {-vl1,dsY[o[i]]-vl1-vl2,vl1+vl2};\r\n\t}z[++tp]=(Sqr) {dsX[1]-INF2,-1,INF2};z[++tp]=(Sqr) {dsX[n],-1,INF2};\r\n\tfor(int i=1;i<=m;++i) X[i]=rd(),Y[i]=rd(),dsX[i]=X[i],dsY[i]=Y[i];\r\n\tsort(dsX+1,dsX+m+1);sort(dsY+1,dsY+m+1);\r\n\tfor(int i=1;i<=m;++i)\r\n\t{\r\n\t\tX[i]=lower_bound(dsX+1,dsX+m+1,X[i])-dsX;\r\n\t\tY[i]=lower_bound(dsY+1,dsY+m+1,Y[i])-dsY;\t\r\n\t}for(int i=1;i<=m;++i) o[X[i]]=Y[i];\r\n\tfor(int i=1,x;i<=tp;++i)\r\n\t\tx=upper_bound(dsX+1,dsX+m+1,z[i].x)-dsX,vc[x].pb(z[i]);\r\n\tfor(int i=1,l,r;i<=m;++i)\r\n\t{\r\n\t\tsort(vc[i].begin(),vc[i].end(),cmp);\r\n\t\tfor(auto j:vc[i])\r\n\t\t{\r\n\t\t\tl=upper_bound(dsY+1,dsY+m+1,j.y)-dsY;\r\n\t\t\tr=lower_bound(dsY+1,dsY+m+1,j.y+j.w)-dsY-1;\r\n\t\t\tupd1(1,1,m,l,r,(Node) {j.x+j.w-1,j.w});\r\n\t\t}ans[i]=qry(1,1,m,o[i],dsX[i]);if(ans[i]>INF1) ans[i]=-1;\r\n\t}for(int i=1;i<=m;++i) printf(\"%d\\n\",ans[X[i]]);return 0;\r\n}\r\n```",
        "postTime": 1672489676,
        "uid": 119621,
        "name": "Kubic",
        "ccfLevel": 10,
        "title": "P8923 \u300eMdOI R5\u300fSquares"
    }
]
[
    {
        "content": "\u4f60\u8c37\u7eff\u9898\u6050\u6016\u5982\u65af\u3002\u5efa\u8bae\u8bc4\u7d2b/\u9ed1\u3002\n\n\u6709\u7528\u7684\u4fe1\u606f\u5171\u6709\u4e24\u79cd\uff1a\u516c\u5e03\u7684\u201c\u67d0\u4e2a\u96c6\u5408\u91cc\u5b58\u5728\u67d0\u79cd\u6570\u5b57\u7684\u5361\u7247\u201d\u7684\u4fe1\u606f\u548c\u6bcf\u4e00\u56de\u5408\u558a\u51fa\u201cMeltdown\uff01\u201d\u7684\u4eba\u7684\u96c6\u5408\u3002\n\n\u7531\u4e8e $n$ \u5f88\u5c0f\uff0c\u8003\u8651\u72b6\u538b\uff0c\u4ee4 $f_{i,S}$ \u8868\u793a\u7b2c $i$ \u6b21\u516c\u5e03\u4fe1\u606f\u540e $S$ \u662f\u5426\u6ee1\u8db3\u6240\u6709\u5df2\u77e5\u7684\u4fe1\u606f\uff0c$g_{i,S}$ \u8868\u793a\u82e5\u5f53\u524d\u6240\u6709 $\\texttt{1}$ \u7684\u96c6\u5408\u4e3a $S$\uff0c\u5219\u7b2c $i$ \u6b21\u558a\u8bdd\u540e\u7b2c\u4e00\u6b21\u558a\u7684\u4eba\u7ec4\u6210\u7684\u96c6\u5408\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u96c6\u5408 $S$\uff0c\u51fa\u73b0\u4ee5\u4e0b\u4e24\u79cd\u60c5\u51b5\u65f6\u8be5\u96c6\u5408\u5373\u4e3a\u975e\u6cd5\uff1a\u4e0e\u516c\u5e03\u7684\u4fe1\u606f\u77db\u76fe\uff0c\u6216\u8005 $g_{i,S} \\neq g_{i,V}$\uff0c\u5176\u4e2d $V$ \u8868\u793a\u6240\u6709 $\\texttt{1}$ \u7684\u96c6\u5408\u3002\n\n\u5bf9\u4e8e $g_{i,S}$\uff0c\u6bcf\u6b21\u66b4\u529b\u679a\u4e3e\u6240\u6709\u4eba\uff0c\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u4eba\u5224\u65ad\u5728\u6240\u6709\u5408\u6cd5\u7684\u96c6\u5408\u4e2d\u662f\u5426\u5b58\u5728\u591a\u4e2a\u80fd\u63a8\u65ad\u51fa\u6765\u7684\u503c\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(2^n(nm+\\sum k))$\u3002\n\nCode:\n\n```cpp\nint n,q,m,S,ans[17],f[1<<16],g[1<<16],st[(1<<16)|1],vis[1<<16][2],t,tt,lt;\nint main()\n{\n\tn=rd();q=rd();for(int i=0;i<n;++i)S|=rd()<<i,ans[i]=-1;\n\tcst int lim=1<<n;for(int i=0;i<lim;++i)st[++t]=i,f[i]=1;\n\tfor(int ti=1;ti<=q;++ti)\n\t{\n\t\t//cerr<<t<<endl;for(int i=1;i<=tt;++i)cerr<<st[i]<<\" \\n\"[i==tt];\n\t\tm=rd();while(m --> 0)\n\t\t{\n\t\t\tint c=rd(),s=0;while(c --> 0)s|=1<<rd();\n\t\t\tint b=rd();if(vis[s][b])continue;\n\t\t\tvis[s][b]=1;tt=t;t=0;\n\t\t\tfor(int i=1;i<=tt;++i)if((st[i]&s)==(b?0:s))f[st[i]]=0;else st[++t]=st[i];\n\t\t}\n\t\tif(t==lt)continue;\n\t\t//cerr<<t<<endl;for(int i=1;i<=tt;++i)cerr<<st[i]<<\" \\n\"[i==tt];\n\t\tfor(int j=1,s;j<=t;++j)\n\t\t{\n\t\t\tg[s=st[j]]=0;assert(f[s]);\n\t\t\tfor(int i=0,posl=n-1,posr=1;i<n;++i,++posl,++posr)\n\t\t\t{\n\t\t\t\tif(~ans[i])continue;\n\t\t\t\tif(posl>=n)posl-=n;\n\t\t\t\tif(posr>=n)posr-=n;\n\t\t\t\tint s1=(s|(1<<posl))|(1<<posr),s2=(s|(1<<posl))&~(1<<posr),s3=(s&~(1<<posl))|(1<<posr),s4=(s&~(1<<posl))&~(1<<posr);\n\t\t\t\t//cerr<<ti<<' '<<s<<' '<<i<<' '<<((s>>i)&1)<<' '<<g[s]<<' '<<s1<<' '<<s2<<' '<<s3<<' '<<s4<<endl;\n\t\t\t\tif((s>>i)&1){if((((s>>posl)&1)^((s>>posr)&1))?!f[s1]&&!f[s4]:!f[s2]&&!f[s3])g[s]|=1<<i;}\n\t\t\t\telse{if((((s>>posl)&1)|((s>>posr)&1))?!f[s4]:!f[s1]&&!f[s2]&&!f[s3])g[s]|=1<<i;}\n\t\t\t\t//cerr<<ti<<' '<<s<<' '<<i<<' '<<((s>>i)&1)<<' '<<g[s]<<' '<<s1<<' '<<s2<<' '<<s3<<' '<<s4<<endl;\n\t\t\t}\n\t\t\t//cerr<<ti<<' '<<t<<' '<<j<<' '<<s<<' '<<g[s]<<endl;\n\t\t}\n\t\tlt=t;t=0;for(int j=1,s;j<=lt;++j){if(g[s=st[j]]^g[S])f[s]=0;else st[++t]=s;}\n\t\tfor(int i=0;i<n;++i)if(((g[S]>>i)&1)&&!~ans[i])ans[i]=ti;\n\t\t//cerr<<t<<endl;for(int i=1;i<=tt;++i)cerr<<st[i]<<\" \\n\"[i==tt];\n\t}\n\tfor(int i=0;i<n;++i)prt(ans[i],\" \\n\"[i==n-1]);\n\tret 0;\n}\n```",
        "postTime": 1668321524,
        "uid": 224991,
        "name": "Presentation_Emitter",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P7352 \u3010\u7089\u5fc3\u878d\u89e3\u3011"
    }
]
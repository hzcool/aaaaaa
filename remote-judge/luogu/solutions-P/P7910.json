[
    {
        "content": "### \u9898\u76ee\u7b80\u8ff0\n\u7ed9\u5b9a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217 $a_i$\u3002\u73b0\u5728\u8981\u7ef4\u62a4\u5355\u70b9\u4fee\u6539\u4e0e\u5192\u6ce1\u6392\u5e8f\u540e\u4e00\u5143\u7d20\u7684\u4e0b\u6807\u3002\n\n$n\\leq8000,q\\leq2\\times 10^5$\uff0c\u4fee\u6539\u64cd\u4f5c\u4e0d\u8d85\u8fc7 $5000$ \u6b21\u3002\n\n### \u89e3\u9898\u601d\u8def\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5df2\u7ecf\u6709\u5e8f\u7684\u6570\u5217\uff0c\u5355\u70b9\u4fee\u6539\u4e00\u4e2a\u503c\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u524d\u540e\u5192\u6ce1\u5404\u4e00\u6b21\u6765\u4fdd\u6301\u6709\u5e8f\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff1a\n\n\u539f\u5e8f\u5217\u4e3a $1,1,4,5,6,7$\uff0c\u4fee\u6539\u4e3a $1,1,9,5,6,7$\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u4ece\u524d\u5f80\u540e\u5192\u6ce1\uff0c\u518d\u6b21\u7ef4\u6301\u4e86\u6570\u5217\u7684\u6709\u5e8f\u3002\u8fd9\u6837\u7684\u64cd\u4f5c\u662f $\\mathcal{O}(n)$ \u7684\u3002\n\n\u540c\u6837\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u7ef4\u62a4\u4e00\u4e2a\u6709\u5e8f\u6570\u5217\uff0c\u5e76\u8bb0\u5f55\u539f\u4e0b\u6807\u4e0e\u5148\u4e0b\u6807\u4e4b\u95f4\u7684\u5173\u7cfb\uff08\u7528\u6570\u7ec4\u8bb0\u5f55\uff09\uff0c\u6bcf\u6b21\u4fee\u6539\u540e\u66f4\u65b0\u8fd9\u79cd\u5173\u7cfb\u3002\n\n\u8fd9\u6837\uff0c\u4fee\u6539\u64cd\u4f5c\u662f $\\mathcal{O}(n)$ \u7684\uff0c\u67e5\u8be2\u662f $\\mathcal{O}(1)$ \u7684\u3002\u5b8c\u7ed3\u6492\u82b1\u3002\n\n\u4e0b\u9762\u7ed9\u51fa\u8003\u573a\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\nconst int MAXN=8005;\nint n,q;\nint t[MAXN];\nstruct node{\n\tint pre,id;\n}a[MAXN];\nbool cmp(node x,node y){\n\tif(x.pre!=y.pre) return x.pre<y.pre;\n\treturn x.id<y.id;\n}//\u4e24\u4e2a\u5143\u7d20\u4e4b\u95f4\u7684\u4f18\u5148\u7ea7\nint main(){\n\t//freopen(\"sort.in\",\"r\",stdin);\n\t//freopen(\"sort.out\",\"w\",stdout);\n\tscanf(\"%d%d\",&n,&q); \n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%d\",&a[i].pre);\n\t\ta[i].id=i;\n\t}//\u8f93\u5165\n\tsort(a+1,a+n+1,cmp);//\u6392\u5e8f\n\tfor(int i=1;i<=n;i++)\n\t\tt[a[i].id]=i;\n\tfor(int i=1;i<=q;i++){\n\t\tint opt,x,v;\n\t\tscanf(\"%d\",&opt);\n\t\tif(opt==1){//\u5355\u70b9\u4fee\u6539\n\t\t\tscanf(\"%d%d\",&x,&v);//Ax->v\n\t\t\ta[t[x]].pre=v;\n\t\t\tfor(int j=n;j>=2;j--)\n\t\t\t\tif(cmp(a[j],a[j-1])){\n\t\t\t\t\tnode kkksc03=a[j];\n\t\t\t\t\ta[j]=a[j-1];\n\t\t\t\t\ta[j-1]=kkksc03;\n\t\t\t\t}//\u524d\u626b\n\t\t\tfor(int j=2;j<=n;j++)\n\t\t\t\tif(cmp(a[j],a[j-1])){\n\t\t\t\t\tnode kkksc03=a[j];\n\t\t\t\t\ta[j]=a[j-1];\n\t\t\t\t\ta[j-1]=kkksc03;\n\t\t\t\t}//\u540e\u626b\n\t\t\tfor(int i=1;i<=n;i++)\n\t\t\t\tt[a[i].id]=i;//\u66f4\u65b0\u5173\u7cfb\n\t\t}\n\t\telse{\n\t\t\tscanf(\"%d\",&x);\n\t\t\tprintf(\"%d\\n\",t[x]);\n\t\t}\n\t}\n\treturn 0;\n}\n```\nupdate 2021.11.7\n\n\u6700\u8fd1\u6709\u4e00\u4e9b\u5c0f\u670b\u53cb\u95ee\u6211\u4e3a\u4ec0\u4e48\u8981\u524d\u540e\u5404\u626b\u4e00\u6b21\u3002\n\n\u539f\u56e0\u662f\u66f4\u6539\u7684\u65f6\u5019\u53ea\u4fee\u6539\u4e86\u4e00\u4e2a\u5143\u7d20\uff0c\u6211\u4eec\u4e0d\u77e5\u9053\u4ed6\u662f\u6539\u5927\u4e86\u8fd8\u662f\u6539\u5c0f\u4e86\u3002\n\n\u4e3e\u4e2a\u6817\u5b50\uff0c\u6bd4\u5982\u539f\u5e8f\u5217\u662f $4,5,6$\u3002\n\n\u628a $5$ \u6539\u6210 $1$ \u5c31\u8981\u5f80\u524d\u626b\uff0c\u628a $5$ \u6539\u6210 $9$ \u5c31\u8981\u5f80\u540e\u626b\u3002",
        "postTime": 1635001183,
        "uid": 248400,
        "name": "Inaba_Meguru",
        "ccfLevel": 7,
        "title": "P7910 [CSP-J 2021] \u63d2\u5165\u6392\u5e8f\uff08\u6c11\u95f4\u6570\u636e\uff09 \u9898\u89e3"
    },
    {
        "content": "\u7531\u4e8e\u7ed9\u7684\u6761\u4ef6\u662f\u4fee\u6539\u6b21\u6570\u4e0d\u8d85\u8fc7 $5000$ \uff0c\u6211\u4eec\u5e94\u8be5\u5728\u4fee\u6539\u5904\u505a\u6587\u7ae0\u3002\n\n\u6ce8\u610f\u5230\u4e00\u4e2a\u6570\u7ec4 $a$ \u8fdb\u884c\u201c\u793a\u8303\u4ee3\u7801\u201d\u4e4b\u540e\uff0c\u6570 $a_i$ \u5728 $a_j$ \u4e4b\u524d\u7684\u5145\u8981\u6761\u4ef6\u662f\u4ee5\u4e0b\u4e24\u8005\u4e2d\u6210\u7acb\u4e00\u4e2a\uff1a\n\n1. $a_i<a_j$\n\n2. $a_i=a_j$ \u4e14 $i<j$\n\n\u8003\u8651\u7ef4\u62a4\u4e00\u4e2a\u6570\u7ec4 $b$ \u50a8\u5b58\u5404\u4e2a\u6570\u5728\u6570\u7ec4 $a$ \u4e2d\u7684\u76f8\u5bf9\u6392\u540d\uff0c\u90a3\u4e48\u5f00\u59cb\u8f93\u5165 $a$ \u65f6\u8fdb\u884c\u7edf\u8ba1\uff08\u7528\u4ee5\u4e0a\u4e24\u6761\u5224\u65ad\uff09\u4e4b\u540e\uff1a\n\n\u6bcf\u8fdb\u884c\u4e00\u6b21\u64cd\u4f5c 2 \uff0c\u8f93\u51fa $b_x$ \u3002\n\n\u6bcf\u8fdb\u884c\u4e00\u6b21\u64cd\u4f5c 1 \uff0c\u5373\u5c06 $a_x$ \u4fee\u6539\u6210 $v$ \u3002\u6b64\u65f6\u7528 $O(n)$ \u904d\u5386\u6570\u7ec4\u4e2d\u7684\u5404\u4e2a\u5143\u7d20\uff0c\u5982\u679c\u67d0\u4e00\u4e2a\u5143\u7d20 $i$ \u6ee1\u8db3\u5728\u6570\u7ec4\u63d2\u5165\u6392\u5e8f\u540e\u539f\u672c\u5728 $x$ \u4e4b\u524d\uff0c\u73b0\u5728\u5728 $x$ \u4e4b\u540e\uff08\u4ecd\u7136\u7528\u4e24\u6761\u5224\u5b9a\uff09\uff0c\u56e0\u4e3a $i$ \u4e0e\u6570\u7ec4\u4e2d\u5176\u4ed6\u6570\u7684\u76f8\u5bf9\u4f4d\u7f6e\u6ca1\u6709\u53d8\u5316\uff0c\u4f7f $b_i$ \u589e\u52a0\u4e00\uff0c $b_x$ \u51cf\u5c11\u4e00\u5373\u53ef\u3002\u53e6\u5916\u4e00\u79cd\u60c5\u51b5\u540c\u7406\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,q,a[8005],b[8005],num,x,v,ans;\nint main()\n{\n\tscanf(\"%d%d\",&n,&q);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&a[i]);\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=i;j++)\n\t\t{\n\t\t\tif(i==j||a[j]<a[i]||a[j]==a[i])b[i]++;\n\t\t\telse b[j]++;\n\t\t}//\u8fd9\u91cc\u7684b[i]\u5c31\u662f\u7b2ci\u4e2a\u6570\u5728\u6570\u7ec4a[i]\u4e2d\u7684\u6392\u4f4d \n\t}\n\tfor(int i=0;i<q;i++)\n\t{\n\t\tscanf(\"%d\",&num);\n\t\tif(num==1)\n\t\t{\n\t\t\tscanf(\"%d%d\",&x,&v);\n\t\t\tfor(int i=1;i<=n;i++)\n\t\t\t{\n\t\t\t\tif(i==x)continue;\n\t\t\t\tif((a[i]<a[x]||a[i]==a[x]&&i<x)&&(a[i]>v||a[i]==v&&i>x))\n\t\t\t\t{\n\t\t\t\t\tb[i]++;b[x]--;\n\t\t\t\t}\n\t\t\t\telse if((a[i]>a[x]||a[i]==a[x]&&i>x)&&(a[i]<v||a[i]==v&&i<x))\n\t\t\t\t{\n\t\t\t\t\tb[i]--;b[x]++;\n\t\t\t\t}\n\t\t\t}\n\t\t\ta[x]=v;\n\t\t}\n\t\tif(num==2)\n\t\t{\n\t\t\tscanf(\"%d\",&x);\n\t\t\tprintf(\"%d\\n\",b[x]);\n\t\t}\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1635255799,
        "uid": 136931,
        "name": "chenpengda",
        "ccfLevel": 5,
        "title": "CSP2021-J T2"
    },
    {
        "content": "\u9898\u5916\u8bdd\uff1a\u4eca\u5e74\u9898\u592a\u7b80\u5355\u4e86\u5427\u3002\u3002\u3002\u6211\u90fd\u80fd\u963f\u514b\u3002\u3002\u3002\n\n# \u9898\u610f\n\u6709\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5168\u662f\u6b63\u6574\u6570\u7684\u5e8f\u5217\uff0c\u6709 $q$ \u6b21\u8be2\u95ee\uff0c\u5206\u4e3a\u4e24\u79cd\uff1a\n1. \u628a\u7b2c $x$ \u4e2a\u6570\u6539\u4e3a $v$\uff0c\u6ce8\u610f\uff0c\u672c\u64cd\u4f5c\u6700\u591a\u6709 $5000$ \u6b21\u3002\n1. \u67e5\u8be2\u7b2c $x$ \u4e2a\u6570\u7684\u6392\u540d\uff0c\u6ce8\u610f\uff0c\u5982\u679c\u4e24\u4e2a\u6570\u7684\u503c\u76f8\u7b49\u7684\u8bdd\uff0c\u90a3\u4e48\u66f4\u9760\u524d\u7684\u90a3\u4e2a\u6392\u540d\u66f4\u4f4e\u3002\n\n# \u505a\u6cd5\n\u7528\u4e00\u4e2a\u5e73\u8861\u6811\u7ef4\u62a4\u5c31\u53ef\u4ee5\u4e86\uff0c\u4f46\u6ce8\u610f\u5230\u6700\u591a\u6709 $n+5000$ \u4e2a\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u79bb\u6563\u5316\u4e00\u4e0b\u7136\u540e\u7528\u503c\u57df\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u5c31\u884c\u4e86\uff0c\u6ce8\u610f\u4e24\u4e2a\u503c\u76f8\u7b49\u4f46\u662f\u5b83\u653e\u7684\u4f4d\u7f6e\u4e0d\u4e00\u6837\u7684\u8bdd\uff0c\u79bb\u6563\u5316\u540e\u7684\u503c\u4e5f\u4e0d\u5e94\u8be5\u4e00\u6837\u3002\n\n\u8003\u573a\u4ee3\u7801\uff1a\n```cpp\n#include<stdio.h>\n#include<ctype.h>\n#include<algorithm>\nFILE *in=fopen(\"sort.in\",\"r\"),*out=fopen(\"sort.out\",\"w\");\nstruct{\n\tint op,x,v;\n}q[200001];\nstruct pair{\n\tint a,b;\n\tbool operator <(const pair&o)const{\n\t\treturn a==o.a?b<o.b:a<o.a;\n\t}\n\tbool operator ==(const pair&o)const{\n\t\treturn a==o.a&&b==o.b;\n\t}\n}b[13001];\nint a[8001],cnt[13001],n,Q,m;\ninline void add(int x,int y){\n\tfor(;x<=m;x+=(x&-x))\n\t\tcnt[x]+=y;\n}\ninline int sum(int x){\n\tint ans=0;\n\tfor(;x;x-=(x&-x))\n\t\tans+=cnt[x];\n\treturn ans;\n}\nnamespace fasti{\n\tchar buf[1<<15],*p1=buf,*p2=buf;\n\t#define getc() (p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<15,in),p1==p2)?EOF:*p1++)\n\tinline void read(int&x){\n\t\tchar c=getc();\n\t\tfor(;!isdigit(c);c=getc());\n\t\tfor(x=0;isdigit(c);c=getc())x=(x<<1)+(x<<3)+(c^48);\n\t}\n}\nusing fasti::read;\nint main(){\n\tread(n),read(Q);\n\tfor(int i=1;i<=n;++i)read(a[i]),b[i]={a[i],i};\n\tm=n;\n\tfor(int i=1;i<=Q;++i){\n\t\tread(q[i].op),read(q[i].x);\n\t\tif(q[i].op==1)read(q[i].v),b[++m]={q[i].v,q[i].x};\n\t}\n\tstd::sort(b+1,b+m+1);\n\tm=std::unique(b+1,b+m+1)-b-1;\n\tfor(int i=1;i<=n;++i)add(a[i]=(std::lower_bound(b+1,b+m+1,(pair){a[i],i})-b),1);\n\tfor(int i=1;i<=Q;++i){\n\t\tif(q[i].op==1){\n\t\t\tadd(a[q[i].x],-1);\n\t\t\tadd(a[q[i].x]=std::lower_bound(b+1,b+m+1,(pair){q[i].v,q[i].x})-b,1);\n\t\t}else\n\t\t\tfprintf(out,\"%d\\n\",sum(a[q[i].x]));\n\t}\n\tfclose(in);\n\tfclose(out);\n\treturn 0;\n}\n```",
        "postTime": 1634992404,
        "uid": 203008,
        "name": "toaru",
        "ccfLevel": 5,
        "title": "CSP2021-J T2"
    },
    {
        "content": "## \u5e7f\u544a\n[$\\color{Cyan}\\colorbox{White}{\u65e0\u803b\u5730\u63a8\u8350\u4e00\u4e0b\u6211\u7684\u535a\u5ba2}$](https://www.luogu.com.cn/blog/Michaela-chr/#)\n## \n## PART 0\uff1a\u9898\u610f\u63cf\u8ff0\n\u7ed9\u5b9a\u4e00\u4e2a\u6570\u5217 $a_1,a_2,\u2026\u2026,a_n$\uff0c\u73b0\u5728\u8981\u6c42\u51fa\u4fee\u6539\u548c\u5192\u6ce1\u6392\u5e8f\uff08\u9898\u76ee\u8bf4\u662f\u63d2\u5165\u6392\u5e8f\uff0c\u6211\u695e\u662f\u770b\u4e86\u597d\u4e45\uff09\u4e4b\u540e\u6bcf\u4e2a\u5143\u7d20\u6240\u5728\u7684\u4f4d\u7f6e\u3002\n## PART 1\uff1a\u601d\u8def\u5206\u6790\n\u9898\u76ee\u8981\u6c42\u7684\u662f **\u539f\u6765\u7684 $a_x$ \u5728\u73b0\u5728\u7684\u4f4d\u7f6e**\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f00\u4e00\u4e2a\u6570\u7ec4\u7ef4\u62a4 **\u539f\u4f4d\u7f6e** \u4e0e **\u6392\u5e8f\u540e\u7684\u4f4d\u7f6e** \u7684\u5bf9\u5e94\u5173\u7cfb\u3002\n\n\u5c31\u50cf\u8fd9\u6837\n```cpp\nvoid get_order(){\n    for(int i=1;i<=n;i++){\n        order[a[i].num]=i;\n    }\n}\n```\n\n### \u5b8c\u5168\u66b4\u529b\n\u9996\u5148\u770b\u5230\u9898\u76ee\u4e2d\u8be2\u95ee\u7684\u8981\u6c42\n\n```\n\u5047\u8bbe H \u8001\u5e08\u6309\u7167\u4e0a\u9762\u7684\u4f2a\u4ee3\u7801\u5bf9 a \u6570\u7ec4\u8fdb\u884c\u6392\u5e8f\uff0c\u4f60\u9700\u8981\u544a\u8bc9 H \u8001\u5e08\u539f\u6765 a \u7684\u7b2c x \u4e2a\u5143\u7d20\uff0c\u4e5f\u5c31\u662f a[x]\uff0c\u5728\u6392\u5e8f\u540e\u7684\u65b0\u6570\u7ec4\u6240\u5904\u7684\u4f4d\u7f6e\u3002\u4fdd\u8bc1 1\u2264x\u2264n\u3002\u6ce8\u610f\u8fd9\u79cd\u64cd\u4f5c\u4e0d\u4f1a\u6539\u53d8\u6570\u7ec4\u7684\u5143\u7d20\uff0c\u6392\u5e8f\u540e\u7684\u6570\u7ec4\u4e0d\u4f1a\u88ab\u4fdd\u7559\uff0c\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u540e\u7eed\u7684\u64cd\u4f5c\u3002\n```\n\n\u9898\u76ee\u4e2d\u63d0\u5230 **\u6392\u5e8f\u540e\u7684\u6570\u7ec4\u4e0d\u4f1a\u88ab\u4fdd\u7559\uff0c\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u540e\u7eed\u7684\u64cd\u4f5c**\uff0c\u8fd9\u6837\u770b\u8d77\u6765\u6211\u4eec\u9700\u8981\u6bcf\u6b21\u5c06\u6570\u7ec4\u590d\u5236\u4e00\u904d\uff0c\u7136\u540e\u8fdb\u884c\u6392\u5e8f\uff0c\u5f97\u5230\u7b54\u6848\u540e\u518d\u5c06\u6570\u7ec4\u590d\u539f\uff0c\u4e8e\u662f\u5f97\u5230\u4e86\u8fd9\u6837\u7684\u4ee3\u7801\n\n```cpp\nvoid query(int x){\n    for(int i=1;i<=n;i++){\n        b[i]=a[i];\n    }\n    sort(b+1,b+n+1);\n    get_order();\n    printf(\"%d\\n\",order[x]);\n}\nvoid updata(int x,int v){\n    a[x].val=v;\n}\n```\n\n\u663e\u7136\uff0c\u8fd9\u6837\u53ea\u6709 52 \u5206\uff0c\u60f3\u8981 AC\uff0c\u8fd8\u9700\u8981\u5176\u4ed6\u4f18\u5316\n### \u6b63\u89e3\nH \u8001\u5e08\u7684\u6bcf\u4e00\u6b21\u8be2\u95ee\uff0c\u90fd\u9700\u8981\u6392\u5e8f\uff0c\u8fd9\u672a\u514d\u592a\u6d6a\u8d39\u65f6\u95f4\u4e86\uff0c\u6211\u4eec\u53ef\u4e0d\u53ef\u4ee5\u4e0d\u7528\u6bcf\u6b21\u6392\u5e8f\u5462\uff1f\u5f53\u7136\u53ef\u4ee5\u3002\u6211\u4eec\u53ef\u4ee5\u5728\u6bcf\u4e00\u6b21\u4fee\u6539\u540e\uff0c\u628a\u4fee\u6539\u540e\u7684\u5143\u7d20\u7ed9\u4ed6\u653e\u5728\u6b63\u786e\u7684\u4f4d\u7f6e\u3002\u6ca1\u9519\uff0c\u5c31\u662f\u4e00\u4e2a\u5143\u7d20\u7684\u5192\u6ce1\u3002\n\n\u4f46\u662f\u6211\u4eec\u60f3\u8981\u77e5\u9053\u7684\u662f\uff0c\u8fd9\u6837\u548c\u9898\u610f\u6709\u51b2\u7a81\uff0c\u9898\u76ee\u4e2d\u8bf4\u7684\u662f **\u6392\u5e8f\u540e\u7684\u6570\u7ec4\u4e0d\u4f1a\u88ab\u4fdd\u7559\uff0c\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u540e\u7eed\u7684\u64cd\u4f5c**\uff0c\u8fd9\u79cd\u5199\u6cd5\u662f\u5426\u6b63\u786e\u5462\uff1f\n\n\u8fd9\u79cd\u5199\u6cd5\u7684\u786e\u662f\u6b63\u786e\u7684\u3002\u56e0\u4e3a\u6bcf\u6b21\u5728\u67e5\u8be2\u7684\u65f6\u5019\u90fd\u9700\u8981\u6392\u5e8f\uff0c\u6240\u4ee5\u67e5\u8be2\u7684\u65f6\u5019\u5143\u7d20\u4e00\u5b9a\u662f\u6709\u5e8f\u7684\uff0c\u800c\u6211\u4eec\u4e00\u76f4\u4fdd\u8bc1\u5143\u7d20\u7684\u6709\u5e8f\u6027\uff0c\u8fd9\u6837\u6700\u7ec8\u5f97\u5230\u7684\u5e8f\u5217\u548c\u524d\u9762\u66b4\u529b\u5f97\u51fa\u7684\u5e8f\u5217\u662f\u4e00\u6837\u7684\uff0c\u90a3\u4e48\u7b54\u6848\u81ea\u7136\u4e5f\u5c31\u6b63\u786e\u3002\n\n\u6240\u4ee5\u4fee\u6539\u7684\u51fd\u6570\u53ef\u4ee5\u8fd9\u6837\u5199\n\n```cpp\nvoid updata(int x,int v){\n    a[order[x]].val=v;\n    for(int i=order[x];i<n;i++){\n        if(a[i]>a[i+1]){\n            swap(a[i],a[i+1]);\n        }\n    }\n    for(int i=order[x];i>1;i--){\n        if(a[i]<a[i-1]){\n            swap(a[i],a[i-1]);\n        }\n    }\n    get_order();\n}\n```\n\u800c\u6700\u540e\u7684\u67e5\u8be2\u53ea\u9700\u8981\u8f93\u51fa\u6211\u4eec\u4e4b\u524d\u7ef4\u62a4\u7684\u5bf9\u5e94\u5173\u7cfb\u7684\u7b2c $x$ \u4e2a\u5c31\u53ef\u4ee5\u4e86\n## PART 3\uff1a\u7ec6\u8282\n\u548c\u7b2c\u4e00\u79cd\u66b4\u529b\u6709\u4e0d\u540c\u7684\u662f\uff0c\u7531\u4e8e\u6211\u4eec\u66f4\u6539\u4e86\u5143\u7d20\u7684\u987a\u5e8f\uff0c\u6240\u4ee5\u6211\u4eec\u4fee\u6539\u7684\u65f6\u5019\u5e76\u4e0d\u662f\u76f4\u63a5\u4fee\u6539 $a_x$\uff0c\u800c\u9700\u8981\u4fee\u6539 $a_{order_x}$ \uff0c\u5176\u4e2d order \u7ef4\u62a4\u7684\u662f\u524d\u9762\u6240\u63d0\u5230\u7684\u5173\u7cfb\uff0c\u800c\u5192\u6ce1\u4e5f\u9700\u8981\u4ece $a_{order_x}$ \u5f00\u59cb\uff0c\u800c\u975e $a_x$\n## PART 4\uff1aAC \u4ee3\u7801\n\u4e0d\u4f1a\u6709\u4eba\u4f1a\u7ffb\u5230\u8fd9\u91cc\u5427\uff0c\u90a3\u6211\u6084\u6084\u653e\u4e0a\u6211\u7684\u5783\u573e\u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\n#define MAXN 8010\nusing namespace std;\nstruct node{\n    int val;\n    int num;\n    bool operator >(const node b) const{\n        if(this->val!=b.val) return this->val > b.val;\n        else return this->num > b.num;\n    }\n    bool operator <(const node b) const{\n        if(this->val!=b.val) return this->val < b.val;\n        else return this->num < b.num;\n    }\n};\nnode a[MAXN];\nint n,q;\nint type,x,v;\n/*\n    order -> \u8bb0\u5f55\u6bcf\u4e2a\u70b9\u521d\u59cb\u7f16\u53f7\u4e0e\u5f53\u524d\u4f4d\u7f6e\u7684\u5173\u7cfb\n*/\nint order[MAXN];\nvoid get_order(){\n    for(int i=1;i<=n;i++){\n        order[a[i].num]=i;\n    }\n}\nvoid updata(int x,int v){\n    a[order[x]].val=v;\n    for(int i=order[x];i<n;i++){\n        if(a[i]>a[i+1]){\n            swap(a[i],a[i+1]);\n        }\n    }\n    for(int i=order[x];i>1;i--){\n        if(a[i]<a[i-1]){\n            swap(a[i],a[i-1]);\n        }\n    }\n    get_order();\n}\nint main(){\n    // freopen(\"sort.in\",\"r\",stdin);\n    // freopen(\"sort.out\",\"w\",stdout);\n    scanf(\"%d%d\",&n,&q);\n    for(int i=1;i<=n;i++){\n        scanf(\"%d\",&a[i].val);\n        a[i].num=i;\n    }\n    sort(a+1,a+n+1);\n    get_order();\n    while(q--){\n        scanf(\"%d\",&type);\n        if(type==1){\n            scanf(\"%d%d\",&x,&v);\n            updata(x,v);\n        }else{\n            scanf(\"%d\",&x);\n            printf(\"%d\\n\",order[x]);\n        }\n    }\n    return 0;\n}\n```\n",
        "postTime": 1635859331,
        "uid": 547908,
        "name": "Hoshino_kaede",
        "ccfLevel": 7,
        "title": "P7910 [CSP-J 2021] \u63d2\u5165\u6392\u5e8f \u9898\u89e3"
    },
    {
        "content": "## \u524d\u8a00\n\u5f53\u6211\u7b2c\u4e00\u773c\u770b\u5230\u8fd9\u9053\u9898\uff0c\u6211\u60f3\u5230\u7684\u662f\u5e73\u8861\u6811\u2026\u2026\n\n\u4f46\u60f3\u60f3\u5c31\u80fd\u77e5\u9053\u666e\u53ca\u4e0d\u53ef\u80fd\u8003\u5e73\u8861\u6811\n\n\u4e8e\u662f\u2026\u2026\n\n**~~\u5927\u5bb6\u597d\uff0c\u6211\u975e\u5e38\u559c\u6b22\u7ebf\u6bb5\u6811\uff0c\u6240\u4ee5\u6211\u7528\u7ebf\u6bb5\u6811\u901a\u8fc7\u4e86\u901a\u8fc7\u4e86\u8fd9\u9053\u9898~~**\n\n## \u5206\u6790\n\n\u7b80\u5355\u7684\u4fee\u6539\u6743\u503c\u6c42\u6392\u540d\u800c\u5df2\u561b\u2026\u2026\u56e0\u4e3a\u63d2\u5165\u6392\u5e8f\u662f**\u7a33\u5b9a\u6392\u5e8f**\uff0c\u6240\u4ee5\u6743\u503c\u53ef\u4ee5\u8d4b\u503c\u4e3a $a_i \\times n + i - 1$\n\n\u63a5\u4e0b\u6765\u5c31\u662f\u4e00\u4e2a\u503c\u57df\u7ebf\u6bb5\u6811\u4e86\u3002~~\u8fd8\u662f\u88f8\u7684\u3002~~ \u4e0d\u8fc7\u7a7a\u95f4\u4e0d\u591f\uff0c\u6240\u4ee5\u5fc5\u987b\u52a8\u6001\u5f00\u70b9\u3002\n\n## \u4ee3\u7801\n\n```cpp\n// Author : Luogu Canstant0x5F3759DF\n#include <bits/stdc++.h>\n#define lld long long\nusing namespace std;\n#define frein(x) freopen(x, \"r\", stdin)\n#define freout(x) freopen(x, \"w\", stdout)\nint n, q;\nlld a[10010];\nstruct node1 {\n\tint sons[2];\n\tint vis;\n} tr[3000010];\nint cnt = 1;\nvoid insert(lld x) {\n\tint p = 1;\n\t++ tr[p].vis;\n\tint b;\n\tfor (int i = 63; i >= 0; -- i) {\n\t\tb = (x >> i) & 1;\n\t\tif (!tr[p].sons[b])\n\t\t\ttr[p].sons[b] = ++ cnt;\n\t\tp = tr[p].sons[b];\n\t\t++ tr[p].vis;\n\t}\n}\nvoid remove(lld x) {\n\tint p = 1;\n\t-- tr[p].vis;\n\tfor (int i = 63; i >= 0; -- i) {\n\t\tp = tr[p].sons[(x >> i) & 1];\n\t\tif (!p) return;\n\t\t-- tr[p].vis;\n\t}\n}\nint query(lld x) {\n\tint p = 1;\n\tint ret = 0;\n\tint b;\n\tfor (int i = 63; i >= 0; -- i) {\n\t\tb = (x >> i) & 1;\n\t\tif (b) ret += tr[tr[p].sons[0]].vis;\n\t\tp = tr[p].sons[b];\n\t\tif (!p) return ret;\n\t}\n\treturn ret;\n}\nint main() {\n\tfrein(\"sort.in\");\n\tfreout(\"sort.out\");\n\tscanf(\"%d%d\", &n, &q);\n\tfor (int i = 1; i <= n; ++ i) {\n\t\tscanf(\"%lld\", a + i);\n\t\tinsert((lld)a[i] * n + i - 1);\n\t}\n\tint op, x, v;\n\tfor (int i = 1; i <= q; ++ i) {\n\t\tscanf(\"%d%d\", &op, &x);\n\t\tif (op == 1) {\n\t\t\tscanf(\"%d\", &v);\n\t\t\tremove((lld)a[x] * n + x - 1);\n\t\t\ta[x] = v;\n\t\t\tinsert((lld)a[x] * n + x - 1);\n\t\t} else printf(\"%d\\n\", query((lld)a[x] * n + x - 1) + 1);\n\t}\n\tfclose(stdin);\n\tfclose(stdout);\n\treturn 0;\n}\n\n```",
        "postTime": 1635001406,
        "uid": 228486,
        "name": "SunsetSamsara",
        "ccfLevel": 7,
        "title": "P7910 [CSP-J 2021] \u63d2\u5165\u6392\u5e8f\uff08\u6c11\u95f4\u6570\u636e\uff09 \u9898\u89e3"
    },
    {
        "content": "\n### \u672c\u9898\u6b63\u89e3\n\n\u8fd9\u4e2a\u9898\u76ee\u9ebb\u70e6\u7684\u5730\u65b9\u4e0d\u5728\u4e8e\u64cd\u4f5c $1$ \uff0c\u800c\u5728\u4e8e\u64cd\u4f5c $2$ \u4ed6\u8bf4\u6392\u5b8c\u5e8f\u4e4b\u540e\u4e0d\u4ec5\u8981\u77e5\u9053\u8fd9\u4e2a\u6570\u5728\u539f\u6570\u7ec4\u7684\u54ea\u4e00\u4e2a\u4f4d\u7f6e\u4e0a\uff0c\u800c\u4e14\u4ed6\u4e0d\u4f1a\u4fdd\u7559\u8fd9\u4e00\u6b21\u7684\u6392\u5e8f\u7ed3\u679c\uff0c\u8fd9\u5c31\u5bfc\u81f4\u6211\u4eec\u5728\u64cd\u4f5c $1$ \u4fee\u6539\u5b8c\u503c\u4e4b\u540e\u4e0d\u80fd\u5bf9\u539f\u6570\u7ec4\u76f4\u63a5\u8fdb\u884c\u63d2\u5165\u601d\u60f3\u7684\u6392\u5e8f\u3002 \u4f46\u662f\u5982\u679c\u6211\u4eec\u5728\u64cd\u4f5c $2$ \u7528\u4e00\u4e2a\u6570\u7ec4\u6765\u8fdb\u884c\u6392\u5e8f\uff0c\u6700\u5feb\u4e5f\u9700\u8981 $nlogn$ \u662f\u80af\u5b9a\u4f1a\u8d85\u65f6\u7684\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u53ea\u6709\u64cd\u4f5c $1$ \u53ef\u4ee5\u505a $O(n)$ \u7684\u64cd\u4f5c,\u64cd\u4f5c $2$ \u53ea\u80fd\u505a $O(1)$ \u7684\u64cd\u4f5c\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5148\u7ef4\u62a4\u4e00\u4e2a $tot$ \u4e00\u7ef4\u6570\u7ec4\uff0c$tot_i$ \u8868\u793a\u539f\u6570\u7ec4\u7684\u7b2c $i$ \u4e2a\u6570\u5b57\u5728\u73b0\u5728\u7684\u6570\u7ec4\u4e2d\u662f\u6392\u5728\u7b2c\u51e0\u4e2a\u4f4d\u7f6e\u4e0a\u7684\u3002 \u663e\u7136\uff0c\u64cd\u4f5c $2$ \u5c31\u76f4\u63a5\u8f93\u51fa $tot_x$ , \u8fbe\u5230\u4e86 $O(1)$ \u7684\u6548\u679c\uff0c\u63a5\u4e0b\u6765\u7684\u96be\u70b9\u5c31\u662f\u64cd\u4f5c $1$ \uff0c\u8be5\u600e\u4e48\u8fd0\u7528 $\\le O(n)$ \u7684\u65b9\u6cd5\uff0c\u53bb\u4fee\u6539 $tot$ \u7684\u503c\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5148\u5c06\u539f\u6570\u7ec4\u8fdb\u884c\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u5e76\u66f4\u65b0 $tot$ \u7684\u503c\uff0c\u7136\u540e\u6bcf\u4fee\u6539\u4e00\u4e2a $a_x$ \uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8fd0\u7528\u5192\u6ce1\u6392\u5e8f\u7684\u601d\u60f3\uff0c\u628a\u4fee\u6539\u7684\u8fd9\u4e2a\u6570\u5f80\u524d\u9762\u6324\u6216\u8005\u5f80\u540e\u9762\u6324\u3002(\u56e0\u4e3a\u6570\u7ec4\u6709\u5e8f\uff0c\u4e14\u53ea\u4fee\u6539\u4e86\u4e00\u4e2a\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u5c06\u8fd9\u4e00\u4e2a\u6570\u7684\u987a\u5e8f\u6539\u53d8)\u3002\u7279\u522b\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5f53\u4e00\u4e2a\u88ab\u4fee\u6539\u7684\u6570\u5728\u5f80\u524d\u9762\u6324\u7684\u65f6\u5019\uff0c\u6211\u4eec\u9700\u8981\u6539\u53d8 $tot$ \u7684\u503c\uff0c\u56e0\u4e3a\u5b83\u5728\u73b0\u5728\u6570\u7ec4\u7684\u4f4d\u7f6e\u6539\u53d8\u4e86\u3002\n\n\u5176\u4f59\u7684\u90fd\u6ca1\u6709\u4ec0\u4e48\u8981\u8bf4\u7684\uff0c\u5c31\u662f\u8981\u6ce8\u610f\u5728\u4fee\u6539 $tot$ \u503c\u7684\u65f6\u5019\u4e0d\u8981\u5199\u9519\u5c31\u53ef\u4ee5\u4e86\u3002\n\n### AC\u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,q;\nint tot[100005];//\u8981\u7ef4\u62a4\u7684tot\u6570\u7ec4 \nstruct node\n{\n\tint a,id;//\u8bb0\u5f97\u50a8\u5b58\u8fd9\u4e2a\u6570\u5728\u539f\u6570\u7ec4\u7684\u7f16\u53f7\u3002 \n\tbool operator <(const node &n)const\n\t{\n\t\treturn a<n.a||(a==n.a&&id<n.id);//\u6392\u5e8f\u65b9\u5f0f \n\t}\n}arr[100005];\nint s;\nint main()\n{\n\t//\u6587\u4ef6\u8f93\u5165\u8f93\u51fa \n \tfreopen(\"sort.in\",\"r\",stdin);\n \tfreopen(\"sort.out\",\"w\",stdout);\n\tscanf(\"%d%d\",&n,&q);\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\t//\u8f93\u5165\uff0c\u53d8\u6362id\u7684\u503c \n\t\tarr[i].id=i;\n\t\tscanf(\"%d\",&arr[i].a);\n\t}\n\tsort(arr+1,arr+n+1);//\u6392\u5e8f \n\tfor(int i=1;i<=n;++i)\n\t{\n\t\ttot[arr[i].id]=i;//\u7b2c\u4e00\u6b21\u6392\u5e8f\u540e\uff0ctot\u7684\u503c \n\t}\n\twhile(q--)\n\t{\n\t\t//\u64cd\u4f5c \n\t\tint op,x,y;\n\t\tscanf(\"%d%d\",&op,&x);\n\t\tif(op==1)\n\t\t{\n\t\t\tscanf(\"%d\",&y);\n\t\t\ts=tot[x];\n\t\t\tarr[tot[x]].a=y;//\u7531\u4e8ex\u662f\u6307\u7684\u539f\u6570\u7ec4\u7684\u4e0b\u6807\uff0c\u800c\u73b0\u5728\u6570\u7ec4\u7684\u4e0b\u6807\u662f tot[y] \n\t\t\t//\u5411\u524d\u6324 \n\t\t\tfor(int i=s-1;i>=1;--i)\n\t\t\t{\n\t\t\t\tif(arr[i].a>y||(arr[i].a==y&&x<arr[i].id))\n\t\t\t\t{\n\t\t\t\t\t//\u4ea4\u6362tot\u503c\u548carr\u503c\uff0c\u6ce8\u610f\u5148\u540e\u987a\u5e8f \n\t\t\t\t\tswap(tot[x],tot[arr[i].id]);\n\t\t\t\t\tswap(arr[s],arr[i]);\n\t\t\t\t\ts=tot[x];\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t//\u5411\u540e\u6324 \n\t\t\tfor(int i=s+1;i<=n;++i)\n\t\t\t{\n\t\t\t\tif(arr[i].a<y||(arr[i].a==y&&x>arr[i].id))\n\t\t\t\t{\n\t\t\t\t\tswap(tot[x],tot[arr[i].id]);\n\t\t\t\t\tswap(arr[s],arr[i]);\n\t\t\t\t\ts=tot[x];\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\t//O(1)\u64cd\u4f5c\uff0c\u76f4\u63a5\u8f93\u51fa \n\t\t\tprintf(\"%d\\n\",tot[x]);\n\t\t}\n\t}\n\treturn 0;//\u8bb0\u5f97\u8fd4\u56de0 \n}\n```",
        "postTime": 1635830631,
        "uid": 428690,
        "name": "Zhy_never_giveup_jtl",
        "ccfLevel": 0,
        "title": "P7910 \u63d2\u5165\u6392\u5e8f\u9898\u89e3"
    },
    {
        "content": "## 0x01 \u524d\u8a00\n\n\u8003\u573a\u4e0a\u5148\u505a T3 \u518d\u505a T2 \u7684 QwQ\n\n---\n\n## 0x02 \u601d\u8def\n\n\u9996\u5148\uff0c\u63d2\u6392\u662f\u7a33\u5b9a\u6027\u6392\u5e8f\uff0c\u6240\u4ee5\u53ef\u4ee5\u6539\u6210\u4e0d\u7a33\u5b9a\u7684\u5feb\u6392\u52a0\u4e2a\u8868\u793a\u5e8f\u53f7\u7684 $id$ \uff08\u53ef\u4ee5\u7406\u89e3\u6210\u4eba\u5de5\u5c06\u7ed3\u679c\u53d8\u7a33\u5b9a\uff09\uff0ccmp \u51fd\u6570\u4e3a\n\n```cpp\n\tbool cmp(pair<int, int> a, pair<int, int> b)\n\t{\n\t\tif(a.first != b.first) return a.first < b.first; //\u6570\u503c\n   \t\telse return a.second < b.second; //id\n\t}\n```\n\n\u5176\u6b21\uff0c\u5982\u679c\u6211\u4eec\u771f\u7684\u6765\u6a21\u62df\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(Qnlogn)$ \uff0c\u6240\u4ee5\u8fde\u5feb\u6392\u90fd\u4e0d\u80fd\u8fc7\u3002\n\n\u90a3\u600e\u4e48\u529e\u5462\uff1f\n\n\u6211\u4eec\u53d1\u73b0 H \u8001\u5e08\u9700\u8981\u7684\u53ea\u662f\u5143\u7d20\u7684\u4f4d\u7f6e\uff08\u53ef\u4ee5\u7406\u89e3\u6210\u6392\u540d\uff09\uff0c\u6240\u4ee5\u76f4\u63a5\u8bb0\u5f55\u6bd4 $a_x$ \u5c0f\u7684\u5143\u7d20\u7684\u4e2a\u6570\uff0c\u8f93\u51fa\u65f6\u52a0\u4e00 \uff08\u6392\u540d\u5305\u542b\u81ea\u5df1\uff09\uff0c\u6539\u53d8\u65f6\u66f4\u65b0\u4e00\u904d $le_i$ \u5c31\u884c\u4e86\u3002\n\n\u6ce8\u610f\u5230\u8fd9\u53e5\u8bdd\uff1a**H \u8001\u5e08\u4e0d\u559c\u6b22\u8fc7\u591a\u7684\u4fee\u6539\uff0c\u6240\u4ee5\u4ed6\u4fdd\u8bc1\u7c7b\u578b 1 \u7684\u64cd\u4f5c\u6b21\u6570\u4e0d\u8d85\u8fc7 5000\u3002**\n\n\u4e8e\u662f\u8fd9\u4e2a\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f $O(NM)$ \uff0c\u5176\u4e2d $M$ \u4e3a\u64cd\u4f5c 1 \u7684\u4e2a\u6570\u3002\u663e\u7136\uff0c\u6491\u6b7b\u4e0d\u8d85\u8fc7 $4\\times 10^7$ \u3002\n\n---\n\n## 0x03 \u4ee3\u7801\n\n```cpp\n\t//O(4 * 10^7)\n\t\n\t#include<bits/stdc++.h>\n\t#define int long long\n\t#define Rep(i, n) for(int i=0; i< n; i++)\n\t#define Rpp(i, n) for(int i=0; i<=n; i++)\n\t#define Pinf 0x3f3f3f3f3f3f3f3fLL\n\t#define Ninf 0xcfcfcfcfcfcfcfcfLL\n\tusing namespace std;\n\t\n\tpair <int, int> p[8010], k[8010]; // k \u662f\u8f85\u52a9less\u7528\u7684\n\tint le[8010];\n\t\n\tsigned main()\n\t{\n\t\n\t\tint n, q; scanf(\"%lld %lld\", &n, &q);\n\t\tRep(i, n) { scanf(\"%lld\", &p[i].first); p[i].second = i; k[i] = p[i]; }\n\t\tsort(k, k+n);\n\t\tRep(i, n) le[k[i].second] = i; //\u521d\u59cb\u5316 le[i]\n\t\twhile(q --)\n\t\t{\n\t\t\tint op; scanf(\"%lld\", &op);\n\t\t\tif(op == 2)\n\t\t\t{\n\t\t\t\tint x; scanf(\"%lld\", &x); //\u56e0\u4e3a\u672c\u849f\u84bb\u4e60\u60ef\u4ece 0 \u5f00\u59cb\u4e0b\u6807\uff0c\u6240\u4ee5\u8981 --x \u3002\n\t\t\t\tprintf(\"%lld\\n\", le[--x]+1);\n\t\t\t}\n\t\t\telse // \u6ce8\u610f\u66f4\u65b0\u8981\u653e\u5728 op=1 \uff0c\u4e0d\u7136\u4f1a TLE \u6389\uff08\u590d\u6742\u5ea6 O(QN) \uff09\n\t\t\t{\n\t\t\t\tint x, nownum;\n\t\t\t\tpair <int, int> lsnum;\n\t\t\t\tscanf(\"%lld %lld\", &x, &nownum);\n\t\t\t\tlsnum = p[--x];\n\t\t\t\tp[x].first = nownum;\n\t\t\t\tle[x] = 0;\n\t\t\t\tRep(i, n)\n\t\t\t\t{\n\t\t\t\t\tif(i == x) continue;\n\t\t\t\t\tif(p[i] < p[x]) ++le[x]; //\u66f4\u65b0\n\t\t\t\t\tif(p[i] < lsnum && p[i] > p[x]) ++le[i];\n\t\t\t\t\tif(p[i] > lsnum && p[i] < p[x]) --le[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn 0;\n\t}\n```\n---\n## 0x04 Update\n\n\u542c\u8bf4 julao @Cui2010 \u6709\u4e00\u4e2a $O(n logn)$ \u7684\u505a\u6cd5",
        "postTime": 1634994776,
        "uid": 380730,
        "name": "LKX_Wata",
        "ccfLevel": 7,
        "title": "CSP-J 2021 T2 \u9898\u89e3"
    },
    {
        "content": "## \u9898\u76ee\u5927\u610f\n\n\u8981\u6c42\u5bf9\u6570\u5217 $a$ \u7ef4\u62a4\u4e24\u4e2a\u64cd\u4f5c\uff1a\n\n- \u5355\u70b9\u4fee\u6539\n\n- \u540d\u6b21\u67e5\u8be2\n\n\u5176\u4e2d\u540d\u6b21\u4ee5**\u6743\u503c\u4ece\u5c0f\u5230\u5927**\u4f5c\u4e3a\u7b2c\u4e00\u5173\u952e\u5b57\uff0c\u5728\u539f\u6570\u7ec4\u4e2d\u7684\u5148\u540e\u987a\u5e8f\u4e3a\u7b2c\u4e8c\u5173\u952e\u5b57\u3002\n\n## \u9898\u76ee\u5206\u6790\n\n\u770b\u5230\u6709\u4e00\u53e5\u5f88\u5173\u952e\u7684\u8bdd\uff1a\n\n**\u5bf9\u4e8e\u6240\u6709\u6d4b\u8bd5\u6570\u636e\uff0c\u4fdd\u8bc1\u5728\u6240\u6709 $Q$ \u6b21\u64cd\u4f5c\u4e2d\uff0c\u81f3\u591a\u6709 $5000$ \u6b21\u64cd\u4f5c\u5c5e\u4e8e\u7c7b\u578b\u4e00\u3002**\n\n\u4e5f\u5c31\u662f\u8bf4\u53ef\u4ee5\u5728\u53ea\u6709\u6bcf\u6b21\u64cd\u4f5c\u4e00\u7684\u65f6\u5019\u53ef\u4ee5\u8dd1\u4e00\u6b21 $O(n)$ \u7684\u7b97\u6cd5\uff0c\u6bcf\u6b21\u64cd\u4f5c\u4e8c\u7684\u65f6\u5019\u5c31\u53ea\u80fd\u76f4\u63a5\u8f93\u51fa\u3002\n\n\u5728\u8054\u7cfb\u9898\u76ee\u540d\u5b57\u53eb\u505a**\u63d2\u5165\u6392\u5e8f**\uff0c\u90a3\u4e48**\u80af\u5b9a\u4e0d\u4f1a\u662f\u76f4\u63a5\u7684\u63d2\u5165\u6392\u5e8f** qwq\u3002\n\n\u56e0\u4e3a\u6bcf\u6b21\u64cd\u4f5c\u4e00\u53ea\u4f1a\u5bf9\u4e00\u4e2a\u6570\u8fdb\u884c\u4fee\u6539\uff0c\u6240\u4ee5\u53ef\u4ee5\u8003\u8651\u628a\u6b63\u5e38\u7684\u63d2\u5165\u6392\u5e8f\u7684\u5916\u5c42\u7ed9\u6252\u4e86\uff0c\u53ea\u7559\u5185\u5c42\u7684\u6392\u5e8f\u64cd\u4f5c\uff0c\u6b63\u597d\u662f $O(n)$ \u7684\u590d\u6742\u5ea6\u3002\n\n\u4f46\u5728\u4ee3\u7801\u5b9e\u73b0\u7684\u65f6\u5019\u4f1a\u6709\u4e00\u4e2a\u95ee\u9898\uff1a\n\n**\u5982\u4f55\u7528 $O(1)$ \u7684\u590d\u6742\u5ea6\u5224\u65ad\u4f60\u771f\u6b63\u4fee\u6539\u7684\u4f4d\u7f6e\uff1f**\n\n\u5177\u4f53\u7684\u8bb2\uff0c\u5982\u679c\u6392\u5e8f\u65f6**\u5e26\u4e0a\u539f\u6570\u5217\u6392\u5e8f**\uff0c\u90a3\u4e48\u539f\u6570\u5217\u7684 $id$ \u5c06\u4f1a\u88ab\u6253\u4e71\uff1b\u800c\u5982\u679c**\u53ea\u5bf9 $id$ \u8fdb\u884c\u6392\u5e8f**\uff0c\u90a3\u4e48\u53ea\u80fd\u7ef4\u62a4\u65b0\u6570\u5217\u5f97\u6570\u5728\u539f\u6570\u5217\u7684\u4f4d\u7f6e ~~\uff08\u81f3\u5c11\u8003\u573a\u4e0a\u6211\u6ca1\u60f3\u5230 qwq\uff09~~\u3002\n\n\u5728\u8fd9\u91cc\u6211\u7684\u60f3\u6cd5\u662f\u518d\u6b21\u5b9a\u4e49\u4e00\u4e2a\u6570\u7ec4 $fid$ \u4e3a $id$ \u7684**\u53cd\u51fd\u6570**\uff0c\u7136\u540e**\u5e26\u4e0a\u539f\u6570\u5217\u6392\u5e8f**\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6700\u7ec8\u7b54\u6848\u50a8\u5b58\u5728 $fid$ \u4e2d\u3002\n\n\u7136\u540e\u4f60\u4f1a\u53d1\u73b0\u4e00\u4e2a\u975e\u5e38\u6709\u8da3\u7684\u4e1c\u897f\uff1a\u6bcf\u6b21\u771f\u5b9e\u4fee\u6539\u7684\u4f4d\u7f6e\u4e0d\u662f $x$ \uff0c\u800c\u662f $fid_x$\u3002\n\n\u90a3\u4e48\u4e0a\u9762\u90a3\u4e2a\u95ee\u9898\u5c31\u8fce\u5203\u800c\u89e3\u4e86\u3002\n\n\u81f3\u4e8e\u5982\u4f55\u7ef4\u62a4 $fid$\uff0c\u76f4\u63a5\u5728\u6bcf\u6b21\u6392\u5e8f\u73a9\u4e4b\u540e $O(n)$ \u66b4\u626b\u5c31\u597d\u4e86 qwq\u3002\n\n\u53ef\u80fd\u8bb2\u7684\u6709\u70b9\u96be\u61c2\uff0c\u90a3\u5c31\u5bf9\u7167\u7740\u4ee3\u7801\u7406\u89e3\u5427\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define ll long long\n#define R register\nusing namespace std;\nconst int MAXN=8010;\nint n,q;\nint fid[MAXN];\nstruct node{\n\tint val,id;\n}a[MAXN];//\u5e26\u4e0a\u539f\u6570\u5217\u4e00\u8d77\u6392\u5e8f\ninline bool cmp(node x,node y){\n\tif(x.val==y.val)return x.id<y.id;\n\treturn x.val<y.val;\n}\ninline void ssort(int x,bool f){//f\u8868\u793a\u628ax\u5f80\u524d\u653e\u8fd8\u662f\u5f80\u540e\u653e\n\tif(f){\n\t\tfor(R int i=x;i<n;i++){\n\t\t\tif(a[i].val>a[i+1].val||(a[i].val==a[i+1].val&&a[i].id>a[i+1].id)){\n\t\t\t\tnode t=a[i];\n\t\t\t\ta[i]=a[i+1];\n\t\t\t\ta[i+1]=t;\n\t\t\t}\n\t\t\telse break;\n\t\t}\n\t}\n\telse{\n\t\tfor(R int i=x;i>1;i--){\n\t\t\tif(a[i].val<a[i-1].val||(a[i].val==a[i-1].val&&a[i].id<a[i-1].id)){\n\t\t\t\tnode t=a[i];\n\t\t\t\ta[i]=a[i-1];\n\t\t\t\ta[i-1]=t;\n\t\t\t}\n\t\t\telse break;\n\t\t}\n\t}\n}\nint main(){\n//\tfreopen(\"sort.in\",\"r\",stdin);\n//\tfreopen(\"sort.out\",\"w\",stdout);\n\tscanf(\"%d%d\",&n,&q);\n\tfor(R int i=1;i<=n;i++){\n\t\tscanf(\"%d\",&a[i].val);\n\t\ta[i].id=i;\n\t}\n\tsort(a+1,a+n+1,cmp);//\u521d\u59cb\u6392\u5e8f\u6ca1\u6709\u90a3\u4e48\u591a\u8bb2\u7a76\uff0c\u76f4\u63a5\u6392\u5c31\u5b8c\u4e86\n\tfor(R int i=1;i<=n;i++)fid[a[i].id]=i;//\n\twhile(q--){\n\t\tint op;\n\t\tscanf(\"%d\",&op);\n\t\tif(op==1){\n\t\t\tR int x,y;\n\t\t\tscanf(\"%d%d\",&x,&y);\n\t\t\tR bool f=a[fid[x]].val<y;\n\t\t\ta[fid[x]].val=y;//\u771f\u5b9e\u7684\u4fee\u6539\u4f4d\u7f6e\u662ffid[x]\n\t\t\tssort(fid[x],f);\n\t\t\tfor(R int i=1;i<=n;i++)fid[a[i].id]=i;//\u91cd\u65b0\u7ef4\u62a4\u53cd\u51fd\u6570\n\t\t}\n\t\tif(op==2){\n\t\t\tR int x;\n\t\t\tscanf(\"%d\",&x);\n\t\t\tprintf(\"%d\\n\",fid[x]);\n\t\t}\n\t}\n//\tfclose(stdin);\n//\tfclose(stdout);\n\treturn 0;\n}\n```\n**The end.Thanks.**",
        "postTime": 1635951046,
        "uid": 390742,
        "name": "qwqUwU",
        "ccfLevel": 7,
        "title": "[CSP-J 2021] \u63d2\u5165\u6392\u5e8f"
    },
    {
        "content": "\u5e73\u8861\u6811\u88f8\u9898\u3002\u9898\u89e3\u975e\u8003\u573a\u601d\u8def\u3002\n\n## \u5206\u6790\n\n1. \u6b64\u9898\u660e\u663e\u4e0e\u6392\u5e8f\u76f8\u5173\u3002\u7531\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u4e8c\u53c9\u641c\u7d22\u6811\uff0c\u8fdb\u800c\u60f3\u5230\u5e73\u8861\u6811\u3002\n\n2. \u4fee\u6539\u76f4\u63a5\u6539\u4e0a\u53bb\uff08\u4fee\u6539\u4e0d\u662f\u4e34\u65f6\u7684\uff0c\u4f1a\u5f71\u54cd\u540e\u9762\u7684\u64cd\u4f5c\uff09\u542f\u793a\u6211\u4eec\u5e73\u8861\u6811\u662f\u53ef\u884c\u7684\uff08\u8981\u4e0d\u5c31\u53d8\u6210\u4e86\u53ef\u6301\u4e45\u5316\u5e73\u8861\u6811\uff09\u3002\n\n3. \u64cd\u4f5c `2` \u8be2\u95ee\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u90a3\u4e48\u3002\u3002\u3002\u8fd9\u4e0d\u5c31\u662f\u5e73\u8861\u6811\u7ed9\u503c\u6c42\u6392\u540d\u7684\u64cd\u4f5c\u5417\uff1f\n\n4. \u63d2\u6392\u662f\u7a33\u5b9a\u7684\uff0c\u6240\u4ee5\u8981\u628a\u5143\u7d20\u5728 $a$ \u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e\u4e5f\u8bb0\u5f55\u4e0b\u6765\u3002\n\n## \u505a\u6cd5\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u5efa\u4e00\u68f5\u5e73\u8861\u6811\uff0c\u4e00\u5f00\u59cb\u63d2\u5165\u539f\u59cb\u7684\u503c\uff08\u6ce8\u610f\uff0c\u8981\u628a\u5176\u5728 $a$ \u6570\u7ec4\u7684\u4f4d\u7f6e\u4e5f\u5f53\u4f5c\u6743\u503c\u8bb0\u4e0b\u6765\uff0c\u6211\u7528\u7684\u662f\u7ed3\u6784\u4f53\uff09\uff0c$a$ \u6570\u7ec4\u5185\u7684\u503c\u4e5f\u8981\u8bb0\u5f55\u3002\n\n\u4e0b\u9762\u7ea6\u5b9a\uff1a$v1$ \u4e3a\u5143\u7d20\u5728 $a$ \u6570\u7ec4\u7684\u503c\uff0c$v2$ \u4e3a\u5143\u7d20\u5728 $a$ \u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e\u3002\n\n\u5bf9\u4e8e\u64cd\u4f5c `1`\uff0c\u6211\u4eec\u8003\u8651\u628a\u7ed9\u5b9a\u7684\u503c\uff08\u540c\u65f6\u6ee1\u8db3 $v1$ \u548c $v2$ \u76f8\u7b49\uff09\u627e\u51fa\u6765\uff0c\u5220\u6389\uff0c\u518d\u63d2\u5165\u65b0\u7684\u503c\uff08\u63d2\u5165\u65b0\u7684 $v1$ \u548c $v2$\uff09\u3002\uff08\u6ce8\uff1a\u6b64\u65f6\u7684 $v1$ \u4e3a\u539f\u503c\uff0c\u5373 $a_{p}$\uff1b$v2$ \u4e3a\u9898\u76ee\u7ed9\u5b9a\u7684 $p$\uff1b\u65b0\u7684 $v1$ \u4e3a\u9898\u76ee\u7ed9\u5b9a\u7684 $v$\uff09\u3002\n\n\u5bf9\u4e8e\u64cd\u4f5c `2`\uff0c\u6211\u4eec\u8003\u8651\u7528\u5e73\u8861\u6811\u7684\u7ed9\u503c\uff08\u539f $v1$ \u548c $v2$\uff09\u6c42\u6392\u540d\u64cd\u4f5c\u6765\u66b4\u529b\u89e3\u51b3\u3002\uff08\u6ce8\uff1a\u539f $v1$ \u4e3a\u7ed9\u5b9a\u7684 $a_{p}$\uff1b\u539f $v2$ \u4e3a\u7ed9\u5b9a\u7684 $p$\uff09\u3002\n\n## \u4ee3\u7801\n\n\u5feb\u8bfb\u5feb\u5199\u64cd\u4f5c\u7b49\u7565\uff0c\u770b [\u8fd9\u91cc](https://www.luogu.com.cn/paste/2i2fp17n)\n\n`iget` \u4e3a\u8bfb\u5165 `int` \u7c7b\u578b\uff0c`iwln` \u4e3a\u8f93\u51fa `int` \u7c7b\u578b\u6570\u4e14\u6362\u884c\uff08`int write line` ~~Chinglish \u5341\u7ea7 qwq~~\uff09\u3002\n\n\u6211\u7528\u7684\u5e73\u8861\u6811\u662f fhq treap\uff0c\u5e38\u6570\u53ef\u80fd\u8f83\u5927\uff08\u4e5f\u53ef\u80fd\u662f\u6211\u5199\u4ee3\u7801\u81ea\u5e26\u5927\u5e38\u6570\u5427\uff09\uff0c\u56e0\u6b64\u4e0d\u4fdd\u8bc1\u6bd4 $O(5000 \\times n + q)$ \u5feb\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(q \\times log_{2}{n})$\n\n```cpp\n#include <random>\n\nnamespace Solution\n{\n    using namespace AKA;\n    using IO::gc; using IO::pc; \n    using IO::iget; using IO::ipr; using IO::iwsp; using IO::iwln;\n    using IO::llget; using IO::llpr; using IO::llwsp; using IO::llwln;\n    using IO::ullget; using IO::ullwsp; using IO::ullwln;\n    using IO::spr; using IO::swsp; using IO::swln;\n\n\n    constexpr int maxn = 16e4 + 5;\n\n    std::mt19937 ri(std::random_device{}());\n    std::uniform_int_distribution<int> lim(1, maxn << 2);\n\n    int size[maxn], ch[maxn][2], pri[maxn], ncnt = 0;\n    struct Val\n    {\n        int v, p;\n        bool operator<(const Val& rhs) const\n        {\n            return v == rhs.v ? p < rhs.p : v < rhs.v;\n        }\n        bool operator==(const Val& rhs) const \n        {\n            return v == rhs.v && p == rhs.p;\n        }\n        bool operator<=(const Val& rhs) const \n        {\n            return (this->operator<(rhs)) || (this->operator==(rhs));\n        }\n        Val(int v__, int p__):\n            v(v__), p(p__) {}\n        Val():\n            Val(0, 0) {}\n    } val[maxn];\n\n\n    inline void update(int x)\n    {\n        size[x] = size[ch[x][0]] + size[ch[x][1]] + 1;\n    }\n\n    inline int mk(int v, int p)\n    {\n        size[++ncnt] = 1;\n        val[ncnt].v = v; \n        val[ncnt].p = p;\n        pri[ncnt] = lim(ri);\n        return ncnt;\n    }\n\n    int merge(int x, int y)\n    {\n        if (!x || !y)\n        {\n            return x + y;\n        }\n        if (pri[x] < pri[y])\n        {\n            ch[x][1] = merge(ch[x][1], y);\n            update(x);\n            return x;\n        }\n        else  \n        {\n            ch[y][0] = merge(x, ch[y][0]);\n            update(y);\n            return y;\n        }\n        return 0;\n    }\n\n    void split(int now, const Val& k, int& x, int& y)\n    {\n        if (!now)\n        {\n            x = y = 0;\n            return ;\n        }\n        if (val[now] <= k)\n        {\n            x = now;\n            split(ch[now][1], k, ch[now][1], y);\n        }\n        else  \n        {\n            y = now;\n            split(ch[now][0], k, x, ch[now][0]);\n        }\n        update(now);\n    }\n\n    int kth(int now, int k)\n    {\n        while (true)\n        {\n            if (k <= size[ch[now][0]])\n            {\n                now = ch[now][0];\n            }\n            else if (k == size[ch[now][0]] + 1)\n            {\n                return now;\n            }\n            else  \n            {\n                k -= size[ch[now][0]] + 1;\n                now = ch[now][1];\n            }\n        }\n        return now;\n    }\n\n    int root;\n\n    int a[maxn];\n\n\n    void main(void)\n    {\n        #ifndef ONLINE_JUDGE\n            std::ifstream cin(\"sort.in\");\n            std::ofstream cout(\"sort.out\");\n            IO::inbuf = cin.rdbuf(); IO::outbuf = cout.rdbuf();\n        #else\n            std::ios::sync_with_stdio(false);\n            using std::cin; using std::cout;\n            #if __cplusplus >= 201103L\n                cin.tie(nullptr); cout.tie(nullptr);\n            #else\n                cin.tie(NULL); cout.tie(NULL);\n            #endif\n            IO::inbuf = cin.rdbuf(); IO::outbuf = cout.rdbuf();\n        #endif\n\n\n        int n = iget(), general_q = iget();\n        int x = 0, y = 0, z = 0;\n\n        for (int i = 1; i <= n; ++i)\n        {\n            a[i] = iget();\n            split(root, Val(a[i], i), x, y);\n            root = merge(merge(x, mk(a[i], i)), y);\n        }\n\n        while (general_q--)\n        {\n            int op = iget(), p = iget();\n            if (op == 1)\n            {\n                int v = iget();\n                split(root, Val(a[p], p), x, z);\n                split(x, Val(a[p], p - 1), x, y);\n                y = merge(ch[y][0], ch[y][1]);\n                root = merge(merge(x, y), z);\n                a[p] = v;\n                split(root, Val(a[p], p), x, y);\n                root = merge(merge(x, mk(a[p], p)), y);\n            }\n            else  \n            {\n                split(root, Val(a[p], p - 1), x, y);\n                iwln(size[x] + 1);\n                root = merge(x, y);\n            }\n        }\n\n\n        #ifndef ONLINE_JUDGE\n            cin.close(); cout.close();\n        #endif\n    }\n} // namespace Solution\n\nint main(int argc, const char* argv[])\n{\n    Solution::main();\n    return 0;\n}\n```\n",
        "postTime": 1635773812,
        "uid": 317805,
        "name": "BootsH",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011P7910 [CSP-J 2021] \u63d2\u5165\u6392\u5e8f"
    },
    {
        "content": "\u7b80\u5316\u9898\u610f\uff1a\u5355\u70b9\u4fee\u6539\uff0c\u533a\u95f4\u67e5\u8be2\u6392\u540d\u3002\n\n\u53ef\u4ee5\u4f7f\u7528\u5206\u5757\u3002\u5177\u4f53\u662f\uff1a\u5355\u70b9\u4fee\u6539\u76f4\u63a5\u4fee\u6539\u503c\u5c31\u884c\u3002\u67e5\u8be2\u65f6\uff0c\u67e5\u8be2 $[1,n]$ \u4e4b\u95f4\u5c0f\u4e8e $a_x$ \u7684\u6570\u7684\u4e2a\u6570 $cnt1$\uff0c\u67e5\u8be2 $[1,x]$ \u4e4b\u95f4\u5c0f\u4e8e\u7b49\u4e8e $a_x$ \u7684\u6570\u7684\u4e2a\u6570 $cnt2$\uff0c\u67e5\u8be2 $[1,x]$ \u4e4b\u95f4\u5c0f\u4e8e $a_x$ \u7684\u6570\u7684\u4e2a\u6570 $cnt3$\u3002\u7b54\u6848\u5c31\u4e3a $cnt1+cnt2-cnt3$\u3002\n\n\u67e5\u8be2\u533a\u95f4\u5c0f\u4e8e$/$\u5c0f\u4e8e\u7b49\u4e8e\uff0c\u53ef\u4ee5\u53e6\u5f00\u4e00\u4e2a\u6570\u7ec4\u5b58\u50a8\u6709\u5e8f\u7684\u6574\u5757\uff0c\u7136\u540e\u5bf9\u6574\u5757\u4e8c\u5206\u67e5\u627e\u6392\u540d\uff0c\u518d\u5728\u6563\u5757\u66b4\u529b\u8ba1\u7b97\u5373\u53ef\u3002\n\n\u65f6\u95f4 $:O(q\\sqrt{n}\\log{\\sqrt{n}})$\u3002\n\ncode\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1e4+10;\nint n,t,q;\nint a[N],A[N];\ninline int read(){\n\tint x=0;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9'){ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=(x<<1)+(x<<3)+(ch^48);ch=getchar();}\n\treturn x;\n}\nvoid write(int x){\n\tif(x>9) write(x/10);\n\tputchar(x%10+48);\n}\nint bh(int x){return (x-1)/t+1;}\nint left(int x){return x*t-t+1;}\nint right(int x){return x*t;}\nint min(int x,int y){return x<y?x:y;}\nint query1(int l,int r,int c){\n\tint i,ret,res=0,X,Y,numl,numr;\n\tnuml=bh(l);numr=bh(r);\n\tfor(i=numl+1;i<=numr-1;i++){\n\t\tX=left(i);Y=right(i);\n\t\tret=lower_bound(A+X,A+Y+1,c)-A-X;\n\t\tret=min(ret,Y-X+1);\n\t\tres+=ret;\n\t}\n\tif(numl==numr){\n\t\tfor(i=l;i<=r;i++) if(a[i]<c) res++;\n\t}\n\telse{\n\t\tfor(i=l;i<=right(numl);i++) if(a[i]<c) res++;\n\t\tfor(i=left(numr);i<=r;i++) if(a[i]<c) res++;\n\t}\n\treturn res;\n}\nint query2(int l,int r,int c){\n\tint i,ret,res=0,X,Y,numl,numr;\n\tnuml=bh(l);numr=bh(r);\n\tfor(i=numl+1;i<=numr-1;i++){\n\t\tX=left(i);Y=right(i);\n\t\tret=upper_bound(A+X,A+Y+1,c)-A-X;\n\t\tret=min(ret,Y-X+1);\n\t\tres+=ret;\n\t}\n\tif(numl==numr){\n\t\tfor(i=l;i<=r;i++) if(a[i]<=c) res++;\n\t}\n\telse{\n\t\tfor(i=l;i<=right(numl);i++) if(a[i]<=c) res++;\n\t\tfor(i=left(numr);i<=r;i++) if(a[i]<=c) res++;\n\t}\n\treturn res;\n}\nint main(){\n\tint i,j,x,v,opt;\n\tn=read();q=read();\n\tt=150;\n\tfor(i=1;i<=n;i++) a[i]=read();\n\tfor(i=1;i<=n;i++) A[i]=a[i];\n\tfor(i=1;i<=bh(n);i++) sort(A+left(i),A+min(n,right(i))+1);\n\tfor(i=1;i<=q;i++){\n\t\topt=read();\n\t\tif(opt==1){\n\t\t\tx=read();v=read();\n\t\t\ta[x]=v;\n\t\t\tfor(j=left(bh(x));j<=right(bh(x));j++) A[j]=a[j];\n\t\t\tsort(A+left(bh(x)),A+min(n,right(bh(x)))+1);\n\t\t}\n\t\tif(opt==2){\n\t\t\tx=read();\n\t\t\twrite(query1(1,n,a[x])+query2(1,x,a[x])-query1(1,x,a[x]));\n\t\t\tprintf(\"\\n\");\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\u53ef\u80fd\u4f1a\u88ab\u5361\u5e38\u3002\n\n\u6b63\u7ecf\u89e3\u6cd5\uff1a\n\n\u6ce8\u610f\u5230\uff1a\u7c7b\u578b $1$ \u7684\u64cd\u4f5c\u4e0d\u4f1a\u8d85\u8fc7 $5000$ \u6b21\u3002\u6240\u4ee5\u53ef\u4ee5\u4ece\u6b64\u5904\u5165\u624b\u3002\n\n\u5bf9\u4e8e\u7c7b\u578b $2$ \u7684\u64cd\u4f5c\uff0c\u5f88\u66b4\u529b\u7684\u65b9\u6cd5\u5c31\u662f\u6392\u4e00\u904d **\u7a33\u5b9a\u6392\u5e8f**\uff0c\u7136\u540e\u627e\u5230\u4e0b\u6807\u3002\n\n\u4f46\u662f\u5982\u679c\u6bcf\u4e00\u6b21\u4fee\u6539\u6570\u540e\u90fd\u6392\u4e00\u904d\u5e8f\uff0c\u90a3\u4e48\u65f6\u95f4\u662f $O(5000q\\log n)$ \u7684\u4f1a\u8d85\u65f6\u3002\n\n\u5982\u679c\u719f\u6089\u63d2\u5165\u6392\u5e8f\u6216\u8005\u5192\u6ce1\u6392\u5e8f\u7684\u4eba\uff0c\u53ef\u4ee5\u5f97\u51fa\u8fd9\u6837\u4e00\u4e2a\u7ed3\u8bba\uff1a**\u5982\u679c\u4e00\u4e2a\u6570\u5217\u4e2d\u53ea\u6709\u4e00\u4e2a\u6570\u662f\u65e0\u5e8f\u7684\uff0c\u53ea\u9700\u8981 $O(n)$\u7684\u65f6\u95f4\u5c31\u53ef\u4ee5\u5b9e\u73b0\u6709\u5e8f**\u3002\u800c\u64cd\u4f5c $1$\uff0c\u6070\u597d\u6bcf\u6b21\u53ea\u4fee\u6539\u4e00\u4e2a\u6570\uff0c\u6240\u4ee5\u4f7f\u7528\u4e00\u6b21\u5192\u6ce1\u6216\u8005\u63d2\u5165\uff0c\u5c31\u53ef\u4ee5\u7ef4\u62a4\u6570\u5217\u7684\u6709\u5e8f\u6027\u3002\n\n\u4f46\u662f\u6b64\u65f6\u53c8\u4f1a\u5b58\u5728\u4e00\u4e2a\u5c0f\u95ee\u9898\uff1a\u5982\u4f55\u53bb\u627e\u5230\u8fd9\u4e2a $a_x$ \uff1f\u56e0\u4e3a\u5df2\u7ecf\u8ba9\u6570\u5217\u6709\u5e8f\u4e86\uff0c\u6240\u4ee5\u6570\u5217\u4e2d\u7684\u7b2cx\u4e2a\u5143\u7d20\u5e76\u4e0d\u662f\u8fd9\u4e2a $a_x$\u3002\u89e3\u51b3\u65b9\u6cd5\u662f\u53ef\u4ee5\u589e\u52a0\u4e00\u4e2a\u6570\u7ec4 $xb_i$\uff0c\u8868\u793a\u6709\u5e8f\u7684\u6570\u5217\u4e2d\u7b2ci\u4e2a\u5143\u7d20\u7684\u539f\u6765\u7684\u4e0b\u6807\u662f\u591a\u5c11\u3002\u6bcf\u4e00\u6b21\u4fee\u6539\u65f6\u53bb\u627e\u5230\u8fd9\u4e2a\u4e0b\u6807\u5c31\u884c\u3002\u65f6\u95f4\u4e5f\u662f $O(n)$\u3002\n\n\u7efc\u4e0a\uff1a\u65f6\u95f4\u590d\u6742\u5ea6 $:O(5000n+q)$\n\ncode:\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=8e3+10;\nstruct node{\n\tint a,xb;\n}q[N];\nint n,t,ans[N];\ninline int read(){\n\tint x=0;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9') ch=getchar();\n\twhile(ch>='0'&&ch<='9'){x=(x<<1)+(x<<3)+(ch^48);ch=getchar();}\n\treturn x;\n}\nvoid write(int x){\n\tif(x>9)write(x/10);\n\tputchar(x%10+48);\n}\nbool cmp(node x,node y){\n\tif(x.a==y.a) return x.xb<y.xb;\n\treturn x.a<y.a;\n}\nint main(){\n\tint i,j,k,x,v,opt;\n\tn=read();t=read();\n\tfor(i=1;i<=n;i++){q[i].a=read();q[i].xb=i;} \n\tsort(q+1,q+1+n,cmp);\n\tfor(i=1;i<=n;i++) ans[q[i].xb]=i;\n\tfor(i=1;i<=t;i++){\n\t\topt=read();x=read();\n\t\tif(opt==1){\n\t\t\tv=read();\n\t\t\tfor(j=1;j<=n;j++){\n\t\t\t\tif(q[j].xb==x){\n\t\t\t\t\tq[j].a=v;\n\t\t\t\t\tfor(k=1;k<n;k++)\n\t\t\t\t\t\tif(q[k].a>q[k+1].a){ans[q[k].xb]=k+1;ans[q[k+1].xb]=k;swap(q[k],q[k+1]);}\n\t\t\t\t\t\telse if(q[k].a==q[k+1].a&&q[k+1].xb<q[k].xb){ans[q[k].xb]=k+1;ans[q[k+1].xb]=k;swap(q[k],q[k+1]);} \n\t\t\t\t\tfor(k=n;k>1;k--)\n\t\t\t\t\t\tif(q[k].a<q[k-1].a){ans[q[k].xb]=k-1;ans[q[k-1].xb]=k;swap(q[k],q[k-1]);}\n\t\t\t\t\t\telse if(q[k].a==q[k-1].a&&q[k].xb<q[k-1].xb){ans[q[k].xb]=k-1;ans[q[k-1].xb]=k;swap(q[k],q[k-1]);}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(opt==2){write(ans[x]);printf(\"\\n\");}\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1635401396,
        "uid": 225100,
        "name": "ice_in_sky",
        "ccfLevel": 0,
        "title": "P7910 [CSP-J 2021] \u63d2\u5165\u6392\u5e8f"
    },
    {
        "content": "\u8fd9\u9898\u4e00\u773c\u770b\u4e0b\u6765\u662f\u4e2a\u6570\u636e\u7ed3\u6784\u9898\uff0c\u51fa\u5230\u5165\u95e8\u7ec4T2\u611f\u89c9\u5f88\u602a\uff0c\u6700\u540e\u53d1\u73b0\u4fee\u6539\u64cd\u4f5c\u4e0d\u8d85\u8fc7 $5000$\u3002\n\n$2$ \u64cd\u4f5c\u6c42\u7684\u662f\u6bcf\u4e2a\u4f4d\u7f6e\u7684\u6392\u540d\uff08rank\uff09\uff0c\u6ce8\u610f\u76f8\u7b49\u65f6\u4f4d\u7f6e\u5c0f\u7684\u6570\u6392\u540d\u66f4\u5c0f\uff08\u8fd9\u662f\u6839\u636e\u9898\u4e2d\u7ed9\u51fa\u7684\u4ee3\u7801\u5206\u6790\u5f97\u5230\u7684\uff09\u3002\n\n\u4e00\u4e2a\u6b63\u5e38\u601d\u7ef4\u662f\u7528\u5e73\u8861\u6811\u6765\u505a\uff0c\u6bcf\u4e2a\u5143\u7d20\u4e3a\u4e00\u4e2a`std::pair<int,int>`\uff0c\u6bcf\u6b211\u64cd\u4f5c\u53ea\u662f\u5220\u9664\u4e00\u4e2a\u5143\u7d20\uff0c\u7136\u540e\u518d\u63d2\u5165\u4e00\u4e2a\u5143\u7d20\u3002\n\n\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6 $O((n+q)\\log n)$ \uff0c\u7528 PDBS \u7684\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```c++\n#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/pb_ds/tree_policy.hpp>\nusing namespace __gnu_pbds;\n#define TR tree<pair<int, int>, null_type, less<pair<int, int>>, rb_tree_tag, tree_order_statistics_node_update>\nint a[N];\nTR se;\nint main() {\n    int n, m;\n    scanf(\"%d%d\", &n, &m);\n    for (int i = 1; i <= n; i++) {\n        scanf(\"%d\", &a[i]);\n        se.insert({a[i], i});\n    }\n    while (m--) {\n        int op, x, y;\n        scanf(\"%d\", &op);\n        if (op == 1) {\n            scanf(\"%d%d\", &x, &y);\n            se.erase({a[x], x});\n            a[x] = y;\n            se.insert({a[x], x});\n        } else {\n            scanf(\"%d\", &x);\n            printf(\"%d\\n\", se.order_of_key({a[x], x}) + 1);\n        }\n    }\n    return 0;\n}\n```\n\n\u660e\u663e\u53ef\u4ee5\u79bb\u7ebf\u505a\uff0c\u5f53\u7136\u5c31\u53ef\u4ee5\u79bb\u6563\u5316\u540e\u7528\u6811\u72b6\u6570\u7ec4/\u7ebf\u6bb5\u6811\u6765\u89e3\u51b3\u8fd9\u4e2a\u6c42rank\u7684\u95ee\u9898\u3002\u8003\u8651\u5230\u662f\u5165\u95e8\u7ec4\u7684\u6bd4\u8d5b\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4e0d\u7528\u6570\u636e\u7ed3\u6784\uff0c\u6539\u7528\u5206\u6cbb\u6765\u89e3\u51b3\uff08~~\u8fd9\u5c31\u5f88\u7b26\u5408\u5927\u7eb2\u4e86~~\uff09\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O((n+q)\\log(n+q))$\u3002\n\n\u7b2c\u4e00\u7ef4\u65f6\u95f4\u5929\u7136\u6709\u5e8f\uff0c\u7b2c\u4e8c\u7ef4\u662f\u5143\u7d20\u5927\u5c0f`pair<int,int>`\uff0c\u5206\u6cbb\u7684\u65f6\u5019\u5bf9\u5176\u505a\u5f52\u5e76\uff0c\u6c42\u51fa\u6bcf\u4e2a\u533a\u95f4\u5de6\u534a\u90e8\u5206\u7684\u4fee\u6539\u64cd\u4f5c\u5bf9\u53f3\u534a\u90e8\u5206\u8be2\u95ee\u7684\u8d21\u732e\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```c++\nstruct Node {\n    int x, y, id;\n    bool operator<(const Node &rhs) const {\n        if (x == rhs.x) {\n            if (y == rhs.y) return id < rhs.id;\n            return y < rhs.y;\n        }\n        return x < rhs.x;\n    }\n} a[N];\nint c[N];\nint ans[N];\n\nvoid solve(int l, int r) {\n    if (l == r) return;\n    int mid = (l + r) / 2;\n    solve(l, mid);\n    solve(mid + 1, r);\n    int p1 = l, p2 = mid + 1, len = r - l + 1;\n    int now = 0;\n    for (int i = 0; i < len; i++) {\n        if (p1 <= mid && (p2 > r || a[p1] < a[p2])) {\n            if (a[p1].id == -1) now--;\n            if (a[p1].id == 0) now++;\n            p1++;\n        } else {\n            if (a[p2].id > 0) ans[a[p2].id] += now;\n            p2++;\n        }\n    }\n    inplace_merge(a + l, a + mid + 1, a + r + 1);\n}\nint main() {\n    int n, m;\n    scanf(\"%d%d\", &n, &m);\n    int tot = 0;\n    for (int i = 1; i <= n; i++) {\n        scanf(\"%d\", &c[i]);\n        a[++tot] = {c[i], i, 0};\n    }\n    int qid = 0;\n    for (int i = 1; i <= m; i++) {\n        int op, x, y;\n        scanf(\"%d\", &op);\n        if (op == 1) {\n            scanf(\"%d%d\", &x, &y);\n            a[++tot] = {c[x], x, -1};\n            c[x] = y;\n            a[++tot] = {c[x], x, 0};\n        } else {\n            scanf(\"%d\", &x);\n            a[++tot] = {c[x], x, ++qid};\n        }\n    }\n    solve(1, tot);\n    for (int i = 1; i <= qid; i++) {\n        printf(\"%d\\n\", ans[i]);\n    }\n    return 0;\n}\n```\n\n\u5f53\u7136\u8fd9\u9898\u6b63\u89e3\u65f6\u95f4\u590d\u6742\u5ea6\u5e94\u8be5\u4e3a $O(n\\log n+5000n+q)$\uff0c\u5c31\u662f\u6700\u521d\u6392\u5e8f\u4f9d\u6b21\uff0c\u7136\u540e\u5bf9\u6bcf\u4e2a\u4fee\u6539\uff0c\u66b4\u529b $O(n)$ \u8c03\u4e00\u4e0b\u4f4d\u7f6e\uff0c\u5bf9\u6bcf\u4e2a\u67e5\u8be2\u5c31\u53ef\u4ee5 $O(1)$ \u5f97\u5230\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```c++\npair<int, int> a[N];\nint b[N];// \u539f\u6765\u6bcf\u4e2a\u4f4d\u7f6e\u7684\u6570\u5f53\u524d\u7684\u4f4d\u7f6e\n\nint main() {\n    int n, m;\n    scanf(\"%d%d\", &n, &m);\n    for (int i = 1; i <= n; i++) {\n        scanf(\"%d\", &a[i].first);\n        a[i].second = i;\n    }\n    sort(a + 1, a + n + 1);\n    for (int i = 1; i <= n; i++) b[a[i].second] = i;\n    while (m--) {\n        int op, x, y;\n        scanf(\"%d\", &op);\n        if (op == 1) {\n            scanf(\"%d%d\", &x, &y);\n            a[b[x]].first = y;\n            for (int i = 1; i < n; i++) {\n                if (a[i] > a[i + 1]) swap(a[i], a[i + 1]);\n            }\n            for (int i = n - 1; i >= 1; i--) {\n                if (a[i] > a[i + 1]) swap(a[i], a[i + 1]);\n            }\n            for (int i = 1; i <= n; i++) b[a[i].second] = i;\n        } else {\n            scanf(\"%d\", &x);\n            printf(\"%d\\n\", b[x]);\n        }\n    }\n    return 0;\n}\n```\n\n",
        "postTime": 1635743617,
        "uid": 54357,
        "name": "OMG_wc",
        "ccfLevel": 0,
        "title": "[CSP-J 2021] \u63d2\u5165\u6392\u5e8f\u9898\u89e3"
    },
    {
        "content": "#### \u89e3\u9898\u601d\u8def\n\n\u65b0\u5f00\u4e24\u4e2a\u6570\u7ec4\uff0c\u4e00\u4e2a\u8868\u793a\u6392\u5b8c\u5e8f\u540e\u7684\u7ed3\u679c\uff0c\u53e6\u4e00\u4e2a\u8868\u793a\u6392\u5e8f\u540e\u6bcf\u4e2a\u6570\u7684\u4f4d\u7f6e\u3002\n\n\u6bcf\u6b21\u4fee\u6539\u7684\u65f6\u5019\u91cd\u65b0\u6392\u5e8f\u5e76\u66f4\u65b0\u4f4d\u7f6e\u3002\n\n\u82e5\u76f4\u63a5\u4f7f\u7528 `sort`\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(5000n\\log n)$\uff0c\u53ef\u80fd\u4f1a\u8d85\u65f6\u3002\n\n\u4f46\u7531\u4e8e\u4ec5\u4ec5\u4fee\u6539\u4e86\u4e00\u4e2a\u6570\u5b57\uff0c\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u6570\u5b57\u5728\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$ \u5c06\u8fd9\u4e2a\u6570\u63d2\u5165\u6392\u5b8c\u5e8f\u7684\u6570\u7ec4\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u964d\u4e3a $O(5000n)$\uff0c\u53ef\u901a\u8fc7\u672c\u9898\u3002\n\n#### \u4ee3\u7801\n\n```c++\n#include<bits/stdc++.h>\nusing namespace std;\nstruct node{\n\tint num,p;\n\tbool operator < (const node& nd) const {\n\t\tif(num==nd.num) return p<nd.p;\n\t\treturn num<nd.num;\n\t}\n}b[8005];\nint t[8005],n,q,a[8005];\nvoid qsort() {\n\tfor(int i=1;i<=n;++i)\n\t\tb[i].num=a[i],b[i].p=i;\n\tsort(b+1,b+n+1);\n\tfor(int i=1;i<=n;++i) t[b[i].p]=i;\n}\nvoid upd(int x,int y) {\n\tb[t[x]].num=y;\n\tfor(int i=1;i<=n+1;++i) {\n\t\tif(b[t[x]]<b[i]) {\n\t\t\tif(i<t[x]) {\n\t\t\t\tfor(int j=t[x];j>i;--j) {\n\t\t\t\t\tb[j]=b[j-1];\n\t\t\t\t}\n\t\t\t\tb[i].num=y,b[i].p=x;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor(int j=t[x];j<i-1;++j) {\n\t\t\t\t\tb[j]=b[j+1];\n\t\t\t\t}\n\t\t\t\tb[i-1].num=y,b[i-1].p=x;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor(int i=1;i<=n;++i) t[b[i].p]=i;\n}\nint main() {\n\tscanf(\"%d%d\",&n,&q);\n\tfor(int i=1;i<=n;++i) scanf(\"%d\",&a[i]);\n\tqsort();\n\tb[n+1].num=0x3f3f3f3f,b[n+1].p=n+1;\n\twhile(q--) {\n\t\tint op,x,y;\n\t\tscanf(\"%d\",&op);\n\t\tif(op==1) {\n\t\t\tscanf(\"%d%d\",&x,&y);\n\t\t\ta[x]=y;\n\t\t\tupd(x,y);\n\t\t}\n\t\telse {\n\t\t\tscanf(\"%d\",&x);\n\t\t\tprintf(\"%d\\n\",t[x]);\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1636024201,
        "uid": 369836,
        "name": "\u9cb6\u9c7c\u7684\u5fe0\u5b9e\u7c89",
        "ccfLevel": 7,
        "title": "P7910"
    },
    {
        "content": "**upd\uff1a\u4fee\u6539\u90e8\u5206\u8868\u8ff0\u3002**\n\n\u89c2\u5bdf\u6570\u636e\u8303\u56f4\uff0c\u53d1\u73b0\u7ed9\u7684 $n$ \u662f\u5e73\u65b9\u7ea7\u522b\u7684\u6570\u636e\u8303\u56f4\u3002\n\n\u4f46\u662f $q$ \u662f\u7ebf\u6027\u6216\u8005\u5e26\u4e00\u4e2a $\\log$ \u7684\u8303\u56f4\uff0c\u4e8e\u662f\u53c8\u89c2\u5bdf\u5230\u64cd\u4f5c $1$ \u7684\u6267\u884c\u6b21\u6570 $\\le5000$ \u6b21\u3002\n\n\u6240\u4ee5\u8bf4\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\uff1a\n\n\u6bcf\u6b21\u64cd\u4f5c $1$ \u4e4b\u540e\u7ebf\u6027\u626b\u63cf\u4e00\u904d\uff0c\u4e4b\u540e $O(1)$ \u6216\u8005 $O(\\log)$ \u67e5\u8be2\u7b54\u6848\u662f\u6211\u4eec\u53ef\u4ee5\u63a5\u53d7\u7684\u590d\u6742\u5ea6\u3002\n\n\u9996\u5148\u8003\u8651\u64cd\u4f5c $1$ \u4e4b\u540e\uff0c\u7ed9\u6211\u4eec\u5e26\u6765\u7684\u5f71\u54cd\u662f\u4e00\u904d\u6392\u5e8f\uff0c\u800c\u5df2\u77e5\u6700\u4f18\u6392\u5e8f\u662f $O(n\\log n)$\uff0c\u7b80\u5355\u7b97\u4e00\u4e0b\u4e4b\u540e\u53d1\u73b0\u4e0d\u592a\u80fd\u8fc7\u3002\n\n**\u8003\u8651\u6876\u6392**\uff0c\u5982\u679c\u6211\u4eec\u628a\u6709\u8d21\u732e\u7684\u6570\u5b57\u79bb\u7ebf\u4e0b\u6765\uff0c\u9876\u591a\u4e0d\u4f1a\u8d85\u8fc7 $8000+5000=13000$ \u4e2a\u6570\uff0c\u8bb0\u4e3a $k$\uff0c\u4e5f\u5c31\u662f\u8bf4 $k\\le13000$\u3002\n\n\u7136\u540e\u79bb\u6563\u5316\u4e00\u4e0b\u53ef\u4ee5\u7f29\u5c0f\u503c\u57df\uff0c\u81f3\u6b64\u6211\u4eec\u6bcf\u6b21\u64cd\u4f5c $1$ \u4e4b\u540e\u662f $O(k)$ \u7684\u590d\u6742\u5ea6\u5c31\u80fd\u6392\u5e8f\u5b8c\u6574\u4e2a\u5e8f\u5217\u3002\n\n\u6ce8\u610f\u5230\u8fd9\u4e2a\u6709\u91cd\u590d\u5143\u7d20\uff0c\u6240\u4ee5\u518d\u591a\u8bb0\u5f55\u4e00\u4e9b\u4fe1\u606f\u5c31\u597d\u4e86\u3002\n\n\u5177\u4f53\u800c\u8a00\uff0c\u9700\u8981\u77e5\u9053\u6bcf\u4e2a\u6570\u5b57\u5728\u5bf9\u5e94\u4f4d\u7f6e\u4e0a\u662f\u7b2c\u51e0\u6b21\u51fa\u73b0\uff0c\u8fd8\u662f\u7531\u4e8e $n\\le8000$ \u6240\u4ee5\u8fd9\u4e9b\u4fe1\u606f\u5168\u90e8\u90fd\u53ef\u4ee5\u7ebf\u6027\u626b\u63cf\u7ef4\u62a4\uff0c\u6bcf\u6b21\u64cd\u4f5c\u5168\u90e8\u66f4\u65b0\u4e00\u904d\uff0c\u8fd9\u5c31\u4e0d\u96be\u4e86\u3002\n\n\u8be6\u89c1\u4ee3\u7801\u3002\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define findb(x) std::lower_bound(b+1,b+1+len,x)-(b)\n#define findc(x) std::lower_bound(c+1,c+1+c[0],x)-(c)\ninline int in();\ninline void wr(int);\nconst int N=(int)8e3+5,M=(int)5e3+5,K=(int)2e5+5;\nint a[N],b[N+M],c[N];\nstruct Node{\n\tint tp,x,v;\n}s[K];\nint tong[N+M],len,times[N+M],pos[N];\n// times[i]: i \u51fa\u73b0\u4e86\u51e0\u6b21\n// pos[i]: a[i] \u7b2c\u51e0\u6b21\u51fa\u73b0\ninline void translate();\nint main(int argc,char**argv){\n#ifndef ONLINE_JUDGE\n\tfreopen(\"7910.in\",\"r\",stdin);\n\tfreopen(\"7910.out\",\"w\",stdout);\n#endif\n\tregister int n=in(),q=in();\n\tfor(register int i=1;i<=n;++i)\n\t\tb[i]=a[i]=in();\n\tlen=n;\n\tfor(register int i=1;i<=q;++i){\n\t\ts[i].tp=in();\n\t\tif(s[i].tp==1){\n\t\t\ts[i].x=in(),s[i].v=in();\n\t\t\tb[++len]=s[i].v;\n\t\t}\n\t\telse\n\t\t\ts[i].x=in();\n\t}\n\tstd::stable_sort(b+1,b+1+len);\n\tlen=std::unique(b+1,b+1+len)-(b+1);\n\tfor(register int i=1;i<=n;++i)\n\t\ta[i]=findb(a[i]);\n\tfor(register int i=1;i<=q;++i)\n\t\tif(s[i].tp==1)\n\t\t\ts[i].v=findb(s[i].v);\n\tfor(register int i=1;i<=n;++i)\n\t\t++tong[a[i]];\n\tmemset(times,0,sizeof(times));\n\tfor(register int i=1;i<=n;++i)\n\t\tpos[i]=++times[a[i]];\n\ttranslate();\n\tfor(register int i=1;i<=q;++i)\n\t\tif(s[i].tp==2){\n\t\t\t// \u67e5\u8be2\n\t\t\tregister int id=findc(a[s[i].x]);\n\t\t\twr(id+pos[s[i].x]-1),putchar('\\n');\n\t\t\t//  1 2 3 4 5\n\t\t\t//  5 5 5 5 5\n\t\t\t//  ^\n\t\t}\n\t\telse{\n\t\t\t// \u4fee\u6539\n\t\t\t--tong[a[s[i].x]];\n\t\t\ta[s[i].x]=s[i].v;\n\t\t\t++tong[a[s[i].x]];\n\t\t\tmemset(times,0,sizeof(times));\n\t\t\tfor(register int i=1;i<=n;++i)\n\t\t\t\tpos[i]=++times[a[i]];\n\t\t\ttranslate();\n\t\t}\n}\ninline void translate(){\n\tc[0]=0;\n\tfor(register int i=1;i<=len;++i){\n\t\tregister int x=tong[i];\n\t\twhile(x--)\n\t\t\tc[++c[0]]=i;\n\t}\n}\ninline int in(){\n\tregister char c=getchar();\n\tregister int x=0,f=1;\n\tfor(;c<'0'||c>'9';c=getchar())\n\t\tif(c=='-')f=-1;\n\tfor(;c>='0'&&c<='9';c=getchar())\n\t\tx=(x<<1)+(x<<3)+(c&15);\n\treturn x*f;\n}\ninline void wr(int x){\n\tif(x<0)putchar('-'),x=-x;\n\tif(x/10)wr(x/10);\n\tputchar(x%10+'0');\n}\n```",
        "postTime": 1635732590,
        "uid": 50606,
        "name": "\u8a00\u7422\u10d3",
        "ccfLevel": 6,
        "title": "\u3010\u9898\u89e3\u3011P7910 [CSP-J 2021] \u63d2\u5165\u6392\u5e8f"
    },
    {
        "content": "# 0x00 \u601d\u8def\n\uff08\u6b64\u5904\u7701\u53bb\u524d\u9762\u7684\u4e00\u5927\u5806\u65e0\u7528\u63cf\u8ff0\uff09\n>H \u8001\u5e08\u7ed9\u4e86\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6570\u7ec4 $a$\uff0c\u6570\u7ec4\u4e0b\u6807\u4ece $1$ \u5f00\u59cb\uff0c\u5e76\u4e14\u6570\u7ec4\u4e2d\u7684**\u6240\u6709\u5143\u7d20\u5747\u4e3a\u975e\u8d1f\u6574\u6570**\u3002\u5c0f Z \u9700\u8981\u652f\u6301\u5728\u6570\u7ec4 $a$ \u4e0a\u7684 $Q$ \u6b21\u64cd\u4f5c\uff0c\u64cd\u4f5c\u5171\u4e24\u79cd\uff0c\u53c2\u6570\u5206\u522b\u5982\u4e0b\uff1a\n\n>$1~x~v$\uff1a\u5c06 $a$ \u7684\u7b2c $x$ \u4e2a\u5143\u7d20\u4fee\u6539\u4e3a $v$\u3002\u4fdd\u8bc1 $1 \\le x \\le n$\uff0c$1 \\le v \\le 10^9$ \u3002\u6ce8\u610f\u8fd9\u79cd\u64cd\u4f5c**\u4f1a**\u6539\u53d8\u6570\u7ec4\u7684\u5143\u7d20\uff0c\u4fee\u6539\u5f97\u5230\u7684\u6570\u7ec4\u4f1a\u88ab\u4fdd\u7559\uff0c\u4e5f\u4f1a\u5f71\u54cd\u540e\u7eed\u7684\u64cd\u4f5c\u3002\n\n>$2~x$\uff1a\u5047\u8bbe H \u8001\u5e08**\u6309\u7167\u4e0a\u9762\u7684\u4f2a\u4ee3\u7801**\u5bf9 $a$ \u6570\u7ec4\u8fdb\u884c\u6392\u5e8f\uff0c\u4f60\u9700\u8981\u544a\u8bc9 H \u8001\u5e08\u539f\u6765 $a$ \u7684**\u7b2c $x$ \u4e2a\u5143\u7d20**\u5728\u6392\u5e8f\u540e\u7684\u65b0\u6570\u7ec4\u6240\u5904\u7684\u4f4d\u7f6e\u3002\u4fdd\u8bc1 $1 \\le x \\le n$\u3002\u6ce8\u610f\u8fd9\u79cd\u64cd\u4f5c**\u4e0d\u4f1a**\u6539\u53d8\u6570\u7ec4\u7684\u5143\u7d20\uff0c\u6392\u5e8f\u540e\u7684\u6570\u7ec4\u4e0d\u4f1a\u88ab\u4fdd\u7559\uff0c\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u540e\u7eed\u7684\u64cd\u4f5c\u3002\n\n>H \u8001\u5e08\u4e0d\u559c\u6b22\u8fc7\u591a\u7684\u4fee\u6539\uff0c\u6240\u4ee5\u4ed6\u4fdd\u8bc1**\u7c7b\u578b $1$ \u7684\u64cd\u4f5c\u6b21\u6570\u4e0d\u8d85\u8fc7 $5000$**\u3002\n\n\u90a3\u4e48\u8fd9\u91cc\u6211\u4eec\u53d1\u73b0\u5b83\u63d0\u5230\u4e86\u524d\u9762\u7684\u4f2a\u4ee3\u7801\uff0c\u5373\n```c\nC/C++:\nfor (int i = 1; i <= n; i++)\n\tfor (int j = i; j >= 2; j--)\n\t\tif (a[j] < a[j-1]) {\n\t\t\tint t = a[j-1];\n\t\t\ta[j-1] = a[j];\n\t\t\ta[j] = t;\n\t\t}\n\nJava:\nfor i:=1 to n do\n\tfor j:=i downto 2 do\n\t\tif a[j]<a[j-1] then\n\t\t\tbegin\n\t\t\t\tt:=a[i];\n\t\t\t\ta[i]:=a[j];\n\t\t\t\ta[j]:=t;\n\t\t\tend;\n```\n\u800c\u8fd9\u4e2a\u6392\u5e8f\u65b9\u6cd5\u662f\u628a\u6574\u4e2a\u6570\u7ec4**\u4ece\u5c0f\u5230\u5927**\u8fdb\u884c\u6392\u5e8f\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u505a\u8fd9\u9053\u9898\u7684\u65f6\u5019\u4e5f\u5e94\u8be5**\u4ece\u5c0f\u5230\u5927**\u8fdb\u884c\u6392\u5e8f\u3002\n\n\n\u5982\u679c\u4f60\u60f3\u8981**\u8001\u8001\u5b9e\u5b9e**\u5730\u7528\u63d2\u5165\u6392\u5e8f\u5e76\u4e14**\u6bcf\u4e00\u6b21\u8be2\u95ee**\u90fd\u8981\u8fdb\u884c\u67e5\u627e\uff0c\u90a3\u4e48\u4f60\u4e00\u5b9a\u4f1a TLE\u3002\n\n\u63a5\u7740\uff0c\u6211\u4eec\u53d1\u73b0\u4e86\u8fd9\u53e5\u8bdd\uff1a\n>H \u8001\u5e08\u4e0d\u559c\u6b22\u8fc7\u591a\u7684\u4fee\u6539\uff0c\u6240\u4ee5\u4ed6\u4fdd\u8bc1**\u7c7b\u578b $1$ \u7684\u64cd\u4f5c\u6b21\u6570\u4e0d\u8d85\u8fc7 $5000$**\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u4fee\u6539\u64cd\u4f5c\u6b21\u6570**\u6700\u591a**\u4e3a $5000$ \u6b21\u3002\u90a3\u4e48\u5269\u4e0b\u7684\u64cd\u4f5c**\u4e00\u5b9a\u90fd\u662f**\u67e5\u8be2\u64cd\u4f5c\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u5e94\u8be5\u5bf9\u67e5\u8be2\u8fdb\u884c\u4f18\u5316\uff08\u4e0d\u5e94\u5728\u6bcf\u6b21**\u8be2\u95ee**\u7684\u65f6\u5019\u8fdb\u884c\u6392\u5e8f\uff0c\u800c\u5e94\u8be5\u5728**\u4fee\u6539\u65f6**\u8fdb\u884c\u6392\u5e8f\uff09\u3002\n# 0x01 \u4f18\u5316\n\u65e2\u7136\u6211\u4eec\u8981\u4f18\u5316**\u65f6\u95f4**\uff0c\u90a3\u4e48\u6211\u4eec\u80af\u5b9a\u9700\u8981\u66f4\u591a\u7684**\u7a7a\u95f4**\u8fdb\u884c\u4ea4\u6362\u3002\uff08\u7b97\u6cd5\u867d\u7136\u4e5f\u6709\u53ef\u80fd\uff0c\u4f46\u662f\u8fd9\u91cc\u6211\u4eec\u4e0d\u597d\u8fdb\u884c\u4f18\u5316\u3002\uff09\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u60f3\u5230\u5c06\u6bcf\u4e00\u4e2a\u6570\u5728\u63d2\u6392\u540e\u7684\u4f4d\u7f6e\u8fdb\u884c\u8bb0\u5f55\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u505a\u5230\u4e86\u6bcf\u4e00\u6b21\u67e5\u8be2\u65f6\u95f4\u4e3a $O(1)$ \u7684\u6781\u5927\u4f18\u5316\u3002\u5f53\u7136\u5728\u6211\u4eec\u8bb0\u5f55\u4f4d\u7f6e\u7684\u65f6\u5019\u80af\u5b9a\u4e0d\u53ef\u80fd\u6392\u4e00\u6b21\u5168\u90e8\u5237\u65b0\u4e00\u6b21\u3002\n\n\u6839\u636e\u5b9e\u9a8c\uff0c\u6211\u4eec\u5237\u65b0\u7684**\u4ec5\u4ec5\u53ea\u662f**\u5f53\u524d\u88ab\u4fee\u6539\u7684\u6570\u548c\u4e0e\u5b83\u4ea4\u6362\u8fc7\u7684\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u63d2\u5165\u6392\u5e8f\u65f6\u53ef\u4ee5\u8fb9\u6392\u8fb9\u66f4\u65b0\u503c\u3002\n\n\u56e0\u6b64\u6211\u4eec\u7684\u65f6\u95f4\u7684\u6700\u5927\u4e3a $O(5000\\times n+Q)$\u3002\n\n# code\n```c\n#include<bits/stdc++.h>\nusing namespace std;\ninline void qr(int &ret){int x=0,f=0;char ch;ch=getchar();while(ch<'0'||ch>'9')f|=ch=='-',ch=getchar();while(ch>='0'&&ch<='9')x=(x<<3)+(x<<1)+(ch^48),ch=getchar();ret=f?-x:x;return;}\n//\u5feb\u8bfb\uff0c\u53ef\u4ee5\u4e0d\u770b\u3002\n\ntypedef struct N\n{\n\tint id,num;\n}NUMBER;//\u9700\u8981\u8bb0\u5f55\u6b64\u4f4d\u7f6e\u6570\u5b57\u7684\u503c\u548c\u7f16\u53f7\uff0c\u597d\u8fdb\u884c\u66f4\u65b0\nNUMBER a[8005];\nint num[8005],wei[8005]/*\u6b64\u7f16\u53f7\u7684\u6570\u5b57\u6240\u5728\u4f4d\u7f6e*/;\nbool cmp(NUMBER a,NUMBER b)\n{\n//\u4ece\u5c0f\u5230\u5927\u8fdb\u884c\u6392\u5e8f\uff0c\u82e5\u6570\u503c\u76f8\u7b49\u5fc5\u987b\u5c06\u7f16\u53f7\u5c0f\u7684\u653e\u5728\u524d\u9762\n\tif(a.num==b.num)\n\t\treturn a.id<b.id;\n\treturn a.num<b.num;\n}\nint main()\n{\n// \tfreopen(\"sort.in\",\"r\",stdin);\n// \tfreopen(\"sort.out\",\"w\",stdout);\n\tint n,i,Q,q,x,v;\n\tqr(n),qr(Q);\n\tfor(i=1;i<=n;i++)\n\t{\n\t\tqr(num[i]);\n\t\ta[i].num=num[i];\n\t\ta[i].id=i;\n\t}\n\tsort(a+1,a+1+n,cmp);//\u5148\u5c06\u5176\u53d8\u6210\u6709\u5e8f\u5e8f\u5217\n\tfor(i=1;i<=n;i++)//\u521d\u59cb\u5316\u4f4d\u7f6e\n\t\twei[a[i].id]=i;\n\tfor(i=1;i<=Q;i++)\n\t{\n\t\tqr(q);\n\t\tif(q==1)//\u4fee\u6539\u64cd\u4f5c\n\t\t{\n\t\t\tqr(x),qr(v);\n\t\t\tnum[x]=v;\n\t\t\ta[wei[x]].num=v;\n\t\t\tint j=wei[x]+1;\n\t\t\tNUMBER t=a[wei[x]];\n\t\t\t//\u63d2\u5165\u6392\u5e8f\n\t\t\twhile(j<=n&&(a[j].num<v||(a[j].num==v&&a[j].id<x)))//\u5f80\u540e\u63d2\n\t\t\t{\n\t\t\t\twei[a[j].id]--;\n\t\t\t\ta[j-1]=a[j];\n\t\t\t\ta[j]=t;\n\t\t\t\tj++;\n\t\t\t}\n//\t\t\tputs(\"Aaa\");\n\t\t\tif(j-1==wei[x])//\u5f80\u524d\u63d2\n\t\t\t{\n\t\t\t\tj=wei[x]-1;\n\t\t\t\twhile(j>0&&(a[j].num>v||(a[j].num==v&&a[j].id>x)))\n\t\t\t\t{\n\t\t\t\t\twei[a[j].id]++;\n\t\t\t\t\ta[j+1]=a[j];\n\t\t\t\t\ta[j]=t;\n\t\t\t\t\tj--;\n\t\t\t\t}\n\t\t\t\twei[x]=j+1;\n\t\t\t}\n\t\t\telse//\u4fee\u6539\u5728\u524d\u9762\u6ca1\u6709\u6539\u6389\u7684\u503c\n\t\t\t\twei[x]=j-1;\n//\t\t\tfor(i=1;i<=n;i++)\n//\t\t\t\tprintf(\"%d:%d %d\\n\\n\",i,a[i].id,wei[a[i].id]);\n\t\t}\n\t\tif(q==2)//\u67e5\u8be2\u64cd\u4f5c\uff0c\u6709\u4ec0\u4e48\u597d\u8bf4\u7684\n\t\t{\n\t\t\tqr(x);\n\t\t\tprintf(\"%d\\n\",wei[x]);\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1635238861,
        "uid": 465692,
        "name": "Harry_Hedwig",
        "ccfLevel": 6,
        "title": "P7910 [CSP-J 2021] \u63d2\u5165\u6392\u5e8f \u9898\u89e3"
    }
]
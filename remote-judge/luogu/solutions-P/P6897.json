[
    {
        "content": "## Link\n\n[[ICPC2014 WF]Messenger](https://www.luogu.com.cn/problem/P6897)\n\n## Solution\n\n~~\u54b3\u54b3\u54b3\uff0c\u4e3a\u5565ICPC\u8fd9\u4e48\u559c\u6b22\u51e0\u4f55\u9898~~\n\n\u8a00\u5f52\u6b63\u4f20\uff0c\u6211\u4eec\u5206\u6790\u4e0b\u8fd9\u9053\u9898\u76ee\u3002\n\n\u663e\u7136\u8fd9\u9898\u7684\u8ba1\u7b97\u51e0\u4f55\u90e8\u5206\u4e0d\u662f\u91cd\u70b9\uff0c\u90a3\u4e48\u6211\u4eec\u4e3b\u8981\u5206\u6790\u8fd9\u4e2a\u8fd0\u52a8\u8fc7\u7a0b\u3002\n\n\u9898\u76ee\u4e2d\u662f\u4e24\u4e2a\u4eba\u540c\u65f6\u5728\u8fd0\u52a8\uff0c\u7136\u540e\u968f\u4fbf\u5206\u6790\u4e00\u4e0b\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u770b\u51fa\uff1a\u7531\u4e8e\u4e24\u4e2a\u4eba\u90fd\u662f\u5300\u901f\u76f4\u7ebf\u8fd0\u52a8\uff0c\u90a3\u4e48\u6211\u4eec\u76f4\u63a5\u5c06\u4e00\u4e2a\u4eba\u9009\u4f5c\u53c2\u8003\u7cfb\uff0c\u5c31\u53ef\u4ee5\u8f6c\u5316\u4e3a\u53ea\u6709\u4e00\u4e2a\u4eba\u8fd0\u52a8\u3002\n\n\u90a3\u4e48\u73b0\u5728\u95ee\u9898\u5df2\u7ecf\u5f31\u5316\u5f88\u591a\u4e86\uff0c\u53ef\u662f\u8fd8\u662f\u4e0d\u662f\u975e\u5e38\u597d\u5904\u7406\u3002\n\n\u4e00\u4e2a\u5173\u952e\u7684\u60f3\u6cd5\uff1a\u8fd9\u4e2a\u9001\u90ae\u9012\u7684\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u8fd9\u6837\u8f6c\u5316\u4e00\u4e0b\u3002\u6211\u4eec\u4e0d\u59a8\u76f4\u63a5\u628a\u90ae\u9012\u5458~~\u8fd9\u4e2a\u5de5\u5177\u4eba~~\u76f4\u63a5\u5220\u4e86\uff0c\u628a\u8fd9\u4e2a\u8fc7\u7a0b\u8f6c\u6362\u4e3aNadia\u63d0\u524d\u4e86$t$\u51fa\u53d1\uff0c\u90a3\u4e48\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u53ea\u8981Misha\uff08\u73b0\u5728\u4e00\u76f4\u5728\u539f\u70b9\uff09\u5230Nadia\u8def\u5f84\u7684\u4efb\u4f55\u4e00\u6bb5\u8ddd\u79bb\u5c0f\u4e8e$t$\uff0c\u90a3\u4e48$t$\u7684\u9001\u8d27\u65f6\u95f4\u5c31\u662f\u53ef\u884c\u7684\u3002\n\n\u7136\u540e\u5c31\u662f\u4e00\u4e9b\u7ec6\u8282\u95ee\u9898\u3002\u7531\u4e8e\u6bcf\u6b21\u6d89\u53ca\u5230\u63d0\u524d\u4e00\u4e2a\u4eba\uff0c\u6240\u4ee5\u6bcf\u6b21\u7684\u76f8\u5bf9\u8def\u5f84\u9700\u8981\u91cd\u65b0\u8ba1\u7b97\u3002\u7136\u540e\u7531\u4e8e\u662f\u6d6e\u70b9\u6570\uff0c\u9700\u8981\u6ce8\u610f\u4e00\u4e0b\u7cbe\u5ea6\u95ee\u9898\u3002~~\u4f46\u51e1\u6d89\u53ca\u5230\u6d6e\u70b9\u6570\u7684\u9898\u76ee\u6211\u5fc5\u5b9a\u8981\u4ea4\u4e24\u4e09\u9762\u3002~~\u6700\u7ec8\u590d\u6742\u5ea6 $\\mathcal{O}(n\\log n)$\u3002\n\n## Code\n\n```cpp\n#include <cstdio>\n#include <cmath>\n\n#define _N 50010\n#define _EPS 1e-8\n\nstruct Tuple {\n\tdouble x, y;\n\tTuple() {\n\t\tx = y = 0;\n\t}\n\tTuple(double a, double b) {\n\t\tx = a, y = b;\n\t}\n};\n\nTuple inline operator +(const Tuple& left, const Tuple& right) {\n\treturn Tuple(left.x + right.x, left.y + right.y);\n}\nTuple inline operator -(const Tuple& left, const Tuple right) {\n\treturn Tuple(left.x - right.x, left.y - right.y);\n}\nTuple inline operator *(const Tuple& left, double right) {\n\treturn Tuple(left.x * right, left.y * right);\n}\ndouble inline operator *(const Tuple& left, const Tuple& right) {\n\treturn left.x * right.x + left.y * right.y;\n}\nTuple inline operator /(const Tuple& left, double right) {\n\treturn Tuple(left.x / right, left.y / right);\n}\ndouble inline operator %(const Tuple& left, const Tuple& right) {\n\treturn left.x * right.y - left.y * right.x;\n}\n\ntypedef Tuple Point;\ntypedef Tuple Vec;\n\nint n, m;\n\nPoint misha[_N];\nPoint nadia[_N];\ndouble disn[_N];\n\nint inline sgn(double val) {\n\tif (val > _EPS) {\n\t\treturn 1;\n\t}\n\tif (val < -_EPS) {\n\t\treturn -1;\n\t}\n\treturn 0;\n}\n\ndouble inline dist(Point left, Point right) {\n\treturn sqrtl((right.x - left.x) * (right.x - left.x) + (right.y - left.y) * (right.y - left.y));\n}\ndouble inline len(Vec val) {\n\treturn sqrtl(val.x * val.x + val.y * val.y);\n}\ndouble inline dist(Point p, Point left, Point right) {\n\tdouble len = dist(left, right);\n\tif (len > _EPS && sgn((p - left) * (right - left)) >= 0 && sgn((p - right) * (left - right)) >= 0) {\n\t\treturn fabsl((p - left) % (right - left)) / len;\n\t}\n\treturn fminl(dist(p, left), dist(p, right));\n}\nPoint inline at(Point from, Point to, double len) {\n\treturn from + (to - from) * len / dist(from, to);\n}\nVec inline unit(Vec val) {\n\treturn val / len(val);\n}\n\nbool check(double delay) {\n\tint ptm = 1, ptn = 1;\n\tdouble remm = 0, remn = delay;\n\tPoint lastm = misha[1], lastn;\n\twhile (ptn < m && disn[ptn] < delay + _EPS) {\n\t\tptn++;\n\t}\n\tif (ptn == m) {\n\t\treturn true;\n\t}\n\tremn -= disn[ptn - 1];\n\tlastn = at(nadia[ptn], nadia[ptn + 1], remn);\n\twhile (ptm < n && ptn < m) {\n\t\tif (dist(lastm, lastn) < delay + _EPS) {\n\t\t\treturn true;\n\t\t}\n\t\tdouble timm = dist(lastm, misha[ptm + 1]), timn = dist(lastn, nadia[ptn + 1]);\n\t\tVec relamov = (unit(nadia[ptn + 1] - lastn) - unit(misha[ptm + 1] - lastm)) * fminl(timm, timn);\n\t\tif (timm > _EPS && timn > _EPS && dist(lastm, lastn, lastn + relamov) < delay + _EPS) {\n\t\t\treturn true;\n\t\t}\n\t\tint cmp = sgn(timm - timn);\n\t\tif (cmp == 1) {\n\t\t\tremm += timn, remn = 0;\n\t\t\tlastm = at(misha[ptm], misha[ptm + 1], remm), lastn = nadia[++ptn];\n\t\t} else if (cmp == -1) {\n\t\t\tremn += timm, remm = 0;\n\t\t\tlastn = at(nadia[ptn], nadia[ptn + 1], remn), lastm = misha[++ptm];\n\t\t} else {\n\t\t\tremm = remn = 0;\n\t\t\tlastm = misha[++ptm], lastn = nadia[++ptn];\n\t\t}\n\t}\n\treturn false;\n}\n\nint main() {\n\tscanf(\"%d\", &n);\n\tfor (int i = 1; i <= n; i++) {\n\t\tscanf(\"%lf%lf\", &misha[i].x, &misha[i].y);\n\t}\n\tscanf(\"%d\", &m);\n\tfor (int i = 1; i <= m; i++) {\n\t\tscanf(\"%lf%lf\", &nadia[i].x, &nadia[i].y);\n\t}\n\tfor (int i = 1; i < m; i++) {\n\t\tdisn[i] = dist(nadia[i], nadia[i + 1]);\n\t\tdisn[i] += disn[i - 1];\n\t}\n\tdouble l = 0, r = disn[m - 1];\n\tif (dist(misha[1], nadia[m]) > r + _EPS) {\n\t\tputs(\"impossible\");\n\t\treturn 0;\n\t}\n\twhile (r - l > _EPS) {\n\t\tdouble mid = (l + r) / 2;\n\t\tif (check(mid)) {\n\t\t\tr = mid;\n\t\t} else {\n\t\t\tl = mid;\n\t\t}\n\t}\n\tprintf(\"%.4lf\\n\", (l + r) / 2);\n\treturn 0;\n}\n```\n\n## Inspiration\n\n\u6211\u8ba4\u4e3a\u8fd9\u9898\u7684\u8f6c\u5316\u5982\u679c\u662f\u7b2c\u4e00\u6b21\u63a5\u89e6\u8fd8\u662f\u6709\u70b9\u96be\u5ea6\u7684\uff0c\u4e0d\u8fc7\u5176\u4ed6\u7684\u90e8\u5206\u90fd\u4e0d\u96be\u3002\n\n\u5173\u952e\u7ed3\u8bba\uff1a\n\n- \u4e24\u4e2a\u5300\u901f\u76f4\u7ebf\u8fd0\u52a8\u53ef\u4ee5\u901a\u8fc7\u53d8\u6362\u53c2\u8003\u7cfb\u53d8\u6210\u9759\u6b62\u548c\u4e00\u4e2a\u5300\u901f\u76f4\u7ebf\u8fd0\u52a8\u3002\n- \u90ae\u9012\u5458\u53ef\u4ee5\u901a\u8fc7\u8f6c\u5316\u7b80\u5355\u7684\u8003\u8651",
        "postTime": 1619253197,
        "uid": 244096,
        "name": "FangZeLi",
        "ccfLevel": 7,
        "title": "P6897\u9898\u89e3"
    },
    {
        "content": "\u65e0\u89e3\u5224\u65ad\u663e\u7136\u662f\u5982\u679c\u4ece A \u8d77\u70b9\u51fa\u53d1\u76f4\u63a5\u8d70\u76f4\u7ebf\u6700\u5feb\u90fd\u65e0\u6cd5\u622a\u65ad\uff08\u5728 B \u5230\u7ec8\u70b9\u524d\u5230\u8fbe\uff09\u3002\n\n\u76f4\u63a5\u505a\u4e0d\u597d\u505a\uff08\u65e0\u6cd5\u523b\u753b\u8ddd\u79bb\u65f6\u95f4\u95f4\u9694\u5bf9\u7b49\u7684\u5173\u7cfb\uff09\uff0c\u8003\u8651\u4e8c\u5206\u7b54\u6848 $x$\uff0c\u5224\u65ad\u90ae\u9012\u65f6\u95f4\u662f\u5426\u5b58\u5728 $\\le x$\u3002\n\n\u95ee\u9898\u7b49\u4ef7\u4e8e\uff0cA \u4ece\u8d77\u70b9\u51fa\u53d1\uff0cB \u4ece\u539f\u7ebf\u8def\u8d70\u5230 $x$ \u65f6\u523b\u51fa\u53d1\uff08\u65f6\u523b\u5bf9\u9f50\uff09\uff0c\u662f\u5426\u6709\u4e00\u4e2a\u65f6\u523b\u4f7f\u4e24\u8005\u7684\u8ddd\u79bb $\\le x$\u3002\u8bc1\u660e\uff1a \u5982\u679c\u6ee1\u8db3\uff0c\u663e\u7136\u5b58\u5728\uff08\u4e0d\u65ad\u7f29\u5c0f\u95f4\u9694\u8ba9\u8ddd\u79bb\u548c\u95f4\u9694\u76f8\u540c\u5373\u53ef\uff09\u3002\u53cd\u8fc7\u6765\u5982\u679c\u5b58\u5728\u4e00\u4e2a\u7b54\u6848 $ans \\le x$\uff0c\u4f60\u53ef\u80fd\u901a\u8fc7\u62c9\u957f\u65f6\u95f4\u95f4\u9694\u8ba9\u4ed6\u4eec\u53d8\u6210 $x$\uff0c\u7531\u4e8e\u7136\u540e\u4ed6\u4eec\u8ddd\u79bb\u7684\u53d8\u5316\u4e0d\u4f1a\u8d85\u8fc7\u65f6\u95f4\u95f4\u9694\uff08\u4f60\u8003\u8651\u4e24\u70b9 $a, b$ \u4e4b\u95f4\u7684\u8ddd\u79bb\uff0c\u5f53 $a$ \u79fb\u52a8 $d$ \u957f\u5ea6\uff0c\u8ddd\u79bb\u53d8\u52a8\u4f1a\u5c0f\u4e8e\u7b49\u4e8e $d$\uff09 \uff0c\u6240\u4ee5\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u65f6\u95f4\u95f4\u9694\u662f $x$ \u7136\u540e\u8ddd\u79bb $\\le x$ \u7684\u7b54\u6848\u3002\n\n\u6211\u4eec\u5c06\u65f6\u95f4\u6bb5\u6309\u7167 $n + m$ \u4e2a\u4e24\u4eba\u8d70\u7684\u8f6c\u6298\u70b9\u5206\u6210\u82e5\u5e72\u6bb5\uff0c\u6bcf\u6bb5 A\u3001B \u90fd\u662f\u5728\u4e00\u6761\u76f4\u7ebf\u4e0a\u505a\u5300\u901f\u76f4\u7ebf\u8fd0\u52a8\u3002\n\n\u8fd0 \u52a8 \u662f \u76f8 \u5bf9 \u7684\u3002 \n\n\u53ef\u4ee5\u8f6c\u5316\u4e3a A \u9759\u6b62\uff0cB \u5300\u901f\u76f4\u7ebf\u8fd0\u52a8\u3002\n\n\u5373\u6c42 A \u5728 B \u8fd0\u52a8\u7ebf\u6bb5\u8f68\u8ff9\u8ddd\u79bb\u6700\u5c0f\u503c\uff0c\u5373\u70b9\u5230\u7ebf\u6bb5\u6700\u5c0f\u503c\uff0c\u5c31\u80fd\u505a\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n \\log n)$\u3002",
        "postTime": 1611718317,
        "uid": 161687,
        "name": "Remake",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6897 \u3010[ICPC2014 WF]Messenger\u3011"
    }
]
[
    {
        "content": "### \u6d88\u9664\u7684\u57fa\u672c\u7b56\u7565\n\n\u5047\u5b9a\u5f53\u524d\u724c\u5806\u9876\u7684\u724c\u7684\u79cd\u7c7b\u4e3a $x$\uff0c\u73b0\u5728\u573a\u4e0a\u4e5f\u6709\u81f3\u5c11\u4e00\u5f20\u79cd\u7c7b\u4e3a $x$ \u7684\u724c\uff0c\u7136\u540e\u6211\u4eec\u60f3\u628a\u8fd9\u5f20\u724c\u76f4\u63a5\u6d88\u6389\u3002\n\n\u5728\u4ee5\u4e0b\u7684\u7b56\u7565\u4e2d\u5982\u679c\u573a\u4e0a\u6709\u4e24\u5f20\u76f8\u540c\u7684\u724c\uff0c\u6211\u4eec\u4e00\u5b9a\u4f1a\u7acb\u523b\u5c06\u5b83\u4eec\u6d88\u6389\uff0c\u6240\u4ee5\u540c\u79cd\u7c7b\u7684\u724c\u4e8e\u6b64\u6761\u4ef6\u4e0b\u5728\u573a\u4e0a\u53ea\u80fd\u51fa\u73b0\u4e00\u6b21\u3002\u5047\u5b9a\u573a\u4e0a\u53e6\u4e00\u5f20\u79cd\u7c7b\u4e3a $x$ \u7684\u724c\u4f4d\u4e8e\u6808 $p_x$ \u4e2d\u3002\n\n- \u5982\u679c $p_x$ \u7684\u9876\u7aef\u5361\u724c\u79cd\u7c7b\u4e3a $x$\uff0c\u5219\u5c06\u5f53\u524d\u724c\u5806\u9876\u7684\u724c\u653e\u5230\u6808 $p_x$ \u4e0a\uff0c\u5b83\u4eec\u4f1a\u81ea\u52a8\u88ab\u6d88\u6389\u3002\n- \u5982\u679c $p_x$ \u7684\u5e95\u7aef\u5361\u724c\u79cd\u7c7b\u4e3a $x$\uff0c\u5219\u5c06\u5f53\u524d\u724c\u5806\u9876\u7684\u724c\u653e\u5230\u4e00\u4e2a\u7a7a\u6808 $sp$ \u4e0a\uff0c\u7136\u540e\u5bf9\u6808 $sp$ \u548c $p_x$ \u6267\u884c\u4e00\u6b21\u64cd\u4f5c\u4e8c\uff0c\u5b83\u4eec\u4e5f\u4f1a\u88ab\u6d88\u6389\u3002\n\n\uff08\u4ee5\u4e0b\u540c\u989c\u8272\u4ee3\u8868\u540c\u79cd\u7c7b\u7684\u724c\uff09\n\n\u7b2c\u4e00\u79cd\u64cd\u4f5c\u793a\u4f8b\uff1a\n\n![\u64cd\u4f5c1](https://cdn.luogu.com.cn/upload/image_hosting/ky1hipe1.png)\n\n\u7b2c\u4e8c\u79cd\u64cd\u4f5c\u793a\u4f8b\uff1a\n\n![\u64cd\u4f5c2](https://cdn.luogu.com.cn/upload/image_hosting/wvsbdwvw.png)\n\n\u4e0d\u96be\u53d1\u73b0\u5982\u679c\u4e00\u4e2a\u6808\u91cc\u6709\u4e0d\u5c11\u4e8e\u4e09\u5f20\u724c\u7684\u8bdd\uff0c\u90a3\u4e48\u4f4d\u4e8e\u4e2d\u95f4\u7684\u90a3\u4e00\u5f20\u662f\u4e0d\u5bb9\u6613\u88ab\u6d88\u6389\u7684\uff0c\u800c $k$ \u7684\u8303\u56f4\u5728 $2n$ \u5de6\u53f3\uff0c\u8fd9\u542f\u53d1\u6211\u4eec\u5c3d\u53ef\u80fd\u4f7f\u6bcf\u4e2a\u6808\u542b\u6709\u4e0d\u8d85\u8fc7\u4e24\u5f20\u724c\u3002\n\n### $k=2n-2$\n\n#### \u7b56\u75651\uff1a\u5b58\u5728\u4e00\u4e2a\u7f16\u53f7\u4e3a $sp$ \u7684\u7a7a\u6808\uff0c\u4e14\u5f53\u524d\u724c\u5806\u9876\u7684\u724c\u5728\u573a\u4e0a\u5b58\u5728 \u6216 \u5176\u4f59\u6808\u4e2d\u5b58\u5728\u81f3\u5c11\u4e00\u4e2a\u6808\u5927\u5c0f\u4e0d\u8d85\u8fc7 $1$\uff1a\n\n- \u5982\u679c\u5f53\u524d\u724c\u5806\u9876\u7684\u724c\u5728\u573a\u4e0a\u51fa\u73b0\u8fc7\uff0c\u6309\u4e0a\u8ff0\u6d88\u9664\u57fa\u672c\u7b56\u7565\u6267\u884c\uff08\u5c06\u6808 $sp$ \u7b2c\u4e8c\u79cd\u6d88\u9664\u64cd\u4f5c\u7684\u7a7a\u6808\uff09\u3002\n- \u5426\u5219\u5c06\u5176\u653e\u5230\u4efb\u610f\u4e00\u4e2a\u5176\u4e2d\u5927\u5c0f\u4e0d\u8d85\u8fc7 $1$ \u7684\u6808\u7684\u6808\u9876 **\uff08$sp$ \u53f7\u6808\u9664\u5916\uff09**\u3002\n\n\n\n\u7531\u4e8e\u53ea\u6709 $k=2n-2$ \u79cd\u5361\u724c\uff0c\u6211\u4eec\u53ef\u4ee5\u4fdd\u8bc1\u5373\u4f7f\u524d $n-1$ \u4e2a\u6808\u5747\u542b\u6709\u4e24\u5f20\u5361\u724c\u65f6\uff0c\u724c\u5806\u9876\u7684\u724c\u4e5f\u4e00\u5b9a\u4f1a\u5728\u573a\u4e0a\u51fa\u73b0\u8fc7\uff0c\u53ef\u4ee5\u91cd\u590d\u6309\u7167\u7b56\u75651\u6267\u884c\u3002\u4ee4 $n$ \u53f7\u6808\u4e3a $sp$ \u7a7a\u6808\uff0c\u4fbf\u53ef\u4fdd\u8bc1\u7b2c\u4e8c\u79cd\u6d88\u9664\u57fa\u672c\u7b56\u7565\u7684\u6267\u884c\u3002\n\n\n\n### $k=2n-1$\n\n\u73b0\u5728\u591a\u4e86\u4e00\u79cd\u724c\uff0c\u6240\u4ee5\u7b56\u75651\u4e0d\u4e00\u5b9a\u6bcf\u6b21\u90fd\u80fd\u594f\u6548\u4e86\u3002\n\n\u90a3\u4e48\u8003\u8651\u5982\u4f55\u5b89\u7f6e\u591a\u51fa\u6765\u7684\u8fd9\u4e00\u79cd\u724c\u3002\u6211\u4eec\u518d\u770b\u724c\u5806\u9876\u7684\u4e0b\u4e00\u5f20\u724c\uff0c\u5982\u679c\u8fd9\u5f20\u724c\u7684\u540c\u7c7b\u724c\u51fa\u73b0\u5728\u6808\u5e95\uff08\u4e0d\u59a8\u8bbe\u5bf9\u5e94\u6808\u7f16\u53f7\u4e3a $p$\uff09\uff0c\u90a3\u4e48\u4e0d\u96be\u5f97\u51fa\u53ef\u4ee5\u5c06\u724c\u5806\u9876\u7684\u724c\u653e\u5230\u6808 $p$ \u4e0a\uff0c\u7136\u540e\u5c06\u4e0b\u4e00\u5f20\u724c\u653e\u5230\u6808 $sp$ \u91cc\uff0c\u6700\u540e\u5bf9\u6808 $p$ \u548c $sp$ \u6267\u884c\u4e00\u6b21\u64cd\u4f5c2\u4fbf\u53ef\u5b89\u7f6e\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/le9p0fu1.png)\n\n\u4f46\u662f\u5982\u679c\u4e0b\u4e00\u5f20\u724c\u7684\u540c\u7c7b\u724c\u5728\u6808\u9876\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u65e0\u8111\u5c06\u724c\u5806\u9876\u7684\u724c\u653e\u5230\u6808 $sp$ \u4e0a\u5417\uff1f\u663e\u7136\u4e0d\u53ef\u4ee5\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/gss3eqmu.png)\n\n\u65e2\u7136\u6d88\u9664\u7684\u5173\u952e\u8fd8\u662f\u6808\u5e95\u7684\u724c\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4e0d\u53ef\u4ee5\u62d3\u5bbd\u4e00\u4e0b\u89c6\u91ce\uff0c\u5f80\u540e\u770b\u6709\u6ca1\u6709\u4f4d\u4e8e\u5e95\u90e8\u7684\u724c\uff0c\u7136\u540e\u5c06\u724c\u5806\u9876\u7684\u724c\u653e\u5230\u5bf9\u5e94\u6808\u9876\u5462\uff1f\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xy1g3sgy.png)\n\n\u8c8c\u4f3c\u5f88\u884c\uff0c\u5bf9\u5427\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6i8exa0v.png)\n\n\u8fd8\u662f\u4e0d\u884c\u3002\u724c\u5806\u9876\u7684\u724c\u963b\u6321\u4e86\u539f\u6808\u9876\u7684\u724c\uff0c\u4f7f\u5f97\u5b83\u4eec\u4e0d\u80fd\u4e92\u76f8\u6d88\u9664\u3002\n\n\u4f46\u5982\u679c\u6211\u4eec\u6539\u4e3a\u5c06\u724c\u5806\u9876\u7684\u724c\u653e\u5230 $sp$ \u91cc....\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jvk4sqyv.png)\n\n\u8fd9\u6837\u53cd\u800c\u884c\u5f97\u901a\u4e86\uff0c\u552f\u4e00\u7684\u533a\u522b\u5c31\u662f $sp$ \u6362\u4e86\u4e00\u4e0b\u3002\n\n\u90a3\u4e48\u4e24\u8005\u7684\u533a\u522b\u662f\u4ec0\u4e48\u5462\uff1f\u4ed4\u7ec6\u89c2\u5bdf\u5c31\u53ef\u4ee5\u53d1\u73b0\uff1a\n\n- \u524d\u8005\u7b2c\u4e00\u5f20\u4f4d\u4e8e\u5e95\u90e8\u7684\u724c\u6240\u5728\u6808\u7684\u6808\u9876\u724c\u6ca1\u6709\u88ab\u6d88\u53bb\uff0c\u540e\u8005\u88ab\u6d88\u53bb\u4e86\u3002\n\n\u4ec0\u4e48\u60c5\u51b5\u4e0b\u6808\u9876\u5143\u7d20\u4f1a\u88ab\u6d88\u53bb\uff1f\u7ed3\u5408\u4e0a\u8ff0\u56fe\u601d\u8003\u4e00\u4e0b\u4fbf\u53ef\u5f97\u77e5\uff1a\n\n- \u5728\u724c\u5806\u9876\u548c\u5176\u540e\u7b2c\u4e00\u5f20\u4f4d\u4e8e\u6808\u5e95\u7684\u724c\u4e4b\u95f4\uff0c\u4e0e\u6808\u9876\u724c\u540c\u7c7b\u7684\u724c\u51fa\u73b0\u4e86\u5947\u6570\u6b21\u3002\n\n\u81f3\u4e8e\u8fd9\u4e24\u5f20\u724c\u4e4b\u95f4\u7684\u6240\u6709\u724c\uff0c\u7531\u4e8e\u5b83\u4eec\u90fd\u51fa\u73b0\u5728\u6808\u9876\u51fa\u73b0\uff0c\u6240\u4ee5\u76f4\u63a5\u5c06\u5176\u5206\u522b\u653e\u5728\u5bf9\u5e94\u6808\u4e0a\u5373\u53ef\u3002\uff08\u5f53\u7136\u4e00\u4e9b\u724c\u4f1a\u51fa\u73b0\u591a\u6b21\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4e3a\u4e86\u65b9\u4fbf\uff0c\u53ef\u4ee5\u6bcf\u6b21\u90fd\u5c06\u5176\u653e\u5728\u540c\u6837\u7684\u4f4d\u7f6e\u3002\uff09\n\n\u4e8e\u662f\u7b56\u7565\u4fbf\u9010\u6e10\u660e\u6717\u8d77\u6765\uff1a\n\n#### \u7b56\u7565 Meow\uff1a\u5b58\u5728\u4e00\u4e2a\u7f16\u53f7\u4e3a $sp$ \u7684\u7a7a\u6808\uff0c\u4e14\u4e0d\u6ee1\u8db3\u7b56\u75651\u6761\u4ef6\u3002\n\n\u9996\u5148\u8bb0\u5f55**\u6b64\u65f6**\u6bcf\u7c7b\u724c\u6240\u5728\u7684\u6808\u7f16\u53f7\u548c\u662f\u5426\u4f4d\u4e8e\u6808\u9876\uff0c\u8bb0 $p_i$ \u6b64\u65f6\u724c $i$ \u540c\u7c7b\u7684\u724c\u6240\u4f4d\u4e8e\u7684\u6808\u7f16\u53f7\uff0c$t_i=1$ \u4ee3\u8868\u6b64\u65f6\u724c $i$ \u540c\u7c7b\u7684\u724c\u4f4d\u4e8e\u6808\u9876\u3002\n\n\u7136\u540e\u4ece\u724c\u5806\u9876\u7684\u4e0b\u4e00\u5f20\u5f00\u59cb\uff0c\u9010\u4e2a\u5411\u540e\u5224\u65ad\u3002\u8bbe\u5f53\u524d\u5224\u65ad\u7684\u724c\u4e3a $x$\u3002\n\n- \u82e5 $t_x=1$\uff0c\u5219\u5c06 $x$ \u653e\u5230\u6808 $p_x$ \u7684\u6808\u9876\uff0c\u7136\u540e\u5224\u65ad\u4e0b\u4e00\u5f20\u3002\n\n- \u5426\u5219\u82e5 $x$ \u4e0e\u724c\u5806\u9876\u7684\u724c\u540c\u7c7b\uff0c\u5c06\u8fd9\u4e24\u5f20\u724c\u653e\u5230 $sp$ \u91cc\uff0c\u7136\u540e\u66f4\u6362\u4f7f\u7528\u7b56\u75651\u6216\u91cd\u65b0\u4f7f\u7528\u7b56\u7565 Meow\u3002\n\n- \u5426\u5219\uff1a\n\n  - \u82e5\u4e0e\u6808 $p_x$ \u7684\u6808\u9876\u724c\u540c\u7c7b\u7684\u724c\u5728\u724c\u5806\u9876\u81f3 $x$ \u8fd9\u4e9b\u724c\u4e4b\u95f4\u51fa\u73b0\u4e86\u5947\u6570\u6b21\uff0c\u5219\u5c06\u6b64\u65f6\u724c\u5806\u9876\u7684\u724c\u653e\u7f6e\u4e8e\u6808 $sp$\uff0c\u5c06 $x$ \u653e\u7f6e\u4e8e\u6808 $p_x$\uff0c\u7136\u540e\u5c06 $sp$ \u6539\u4e3a $p_x$\u3002\n\n    ![](https://cdn.luogu.com.cn/upload/image_hosting/jvk4sqyv.png)\n\n  - \u82e5\u4e0e\u6808 $p_x$ \u7684\u6808\u9876\u724c\u540c\u7c7b\u7684\u724c\u5728\u724c\u5806\u9876\u81f3 $x$ \u8fd9\u4e9b\u724c\u4e4b\u95f4\u51fa\u73b0\u4e86\u5076\u6570\u6b21\uff0c\u5219\u5c06\u6b64\u65f6\u724c\u5806\u9876\u7684\u724c\u653e\u7f6e\u4e8e\u6808 $p_x$\uff0c\u5c06 $x$ \u653e\u7f6e\u4e8e\u6808 $sp$\uff0c\u7136\u540e\u5728\u6808 $sp$ \u548c $p_x$ \u4e0a\u6267\u884c\u4e00\u6b21\u64cd\u4f5c $2$\u3002\n\n    ![](https://cdn.luogu.com.cn/upload/image_hosting/xy1g3sgy.png)\n\n    \u6267\u884c\u4ee5\u4e0a\u4e24\u79cd\u64cd\u4f5c\u4e4b\u4e00\u540e\u66f4\u6362\u4f7f\u7528\u7b56\u75651\u6216\u91cd\u65b0\u4f7f\u7528\u7b56\u7565 Meow \u5373\u53ef\u3002\n\n\n\n\u5f53\u7136\uff0c\u7531\u4e8e\u5c06\u724c\u52a0\u5165\u81f3\u6808\u7684\u8fc7\u7a0b\u662f\u6709\u5e8f\u7684\uff0c\u6240\u4ee5\u5728\u5b9e\u73b0\u4e0a\u4f1a\u6709\u4e9b\u8bb8\u4e0d\u540c\u3002\uff08\u4f8b\u5982\uff0c\u53ef\u4ee5\u5148\u627e\u5230 $x$ \u5728\u54ea\u91cc\uff0c\u7136\u540e\u6839\u636e\u4fe1\u606f\u5224\u65ad\u724c\u5806\u9876\u7684\u724c\u5e94\u653e\u7f6e\u5728\u54ea\u91cc\uff0c\u6700\u540e\u5c06\u724c\u5806\u9876\u4e4b\u540e\u7684\u724c\u52a0\u5165\u6808\u3002\uff09\n\n\n\n\u91cd\u590d\u6267\u884c\u7b56\u75651\u548c\u7b56\u7565 Meow\uff0c\u6700\u7ec8\u6240\u6709\u7684\u724c\u5747\u53ef\u4ee5\u88ab\u6d88\u6389\u3002\u8fd9\u6837\u6211\u4eec\u4e5f\u53ef\u4ee5\u8bc1\u660e\u6240\u6709\u5408\u6cd5\u7684\u521d\u59cb\u914d\u7f6e\u5747\u6709\u89e3\u3002\n\n[\u6574\u4f53\u64cd\u4f5c\u793a\u4f8b](https://www.luogu.com.cn/paste/wexeffk8)\n\n\u5bf9\u4e8e\u64cd\u4f5c\u6b21\u6570\uff1a\u6211\u4eec\u4f1a\u6267\u884c\u6070\u597d $m$ \u6b21\u64cd\u4f5c1\uff0c\u800c\u6bcf\u6b21\u64cd\u4f5c2\u4f1a\u6d88\u9664\u4e24\u5f20\u724c\uff0c\u7531\u4e8e\u64cd\u4f5c1\u6267\u884c\u8fc7\u7a0b\u4e2d\u4e5f\u4f1a\u6d88\u53bb\u724c\uff0c\u56e0\u6b64 $2m$ \u5f20\u724c\u81f3\u591a\u4f7f\u7528 $m$ \u6b21\u64cd\u4f5c2\u5373\u53ef\u5168\u90e8\u6d88\u9664\uff0c\u4e8e\u662f\u603b\u64cd\u4f5c\u6b21\u6570\u4e0d\u8d85\u8fc7 $m+m=2m$\uff0c\u7b26\u5408\u6761\u4ef6\u3002\n\n\n\n\u6570\u636e\u8303\u56f4\u8f83\u5927\uff08$\\sum m\\le 2\\times 10^6$\uff09\uff0c\u6240\u4ee5\u9700\u8981\u6ce8\u610f\u590d\u6742\u5ea6\u548c\u5e38\u6570\u3002\n\n\n\n### \u4ee3\u7801\u5b9e\u73b0\u7684\u7ec6\u8282\u548c\u6ce8\u610f\u4e8b\u9879\n\n#### \u7ef4\u62a4\u4fe1\u606f\n\n\u4f60\u9700\u8981\u7ef4\u62a4\uff1a\n\n- \u5927\u5c0f\u4e0d\u8d85\u8fc71\u7684\u6808\u6709\u54ea\u4e9b\n- \u6bcf\u79cd\u724c\u5728\u573a\u4e0a\u51fa\u73b0\u7684\u6b21\u6570\n- \u6bcf\u79cd\u724c\u6240\u5728\u7684\u6808\u7684\u7f16\u53f7\n\n\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u7ef4\u62a4\u66f4\u591a\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u6bcf\u79cd\u724c\u662f\u5426\u4f4d\u4e8e\u6808\u9876\u6216\u6808\u5e95\u7b49\u3002\n\n#### \u64cd\u4f5c\u51fd\u6570\n\n\u7531\u4e8e\u9700\u8981\u6d89\u53ca\u5230\u5f88\u591a\u60c5\u51b5\uff0c\u6240\u4ee5\u5efa\u8bae\u5c06\u64cd\u4f5c\u5199\u8fdb\u4e00\u4e2a\u51fd\u6570\u4ee5\u51cf\u5c11\u4ee3\u7801\u91cf\u3002\n\n\u4ee5\u4e0b\u4e3a\u4e00\u79cd\u5199\u6cd5\uff1a\n\n```c++\nvoid change(int x,int y){\n\tans.push_back({x,y});\n\tif(y==0){//y=0\u4ee3\u8868\u4e3a\u64cd\u4f5c1\n\t\t...//\u64cd\u4f5c1\n\t}\n\telse{\n\t\t...//\u64cd\u4f5c2\n\t}\n}\n...\nchange(4,0);//\u5c06\u724c\u5806\u9876\u7684\u724c\u52a0\u5165\u68084\nchange(1,2);//\u5bf9\u68081\u548c\u68082\u6267\u884c\u64cd\u4f5c2\n\n```\n\n\u4f60\u4e5f\u53ef\u4ee5\u5728\u8fd9\u4e2a\u51fd\u6570\u91cc\u8fdb\u884c\u5bf9\u7ef4\u62a4\u4fe1\u606f\u7684\u4fee\u6539\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nifstream fin(\"meow.in\");\nofstream fout(\"meow.out\");\n#define cin fin\n#define cout fout\nint a[2000005],p[1000],b[1005];\ndeque<int>q[1000];\nvector<pair<int,int>>ans;\nint pos=1,sz;\nint cnt[1005];\nqueue<int>pq0;\nvoid change(int x,int y){\n\tans.push_back({x,y});\n\tif(y==0){\n\t\tpq0.push(x);\n\t\tif(!q[x].empty() and q[x].back()==a[pos]){\n\t\t\tq[x].pop_back();\n\t\t\tcnt[a[pos]]--;\n\t\t\tif(cnt[a[pos]]==0)sz--,p[a[pos]]=0;\n\t\t\tif(q[x].empty())b[a[pos]]=0;\n\t\t}\n\t\telse{\n\t\t\tq[x].push_back(a[pos]);\n\t\t\tif(cnt[a[pos]]==0){\n\t\t\t\tsz++,p[a[pos]]=x;\n\t\t\t}\n\t\t\tcnt[a[pos]]++;\n\t\t\tif(q[x].size()==1)b[a[pos]]=1;\n\t\t}\n\t\tpos++;\n\t}\n\telse{\n\t\tpq0.push(x);\n\t\tpq0.push(y);\n\t\tif(q[x].front()==q[y].front()){\n\t\t\tb[q[x].front()]=0;\n\t\t\tcnt[q[x].front()]-=2;\n\t\t\tif(cnt[q[x].front()]==0){\n\t\t\t\tsz--,p[q[x].front()]=0;\n\t\t\t\tb[q[x].front()]=0;\n\t\t\t}\n\t\t\tq[x].pop_front();\n\t\t\tq[y].pop_front();\n\t\t\t\n\t\t\tif(!q[x].empty())b[q[x].front()]=1;\n\t\t\tif(!q[y].empty())b[q[y].front()]=1;\n\t\t}\n\t}\n}\nint main(){\n\tint t;\n\tcin>>t;\n\twhile(t--){\n\t\tpos=1;\n\t\tsz=0;\n\t\tmemset(p,0,sizeof p);\n\t\tmemset(b,0,sizeof b);\n\t\tans.resize(0);\n\t\tint n,m,k;\n\t\tcin>>n>>m>>k;\n\t\tint sp=n;\n\t\t\n\t\twhile(!pq0.empty())pq0.pop();\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tif(i!=sp)pq0.push(i);\n\t\t}\n\t\tint ap[k+5]={0};\n\t\tfor(int i=1;i<=m;i++){\n\t\t\tcin>>a[i];\n\t\t\ta[i+1]=0;\n\t\t}\n\t\tfor(int i=1;i<=m;i++){\n\t\t\tif(sz==2*(n-1) and !cnt[a[i]]){\n\t\t\t\tint ti=i;\n\t\t\t\tfor(int j=i+1;j<=m;j++){\n\t\t\t\t\tif(a[j]==a[i]){\n\t\t\t\t\t\tfor(int w=i+1;w<=j;w++){\n\t\t\t\t\t\t\tap[a[w]]=p[a[w]];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tchange(sp,0);\n\t\t\t\t\t\t\tfor(int w=i+1;w<=j;w++){\n\t\t\t\t\t\t\t\tif(a[w]==a[i])change(sp,0);\n\t\t\t\t\t\t\t\telse change(ap[a[w]],0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\ti=j;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(b[a[j]]){\n\t\t\t\t\t\tif(ap[q[p[a[j]]].back()]){\n\t\t\t\t\t\t\tfor(int w=i+1;w<=j;w++){\n\t\t\t\t\t\t\t\tap[a[w]]=p[a[w]];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tchange(sp,0);\n\t\t\t\t\t\t\tsp=p[a[j]];\n\t\t\t\t\t\t\tfor(int w=i+1;w<=j;w++){\n\t\t\t\t\t\t\t\tchange(ap[a[w]],0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tfor(int w=i+1;w<=j;w++){\n\t\t\t\t\t\t\t\tap[a[w]]=p[a[w]];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tchange(p[a[j]],0);\n\t\t\t\t\t\t\tfor(int w=i+1;w<j;w++){\n\t\t\t\t\t\t\t\tchange(ap[a[w]],0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tchange(sp,0);\n\t\t\t\t\t\t\tchange(sp,p[a[j]]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\ti=j;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tap[a[j]]^=1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int j=ti;j<=i;j++){\n\t\t\t\t\tap[a[j]]=0;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(p[a[i]]){\n\t\t\t\tif(q[p[a[i]]].back()==a[i]){\n\t\t\t\t\tchange(p[a[i]],0);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tchange(sp,0);\n\t\t\t\t\tchange(sp,p[a[i]]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\twhile(!pq0.empty() and (pq0.front()==sp or q[pq0.front()].size()>=2)){\n\t\t\t\t\tpq0.pop();\n\t\t\t\t}\n\t\t\t\tchange(pq0.front(),0);\n\t\t\t}\n\t\t}\n\t\t\n\t\tcout<<ans.size()<<endl;\n\t\t\n\t\tfor(auto it:ans){\n\t\t\tif(it.second==0)cout<<1<<' '<<it.first<<'\\n';\n\t\t\telse cout<<2<<' '<<it.first<<\" \"<<it.second<<'\\n';\n\t\t}\n\t\tassert(pos==m+1);\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tassert(q[i].empty());\n\t\t}\n\t}\n}\n```\n\n",
        "postTime": 1669606424,
        "uid": 280163,
        "name": "dapingguo8",
        "ccfLevel": 8,
        "title": "Meow \u9898\u89e3"
    },
    {
        "content": "\u672c\u7bc7\u9898\u89e3\u5c06\u7ec6\u81f4\u8bb2\u89e3\u672c\u9898\u7684\u601d\u8def\uff0c\u5e76\u7ed9\u51fa\u4e00\u79cd\u957f\u5ea6\u77ed\u800c\u53ef\u8bfb\u6027\u9ad8\u7684\u89e3\u6cd5\u3002\n\n[\u60a8\u53ef\u5728\u6211\u7684\u535a\u5ba2\u4e2d\u67e5\u770b\u672c\u6587\uff0c\u8c22\u8c22\uff01](https://www.cnblogs.com/crab-in-the-northeast/p/luogu-p8866.html)\n\n[P8866 NOIP2022 \u55b5\u4e86\u4e2a\u55b5 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)](https://www.luogu.com.cn/problem/P8866)\u3002\n\n\u672c\u9898\u89e3\u4e2d\u6211\u4eec\u5c06\u56fe\u6848\u4e3a $x$ \u7684\u5361\u724c\u770b\u505a\u6570\u5b57 $x$\uff0c\u5c06\u672c\u9898\u5bf9\u4e8e\u5361\u724c\u7684\u64cd\u4f5c\u770b\u505a\u5bf9\u6570\u5b57\u7684\u64cd\u4f5c\u3002\n\n\u89c2\u5bdf\u5230\u6570\u636e\u8303\u56f4\uff0c$k \\in \\{2n - 2, 2n - 1\\}$\uff0c\u90a3\u4e48\u505a\u6cd5\u80af\u5b9a\u8ddf $k$ \u5f3a\u76f8\u5173\u3002~~\u5f88\u96be\u4e0d\u8054\u60f3 2018 \u5e74\u7684\u65c5\u884c\u3002\u4f46\u662f\u90a3\u4e2a $m = n - 1$ \u7ed9\u4e86 60 \u5206\uff0c\u8fd9\u4e2a\u5462\uff1f~~\n\n## $k = 2n - 2$\n\n\u9996\u5148\u53d1\u73b0 $op$ \u7684\u9650\u5236\u5176\u5b9e\u662f\u5047\u7684\uff1a\u6211\u4eec\u4e00\u5b9a\u6070\u597d\u8fdb\u884c\u4e86 $m$ \u6b21\u64cd\u4f5c $1$\uff0c\u6700\u591a\u8fdb\u884c\u4e86 $0.5m$ \u6b21\u64cd\u4f5c $2$\uff0c\u6240\u4ee5 $op$ \u4e00\u5b9a\u5929\u7136\u6ee1\u8db3 $m \\le op \\le 1.5m$\u3002\n\n\u89c2\u5bdf $k$ \u548c $n$ \u7684\u5173\u7cfb\uff0c\u53d1\u73b0\u662f\u8fd1\u4f3c\u4e8c\u500d\uff0c\u800c\u4e14 $k = 2(n - 1)$\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u5982\u679c\u628a\u6bcf\u4e24\u79cd\u6570\u5b57\u8003\u8651\u5230\u4e00\u4e2a\u6808\uff0c\u8fd9\u6837\u5206\u914d\u5c06\u6070\u597d\u5269\u4e0b\u4e00\u4e2a\u7a7a\u6808\u3002\n\n\u8003\u8651\u5c06\u6570\u5b57 $2i - 1$ \u548c $2i$ \u5206\u914d\u5230\u7b2c $i$ \u4e2a\u6808\u4e2d\uff0c\u7b2c $n$ \u4e2a\u6808\u5c31\u53ef\u4ee5\u4f5c\u4e3a\u7a7a\u8f85\u52a9\u6808\u4e86\u3002\u7a0d\u4f5c\u601d\u8003\u53ef\u4ee5\u7ed9\u51fa\u4ee5\u4e0b\u7684\u89e3\u6cd5\uff1a\n\n\u9047\u5230\u4e00\u4e2a\u6570\u5b57 $x$\uff0c\u6211\u4eec\u67e5\u770b\u8fd9\u4e2a\u6570\u5b57\u6240\u5206\u914d\u5230\u6808 $s$ \u7684\u60c5\u51b5\uff1a\n\n- \u5982\u679c $s$ \u4e3a\u7a7a\uff0c\u76f4\u63a5\u5165\u6808\uff1b\n- \u5982\u679c $s$ \u6709 $1$ \u4e2a\u5143\u7d20\uff0c\u548c $x$ \u76f8\u540c\uff0c\u5c06 $x$ \u5165\u6808 $s$ \u5e76\u5c06\u8fd9\u4e24\u4e2a $x$ \u6d88\u9664\uff1b\n- \u5982\u679c $s$ \u6709 $1$ \u4e2a\u5143\u7d20\uff0c\u548c $x$ \u4e0d\u540c\uff0c\u5c06 $x$ \u5165\u6808 $s$ \uff1b\n- \u5982\u679c $s$ \u6709 $2$ \u4e2a\u5143\u7d20\uff0c\u6808\u9876\u548c $x$ \u76f8\u540c\uff0c\u5c06 $x$ \u5165\u6808 $s$ \u5e76\u5c06\u8fd9\u4e24\u4e2a $x$ \u6d88\u9664\uff1b\n- \u5982\u679c $s$ \u6709 $2$ \u4e2a\u5143\u7d20\uff0c\u6808\u9876\u548c $x$ \u4e0d\u540c\uff0c\u90a3\u4e48\u6808\u5e95\u4e00\u5b9a\u548c $x$ \u76f8\u540c\u3002\u5c06 $x$ \u5165\u8f85\u52a9\u6808 $n$\uff0c\u5bf9\u6808 $n$ \u548c\u6808 $s$ \u6808\u5e95\u76f8\u6d88\u3002\n\n\u5bb9\u6613\u770b\u51fa\uff0c\u6211\u4eec\u7b2c\u5076\u6570\u6b21\u9047\u5230 $x$ \u7684\u65f6\u5019\uff0c\u603b\u80fd\u7acb\u523b\u5c06\u5b83\u548c\u4e0a\u4e00\u4e2a $x$ \u62b5\u6d88\uff0c\u6240\u4ee5\u4e00\u5b9a\u80fd\u62a5\u544a\u51fa\u89e3\u3002\n\n> \u53e6\u5916\uff0c\u53ef\u4ee5\u6ce8\u610f\u5230\u672c\u9898\u7684\u64cd\u4f5c\u53ea\u5bf9\u6808\u9876\u548c\u6808\u5e95\u6709\u6548\uff0c\u6240\u4ee5\u5982\u679c\u6808\u4e2d\u67d0\u65f6\u5143\u7d20\u5f88\u591a\u5c31\u4f1a\u9020\u6210\u5927\u91cf\u7684\u6ede\u7559\uff0c\u975e\u5e38\u4e0d\u4f18\u3002\u8fd9\u4e5f\u548c\u672c\u505a\u6cd5\u4e2d\u6808\u7684\u5927\u5c0f\u59cb\u7ec8\u4e0d\u8d85\u8fc7 $2$ \u6709\u5173\u7cfb\uff08\u8fbe\u5230 $3$ \u4e4b\u540e\u53ef\u4ee5\u9a6c\u4e0a\u901a\u8fc7\u76f8\u6d88\u964d\u4e3a $2$\uff09\u3002\n\n\u8fd9\u6837 15 \u5206\u5c31\u5230\u624b\u4e86\u3002~~\u662f 60 \u5206\u7684\u56db\u5206\u4e4b\u4e00\u3002~~\n\n## $k = 2n - 1$\n\n\u4e00\u79cd\u6bd4\u8f83\u663e\u7136\u7684\u60f3\u6cd5\u662f\uff0c\u5bf9\u4e8e\u6570\u5b57 $x \\le 2n - 2$ \u6211\u4eec\u6682\u65f6\u4ecd\u7136\u8003\u8651\u4e0a\u9762\u7684\u5904\u7406\u65b9\u5f0f\uff0c\u7136\u540e\u8003\u8651\u5982\u4f55\u5904\u7406 $x = 2n - 1$\u3002\u53d1\u73b0\u9047\u5230 $x = 2n-1$ \u7684\u65f6\u5019\u5c40\u9762\u7684\u7ed3\u6784\u6bd4\u8f83\u53c2\u5dee\u4e0d\u5b9a\uff0c\u4e0d\u597d\u60f3\uff08\u540e\u6765\u53d1\u73b0\u597d\u50cf\u4e5f\u4e0d\u662f\u4e0d\u53ef\u4ee5\uff0c\u8bfb\u8005\u53ef\u4ee5\u81ea\u5df1\u8bd5\u8bd5\uff1f\uff09\u3002\n\n\u6211\u9009\u62e9\u4e86\u53e6\u4e00\u79cd\u60f3\u6cd5\uff0c\u90a3\u5c31\u662f\u629b\u5f00\u6808 $i$ \u548c\u6570\u5b57 $2i$\uff0c$2i - 1$ \u7684\u7ed1\u5b9a\u5173\u7cfb\uff0c\u91c7\u7528\u5148\u6765\u540e\u5230\u7684\u601d\u60f3\uff0c\u6309\u7167 $k = 2n-2$ \u7684\u7b56\u7565\u5c3d\u53ef\u80fd\u8d70\u4e0b\u53bb\u3002\u5177\u4f53\u6765\u8bf4\uff1a\n\n- \u5982\u679c\u6211\u4eec\u5f53\u524d\u9047\u5230\u7684\u6570 $x$ \u5728\u6240\u6709\u6808\u4e2d\u8fd8\u6ca1\u51fa\u73b0\u8fc7\uff0c\u5c31\u628a $x$ \u5c04\u5165\u4e00\u4e2a**\u8fd8\u6ca1\u6ee1\u4e24\u4e2a\u5143\u7d20**\u7684\u6808\uff0c\u4f46\u5982\u679c\u5df2\u7ecf\u6709 $n-1$ \u4e2a\u6808\u5168\u90fd\u6ee1\u4e86\uff0c\u8bf4\u660e\u6211\u4eec\u6309\u7167 $k= 2n-2$ \u7684\u7b56\u7565\u5df2\u7ecf**\u8d70\u4e0d\u4e0b\u53bb**\u4e86\uff08\u6211\u4eec\u5fc5\u987b\u7559\u4e00\u4e2a\u7a7a\u6808\u4f5c\u4e3a\u8f85\u52a9\u6808\uff0c\u7528\u6765\u6808\u5e95\u76f8\u6d88\uff09\u3002\n- \u5982\u679c $x$ \u5728\u67d0\u4e2a\u6808\u4e2d\u51fa\u73b0\u4e86\uff0c\u76f4\u63a5\u4f7f\u7528 $k = 2n-2$ \u7684\u7b56\u7565\u76f4\u63a5\u8ba9\u5f53\u524d\u7684 $x$ \u548c\u6808\u4e2d\u51fa\u73b0\u7684\u90a3\u4e2a $x$ \u6d88\u9664\u3002\n\n\u5f53\u8d70\u4e0d\u4e0b\u53bb\u7684\u65f6\u5019\uff0c\u4e00\u5b9a\u662f\u5c40\u9762\u4e0a\u7684 $n-1$ \u4e2a\u6808\u5168\u90e8\u88ab\u586b\u6ee1\u5404\u4e24\u4e2a\u5143\u7d20\uff0c\u6bcf\u79cd\u5143\u7d20\u6070\u51fa\u73b0\u4e00\u6b21\uff0c\u4e14\u63a5\u4e0b\u6765\u8981\u586b\u7684\u6570\u8fd8\u662f\u4e00\u4e2a\u6ca1\u6709\u5728\u8fd9 $n-1$ \u4e2a\u6808\u4e2d\u51fa\u73b0\u8fc7\u7684\u6570 $P$\u3002\n\n> \u63d0\u4e00\u5634\uff0c\u6211\u611f\u89c9\u5728\u5269\u4e0b\u7684 85 \u5206\u4e2d\uff0c\u5e94\u8be5\u662f\u6709\u90e8\u5206\u6570\u636e\u53ef\u4ee5\u6309\u7167\u4e0a\u8ff0\u7b56\u7565\u6210\u529f\u8d70\u5b8c\u6574\u4e2a\u6e38\u620f\u7684\uff0c\u6bd5\u7adf\u968f\u673a\u6570\u636e\u4e0b\uff0c\u51fa\u73b0\u8d70\u4e0d\u4e0b\u53bb\u7684\u6982\u7387\u4e0d\u662f\u7279\u522b\u9ad8\uff08\u5f53\u7136\u4e5f\u4e0d\u96be\u6784\u9020\uff09\u3002\u6240\u4ee5\u4e5f\u4e0d\u5931\u4e3a\u4e00\u4e2a\u9a97\u5206\u597d\u529e\u6cd5\u3002\u4e0d\u8fc7\u8fd9\u9898\u6709\u591a\u6d4b\uff0c\u6240\u4ee5\u4e5f\u6709\u53ef\u80fd\u4f1a\u5361\u3002\n>\n> \u66f4\u65b0\uff1a\u5b98\u65b9\u6570\u636e\u5361\u4e86\u8fd9\u4e00\u70b9\uff0c\u53ea\u80fd\u62ff\u5230 15 pts\u3002\u6c11\u95f4\u6570\u636e\u53ef\u4ee5\u62ff\u5230 30 pts\u3002\n\n\u76f4\u63a5\u628a $P$ \u653e\u5230\u8f85\u52a9\u6808\u663e\u7136\u662f\u9519\u7684\uff1a\u5047\u5982 $P$ \u540e\u9762\u8ddf\u4e86\u4e00\u4e2a\u88ab\u538b\u5728\u6808\u5e95\u7684\u6570\u5b57\uff0c\u90a3\u4e48\u8fd9\u4e24\u4e2a\u6570\u5b57\u53ef\u80fd\u5f88\u96be\u518d\u62b5\u6d88\uff0c\u5f88\u4e0d\u4f18\u3002\n\n\u6211\u4eec\u8003\u8651\u79bb\u7ebf\uff1a\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u5f00\u59cb\u9884\u77e5\u8fd9\u4e2a\u6570\u540e\u9762\u90fd\u662f\u4ec0\u4e48\u6570\u3002\u4f9d\u636e\u540e\u9762\u6570\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u8003\u8651 $P$ \u653e\u5728\u54ea\u91cc\u3002\n\n\u8003\u8651\u7d27\u8ddf\u5728 $P$ \u540e\u65b9\u6700\u957f\u7684\u4e00\u4e32\u6570\uff0c\u6ee1\u8db3\u8fd9\u4e9b\u6570\u90fd\u5728\u6808\u9876\u3002\u5982\u679c\u4e0d\u8003\u8651\u5f53\u524d $P$ \u7684\u53bb\u5411\uff0c\u90a3\u4e48\u76f4\u63a5\u5c06\u8fd9\u4e9b\u6570\u653e\u5230\u5bf9\u5e94\u7684\u6808\uff0c\u548c\u6808\u9876\u76f8\u6d88\u5373\u53ef\uff0c\u5982\u679c\u518d\u6765\u5c31\u4ecd\u7136\u653e\u7f6e\u539f\u6765\u7684\u6808\u9876\u3002\u6bd4\u5982 $5$ \u662f\u67d0\u4e2a\u6808\u7684\u6808\u9876\uff0c\u5982\u679c $P$ \u540e\u9762\u6765\u4e86\u4e2a $5$ \u5c31\u8ba9\u5b83\u548c $5$ \u76f8\u6d88\uff0c\u5982\u679c\u518d\u6765\u4e00\u4e2a $5$ \u5c31\u653e\u5728\u539f\u6765\u7684\u6808\u9876\uff0c\u5982\u679c\u518d\u6765\u5c31\u7ee7\u7eed\u76f8\u6d88\u3002\u56e0\u6b64\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u4e9b\u6570\u8fd8\u662f\u76f8\u5f53\u81ea\u7531\u7684\uff0c\u6211\u6682\u4e14\u79f0\u4e4b\u4e3a\u81ea\u7531\u76f8\u6d88\u3002\n\n\u56e0\u6b64\u53d1\u73b0\uff0c\u5982\u679c $P$ \u540e\u9762\u7b2c\u4e00\u4e2a\u4e0d\u5728\u6808\u9876\u4e0a\u7684\u6570\u662f $P$\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u628a\u5f53\u524d\u7684 $P$ \u653e\u5165\u8f85\u52a9\u6808\uff0c\u7136\u540e\u63a5\u4e0b\u6765\u7684\u6570\u81ea\u7531\u76f8\u6d88\uff0c\u6700\u540e\u5728\u7b2c\u4e8c\u4e2a $P$ \u6765\u65f6\uff0c\u5c06\u5b83\u4e5f\u653e\u5165\u8f85\u52a9\u6808\uff0c\u6808\u9876\u76f8\u6d88\u5373\u53ef\u3002\u8fd9\u79cd\u60c5\u51b5\u6bd4\u8f83\u7b80\u5355\u3002\n\n\n\u73b0\u5728\u8ba8\u8bba $P$ \u540e\u9762\u7b2c\u4e00\u4e2a\u4e0d\u5728\u6808\u9876\u4e0a\u7684\u6570\u662f\u4e00\u4e2a\u6808\u5e95 $X$ \u7684\u60c5\u51b5\u3002\u6211\u4eec\u8bb0\u5176\u5bf9\u5e94\u6808\u4e3a $S$\u3002\u6b64\u65f6\u672a\u6765\u7684\u6570\u5217\u662f $(P, \\cdots, X)$\uff0c\u5176\u4e2d $\\cdots$ \u90fd\u662f\u67d0\u4e2a\u6808\u7684\u6808\u9876\u3002\u6211\u4eec\u8ba8\u8bba $S$ \u5f53\u524d\u7684\u6808\u9876 $Y$\u3002\n\n- \u5982\u679c\u672a\u6765\u6570\u5217\u7684 $P$ \u548c $X$ \u4e4b\u95f4\uff0c$Y$ \u51fa\u73b0\u4e86\u5947\u6570\u6b21\uff1a\u628a $P$ \u653e\u5165\u8f85\u52a9\u6808\uff0c\u63a5\u4e0b\u6765\u4e00\u76f4\u81ea\u7531\u76f8\u6d88\uff0c\u76f4\u5230\u5c06\u5904\u7406 $X$ \u4e3a\u6b62\u3002\u7531\u4e8e $Y$ \u7684\u6570\u91cf\u662f\u5947\u6570\uff0c\u52a0\u4e0a\u4e00\u5f00\u59cb\u7684\u4e00\u4e2a $Y$\uff0c\u6b64\u65f6 $Y$ \u4e00\u5b9a\u88ab\u6d88\u9664\u5149\uff0c\u73b0\u5728 $S$ \u7684\u6808\u9876\u53d8\u6210 $X$\uff0c\u5c06 $X$ \u653e\u5165 $S$ \u6808\u9876\u76f8\u6d88\uff0c$S$ \u53d8\u6210\u4e86\u7a7a\u6808\u3002\n- \u5982\u679c $Y$ \u51fa\u73b0\u4e86\u5076\u6570\u6b21\uff1a\u628a $P$ \u653e\u5165 $S$\uff0c\u672a\u6765\u6240\u6709\u4e0d\u4e3a $Y$ \u7684\u6808\u9876\u81ea\u7531\u76f8\u6d88\uff0c\u5bf9\u4e8e $Y$\uff0c\u6211\u4eec\u5c06\u5176\u5168\u90e8\u653e\u5165\u8f85\u52a9\u6808\u76f8\u6d88\uff0c\u76f4\u5230\u5c06\u5904\u7406 $X$ \u4e3a\u6b62\u3002\u7531\u4e8e $Y$ \u7684\u6570\u91cf\u662f\u5076\u6570\uff0c\u8fd9\u4e9b $Y$ \u4e00\u5b9a\u90fd\u88ab\u6d88\u9664\u5149\uff0c\u8f85\u52a9\u6808\u4ecd\u4e3a\u7a7a\uff0c\u6211\u4eec\u5c06 $X$ \u653e\u5165\u8f85\u52a9\u6808\uff0c\u548c $S$ \u6808\u5e95\u76f8\u6d88\uff0c\u8f85\u52a9\u6808\u4ecd\u4e3a\u7a7a\u3002\n\n\u7ecf\u8fc7\u4e0a\u8ff0\u64cd\u4f5c\u540e\uff0c\u5c40\u9762\u603b\u4f1a\u4fdd\u6301\uff1a\n\n- \u5b58\u5728\u4e00\u4e2a\u7a7a\u6808\uff1b\n- \u6240\u6709\u6570\u90fd\u5728\u6808\u4e2d\u6700\u591a\u51fa\u73b0\u4e00\u6b21\uff1b\n- \u6240\u6709\u6808\u6700\u591a\u53ea\u6709\u4e24\u4e2a\u5143\u7d20\u3002\n\n\u76f4\u63a5\u8ba9\u65b0\u7684\u7a7a\u6808\u4f5c\u4e3a\u8f85\u52a9\u6808\u5373\u53ef\u3002\n\n\u5982\u4f55\u8bc1\u660e\u8fd9\u79cd\u505a\u6cd5\u4e00\u5b9a\u53ef\u4ee5\u62a5\u544a\u51fa\u89e3\uff1f\u5176\u5b9e\u5f88\u7b80\u5355\uff1a\u5728\u6700\u540e\uff0c\u6bcf\u79cd\u5143\u7d20\u5728\u6240\u6709\u6808\u4e2d\u6700\u591a\u53ea\u80fd\u51fa\u73b0\u4e00\u6b21\uff1b\u6bcf\u79cd\u6570\u5b57\u6570\u91cf\u5747\u4e3a\u5076\u6570\uff0c\u76f8\u6d88\u6c38\u8fdc\u662f\u540c\u79cd\u5143\u7d20\u4e24\u4e24\u76f8\u6d88\uff0c\u6240\u4ee5\u5230\u6700\u540e\uff0c\u67d0\u79cd\u6570\u51fa\u73b0\u5947\u6570\u6b21\u662f\u4e0d\u53ef\u80fd\u7684\u3002\u7efc\u5408\u6765\u770b\uff0c\u6bcf\u79cd\u5143\u7d20\u5230\u6700\u540e\u53ea\u80fd\u51fa\u73b0\u96f6\u6b21\uff0c\u4e5f\u5c31\u662f\u5fc5\u5b9a\u4e0d\u4f1a\u51fa\u73b0\u3002\n\n\u4e00\u4e2a\u5b9e\u73b0\u95ee\u9898\uff1a\u600e\u4e48\u627e\u5f53\u524d\u8fd8\u6ca1\u6ee1\u4e24\u4e2a\u5143\u7d20\u7684\u6808\uff1f\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u961f\u5217\uff0c\u5b58\u50a8\u6808\u7684\u7f16\u53f7\uff0c\u4f7f\u5f97\u59cb\u7ec8\u6ee1\u8db3\uff1a\n\n- \u5982\u679c\u4e00\u4e2a\u6808\u5f53\u524d\u5b58\u6ee1\u4e24\u4e2a\u5143\u7d20\uff0c\u961f\u5217\u4e2d\u4e0d\u5b58\u5728\u5f53\u524d\u6808\u7684\u7f16\u53f7\uff1b\n- \u5982\u679c\u4e00\u4e2a\u6808\u5f53\u524d\u53ea\u5b58\u4e86\u4e00\u4e2a\u5143\u7d20\uff0c\u8ba9\u961f\u5217\u4e2d\u8be5\u6808\u7684\u7f16\u53f7\u51fa\u73b0\u4e00\u6b21\uff1b\n- \u5982\u679c\u4e00\u4e2a\u6808\u5f53\u524d\u4e3a\u7a7a\uff0c\u8ba9\u961f\u5217\u4e2d\u8be5\u6808\u7684\u7f16\u53f7\u51fa\u73b0\u4e24\u6b21\u3002\n- **\u8f85\u52a9\u6808\u7684\u7f16\u53f7\u5728\u961f\u5217\u4e2d\u4e0d\u80fd\u51fa\u73b0**\u3002\n\n\u4e00\u5f00\u59cb\uff0c\u6211\u4eec\u76f4\u63a5\u8ba9 $1 \\sim n - 1$ \u90fd\u63a8\u5165\u961f\u5217\u5404\u4e24\u6b21\uff0c$n$ \u4f5c\u4e3a\u521d\u59cb\u8f85\u52a9\u6808\u4e0d\u63a8\u5165\u961f\u5217\u3002\n\n\u5047\u5982\u6211\u4eec\u5f53\u524d\u9047\u5230\u4e86\u4e00\u4e2a\u6570 $x$\uff0c\u8fd9\u4e2a $x$ \u6ca1\u8fd8\u6ca1\u51fa\u73b0\u5728\u6808\u4e2d\uff0c\u6211\u4eec\u8981\u7ed9 $x$ \u627e\u4e00\u4e2a\u6ca1\u6ee1\u7684\u6808\u65f6\uff0c\u76f4\u63a5\u53d6\u961f\u5217\u7684\u961f\u5934\u4f5c\u4e3a $x$ \u9009\u62e9\u7684\u6808\u7f16\u53f7\uff0c\u961f\u5217\u5f39\u51fa\u961f\u5934\u5373\u53ef\u3002\u7279\u522b\u5730\uff0c\u5982\u679c\u6b64\u65f6\u961f\u5217\u4e3a\u7a7a\uff0c\u8bc1\u660e\u9664\u4e86\u8f85\u52a9\u6808\u6240\u6709\u6808\u90fd\u6ee1\u4e86\uff0c\u8bc1\u660e\u6211\u4eec\u6309\u7167 $k = 2n-2$ \u7684\u7b56\u7565\u8d70\u4e0d\u4e0b\u53bb\uff0c\u8981\u5f00\u59cb\u7279\u522b\u5904\u7406\u4e86\uff1b\n\n\u800c\u5f53\u4e00\u4e2a\u5143\u7d20\u88ab\u5f39\u51fa\u6808\u540e\uff0c\u8ba9\u5143\u7d20\u6240\u5bf9\u5e94\u7684\u6808\u7684\u7f16\u53f7\u5165\u961f\u3002\n\n\u5bb9\u6613\u53d1\u73b0\uff0c\u8fd9\u6837\u5c31\u7ef4\u62a4\u597d\u4e86\u4e0a\u9762\u961f\u5217\u5e94\u8be5\u6ee1\u8db3\u7684\u56db\u6761\u6027\u8d28\u3002\u4e0d\u8fc7\uff0c\u8f85\u52a9\u6808\u7684\u7f16\u53f7\u53ef\u80fd\u4f1a\u53d8\u52a8\uff0c\u8981\u59cb\u7ec8\u4fdd\u8bc1\u597d\u5b83\u4e0d\u51fa\u73b0\u5728\u961f\u5217\u4e2d\u662f\u6709\u4e9b\u7ec6\u8282\u7684\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(m)$\u3002\n\n```cpp\n/*\n * @Author: crab-in-the-northeast \n * @Date: 2022-12-04 01:03:11 \n * @Last Modified by: crab-in-the-northeast\n * @Last Modified time: 2022-12-04 13:35:14\n */\n#include <bits/stdc++.h>\ninline int read() {\n    int x = 0;\n    bool f = true;\n    char ch = getchar();\n    for (; !isdigit(ch); ch = getchar())\n        if (ch == '-')\n            f = false;\n    for (; isdigit(ch); ch = getchar())\n        x = (x << 1) + (x << 3) + ch - '0';\n    return f ? x : (~(x - 1));\n}\n\nconst int maxn = 305;\nconst int maxm = (int)2e6 + 5;\n\nint a[maxm];\nstd :: deque <int> st[maxn];\nint id[maxn * 2]; // \u7ef4\u62a4\u6240\u5728\u6808\u7f16\u53f7\uff0c\u5c40\u9762\u672a\u51fa\u73b0\u5219\u4e3a 0\n\ntypedef std :: pair <int, int> pii;\nstd :: vector <pii> ans;\n\ninline void pu(int s) {\n    ans.emplace_back(s, 0);\n}\n\ninline void de(int s, int t) {\n    ans.emplace_back(s, t);\n}\n\nint spt; // \u8f85\u52a9\u6808\u7f16\u53f7\nstd :: queue <int> q; // \u7ef4\u62a4\u7a7a\u6808\n\ninline bool simple(int x) { // \u5c1d\u8bd5\u7b80\u5355\u76f8\u6d88\n    int s = id[x];\n    if (!s) {\n        if (q.empty())\n            return false;\n        id[x] = s = q.front();\n        q.pop();\n        pu(s);\n        st[s].push_back(x);\n    } else {\n        id[x] = 0;\n        q.push(s);\n        if (x == st[s].back()) {\n            pu(s);\n            st[s].pop_back();\n        } else {\n            pu(spt);\n            de(spt, s);\n            st[s].pop_front();\n        }\n    }\n    return true;\n}\n\nint main() {\n    for (int T = read(); T; --T) {\n        int n = read(), m = read(); read();\n        for (int i = 1; i <= m; ++i)\n            a[i] = read();\n        std :: memset(id, 0, sizeof(id));\n        ans.clear();\n        spt = n;\n\n        while (!q.empty())\n            q.pop();\n        for (int i = 1; i < n; ++i) {\n            q.push(i);\n            q.push(i);\n        }\n        \n        for (int i = 1; i <= m; ++i) if (!simple(a[i])) {\n            int p = a[i];\n            int r = i + 1, x = a[r];\n            for (; r <= m && x != p && st[id[x]].back() == x; ++r, x = a[r]);\n            // \u6b64\u65f6 r \u662f i \u540e\u7b2c\u4e00\u4e2a\u4e0d\u5728\u6808\u9876\u4e0a\u7684\u4e0b\u6807\uff0cx \u662f a[r]\n\n            if (x == p) {\n                pu(spt);\n                for (int j = i + 1; j < r; ++j)\n                    simple(a[j]);\n                pu(spt);\n            } else {\n                int s = id[x], y = st[s].back();\n                bool evn = true; // \u4e2d\u95f4\u6808\u9876\u4e2d\uff0cy \u7684\u6570\u91cf\u662f\u5426\u4e3a\u5076\u6570\n                for (int j = i + 1; j < r; ++j)\n                    if (a[j] == y)\n                        evn = !evn;\n                if (evn) {\n                    pu(s);\n                    st[s].push_back(p);\n                    for (int j = i + 1; j < r; ++j) {\n                        if (a[j] == y)\n                            pu(spt);\n                        else\n                            simple(a[j]);\n                    }\n                    pu(spt);\n                    de(spt, s);\n                    st[s].pop_front();\n                    // st[s] \u4ece\u6808\u5e95\u5230\u6808\u9876\uff0c\u539f\u5148\u4e3a x, y\uff0c\u73b0\u5728\u4e3a y, p\n                    // \u4f9d\u6b64\u66f4\u65b0 id\n                    id[x] = 0;\n                    id[p] = s;\n                } else {\n                    pu(spt);\n                    st[spt].push_back(p);\n                    for (int j = i + 1; j < r; ++j) {\n                        if (a[j] == y)\n                            pu(s); // \u6ce8\u610f\u8fd9\u91cc\u4e0d\u8981\u76f4\u63a5 simple(a[j])\n                        // \u539f\u56e0\u662f s \u5373\u5c06\u53d8\u6210 spt\uff0c\u6240\u4ee5\u6682\u65f6\u4e0d\u80fd\u8ba9 s \u5f39\u5165 q\n                        // \u7279\u5224\u8ba9 simple \u51fd\u6570\u6b64\u65f6\u4e0d\u628a s \u4e0d\u5f39\u5165 q \u4e5f\u4e0d\u884c\n                        // \u5047\u5982 3 1 2 1 1 1 ....\n                        // \u5982\u679c\u76f4\u63a5\u4e0d\u5f39\u5165 q\uff0c\u4f1a\u9020\u6210\u540e\u9762\u7684\u4e00\u4e32 1 1 1 \u65e0\u6cd5\u6b63\u786e\u5f39\u5165 s\n                        // \u6700\u540e\u66b4\u529b\u626b\u961f\u5217\u628a s \u5220\u9664\u590d\u6742\u5ea6\u4e5f\u4e0d\u5bf9\n                        // \u6240\u4ee5\u6b63\u786e\u7684\u505a\u6cd5\u5c31\u662f\u4e0d\u7528 simple \u51fd\u6570\n                        else\n                            simple(a[j]);\n                    }\n                    pu(s);\n                    st[s].clear();\n                    // \u539f\u5148\u8f85\u52a9\u6808 spt \u6b64\u65f6\u5b58\u5728\u4e00\u4e2a\u5143\u7d20 p\n                    // s \u539f\u5148\u6808\u5e95\u5230\u6808\u9876\u4e3a x\uff0cy\uff0c \u73b0\u5728\u4e3a\u7a7a\n                    // s \u4f5c\u4e3a\u65b0\u7684 spt\n                    // \u4f9d\u6b64\u66f4\u65b0 id \u548c q\n                    id[x] = id[y] = 0;\n                    id[p] = spt;\n                    q.push(spt);\n                    spt = s;\n                }\n            }\n\n            i = r; // \u6ce8\u610f\u5faa\u73af\u4f1a\u81ea\u5e26 ++i\uff0c\u4e0b\u4e00\u6b21\u5faa\u73af i = r + 1\n        }\n\n        printf(\"%d\\n\", (int)ans.size());\n        for (pii p : ans) {\n            if (p.second)\n                printf(\"2 %d %d\\n\", p.first, p.second);\n            else\n                printf(\"1 %d\\n\", p.first);\n        }\n    }\n}\n```\n\n\u5220\u9664\u6ce8\u91ca\u548c\u4e0d\u5fc5\u8981\u7684\u7a7a\u683c\uff0c\u5e76\u4e14\u4ecd\u7136\u4fdd\u6301\u5f88\u9ad8\u7684\u53ef\u8bfb\u6027\u540e\uff0c\u4ee3\u7801\u957f\u5ea6\u662f\u4e0d\u8db3 2K \u7684\uff0c\u51e0\u4e4e\u4f18\u4e8e\u6240\u6709 AC \u63d0\u4ea4\u3002\u800c\u4e14\uff0c\u53ef\u8bfb\u6027\u975e\u5e38\u597d\u3002\n\n\u5982\u679c\u89c9\u5f97\u8fd9\u7bc7\u9898\u89e3\u5199\u5f97\u597d\uff0c\u8bf7\u4e0d\u8981\u5fd8\u8bb0\u70b9\u8d5e\uff0c\u8c22\u8c22\uff01",
        "postTime": 1670132150,
        "uid": 120868,
        "name": "dbxxx",
        "ccfLevel": 6,
        "title": "P8866"
    },
    {
        "content": "\u597d\u9898\uff0c\u4e3a\u51fa\u9898\u4eba\u70b9\u8d5e\u3002\u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e2a\u7a0d\u5fae\u4e0d\u4e00\u6837\u7684\u505a\u6cd5\u3002\n\n\u6211\u4eec\u5148\u6765\u8003\u8651 $k=2n-2$ \u7684\u60c5\u5f62\u3002\u4e00\u4e2a\u81ea\u7136\u7684\u60f3\u6cd5\u662f\uff0c\u6211\u4eec\u4fdd\u7559\u4e00\u4e2a\u6808\u4e3a\u7a7a\uff0c\u540c\u65f6\u5176\u4ed6\u7684\u6808\u90fd\u81f3\u591a\u653e $2$ \u4e2a\u5143\u7d20\u3002\u8fd9\u6837\u7684\u8bdd\uff0c\u6bcf\u6b21\u5904\u7406\u4e00\u5f20\u724c\u65f6\uff0c\u5982\u679c\u8fd9\u5f20\u724c\u7684\u56fe\u6848\u51fa\u73b0\u5728\u67d0\u4e2a\u6808\u7684\u9876\u90e8\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u6254\u5230\u8be5\u6808\u6808\u9876\u6d88\u6389\uff1b\u5982\u679c\u51fa\u73b0\u5728\u67d0\u4e2a\u6808\u7684\u5e95\u90e8\uff0c\u90a3\u4e48\u628a\u8fd9\u5f20\u724c\u6254\u5230\u7a7a\u6808\u91cc\uff0c\u7136\u540e\u628a\u4e24\u4e2a\u6808\u6808\u5e95\u540c\u65f6\u6d88\u6389\uff1b\u5426\u5219\u6254\u5230\u67d0\u4e2a\u67d0\u4e2a\u672a\u6ee1\u7684\u6808\u91cc\u5373\u53ef\u3002\u7531\u4e8e\u81f3\u591a\u53ea\u6709 $2n-2$ \u79cd\u56fe\u6848\uff0c\u8fd9\u6837\u7684\u65b9\u6cd5\u603b\u662f\u884c\u5f97\u901a\u7684\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651 $k=2n-1$ \u7684\u60c5\u5f62\u3002\u4e0a\u9762\u7684\u505a\u6cd5\u76f4\u63a5\u5957\u7528\u4f1a\u9047\u5230\u4e00\u4e2a\u95ee\u9898\uff1a\u53ef\u80fd\u5f53\u524d $2n-2$ \u79cd\u56fe\u6848\u5df2\u7ecf\u628a $n-1$ \u4e2a\u6808\u90fd\u5360\u6ee1\u4e86\uff0c\u63a5\u4e0b\u6765\u53c8\u51fa\u73b0\u4e86\u5269\u4e0b\u7684\u90a3\u79cd\u56fe\u6848\uff08\u8bb0\u4e3a $u$\uff09\u3002\u6b64\u65f6\u5982\u679c\u628a\u5b83\u6254\u5230\u7a7a\u6808\u91cc\uff0c\u4f1a\u8ba9\u5176\u4ed6\u6808\u7684\u6808\u5e95\u5f39\u4e0d\u51fa\u6765\uff1b\u5982\u679c\u6254\u5230\u6ee1\u7684\u6808\u4e0a\uff0c\u53c8\u4f1a\u8ba9\u8fd9\u4e2a\u6808\u7684\u4e2d\u95f4\u5143\u7d20\u5904\u5883\u975e\u5e38\u5c34\u5c2c\u3002\u6211\u4eec\u9700\u8981\u7075\u6d3b\u5904\u7406\u8fd9\u6837\u7684\u60c5\u51b5\u3002\n\n\u89e3\u51b3\u65b9\u6848\u662f\u8fd9\u6837\u7684\u3002\u8bb0\u5f53\u524d\u6240\u6709\u5728\u6808\u9876\u7684 $n-1$ \u4e2a\u5143\u7d20\u6784\u6210\u96c6\u5408 $S$\u3002\u6211\u4eec\u4e0d\u65ad\u626b\u63cf\u4e4b\u540e\u7684\u56fe\u6848\uff0c\u76f4\u5230\u9047\u5230\u7b2c\u4e00\u4e2a\u4e0d\u5728 $S$ \u4e2d\u7684\u56fe\u6848\u4e3a\u6b62\u3002\uff08\u6ce8\u610f\u5230\u7531\u4e8e\u6bcf\u4e2a\u5143\u7d20\u5728\u603b\u64cd\u4f5c\u5e8f\u5217\u4e2d\u51fa\u73b0\u7684\u6b21\u6570\u90fd\u662f\u5076\u6570\uff0c\u6545\u6bcf\u4e2a\u5143\u7d20\u4e4b\u540e\u90fd\u8fd8\u4f1a\u51fa\u73b0\u81f3\u5c11\u4e00\u6b21\u3002\uff09\n\n- \u5982\u679c\u8fd9\u4e2a\u56fe\u6848\u5c31\u662f $u$\uff1a\u6211\u4eec\u628a\u4e4b\u524d\u7684 $u$ \u548c\u73b0\u5728\u7684 $u$ \u90fd\u6254\u5230\u7a7a\u6808\u91cc\uff0c\u5b83\u4eec\u5c31\u6d88\u6389\u4e86\u3002\u4e2d\u95f4\u7684\u6240\u6709\u5143\u7d20\u90fd\u662f\u6808\u9876\uff0c\u53ef\u4ee5\u76f4\u63a5\u6254\u5230\u5bf9\u5e94\u7684\u6808\u4e0a\u3002\n- \u5982\u679c\u8fd9\u4e2a\u56fe\u6848\u4e0d\u662f $u$\uff1a\u90a3\u4e48\u8fd9\u4e2a\u56fe\u6848 $v$ \u662f\u67d0\u4e2a\u6808 $P$ \u7684\u6808\u5e95\u3002\u8bb0 $P$ \u7684\u6808\u9876\u4e3a $w$\uff0c\u6211\u4eec\u6765\u8ba8\u8bba $w$ \u5728\u521a\u521a\u626b\u63cf\u8fc7\u7684\u6240\u6709\u56fe\u6848\u4e2d\u51fa\u73b0\u6b21\u6570\u7684\u5947\u5076\u6027\uff1a\n- - \u5947\u6570\u6b21\uff1a\u6211\u4eec\u628a $u$ \u6254\u5230\u7a7a\u6808\u91cc\uff0c\u6240\u6709\u7684 $w$ \u90fd\u6254\u5230 $P$ \u91cc\u3002\u8fd9\u6837 $v$ \u518d\u6b21\u51fa\u73b0\u7684\u65f6\u5019\uff0c$P$ \u4e0a\u9762\u7684 $u$ \u88ab\u6e05\u7a7a\u4e86\uff0c\u6b64\u65f6\u53ef\u4ee5\u76f4\u63a5\u628a $v$ \u6d88\u6389\uff0c$P$ \u53d8\u6210\u65b0\u7684\u7a7a\u6808\u3002\n  - \u5076\u6570\u6b21\uff1a\u6211\u4eec\u628a $u$ \u6254\u5230 $P$ \u91cc\uff0c\u6240\u6709\u7684 $w$ \u4e5f\u6254\u5230 $P$ \u91cc\u3002\u8fd9\u6837 $v$ \u518d\u6b21\u51fa\u73b0\u7684\u65f6\u5019\uff0c$P$ \u4e2d\u81ea\u9876\u5230\u5e95\u5206\u522b\u662f $u,w,v$ \u4e09\u4e2a\u5143\u7d20\u3002\u628a $v$ \u6254\u8fdb\u7a7a\u6808\u91cc\uff0c\u518d\u6d88\u6389 $P$ \u548c\u7a7a\u6808\u7684\u6808\u5e95\uff0c\u8fd9\u6837\u5c31\u4ecd\u7136\u7ef4\u6301\u4e86 $P$ \u4e2d\u53ea\u6709\u4e24\u4e2a\u5143\u7d20\u7684\u6761\u4ef6\u3002\n- \u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u5176\u4ed6\u6808\u9876\u5143\u7d20\u6254\u5230\u5bf9\u5e94\u6808\u9876\u5373\u53ef\u3002\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u89e3\u51b3\u4e86\u6b64\u9898\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(m)$\u3002\n\n\u4e00\u4e9b\u9898\u5916\u8bdd\uff1a\u5982\u679c\u6e38\u620f\u66f4\u6539\u4e00\u4e0b\u89c4\u5219\uff0c\u4f8b\u5982\n\n- \u73a9\u5bb6\u5fc5\u987b\u5728\u8bfb\u5165\u6bcf\u4e2a\u56fe\u6848\u540e\u5c31\u7acb\u5373\u51b3\u5b9a\u8be5\u56fe\u6848\u5e94\u8be5\u653e\u8fdb\u90a3\u4e2a\u6808\u91cc\u3002\n\n\u90a3\u4e48 $k=2n-1$ \u65f6\u5f88\u6709\u53ef\u80fd\u73a9\u5bb6\u662f\u5fc5\u8d25\u7684\u3002\u8fd9\u4e5f\u542f\u793a\u6211\u4eec\u5728\u4f5c\u5f53\u524d\u51b3\u7b56\u65f6\u5fc5\u987b\u8003\u8651\u4e4b\u540e\u7684\u56fe\u6848\u3002\u8003\u8651\u5230\u8fd9\u4e00\u70b9\u540e\u672c\u9898\u5c31\u4e0d\u662f\u7279\u522b\u68d8\u624b\u4e86\u3002\n\n```cpp\n#include<cstdio>\n#include<vector>\n\nusing namespace std;\n\nint up[3000],down[3000],val[3000][2],sz[3000],a[3000000];\nint sta[3000];\n\nint main()\n{\n\t//freopen(\"meow.in\",\"r\",stdin);\n\t//freopen(\"meow.out\",\"w\",stdout);\n\tint TT=0;scanf(\"%d\",&TT);\n\twhile(TT--)\n\t{\n\t\tint n=0,m=0,k=0;scanf(\"%d%d%d\",&n,&m,&k);for(int i=1;i<=m;i++)scanf(\"%d\",&a[i]);\n\t\tk=2*n-1;\n\t\tvector<int> L;for(int i=1;i<n;i++)L.push_back(i);\n\t\tvector<pair<int,int> > V;\n\t\tint empty=n;\n\t\tfor(int l=1,r=0;l<=m;l=r+1)\n\t\t{\n\t\t\tr=l;int i=l;\n\t\t\tif(down[a[i]])\n\t\t\t{\n\t\t\t\tint u=down[a[i]];\n\t\t\t\tV.push_back(make_pair(empty,0));V.push_back(make_pair(u,empty));\n\t\t\t\t//printf(\"1 %d\\n\",empty);printf(\"2 %d %d\\n\",u,empty);\n\t\t\t\tif(sz[u]==2){int v=val[u][1];val[u][0]=v,val[u][1]=0;sz[u]=1;up[v]=0,down[v]=u;L.push_back(u);}\n\t\t\t\telse{val[u][0]=0;sz[u]=0;}\n\t\t\t\tdown[a[i]]=0;\n\t\t\t}\n\t\t\telse if(up[a[i]])\n\t\t\t{\n\t\t\t\tint u=up[a[i]];\n\t\t\t\tV.push_back(make_pair(u,0));\n\t\t\t\t//printf(\"1 %d\\n\",u);\n\t\t\t\tup[a[i]]=0;sz[u]=1;val[u][1]=0;\n\t\t\t\tL.push_back(u);\n\t\t\t}\n\t\t\telse if(!L.empty())\n\t\t\t{\n\t\t\t\tint u=L.back();L.pop_back();\n\t\t\t\tV.push_back(make_pair(u,0));\n\t\t\t\t//printf(\"1 %d\\n\",u);\n\t\t\t\tif(sz[u]==0)\n\t\t\t\t{\n\t\t\t\t\tval[u][0]=a[i];sz[u]=1;down[a[i]]=u;\n\t\t\t\t\t\n\t\t\t\t\tL.push_back(u);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tval[u][1]=a[i];sz[u]=2;up[a[i]]=u;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twhile(r+1<=m)\n\t\t\t\t{\n\t\t\t\t\tr++;\n\t\t\t\t\tif(a[r]==a[i])\n\t\t\t\t\t{\n\t\t\t\t\t\tV.push_back(make_pair(empty,0));\n\t\t\t\t\t\t//printf(\"1 %d\\n\",empty);\n\t\t\t\t\t\tfor(int x=l+1;x<r;x++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tV.push_back(make_pair(up[a[x]],0));\n\t\t\t\t\t\t\t//printf(\"1 %d\\n\",up[a[x]]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor(int x=l+1;x<r;x++)if(up[a[x]]&&sta[up[a[x]]])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tint u=up[a[x]];\n\t\t\t\t\t\t\tsta[u]=0;val[u][1]=0;up[a[x]]=0;sz[u]=1;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tL.push_back(u);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tV.push_back(make_pair(empty,0));\n\t\t\t\t\t\t//printf(\"1 %d\\n\",empty);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(down[a[r]])\n\t\t\t\t\t{\n\t\t\t\t\t\tint u=down[a[r]];\n\t\t\t\t\t\tif(sta[u])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tV.push_back(make_pair(empty,0));\n\t\t\t\t\t\t//printf(\"1 %d\\n\",empty);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tV.push_back(make_pair(u,0));\n\t\t\t\t\t\t\t//printf(\"1 %d\\n\",u);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tfor(int x=l+1;x<r;x++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tV.push_back(make_pair(up[a[x]],0));\n\t\t\t\t\t\t\t//printf(\"1 %d\\n\",up[a[x]]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor(int x=l+1;x<r;x++)if(up[a[x]]&&sta[up[a[x]]]&&up[a[x]]!=u)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tint u=up[a[x]];\n\t\t\t\t\t\t\tsta[u]=0;val[u][1]=0;up[a[x]]=0;sz[u]=1;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tL.push_back(u);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(sta[u])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tV.push_back(make_pair(u,0));\n\t\t\t\t\t\t\t//printf(\"1 %d\\n\",u);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tsta[u]=0;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tdown[val[u][0]]=up[val[u][1]]=0;\n\t\t\t\t\t\t\tval[u][0]=val[u][1]=0;sz[u]=0;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tdown[a[l]]=empty;val[empty][0]=a[l];sz[empty]=1;\n\t\t\t\t\t\t\tL.push_back(empty);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tempty=u;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tV.push_back(make_pair(empty,0));\n\t\t\t\t\t\t\tV.push_back(make_pair(u,empty));\n\t\t\t\t\t\t\t//printf(\"1 %d\\n\",empty);\n\t\t\t\t\t\t\t//printf(\"2 %d %d\\n\",u,empty);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tdown[val[u][0]]=0;\n\t\t\t\t\t\t\tup[val[u][1]]=0;down[val[u][1]]=u;\n\t\t\t\t\t\t\tup[a[l]]=u;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tval[u][0]=val[u][1];val[u][1]=a[l];\n\t\t\t\t\t\t\tsz[u]=2;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tsta[up[a[r]]]^=1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",V.size());\n\t\tfor(int i=0;i<V.size();i++)\n\t\t{\n\t\t\tif(V[i].second==0)printf(\"1 %d\\n\",V[i].first);\n\t\t\telse printf(\"2 %d %d\\n\",V[i].first,V[i].second);\n\t\t}\n\t}\n}\n```",
        "postTime": 1669949369,
        "uid": 112794,
        "name": "\u5468\u5b50\u8861",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P8866\u3010[NOIP 2022] \u55b5\u4e86\u4e2a\u55b5\u3011"
    },
    {
        "content": "\u6b64\u9898\u89e3\u7eaa\u5ff5\u6211\u7b2c\u4e00\u6b21\u5728 NOIP \u8003\u573a\u4e0a\u901a\u8fc7 T2\u3002\n\n\u9996\u5148\u8003\u8651 $k = 2n - 2$ \u7684\u60c5\u51b5\u3002\u8fd9\u79cd\u60c5\u51b5\u53ea\u8981\u7528\u524d $n - 1$ \u4e2a\u6808\u653e\u5361\u724c\uff0c\u6700\u540e\u4e00\u4e2a\u6808\u7528\u6765\u6d88\u9664\u4e0b\u5c42\u5361\u724c\u3002\n\n\u5b9a\u4e49\u201c\u7b80\u5355\u60c5\u51b5\u201d\u8868\u793a\u6240\u6709\u6808\u4e2d\u5361\u724c\u6570\u91cf\u5747\u4e0d\u8d85\u8fc7 2\uff0c\u4e14\u81f3\u5c11\u6709\u4e00\u4e2a\u7a7a\u6808\u7684\u60c5\u51b5\u3002\u6bcf\u79cd\u5361\u724c\u7684\u7b2c\u5947\u6570\u3001\u5076\u6570\u5f20\u5206\u522b\u79f0\u4e3a\u5165\u6808\u724c\u3001\u51fa\u6808\u724c\u3002\n\n\u518d\u8003\u8651 $k = 2n - 1$\u3002\u5982\u679c\u73b0\u5728\u5df2\u7ecf\u6709 $n - 1$ \u4e2a\u653e\u4e86 2 \u5f20\u5361\u724c\u7684\u6808\u548c\u4e00\u4e2a\u7a7a\u6808\uff0c\u5f53\u524d\u7684\u724c\u4e3a\u5165\u6808\u724c\uff0c\u4e00\u79cd\u65b9\u6cd5\u662f\u653e\u5728\u7a7a\u6808\uff0c\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u653e\u5728\u4e00\u4e2a\u5df2\u7ecf\u6709 2 \u5f20\u5361\u724c\u7684\u6808\u9876\u3002\n\n\u4f46\u662f\uff0c\u8fd9\u4e24\u79cd\u65b9\u6cd5\u90fd\u5b58\u5728\u95ee\u9898\u3002\u65b9\u6cd5\u4e00\u653e\u5b8c\u4e4b\u540e\u4e0d\u5b58\u5728\u7a7a\u6808\uff0c\u5982\u679c\u63a5\u4e0b\u6765\u51fa\u73b0\u4e0b\u5c42\u5361\u724c\u7684\u51fa\u6808\u724c\uff0c\u90a3\u5c31\u5bc4\u4e86\u3002\u65b9\u6cd5\u4e8c\u653e\u5b8c\u4e4b\u540e\u4f1a\u5b58\u5728\u4e00\u4e2a\u6709 3 \u5f20\u5361\u724c\u7684\u6808\uff0c\u4e2d\u95f4\u7684\u724c\u6d88\u4e0d\u6389\u3002\n\n\u6ce8\u610f\u5230 3 \u5f20\u5361\u724c\u7684\u6808\u5982\u679c\u5728\u9047\u5230\u4e2d\u95f4\u724c\u7684\u51fa\u6808\u724c\u4e4b\u524d\u5c31\u53d8\u6210 2 \u5f20\u5361\u724c\uff0c\u5c31\u4e0d\u4f1a\u5b58\u5728\u95ee\u9898\u3002\u6240\u4ee5\uff0c\u4f7f\u7528\u65b9\u6cd5\u4e8c\u65f6\u8981\u627e\u5230\u4e00\u4e2a\u4e0a\u5c42\u724c\u51fa\u6808\u6bd4\u4e0b\u5c42\u724c\u665a\u7684\u6808\uff0c\u4e0b\u5c42\u724c\u5fc5\u5b9a\u5148\u88ab\u6d88\u9664\uff0c\u800c\u5176\u4ed6\u6808\u91cc\u7684\u724c\u90fd\u80fd\u5728\u81ea\u5df1\u7684\u6808\u548c\u7a7a\u6808\u4e2d\u89e3\u51b3\uff0c\u4e0d\u4f1a\u6709\u5f71\u54cd\u3002\u6d88\u9664\u4e4b\u540e\u5c31\u8f6c\u5316\u4e3a\u7b80\u5355\u60c5\u51b5\u3002\n\n\u5982\u679c\u627e\u4e0d\u5230\u8fd9\u6837\u7684\u6808\u600e\u4e48\u529e\uff1f\u4e0d\u5b58\u5728\u4e0a\u5c42\u724c\u51fa\u6808\u6bd4\u4e0b\u5c42\u724c\u665a\u7684\u6808\uff0c\u5219\u6d88\u9664\u4e0b\u5c42\u724c\u4e4b\u524d\uff0c\u5bf9\u5e94\u7684\u4e0a\u5c42\u724c\u5fc5\u5b9a\u88ab\u6d88\u9664\u3002\u6240\u4ee5\u7528\u65b9\u6cd5\u4e00\u5373\u53ef\u3002\n\n\u4f46\u662f\u53ef\u80fd\u5b58\u5728\u4e0a\u5c42\u724c\u51fa\u6808\u4e4b\u540e\u7acb\u523b\u5165\u6808\u7684\u60c5\u51b5\u3002\u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5\uff0c\u5165\u6808\u65f6\u8fdb\u884c\u5fae\u8c03\uff0c\u9009\u62e9\u6709 1 \u5f20\u724c\uff0c\u4e14\u8fd9\u5f20\u724c\u51fa\u6808\u8f83\u665a\u7684\u6808\u653e\u5165\u5373\u53ef\u3002\u8fd9\u6837\u53ef\u4ee5\u4fdd\u8bc1\u5728\u6d88\u9664\u7b2c\u4e00\u5f20\u4e0b\u5c42\u724c\u65f6\uff0c\u8fd9\u5f20\u724c\u5728\u6808\u9876\uff0c\u6d88\u9664\u8fd9\u5f20\u724c\u5373\u53ef\u8f6c\u5316\u4e3a\u7b80\u5355\u60c5\u51b5\u3002\n\n\u6700\u540e\u5229\u7528\u7a7a\u6808\u8fdb\u884c\u6d88\u9664\u5373\u53ef\u3002\n\n\u603b\u7ed3\u4e00\u4e0b\u653e\u724c\u7684\u65b9\u6cd5\uff1a\u9047\u5230\u5165\u6808\u724c\uff0c\u5982\u679c\u5b58\u5728\u4e24\u4e2a\u4ee5\u4e0a\u7a7a\u6808\uff0c\u653e\u5165\u7a7a\u6808\u5373\u53ef\uff1b\u5426\u5219\u627e\u6709 1 \u5f20\u724c\u7684\u6808\uff0c\u653e\u5165\u724c\u51fa\u6808\u6700\u665a\u7684\u6808\uff1b\u82e5\u6ca1\u6709\uff0c\u627e\u6709 2 \u5f20\u724c\uff0c\u4e14\u4e0a\u5c42\u724c\u51fa\u6808\u6bd4\u4e0b\u5c42\u724c\u665a\u7684\u6808\uff1b\u518d\u627e\u4e0d\u5230\uff0c\u5c31\u653e\u5165\u7a7a\u6808\u3002\u9047\u5230\u51fa\u6808\u724c\uff0c\u5982\u679c\u6d88\u9664\u7684\u724c\u5728\u6808\u9876\uff0c\u76f4\u63a5\u6d88\u53bb\u3002\u5982\u679c\u6d88\u9664\u7684\u724c\u5728\u6808\u5e95\uff0c\u6b64\u65f6\u5fc5\u7136\u5b58\u5728\u7a7a\u6808\uff0c\u5229\u7528\u7a7a\u6808\u6d88\u9664\u3002\n\n\u7528 3 \u4e2a set \u5206\u522b\u7ef4\u62a4\u6709 0 \u5f20\u30011 \u5f20\u30012 \u5f20\u724c\u7684\u6808\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(S \\log n)$\u3002\u636e\u8bf4\u53ef\u4ee5\u7ebf\u6027\uff0c\u4f46\u662f\u6211\u4e0d\u4f1a\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef pair<int, int> pii;\nconst int N = 2e6 + 5;\nint T, n, m, k;\nint tim[N], last[N], a[N], pos[N];\nint len[N], out[N][4];\nset<pii, greater<pii>> q[3];\n\nstruct Triple {\n\tint x, y, z;\n\t\n\tTriple(int _x = 0, int _y = 0, int _z = 0) : x(_x), y(_y), z(_z) {}\n};\n\nvector<Triple> ans;\n\ninline void put(int x, int s) {\n\tpos[x] = s;\n\tans.emplace_back(1, s, 0);\n}\n\nvoid solve() {\n\tfor (int i = 1; i <= m; ++i) {\n\t\tif (last[a[i]]) tim[last[a[i]]] = i, last[a[i]] = 0;\n\t\telse last[a[i]] = i;\n\t}\n\tfor (int i = 1; i <= n; ++i) {\n\t\tq[0].insert(pii(0, i));\n\t\tlen[i] = 0;\n\t}\n\tfor (int i = 1; i <= m; ++i) {\n\t\tif (tim[i]) {\n\t\t\tlast[a[i]] = i;\n\t\t\tif (q[0].size() >= 2u) {\n\t\t\t\tauto it = q[0].begin();\n\t\t\t\tint id = it->second;\n\t\t\t\tq[0].erase(it);\n\t\t\t\tout[id][++len[id]] = i;\n\t\t\t\tput(i, id);\n\t\t\t\tq[1].insert(pii(tim[i], id));\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!q[1].empty()) {\n\t\t\t\tauto it = q[1].begin();\n\t\t\t\tint id = it->second, t = it->first;\n\t\t\t\tq[1].erase(it);\n\t\t\t\tout[id][++len[id]] = i;\n\t\t\t\tput(i, id);\n\t\t\t\tq[2].insert(pii(tim[i] > t, id));\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!q[2].empty() && q[2].begin()->first) {\n\t\t\t\tauto it = q[2].begin();\n\t\t\t\tint id = it->second;\n\t\t\t\tq[2].erase(it);\n\t\t\t\tout[id][++len[id]] = i;\n\t\t\t\tput(i, id);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tauto it = q[0].begin();\n\t\t\tint id = it->second;\n\t\t\tq[0].erase(it);\n\t\t\tout[id][++len[id]] = i;\n\t\t\tput(i, id);\n\t\t\tq[1].insert(pii(tim[i], id));\n\t\t} else {\n\t\t\tint j = last[a[i]], id = pos[j];\n\t\t\tif (out[id][len[id]] == j) {\n\t\t\t\tans.emplace_back(1, id, 0);\n\t\t\t\tif (len[id] == 1)\n\t\t\t\t\tq[1].erase(pii(tim[out[id][1]], id));\n\t\t\t\telse if (len[id] == 2)\n\t\t\t\t\tq[2].erase(pii(tim[out[id][2]] > tim[out[id][1]], id));\n\t\t\t\t--len[id];\n\t\t\t\tif (len[id] == 0)\n\t\t\t\t\tq[0].insert(pii(0, id));\n\t\t\t\telse if (len[id] == 1)\n\t\t\t\t\tq[1].insert(pii(tim[out[id][1]], id));\n\t\t\t\telse\n\t\t\t\t\tq[2].insert(pii(tim[out[id][2]] > tim[out[id][1]], id));\n\t\t\t} else {\n\t\t\t\tint tmp = q[0].begin()->second;\n\t\t\t\tans.emplace_back(1, tmp, 0);\n\t\t\t\tans.emplace_back(2, id, tmp);\n\t\t\t\tif (len[id] == 1)\n\t\t\t\t\tq[1].erase(pii(tim[out[id][1]], id));\n\t\t\t\telse if (len[id] == 2)\n\t\t\t\t\tq[2].erase(pii(tim[out[id][2]] > tim[out[id][1]], id));\n\t\t\t\t--len[id];\n\t\t\t\tfor (int k = 1; k <= len[id]; ++k)\n\t\t\t\t\tout[id][k] = out[id][k + 1];\n\t\t\t\tif (len[id] == 0)\n\t\t\t\t\tq[0].insert(pii(0, id));\n\t\t\t\telse if (len[id] == 1)\n\t\t\t\t\tq[1].insert(pii(tim[out[id][1]], id));\n\t\t\t\telse\n\t\t\t\t\tq[2].insert(pii(tim[out[id][2]] > tim[out[id][1]], id));\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans.size() << '\\n';\n\tfor (auto res : ans) {\n\t\tif (res.x == 1)\n\t\t\tcout << \"1 \" << res.y << '\\n';\n\t\telse \n\t\t\tcout << \"2 \" << res.y << ' ' << res.z << '\\n';\n\t}\t\n}\n\ninline void clear() {\n\tint mx = max({n, m, k});\n\tfor (int i = 1; i <= mx; ++i)\n\t\ttim[i] = last[i] = a[i] = pos[i] = len[i] = 0;\n\tq[0].clear();\n\tq[1].clear();\n\tq[2].clear();\n\tans.clear();\n}\n\nint main() {\n\tfreopen(\"meow.in\", \"r\", stdin);\n\tfreopen(\"meow.out\", \"w\", stdout);\n\tios::sync_with_stdio(0);\n\tcin.tie(0);\n\tcin >> T;\n\twhile (T--) {\n\t\tcin >> n >> m >> k;\n\t\tfor (int i = 1; i <= m; ++i)\n\t\t\tcin >> a[i];\n\t\tsolve();\n\t\tclear();\n\t}\n\treturn 0;\n} \n```\n",
        "postTime": 1669720480,
        "uid": 233442,
        "name": "SSH_automaton",
        "ccfLevel": 7,
        "title": "P8866 [NOIP2022] \u55b5\u4e86\u4e2a\u55b5 \u9898\u89e3"
    },
    {
        "content": "upd on 12/4 \u4fee\u590d\u4e00\u4e2a\u5c0f\u9505\u3002\n\n\n\n------------\n\n\n\u4e0d\u505a\u8bc4\u4ef7\uff0c\u5176\u5b9e\u4e0d\u96be\u3002\n\n\u9996\u5148 $k=2n-2$ \u7684\u60c5\u51b5\u5e94\u8be5\u5927\u5bb6\u90fd\u4f1a\u3002\n\n\u5148\u7ed9\u79cd\u7c7b\u4e24\u4e24\u5206\u7ec4\uff0c\u5e76\u7ed9\u6bcf\u4e00\u7ec4\u5206\u914d\u4e00\u4e2a\u6808\uff0c\u4e0d\u96be\u53d1\u73b0\u6709\u4e2a\u7a7a\u6808\u3002\n\n\u51fa\u73b0\u4e00\u4e2a\u6570\u65f6\uff0c\u82e5\u5df2\u7ecf\u5b58\u5728\u8fd9\u4e2a\u6570\uff0c\u90a3\u5c31\u6839\u636e\u5b83\u5728\uff1a\n\n- \u6808\u9876\uff1a\u76f4\u63a5\u653e\u5230\u8be5\u6808\u7684\u4e0a\u65b9\u6d88\u53bb\u3002\n- \u6808\u5e95\uff1a\u653e\u5165\u7a7a\u6808\uff0c\u7136\u540e\u7528\u64cd\u4f5c $2$ \u6d88\u53bb\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u7a7a\u6808\u5728\u6bcf\u51fa\u73b0\u4e00\u4e2a\u6570\u7684\u64cd\u4f5c\u7ed3\u675f\u4e4b\u540e\uff0c\u5fc5\u7136\u4e3a\u7a7a\u3002\n\n---\n\n\u60f3\u4e00\u60f3 $k=2n-1$ \u4f1a\u51fa\u73b0\u7684\u6781\u7aef\u65f6\u5019\u3002\n\n\u90a3\u4e00\u5b9a\u662f\u5c40\u9762\u4e0a\u653e\u6ee1\u4e86\u4e1c\u897f\u3002\n\n\u653e\u8fdb\u53bb\u4e0d\u662f\u653e\u5728\u4e00\u4e2a\u5927\u5c0f\u4e3a 2 \u7684\u6808\u7684\u4e0a\u9762\uff0c\u5c31\u662f\u5728\u7a7a\u6808\u3002\n\n\u8bbe\u8fd9\u4e2a\u653e\u8fdb\u53bb\u7684\u6570\u4e3a $t$\u3002\n\n\u5982\u679c\u653e\u5728\u5927\u5c0f\u4e3a 2 \u7684\u6808\u4e0a\u9762\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6808\u5e95\u8981\u62bd\u6389\uff0c\u8fd9\u6837\u624d\u7b26\u5408\u6bcf\u4e2a\u6808\u5927\u5c0f\u90fd\u662f $2$ \u7684\u7f8e\u597d\u5e0c\u671b\u3002\n\n\u6808\u5e95\u8981\u62bd\u6389\uff0c\u90a3\u4e48\u6808\u9876\u4e0d\u80fd\u51fa\u73b0\uff0c\u5426\u5219\u4e00\u653e\u4e0a\u6765\uff0c\u5c31 GG\u3002\n\n\u6240\u4ee5**\u627e\u4e0b\u4e00\u4e2a\u51fa\u7684\u6808\u5e95\uff0c\u5e76\u4e14\u8fd9\u65f6\u5019\u6808\u9876\u8fd8\u6ca1\u51fa\u3002\u628a $t$ \u653e\u5728\u6808\u9876\u3002**\n\n\u8fdb\u8fc7\u4e00\u7cfb\u5217\u64cd\u4f5c\u540e\uff0c\u539f\u6765\u7684\u6808\u5e95\u51fa\u53bb\u4e86\uff0c\u6808\u9876\u53d8\u6210\u4e86\u65b0\u6808\u5e95\uff0c$t$ \u53d8\u6210\u6808\u9876\u3002\n\n---\n\n\u8fd8\u6709\u4e00\u79cd\u6bd4\u8f83\u7b80\u5355\u7684\u60c5\u51b5\u3002\n\n\u5c31\u662f\u5728\u6bcf\u4e2a\u6808\u5e95\u90fd\u8fd8\u672a\u51fa\u7684\u65f6\u5019\uff0c\u51fa\u73b0\u4e86 $t$\u3002\n\n**\u76f4\u63a5\u628a $t$ \u653e\u8fdb\u7a7a\u4f4d\uff0c\u7b49\u5f85\u4e0b\u4e00\u4e2a $t$\u3002**\n\n\u56e0\u4e3a\u540e\u9762\u53ea\u4f1a \u51fa/\u5165 \u6808\u9876\uff0c\u6240\u4ee5\u7a7a\u6808\u6ca1\u6709\u7528\uff0c\u6b63\u597d\u7ed9 $t$ \u7528\u3002\n\n---\n\n\u5982\u679c\u4e0d\u6ee1\u8db3\u4ee5\u4e0a\u4e24\u79cd\u60c5\u51b5\u3002\n\n\u56e0\u4e3a\u8fd9\u4e2a\u65f6\u5019\uff0c\u627e\u4e0b\u4e00\u4e2a\u51fa\u7684\u6808\u5e95\uff08\u8bbe\u4e3a $u$\uff0c\u4e0e\u4e4b\u5bf9\u5e94\u7684\u6808\u9876\u4e3a $v$\uff09\uff0c$v$ \u4e00\u5b9a\u5728\u4e4b\u524d\u51fa\u73b0\u8fc7\u3002\n\n\u6240\u4ee5\u6211\u7684\u60f3\u6cd5\u5c31\u662f\u628a\u90a3\u4e2a\u6808\u53d8\u6210\u65b0\u7684\u7a7a\u6808\u3002\n\n\u5177\u4f53\u7684\uff0c**\u5148\u628a $t$ \u653e\u5165\u7a7a\u6808\uff0c\u5728\u7b2c\u4e00\u6b21 $v$ \u51fa\u73b0\uff08\u8fd9\u65f6\u5019\uff09\u7684\u65f6\u5019\uff0c\u6309\u6b63\u5e38\u64cd\u4f5c\uff0c\u5c06 $v$ \u653e\u5165\u5b83\u6240\u5728\u7684\u6808\u5c06\u5176\u6d88\u9664\u3002\u7b2c\u4e8c\u6b21\u53ca\u4ee5\u540e\u7684\u51fa\u73b0\uff0c\u653e\u5728 $t$ \u7684\u4e0a\u9762\u3002$u$ \u51fa\u73b0\u540e\uff0c\u4f1a\u5e26\u6765\u4e00\u4e2a\u65b0\u7684\u7a7a\u6808\u3002**\n\n\u4ee5\u4e0a\u5c31\u662f\u5168\u90e8\u3002\n\n\u5206\u7c7b\u8ba8\u8bba\u5f88\u9ebb\u70e6\u3002\n\n\u9644\u4e0a\u8d5b\u65f6\u53bb\u6ce8\u91ca\u4ee3\u7801\u3002\n\n\u590d\u6742\u5ea6 $O(m)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define ull unsigned ll\n#define INF 0x3f3f3f3f\n#define INFLL 0x3f3f3f3f3f3f3f3fll\n#define For(i_,l_,r_) for(int i_=(l_);i_<=(r_);i_++)\n#define Rep(i_,l_,r_) for(int i_=(l_);i_>=(r_);i_--)\nusing namespace std;\n#define Ci const int\n#define Cl const ll\n#define Cul const ull\n#define Cc const char\nint _l=-1,_p;Ci inS=1<<18,ouS=1<<18;\nchar _c[inS],*_u=_c,*_v=_c,_b[ouS],_d[55];\n#define getchar() (_u==_v&&(_v=(_u=_c)+fread(_c,1,inS,stdin),_u==_v)?EOF:*_u++)\n#define _c_ getchar()\ntemplate<typename T=int>inline T read(){\n\tchar ch=_c_;T X=0;bool fl=0;while(ch<48||ch>57)fl|=(ch==45),ch=_c_;\n\twhile(ch>47&&ch<58)X=X*10+(ch^48),ch=_c_;return fl?-X:X;\n}\ninline char Gec(){\n\tchar ch=_c_;while(ch<33)ch=_c_;return ch;\n}\ninline void flush(){fwrite(_b,1,_l+1,stdout);_l=-1;}\ninline void _pc(Cc c){if(c!=-1)_b[++_l]=c;}\ninline void _chf(){if(_l>(ouS>>1))flush();}\ntemplate<typename T=int>inline void write(T x,Cc c=-1){\n\tif(x<0)_pc(45),x=-x;do{_d[++_p]=(x%10)|48;}while(x/=10);\n\tdo{_b[++_l]=_d[_p];}while(--_p);_pc(c);_chf();\n}\ninline void write(Cc c){_pc(c);}\ninline void puc(Cc c){_pc(c);_chf();}\ntemplate<typename T,typename...A>void write(T x,A...a){write(x);write(a...);}\nint n,m,k,a[2000005];\nstruct Q{\n\tint op,x,y;\n}ans[4000005];int ansl;\nint st[305][3],l[305];\nint G[1005],L,emp;\nint vis[1005],GG[1005],tuu[1005];\ninline void work(Ci op,Ci x,Ci y){\n\tans[++ansl]={op,x,y};\n}\ninline void ypa(){\n\tn=read(),m=read(),k=read();\n\tFor(i,1,m)a[i]=read();\n\temp=1;\n\tFor(i,2,n)G[++L]=i;\n\tFor(i,1,m){\n\t\twhile(L&&l[G[L]]>=2)--L;\n\t\tif(!vis[a[i]]){\n\t\t\tif(!L){\n\t\t\t\tFor(i,1,k)GG[i]=0,tuu[i]=vis[i];\n\t\t\t\tFor(j,i+1,m){\n\t\t\t\t\tint I=vis[a[j]];\n\t\t\t\t\tif(st[I][0]==a[j]){\n\t\t\t\t\t\tif(!GG[st[I][1]]){\n\t\t\t\t\t\t\twork(1,I,0);\n\t\t\t\t\t\t\tst[I][l[I]++]=a[i];\n\t\t\t\t\t\t\tvis[a[i]]=I;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tint now=st[I][1],fl=0;\n\t\t\t\t\t\t\twork(1,emp,0);\n\t\t\t\t\t\t\tst[emp][l[emp]++]=a[i];\n\t\t\t\t\t\t\tvis[a[i]]=emp;\n\t\t\t\t\t\t\tFor(J,i+1,j-1){\n\t\t\t\t\t\t\t\tif(vis[a[J]]){\n\t\t\t\t\t\t\t\t\tint II=vis[a[J]];\n\t\t\t\t\t\t\t\t\twork(1,II,0),--l[II];\n\t\t\t\t\t\t\t\t\tvis[a[J]]=0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\tint II;\n\t\t\t\t\t\t\t\t\tif(a[J]==now&&!fl){\n\t\t\t\t\t\t\t\t\t\tII=emp;\n\t\t\t\t\t\t\t\t\t\twork(1,II,0);fl=1;\n\t\t\t\t\t\t\t\t\t\tst[II][l[II]++]=a[J];\n\t\t\t\t\t\t\t\t\t\tvis[a[J]]=II;tuu[a[J]]=II;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\t\tII=tuu[a[J]];\n\t\t\t\t\t\t\t\t\t\twork(1,II,0);\n\t\t\t\t\t\t\t\t\t\tst[II][l[II]++]=a[J];\n\t\t\t\t\t\t\t\t\t\tvis[a[J]]=II;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\twork(1,I,0);--l[I];vis[a[j]]=0;\n\t\t\t\t\t\t\temp=I;i=j;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tGG[a[j]]=1;\n\t\t\t\t\t\tif(a[j]==a[i]){\n\t\t\t\t\t\t\twork(1,emp,0);\n\t\t\t\t\t\t\tst[emp][l[emp]++]=a[i];\n\t\t\t\t\t\t\tvis[a[i]]=emp;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tL=0;\n\t\t\t\tFor(i,1,n)\n\t\t\t\t\tif(l[i]<2&&i!=emp)G[++L]=i;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tint I=G[L];\n\t\t\t\twork(1,I,0);\n\t\t\t\tst[I][l[I]++]=a[i];\n\t\t\t\tif(l[I]>=2)--L;\n\t\t\t\tvis[a[i]]=I;\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tint I=vis[a[i]];\n\t\t\tif(l[I]>=2&&st[I][0]==a[i]){\n\t\t\t\twork(1,emp,0);\n\t\t\t\twork(2,emp,I);\n\t\t\t\t--l[I];\n\t\t\t\tst[I][0]=st[I][1];\n\t\t\t\tst[I][1]=st[I][2];\n\t\t\t}\n\t\t\telse work(1,I,0),--l[I];\n\t\t\tif(l[I]<2&&I!=emp)G[++L]=I;vis[a[i]]=0;\n\t\t}\n\t}\n\twrite(ansl,'\\n');\n\tFor(i,1,ansl){\n\t\tif(ans[i].op==1)write(ans[i].op,' ',ans[i].x,'\\n');\n\t\tif(ans[i].op==2)write(ans[i].op,' ',ans[i].x,' ',ans[i].y,'\\n');\n\t}\n\tflush();\n\tansl=0;L=0;\n\tFor(i,1,k)vis[i]=GG[i]=tuu[i]=G[i]=0;\n\tFor(i,1,n)l[i]=st[i][0]=st[i][1]=st[i][2]=0;\n}\nsigned main(){\n//\tfreopen(\"meow.in\",\"r\",stdin);\n//\tfreopen(\"meow.out\",\"w\",stdout);\n\tint T=read();\n\tFor(I,1,T)ypa();\n\tflush();return 0;\n}\n```",
        "postTime": 1669509837,
        "uid": 185864,
        "name": "TOBapNw",
        "ccfLevel": 7,
        "title": "\u55b5\u4e86\u4e2a\u55b5\u4e86\u4e2a\u55b5\u4e86\u4e2a\u55b5"
    },
    {
        "content": "\u4f30\u8ba1\u662f\u51fa\u9898\u4eba\u89c9\u5f97\u7b80\u5355\u624d\u653e\u5728 T2 \u7684\uff0c\u4f46\u601d\u8def\u867d\u7136\u660e\u4e86\u5f88\u6709\u53ef\u80fd\u60f3\u9519\u3002\r\n\r\n\u8d5b\u65f6\u60f3\u6cd5\uff1a\r\n\r\n- \u597d\u50cf\u5f88\u4e0d\u597d\u505a\uff0c\u4f46\u7559\u4e00\u4e2a\u7a7a\u6808\uff0c\u94a6\u5b9a $2(n-1)$ \u4e2a\u4e0d\u540c\u5143\u7d20\u6bcf\u4e2a\u6808\u653e\u4e24\u4e2a\uff0c\u5c31\u80fd\u505a $k=2n-2$ \u4e86\u3002\r\n- \u53d1\u73b0 $k=2n-1$ \u4f1a\u6709\u65b0\u7684\u6570\u52a0\u8fdb\u6765\u51b2\u7a81\u3002\u624b\u73a9\u53d1\u73b0\u6709\u4e24\u79cd\u60c5\u51b5\u9700\u8981\u65b0\u7684\u6570\u5fc5\u987b\u653e\u5728\u67d0\u4e2a\u6808\u9876\u6216\u8005\u65b0\u7684\u6570\u5fc5\u987b\u653e\u5728\u7a7a\u6808\uff0c\u6700\u540e\u624d\u80fd\u6d88\u7a7a\u3002\r\n- \u7136\u540e\u5206\u7c7b\u8ba8\u8bba\u600e\u6837\u624d\u80fd\u8ba9\u82e5\u5e72\u8f6e\u540e\u518d\u6d88\u51fa\u4e00\u4e2a\u7a7a\u6808\uff0c\u8fd9\u90e8\u5206\u60f3\u7684\u6700\u4e45\uff0c\u6700\u540e\u8fd8\u5047\u4e86\u3002\r\n\r\n\u5b9e\u9645\u4e0a\u8981\u7406\u6e05\u601d\u8def\uff0c\u5c3d\u91cf\u8ba9\u65b0\u52a0\u7684\u6570**\u5f71\u54cd\u6700\u5c0f**\u7684\u65b9\u5411\u8ba8\u8bba\u3002\r\n\r\n\u8bbe\u65b0\u7684\u6570\u662f $x$\u3002\u5982\u679c\u65b0\u7684\u6570\u5835\u4f4f\u4e86\u4e00\u4e2a\u6808\u9876\u90a3\u4e48\u6765\u4e00\u4e2a\u8fd9\u79cd\u6808\u9876\u5c31 GG \u4e86\u3002\u5835\u4f4f\u4e86\u7a7a\u6808\u90a3\u4e48\u6765\u4e00\u4e2a\u6808\u5e95\u7684\u5c31 GG \u4e86\u3002\r\n\r\n\u89c2\u5bdf\u5230**\u5835\u4f4f\u7a7a\u6808\u7684\u5f71\u54cd\u66f4\u5927**\uff0c\u4e8e\u662f\u8003\u8651\u4e0b\u4e00\u4e2a\u51fa\u73b0\u7684 $x$ \u548c\u4e0b\u4e00\u4e2a\u51fa\u73b0\u7684\u67d0\u4e2a\u6808\u5e95\uff0c\u5982\u679c\u4e0b\u4e00\u4e2a\u51fa\u73b0\u7684\u662f $x$ \u90a3\u4e48\u53ef\u4ee5\u653e\u7a7a\u6808\u91cc\uff0c\u6ca1\u5f71\u54cd\u5230\u6808\u5e95\u3002\r\n\r\n\u5982\u679c\u67d0\u4e2a\u6808\u5e95\u5148\u51fa\u73b0\uff0c\u8bbe\u8fd9\u4e2a\u6808\u5e95\u4e3a $u$\uff0c\u6808\u9876\u4e3a $v$\u3002\u8003\u8651\u5230\u4e0b\u4e00\u4e2a $u$ \u51fa\u73b0\u65f6 $v$ \u51fa\u73b0\u7684\u6b21\u6570\uff1a\r\n\r\n\u5982\u679c $v$ \u51fa\u73b0\u4e86\u5076\u6570\u6b21\uff0c\u628a $x$ \u4e22\u5728\u6808\u9876\uff0c\u540e\u9762\u6765\u7684 $v$ \u90fd\u4e22\u5728\u7a7a\u6808\u91cc\uff0c\u6700\u540e\u7a7a\u6808\u4f1a\u7a7a\u51fa\u6765\u3002\r\n\r\n\u5982\u679c $v$ \u51fa\u73b0\u4e86\u5947\u6570\u6b21\uff0c\u628a $x$ \u4e22\u5728\u7a7a\u6808\uff0c\u540e\u9762\u6765\u7684 $v$ \u4e22\u5728\u6808\u9876\uff0c\u8fd9\u6837\u6808\u5e95\u6765\u7684\u65f6\u5019 $v$ \u5df2\u7ecf\u88ab\u5947\u6570\u4e2a $v$ \u5e72\u6389\u4e86\uff0c\u53ef\u4ee5\u76f4\u63a5\u4e22\u8fdb\u6808\u91cc\u9762\u3002\r\n\r\n\u6a21\u62df\u4e0a\u8ff0\u8fc7\u7a0b\u5373\u53ef\uff0c\u53ef\u4ee5\u505a\u5230 $O(n+m)$\u3002",
        "postTime": 1669724267,
        "uid": 151935,
        "name": "Rainbow_qwq",
        "ccfLevel": 0,
        "title": "\u95f2\u8bdd T2"
    },
    {
        "content": "# \u3010\u9898\u89e3\u3011P8866 [NOIP2022] \u55b5\u4e86\u4e2a\u55b5\n\n[\u535a\u5ba2\u56ed\u98df\u7528\u6548\u679c\u66f4\u4f73](https://www.cnblogs.com/xrkforces/p/luogu-P8866.html)\n\n## \u9898\u76ee\u94fe\u63a5\n\n[P8866 [NOIP2022] \u55b5\u4e86\u4e2a\u55b5](https://www.luogu.com.cn/problem/P8866)\n\n## \u9898\u610f\u6982\u8ff0\n\n\u6709\u4e00\u4e2a\u724c\u5806\u548c $n$ \u4e2a\u53ef\u4ee5\u4ece\u6808\u5e95\u5220\u9664\u5143\u7d20\u7684\u6808\uff0c\u4efb\u52a1\u662f\u8981\u901a\u8fc7\u89c4\u5219\u5c06\u6240\u6709\u7684\u5361\u724c\u6d88\u53bb\u3002\n\n\u5f00\u59cb\u65f6\u724c\u5806\u4e2d\u6709 $m$ \u5f20\u5361\u724c\uff0c\u4ece\u4e0a\u5230\u4e0b\u7684\u56fe\u6848\u5206\u522b\u662f $a_1, a_2,\\dots, a_m$\u3002\u6240\u6709\u7684\u5361\u724c\u4e00\u5171\u6709 $k$ \u79cd\u56fe\u6848\uff0c\u4ece $1$ \u5230 $k$ \u7f16\u53f7\u3002\u724c\u5806\u4e2d\u6bcf\u4e00\u79cd\u56fe\u6848\u7684\u5361\u724c\u90fd\u6709\u5076\u6570\u5f20\u3002\u5f00\u59cb\u65f6\u6240\u6709\u7684\u6808\u90fd\u662f\u7a7a\u7684\u3002\u8fd9\u4e2a\u6e38\u620f\u6709\u4e24\u79cd\u64cd\u4f5c\uff1a\n\n- \u9009\u62e9\u4e00\u4e2a\u6808\uff0c\u5c06\u724c\u5806\u9876\u4e0a\u7684\u5361\u724c\u653e\u5165\u6808\u7684\u9876\u90e8\u3002\u5982\u679c\u8fd9\u4e48\u64cd\u4f5c\u540e\uff0c\u8fd9\u4e2a\u6808\u6700\u4e0a\u65b9\u7684\u4e24\u5f20\u724c\u6709\u76f8\u540c\u7684\u56fe\u6848\uff0c\u5219\u4f1a\u81ea\u52a8\u5c06\u8fd9\u4e24\u5f20\u724c\u6d88\u53bb\u3002\n- \u9009\u62e9\u4e24\u4e2a\u4e0d\u540c\u7684\u6808\uff0c\u5982\u679c\u8fd9\u4e24\u4e2a\u6808\u6808**\u5e95**\u7684\u5361\u724c\u6709\u76f8\u540c\u7684\u56fe\u6848\uff0c\u5219\u53ef\u4ee5\u5c06\u8fd9\u4e24\u5f20\u724c\u6d88\u53bb\uff0c\u539f\u6765\u5728\u6808\u5e95\u4e0a\u65b9\u7684\u5361\u724c\u4f1a\u6210\u4e3a\u65b0\u7684\u6808\u5e95\u3002\u5982\u679c\u4e0d\u540c\uff0c\u5219\u4ec0\u4e48\u4e5f\u4e0d\u4f1a\u505a\u3002\n\n\u8981\u6c42\u6784\u9020\u4e00\u4e2a\u64cd\u4f5c\u5e8f\u5217\uff0c\u6ee1\u8db3\u8fdb\u884c\u8fd9\u4e9b\u64cd\u4f5c\u4e4b\u540e\u53ef\u4ee5\u4f7f\u5f97\u64cd\u4f5c\u7684\u724c\u5806\u548c\u6bcf\u4e2a\u6808\u5747\u4e3a\u7a7a\u3002\n\n## \u6570\u636e\u8303\u56f4\n\n\u8bbe $S$ \u4e3a\u6240\u6709 $T$ \u7ec4\u6570\u636e\u4e2d $m$ \u7684\u603b\u548c\u3002\n\n\u5bf9\u4e8e\u6240\u6709\u6570\u636e\uff0c\u4fdd\u8bc1 $S \\leq 2 \\times 10^6$\uff0c$1 \\leq n \\leq 300$\uff0c$1 \\leq a_i \\leq k$\u3002\n\n|   \u6d4b\u8bd5\u70b9    |  $T=$  |    $n$     |  $k=$  | $m \\leq$ |\n| :---------: | :----: | :--------: | :----: | :------: |\n|  $1\\sim 3$  | $1001$ | $\\leq 300$ | $2n-2$ |  \u65e0\u9650\u5236  |\n|  $4\\sim 6$  | $1002$ |    $=2$    | $2n-1$ |  \u65e0\u9650\u5236  |\n| $7\\sim 10$  |  $3$   |    $=3$    | $2n-1$ |   $14$   |\n| $11\\sim 14$ | $1004$ |    $=3$    | $2n-1$ |  \u65e0\u9650\u5236  |\n| $15\\sim 20$ | $1005$ | $\\leq 300$ | $2n-1$ |  \u65e0\u9650\u5236  |\n\n## \u601d\u8def\u5206\u6790\n\n\u6ce8\uff1a\u4e3a\u4e86\u65b9\u4fbf\u8d77\u89c1\uff0c\u6211\u4eec\u5c06\u9898\u76ee\u4e2d\u7684**\u5361\u724c**\u79f0\u4e4b\u4e3a**\u5143\u7d20**\u3002\n\n\u9996\u5148\u770b\u5230\u8fd9\u4e2a\u9898\u76ee\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u53d1\u73b0\u4e00\u4e9b\u57fa\u672c\u7684\u7ed3\u8bba\uff1a\n\n\u6211\u4eec\u6700\u7ec8\u4e00\u5b9a\u8fdb\u884c\u4e86 $m$ \u6b21\u7b2c\u4e00\u79cd\u64cd\u4f5c\uff0c\u548c\u81f3\u591a $\\frac{m}{2}$ \u6b21\u7b2c\u4e8c\u79cd\u64cd\u4f5c\uff0c\u90a3\u4e48\u64cd\u4f5c\u6b21\u6570 $op$ \u4e00\u5b9a\u6ee1\u8db3 $m \\le op \\le  \\frac{3}{2}m$\uff0c\u6240\u4ee5\u9898\u76ee\u4e2d\u5173\u4e8e $op$ \u7684\u9650\u5236\u662f\u6ca1\u7528\u7684\u3002 \n\n\u89c2\u5bdf\u6570\u636e\u8303\u56f4\u5c31\u6bd4\u8f83\u5bb9\u6613\u80fd\u8054\u60f3\u5230 NOIP2018 \u7684\u65c5\u884c\uff0c\u8bf4\u660e\u89e3\u6cd5\u4e00\u5b9a\u4e0e $k$ \u5f3a\u76f8\u5173\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5148\u4ece $k$ \u7684\u90e8\u5206\u5206\u5165\u624b\u3002\n\n### $k=2n-2$\n\n\u89c2\u5bdf $k$ \u548c $n$ \u7684\u5173\u7cfb\uff0c\u53d1\u73b0 $k=2(n-1)$\uff0c\u5373 $k$ \u662f $n-1$ \u7684\u4e8c\u500d\uff0c\u90a3\u4e48\u5f53\u6211\u4eec\u628a\u6bcf\u4e24\u79cd\u5143\u7d20\u653e\u5230\u4e00\u4e2a\u5806\u91cc\uff0c\u6070\u597d\u6700\u540e\u4f1a\u5269\u4e0b\u4e00\u4e2a\u7a7a\u6808\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u8003\u8651\u76f4\u63a5\u94a6\u5b9a\u5c06 $2i$ \u548c $2i-1$ \u4e24\u79cd\u5143\u7d20\u653e\u5728\u7b2c $i$ \u4e2a\u6808\u4e2d\uff0c\u7136\u540e\u5c06\u7a7a\u7684\u6808 $n$ \u4f5c\u4e3a\u8f85\u52a9\u6808\u3002\n\n\u90a3\u4e48\u7531\u4e8e\u4e00\u4e2a\u6808\u4e2d\u53ea\u4f1a\u653e\u4e24\u79cd\u5361\u724c\uff0c\u6240\u4ee5\u4efb\u610f\u65f6\u523b\uff0c\u4e00\u4e2a\u6808\u4e2d\u7684\u5143\u7d20**\u6700\u591a**\u4e3a $2$ \u4e2a\uff1a\u5f53\u6808\u4e2d\u5143\u7d20\u6570\u91cf\u4e3a $2$ \u65f6\u518d\u52a0\u8fdb\u6765\u4e00\u4e2a\u5143\u7d20\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5143\u7d20\u4e00\u5b9a\u4e0e\u6808\u9876/\u6808\u5e95\u76f8\u540c\uff0c\u4e00\u5b9a\u53ef\u4ee5\u76f8\u6d88\u4f7f\u5f97\u5143\u7d20\u4e2a\u6570 $\\le 2$\u3002\n\n\u90a3\u4e48\u53ef\u4ee5\u6709\u4ee5\u4e0b\u89e3\u6cd5\uff1a\n\n\u5047\u8bbe\u5f53\u524d\u6211\u4eec\u8981\u5c06 $x$ \u653e\u5165\u6808\u4e2d\u8fdb\u884c\u64cd\u4f5c\uff0c\u8003\u8651 $x$ \u653e\u5165\u6808 $s$ \u7684\u64cd\u4f5c\uff1a\n\n- \u82e5 $s$ \u4e3a\u7a7a\uff0c\u76f4\u63a5\u5165\u6808\uff1b\n- \u82e5 $s$ \u6709\u4e00\u4e2a\u5143\u7d20\uff1a\n\t- \u8be5\u5143\u7d20\u548c $x$ \u76f8\u540c\uff0c\u90a3\u4e48\u76f4\u63a5\u8fdb\u884c\u7b2c\u4e00\u79cd\u64cd\u4f5c\uff1a\u5c06 $x$ \u5165\u6808\u5e76\u5c06\u4e24\u4e2a $x$ \u76f8\u6d88\uff1b\n\t- \u8be5\u5143\u7d20\u548c $x$ \u4e0d\u540c\uff0c\u90a3\u4e48\u4e5f\u76f4\u63a5\u8fdb\u884c\u7b2c\u4e00\u79cd\u64cd\u4f5c\uff1a\u5c06 $x$ \u5165\u6808\u3002\n- \u82e5 $s$ \u6709\u4e24\u4e2a\u5143\u7d20\uff1a\n\t- \u6808\u9876\u4e0e $x$ \u76f8\u540c\uff0c\u90a3\u4e48\u76f4\u63a5\u8fdb\u884c\u7b2c\u4e00\u79cd\u64cd\u4f5c\uff1a\u5c06 $x$ \u5165\u6808\u5e76\u5c06\u4e24\u4e2a $x$ \u76f8\u6d88\uff1b\n\t- \u6808\u5e95\u548c $x$ \u76f8\u540c\uff0c\u90a3\u4e48\u76f4\u63a5\u8fdb\u884c\u7b2c\u4e8c\u79cd\u64cd\u4f5c\uff1a\u5c06 $x$ \u52a0\u5165\u8f85\u52a9\u6808\u5e76\u5c06\u4e24\u4e2a $x$ \u76f8\u6d88\u3002\n\n\u90a3\u4e48\u9996\u5148\u663e\u7136\u6700\u540e\u65e0\u8bba\u5982\u4f55\u8f85\u52a9\u6808\u4e00\u5b9a\u4e3a\u7a7a\uff1a\u56e0\u4e3a\u4e09\u7c7b\u4e94\u79cd\u60c5\u51b5\u4e0b\u53ea\u6709\u6700\u540e\u4e00\u79cd\u60c5\u51b5\u4f1a\u7528\u5230\u8f85\u52a9\u6808\u4e14\u6bcf\u6b21\u64cd\u4f5c\u90fd\u80fd\u8bb2\u8f85\u52a9\u6808\u6e05\u7a7a\u3002\n\n\u4e14\u7531\u4e8e\u6bcf\u4e2a\u5143\u7d20\u51fa\u73b0\u6b21\u6570\u4e3a\u5076\u6570\u6b21\uff0c\u6700\u540e\u4e00\u6b21 $x$ \u5165\u6808\u4e5f\u4e00\u5b9a\u80fd\u5c06\u5176\u5b83\u6808\u6e05\u7a7a\uff0c\u6240\u4ee5\u8fd9\u6837\u505a\u4e00\u5b9a\u53ef\u4ee5\u6709\u89e3\u3002\n\n\u8fd9\u90e8\u5206\u5206\u7ed9\u4e86 15pts\uff0c\u867d\u7136\u76f8\u5bf9\u4e8e\u6b63\u89e3\u8fd8\u5dee\u522b\u5f88\u5927\uff0c\u4f46\u5df2\u7ecf\u7ed9\u4e86\u6211\u4eec\u5f88\u5927\u7684\u542f\u53d1\u6765\u601d\u8003\u6b63\u89e3\u3002\n\n### $k=2n-1$\n\n\u7531\u4e8e $2n-1$ \u53ea\u6bd4 $2n-2$ \u591a\u4e86\u4e00\u4e2a\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\uff1a\u524d $2n-2$ \u79cd\u5143\u7d20\u8fd8\u6309\u7167\u4e0a\u8ff0\u529e\u6cd5\u5904\u7406\uff0c\u53ea\u9700\u8981\u8003\u8651 $x=2n-1$ \u5e94\u8be5\u5982\u4f55\u5904\u7406\u3002\n\n\u4f46\u5982\u679c\u76f4\u63a5\u6cbf\u7528\u4e0a\u8ff0 $k=2n-2$ \u7684\u89e3\u6cd5\u5c06\u4f1a\u975e\u5e38\u590d\u6742\uff0c\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u4e4b\u540e\u518d\u8bf4\u3002\n\n\u8003\u8651\u53e6\u4e00\u79cd\u4f7f\u7528\u4e0a\u8ff0\u89e3\u6cd5\u7684\u7b56\u7565\u4f46\u629b\u5f00 $2i,2i-1$ \u548c\u6808 $i$ \u7ed1\u5b9a\u5173\u7cfb\u7684\u4e00\u79cd\u505a\u6cd5\uff1a\n\n\u6211\u4eec\u540c\u6837\u5728**\u521d\u59cb\u65f6**\u5c06\u524d $n-1$ \u4e2a\u6808\u5f53\u505a\u666e\u901a\u6808\uff0c\u7b2c $n$ \u4e2a\u6808\u5f53\u505a\u8f85\u52a9\u6808\u3002\n\n\u5047\u8bbe\u5f53\u524d\u6211\u4eec\u8981\u5c06 $x$ \u653e\u5165\u6808\u4e2d\u8fdb\u884c\u64cd\u4f5c\uff0c\u8003\u8651 $x$ \u653e\u5165\u6808\u4e2d\u7684\u64cd\u4f5c\uff1a\n\n- \u5f53 $x$ \u5728\u4e4b\u524d\u7684\u6808\u4e2d**\u5df2\u7ecf\u51fa\u73b0\u8fc7**\uff0c\u5047\u8bbe $x$ \u4e4b\u524d\u51fa\u73b0\u5728\u6808 $s$ \u4e2d\u3002\u5219\u6211\u4eec\u53ef\u4ee5\u6309\u7167 $k=2n-2$ \u7684\u7b56\u7565\u5c06 $x$ \u4e0e\u6808 $s$ \u4e2d\u7684\u53e6\u5916\u4e00\u4e2a $x$ \u8fdb\u884c\u7b80\u5355\u76f8\u6d88\uff0c\u5177\u4f53\u800c\u8a00\uff1a\n\t- \u5f53 $x$ \u662f $s$ \u7684\u6808\u9876\u65f6\uff0c\u6267\u884c\u7b2c\u4e00\u79cd\u64cd\u4f5c\uff1b\n\t- \u5f53 $x$ \u662f $s$ \u7684\u6808\u5e95\u65f6\uff0c\u6267\u884c\u7b2c\u4e8c\u79cd\u64cd\u4f5c\u3002\n\n- \u5f53 $x$ \u5728\u4e4b\u524d\u7684\u6808\u4e2d**\u4ece\u672a\u51fa\u73b0\u8fc7**\uff0c\u5219\u5c06 $x$ \u52a0\u5165\u5230\u4e00\u4e2a\u65b0\u7684**\u6ca1\u6ee1\u4e24\u4e2a\u5143\u7d20**\u7684\u6808\u4e2d\u3002\u82e5\u9664\u4e86\u8f85\u52a9\u6808\u4e4b\u5916\u7684\u5176\u5b83\u6808\u5df2\u6ee1\uff0c\u90a3\u4e48\u53d1\u73b0\u6b64\u65f6\u5df2\u7ecf\u4e0d\u80fd\u7528 $k=2n-2$ \u8fdb\u884c\u64cd\u4f5c\u4e86\uff0c\u6211\u4eec\u8003\u8651\u8fdb\u884c\u7279\u6b8a\u64cd\u4f5c\u3002\n\n\u53d1\u73b0\u6b64\u65f6\u6211\u4eec\u5df2\u7ecf\u57fa\u672c\u89e3\u51b3\u4e86\u95ee\u9898\uff0c\u53ea\u6709\u6700\u540e\u4e00\u79cd\u60c5\u51b5\u5f53\u3010\u6240\u6709\u666e\u901a\u6808\u5df2\u6ee1\u3011\u65f6\u7684\u7279\u6b8a\u64cd\u4f5c\u8fd8\u4e0d\u77e5\u9053\u5e94\u8be5\u600e\u4e48\u529e\u3002\n\n\u90a3\u4e48\u6211\u4eec\u63a5\u4e0b\u6765\u90fd\u6765\u8bf4\u660e\u5982\u4f55\u8fdb\u884c\u7279\u6b8a\u64cd\u4f5c\u3002\n\n\u5f53\u6240\u6709\u666e\u901a\u6808\u5df2\u6ee1\u65f6\uff0c\u6b64\u65f6\u5c40\u9762\u4e0a\u4e00\u5b9a\u662f\u524d $n-1$ \u4e2a\u6808\u88ab\u5143\u7d20\u6446\u6ee1\uff0c\u4e14\u4e0b\u4e00\u4e2a\u5165\u6808\u5e8f\u5217\u4e2d\u7684\u5143\u7d20 $P$ \u4ece\u672a\u5728\u4e4b\u524d\u7684\u6808\u4e2d\u51fa\u73b0\u8fc7\u3002\n\n\u8d2a\u5fc3\u7684\u8003\u8651\u662f\u76f4\u63a5\u5c06 $P$ \u653e\u5165\u8f85\u52a9\u6808\u4e2d\uff0c\u4f46\u5047\u5982 $P$ \u540e\u9762\u8ddf\u4e86\u4e00\u4e2a\u662f\u524d\u9762\u6808\u4e2d\u6808\u5e95\u7684\u5143\u7d20\uff0c\u90a3\u4e48\u672c\u6765\u76f4\u63a5\u5c06\u8be5\u5143\u7d20\u653e\u5165\u8f85\u52a9\u6808\u6808\u5e95\u5c31\u53ef\u4ee5\u4e0e\u524d\u9762\u7684\u6808\u4e2d\u5143\u7d20\u8fdb\u884c\u64cd\u4f5c 2 \u76f8\u6d88\u3002\u4f46\u8981\u662f\u5c06 $P$ \u653e\u5165\u8f85\u52a9\u6808\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5143\u7d20\u5c31\u5f88\u96be\u518d\u62b5\u6d88\uff0c\u4e0d\u80fd\u6700\u4f18\u3002\n\n\u7531\u6b64\u53ef\u4ee5\u53d1\u73b0\u6211\u4eec\u7684\u9009\u6808\u7b56\u7565\u5b9e\u9645\u4e0a\u4e0e $P$ \u540e\u9762\u7684\u4e00\u4e32\u6570\u6709\u5173\u3002\u90a3\u4e48\u6211\u4eec\u8003\u8651\u79bb\u7ebf\uff1a\u5373\u5206\u522b\u8003\u8651 $P$ \u540e\u9762\u90fd\u6709\u54ea\u4e9b\u6570\uff0c\u7136\u540e\u518d\u8fdb\u884c\u9009\u6808\u3002\n\n- \u5bf9\u4e8e $P$ \u540e\u9762\u5728**\u6808\u9876**\u7684\u5143\u7d20\uff1a\u8fd9\u4e9b\u6808\u9876\u7684\u6570\u90fd\u5f88\u597d\u89e3\u51b3\uff0c\u6211\u4eec\u76f4\u63a5\u5c06\u4ed6\u4eec\u653e\u5165\u539f\u6765\u7684\u6808\u4e2d\u7b80\u5355\u76f8\u6d88\u5373\u53ef\u3002\n- \u5bf9\u4e8e $P$ \u540e\u9762\u672c\u6765\u5c31\u662f $P$ \u7684\u5143\u7d20\uff1a\u663e\u7136\u53ef\u4ee5\u5c06\u4e24\u4e2a $P$ \u653e\u5728\u8f85\u52a9\u6808\u7136\u540e\u76f4\u63a5\u76f8\u6d88\uff0c\u8fd9\u65f6\u5019\u8f85\u52a9\u6808\u8fd8\u662f\u7a7a\u7684\uff1b\n- \u5bf9\u4e8e $P$ \u540e\u9762\u5728**\u6808\u5e95**\u7684\u5143\u7d20\uff1a\u6309\u7406\u6765\u8bb2\uff0c\u6211\u4eec\u5e94\u8be5\u5c06\u5b83\u653e\u5728\u8f85\u52a9\u6808\u4e2d\uff0c\u7136\u540e\u4e0e\u53e6\u5916\u4e00\u4e2a\u6808\u5e95\u5143\u7d20\u76f8\u6d88\uff1b\u90a3\u4e48\u8fd9\u65f6\u5019\u64cd\u4f5c\u5b8c\u8f85\u52a9\u6808\u8fd8\u662f\u7a7a\u7684\n\n\u6211\u4eec\u53d1\u73b0\u5f53 $P$ \u7684\u540e\u9762\u51fa\u73b0 $P$ \u6216\u8005\u5728**\u6808\u5e95**\u7684\u5143\u7d20\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u4ed6\u4eec\u5165\u6808\u4e4b\u540e\u76f4\u63a5\u7ed3\u675f\u7279\u6b8a\u5904\u7406\uff0c\u56e0\u4e3a\u65e0\u8bba\u5982\u4f55\u5c06\u5b83\u4eec\u5165\u6808\u4e4b\u540e\u90fd\u4e00\u5b9a\u4f1a\u51fa\u73b0\u81f3\u5c11\u4e00\u4e2a\u7a7a\u6808\uff0c\u8fd9\u4e2a\u7a7a\u6808\u5c31\u53d8\u6210\u4e86\u8f85\u52a9\u6808\uff0c\u56de\u5230\u4e86\u6b63\u5e38\u76f8\u6d88\u7684\u5c40\u9762\u3002\u800c\u5f53 $P$ \u540e\u9762\u5728\u6808\u9876\u7684\u5143\u7d20\u5165\u6808\u4e4b\u540e\u4e0d\u4e00\u5b9a\u4f1a\u4f7f\u5f97\u4e00\u5b9a\u5b58\u5728\u7a7a\u6808\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd\u56de\u5230\u6b63\u5e38\u76f8\u6d88\u7684\u5c40\u9762\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5206\u7c7b\u8ba8\u8bba\u8003\u8651\u5165\u6808\u5e8f\u5217\u4e2d $P$ \u540e\u9762\u7b2c\u4e00\u4e2a**\u4e0d\u5728\u6808\u9876**\u7684\u5143\u7d20\u662f\u4ec0\u4e48\uff1a\n\n- \u5f53 $P$ \u540e\u9762\u7b2c\u4e00\u4e2a\u4e0d\u5728\u6808\u9876\u7684\u5143\u7d20\u662f $P$ \u65f6\uff0c\u90a3\u4e48\u6b64\u65f6\u7684\u5165\u6808\u5e8f\u5217\u4e00\u5b9a\u662f $(P,\\cdots,P)$\uff0c\u7701\u7565\u53f7\u8868\u793a\u4e86\u4e00\u6bb5\u5728\u6808\u9876\u7684\u5143\u7d20\uff0c\u90a3\u4e48\u6211\u4eec\u5c06 $P$ \u653e\u5165\u8f85\u52a9\u6808\u4e2d\uff0c\u5bf9\u4e8e\u7701\u7565\u53f7\u4e2d\u7684\u5143\u7d20\u53ef\u4ee5\u76f4\u63a5\u5728\u6808\u9876\u81ea\u7531\u76f8\u6d88\uff0c\u518d\u5c06\u7b2c\u4e8c\u4e2a $P$ \u52a0\u5165\u5230\u8f85\u52a9\u6808\u4e2d\uff0c\u4f7f\u5f97\u8f85\u52a9\u6808\u53d8\u7a7a\u4e14\u8f85\u52a9\u6808\u4f4d\u7f6e\u4e0d\u53d8\uff1b\n\n- \u5f53 $P$ \u540e\u9762\u7b2c\u4e00\u4e2a\u4e0d\u5728\u6808\u9876\u7684\u5143\u7d20\u5728\u6808\u5e95\u65f6\uff0c\u5047\u8bbe\u8fd9\u4e2a\u5143\u7d20\u4e3a $X$\uff0c$X$ \u539f\u6765\u5728\u6808 $s$ \u7684\u6808\u5e95\u3002\u90a3\u4e48\u6b64\u65f6\u7684\u5165\u6808\u5e8f\u5217\u4e00\u5b9a\u662f $(P,\\cdots,X)$\uff0c\n\n\t\u6211\u4eec\u5f53\u7136\u4f1a\u5c3d\u91cf\u8ba9 $X$ \u76f8\u62b5\u6d88\uff0c\u90a3\u4e48\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\n\n\t- \u4f7f\u7528\u64cd\u4f5c 1 \u5c06\u5165\u6808\u5e8f\u5217\u4e2d\u7684 $X$ \u653e\u5165 $s$ \u4e2d\uff0c\u6b64\u65f6\u4e00\u5b9a\u6ee1\u8db3 $s$ \u53ea\u6709\u4e00\u4e2a\u5143\u7d20 $X$\uff0c\u90a3\u4e48\u5c31\u8981\u628a $s$ \u7684\u6808\u9876\u5143\u7d20\u5168\u90e8\u6d88\u6389\uff0c\u6211\u4eec\u8bbe $s$ \u7684\u6808\u9876\u5143\u7d20\u4e3a $Y$\uff0c\u90a3\u4e48\u8bf4\u660e $(P,\\cdots,X)$ \u7684\u7701\u7565\u53f7\u4e2d $Y$ \u7684\u4e2a\u6570\u4e00\u5b9a\u662f\u5947\u6570\u4e2a\uff0c\u56e0\u4e3a\u8fd9\u6837\u5b83\u4eec\u624d\u80fd\u4e0e\u6808\u4e2d\u7684\u4e00\u4e2a $Y$ \u5171\u540c\u5168\u90e8\u6d88\u6389\u3002\u5373\uff1a\u5f53 $(P,\\cdots,X)$ \u7684\u7701\u7565\u53f7\u4e2d $Y$ \u4e3a\u5947\u6570\u65f6\uff0c\u5219\u5c06 $P$ \u653e\u5165\u8f85\u52a9\u6808\u4e2d\uff0c\u518d\u5c06\u7701\u7565\u53f7\u4e2d\u7684\u5143\u7d20\u81ea\u7531\u76f8\u6d88\uff0c\u7136\u540e\u5c06 $X$ \u5165\u6808 $s$\uff0c\u4e0e\u6808\u4e2d $s$ \u76f8\u6d88\u3002\u6b64\u65f6 $s$ \u4e3a\u7a7a\uff0c\u53d8\u6210\u65b0\u7684\u8f85\u52a9\u6808\uff1b\n\t- \u540c\u7406\u5f53\u7701\u7565\u53f7\u4e2d $Y$ \u7684\u4e2a\u6570\u4e3a\u5076\u6570\u4e2a\u65f6\uff0c\u53ea\u80fd\u8ba9\u4e24\u4e2a $X$ \u901a\u8fc7\u64cd\u4f5c 2 \u6808\u5e95\u76f8\u6d88\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u80fd\u5148\u5c06 $P$ \u653e\u5165 $s$ \u4e2d\uff0c\u7136\u540e\u518d\u5c06\u5176\u5b83\u975e $Y$ \u7684\u6808\u9876\u5143\u7d20\u81ea\u7531\u76f8\u6d88\uff0c\u5076\u6570\u4e2a $Y$ \u653e\u5728\u8f85\u52a9\u6808\u4e2d\u76f8\u6d88\uff0c\u6700\u540e\u518d\u5c06 $X$ \u653e\u5165\u8f85\u52a9\u6808\u8fdb\u884c\u64cd\u4f5c 2 \u4e0e\u6808\u5e95\u7684 $X$ \u76f8\u6d88\u3002\u6b64\u65f6\u8f85\u52a9\u6808\u4e3a\u7a7a\u4e14\u8f85\u52a9\u6808\u4f4d\u7f6e\u4e0d\u53d8\u3002\n\n- \u5f53 $P$ \u540e\u9762\u5168\u90e8\u8ddf\u7684\u90fd\u662f\u5728\u6808\u9876\u7684\u5143\u7d20\u65f6\uff0c\u76f4\u63a5\u4e00\u76f4\u76f8\u6d88\u5230\u5165\u6808\u5e8f\u5217\u4e3a\u7a7a\u5373\u53ef\u3002\n\n\u7ecf\u8fc7\u4e0a\u8ff0\u64cd\u4f5c\u540e\uff0c\u5c40\u9762\u603b\u4fdd\u6301\uff1a\n\n- \u5b58\u5728\u4e00\u4e2a\u7a7a\u6808\uff0c\u5c31\u662f\u8f85\u52a9\u6808\u3002\n- \u6240\u6709\u5143\u7d20\u5728\u6808\u4e2d\u6700\u591a\u51fa\u73b0\u4e00\u6b21\uff1b\n- \u6bcf\u4e2a\u6808\u6700\u591a\u53ea\u6709\u4e24\u4e2a\u5143\u7d20\u3002\n\n\u7531\u4e8e\u6bcf\u79cd\u5143\u7d20\u6570\u91cf\u5747\u4e3a\u5076\u6570\uff0c\u76f8\u6d88\u6c38\u8fdc\u662f\u540c\u79cd\u5143\u7d20\u4e24\u4e24\u76f8\u6d88\uff0c\u6240\u4ee5\u5230\u6700\u540e\uff0c\u67d0\u79cd\u6570\u51fa\u73b0\u5947\u6570\u6b21\u662f\u4e0d\u53ef\u80fd\u7684\u3002\u53c8\u7531\u4e8e\u6bcf\u79cd\u5143\u7d20\u5728\u6808\u4e2d\u6700\u591a\u53ea\u51fa\u73b0\u4e00\u6b21\u3002\u7efc\u5408\u6765\u770b\uff0c\u6bcf\u79cd\u5143\u7d20\u5230\u6700\u540e\u53ea\u80fd\u51fa\u73b0\u96f6\u6b21\uff0c\u4e5f\u5c31\u662f\u5fc5\u5b9a\u4e0d\u4f1a\u51fa\u73b0\u3002\n\n## \u5b9e\u73b0\u7ec6\u8282\n\n\u4e4b\u6240\u4ee5\u5728\u8fd9\u4e2a\u9898\u9898\u89e3\u4e2d\u7a81\u7136\u52a0\u4e00\u4e2a\u6211\u4e4b\u524d\u5199\u9898\u89e3\u4ece\u6765\u6ca1\u6709\u8fc7\u7684\u3010\u5b9e\u73b0\u7ec6\u8282\u3011\u7684\u73af\u8282\uff0c\u662f\u56e0\u4e3a\u8fd9\u4e2a\u9898\u4ee3\u7801\u786e\u5b9e\u96be\u5199\u4e5f\u6bd4\u8f83\u5de7\u5999\uff0c\u6240\u4ee5\u4e13\u95e8\u5728\u8fd9\u91cc\u8bf4\u4e00\u4e0b\u3002\n\n1. \u5982\u4f55\u5b9e\u73b0\u666e\u901a\u5c40\u9762\u65f6\uff0c\u5bf9\u4e8e $x$ \u7684\u5165\u6808\u548c\u7b80\u5355\u76f8\u6d88\u7684\u8fc7\u7a0b\uff1f\n\n\t\u5b9e\u9645\u4e0a\u53ea\u8981\u7ef4\u62a4\u4e00\u4e2a\u961f\u5217 $stk$ \u5b58\u50a8\u6808\u7684\u7f16\u53f7\uff0c\u6ee1\u8db3\uff1a\n\n\t- \u5982\u679c\u4e00\u4e2a\u6808\u4e2d\u5df2\u7ecf\u5b58\u6ee1\u4e24\u4e2a\u5143\u7d20\uff0c\u90a3\u4e48\u5f53\u524d\u6808\u4e0d\u5728\u961f\u5217\u4e2d\uff1b\n\t- \u5982\u679c\u4e00\u4e2a\u6808\u4e2d\u6709\u4e00\u4e2a\u5143\u7d20\uff0c\u90a3\u4e48\u5f53\u524d\u6808\u5728\u961f\u5217\u4e2d\u51fa\u73b0\u4e00\u6b21\uff1b\n\t- \u5982\u679c\u4e00\u4e2a\u6808\u4e2d\u6ca1\u6709\u5143\u7d20\uff0c\u90a3\u4e48\u5f53\u524d\u6808\u5728\u961f\u5217\u4e2d\u51fa\u73b0\u4e24\u6b21\uff1b\n\t- **\u8f85\u52a9\u6808\u7684\u7f16\u53f7\u4e0d\u51fa\u73b0\u5728\u961f\u5217\u4e2d**\u3002\n\n\t\u521d\u59cb\u65f6\uff0c\u6211\u4eec\u5c06 $1$ \u5230 $n-1$ \u7684\u6240\u6709\u5143\u7d20\u5165\u6808\u4e24\u6b21\u3002\n\n\t\u540c\u65f6\uff0c\u5b9a\u4e49\u4e00\u4e2a\u6570\u7ec4 $id_x$ \u8868\u793a $x$ \u51fa\u73b0\u7684\u6808\u7684\u7f16\u53f7\uff0c\u521d\u59cb\u65f6 $id_x=0$\u3002\n\n\t\u6211\u4eec\u7528 `deque` \u6765\u5b58\u50a8\u6bcf\u4e2a\u6808\u7684\u5143\u7d20\u548c\u6808\u5185\u76f8\u5bf9\u4f4d\u7f6e\u3002\u5e76\u7528\u4e00\u4e2a\u53d8\u91cf $spt$ \u8868\u793a\u5f53\u524d\u8f85\u52a9\u6808\u7684\u7f16\u53f7\u3002\n\n\t\u5f53\u4e00\u4e2a\u5143\u7d20 $x$ \u8981\u5165\u6808\u65f6\uff1a\n\n\t- \u5f53 $id_x=0$ \u65f6\uff1a\u76f4\u63a5\u4ece\u961f\u5217\u4e2d\u5f39\u51fa\u4e00\u4e2a\u6808\uff0c\u5e76\u5c06 $x$ \u5165\u6808\u3002\n\t- \u5f53 $id_x\\ne0$ \u65f6\uff1a\n\t\t- \u5f53 $x$ \u5728\u6808\u9876\uff0c\u5373 $dq[id_x].back=x$ \u65f6\uff0c\u5c06 $x$ \u52a0\u5165 $id_x$\uff0c\u5e76\u4e0e\u6808\u9876 $x$ \u8fdb\u884c\u76f8\u6d88\uff1b\n\t\t- \u5f53 $x$ \u5728\u6808\u5e95\uff0c\u5373 $dq[id_x].front=x$ \u65f6\uff0c\u5c06 $x$ \u52a0\u5165 $spt$\uff0c\u5e76\u4e0e\u6808\u5e95 $x$ \u8fdb\u884c\u76f8\u6d88\u3002\n\n\t\u8fd9\u5757\u9700\u8981\u6ce8\u610f\uff0c\u53ca\u65f6\u66f4\u65b0 $id_x$\uff08\u53d8\u4e3a $0$ \u8fd8\u662f\u53d8\u6210\u65b0\u7684\u6570\uff09\uff0c\u53ca\u65f6\u5c06\u6bcf\u4e2a\u6808\u5165\u961f\u51fa\u961f\uff0c\u53ca\u65f6\u66f4\u65b0\u6808\u5185\u5143\u7d20\u3002\n\n\tcode\uff1a\n\n\t```cpp\n\tint solve(int x)\n\t{\n\t\tif(id[x])\n\t\t{\n\t\t\tint ID=id[x];\n\t\t\tif(dq[ID].back()==x)\n\t\t\t{\n\t\t\t\tid[x]=0;\n\t\t\t\tdq[ID].pop_back();\n\t\t\t\tpb(ID);\n\t\t\t\tstk.push(ID);\n\t\t\t}\n\t\t\telse if(dq[ID].front()==x)\n\t\t\t{\n\t\t\t\tid[x]=0;\n\t\t\t\tdq[ID].pop_front();\n\t\t\t\tpb(spt);\n\t\t\t\tdel(ID,spt);\n\t\t\t\tstk.push(ID);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(stk.empty())//\u7279\u6b8a\u5904\u7406\n\t\t\t{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\telse//\u7b80\u5355\u63d2\u5165\n\t\t\t{\n\t\t\t\tint tt=stk.front();\n\t\t\t\tdq[tt].push_back(x);\n\t\t\t\tstk.pop();\n\t\t\t\tid[x]=tt;\n\t\t\t\tpb(tt);\n\t\t\t}\n\t\t}\n\t\treturn 1;\n\t}\n\t```\n\n2. \u7279\u6b8a\u5904\u7406\u4e2d\uff0c\u5982\u4f55\u6c42\u51fa $P$ \u540e\u9762\u7b2c\u4e00\u4e2a\u4e0d\u4e3a\u6808\u9876\u7684\u5143\u7d20\u662f\u8c01\uff1f\n\n\t\u6211\u4eec\u53ef\u4ee5\u4ece $P$ \u5f00\u59cb\u66b4\u529b\u679a\u4e3e\u6bcf\u4e00\u4e2a\u5143\u7d20\uff0c\u5224\u65ad\u5b83\u4eec\u662f\u5426\u4e3a\u6808\u9876\u3002\u76f4\u5230\u5224\u65ad\u5230\u4e00\u4e2a\u5143\u7d20\u662f $P$ \u6216\u8005\u662f\u6808\u5e95\u5373\u53ef\u3002\n\n\t\u7531\u4e8e $P$ \u4e00\u5b9a\u6ca1\u6709\u51fa\u73b0\u5728\u6808\u4e2d\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u5224\u65ad\u5f53\u524d\u5143\u7d20\u662f\u5426\u5728\u6808\u4e2d\u51fa\u73b0\u3002\n\n\tcode\uff1a\n\n\t```cpp\n\tint t=pos;\n\tpos++;\n\twhile(id[a[pos]]&&dq[id[a[pos]]].back()==a[pos])pos++;\n\t```\n\n3. \u7279\u6b8a\u5904\u7406\u4e2d\u6709\u54ea\u4e9b\u9700\u8981\u6ce8\u610f\u7684\u7ec6\u8282\uff1f\n\n\t- \u5bf9\u4e8e $(P,\\cdots,X)$ \u4e2d\uff0c$Y$ \u4e3a\u5076\u6570\u7684\u60c5\u51b5\uff0c\u672a\u6765\u6240\u6709\u4e0d\u4e3a $Y$ \u7684\u6808\u9876\u81ea\u7531\u76f8\u6d88\uff0c\u5bf9\u4e8e $Y$\uff0c\u4e0d\u80fd\u76f4\u63a5\u81ea\u7531\u76f8\u6d88\uff0c\u9700\u8981\u6211\u4eec\u628a\u5b83\u653e\u5230\u8f85\u52a9\u6808\u76f8\u6d88\u3002\n\t- \u5bf9\u4e8e $(P,\\cdots,X)$ \u4e2d\uff0c$Y$ \u4e3a\u5076\u6570\u7684\u60c5\u51b5\uff0c\u8f85\u52a9\u6808\u5373\u5c06\u53d8\u5230 $s$\uff0c\u6240\u4ee5\u8f85\u52a9\u6808\u4e0d\u80fd\u5165\u6808\u3002\u4e5f\u4e0d\u80fd\u76f4\u63a5\u7279\u5224\u5f53\u524d\u6808\u4e3a $s$ \u65f6\uff0c\u76f4\u63a5\u4e0d\u5165\u6808\uff0c\u4f8b\u5982\uff1a\u5f53\u5f53\u524d\u5165\u6808\u5e8f\u5217\u4e3a `3 1 2 1 1 1 ...`\uff0c\u5982\u679c\u76f4\u63a5\u4e0d\u5f39\u5165 $stk$\uff0c\u4f1a\u9020\u6210\u540e\u9762\u7684\u4e00\u4e32 `1 1 1` \u65e0\u6cd5\u6b63\u786e\u5165\u6808\u3002\u4f46\u7531\u4e8e\u6700\u540e\u66b4\u529b\u626b\u961f\u5217\u628a $s$ \u5220\u9664\u590d\u6742\u5ea6\u5b58\u5728\u95ee\u9898\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4e0d\u4f7f\u7528\u7b80\u5355\u76f8\u6d88\u3002\n\n4. \u5982\u4f55\u8bb0\u5f55\u6700\u7ec8\u7b54\u6848\uff1f\n\n\t\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a `vector<pair<int,int>>ans` \u6765\u5b58\u50a8\u7b54\u6848\u5e8f\u5217\uff0c\u5bf9\u4e8e $ans$ \u4e2d\u7684\u5143\u7d20 $val$\uff0c\u82e5 $val.second$ \u4e3a $0$\uff0c\u5219\u662f\u64cd\u4f5c 1\uff0c$val.first$ \u8868\u793a\u64cd\u4f5c 1 \u9009\u62e9\u7684\u6808\uff1b\u53cd\u4e4b\u5219\u662f\u64cd\u4f5c 2\uff0c$val.first$ \u548c $val.second$ \u5206\u522b\u8868\u793a\u64cd\u4f5c 2 \u9009\u62e9\u7684\u4e24\u4e2a\u6808\u3002\u90a3\u4e48\u64cd\u4f5c\u6b21\u6570\u76f4\u63a5\u8f93\u51fa $ans.size()$ \u5373\u53ef\u3002\n\n## \u4ee3\u7801\u5b9e\u73b0\n\n```cpp\n//luoguP8866\n#include<iostream>\n#include<cstdio>\n#include<queue>\n#include<cstring>\n#include<vector>\n#define mk make_pair\n#define pii pair<int,int>\nusing namespace std;\nconst int maxn=305;\nconst int maxm=2e6+10;\nconst int maxk=1005;\nint a[maxm],id[maxk];\nint n,m,k,spt;\n\nqueue<int>stk;\n\ndeque<int>dq[maxn];\n\nvector<pii>ans;\n\ninline int read()\n{\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=x*10+ch-48;ch=getchar();}\n\treturn x*f;\n}\n\nvoid pb(int pos){ans.push_back(mk(pos,0));}\n\nvoid del(int pos1,int pos2){ans.push_back(mk(pos1,pos2));}\n\nvoid clear()\n{\n\twhile(!stk.empty())stk.pop();\n\tfor(int i=1;i<=k;i++)id[i]=0;\n\tans.clear();\n\tspt=n;\n}\n\nint solve(int x)\n{\n\tif(id[x])\n\t{\n\t\tint ID=id[x];\n\t\tif(dq[ID].back()==x)\n\t\t{\n\t\t\tid[x]=0;\n\t\t\tdq[ID].pop_back();\n\t\t\tpb(ID);\n\t\t\tstk.push(ID);\n\t\t}\n\t\telse if(dq[ID].front()==x)\n\t\t{\n\t\t\tid[x]=0;\n\t\t\tdq[ID].pop_front();\n\t\t\tpb(spt);\n\t\t\tdel(ID,spt);\n\t\t\tstk.push(ID);\n\t\t}\n\t}\n\telse\n\t{\n\t\tif(stk.empty())//\u7279\u6b8a\u5904\u7406\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\t\telse//\u7b80\u5355\u63d2\u5165\n\t\t{\n\t\t\tint tt=stk.front();\n\t\t\tdq[tt].push_back(x);\n\t\t\tstk.pop();\n\t\t\tid[x]=tt;\n\t\t\tpb(tt);\n\t\t}\n\t}\n\treturn 1;\n}\n\nint work(int pos)\n{\n\tint t=pos;\n\tpos++;\n\twhile(id[a[pos]]&&dq[id[a[pos]]].back()==a[pos])pos++;\n\tif(a[pos]==a[t])\n\t{\n\t\tpb(spt);\n\t\tfor(int i=t+1;i<pos;i++)solve(a[i]);\n\t\tpb(spt);\n\t\treturn pos;\n\t}\n\tint cnt=0,idx=id[a[pos]];\n\tfor(int i=t;i<pos;i++)if(id[a[i]]==idx)cnt++;\n\tint ID=id[a[pos]];\n\tint y=dq[ID].back();\n\tif(cnt&1)\n\t{\n\t\tpb(spt);\n\t\tdq[spt].push_back(a[t]);\n\t\tfor(int i=t+1;i<pos;i++)\n\t\t{\n\t\t\tif(a[i]==y)pb(ID);\n\t\t\telse solve(a[i]);\n\t\t}\n\t\tpb(ID);\n\t\tdq[ID].clear();\n\t\tid[a[pos]]=id[y]=0;\n\t\tid[a[t]]=spt;\n\t\tstk.push(spt);\n\t\tspt=ID;\n\t}\n\telse\n\t{\n\t\tpb(ID);\n\t\tdq[ID].push_back(a[t]);\n\t\tfor(int i=t+1;i<pos;i++)\n\t\t{\n\t\t\tif(a[i]==y)pb(spt);\n\t\t\telse solve(a[i]);\n\t\t}\n\t\tpb(spt);\n\t\tdel(ID,spt);\n\t\tdq[ID].pop_front();\n\t\tid[a[pos]]=0;\n\t\tid[a[t]]=ID;\n\t}\n\treturn pos;\n}\n\nint main()\n{\n\tint T=read();\n\twhile(T--)\n\t{\n\t\tn=read();m=read();k=read();\n\t\tclear();\n\t\tfor(int i=1;i<=m;i++)a[i]=read();\n\t\tfor(int i=1;i<n;i++){stk.push(i);stk.push(i);}\n\t\tfor(int i=1;i<=m;i++)\n\t\t{\n\t\t\tint x=a[i];\n\t\t\tif(solve(x))continue;\n\t\t\tint tt=work(i);\n\t\t\ti=tt;\n\t\t}\n\t\tcout<<ans.size()<<'\\n';\n\t\tfor(auto val:ans)\n\t\t{\n\t\t\tif(val.second){cout<<\"2 \"<<min(val.first,val.second)<<\" \"<<max(val.first,val.second)<<'\\n';}\n\t\t\telse cout<<\"1 \"<<val.first<<'\\n';\n\t\t}\n\t}\n}\n```\n\n## \u5199\u5728\u540e\u9762\n\n\u6211\u662f\u5f88\u83dc\u7684\uff0c\u9047\u5230\u6784\u9020\u5c31\u6ca1\u62db\u4e86\u3002\u66f4\u4f55\u51b5\u8fd9\u9898\u6bd4\u8f83 adhoc\u3002\n\n\u540e\u6765\u641e\u4e86\u4e00\u5929\u624d\u628a\u8fd9\u9898\u641e\u660e\u767d\uff08\u53ef\u89c1\u6211\u6709\u591a\u83dc\uff09\u3002\u4f46\u7ec8\u7a76\u8fd8\u662f\u5f04\u61c2\u4e86\uff0c\u6240\u4ee5\u5199\u7bc7\u9898\u89e3\u6765\u7eaa\u5ff5\u4e00\u4e0b\uff08\n\n\u7279\u522b\u9e23\u8c22\uff1a@[dbxxx](https://www.luogu.com.cn/user/120868)\n\n\u4e0d\u7ba1\u662f\u4ed6\u7684[\u9898\u89e3](https://www.cnblogs.com/crab-in-the-northeast/p/luogu-p8866.html)\u8fd8\u662f\u672c\u4eba\u90fd\u5bf9\u6211\u63d0\u4f9b\u4e86\u5f88\u5927\u5e2e\u52a9\uff0c\u611f\u8c22\u4ed6\u4e13\u95e8\u62bd\u51fa\u4e00\u5929\u65f6\u95f4\u4ece\u65e9\u5230\u665a\u4e0d\u538c\u5176\u70e6\u7ed9\u6211\u8bb2\u89e3+\u8c03\u4ee3\u7801\u3002",
        "postTime": 1670600741,
        "uid": 341245,
        "name": "xrk2006",
        "ccfLevel": 4,
        "title": "\u3010\u9898\u89e3\u3011P8866 [NOIP2022] \u55b5\u4e86\u4e2a\u55b5\uff08\u6784\u9020\uff0cadhoc\uff09"
    },
    {
        "content": "### \u4ece\u90e8\u5206\u5206 $k=2n-2$ \u5165\u624b\n\n\u8fd9\u4e2a\u6570\u636e\u7279\u5f81\u542f\u793a\u6211\u4eec\u5c06\u6240\u6709\u724c\u5c3d\u91cf\u5f80\u524d $n-1$ \u4e2a\u6808\u653e\uff0c\u7559\u7b2c $n$ \u4e2a\u6808\u4f5c\u4e3a\u7a7a\u6808\u3002\n\n\u6709\u4e86\u8fd9\u4e2a\u7a7a\u6808\uff0c\u4e0d\u96be\u6784\u9020\u4e00\u79cd\u7b56\u7565\uff1a\u5c06 $2n-2$ \u79cd\u724c\u578b\u5e73\u5747\u5206\u914d\u5230\u524d $n-1$ \u4e2a\u6808\u4e2d\u3002\u5bf9\u4e8e\u5f53\u524d\u7684\u724c $i$\uff0c\u8bbe\u5176\u7684\u79cd\u7c7b\u4e3a $a_i$\uff0c\u79cd\u7c7b $a_i$ \u5e94\u5206\u914d\u5230\u7684\u6808\u4e3a $s_i$\u3002\n\n- \u82e5\u6808 $s_i$ \u6ca1\u6709\u7b2c $a_i$ \u79cd\u724c\uff0c\u5219\u6267\u884c\u64cd\u4f5c $1$\uff1a\u5c06\u724c $i$ \u653e\u5165\u6808 $s_i$\u3002\n- \u82e5\u6808 $s_i$ \u5df2\u7ecf\u6709\u7b2c $a_i$ \u79cd\u724c\uff0c\u4e14\u5b83\u5728\u6808\u9876\uff0c\u5219\u6267\u884c\u64cd\u4f5c $1$\uff1a\u5c06\u724c $i$ \u653e\u5165\u6808 $s_i$\uff0c\u5e76\u81ea\u52a8\u6d88\u9664\u6808 $s_i$ \u6700\u4e0a\u65b9\u7684\u4e24\u5f20\u76f8\u540c\u79cd\u7c7b\u7684\u724c\u3002\n- \u82e5\u6808 $s_i$ \u5df2\u7ecf\u6709\u7b2c $a_i$ \u79cd\u724c\uff0c\u4e14\u5b83\u5728\u6808\u5e95\uff0c\u5219\u5148\u6267\u884c\u64cd\u4f5c $1$\uff1a\u5c06\u724c $i$ \u653e\u5165\u6808 $n$\uff1b\u518d\u6267\u884c\u64cd\u4f5c $2$\uff1a\u6d88\u9664\u6808 $s_i$ \u548c\u6808 $n$ \u7684\u6808\u5e95\u4e24\u5f20\u76f8\u540c\u79cd\u7c7b\u7684\u724c\u3002\n\n\u4e0a\u9762\u7684\u7b56\u7565\u4f1a\u4fdd\u8bc1\uff1a**\u4efb\u610f\u65f6\u5019\u4efb\u610f\u4e00\u4e2a\u6808\u4e2d\u6700\u591a\u53ea\u6709 $2$ \u5f20\u724c\uff0c\u4e14\u4ece\u724c\u5806\u4e2d\u65b0\u62ff\u4e00\u5f20\u724c\u65f6\u4e00\u5b9a\u4f1a\u5b58\u5728\u7a7a\u6808\u3002\u6808\u9876\u7684\u724c\u5728\u6808\u9876\u76f4\u63a5\u6d88\u9664\uff0c\u6808\u5e95\u7684\u724c\u5229\u7528\u7a7a\u6808\u6d88\u9664\u3002**\n\n### \u5728\u90e8\u5206\u5206 $n=2$ \u4e2d\uff0c\u5c06 $k=2n-1$ \u8f6c\u5316\u4e3a $k=2n-2$\n\n$k=2n-1$ \u76f8\u6bd4\u4e8e $k=2n-2$ \u591a\u4e86\u4e00\u79cd\u724c\u3002\u8bbe\u5f53\u524d\u7b2c\u4e00\u4e2a\u6808\u5df2\u7ecf\u6709 $2$ \u5f20\u724c\uff0c**\u6808\u5e95\u7684\u724c\u7684\u79cd\u7c7b\u4e3a $x$\uff0c\u6808\u9876\u7684\u724c\u7684\u79cd\u7c7b\u4e3a $y$**\uff0c\u7b2c\u4e8c\u4e2a\u6808\u4e3a\u7a7a\u6808\u3002\n\n\u5982\u679c\u5c06\u591a\u51fa\u7684\u8fd9\u79cd\u724c\u653e\u5165\u7a7a\u6808\uff08\u7b2c\u4e8c\u4e2a\u6808\uff09\uff0c\u53ef\u80fd\u5bfc\u81f4\u7a7a\u6808\u88ab\u5360\u7528\u800c\u4e0d\u80fd\u6d88\u9664\u7b2c\u4e00\u4e2a\u6808\u7684\u6808\u5e95\u7684\u724c\uff1b\u5982\u679c\u5c06\u5176\u653e\u5165\u7b2c\u4e00\u4e2a\u6808\uff0c\u53ef\u80fd\u5bfc\u81f4\u7b2c\u4e00\u4e2a\u6808\u6709 $3$ \u5f20\u724c\uff0c\u4e0d\u80fd\u6d88\u9664\u4e2d\u95f4\u7684\u724c\u3002\u6211\u4eec\u628a**\u591a\u51fa\u7684\u8fd9\u79cd\u724c\u79f0\u4e3a\u7b2c $3$ \u8005**\u3002\n\n\u4ece\u7b80\u5355\u5165\u624b\uff0c\u8bbe\u60f3\u4e00\u79cd\u5f88\u7f8e\u597d\u7684\u60c5\u51b5\uff1a\u724c\u5806\u4e2d\u7b2c $3$ \u8005\u540e\u9762\u5168\u662f $y$\u3002\u90a3\u4e48\u6211\u4eec\u53ea\u8981\u628a\u7b2c $3$ \u8005\u653e\u5165\u7a7a\u6808\uff0c$y$ \u5728\u6808\u9876\u76f4\u63a5\u6d88\u3002\u8fd9\u79cd\u60c5\u51b5\u663e\u7136\u4e0d\u53ef\u80fd\u3002\u56e0\u4e3a\u5f53\u524d\u7b2c\u4e00\u4e2a\u6808\u4e2d\u5df2\u7ecf\u6709 $x$\uff0c\u6240\u4ee5**\u7b2c $3$ \u8005\u540e\u9762\u4e00\u5b9a\u4f1a\u5b58\u5728 $x$**\u3002\n\n\u6b38\uff5e\u662f\u4e0d\u662f\u6211\u4eec\u53ef\u4ee5\u4e00\u6b21\u6027\u5bf9**\u724c\u5806\u4e2d\u4ece\u5f53\u524d\u7684\u7b2c $3$ \u8005\u5230\u7b2c\u4e00\u5f20 $x$** \u8fdb\u884c\u5904\u7406\uff0c\u5904\u7406\u5b8c\u540e\u5c06\u5c40\u9762\u8f6c\u5316\u4e3a $k=2n-2$ \u65f6\u7684\u60c5\u51b5\u5462\uff1f\u53ef\u4ee5\uff01\n\n1. \u82e5\u724c\u5806\u4e2d\u4ece\u7b2c $3$ \u8005\u5230\u7b2c\u4e00\u5f20 $x$ \u7684\u60c5\u51b5\u662f `3 x`\uff1a\u5148\u6267\u884c\u64cd\u4f5c $1$\uff1a\u5c06\u7b2c $3$ \u8005\u653e\u5165\u7b2c\u4e00\u4e2a\u6808\uff1b\u518d\u6267\u884c\u64cd\u4f5c $1$\uff1a\u5c06 $x$ \u653e\u5165\u7b2c\u4e8c\u4e2a\u6808\uff1b\u518d\u6267\u884c\u64cd\u4f5c $2$\uff1a\u6d88\u9664\u7b2c\u4e00\u4e2a\u6808\u548c\u7b2c\u4e8c\u4e2a\u6808\u7684\u6808\u5e95\u4e24\u5f20\u76f8\u540c\u79cd\u7c7b\u7684\u724c\u3002\n2. \u82e5\u724c\u5806\u4e2d\u4ece\u7b2c $3$ \u8005\u5230\u7b2c\u4e00\u5f20 $x$ \u7684\u60c5\u51b5\u662f `3 y y x`\uff1a\u5148\u6267\u884c\u64cd\u4f5c $1$\uff1a\u5c06\u7b2c $3$ \u8005\u653e\u5165\u7b2c\u4e8c\u4e2a\u6808\uff1b\u518d\u6267\u884c\u64cd\u4f5c $1$\uff1a\u5c06 $y$ \u653e\u5165\u7b2c\u4e00\u4e2a\u6808\uff0c\u5e76\u81ea\u52a8\u6d88\u9664\u7b2c\u4e00\u4e2a\u6808\u6700\u4e0a\u65b9\u7684\u4e24\u5f20\u76f8\u540c\u79cd\u7c7b\u7684\u724c\uff1b\u518d\u6267\u884c\u64cd\u4f5c $1$\uff1a\u5c06 $y$ \u653e\u5165\u7b2c\u4e8c\u4e2a\u6808\uff1b\u518d\u6267\u884c\u64cd\u4f5c $1$\uff1a\u5c06 $x$ \u653e\u5165\u7b2c\u4e00\u4e2a\u6808\uff0c\u5e76\u81ea\u52a8\u6d88\u9664\u7b2c\u4e00\u4e2a\u6808\u6700\u4e0a\u65b9\u7684\u4e24\u5f20\u76f8\u540c\u79cd\u7c7b\u7684\u724c\u3002\u6b64\u65f6\u7a7a\u6808\u53d8\u6210\u4e86\u7b2c\u4e00\u4e2a\u6808\u3002\n\n\u5bf9\u4e8e\u5176\u4ed6\u60c5\u51b5\uff08\u4ece\u7b2c $3$ \u8005\u5230\u7b2c\u4e00\u5f20 $x$ \u4e2d\u6709\u82e5\u5e72\u4e2a $3$ \u548c $y$\uff09\uff0c\u53ef\u4ee5\u628a**\u591a\u4f59\u7684** $3$ \u653e\u5728\u7b2c\u4e8c\u4e2a\u6808\u7684\u6808\u9876**\u6d88\u9664**\uff0c\u628a\u591a\u4f59\u7684 $y$ \u653e\u5728\u7b2c\u4e00\u4e2a\u6808\u7684\u6808\u9876\u6d88\u9664\uff0c\u5c06**\u6700\u540e\u4e00\u5f20** $3$ \u6216 $y$ \u5b66\u4e60\u4e0a\u9762\u4e24\u79cd\u60c5\u51b5\u7684\u8ba8\u8bba\u8fdb\u884c\u7c7b\u4f3c\u7684\u5904\u7406\uff0c\u5177\u4f53\u7ec6\u8282\u89c1\u4ee3\u7801\u3002\n\n### \u5c06\u90e8\u5206\u5206 $n=2$ \u63a8\u5e7f\u5230\u6b63\u89e3 $n\\le 300$\n\n\u7c7b\u4f3c\u5730\uff0c\u6211\u4eec\u53ef\u4ee5\u4e00\u6b21\u6027\u5bf9\u724c\u5806\u4e2d\u4ece\u5f53\u524d\u7684\u7b2c $3$ \u8005\u5230\u7b2c\u4e00\u5f20\u6808\u5e95\u7684\u724c\uff08\u8bbe\u8be5\u6808\u4e3a $s$\uff0c\u8be5\u6808\u7684\u6808\u5e95\u7684\u724c\u4e3a $s_x$\u3001\u6808\u9876\u4e3a $s_y$\uff09\u8fdb\u884c\u5904\u7406\uff0c\u5904\u7406\u5b8c\u540e\u5c06\u5c40\u9762\u8f6c\u5316\u4e3a $k=2n-2$ \u65f6\u7684\u60c5\u51b5\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u5728\u724c\u5806\u4ece\u7b2c $3$ \u8005\u5230\u7b2c\u4e00\u5f20 $s_y$ \u4e2d\u6211\u4eec\u53ea\u9700\u8981\u5173\u5fc3\u4e09\u79cd\u724c\uff1a$3,s_x,s_y$\u3002\u56e0\u4e3a**\u5176\u4ed6\u7684\u724c\u90fd\u662f\u5176\u4ed6\u6808\u7684\u6808\u9876\u7684\u724c\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728\u4ed6\u4eec\u5404\u81ea\u7684\u6808\u7684\u6808\u9876\u76f4\u63a5\u6d88\u9664**\u3002\u73b0\u5728\u6211\u4eec\u4ec5\u9700\u8981\u5229\u7528\u6808 $s$ \u548c\u7a7a\u6808\u5bf9\u724c $3,s_x,s_y$ \u8fdb\u884c\u5904\u7406\uff0c\u53d1\u73b0\u8fd9\u5c31\u662f $n=2$ \u65f6\u7684\u60c5\u51b5\u3002\n\n\u6ce8\u610f\u7279\u5224 $n=1$ \u65f6\u7684\u60c5\u51b5\uff0c\u6b64\u65f6\u6ca1\u6709\u7a7a\u6808\u3002\n\n\u7406\u8bba\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(S)$\u3002\u8003\u573a\u4e0a\u4e3a\u4e86\u4ee3\u7801\u65b9\u4fbf\uff0c\u6211\u5199\u7684\u662f $O(NS)$ \u7684\u4ee3\u7801\u3002\n\n\u5177\u4f53\u4ee3\u7801\u89c1[\u526a\u8d34\u677f](https://www.luogu.com.cn/paste/l3cramtm)\u3002\n\n###### \u540e\u8bb0\n\n\u672c\u9898\u6709\u4e00\u5b9a\u7684\u6784\u9020\u601d\u7ef4\u96be\u5ea6\uff0c\u4f46\u662f\u53c8\u914d\u4e4b\u4ee5\u5927\u6a21\u62df\uff0c\u5bfc\u81f4\u8003\u573a\u4e0a\u60f3\u51fa T2 \u6784\u9020\u601d\u8def\u7684\u540c\u5b66\u6df1\u9677\u5927\u6a21\u62df\uff1b\u8003\u573a\u4e0a\u5bf9 T2 \u6ca1\u601d\u8def\u7684\u540c\u5b66\u53cd\u800c\u65e0\u5f62\u4e2d\u88ab\u5e2e\u4e86\u4e00\u628a\uff0c\u53bb\u5199\u66f4\u5212\u7b97\u7684 T3 \u4e86\u3002",
        "postTime": 1670336409,
        "uid": 557756,
        "name": "Brilliance_Z",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P8866"
    },
    {
        "content": "~~\u55ef\uff0c\u8fd9\u7834\u9898\uff0c\u771f\u7684\u5f88\u8ba9\u4eba\u8ba8\u538c\u3002~~\n\n\u9996\u5148\uff0c\u89c2\u5bdf\u6570\u636e\u8303\u56f4\uff0c\u53d1\u73b0 $ k $ \u53ea\u6709\u4e24\u79cd\u60c5\u51b5\uff0c\u76f4\u63a5\u5165\u624b\u3002\n\n\u5f53 $ k=2n-2 $ \u65f6\uff0c\u7ed9\u524d $ n-1 $ \u4e2a\u6808\u6bcf\u4e2a\u5206\u914d\u4e24\u79cd\u989c\u8272\uff0c\u8fd9\u6837\u6bcf\u6b21\u9047\u5230\u9700\u8981\u6d88\u9664\u7684\u60c5\u51b5\u65f6\u53ea\u9700\u8981\u5728\u7a7a\u6808\u4e2d\u64cd\u4f5c\uff0c\u5fc5\u7136\u80fd\u591f\u5b8c\u6210\u3002\n\n\u5f53 $ k=2n-1 $ \u65f6\uff0c\u53d1\u73b0\u4e4b\u524d\u7684\u505a\u6cd5\u4e0d\u80fd\u6210\u7acb\uff0c\u5018\u82e5\u6781\u9650\u60c5\u51b5\u4e0b\u524d $ n-1 $ \u4e2a\u6808\u5806\u6ee1\u540e\u53c8\u6765\u4e00\u79cd\u65b0\u7684\u989c\u8272\uff0c\u6b64\u65f6\u5c31\u65e0\u6cd5\u653e\u7f6e\uff0c\u6240\u4ee5\u6211\u4eec\u505a\u51fa\u4e00\u4e9b\u53d8\u5316\u3002\n\n\u8bb0\u5f55 $ nxt $ \u6570\u7ec4\uff0c\u8bb0\u5f55\u4e00\u5f20\u724c\u540e\u9762\u7b2c\u4e00\u5f20\u4e0e\u5b83\u5339\u914d\u7684\u724c\u7684\u4f4d\u7f6e\uff0c\u7279\u522b\u5730\uff0c\u5bf9\u4e8e\u88ab\u7528\u6765\u5339\u914d\u7684\u724c\u4e0d\u8bb0\u5f55\u3002\n\n\u5047\u5982\u524d $ n-1 $ \u4e2a\u6808\u672a\u653e\u6ee1\u6216\u653e\u6ee1\u540e\u4ecd\u7136\u672a\u51fa\u73b0\u591a\u4f59\u7684\u989c\u8272\uff0c\u6b64\u65f6\u76f4\u63a5\u6309\u7167\u4e0a\u6587\u6240\u8ff0\u7684\u505a\u5373\u53ef\uff0c\u63a5\u4e0b\u6765\u8ba8\u8bba\u6700\u9ebb\u70e6\u7684\u60c5\u51b5\uff0c\u5373\u653e\u6ee1\u540e\u51fa\u73b0\u4e86\u591a\u4f59\u7684\u989c\u8272\u3002\n\n\u6211\u4eec\u8003\u8651\u524d $ n-1 $ \u4e2a\u6808\u4e2d\u6808\u9876\u548c\u6808\u5e95\u5143\u7d20 $ nxt $ \u7684\u5173\u7cfb\u3002\u5018\u82e5\u6211\u4eec\u53d1\u73b0\u5b58\u5728\u4e00\u4e2a\u6808\uff0c\u5b83\u7684\u6808\u9876\u5143\u7d20 $ nxt $ \u503c\u5927\u4e8e\u6808\u5e95\u5143\u7d20 $ nxt $ \u503c\uff0c\u90a3\u4e48\u53ef\u4ee5\u5c06\u65b0\u5143\u7d20\u653e\u5728\u8be5\u6808\u4e0a\uff0c\u56e0\u4e3a\u5728\u6d88\u9664\u6808\u9876\u5143\u7d20\u524d\u4e00\u5b9a\u4f1a\u5148\u6d88\u9664\u6808\u5e95\u5143\u7d20\u3002\u5018\u82e5\u4e0d\u5b58\u5728\uff0c\u4fbf\u8bf4\u660e\u5728\u6240\u6709\u6808\u5e95\u5143\u7d20\u4e2d $ nxt $ \u6700\u5c0f\u7684\u5143\u7d20\u6d88\u9664\u524d\uff0c\u6d88\u9664\u64cd\u4f5c\u4e00\u5b9a\u90fd\u662f\u5728\u6808\u9876\u8fdb\u884c\uff0c\u90a3\u4e48\u53ef\u4ee5\u5c06\u65b0\u5143\u7d20\u653e\u5165\u539f\u672c\u7684\u7a7a\u6808\uff0c\u7b49\u5230\u6d88\u9664\u51fa\u4e00\u4e2a\u65b0\u7684\u7a7a\u6808\uff0c\u800c\u4e0a\u6587\u7684\u9650\u5236\u5219\u4fdd\u8bc1\u4e86\u64cd\u4f5c\u7684\u5408\u6cd5\u6027\u3002\n\n\u4e8e\u662f\u8bb0\u5f55\u51fa\u7a7a\u6808\u4f4d\u7f6e $ Free $\uff0c\u53ca\u65f6\u66f4\u65b0\u5373\u53ef\u3002\n\n\u611f\u89c9\u5199\u7684\u8fd8\u884c\u5427\uff1a\n\n```cpp\n#include<iostream>\n#include<iomanip>\n#include<cmath>\n#include<cstring>\n#include<cstdio>\n#include<algorithm>\n#include<queue>\nusing namespace std;\n#define md(a) a=(a%mod+mod)%mod\n#define file(a) freopen(#a\".in\",\"r\",stdin);freopen(#a\".out\",\"w\",stdout)\nconst int Ns=305,Ncd=4000005,Ncol=705;\nint T,Now;\nint n,m,Num,col[Ncd];\nint nxt[Ncd],las[Ncol];\nint Free,st[Ns][2];\nstruct Do{int op,x,y;};\nvector<Do>Res;\nvoid Clear()\n{\n\tRes.clear();\n\tfor(int i=1;i<=n;i++)st[i][0]=st[i][1]=0;\n\tfor(int i=1;i<=m;i++)nxt[i]=0;\n\tfor(int i=1;i<=Num;i++)las[i]=0;\n}\nvoid Up(int x){Res.push_back({1,x,0});}\nvoid Down(int x,int y){Res.push_back({1,y,0}),Res.push_back({2,min(x,y),max(x,y)});}\npair<int,int>Fcol(int c){for(int i=1;i<=n;i++){if(col[st[i][0]]==c)return {i,0};if(col[st[i][1]]==c)return {i,1};}}\nint Fsta(){for(int i=1;i<=n;i++)if(i!=Free&&st[i][0]==0)return i;return -1;}\nint Fuld(){for(int i=1;i<=n;i++)if(i!=Free&&nxt[st[i][0]]>nxt[st[i][1]])return i;return -1;}\nint Fmin(){pair<int,int>ans={m+1,0};for(int i=1;i<=n;i++)if(i!=Free)ans=min(ans,{nxt[st[i][1]],i});return ans.second;}\nvoid Use_Normal(int i)\n{\n\tif(nxt[i]==0)\n\t{\n\t\tpair<int,int>Pos=Fcol(col[i]);\n\t\tint x=Pos.first,y=Pos.second;\n\t\tif(y==0)Up(x),st[x][0]=0;\n\t\telse Down(x,Free),st[x][1]=st[x][0],st[x][0]=0;\n\t}\n\telse\n\t{\n\t\tint Pos=Fsta();\n\t\tUp(Pos),st[Pos][(st[Pos][1]==0)]=i;\n\t}\n}\nint Use_Free(int i)\n{\n\tint Pos=Fuld();\n\tif(Pos!=-1)\n\t{\n\t\tUp(Pos);int mn=min(nxt[st[Pos][1]],nxt[i]);\n\t\tfor(int j=i+1;j<=mn-1;j++)Use_Normal(j);\n\t\tif(nxt[st[Pos][1]]<nxt[i])Down(Pos,Free),st[Pos][1]=st[Pos][0],st[Pos][0]=i;\n\t\telse Up(Pos);\n\t\treturn mn+1;\n\t}\n\telse\n\t{\n\t\tPos=Fmin(),Up(Free);\n\t\tint mn=min(nxt[st[Pos][1]],nxt[i]);\n\t\tif(nxt[st[Pos][1]]<nxt[i])st[Free][1]=i,Free=Pos;\n\t\tfor(int j=i+1;j<=mn-1;j++)Use_Normal(j);\n\t\tif(nxt[st[Pos][1]]<nxt[i])Up(Pos),st[Pos][1]=0;\n\t\telse Up(Free),st[Free][1]=0;\n\t\treturn mn+1;\n\t}\n}\nvoid Start()\n{\n\tif(n==1){for(int i=1;i<=m;i++)Up(1);return ;}\n\tFree=n;\n\tfor(int i=1;i<=m;)\n\t{\n\t\tif(nxt[i]==0)Use_Normal(i),i++;\n\t\telse\n\t\t{\n\t\t\tint Pos=Fsta();\n\t\t\tif(Pos!=-1)Up(Pos),st[Pos][(st[Pos][1]==0)]=i,i++;\n\t\t\telse i=Use_Free(i);\n\t\t}\n\t}\n}\nvoid Play_Game()\n{\n\tscanf(\"%d%d%d\",&n,&m,&Num);\n\tfor(int i=1;i<=m;i++)scanf(\"%d\",&col[i]);\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tif(las[col[i]])nxt[las[col[i]]]=i,las[col[i]]=0;\n\t\telse las[col[i]]=i;\n\t}\n\tStart();\n\tcout<<Res.size()<<endl;\n\tfor(Do x:Res)\n\t{\n\t\tif(x.op==1)printf(\"1 %d\\n\",x.x);\n\t\telse printf(\"2 %d %d\\n\",x.x,x.y);\n\t}\n\tClear();\n}\nsigned main()\n{\n\tscanf(\"%d\",&T);\n\twhile(T--)Play_Game();\n\treturn 0;\n}\n```\n",
        "postTime": 1672398888,
        "uid": 556042,
        "name": "Iratis",
        "ccfLevel": 7,
        "title": "P8866-\u55b5\u4e86\u4e2a\u55b5"
    },
    {
        "content": "\u8fd9\u662f\u6211\u7684\u7b80\u6613\u9898\u89e3\uff1a\n\n$k=2n-2$ \u7684\u65f6\u5019\u76f4\u63a5\u7559\u4e00\u4e2a\u7a7a\u6808\uff0c\u7136\u540e\u5176\u5b83\u6bcf\u4e2a\u6808\u7ef4\u62a4\u4e24\u4e2a\u989c\u8272\u3002\n\n\u8fd9\u662f\u6211\u7684 $15$ \u5206\u4ee3\u7801\uff0c\u5982\u679c\u60f3\u5230\u505a\u6cd5\u7684\u8bdd\uff0c\u5e94\u8be5\u5f88\u597d\u5199\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nnamespace io\n{\n\tint F()\n\t{\n\t\tint n=0,F=0;\n\t\tchar ch;\n\t\twhile((ch=getchar())!='-'&&(ch<'0'||ch>'9'));\n\t\tch=='-'?F=1:n=ch-'0';\n\t\twhile((ch=getchar())>='0'&&ch<='9')n=n*10+ch-'0';\n\t\treturn F?-n:n;\n\t}\n}\nint top[3333],bot[3333];\nstruct op{\n\tint v,s1,s2;\n};\nint main()\n{\n\tint T=io::F();\n\twhile(T--){\n\t\tstd::vector<op> ops;\n\t\tint n=io::F(),m=io::F(),k=io::F();\n\t\tfor(int i=1;i<=m;++i){\n\t\t\tint a=io::F();\n\t\t\tint pl=a+1>>1;\n\t\t\tif(bot[pl]==a){\n\t\t\t\tops.push_back((op){1,n,0});\n\t\t\t\tops.push_back((op){2,pl,n});\n\t\t\t\tbot[pl]=top[pl];\n\t\t\t\ttop[pl]=0;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tops.push_back((op){1,pl,0});\n\t\t\t\tif(top[pl]==a)top[pl]=0;\n\t\t\t\telse if(bot[pl]==0)bot[pl]=a;\n\t\t\t\telse top[pl]=a;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%ld\\n\",ops.size());\n\t\tfor(auto p: ops){\n\t\t\tif(p.v==1)printf(\"1 %d\\n\",p.s1);\n\t\t\t\telse printf(\"2 %d %d\\n\",p.s1,p.s2);\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n$k=2n-1$ \u7684\u65f6\u5019\u5982\u679c\u7b2c $2n-1$ \u79cd\u989c\u8272\u52a0\u5165\uff0c\u90a3\u4e48\u68c0\u67e5\u4e0b\u4e00\u79cd\u6808\u5e95\u5143\u7d20\u6216\u8005\u81ea\u8eab\u51fa\u73b0\u7684\u4f4d\u7f6e\u3002\u5982\u679c\u81ea\u8eab\u5148\u4e8e\u4efb\u4f55\u4e00\u4e2a\u6808\u5e95\u5143\u7d20\u51fa\u73b0\uff0c\u90a3\u4e48\u5c06\u5b83\u653e\u5165\u7a7a\u6808\u4e2d\u3002\u5982\u679c\u4e00\u4e2a\u6808\u5e95\u5143\u7d20\u5148\u51fa\u73b0\uff0c\u90a3\u4e48\u68c0\u67e5\u8fd9\u4e2a\u5143\u7d20\u4e0a\u9762\u7684\u5143\u7d20\u5728\u5b83\u4e4b\u524d\u51fa\u73b0\u5947\u6570\u6b21\u8fd8\u662f\u5076\u6570\u6b21\u3002\u5982\u679c\u662f\u5076\u6570\u6b21\u5c31\u628a\u65b0\u5143\u7d20\u63d2\u5165\u5728\u8fd9\u4e2a\u6808\u6808\u9876\uff0c\u6700\u540e\u7528\u7a7a\u6808\u6d88\u53bb\u6808\u5e95\u5143\u7d20\u3002\u5982\u679c\u662f\u5947\u6570\u6b21\u5c31\u628a\u65b0\u5143\u7d20\u63d2\u5165\u7a7a\u6808\uff0c\u7136\u540e\u4ece\u6808\u9876\u6d88\u53bb\u90a3\u4e2a\u6808\u5e95\u5143\u7d20\u3002\n\n\u4e0d\u8fc7\u6211\u7684\u4e3b\u8981\u76ee\u7684\u662f\u8bf4\u8bf4 $n=2$ \u7684\u90e8\u5206\u5206\u600e\u4e48\u505a\u3002\u53d1\u73b0\u5927\u90e8\u5206\u6ca1\u6709\u901a\u8fc7\u672c\u9898\u7684\u9009\u624b\u90fd\u6ca1\u6709\u62ff\u5230\u8fd9\u4e00\u6863\u90e8\u5206\u5206\u3002\n\n\u7b2c\u4e00\u79cd\u601d\u8def\uff0c\u4e5f\u662f\u6211\u6700\u5148\u8003\u8651\u5230\u7684\u601d\u8def\u662f\uff0c$n=2$ \u76f8\u5f53\u4e8e\u5f80\u4e00\u6839\u4e24\u7aef\u5f00\u53e3\u7684\u7ba1\u5b50\u91cc\u585e\u5361\u724c\uff0c\u4e24\u5f20\u76f8\u90bb\u7684\u5361\u724c\u6d88\u53bb\u3002\u5f80\u7ba1\u9053\u7684\u5750\u6807\u585e\u724c\u5c31\u76f8\u5f53\u4e8e\u653e\u5165\u7b2c\u4e00\u4e2a\u6808\u3002\u5f80\u53f3\u8fb9\u585e\u724c\u5c31\u76f8\u5f53\u4e8e\u653e\u5165\u7b2c\u4e8c\u4e2a\u6808\u3002\u6d88\u9664\u65f6\u82e5\u4e24\u5f20\u76f8\u90bb\u7684\u724c\u5728\u4e0d\u540c\u6808\u91cc\uff0c\u5c31\u4f7f\u7528\u4e00\u6b21\u64cd\u4f5c $2$\u3002\n\n\u7136\u540e\u8003\u8651\u52a0\u5165\u7b2c\u4e09\u79cd\u989c\u8272\u7684\u724c\u7684\u60c5\u51b5\u3002\u8fd9\u65f6\u770b\u4e0b\u4e00\u5f20\u724c\u7684\u989c\u8272\u3002\u6b64\u65f6\u4e00\u5b9a\u6709\u4e00\u79cd\u65b9\u5f0f\u4f7f\u5f97\u52a0\u5165\u8fd9\u7b2c\u4e09\u79cd\u989c\u8272\u7684\u724c\u4e4b\u540e\uff0c\u4e0b\u4e00\u5f20\u724c\u6ca1\u6709\u88ab\u5939\u5728\u4e2d\u95f4\u3002\u4e8e\u662f\u4e0b\u4e00\u5f20\u724c\u8fdb\u6765\u65f6\u5c31\u53ef\u4ee5\u6d88\u9664\u4e86\u3002\u8fd9\u79cd\u65b9\u6cd5\u5f88\u597d\u5199\u3002\n\n\u7b2c\u4e8c\u79cd\u601d\u8def\u662f\uff0c\u5982\u679c\u4e24\u5f20\u76f8\u540c\u7684\u724c\u4e4b\u95f4\u6ca1\u6709\u724c\u6216\u8005\u53ea\u6709\u4e00\u5f20\u522b\u7684\u724c\uff0c\u90a3\u4e48\u53ef\u4ee5\u8003\u8651\u628a\u8fd9\u4e24\u5f20\u724c\u653e\u5728\u540c\u4e00\u4e2a\u6808\u91cc\u3002\u5982\u679c\u5b83\u4eec\u4e4b\u95f4\u6709\u4e00\u5f20\u724c\uff0c\u90a3\u4e48\u5c31\u653e\u5728\u4e0e\u8fd9\u5f20\u724c\u653e\u7684\u6808\u4e0d\u540c\u7684\u90a3\u4e2a\u6808\u91cc\u3002\u7136\u540e\u4ece\u5e8f\u5217\u4e2d\u5220\u53bb\u8fd9\u4e24\u5f20\u724c\u3002\n\n\u5230\u4e0d\u80fd\u6d88\u4e4b\u540e\u5269\u4e0b\u7684\u724c\u4f1a\u5f62\u5982 `123123123123...` \u7684\u5faa\u73af\uff0c\u8fd9\u65f6\u5019\u53ea\u8981\u968f\u4fbf\u6784\u9020\u4e00\u4e0b `123123` \u600e\u4e48\u6d88\u5c31\u884c\uff0c\u7136\u540e\u4e0d\u65ad\u91cd\u590d\u5c31\u597d\u4e86\u3002\u8fd9\u79cd\u65b9\u6cd5\u5f88\u96be\u5199\u3002\n\n\u8fd9\u662f\u6211\u7684\u6b63\u89e3\u7a0b\u5e8f\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nnamespace io\n{\n\tint F()\n\t{\n\t\tint n=0,F=0;\n\t\tchar ch;\n\t\twhile((ch=getchar())!='-'&&(ch<'0'||ch>'9'));\n\t\tch=='-'?F=1:n=ch-'0';\n\t\twhile((ch=getchar())>='0'&&ch<='9')n=n*10+ch-'0';\n\t\treturn F?-n:n;\n\t}\n}\nint last;\nint a[2222222];\nint pos[11111];\nint top[3333],bot[3333];\nint q[2222222],hq,tq;\nstruct op{\n\tint v,s1,s2;\n\top(int x,int y,int z):v(x),s1(y),s2(z){}\n};\nvoid remove_top(std::vector<op>& ops, int& p){\n\tops.emplace_back(1,p,0);\n\ttop[p]=0;\n\tq[tq++]=p;\n\tp=0;\n}\nvoid remove_bot(std::vector<op>& ops, int& p){\n\tops.emplace_back(1,last,0);\n\tops.emplace_back(2,-p,last);\n\tpos[top[-p]]*=-1;\n\tbot[-p]=top[-p];\n\ttop[-p]=0;\n\tq[tq++]=-p;\n\tp=0;\n}\nvoid push(std::vector<op>& ops, int c){\n\tint pl=q[hq++];\n\tops.emplace_back(1,pl,0);\n\tif(bot[pl]){\n\t\ttop[pl]=c;\n\t\tpos[c]=pl;\n\t}\n\telse{\n\t\tbot[pl]=c;\n\t\tpos[c]=-pl;\n\t}\n}\nint main()\n{\n\tint T=io::F();\n\twhile(T--){\n\t\tint n=io::F(),m=io::F(),k=io::F();\n\n\t\tfor(int i=1;i<=m;++i){\n\t\t\ta[i]=io::F();\n\t\t}\n\t\thq=tq=1;\n\t\tfor(int i=1;i<n;++i){\n\t\t\tq[tq++]=i;\n\t\t\tq[tq++]=i;\n\t\t}\n\t\tlast=n;\n\t\tstd::vector<op> ops;\n\t\tfor(int i=1;i<=m;++i){\n\t\t\tint &p=pos[a[i]];\n\t\t\tif(p>0){\n\t\t\t\tremove_top(ops,p);\n\t\t\t}\n\t\t\telse if(p<0){\n\t\t\t\tremove_bot(ops,p);\n\t\t\t}\n\t\t\telse if(hq!=tq){\n\t\t\t\tpush(ops,a[i]);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tint j=i+1;\n\t\t\t\twhile(pos[a[j]]>0)++j;\n\t\t\t\tif(a[i]==a[j]){\n\t\t\t\t\tops.emplace_back(1,last,0);\n\t\t\t\t\tfor(++i;i<j;++i){\n\t\t\t\t\t\tif(pos[a[i]]){\n\t\t\t\t\t\t\tremove_top(ops,pos[a[i]]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tpush(ops,a[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tops.emplace_back(1,last,0);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tint cnt=0;\n\t\t\t\t\tint cr=top[-pos[a[j]]],crp=pos[cr];\n\t\t\t\t\tint now=a[i];\n\t\t\t\t\tfor(int l=i+1;l<j;++l){\n\t\t\t\t\t\tcnt^=a[l]==cr;\n\t\t\t\t\t}\n\t\t\t\t\tif(cnt){\n\t\t\t\t\t\tops.emplace_back(1,last,0);\n\t\t\t\t\t\tfor(++i;i<j;++i){\n\t\t\t\t\t\t\tif(pos[a[i]]){\n\t\t\t\t\t\t\t\tremove_top(ops,pos[a[i]]);\n\t\t\t\t\t\t\t\tif(a[i]==cr)--tq;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if(a[i]==cr){\n\t\t\t\t\t\t\t\tq[--hq]=crp;\n\t\t\t\t\t\t\t\tpush(ops,cr);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tpush(ops,a[i]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tops.emplace_back(1,crp,0);\n\t\t\t\t\t\tbot[last]=now;\n\t\t\t\t\t\tpos[a[i]]=0;\n\t\t\t\t\t\tpos[now]=-last;\n\t\t\t\t\t\tq[tq++]=last;\n\t\t\t\t\t\tlast=crp;\n\t\t\t\t\t\tbot[last]=0;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tops.emplace_back(1,crp,0);\n\t\t\t\t\t\tfor(++i;i<j;++i){\n\t\t\t\t\t\t\tif(a[i]==cr){\n\t\t\t\t\t\t\t\tops.emplace_back(1,last,0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if(pos[a[i]]){\n\t\t\t\t\t\t\t\tremove_top(ops,pos[a[i]]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tpush(ops,a[i]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tops.emplace_back(1,last,0);\n\t\t\t\t\t\tops.emplace_back(2,crp,last);\n\t\t\t\t\t\tpos[a[i]]=0;\n\t\t\t\t\t\tpos[cr]*=-1;\n\t\t\t\t\t\tpos[now]=crp;\n\t\t\t\t\t\tbot[crp]=cr;\n\t\t\t\t\t\ttop[crp]=now;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%ld\\n\",ops.size());\n\t\tfor(auto p: ops){\n\t\t\tif(p.v==1)printf(\"1 %d\\n\",p.s1);\n\t\t\t\telse printf(\"2 %d %d\\n\",p.s1,p.s2);\n\t\t}\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1670507020,
        "uid": 7528,
        "name": "E_Space",
        "ccfLevel": 10,
        "title": "P8866 \u55b5\u4e86\u4e2a\u55b5 \u9898\u89e3"
    },
    {
        "content": "\u9996\u5148\u64cd\u4f5c\u6b21\u6570\u7684\u9650\u5236 $2m$ \u53ef\u4ee5\u5b8c\u5168\u4e0d\u7528\u7ba1\uff0c\u56e0\u4e3a $1$ \u64cd\u4f5c\u53ea\u4f1a\u8fdb\u884c $m$ \u6b21\uff0c\u800c $2$ \u64cd\u4f5c\u53ea\u8981\u4e0d\u8fdb\u884c\u65e0\u6548\u7684\u6700\u591a $m\\over2$ \u6b21\u3002\n\n\u5f53\u5361\u724c\u79cd\u7c7b $k= 2n-2 =2(n-1)$ \u65f6\uff0c\u53ef\u4ee5\u628a\u6240\u6709\u5361\u724c\u4e24\u4e24\u5206\u7ec4\uff0c\u8ba9\u524d $n-1$ \u4e2a\u6808\u5404\u5c5e\u4e8e\u4e24\u79cd\u5361\u724c\uff0c\u6700\u540e\u4e00\u4e2a\u6808\u7a7a\u7740\uff0c\u79f0\u4e3a\u7279\u6b8a\u6808\u3002\n\n\u8fd9\u6837\u5bf9\u4e8e\u67d0\u4e2a\u6808\uff0c\u6765\u4e00\u4e2a\u5c5e\u4e8e\u8be5\u6808\u7684\u5361\u724c\u65f6\uff0c\u82e5\u548c\u5e95\u90e8\u5361\u724c\u76f8\u540c\u5c31\u5229\u7528\u7279\u6b8a\u6808\u8fdb\u884c $2$ \u64cd\u4f5c\uff0c\u5426\u5219\u5c31\u76f4\u63a5\u653e\u4e0a\u53bb\u3002\u8fd9\u6837\u53ef\u4ee5\u4fdd\u8bc1\u6bcf\u65f6\u6bcf\u523b\uff0c\u524d $n-1$ \u4e2a\u6808\u7684\u5361\u724c\u4e2a\u6570\u4e0d\u8d85\u8fc7 $2$ \u3002\n\n\u5f53 $k=2n-1$  \u65f6\uff0c\u6b64\u65f6\u4f1a\u51fa\u73b0\u4e00\u79cd\u60c5\u51b5\uff1a$n-1$ \u4e2a\u6808\u90fd\u5305\u542b $2$ \u4e2a\u5361\u724c\u4e86\uff0c\u6b64\u65f6\u53c8\u6765\u6700\u540e\u4e00\u79cd\u5361\u724c\u3002\n\n\u8bbe\u8be5\u5361\u724c\u4e3a $w$\uff0c\u627e\u5230 $n-1$ \u4e2a\u653e\u6ee1\u7684\u6808\u4e2d\u5e95\u90e8\u5361\u724c\u4e4b\u540e\u6700\u5148\u51fa\u73b0\u7684\u6808 $x$ \uff0c$x$ \u6808\u5e95\u8bbe\u4e3a $u$\uff0c\u6808\u9876\u8bbe\u4e3a $v$\uff0c\u5206\u4e0b\u9762\u4e09\u79cd\u60c5\u51b5\u8ba8\u8bba\uff1a\n\n- \u82e5 $w$ \u7684\u4e0b\u4e00\u6b21\u51fa\u73b0\u65f6\u95f4\u65e9\u4e8e $u$ \uff0c\u90a3\u4e48\u53ef\u4ee5 $w$ \u76f4\u63a5\u653e\u5230\u7279\u6b8a\u6808\uff08\u56e0\u4e3a\u7279\u6b8a\u6808\u7684\u4f5c\u7528\u662f\u6d88\u9664\u5e95\u90e8\uff0c\u5728 $u$ \u4e0b\u6b21\u51fa\u73b0\u4e4b\u524d\u90fd\u4e0d\u4f1a\u7528\u5230\u7279\u6b8a\u6808\uff09\n- \u82e5 $u$ \u4e0b\u6b21\u51fa\u73b0\u65f6\u95f4\u65e9\u4e8e $v$ \uff0c\u90a3\u4e48\u53ef\u4ee5\u628a $w$ \u653e\u5230 $x$ \u9876\u90e8\uff08\u867d\u7136\u6b64\u65f6\u6808\u5185\u4f1a\u6709 $3$ \u4e2a\u5361\u724c\u5bfc\u81f4\u4e2d\u95f4\u7684 $v$ \u65e0\u6cd5\u6d88\u9664\uff0c\u4f46\u662f $u$ \u4f1a\u65e9\u4e8e $v$ \u79bb\u5f00\uff09\n- \u5269\u4e0b\u7684\u60c5\u51b5\u610f\u5473\u7740\u4e0b\u6b21\u51fa\u73b0\u7684\u65f6\u95f4\u662f $v<u<w$ \uff0c\u90a3\u4e48\u53ef\u4ee5\u628a $w$ \u653e\u5230\u7279\u6b8a\u6808\uff0c\u7136\u540e\u89c4\u5b9a\u63a5\u4e0b\u6765\u7684\u7279\u6b8a\u6808\u6539\u4e3a $x$ \uff08\u5f88\u660e\u663e\u5728 $x$ \u6e05\u7a7a\u4e4b\u524d\uff0c\u90fd\u4e0d\u4f1a\u5b58\u5728 $2$ \u64cd\u4f5c\uff0c\u6240\u4ee5\u6ca1\u5f71\u54cd\uff09\n\n\u5b9e\u73b0\u8d77\u6765\u6709\u5f88\u591a\u7ec6\u8282\uff0c\u6700\u5f00\u59cb\u5199\u7684 $O(mn)$ \u7684\u66b4\u529b\u7248\u672c\u8dd1\u4e86\u5b98\u65b9\u6570\u636e\u5c45\u7136\u4e5f\u80fd\u62ff $95$ \u5206\uff0c\u53ea\u4f1a\u6709\u4e00\u7ec4\u6570\u636e\u8d85\u65f6\u3002\n\n\u4f18\u5316\u6210 $O(m)$ \u8981\u6ce8\u610f\u51e0\u4e2a\u70b9\uff1a\n\n- \u9700\u8981\u4e00\u4e2a\u6570\u7ec4\u7ef4\u62a4\u6bcf\u4e2a\u5361\u724c\u5f53\u524d\u6240\u5728\u6808\u7684\u7f16\u53f7\n\n- \u9700\u8981\u4e00\u4e2a\u961f\u5217\u6765\u5206\u914d\u6bcf\u4e2a\u65b0\u6765\u7684\u5361\u724c\u5c5e\u4e8e\u54ea\u4e2a\u666e\u901a\u6808\u7684\uff0c\u521d\u59cb\u6bcf\u4e2a\u666e\u901a\u6808\u80fd\u63d0\u4f9b\u4e24\u4e2a\u7a7a\u4f4d\uff0c\u5361\u724c\u51fa\u6808\u4f1a\u5f52\u8fd8\u7a7a\u4f4d\n- \u67e5\u627e\u4e0b\u4e00\u4e2a\u6700\u5148\u51fa\u73b0\u5e95\u90e8\u5143\u7d20\u7684\u6808\uff0c\u53ef\u4ee5\u66b4\u529b\u5f80\u540e\u627e\uff0c\u56e0\u4e3a\u4e0b\u4e00\u6b21\u518d\u51fa\u73b0\u653e\u6ee1\u6808\u7684\u5c40\u9762\u4e00\u5b9a\u5728\u5e95\u90e8\u5143\u7d20\u51fa\u6808\u540e\uff08\u82e5\u662f\u7b2c\u4e00\u79cd\u60c5\u51b5 $w$ \u5148\u51fa\uff0c\u5c31\u5faa\u73af\u5230\u4e0b\u4e2a $w$ \u7ed3\u675f\uff09\u3002\u8fd9\u6837\u6240\u6709\u66b4\u529b\u627e\u7684\u90e8\u5206\u4e0d\u4f1a\u6709\u4ea4\u53c9\uff0c\u603b\u5faa\u73af\u6b21\u6570\u4e0d\u8d85\u8fc7 $m$\n\n\n[\u91c7\u7528\u5b8c\u5168 STL \u5b9e\u73b0\uff0c\u5199\u4e86 $90$ \u591a\u884c\uff0c\u70b9\u6211\u67e5\u770b](https://www.luogu.com.cn/paste/p9kp120t)",
        "postTime": 1670329689,
        "uid": 54357,
        "name": "OMG_wc",
        "ccfLevel": 0,
        "title": "[NOIP2022] \u55b5\u4e86\u4e2a\u55b5 \u9898\u89e3"
    },
    {
        "content": "[**\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c**](https://cjmfeitveer.github.io/2023/03/20/P8866%20%5BNOIP2022%5D%20%E5%96%B5%E4%BA%86%E4%B8%AA%E5%96%B5%20%E9%A2%98%E8%A7%A3/)\n\n\u5927\u6076\u5fc3\u601d\u7ef4\u9898\u3002\n\n\u6b64\u9898\u89e3\u4ee5\u7eaa\u5ff5\u6211\u6b7b\u53bb\u7684 $\\text{NOIP2023}$\n\n### \u601d\u8def\n\n\u8003\u8651 $k=2n-2$ \u65f6\u3002\n\n\u53d1\u73b0\u5bf9\u4e8e\u6bcf\u4e24\u79cd\u5143\u7d20\u653e\u5728\u540c\u4e00\u4e2a\u6808\u5185\u5c31\u5fc5\u7136\u4f1a\u6709\u4e00\u4e2a\u6808\u7a7a\u51fa\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u6808\u4f5c\u4e3a\u8f85\u52a9\u6808\u3002\n\n\u6211\u4eec\u5047\u8bbe\u5c06 $a_i,b_i$ \u653e\u5728\u540c\u4e00\u4e2a\u6808 $i$ \u5185\u3002\n\n\u90a3\u4e48\u6211\u4eec\u6b64\u65f6\u52a0\u5165 $a_i$ \u8fd9\u5f20\u5361\u724c\u3002\n\n1. \u6808\u9876\u4e3a $a_i$\uff0c\u76f4\u63a5\u52a0\u5165\u6d88\u53bb\u5373\u53ef\u3002\n2. \u6808\u9876\u4e3a $b_i$\uff0c\u4e14\u4ec5\u6709\u4e00\u5f20\u5361\u724c\uff0c\u76f4\u63a5\u52a0\u5165\u81f3\u6808\u9876\uff0c\u65e0\u9700\u6d88\u53bb\u3002\n3. \u6808\u9876\u4e3a $b_i$\uff0c\u4e14\u6808\u5e95\u4e3a $a_i$\uff0c\u5c06 $a_i$ \u52a0\u5165\u81f3\u8f85\u52a9\u6808\u5185\uff0c\u6d88\u53bb\u4e24\u5f20\u5361\u3002\n\n\u8fd9\u6837\uff0c\u53ef\u4ee5\u53d1\u73b0\u6bcf\u4e00\u4e2a\u6808\u5185\u6700\u591a\u5c31\u4e24\u5f20\u5361\uff0c\u4e5f\u6bd4\u8f83\u5bb9\u6613\u7ef4\u62a4\u3002\n\n\u8fd9\u5c31\u662f\u6211\u5728\u8003\u573a\u4e0a\u60f3\u4e86\u4e24\u4e2a\u5c0f\u65f6\u7684\u601d\u8def~~\u867d\u7136\u56db\u4e2a\u5c0f\u65f6\u786c\u94a2T2~~\u3002\n\n\u8003\u8651 $k=2n-1$ \u65f6\u3002\n\n\u8bb2\u4e00\u4e0b\u6211\u8003\u573a\u65f6\u5019\u7684\u601d\u8def\u3002\n\n\u53d1\u73b0\u5bf9\u4e8e $k=2n-2$ \u65f6\u7684\u505a\u6cd5\u5bf9\u4e8e\u6808\u7684\u8981\u6c42\uff1a\n\n- \u8981\u6709\u4e00\u4e2a\u7a7a\u6808\u6765\u4f5c\u4e3a\u8f85\u52a9\u6808\u3002\n- \u6bcf\u4e00\u4e2a\u5176\u4f59\u7684\u6808\u90fd\u6700\u591a\u653e\u4e24\u5f20\u5361\u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u53d1\u73b0\u53ef\u4ee5\u5c06\u52a0\u5165\u5e8f\u5217\u4e2d\u7684\u7b2c $k$ \u53f7\u5361\u63d0\u51fa\uff0c\u7ef4\u62a4\u4e00\u4e0b\u5de6\u53f3\u7684\u5e8f\u5217\u5373\u53ef\u3002\n\n\u8fd9\u662f\u6211\u8003\u573a\u7684\u5927\u81f4\u601d\u8def\uff0c\u53ef\u60dc\u6ca1\u80fd\u5199\u51fa\u6765\uff0c\u6700\u540e\u4ea4\u7684\u4ee3\u7801~~\u751a\u81f3\u8c03\u8bd5\u4ee3\u7801\u6ca1\u5220CE\u6389\u4e86~~\u3002\n\n\u73b0\u5728\u8003\u8651\u4e00\u4e0b\u5176\u5b9e\u5b9e\u73b0\u4e5f\u4e0d\u7b97\u96be\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\u5bf9\u4e8e\u4e00\u4e2a\u73b0\u5728\u5904\u5728\u6808\u9876\u7684\u5143\u7d20\uff0c\u6211\u4eec\u5c31\u5fc5\u7136\u53ef\u4ee5\u76f4\u63a5\u52a0\u5165\u6d88\u53bb\u3002\n\n\u90a3\u4e48\u6211\u4eec\u627e\u5230\u7b2c\u4e00\u4e2a\u6808\u5e95\u7684\u5143\u7d20 $a_i$\u3002\n\n\u5047\u8bbe\u6b64\u65f6\u6808\u9876\u4e3a $b_i$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5bf9\u4e8e $k,\\cdots,a_i$ \u4e2d\u7684 $b_i$ \u7684\u4e2a\u6570\u8fdb\u884c\u5206\u7c7b\u8ba8\u8bba\u3002\n\n1. \u52a0\u5165 $cnt_{b_i}$ \u4e3a\u5076\u6570\u3002\n\n    \u90a3\u4e48\u6211\u4eec\u5c06 $k$ \u653e\u7f6e\u5728 $i$ \u7684\u6808\u9876\uff0c\u8003\u8651\u7531\u4e8e $cnt_{b_i}$ \u4e3a\u5076\u6570\uff0c\u90a3\u4e48**\u65b0\u51fa\u73b0**\u7684 $b_i$ \u90fd\u4f1a\u88ab\u6d88\u53bb\uff0c\u6700\u540e\u5c06 $a_i$ \u52a0\u5165\u8f85\u52a9\u6808\uff0c\u76f4\u63a5\u6d88\u53bb\u5373\u53ef\u3002\n\n    \u8003\u8651\u73b0\u5728\u7b2c $i$ \u53f7\u6808\u4efb\u7136\u53ea\u6709\u4e24\u4e2a\u5143\u7d20\uff0c\u800c\u8f85\u52a9\u6808\u8fd8\u662f\u7a7a\u7684\uff0c\u7b26\u5408\u6761\u4ef6\u3002\n\n2. \u52a0\u5165 $cnt_{b_i}$ \u4e3a\u5947\u6570\n\n    \u90a3\u4e48\u6211\u4eec\u5c06 $k$ \u653e\u7f6e\u5728\u8f85\u52a9\u6808\u5185\uff0c\u8003\u8651\u7531\u4e8e $cnt_{b_i}$ \u4e3a\u5947\u6570\uff0c\u90a3\u4e48**\u6240\u6709**\u7684 $b_i$ \u90fd\u4f1a\u88ab\u6d88\u53bb\uff0c\u6700\u540e\u5c06 $a_i$ \u52a0\u5165 $i$ \u53f7\u6808\uff0c\u76f4\u63a5\u6d88\u53bb\u5373\u53ef\u3002\n\n    \u8003\u8651\u73b0\u5728\u7b2c $i$ \u53f7\u6808\u53d8\u6210\u7a7a\u6808\uff0c\u800c\u8f85\u52a9\u6808\u53ea\u6709\u4e00\u4e2a\u5143\u7d20\uff0c\u90a3\u4e48\u6211\u4eec\u5c06 $i$ \u53f7\u6808\u53d8\u4e3a\u8f85\u52a9\u6808\uff0c\u800c\u8f85\u52a9\u6808\u53d8\u4e3a\u4e00\u4e2a\u666e\u901a\u7684\u6808\uff0c\u540c\u6837\u7b26\u5408\u6761\u4ef6\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u4e5f\u4e0d\u7b97\u592a\u96be\u3002\n\n[Code](https://www.luogu.com.cn/record/105349479)",
        "postTime": 1679318890,
        "uid": 320933,
        "name": "Mfeitveer",
        "ccfLevel": 0,
        "title": "P8866 [NOIP2022] \u55b5\u4e86\u4e2a\u55b5 \u9898\u89e3"
    },
    {
        "content": "## [[NOIP2022] \u55b5\u4e86\u4e2a\u55b5](https://www.luogu.com.cn/problem/P8866)\n\n\u4f46\u51e1\u51fa\u9898\u4eba\u8111\u5b50\u6b63\u5e38\u4e00\u70b9\u90fd\u4e0d\u4f1a\u628a\u8fd9\u9898\u653e\u5728 $\\text{T2}$\u3002\n\n\u573a\u4e0a\u4ee5\u4e3a\u81ea\u5df1\u60f3\u51fa\u6765\u4e86\uff0c\u6253\u4e86 $3h$ \u65e0\u679c\u3002\u7136\u540e\u6ca1\u65f6\u95f4\u4e86\u3002\u5bc4\u3002\n\n\u540e\u6765\u8fd8\u53d1\u73b0\u5f00\u4e86 $10^6$ \u4e2a `deque`\uff0c\u5149\u8363\u7206\u86cb\u3002\n\n---\n\n\u53d1\u73b0 $k$ \u53ea\u6709 $2n-1$ \u548c $2n-2$ \u4e24\u79cd\u3002\n\n$k=2n-2$ \u7684\u60c5\u51b5\u662f\u5e73\u51e1\u7684\u3002\u524d $n-1$ \u4e2a\u6808\u6bcf\u4e2a\u50a8\u5b58\u4e24\u4e2a\u5143\u7d20\uff0c\u6700\u540e\u4e00\u4e2a\u6808\u4e3a\u7a7a\u6808\uff0c\u7528\u4e8e\u6d88\u9664\u6808\u5e95\u5143\u7d20\u3002\n\n\u8003\u8651\u5982\u4f55\u5b58\u653e\u591a\u51fa\u6765\u7684\u4e00\u4e2a\u5143\u7d20\u3002\n\n\u5c1d\u8bd5**\u5728\u5927\u591a\u6570\u65f6\u5019**\u4fdd\u6301 $k=2n-2$ \u505a\u6cd5\u7684\u7279\u6027\uff0c\u5373 $n-1$ \u4e2a\u6808\u4ec5\u4fdd\u5b58\u4e24\u79cd\u5143\u7d20\u5e76\u4e14\u5269\u4f59\u4e00\u4e2a\u6808\u4e3a\u7a7a\u3002\n\n\u611f\u89c9\u7a7a\u6808\u5f88\u6d6a\u8d39\uff0c\u6bd5\u7adf\u53ea\u662f\u7528\u6765\u6d88\u9664\u6808\u5e95\u3002\u90a3\u4e48\uff0c\u5982\u679c\u4e0d\u9700\u8981\u5220\u9664\u6808\u5e95\uff0c\u6211\u4eec\u76f4\u63a5\u628a\u5b83\u6254\u5728\u7a7a\u6808\u5c31\u597d\u4e86\u3002\n\n\u4e5f\u662f\u5c31\u662f\u8bf4\uff0c\u4ee4\u4e0b\u4e00\u4e2a\u6808\u5e95\u5143\u7d20\u4e3a $i$\uff0c\u5176\u6240\u5728\u6808\u7684\u6808\u9876\u5143\u7d20\u4e3a $j$\u3002\n\n\u82e5\u5f53\u524d\u5143\u7d20\u5230 $i$ \u4e4b\u95f4\u51fa\u73b0\u4e86**\u5947\u6570\u4e2a** $j$\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5**\u4ece\u6808\u9876\u5220\u5230\u6808\u5e95**\u3002\u6b64\u65f6\u628a\u591a\u51fa\u6765\u7684\u5143\u7d20\u653e\u5728\u539f\u6765\u7684\u7a7a\u6808\u4e2d\u5c31\u6ca1\u6709\u95ee\u9898\uff0c\u4e14**\u672c\u8f6e\u64cd\u4f5c\u7ed3\u675f\u540e\u4ecd\u7136\u5b58\u5728\u4e00\u4e2a\u7a7a\u6808**\u3002\n\n\u5982\u679c\u51fa\u73b0\u4e86\u5076\u6570\u4e2a $j$ \u5462\uff1f\n\n\u53d1\u73b0\u628a\u5076\u6570\u4e2a $j$ \u6254\u5230\u7a7a\u6808\u4e4b\u540e\u4f1a\u88ab\u5168\u90e8\u6d88\u9664\u3002\u6211\u4eec\u5c31**\u4e0d\u9700\u8981\u4ece\u6808\u9876\u5220\u9664\u5143\u7d20\u4e86**\uff01\n\n\u8fd9\u4e2a\u65f6\u5019\u53ef\u4ee5\u628a\u591a\u51fa\u6765\u7684\u5143\u7d20\u6254\u5230 $i$ \u6240\u5728\u6808\u7684\u6808\u9876\u3002\n\n\u5982\u6b64\u64cd\u4f5c\uff0c\u6bcf\u4e00\u8f6e\u7ed3\u675f\u540e\u90fd\u4fdd\u7559\u4e86\u539f\u6709\u7684\u6027\u8d28\u3002\u975e\u7279\u6b8a\u5143\u7d20\u6b63\u5e38\u64cd\u4f5c\u5373\u53ef\u3002\n\n\u7ec6\u8282\u8f83\u591a\u3002\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define pb push_back\n#define ppb pop_back\n#define pf push_front\n#define ppf pop_front\nconst int maxn = 610, maxm = 2e6 + 10;\nint sz;\nint n, m, k, a[maxm], emp, sp, cnt[maxn];\nint bel[maxn];\nqueue<int> qu;\nbool inq[maxn];\nstruct Satck{\n    deque<int> q;\n    int id;\n    bool empty(){return q.empty();}\n    int size(){return q.size();}\n    void push_back(int x){\n        cnt[x] ^= 1;\n        if(!q.empty() && q.back() == x) q.ppb(), sz--;\n        else q.pb(x), sz++;\n        if(q.size() < 2 && !inq[id]) qu.push(id), inq[id] = 1;\n    }\n    void pop_front(){\n        cnt[front()] ^= 1, q.pop_front(), sz--;\n        if(q.size() < 2 && !inq[id]) qu.push(id), inq[id] = 1;\n    }\n    int back(){assert(!q.empty()); return q.back();}\n    int front(){assert(!q.empty()); return q.front();}\n}st[maxn];\nint front(){\n    while(!qu.empty() && (st[qu.front()].size() > 1 || qu.front() == emp)) inq[qu.front()] = 0, qu.pop();\n    assert(!qu.empty()); int ret = qu.front(); \n    return ret;\n}\nstruct Query{\n    int opt, x, y;\n    Query(int o, int a, int b = 0){opt = o, x = a, y = b;}\n    void print(){printf(\"%d %d \", opt, x); if(opt == 2) printf(\"%d\\n\", y); else puts(\"\");}\n};\nvector<Query> ans;\nvoid wsyakioi(){\n    assert(!sz);\n    while(!qu.empty()) qu.pop();\n    scanf(\"%d%d%d\", &n, &m, &k), ans.clear();\n    for(int i = 1; i <= m; i++) scanf(\"%d\", &a[i]);\n    for(int i = 1; i < n; i++) qu.push(i), inq[i] = 1;\n    emp = n, sp = 2 * n - 1, fill(bel + 1, bel + n * 2 + 1, 0);\n    for(int i = 1; i <= m; i++) if(sz < n * 2 - 2 || cnt[a[i]]){\n        if(!cnt[a[i]]) bel[a[i]] = front(), ans.pb(Query(1, bel[a[i]])), st[bel[a[i]]].pb(a[i]);\n        else if(st[bel[a[i]]].back() == a[i]) ans.pb(Query(1, bel[a[i]])), st[bel[a[i]]].pb(a[i]);\n        else if(st[bel[a[i]]].front() == a[i]) ans.pb(Query(1, emp)), ans.pb(Query(2, bel[a[i]], emp)), st[bel[a[i]]].ppf();\n        else assert(0);\n    }else{\n        sp = a[i];\n        int j = i + 1, qwq = 0;\n        for(; j <= m; j++) if(bel[a[j]] && st[bel[a[j]]].size() == 2 && st[bel[a[j]]].front() == a[j]) break;\n        if(j == m + 1){ans.pb(Query(1, emp)), st[emp].pb(a[i]), bel[a[i]] = emp; continue;}\n        for(int k = i + 1; k <= j; k++) if(a[k] == st[bel[a[j]]].back()) qwq++;\n        int ano = st[bel[a[j]]].back();\n        if(qwq & 1){\n            bel[sp] = emp, ans.pb(Query(1, emp)), st[emp].pb(a[i]);\n            for(int k = i + 1; k <= j; k++) st[bel[a[k]]].pb(a[k]), ans.pb(Query(1, bel[a[k]]));\n            assert(st[bel[a[j]]].empty()); \n            qu.push(emp), inq[emp] = 1;\n            bel[a[j]] = emp, sp = ano, emp = bel[ano], bel[ano] = 0;\n            i = j;\n        }else{\n            bel[sp] = bel[a[j]], bel[ano] = emp;\n            for(int k = i; k < j; k++) st[bel[a[k]]].pb(a[k]), ans.pb(Query(1, bel[a[k]]));\n            ans.pb(Query(1, emp)), ans.pb(Query(2, bel[a[j]], emp)), st[bel[a[j]]].ppf();\n            assert(st[emp].empty());\n            bel[ano] = bel[a[j]], sp = a[j], bel[sp] = 0;\n            i = j;\n        }\n    }\n    printf(\"%d\\n\", ans.size());\n    for(auto p : ans) p.print();\n    for(int i = 1; i <= n; i++) assert(st[i].empty());\n}\nint main(){\n    for(int i = 1; i < maxn; i++) st[i].id = i;\n    int T; scanf(\"%d\", &T);\n    while(T--) wsyakioi();\n    return 0;\n}\n```",
        "postTime": 1670382877,
        "uid": 170890,
        "name": "Cxny",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P8866 [NOIP2022] \u55b5\u4e86\u4e2a\u55b5"
    },
    {
        "content": "\u5148\u89e3\u51b3 $k=2n-2$ \u7684\u60c5\u51b5\u3002\n\n\u5b9a\u4e49\u4e09\u79cd\u57fa\u672c\u64cd\u4f5c\uff1a\n- \u63d2\u5165\uff08`ins`\uff09\uff1a\u628a\u4e0d\u7b49\u4e8e\u6808\u9876\u7684\u6570\u5165\u6808\u3002\n- \u5220\u9664\uff08`del`\uff09\uff1a\u628a\u7b49\u4e8e\u6808\u9876\u7684\u6570\u5165\u6808\uff0c\u4e0e\u6808\u9876\u6d88\u9664\u3002\n- \u8fde\u63a5\uff08`con`\uff09\uff1a\u628a\u6570\u653e\u5230\u5907\u7528\u6808\uff08\u4e00\u4e2a\u94a6\u5b9a\u7684\u7a7a\u6808\uff09\uff0c\u518d\u4e0e\u67d0\u4e2a\u6808\u5e95\u8fdb\u884c\u6d88\u9664\u3002\n\n\u63d2\u5165\u65f6\uff0c\u5982\u679c\u6709\u9ad8\u5ea6\u4e3a $1$ \u7684\u6808\uff0c\u5c31\u4efb\u9009\u4e00\u4e2a\u63d2\u5165\uff1b\u5426\u5219\u5c31\u63d2\u5230\u9ad8\u5ea6\u4e3a $0$ \u7684\u6808\u4e2d\u3002\u663e\u7136\u8fd9\u6837\u7684\u6808\u603b\u662f\u5b58\u5728\u3002\u5b9e\u73b0\u65f6\uff0c\u53ef\u4ee5\u7528 `set`\uff0c\u4e5f\u53ef\u4ee5\u7ef4\u62a4\u4e00\u4e2a\u6808\uff0c\u5220\u9664\u65f6\u7528\u6808\u9876\u66ff\u6362\u3002\n\n$k=2n-1$ \u65f6\uff0c\u8fd9\u6837\u7684\u6808\u4e0d\u603b\u662f\u5b58\u5728\u4e86\uff0c\u6b64\u65f6\u9664\u4e86\u5c06\u8981\u653e\u5165\u7684\u6570\uff08\u539f\u6570\uff09\uff0c\u5176\u4ed6\u6570\u90fd\u5df2\u5b58\u5728\u3002\u6211\u4eec\u5148\u5ffd\u7565\u8fd9\u4e2a\u6570\uff0c\u7ee7\u7eed\u5f80\u540e\u505a\u3002\u6709\u51e0\u79cd\u60c5\u51b5\uff08\u53ef\u80fd\u9700\u8981\u524d\u540e\u5bf9\u7167\u6765\u7406\u89e3\uff09\uff1a\n- \u7b49\u4e8e\u539f\u6570\uff1a\u5982\u679c\u6267\u884c\u5230\u8fd9\u91cc\uff0c\u5219\u4e0d\u4f1a\u51fa\u73b0\u8fde\u63a5\u64cd\u4f5c\u800c\u4f7f\u7528\u5907\u7528\u6808\u3002\u628a\u5b83\u4eec\u90fd\u653e\u5165\u5907\u7528\u6808\u4e2d\u5bf9\u6d88\uff0c\u7ed3\u675f\u5faa\u73af\u3002\n- \u8fde\u63a5\uff1a\u5982\u679c\u6267\u884c\u8fd9\u79cd\u64cd\u4f5c\uff0c\u53ea\u6709\u53ef\u80fd\u4e0a\u9762\u7684\u6570\u88ab\u653e\u5165\u5076\u6570\u6b21\u3002\u56e0\u6b64\u9884\u5148\u653e\u5165\u539f\u6570\uff0c\u53ef\u4ee5\u8ba9\u540e\u9762\u5076\u6570\u4e2a\u6570\u5bf9\u6d88\uff0c\u4e0d\u4f1a\u6709\u5f71\u54cd\u3002\u7ed3\u675f\u5faa\u73af\u3002\n- \u5220\u9664\uff1a\u5982\u679c\u5220\u9664\u540e\u6808\u4e3a\u7a7a\uff0c\u53ef\u4ee5\u628a\u539f\u6570\u653e\u5165\u5907\u7528\u6808\uff0c\u8fd9\u4e2a\u6808\u53d8\u6210\u65b0\u7684\u5907\u7528\u6808\uff0c\u7ed3\u675f\u5faa\u73af\u3002\u5426\u5219\u7ee7\u7eed\u3002\n- \u63d2\u5165\uff1a\u76f4\u63a5\u63d2\u5165\u3002\u6ce8\u610f\u63d2\u5165\u7684\u5730\u65b9\u8981\u548c\u4e4b\u524d\u4fdd\u6301\u4e00\u81f4\uff0c\u4e0d\u80fd\u653e\u5230\u522b\u5904\u3002  \n\u4e0b\u9762\u7684 hack \u6570\u636e\u4f1a\u8ba9\u7a0b\u5e8f\u628a\u5e26\u661f\u53f7\u7684 5 \u63d2\u5165\u539f\u6765\u662f 1 \u7684\u4f4d\u7f6e\uff0c\u628a\u5e26\u661f\u53f7\u7684 1 \u63d2\u5165\u539f\u6765\u662f 5 \u7684\u4f4d\u7f6e\uff08\u5982\u679c\u4f60\u7528\u201c\u6808\u201d\u5b9e\u73b0\u96c6\u5408\uff0c\u4e14\u63d2\u5165\u5230\u201c\u6808\u201d\u9876\u7684\u90a3\u4e2a\u6808\uff09\uff0c\u5728\u8fde\u63a5 3 \u4e4b\u524d\uff0c\u53d8\u6210 3 ~~5 5~~ 1\uff0c\u518d\u628a 2 \u9884\u5148\u653e\u5165\u5c31\u53d8\u6210 3 5 2 **5 1**\uff0c\u540e\u9762\u4e24\u6570\u65e0\u6cd5\u5bf9\u6d88\u3002\u5982\u679c\u548c\u4e4b\u524d\u4fdd\u6301\u4e00\u81f4\uff0c\u5219\u662f 3 ~~5 5~~ 5 \u548c 3 5 2 ~~5 5~~\u3002\n\n```plain\n1\n4 18 7\n4 1 6 7 3 5 2 5 1 5 1 3 2 7 4 5 1 6\n                  * *\n```\n\n\u7ec6\u8282\u7565\u591a\uff0c\u8981\u591a\u52a0\u6ce8\u610f\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntemplate<typename T>void rd(T&x){\n\tx=0;int f=1;char c=getchar();\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9'){x=x*10+c-48;c=getchar();}\n\tx*=f;\n}\nconst int N=310,M=2e6+10,K=N*2;\nint T,n,m,k,a[M];\nint o[M],p[M],b,c[K],c2[K];\nint s[N][2],t[N];\nint f[N],e[N],z,e2[N],z2;\nvoid ins(int x){\n\tif(t[x]==1)e2[f[x]=z2++]=x;\n\telse if(!t[x])e[f[x]=z++]=x;\n}\nvoid del(int x){\n\tif(t[x]==1)f[e2[--z2]]=f[x],e2[f[x]]=e2[z2];\n\telse if(!t[x])f[e[--z]]=f[x],e[f[x]]=e[z];\n}\nvoid ins(int y,int i){int x=a[i];del(y);o[i]=0;p[i]=y;c[x]=y;s[y][t[y]++]=x;ins(y);}\nvoid del(int y,int i){int x=a[i];del(y);o[i]=0;p[i]=y;c[x]=0;--t[y];ins(y);}\nvoid con(int y,int i){int x=a[i];del(y);o[i]=e[0];p[i]=y;c[x]=0;++b;s[y][0]=s[y][1];--t[y];ins(y);}\nint main(){\n\trd(T);\n\twhile(T--){\n\t\trd(n);rd(m);rd(k);b=m;\n\t\tmemset(c,0,(k+5)<<2);\n\t\tmemset(t,0,(n+5)<<2);\n\t\tmemset(f,0,(n+5)<<2);\n\t\tz=z2=0;\n\t\tfor(int i=n;i;--i)ins(i);\n\t\tfor(int i=1;i<=m;++i)rd(a[i]);\n\t\tfor(int i=1,j=1;i<=m;i=++j){\n\t\t\tint x=a[i];\n\t\t\tif(int y=c[x]){\n\t\t\t\tif(s[y][t[y]-1]==x)del(y,i);\n\t\t\t\telse con(y,i);\n\t\t\t}else if(z2||z>1)ins(z2?e2[z2-1]:e[z-1],i);\n\t\t\telse for(j=i+1;;++j){\n\t\t\t\tif(x==a[j]){int y=e[0];ins(y,i);del(y,j);break;}\n\t\t\t\tif(int y=c[a[j]]){\n\t\t\t\t\tif(s[y][t[y]-1]==a[j]){\n\t\t\t\t\t\tdel(y,j);\n\t\t\t\t\t\tif(!t[y]){ins(e[0],i);break;}\n\t\t\t\t\t\tc2[a[j]]=y;\n\t\t\t\t\t}else{con(y,j);ins(y,i);break;}\n\t\t\t\t}else ins(c2[a[j]],j);\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",b);\n\t\tfor(int i=1;i<=m;++i){\n\t\t\tif(o[i])printf(\"1 %d\\n2 %d %d\\n\",o[i],p[i],o[i]);\n\t\t\telse printf(\"1 %d\\n\",p[i]);\n\t\t}\n\t}\n}\n```",
        "postTime": 1670322156,
        "uid": 103171,
        "name": "jifbt",
        "ccfLevel": 6,
        "title": "\u3010\u9898\u89e3\u3011P8866 [NOIP2022] \u55b5\u4e86\u4e2a\u55b5"
    },
    {
        "content": "\u597d\u9898\uff0c\u4f46\u662f\u8d5b\u65f6\u6211\u6700\u591a\u53ea\u80fd\u62ff\u5230 $15 \\operatorname{pts}$ /kk\n\n~~\u867d\u7136\u4f46\u662f\uff0c\u8fd9\u9898\u653e NOIP T2 \u633a\u521b\u4eba\u7684\u3002~~\n\n------------\n\n\u9996\u5148\u8003\u8651 $k = 2n - 2$ \u7684\u60c5\u51b5\u3002\u4e0d\u96be\u53d1\u73b0\u8fd9\u73a9\u610f\u8ddf $2n$ \u5f88\u63a5\u8fd1\u4e14\u4e3a\u5076\u6570\u2014\u2014\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ef\u4ee5\u6293\u51fa $n - 1$ \u4e2a\u6808\uff0c\u6bcf\u4e2a\u81f3\u591a\u653e\u4e24\u4e2a\u5143\u7d20\uff0c\u5269\u4e0b\u4e00\u4e2a\u6808\u5907\u7528\u3002\n\n\u4ece\u8fd9\u4e2a\u89d2\u5ea6\u51fa\u53d1\uff0c\u6211\u4eec\u4e0d\u96be\u60f3\u5230\u4ee5\u4e0b\u505a\u6cd5\uff1a\n\n- \u628a $k$ \u79cd\u56fe\u6848\u4e24\u4e24\u914d\u5bf9\uff0c\u6784\u6210 $n - 1$ \u4e2a pair\u3002\n- \u53d6\u51fa\u5361\u724c\u65f6\uff0c\u82e5\u5f53\u524d\u56fe\u6848\u5728\u6808\u9876\uff0c\u5219\u76f4\u63a5\u6d88\u9664\uff1b\u82e5\u5f53\u524d\u56fe\u6848\u5728\u6808\u5e95\uff0c\u5148\u5c06\u8fd9\u5f20\u724c\u653e\u5230\u5907\u7528\u7684\u7a7a\u6808\u91cc\uff0c\u518d\u4f7f\u7528\u4e00\u6b21\u64cd\u4f5c $2$ \u6d88\u9664\uff1b\u5426\u5219\uff0c\u5c06\u5176\u653e\u5165\u5bf9\u5e94\u7684\u6808\u3002\n\n\u7531\u4e8e\u6bcf\u79cd\u56fe\u6848\u7684\u724c\u6709\u5076\u6570\u5f20\uff0c\u663e\u7136\u6700\u7ec8\u4f1a\u88ab\u6d88\u5b8c\u3002\n\n\u73b0\u5728\u6765\u7b97\u4e00\u4e0b\u64cd\u4f5c\u6b21\u6570\u3002\u7b2c\u4e00\u79cd\u64cd\u4f5c\u663e\u7136\u53ea\u6709\u6070\u597d $m$ \u6b21\uff0c\u7b2c\u4e8c\u79cd\u64cd\u4f5c\u81f3\u591a\u53ea\u6709 $\\frac{m}{2}$ \u6b21\uff0c\u5219 $m \\leq op \\leq \\frac{3m}{2}$\uff0c\u7b26\u5408\u8981\u6c42\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651 $k = 2n - 1$ \u7684\u60c5\u51b5\u3002\u8fd9\u4e24\u79cd\u60c5\u51b5\u7684\u533a\u522b\u662f\u4ec0\u4e48\u5462\uff1f\u2014\u2014\u53ef\u80fd\u5b58\u5728\u67d0\u4e2a\u65f6\u523b\uff0c\u6709 $n - 1$ \u4e2a\u6808\u90fd\u6709\u4e24\u79cd\u56fe\u6848\uff0c\u800c\u6211\u4eec\u6b63\u5728\u653e\u5165\u4e00\u4e2a\u65b0\u7684\u56fe\u6848\uff0c\u76f4\u63a5\u653e\u5165\u5907\u7528\u6808\u53ef\u80fd\u4f1a\u5bfc\u81f4\u540e\u9762\u65e0\u6cd5\u6309\u7167\u4e0a\u8ff0\u64cd\u4f5c\u8fdb\u884c\u4e0b\u53bb\u2026\u2026\n\n**tips\uff1a\u8fd9\u79cd\u65f6\u5019\u4e0d\u8981\u76f4\u63a5\u653e\u5f03\u539f\u6709\u601d\u8def\uff0c\u53ef\u4ee5\u8fdb\u884c\u4e00\u4e9b\u6253\u8865\u4e01\u7684\u5c1d\u8bd5\u3002**\n\n\u4eba\u7c7b\u667a\u6167\u5730\uff0c\u8003\u8651\u4ece\u63a5\u4e0b\u6765\u5c06\u8981\u653e\u5165\u7684\u5361\u724c\u4e2d\u627e\u51fa\u7b2c\u4e00\u5f20\u53ef\u4ee5\u5728\u67d0\u4e2a\u65f6\u523b\u88ab\u6d88\u6389\u7684\u724c\u5e76\u5c06\u5f53\u524d\u724c\u6682\u65f6\u7f6e\u4e8e\u90a3\u4e2a\u6808\u7684\u9876\u7aef\u3002\n\n\u90a3\u8fd9\u5f20\u724c\u5e94\u8be5\u6ee1\u8db3\u4ec0\u4e48\u6761\u4ef6\u5462\uff1f\u66f4\u52a0\u4eba\u7c7b\u667a\u6167\u5730\uff0c\u6211\u4eec\u60f3\u5230\u8fd9\u5f20\u724c\u9700\u8981\u6ee1\u8db3**\u5f53\u524d\u5728\u6808\u5e95**\uff0c\u56e0\u4e3a\u8fd9\u6837\u7684\u8bdd\u4e2d\u95f4\u9047\u5230\u7684\u5176\u4ed6\u724c\u8981\u4e48\u53ef\u4ee5\u88ab\u6d88\u6389\uff0c\u8981\u4e48\u56e0\u4e3a\u5076\u6570\u6b21\u64cd\u4f5c\u800c\u4e0d\u53d8\u3002\n\n\u8bbe\u6211\u4eec\u627e\u51fa\u7684\u8fd9\u5f20\u724c\u4e3a $p = a_k$\u3002\u5c06\u5f53\u524d\u724c $a_j$ \u653e\u5230 $p$ \u6240\u5728\u6808\u7684\u4e0a\u65b9\uff0c\u4e2d\u95f4\u7684\u8be5\u548b\u64cd\u4f5c\u548b\u64cd\u4f5c\uff0c\u6700\u540e\u628a $p$ \u653e\u5230\u5907\u7528\u6808\u91cc\u8ddf\u4e4b\u524d\u5728\u6808\u91cc\u7684 $p$ \u6d88\u6389\uff0c\u6b64\u540e\u6240\u6709\u6808\u5c31\u6062\u590d\u4e86 $k = 2n - 2$ \u7684\u60c5\u51b5\uff0c\u6309\u7167\u4e4b\u524d\u6240\u8bf4\u7684\u65b9\u6cd5\u505a\u4e0b\u53bb\u5373\u53ef\u3002\n\n\u4f46\u662f\u5f88\u5feb\u4f60\u5c31\u4f1a\u53d1\u73b0\u8fd9\u73a9\u610f\u5bc4\u4e86\uff0c\u56e0\u4e3a\u5728\u724c\u5806\u4e2d $(j, k)$ \u4e4b\u95f4\u5982\u679c\u9047\u5230\u4e86 $q$ \u6b64\u524d\u5bf9\u5e94\u7684\u6808\u9876 $q$ \u5c31\u4f1a\u6d88\u4e0d\u6389\u2026\u2026\n\n\u4e0d\u8fc7\u82e5 $q$ \u5728 $(j, k)$ \u95f4\u51fa\u73b0\u6b21\u6570\u662f\u5076\u6570\u770b\u4e0a\u53bb\u6ca1\u5565\u95ee\u9898\uff0c\u56e0\u4e3a\u4f60\u53ef\u4ee5\u628a\u5907\u7528\u6808\u5355\u72ec\u8ba9\u7ed9\u5b83\u7528\u4e8e\u6d88\u9664\u3002\u63a5\u4e0b\u6765\u8003\u8651\u5947\u6570\u7684\u60c5\u51b5\u3002\n\n\u4e3a\u4e86\u8ba9 $q$ \u53ef\u4ee5\u88ab\u6d88\u6389\uff0c\u4e0d\u8ba1\u540e\u679c\u5730\uff0c\u8003\u8651\u542f\u7528\u5907\u7528\u6808\uff0c\u628a $a_j$ \u5355\u72ec\u653e\u5230\u5907\u7528\u6808\u91cc\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u4e0d\u5f71\u54cd\u5176\u5b83\u9879\u7684\u524d\u63d0\u4e0b\u6d88\u6389 $(j, k)$ \u4e4b\u95f4\u7684 $q$ \u4e86\u3002\n\n\u73b0\u5728\u552f\u4e00\u7684\u95ee\u9898\u5c31\u662f\u5907\u7528\u6808\u88ab\u5360\u7528\u4e86\uff0c\u4f46\u6ce8\u610f\u5230\u5728\u6267\u884c\u5230 $k$ \u65f6\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u628a $p$ \u62ff\u53bb\u6d88\u6389\u539f\u6765\u90a3\u4e2a\u6808\u91cc\u7684 $p$\uff0c\u5219\u6211\u4eec\u6700\u7ec8\u53c8\u4f1a\u83b7\u5f97\u4e00\u4e2a\u65b0\u7684\u5907\u7528\u6808\uff0c\u6240\u4ee5\u5c31\u6ca1\u95ee\u9898\u4e86\u3002\n\n\u7efc\u4e0a\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\sum nm)$\uff08\u5f53\u7136\u53ef\u4ee5\u7cbe\u7ec6\u5b9e\u73b0\u505a\u5230 $O(\\sum (n + m))$\uff09\u3002\u6ce8\u610f\u7279\u5224 $n = 1$ \u7684\u60c5\u51b5\u3002\n\n\u7ec6\u8282\u7a0d\u591a\uff0c\u53ef\u4ee5\u53c2\u8003\u4e00\u4e0b\u4ee3\u7801\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <stdio.h>\n\nint ansop;\nint a[2000007], cnt[307], pos1[607], pos2[607], anstype[3000007], anss[3000007], anss1[3000007], anss2[3000007];\n\ninline int read(){\n\tint ans = 0;\n\tchar ch = getchar();\n\twhile (ch < '0' || ch > '9'){\n\t\tch = getchar();\n\t}\n\twhile (ch >= '0' && ch <= '9'){\n\t\tans = ans * 10 + (ch ^ 48);\n\t\tch = getchar();\n\t}\n\treturn ans;\n}\n\ninline void process1(int x){\n\tansop++;\n\tanstype[ansop] = 1;\n\tanss[ansop] = x;\n}\n\ninline void process2(int x, int y){\n\tansop++;\n\tanstype[ansop] = 2;\n\tanss1[ansop] = x;\n\tanss2[ansop] = y;\n}\n\nvoid write(int n){\n\tif (n >= 10) write(n / 10);\n\tputchar(n % 10 + '0');\n}\n\nint main(){\n\tint t = read();\n\tfor (register int i = 1; i <= t; i++){\n\t\tint n = read(), m = read(), k = read();\n\t\tansop = 0;\n\t\tfor (register int j = 1; j <= m; j++){\n\t\t\ta[j] = read();\n\t\t}\n\t\tif (n == 1){\n\t\t\tfor (register int j = 1; j <= m; j++){\n\t\t\t\tprocess1(a[j]);\n\t\t\t}\n\t\t} else {\n\t\t\tfor (register int j = 1; j <= n; j++){\n\t\t\t\tcnt[j] = 0;\n\t\t\t}\n\t\t\tfor (register int j = 1; j <= k; j++){\n\t\t\t\tpos1[j] = pos2[j] = 0;\n\t\t\t}\n\t\t\tfor (register int j = 1; j <= m; j++){\n\t\t\t\tif (pos1[a[j]] != 0 && pos2[a[j]] == cnt[pos1[a[j]]]){\n\t\t\t\t\tprocess1(pos1[a[j]]);\n\t\t\t\t\tcnt[pos1[a[j]]]--;\n\t\t\t\t\tpos1[a[j]] = 0;\n\t\t\t\t} else {\n\t\t\t\t\tint zero, zero_cnt = 0, one = -1;\n\t\t\t\t\tfor (register int x = 1; x <= n; x++){\n\t\t\t\t\t\tif (cnt[x] == 0){\n\t\t\t\t\t\t\tzero = x;\n\t\t\t\t\t\t\tzero_cnt++;\n\t\t\t\t\t\t} else if (cnt[x] == 1){\n\t\t\t\t\t\t\tone = x;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (pos1[a[j]] != 0 && pos2[a[j]] == 1){\n\t\t\t\t\t\tprocess1(zero);\n\t\t\t\t\t\tprocess2(pos1[a[j]], zero);\n\t\t\t\t\t\tcnt[pos1[a[j]]]--;\n\t\t\t\t\t\tfor (register int x = 1; x <= k; x++){\n\t\t\t\t\t\t\tif (x != a[j] && pos1[x] == pos1[a[j]]){\n\t\t\t\t\t\t\t\tpos2[x]--;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpos1[a[j]] = 0;\n\t\t\t\t\t} else if (zero_cnt > 1 || one != -1){\n\t\t\t\t\t\tint goal = zero_cnt > 1 ? zero : one;\n\t\t\t\t\t\tprocess1(goal);\n\t\t\t\t\t\tpos1[a[j]] = goal;\n\t\t\t\t\t\tpos2[a[j]] = ++cnt[goal];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tint pos, up;\n\t\t\t\t\t\tbool flag = false;\n\t\t\t\t\t\tfor (register int x = j + 1; x <= m; x++){\n\t\t\t\t\t\t\tif (pos1[a[x]] != 0 && pos2[a[x]] == 1){\n\t\t\t\t\t\t\t\tpos = x;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (register int x = 1; x <= k; x++){\n\t\t\t\t\t\t\tif (x != a[pos] && pos1[x] == pos1[a[pos]]){\n\t\t\t\t\t\t\t\tup = x;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (register int x = j + 1; x < pos; x++){\n\t\t\t\t\t\t\tif (a[x] == up) flag = !flag;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!flag){\n\t\t\t\t\t\t\tpos1[a[j]] = pos1[a[pos]];\n\t\t\t\t\t\t\tpos2[a[j]] = 0;\n\t\t\t\t\t\t\tpos1[up] = zero;\n\t\t\t\t\t\t\tpos2[up] = 0;\n\t\t\t\t\t\t\tfor (register int x = j; x < pos; x++){\n\t\t\t\t\t\t\t\tprocess1(pos1[a[x]]);\n\t\t\t\t\t\t\t\tif (pos2[a[x]] == 0){\n\t\t\t\t\t\t\t\t\tpos2[a[x]] = ++cnt[pos1[a[x]]];\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tpos2[a[x]] = 0;\n\t\t\t\t\t\t\t\t\tcnt[pos1[a[x]]]--;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpos1[up] = pos1[a[pos]];\n\t\t\t\t\t\t\tpos2[up] = 1;\n\t\t\t\t\t\t\tprocess1(zero);\n\t\t\t\t\t\t\tprocess2(pos1[a[pos]], zero);\n\t\t\t\t\t\t\tcnt[pos1[a[pos]]]--;\n\t\t\t\t\t\t\tpos2[a[pos]] = 0;\n\t\t\t\t\t\t\tif (pos2[a[j]] != 0) pos2[a[j]]--;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tprocess1(zero);\n\t\t\t\t\t\t\tpos1[a[j]] = zero;\n\t\t\t\t\t\t\tpos2[a[j]] = ++cnt[zero];\n\t\t\t\t\t\t\tfor (register int x = j + 1; x <= pos; x++){\n\t\t\t\t\t\t\t\tprocess1(pos1[a[x]]);\n\t\t\t\t\t\t\t\tif (pos2[a[x]] == 0){\n\t\t\t\t\t\t\t\t\tpos2[a[x]] = ++cnt[pos1[a[x]]];\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tpos2[a[x]] = 0;\n\t\t\t\t\t\t\t\t\tcnt[pos1[a[x]]]--;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (register int x = j; x <= pos; x++){\n\t\t\t\t\t\t\tif (pos2[a[x]] == 0) pos1[a[x]] = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tj = pos;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\twrite(ansop);\n\t\tputchar('\\n');\n\t\tfor (register int j = 1; j <= ansop; j++){\n\t\t\tif (anstype[j] == 1){\n\t\t\t\tputchar('1');\n\t\t\t\tputchar(' ');\n\t\t\t\twrite(anss[j]);\n\t\t\t} else {\n\t\t\t\tputchar('2');\n\t\t\t\tputchar(' ');\n\t\t\t\twrite(anss1[j]);\n\t\t\t\tputchar(' ');\n\t\t\t\twrite(anss2[j]);\n\t\t\t}\n\t\t\tputchar('\\n');\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1676348534,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P8866 \u3010[NOIP2022] \u55b5\u4e86\u4e2a\u55b5\u3011"
    },
    {
        "content": "\u60f3\u5230\u5c31\u5f88\u96be\u4e86\uff0c$O(n)$ \u7cbe\u7ec6\u5b9e\u73b0\u4e5f\u96be\u3002\n\n\u9996\u5148 $k=2n-2$\uff0c\u6211\u4eec\u60f3\u5230 [NOIP2020] \u79fb\u7403\u6e38\u620f \u7684\u7c7b\u4f3c\u505a\u6cd5\uff0c\u5c06\u4e24\u79cd\u989c\u8272\u7684\u724c\u653e\u5728\u4e00\u5806\u91cc\uff0c\u8fd9\u6837\u4f1a\u6709\u4e00\u4e2a\u7a7a\u5806\u3002\n\n\u52a0\u5165\u724c $x$ \u65f6\uff0c\u5f53\u5176\u6240\u5c5e\u5806\u5df2\u6709\u4e24\u5f20\u4e0d\u540c\u989c\u8272\u7684\u724c\uff08\u5426\u5219\u76f4\u63a5 1 \u64cd\u4f5c\u538b\u5165\uff09\u3002\n\n\u82e5 $x$ \u5728\u9876\u90e8\uff0c\u6211\u4eec 1 \u64cd\u4f5c\u538b\u5165\u5373\u53ef\u3002\n\n\u82e5 $x$ \u5728\u5e95\u90e8\uff0c\u6211\u4eec 1 \u64cd\u4f5c\u538b\u5165\u7a7a\u5806\uff0c\u7136\u540e 2 \u64cd\u4f5c\u4e24\u4e2a\u5806\u5e95\u6d88\u6389\u5373\u53ef\u3002\n\n\u8fd9\u6837\u6211\u4eec\u4fdd\u8bc1\u4e86\u724c\u5806\u5927\u5c0f $\\le 2$\uff0c\u6240\u4ee5\u4e0a\u8ff0\u60c5\u51b5\u5168\u77e3\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf\u62d3\u5c55\uff0c\u5f53\u4e24\u79cd\u60c5\u51b5\u5747\u53ef\u64cd\u4f5c\u65f6\uff0c\u4f18\u5148\u9009\u62e9\u5806\u9876\u62b5\u6d88\u3002\n\n\u8003\u8651\u63a8\u5e7f\u5230 $k=2n-1$\u3002\n\n\u53d1\u73b0\u7a7a\u5806\u7684\u56fa\u5b9a\u548c\u724c\u989c\u8272\u4e24\u4e24\u642d\u914d\u7684\u56fa\u5b9a\u662f\u975e\u5fc5\u8981\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u6682\u65f6\u4e0d\u6ee1\u8db3\u4e0a\u8ff0\u6027\u8d28\uff0c\u6765\u5904\u7406\u8fd9\u591a\u51fa\u6765\u7684\u4e00\u79cd\u989c\u8272\uff0c\u6700\u540e\u4e5f\u4e0d\u5fc5\u8fd8\u539f\u56de\u539f\u6765\u7684\u7a7a\u5806\u548c\u914d\u5bf9\u3002\n\n\u5f53\u4e00\u5f20\u724c $x$ \u52a0\u5165\u524d\u5c40\u9762\u65f6\u8fd9\u6837\u7684\uff1a\u4e00\u4e2a\u7a7a\u5806\uff0c\u5269\u4e0b\u6bcf\u5806\u4e24\u4e2a\uff0c\u5171 $2n-2$ \u79cd\u4e0e $x$ \u4e0d\u540c\u7684\u989c\u8272\u3002\u6211\u4eec\u5c31\u9700\u8981\u66f4\u9ad8\u5999\u7684\u64cd\u4f5c\u3002\n\n\u5982\u679c\u5728\u4e0b\u4e00\u6b21\u4f7f\u7528\u7a7a\u5806\u524d\u51fa\u73b0\u4e86\u53e6\u4e00\u5f20 $x$\uff0c\u5219\u6211\u4eec\u76f4\u63a5\u5c06\u8fd9\u4e24\u4e2a\u5728\u7a7a\u5806\u62b5\u6d88\u3002\n\n\u5426\u5219\u6211\u4eec\u627e\u5230\u4e0b\u4e00\u5f20\u4f7f\u7528\u7a7a\u5806\u6d88\u9664\u7684\u724c\uff0c\u8bb0\u4e3a\u989c\u8272 $y$\uff0c\u5979\u5f53\u524d\u5fc5\u7136\u662f\u67d0\u5806\u7684\u5e95\uff0c\u8bbe\u5176\u5806\u9876\u4e3a $z$\u3002\n\n\u82e5 $z$ \u5728\u603b\u724c\u5806\u5728 $(x,y)$ \u4e4b\u95f4\u51fa\u73b0\u4e86\u5076\u6570\u6b21\uff0c\u6211\u4eec\uff1a\n\n1. \u5c06 $x$ \u653e\u5728 $y$ \u6240\u5728\u5806\u9876\u3002\n\n2. \u6301\u7eed\u6309\u539f\u6765\u7684\u5957\u8def\u6d88\u9664\uff0c$z$ \u76f4\u63a5\u5728 $x$ \u4e0a\u65b9\u6d88\u9664\u3002\n\n3. $y$ \u901a\u8fc7\u5e95\u90e8\u6d88\u9664\u3002\n\n\u82e5\u51fa\u73b0\u4e86\u5947\u6570\u6b21\uff0c\u5219\u63a5\u4e0b\u6765\u7a7a\u5806\u4f1a\u6362\u4f4d\u7f6e\uff1a\n\n1. \u5c06 $x$ \u653e\u5728\u7a7a\u5806\u3002\n\n2. \u6301\u7eed\u6309\u539f\u6765\u7684\u5957\u8def\u6d88\u9664\u3002\n\n3. \u73b0\u5728 $y$ \u5806\u5df2\u7ecf\u6ca1\u6709 $z$ \u4e86\uff0c$y$ \u901a\u8fc7\u9876\u90e8\u6d88\u9664\u3002\n\n4. $y$ \u5806\u7a7a\u4e86\uff0c\u5c06\u7a7a\u5806\u8bbe\u4e3a\u8fd9\u4e2a\u5806\u3002\n\n\u8bb2\u5b8c\u4e86\uff0c$O(n)$ \u4ee3\u7801\u5b9e\u73b0\u975e\u5e38\u6709\u96be\u5ea6\uff08\u5bf9\u4e8e\u6211\u6765\u8bf4\uff09\u3002\n\n```cpp\n#define M 2000010\n#define N 303\nvector<pi> out;\nstruct node{\n\tint a[2],sz;\n\tvoid push(int x){\n\t\tif(sz && a[sz-1]==x) sz--;\n\t\telse a[sz++]=x;\n\t}\n\tvoid pop(){\n\t\tsz--;\n\t\tif(sz) a[0]=a[1];\n\t}\n\tint bot(){ return a[0]; }\n\tint top(){ return a[sz-1]; }\n}t[N];\nint n,m,k,tar,a[N],ta,pos[N<<1],pre[N<<1],p[M],cnt,L,R;\nbool ban;//for tar\nvoid ins(int x){\n\tif(pos[x]){\n\t\tassert(t[pos[x]].sz);\n\t\tif(t[pos[x]].top()==x){\n\t\t\tout.pb(0,pos[x]);\n\t\t\tt[pos[x]].push(x);\n\t\t}else if(t[pos[x]].bot()==x){\n\t\t\tassert(!ban);\n\t\t\tout.pb(0,tar);\n\t\t\tout.pb(pos[x],tar);\n\t\t\tt[pos[x]].pop();\n\t\t}else assert(0);\n\t\tif(t[pos[x]].sz==1) a[++ta]=pos[x];\n\t\tpos[x]=0;\n\t\tcnt--;\n\t}else{\n\t\tassert(ta);\n\t\tout.pb(0,a[ta]);\n\t\tt[a[ta]].push(x);\n\t\tpos[x]=a[ta];\n\t\tcnt++;\n\t\tif(t[a[ta]].sz==2) ta--;\n\t}\n}\nvoid work(){\n\tout.clear();\n\tcin>>n>>m>>k;\n\trep(i,1,m) cin>>p[i];\n\ttar=n;//empty\n\trep(i,1,n) t[i].sz=0;\n\tta=n-1;\n\tiota(a+1,a+n,1);\n\tfill(pos+1,pos+1+k,0);\n\tcnt=0;\n\tL=1;\n\tban=false;\n\tbool pan;\n\tint x,y,z,now;\n\twhile(L<=m){\n\t\tx=p[L];\n\t\tif(!pos[x] && cnt==2*n-2){\n\t\t\tassert(!ta);\n\t\t\tR=L+1;\n\t\t\twhile((y=p[R])!=p[L] && y==(z=t[now=pos[y]].top())){\n\t\t\t\tassert(now && t[now].sz==2);\n\t\t\t\tR++;\n\t\t\t}\n\t\t\tif(x==y){\n\t\t\t\tout.pb(0,tar);\n\t\t\t\tban=true;\n\t\t\t\trep(i,L+1,R-1) ins(p[i]);\n\t\t\t\tban=false;\n\t\t\t\tout.pb(0,tar);\n\t\t\t}else{\n\t\t\t\tpan=false;\n\t\t\t\trep(i,L+1,R-1) if(p[i]==z) pan^=1;\n\t\t\t\tif(pan){//odd\n\t\t\t\t\tout.pb(0,tar);\n\t\t\t\t\tban=true;\n\t\t\t\t\trep(i,L+1,R-1){\n\t\t\t\t\t\tif(p[i]==z){\n\t\t\t\t\t\t\tout.pb(0,now);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tins(p[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tban=false;\n\t\t\t\t\tout.pb(0,now);\n\t\t\t\t\tt[now].sz=0;\n\t\t\t\t\tpos[z]=0;\n\t\t\t\t\tpos[y]=0;\n\t\t\t\t\tpos[x]=tar;\n\t\t\t\t\tt[tar].push(x);\n\t\t\t\t\ta[++ta]=tar;\n\t\t\t\t\ttar=now;\n\t\t\t\t\tcnt--;\n\t\t\t\t}else{//even\n\t\t\t\t\tout.pb(0,now);\n\t\t\t\t\tban=true;//\u867d\u7136\u6b64\u65f6 tar \u662f\u7a7a\u7684\uff0c\u4f46\u786e\u5b9e\u6ca1\u6709 2 \u64cd\u4f5c\n\t\t\t\t\trep(i,L+1,R-1){\n\t\t\t\t\t\tif(p[i]==z){\n\t\t\t\t\t\t\tout.pb(0,now);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tins(p[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tban=false;\n\t\t\t\t\tout.pb(0,tar);\n\t\t\t\t\tout.pb(tar,now);\n\t\t\t\t\tt[now].pop();\n\t\t\t\t\tt[now].push(x);\n\t\t\t\t\tpos[y]=0;\n\t\t\t\t\tpos[x]=now;\n\t\t\t\t}\n\t\t\t}\n\t\t\tL=R+1;\n\t\t}else{\n\t\t\tins(x);\n\t\t\tL++;\n\t\t}\n\t}\n\tassert(!cnt);\n\tcout<<siz(out)<<\"\\n\";\n\tfor(auto i:out)\n\t\tif(i.fir) cout<<\"2 \"<<i.fir<<\" \"<<i.sec<<\"\\n\";\n\t\telse cout<<\"1 \"<<i.sec<<\"\\n\";\n}\n```",
        "postTime": 1671251441,
        "uid": 101868,
        "name": "I_am_Accepted",
        "ccfLevel": 0,
        "title": "P8866 [NOIP2022] \u55b5\u4e86\u4e2a\u55b5\uff08\u6784\u9020/\u5206\u8ba8\uff09"
    },
    {
        "content": "\u8003\u573a\u4e0a\u6302\u6210 30 \u5206\u4e86\uff0c\u5f88\u6c14\u3002\n\n\u8003\u8651\u90e8\u5206\u5206\u60c5\u51b5\u5373 $k=2n-2$\uff0c\u6b64\u65f6\u6211\u4eec\u9884\u7559\u51fa\u4e00\u4e2a\u7a7a\u6808\uff0c\u5269\u4e0b\u7684\u6808\u6bcf\u4e00\u4e2a\u6808\u5206\u914d\u4e24\u79cd\u989c\u8272\uff0c\u5982\u679c\u6240\u6709\u975e\u6808\u7684\u6808\u90fd\u6ee1\u4e86\uff0c\u90a3\u4e48\u6839\u636e\u9e3d\u5de2\u539f\u7406\u6808\u91cc\u7684\u6240\u6709\u5143\u7d20\u90fd\u4e0d\u91cd\u4e0d\u6f0f\uff0c\u5982\u679c\u662f\u538b\u5728\u5e95\u4e0b\u7684\u5c31\u8fdb\u7a7a\u6808\u7136\u540e 2 \u64cd\u4f5c\u6d88\u9664\uff0c\u5426\u5219\u5c31\u538b\u5230\u5b83\u6240\u5728\u7684\u6808\u4e0a\u9762\u3002\n\n\u5bb9\u6613\u53d1\u73b0\uff0c\u8fd9\u6837\u64cd\u4f5c\u7684\u8bdd\u6808\u6700\u5927\u5927\u5c0f\u4e0d\u8d85\u8fc7 2\u3002\n\n\u8003\u8651\u628a\u505a\u6cd5\u6269\u5c55\u5230 $k=2n-1$\uff0c\u8fd8\u662f\u4e00\u6837\u9884\u7559\u7a7a\u6808\uff0c\u4f46\u662f\u989c\u8272\u591a\u4e86\u4e00\u4e2a\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ef\u80fd\u4f1a\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\uff1a\u9664\u4e86\u7a7a\u6808\u5176\u4ed6\u6808\u90fd\u662f\u6ee1\u7684\uff0c\u6b64\u65f6\u8fd8\u6709\u4e00\u79cd\u989c\u8272\u6ca1\u6709\u9009\u4e2d\u8fc7\uff0c\u6211\u4eec\u5e94\u8be5\u600e\u4e48\u529e\u5462\uff1f\n\n\u6211\u4eec\u628a\u6808\u5212\u5206\u6210\u4e24\u79cd\uff0c\u7b2c\u4e00\u79cd\u662f\u4e0b\u9762\u7684\u5148\u88ab\u6d88\u6389\uff0c\u7b2c\u4e8c\u79cd\u662f\u4e0a\u9762\u7684\u5148\u88ab\u6d88\u6389\u3002\n\n\u5982\u679c\u6709\u6808\u5c5e\u7b2c\u4e00\u79cd\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u628a\u8fd9\u4e2a\u989c\u8272\u53e0\u4e0a\u53bb\uff0c\u56e0\u4e3a\u5148\u6d88\u4e0b\u9762\u7684\uff0c\u4e0b\u9762\u7684\u6d88\u6389\u540e\u8fd9\u4e2a\u6808\u53c8\u4f1a\u53d8\u6210\u5927\u5c0f\u4e3a 2 \u7684\u6808\u3002\n\n\u5982\u679c\u6240\u6709\u6808\u90fd\u5c5e\u7b2c\u4e8c\u79cd\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u628a\u5f53\u524d\u5143\u7d20\u4e22\u8fdb\u7a7a\u6808\u91cc\uff0c\u7136\u540e\u627e\u5230\u6240\u6709\u6808\u4e2d\u6808\u5e95\u6700\u5148\u88ab\u6d88\u6389\u7684\u6808\uff0c\u94a6\u70b9\u4ed6\u4e3a\u7a7a\u6808\u3002\n\n\u4e3a\u4ec0\u4e48\uff1f\n\n\u6bd4\u8f83\u663e\u7136\uff0c\u63a5\u4e0b\u6765\u5728\u7a7a\u6808\u51fa\u73b0\u4e4b\u524d\u90fd\u4e0d\u4f1a\u7528\u5230\u7a7a\u6808\uff0c\u5982\u679c\u7528\u5230\u4e86\u7a7a\u6808\u5c31\u4f1a\u5f52\u5230\u5230\u7b2c\u4e00\u79cd\u53bb\u3002\n\n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\uff0cCCF \u600e\u4e48\u5929\u5929\u51fa\u8fd9\u79cd\u7b54\u8fa9\u6a21\u62df\u9898\u554a\u3002",
        "postTime": 1670322378,
        "uid": 679749,
        "name": "EastSnowLotus",
        "ccfLevel": 0,
        "title": "\u7b54\u8fa9\u9898\u50bb\u903c\u624d\u5199"
    },
    {
        "content": "\u7b80\u5355\u8bb2\u4e00\u4e0b\u7b2c\u4e8c\u9898\u7684\u601d\u8def\u3002\u8003\u8651 $k=2n-2$ \u600e\u4e48\u505a\uff0c\u6211\u4eec\u5c06 $2\\times i-1$ \u548c $2\\times i$ \u90fd\u653e\u8fdb\u7b2c $i$ \u53f7\u6808\uff0c\u5269\u4f59\u7684\u6808\u4f5c\u4e3a\u8f85\u52a9\u6808\uff0c\u7528\u4e8e\u6d88\u9664\u5bf9\u5e94\u6808\u7684\u6808\u5e95\u5143\u7d20\u3002\n\n---\n\n\u90a3\u4e48\u6211\u4eec\u600e\u4e48\u505a $k=2n-1$\uff0c\u591a\u51fa\u7684\u4e00\u79cd\u989c\u8272\u6211\u4eec\u5c06\u5176\u8bb0\u4f5c\u7279\u6b8a\u7684\u989c\u8272\uff0c\u5f53\u6211\u4eec\u9700\u8981\u628a\u8be5\u7279\u6b8a\u989c\u8272\u4ece\u724c\u5806\u6254\u8fdb\u6808\u91cc\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5206\u60c5\u51b5\u8ba8\u8bba\u3002\n\n\u9996\u5148\uff0c\u6309\u7167\u6211\u4eec\u4e4b\u524d\u7684\u7b56\u7565\uff0c\u975e\u8f85\u52a9\u6808\u7684\u6808\u5185\u5143\u7d20\u5728\u4efb\u610f\u65f6\u523b\u662f\u4e0d\u591a\u4e8e\u4e24\u4e2a\u7684\u3002\n\n\u6211\u4eec\u8003\u8651\u8be5\u989c\u8272\u548c\u4e0b\u4e00\u4e2a\u8be5\u989c\u8272\u5143\u7d20\u4e4b\u95f4\u7684\u5143\u7d20\uff0c\u5982\u679c\u8fd9\u4e9b\u5143\u7d20\u5b58\u5728\u4e00\u4e2a\u662f\u7528\u4e8e\u5f39\u51fa\u6808\u5e95\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u8fd9\u4e2a\u7279\u6b8a\u5143\u7d20\u6254\u8fdb\u8fd9\u4e2a\u7528\u4e8e\u5f39\u51fa\u6808\u5e95\u7684\u6808\u5185\uff0c\u5e76\u628a\u7279\u6b8a\u989c\u8272\u8bbe\u7f6e\u4e3a\u7528\u4e8e\u5f39\u51fa\u6808\u5e95\u5143\u7d20\u7684\u989c\u8272\u3002\n\n\u5982\u679c\u4e0d\u5b58\u5728\u7528\u4e8e\u5f39\u51fa\u6808\u5e95\u7684\u5143\u7d20\uff0c\u90a3\u4e48\u76f4\u63a5\u628a\u8fd9\u4e24\u4e2a\u7279\u6b8a\u989c\u8272\u6254\u8fdb\u8f85\u52a9\u6808\u5c31\u597d\u4e86\u3002\n\n\u4ee3\u7801\u5b9e\u73b0\u4e0d\u96be\uff0c\u7ec6\u8282\u7565\u591a\u3002",
        "postTime": 1669446707,
        "uid": 183026,
        "name": "Cocoly1990",
        "ccfLevel": 0,
        "title": "NOIP 2022 \u55b5\u4e86\u4e2a\u55b5 \u9898\u89e3\u62a5\u544a\u3002"
    }
]
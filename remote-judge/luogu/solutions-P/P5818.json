[
    {
        "content": "\u5230\u8fd9\u91cc\u6b3a\u8d1f\u8001\u5e74\u9000\u5f79\u9009\u624b $\\to$ [`George1123`](https://www.cnblogs.com/George1123/p/14178146.html)\n\n---\n\n## \u9898\u9762\n\n> [JSOI2011 \u540c\u5206\u5f02\u6784\u4f53\u8ba1\u6570](https://www.luogu.com.cn/problem/P5818)\n\n> \u6c42\u6709\u591a\u5c11\u4e2a\u672c\u8d28\u4e0d\u540c\u7684\u65e0\u5411\u56fe\u57fa\u73af\u6811\uff0c\u6709 $n$ \u4e2a\u70b9\u4e14\u73af\u4e0a\u7684\u70b9\u6570 $\\le m$\u3002\u7b54\u6848\u5bf9 $p$ \u53d6\u6a21\u3002\n\n> \u6570\u636e\u8303\u56f4\uff1a$3\\le n\\le 1000$\uff0c$3\\le m\\le 50$\uff0c$10^4\\le p\\le 2\\times 10^9$\u3002\n\n---\n\n## \u9898\u89e3\n\n\u8bbe $t(x)$ \u4e3a\u6839\u8282\u70b9\u5b50\u8282\u70b9\u6570 $\\le 2$\uff0c\u6240\u6709\u8282\u70b9\u5b50\u8282\u70b9\u6570 $\\le 3$ \u7684\u672c\u8d28\u4e0d\u540c\u65e0\u6807\u53f7\u6709\u6839\u6811\u4e2a\u6570\u3002\n\n\u8fd9\u4e2a\u4e1c\u897f\u4e0d\u9700\u8981\u591a\u9879\u5f0f\uff0c\u76f4\u63a5 `Burnside` \u5b9a\u7406\u7136\u540e `dp` \u5373\u53ef\uff0c\u53c2\u8003 [\u70f7\u57fa\u8ba1\u6570 \u52a0\u5f3a\u7248](https://loj.ac/p/6269)\u3002\n\n\u7136\u540e\u679a\u4e3e\u73af\u957f\uff0c\u8bbe\u4e3a $k$\uff0c\u8bbe\u5f53\u524d\u7b54\u6848\u591a\u9879\u5f0f\u4e3a $\\frac{f(x)}{2k}$\u3002\n\n\u5229\u7528 `Burnside` \u5b9a\u7406\uff0c\u8003\u8651 $G$ \u7684\u5143\u7d20\uff1a\n\n1. \u4e0d\u52a8\uff0c\u5171 $1$ \u79cd\u3002$f(x)\\leftarrow t(x)^k$\u3002\n\n2. \u7ffb\u8f6c\uff0c\u5171 $k$ \u79cd\uff08\u5373\u73af\u4e0d\u8003\u8651\u5916\u5411\u6811\u7684\u5bf9\u79f0\u8f74\u4e2a\u6570\uff0c\u60f3\u8c61\u4e00\u4e0b\u7ffb\u8f6c\u540e\u7684\u7f6e\u6362\u73af\u6570\u5373\u53ef\uff09\u3002\n    - \u5047\u8bbe $k$ \u662f\u5947\u6570 $f(x)\\leftarrow t(x^2)^{\\lfloor k/2\\rfloor}t(x)$\u3002\n    - \u5047\u8bbe $k$ \u662f\u5076\u6570 $f(x)\\leftarrow \\frac{1}{2}(t(x^2)^{k/2}+t(x^2)^{k/2-1}t(x)^2)$\u3002\n\n3. \u65cb\u8f6c\uff0c\u5171 $k-1$ \u79cd\u3002\u8bbe\u65cb\u8f6c\u8282\u4e3a $d$\uff0c\u8bbe $g=\\gcd(d,k)$\uff0c$f(x)\\leftarrow t(x^{k/g})^{g}$\u3002\n\n\n\n$n,m$ \u5f88\u5c0f\uff0c\u8fd9\u90e8\u5206\u4e0d\u7528\u591a\u9879\u5f0f\u4e5f\u53ef\u4ee5\u5b9e\u73b0\uff1a\n\n$\\Theta(n^2 m)$ \u66b4\u529b\u5377\u79ef\u9884\u5904\u7406\u51fa $t(x)^a$\u3002\n\n\u4e0a\u9762\u7684 $t(x^s)^a[x^n]=t(x)^a[x^{n/s}]$\uff0c\u4e5f\u53ef\u4ee5\u6c42\u4e86\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n^2 m+m^2\\log m)$\u3002\n\n---\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef double db;\n#define x first\n#define y second\n#define bg begin()\n#define ed end()\n#define pb push_back\n#define mp make_pair\n#define sz(a) int((a).size())\n#define R(i,n) for(int i(0);i<(n);++i)\n#define L(i,n) for(int i((n)-1);i>=0;--i)\nconst int iinf=0x3f3f3f3f;\nconst ll linf=0x3f3f3f3f3f3f3f3f;\n\n//Data\nconst int N=1001,M=51;\nint n,m,mod,f[N],g[N],t[N],p[M][N];\n\n//Math\nint& fmod(int &x){return x+=x>>31&mod;}\nint gcd(int a,int b){return a?gcd(b%a,a):b;}\nint mypow(int a,int x=mod-2,int res=1){\n    for(;x;x>>=1,a=1ll*a*a%mod)\n        (x&1)&&(res=1ll*res*a%mod);\n    return res;\n}\n\n//Main\nint main(){\n    ios::sync_with_stdio(false);\n    cin.tie(0),cout.tie(0);\n    cin>>n>>m>>mod,f[0]=p[0][0]=1;\n    const int i6=mypow(6),i2=mypow(2);\n    for(int i=1;i<=n;i++){\n        R(a,i)  g[i]=(1ll*f[a]*f[i-1-a]+g[i])%mod;\n        R(a,i)  f[i]=(1ll*f[a]*g[i-a]+f[i])%mod;\n        for(int a=0;(a<<1)<i;a++)\n            f[i]=(3ll*f[a]%mod*f[i-1-(a<<1)]+f[i])%mod;\n        if((i-1)%3==0) f[i]=(2ll*f[(i-1)/3]+f[i])%mod;\n        f[i]=1ll*f[i]*i6%mod,t[i]=g[i];\n        if(i&1) t[i]=(f[(i-1)>>1]+t[i])%mod;\n        t[i]=1ll*t[i]*i2%mod;\n        // cout<<\"i=\"<<i<<\" t=\"<<t[i]<<'\\n';\n    }\n    R(k,m)R(i,n+1)R(j,n+1-i)\n        p[k+1][i+j]=(1ll*p[k][i]*t[j]+p[k+1][i+j])%mod;\n    int ns=0;\n    for(int k=3;k<=m;k++){\n        int res=p[k][n]; // cout<<res<<'\\n';\n        if(k&1) for(int a=0;(a<<1)<=n;a++)\n            res=(1ll*k*p[k>>1][a]%mod*t[n-(a<<1)]+res)%mod;\n        else {\n            if(~n&1) res=(1ll*(k>>1)*p[k>>1][n>>1]+res)%mod;\n            for(int a=0;(a<<1)<=n;a++)\n                res=(1ll*(k>>1)*p[(k>>1)-1][a]%mod\n                    *p[2][n-(a<<1)]+res)%mod;\n        }\n        for(int d=1,G;d<k;d++)if(n%(k/(G=gcd(d,k)))==0)\n            res=(0ll+p[G][n/(k/G)]+res)%mod;\n        ns=(1ll*res*mypow(k<<1)+ns)%mod;\n    }\n    cout<<ns<<'\\n';\n    return 0;\n}\n```\n\n---\n\n**\u795d\u5927\u5bb6\u5b66\u4e60\u6109\u5feb\uff01**",
        "postTime": 1608701863,
        "uid": 118365,
        "name": "George1123",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5818 \u3010[JSOI2011]\u540c\u5206\u5f02\u6784\u4f53\u8ba1\u6570\u3011"
    }
]
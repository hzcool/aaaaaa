[
    {
        "content": "~~\u4f5c\u4e3a\u5229\u7528\u6211\u975e\u6545\u610f\u641e\u51fa\u6765\u7684 bug \u5f97\u5230 O(n) \u7206\u6807\u7b97\u6cd5\u7684sb\u89c9\u5f97\u5199\u4e00\u53d1\u8fd9\u9053\u9898\u9898\u89e3\u5f88\u91cd\u8981~~\n\n\u6211\u4eec\u9996\u5148\u8003\u8651\u8fd9\u9053\u9898\u7684\u4ee3\u4ef7\u8ba1\u7b97\u65b9\u5f0f\uff0c\u901a\u8fc7\u7b80\u5355\u5316\u7b80\u53ef\u5f97\u5176\u5b9e\u6211\u4eec\u53ea\u8981\u4fdd\u8bc1\u603b\u6b21\u6570 $\\le n+300$ \u5373\u53ef\u5f97\u5230 $100$ \u5206\u7684\u5dee\u6210\u7ee9\u3002\n\n\u8fdb\u4e00\u6b65\u5206\u6790\u53d1\u73b0\uff0c\u5982\u679c\u6211\u4eec\u80fd\u6c42\u51fa\u6700\u5c0f\u503c\u53ca\u5176\u6240\u5728\u7684\u4f4d\u7f6e\uff0c\u90a3\u4e48\u6211\u4eec\u5c06\u53ef\u4ee5\u7528 $n$ \u6b21\u64cd\u4f5c\u5f97\u5230\u6574\u4e2a\u5e8f\u5217\u3002\n\n\u987a\u7740\u8fd9\u4e2a\u65b9\u5411\uff0c\u6211\u4eec\u8003\u8651\u7528 $300$ \u6b21\u64cd\u4f5c\u5f97\u51fa\u8fd9\u4e2a\u4f4d\u7f6e\u3002\n\n\u6211\u4eec\u5206\u6790 $300$ \u7684\u610f\u4e49\uff0c\u53d1\u73b0\u662f $\\log n \\sim \\log^2 n$ \u4e4b\u95f4\uff1b\u7531\u4e8e\u6211\u4eec\u4ec5\u9700\u8981\u627e\u51fa\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u8fd9\u5f88\u9002\u5408\u6211\u4eec\u5b66\u8fc7\u7684\u4e8c\u5206/\u4e09\u5206\u7b97\u6cd5\uff1b\n\n\u4e8e\u662f\u6211\u4eec\u8003\u8651\u6539\u7248\u4e09\u5206\uff1a\n\n\u5047\u8bbe\u6709\u4e00\u6bb5\u533a\u95f4 $[l,r]$\uff0c\u5176\u4e09\u5206\u70b9\u662f $s1,s2$\uff0c\u90a3\u4e48\u6211\u4eec\u901a\u8fc7\u6bd4\u8f83 `query(l,s2)-query(l,s1-1)` \u4e0e `query(s1,r)-query(s2+1,r)` \u7684\u5927\u5c0f\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\uff1a\n\n- \u5982\u679c\u6700\u5c0f\u503c\u5728 $[s1,s2]$ \u4e2d\uff0c\u90a3\u4e48\u8fd9\u4e24\u4e2a\u503c\u5fc5\u5b9a\u4e0d\u53ef\u80fd\u76f8\u7b49\uff1b\n\n- \u5982\u679c\u6700\u5c0f\u503c\u5728 $[l,s1)$ \u4e2d\uff0c\u90a3\u4e48\u7b2c\u4e00\u4e2a\u503c\u5fc5\u5b9a\u4e0d\u53ef\u80fd\u6bd4\u7b2c\u4e8c\u4e2a\u503c\u5927\uff1b\n\n- \u5982\u679c\u6700\u5c0f\u503c\u5728 $(s2,r]$ \u4e2d\uff0c\u90a3\u4e48\u7b2c\u4e8c\u4e2a\u503c\u5fc5\u5b9a\u4e0d\u53ef\u80fd\u6bd4\u7b2c\u4e00\u4e2a\u503c\u5927\uff1b\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e24\u4e2a\u503c\u7684\u5173\u7cfb\uff0c\u6392\u9664\u6389\u5f53\u524d\u7ea6 $\\frac{1}{3}$ \u7684\u7b54\u6848\uff1b\n\n\u5f53\u6700\u540e\u53ea\u5269\u4e0b $1 \\sim 2$ \u4e2a\u503c\u65f6\uff0c\u6211\u4eec\u76f4\u63a5\u7528 `get` \u5f97\u5230\u4ed6\u4eec\u7684\u503c\u5373\u53ef\uff0c\u7136\u540e\u95ee\u4e00\u904d `query(i,x)/query(x,i)`\uff0c\u505a\u4e00\u904d\u5dee\u5206\u5373\u53ef\uff08$x$ \u662f\u6700\u5c0f\u503c\u4f4d\u7f6e\uff09\uff1b\n\n\u300c\u6b38\uff0c\u4f60\u8bf4\u8fd9\u9898\u4e00\u5f00\u59cb\u6709\u4ec0\u4e48 bug \u80fd\u8ba9\u4f60O(n)\u8fc7\u554a\u300d\n\n\u201cemm\u2026\u2026\u5c31\u662f\u4f60\u53ef\u4ee5\u8be2\u95ee `query(0,i)` \uff0c\u7136\u540e\u5dee\u5206\u5c31\u53ef\u4ee5\u8fc5\u901f\u89e3\u51b3\u5566\u201d\n\n\u300c\u6b38\uff0c\u90a3\u4f60\u8bf4\u51fa\u9898\u4eba\u662f\u4e0d\u5c0f\u5fc3\u8fd8\u662f\u6545\u610f\u7684\u554a\u300d\n\n\u201c\u2026\u591a\u534a\u8fd8\u662f\u51fa\u9898\u4eba\u7684\u5b89\u6392\u5427\u3002\u201d\n\n~~\u68a6\u5e7b\u8054\u52a8~~\uff08\u5927\u96fe\n\nCode\uff1a\n\n```cpp\n# include <cstdint>\n# include <vector>\n# include <algorithm>\n# include <stdio.h>\n# define ui uint32_t\n# define ull uint64_t\nui ok1[1000010],ok2[1000010],f[1000010],totf;\nui a[1000010];\null an[1000010];\null q[1000010];\nui remain=301;\nint m,tot=0;\null query(int l,int r);\nui get(int x);\nint sr()\n{\n\tint i,j;\n\ttotf=0;\n\ttot++;\n\tint bj=0;\n\tfor(i=1;i<=m;i++)\n\t{\n\t\tif(!ok1[i])\n\t\t{\n\t\t\ttotf++;\n\t\t\tf[totf]=i;\n\t\t}\n\t}\n\tif(totf<=2)\n\t{\n\t\tfor(i=1;i<=totf;i++)\n\t\t{\n\t\t\ta[i]=get(f[i]);\n\t\t\tan[f[i]]=(ull)a[i];\n\t\t}\n\t\tstd::sort(a+1,a+totf+1);\n\t\tfor(i=1;i<=totf;i++)\n\t\t{\n\t\t\tif(an[f[i]]==(ull)a[1])\n\t\t\t\treturn f[i];\n\t\t}\n\t\treturn 0;\n\t}\n\telse\n\t{\n\t\tint mi=totf/3;\n\t\tint s1=1+mi;\n\t\tint s2=totf-mi;\n\t\tull an1=query(1,f[s2])-query(1,f[s1]-1);\n\t\tull an2=query(f[s1],m)-query(f[s2]+1,m);\n\t\tremain-=4;\n\t\tif(an1==an2)\n\t\t{\n\t\t\tfor(i=s1;i<=s2;i++)\n\t\t\t\tok1[f[i]]=1;\n\t\t\treturn sr();\n\t\t}\n\t\tif(an1>an2)\n\t\t{\n\t\t\tfor(i=1;i<s1;i++)\n\t\t\t\tok1[f[i]]=1;\n\t\t\treturn sr();\n\t\t}\n\t\tif(an1<an2)\n\t\t{\n\t\t\tfor(i=s2+1;i<=totf;i++)\n\t\t\t\tok1[f[i]]=1;\n\t\t\treturn sr();\n\t\t}\n\t}\n\treturn sr();\n}\nstd::vector< ui > recover(int n)\n{\n\tm=n;\n\tint i,j,x,y;\n\tx=sr();\n\tfor(i=x+1;i<=n;i++)\n\t{\n\t\tq[i]=query(x,i);\n\t\tan[i]=q[i]-q[i-1];\n\t}\n\tfor(i=x-1;i>=1;i--)\n\t{\n\t\tq[i]=query(i,x);\n\t\tan[i]=q[i]-q[i+1];\n\t}\n\tstd::vector< ui > vec;\n\tfor(i=1;i<=n;i++)\n\t\tvec.push_back((ui)an[i]);\n\treturn vec;\n}\n\n```\n\n",
        "postTime": 1644722881,
        "uid": 559616,
        "name": "\u20ac\u20ac\u00a3",
        "ccfLevel": 0,
        "title": "P8150 \u518d\u4f1a | Sayounara \u9898\u89e3"
    }
]
[
    {
        "content": "# B3716 \u5206\u89e3\u8d28\u56e0\u5b50 3\r\n\r\n## Analysis\r\n\r\n\u8003\u8651\u4e00\u4e2a\u6570 $n$ \u7684\u8d28\u56e0\u5b50\u53ea\u6709 $O(\\log n)$ \u4e2a\u3002\u5728\u5206\u89e3\u8d28\u56e0\u5b50\u65f6\uff0c\u5982\u679c\u77e5\u9053\u4e86\u6bcf\u4e2a\u6570\u7684\u6700\u5c0f\u8d28\u56e0\u5b50\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7\u4e00\u8def\u9664\u6389\u6700\u5c0f\u8d28\u56e0\u5b50\u5b8c\u6210\u5206\u89e3\u3002\u5bb9\u6613\u60f3\u5230\u5728\u7ebf\u6027\u7b5b\u7684\u540c\u65f6\u6c42\u51fa\u6bcf\u4e2a\u6570\u7684\u6700\u5c0f\u8d28\u56e0\u5b50\u3002\r\n\r\n**\u5f15\u7406**\uff1a\u5728\u6b27\u62c9\u7b5b\u65f6\uff0c\u88ab $i \\times p$\uff08\u5176\u4e2d $p$ \u662f\u8d28\u6570\uff09\u7b5b\u6389\u7684\u5408\u6570 $k$ \u7684\u6700\u5c0f\u8d28\u56e0\u5b50\u5c31\u662f $p$\u3002\r\n\r\n**\u8bc1\u660e**\uff1a\u5bb9\u6613\u6ce8\u610f\u5230 $i$ \u4e2d\u4e0d\u542b\u5c0f\u4e8e $p$ \u7684\u8d28\u56e0\u5b50\uff08\u53cd\u8bc1\u6cd5\uff0c\u5047\u8bbe $q \\mid i$ \u4e14 $q < p$\uff0c\u5219\u5f53\u679a\u4e3e\u5230\u8d28\u6570 $q$ \u65f6\uff0c$i \\bmod q = 0$ \u6210\u7acb\uff0c`break` \u6761\u4ef6\u6210\u7acb\uff0c\u5219\u4e0d\u4f1a\u679a\u4e3e\u5230 $p$\uff0c\u4e8e\u662f $k$ \u4e0d\u662f\u88ab $i \\times p$ \u7b5b\u6389\u7684\uff09\u3002\u800c $k = i \\times p$\uff0c\u4e8e\u662f $p$ \u5c31\u662f $k$ \u7684\u6700\u5c0f\u8d28\u56e0\u5b50\u3002\r\n\r\n\u4e8e\u662f\u5728\u6b27\u62c9\u7b5b\u65f6\u7ef4\u62a4\u51fa\u6700\u5c0f\u8d28\u56e0\u5b50\uff0c\u628a $n$ \u4e0d\u65ad\u9664\u5f53\u524d\u7684\u6700\u5c0f\u8d28\u56e0\u5b50\u5373\u53ef\u5b8c\u6210\u8d28\u56e0\u5b50\u5206\u89e3\u3002\r\n\r\n\u9884\u5904\u7406\u590d\u6742\u5ea6 $O(n)$\uff0c\u6bcf\u6b21\u5206\u89e3\u4e0d\u4f1a\u6709\u65e0\u6548\u8bd5\u9664\uff0c\u590d\u6742\u5ea6 $O(\\mathrm d (n))$\uff0c\u4e8e\u662f\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n + T \\mathrm d(n))$\uff0c\u5176\u4e2d $\\mathrm d(n)$ \u8868\u793a $n$ \u7684\u8d28\u56e0\u5b50\u4e2a\u6570\uff0c\u4e0d\u4f1a\u8d85\u8fc7 $\\log_2 n$\u3002\r\n\r\n## Code\r\n\r\n```cpp\r\n#include <bitset>\r\n#include <vector>\r\n#include <iostream>\r\n#include <algorithm>\r\n\r\nconst int maxn = 100000008;\r\n\r\nstd::vector<int> prm, pre;  // pre is the min-factor array.\r\nbool np[maxn];\r\n\r\nvoid getPrime(const int N = 100000000) {\r\n  pre.resize(N + 1);\r\n  for (int i = 2; i <= N; ++i) {\r\n    if (!np[i]) {\r\n      prm.push_back(i); pre[i] = i;\r\n    }\r\n    for (auto p : prm) if (i * p <= N) {\r\n      int k = i * p;\r\n      np[k] = true;\r\n      pre[k] = p;\r\n      if (i % p == 0) break;\r\n    } else break;\r\n  }\r\n}\r\n\r\nint main() {\r\n  std::ios::sync_with_stdio(false);\r\n  std::cin.tie(nullptr);\r\n  getPrime();\r\n  int T, n;\r\n  for (std::cin >> T; T; --T) {\r\n    std::cin >> n;\r\n    int ans = 0;\r\n    while (n != 1) {\r\n      ans ^= pre[n];\r\n      n /= pre[n];\r\n    }\r\n    std::cout << ans << '\\n';\r\n  }\r\n}\r\n```",
        "postTime": 1525141328,
        "uid": 65363,
        "name": "\u4e00\u6276\u82cf\u4e00",
        "ccfLevel": 7,
        "title": "B3716 \u5206\u89e3\u8d28\u56e0\u5b50 3"
    },
    {
        "content": "## \u4e00\u9053\u9884\u5904\u7406\u5c31\u884c\u7684\u9898\n\n\n------------\n\u8fd9\u9053\u9898\u4e00\u770b\u611f\u89c9\u5f88\u7b80\u5355\uff0c\u5b9e\u9645\u4e0a\u6b63\u5e38\u7684\u66b4\u529b\u627e\u8fc7\u4e0d\u53bb\uff0c\u56e0\u4e3a\u6709\u8fd9\u53e5\u8bdd\uff1a**\u5bf9\u4e8e\u5168\u90e8\u7684\u6d4b\u8bd5\u70b9\uff0c\u4fdd\u8bc1 $1 \\leq T \\leq 5 \\times 10^5$\uff0c$2 \\leq n \\leq 10^8$**  \n\n\n\u6570\u636e\u65e2\u7136\u8fd9\u4e48\u5927\uff0c\u90a3\u4e48\u7b2c\u4e00\u65f6\u95f4\u60f3\u5230\u7684\u80af\u5b9a\u662f\u9884\u5904\u7406\u4e86\u554a\u3002\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u6b27\u62c9\u7b5b\uff0c\u628a\u6240\u6709\u7684\u8d28\u6570\u90fd\u5148\u7b5b\u51fa\u6765\uff0c\u518d\u53bb\u505a\u5c31\u4f1a\u8282\u7701\u5f88\u591a\u65f6\u95f4\u4e86\u3002\u4e0d\u4f1a\u7684\u5c0f\u4f19\u4f34\u53ef\u4ee5\u5148\u505a\u8fd9\u9053\u9898\uff1a[\u7ebf\u6027\u7b5b\u8d28\u6570](https://www.luogu.com.cn/problem/P3383)\u3002\n\n\u8981\u6ce8\u610f\u7684\u662f\uff1a\u8fd9\u9053\u9898\u5728\u7b5b\u7684\u65f6\u5019\u53ef\u4ee5\u5c06\u6bcf\u4e00\u4e2a\u5408\u6570\u90fd\u6807\u8bb0\u4e0a\u5b83\u662f\u4ece\u54ea\u91cc\u5f97\u5230\u8fd9\u4e2a\u6807\u8bb0\u7684\uff0c\u8fd9\u6837\u6bcf\u4e00\u4e2a\u9700\u8981\u627e\u7684\u6570\u5c31\u53ef\u4ee5\u76f4\u63a5\u8df3\u56de\u53bb\uff0c\u4e0d\u9700\u8981\u8d28\u56e0\u6570\u5206\u89e3\u4e86\u3002\u5177\u4f53\u5b9e\u73b0\u4e5f\u5f88\u7b80\u5355\uff0c\u53ea\u9700\u8981\u5c06\u6253\u6807\u8bb0\u7684\u8fd9\u4e00\u53e5\u8bdd\n```\nv[prime[j]*i]=1;\n```\n\u6539\u4e3a\n```\nv[prime[j]*i]=prime[j];\n```\n\u5c31\u53ef\u4ee5\u77e5\u9053\u5b83\u662f\u54ea\u6765\u7684\u4e86\u3002\n\n\n\n------------\n\u4e0b\u9762\u662f\u5b8c\u6574\u4ee3\u7801\n```\n#include<bits/stdc++.h>\nusing namespace std;\nint v[100000010],prime[5770000],cnt,t,n;\nint main()\n{\n\tfor(int i=2;i<=100000000;i++)\n\t{\n\t\tif(!v[i])\n\t\t\tprime[++cnt]=i;\n\t\tfor(int j=1;j<=cnt&&(long long)prime[j]*i<=100000000;j++)\n\t\t{\n\t\t\tv[prime[j]*i]=prime[j];//\u6807\u8bb0\u5b83\u662f\u4ece\u54ea\u91cc\u6765\u7684\u90e8\u5206\n\t\t\tif(!(i%prime[j]))\n\t\t\t\tbreak;\n\t\t}\n\t}//\u6b27\u62c9\u7b5b\u9884\u5904\u7406\n\tscanf(\"%d\",&t);\n\twhile(t--)\n\t{\n\t\tscanf(\"%d\",&n);\n\t\tint ans=0;\n\t\tif(v[n]==0)\n\t\t{\n\t\t\tprintf(\"%d\\n\",n);\n\t\t\tcontinue;\n\t\t}//\u5982\u679c\u662f\u8d28\u6570\u5c31\u76f4\u63a5\u8f93\u51fa\n\t\twhile(1)\n\t\t{\n\t\t\tif(!v[n])\n\t\t\t{\n\t\t\t\tans^=n;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tans^=v[n];\n\t\t\tn/=v[n];\n\t\t}//\u4e0d\u662f\u5c31\u4ece\u524d\u5f80\u540e\u627e\uff0c\u6bcf\u4e00\u6b21\u90fd\u5f02\u6216\u4e00\u4e0b\u90a3\u4e2a\u8d28\u56e0\u6570\uff0c\u76f4\u5230\u627e\u5230\u4e00\u4e2a\u8d28\u6570\n\t\tprintf(\"%d\\n\",ans);\n\t}\n    return 0;\n}\n```\n### \u5b8c\u7ed3\u6492\u82b1\uff01\n\u6ce8\uff1b\u840c\u65b0\u7684\u7b2c\u4e00\u7bc7\u9898\u89e3\uff0c\u6c42\u7ba1\u7406\u5927\u5927\u7ed9\u8fc7\u554a",
        "postTime": 1677145475,
        "uid": 469470,
        "name": "EurekaStriker",
        "ccfLevel": 4,
        "title": "B3716\u9898\u89e3"
    }
]
[
    {
        "content": "### \u6211\u662f\u521a\u5b66\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u840c\u65b0\uff0c\u7b2c\u4e00\u6b21\u5199\u83ab\u53cd\u9898\u89e3\uff0c\u5982\u679c\u6709\u4ec0\u4e48\u5730\u65b9\u770b\u4e0d\u61c2\u53ef\u4ee5\u79c1\u4fe1\u6211~~~\n\n\u5bf9\u4e8e 1\u2264a\u2264A\uff0c1\u2264b\u2264B\uff0c\u6709\u591a\u5c11\u6709\u5e8f\u6570\u5bf9 (a, b) \u662f D \u7684\u53cc\u4eb2\u6570\uff1f\n\n\u7531\u9898\u610f\u5f97\n\n## $\\sum ^{A}_{a=1}\\sum ^{B}_ {b=1}(\\gcd \\left( a,b\\right)==D)$\n \n\n### \u6ce8\u610f $\\lfloor A\\rfloor$ \u662f\u5c06A\u5411\u4e0b\u53d6\u6574\u7684\u610f\u601d\n\n\n## $\\sum^{\\lfloor \\frac{A}{D} \\rfloor}_{{a}=1}\\sum^{\\lfloor \\frac{B}{D} \\rfloor}(\\gcd \\left( a,b\\right)==1)$\n\n\u6211\u4eec\u9700\u8981\u7528\u5230$\\mu$\n\n### $\\mu $\u7684\u6027\u8d28\u662f\u8fd9\u6837\u7684\uff1a\n## $(\\gcd \\left( a,b\\right)==1)=\\sum_{d|a ,d|b}\\mu\\left(d\\right)$\n\n\u539f\u5f0f\u7b49\u4e8e\n\n## $\\sum^{\\lfloor \\frac {A}{D}\\rfloor}_{{a}=1}\\sum^{\\lfloor \\frac {B}{D}\\rfloor}_{{b}=1}\\sum_{d|a ,d|b}\\mu\\left(d\\right)$\n\n\u6211\u4eec\u9009\u62e9\u679a\u4e3ed \n\n\n## $\\sum^{\\min({\\lfloor \\frac {A}{D}\\rfloor},\\lfloor \\frac {B}{D}\\rfloor)}_{d=1}\\mu(d)\\sum^{\\lfloor \\frac {A}{Dd}\\rfloor}_{a=1}\\sum^{\\lfloor \\frac {B}{Dd}\\rfloor}_{b=1}1$\n\n\n## $\\sum^{\\min({\\lfloor \\frac {A}{D}\\rfloor},\\lfloor \\frac {B}{D}\\rfloor)}_{d=1}\\mu(d){\\lfloor \\frac {A}{Dd}\\rfloor}{\\lfloor \\frac {B}{Dd}\\rfloor}$\n\n \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6574\u9664\u5206\u5757$O(\\sqrt {n})$\u6c42\u51fa\u6765\u7b54\u6848\n\n \u63a8\u8350\u4e00\u7bc7dalao\u5199\u7684blog\n\n[\u5173\u4e8e\u6574\u9664\u5206\u5757](https://www.luogu.com.cn/blog/command-block/zheng-chu-fen-kuai-ru-men-xiao-ji)\n\n### \u4ee3\u7801\u65f6\u95f4\uff01\n\n#### \u5c0f\u6280\u5de7\uff1a\n\n```\n#define int long long\nsigned main()\n```\n#### \u5c31\u5f00\u4e0a\u4e86longlong\u4e86\n```cpp\n#include<bits/stdc++.h>\n#define int long long//\u5c0f\u6280\u5de7\nusing namespace std;\nint read()//\u5feb\u8bfb\n{\n\tchar c;\n\tint w=1;\n\twhile((c=getchar())>'9'||c<'0')if(c=='-')w=-1;\n\tint ans=c-'0';\n\twhile((c=getchar())>='0'&&c<='9')ans=(ans<<1)+(ans<<3)+c-'0';\n\treturn ans*w;\n}\nint A,B,D;\nint mu[1000005];//\u7b5bmu\nint qzh[1000005];//\u524d\u7f00\u548c\nint prim[1000005];//\u7d20\u6570\uff08\u6b27\u62c9\u7b5b \uff09\nint vis[1000005];//\u6807\u8bb0\nvoid pre()//\u5904\u7406\n{\n\tmu[1]=1;\n\tint cnt=0;\n\tfor(int i=2;i<=1e6;i++)\n\t{\n\t\tif(!vis[i])\n\t\t{\n\t\t\tprim[++cnt]=i;\n\t\t\tmu[i]=-1;\n\t\t}\n\t\tfor(int j=1;j<=cnt;j++)\n\t\t{\n\t\t\tif(i*prim[j]>1e6)break;\n\t\t\tvis[i*prim[j]]=1;\n\t\t\tif(i%prim[j]==0)\n\t\t\t{\n\t\t\t\tmu[i*prim[j]]=0;break;\n\t\t\t}\n\t\t\tmu[i*prim[j]]=-mu[i];\n\t\t}\n\t}\n\tfor(int i=1;i<=1e6;i++)\n\t{\n\t\tqzh[i]=qzh[i-1]+mu[i];\n\t}\n}\nint ask(int x,int y)//\u6574\u9664\u5206\u5757\u8be2\u95ee\uff01\uff01\uff01\uff01\n{\n\tint ans=0,r;\n\tfor(int l=1;l<=min(x,y);l=r+1)\n\t{\n\t\tr=min(x/(x/l),y/(y/l));\n\t\tans+=(qzh[r]-qzh[l-1])*(x/l)*(y/l);\n\t}\n\treturn ans;\n}\nsigned main(){\n\tpre();\n\tA=read();\n\tB=read();\n\tD=read();\n\tA/=D;//\u5176\u5b9e\u8fd9\u91cc\u53ef\u4ee5\u63d0\u524d\u9664\u4ee5D\u7684\n\tB/=D;\n\tcout<<ask(A,B)<<endl;\n\treturn 0;\n}\n```\n\n#### \u672c\u4eba\u5c31\u4e0d\u505a\u9632\u6284\u88ad\u4e86\uff0c\u65b9\u4fbf\u5927\u5bb6\u7406\u89e3\n\n#### [\u63d0\u4ea4\u8bb0\u5f55](https://www.luogu.com.cn/record/34151590)\n\n#### \u795d\u5927\u5bb6\u597d\u8fd0\uff01\uff01\uff01",
        "postTime": 1591354129,
        "uid": 174399,
        "name": "fzwfzwfzw",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4450 \u53cc\u4eb2\u6570"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u79cd\u8d85\u77ed\u7684\u505a\u6cd5\r\n\r\n\u6211\u4eec\u8bbe $f(d)$ \u4e3a $1\u2264a\u2264A,1\u2264b\u2264B$ \u4e2d $\\gcd(a,b)=d$ \u7684\u4e8c\u5143\u7ec4\u4e2a\u6570\u3002\r\n\r\n\u5982\u4f55\u6c42 $f(d)$ \u6210\u4e3a\u672c\u9898\u7684\u5173\u952e\uff0c\u6211\u5c06\u7528\u8ba1\u6570DP\u6765\u89e3\u51b3\u3002\r\n\r\n\u6211\u4eec\u6253\u4e00\u4e2a\u8868\u89c2\u5bdf\u4e00\u4e0b $\\gcd(a,b)$\u3002\r\n\r\n\r\n```\r\n1 1 1 1 1 1 1 1 1 1\r\n1 2 1 2 1 2 1 2 1 2\r\n1 1 3 1 1 3 1 1 3 1\r\n1 2 1 4 1 2 1 4 1 2\r\n1 1 1 1 5 1 1 1 1 5\r\n1 2 3 2 1 6 1 2 3 2\r\n1 1 1 1 1 1 7 1 1 1\r\n1 2 1 4 1 2 1 8 1 2\r\n1 1 3 1 1 3 1 1 9 1\r\n1 2 1 2 5 2 1 2 1 10\r\n```\r\n\u6211\u4eec\u8bbe\u51fd\u6570 $g(d)$ \u662f $\\sum_{(a,b)}d| \\gcd(a,b)$\u3002\r\n\r\n\u5982\u56fe\uff0c\u53ef\u4ee5\u5f88\u76f4\u89c2\u7684\u53d1\u73b0 $g(d)$ \u5b9e\u9645\u4e0a\u5c31\u662f $(A/d)*(B/d)$\u3002\r\n\r\n\u6211\u4eec\u53ef\u4ee5\u5f88\u76f4\u89c2\u7684\u53d1\u73b0\uff0c$g(d)=f(d)+f(2d)+f(3d)\u2026\u2026+f(\\lfloor \\frac{n}{d} \\rfloor*d)$\u3002\r\n\r\n\u4e8e\u662f\u6211\u4eec\u53cd\u5411\u63a8\u4e00\u4e0b $f(d)=g(d)- f(2d)-f(3d)\u2026\u2026-f(\\lfloor \\frac{n}{d} \\rfloor*d)$ , \u5e76\u4e14\u6709\u8fb9\u754c\u6761\u4ef6 $g(n)=f(n)=1$\u3002\r\n\r\n\u4e8e\u662f\u6211\u4eec\u5c31\u5f97\u5230\u4e86 $f(d)$ \u7684\u9006\u63a8\u5f0f\u3002\r\n\r\n\u4e0a\u4ee3\u7801\uff1a\r\n\r\n```\r\n#include<cstdio>\r\n#include<algorithm>\r\n#define int long long\r\n#define N 100000006\r\nusing namespace std;\r\nint k,g[N],f[N],ans,n,m,sum,Ch;\r\nsigned main(){\r\n\tscanf(\"%lld%lld%lld\",&n,&m,&Ch);\r\n\tif(n>m)swap(n,m);\r\n\tfor(int k=n;k>=1;k--){\r\n\t\tg[k]=(n/k)*(m/k);\r\n\t\tf[k]=g[k];\r\n\t\tfor(int j=2;j<=(n/k);j++)f[k]-=f[j*k];\r\n\t}\r\n\tprintf(\"%lld\",f[Ch]);\r\n\treturn 0;\r\n}\r\n```\r\n\u7b97\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(nH(n))$\uff0c\u5176\u4e2d $H(n)$ \u4e3a\u8c03\u548c\u7ea7\u6570\u548c\uff0c\u6c42\u4e00\u4e0b\u79ef\u5206\u53ef\u4ee5\u77e5\u9053\u65f6\u95f4\u590d\u6742\u5ea6\u7ea6\u4e3a $O(n \\ln n)$",
        "postTime": 1656763812,
        "uid": 285617,
        "name": "\u9ed1\u5f71\u6d1e\u4eba",
        "ccfLevel": 5,
        "title": "P4450 \u53cc\u4eb2\u6570 \u9898\u89e3"
    },
    {
        "content": "\n\uff08\u524d\u8a00\uff09\u672c\u6587\u501f\u9274\u4e86[dalao\u7684\u535a\u5ba2](https://www.luogu.org/blog/An-Amazing-Blog/mu-bi-wu-si-fan-yan-ji-ge-ji-miao-di-dong-xi)\uff0c\u770b\u4e86\u8fd9\u7bc7\u6587\u7ae0\u624d\u7ec8\u4e8e\u660e\u767d\u4e86\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u8be5\u600e\u4e48\u6253\u3002\u591a\u8c22dalao\uff01\uff01\n\n\u539f\u9898\u4f20\u9001\u95e8[>Here<](https://www.luogu.org/problemnew/show/P4450)\n\n\u7f51\u4e0a\u7684\u7684\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u8bb2\u7a3f\u90fd\u8bb2\u4e86\u5f88\u591a\u4e0d\u660e\u89c9\u5389\u7684\u516c\u5f0f\uff0c\u641e\u5f97\u6211\u5f88\u4e45\u90fd\u6ca1\u61c2\uff0c\u770b\u4e86\u4e00\u4e9b\u9898\u76ee\u548cdalao\u7684\u535a\u5ba2\u4ee5\u540e\u624d\u53d1\u73b0\u3002\u3002\u5176\u5b9e\u6709\u5f88\u591a\u516c\u5f0f\u662f\u4e0d\u9700\u8981\u7684\uff01\n\n\u5b9e\u9645\u7f16\u7a0b\u65f6\uff0c\u5f88\u591a\u516c\u5f0f\u5e76\u4e0d\u9700\u8981\u641e\u5f97\u90a3\u4e48\u590d\u6742\uff0c\u4e8e\u662f\u6211\u5148\u5199\u4e00\u7bc7\u9762\u5411OI\u7684\u5b66\u4e60\u7b14\u8bb0\uff0c\u4ee5\u540e\u6709\u65f6\u95f4\u518d\u66f4\u65b0\u66f4\u5947\u8469\u7684\u6570\u5b66\u90e8\u5206\u3002\n\n\u9996\u5148\u5b9a\u4e49\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570 $\u03bc(n)$\uff1a\n\n$$\\large\u03bc(n)=\\begin{cases}1&n==1\\\\(-1)^k&n=p_1p_2p_3..p_k\\\\0&otherwise\\end{cases}$$\n\n\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u7b80\u5355\u7684\u8bc1\u660e\u5f97\u5230$\u03bc(n)$\u7684\u6027\u8d28\u5982\u4e0b\uff1a\n\n\n$$\\sum_{d|n}\u03bc(d)=[n=1]$$\n\n\u4e0b\u9762\u662f\u7b80\u5355\u7684\u8bc1\u660e\uff1a\n\n\u6211\u4eec\u77e5\u9053\uff0c\u5f53\u4e14\u4ec5\u5f53n\u7531\u82e5\u5e72\u4e92\u4e0d\u76f8\u540c\u7684\u8d28\u6570\u76f8\u4e58\u800c\u6765\u65f6\uff0c$\u03bc(n)$\u4e0d\u4e3a0\u3002\u56e0\u6b64\u6211\u4eec\u8003\u8651\u679a\u4e3en\u7684\u56e0\u5b50\u4e2d\u7684\u7d20\u6570\u4e2a\u6570\u3002\u8bben\u6709k\u4e2a\u8d28\u56e0\u6570\uff0c\u5219\uff1a\n\n$$\\sum_{d|n}\u03bc(d)=C_k^0(-1)^0+C_k^1(-1)^1+..+C_k^k(-1)^k$$\n\n\u901a\u8fc7\u4e8c\u9879\u5f0f\u5b9a\u7406\u53ef\u77e5\uff0ck>1\u65f6\u4e0a\u5f0f\u7b49\u4e8e$(1+(-1))^k=0$\u3002\n\n\u8bc1\u6bd5\u3002\n\n\u8fd9\u9053\u9898\u6c42\u7684\u662f$$\\sum_{i=1}^{A}\\sum_{j=1}^{B}[gcd(i,j)==k]$$\n\n\u6211\u4eec\u628a\u8fd9\u4e2a\u5f0f\u5b50\u5316\u7b80\u4e00\u4e0b\uff0c\u5c06A,B\u540c\u9664\u4ee5k\u3002\n\n\u4e8e\u662f\u6b64\u9898\u5373\u4e3a\u6c42$$\\sum_{i=1}^{A}\\sum_{j=1}^{B}[gcd(i,j)==1]$$\n\n\u5957\u7528$\u03bc(n)$\u7684\u6027\u8d28\uff0c\u5219\u4e0a\u5f0f\u5373\u4e3a\n\n$$\\sum_{i=1}^{A}\\sum_{j=1}^{B}\\sum_{d|gcd(i,j)}\u03bc(d)$$\n\n\u8003\u8651\u5f53$d|gcd(i,j)$\u65f6\uff0c$i\\in\\{d,2d,3d,..\\}\\cap\\{1,2,3,..,n\\}$,\u56e0\u6b64\u6709$|\\frac{A}{d}|$\u79cd\u53d6\u503c\u3002\u540c\u7406\uff0c$j$\u6709$|\\frac{B}{d}|$\u79cd\u53d6\u503c\uff08\u5199\u5f97\u6709\u4e9b\u5570\u55e6\u5927\u4f6c\u4eec\u52ff\u55b7\uff09\u3002\u6240\u4ee5\u4e0a\u5f0f\u53ef\u5316\u7b80\u4e3a\n\n$$\\sum_{d=1}^{n}\u03bc(d)*|\\frac{A}{d}|*|\\frac{B}{d}|$$\n\n\u505a\u5230\u8fd9\u91cc\u5df2\u7ecf\u964d\u4e86\u5f88\u591a\u590d\u6742\u5ea6\u53ef\u4ee5\u8fdb\u884c$O(n)$\u7684\u679a\u4e3e\u4e86\u3002\u7136\u800c\u8fd9\u91cc\u6570\u636e\u51fa\u5f97\u5f88\u5927\uff0c\u8fde$O(n)$\u4e5f\u8fc7\u4e0d\u53bb\u3002\u8fd9\u65f6\u5019\u5c31\u8981\u7528\u6574\u9664\u5206\u5757\u628a\u590d\u6742\u5ea6\u964d\u5230$O(\\sqrt{n})$\n\n\u4f46\u662f\u8fd9\u4e2a\u6574\u9664\u5206\u5757\u6709\u4e9b\u4e0d\u4e00\u6837\uff0c\u6bcf\u6b21\u53ea\u80fd\u64cd\u4f5c$|\\frac{A}{d}|$\u4e0e$|\\frac{B}{d}|$\u90fd\u76f8\u540c\u7684\u90e8\u5206\uff0c\u6240\u4ee5\u9700\u8981\u7279\u6b8a\u5904\u7406\u3002\n\n\u518d\u52a0\u4e0a\u4e00\u6bb5\u7ebf\u6027\u7b5b$\u03bc(n)$\u7684\u4ee3\u7801\uff0c\u5c31\u53ef\u4ee5AC\u4e86\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <cstdio>\n#define min(X,Y) ((X)<(Y)?(X):(Y))\n\nlong long mobius[1000001],A,B,d,prime[1000001],tot,ans;\nbool check[1000001];\nint main(){\n\tscanf(\"%lld%lld%lld\",&A,&B,&d);\n\tmobius[1]=1;\n\tA/=d;\n\tB/=d;\n\tif(A>B)A^=B^=A^=B;\n\tfor(register int i=2;i<=A;i++){\n\t\tif(!check[i]){\n\t\t\tmobius[i]=-1;\n\t\t\tprime[++tot]=i;\n\t\t}\n\t\tfor(register int j=1;j<=tot;j++){\n\t\t\tif(i*prime[j]>A)break;\n\t\t\tcheck[i*prime[j]]=1;\n\t\t\tif(i%prime[j]==0){\n\t\t\t\tmobius[i*prime[j]]=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmobius[i*prime[j]]=-mobius[i];\n\t\t}\n\t}\n\tfor(register int i=2;i<=A;i++)mobius[i]+=mobius[i-1];\n    for(register int i=1,j;i<=A;i=j+1)\n    {\n        j=min(A/(A/i),B/(B/i));\n        ans+=(A/i)*(B/i)*(mobius[j]-mobius[i-1]);\n    }\n    printf(\"%lld\",ans);\n}\n```",
        "postTime": 1533740410,
        "uid": 30903,
        "name": "Isonan",
        "ccfLevel": 0,
        "title": "luoguP4450 \u53cc\u4eb2\u6570"
    },
    {
        "content": "**upd\uff1a256 \u5929\u540e\u7684\u66f4\u65b0\uff0c\u4fee\u590d\u4e86\u9519\u8bef\u548c\u516c\u5f0f\u683c\u5f0f\uff0c\u5145\u5b9e\u4e86\u5185\u5bb9**\n\n**\u5982\u679c $\\LaTeX$ \u6e32\u67d3\u6302\u4e86\u8bf7\u79fb\u6b65[\u6d1b\u8c37\u535a\u5ba2](https://www.luogu.com.cn/blog/fa555/solution-p4450)\u6216[\u4e2a\u4eba\u535a\u5ba2](https://fa555.github.io/2019/%E9%A2%98%E8%A7%A3-P4450-%E3%80%90%E5%8F%8C%E4%BA%B2%E6%95%B0%E3%80%91/)**\n\nunder \u9898\u89e3 [P4450](https://www.luogu.org/problem/P4450)\n\n*\u849f\u84bb\u7b2c\u4e00\u9053\u83ab\u53cd\u9898*\n\n*\u672c\u9898\u89e3\u9002\u5408\u65b0\u624b\u5b66\u4e60\u57fa\u7840\uff0cdalao \u8bf7\u8df3\u8fc7\uff0c\u4e0d\u8981\u5632\u8bbd qwq*\n\n---\n\n### \u524d\u7f6e\u77e5\u8bc6\uff1a\n\n#### \u5355\u4f4d\u51fd\u6570\uff08$\\epsilon$\uff09\uff1a\n\n$$\n\\epsilon(i) = \\begin{cases}\n1 &, i = 1 \\\\\n0 &, i \\ne 1\n\\end{cases}\n$$\n\n\u5373\u5f53\u4e14\u4ec5\u5f53 `i = 1` \u65f6\u53d6\u503c\u53d6\u503c\u4e3a `1`\uff0c\u5426\u5219\u4e3a `0`\u3002\u5f88\u7b80\u5355\u5bf9\u4e0d\u5bf9\uff1f\n\n#### Dirichlet \u5377\u79ef($\\ast$)\uff1a\n\nDirichlet \u5377\u79ef\u662f\u6570\u8bba\u51fd\u6570\u4e4b\u95f4\u7684\u8fd0\u7b97\u3002\u5373\n\n$$\nh = f \\ast g\n$$\n\n\u5176\u4e2d $f, g, h$ \u5747\u4e3a\u6570\u8bba\u51fd\u6570\u3002\u5219\n\n$$\nh(n) = \\sum_{d | n}{f(d) g \\left(\\frac nd \\right)}\n$$\n\n\u4e5f\u53ef\u4ee5\u5199\u4f5c\n\n$$\nh(n) = \\sum_{i \u00b7 j = n}{f(i) g(j)}\n$$\n\n\u6211\u4eec\u53d1\u73b0\uff1a$\\epsilon$ \u51fd\u6570\u662f Dirichlet \u5377\u79ef\u7684\u5355\u4f4d\u5143\uff0c\u5373 $f = f \\ast \\epsilon$\u3002\n\n#### Mobius \u51fd\u6570($\\mu$)\uff1a\n$$\n\\mu(n) = \\begin{cases}\n1 &, n = 1 \\\\\n(-1)^m &, n = p_1p_2 \\cdots p_m \\\\\n0 &, \\mathrm{otherwise}\n\\end{cases}\n$$\n\n\u5176\u4e2d $p_1,p_2, \\cdots, p_m$ \u662f\u4e0d\u540c\u7684\u8d28\u6570\u3002$\\mu(n)$ \u6070\u5728 $n$ \u65e0\u5e73\u65b9\u56e0\u5b50\u65f6\u53d6\u503c\u975e\u96f6\u3002\u663e\u7136 $\\mu$ \u662f\u79ef\u6027\u51fd\u6570\u3002\n\n$$\n\\begin{aligned}\n\\sum_{d | n}{\\mu(d)} &= \\epsilon(n) \\\\\n\\epsilon &= 1 \\ast \\mu\n\\end{aligned}\n$$\n\n#### Mobius \u53d8\u6362\n\n\u8bbe $f$ \u662f\u6570\u8bba\u51fd\u6570\uff0c\u82e5\u6570\u8bba\u51fd\u6570 $g$ \u6ee1\u8db3\n\n$$\n\\begin{aligned}\ng &=  f * \\mathbf1 \\\\\n\\textrm{That is} \\quad g(n) &= \\sum_{d | n}{f(d)}\n\\end{aligned}\n$$\n\n\u5219\u79f0 $g$ \u662f $f$ \u7684 Mobius \u53d8\u6362\u3002\n\n\u63a8\u4e00\u4e0b\u5f0f\u5b50\u3002\n\n$$\ng = f \\ast 1 \\Rightarrow f = f \\ast \\epsilon = f \\ast 1 \\ast \\mu = g \\ast \\mu\n$$\n\n\u5373\n\n$$\ng = f \\ast 1 \\Leftrightarrow f = g \\ast \\mu\n$$\n\n\u81f3\u6b64\u5c31\u53ef\u4ee5\u6765\u505a\u8fd9\u9053\u9898\u4e86\u3002\n\n---\n\n\u56de\u5230\u4e86\u539f\u9898\u3002\u9898\u76ee\u8981\u6c42\u7684\u662f\n\n$$\n\\sum_{i = 1}^A{\\sum_{j = 1}^B{[\\gcd(i, j) = d]}}\n$$\n\n\u5bf9\u5f0f\u5b50\u8fdb\u884c\u5957\u8def\u6027\u7684\u53d8\u5f62\n\n$$\n\\sum_{i = 1}^{\\lfloor A / d \\rfloor}{\\sum_{j = 1}^{\\lfloor B / d \\rfloor}{[\\gcd(i, j) = 1]}}\n$$\n\n\u51fa\u73b0\u4e86 $[ \\gcd(i, j) = 1]$\uff0c\u4e5f\u5373 $\\epsilon( \\gcd(i, j))$\u3002\u628a $\\epsilon = 1 \\ast \\mu$ \u4ee3\u5165\uff0c\u5f97\u5230\u4e86\n\n$$\n\\sum_{i = 1}^{\\lfloor A / d \\rfloor}{\\sum_{j = 1}^{\\lfloor B / d \\rfloor}{\\sum_{g | \\gcd(i, j)}{\\mu(g)}}}\n$$\n\n~~\uff08\u4f3c\u4e4e\u8d8a\u6765\u8d8a\u4e11\u4e86\uff09~~\u6b64\u65f6\u53ef\u4ee5\u628a $d | \\gcd(i, j)$ \u62c6\u5f00\uff1a\n\n$$\n\\begin{aligned}\n& \\sum_{i = 1}^{\\lfloor A / d \\rfloor}{\\sum_{j = 1}^{\\lfloor B / d \\rfloor}{\\sum_{g | i, g | j}{\\mu(g)}}} \\\\\n=& \\sum_{g = 1}^{\\min(A / d, B / d)}{\\mu(g) \\left\\lfloor \\frac{A}{dg} \\right\\rfloor \\left\\lfloor \\frac{B}{dg} \\right\\rfloor}\n\\end{aligned}\n$$\n\n\u81f3\u6b64\uff0c\u8ba1\u7b97\u7b54\u6848\u53ef\u4ee5 $O(n)$ \u89e3\u51b3\u3002\n\n\u7b97\u6cd5\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u4f18\u5316\u3002\u53d1\u73b0\u5f0f\u5b50\u91cc\u8fd8\u6709\u4e24\u4e2a\u5f62\u5982 $\\lfloor n / d \\rfloor$ \u7684\u56e0\u5b50\uff0c\u56e0\u6b64\u53ef\u4ee5\u6574\u9664\u5206\u5757\u4f18\u5316\u6210 $O(\\sqrt{n})$ \u7684\u3002\u914d\u5408 $O(n)$ \u7684\u7ebf\u6027\u7b5b $\\mu$ \u51fd\u6570\uff0c\u603b\u590d\u6742\u5ea6 $O(n)$\uff0c\u53ef\u4ee5\u8f7b\u677e\u901a\u8fc7\u672c\u9898\u3002\n\n---\n\n### code 1\n\n``` cpp\nstd::bitset<1000003> v;\nint p[78501], mu[1000003];\n\nvoid sieve(int N) {\n  int m = 0;\n\n  v.set(1), mu[1] = 1;\n  for (int i = 2; i <= N; ++i) {\n    if (!v[i]) p[++m] = i, mu[i] = -1;\n    for (int j = 1; j <= m && i * p[j] <= N; ++j) {\n      v.set(i * p[j]);\n      if (i % p[j] == 0) break;\n      mu[i * p[j]] = -mu[i];\n    }\n    mu[i] += mu[i - 1];\n  }\n}\n\nint main() {\n  int A, B, d;\n  long long ans = 0;\n\n  std::cin >> A >> B >> d;\n  A /= d, B /= d;\n  if (A > B) std::swap(A, B);\n\n  sieve(A);\n  for (int l = 1, r, a, b; l <= A; l = r + 1) {\n    a = A / l, b = B / l;\n    r = std::min(A / a, B / b);\n    ans += 1ll * a * b * (mu[r] - mu[l - 1]);\n  }\n  std::cout << ans << '\\n';\n  return 0;\n}\n\n```\n\n### code 2\n\n~~\u5982\u679c\u4f60\u50cf\u6211\u4e00\u6837\u95f2\u5f97\u96be\u53d7\uff0c\u53ef\u4ee5\u5b66\u6765\u675c\u6559\u7b5b\u5199\u5199\u8fd9\u9898\uff0c\u590d\u6742\u5ea6\u597d\u50cf\u8fd8\u66f4\u9ad8\u4e86\u3002~~\n\n\u4e0d\u4f1a\u675c\u6559\u7b5b\u4f46\u60f3\u5b66\u7684\u670b\u53cb\u53ef\u4ee5\u6765\u770b\u6211\u7684[\u8fd9\u7bc7\u9898\u89e3](https://fa555.github.io/2020/\u675c\u6559\u7b5b\u5b66\u4e60\u7b14\u8bb0/)\u3002\n\n\u8fd9\u4e2a\u591a\u6b21\u8be2\u95ee\u7684\u9898\u76ee\u8ba9\u6211\u5bf9\u675c\u6559\u7b5b\u53ca\u7a7a\u95f4\u4f18\u5316\u6709\u4e86\u66f4\u6df1\u5165\u7684\u7406\u89e3\uff08\n\n``` cpp\nstd::bitset<10003> v, vm;\nint MX, base, p[1231], mu[10003], mu_[10003];\n\ninline int to(int x) {\n  return MX / x;\n}\n\nvoid sieve(int N); // \u540c code 1\n\nint getMu(int N) {\n  if (N <= base) return mu[N];\n  if (vm[to(N)]) return mu_[to(N)];\n  int ans = 0;\n  for (int l = 2, r, L; l <= N; l = r + 1) {\n    L = N / l, r = N / L;\n    ans += (r - l + 1) * getMu(L);\n  }\n  vm.set(to(N));\n  return mu_[to(N)] = 1 - ans;\n}\n\nint main() {\n  int A, B, d;\n  long long ans = 0;\n\n  std::cin >> A >> B >> d;\n  A /= d, B /= d;\n  if (A > B) std::swap(A, B);\n\n  MX = A, base = pow(A, 2. / 3);\n  sieve(base);\n  for (int l = 1, r, a, b, gR, gL; l <= A; l = r + 1) {\n    a = A / l, b = B / l;\n    r = std::min(A / a, B / b);\n    vm.reset(), gR = getMu(r);\n    vm.reset(), gL = getMu(l - 1);\n    ans += 1ll * a * b * (gR - gL);\n  }\n  std::cout << ans << '\\n';\n  return 0;\n}\n\n```\n\n",
        "postTime": 1564104790,
        "uid": 111890,
        "name": "fa_555",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4450 \u3010\u53cc\u4eb2\u6570\u3011"
    },
    {
        "content": "\u591a\u500d\u7ecf\u9a8c\u9898\uff0c\u521a\u597d\u505a\u5230\u8fd9\u91cc\u60f3\u5199\u4e00\u5199\u9898\u89e3\n### \u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\n- \u5b9a\u4e49  \n\n$\\mu(n)=\\begin{cases}\n-1& n=1  \\\\\n0  & i\\in N^* ,i^2|n \\\\\n(-1)^k&n=a_1a_2a_3...a_t(\\forall i,j,[1 \\le i,j,\\le t;i\\ne j],a_i\\ne a_j)\n\\end{cases}$\n\n- \u6027\u8d28   \n\n$\\sum\\limits_{d|n}^{}\\mu(d)=\\begin{cases}\n1&n=1\\\\\n0&n\\ne 1\\\\\n\\end{cases}$  \n\n$\\begin{cases}\n1&n=1\\\\\n0&n\\ne 1\\\\\n\\end{cases}$\n\n\u4e5f\u53ef\u4ee5\u8bb0\u4f5c$[n=1]$\uff0c\u610f\u4e49\u4e3a\uff0c\u62ec\u53f7\u4e3a\u6b63\u503c\u4e3a$1$, \u5426\u5219\u503c\u4e3a$0$ $($\u5373\u62ec\u53f7\u5185\u8868\u8fbe\u5f0f\u8fd4\u56de\u503c$)$\n\u6545\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a  \n\n$\\sum\\limits_{d|n}^{}\\mu(d)=[n=1]$\n- $\\mu$\u662f$1$\u7684\u9006\u5143\n\n\u524d\u7f6e\uff1a$n$\u4e0d\u540c\u7684\u8d28\u56e0\u5b50\u4e2a\u6570\u4e3a$t$\n \n$\\mu* 1$\n\n$=\\sum\\limits_{d|n}\\mu(d)1(\\frac{n}{d})$\n\n$=\\sum\\limits_{d|n}\\mu(d)$\n\n$=\\sum\\limits_{i=0}^k(-1)^k\\dbinom{k}{i}$\n\n\u7531\u4e8c\u9879\u5f0f\u5b9a\u7406\u5f97 ~~\uff08\u4e0d\u4f1a\u7684\u8d76\u7d27\u53bb\u767e\u5ea6~~\uff1a\n\n$(x-y)^k$\n\n$=\\sum\\limits_{i=0}^kx^iy^{x-i}\\dbinom{k}{i}$  \n\n\u7279\u89e3\uff1a  \n\n$x=-1,y=1$\u65f6\n\n$(-1+1)^k=\\sum\\limits_{i=0}^k(-1)^k\\cdot1\\cdot\\dbinom{k}{i}$\n\n\u6545\uff1a\n\n$\\mu* 1=\\sum\\limits_{i=0}^k(-1)^k\\dbinom{k}{i}=0^k$   \n\n\u8fd9\u91cc$0^0$\u53ea\u6709\u5f53 $n=1,\\mu(n)=1$\u65f6\u51fa\u73b0\uff0c\u521a\u597d\u7b26\u5408\uff1a\n\n$\\epsilon(n)=[n=1]$\n\n$\\therefore\\mu* 1=\\epsilon$\n### \u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n- \u5f0f\u5b50  \n\n\u8bbe\u4e24\u51fd\u6570 $f(x),g(x)$\n\n$g(n)=\\sum\\limits_{d|n}^{}f(d)\\iff f(x)=\\sum\\limits_{d|n}^{}\\mu(d)f(\\frac{n}{d})$   \n\n\u53e6\u4e00\u5f62\u5f0f\n\n$g(n)=\\sum\\limits_{n|d}^{}f(d)\\iff f(x)=\\sum\\limits_{n|d}^{}\\mu(\\frac{d}{n})f(d)$   \n- \u8bc1\u660e(1)\n\n\u524d\u7f6e\uff1a$g=f* 1$\n\n$g(n)=\\sum\\limits_{d|n}f(d)1(\\frac{n}{d})$\n\n$g(n)=\\sum\\limits_{d|n}f(d)$\n\n$\\because g=f* 1$\n\n$g*\\mu=f* 1*\\mu$\n\n$f=g*\\mu$\n\n$f(n)=\\sum\\limits_{d|n}g(d)\\mu(\\frac{n}{d})$\n\n$\\therefore g(n)=\\sum\\limits_{d|n}^{}f(d)\\iff f(x)=\\sum\\limits_{d|n}^{}\\mu(d)f(\\frac{n}{d})$\n\n- \u8bc1\u660e(2)\n\n\u524d\u7f6e\uff1a$g(n)=\\sum\\limits_{n|d}^{}f(d),k=\\frac{d}{n}$\uff0c$t$\u662f$nk$\u7684\u500d\u6570\n\n$\\sum\\limits_{n|d}^{}\\mu(\\frac{d}{n})f(d)$\n\n$=\\sum\\limits_{k}\\mu(k)f(nk)$\n\n$=\\sum\\limits_{k}({\\mu(k)\\sum\\limits_{(nk)|t}f(t)})$   \n\u5148\u679a\u4e3e$t:$\n\n$=\\sum\\limits_{t}(f(t)\\sum\\limits_{(nk)|t}\\mu(k))$\n\n$=\\sum\\limits_t(f(t)\\sum\\limits_{(k|\\frac{n}{t})}\\mu(k)))$\n\n$=\\sum\\limits_{t}f(t)\\mu(\\frac{n}{t})*1$\n\n$=\\sum\\limits_tf(t)\\epsilon(\\frac{n}{t})$\n\n$\\frac{n}{t}=1,n=t$\u65f6,\u5f0f\u5b50\u6709\u503c\n\n\u6545\u539f\u5f0f\n\n$=f(n)$\n### \u53cd\u6f14\u5e94\u7528\n- \u9898\u610f\n\n\u7ed9\u5b9a$d$\uff0c\u6c42$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m[gcd(i,j)=d]$\n\n- \u53cd\u6f14\n\n$\\because [gcd(i,j)=d]$\n\n$\\therefore \\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m[gcd(i,j)=d]$\n\n$=\\sum\\limits_{i=1}^{n/d}\\sum\\limits_{j=1}^{m/d}[gcd(i,j)=1]$\n\n\u8bbe\uff1a\n\n$f(x)=\\sum\\limits_{i=1}^{n/d}\\sum\\limits_{j=1}^{m/d}[gcd(i,j)=x]$\n\n$g(x)=\\sum\\limits_{i=1}^{n/d}\\sum\\limits_{j=1}^{m/d}[x|gcd(i,j)]$\n\n$f(x)$\u8868\u793a\u6700\u5927\u516c\u56e0\u6570\u662f$x$\u7684\u70b9\u5bf9\n\n$g(x)$\u8868\u793a\u516c\u56e0\u6570\u662f$x$\u7684\u70b9\u5bf9\n\n\u663e\u7136\u6709\uff1a\n\n$g(x)=\\sum\\limits_{x|k,k \\le n}f(x)$\n\n~~\u4e00\u6ce2~~\u53cd\u6f14~~\u731b\u5982\u864e~~\uff1a\n\n$f(x)=\\sum\\limits_{x|k}f(x)\\mu(\\frac{k}{x})\\iff f(x)=\\sum\\limits_{x|k}\\mu(x)f(\\frac{k}{x})$\n\n$g(x)=\\sum\\limits_{i=1}^{n/d}\\sum\\limits_{j=1}^{m/d}[x|gcd(i,j)]$\n\n$=\\sum\\limits_{i=1}^{\\frac{n}{dx}}\\sum\\limits_{j=1}^{\\frac{m}{dx}}[1|gcd(i,j)]$\n\n$=\\sum\\limits_{i=1}^{\\frac{n}{dx}}\\sum\\limits_{j=1}^{\\frac{m}{dx}}1$\n\n$=\\lfloor\\frac{n}{dx}\\rfloor\\cdot\\lfloor\\frac{m}{dx}\\rfloor$\n\n\u6545\u7b54\u6848\u4e3a\uff1a\n\n$f(1)=\\sum\\limits_{i=1}^n\\mu(i)\\lfloor\\frac{n}{dx}\\rfloor\\lfloor\\frac{m}{dx}\\rfloor$\n\n\u6570\u8bba\u5206\u5757\u4e00\u4e0b\u5c31\u53ef\u4ee5$O(\\sqrt{n})$\u505a\u5b8c\u5566\uff01    \n\u5206\u5757\u4e0d\u4f1a\u7684\u8bdd[[P1403]](https://www.luogu.com.cn/problem/P1403)\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nconst int maxn=1e6+1;\nll ans,sum[maxn],mu[maxn],prime[maxn],cnt;\nbool used[maxn];\ninline void get_mu(ll n)//\u7ebf\u6027\u7b5bmu\uff0c\u548c\u7b5b\u7d20\u6570\u5dee\u4e0d\u591a\n{\n    mu[1]=1;//\u52a0\u4e86\u8fd9\u884c\n    for(int i=2;i<=n;i++)\n    {\n        if(!used[i]){prime[++cnt]=i;mu[i]=-1;}//\u8fd9\u884c\n        for(int j=1;j<=cnt&&i*prime[j]<=n;++j)\n        {\n            used[i*prime[j]]=1;\n            if(i%prime[j]==0)break;\n            else mu[i*prime[j]]=-mu[i];//\u8fd9\u884c\n        }\n    }\n    for(int i=1;i<=n;i++)sum[i]=sum[i-1]+mu[i];//\u8fd8\u6709\u8fd9\u884c\n}\nint main()\n{\n    ll n,m,k;\n    scanf(\"%lld%lld%lld\",&n,&m,&k);\n    int x=max(n,m);\n    get_mu(x);\n    ll ans=0;\n    for(int l=1,r;l<=n;l=r+1)//\u5206\u5757\n    {\n        r=min(n/(n/l),m/(m/l));\n        ans+=(n/(l*k))*(m/(l*k))*(sum[r]-sum[l-1]);\n    }\n    printf(\"%lld\",ans);\n    return 0;\n}\n```\n",
        "postTime": 1588154943,
        "uid": 115855,
        "name": "Yyxxxxx",
        "ccfLevel": 4,
        "title": "[P4450]\u53cc\u4eb2\u6570 \u9898\u89e3"
    },
    {
        "content": "\u6700\u8fd1\u5b66\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u672c\u9898\u5e94\u8be5\u662f\u4e00\u9053\u975e\u5e38\u7ecf\u5178\u7684\u5165\u95e8\u9898\n\n\u5148%\u4e00\u4e0bhy\u5927\u4f6c\uff0c\u5728\u4ed6\u7684\u6559\u5bfc\u4e0b\u6211\u624d\u53bb\u5b66\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u2026\u2026\n\nhy\u5927\u4f6c\u7528\u7684\u662f\u6574\u9664\u5206\u5757\u4f18\u5316\u7684\uff0c\u800c\u6211\u6ca1\u7528\u6574\u9664\u5206\u5757\uff0c\u76f4\u63a5\u7528\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5c31\u8fc7\u4e86\u2026\u2026\n\n\u6211\u4eec\u5148\u8981\u8bbe\u5b9a$f$\u548c$F$\u7684\u610f\u4e49\u3002\u5728\u672c\u9898\u4e2d\uff0c\u8bbe$f(n)$\u8868\u793a\u89c4\u5b9a\u8303\u56f4\u5185$gcd=n$\u7684\u6570\u5bf9\u4e2a\u6570\uff0c$F(n)$\u8868\u793a\u89c4\u5b9a\u8303\u56f4\u5185\u516c\u7ea6\u6570\u5305\u62ec$n$\u7684\u6570\u5bf9\u4e2a\u6570\uff08\u5373$n|gcd$\u7684\u6570\u5bf9\u4e2a\u6570\uff09\n\n\u5728\u8fd9\u6837\u7684\u5047\u8bbe\u4e0b\uff0c\u6613\u77e5$$F(n)=\\sum\\limits_{n|d}f(d)$$\u610f\u4e49\u975e\u5e38\u663e\u7136\uff0c\u5c31\u662f\u6309\u7167\u5b9a\u4e49\u6765\u7684\n\n\u4e8e\u662f\u6839\u636e\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u7b2c\u4e8c\u4e2a\u516c\u5f0f\uff0c\u5982\u4e0b$$f(n)=\\sum\\limits_{n|d}\u03bc(\\dfrac{d}{n})F(d)$$\u4e8e\u662f\u53ea\u9700\u8981\u4e00\u4e2a\u80fd\u591f\u7b80\u4fbf\u6c42\u51fa$F$\u7684\u65b9\u6cd5\u5373\u53ef\n\n\u4e4b\u6240\u4ee5\u8981\u53cd\u6f14\uff0c\u662f\u56e0\u4e3a$F$\u6bd4$f$\u66f4\u597d\u6c42\u3002\u5206\u6790\u53d1\u73b0\uff0c$F$\u7684\u610f\u4e49\u5b9e\u9645\u4e0a\u5c31\u662f\u8981\u6c42\u6570\u5bf9$(a,b)$\u7684\u6570\u91cf\uff0c\u5176\u4e2d$n|a,n|b$\u3002\u6240\u4ee5$$F(n)=\\left \\lfloor \\dfrac{A}{n} \\right \\rfloor * \\left \\lfloor \\dfrac{B}{n} \\right \\rfloor$$\u56e0\u4e3a\u5728\u89c4\u5b9a\u8303\u56f4\u5185\uff0c\u524d\u8005\u6709$\\left \\lfloor \\dfrac{A}{n} \\right \\rfloor$\u4e2a$n$\u7684\u500d\u6570\uff0c\u540e\u8005\u6709$\\left \\lfloor \\dfrac{B}{n} \\right \\rfloor$\u4e2a$n$\u7684\u500d\u6570\u3002\u76f8\u4e58\u5373\u4e3a\u603b\u65b9\u6848\u6570\n\n\u6c42\u89e3\u51fa$F$\u4ee5\u540e\uff0c\u53ea\u9700\u8981\u7ebf\u6027\u7b5b$\u03bc$\uff0c\u6c42\u51fa$f(d)$\u5c31\u662f\u7b54\u6848\u4e86\n\n\u53e6\u5916\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u4e2a\u516c\u5f0f\u8c8c\u4f3c\u6ca1\u6709\u4e0a\u9650\u2026\u2026\u7136\u800c\u9898\u76ee\u7ed9\u4e86\u4e0a\u9650\u3002\u6211\u4eec\u7684$F$\u51fd\u6570\uff0c\u4e00\u65e6$n>A$\u6216$n>B$\u5c31\u4f1a\u53d8\u4e3a0\uff0c\u56e0\u6b64\u5e94\u5f53\u6ee1\u8db3$n \\leq Min\\{A,B\\}$\n\n\u8d34\u4e0a\u4e11\u964b\u7684\u4ee3\u7801\n```cpp\n/*By DennyQi 2018*/\n#include <cstdio>\n#include <queue>\n#include <cstring>\n#include <algorithm>\n#define  r  read()\nusing namespace std;\ntypedef long long ll;\n#define int long long\nconst int MAXN = 1000010;\nconst int INF = 1061109567;\ninline int Max(const int a, const int b){ return (a > b) ? a : b; }\ninline int Min(const int a, const int b){ return (a < b) ? a : b; }\ninline int read(){\n    int x = 0; int w = 1; register char c = getchar();\n    for(; c ^ '-' && (c < '0' || c > '9'); c = getchar());\n    if(c == '-') w = -1, c = getchar();\n    for(; c >= '0' && c <= '9'; c = getchar()) x = (x<<3) + (x<<1) + c - '0'; return x * w;\n}\nint A,B,d,tot,ans;\nint mu[MAXN],prime[MAXN],b[MAXN];\ninline void getMobius(){\n\tmu[1] = 1;\n\tfor(int i = 2; i <= Max(A,B); ++i){\n\t\tif(!b[i]){\n\t\t\tprime[++tot] = i;\n\t\t\tmu[i] = -1;\n\t\t}\n\t\tfor(int j = 1; j <= tot; ++j){\n\t\t\tif(i * prime[j] > Max(A,B)) break;\n\t\t\tb[i * prime[j]] = 1;\n\t\t\tif(i % prime[j] == 0){\n\t\t\t\tmu[i * prime[j]] = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmu[i * prime[j]] = -mu[i];\n\t\t}\n\t}\n}\ninline int F(int x){\n\treturn (A/x) * (B/x);\n}\n#undef int\nint main(){\n#define int long long\n\tA = r, B = r, d = r;\n\tgetMobius();\n\tfor(int i = d; i <= Min(A,B); i += d){\n\t\tans += mu[i/d] * F(i);\n\t}\n\tprintf(\"%lld\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1536410465,
        "uid": 115065,
        "name": "DennyQi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4450 \u3010\u53cc\u4eb2\u6570\u3011"
    },
    {
        "content": "## Description\uff1a\n>\u7ed9\u5b9a $A,B,d$ \uff0c\u6c42\u6ee1\u8db3$1\\le a\\le A,1\\le b\\le B $ \u4e14 $\\gcd(a,b)=d$ \u7684\u6570\u5bf9\u6570\n\n## Solution\n\u8003\u8651\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n\u539f\u5f0f\u53ef\u5316\u4e3a\n $$\\sum_{i=1}^A\\sum_{j=1}^B\\gcd(i,j)=d$$\n \n\u6839\u636e\u5957\u8def\uff0c\u6211\u4eec\u5148\u7ed9\u4e24\u8fb9\u9664\u4ee5 $d$,\u5316\u6210\n\n$$\\sum_{i=1}^{\\left\\lfloor\\tfrac A d\\right\\rfloor}\\sum_{j=1}^{\\left\\lfloor\\tfrac B d\\right\\rfloor}\\gcd(i,j)=1$$\n\u4e3a\u4ec0\u4e48\u8981\u5316\u6210\u8fd9\u4e2a\u5f62\u5f0f\u5462\uff1f\n\u56e0\u4e3a\u6839\u636e\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u7684\u6027\u8d28\n$$\\sum_{d\\mid n} \\mu(d) = [n=1]$$\n\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u5316\u6210\n$$\\sum_{i=1}^{\\left\\lfloor\\tfrac A d\\right\\rfloor}\\sum_{j=1}^{\\left\\lfloor\\tfrac B d\\right\\rfloor}\\sum_{k\\mid \\gcd(i,j)} \\mu(k) $$\n\n\u6211\u4eec\u8003\u8651\u4ea4\u6362\u679a\u4e3e\u987a\u5e8f\uff0c\u5148\u679a\u4e3e $d$\uff0c\u539f\u5f0f\u5c31\u53ef\u4ee5\u5316\u6210\n\n$$\\sum_{k=1}^{\\min(\\frac A d,\\frac B d)} \\mu(k)\\sum_{i=1}^{\\left\\lfloor\\tfrac A d\\right\\rfloor}\\sum_{j=1}^{\\left\\lfloor\\tfrac B d\\right\\rfloor} [k\\mid\\gcd(i,j)]$$\n\n$$\\sum_{k=1}^{\\min(\\frac A d,\\frac B d)}\\mu(k)\\left\\lfloor\\tfrac A {kd}\\right\\rfloor\\left\\lfloor\\tfrac B {kd}\\right\\rfloor$$\n\n\u5bf9\u4e8e\u8fd9\u4e2a\u5f0f\u5b50\uff0c$\\mu$ \u51fd\u6570\u53ef\u4ee5\u7ebf\u6027\u9884\u5904\u7406\uff0c\u5206\u6570\u53ef\u4ee5\u7528\u6574\u9664\u5206\u5757\u6765\u505a\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f$\\Theta(\\sqrt n)$\n## Code\n```cpp\n/*If you are full of hope,you will be invincible*/\n#include <ctime>\n#include <cstdio>\n#include <random>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\n#include<ext/pb_ds/assoc_container.hpp>\n#include<ext/pb_ds/hash_policy.hpp>\n#include<ext/pb_ds/priority_queue.hpp>\n#define ri register int\ntypedef long long ll;\nstd::mt19937 hpy(time(nullptr)+(unsigned long long)(new char));\nnamespace IO{\n\tconstexpr int HL=1<<20;\n\tchar buf[HL],*t1=buf,*t2=buf;\n\t#ifndef ONLINE_JUDGE\n\t#define getc() getchar()\n\t#else\n\t#define getc() t1==t2&&(t2=(t1=buf)+fread(buf,1,HL,stdin),t1==t2)?EOF:*t1++\n\t#endif\n\tinline int read(){static int an,f;an = 0,f = 1;static char ch;ch=getc();\n\twhile(!isdigit(ch))ch=='-'?f=-1:1,ch=getc();\n\twhile(isdigit(ch))an=(an<<3)+(an<<1)+(ch^48),ch=getc();\n\treturn an*f;}\n\tchar buff[HL],*T=buff;\n\tvoid flush(){fwrite(buff,1,T-buff,stdout);T=buff;}\n\tinline void putc(char ch){if(T==buff+HL)flush();*T++=ch;}\n\ttemplate<typename Tp>\n\tinline void print(Tp x){if(x<0)putc('-'),x=-x;if(!x)return putc('0'),void();\n\tstatic int st[20],tp;while(x)st[++tp]=x%10,x/=10;while(tp)putc(st[tp]^48),--tp;}\n}\nusing IO::read;\nusing IO::print;\nusing IO::putc;\nconstexpr int inf = 0x3f3f3f3f,N = 1e6 + 10;\nint vis[N],n,m,cnt;\nll pri[N],sum[N],mu[N];\ninline void Sieve() {\n\tmu[1] = 1;\n\tfor(ri i = 2;i <= N;++i) {\n\t\tif(!vis[i]) vis[i] = 1,pri[++cnt] = i,mu[i] = -1; \n\t\tfor(ri j = 1;j <= cnt && i*pri[j] <= N;++j) {\n\t\t\tvis[i*pri[j]] = 1;\n\t\t\tif(i%pri[j] == 0) break;\n\t\t\tmu[i*pri[j]] = -mu[i];\n\t\t}\n\t}//\u7ebf\u6027\u7b5b\u03bc\n\tfor(ri i = 1;i <= N;++i) sum[i] = mu[i] + sum[i-1];//\u7528\u524d\u7f00\u548c\u5904\u7406 \n}\nll Solve(int a,int b,int d){\n\tint mx = std::min(a,b);\n\tll ans = 0;\n\tfor(ri l = 1,r;l <= mx;l = r + 1) {//\u6574\u9664\u5206\u5757\n\t\tr = std::min(a/(a/l),b/(b/l));\n\t\tans += (sum[r]-sum[l-1])*(1ll*a/(1ll*l*d)) * (1ll*b/(1ll*l*d));\n\t}\n\treturn ans;\n}\nint main() {\n\tSieve();\n\tint a=read(),b=read(),d=read();\n\tprint(Solve(a,b,d));\n    return IO::flush(),0;\n}\n```\n",
        "postTime": 1614676010,
        "uid": 413147,
        "name": "_Alejandro_",
        "ccfLevel": 0,
        "title": "P4450\u9898\u89e3"
    },
    {
        "content": "\u83ab\u53cd\u677f\u5b50\u9898\n\n\u5148\u628a\u539f\u5f0f\u5316\u6210\u597d\u63a8\u4e00\u70b9\u7684\u5f0f\u5b50\uff1a\n\n$$\\sum_{i=1}^A\\sum_{j=1}^B[gcd(i, j) =D]=\\sum_{i=1}^{\\lfloor{A\\over D}\\rfloor}\\sum_{j=1}^{\\lfloor{B\\over D}\\rfloor}[gcd(i,j)=1]$$\n\n\u6211\u4eec\u8bbe\uff1a$n=\\lfloor{A\\over D}\\rfloor,m=\\lfloor{B\\over D}\\rfloor$\n\n\u6ce8\u610f\u5230$\\mu$\u51fd\u6570\u6709\u4e2a\u6027\u8d28\uff1a\n\n$$\\sum_{d|n}\\mu(d)=[n=1]$$\n\n\u8bc1\u660e\uff1a\n\n\u8bbe\uff1a\n\n$$n=\\prod_{i=1}^m p_i^{a_i}$$\n\n\u6211\u4eec\u53ea\u7528\u8003\u8651$n$\u6709\u5e73\u65b9\u56e0\u5b50\u7684\u56e0\u5b50\uff08\u56e0\u4e3a\u82e5\u4e00\u4e2a\u6570\u6ca1\u6709\u5e73\u65b9\u56e0\u5b50\u5219$\\mu$\u51fd\u6570\u7684\u503c\u4e3a0\uff09\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u7684\u56e0\u5b50$d$\u7684\u53d6\u503c\u8303\u56f4\u4e3a\uff1a\n\n$$\\prod_{i=1}^m p_i^{b_i}\\space\\space\\space\\space\\space\\space(b_i=0/1)$$\n\n\u663e\u7136\u6709$2^m$\u79cd\u60c5\u51b5\uff0c\u60f3\u8981\u8fd9$2^m$\u79cd\u60c5\u51b5\u548c\u4e3a0\uff0c\u5fc5\u987b\u4f7f$b_i$\u4e4b\u548c\u4e3a\u5947\u7684\u60c5\u51b5\u548c\u4e3a\u5076\u7684\u60c5\u51b5\u7684\u6570\u91cf\u76f8\u7b49\u3002\n\n\u7531\u6768\u8f89\u4e09\u89d2\u7684\u5bf9\u79f0\u6027\u53ef\u5f97\uff0c\u5f53$m$\u4e3a\u5947\u6570\u65f6\uff0c\u7ed3\u8bba\u4e00\u5b9a\u6210\u7acb\u3002\n\n\u800c$m$\u4e3a\u5076\u6570\u65f6\uff1a\n\n\u548c\u4e3a\u5947\u7684\u6570\u91cf\u4e3a\uff1a\n\n$$\\sum_{i=0}^{\\lfloor{m-1\\over2}\\rfloor} C_{2i+1}^m$$\n\n\u5b83\u521a\u597d\u7b49\u4e8e\u4e0a\u4e00\u6392\u6768\u8f89\u4e09\u89d2\u7684\u548c\uff08\u7531\u6768\u8f89\u4e09\u89d2\u5b9a\u4e49\u53ef\u77e5\uff09\uff0c\u4e5f\u5c31\u662f$2^{m-1}$\uff0c\u6070\u597d\u662f$2^m$\u7684\u4e00\u534a\uff0c\u4e5f\u5c31\u662f\u548c\u548c\u4e3a\u5076\u6570\u7684\u60c5\u51b5\u6570\u91cf\u76f8\u7b49\u3002\n\n\u6ce8\u610f\u5f53$n=1$\u65f6\uff0c\u4e0d\u80fd\u88ab\u5206\u89e3\uff0c\u539f\u5f0f\u7684\u503c\u4e3a1\n\n\u8bc1\u6bd5\n\n\u56de\u5230\u9898\u76ee\uff0c\u4e0a\u9762\u7684\u5f0f\u5b50\u6839\u636e\u8fd9\u4e2a\u7ed3\u8bba\u5c31\u53ef\u4ee5\u5199\u6210\uff1a\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{m}[gcd(i,j)=1]=\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{d|gcd(i,j)}\\mu(d)$$\n\n$$=\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{d|i,d|j}\\mu(d)$$\n\n\u6211\u4eec\u6362\u4e2a\u679a\u4e3e\u7684\u987a\u5e8f\uff0c\u5148\u679a\u4e3e$d$:\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{d|i,d|j}\\mu(d)=\\sum_{d=1}^{\\min(n,m)}\\sum_{d|i}^n\\sum_{d|j}^m\\mu(d)$$\n\n$$=\\sum_{d=1}^{\\min(n,m)}\\lfloor{n\\over d}\\rfloor\\lfloor{m\\over d}\\rfloor\\mu(d)$$\n\n\u4e0a\u9762\u7684\u5f0f\u5b50\u663e\u7136\u53ef\u4ee5$\\Theta(n)$\u6c42\u51fa\uff0c\u6574\u9664\u5206\u5757\u53ef\u4ee5\u5230$\\Theta(\\sqrt{n})$\uff0c\u4e0d\u8fc7\u6570\u636e\u53ea\u6709$1e6$\uff0c\u6ca1\u6709\u5fc5\u8981\u3002\u8bb0\u5f97\u5f00long long\n\nCode :\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\n\nusing namespace std;\n\nint A, B, d, n, m, mu[1000005], prime[1000005], top = 0;\nbool notprime[1000005];\nlong long ans = 0;\n\ninline int min_(int a, int b) {\n\treturn a < b ? a : b;\n}\n\nint main() {\n\tmu[1] = 1;\n    for (register int i = 2; i <= 1000000; ++i) {  \n        if (!notprime[i]) prime[++top] = i, mu[i] = -1;\n        for (register int j = 1; j <= top; ++j) {  \n            if (i * prime[j] > 1000000) break;  \n            notprime[i * prime[j]] = 1;\n            if (!(i % prime[j])) {  \n                mu[i * prime[j]] = 0;\n                break;  \n            } else mu[i * prime[j]] = -1 * mu[i];\n        } \n    }\n    scanf(\"%d%d%d\", &A, &B, &d);\n    n = A / d; m = B / d;\n    for (int i = 1; i <= min_(n, m); ++i) ans += 1ll * mu[i] * (n / i) * (m / i);\n    printf(\"%lld\", ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1591432917,
        "uid": 98096,
        "name": "Smallbasic",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4450 \u3010\u53cc\u4eb2\u6570\u3011"
    },
    {
        "content": "## \u524d\u8a00\n\n\u9898\u89e3\u533a\u4f3c\u4e4e\u6240\u6709\u7684\u9898\u89e3\u90fd\u662f\u7528\u83ab\u53cd\u505a\u7684\uff0c\u4f46\u662f\uff0c\u8fd9\u6839\u672c\u4e0d\u9700\u8981\u3002\n\n\u6211\u6765\u4ecb\u7ecd\u4e00\u4e0b\u4e0d\u7528\u83ab\u53cd\u7684\u505a\u6cd5\u3002\n\n## \u9898\u89e3\n\n\u5b9a\u4e49 $s_{i}$ \u4e3a\u5728 $d=i$ \u65f6\u7684\u7b54\u6848\u3002\n\n\u5047\u5982\u8981\u6c42\u662f\u6700\u5927\u516c\u7ea6\u6570\u662f $d$ \u7684\u500d\u6570\uff0c\u7b54\u6848\u663e\u7136\u5c31\u662f $\\left\\lfloor\\dfrac{A}{d}\\right\\rfloor\\cdot\\left\\lfloor\\dfrac{B}{d}\\right\\rfloor$\n\n\u73b0\u5728\u7684\u8981\u6c42\u662f\u6700\u5927\u516c\u7ea6\u6570\u6070\u597d\u662f $d$\uff0c\u6240\u4ee5\u53ea\u8981\u628a\u6700\u5927\u516c\u7ea6\u6570\u662f $2d,3d,\\cdots$ \u65f6\u7684\u7b54\u6848\u51cf\u53bb\u3002\n\n\u4e8e\u662f\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u9012\u63a8\u5f0f $s_{i}=\\left\\lfloor\\dfrac{A}{i}\\right\\rfloor\\cdot\\left\\lfloor\\dfrac{B}{i}\\right\\rfloor-\\sum\\limits_{i|t,t<i,t\\leq A,t\\leq B}s_{t}$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u76f4\u63a5\u5c31\u80fd\u7b97\u4e86\uff01\n\n\u64cd\u4f5c\u6b21\u6570\u5927\u6982\u662f $N\\sum\\limits_{i=1}^{N}\\left\\lfloor\\dfrac{N}{i}\\right\\rfloor$ \u8fd9\u4e2a\u91cf\u7ea7\uff0c\u5176\u4e2d $N=\\dfrac{\\min\\left\\{A,B\\right\\}}{d}$\uff0c\u5728 $N=10^{6}$ \u65f6\u662f $10^{7}$ \u591a\u4e00\u70b9\uff0c\u800c\u4e14 $d$ \u7a0d\u5fae\u5927\u4e00\u70b9\u5c31\u4f1a\u5f88\u5c0f\uff0c\u5b8c\u5168\u80fd\u8fc7\u3002\n\n### \u4ee3\u7801\n\n``` cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint a,b,d;\nlong long t[1000005];\nint main() {\n\tscanf(\"%d%d%d\",&a,&b,&d);\n\tfor(int i=min(a,b)/d*d;i>=d;i-=d) {\n\t\tt[i]=1ll*(a/i)*(b/i);\n\t\tfor(int j=i+i;j<=a&&j<=b;j+=i) t[i]-=t[j];\n\t}\n\tprintf(\"%lld\",t[d]);\n\treturn 0;\n}\n```\n\n\u5982\u679c\u7528\u6574\u9664\u5206\u5757\u6765\u4f18\u5316\u7684\u8bdd\u53ef\u4ee5\u505a\u5230 $O(n)$\uff0c\u4f46\u662f\u8fd9\u4e2a\u505a\u6cd5\u662f\u6ca1\u6cd5\u901a\u8fc7\u90a3\u51e0\u9053\u548c\u8fd9\u9898\u7c7b\u4f3c\u4f46\u662f\u8981\u591a\u6d4b\u7684\u9898\uff0c\u90a3\u51e0\u9053\u8fd8\u662f\u5f97\u7528\u83ab\u53cd\u3002\n\n\u4e0d\u77e5\u9053\u6709\u6ca1\u6709\u66f4\u597d\u7684\u4f18\u5316\uff0c\u5982\u679c\u6709\u7684\u8bdd\u90a3\u51e0\u9053\u8bf4\u4e0d\u5b9a\u80fd\u505a\u3002\n\n### \u4f18\u5316\u540e\u7684\u4ee3\u7801\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nint a,b,d;\nlong long t[1000005];\nint main() {\n\tscanf(\"%d%d%d\",&a,&b,&d);\n\ta/=d,b/=d;\n\tfor(int i=min(a,b);i>=1;i=max(a/(a/i+1),b/(b/i+1))) {\n\t\tt[i]=1ll*(a/i)*(b/i);\n\t\tint tmp=i;\n\t\tfor(int j=i*2;j<=a&&j<=b;j+=i) j=min(a/(a/j),b/(b/j))/i*i,t[i]-=(j-tmp)/i*t[min(a/(a/j),b/(b/j))],tmp=j;\n\t}\n\tprintf(\"%lld\\n\",t[1]);\n\treturn 0;\n}\n```\n\nupdate on 2022.05.21: \u6dfb\u52a0\u4e86\u6574\u9664\u5206\u5757\u7684\u4f18\u5316",
        "postTime": 1653059408,
        "uid": 369836,
        "name": "\u9cb6\u9c7c\u7684\u5fe0\u5b9e\u7c89",
        "ccfLevel": 7,
        "title": "P4450"
    },
    {
        "content": "\u771f\u00b7\u7b2c\u4e00\u9053\u81ea\u5df1\u505a\u51fa\u6765\u7684\u83ab\u53cd\u9898\n\n\u770b\u5b8c\u9898\u76ee\uff0c\u5c31\u77e5\u9053\u4e86\u662f\u8981\u6c42\u8fd9\u4e2a\u5f0f\u5b50\n$$\\sum_{a=1}^A\\sum_{b=1}^B\\ [gcd(a,b)=d]$$\n\n\u8003\u8651\u83ab\u53cd\uff0c\u8bbe$f(x)=\\begin{cases}\\ 1&(x=d)&\\\\\\ 0&(x\\ne d)&\\end{cases}$\n\n\u90a3\u4e48\u6211\u4eec\u8981\u627e\u5230\u4e00\u4e2a$g$\u4f7f\u5f97$f=g*1$\uff0c\u5373$f(x)=\\sum_{k|x}g(x)$\uff0c\u56e0\u4e3a$1$\u7684\u9006\u662f$\\mu$\uff0c\u6240\u4ee5$g=f*\\mu$\n\n$$g(x)=\\sum_{k|x}\\mu(\\frac{x}{k})[k=d]$$\n$$g(x)=\\mu(\\frac{x}{d})[d|x]$$\n\n\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u6c42\u51fa\u6765$g$\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5bf9\u5f0f\u5b50\u8fdb\u884c\u5316\u7b80\u4e86\n$$\\sum_{a=1}^A\\sum_{b=1}^B\\ f(gcd(a,b))$$\n$$\\sum_{a=1}^A\\sum_{b=1}^B\\sum_{k|a,k|b}\\ g(k)$$\n$$\\sum_{k=1}^{min(A,B)}g(k)\\ \\sum_{a=1}^A\\sum_{b=1}^B\\ [k|a]\\ [k|b]$$\n$$\\sum_{k=1}^{min(A,B)}g(k)\\ \\lfloor\\frac{A}{k}\\rfloor\\ \\lfloor\\frac{B}{k}\\rfloor$$\n\n\u7136\u540e\u5bf9\u8fd9\u4e2a\u5f0f\u5b50\u6574\u9664\u5206\u5757\u5c31\u53ef\u4ee5\u4e86\n\n\u81f3\u4e8e$g$\u600e\u4e48\u6c42\uff0c\u6211\u4eec\u628a$\\mu$\u7b5b\u51fa\u6765\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u6c42\u6bcf\u4e2a$g(x)$\uff0c\u518d\u505a\u4e00\u4e2a\u524d\u7f00\u548c\u5c31\u53ef\u4ee5$O(1)$\u8be2\u95ee\u533a\u95f4$g$\u7684\u548c\u4e86\n\n**Code**\n``` cpp\n#include <iostream>\n#include <cstdio>\n#define N 1000000\nusing namespace std;\nint a,b,d,mul[N+5],v[N+5],prime[N+5],cnt,g[N+5],sg[N+5];\nlong long ans;\nvoid make()\n{\n\tmul[1]=1;v[1]=1;\n\tfor (int i=2;i<=N;i++)       //\u7ebf\u7b5b\u7b5b\u03bc\n\t{\n\t\tif (!v[i])\n\t\t{\n\t\t\tprime[++cnt]=i;\n\t\t\tmul[i]=-1;\n\t\t}\n\t\tfor (int j=1;j<=cnt&&i*prime[j]<=N;j++)\n\t\t{\n\t\t\tv[prime[j]*i]=1;\n\t\t\tif (i%prime[j]!=0)mul[i*prime[j]]=-mul[i];\n\t\t\telse\n\t\t\t{\n\t\t\t\tmul[i*prime[j]]=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i=1;i<=N;i++)     //\u5904\u7406g\u51fd\u6570\n\t\tif (i%d==0)\n\t\t\tg[i]=mul[i/d];\n\tfor (int i=1;i<=N;i++)    //\u524d\u7f00\u548c\n\t\tsg[i]=sg[i-1]+g[i];\n}\nint main()\n{\n\tcin>>a>>b>>d;\n\tmake();\n\tif (a>b)swap(a,b);\n\tfor (int l=1,r;l<=a;l=r+1)     \u6574\u9664\u5206\u5757\n\t{\n\t\tr=min(a/(a/l),b/(b/l));\n\t\tans+=(sg[r]-sg[l-1])*1LL*(a/l)*1LL*(b/l)*1LL;\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```\n\u5e38\u6570\u5927\uff0c\u4ee3\u7801\u4e11(\u256f\ufe35\u2570)",
        "postTime": 1562739132,
        "uid": 73231,
        "name": "eee_hoho",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4450 \u3010\u53cc\u4eb2\u6570\u3011"
    },
    {
        "content": "~~\u8fd9\u9053\u9898\u4e0d\u5c31\u662fZAP-Queries\u7684\u5f31\u5316\u7248\u5417\uff0c\u8fde\u6574\u9664\u5206\u5757\u90fd\u4e0d\u9700\u8981~~\n\n\u4f5c\u4e3a\u4e00\u9053\u83ab\u53cd\u7684\u57fa\u7840\u9898\uff0c\u73b0\u5728\u6765\u8bb2\u89e3\u4e00\u4e0b\u4ec0\u4e48\u662f\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n\n\u82e5\u4e24\u4e2a\u6570\u8bba\u51fd\u6570$ f(n),g(n) $\uff0c\u6ee1\u8db3\n\n$$\nf(n)=\\sum_{n|d}g(d)\n$$\n\n\u5219\u6709\n\n$$\ng(n)=\\sum_{n|d}\\mu(d)f(\\frac{d}{n})\n$$\n\n\u5176\u4e2d\u5f53$ p=p1p2......p_k $\u5176\u4e2d$ p_1......p_k $\u662f\u4e24\u4e24\u4e0d\u540c\u7684\u8d28\u6570\u65f6$ \\mu(n)=(-1)^k $\uff0c\u5426\u5219$ \\mu(n)=0 $\u3002\n\n\u7279\u522b\u7684\uff0c$ \\mu(1)=1 $\u3002\n\n\u7531\u4e8e$ \\mu $\u662f\u4e2a\u79ef\u6027\u51fd\u6570\uff0c\u6240\u4ee5\u53ef\u4ee5\u7ebf\u6027\u7b5b\u3002\n\n\u597d\u73b0\u5728\u8ba9\u6211\u4eec\u770b\u5230\u9898\u76ee\u3002\n\n\u4ee4$ A'=\\lfloor\\frac{A}{d}\\rfloor $\uff0c$ B'=\\lfloor \\frac{B}{d}\\rfloor $\n\n\u5219\u6709\u7b54\u6848\u4e3a\n\n$$\n\\sum_{i=1}^{A'}\\sum_{j=1}^{B'}[\\gcd(i,j)=1]\n$$\n\n\u73b0\u5728\u4ee4\n$$\nf(i)=\\sum_{i=1}^{A'}\\sum_{j=1}^{B'}[\\gcd(i,j)=i]\n$$\n$$\n\ng(i)=\\lfloor \\frac{A'}{i} \\rfloor\\lfloor \\frac{B'}{i} \\rfloor\n$$\n\u5219\u663e\u7136\u6709\n\n$$\ng(n)=\\sum_{n|d}f(d)\n$$\n\n\u6240\u4ee5\n\n$$\nf(n)=\\sum_{n|d}\\mu(d)g(\\frac{d}{n})\n$$\n\n\u6240\u4ee5\n\n$$\nAns=f(1)=\\sum_{i=1}^{\\min(A',B')}\\mu(i)\\lfloor \\frac{A'}{i} \\rfloor\\lfloor \\frac{B'}{i} \\rfloor\n$$\n\n\u5199\u5230\u8fd9\u91cc\u5c31\u5dee\u4e0d\u591a\u4e86\n\n\u8fd9\u9898\u56e0\u4e3a\u662f\u5355\u6b21\u8be2\u95ee\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u6574\u9664\u5206\u5757$ O(\\sqrt n) $\n\n\u5b8c\u6574\u4ee3\u7801\u5c31\u4e0d\u7ed9\u4e86\uff0c\u7ed9\u4e00\u4e0b\u7ebf\u6027\u7b5b$ \\mu $\u7684\u4ee3\u7801\n```cpp\nfor(int i=2;i<=1000000;i++){\n\tif(!check[i]){\n\t\tprime[tot++]=i;\n\t\tmiu[i]=-1;\n\t}\n\tfor(int j=0;j<tot&&i*prime[j]<=1000000;j++){\n\t\tcheck[i*prime[j]]=1;\n\t\tif(i%prime[j]==0){\n\t\t\tmiu[i*prime[j]]=0;\n\t\t\tbreak;\n\t\t}\n\t\tmiu[i*prime[j]]=-miu[i];\n\t}\n}\n```\n",
        "postTime": 1611563844,
        "uid": 289230,
        "name": "ricky0916",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4450 \u3010\u53cc\u4eb2\u6570\u3011"
    },
    {
        "content": "# \u9898\u89e3\n\n\u524d\u8a00$:$\u4f60\u8981\u662f\u4e0d\u4f1a\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u53ef\u4ee5\u770b\u4e00\u4e0b\u8fd9\u7bc7[$blog$](https://www.luogu.com.cn/blog/QWQdeta/mu-bi-wu-si-fan-yan)\n\n## \u672c\u9898\u6c42 $\\sum\\limits_{i=1}^A\\sum\\limits_{j=1}^B[gcd(i,j)==d]$\n\n### \u5148\u63d0\u51fa\u6765\n\n$=\\sum\\limits_{i=1}^{[\\frac{A}{d}]}\\sum\\limits_{j=1}^{[\\frac{B}{d}]}[gcd(i,j)==1]$\n\n$=\\sum\\limits_{i=1}^{[\\frac{A}{d}]}\\sum\\limits_{j=1}^{[\\frac{B}{d}]}\\sum\\limits_{k|gcd(i,j)}\\mu(k)$\n\n$=\\sum\\limits_{i=1}^{[\\frac{A}{d}]}\\sum\\limits_{j=1}^{[\\frac{B}{d}]}\\sum\\limits_{k|i}\\sum\\limits_{k|j}\\mu(k)$\n\n\u679a\u4e3e$k,$\u9ed8\u8ba4$A \\geqslant B$\n\n$=\\sum\\limits_{k=1}^{[\\frac{A}{d}]}\\mu(k)\\sum\\limits_{i=1}^{[\\frac{A}{dk}]}\\sum\\limits_{j=1}^{[\\frac{B}{dk}]}1$\n\n$=\\sum\\limits_{k=1}^{[\\frac{A}{d}]}\\mu(k)[\\frac{A}{dk}][\\frac{B}{dk}]$\n\n\u540e\u9762\u8fd9\u4e00\u5768\u505a\u6574\u9664\u5206\u5757\u5c31\u5b8c\u4e8b\u4e86\n\n\u672c\u849f\u84bb\u7684\u4ee3\u7801$:$\n\n```cpp\n#include<iostream>\n#include <cstdio>\n#include<cmath>\nusing namespace std;\nconst int N = 1000005;\nbool fi[1000010];\nlong long coot=0,prime[1000010],mu[1000010];\nlong long A,B,D;\nvoid init(){\n\tmu[1]=1;\n\tfor(long long i = 2;i <= N;i++){\n\t\tif(!fi[i])\n\t\t\tprime[++coot]=i,mu[i]=-1;\n\t\tfor(long long j = 1;j <= coot&&i*prime[j]<=N;j++){\n\t\t\tint k= i*prime[j];\n\t\t\tfi[k]=true;\n\t\t\tif(i%prime[j]==0){\n\t\t\t\tmu[k]=0;\n\t\t\t\tbreak;\t\n\t\t\t}else{\n\t\t\t\tmu[k]=-mu[i];\n\t\t\t} \n\t\t}\n\t}\n\tfor(int m = 2;m <= N;m++) mu[m] += mu[m-1];\n}\nlong long work(long long a,long long b){\n\tlong long ans=0;\n\tlong long s=min(a,b);\n\tfor(long long left=1;left<=s;){\n\t\tlong long right=min(a/(a/left),b/(b/left));\n\t\tans+=(mu[right]-mu[left-1])*(a/left)*(b/left);\n\t\tleft=right+1;\n\t}\n\treturn ans;\n} \nint main(){\n\tinit();\n\tscanf(\"%lld %lld %lld\",&A,&B,&D);\n\tA/=D;\n\tB/=D;\n\tprintf(\"%lld\\n\",work(A,B));\n\treturn 0;\n}\n```\n\u5b8c\u7ed3\u6492\u82b1$,$\u7ba1\u7406\u5458\u5927\u5927\u8ba9\u6211\u8fc7\u5427$QwQ$",
        "postTime": 1609326045,
        "uid": 436389,
        "name": "Vidoliga",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4450"
    },
    {
        "content": "\u4eba\u751f\u7b2c\u4e00\u9053\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u9898\uff0c\u5199\u5199\u9898\u89e3\u5427\n\n\u5982\u679cmarkdown\u6709\u9505\u8bf7\u79fb\u6b65\u81f3[\u8fd9\u91cc](https://beyondmyself.blog.luogu.org/ti-xie-p4450-shuang-qing-shuo-post)\n\n\u5b9a\u4e49\n\n\u9898\u76ee\u8ba9\u6211\u4eec\u6c42\n\n$$\n\\sum_{a=1}^{A}\\sum_{b=1}^{B}[\\gcd(a\\in A,b\\in B)=d]\n$$\n\n\u663e\u7136\uff0c\u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u65b9\u5f0f\u6765\u6c42\u51fa\u8fd9\u4e2a\u5f0f\u5b50\n\n\u6211\u4eec\u53ef\u4ee5\u8bb0\n\n$$\nf(x)=\\begin{cases}1\\ \\ \\ (x=d)\\\\\\\\ 0\\ \\ \\ (x\\ne d)\\end{cases}\n$$\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u9700\u8981\u627e\u5230$g$\u4e14$f=g\\times 1$\uff0c\u5373\n\n$$\nf(x)=\\sum_{k\\mid x}g(x)\n$$\n\n\u53c8\u56e0\u4e3a1\u7684\u9006\u4e3a$\\mu$\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f97\u51fa\u4ee5\u4e0b\u7ed3\u8bba\n\n$$\n\\begin{cases}g=f\\times\\mu\\\\\n\\\\\n\\displaystyle\n\\displaystyle g(x)=\\sum_{k\\mid x}\\mu(\\frac{x}{k})[k=d]\\\\\n\\displaystyle g(x)=\\mu(\\frac{x}{d})[d\\mid x]\\end{cases}\n$$\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5316\u7b80\u5f97\u5230\u4ee5\u4e0b\u7684\u5f0f\u5b50\n\n$$\n\\sum_{k=1}^{\\min(A,B)}g(k)\\lfloor \\frac{A}{k}\\rfloor\\times \\lfloor\\frac{B}{k}\\rfloor\n$$\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u6570\u8bba\u5206\u5757\u7684\u65b9\u6cd5\u6c42\u51fa\u8fd9\u4e2a\u5f0f\u5b50\u4e86\n\n\u81f3\u4e8e$g$\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u7ebf\u6027\u7b5b\u628a$\\mu$\u7b5b\u51fa\u6765\uff0c\u518d\u524d\u7f00\u548c\u5373\u53ef\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <algorithm>\n#include <cstring>\n#include <queue>\n#include <cmath>\n#define int long long\n\nusing namespace std;\n\nnamespace MAIN {\n    const int SIZE = 1000000 + 5;\n    int a, b, d, tot, ans, primes[SIZE];\n    int Mobius[SIZE], tag[SIZE];\n\n    inline void MAIN() {\n        scanf(\"%lld %lld %lld\", &a, &b, &d);\n        Mobius[1] = 1;\n        for (int i = 2; i <= max(a, b); ++i) { // \u7ebf\u6027\u7b5b\n            if (!tag[i]) primes[++tot] = i, Mobius[i] = -1;\n            for (int j = 1; j <= tot; ++j) {\n                if (i * primes[j] > max(a, b)) break;\n                tag[i * primes[j]] = 1;\n                if (!(i % primes[j])) {\n                    Mobius[i * primes[j]] = 0;\n                    break;\n                }\n                Mobius[i * primes[j]] = -Mobius[i];\n            }\n        }\n        for (int i = d; i <= min(a, b); i += d) ans += Mobius[i / d] * (a / i) * (b / i);\n        printf(\"%lld\\n\", ans);\n    }\n} // namespace MAIN\n\nsigned main() {\n    MAIN::MAIN();\n}\n```",
        "postTime": 1578820775,
        "uid": 161849,
        "name": "cirnovsky",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4450 \u3010\u53cc\u4eb2\u6570\u3011"
    },
    {
        "content": "\u663e\u7136\uff0c\u9898\u76ee\u6c42\u7684\u662f\uff1a\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m[gcd(i,j)=d]$$\n\n$$\\sum_{i=1}^{ \\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor}[gcd(i,j)=1] $$\n\n\u6709\u4e00\u4e2a\u4e0e\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u6709\u5173\u7684\u6027\u8d28\uff1a$\\sum_{d | n}\\mu(d)=[n=1]$\n\n$$\\sum_{i=1}^{ \\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor}\\sum_{k|gcd(i,j)}\\mu(k)$$\n\n\u5c06 $k$ \u5f80\u524d\u79fb\uff0c\u7136\u540e\u662f\u4e00\u4e2a\u975e\u5e38\u7ecf\u5178\u7684\u5f0f\u5b50\u4e86\n\n$$\\sum_{k=1}^{min(\\lfloor \\frac{n}{d} \\rfloor,\\lfloor \\frac{m}{d} \\rfloor)}\\mu(k)\\lfloor \\frac{n}{kd} \\rfloor \\lfloor \\frac{m}{kd} \\rfloor$$\n\n\u7528\u6570\u8bba\u5206\u5757\u5373\u53ef\u89e3\u51b3\u3002\n\n\n```cpp\n#include <cstdio>\n#include <iostream>\nusing namespace std;\n\nconst int MAXN = 1000000;\nint a , b , d , k , prime[ MAXN + 5 ] , mu[ MAXN + 5 ] , f[ MAXN + 5 ];\nbool vis[ MAXN + 5 ];\nvoid sieve( ) {\n\tmu[ 1 ] = 1;\n\tfor( int i = 2 ; i <= MAXN ; i ++ ) {\n\t\tif( !vis[ i ] ) {\n\t\t\tprime[ ++ k ] = i;\n\t\t\tmu[ i ] = -1;\n\t\t}\n\t\tfor( int j = 1 ; j <= k && 1ll * i * prime[ j ] <= MAXN ; j ++ ) {\n\t\t\tvis[ i * prime[ j ] ] = 1;\n\t\t\tif( i % prime[ j ] == 0 ) break;\n\t\t\tmu[ i * prime[ j ] ] = -mu[ i ];\n\t\t}\n\t}\n    for( int i = 1 ; i <= MAXN ; i ++ )\n        f[ i ] = f[ i - 1 ] + mu[ i ];\n}\n\nlong long solve( int n , int m , int k ) {\n    int d = min( n , m ); long long Ans = 0;\n    for( int l = 1 , r ; l <= d ; l = r + 1 ) {\n        r = min( n / ( n / l ) , m / ( m / l ) );\n        Ans = Ans + 1ll * ( f[ r ] - f[ l - 1 ] ) * ( n / k / l ) * ( m / k / l );\n    }\n    return Ans;\n}\n\nint main( ) {\n    sieve( );\n    scanf(\"%d %d %d\",&a,&b,&d);\n    printf(\"%lld\",solve( a , b , d ));\n    return 0;\n}\n```\n",
        "postTime": 1572079484,
        "uid": 123802,
        "name": "chihik",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4450 \u3010\u53cc\u4eb2\u6570\u3011"
    },
    {
        "content": "\u4e00\u4e2a\u6b63\u5e38\u7684\u83ab\u6bd4\u4e4c\u65af\u5e94\u7528\n\n\u6211\u4eec\u4ee4\n\n$f(d) = \\sum_{i = 1}^{n}\\sum_{j = 1}^{m}[\\gcd(i, j) = d]$\n$F(n) = \\sum_{n \\mid d}f(d) = \\lfloor{\\frac{A}{n}}\\rfloor * \\lfloor{\\frac{B}{n}}\\rfloor$\n\n\u6839\u636e\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u6211\u4eec\u6709:\n\n$f(k) = \\sum_{k \\mid d}\\mu(\\frac{d}{k})*F(d)=\\sum_{k \\mid d}\\mu(\\frac{d}{k})\\lfloor{\\frac{A}{d}}\\rfloor * \\lfloor{\\frac{B}{d}}\\rfloor$\n\n\u6211\u4eec\u5148\u7528d\u66ff\u6362\u6389\n\n$\\frac{d}{k}$\n$f(k) = \\sum_{d = 1}^{\\min(\\frac{A}{k}, \\frac{B}{k})}\\mu(d)\\lfloor{\\frac{A}{dk}}\\rfloor * \\lfloor{\\frac{B}{dk}}\\rfloor$\n\n\u7136\u540e\u6211\u4eec\u5728\u7528T\u66ff\u6362dk\n\n$f(k) = \\sum_{T = 1}^{\\min(A, B)}\\mu(\\frac{T}{k})\\lfloor{\\frac{A}{T}}\\rfloor * \\lfloor{\\frac{B}{T}}\\rfloor \\qquad(k \\mid T)$\n\n\u8fd9\u6837\u5bf9\u4e8e$\\mu(\\frac{T}{k})$\u6211\u4eec\u53ef\u4ee5\u524d\u7f00\u548c\u5904\u7406\uff0c\u6ce8\u610fk\u6574\u9664T\n\n```\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\nconst int N = 1e6 + 5;\ntemplate <typename T>\nvoid out(T x) { cout << x << endl; }\nll fast_pow(ll a, ll b, ll p) {ll c = 1; while(b) { if(b & 1) c = c * a % p; a = a * a % p; b >>= 1;} return c;}\nint mu[N], prime[N], tot;\nll sum[N];\nbool mark[N];\nvoid get_mu()//\u7ebf\u6027\u7b5b\n{\n    memset(mark, false, sizeof(mark));\n    memset(mu, 0, sizeof(mu));\n    tot = 0;\n    mark[1] = mark[0] = true;\n    mu[1] = 1;\n    for(int i = 2; i < N; i ++)\n    {\n        if(!mark[i])\n        {\n            prime[tot ++] = i;\n            mu[i] = -1;\n        }\n        for(int j = 0; j < tot && i * prime[j] < N; j ++)\n        {\n            mark[i * prime[j]] = true;\n            if(i % prime[j] == 0)\n                break;\n            else \n                mu[i * prime[j]] = -mu[i];\n        }\n    }\n}\nll cal(ll a, ll b, ll k)//\u5206\u5757\n{\n    ll ans = 0;\n    if(a > b)\n        swap(a, b);\n    for(ll i = 1, j = 1; i <= a; i = j + 1)\n    {\n        j = min(a / (a / i), b / (b / i));\n        ans += (a / i) * (b / i) * (sum[j] - sum[i - 1]);\n    }\n    return ans;\n}\nint main()\n{\n    ios::sync_with_stdio(false);\n    get_mu();\n    memset(sum, 0, sizeof(sum));\n    ll a, b, c;\n    cin >> a >> b >> c;\n    for(int i = 1; i <= min(a, b); i ++)\n        sum[i] = sum[i - 1] + (i % c == 0 ? mu[i / c] : 0);//\u6574\u9664\uff0c\u521a\u5f00\u59cb\u6ca1\u68c0\u67e5\u51fa\u6765\n    cout << cal(a, b, c) << endl;\n}\n\n```\n",
        "postTime": 1569159761,
        "uid": 211915,
        "name": "three_trees",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4450 \u3010\u53cc\u4eb2\u6570\u3011"
    },
    {
        "content": "#### \u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\n\n$$\\large \\sum_{d|n}\\mu(d)=\\begin{cases}1& \\text{n=1}\\\\0& \\text{n>1}\\end{cases}$$\n\n\t\t\u4e5f\u5c31\u662f\u8bf4\uff1a\n\n$$\\large \\mu(n)=\\begin{cases}1& \\text{n=0}\\\\(-1)^k& \\text{n= p1*p2*p3...pk}\\\\0& \\text{\u5176\u4ed6}\\end{cases}$$\n\n~~\u592a\u83dc\u4e86\u90fd\u5feb\u5fd8\u4e86\u600e\u4e48\u7ebf\u6027\u7b5b~~ $\\mu$ \u4e86\n\n\u6211\u4eec\u4ece\u516c\u5f0f\u5f53\u4e2d\u53ef\u4ee5\u77e5\u9053\uff0c\u5982\u679c\u662f\u8d28\u6570\u7684\u8bdd\uff0c\u90a3\u4e48\u8d28\u56e0\u5b50\u7684\u4e2a\u6570\u662f1\uff0c\u6240\u4ee5$\\mu$\u7684\u503c\u662f$-1$\uff0c\u5c31\u50cf\u7ebf\u6027\u7b5b\u7d20\u6570\u90a3\u6837\uff0c\u5bf9\u7d20\u6570\u7684\u500d\u6570\u8fdb\u884c\u6807\u8bb0\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u7ebf\u6027\u7b5b\u51fa\u6765$\\mu$\u4e86\uff0c\u4f46\u662f\u6709\u7684\u65f6\u5019\u7ebf\u6027\u7b5b\u4e0d\u591f\u7528\u4e86\uff0c\u5c31\u9700\u8981\u7528\u5230\u675c\u6559\u7b5b\uff0c\u675c\u6559\u7b5b\u7684\u5185\u5bb9\u540e\u9762\u518d\u8bf4\uff0c\u8fd9\u91cc\u7ed9\u4e00\u4e2a\u53c2\u8003\u4ee3\u7801 \uff08~~\u9632\u6b62\u81ea\u5df1\u5929\u5929\u5fd8~~\uff09\n\n```cpp\nvoid get_mu()\t//\u7ebf\u6027\u7b5b\u6c42mu\u51fd\u6570\n{\n\tmu[1]=1;\n\tfor(int i=2;i<=n;++i)\n\t{\n\t\tif(!vis[i])\n\t\t\tmu[i]=-1,pri[++cnt]=i;\n\t\tfor(int j=1;j<=cnt&&i*pri[j]<=n;++j)\n\t\t{\n\t\t\tvis[i*pri[j]]=1;\n\t\t\tif(i%pri[j]==0) break;\n\t\t\telse mu[i*pri[j]]=-mu[i];\n\t\t}\n\t}\n}\n```\n\n\n\n#### \u57fa\u672c\u516c\u5f0f\n\n$$\\large g(n)=\\sum_{d|n}f(d)$$\n\n$$\\large \\Updownarrow$$\n\n$$\\large f(n)=\\sum_{d|n}\\mu(d)g\\left(\\frac{n}{d}\\right)$$\n\n$$\\large g(n)=\\sum_{n|d}f(d)$$\n\n$$\\large \\Updownarrow$$\n\n$$\\large f(n)=\\sum_{n|d}g(d)\\mu\\left(\\frac{d}{n}\\right)$$\n\n#### \u7b80\u5355\u5e94\u7528\n\n##### \u677f\u5b50\n\n$$\\large \\sum_{i=1}^n\\sum_{j-1}^m[gcd(i,j)==1]$$\n\n$$ \\large f(x)=\\sum_{i=1}^n\\sum_{j-1}^m[gcd(i,j)==x]$$\n\n$$\\large \\large g(n)=\\sum_{n|d}f(d)$$\n\n$$\\large f(n)=\\sum_{n|d}g(d)\\mu\\left(\\frac{d}{n}\\right)$$\n\n$$\\large \\because g(x)=\\sum_{i=1}^n\\sum_{j=1}^m[x|gcd(i,j)]$$\n\n$$\\large \\therefore g(x)=\\sum_{i=1}^{{\\lfloor\\frac{n}{x}\\rfloor}}\\sum_{j=1}^{\\lfloor\\frac{m}{x}\\rfloor}[1|gcd(i,j)]$$\n\n$$\\large f(x)=\\sum_{x|d}g(d)\\mu\\left(\\frac{d}{x}\\right)=\\sum_{x|d}\\mu\\left(\\frac{d}{x}\\right)\\lfloor\\frac{n}{d}\\rfloor\\lfloor\\frac{m}{d}\\rfloor$$\n\n$$\\large f(1)=\\sum_{1|d}\\mu\\left(\\frac{d}{1}\\right)\\lfloor\\frac{n}{d}\\rfloor\\lfloor\\frac{m}{d}\\rfloor=\\sum_{d=1}^{min(n,m)}\\mu({d})\\lfloor\\frac{n}{d}\\rfloor\\lfloor\\frac{m}{d}\\rfloor$$\n\n$$\\large Ans=\\sum_{d=1}^{min(n,m)}\\mu({d})\\lfloor\\frac{n}{d}\\rfloor\\lfloor\\frac{m}{d}\\rfloor$$\n\n\u4ee3\u7801\u5957\u8def\uff1a\u9884\u5904\u7406\u524d\u7f00\u548c+\u6574\u9664\u5206\u5757\n\n\n```cpp\nfor(int l=1,r;l<=n;l=r+1)\n{\n    r=min(a/(a/l),b/(b/l));\n    ans+=1LL*(a/l)*(b/l)*(s[r]-s[l-1]);\n}\ncout<<ans<<endl;\n```\n\n###### POI2007 ZAP-Queries / luoguP4450 \u53cc\u4eb2\u6570\n\n\u200b\t\u6a21\u677f\u9898\uff0c\u4e24\u4e2a\u4e00\u6837\n$$\\large \\sum_{i=1}^n\\sum_{j=1}^m [ gcd(i,j)==d ]$$\n\n$$\\large f(x)=\\sum_{i=1}^n\\sum_{j=1}^m[gcd(i,j)=x]$$\n\n$$\\large g(x)=\\sum_{x|d}f(d)=\\sum_{i=1}^n\\sum_{j=1}^m[x|gcd(i,j)$$\n\n$$\\large \\because[x|gcd(i,j)]$$\n\n$$\\large \\therefore x|i\\text{\u4e14}x|j$$\n\n$$\\large g(x)=\\sum_{i=1}^n\\sum_{j=1}^m[x|gcd(i,j)]=\\sum_{i=1}^{\\lfloor\\frac{n}{x}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{m}{x}\\rfloor}=\\lfloor\\frac{n}{x}\\rfloor\\lfloor\\frac{m}{x}\\rfloor$$\n\n$$\\large f(x)=\\sum_{x|d}g(d)\\mu\\left(\\frac{d}{x}\\right)=\\sum_{x|d}\\mu\\left(\\frac{d}{x}\\right)\\lfloor\\frac{n}{d}\\rfloor\\lfloor\\frac{m}{d}\\rfloor$$\n\n$$\\large \\sum_{x|d}\\mu\\left(\\frac{d}{x}\\right)\\lfloor\\frac{n}{d}\\rfloor\\lfloor\\frac{m}{d}\\rfloor=\\sum_{i=1}^{\\lfloor\\frac{n}{x}\\rfloor}\\mu(i)\\lfloor\\frac{n}{ix}\\rfloor\\lfloor\\frac{m}{ix}\\rfloor=\\sum_{i=1}^{\\lfloor\\frac{n}{x}\\rfloor}\\mu(i)\\frac{\\lfloor\\frac{n}{x}\\rfloor}{i}\\frac{\\lfloor\\frac{m}{x}\\rfloor}{i}$$\n\n$$\\large Ans=\\sum_{i=1}^{\\lfloor\\frac{n}{x}\\rfloor}\\mu(i)\\frac{\\lfloor\\frac{n}{x}\\rfloor}{i}\\frac{\\lfloor\\frac{m}{x}\\rfloor}{i}$$\n",
        "postTime": 1560776024,
        "uid": 216081,
        "name": "\u5b50\u887f\u541b",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4450 \u3010\u53cc\u4eb2\u6570\u3011"
    },
    {
        "content": "~~\u8fd9\u9053\u9898\u53ef\u80fd\u7d2b\u8272\u90fd\u6ca1\u6709\uff1f~~\n\n\u6211\u4eec\u8003\u8651\u8fd9\u9053\u9898\u53ef\u80fd\u66b4\u529b\u90fd\u80fd A \uff0c~~\u6240\u4ee5\u522b\u505a\u4e86~~\n\n\u6211\u4eec\u53d1\u73b0\u5f0f\u5b50\u957f\u8fd9\u6837\uff1a\n\n\n$$ANS= \\sum_{i=1}^A \\sum_{j=1}^ B [(A,B)=d]$$\n\n\u7136\u540e\u5316\u7b80\uff08\u6b64\u5904\u9ed8\u8ba4 A \u6bd4 B \u5c0f\uff09\uff1a\n\n$$ANS=\\sum_{i=1}^{A/d} \\sum_{j=1}^ {B/d} [(A,B)=1]$$\n\n\n$$ANS= \\sum_{i=1}^{A/d} \\sum_{j=1}^ {B/d} \\sum_{k|i,k|j} \u03bc (k) $$\n\n\n\n$$ANS= \\sum_{k=1}^{A/d} \u03bc (k) \\sum_{i=1}^{A/kd} \\sum_{j=1}^ {B/kd}  $$\n\n\n\n$$ANS= \\sum_{k=1}^{A/d} \u03bc (k) \\lfloor{A\\over kd} \\rfloor \\lfloor{B\\over kd} \\rfloor $$\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u6570\u636e\u6bd4\u8f83\u5c0f\u5c31\u53ef\u4ee5\u76f4\u63a5\u7b5b\u4e00\u904d \u03bc \u7136\u540e\u7ebf\u6027\u51fa\u89e3\u4e86\n\n\n```\n//by Judge\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int M=1e4+3;\ntypedef int arr[M];\ninline int Min(int a,int b){return a<b?a:b;}\nll cnt,m,A,B,d,ans; arr v,p,mu; map<int,ll> mp;\ninline void prep(int n){ v[1]=mu[1]=1;\n\tfor(int i=2;i<=n;++i){ if(!v[i]) p[++cnt]=i,mu[i]=-1;\n\t\tfor(int j=1;j<=cnt&&i*p[j]<=n;++j){ v[i*p[j]]=1;\n\t\t\tif(!(i%p[j])) break; mu[i*p[j]]=-mu[i];\n\t\t} mu[i]+=mu[i-1];  //\u8fd9\u91cc\u5df2\u7ecf\u5904\u7406\u51fa\u4e86 \u03bc \u7684\u524d\u7f00\u548c\uff0c\u7ebf\u6027\u5904\u7406\u7b54\u6848\u7684\u65f6\u5019\u8981\u6ce8\u610f... \n\t}\n}\ninline ll get(int n){ if(n<=m) return mu[n]; //\u5982\u679c\u662f\u675c\u6559\u7b5b\u5c31\u8981\u7528 \n\tif(mp[n]) return mp[n]; ll ans=1;\n\tfor(int l=2,r;l<=n;l=r+1) r=n/(n/l),\n\t\tans-=(r-l+1)*get(n/l); return mp[n]=ans;\n}\nint main(){ cin>>A>>B>>d; if(A>B) swap(A,B);\n\tA/=d,B/=d,prep(A);\n\tfor(int k=1;k<=A;++k)\n\t\tans+=(mu[i]-mu[i-1])*(A/l)*(B/l);\n\treturn !printf(\"%lld\\n\",ans);\n\t\n\tA/=d,B/=d,prep(m=pow(A,2/3.0));\n\tfor(int l=1,r;l<=A;l=r+1) r=Min(A/(A/l),B/(B/l)),\n\t\tans+=(get(r)-get(l-1))*(A/l)*(B/l); return !printf(\"%lld\\n\",ans);\n}\n```\n\n\n\u4f46\u5176\u5b9e\u53ef\u4ee5\u8dd1\u5f97\u66f4\u5feb\u4e00\u4e9b\uff0c\u5c31\u662f\u7528\u675c\u6559\u7b5b\uff0c\u6bd4\u539f\u6765\u5927\u6982\u5feb\u4e2a\u4e24\u4e09\u500d\uff08\u6d1b\u8c37 4 \u73af\u5883\u4e0b\uff09\uff0c\u5176\u5b9e\u5df2\u7ecf\u5c11\u4e86\u4e24\u4e2a\u6570\u91cf\u7ea7\uff0c\u6839\u672c\u90fd\u4e0d\u7528\u6bd4\u4e86\n\n\u81f3\u4e8e\u4ee3\u7801\u5c31\u662f return \u540e\u9762\u7684\u90a3\u4e00\u6bb5\u8bdd\u4e86\n\n\n",
        "postTime": 1553841110,
        "uid": 38576,
        "name": "J\u03bcdge",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4450 \u3010\u53cc\u4eb2\u6570\u3011"
    },
    {
        "content": "\u9898\u76ee\u8981\u6c42\uff08\u4e4b\u540e\u4ee4$n<m$\uff09\n\n$$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m[gcd(i,j)==d]$$\n\n\u540c\u65f6\u9664\u4e0a$d$\uff0c\u6709\n\n$$\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}[gcd(i,j)==1]$$\n\n\u7136\u540e\u53d1\u73b0\u6700\u540e\u9762\u5176\u5b9e\u662f\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u5f62\u5f0f\uff0c\u7ee7\u7eed\u6539\u5199\u5f0f\u5b50\n\n$$\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}\\sum\\limits_{x|i,x|j}\\mu(x)$$\n\n\u7136\u540e\u6211\u4eec\u628a\u679a\u4e3e\u6539\u4e00\u4e0b\u987a\u5e8f\uff0c\u5f97\u5230\n\n$$\\sum\\limits_{x=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\mu(x)\\lfloor\\dfrac{n}{dx}\\rfloor\\lfloor\\dfrac{m}{dx}\\rfloor$$\n\n\u7136\u540e\u6211\u4eec\u53ea\u8981\u7ebf\u7b5b\u6c42\u51fa$\\mu$\u51fd\u6570\u4e4b\u540e\u5c31\u53ef\u4ee5\u505a\u8fd9\u9898\u4e86~~(\u5f53\u7136\u53ef\u4ee5\u4f7f\u7528\u6574\u9664\u5206\u5757)~~\n\n```cpp\n/*program from Wolfycz*/\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\n#define inf 0x7f7f7f7f\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int ui;\ntypedef unsigned long long ull;\ninline char gc(){\n\tstatic char buf[1000000],*p1=buf,*p2=buf;\n\treturn p1==p2&&(p2=(p1=buf)+fread(buf,1,1000000,stdin),p1==p2)?EOF:*p1++;\n}\ninline int frd(){\n\tint x=0,f=1; char ch=gc();\n\tfor (;ch<'0'||ch>'9';ch=gc())\tif (ch=='-')\tf=-1;\n\tfor (;ch>='0'&&ch<='9';ch=gc())\tx=(x<<3)+(x<<1)+ch-'0';\n\treturn x*f;\n}\ninline int read(){\n\tint x=0,f=1; char ch=getchar();\n\tfor (;ch<'0'||ch>'9';ch=getchar())\tif (ch=='-')\tf=-1;\n\tfor (;ch>='0'&&ch<='9';ch=getchar())\tx=(x<<3)+(x<<1)+ch-'0';\n\treturn x*f;\n}\ninline void print(int x){\n\tif (x<0)\tputchar('-'),x=-x;\n\tif (x>9)\tprint(x/10);\n\tputchar(x%10+'0');\n}\nconst int N=1e6;\nint prime[N+10],miu[N+10],sum[N+10];\nbool inprime[N+10];\nvoid prepare(){\n\tmiu[1]=sum[1]=1; int tot=0;\n\tfor (int i=2;i<=N;i++){\n\t\tif (!inprime[i])\tmiu[prime[++tot]=i]=-1;\n\t\tfor (int j=1;j<=tot&&i*prime[j]<=N;j++){\n\t\t\tinprime[i*prime[j]]=1;\n\t\t\tif (i%prime[j]==0){\n\t\t\t\tmiu[i*prime[j]]=0;\n\t\t\t\tbreak;\n\t\t\t}miu[i*prime[j]]=-miu[i];\n\t\t}\n\t\tsum[i]=sum[i-1]+miu[i];\n\t}\n}\nint main(){\n\tprepare();\n\tint n=read(),m=read(),d=read();\n\tll Ans=0; n/=d,m/=d;\n\tif (n>m)\tswap(n,m);\n\tfor (int i=1,pos;i<=n;i=pos+1){\n\t\tpos=min(n/(n/i),m/(m/i));\n\t\tAns+=1ll*(sum[pos]-sum[i-1])*(n/i)*(m/i);\n\t}\n\tprintf(\"%lld\\n\",Ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1547424794,
        "uid": 21633,
        "name": "Wolfycz",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4450 \u3010\u53cc\u4eb2\u6570\u3011"
    },
    {
        "content": "\u63a8\u5bfc\u8fc7\u7a0b\uff1a\n\n$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m[(i,j)==d]$\n\n$=\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}[(i,j)==1]$\n\n$=\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}\\sum\\limits_{D|i,j}\\mu(D)$\n\n$=\\sum\\limits_{D=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\mu(D)\\lfloor\\frac{n}{dD}\\rfloor\\lfloor\\frac{m}{dD}\\rfloor$\n\n\u76f4\u63a5\u7ebf\u7b5b\u51fa$\\mu$\uff0c\u7136\u540e\u968f\u4fbf\u505a\u4e86\u3002\u6211\u7528\u4e86\u6574\u9664\u5206\u5757\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$O(\\frac{n}{d}+\\sqrt{\\frac{n}{d}})$\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define For(i,a,b) for(i=(a),i##end=(b);i<=i##end;++i)\n#define Forward(i,a,b) for(i=(a),i##end=(b);i>=i##end;--i)\n#define Rep(i,a,b) for(register int i=(a),i##end=(b);i<=i##end;++i)\n#define Repe(i,a,b) for(register int i=(a),i##end=(b);i>=i##end;--i)\n#define Chkmax(a,b) a=a>b?a:b\n#define Chkmin(a,b) a=a<b?a:b\nusing namespace std;\ntemplate<typename T>inline void read(T &x){\n    T s=0,f=1;char k=getchar();\n    while(!isdigit(k)&&k^'-')k=getchar();\n    if(!isdigit(k)){f=-1;k=getchar();}\n    while(isdigit(k)){s=s*10+(k^48);k=getchar();}\n    x=s*f;\n}\nvoid file(void){\n    #ifndef ONLINE_JUDGE\n    freopen(\"water.in\",\"r\",stdin);\n    freopen(\"water.out\",\"w\",stdout);\n    #endif\n}\n\nconst int MAXN=1e6+7;\n\nstatic int pri[MAXN],e;\nstatic short mu[MAXN];\nstatic bool is[MAXN];\n\nstatic int n,m,d;\n\ninline void predone(int lim)\n{\n\tmu[1]=1;\n\tstatic int z;\n\tRep(i,2,lim)\n\t{\n\t\tif(!is[i])pri[++e]=i,mu[i]=-1;\n\t\tfor(register int j=1;j<=e&&(z=i*pri[j])<=lim;++j)\n\t\t{\n\t\t\tis[z]=true;\n\t\t\tif(i%pri[j]==0)break;\n\t\t\tmu[z]=-mu[i];\n\t\t}\n\t}\n\tRep(i,2,lim)mu[i]+=mu[i-1];\n}\n\ninline void init()\n{\n\tread(n);read(m);read(d);\n\tif(n>m)swap(n,m);n/=d;m/=d;\n\tpredone(n);\n}\n\nstatic long long ans;\n\ninline void solve()\n{\n\tstatic int las,i;\n\tfor(i=1;i<=n;i=las+1)\n\t{\n\t\tlas=min(n/(n/i),m/(m/i));\n\t\tans+=(long long)(n/i)*(m/i)*(mu[las]-mu[i-1]);\n\t}\n\tprintf(\"%lld\\n\",ans);\n}\n\nint main(void){\n    file();\n\tinit();\n\tsolve();\n\treturn 0;\n}\n\n```",
        "postTime": 1523972506,
        "uid": 7035,
        "name": "Great_Influence",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4450 \u3010\u53cc\u4eb2\u6570\u3011"
    }
]
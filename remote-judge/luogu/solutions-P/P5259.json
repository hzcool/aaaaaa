[
    {
        "content": "# \u5c0f\u5154\u7684\u8bdd\n\u6b22\u8fce\u5927\u5bb6\u5728\u8bc4\u8bba\u533a\u7559\u8a00\u54e6~\n- - -\n# \u601d\u8def\n\u56e0\u4e3a **\u6bcf\u4e00\u4e2a\u4eba\u90fd\u968f\u673a\u5730\u62c9\u4f4f\u4e24\u4e2a\u4e0d\u540c\u4eba\u7684\u624b**\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053 **\u81f3\u5c11\u8981 $3$ \u4e2a\u4eba\u624d\u80fd\u56f4\u6210\u4e00\u4e2a\u65b0\u7684\u5708**  \n\u4e0d\u59a8\u8bbe $dp[i][j]$\uff1a\u6709 $i$ \u4e2a\u4eba\uff0c\u56f4\u6210 $j$ \u4e2a\u5708\u7684\u65b9\u6848\u6570  \n- - -\n# \u5206\u6790\n\u5bf9\u4e8e\u4e00\u4e2a $i, j$\uff0c\u6709 $2$ \u79cd\u60c5\u51b5\uff1a  \n- \u7b2c $i$ \u4e2a\u4eba\u52a0\u5165\u4e4b\u524d\u7684\u4eba\u56f4\u6210\u7684 $j$ \u4e2a\u7684\u5708\u4e2d\uff0c\u7b2c $i$ \u4e2a\u4eba\u53ef\u4ee5\u63d2\u5165\u4e4b\u524d\u7684 $i - 1$ \u4e2a\u4f4d\u7f6e\uff08 \u5927\u5bb6\u53ef\u4ee5\u81ea\u5df1\u63a8\u4e00\u4e0b, $n$ \u4e2a\u4eba\u5c31\u6709 $n$ \u4e2a\u7a7a\u4f4d \uff09\uff0c\u6545\u6709 $i - 1$ \u79cd\u60c5\u51b5\uff0c\u5373 $dp[i - 1][j] * (i - 1)$  \n- \u7b2c $i$ \u4e2a\u4eba\u5206\u79bb\u51fa\u6765\uff0c\u548c\u4e4b\u524d\u7684 $2$ \u4e2a\u4eba\u56f4\u6210 $1$ \u4e2a\u65b0\u7684\u5708 ( \u5982\u679c\u662f\u548c\u4e4b\u524d\u7684 $3$ \u4e2a\u4eba\uff0c\u5c31\u76f8\u5f53\u4e8e\u662f\u52a0\u5165\u90a3 $3$ \u4e2a\u4eba\u4e4b\u524d\u56f4\u6210\u7684\u5708\u4e2d\u4e86 \uff09\uff0c\u8fd9\u65f6\u53ea\u9700\u8981\u9009\u51fa\u4e4b\u524d\u7684\u4eba\u4e2d\u7684 $2$ \u4e2a\u4eba\uff0c\u6545\u6709 $(i - 1) * (i - 2)$ \u79cd\u60c5\u51b5\uff0c\u5373 $dp[i - 3][j - 1] * (i - 1) * (i - 2)$  \n\n\u7efc\u4e0a\u6240\u8ff0\uff1a$dp[i][j] = dp[i - 1][j] * (i - 1) + dp[i - 3][j - 1] * (i - 1) * (i - 2)$  \n- - -\n# \u4ee3\u7801\n```cpp\n#include <cstdio>\n\n// \u4ee5\u4e0b\u5b9a\u4e49\u53ea\u662f\u4e3a\u4e86\u597d\u770b\n#define i32 int\n#define i64 long long\n#define u32 unsigned int\n#define u64 unsigned long long\n\nconst int MAXN = 3e3, MAXK = MAXN / 3;\nint N, K, P;\ni64 dp[MAXN + 5][MAXK + 5];\n\nint main()\n{\n\tscanf(\"%d %d %d\", &N, &K, &P);\n\tdp[0][0] = 1 % P;\n\tfor (int i = 1; i <= N; i++)\n\t{\n\t\tfor (int j = K; j >= 1; j--)\n\t\t{\n\t\t\tdp[i][j] = dp[i - 1][j] * (i - 1) % P;\n\t\t\tif (i >= 3) dp[i][j] += dp[i - 3][j - 1] * (i - 1) % P * (i - 2) % P;\n\t\t\tdp[i][j] %= P;\n\t\t}\n\t}\n\tprintf(\"%lld\\n\", dp[N][K]);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1609854022,
        "uid": 331660,
        "name": "mqxmm",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5259 \u3010[JSOI2013]\u6e38\u620f\u4e2d\u7684\u5b66\u95ee \u3011"
    },
    {
        "content": "### \u89e3\u9898\u601d\u8def\n\n\u6807\u51c6 DP \u9898\uff0c\u7edf\u4e00\u628a**\u5de6\u624b**\u770b\u6210**\u5355\u5411\u8fb9**\uff0c\u5c31\u8f6c\u6362\u6210\u591a\u73af\u8ba1\u6570\u4e86\uff08\u73af\u5927\u5c0f $\\geqslant 3$\uff09\uff0c\u6709\u70b9\u9519\u6392\u95ee\u9898\u7684\u5473\u9053\u3002\n\n\u76f4\u63a5\u7528 $f_{i,\\,j}$ \u8868\u793a\u5df2\u9009 $i$ \u4e2a\u70b9\uff0c\u6784\u6210 $j$ \u4e2a\u73af\u7684\u65b9\u6848\u6570\u3002\n\n\u600e\u4e48\u6784\u6210\u4e00\u4e2a\u65b0\u73af\u5462\uff1f\u8981\u5148\u6709\u4e2a\u5c0f\u76ee\u6807\u2014\u2014\u6784\u9020\u4e09\u4e2a\u70b9\u7684\u3002\u8f6c\u79fb\u6765\u7684\u72b6\u6001\u662f $f_{i-3,\\,j-1}$\uff0c\u65b0\u52a0\u8fdb\u53bb\u4e86 $i$ \uff0c$i-1$ \u548c $i-2$ \u53f7\u70b9\uff0c\u94a6\u5b9a $i$ \u53f7\u70b9\u662f\u8fd9\u4e2a\u73af\u4e2d\u7684\u201c\u5934\u513f\u201d\uff0c\u4e5f\u5c31\u662f\u8bf4 $i-1$ \u548c $i-2$ \u53f7\u70b9\u53ef\u4ee5\u8ddf\u4e4b\u524d\u4f7f\u7528\u7684\u70b9\u4ea4\u6362\uff0c\u6240\u4ee5\u8f6c\u79fb\u8d21\u732e\u662f $f_{i-3,\\,j-1}\\times(i-1)\\times(i-2)$ \u3002\n\n\u4f46\u5927\u5c0f\u4e3a $3$ \u8fdc\u8fdc\u4e0d\u591f\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u94a6\u70b9 $i$ \u53f7\u70b9\u662f\u7528\u6765\u6269\u5145\u7684\u3002\u8f6c\u79fb\u6765\u7684\u72b6\u6001\u662f $f_{i-1,j}$\uff0c\u56e0\u4e3a\u5176\u53ef\u4ee5\u63a5\u5728\u524d $i-1$ \u4e2a\u70b9\u7684\u4efb\u4f55\u4e00\u4e2a\u70b9\u7684\u540e\u9762\uff0c\u6240\u4ee5\u8f6c\u79fb\u8d21\u732e\u662f $f_{i-1,j}\\times(i-1)$ \u3002\n\n\u7efc\u4e0a\uff0c$f_{i,\\,j} = f_{i-3,\\,j-1}\\times(i-1)\\times(i-2)+f_{i-1,j}\\times(i-1)$ \uff0c\u8bbe\u5b9a\u8fb9\u754c $f_{0,\\,0} = 1$ \uff0c\u7b54\u6848\u72b6\u6001 $f_{n,\\,m}$ \u3002\n\n---\n\n### \u4ee3\u7801\u5b9e\u73b0\n\n\u771f\u7684\u5f88\u77ed\u5462 qaq\n\n```cpp\n#include <cstdio>\n\nconst int maxN = 3005;\n\nint n, m, p, f[maxN][maxN];\n\nint main() {\n    scanf(\"%d%d%d\", &n, &m, &p); f[0][0] = 1;\n    for (int i = 1; i <= n; i++) {\n        for (int j = 1; j <= m; j++) { f[i][j] = ((i >= 3 ? f[i - 3][j - 1] * (i - 1ll) % p * (i - 2) % p : 0) + f[i - 1][j] * (i - 1ll)) % p; }\n    }\n    printf(\"%d\\n\", f[n][m]);\n    return 0;\n}\n```",
        "postTime": 1553174503,
        "uid": 26673,
        "name": "Sooke",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5259 \u3010\u6e38\u620f\u4e2d\u7684\u5b66\u95ee \u3011"
    },
    {
        "content": "\u8bbe$f[i][j]$\u4e3a$i$\u4e2a\u4eba\u56f4\u6210$j$\u4e2a\u5708\u7684\u65b9\u6848\u6570\u3002\n\n$$f[i][j]=f[i-1][j]\\times(i-1)+f[i-3][j-1]\\times(i-1)\\times(i-2)$$\n\n\u8f6c\u79fb\u9996\u5148\u662f$i-1$\u4e2a\u4eba\u56f4\u6210$j$\u4e2a\u5708\uff0c\u7b2c$i$\u4e2a\u4eba\u53ef\u4ee5\u8ddf$i-1$\u4e2a\u4eba\u62c9\u624b\n\n\u8fd8\u6709$i-3$\u4e2a\u4eba\u56f4\u6210$j-1$\u4e2a\u5708\uff0c\u518d\u9009\u51fa$2$\u4e2a\u4eba\u8ddf\u7b2c$i$\u4e2a\u4eba\u56f4\u6210$1$\u4e2a\u5708\u3002\n\n```cpp\n#include<cstdio>\nconst int N=1005;\nint n,k,p;\nint f[N*3][N];\ninline int min(int u,int v){return u<v?u:v;}\nint main(){\n\tscanf(\"%d%d%d\",&n,&k,&p);\n\tf[0][0]=1;\n\tfor(int i=1;i<=n;i++)\n\tfor(int j=1;j<=min(i/3,k);j++)\n\tf[i][j]=(1ll*f[i-1][j]*(i-1)%p+1ll*f[i-3][j-1]*(i-1)*(i-2)%p)%p;\n\tprintf(\"%d\\n\",f[n][k]);\n}\n```",
        "postTime": 1552694215,
        "uid": 50092,
        "name": "da32s1da",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P5259 \u3010\u6e38\u620f\u4e2d\u7684\u5b66\u95ee \u3011"
    },
    {
        "content": "[\u6e38\u620f\u4e2d\u7684\u5b66\u95ee](https://www.luogu.com.cn/problem/P5259)\n\n\u4e00\u9053\u4e0d\u7b97\u96be\u7684\u52a8\u89c4\u9898\u3002\n\n### \u601d\u8def\uff1a\n\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff1a\u81f3\u5c11\u8981 $3$ \u4e2a\u4eba\u624d\u80fd\u56f4\u6210\u4e00\u4e2a\u5708\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n1. \u7b2c $i$ \u4e2a\u4eba\u52a0\u5165 $j$ \u4e2a\u4eba\u7684\u5708\u4e2d\uff0c\u6709 $i-1$ \u79cd\u65b9\u6848\u3002\n2. \u7b2c $i$ \u4e2a\u4eba\u79bb\u5f00\u4ed6\u6240\u5728\u7684\u5708\uff0c\u627e $2$ \u4e2a\u4eba\u5408\u6210\u4e00\u4e2a\u65b0\u5708\uff0c\u6709 $(i-1)\\times (i-2)$ \u79cd\u65b9\u6848\u3002\n\n### \u52a8\u89c4\u65b9\u7a0b\uff1a\n\n\u53ef\u4ee5\u8bbe $f[i][j]$ \u4e3a\uff1a\u6709 $i$ \u4e2a\u4eba\uff0c\u56f4\u6210 $j$ \u4e2a\u5708\u7684\u65b9\u6848\u6570\u3002\n\n\u5219\u65b9\u7a0b\u4e3a\uff1a $f[i][j]=f[i-1][j]\\times(i-1)+f[i-3][j-1]\\times(i-1)\\times(i-2)$\n\n### \u6ce8\u610f\uff1a\n\u52a8\u89c4\u6570\u7ec4\u8bb0\u5f97\u5f00 $long long$ \uff01\uff01\uff01\n\n### CODE:\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nlong long f[3001][1001];\nint main()\n{\n\tint n,k;\n\tlong long p;\n\tcin>>n>>k>>p;\n\tf[0][0]=1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=k;j>=1;j--)\n\t\t{\n\t\t\tf[i][j]=f[i-1][j]*(i-1)%p;\n\t\t\tif(i>=3)\n\t\t\tf[i][j]+=f[i-3][j-1]*(i-1)%p*(i-2)%p;\n\t\t\tf[i][j]%=p;\n\t\t}\n\t}\n\tcout<<f[n][k];\n\treturn 0;\n}\n```",
        "postTime": 1638419099,
        "uid": 545692,
        "name": "mzyc_jx",
        "ccfLevel": 0,
        "title": "\u6e38\u620f\u4e2d\u7684\u5b66\u95ee \u9898\u89e3"
    },
    {
        "content": "\u8fd9\u91cc\u7ed9\u51fa\u4e00\u4e2a\u57fa\u4e8e\u6307\u6570\u578b\u751f\u6210\u51fd\u6570\u7684 $O(n^2)$ \u6216 $O(n\\log^2n)$ \u6216 $O(n\\log n)$ \u7684\u505a\u6cd5\u3002\n\n\u5bb9\u6613\u53d1\u73b0\uff0c\u5982\u679c\u786e\u5b9a\u4e86 $a$ \u4e2a\u4eba\u4f5c\u4e3a\u4e00\u4e2a\u73af\uff0c\u90a3\u4e48\u73af\u7684\u65b9\u6848\u6570\u5373\u5706\u6392\u5217 $(a-1)!$\n\n\u8003\u8651\u6bcf\u4e2a\u73af\u7684\u6307\u6570\u578b\u751f\u6210\u51fd\u6570\u4e3a\n\n$$f(x)=\\sum_{a\\geq 3}\\frac{1}{a}x^a$$\n\n\u90a3\u4e48\u7b54\u6848\u5c31\u662f $\\dfrac{n!}{k!}[x^n]f^k(x)$\n\n\u4f7f\u7528 FFT \u548c\u500d\u589e\u5feb\u901f\u5e42\uff0c\u5373\u53ef $O(n\\log^2n)$\n\n\u4e5f\u53ef\u4ee5\u7528 $\\ln \\exp$ \u8fbe\u5230 $O(n\\log n)$ \u7684\u590d\u6742\u5ea6\uff0c\u8fd9\u91cc\u4e3a\u4e86\u65b9\u4fbf\uff0c\u4f7f\u7528\u4e86 $O(n^2)$ \u7684\u7b97\u6cd5\n\n```cpp\n#include <iostream>\n\nconst int N = 3001;\nusing LL = long long;\nint mod, n, k, A[N], lnA[N], B[N], lnB[N];\nvoid reduce(int &x) { x += x >> 31 & mod; }\nint pow(int x, int y, int ans = 1) {\n\tfor (; y; y >>= 1, x = (LL) x * x % mod)\n\t\tif (y & 1) ans = (LL) ans * x % mod;\n\treturn ans;\n}\nvoid poly_ln(int *A, int *B) {\n\tB[0] = 0;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tB[i] = 0;\n\t\tfor (int j = 1; j < i; ++j)\n\t\t\treduce(B[i] -= (LL) A[i - j] * j % mod * B[j] % mod);\n\t\tB[i] = pow(i, mod - 2, B[i]);\n\t\treduce(B[i] += A[i] - mod);\n\t}\n}\nvoid poly_exp(int *A, int *B) {\n\tB[0] = 1;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tB[i] = 0;\n\t\tfor (int j = 0; j < i; ++j)\n\t\t\treduce(B[i] += (LL) A[i - j] * (i - j) % mod * B[j] % mod - mod);\n\t\tB[i] = pow(i, mod - 2, B[i]);\n\t}\n}\nint main() {\n\tstd::ios::sync_with_stdio(0), std::cin.tie(0);\n\tstd::cin >> n >> k >> mod;\n\tfor (int i = 0; i <= n; ++i)\n\t\tA[i] = pow(i + 3, mod - 2);\n\tint c = A[0], d = pow(c, mod - 2);\n\tfor (int i = 0; i <= n; ++i)\n\t\tA[i] = (LL) A[i] * d % mod;\n\tpoly_ln(A, lnA);\n\tfor (int i = 0; i <= n; ++i)\n\t\tlnB[i] = (LL) lnA[i] * k % mod;\n\tpoly_exp(lnB, B);\n\tint ans = pow(c, k, B[n - 3 * k]);\n\tfor (int i = 1; i <= n; ++i) ans = (LL) ans * i % mod;\n\tfor (int i = 1; i <= k; ++i) ans = (LL) ans * pow(i, mod - 2) % mod;\n\tstd::cout << ans << '\\n';\n\treturn 0;\n}\n```",
        "postTime": 1556975890,
        "uid": 26127,
        "name": "Weng_Weijie",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5259 \u3010\u6e38\u620f\u4e2d\u7684\u5b66\u95ee \u3011"
    },
    {
        "content": "[link](https://www.luogu.com.cn/problem/P5259)\n\n\u5c0f\u6e05\u65b0 $\\text{dp}$ \u9898 \u3002\n\n## \u601d\u8def\n\n\u6ce8\u610f\u5230\u5708\u7684\u4eba\u6570\u81f3\u5c11\u4e3a $3$ \u3002\n\n\u6700\u5bb9\u6613\u60f3\u5230\u7684\u72b6\u6001\uff1a $dp_{i,j}$ \u8868\u793a\u6709 $i$ \u4e2a\u4eba\uff0c**\u6070\u597d**\u56f4\u4e86 $j$ \u4e2a\u5708\u7684\u65b9\u6cd5\u6570\u3002\n\n\u5f53\u6709\u4e00\u4e2a\u65b0\u7684 $dp_{i,j}$ \u5904\u7406\u65f6\uff0c\u53ef\u4ee5\u5206\u6210\u4e24\u4e2a\u60c5\u51b5\u8003\u8651\uff1a\n\n1. \u5408\u5e76\u3002\u7b2c $i$ \u4e2a\u4eba\u4e0e\u4e4b\u524d\u7684 $j-1$ \u4e2a\u5708\u4e2d\u7684\u67d0\u4e2a\u5708\u5408\u5e76\uff0c\u5373\u5c06 $i$ \u63d2\u5165\u5230\u524d $i-1$ \u4e2a\u4eba\u56f4\u6210\u7684\u5708\u7684 $i-1$ \u4e2a\u7a7a\u9699\u4e2d\uff0c\u5f97\u5230 $dp_{i-1,j-1}\\times (i-1)$ \u3002\n2. \u72ec\u7acb\u3002\u4e0e\u524d\u9762\u5df2\u7ecf\u51fa\u73b0\u8fc7\u7684\u4e24\u4eba\u76f4\u63a5\u7ec4\u5efa\u65b0\u7684\u6700\u5c0f\u5708\uff08\u8d85\u4e09\u4eba\u5219\u79f0\u5408\u5e76\uff09\uff0c\u5f97\u5230 $dp_{i-3,j-1} \\times(i-1)\\times(i-2)$ \uff0c\u6ce8\u610f\u6b64\u65f6 $3\\le i$ \u3002\n\n\u7efc\u4e0a\uff0c\u5f97\u5230 $dp_{i,j}=dp_{i-1,j-1}\\times (i-1)+dp_{i-3,j-1} \\times(i-1)\\times(i-2)$ \u3002\n\n\u7b54\u6848\u5373\u4e3a $dp_{n,k}$ \u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nint n, k, p;\nint dp[3005][3005];\n\nsigned main()\n{\n\tcin >> n >> k >> p;\n\tdp[0][0] = 1;\n\tfor (int i = 1;i <= n;i++)\n\t{\n\t\tfor(int j = 1;j <= k;j++)\n\t\t{\n\t\t\tdp[i][j] = dp[i - 1][j] * (i - 1) % p;\n\t\t\tif(i >= 3)\n\t\t\t\tdp[i][j] += dp[i - 3][j - 1] * (i - 1) * (i - 2) % p;\n\t\t\tdp[i][j] %= p;\n\t\t}\n\t}\n\tcout << dp[n][k];\n\treturn 0;\n}\n```",
        "postTime": 1664273995,
        "uid": 413301,
        "name": "Digital_Sunrise",
        "ccfLevel": 7,
        "title": "P5259 [JSOI2013]\u6e38\u620f\u4e2d\u7684\u5b66\u95ee"
    },
    {
        "content": "\u4e00\u9053\u5178\u578b\u7684\u52a8\u89c4~~\u6c34~~\u9898\u3002\n### \u5206\u6790\uff1a\n\u4efb\u4f55\u4e00\u4e2a\u4eba\u90fd\u53ef\u4ee5\u4efb\u610f\u7275\u4f4f\u4e24\u4e2a\u4eba\uff0c\u6240\u4ee5\u81f3\u5c11 3 \u4eba\u56f4\u6210\u4e00\u5708\u3002\n### \u5206\u7c7b\u8ba8\u8bba\uff1a\n1. \u7b2c $i$ \u4e2a\u4eba\u52a0\u5165 $j$ \u4e2a\u4eba\u7684\u5708\u4e2d\uff0c\u6709 $ i - 1$ \u79cd\u65b9\u6848\u3002\n2. \u7b2c $i$ \u4e2a\u4eba\u79bb\u5f00\u4ed6\u6240\u5728\u7684\u5708\uff0c\u627e 2 \u4e2a\u4eba\u5408\u6210\u4e00\u4e2a\u65b0\u5708\uff0c\u6709     $(i-1)\\times (i-2)$ \u79cd\u65b9\u6848\u3002\n### \u52a8\u5f52\u65b9\u7a0b\uff1a\n $f_{i,j} = f_{i - 1,j}\\times (i - 1) + f_{i - 3,j - 1}\\times (i - 1)\\times (i - 2)$\n## Code:\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,k,p;\nlong long a[3001][10001];\nint main()\n{\n\tcin>>n>>k>>p;\n\ta[0][0]=1%p;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\ta[i][j]=a[i-1][j]*(i-1)%p;\n\t\t\tif(i>=3)\n\t\t\ta[i][j]=a[i][j]+a[i-3][j-1]*(i-1)%p*(i-2)%p;\n\t\t\ta[i][j]=a[i][j]%p;\n\t\t}\n\t}\n\tcout<<a[n][k];\n\treturn 0;\n}\n```\n### \u6ce8\u610f:\n\u52a8\u5f52\u6570\u7ec4\u4e00\u5b9a\u8981\u5f00\u591f\uff0c\u5426\u5219\u4f1a RE \u3002\n\n\u5341\u5e74 OI \u4e00\u573a\u7a7a\uff0c\u4e0d\u5f00 long long \u89c1\u7956\u5b97\u3002",
        "postTime": 1637747009,
        "uid": 481323,
        "name": "mzyc_pzx",
        "ccfLevel": 0,
        "title": "P5259"
    }
]
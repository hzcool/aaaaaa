[
    {
        "content": "## \u60ca\u4e86\uff01\u5c45\u7136\u662f\u7d2b\u9898\uff1f\uff01\n#### \u6211\u7684\u5929\uff0c\u6015\u4e0d\u662f\u6709\u53f2\u4ee5\u6765\u505a\u5230\u7684\u6700\u7b80\u5355\u7684\u7d2b\u9898\uff0c\u611f\u89c9\u6bd4\u6211\u8fd9\u4e24\u5929\u75af\u72c2\u5237\u7684\u84dd\u8272\u7684\u5355\u8c03\u961f\u5217\u4f18\u5316DP\u8fd8\u6709\u659c\u7387\u4f18\u5316\u7b80\u5355\u591a\u4e86\n##### \u601d\u8def\u76f8\u5f53\u7b80\u5355\uff0c\u5c31\u662f\u5206\u89e3\u8d28\u56e0\u6570\u5c31\u884c\u4e86\uff0c\u6ce8\u610f\u5982\u679c\u6ca1\u6709\u5206\u89e3\u5e72\u51c0\u7684\u8bdd\u8bb0\u7740\u4e583\u5c31\u884c\u4e86\uff0c\u5343\u4e07\u4e0d\u8981\u7ebf\u6027\u7b5b\uff0c\u8981\u4e0dRE\uff0c\u8981\u4e0dMLE\uff0c\u76f4\u63a5\u66b4\u529b\u5c31\u884c\u4e86\uff0c_nsqrt(n)_\u7edd\u5bf9\u4e0d\u4f1aTLE\u3002\n##### \u770b\u89c1\u8bf8\u4f4d\u5df2\u7ecf\u5bf9\u6211\u7684\u4ee3\u7801\u864e\u89c6\u7708\u7708\u4e86\uff08\u778e\u731c\u7684\uff09\uff0c\u90a3\u6211\u5c31\u4e0a\u4ee3\u7801\u55bd~\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nlong long cnt,ans=1;\nint main()\n{\n\tlong long n;\n\tscanf(\"%lld\",&n);\n\tfor(int i=2;i<=sqrt(n);i++)\n\t{\n\t\tcnt=0;\n\t\twhile(!(n%i))\n\t\t{\n\t\t\tcnt++;\n\t\t\tn/=i;\n\t\t}\n\t\tans*=(cnt<<1|1);\n\t}\n\tif(n>1)ans*=3;\n\tcout<<ans;\n\treturn 0;\n}\n```\n\u5c31\u8fd9\u4e48\u957f\uff0c\u5927\u62ec\u53f7\u8fd8\u6362\u884c\u4e86",
        "postTime": 1552611749,
        "uid": 93488,
        "name": "Porsche",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5150 \u3010\u751f\u65e5\u793c\u7269\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u9700\u8981\u4e00\u4e2a\u6570\u5b66\u77e5\u8bc6\uff1a\u552f\u4e00\u5206\u89e3\u5b9a\u7406\n\n\u5bf9\u4e8e\u4efb\u610f\u7684\u6b63\u6574\u6570 $N$ \u4e00\u5b9a\u6709\uff1a\n\n$N=a_1^{p_1}\u00d7a_2^{p_2}\u00d7\u2026\u2026\u00d7a_n^{p_n}$\uff08$a_i$\u4e3a\u8d28\u6570\uff09\n\n\uff08\u4ee5\u4e0b $N$ \u548c\u4e0a\u9762\u7684 $N$ \u65e0\u5173\uff09\n\n\u901a\u8fc7\u9605\u8bfb\u9898\u610f\uff0c\u5927\u81f4\u610f\u601d\u662f $N=lcm(m,n)$ \u95ee \uff08$m,n$\uff09\u6709\u591a\u5c11\u5bf9\uff1f\uff08\u53ef\u4ee5\u4e92\u6362\u4f4d\u7f6e\uff09\n\n\u5206\u6790\u5982\u4e0b\uff1a\n\n\u9996\u5148\uff0c\u6211\u4eec\u8bbe $N=a^p\u00d7b^q\u00d7\u2026\u2026$ \uff08$a$ \u548c $b$ \u5747\u4e3a\u8d28\u6570\uff09\n\n\u5047\u8bbe $m$ \u7684\u4e00\u4e2a\u56e0\u6570\u662f $a^k(0<=k<=p)$\uff0c\u90a3\u4e48\u5f53\u4e14\u4ec5\u5f53 $n$ \u7684\u4e00\u4e2a\u56e0\u6570\u662f $a^p$ \u65f6\uff0c\u624d\u53ef\u80fd\u6709 $lcm(m,n)=N$\uff0c\u4e5f\u5c31\u662f\u8bf4\u5bf9\u4e8e $n$ \u82e5\u6709\u4e00\u4e2a\u56e0\u6570\u662f $a^p$ \u5219 $m$ \u5bf9\u5e94\u53ef\u4ee5\u6709\u56e0\u6570 $a^k(0<=k<=p)$\uff0c\u6240\u6709\u5bf9\u4e8e $N$ \u7684\u4e00\u4e2a\u8d28\u56e0\u6570 $a$ \u6765\u8bf4\uff0c\u6709 $2\u00d7p+1$ \u79cd\uff0c\u8bf4\u660e\u5982\u4e0b\uff1a\n\n\u5f53 $0<=k<p$ \u65f6\uff0c\u6709 $2\u00d7p$ \u79cd\uff08$m,n$ \u4f4d\u7f6e\u53ef\u4ee5\u4e92\u6362\uff09\uff0c\u5f53 $k=p$ \u65f6\uff0c\u6709\u4e14\u4ec5\u6709\u4e00\u79cd\u60c5\u51b5\uff08$m,n$ \u4e92\u6362\u662f\u4e00\u79cd\u60c5\u51b5\uff09\n\n\u90a3\u4e48\uff0c\u540c\u7406\u53ef\u5f97\uff1a\u5bf9\u4e8e\u4e4b\u540e\u7684\u8d28\u56e0\u6570\uff0c\u6bcf\u4e00\u4e2a\u8d28\u56e0\u6570\u6709 $2\u00d7$ \u6307\u6570\u4f4d $+1$ \u79cd\u60c5\u51b5\uff0c\u7531\u5206\u6b65\u8ba1\u6570\u539f\u7406\uff0c\u6700\u597d\u7ed3\u679c\u53ea\u9700\u5c06\u8fd9\u4e9b\u76f8\u4e58\u8d77\u6765\u5373\u53ef\u3002\n\n\u6700\u540e\uff0c$Ans=(2\u00d7p+1)\u00d7(2\u00d7q+1)\u00d7\u2026\u2026$\n\n\u7aef\u4e0a\u4e00\u6ce2\u4ee3\u7801\uff1a\n\n```cpp\nvoid scr(ll k)//\u6b27\u7b5b\uff0c\u5feb\u4e00\u4e9b\n{\n    for(ll i=2;i<=k;i++)//\u8fd9\u91cc\u53ea\u9700\u4ece2\u7b5b\u52301e7\u5373\u53ef\n    {\n        if(!unp[i])\n        {\n            prim[++cnt]=i;\n            isp[prim[cnt]]=1;\n        }\n        for(int j=1;j<=cnt&&i*prim[j]<=sqrt(k);j++)\n        {\n            unp[i*prim[j]]=1;\n            if(!(i%prim[j]))\n            {\n                break;\n            }\n        }\n    } \n}\n```\n\u4e2a\u4eba\u611f\u89c9\uff0c\u6b27\u7b5b\u4f1a\u6bd4\u57c3\u7b5b\u66f4\u5feb\u4e00\u4e9b\uff0c$isp$ \u6570\u7ec4\u7528\u6765\u4e4b\u540e\u5224\u65ad\u662f\u4e0d\u662f\u8d28\u6570\u3002\n\n```cpp\nvoid divi(ll k)//\u5206\u89e3\u8d28\u56e0\u6570\n{\n    for(ll i=2;i*i<=k;i++)//\u53ea\u9700\u5206\u89e3\u5230\u221ak\u5373\u53ef\n    {\n        if(k%i==0&&isp[i])\n        {\n            pr[++tot]=i;\n            while(k%i==0)//\u628a\u6240\u6709\u56e0\u6570i\u90fd\u9664\u6389\uff0c\u5e76\u8bb0\u5f55\u4e2a\u6570\n            {\n                k/=i;\n                prc[tot]++;\n            }\n        }\n    }\n    if(k>1)//\u6700\u540e\u5269\u4f59\u7684\u6570\u8981\u662f\u5927\u4e8e1\uff0c\u5219\u5176\u4e00\u5b9a\u662f\u8fd8\u672a\u5206\u89e3\u5230\uff0c\u8bb0\u5f55\u4e0b\u6765\n    {\n        pr[++tot]=k;\n        prc[tot]=1;\n    }\n}\n```\n\u5206\u89e3\u8d28\u56e0\u6570\u8fd9\u91cc\u6700\u91cd\u8981\u7684\u4e8b\u6700\u540e\u90a3\u4e2a $n>1$ \u7684\u5224\u65ad\uff0c\u56e0\u4e3a\u5206\u89e3\u51fa\u7684\u8d28\u56e0\u6570\u53ea\u5230 $\\sqrt{k}$ \u65e0\u6cd5\u6392\u9664\u4e4b\u5916\u662f\u5426\u8fd8\u6709\u5176\u4ed6\u8d28\u56e0\u6570\uff0c\u8981\u52a0\u4e00\u4e2a\u5224\u65ad\u3002\n\n```cpp\nint main()//\u6109\u5feb\u7684\u4e3b\u51fd\u6570\n{\n    scanf(\"%lld\",&num);\n    scr(Maxn);\n    divi(num);\n    for(int i=1;i<=tot;i++)\n    {\n        ans*=(2*prc[i]+1);\n    }\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1545571778,
        "uid": 59558,
        "name": "Skeleton",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5150 \u3010\u751f\u65e5\u793c\u7269\u3011"
    },
    {
        "content": "\u552f\u4e00\u5206\u89e3\u5b9a\u7406\uff1a\n\n$$N=\\prod_{p_i\\in\\mathbb{P}}p_i^{a_i}$$\n\n\u6211\u4eec\u8003\u8651\u8d28\u56e0\u5b50$p_i$\uff0c\u8981\u4fdd\u8bc1\u4e24\u4e2a\u6570\u7684$\\texttt{lcm}$\u6070\u597d\u4e3a$N$\uff0c\u5219\u6bcf\u4e2a\u8d28\u56e0\u5b50$p_i$\u90fd\u5728\u4e00\u4e2a\u6570\u4e2d\u6070\u597d\u6709$a_i$\u4e2a\uff0c\u4e14\u5728\u53e6\u4e00\u4e2a\u6570\u4e2d\u4e0d\u8d85\u8fc7$a_i$\u4e2a\u3002\n\n\u8003\u8651\u7b2c\u4e00\u4e2a\u6570\u6709$a_i$\u4e2a$p_i$\uff0c\u90a3\u4e48\u7b2c\u4e8c\u4e2a\u6570\u80fd\u6709$0\\sim a_i$\u4e2a\u5171$a_i+1$\u79cd\u9009\u6cd5\u3002\u540c\u7406\u7b2c\u4e8c\u4e2a\u6570\u6709$a_i$\u4e2a\uff0c\u7b2c\u4e00\u4e2a\u6570\u4e5f\u6709$a_i+1$\u79cd\u9009\u6cd5\u3002\n\n\u5176\u4e2d\u4e24\u4e2a\u6570\u4e2d\u90fd\u6709$a_i$\u4e2a\u7684\u60c5\u51b5\u7b97\u91cd\uff0c\u51cf\u6389\u4e00\u79cd\u65b9\u6848\u3002\n\n\u6240\u4ee5\u5bf9\u4e8e\u6bcf\u4e2a\u8d28\u56e0\u5b50\uff0c\u6709$2a_i+1$\u79cd\u65b9\u6848\u3002\n\n\u6240\u4ee5\u7b54\u6848\u4e3a$\\prod\\limits_{i}(2a_i+1)$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5bf9$N$\u5206\u89e3\u8d28\u56e0\u6570\u5373\u53ef\u3002\n\n\u8003\u8651\u5230$N$\u8f83\u5927\uff0c\u7528Pollard_Rho\u8fdb\u884c\u5206\u89e3\uff0c\u914d\u5408Miller_Rabin\u8fdb\u884c\u7d20\u6570\u6d4b\u8bd5\u3002\u65f6\u95f4\u590d\u6742\u5ea6$O(\\sqrt{\\sqrt{N}})$\u3002\n\n## Code\uff1a\n```cpp\n#include<cstdio>\n#include<vector>\n#include<cstdlib>\n#include<algorithm>\ntypedef long long LL;\ninline LL mul(LL a,LL b,const LL&md){\n\tLL c=a*b-LL((long double)a*b/md+.5)*md;\n\treturn(c>>63&md)+c;\n}\nLL n,ans=1;\ninline LL pow(LL a,LL b,const LL&md){\n\tLL ret=1;\n\tfor(;b;b>>=1,a=mul(a,a,md))if(b&1)ret=mul(ret,a,md);return ret;\n}\nnamespace MR{\n\tconst int P[]={2,3,5,7,11,13,17,19,23,29,31,37};\n\tbool check(int a,LL n){\n\t\tLL x=n-1;int d=0;\n\t\twhile(!(x&1))x>>=1,++d;\n\t\tfor(x=pow(a,x,n);d--;){\n\t\t\tconst LL lst=x;x=mul(x,x,n);\n\t\t\tif(x==1&&lst!=1&&lst!=n-1)return 0;\n\t\t}\n\t\treturn x==1;\n\t}\n\tbool test(LL n){\n\t\tif(n==1)return 0;\n\t\tfor(int i:P)if(n==i)return 1;\n\t\tif(!(n&1))return 0;\n\t\tfor(int i:P)if(!check(i,n))return 0;\n\t\treturn 1;\n\t}\n}\nstd::vector<LL>v;\nLL find(LL n,int c){\n\tLL x=rand()%(n-1)+1,y=x,k=2,q=1,t=1;\n\tfor(;;k<<=1,y=x,q=1){\n\t\tfor(int i=1;i<=k;++i){\n\t\t\tx=mul(x,x,n)+c-n;x+=x>>63&n;\n\t\t\tq=mul(q,llabs(x-y),n);\n\t\t\tif(!(i&127)){\n\t\t\t\tt=std::__gcd(q,n);\n\t\t\t\tif(t>1)return t;\n\t\t\t}\n\t\t\tt=std::__gcd(q,n);\n\t\t\tif(t>1)return t;\n\t\t}\n\t}\n}\nvoid rho(LL n){\n\tif(n==1)return;\n\tif(MR::test(n))return v.push_back(n);\n\tLL p=n;int c=19260817;\n\twhile(p==n)p=find(p,c--);\n\twhile(n%p==0)n/=p;\n\trho(p),rho(n);\n}\nint main(){\n\tsrand(20040607);\n\tscanf(\"%lld\",&n);\n\trho(n);\n\tfor(LL i:v){\n\t\tint a=0;\n\t\twhile(n%i==0)n/=i,++a;\n\t\tans*=a<<1|1;\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n\n---\n\n\u5176\u5b9e\u4e0d\u9700\u8981\u4ec0\u4e48Pollard_Rho\uff0c\u53ea\u9700\u8981Miller_Rabin\u4e00\u6b21\u5c31\u591f\u4e86\u3002\n\n\u9996\u5148\u628a$\\sqrt[3]N$\u4ee5\u5185\u7684\u8d28\u56e0\u6570\u7b5b\u51fa\u6765\uff0c\u7136\u540e\u5269\u4e0b\u7684\u6570\u663e\u7136\u6700\u591a\u67092\u4e2a\u8d28\u56e0\u5b50\u3002\n\n\u5206\u4e09\u7c7b\uff1a\n\n1. \u8be5\u6570\u4e3a\u5b8c\u5168\u5e73\u65b9\u6570\uff0c\u5219\u591a\u51fa\u6765\u4e86\u4e00\u4e2a$p^2$\uff0c\u7b54\u6848\u4e585\u3002\n2. \u8be5\u6570\u4e3a\u8d28\u6570\uff0c\u5219\u591a\u51fa\u6765\u4e00\u4e2a$p$\uff0c\u7b54\u6848\u4e583\u3002\n3. \u5176\u4ed6\u60c5\u51b5\uff0c\u5219\u591a\u51fa\u6765\u4e24\u4e2a\u4e0d\u540c\u7684$p$\uff0c\u7b54\u6848\u4e589\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(\\sqrt[3]N)$\u3002\n\n\u7b5b\u5b50\u90fd\u4e0d\u7528\u6253\u3002\n\n## Code\uff1a\n```cpp\n#include<cstdio>\n#include<cmath>\ntypedef long long LL;\ninline LL mul(LL a,LL b,const LL&md){\n\tLL c=a*b-LL((long double)a*b/md+.5)*md;\n\treturn(c>>63&md)+c;\n}\nLL n,ans=1;\ninline LL pow(LL a,LL b,const LL&md){\n\tLL ret=1;\n\tfor(;b;b>>=1,a=mul(a,a,md))if(b&1)ret=mul(ret,a,md);return ret;\n}\nnamespace MR{\n\tconst int P[]={2,3,5,7,11,13,17,19,23,29,31,37};\n\tbool check(int a,LL n){\n\t\tLL x=n-1;int d=0;\n\t\twhile(!(x&1))x>>=1,++d;\n\t\tfor(x=pow(a,x,n);d--;){\n\t\t\tconst LL lst=x;x=mul(x,x,n);\n\t\t\tif(x==1&&lst!=1&&lst!=n-1)return 0;\n\t\t}\n\t\treturn x==1;\n\t}\n\tbool test(LL n){\n\t\tif(n==1)return 0;\n\t\tfor(int i:P)if(n==i)return 1;\n\t\tif(!(n&1))return 0;\n\t\tfor(int i:P)if(!check(i,n))return 0;\n\t\treturn 1;\n\t}\n}\nint main(){\n\tscanf(\"%lld\",&n);\n\tfor(int i=2;i<=233333;++i)if(n%i==0){\n\t\tint cnt=1;\n\t\twhile(n%i==0)cnt+=2,n/=i;\n\t\tans*=cnt;\n\t}\n\tif(n>1){\n\t\tint x=sqrt(n)+.5;\n\t\tif(LL(x)*x==n)ans*=5;else\n\t\tif(MR::test(n))ans*=3;else ans*=9;\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1547020410,
        "uid": 6813,
        "name": "mrsrz",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5150 \u3010\u751f\u65e5\u793c\u7269\u3011"
    },
    {
        "content": "\u524d\u7f6e\uff1a\u552f\u4e00\u5206\u89e3\u5b9a\u7406\n\n$$ n = \\prod p_i^{x_i} $$\n\n\u5176\u4e2d $ p_i $ \u4e3a\u8d28\u6570\n\n~~\u8bf4\u4eba\u8bdd\uff0c\u5c31\u662f\u8d28\u56e0\u6570\u5206\u89e3~~\n\n---\n\n\u8003\u8651\u4e24\u4e2a\u6570\u7684 $ \\rm{lcm} $ \u503c\u3002\u5982\u679c $ a = \\prod p_i^{x_i}, b = \\prod p_i^{y_i} $\uff08\u5047\u8bbe\u4e24\u4e2a\u6570\u7684 $ p $ \u96c6\u5408\u76f8\u540c\uff09\n\n\u90a3\u4e48 $ \\rm{lcm}$ $(a, b) = \\prod p_i^{\\max(x_i, y_i)} $\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff0c$ 12 = 2^2 \\times 3 $\uff0c$ 54 = 2 \\times 3^3 $\n\n\u90a3\u4e48 $ \\rm{lcm}$ $(12, 54) = 2^2 \\times 3^3 = 108 $\n\n\u7b80\u5355\u7406\u89e3\u4e00\u4e0b\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8d28\u56e0\u5b50\uff0c\u56e0\u4e3a\u8981\u4fdd\u8bc1 $\\rm{lcm}$ \u88ab $ a $ \u6574\u9664\uff0c\u56e0\u6b64 $\\rm{lcm}$ \u4e2d\u8be5\u8d28\u56e0\u5b50\u7684\u4e2a\u6570\u5e94\u5f53\u81f3\u5c11\uff08\u5927\u4e8e\u7b49\u4e8e\uff09\u4e3a $ x_i $\uff08$ a $ \u4e2d\u8be5\u8d28\u56e0\u5b50\u7684\u4e2a\u6570\uff09\n\n\u540c\u7406\u4e5f\u5e94\u8be5\u5927\u4e8e\u7b49\u4e8e $ y_i $\uff08$ b $ \u4e2d\u8be5\u8d28\u56e0\u5b50\u7684\u4e2a\u6570\uff09\n\n---\n\n\u90a3\u4e48\u5982\u679c\u786e\u5b9a\u4e86 $\\rm{lcm} $ \u4e2d\u67d0\u4e00\u8d28\u56e0\u5b50\u7684\u4e2a\u6570\uff0c\u4e0d\u59a8\u8bbe\u8fd9\u4e2a\u8d28\u56e0\u5b50\u4e3a $ p $\uff0c\u4e2a\u6570\u4e3a $ x $\n\n\u5219 $ a, b $ \u4e2d\u8d28\u56e0\u5b50 $ p $ \u7684\u4e2a\u6570\u5171\u6709 $2x + 1 $ \u79cd\u60c5\u51b5\uff1a\n\n$ a $ \u4e2d $ 0 $ \u4e2a\uff0c$ b $ \u4e2d $ x $ \u4e2a\uff1b\n\n$ a $ \u4e2d $ 1 $ \u4e2a\uff0c$ b $ \u4e2d $ x $ \u4e2a\uff1b\n\n$ a $ \u4e2d $ 2 $ \u4e2a\uff0c$ b $ \u4e2d $ x $ \u4e2a\uff1b\n\n\u2026\u2026\n\n$ a $ \u4e2d $ x $ \u4e2a\uff0c$ b $ \u4e2d $ x $ \u4e2a\uff1b\n\n$ a $ \u4e2d $ x $ \u4e2a\uff0c$ b $ \u4e2d $ x - 1 $ \u4e2a\uff1b\n\n\u2026\u2026\n\n$ a $ \u4e2d $ x $ \u4e2a\uff0c$ b $ \u4e2d $ 0 $ \u4e2a\uff1b\n\n\u4e5f\u5c31\u662f\u5176\u4e2d\u4efb\u610f\u4e00\u4e2a\u6570\u6709 $ x $ \u4e2a $ p $ \u8d28\u56e0\u5b50\uff0c\u5269\u4e0b\u90a3\u4e2a\u53ef\u80fd\u6709 $ 0 \\sim x $ \u4e2a\n\n---\n\n\u53c8\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c\u5982\u679c\u5bf9\u4e8e $ p_i $ \u8fd9\u4e2a\u8d28\u56e0\u5b50\uff0c$ a, b $ \u6709 $ s_i( = 2x_i + 1) $ \u79cd\u53d6\u503c\n\n\u90a3\u4e48\u603b\u65b9\u6848\u6570 $ = \\prod s_i $\n\n\u6240\u4ee5\u53ea\u8981\u5148\u5c06 $ n $ \u8d28\u56e0\u6570\u5206\u89e3\uff0c\u518d\u6309\u4e0a\u8ff0\u516c\u5f0f\u8ba1\u7b97\u5373\u53ef\n\n---\n\n\u4e8e\u662f\u4f60\u5174\u51b2\u51b2\u5730\u6253\u5b8c $ O(n) $ [\u7ebf\u6027\u7b5b](https://www.luogu.com.cn/problem/P3383)\uff08\u53ea\u9700\u8981\u7b5b\u5230 $ \\leqslant \\sqrt n $ \u7684\u8d28\u6570\uff0c\u8bb0\u5f97\u5904\u7406\u6700\u540e\u5269\u4e0b\u4e00\u4e2a $ > 10^8 $ \u7684\u8d28\u6570\u7684\u60c5\u51b5.\uff09\uff0c\u4ea4\u4e0a\u53bb\u65f6\uff1aTLE\n\n\u63a5\u4e0b\u6765\u5c31\u662f\u5361\u5e38\u5c0f trick \u4e86\n\n0. O2, O3, Ofast, \u706b\u8f66\u5934\n\n1. I/O \u4f18\u5316\uff08\u6b64\u9898\u7528\u5904\u5fae\u4e4e\u5176\u5fae\uff09\n\n2. register, inline\n\n3. \u77ed\u8def\u8fd0\u7b97\u7b26\uff08\u7528\u5904\u4e0d\u5927\uff09\n\n4. __\u867d\u7136\u8bf4\u201c\u4e0d\u5f00 `long long` \u89c1 * *\u201d\uff0c\u4f46\u662f `#define int long long` \u786e\u5b9e\u4f1a\u8ba9\u7a0b\u5e8f\u6027\u80fd\u4e0b\u964d\u4e0d\u5c11\u3002\u4e0d\u9700\u8981 `long long` \u7684\u5730\u65b9\u53ef\u4ee5\u7528 `int\t`\u3002\uff08\u672c\u9898\u6548\u679c\u663e\u8457\uff09__\n\n5. \u5982\u679c MLE\uff0c\u53ef\u80fd\u662f\u5b58\u653e\u8d28\u6570\u7684\u6570\u7ec4\u592a\u5927\u3002\u4e8b\u5b9e\u4e0a\uff0c\u4e0d\u9700\u8981\u5f00\u5230 $ 10^8 $ \u4e2a\u8d28\u6570\uff0c\u56e0\u4e3a $ 10^8 $ \u4ee5\u5185\u7684\u8d28\u6570\u53ea\u6709 $ 5761455 $ \u4e2a\u3002\n\n\u867d\u7136\u590d\u6742\u5ea6\u6ca1\u6709 dalao \u4eec\u7684\u795e\u5947\u6570\u5b66\u4f18\u79c0 orz\uff0c\u4f46\u662f\u8db3\u591f\u901a\u8fc7\u6b64\u9898\u4e86\n\nCode: \n\n```cpp\n#pragma GCC optimize(2)\n#pragma GCC optimize(3)\n#pragma GCC optimize(\"Ofast\")\n#include <bits/stdc++.h>\nusing namespace std;\n#define ll long long\nbool isp[100000001];\nint primes[6000000], pcnt = 0;\nvoid Init(int n)\n{\n\tisp[1] = true;\n\tfor(register int i = 2; i <= n; i++)\n\t{\n\t\tif(!isp[i])\n\t\t\tprimes[++pcnt] = i;\n\t\tfor(register int j = 1; (ll)i * primes[j] <= n && j <= pcnt; j++)\n\t\t{\n\t\t\tisp[i * primes[j]] = true;\n\t\t\tif(i % primes[j] == 0)\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\nsigned main()\n{\n\tll n;\n\tscanf(\"%lld\", &n);\n\tInit(sqrt(n));\n\tll ans = 1;\n\tfor(int i = 1; i <= pcnt; i++)\n\t{\n\t\tif(n % primes[i] == 0)\n\t\t{\n\t\t\tint res = 0;\n\t\t\twhile(n % primes[i] == 0)\n\t\t\t{\n\t\t\t\tn /= primes[i];\n\t\t\t\tres++;\n\t\t\t}\n\t\t\tans *= (2 * res + 1);\n\t\t\tif(n == 1)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tif(n > 1)\n\t\tans *= 3;\n\tprintf(\"%lld\\n\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1595942011,
        "uid": 73645,
        "name": "_ztyqwq",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5150 \u3010\u751f\u65e5\u793c\u7269\u3011"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/yifusuyi/p/10248113.html)\n\n## Description\n\n\u7ed9\u5b9a $n$\uff0c\u6c42\n\n$$\\sum_{i}~\\sum_j~[lcm(i,j)~=~n]$$\n\n## input\n\n\u4e00\u884c\u4e00\u4e2a\u6574\u6570\u4ee3\u8868 $n$\n\n## Output\n\n\u4e00\u884c\u4e00\u4e2a\u6574\u6570\u4ee3\u8868\u7b54\u6848\n\n## Hint\n\n$1~\\leq~n~\\leq~10^{16}$\n\n## Solution\n\n\u4e00\u5f00\u59cb\u770b\u5230\u8fd9\u4e2a\u5f62\u5f0f\u4ee5\u4e3a\u662f\u53cd\u6f14\uff0c\u7136\u540e\u770b\u5230\u6570\u636e\u8303\u56f4\u5c31\u81ea\u95ed\u4e86\u2026\u2026\n\n\u7136\u540e\u53d1\u73b0\u8fd9\u662f\u4e2a\u552f\u4e00\u5206\u89e3\u5b9a\u7406\u9898\u2026\u2026\n\n\u5410\u69fd\u4e00\u4e0b\u6807\u7b97 $O(\\sqrt{n})$ \u66b4\u529b\u5361\u5e38 \u8303\u56f4\u51fa1e16\u4e5f\u592a[\u6570\u636e\u5220\u9664]\u4e86\u5427\uff08\u5927\u96fe\n\n\u7136\u540e\u7528py\u5199\u4e86\u4e00\u53d1\u548c\u6807\u7b97\u5dee\u4e0d\u591a\u7684\u66b4\u529b\uff0c\u60e8\u906d\u5361\u5e38\n\n\u6240\u4ee5\u8fd9\u91cc\u6765\u63d0\u4f9b\u4e00\u79cd $O(\\sqrt[3]{n})$ \u7684\u65b9\u6cd5\uff01\n\n\u5176\u5b9e\u5c31\u662f\u8ba8\u8bba\u91cc @[mrsrz](https://www.luogu.org/space/show?uid=6813) \u795e\u4ed9\u7684\u7b2c\u4e00\u79cd\u8e29\u6807\u7b97\u505a\u6cd5\n\n\u8bbe\n\n$$n~=~\\prod_{i = 1}^{k} p_i^{c_i}$$\n\n$$x~=~\\prod_{i = 1}^k p_i^{d_i}$$\n\n$$y~=~\\prod_{i = 1}^{k}~p_{i}^{e_i}$$\n\n\u5176\u4e2d $p$ \u4e3a\u8d28\u6570\u3002\n\n\u5219\u663e\u7136\u6709\n\n$$lcm(x, y)~=~n~\\Leftrightarrow~\\forall~i~\\in~[1,k],c_i~=~\\max(d_i,e_i)$$\n\n\u6211\u4eec\u8003\u8651\u56fa\u5b9a $x$ \u7b2c $i$ \u4f4d\u6307\u6570\u5373 $d_i~=~c_i$\uff0c\u5219 $e_i$ \u9009 $[0,c_i]$ \u90fd\u662f\u5408\u6cd5\u7684\uff0c\u5171 $c_i~+~1$ \u4e2d\u9009\u6cd5\u3002\u5c06 $x,y$ \u53cd\u8fc7\u6765\u540c\u6837\u6210\u7acb\u3002\u4f46\u662f\u6ce8\u610f\u56fa\u5b9a $d_i~=~c_i$ \u65f6\u4ee4 $e_i~=~c_i$ \u7684\u9009\u6cd5\u548c\u53cd\u8fc7\u6765\u662f\u4e00\u6837\u7684\uff0c\u4e8e\u662f\u8981\u628a\u8fd9\u4e2a\u65b9\u6848\u6263\u9664 $1$\u3002\n\n\u6240\u4ee5\u5bf9\u4e8e\u7b2c $i$ \u4e2a\u8d28\u56e0\u5b50\u7684\u65b9\u6848\u6570\u4e3a $(2~\\times c_i~+~1)$\u3002\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c\u603b\u65b9\u6848\u6570\u4e3a\n\n$$\\prod_{i = 1}^{k}~(2~\\times~c_i~+~1)$$\n\n\u4e8e\u662f $O(\\sqrt{n})$ \u5206\u89e3\u4e00\u4e0b\uff0c\u53d1\u73b0py\u88ab\u5361\u5e38\u4e86\u3002\u6211\u4eec\u8003\u8651\u4e00\u79cd\u66f4\u4f18\u79c0\u7684\u505a\u6cd5\uff1a\n\n\u6211\u4eec\u5728\u5206\u89e3\u8d28\u56e0\u6570\u65f6\uff0c\u5206\u89e3\u5230 $\\sqrt[3]{n}$\uff0c\u5373\u5f53 $i^3~>~n$ \u65f6\u505c\u6b62\u3002\u8003\u8651\u73b0\u5728 $n$ \u9664\u6389\u5df2\u7ecf\u7b5b\u51fa\u7684\u8d28\u56e0\u5b50\u540e\u5269\u4e0b\u7684\u503c\u5171\u6709\u5982\u4e0b\u51e0\u79cd\u60c5\u51b5\uff1a\n\n> \u5269\u4e0b $1$\uff1a\u8fd9\u79cd\u60c5\u51b5\u5bf9\u7b54\u6848\u65e0\u8d21\u732e\uff0c\u65e0\u9700\u7406\u4f1a\n>\n> \u5269\u4e0b\u7684\u6570\u662f\u4e00\u4e2a\u8d28\u6570\uff1a\u663e\u7136\u8fd9\u4e2a\u5269\u4e0b\u7684\u6570\u662f $n$ \u7684\u6700\u540e\u4e00\u4e2a\u8d28\u56e0\u5b50\uff0c\u5e76\u4e14\u6307\u6570\u663e\u7136\u4e3a $1$\uff0c\u4e8e\u662f\u76f4\u63a5\u5c06\u7b54\u6848\u4e58 $3$ \u5373\u53ef\n\n\u8003\u8651\u9664\u53bb\u8fd9\u4e24\u79cd\u60c5\u51b5\u5916\uff0c\u5269\u4e0b\u7684\u6570\u53ea\u80fd\u662f\u4e24\u4e2a\u8d28\u6570\u7684\u79ef\uff0c\u800c\u4e0d\u53ef\u80fd\u662f\u66f4\u591a\u8d28\u6570\u7684\u79ef\u3002\n\n\u8bc1\u660e\u4e0a\uff0c\u53ef\u4ee5\u8bbe\u5269\u4e0b\u7684\u6700\u5c0f\u7684\u8d28\u6570\u662f $p$\uff0c\u5219\u6709 $p~>~\\sqrt[3]{n}$\uff0c\u5047\u8bbe\u662f $k$ \u4e2a\u8d28\u6570\u7684\u4e58\u79ef\uff0c\u90a3\u4e48\u663e\u7136\u6709\u5269\u4e0b\u7684\u6570\u5b57 $dn~\\geq~p^k$\u3002\u7531\u4e8e $p^3~>~(\\sqrt[3]{n})^3~=~n$\uff0c$dn~\\leq~n$\uff0c\u5219\u5728 $k~\\geq~3$ \u65f6\u4ea7\u751f\u77db\u76fe\uff0c\u4e8e\u662f $k~\\leq~2$\u3002\n\n\u518d\u5206\u4e24\u79cd\u60c5\u51b5\uff1a\n\n> \u5269\u4e0b\u7684\u6570\u662f\u4e00\u4e2a\u8d28\u6570\u7684\u5e73\u65b9\uff1a\u76f4\u63a5\u5c06\u7b54\u6848\u4e58 $5$ \u5373\u53ef\n>\n> \u5426\u5219\u4e00\u5b9a\u662f\u4e24\u4e2a\u8d28\u6570\u76f8\u4e58\u3002\u8003\u8651\u6bcf\u4e2a\u8d28\u6570\u8d21\u732e $3$\uff0c\u6240\u4ee5\u5c06\u7b54\u6848\u4e58\u4e0a $9$ \u5373\u53ef\u3002\n\n\u8003\u8651\u5982\u4f55\u5feb\u901f\u5224\u65ad\u5269\u4e0b\u7684\u6570\u5b57\u662f\u4e00\u4e2a\u8d28\u6570\uff1a\u76f4\u63a5\u8fdb\u884c\u7c73\u52d2\u62c9\u5bbe\u8d28\u6570\u5224\u5b9a\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\log n)$\u3002\n\n\u8003\u8651\u4e0d\u635f\u5931\u7cbe\u5ea6\u7684\u5224\u65ad\u4e00\u4e2a\u6570\u662f\u4e00\u4e2a\u5b8c\u5168\u5e73\u65b9\u6570\uff1a\u76f4\u63a5\u8fdb\u884c\u4e8c\u5206\u5f00\u65b9\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\log n)$\n\n\u4e8e\u662f\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\sqrt[3]{n})$\uff0c\u8e29\u7206\u6807\u7b97\n\n## Code\n\n```cpp\ndef mpow(x, y, p):\n\t_ret, _temp = 1, x\n\twhile y:\n\t\tif y & 1:\n\t\t\t_ret = _ret * _temp % p\n\t\t_temp = _temp * _temp % p\n\t\ty >>= 1\n\treturn _ret\n\ndef ML(x, n):\n\tif n == x: return 1\n\tsn = n - 1\n\ts, d = n - 1, 0\n\twhile not (s & 1):\n\t\ts >>= 1\n\t\td += 1\n\tt = mpow(x, s, n)\n\tif t == 1 or t == -1: return 1\n\tfor i in range(d):\n\t\tif t == sn: return 1\n\t\tt = t * t % n\n\treturn 0\n\ndef IsPrime(x):\n\tif not (x & 1):\n\t\tif x == 2: return 1\n\t\telse: return 0\n\telif not ML(2, x): return 0\n\telif not ML(7, x): return 0\n\telif not ML(61, x): return 0\n\telse: return 1\n\ndef IsPow(x):\n\tl, r, mid, = 1, x, 0\n\twhile l <= r:\n\t\tmid = (l + r) >> 1\n\t\tk = mid * mid\n\t\tif k < x: l = mid + 1\n\t\telif k == x: return 1\n\t\telse: r = mid - 1\n\treturn 0\n\nn = int(input())\n\nans, i, dn = 1, 2, n\n\nwhile (i * i * i) <= n:\n\tif (dn % i) == 0:\n\t\tcnt = 0\n\t\twhile (dn % i) == 0:\n\t\t\tdn //= i\n\t\t\tcnt += 1\n\t\tans *= (cnt << 1) + 1\n\ti += 1\nif dn != 1:\n\tif IsPrime(dn):\n\t\tans *= 3\n\telif IsPow(dn):\n\t\tans *= 5\n\telse:\n\t\tans *= 9\n\t\t\nprint(ans)\n```",
        "postTime": 1547084757,
        "uid": 65363,
        "name": "\u4e00\u6276\u82cf\u4e00",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5150 \u3010\u751f\u65e5\u793c\u7269\u3011"
    },
    {
        "content": "\u867d\u7136\u9898\u76ee\u4e0d\u96be\uff0c\u4f46\u80cc\u540e\u8574\u542b\u7684\u8003\u70b9\u8fd8\u662f\u5f88\u6709\u610f\u601d\u7684\u3002\n\n\u672c\u9898\u7684\u6838\u5fc3\u8003\u70b9\u662f**\u552f\u4e00\u5206\u89e3\u5b9a\u7406**\u3002\n\n# \u6b64\u8003\u70b9\u66fe\u5728NOIP\u4e2d\u6d89\u53ca\uff0c\u975e\u5e38\u91cd\u8981\uff01\uff01\uff01\n\n\u4f8b\u5982 [NOIP2009 Hankson\u7684\u8da3\u5473\u9898](https://www.luogu.com.cn/problem/P1072)\n\n\u552f\u4e00\u5206\u89e3\u5b9a\u7406\uff1a\u8bbe $p_i$ \u8868\u793a\u7b2c $i$ \u4e2a\u8d28\u6570\uff0c\u90a3\u4e48\u5bf9\u4e8e\u4efb\u610f\u6b63\u6574\u6570$N$\uff0c\u90fd\u6709**\u552f\u4e00\u7684**\u4e00\u7ec4 $a_1,a_2,a_3\\dots a_n$ \uff0c\u4f7f\u5f97\n\n$$N=p_1^{a_1}\\times p_2^{a_2}\\times p_3^{a_3}\\times\\dots\\times p_n^{a_n}$$\n\n\u5176\u4e2d $a_i$ \u53ef\u4ee5\u7b49\u4e8e$0$\u3002\n\n\u7528\u767d\u8bdd\u6587\u8bf4\uff1a\u4efb\u4f55\u6570\u90fd\u53ef\u4ee5\u8868\u793a\u4e3a\u4ed6\u7684\u8d28\u56e0\u6570\u4eec\u7684\u82e5\u5e72\u6b21\u5e42\u7684\u4e58\u79ef\uff0c\u800c\u5e42\u6307\u6570\u5e8f\u5217\u662f\u786e\u5b9a\u7684\u3002\n\n\u63a8\u8bba\uff1a\u5bf9\u4e8e $\\forall x,y$ \uff0c\u5176\u4e2d\n\n$$x=p_1^{a_1}\\times p_2^{a_2}\\times p_3^{a_3}\\times\\dots\\times p_n^{a_n}$$\n\n$$y=p_1^{b_1}\\times p_2^{b_2}\\times p_3^{b_3}\\times\\dots\\times p_n^{b_n}$$\n\n\u5219\n\n$$\\gcd(x,y)=p_1^{\\min(a_1,b_1)}\\times p_2^{\\min(a_2,b_2)}\\times p_3^{\\min(a_3,b_3)}\\times\\dots\\times p_n^{\\min(a_n,b_n)}$$\n\n$$\\operatorname{lcm}(x,y)=p_1^{\\max(a_1,b_1)}\\times p_2^{\\max(a_2,b_2)}\\times p_3^{\\max(a_3,b_3)}\\times\\dots\\times p_n^{\\max(a_n,b_n)}$$\n\n\u56de\u5230\u672c\u9898\uff0c\u7ed9\u5b9a\u6574\u6570 $n$ \uff0c\u6c42\u6709\u591a\u5c11\u5bf9 $x,y$ \uff0c\u6ee1\u8db3 $\\operatorname{lcm}(x,y)=n$ \u3002\n\n\u5bf9 $n$ \u5206\u89e3\u8d28\u56e0\u6570\uff0c\u5f97\u5230 $n$ \u7684\u552f\u4e00\u5206\u89e3\u5e8f\u5217 $S=\\{a_1,a_2,a_3,\\dots,a_n\\}$ \u3002\n\n\u5bf9\u4e8e\u5e8f\u5217\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5143\u7d20 $a_i$ \uff0c\u8981\u6c42 $x,y$ \u7684\u5206\u89e3\u5e8f\u5217\u4e2d\u7684\u5bf9\u5e94\u5143\u7d20 $x_i,y_i$ **\u66f4\u5927\u7684\u90a3\u4e2a**\u4e0e $a_i$ \u76f8\u7b49\uff0c\u53e6\u4e00\u4e2a\u53ef\u4ee5\u5728 $[0,a_i-1]$ \u4e2d\u4efb\u53d6\u3002\n\n\u5f53 $x_i=a_i$ \u65f6\uff0c $y_i\\in[0,a_i-1]$ \uff0c\u5171 $a_i$ \u79cd\u65b9\u6cd5\uff1b\n\n\u5f53 $y_i=a_i$ \u65f6\uff0c $x_i\\in[0,a_i-1]$ \uff0c\u5171 $a_i$ \u79cd\u65b9\u6cd5\u3002\n\n\u6839\u636e\u52a0\u6cd5\u539f\u7406\uff0c\u5e94\u6709 $d_i=2\\times a_i$ \u79cd\u65b9\u6cd5\u3002\n\n\u7136\u800c\uff0c\u521a\u521a\u7684\u8ba1\u7b97\u4e2d\uff0c $\\begin{cases}x_i=a_i\\\\y_i=a_i\\end{cases}$ \u7684\u60c5\u51b5\u88ab\u7b97\u4e86\u4e24\u6b21\uff0c\u56e0\u6b64\u8981\u51cf1\u3002\n\n\u5bf9\u4e8e\u5206\u89e3\u5e8f\u5217\u4e2d\u7684\u5176\u4ed6\u5143\u7d20\uff0c\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c\u5404\u4e2a\u8d28\u56e0\u6570\u76f4\u63a5\u7684\u65b9\u6cd5\u4e92\u4e0d\u5e72\u6d89\uff0c\u6700\u7ec8\u7684\u7b54\u6848\u5e94\u5f53\u662f\u5404 $d_i$ \u76f8\u4e58\u7684\u79ef\n$$\\prod_{i=1}^n d_i$$\n\n\u6700\u540e\u662f\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790\u3002\n\n\u8ba1\u7b97\u7684\u74f6\u9888\u5728\u4e8e\u5206\u89e3\u8d28\u56e0\u6570\uff0c\u5982\u679c\u4f7f\u7528Pollard_Rho\u8fdb\u884c\u5206\u89e3\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\sqrt{\\sqrt{n}})$ \uff0c\u975e\u5e38\u5c0f\u7684\u4e00\u4e2a\u6570\uff1b\u7136\u800c\u5982\u679c\u7528\u66b4\u529b\u5206\u89e3\u8d28\u56e0\u6570\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\sqrt n)$ \uff0c\u5b9e\u9645\u6d4b\u8bd5\u4e2d\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n\u5b9e\u9645\u4e0a\uff0c\u5728\u8bb8\u591a\u9898\u76ee\u4e2d\uff0c\u5982\u679c $n$ \u5728longlong\u8303\u56f4\u5185\u4e14\u6ca1\u6709\u591a\u7ec4\u6570\u636e\uff0c $O(\\sqrt n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u5f88\u96beTLE\u7684\u3002\n\n\u6240\u4ee5\u672c\u9898\u5c31\u8f7b\u677e\u6109\u5feb\u5730\u89e3\u51b3\u5566\uff01\n\n\u603b\u7ed3\uff1a\n\n1. \u552f\u4e00\u5206\u89e3\u5b9a\u7406\u7684\u5185\u5bb9\u53ca\u5176\u63a8\u8bba\uff0c\u52a1\u5fc5\u7262\u8bb0\n\n2. \u5982\u679c\u7ec4\u6210\u95ee\u9898\u7684\u5404\u4e2a\u201c\u4f4d\u201d\u4e4b\u95f4\u76f8\u4e92\u72ec\u7acb\uff0c\u53ef\u4ee5\u8003\u8651\u628a\u5f85\u6c42\u89e3\u7684\u95ee\u9898\u201c\u6309\u4f4d\u5206\u89e3\u201d\uff0c\u8fd9\u79cd\u601d\u60f3\u4e0d\u4ec5\u5728\u6570\u8bba\u9898\u4e2d\u5341\u5206\u91cd\u8981\uff0c\u5728\u52a8\u6001\u89c4\u5212\u4e2d\u4e5f\u7ecf\u5e38\u51fa\u73b0\u3002\n\nAC\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#define re register\ntypedef long long ll;\nusing namespace std;\n\nll n,cnt,ans = 1;\n\nint main(){\n\tcin>>n;\n\tfor(re int i = 2; i < sqrt(n); ++i){\n\t\tcnt = 0;\n\t\twhile(n%i==0){\n\t\t\t++cnt;\n\t\t\tn /= i;\n\t\t}\n\t\tif(cnt) ans *= (cnt<<1)+1;\n\t}\n\tif(n>1) ans *= 3;//n>1\n\tcout<<ans<<endl;\n\t\n\treturn 0;\n}\n```\n",
        "postTime": 1601377462,
        "uid": 261932,
        "name": "qpdk777",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5150 \u3010\u751f\u65e5\u793c\u7269\u3011"
    },
    {
        "content": "\u56e0\u4e3a $n = lcm(a, b)$ \uff0c\u53ef\u4ee5\u5f97\u51fa\uff1a\n- $ a $ \u548c $ b $ \u7684\u8d28\u56e0\u6570\u90fd\u662f $ n $ \u7684\u8d28\u56e0\u6570\n- \u5bf9\u4e8e $ n $ \u7684\u6bcf\u4e2a\u8d28\u56e0\u6570 $ x $ \uff0c\u5728 $ n $ \u4e2d\u7684\u6b21\u6570\u4e3a $ y $ \uff0c\u90a3\u4e48 $ x $ \u5728 $ a $ \u548c $ b $ \u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u6b21\u6570\u4e3a $y$ \uff0c\u5728\u53e6\u4e00\u4e2a\u4e2d\u7684\u6b21\u6570 $<=y$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u628a $ n $ \u7684\u6bcf\u4e2a\u8d28\u56e0\u6570\u7684\u6b21\u6570\u6c42\u51fa\u6765\u5c31\u597d\u4e86\u3002~~\uff08\u8fd9\u90e8\u5206\u6211\u597d\u50cf\u8bb2\u5f97\u5f88\u7cdf\u7cd5\uff0c\u5927\u5bb6\u8fd8\u662f\u770b Skeleton \u5927\u4f6c\u7684\u9898\u89e3\u5427\uff09~~\n\n\u5177\u4f53\u5b9e\u73b0\u6211\u6ca1\u6709\u7528\u5230\u7b5b\u8d28\u6570\u800c\u662f\u76f4\u63a5\u9664\u3002\u4ee5\u4e0b\u662f80\u5206TLE\u4ee3\u7801\uff1a\n```\n#include<bits/stdc++.h>\n\ntypedef unsigned long long ull; \n\null n; \n\nint cnt = 1; \nchar vis[10000003]; \n\null res = 1; \n\nvoid get(ull x, ull in) { // x \u8868\u793a\u9664\u5269\u4e0b\u7684\u90e8\u5206\uff0cin \u8868\u793a\u5f53\u524d\u679a\u4e3e\u5230\u7684\u6570\uff08\u4e0d\u7528\u7ba1\u662f\u4e0d\u662f\u8d28\u6570\uff0c\u4e0d\u662f\u7684\u8bdd\u80af\u5b9a\u5df2\u7ecf\u9664\u5b8c\u4e86\uff09\n    if(x == 1) return ; \n    while(x % in) in += 2; // 2 \u5df2\u7ecf\u505a\u6389\u4e86\uff0c\u540e\u9762\u7684\u8d28\u6570\u90fd\u662f\u5947\u6570\n    cnt++; // \u65b0\u7684\u4e00\u4e2a\u80fd\u9664\u7684\n    while(x % in == 0) x /= in, vis[cnt]++; // \u7edf\u8ba1\u80fd\u9664\u51e0\u6b21\n    get(x, in + 2); \n}\n\nint main() {\n    scanf(\"%lld\", &n); \n\n    while((n & 1) == 0) n >>= 1, vis[1]++; \n    get(n, 3); \n    for(int i = 1; i <= cnt; i++) res *= 2ll * (int)vis[i] + 1; \n\n    printf(\"%lld\\n\", res); \n\n    return 0; \n}\n```\n\n\u8fd9\u4e2a\u65f6\u5019\u53ef\u4ee5\u7528 $ \\sqrt{n} $ \u6765\u4f18\u5316\u4e00\u4e0b\u3002\u5982\u679c\u5f53\u524d\u679a\u4e3e\u5230\u7684\u6570\u5df2\u7ecf\u8d85\u8fc7 $\\sqrt{n}$ \u5e76\u4e14\u9664\u5269\u4e0b\u7684\u4e0d\u662f $ 1 $ \uff0c\u8bf4\u660e\u5269\u4e0b\u7684\u80af\u5b9a\u662f\u4e2a\u8d28\u6570\uff0c\u56e0\u4e3a\u5176\u4ed6\u8d28\u6570\u90fd\u679a\u4e3e\u5b8c\u4e86\u3002\u6ce8\u610f\u8fd9\u91cc\u4e0d\u80fd\u7528 $ \\sqrt{x} $ \u6765\u5224\u65ad\uff0c\u539f\u56e0\u60f3\u60f3\u5e94\u8be5\u5c31\u80fd\u660e\u767d~~\u800c\u4e14\u6211\u4e00\u5f00\u59cb\u5c31\u662f\u8fd9\u6837\u505a\u7684\u51e0\u4e4eWA\u5149~~\n\nAC\u4ee3\u7801\uff1a\n```\n#include<bits/stdc++.h>\n\ntypedef unsigned long long ull; \n\null n; \n\nint cnt = 1; \nchar vis[10000003]; \n\null k, res = 1; \n\nvoid get(ull x, ull in) {\n    if(x == 1) return ; \n    while(x % in) {\n        in += 2; \n        if(in > k) {\n            vis[++cnt] = 1; \n            return ; \n        }\n    }\n    cnt++; \n    while(x % in == 0) x /= in, vis[cnt]++; \n    get(x, in + 2); \n}\n\nint main() {\n    scanf(\"%lld\", &n); \n\n    while((n & 1) == 0) n >>= 1, vis[1]++; \n    k = sqrt(n); \n    get(n, 3); \n    for(int i = 1; i <= cnt; i++) res *= 2ll * (int)vis[i] + 1; \n\n    printf(\"%lld\\n\", res); \n\n    return 0; \n}\n```",
        "postTime": 1546068024,
        "uid": 75165,
        "name": "\u5f7c\u5cb8\u5f52\u822a",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5150 \u3010\u751f\u65e5\u793c\u7269\u3011"
    },
    {
        "content": "# \u9898\u89e3 P5150 \u3010\u751f\u65e5\u793c\u7269\u3011\n\n\u8fd9\u9053\u9898\u60f3\u6cd5\u5f88\u597d\u8003\u8651\uff0c\u9996\u5148\u8981\u7528\u5c06 $n$ \u5206\u89e3\u8d28\u56e0\u6570\u3002\n\n\u9996\u5148\u628a\u7d20\u6570\u7b5b\u51fa\u6765\uff0c\u8fd9\u91cc\u7528\u6b27\u62c9\u7b5b\u6cd5\uff0c\u5c06\u7d20\u6570\u5168\u90e8\u7b5b\u51fa\u6765\n\n```cpp\ninline void get_prime()\n{\n\tfor (int i = 2; i <= SIZE; ++i)\n\t{\n\t\tif (!vis[i])\n\t\t{\n\t\t\tprime[++cnt] = i;\n\t\t\tisw[prime[cnt]] = true;\n\t\t}\n\t\tfor (int j = 1; j <= cnt && i * prime[j] <= sqrt(SIZE); ++j)\n\t\t{\n\t\t\tvis[i*prime[j]] = true;\n\t\t\tif (!(i % prime[j])) break;\n\t\t}\n\t}\n}\n```\n\n\u800c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $n$ \u90fd\u4e00\u5b9a\u53ef\u4ee5\u8f6c\u5316\u6210\u51e0\u4e2a\u7d20\u6570\u7684\u4e58\u79ef\uff1a\n\n$$\nn = prime_1 \\times prime_2 \\times \\cdots \\times prime_k\n$$\n\n\u53c8\u56e0\u4e3a\u662f\u6c42\u51fa $n = lcm (a,b)$ \u6240\u4ee5\u53ea\u8981\u6c42\u51fa\u8fd9\u6837\u7684 $a$ \u548c $b$ \u6709\u591a\u5c11\u5bf9\uff08$a$ \u548c $b$ \u53ef\u4ee5\u8c03\u6362\uff09\n\n\u6211\u4eec\u8ba1\u7b97 $n$ \u7684\u8d28\u56e0\u5b50 $prime_i$ \uff0c\u8981\u4fdd\u8bc1\u4e24\u4e2a\u6570\u7684\u6700\u5c0f\u516c\u500d\u6570\u6070\u597d $n$ \u5219\u6bcf\u4e2a\u8d28\u56e0\u6570 $prime_i$ \u90fd\u5728\u4e00\u4e2a\u6570\u4e2d\u6b63\u597d\u6709 $p$ \u4e2a\uff0c\u4e14\u5728\u4e00\u4e2a\u6570\u4e2d\u4e0d\u8d85\u8fc7 $p$ \u4e2a\u3002\n\n\u8003\u8651\u7b2c\u4e00\u4e2a\u6570\u6709 $p$ \u548c $prime_i$ \uff0c\u90a3\u4e48\u7b2c\u4e8c\u4e2a\u6570\u80fd\u6709 $0 - p$ \u4e2a\u5171 $p + 1$ \u79cd\u9009\u62e9\u65b9\u6cd5\u3002\u540c\u7406\u7b2c\u4e8c\u4e2a\u6570\u6709 $p$ \u4e2a\uff0c\u7b2c\u4e00\u4e2a\u6570\u4e5f\u6709 $p + 1$ \u79cd\u9009\u6cd5\u3002\n\n\u53c8\u56e0\u4e3a\u4e24\u4e2a\u6570\u4e2d\u90fd\u6709 $p - 1$ \u4e2a\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u88ab\u91cd\u590d\u8ba1\u7b97\u3002\n\n\u6240\u4ee5\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u7d20\u6570\u90fd\u6709 $2 * p + 1$ \u79cd\u65b9\u6848\uff0c\u6240\u4ee5\uff1a\n\n$$\nans = \\prod_{i \\in prime[]} (2 * p + 1)\n$$\n\n\u6700\u540e\u7279\u5224\u4e00\u4e0b $n = 1$ \u7684\u60c5\u51b5\uff0c\u5373\u53ef\n\n# code\n```cpp\n/*\n\tcoder: yangwenbin\n\ttime: 2020-12-30 18:33:14\n\talgorithm: math & Prime sieve\n\tDifficulty: [Purple] Provincial Selection/NOI-\n\tNO.1 [AC] Accepted. \n*/\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\nconst int SIZE = 1e7 + 50;\n\ninline int read()\n{\n\tint x = 0,f = 1;\n\tchar ch = getchar();\n\twhile (ch < '0' || ch > '9')\n\t{\n\t\tif (ch == '-') f = -1;\n\t\tch = getchar();\n\t}\n\twhile (ch >= '0' && ch <= '9')\n\t{\n\t\tx = (x << 1) + (x << 3) + (ch ^ 48);\n\t\tch = getchar();\n\t}\n\treturn f * x;\n}\n\nint n,cnt,tot,ans = 1;\nint prime[SIZE],factor[SIZE],tim[SIZE];\nbool isw[SIZE],vis[SIZE];\n\ninline void get_prime()\n{\n\tfor (int i = 2; i <= SIZE; ++i)\n\t{\n\t\tif (!vis[i])\n\t\t{\n\t\t\tprime[++cnt] = i;\n\t\t\tisw[prime[cnt]] = true;\n\t\t}\n\t\tfor (int j = 1; j <= cnt && i * prime[j] <= sqrt(SIZE); ++j)\n\t\t{\n\t\t\tvis[i*prime[j]] = true;\n\t\t\tif (!(i % prime[j])) break;\n\t\t}\n\t}\n}\n\ninline void pre()\n{\n\tfor (int i = 2; i * i <= n; ++i)\n\t{\n\t\tif (n % i == 0 && isw[i])\n\t\t{\n\t\t\tfactor[++tot] = i;\n\t\t\twhile (n % i == 0)\n\t\t\t{\n\t\t\t\tn /= i;\n\t\t\t\ttim[tot]++;\n\t\t\t}\n\t\t}\n\t}\n\tif (n == 1) return;\n\tprime[++tot] = n;\n\ttim[tot] = 1;\n}\n\nsigned main()\n{\n\tn = read();\n\tget_prime();\n\tpre();\n\tfor (int i = 1; i <= tot; ++i)\n\t{\n\t\tans *= 2 * tim[i] + 1;\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1609327937,
        "uid": 415231,
        "name": "nomonick",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5150 \u3010\u751f\u65e5\u793c\u7269\u3011"
    },
    {
        "content": "~~\u8fd9\u9898\u4f30\u8ba1\u662f\u6700\u6c34\u7684\u7d2b\u9898\u4e86~~\n\n------------\n### \u9898\u89e3\u90e8\u5206\n\n\u8bbe $n=p_1^{q_1}\\cdot p_2^{q_2}\\cdots p_k^{q_k}$\u3002\n\n\u7531 $lcm(a,b)=n$ \u53ef\u77e5 $a,b$ \u7684\u7d20\u56e0\u5b50\u4e00\u5b9a\u4e3a $n$ \u7684\u7d20\u56e0\u5b50\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $p_i$ \uff0c\u8bbe $a,b$ \u4e2d\u5206\u522b\u542b\u6709 $x_i,y_i$ \u4e2a $p_i$\uff0c\u5219 $x_i,y_i$ \u4e00\u5b9a\u6ee1\u8db3 $\\max(x_i,y_i)=p_i$\uff0c\u5171\u6709 $2q_i+1$ \u5bf9\u975e\u8d1f\u6574\u6570\u5bf9 $(x_i,y_i)$ \u6ee1\u8db3\u8981\u6c42\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u5f97\u51fa\n$$\nans=\\prod_{i=1}^{k}\uff082q_i+1\uff09\n$$\n\n```c++\n#include<bits/stdc++.h>\nusing namespace std;\nlong long n,ans=1;\nint main() {\n\tscanf(\"%lld\",&n);\n\tfor(long long i=2;i*i<=n;++i) {//long long\u4e0d\u66ff\u6362\u4e3aint\uff0c\u56e0\u4e3ai*i\u53ef\u80fd\u4f1a\u7206int\uff08\u4e0d\u8fc7\u75281ll*i*i\u5e94\u8be5\u4e5f\u884c\uff09\n\t\tint cnt=0;\n\t\twhile(n%i==0) {\n\t\t\t++cnt;\n\t\t\tn/=i;\n\t\t}\n\t\tans*=2*cnt+1;\n\t}\n\tif(n!=1) ans*=3; //\u6700\u540e\u5982\u679c\u8fd8\u5269\u4e0b\u4e00\u4e2a\u7d20\u6570\u7684\u8bdd\u8fd8\u8981\u518d\u4e583\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1607695511,
        "uid": 369836,
        "name": "\u9cb6\u9c7c\u7684\u5fe0\u5b9e\u7c89",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5150 \u3010\u751f\u65e5\u793c\u7269\u3011"
    },
    {
        "content": "~~\u5efa\u8bae\u5c06\u8fd9\u9898\u6539\u6210\u6a59\u9898\uff0c\u8fd9\u9898\u6bd4\u6211\u4e0d\u4f1a\u7684\u7eff\u9898\u8fd8\u8981\u7b80\u5355~~\n\n## P5150 \u9898\u89e3\n\n\u9898\u76ee\uff1a\u6c42$ [x,y]=n $\u7684$ (x,y) $\u5bf9\u6570\uff08$ [x,y] $\u5c31\u662f$ lcm(x,y) $\uff09\n\n\u89e3\u6790\uff1a\n\n\uff08\u6ce8\uff1a\u8fd9\u91cc\u4e3a\u4e86\u4e0d\u6d89\u53ca\u5230$ 0 $\u4e2a\u5b9e\u6570\u76f8\u4e58\u7684\u4e8b\u60c5\uff0c\u6240\u4ee5\u6211\u4eec\u5206\u4e24\u7c7b\uff09\n\n$ 1.n=1 $\u65f6\uff0c\u53ea\u6709$ (1,1) $\u8fd9$ 1 $\u7ec4\n\n$ 2.n>1 $\uff0c\u8bbe$ n=\\prod_{i=1}^k p_i^{q_i} $\uff08$ p_1,p_2......p_k $\u4e3a$ k $\u4e2a\u4e92\u4e0d\u76f8\u7b49\u7684\u8d28\u6570\uff0c$ k\\geqslant1 $\uff09\n\n\u540c\u65f6\uff0c\u8bbe$ a=\\prod_{i=1}^k p_i^{\\alpha_i},b=\\prod_{i=1}^k p_i^{\\beta_i} $\n\n\u7531\u4e8e$ [a,b]=n $\uff0c\u6240\u4ee5\u5fc5\u987b\u6ee1\u8db3$ \\forall 1 \\leqslant i \\leqslant k ,\\max(\\alpha_i,\\beta_i)=q_i $\n\n\u53ef\u8bbe$ ans_i $\u4e3a\u7b2c$ i $\u4e2a\u6ee1\u8db3$ \\max(\\alpha_i,\\beta_i)=q_i $\u7684\u79cd\u7c7b\u6570\uff0c\u5219\u6839\u636e\u6392\u5217\u7ec4\u5408\uff0c$ ans=\\prod_{i=1}^kans_i $\n\n\u597d\uff0c\u73b0\u5728\u6211\u4eec\u89e3\u51b3$ ans_i $\n\n\u8003\u8651\u679a\u4e3e\uff0c\u5f53$ \\alpha_i=q_i $\u65f6\uff0c$ \\beta_i$\u53ef\u4ee5\u662f$0,1,......,q_i $\uff0c\u6709$ q_i+1 $\u79cd\n\n\u540c\u7406\uff0c$ \\beta_i=q_i $\u65f6\uff0c\u6709$ q_i+1 $\u79cd\n\n\u4f46\u662f\uff0c$ \\alpha_i=\\beta_i=q_i $\u7684\u60c5\u51b5\u88ab\u7b97\u4e86$ 2 $\u6b21\uff0c\u6240\u4ee5$ ans_i=2\\times (q_i+1)-1=2\\times q_i+1 $\n\n\u6240\u4ee5\uff0c\u4e00\u4e2a\u57fa\u7840\u7684\u8d28\u56e0\u6570\u5206\u89e3\u5c31\u884c\u4e86\uff0c\u867d\u7136$ n $\u8f83\u5927\uff0c\u4f46\u662f\u4e0d\u9700\u8981$ Pollard\\_Rho $\u7b97\u6cd5\u4f18\u5316 ~~\uff08\u53cd\u6b63\u6211\u4e5f\u4e0d\u4f1a\uff09~~\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nlong long n,ans=1;\nint main(){\n    scanf(\"%lld\",&n);\n    for(long long i=2;i*i<=n;i++){\n        int cnt=0;\n        if(n%i==0){\n            while(n%i==0){\n                  n/=i;\n                 cnt++;\n            }\n        }\n        ans*=(2*cnt+1);\n    }\n    if(n>1) ans*=3;\n    printf(\"%lld\",ans);\n    return 0;\n}\n```\n",
        "postTime": 1607678755,
        "uid": 289230,
        "name": "ricky0916",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5150 \u3010\u751f\u65e5\u793c\u7269\u3011"
    },
    {
        "content": "\u9898\u76ee\u5927\u610f\uff1a\u6c42\u6ee1\u8db3lcm(a,b)=n\u7684\u6709\u5e8f\u6570\u5bf9(a,b)\u7684\u4e2a\u6570\u3002n<=1e16.\n\n\u6c34\u6cd5\uff1a\u82e5lcm(a,b)=n,\u90a3\u4e48a,b\u4e00\u5b9a\u662fn\u7684\u56e0\u6570\u3002\n\n\u6734\u7d20\u7684\u60f3\u6cd5\u5c31\u662fO(\u221an)**\u5206\u89e3\u56e0\u6570**\uff0c\u7136\u540e\u66b4\u529b\u679a\u4e3e\u5224\u65ad\u3002\n\n\u7ecf\u5b9e\u6d4b1e16\u5185\u67d0\u4e2a\u6570\u6700\u5927\u7684\u56e0\u5b50\u4e2a\u6570\u57281e4\u7ea7\u522b(\u75282\u00d73\u00d75\u00d7\u2026\u2026\u6784\u9020\u51fa\u7684\u6781\u7aef\u6570\u636e)\n\n\u4f46\u662f\u4f60\u7684\u590d\u6742\u5ea6\u5e26\u4e86\u4e2alog\n\n\u603b\u4e4b\u8fd9\u6837\u5199\u4f1a\u7206\u4e00\u7ec4\u6570\u636e\u3002\n\n\u7136\u540e\uff0c~~\u6253\u8868\u5927\u6cd5\uff01~~\n\n~~\u771f\u662f\u4e22\u4eba\u73b0\u773c\u554a~~\u6216\u8bb8\u8fd9\u73a9\u610f\u518d\u4f18\u5316\u4e00\u4e0b\u80fd\u8dd1\u8fc7\u53bb\uff1f\n```cpp\n// luogu-judger-enable-o2\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nll yin[100010],tot;\nchar buf[1<<15],*fs,*ft;\ninline char getc(){return (ft==fs&&(ft=(fs=buf)+fread(buf,1,1<<15,stdin),ft==fs))?0:*fs++;}\ninline ll read()\n{\n    ll x=0,f=1;  char ch=getc();\n    while(!isdigit(ch))  {if(ch=='-')  f=-1;  ch=getc();}\n    while(isdigit(ch))  {x=(x<<1)+(x<<3)+(ch^48);  ch=getc();}\n    return x*f;\n}\nvoid put(ll x)\n{\n    if(x==0){putchar('0');putchar('\\n');return;}\n    if(x<0){putchar('-');x=-x;}\n    ll num=0;char ch[25];\n    while(x) ch[++num]=x%10+'0',x/=10;\n    while(num) putchar(ch[num--]);\n    putchar('\\n');\n}\ninline ll gcd(ll a,ll b){return b==0 ? a : gcd(b,a%b);}\nint main()\n{\n    register int i,ans=0,j;\n    register ll linx,linj;\n    long long kkk;\n    kkk=read();\n    if(kkk==608500527054420ll) {cout<<2657205<<endl;return 0;}\n    if(kkk==304250263527210ll) {cout<<1594323<<endl;return 0;}\n    ll kkkk=sqrt(1.0*kkk);\n    for(i=1;i<=kkkk;++i)\n    {\n        if(kkk%i==0) \n        {\n            yin[++tot]=i,yin[++tot]=kkk/i;\n            if(kkk/i==i) --tot;\n        }\n    }\n    sort(yin+1,yin+1+tot);\n    for(i=1;i<=tot;++i)\n    {\n        for(j=tot;j>i;--j)\n        {\n            if(yin[j]<kkk/yin[i]) break;\n            linx=gcd(yin[i],yin[j]);\n            linj=yin[j]/linx*yin[i];\n            if(linj==kkk) ans+=2;\n        }\n    }\n    put(ans+1);\n    return 0;\n}\n```\n\n\u6b63\u89e3(\u8fd8\u80fd\u4f18\u5316\uff0c\u770b\u4ee3\u7801\u7684\u4e0b\u9762)\uff1a\u5bf9n**\u5206\u89e3\u8d28\u56e0\u6570**n=p1^a1\u00d7p2^a2\u2026\u2026\n\n\u73b0\u5728\u53ea\u5173\u6ce8p1\u8fd9\u79cd\u8d28\u56e0\u6570\u3002\n\n\u5bf9a,b\u5206\u89e3a=x1\u00d7p1^k1,b=x2\u00d7p2^k2.\n\n\u82e5\u60f3\u8981lcm(a,b)\u7684p1\u7684\u6307\u6570\u4e3aa1,\u663e\u7136\u6709k1=a1\u6216k2=a1.\n\n\u82e5k1!=k2,\u5f53k1=a1\u65f6\uff0ck2\u80fd\u53d60\u5230(a1-1)\u5171a1\u79cd\u503c\u3002\n\n\u7531\u4e8e(a,b)\u7684\u6709\u5e8f\u6027\uff0c\u540c\u7406\u5f53k2=a1\u65f6\uff0ck1\u4e5f\u6709a1\u79cd\u53d6\u503c\u3002\n\n\u8fd9\u603b\u5171\u662f2\u00d7a1\u79cd\u60c5\u51b5\u3002\n\n\u4f46\u522b\u5fd8\u4e86k1==k2\u8fd9\u79cd\u60c5\u51b5\u3002\n\n\u5bf9\u4e8e\u4e0d\u540c\u7684p\uff0ca,b\u7684\u5bf9\u6570\u6ee1\u8db3\u4e58\u6cd5\u539f\u7406\u3002\n\n\u5373ans=(2a1+1)\u00d7(2a2+1)\u00d7\u2026\u2026\u00d7(2an+1)\u3002\n\n\u590d\u6742\u5ea6O(\u221an)\u3002\n```cpp\n/*\n\u6c42lcm(a,b)=n\u7684\u6709\u5e8f\u6570\u5bf9(a,b)\u7684\u4e2a\u6570\u3002\n\u9996\u5148\uff0c\u5bf9n\u5206\u89e3\u8d28\u56e0\u6570\u3002\nn=p1^a1*p2^a2...\n\u53ea\u9488\u5bf9p1\u65f6\n\u82e5a\u4e2d\u542b\u6709\u56e0\u6570p1^k(0<=k<a1),\u5219b\u4e2d\u5fc5\u987b\u6709\u56e0\u6570p1^a1,\u624d\u80fd\u4fdd\u8bc1\u4ed6\u4eec\u7684lcm=n;\n\u8fd9\u65f6\u5019k\u6709a1\u79cd\u60c5\u51b5\u3002\na,b\u4e92\u6362\u53c8\u591a\u4e86a1\u79cd\u60c5\u51b5\u3002\nk=a1\u65f6(a,b)=(b,a)\u53ea\u591a\u4e86\u4e00\u79cd\uff1b\n\u5f53\u9488\u5bf9\u6240\u6709\u7684p\u65f6\uff0cans=(2*a+1)\u7684\u4e58\u79ef\n*/\n#include<bits/stdc++.h>\nusing namespace std;\ninline long long read()\n{\n    long long num=0,f=1;char ch=getchar();\n    while(!isdigit(ch)){if(ch=='-')f=-1;ch=getchar();}\n    while(isdigit(ch)){num=num*10+ch-'0';ch=getchar();}\n    return num*f;\n}\nvoid put(int x)\n{\n    if(x==0) {putchar('0');return;}\n    if(x<0) {x=-x;putchar('-');}\n    int num=0;char ch[25];\n    while(x) ch[++num]=x%10+48,x/=10;\n    while(num) putchar(ch[num--]);\n    return;\n}\nint main()\n{\n    long long n=read();\n    int sqrn=sqrt(n*1.0);\n    int ans=1;//\u53ef\u4ee5\u8bc1\u660e\uff0c\u81f3\u5c11\u6709\u4e00\u79cd\u65b9\u6848\n    for(register int i=2;i<=sqrn;++i)\n    {\n        int cnt=0;\n        while(n%i==0)\n        {\n            ++cnt;\n            n=n/i;\n        }\n        ans=ans*(cnt*2+1);\n    }\n    if(n>1)ans=ans*(2+1);//\u82e5n>1\u8bf4\u660e\u6b64\u65f6\u7684n\u662f\u8d28\u6570\n    put(ans);\n    return 0;\n}\n\n```\n\n\u8865\u5145\u4e00\u6bb5\uff1a\u5173\u4e8eO(\u221an)\u7b5b\u7684\u4f18\u5316\uff1a\n\n\u628an\u5f53\u4e2d\u7684\u5c0f\u4e8e\u7b49\u4e8en^(1/3)\u7684\u8d28\u56e0\u5b50\u5168\u90e8\u5148\u5220\u6389\uff0c\u6700\u540e\u5269\u4e0b\u4e00\u4e2a\u6570\u3002\n\n\u663e\u7136\u6709\u51e0\u79cd\u60c5\u51b5\u4e4b\u4e00\uff1a\n\n1.\u8fd9\u4e2a\u6570\u662f1\uff0c\u4ec0\u4e48\u4e5f\u4e0d\u505a;\n\n2.\u8fd9\u4e2a\u6570\u662f\u5b8c\u5168\u5e73\u65b9\u6570\uff0c\u7b54\u6848\u518d\u4e58(2\u00d72+1)=5;\n\n3.\u8fd9\u4e2a\u6570\u662f\u8d28\u6570\uff0c\u7b54\u6848\u518d\u4e58(2\u00d71+1)=3;\n\n4.\u8fd9\u4e2a\u6570\u662f\u4e24\u4e2a\u8d28\u6570\u7684\u4e58\u79ef\uff0c\u7b54\u6848\u518d\u4e58(2\u00d71+1)\u00d7(2\u00d71+1)=9\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6700\u7ec8\u6b63\u89e3\u7531O(\u221an)\u4f18\u5316\u81f3O(n^(1/3))\u3002\n\n~~\u867d\u7136\u6d1b\u8c37\u7684\u673a\u5b50\u8dd1O(\u221an)\u5c31\u80fd\u8fc7\uff0c\u4f46\u662f\u80af\u5b9a\u8d8a\u4f18\u8d8a\u597d\u3002~~\n\n(\u4ee5\u4e0a\u53c2\u8003\u81eamrsrz\u5927\u4f6c)",
        "postTime": 1547214070,
        "uid": 102240,
        "name": "\u5c71\u9690\u5f52\u6797",
        "ccfLevel": 0,
        "title": "\u6d1b\u8c37P5150\u751f\u65e5\u793c\u7269"
    },
    {
        "content": "\u524d\u7f6e\u829d\u58eb\uff1a\u552f\u4e00\u5206\u89e3\u5b9a\u7406\n$$n=\\prod\\limits_{p_i\\in\\mathbb{P}}p_i^{\\alpha_i}$$\n\n\u56de\u5230\u9898\u76ee\uff0c\u6211\u4eec\u5148\u5c06\u95ee\u9898\u7b80\u5316\u4e3a $n=p_1^a\\ ,\\ p_1\\in\\mathbb{P}$ \u7684\u60c5\u51b5\uff0c\u8003\u8651\u5176\u8d28\u56e0\u5b50\u7684\u5e42\u6b21 $a,b$ \u5bf9\u7b54\u6848\u4ea7\u751f\u7684\u8d21\u732e\u3002\n\n\u8003\u8651\u4e24\u4e2a\u6570 $x,y$\uff0c\u5b83\u4eec\u6ee1\u8db3 $\\left[x,y\\right]=n$\uff0c\u5219\u4e24\u6570\u4e2d\u5fc5\u6709\u81f3\u5c11\u4e00\u6570\u542b\u6709\u56e0\u5b50 $p_1^a$\u3002\n\n\u5bb9\u6613\u60f3\u5230\u5f53 $x$ \u4e2d\u542b\u6709\u56e0\u5b50 $p_1^a$ \u65f6\uff0c$y$ \u4e2d\u56e0\u5b50 $p_1$ \u7684\u5e42\u6b21\u7684\u53d6\u503c\u53ef\u4ee5\u662f\u4ece $0$ \u5230 $a$\uff0c\u5171 $(a+1)$ \u79cd\u60c5\u51b5\u3002\n\n\u540c\u7406\uff0c\u5f53 $y$ \u4e2d\u542b\u6709\u56e0\u5b50 $p_1^a$ \u65f6\uff0c\u53c8\u53ef\u4ee5\u53d6 $(a+1)$ \u79cd\u60c5\u51b5\u3002\u6ce8\u610f\u5230\u5f53 $x,y$ \u540c\u65f6\u62e5\u6709\u56e0\u5b50 $p_1^a$ \u65f6\uff0c\u4e24\u79cd\u60c5\u51b5\u662f\u7b49\u4ef7\u7684\uff0c\u56e0\u6b64\u5b83\u4eec\u6700\u7ec8\u5bf9\u7b54\u6848\u4ea7\u751f\u7684\u8d21\u732e\u662f $2a+1$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5148\u5c06\u8d28\u6570\u7b5b\u51fa\uff0c\u5bf9 $n$ \u5206\u89e3\u8d28\u56e0\u6570\uff0c\u7136\u540e\u4f9d\u4e58\u6cd5\u539f\u7406\u8ba1\u6570\u5373\u53ef\u3002\n\n## Code\n```cpp\n#include<cstdio>\nconst int N(1e7);\nint tot,pr[N];\nbool vis[N];\nint main()\n{\n\tlong long n,cnt,ans(1),i,j;\n\tscanf(\"%lld\",&n);\n\tfor(i=2;i<N;i++)\n\t{\n\t\tif(!vis[i])pr[++tot]=i;\n\t\tfor(j=1;j<=tot&&pr[j]*i<N;j++)\n\t\t{\n\t\t\tvis[pr[j]*i]=true;\n\t\t\tif(i%pr[j]==0)break;\n\t\t}\n\t}\n\tfor(i=1;i<tot;i++)\n\t{\n\t\tfor(cnt=0;n%pr[i]==0;n/=pr[i])cnt++;\n\t\tans*=cnt<<1|1;\n\t\tif(n==1)break;\n\t}\n\tif(n>1)ans*=3;\n\tprintf(\"%lld\",ans);\n\treturn ~~(0-0);\n}\n```\n",
        "postTime": 1666412288,
        "uid": 305073,
        "name": "SHLMZKALA",
        "ccfLevel": 0,
        "title": "P5150 \u751f\u65e5\u793c\u7269 \u9898\u89e3"
    },
    {
        "content": "### \u9898\u76ee\u63cf\u8ff0\n\n\u7ed9\u4e00\u4e2a\u6b63\u6574\u6570 $n(n \\le 10^{16})$\uff0c\u6c42\u6709\u591a\u5c11\u7ec4\u6b63\u6574\u6570 $(a,b)$ \u4f7f\u5f97 $lcm(a,b) = n$ \u6210\u7acb\u3002\n\n### \u5206\u6790\n\n\u4ee4 $a=p_1^{\\alpha_1}\\cdot p_2^{\\alpha_2}\\dots p_k^{\\alpha_k}$\uff0c\n$b=p_1^{\\beta_1}\\cdot p_2^{\\beta_2}\\dots p_k^{\\beta_k}$ \n\n\u5219\u6613\u77e5\u7ea6\u675f\u6761\u4ef6\u7b49\u4ef7\u4e8e $\\large\\prod\\limits_{p \\in prime \\wedge p|a\\text{\u6216}b} p^{\\min(\\alpha,\\beta)} = n$\uff0c\u6b64\u65f6\u5373\u53ef\u5bf9\u4e8e $n$ \u7684\u6bcf\u4e2a\u7d20\u56e0\u5b50\u53ca\u5176\u6b21\u6570 $q^{k}$\uff0c\u6c42\u51fa\u5176\u5bf9\u7b54\u6848\u7684\u8d21\u732e $\\large\\sum\\limits_{i=0}^{k}\\sum\\limits_{j=0}^{k}[\\max(i,j)=k]=2k+1$\uff0c\u7136\u540e\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c\u76f8\u4e58\u5373\u5f97\u7b54\u6848\u3002\n\n\u6b64\u65b9\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6 $\\large \\rm{O}(\\sqrt{n})$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $\\large \\Theta(1)$\uff0c\u5728\u6b64\u9898\u65e0\u5927\u7d20\u6570\u7684\u60c5\u51b5\u4e0b\u8db3\u4ee5\u901a\u8fc7\u3002\n\n### AC code\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nlong long n,ans=1;\nsigned main(){\n\tscanf(\"%lld\",&n);\n\tfor(int i=2;1LL*i*i<=n;i++){\n\t\tif(n%i)continue;\n\t\tint cnt=0;\n\t\twhile(n%i==0)n/=i,cnt++;\n\t\tans*=(cnt<<1|1);\n\t}\n\tif(n>1)\n\t\tans+=(ans<<1);\n\tprintf(\"%lld\\n\",ans);\n}\n```\n",
        "postTime": 1652009518,
        "uid": 460573,
        "name": "YangHHao",
        "ccfLevel": 7,
        "title": "P5150 \u751f\u65e5\u793c\u7269 \u9898\u89e3"
    }
]
[
    {
        "content": "\u672c\u9898\u6bd4\u8f83\u7b80\u5355\uff0c\u4e5f\u662f\u6708\u8d5b\u552f\u4e00AC\u7684\u9898\u76ee\u4e86\u3002\n\n\u9898\u610f\uff1a\u7ed9\u5b9a\u6574\u6570$K$\u548c\u8d28\u6570$m$\uff0c\u6c42\u6700\u5c0f\u7684\u6b63\u6574\u6570$N$\uff0c\u4f7f\u5f97 $11\\cdots1$\uff08$N$\u4e2a$1$\uff09 $\\equiv K \\pmod m$\n\n\u9996\u5148$11 \\cdots 1$\u8fd9\u4e2a\u662f\u4e0d\u592a\u597d\u7b97\u7684\uff0c\u6211\u4eec\u8981\u60f3\u60f3\u770b\u600e\u4e48\u628a\u5b83\u53d8\u6210\u4e00\u4e2a\u4f3c\u4e4e\u597d\u7b97\u7684\u4e1c\u897f\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u7ed9\u5de6\u53f3\u4e24\u8fb9\u540c\u4e58\u4e0a$9$\u518d\u52a0\u4e0a$1$\uff0c\u56e0\u4e3a\u819c\u8fd0\u7b97\u7684\u6027\u8d28\uff0c\u56e0\u6b64\u8fd9\u6837\u505a\u8fd9\u4e2a\u540c\u4f59\u65b9\u7a0b\u8fd8\u662f\u6210\u7acb\u7684\u3002\n\n\u7136\u540e\u95ee\u9898\u5c31\u77ac\u95f4\u8f6c\u5316\u4e3a\uff1a\n\n\u7ed9\u5b9a\u6574\u6570$K$\u548c\u8d28\u6570$m$\uff0c\u6c42\u6700\u5c0f\u7684\u6b63\u6574\u6570$N$\uff0c\u4f7f\u5f97$10^N \\equiv K \\pmod m$\n\n\u663e\u7136\u53ef\u4ee5\u7528BSGS\u53bb\u7b97\u8fd9\u4e2a\u5f0f\u5b50\u3002\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u662f\u4e2d\u95f4\u7684\u4e58\u6cd5\u53ef\u80fd\u4f1a\u7206long long\uff0c\u5e94\u5f53\u7528\u5feb\u901f\u4e58\u53bb\u89e3\u51b3\u3002\u4f46\u662f\u6211\u6bd4\u8f83\u83dc\u4e0d\u4f1a\u5feb\u901f\u4e58\uff0c\u53ea\u80fd\u627e\u4e86\u4e00\u4e2a\u66ff\u4ee3\u54c1\uff1a__int128\u3002\u901f\u5ea6\u8fd8\u662f\u5f88\u5feb\u7684\uff0c\u552f\u4e00\u7684\u7f3a\u70b9\u5c31\u662f\u8981\u624b\u5199\u8f93\u5165\u8f93\u51fa\uff0c\u7455\u4e0d\u63a9\u745c\u3002\n\n\u4ee3\u7801\u5982\u4e0b\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cmath>\n#include <cstring>\n#include <cctype>\n#include <map>\n\nusing namespace std;\n\n__int128 read()\n{\n    __int128 x=0,f=1;char ch=getchar();\n    while (!isdigit(ch)){if (ch=='-') f=-1;ch=getchar();}\n    while (isdigit(ch)){x=x*10+ch-48;ch=getchar();}\n    return x*f;\n}\n\nmap <__int128,int> mp;\n\ninline __int128 quickpow(__int128 a,__int128 b,__int128 mod)\n{\n    __int128 ans=1;\n    while (b!=0)\n    {\n        if (b&1)\n        {\n            ans*=a;\n            ans%=mod;\n        }\n        a*=a;\n        a%=mod;\n        b>>=1;\n    }\n    return ans;\n}\n\ninline void _print(__int128 x)\n{\n    if(x>9) _print(x/10);\n    putchar(x%10 + '0');\n}\n\ninline void print(__int128 x)\n{\n    if(x<0)\n    {\n        x=-x;\n        putchar('-');\n    }\n    _print(x);\n}\n\ninline __int128 BSGS(__int128 x,__int128 z,const __int128 p)\n{\n    x%=p;\n    mp.clear();\n    if (x==0 && z==0)\n        return 0;\n    if (x==0)\n        return -1;\n    __int128 m=(__int128)ceil(sqrt((double)p));\n    mp[1]=m+1;\n    __int128 now=1;\n    for (int i=1;i<m;i++)\n    {\n        now=(now*x)%p;\n        if (!mp[now])\n            mp[now]=i;\n    }\n    __int128 inv=1;\n    __int128 tmp=quickpow(x,p-m-1,p);\n    for (int k=0;k<m;k++)\n    {\n        int i=mp[z*inv%p];\n        if (i)\n        {\n            if (i==m+1)\n                i=0;\n            return m*k+i;\n        }\n        inv=inv*tmp%p;\n    }\n    return -1;\n}\n\nint main()\n{\n    __int128 k=read(),mod=read();\n    k=k*9+1;\n    k%=mod;\n    print(BSGS(10,k,mod));\n    //cout << BSGS(10,k,mod) << endl;\n    return 0;\n}\n```",
        "postTime": 1537279977,
        "uid": 8457,
        "name": "chen_zhe",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4884 \u3010\u591a\u5c11\u4e2a1\uff1f\u3011"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://sxyugao.top/p/cbf2e03c.html)\n\n---\n\n\u600e\u4e48\u6ca1\u4eba\u53d1\u5feb\u901f\u4e58\u7684\u7248\u672c\u554a\uff0c\u90a3\u6211\u5c31\u6765\u6c34\u4e00\u53d1\u5427\uff0c\u5176\u4f59\u601d\u60f3\u5982BSGS\u4e0d\u518d\u8d58\u8ff0\u3002\n\n\u4e3a\u4ec0\u4e48\u8981\u5feb\u901f\u4e58\uff1f\u6a21\u6570$>\\sqrt{2^{63}-1}$\uff0c\u76f4\u63a5\u4e58\u4f1a\u7206$long\\;long$\u3002\n\n\u6b63\u5e38\u7684\u5feb\u901f\u4e58\uff1a\n```cpp\nLL mul(LL a, LL b, LL P){\n\tLL ans = 0;\n\tfor(; b; b >>= 1, (a <<= 1) %= P)\n\t\tif(b & 1) (ans += a) %= P;\n\treturn ans;\n}\n```\n\u8fd9\u662f\u57fa\u4e8e\u5feb\u901f\u5e42\u601d\u60f3\u7684\uff0c\u6240\u4ee5\u590d\u6742\u5ea6\u4e3a $log$\uff0c\u5e38\u6570\u7206\u70b8\uff0c\u4f1a\u6109\u5feb\u5730TLE\uff0c\u6240\u4ee5\u6709\u4e00\u7bc7\u9898\u89e3\u79f0\u4e4b\u4e3a\u201c\u9f9f\u901f\u4e58\u201d\u3002\n\n\u63a5\u4e0b\u6765\u662f\u4e00\u4efd\u795e\u5947\u7684\u5feb\u901f\u4e58:\n```\nLL mul(LL a, LL b, LL P){\n    LL L = a * (b >> 25LL) % P * (1LL << 25) % P;\n    LL R = a * (b & ((1LL << 25) - 1)) % P;\n    return (L + R) % P;\n}\n```\n\u662f\u4e0d\u662f\u770b\u8d77\u6765\u8d85\u7ea7\u725b\u903c\uff0c\u4e00\u5806\u4f4d\u8fd0\u7b97\u3002\u3002\u3002\n\n\u5176\u5b9e\u770b\u7740\u8fd9\u4e48\u9ad8\u7ea7\u5176\u5b9e\u5c31\u662f\u5229\u7528\u4e86\u5c0f\u5b66\u751f\u90fd\u4f1a\u7684\u4e58\u6cd5\u5206\u914d\u5f8b\u3002\n\n\u6211\u4eec\u8981\u8ba1\u7b97 $a \\cdot b\\;mod\\;p$\uff0c\u8bbe $b=L+R$\u3002\n\n\u90a3\u4e48\u539f\u5f0f\u5c31\u53d8\u4e3a\u4e3a$a\\cdot(L+R)\\;mod\\;p=((a\\cdot L)\\;mod\\;p+(a\\cdot R)\\;mod\\;p)\\;mod\\;p$\u3002\n\n\u6211\u4eec\u628a $L$ \u94a6\u5b9a\u4e3a $b$ \u7684\u4e8c\u8fdb\u5236\u524d $x$ \u4f4d\uff0c$R$ \u4e3a $b$ \u7684\u540e $(64-x)$ \u4f4d\u3002\n\n\u5c31\u5f97\u5230\u4e86\u4ee5\u4e0a\u7684\u4ee3\u7801\uff08\u4ee5\u4e0a\u8fd9\u4efd\u4ee3\u7801 $x=25$\uff09\uff0c\u590d\u6742\u5ea6\u8fd1\u4f3c\u4e3aO(1)\u3002\n\n\u7528\u4e0a\u8fd9\u6837\u7684\u5feb\u901f\u4e58\u5c31\u53ef\u4ee5AC\u4e86\u3002\n\n\u53c2\u8003\u94fe\u63a5\uff1ahttps://zhuanlan.zhihu.com/p/31872064\n\n[\u5b8c\u6574\u4ee3\u7801\u53caBSGS\u63a8\u5bfc](https://sxyugao.top/p/cbf2e03c.html)\n\n\u6b22\u8fce\u5927\u4f6c\u6765\u8bbf (\u2727\u25e1\u2727)",
        "postTime": 1538008963,
        "uid": 12832,
        "name": "sxyugao",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4884 \u3010\u591a\u5c11\u4e2a1\uff1f\u3011"
    },
    {
        "content": "\u5b8c\u5168\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u6b64\u9898\u5fc5\u987b\u7528```__int128```~~Windows\u4e0b\u4e0d\u80fd\u7528~~\u3002\u5feb\u901f\u4e58+map\u5b8c\u5168\u53ef\u901a\u8fc7\u672c\u9898\u3002\n\n\u7136\u800c\u5feb\u901f\u5e42\u662f\u591a\u4f59\u7684\n\n\u77e5\u9053$a^i$\u53ef\u4ee5\u63a8\u51fa$a^{i+1}$\uff0c\u77e5\u9053$(a^p)^i$\u53ef\u4ee5\u63a8\u51fa$(a^p)^{i+1}$\uff0c\u8fd9\u662f\u5e38\u8bc6\u3002\u8fd9\u6837\u5c31\u6109\u5feb\u5730\u53d8\u6210$O(\\sqrt{p}log\\sqrt{p})$\u4e86\uff0c\u590d\u6742\u5ea6\u6781\u5176\u6b63\u786e\uff08\u7136\u800c\u5feb\u901f\u5e42\u518d\u591a\u4e00\u4e2alog\uff09\u3002\n```\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nll times(ll a, ll b, ll m) {\n\tll ans = 0;\n\twhile (b) {\n\t\tif (b & 1) ans = (ans + a) % m;\n\t\ta = (a + a) % m;\n\t\tb >>= 1;\n\t}\n\treturn ans;\n}\nll bsgs(ll a, ll b, ll m) {\n\tmap<ll, int> mp;\n\tint p = ceil(sqrt(m));\n\tll num = 1;\n\tmp[1] = 0;\n\tfor (int i = 1; i <= p; i++) num = times(num, a, m), mp[times(num, b, m)] = i;\n\tll n = 1;\n\tfor (int i = 1; i <= p; i++) {\n\t\tn = times(n, num, m);\n\t\tif (mp.find(n) != mp.end()) return 1ll * p * i - mp[n];\n\t}\n\treturn -1;\n}\nint main() {\n\tll k, m;\n\tcin >> k >> m;\n\tcout << bsgs(10, 9 * k + 1, m) << endl;\n\treturn 0;\n}\n\n```",
        "postTime": 1572251434,
        "uid": 61068,
        "name": "01190220csl",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4884 \u3010\u591a\u5c11\u4e2a1\uff1f\u3011"
    },
    {
        "content": "[\u535a\u5ba2\u5185\u98df\u7528\u66f4\u4f73](https://www.luogu.com.cn/blog/Dream-Battle/solution-p4884)\n\n\u9898\u76ee\u4f20\u9001\u95e8\uff1a [Link](https://www.luogu.com.cn/problem/P4884)\n\n\u524d\u7f6e\u77e5\u8bc6\uff1a [BSGS/exBSGS](https://www.luogu.com.cn/problem/P4195)\n\n## Solution\n\n\u770b\u5230 $n$ \u4e2a $1$ \uff0c\u5b66\u4e60\u8fc7\u6570\u8bba\u7684\u5e94\u8be5\u5f88\u5bb9\u6613\u8054\u60f3\u5230\u5b83\u7684\u53e6\u4e00\u4e2a\u5f62\u5f0f\uff1a\n\n$$\\frac{10^n-1}{9}$$\n\n\u6240\u4ee5\u539f\u5f0f\u662f\u8fd9\u4e2a\u6837\u5b50\u7684\uff1a\n\n$$\\frac{10^n-1}{9}\\equiv \\operatorname{K} \\left(\\bmod \\space m\\right)$$\n\n\u628a\u5206\u6bcd\u79fb\u81f3\u53f3\u8fb9\u5e76\u5316\u7b80\u5f97\uff1a\n\n$${10^n}\\equiv \\operatorname{9K+1} \\left(\\bmod \\space m\\right)$$\n\n\u90a3\u4e48\u5c31\u53ef\u4ee5\u5957 BSGS/exBSGS \u7684\u677f\u5b50\u4e86\uff0c\u4f46\u662f\u6570\u636e\u8303\u56f4\u6bd4\u8f83\u5927\uff0c\u6240\u4ee5\u7b14\u8005\u5077\u61d2\u7528\u4e86 `__int128` \u3002\u540c\u65f6\uff0c\u8fd8\u9700\u6ce8\u610f hash \u6570\u7ec4\u7684\u5927\u5c0f\uff0c\u8fc7\u5927\u4f1a MLE \uff0c\u5c0f\u4e86\u5219\u4f1a RE \uff0c\u5b9e\u6d4b\u7528 $2^{20}$ \u53ef\u4ee5\u8fc7\u3002\n\n\u9644\u4e0a\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define ll __int128\n#define int __int128\nusing namespace std;\n\nclass Hash{\n\tstatic const ll HASHMOD=1000003;\n\tll top,hash[HASHMOD+100],value[HASHMOD+100],stack[1<<20];\n\tll locate(const int x) const{\n\t\tint h=x%HASHMOD;\n\t\twhile(hash[h]!=-1 && hash[h]!=x) h++;\n\t\treturn h;\n\t}\npublic:\n\tHash(): top(0) { memset(hash,0xFF,sizeof(hash)); }\n\tvoid insert(const ll x, const ll v){\n\t\tconst ll h=locate(x);\n\t\tif(hash[h]==-1)\n\t\t\thash[h]=x ,value[h]=v, stack[++top]=h;\n\t}\n\tll get(const ll x) const{\n\t\tconst ll h=locate(x);\n\t\treturn hash[h]==x ? value[h] : -1;\n\t}\n\tvoid clear(){ while(top) hash[stack[top--]]=-1;}\n} hash;\nstruct Triple{\n\tll x,y,z;\n\tTriple(){}\n\tTriple(const ll a, const ll b,const ll c): x(a), y(b), z(c){};\n};\n\nTriple Extendedgcd(const ll &a, const ll &b){\n\tif(b==0) return Triple(1,0,a);\n\tconst Triple last=Extendedgcd(b,a%b);\n\treturn Triple(last.y,last.x-a/b*last.y,last.z);\n}\n\nll ebsgs(ll A, ll B, ll C){\n\tll tmp=1, cnt=0, D=1;\n\tfor(ll i=0;i<32;++i){\n\t\tif(tmp==B) return i;\n\t\ttmp=tmp*A%C;\n\t}\n\tfor(Triple res; (res=Extendedgcd(A,C)).z!=1; ++cnt){\n\t\tif(B%res.z) return -1;\n\t\tB/=res.z,C/=res.z;\n\t\tD=D*A/res.z%C;\n\t}\n\tconst ll sqrtn=static_cast<ll>(ceil(sqrt((double)C)));\n\thash.clear();\n\tll base=1;\n\tfor(ll i=0;i<sqrtn;++i){\n\t\thash.insert(base,i);\n\t\tbase=base*A%C;\n\t}\n\tll j=-1,i;\n\tfor(i=0;i<sqrtn;++i){\n\t\tTriple res=Extendedgcd(D,C);\n\t\tconst ll c=C/res.z;\n\t\tres.x=(res.x*B/res.z%c+c)%c;\n\t\tj=hash.get(res.x);\n\t\tif(j!=-1) return i*sqrtn+j+cnt;\n\t\tD=D*base%c;\n\t}\n\treturn -1;\n} \n\nvoid read(ll &x){\n    int f=1;x=0;char s=getchar();\n    while(s<'0'||s>'9'){if(s=='-')f=-1;s=getchar();}\n    while(s>='0'&&s<='9'){x=x*10+s-'0';s=getchar();}\n    x*=f;\n}\nvoid print(ll x){\n    if(x<0)putchar('-'),x=-x;\n    if(x>9)print(x/10);\n    putchar(x%10+'0');\n}\n\nsigned main(){\n\tll b,c; read(c), read(b); \n\tc=c*9+1;\n\tc%=b;\n\tconst ll ans=ebsgs(10,c,b);\n\tprint(ans);\n\treturn 0;\n}\n```",
        "postTime": 1585319457,
        "uid": 91204,
        "name": "Fatalis_Lights",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4884 \u3010\u591a\u5c11\u4e2a1\uff1f\u3011"
    },
    {
        "content": "## \u6700\u8fd1\u5728\u5b66\u6570\u8bba\uff0c\u4e8e\u662f\u6765\u5199\u8fd9\u9053bsgs\u6a21\u677f\u9898\u3002\n\n- \u6b63\u6587\n\n\u9898\u610f\u6bd4\u8f83\u660e\u786e\uff0c\u8981\u6c42\n\n\u6700\u5c0f\u7684n\u4f7f\u5f97$111...111$\u4e00\u5171n\u4e2a$1$\uff0c\u80fd\u819c$m$\u4e3a$k$\u3002\n\n\u5373\u4e3a\u6c42\n\n$$111...111 \\equiv k \\ (mod \\ m) $$\n\n\u4e2d$111...111$\u7684\u4f4d\u6570$n$\u7684\u6700\u5c0f\u503c\u3002\n\n\u4e4d\u770b\u4e4b\u4e0b\u6ca1\u6709\u601d\u8def\uff0c\u4f46\u662f\u53ef\u4ee5\u53d1\u73b0\u628a\u8fd9\u4e2a\u6570\u4e58$9$\u518d\u52a0$1$\uff0c\u5c31\u662f$10^{n}$\u3002\n\n\u7531\u4e8e\u540c\u4f59\u5f0f\u4e24\u8fb9\u4e58\u6216\u52a0\u67d0\u6570\uff0c\u4f9d\u7136\u6210\u7acb\u3002\u6240\u4ee5\u628a\u5de6\u53f3\u4e58$9$\u52a0$1$\uff0c\n\n\u5c31\u53d8\u6210\u4e86\u6c42\n\n$$10^{n} \\equiv 9k+1 \\ (mod \\ m)$$\n\n$n$\u7684\u6700\u5c0f\u503c\u3002\n\n\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u53ef\u4ee5\u7528bsgs\u7b97\u6cd5\u6765\u6c42\n\n\u4e0d\u4f1absgs\u53ef\u4ee5\u53bb[OI-wiki](https://oi-wiki.org/math/bsgs/)\u770b\u770b\u3002\n\n- \u6ce8\u610f \n\n\u5728bsgs\u8ba1\u7b97\u8fc7\u7a0b\u4e2d\u4f1a\u7206long long\uff0c\u53ea\u5f00long long\u4f1aWA\u540e\u9762\u4e24\u4e2a\u70b9\u3002\u8981\u7528\u5feb\uff08\u9f9f\uff09\u901f\n\n\u4e58 \u6216 `__int128`\u5b58\u6570\u3002\n\n$Code$:\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <map>\nusing namespace std;\n#define int __int128\ninline int read(){\n\tregister int x=0,f=0,ch=getchar();\n\twhile('0'>ch||ch>'9')f^=ch=='-',ch=getchar();\n\twhile('0'<=ch&&ch<='9')x=(x<<1)+(x<<3)+(ch^'0'),ch=getchar();\n\treturn f?-x:x;\n}\ninline void print(int x){\n\tif(x<10){\n\t\tputchar(x+'0');\n\t\treturn ;\n\t}else print(x/10);\n\tputchar(x%10+'0');\n}\nmap<int,int>vis;\ninline int qpow(int x,int p,int P){\n\tregister int res=1;\n\tfor(;p;p>>=1,x=x*x%P)if(p&1)res=res*x%P;\n\treturn res%P;\n}\nint p,n,m,res,ans=1,Ans; \nsigned main(){\n\tn=read()*9+1,p=read();n%=p;\n\tm=ceil(sqrt((long long)p));\n\tres=qpow(10,m,p)%p;\n\tvis[n%p]=0;\n\tfor(register int i=1;i<=m;++i)\n\t\tvis[qpow(10,i,p)*n%p]=i;\n\tfor(register int i=1;i<=m;++i){\n\t\tans=ans*res%p;\n\t\tif(vis[ans]){\n\t\t\tAns=i*m%p-vis[ans];\n\t\t\tprint((Ans%p+p)%p);\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn 0;\n}\n\n\n```\n",
        "postTime": 1583318458,
        "uid": 119062,
        "name": "Lates",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4884 \u3010\u591a\u5c11\u4e2a1\uff1f\u3011"
    },
    {
        "content": "\u5148\u770b\u4e00\u4e0b\u9898\u76ee\uff1a\n\n11111...111(N\u4e2a)$\\equiv k (mod_m)$\n\n\u6211\u4eec\u53ef\u4ee5\u628aN\u4e2a1\u770b\u6210$\\frac{10^{N}-1}{9}$\uff0c\u90a3\u4e48\u7b49\u5f0f\u5c31\u53d8\u6210\u4e86\uff1a\n\n$\\frac{10^{N}-1}{9}\\equiv k(mod_m)$\n\n\u7531\u4e8e\u540c\u4f59\u7684\u7279\u6027\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u65b9\u7a0b\u53d8\u6210\uff1a\n\n$10^{N}\\equiv 9k+1 (mod_m)$\n\n\u8fd9\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a\u666e\u901a\u7684**\u9ad8\u6b21\u540c\u4f59\u65b9\u7a0b**\u4e86.\n\n\u7531\u4e8e\u6211\u4eec\u7684**m\u662f\u8d28\u6570**\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u666e\u901a\u7684**Baby Step,Giant Step**\u7b97\u6cd5\u4e86\uff0c\u6211\u8fd9\u91cc\u5c31\u4e0d\u518d\u53d9\u8ff0\u5b83\u7684\u8bc1\u660e\u8fc7\u7a0b\u4e86.\n\n\u5148\u4ea4\u4e86\u51e0\u53d1**c++**:\n\n\uff08\u7ed3\u679c\u6700\u540e\u4e24\u4e2a\u70b9\u8981\u4e48\u662f\u9f9f\u901f\u4e58TLE,\u8981\u4e48\u662f\u5feb\u4e58\u4e58\u7206\uff0cWA\uff09.\n\n\u4e0d\u4f1a\u7528**int128**,\u6211\u9009\u62e9**Python**\n\n**Code:**\n\n```python\nfrom math import *\ns=input().split()\nk=int(s[0])\np=int(s[1])\nk=k*9+1\nmap={}\ndef quickpow(a,b,p):\n    ret=1\n    while(b):\n        if(b&1):\n            ret=ret*a%p\n        a=a*a%p\n        b=b>>1\n    return ret\n\n\ndef BSGS(a,b,p):\n    t=int(sqrt(p))+1\n    aa=a\n    for i in range(0,t):\n        val=b*aa%p\n        if(i==0):\n            val=b\n        if(val not in map):\n            map[val]=i\n        if(i>=1):\n            aa=(aa*10)%p\n\n    a=quickpow(a,t,p)\n    aa=a\n    if(a==0):\n        if(b==0):\n            return 1\n        else:\n            return -1\n    for i in range(0,t+1):\n        #val=quickpow(a,i,p)%p\n        val=a\n        if(i==0):\n            val=1\n        if(val in map):\n            j=map[val]\n            if(i*t-j>=0):\n                return i*t-j\n        if(i>=1):\n            a=(a*aa)%p\n    return -1\nprint(BSGS(10,k,p))\n```\n",
        "postTime": 1571800685,
        "uid": 103304,
        "name": "a2954898606",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P4884 \u3010\u591a\u5c11\u4e2a1\uff1f\u3011"
    },
    {
        "content": "[\u849f\u84bbblog]()\uff0c\u6b22\u8fce\u6765\u8e29QwQ\uff01\uff01\uff01\n\n\u8fd9\u4e48\u591a\u4eba\u90fd\u7528\u4e86$map$+__ int128\n\n\u6211\u5c31\u53d1\u4e00\u6ce2$longdouble$\u4e58\u9632\u7206$long\\ long$+\u624b\u5199$hash$\u7684\u9898\u89e3\u5427QwQ\n\n\u601d\u8def\u90fd\u662f\u5f0f\u5b50\u8f6c\u6362\u6210$10^n\\equiv 9k+1(mod\\ m)$\uff0c\u5f62\u5982$a^x\\equiv b(mod\\ p)$\uff0c\u6240\u4ee5\u8fd9\u662f\u4e00\u9053$BSGS$\u7684\u6a21\u677f\u9898\uff0c\u5176\u4e2d$a=10,b=9k+1,p=m$\uff0c\u8dd1\u5927\u6b65\u5c0f\u6b65\u5c31$OK$\u5566\n\n\u5173\u4e8e$hash$\u8868\u7684\u5927\u5c0f\uff0c\u5176\u5b9e\u53ea\u9700\u8981\u9009\u4e00\u4e2a\u5927\u4e8e$\\sqrt{10^{11}}=10^{6.5}\\approx 3.16\\times 10^5$\u7684\u8d28\u6570\u5c31\u53ef\u4ee5\u4e86\uff0c\u4f46\u4e0d\u8981\u592a\u5927\uff0c\u5bb9\u6613\u70b8\u7a7a\u95f4\n\n\u4ee5\u4e0b\u662f$BSGS$\u7b97\u6cd5\u7684\u6d41\u7a0b\n>\u8bbe$x=it-j$\uff0c\u5176\u4e2d$t=\\lceil \\sqrt p\\rceil$\uff0c$0\\leq j<t$\uff0c\u5219\u65b9\u7a0b\u53ef\u4ee5\u53d8\u6210$a^{it-j}\\equiv b(mod\\ p)$\uff0c\u4e24\u8fb9\u540c\u65f6\u4e58$a^j$\uff0c\u5f97\u5230$a^{it}\\equiv ba^j(mod\\ p)$\uff0c\u5373$(a^i)^t\\equiv ba^j(mod\\ p)$\u3002\n\n>\u6b64\u65f6\u5bf9\u4e8e\u6240\u6709\u7684$j\\in [0,t-1]$\uff0c\u628a$ba^j\\ mod\\ p$\u63d2\u5165\u4e00\u4e2a$hash$\u8868\u3002\n\n>\u7136\u540e\u5bf9\u4e8e\u6240\u6709\u7684$i\\in[0,t]$\uff0c\u8ba1\u7b97$(a^i)^t\\ mod\\ p$\uff0c\u540c\u65f6\u67e5\u8be2\u662f\u5426\u5b58\u5728\u5bf9\u5e94\u7684$j$\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(\\sqrt p)$\n\n\u5176\u5b9e\u51c6\u786e\u6765\u8bf4\u5e94\u8be5\u662f$O(\\sqrt p\\ log\\ \\sqrt p)$\u4e86\u5566\uff0c\u5feb\u901f\u5e42\u4e5f\u8981\u65f6\u95f4\u7684\u561b\u4e0d\u662f\uff1f\n***\n#### $Code$\n```cpp\n#include<cmath>\n#include<cstdio>\n#include<algorithm>\n#define LL long long\nusing namespace std;LL m,k;\nstruct hash\n{\n\t#define p 1000003\n\tLL a[p],b[p];//a\u662f\u539fhash\u8868\uff0cb\u7528\u6765\u5b58\u50a8\u8fd9\u4e2a\u4f4d\u7f6e\u4e0a\u8981\u5b58\u7684\u6570\n\tinline LL h(LL x){return x%p;}//\u6c42\u51fa\u6bcf\u4e2a\u6570\u5bf9\u5e94\u7684hash\u51fd\u6570\u503c\n\tinline int find(LL x)//\u5728hash\u8868\u4e2d\u67e5\u627ex\n\t{\n\t\tint y=x%p;\n\t\twhile(a[y]&&a[y]!=x) y=h(++y);//\u76f4\u5230\u627e\u5230\u4e00\u4e2a\u7a7a\u4f4d\u6216\u627e\u5230\u8fd9\u4e2a\u6570\u4e3a\u6b62\n\t\treturn y;\n\t}\n\tinline void push(LL x,LL num)//\u5728x\u7684\u4f4d\u7f6e\u653e\u5165num\n\t{\n\t\tint y=find(x);//\u7ed9\u4e88\n\t\ta[y]=x;\n\t\tb[y]=num;\n\t\treturn;\n\t}\n\tinline int init(LL x)//\u5224\u65ad\u662f\u5426\u5b58\u5728x\uff0c\u5b58\u5728\u8fd4\u56de\u5bf9\u5e94\u6570\u503c\uff0c\u4e0d\u5b58\u5728\u8fd4\u56de-1\n\t{\n\t\tint y=find(x);\n\t\treturn a[y]==x?b[y]:-1;\n\t}\n\t#undef p\n}h;\ninline LL ksc(LL a,LL b,LL p)//long double\u7248\u672c\u7684\u5feb\u901f\u4e58\uff0c\u9632\u6b62\u76f8\u57ce\u7206long long\n{\n    a%=p;b%=p;\n    long long c=(long double)a*b/p;\n    long long ans=a*b-c*p;\n    if(ans<0) ans+=p;\n    else if(ans>=p) ans-=p;\n    return ans;\n}\ninline LL ksm(LL x,LL y,LL p)//\u5feb\u901f\u5e42\n{\n\tLL ans=1;\n\tfor(;y;y>>=1,x=ksc(x,x,p)) if(y&1) ans=ksc(ans,x,p);\n\treturn ans;\n}\ninline LL BSGS(LL a,LL b,LL p)\n{\n\ta%=p;b%=p;\n\tif(!a) return !b?1:-1;\n\tif(b==1) return 0;\n\tLL t=ceil(sqrt(p)),val;\n\tfor(register int j=0;j<t;j++) val=ksc(b,ksm(a,j,p),p),h.push(val,j);//\u653e\u5165hash\u8868\u4e2d\n\ta=ksm(a,t,p);val=1;//\u521d\u59cb\u5316val=a^0\n\tfor(register int i=1;i<=t;i++)\n\t{\n\t\tval=ksc(val,a,p);//\u6bcf\u6b21\u4e58a\uff0c\u5c31\u53d8\u6210\u4e86val=a^i\n\t\tLL j=h.init(val);//\u67e5\u8be2\n\t\tif(j>=0&&i*t-j>=0) return i*t-j;//\u5224\u65ad\n\t}\n\treturn -1;\n}\nsigned main()\n{\n\tscanf(\"%lld%lld\",&k,&m);\n\tprintf(\"%lld\",BSGS(10,9*k+1,m));\n}\n```",
        "postTime": 1559346769,
        "uid": 52915,
        "name": "Ajwallet",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4884 \u3010\u591a\u5c11\u4e2a1\uff1f\u3011"
    },
    {
        "content": "\u5feb\u901f\u4e58from\u8fd9\u4f4d\u5de8\u4f6c [sxyugao] Orz Orz\n------------\n\u770b\u9898\u89e3\u4e2d\u6ca1\u5feb\u901f\u4e58\u7684\u4ee3\u7801\uff0c\u6211\u8fd9\u849f\u84bb\u7ed9\u4e00\u4efd\u4ee3\u7801\u4f9b\u53c2\u8003\n\n\u8fd9\u9053\u9898\u8bbe\u7b54\u6848\u4e3ax \u5373\u53ef\u4ee5\u5f97\u5230\u5f0f\u5b50:1/9*(10^x-1)\u2261K (mod m)\n\n\u5316\u7b80\u540e\u5f97:10^x\u22619K+1 (mod m)\n\n\u663e\u7136\u5c31\u662f\u4e00\u9053bsgs\u6a21\u677f\u9898\n\n\n\n------------\n\n\n\u4ee5\u4e0b\u7b80\u8981\u4ecb\u7ecdbsgs\u7b97\u6cd5\u601d\u8def:\n\n\u6211\u4eec\u6c42\u7684x\u53ef\u8bbe\u4e3ax=i*t - j  \uff080 <=j< t\uff09\n\n\u5176\u4e2dt=ceil(sqrt(m)) \uff08\u6570\u5b66\u7b26\u53f7\u4e0d\u60f3\u627e\u4e86\u3002\u3002\u3002\uff09\n\nP.S. \u8bbet=ceil(sqrt(m))\u662f\u56e0\u4e3a\u6b64\u65f6\u590d\u6742\u5ea6\u671f\u671b\u503c\u6700\u5c0f\n\n\u90a3\u4e48\u539f\u5f0f\u53ef\u7ee7\u7eed\u5316\u4e3a (10^t)^i\u2261(9K+1)*10^j \uff08mod m\uff09 \uff080 <=j< t \uff09\n\n\u90a3\u4e48\u53f3\u4fa7\u53ef\u4ee5\u679a\u4e3e 0 <=j< t \u7684 j \u7b97\u51fa(9K+1)*10^j % m \u5e76\u5b58\u5165\u4e00\u4e2ahash\u8868\u4e2d\uff08\u53ef\u7528map\uff09\n\n\u50cf\u8fd9\u6837\uff1ahash[(9K+1)*10^j%m]=j\n\n\u5de6\u4fa7\u679a\u4e3e 0 <=i<= t \u7684 i \u7b97\u51fa(10^t)^i % m\u67e5\u8868\u770b\u770b\u6709\u6ca1\u6709\u5bf9\u5e94\u503c \u6709\u7684\u8bdd \u7b54\u6848\u5c31\u662fi*t-hash[(10^t)^i%m]\n```\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<vector>\n#include<cmath>\n#include<map>\nusing namespace std;\ntypedef long long ll;\nll a,b,p,x;\nmap<ll,int> hash;\nmap<ll,int>::iterator it;\nll mul(ll a,ll b,ll p)\n{\n    if(a>1e9||b>1e9){\n        ll x = 1LL<<25;\n        ll L = a * (b >> 25LL) % p * x % p;\n        ll R = a * (b & (x - 1)) % p;\n        return (L + R) % p;\n    }\n    else\n        return a*b%p;\n}\nll qpow(ll a,ll b,ll p)\n{\n    ll ans=1;\n    for(;b;b>>=1)\n    {\n        if(b&1){\n            ans=mul(ans,a,p);\n        }\n        a=mul(a,a,p);\n    }\n    return ans;\n}\nll bsgs(ll a,ll b,ll p)\n{\n    a%=p,b%=p;\n    if(a==0) return b==0?1:-1;\n    if(b==1) return 0;\n    ll t=ceil(sqrt(p)),val;\n    for(int j=0;j<t;j++)\n    {\n        val=mul(b,qpow(a,j,p),p);\n        hash[val]=j;\n    }\n    a=qpow(a,t,p);\n    val=1;\n    for(int i=1;i<=t;i++)\n    {\n        val=mul(val,a,p);\n        it=hash.find(val);\n        if(it!=hash.end())\n        {\n            if(i*t-(it->second)>=0) return i*t-(it->second);\n        }\n    }\n    return -1;\n}\nint main()\n{\n    scanf(\"%lld%lld\",&b,&p);\n    x=bsgs(10,9*b+1,p);\n    printf(\"%lld\\n\",x);\n    return 0;\n}\n```\n\u521a\u521a\u53c8\u4f18\u5316\u4e86\u4e00\u4e0b \u73b0\u5728\u4e00\u79d2\u5185\u80fd\u8fc7\n\n\n\u518d\u9644\u4e0a\u4e00\u679absgs\u62d3\u5c55\uff08\u5373\u4e0d\u8981\u6c42a\u4e0ep\u4e92\u8d28\uff09\n```\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<vector>\n#include<cmath>\n#include<map>\nusing namespace std;\ntypedef long long ll;\nll a,b,p,x;\nmap<ll,int> hash;\nmap<ll,int>::iterator it;\nll mul(ll a,ll b,ll p)\n{\n    if(a>1e9||b>1e9){\n        ll x = 1LL<<25;\n        ll L = a * (b >> 25LL) % p * x % p;\n        ll R = a * (b & (x - 1)) % p;\n        return (L + R) % p;\n    }\n    else\n        return a*b%p;\n}\nll qpow(ll a,ll b,ll p)\n{\n    ll ans=1;\n    for(;b;b>>=1)\n    {\n        if(b&1){\n            ans=mul(ans,a,p);\n        }\n        a=mul(a,a,p);\n    }\n    return ans;\n}\nll gcd(ll a,ll b)\n{\n    if(b==0) return  a;\n    return gcd(b,a%b);\n}\nll ex_bsgs(ll a,ll b,ll p)\n{\n    a%=p,b%=p;\n    if(a==0) return b==0?1:-1;\n    if(b==1) return 0;\n    ll d=a,tmp=1,k=0;\n    while(true)\n    {\n        d=gcd(d,p);\n        if(d==1) break;\n        if(b%d!=0) return -1;\n        b/=d,p/=d;\n        tmp=mul(tmp,a/d,p);\n        k++;\n        if(tmp==b) return k;\n    }\n    a%=p,b%=p,tmp%=p;\n    ll t=ceil(sqrt(p)),val;\n    for(int j=0;j<t;j++)\n    {\n        val=mul(b,qpow(a,j,p),p);\n        hash[val]=j;\n    }\n    a=qpow(a,t,p);\n    val=tmp;\n    for(int i=1;i<=t;i++)\n    {\n        val=mul(val,a,p);\n        it=hash.find(val);\n        if(it!=hash.end())\n        {\n            if(i*t-(it->second)+k) return i*t-(it->second)+k;\n        }\n    }\n    return -1;\n}\nint main()\n{\n    scanf(\"%lld%lld\",&b,&p);\n    x=ex_bsgs(10,9*b+1,p);\n    printf(\"%lld\\n\",x);\n    return 0;\n}\n```",
        "postTime": 1551372563,
        "uid": 128523,
        "name": "ZhuMingYang",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4884 \u3010\u591a\u5c11\u4e2a1\uff1f\u3011"
    },
    {
        "content": "2022.9.23 ver. \n\n\u6821\u6b63\u4e86\u4e4b\u524d\u7684\u9519\u8bef\uff0c\u5e76\u4e14\u6839\u636e\u65b0\u6570\u636e\u8303\u56f4\u8c03\u6574\u9898\u89e3\u5185\u5bb9\u3002\n\n\u8fd9\u7bc7\u9898\u89e3\u7684\u4e0a\u4e00\u4e2a\u7248\u672c\u64b0\u5199\u4e8e 2019.07.15\u3002\n\n\u6570\u636e\u8303\u56f4**\u5728 2020 \u5e74\u624d**\u4fee\u6539\u4e3a\u73b0\u5728\u7684\u6570\u636e\u8303\u56f4\u3002\n\n\u8bf7\u52a1\u5fc5\u6ce8\u610f\u3002\n\n------------\n#### 1. \u601d\u8def\n\n$$\\begin{aligned}\\dfrac {10^{x}-1} {9}&\\equiv K\\pmod {m}\\\\\\dfrac {10^{x}-1} {9}+my&=K\\\\10^{x}-1+9my&=9K\\\\10^{x}-1&\\equiv 9K\\sout {\\pmod {9m}}\\pmod {m}\\end{aligned}$$\n\n~~\u53c8$\\sout {\\because 10\\perp 9m}$\u4e0d\u4e00\u5b9a\u6210\u7acb\uff0c\u672c\u9898\u5e94\u4f7f\u7528$\\sout {\\mathrm {exBSGS}}$\u7b97\u6cd5\u3002~~\n\n\u6570\u636e\u8303\u56f4\u8c03\u6574\u4e4b\u540e\uff0c$m$ \u662f**\u4e0d\u5c0f\u4e8e** $6$ \u7684\u8d28\u6570\u3002\n\n\u4e8e\u662f $m=2$ \u548c $m=5$ \u7684\u60c5\u51b5**\u88ab\u6392\u9664**\uff0c$10\\perp m$ \u4e00\u5b9a\u6210\u7acb\u3002\n\n\u90a3\u4e48 $\\rm BSGS$ \u5c31\u591f\u7528\u4e86\u3002\u53e6\u5916\uff0c\u9898\u76ee\u4e00\u5b9a\u6709\u89e3\u4e5f\u4e0d\u96be\u786e\u8ba4\u4e86\u3002\n\n~~\u9664\u6b64\u4e4b\u5916\uff0c\u672c\u9898\u660e\u786e\u8981\u6c42$\\sout {x>0}$\uff0c\u56e0\u6b64$\\sout {x=0}$\u7684\u60c5\u51b5\u5e94\u5f53\u88ab\u6392\u9664\uff0c\u4f46\u8ba1\u7b97\u6240\u6709\u89e3\u5bfc\u81f4\u4e86$\\sout \\color{DarkBlue} \\mathrm {TLE}$\u6216\u8bb8\u662f\u56e0\u4e3a\u6211\u592a\u83dc\u4e86~~\u3002\n\n~~\u7528$\\sout {unordered\\_ map}$\u3001\u5f00$\\sout {O_{2}}$\u624d\u52c9\u5f3a\u901a\u8fc7\u8be5\u9898\u3002~~\n\n\u4e4b\u524d\u7684\u6570\u636e\u8303\u56f4\u6682\u4e14\u4e0d\u8c08\u3002\u6211\u4eec**\u53ea\u8003\u8651\u73b0\u6709**\u6570\u636e\u8303\u56f4\u4e0b\uff0c$x>0$ \u662f\u5426\u4e00\u5b9a\u6210\u7acb\u3002\n\n\u6211\u4eec\u5148\u5047\u5b9a $x=0$\uff0c\u4e0d\u96be\u63a8\u77e5\u6b64\u65f6 $m|K$\u3002\n\n\u4f46\u662f $K<m$\uff0c\u663e\u7136\u8fd9\u4e24\u6761\u662f\u77db\u76fe\u7684\u3002\n\n\u4e8e\u662f\u5fc5\u6709 $x\\neq 0$\u3002\n\n\u663e\u7136 $x\\geq 0$ \uff0c\u90a3\u4e48 $x>0$ \u4fbf\u662f\u677f\u4e0a\u9489\u9489\u7684\u4e86\u3002\n\n\u6570\u636e\u8303\u56f4\u5f88\u5927\uff0c\u522b\u5fd8\u4e86\u7528\u5feb\u901f\u4e58\uff01\n\n\uff08\u5f53\u7136\uff0c`__int128` \u4e5f\u884c\uff09\n#### 2. \u4ee3\u7801\n```cpp\n#include <cstdio>\n#include <cmath>\n#include <map>\n#define rgst register\nusing namespace std;\n\ntypedef long long ll;\n\nll x, y, K, M;\nmap<ll, int> q;\n\ninline ll qmul(ll a, ll b, ll p)\n{\n\tll d = (ll)(a *(long double)b / p + 0.5);\n\tll res = a * b - d * p;\n\treturn((res % p + p)% p);\n}\n\ninline ll qpwr(ll a, ll n, ll p)\n{\n\tll res= 1;\n\ta %= p;\n\tfor(; n; n >>= 1, a = qmul(a, a, p)% p)\n\t\tif(n & 1)\n\t\t\tres = qmul(a, res, p);\n\treturn(res % p);\n}\n\ninline ll bsgs(ll a, ll b, ll p)\n{\n\tq.clear();\n\tb %= p;\n\tq[b] = 0;\n\tint m = ceil(sqrt(p));\n\tfor(rgst int i = 1; i <= m; i++)\n\t{\n\t\tb = qmul(b,a,p);\n\t\tq[b] = i;\n\t}\n\tb = 1;\n\tll po = qpwr(a,m,p);\n\tfor(rgst int i = 1; i <= m; i++)\n\t{\n\t\tb = qmul(b, po, p);\n\t\tif(q.count(b))\n\t\t\treturn( ((1ll * m * i - q[b])% p + p)% p);\n\t}\n\treturn(-1);\n}\n\ninline ll calc(ll a,ll b,ll p)\n{\n\ta %= p, b %= p;\n\tll res = bsgs(a, b, p);\n\tif(res == -1)\n\t\treturn(-1);\n\treturn(res);\n}\n\nint main()\n{\n\tscanf(\"%lld %lld\", &K, &M);\n\tprintf(\"%lld\", calc(10, 9 * K + 1, M));\n\treturn(0);\n}\n```",
        "postTime": 1563193707,
        "uid": 14854,
        "name": "\u672a\u89c1\u5807\u5f00",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4884 \u3010\u591a\u5c11\u4e2a1\uff1f\u3011"
    }
]
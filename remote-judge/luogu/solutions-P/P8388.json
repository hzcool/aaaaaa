[
    {
        "content": "[\u9898\u9762](https://www.luogu.com.cn/problem/P8388)\n\n\u9996\u5148\u5206\u6790\u9898\u610f\uff0c\u6ce8\u610f\u201c\u6309\u7816\u5757\u7684\u653e\u7f6e\u987a\u5e8f\u7ed9\u5b9a\u6bcf\u5757\u7816\u7684\u957f\u5ea6\u201d\uff0c\u5373\u6b64\u5904\u6bcf\u4e00\u5c42\u4e00\u5b9a\u5bf9\u5e94\u539f\u7cfb\u5217\u7684\u4e00\u4e2a\u8fde\u7eed\u6bb5\u3002\n\n\u663e\u7136\u5373\u4e3a\u5e8f\u5217\u5206\u6bb5\u95ee\u9898\uff0c\u8003\u8651 DP\u3002\u4e0d\u59a8\u8bbe\u6709\u8fde\u7eed\u6bb5 $[t,l - 1]$ \u53ca $[l,r]$ \uff0c\u5219 $[l,r]$ \u7684\u8d21\u732e\uff1a\n\n$$\\sum^{r-1}_{q=l}[\u2203 p\\in[t+1,l-1],\\sum^{l-1}_{k=p}d_k=\\sum^{q}_{k=l}d_k]$$\n\n\u6ce8\u610f**\u56db\u4e2a\u7816\u5757**\u5171\u9876\u70b9\u610f\u5473\u7740\u5de6\u53f3\u8fb9\u754c\u90e8\u5206\u662f\u4e0d\u7b97\u7684\u3002\n\n\u5373\u6709\u591a\u5c11\u4e2a\u4f4d\u7f6e $q\\in[l, r-1]$ \u6ee1\u8db3\u5b58\u5728\u5bf9\u5e94\u7684 $p\\in[t+1,l-1]$ \u4f7f\u5f97 $[l,q]$ \u6bb5\u4e4b\u548c\u7b49\u4e8e $[p,l - 1]$ \u6bb5\u4e4b\u548c\u3002\n\n\u7531\u4e8e $n\\le5\\times10^3$\uff0c\u8003\u8651\u8bbe $f_{i,j}$ \u8868\u793a\u5206\u4e3a\u82e5\u5e72\u6bb5\uff0c\u6ee1\u8db3\u6700\u540e\u4e00\u6bb5\u4e3a $[i,j]$ \u7684\u8d21\u732e\u3002\n\n\u8981\u4e48 $[l,j]$ \u4e0d\u80fd\u5339\u914d\u4efb\u4f55 $[p,l-1]$\uff0c\u8f6c\u79fb\u663e\u7136\u3002\u8981\u4e48 $[l,j]$ \u5339\u914d\u67d0\u4e00\u533a\u95f4 $[p,l-1]$\uff0c\u8fd9\u65f6\u5019\u8981\u6c42\u4e0a\u4e00\u6bb5\u7684\u5de6\u7aef\u70b9 $k \\le p$\uff0c\u5373\u53ef\u8f6c\u79fb\u3002\u5229\u7528\u524d\u7f00\u6700\u503c $g_{t,j}$ \u8bb0\u5f55\u6ee1\u8db3 $i\\in[1,t]$ \u7684 $f_{i,j}$ \u7684\u6700\u5927\u503c\u5373\u53ef\u3002\n\n\u968f\u7740 $j$ \u7684\u589e\u52a0\uff0c$p$ \u5355\u8c03\u4e0d\u589e\u3002\u6545\u65f6\u7a7a\u590d\u6742\u5ea6 $O(n^2)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define maxn 5005\nusing namespace std;\n\nint n, ans, a[maxn], f[maxn][maxn], g[maxn][maxn];\nsigned main() {\n    scanf(\"%d\", &n);\n    for (int i = 1; i <= n; ++i) scanf(\"%d\", a + i);\n    // \u8fb9\u754c\u5904\u7406\uff0c\u5373\u521d\u59cb\u5904\u6700\u591a\u4ec5\u6709 3 \u4e2a\u5171\u9876\u70b9\uff0c\u4e0d\u80fd\u5339\u914d\n    for (int j = 0; j <= n; ++j) g[0][j] = g[j][0] = -0x3f3f3f3f;\n    for (int i = 1; i <= n; ++i) {\n        int ls = 0, rs = 0, t = 0, k = i, tp = 0;\n        for (int j = i; j <= n; ++j) {\n            f[i][j] = max(f[i][j - 1], max(f[k][i - 1] + t - tp, g[k - 1][i - 1] + t));\n            g[i][j] = max(g[i - 1][j], f[i][j]);\n            rs += a[j];\n            while (ls < rs && k > 1) ls += a[--k];\n            if (ls >= rs) tp = (rs == ls);\n            if (rs == ls) ++t; \n        }\n        ans = max(ans, f[i][n]);\n    }\n    printf(\"%d\", ans);\n    return 0;\n}\n```",
        "postTime": 1672376209,
        "uid": 62440,
        "name": "MuelsyseU",
        "ccfLevel": 0,
        "title": "P8388 [COI2021] Cigle \u9898\u89e3"
    }
]
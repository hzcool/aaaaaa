[
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P9091)\n\n### \u524d\u8a00\n\n\u5c1d\u8bd5\u4ecb\u7ecd\u4e0b\u4e00\u79cd\u5bb9\u6613\u5b9e\u73b0\u4e14\u5e38\u6570\u5f88\u5c0f\u7684\u79ef\u6027\u51fd\u6570\u6c42\u548c\u6cd5\u3002\n\n### Solution\n\n\u5f0f\u5b50\u7684\u63a8\u5bfc\u8bf7\u89c1\u51fa\u9898\u4eba Leasier \u7684[\u9898\u89e3](https://www.luogu.com.cn/blog/Leasier/solution-P9091)\uff0c\u8fdb\u4e00\u6b65\u8f6c\u5316\u540e\u5f97\u5230\u539f\u5f0f $=mS_{I_{m+1}}(n)$\uff0c\u5176\u4e2d $I_n$ \u8868\u793a $I*I\\,*\u00b7\u00b7\u00b7*\\,I$ (\u5377 $n$ \u6b21)\uff0c\u4e3a\u79ef\u6027\u51fd\u6570\u3002\n\n\u5bf9\u4e8e\u79ef\u6027\u51fd\u6570 $f$\uff0c\u6784\u9020 $g$ \u6ee1\u8db3 $g(p^k)=f(p)^k$\uff0c\u5219 $f=g*h$\uff0c\u6613\u5f97 $h(p^k)=f(p^k)-f(p)f(p^{k-1})$\u3002\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5148\u7b97\u8f83\u5bb9\u6613\u6c42\u51fa\u7684 $g$\uff0c\u518d\u501f\u52a9 $PN$ \u5f97\u5230 $f$\u3002\n\n\u56de\u5fc6\u4e00\u4e0b min_25 \u7b5b\u7684\u7b2c\u4e00\u90e8\u5206\uff0c$g$ \u4e3a\u6ee1\u8db3 $g(p^k)=g(p)^k$ \u7684\u4efb\u4e00\u79ef\u6027\u51fd\u6570\uff0c\u4ee4 $S(n, a)=\\sum\\limits_{i=1}^{n}[min_i>p_a \\,or\\;i\\in P]\\,g(i)$\uff0c\u6709 :\n$$S(n,a)=S(n,a-1)-g(p_a)(S(\\frac{n}{p_a},a-1)-S(p_{a-1},a-1))$$\n\n\u90a3\u4e48\u5176\u5b9e\u5b83\u4e5f\u80fd\u5199\u6210\u8fd9\u6837 :\n$$S(n,a-1)=S(n,a)+g(p_a)(S(\\frac{n}{p_a},a-1)-S(p_{a-1},a-1))$$\n\n\u4e5f\u5c31\u662f\u8bf4\u5bf9\u4e8e\u6211\u4eec\u8981\u6c42\u7684 $g$\uff0c\u6211\u4eec\u53ea\u9700\u5148\u6c42\u51fa\u5176\u5728\u7d20\u6570\u5904\u7684\u548c\uff08\u5373\u5f97\u5230 $S(m,\\pi(\\sqrt{n}))$\uff0c$m=\\left\\lfloor\\dfrac{n}{i}\\right\\rfloor$\uff0c$i=1,2,\u00b7\u00b7\u00b7,\\sqrt{n}$\uff09\uff0c\u4fbf\u53ef\u901a\u8fc7\u540e\u4e00\u5f0f\u5f97\u5230 $g$ \u7684\u5757\u7b5b\u3002\n\n\u4e4b\u540e\u5c31\u53ef\u4ee5\u5728 $O(\\sqrt n)$ \u5185\u5f97\u5230 $S_f(n)$\uff0c\u6216\u5728 $O(\\sqrt{n}\\log^{1+\\varepsilon} n)$ \u5185\u5f97\u5230 $f$ \u7684\u5757\u7b5b\u3002\n\n### \u5b9e\u73b0\n\n\u8fdc\u53e4\u4ee3\u7801\u76f4\u63a5\u7c98\u8d34\u8fc7\u6765\u4e86\uff0c\u6b20\u4f73\u3002\n```cpp\n#include <iostream>\n#include <vector>\n#include <cmath>\n#include <functional>\n#include <algorithm>\n#include <time.h>\n#include <fstream>\nusing namespace std;\nusing u32 = unsigned int;\nusing u64 = unsigned long long;\nusing i64 = long long;\ndouble inv[100005];\nu32 c[70][70];\nvector<int> primes;\nu32 solve(i64 N, u32 k) {\n\tint v = log2(N) + k;\n\t\n\tconst auto div = [&](i64 n, int d) -> i64 {return n * inv[d]; };\n\tk++;\n\tv = sqrt(N + 0.5);\n\tfor (int i = 1; i <= v; ++i) inv[i] = 1.0 / i * (1 + 1e-15);\n\tvector<u32> s(v + 1), l(v + 1);\n\tfor (int i = 1; i <= v; ++i) s[i] = i - 1, l[i] = div(N, i) - 1;\n\tfor (int p = 2; p <= v; ++p)\n\t\tif (s[p] != s[p - 1]) {\n\t\t\tprimes.push_back(p);\n\t\t\ti64 q = i64(p) * p, M = div(N, p);\n\t\t\tu32 t0 = s[p - 1];\n\t\t\tint t = v / p, u = min<i64>(v, div(M, p));\n\t\t\tfor (int i = 1; i <= t; ++i) l[i] -= l[i * p] - t0;\n\t\t\tfor (int i = t + 1; i <= u; ++i) l[i] -= s[div(M, i)] - t0;\n\t\t\tfor (int i = v, j = t; j >= p; --j)\n\t\t\t\tfor (int l = j * p; i >= l; --i)\n\t\t\t\t\ts[i] -= s[j] - t0;\n\t\t}\n\tfor (int i = 1; i <= v; ++i) s[i] *= k, l[i] *= k;\n\tfor (auto it = primes.rbegin(); it != primes.rend(); ++it) {\n\t\tint p = *it;\n\t\ti64 q = i64(p) * p, M = div(N, p);\n\t\tint t = v / p, u = min<i64>(v, div(M, p));\n\t\tu32 t0 = s[p - 1];\n\t\tif(q <= v) {\n\t\t\tu32 s0 = k * k;\n\t\t\tfor (int j = p, i = q; j < t; s0 = (s[++j] - t0) * k)\n\t\t\t\tfor (int l = j * p + p; i < l; ++i) s[i] += s0;\n\t\t\tfor (int i = t * p; i <= v; ++i) s[i] += s0;\n\t\t}\n\t\tfor (int i = u; i > t; --i) l[i] += (s[div(M, i)] - t0) * k;\n\t\tfor (int i = t; i >= 1; --i) l[i] += (l[i * p] - t0) * k;\n\t}\n\tfor (int i = 1; i <= v; ++i) s[i] += 1, l[i] += 1;\n\t\n\tk--;\n\tconst auto divide = [](i64 n, i64 d) -> i64 {return double(n) / d; };\n\tfunction< u32(i64, int, u32)> rec = [&] (i64 n, size_t beg, u32 coeff) -> u32 {\n\t\tif (!coeff) return 0;\n\t\tu32 ret = coeff * (n > v ? l[divide(N, n)] : s[n]);\n\t\tfor (size_t i = beg; i < primes.size(); ++i) {\n\t\t\tint p = primes[i];\n\t\t\ti64 q = i64(p) * p;\n\t\t\tif (q > n) break;\n\t\t\ti64 nn = divide(n, q);\n\t\t\tfor (u32 e = 1; nn; nn = div(nn, p), ++e)\n\t\t\t\tret += rec(nn, i + 1, -coeff * e * c[e + k][e + 1]);\n\t\t}\n\t\treturn ret;\n\t};\n\treturn k * rec(N, 0, 1);\n}\nint main() {\n\ti64 N;\n\tu32 k;\n\tcin >> N >> k;\n\tcout << solve(N, k);\n\treturn 0;\n}\n```\n",
        "postTime": 1677334976,
        "uid": 224584,
        "name": "\u6e10\u53d8\u8272",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P9091 \u79ef\u6027\u51fd\u6570\u6c42\u548c"
    },
    {
        "content": "~~\u4ee4\u4eba\u9057\u61be\u7684\u662f\u672c\u9898\u552f\u4e00\u8d5b\u65f6\u901a\u8fc7\u8005 @[Silver187](https://www.luogu.com.cn/user/154560) \u5199\u7684\u662f\u7ecf\u8fc7\u5927\u529b\u5361\u5e38\u540e\u7684\u7b97\u6cd5\u4e09\u3002~~\n\n------------\n\n### \u7b97\u6cd5\u4e00\n\u5bb9\u6613\u53d1\u73b0\u524d\u7f00 $\\gcd$ \u7684\u9650\u5236\u76f8\u5f53\u4e8e $\\forall 2 \\leq i \\leq m, b_i \\mid b_{i - 1}$\u3002\n\n\u679a\u4e3e $b_1$ \u540e\u8bb0\u5fc6\u5316\u641c\u7d22\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(nm^2 \\log n)$\uff0c\u53ef\u4ee5\u901a\u8fc7 $\\text{Subtask } 1$\u3002\n### \u7b97\u6cd5\u4e8c\n\u8003\u8651 $f(n, m, k)$ \u4e2d\u76f8\u90bb\u9879\u76f8\u7b49\u51fa\u73b0\u7684\u6b21\u6570\u7684\u9650\u5236\u5b9e\u9645\u4e0a\u76f8\u5f53\u4e8e\u94a6\u5b9a\u67d0\u4e9b\u9879\uff0c\u4f7f\u4e4b\u4e0e\u540e\u4e00\u9879\u76f8\u7b49\uff0c\u4e8e\u662f\u6211\u4eec\u8bbe $g(n, m)$ \u8868\u793a\u4ee5 $n$ \u7ed3\u5c3e\u7684\u5408\u6cd5\u7684 $m$ \u9879\u7684\u65b9\u6848\u6570\uff0c\u5219 $f(n, m, 0) = \\displaystyle\\sum_{i = 1}^n g(i, m)$\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651 $g(n, m)$\uff0c\u663e\u7136\u53ef\u4ee5\u5bb9\u65a5\u3002\u6211\u4eec\u5e0c\u671b\u6c42\u7684\u662f**\u6070\u597d**\u6709 $0$ \u4e2a $1 \\leq i < m, b_i = b_{i + 1}$ \u7684\u65b9\u6848\u6570\uff0c\u901a\u8fc7\u5bb9\u65a5\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u8f6c\u5316\u4e3a**\u81f3\u5c11**\u6709 $k$ \u4e2a $1 \\leq i < m, b_i = b_{i + 1}$ \u7684\u65b9\u6848\u6570\u3002\n\n\u8003\u8651\u94a6\u5b9a\u5176\u4e2d $k$ \u9879\u4e0e\u540e\u4e00\u9879\u76f8\u540c\uff0c\u65b9\u6848\u6570\u662f $C_{m - 1}^k$\uff08\u56e0\u4e3a\u4e0d\u80fd\u94a6\u5b9a\u6700\u540e\u4e00\u9879\uff09\uff1b\u5bf9\u4e8e\u4f59\u4e0b\u7684\u9879\uff0c\u5176\u53ef\u4ee5\u9009\u62e9\u4e0e\u540e\u4e00\u9879\u76f8\u540c\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u540c\uff0c\u4e14\u6bcf\u4e00\u9879\u4e00\u5b9a\u662f\u540e\u4e00\u9879\u7684\u56e0\u6570\uff0c\u65b9\u6848\u6570\u662f $I_{m - k}(b_m)$\u3002\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 $g(n, m) = \\displaystyle\\sum_{i = 0}^{m - 1} (-1)^i C_{m - 1}^i I_{m - i}(n)$\u3002\n\n\u6ce8\u610f\u5230 $f(n, m, k) = \\displaystyle\\sum_{i = 0}^k C_{m - 1}^i f(n, m - i, 0)$\uff0c\u4ee4 $S_f(n) = \\displaystyle\\sum_{i = 1}^n f(i)$\uff0c\u5219 $f(n, m, k) = \\displaystyle\\sum_{i = 0}^k C_{m - 1}^i \\sum_{j = 1}^n \\sum_{x = 0}^{m - i - 1} (-1)^x C_{m - i - 1}^x I_{m - i - x}(j) = \\sum_{i = 0}^k C_{m - 1}^i \\sum_{x = 0}^{m - i - 1} (-1)^x C_{m - i - 1}^x S_{I_{m - i - x}}(n)$\u3002\n\n\u539f\u5f0f $= \\displaystyle\\sum_{i = 1}^n \\sum_{j = 1}^m \\sum_{k = 0}^{j - 1} \\sum_{l = 0}^k C_{j - 1}^l \\sum_{x = 0}^{j - l - 1} (-1)^x C_{j - l - 1}^x S_{I_{j - l - x}}(\\lfloor \\frac{n}{i} \\rfloor)$\n\n$ = \\displaystyle\\sum_{i = 1}^n \\sum_{j = 1}^m \\sum_{k = 0}^{j - 1} \\sum_{l = 0}^k C_{j - 1}^l \\sum_{x = 0}^{j - l - 1} (-1)^x C_{j - l - 1}^{j - l - x - 1} S_{I_{j - l - x}}(\\lfloor \\frac{n}{i} \\rfloor)$\n\n\u6ce8\u610f\u5230\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u679a\u4e3e $T = l + x$\uff0c\u6709\uff1a\n\n\u539f\u5f0f $= \\displaystyle\\sum_{i = 1}^n \\sum_{j = 1}^m \\sum_{T = 0}^{j - 1} S_{I_{j - T}}(\\lfloor \\frac{n}{i} \\rfloor) \\sum_{l = 0}^T (-1)^{T - l} C_{j - 1}^l C_{j - l - 1}^{T - l} \\sum_{k = l}^{j - 1} 1$\n\n$ = \\displaystyle\\sum_{i = 1}^n \\sum_{j = 1}^m \\sum_{T = 0}^{j - 1} S_{I_{j - T}}(\\lfloor \\frac{n}{i} \\rfloor) \\sum_{l = 0}^T (-1)^{T - l} (j - l) C_{j - 1}^l C_{j - l - 1}^{T - l}$\n\n\u6ce8\u610f\u5230\u6700\u540e\u4e00\u4e2a\u6c42\u548c\u7b26\u53f7\u7684\u7ed3\u679c\u53ea\u4e0e $j, T$ \u6709\u5173\u4e14 $m$ \u5f88\u5c0f\uff0c\u4e8e\u662f\u4ee4 $g_{n, m} = \\displaystyle\\sum_{i = 0}^m (-1)^{m - i} (n - i) C_{n - 1}^i C_{n - i - 1}^{m - i}$\uff0c\u5219\u53ef\u4ee5\u5728 $O(m^3)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u9884\u5904\u7406\u51fa\u3002\n\n\u539f\u5f0f $= \\displaystyle\\sum_{i = 1}^n \\sum_{j = 1}^m \\sum_{T = 0}^{j - 1} g_{j, T} S_{I_{j - T}}(\\lfloor \\frac{n}{i} \\rfloor)$\n\n\u6ce8\u610f\u5230\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u679a\u4e3e $U = j - T$\uff0c\u6709\uff1a\n\n$ = \\displaystyle\\sum_{i = 1}^n \\sum_{U = 1}^m S_{I_U}(\\lfloor \\frac{n}{i} \\rfloor) \\sum_{T = 0}^{m - U} g_{T + U, T}$\n\n\u6ce8\u610f\u5230\u6700\u540e\u4e00\u4e2a\u6c42\u548c\u7b26\u53f7\u7684\u503c\u53ea\u4e0e $T$ \u6709\u5173\uff0c\u4e8e\u662f\u4ee4 $h_n = \\displaystyle\\sum_{i = 0}^{m - n} g_{n + i, i}$\uff0c\u5219\u53ef\u4ee5\u5728 $O(m^2)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u9884\u5904\u7406\u51fa\u3002\n\n\u539f\u5f0f $= \\displaystyle\\sum_{i = 1}^n \\sum_{U = 1}^m h_U S_{I_U}(\\lfloor \\frac{n}{i} \\rfloor)$\n\n\u7ebf\u6027\u7b5b\u6240\u6709 $I_i$ \u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(nm + m^3)$\uff0c\u53ef\u4ee5\u901a\u8fc7 $\\text{Subtask } 1, 2$\u3002\n### \u7b97\u6cd5\u4e09\n\u4e8b\u5b9e\u4e0a\u6211\u4eec\u53ea\u9700\u8981\u5bf9\u4e8e $\\forall 1 \\leq i \\leq m$\uff0c\u6c42\u51fa $I_i$ \u7684\u5757\u7b5b\u3002\n\n\u6570\u8bba\u5206\u5757 + \u6839\u53f7\u5206\u6cbb\u6216\u9012\u63a8\u7248 Min_25 \u7b5b\u6c42\u89e3\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(mn^{\\frac{2}{3}} + m^3)$ \u6216 $O(\\frac{mn^{\\frac{3}{4}}}{\\ln n} + m^3)$\uff0c\u53ef\u4ee5\u901a\u8fc7 $\\text{Subtask } 1 \\sim 3$\u3002\u5b9e\u73b0\u5e38\u6570\u8db3\u591f\u4f18\u79c0\u8fd8\u53ef\u4ee5\u901a\u8fc7 $\\text{Subtask } 4$\u3002 \n### \u7b97\u6cd5\u56db\n\u8003\u8651 $I_i$ \u5728\u8d28\u6570\u5904\u7684\u8868\u73b0\uff0c\u6211\u4eec\u53d1\u73b0 $\\forall p \\in \\operatorname{Prime}$\uff0c$I_i(p)$ \u7684\u503c**\u4e0e $p$ \u5177\u4f53\u662f\u591a\u5c11\u65e0\u5173**\u3002\n\n\u4e8e\u662f\u4e0d\u96be\u60f3\u5230 Powerful Number \u7b5b\u3002\u6784\u9020 $I_i'(p^k) = [k \\leq 1] I_i(p^k)$\uff0c\u73b0\u5728\u95ee\u9898\u8f6c\u53d8\u4e3a\u6c42\u51fa $I_i'$ \u7684\u5757\u7b5b\u3002\n\n\u663e\u7136\u53ef\u4ee5\u7b97\u8d21\u732e\uff0c\u53ef\u5f97\uff1a$S_{I_i'}(n) = \\displaystyle\\sum_{i = 0} I_i'(p)^i \\sum_{j = 1}^n [\\omega(j) = i] \\mu^2(j)$\uff0c\u5176\u4e2d $p$ \u4e3a\u4efb\u610f\u8d28\u6570\u3002\u540e\u534a\u90e8\u5206\u663e\u7136\u53ef\u4ee5\u7528\u7c7b\u4f3c Min_25 \u7b5b Part 1 \u7684\u65b9\u6cd5\u6c42\u51fa\uff0c\u56e0\u4e3a $\\displaystyle\\max_{i = 1}^n w(i) = O(\\frac{\\ln n}{\\ln \\ln n})$\uff0c\u5219\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\frac{n^{\\frac{3}{4}}}{\\ln \\ln n})$\uff0c\u8fdb\u800c\u53ef\u4ee5\u5728 $O(\\frac{m \\sqrt{n} \\ln n}{\\ln \\ln n})$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u6c42\u51fa\u5757\u7b5b\u3002\n\n\u4f46\u5982\u679c\u6b64\u65f6\u76f4\u63a5\u50cf\u675c\u6559\u7b5b\u4e00\u6837\u6839\u53f7\u5206\u6cbb\uff0c\u5757\u7b5b\u90e8\u5206\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\frac{n^{\\frac{3}{4}}}{\\ln \\ln n} + mn^{\\frac{2}{3}})$\uff0c\u4e0d\u80fd\u901a\u8fc7\u3002\n\n\u8003\u8651 Powerful Number \u7684\u6027\u8d28\u3002\u5bf9\u4e8e $\\lfloor \\frac{n}{i} \\rfloor$\uff0c\u5f53 $i \\leq \\sqrt[3]{n}$\uff0c\u663e\u7136\u53ea\u6709 $O(\\sqrt[3]{n})$ \u79cd\u503c\uff1b\u5f53 $i > \\sqrt[3]{n}$\uff0c$\\lfloor \\frac{n}{i} \\rfloor < n^{\\frac{2}{3}}$\uff0c\u6240\u4ee5\u53ea\u6709 $\\sqrt{n^{\\frac{2}{3}}} = O(\\sqrt[3]{n})$ \u79cd\u503c\u3002\u636e\u6b64\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6839\u53f7\u5206\u6cbb\u5c06\u5355\u6b21\u6c42\u5757\u7b5b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4f18\u5316\u81f3 $O(n^{\\frac{3}{5}})$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\frac{n^{\\frac{3}{4}}}{\\ln \\ln n} + mn^{\\frac{3}{5}} + m^3)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u6240\u6709\u6570\u636e\uff0c\u82e5\u5b9e\u73b0\u5e38\u6570\u8fc7\u5927\u5c06\u65e0\u6cd5\u901a\u8fc7 $\\text{Subtask } 5$\u3002\n### \u7b97\u6cd5\u4e94\n\u611f\u8c22 @[\u6e10\u53d8\u8272](https://www.luogu.com.cn/user/224584) \u63d0\u4f9b\u672c\u90e8\u5206\u505a\u6cd5\u3002\n\n\u6ce8\u610f\u5230 $h_i = [i = m] m$\uff08\u5177\u4f53\u8bc1\u660e\u7565\u53bb\uff09\uff0c\u5219\u539f\u5f0f $= m \\displaystyle\\sum_{i = 1}^n S_{I_m}(\\lfloor \\frac{n}{i} \\rfloor) = m S_{I_{m + 1}}(n)$\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ea\u9700\u8981\u6c42 $S_{I_{m + 1}}(n)$\u3002\u53ef\u4ee5\u76f4\u63a5\u91c7\u7528\u4e0a\u8ff0\u65b9\u6cd5\uff0c\u5e76\u8fd8\u53ef\u4ee5\u5728 $O(m \\sqrt{n})$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5bf9\u4e8e $1 \\sim m$ \u6c42\u89e3\u7b54\u6848\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(m \\log n + \\frac{n^{\\frac{3}{4}}}{\\ln \\ln n})$\u3002\n\n~~\u5176\u5b9e\u53ef\u4ee5\u51fa\u52a0\u5f3a\u7248\uff0c\u4f46\u662f\u61d2\u5f97\u51fa\u4e86\uff08~~\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <stdio.h>\n#include <math.h>\n\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef __int128 lll;\ntypedef __uint128_t ulll;\n\ntypedef struct Division_tag {\n\tulll a;\n\tDivision_tag(){}\n\tDivision_tag(ull mod){\n\t\ta = (((ulll)1 << 64) + mod - 1) / mod;\n\t}\n} Division;\n\nconst int N = 1e5 + 7, M = 2e5 + 7, K = 67 + 7, P = 33 + 7, Q = 10 + 7;\nint sqrt_n, prime_cnt = 0, id = 0;\nll cur_n;\nint prime[N], max_prime_cnt[M];\nuint c[K][P], g[M], h[Q][M], prime_power[P];\nll number[M];\nbool p[N];\nDivision inv_prime[N];\n\null operator /(const ull &a, const Division &b){\n\treturn a * b.a >> 64;\n}\n\ninline int min(int a, int b){\n\treturn a < b ? a : b;\n}\n\ninline int log2(ll n){\n    int ans = log2((double)n);\n    while ((1ll << ans) <= n) ans++;\n    return ans - 1;\n}\n\ninline int get_max_prime_cnt(ll n, int cnt){\n    int ans = 0;\n    for (register ll i = 1; i <= n && ans <= cnt; i *= prime[ans]) ans++;\n    return ans - 1;\n}\n\ninline int divide(ll x, ll y){\n\treturn 1.0 * x / y;\n}\n\ninline int get_id(ll n){\n\treturn n <= sqrt_n ? id - n + 1 : divide(cur_n, n);\n}\n\ninline void init(ll n, int m){\n\tint up1 = log2(n), up2 = up1 + m - 1;\n\tsqrt_n = sqrt(n);\n\tcur_n = n;\n\tc[0][0] = 1;\n\tfor (register int i = 1; i <= up2; i++){\n\t\tint t = min(i, up1);\n\t\tc[i][0] = 1;\n\t\tfor (register int j = 1; j <= t; j++){\n\t\t\tc[i][j] = c[i - 1][j] + c[i - 1][j - 1];\n\t\t}\n\t}\n\tp[0] = p[1] = true;\n\tfor (register int i = 2; i <= sqrt_n; i++){\n\t\tif (!p[i]){\n\t\t\tprime_cnt++;\n\t\t\tprime[prime_cnt] = i;\n\t\t\tinv_prime[prime_cnt] = Division(i);\n\t\t}\n\t\tfor (register int j = 1; j <= prime_cnt && i * prime[j] <= sqrt_n; j++){\n\t\t\tp[i * prime[j]] = true;\n\t\t\tif (i % prime[j] == 0) break;\n\t\t}\n\t}\n\tfor (register ll i = 1, j; i <= n; i = j + 1){\n\t\tll tn = n / i;\n\t\tj = n / tn;\n\t\tid++;\n\t\tnumber[id] = tn;\n\t\tmax_prime_cnt[id] = get_max_prime_cnt(tn, prime_cnt);\n\t\tg[id] = tn - 1;\n\t}\n\tfor (register int i = 1; i <= prime_cnt; i++){\n\t\tll t = 1ll * prime[i] * prime[i];\n\t\tfor (register int j = 1; j <= id && number[j] >= t; j++){\n\t\t\tg[j] -= g[get_id(number[j] / inv_prime[i])] - (i - 1);\n\t\t}\n\t}\n\tfor (register int i = 1; i <= id; i++){\n\t\th[0][i] = 1;\n\t\th[1][i] = g[i];\n\t}\n\tfor (register int i = prime_cnt; i >= 1; i--){\n\t\tll t1 = 1ll * prime[i] * prime[i];\n\t\tfor (register int j = 1; j <= id && number[j] >= t1; j++){\n\t\t\tint cur_id = get_id(number[j] / inv_prime[i]), t2 = max_prime_cnt[j];\n\t\t\th[2][j] -= i;\n\t\t\tfor (register int k = 2; k <= t2; k++){\n\t\t\t\th[k][j] += h[k - 1][cur_id];\n\t\t\t}\n\t\t}\n\t}\n}\n\ninline uint get_f__sum(ll n, int m){\n\tint id = get_id(n);\n\tuint ans = 0;\n\tfor (register int i = max_prime_cnt[id]; i >= 0; i--){\n\t\tans = ans * m + h[i][id];\n\t}\n\treturn ans;\n}\n\nuint get_f_sum(int cur, int m, ll val1, uint val2){\n\tuint ans = val2 * get_f__sum(cur_n / val1, m);\n\tfor (register int i = cur + 1; i <= prime_cnt && (lll)val1 * prime[i] * prime[i] <= cur_n; i++){\n\t\tint j = 2;\n\t\tfor (register ll x = val1 * prime[i] * prime[i]; x <= cur_n; j++, x *= prime[i]){\n\t\t\tans += get_f_sum(i, m, x, val2 * prime_power[j]);\n\t\t}\n\t}\n\treturn ans;\n}\n\nint main(){\n\tint m, mi;\n\tll n;\n\tscanf(\"%lld %d\", &n, &m);\n\tmi = m + 1;\n\tinit(n, mi);\n\tprime_power[0] = 1;\n\tfor (register int i = 1; (1ll << i) <= n; i++){\n\t\tprime_power[i] = c[i + m][i] - mi * prime_power[i - 1];\n\t}\n\tprintf(\"%u\", m * get_f_sum(0, mi, 1, 1));\n\treturn 0;\n}\n```",
        "postTime": 1676724007,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P9091 \u3010\u300cSvR-2\u300dLet's Meet at a Higher Place\u3011"
    },
    {
        "content": "\u663e\u7136\u5982\u679c\u77e5\u9053 $b$ \u5e8f\u5217\u4e2d\u4e0d\u540c\u7684\u6570\u7684\u4e2a\u6570\uff0c\u5c31\u53ef\u4ee5\u7b97\u51fa $b$ \u5e8f\u5217\u4e2d\u76f8\u90bb\u9879\u76f8\u7b49\u7684\u60c5\u51b5\u51fa\u73b0\u6b21\u6570\u3002\u53ef\u4ee5\u6ce8\u610f\u5230 $b_1=a_1$\uff0c\u4e0d\u5982\u679a\u4e3e $b_1=x$\uff0c\u90a3\u4e48\u540e\u9762\u7684\u65b9\u6848\u6570\u7684\u8ba1\u7b97\u53ea\u8ddf $x$ \u6709\u5173\u3002\n\n\u4e0d\u5982\u8bbe $h(x,L)$ \u8868\u793a\u957f\u5ea6\u4e3a $L$ \u4e14\u6ee1\u8db3 $b_1=x$\uff0c\u5143\u7d20\u4e24\u4e24\u4e0d\u540c\u7684 $b$ \u5e8f\u5217\u4e2a\u6570\u3002\n\n\u90a3\u4e48\u5c31\u53ef\u4ee5\u8f6c\u5316\u4e00\u4e0b\u7b54\u6848\uff0c\u5148\u4e0d\u7ba1\u90a3\u4e2a $\\lfloor\\frac{n}{i}\\rfloor$\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u901a\u8fc7\u6574\u9664\u5206\u5757\u4e00\u4e0b\u5c31\u5904\u7406\u6389\u4e86\u3002\n\n$$\nf(n,m)=\\sum_{i=1}^n \\sum_{L=1}^m \\binom{m-1}{L-1}\\times L \\times h(i,L)\n$$\n\n\u5176\u4e2d\u90a3\u4e2a\u7ec4\u5408\u6570\u7cfb\u6570\u662f\u7ecf\u5178\u7684\u76d2\u5b50\u653e\u7403\u95ee\u9898\uff0c\u4e58\u4e0a $L$ \u662f\u56e0\u4e3a\u9898\u76ee\u4e2d\u8981\u6c42\u7684\u7b54\u6848\u91cc\u679a\u4e3e\u4e86 $k$\u3002\n\n\u5982\u4f55\u5feb\u901f\u8ba1\u7b97 $h$ \u5462\uff1f\u8003\u8651\u6c42\u524d\u7f00 $\\gcd$ \u5728\u5bf9\u4e8e\u4e00\u4e2a\u8d28\u6570\u6765\u770b\u662f\u6c42\u5176\u6307\u6570\u7684\u524d\u7f00 $\\min$\uff0c\u4e8e\u662f\u53ef\u4ee5\u60f3\u5230\u5bf9 $x$ \u5148\u552f\u4e00\u5206\u89e3\uff0c$x=\\prod_{i=1}^k p_i^{\\alpha_i}$ \u53ef\u4ee5\u53d1\u73b0 $h$ \u53ea\u8ddf\u8d28\u6570\u5934\u4e0a\u7684\u6307\u6570\u6709\u5173\uff0c\u4e0d\u5982\u76f4\u63a5\u628a\u6307\u6570\u62ff\u4e0b\u6765\u8bb0\u6210\u4e00\u4e2a $k$ \u5143\u7ec4 $P$\u3002\n\n$h(x,L)$ \u5219\u53ef\u4ee5\u5199\u4e3a\u6ee1\u8db3\u4e0b\u5217\u6761\u4ef6\u7684 $c$ \u5e8f\u5217\uff08\u6ce8\u610f $c$ \u5e8f\u5217\u4e2d\u7684\u5143\u7d20\u90fd\u662f\u4ee3\u8868\u4e00\u4e2a $k$ \u5143\u7ec4\uff09\u4e2a\u6570\uff1a\n\n- $c_1=P$\u3002\n\n- $\\forall 2\\le i\\le L$\uff0c$\\forall 1\\le j\\le k$\uff0c$c_{i,j}\\le c_{i-1,j}$\uff0c\u4e14\u6ee1\u8db3 $\\exists 1\\le j\\le k$\uff0c$c_{i,j}\\lt c_{i-1,j}$\u3002\n\n\u6ce8\u610f\u5230\u5982\u679c\u8bf4\u6ca1\u6709 $\\exists 1\\le j\\le k$\uff0c$c_{i,j}\\lt c_{i-1,j}$ \u8fd9\u4e2a\u8981\u6c42\uff0c\u8fd9\u4e2a\u4e1c\u897f\u662f\u975e\u5e38\u597d\u7b97\u7684\uff0c\u56e0\u4e3a\u6bcf\u4e00\u7ef4\u662f\u72ec\u7acb\u7684\u3002\n\n\u4e0d\u5982\u8003\u8651\u5bb9\u65a5\uff0c\u8bbe $h_2(x,L)$ \u8868\u793a\u53ea\u6ee1\u8db3 $c_1=P$\uff0c$\\forall 2\\le i\\le L$\uff0c$\\forall 1\\le j\\le k$\uff0c$c_{i,j}\\le c_{i-1,j}$ \u8fd9\u4e24\u4e2a\u6761\u4ef6\u7684 $c$ \u5e8f\u5217\u4e2a\u6570\u3002\n\n\u53ef\u4ee5\u53d1\u73b0 $h_2$ \u4e0e $h$ \u7684\u5982\u4e0b\u5173\u7cfb\u3002\n\n$$\nh_2(x,L)=\\sum_{i=1}^L h(x,i)\\binom{L-1}{i-1}\n$$\n\n\u90a3\u4e48\u5982\u679c\u53ef\u4ee5\u5feb\u901f\u7b97\u51fa $h_2$ \u5c31\u53ef\u4ee5\u89e3\u51b3\u6389\u8fd9\u4e2a\u95ee\u9898\u4e86\u3002\n\n\u56e0\u4e3a\u6bcf\u4e00\u7ef4\u72ec\u7acb\uff0c\u663e\u7136 $h_2(x,L)$ \u662f\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\uff0c$h_2(x,L)=\\prod_{i=1}^k G(\\alpha_i,L)$\uff0c\u5176\u4e2d $G$ \u53ef\u4ee5\u901a\u8fc7 DP \u6216\u8005\u7ec4\u5408\u6570\u5b66\u9884\u5904\u7406\u51fa\u6765\u3002\n\n\u505a $m$ \u6b21\u9012\u63a8\u7248 min_25 \u5373\u53ef\uff0c\u590d\u6742\u5ea6 $\\mathcal{O}(m\\frac{n^{\\frac{3}{4}}}{\\log n})$\uff0c\u5982\u679c\u5e38\u6570\u5361\u5f97\u597d\u5c31\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898 ~~\uff08\u8fd8\u53ef\u4ee5\u78be\u538b std\uff09~~\u3002\n\n\u6709\u4e0b\u5217\u5361\u5e38\u6280\u5de7\uff1a\n\n- \u4e0d\u8981\u5355\u72ec\u505a $m$ \u6b21 min_25\uff0c\u56e0\u4e3a min_25 \u4e2d\u5b58\u5728\u5927\u91cf\u5411\u4e0b\u6574\u9664\u8fd0\u7b97\u6c42\u7f16\u53f7\uff0c\u975e\u5e38\u7684\u6162\uff0c\u53ef\u4ee5\u5f00\u4e00\u4e2a $m\\times \\sqrt{n}$ \u7684 DP \u6570\u7ec4\uff0c\u5728\u6700\u91cc\u9762\u4e00\u8d77\u8f6c\u79fb\u3002\n\n- DP \u6570\u7ec4\u7684\u7b2c\u4e00\u7ef4\u8981\u5f00\u6210 $\\sqrt{n}$ \u7684\u5927\u5c0f\uff0c\u56e0\u4e3a $L$ \u8fd9\u4e00\u7ef4\u662f\u8fde\u7eed\u8bbf\u95ee\u7684\uff0c\u8fd9\u6837\u5b50\u4f1a\u5feb\u5f88\u591a\u3002\n\n\n\u4f46\u662f\u8fd8\u53ef\u4ee5\u4f18\u5316\uff0c\u6ce8\u610f\u5230 $h_2(p,L)=L$\uff0c\u8003\u8651 Powerful Number\uff0c\u6784\u9020 $g(p^k)=L[k\\le 1]$\uff0c\u7136\u540e\u8981\u8ba1\u7b97 $g$ \u7684\u5757\u7b5b\uff0c\u56e0\u4e3a\u4e0d\u80fd\u518d\u53bb\u679a\u4e3e $L$ \u4e86\uff0c\u6240\u4ee5\u5f97\u53bb\u679a\u4e3e\u4e58\u4e86\u591a\u5c11\u6b21 $L$\uff0c\u53ef\u4ee5\u5f97\u5230\u4e0b\u5217\u67ff\u5b50\uff1a\n\n$$\n\\sum_{i=0} L^i\\sum_{k=1}^n [w(k)=i]\\mu(k)^2\n$$\n\n\u5176\u4e2d $w(n)$ \u8868\u793a $n$ \u7684\u4e0d\u540c\u8d28\u56e0\u5b50\u4e2a\u6570\u3002\n\n\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u52a0\u4e00\u7ef4\u8868\u793a $w$\uff0c\u7136\u540e\u4e00\u904d min_25 \u6c42\u51fa\u6765\uff0c\u52a0\u7684\u90a3\u4e00\u4f4d\u5927\u5c0f\u53ea\u6709 $\\ln \\ln n$\uff0c\u6240\u4ee5\u590d\u6742\u5ea6\u662f $\\mathcal{O}(\\frac{n^{\\frac{3}{4}}\\ln\\ln n}{\\log n})$\u3002\n\n\u5269\u4e0b\u5c31\u5f88\u5957\u8def\u4e86\uff0cPN \u7b5b\u6a21\u677f\u600e\u4e48\u505a\u5c31\u600e\u4e48\u505a\u3002\n\n\u590d\u6742\u5ea6\u53d8\u6210 $\\mathcal{O}(\\frac{n^{\\frac{3}{4}}\\ln\\ln n}{\\log n}+mn^{\\frac{3}{5}})$\u3002",
        "postTime": 1677142716,
        "uid": 154560,
        "name": "Silver187",
        "ccfLevel": 7,
        "title": "\u300cSvR-2\u300dLet's Meet at a Higher Place \u9898\u89e3"
    }
]
[
    {
        "content": "### PS.\n\u770b\u4e86\u4e00\u4e0b\u9898\u89e3\u533a\uff0c\u53d1\u73b0\u5927\u591a\u6570\u9898\u89e3\u90fd\u7528\u6811\u5256\u505a\u7684\uff0c\u4f46\u662f\u6211\u611f\u89c9\u6839\u672c\u4e0d\u7528\u6811\u5256\u554a\u3002\u3002\u3002\u7528LCA\u5c31\u591f\u4e86\u3002  \n\u6b64\u9898\u5176\u5b9e\u6ca1\u6709\u7d2b\u8272\u7684qwq\uff0c\u4e2a\u4eba\u611f\u89c9\u84dd~\u7eff\u5dee\u4e0d\u591a\u4e86\u3002\n\n### Problem.\n\u6709$n$\u5ea7\u57ce\u5e02\u3002  \n\u6709$m$\u4e2a\u65f6\u523b\uff0c\u5728\u7b2c$i$\u4e2a\u65f6\u523b\uff0c\u6240\u6709$m-i+1$\u7684\u500d\u6570\u4e4b\u95f4\u8fde\u8fb9\u3002  \n\u6709$q$\u4e2a\u8be2\u95ee\uff0c\u8be2\u95ee\u7b2c$x_i$\u5ea7\u57ce\u5e02\u548c$y_i$\u5ea7\u57ce\u5e02\u4ec0\u4e48\u65f6\u5019\u8054\u901a\u3002  \n\n### Solution.\n\u611f\u89c9\u8fd9\u9898\u6839\u672c\u4e0d\u7528\u6811\u5256\uff0c\u800c\u4e14\u4e00\u822cdfs\u4e5f\u5c31\u80fd\u641e\u5b9a\u4e86\u3002  \n\u4f46\u662f\u770b\u9898\u89e3\u533a\uff0c\u57fa\u672c\u4e0a\u5168\u90fd\u7528\u6811\u5256\u7684\u3002  \n\u6240\u4ee5\u8d21\u732e\u4e00\u53d1LCA\u7684\u9898\u89e3\u3002  \n\n\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5982\u4f55\u628a\u8fd9\u68f5\u6811\u5efa\u51fa\u6765\u3002  \n\u6bcf\u4e00\u4e2a\u65f6\u523b\uff0c**\u663e\u7136**\u53ef\u4ee5\u76f4\u63a5\u8003\u8651\u7b2c$m-i+1$\u5ea7\u57ce\u5e02\u548c\u6240\u6709$m-i+1$\u7684\u500d\u6570\u8fde\u8fb9\u3002  \n\u8fd9\u4e24\u5f20\u56fe\u662f\u7b49\u4ef7\u7684\u3002\uff08\u5728\u53ea\u9700\u8981\u5224\u65ad\u8054\u901a\u6027\u7684\u60c5\u51b5\u4e0b  \n\u90a3\u4e48\u5c31\u53ef\u4ee5\u76f4\u63a5\u8fd9\u6837\u66b4\u529b\u679a\u4e3e\uff0c\u7136\u540e\u7528\u4e00\u4e2a\u5e76\u67e5\u96c6\u8bb0\u5f55\u4e24\u4e2a\u70b9\u662f\u5426\u5728\u540c\u4e00\u4e2a\u96c6\u5408\u91cc\u3002  \n\u66b4\u529b\u679a\u4e3e\u7684\u590d\u6742\u5ea6\u662f$\\frac{N}{1}+\\frac{N}{2}+...+\\frac{N}{N}$\u7684\uff0c\u6240\u4ee5\u590d\u6742\u5ea6\u662f$O(N\\times log_N)$\u7684\n\n\u8fd9\u68f5\u6811\u5efa\u51fa\u6765\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u7ed9\u8fd9\u68f5\u6811\u9644\u4e0a\u6743\u503c\u3002  \n\u6bcf\u6761\u8fb9\u7684\u8fb9\u6743\u5c31\u662f\u5f53\u524d\u7684\u65f6\u523b\uff0c\u4ece\u5c0f\u5230\u5927\u52a0\u8fb9\u3002  \n\u7136\u540e\u76f4\u63a5\u67e5\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684\u8def\u5f84\u4e0a\u7684\u74f6\u9888\u5c31\u597d\u4e86\u3002  \n\u8fd9\u4e2a\u8d2a\u5fc3**\u663e\u7136**\u662f\u5bf9\u7684\uff0c\u7b14\u8005\u4e0d\u8bc1\u3002  \n\n\u7136\u540e\uff0c\u8fd9\u68f5\u6811**\u663e\u7136**\u662f\u4e00\u68f5\u65e0\u6839\u6570\u3002  \n\u90a3\u4e48\u5982\u4f55\u8f6c\u5316\u6210\u4e00\u4e2a\u6709\u6839\u6570\u5462\uff1f  \n\u65b9\u6cd5\u5f88\u7b80\u5355\uff0c\u76f4\u63a5\u94a6\u5b9a1\u4e3a\u6839\u5c31\u597d\u4e86\u3002  \n\n\u7136\u540e\u8fd9\u68f5\u6811\u5efa\u51fa\u6765\u4e4b\u540e\uff0c\u63a5\u4e0b\u6765\u4e5f\u6ca1\u6709\u4fee\u6539\u64cd\u4f5c\u3002  \n\u6211\u5c31\u5f88\u60f3\u4e0d\u901a\u4e3a\u4ec0\u4e48\u697c\u4e0a\u697c\u4e0b\u90fd\u8981\u7528\u6811\u5256\u505a\u3002  \n\u8fd9\u4e0d\u662f\u5f88**\u663e\u7136**\u4e00\u4e2alca\u7684\u95ee\u9898\u5417\uff0c\u771f\u662f\u4ee4\u4eba\u8c14\u8c14\u3002  \n\u6211\u76f8\u4fe1\uff0c\u60f3\u6765\u505a\u8fd9\u9898\u7684\u5e94\u8be5\u90fd\u4f1aST\u8868\u6c42LCA\u4e86\u5427\u3002  \n\u7b14\u8005\u5728\u8fd9\u91cc\u4e5f\u5c31\u4e0d\u8d58\u8ff0\u65b9\u6cd5\u4e86\uff0c\u5982\u679c\u4e0d\u61c2\u53ef\u4ee5\u770b\u4ee3\u7801\u6ce8\u91ca\u3002  \n\n\u7b14\u8005\u4e0d\u624d\uff0c\u500d\u589e\u7528\u7684st\u8868\uff0c\u538b\u884c\u5728\u8fd9\u4e00\u884c\u4ee3\u7801\u4e2d\u4e5f\u6ca1\u6709\u5f88\u4f53\u73b0\u3002  \n\u5b8c\u7ed3\u6492\u82b1\uff0c\u65e0\u803b\u6c42\u8d5e\u3002  \n\n### Coding.\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nstruct edge{int to,wei,nxt;}e[200005];//\u8fb9\u7684\u7ed3\u6784\u4f53\nint n,m,q,tot,head[100005],fa[100005],dep[100005],f[100005][35],dis[100005][35];\ninline int getf(int x) {return fa[x]==x?x:fa[x]=getf(fa[x]);}//\u5e76\u67e5\u96c6\u627e\u7236\u4eb2\ninline void adde(int x,int y,int w) {e[++tot]=(edge){y,w,head[x]},head[x]=tot;}//\u52a0\u8fb9\ninline void ready() {for(int i=m;i>=1;i--) for(int j=i+i,u=getf(i),v=getf(j);j<=n;j+=i,u=getf(i),v=getf(j)) if(u!=v) fa[u]=v,adde(i,j,m-i+1),adde(j,i,m-i+1);}//\u5efa\u6811\uff0c\u76f4\u63a5\u66b4\u529b\u679a\u4e3e\ninline void dfs(int x,int fa=0,int val=0)\n{//\u6c42\u51fa\u500d\u589e\u6570\u7ec4\uff0c\u7531\u4e8e\u8fd9\u9898\u662f\u8fb9\u6743\uff0c\u6240\u4ee5\u8fd8\u9700\u8981\u4e00\u4e2aval\u8868\u793a\u4e4b\u524d\u7684\u8fb9\u3002\n\tf[x][0]=fa,dis[x][0]=val,dep[x]=dep[fa]+1;//f\u662ffather\uff0cdis\u662f\u5411\u4e0a\u8df3\u7684\u6700\u5c0f\u503c\uff0cdep\u662f\u6df1\u5ea6\n\tfor(int i=1;(1<<i)<=dep[x];i++) f[x][i]=f[f[x][i-1]][i-1],dis[x][i]=max(dis[x][i-1],dis[f[x][i-1]][i-1]);//\u500d\u589e\u5904\u7406\n\tfor(int i=head[x];i;i=e[i].nxt) if(e[i].to!=fa) dfs(e[i].to,x,e[i].wei);//\u7ee7\u7eeddfs\n}\ninline int lca(int x,int y)\n{//\u6c42x\u5230y\u7684\u8ddd\u79bb\uff0clca\u6a21\u677f\n\tint ans=0;if(dep[x]<dep[y]) swap(x,y);\n\tfor(int i=25;i>=0;i--) if(dep[x]-(1<<i)>=dep[y]) ans=max(ans,dis[x][i]),x=f[x][i];\n\tif(x==y) return ans;\n\tfor(int i=25;i>=0;i--) if(f[x][i]!=f[y][i]) ans=max(ans,max(dis[x][i],dis[y][i])),x=f[x][i],y=f[y][i];\n\treturn max(ans,max(dis[x][0],dis[y][0]));\n}\nint main()\n{\n\tfor(int i=1;i<=100000;i++) fa[i]=i;//\u5e76\u67e5\u96c6\u521d\u59cb\u5316\n\tscanf(\"%d%d%d\",&n,&m,&q),dep[0]=0,memset(dis,0x3f,sizeof(dis)),ready(),dfs(1);//\u4e00\u5927\u5806\u521d\u59cb\u5316\n\tfor(int x,y;q--;) scanf(\"%d%d\",&x,&y),printf(\"%d\\n\",lca(x,y));//\u5904\u7406\u8be2\u95ee\n\treturn 0;//\u5b8c\u7ed3\u6492\u82b1\n}\n```",
        "postTime": 1582636189,
        "uid": 44805,
        "name": "Leap_Frog",
        "ccfLevel": 7,
        "title": "P4616[COCI2017-2018#5]Pictionary\uff08\u9898\u89e3\uff09"
    },
    {
        "content": "\u9898\u610f\uff1a$n$\u4e2a\u70b9\uff0c\u4e00\u5f00\u59cb\u6ca1\u6709\u8fb9\uff0c\u7b2c$i$\u5929\u5728$gcd(a,b)=m-i+1$\u7684\u4e24\u70b9\u4e4b\u95f4\u8fde\u8fb9\uff0c\u5171$m$\u5929\u3002\u591a\u7ec4\u8be2\u95ee$x,y$\u6700\u65e9\u5728\u7b2c\u51e0\u5929\u8fde\u901a\n\n\n\n------------\n\n\u53d1\u73b0\u7b2c$i$\u5929\u53ea\u9700\u4ece$m-i+1$\u5411\u5b83\u7684\u500d\u6570\u8fde\u8fb9\n\n\u8fd9\u6837\u4e24\u4e2a\u4ee5$m-i+1$\u4e3a$gcd$\u7684\u70b9\u4e5f\u4f1a\u76f8\u8fde\n\n\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\uff0c\u518d\u5efa\u7acb\u91cd\u6784\u6811\uff0c\u6bcf\u6b21\u8be2\u95ee\u627e\u5230\u91cd\u6784\u6811\u4e0a\u7684\u74f6\u9888\u5373\u53ef\n\n~~\u6bd4\u8f83\u88f8\u7684\u9898\u4f46\u4e3a\u4ec0\u4e48\u5c31\u662f\u60f3\u4e0d\u51fa\u6765\uff01\uff01\uff01~~\n\n\u5982\u679c\u4f60\u5728$2018.11.10$\u4e4b\u524d\u770b\u5230\u4e86\u8fd9\u7bc7\u9898\u89e3\n\n\u795d$NOIP2018$\u3000$rp++$\n\n```\n#include<cstdio>\n#include<cstring>\n#include<cctype>\n#include<algorithm>\n#define reg register\nusing namespace std;\nconst int N=2e5+5;\nstruct node\n{\n\tint to,nxt;\n}edge[N*20];\nint n,m,num,head[N],cnt,f[N],tot[N],dep[N];\nint tim,idx[N],top[N],fa[N],son[N],w[N];\ninline int read()\n{\n\tint x=0,w=1;\n\tchar c=getchar();\n\twhile (!isdigit(c)&&c!='-') c=getchar();\n\tif (c=='-') c=getchar(),w=-1;\n\twhile (isdigit(c))\n\t{\n\t\tx=(x<<1)+(x<<3)+c-'0';\n\t\tc=getchar();\n\t}\n\treturn x*w;\n}\ninline void add_edge(int from,int to)\n{\n\tedge[++num]=(node){to,head[from]}; head[from]=num;\n\tedge[++num]=(node){from,head[to]}; head[to]=num;\n}\nint find(int x){return f[x]==x?x:f[x]=find(f[x]);}\nvoid dfs(int k,int father,int deep)\n{\n\tint bigson=0;\n\tfa[k]=father; dep[k]=deep; tot[k]=1;\n\tfor (reg int i=head[k];i;i=edge[i].nxt)\n\t{\n\t\tint v=edge[i].to;\n\t\tif (v==father) continue;\n\t\tdfs(v,k,deep+1); tot[k]+=tot[v];\n\t\tif (bigson<tot[v]) bigson=tot[v],son[k]=v;\n\t}\n}\nvoid dfs(int k,int tp)\n{\n\tidx[k]=++tim; top[k]=tp;\n\tif (!son[k]) return; dfs(son[k],tp);\n\tfor (reg int i=head[k];i;i=edge[i].nxt)\n\t{\n\t\tint v=edge[i].to;\n\t\tif (!idx[v]) dfs(v,v);\n\t}\n}\ninline int getlca(int x,int y)\n{\n\twhile (top[x]!=top[y])\n\t{\n\t\tif (dep[top[x]]<dep[top[y]]) swap(x,y);\n\t\tx=fa[top[x]];\n\t}\n\treturn dep[x]<dep[y]?x:y;\n}\nint main()\n{\n\tn=cnt=read(),m=read();\n\tfor (reg int i=1;i<=(n<<1);i++) f[i]=i;\n\tfor (reg int i=m;i;i--)\n\t{\n\t\tfor (reg int j=(i<<1);j<=n;j+=i)\n\t\t{\n\t\t\tint u=find(i),v=find(j);\n\t\t\tif (u==v) continue;\n\t\t\tw[f[u]=f[v]=++cnt]=m-i+1;\n\t\t\tadd_edge(u,cnt); add_edge(v,cnt);\n\t\t}\n\t}\n\tdfs(cnt,0,1); dfs(cnt,cnt);\n\tfor (reg int T=read();T;T--) printf(\"%d\\n\",w[getlca(read(),read())]);\n\treturn 0;\n}\n```",
        "postTime": 1541485545,
        "uid": 43471,
        "name": "Captain_Paul",
        "ccfLevel": 0,
        "title": "P4616 [COCI2017-2018#5] Pictionary"
    },
    {
        "content": "\u6bcf\u4e00\u4e2a\u65f6\u523b\uff0c\u9898\u76ee\u8981\u6c42\u6211\u4eec\u628a $\\gcd(a,b)=m-i+1$ \u7684 $a$ \u4e0e $b$ \u4e4b\u95f4\u8fde\u8fb9\uff0c\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u628a $m-i+1$ \u4e0e\u5b83\u7684\u500d\u6570\u8fde\u8fb9\u3002\u4e0d\u96be\u53d1\u73b0\uff0c\u5728\u53ea\u8003\u8651\u8fde\u901a\u6027\u7684\u60c5\u51b5\u4e0b\u4e24\u5f20\u56fe\u7b49\u4ef7\u3002\n\n\u7ed9\u7b2c $i$ \u5929\u8fde\u7684\u8fb9\u8d4b\u6743\u503c $i$\uff0c\u9898\u76ee\u8f6c\u6362\u6210\u67e5\u8be2\u4e24\u70b9 $x,y$\uff0c\u627e\u5230\u56fe\u4e0a\u4e00\u6761\u4e24\u70b9\u4e4b\u95f4\u7684\u8def\u5f84\u4f7f\u5f97\u8def\u5f84\u4e0a\u7684\u6700\u5927\u503c\u6700\u5c0f\u3002\n\n\u7a0d\u5fae\u4e00\u60f3\uff0c\u8fd9\u4e0d\u5c31\u662f [P1967 [NOIP2013 \u63d0\u9ad8\u7ec4] \u8d27\u8f66\u8fd0\u8f93](https://www.luogu.com.cn/problem/P1967) \u5417\uff1f\uff08\u5f88\u597d\u5947\u4e3a\u4ec0\u4e48\u9898\u89e3\u91cc\u6ca1\u6709\u4eba\u63d0\u51fa\u8fd9\u4e00\u70b9\uff09\u4e00\u4e2a\u5c0f\u533a\u522b\u5c31\u662f\u8fd9\u4e24\u4e2a\u9898\u76ee\u4e00\u4e2a\u662f\u6700\u5927\u503c\u6700\u5c0f\uff0c\u4e00\u4e2a\u662f\u6700\u5c0f\u503c\u6700\u5927\u3002\n\n\u539f\u9898\u505a\u6cd5\u662f\u7528 kruskal \u5148\u6c42\u51fa\u6700\u5927\uff08\u8fd9\u9898\u91cc\u662f\u6700\u5c0f\uff09\u751f\u6210\u6811\uff0c\u7136\u540e\u518d\u6811\u4e0a\u500d\u589e\u7c7b\u4f3c LCA \u5730\u7ef4\u62a4\u6700\u503c\u3002\u5728\u672c\u9898\u4e2d\u540c\u6837\u9002\u7528\u4e5f\u53ef\u4ee5\u901a\u8fc7\u3002\u6ce8\u610f\u5230\u672c\u9898\u8fde\u8fb9\u7684\u8fc7\u7a0b\u5df2\u7ecf\u6392\u597d\u5e8f\uff0c\u6240\u4ee5\u7701\u53bb\u4e86 kruskal \u7684\u6392\u5e8f\u8fc7\u7a0b\u3002\n\n\u4e0e [P1967 [NOIP2013 \u63d0\u9ad8\u7ec4] \u8d27\u8f66\u8fd0\u8f93](https://www.luogu.com.cn/problem/P1967) \u957f\u5f97\u51e0\u4e4e\u4e00\u6837\u7684\u4ee3\u7801\uff0c\u4ec5\u4f9b\u53c2\u8003\uff1a\n\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint n,m,p;\nconst int N=200005;\nint fax[N];\n\nstruct edge\n{\n\tint x,y,z;\n}e[N*52];\nint find(int x)\n{\n\tif (fax[x]==x) return x;\n\treturn fax[x]=find(fax[x]);\n}\nint h[N],nxt[N],v[N],t[N],cnt;\nint fa[N][22],w[N][22],deth[N],used[N];\nvoid add(int x,int y,int z)\n{\n\tt[++cnt]=y;\n\tv[cnt]=z;\n\tnxt[cnt]=h[x];\n\th[x]=cnt;\n}\nvoid dfs(int x,int f)\n{\n\tfa[x][0]=f,used[x]=1;\n\tfor (int i=1;i<=20;i++)\n\t{\n\t\tfa[x][i]=fa[fa[x][i-1]][i-1];\n\t\tw[x][i]=max(w[x][i-1],w[fa[x][i-1]][i-1]);\n\t}\n\tfor (int i=h[x];i;i=nxt[i])\n\t{\n\t\tif (t[i]!=f) \n\t\t{\n\t\t\tw[t[i]][0]=v[i];\n\t\t\tdeth[t[i]]=deth[x]+1;\n\t\t\tdfs(t[i],x);\n\t\t}\n\t}\n}\nint LCA(int x,int y)\n{\n\tif (find(x)!=find(y)) return -1;\n\tif (deth[x]<deth[y]) swap(x,y);\n\tint res=0;\n\tfor (int i=20;i>=0;i--) \n\t{\n\t\tif (deth[fa[x][i]]>=deth[y]) \n\t\t{\n\t\t\tres=max(res,w[x][i]);\n\t\t\tx=fa[x][i];\n\n\t\t}\n\t}\n    if (x==y) return res;\n    for (int i=20;i>=0;i--)\n    {\n    \tif (fa[x][i]!=fa[y][i]) \n    \t{\n    \t\tres=max(res,w[x][i]);\n    \t\tres=max(res,w[y][i]);\n    \t\tx=fa[x][i],y=fa[y][i];\n    \t}\n    }\n    res=max(res,max(w[x][0],w[y][0]));\n    return res;\n}\n\ninline int read()\n{\n    int F=1,ANS=0;\n\tchar C=getchar();\n    while (C<'0'||C>'9')\n\t{\n\t\tif (C=='-') F=-1;\n\t\tC=getchar();\n\t}\n    while (C>='0'&&C<='9')\n\t{\n\t\tANS=ANS*10+C-'0';\n\t\tC=getchar();\n\t}\n    return F*ANS;\n}\nint main()\n{\n\tn=read(),p=read();\n\tfor (int i=1;i<=n;i++) fax[i]=i;\n\tfor (int i=p;i>=1;i--)\n\t{\n\t\tfor (int j=2;i*j<=n;j++)\n\t\t{\n\t\t\t++m;\n\t\t\te[m].x=i,e[m].y=i*j,e[m].z=p-i+1;\n\t\t\tint x1=find(e[m].x),y1=find(e[m].y);\n\t\t\tif (x1==y1) continue;\n\t\t\tfax[x1]=y1;\n\t\t\tadd(e[m].x,e[m].y,e[m].z),add(e[m].y,e[m].x,e[m].z);\n\t\t}\n\t}\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tif (used[i]==0) \n\t\t{\n\t\t\tfa[i][0]=i;\n\t\t\tw[i][0]=0;\n\t\t\tdfs(i,i);\n\t\t}\n\t}\n\tint q=read();\n\twhile (q--)\n\t{\n\t\tint x=read(),y=read();\n\t\tcout << LCA(x,y) << endl;\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1628048184,
        "uid": 151475,
        "name": "Little09",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P4616 [COCI2017-2018#5] Pictionary"
    },
    {
        "content": "\u6ca1\u60f3\u51fa\u6765\u7528\u8fb9\u6743\u8868\u793a\u5929\u6570\u505a\u5230 $\\Theta((n+q)\\log n)$\uff0c\u63d0\u4f9b\u4e00\u4e2a $\\Theta(n\\log^2 n\\times \\alpha(n)+q\\log n\\times\\alpha(n))$ \u7684\u79bb\u7ebf\u505a\u6cd5\u3002\n\n\u9996\u5148\u7ef4\u62a4\u8fde\u901a\u6027\u53ef\u4ee5\u60f3\u5230\u5e76\u67e5\u96c6\u3002\u5bf9\u4e8e\u67d0\u4e2a\u5929\u6570 $i$\uff0c\u8fde\u8fb9 $\\gcd(a,b)=m-i+1$ \u7684\u70b9\uff0c\u5bb9\u6613\u53d1\u73b0\u53ea\u9700\u8981\u8fde $k(m-i+1)\\leftrightarrow (k-1)(m-i+1)$ \u5373\u53ef\u4fdd\u8bc1\u8fde\u901a\u6027\u3002\n\n\u90a3\u4e48\uff0c\u5bf9\u4e8e\u7b2c $i$ \u5929\uff0c\u8fde\u7684\u603b\u8fb9\u6570\u5373\u4e3a $O(\\frac n{m-i+1})$\u3002\u5bf9\u4e8e\u67d0\u4e00\u6bb5\u5929\u6570 $[1,k]$ \u6765\u8bf4\uff0c\u8fde\u7684\u603b\u8fb9\u6570\u4e3a\uff1a\n\n$$\n\\sum_{i=k}^m \\frac{n}{i}\\leq\\sum_{i=1}^n=\\Theta(n\\log n)\n$$\n\n\u5229\u7528\u5e76\u67e5\u96c6\uff0c\u4e00\u8d9f\u8fde\u7eed\u5929\u6570\u7684\u8054\u901a\u6027\u7ef4\u62a4\u53ef\u4ee5\u4fdd\u8bc1\u5728 $\\Theta(n\\log n\\times \\alpha(n))$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\uff0c\u5176\u4e2d $\\alpha(n)$ \u4e3a\u53cd\u963f\u514b\u66fc\u51fd\u6570\u3002\n\n\u7531\u6b64\u53ef\u4ee5\u60f3\u5230\u4e00\u4e2a\u6574\u4f53\u4e8c\u5206\u7684\u505a\u6cd5\uff0c\u5148\u5c06\u8be2\u95ee\u79bb\u7ebf\u4e0b\u6765\u7136\u540e\u6bcf\u4e00\u8d9f\u67e5\u8be2\u6bcf\u4e2a\u8be2\u95ee\u7684\u8fde\u901a\u6027\u3002\u6bcf\u4e00\u8d9f\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\Theta(n\\log n\\times \\alpha(n)+q\\times \\alpha(n))$\uff0c\u603b\u5171\u9700\u8981\u505a $\\Theta(\\log n)$ \u8d9f\uff0c\u6700\u7ec8\u65f6\u95f4\u590d\u6742\u5ea6\u5373\u4e3a $\\Theta(n\\log^2 n\\times \\alpha(n)+q\\log n\\times \\alpha(n))$\u3002\n\n\u6700\u7ec8\u6700\u5927\u7684\u70b9\u7ea6 300ms\u3002\n\n\u9644 AC \u4ee3\u7801\uff1a\n\n```cpp\n#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\nint getint()\n{\n\tchar ch;\n\twhile((ch=getchar()) < '!') ;\n\tint x = ch^'0';\n\twhile((ch=getchar()) > '!') x = (x*10)+(ch^'0');\n\treturn x;\n}\n\nvoid putint(int x)\n{\n\tif(x/10) putint(x/10);\n\tputchar((x%10)^'0');\n}\n\nint st[100005];\nint rnk[100005];\n\nvoid init(int n)\n{\n\tfor(int i=1; i<=n; ++i)\n\t{\n\t\tst[i] = i;\n\t\trnk[i] = 0;\n\t}\n}\n\nint getfa(int x) { return x==st[x] ? x : st[x]=getfa(st[x]); }\n\nvoid unio(int fa,int fb)\n{\n\tif(rnk[fa] == rnk[fb])\n\t{\n\t\tst[fb] = fa;\n\t\t++rnk[fa];\n\t}\n\telse if(rnk[fa] > rnk[fb])\n\t{\n\t\tst[fb] = fa;\n\t}\n\telse\n\t{\n\t\tst[fa] = fb;\n\t}\n}\n\nstruct query\n{\n\tint a,b;\n\tint ansi;\n\tint qury;\n\tint id;\n};\n\nquery qi[100005];\n\nbool pmc(query a,query b) { return a.id < b.id; }\n\nint main()\n{\n\tint n = getint();\n\tint m = getint();\n\tint q = getint();\n\tfor(int i=1; i<=q; ++i)\n\t{\n\t\tqi[i].a = getint();\n\t\tqi[i].b = getint();\n\t}\n\t\n\tint logn = 31-__builtin_clz(n);\n\tfor(int i=1; i<=q; ++i)\n\t{\n\t\tqi[i].qury = 1<<logn;\n\t\tqi[i].id = i;\n\t}\n\tfor(int i=logn-1; i>=-1; --i)\n\t{\n\t\tinit(n);\n\t\tint tim = 1;\n\t\tfor(int j=1; j<=q; ++j)\n\t\t{\n\t\t\tint r = j;\n\t\t\twhile(qi[r+1].qury==qi[j].qury || (qi[j].qury>=m&&qi[r+1].qury>=m)) ++r;\n\t\t\twhile(tim<=qi[j].qury && tim<=m)\n\t\t\t{\n\t\t\t\tint gcd = m-tim+1;\n\t\t\t\tfor(int d=gcd; d<=n-gcd; d+=gcd)\n\t\t\t\t{\n\t\t\t\t\tint fa = getfa(d);\n\t\t\t\t\tint fb = getfa(d+gcd);\n\t\t\t\t\tif(fa != fb) unio(fa,fb);\n\t\t\t\t}\n\t\t\t\t++tim;\n\t\t\t}\n\t\t\tint cr = r;\n\t\t\tfor(int c=j; c<=cr; ++c)\n\t\t\t{\n\t\t\t\tif(getfa(qi[c].a) == getfa(qi[c].b))\n\t\t\t\t{\n\t\t\t\t\tqi[c].ansi = tim-1;\n\t\t\t\t\tqi[c].qury -= 1<<i;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tqi[c].qury += 1<<i;\n\t\t\t\t\tswap(qi[c],qi[cr]);\n\t\t\t\t\t--c; --cr;\n\t\t\t\t}\n\t\t\t}\n\t\t\tj = r;\n\t\t}\n\t}\n\t\n\tsort(qi+1,qi+1+q,pmc);\n\t\n\tfor(int i=1; i<=q; ++i)\n\t{\n\t\tputint(qi[i].ansi);\n\t\tputchar('\\n');\n\t}\n}\n```",
        "postTime": 1601973148,
        "uid": 49458,
        "name": "\u6728\u6728\uff01",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4616 \u3010[COCI2017-2018#5] Pictionary\u3011"
    },
    {
        "content": "\u9898\u76ee\u9700\u8981\u4e00\u79cd\u652f\u6301\u5408\u5e76\u4e00\u4e9b\u70b9\u96c6\u7684\u6570\u636e\u7ed3\u6784\uff0c\u663e\u7136\u662f\u5e76\u67e5\u96c6\uff0c\u6211\u4eec\u8003\u8651\u5bf9\u6bcf\u4e2a\u65f6\u95f4\u90fd\u5408\u5e76\u4e00\u6b21\u70b9\u96c6\uff0c\u663e\u7136\u590d\u6742\u5ea6\u4e3a$O(nlogn)$\n\n\u7136\u540e\u6bcf\u4e2a\u70b9\u8bb0\u5f55\u7684\u662f\u4ed6\u548c\u4ed6\u7236\u4eb2\u5408\u5e76\u65f6\u7684\u65f6\u95f4\u6233\uff0c\u90a3\u4e48\u663e\u7136\uff0c\u5728\u67e5\u8be2\u4e24\u4e2a\u70b9$(x,y)$\u7684\u8054\u901a\u65f6\u95f4\u65f6\uff0c\u5c31\u662f$x$\u5230$lca(x,y)$\u7684\u6700\u5927\u503c\u52a0\u4e0a$lca(x,y)$\u5230$y$\u7684\u6700\u5927\u503c\uff0c\u6ce8\u610f\u4e0d\u80fd\u5305\u542b$lca(x,y)$\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u70b9\u5b58\u50a8\u7684\u65f6\u95f4\u662f\u548c\u53e6\u5916\u4e00\u4e2a\u70b9\u96c6\u7684\u5408\u5e76\u65f6\u95f4\n\n\u7136\u540e\u5f80\u4e0a\u8df3\u5c31\u884c\uff0c\u56e0\u4e3a\u4e0d\u80fd\u8def\u5f84\u538b\u7f29\uff0c\u6211\u4eec\u91c7\u7528\u542f\u53d1\u5f0f\u5408\u5e76\n```cpp\n/*deco loves Chino*/\n#include <bits/stdc++.h>\n#pragma GCC optimize(2)\nusing namespace std;\nint n,m,q;\nint f[100010],siz[100010],t[100010],app[100010],dep[100010],maxn[100010]; \nvector<int> vc[100010];\nint find(int x)\n{\n\tif(x==f[x])\n\t{\n\t\treturn x;\n\t}\n\treturn find(f[x]);\n}\nvoid dfs(int u)\n{\n\tfor(int i=0;i<vc[u].size();i++)\n\t{\n\t\tint v=vc[u][i];\n\t\tdep[v]=dep[u]+1;\n\t\tdfs(v);\n\t}\n}\nint main()\n{\n\t//freopen(\"pictionary.in\",\"r\",stdin);\n\t//freopen(\"pictionary.out\",\"w\",stdout);\n\tcin>>n>>m>>q;\n\tint rt;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tf[i]=i;\n\t\tsiz[i]=0;\n\t}\n\tfor(int i=m;i>=1;i--)\n\t{\n\t\tfor(int j=(i<<1);j<=n;j+=i)\n\t\t{\n\t\t\tint nt=(m-i+1);\n\t\t\tint dx=find(i),dy=find(j);\n\t\t\tif(dx==dy)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(siz[dx]<siz[dy])\n\t\t\t{\n\t\t\t\tswap(dx,dy);\n\t\t\t}\n\t\t\tf[dy]=dx;\n\t\t\tvc[dx].push_back(dy);\n\t\t\trt=dx;\n\t\t\tif(siz[dx]==siz[dy])\n\t\t\t{\n\t\t\t\t++siz[dx];\n\t\t\t}\n\t\t\tt[dy]=nt;\n\t\t}\n\t}\n\tdfs(rt);\n\tfor(int i=1;i<=q;i++)\n\t{\n\t\tint x,y;\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tint ans=0;\n\t\tif(dep[x]<dep[y])\n\t\t{\n\t\t\tswap(x,y);\n\t\t}\n\t\twhile(dep[x]>dep[y])\n\t\t{\n\t\t\tans=max(ans,t[x]);\n\t\t\tx=f[x];\n\t\t}\n\t\twhile(x!=y)\n\t\t{\n\t\t\tans=max(max(t[x],t[y]),ans);\n\t\t\tx=f[x],y=f[y];\n\t\t}\n\t\tcout<<ans<<\"\\n\";\n\t}\n}\n```",
        "postTime": 1572589178,
        "uid": 48265,
        "name": "decoqwq",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4616 \u3010[COCI2017-2018#5] Pictionary\u3011"
    },
    {
        "content": "## \u5199\u5728\u524d\u9762\n\n\u9996\u5148\u795d\u5927\u5bb6CSP rp++\uff01\n\n\u8fd9\u9053\u9898\u672c\u6765\u662f\u60f3\u7ec3\u4e60\u6811\u5256\u6765\uff0c\u7ed3\u679c\u53d1\u73b0\u7528LCA\u505a\u66f4\u7b80\u5355\uff0c\u4e8e\u662f\u53c8\u80fd~~\u6c34\u7d2b\u9898\u4e86~~\n\n## \u6b63\u6587\n\n### \u7b80\u8ff0\u9898\u610f\uff1a\n\n\u8f93\u5165\u4e09\u4e2a\u6574\u6570n, m, q, \u5206\u522b\u8868\u793a\u57ce\u5e02\u6570\u91cf\uff0c\u4fee\u8def\u6301\u7eed\u5929\u6570\uff0c\u8be2\u95ee\u6570\u91cf\n\n\u5bf9\u4e8e\u7b2ci\u5929\uff0c\u82e5gcd(a,b) = m - i +\uff11\uff0c\u5219a \u548cb \u57ce\u5e02\u95f4\u4f1a\u4fee\u4e00\u6761\u8def\n\nq\u4e2a\u8be2\u95ee\uff0c\u6bcf\u6b21\u95eea\uff0cb\u4e24\u4e2a\u57ce\u5e02\u6700\u65e9\u8054\u901a\u7684\u65f6\u95f4\n\n\n------------\n### Solution\n\n\u9898\u76ee\u4e2d\u8bf4gcd(a,b) = m - i +\uff11\u7684\u610f\u601d\u662f\u7b2ci\u5929\u65f6\uff0c\u7f16\u53f7\u4e3am-i+1\u7684\u500d\u6570\u7684\u57ce\u5e02\u4e4b\u95f4\u4f1a\u4fee\u4e00\u6761\u8def\uff08a\uff0cb\u80af\u5b9a\u90fd\u6709m-i+1\u4f5c\u4e3a\u56e0\u5b50\uff09\n\n\u6240\u4ee5\u6211\u4eec\u4ee5\u8fd9\u6761\u4fe1\u606f\u4e3a\u4f9d\u636e\u6765\u5efa\u6811\uff0c\u628a\u65f6\u95f4\u8bbe\u505a\u8fb9\u6743\n\n\u76f4\u63a5\u66b4\u529b\u679a\u4e3e\u6240\u6709\u7b26\u5408\u6761\u4ef6\u7684\u8fb9\uff0c\u590d\u6742\u5ea6\u5728Peal_Frog\u7684\u4e0a\u9898\u89e3\u6709\u8bc1\u660e\n\n\u7528\u5e76\u67e5\u96c6\u6765\u907f\u514d\u51fa\u73b0\u73af\u7684\u60c5\u51b5\n\n\u7136\u540e\u5c31\u662f\u500d\u589e\u6c42LCA\u7684\u677f\u5b50\u4e86\n\n\u867d\u7136\u8fd9\u662f\u68f5\u65e0\u6839\u6811\uff0c\u4f46\u4ee41\u4e3a\u6839\u5c31\u53ef\u4ee5\u5904\u7406\n\n\u9884\u5904\u7406\u51fa\u4e24\u4e2a\u70b9\u7684\u6700\u8fd1\u516c\u5171\u7956\u5148\uff0c\u4ee5\u53ca\u8def\u5f84\u4e0a\u7684\u65f6\u95f4\u6700\u5927\u503c\uff08\u56e0\u4e3a\u53ea\u6709\u6700\u665a\u88ab\u4fee\u7684\u90a3\u6761\u8def\u88ab\u4fee\u4e86\uff0c\u4e24\u4e2a\u57ce\u5e02\u624d\u7b97\u88ab\u8054\u901a\uff09\n\n\u5177\u4f53\u89e3\u91ca\u5728\u4ee3\u7801\u4e2d\n\n### AC code\n\n\n```cpp\n/*\nWork by: Suzt_ilymics\nKnowledge: ??\nTime: O(??)\n*/\n#include<iostream>\n#include<cstdio>\nusing namespace std;\nconst int MAXN = 1e5+5; \nstruct edge{\n\tint to, nxt, w;\n}e[MAXN << 1];\nint head[MAXN], num_edge;\nint n, m, q; \nint fa[MAXN], f[MAXN][20], fm[MAXN][20], dep[MAXN];\nint read(){\n\tint w = 1, s = 0;\n\tchar ch = getchar();\n\twhile(ch < '0' || ch > '9') {if(ch == '-') w = -1; ch = getchar(); }\n\twhile(ch >= '0' && ch <= '9') s = (s << 1) + (s << 3) + ch - '0', ch = getchar();\n\treturn w * s;\n}\n//\u94fe\u5f0f\u524d\u5411\u661f\u5b58\u8fb9 \nvoid add(int from, int to, int w){\n\te[++num_edge].nxt = head[from];\n\te[num_edge].to = to;\n\te[num_edge].w = w;\n\thead[from] = num_edge;\n}\n//\u5e76\u67e5\u96c6\u907f\u514d\u51fa\u73b0\u73af \nint find(int x){return fa[x] == x ? x : fa[x] = find(fa[x]);}\n//\u5efa\u6811 \nvoid init(){\n\tfor(int i = m; i >= 1; --i){//\u6ce8\u610f\u8fd9\u91cc\u662f\u4ece\u5927\u5230\u5c0f\uff0c\u5927\u5bb6\u53ef\u4ee5\u628a\u9898\u610f\u7684\u90a3\u4e2a\u5f0f\u5b50\u5316\u7b80\u5904\u7406 \n\t\tfor(int j = i + i; j <= n; j += i){//\u679a\u4e3e\u6bcf\u4e2a\u7f16\u53f7\u4e3ai\u7684\u500d\u6570\u7684\u70b9 \n\t\t\tint fj = find(j), fi = find(i);\n\t\t\tif(fj != fi)\n\t\t\t\tfa[fj] = fi, add(i, j, m - i + 1), add(j, i, m - i + 1);\n\t\t}\n\t}\n}\n//lca\u9884\u5904\u7406 \nvoid dfs(int x, int fath){\n\tf[x][0] = fath; dep[x] = dep[fath] + 1; \n\tfor(int i = head[x]; i; i = e[i].nxt){\n\t\tint v = e[i].to;\n\t\tif(v == fath) continue;\n\t\tfm[v][0] = e[i].w;\n\t\tdfs(v, x);\n\t}\n}\n//lca\u9884\u5904\u7406\u51fa\u6700\u5927\u503c\u6765 \nvoid init_lca(){\n\tfor(int i = 1; i <= 18; ++i){\n\t\tfor(int j = 1; j <= n; ++j){\n\t\t\tf[j][i] = f[f[j][i - 1]][i - 1];\n\t\t\tfm[j][i] = max(fm[j][i-1], fm[f[j][i-1]][i-1]);\n\t\t}\n\t}\n}\n//\u53d6\u51fax\u548cy\u7684\u6700\u8fd1\u516c\u5171\u7956\u5148 \nint get_lca(int x, int y){\n\tif(dep[x] > dep[y]) swap(x, y);\n\tfor(int i = 18; i >= 0; --i){\n\t\tif(dep[x] <= dep[f[y][i]])\n\t\t\ty = f[y][i];\n\t}\n\tif(x == y) return x;\n\tfor(int i = 18; i >= 0; --i){\n\t\tif(f[x][i] == f[y][i]) continue;\n\t\telse{\n\t\t\tx = f[x][i];\n\t\t\ty = f[y][i];\n\t\t}\n\t}\n\treturn f[x][0];\n}\n//\u6c42\u4ecex\u5230lca\u7684\u6700\u5927\u503c \nint get_max(int x, int y){\n\tint ans = -19000;//\u56e0\u4e3a\u4e24\u4e2a\u70b9\u90fd\u662f\u5f80\u5b83\u4eec\u7684lca\u4e0a\u8df3\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u524d\u9762\u90a3\u4e00\u5757 \n\tfor(int i = 18; i >= 0; --i){\n\t\tif(dep[f[x][i]] < dep[y]) continue;\n\t\telse{\n\t\t\tans = max(ans, fm[x][i]);\n\t\t\tx = f[x][i];\n\t\t}\n\t}\n\treturn ans;\n}\n\nint main()\n{\n\tn = read(), m = read(), q = read();\n\tfor(int i = 1; i <= n; ++i) fa[i] = i;\n\tinit(); \n\tdfs(1, 1);\n\tinit_lca();\n\tfor(int i = 1, u, v; i <= q; ++i){\n\t\tu = read(), v = read();\n\t\tint lca = get_lca(u, v);\n\t\tint maxu = get_max(u, lca);\n\t\tint maxv = get_max(v, lca);\n\t\tprintf(\"%d\\n\", max(maxu, maxv));//\u6109\u5feb\u7684\u8f93\u51fa\u7b54\u6848 \n\t}\n\treturn 0;//\u5b8c\u7f8e\u7ed3\u675f \n}\n\n```\n\n",
        "postTime": 1604149828,
        "uid": 230580,
        "name": "Suzt_ilymtics",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4616 \u3010[COCI2017-2018#5] Pictionary\u3011"
    },
    {
        "content": "\n\n## $ \\texttt{Introduction} $\n\n\u539f\u9898+\u601d\u7ef4\n\n## $ \\texttt{Solution} $ \n\n\u672c\u9898\u9898\u610f\u53ef\u4ee5\u7b80\u5316\u4e3a $ i $ \u548c $ j $ \u4e4b\u95f4\u8fde\u4e00\u6761 $ m-\\gcd(i,j)+1 $ \u7684\u8fb9\uff0c\u7136\u540e\u95ee\u4f60\u4ece $ a $ \u8d70\u5230 $ b $ \u7684\u9053\u8def\u4e2d\u7684\u6700\u5927\u503c\u7684\u6700\u5c0f\u503c\u662f\u591a\u5c11\u3002\n\n\u7b80\u5316\u4e4b\u540e\u7684\u95ee\u9898\uff0c\u96be\u5ea6\u5c31\u5728\u4e8e\u5efa\u8fb9\u4e86\uff0c\u9996\u5148\u80af\u5b9a\u4e0d\u80fd\u5efa\u51fa\u4e00\u5f20\u5355\u7eaf\u7684\u56fe\uff0c\u6211\u4eec\u53d1\u73b0\u7b54\u6848\u8981\u5c3d\u91cf\u7684\u5c0f\uff0c\u6240\u4ee5\u6211\u4eec\u6309\u4ef7\u503c\u4ece\u5c0f\u5230\u5927\u52a0\u8fb9\uff0c\u5982\u679c\u4e24\u4e2a\u70b9\u5df2\u7ecf\u76f8\u8fde\uff0c\u90a3\u4e48\u4fbf\u4e0d\u7528\u518d\u8fde\uff0c\u6700\u540e\u6211\u4eec\u4f1a\u5f97\u51fa\u4e00\u68f5\u6811\u3002\n\n\u4f46\u5927\u4f53\u7684\u601d\u8def\u600e\u4e48\u5177\u4f53\u5b9e\u73b0\u5462?\n\n\u9996\u5148\u6709\u4e00\u4e2a\u5f88 $ naive $ \u7684\u60f3\u6cd5\uff0c\u6211\u4eec\u4ece\u5927\u5230\u5c0f\u679a\u4e3e\u6700\u5927\u516c\u7ea6\u6570\uff0c\u7136\u540e\u627e\u5230\u6700\u5927\u516c\u7ea6\u6570\u4e3a\u8fd9\u4e2a\u6570\u7684\u4e24\u4e2a\u70b9\uff0c\u6309\u7167\u4e0a\u8ff0\u7684\u65b9\u6cd5\u8fde\u8fb9\uff0c\u4f46\u662f\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6\u4f1a\u7206\u70b8\uff0c\u4eb2\u6d4b\u53ea\u6709 $ 32pts $,\u90a3\u600e\u4e48\u529e\u5462\uff1f\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u9009\u53d6\u7684\u4e24\u4e2a\u6570\u4e00\u5b9a\u90fd\u662f\u6700\u5927\u516c\u7ea6\u6570\u7684\u500d\u6570\uff0c\u90a3\u4e48\u6211\u4eec\u76f4\u63a5\u5c06\u6700\u5927\u516c\u7ea6\u6570\u548c\u4ed6\u7684\u500d\u6570\u8fde\u8fb9\uff0c\u8fd9\u6837\u5c31\u628a\u6700\u5927\u516c\u7ea6\u6570\u662f\u8fd9\u4e2a\u6570\u7684\u60c5\u51b5\u7684\u8fb9\u90fd\u8fde\u597d\u4e86\uff0c\u4e5f\u8bb8\u4f60\u8981\u95ee\u90a3\u5982\u679c\u4f1a\u8fde\u591a\u4f59\u7684\u8fb9\u5462\uff0c\u5176\u5b9e\u4e0d\u4f1a\u56e0\u4e3a\u6211\u4eec\u662f\u8981\u5224\u65ad\u8fc7\u5f97\uff0c\u5982\u679c\u6700\u5927\u516c\u7ea6\u6570\u6bd4\u8fd9\u4e2a\u6570\u8981\u5927\uff0c\u90a3\u4e48\u524d\u9762\u4e00\u5b9a\u5df2\u7ecf\u8fde\u8fc7\u8fb9\uff0c\u5c31\u4e0d\u4f1a\u518d\u8fde\u4e86\u3002\n\n\u5efa\u597d\u8fd9\u68f5\u6811\u4e4b\u540e\u5c31\u662f\u7ecf\u5178\u64cd\u4f5c\u4e86\uff0c\u6211\u4eec\u8981\u627e\u4e24\u70b9\u4e4b\u95f4\u7684\u8fb9\u7684\u6700\u5927\u503c\uff0c\u53ef\u4ee5\u7528\u500d\u589e\u5b9e\u73b0\uff0c\u5177\u4f53\u53ef\u4ee5\u53c2\u8003[[NOIP2013 \u63d0\u9ad8\u7ec4] \u8d27\u8f66\u8fd0\u8f93](https://www.luogu.com.cn/problem/P1967)\uff0c\u7136\u540e\u8fd9\u9053\u9898\u5c31\u505a\u597d\u4e86\u3002\n\n```c++\nint find(int x)\n{\n\tif (ff[x]==x) return ff[x];\n\tff[x]=find(ff[x]);return ff[x];\n}\nvoid add(int x,int y,int z)\n{\n\tcnt++;a[cnt]=y;b[cnt]=d[x];c[cnt]=z;d[x]=cnt;\n}\nvoid sc(int x,int y) //\u627e\u4e24\u70b9\u4e4b\u95f4\u6700\u5927\u8fb9\n{\n    int t,i;\n    if (e[x]>e[y]){\n        t=x;x=y;y=t;\n    }\nfor (i=lg[n];i>=0;i--)\n     if (e[f[y][i]]>=e[x])\n          {\n              ans=max(ans,u[y][i]);\n              y=f[y][i];\n          }\n    if (x==y) return ;\n    for (i=lg[n];i>=0;i--)\n         if (f[x][i]!=f[y][i])\n              {\n                  ans=max(ans,max(u[x][i],u[y][i]));\n                  x=f[x][i];y=f[y][i];\n              }\n    ans=max(ans,max(u[x][0],u[y][0]));\n}\nint main()\n{\n\t//ios::sync_with_stdio(0);cin.tie();cout.tie();\n\tn=read();m=read();T=read();\n\tfor (i=1;i<=n;i++) ff[i]=i;\n\tfor (i=m;i>=1;i--)\n\t     {\n\t     \tfor (j=2;j<=n/i;j++)\n\t     \t              {\n\t     \t              \tx=i;y=i*j;\n\t     \t              \tr1=find(x);r2=find(y);\n\t     \t              \tif (r1!=r2)\n\t     \t              \t    {\n\t     \t              \t    \tadd(x,y,m-i+1);add(y,x,m-i+1);\n\t     \t              \t    \ttot++;\n\t\t\t\t\t\t\t\t   }\n\t\t\t\t\t\t\tff[r1]=r2;\n\t\t\t\t\t\t\tif (tot==n-1) break;\n\t\t\t\t\t\t   }\n\t\t\tif (tot==n-1) break;\n\t}//\u5efa\u56fe\n\tfor (i=2;i<=n;i++) lg[i]=lg[i>>1]+1;\n    t=1;w=1;f2[1]=1;e[1]=1;\n    while (t<=w)\n        {\n            for (i=d[f2[t]];i;i=b[i])\n                 {\n                     if (e[a[i]]==0)\n                          {\n                              e[a[i]]=e[f2[t]]+1;\n                              f[a[i]][0]=f2[t];u[a[i]][0]=c[i];\n                              for (j=1;j<=lg[n];j++)\n                                  {\n                                  f[a[i]][j]=f[f[a[i]][j-1]][j-1];\n                                  u[a[i]][j]=max(u[a[i]][j-1],u[f[a[i]][j-1]][j-1]);\n                                  }\n                            w++;f2[w]=a[i];\n                            \n                          }\n                 }\n            t++;\n        }//\u500d\u589e\u7684\u9884\u5904\u7406\n    for (;T;T--)\n          {\n          \tx=read();y=read();ans=0;\n          \tsc(x,y);\n          \tprintf(\"%d\\n\",ans);\n\t\t  }\n    return 0;\n}\n\n```\n\n",
        "postTime": 1630990736,
        "uid": 77615,
        "name": "OIerAlbedo",
        "ccfLevel": 0,
        "title": "P4616 [COCI2017-2018#5] Pictionary"
    },
    {
        "content": "[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4616)\n## \u9898\u76ee\u5927\u610f\n\u7ed9\u5b9a $n$ \u4e2a\u70b9\uff0c\u7b2c $i$ \u6b21\u4f1a\u628a\u6240\u6709\u7f16\u53f7\u6ee1\u8db3 $\\gcd(a,b)=m-i+1$ \u7684\u70b9\u5bf9\u8fde\u8fb9\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee $a,b$\uff0c\u6c42\u70b9 $a$ \u548c\u70b9 $b$ \u4ec0\u4e48\u65f6\u5019\u8054\u901a\u3002\n\n## Solution\n\u8111\u6d1e\u4e0d\u591f\uff0c\u5957\u8def\u4e0d\u591f\u3002\u5176\u5b9e\u60f3\u901a\u4e86\u8fd8\u662f\u86ee\u7b80\u5355\u7684\u3002\n\n\u9996\u5148\u6211\u4eec\u8003\u8651\u628a\u8fde\u8fb9\u8f6c\u5316\u4e00\u4e0b\u3002\u5982\u679c $\\gcd(a,b)=k$\uff0c\u90a3\u4e48\u663e\u7136 $a$ \u548c $b$ \u90fd\u662f $k$ \u7684\u500d\u6570\u3002\u800c\u6bcf\u4e00\u6b21\u628a $\\gcd(a,b)=k$ \u7684\u6240\u6709\u70b9\u8fde\u8fb9\uff0c\u6700\u540e\u7684\u8fde\u901a\u6027\u4e0e\u628a\u6240\u6709\u7684 $k$ \u7684\u500d\u6570\u662f\u4e00\u6837\u4e00\u6837\u7684\u3002\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u8bf4\uff0c\u7b2c $i$ \u6b21\u628a\u6240\u6709\u7f16\u53f7\u4e3a $m-i+1$ \u7684\u500d\u6570\u7684\u70b9\u4e4b\u95f4\u8fde\u8fb9\u3002\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u6211\u4eec\u628a\u6bcf\u6b21\u52a0\u7684\u8fb9\u7f16\u53f7\u7684\u8bdd\uff0c\u90a3\u4e48\u4e24\u4e2a\u70b9\u4e4b\u95f4\u6700\u65e9\u7684\u8054\u901a\u65f6\u95f4\u662f\u8def\u5f84\u4e0a\u7684\u6700\u5927\u503c\u3002\u56e0\u6b64\u5c31\u8f6c\u5316\u4e3a\u6c42\u4e24\u70b9\u95f4\u6240\u6709\u8def\u5f84\u4e0a\u7684\u6700\u5927\u503c\u6700\u5c0f\u662f\u591a\u5c11\u3002\n\n\u4e8e\u662f\u81ea\u7136\u8054\u60f3\u5230 [\u8d27\u8f66\u8fd0\u8f93](https://www.luogu.com.cn/problem/P1967) \u8fd9\u9898\u3002\u8003\u8651\u6bcf\u6b21\u6309\u5e8f\u52a0\u8fb9\uff0c\u540c\u65f6\u7ef4\u62a4\u662f\u4e00\u9897\u6811\u3002\u5f53\u7136\u53ef\u4ee5\u9009\u62e9\u514b\u9c81\u65af\u5361\u5c14\u91cd\u6784\u6811\uff0c\u6216\u8005\u76f4\u63a5\u6700\u5c0f\u751f\u6210\u6811\u90fd\u662f\u53ef\u4ee5\u7684\uff0c\u6211\u4ee3\u7801\u4e2d\u7ed9\u51fa\u514b\u9c81\u65af\u5361\u5c14\u91cd\u6784\u6811\u7684\u5199\u6cd5\u3002\n\n\u8fd8\u6709\u4e00\u4e2a\u5c31\u662f\u8def\u5f84\u6700\u503c\uff0c\u53ef\u4ee5\u500d\u589e\u7ef4\u62a4\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u7528\u6811\u5256\uff08\u4e0d\u5199\u6302\u7684\u8bdd\uff09\uff0c\u6211\u4ee3\u7801\u4e2d\u7ed9\u51fa\u7684\u662f\u500d\u589e\u3002\n\n## Code\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define inf (1<<30)\n#define INF (1ll<<60)\nusing namespace std;\nconst int MAXN=2e5+10;\nint f[MAXN],val[MAXN];\nint find(int x){return f[x]==x?x:f[x]=find(f[x]);}\nvector<int> e[MAXN];\nint fa[MAXN][20],dp[MAXN][20],dep[MAXN];\nvoid dfs(int x,int fat){\n\tfa[x][0]=fat;dp[x][0]=val[fat];\n\tfor(int i=1;i<20;i++)\n\t\tfa[x][i]=fa[fa[x][i-1]][i-1];\n\tfor(int i=1;i<20;i++)\n\t\tdp[x][i]=max(dp[x][i-1],dp[fa[x][i-1]][i-1]);//\u8868\u793a\u4ece x \u5f00\u59cb\u5411\u4e0a 2^i \u683c\u5185\u7684\u6700\u5927\u503c\n\tfor(int i=0;i<e[x].size();i++){\n\t\tint s=e[x][i];if(s==fat) continue;\n\t\tdep[s]=dep[x]+1;dfs(s,x);\n\t}\n}\nint LCA(int x,int y){\n\tif(dep[x]<dep[y]) swap(x,y);\n\tint dlt=dep[x]-dep[y];\n\tfor(int i=0;i<20;i++)\n\t\tif(dlt&(1<<i))\n\t\t\tx=fa[x][i];\n\tif(x==y) return x;\n\tfor(int i=19;i>=0;i--)\n\t\tif(fa[x][i]!=fa[y][i])\n\t\t\tx=fa[x][i],y=fa[y][i];\n\treturn fa[x][0];\n}//\u500d\u589e\u6c42 LCA\nint main()\n{\n\tint n,m,Q;\n\tscanf(\"%d%d%d\",&n,&m,&Q);\n\tint cnt=n;\n\tfor(int i=1;i<=n*2;i++)\n\t\tf[i]=i;\n\tfor(int i=1;i<=m;i++){\n\t\tint dis=m-i+1;\n\t\tfor(int j=dis;j+dis<=n;j+=dis){\n\t\t\tint u=find(j),v=find(j+dis);\n\t\t\tif(u==v) continue;\n\t\t\tval[++cnt]=i;\n\t\t\tf[u]=f[v]=cnt;\n\t\t\te[cnt].push_back(u);\n\t\t\te[cnt].push_back(v);\n\t\t}\n\t}\n   //\u5176\u5b9e\u597d\u50cf\u662f\u4e0d\u7528\u514b\u9c81\u65af\u5361\u5c14\u91cd\u6784\u6811\u66f4\u52a0\u7b80\u6d01\u2026\u2026\n   //\u4e0d\u8fc7\u4e5f\u597d\u987a\u4fbf\u590d\u4e60\u4e00\u4e0b\u79d1\u6280.jpg\n\tdfs(cnt,0);\n\tint x,y;\n\twhile(Q--){\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tint lca=LCA(x,y);\n\t\tint dlt=dep[x]-dep[lca];\n\t\tint ans=0;\n\t\tfor(int i=0;i<19;i++)\n\t\t\tif(dlt&(1<<i))\n\t\t\t\tans=max(ans,dp[x][i]),\n\t\t\t\tx=fa[x][i];\n\t\tdlt=dep[y]-dep[lca];\n\t\tfor(int i=0;i<19;i++)\n\t\t\tif(dlt&(1<<i))\n\t\t\t\tans=max(ans,dp[y][i]),\n\t\t\t\ty=fa[y][i];\n                //\u500d\u589e\u627e\u51fa\u6700\u5927\u503c\n\t\tprintf(\"%d\\n\",ans);\n\t}\n}\n```\n## End",
        "postTime": 1630909880,
        "uid": 292315,
        "name": "ZCETHAN",
        "ccfLevel": 7,
        "title": "[COCI2017-2018#5] Pictionary"
    },
    {
        "content": "\u53d1\u73b0\u73b0\u5728\u505a\u7684\u9898\u522b\u4eba\u90fd\u505a\u8fc7\uff0c\u7b11\u6b7b\u3002\n\n\u6ce8\u610f\u5230\u6709\u8bb8\u591a\u6761\u8fb9\uff0c\u4f46\u662f\u95ee\u9898\u662f\u5224\u6700\u5c11\u7684\u5929\u6570\u8054\u901a\u3002\u5982\u679c\u5c06\u4e00\u6761\u8fb9\u8fb9\u6743\u8bbe\u4e3a\u5176\u4fee\u5efa\u7684\u65e5\u5b50\uff0c\u90a3\u4e48\u95ee\u9898\u8be2\u95ee\u7684\u5c31\u662f $u$ \u5230 $v$ \u7684\u6240\u6709\u8def\u5f84\u4e0a\uff0c\u7ecf\u8fc7\u7684\u6700\u5927\u8fb9\u6743\u6700\u5c0f\u7684\u503c\u3002\n\n\u6ce8\u610f\u5230\u8981\u7b54\u6848\u8d8a\u5c0f\u8d8a\u597d\uff0c\u4e0d\u96be\u60f3\u5230\u5148\u5efa\u66f4\u5c0f\u7684\u8fb9\u66f4\u597d\u3002\u90a3\u4e48\uff0c\u7b2c $i$ \u5929\u8fde\u4e86\u8fd9\u4e48\u591a\u6761\u8fb9\uff0c\u4ee4 $x=m-i+1$\uff0c\u672c\u8d28\u4e0a\u6211\u4eec\u53ea\u662f\u5c06 $x,2x,\\cdots ,\\lfloor \\frac{n}{x} \\rfloor x$ \u8fde\u63a5\u8d77\u6765\u4e86\u3002\u6211\u4eec\u53ef\u4ee5\u8bc1\u660e\u8fd9\u4e9b\u70b9\u4e4b\u95f4\u53ef\u4ee5\u53ea\u7ecf\u8fc7\u8fb9\u6743\u4e3a $x$ \u7684\u8fb9\u3002\uff08\u56e0\u4e3a $\\gcd(kx,(k-1)x) = x$\uff09\n\n\u5173\u4e8e\u66b4\u529b\u5efa\u8fb9\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u6709\u4e00\u4e2a\u7ecf\u5178\u7ed3\u8bba\u662f $\\sum_{i=1}^n \\frac{n}{i} = \\ln n$\uff0c\u6240\u4ee5\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n \\ln n)$\u3002\n\n\u8003\u8651\u5230\u6211\u4eec\u4e4b\u524d\u7684\u6a21\u578b\u8f6c\u6362\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u4e00\u822c\u7684\u56fe\u8fd9\u4e2a\u95ee\u9898\u662f\u4e0d\u597d\u505a\u7684\u3002\u5982\u679c\u653e\u5728\u4e00\u4e9b\u6709\u7279\u6b8a\u6027\u8d28\u7684\u56fe\u4e0a\uff0c\u6216\u8bb8\u53ef\u4ee5\u7b80\u5355\u89e3\u51b3\u3002\u6bd4\u5982\u6811\u3002\n\n\u6ce8\u610f\u5230\u6211\u4eec\u76f4\u63a5\u5efa\u8fb9\u4f1a\u51fa\u73b0\u73af\uff0c\u6211\u4eec\u7528\u5e76\u67e5\u96c6\u907f\u514d\u8fd9\u79cd\u4e8b\u60c5\u53d1\u751f\u5373\u53ef\u3002\n\n\u4e8e\u662f\u5efa\u51fa\u4e00\u68f5\u6811\uff0c\u8be2\u95ee\u7684\u5c31\u662f\u4e24\u70b9\u95f4\u7684\u6700\u5927\u8fb9\u6743\u3002\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u76f4\u63a5\u7528\u500d\u589e\u89e3\u51b3\u3002\u6bcf\u6b21\u8be2\u95ee\u4e24\u70b9\u95f4 LCA\uff0c\u500d\u589e\u5904\u7406 $x$ \u5230 $x$ \u7684 $2^k$ \u7ea7\u7956\u5148\u95f4\u7684\u6700\u5927\u8fb9\u6743\u5373\u53ef\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n \\log n)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nchar buf[1<<21],*p1=buf,*p2=buf;\n#define getchar() (p1==p2 && (p2=(p1=buf)+fread(buf,1,1<<18,stdin),p1==p2)?EOF:*p1++)\nint read()\n{\n\tint x=0;\n\tchar c=getchar();\n\twhile(c<'0' || c>'9')\tc=getchar();\n\twhile(c>='0' && c<='9')\tx=(x<<1)+(x<<3)+(c^'0'),c=getchar();\n\treturn x;\n}\nvoid write(int x)\n{\n\tif(x>9)\twrite(x/10);\n\tputchar(x%10+'0');\n}\nstruct unionFindSet{\n\tint fa[100005];\n\tvoid makeSet(int up){for(int i=0;i<=up;++i)\tfa[i]=i;}\n\tint findSet(int x)\n\t{\n\t\tif(x==fa[x])\treturn x;\n\t\treturn fa[x]=findSet(fa[x]);\n\t}\n\tbool unionSet(int x,int y)\n\t{\n\t\tint xx=findSet(x),yy=findSet(y);\n\t\tif(xx==yy)\treturn false;\n\t\treturn fa[yy]=xx,true;\n\t}\n}ufs;\nstruct Edge{\n\tint t,v;\n\tEdge(){}\n\tEdge(int T,int V){t=T,v=V;}\n};\nvector<Edge> G[100005];\nint n,m,q,dep[100005],fa[18][100005],st[18][100005],lgs[100005];\nvoid dfs(int now,int pre)\n{\n\tdep[now]=dep[pre]+1;\n\tfa[0][now]=pre;\n\tfor(int i=1;i<=17;++i)\tfa[i][now]=fa[i-1][fa[i-1][now]],st[i][now]=max(st[i-1][now],st[i-1][fa[i-1][now]]);\n\tfor(auto to:G[now])\n\t{\n\t\tint t=to.t,val=to.v;\n\t\tif(t==pre)\tcontinue;\n\t\tst[0][t]=val;\n\t\tdfs(t ,now);\n\t}\n}\nint LCA(int u,int v)\n{\n\tif(dep[u]>dep[v])\tu^=v^=u^=v;\n\twhile(dep[u]<dep[v])\tv=fa[lgs[dep[v]-dep[u]]][v];\n\tif(u==v)\treturn u;\n\tfor(int i=17;~i;--i)\tif(fa[i][u]!=fa[i][v])\tu=fa[i][u],v=fa[i][v];\n\treturn fa[0][u];\n}\nint jump(int s,int t)\n{\n\tint ret=0;\n\twhile(dep[s]>dep[t])\n\t{\n\t\tret=max(ret,st[lgs[dep[s]-dep[t]]][s]);\n\t\ts=fa[lgs[dep[s]-dep[t]]][s];\n\t}\n\treturn ret;\n}\nint main(){\n\tn=read(),m=read(),q=read();\n\tufs.makeSet(n);\n\tfor(int i=1;i<=m;++i)\n\t{\n\t\tint tek=m-i+1;\n\t\tfor(int j=2;j*tek<=n;++j)\n\t\t{\n\t\t\tif(ufs.unionSet((j-1)*tek,j*tek))\n\t\t\t{\n\t\t\t\tG[(j-1)*tek].push_back(Edge(j*tek,i));\n\t\t\t\tG[j*tek].push_back(Edge((j-1)*tek,i));\n//\t\t\t\tprintf(\"%d %d %d\\n\",(j-1)*tek,j*tek,i);\n\t\t\t}\n\t\t}\n\t}\n\tdfs(1,0);\n\tfor(int i=2;i<=n;++i)\tlgs[i]=lgs[i>>1]+1;\n\twhile(q-->0)\n\t{\n\t\tint u=read(),v=read(),lca=LCA(u,v);\n\t\twrite(max(jump(u,lca),jump(v,lca))),puts(\"\");\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1624951715,
        "uid": 184977,
        "name": "pomelo_nene",
        "ccfLevel": 9,
        "title": "\u95f2\u8bb03"
    },
    {
        "content": "~~\u6211\u4eec\u6559\u7ec3\u4e0a\u5348\u8003\u8fd9\u9898\u7ed9\u6254\u5230T1\uff0c\u82b1\u4e86\u4e00\u4e2a\u534a\u5c0f\u65f6\u624dA~~\n\n\u9996\u5148\u8fd9\u9898\u9898\u9762\u53ef\u4ee5\u8fd9\u6837\u63cf\u8ff0\n\nn\u4e2a\u70b9\uff0c\u4efb\u610f\u4e24\u70b9\u95f4\u8fde\u8fb9\u7684\u6743\u503c\u4e3a$(a,b)$\uff0c\uff08\u82e5$(a,b)>m$\u5219\u65e0\u8fb9\u76f8\u8fde\uff09\uff0c\u6c42$a$\u5230$b$\u7684\u4e00\u6761\u8def\u5f84\uff0c\u4f7f\u5f97\u7ecf\u8fc7\u8fb9\u6743\u7684\u6700\u5c0f\u503c\u6700\u5927\n\n\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u4fdd\u7559\u4e24\u70b9\u95f4\u8054\u901a\u65f6\u6700\u5927\u7684\u5fc5\u8981\u7684\u90a3\u4e9b\u8fb9\n\n\u6211\u4eec\u53ef\u4ee5\u8d2a\u5fc3\u5730\u4ece\u5927\u5230\u5c0f\u52a0\u8fb9\uff0c\u4ece\u4e00\u4e2a\u70b9\u5411ta\u7684\u500d\u6570\u5c1d\u8bd5\u8fde\u8fb9\uff0c\u82e5\u4e0d\u8fde\u901a\u5219\u8fde\u4e00\u6761\u6743\u503c\u4e3a\u8be5\u70b9\u7f16\u53f7\u7684\u8fb9\n\n\u8fde\u901a\u6027\u53ef\u4ee5\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u4e00\u68f5\u6811\uff0c\u4e24\u70b9\u95f4\u7b80\u5355\u8def\u5f84\u6743\u503c\u7684\u6700\u5c0f\u503c\u5373\u4e3a\u6240\u6c42\n\n\u52a0\u8fb9\u7684\u590d\u6742\u5ea6\u662f$\\Theta(n \\log n)$\u7ea7\u7684\uff0c\u5177\u4f53\u8bc1\u660e\u53ef\u4ee5\u7528\u653e\u7f29\u7684\u65b9\u5f0f\u6765\u8bc1\n\n\u7136\u540e\u5728\u6811\u4e0a\u8dd1\u500d\u589e\u6216\u6811\u94fe\u5256\u5206\u5c31\u884c\n\n\u95ee\u9898\uff1a\u6811\u94fe\u5256\u5206\u5982\u4f55\u505a\u5230$\\Theta(q \\log n)$\uff1f\n\n\u6211\u4eec\u53ef\u4ee5\u9884\u5904\u7406\u67d0\u70b9\u5230\u94fe\u9876\u7684\u6700\u5c0f\u8fb9\u6743\n\n\u6700\u540e\u8df3\u94fe\u5230\u540c\u4e00\u6761\u65f6\u518d\u7528\u7ebf\u6bb5\u6811\n\n\u7b54\u6848\u5373\u4e3a$m-ans+1$\n\n```cpp\n#include\"cstdio\"\n#include\"cstring\"\n#include\"iostream\"\n#include\"algorithm\"\n#include\"bitset\"\nusing namespace std;\n\nconst int MAXN=1<<17;\n\nint n,m,t,np;\nint h[MAXN],f[MAXN],fa[MAXN],sn[MAXN],siz[MAXN],nwn[MAXN];\nint id[MAXN],num[MAXN],ren[MAXN],dep[MAXN],top[MAXN];\nint tree[MAXN<<1];\nstruct rpg{\n\tint li,nx,ln;\n}a[MAXN<<1];\n\nint find(int x){return f[x]==x?x:f[x]=find(f[x]);}\nvoid un(int a,int b){int fa=find(a),fb=find(b);if(fa!=fb) f[fa]=fb;}\nvoid add(int ls,int nx,int ln)\n{\n\ta[++np]=(rpg){h[ls],nx,ln};h[ls]=np;\n\ta[++np]=(rpg){h[nx],ls,ln};h[nx]=np;\n}\n\nvoid dfs1(int x,int f,int tp,int ln)\n{\n\tdep[x]=tp;\n\tfa[x]=f;\n\tsiz[x]=1;\n\tnum[x]=ln;\n\tfor(int i=h[x];i;i=a[i].li){\n\t\tif(a[i].nx==f) continue;\n\t\tdfs1(a[i].nx,x,tp+1,a[i].ln);\n\t\tsiz[x]+=siz[a[i].nx];\n\t\tif(siz[a[i].nx]>siz[sn[x]]) sn[x]=a[i].nx;\n\t}return;\n}\n\nvoid dfs2(int x,int tpx,int mx)\n{\n\tid[x]=++id[0];\n\tren[id[x]]=num[x];\n\tnwn[x]=mx;\n\ttop[x]=tpx;\n\tif(!sn[x]) return;\n\tdfs2(sn[x],tpx,min(mx,num[sn[x]]));\n\tfor(int i=h[x];i;i=a[i].li){\n\t\tif(a[i].nx==fa[x]||a[i].nx==sn[x]) continue;\n\t\tdfs2(a[i].nx,a[i].nx,num[a[i].nx]);\n\t}return;\n}\n\nvoid build(int k,int l,int r)\n{\n\tif(l==r){\n\t\ttree[k]=ren[l];\n\t\treturn;\n\t}int i=k<<1,mid=l+r>>1;\n\tbuild(i,l,mid);build(i|1,mid+1,r);\n\ttree[k]=min(tree[i],tree[i|1]);\n\treturn;\n}\n\nint cask(int k,int l,int r,int le,int ri)\n{\n\tif(le<=l&&r<=ri) return tree[k];\n\tint i=k<<1,mid=l+r>>1,ans=m+1;\n\tif(le<=mid) ans=min(ans,cask(i,l,mid,le,ri));\n\tif(mid<ri) ans=min(ans,cask(i|1,mid+1,r,le,ri));\n\treturn ans;\n}\n\nint casks(int x,int y)\n{\n\tint ans=m+1;\n\twhile(top[x]!=top[y]){\n\t\tif(dep[top[x]]<dep[top[y]]) swap(x,y);\n\t\tans=min(ans,nwn[x]);\n\t\tx=fa[top[x]];\n\t}if(dep[x]>dep[y]) swap(x,y);\n\tif(id[y]-id[x]>=1) ans=min(ans,cask(1,1,n,id[x]+1,id[y]));\n\treturn ans;\n}\n\nint main()\n{\n\tscanf(\"%d%d%d\",&n,&m,&t);\n\tfor(int i=1;i<=n;++i) f[i]=i;\n\tfor(int i=m;i;--i){\n\t\tfor(int j=i<<1;j<=n;j+=i){\n\t\t\tif(find(i)!=find(j)){\n\t\t\t\tadd(i,j,i);\n\t\t\t\tun(i,j);\n\t\t\t}\n\t\t}\n\t}dfs1(1,1,1,0);dfs2(1,1,m+1);\n\tbuild(1,1,n);\n\twhile(t--){\n\t\tint x,y;scanf(\"%d%d\",&x,&y);\n\t\tprintf(\"%d\\n\",m-casks(x,y)+1);\n\t}return 0;\n}\n```",
        "postTime": 1541501917,
        "uid": 31293,
        "name": "Adove",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4616 \u3010[COCI2017-2018#5] Pictionary\u3011"
    },
    {
        "content": "\u7ed3\u8bba\u9898\u3002\n\n\u8bc1\u660e\u4e00\u4e0b\uff0c\u5bf9\u4e8e $\\forall i$ \uff0c\u5728\u7b2c $i$ \u5929\uff0c\u53ea\u9700\u5c06 $m-i+1$ \u4e0e\u5b83\u7684\u500d\u6570\u8fde\u8fb9\u6240\u5f97\u751f\u6210\u6811 $T$ \u7684\u8fde\u901a\u6027\u4e0e $\\forall i$\uff0c\u5728\u7b2c $i$ \u5929\uff0c\u5f53 $\\gcd(a,b)=m-i+1$\uff0c\u5219\u5c06 $a,b$ \u8fde\u8fb9\uff0c\u6240\u5f97\u56fe $G$ \u7684\u8fde\u901a\u6027\u76f8\u540c\u3002\u5bf9\u4e8e\u4e24\u4e2a\u70b9 $a,b$\uff0c\u5728\u7b2c $i$ \u5929\u624d\u80fd\u591f **\u76f4\u63a5\u5230\u8fbe\uff08\u5373\u5728\u539f\u56fe $G$ \u4e0a\u6709\u8fb9 $(a,b)$\uff09** \uff0c\u4e00\u5b9a\u6ee1\u8db3 $\\gcd(a,b)=m-i+1$\uff0c\u4e5f\u5c31\u662f\u8bf4 $(m-i+1)|a,(m-i+1)|b$\uff0c\u6309\u7167\u6211\u4eec\u5bf9\u4e8e\u751f\u6210\u6811 $T$ \u7684\u5b9a\u4e49\uff0c\u5728\u751f\u6210\u6811 $T$ \u4e0a\u8fd9\u4e24\u70b9\u662f\u8fde\u901a\u7684\uff0c\u5728\u539f\u56fe\u4e0a\u4e5f\u662f\u8fde\u901a\u7684\uff0c\u8bc1\u6bd5\u3002\n\n\u90a3\u4e48\u5728\u7b2c $i$ \u5929\uff0c\u6211\u4eec\u5c06 $m-i+1$ \u4e0e\u5b83\u7684\u500d\u6570\u8fde\u8fb9\u3002\u9700\u8981\u7ef4\u62a4\u4e00\u7ec4\u8fb9\u96c6\u5224\u65ad\u8fde\u8fb9\u540e\u662f\u5426\u5b58\u5728\u73af\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u4f7f\u7528\u5e76\u67e5\u96c6\u3002\u8fd8\u9700\u8981\u7ef4\u62a4 $a,b$ \u6700\u65e9\u5728\u54ea\u5929\u52a0\u5165\u54ea\u6761\u8fb9\u4e4b\u540e\u53ef\u4ee5\u76f8\u4e92\u5230\u8fbe\uff0c\u4f7f\u7528\u6309\u79e9\u5408\u5e76 $/$ \u542f\u53d1\u5f0f\u5408\u5e76\u4fdd\u6301\u5e76\u67e5\u96c6\u7684\u7ed3\u6784\uff0c\u5728 $a,b$ \u5df2\u7ecf\u8fde\u901a\u65f6\uff0c\u67e5\u8be2\u8def\u5f84 $a\\to b$ \u4e0a\u6700\u665a\u52a0\u5165\u7684\u8fb9\u7684\u5929\u6570\u3002\u6211\u4eec\u5c06\u7b2c $i$ \u5929\u52a0\u5165\u7684\u8fb9\u7684\u8fb9\u6743\u8bbe\u505a $i$\uff0c\u90a3\u4e48\u5c31\u662f\u67e5\u8be2 $a\\to b$ \u4e0a\u8fb9\u6743\u6700\u5927\u7684\u503c\u3002\n\n\u6309\u79e9\u5408\u5e76\u6709\u7740\u975e\u5e38\u597d\u7684\u6027\u8d28\uff1a\u6240\u5f97\u751f\u6210\u6811\u9ad8\u4e0d\u4f1a\u8d85\u8fc7 $\\log n$\uff0c\u6240\u4ee5\u5982\u679c\u4f7f\u7528\u6309\u79e9\u5408\u5e76\uff0c\u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u67e5\u8be2\u8fd9\u4e2a\u503c\u3002 ",
        "postTime": 1601780960,
        "uid": 95244,
        "name": "tommymio",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4616 \u3010[COCI2017-2018#5] Pictionary\u3011"
    }
]
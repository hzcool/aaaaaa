[
    {
        "content": "~~\u4e3a\u4ec0\u4e48\u9898\u89e3\u91cc\u9762\u90fd\u662f\u8dd1\u7f51\u7edc\u6d41\u554a\u5582\u3002~~\n\n\u4e0b\u9762\u63d0\u4f9b\u4e00\u79cd\u4e8c\u5206\u56fe\u5b8c\u7f8e\u5339\u914d\u7684\u601d\u8def\u3002\n\n### \u89e3\u9898\u601d\u8def\n\n\u9898\u76ee\u6700\u540e\u63d0\u5230\u8981\u6c42\u6700\u4f4e\u6210\u672c\uff0c\u90a3\u5c31\u76f8\u5f53\u4e8e\u662f\u8981\u8dd1\u4e8c\u5206\u56fe\u6700\u5c0f\u6743\u5b8c\u7f8e\u5339\u914d\uff08\u8bf4\u767d\u4e86\u5c31\u662f\u8d1f\u6743\u8fb9\u8dd1\u6700\u5927\u6743\uff09\n\n\u52a0\u8fb9\u7684\u65f6\u5019\uff08\u7528\u7684\u662f\u90bb\u63a5\u77e9\u9635\uff09\uff0c\u6211\u4eec\u679a\u4e3e\u80fd\u66f4\u65b0\u5230\u7684\u7f16\u53f7\u8303\u56f4\uff0c\u7136\u540e\u52a0\u8fb9\u3002\n\n\u52a0\u5b8c\u8fb9\u4e4b\u540e\u5c31\u518d\u8dd1\u4e00\u4e2a KM \u7684\u677f\u5b50\u5c31\u597d\u4e86\u3002\n\n\u5173\u4e8e\u4ec0\u4e48\u65f6\u5019\u8f93\u51fa `NIE`\uff1a\n\n\u53ea\u9700\u5728\u66f4\u65b0 $del$ \u7684\u65f6\u5019\u5224\u65ad $del$ \u662f\u5426\u8fd8\u662f $\\infty$ \u5c31\u597d\u4e86\u3002\n\n\u5982\u679c\u8fd8\u662f $\\infty$ \uff0c\u90a3\u4e48\u5c31\u8f93\u51fa `NIE`\u3002\n\n\u5177\u4f53\u770b\u4ee3\u7801\u7406\u89e3\uff0c\u8fd9\u91cc\u8dd1\u7684\u662f dfs \u7248\u7684 KM\u3002\n\n### AC\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int N=5e2+1,inf=1e9+1;\nint n;\nint a[N],b[N];\nint last[N],k[N]; \nint goal[N],slack[N];\nstruct edge{\n\tint to,ne,dis;\n}e[N*N];\nint adj[N],l;\ninline void add(int x,int y,int z){e[++l].to=y,e[l].ne=adj[x],e[l].dis=z,adj[x]=l;}\nint col[N],vis[N],mat[N];\nint nn;\nint flag=0;\nint ans[N],sum;\nint dfs(int x){\n\tvis[x]=1;\n\tfor(register int i=adj[x];i;i=e[i].ne){\n\t\tint y=e[i].to,z=e[i].dis;\n\t\tif(vis[y]) continue;\n\t\tint dist=goal[x]+goal[y]-z;\n\t\tif(dist==0){\n\t\t\tvis[y]=1;\n\t\t\tif(!mat[y]||dfs(mat[y])){\n\t\t\t\tif(mat[y]) sum-=ans[y];\n\t\t\t\tans[y]=z;\n\t\t\t\tsum+=z;\n\t\t\t\tmat[y]=x;\n\t\t\t\treturn 1;\n\t\t\t} \n\t\t}\n\t\telse slack[y]=min(slack[y],dist);\n\t}\n\treturn 0;\n}\ninline int KM(){\n\tfor(register int x=1;x<=n;x++){\n\t\tfor(int i=adj[x];i;i=e[i].ne){\n\t\t\tint y=e[i].to,z=e[i].dis;\n\t\t\tgoal[x]=max(goal[x],z);\n\t\t}\n\t}\n\tfor(register int i=1;i<=n;i++){\n\t\tmemset(slack,inf,sizeof(slack));\n\t\twhile(1){\n\t\t\tmemset(vis,0,sizeof(vis));\n\t\t\tif(dfs(i)) break;\n\t\t\tint del=inf;\n\t\t\tfor(register int j=n+1;j<=n+nn;j++) if(!vis[j]) del=min(del,slack[j]);\n\t\t\tif(del==inf) return inf;\n\t\t\tfor(register int j=1;j<=n;j++) if(vis[j]) goal[j]-=del;\n\t\t\tfor(register int j=n+1;j<=n+nn;j++){\n\t\t\t\tif(vis[j]) goal[j]+=del;\n\t\t\t\telse slack[j]-=del;\n\t\t\t} \n\t\t}\n\t}\n\treturn sum;\n}\nsigned main(){\n\tscanf(\"%lld\",&n);\n\tfor(register int i=1;i<=n;i++){\n\t\tscanf(\"%lld%lld%lld%lld\",&last[i],&a[i],&b[i],&k[i]);\n\t\tnn=max(nn,max(a[i],b[i]));\n\t\tfor(register int j=a[i];j<=b[i];j++) add(i,j+n,-k[i]*abs(last[i]-j));\n\t\tgoal[i]=-inf;\n\t}\n\tint anss=KM();\n\tif(anss==inf) printf(\"NIE\");\n\telse printf(\"%lld\",-anss);\n}\n```\n",
        "postTime": 1624424263,
        "uid": 209808,
        "name": "\u94f6\u6cb3AI",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P3440 [POI2006]SZK-Schools"
    },
    {
        "content": "\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u5e26\u6743\u4e8c\u5206\u56fe\u5339\u914d\uff0c\u5efa\u597d\u56fe\u540e\u76f4\u63a5\u8dd1\u4e00\u8fb9\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\n\n\u6700\u540e\u5982\u679c\u6700\u5927\u6d41\u4e0d\u4e3a$n$\uff0c\u8bf4\u660e\u4e0d\u662f\u6240\u6709\u4eba\u90fd\u80fd\u627e\u5230\u5408\u9002\u7684\u7f16\u53f7\uff0c\u8f93\u51fa`NIE`\uff0c\u5426\u5219\u8f93\u51fa\u6700\u5c0f\u8d39\u7528\n\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<queue>\n#include<algorithm>\n#include<cstring>\nusing namespace std;\nconst int Maxn=1000,Maxm=100000+20,inf=0x3f3f3f3f;\nint nxt[Maxm],flow[Maxm],to[Maxm],cost[Maxm];\nint head[Maxn],dis[Maxn],pre[Maxn],cur[Maxn];\nint n,s,t,ans,tot,edgecnt=1;\nbool vis[Maxn];\ninline int read()\n{\n\tint s=0,w=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n\twhile(ch>='0' && ch<='9')s=(s<<3)+(s<<1)+(ch^48),ch=getchar();\n\treturn s*w;\n}\ninline void add(int x,int y,int len,int c)\n{\n\t++edgecnt;\n\tnxt[edgecnt]=head[x];\n\tto[edgecnt]=y;\n\tflow[edgecnt]=len;\n\tcost[edgecnt]=c;\n\thead[x]=edgecnt;\n}\nbool spfa()\n{\n\tmemset(dis,inf,sizeof(dis));\n\tmemset(cur,inf,sizeof(cur));\n\tqueue <int> q;\n\tdis[s]=0,vis[s]=1,q.push(s);\n\twhile(!q.empty())\n\t{\n\t\tint x=q.front();\n\t\tq.pop();\n\t\tvis[x]=0;\n\t\tfor(int i=head[x];i;i=nxt[i])\n\t\t{\n\t\t\tint y=to[i];\n\t\t\tif(!flow[i])continue;\n\t\t\tif(dis[y]>dis[x]+cost[i])\n\t\t\t{\n\t\t\t\tdis[y]=dis[x]+cost[i];\n\t\t\t\tpre[y]=i,cur[y]=min(cur[x],flow[i]);\n\t\t\t\tif(!vis[y])vis[y]=1,q.push(y);\n\t\t\t}\n\t\t}\n\t}\n\tif(dis[t]==inf)return 0;\n\treturn 1;\n}\nvoid upd()\n{\n\tint x=t;\n\twhile(x!=s && x)\n\t{\n\t\tint i=pre[x];\n\t\tflow[i]-=cur[t];\n\t\tflow[i^1]+=cur[t];\n\t\tx=to[i^1];\n\t}\n\tans+=cur[t];\n\ttot+=cur[t]*dis[t];\n}\nint main()\n{\n\t//freopen(\"in.txt\",\"r\",stdin);\n\t//freopen(\"out.txt\",\"w\",stdout);\n\tn=read();\n\ts=n*2+1,t=s+1;\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tadd(s,i,1,0);\n\t\tadd(i,s,0,0);\n\t\tadd(i+n,t,1,0);\n\t\tadd(t,i+n,0,0);\n\t}\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tint id=read(),l=read(),r=read(),k=read();\n\t\tfor(int j=l;j<=r;++j)\n\t\t{\n\t\t\tint c=abs(id-j)*k;\n\t\t\tadd(i,j+n,1,c);\n\t\t\tadd(j+n,i,0,-c);\n\t\t}\n\t}\n\twhile(spfa())upd();\n\tif(ans!=n)\n\t{\n\t\tputs(\"NIE\");\n\t\treturn 0;\n\t}\n\tprintf(\"%d\\n\",tot);\n\t\n\treturn 0;\n}\n```",
        "postTime": 1576566284,
        "uid": 120362,
        "name": "Priori_Incantatem",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3440 \u3010[POI2006]SZK-Schools\u3011"
    },
    {
        "content": "\u9898\u610f\u4e0d\u518d\u63cf\u8ff0\u4e86\u3002\n\n\u6bcf\u4e2a\u5b66\u6821\u6709\u4e00\u4e2a\u521d\u59cb\u7f16\u53f7\u3001\u4e00\u4e2a\u6539\u7f16\u540e\u53ef\u4ee5\u63a5\u53d7\u7684\u7f16\u53f7\u8303\u56f4\uff0c\u4ee5\u53ca\u5355\u4f4d\u7f16\u53f7\u53d8\u5316\u7684\u4ee3\u4ef7\u3002\u4e0d\u96be\u770b\u51fa\u5176\u5b9e\u662f\u4e00\u9053\u5e26\u6743\u4e8c\u5206\u56fe\u5339\u914d\u95ee\u9898\uff0c\u5373\u5b66\u6821\u53bb\u548c\u7f16\u53f7\u5339\u914d\uff0c\u76f4\u63a5\u4e0a\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\u3002\u6211\u4eec\u7528\u4e00\u4e2a\u8d85\u7ea7\u6e90\u70b9\u5411\u6240\u6709\u5b66\u6821\u8fde\u8fb9\uff0c\u5bb9\u91cf\u662f $1$\uff0c\u8d39\u7528\u662f $0$\u3002\u6bcf\u4e2a\u5b66\u6821\u5411\u5b83\u80fd\u63a5\u53d7\u7684\u6240\u6709\u7f16\u53f7\u8fde\u8fb9\uff0c\u5bb9\u91cf\u662f $1$\uff0c\u8d39\u7528\u5c31\u662f\u7f16\u53f7\u53d8\u5316\u91cf\u4e58\u4ee5\u5355\u4f4d\u53d8\u5316\u7684\u4ee3\u4ef7\u3002\u518d\u628a\u6240\u6709\u7f16\u53f7\u5411\u8d85\u7ea7\u6c47\u70b9\u8fde\u8fb9\uff0c\u5bb9\u91cf\u4e3a $1$\uff0c\u8d39\u7528\u4e3a $0$\u3002\u5b66\u6821\u7528\u70b9 $1$ \u5230 $n$ \u8868\u793a\uff0c\u7f16\u53f7 $i$ \u7528\u70b9 $n+i$ \u8868\u793a\u3002\u6e90\u70b9\u4e3a $0$\uff0c\u6c47\u70b9\u4e3a $n+n+1$\u3002\n\n\u6700\u5c0f\u8d39\u7528\u662f\u5728\u6700\u5927\u6d41\u91cf\u7684\u524d\u63d0\u4e0b\u7684\u3002\u672c\u9898\u5982\u679c\u6700\u5927\u6d41\u8ba1\u7b97\u51fa\u6765\u7b49\u4e8e $n$\uff0c\u90a3\u8bf4\u660e\u6240\u6709\u5b66\u6821\u90fd\u5339\u914d\u5230\u4e86\u7f16\u53f7\uff0c\u6b64\u65f6\u7684\u6700\u5c0f\u8d39\u7528\u4fbf\u662f\u7b54\u6848\u3002\u5982\u679c\u6700\u5927\u6d41\u4e0d\u662f $n$\uff0c\u90a3\u4e48\u5224\u5b9a\u4e3a\u65e0\u89e3\u3002\n\n\u4ee3\u7801\uff1a\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nint n,s,t;\nint p[250],a[250],b[250],k[250];\nconst int N=200010,INF=500000000;\nint head[N],to[N*2],nex[N*2],e[N*2],cnt,f[N*2];\nvoid addE(int x,int y,int z,int w){\n\tcnt++;\n\te[cnt]=z;\n\tf[cnt]=w;\n\tto[cnt]=y;\n\tnex[cnt]=head[x];\n\thead[x]=cnt;\n}\nvoid add(int x,int y,int z,int w){\n\taddE(x,y,z,w);\n\taddE(y,x,0,-w);\n}\nint d[N],pre[N],r[N];\nbool v[N];\nbool spfa(){\n\tqueue<int> q;\n\tq.push(s);\n\tmemset(d,0x3f,sizeof(d));\n\tmemset(v,0,sizeof(v));\n\tv[s]=1;\n\td[s]=0;\n\tr[s]=INF;\n\twhile(q.size()){\n\t\tint x=q.front();\n\t\tq.pop();\n\t\tv[x]=0;\n\t\tfor(int i=head[x];i;i=nex[i]){\n\t\t\tint y=to[i];\n\t\t\tif(e[i]&&d[y]>d[x]+f[i]){\n\t\t\t\td[y]=d[x]+f[i];\n\t\t\t\tpre[y]=i;\n\t\t\t\tr[y]=min(r[x],e[i]);\n\t\t\t\tif(!v[y]){\n\t\t\t\t\tv[y]=1;\n\t\t\t\t\tq.push(y);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tif(d[t]!=d[t+1])\n\t\treturn 1;\n\treturn 0;\n}\nint ans,maxflow;\nvoid update(){\n\tint x=t;\n\twhile(x!=s){\n\t\te[pre[x]]-=r[t];\n\t\te[pre[x]^1]+=r[t];\n\t\tx=to[pre[x]^1];\n\t}\n\tans+=r[t]*d[t];\n\tmaxflow+=r[t];\n}\nvoid EK(){\n\twhile(spfa())\n\t\tupdate();\n}\nint main(){\n\tcnt=1;\n\tcin>>n;\n\tfor(int i=1;i<=n;i++)\n\t\tcin>>p[i]>>a[i]>>b[i]>>k[i];\n\ts=0;\n\tt=n+n+1;\n\tfor(int i=1;i<=n;i++){\n\t\tadd(s,i,1,0);\n\t\tfor(int j=a[i];j<=b[i];j++)\n\t\t\tadd(i,n+j,1,k[i]*abs(p[i]-j));\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tadd(i+n,t,1,0);\n\tEK();\n\tif(maxflow!=n)\n\t\tcout<<\"NIE\";\n\telse\n\t\tcout<<ans;\n\treturn 0;\n}\n```",
        "postTime": 1643767972,
        "uid": 140360,
        "name": "LKawaii",
        "ccfLevel": 0,
        "title": "P3440\u9898\u89e3"
    },
    {
        "content": "\u7b2c\u4e00\u773c\u770b\u4e0a\u53bb\u597d\u50cf\u5e76\u4e0d\u662f\u5f88\u53ef\u505a\u4f46\u662f\u770b\u4e86\u6570\u636e\u8303\u56f4\u540e\u5c31\u4e0d\u96be\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u7f51\u7edc\u6d41\u95ee\u9898\u3002\n\n\u8981\u5224\u65ad\u662f\u5426\u5408\u6cd5\u548c\u8d39\u7528\u6700\u5c0f\uff0c\u90a3\u4e48\u53ef\u4ee5\u4f7f\u7528\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\uff0c\u5e76\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u6709\u6700\u5c0f\u5272\u7684\u6807\u7b7e\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a**\u5b66\u6821**\uff0c\u6ce8\u610f\u662f**\u5b66\u6821**\u800c\u4e0d\u662f\u7f16\u53f7\uff0c\u5411\u5b83\u80fd\u591f\u8f6c\u79fb\u7684\u7f16\u53f7\u8fde\u8fb9\uff0c\u6d41\u91cf\u5927\u5c0f\u4e3a1\uff0c\u8d39\u7528\u4e3a\u4ee3\u4ef7\uff0c\u7136\u540e\u539f\u70b9\u5411\u5b66\u6821\u8fde\u8fb9\uff0c\u6d41\u91cf\u5927\u5c0f\u4e3a1\uff0c\u8d39\u7528\u4e3a0,\u6bcf\u4e2a\u7f16\u53f7\u5411\u6c47\u70b9\u8fde\u8fb9\uff0c\u6d41\u91cf\u5927\u5c0f\u4e3a1,\u8d39\u7528\u4e3a0,\u7136\u540e\u5c31\u662f\u6a21\u677f\u4e86\u3002\n\n\u628a\u5b66\u6821\u8f6c\u5316\u6210\u7f16\u53f7\uff0c\u8fd9\u6837\u505a\u4e0d\u5408\u6cd5\u7406\u7531\u662f\u6709\u53ef\u80fd\u4f1a\u8ba9\u67d0\u4e2a\u5b66\u6821\u7528\u4e86\u522b\u7684\u5b66\u6821\u7684\u8d39\u7528\uff0c\u6bd4\u5982\n```\n3\n1 1 3 1\n1 1 3 2\n1 1 3 3\n```\n\u8fd9\u7ec4\u6570\u636e\u3002\n\n\u6240\u4ee5\u5e94\u8be5\u662f\u7528\u5b66\u6821\u4f5c\u4e3a\u4e00\u4e2a\u70b9\u3002\n\n```\n#include<queue>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nconst int N=410;\nstruct Edge{\n\tint to,nxt,val,cost;\n}e[N*N];\nint h[N],idx=1;\nvoid Ins(int a,int b,int c,int d){\n\te[++idx].to=b;e[idx].nxt=h[a];\n\th[a]=idx;e[idx].val=c;e[idx].cost=d;\n}\nint st,ed,cnt,mp[N],dis[N],pre[N];\nbool inq[N];\ndeque<int> q;\nbool spfa(){\n\tmemset(dis,0x3f,sizeof(dis));\n\tmemset(inq,0,sizeof(inq));\n\tdis[st]=0;q.push_back(st);\n\twhile(!q.empty()){\n\t\tint u=q.front();q.pop_front();inq[u]=0;\n\t\tfor(int i=h[u];i;i=e[i].nxt){\n\t\t\tint v=e[i].to;\n\t\t\tif(dis[v]>dis[u]+e[i].cost&&e[i].val){\n\t\t\t\tdis[v]=dis[u]+e[i].cost;\n\t\t\t\tpre[v]=i;\n\t\t\t\tif(!inq[v]){\n\t\t\t\t\tif(q.empty()||dis[v]<=dis[q.front()])q.push_front(v);\n\t\t\t\t\telse q.push_back(v);\n\t\t\t\t\tinq[v]=1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn dis[ed]!=0x3f3f3f3f;\n}\nint main(){\n\tint n;\n\tscanf(\"%d\",&n);\n\tst=++cnt;ed=++cnt;\n\tfor(int i=1;i<=n;i++){\n\t\tmp[i]=++cnt;\n\t\tIns(cnt,ed,1,0);Ins(ed,cnt,0,0);\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tint lst,a,b,k;\n\t\tscanf(\"%d%d%d%d\",&lst,&a,&b,&k);\n\t\t++cnt;\n\t\tIns(st,cnt,1,0);Ins(cnt,st,0,0);\n\t\tfor(int j=a;j<=b;j++){\n\t\t\tint w=abs(j-lst)*k;\n\t\t\tIns(cnt,mp[j],1,w);\n\t\t\tIns(mp[j],cnt,0,-w);\n\t\t}\n\t}\n\tint res1=0,res2=0;\n\twhile(spfa()){\n\t\tint Min=1e9;\n\t\tfor(int now=ed;now!=st;now=e[pre[now]^1].to)\n\t\t\tMin=min(Min,e[pre[now]].val);\n\t\tfor(int now=ed;now!=st;now=e[pre[now]^1].to){\n\t\t\te[pre[now]].val-=Min;\n\t\t\te[pre[now]^1].val+=Min;\n\t\t}\n\t\tres1+=Min;\n\t\tres2+=Min*dis[ed];\n\t}\n\tif(res1!=n)puts(\"NIE\");\n\telse printf(\"%d\\n\",res2);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1605774511,
        "uid": 305262,
        "name": "Su_Zipei",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3440 \u3010[POI2006]SZK-Schools\u3011"
    },
    {
        "content": "\u3010POI\u8865\u5168\u8ba1\u5212#24 POI2006 SZK\u3011\n\n\u6ca1\u4ec0\u4e48\u53ef\u8bf4\u7684\uff0c\u53c8\u662f\u6807\u51c6\u7684\u8d39\u7528\u6d41\uff08\u770b\u6570\u636e\u8303\u56f4\u90fd\u77e5\u9053\uff09\n\n\u5efa\u56fe\u5206\u4e09\u90e8\u5206\uff1a\n\n1.\u6e90\u70b9S->\u5b66\u6821i\uff0c\u5bb9\u91cf1\uff0c\u8d39\u75280\n\n2.\u5b66\u6821i->\u53ef\u63a5\u53d7\u7f16\u53f7j\uff0c\u5bb9\u91cf1\uff0c\u8d39\u7528 $ | m_i - j | \\times t_i $\uff0c\u5176\u4e2d $ a_i \\leq j \\leq b_i $ \n3.\u7f16\u53f7i->\u6c47\u70b9T\n\n\u7136\u540e\u518d\u8fd9\u4e2a\u56fe\u4e0a\u8dd1\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\u5373\u53ef\n\n\u8d34\u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<queue>\nusing namespace std;\nconst int MAXN=510,S=501,T=502,SHIFT=250;\nstruct edge\n{\n    int v,f,len;\n    edge *next,*rev;\n}*h[MAXN],pool[MAXN*MAXN*2];\nint top;\ninline void addedge(int u,int v,int c,int w)\n{\n    edge *tmp=&pool[++top];tmp->v=v;tmp->f=c;tmp->len=w;tmp->next=h[u];h[u]=tmp;\n    edge *pmt=&pool[++top];pmt->v=u;pmt->f=0;pmt->len=-w;pmt->next=h[v];h[v]=pmt;\n    tmp->rev=pmt;pmt->rev=tmp;\n}\nint totf,totc;\nqueue<int> q;\nint inq[MAXN],dis[MAXN],last[MAXN];\nedge *laste[MAXN];\ninline int spfa()\n{\n    while(!q.empty())q.pop();\n    memset(dis,0x3f,sizeof(dis));\n    memset(last,0,sizeof(last));\n    memset(laste,0,sizeof(laste));\n    dis[S]=0;inq[S]=1;\n    q.push(S);\n    while(!q.empty())\n    {\n        int u=q.front();q.pop();\n        inq[u]=0;\n        for(edge *tmp=h[u];tmp;tmp=tmp->next)\n        {\n            if(tmp->f&&dis[tmp->v]>dis[u]+tmp->len)\n            {\n                dis[tmp->v]=dis[u]+tmp->len;\n                last[tmp->v]=u;\n                laste[tmp->v]=tmp;\n                if(!inq[tmp->v])\n                {\n                    inq[tmp->v]=1;\n                    q.push(tmp->v);\n                }\n            }\n        }\n    }\n    if(dis[T]==0x3f3f3f3f)return -1;\n    int cur=T;\n    while(cur!=S)\n    {\n        laste[cur]->f--;laste[cur]->rev->f++;\n        cur=last[cur];\n    }\n    return dis[T];\n}\nint main()\n{\n    int n;\n    scanf(\"%d\",&n);\n    int m,l,r,t;\n    for(int i=1;i<=n;i++)\n    {\n        scanf(\"%d%d%d%d\",&m,&l,&r,&t);\n        addedge(S,i,1,0);\n        for(int j=l;j<=r;j++)\n        {\n            addedge(i,j+SHIFT,1,abs(m-j)*t);\n        }\n        addedge(i+SHIFT,T,1,0);\n    }\n    int tmp;\n    while((tmp=spfa())!=-1)\n    {\n        totf++;\n        totc+=tmp;\n    }\n    if(totf==n)printf(\"%d\\n\",totc);\n    else printf(\"NIE\\n\");\n    return 0;\n}\n```",
        "postTime": 1507050733,
        "uid": 3346,
        "name": "oscar",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3440 \u3010[POI2006]SZK-Schools\u3011"
    },
    {
        "content": "### \u524d\u8a00\r\n\r\n\u524d\u9762\u7684\u9898\u89e3\u53ea\u6709\u4e00\u7bc7\u662f\u7528 KM \u7b97\u6cd5\u7684\uff0c\u672c\u4eba\u5728\u6b64\u63d0\u4f9b\u53e6\u4e00\u79cd\u505a\u6cd5\u3002\r\n\r\n### \u601d\u8def\r\n\r\n\u9996\u5148\u660e\u786e\u672c\u9898\u662f\u6c42\u4e00\u4e2a\u4e8c\u5206\u56fe\u6700\u5927\u6743\u5b8c\u7f8e\u5339\u914d\uff0c\u4e8e\u662f\u8003\u8651\u4f7f\u7528 KM \u7b97\u6cd5\u6c42\u89e3\uff08\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\u4e5f\u53ef\u4ee5\u5b8c\u6210\uff09\u3002\u5982\u679c\u8fd8\u4e0d\u4f1a KM \u7b97\u6cd5\uff0c\u8bf7\u53f3\u8f6c [P6577 \u3010\u6a21\u677f\u3011\u4e8c\u5206\u56fe\u6700\u5927\u6743\u5b8c\u7f8e\u5339\u914d](https://www.luogu.com.cn/problem/P6577) \u8fdb\u884c\u5b66\u4e60\u3002\r\n\r\n\u9996\u5148\u660e\u786e\u9898\u610f\uff0c\u662f\u6c42\u4e8c\u5206\u56fe\u6700\u5927\u5339\u914d\u4e2d\u6700\u5c0f\u6743\u5339\u914d\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5c06\u539f\u95ee\u9898\u5176\u53d8\u4e3a\uff0c\u5c06\u6240\u6709\u7684\u8fb9\u6743\u53d8\u4e3a\u5b83\u7684\u76f8\u53cd\u6570\u540e\uff0c\u539f\u56fe\u7684\u6700\u5927\u6743\u5b8c\u7f8e\u5339\u914d\u3002\r\n\r\n\u5bf9\u4e8e\u6709\u89e3\u7684\u60c5\u51b5\uff0c\u76f4\u63a5\u8dd1\u4e00\u6b21 KM \u7b97\u6cd5\u7684\u6a21\u677f\u5c31\u53ef\u4ee5\u4e86\uff0c\u4f46\u662f\u6211\u4eec\u5e94\u8be5\u5982\u4f55\u5224\u5b9a\u65e0\u89e3\uff1f\r\n\r\n\u7b2c\u4e00\u79cd\u601d\u8def\u662f\u501f\u9274\u7684 @[\u94f6\u6cb3AI](https://www.luogu.com.cn/user/209808) \u7684\u601d\u8def\uff0c\u5728 DFS \u540e\u5224\u65ad $delta$ \u503c\u662f\u5426\u8fd8\u662f\u65e0\u9650\uff0c\u5982\u679c\u662f\u5219\u8bf4\u660e\u8282\u70b9 $i$ \u627e\u4e0d\u5230\u53ef\u884c\u7684\u589e\u5e7f\u8def\uff0c\u76f4\u63a5\u8fd4\u56de\u65e0\u89e3\u5373\u53ef\u3002\u5177\u4f53\u4ee3\u7801\u8bf7\u89c1 [\u9898\u89e3 P3440 POI2006 SZK-Schools](https://www.luogu.com.cn/blog/AIAKIOI/solution-p3440)\uff08\u8fd9\u6bd4\u6c42\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\u5feb\u5f97\u591a\uff0c\u4e0d\u8fc7\u628a KM \u7b97\u6cd5\u7528 BFS \u5199\u53ef\u80fd\u4f1a\u66f4\u5feb\uff09\u3002\r\n\r\n\u73b0\u5728\u8bf4\u4e00\u8bf4\u6211\u7684\u601d\u8def\u3002\u5bf9\u4e8e\u65e0\u89e3\u7684\u60c5\u51b5\uff0c\u4e00\u5b9a\u662f\u4f1a\u6709\u4e00\u4e2a\u70b9\u627e\u4e0d\u5230\u589e\u5e7f\u8def\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5728\u8fdb\u884c KM \u7b97\u6cd5\u6c42\u89e3\u4e4b\u524d\u5148\u8fdb\u884c\u4e00\u6b21\u5308\u7259\u5229\u7b97\u6cd5\uff08\u5982\u679c\u7528\u7684\u662f ``Dinic`` \u7b97\u6cd5\u5c31\u4e0d\u9700\u8981\u8003\u8651\u4e86\uff09\uff0c\u770b\u80fd\u5426\u7ed9\u6bcf\u4e2a\u70b9\u627e\u5230\u589e\u5e7f\u8def\uff0c\u5982\u679c\u53ef\u4ee5\u5219\u8fdb\u884c KM \u7b97\u6cd5\uff0c\u5982\u679c\u4e0d\u884c\u5219\u8f93\u51fa ``NIE``\u3002\r\n\r\n\u4e0d\u8fc7\u73b0\u5728\u6d89\u53ca\u5230\u4e00\u4e2a\u95ee\u9898\uff0c\u9898\u76ee\u4e2d\u603b\u7684\u8fb9\u6570\u6700\u5927\u53ef\u4ee5\u8fbe\u5230 $n^2$ \u6761\uff0c\u8fdb\u884c\u5308\u7259\u5229\u7b97\u6cd5\u65f6\uff0c\u4f1a\u679a\u4e3e\u6bcf\u4e2a\u70b9\uff0c\u5728\u5bfb\u627e\u6bcf\u4e2a\u70b9\u7684\u589e\u5e7f\u8def\u65f6\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u4e0a\u754c\u53ef\u4ee5\u8fbe\u5230 $O(nm)$\uff0c\u5728\u672c\u9898\u4e2d\u5373\u4e3a $O(n^3)$\uff0c\u5219\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u4f1a\u8fbe\u5230 $O(n^4)$\uff0c\u96be\u9053\u4e0d\u4f1a\u8d85\u65f6\u5417\uff1f\r\n\r\n\u7b54\u6848\u662f\u4e0d\u4f1a\uff0c\u56e0\u4e3a\u6211\u4eec\u5fc5\u987b\u6784\u9020\u51fa\u6765\u53ef\u80fd\u628a\u6240\u6709\u8fb9\u90fd\u679a\u4e3e\u4e00\u6b21\u624d\u80fd\u627e\u5230\u589e\u5e7f\u8def\u7684\u56fe\uff0c\u6309\u7167\u9898\u76ee\u4e2d\u7684\u5efa\u56fe\u65b9\u5f0f\u662f\u65e0\u6cd5\u6784\u9020\u51fa\u6765\u7684\uff0c\u5308\u7259\u5229\u7b97\u6cd5\u7684\u65f6\u95f4\u5728\u6b64\u53ea\u80fd\u8fbe\u5230 $O(n^3)$ \u5de6\u53f3\uff0c\u4e0d\u9700\u8981\u62c5\u5fc3\u8d85\u65f6\u7684\u95ee\u9898\u3002\r\n\r\n\uff08PS\uff1a\u54ea\u4f4d\u5927\u4f6c\u6784\u9020\u51fa\u6570\u636e\u5361\u6389\u4e86\u5308\u7259\u5229\u7b97\u6cd5\u9ebb\u70e6\u8bc4\u8bba\u6216\u8005\u79c1\u4fe1\u6307\u51fa\uff0c\u8c22\u8c22\uff01\u5f53\u7136\u8fd9\u79cd\u60c5\u51b5\u76f4\u63a5\u628a\u5308\u7259\u5229\u7b97\u6cd5\u6362\u6210 HK \u7b97\u6cd5\u6216\u8005 Dinic \u7b97\u6cd5\u5c31\u597d\u4e86\u3002\uff09\r\n\r\nAC Code\r\n\r\n```cpp\r\n#include<bits/stdc++.h>\r\nusing namespace std;\r\ninline int read(){\r\n\tint sss=0,www=1;\r\n\tchar chh=getchar();\r\n\twhile(chh<'0'||chh>'9'){\r\n\t\tif(chh=='-') www=-1;\r\n\t\tchh=getchar();\r\n\t}\r\n\twhile(chh>='0'&&chh<='9'){\r\n\t\tsss=sss*10+chh-'0';\r\n\t\tchh=getchar();\r\n\t}\r\n\treturn sss*www;\r\n}\r\nint n;\r\nlong long delta;\r\nlong long edge[205][205];\r\nint matched[405];\r\nbool vis[405],visx[205],visy[205];\r\nlong long lx[205],ly[205];\r\nint head[40005],to[40005],nxt[40005],tot=0;\r\nvoid add(int u,int v){\r\n\tto[++tot]=v;\r\n\tnxt[tot]=head[u];\r\n\thead[u]=tot;\r\n}\r\nbool find(int now){\r\n\tfor(register int i=head[now];i;i=nxt[i]){\r\n\t\tint u=to[i];\r\n\t\tif(!vis[u]){\r\n\t\t\tvis[u]=true;\r\n\t\t\tif(!matched[u]||find(matched[u])){\r\n\t\t\t\tmatched[u]=now;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\nbool check(){\r\n\tfor(register int i=1;i<=n;i++){\r\n\t\tmemset(vis,false,sizeof vis);\r\n\t\tif(!find(i)) return false;//\u627e\u4e0d\u5230\u589e\u5e7f\u8def\u8fd4\u56de\u65e0\u89e3\r\n\t}\r\n\treturn true;\r\n}\r\nbool dfs(int now){\r\n\tvisx[now]=true;\r\n\tfor(register int i=1;i<=n;i++){\r\n        if(!visy[i]){\r\n            if(lx[now]+ly[i]==edge[now][i]){\r\n                visy[i]=true;\r\n                if(!matched[i]||dfs(matched[i])){\r\n                    matched[i]=now;\r\n                    return true;\r\n                }\r\n            }\r\n            else delta=min(delta,lx[now]+ly[i]-edge[now][i]);\r\n        }\r\n    }\r\n    return false;\r\n}\r\nlong long KM(){\r\n\tmemset(lx,0x3f,sizeof lx);\r\n\tfor(register int i=1;i<=n;i++){\r\n\t\twhile(true){\r\n\t\t\tmemset(visx,false,sizeof visx);\r\n\t\t\tmemset(visy,false,sizeof visy);\r\n\t\t\tdelta=1e18;\r\n\t\t\tif(dfs(i)) break;\r\n\t\t\tfor(register int j=1;j<=n;j++){\r\n\t\t\t\tif(visy[j]) ly[j]+=delta;\r\n\t\t\t\tif(visx[j]) lx[j]-=delta;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tlong long ans=0;\r\n\tfor(register int i=1;i<=n;i++)\r\n\t\tans-=edge[matched[i]][i];\r\n\treturn ans;\r\n}\r\nint main(){\r\n\tn=read();\r\n\tint m,a,b,k;\r\n\tmemset(edge,-0x3f,sizeof edge);\r\n\tfor(register int i=1;i<=n;i++){\r\n\t\tm=read(),a=read(),b=read(),k=read();\r\n\t\tfor(register int j=a;j<=b;j++){\r\n\t\t\tadd(i,j+n);\r\n\t\t\tedge[i][j]=-k*abs(m-j);\r\n\t\t}\r\n\t}\r\n\tif(!check()){\r\n\t\tputs(\"NIE\");\r\n\t\treturn 0;\r\n\t}\r\n\tmemset(matched,0,sizeof matched);\r\n\tprintf(\"%lld\\n\",KM());\r\n\treturn 0;\r\n}\r\n```",
        "postTime": 1644627502,
        "uid": 367316,
        "name": "Foreverxxx",
        "ccfLevel": 0,
        "title": "P3440 [POI2006]SZK-Schools \u9898\u89e3"
    },
    {
        "content": "\u5bf9\u4e8e\u8fd9\u6837\u7684\u5339\u914d\u7c7b\u95ee\u9898\uff0c\u5f80\u5f80\u8981\u60f3\u5230\u5efa\u7acb\u7f51\u7edc\u6d41\u7684\u6a21\u578b\u6765\u89e3\u51b3\u3002\n\n\u6211\u4eec\u5c06\u5b66\u6821\u653e\u5230\u5de6\u8fb9\uff0c\u6bcf\u4e2a\u65b0\u7f16\u53f7\u653e\u5230\u53f3\u8fb9\uff0c\u5c06\u5b66\u6821\u4e0e\u5176\u6240\u6709\u63a5\u53d7\u7684\u65b0\u7f16\u53f7\u4e4b\u95f4\u8fde\u4e00\u6761\u6d41\u91cf\u4e3a $1$ \u7684\u8fb9\uff0c\u8d39\u7528\u4e3a\u6539\u7f16\u53f7\u7684\u5f00\u9500\u3002\n\n\u4ece\u8d85\u7ea7\u6e90\u70b9\u5411\u5de6\u8fb9\u6240\u6709\u70b9\u8fde\u4e00\u6761\u6d41\u91cf\u4e3a $1$\uff0c\u8d39\u7528\u4e3a $0$ \u7684\u8fb9\uff1b\u4ece\u8d85\u7ea7\u6c47\u70b9\u5411\u53f3\u8fb9\u6240\u6709\u70b9\u8fde\u4e00\u6761\u6d41\u91cf\u4e3a $1$\uff0c\u8d39\u7528\u4e3a $0$ \u7684\u8fb9\uff08\u8981\u786e\u4fdd\u6bcf\u4e2a\u7f16\u53f7\u6070\u597d\u88ab\u9009\u4e00\u6b21\uff09\uff0c\u8dd1\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\u5373\u53ef\u3002\n\n\u5982\u679c\u6700\u5927\u6d41\u4e0d\u5230 $n$ \u5219\u65e0\u89e3\uff0c\u5426\u5219\u6c42\u51fa\u7684\u6700\u5c0f\u8d39\u7528\u5373\u4e3a\u7b54\u6848\u3002\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <queue>\nusing namespace std;\nstruct graph\n{\n #define INF 0x3f3f3f3f\n struct edge\n {\n  int v,w,c,next;\n }e[100005];\n struct node\n {\n  int v,e;\n }p[10005];\n int head[505],dist[505],vis[505],s,t,cnt;\n void addedge(int u,int v,int w,int c)\n {\n  e[++cnt].v=v;\n  e[cnt].w=w;\n  e[cnt].c=c;\n  e[cnt].next=head[u];\n  head[u]=cnt;\n }\n void init(int S,int T,int n)\n {\n  s=S,t=T;\n  cnt=1;\n  for(int i=1;i<=n;i++)\n  {\n   addedge(s,i,1,0);\n   addedge(i,s,0,0);\n   addedge(i+n,t,1,0);\n   addedge(t,i+n,0,0);\n  }\n }\n bool spfa()\n {\n  queue<int> q;\n  memset(dist,INF,sizeof(dist));\n  q.push(s);\n  dist[s]=0;\n  vis[s]=1;\n  while(!q.empty())\n  {\n   int cur=q.front();\n   q.pop();\n   vis[cur]=0;\n   for(int i=head[cur];i;i=e[i].next)\n    if(e[i].w&&dist[cur]+e[i].c<dist[e[i].v])\n    {\n     dist[e[i].v]=dist[cur]+e[i].c;\n     p[e[i].v].v=cur;\n     p[e[i].v].e=i;\n     if(!vis[e[i].v])\n     {\n      vis[e[i].v]=1;\n      q.push(e[i].v);\n     }\n    }\n  }\n  return dist[t]!=INF;\n }\n pair<int,int> mcmf()\n {\n  int maxw=0,minf=0;\n  while(spfa())\n  {\n   int minw=INF;\n   for(int i=t;i!=s;i=p[i].v)\n    minw=min(minw,e[p[i].e].w);\n   for(int i=t;i!=s;i=p[i].v)\n   {\n    e[p[i].e].w-=minw;\n    e[p[i].e^1].w+=minw;\n   }\n   maxw+=minw;\n   minf+=minw*dist[t];\n  }\n  return make_pair(maxw,minf);\n }\n}g;\nint main()\n{\n int n;\n scanf(\"%d\",&n);\n g.init(2*n+1,2*n+2,n);\n for(int i=1;i<=n;i++)\n {\n  int m,a,b,k;\n  scanf(\"%d%d%d%d\",&m,&a,&b,&k);\n  for(int j=a;j<=b;j++)\n  {\n   int c=abs(m-j)*k;\n   g.addedge(i,j+n,1,c);\n   g.addedge(j+n,i,0,-c);\n  }\n }\n auto ans=g.mcmf();\n if(ans.first!=n)puts(\"NIE\");\n else printf(\"%d\\n\",ans.second);\n return 0;\n}\n```\n",
        "postTime": 1575799132,
        "uid": 22030,
        "name": "StudyingFather",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3440 \u3010[POI2006]SZK-Schools\u3011"
    },
    {
        "content": "# \u9898\u76ee\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[\u9898\u76ee\u94fe\u63a5](https://www.luogu.org/problem/P3440).\n# \u9898\u89e3\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u4e00\u9053\u6709\u8da3\u7684\u6700\u5c0f\u8d39\u7528\u6d41\u95ee\u9898. \u6211\u4eec\u5c1d\u8bd5\u628a\u539f\u95ee\u9898\u62bd\u8c61\u4e3a\u56fe:  \n![P3340_1.png](https://cdn.luogu.com.cn/upload/pic/74941.png).  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u5bf9\u4e8e\u4ece\u8d85\u7ea7\u6e90\u70b9\u51fa\u53d1\u7684\u8fb9, \u82b1\u8d39\u4e3a$0$, \u5bb9\u91cf\u4e3a$1$; \u5bf9\u4e8e\u5b66\u6821\u548c\u7f16\u53f7\u4e4b\u95f4\u7684\u8fb9$<u,v>$, \u82b1\u8d39\u4e3a$k_u|m_u-v|$, \u5bb9\u91cf\u4e3a$1$; \u5bf9\u4e8e\u8fde\u5411\u8d85\u7ea7\u6c47\u70b9\u7684\u8fb9, \u82b1\u8d39\u4e3a$0$, \u5bb9\u91cf\u4e3a$1$, \u8dd1\u4e00\u8fb9\u6700\u5c0f\u8d39\u7528\u6d41. \u82e5\u5230\u8fbe\u6c47\u70b9\u7684\u6d41\u91cf\u4e0d\u8db3$n$, \u8bc1\u660e\u65e0\u89e3, \u5426\u5219\u8f93\u51fa\u6700\u5c0f\u8d39\u7528.\n```cpp\n#include <queue>\n#include <cstdio>\n#include <cstring>\n#include <utility>\n\n#define Int register int\n\nusing namespace std;\n\ntypedef pair<int, int> pii;\n\nconst int MAXN = 200, MAXNODE = 2 * MAXN + 2;\nint n, Cnte = 1, Head[MAXNODE + 5] = {}, Dist[MAXNODE + 5] = {}, S, T;\nbool Vis[MAXNODE + 5] = {};\npii Path[MAXNODE + 5] = {};\nqueue<int> Q;\n\nstruct Edge {\n\tint To, Cost, Flow, _nxt;\n} Graph[2 * ( MAXN * MAXN + 2 * MAXN ) + 5] = {};\n\ninline int Abs ( const int x ) {\n\treturn x < 0 ? -x : x;\n}\n\ninline void Link ( const int From, const int To, const int Cost, const int Flow ) {\n\tGraph[++ Cnte] = { To, Cost, Flow, Head[From] };\n\tHead[From] = Cnte;\n}\n\ninline bool SPFA () {\n\tmemset ( Vis, false, sizeof Vis );\n\tmemset ( Path, 0, sizeof Path );\n\tmemset ( Dist, 0x3f, sizeof Dist );\n\tVis[S] = true, Q.push ( S ), Dist[S] = 0;\n\twhile ( ! Q.empty () ) {\n\t\tint u = Q.front (); Q.pop ();\n\t\tVis[u] = false;\n\t\tfor ( Int i = Head[u], v, w; i; i = Graph[i]._nxt ) {\n\t\t\tw = Graph[i].Cost;\n\t\t\tif ( Graph[i].Flow > 0 && Dist[v = Graph[i].To] > Dist[u] + w ) {\n\t\t\t\tDist[v] = Dist[u] + w, Path[v] = { u, i };\n\t\t\t\tif ( ! Vis[v] ) {\n\t\t\t\t\tQ.push ( v );\n\t\t\t\t\tVis[v] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn Dist[T] ^ 0x3f3f3f3f;\n}\n\ninline pii EK () {\n\tpii ret ( 0, 0 );\n\tfor ( ; SPFA (); ) {\n\t\tint MinFlow = 0x7fffffff;\n\t\tfor ( Int i = T; i ^ S; i = Path[i].first ) {\n\t\t\tMinFlow = min ( MinFlow, Graph[Path[i].second].Flow );\n\t\t}\n\t\tfor ( Int i = T; i ^ S; i = Path[i].first ) {\n\t\t\tGraph[Path[i].second].Flow -= MinFlow;\n\t\t\tGraph[Path[i].second ^ 1].Flow += MinFlow;\n\t\t}\n\t\tret.first += MinFlow, ret.second += MinFlow * Dist[T];\n\t}\n\treturn ret;\n}\n\ninline void Work () {\n\tscanf ( \"%d\", &n );\n\tS = 1, T = 2 * n + 2;\n\t// 1: SuperSource   2~n+1: School   n+2~2*n+1: Index    2*n+2: SuperSink\n\tfor ( Int i = 1, m, a, b, k; i <= n; ++ i ) {\n\t\tscanf ( \"%d %d %d %d\", &m, &a, &b, &k );\n\t\tLink ( S, i + 1, 0, 1 ), Link ( i + 1, S, 0, 0 );\n\t\tfor ( Int j = a; j <= b; ++ j ) {\n\t\t\tLink ( i + 1, 1 + n + j, Abs ( j - m ) * k, 1 );\n\t\t\tLink ( 1 + n + j, i + 1, -Abs ( j - m ) * k, 0 );\n\t\t}\n\t}\n\tfor ( Int i = 1; i <= n; ++ i ) {\n\t\tLink ( 1 + n + i, T, 0, 1 );\n\t\tLink ( T, 1 + n + i, 0, 0 );\n\t}\n\tpii Ans = EK ();\n\tif ( Ans.first < n ) {\n\t\tputs ( \"NIE\" );\n\t} else {\n\t\tprintf ( \"%d\\n\", Ans.second );\n\t}\n}\n\nint main () {\n\tWork ();\n\treturn 0;\n}\n```",
        "postTime": 1566790473,
        "uid": 123807,
        "name": "Rainybunny",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3440 \u3010[POI2006]SZK-Schools\u3011"
    },
    {
        "content": "\u76f4\u63a5\u5efa\u8fb9\uff0c\u4ee50\u4e3a\u8d85\u7ea7\u6e90\uff0c\u4ee51+2*n\u4e3a\u8d85\u7ea7\u6c47\n\u76f4\u63a5\u8dd1\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\u5373\u53ef\n\u63d0\u9192\u4e00\u4e0b\uff1a\u4e0b\u65b9\u9898\u89e3\u4e0d\u80fd\u76f4\u63a5\u6284\n```\n#include <bits/stdc++.h>\n#define res register int\n#define inf 0x3f3f3f3f\n#define N 20001\n#define M 8000000\nusing namespace std;\nint d[N],pre[N],dis[N],flow[N],per[N],n,m,a,b,cc,tot=1,ans,maxflow,vis[N];\nstruct papa{\n    int w,c,next,to;\n}e[M];\ninline int read()\n{\n    int X=0,w=0; char ch=0;\n    while(!isdigit(ch)) {w|=ch=='-';ch=getchar();}\n    while(isdigit(ch)) X=(X<<3)+(X<<1)+(ch^48),ch=getchar();\n    return w?-X:X;\n}\ninline void add(int x,int y,int we,int cost){\n    e[++tot].next=d[x];\n    d[x]=tot;\n    e[tot].w=we;\n    e[tot].c=cost;\n    e[tot].to=y;\n}\ninline bool spfa(int s,int t){\n    memset(dis,inf,sizeof(dis));\n    memset(vis,0,sizeof(vis));\n    queue<int> l;\n    dis[s]=0;\n    vis[s]=1;\n    flow[s]=inf;\n    l.push(s);\n    while(!l.empty()){\n        int now=l.front();\n        vis[now]=0;\n        l.pop();\n        for(res i=d[now];i;i=e[i].next)\n          if(e[i].w&&dis[e[i].to]>dis[now]+e[i].c){\n          \tdis[e[i].to]=dis[now]+e[i].c;\n          \tflow[e[i].to]=min(flow[now],e[i].w);\n          \tpre[e[i].to]=i;\n          \tif(!vis[e[i].to]){\n          \t\tl.push(e[i].to);\n          \t\tvis[e[i].to]=1;\n              }\n          }\n    }\n    return dis[t]!=inf;\n}\ninline void updata(int s,int t){\n    int x=t;\n    while(x!=s){\n        int i=pre[x];\n        e[i].w-=flow[t];\n        e[i^1].w+=flow[t];\n        x=e[i^1].to;\n    }\n    maxflow+=flow[t];\n    ans+=dis[t]*flow[t];\n}\ninline void EK(int s,int t){\n    while(spfa(s,t))\n      updata(s,t);\n}\nint main(){\n    //n=read();\n    for(res i=1;i<=n;i++){\n        add(0,i,1,0);\n        add(i,0,0,0);\n    }\n    for(res i=1;i<=n;i++){\n        m=read(),a=read(),b=read(),cc=read();\n        for(res j=a;j<=b;j++)\n          add(i,n+j,1,abs(j-m)*cc),add(n+j,i,0,-abs(j-m)*cc);\n    }\n    for(res i=1;i<=n;i++)\n      add(i+n,1+(n<<1),1,0),add(1+(n<<1),i+n,0,0);\n    EK(0,1+(n<<1));\n    if(maxflow==n)\n      printf(\"%d\\n\",ans);\n    else\n      printf(\"NIE\\n\");\n}\n```",
        "postTime": 1530772667,
        "uid": 26848,
        "name": "miaokehao",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3440 \u3010[POI2006]SZK-Schools\u3011"
    }
]
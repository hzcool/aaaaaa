[
    {
        "content": "\u624b\u73a9\u4e00\u4e0b\u53d1\u73b0\u8def\u5f84\u91cd\u5408\u80af\u5b9a\u4e0d\u4f18\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1ji3fyjk.png)\n\n\u4f8b\u5982\u4e0a\u56fe\uff0c\u6211\u4eec\u9009\u62e9 $A \\rightarrow C \\rightarrow B \\rightarrow D$ \u7684\u8def\u5f84\u662f\u4e00\u5b9a\u4e0d\u5982 $A \\rightarrow B \\rightarrow C \\rightarrow D$ \u7684\u3002\n\n\u56e0\u4e3a\u8fd9\u76f8\u5f53\u4e8e\u662f\u6bd4\u8f83 $AC+BD$ \u548c $AB+CD$ \u7684\u5927\u5c0f\u3002\n\n\u663e\u7136 $AC+BD=AE+BE+DE+EC > AB + DC$\u3002\n\n\u90a3\u4e48\u7b54\u6848\u8def\u5f84\u4e00\u5b9a\u662f\u5728\u6700\u9ad8\u70b9\u5de6\u8fb9\u53d6\u4e00\u6bb5\u518d\u5728\u53f3\u8fb9\u53d6\u4e00\u6bb5\uff0c\u7136\u540e\u5faa\u73af\u8fd9\u4e2a\u64cd\u4f5c\u3002\n\n\u81ea\u7136\u60f3\u5230 $\\text{dp}$\u3002\n\n\u8bb0 $f_{i,j,0/1}$ \u8868\u793a\u5f53\u524d\u53d6\u4e86\u6700\u9ad8\u70b9\u5de6\u8fb9 $i$ \u4e2a\u70b9\u4ee5\u53ca\u53f3\u8fb9 $j$ \u4e2a\u70b9\uff0c\u5e76\u4e14\u5f53\u524d\u5728\u5de6\u8fb9/\u53f3\u8fb9\u7684\u6700\u5c0f\u8def\u5f84\u548c\u3002\n\n\u8f6c\u79fb\u662f\u7b80\u5355\u7684\uff0c\u76f4\u63a5\u679a\u4e3e\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2)$\u3002\n\n\u6ce8\u610f\u5230\u70b9\u662f\u9006\u65f6\u9488\u7ed9\u51fa\u7684\uff0c\u5199\u7684\u65f6\u5019\u8981\u6ce8\u610f\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define int long long\n#define vi vector<int>\n#define pb(x) push_back(x)\n#define pii pair<int,int>\n#define lowbit(x) x&-x\nusing namespace std;\nconst int N=1e3+10;\nstruct node{\n\tdouble x,y;\n}a[N];\nstruct point{\n\tint l,r,x;\n}fa[N][N][2];\nint n,m,T;\ndouble f[N][N][2],ans;\ninline int read(){\n\tint s=0,f=0;\n\tchar ch=getchar();\n\twhile(ch>'9'||ch<'0') f|=(ch=='-'),ch=getchar();\n\twhile(ch<='9'&&ch>='0') s=(s<<3)+(s<<1)+(ch^48),ch=getchar();\n\treturn f?-s:s;\n}\ninline bool chmin(double& x,double y){if(x>y) x=y;return (x==y);}\ninline int ex(int x){if(x<=0) x+=n;if(x>n) x-=n;return x;}\ninline double dist(int x,int y){return sqrt((a[x].x-a[y].x)*(a[x].x-a[y].x)+(a[x].y-a[y].y)*(a[x].y-a[y].y));}\nsigned main(){\n\tn=read();\n\tfor(register int i=1;i<=n;++i) cin>>a[i].x>>a[i].y;\n\tdouble maxn=-1e9;\n\tfor(register int i=1;i<=n;++i){\n\t\tif(a[i].y>maxn){\n\t\t\tmaxn=a[i].y;\n\t\t\tm=i;\n\t\t}\n\t}\n\tfor(register int i=0;i<=n;++i) for(register int j=0;j<=n;++j) f[i][j][0]=f[i][j][1]=1e18;\n\tf[0][0][0]=f[0][0][1]=0;\n\tfor(register int len=1;len<n;++len){\n\t\tfor(register int l=0;l<=len;++l){\n\t\t\tint r=len-l;\n\t\t\tif(l&&chmin(f[l][r][0],f[l-1][r][0]+dist(ex(m+l),ex(m+l-1)))) fa[l][r][0]=(point){l-1,r,0};\n\t\t\tif(l&&chmin(f[l][r][0],f[l-1][r][1]+dist(ex(m+l),ex(m-r))))   fa[l][r][0]=(point){l-1,r,1};\n\t\t\tif(r&&chmin(f[l][r][1],f[l][r-1][0]+dist(ex(m-r),ex(m+l))))   fa[l][r][1]=(point){l,r-1,0};\n\t\t\tif(r&&chmin(f[l][r][1],f[l][r-1][1]+dist(ex(m-r),ex(m-r+1)))) fa[l][r][1]=(point){l,r-1,1};\n\t\t}\n\t}\n\tans=1e18;\n\tpoint jump;\n\tfor(register int i=0;i<n;++i){\n\t\tif(f[i][n-i-1][0]<ans){\n\t\t\tans=f[i][n-i-1][0];\n\t\t\tjump=(point){i,n-i-1,0};\n\t\t}\n\t\tif(f[i][n-i-1][1]<ans){\n\t\t\tans=f[i][n-i-1][1];\n\t\t\tjump=(point){i,n-i-1,1};\n\t\t}\n\t}\n\tprintf(\"%lld \",m);\n\tstack<int> s;\n\twhile(jump.l>0||jump.r>0){\n\t\ts.push((jump.x==0?ex(m+jump.l):ex(m-jump.r)));\n\t\tjump=fa[jump.l][jump.r][jump.x];\n\t}\n\twhile(!s.empty()) printf(\"%lld \",s.top()),s.pop();\n\treturn 0;\n}\n```",
        "postTime": 1678339096,
        "uid": 428089,
        "name": "HMZHMZHMZ",
        "ccfLevel": 7,
        "title": "P9119"
    },
    {
        "content": "\u9996\u5148\u6211\u4eec\u9700\u8981\u6ce8\u610f\u5230\u5982\u4e0b\u7ed3\u8bba\uff1a\n\n- \u6700\u4f18\u65b9\u6848\u4e2d\u6ca1\u6709\u4e24\u6761\u7ebf\u6bb5\u76f8\u4ea4\u3002\n\n\u8bc1\u660e\uff1a\u8003\u8651\u4e24\u6761\u8def\u5f84 $A \\to B \\to C \\to D, A \\to C \\to B \\to D$\uff0c\u82e5 $AC, BD$ \u76f8\u4ea4\uff08\u8bbe\u4ea4\u4e8e $P$\uff09\u4f46 $AB, CD$ \u4e0d\u4ea4\uff0c\u5219 $(AB + BC + CD) - (AC + CB + BD) = AB + CD - AC - BD = (AB - AP - BP) + (CD - CP - DP) < 0$\uff0c\u5373\u4e0d\u4ea4\u66f4\u4f18\u3002\n\n\u4e8e\u662f\u6211\u4eec\u500d\u957f\u5e8f\u5217\u540e\u533a\u95f4 dp \u5373\u53ef\u3002\u72b6\u6001\u4e2d\u9700\u8981\u8bb0\u5f55\u533a\u95f4\u4e0e\u4e0a\u4e00\u6b21\u9009\u7684\u5de6\u8fb9\u8fd8\u662f\u53f3\u8fb9\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^2)$\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <stdio.h>\n#include <math.h>\n\nint pre[2007][2007][7], ans[1007];\ndouble x[2007], y[2007], dp[2007][2007][7];\n\ninline double sqr(double n){\n\treturn n * n;\n}\n\ninline double get_dis(int a, int b){\n\treturn sqrt(sqr(x[a] - x[b]) + sqr(y[a] - y[b]));\n}\n\nint main(){\n\tint n, m, k = -1, k_, pos1, pos2;\n\tdouble val = 1e18;\n\tscanf(\"%d\", &n);\n\tm = n * 2;\n\tfor (int i = 1; i <= n; i++){\n\t\tscanf(\"%lf %lf\", &x[i], &y[i]);\n\t\tif (k == -1 || y[k] < y[i]) k = i;\n\t}\n\tk_ = k + n;\n\tfor (int i = n + 1; i <= m; i++){\n\t\tint i_ = i - n;\n\t\tx[i] = x[i_];\n\t\ty[i] = y[i_];\n\t}\n\tfor (int i = 1; i <= m; i++){\n\t\tfor (int j = i; j <= m; j++){\n\t\t\tdp[i][j][0] = dp[i][j][1] = 1e18;\n\t\t}\n\t}\n\tdp[k][k][0] = dp[k_][k_][0] = 0.0;\n\tfor (int i = 2; i <= n; i++){\n\t\tfor (int j = 1, x = i; x <= m; j++, x++){\n\t\t\tdouble p = dp[j + 1][x][0] + get_dis(j, j + 1), q = dp[j + 1][x][1] + get_dis(j, x);\n\t\t\tif (p < q){\n\t\t\t\tdp[j][x][0] = p;\n\t\t\t\tpre[j][x][0] = 0;\n\t\t\t} else {\n\t\t\t\tdp[j][x][0] = q;\n\t\t\t\tpre[j][x][0] = 1;\n\t\t\t}\n\t\t\tp = dp[j][x - 1][0] + get_dis(x, j);\n\t\t\tq = dp[j][x - 1][1] + get_dis(x, x - 1);\n\t\t\tif (p < q){\n\t\t\t\tdp[j][x][1] = p;\n\t\t\t\tpre[j][x][1] = 0;\n\t\t\t} else {\n\t\t\t\tdp[j][x][1] = q;\n\t\t\t\tpre[j][x][1] = 1;\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i = 1, j = n; i <= n; i++, j++){\n\t\tif (val > dp[i][j][0]){\n\t\t\tval = dp[i][j][0];\n\t\t\tpos1 = i;\n\t\t\tpos2 = 0;\n\t\t}\n\t\tif (val > dp[i][j][1]){\n\t\t\tval = dp[i][j][1];\n\t\t\tpos1 = i;\n\t\t\tpos2 = 1;\n\t\t}\n\t}\n\tfor (int i = n, j = pos1, x = pos1 + n - 1, y = pos2; i >= 1; i--){\n\t\tint t = pre[j][x][y];\n\t\tif (y == 0){\n\t\t\tans[i] = j <= n ? j : j - n;\n\t\t\tj++;\n\t\t} else {\n\t\t\tans[i] = x <= n ? x : x - n;\n\t\t\tx--;\n\t\t}\n\t\ty = t;\n\t}\n\tfor (int i = 1; i <= n; i++){\n\t\tprintf(\"%d \", ans[i]);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1678448624,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P9119 \u3010[\u6625\u5b63\u6d4b\u8bd5 2023] \u5723\u8bde\u6811\u3011"
    },
    {
        "content": "\u7b80\u8981\u9898\u610f\uff1a\u5728\u51f8\u5305\u4e0a\u6784\u9020\u4e00\u6761\u4ece\u6700\u9ad8\u70b9 $k$ \u51fa\u53d1\u904d\u5386\u6bcf\u4e2a\u70b9\u7684\u8def\u5f84\u3002\n\n\u51f8\u5305\u53ef\u4ee5\u770b\u505a\u4e00\u4e2a\u73af\uff0c\u5728\u73af\u4e0a\u5904\u7406\u3002\u4e3a\u4e86\u65b9\u4fbf\uff0c\u628a\u73af\u4e0a\u4ece $k$ \u5f00\u59cb\u7684\u5de6\u8fb9\u8bb0\u4e3a\u201c\u5de6\u201d\uff0c\u53f3\u8fb9\u8bb0\u4e3a\u201c\u53f3\u201d\uff0c\u6240\u4ee5\u4e00\u4e2a\u4f4d\u7f6e\u5de6\u8fb9\u7684\u70b9\u7684\u6807\u53f7\u53ef\u80fd\u6bd4\u8fd9\u4e2a\u70b9\u5927\u3002\n\n\u89c2\u5bdf\u4e00\u4e0b\u9898\u76ee\u4e2d\u7ed9\u7684\u56fe\uff0c\u53ef\u4ee5\u53d1\u73b0\uff1a\u5bf9\u4e8e\u4e00\u4e2a\u4ece\u4e00\u8fb9\u4e0b\u6765\u7684\u70b9\uff0c\u4e0d\u80fd\u539f\u8def\u8fd4\u56de\u7684\u4e0a\u53bb\u3002\u6362\u6210\u73af\u4e0a\u7684\u8868\u8ff0\uff0c\u5373\u4e3a\u5411\u5de6\u79fb\u52a8\u6765\u7684\u4e0d\u80fd\u5411\u53f3\u8d70\uff0c\u5411\u53f3\u79fb\u52a8\u6765\u7684\u4e0d\u80fd\u5411\u5de6\u8d70\u3002\n\n\u4e3a\u4ec0\u4e48\uff1f\u56e0\u4e3a\u5982\u679c\u539f\u8def\u8fd4\u56de\u4e00\u5b9a\u4f1a\u589e\u52a0\u65e0\u610f\u4e49\u635f\u8017\u3002\n\n\u6bd4\u8f83\u663e\u7136\u7684\u8d70\u6cd5\u4e3a\u5411\u5de6\u8d70\u7684\u70b9\u5411\u5de6\u8d70\uff0c\u5411\u53f3\u8d70\u7684\u70b9\u5411\u53f3\u8d70\u3002\n\n\u6211\u4eec\u8bbe\u5f53\u524d\u5f80\u5de6\u8d70\u5230\u6807\u53f7 $L$ \u7684\u70b9\uff0c\u5f80\u53f3\u8d70\u5230\u6807\u53f7 $R$ \u7684\u70b9\uff0c\u5176\u4e2d $L$ \u5230 $R$ \u4e4b\u95f4\u7684\u70b9\u90fd\u88ab\u8d70\u8fc7\u3002\n\n\u5982\u679c\u6709\u6ca1\u6709\u88ab\u8d70\u8fc7\u7684\u70b9\uff0c\u90a3\u4e48\u4e00\u5b9a\u4f1a\u56de\u53bb\uff0c\u989d\u5916\u589e\u52a0\u65e0\u610f\u4e49\u635f\u8017\u3002\n\n\u89c2\u5bdf\u53d1\u73b0\u8fd8\u6709\u4e24\u4e2a\u8d70\u6cd5\uff0c\u662f\u4ece $L$ \u8d70\u5230 $R$ \u4ee5\u53ca\u4ece $R$ \u8d70\u5230 $L$\u3002\n\n\u8fd9\u4e24\u4e2a\u8d70\u6cd5\u4e5f\u8981\u6ee1\u8db3\u4e0a\u8ff0\u8981\u6c42\uff0c\u56e0\u4e3a\u5982\u679c\u4e2d\u95f4\u7a7a\u4e86\u4e00\u4e9b\u70b9\u4e00\u5b9a\u662f\u8981\u8d70\u56de\u53bb\u7684\uff0c\u4e5f\u4f1a\u589e\u52a0\u65e0\u610f\u4e49\u635f\u8017\u3002\n\n\u603b\u7ed3\u4e00\u4e0b\uff0c\u8def\u5f84\u4e2d\u4e0d\u80fd\u51fa\u73b0\u4ea4\u70b9\uff0c\u5982\u679c\u51fa\u73b0\u4ea4\u70b9\u4e00\u5b9a\u4e0d\u662f\u6700\u4f18\u7684\u3002\n\n\u8bc1\u660e\u662f\u56db\u8fb9\u5f62\u5bf9\u89d2\u7ebf\u52a0\u4e00\u6761\u8fb9\u7684\u548c\u80af\u5b9a\u5927\u4e8e\u4e09\u6761\u8fb9\u7684\u548c\u3002\n\n\u8003\u8651 dp\uff0c\u56e0\u4e3a\u4e0d\u80fd\u8d70\u56de\u5934\u8def\uff0c\u786e\u4fdd\u4e86\u65e0\u540e\u6548\u6027\u3002\n\n\u5b9a\u4e49 dp \u6570\u7ec4 $f_{i,j,k=0/1}$ \u5176\u4e2d $i$ \u8868\u793a $L$\uff0c$j$ \u8868\u793a $R$\uff0c$k$ \u7ef4\u8868\u793a\u5f53\u524d\u5728\u7684\u70b9\u662f\u5de6\u8fb9\u8fd8\u662f\u53f3\u8fb9\uff0c$0$ \u4e3a\u5de6\u8fb9 $1$ \u4e3a\u53f3\u8fb9\n\n\u8f6c\u79fb\u5c31\u6309\u7167\u4e0a\u9762\u6240\u8bf4\u7684\u56db\u4e2a\u8d70\u6cd5\u66b4\u529b\u8f6c\u79fb\u5373\u53ef\uff0c\u6ce8\u610f\u521d\u503c\u8981\u8bbe\u4e3a\u65e0\u7a77\u5927\u3002\n\n\u4e3a\u4e86\u4fdd\u8bc1\u65e0\u540e\u6548\u6027\uff0c\u91c7\u7528\u7c7b\u4f3c\u533a\u95f4 dp \u7684\u8f6c\u79fb\u5f62\u5f0f\u3002\u5373\u6700\u5916\u5c42\u5faa\u73af\u679a\u4e3e\u5f53\u524d\u4e00\u5171\u8d70\u4e86\u591a\u5c11\u6b65\uff0c\u7136\u540e\u518d\u679a\u4e3e\u5de6\u53f3\u70b9\u3002\n\n\u8fd9\u91cc\u9700\u8981\u8bb0\u5f55\u65b9\u6848\uff0c\u5728\u65b0\u8f6c\u79fb\u6bd4\u5f53\u524d\u8f6c\u79fb\u66f4\u4f18\u7684\u65f6\u5019\u8bb0\u5f55\u4e0b\u4ece\u54ea\u91cc\u8f6c\u79fb\uff0c\u6700\u540e\u4ece\u6700\u4f18\u7ed3\u675f\u72b6\u6001\u5f80\u524d\u63a8\u5373\u53ef\u8f93\u51fa\u65b9\u6848\u3002\n\n\u4e3a\u4e86\u4fdd\u8bc1\u4ee3\u7801\u6e05\u6670\uff0c\u5efa\u8bae\u628a\u8f6c\u79fb\u5c01\u88c5\u5230\u51fd\u6570\u91cc\u9762\u3002\n\n```\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<string>\n#include<cstring>\n#include<algorithm>\n#include<queue>\n#include<stack>\n#include<vector>\n#include<map>\n#include<set>\n#include<bitset>\n#define int long long\nusing namespace std;\ninline int read(){\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();}\n\treturn x*f;\n}\nconst int N=1010;\nconst long double inf=1e18;\nint n,k,L[N][N][2],R[N][N][2],P[N][N][2],id[N][N][2];\nlong double a[N],b[N],f[N][N][2];\nstack<int>st;\nlong double dis(int x,int y){\n\treturn sqrt((a[x]-a[y])*(a[x]-a[y])+(b[x]-b[y])*(b[x]-b[y]));\n}\nint ls(int x){\n\treturn (x-2+n)%n+1;\n}\nint rs(int x){\n\treturn x%n+1;\n}\nint Ls(int x,int k){\n\treturn (x-k-1+n)%n+1;\n}\nint Rs(int x,int k){\n\treturn (x+k-1)%n+1;\n}\nvoid get(int x,int y,int z,int u,int v,int w){\n\tL[x][y][z]=u;\n\tR[x][y][z]=v;\n\tP[x][y][z]=w;\n\tif(z==0)\n\t\tid[x][y][z]=x;\n\telse id[x][y][z]=y;\n}\nvoid push(int x,int y,int z,int u,int v,int w){\n\tint p=0,q=0;\n\tif(z==0)\n\t\tp=x;\n\telse p=y;\n\tif(w==0)\n\t\tq=u;\n\telse q=v;\n\tif(u!=k||v!=k){\n\t\tif(p==k||q==k)\n\t\t\treturn;\n\t}\n\tif(f[x][y][z]<=f[u][v][w]+dis(p,q))\n\t\treturn;\n\tf[x][y][z]=f[u][v][w]+dis(p,q);\n\tget(x,y,z,u,v,w);\n}\nsigned main()\n{\n//\tfreopen(\"tree.in\",\"r\",stdin);\n//\tfreopen(\"tree.out\",\"w\",stdout);\n\tn=read();\n\tfor(int i=1;i<=n;i++)\n\t\tcin>>a[i]>>b[i];\n\tlong double res=-inf;\n\tfor(int i=1;i<=n;i++)\n\t\tif(b[i]>res){\n\t\t\tk=i;\n\t\t\tres=b[i];\n\t\t}\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tf[i][j][0]=f[i][j][1]=inf;\n\tf[k][k][0]=f[k][k][1]=0;\n\tpush(ls(k),k,0,k,k,0);\n\tpush(k,rs(k),1,k,k,0);\n\tfor(int len=2;len<n;len++)\n\t\tfor(int p=0;p<=len;p++){\n\t\t\tint q=len-p;\n\t\t\tint x=Ls(k,p),y=Rs(k,q);\n\t\t\tif(p)push(x,y,0,rs(x),y,0);\n\t\t\tif(p)push(x,y,0,rs(x),y,1);\n\t\t\tif(q)push(x,y,1,x,ls(y),0);\n\t\t\tif(q)push(x,y,1,x,ls(y),1);\n\t\t}\n\tint u=0,v=0,w=0;\n\tint len=n-1;\n\tres=inf;\n\tfor(int p=0;p<=len;p++){\n\t\tint q=len-p;\n\t\tint i=Ls(k,p),j=Rs(k,q);\n\t\tif(f[i][j][0]<res){\n\t\t\tres=f[i][j][0];\n\t\t\tu=i,v=j,w=0;\n\t\t}\n\t\tif(f[i][j][1]<res){\n\t\t\tres=f[i][j][1];\n\t\t\tu=i,v=j,w=1;\n\t\t}\n\t}\n\twhile(1){\n\t\tif(u==k&&v==k)\n\t\t\tbreak;\n\t\tst.push(id[u][v][w]);\n\t\tint x=L[u][v][w],y=R[u][v][w],z=P[u][v][w];\n\t\tu=x,v=y,w=z;\n\t}\n\tcout<<k<<' ';\n\twhile(!st.empty()){\n\t\tcout<<st.top()<<' ';\n\t\tst.pop();\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1678360655,
        "uid": 253738,
        "name": "\u542c\u53d6MLE\u58f0\u4e00\u7247",
        "ccfLevel": 7,
        "title": "P9119 \u9898\u89e3"
    },
    {
        "content": "# [LG-P9119 [\u6625\u5b63\u6d4b\u8bd5 2023] \u5723\u8bde\u6811](https://www.luogu.com.cn/problem/P9119) Solution\n\n[TOC]\n\n## [\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\u6233\u6b64\u8fdb\u5165](http://blog.tsawke.com?t=LG-P9119-Solution)\n\n## [\u6e38\u8bb0\u6233\u6b64\u8fdb\u5165](https://www.luogu.com.cn/blog/tsawke/spring-test)\n\n### \u9898\u9762\n\n\u7ed9\u5b9a\u5e73\u9762\u5185\u51f8\u5305\uff0c\u6700\u5c0f\u5316\u4ece\u5176\u6700\u9ad8\u70b9\u5f00\u59cb\u7684\u4efb\u610f\u54c8\u5bc6\u5c14\u987f\u8def\u5f84\uff08\u8ba4\u4e3a\u4efb\u610f\u4e24\u70b9\u4e4b\u95f4\u5747\u53ef\u5230\u8fbe\uff09\u7684\u6b27\u51e0\u91cc\u5f97\u8ddd\u79bb\uff0c\u8f93\u51fa\u6700\u5c0f\u5316\u7684\u65b9\u6848\u3002\u5b58\u5728 SPJ\u3002\n\n### Solution\n\n\u9996\u5148\u5bf9\u4e8e $ n \\le 18 $\uff0c\u4e0d\u96be\u53d1\u73b0\u5176\u4e3a\u7ecf\u5178\u7684 TSP \u95ee\u9898\uff0c\u72b6\u538b\u540e\u7b80\u5355\u8f6c\u79fb\u4e00\u4e0b\u5373\u53ef\u3002\u5bf9\u4e8e\u6027\u8d28 B\uff0c\u987a\u5e8f\u8f93\u51fa\u5373\u53ef\u3002\u5bf9\u4e8e\u6027\u8d28 A\uff0c\u76ee\u524d\u6ca1\u60f3\u5230\u4ec0\u4e48\u6b63\u786e\u7684\u601d\u8def\u3002\n\n\u8003\u8651\u6b63\u89e3\uff0c\u53d1\u73b0\u5bf9\u4e8e\u4efb\u610f\u4e24\u6761\u8def\u5f84\u4e00\u5b9a\u4e0d\u76f8\u4ea4\uff0c\u8bc1\u660e\u662f\u663e\u7136\u7684\uff0c\u8003\u8651\u4efb\u610f\u56db\u4e2a\u70b9\uff1a\n\n![2023_03_06_1](https://cdn.luogu.com.cn/upload/image_hosting/wr84lzfd.png)\n\n\u663e\u7136\u7531\u4e8e\u4e09\u89d2\u5f62\u4e24\u8fb9\u4e4b\u548c\u5927\u4e8e\u7b2c\u4e09\u8fb9\uff0c\u524d\u8005\u4e00\u5b9a\u4f18\u4e8e\u540e\u8005\u3002\n\n\u6240\u4ee5\u5bf9\u4e8e\u9006\u65f6\u9488\u7ed9\u5b9a\u7684\u82e5\u5e72\u4e2a\u70b9\uff0c\u5f53\u5904\u4e8e $ i $ \u65f6\uff0c\u6700\u4f18\u51b3\u7b56\u4e00\u5b9a\u53ea\u80fd\u662f\u4e0b\u4e00\u6b65\u5230 $ i - 1 $ \u6216 $ i + 1 $\uff0c\u5426\u5219\u5c06\u4f1a\u5b58\u5728\u4e00\u4e2a\u70b9\u88ab\u9694\u79bb\uff0c\u5bfc\u81f4\u6700\u7ec8\u53bb\u5f80\u8be5\u70b9\u65f6\u4e00\u5b9a\u5f62\u6210\u4ea4\u53c9\u8def\u5f84\u3002\n\n\u4e8e\u662f\u6b64\u65f6\u95ee\u9898\u663e\u7136\u5730\u8f6c\u5316\u4e3a\u4e86\u533a\u95f4 DP\uff0c\u8003\u8651\u5c06\u539f\u5e8f\u5217\u500d\u957f\uff0c\u8bbe\u72b6\u6001 $ dp(l, r, 0/1) $ \u8868\u793a\u5f53\u524d\u5df2\u7ecf\u8d70\u8fc7\u4e86 $ [l, r] $ \u7684\u70b9\uff0c\u4e14\u6700\u540e\u505c\u5728\u4e86 $ l $ \u6216 $ r $ \u7684\u6700\u5c0f\u7684\u603b\u8ddd\u79bb\uff0c\u5219\u663e\u7136\u5bf9\u4e8e\u8d77\u70b9 $ s $ \u6709 $ dp(s, s, 0) = 0, dp(s, s, 1) = 0 $\u3002\n\n\u8f6c\u79fb\u4e5f\u5341\u5206\u663e\u7136\uff0c\u4e0e [[ABC273F] Hammer 2](https://www.luogu.com.cn/problem/AT_abc273_f) \u7c7b\u4f3c\uff0c\u5373\uff1a\n$$\ndp(l, r, 0) = \\min(dp(l + 1, r, 0) + dis(l + 1, l), dp(l + 1, r, 1) + dis(r, l)\n$$\n\n$$\ndp(l, r, 1) = \\min(dp(l, r - 1, 0) + dis(l, r), dp(l, r - 1, 1) + dis(r - 1, r))\n$$\n\n### Code\n\n```cpp\n#define _USE_MATH_DEFINES\n#include <bits/stdc++.h>\n\n#define PI M_PI\n#define E M_E\n#define npt nullptr\n#define SON i->to\n#define OPNEW void* operator new(size_t)\n#define ROPNEW void* Edge::operator new(size_t){static Edge* P = ed; return P++;}\n#define ROPNEW_NODE void* Node::operator new(size_t){static Node* P = nd; return P++;}\n\nusing namespace std;\n\nmt19937 rnd(random_device{}());\nint rndd(int l, int r){return rnd() % (r - l + 1) + l;}\nbool rnddd(int x){return rndd(1, 100) <= x;}\n\ntypedef unsigned int uint;\ntypedef unsigned long long unll;\ntypedef long long ll;\ntypedef long double ld;\n\ntemplate < typename T = int >\ninline T read(void);\n\nint N;\npair < ld, ld > pts[2100];\nld dis[2100][2100];\nld dp[2100][2100][2];\ntuple < int, int, int > frm[2100][2100][2];\nint top(-1); ld topy(-1e8);\n\nint main(){\n    auto CalDis = [](pair < ld, ld > a, pair < ld, ld > b)->ld{\n        return sqrt((a.first - b.first) * (a.first - b.first) + (a.second - b.second) * (a.second - b.second));\n    };\n    auto Update = [](int l, int r, int k, int sl, int sr, int sk, int dl, int dr)->void{\n        if(dp[sl][sr][sk] >= 1e12)return;\n        if(dp[sl][sr][sk] + dis[dl][dr] < dp[l][r][k])\n            dp[l][r][k] = dp[sl][sr][sk] + dis[dl][dr], frm[l][r][k] = {sl, sr, sk};\n    };\n\n    for(int i = 0; i <= 2010; ++i)for(int j = 0; j <= 2010; ++j)for(int k = 0; k <= 1; ++k)dp[i][j][k] = 1e12;\n    N = read();\n    for(int i = 1; i <= N; ++i){\n        scanf(\"%Lf%Lf\", &pts[i].first, &pts[i].second);\n        pts[i + N] = pts[i];\n        if(pts[i].second > topy)topy = pts[i].second, top = i;\n    }\n    for(int i = 1; i <= N; ++i)for(int j = 1; j <= N; ++j)\n        dis[i][j] = dis[i + N][j] = dis[i][j + N] = dis[i + N][j + N] = CalDis(pts[i], pts[j]);\n    dp[top][top][0] = dp[top][top][1] = dp[top + N][top + N][0] = dp[top + N][top + N][1] = 0.0;\n    for(int len = 2; len <= N; ++len)\n        for(int l = 1; l <= (N << 1) - len + 1; ++l){\n            int r = l + len - 1;\n            Update(l, r, 0, l + 1, r, 0, l + 1, l);\n            Update(l, r, 0, l + 1, r, 1, r, l);\n            Update(l, r, 1, l, r - 1, 0, l, r);\n            Update(l, r, 1, l, r - 1, 1, r - 1, r);\n        }\n    ld ansv(1e12); tuple < int, int, int > curp(0, 0, 0);\n    for(int l = 1; l < N; ++l){\n        int r = l + N - 1;\n        if(dp[l][r][0] < ansv)ansv = dp[l][r][0], curp = {l, r, 0};\n        if(dp[l][r][1] < ansv)ansv = dp[l][r][1], curp = {l, r, 1};\n    }\n    basic_string < int > rans;\n    auto [l, r, k] = curp;\n    auto lst = curp; curp = frm[l][r][k];\n    while(get < 0 >(curp)){\n        auto [l, r, k] = lst;\n        auto [cl, cr, ck] = curp;\n        if(l != cl)rans += l;\n        else rans += r;\n        lst = curp;\n        curp = frm[cl][cr][ck];\n    }rans += get < 0 >(lst);\n    for_each(rans.rbegin(), rans.rend(), [rans](auto val)->void{printf(\"%d%c\", val > N ? val - N : val, val == *prev(rans.rend()) ? '\\n' : ' ');});\n    fprintf(stderr, \"Time: %.6lf\\n\", (double)clock() / CLOCKS_PER_SEC);\n    return 0;\n}\n\ntemplate < typename T >\ninline T read(void){\n    T ret(0);\n    int flag(1);\n    char c = getchar();\n    while(c != '-' && !isdigit(c))c = getchar();\n    if(c == '-')flag = -1, c = getchar();\n    while(isdigit(c)){\n        ret *= 10;\n        ret += int(c - '0');\n        c = getchar();\n    }\n    ret *= flag;\n    return ret;\n}\n```\n\n## UPD\n\nupdate-2023_03_06 \u521d\u7a3f",
        "postTime": 1678365677,
        "uid": 362938,
        "name": "Tsawke",
        "ccfLevel": 6,
        "title": "LG-P9119 [\u6625\u5b63\u6d4b\u8bd5 2023] \u5723\u8bde\u6811 \u9898\u89e3"
    },
    {
        "content": "[$\\text{Link}$](https://www.luogu.com.cn/problem/P9119)\n\n## \u9898\u610f\n\u7ed9\u4f60\u4e00\u4e2a\u5e73\u9762\u4e0a\u7684 $n$ \u4e2a\u70b9\u7684\u51f8\u5305\uff0c\u6c42 TSP \u8def\u7ebf\uff0c\u5373\u4ece\u6700\u9ad8\u70b9\u51fa\u53d1\u5e76\u904d\u5386\u6240\u6709\u70b9\u7684\u6700\u77ed\u7684\u8def\u5f84\u3002\n\n$n\\le 1000$\u3002\n## \u601d\u8def\n\u7ed3\u8bba\uff1a\u8def\u7ebf\u4e0d\u4f1a\u4ea4\u53c9\u3002\n\n\u8bc1\u660e\uff1a\u56e0\u4e3a\u51f8\u56db\u8fb9\u5f62\u5bf9\u89d2\u7ebf\u957f\u5ea6\u548c\u4e00\u5b9a\u5927\u4e8e\u4e00\u7ec4\u5bf9\u8fb9\u7684\u957f\u5ea6\u548c\uff0c\u6240\u4ee5\u5982\u679c $(i,j)$ \u4e0e $(a,b)$ \u4ea4\u53c9\uff0c\u6211\u4eec\u5c06\u8fd9\u4e24\u6761\u5206\u522b\u66f4\u6362\u4e3a $(i,a)$ \u548c $(j,b)$ \u7b54\u6848\u4e00\u5b9a\u53d8\u5c0f\u3002\n\n\u5bf9\u4e8e\u968f\u610f\u4e00\u6761\u8def\u5f84\uff0c\u6211\u4eec\u4f7f\u7528\u8c03\u6574\u6cd5\uff0c\u6bcf\u6b21\u968f\u4fbf\u9009\u4e00\u7ec4\u4ea4\u53c9\u7684\u8fb9\u8c03\u6574\u81f3\u4e0d\u4ea4\u53c9\uff0c\u4e00\u5b9a\u53ef\u4ee5\u8c03\u6574\u5230\u6574\u6761\u8def\u5f84\u4e0d\u4ea4\u53c9\u3002\u56e0\u4e3a\u6bcf\u6b21\u8c03\u6574\u90fd\u4f1a\u4f7f\u8def\u5f84\u957f\u5ea6\u53d8\u77ed\uff0c\u6240\u4ee5\u8c03\u6574\u6b21\u6570\u6709\u9650\u5e76\u4e0d\u4f1a\u8c03\u6574\u56de\u4e4b\u524d\u7684\u72b6\u6001\u3002\n\n\u6211\u4eec\u4ece\u6700\u9ad8\u70b9\u5f00\u59cb\u6309\u987a\u65f6\u9488\u7ed9\u6bcf\u4e2a\u70b9\u91cd\u65b0\u7f16\u53f7\uff0c\u4e3a\u4e86\u65b9\u4fbf\uff0c$0$ \u53f7\u548c $n$ \u53f7\u70b9\u90fd\u662f\u6700\u9ad8\u70b9\u3002\u7531\u4e8e\u8def\u7ebf\u4e0d\u4f1a\u4ea4\u53c9\uff0c\u6240\u4ee5\u65f6\u65f6\u523b\u523b\u6ca1\u6709\u88ab\u904d\u5386\u8fc7\u7684\u7ed3\u70b9\u7684\u65b0\u7f16\u53f7\u90fd\u662f\u4e00\u6bb5\u8fde\u7eed\u7684\u533a\u95f4\u3002\n\n\u8003\u8651\u8bbe\u8ba1 dp\uff0c\u4ee4 $f_{l,r,0/1}$ \u8868\u793a $[l+1,r-1]$ \u8fd8\u6ca1\u6709\u88ab\u904d\u5386\uff0c\u4e0a\u4e00\u4e2a\u904d\u5386\u7684\u7ed3\u70b9\u662f $l/r$ \u65f6\u7684\u6700\u77ed\u8def\u5f84\u3002\n\n\u521d\u59cb\u72b6\u6001 $f_{0,n,0}=f_{0,n,1}=0$\uff0c\u4e00\u6b21\u8f6c\u79fb\u5c31\u662f $f_{l,r,0}=\\min(f_{l-1,r,0}+\\text{dis}(l-1,l),f_{l-1,r,1}+\\text{dis}(l,r))$\uff0c$f_{l,r,1}=\\min(f_{l,r+1,0}+\\text{dis}(l,r),f_{l,r+1,1}+\\text{dis}(r,r+1))$\u3002\n\n\u8981\u8f93\u51fa\u65b9\u6848\u5c31\u8bb0\u5f55\u4e00\u4e0b\u51b3\u7b56\u5c31\u597d\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2)$\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define ld long double\nnamespace IO{//by cyffff\n\t\n}\nconst int N=1e3+10;\nconst ld INF=1e18;\nint n,k,g[N][N][2],p[N];\nld px[N],py[N],f[N][N][2];\ninline ld sqr(ld x){\n\treturn x*x;\n}\ninline ld dis(int x,int y){\n\treturn sqrt(sqr(px[p[x]]-px[p[y]])+sqr(py[p[x]]-py[p[y]]));\n}\ninline void answer(int l,int r,int t){\n\tif(l<0||r>n) return ;\n\tif(t==0){\n\t\tif(g[l][r][0]) answer(l-1,r,1);\n\t\telse answer(l-1,r,0);\n\t}else{\n\t\tif(g[l][r][1]) answer(l,r+1,1);\n\t\telse answer(l,r+1,0);\n\t}\n\twrite(t?p[r]:p[l]),putc(' ');\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tld tmp=-INF;\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%Lf %Lf\",px+i,py+i);\n\t\tif(py[i]>tmp) tmp=py[i],k=i;\n\t}\n\tfor(int i=k;i<=n;i++)\n\t\tp[i-k]=i;\n\tfor(int i=1;i<=k;i++)\n\t\tp[i+n-k]=i;\n\tfor(int l=0;l<=n;l++)\n\t\tfor(int r=l;r<=n;r++)\n\t\t\tf[l][r][0]=f[l][r][1]=INF;\n\tf[0][n][0]=f[0][n][1]=0;\n\tfor(int l=0;l<=n;l++)\n\t\tfor(int r=n;r>l+1;r--){\n\t\t\tld LL=f[l][r][0]+dis(l,l+1),LR=f[l][r][1]+dis(r,l+1);\n\t\t\tif(LL<LR) f[l+1][r][0]=LL;\n\t\t\telse f[l+1][r][0]=LR,g[l+1][r][0]=1;\n\t\t\tld RL=f[l][r][0]+dis(l,r-1),RR=f[l][r][1]+dis(r,r-1);\n\t\t\tif(RL<RR) f[l][r-1][1]=RL;\n\t\t\telse f[l][r-1][1]=RR,g[l][r-1][1]=1;\n\t\t}\n\tld ans=INF;\n\tint pos=0,qwq=0;\n\tfor(int i=0;i<n;i++)\n\t\tfor(int j=0;j<=1;j++){\n\t\t\tif(f[i][i+1][j]<ans){\n\t\t\t\tans=f[i][i+1][j];\n\t\t\t\tpos=i,qwq=j;\n\t\t\t}\n\t\t}\n\tanswer(pos,pos+1,qwq);\n\tflush();\n}\n```\n",
        "postTime": 1678168043,
        "uid": 365127,
        "name": "cyffff",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P9119\u3010[\u6625\u5b63\u6d4b\u8bd5 2023] \u5723\u8bde\u6811\u3011"
    },
    {
        "content": "~~\u672c\u4eba\u8003\u8bd5\u65f6\u5019\u7adf\u7136\u6ca1\u6709 A \u6b64\u9898~~\n\n\u8fd9\u9898\u975e\u6b63\u89e3\u5206\u5f88\u9ad8\uff0c\u4f7f\u7528\u66b4\u529b\u52a0\u51cf\u679d~~\u5361\u5e38~~\u3001\u8fd8\u6709\u6570\u636e\u70b9\u5206\u6cbb\u5c31\u6709 80 \u5206\uff0c\u4e0d\u518d\u591a\u8bf4\u3002\n\n## \u6b63\u89e3\uff1a\u533a\u95f4 DP\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u9898\u76ee\u7ed9\u51fa\u7684\u662f\u4e00\u4e2a\u51f8\u591a\u8fb9\u5f62\uff0c\u89c2\u5bdf\u53d1\u73b0\uff08\u81ea\u5df1\u753b\uff0c\u4e0d\u8981\u88ab\u90a3\u4e2a~~\u753b\u5f97\u53c8\u957f\u53c8\u81ed~~\u9898\u76ee\u4e2d\u7684\u56fe\u8bef\u5bfc\uff09\u73b0\u5728\u9009\u53d6\u7684\u70b9\u96c6\u4e00\u5b9a\u662f\u4e00\u6bb5\u8fde\u7eed\u7684\u70b9\uff08\u6362\u53e5\u8bdd\u8bf4\uff0c\u4e0d\u53ef\u80fd\u51fa\u73b0 $i$,$j$ \u4f7f\u5f97\u4e2d\u95f4\u7684\u70b9\u90fd\u9009\u4e86\uff0c\u800c $i$ \u524d\u9762\u7684\u548c $j$ \u540e\u9762\u7684\u70b9\u6ca1\u6709\u9009\uff0c\u7136\u800c\u9876\u70b9\u4e0d\u518d $i$,$j$ \u4e4b\u95f4\uff09\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4f7f\u7528\u533a\u95f4 DP \u4e86\u3002\n\n\u5b9a\u4e49 $dp_{i,j,k}$ \u4e3a\u5df2\u7ecf\u8d70\u4e86 $i$,$j$ \u4e4b\u95f4\u7684\u70b9\u4e86\uff0c\u6700\u540e\u505c\u5728\u4e86 $i$\uff08$k=0$\uff09\uff0c\u8fd8\u662f $j$\uff08$k=1$\uff09\u3002\n\n\u4e3a\u4ec0\u4e48\u8fd9\u4e2a\u9898\u76ee\u6211\u8c03\u8bd5\u4e86\u597d\u51e0\u4e2a\u6708\u5462\uff1f\u56e0\u4e3a\u8981\u8bb0\u5f55\u8def\u5f84\u3002\n\n\u8fd9\u91cc\u5b9a\u4e49 $bfr_{i,j,k}$\uff0c\u7528\u4e8e\u8bb0\u5f55\u8c01\u8f6c\u6362\u5230\u4e86 $dp_{i,j,k}$\uff0c\u56e0\u4e3a\u53ea\u6709 $4$ \u79cd\u53ef\u80fd\u6765\u8f6c\u6362\u5230\u4e00\u4e2a\u70b9\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528\u4e00\u4e2a $bfr$ \u6570\u7ec4\u8bb0\u5f55\uff0c\u6700\u540e\u6309\u7740 $bfr$ \u201c\u56de\u6eaf\u201d \u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u56db\u79cd\u8f6c\u79fb\u65b9\u6cd5\uff1a\n```\n   ----------\n     i     j\n0\uff1a  -------!\n1\uff1a        -!\n2\uff1a !-\n3\uff1a !-------\n```\n\n\u6838\u5fc3\u4ee3\u7801\uff08\u534a\u4f2a\u4ee3\u7801\uff09\uff1a\n```cpp\nfor (int i : T~T+1)\n{\n    for (int j = T~T-1)\n    {\n        dp[T][T][0] = dp[T][T][1] = 0;\n        double now_0 = dp[i][j][0] + len(i,nxt(j));\n        double now_1 = dp[i][j][1] + len(j,nxt(j));\n        double now_2 = dp[i][j][0] + len(i,bf(i));\n        double now_3 = dp[i][j][1] + len(j,bf(i));\n        if (i == T && j != T)\n        {\n            now_0 = now_2 = inf;\n        }\n        if (j == T && i != T)\n        {\n            now_1 = now_3 = inf;\n        }\n        if (dp[i][nxt(j)][1] > now_0)\n        {\n            //\u66f4\u65b0\n            bfr[i][nxt(j)][1] = 0;\n        }\n        if (dp[i][nxt(j)][1] > now_1)\n        {\n            //\u66f4\u65b0\n            bfr[i][nxt(j)][1] = 1;\n        }\n        if (dp[bf(i)][j][0] > now_2)\n        {\n            //\u66f4\u65b0\n            bfr[bf(i)][j][0] = 2;\n        }\n        if (dp[bf(i)][j][0] > now_3)\n        {\n            //\u66f4\u65b0\n            bfr[bf(i)][j][0] = 3;\n        }\n    }\n}\n```",
        "postTime": 1683783000,
        "uid": 377873,
        "name": "EricWan",
        "ccfLevel": 6,
        "title": "\u5723\u8bde\u6811"
    }
]
[
    {
        "content": "\u9996\u5148\uff0c\u6211\u4eec\u91c7\u7528\u6b63\u5411\u9012\u63a8\u3002\n\u628a $2\\times 3 $ \u4e0e $3 \\times 2$ \u7684\u82af\u7247\u5206\u522b\u8868\u793a\u4e3a\uff1a\n$$\\text{ 2            2  }$$\n\n\n$$\\text{ 1             1 }$$  \n\n\n$$\\text{ 0             0 }$$\n\n\n\u4e0e\n\n$$\\text{ 1       1      1 }$$ \n\n$$\\text{ 0       0      0 }$$\n\n\u8003\u8651\u7b2c $i+1$ \u884c\u7684\u72b6\u6001\uff08\u4e09\u8fdb\u5236\u6570\uff09\u3002\u9700\u8981\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a\n1. \u7b2c $i$ \u884c\u7b2c $j$ \u4f4d\u4e3a $2$ \u65f6\uff0c\u7b2c $i+1$ \u884c\u7b2c $j$ \u4f4d\u586b $1$\u3002\n2. \u7b2c $i$ \u884c\u7b2c $j$ \u4f4d\u4e3a $1$ \u65f6\uff0c\u7b2c $i+1$ \u884c\u7b2c $j$ \u4f4d\u586b $0$\u3002\n3. \u5fc5\u987b\u8fde\u7eed\u586b\u5b8c\u4e00\u6574\u4e2a\u82af\u7247\n\n\u56e0\u4e3a\u8f6c\u79fb\u65b9\u7a0b\u96be\u4ee5\u5199\u51fa\uff0c\u6211\u4eec\u9009\u62e9**\u884c\u5185**\u8fdb\u884c dfs \u5224\u65ad\u8f6c\u79fb\u3002\n\n\u8fd9\u91cc\u518d\u8865\u5145\u4e00\u4e0b\u7b2c\u4e00\u7bc7\u9898\u89e3\u91cc\u51e0\u4e2a\u6ca1\u8bb2\u6e05\u695a\u7684\u70b9\u3002\n- pos \u4ece $m$ \u5230 $0$\uff0c\u662f\u56e0\u4e3a\u4e09\u8fdb\u5236\u6570\u7684\u6700\u672b\u5c3e\u5bf9\u5e94\u7684\u662f\u5730\u56fe\u7684\u6700\u53f3\u7aef\u3002\n- \u641c\u7d22\u7684\u5f00\u59cb\u8981\u5224\u5b9a\u4e0a\u4e00\u884c\u662f\u5426\u5408\u6cd5\u624d\u80fd\u5f00\u59cb\u672c\u884c\u7684\u641c\u7d22\u3002\n\n\u6211\u7684\u4ee3\u7801\u53d8\u91cf\u4ece $1$ \u5f00\u59cb\uff0c\u53ef\u80fd\u66f4\u9002\u5408\u9605\u8bfb\u3002\n```cpp\nbool wr[160][12];\nint n,m,k;\nint thr[20]= {1,3,9,27,81,243,729,2187,6561,19683,59049};\nint f[2][65536];\nint get(int num,int pos)\n{\n\treturn num%thr[pos]/thr[pos-1];\n}\nbool able(int r,int c,int bef)\n{\n\tif (wr[r][c]==0 && get(bef,m-c+1)==0) return 1;\n\telse return 0;\n}\nint ans=0;\nvoid dfs(int line,int bef,int now,int pos,int cnt)//\u672c\u884c\u4e09\u8fdb\u5236\u6570\u7684\u4f4d\u7f6e,\u82af\u7247\u6570\u91cf\n{\n\tif (pos==0)//\u672c\u884c\u641c\u5b8c\u4e86\n\t{\n\t\tf[line&1][now]=max(f[line&1][now],f[line-1&1][bef]+cnt);\n\t\treturn;\n\t}\n\tint bt=get(bef,pos);//\u4e0a\u4e00\u884c\u8fd9\u4e00\u4f4d\n\tif (bt!=0)\n\t{\n\t\tif (wr[line][m-pos+1]) return;\n\t\tif (bt==2) dfs(line,bef,now*3+1,pos-1,cnt);\n\t\telse if (bt==1) dfs(line,bef,now*3,pos-1,cnt);\n\t}\n\telse\n\t{\n\t\tdfs(line,bef,now*3,pos-1,cnt);\n\t\tif (pos>=2 && able(line,m-pos+1,bef) && able(line,m-pos+2,bef))\n\t\t\tdfs(line,bef,(now*3+2)*3+2,pos-2,cnt+1);\n\t\tif (pos>=3 && able(line,m-pos+1,bef) && able(line,m-pos+2,bef) && able(line,m-pos+3,bef))\n\t\t\tdfs(line,bef,((now*3+1)*3+1)*3+1,pos-3,cnt+1);\n\t}\n}\nint main()\n{\n\tint d;d=read();\n\twhile (--d>=0)\n\t{\n\t\tn=read();m=read();k=read();\n\t\tfor (int i=1; i<=k; ++i)\n\t\t{\n\t\t\twr[read()][read()]=1;\n\t\t}\n\t\tmemset(f,-0x3f,sizeof f);\n\t\tf[0][0]=0;\n\t\tfor (int i=1;i<=n;++i)\n\t\t{\n\t\t\tfor (int j=0;j<thr[m];++j) f[i&1][j]=-0x3f3f3f3f;\n\t\t\tfor (int j=0;j<thr[m];++j)\n\t\t\t{\n\t\t\t\tif (f[i-1&1][j]<0) continue;\n\t\t\t\telse dfs(i,j,0,m,0);\n\t\t\t}\n\t\t}\n\t\tcout<<f[n&1][0]<<endl;\n\t\tmemset(wr,0,sizeof wr);\n\t}\n\tfclose(stdin);\n\tfclose(stdout);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1658842951,
        "uid": 385748,
        "name": "\u6e21\u9e262007",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P7689 [CEOI2002] Bugs Integrated,Inc."
    },
    {
        "content": "> \u5176\u5b9e\uff0c\u52a8\u89c4\u90fd\u662f\u60f3\u660e\u767d\u540e\u8d85\u7b80\u5355 QaQ\n\n\u76f8\u6bd4\u697c\u4e0a\u7684\u9898\u89e3\u6ca1\u7528\u5565\u4f18\u5316\uff0c\u53ef\u80fd\u5b9e\u73b0\u65b9\u6cd5\u4e0d\u5927\u4e00\u6837\u3002\n\n\u7531\u5178\u578b\u7684\u4e00\u9053\u9898\uff1a[\u70ae\u5175\u9635\u5730](https://www.luogu.com.cn/problem/P2704) \u5165\u624b\u3002\u8fd9\u9053\u9898\u5f88\u663e\u7136\u53ef\u4ee5\u8bbe $f[i][j][k]$ \u4ee3\u8868\u5230 $i$ \u884c\u4e3a\u6b62\uff0c$i$ \u884c\u72b6\u6001\u662f $j$\uff0c$i-1$ \u884c\u72b6\u6001\u662f $k$\uff0c\u70ae\u5175\u4e92\u4e0d\u51b2\u7a81\u5927\u6700\u5927\u7b54\u6848\u3002\u8fd9\u6837\u7684\u590d\u6742\u5ea6\u662f\u679a\u4e3e\u9636\u6bb5\u7684 $n$ \u4e58\u72b6\u6001 $2^m*2^m$ \u4e58\u51b3\u7b56\uff0c\u5373\u679a\u4e3e\u4e0a\u9762\u524d\u4e24\u884c\u7684\u72b6\u6001\uff0c\u590d\u6742\u5ea6\u4e3a $O((2^m)^3)$\u3002\u53ea\u662f\u56e0\u4e3a\u6709\u6bcf\u4e00\u884c\u7684\u5408\u6cd5\u72b6\u6001\u5f88\u5c11\uff08\u76f8\u90bb\u4e24\u4e2a\u4e00\u4e2d\u95f4\u81f3\u5c11\u6709\u4e24\u4e2a\u96f6\uff0c\u5927\u6982 $100$ \u4e2a\uff09\uff0c\u8fd9\u6837\u624d\u628a\u590d\u6742\u5ea6\u51cf\u5c11\uff0c\u4ece\u800c\u901a\u8fc7\u8fd9\u4e00\u9898\u3002\n\n\u7136\u800c\u8fd9\u4e00\u7c7b\u95ee\u9898\u6709\u66f4\u666e\u904d\u7684\u4e00\u79cd\u89e3\u6cd5\uff0c\u5c31\u662f\u7528\u66f4\u9ad8\u7684\u8fdb\u5236\u4f4d\uff08\u4e09\u8fdb\u5236\uff09\u8fdb\u884c\u538b\u7f29\uff0c\u5e76\u5b58\u50a8\u66f4\u591a\u7684\u4fe1\u606f\u3002\u6211\u4eec\u89c4\u5b9a\u653e\u70ae\u5175\u7684\u4f4d\u7f6e\u4e3a $2$\uff0c$2$ \u7684\u4e0b\u9762\u5fc5\u987b\u653e $1$\uff0c$1$ \u7684\u4e0b\u9762\u5fc5\u987b\u653e $0$\u3002$0$ \u7684\u4e0b\u9762\u624d\u53ef\u4ee5\u4efb\u610f\u653e\u3002\u8fd9\u6837\u6211\u4eec\u5185\u5b58\u53ef\u4ee5\u7701\u53bb\u4e00\u7ef4\uff0c\u53ea\u7528\u5b58\u5f53\u524d\u7b2c $i$ \u884c\u7684\u72b6\u6001\n\n\u91c7\u7528\u6b63\u5411\u9012\u63a8\u3002\u8003\u8651\u7b2c $i+1$ \u884c\u586b\u4ec0\u4e48\u72b6\u6001\u3002\u9700\u8981\u6ee1\u8db3\uff1a\n\n1. \u7b2c $i$ \u884c\u7b2c $j$ \u4f4d\u4e3a $2$ \u65f6\uff0c\u7b2c $i+1$ \u884c\u7b2c $j$ \u4f4d\u586b $1$\n2. \u7b2c $i$ \u884c\u7b2c $j$ \u4f4d\u4e3a $1$ \u65f6\uff0c\u7b2c $i+1$ \u884c\u7b2c $j$ \u4f4d\u586b $0$\n3. \u5c71\u5730\u4e0d\u80fd\u586b $2$\n4. \u4e00\u4e2a\u683c\u5b50\u586b $2$ \u540e\uff0c\u53f3\u8fb9\u4e24\u4e2a\u683c\u5b50\u4e0d\u80fd\u586b $2$\n\n\u56e0\u4e3a\u8f6c\u79fb\u6bd4\u8f83\u590d\u6742\uff0c\u4e0d\u7528\u5199\u51fa\u8f6c\u79fb\u65b9\u7a0b\uff0c\u76f8\u90bb\u4e24\u884c\u8fdb\u884c $dfs$ \u5373\u53ef\u3002\n\n\u56de\u5230\u8fd9\u9898\uff0c\u6211\u4eec\u5c06 $2*3$ \u548c $3*2$ \u7684\u77e9\u9635\u5206\u522b\u5316\u4e3a\n\n$$2\\quad 2$$\n\n$$1\\quad 1$$\n\n$$0\\quad 0$$\n\n\u548c\n\n$$1\\qquad 1 \\qquad 1$$\n\n$$0\\qquad 0 \\qquad 0$$\n\n\u4e0e\u70ae\u5175\u9635\u5730\u7c7b\u4f3c\uff0c\u91c7\u7528\u6b63\u5411\u9012\u63a8\uff0c\u9700\u8981\u6ee1\u8db3\u5982\u4e0b\u6761\u4ef6\uff1a\n\n1. \u7b2c $i$ \u884c\u7b2c $j$ \u4f4d\u4e0d\u4e3a $0$ \u4e14\u7b2c $i+1$ \u884c\u7b2c $j$ \u4f4d\u5df2\u635f\u574f\uff0c\u8f6c\u79fb\u5931\u8d25\n2. \u7b2c $i$ \u884c\u7b2c $j$ \u4f4d\u4e3a $2$ \u65f6\uff0c\u7b2c $i+1$ \u884c\u7b2c $j$ \u4f4d\u586b $1$\n3. \u7b2c $i$ \u884c\u7b2c $j$ \u4f4d\u4e3a $1$ \u65f6\uff0c\u7b2c $i+1$ \u884c\u7b2c $j$ \u4f4d\u586b $0$\n4. \u5df2\u635f\u574f\u7684\u683c\u5b50\u586b\u96f6\u8df3\u8fc7\n5. \u53ef\u4ee5\u5c1d\u8bd5\u586b\u4e0a\u8fde\u7eed\u4e09\u4e2a $1$ \u6216\u8005\u8fde\u7eed\u4e24\u4e2a $2$\n\n\u8fd9\u6837\u8fd9\u9053\u9898\u5c31\u505a\u5b8c\u4e86\uff0c\u6211\u505a\u7684\u65f6\u5019\uff0c\u60f3\u8fc7\u4e00\u4e2a\u95ee\u9898\uff0c\u5c31\u662f\u4f55\u65f6\u7d2f\u52a0\u7b54\u6848\uff0c\u82e5\u5728\u586b\u8fde\u7eed\u4e24\u4e2a $2$ \u6216\u8005\u8fde\u7eed\u4e09\u4e2a $1$ \u7684\u65f6\u5019\u7d2f\u52a0\uff0c\u90a3\u4e48\u6700\u540e\u4e00\u884c\u586b\u8fde\u7eed\u4e24\u4e2a $2$ \u663e\u7136\u662f\u4e0d\u5408\u6cd5\u7684\uff0c\u82af\u7247\u7684\u4e0b\u534a\u90e8\u5206\u5c31\u8d85\u51fa\u8303\u56f4\u4e86\u3002\u6709\u4e24\u79cd\u89e3\u51b3\u529e\u6cd5\uff0c\u4e00\u79cd\u662f\u5224\u65ad\u4e00\u4e0b\u8fb9\u754c\u6761\u4ef6\uff0c\u6211\u91c7\u7528\u7684\u662f\u53e6\u4e00\u79cd\uff0c\u6b63\u5e38\u505a\uff0c\u53ea\u4e0d\u8fc7\u8ba1\u7b97\u7b54\u6848\u7684\u65f6\u5019\u76f4\u63a5\u7528 $f[n][0]$ \u5373\u53ef\u3002\n\n\u5185\u5b58\u9650\u5236\u5f88\u5c0f\uff0c\u6eda\u52a8\u4e00\u4e0b\u5c31\u884c\uff0c\u6539\u52a8\u4e0d\u5927\u3002\n\n\u653e\u4ee3\u7801\uff0c\u6ce8\u91ca\u5f88\u8be6\u7ec6\uff1a\n\n```cpp\n#include<iostream>\n#include<cstring>\nusing namespace std;\nconst int maxn = 155;\nconst int maxm = 11;\nint a[maxn][maxm];\nint T,n,m,k;\nint f[2][60005];\nint pow[11];\nvoid init(){\n\tpow[0] = 1;\n\tfor (int i = 1; i <= 10; i++) pow[i] = pow[i-1]*3;\n}\nint suan(int x, int pos){ // \u6570 x \u7684\u4e09\u8fdb\u5236\u7b2c pos \u4f4d\u662f\u591a\u5c11 \n\treturn x%pow[pos]/pow[pos-1];\n}\nbool ifok(int x, int pos, int lst){ // \u7b2c x \u884c\u7b2c pos \u4f4d\u662f\u5426\u80fd\u653e \n\tif (!a[x][pos] && !suan(lst,m-pos+1)) return 1; // \u5f53\u524d\u4f4d\u7f6e\u4e0d\u80fd\u635f\u574f\uff0c\u4e0a\u4e00\u884c\u5f53\u524d\u4f4d\u7f6e\u5fc5\u987b\u4e3a\u96f6 \n\treturn 0; \n}\nvoid dfs(int x/*\u8fd9\u662f\u7b2c\u51e0\u884c*/, int lst/*\u4e0a\u4e00\u884c\u7684\u72b6\u6001*/, int now/*\u5f53\u524d\u884c\u641c\u7d22\u5230\u7684\u72b6\u6001*/,  int pos/*\u4ece\u5de6\u5f80\u53f3\u641c\u5230\u7b2c\u4e09\u8fdb\u5236\u51e0\u4f4d*/, int cnt/*\u653e\u4e86\u51e0\u4e2a\u6570\u4e86*/){\n\tif (!pos){ // \u66f4\u65b0\u72b6\u6001 \n\t\t f[x%2][now] = max(f[x%2][now],f[(x-1)%2][lst]+cnt);\n\t\t return;\n\t}\n\tif (suan(lst,pos)){//\u4e0a\u4e00\u884c\u5f53\u524d\u975e\u96f6 \n\t\tif (a[x][m-pos+1]) return;\n\t\tif (suan(lst,pos) == 2) dfs(x,lst,now*3+1,pos-1,cnt);\n\t\telse dfs(x,lst,now*3, pos-1,cnt); \n\t} \n\telse{\n\t\tdfs(x,lst,now*3,pos-1,cnt);//\u4ec0\u4e48\u90fd\u4e0d\u653e\uff0c\u8df3\uff01 \n\t\tif (pos >= 2 && ifok(x,m-pos+1,lst) && ifok(x,m-pos+2,lst)){ //\u5c1d\u8bd5\u653e 3*2 \u7684 \uff08\u7ad6\u7684\uff09 \n\t\t\tdfs(x,lst,(now*3+2)*3+2,pos-2,cnt+1); \n\t\t} \n\t\tif (pos >= 3 &&  ifok(x,m-pos+1,lst) && ifok(x,m-pos+2,lst) && ifok(x,m-pos+3,lst)){ //\u5c1d\u8bd5\u653e 2*3 \u7684 \uff08\u6a2a\u7684\uff09 \n\t\t\tdfs(x,lst,((now*3+1)*3+1)*3+1,pos-3,cnt+1);\n\t\t}\n\t}\n}\nint main(){\n\t//freopen(\"a.in\",\"r\",stdin);\n\tinit();\n\tcin >>T;\n\t\n\twhile (T--){\n\t\t\n\t\tcin >> n >> m >> k;\n\t\tmemset(a,0,sizeof a);\n\t\tfor (int i = 1; i <= k; i++){\n\t\t\tint x,y;\n\t\t\tcin >> x >> y;\n\t\t\ta[x][y] = 1;\n\t\t}\n\t\t\n\t\tmemset(f,-0x3f3f3f3f,sizeof f);\n\t\tf[0][0] = 0;\n\t\tfor (int i = 0; i < n; i++){\n\t\t\tfor (int j = 0; j < pow[m]; j++) f[(i+1)%2][j] = -0x3f3f3f3f;\n\t\t\tfor (int j = 0; j < pow[m]; j++){\n\t\t\t\tif (f[i%2][j] < 0) continue;\n\t\t\t\tdfs(i+1,j,0,m,0);\n\t\t\t}\n\t\t}\n\t\tcout << f[n%2][0] << endl;\n\t}\n\treturn 0;\n}\n```\n\n\n\n\n\n\n\n",
        "postTime": 1652412685,
        "uid": 127682,
        "name": "lg_zhou",
        "ccfLevel": 7,
        "title": "\u72b6\u6001\u538b\u7f29 dp \u89e3\u51b3\u7f51\u683c\u586b\u5145\u95ee\u9898"
    },
    {
        "content": "## P7689\n\n\u63d0\u4f9b\u4e00\u79cd\u4e0d\u592a\u4e00\u6837\u7684\u505a\u6cd5\uff0c\u4e5f\u8bb8\u672c\u8d28\u4e0a\u76f8\u5dee\u4e0d\u591a\uff1f\n\n\u8003\u8651\u5c06\u6bcf\u4e2a\u683c\u5b50\u8868\u793a\u4e3a $6$ \u79cd\u72b6\u6001\uff1a\n\n- $0$\uff0c\u8868\u793a\u8be5\u683c\u5b50\u672a\u88ab\u8986\u76d6\u3002\n\n- $1\\sim 3$\uff0c\u8868\u793a\u8be5\u683c\u5b50\u662f\u67d0\u4e2a $2\\times 3$ \u77e9\u5f62\u4e2d\u7684\u7b2c $1\\sim 3$ \u5217\u3002\n\n- $4\\sim 5$\uff0c\u8868\u793a\u8be5\u683c\u5b50\u662f\u67d0\u4e2a $3\\times 2$ \u77e9\u5f62\u7ec8\u70b9\u7b2c $1\\sim 2$ \u5217\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e\u4e00\u5217\u800c\u8a00\uff0c\u5408\u6cd5\u7684\u72b6\u6001\u9700\u8981\u6ee1\u8db3\uff1a\n\n- \u8fde\u7eed\u4e14\u76f8\u540c\u7684 $1\\sim 3$ \u7684\u4e2a\u6570\u662f $2$ \u7684\u500d\u6570\u3002\n\n- \u8fde\u7eed\u4e14\u76f8\u540c\u7684 $4\\sim 5$ \u7684\u4e2a\u6570\u662f $3$ \u7684\u500d\u6570\u3002\n\n\u5bf9\u4e8e\u53ef\u4ee5\u51fa\u73b0\u5728\u76f8\u90bb\u4e24\u5217\u7684\u72b6\u6001\u800c\u8a00\uff0c\u9700\u8981\u6ee1\u8db3\uff1a\n\n- \u8fd9\u4e24\u5217\u7684\u72b6\u6001\u90fd\u6ee1\u8db3\u4e0a\u9762\u7684\u6761\u4ef6\u3002\n\n- \u5bf9\u4e8e\u6bcf\u4e00\u884c\uff0c\u90fd\u53ef\u4ee5\u4ece\u7b2c\u4e00\u5217\u8f6c\u79fb\u5230\u7b2c\u4e8c\u5217\u3002\uff08\u53ef\u4ee5\u8f6c\u79fb\u7684\u6709 $0\\to 0,0\\to 1,0\\to 4$\uff0c$1\\to 2,2\\to 3$\uff0c$3\\to 0,3\\to 1,3\\to 4$\uff0c$4\\to 5$\uff0c$5\\to 0,5\\to 1,5\\to 4$\u3002\n\n\u641c\u7d22\u51fa\u6bcf\u4e00\u5217\u6240\u6709\u5408\u6cd5\u7684\u72b6\u6001\uff0c\u53ef\u4ee5\u53d1\u73b0\u5728 $m=10$ \u7684\u60c5\u51b5\u4e0b\u4e5f\u53ea\u6709 $5779$ \u79cd\u3002\u518d\u641c\u7d22\u51fa\u8fd9\u4e9b\u72b6\u6001\u4e4b\u95f4\u54ea\u4e9b\u53ef\u4ee5\u51fa\u73b0\u4e3a\u76f8\u90bb\u4e24\u5217\uff0c\u53d1\u73b0\u53ea\u6709 $174881$ \u5bf9\u72b6\u6001\u6ee1\u8db3\u3002\n\n\u4e8e\u662f\uff0c\u8bbe $f_{i,j}$ \u8868\u793a\u8003\u8651\u5230\u7b2c $i$ \u5217\uff0c\u7b2c $i$ \u5217\u72b6\u6001\u4e3a $j$\uff0c\u6309\u4e4b\u524d\u641c\u7d22\u51fa\u7684\u72b6\u6001\u5173\u7cfb\u8f6c\u79fb\u5373\u53ef\u3002\n\n\u6781\u9650\u60c5\u51b5\u4e0b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(174881n)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\nCode\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define pii pair<int,int>\n#define fi first\n#define se second\nusing namespace std;\nconst int N=160,M=11,S=5800,E=174885;\nint T,n,m,K,a[N][M],f[2][S],b[N],c[S],d[S],num[S];\nint sta[S][M],tot,tmp[M],now;\nint fr[E],to[E],cnt;\nvoid dfs(int x)\n{\n\tif(x==m+1)\n\t{\n\t\ttot++;\n\t\tfor(int i=1;i<=m;i++)sta[tot][i]=tmp[i];\n\t\treturn;\n\t}\n\ttmp[++now]=0,dfs(x+1),now--;\n\tif(x+2<=m+1)\n\t{\n\t\tfor(int i=1;i<=3;i++)\n\t\t\ttmp[++now]=i,tmp[++now]=i,dfs(x+2),now-=2;\n\t}\n\tif(x+3<=m+1)\n\t{\n\t\tfor(int i=4;i<=5;i++)\n\t\t\ttmp[++now]=i,tmp[++now]=i,tmp[++now]=i,dfs(x+3),now-=3; \n\t}\n}\nbool chk(int x){return !x||x==3||x==5;}\nunordered_map<int,int>id;\nint p;\nvoid expand(int x,int key)\n{\n\tif(x==m+1)return fr[++cnt]=p,to[cnt]=id[key],void();\n\tif(chk(sta[p][x]))expand(x+1,key*6);\n\tif(x+2<=m+1&&chk(sta[p][x])&&chk(sta[p][x+1]))expand(x+2,(key*6+1)*6+1);\n\tif(x+3<=m+1&&chk(sta[p][x])&&chk(sta[p][x+1])&&chk(sta[p][x+2]))expand(x+3,((key*6+4)*6+4)*6+4);\n\tif(sta[p][x]==1)expand(x+1,key*6+2);\n\tif(sta[p][x]==2)expand(x+1,key*6+3);\n\tif(sta[p][x]==4)expand(x+1,key*6+5);\n}\nint main()\n{\n\tscanf(\"%d\",&T);\n\twhile(T--)\n\t{\n\t\tscanf(\"%d%d%d\",&n,&m,&K);\n\t\tfor(int i=1;i<=n;i++)b[i]=0;\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tfor(int j=1;j<=m;j++)\n\t\t\t\ta[i][j]=1,b[i]|=(1<<j);\n\t\tfor(int i=1,x,y;i<=K;i++)\n\t\t\tscanf(\"%d%d\",&x,&y),a[x][y]=0,b[x]^=(1<<y);\n\t\ttot=0,id.clear(),dfs(1);\n\t\tfor(int i=1;i<=tot;i++)\n\t\t{\n\t\t\tc[i]=num[i]=0;int c1=0,c2=0;\n\t\t\tfor(int j=1;j<=m;j++)\n\t\t\t\tif(sta[i][j])c[i]|=(1<<j);\n\t\t\tfor(int j=1;j<=m;j++)\n\t\t\t\tc1+=(sta[i][j]==3),c2+=(sta[i][j]==5),num[i]=num[i]*6+sta[i][j];\n\t\t\td[i]=c1/2+c2/3,id[num[i]]=i;\n\t\t}\n\t\tcnt=0;\n\t\tfor(int i=1;i<=tot;i++)p=i,expand(1,0);\n\t\tmemset(f,~0x3f,sizeof(f));\n\t\tf[0][1]=0;int ans=0;\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tfor(int j=1;j<=cnt;j++)\n\t\t\t\tif((c[to[j]]&b[i])==c[to[j]])\n\t\t\t\t\tf[i&1][to[j]]=max(f[i&1][to[j]],f[(i&1)^1][fr[j]]+d[to[j]]);\n\t\t\tfor(int j=1;j<=tot;j++)f[(i&1)^1][j]=-1e9,ans=max(ans,f[i&1][j]);\n\t\t}\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1665558355,
        "uid": 333574,
        "name": "Tyyyyyy",
        "ccfLevel": 7,
        "title": "P7689\u53e6\u89e3"
    },
    {
        "content": "\n[\u535a\u5ba2\u56ed\u98df\u7528\u66f4\u4f73](https://www.cnblogs.com/yolanda-yxr/p/16472169.html)\n\n[\u539f\u9898\u94fe\u63a5](https://www.luogu.com.cn/problem/P7689)\n\n## \u9898\u76ee\u5206\u6790\n\n#### \u601d\u8def\n\n\u770b\u5230\u8fd9\u9053\u9898\u7b2c\u4e00\u53cd\u5e94\u662f [\u8499\u5fb7\u91cc\u5b89\u7684\u68a6\u60f3](https://www.acwing.com/problem/content/293/)\uff0c\u5f88\u50cf\uff0c\u53ea\u662f\u8fd9\u9053\u9898\u653e\u7684\u957f\u65b9\u5f62\u5927\u5c0f\u4e0d\u592a\u4e00\u6837\u3002\n\n\u90a3\u9053\u9898\u7684\u4e00\u4e2a\u505a\u6cd5\u662f\u72b6\u538b DP\uff0c\u6bcf\u884c\u72b6\u6001\u4e8c\u8fdb\u5236\u4e2d $1$ \u8868\u793a\u4e00\u4e2a\u9aa8\u724c\u7684\u4e0a\u534a\u90e8\u5206\uff08\u5373\u8fd9\u4e2a\u9aa8\u724c\u4e00\u5b9a\u7ad6\u7740\u653e\uff09\uff0c$0$ \u4ee3\u8868\u5176\u4ed6\u60c5\u51b5\u3002\u6700\u540e\u7b54\u6848\u662f $f_{n,0}$\u3002\n\n\u518d\u770b\u8fd9\u9053\u9898\u6570\u636e\u8303\u56f4\uff0c$M$ \u5f88\u5c0f\uff0c\u516b\u4e5d\u4e0d\u79bb\u5341\u662f\u72b6\u538b DP \u4e86\u3002\u4eff\u7167\u4e0a\u9762\u7684\u505a\u6cd5\uff0c\u4f1a\u53d1\u73b0\u7531\u4e8e\u957f\u65b9\u5f62\u5927\u5c0f\u7684\u539f\u56e0\uff0c\u5355\u7eaf\u7684\u4e8c\u8fdb\u5236\u4f3c\u4e4e\u65e0\u6cd5\u6ee1\u8db3\u6240\u6709\u8981\u6c42\u3002\n\n\u6a2a\u7740\u653e\u53ea\u6709 $2$ \u884c\u53ef\u4ee5\u8868\u793a\uff0c\u4f46\u7ad6\u7740\u653e\u65f6\u5c31\u6709 $3$ \u884c\u3002\u90a3\u53ef\u4ee5\u81ea\u7136\u5730\u60f3\u5230 $3$ \u8fdb\u5236\u3002\n\n\u53ef\u4ee5\u8fd9\u6837\u8868\u793a\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0je4s84i.png)\n\n\u7136\u540e\u53ef\u4ee5\u679a\u4e3e\u6bcf\u4e00\u884c\uff0c\u4ece\u4e0a\u4e00\u884c\u7684\u53ef\u884c\u72b6\u6001\u6765\u8003\u8651\u679a\u4e3e\u8fd9\u4e00\u884c\u7684\u7b26\u5408\u6761\u4ef6\u7684\u6240\u6709\u72b6\u6001\uff0c\u518d\u66f4\u65b0\u3002\n\n---\n\n#### \u679a\u4e3e\u72b6\u6001\u7ec6\u8282\n\n1. \u5982\u679c\u4e0a\u4e00\u884c\u5f53\u524d\u4f4d\u7f6e\u6709\u503c\uff0c\u4f46\u8fd9\u4e2a\u70b9\u4e0d\u80fd\u7528\uff0c\u76f4\u63a5\u8fd4\u56de\u3002\n2. \u5982\u679c\u5f53\u524d\u70b9\u4e0d\u80fd\u7528\uff0c\u4e3a $0$ \u3002\n3. \u5982\u679c\u4e0a\u4e00\u884c\u7684\u5f53\u524d\u4f4d\u7f6e\u975e\u96f6\uff0c\u4e3a\u4e0a\u4e00\u884c\u7684\u503c $-1$ \u3002\n4. \u5982\u679c\u4e0a\u4e00\u884c\u8fd9\u4e2a\u4f4d\u7f6e\u5373\u540e\u9762\u4e24\u4e2a\u4f4d\u7f6e\u90fd\u4e3a\u96f6\uff0c\u4e14\u8fd9\u4e00\u884c\u8fd9\u51e0\u4e2a\u70b9\u90fd\u53ef\u7528\uff0c\u53ef\u4ee5\u4e00\u8d77\u8bbe\u4e3a $1$ \u3002\n5. \u5982\u679c\u4e0a\u4e00\u884c\u8fd9\u4e2a\u4f4d\u7f6e\u5373\u540e\u9762\u4e00\u4e2a\u4f4d\u7f6e\u90fd\u4e3a\u96f6\uff0c\u4e14\u8fd9\u4e00\u884c\u8fd9\u51e0\u4e2a\u70b9\u90fd\u53ef\u7528\uff0c\u53ef\u4ee5\u4e00\u8d77\u8bbe\u4e3a $2$ \u3002\n6. \u8fd9\u4e2a\u4f4d\u7f6e\u4e3a $0$ \u3002\n\n\u5148\u6ee1\u8db3\u524d\u4e09\u4e2a\uff0c\u5982\u679c\u662f\u524d\u4e09\u4e2a\u7684\u4e00\u79cd\uff0c\u641c\u7d22\u5b8c\u76f4\u63a5\u8fd4\u56de\u3002\n\n\u5426\u5219\u679a\u4e3e\u5b8c\u5269\u4e0b\u4e09\u79cd\u60c5\u51b5\u3002\u5177\u4f53\u89c1\u4ee3\u7801\u3002\n\n\u56e0\u4e3a\u7a7a\u95f4\u8303\u56f4\u5f88\u5c0f\uff0c\u6240\u4ee5\u6eda\u52a8\u4e00\u4e0b\u6570\u7ec4\u3002\n\n## Code\n\n```cpp\n#include<bits/stdc++.h>\n//By _yolanda_\nusing namespace std;\n#define int long long\n\nconst int N=6e4+5,INF=1e15;\nint f[2][N],w[200][20];\nint n,m;\nint in[15];\n\ninline int read(){\n\tint sum=0,f=1;char a=getchar();\n\twhile(a<'0' || a>'9'){if(a=='-') \tf=-1;a=getchar();}\n\twhile(a>='0' && a<='9') \tsum=sum*10+a-'0',a=getchar();\n\treturn sum*f;\n}\n\ninline int get(int x,int y){ //\u627e3\u8fdb\u5236\u4e0bx\u7684\u7b2cy\u4f4d\n\tint tmp=in[y];\n\treturn (x/tmp)%3;\n}\nvoid dfs(int x,int y,int no,int pre,int sum){\n\tif(y==m){//\u5230\u8fb9\u754c\uff0c\u66f4\u65b0\n\t\tf[x%2][no]=max(f[(x%2)^1][pre]+sum,f[x%2][no]);\n\t\treturn;\n\t}\n\tint t=get(pre,m-y-1); //\u4e0a\u4e00\u884c\uff0c\u8fd9\u4e2a\u4f4d\u7f6e\u7684\u503c\n\tif(w[x][y+1]){ //\u8fd9\u4e2a\u4f4d\u7f6e\u4e0d\u80fd\u7528\n\t\tif(t)\treturn;\n\t\tdfs(x,y+1,no*3,pre,sum);\n\t}\n\telse if(t){\n\t\tdfs(x,y+1,no*3+t-1,pre,sum);//\u7b2c3\u79cd\u60c5\u51b5\n\t}\n\telse{\n\t\tif(x<n && m-y>=3 && !get(pre,m-y-2) && !get(pre,m-y-3) && !w[x][y+2] && !w[x][y+3]){\n\t\t\tint tmp=no*3+1;tmp=tmp*3+1,tmp=tmp*3+1;\n\t\t\tdfs(x,y+3,tmp,pre,sum+1);\n\t\t}//\u8fde\u7740\u586b3\u4e2a1\n\t\tif(x<n-1 && m-y>=2 && !get(pre,m-y-2) &&!w[x][y+2]){\n\t\t\tint tmp=no*3+2;tmp=tmp*3+2;\n\t\t\tdfs(x,y+2,tmp,pre,sum+1);\n\t\t}//\u8fde\u7740\u586b3\u4e2a2\n\t\tdfs(x,y+1,no*3,pre,sum);//\u586b0\n\t}\n}\n\nsigned main(){\n\t\n\tin[0]=1;\n\tfor(int i=1;i<=10;++i)\tin[i]=in[i-1]*3;\n\tint T,k;T=read();\n\twhile(T--){\n\t\tmemset(w,0,sizeof w);\n\t\tmemset(f,0,sizeof f);\n\t\tn=read(),m=read(),k=read();\n\t\t\n\t\tint tp=pow(3,m);\n\t\tint xx,yy;\n\t\tfor(int i=1;i<=k;++i){\n\t\t\txx=read(),yy=read();\n\t\t\tw[xx][yy]=1;\n\t\t}\n\t\tdfs(1,0,0,0,0);\n\t\tfor(int i=2;i<=n;++i){\n\t\t\tfor(int j=0;j<tp;++j)\tf[i%2][j]=-INF;\n\t\t\tfor(int j=0;j<tp;++j)\n\t\t\t\tif(f[(i-1)%2][j]>=0)\tdfs(i,0,0,j,0);\n\t\t\t\t//\u4e0a\u4e00\u884c\u8fd9\u4e2a\u72b6\u6001\u53ef\u5f97\u5230\u624d\u66f4\u65b0\uff0c\u5426\u5219\u4f1aTLE\n\t\t}\n\t\tprintf(\"%lld\\n\",f[n%2][0]);\n\t}\n\t\n\treturn 0;\n}\n```",
        "postTime": 1657638534,
        "uid": 253532,
        "name": "_yolanda_",
        "ccfLevel": 7,
        "title": "P7689 [CEOI2002] Bugs Integrated,Inc \u9898\u89e3"
    },
    {
        "content": "\u7c7b\u4f3c [P2704 [NOI2001] \u70ae\u5175\u9635\u5730](https://www.luogu.com.cn/problem/P2704) \u8fd9\u9053\u9898\uff0c\u8003\u8651\u7528 $f_{i,j,k}$ \u8868\u793a\u5230\u7b2c $i$ \u884c\uff0c\u8be5\u884c\u7684\u72b6\u6001\u4e3a $j$\uff0c\u7b2c $i-1$ \u884c\u7684\u72b6\u6001\u4e3a $k$ \u7684\u65b9\u6848\u6570\uff0c\u4f46\u662f\u65f6\u95f4\u590d\u6742\u5ea6\u663e\u7136\u4e0d\u5bf9\uff0c\u8003\u8651\u72b6\u6001\u538b\u7f29\u3002\n\n\u6211\u4eec\u53d1\u73b0\u7b2c $i$ \u884c\u7684\u653e\u7f6e\u65b9\u6848\u53ea\u4e0e $(i,j)$ \u662f\u5426\u80fd\u653e\u7f6e\u82af\u7247\u6709\u5173\uff0c\u8003\u8651\u7528\u9ad8\u8fdb\u5236\u6765\u8868\u793a\u72b6\u6001\u3002\n\n\u9996\u5148\u5c06 $(2\\times 3)$ \u548c $(3\\times 2)$ \u7684\u82af\u7247\u5206\u522b\u8868\u793a\u4e3a\uff1a\n\n$$\n\\begin{aligned}\n&1 \\quad 1 \\quad 1\\\\\n&0 \\quad 0 \\quad 0\\\\\n\\end{aligned}\n$$\n\n\u548c\n\n$$\n\\begin{aligned}\n&2 \\quad 2\\\\\n&1 \\quad 1\\\\\n&0 \\quad 0\\\\\n\\end{aligned}\n$$\n\n\u8bbe $a_{i,j}$ \u8868\u793a $(i,j)$ \u6240\u586b\u7684\u503c\uff0c\u90a3\u4e48\u6709\uff1a\n\n1. \u82e5 $a_{i,j}$ \u7684\u503c\u4e3a $2$\uff0c\u5219 $a_{i+1,j}$ \u7684\u503c\u4e3a $1$\u3002\n\n2. \u82e5 $a_{i,j}$ \u7684\u503c\u4e3a $1$\uff0c\u5219 $a_{i+1,j}$ \u7684\u503c\u4e3a $0$\u3002\n\n3. \u82e5 $(i,j)$ \u5df2\u7ecf\u635f\u574f\uff0c\u5219 $a_{i-1,j}=0$\uff0c\u4e14 $a_{i,j}=0$\u3002\n\n\u90a3\u4e48\u4ee5 $(i,j)$ \u4e3a\u5de6\u4e0a\u89d2\u653e\u7f6e\u4e00\u4e2a $2\\times 3$ \u7684\u82af\u7247\u5c31\u662f\u5c06 $a_{i,j}=a_{i,j+1}=a_{i,j+2}=1$\u3001$a_{i+1,j}=a_{i+1,j+1}=a_{i+1,j+2}=0$\u3002\n\n\u4ee5 $(i,j)$ \u4e3a\u5de6\u4e0a\u89d2\u653e\u7f6e\u4e00\u4e2a $3\\times 2$ \u7684\u82af\u7247\u5c31\u662f\u5c06 $a_{i,j}=a_{i,j+1}=2$\u3001$a_{i+1,j}=a_{i+1,j+1}=1$\u3001$a_{i+2,j}=a_{i+2,j+1}=0$\u3002\n\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5bb9\u6613\u5199\u51fa\uff0c\u4f46\u662f\u4e0d\u5bb9\u6613\u9012\u63a8\u5b9e\u73b0\uff0c\u53ef\u4ee5\u8003\u8651 $\\texttt{DFS}$ \u8fdb\u884c\u8f6c\u79fb\u3002\n\n\u7531\u4e8e\u5185\u5b58\u53ea\u6709 $\\texttt{8.00 MB}$\uff0c\u6240\u4ee5\u8981\u7528\u6eda\u52a8\u6570\u7ec4\uff0c\u6ce8\u610f\u72b6\u6001\u8f6c\u79fb\u6570\u7ec4\u7684\u6e05\u7a7a\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing std::cin;    using std::cout;\nusing std::printf; using std::scanf;\ntemplate<typename T> inline void Max(T &x, const T &y){x<y?x=y:0;return;}\nconst int N=3e2+1;\n\nint Pow3[55];\nvoid init_pow_base_3(int tt){\n  Pow3[1]=1;\n  for(int i=2; i<=tt+1; i++)\n    Pow3[i]=Pow3[i-1]*3;\n}\n\nint n, m, K, vis[N][55], f[2][200000];\n\nint getith(int F, int pos){return (F/Pow3[pos])%3;}\nint allow(int I, int F, int Pos){return getith(F, Pos)==0&&vis[I][Pos]==0;}\n\nvoid dfs(int I, int Last, int F, int Pos, int Cnt){\n  if(Pos==m+1) return Max(f[I&1][F], f[(I-1)&1][Last]+Cnt);\n  int L=getith(Last, Pos);\n  if(L!=0){\n    if(vis[I][Pos])return;\n    dfs(I, Last, F+Pow3[Pos]*(L-1), Pos+1, Cnt);\n    return;\n  }\n  else{\n    dfs(I, Last, F, Pos+1, Cnt);\n\n    if(Pos<m&&allow(I, Last, Pos)&&allow(I, Last, Pos+1))\n      dfs(I, Last, F+2*(Pow3[Pos]+Pow3[Pos+1]), Pos+2, Cnt+1);\n\n    if(Pos<m-1&&allow(I, Last, Pos)&&allow(I, Last, Pos+1)&&allow(I, Last, Pos+2))\n      dfs(I, Last, F+1*(Pow3[Pos]+Pow3[Pos+1]+Pow3[Pos+2]), Pos+3, Cnt+1);\n  }\n  return;\n}\nint main(){\n  int T;\n  scanf(\"%d\", &T);\n  init_pow_base_3(11);\n\n  while(T--){\n    scanf(\"%d %d %d\", &n, &m, &K);\n    memset(vis, 0, sizeof vis);\n    for(int i=1, a, b; i<=K; i++)\n      scanf(\"%d %d\", &a, &b), vis[a][b]=1;\n\n    memset(f, -0x3f3f3f3f, sizeof f);\n    f[0][0]=0;\n\n    for(int i=1; i<=n; i++){\n      for(int j=0; j<Pow3[m+1]; j++)\n        f[i&1][j]=-0x3f3f3f3f;\n\n      for(int j=0; j<Pow3[m+1]; j++)\n        if(f[(i-1)&1][j]>=0) dfs(i, j, 0, 1, 0);\n    }\n\n    cout<<f[n&1][0]<<'\\n';\n  }\n  return 0;\n}\n```\n\n",
        "postTime": 1682429525,
        "uid": 740607,
        "name": "__ODT__",
        "ccfLevel": 0,
        "title": "P7689"
    },
    {
        "content": "\u672c\u6587\u540c\u6b65\u53d1\u8868\u4e8e [cnblogs](https://www.cnblogs.com/registergen/p/p7689_solution.html)\u3002\n\n## Solution\n\n\u611f\u8c22\u540c\u5b66\u5bf9\u8fd9\u4e2a\u9898\u7684~~\u7cbe\u5f69~~\u8bb2\u89e3\uff01\n\n\u8bbe $f_{i,S_1,S_2}$ \u8868\u793a\u5904\u7406\u5b8c\u524d $i$ \u884c\uff0c\u7b2c $i+1$ \u884c\u7684\u201c\u7a81\u8d77\u201d\u72b6\u6001\u4e3a $S_1$\uff0c\u7b2c $i+2$ \u884c\u7684\u201c\u7a81\u8d77\u201d\u72b6\u6001\u4e3a $S_2$\u3002\n\n\u8f6c\u79fb\u65f6\uff0c\u6211\u4eec\u8bbe\u7b2c $i$ \u884c\u7684\u72b6\u6001\u4e3a $S$\uff0c\u7b2c $i-1$ \u884c **\u201c\u7a81\u8d77\u201d\u5230\u7b2c $\\bm{i+1}$ \u884c** \u7684\u72b6\u6001\u4e3a $S_0$\uff0c\u90a3\u4e48\u6211\u4eec\u8981\u4ece $f_{i-1,S,S_0}$ \u8f6c\u79fb\u5230 $f_{i,S_1,S_2}$\uff1a\n\n$$f_{i,S_1,S_2}=f_{i-1,S,S_0}+\\frac{|S_2|}2+\\frac{|S_1\\backslash S_2\\backslash S_0|}3$$\n\n\u6ce8\uff1a$S_2$ \u5373\u5360\u636e\u4e86 $i\\sim i+2$ \u7684 $3\\times 2$ \u65b9\u5757\uff0c$|S_1\\backslash S_2\\backslash S_0|$ \u5373\u5360\u636e\u4e86 $i\\sim i+1$ \u7684 $2\\times 3$ \u65b9\u5757\uff0c\u53ef\u4ee5\u81ea\u884c\u753b\u56fe\u7406\u89e3\u3002\n\n\u4e8e\u662f\u8fd9\u4e2a\u4e1c\u897f\u65f6\u95f4\u590d\u6742\u5ea6\u592a\u9ad8\uff0c\u8fc7\u4e0d\u53bb\u3002\n\n\u6ce8\u610f\u5230 $S_0,S_2$ \u4e2d\u8fde\u7eed $1$ \u7684\u4e2a\u6570\u5fc5\u987b\u662f\u5076\u6570\uff0c$|S_1\\backslash S_2\\backslash S_0|$ \u4e2d\u8fde\u7eed $1$ \u7684\u4e2a\u6570\u5fc5\u987b\u662f\u4e09\u7684\u500d\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u53ea\u679a\u4e3e\u8fd9\u4e9b\u7b26\u5408\u8981\u6c42\u7684\u72b6\u6001\uff0c\u8fd9\u6837\u53ef\u4ee5\u8282\u7701\u5f88\u591a\u65e0\u7528\u679a\u4e3e\u3002\n\n\u53e6\u5916\u8fd8\u6709\u5f88\u591a\u5c0f\u7684\u526a\u679d\uff0c\u6bd4\u5982 $S_2\\subseteq S_1$ \u5fc5\u987b\u6210\u7acb\u3001$S_0\\subseteq S_1\\backslash S_2$ \u5fc5\u987b\u6210\u7acb\u7b49\u7b49\uff0c\u5177\u4f53\u89c1\u4ee3\u7801\u3002\n\n\u53e6\u5916\u4e3a\u4e86\u538b\u7a7a\u95f4\uff0c\u9700\u8981\u4f7f\u7528 `uint8_t`\u3001`uint16_t` \u7b49\u7c7b\u578b\u3002\n\n## Code\n\n```cpp\n#include <algorithm>\n#include <cstdint>\n#include <cstdio>\n#include <cstring>\n#include <vector>\n#include <set>\nusing namespace std;\n\n#define count(x) (__builtin_popcount(x))\n\nconst int N = 150, M = 10;\n\nint n, m, k;\nuint8_t f[2][1 << M][1 << M];\nuint16_t a[N + 10];\n\nbool check(int x, int y) {\n  int cnt = 0;\n  for (int i = 0; i <= (1 << m) - 1; i++) {\n    if ((x >> i) & 1) cnt++;\n    else {\n      if (cnt % y) return 0;\n      cnt = 0;\n    }\n  }\n  return 1;\n}\n\nvoid mian() {\n  scanf(\"%d%d%d\", &n, &m, &k);\n  for (int i = 1; i <= k; i++) {\n    int x, y; scanf(\"%d%d\", &x, &y);\n    a[x] |= (1 << (y - 1));\n  }\n  uint16_t tot = (1 << m) - 1;\n  vector<uint16_t> ok1; // 2\n  a[n + 1] = a[n + 2] = tot;\n  set<uint16_t> ok2; // 3\n  for (uint16_t i = 0; i <= (1 << m) - 1; i++) {\n    if (check(i, 2)) ok1.push_back(i);\n    if (check(i, 3)) ok2.insert(i);\n  }\n  // msk0 msk msk1 msk2\n  for (int i = 1, ii = 1; i <= n; i++, ii = i % 2)\n    for (auto msk2 : ok1)\n      if ((msk2 & a[i + 2]) == 0)\n        for (uint16_t msk1 = 0; msk1 <= tot; msk1++)\n          if ((msk1 & msk2) == msk2 && (msk1 & a[i + 1]) == 0 && (msk1 & a[i]) == 0)\n            for (auto msk0 : ok1)\n              if ((msk0 & a[i]) == 0 && (msk0 & a[i - 1]) == 0 && ((msk1 - msk2) & msk0) == msk0 && ok2.find(msk1 - msk2 - msk0) != ok2.end())\n                for (uint16_t msk = 0; msk <= tot; msk++)\n                  if ((msk & a[i]) == 0 && (msk & a[i - 1]) == 0 && ((msk1 - msk0) & msk) == 0 && (msk1 & msk0) == msk0)\n                    f[ii][msk1][msk2] = max(f[ii][msk1][msk2], uint8_t(f[(ii + 1) % 2][msk][msk0] + count(msk2) / 2 + count(msk1 - msk2 - msk0) / 3));\n  printf(\"%d\\n\", int(f[n % 2][0][0]));\n}\n\nint main() {\n  int T; scanf(\"%d\", &T);\n  while (T--) {\n    memset(f, 0, sizeof(f)); memset(a, 0, sizeof(a));\n    mian();\n  }\n  return 0;\n}\n```",
        "postTime": 1658673371,
        "uid": 242702,
        "name": "registerGen",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P7689 \u3010[CEOI2002] Bugs Integrated,Inc.\u3011"
    },
    {
        "content": "[$\\text{Link}$](https://www.luogu.com.cn/problem/P7689)\n\n## \u9898\u610f\n\n\u4e00\u4e2a $m$ \u884c $n$ \u5217\u7684\u7f51\u683c\uff0c\u91cc\u9762\u53ef\u4ee5\u653e $2\\times3$ \u548c $3\\times2$ \u4e24\u79cd\u4e0d\u540c\u7684\u82af\u7247\uff0c\u5176\u4e2d $k$ \u4e2a\u683c\u5b50\u88ab\u635f\u574f\u4e0d\u80fd\u5360\u7528\uff0c\u6c42\u6700\u591a\u53ef\u4ee5\u653e\u4e0b\u591a\u5c11\u4e2a\u82af\u7247\u3002\n\n## \u5206\u6790\n\n\u6ce8\u610f\u5230 $m$ \u7279\u522b\u5c0f\uff0c\u4e0d\u8d85\u8fc7 $10$\uff0c\u56e0\u6b64\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u72b6\u6001\u538b\u7f29 $\\text{dp}$\uff0c\u53c2\u8003[\u70ae\u5175\u9635\u5730](https://www.luogu.com.cn/problem/P2704)\u8fd9\u9898\u5728\u300a\u7b97\u6cd5\u7ade\u8d5b\u8fdb\u9636\u6307\u5357\u300b\u4e0a\u7684\u89e3\u6cd5\u4e8c\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\u8ba1\u4e00\u79cd\u7c7b\u4f3c\u7684\u72b6\u6001\u8868\u793a\u65b9\u5f0f\uff1a\n\n- $2\\times 3$ \u7684\u82af\u7247\u7684\u8868\u793a\u65b9\u6cd5\uff1a\n\n$$\\begin{aligned}2\\ \\ \\ \\ 1\\ \\ \\ \\ 0\\\\ 2\\ \\ \\ \\ 1\\ \\ \\ \\ 0\\end{aligned}$$\n\n- $3\\times 2$ \u7684\u82af\u7247\u7684\u8868\u793a\u65b9\u6cd5\uff1a\n\n$$\\begin{aligned}1\\ \\ \\ \\ 0\\\\1\\ \\ \\ \\ 0\\\\1\\ \\ \\ \\ 0\\end{aligned}$$\n\n$2\\times3$ \u7684\u82af\u7247\u7684\u4e24\u4e2a $2$ \u548c $3\\times2$ \u7684\u4e09\u4e2a $1$ \u90fd\u8868\u793a\u653e\u4e86\u4e00\u4e2a\u82af\u7247\uff0c\u89c4\u5b9a $2$ \u540e\u9762\u5fc5\u987b\u586b $1$\uff0c$1$ \u540e\u9762\u5fc5\u987b\u586b $0$\uff0c\u53ea\u6709 $0$ \u540e\u9762\u624d\u53ef\u4ee5\u653e\u65b0\u7684\u82af\u7247\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a\u201c\u81ea\u7531\u683c\u201d\uff0c\u8bb0\u4e3a $-1$\uff0c\u663e\u7136\uff0c$-1$ \u7684\u4f4d\u7f6e\u53ef\u80fd\u586b $0$ \u6216 $1$ \u6216 $2$\u3002\n\n\u8fd9\u6837\uff0c\u6bcf\u4e00\u5217\u90fd\u53ef\u4ee5\u88ab\u72b6\u6001\u538b\u7f29\u4e3a\u4e00\u4e2a $m$ \u4f4d\u4e09\u8fdb\u5236\u6570\uff0c\u53ef\u4ee5\u7528\u4e00\u4e2a $0\\sim 3^m-1$ \u4e4b\u95f4\u7684\u4e00\u4e2a\u5341\u8fdb\u5236\u6574\u6570\u8868\u793a\u3002\n\n\u8bbe $dp_{i,s}$ \u8868\u793a\u7b2c $i$ \u5217\u72b6\u6001\u4e3a $s$ \u65f6\uff0c\u524d $i$ \u5217\u53ef\u4ee5\u653e\u7684\u82af\u7247\u4e2a\u6570\uff0c\u82e5\u72b6\u6001\u4e0d\u5408\u6cd5\u5219\u503c\u5e94\u4e3a $-1$\u3002\u6211\u4eec\u679a\u4e3e\u4e00\u4e2a\u5408\u6cd5\u7684\u72b6\u6001 $s$\uff0c\u628a\u5b83\u6309\u4e09\u8fdb\u5236\u4f4d\u62c6\u5206\u5230 $a_{1\\sim m}$ \u4e2d\uff0c\u8003\u8651\u5b83\u53ef\u4ee5\u8f6c\u79fb\u5230\u7b2c $i+1$ \u5217\u7684\u54ea\u4e9b\u72b6\u6001 $t$\uff0c\u5148\u6c42\u51fa $t$ \u7684\u5f85\u5b9a\u6570\u7ec4 $b_{1\\sim m}$\uff0c\u6839\u636e\u524d\u9762\u7684\u8868\u793a\u65b9\u6cd5\uff0c\u6709 $b_i=a_i-1$\uff0c\u82e5 $b_i$ \u5df2\u7ecf\u88ab\u635f\u574f\uff0c\u5219 $b_i=0$\uff0c\u82e5 $b_i$ \u88ab\u635f\u574f\u7684\u540c\u65f6 $a_i\\ge1$\uff0c\u8bf4\u660e\u5728\u72b6\u6001 $s$ \u4e0b $b_i$ \u5e94\u88ab\u5360\u7528\u5374\u662f\u635f\u574f\u7684\uff0c\u8981\u8f6c\u79fb\u5230 $t$ \u4e5f\u662f\u4e0d\u5408\u6cd5\u7684\uff0c\u5e94\u8be5\u6392\u9664\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7684\u72b6\u6001 $s$\u3002\n\n\u7136\u540e\u6211\u4eec\u901a\u8fc7\u5f85\u5b9a\u6570\u7ec4 $b$ \u6c42\u51fa\u5408\u6cd5\u8f6c\u79fb\u72b6\u6001 $t$\uff0c\u4f46\u50cf\u8fd9\u79cd\u72b6\u6001\u8868\u793a\u6bd4\u8f83\u590d\u6742\uff0c\u5197\u4f59\u6bd4\u8f83\u591a\u7684\u9898\u76ee\uff0c\u6211\u4eec\u4e0d\u4e00\u5b9a\u975e\u8981\u5199\u51fa\u786e\u5207\u7684\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff0c\u53ef\u4ee5\u901a\u8fc7\u6df1\u5ea6\u4f18\u5148\u641c\u7d22\u786e\u5b9a\u53ef\u4ee5\u8f6c\u79fb\u5230\u7684 $t$\uff1a\n\n- \u82e5 $b_i\\le0$\uff0c\u5219 $b_i$ \u88ab\u5f3a\u5236\u7528\u4e3a $0$ \u6216\u4e3a\u81ea\u7531\u683c\uff0c\u8fd9\u4e2a\u683c\u5b50\u53ef\u4ee5\u586b $0$\u3002\n- \u82e5 $b_i=1$\uff0c\u5219 $b_i$ \u88ab\u5f3a\u5236\u7528\u4e3a $1$\uff0c\u8fd9\u4e2a\u683c\u5b50\u5fc5\u987b\u586b $1$\u3002\n- \u82e5 $b_i=-1$\uff0c\u5219 $b_i$ \u4e3a\u81ea\u7531\u683c\uff0c\u5219\u67e5\u8be2\u63a5\u4e0b\u53bb\u7684 $1$ \u6216 $2$ \u4e2a\u683c\u5b50\u662f\u5426\u4e5f\u662f\u81ea\u7531\u683c\uff0c\u82e5\u662f\u5219\u53ef\u4ee5\u653e\u82af\u7247\uff0c\u82af\u7247\u6570\u91cf\u589e\u52a0 $1$\u3002\n\n\u76ee\u6807\u72b6\u6001\u4e3a $dp_{n,0}$\u3002\n\n\u770b\u8d77\u6765\u8fd9\u9053\u9898\u76ee\u5df2\u7ecf\u505a\u5b8c\u4e86\uff0c\u4e0d\u8fc7\u4ea4\u4e0a\u53bb\u4f60\u4f1a\u53d1\u73b0 $\\text{MLE}$ \u4e86\uff0c\u539f\u6765\u8fd9\u9053\u9898\u76ee\u8fc7\u4e8e\u6bd2\u7624\uff0c\u53ea\u7559\u4e86 $\\text{8MB}$ \u7684\u7a7a\u95f4\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6eda\u52a8\u6570\u7ec4\u4f18\u5316\u7a7a\u95f4\uff0c\u4e0d\u8fc7\u8981\u6ce8\u610f\u91cd\u7f6e\u6570\u7ec4\uff08\u6211\u5c31\u662f\u8fd9\u6837\u8c03\u5230\u51cc\u6668 $1$ \u70b9\u7684\uff09\u3002\n\n\u8fd9\u79cd\u505a\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(N3^M\\times?)$\uff0c\u5341\u5206\u7384\u5b66\uff0c\u4f1a $\\text{TLE}$ \u5f97\u6b7b\u6b7b\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u52a0\u4e00\u4e2a\u5c0f\u4f18\u5316\uff1a\u6ce8\u610f\u5230\u679a\u4e3e\u72b6\u6001 $s$ \u65f6\uff0c\u6709\u4e00\u4e9b\u635f\u574f\u7684\u683c\u5b50\u7684\u72b6\u6001\u4e00\u5b9a\u662f $0$\uff0c\u5b8c\u5168\u4e0d\u9700\u8981\u82b1\u592a\u591a\u65f6\u95f4\u53bb\u679a\u4e3e\u4ed6\u4eec\uff0c\u6211\u4eec\u8bb0\u5f55\u7b2c $i$ \u5217\u7684\u635f\u574f\u7684\u683c\u5b50\u7684\u4e2a\u6570 $in_i$\uff0c\u53ea\u8981\u679a\u4e3e $3^{m-in_i}$ \u4e2a \u672a\u635f\u574f\u7684\u683c\u5b50\u7684\u72b6\u6001\u5373\u53ef\u3002\n\n\u7136\u800c\u8fd9\u79cd\u505a\u6cd5\u8fd8\u662f\u8fc7\u4e8e\u5783\u573e\uff0c\u53ea\u80fd\u5f97\u5230 $70$ \u5206\uff0c\u5f97\u52a0\u4e0a\u5927\u91cf\u7684\u4f18\u5316\uff0c\u9009\u62e9\u5408\u9002\u7684\u8bed\u8a00\uff0c\u5f00\u542f $\\text{O2}$ \u540e\u5361\u5361\u5e38\u6570\u624d\u53ef\u4ee5\u538b\u7ebf\u8fc7\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nlong long read(){\n\tlong long x=0,f=1;char ch=getchar();\n\twhile(!isdigit(ch)){if(ch=='-') f=-1;ch=getchar();}\n\twhile(isdigit(ch)){x=x*10+ch-48;ch=getchar();}\n\treturn x*f;\n}\nvoid write(long long x){\n    if(x<0) putchar('-'),x=-x;\n    if(x>9) write(x/10);\n    putchar(x%10+'0');\n}\nconst int N=160,M=12,S=6e4+10;\nint d,n,m,k,m3[M]={1},dp[2][S],in[N],a[M],s,b[M];\nbool v[N][M];\nvoid make(int x,int j){\n\ts=0;\n\tfor(int i=m;i>=1;i--){\n\t\tif(v[x][i])\n\t\t\ta[i]=0;\n\t\telse{\n\t\t\ta[i]=j%3;\n\t\t\tj/=3;\n\t\t}\n\t\ts=s*3+a[i];\n\t\tb[i]=a[i]-1;\n\t\tif(v[x+1][i]&&a[i]){//\u8df3\u8fc7\u7279\u6b8a\u4e0d\u5408\u6cd5\u72b6\u6001 \n\t\t\ts=m3[m];\n\t\t\treturn;\n\t\t}\n\t\tif(v[x+1][i])\n\t\t\tb[i]=0;\n\t}\n}\nvoid dfs(int x,int y,int t,int sum){\n\tif(!y){\n\t\tdp[x^1][t]=max(dp[x^1][t],dp[x][s]+sum);\n\t\treturn;\n\t}\n\t//\u586b 0\n\tif(b[y]<=0)\n\t\tdfs(x,y-1,t*3,sum);\n\t//\u5f3a\u5236\u586b 1 \n\tif(b[y]==1)\n\t\tdfs(x,y-1,t*3+1,sum);\n\t//\u53ef\u4ee5\u653e\u82af\u7247 \n\tif(b[y]==-1){\n\t\t//3*2\n\t\tif(y-2>0&&b[y-1]==-1&&b[y-2]==-1)\n\t\t\tdfs(x,y-3,t*27+1*9+1*3+1,sum+1);\n\t\t//2*3\n\t\tif(y-1>0&&b[y-1]==-1)\n\t\t\tdfs(x,y-2,t*9+2*3+2,sum+1);\n\t}\n}\nint main(){\n\tfor(int i=1;i<12;i++)\n\t\tm3[i]=m3[i-1]*3;\n\td=read();\n\twhile(d--){\n\t\tn=read();m=read();k=read();\n\t\tmemset(v,0,sizeof(v));\n\t\tmemset(in,0,sizeof(in));\n\t\tmemset(dp,-1,sizeof(dp));\n\t\tfor(int i=1,x,y;i<=k;i++){\n\t\t\tx=read();y=read();\n\t\t\tv[x][y]=1;\n\t\t\tin[x]++;\n\t\t}\n\t\tdp[0][0]=0;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int j=0;j<m3[m-in[i]];j++){\n\t\t\t\tmake(i,j);\n\t\t\t\tif(dp[i&1][s]==-1)//\u4e0d\u5408\u6cd5\u72b6\u6001 \n\t\t\t\t\tcontinue;\n\t\t\t\tdfs(i&1,m,0,0);\n\t\t\t}\n\t\t\tfor(int j=0;j<m3[m-in[i+2]];j++){//\u91cd\u7f6e\u6570\u7ec4 \n\t\t\t\tmake(i+2,j);\n\t\t\t\tdp[i&1][s]=-1;\n\t\t\t}\n\t\t}\n\t\twrite(dp[n&1][0]);\n\t\tputs(\"\");\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1649993810,
        "uid": 419144,
        "name": "chenjunxiu",
        "ccfLevel": 7,
        "title": "P7689 [CEOI2002] Bugs Integrated,Inc."
    },
    {
        "content": "\u4e00\u5e74\u4ee5\u524d\u6ca1\u6709 AC \u7684\u72b6\u538b DP \u6a21\u677f\u9898\u3002\n\n- \u8bbe\u72b6\u6001\uff1a$f_{i,x,y}$ \u4ee3\u8868\u7b2c $i-1$ \u884c\u91c7\u7528 $x$ \u53f7\u72b6\u6001\u7684\u60c5\u51b5\u4e0b\uff0c\u7b2c $i$ \u884c\u91c7\u7528 $y$ \u53f7\u72b6\u6001\u6700\u591a\u80fd\u88c1\u51fa\u7684\u82af\u7247\u6570\u3002\n\t- \u3010\u6ce81\u3011\u4e8c\u8fdb\u5236\u72b6\u6001\u7684\u5b9a\u4e49\uff1a\u6bcf\u4e00\u4e2a\u72b6\u6001\u5305\u542b $2\\times3$ \u82af\u7247\u7684\u72b6\u6001\u548c $3\\times2$ \u82af\u7247\u7684\u72b6\u6001\u3002\u4ee5\u4e0b\u56fe\u65b9\u5f0f\u8bb0\u5f55\u4e00\u884c\u7684\u72b6\u6001\uff1a\n    ![image.png](https://s2.loli.net/2021/12/13/h6JDOW29ZMq5UkF.png)\n    - \u3010\u6ce82\u3011\u201c$x$ \u53f7\u201d\u72b6\u6001\u7684\u542b\u4e49\uff1a\u7531\u4e8e\u4e00\u4e2a\u72b6\u6001\u53ef\u80fd*\u81ea\u76f8\u77db\u76fe*\uff0c\u5373\u4e0a\u8868\u4e2d\u201c\u5bf9\u5e94\u4e8c\u8fdb\u5236\u72b6\u6001\u201d\u5728\u4e00\u884c\u4e4b\u4e2d\u6210\u4e3a\u56fe\u6848\u662f\u4e0d\u53ef\u80fd\u4e0d\u91cd\u53e0\u7684\uff0c\u56e0\u6b64\u9884\u5904\u7406\u51fa\u5408\u6cd5\u7684\u72b6\u6001\u3002\u5047\u5982\u5c06\u6bcf\u4e00\u4e2a\u72b6\u6001\u7f16\u53f7\u5b58\u8d77\u6765\uff0c\u90a3\u4e48\u8fd9\u5c31\u662f\u67d0\u53f7\u72b6\u6001\u7684\u542b\u4e49\u3002\u53e6\u5916\uff0c\u7ecf\u7edf\u8ba1\uff0c\u5408\u6cd5\u72b6\u6001\u7684\u6570\u91cf\u6700\u591a\u5728 270 \u5de6\u53f3\u3002\n- \u5217\u8f6c\u79fb\uff1a$f_{i,x,y}\\gets\\max(f_{j,z,x})$\u3002\u6807\u51c6\u7684\u72b6\u538b\u8f6c\u79fb\uff0c\u6ce8\u610f\u5224\u65ad\u5408\u6cd5\u6027\u6765\u526a\u679d\u3002\u4f46\u7531\u4e8e\u5e38\u6570\u95ee\u9898\u548c\u526a\u679d\u987a\u5e8f\u7684\u4e0d\u540c\u7a0b\u5e8f\u7684\u6548\u7387\u53ef\u80fd\u53d7\u5f71\u54cd\u3002\u4e0b\u9762\u7ed9\u51fa\u4e00\u79cd\u53ef\u884c\u7684\u5b9e\u73b0\u65b9\u5f0f\u3002\n```cpp\n//options[x]\u8868\u793a\u7b2cx\u53f7\u5408\u6cd5\u72b6\u6001\n//p[x]\u8868\u793a\u7b2cx\u884c\u7684\u677f\u5b50\u72b6\u6001\uff0c1\u8868\u793a\u574f\u4e86\uff0c0\u8868\u793a\u80fd\u7528\nfor(int i=3;i<=n-1;i++)\n\t\t\tfor(int z=1;z<=num;z++)if(!((options[z].occ1|options[z].occ2)&p[i]|(options[z].occ1|options[z].occ2)&p[i+1]|options[z].occ2&p[i-1]))\n\t\t\t\tfor(int x=1;x<=num;x++)if(!((options[x].occ1|options[x].occ2)&(options[z].occ1|options[z].occ2)))\n\t\t\t\t\tfor(int y=1;y<=num;y++)if(!((options[y].occ1|options[y].occ2)&options[z].occ2))\n\t\t\t\t\t\tif(f[i&1^1][y][x] || x==1)\n\t\t\t\t\t\t\tf[i&1][x][z]=max(f[i&1][x][z],f[i&1^1][y][x]+cnt[options[z].s1]+cnt[options[z].s2]);\n```\n- \u8fb9\u754c\uff1a\u8fb9\u754c\u5c31\u662f\u201c\u5f53\u524d\u884c\u201d\u4e3a 1 \u6216 2 \u7684\u60c5\u51b5\uff0c\u7279\u522b\u5730\u8f6c\u79fb\u5373\u53ef\u3002\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u4e0a\u9762\u7684 $i$ \u662f\u4ece 3 \u5f00\u59cb\u7684\u3002\n- [\u63d0\u4ea4\u8bb0\u5f55](https://loj.ac/s/1321936)",
        "postTime": 1639384161,
        "uid": 300078,
        "name": "pengyule",
        "ccfLevel": 7,
        "title": "\u72b6\u538b DP \u6574\u7406\u5f52\u6863 & \u9898\u89e3\u3010P7689 [CEOI2002] Bugs Integrated,Inc.\u3011"
    }
]
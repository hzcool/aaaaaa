[
    {
        "content": "[$$\\Large\\texttt{My Blog}$$](https://hydingsy.github.io/)\n\n---\n\n> \u9898\u76ee\u94fe\u63a5\uff1a[Luogu 2396](https://www.luogu.org/problemnew/show/P2396)\n\nyyy \u6709 $n$ \u5f20\u5361\u7247\uff0c\u6bcf\u5f20\u5361\u7247\u4e0a\u90fd\u6709\u4e00\u4e2a\u6570\u5b57 $a_i$\uff0c\u6bcf\u6b21 yyy \u53ef\u4ee5\u9009\u62e9\u5411\u524d\u8d70 $a_i$ \u6b65\u5e76\u4e22\u5f03\u7b2c $i$ \u5f20\u5361\u7247\u3002\u5f53\u4ed6\u624b\u4e0a\u6ca1\u6709\u5361\u7247\u7684\u65f6\u5019\u4ed6\u5c31\u8d62\u4e86\uff1b\u4f46\u662f\u6709 $m$ \u4e2a\u201c\u5384\u8fd0\u6570\u5b57\u201d\uff0c\u5728\u201c\u5384\u8fd0\u6570\u5b57\u201d\u7684\u4f4d\u7f6e\u6709\u9677\u9631\uff0c\u53ea\u8981 yyy \u505c\u5728\u8fd9\u4e2a\u683c\u5b50\u4e0a\u4ed6\u5c31\u8f93\u4e86\uff08\u5373\u4f7f\u7ec8\u70b9\u662f\u9677\u9631\uff0c\u90a3\u4e48\u4e5f\u8f93\u4e86\uff09\u3002\u4f60\u9700\u8981\u7b97\u51fa yyy \u80fd\u8d62\u7684\u65b9\u6848\u6570\uff0c\u7b54\u6848\u5bf9 $1000000007$ \u53d6\u6a21\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\le n\\le 24$\uff0c$0\\le m\\le 2$\n\n------\n\n## Solution\n\n\u6211\u4eec\u9996\u5148\u53ef\u4ee5\u786e\u5b9a\u8fd9\u662f\u4e00\u9053 $\\texttt{DP}$ \u9898\u76ee\u3002\u7531\u4e8e\u5e76\u6ca1\u6709\u7ed9\u51fa $a_i$ \u7684\u5177\u4f53\u8303\u56f4\uff0c\u56e0\u6b64\u65e0\u6cd5\u628a\u8ddd\u79bb\u8bbe\u8ba1\u8fdb\u72b6\u6001\uff1b\u53c8\u53d1\u73b0\u6bcf\u5f20\u724c\u53ea\u80fd\u7528\u4e00\u6b21\u5e76\u4e14\u6ca1\u6709\u987a\u5e8f\u9650\u5236\uff0c\u89c2\u5bdf\u5230 $n$ \u7684\u8303\u56f4\u4e5f\u5f88\u5c0f\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u72b6\u538b $\\texttt{DP}$\u3002\n\n\u6211\u4eec\u5b9a\u4e49 $f[i]$ \u8868\u793a\u4f7f\u7528\u4e86\u96c6\u5408 $i$ \u5185\u7684\u5361\u7247\u6709\u591a\u5c11\u79cd\u8d62\u7684\u65b9\u6848\u3002\u8f6c\u79fb\u65f6\uff0c\u6211\u4eec\u8bb0 $dis[i]$ \u8868\u793a\u4f7f\u7528\u4e86\u96c6\u5408 $i$ \u5185\u7684\u5361\u7247\u5230\u8fbe\u7684\u4f4d\u7f6e\uff0c\u663e\u7136\u5f53 $dis[i]$ \u4e3a\u201c\u5384\u8fd0\u6570\u5b57\u201d\u65f6\u4e0d\u80fd\u8f6c\u79fb\u3002\u5426\u5219\u6211\u4eec\u679a\u4e3e\u8fd9\u6b21\u4f7f\u7528\u7684\u5361\u7247 $j$\uff08$j\\in i$\uff09\uff0c\u90a3\u4e48\u6709\u8f6c\u79fb\u65b9\u7a0b\uff1a$f[i]=\\sum_{j=1}^n[j\\in i]\\cdot f[i\\ \\texttt{XOR}\\ j]$\uff08\u5176\u4e2d $i\\ \\texttt{XOR}\\ j$ \u672c\u8d28\u662f\u4ece\u96c6\u5408 $i$ \u4e2d\u5220\u53bb\u5143\u7d20 $j$\uff09\u3002\n\n**\u65f6\u95f4\u590d\u6742\u5ea6**\uff1a$O(2^n\\log n)$\n\n------\n\n## Code\n\n```cpp\n#include <cstdio>\n\nconst int N=24;\nconst int mod=1e9+7;\nint n,m,b1,b2,dis[1<<N],f[1<<N];\n\nvoid upd(int &x,int y) {(x+=y)>=mod&&(x-=mod);}\nvoid solve(int x) {\n    for(int i=x,j;i;i^=j) j=i&-i,upd(f[x],f[x^j]);\n}\nint main() {\n    scanf(\"%d\",&n);\n    for(int i=0;i<n;++i) scanf(\"%d\",&dis[1<<i]);\n    scanf(\"%d\",&m);\n    if(m>0) scanf(\"%d\",&b1);\n    if(m>1) scanf(\"%d\",&b2);\n    f[0]=1;\n    int msk=(1<<n)-1;\n    for(int i=1;i<=msk;++i) {\n        int j=i&-i;\n        dis[i]=dis[i^j]+dis[j];\n        if(dis[i]==b1||dis[i]==b2) continue;\n        solve(i);\n    }\n    printf(\"%d\\n\",f[msk]);\n    return 0;\n}\n```\n\n",
        "postTime": 1543851258,
        "uid": 49725,
        "name": "Siyuan",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2396 \u3010yyy loves Maths VII\u3011"
    },
    {
        "content": "# \u6d1b\u8c37P2396 | \u72b6\u538bDP\u5361\u5e38\u9898\n\n\n\u6d1b\u8c37\u9898\u89e3\u91cc\u9762\u552f\u4e00\u7684\u4e00\u7bc7\u9898\u89e3\u2026\u2026\u6211\u592a\u5f31\u4e86\uff0c\u6ca1\u770b\u61c2\u2026\u2026\n\n\n\u5728\u4e00\u4e2a\u5df2\u7ecf404\u7684\u9875\u9762\uff08\u7684\u767e\u5ea6\u5feb\u7167\u91cc\uff09\u627e\u5230\u4e86\u4e00\u79cd\u770b\u8d77\u6765\u9760\u8c31\u7684\u89e3\u6cd5\uff08\u5361\u5e38\u6cd5\uff1f\uff09\n\n\n\u6b63\u5e38DP\u7684\u74f6\u9888\u5728\u4e8e\u5bf9\u4e8e\u6bcf\u4e2a\u72b6\u6001$i$\u90fd\u8981\u679a\u4e3e$n$\u4e2a\u4f4d\uff0c\u5b9e\u9645\u4e0a\u6211\u4eec\u9700\u8981\u7684\u53ea\u662f\u5728$i$\u4e2d\u4e3a\"1\"\u7684\u90a3\u4e9b\u4f4d\uff0c\u800c\"1\"\u7684\u4f4d\u7f6e\u901a\u8fc7lowbit\u53ef\u4ee5\u5f97\u5230\uff0c\u4ece$i$\u4e2d\u53bb\u6389\u8fd9\u4e2a\"1\"\uff0c\u518d\u53d6lowbit\uff0c\u5c31\u80fd\u5f97\u5230\u5269\u4f59\u7684\"1\"\u3002\n\n\n\u4ee3\u7801\u4eb2\u6d4b\u2026\u2026\u5f00O2\u80fd\u8fc7\u3002\n\n\n    \n    \n```cpp\n    #include <cstdio>\n    #include <cmath>\n    #include <cstring>\n    #include <algorithm>\n    #include <ctime>\n    #include <cstdlib>\n    using namespace std;\n    typedef long long ll;\n    #define enter putchar('\\n')\n    #define space putchar(' ')\n    template <class T>\n    void read(T &x){\n        char c;\n        bool op = 0;\n        while(c = getchar(), c > '9' || c < '0')\n        if(c == '-') op = 1;\n        x = c - '0';\n        while(c = getchar(), c >= '0' && c <= '9')\n        x = x * 10 + c - '0';\n        if(op) x = -x;\n    }\n    template <class T>\n    void write(T x){\n        if(x < 0) putchar('-'), x = -x;\n        if(x >= 10) write(x / 10);\n        putchar('0' + x % 10);\n    }\n    const int N = 24, P = 1e9 + 7;\n    int n, m, b[2], f[1 << N], dis[1 << N];\n    // b: \u5384\u8fd0\u6570\u5b57\uff1bf: dp\u6570\u7ec4\uff1bdis\uff1a\u67d0\u72b6\u6001\u65f6yyy\u5df2\u8d70\u8fc7\u7684\u8ddd\u79bb\n    int main(){\n        read(n);\n        for(int i = 0; i < n; i++)\n            read(dis[1 << i]);\n        read(m);\n        if(m > 0) read(b[0]);\n        if(m > 1) read(b[1]);\n        f[0] = 1;\n        for(int i = 1; i < (1 << n); i++){\n            int j = i & -i, k = i;\n            // k\u662f\u4e00\u4e2a\u8f85\u52a9\u53d8\u91cf\uff0c\u7528\u6765\u4e0d\u505c\u5730lowbit\u4ee5\u627e\u51fai\u4e2d\u7684\u6240\u6709\"1\"\n            dis[i] = dis[i ^ j] + dis[j]; //\u7528i\u53bb\u6389\u4e00\u4e2a\"1\"\u5f97\u5230\u7684\u72b6\u6001\u53ef\u6c42dis[i]\n            if(dis[i] == b[0] || dis[i] == b[1]) continue; //\u5982\u679c\u662f\u5384\u8fd0\u6570\u5b57\n            while(k){ \n                j = k & -k; //j\u662f\u5f53\u524d\u627e\u5230\u7684lowbit\n                f[i] += f[i ^ j];\n                if(f[i] >= P) f[i] -= P; //\u5361\u5e38\u561b\n                k ^= j; //k\u4e2d\u53bb\u6389\u8fd9\u4e2a\"1\"\uff0c\u8fd9\u6837\u4e0b\u6b21lowbit\u4f1a\u627e\u5230\u53e6\u4e00\u4e2a\"1\"\n            }\n        }\n        write(f[(1 << n) - 1]), enter;\n        return 0;\n    }\n\n```",
        "postTime": 1515938613,
        "uid": 8947,
        "name": "RabbitHu",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P2396 \u3010yyy loves Maths VII\u3011"
    },
    {
        "content": "@qleonardo\n\n\u6ca1\u5929\u7406\u7684\u66b4\u529b\u8e29\u5927\u5e38\u6570\u6b63\u89e3~~~\n\n\u4e0d\u4f18\u5316\u7684\u72b6\u538b\u52a8\u5f52\u7a7a\u95f4\u662fO(2^n)\uff0c\u65f6\u95f4\u662fO(2^n\\*n)\uff0c\u52a0\u4e0a\u9012\u5f52\u7684\u5927\u5e38\u6570\uff0c\u59a5\u59a5\u7206\u70b8TLE30\n\n\u6b64\u9898\u5f00\u521b\u4e86\u8fde\u72b6\u538b\u52a8\u5f52\u90fd\u8981\u526a\u679d\u4f18\u5316\u7684\u65b0\u65f6\u4ee3QAQ\uff1a\n\n\u4f18\u53161\uff1a\u5bf9\u4e8e\u4f4d\u7f6e\u6ca1\u6709\u5230\u7b2c\u4e00\u4e2a\u5384\u8fd0\u6570\u5b57\u7684\u72b6\u6001\uff0c\u65b9\u6848\u6570\u7b49\u4e8e\u9009\u7684\u6570\u7684\u4e2a\u6570\u7684\u9636\u4e58\n\n\u4f18\u53162\uff1a\u5bf9\u6240\u6709\u7684\u5e78\u8fd0\u6570\u5b57\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\n\n\u4f18\u53163\uff1a\u5982\u679c\u4e24\u4e2a\u5384\u8fd0\u6570\u5b57\u90fd\u5f88\u5c0f\uff0c\u628a\uff08sum\u5e78\u8fd0\u6570\u5b57-\u5384\u8fd0\u6570\u5b571\uff09\u4f5c\u4e3a-\u5384\u8fd0\u6570\u5b571\uff1b\u628a\uff08sum\u5e78\u8fd0\u6570\u5b57-\u5384\u8fd0\u6570\u5b572\uff09\u4f5c\u4e3a-\u5384\u8fd0\u6570\u5b572\n\n\u4f18\u53164\uff1a\u4eba\u5de5\u6808\u5927\u6cd5\u597d\n\n\u4f18\u53165\uff1ac++\u53ef\u4ee5\u624b\u52a8\u5f00O2 /\\*\u8bf4\u7b11\\*/\n\n\u7ec3\u4e60\u5e38\u6570\u4f18\u5316\u7684\u597d\u9898~~~~~\n",
        "postTime": 1437307880,
        "uid": 1652,
        "name": "lyx613",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2396 \u3010yyy loves Maths VII\u3011"
    },
    {
        "content": "\u4e00\u9053\u795e\u4ed9~~\u5361\u5e38~~\u9898\n\n\u9996\u5148\uff0c\u770b\u5230$n \\leq 24$\u7684\u6570\u636e\u8303\u56f4\uff0c\u6211\u4eec\u60f3\u5230\u4e86\u72b6\u538bdp\u3002\n\n\u72b6\u6001\u8bbe\u4e3a\u4e00\u4e2a2\u8fdb\u5236\u6570\u8868\u793a\u6bcf\u5f20\u5361\u7247\u662f\u5426\u7528\u8fc7\uff0c\u8bbe$f[i]$\u8868\u793a\u72b6\u6001$i$\u65f6\u7684\u65b9\u6848\u6570\uff0c$d[i]$\u8868\u793a\u72b6\u6001\u4e3a$i$\u7684\u8ddd\u79bb\u3002\n\n\u7136\u540edp\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$i$\uff0c\u627e\u5230\u5176\u4e2d\u7684\u6bcf\u4e00\u4e2a$1$\uff08\u8bbe\u4e3a$k$\uff09\uff0c\u5219$f[i] += f[i-k]$\u3002\u521d\u59cb\u5316$f[0]=1$\u3002\u6ce8\u610f\u5f53$d[i]$\u4e3a\"\u5384\u8fd0\u6570\u5b57\"\u7684\u65f6\u5019\u8981\u8bbe\u4e3a0\u3002\n\n\u6700\u540e\u7b54\u6848\u5373\u4e3a$f[(1<<n)-1]$\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u4f1a\u53d1\u73b0\u8fd9\u6837\u8fc7\u4e0d\u6389qwq\n\n\u8003\u8651\u4f18\u5316\uff0c\u9996\u5148\u679a\u4e3e$i$\u5176\u4e2d\u7684$1$\u7684\u65f6\u5019\u53ef\u4ee5\u8bb0\u5f55\u4e00\u4e2a$j$\u521d\u59cb\u503c\u4e3a$i$\uff0c\u6bcf\u6b21$k=lowbit(j),j-=k$\uff0c\u8fd9\u6837$k$\u5c31\u4e3a\u53d6\u51fa\u7684$1$\u3002\n\n\u7136\u540e\u7b97\u51fa$d[i]$\u540e\u5982\u679c\u662f\"\u5384\u8fd0\u6570\u5b57\"\u53ef\u4ee5\u76f4\u63a5\u8df3\u6389\u3002\n\n\u7136\u800c\u6837\u4f8b2\u8fd8\u662f\u8fc7\u4e0d\u6389\u2026\u2026\n\n~~\u4e8e\u662f\u5927\u529b\u5361\u5e38~~\uff0c\u5faa\u73af\u53d8\u91cf\u52a0`register`\uff0c\u4e00\u4e9b\u8fd0\u7b97\u7528\u4f4d\u8fd0\u7b97\u4ee3\u66ff\uff0c\u6a21\u8fd0\u7b97\u7528\u51cf\u4ee3\u66ff\u3002\uff08\u5c31\u8fd9\u6837\u5361\u5230\u4e861s\u5185\uff09\n\n\u4ee3\u7801\u5982\u4e0b :\n```\n#include <cstdio>\n#include <cctype>\n#define M 1000000007\n#define lowbit(x) ((x)&(-x))\ninline int read() {\n    int d=0;char ch=getchar();while(!isdigit(ch))ch=getchar();\n    while(isdigit(ch)){d=d*10+ch-48;ch=getchar();}return d;\n}\n\nint n, m, mx;\nint dis[1<<24], a[2];\nint f[1<<24];\n\nint main() {\n    n = read();\n    for(register int i = 0; i < n; ++i)\n        dis[1<<i] = read();\n    m = read();\n    for(register int i = 0; i < m; ++i)\n        a[i] = read();\n    f[0] = 1, mx = (1<<n)-1;\n    for(register int i = 1; i <= mx; ++i) {\n        dis[i] = dis[i^lowbit(i)] + dis[lowbit(i)];\n        if(dis[i] == a[0] || dis[i] == a[1]) continue;\n        for(register int j = i, k = lowbit(j); j; j ^= k, k = lowbit(j)) {\n            f[i] += f[i^k];\n            if(f[i] > M) f[i] -= M;\n        }\n    }\n    printf(\"%d\", f[mx]);\n    return 0;\n}\n```",
        "postTime": 1543754270,
        "uid": 79017,
        "name": "\u82b1\u91cc\u5fc3\u7231",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2396 \u3010yyy loves Maths VII\u3011"
    },
    {
        "content": "> [P2396 yyy loves Maths VII](https://www.luogu.com.cn/problem/P2396)\r\n\r\n[\u53cc\u500d\u7ecf\u9a8c](https://www.luogu.com.cn/problem/CF327E)\u3002\r\n\r\n\u8bbe $f_S$ \u8868\u793a\u96c6\u5408 $S$ \u7684\u7b54\u6848\uff0c\u82e5 $g_S = \\sum_{i\\in S} a_i$ \u4e0d\u5408\u6cd5\uff0c\u5219 $f_S = 0$\uff0c\u5426\u5219 $f_S = \\sum_{i\\in S} f_{S\\backslash i}$\u3002\r\n\r\n\u76f4\u63a5\u505a\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal{O}(2 ^ n n)$\uff0c\u5f00 O2 \u53ef\u4ee5\u901a\u8fc7\u3002\u6211\u4eec\u679a\u4e3e $i$ \u7684\u65f6\u5019\u901a\u8fc7 $\\mathrm{lowbit}(S)$ \u505a\u5230\u4e0d\u679a\u4e3e\u65e0\u7528\u8f6c\u79fb\uff0c\u6709 $\\frac 1 2$ \u7684\u5e38\u6570\u3002\r\n\r\n\u4f18\u5316\uff1a\r\n\r\n- \u82e5 $k = 0$\uff0c\u5219\u7b54\u6848\u4e3a $n!$\u3002\r\n- \u82e5 $k = 1$\uff0c\u5219\u7b54\u6848\u4e3a $n! - \\sum_{g(S) = x} |S|! (n - |S|)!$\u3002\r\n\r\n- \u5f53 $g_S < \\min(x, y)$ \u65f6\uff0c$f_S = |S|!$\u3002\u53ef\u4ee5\u5c06 $x, y$ \u540c\u65f6\u53d8\u6210 $\\sum a_i - x, \\sum a_i - y$ \u4f7f $\\min(x, y)$ \u53d8\u5927\u3002\r\n- \u5f53\u4f7f\u5f97 $g(S) = x$ \u548c $g(T) = \\sum a_i - y$ \u7684 $S$ \u548c $T$ \u7684\u6570\u91cf\u4e4b\u79ef\u4e0d\u5927\u65f6\uff0c\u53ef\u4ee5\u679a\u4e3e $S, T$ \u7b97\u51fa\u540c\u65f6\u7ecf\u8fc7 $x, y$ \u7684\u8def\u5f84\u6570\uff0c\u518d\u5957\u5165 $k = 1$ \u7684\u5bb9\u65a5\u3002\r\n\r\n[\u4ee3\u7801](https://codeforces.com/contest/327/submission/176821874)\uff0c\u4e0d\u5f00 O2 \u83b7\u5f97\u4e86\u6700\u4f18\u89e3\uff08749ms\uff09\uff0c\u5f00 O2 \u53c8\u83b7\u5f97\u4e86\u6700\u4f18\u89e3\uff08476ms\uff09\u3002\r\n\r\n**\u600e\u4e48\u6ca1\u6709\u4eba\u5199 $\\boldsymbol {3 ^ {n / 2}}$ \u7684\u505a\u6cd5\u554a\uff1f**\r\n\r\n\u8bbe $A(S)$ \u8868\u793a\u96c6\u5408 $S$ \u7684 $a_i$ \u4e4b\u548c\u3002\r\n\r\n\u8003\u8651 $k = 1$\uff0c\u6211\u4eec\u53d1\u73b0\u76f8\u5f53\u4e8e\u6c42 $n! - \\sum\\limits_{A(S) = x} |S|! (n - |S|)!$\u3002\u5b50\u96c6\u548c\u7b49\u4e8e\u67d0\u4e2a\u503c\uff0c\u8003\u8651 MITM\uff0c\u5c06 $a$ \u5206\u6210\u4e24\u90e8\u5206 $L, R$\uff0c\u6c42\u51fa $f_{i, j}$ \u8868\u793a $R$ \u7684\u5b50\u96c6 $R_1$ \u7684\u6570\u91cf\uff0c\u4f7f\u5f97 $|R_1| = i$ \u4e14 $A(R_1) = j$\u3002\u679a\u4e3e $L$ \u5b50\u96c6 $L_1$ \u548c $i = |R_1|$\uff0c\u5219\u7b54\u6848\u51cf\u53bb $f_{i, x - A(L_1)} (i + |L_1|)!(n - i - |L_1|)!$\u3002\r\n\r\n$k = 2$ \u540c\u7406\uff0c\u8fd0\u7528\u5bb9\u65a5\u539f\u7406\u5c06\u7b54\u6848\u8f6c\u5316\u4e3a $n!$ \u51cf\u53bb\u7ecf\u8fc7 $x$ \u7684\u65b9\u6848\u6570\uff0c\u51cf\u53bb\u7ecf\u8fc7 $y$ \u7684\u65b9\u6848\u6570\uff0c\u518d\u52a0\u4e0a\u540c\u65f6\u7ecf\u8fc7 $x$ \u548c $y$ \u7684\u65b9\u6848\u6570\u3002\u5bf9\u4e8e\u540e\u8005 $\\sum\\limits_{A(S_1) = x} \\sum\\limits_{A(S_2) = y - x\\land S_1 \\cap S_2 = \\varnothing} |S_1|! |S_2|! (n - |S_1| - |S_2|)!$\u3002\u7c7b\u4f3c\u5730\uff0c\u679a\u4e3e $R$ \u7684\u5b50\u96c6 $R_1$ \u548c $R\\backslash R_1$ \u7684\u5b50\u96c6 $R_2$\uff0c\u6c42\u51fa $f_{i, j, l, m}$ \u8868\u793a $|R_1| = i$\uff0c$|R_2| = j$\uff0c$A(R_1) = l$ \u4e14 $A(R_2) = m$ \u7684\u65b9\u6848\u6570\u3002\u679a\u4e3e $L$ \u5b50\u96c6 $L_1$ \u548c $L\\backslash L_1$ \u7684\u5b50\u96c6 $L_2$\uff0c\u5219\u7b54\u6848\u52a0\u4e0a $f_{i, j, x - A(L_1), y - x - A(L_2)} (|L_1| + i)! (|L_2| + j)! (n - i - j - |L_1| - |L_2|)!$\u3002\r\n\r\n\u4f7f\u7528\u54c8\u5e0c\u8868\u7ef4\u62a4 $k = 1$ \u7684 $j$ \u4e00\u7ef4\u548c $k = 2$ \u7684 $l, m$ \u4e24\u7ef4\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(3 ^ {n / 2} n ^ 2)$\u3002[\u4ee3\u7801](https://codeforces.com/contest/327/submission/176961722)\u3002\u4e0d\u5f00 O2 \u4f1a TLE\uff0c\u5f00 O2 \u83b7\u5f97\u4e86\u6700\u4f18\u89e3\uff08383ms\uff09\u3002\u6ce8\u610f CF \u53cc\u500d\u7ecf\u9a8c `unodered_map` \u4f1a TLE\uff0c\u7528 `gp_hash_table`\u3002",
        "postTime": 1666158377,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "P2396 yyy loves Maths VII"
    },
    {
        "content": "\u5999\u5999\u9898\u3002\n\n\u4e0d\u5f00 -O2 \u8fc7\u4e0d\u4e86\u8fd8\u662f\u6709\u70b9\u79bb\u8c31\u7684\u3002\n\n\u6570\u636e\u8303\u56f4\u542f\u793a\u6211\u4eec\u8fd9\u662f\u72b6\u538b dp\u3002\n\n\u8003\u8651\u5c06\u5f53\u524d\u7528\u8fc7\u7684\u5361\u7247\u7684\u72b6\u6001\u538b\u6210\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6570 $S$\uff0c\u8bbe $f_{S}$ \u8868\u793a\u5f53\u524d\u7684\u4f7f\u7528\u72b6\u6001\u4e3a $S$ \u65f6\u8fbe\u6210\u7684\u65b9\u6848\u6570\u3002\uff081 \u8868\u793a\u5df2\u7ecf\u4f7f\u7528\uff0c0 \u8868\u793a\u672a\u4f7f\u7528\uff09\n\n\u5bb9\u6613\u53d1\u73b0\u8f6c\u79fb\u65b9\u7a0b\u662f $f_{S}= \\sum f_{S'}\\ (s.t.\\ S' \\ \\texttt{\u662f}\\ S\\ \\texttt{\u4e2d\u53bb\u9664\u4e00\u4e2a\u4f7f\u7528\u8fc7\u7684\u5361\u7247\u5f97\u5230\u7684\u96c6\u5408})$\n\n\u7136\u540e\u5199\u51fa\u6765\u5c31\u662f\uff1a\n\n```\nfor(int state = 0; state < (1 << n) - 1; state++)\n{\n\tint tmp = 0;\n\tfor(int i = 0; i < n; i++)\n\t{\n\t\tif(state & (1 << i))\n\t\t{\n\t\t\ttmp += a[i + 1];\n\t\t}\n\t}\n\tfor(int i = 0; i < n; i++)\n\t{\n\t\tif(!(state & (1 << i)))\n\t\t{\n\t\t\tif(tmp + a[i + 1] != b1 && tmp + a[i + 1] != b2)\n\t\t\t{\n\t\t\t\tf[state | (1 << i)] = (f[state | (1 << i)] + f[state]) % mod;\n\t\t\t}\n\t\t}\n\t}\n}\n```\n\n\u590d\u6742\u5ea6 $O(n\\times 2^n)$\uff0c\u8fc7\u4e0d\u4e86\u554a\u3002\n\n---\n\u8003\u8651\u5999\u5999\u7684\u4f18\u5316\u3002\n\n\u9996\u5148\u53d1\u73b0\u4e0d\u7528\u6bcf\u6b21\u90fd\u53bb\u6c42\u5f53\u524d\u96c6\u5408 $S$ \u6240\u5bf9\u5e94\u7684\u4f4d\u7f6e\uff08$\\sum \\limits_{i \\in S}a_i$\uff09\uff0c\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u6765\u3002\n\n\u4ee4 $g_{S}$ \u8868\u793a\u5f53\u524d\u96c6\u5408\u4e3a $S$ \u65f6\u7684 $\\sum \\limits_{i \\in S}a_i$\uff0c\u90a3\u4e48\u53ef\u4ee5\u8fd9\u4e48\u8f6c\u79fb g\uff1a\n\n```cpp\nfor(int state = 1; state < (1 << n); state++)\n{\n\tg[state] = g[state ^ lowbit(state)] + a[lg2[lowbit(state)] + 1];\n}\n```\n\n\u5373\u8003\u8651 g \u4ece\u6700\u4f4e\u4f4d\u7684\u53d6\u4e86\u7684\u5361\u724c\u6240\u4ee3\u8868\u7684\u503c\u8f6c\u79fb\u8fc7\u6765\uff0c\u5373 $\\log_2 {\\text{lowbit}(S)}$\u3002\uff08\u6bcf\u4e2a 2 \u7684\u6574\u6570\u6b21\u5e42\u5bf9\u5e94\u7684\u6307\u6570\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u6765\uff09\n\n\u7136\u540e\u540c\u6837\u7684\uff0c\u6211\u4eec\u53d1\u73b0\u5728\u8f6c\u79fb f \u7684\u8fc7\u7a0b\u4e2d S \u53ef\u80fd\u6709\u4e0d\u5c11\u4f4d\u7f6e\u672c\u6765\u5c31\u662f 1\uff0c\u4f46\u662f\u6211\u4eec\u53ea\u9700\u8981\u679a\u4e3e 0 \u7684\u4f4d\u7f6e\u3002\n\n\u540c\u6837\u8003\u8651\u7528 lowbit \u5b9e\u73b0 0 \u7684\u4f4d\u7f6e\u7684\u679a\u4e3e\uff08\u5148\u8981\u5c06 S \u53d6\u53cd\uff0c\u518d\u4ece\u4f4e\u5230\u9ad8\u51cf\u53bb lowbit \u6765\u53d6\u5230\u6bcf\u4e00\u4f4d\uff09\u3002\n\n\u6ce8\u610f\u8fd9\u91cc\u4e0d\u80fd\u4f7f\u7528 ```~``` \u8fd0\u7b97\uff0c\u56e0\u4e3a\u66f4\u9ad8\u4f4d\u7684 0 \u6211\u4eec\u4e0d\u5e0c\u671b\u6539\u6210 1\u3002\n\n\u4f18\u5316\u8fc7\u540e\uff0c\u53d1\u73b0\u5747\u644a\u4e0b\u6765\u4f1a\u5c11\u4e00\u534a\u7684\u6b21\u6570\uff08\u5373 $[0,2^n]$ \u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e0b 0 \u7684\u4e2a\u6570\u662f $2^{n - 1}$\uff09\u3002\n\n\u590d\u6742\u5ea6\u4e3a $O(n \\times 2^{n - 1})$\u3002\n\n```cpp\nfor(int i = state ^ ((1 << n) - 1); i; i -= lowbit(i))\n{\n\tif(g[state] + a[lg2[lowbit(i)] + 1] != b1 && g[state] + a[lg2[lowbit(i)] + 1] != b2)\n\t{\n\t\tf[state | lowbit(i)] = (f[state | lowbit(i)] + f[state]) % mod;\n\t}\n}\n```\n\nCode\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\ninline void read(int &x)\n{\n\tx = 0;\n\tint f = 0;\n\tchar ch = getchar();\n\twhile(ch < '0' || ch > '9')\n\t{\n\t\tf |= ch == '-';\n\t\tch = getchar();\n\t}\n\twhile(ch >= '0' && ch <= '9')\n\t{\n\t\tx = x * 10 + ch - 48;\n\t\tch = getchar();\n\t}\n\tx = f ? -x : x;\n\treturn;\n}\nconst int mod = 1e9 + 7;\n#define N 25\nint n, a[N];\nint m, b1 = 0x3f3f3f3f, b2 = 0x3f3f3f3f;\nint f[1 << N], g[1 << N], lg2[1 << N];\ninline int lowbit(int x)\n{\n\treturn x & (-x);\n}\nsigned main()\n{\n\tread(n);\n\tfor(int i = 1; i <= n; i++)\n\t{\n\t\tread(a[i]);\n\t}\n\tread(m);\n\tif(m >= 1)\n\t{\n\t\tread(b1);\n\t}\n\tif(m >= 2)\n\t{\n\t\tread(b2);\n\t}\n\tf[0] = (b1 && b2);\n\tfor(int i = 0, now = 1; i <= n; i++, now <<= 1)\n\t{\n\t\tlg2[now] = i;\n\t}\n\tfor(int state = 1; state < (1 << n); state++)\n\t{\n\t\tg[state] = g[state ^ lowbit(state)] + a[lg2[lowbit(state)] + 1];\n\t}\n\tfor(int state = 0; state < (1 << n) - 1; state++)\n\t{\n\t\tfor(int i = state ^ ((1 << n) - 1); i; i -= lowbit(i))\n\t\t{\n\t\t\tif(g[state] + a[lg2[lowbit(i)] + 1] != b1 && g[state] + a[lg2[lowbit(i)] + 1] != b2)\n\t\t\t{\n\t\t\t\tf[state | lowbit(i)] = (f[state | lowbit(i)] + f[state]) % mod;\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\", f[(1 << n) - 1]);\n\treturn 0;\n}\n```",
        "postTime": 1636298144,
        "uid": 90027,
        "name": "GG_jok_er",
        "ccfLevel": 0,
        "title": "P2396 yyy loves Maths VII \u9898\u89e3"
    },
    {
        "content": "[\u9898\u76ee](https://www.luogu.com.cn/problem/P2396)\n\n\u6bd4\u8f83\u677f\u5b50\u7684\u72b6\u538b dp\u3002\n\n\u8bfb\u5b8c\u9898\u5bb9\u6613\u8bbe\u51fa\u72b6\u6001 $f_{i}$ \u8868\u793a\u6b64\u65f6\u5df2\u9009\u5361\u7247\u7684\u72b6\u6001\uff0c$i$ \u7684\u4e8c\u8fdb\u5236\u4f4d $0/1$ \u5206\u522b\u5bf9\u5e94\u8fd9\u4e00\u5f20\u5361\u7247\u4e0d\u9009\u6216\u9009\u3002\n\n\u56e0\u4e3a\u5df2\u9009\u5361\u7247\u6570\u5b57\u603b\u548c\u4e0d\u5f97\u7b49\u4e8e\u7ed9\u5b9a\u6570\uff0c\u6211\u4eec\u65b0\u5f00\u4e00\u4e2a\u6570\u7ec4\u8bb0\u5f55\u6bcf\u4e2a\u9009\u62e9\u5361\u7247\u7684\u72b6\u6001\u7684\u5361\u7247\u603b\u548c\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $i$\uff0c\u627e\u5230 $i$ \u4e2d\u6240\u6709\u4e8c\u8fdb\u5236\u4f4d\u4e3a $1$ \u7684\u4f4d\uff0c\u8bbe\u6b64\u4f4d\u4e3a\u7b2c $j$ \u4f4d\uff0c\u5219\u6613\u5f97 $f_{i}=f_{i} + f_{i \\otimes 2^j}$\u3002\u5176\u4e2d $\\otimes$ \u8868\u793a\u5f02\u6216\u8fd0\u7b97\u3002\n\n\u4f46\u662f\u600e\u4e48\u8bf4\u8fd9\u4e5f\u662f\u4e00\u9053\u7d2b\uff0c\u4e0d\u53ef\u80fd\u8fd9\u4e48\u7b80\u5355\uff0c\u679c\u7136\uff0c\u4ea4\u4e0a\u53bb TLE\uff0860pts\uff09\u3002\n\n\n\u5728\u4e0a\u8ff0 dp \u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u72b6\u6001\u90fd\u8981\u679a\u4e3e\u4e00\u4e0b\u6bcf\u4e00\u4f4d\u662f\u5426\u4e3a $1$\uff0c\u5e38\u6570\u8fc7\u5927\uff0c\u4f1a T \u6389\u3002\n\n**\u4e3a\u4e86\u7a81\u7834\u6b64\u74f6\u9888\uff0c\u7528\u5230 lowbit \u8fd0\u7b97\uff0c\u5feb\u901f\u627e\u5230\u6b64\u4e8c\u8fdb\u5236\u6570\u7684\u6bcf\u4e00\u4e2a $1$\u3002**\n\n\u4ea4\u4e0a\u53bb\u6539\u8fdb\u540e\u7684\u4ee3\u7801\uff0c\u4f9d\u7136 TLE\uff0860pts\uff09\uff0c~~\u6b64\u65f6\u53ea\u8981\u5f00\u542f O2\uff0c\u5373\u53ef AC\u3002~~\n\n\u8981\u77e5\u9053\uff0c\u5f88\u591a\u6bd4\u8d5b\u662f\u6ca1\u6709 O2 \u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u5361\u8fdb 1s \u4e4b\u5185\u3002\n\n\u5f00\u59cb\u4e71\u641e\uff0c\u5faa\u73af\u53d8\u91cf\u5728\u5916\u9762\u5b9a\u4e49\uff0c\u5e76\u52a0\u4e0a regiter\uff0c\u8fd8\u6709\u53d6\u6a21\u4e0d\u8981\u7528\u53d6\u6a21\uff0c\u7528\u51cf\u6cd5\uff0c\u52a0\u4e0a\u8fd9\u4e9b\u5c31\u591f\u4e86\uff0c\u4e0d\u5f00 O2 \u53ef AC\u3002\n\n```cpp\n#include <algorithm>\n#include <iostream>\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <stack>\n#include <queue>\n#include <vector>\n#include <list>\n#include <map>\n#include <ctime>\n//#define int long long\n//#define int __int128\n//#define int long long\n//#define int long double\n//#define Int int\n#define mr make_pair\n#define ff first\n#define ss second\n#define lb(x) (x & (-x))\nusing namespace std ;\nint a[26] ;\nint b[3] ;\nint f[1 << 24 | 1] ;  \nint sum[1 << 24 | 1] ;\nconst int mod = 1e9 + 7 ;\nint n, m ; \nbool check(int x) {\n\treturn (x != b[1] && x != b[2]) ;\n}\nint read(){\n\tchar ch ;int s = 0 ;int w = 1;\n\twhile((ch = getchar()) >'9' || ch < '0' )if(ch == '-')w = -1 ;\n\twhile(ch >= '0' && ch <= '9')s = (s << 1) + (s << 3) + (ch ^ 48) , ch = getchar() ;\n\treturn s * w ;\n}\nsigned main() {\n    cin >> n ;\n    register int i ;\n    for(i = 1 ; i <= n ; i++) a[i] = read() ;\n    cin >> m ;\n    memset(b, -1, sizeof(b)) ;\n    for(i = 1 ; i <= m ; i++) b[i] = read() ;\n    f[0] = 1 ;\n    for(i = 0 ; i < n ; i++) sum[1 << i] = a[i + 1] ;\n    int maxn = 1 << n ;\n    for(i = 1 ; i < maxn ; i++) sum[i] = sum[lb(i)] + sum[i - lb(i)] ;\n    for(i = 0 ; i < maxn ; i++) {\n    \tif(!check(sum[i])) continue ;\n\t\tint k = i ;\n    \twhile(k) { \n    \t\tf[i] += f[i ^ lb(k)] ;\n    \t\tif(f[i] >= mod) f[i] -= mod ;\n    \t\tk -= lb(k) ; //\u7528lowbit\u5feb\u901f\u627e\u51fa\u6bcf\u4e00\u4f4d\u76841 \n\t\t}\n\t}\t\n    cout << f[(1 << n) - 1]  ;\n\treturn 0 ;\n}\n```",
        "postTime": 1658414920,
        "uid": 632162,
        "name": "quarmer",
        "ccfLevel": 0,
        "title": "P2396 yyy loves Maths VII"
    },
    {
        "content": "\u8003\u8651\u72b6\u538b dp\u3002\n\n\u8bbe $f(S)$ \u4e3a\u5c06\u96c6\u5408 $S$ \u5185\u7684\u5361\u7247\u5168\u90e8\u9009\u7684\u65b9\u6848\u6570\uff0c$d(S)$ \u8868\u793a\u5c06\u96c6\u5408 $S$ \u5185\u7684\u5361\u7247\u5168\u90e8\u9009\u4e4b\u540e\u7684\u4f4d\u7f6e\u3002\u8f6c\u79fb\u5bb9\u6613\u60f3\u5230\uff1a\n\n$$f(S)=\\sum_{i \\in S} f(S-\\{i\\})$$\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a $\\mathcal{O}(n2^n)$\u3002\u8fc7\u4e0d\u53bb\u3002\n\n\u8003\u8651\u8f6c\u79fb\u7684\u8fc7\u7a0b\uff0c\u5b9e\u8d28\u4e0a\u5c31\u662f\u53d6\u51fa\u6bcf\u4e00\u4f4d\u4e0a\u7684 $1$\u3002\u8fd9\u4e2a\u64cd\u4f5c\u53ef\u4ee5\u7528 $\\mathrm{lowbit}$ \u4f18\u5316\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(2^n \\log n)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N = 24;\nconst int P = 1e9+7;\n#define lowbit(x) (x&-x)\nint n,m,a[1<<N],f[1<<N],b[2];\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1,x;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&x);\n\t\ta[1<<(i-1)]=x;\n\t}\n\tscanf(\"%d\",&m);\n\tfor(int i=0;i<m;i++) scanf(\"%d\",&b[i]);\n\tf[0]=1;\n\tfor(int i=1;i<(1<<n);i++)\n\t{\n\t\ta[i]=a[lowbit(i)]+a[i^lowbit(i)];\n\t\tif(a[i]==b[0]||a[i]==b[1]) continue;\n\t\tfor(int j=i;j;j-=lowbit(j)) f[i]=(f[i]+f[i^lowbit(j)])%P;\n\t}\n\tprintf(\"%d\\n\",f[(1<<n)-1]);\n}\n```",
        "postTime": 1663303841,
        "uid": 280473,
        "name": "404Not_Found",
        "ccfLevel": 5,
        "title": "P2396"
    },
    {
        "content": "\u72b6\u6001\u538b\u7f29 dp\u3002\n\n\u4e00\u4e2a\u6bd4\u8f83\u663e\u7136\u7684\u601d\u8def\u662f\u8bbe $S$ \u4e3a\u72b6\u6001\u3002\u8bb0\u5341\u8fdb\u5236\u6570 $S$ \u4e8c\u8fdb\u5236\u8868\u793a\u4e0b\u7684\u7b2c $i$ \u4f4d\u4e3a $S_i$\uff0c\u5219 $S_i=0$ \u8868\u793a\u7b2c $i$ \u4e2a\u6570\u9009\u8fc7\uff0c$S_i=1$ \u8868\u793a\u7b2c $i$ \u4e2a\u6570\u672a\u88ab\u9009\u8fc7\u3002\n\n\u72b6\u6001\u8f6c\u79fb\u65b9\u5f0f\u4e3a\uff1a\u6bcf\u6b21\u679a\u4e3e $x \\in [1, n]$\uff1b\u5982\u679c $S_i=0$\uff0c\u5219\u68c0\u67e5\u52a0\u5165\u7b2c $x$ \u4e2a\u6570\u4e4b\u540e\u603b\u548c\u662f\u5426\u4e3a\u7981\u6b62\u9009\u4e2d\u7684\u6570\uff0c\u5982\u679c\u4e0d\u662f\u5219\u5c06 $S_i$ \u8bbe\u4e3a $1$ \u5e76\u8f6c\u79fb\u3002\u5f88\u5bb9\u6613\u770b\u51fa\u8fd9\u4e2a\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\mathcal{O}(n2^n) $\uff0c\u4f1a\u8d85\u65f6\u3002\u4e00\u4e2a\u4f18\u5316\u662f\u628a\u6bcf\u6b21\u76f4\u63a5\u679a\u4e3e $x \\in [1, n]$ \u6362\u6210\u679a\u4e3e\u6240\u6709 $S_x=0$ \u7684 $x$\uff0c\u8fd9\u786e\u5b9e\u80fd\u4f18\u5316\uff0c\u4f46\u662f\u6548\u679c\u6709\u9650\uff1a\u5e73\u5747\u60c5\u51b5\u4e0b $S$ \u6709\u4e00\u534a\u7684\u4f4d\u662f $0$\uff0c\u8fd9\u4e2a\u4f18\u5316\u4ec5\u4ec5\u662f\u628a\u5e38\u6570\u7f29\u51cf\u5230\u539f\u6765\u7684 $\\frac{1}{2}$\uff0c\u4ecd\u7136\u65e0\u6cd5\u901a\u8fc7 $n \\leq 24$ \u7684\u6570\u636e\u3002\n\n\u7531\u6b64\uff0c\u9700\u8981\u60f3\u529e\u6cd5\u5c06\u65f6\u95f4\u590d\u6742\u5ea6\u4e2d\u7684 $n$ \u56e0\u5b50\u53bb\u9664\u3002\u53ef\u4ee5\u53d1\u73b0\uff0c\u72b6\u6001 $S(\\texttt{111100})$ \u4f1a\u88ab $S(\\texttt{111000})$\u3001$S(\\texttt{110100})$ \u7b49\u591a\u4e2a\u72b6\u6001\u8f6c\u79fb\u5230\u3002\u867d\u7136\u72b6\u6001\u8ba1\u7b97\u53ef\u4ee5\u8fbe\u5230 $\\mathcal{O}(1) $\uff0c**\u4f46\u662f\u72b6\u6001\u8f6c\u79fb\u4e5f\u4f1a\u8017\u8d39\u65f6\u95f4**\u3002\u8fd9\u5c31\u662f\u75c7\u7ed3\u6240\u5728\u3002\n\n![](https://i.bmp.ovh/imgs/2022/06/27/53eecacbde5c28b7.png)\n\n\u72b6\u6001\u4e4b\u95f4\u7684\u8f6c\u79fb\u53ef\u4ee5\u770b\u6210\u4e00\u5f20\u6709\u5411\u65e0\u73af\u56fe\uff0c\u65e2\u7136\u6b63\u7740\u904d\u5386\u8017\u8d39\u65f6\u95f4\uff0c\u90a3\u5c31\u53cd\u7740\u904d\u5386\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u72b6\u6001\uff0c\u5bfb\u627e**\u6240\u6709\u80fd\u591f\u8f6c\u79fb\u5230\u8be5\u72b6\u6001\u7684\u72b6\u6001**\uff0c\u5c06\u5b83\u4eec\u7684\u53ef\u80fd\u6570\u76f8\u52a0\u5373\u4e3a\u8be5\u72b6\u6001\u7684\u603b\u53ef\u80fd\u6570\uff0c\u5373**\u52a0\u6cd5\u539f\u7406**\u3002\n\n![](https://i.bmp.ovh/imgs/2022/06/27/5f274d14b04451ce.png)\n\n\u80fd\u8f6c\u79fb\u5230\u8be5\u72b6\u6001\u7684\u72b6\u6001\uff0c\u5f88\u660e\u663e\u5c31\u662f\u5c06 $S$ \u4e2d\u6240\u6709\u4e3a $1$ \u7684\u4f4d\u4f9d\u6b21\u8bbe\u4e3a $0$ \u5e76\u76f8\u52a0\u3002\u5bfb\u627e\u6240\u6709\u4e3a $1$ \u7684\u4f4d\u5c31\u662f `lowbit` \u64cd\u4f5c\u3002\u53e6\u5916\u9700\u8981\u8ba1\u7b97\u4e00\u4e0b\u5f53\u524d\u72b6\u6001 $a_x$ \u7684\u603b\u548c\uff0c\u5982\u679c\u53d1\u73b0\u603b\u548c\u4e3a\u88ab\u7981\u6b62\u7684\u6570\u5219\u4e0d\u8fdb\u884c\u8f6c\u79fb\u3002\u76f8\u5bf9\u5bb9\u6613\uff0c\u89c1\u4ee3\u7801\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\mathcal{O}(2^n \\log n) $\u3002\n\n```\n#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int maxn = 24;\nconst int mod = 1e9 + 7;\n\nint a[maxn + 2];\nint sum[1 << maxn];\nint f[1 << maxn];\nint bad[maxn + 2];\nint badcnt;\n\n#define lowbit(x) ((x) & -(x))\n\nint main() {\n\tint n, target;\n\tscanf(\"%d\", &n); for (int i = 0; i < n; i++) scanf(\"%d\", &sum[1 << i]); target = (1 << n) - 1;\n\tscanf(\"%d\", &badcnt); for (int i = 1; i <= badcnt; i++) scanf(\"%d\", &bad[i]);\n\tf[0] = 1; // \u521d\u59cb\u5316 \n\tfor (int i = 1; i <= target; i++) {\n\t\tsum[i] = sum[i xor lowbit(i)] + sum[lowbit(i)]; // \u8ba1\u7b97\u5f53\u524d\u72b6\u6001\u4e0b a[x] \u7684\u603b\u548c \n\t\tif (sum[i] != bad[1] && sum[i] != bad[2]) { // \u4e0d\u662f\u88ab\u7981\u6b62\u7684\u6570 \n\t\t\tfor (int j = i; j; j -= lowbit(j)) f[i] += f[i xor lowbit(j)], f[i] %= mod; // \u679a\u4e3e\u6240\u6709\u4e3a 1 \u7684\u4f4d\uff0c\u5373\u627e\u51fa\u53bb\u6389\u8be5\u4f4d\u540e\u7684\u72b6\u6001 \n\t\t}\n\t}\n\tprintf(\"%d\\n\", f[target]);\n\treturn 0;\n}\n```\n",
        "postTime": 1656323549,
        "uid": 188950,
        "name": "UruhaRushia",
        "ccfLevel": 6,
        "title": "P2396 \u9898\u89e3"
    },
    {
        "content": "## P2396 yyy loves Maths VII \u9898\u89e3\n\n### \u9898\u610f\u7b80\u8ff0\n\n\u7ed9\u51fa $ n $ \u5f20\u5361\u7247\u548c\u6700\u591a\u4e24\u4e2a\u5384\u8fd0\u683c\u5b50\uff0c\u6bcf\u6b21\u53ef\u4ee5\u4f7f\u7528\u4e00\u5f20\u5361\u7247\u5e76\u4f7f yyy \u524d\u8fdb $ a_i $ \u683c\uff0c\u6c42\u4f7f yyy \u5168\u90e8\u7528\u5b8c\u5361\u7247\u4e14\u4e0d\u8e29\u5230\u5384\u8fd0\u683c\u5b50\u7684\u65b9\u6848\u6570\u3002\n\n### \u505a\u6cd5\u7b80\u6790\n\n\u770b\u5230\u65b9\u6848\u6570\uff0c\u6bcf\u5f20\u5361\u7247\u53ea\u6709\u4e00\u5f20\uff0c\u53c8\u770b\u5230\u8fd9\u4e48\u5c0f\u7684\u6570\u636e\u8303\u56f4\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u60f3\u5230\u91c7\u53d6\u72b6\u538b dp \u7684\u65b9\u5f0f\u3002\n\n\u5c06\u6bcf\u5f20\u5361\u7247\u4f7f\u7528\u8fc7\u8bb0\u4e3a 1\uff0c\u672a\u4f7f\u7528\u8fc7\u8bb0\u4e3a 0\uff0c\u4f7f\u7528\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6570\u8bb0\u5f55\u72b6\u6001\u3002\n\n\u5bf9\u4e8e\u8f6c\u79fb\uff0c\u6211\u4eec\u5219\u53ef\u4ee5\u8003\u8651\u5728\u8ba1\u7b97\u6b64\u72b6\u6001\u65f6\uff0c\u4efb\u610f\u6263\u6389\u4f7f\u7528\u8fc7\u7684\u4e00\u5f20\u5361\u7247\u7684\u72b6\u6001\u80af\u5b9a\u88ab\u8ba1\u7b97\u8fc7\uff0c\u6211\u4eec\u4fbf\u53ef\u4ee5\u679a\u4e3e\u6700\u540e\u4e00\u5f20\u4f7f\u7528\u7684\u5361\u7247\uff0c\u4ece\u4e0a\u4e2a\u9636\u6bb5\u8f6c\u79fb\u3002\n\n\u4f46\u662f\u6ce8\u610f\u6570\u636e\u8303\u56f4\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u4f1a\u88ab\u5361\u5e38\uff0c\u9700\u8981\u4f18\u5316\uff0c\u6ce8\u610f\u5230\u6211\u4eec\u6bcf\u6b21\u679a\u4e3e\u65f6\u90fd\u662f\u53bb\u627e\u4e00\u4e2a\u5f53\u524d\u4e8c\u8fdb\u5236\u6570\u5bf9\u5e94\u4e3a 1 \u7684\u4f4d\uff0c\u6211\u4eec\u4fbf\u53ef\u4ee5\u4f7f\u7528 lowbit \u8fd0\u7b97\u4f18\u5316\u67e5\u627e\u7684\u6b65\u9aa4\uff0c\u4fbf\u53ef AC\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<iostream>\n#include<vector>\n#define mod 1000000007\n#define ll long long\nusing namespace std;\nint num[30];\nint dp[(1<<24)];\nint val[(1<<24)];\nint main(){\n\tint n,a=0,b=0,m;\n\tcin>>n;\n\tfor(int i=1;i<=n;i++) cin>>val[(1<<(i-1))];\n\tcin>>m;\n\tif(m==1) cin>>a;\n\telse if(m==2) cin>>a>>b;\n\tdp[0]=1;\n\tfor(int i=0;i<(1<<n);i++){\n\t\tif(i==0) continue;\n\t\tint tmp=i,x,flag=0;\n\t\twhile(tmp){\n\t\t\tx=(tmp&(-tmp));\n\t\t\tif(!flag){\n\t\t\t\tval[i]=val[i-x]+val[x];\n\t\t\t\tif(val[i]==a || val[i]==b) break;\n\t\t\t\tflag^=1;\n\t\t\t}\n\t\t\tdp[i]=(dp[i]+dp[i-x])%mod;\n\t\t\ttmp-=x;\n\t\t}\n\t}\n\tcout<<dp[(1<<n)-1];\n}\n```\n",
        "postTime": 1655472595,
        "uid": 421265,
        "name": "eastcloud",
        "ccfLevel": 4,
        "title": "P2396 yyy loves Maths VII \u9898\u89e3"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P2396)\n\n---\n>>\u9898\u76ee\u5927\u610f\n\n> \u7ed9\u51fa\u4e00\u5806\u6570\uff0c\u8ba9\u4f60\u5bf9\u5176\u8fdb\u884c\u6392\u5e8f\uff0c\u6c42\u6709\u591a\u5c11\u79cd\u65b9\u6848\u6ee1\u8db3\u4efb\u610f\u524d\u7f00\u548c\u4e0d\u4f1a\u51fa\u73b0\u7ed9\u5b9a\u7684\u6570\u5b57\u3002\n---\n\n\u770b\u5230\u8fd9\u4e48\u5c0f\u7684\u6570\u636e\u8303\u56f4\u679c\u65ad\u72b6\u538b\u3002\n\n\u4ee4 $f_S$ \u4e3a\u9009\u62e9\u72b6\u6001\u4e3a $S$ \u7684\u65b9\u6848\u6570\uff0c\u6613\u77e5\u6700\u7ec8\u7b54\u6848\u4e3a $f_{2^n-1}$ \u3002\n\n\u8003\u8651 $f_S$ \u73c2\u4ee5\u7531\u54ea\u4e9b\u524d\u7ee7\u72b6\u6001 $f_T$ \u8f6c\u79fb\u800c\u6765\uff0c\u56e0\u4e3a\u6bcf\u6b21\u53ea\u80fd\u9009\u4e00\u4e2a\uff0c\u6240\u4ee5 $S$ \u4e0e $T$ \u5e94\u8be5\u6ee1\u8db3\uff1a$S \\oplus  T = 2^p | S>T$\uff0c\u5f02\u6216\u76f8\u5f53\u4e0e\u628a\u9664\u4e86\u9009\u62e9\u7684\u6570\u4e4b\u5916\u7684\u7684\u53bb\u6389\uff0c\u7136\u540e\u53ea\u5269\u4e00\u4e2a\u6570\u5c31\u5fc5\u7136\u662f $2^p$ \u4e86\u3002\n\n\u76f4\u63a5\u4e00\u4e2a\u4e2a\u679a\u4e3e $T$ \u80af\u5b9a\u662f\u4f1a\u7206\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u62ff\u4e00\u4e2a\u4e1c\u897f\u8bb0\u5f55\u6700\u540e\u4e00\u4e2a\u4f4d\u662f\u4ec0\u4e48\uff0c\u7136\u540e\u5c06\u4e00\u4e2a\u539f\u503c\u7b49\u4e8e $S$ \u7684\u5bc4\u5b58\u5668\u5f02\u6216\u6389\u5979\uff0c\u7136\u540e\u62ff\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7684\u6700\u540e\u4e00\u4f4d\u53bb\u5f02\u6216 $S$ \u5373\u53ef\u679a\u4e3e\u5230\u6240\u6709\u53ef\u80fd\u7684 $T$\u3002\n\n\u4e0a\u9762\u7684\u4e00\u4e2a\u8fc7\u7a0b\u90fd\u79bb\u4e0d\u5f00\u4e00\u4e2a\u64cd\u4f5c\uff1a\u53d6\u6700\u540e\u4e00\u4f4d\uff0c\u60f3\u5fc5\u5b66\u8fc7\u6811\u72b6\u6570\u7ec4\u7684\u540c\u5b66\u90fd\u80fd\u56de\u5fc6\u8d77\u6765\u5b83\u662f $\\text{lowbit(x)}$\u3002\n\n\u6211\u4eec\u518d\u628a\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5217\u51fa\uff1a\n\n$$f_S=\\sum_{T \\oplus S = 2^p}^{(0,S)} f_T$$\n\n\u8fd9\u662f\u6ca1\u6709\u9650\u5236\u7684\u60c5\u51b5\u3002\n\n\u90a3\u5982\u679c\u6709\u9650\u5236\u5462\uff1f\n\n\u5f88\u7b80\u5355\uff0c\u53ea\u8981 $S$ \u6240\u8868\u793a\u7684\u9009\u62e9\u72b6\u6001\u548c\u88ab\u9650\u5236\u8d4b\u503c\u4e3a 0 \u5373\u53ef\u3002\n\n\u8fd9\u4e2a\u548c\u73c2\u4ee5\u76f4\u63a5\u6bcf\u6b21 $O(\\log n)$ \u66b4\u529b\u6c42\uff0c\u4e5f\u53ef\u4ee5\u7c7b\u4f3c\u4e8e $f$ \u4e00\u6837\u6c42\u3002\n\n### Code\n\n```cpp\n#include <stdio.h>\n#include <algorithm>\n#include <string.h>\n#define N 100005\n#define lowbit(x) (x&(-x))\nusing namespace std;\ntypedef long long ll;\nconst int INF=0x3f3f3f3f;\nconst int mo=1e9+7;\ninline int read(){\n\tchar ch=getchar();int x=0, f=1;\n\twhile(ch<'0'||ch>'9'){if(ch=='-') f=-1; ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\n\treturn x*f;\n}\nint n, k, notin[3], R;\nint a[1<<24], f[1<<24];\nsigned main(){\n\tn=read(), R=1<<n;\n\tfor(int i=1; i<R; i<<=1) a[i]=read();\n\tk=read();for(int i=1; i<=k; i++) notin[i]=read();\n\tf[0]=1;\n\tfor(int S=1; S<R; S++){\n\t\ta[S]=a[S^lowbit(S)]+a[lowbit(S)];\n\t\tif(a[S]==notin[1]||a[S]==notin[2]) continue;\n\t\tfor(int T=S; T; T^=lowbit(T)) f[S]=(f[S]+f[S^lowbit(T)])%mo;\n\t}\n\tprintf(\"%d\", f[R-1]);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1622303814,
        "uid": 341102,
        "name": "ReKoJ",
        "ccfLevel": 0,
        "title": "P2396 yyy loves Maths VII"
    },
    {
        "content": "\u72b6\u538b\u597d\u9898\u3002\n\n### \u9898\u610f\n\n> \u7ed9\u4f60\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6b63\u6574\u6570\u5e8f\u5217 $a$\uff0c\u518d\u6709 $k$ \u4e2a\u6b63\u6574\u6570\u3002\n\u6c42\u6709\u591a\u5c11\u79cd $a$ \u7684\u6392\u5217\u65b9\u5f0f\u4f7f\u5f97\u5176\u524d\u7f00\u548c\u4e0d\u4f1a\u6210\u4e3a\u90a3 $k$ \u4e2a\u6570\u91cc\u7684\u4efb\u610f\u4e00\u4e2a\u3002\n\n### \u9898\u89e3\n\n\u56e0\u4e3a $n \\le 24$\uff0c\u660e\u663e\u662f\u72b6\u538b\u3002\n\n\u5047\u8bbe $f_i$ \u8868\u793a\u5728\u72b6\u6001\u4e3a $i$ \u7684\u60c5\u51b5\u4e0b\u7684\u7ec4\u5408\u65b9\u6cd5\u6570\uff0c\u5219\u7b54\u6848\u4e3a $f_{2^n-1}$\u3002\n\n\u8003\u8651\u5982\u4f55\u8f6c\u79fb\u3002\n\n\u5bf9\u4e8e $f_i$ \u53ef\u4ee5\u7531 $f_j$ \u8f6c\u79fb\u800c\u6765\uff0c\u5176\u4e2d $j$ \u662f $i$ \u53bb\u6389\u4e00\u4e2a\u5143\u7d20\u5f97\u6765\u7684\u3002\n\n\u90a3\u4e48\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5c31\u662f $f_i = \\sum f_j$\uff0c\u5728\u5faa\u73af\u5185\u679a\u4e3e\u6bcf\u4e00\u4f4d\u7684\u60c5\u51b5\u5373\u53ef\u3002\n\n\u56e0\u4e3a\u8981\u7528\u5230\u53d6\u6700\u540e\u4e00\u4f4d\u7684\u64cd\u4f5c\uff0c\u6240\u4ee5\u8981\u7528\u5230 lowbit \u8fdb\u884c\u4f18\u5316\u3002\n\n\u5b9a\u4e49\u4e00\u4e2a\u6570\u7ec4 a\uff0c\u5176\u4e2d $a_i$ \u5b58\u50a8\u5728\u60c5\u51b5 $i$ \u4e0b\u7684\u5143\u7d20\u4e4b\u548c\uff0c\u5f88\u5bb9\u6613\u7406\u89e3\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u65b0\u7684 $a_i$\uff0c$a_i = a_{lowbit(i)} + a_{i \\, \\operatorname{xor}  \\, lowbit(i)}$\u3002\n\n### \u4ee3\u7801\n\n\u4eb2\u6d4b\u4e0d\u5f00 O2 \u80fd\u8fc7\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\n#define lb(x) (x&(-x))\nusing namespace std;const ll N=24,mod=1e9+7;\nint a[1<<N],f[1<<N],n,k,b[N],lim;\nint main(){\n    cin>>n;lim=(1<<n)-1;for(int i=1;i<=lim;i<<=1)cin>>a[i];\n    cin>>k;for(int i=1;i<=k;i++)cin>>b[i];f[0]=1;\n    for(int i=0;i<=lim;i++){\n\ta[i]=a[i^lb(i)]+a[lb(i)];\n\tif(a[i]!=b[1]&&a[i]!=b[2])\n\t    for(int j=i;j;j^=lb(j))\n            \tf[i]=(f[i^lb(j)]+f[i])%mod;\n    }cout<<f[lim];return 0;\n}\n```\n\n\u8fd8\u4f3c\u4e4e\u6709[\u53cc\u500d\u7ecf\u9a8c](https://www.luogu.com.cn/problem/CF327E)\u3002",
        "postTime": 1646732468,
        "uid": 540715,
        "name": "A_I_Skeleton",
        "ccfLevel": 0,
        "title": "P2396"
    },
    {
        "content": "\u6211\u5c1d\u8bd5\u5199\u4e00\u4e2a $\\purple{\\text{\u72b6\u538b}}$\n\n\u9898\u610f\uff1a\u7ed9\u5b9a\u957f\u5ea6\u4e3a $1\\le n\\le 24$ \u7684\u5e8f\u5217 $a$\uff0c\u6c42\u6709\u591a\u5c11\u79cd\u957f\u5ea6\u4e3a $n$ \u7684\u6392\u5217 $\\pi$\uff0c\u4f7f\u5f97$\\{x|x=\\sum_{i=1}^ga_{\\pi_i}(1\\le g\\le n)\\}$ \u4e2d\u4e0d\u5305\u542b\u7ed9\u5b9a\u7684\u81f3\u591a\u4e24\u4e2a\u6570\u3002\n\n\u4f60\u72b6\u538b\uff0c\u7528 $f_S$ \u8868\u793a\u9009\u62e9\u4e86 $S$ \u96c6\u5408\u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u5982\u679c\u96c6\u5408 $nxt$ \u4e4b\u548c\u4e0d\u4e3a\u4f60\u7ed9\u5b9a\u7684\u6570\u3002\n\n$$f_{nxt}\\leftarrow f_{nxt}+f_{pre}$$\n\n```cpp\n#include<stdio.h>\nint n,a[24],m;\nconst int p=1e9+7;\n#define add(a,b) ((a+=b)>=p&&(a-=p))\n#define mul(a,b) a=1ll*a*b%p;\nint f[1<<24],g[1<<24];\nint A,B;\nint G(int x){\n\tint ans=0;\n\tfor(int i=0;i<n;i++)\n\tif(x>>i&1)ans+=a[i];\n\treturn ans;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=0;i<n;i++)scanf(\"%d\",a+i);\n\tscanf(\"%d\",&m);\n\tif(m==0){\n\t\tint ans=1;\n\t\tfor(int i=1;i<=n;i++)mul(ans,i);\n\t\tprintf(\"%d\",ans);\n\t}else\n\t\tfor(int i=0;i<1<<n;i++)g[i]=G(i);\n\tif(m==1){\n\t\tscanf(\"%d\",&A);\n\t\tf[0]=1;\n\t\tfor(int S=0;S<1<<n;S++)\n\t\tfor(int i=0;i<n;i++)if(!(S>>i&1)){\n\t\t\tint T=S|(1<<i);\n\t\t\tif(g[T]!=A)add(f[T],f[S]);\n\t\t}\n\t\tprintf(\"%d\",f[(1<<n)-1]);\n\t}\n\tif(m==2){\n\t\tscanf(\"%d%d\",&A,&B);\n\t\tf[0]=1;\n\t\tfor(int S=0;S<1<<n;S++)\n\t\tfor(int i=0;i<n;i++)if(!(S>>i&1)){\n\t\t\tint T=S|(1<<i);\n\t\t\tif(g[T]!=A&&g[T]!=B)add(f[T],f[S]);\n\t\t}\n\t\tprintf(\"%d\",f[(1<<n)-1]);\n\t}\n}\n```\n\n\u7136\u540e\u4f60\u88ab\u5361\u5e38\u4e86\u3002\n\n\u6211\u4eec\u6ce8\u610f\u5230\u6709\u5f88\u591a\u5197\u4f59\u64cd\u4f5c\u767d\u767d\u8dd1\u4e86\u5f88\u591a\u4e2a $\\text{skip}$ \u7684 $\\text{if}$\uff0c\u4e8e\u662f\u4f60\u6362\u4e3a\u679a\u4e3e $T$\uff0c\u7136\u540e\u7528 `__builtin_ctz` \u628a $1$ \u53d6\u51fa\u6765\u5c31\u884c\u4e86\u3002\n\n```cpp\n#include<stdio.h>\nint n,a[24],m;\nconst int p=1e9+7;\n#define add(a,b) ((a+=b)>=p&&(a-=p))\n#define mul(a,b) a=1ll*a*b%p;\nint f[1<<24],g[1<<24];\nint A,B,S,T;\nint G(int x){\n\tint ans=0;\n\tfor(int i=x;i;i-=i&-i)ans+=a[__builtin_ctz(i)];\n\treturn ans;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=0;i<n;i++)scanf(\"%d\",a+i);\n\tscanf(\"%d\",&m);\n\tif(m==0){\n\t\tint ans=1;\n\t\tfor(int i=1;i<=n;i++)mul(ans,i);\n\t\tprintf(\"%d\",ans);\n\t}else\n\t\tfor(int i=0;i<1<<n;i++)g[i]=G(i);\n\tif(m==1){\n\t\tscanf(\"%d\",&A);\n\t\tf[0]=1;\n\t\tfor(T=1;T<1<<n;T++)\n\t\tfor(int i=T;i;i-=i&-i){\n\t\t\tS=T^(1<<__builtin_ctz(i));\n\t\t\tif(g[T]!=A)add(f[T],f[S]);\n\t\t}\n\t\tprintf(\"%d\",f[(1<<n)-1]);\n\t}\n\tif(m==2){\n\t\tscanf(\"%d%d\",&A,&B);\n\t\tf[0]=1;\n\t\tfor(T=1;T<1<<n;T++)\n\t\tfor(int i=T;i;i-=i&-i){\n\t\t\tS=T^(1<<__builtin_ctz(i));\n\t\t\tif(g[T]!=A&&g[T]!=B)add(f[T],f[S]);\n\t\t}\n\t\tprintf(\"%d\",f[(1<<n)-1]);\n\t}\n}\n```",
        "postTime": 1636273622,
        "uid": 100325,
        "name": "peterwuyihong",
        "ccfLevel": 7,
        "title": "P2396 yyy loves Maths VII \u8bb0\u5f55"
    }
]
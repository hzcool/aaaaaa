[
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P7634)\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/lbh2021/p/14940741.html)\n\n**\u7b97\u6cd5\u5206\u6790\uff1a\u7ebf\u6027 dp**\n\n\u5e94\u8be5\u6765\u8bf4\u662f\u6bd4\u8f83\u660e\u663e\u7684\u7ebf\u6027 dp\uff0c\u5173\u952e\u5728\u4e8e\u5982\u4f55\u8bbe\u8ba1\u72b6\u6001\u53ca\u8f6c\u79fb\u65b9\u7a0b\u3002\n\n\u5728\u672c\u9898\u4e2d\u6d89\u53ca\u4e24\u79cd\u201c\u9898\u76ee\u201d\uff0c\u5373\u4ec5\u80fd\u88ab\u89c6\u4e3a\u4e00\u4e2a\u96be\u5ea6\u7684\u201c\u9898\u76ee\u201d\u548c\u80fd\u88ab\u89c6\u4e3a\u6709\u4e24\u4e2a\u8fde\u7eed\u96be\u5ea6\u7684\u201c\u9898\u76ee\u201d\u3002\u4f5c\u4e3a\u4e24\u79cd\u4e0d\u540c\u7684\u60c5\u51b5\uff0c\u4e00\u7ef4\u7684 dp \u660e\u663e\u662f\u4e0d\u591f\u7684\uff0c\u9700\u8981\u52a0\u5165\u7b2c\u4e8c\u7ef4\u3002\n\n\u4e3a\u4e86\u8868\u8ff0\u65b9\u4fbf\uff0c\u4e0b\u6587\u79f0\u201c\u4ec5\u80fd\u88ab\u89c6\u4e3a\u4e00\u4e2a\u96be\u5ea6\u7684\u2018\u9898\u76ee\u2019\u201d\u4e3a\u201c\u7b2c\u4e00\u79cd\u9898\u76ee\u201d\uff0c\u5176\u6570\u91cf\u8bb0\u4e3a $a_i$\uff1b\u79f0\u201c\u80fd\u88ab\u89c6\u4e3a\u6709\u4e24\u4e2a\u8fde\u7eed\u96be\u5ea6\u7684\u2018\u9898\u76ee\u2019\u201d\u4e3a\u201c\u7b2c\u4e8c\u79cd\u9898\u76ee\u201d\uff0c\u5176\u6570\u91cf\u8bb0\u4e3a $b_i$\u3002\u5728\u5206\u6790\u4e2d\uff0c\u5c06\u7701\u7565\u201c\u53d6\u6a21\u201d\u8fd9\u4e00\u8fc7\u7a0b\u3002\n\n\u63a5\u4e0b\u6765\u5206\u6790 dp \u7684\u72b6\u6001\u53ca\u8f6c\u79fb\u65b9\u7a0b\u3002\n\n**\u72b6\u6001\uff1a**\n\n>\u6211\u4eec\u8bbe\u8ba1 $dp_{i,j}$ \u8868\u793a\u5bf9\u4e8e\u96be\u5ea6 $i$ \uff0c\u662f\u7528\u65b9\u6cd5 $j$ \u89e3\u51b3\u7684\u3002\u5176\u4e2d $j\\in\\{0,1\\}$\uff0c\u5728\u6b64\u8bb0 $j=0$ \u4e3a\u4f7f\u7528\u4e86\u7b2c\u4e00\u79cd\u9898\u76ee\uff0c$j=1$ \u4e3a\u4f7f\u7528\u4e86\u7b2c\u4e8c\u79cd\u9898\u76ee\uff08\u5f53\u7136\uff0c\u53cd\u8fc7\u6765\u4e5f\u4e00\u6837\uff09\u3002\n\n**\u8fb9\u754c\uff1a**\n\n> \u6839\u636e\u72b6\u6001\uff0c\u663e\u7136\u5730\uff0c$dp_{1,0}=a_1,dp_{1,1}=b_1$\uff0c\u8981\u6c42\u7684\u7b54\u6848\u4e3a $dp_{n,0}+dp_{n,1}$\n\n**\u8f6c\u79fb\u65b9\u7a0b\uff1a**\n\n> - \u6839\u636e\u9898\u610f\uff0c\u5bf9\u4e8e $j=0$ \u7684\u60c5\u51b5\uff0c\u8981\u8003\u8651\u96be\u5ea6 $i-1$ \u7684\u4f7f\u7528\u60c5\u51b5\u3002\u82e5\u4e0a\u4e00\u4e2a\u4f7f\u7528\u4e86\u7b2c\u4e00\u79cd\u9898\u76ee\uff0c\u90a3\u4e48\u5176\u8d21\u732e\u4e3a $dp_{i-1,0}\\times(a_i+b_{i-1})$\uff0c\u82e5\u4e0a\u4e00\u4e2a\u4f7f\u7528\u4e86\u76f8\u5e94\u7684\u7b2c\u4e8c\u79cd\u9898\u76ee\uff0c\u5219\u8d21\u732e\u4e3a $dp_{i-1,1}\\times(a_i+\\max(b_{i-1}-1,0))$\u3002\u7531\u4e8e\u4e0a\u4e00\u4e2a\u4f7f\u7528\u4e86\u7b2c\u4e8c\u79cd\u9898\u76ee\uff0c\u6570\u91cf\u987b $-1$\u3002\u540c\u65f6\u4e3a\u4e86\u9632\u6b62 $b_{i-1}=0$ \u7684\u60c5\u51b5\uff0c\u4e0e $0$ \u53d6\u6700\u5927\u503c\uff0c\u589e\u5f3a\u7a0b\u5e8f\u7684\u5bb9\u9519\u7387\u3002\n>\n> - \u5bf9\u4e8e$j=1$ \u7684\u60c5\u51b5\u8f83\u4e3a\u7b80\u5355\uff0c\u4e24\u79cd\u60c5\u51b5\u7684\u8d21\u732e\u5404\u4e3a $dp_{i-1,0}\\times b_i$ \u4ee5\u53ca $dp_{i-1,1}\\times b_i$\u3002\n>\n>   \u7efc\u4e0a\u6240\u8ff0\uff0c\u6709\uff1a\n>\n>   $$dp_{i,j}=\\begin{cases}dp_{i-1,0}\\times(a_i+b_{i-1})+dp_{i-1,1}\\times(a_i+\\max(b_{i-1}-1,0))&j=0\\\\dp_{i-1,0}\\times b_i+dp_{i-1,1}\\times b_i&j=1\\end{cases}$$ \n\n\u5728\u6b64\u8fc7\u7a0b\u4e2d\uff0c$i:2\\to n$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal{O}(n)$\uff0c\u6ee1\u8db3\u6761\u4ef6\u3002\n\n\u4e0b\u9762\u7ed9\u51fa\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define reg register\n#define F(i,a,b) for(reg int i=a;i<=b;++i)\nusing namespace std;\ninline int read();\nconst int N=1e5+10,mod=1e9+7;\nint n,a[N],b[N];\nll dp[N][2];\nint main() {\n\tn=read();\n\tF(i,1,n)a[i]=read();\n\tF(i,1,n-1)b[i]=read();\n\tdp[1][0]=a[1],dp[1][1]=b[1];\n\t//\u521d\u59cb\u5316 \n\tF(i,2,n){\n\t\tdp[i][0]=(dp[i-1][0]*(a[i]+b[i-1])+dp[i-1][1]*(a[i]+max(b[i-1]-1,0)))%mod;\n\t\tdp[i][1]=(dp[i-1][0]*b[i]+dp[i-1][1]*b[i])%mod;\n\t}//\u8f6c\u79fb \n\tprintf(\"%lld\",(dp[n][0]+dp[n][1])%mod);\n\treturn 0;\n}\ninline int read() {\n\treg int x=0;\n\treg char c=getchar();\n\twhile(!isdigit(c))c=getchar();\n\twhile(isdigit(c))x=(x<<1)+(x<<3)+(c^48),c=getchar();\n\treturn x;\n}\n```\n\n\u5199\u5230\u8fd9\u91cc\u5df2\u7ecf\u8db3\u591f\u4e86\uff0c\u4f46\u4e8b\u5b9e\u4e0a\uff0c\u7a7a\u95f4\u4ecd\u7136\u53ef\u4ee5\u4f18\u5316\u3002\u89c2\u5bdf\u5230 $dp_{i,0}$ \u548c $dp_{i,1}$ \u5747\u7531 $dp_{i-1,0}$ \u548c $dp_{i-1,1}$ \u8fed\u4ee3\u8f6c\u79fb\u8fc7\u6765\uff0c\u56e0\u6b64\u53ef\u4ee5\u7528\u4e00\u4e2a\u53d8\u91cf\u6765\u6eda\u52a8\u8bb0\u5f55\u3002\u4e0b\u9762\u7ed9\u51fa\u5229\u7528\u53d8\u91cf\u6eda\u52a8\u8bb0\u5f55\u7684\u4ee3\u7801\uff1a\n\n```cpp\n\tx=a[1],y=b[1];\n\tF(i,2,n){\n\t\tll xx=(x*(a[i]+b[i-1])+y*(a[i]+max(0,b[i-1]-1)))%mod;\n\t\tll yy=(x*b[i]+y*b[i])%mod;\n        //\u6eda\u52a8\n\t\tx=xx,y=yy;\n\t}\n```\n\n\u4e24\u4e2a\u4ee3\u7801\u5728\u672c\u8d28\u4e0a\u662f\u5b8c\u5168\u4e00\u81f4\u7684\u3002\n\n[AC](https://www.luogu.com.cn/record/52108575)\n\n\u6b22\u8fce\u4ea4\u6d41\u8ba8\u8bba\uff0c\u8bf7\u70b9\u4e2a\u8d5e\u54e6~",
        "postTime": 1624782125,
        "uid": 415473,
        "name": "\u262f\u262f\u67ab\u262f\u262f",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P7634 [COCI2010-2011#5] HONI"
    }
]
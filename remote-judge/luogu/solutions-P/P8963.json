[
    {
        "content": "# \u52a0\u51cf\u6cd5\u6784\u9020 \u9898\u89e3\n\n## Tag\n\n\u6570\u5b66\uff0c\u5feb\u6392\u601d\u60f3\u3002\n\n## Preface\n\n\u7c7b\u4f3c\u62df\u5408\u76f4\u7ebf\u7684\u4e1c\u897f\uff0c\u7f51\u4e0a\u67e5\u8fc7\u7684\u62df\u5408\u76f4\u7ebf\u90fd\u662f\u65b9\u5dee\u7684\uff0c\u6240\u4ee5\u51fa\u4e86\u4e2a\u5947\u602a\u7684\u7edd\u5bf9\u503c\u5dee\u3002\u5982\u679c\u8d5b\u65f6\u6709\u4eba\u7528\u795e\u79d8\u8fed\u4ee3\u8fc7\u4e86\u6233\u6211\uff0c\u53cd\u6b63\u6211\u6ca1\u60f3\u5230\u3002\u548c\u7fa4\u91cc\u8001\u54e5\u8ba8\u8bba\u4e86\u534a\u5929\uff0c\u6700\u7ec8\u5f97\u51fa\u4e00\u4e2a\u6ee1\u610f\u89e3\u3002\n\n## Solution\n\n\u9996\u5148\u53d1\u73b0 $y_{i+1}=y_i+y_1+k$\uff0c\u4e5f\u5c31\u662f\u662f\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\u3002\u90a3\u4e48\u4e3a\u4e86\u65b9\u4fbf\u4e0d\u59a8\u8bbe $y_i=ki+b$\u3002\u663e\u7136\u659c\u7387\u548c\u622a\u8ddd\u90fd\u662f\u6574\u6570\u3002\u6b64\u65f6 $d(x,y)=\\sum\\limits_{i=1}^n|ki+b-x_i|$\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u786e\u5b9a $k,b$ \u65f6 $O(n)$ \u7b97 $d(x,y)$ \u4e86\u3002\n\n\n\u63a5\u4e0b\u6765\u8003\u8651\u600e\u4e48\u628a $V$ \u8fd9\u4e2a\u5de8\u5927\u7684\u4e1c\u897f\u89e3\u51b3\u3002\u4e0d\u59a8\u8bb0 $x$ \u7684\u8303\u56f4\u4e3a $[-W, W]$\u3002\u8003\u8651\u5230\u53ef\u4ee5\u679a\u4e3e\u659c\u7387\uff0c\u659c\u7387\u7684 $k $ \u8303\u56f4\u9996\u5148\u5728 $[-\\frac{2V}{n-1},\\frac{2V}{n-1}]$ \u8303\u56f4\u5185\u3002\u540c\u6837\u4e5f\u53ef\u4ee5\u5408\u7406\u731c\u6d4b $|k|=O(\\frac{W}{n})$\u3002\n\n\u4e0b\u9762\u8bc1\u660e $|k|\\le \\frac{2\\sqrt2V}{n}+O(1)$\u3002\n\n\u663e\u7136\u6781\u7aef\u60c5\u51b5\u662f\u659c\u7387\u6700\u5927\u7684\u76f4\u7ebf\u8fc7\u4e2d\u5fc3\u70b9\uff08\u6307 $(\\frac{n+1}2,0)$\uff09\uff0c\u800c\u5b83\u6bd4\u6240\u6709\u7684\u8fc7\u8fd9\u4e2a\u70b9\u90fd\u4f18\u79c0\u3002\n\n\u8fd9\u91cc\u5f88\u96be\u7b97\uff0c\u6211\u4eec\u4e0d\u59a8\u7528\u79ef\u5206\uff08\u8fd9\u91cc\u5728\u56fe\u4e2d\u8868\u793a\u4e3a\u9762\u79ef\uff09\u4ee3\u66ff\u4e00\u5927\u5806\u7edd\u5bf9\u503c\u7684\u548c\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lpbf00ou.png)\n\n\u5982\u56fe\uff0c\u8bbe $\\frac{\\text{AB}}{\\text{AF}}=m$\u3002\n\n\u90a3\u4e48\uff0c\u6211\u4eec\u5c31\u9700\u8981\u627e\u5230\u8fd9\u6837\u4e00\u6761\u76f4\u7ebf AF\uff0c\u4f7f\u5f97\u65e0\u8bba BC \u600e\u4e48\u53d6\uff0c\u90fd\u6709 $2\\Delta\\text{AFE}<2\\Delta\\text{CDE}+2\\Delta\\text{ACB}$\u3002\n\n\u8fd9\u91cc\u4e0d\u59a8\u8bbe CE \u957f\u4e3a $x$\uff0c\u90a3\u4e48 $\\frac{2\\Delta\\text{CDE}+2\\Delta\\text{ACB}}{2\\Delta\\text{AFE}}=(1-x)m+\\frac{x^2m}{1-x+m}\\le1$ \u5728 $(0,1)$ \u4e0a\u603b\u6210\u7acb\u3002\u5bb9\u6613\u53d1\u73b0\uff0c\u8fd9\u4e2a\u51fd\u6570\u5fc5\u5b9a\u8fc7 $(1,1)$\uff0c\u53ef\u4ee5\u5f97\u51fa\uff0c\u6781\u9650\u60c5\u51b5\u662f $y=1$ \u662f\u8fd9\u4e2a\u51fd\u6570\u7684\u5207\u7ebf\uff0c\u5207\u70b9\u4e3a $(1, 1)$\u3002\u7136\u540e\u7ecf\u8fc7\u7b80\u5355\u7684\u6c42\u5bfc\u53ef\u4ee5\u5f97\u5230\uff0c$m\\le 2\\sqrt2+1$\u3002\u6b64\u65f6\u53ef\u4ee5\u7b97\u51fa\u659c\u7387\u4e3a $\\frac{2\\sqrt2V}{n}$ \u7ea7\u522b\u3002\n\n\u90a3\u4e48 $k$ \u53ea\u6709 $O(\\min\\{\\frac Wn,\\frac Vn\\})$ \u79cd\u53d6\u503c\u3002\u8fd9\u65f6\u56fa\u5b9a $k$\uff0c\u90a3\u4e48 $d(x,y)$ \u5c31\u53d8\u6210\u4e86\u5173\u4e8e $b$ \u7684\u51fd\u6570\u3002$d(x,y)=\\sum\\limits_{i=1}^n|b-(x_i-ki)|$\u3002\n\n\u770b\u5230\u7edd\u5bf9\u503c\uff0c\u60f3\u5230\u51e0\u4f55\u610f\u4e49\u3002\u628a\u6240\u6709 $x_i-ki$ \u6254\u5230\u6570\u8f74\u4e0a\uff0c\u90a3\u4e48\u5f53 $n$ \u662f\u5947\u6570\u65f6\uff0c$f(x,y)$ \u6700\u5c0f\u5373 $b$ \u53d6\u5230\u8fd9 $n$ \u4e2a\u6570\u7684\u4e2d\u4f4d\u6570\uff1b\u5f53 $n$ \u662f\u5076\u6570\u65f6\uff0c$f(x,y)$ \u6700\u5c0f\u5373 $b$ \u53d6\u5230\u4e24\u4e2a\u4e2d\u4f4d\u6570\u4e4b\u95f4\u3002\u4f46\u662f\u4f1a\u53d1\u73b0\u5176\u5b9e\u6781\u503c\u60c5\u51b5\u4e0d\u4e00\u5b9a\u80fd\u53d6\u5230\uff0c\u56e0\u4e3a\u6709 $-V\\le y_i\\le V$ \u7684\u9650\u5236\u3002\u8fd9\u4e2a\u65f6\u5019\u4f1a\u53d1\u73b0 $k$ \u53ef\u4ee5\u51b3\u5b9a $b$ \u7684\u53d6\u503c\uff0c\u7136\u540e\u8fd9\u4e2a\u53d6\u503c\u8303\u56f4\u662f\u4e00\u6bb5\u6574\u6570\u3002\u6b64\u65f6\u5982\u679c\u6574\u6570\u8986\u76d6\u81f3\u5c11\u4e00\u4e2a\u4e2d\u4f4d\u6570\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u76f4\u63a5\u53d6\uff1b\u5426\u5219\u5c31\u53d6\u79bb\u4e2d\u95f4\u6700\u8fd1\u7684\u3002\n\n\u90a3\u4e48\u73b0\u5728\u8ba1\u7b97\u74f6\u9888\u5c31\u53d8\u6210\u4e86\u8ba1\u7b97\u4e2d\u4f4d\u6570\u3002\u901a\u8fc7\u7c7b\u4f3c\u5feb\u6392\u7684\u601d\u8def\uff0c\u8ba1\u7b97\u4e2d\u4f4d\u6570\u53ef\u4ee5\u505a\u5230\u5e73\u5747 $O(n)$\u3002\u90a3\u4e48\u8ba1\u7b97\u51fa\u540e\u8fd8\u5f97\u7b97\u4e00\u4e2a $d$\uff0c\u4e5f\u662f $O(n)$ \u7684\u3002\u90a3\u4e48\u6700\u7ec8\u590d\u6742\u5ea6\u5373\u4e3a $O(\\min\\{\\frac Wn,\\frac Vn\\}n)=O(\\min\\{W,V\\})$\u3002\n\n## Code \n\n\n```cpp\n#include <iostream>\n#include <algorithm>\n#include <cmath>\nusing ll = long long;\n\n// \u5feb\u8bfb\u677f\u5b50\n\nint n;\nll V;\nll x[10000007];\nll ansd = 1e18, ansk, ansb;\nll z[10000007];\nvoid eval(ll k, ll b) {\n  ll res = 0;\n  for (int i = 1; i <= n; ++i) {\n    res += std::abs(b - z[i]);\n  }\n  if (res < ansd) {\n    ansd = res;\n    ansk = k, ansb = b;\n  }\n}\nvoid calc(ll k) {\n  ll bl = std::max(-V - k, -V - n * k);\n  ll br = std::min(V - k, V - n * k);\n  for (int i = 1; i <= n; ++i) {\n    z[i] = x[i] - k * i;\n  }\n  std::nth_element(z + 1, z + (n + 1) / 2, z + n + 1);\n  if (n & 1) {\n    ll medium = z[(n + 1) / 2];\n    if (bl > medium) {\n      eval(k, bl);\n    } else if (br < medium) {\n      eval(k, br);\n    } else {\n      eval(k, medium);\n    }\n  } else {\n    ll medium1 = z[(n + 1) / 2];\n    for (int i = (n + 2) / 2 + 1; i <= n; ++i) {\n      if (z[i] < z[(n + 2) / 2]) {\n        std::swap(z[(n + 2) / 2], z[i]);\n      }\n    }\n    ll medium2 = z[(n + 2) / 2];\n    if (br < medium1) {\n      eval(k, br);\n    } else if (bl > medium2) {\n      eval(k, bl);\n    } else if (bl <= medium1 && medium1 <= br) {\n      eval(k, medium1);\n    } else {\n      eval(k, medium2);\n    }\n  }\n}\nint main() {\n  io.read(n), io.read(V);\n  for (int i = 1; i <= n; ++i) {\n    io.read(x[i]);\n  }\n  if (n == 1) {\n    ll x1 = x[1];\n    if (x[1] > V) x[1] = V;\n    if (x[1] < -V) x[1] = -V;\n    io.write(0, ' '), io.write(std::abs(x1 - x[1]), '\\n'), io.write(x[1]);\n    return 0;\n  }\n  ll ak = std::min(ll(28284271.25 / (n - 1) + 2), (V << 1) / (n - 1));\n  for (int k = -ak; k <= ak; ++k) calc(k);\n  io.write(-ansb, ' '), io.write(ansd, '\\n');\n  for (int i = 1; i <= n; ++i) io.write(i * ansk + ansb, ' ');\n  return 0;\n}\n```",
        "postTime": 1672969724,
        "uid": 306090,
        "name": "0x3b800001",
        "ccfLevel": 5,
        "title": "\u52a0\u51cf\u6cd5\u6784\u9020 \u9898\u89e3"
    }
]
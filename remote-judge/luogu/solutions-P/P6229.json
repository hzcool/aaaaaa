[
    {
        "content": "[\u9898\u9762\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P6229)\n\u5e0c\u671b\u65e9\u65e5\u6709\u597d\u7684spj\u3002\n\n\u770b\u5230\u8fd9\u9053\u9898\u5e94\u8be5\u53ef\u4ee5\u76f4\u63a5\u79d2\u4e86$O(n^3)$\uff1a\u679a\u4e3e\u7b2c\u4e00\u4e2a\u4e32\u4e2d\u7684\u4e24\u4e2a\u7aef\u70b9\uff0c\u7136\u540e\u679a\u4e3e\u7b2c\u4e8c\u4e2a\u4e32\u7684\u91cd\u6784\u5faa\u73af\u5f00\u59cb\u7684\u5730\u65b9\uff0c\u4e24\u8fb9\u8dd1lcp/lcs\u770b\u80fd\u5426\u6210\u7acb\n\u3002\n\u7136\u540e\u4f60\u53d1\u73b0lcp\u548clcs\u663e\u7136\u53ef\u4ee5hash+\u500d\u589e$O(n^2logn)$\u8dd1\u51fa\u6765\uff0c\u5173\u952e\u662f\u5224\u65ad\u7684\u5730\u65b9\u3002\n\n\u8bbe$f_{i,j}$\u4e3a\u7b2c\u4e00\u4e2a\u4e32\u7684$j$\u548c\u7b2c\u4e8c\u4e2a\u4e32\u7684$i$\u540c\u65f6\u5411\u5de6\u8dd1\u80fd\u8dd1\u5230\u7684\u957f\u5ea6\uff0c$g_{i,j}$\u4e3a\u5411\u53f3\u3002\n\n\u90a3\u4e48\u6211\u4eec\u9700\u8981\u5224\u65ad\u7684\u662f\u5bf9\u4e8e\u4e00\u4e2a\u533a\u95f4$[j,k]$\u6709\u6ca1\u6709\u4e00\u4e2a$i$\u6ee1\u8db3$f_{i,j}+g_{i+1,k}\\geq k-j+1$\n\n\u79fb\u9879\uff0c\u53d8\u6210$f_{i,j}+j-1\\geq k-g_{i+1,k}$\uff0c\u4e5f\u5c31\u662f\u56fa\u5b9a$i,j$\u65f6\u4f60\u9700\u8981\u627e\u5230\u6700\u5927\u7684$k$\u6ee1\u8db3\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u90a3\u4e48\u9884\u5904\u7406\u540e\u7f00min\u500d\u589e\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n^2logn)$\n\ncode:\n```cpp\n#include<cstdio>\n#include<cstring>\n#define N 3000\n#define mod 1000000007\n#define ll long long\n#define I inline \n#define max(a,b) ((a)>(b)?(a):(b))\n#define min(a,b) ((a)<(b)?(a):(b))\nusing namespace std;\nint  n,m,k,x,y,z,lg[N+5],st[N+5],f1[N+5],f2[N+5],now,pus,ans,tot1,tot2,l,r,mid;ll f[N+5],g[N+5],ba[N+5],inv[N+5];\nchar a[N+5],b[N+5];\nI ll mpow(ll x,int y=mod-2){ll ans=1;while(y) (y&1)&&(ans=ans*x%mod),y>>=1,x=x*x%mod;return ans;}\nI ll findf(int x,int y){return (f[y]-f[x-1]+mod)*inv[x]%mod;}\nI ll findg(int x,int y){return (g[y]-g[x-1]+mod)*inv[x]%mod;}\nI void swap(char &x,char &y){char c=x;x=y;y=c;}\nI void work(int i,int flag){\n\tregister int j,h;\n\tfor(j=1;j<=m;j++)g[j]=(g[j-1]+(b[j]-'a'+1)*ba[j])%mod;\n\tfor(j=1;j<=n;j++){\n\t\tnow=i-1;pus=j;l=0;r=i-1;\n\t\twhile(l+1<r) mid=l+r>>1,(findg(mid,i-1)==findf(j-(i-mid)+1,j)?r:l)=mid;\n\t\tf1[j]=i-r;\n\t\tnow=i;pus=j;l=i;r=n+1;\n\t\twhile(l+1<r) mid=l+r>>1,(findg(i,mid)==findf(j,j+(mid-i))?l:r)=mid;\n\t\t//printf(\"%lld %lld\\n\",findg(5,6),findf(4,5));\n\t\tf2[j]=l-i+1;\n\t}\n\tfor(st[n+1]=1e9,j=n;j;j--)  st[j]=min(st[j+1],j-f1[j]);\n//\tprintf(\"%d\\n\",i);printf(\"%s\\n\",b+1);for(j=1;j<=n;j++) printf(\"%d %d\\n\",f1[j],f2[j]);printf(\"\\n\");\n\tfor(j=1;j<=n;j++){\n\t\tnow=n;\n\t\tfor(h=lg[n];~h;h--) if(now>=(1<<h)&&st[now-(1<<h)+1]>f2[j]+j-1) now-=(1<<h);\n\t\tif(now-j+1>ans) ans=now-j+1,/*printf(\"%d %d %d %d %d %s\\n\",ans,i,f1[now],f2[j],flag,b+1),*/tot1=j-1,tot2=(flag!=1?(m-(i+f2[j])+1):(i-f1[now]-1));\n\t}\n\tfor(j=1;j<=m/2;j++) swap(b[j],b[m-j+1]);\n}\nint main(){\n//\tfreopen(\"necklace.in\",\"r\",stdin);freopen(\"necklace.out\",\"w\",stdout);\n\tregister int i,j,h;scanf(\"%s%s\",a+1,b+1);n=strlen(a+1);m=strlen(b+1);k=max(n,m);\n\tfor(i=2;i<=k;i++)lg[i]=lg[i/2]+1;ba[0]=inv[0]=1;\n\tfor(i=1;i<=k;i++) ba[i]=ba[i-1]*131%mod,inv[i]=inv[i-1]*mpow(131)%mod;\n\tfor(i=1;i<=n;i++)f[i]=(f[i-1]+(a[i]-'a'+1)*ba[i])%mod;\n\tfor(i=1;i<=m+1;i++)work(i,1),work(m-i+2,-1);\n\tprintf(\"%d\\n%d %d\",ans,tot1,tot2);\n}\n```\n\u4ea4\u4e0a\u53bb\u53d1\u73b0\u548c$O(n^3)$\u66b4\u529b\u540c\u5206\u3002/cy\n\n\u7136\u540e\u5361\u4e0b\u5e38\u53d1\u73b0\u4e24\u4e2alcp\u548clcs\u5176\u5b9e\u53ef\u4ee5\u9012\u63a8\u505a\u5230$O(n^2)$\u5927\u5927\u51cf\u5c0f\u4e86\u5e38\u6570\u3002\u8fd9\u4e2a\u590d\u6742\u5ea6\u5176\u5b9eloj\u4e0a\u5c31\u53ef\u4ee5\u8fc7\u4e86\u3002\n\n\u7136\u800c\u8fd9\u4e2alog\u8ba9\u4eba\u5f88\u4e0d\u723d\u3002\n\n\u770b\u5230\u540e\u9762\u8fd9\u4e2a\u4e8c\u5206\uff0c\u5982\u679c\u6211\u4eec\u80fd\u4fdd\u8bc1`f2[j]+j-1`\u6709\u5e8f\u6211\u4eec\u5176\u5b9e\u53ef\u4ee5\u53cc\u6307\u9488\u7ef4\u62a4\u3002\n\n\u53c8\u56e0\u4e3a\u8fd9\u4e2a\u5f88\u5c0f\u4e0d\u8d85\u8fc7$n$\u6240\u4ee5\u53ef\u4ee5\u6876\u6392\u4e4b\u540e\u7ef4\u62a4\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n^2)$\u5c0f\u5e38\u6570\uff0c[LOJ\u8bc4\u6d4b\u8bb0\u5f55](https://loj.ac/s/1130014)\u53ef\u4ee5\u53d1\u73b0\u5f88\u5feb\u3002\ncode\uff1a\n```cpp\n#include<cstdio>\n#include<cstring>\n#define N 3000\n#define mod 1000000007\n#define I inline \n#define max(a,b) ((a)>(b)?(a):(b))\n#define min(a,b) ((a)<(b)?(a):(b))\nusing namespace std;\nint  n,m,k,x,y,z,lg[N+5],st[N+5],f1[N+5],f2[N+5],now,pus,ans,tot1,tot2,f[N+5];\nchar a[N+5],b[N+5];\nI void swap(char &x,char &y){char c=x;x=y;y=c;}\nI void work(int i,int flag){\n\tregister int j,l;\n\tfor(j=n;j;j--) f1[j]=(b[i-1]==a[j])?f1[j-1]+1:0;\n\tfor(j=n;j;j--){if(f2[j-1]>1){f2[j]=f2[j-1]-1;continue;}f2[j]=0;while(j+f2[j]<=n&&i+f2[j]<=m&&b[i+f2[j]]==a[j+f2[j]]) f2[j]++;}\n\tfor(st[n+1]=1e9,j=n;j;j--)  st[j]=min(st[j+1],j-f1[j]);\n\tmemset(f,0x3f,sizeof(f));for(j=1;j<=n;j++) f[f2[j]+j-1]=min(j,f[f2[j]+j-1]);l=1;\n\tfor(j=1;j<=n;j++){\n\t\twhile(st[l]<=j) l++;\n\t\tif(l-f[j]>ans) ans=l-f[j],tot1=f[j]-1,tot2=(flag!=1?(m-(i+f2[f[j]])+1):(i-f1[l-1]-1));\n\t}\n}\nint main(){\n\tfreopen(\"necklace.in\",\"r\",stdin);freopen(\"necklace.out\",\"w\",stdout);\n\tregister int i,j,h;scanf(\"%s%s\",a+1,b+1);n=strlen(a+1);m=strlen(b+1);k=max(n,m);\n\tfor(i=1;i<=m+1;i++)work(i,1);\n\tfor(i=1;i<=m/2;i++) swap(b[i],b[m-i+1]);memset(f1,0,sizeof(f1));memset(f2,0,sizeof(f2));\n\tfor(i=1;i<=m+1;i++)work(i,-1);\n\tprintf(\"%d\\n%d %d\",ans,tot1,tot2);\n}\n```",
        "postTime": 1619943938,
        "uid": 181766,
        "name": "275307894a",
        "ccfLevel": 0,
        "title": "luogu P6229 [BalticOI 2019 Day2]\u9879\u94fe"
    }
]
[
    {
        "content": "\u5927\u5bb6\u597d\uff0c\u6211\u51fa\u6765\u5356\u840c\u4e86\uff0c\u76f8\u4fe1\u5927\u5bb6\u8fd9\u9898\u505a\u7684\u90fd\u5f88\u5f00\u5fc3\uff08\r\n\r\n### \u9898\u89e3\r\n\r\n$k=2$\u65f6\uff0c\u76f4\u63a5\u8f93\u51fa\u4e24\u6570\uff0c\u6613\u77e5\u6b63\u786e\r\n\r\n---\r\n\r\n$k=3$\u65f6\uff0c\u8003\u8651\u5230\uff0c$(a,b)[a,b]=ab$\uff0c\u90a3\u4e48\u516d\u4e2a\u6570\u4e58\u8d77\u6765\u5c31\u662f$(abc)^2$\r\n\r\n\u56e0\u4e3a\u76f4\u63a5\u8ba1\u7b97$(abc)^2$\u4f1a\u7206`__int128`\uff0c\u6240\u4ee5\u8003\u8651\u8ba1\u7b97$\\frac{(a,b)[a,b](a,c)[a,c]}{(b,c)[b,c]}=\\frac{a^2bc}{bc}=a^2$\uff0c\u7136\u540e\u5c31\u80fd\u7b97\u51fa$a$\u3002\u4f46\u662f$a^2bc$\u4e5f\u4f1a\u7206 `__int128`\uff0c\u6240\u4ee5\u5148\u8ba9ab\u9664\u6389gcd(ab,bc)\uff0c\u518d\u8ba9ac\u9664\u6389bc/gcd(ab,bc)\uff0c\u5c31\u53ef\u4ee5\u628a\u4e24\u8fb9\u76f4\u63a5\u76f8\u4e58\u4e86\u3002\r\n\r\n\u5230\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u4e09\u4e2agcd\u548c\u4e09\u4e2alcm\u5206\u522b\u600e\u4e48\u914d\u5bf9\uff0c\u5c31\u80fd\u5206\u522b\u8ba1\u7b97\u51fa$a$,$b$,$c$\r\n\r\n---\r\n\r\n$k=4$\u65f6\uff0c\u8003\u8651\u5230\u5bf9\u5e94\u987a\u5e8f\u786e\u5b9a\u7684$k=3$\u95ee\u9898\u7684\u7b54\u6848\u662f\u786e\u5b9a\u7684\uff0c\u90a3\u4e48\u53ea\u8981\u679a\u4e3e\u67d0\u4e09\u4e2a\u548c\u53e6\u4e09\u4e2a\u600e\u4e48\u914d\u5bf9\uff0c\u518d\u68c0\u9a8c\u4e00\u4e0b\u5269\u4e0b\u4e09\u4e2a\u662f\u5426\u6b63\u786e\u5c31\u884c\u3002\r\n\r\n---\r\n\r\n### \u4ee3\u7801\r\n\r\n```cpp\r\n#include <bits/stdc++.h>\r\nusing namespace std;\r\ntypedef long long LL;\r\ntypedef __int128 LLL;\r\nLLL gcd(LLL a, LLL b) { return b ? gcd(b, a % b) : a; }\r\nLLL lcm(LLL a, LLL b) { return a / gcd(a, b) * b; }\r\nLLL div(LLL a, LLL b, LLL c) //a*b/c;\r\n{\r\n\tLLL d1 = gcd(a, c), d2 = c / d1;\r\n\treturn (a / d1) * (b / d2);\r\n}\r\nLLL sqrt(LLL a)\r\n{\r\n\tLLL mid, l = 1, r = 1e18;\r\n\tfor (; l <= r;)\r\n\t{\r\n\t\tmid = l + r >> 1;\r\n\t\tif (mid * mid == a)\r\n\t\t\treturn mid;\r\n\t\telse if (mid * mid < a)\r\n\t\t\tl = mid + 1;\r\n\t\telse\r\n\t\t\tr = mid - 1;\r\n\t}\r\n\treturn 0;\r\n}\r\nvector<LL> solve3(LLL g1, LLL g2, LLL g3, LLL l1, LLL l2, LLL l3) //solve (a,b)=g1 (a,c)=g2 (b,c)=g3\r\n{\r\n\tLLL ab = g1 * l1, ac = g2 * l2, bc = g3 * l3;\r\n\tLLL a2 = div(ab, ac, bc), b2 = div(bc, ab, ac), c2 = div(ac, bc, ab);\r\n\tLL a = sqrt(a2), b = sqrt(b2), c = sqrt(c2);\r\n\tif (a * b * c == 0)\r\n\t\treturn {};\r\n\tif (gcd(a, b) == g1 && gcd(a, c) == g2 && gcd(b, c) == g3 && lcm(a, b) == l1 && lcm(a, c) == l2 && lcm(b, c) == l3)\r\n\t\treturn {a, b, c};\r\n\telse\r\n\t\treturn {};\r\n}\r\nLL g[10], l[10];\r\nint k, s;\r\nint work()\r\n{\r\n\ts = k * (k - 1) / 2;\r\n\tfor (int i = 1; i <= s; i++)\r\n\t\tcin >> g[i];\r\n\tfor (int i = 1; i <= s; i++)\r\n\t\tcin >> l[i];\r\n\tif (k == 2)\r\n\t\tprintf(\"%lld %lld\\n\", l[1], g[1]);\r\n\telse if (k == 3)\r\n\t\tfor (int _ = 6; _--; next_permutation(g + 1, g + 1 + s))\r\n\t\t\tfor (int __ = 6; __--; next_permutation(l + 1, l + 1 + s))\r\n\t\t\t{\r\n\t\t\t\tauto k = solve3(g[1], g[2], g[3], l[1], l[2], l[3]);\r\n\t\t\t\tif (k.size() == 0)\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\telse\r\n\t\t\t\t\treturn printf(\"%lld %lld %lld\\n\", k[0], k[1], k[2]), 0;\r\n\t\t\t}\r\n\telse\r\n\t\tfor (int _ = 720; _--; next_permutation(g + 1, g + 1 + s))\r\n\t\t\tfor (int __ = 720; __--; next_permutation(l + 1, l + 1 + s))\r\n\t\t\t{\r\n\t\t\t\tauto k = solve3(g[1], g[2], g[3], l[1], l[2], l[3]), kk = solve3(g[1], g[4], g[5], l[1], l[4], l[5]);\r\n\t\t\t\tif (k.size() == 0 || kk.size() == 0)\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\tif (k[0] != kk[0] || k[1] != kk[1])\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\tvector<LL> ans = {k[0], k[1], k[2], kk[2]};\r\n\t\t\t\tif (gcd(ans[2], ans[3]) != g[6] || lcm(ans[2], ans[3]) != l[6])\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\telse\r\n\t\t\t\t\treturn printf(\"%lld %lld %lld %lld\\n\", ans[0], ans[1], ans[2], ans[3]), 0;\r\n\t\t\t}\r\n}\r\nint main()\r\n{\r\n\tint T;\r\n\tfor (scanf(\"%d%d\", &T, &k); T--;)\r\n\t\twork();\r\n\treturn 0;\r\n}\r\n```",
        "postTime": 1555768888,
        "uid": 829,
        "name": "Scarlet",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5316 \u3010\u604b\u604b\u7684\u6570\u5b66\u9898\u3011"
    },
    {
        "content": "[\u5728\u535a\u5ba2\u67e5\u770b](https://www.cnblogs.com/chenxiaoran666/p/Luogu5316.html)\n\n**\u5927\u81f4\u9898\u610f\uff1a** \u4e71\u5e8f\u7ed9\u51fa$k$\u4e2a\u6570\u4e24\u4e24$gcd$\u548c$lcm$\uff0c\u8ba9\u4f60\u6c42\u51fa\u8fd9$k$\u4e2a\u6570\u3002\n\n### \u524d\u8a00\n\n\u6bd4\u8d5b\u65f6\u770b\u5230\u8fd9\u9898\u5fc3\u60f3\u795e\u4ed9\u9898\uff0c\u7136\u540e\u53d1\u73b0$2\\le k\\le4$\u3002\u3002\u3002\n\n\u4e8e\u662f\u53c8\u60f3\u5feb\u4e00\u4e2a\u5c0f\u65f6\uff0c\u624d\u5dee\u4e0d\u591a\u60f3\u5230\u4e86\u6b63\u89e3\u3002\n\n\u7ed3\u679c\u5199\u5b8c\u4e4b\u540e\u5c11\u52a0\u4e86\u4e00\u53e5\u68c0\u9a8c\uff0c\u5c31\u88ab\u5361\u6389$2$\u5206\uff0c\u53ea\u5269$98$\u4e86$2333$\u3002\n\n### $k=2$\n\n$k=2$\u5e94\u8be5\u662f\u6bd4\u8f83\u7b80\u5355\u7684\uff0c\u8003\u8651\u5230\u4fdd\u8bc1\u6709\u89e3\uff0c\u56e0\u6b64\u76f4\u63a5\u628a\u7ed9\u51fa\u7684\u6570\u8f93\u51fa\u5373\u53ef\u3002\n\n### $k=3$\n\n$k=3$\u7684\u60c5\u51b5\u7565\u5fae\u590d\u6742\u3002\n\n\u8003\u8651\u5230\u4e71\u5e8f\u4e0d\u592a\u597d\u505a\uff0c\u4e00\u4e2a\u5f88\u76f4\u63a5\u7684\u60f3\u6cd5\uff0c\u6211\u4eec**\u5168\u6392\u5217**\u6765\u679a\u4e3e\u5bf9\u5e94\u987a\u5e8f\u3002\n\n\u5219\u6700\u540e\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$gcd(v_1,v_2),gcd(v_1,v_3),gcd(v_2,v_3)$$\n\n$$lcm(v_1,v_2),lcm(v_1,v_3),lcm(v_2,v_3)$$\n\n\u7136\u540e\u5982\u679c\u4f60\u77e5\u9053\u4e00\u4e2a\u5f88\u663e\u7136\u7684\u6027\u8d28\uff0c\u90a3\u4e48\u8fd9\u9898\u5c31\u5f88\u6c34\u4e86\uff1a\n\n$$x\\cdot y=gcd(x,y)\\cdot lcm(x,y)$$\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u4e0a\u9762\u7684\u5f0f\u5b50\u4e24\u4e24\u76f8\u4e58\u5f97\u5230$v_1\\cdot v_2,v_1\\cdot v_3,v_2\\cdot v_3$\u7684\u503c\u3002\uff08\u6ce8\u610f\u76f8\u4e58\u4f1a\u7206$long\\ long$\uff0c\u56e0\u6b64\u9700\u8981\u5f00$\\_\\_int128$\uff09\n\n\u7136\u540e\uff0c\u5982\u679c\u6211\u4eec\u6c42\u51fa$v_1\\cdot v_2,v_1\\cdot v_3$\u7684$gcd$\uff0c\u5219\u5b83\u5c31\u76f8\u5f53\u4e8e\u662f$v_1\\cdot gcd(v_2,v_3)$\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u7528$gcd(v_1\\cdot v_2,v_1\\cdot v_3)$\u53bb\u9664\u4ee5$gcd(v_2,v_3)$\uff0c\u5c31\u5f97\u5230\u4e86$v_1$\u7684\u503c\uff01\n\n\u800c$v_2$\u548c$v_3$\u65e2\u7136\u5df2\u77e5\u4e0e$v_1$\u7684\u4e58\u79ef\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u9664\u6cd5\u7b97\u51fa\u3002\n\n\u6ce8\u610f\u5728\u679a\u4e3e\u5230\u7684\u4e00\u79cd\u6392\u5217\u4e2d\uff0c\u6709\u8bb8\u591a\u65e0\u89e3\u7684\u60c5\u51b5\u9700\u8981\u7279\u5224\uff0c\u5217\u4e3e\u5982\u4e0b\uff1a\n\n- \u4e24\u4e2a\u6570\u5bf9\u5e94\u7684$lcm$\u4e0d\u80fd\u6574\u9664\u8fd9\u4e24\u4e2a\u6570\u5bf9\u5e94\u7684$gcd$\u3002\n- $gcd(v_1\\cdot v_2,v_1\\cdot v_3)$\u4e0d\u80fd\u6574\u9664$gcd(v_2,v_3)$\u3002\n- \u6700\u540e\u7b97\u51fa\u7684$v_2\\cdot v_3$\u4e0d\u7b49\u4e8e$gcd(v_2,v_3)*lcm(v_2,v_3)$\u3002\n- \u6700\u540e\u7b97\u51fa\u7684$gcd(v_1,v_2),gcd(v_1,v_3),gcd(v_2,v_3)$\u4e0e\u5df2\u77e5\u6570\u636e\u4e0d\u7b26\uff08\u6211\u5c31\u662f\u5c11\u5224\u4e86\u8fd9\u4e2a\u4e22\u4e86$2$\u5206\uff09\u3002\n\n### $k=4$\n\n\u77e5\u9053\u4e86$k=3$\uff0c$k=4$\u5176\u5b9e\u53ea\u8981\u5728\u6b64\u57fa\u7840\u4e0a\u52a0\u4e00\u4e9b\u7ec6\u8282\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u8fd9\u6b21\u6211\u4eec\u9700\u8981\u5168\u6392\u5217\u5957\u5168\u6392\u5217\uff0c\u624d\u80fd\u4f7f\u5f97\u6700\u540e\u7684\u5bf9\u5e94\u987a\u5e8f\u6070\u597d\u4e3a\uff1a\n\n$$gcd(v_1,v_2),gcd(v_1,v_3),gcd(v_1,v_4),gcd(v_2,v_3),gcd(v_2,v_4),gcd(v_3,v_4)$$\n\n$$lcm(v_1,v_2),lcm(v_1,v_3),lcm(v_1,v_4),lcm(v_2,v_3),lcm(v_2,v_4),lcm(v_3,v_4)$$\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u53ef\u4ee5\u50cf\u524d\u9762\u4e00\u6837\u5148\u6c42\u51fa$v_1,v_2,v_3$\u7684\u503c\uff0c\u7136\u540e\u8ba1\u7b97\u51fa$v_4$\u7684\u503c\u5e76\u68c0\u9a8c\u5373\u53ef\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u8be6\u89c1\u4ee3\u7801\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define Tp template<typename Ty>\n#define Ts template<typename Ty,typename... Ar>\n#define Reg register\n#define RI Reg int\n#define Con const\n#define CI Con int&\n#define I inline\n#define W while\n#define LL long long\nusing namespace std;\nint n,m;__int128 a[10],b[10];\nTp I void read(Ty& x)//\u8bfb\u5165__int128\n{\n\tchar c;x=0;W(!isdigit(c=getchar()));\n\tW(x=(x<<3)+(x<<1)+(c&15),isdigit(c=getchar()));\n}\nTp I Ty gcd(Con Ty& x,Con Ty& y) {return y?gcd(y,x%y):x;}//\u6c42gcd\nclass Dfser_for_Three\n{\n\tprivate:\n\t\tbool vis[10];__int128 s[10];\n\t\tI bool Calc()//\u6c42\u7b54\u6848\n\t\t{\n\t\t\t__int128 v1,v2,v3;if(gcd(a[1]*s[1],a[2]*s[2])%a[3]) return 0;//\u5224\u65e0\u89e3\n\t\t\tv1=gcd(a[1]*s[1],a[2]*s[2])/a[3],v2=a[1]*s[1]/v1,v3=a[2]*s[2]/v1;//\u6c42\u51fav1,v2,v3\n\t\t\tif(v2*v3!=a[3]*s[3]||gcd(v1,v2)^a[1]||gcd(v1,v3)^a[2]||gcd(v2,v3)^a[3]) return 0;//\u5224\u65e0\u89e3\n\t\t\treturn printf(\"%lld %lld %lld\\n\",(LL)v1,(LL)v2,(LL)v3),1;//\u8f93\u51fa\u7b54\u6848\n\t\t}\n\tpublic:\n\t\tI bool dfs(CI x)//\u5168\u6392\u5217\n\t\t{\n\t\t\tif(x>3) return Calc();\n\t\t\tfor(RI i=1;i<=3;++i) if(!vis[i]&&!(b[i]%a[x]))//\u526a\u679d\n\t\t\t{\n\t\t\t\tif(vis[i]=1,s[x]=b[i],dfs(x+1)) return vis[i]=0,1;\n\t\t\t\tvis[i]=0;\n\t\t\t}return 0;\n\t\t}\n}D3;\nclass Dfser_for_Four\n{\n\tprivate:\n\t\tbool vis1[10],vis2[10];__int128 s1[10],s2[10];\n\t\tI bool Calc()//\u6c42\u7b54\u6848\uff0c\u4e0e\u4e0a\u9762\u7c7b\u4f3c\n\t\t{\n\t\t\t__int128 v1,v2,v3,v4;if(gcd(s1[1]*s2[1],s1[2]*s2[2])%s1[4]) return 0;\n\t\t\tv1=gcd(s1[1]*s2[1],s1[2]*s2[2])/s1[4],v2=s1[1]*s2[1]/v1,v3=s1[2]*s2[2]/v1;//\u6c42\u51fav1,v2,v3\n\t\t\tif(s1[3]*s2[3]%v1) return 0;v4=s1[3]*s2[3]/v1;//\u6c42\u51fav4\n\t\t\tif(v2*v3!=s1[4]*s2[4]||v2*v4!=s1[5]*s2[5]||v3*v4!=s1[6]*s2[6]) return 0;//\u5224\u65e0\u89e3\n\t\t\tif(gcd(v1,v2)^s1[1]||gcd(v1,v3)^s1[2]||gcd(v1,v4)^s1[3]) return 0;//\u5224\u65e0\u89e3\n\t\t\tif(gcd(v2,v3)^s1[4]||gcd(v2,v4)^s1[5]||gcd(v3,v4)^s1[6]) return 0;//\u5224\u65e0\u89e3\n\t\t\treturn printf(\"%lld %lld %lld %lld\\n\",(LL)v1,(LL)v2,(LL)v3,(LL)v4),1;//\u8f93\u51fa\u7b54\u6848\n\t\t}\n\t\tI bool dfs2(CI x)//\u7b2c\u4e8c\u5c42\u5168\u6392\u5217\n\t\t{\n\t\t\tif(x>6) return Calc();\n\t\t\tfor(RI i=1;i<=6;++i) if(!vis2[i]&&!(b[i]%s1[x]))\n\t\t\t{\n\t\t\t\tif(vis2[i]=1,s2[x]=b[i],dfs2(x+1)) return vis2[i]=0,1;\n\t\t\t\tvis2[i]=0;\n\t\t\t}return 0;\n\t\t}\n\tpublic:\n\t\tI bool dfs1(CI x)//\u7b2c\u4e00\u5c42\u5168\u6392\u5217\n\t\t{\n\t\t\tif(x>6) return dfs2(1);\n\t\t\tfor(RI i=1;i<=6;++i) if(!vis1[i])\n\t\t\t{\n\t\t\t\tif(vis1[i]=1,s1[x]=a[i],dfs1(x+1)) return vis1[i]=0,1;\n\t\t\t\tvis1[i]=0;\n\t\t\t}return 0;\n\t\t}\n}D4;\nint main()\n{\n\tRI Ttot,i;cin>>Ttot>>n,m=n*(n-1)>>1;W(Ttot--)\n\t{\n\t\tfor(i=1;i<=m;++i) read(a[i]);for(i=1;i<=m;++i) read(b[i]);\n\t\tif(n==2) {printf(\"%lld %lld\\n\",(LL)a[1],(LL)b[1]);continue;}//\u5bf9\u4e8e\u4e24\u4e2a\u6570\u76f4\u63a5\u8f93\u51fa\n\t\tif(n==3) {D3.dfs(1);continue;}D4.dfs1(1);\n\t}return 0;\n}\n```\n\n",
        "postTime": 1555833202,
        "uid": 28382,
        "name": "TheLostWeak",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5316 \u3010\u604b\u604b\u7684\u6570\u5b66\u9898\u3011"
    },
    {
        "content": "\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u66b4\u529b$O(4!*4!)$\u679a\u4e3e\u8fd9\u4e9b$gcd$\u548c$lcm$\u5404\u81ea\u662f\u54ea\u4e24\u5bf9\u7684$gcd$\u548c$lcm$\uff0c\u4e5f\u5c31\u76f8\u5f53\u4e8e\u77e5\u9053\u4e86\u4e24\u4e24\u4e4b\u95f4\u7684\u4e58\u79ef\u662f\u5565\uff0c\u6211\u4eec\u4ee5$k=3$\u4e3a\u4f8b\uff0c$ab=A,bc=B,cd=C$\uff0c\u90a3\u4e48\u663e\u7136\u6709$gcd(A,B)=bgcd(a,c)$\uff0c\u800c\u540e\u8005\u5df2\u77e5\uff0c\u90a3\u4e48\u5c31\u80fd\u6c42\u51fa$b$\uff0c\u540c\u7406\u8fd9$k$\u4e2a\u4e1c\u897f\u90fd\u80fd\u8fd9\u6837\u89e3\u51fa\u6765\uff0c\u5224\u4e00\u4e0b\u5408\u6cd5\u5373\u53ef\u3002\n\n\u53e6\u5916$k=2$\u7684\u65f6\u5019\u76f4\u63a5\u628a\u8f93\u5165\u76842\u4e2a\u6570\u8f93\u51fa\u5373\u53ef\u2026\u2026\u56e0\u4e3a\u663e\u7136\u6709$lcm(lcm,gcd)=lcm,gcd(gcd,lcm)=gcd$\u2026\u2026\u6211\u6253\u4e86\u4e2apollard_rho\u4e4b\u540e\u624d\u610f\u8bc6\u5230\u8fd9\u4e2a\u2026\u2026\n\n\u5565\uff1f$gcd,lcm<=10^{18}$\u4e58\u4e00\u5757\u7206\u4e86\uff1f__int128\u4e86\u89e3\u4e00\u4e0b\u2026\u2026~~\u6bd5\u7adfpython\u90fd\u80fd\u7528\u2026\u2026~~\n\n\u4e0a\u4ee3\u7801~\n\n```cpp\n#pragma GCC optimize(2)\n#pragma GCC optimize(3)\n#pragma GCC optimize(\"Ofast\")\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#define ll __int128\n#define abs(_o) ((_o < 0) ? -(_o) : _o)\nusing namespace std;\nnamespace ywy {\n\tint id[5][5];\n\tint a[10], b[10];\n\tinline ll get() {\n\t    ll n = 0;\n\t    char c;\n\t    while ((c = getchar()) || 23333) {\n\t        if (c >= '0' && c <= '9')\n\t            break;\n\t        if (c == '-')\n\t            goto s;\n\t    }\n\t    n = c - '0';\n\t    while ((c = getchar()) || 23333) {\n\t        if (c >= '0' && c <= '9')\n\t            n = n * 10 + c - '0';\n\t        else\n\t            return (n);\n\t    }\n\ts:\n\t    while ((c = getchar()) || 23333) {\n\t        if (c >= '0' && c <= '9')\n\t            n = n * 10 - c + '0';\n\t        else\n\t            return (n);\n\t    }\n\t}\n\tll dgcd[10], dlcm[10];\n\tinline ll gcd(ll a, ll b) {\n\t    while (b) {\n\t        ll r = a % b;\n\t        a = b;\n\t        b = r;\n\t    }\n\t    return (a);\n\t}\n\tvoid print(ll num) {\n\t    if (num >= 10)\n\t        print(num / 10);\n\t    putchar(num % 10 + '0');\n\t}\n\tint dx[10], dy[10];\n\tll real[5];\n\tvoid ywymain() {\n\t    int t, n;\n\t    cin >> t >> n;\n\t    while (t) {\n\t        t--;\n\t        if (n == 2) {\n\t            ll a = get(), b = get();\n\t            print(a);\n\t            putchar(' ');\n\t            print(b);\n\t            putchar('\\n');\n\t            continue;\n\t        }\n\t        int d = (n * (n - 1)) / 2;\n\t        for (register int i = 1; i <= d; i++) {\n\t            a[i] = b[i] = i;\n\t            dgcd[i] = get();\n\t        }\n\t        for (register int i = 1; i <= d; i++) dlcm[i] = get();\n\t        int gn = 1;\n\t        for (register int i = 1; i <= n; i++) {\n\t            for (register int j = 1; j < i; j++) id[i][j] = id[j][i] = gn, dx[gn] = i, dy[gn] = j, gn++;\n\t        }\n\t        do {\n\t            for (register int i = 1; i <= d; i++) b[i] = i;\n\t            do {\n\t                memset(real, 0, sizeof(real));\n\t                for (register int i = 1; i <= d; i++) {\n\t                    for (register int j = 1; j <= d; j++) {\n\t                        if (dx[i] == dx[j] && dy[i] == dy[j])\n\t                            continue;\n\t                        if (dx[i] == dx[j]) {\n\t                            ll cjr = gcd(dgcd[a[i]] * dlcm[b[i]], dgcd[a[j]] * dlcm[b[j]]) /\n\t                                     dgcd[a[id[dy[i]][dy[j]]]];\n\t                            if (!real[dx[i]]) {\n\t                                real[dx[i]] = cjr;\n\t                            } else {\n\t                                if (real[dx[i]] != cjr)\n\t                                    goto t;\n\t                            }\n\t                        }\n\t                        if (dy[i] == dy[j]) {\n\t                            ll cjr = gcd(dgcd[a[i]] * dlcm[b[i]], dgcd[a[j]] * dlcm[b[j]]) /\n\t                                     dgcd[a[id[dx[i]][dx[j]]]];\n\t                            if (!real[dy[i]]) {\n\t                                real[dy[i]] = cjr;\n\t                            } else {\n\t                                if (real[dy[i]] != cjr)\n\t                                    goto t;\n\t                            }\n\t                        }\n\t                        if (dy[i] == dx[j]) {\n\t                            ll cjr = gcd(dgcd[a[i]] * dlcm[b[i]], dgcd[a[j]] * dlcm[b[j]]) /\n\t                                     dgcd[a[id[dx[i]][dy[j]]]];\n\t                            if (!real[dy[i]]) {\n\t                                real[dy[i]] = cjr;\n\t                            } else {\n\t                                if (real[dy[i]] != cjr)\n\t                                    goto t;\n\t                            }\n\t                        }\n\t                        if (dx[i] == dy[j]) {\n\t                            ll cjr = gcd(dgcd[a[i]] * dlcm[b[i]], dgcd[a[j]] * dlcm[b[j]]) /\n\t                                     dgcd[a[id[dy[i]][dx[j]]]];\n\t                            if (!real[dx[i]]) {\n\t                                real[dx[i]] = cjr;\n\t                            } else {\n\t                                if (real[dx[i]] != cjr)\n\t                                    goto t;\n\t                            }\n\t                        }\n\t                    }\n\t                }\n\t                for (register int i = 1; i <= n; i++) {\n\t                    if (!real[i])\n\t                        goto t;\n\t                    for (register int j = 1; j < i; j++) {\n\t                        if (gcd(real[i], real[j]) != dgcd[a[id[i][j]]])\n\t                            goto t;\n\t                        if ((real[i] * real[j]) / gcd(real[i], real[j]) != dlcm[b[id[i][j]]])\n\t                            goto t;\n\t                    }\n\t                }\n\t                for (register int i = 1; i <= n; i++) print(real[i]), putchar(' ');\n\t                cout << endl;\n\t                goto s;\n\t            t:;\n\t            } while (next_permutation(b + 1, b + 1 + d));\n\t        } while (next_permutation(a + 1, a + 1 + d));\n\t    s:;\n\t    }\n\t}\n}\nint main() {\n    ywy::ywymain();\n    return (0);\n}\n```",
        "postTime": 1555767940,
        "uid": 125124,
        "name": "ywy_c_asm",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5316 \u3010\u604b\u604b\u7684\u6570\u5b66\u9898\u3011"
    },
    {
        "content": "\u4f5c\u4e3a\u4e00\u4e2a\u66b4\u529b\u9009\u624b\uff0c\u5e76\u4e0d\u60f3\u8ba8\u8bba\u90a3\u4e48\u591a\u4e1c\u897f\uff0c\u53ea\u9700\u8ffd\u6c42\u66b4\u529b\u7f8e\u5b66\u3002\n\nPollard_Rho+\u7206\u641c\u5373\u53ef\u3002\u5f53\u7136Pollard_Rho\u53ea\u662f\u4e2a\u677f\u5b50\uff0c\u7cbe\u9ad3\u5728\u4e8e\u7206\u641c\uff08\u96fe\uff09\n\n\u9996\u5148\u5047\u8bbe\u7ed9\u4f60\u7684\\\\(\\gcd\\\\)\u548c\\\\(\\rm{lcm}\\\\)\u662f\u6309\u987a\u5e8f\u6392\u5217\u7684\u3002\n\n\u6211\u4eec\u5bf9\u6bcf\u4e2a\u6570\u5206\u89e3\u8d28\u56e0\u6570\uff0c\u7136\u540e\u5bf9\u6bcf\u79cd\u8d28\u56e0\u6570\u5206\u522b\u8003\u8651\u3002\n\n\u5047\u8bbe\u4e24\u4e2a\u6570\u7684\\\\(\\gcd\\\\)\u4e2d\u542b\u6709\\\\(p^a\\\\)\uff0c\\\\(\\rm{lcm}\\\\)\u4e2d\u542b\u6709\\\\(p^b\\\\)\uff0c\\\\(0\\leqslant a\\leqslant b\\\\)\u5219\u5fc5\u5b9a\u4e00\u4e2a\u6570\u542b\u6709\\\\(p^a\\\\)\uff0c\u4e00\u4e2a\u6570\u542b\u6709\\\\(p^b\\\\)\u3002\n\n\u90a3\u4e48\u6211\u4eec\u66b4\u529bdfs\uff0c\u5bf9\u6bcf\u4e2a\u6570\u7ed9\u5b83\u5339\u914d\u4e00\u4e0b\u5c31\u597d\u4e86\u3002\n\n\u4e71\u5e8f\u600e\u4e48\u529e\uff1f\n\n\u53cd\u6b63\u4e5f\u5c31\\\\(6!\\times 6!\\\\)\u79cd\u4e0d\u540c\u7684\u5bf9\u5e94\u65b9\u5f0f\uff0c\u5927\u4e0d\u4e86\u679a\u4e3e\u5168\u6392\u5217\u5457\u2026\u2026\n\n\u679a\u4e3e\u5176\u5bf9\u5e94\u65b9\u5f0f\uff0c\u5bf9\u6bcf\u79cd\u5bf9\u5e94\u65b9\u5f0f\u7684\u6bcf\u4e2a\u4e0d\u540c\u8d28\u56e0\u6570\u7206\u641c\u5339\u914d\u3002\u5982\u679c\u6240\u6709\u8d28\u56e0\u6570\u90fd\u6210\u529f\u5339\u914d\u4e86\uff0c\u5c31\u8bf4\u660e\u627e\u5230\u4e86\u4e00\u7ec4\u5408\u6cd5\u89e3\u3002\n\n\u8fd9\u6837\u76f4\u63a5\u7528```__int128```\u5373\u53ef\uff0c\u4e5f\u4e0d\u7528\u62c5\u5fc3\u4ec0\u4e48\u4e2d\u95f4\u8fc7\u7a0b\u4f1a\u7206\u4e86\u3002\n\n\u5b9e\u9645\u4e0a\u901f\u5ea6\u4e5f\u5c31\u6bd4\u6b63\u89e3\u505a\u6cd5\u5dee\u4e86100ms\u5de6\u53f3\u3002\n\n~~\u6bd4\u8d5b\u7684\u65f6\u5019\u53ea\u679a\u4e3e\u4e86\u4e00\u5c42\u5168\u6392\u5217\u8fd8\u6709\u4e9b\u7ec6\u8282\u5199\u6302\u5bfc\u81f4\u6302\u621084~~\n\n## Code\uff1a\n```cpp\n#include<cstdio>\n#include<map>\n#include<vector>\n#include<cstdlib>\n#include<algorithm>\n#include<ctime>\n#include<set>\ntypedef long long LL;\n#ifndef ONLINE_JUDGE\n#define __int128 LL\n#endif\nusing std::__gcd;\nint T,n;\nLL GCD[5][5],LCM[5][5],__[20],__2[20];\nstd::set<LL>ret;\nstd::map<LL,int>mn[5][5],mx[5][5],___[233],___2[233];\nstd::set<LL>s;__int128 r[5];\nint cnt[5];\nint ok=0;\nLL P;\ninline void chkmax(int&a,int b){a=(a>b)?a:b;}\ninline void chkmin(int&a,int b){a=(a<b)?a:b;}\nvoid Write(__int128 x){\n\tif (x<0) x=-x,putchar('-');\n\tif (x>9) Write(x/10);\n\tputchar(x%10+'0');\n}\ninline LL pow(LL a,int b){\n\tLL ret=1;\n\twhile(b--)ret*=a;\n\treturn ret;\n}\nnamespace rho{\n\tinline LL mul(LL a,LL b,const LL&md){\n\t\tconst LL c=a*b-(LL)((long double)a*b/md+.5)*md;\n\t\treturn(c>>63&md)+c;\n\t}\n\tinline LL pow(LL a,LL b,const LL&md){\n\t\tLL ret=1;\n\t\tfor(;b;b>>=1,a=mul(a,a,md))if(b&1)ret=mul(ret,a,md);\n\t\treturn ret;\n\t}\n\tnamespace MR{\n\t\tconst int P[]={2,3,5,7,11,13,17,19,23,29,31,37};\n\t\tbool test(int a,LL n){\n\t\t\tLL x=n-1;int d=0;\n\t\t\twhile(!(x&1))++d,x>>=1;\n\t\t\tx=pow(a,x,n);\n\t\t\twhile(d--){\n\t\t\t\tconst LL lst=x;\n\t\t\t\tx=mul(x,x,n);\n\t\t\t\tif(x==1&&lst!=1&&lst!=n-1)return 0;\n\t\t\t}\n\t\t\treturn x==1;\n\t\t}\n\t\tbool check(LL n){\n\t\t\tfor(int i:P)if(n==i)return 1;\n\t\t\tif(!(n&1))return 0;\n\t\t\tfor(int i:P)if(!test(i,n))return 0;\n\t\t\treturn 1;\n\t\t}\n\t}\n\tLL find(LL n,int c){\n\t\tLL x=rand()%(n-1)+1,y=x,k=2,q=1,t=1;\n\t\tfor(;;k<<=1,y=x,q=1){\n\t\t\tfor(int i=1;i<=k;++i){\n\t\t\t\tx=mul(x,x,n)+c-n;x+=x>>63&n;\n\t\t\t\tq=mul(q,llabs(x-y),n);\n\t\t\t\tif(!(i&127)){\n\t\t\t\t\tt=std::__gcd(q,n);\n\t\t\t\t\tif(t>1)return t;\n\t\t\t\t}\n\t\t\t}\n\t\t\tt=std::__gcd(q,n);\n\t\t\tif(t>1)return t;\n\t\t}\n\t}\n\tvoid rho(LL n){\n\t\tif(n==1)return;\n\t\tif(MR::check(n))return (void)ret.insert(n);\n\t\tLL p=n;int c=19260817;\n\t\twhile(p==n)p=find(p,c--);\n\t\twhile(n%p==0)n/=p;\n\t\trho(p),rho(n);\n\t}\n}\nvoid dfs(int i,int j){\n\tif(ok)return;\n\tif(i==n){\n\t\tok=1;\n\t\tfor(int i=1;i<=n;++i)\n\t\tr[i]*=pow(P,cnt[i]);\n\t}else{\n\t\tif(j>n)return dfs(i+1,i+2);\n\t\tint mnx=mn[i][j][P],mxx=mx[i][j][P];\n\t\tif(mxx==0)mxx=mnx;\n\t\tif(cnt[i]==-1){\n\t\t\tif(cnt[j]==-1){\n\t\t\t\tcnt[i]=mnx,cnt[j]=mxx;\n\t\t\t\tdfs(i,j+1);\n\t\t\t\tif(mnx!=mxx)\n\t\t\t\tcnt[j]=mnx,cnt[i]=mxx,\n\t\t\t\tdfs(i,j+1);\n\t\t\t\tcnt[i]=cnt[j]=-1;\n\t\t\t}else{\n\t\t\t\tif(cnt[j]==mxx)cnt[i]=mnx,dfs(i,j+1);else\n\t\t\t\tif(cnt[j]==mnx)cnt[i]=mxx,dfs(i,j+1);\n\t\t\t\tcnt[i]=-1;\n\t\t\t}\n\t\t}else{\n\t\t\tif(cnt[j]==-1){\n\t\t\t\tif(cnt[i]==mxx)cnt[j]=mnx,dfs(i,j+1);else\n\t\t\t\tif(cnt[i]==mnx)cnt[j]=mxx,dfs(i,j+1);\n\t\t\t\tcnt[j]=-1;\n\t\t\t}else{\n\t\t\t\tif(cnt[i]==mnx&&cnt[j]==mxx||cnt[i]==mxx&&cnt[j]==mnx)dfs(i,j+1);\n\t\t\t}\n\t\t}\n\t}\n}\nint main(){\n\tsrand(time(0));\n\tscanf(\"%d%d\",&T,&n);\n\twhile(T--){\n\t\ts.clear();\n\t\tfor(int i=1;i<n;++i)\n\t\tfor(int j=i+1;j<=n;++j)mx[i][j].clear(),mn[i][j].clear();\n\t\tfor(int i=1;i<n;++i)\n\t\tfor(int j=i+1;j<=n;++j)\n\t\tscanf(\"%lld\",&GCD[i][j]);\n\t\tfor(int i=1;i<n;++i)\n\t\tfor(int j=i+1;j<=n;++j)\n\t\tscanf(\"%lld\",&LCM[i][j]);\n\t\tfor(int i=1;i<=n*(n-1)/2;++i)__[i]=__2[i]=i;\n\t\tint t=0;\n\t\tfor(int i=1;i<n;++i)\n\t\tfor(int j=i+1;j<=n;++j){\n\t\t\t++t;\n\t\t\t___2[t].clear();\n\t\t\tret.clear();\n\t\t\tLL a=GCD[i][j];\n\t\t\trho::rho(a);\n\t\t\tfor(LL x:ret){\n\t\t\t\tint cnt=0;\n\t\t\t\twhile(a%x==0)a/=x,++cnt;\n\t\t\t\tchkmax(___2[t][x],cnt);\n\t\t\t\ts.insert(x);\n\t\t\t}\n\t\t}\n\t\tt=0;\n\t\tfor(int i=1;i<n;++i)\n\t\tfor(int j=i+1;j<=n;++j){\n\t\t\t++t;\n\t\t\t___[t].clear();\n\t\t\tret.clear();\n\t\t\tLL a=LCM[i][j];\n\t\t\trho::rho(a);\n\t\t\tfor(LL x:ret){\n\t\t\t\tint cnt=0;\n\t\t\t\twhile(a%x==0)a/=x,++cnt;\n\t\t\t\tif(___[t].count(x))chkmin(___[t][x],cnt);else ___[t][x]=cnt;\n\t\t\t\ts.insert(x);\n\t\t\t}\n\t\t}\n\t\tdo{\n\t\t\tdo{\n\t\t\t\tint t=0;\n\t\t\t\tfor(int i=1;i<n;++i)\n\t\t\t\tfor(int j=i+1;j<=n;++j){\n\t\t\t\t\t++t;\n\t\t\t\t\tmx[i][j]=___[__[t]];\n\t\t\t\t\tmn[i][j]=___2[__2[t]];\n\t\t\t\t}\n\t\t\t\tfor(int i=1;i<=n;++i)r[i]=1;\n\t\t\t\tbool yes=1;\n\t\t\t\tfor(LL P:s){\n\t\t\t\t\t::P=P;\n\t\t\t\t\tok=0;\n\t\t\t\t\tfor(int i=1;i<=n;++i)cnt[i]=-1;\n\t\t\t\t\tdfs(1,2);\n\t\t\t\t\tif(!ok){\n\t\t\t\t\t\tyes=0;break;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(yes)goto succ;\n\t\t\t}while(std::next_permutation(__2+1,__2+t+1));\n\t\t}while(std::next_permutation(__+1,__+t+1));\n\t\tsucc:\n\t\tfor(int i=1;i<n;++i)\n\t\tWrite(r[i]),putchar(' ');\n\t\tWrite(r[n]),putchar('\\n');\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1556523880,
        "uid": 6813,
        "name": "mrsrz",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5316 \u3010\u604b\u604b\u7684\u6570\u5b66\u9898\u3011"
    },
    {
        "content": "### Update On 2020/8/25 \u7ea0\u6b63\u4e86\u4e00\u4e2a\u5c0f\u9519\u8bef\u3002\n\n[\u539f\u9898\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5316)\n\n[~~\u672c\u4eba\u7684\u60b2\u60e8\u7ecf\u5386~~](https://www.luogu.com.cn/record/list?user=334727&pid=P5316&page=1)\n\n\u76f8\u4fe1\u5927\u5bb6\u90fd\u770b\u597d\u9898\u9762\u4e86\uff0c\u6211\u4eec\u8fdb\u5165\u6b63\u9898\u3002\n\n\u9996\u5148\u6211\u4eec\u8981\u77e5\u9053\u600e\u4e48\u7528\u4e24\u4e24\u4e4b\u95f4\u7684 $\\gcd$ \u548c $\\operatorname{lcm}$ \u6765\u6c42\u51fa\u8fd9\u4e9b\u6570\u3002\n\n+ \u7b2c\u4e00\u6b65\uff1a\u89e3\u51b3 $k=2$ \u7684\u60c5\u51b5\n\n$ \\ \\ \\ \\ \\ $ \u76f4\u63a5\u8f93\u51fa\u4e24\u4e2a\u6570\u3002\u3002\u3002\u8fd9\u4e9b\u5206\u767d\u9001\u7684\n\n+ \u7b2c\u4e8c\u6b65\uff1a\u63a8\u5bfc\u516c\u5f0f\uff0c\u5f97\u51fa $a \\times b=\\gcd(x,y) \\times \\operatorname{lcm}(x,y)$\n\n$ \\ \\ \\ \\ \\ $\u8bbe $x=\\gcd(a,b)\\;\\;$,$\\;\\;y=\\operatorname{lcm}(a,b)$ \u3002\n\n$ \\ \\ \\ \\ \\ $\u5219 $a=m \\times x\\;\\;$,$\\;\\;b=n\\times x\\;\\;$,$\\;\\;m$ \u4e0e $n$ \u4e92\u8d28\u3002\n\n$ \\ \\ \\ \\ \\ $\u6545 $y=m\\times n \\times x$ \u3002\n\n$ \\ \\ \\ \\ \\ $\u56e0\u6b64 $x\\times y=x\\times (m\\times n\\times x)=(m\\times x)\\times (n\\times x)=a\\times b$ \u5373 $a\\times b=\\gcd(a,b)\\times \\operatorname{lcm}(a,b)$ \u3002\n\n\n+ \u7b2c\u4e09\u6b65\uff1a\u89e3\u51b3 $k=3$ \u7684\u60c5\u51b5\n\n$ \\ \\ \\ \\ $ \u9996\u5148\u6211\u4eec\u8981\u77e5\u9053\u5982\u4f55\u901a\u8fc7\u4e24\u4e24\u4e4b\u95f4\u7684 $\\gcd$ \u548c $\\operatorname{lcm}$ \u6765\u6c42\u51fa\u8fd9\u4e9b\u6570\u3002\n\n$ \\ \\ \\ \\ $ \u7b2c\u4e8c\u6b65\u7684\u516c\u5f0f\u6d3e\u4e0a\u7528\u573a\u4e86\u3002\n\n$ \\ \\ \\ \\ $ \u8bbe $F$ \u4e3a\u6240\u6709\u7684\u6700\u5927\u516c\u7ea6\u6570\uff0c$H$ \u4e3a\u6700\u5c0f\u516c\u500d\u6570\uff0c$A,B,C$\u4ee3\u8868\u7b54\u6848\u4e2d\u7684\u4e09\u4e2a\u6570\u3002\n\n$ \\ \\ \\ \\ $ \u5047\u8bbe $F_1=\\gcd(a,b),F_2=\\gcd(b,c),F_3=\\gcd(a,c)$\n\n$ \\ \\ \\ \\ $ $H_1=\\operatorname{lcm}(a,b),H_2=\\operatorname{lcm}(b,c),F_3=\\operatorname{lcm}(a,c)$\n\n$ \\ \\ \\ \\ $ \u90a3\u4e48\u6839\u636e\u521a\u624d\u7684\u516c\u5f0f\uff0c\u5f97 $\\dfrac{F_1 \\times H_1 \\times F_2 \\times H_2}{F_3 \\times H_3}=\\dfrac{A^2BC}{BC}=A^2$\n\n$ \\ \\ \\ \\ $ \u4f46\u662f\u8fd9\u6837\u8fde ``__int128`` \u90fd\u4f1a\u7206\u70b8\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u628a\u5206\u53f7\u7684\u4e0a\u4e0b\u8fb9\u90fd\u9664\u6389 $\\gcd(AB,BC)$ \u5373\u53ef\u3002\n\n\n$ \\ \\ \\ \\ $ \u6700\u540e\u6211\u4eec\u6309\u7167\u7c7b\u4f3c\u7684\u65b9\u6cd5\u6c42\u51fa $B,C$\u3002\n\n$ \\ \\ \\ \\ $ \u679a\u4e3e $F$ \u548c $H$ \u7684\u5168\u6392\u5217\u5373\u53ef\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u5230 ``STL`` \u91cc\u9762\u7684 ``next_permutation`` \u51fd\u6570\u3002\n\n+ \u7b2c\u56db\u6b65\uff1a\u89e3\u51b3 $k=4$\n\n$ \\ \\ \\ \\ $ \u8fd9\u4e2a\u548c $k=3$ \u7684\u65b9\u6cd5\u662f\u5dee\u4e0d\u591a\u7684\uff0c\u53ef\u4ee5\u6309\u7167\u4e0a\u9762\u7684\u516c\u5f0f\u4f9d\u6b21\u6c42\u51fa $A,B,C,D$\uff0c\u5efa\u8bae\u81ea\u5df1\u63a8\u5bfc\uff0c\u6211\u5c31\u4e0d\u8be6\u7ec6\u8bb2\u89e3\u4e86\u3002\n\n\u662f\u4e0d\u662f\u5f88\u7b80\u5355\u5462\uff1f\n\n\u4e0a\u4ee3\u7801\u3002\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#define ll __int128\nll g[10],l[10];\nint t,k,n;\ninline ll gcd(ll A,ll B)\n{\n    if(A==0)\n    {\n        A=B;B=0;\n    }\n    return B?gcd(B%A,A):A;\n}//\u6700\u5927\u516c\u7ea6\u6570\ninline ll lcm(ll A,ll B)\n{\n    if(gcd(A,B)==0) return 0;\n    return A*B/gcd(A,B);\n}//\u6700\u5c0f\u516c\u500d\u6570\ninline ll Sqrt(ll x)\n{\n    ll L=1,R=1e18;\n    while(L<=R)\n    {\n        ll MID=(L+R)/2;\n        if(MID*MID==x) return MID;\n        else if(MID*MID<x) L=MID+1;\n        else R=MID-1;\n    }\n    return -1;\n}//\u4e8c\u5206\u5f00\u6839\u53f7\ninline ll read()\n{\n    ll f=0;char ch=getchar();\n    while(ch<'0'||ch>'9') ch=getchar();\n    while(ch>='0'&&ch<='9') {f=f*10+ch-'0';ch=getchar();}\n    return f;\n}//\u8bfb\u5165\ninline void write(ll x)\n{\n    int num[50],cnt=0;\n    ll X=x;\n    do{\n        cnt++;\n        num[cnt]=int(X%10);\n        X/=10;\n    }while(X);\n    for(int i=cnt;i>=1;i--) printf(\"%d\",num[i]);\n}//\u8f93\u51fa\ninline void work2()\n{\n    write(g[1]);printf(\" \");\n    write(l[1]);puts(\"\");\n}//k=2 \u7684\u60c5\u51b5\ninline void work3()\n{\n    sort(g+1,g+4);\n    sort(l+1,l+4);\n    for(int i=1;i<=6;i++)\n    {\n        next_permutation(g+1,g+4);\n        for(int j=1;j<=6;j++)\n        {\n            next_permutation(l+1,l+4);\n            ll ab=g[1]*l[1],bc=g[2]*l[2],ac=g[3]*l[3];\n            ll tg=gcd(ab,bc);\n            ll AB=ab/tg,BC=bc/tg;\n            ll AA=AB*ac/BC;\n            ll A=Sqrt(AA);\n            if(A==-1) continue;\n            ll B=ab/A;\n            ll C=ac/A;\n            if(gcd(A,B)==g[1]&&lcm(A,B)==l[1])\n            if(gcd(B,C)==g[2]&&lcm(B,C)==l[2])\n            if(gcd(A,C)==g[3]&&lcm(A,C)==l[3])\n            {\n                write(A);printf(\" \");\n                write(B);printf(\" \");\n                write(C);puts(\"\");\n                return;\n            }\n        }\n    }\n}//k=3 \u7684\u60c5\u51b5\ninline void work4()\n{\n    sort(g+1,g+7);\n    sort(l+1,l+7);\n    for(int i=1;i<=720;i++)\n    {\n        next_permutation(g+1,g+7);\n        for(int j=1;j<=720;j++)\n        {\n            next_permutation(l+1,l+7);\n            ll ab=g[1]*l[1],ac=g[2]*l[2],ad=g[3]*l[3],bc=g[4]*l[4],bd=g[5]*l[5],cd=g[6]*l[6];\n            ll tg=gcd(ab,bc);\n            ll AB=ab/tg;ll BC=bc/tg;\n            ll AA=AB*ac/BC;\n            ll A=Sqrt(AA);\n            if(A==-1) continue;\n            ll B=ab/A;\n            ll C=ac/A;\n            ll D=ad/A;\n            if(gcd(A,B)==g[1]&&lcm(A,B)==l[1])\n            if(gcd(A,C)==g[2]&&lcm(A,C)==l[2])\n            if(gcd(A,D)==g[3]&&lcm(A,D)==l[3])\n            if(gcd(B,C)==g[4]&&lcm(B,C)==l[4])\n            if(gcd(B,D)==g[5]&&lcm(B,D)==l[5])\n            if(gcd(C,D)==g[6]&&lcm(C,D)==l[6])\n            {\n                write(A);printf(\" \");\n                write(B);printf(\" \");\n                write(C);printf(\" \");\n                write(D);puts(\"\");\n                return;\n            }\n        }\n    }\n}//k=4 \u7684\u60c5\u51b5\nint main()\n{\n    scanf(\"%d%d\",&t,&k);\n    for(int i=1;i<=t;i++)\n    {\n        int s=k*(k-1)/2;\n\n        for(int j=1;j<=s;j++) g[j]=read();\n        for(int j=1;j<=s;j++) l[j]=read();\n        if(k==2) work2();\n        else if(k==3) work3();\n        else if(k==4) work4();\n    }\n    return 0;\n}//\u4e3b\u7a0b\u5e8f\n\n```",
        "postTime": 1587211233,
        "uid": 334727,
        "name": "BreakPlus",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5316 \u3010\u604b\u604b\u7684\u6570\u5b66\u9898\u3011"
    },
    {
        "content": "\u611f\u8c22\u826f\u5fc3\u51fa\u9898\u4ebaScarlet~ Q^Q\n\n\u53d1\u73b0 $k$ \u7684\u8303\u56f4\u5de8\u5c0f\uff0c\u5c31\u53ef\u4ee5\u4e71\u641e\u4e86\u3002\n\n\u5bf9\u4e8e $k=2$\uff0c\u663e\u7136\u7b54\u6848\u5c31\u662f\u8f93\u5165\u7684\u4e24\u4e2a\u6570\u3002\n\n\u7136\u540e\u60f3\u5230 $xy=\\gcd(x,y)\\operatorname{lcm}(x,y)$\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u6bcf\u5bf9\u6570\u7684 $\\gcd$ \u548c $\\operatorname{lcm}$ \u662f\u54ea\u4e2a\u3002\n\n\u5bf9\u4e8e $k=3$\uff0c\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86 $x_1x_2,x_1x_3,x_2x_3$ \u7684\u503c\uff0c\u90a3\u4e48\u89e3\u4e2a\u65b9\u7a0b\u770b\u770b\u662f\u4e0d\u662f\u6574\u6570\u5c31\u884c\u4e86\u3002\n\n\u5bf9\u4e8e $k=4$\uff0c\u53ef\u4ee5\u5148\u89e3\u51fa\u5176\u4e2d\u4e09\u4e2a\u672a\u77e5\u6570\uff0c\u7136\u540e\u5224\u65ad\u662f\u5426\u5b58\u5728\u5408\u6cd5\u7684\u7b2c\u56db\u4e2a\u6570\u3002\n\n\u7136\u540e\u7531\u4e8e\u4e0d\u60f3\u7528__int128\uff08\u6bd5\u7adfCCF\u7cfb\u5217\u4e0d\u7ed9\u7528\uff09\uff0c\u5c31\u7528\u4e86long double\u3002\u6015\u6389\u7cbe\u5ea6\uff0c\u5c31\u518d\u52a0\u4e86\u5f88\u591a\u7684\u5224\u65ad\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O((\\frac{k(k-1)}{2}!)^2k^2\\log v)$\uff0c\u7136\u800c\u57fa\u672c\u8fbe\u4e0d\u5230\u4e0a\u754c\uff0c\u8dd1\u5f97\u5de8\u5feb\uff0c\u6240\u6709\u70b9\u90fd\u662f3ms\u3002\uff08\u4f3c\u4e4e\u8fd8\u662f\u6700\u4f18\u89e3\uff1f\uff09\n\n\u8d5b\u540e\u542c\u51fa\u9898\u4eba\u8bf4\u4f3c\u4e4e\u5361\u4e0d\u6389long double\uff0c\u771f\u7684\u826f\u5fc3\u554a\u2026\u2026~~\u660e\u660e\u662f\u60f3\u6bd2\u7624\u5374\u6bd2\u7624\u4e0d\u8d77\u6765~~\n\n\u4e00\u5f00\u59cb\u6302\u5728\u5feb\u8bfb\u6ca1\u5f00long long\u4e0a\uff0c\u7ed3\u679c\u4e00\u4e0b\u8dcc\u5230\u4e86rk12\u2026\u2026\u672c\u6765\u53ef\u4ee5rk1\u7684\u2026\u2026\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int,int> PII;\nconst int maxn=100010;\n#define MP make_pair\n#define PB push_back\n#define lson o<<1,l,mid\n#define rson o<<1|1,mid+1,r\n#define FOR(i,a,b) for(int i=(a);i<=(b);i++)\n#define ROF(i,a,b) for(int i=(a);i>=(b);i--)\n#define MEM(x,v) memset(x,v,sizeof(x))\ninline ll read(){\n\tchar ch=getchar();ll x=0,f=0;\n\twhile(ch<'0' || ch>'9') f|=ch=='-',ch=getchar();\n\twhile(ch>='0' && ch<='9') x=x*10+ch-'0',ch=getchar();\n\treturn f?-x:x;\n}\nint t,k,n;\nll a[10],b[10],tmp[10],ans[10];\nbool check(ld x){\t//\u5224\u65ad\u662f\u4e0d\u662f\u6574\u6570\n\treturn min(ceil(x)-x,x-floor(x))<=1e-5;\n}\nbool equal(ld x,ld y,ld z){\t//\u5224\u65ad\u4e09\u4e2a\u6570\u662f\u5426\u76f8\u540c\n\treturn fabs(x-z)<=1e-5 && fabs(y-z)<=1e-5;\n}\nll gcd(ll x,ll y){\n\treturn y?gcd(y,x%y):x;\n}\nll lcm(ll x,ll y){\n\treturn x/gcd(x,y)*y;\n}\nint main(){\n\tt=read();k=read();n=k*(k-1)/2;\n\twhile(t--){\n\t\tFOR(i,1,n) a[i]=read();\n\t\tFOR(i,1,n) tmp[i]=read();\n\t\tif(k==2) printf(\"%lld %lld\\n\",a[1],tmp[1]);\n\t\telse{\n\t\t\tsort(a+1,a+n+1);sort(tmp+1,tmp+n+1);\n\t\t\tMEM(ans,0);\n\t\t\tdo{\n\t\t\t\tFOR(i,1,n) b[i]=tmp[i];\n\t\t\t\tdo{\n\t\t\t\t\tld a1,a2,a3;\n\t\t\t\t\ta1=sqrt((ld)b[1]/a[3]/b[3]*a[1]*a[2]*b[2]);\n\t\t\t\t\ta2=sqrt((ld)b[1]/a[2]/b[2]*a[1]*a[3]*b[3]);\n\t\t\t\t\ta3=sqrt((ld)b[3]/a[1]/b[1]*a[3]*a[2]*b[2]);\t//\u89e3\u65b9\u7a0b\n\t\t\t\t\tif(!check(a1) || !check(a2) || !check(a3)) continue;\n\t\t\t\t\tif(k==3){\n\t\t\t\t\t\tans[1]=ll(a1+0.5);\n\t\t\t\t\t\tans[2]=ll(a2+0.5);\n\t\t\t\t\t\tans[3]=ll(a3+0.5);\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tld a4=(ld)a[4]/a1*b[4],a5=(ld)a[5]/a2*b[5],a6=(ld)a[6]/a3*b[6];\n\t\t\t\t\t\tif(check(a4) && equal(a4,a5,a6)){\t//\u5982\u679c\u6709\u5408\u6cd5\u7684\u7b2c\u56db\u4e2a\u672a\u77e5\u6570\n\t\t\t\t\t\t\tans[1]=ll(a1+0.5);\n\t\t\t\t\t\t\tans[2]=ll(a2+0.5);\n\t\t\t\t\t\t\tans[3]=ll(a3+0.5);\n\t\t\t\t\t\t\tans[4]=ll(a4+0.5);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tint cnt=0;\n\t\t\t\t\tif(!ans[1]) continue;\n\t\t\t\t\tif(k==4) swap(a[3],a[4]),swap(b[3],b[4]);\t//\u7531\u4e8e\u79cd\u79cd\u539f\u56e0\u5fc5\u987b\u8981\u8fd9\u4e48\u5e72\uff08\u7406\u89e3\u4e86\u524d\u9762\u7684\u4ee3\u7801\u5e94\u8be5\u5c31\u61c2\u4e86\uff09\n\t\t\t\t\tFOR(i,1,k){\t//\u4e3a\u4e86\u4fdd\u9669\uff0c\u52a0\u4e2a\u5224\u65ad\n\t\t\t\t\t\tFOR(j,i+1,k){\n\t\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\t\tif(gcd(ans[i],ans[j])!=a[cnt] || lcm(ans[i],ans[j])!=b[cnt]){\n\t\t\t\t\t\t\t\tFOR(hhh,1,k) ans[hhh]=0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(!ans[1]) break;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(!ans[1]) break;\n\t\t\t\t\t}\n\t\t\t\t\tif(k==4) swap(a[3],a[4]),swap(b[3],b[4]);\n\t\t\t\t\tif(ans[1]) break;\n\t\t\t\t}while(next_permutation(b+1,b+n+1));\n\t\t\t\tif(ans[1]) break;\n\t\t\t}while(next_permutation(a+1,a+n+1));\n\t\t\tFOR(i,1,k) printf(\"%lld \",ans[i]);\n\t\t\tputs(\"\");\n\t\t}\n\t}\n}\n```",
        "postTime": 1555756108,
        "uid": 72118,
        "name": "AThousandSuns",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5316 \u3010\u604b\u604b\u7684\u6570\u5b66\u9898\u3011"
    },
    {
        "content": "\u8fd9\u9898\u9898\u610f\u7279\u522b\u7b80\u5355\uff0c\u4e71\u5e8f\u7ed9k\u4e2a\u6570\u4e24\u4e24\u7684gcd\u548clcm\uff0c\u6c42\u8fd9k\u4e2a\u6570\u3002\n\n\u8fd9\u9898\u7684\u6570\u636e\u8303\u56f4\u4e5f\u7279\u522b\u7b80\u5355\uff0c$2\u2264k\u22644$\uff0c$T\u22645$\uff0c~~\u4e00\u770b\u5c31\u662f\u9053\u66b4\u529b\u641c\u7d22\u90fd\u80fd\u8fc7\u7684\u6c34\u9898\u5bf9\u4e0d\u5bf9~~\n\n#### \u524d\u8a00\n\n\u4e0a\u9762\u7684\u9898\u89e3\u90fd\u662f\u7528_int128\u628agcd\u548clcm\u4e58\u8d77\u6765\u518d\u641e\uff0c\u4e8e\u662f\u6211\u51b3\u5b9a\u5199\u4e00\u4e2a\u4e0d\u7528_int128\u7684\u57fa\u4e8e\u62c6\u8d28\u56e0\u6570\u7684\u9898\u89e3~~\u867d\u7136\u672c\u8d28\u4e0a\u662f\u7528\u4e86\u9ad8\u7cbe\u5ea6~~\n\n### \u9898\u89e3\n\n\u9996\u5148\u6211\u4eec\u77e5\u9053$gcd(a/gcd(a,b),b/gcd(a,b))=1$\uff0c$lcm(a,b)=a*b/gcd(a,b)$\u3002\n\n\u90a3\u4e48\u5c31\u6709\u4e2a\u63a8\u8bba\uff0c\u8bbe$lcm(a,b)/gcd(a,b)$\u7684\u8d28\u56e0\u6570\u5206\u89e3\u5f0f\u4e3a$P^{x_{1}}_{1}P^{x_{2}}_{2}...P^{x_{n}}_{n}$\uff0c\u90a3\u4e48\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$1\u2264k\u2264n$\uff0c\u8981\u4e48\u6709$P^{x_{k}}_{k}|a$\u4e14$gcd(P^{x_{k}}_{k},b)=1$\uff0c\u8981\u4e48\u5c31\u53cd\u8fc7\u6765\u3002\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u6bcf\u4e00\u4e2a$P^{x_{k}}_{k}$\u90fd\u53ef\u4ee5\u5212\u5230a\u6216\u8005b\u7684\u56e0\u6570\u91cc\u9762\u53bb\u3002\u7136\u540e\u53ea\u8981\u77e5\u9053\u4e86\u8fd9\u4e2a\u8d28\u56e0\u6570\u5206\u89e3\u5f0f\uff0c\u5c31\u53ef\u4ee5\u679a\u4e3ea\u548cb\u4e86\u3002\u5728$1e18$\u7684\u8303\u56f4\u5185\u4e00\u4e2a\u6570\u6700\u591a\u53ea\u670915\u4e2a\u8d28\u56e0\u6570\uff0c\u6240\u4ee5$2^n$\u679a\u4e3e\u5b8c\u5168\u53ef\u4ee5\u63a5\u53d7\u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u679a\u4e3e\u6bcf\u4e2agcd\u5bf9\u5e94\u54ea\u4e2alcm\uff0c\u7136\u540e\u968f\u4fbf\u53d6\u4e00\u7ec4\u5bf9\u5e94\u6765\u679a\u4e3e\u4e24\u4e2a\u6570$a1$\u548c$a2$\uff0c\u7136\u540e\u5206\u7c7b\u8ba8\u8bba\u3002\n\n$k=2$ \u76f4\u63a5\u628a$a1$\u548c$a2$\u8f93\u51fa\u5c31\u5b8c\u4e8b\u4e86\n\n$k=3$ \u770b$a1$\u80fd\u4e0d\u80fd\u6574\u9664\u53e6\u5916\u4e24\u7ec4\u5bf9\u5e94\uff0c\u7531\u6b64\u62c6\u51fa$a3$\uff0c\u7136\u540e\u9a8c\u8bc1$a2$\u548c$a3$\u5408\u8d77\u6765\u662f\u4e0d\u662f\u5269\u4e0b\u90a3\u7ec4\u5bf9\u5e94\n\n$k=4$ \u548c$k=3$\u5dee\u4e0d\u591a\uff0c\u5c31\u662f\u679a\u4e3e\u4e24\u7ec4\u5bf9\u5e94\u7528$a1$\u53bb\u62c6\u51fa$a3$\u548c$a4$\uff0c\u7136\u540e\u9a8c\u8bc1$a2$\u3001$a3$\u3001$a4$\u5408\u8d77\u6765\u662f\u4e0d\u662f\u5269\u4e0b\u90a3\u4e09\u7ec4\n\n\u7136\u540e\u8fd9\u4e2a\u505a\u6cd5\u7ef4\u62a4\u7684\u662f\u6bcf\u4e2a\u6570\u7684\u8d28\u56e0\u6570\u5206\u89e3\u5f0f\uff0c\u4e58\u5c31\u662f\u9010\u4e2a\u52a0\uff0c\u9664\u5c31\u662f\u9010\u4e2a\u51cf\uff0c\u6240\u4ee5\u4e0d\u4f1a\u6709\u7206longlong\u7684\u5730\u65b9\n\n\u81f3\u4e8e1e18\u600e\u4e48\u62c6\u8d28\u56e0\u6570\u2026\u2026\u53bb\u6284\u4e2apollard-rho\u677f\u5b50\u8fc7\u6765\u54af\n\n### \u4ee3\u7801\n\n\u4ee3\u7801\u91cc\u7528\u7684map\u7ef4\u62a4\u8d28\u56e0\u6570\u5206\u89e3\u5f0f\uff0c\u8003\u573a\u8111\u62bd\u7528\u4e86unordered_map\u7ed3\u679c\u5fd8\u4e86\u8fd9\u4e2a\u4e0d\u662f\u6309\u5173\u952e\u5b57\u6392\u5e8f\u7684\u7ed3\u679cwa+tle\u5f97\u5230\u4e8665\u7684\u597d\u5206\u6570\u2026\u2026\n\n~~\u672c\u9898\u6700\u957fac\u4ee3\u7801\u8b66\u544a~~\n\n```cpp\n#include<iostream>\n#include<cstdlib>\n#include<cstdio>\n#include<algorithm>\n#include<vector>\n#include<unordered_map>\n#include<map>\nusing namespace std;\ntypedef long long ll;\nconst ll INF=1e18+5;\n#define um map<ll,int>\n#define ui map<ll,int>::iterator\n#define ft first\n#define sd second\n#define mytz __builtin_ctzll\n\ninline ll gcd(ll a,ll b)\n{\n    if(!a)return b;\n    if(!b)return a;\n    if(!(a^b))return a;\n    int t=mytz(a|b);\n    a>>=mytz(a);\n    do\n    {\n        b>>=mytz(b);\n        if(a>b)\n        {\n            ll t=a;\n            a=b;\n            b=t;\n        }\n        b-=a;\n    }while(b);\n    return a<<t;\n}\ninline ll qc(ll a,ll b,ll p)\n{\n    a%=p;\n    b%=p;\n    ll qwe=((long double)a/p*b+1e-8);\n    ll asd=(a*b-qwe*p);\n    return asd<0?asd+p:asd;\n}\ninline ll fpow(ll qwe,ll asd,ll zxc)\n{\n    ll a=1;\n    for(;asd;asd>>=1,qwe=qc(qwe,qwe,zxc))\n    {\n        if(asd&1)a=qc(a,qwe,zxc);\n    }\n    return a;\n}\nstruct miaow\n{\n    ll a;\n    int b;\n    miaow(ll a=0,int b=0):a(a),b(b){}\n};\nstruct pho\n{\n    inline int mlyz(ll a,ll x)\n    {\n        int t=0;\n        ll x2=x-1,a2;\n        while(!(x2&1))x2>>=1,t+=1;\n        a=fpow(a,x2,x);\n        while(t)\n        {\n            --t;\n            a2=qc(a,a,x);\n            if(a2==1&&a!=1&&a!=x-1)return 1;\n            a=a2;\n        }\n        if(a!=1)return 1;\n        else return 0;\n    }\n    inline int mllb(ll x)\n    {\n        if(x==2||x==3||x==5)return 1;\n        if((!(x&1))||(!(x%3))||(!(x%5)))return 0;\n        ll a[6]={2,3,5,29,31,37};\n        for(int i=0;i<6&&a[i]<x;++i)\n        {\n            if(mlyz(a[i],x))return 0;\n        }\n        return 1;\n    }\n    inline ll prho(ll n,ll m)\n    {\n        if(!(n&1))return 2;\n        if(!(n%3))return 3;\n        if(!(n%5))return 5;\n        int i=1;\n        ll x=rand()%(n-1)+1,y=x,d;\n        int k=2;\n        while(1)\n        {\n            ++i;\n            x=(qc(x,x,n)-m+n)%n;\n            if(!(y^x))return n;\n            d=gcd((y-x+n)%n,n);\n            if(d!=1&&d!=n)return d;\n            if(!(i^k))\n            {\n                y=x;\n                k<<=1;\n            }\n        }\n    }\n    inline void fj2(ll x,ll m,um& qwe)\n    {\n        if(mllb(x))\n        {\n        \tif(x==1)return;\n            if(qwe.count(x))qwe[x]+=1;\n            else qwe[x]=1;\n            return;\n        }\n        ll y=x,z=m;\n        while(!(y^x))\n        {\n            y=prho(x,--m);\n        }\n        y>(x/y)?(fj2(y,z,qwe),fj2(x/y,z,qwe)):(fj2(x/y,z,qwe),fj2(y,z,qwe));\n    }\n    inline void fj(ll x,um& qwe)\n    {\n        fj2(x,127,qwe);\n    }\n}pollard;\n\nconst int N=31;\nll gc[N],lc[N],lc2[N],su[N];\nint mj[N];\nint t,k,k2;\num yz[N],gc2[N];\nint bj[N]={0};\num sz[N];\nvector<miaow> gg;\nbool yycf(int a,int b)\n{\n    for(ui i=gc2[b].begin();i!=gc2[b].end();++i)\n    {\n        if(!sz[a].count(i->first)||sz[a][i->first]<i->second)return false;\n    }\n    return true;\n}\nvoid cf(int a,int b)\n{\n    for(ui i=gc2[b].begin();i!=gc2[b].end();++i)\n    {\n        if(sz[a][i->first]==i->second)sz[a].erase(i->first);\n        else sz[a][i->first]-=i->second;\n    }\n}\nvoid cc(int a,int b)\n{\n    for(ui j=gc2[b].begin();j!=gc2[b].end();++j)\n    {\n        if(!sz[a].count(j->first))sz[a][j->first]=j->second;\n        else sz[a][j->first]+=j->second;\n    }\n}\nbool yy(int a,int c)\n{\n    if(yycf(a,c))\n    {\n        cf(a,c);\n        int err=0;\n        for(ui i=sz[a].begin();i!=sz[a].end();++i)\n        {\n            if(!yz[c].count(i->first)||yz[c][i->ft]!=i->second)\n            {\n                err=1;\n                break;\n            }\n        }\n        cc(a,c);\n        if(err)return false;\n    }\n    else\n    {\n        return false;\n    }\n    return true;\n}\nbool yy2(int a,int b,int c)\n{\n    if(yycf(a,c)&&yycf(b,c))\n    {\n        cf(a,c);cf(b,c);\n        int err=0;\n        if(yz[c].size()!=sz[a].size()+sz[b].size())\n        {\n            err=1;\n            goto sssss;\n        }\n        for(ui i=sz[a].begin();i!=sz[a].end();++i)\n        {\n            if(!yz[c].count(i->first)||yz[c][i->ft]!=i->second)\n            {\n                err=1;\n                goto sssss;\n            }\n        }\n        for(ui i=sz[b].begin();i!=sz[b].end();++i)\n        {\n            if(!yz[c].count(i->first)||yz[c][i->ft]!=i->second)\n            {\n                err=1;\n                break;\n            }\n        }\n        sssss:cc(a,c);cc(b,c);\n        if(err)return false;\n    }\n    else\n    {\n        return false;\n    }\n    return true;\n}\nvoid fg(int a,int b,int c)\n{\n    sz[b].clear();\n    cf(a,c);\n    ui wz=sz[a].begin();\n    for(ui i=yz[c].begin();i!=yz[c].end();++i)\n    {\n        while(wz!=sz[a].end()&&wz->first<i->first)++wz;\n        if(wz==sz[a].end())\n        {\n            for(;i!=yz[c].end();++i)sz[b][i->first]=i->second;\n            break;\n        }\n        if(wz->first!=i->first)sz[b][i->first]=i->second;\n    }\n    cc(a,c);\n    cc(b,c);\n}\nvoid sc(int x)\n{\n    ll a=1;\n    for(ui i=sz[x].begin();i!=sz[x].end();++i)a*=fpow(i->first,i->second,INF);\n    cout<<a<<\" \";\n}\nvoid solve()\n{\n    for(int i=1;i<=k2;++i)\n    {\n        cin>>gc[i];\n        gc2[i].clear();\n        pollard.fj(gc[i],gc2[i]);\n    }\n    for(int i=1;i<=k2;++i)cin>>lc2[i];\n    for(int i=1;i<=k2;++i)mj[i]=i;\n    do\n    {\n        int err=0;\n        for(int i=1;i<=k2;++i)\n        {\n            lc[i]=lc2[mj[i]];\n            if(lc[i]%gc[i]!=0)\n            {\n                err=1;\n                break;\n            }\n            su[i]=lc[i]/gc[i];\n            bj[i]=0;\n        }\n        if(err)goto sss;\n        for(int i=1;i<=k2;++i)\n        {\n            yz[i].clear();\n            pollard.fj(su[i],yz[i]);\n        }\n        gg.clear();\n        for(ui i=yz[1].begin();i!=yz[1].end();++i)\n        {\n            gg.push_back(miaow(i->first,i->second));\n        }\n        for(int i=0;i<((1<<gg.size()));++i)\n        {\n            for(int j=1;j<=k;++j)sz[j].clear();\n            for(int j=0;j<gg.size();++j)\n            {\n                if(i&(1<<j))sz[1][gg[j].a]=gg[j].b;\n                else sz[2][gg[j].a]=gg[j].b;\n            }\n            cc(1,1);cc(2,1);\n            if(k==2)\n            {\n                sc(1);sc(2);cout<<endl;\n                goto ssss;\n            }\n            if(k==3)\n            {\n                int ye=0;\n                if(yy(1,2))\n                {\n                    fg(1,3,2);\n                    if(yy2(2,3,3))\n                    {\n                        sc(1);sc(2);sc(3);cout<<endl;\n                        goto ssss;\n                    }\n                    else ye=1;\n                }\n                else ye=1;\n                if(ye)\n                {\n                    if(yy(1,3))\n                    {\n                        fg(1,3,3);\n                        if(yy2(2,3,2))\n                        {\n                            sc(1);sc(2);sc(3);cout<<endl;\n                            goto ssss;\n                        }\n                    }\n                }\n            }\n            if(k==4)\n            {\n                int ye=0;\n                for(int j=2;j<=k2;++j)\n                {\n                    if(yy(1,j))\n                    {\n                        fg(1,3,j);\n                        bj[j]=13;\n                        for(int l=j+1;l<=k2;++l)\n                        {\n                            if(yy(1,l))\n                            {\n                                fg(1,4,l);\n                                bj[l]=14;\n                                vector<int> asd;\n                                for(int p=2;p<=k2;++p)if(!bj[p])asd.push_back(p);\n                                if(yy2(2,3,asd[0]))\n                                {\n                                    if(yy2(2,4,asd[1])&&yy2(3,4,asd[2]))\n                                    {\n                                        sc(1);sc(2);sc(3);sc(4);cout<<endl;\n                                        ye=1;goto ss;\n                                    }\n                                    if(yy2(3,4,asd[1])&&yy2(2,4,asd[2]))\n                                    {\n                                        sc(1);sc(2);sc(3);sc(4);cout<<endl;\n                                        ye=1;goto ss;\n                                    }\n                                }\n                                if(yy2(2,4,asd[0]))\n                                {\n                                    if(yy2(2,3,asd[1])&&yy2(3,4,asd[2]))\n                                    {\n                                        sc(1);sc(2);sc(3);sc(4);cout<<endl;\n                                        ye=1;goto ss;\n                                    }\n                                    if(yy2(3,4,asd[1])&&yy2(2,3,asd[2]))\n                                    {\n                                        sc(1);sc(2);sc(3);sc(4);cout<<endl;\n                                        ye=1;goto ss;\n                                    }\n                                }\n                                if(yy2(3,4,asd[0]))\n                                {\n                                    if(yy2(2,3,asd[1])&&yy2(2,4,asd[2]))\n                                    {\n                                        sc(1);sc(2);sc(3);sc(4);cout<<endl;\n                                        ye=1;goto ss;\n                                    }\n                                    if(yy2(2,4,asd[1])&&yy2(2,3,asd[2]))\n                                    {\n                                        sc(1);sc(2);sc(3);sc(4);cout<<endl;\n                                        ye=1;goto ss;\n                                    }\n                                }\n                                ss:int zxczxczxc;\n                                if(ye)goto ssss;\n                                bj[l]=0;\n                            }\n                        }\n                        bj[j]=0;\n                    }\n                }\n            }\n        }\n        sss:int qweqweqwe;\n    }while(next_permutation(mj+1,mj+k2+1));\n    ssss:int asdasdasd;\n}\nint main()\n{\n    cin>>t>>k;\n    k2=(k*(k-1)/2);\n    while(t)\n    {\n    \t--t;\n    \tsolve();\n    }\n}\n```\n",
        "postTime": 1556011140,
        "uid": 13105,
        "name": "miaow",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5316 \u3010\u604b\u604b\u7684\u6570\u5b66\u9898\u3011"
    }
]
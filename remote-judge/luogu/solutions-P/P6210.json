[
    {
        "content": "### Subtask $1$ & $2$\n\u76f4\u63a5\u66b4\u529b\u8ba1\u7b97\u5373\u53ef\u3002~~\u65f6\u95f4\u590d\u6742\u5ea6\u4e0d\u4f1a\u7b97\u3002~~\n\n\u4ee3\u7801\uff1a\n```python\ndef gcd(a, b):\n\tif b == 0:\n\t\treturn a\n\treturn gcd(b, a % b)\n\ndef f_function(n, m, k):\n        ans = 0\n        for i in range(1, m + 1):\n                if gcd(i, n) <= c:\n                        ans += 1\n        return ans\n\nn, c, f, l, r = map(int, input().split())\ncnt = 0\ni = 1\nwhile True:\n\tif gcd(i, n) <= c:\n\t\tcnt += 1\n\t\tif cnt >= f:\n\t\t\tbreak\n\ti += 1\nprint(i)\nprint(f_function(n, r, c) - f_function(n, l - 1, c), end = \"\")\n```\n### Subtask $3$ & $4$\n\u524d\u7f6e\u829d\u58eb\uff1a[\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14](https://oi-wiki.org/math/mobius/)\n\n\u8003\u8651\u5316\u7b80\u7b2c\u4e8c\u95ee\u6240\u6c42\u5f0f\u5b50\u3002\n\n\u8bbe\u8be5\u5f0f\u5b50\u7684\u503c\u4e3a $g(n, r, c) - g(n, l - 1, c)$\uff0c\u5219\u9700\u8981\u5316\u7b80 $g$ \u51fd\u6570\u3002\n\n$g(n, m, k) = \\displaystyle\\sum_{i = 1}^m [\\gcd(i, n) \\leq k]$\n\n$ = \\displaystyle\\sum_{d\\ |\\ n}^k \\displaystyle\\sum_{i = 1}^m [\\gcd(i, n) = d]$\n\n$ = \\displaystyle\\sum_{d\\ |\\ n}^k \\displaystyle\\sum_{i = 1}^{\\lfloor \\frac{m}{d} \\rfloor} [\\gcd(i, \\frac{n}{d}) = 1]$\n\n\u8bbe\u7b2c\u4e8c\u5c42 $\\sum$ \u4e3a $f(\\frac{n}{d}, \\lfloor \\frac{m}{d} \\rfloor)$\uff0c\u5219\u9700\u8981\u5316\u7b80 $f$ \u51fd\u6570\u3002\n\n$f(n, k) = \\displaystyle\\sum_{i = 1}^k [\\gcd(i, n) = 1]$\n\n$ = \\displaystyle\\sum_{i = 1}^k \\sum_{d\\ | \\gcd(i, n)} \\mu(d)$\n\n$ = \\displaystyle\\sum_{d\\ |\\ n} \\mu(d) \\lfloor \\frac{k}{d} \\rfloor$\n\n\u5bf9\u4e8e\u7b2c\u4e00\u95ee\uff0c\u8003\u8651\u4e8c\u5206\u7b54\u6848\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5148\u6d88\u9664\u6240\u6709\u957f\u5ea6\u4e3a $n$ \u7684 $\\gcd$ \u5468\u671f\u7684\u5f71\u54cd\uff08\u5355\u4e2a\u5468\u671f\u4e3a $g(n,  n, c)$\uff09\uff0c\u4ece\u800c\u4f7f\u4e8c\u5206\u7b54\u6848\u8303\u56f4\u964d\u4f4e\u4e3a $1 \\sim n$\uff0c\u7136\u540e\u8fdb\u884c\u4e8c\u5206\u7b54\u6848\uff0c\u6700\u540e\u518d\u5c06\u6574\u5468\u671f\u7684\u8d21\u732e\u52a0\u4e0a\u5373\u53ef\u3002~~\u65f6\u95f4\u590d\u6742\u5ea6\u8fd8\u662f\u4e0d\u4f1a\u7b97\u3002~~\n\n\u5177\u4f53\u7ec6\u8282\u89c1\u4ee3\u7801\u6ce8\u91ca\u3002\n\n\u4ee3\u7801\uff1a\n```python\nimport math\n\ndef mu(n):\n\tans = 1\n\ti = 2\n\twhile i * i <= n:\n\t\tif n % i == 0:\n\t\t\tn //= i\n\t\t\tif n % i == 0:\n\t\t\t\treturn 0\n\t\t\tans = -ans\n\t\ti += 1\n\tif n > 1:\n\t\tans = -ans\n\treturn ans\n\ndef f_function(n, k):\n\tt = min(int(math.sqrt(n)), k)\n\tans = 0\n\tfor i in range(1, t + 1):\n\t\tif n % i == 0:\n\t\t\tans += mu(i) * (k // i)\n\t\t\tif i * i != n and n // i <= k:\n\t\t\t\tans += mu(n / i) * (k // (n // i))\n\treturn ans\n\ndef g(n, m, k):\n\tt = min(int(math.sqrt(n)), k)\n\tans = 0\n\tfor i in range(1, t + 1):\n\t\tif n % i == 0:\n\t\t\tans += f_function(n // i, m // i)\n\t\t\tif i * i != n and n // i <= k:\n\t\t\t\tans += f_function(i, m // (n / i))\n\treturn ans\n\ndef search(n, m, k):\n\tl = 1\n\tr = n\n\twhile l < r:\n\t\tmid = (l + r) >> 1\n\t\tif g(n, mid, m) < k:\n\t\t\tl = mid + 1\n\t\telse:\n\t\t\tr = mid;\n\treturn l\n\nn, c, f, l, r = map(int, input().split())\nx = g(n, n, c)\nif f % x == 0: // \u6574\u5468\u671f\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u5b9e\u9645\u7aef\u70b9\u5728 1 ~ n \u4e2d\u7684\u60c5\u51b5\u3002\n\ty = (f // x - 1) * n\n\tf = x\nelse:\n\ty = f // x * n\n\tf %= x\nprint(search(n, c, f) + y)\nprint(g(n, r, c) - g(n, l - 1, c), end = \"\")\n```",
        "postTime": 1606656559,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P6210 \u3010\u300cSWTR-04\u300dEasy Math Problems\u3011"
    },
    {
        "content": "~~\u8fd9\u9053\u9898\u63a8\u5f0f\u5b50\u8981\u83ab\u53cd\u4f60\u8ddf\u6211\u8bf4\u662f\u7eff\u9898~~\n\n\u7b2c\u4e00\u95ee\u8c8c\u4f3c\u4e0d\u592a\u597d\u505a\u6211\u4eec\u5148\u770b\u5230\u7b2c\u4e8c\u95ee\n\n\u4ed6\u8981\u6c42\u4e2a\u6570\u800c\u4e14\u662f\u533a\u95f4\u5185\uff0c\u6839\u636e\u5957\u8def\u6700\u540e\u4e00\u6b65\u5e94\u8be5\u662f $\\mathrm{cnt}(r)-\\mathrm{cnt}(l-1)$\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ea\u8981\u6c42 $\\mathrm{cnt}(m)$ \u5373 $[1,m]$ \u5185\u7684\u4e2a\u6570\u5c31\u884c\u4e86\u3002\n\n$$\n\\mathrm{cnt}(m)=\\sum_{i=1}^m[\\gcd(i,n)\\le c]\n$$\n\n\u5982\u679c\u4ee4\n\n$$\nf(n)=[n\\le c]=\\sum_{d|n}g(d)\n$$\n\n\u6839\u636e\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n\n$$\ng(n)=\\sum_{d|n}\\mu\\left(\\frac nd\\right)f(d)\n$$\n\n\u4e8e\u662f\n\n$$\n\\begin{aligned}\n\\mathrm{cnt}(m)\n\n&=\\sum_{i=1}^m\\sum_{d|i,d|n}g(d)\\\\\n\n&=\\sum_{d=1}^n[d|n]g(d)\\left\\lfloor\\frac md\\right\\rfloor\n\n\\end{aligned}\n$$\n\n\u8fd9\u4e2a $m$ \u592a\u5927\u8fd8\u662f\u505a\u4e0d\u4e86\uff0c\u4f46\u5bf9\u7b54\u6848\u6709\u8d21\u732e\u7684 $d$ \u4e00\u5b9a\u6ee1\u8db3 $d|n$\uff0c\u6240\u4ee5\u53ef\u4ee5\u4ee4 $m=kn+r(0\\le r<n)$\n\n$$\n\\begin{aligned}\n\\mathrm{cnt}(m)\n\n&=k\\sum_{d=1}^n[d|n]g(d)\\frac{n}d+\\sum_{d=1}^n[d|n]g(d)\\left\\lfloor\\frac rd\\right\\rfloor\\\\\n\n&=k\\mathrm{cnt}(n)+\\mathrm{cnt}(r)\n\n\\end{aligned}\n$$\n\n\u76f4\u63a5\u901a\u8fc7\u66b4\u529b\u6c42\u51fa $\\mathrm{cnt}(1\\dots n)$\uff08$O(n\\log n)$ \u8c8c\u4f3c\u4e0d\u592a\u884c\uff0c\u9700\u8981\u5361\u5361\u5e38\uff0c\u770b\u4ee3\u7801\uff09\uff0c\u7136\u540e $k$ \u548c $r$ \u90fd\u80fd\u76f4\u63a5\u9ad8\u7cbe\u9664\u6c42\u51fa\u6765\u3002\n\n\u7b2c\u4e00\u95ee $f=k\\mathrm{cnt}(n)+\\mathrm{cnt}(r)$\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u9ad8\u7cbe\u9664\uff0c\u518d\u82b1 $O(n)$ \u679a\u4e3e\u6216\u8005 $O(\\log n)$ \u4e8c\u5206\u67e5\u627e\u5f97\u5230 $r$ \u5c31\u597d\u4e86\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#define pr pair<num,int>\n#define mp make_pair\n#define fst first\n#define scd second\n#define re register\nusing namespace std;\nint n,c;\nint cnt[10000005];\nchar s[100005];\nstruct num{\n\tint a[100010],len;\n\tvoid operator--(){\n\t\tint res=1;\n\t\tfor(re int i=1;i<=len;++i){\n\t\t\tif(!res) break;\n\t\t\tif(a[i]) --a[i],res=0;\n\t\t\telse a[i]=9;\n\t\t}\n\t\tif(len>1){\n\t\t\tif(!a[len]) --len;\n\t\t}\n\t\treturn;\n\t}\n\tvoid operator+=(int y){\n\t\tfor(re int i=1;i<=len;++i){\n\t\t\ta[i]+=y;\n\t\t\ty=a[i]/10; a[i]%=10;\n\t\t\tif(!y) break;\n\t\t}\n\t\twhile(y) a[++len]=y%10,y/=10;\n\t\treturn;\n\t}\n\tvoid operator-=(num y){\n\t\tint res=0;\n\t\tfor(re int i=1;i<=len;++i){\n\t\t\tif(i>y.len) a[i]-=res;\n\t\t\telse a[i]-=(res+y.a[i]);\n\t\t\tif(a[i]<0) a[i]+=10,res=1;\n\t\t\telse res=0;\n\t\t}\n\t\twhile(len>1){\n\t\t\tif(!a[len]) --len;\n\t\t\telse break;\n\t\t}\n\t\treturn;\n\t}\n\tvoid operator*=(int y){\n\t\tif(!y) a[len=1]=0;\n\t\tint res=0;\n\t\tfor(re int i=1;i<=len;++i){\n\t\t\ta[i]=res+a[i]*y;\n\t\t\tres=a[i]/10; a[i]%=10;\n\t\t}\n\t\twhile(res) a[++len]=res%10,res/=10;\n\t\treturn;\n\t}\n}f,l,r,ans;\nvoid read(num &x){\n\tscanf(\"%s\",s); x.len=strlen(s);\n\tfor(re int i=1;i<=x.len;++i){\n\t\tx.a[i]=(s[x.len-i]^48);\n\t}\n\treturn;\n}\nvoid write(num x){\n\tfor(int i=x.len;i>=1;i-=1) printf(\"%d\",x.a[i]);\n\tprintf(\"\\n\");\n\treturn;\n}\npr operator/(num x,int y){\n\tint res=0;\n\tnum z; z.len=0;\n\tfor(re int i=x.len;i>=1;--i){\n\t\tres=(res<<1)+(res<<3)+x.a[i];\n\t\tz.a[i]=res/y; res%=y;\n\t\tif(z.a[i]&&!z.len) z.len=i;\n\t}\n\treturn mp(z,res);\n}\ninline int check(int x,int y){\n\tif(y){\n\t\tif(x<=c) return 1;\n\t\treturn check(y,x%y);\n\t}\n\telse return (x<=c);\n}\nnum solve(num x){\n\tpr g=x/n; num res;\n\tres=g.fst;\n\tres*=cnt[n];\n\tres+=cnt[g.scd];\n\treturn res;\n}\nint main(){\n\tscanf(\"%d%d\",&n,&c);\n\tint m=n+1>>1;\n\tfor(re int i=1;i<=n;++i){\n\t\tif(i<=m) cnt[i]=check(n,i);\n\t\telse cnt[i]=cnt[n-i];\n\t}\n\tfor(re int i=1;i<=n;++i) cnt[i]+=cnt[i-1];\n\tread(f); pr g=(f/cnt[n]); ans=g.fst;\n\tif(!g.scd) --ans,g.scd=cnt[n];\n\tfor(re int i=g.scd;i<=n;i+=(g.scd-cnt[i])){\n\t\tif(cnt[i]==g.scd){\n\t\t\tans*=n; ans+=i; break;\n\t\t}\n\t}\n\twrite(ans);\n\tread(l); --l; read(r);\n\tans=solve(r); ans-=solve(l);\n\twrite(ans);\n\treturn 0;\n}\n```\n**\u540e(zheng)\u8bb0(wen)**\n\n\u540e\u6765\u6211\u53d1\u73b0\u7528\u83ab\u53cd\u53ea\u662f\u4e3a\u4e86\u8bc1\u5468\u671f\u6027\uff0c\u4f46\u5982\u679c\u53ea\u662f\u8981\u8bc1\u5468\u671f\u6027\u7684\u8bdd\uff0c\u90a3\u5927\u53ef\u4e0d\u5fc5\u8fd9\u4e48\u9ebb\u70e6\u3002\u5176\u5b9e $\\gcd(n,m)=\\gcd(n,m-n)$ \u5b83\u4eec\u540c\u65f6\u5927\u4e8e $c$ \u6216\u540c\u65f6\u4e0d\u5927\u4e8e $c$\uff0c\u4e5f\u5c31\u662f\u76f8\u9694 $n$ \u7684\u4e24\u4e2a\u51fd\u6570\u503c\u76f8\u7b49\uff0c\u6bcf $n$ \u4e2a\u52a0\u8d77\u6765\u7ed3\u679c\u5c31\u4e00\u6837\u3002\n\n~~\u8fd9\u6837\u4e00\u6765\uff0c\u8fd9\u9898\u8bc4\u7eff\u9898\u4e5f\u662f\u5408\u7406\u7684~~\n\nThanks~",
        "postTime": 1652079735,
        "uid": 189682,
        "name": "QQ82272760",
        "ccfLevel": 7,
        "title": "P6210 \u300cSWTR-04\u300dEasy Math Problems \u9898\u89e3"
    },
    {
        "content": "\u9b4f\u8001\u5e08\u7684\u9898\uff0c\u5f88\u9177\uff01\n\n\u9898\u89e3\u533a\u5168\u662f $O(n)$ \u7684\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u5b8c\u5168\u4e0d\u9700\u8981\u3002\n\n\u8003\u8651\u6c42\u51fa\u6240\u6709 $\\gcd(i,n)$ \u4e4b\u540e\uff0c\u5269\u4f59\u7684\u90e8\u5206\u90fd\u662f\u7b80\u5355\u7684\u9ad8\u7cbe\u5ea6\u8fd0\u7b97\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u505a\u7684\u5176\u5b9e\u662f\u5c3d\u91cf\u5feb\u5730\u6c42\u51fa\u6240\u6709 $\\gcd(i,n)$\u3002\u666e\u901a\u7684 $O(n\\log n)$ \u505a\u6cd5\u663e\u7136\u88ab\u5361\u6389\u4e86\uff0c\u4f46\u662f\u5728\u8003\u8651\u83ab\u53cd\u8fd9\u79cd\u9ad8\u7ea7\u7b97\u6cd5\u4e4b\u524d\uff0c\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u5c1d\u8bd5\u66b4\u529b\u3002\n\n\u8003\u8651\u5bf9\u4e8e $n$ \u7684\u6bcf\u4e2a\u8d28\u56e0\u6570 $p$\uff0c\u6211\u4eec\u66b4\u529b\u5730\u7ed9 $p^1,p^2,\\cdots$ \u7684\u500d\u6570\u7684 $\\gcd$ \u6570\u503c\u4e58 $p$\u3002\u8fd9\u73a9\u610f\u7684\u64cd\u4f5c\u6b21\u6570\u662f $\\frac{n}{p}$ \u5230 $\\frac{n}{p-1}$ \u4e4b\u95f4\u7684\u4e00\u4e2a\u6570\u3002\u56e0\u4e3a $2\\times 3\\times 5\\times 7\\times 11\\times 13\\times 17\\times 19$ \u548c $10^7$ \u5f88\u63a5\u8fd1\uff0c\u76f4\u63a5\u8ba1\u7b97\u64cd\u4f5c\u6b21\u6570\u6700\u5927\u503c\u5c31\u53ef\u4ee5\u53d1\u73b0\u64cd\u4f5c\u6b21\u6570\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u3002\n\n\u4e8b\u5b9e\u4e0a\u5199\u51fa\u4ee3\u7801\u8dd1\u5728\u6700\u540e\u4e00\u4e2a sub \u8dd1\u51fa\u4e86 $\\text{50ms}$ \u7684\u597d\u6210\u7ee9\u3002",
        "postTime": 1685539447,
        "uid": 172020,
        "name": "Kevin090228",
        "ccfLevel": 8,
        "title": "\u300cSWTR-04\u300dEasy Math Problems"
    },
    {
        "content": "\u76f8\u5bf9\u6bd2\u7624\u7684\u63a8\u5f0f\u5b50\u9898\u3002\n\n- \u53d8\u91cf\u540d\u79f0\u63d0\u9192\uff1a$n,c,l,r$ \u4e0e\u539f\u9898\u4e2d\u4e00\u81f4\uff0c\u9898\u89e3\u4e2d\u7684 $f$ \u5747\u8868\u793a\u51fd\u6570\u3002\u9664\u53bb\u63a8\u5bfc\u516c\u5f0f\u4e2d\u51fa\u73b0\u7684 $k$\uff0c\u5176\u4f59\u7684 $k$ \u5747\u8868\u793a\u539f\u9898\u4e2d\u7684 $f$\u3002\n\n\u9996\u5148\u770b\u7b2c\u4e00\u95ee\uff0c\u6c42\u7b2c $k$ \u5927\u3002\u6bd4\u8f83\u76f4\u89c2\u7684\u60f3\u6cd5\u662f\u4e8c\u5206\u6216\u6027\u8d28\u3002\u4f46\u6682\u65f6\u60f3\u4e0d\u5230\u4ec0\u4e48\uff0c\u5148\u8fc7\u3002\n\n\u518d\u770b\u7b2c\u4e8c\u95ee\uff0c\u6c42\u533a\u95f4\u5408\u6cd5\u4e2a\u6570\u3002\u4f20\u7edf\u5957\u8def\u80af\u5b9a\u662f\u8f6c\u5316\u4e3a\u524d\u7f00\u76f8\u51cf\u3002\u6240\u4ee5\u8003\u8651\u5982\u4f55\u6c42\u51fa $[1,r]$ \u7684\u5408\u6cd5\u4e2a\u6570\u3002\n\n\u8bbe $f(m)$ \u8868\u793a\u533a\u95f4 $[1,m]$ \u7684\u7b54\u6848\uff0c\u90a3\u4e48\u6211\u4eec\u7684\u5f0f\u5b50\u5373\u4e3a $f(m)=\\sum\\limits_{i=1}^m\\left[\\gcd(i,n)\\le c\\right]$\u3002\n\n\u679a\u4e3e $\\gcd$\uff0c\u53d1\u73b0\u4e00\u5b9a\u4e3a $n$ \u7684\u56e0\u6570\u3002\n$$\nf(m)=\\sum_{k\\mid n,k\\le c}\\sum_{i=1}^m[gcd(i,n)=k]\\\\\n=\\sum_{k\\mid n,k\\le c}\\sum_{i=1}^{\\lfloor\\frac mk\\rfloor}[gcd(i,\\frac nk)=1]\\\\\n=\\sum_{k\\mid n,k\\le c}\\sum_{i=1}^{\\lfloor\\frac mk\\rfloor}\\sum_{d\\mid i,d\\mid \\frac nk}\\mu(d)\\\\\n=\\sum_{k\\mid n,k\\le c}\\sum_{dk\\mid n}\\mu(d)\\lfloor\\frac{m}{dk}\\rfloor\n$$\n\n\u6539\u4e3a\u679a\u4e3e $dk$\n\n$$\nf(m)=\\sum_{T\\mid n}\\lfloor\\frac mT\\rfloor\\sum_{k\\mid T,k\\le c}\\mu(\\frac Td)\n$$\n\n\u8bb0 $g(m)=\\sum\\limits_{d\\mid m,d\\le c}\\mu(\\frac md)$\uff0c\u5219 $f(m)=\\sum\\limits_{T\\mid n}\\lfloor\\frac mT\\rfloor g(T)$\u3002\n\n\u5173\u6ce8\u5230\u5b9e\u9645\u9700\u8981\u8ba1\u7b97\u7684 $T$ \u53ea\u6709 $n$ \u7684\u7ea6\u6570\uff0c$10^7$ \u4ee5\u5185\u7ea6\u6570\u4e2a\u6570\u6700\u591a\u7684\u662f $8648640$\uff0c\u7ea6\u6570\u4e2a\u6570\u4e3a $448$\u3002\u6240\u4ee5 $g$ \u6211\u4eec\u53ef\u4ee5 $500^2$ \u9884\u5904\u7406\u3002\n\n\u81f3\u6b64\uff0c\u524d\u4e09\u4e2a\u5b50\u4efb\u52a1\u5747\u53ef\u6574\u9664\u5206\u5757 $O(\\sqrt m+d(n)^2)$ \u5b8c\u6210\u3002$d(n)$ \u8868\u793a $n$ \u7684\u7ea6\u6570\u4e2a\u6570\u3002\n\n\u8003\u8651\u6211\u4eec\u7684\u590d\u6742\u5ea6\u74f6\u9888\u5728\u4e8e $\\lfloor\\frac mT\\rfloor$\uff0c\u5c1d\u8bd5\u5c06\u5176\u7834\u5f00\u3002\u57fa\u4e8e\u6574\u9664\u7684\u5b9a\u4e49\uff0c\u6211\u4eec\u5047\u8bbe $m=xn+y$\uff0c\u5176\u4e2d $x,y\\ge 0$ \u4e14 $y<x$\u3002\n\n\u90a3\u4e48\u6709 $\\large f(xn+y)=\\sum\\limits_{T\\mid n}\\lfloor\\frac {xn+y}T\\rfloor g(T)$\u3002\n\n\u56e0\u4e3a $T\\mid n$\uff0c\u6240\u4ee5\u5c06\u6574\u9664\u62c6\u5f00\uff0c $x$ \u53ef\u4ee5\u63d0\u51fa\u53bb\u3002\u5f97\u5230 $\\large f(xn+y)=x\\sum\\limits_{T\\mid n}\\frac {n}Tg(T)+\\sum \\limits_{T\\mid n}\\lfloor\\frac yT\\rfloor g(T)$\n\n\u5de6\u8fb9\u4e00\u5b9a\u662f\u6574\u9664\uff0c\u4e8e\u662f\u6709 $f(xn+y)=xf(n)+f(y)$\u3002\n\n\u81f3\u6b64\uff0c\u95ee\u9898\u53d8\u4e3a\u6c42\u51fa $f(1\\dots n)$\u3002\n\n\u8003\u8651\u6bcf\u4e2a $T$ \u5bf9\u6240\u6709 $f$ \u7684\u8d21\u732e\u3002\u5373 $f(x)+=\\lfloor\\frac xT\\rfloor g(T)$\u3002\n\n$g(T)$ \u662f\u5e38\u91cf\u4e0d\u7528\u7ba1\uff0c\u4ece\u6574\u9664\u89d2\u5ea6\u8003\u8651\uff0c\u53d1\u73b0\u4ece $1\\dots n$\uff0c\u6211\u4eec\u7684 $x$ \u9012\u589e\uff0c\u663e\u7136\u6bcf\u589e\u52a0 $T$\uff0c\u6574\u9664\u7684\u503c\u90fd\u4f1a\u591a $1$\u3002\u56e0\u6b64\u53d8\u4e3a\u4e00\u5806\u533a\u95f4\u7684\u52a0\u6cd5\uff0c\u76f4\u63a5\u5dee\u5206\u7d2f\u8ba1\u524d\u7f00\u548c\u5373\u53ef\u3002\u5bf9\u4e8e\u6bcf\u4e2a $T$\uff0c\u5176\u90fd\u6709 $\\frac nT$ \u4e2a\u4e0d\u540c\u7684\u52a0\u6cd5\u533a\u95f4\u3002\u56e0\u6b64\u590d\u6742\u5ea6 $\\sum\\limits_{T\\mid n}\\frac nT=\\sum\\limits_{T\\mid n}T$\uff0c\u5373 $n$ \u7684\u7ea6\u6570\u4e4b\u548c\u3002\n\n\u663e\u7136\u5176\u8fdc\u5c0f\u4e8e\u8c03\u548c\u7ea7\u6570\uff0c\u591a\u6b21\u6d4b\u8bd5\u540e\u53d1\u73b0\u5176\u4e0e $n$ \u540c\u9636\uff08$n=8648640$ \u65f6\u6700\u5927\uff0c\u7ea6\u4e3a $4\\times 10^7$\uff09\u3002\n\n\u6240\u4ee5\u9884\u5904\u7406 $g,f$ \u7684\u603b\u590d\u6742\u5ea6 $O(n)$ \u7ea7\u522b\u3002\n\n\u6b64\u5916\uff0c\u6211\u4eec\u8fd8\u5f97\u5230\u4e86\u4e00\u4e2a\u91cd\u91cf\u7ea7\u7ed3\u8bba\uff1a$f(xn+y)=xf(n)+f(y)$\u3002\n\n\u56e0\u6b64\uff0c\u7b2c\u4e8c\u95ee\u53ef\u4ee5\u76f4\u63a5\u89e3\u51b3\u3002\u9700\u8981\u9ad8\u7cbe\u5ea6\u5168\u5bb6\u6876\uff0c\u5176\u4e2d\u7531\u4e8e\u4e58\u9664\u53d6\u6a21\u5747\u5bf9\u4f4e\u7cbe\u8fdb\u884c\uff0c\u53ef\u4ee5 $O(len)$ \u5b8c\u6210\u3002\n\n\u8003\u8651\u7b2c\u4e00\u95ee\uff0c\u6211\u4eec\u7b49\u6548\u4e8e\u6c42\u6700\u5c0f\u7684 $x$\uff0c\u4f7f\u5f97 $f(x)=k$\u3002\n\n\u663e\u7136 $f$ \u4e0d\u4e25\u683c\u5355\u8c03\u7684\uff0c\u90a3\u4e48\u662f\u4e8c\u5206\u5417\uff1f\n\n\u867d\u7136\u770b\u8d77\u6765\u5f88\u50cf\uff0c\u4f46\u5e76\u4e0d\u662f\u3002\u6211\u4eec\u8ba1\u7b97\u4e00\u6b21 $f(m)$ \u590d\u6742\u5ea6\u4e3a $O(len)$\uff0c\u4e8c\u5206\u7684\u503c\u57df\u4e3a $[1,10^{10^5}]$\uff0c$\\log_210^{10^5}$ \u7ea6\u4e3a $3.4\\times 10^5$\uff0c\u8fd9\u4e24\u4e2a\u518d\u4e58\u8d77\u6765\uff0c$10^{10}$ \u663e\u7136\u65e0\u6cd5\u901a\u8fc7\u3002\n\n\u56de\u5934\u770b\u6211\u4eec\u7684\u7ed3\u8bba\u4f1a\u53d1\u73b0\uff0c\u56e0\u4e3a $f$ \u5355\u8c03\u4e0d\u51cf\uff0c\u6240\u4ee5\u4e00\u5b9a\u6709 $f(n)\\ge f(y)$\u3002\u90a3\u4e48\u6211\u4eec\u76f4\u63a5\u5c06 $k$ \u9664\u4ee5 $f(n)$\uff0c\u5f97\u5230\u5546\u5373\u4e3a\u7cfb\u6570\u540e\uff0c\u627e\u5230\u7b49\u4e8e\u4f59\u6570\u4e14\u6700\u5c0f\u7684\u4f4d\u7f6e\u5408\u5e76\uff0c\u662f\u4e0d\u662f\u5c31\u5bf9\u4e86\uff1f\n\n\u662f\uff0c\u4f46\u4e0d\u5b8c\u5168\u662f\u3002\u56e0\u4e3a\u8fd9\u6837\u7b97\u7b2c\u4e00\u4e2a\u6837\u4f8b\u4f1a\u8f93\u51fa $12$\u3002\n\n\u4e3a\u4ec0\u4e48\uff1f$f(12)=8$\uff0c\u90a3\u4e48\u4f59\u6570\u4e3a $0$\uff0c\u5546\u4e3a $1$\u3002\u4f46\u663e\u7136 $f(11)=8$\u3002\u6240\u4ee5\u6211\u4eec\u9700\u8981\u7279\u5224\u4f59\u6570\u4e3a $0$ \u65f6\uff0c\u5546\u81ea\u51cf\uff0c\u627e\u5230\u7b49\u4e8e $f(n)$ \u4e14\u6700\u5c0f\u7684\u4f4d\u7f6e\u4f5c\u4e3a\u8d21\u732e\u7edf\u8ba1\u8fdb\u7b54\u6848\u3002\n\n\u590d\u6742\u5ea6 $O(len+\\log n)$\u3002\u4e0d\u8fc7\u53cd\u6b63\u524d\u9762\u5df2\u7ecf\u6709\u4e2a $O(n)$ \u4e86\uff0c\u8fd9\u91cc\u76f4\u63a5\u66b4\u529b\u627e\u4e5f\u6ca1\u5565\u95ee\u9898\u3002\n\n\u603b\u590d\u6742\u5ea6 $O(n)$\u3002\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nbool isp[10000001];\nint p[1000001],u[10000001],tot,n,c;\nint ys[500],cnt,g[501],f[10000001];\nstruct gj{\n\tint a[100001],len;\n\t//\u9ad8\u7cbe\u5ea6\u5168\u5bb6\u6876\n\t//pushup \u7528\u6765\u5904\u7406\u8fdb\u4f4d\u9000\u4f4d\u3002\n\tvoid pushup(){\n\t\tint i;\n\t\tfor(i=1;i<=len;i++){\n\t\t\tif(a[i]<0)a[i+1]-=(-a[i]+9)/10,a[i]=(a[i]%10+10)%10;\n\t\t}\n\t\tfor(i=len;i;i--){\n\t\t\tlen=i;\n\t\t\tif(a[i])break;\n\t\t}\n\t\tfor(i=1;i<len;i++){\n\t\t\ta[i+1]+=a[i]/10,a[i]%=10;\n\t\t}\n\t\tfor(i=len;a[i]>=10;i++){\n\t\t\tlen=i+1;\n\t\t\ta[i+1]=a[i]/10;\n\t\t\ta[i]%=10;\n\t\t}\n\t}\n\tvoid operator/=(int y){\n\t\tint tmp=0,i;\n\t\tfor(i=len;i;i--){\n\t\t\ttmp=tmp*10+a[i];\n\t\t\ta[i]=tmp/y;\n\t\t\ttmp%=y;\n\t\t}\n\t\tpushup();\n\t}\n\tvoid operator*=(int y){\n\t\tint i;\n\t\tfor(i=1;i<=len;i++)a[i]*=y;\n\t\tpushup();\n\t}\n\tvoid operator-=(int y){\n\t\ta[1]-=y;\n\t\tpushup();\n\t}\n\tvoid operator+=(int y){\n\t\ta[1]+=y;\n\t\tpushup();\n\t}\n\tvoid print(int t){\n\t\tint i;\n\t\tfor(i=len;i;i--)printf(\"%d\",a[i]);\n\t\tif(t)putchar(t);\n\t}\n\tint cint(){\n\t\t//\u5c06\u9ad8\u7cbe\u5ea6\u6570\u8f6c\u5316\u4e3a\u4f4e\u7cbe\u5ea6\u6570\n\t\t//\u4ec5\u7528\u4e8e\u53d6\u6a21\u540e\u3002\n\t\tint i,res=0;\n\t\tfor(i=len;i;i--)res=res*10+a[i];\n\t\treturn res;\n\t}\n};\ngj x,y,z,res1,res2;\ngj operator-(gj x,gj y){\n\tint i;\n\tfor(i=1;i<=x.len;i++)x.a[i]-=y.a[i];\n\tx.pushup();\n\treturn x;\n}\nvoid s(){\n\t//\u7ebf\u6027\u7b5b+\u9884\u5904\u7406 f,g\n\tint i,j;\n\tu[1]=1;\n\tfor(i=2;i<=n;i++){\n\t\tif(!isp[i])p[++tot]=i,u[i]=-1;\n\t\tfor(j=1;j<=tot&&i*p[j]<=n;j++){\n\t\t\tisp[i*p[j]]=1;\n\t\t\tif(i%p[j]==0)break;\n\t\t\tu[i*p[j]]=u[i]*u[p[j]];\n\t\t}\n\t}\n\tfor(i=1;i*i<n;i++)if(n%i==0)ys[++cnt]=i,ys[++cnt]=n/i;\n\tif(i*i==n)ys[++cnt]=i;\n\tstd::sort(ys+1,ys+cnt+1);\n\tfor(i=1;i<=cnt;i++){\n\t\tif(ys[i]>c)break;\n\t\tfor(j=i;j<=cnt;j++){\n\t\t\tif(ys[j]%ys[i])continue;\n\t\t\tg[j]+=u[ys[j]/ys[i]];\n\t\t}\n\t}\n\tfor(i=1;i<=cnt;i++)for(j=ys[i];j<=n;j+=ys[i])f[j]+=g[i];\n\tfor(i=1;i<=n;i++)f[i]+=f[i-1];\n}\nchar t[1000001];\nint main(){\n\tint i,j,res=0;\n\tscanf(\"%d%d\",&n,&c);\n\ts();\n\tscanf(\"%s\",t+1);\n\tx.len=strlen(t+1);\n\tfor(i=1;i<=x.len;i++)x.a[i]=t[x.len-i+1]-'0';\n\ty=x;y/=f[n];\n\tres1=y;res1*=n;\n\ty*=f[n];y=x-y;\n\tint tt=y.cint();\n\t//\u4f59\u6570\n\tif(tt){\n\t\tfor(i=0;i<n;i++){\n\t\t\tif(tt==f[i]){\n\t\t\t\tres1+=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\telse{\n\t\tres1-=n;\n\t\t//\u524d\u9762\u5df2\u7ecf\u4e58\u8fc7\u4e86\uff0c\u6240\u4ee5\u76f4\u63a5 -n\n\t\tfor(i=n;i;i--){\n\t\t\tif(f[i]!=f[n]){\n\t\t\t\tres1+=i+1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tres1.print(10);\n\tres1=res2;y=res2;x=res2;\n\t//\u7b2c\u4e00\u95ee\uff0c\u7ed3\u675f\u3002\u6e05\u7a7a\u7528\u5230\u7684\u9ad8\u7cbe\u5ea6\u6570\u3002\n\tscanf(\"%s\",t+1);\n\ty.len=strlen(t+1);\n\tfor(i=1;i<=y.len;i++)y.a[i]=t[y.len-i+1]-'0';\n\ty-=1;\n\tx=y;x/=n;\n\tres1=x;res1*=f[n];\n\tx*=n;x=y-x;\n\ttt=x.cint();\n\tres1+=f[tt];\n\tx=res2;y=res2;\n\tscanf(\"%s\",t+1);\n\tfor(i=1;i<=y.len;i++)y.a[i]=0;\n\ty.len=strlen(t+1);\n\tfor(i=1;i<=y.len;i++)y.a[i]=t[y.len-i+1]-'0';\n\tx=y;x/=n;\n\tres2=x;res2*=f[n];\n\tx*=n;x=y-x;\n\ttt=x.cint();\n\tres2+=f[tt];\n\tres2=res2-res1;\n\tres2.print(0);\n}\n```",
        "postTime": 1657606581,
        "uid": 128606,
        "name": "2018ljw",
        "ccfLevel": 7,
        "title": "P6210 \u9898\u89e3"
    }
]
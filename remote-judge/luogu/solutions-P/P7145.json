[
    {
        "content": "\u8fd9\u9898\u9047\u5230\u4e8c\u8fdb\u5236\uff0c\u5f53\u7136\u60f3\u5230\u72b6\u538b dp\u3002\n\n\u679a\u4e3e\u524d\u9762 $2^k$ \u4f4d\u7684\u6570\uff0c\u7136\u540e\u5224\u65ad\u662f\u5426\u5408\u6cd5\uff0c\u5982\u679c\u5408\u6cd5\u5c31\u7ee7\u7eed\u72b6\u538b dp\uff0c\u72b6\u6001\u4e3a $f_{i,j}$\uff0c\u8868\u793a\u5230\u7b2c $i$ \u4e2a\u70b9\u540e\u8fb9 $k$ \u4e3a\u4e3a $j$ \u7684\u65b9\u6848\u6570\u3002\n\n\u590d\u6742\u5ea6\u5176\u5b9e\u4e0d\u9ad8\uff0c\u56e0\u4e3a\u5408\u6cd5\u72b6\u6001\u6700\u591a\u5c31\u51e0\u767e\u4e2a\uff0c$2^k$ \u53ea\u6709 $16$\uff0c\u4e00\u5171\u5e94\u8be5\u4e0d\u8fc7 $10^7$\u3002\n\n\u7136\u540e\u5c31\u8fc7\u4e86\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint f[16][505],r[16];\nint main()\n{\n\tint n,k,ans=0;\n\tcin>>n>>k;\n\tfor(int i=0;i<(1<<k);i++)\n\t{\n\t\tfor(int j=0;j<k;j++)r[i]|=((i>>j)&1)*(1<<(k-j-1));\n\t}\n\tfor(int i=0;i<(1<<(1<<k));i++)\n\t{\n\t\tint flag=1;\n\t\tfor(int j=0;j<=(1<<k)-k;j++)\n\t\t{\n\t\t\tint tt=(i>>j)&((1<<k)-1);\n\t\t\ttt=r[tt];\n\t\t\tif((i&(1<<tt)))continue;\n\t\t\tflag=0;\n\t\t\tbreak;\n\t\t}\n\t\tif(!flag)continue;\n\t\tmemset(f,0,sizeof(f));\n\t\tf[i>>((1<<k)-k)][(1<<k)-1]=1;\n\t\tfor(int j=1<<k;j<n;j++)for(int l=0;l<(1<<k);l++)\n\t\t{\n\t\t\tif((i&(1<<r[l]))==0)continue;\n\t\t\tint rrr=((l|(1<<k-1))^(1<<k-1))<<1;\n\t\t\tf[l][j]=(f[rrr|1][j-1]+f[rrr][j-1])%998244353;\n\t\t}\n\t\tint tr=0;\n\t\tfor(int j=0;j<(1<<k);j++)tr=(tr+f[j][n-1])%998244353;\n\t\tans=(ans+tr)%998244353;\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1608638302,
        "uid": 107484,
        "name": "wmy_goes_to_thu",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P7145 \u3010[THUPC2021 \u521d\u8d5b]\u5408\u6cd5\u5e8f\u5217\u3011"
    },
    {
        "content": "\n# $\\mathcal{Solution}$\n\n\u8003\u8651\u5230 $k$ \u6700\u5927\u53ea\u6709 $4$\uff0c\u6240\u4ee5\u6bcf\u4e00\u4e2a\u5b50\u6bb5\u9650\u5236\u7684\u4f4d\u7f6e\u80af\u5b9a\u662f $\\leq 2^k$ \u7684\uff0c\u4e5f\u5c31\u662f\u80af\u5b9a\u53ea\u4e0e\u524d $2^k$ \u4e2a\u6570\u76f8\u5173\uff0c\u8003\u8651\u7206\u641c\u8fd9\u4e9b\u6570\uff0c\u53ea\u6709 $2^{2^k}$ \u79cd\u53ef\u80fd\uff0c\u6700\u5927\u4e5f\u5c31 $2^{16}$\uff0c\u8003\u8651\u600e\u6837\u5feb\u901f\u7edf\u8ba1\u540e\u9762\u7684\u65b9\u6848\u6570\u3002\n\n\u8003\u8651 $dp$\uff0c\u8bbe $f_{i,j}$ \u4ee3\u8868 $[i-k+1,i]$ \u8fd9\u6bb5\u533a\u95f4\uff08\u4e5f\u5c31\u662f\u4ee5\u7b2c $i$ \u4e2a\u4e3a\u7ed3\u5c3e\u7684\u5b50\u6bb5\uff09\u9009\u7684\u72b6\u6001\u4e3a $j$ \u7684\u65b9\u6848\u6570\uff0c\u8fd9\u6837\u5c31\u5f88\u597d $dp$ \u4e86\uff0c\u8003\u8651 $f_{i,j}$ \u4ece $f_{i-1,j'}$ \u8f6c\u79fb\uff0c\u4e00\u5b9a\u65f6\u6ee1\u8db3 $j'$ \u7684\u540e $k-1$ \u4f4d\u548c $j$ \u7684 \u524d $k-1$ \u4f4d\u76f8\u7b49\uff08\u4e5f\u5c31\u662f\u8003\u8651\u628a\u4e00\u4e2a\u957f\u5ea6\u4e3a $k$ \u7684\u533a\u95f4\u5411\u540e\u63a8\u4e00\u4e2a\uff0c\u8fd9\u4e24\u4e2a\u533a\u95f4\u7684\u91cd\u5408\u90e8\u5206\uff09\uff0c$j'$ \u7684\u6700\u524d\u9762\u4e00\u4f4d\u6b64\u65f6\u586b $0,1$ \u90fd\u884c\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u76f4\u63a5\u8f6c\u79fb\uff0c\u800c\u6ee1\u8db3\u80fd\u8fdb\u884c\u8f6c\u79fb\u7684 $j$ \u4e00\u5b9a\u662f\u8981\u6ee1\u8db3\u7206\u641c\u51fa\u6765\u524d $2^k$ \u4e3a\u7b2c $j$ \u4f4d\u4e3a $1$\uff0c\u90a3\u4e48\u63d0\u524d\u5b58\u51fa\u6765\u8fd9\u4e9b\u5408\u6cd5\u7684 $j$\uff0c\u8f6c\u79fb\u76f4\u63a5\u904d\u5386\u4e00\u904d\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u964d\u7684\u7279\u522b\u4f4e\u3002\n\n\u5927\u6982\u662f\u4e00\u4e2a $\\sum_{i=1}^{2^{2^k}}count\\_bit(i) \\times n$\u3002\u5176\u4e2d $count\\_bit(x)$ \u4e3a $(x)_2$ \u4e2d\u6570\u4f4d\u4e0a\u4e3a $1$ \u7684\u4e2a\u6570\uff0c\u5199\u4e2a\u7a0b\u5e8f\u7b80\u5355\u7b97\u4e00\u4e0b\u53d1\u73b0\u624d\u4ec5\u4ec5 $1e8$ \u5de6\u53f3\uff0c\u8db3\u591f\u901a\u8fc7\u6b64\u9898\u3002\n\n\u4e0a\u9762\u90a3\u4e2a\u590d\u6742\u5ea6\u53ef\u4ee5\u5199\u6210 $\\mathcal{O}(2^{2^k}\\times 2^k \\times n)$\n\n# $\\mathcal{Code}$\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<vector>\n#define ll long long\n#define re register\n#define int long long\n#define pb push_back\nconst int mod = 998244353;\ninline int Add(int x, int y) { return (x + y - mod) < 0 ? (x + y) : (x + y - mod); }\ninline int Max(int x, int y) { return x > y ? x : y; }\ninline int Min(int x, int y) { return x < y ? x : y; }\ninline int Abs(int x) { return x < 0 ? ~x + 1 : x; }\ninline int read() {\n\tint r = 0; bool w = 0; char ch = getchar();\n\twhile(ch < '0' || ch > '9') {\n\t\tif(ch == '-') w = 1;\n\t\tch = getchar();\n\t}\n\twhile(ch >= '0' && ch <= '9') {\n\t\tr = (r << 3) + (r << 1) + (ch ^ 48);\n\t\tch = getchar();\n\t}\n\treturn w ? ~r + 1 : r;\n}\n#undef int\nconst int N = 510;\nint n, k, m, vecnt, a[N];\nll f[N][N];\nstd::vector<int>vec;\nbool check(int x) {\n\tint now = 0;\n\tfor(int i = x; i >= x - k + 1; --i)\n\t\tnow |= a[i] * (1 << (x - i));\n\treturn a[now] == 0;\n}\nll solve(int x) {\n\tvec.clear(); vecnt = 0;\n\tfor(int i = 0; i < m; ++i) a[i] = 0;\n\tfor(int i = 0; i < m; ++i)\n\t\tif((1 << i) & x) {\n\t\t\tvec.pb(m - i - 1);\n\t\t\ta[m - i - 1] = 1;\n\t\t\t++vecnt;\n\t\t}\n\tfor(int i = 0; i < n; ++i)\n\t\tfor(int j = 0; j < vecnt; ++j)\n\t\t\tf[i][j] = 0;\n\tfor(int i = k-1; i < m; ++i)\n\t\tif(check(i))\n\t\t\treturn 0ll;\n\tf[m-1][x & ((1 << k) - 1)] = 1;\n\tfor(int i = m; i < n; ++i)\n\t\tfor(int j = 0; j < vecnt; ++j)\n\t\t\tf[i][vec[j]] = Add(f[i][vec[j]], f[i-1][(vec[j] >> 1) | (1 << (k-1))] + f[i-1][vec[j] >> 1]);\n\tll ans = 0;\n\tfor(int i = 0; i < vecnt; ++i)\n\t\tans = Add(ans, f[n-1][vec[i]]);\n\tfor(int i = 0; i < n; ++i)\n\t\tfor(int j = 0; j < vecnt; ++j)\n\t\t\tf[i][vec[j]] = 0;\n\treturn ans;\n}\nint main() {\n\tll ans = 0;\n\tn = read(); k = read(); m = (1 << k);\n\tfor(int i = 0; i < 1 << m; ++i)\n\t\tans = Add(ans, solve(i));\n\tprintf(\"%lld\\n\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1613018420,
        "uid": 223298,
        "name": "do_while_true",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P7145 \u3010[THUPC2021 \u521d\u8d5b] \u5408\u6cd5\u5e8f\u5217\u3011"
    },
    {
        "content": "\u663e\u7136\u8fd9\u4e9bt\u4e00\u5b9a\u5728$[0, 2^k)$ \u4e2d\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u76f4\u63a5\u679a\u4e3e\u524d$2^k$\u4f4d\u3002\n\n\u7136\u540e\u76f8\u5f53\u4e8e\u8981\u6c42\u4e0d\u4ee5\u82e5\u5e7201\u4e32\u4e3a\u5b50\u4e32\u768401\u4e32\u6570\u91cf\uff0c\u5c06$[0,2^k-1]$\u4e2d\u4e3a0\u7684\u4f4d\u63d2\u5165AC\u81ea\u52a8\u673a\u8dd1dp\u5c31\u53ef\u4ee5\u4e86\u3002\u5f53\u7136\uff0c\u5bf9\u4e8e\u672c\u8eab\u4e0d\u5408\u6cd5\u7684\u524d\u7f00\uff0c\u53ef\u4ee5\u76f4\u63a5\u8df3\u8fc7\u3002\n\n\u590d\u6742\u5ea6\u770b\u8d77\u6765\u5f88\u5413\u4eba\uff0c\u4f46\u7531\u4e8e\u5408\u6cd5\u524d\u7f00\u4e0d\u591a\uff0c\u5b9e\u9645\u8fdc\u8fdc\u8dd1\u4e0d\u6ee1\u3002\uff08\u53ef\u4ee5\u81ea\u5df1\u5148\u6253\u4e2a\u8868\u770b\u6709\u51e0\u4e2a\u5408\u6cd5\u524d\u7f00\uff09\n\n```cpp\n#include <bits/stdc++.h>\n#define F(i, a, b) for (int i = a; i <= b; ++i)\n\nconst int MS = 505, mod = 998244353;\nint n, k, tot, ch[70][2], fail[20], ised[20], d[70][505];\nvoid insert(int x)\n{\n\tint u = 0;\n\tfor (int i = k - 1; i >= 0; --i) \n\t{\n\t\tif (!ch[u][x >> i & 1]) ch[u][x >> i & 1] = ++tot;\n\t\tu = ch[u][x >> i & 1];\n\t}\n\tised[u] = 1;\n}\nvoid getFail()\n{\n\tstd::queue<int> Q;\n\tif (ch[0][0]) fail[ch[0][0]] = 0, Q.push(ch[0][0]);\n\tif (ch[0][1]) fail[ch[0][1]] = 0, Q.push(ch[0][1]);\n\twhile (!Q.empty())\n\t{\n\t\tint u = Q.front();\n\t\tQ.pop();\n\t\tif (ch[u][0])\n\t\t{\n\t\t\tfail[ch[u][0]] = ch[fail[u]][0];\n\t\t\tised[ch[u][0]] |= ised[ch[fail[u]][0]];\n\t\t\tQ.push(ch[u][0]);\n\t\t} else ch[u][0] = ch[fail[u]][0];\n\t\tif (ch[u][1])\n\t\t{\n\t\t\tfail[ch[u][1]] = ch[fail[u]][1];\n\t\t\tised[ch[u][1]] |= ised[ch[fail[u]][1]];\n\t\t\tQ.push(ch[u][1]);\n\t\t} else ch[u][1] = ch[fail[u]][1];\n\t}\n}\n\nint main()\n{\n\tscanf(\"%d%d\", &n, &k);\n\tint cnt = 0;\n\tF(t, 0, (1 << (1 << k)) - 1)\n\t{\n\t\ttot = 0;\n\t\tmemset(ch, 0, sizeof(ch));\n\t\tmemset(ised, 0, sizeof(ised));\n\t\tmemset(fail, 0, sizeof(fail));\n\t\tF(i, 0, (1 << k) - 1) if (!(1 << i & t)) insert(i);\n\t\tgetFail();\n\t\tint u = 0, flag = 0;\n\t\tF(i, 0, (1 << k) - 1)\n\t\t{\n\t\t\tu = ch[u][t >> i & 1];\n\t\t\tif (ised[u]) { flag = 1; break; }\n\t\t}\n\t\tif (flag) continue;\n\t\tmemset(d, 0, sizeof(d));\n\t\td[u][0] = 1;\n\t\tF(i, 1, n - (1 << k))\n\t\t{\n\t\t\tF(cur, 0, tot)\n\t\t\t{\n\t\t\t\tif (!ised[ch[cur][0]]) d[ch[cur][0]][i] = (d[ch[cur][0]][i] + d[cur][i - 1]) % mod;\n\t\t\t\tif (!ised[ch[cur][1]]) d[ch[cur][1]][i] = (d[ch[cur][1]][i] + d[cur][i - 1]) % mod;\n\t\t\t}\n\t\t}\n\t\tF(cur, 0, tot) cnt = (cnt + d[cur][n - (1 << k)]) % mod;\n\t}\n\tprintf(\"%d\", cnt);\n\treturn 0;\n}\n```",
        "postTime": 1608644560,
        "uid": 161577,
        "name": "psoet",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P7145 \u3010[THUPC2021 \u521d\u8d5b]\u5408\u6cd5\u5e8f\u5217\u3011"
    }
]
[
    {
        "content": "### \u524d\u8a00\n\u524d\u51e0\u5929\uff0c\u8001\u5e08\u8ba9\u6211\u4eec\u505a\u9898\uff0c\u7ed3\u679c\uff0c\u505a\u8fd9\u9053\uff0c\u88c2\u5f00\u3002\n\n## \u6b63\u89e3\n\u8fd9\u9053\u9898\u662f\u9053\u533a\u95f4 `dp`\uff0c\u4f46\uff0c\u96be\u7684\u4e00\u6279\uff0c\u8f6c\u79fb\u65b9\u7a0b\u60f3\u5230\u4e86\u5c31\u5f88\u7b80\u5355\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u8bbe\u4e00\u4e2a\u6570\u7ec4 $dp_{l,r,L,R}$\uff0c\u8868\u793a\u4ece `l` \u5230 `r` \u7684\u533a\u95f4\uff0c\u503c\u57df\u4e3a `L~R` \u7684\u6700\u5927\u4ef7\u503c\u3002\n\n\u8f6c\u79fb\u65b9\u7a0b\uff1a\u6211\u4eec\u5148\u770b\u770b\u5b83\u4e0d\u8f6c\u6362\u5e8f\u5217\uff0c\u6700\u5927\u4ef7\u503c\uff0c\u5219\u4e3a\n```cpp\ndp[l][r][L][R]=max(dp[l][r][L+1][R],dp[l][r][L][R-1]);//\u628a\u5c0f\u503c\u57df\u7684\u4ef7\u503c\u8f6c\u6362\u5230\u5927\u503c\u57df\ndp[l][r][L][R]=max(dp[l][r][L][R],dp[l+1][r][L][R]+(a[l]==L));//\u5411\u5de6\u6269\u5c55\ndp[l][r][L][R]=max(dp[l][r][L][R],dp[l][r-1][L][R]+(a[r]==R));//\u5411\u53f3\u6269\u5c55\n\n```\n\u63a5\u4e0b\u6765\u8003\u8651\u5e8f\u5217\u8f6c\u79fb\u540e\uff0c\u8f6c\u79fb\u65b9\u7a0b\u600e\u4e48\u5f04\uff0c\u65e2\u7136\u8981\u8f6c\u6362\uff0c\u4e5f\u8981\u662f\u6700\u957f\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\uff0c\u5219\u8981\u5224\u65ad\uff0c\u8f6c\u6362\u540e\uff0c\u662f\u5426\u662f\u6700\u957f\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\uff0c\u5219\u4e3a\n```cpp\ndp[l][r][L][R]=max(dp[l][r][L][R],dp[l+1][r-1][L][R]+(a[l]==R)+(a[r]==L));//\u5e8f\u5217\u7ffb\u8f6c\u540e\uff0c\u6700\u5927\u4ef7\u503c \n```\n\n\u8fd9\u6837\u7684\u8bdd\uff0c\u518d\u521d\u59cb\u5316\uff0c\u5c31\u884c\u4e86\uff01\uff01\uff01\uff01\n\n### AC\u4ee3\u7801\n\n```cpp\n#include <algorithm>\n#include <cstdio>\nusing namespace std;\nint n, a[51], dp[51][51][51][51];\nint main()\n{\n    scanf(\"%d\",&n);\n    for (int i=1;i<=n;i++)\n    {\n        scanf(\"%d\",&a[i]);\n        for (int L=1;L<=a[i];L++)\n            for (int R=a[i];R<=50;R++)\n                dp[i][i][L][R]=1;//\u521d\u59cb\u5316 \n    }\n    for (int len=2;len<=n;len++)//\u679a\u4e3e\u533a\u95f4\u957f\u5ea6 \n    {\n    \tfor (int l=1,r=len;r<=n;l++,r++)//\u679a\u4e3e\u8d77\u70b9\u548c\u7ec8\u70b9 \n    \t{\n    \t\tfor (int llen=1;llen<=50;llen++)//\u679a\u4e3e\u503c\u57df \n    \t\t{\n    \t\t\tfor (int L=1,R=llen;R<=50;L++,R++)//\u679a\u4e3e\u503c\u57df\u8d77\u70b9\u548c\u91cd\u70b9 \n                {\n                    dp[l][r][L][R]=max(dp[l][r][L+1][R],dp[l][r][L][R-1]);//\u628a\u5c0f\u503c\u57df\u7684\u4ef7\u503c\u8f6c\u6362\u5230\u5927\u503c\u57df\n                    dp[l][r][L][R]=max(dp[l][r][L][R],dp[l+1][r][L][R]+(a[l]==L));//\u5411\u5de6\u6269\u5c55\n                    dp[l][r][L][R]=max(dp[l][r][L][R],dp[l][r-1][L][R]+(a[r]==R));//\u5411\u53f3\u6269\u5c55\n                    dp[l][r][L][R]=max(dp[l][r][L][R],dp[l+1][r-1][L][R]+(a[l]==R)+(a[r]==L));//\u5e8f\u5217\u7ffb\u8f6c\u540e\uff0c\u6700\u5927\u4ef7\u503c \n                }\n\t\t\t}\n\t\t}\n\t}\n    printf(\"%d\",dp[1][n][1][50]);\n    return 0;\n}\n```",
        "postTime": 1636609971,
        "uid": 513253,
        "name": "\u82cf22",
        "ccfLevel": 0,
        "title": "\u9898\u89e3\u4e4bP3607"
    },
    {
        "content": "\u611f\u89c9\u8fd9\u9898\u5173\u952e\u5c31\u662f\u6ce8\u610f\u5230\u4e00\u4e2a\u5b50\u5e8f\u5217\u7684\u53cd\u8f6c\u7b49\u4ef7\u4e8e\u591a\u6b21\u4ea4\u6362\u4e86\u4e24\u8fb9\n\n\u4e4b\u540e\u7528dp[l][r][down][up]\u8868\u793a[l,r]\u503c\u57df\u5728[down,up]\u7684\u6700\u957f\u4e0d\u964d\n\n\u53ea\u7528\u8003\u8651\u4ea4\u6362\u4e0d\u4ea4\u6362\u5373\u53ef\n\n\n\n\n\n    \n    \n```cpp\n//=max:\n//dp[l][r][down+1][up] / [down][up-1]\n//dp[l+1][r][down][up]+(down==a[l]) / [l][r-1]+(up==a[r])\n//dp[l+1][r-1][down][up]+(down==a[r])+(up==a[l])\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=52;\nint a[N],f[N][N][N][N];\nvoid chmax(int &x,int y)\n{\n    if(x<y)x=y;\n}\nint main()\n{\n    int n,i,l,r,down,up;\n    scanf(\"%d\",&n);\n    for(i=1;i<=n;++i)\n    {scanf(\"%d\",a+i);\n     for(down=1;down<=a[i];++down)\n     for(up=a[i];up<=50;++up)\n      f[i][i][down][up]=1;\n    }\n    for(int l1=2;l1<=n;++l1)\n    for(l=1,r=l1;r<=n;++l,++r)\n    for(int l2=1;l2<=50;++l2)\n    for(down=1,up=l2;up<=50;++down,++up)\n    {\n        int ans=max(f[l][r][down+1][up],f[l][r][down][up-1]);\n        chmax(ans,f[l+1][r][down][up]+(down==a[l]));\n        chmax(ans,f[l][r-1][down][up]+(up==a[r]));\n        chmax(ans,f[l+1][r-1][down][up]+(down==a[r])+(up==a[l]));\n        f[l][r][down][up]=ans; \n    } \n    printf(\"%d\\n\",f[1][n][1][50]);\n}\n```",
        "postTime": 1496049556,
        "uid": 9168,
        "name": "kczno1",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3607 \u3010[USACO17JAN]Subsequence Reversal\u5e8f\u5217\u53cd\u8f6c\u3011"
    },
    {
        "content": "\u770b\u5230 LIS \u81ea\u7136\u60f3\u5230 dp\uff0c\u4f46\u662f\u8fd9\u91cc\u6309\u7167\u666e\u901a\u65b9\u6cd5 dp \u770b\u7684\u975e\u5e38\u96be\uff0c\u7531\u4e8e\u4e0d\u80fd\u9884\u6d4b\u67d0\u4e2a\u53cd\u8f6c\u5bf9\u4f1a\u53cd\u8f6c\u5230\u54ea\u91cc\u3002\u4f46\u662f\uff0c\u5982\u679c\u6211\u4eec\u628a\u8fd9\u4e9b\u53cd\u8f6c\u4ea4\u6362\u5bf9\u5339\u914d\u4e00\u4e0b\uff0c\u4f1a\u53d1\u73b0\uff1a\n\n```\n1 6 2 3 4 3 5 3 4\n  ^         ^ ^ ^\n  |         +-+ |\n  +-------------+\n```\n\n\u8fd9\u4e2a\uff086\uff0c4\uff09\u5bf9\u56fa\u5b9a\u4e3a\u4e00\u4e2a\u53cd\u8f6c\u5bf9\u4e4b\u540e\uff0c\u540e\u9762\u53cd\u8f6c\u5bf9\u5fc5\u987b\u5728\uff086\uff0c4\uff09\u4e4b\u5185\uff0c\u628a\u95ee\u9898\u7f29\u5c0f\u3002\u4e8e\u662f\u5c1d\u8bd5\u505a\u533a\u95f4 dp\u3002\n\n\u6765\u5feb\u901f\u5224\u65ad\u67d0\u4e2a\u503c\u80fd\u5426\u5bf9\u67d0\u4e2a\u533a\u95f4\u8d21\u732e\uff0c\u9700\u8981\u4fdd\u5b58\u8fd9\u4e2a\u533a\u95f4\u6240\u6709\u503c\u57df\u533a\u95f4\u7684\u7b54\u6848\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5bf9\u6bcf\u4e00\u4e2a\u503c\u57df\u533a\u95f4\u548c\u4f4d\u7f6e\u533a\u95f4\uff0c\u9700\u8981\u8ba1\u7b97\u8fd9\u4e2a\u4f4d\u7f6e\u533a\u95f4\u5185\u53ea\u5305\u542b\u503c\u57df\u533a\u95f4\u7684\u5143\u7d20\u7684 LIS\u3002\n\n$(l,r,L,R)$ \u7684 dp \u600e\u4e48\u8f6c\u79fb\uff1f\n\n 1. \u80af\u5b9a\u8981\u5305\u542b\u5b50\u503c\u57df\u533a\u95f4\uff0c\u4ece $(l,r,L,R-1)$ \u548c $(l,r,L+1,R)$ \u8f6c\u79fb\n 2. \u5982\u679c\u60f3\u9009\u4e0a $l$\uff0c\u9700\u8981 $a_l=L$\uff0c\u5982\u679c $a_l=L$ \u5219\u53ef\u4ee5\u4ece $(l+1,r,L,R)+1$ \u8f6c\u79fb\u3002\u7c7b\u4f3c\u5982\u679c $a_r=R$\uff0c\u5219\u53ef\u4ee5\u4ece $(l,r-1,L,R)+1$ \u8f6c\u79fb\n \t- \u5982\u679c $a_l \\neq L$ \u4f46\u662f\u8fd8\u53ef\u4ee5\u88ab\u9009\u4e0a\uff0c\u5728\u8fd9\u91cc\u4e0d\u9700\u8981\u8003\u8651\uff0c\u6700\u7ec8\u4f1a\u88ab\u8f6c\u79fb 1 \u7b97\n 3. \u5f3a\u884c\u628a $(l,r)$ \u5f53\u505a\u4e00\u4e2a\u53cd\u8f6c\u5bf9\uff0c\u90a3\u4e48\u533a\u95f4\u7f29\u5c0f\u5230 $(l+1,r-1)$\uff0c\u7136\u540e $a_l$ \u548c $a_r$ \u4e5f\u5c3d\u91cf\u5c1d\u8bd5\u8d21\u732e\uff1a\u4ece $(l+1,r-1,L,R)+[a_l=R]+[a_r=L]$ \u8f6c\u79fb\n\n\u7531\u4e8e\u8f6c\u79fb\u987a\u5e8f\u6bd4\u8f83\u96be\u641e\uff0c\u7528\u8bb0\u4e00\u5316\u641c\u7d22\u5373\u53ef\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n\nint dp[51][51][51][51];\nint a[51];\nint dfs(int l, int r, int lb, int ub) {\n\tif(l > r) return 0;\n\tif(lb > ub) return 0;\n\tif(l == r && lb <= a[l] && a[l] <= ub) return 1;\n\tif(dp[l][r][lb][ub] != -1) return dp[l][r][lb][ub];\n\tint ans = max(dfs(l+1, r, lb, ub), dfs(l, r-1, lb, ub));\n\tans = max(ans, dfs(l, r, lb, ub-1));\n\tans = max(ans, dfs(l, r, lb+1, ub));\n\tif(a[l] == lb) ans = max(ans, dfs(l+1, r, lb, ub) + 1);\n\tif(a[r] == ub) ans = max(ans, dfs(l, r-1, lb, ub) + 1);\n\tans = max(ans, dfs(l+1, r-1, lb, ub) + (a[l] == ub) + (a[r] == lb));\n\treturn dp[l][r][lb][ub] = ans;\n}\nsigned main() {\n    ios_base::sync_with_stdio(false); cin.tie(0);\n    memset(dp, -1, sizeof dp);\n\tint n; cin >> n;\n\trep1(i, n) cin >> a[i];\n\tcout << dfs(1, n, 1, 50) << endl;\n}\n```",
        "postTime": 1608302496,
        "uid": 220037,
        "name": "w33z8kqrqk8zzzx33",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3607 \u3010[USACO17JAN]Subsequence Reversal P\u3011"
    },
    {
        "content": "## \u524d\u8a00\n\n\u5e0c\u671b\u5ba1\u6838\u80fd\u7ed9\u6211\u8fc7\u4e86\u8fd9\u7bc7\u9898\u89e3 \u3002\n\n## \u9898\u76ee\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3607)\n\n## \u6b63\u6587\n\n\u5f88\u5de7\u5999\u7684\u601d\u7ef4\u9898\u554a \uff0c \u4e00\u5f00\u59cb\u4e1d\u6beb\u6ca1\u6709\u601d\u8def \uff0c \u779f\u4e86\u4e00\u773c\u9898\u89e3 \uff0c \u770b\u5230\u4e00\u53e5\u8bdd \uff1a \u4ea4\u6362\u4e00\u4e2a\u5e8f\u5217\u76f8\u5f53\u4e8e\u4e0d\u76f8\u4ea4\u7684\u4ea4\u6362\u51e0\u4e2a\u5143\u7d20 \uff0c \u56e0\u4e3a\u8fd9\u51e0\u4e2a\u5143\u7d20\u4ea4\u6362\u4e4b\u540e\u5c31\u76f8\u5f53\u4e8e\u662f\u4ea4\u6362\u4e86\u4e00\u4e2a\u5b50\u5e8f\u5217 \u3002\n\n\u6709\u4e86\u8fd9\u53e5\u8bdd\u7684\u63d0\u793a \uff0c \u95ee\u9898\u5c31\u8fce\u5203\u800c\u89e3\u4e86 \uff0c \u5173\u952e\u8981\u505a\u5230\u4ea4\u6362\u7684\u5143\u7d20\u4e0d\u80fd\u76f8\u4ea4 \uff0c \u5176\u5b9e\u53ea\u9700\u8981 DP \u7684\u987a\u5e8f\u6ca1\u95ee\u9898\u5373\u53ef \uff0c \u90a3\u4e48\u663e\u7136\u5047\u8bbe  [L,R] \u5df2\u7ecf\u89e3\u51b3\u4e86 \uff0c \u90a3\u4e48\u4ea4\u6362\u7684\u5143\u7d20\u5c31\u5f3a\u5236\u53ea\u80fd\u5728 [L,R] \u4e4b\u5916 \u3002\n\u4e0b\u9762\u6b63\u5f0f\u5f00\u59cb DP \uff0c \u5b9a\u4e49  $dp_{l,r,i,j}$  \u8868\u793a\u533a\u95f4 [l,r] \u95f4 \uff0c  \u503c\u57df\u5728 [i,j] \u95f4\u7684\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684\u957f\u5ea6 \uff0c \u90a3\u4e48\u5c31\u8f6c\u79fb\u5c31\u662f\u4ea4\u6362\u548c\u4e0d\u4ea4\u6362\u7684\u533a\u522b \u3002\n\n\u4e0d\u4ea4\u6362\u7684\u8f6c\u79fb :\n\n$dp_{l,r,i,j}=\\max(dp_{l+1,r,i,j}+(a_{l}==i),dp_{l,r-1,i,j}+(a_{r} == j))$\n\n\u4ea4\u6362\u7684\u8f6c\u79fb :\n\n$dp_{l,r,i,j}=\\max(dp_{l,r,i,j},dp_{l+1,r-1,i,j}+(a_{l}==j)+(a_{r} == i))$\n\n\u6ce8\u610f\u503c\u57df\u662f\u53ef\u4ee5\u5411\u4e24\u8fb9\u6269\u5c55\u7684 \u3002\n## AC code :\n\n```cpp\n#include <bits/stdc++.h>\n#define LL long long\nusing namespace std;\nint read() {\n\tint s = 0, f = 1;\n\tchar a = getchar();\n\twhile(a < '0' || a > '9') {\n\t\tif(a == '-') f = -1;\n\t\ta = getchar();\n\t}\n\twhile(a <= '9' && a >= '0') s = s * 10 + a - '0', a = getchar();\n\treturn s * f;\n}\nLL dp[55][55][55][55],n,m,a[55],p;\nint main() {\n\tn=read();\n\tfor(int i=1; i<=n; i++) {\n\t\ta[i]=read();\n\t}\n\tfor(int i=1;i<=n;i++) {\n\t\tfor(int j=1;j<=a[i];j++) {\n\t\t\tfor(int k=a[i];k<=50;k++) {\n\t\t\t\tdp[i][i][j][k]=1;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int len=2;len<=n;len++) {\n\t\tfor(int l=1;l<=n;l++) {\n\t\t\tint r=l+len-1; if(r>n) break;\n\t\t\tfor(int i=1;i<=50;i++) {\n\t\t\t\tfor(int j=i;j<=50;j++) {\n\t\t\t\t\tdp[l][r][i][j]=max(dp[l][r][i][j],max(dp[l+1][r][i][j]+(a[l]==i),dp[l][r-1][i][j]+(a[r]==j)));\n\t\t\t\t\tdp[l][r][i][j]=max(dp[l][r][i][j],dp[l+1][r-1][i][j]+(a[r]==i)+(a[l]==j));\n\t\t\t\t\tdp[l][r][i][j+1]=max(dp[l][r][i][j+1],dp[l][r][i][j]);\n\t\t\t\t\tdp[l][r][i-1][j]=max(dp[l][r][i-1][j],dp[l][r][i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i=1;i<=50;i++) {\n\t\t\t\tfor(int j=i;j>=1;j--) {\n\t\t\t\t\tdp[l][r][j-1][i]=max(dp[l][r][j-1][i],dp[l][r][j][i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%lld\",dp[1][n][1][50]);\n}\n```\n### \u6700\u540e\u5e0c\u671b\u8fd9\u7bc7\u9898\u89e3\u80fd\u5e2e\u5230\u5c4f\u5e55\u524d\u7684\u4f60 \uff0c \u4f46\u662f\u4e0d\u8981\u6284\u88ad\u54e6 \uff01",
        "postTime": 1638335963,
        "uid": 501855,
        "name": "\u6253\u7a0b\u5e8f\u7684\u54b8\u9c7c",
        "ccfLevel": 0,
        "title": "\u3010[USACO17JAN]Subsequence Reversal P\u3011\u9898\u89e3"
    },
    {
        "content": "# \u9898\u76ee\u5927\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217 $\\{a_i\\}$\uff0c\u53ef\u4ee5\u9009\u62e9\u4e00\u4e2a\u5b50\u5e8f\u5217\u5c06\u5176\u53cd\u8f6c\uff0c\u6c42\u80fd\u83b7\u5f97\u7684\u6700\u5927\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\u3002\n\n$1\\le n,a_i\\le 50$\u3002\n\n# \u9898\u76ee\u5206\u6790\n\n\u6ce8\u610f\u5230\u6211\u4eec\u7ffb\u8f6c\u4e00\u4e2a\u5b50\u5e8f\u5217\uff0c\u76f8\u5f53\u4e8e\u4ea4\u6362\u4e00\u4e9b\u6570\u7684\u987a\u5e8f\uff0c\u5e76\u4e14\u8fd9\u4e9b\u4ea4\u6362\u7684\u6570\u662f **\u4e92\u76f8\u5d4c\u5957\u7684**\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\u4ed6\u4eec\u6784\u6210\u7684\u533a\u95f4\u7684\u4ea4\u70b9\u4e0d\u4f1a\u5728\u9876\u70b9\u5904\u3002\u6bd4\u5982\u8fd9\u6837\uff1a\n\n```plain\n----------------\n -----------\n  --------\n     ---\n      -\n```\n\n\u800c\u4e0d\u4f1a\u51fa\u73b0\uff1a\n\n```plain\n-------------\n ----------\n   -------------\n  --\n```\n\n\u7136\u540e\u5f88\u663e\u7136\uff0c\u8fd9\u5c31\u662f\u4e00\u4e2a\u533a\u95f4 $\\verb!dp!$\u3002\n\n\u4ee4 $dp[l,r,i,j]$ \u8868\u793a\u533a\u95f4 $[l,r]$ \u7684\u503c\u57df\u5728 $[i,j]$ \u95f4\u7684\u6700\u957f\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\u7684\u6700\u5927\u957f\u5ea6\u3002\n\n\u7136\u540e\u679a\u4e3e\u533a\u95f4\u957f\u5ea6\u548c\u5de6\u7aef\u70b9\uff0c\u5982\u679c\u4e0d\u4ea4\u6362\u5219\u6709\uff1a\n\n$$dp[l,r,i,j]=\\max\\{dp[l+1,r,i,j]+[a_l=i],dp[l,r-1,i,j]+[a_r=j]\\}$$\n\n\u82e5\u4ea4\u6362\uff1a\n\n$$d[l,r,i,j]=\\max\\{dp[l+1,r-1,i,j]+[a_l=j]+[a_r=i]\\}$$\n\n\u7136\u540e\u8f6c\u79fb\u7684\u65f6\u5019\u6ce8\u610f\u4e00\u4e0b\u8fb9\u754c\u6761\u4ef6\u3002\n\n# \u4ee3\u7801\n\n```cpp\n// Problem: P3607 [USACO17JAN]Subsequence Reversal P\n// Contest: Luogu\n// URL: https://www.luogu.com.cn/problem/P3607\n// Memory Limit: 125 MB\n// Time Limit: 1000 ms\n// Date:2022-06-26 17:09\n//\n// Powered by CP Editor (https://cpeditor.org)\n\n#include <iostream>\n#include <cstdio>\n#include <climits>//need \"INT_MAX\",\"INT_MIN\"\n#include <cstring>//need \"memset\"\n#include <numeric>\n#include <algorithm>\n#include <cmath>\n#define int long long\n#define enter putchar(10)\n#define debug(c,que) std::cerr << #c << \" = \" << c << que\n#define cek(c) puts(c)\n#define blow(arr,st,ed,w) for(register int i = (st);i <= (ed); ++ i) std::cout << arr[i] << w;\n#define speed_up() std::ios::sync_with_stdio(false),std::cin.tie(0),std::cout.tie(0)\n#define mst(a,k) memset(a,k,sizeof(a))\n#define stop return(0)\nconst int mod = 1e9 + 7;\ninline int MOD(int x) {\n\tif (x < 0) x += mod;\n\treturn x % mod;\n}\nnamespace Newstd {\n\tchar buf[1 << 21], *p1 = buf, *p2 = buf;\n\tinline int getc() {\n\t\treturn p1 == p2 && (p2 = (p1 = buf) + fread(buf, 1, 1 << 21, stdin), p1 == p2) ? EOF : *p1 ++;\n\t}\n#ifndef ONLINE_JUDGE\n#define getc getchar\n#endif\n\tinline int read() {\n\t\tint ret = 0, f = 0;\n\t\tchar ch = getc();\n\t\twhile (!isdigit(ch)) {\n\t\t\tif (ch == '-') f = 1;\n\t\t\tch = getc();\n\t\t}\n\t\twhile (isdigit(ch)) {\n\t\t\tret = (ret << 3) + (ret << 1) + ch - 48;\n\t\t\tch = getc();\n\t\t}\n\t\treturn f ? -ret : ret;\n\t}\n\tinline double double_read() {\n\t\tlong long ret = 0, w = 1, aft = 0, dot = 0, num = 0;\n\t\tchar ch = getc();\n\t\twhile (!isdigit(ch)) {\n\t\t\tif (ch == '-') w = -1;\n\t\t\tch = getc();\n\t\t}\n\t\twhile (isdigit(ch) || ch == '.') {\n\t\t\tif (ch == '.') {\n\t\t\t\tdot = 1;\n\t\t\t} else if (dot == 0) {\n\t\t\t\tret = (ret << 3) + (ret << 1) + ch - 48;\n\t\t\t} else {\n\t\t\t\taft = (aft << 3) + (aft << 1) + ch - '0';\n\t\t\t\tnum ++;\n\t\t\t}\n\t\t\tch = getc();\n\t\t}\n\t\treturn (pow(0.1, num) * aft + ret) * w;\n\t}\n\tinline void write(int x) {\n\t\tif (x < 0) {\n\t\t\tputchar('-');\n\t\t\tx = -x;\n\t\t}\n\t\tif (x > 9) write(x / 10);\n\t\tputchar(x % 10 + '0');\n\t}\n}\nusing namespace Newstd;\n\nconst int N = 55;\nint a[N], dp[N][N][N][N];\n//dp[r][l][i][j]:\u533a\u95f4 [l,r] \u7684\u503c\u57df\u5728 [i,j] \u95f4\u7684\u6700\u957f\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\u7684\u6700\u5927\u957f\u5ea6\nint n;\nint32_t main(void) {\n\tn = read();\n\tfor (register int i = 1; i <= n; ++ i) a[i] = read();\n\tfor (register int i = 1; i <= n; ++ i) {\n\t\tfor (register int j = 1; j <= a[i]; ++ j) {\n\t\t\tfor (register int k = a[i]; k <= 50; ++ k) {\n\t\t\t\tdp[i][i][j][k] = 1;\n\t\t\t}\n\t\t}\n\t}\n\tfor (register int len = 2; len <= n; ++ len) {\n\t\tfor (register int l = 1; l + len - 1 <= n; ++ l) {\n\t\t\tint r = l + len - 1;\n\t\t\tfor (register int i = 1; i <= 50; ++ i) {\n\t\t\t\tfor (register int j = i; j <= 50; ++ j) {\n\t\t\t\t\tdp[l][r][i][j] = std::max(dp[l][r][i][j], std::max(dp[l + 1][r][i][j] + (a[l] == i), dp[l][r - 1][i][j] + (a[r] == j)));\n\t\t\t\t\tdp[l][r][i][j] = std::max(dp[l][r][i][j], dp[l + 1][r - 1][i][j] + (a[r] == i) + (a[l] == j));\n\t\t\t\t\tdp[l][r][i][j + 1] = std::max(dp[l][r][i][j + 1], dp[l][r][i][j]);\n\t\t\t\t\tdp[l][r][i - 1][j] = std::max(dp[l][r][i - 1][j], dp[l][r][i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (register int i = 1; i <= 50; ++ i) {\n\t\t\t\tfor (register int j = i;j >= 1; -- j) {\n\t\t\t\t\tdp[l][r][j - 1][i] = std::max(dp[l][r][j - 1][i], dp[l][r][j][i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%lld\\n\", dp[1][n][1][50]);\n\n\treturn 0;\n}\n```",
        "postTime": 1656251757,
        "uid": 430409,
        "name": "Coros_Trusds",
        "ccfLevel": 6,
        "title": "P3607 [USACO17JAN]Subsequence Reversal P"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u7bc7\u771f\u5b9e\u7684\u89e3\u9898\u62a5\u544a\u3002\n\n### \u601d\u8def\n\nPart 1\uff1a\u6211\u662f\u600e\u4e48\u60f3\u5230\u8fd9\u662f\u4e00\u9053\u533a\u95f4 dp \u7684\uff1f\n\n\u9996\u5148\u8fd9\u9053\u9898\u7b26\u5408 dp \u7684\u7279\u70b9\uff0c\u800c\u4e14\u8fd9\u9053\u9898\u53ef\u4ee5\u662f\u4ece\u5c0f\u533a\u95f4\u63a8\u5411\u5927\u533a\u95f4\uff0c\u5927\u81f4\u53ef\u4ee5\u786e\u5b9a\u662f\u533a\u95f4 dp \u4e86\uff1b\n\n\u7136\u540e\u770b\u770b\u6570\u636e\u8303\u56f4\uff0c\u533a\u95f4 dp \u5e94\u8be5\u5dee\u4e0d\u591a\u3002\n\nPart 2\uff1a\u6211\u662f\u600e\u4e48\u60f3\u5230\u8fd9\u4e2a\u72b6\u6001\u7684\uff1f\n\n\u65e2\u7136\u662f\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\uff0c\u90a3\u6211\u4eec\u8003\u8651\u4ece\u5c0f\u533a\u95f4\u5230\u5927\u533a\u95f4\uff0c\u662f\u5426\u53ef\u4ee5\u8ba9\u5b50\u5e8f\u5217\u66f4\u957f\u53d6\u51b3\u4e8e\u548c\u539f\u6765\u7684\u5c0f\u5e8f\u5217\u4e2d\u7684\u6781\u503c\u7684\u5927\u5c0f\u5173\u7cfb\u3002\n\n\u4e8e\u662f\u6211\u4eec\u7d22\u6027\u5f00\u4e00\u4e2a\u56db\u7ef4\u7684\u6570\u7ec4 $dp_{i,j,L,R}$\uff0c\u8868\u793a\u533a\u95f4\u662f\u4ece $i$ \u5230 $j$\uff0c\u800c\u503c\u57df\u662f\u4ece $L$ \u5230 $R$ \u7684\u6700\u957f\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\u957f\u5ea6\u3002\n\nPart 3\uff1a\u600e\u4e48\u7b97\u4e0d\u7528\u53cd\u8f6c\u7684\u60c5\u51b5\uff1f\n\n\u8fd9\u9053\u9898\u7684\u96be\u70b9\u5c31\u5728\u53ef\u4ee5\u53cd\u8f6c\u4e00\u6b21\u3002\n\n\u90a3\u5982\u679c\u6211\u628a\u5b83\u5f53\u4f5c\u4e0d\u80fd\u53cd\u8f6c\u5462\uff1f\n\n\u90a3\u4e48\u53ea\u9700\u8981\u8003\u8651\u4e09\u79cd\u60c5\u51b5\uff1a\u4ece\u4e24\u7aef\u7684\u503c\u57df\u8f6c\u79fb\uff0c\u533a\u95f4\u5f80\u5de6\u6269\u5c55\uff0c\u533a\u95f4\u5f80\u53f3\u6269\u5c55\u3002\n\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5c31\u662f\uff1a\n\n```cpp\ndp[i][j][L][R]=max(dp[i][j][L+1][R],dp[i][j][L][R-1]);//\u4ece\u4e24\u7aef\u7684\u503c\u57df\u8f6c\u79fb\ndp[i][j][L][R]=max(dp[i][j][L][R],dp[i+1][j][L][R]+(a[i]==L));//\u533a\u95f4\u5f80\u5de6\u6269\u5c55\ndp[i][j][L][R]=max(dp[i][j][L][R],dp[i][j-1][L][R]+(a[j]==R));//\u533a\u95f4\u5f80\u53f3\u6269\u5c55\n```  \n\nPart 4\uff1a\u90a3\u662f\u600e\u4e48\u89e3\u51b3\u53cd\u8f6c\u95ee\u9898\u7684\u5462\uff1f\n\n\u53cd\u8f6c\uff0c\u65e0\u975e\u5c31\u662f\u591a\u6b21\u4ea4\u6362\u4e24\u8fb9\u6570\u7684\u4f4d\u7f6e\u3002\n\n\u4e8e\u662f\u518d\u52a0\u4e00\u4e2a\u65b9\u7a0b\u5c31\u53ef\u4ee5\u4e86\uff1a\n\n```cpp\ndp[i][j][L][R]=max(dp[i][j][L][R],dp[i+1][j-1][L][R]+(a[i]==R)+(a[j]==L));\n```\n\nPart 5\uff1a\u8fb9\u754c\u6761\u4ef6\uff1f\n\n\u8fd9\u4e2a\u9898\u4e3b\u8981\u662f\u8981\u8003\u8651\u521d\u59cb\u503c\u3002\u6309\u7167\u72b6\u6001\u7684\u5b9a\u4e49\u6765\u5199\u5373\u53ef\uff1a\n\n```cpp\nfor(ri l=1;l<=a[i];l++){\n\tfor(ri r=a[i];r<=50;r++){\n\t\tdp[i][i][l][r]=1;\n\t}\n}\n```\n\n### \u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n#define ll long long\n#define ri register int\nusing namespace std;\nconst int MAXN=60;\nint n,a[MAXN],dp[MAXN][MAXN][MAXN][MAXN];\n\nint main() {\n\tscanf(\"%d\",&n);\n\tfor(ri i=1;i<=n;i++){\n\t\tscanf(\"%d\",&a[i]);\n\t\tfor(ri l=1;l<=a[i];l++){\n\t\t\tfor(ri r=a[i];r<=50;r++){\n\t\t\t\tdp[i][i][l][r]=1;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfor(ri len=2;len<=n;len++){\n\t\tfor(ri i=1;i+len-1<=n;i++){\n\t\t\tint j=i+len-1;\n\t\t\tfor(ri Len=2;Len<=50;Len++){\n\t\t\t\tfor(ri L=1;L+Len-1<=50;L++){\n\t\t\t\t\tint R=L+Len-1;\n\t\t\t\t\tdp[i][j][L][R]=max(dp[i][j][L+1][R],dp[i][j][L][R-1]);\n\t\t\t\t\tdp[i][j][L][R]=max(dp[i][j][L][R],dp[i+1][j][L][R]+(a[i]==L));\n\t\t\t\t\tdp[i][j][L][R]=max(dp[i][j][L][R],dp[i][j-1][L][R]+(a[j]==R));\n\t\t\t\t\tdp[i][j][L][R]=max(dp[i][j][L][R],dp[i+1][j-1][L][R]+(a[i]==R)+(a[j]==L));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\",dp[1][n][1][50]);\n\treturn 0;\n}\n```",
        "postTime": 1637416908,
        "uid": 483928,
        "name": "Ziqqurat",
        "ccfLevel": 5,
        "title": "P3607 \u9898\u89e3"
    },
    {
        "content": "## Description\n\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217 $\\{a_i\\}$\uff0c\u53ef\u4ee5\u9009\u62e9\u4e00\u4e2a\u5b50\u5e8f\u5217\u5c06\u5176\u53cd\u8f6c\uff0c\u6c42\u80fd\u83b7\u5f97\u7684\u6700\u5927\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\u3002\n\n$n\\leq 50$\u3002\n\n## Solution\n\n\u89c2\u5bdf\u4e00\u4e0b\u53cd\u8f6c\u7684\u6027\u8d28\uff0c\u5b9e\u9645\u4e0a\u5c31\u76f8\u5f53\u4e8e\u5c06\u8fd9\u4e2a\u5b50\u5e8f\u5217\u4e24\u8fb9\u5bf9\u8c03\uff0c\u4e14\u4e0d\u4f1a\u6709\u4ea4\u9519\u548c\u5e76\u5217\uff0c\u4e0e\u533a\u95f4 DP \u80fd\u5f88\u597d\u5730\u642d\u914d\u2014\u2014\u9009\u62e9\u53cd\u8f6c\u4e24\u4e2a\u6570\uff0c\u4ed6\u4eec\u4e4b\u95f4\u7684\u533a\u95f4\u53ef\u4ee5\u63a5\u7740\u53cd\u8f6c\u3002\n\n\u90a3\u4e48\u8003\u8651 $f_{i,j}$ \u8868\u793a\u533a\u95f4 $[i,j]$ \u7684\u7b54\u6848\uff0c\u5176\u4e2d\u53ea\u8003\u8651\u662f\u5426\u53cd\u8f6c $a_i,a_j$\u3002\n\n\u8003\u8651\u5982\u4f55\u7531\u5c0f\u533a\u95f4\u5f97\u5230\u5927\u533a\u95f4\u7684\u89e3\uff0c\u56de\u5fc6 LIS \u7684 $O(n^2)$ \u505a\u6cd5\uff0c\u4e0e\u503c\u6709\u5173\uff0c\u90a3\u4e48\u518d\u52a0\u4e24\u7ef4\u72b6\u6001\uff1a$f_{i,j,l,r}$ \u8868\u793a\u533a\u95f4 $[i,j]$\uff0c\u503c\u57df $[l,r]$ \u7684\u7b54\u6848\u3002\n\n\u90a3\u4e48\u5c31\u53ef\u4ee5\u65b9\u4fbf\u7684\u8f6c\u79fb\u4e86\u3002\n\n\u9996\u5148\uff0c\u5927\u503c\u57df\u663e\u7136\u53ef\u4ee5\u7531\u5c0f\u503c\u57df\u5f97\u6765\uff0c\u5373 $f_{i,j,l,r}=\\max(f_{i,j,l+1,r},f_{i,j,l,r-1})$\u3002\n\n\u4e3a\u8868\u8ff0\u65b9\u4fbf\uff0c\u8bb0 $[\\text{bool}]=\\begin{cases}1&\\text{if bool = TRUE}\\\\0&\\text{if bool = FALSE}\\end{cases}$\u3002\n\n\u5f53\u4e0d\u53cd\u8f6c $a_i,a_j$ \u65f6\uff0c$f_{i,j,l,r}=\\max(f_{i+1,j,l,r}+[a_i=l],f_{i,j-1,l,r}+[a_j=r])$\u3002\n\n\u5f53\u53cd\u8f6c $a_i,a_j$ \u65f6\uff0c$f_{i,j,l,r}=f_{i+1,j-1,l,r}+[a_i=l]+[a_j=r]$\u3002\n\n\u628a\u4e0a\u9762\u7684\u65b9\u7a0b\u90fd\u53d6\u4e2a $\\text{max}$\uff0c\u5c31\u5f97\u5230\u8fd9\u4e2a\u72b6\u6001\u7684\u7b54\u6848\u4e86\u3002\n\n\u521d\u59cb\u72b6\u6001\u5c31\u628a\u533a\u95f4\u957f\u5ea6\u4e3a $1$ \u7684\u5408\u6cd5\u72b6\u6001\u90fd\u8bbe\u6210 $1$ \u5373\u53ef\u3002\n\n\u4e00\u5f00\u59cb\u628a\u4e0d\u76f8\u7b49\u7684\u60c5\u51b5\u4e5f\u8003\u8651\u8fdb\u53bb\u4e86\uff0c\u540e\u6765\u53d1\u73b0\u662f\u9519\u7684\uff1a\u4e0d\u76f8\u7b49\u7684\u60c5\u51b5\u5728\u503c\u57df\u6269\u5f20\u7684\u65f6\u5019\u4f1a\u88ab\u8003\u8651\u5230\uff0c\u6ca1\u5fc5\u8981\u518d\u8fdb\u884c\u8ba8\u8bba\u3002\uff08\u5176\u5b9e\u628a\u7ec6\u8282\u7a0d\u5fae\u6539\u4e00\u4e0b\u4e5f\u80fd\u505a\uff09\n\n## Code\n```cpp\n#include <algorithm>\n#include <cstdio>\n#include <iostream>\n\nconst int maxn = 55;\n\nint a[maxn], b[maxn];\nint f[maxn][maxn][maxn][maxn];\n\nint n;\n\ninline void upd_max(int &a, int b) { a = std::max(a, b); }\ninline int change(bool x) { return x ? 1 : 0; }\n\nint main()\n{\n    scanf(\"%d\", &n);\n    for (int i = 1; i <= n; i++)\n        scanf(\"%d\", &a[i]), b[i] = a[i];\n    \n    std::sort(b + 1, b + 1 + n);\n    int tot = std::unique(b + 1, b + 1 + n) - b - 1;\n    for (int i = 1; i <= n; i++)\n        a[i] = std::lower_bound(b + 1, b + 1 + tot, a[i]) - b;\n    // \u5176\u5b9e\u6ca1\u5fc5\u8981\u79bb\u6563\u5316\u3002\n    for (int i = 1; i <= n; i++)\n        for (int j = 1; j <= a[i]; j++)\n            for (int k = a[i]; k <= tot; k++)\n                f[i][i][j][k] = 1;\n    // DP\u7684\u987a\u5e8f\u9700\u8981\u8003\u8651\u4e00\u4e0b\n    for (int len = 2; len <= n; len++)\n    {\n        for (int i = 1; i <= n; i++)\n        {\n            int j = i + len - 1;\n            if (j > n)\n                continue;\n            for (int len2 = 1; len2 <= tot; len2++)\n            {\n                for (int l = 1; l <= tot; l++)\n                {\n                    int r = l + len2 - 1;\n                    if (r > tot)\n                        continue;\n                    if (l != tot)\n                        upd_max(f[i][j][l][r], f[i][j][l + 1][r]);\n                    upd_max(f[i][j][l][r], f[i][j][l][r - 1]);\n                    upd_max(f[i][j][l][r], f[i + 1][j][l][r] + change(a[i] == l));\n                    upd_max(f[i][j][l][r], f[i][j - 1][l][r] + change(a[j] == r));\n                    upd_max(f[i][j][l][r], f[i + 1][j - 1][l][r] + change(a[i] == r) + change(a[j] == l));\n                }\n            }\n        }\n    }\n    printf(\"%d\\n\", f[1][n][1][tot]);\n}\n```\n\n",
        "postTime": 1636080629,
        "uid": 373429,
        "name": "_slb",
        "ccfLevel": 0,
        "title": "luogu3607"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://blog.calvincheng1231.org.cn/sols/256.html)\n\n## \u5206\u6790\n\u5f88\u795e\u5947\u7684 DP \u9898\u3002\n\n\u8fd9\u9053\u9898\u6bd4\u8f83\u96be\u7684\u5730\u65b9\u5728\u4e8e\u5904\u7406\u5e8f\u5217\u53cd\u8f6c\u3002\n\n\u6709\u4e00\u4e2a\u5173\u952e\u7684\u60f3\u6cd5\uff1a\u5e8f\u5217\u53cd\u8f6c\u4e0d\u597d\u8bb0\u5f55\uff0c\u4f46\u662f\u53ef\u4ee5\u770b\u505a\u5f88\u591a\u6b21\u4ea4\u6362\u6570\u7684\u4f4d\u7f6e\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u7ffb\u8f6c\u5b50\u5e8f\u5217 $a_{i_1},a_{i_2},\\ldots a_{i_k}$ \u7b49\u4ef7\u4e8e\u4ea4\u6362 $a_{i_1}$ \u548c $a_{i_k}$\uff0c$a_{i_2}$ \u548c $a_{i_{k-1}}$ \u7b49\u7b49\u3002\u4e0d\u9700\u8981\u8003\u8651\u591a\u4e86\u4e00\u4e2a\u7684\u60c5\u51b5\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u6570\u6839\u672c\u5c31\u4e0d\u4f1a\u6539\u53d8\u4f4d\u7f6e\uff0c\u628a\u5b83\u4ece $i$ \u4e2d\u53bb\u6389\u5c31\u597d\u3002\u5f88\u53ef\u80fd\u662f\u4e00\u4e2a\u533a\u95f4 DP\u3002\n\n\u9700\u8981\u5feb\u901f\u5224\u65ad\u4e00\u4e2a\u6570\u80fd\u5426\u4f5c\u8d21\u732e\uff0c\u800c\u4e14\u503c\u57df\u4e5f\u53ea\u6709 50\uff0c\u72b6\u6001\u91cc\u9762\u53ef\u4ee5\u8003\u8651\u5e26\u503c\u57df\u3002\n\n\u6240\u4ee5\uff0c\u57fa\u672c\u4e0a\u53ef\u4ee5\u8bbe\u51fa\u72b6\u6001\uff1a\u8bbe $dp_{l,r,L,R}$ \u4e3a\u539f\u5e8f\u5217\u4e2d $l$ \u5230 $r$ \u7684\u533a\u95f4\u91cc\uff0c\u6240\u6709\u503c\u4e3a $L$ \u5230 $R$ \u7684\u6570\u7ecf\u8fc7\u7ffb\u8f6c\u540e\u53ef\u4ee5\u7ec4\u6210\u7684\u6700\u957f LIS \u957f\u5ea6\u3002\n\n\u8003\u8651\u5982\u4f55\u8f6c\u79fb\u3002\n\n\u9996\u5148\uff0c$a_l$ \u548c $a_r$ \u53ef\u80fd\u4e0d\u5728 $[L,R]$ \u4e2d\uff0c\u6240\u4ee5\u8981\u901a\u8fc7 $dp_{l,r,L+1,R}$ \u548c $dp_{l,r,L,R-1}$ \u8f6c\u79fb\u3002\n\n**update:** \u5c11\u5199\u4e86\u4e00\u4e2a\u201c\u4e0d\u201d\u5b57\uff0c\u53ef\u80fd\u9020\u6210\u4e86\u4e00\u4e9b\u56f0\u6270\u3002\n\n\u5176\u6b21\u8003\u8651\u4e0d\u4ea4\u6362 $a_l$ \u548c $a_r$ \u4f4d\u7f6e\u7684\u60c5\u51b5\u4e0b\uff0c$a_l$ \u4f5c\u7684\u8d21\u732e\u3002\u4e0d\u88ab\u5305\u62ec\u5728\u7b2c\u4e00\u79cd\u60c5\u51b5\u7684\u53ea\u6709 $a_l=L$ \u4e14\u7b97\u5165 LIS \u7684\u60c5\u51b5\u3002\u4ece $dp_{l+1,r,L,R}+[a_l=L]$ \u8f6c\u79fb\u3002\u540c\u7406\u8981\u4ece $dp_{l,r-1,L,R}+[a_r=R]$ \u8f6c\u79fb\u3002\n\n\u6700\u540e\u8003\u8651\u4ea4\u6362 $a_l$ \u548c $a_r$ \u7684\u60c5\u51b5\u3002\u4e0d\u88ab\u5305\u62ec\u5728\u7b2c\u4e00\u79cd\u60c5\u51b5\u7684\u53ea\u6709 $a_l=R$ \u6216\u8005 $a_r=L$ \u7684\u60c5\u51b5\u3002\u4ece $dp_{l+1,r-1,L,R}+[a_l=R]+[a_r=L]$ \u8f6c\u79fb\u3002\n\n\u7b54\u6848\u662f $dp_{1,n,1,50}$\u3002\n\n## \u89e3\u51b3\n```cpp\n#include <algorithm>\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n\nusing namespace std;\n\nconst int N = 55;\nint n, a[N], dp[N][N][N][N];\n\nint main()\n{\n    cin >> n;\n    for (int i = 1; i <= n; i++)\n    {\n        cin >> a[i];\n        for (int L = 1; L <= a[i]; L++)\n            for (int R = a[i]; R <= 50; R++)\n                dp[i][i][L][R] = 1;\n    }\n    for (int l1 = 2; l1 <= n; l1++)\n        for (int l = 1, r = l1; r <= n; l++, r++)\n            for (int l2 = 1; l2 <= 50; l2++)\n                for (int L = 1, R = l2; R <= 50; L++, R++)\n                {\n                    dp[l][r][L][R] = max(dp[l][r][L + 1][R], dp[l][r][L][R - 1]);\n                    dp[l][r][L][R] = max(dp[l][r][L][R], dp[l + 1][r][L][R] + (a[l] == L));\n                    dp[l][r][L][R] = max(dp[l][r][L][R], dp[l][r - 1][L][R] + (a[r] == R));\n                    dp[l][r][L][R] =\n                        max(dp[l][r][L][R], dp[l + 1][r - 1][L][R] + (a[l] == R) + (a[r] == L));\n                }\n    cout << dp[1][n][1][50] << endl;\n    return 0;\n}\n```",
        "postTime": 1633338510,
        "uid": 253946,
        "name": "ClHg2",
        "ccfLevel": 7,
        "title": "P3607 \u9898\u89e3"
    },
    {
        "content": "\u8bbe $dp[l][r][k][m]$ \u4e3a\uff1a \u533a\u95f4 $[l,r]$ \u5728 $[1,l-1]$ \u7684\u6700\u5927\u503c\u4e3a $k$, $[r+1,n]$ \u7684\u6700\u5c0f\u503c\u4e3a $m$ \u7684\u60c5\u51b5\u4e0b\u5bf9\u7b54\u6848\u7684\u8d21\u732e\uff0c\u8f6c\u79fb\u89c1\u4ee3\u7801\u3002\n\n\n```cpp\n#include <cstdio>\n\nconst int MAXN = 55;\n\ninline void chkmax(int &a, int b) {\n  if(b > a) a = b;\n}\n\nint a[MAXN], dp[MAXN][MAXN][MAXN][MAXN], vis[MAXN][MAXN][MAXN][MAXN];\n\nint solve(int i, int j, int k, int m) {\n  if(vis[i][j][k][m]) return dp[i][j][k][m];\n  if(k > m) return -1e8;\n  if(i > j) return 0;\n  if(i == j) {\n    if(a[i] >= k && a[j] <= m) return 1;\n    return 0;\n  }\n  int ans = 0;\n  //1. \u4ea4\u6362 a[i], a[j]\n  chkmax(ans, solve(i + 1, j - 1, k, m));\n  if(a[j] >= k) chkmax(ans, solve(i + 1, j - 1, a[j], m) + 1);\n  if(a[i] <= m) chkmax(ans, solve(i + 1, j - 1, k, a[i]) + 1);\n  if(a[j] >= k && a[i] <= m) chkmax(ans, solve(i + 1, j - 1, a[j], a[i]) + 2);\n  //2. \u4e0d\u4ea4\u6362\n  //(1) [i + 1, j]\n  chkmax(ans, solve(i + 1, j, k, m));\n  if(a[i] >= k) chkmax(ans, solve(i + 1, j, a[i], m) + 1);\n  //(2) [i, j - 1]\n  chkmax(ans, solve(i, j - 1, k, m));\n  if(a[j] <= m) chkmax(ans, solve(i, j - 1, k, a[j]) + 1);\n  return vis[i][j][k][m] = 1, dp[i][j][k][m] = ans;\n}\nint main() {\n  int n; scanf(\"%d\", &n);\n  for(int i = 1; i <= n; i++) {\n    scanf(\"%d\", &a[i]);\n  }\n  printf(\"%d\\n\", solve(1, n, 0, 50));\n  return 0;\n}\n```",
        "postTime": 1486217099,
        "uid": 11171,
        "name": "ddd",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3607 \u3010[USACO17JAN]Subsequence Reversal\u5e8f\u5217\u53cd\u8f6c\u3011"
    }
]
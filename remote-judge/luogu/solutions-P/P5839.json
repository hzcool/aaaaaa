[
    {
        "content": "[\u672c\u573aUSACO\u5176\u4ed6\u9898\u76ee\u7684\u9898\u89e3](https://www.luogu.com.cn/blog/Good-ZH/usaco2019-dec-ti-xie)\n\n~~\u65e2\u7136\u90fd\u5199\u8fc7\u4e86\u5c31\u5728\u9898\u89e3\u533a\u518d\u53d1\u4e00\u904d~~\n\n\u7ed9\u5b9a\u4e00\u4e2a\u5b57\u7b26\u4e32\u548c\u4e00\u4e2a $M\\times M$ \u7684\u77e9\u9635 $a$\uff0c\u8868\u793a\u53ef\u4ee5\u6d88\u8017 $a_{i,j}$ \u7684\u4ee3\u4ef7\u628a\u5b57\u7b26 $i$ \u6539\u6210\u5b57\u7b26 $j$\uff0c\u6c42\u628a\u539f\u5b57\u7b26\u4e32\u6539\u6210\u6bcf\u4e2a\u8fde\u7eed\u6bb5\u957f\u5ea6\u90fd\u4e0d\u5c0f\u4e8e $K$ \u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n$n,K\\le 10^5,M\\le 26$\n\n\u9996\u5148\u76f4\u63a5\u7528\u539f\u77e9\u9635\u7684\u4ea4\u6362\u65b9\u6cd5\u4e0d\u4e00\u5b9a\u6700\u4f18\uff0c\u62ff\u5230\u624b\u5148\u8dd1\u4e00\u904d floyd\u3002\n\n\u7136\u540e\u8003\u8651 dp \uff0c$f_i$ \u8868\u793a\u524d $i$ \u4e2a\u4e2d\u6bcf\u4e2a\u8fde\u7eed\u6bb5\u90fd $\\ge k$ \u7684\u6700\u5c0f\u4ee3\u4ef7\uff0c\u663e\u7136\u6709\u8f6c\u79fb\n$$\nf_i=\\min\\{ f_j +cost(i,j,c)\\} \\ \\ \\ (j\\le i-k)\n$$\n\n\u5176\u4e2d $cost(i,j,c)$ \u8868\u793a\u628a $[i,j]$ \u5168\u90fd\u6539\u6210\u5b57\u7b26 $c$ \u7684\u6700\u5c0f\u4ee3\u4ef7\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u524d\u7f00\u548c\u9884\u5904\u7406\u3002\n\n\u89c2\u5bdf\u8f6c\u79fb\uff0c\u53d1\u73b0\u53ef\u4ee5\u5728\u679a\u4e3e\u5230 $i$ \u65f6\u518d\u628a $i-k$ \u7684\u51b3\u7b56\u52a0\u8fdb\u53bb\uff0c\u8fd9\u6837\u7ef4\u62a4\u4e00\u4e2a\u524d\u7f00 $\\min$ \u5373\u53ef\u505a\u5230 $O(1)$ \u8f6c\u79fb\u3002\n\n\u590d\u6742\u5ea6 $O(n\\times M)$\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N=100005;\nint c[30][30],f[N];\nchar s[N];\nint sum[30][N];\nint query(int x,int l,int r){\n\treturn sum[x][r]-sum[x][l-1];\n}\nint mn[30];\nint main (){\n\tfreopen (\"cowmbat.in\",\"r\",stdin);\n\tfreopen (\"cowmbat.out\",\"w\",stdout);\n\tint n,m,k;scanf (\"%d%d%d\",&n,&m,&k);\n\tscanf (\"%s\",s+1);\n\tfor (int i=0;i<m;i++)\n\t\tfor (int j=0;j<m;j++)\n\t\t\tscanf (\"%d\",&c[i][j]);\n\tfor (int l=0;l<m;l++)\n\t\tfor (int i=0;i<m;i++)\n\t\t\tfor (int j=0;j<m;j++)\n\t\t\t\tif (i!=j&&j!=l&&i!=l)\n\t\t\t\t\tc[i][j]=min(c[i][j],c[i][l]+c[l][j]);\n\tfor (int i=0;i<m;i++)\n\t\tfor (int j=1;j<=n;j++)\n\t\t\tsum[i][j]=c[s[j]-'a'][i]+sum[i][j-1];\n\tmemset (mn,0x3f,sizeof(mn));\n\tmemset (f,0x3f,sizeof(f));f[0]=0;\n\tfor (int i=k;i<=n;i++)\n\t\tfor (int j=0;j<m;j++)\n\t\t\tmn[j]=min(mn[j]+c[s[i]-'a'][j],f[i-k]+query(j,i-k+1,i)),f[i]=min(f[i],mn[j]);\n\tprintf (\"%d\",f[n]);\n\treturn 0;\n}\n```",
        "postTime": 1576836315,
        "uid": 18378,
        "name": "wh_ZH",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5839 \u3010[USACO19DEC]Moortal Cowmbat\u3011"
    },
    {
        "content": "\u62a2\u7b2c\u4e00\u7bc7\u9898\u89e3\n\n\n\u6839\u636e\u6570\u636e\u8303\u56f4\u548c\u9700\u8981\u89e3\u51b3\u7684\u95ee\u9898\uff0c\u5f88\u5bb9\u6613\u60f3\u5230$DP$\u505a\u6cd5(\u5176\u5b9e\u9760\u76f4\u89c9\n\n\n\u5b9a\u4e49\u72b6\u6001$f[i]$\u8868\u793a\u5c06$1-i$\u6539\u6210\u5408\u6cd5\u9700\u8981\u7684\u6700\u5c0f\u5929\u6570\n\n\n\u6211\u4eec\u6709\u8f6c\u79fb\u65b9\u7a0b$f[i]=min_{0<=j+k<=i}\\{f[j]+val(j+1,i)\\}$\n\n\n\u8fb9\u754c$f[0]=0$\uff0c\u5176\u4e2d$val(i,j)$\u8868\u793a``\u5c06i-j``\u5168\u90e8\u67d3\u6210\u4e00\u79cd\u989c\u8272\u9700\u8981\u7684\u6700\u5c0f\u5929\u6570\n\n\n\u663e\u7136\u6211\u4eec\u5bf9\u6bcf\u79cd\u989c\u8272\u8dd1\u4e00\u904d\u5c06$1-i$\u5168\u90e8\u67d3\u6210\u989c\u8272$c$\u7684\u5929\u6570\uff0c\u8bb0\u5f55\u524d\u7f00\u548c\u5373\u53ef\n\n\n\u8fd9\u6837$f[i]=min(f[i],sum[col][i]-sum[col][j]+f[j])$\n\n\n$j$\u7684\u9009\u62e9\u592a\u591a\u4e0d\u80fd\u76f4\u63a5\u679a\u4e3e\uff0c\u6211\u4eec\u53d1\u73b0\u51b3\u7b56\u96c6\u5408\u5355\u8c03\u9012\u589e\uff0c\u6240\u4ee5\u53ea\u7528\u5bf9\u6bcf\u79cd\u989c\u8272$col$\u8bb0\u5f55$mx[col]$\u8868\u793a$sum[col][j]-f[j]$\u6700\u5927\u503c\u5373\u53ef\n\n\n\u6700\u7ec8\u8f6c\u79fb$f[i]=min(f[i],sum[col][i]-mx[col])$\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(NM)$\n\n\n```cpp\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<=b;i++)\n#define N 100005\nusing namespace std;\nint n,m,k,a[30][30];\nchar s[N];\nint sum[30][N];\nvoid init(int col){\n\trep(i,1,n)sum[col][i]=sum[col][i-1]+a[s[i]-'a'+1][col];\n}\nint mx[30];\nint f[N];\nvoid floyd(){\n\trep(k,1,m)\n\t  rep(i,1,m)\n\t    rep(j,1,m)\n\t\t  if(i^j)a[i][j]=min(a[i][j],a[i][k]+a[k][j]);\n}\nvoid work(){\n\tmemset(f,0x7f,sizeof(f));\n\tf[0]=0;\n\trep(i,k,n){\n\t\trep(col,1,m)mx[col]=max(mx[col],sum[col][i-k]-f[i-k]);\n\t\trep(col,1,m)f[i]=min(f[i],sum[col][i]-mx[col]);\n\t}\n\tprintf(\"%d\\n\",f[n]);\n}\nint main(){\n\t//freopen(\"cowmbat.in\",\"r\",stdin);\n\t//freopen(\"cowmbat.out\",\"w\",stdout);\n\tscanf(\"%d%d%d\",&n,&m,&k);\n\tscanf(\"%s\",s+1);\n\trep(i,1,m)rep(j,1,m)scanf(\"%d\",&a[i][j]);\n\tfloyd();\n\trep(i,1,m)init(i);\n\t/*rep(i,1,m){\n\t\trep(j,1,n)printf(\"%d \",sum[i][j]);\n\t\tputchar('\\n');\n\t}*/\n\twork();\n\treturn 0;\n}\n```\n\n\uff08\u62a2\u8fdb\u5ea6\uff0c\u6709\u95ee\u9898\u53f3\u8f6c\u8bc4\u8bba\u533a",
        "postTime": 1576766178,
        "uid": 119261,
        "name": "7KByte",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5839 \u3010[USACO19DEC]Moortal Cowmbat\u3011"
    },
    {
        "content": "\u8003\u8651 DP\uff0c\u8bbe $f_i$ \u8868\u793a\u8c03\u6574\u524d $i$ \u4e2a\u5b57\u7b26\u7684\u6700\u5c0f\u4ee3\u4ef7\uff0c\u8f6c\u79fb\u53ef\u4ee5\u8003\u8651\u679a\u4e3e\u6700\u540e\u4e00\u6bb5\u622a\u5230\u54ea\u91cc\uff0c\u6709\n$$\nf_i=\\min_{j\\le i-k} f_j+\\text{cost}(j+1,i)\n$$\n \u5176\u4e2d $\\text{cost}(l,r)$ \u8868\u793a\u533a\u95f4 $[l,r]$ \u53d8\u6210\u540c\u4e00\u4e2a\u5b57\u7b26\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n\u8fd9\u4e2a\u53ef\u4ee5\u7528 $O(M^3+NM)$ \u65f6\u95f4\u9884\u5904\u7406\uff0c\u5177\u4f53\u6765\u8bf4\u662f\u505a\u4e00\u4e2a $\\text{Floyd}$ \u7136\u540e\u6c42\u4e00\u4e0b\u524d\u7f00\u548c $S(i,c)$ \u8868\u793a\u5c06\u524d $i$ \u4e2a\u5b57\u7b26\u90fd\u53d8\u4e3a $c$ \u7684\u6700\u5c0f\u4ee3\u4ef7\uff0c\u90a3\u4e48 $\\text{cost}(l,r)=\\min_{c}S(r,c)-S(l-1,c)$\u3002\n\n\u76f4\u63a5\u8f6c\u79fb\u7684\u8bdd\u590d\u6742\u5ea6\u4e3a $O(N^2M)$\uff0c\u6211\u4eec\u8003\u8651\u679a\u4e3e $c$\uff0c\u90a3\u4e48\u6709\n$$\n\\min_{j\\le i-k}f_j+\\text{cost}(j+1,i)=\\min_{c\\in\\{\\texttt{A,B,}\\cdots\\texttt{,Z}\\}}\\left(S(i,c)+\\min_{j\\le i-k}\\left\\{f_j-S(j,c)\\right\\}\\right)\n$$\n\u90a3\u4e48\u53ea\u9700\u8981\u5bf9\u6bcf\u4e2a $c$ \u7ef4\u62a4 $f_j-S(j,c)$ \u7684\u524d\u7f00\u6700\u5c0f\u503c\u5373\u53ef\u3002\u590d\u6742\u5ea6 $O(NM+M^3)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n\n#define int long long\n\nusing namespace std;\n\ninline int read(){\n\tint x=0,f=1;char c=getchar();\n\tfor(;(c<'0'||c>'9');c=getchar()){if(c=='-')f=-1;}\n\tfor(;(c>='0'&&c<='9');c=getchar())x=x*10+(c&15);\n\treturn x*f;\n}\n\nconst int MN=1e5+5;\nconst int MC=30;\n\nint f[MC][MC],n,k,m,dp[MN],S[MN][MC],g[MN][MC];\nstring str;\n\nsigned main(void){\n\n#ifndef ONLINE_JUDGE\n\tfreopen(\"in.in\",\"r\",stdin);\n#endif\n\n\tcin>>n>>m>>k;\n\tcin>>str;\n\tfor(int i=1;i<=m;i++)for(int j=1;j<=m;j++)f[i][j]=read();\n\tfor(int k=1;k<=m;k++)for(int i=1;i<=m;i++)for(int j=1;j<=m;j++)f[i][j]=min(f[i][j],f[i][k]+f[k][j]);\n\tfor(int x=1;x<=m;x++)for(int i=1;i<=n;i++)S[i][x]=S[i-1][x]+f[str[i-1]-'a'+1][x];\n\tmemset(dp,63,sizeof(dp)),memset(g,63,sizeof(g));\n\tdp[0]=0;for(int x=1;x<=m;x++)g[0][x]=0;\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int x=1;x<=m;x++)if(i>=k)dp[i]=min(dp[i],g[i-k][x]+S[i][x]);\n\t\tfor(int x=1;x<=m;x++)g[i][x]=min(g[i-1][x],dp[i]-S[i][x]);\n\t}\n\tcout<<dp[n]<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1659111950,
        "uid": 307453,
        "name": "\u4e91\u6d45\u77e5\u5904",
        "ccfLevel": 6,
        "title": "P5839 USACO19DEC Moortal Cowmbat G"
    },
    {
        "content": "\u6bcf\u5757\u957f $x\\in [k,2k-1]$\uff0c\u56e0\u4e3a\u5bf9\u4e8e $\\ge 2k$ \u7684\u5757\u53ef\u4ee5\u770b\u505a\u591a\u4e2a\u5c0f\u5757\u3002\n\n\u8bbe $f_{i,j}$ \u8868\u793a\u7ef4\u62a4\u5230\u4f4d\u7f6e $i$\uff0c\u6700\u540e\u4e00\u4e2a\u5757\u662f\u7b2c $j$ \u4e2a\u5c0f\u5199\u5b57\u6bcd\u7684\u6700\u5c0f\u82b1\u8d39\u3002\n\n$i\\in[x,x]\\cup [x+k,n]$\uff0c\u542b\u4e49\u662f\uff0c\u8981\u4e48\u662f\u7b2c\u4e00\u4e2a\u5757\uff0c\u8981\u4e48\u4ece\u524d\u9762\u627e\u4e00\u4e2a\u5757\u63a5\u8fc7\u6765\u3002\n\n\u7136\u540e\u4e00\u6bb5\u8fde\u7eed\u7684\u533a\u95f4\u9644\u6210\u540c\u4e00\u4e2a\u5b57\u6bcd\u662f\u53ef\u4ee5\u524d\u7f00\u548c\u9884\u5904\u7406\u51fa\u6765\u7684\uff0c\u6240\u4ee5\u5f53\u524d\u5757\u8d39\u7528\u7684\u8ba1\u7b97\u662f $\\operatorname O(1)$ \u7684\u3002\n\n\u8bbe $add_{i,j}$ \u8868\u793a\u628a\u524d $i$ \u4e2a\u4f4d\u7f6e\u5168\u90fd\u53d8\u6210\u7b2c $j$ \u4e2a\u5c0f\u5199\u5b57\u6bcd\u7684\u82b1\u8d39\u3002\n\n\u76f4\u63a5\u6309\u8fd9\u4e2a DP \u5f0f\u6b63\u5e38\u505a\u7684\u8bdd\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a\uff1a\n\n$$(n-2k)+(n-2k-1)+\\dots+(n-3k)+k$$\n\n$$=n\\times k-\\frac{5k^2}{2}+k$$\n\n$$=-\\frac{5}{2}k^2+(n+1)k$$\n\n\u5f53 $k=\\frac{n+1}{5}$ \u65f6\uff0c$\\operatorname O_{min}=\\frac{(n+1)^2}{10}$\u3002\n\n$n\\le 10^5$\uff0c\u597d\u50cf\u5dee\u4e0d\u591a\u521a\u597d\u7684\u6837\u5b50\u3002\n\n\u4f46\u662f\uff0c\u522b\u5fd8\u4e86\u8fd8\u6709\u4e2a $m\\le 26$ \u7684\u5927\u5e38\u6570\uff0c\u679a\u4e3e\u8fd9\u4e2a\u5757\u548c\u4e0a\u4e00\u4e2a\u5757\u7684\u5b57\u6bcd\uff0c\u6240\u4ee5\u8fd9\u4e2a\u65b9\u6cd5\u7684\u6781\u9650\u590d\u6742\u5ea6\u4e3a $\\operatorname O(m^2\\times \\frac{(n+1)^2}{10})$\uff0c\u53ef\u4ee5\u8fbe\u5230 $6.76\\times 10^{11}$\u3002\n\n\u4f46\u5b9e\u9645\u4e0a\u6211\u4eec\u53d1\u73b0\uff0c\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u7ba1\u524d\u9762\u7684\u5b57\u6bcd\u662f\u4ec0\u4e48\uff0c\u6240\u4ee5\u9996\u5148\u5c06 $f$ \u964d\u6210\u4e00\u7ef4\u7684\uff0c\u7528 $f_i$ \u8868\u793a\u7ef4\u62a4\u5230\u4f4d\u7f6e $i$ \u7684\u6700\u5c0f\u82b1\u8d39\u3002\n\n\u7136\u540e\u5bf9\u4e8e $f_i$\uff0c\u6211\u4eec\u9700\u8981\u7528\u5230\u7684\u662f $f_j,j\\in[i-(2k-1),i-k]$\uff08\u5b9e\u9645\u4e0a\u8003\u8651\u5230\u8fd9\u91cc $[0,i-k]$ \u662f\u4e00\u6837\u7684\uff0c\u524d\u9762\u770b\u4f5c\u591a\u4e2a\u5c0f\u5757\uff0c\u5176\u5b9e\u5e76\u6ca1\u6709\u8fd9\u4e2a\u5fc5\u8981\uff09\uff0c\u7136\u540e\u8f6c\u79fb\u65b9\u7a0b\u5f0f\u4e3a\uff1a\n\n$$f_i=f_j+add_{i,k}-add_{j,k}$$\n\n\u5176\u4e2d $k$ \u8868\u793a\u5f53\u524d\u5757\u679a\u4e3e\u7684\u662f\u7b2c\u51e0\u4e2a\u5c0f\u5199\u5b57\u6bcd\u3002\n\n\u90a3\u4e48\u5c31\u5f00\u4e2a\u6570\u7ec4\u5b58\u4e00\u4e0b\u6bcf\u4e2a\u5c0f\u5199\u5b57\u6bcd\u7684\u6700\u4f73\u8f6c\u79fb\u8d39\u7528\u5c31\u884c\u4e86\u3002\n\n\u8fd9\u4e48\u4e00\u770b\u5c31\u662f\u4e00\u9053\u975e\u5e38\u7b80\u5355\u7684 DP \u9898\uff0c\u4ee3\u7801\u4e5f\u5f88\u7b80\u77ed\u3002\n\n~~\u84dd\u6709\u70b9\u8fc7\u4e86\uff0c\u5e94\u8be5\u8bc4\u7eff\u5dee\u4e0d\u591a~~\n\n```cpp\n#include <bits/stdc++.h>\n#define LL long long\n#define min(a,b) a<b?a:b\nusing namespace std;\nconst int MAX=1e5+3;\nint n,m,k;\nint a[27][27];\nint add[27][MAX];\nint f[MAX];\nint min_f[26];\nstring s;\nLL rin()\n{\n    LL s=0;\n    char c=getchar();\n    bool bj=0;\n    for(;(c>'9'||c<'0')&&c!='-';c=getchar());\n    if(c=='-')c=getchar(),bj=true;\n    for(;c>='0'&&c<='9';c=getchar())s=(s<<1)+(s<<3)+(c^'0');\n    if(bj)return -s;\n    return s;\n}\nint main()\n{\n    memset(f,0x3f,sizeof(f));\n    n=rin();m=rin();k=rin();\n    cin>>s;\n    for(int i=1;i<=m;i++)for(int j=1;j<=m;j++)a[i][j]=rin();\n    for(int _=1;_<=m;_++)\n    for(int i=1;i<=m;i++)\n    for(int j=1;j<=m;j++)\n    a[i][j]=min(a[i][j],a[i][_]+a[_][j]);\n    for(int j=1;j<=m;j++)for(int i=1;i<=n;i++)add[j][i]=add[j][i-1]+a[s[i-1]-'a'+1][j];\n    for(int i=k;i<=n;i++)\n    {\n        if(i>=(k<<1))\n        {\n            int now=i-k;\n            for(int j=1;j<=m;j++)min_f[j]=min(min_f[j],f[now]-add[j][now]);\n        }\n        for(int j=1;j<=m;j++)f[i]=min(f[i],min_f[j]+add[j][i]);\n        // printf(\"f[%d]:%d\\n\",i,f[i]);\n    }\n    printf(\"%d\",f[n]);\n    return 0;\n}\n```\n",
        "postTime": 1599382949,
        "uid": 73551,
        "name": "zjjws",
        "ccfLevel": 7,
        "title": "P5839 [USACO19DEC]Moortal Cowmbat G"
    },
    {
        "content": "\u63a8\u8350\u4e00\u4e0b\u6211\u7684\u535a\u5ba2\uff0c\u8fd9\u91cc\u670912\u6708\u6708\u8d5b\u7684\u5168\u90e812\u7bc7\u9898\u89e3~~\nhttps://www.cnblogs.com/Purple-wzy/\n\n## C Moortal Cowmbat\n\n\u9898\u76ee\uff1ahttps://www.luogu.com.cn/problem/P5839\n\n\u9898\u89e3\uff1a\u9996\u5148\u89c2\u5bdf\u5230m\u5f88\u5c0f\uff0c\u5148O(m^3)floyd\u5224\u4e00\u4e0b\u4e24\u4e24\u4e4b\u95f4\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n\u8bbef[i][j]\u8868\u793a\u5904\u7406\u4e86\u524di\u4e2a\u5b57\u7b26\uff0c\u6700\u540e\u4e00\u5806\u5b57\u7b26\u4e3aj\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n~~\u53ef\u4ee5\u53e3\u80e1\u4e00\u4e0b\u8f6c\u79fb\u65b9\u7a0b~~\n\n\u66b4\u529b\u8f6c\u79fb\u662fO(n^2m^2)\u7684\uff0c\u6211\u4eec\u65e0\u6cd5\u63a5\u53d7\u3002\n\n\u8003\u8651\u4f18\u5316\u8fd9\u4e2adp\u3002\n\n##### O(n^2m)\n\n\u8003\u8651\u5230\u5f53\u524d\u7684\u8f6c\u79fb\u5e76\u4e0d\u9700\u8981\u77e5\u9053\u4e0a\u4e00\u6b21\u7684\u6700\u540e\u4e00\u6bb5\u7684\u5b57\u6bcd\u662f\u4ec0\u4e48\uff0c\u6211\u4eec\n\n\u53ef\u4ee5\u5148\u5bf9i\u7684\u6240\u6709\u7684f[i][j]\u53d6\u4e2amin,\u518d\u8fdb\u884c\u8f6c\u79fb\u3002\n\n##### O(nm)\n\n\u53d1\u73b0\u5bf9\u4e8e\u5f53\u524d\u7684i\uff0c\u53ef\u4ee5\u8f6c\u79fb\u5230\u5b83\u7684p\u662f\u4ece1\u5f00\u59cb\u7684\u4e00\u6bb5\u8fde\u7eed\u533a\u95f4\u3002\n\n\u6211\u4eec\u8bbef[i]\u8868\u793a\u5904\u7406\u5b8c\u524di\u4e2a\u5b57\u6bcd\u7684\u6700\u5c0f\u4ee3\u4ef7\uff0csum[i][j]\u8868\u793a\u4ece1\u5230i\uff0c\n\n\u5c06\u6240\u6709\u5b57\u6bcd\u90fd\u53d8\u4e3aj\u7684\u4ee3\u4ef7\u3002\n\n\u8fd9\u6837\uff0c\u8f6c\u79fb\u65b9\u7a0b\u5c31\u53ef\u4ee5\u5199\u4e3a\uff1a\n\nf[i]=min{f[p]+sum[i][j]-sum[p][j},p $\\in$ [1,i-k]\n\n\u679a\u4e3e\u7279\u5b9a\u7684j\u65f6\uff0c\u53ef\u4ee5\u5c06sum[i][j]\u4ece\u8fd9\u4e2amax\u91cc\u63d0\u51fa\u6765\u3002\n\n\u53d1\u73b0\u53ea\u9700\u8981\u53d6f[p]-sum[p][j]\u7684min\u3002\n\n\u6211\u4eec\u8bbemx[j]\u8868\u793a\u5bf9\u4e8ep $\\in$ [1,i-k],f[p]-sum[p][j]\u7684\u6700\u5c0f\u503c\u3002\n\n\u8fd9\u6837\uff0c\u8f6c\u79fb\u5c31\u53d8\u6210\u4e86O(1)\u3002\u5177\u4f53\u5b9e\u73b0\u8fd8\u6709\u4e00\u4e9b\u5c0f\u7ec6\u8282\uff0c\u770b\u4ee3\u7801\u5427~\n\n\u590d\u6742\u5ea6\uff1aO(m^3+nm)\n\n\u4ee3\u7801\uff1a\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define re register int\n#define F(x,y,z) for(re x=y;x<=z;x++)\n#define FOR(x,y,z) for(re x=y;x>=z;x--)\n#define I inline void\n#define IN inline int\ntypedef long long ll;\nI read(int &res){\n    re g=1;register char ch=getchar();res=0;\n    while(!isdigit(ch)){\n        if(ch=='-')g=-1;\n        ch=getchar();\n    }\n    while(isdigit(ch)){\n        res=(res<<3)+(res<<1)+(ch^48);\n        ch=getchar();\n    }\n    res*=g;\n}\nconst int INF=1e9+7;\nchar c[101000];\nint n,m,k,a[101000],dis[30][30],mx[30],sum[101000][30],f[101000];\nint main(){\n\tfreopen(\"cowmbat.in\",\"r\",stdin);\n\tfreopen(\"cowmbat.out\",\"w\",stdout);\n\tread(n);read(m);read(k);\n\tcin>>c+1;\n\tF(i,1,n){\n\t\ta[i]=c[i]-'a'+1;\n\t}\n\tF(i,1,m){\n\t\tF(j,1,m){\n\t\t\tread(dis[i][j]);\n\t\t}\n\t}\n\tF(k,1,m){\n\t\tF(i,1,m){\n\t\t\tF(j,1,m){\n\t\t\t\tdis[i][j]=min(dis[i][j],dis[i][k]+dis[k][j]);//Floyd\n\t\t\t}\n\t\t}\n\t}\n\tmemset(mx,0,sizeof(mx));\n\tmemset(sum,0,sizeof(sum));\n\tF(i,1,k-1){\n\t\tF(j,1,m){\n\t\t\tsum[i][j]=sum[i-1][j]+dis[a[i]][j];//\u9884\u5904\u7406sum \n\t\t}\n\t}\n\tF(i,k,n){\n\t\tf[i]=INF;\n\t\tif(i>=(k<<1)){\n\t\t\tF(j,1,m){\n\t\t\t\tmx[j]=min(mx[j],f[i-k]-sum[i-k][j]);//i<2k\u65f6\u4e0d\u5b58\u5728\u5408\u6cd5\u7684f \n\t\t\t}\n\t\t}\n\t\tF(j,1,m){\n\t\t\tsum[i][j]=sum[i-1][j]+dis[a[i]][j];\n\t\t\tf[i]=min(f[i],mx[j]+sum[i][j]);\n\t\t}\n\t}\n\tcout<<f[n];\n    return 0;\n}\n```",
        "postTime": 1576834445,
        "uid": 93453,
        "name": "Purple_wzy",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5839 \u3010[USACO19DEC]Moortal Cowmbat\u3011"
    },
    {
        "content": "### \u505a\u9898\u5168\u8fc7\u7a0b\n\n\u5728Gold T1\u8c03\u5230\u81ea\u95ed(\u5b9e\u9645\u4e0a\u662f\u6ca1\u770b\u6e05\u695a\u5411\u4e0b\u53d6\u6574)\u4e4b\u540e\u5f00\u59cb\u770bGold T3\u3002\n\n\u5148\u60f3\u5230\u4e86\u4e00\u79cd$O(NKM)$\u7684\u505a\u6cd5\u3002\n\n\u7206\u70b8\u4e86\u4e4b\u540e\u7ee7\u7eed\u4e0a\u9ed1\u677f\u4e71\u6d82\u4e71\u753b\u3002\n\n\u6211\u5199\u4e0b\u4e86\u4e09\u4e2a\u5faa\u73af:\n\n```\nfor i 1->N\n  for j 1->K\n    for k 1->M\n```\n\n\u60f3\u4e86\u60f3\uff0c\u628a\u7b2c\u4e8c\u53e5\u8bdd\u62b9\u53bb\u4e86\u3002\n\n\u7b97\u4e86\u7b97\u590d\u6742\u5ea6\u2026\u2026\u8dd1\u5f97\u8fc7\uff01\n\n\u518d\u7136\u540e\u5c31\u662f\u4ee3\u7801\u8fc7\u7a0b\u4e86\u3002\n\n\u771f\u7684\u5c31\u8fd9\u6837\u3002\n\n---\n\n### \u9898\u610f\u7b80\u8ff0\n\n\u7ed9\u5b9a\u4e00\u4e2a\u4e32$S$\uff0c\u542b\u6709M\u79cd\u5b57\u7b26,\u8981\u5c06\u5176\u4fee\u6539\u4e3a\u8fde\u7eed\u81f3\u5c11$K$\u4e2a\u76f8\u540c\u5b57\u6bcd\u62fc\u5728\u4e00\u8d77\u7684\u6837\u5b50(\u5c31\u6bd4\u5982\u8bf4$K=2$\u65f6\uff0c`aabbcc`\u53ef\u4ee5\uff0c\u4f46\u662f`aabbc`\u4e0d\u884c\uff0c\u56e0\u4e3a\u6709\u8fde\u7eed\u5c0f\u4e8e\u4e24\u6b21\u4e2a\u76f8\u540c\u5b57\u6bcd\u7684\u4e32`c`)\u3002\u5c06\u4e00\u4e2a\u5b57\u6bcd\u4fee\u6539\u5230\u53e6\u4e00\u4e2a\u5b57\u6bcd\u9700\u8981\u4e00\u5b9a\u4ee3\u4ef7\u3002\u6c42\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n---\n\n### \u505a\u6cd5\n\n\u521a\u521a\u6240\u8bf4\u7684$O(NKM)$\u7b97\u6cd5\u5b9e\u9645\u4e0a\u5f88\u597d\u60f3\u3002\u8bb0\u5f55$dp_{i,j,k}$\u8868\u793a\u524d$i$\u4e2a\u5b57\u7b26\u4e2d\u672b\u5c3e\u4e3a\u91cd\u590d$k$\u6b21\u7684$j$\u7684\u6700\u5c0f\u82b1\u8d39\u3002\n\n\u8fd9\u4e2a\u4e1c\u897f\u4f1a\u8d85\u65f6\uff0c\u800c\u4e14\u5f88\u5bb9\u6613\u5199\u6302\uff0c\u6240\u4ee5\u6211\u653e\u5f03\u4e86\u8fd9\u4e2a\u7b97\u6cd5\u3002\n\n\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\uff0c\u5982\u679c\u6b63\u89e3\u771f\u7684\u662fDP\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u964d\u7ef4\u3002\n\n\u679a\u4e3e\u7684$N$\u662f\u5fc5\u8981\u7684\uff0c$M$\u964d\u4e0d\u964d\u65e0\u6240\u8c13\uff0c\u90a3\u4e48\u53ea\u6709$K$\u4e86\u3002\n\n\u6211\u4eec\u5047\u8bbe\u957f\u5ea6\u4e3a$i$\u7684\u4e32\u4e2d\u672b\u5c3e\u662f\u8fde\u7eed$l$\u7684\u5b57\u7b26$j$\u3002\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5c06\u540e\u9762$K$\u4e2a\u5b57\u7b26\u5206\u51fa\u6765\uff0c\u4e5f\u5c31\u662f\n```\n...aaaaa...a\n   |<--l-->|\n   ^^^^|<K>|\n```\n\n\u7531\u4e8e\u540e\u9762$K$\u4e2a\u5b57\u7b26\u4fee\u6539\u7684\u4ee3\u4ef7\u662f\u786e\u5b9a\u7684\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651\u524d\u9762\u7684\u6700\u5c0f\u4ee3\u4ef7\u5373\u53ef\u3002\n\n\u89c2\u5bdf\u4e0b\u56fe\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/j4im24v7.png)\n\n\u5176\u4e2d\u9ec4\u8272\u8868\u793a\u66b4\u529b\u4fee\u6539\u6210\u540c\u4e00\u79cd \u5b57\u7b26\uff0c\u7ea2\u8272\u8868\u793a\u7528dp\u51fd\u6570\u6c42\u5f97\u7684\u6700\u5c0f\u503c\u3002\n\n\u5982\u679c\u6211\u4eec\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u8fd9\u5e45\u56fe\u4e2d\u6bcf\u4e00\u884c\u7684\u5f0f\u5b50\u4ee3\u8868\u7684\u503c\u7684\u6700\u5c0f\u503c\u7684\u8bdd\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u52a0\u4e0a\u540e\u9762$K$\u4e2a\u5b57\u7b26\u66b4\u529b\u4fee\u6539\u7684\u4ee3\u4ef7\u6c42\u51fa\u4e00\u4e2a\u72b6\u6001\u7684\u503c\u3002\u7528$dp2_{i,j}$\u8868\u793a($i$\u662f\u957f\u5ea6\uff0c$j$\u662f\u5b57\u7b26)\u3002\n\n\u5207\u5272\u4e00\u4e0b\u8fd9\u5e45\u56fe\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5i35pkm6.png)\n\n\u5176\u4e2d\uff0c\u7eff\u8272\u65b9\u6846\u4e2d\u8868\u793a\u7684\u5c31\u662fdp2_{i-1,j}\uff0c\u9ed1\u8272\u65b9\u6846\u4e2d\u5305\u542b\u7684\u662f\u4e00\u4e2a\u5e38\u6570\u2014\u2014\u5c06\u5f53\u524d\u4f4d\u4e0a\u5b57\u7b26\u6539\u6210$j$\u7684\u4ee3\u4ef7\u3002\u84dd\u8272\u65b9\u6846\u5c31\u662fdp\u51fd\u6570\u5bf9\u4e8e\u6240\u6709\u7ed3\u5c3e\u957f\u5ea6\u4e3a$i$\u65f6\u7684\u6700\u5c0f\u503c(\u7531\u4e8e\u540e\u9762\u8fd8\u4f1a\u52a0\u4e0a$K$\u4e2a\u540c\u6837\u5b57\u7b26\uff0c\u8fd9\u91cc\u7528\u4ec0\u4e48\u7ed3\u5c3e\u90fd\u53ef\u4ee5)\u3002\n\n\u7efc\u4e0a\uff0c\u5f97\u5230\u5982\u4e0b\u5f0f\u5b50\uff1a$dp2_{i,j}=min(dp2_{i-1,j}+change(s_i\\rightarrow j),min_{0\\leq k \\le M}dp_{i,k})$\uff1b\n\n$dp_{i,j}=dp2_{i-K,j}+[cost\\ \\ to\\ \\ change\\ \\ all\\ \\ s_{i-K+1...i}\\ \\ to\\ \\ j]$\n\n\u901a\u8fc7\u8fd9\u4e24\u4e2a\u5f0f\u5b50\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u6c42\u51fa$dp$\uff0c\u4e4b\u540e\u6c42$dp2$\uff0c\u4ece\u800c\u5b9e\u73b0\u4e86$dp$\u51fd\u6570\u7684\u8ba1\u7b97\u3002\u6b64\u65f6\u590d\u6742\u5ea6$O(NM)$\u3002\n\n\u4ee3\u4ef7\u77e9\u9635\u8dd1$O(M^3)$\u6700\u77ed\u8def\u4f18\u5316\u5373\u53ef\u3002\n\n\u603b\u590d\u6742\u5ea6\uff1a$O(M^3+NM)$\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<cmath>\nusing namespace std;\nint M,N,K;\nchar ZH[100010];\nint cng[26][26];\nint dp[100010][26];\nint dp2[100010][26];\nint qzh[100010][26];\nint cst(int L,int R,int B){\n\tint ans=0;\n\tfor(int i=0;i<M;i++)\n\t\tans+=(qzh[R][i]-qzh[L-1][i])*cng[i][B];\n\treturn ans;\n}\nint main(){\n\tscanf(\"%d %d %d\",&N,&M,&K);\n\tscanf(\" %s\",ZH+1);\n\tfor(int i=1;i<=N;i++){\n\t\tfor(int j=0;j<M;j++)\tqzh[i][j]=qzh[i-1][j];\n\t\t++qzh[i][(int)ZH[i]-'a'];\n\t}\n\tfor(int i=0;i<M;i++)\n\t\tfor(int j=0;j<M;j++)\n\t\t\tscanf(\"%d\",&cng[i][j]);\n\tfor(int k=0;k<M;k++)\n\t\tfor(int i=0;i<M;i++)\n\t\t\tfor(int j=0;j<M;j++)\n\t\t\t\tcng[i][j]=min(cng[i][j],cng[i][k]+cng[k][j]);\n\tmemset(dp,0x3f,sizeof(dp));\n\tmemset(dp2,0x3f,sizeof(dp2));\n\tfor(int j=0;j<M;j++){\n\t\tint u=0;dp2[0][j]=0;\n\t\tfor(int i=1;i<K;i++){\n\t\t\tu += cng[(int)ZH[i]-'a'][j];\n\t\t\tdp2[i][j]=u;\n\t\t}\n\t}\n\tfor(int i=K;i<=N;i++){\n\t\tfor(int j=0;j<M;j++)\n\t\t\t\tdp[i][j]=dp2[i-K][j]+cst(i-K+1,i,j);\n\t\tint p = 0x3f3f3f3f;\n\t\tfor(int j=0;j<M;j++)\tp=min(p,dp[i][j]);\n\t\tfor(int j=0;j<M;j++)\n\t\t\tdp2[i][j]=min(dp2[i-1][j]+cng[(int)ZH[i]-'a'][j],p);\n\t}\n\tint ans=2147483647;\n\tfor(int i=0;i<M;i++)\n\t\tans=min(ans,dp[N][i]);\n\tprintf(\"%d\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1576920293,
        "uid": 60864,
        "name": "tiger2005",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5839 \u3010[USACO19DEC]Moortal Cowmbat\u3011"
    },
    {
        "content": "\u8003\u8651\u5c06l-r\u6362\u4e3a\u989c\u8272k\uff0c\u4ee3\u4ef7\u4e3acost_k(l,r)\n\n\u663e\u7136\u53ef\u4ee5\u8f6c\u5316\u4e3acost_k(1,r)-cost(1,l-1);\n\n\u5bf9\u4e8e\u6bcf\u79cd\u989c\u8272k\uff0c\u6700\u4f18\u7684\u5408\u6cd5\u8f6c\u79fbj\uff0c\u4ee3\u4ef7\u4e3adp[j]+cost_k(j,i)\u3002\n\n\u8f6c\u79fb\u65f6\u679a\u4e3e\u989c\u8272\u53d6min.\n\n\u5f53\u65f6\u53d1\u61d2\uff0c\u76f4\u63a5\u5199\u4e86\u5806\uff0cO(nmlogn)\uff0c\u628a\u5806\u6362\u6210\u53d8\u91cf\u53ef\u4ee5O(nm)\n\nusaco\u8fc7\u4e86\uff0cluogu\u9700\u8981\u5438\u53e3\u6c27\u3002\n\n```cpp\n#include <iostream>\n#include <string>\n#include <queue>\n#include <cstdio>\nusing namespace std;\n#define int long long\nconst int kmaxn=100000+5;\nconst int kmaxm=30;\nint dp[kmaxn];\npriority_queue<int,vector<int>,greater<int> > q[kmaxm];\nint offset[kmaxm][kmaxn];\nint a[kmaxm][kmaxm];\nint n,m,K;\nstring s;\nconst int inf=1e9+7;\n#define T(x) (x-'a')\nsigned main()\n{\n\tcin>>n>>m>>K;\n\tcin>>s;\n\ts=\" \"+s;\n\tfor(int i=0;i<m;++i)\n\t{\n\t\tfor(int j=0;j<m;++j)\n\t\t{\n\t\t\tcin>>a[i][j];\n\t\t}\n\t}\n\tfor(int k=0;k<m;k++)\n\t{\n\t\tfor(int i=0;i<m;i++)\n\t\t{\n      \t\tfor(int j=0;j<m;j++) \n\t\t\t{\n            \ta[i][j]=min(a[i][j],a[i][k]+a[k][j]);\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=0;i<=n;++i)\n\t\tdp[i]=inf;\n\tfor(int k=0;k<m;++k)\n\t{\n\t\tint cost=0;\n\t\tfor(int i=1;i<=n;++i)\n\t\t{\n\t\t\tcost+=a[T(s[i])][k];\n\t\t\toffset[k][i]=cost;\n\t\t}\n\t}\n\tfor(int i=0;i<m;++i)\n\t\tq[i].push(0);\n\t\n\tfor(int i=K,pre=1;i<=n;++i,++pre)\n\t{\n\t\tdp[i]=inf;\n\t\tfor(int j=0;j<m;++j)\n\t\t{\n\t\t\tdp[i]=min(dp[i],q[j].top()+offset[j][i]);\n\t\t}\n\t\tfor(int j=0;j<m;++j)\n\t\t{\n\t\t\tq[j].push(dp[pre]-offset[j][pre]);\n\t\t}\n\t}\n\tcout<<dp[n]<<endl;\n\treturn 0;\n}\n```\n",
        "postTime": 1576801153,
        "uid": 56184,
        "name": "_\u8679_",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P5839 \u3010[USACO19DEC]Moortal Cowmbat\u3011"
    }
]
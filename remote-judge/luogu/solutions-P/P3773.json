[
    {
        "content": "[\u5b89\u5229blog](https://ctz45562.github.io/2019/10/10/%E6%B4%9B%E8%B0%B7-P3773-CTSC2017-%E5%90%89%E5%A4%AB%E7%89%B9/)\n\n[\u4f20\u9001\u95e8](https://www.luogu.org/problem/P3773)\n\n\u6211\u597d\u83dc\u554a\u8fde\u5362\u5361\u65af\u90fd\u4e0d\u4f1a\u4e86$QAQ$\n\n\u5362\u5361\u65af\u641e\u90a3\u4e00\u5768\u7ec4\u5408\u6570\uff1a\n\n$C_{a_i}^{a_j}\\equiv C_{a_i/2}^{a_j/2}\\times C_{a_i\\%2}^{a_j\\%2}\\pmod 2$\n\n\u540e\u9762\u90a3\u4e2a$C_{a_i\\%2}^{a_j\\%2}$\u6709\u56db\u79cd\u60c5\u51b5$C_0^0,C_0^1,C_1^0,C_1^1$\uff0c\u5176\u4e2d\u53ea\u6709$C_0^1=0$\u3002\n\n\u7136\u540e\u7ee7\u7eed\u5904\u7406$C_{a_i/2}^{a_j/2}$\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u4e0d\u5c31\u662f\u628a$a_i$\u548c$a_j$\u6309\u4e8c\u8fdb\u5236\u62c6\u4f4d\u4e86\u3002\u5176\u4e2d\u53ea\u8981\u51fa\u73b0\u8fc7$C_0^1$\uff0c$C_{a_i}^{a_j}$\u5c31\u4e3a$0$\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\u4e8c\u8fdb\u5236\u4e0b\u4e0d\u5b58\u5728\u67d0\u4e00\u4f4d$a_i$\u4e3a$0$\u800c$a_j$\u4e3a$1$\uff0c\u5373$a_j$\u4e8c\u8fdb\u5236\u4e0b\u662f$a_i$\u7684\u5b50\u96c6\u3002\n\n\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u6c42\u5b50\u5e8f\u5217\u7684\u4e2a\u6570\uff0c\u6ee1\u8db3\u6bcf\u4e00\u9879\u5728\u4e8c\u8fdb\u5236\u4e0b\u662f\u524d\u4e00\u9879\u7684\u5b50\u96c6\u3002\n\n$a_i\\le 233333$\u8fd8\u4e92\u4e0d\u76f8\u540c\uff0c\u76f4\u63a5\u8bbe$f(i)$\u4e3a\u4ee5$i$\u4e3a\u7ed3\u5c3e\u7684\u5b50\u5e8f\u5217\u4e2a\u6570\uff0c\u679a\u4e3e\u5b50\u96c6\u5237\u8868\u8f6c\u79fb\u5c31\u6ca1\u4e86\u3002\n\n\u800c\u4e14\u90fd\u662f\u5b83\u7684\u5b50\u96c6\u4e86\uff0c\u5c31\u4e0d\u7528\u8003\u8651\u5e8f\u5217\u7684\u5355\u8c03\u6027\u4e86\u3002\n\n\u590d\u6742\u5ea6\u5c31\u662f\u679a\u4e3e\u5b50\u96c6\u7684$O(3^{\\log_2\\max\\{a_i\\}})$\n\n\u975e\u5e38\u7b80\u77ed\u7684\u4ee3\u7801\uff1a\n\n``` cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cmath>\n#include <cstring>\n\n#define maxn 250005\n#define inf 0x3f3f3f3f\n\nconst int mod = 1e9 + 7;\n\nusing namespace std;\n\ninline int read(){\n\tint x=0,y=0;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')y=1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9')x=(x<<1)+(x<<3)+(ch^48),ch=getchar();\n\treturn y?-x:x;\n}\nint f[maxn];\nint main(){\n\tint n=read(),a,ans=0;\n\tfor(register int i=1;i<=n;++i){\n\t\ta=read();\n\t\tfor(register int S=a-1&a;S;S=S-1&a)(f[S]+=f[a]+1)%=mod;\n\t\t(ans+=f[a])%=mod;\n\t}\n\tprintf(\"%d\\n\",ans);\n}\n\n```\n\n",
        "postTime": 1570692010,
        "uid": 111762,
        "name": "_ctz",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3773 \u3010[CTSC2017]\u5409\u592b\u7279\u3011"
    },
    {
        "content": "[~~\u70b9\u51fb\u5c31\u9001\u5c60\u9f99\u5200~~ \u4e2a\u4eba\u535a\u5ba2\u5b89\u5229](https://blog.csdn.net/litble/article/details/80172715)\n\n~~\u89e3\u9898\u601d\u8def\uff1aB\u541b\u51fa\u7684\u9898\uff0c\u4e0d\u53ef\u505a~~\n\n**\u5982\u4f55\u5224\u65ad\u7ec4\u5408\u6570\u662f\u5426\u662f\u5947\u6570\uff1f**\n\n\u9996\u5148\uff0c$C_n^k=\\frac{n!}{k!(n-k)!}$\uff0c\u5047\u8bbe$n!$\u76842\u56e0\u5b50\u6570\u4e3a$a$\uff0c$k!$\u76842\u56e0\u5b50\u6570\u662f$b$\uff0c$(n-k)!$\u76842\u56e0\u5b50\u6570\u4e3a$c$\uff0c\u90a3\u4e48\u5982\u679c$C_n^k$\u662f\u5947\u6570\uff0c\u5219$a=b+c$\n\n\u600e\u4e48\u6c42\u51fa$x!$\u76842\u56e0\u5b50\u4e2a\u6570\u5462\uff1f\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u5c06x\u9664\u4ee52\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u63d0\u53d6\u516c\u56e0\u6570\u7684\u8fc7\u7a0b\uff0c\u800c\u90a3\u4e9b\u4e0d\u80fd\u88ab2\u6574\u9664\u7684\u9879\u5c31\u4f1a\u88ab\u4e22\u6389\uff0c\u4e8e\u662f\u5269\u4e0b\u6765\u7684\u662f$2*(\\frac{x}{2}!)$\uff0c\u4e00\u76f4\u8fd9\u6837\u5904\u7406\u4e0b\u53bb\uff0c\u5f97\u5230\u7b54\u6848\u4e3a\n\n$$f(x)=\\sum_{i=1}^{ \\infty} \\frac{x}{2^i}$$\n\n\u6211\u4eec\u8bbe$g(x)=x$\uff0c\u90a3\u4e48$g(x)=g(\\frac{x}{2})+\\frac{x}{2}+(x\\bmod 2)=\\sum_{i=1}^{ \\infty} \\frac{x}{2^i}+$(x\u5728\u4e8c\u8fdb\u5236\u4e0b1\u7684\u4e2a\u6570\uff09\n\u6240\u4ee5$x!$\u76842\u56e0\u5b50\u4e2a\u6570\u5c31\u662f(x-x\u5728\u4e8c\u8fdb\u5236\u4e0b1\u7684\u4e2a\u6570)\n\n\u90a3\u4e48$C_n^k$\u662f\u5947\u6570\u7684\u6761\u4ef6\u5373\u4e3a\uff1an\u5728\u4e8c\u8fdb\u5236\u4e0b1\u7684\u4e2a\u6570=k\u5728\u4e8c\u8fdb\u5236\u4e0b1\u7684\u4e2a\u6570+(n-k)\u5728\u4e8c\u8fdb\u5236\u4e0b1\u7684\u4e2a\u6570\u3002\n\n\u5047\u8bbe\u4e8c\u8fdb\u5236\u4e0b\uff0cn\u62e5\u6709\u7684\u67d0\u4e00\u4e2a1\uff0ck\u5e76\u6ca1\u6709\uff0c\u90a3\u4e48\uff1a\n\nn: ...0...\n\nk: ...1...\n\nn-k: ...11....\n\n\u4f1a\u53d1\u73b0k\u548c(n-k)\u4e8c\u8fdb\u5236\u4e0b1\u7684\u4e2a\u6570\u548c\u4e00\u5b9a\u4f1a\u5927\u4e8en\uff0c\u6240\u4ee5\u5fc5\u987bk\u6240\u6709\u76841 n\u90fd\u62e5\u6709\u624d\u80fd\u7b26\u5408\u6761\u4ef6\uff0c\u7efc\u4e0a\uff0c$C_n^k$\u662f\u5947\u6570\u7684\u6761\u4ef6\u4e3a\uff1a`(n&k)=k`\n\n\u90a3\u4e48\u540e\u9762\u7684\u4e8b\u60c5\u5c31\u7b80\u5355\u4e86\uff0c\u8bbe$f_i$\u8868\u793a\u4ee5$a_i$\u5f00\u5934\u7684\u5b50\u5e8f\u5217\u4e2a\u6570\uff0c\u7528\u6876\u5b58\u6bcf\u4e00\u4e2a$a_i$\u51fa\u73b0\u7684\u4f4d\u7f6e$i$\u3002\u8ba1\u7b97$f_i$\u65f6\uff0c\u8003\u8651\u4e0b\u4e00\u4e2a\u653e\u4ec0\u4e48\uff0c\u4e5f\u5c31\u662f\u679a\u4e3e$a_i$\u7684\u5b50\u96c6\uff0c\u5224\u65ad\u8fd9\u4e2a\u6570\u662f\u5426\u5728$i$\u540e\u9762\uff0c\u7136\u540e\u7edf\u8ba1\u65b9\u6848\u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6\u662f$O(3^{\\log maxa})$\u7684\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define RI register int\nint read() {\n\tint q=0;char ch=' ';\n\twhile(ch<'0'||ch>'9') ch=getchar();\n\twhile(ch>='0'&&ch<='9') q=q*10+ch-'0',ch=getchar();\n\treturn q;\n}\nconst int N=240000,mod=1000000007;\nint a[N],T[N],f[N];\nint n,ans;\nint qm(int x) {return x>=mod?x-mod:x;}\nint main()\n{\n\tn=read();\n\tfor(RI i=1;i<=n;++i) a[i]=read(),T[a[i]]=i;\n\tfor(RI i=n;i>=1;--i) {\n\t\tf[i]=1;\n\t\tfor(RI j=a[i]&(a[i]-1);j;j=a[i]&(j-1))\n\t\t\tif(T[j]>i) f[i]=qm(f[i]+f[T[j]]);\n\t\tans=qm(ans+f[i]);\n\t}\n\tans=(ans-n+mod)%mod;\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1525269497,
        "uid": 20604,
        "name": "litble",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P3773 \u3010[CTSC2017]\u5409\u592b\u7279\u3011"
    },
    {
        "content": "\u4e00\u9053\u4e0d\u96be\u4f46\u662f\u62d6\u4e86\u5f88\u4e45\u7684\u9898,\u6211\u8fd9\u4e2a\u50bb\u903c\u6d3b\u8be5\u8981\u9000\u5f79.\n\n[Click here to read the problem.](https://www.luogu.org/problemnew/show/P3773)\n\n\u4ee4 $N= log_2(max_{a_i})$.\n\u7f51\u4e0a\u5f88\u591a $3^N$ \u7684\u505a\u6cd5,\u4e0d\u5177\u4f53\u8bf4\u4e86,\u5927\u6982\u5c31\u662f$dp[x]$\u4ee3\u8868\u4ee5$x$\u7ed3\u5c3e\u7684\u65b9\u6848\u6570.\n\n\u8003\u8651\u5206\u5757,\u628a\u6570\u5b57\u4e8c\u8fdb\u5236\u4e0b\u5206\u6210\u524d\u4e00\u6bb5\u548c\u540e\u4e00\u6bb5.\n\u8bbe$f[u][v] = \\sum_{v \\in x}*dp[u*2^\\frac{N}{2}+x]$.\u5373\u524d\u4e00\u534a\u4e3a$u$,\u540e\u4e00\u534a$v$\u7684\u8d85\u96c6\u7684\u65b9\u6848\u6570\u4e4b\u548c.(\u8d85\u96c6\u5c31\u662f\u5b50\u96c6\u7684\u8865\u96c6).\n\n\u6bcf\u52a0\u8fdb\u4e00\u4e2a\u6570\u5b57,\u679a\u4e3e\u524d\u4e00\u534a\u7684\u8d85\u96c6,\u8ba1\u7b97\u7b54\u6848;\u518d\u679a\u4e3e\u540e\u4e00\u534a\u7684\u5b50\u96c6,\u56e0\u4e3a\u8fd9\u4e2a\u6570\u5b57\u7ed3\u5c3e\u7684\u7b54\u6848\u5c06\u5f71\u54cd\u540e\u4e00\u534a\u5b50\u96c6\u7684$f$\u503c.\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(6^\\frac{N}{2})$.\n\n```cpp\n#include <bits/stdc++.h>\n#define LL long long\nusing namespace std ;\ntemplate <class T> void Read ( T &x, char c = getchar(), bool f = 0 ) {\n\tfor ( x = 0 ; !isdigit(c) ; c = getchar() ) f |= c == '-' ;\n\tfor ( ; isdigit(c) ; c = getchar() ) x = 10*x + c - '0' ;\n\tif (f) x = -x ;\n}\nconst int maxn = 220000, Mod = 1000000007 ;\nint n, m, S, f[520][520] ;\nint main() {\n\tint i, x, u, v, val, ans = 0 ;\n\tRead(n) ;\n\tm = 1<<9, S = m-1 ;\n\tfor ( i = 1 ; i <= n ; i ++ ) {\n\t\tRead(x) ;\n\t\tu = x/m, v = x%m ;\n\t\tval = 1 ;\n\t\tfor ( x = u^S ; x ; x = (x-1)&(u^S) )\n\t\t\tif (f[x|u][v]) (val += f[x|u][v]) %= Mod ;\n\t\t(val += f[u][v]) %= Mod ;\n\t\tfor ( x = v ; x ; x = (x-1)&v ) (f[u][x] += val) %= Mod ;\n\t\t(f[u][0] += val) %= Mod ;\n\t}\n\tfor ( i = 0 ; i <= S ; i ++ )\n\t\t(ans += f[i][0]) %= Mod ;\n\t(ans += Mod-n) %= Mod ;\n\tcout << ans << endl ;\n\treturn 0 ;\n}\n```",
        "postTime": 1530365445,
        "uid": 39497,
        "name": "GoAway",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3773 \u3010[CTSC2017]\u5409\u592b\u7279\u3011"
    },
    {
        "content": "~~[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/SovietPower/p/9775319.html)~~\n\n\u9996\u5148$C(n,m)$\u4e3a\u5947\u6570\u5f53\u4e14\u4ec5\u5f53$n\\&m=m$\u3002\u8bc1\u660e\u4e0d\u518d\u5728\u8fd9\u5199\u4e86\u3002\n\n\u56e0\u4e3a\u8981\u6ee1\u8db3$n\\&m=m$\uff0c\u6240\u4ee5\u9898\u610f\u5373\u4e3a\uff0c\u6709\u591a\u5c11\u4e2a$a$\u7684\u5b50\u5e8f\u5217$b$\uff0c\u6ee1\u8db3$b_i\\&b_{i+1}=b_{i+1}$\u3002\n\n\u4ee4$f[i]$\u8868\u793a\u4ee5$A[i]$\u7ed3\u5c3e\u7684\u5408\u6cd5\u5b50\u5e8f\u5217\u6570\u3002\n\u90a3\u4e48\u6709\u4e24\u79cd\u663e\u7136\u7684\u65b9\u5f0f\uff1a\n\n1. \u679a\u4e3e$i$\uff0c$ans+=f[i]$\uff0c\u518d\u66f4\u65b0\u540e\u9762\u6ee1\u8db3 $A[j]$\u7684\u4e8c\u8fdb\u5236\u4f4d\u662f$A[i]$\u4e8c\u8fdb\u5236\u4f4d\u7684\u5b50\u96c6 \u7684$j$\uff0c$f[j]+=f[i]$\u3002\n\n2. \u679a\u4e3e$i$\uff0c\u679a\u4e3e$j$\uff0c\u6c42$f[i]=\\sum_{j<i}f[j]$($j$\u6ee1\u8db3$A[j]$\u662f$A[i]$\u7684\u8d85\u96c6)\uff0c\u7136\u540e$ans+=f[i]$\u3002\n\n\u4e24\u79cd\u90fd\u662f\u679a\u4e3e\u5b50\u96c6\u3002\u7b2c\u4e00\u79cd\u662f\u4e0d\u9700\u8981\u67e5\u8be2\uff0c\u8f6c\u79fb$O(3^{18})$\uff1b\u7b2c\u4e8c\u79cd\u662f\u67e5\u8be2$O(3^{18})$\uff0c\u4e0d\u9700\u8981\u8f6c\u79fb\u3002\n\n\uff08\u6574\u4e2a\u7b97\u6cd5\u5b9e\u9645\u4e0a\u662f\u5bf9\u6bcf\u4e2a$a_i$\u7684\u4e8c\u8fdb\u5236\u8868\u793a\u679a\u4e3e\u4e86\u5b83\u7684\u5b50\u96c6\uff0c\u800c$a_i$\u4e92\u4e0d\u76f8\u540c\uff0c\u76f8\u5f53\u4e8e\u662f\u5bf9\u6240\u6709\u4e8c\u8fdb\u5236\u5b50\u96c6\u679a\u4e3e\u4e86\u5b83\u7684\u5b50\u96c6\uff0c\u6240\u4ee5\u590d\u6742\u5ea6\u662f$3^{\\log a_{max}}=3^{18}$\uff09\n\n\u8fd9\u6837\u597d\u50cf\u6bd4\u8f83\u5371\u9669\uff1f\uff08\u6bd4\u5982\u51fa\u4e8c\u8fdb\u5236$1$\u5f88\u591a\u7684$a_i$\uff09\n\n------------\n\u6211\u4eec\u5c06\u8fd9\u4e24\u79cd\u65b9\u5f0f\u7efc\u5408\u4e00\u4e0b\uff1a\n\n\u8f6c\u79fb\u65f6\uff0c\u56fa\u5b9a$i$\u7684\u540e$9$\u4f4d\uff0c\u679a\u4e3e$i$\u524d$9$\u4f4d\u7684\u5b50\u96c6$j$\uff0c\u7528$f[i]$\u66f4\u65b0\u540e\u9762\u7684$f[j]$\uff1b\n\n\u6c42\u503c\u65f6\uff0c\u56fa\u5b9a$i$\u7684\u524d$9$\u4f4d\uff0c\u679a\u4e3e$i$\u540e$9$\u4f4d\u7684\u8d85\u96c6$j$\uff0c\u4ece\u524d\u9762\u7684$f[j]$\u8f6c\u79fb\uff0c\u5373$f[i]=\\sum f[j]$\u3002\n\n\u8fd9\u6837\u590d\u6742\u5ea6\u662f\u5565\u554a\u3002\u3002\u6211\u4e0d\u77e5\u9053\uff0c\u53cd\u6b63\u9760\u8c31\u5f88\u591a\u3002\u7136\u540e\u5c31\u53ef\u4ee5200ms\u5185AC\u4e86\u3002\n\n~~dls\u73b0\u573a\u5206\u6790\uff1a\u5927\u6982\u662f\u4ece\u4e4b\u524d\u7684$2^{\\log_23\\cdot n}=2^{1.59n}$\u4f18\u5316\u5230\u4e86$2^{1.5n}$\u3002\n\u8003\u8651\u679a\u4e3e\u4e0d\u6ee1\uff0c\u5927\u6982\u6709$2^{(0.6+\\frac{1.59}{2})n}=2^{1.3n+}$\uff1f~~\n\nby the way\uff0c\u597d\u50cf\u5f88\u591a\u4eba\u4e0d\u77e5\u9053\u679a\u4e3e\u5b50\u96c6\u4e3a\u4ec0\u4e48\u662f$3^n$\u7684\u3002\n> \u8bc1\u660e\uff1a\u8bbe\u96c6\u5408\u6709$n$\u4e2a\u5143\u7d20\uff0c\u6211\u4eec\u628a\u6240\u6709\u5b50\u96c6$s$\u6309\u5143\u7d20\u4e2a\u6570$k=|s|$\u5206\u7c7b\uff08\u56e0\u4e3a\u5b83\u4eec\u7684\u5b50\u96c6\u90fd\u4e3a$2^k$\u4e2a\u3002\u90a3\u4e48\u679a\u4e3e\u7684\u96c6\u5408\u6570\u4e3a\uff1a$$\\sum_{k=0}^nC_{n}^k2^k=(1+2)^n=3^n$$\n\n------------\n```cpp\n#include <cstdio>\n#include <cctype>\n#include <algorithm>\n#define gc() getchar()\n#define mod 1000000007\n#define Mod(x) x>=mod&&(x-=mod)\ntypedef long long LL;\nconst int N=(1<<18)+3,L=(1<<9)-1;\n\ninline int read()\n{\n\tint now=0;register char c=gc();\n\tfor(;!isdigit(c);c=gc());\n\tfor(;isdigit(c);now=now*10+c-'0',c=gc());\n\treturn now;\n}\n\nint main()\n{\n\tstatic int f[N];\n\tint n=read(); LL ans=0,sum;\n\tfor(int i=1,a; i<=n; ++i)\n\t{\n\t\ta=read(),sum=0;\n\t\tint l=a&L, r=a>>9;\n\t\tfor(int j=r; j<=L; j=(j+1)|r)\n\t\t\tsum+=f[(j<<9)|l];\n\t\tans+=sum%=mod, ++sum;\n\t\tr<<=9;\n\t\tfor(int j=l; j; j=(j-1)&l)\n\t\t\tf[j|r]+=sum, Mod(f[j|r]);\n\t\tf[r]+=sum, Mod(f[r]);//0|r\n\t}\n\tprintf(\"%lld\\n\",ans%mod);\n\n\treturn 0;\n}\n```\n\n------------",
        "postTime": 1539266674,
        "uid": 39887,
        "name": "SovietPower\u2728",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3773 \u3010[CTSC2017]\u5409\u592b\u7279\u3011"
    },
    {
        "content": "# \u5e7f\u544a\n\n[\u8fd9\u91cc\u89c2\u8d4f\u4f53\u9a8c\u66f4\u4f73](https://www.cnblogs.com/dedicatus545/p/9261490.html)\n\n# \u601d\u8def\n\n\u4e00\u53e5\u8bdd\u9898\u610f\uff1a\n\n\u7ed9\u51fa\u4e00\u4e2a\u957f\u5ea6\u4e3a n \u7684\u5e8f\u5217\uff0c\u6c42\u6240\u6709\u957f\u5ea6\u5927\u4e8e\u7b49\u4e8e2\u7684\u5b50\u5e8f\u5217\u4e2a\u6570\uff0c\u6ee1\u8db3\uff1a\u5bf9\u4e8e\u5b50\u5e8f\u5217\u4e2d\u4efb\u610f\u4e24\u4e2a\u76f8\u90bb\u7684\u6570 a\u548c b \uff08b \u5728 a \u524d\u9762\uff09\uff0c$C_a^b mod 2=1$\uff0c\u7b54\u6848\u5bf91e9+7\u53d6\u6a21\n\n\u663e\u7136\u819c2\u4f591\u662f\u4e2a\u975e\u5e38\u7279\u6b8a\u7684\u6027\u8d28\uff0c\u5e94\u5f53\u597d\u597d\u52a0\u4ee5\u5229\u7528\n\n\u548c\u7ec4\u5408\u6570\u53d6\u6a21\u6709\u5173\u7684\u4e1c\u897f\uff0c\u6709Lucas\u5b9a\u7406\uff0c\u56e0\u6b64\u6211\u4eec\u6765\u8bd5\u7740\u63a8\u4e00\u63a8\n\n$C_n^m\\;mod\\;2=C_{n\\;mod\\;2}^{m\\;mod\\;2}\\ast C_{n/2}^{m/2}$\n\n\u8fd9\u4e2a\u73a9\u610f\u7684\u610f\u4e49\uff0c\u663e\u7136\u5c31\u662f\u628an\u548cm\u8f6c\u6210\u4e8c\u8fdb\u5236\uff0c\u90a3\u4e48\u53ea\u8981\u6ca1\u6709\u67d0\u4e00\u4f4d\u4e0an\u662f0m\u662f1\uff08\u6b64\u65f6$C_0^1$\u65e0\u610f\u4e49\uff0c\u89c6\u4f5c0\uff09\u5c31OK\u4e86\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u628a\u95ee\u9898\u8f6c\u5316\u6210\u4e86\u4e00\u4e2a\u53ef\u4ee5DP\u7684\u95ee\u9898\n\n\u8bbedp[i]\u8868\u793a\u5e8f\u5217$[i,n]$\u4e2d\u53ef\u80fd\u7684\u79cd\u7c7b\u6570\uff0c\u90a3\u4e48\u53ef\u4ee5\u901a\u8fc7\u679a\u4e3e$a[i]$\u548c\u54ea\u4e9b\u6570\u6ee1\u8db3\u4e0a\u5c5e\u6027\u8d28\n\n\u8fd9\u4e2a\u679a\u4e3e\u8fc7\u7a0b\u53ef\u4ee5\u5de7\u5999\u5730\u5229\u7528$j=(j+1)|a[i]$\u6765\u5b8c\u6210\uff0c\u76f8\u5f53\u4e8e\u662f\u628a$a[i]$\u76840\u4e00\u4e2a\u4e2a\u53d8\u62101\n\n\u603b\u6548\u7387\u4e0d\u592a\u4f1a\u7b97\uff0c\u4f46\u662fO(\u80fd\u8fc7)\u8fd8\u662f\u6709\u7684\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define ll long long\nusing namespace std;\ninline ll read(){\n    ll re=0,flag=1;char ch=getchar();\n    while(ch<'0'||ch>'9'){\n        if(ch=='-') flag=-1;\n        ch=getchar();\n    }\n    while(ch>='0'&&ch<='9') re=(re<<1)+(re<<3)+ch-'0',ch=getchar();\n    return re*flag;\n}\nll MOD=1e9+7; \nll n,a[300010],dp[300010],lim=233333;\nll pl(ll a,ll b){\n    return (a+b>MOD)?a+b-MOD:a+b;\n}\nint main(){\n    n=read();ll i,j,ans=0;\n    for(i=1;i<=n;i++) a[i]=read();\n    for(i=n;i>=1;i--){\n        for(j=a[i];j>=1;j=(a[i]&(j-1))){//\u6ce8\u610f\u679a\u4e3e\u65b9\u6cd5\n            dp[a[i]]=pl(dp[a[i]],dp[j]);\n        }\n        ans=pl(ans,dp[a[i]]);\n        dp[a[i]]=pl(dp[a[i]],1);\n    }\n    printf(\"%I64d\\n\",ans); \n}\n```",
        "postTime": 1530661465,
        "uid": 27753,
        "name": "Orion545",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3773 \u3010[CTSC2017]\u5409\u592b\u7279\u3011"
    },
    {
        "content": "\u9898\u610f\uff1a\u6c42\u6709\u591a\u5c11\u5b50\u5e8f\u5217 $a_{b_1},a_{b_2},\\dots,a_{b_m}$ \u6ee1\u8db3 \u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a $i \\in[1,m-1]$ \uff0c\u5747\u6709 $\\binom {a_{b_i}}{a_{b_{i+1}}} \\mod 2=1$\u3002\n\n\u6839\u636e AGC \u67d0\u9898\u7684\u7ed3\u8bba\uff0c$\\binom n m \\equiv 1 (\\mod 2)$ \u5f53\u4e14\u4ec5\u5f53 $n \\  \\& \\ m =m$\n\n\u81f3\u4e8e\u8bc1\u660e\u7684\u8bdd\uff0c\u8003\u8651 $\\operatorname{Lucas}$\uff0c $\\binom n m\\equiv \\binom {n/2}{m/2} \\times \\binom{n \\mod 2}{m \\mod 2}\\ (\\mod 2)$\n\n\n\u8003\u8651 `dp` \u4e86\uff0c\u8bbe $f_{i}$ \u4e3a\u4ee5 $i$ \u4e3a\u7ec8\u70b9\u7684\u6ee1\u8db3\u9898\u610f\u7684\u5b50\u5e8f\u5217\u4e2a\u6570\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $i$\uff0c\u5411 $a_i$ \u7684\u5b50\u96c6\u8f6c\u79fb\u5373\u53ef\u3002\n\n\u4ee3\u7801\u5c31\u4e0d\u653e\u4e86\u3002",
        "postTime": 1600441083,
        "uid": 344016,
        "name": "wurzang",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3773 \u3010[CTSC2017]\u5409\u592b\u7279\u3011"
    },
    {
        "content": "\u697c\u4e0b\u8bf4\u7684\u8fd9\u4e2a\u7ed3\u8bba\u4f30\u8ba1\u5f88\u591a\u50cf\u6211\u4e00\u6837\u7684\u849f\u84bb\u4f1a\u61f5\u6389\u5427\u3002\u3002\u3002\n\n\u90a3\u4e48\u4e3a\u4e86\u5e2e\u52a9\u5927\u5bb6\u7406\u89e3\u6211\u5c31\u6765\u8bc1\u660e\u4e00\u4e0b\u8fd9\u4e2a\u7ed3\u8bba\u5427\n\n\n\u6211\u4eec\u5047\u8bbe(n&m)==m,\u90a3\u4e48\u5148\u5047\u8bbe\u8fd9\u4e2a\u7ed3\u8bba\u662f\u5bf9\u7684\uff0c\u770b\u80fd\u4e0d\u80fd\u627e\u5230\u53cd\u4f8b\u63a8\u7ffb\u5b83\u3002\n\n\n1.\u5f53m\u7684\u4e8c\u8fdb\u5236\u6700\u53f3\u4f4d\u662f1\u65f6\uff1a\n\n\u8fd9\u65f6n\u7684\u4e8c\u8fdb\u5236\u6700\u53f3\u4f4d\u80af\u5b9a\u662f1\uff0c\u6240\u4ee5((n-1)&(m-1))==m-1,\u53ef\u4ee5\u9012\u5f52\u8bc1\u660eC(n-1,m-1)\u662f\u5947\u6570\uff1b\n\n\u53c8\u56e0\u4e3a((n-1)&m)!=m,\u56e0\u4e3an-1\u7684\u4e8c\u8fdb\u5236\u6700\u53f3\u4f4d\u6ca1\u67091\u4e86\uff0c\u6240\u4ee5\u53ef\u4ee5\u9012\u5f52\u8bc1\u660e C(n-1,m)\u662f\u5076\u6570\uff0c\n\n\u8fdb\u800c\u53ef\u4ee5\u8bc1\u660e C(n,m)\u662f\u5947\u6570\u3002\n\n\n2.m\u4e8c\u8fdb\u5236\u6700\u53f3\u4f4d\u4e0d\u662f1\u65f6\uff1a\n\n\u8fd9\u6837(m-1)\u7684\u4e8c\u8fdb\u5236\u6700\u53f3\u7aef\u663e\u7136\u4f1a\u6709\u4e00\u63921(\u957f\u5ea6>=1)\u3002\n\n(1):\u5982\u679c\u6b64\u65f6n\u7684\u4e8c\u8fdb\u5236\u6700\u53f3\u4f4d\u76841\u548cm\u662f\u76f8\u540c\u7684\u4f4d\u7f6e\uff0c\u90a3\u4e48\u4f9d\u7136\u6ee1\u8db3((n-1)&(m-1))==m-1\u3002\n\n\u6709\u56e0\u4e3an\u7684\u4e8c\u8fdb\u5236\u6700\u53f3\u4f4d\u76841\u5728n\u51cf\u53bb1\u4e4b\u540e\u88ab\u6d88\u53bb\u4e86\uff0c\u6240\u4ee5\u6b64\u65f6((n-1)&m)!=m\uff0c\u4ecd\u53ef\u8bc1\u660eC(n,m)\u662f\u5947\u6570\u3002\n\n\n(2):\u5982\u679cn\u4e8c\u8fdb\u5236\u6700\u53f3\u4f4d\u76841\u5728m\u4e8c\u8fdb\u5236\u6700\u53f3\u4f4d1\u7684\u53f3\u8fb9\uff0c\u90a3\u4e48\u51cf\u53bb1\u540e\uff0cm\u53f3\u7aef\u8fde\u7eed\u7684\u53d8\u62101\u7684\u5e8f\u5217\u4f1a\u957f\u4e8en\uff0c\u6bd4\u5982m=10100(2),n=10110(2),\u90a3\u4e48m-1=10011,n-1=10101,2^1\u8fd9\u4f4dm-1\u662f1\u800cn-1\u4e0d\u662f1\uff0c\u6240\u4ee5\u6b64\u65f6((n-1)&(m-1))!=m-1;\u53c8\u56e0\u4e3an\u51cf\u53bb1\u4e4b\u540e\u5e76\u4e0d\u5f71\u54cd\u6700\u53f3\u7aef1\u5de6\u8fb9\u90a3\u4e9b1\uff0c\u6240\u4ee5\u53ef\u4ee5\u8bc1\u660e((n-1)&m)==m,\u8fd9\u6837\u53c8\u8bc1\u660e\u4e86C(n,m)\u662f\u5947\u6570\u3002\n\n   \n\u4ee3\u7801\u697c\u4e0a\u7684\u5c31\u6bd4\u8f83\u597d\u4e86\uff0c\u6211\u5c31\u4e0d\u8d34\u6211\u7684\u4e11\u4ee3\u7801\u4e86hhh\n",
        "postTime": 1514025259,
        "uid": 31377,
        "name": "\u91d1\u7237\u7237\u54c8\u54c8",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3773 \u3010[CTSC2017]\u5409\u592b\u7279\u3011"
    },
    {
        "content": "## \u9898\u610f\u7b80\u8ff0\r\n\r\n\u6c42\u6ee1\u8db3\r\n\r\n$$\\prod _{i=2}^{k} \\binom{a_{b_{i-1}}}{a_{b_i}} \\mod 2 = \\binom{a_{b_1}}{a_{b_2}} \\times \\binom{a_{b_2}}{a_{b_3}} \\times \\cdots \\binom{a_{b_{k-1}}}{a_{b_k}} \\mod 2 > 0$$\r\n\r\n\u7684\u5b50\u5e8f\u5217\u4e2a\u6570\u3002\r\n\r\n## \u9898\u89e3\r\n\r\n\u54c7\u54e6\u3002\r\n\r\n$$\r\n\\begin{aligned}\r\n&\\ \\ \\ \\ \\prod_{i=2}^{k}{a_{b_{i}-1}\\choose a_{b_{i}}} \\\\\r\n&\\equiv\\prod_{i=2}^{k}{\\lfloor\\frac{a_{b_{i}-1}}{2}\\rfloor\\choose\\lfloor\\frac{a_{b_{i}}}{2}\\rfloor}\\times{a_{b_{i}-1}\\bmod2\\choose a_{b_{i}}\\bmod2}\r\n\\end{aligned}\r\n(\\operatorname{mod} 2)\r\n$$\r\n\r\n\u5f0f\u5b50\u540e\u9762\u7684 $\\dbinom{a_{b_{i}-1}\\bmod2}{a_{b_{i}\\bmod2}}$ \u4e00\u5171\u6709\u56db\u79cd\u60c5\u51b5\uff0c\u5176\u4e2d\u53ea\u6709 $\\dbinom{0}{1}=0$\u3002\u5176\u4ed6\u90fd\u4e3a $1$\u3002\r\n\r\n\u610f\u5473\u7740\u53ea\u8981\u51fa\u73b0 $a_{b_{i}-1}\\equiv0\\bmod2$ \u4e14 $a_{b_{i}}\\equiv1\\bmod1$ \u7684\u60c5\u51b5\uff0c\u6574\u4e2a\u5f0f\u5b50\u5c31\u4e3a\u96f6\u4e86\u3002\r\n\r\n\u7ed3\u8bba\uff1a$\\dbinom{n}{m}\\equiv0\\space(\\operatorname{mod}2)$ \u5f53\u4e14\u4ec5\u5f53 $n\\operatorname{bitand}m=m$\u3002\r\n\r\n\u8bc1\u660e\uff08\u4e5f\u8bb8\u4e0d\u662f\u7279\u522b\u4e25\u8c28\uff09\uff1a\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff1a\r\n$$\r\n{n\\choose m}={\\lfloor\\frac{n}{2}\\rfloor\\choose\\lfloor\\frac{m}{2}\\rfloor}\\times{n\\bmod 2\\choose m\\bmod2}={\\lfloor\\frac{\\lfloor\\frac{n}{2}\\rfloor}{2}\\rfloor\\choose\\lfloor\\frac{\\lfloor\\frac{m}{2}\\rfloor}{2}\\rfloor}\\times {\\lfloor\\frac{n}{2}\\rfloor\\bmod2\\choose\\lfloor\\frac{m}{2}\\rfloor\\bmod2}\\times{n\\bmod 2\\choose m\\bmod2}=\\cdots\r\n$$\r\n\u6211\u4eec\u53d1\u73b0\uff1a\r\n$$\r\n{\\lfloor\\frac{\\lfloor\\frac{\\lfloor\\frac{n}{2}\\rfloor}{2}\\rfloor}{\\cdots}\\rfloor\\choose\\lfloor\\frac{\\lfloor\\frac{\\lfloor\\frac{m}{2}\\rfloor}{2}\\rfloor}{\\cdots}\\rfloor}\r\n$$\r\n\u8fd9\u4e00\u5768\uff0c\u5c31\u662f\u5728\u4e00\u76f4\u8fdb\u884c\u4e8c\u8fdb\u5236\u79fb\u4f4d\uff0c$\\operatorname{shr}1$\u3002\r\n\r\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5f97\u51fa\u4e00\u4e2a\u7ed3\u8bba\uff1a\u5982\u679c\u5bf9\u4e8e\u6211\u4eec\u8bb0 $(n)_{k}$ \u8868\u793a $n$ \u5728\u4e8c\u8fdb\u5236\u610f\u4e49\u4e0b\u7684\u7b2c $k$ \u4f4d\u3002$(n)_{k}\\in[0,1]$\r\n\r\n\u90a3\u4e48\u5bf9\u4e8e $\\forall i$\uff0c\u6709 $(n)_{i}=0$ \u4e14 $(m)_{i}=1$\uff0c\u90a3\u4e48 $\\dbinom{n}{m}\\equiv0\\space(\\operatorname{mod} 2)$\u3002\r\n\r\n\u6240\u4ee5 $n\\operatorname{bitand}m=m$\uff0c\u8bc1\u6bd5\u3002\r\n\r\n\u6211\u4eec\u9898\u76ee\u8981\u6c42\u7684\u662f\u6700\u540e\u7b97\u51fa\u6765\u662f\u4e2a\u5947\u6570\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd\u5b58\u5728 $a_{b_{i}-1}\\operatorname{bitand}a_{b_{i}}=a_{b_{i}}$\u3002\r\n\r\n\u4e5f\u5c31\u662f $a_{b_{i}}$ \u4e3a $a_{b_{i}-1}$ \u7684\u5b50\u96c6\u3002\r\n\r\n\u63a5\u4e0b\u6765\u6211\u4eec\u53ef\u4ee5\u8bbe\u8ba1\u4e00\u4e2a DP\uff0c\u6211\u4eec\u8bbe $f_{i}$ \u4e3a\u4ee5 $a_{i}$ \u4e3a\u5f00\u5934\u7684\u7b54\u6848\u3002\r\n\r\n\u90a3\u4e48\u8f6c\u79fb\u5c31\u662f\u52a0\u6cd5\u539f\u7406\uff1a\r\n$$\r\nf_{i}=f_{i}+f_{j},j\\in a_{i}\\wedge t_{j}>i\r\n$$\r\n\u5176\u4e2d $t_{i}$ \u8868\u793a $i$ \u5728\u5e8f\u5217\u4e2d\u7684\u4f4d\u7f6e\u3002\r\n\r\n\u65f6\u95f4\u590d\u6742\u5ea6\u7531\u4e8c\u9879\u5f0f\u5b9a\u7406\u53ef\u77e5\u662f $\\Theta(3^{\\log_{2}\\max\\{a_{i}\\}})$\u3002\r\n\r\n```cpp\r\n#include <cstdio>\r\n#define mod ( 1000000007 )\r\n\r\nconst int MAXN = 250000 + 5;\r\n\r\nint N;\r\nint val[MAXN], dp[MAXN];\r\nint buc[MAXN];\r\n\r\nint main( ){\r\n\tscanf( \"%d\", &N ); for( int i = 1; i <= N; ++ i ){ scanf( \"%d\", &val[i] ); buc[val[i]] = i; }\r\n\tint Ans = 0;\r\n\tfor( int i = N; i; -- i ){\r\n\t\tdp[i] = 1;\r\n\t\tfor( int j = val[i] & ( val[i] - 1 ); j; j = ( j - 1 ) & val[i] ){\r\n\t\t\tif( buc[j] > i )\tdp[i] = ( dp[i] + dp[buc[j]] ) % mod;\r\n\t\t}\r\n\t\tAns = ( Ans + dp[i] ) % mod;\r\n\t}\r\n\tprintf( \"%d\\n\", ( Ans - N + mod ) % mod );\r\n\treturn 0;\r\n}\r\n```",
        "postTime": 1605425458,
        "uid": 161849,
        "name": "cirnovsky",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3773 \u3010[CTSC2017]\u5409\u592b\u7279\u3011"
    },
    {
        "content": "- [P3773 [CTSC2017]\u5409\u592b\u7279](https://www.luogu.com.cn/problem/P3773)\n\n- \u9898\u610f\u63cf\u8ff0\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6b63\u6574\u6570\u5e8f\u5217 $a_1,a_2,\\cdots ,a_n$\uff0c\u5176\u4e2d\u5bf9\u4e8e $\\forall i,j\\in[1,n]\\cap i < j$\uff0c\u6709 $a_i\\neq a_j$\uff0c\u95ee\u6709\u591a\u5c11\u4e2a\u957f\u5ea6 $\\ge 2$ \u7684\u5b50\u5e8f\u5217 $b_1,b_2\\cdots b_m$\uff0c\u6ee1\u8db3\u6bcf\u4e2a\u6570\u5728\u4e8c\u8fdb\u5236\u4e0b\u770b\u4f5c\u96c6\u5408\u540e\uff0c\u5bf9\u4e8e $\\forall i \\in [2,n]$\uff0c\u6709 $b_i$ \u662f $b_{i-1}$ \u7684\u5b50\u96c6\u3002$1\\le n\\le 211985$\uff0c$1\\le a_i \\le 233333$\u3002\n\n- \u89e3\u9898\u601d\u8def\uff1a\n\n  \u5c06\u6bcf\u4e2a\u6570\u5728\u4e8c\u8fdb\u5236\u4e0b\u770b\u4f5c\u96c6\u5408\u540e\uff0c$b$ \u662f $a$ \u7684\u5b50\u96c6\uff0c\u5f53\u4e14\u4ec5\u5f53 $a\\  \\text{and} \\ b = b$\u3002\n  \n  \u4ee5\u4e0b\u7684\u4e09\u4e2a\u505a\u6cd5\u90fd\u53ef\u4ee5\u53bb\u6389 $a$ \u6570\u5217\u4e2d\u7684\u5143\u7d20\u4e24\u4e24\u4e0d\u540c\u7684\u9650\u5236\u3002\n\n  - \u65b9\u6cd5\u4e00\uff1a\n  \n      \u5f88\u5bb9\u6613\u60f3\u5230\u4e00\u79cd\u52a8\u6001\u89c4\u5212\u7684\u89e3\u6cd5\uff0c\u4ee4 $f_i$ \u8868\u793a\u6709\u591a\u5c11\u6ee1\u8db3\u6761\u4ef6\u7684\u5e8f\u5217\u4ee5 $a_i$ \u4e3a\u7ed3\u5c3e\u3002\u548c $\\text{LIS}$ \u7c7b\u4f3c\u3002\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n  \n      $$f_i=\\left (\\sum_{j=1}^{i-1}\\ [a_j \\ \\text{and}\\ a_i=a_i]\\ f_j\\right) +1$$\n  \n      $$\\text{ans}=\\left (\\sum_{i=1}^n f_i\\right) - n$$\n    \n  - \u65b9\u6cd5\u4e8c\uff1a\n  \n      \u4f20\u7edf\u52a8\u6001\u89c4\u5212\u7684\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2)$\uff0c\u4e0d\u80fd\u901a\u8fc7\u672c\u9898\u3002\u5982\u4f55\u4f18\u5316\u5462\uff1f\n    \n      \u5c06\u5e8f\u5217\u5206\u5757\uff0c\u6bcf\u5757 $\\text{size}$ \u4e2a\u6570\u3002\u5bf9\u4e8e $f_i$ \u7684\u8ba1\u7b97\uff0c\u66b4\u529b\u679a\u4e3e\u5757\u5185\u6240\u6709 $j$\uff0c\u66f4\u65b0 $f_i$\u3002\u6bcf\u7b97\u5b8c\u4e00\u5757\u7684\u6240\u6709 $f$ \u7684\u503c\u65f6\uff0c\u8bbe $g_x$ \u8868\u793a\u524d\u9762\u6240\u6709\u6570\u4e2d\uff0c\u5305\u542b $x$ \u7684\u6570\u7684 $f$ \u7684\u548c\uff0c\u5219 $g$ \u53ef\u4ee5\u7528\u9ad8\u7ef4\u524d\u7f00\u548c\u5728 $O(a_i \\log_2 a_i)$ \u7684\u65f6\u95f4\u5185\u7b97\u51fa\u3002\u90a3\u4e48 $f_i = $ \u5757\u5185\u7684\u8d21\u732e $+\\ g({a_i})$\u3002\n    \n      \u4e00\u5171\u8981\u91cd\u65b0\u8ba1\u7b97 $g$ \u6570\u7ec4 $\\lceil \\dfrac {n}{\\text{size}}\\rceil$ \u6b21\uff0c\u6240\u4ee5\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O\\left(\\lceil \\dfrac {n}{\\text{size}}\\rceil \\times  a_i \\times  \\log_2 a_i + n \\times  \\text{size}\\right)$\uff0c\u5f53 $\\text{size} = \\sqrt{a_i\\times \\log_2a_i}$ \u65f6\u590d\u6742\u5ea6\u53d6\u5230\u6700\u5c0f\u503c\uff0c\u4e3a $O\\left(\\sum_{i=1}^n \\sqrt{a_i\\times \\log_2 a_i}\\right)$\u3002\n    \n      \u8fd9\u6837\u7684\u590d\u6742\u5ea6\u8fd8\u662f\u6709\u70b9\u60ac\uff0c\u6709\u6ca1\u6709\u66f4\u597d\u7684\u65b9\u6cd5\uff1f\n    \n  - \u65b9\u6cd5\u4e09\uff1a\n  \n      \u56e0\u4e3a $1\\le a_i\\le 233333$\uff0c\u6240\u4ee5 $a_i$ \u5728\u4e8c\u8fdb\u5236\u4e0b\u6700\u591a\u6709 $18$ \u4f4d\u3002\u8bbe $g(x,y)$ \u8868\u793a\u4e8c\u8fdb\u5236\u4e0b\u524d $9$ \u4f4d\u4e3a $x$ \u7684\u6570\u5bf9\u4e8c\u8fdb\u5236\u4e0b\u540e $9$ \u4f4d\u4e3a $y$ \u7684 $\\text{DP}$ \u503c\u7684\u8d21\u732e\u3002\u8981\u8ba1\u7b97 $f_i$ \u65f6\uff0c\u4ee4 $A$ \u4e3a $a_i$ \u4e8c\u8fdb\u5236\u4e0b\u7684\u524d $9$ \u4f4d\uff0c$B$ \u4e3a $a_i$ \u4e8c\u8fdb\u5236\u4e0b\u7684\u540e $9$ \u4f4d\uff0c\u5219\n  \n      $$f_i = \\left(\\sum_{x\\ \\text{and}\\ a = a} g(x, B)\\right)+1$$\n  \n      \u8ba1\u7b97 $f_i$ \u5b8c\u6bd5\u540e\uff0c\u5c06\u6240\u6709\u7684 $g(A,y)$ \u90fd\u52a0\u4e0a $f_i$\uff0c\u5176\u4e2d $B$ \u5305\u542b $y$\u3002\u6b64\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O\\left(\\sum_{i=1}^n \\sqrt{a_i}\\right)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n------------\n```cpp\n#include <stdio.h>\n#include <ctype.h>\n#define R register\n#define MAX (1 << 9)\n#define mod 1000000007\nusing namespace std;\nchar Buf[1 << 21], *S(Buf), *T(Buf);\n#define getchar() (S == T && (T = (S = Buf) + fread(Buf, 1, 1 << 24, stdin), S == T) ? EOF : *S++)\ninline void Input(int &x) {\n    R char c(getchar());\n    for (x = 0; !isdigit(c); ) c = getchar();\n    while (isdigit(c)) x = (x << 1) + (x << 3) + (c ^ 48), c = getchar();\n}\nint n, x, ans, cnt, i, A, B, f[MAX][MAX];\ninline int Add(int &x, int y) {\n\tx += y;\n\tif (x >= mod)\n\t\tx -= mod;\n\treturn x;\n}\nint main() {\n\tfor (Input(n), ans = -n; n--; ) {\n\t\tInput(x), A = x >> 9, B = x & 511;\n\t\tfor (cnt = 1, i = A; ; i = (i + 1) | A) {\n\t\t\tAdd(cnt, f[i][B]);\n\t\t\tif (i == MAX - 1)\n\t\t\t\tbreak;\n\t\t}\n\t\tfor (Add(ans, cnt), i = B; ; i = (i - 1) & B) {\n\t\t\tAdd(f[A][i], cnt);\n\t\t\tif (i == 0)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n```\n- \u7b97\u6cd5\u6807\u7b7e\uff1a\u7ebf\u6027\u52a8\u6001\u89c4\u5212\uff0c\u4f4d\u8fd0\u7b97\u3002\n\n- \u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O\\left(\\sum_{i=1}^n \\sqrt{a_i}\\right)$\u3002\n\n- \u7a7a\u95f4\u590d\u6742\u5ea6\uff1a$O(\\max{a_i})$\u3002\n\n- \u671f\u671b\u5f97\u5206\uff1a$100$ \u5206\u3002[\u63d0\u4ea4\u8bb0\u5f55](https://www.luogu.com.cn/record/36032458)\u3002",
        "postTime": 1596072016,
        "uid": 148851,
        "name": "StevenLu1103",
        "ccfLevel": 6,
        "title": "P3773 [CTSC2017]\u5409\u592b\u7279"
    },
    {
        "content": "$p.s.$\u516c\u5f0f\u597d\u50cf\u4e0d\u652f\u6301\u5c45\u4e2d\u8bf6\uff0c\u9ebb\u70e6\u7ba1\u7406\u5458\u4e86awa\u3002\n\n\u505a\u8fd9\u9898\u7684\u524d\u7f6e\u77e5\u8bc6\u662f Lucas \u5b9a\u7406\uff0c\u53ef\u4ee5\u5148\u505a\u4e00\u4e0b[\u8fd9\u9898](https://www.luogu.com.cn/problem/P3807)\u3002\n\n\u6211\u5c31\u5f53\u5927\u5bb6\u90fd\u4f1a Lucas \u5b9a\u7406\u4e86awa\u3002\n\n---\n\nLucas \u5b9a\u7406\uff1a\n\n$C^m_n\\!\\equiv\\!C^{\\left\\lfloor\\frac{m}{p}\\right\\rfloor}_{\\left\\lfloor\\frac{n}{p}\\right\\rfloor}\\times C^{m\\mod p}_{n\\mod p}\\pmod{p}$\n\n\u6240\u4ee5\u6211\u4eec\u6765\u770b\u770b\u539f\u5f0f:\n\n$\\prod_{i=2}^k \\dbinom{a_{b_i}}{a_{b_{i-1}}}\\!\\mod 2$\n\n\u91cd\u70b9\u5c31\u5728\u4e8e $\\!\\mod 2$ \u8fd9\u4e2a\u5730\u65b9\u3002\n\n\u7531 Lucas \u5b9a\u7406\u53ef\u77e5\uff0c\u539f\u5f0f\u7684\u7b54\u6848\u4e0d\u662f 0\uff0c\u5c31\u662f 1\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8981\u4fdd\u8bc1 $\\forall \\dbinom{a_{b_i}}{a_{b_{i-1}}} \\equiv 1 \\pmod 2$\u3002\n\n\u53c8\u56e0\u4e3a $\\dbinom{0}{0}$\uff0c$\\dbinom{1}{0}$\uff0c$\\dbinom{1}{1}$ \u4e3a 1\uff0c$\\dbinom{0}{1}$ \u4e3a 0\u3002\n\n\u6839\u636e Lucas \u5b9a\u7406\uff0c\u6bcf\u6b21 $\\mod 2$ \u76f8\u5f53\u4e8e\u628a $a_{b_i}$ \u548c $a_{b_{i-1}}$ \u4e8c\u8fdb\u5236\u62c6\u5206\uff0c\u5e76\u4e14\u4fdd\u8bc1\uff0c$a_{b_i}$ \u4e3a 0 \u7684\u90a3\u4e2a\u4f4d\u4e0a $a_{b_{i-1}}$ \u4e0d\u80fd\u4e3a 1\u3002\n\n\u5373 $a_{b_{i}}\\!\\And a_{b_{i-1}}\\!=\\!a_{b_i}$\uff0c\u6211\u4eec\u8bbe $f(i)$ \u4e3a\u4ee5 $i$ \u5f00\u5934\u7684\u5b50\u5e8f\u5217\u6570\uff0c\u679a\u4e3e\u5b50\u96c6\u8fdb\u884c dp \u5373\u53ef\u3002\n\n$p.s.$ \u5728\u6700\u540e\u7d2f\u52a0\u7684\u65f6\u5019\uff0c\u8981\u51cf\u53bb\u53ea\u6709\u4e00\u4e2a\u6570\u7684\u60c5\u51b5\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define rint register int\nusing namespace std;\ninline int read(){\n    int s=0,f=1;char c=getchar();\n    while(c<'0'||c>'9'){if(c=='-')f=0;c=getchar();}\n    while(c>='0'&&c<='9')s=(s<<1)+(s<<3)+c-48,c=getchar();\n    return f?s:-s;\n}\nconst int Mod=1e9+7;\nint n,a[300010],f[300010],ans;\nint main(){\n    n=read();\n    for(rint i=1;i<=n;++i) a[i]=read();\n    for(rint i=n;i;--i){\n        for(rint j=(a[i]-1)&a[i];j;j=(j-1)&a[i])\n            f[a[i]]=(f[a[i]]+f[j])%Mod;\n        f[a[i]]=(f[a[i]]+1)%Mod;\n    }\n    for(rint i=1;i<=n;++i) ans=(ans+f[a[i]]-1)%Mod;\n    printf(\"%d\",ans%Mod); \n    return 0;\n}\n```\n\n\u6ca1\u4e86awa\u3002",
        "postTime": 1583989154,
        "uid": 187259,
        "name": "v\u679c\u5b9dv",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3773 \u3010[CTSC2017]\u5409\u592b\u7279\u3011"
    },
    {
        "content": "## \u514d\u8d23\u58f0\u660e\uff0c\u542b\u501f\u9274\u6210\u5206\uff0c\u4e0d\u559c\u52ff\u55b7\n\nDP\u597d\u9898\u554a\uff0c\u8fd9\u8ba1\u6570\u975e\u5e38\u7684CTSC\uff0c\u65e2\u7136\u662fDP\u4f18\u5316\uff0c\u6211\u4eec\u5c31$step by step$.\n\n**40$pts$**\n\n$O(n^2)$\u5904\u7406\u7ec4\u5408\u6570$%2$\u7684\u503c\uff0c\u6211\u4eec\u8bbe$f_{i,j}$\u4e3a\u9009\u5230$i$\uff0c\n$\\binom{a_{b_1}}{a_{b_2}} \\times \\binom{a_{b_1}}{a_{b_2}} \\times \\cdots \\binom{a_{b_{k-1}}}{a_{b_k}} \\mod 2=j$\u7684\u65b9\u6848\u6570\u3002\n\n**\u8f6c\u79fb\u65b9\u7a0b**\n\n```cpp\n\nif(a[j]>a[i]) {\n\tif(C[a[j]][a[i]]%2==0) {\n\t\tf[i][0] = (f[i][0]+f[j][1])%MOD;\n\t} else f[i][1] = (f[i][1]+f[j][1])%MOD;\n\tf[i][0] = (f[i][0]+f[j][0])%MOD;\n}\n```\n\u5927\u6570\u636e\u59a5\u59a5\u7684\u8dd1\u5230\u8fc7\u5e74~~\n\n**\u4f18\u5316**\n\n\u6211\u4eec\u8003\u8651\u4e00\u4e2a\u7ec4\u5408\u6570\u4e3a\u5947\u6570\u662f\u7684\u60c5\u51b5\uff0c$C_n^mmod\\;2>0$\n\n\u4f17\u6240\u5468\u77e5$2$\u662f\u4e00\u4e2a\u7d20\u6570\uff0c\u8fd8\u662f\u6700\u5c0f\u7684\u7d20\u6570\uff0c\u90a3\u5c31\u8ba9\u6211\u4eec\u60f3\u5230\u4e00\u4e2a\u597d\u4e1c\u897f ***lucas*** \u5b9a\u7406\u3002\n\n$C_n^m mod\\;2=C_{n\\;mod\\;2}^{m\\;mod\\;2}C_{n/2}^{m/2}$\uff0c\u8fd9\u663e\u7136\u662f\u544a\u8bc9\u6211\u4eec$C_{n}^mmod\\;2=1$\u7684\u6761\u4ef6\u662f\uff0c$m$\u4e8c\u8fdb\u5236\u62c6\u5206\u4e4b\u540e\uff0c\u662f$n$\u7684\u5b50\u96c6\uff0c\u4e4b\u540e\u6211\u4eec\u628a\u7b49\u4e8e$a_i$\u7684\u503c\u7684\u4f4d\u7f6e\u7684$f_i$\u90fd\u52a0\u8d77\u6765\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5$O(3^n)$\u5b8c\u6210\u6b64\u9898\u4e86\u3002\n\n***Code***\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cmath>\n#include <algorithm>\n#include <vector>\nusing namespace std;\nint read(){\n\tint w=1,x=0,ch=getchar();\n\tfor(;ch<'0'||ch>'9';ch=getchar())if(ch=='-')w=-1;\n\tfor(;ch>='0'&&ch<='9';ch=getchar())x=x*10+ch-'0';\n\treturn x*w;\n}\nconst int MAXN = (int)4e5+10;\nint n,a[MAXN];\nlong long f[MAXN],ans;\nconst long long MOD = (int)1e9+7;\nlong long chain[MAXN];\nint main(){\n\tn = read();\n\tfor(int i=1;i<=n;i++){\n\t\ta[i] = read();\n\t}\n\tfor(int i=n;i>0;i--){\n\t\tfor(int j=a[i];j;j=(j-1)&a[i]){\n\t\t\tf[i] = (f[i]+chain[j])%MOD;\n\t\t}\n\t\tf[i] = (f[i]+1)%MOD;\n\t\tans = (ans+f[i]-1+MOD)%MOD;\n\t\tchain[a[i]] += f[i]; \n\t}\n\tprintf(\"%lld\\n\",ans%MOD);\n\treturn 0;\n}\n```",
        "postTime": 1569402297,
        "uid": 165030,
        "name": "Sweetie_Liu",
        "ccfLevel": 6,
        "title": "P3773 [CTSC2017]\u5409\u592b\u7279"
    }
]
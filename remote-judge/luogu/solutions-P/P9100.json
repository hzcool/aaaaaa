[
    {
        "content": "\u8003\u8651 dp\uff0c\u8bbe $f_i$ \u4e3a\u53ea\u8003\u8651\u524d $i$ \u4e2a\u5730\u96f7\uff0c\u5f3a\u5236\u7b2c $i$ \u4e2a\u4e0d\u5f15\u7206\u7684\u65b9\u6848\u6570\uff0c\u6734\u7d20\u60f3\u6cd5\u5373\u5bf9\u4e8e $i$ \u679a\u4e3e $j>i$\uff0c\u5224\u65ad\u5f15\u7206 $i+1\\sim j-1$ \u7684\u6240\u6709\u5730\u96f7\u662f\u5426\u4f1a\u5f15\u7206 $j$ \u548c $i$\u3002\u5982\u679c\u5747\u4e0d\u4f1a\u5f15\u7206\uff0c\u5219\u8f6c\u79fb $f_j\\leftarrow f_j+f_i$\u3002\n\n\u8003\u8651\u5206\u6cbb\u4f18\u5316\uff0c\u9700\u8981\u5728 $O(r-l)$ \u65f6\u95f4\u5185\u5b8c\u6210 $[l,m]$ \u5230 $[m+1,r]$ \u7684\u8f6c\u79fb\u3002\n\n\u8bbe $i\\leq m<j$\uff0c\u5219\u6761\u4ef6\u53ef\u4ee5\u8f6c\u5316\u4e3a\uff1a\n\n1. \u5f15\u7206 $i+1\\sim m$ \u7684\u6240\u6709\u5730\u96f7\u4e0d\u4f1a\u5f15\u7206 $i$\uff1b\n1. \u5f15\u7206 $i+1\\sim m$ \u7684\u6240\u6709\u5730\u96f7\u4e0d\u4f1a\u5f15\u7206 $j$\uff1b\n1. \u5f15\u7206 $m+1\\sim j-1$ \u7684\u6240\u6709\u5730\u96f7\u4e0d\u4f1a\u5f15\u7206 $i$\uff1b\n1. \u5f15\u7206 $m+1\\sim j-1$ \u7684\u6240\u6709\u5730\u96f7\u4e0d\u4f1a\u5f15\u7206 $j$\u3002\n\n\u6ce8\u610f\u5230\u867d\u7136 $i+1\\sim m$ \u7684\u5f15\u7206\u533a\u95f4\u7684\u5e76\u4e0d\u4e00\u5b9a\u4ecd\u7136\u662f\u4e00\u4e2a\u533a\u95f4\uff0c\u4f46\u662f\u7531\u4e8e\u5bf9\u4e8e\u6240\u6709 $i$\uff0c$i$ \u7684\u5f15\u7206\u533a\u95f4\u90fd\u5305\u542b $a_i$\uff0c\u6240\u4ee5\u5bf9\u4e8e\u4efb\u4f55 $i+1\\leq k\\leq m$\uff0c\u5b83\u7684\u5f15\u7206\u533a\u95f4\u5411\u5de6\u8d85\u51fa $a_{i+1}$ \u7684\u90e8\u5206\u4e00\u5b9a\u5f62\u6210\u4e00\u4e2a\u540e\u7f00\uff08\u56e0\u4e3a\u9700\u8981\u5305\u542b $a_k>a_{i+1}$\uff09\uff0c\u6240\u4ee5\u5f15\u7206\u533a\u95f4\u7684\u5e76\u5411\u5de6\u8d85\u51fa $a_{i+1}$ \u7684\u90e8\u5206\u4e5f\u4e00\u5b9a\u5f62\u6210\u4e00\u4e2a\u540e\u7f00\u3002\u540c\u7406\uff0c\u5411\u53f3\u8d85\u51fa $a_m$ \u7684\u90e8\u5206\u4e5f\u4e00\u5b9a\u5f62\u6210\u4e00\u4e2a\u524d\u7f00\u3002\u540c\u65f6\uff0c\u6211\u4eec\u9700\u8981\u5224\u5b9a\u662f\u5426\u5c5e\u4e8e\u5f15\u7206\u533a\u95f4\u7684\u5e76\u7684\u70b9\u5206\u522b\u662f $a_i$ \u548c $a_j$\uff0c\u5206\u522b\u5411\u5de6\u8d85\u51fa $a_{i+1}$ \u548c\u5411\u53f3\u8d85\u51fa $a_m$\u3002\n\n**\u4e8e\u662f\u5728\u5224\u5b9a\u6761\u4ef6\u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u5c06\u5f15\u7206\u533a\u95f4\u7684\u5e76\u5f53\u4f5c\u5305\u542b\u8fd9\u4e2a\u5e76\u7684\u6781\u5c0f\u533a\u95f4\u5904\u7406\u3002**\n\n\u800c\u8fd9\u4e2a\u6781\u5c0f\u533a\u95f4\u7684\u5de6\u53f3\u7aef\u70b9\u5c31\u5206\u522b\u662f\u6240\u6709\u5de6\u7aef\u70b9\u7684\u6700\u5c0f\u503c\u548c\u6240\u6709\u53f3\u7aef\u70b9\u7684\u6700\u5927\u503c\uff0c\u53ef\u4ee5\u975e\u5e38\u5bb9\u6613\u5730\u6c42\u51fa\u3002\u8bbe\u300c\u5305\u542b $i+1\\sim m$ \u7684\u5f15\u7206\u533a\u95f4\u7684\u5e76\u7684\u6781\u5c0f\u533a\u95f4\u300d\u662f $[L_i,R_i]$\uff0c\u300c\u5305\u542b $m+1\\sim j-1$ \u7684\u5f15\u7206\u533a\u95f4\u7684\u5e76\u7684\u6781\u5c0f\u533a\u95f4\u300d\u662f $[L_j',R_j']$\u3002\n\n\u7136\u540e\u8003\u8651\u8f6c\u79fb\u8fc7\u7a0b\u3002\n\n\u9996\u5148\u9884\u5904\u7406 $i$ \u4fa7\uff0c\u5220\u53bb\u4e0d\u6ee1\u8db3 1 \u7684 $i$\uff08\u4f8b\u5982\u5c06\u5176 $f$ \u6539\u4e3a $0$\uff0c\u4e0d\u8fc7\u5f53\u7136\u4e0d\u80fd\u628a\u8fd9\u4e2a\u4fee\u6539\u4fdd\u7559\u5230\u6700\u540e\u7b97\u7b54\u6848\u7684\u65f6\u5019\uff09\u3002\n\n\u7136\u540e\u8003\u8651\u9012\u589e\u5904\u7406 $j$\u3002\u5148\u5224\u5b9a\u6761\u4ef6 4\uff0c\u4e0d\u6ee1\u8db3\u6761\u4ef6 4 \u76f4\u63a5\u5f3a\u5236\u4e0d\u80fd\u8f6c\u79fb\uff1b\u7136\u540e\u5224\u5b9a\u6761\u4ef6 2,3\u3002\u6761\u4ef6 2 \u7b49\u4ef7\u4e8e $R_i<a_j$\u3002\u4e0d\u96be\u53d1\u73b0 $R_i$ \u5173\u4e8e $i$ \u9012\u51cf\uff0c\u4e8e\u662f\u6ee1\u8db3\u6761\u4ef6 2 \u7684 $i$ \u662f\u4e00\u4e2a\u968f $j$ \u589e\u5927\u800c\u9010\u6e10\u6269\u5927\u7684\u540e\u7f00\u3002\u6761\u4ef6 3 \u7b49\u4ef7\u4e8e $L_j'>a_i$\u3002\u7c7b\u4f3c\u7684\uff0c\u4e0d\u96be\u53d1\u73b0 $L_j'$ \u5173\u4e8e $j$ \u9012\u51cf\uff0c\u4e8e\u662f\u6ee1\u8db3\u6761\u4ef6 3 \u7684 $i$ \u662f\u4e00\u4e2a\u968f $j$ \u589e\u5927\u800c\u9010\u6e10\u7f29\u5c0f\u7684\u524d\u7f00\u3002\n\n\u4e8e\u662f\u6700\u7ec8\u5408\u6cd5\u7684\u8f6c\u79fb\u662f\u4e00\u6bb5\u533a\u95f4\uff0c\u4e14\u5de6\u53f3\u7aef\u70b9\u5747\u5355\u8c03\u3002\u4f7f\u7528\u53cc\u6307\u9488\u548c\u524d\u7f00\u548c\u5904\u7406\uff0c\u590d\u6742\u5ea6\u4e3a $O(n)$\u3002\u5957\u4e0a\u5206\u6cbb\uff0c\u6574\u4e2a\u9898\u5c31 $O(n\\log n)$ \u505a\u5b8c\u4e86\u3002\n\n```cpp\nconst int N = 300005;\nconst long long mod = 1000000007;\n\nint n;\nlong long a[N], pr[N], dp[N], ls[N], rs[N], w[N];\n\ninline void Read() {\n    cin >> n;\n    for (int i = 1;i <= n;i++) cin >> a[i] >> pr[i];\n}\n\ninline void Prefix() {\n    long long mx = -4e18;\n    for (int i = 1;i <= n;i++) {\n        if (mx < a[i]) dp[i] = 1;\n        mx = max(mx, a[i] + pr[i]);\n    }\n}\n\ninline void Work(int l, int r) {\n    if (l == r) return;\n    long long mid = l + r >> 1;\n    Work(l, mid);\n    ls[mid] = 4e18; rs[mid] = -4e18;\n    for (int i = mid - 1;i >= l;i--) {\n        ls[i] = min(a[i + 1] - pr[i + 1], ls[i + 1]);\n        rs[i] = max(a[i + 1] + pr[i + 1], rs[i + 1]);\n    }\n    w[l - 1] = 0;\n    for (int i = l;i <= mid;i++) {\n        if (ls[i] > a[i]) w[i] = dp[i];\n        else w[i] = 0;\n        w[i] = (w[i] + w[i - 1]) % mod;\n    }\n    int trr = mid, trl = mid;\n    long long lt = 4e18, rt = -4e18;\n    for (int j = mid + 1;j <= r;j++) {\n        while (trl > l && rs[trl - 1] < a[j]) trl--;\n        while (trr >= l && a[trr] >= lt) trr--;\n        if (trl <= trr && rt < a[j]) dp[j] = (dp[j] + w[trr] - w[trl - 1] + mod) % mod;\n        lt = min(lt, a[j] - pr[j]);\n        rt = max(rt, a[j] + pr[j]);\n    }\n    Work(mid + 1, r);\n}\n\ninline void Solve() {\n    long long ans = 1, mn = 4e18;\n    Work(1, n);\n    for (int i = n;i >= 1;i--) {\n        if (mn > a[i]) ans = (ans + dp[i]) % mod;\n        mn = min(mn, a[i] - pr[i]);\n    }\n    cout << ans << endl;\n}\n```",
        "postTime": 1683882850,
        "uid": 61088,
        "name": "Solystic",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P9100 [PA2020] Miny"
    }
]
[
    {
        "content": "\u7b80\u5355\u8bc1\u660e\u4e00\u4e0b\uff0c\u96c6\u5408$\\{gcd(a[l],a[l+1]...a[r])\\ | l\\le r\\}$\u5143\u7d20\u4e2a\u6570\u4e0d\u8d85\u8fc7$logn$\u4e2a\uff1a\n\n\u5c0f\u4e8e$n$\u4e14\u80fd\u88ab$n$\u6574\u9664\u7684\u6700\u5927\u7684\u6570\u5b57\u4e00\u5b9a\u5c0f\u4e8e\u7b49\u4e8e$n/2$\uff0c\u4e5f\u5c31\u8bf4\u5c0f\u4e8e$n$\u7684\u6700\u5927\u7684$gcd$\u4e0d\u8d85\u8fc7$n/2$\u3002\n\n\u90a3\u4e48\u56fa\u5b9a$r$\u540e\uff0c\u6bcf\u6b21\u5f80\u5de6\u8fb9\u6269\u5927\u4e00\u683c\uff0c\u6269\u5927\u533a\u95f4\u8303\u56f4\u540e\u7684$gcd$\u8981\u4e48\u7b49\u4e8e\u539f\u6765\u7684$gcd$\uff0c\u8981\u4e48\u5c31\u662f\u5c0f\u4e8e\u7b49\u4e8e\u539f\u6765\u7684$gcd/2$\u3002\u4e5f\u5c31\u8bf4\u4ea7\u751f\u7684\u65b0\u7684$gcd$\u6570\u503c\u4e00\u5b9a\u90fd\u5c0f\u4e8e\u7b49\u4e8e\u539f\u6765\u90fd\u4e00\u534a\uff0c\u90a3\u4e48\u4e5f\u5c31\u6700\u591a\u4ea7\u751f$log$\u7ea7\u522b\u4e2a\u65b0\u7684$gcd$\u6570\u503c\u3002\n\n\u5e76\u4e14\u6211\u4eec\u53d1\u73b0\uff0c\u5de6\u8fb9\u7684$gcd(a[l]...a[r])$\u4e00\u5b9a\u5c0f\u4e8e\u7b49\u4e8e$gcd(a[l+1]...a[r])$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u679a\u4e3er\uff0c\u7528\u4e00\u4e2a\u961f\u5217\u5b58\u50a8\u8fd9log\u4e2a\u4e0d\u540c\u7684gcd\u7684\u5de6\u7aef\u70b9\uff0c\u6bcf\u6b21\u76f4\u63a5\u679a\u4e3e\u8fd9\u4e9bgcd\u66f4\u65b0\uff0c\u66f4\u65b0\u7684\u65f6\u5019\u52a0\u4e00\u4e9b\u5224\u65ad\u5904\u7406\u91cd\u590d\u5c31\u597d\u4e86\uff0c\u5199\u8d77\u6765\u5f88\u5bb9\u6613\u3002\n\n\u590d\u6742\u5ea6\uff1a$(nlog^2n)$\n\n```\n#include <bits/stdc++.h>\nusing namespace std;\n\nint n;\nqueue<int> que;\nqueue<int> lins;\nlong long g[100005];\nlong long ans;\n\nlong long gcd(long long a,long long b){\n    if(a==0)return b;\n    return gcd(b%a,a);\n}\n\nint main()\n{\n    scanf(\"%d\",&n);\n    g[0]=-1;\n    for(int i=1;i<=n;i++)\n    {\n        scanf(\"%lld\",&g[i]);\n        int last=0;\n        while(!que.empty())\n        {\n            int x=que.front();\n            que.pop();\n            g[x]=gcd(g[x],g[i]);\n            ans=max(ans,g[x]*(i-x+1));\n            if(g[x]==g[last])continue;\n            lins.push(x);\n            last=x;\n        }\n        ans=max(ans,g[i]);\n        while(!lins.empty())\n        {\n            que.push(lins.front());\n            lins.pop();\n        }\n        if(g[last]!=g[i])que.push(i);\n    }\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n\n```\n",
        "postTime": 1568978634,
        "uid": 34663,
        "name": "redegg",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5502 \u3010[JSOI2015]\u6700\u5927\u516c\u7ea6\u6570\u3011"
    },
    {
        "content": "#### UPD: 19/10/05 \u8865\u5145\u4e86\u90e8\u5206\u8bf4\u660e\uff0c\u611f\u8c22 @LRL52 \u63d0\u51fa\u7684\u9519\u8bef\u5e76\u4fee\u6b63\u4e86\u4ee3\u7801\u3002\r\n#### UPD\uff1a21/06/10 \u4fee\u6539\u4e86\u8868\u8ff0\u5e76\u8865\u5145\u4e86\u6b63\u786e\u6027\u8bc1\u660e\r\n\r\n------------\r\n\r\n\u8fd9\u9898\u53ef\u4ee5\u7528\u533a\u95f4\u5206\u6cbb\u7684\u601d\u60f3\u3002\u5728\u4e24\u5e74\u540e\u7684\u4eca\u5929\u6211\u624d\u60ca\u8bb6\u5730\u53d1\u73b0\u300a\u7b97\u6cd5\u5bfc\u8bba\u300b\u5206\u6cbb\u7ae0\u8282\u7684\u7b2c\u4e00\u9875\u5c31\u662f\u8fd9\u4e2a\u7b97\u6cd5\u3002\r\n\r\n#### \u9898\u76ee\u5206\u6790:\r\n\r\n\u5728\u6211\u4eec\u73b0\u5728\u8003\u8651\u7684\u533a\u95f4 $[L,R]$ \u4e2d\uff0c\u8bbe\u6700\u5927\u4ef7\u503c\u533a\u95f4\u4e3a $[l,r]$\uff0c\u8bbe $mid=\\left\\lfloor\\frac{L+R}{2}\\right\\rfloor$\uff0c\u90a3\u4e48\u5b83\u53ea\u6709\u4e09\u79cd\u53ef\u80fd\uff1a\r\n\r\n1. $[l,r]$ \u5728\u533a\u95f4 $[L,mid)$ \u4e2d\u3002\r\n2. $[l,r]$ \u5728\u533a\u95f4 $(mid,R]$ \u4e2d\u3002\r\n3. $l$ \u5728 $[L,mid]$ \u4e2d\uff0c$r$ \u5728 $[mid,R]$ \u4e2d\u3002\r\n\r\n\u524d\u4e24\u79cd\u60c5\u51b5\u9012\u5f52\u5c31\u884c\u4e86\uff0c\u8fb9\u754c\u4e3a $L=R$\uff0c\u4ee5\u6743\u503c $a_i$\uff08\u5373\u81ea\u5df1\u4e58\u4ee5\u957f\u5ea6 $1$\uff09\u5c1d\u8bd5\u66f4\u65b0\u7b54\u6848\u3002\r\n\r\n\u7136\u540e\u662f\u7b2c\u4e09\u79cd\u60c5\u51b5\uff0c\u65e2\u7136 $l$ \u5728 $[L,mid]$ \u4e2d\uff0c$r$ \u5728 $[mid,R]$ \u4e2d\uff0c\u90a3\u4e48\u5fc5\u7136\u5305\u542b\u4e86 $a_{mid}$ \u8fd9\u4e2a\u6570\uff0c\u4ece $a_{mid}$ \u5f00\u59cb\u5411\u5de6\u53f3\u6269\u5c55\uff0c\u5982\u679c\u4e00\u4e2a\u4e0e\u5f53\u524d\u9009\u53d6\u7684\u533a\u95f4\u5de6\u53f3\u76f8\u90bb\u7684\u6570\u52a0\u8fdb\u6765\u80fd\u4fdd\u6301\u5f53\u524d $\\gcd$ \u4e0d\u53d8\uff0c\u90a3\u4e48\u5c31\u8d2a\u5fc3\u5730\u52a0\u8fdb\u6765\uff0c\u5728\u65e0\u6cd5\u62d3\u5c55\u65f6\u5c31\u53ef\u4ee5\u5c1d\u8bd5\u66f4\u65b0\u7b54\u6848\u4e86\uff0c\u7136\u540e\u52a0\u8fdb\u4f1a\u6539\u53d8 $\\gcd$ \u7684\u4e00\u4e2a\u65b0\u6570\uff0c\u53c8\u5f00\u59cb\u62d3\u5c55 $\\dots$ \u76f4\u5230\u62d3\u5c55\u5230\u8fb9\u754c $L$ \u6216\u8005 $R$ \u4e3a\u6b62\u3002\r\n\r\n\u5728\u52a0\u8fdb\u65b0\u6570\u6539\u53d8 $\\gcd$ \u65f6\u6211\u4eec\u6709\u4e24\u79cd\u9009\u62e9\uff0c\u4e00\u79cd\u662f\u52a0\u5de6\u8fb9\u7684\uff0c\u4e00\u79cd\u662f\u52a0\u53f3\u8fb9\u7684\uff0c\u6211\u4eec\u53ea\u9700\u8981\u4e00\u6b21\u4ee5\u5de6\u8fb9\u4e3a\u51c6\u62d3\u5c55\u5b8c\u4e00\u6b21\uff0c\u518d\u4e00\u6b21\u4ee5\u53f3\u8fb9\u4e3a\u51c6\u5373\u53ef\u3002\u8fd9\u6837\u80fd\u4fdd\u8bc1\u8003\u8651\u5230\u8fd9\u4e2a\u533a\u95f4\u6240\u6709\u7684 $\\gcd$ \u4e86\uff0c\u6b63\u786e\u6027\u5728\u4ee3\u7801\u540e\u8bc1\u660e\u3002\r\n\r\n\u4e0d\u7b97 $\\gcd$ \u7684\u590d\u6742\u5ea6\u4e3a $O(n\\log{n})$\u3002 ~~\u5927\u5bb6\u5c31\u628agcd\u5f53\u5e38\u6570\u597d\u4e86~~\r\n\r\n#### \u4ee3\u7801\u5b9e\u73b0(2019\u5e74\uff0c216ms in total):\r\n\r\n```cpp\r\n//2019 last edition by saxiy\uff0c2019\u7684\u53e4\u8463\u4ec5\u4f5c\u53c2\u8003\r\n#pragma GCC optimize(\"fast-math,unroll-loops\")\r\n#include <bits/stdc++.h>\r\n#define RS register\r\n#define N 100005\r\nusing namespace std;\r\ntypedef long long ll;\r\n\r\ntemplate <typename T> void read(T &x) {\r\n\tx = 0; RS char c(getchar());\r\n\twhile(!isdigit(c)) c = getchar();\r\n\tfor(;isdigit(c);c = getchar())\r\n\t\tx = (x << 3) + (x << 1) + (c ^ 48); \r\n}\r\n\r\nint n; ll a[N];\r\n\r\ninline ll max(ll a, ll b) { return a > b ? a : b; }\r\n\r\nll gcd(ll a, ll b) {//\u4e0d\u7528\u7ba1\u8fd9gcd\r\n\tif(!a) return b; if(!b) return a;\r\n\tif(!(a & 1 || b & 1))\r\n\t\treturn gcd(a >> 1, b >> 1) << 1;\r\n\tif(!(a & 1)) return gcd(a >> 1, b);\r\n\tif(!(b & 1)) return gcd(a, b >> 1);\r\n\treturn gcd(abs(a - b), min(a, b));\r\n}\r\n\r\nll dfs(int L, int R) {\r\n\tif(L == R) return a[L];\r\n\tRS int l, r, mid = L + R >> 1;\r\n\tl = r = mid;\r\n\tRS ll g = a[mid], maxx = a[mid];\r\n\twhile(L <= l && r < R) {\r\n\t\tg = gcd(a[++r], g);\r\n\t\twhile(r <= R) if(a[++r] % g) break; r--;\r\n\t\twhile(l >= L) if(a[--l] % g) break; l++;\r\n\t\tmaxx = max(maxx, (r - l + 1) * g);\r\n\t}\r\n\tl = r = mid; g = a[mid];\r\n\twhile(L < l && r <= R) {\r\n\t\tg = gcd(a[--l], g);\r\n\t\twhile(l >= L) if(a[--l] % g) break; l++;\r\n\t\twhile(r <= R) if(a[++r] % g) break; r--;\r\n\t\tmaxx = max(maxx, (r - l + 1) * g);\r\n\t}\r\n\treturn max(maxx, max(dfs(L, mid), dfs(mid + 1, R)));\r\n}\r\n\r\nint main() {\r\n\tread(n);\r\n\tfor(RS int i = 1;i <= n;i++) read(a[i]);\r\n\tprintf(\"%lld\", dfs(1, n));\r\n\treturn 0;\r\n}\r\n```\r\n\r\n#### \u6b63\u786e\u6027\u8bc1\u660e\r\n\r\n\u4f1a\u7528\u5230\u51e0\u4e2a\u6613\u8bc1\u7684\u5f15\u7406\uff0c\u7559\u7ed9\u8bfb\u8005\u601d\u8003\u5c31\u7565\u8fc7\u8bc1\u660e\u4e86\u3002\r\n\r\n1. \u5bf9\u4e8e\u6240\u6709 $a_i(i \\in [L,R])$\uff0c\u533a\u95f4 $[a_i,a_{mid}]$ \u4e00\u5b9a\u88ab\u62d3\u5c55\u8fc7\u3002 \r\n2. \u5bf9\u4e8e\u4e00\u4e2a\u5e8f\u5217\u4efb\u610f\u7684\u5b50\u5e8f\u5217\uff08\u53ef\u4ee5\u4e0d\u8fde\u7eed\uff09\uff0c\u5b50\u5e8f\u5217\u7684 $\\gcd$ \u4e00\u5b9a $\\ge$ \u539f\u5e8f\u5217\u7684 $\\gcd$\u3002\r\n3. \u5982\u679c\u516c\u5171 $\\gcd$ \u51cf\u5c0f\uff0c\u81f3\u5c11\u9664\u4ee5 $2$\u3002\r\n\r\n\u5b9a\u4e49\u67d0\u533a\u95f4\u7684 **\u7236\u533a\u95f4** \u4e3a\u6b64\u533a\u95f4\u7ecf\u4e24\u4fa7\u5b8c\u5168\u8d2a\u5fc3\u62d3\u5c55\u540e\u7684\u533a\u95f4\u3002\r\n\r\n\u5b9a\u4e49 **\u6700\u5927\u4ef7\u503c\u533a\u95f4** \u4e3a\u5176\u76f8\u540c\u516c\u5171 $\\gcd$ \u7684\u5b50\u533a\u95f4\u7684 **\u7236\u533a\u95f4**\uff0c\u5373\u4fdd\u8bc1\u76ee\u524d $\\gcd$ \u4e0d\u53d8\u7684\u60c5\u51b5\u4e0b\uff0c\u533a\u95f4\u957f\u5ea6\u6700\u5927\u3002\r\n\r\n\u73b0\u5728\u6211\u4eec\u7b97\u6cd5\u6700\u5927\u7684\u95ee\u9898\u5c31\u662f\u53ea\u80fd\u4fdd\u8bc1\u6bcf\u4e2a $a_i(i \\in [L,R])$\uff0c\u533a\u95f4 $[a_i,a_{mid}]$ \u88ab\u62d3\u5c55\u8fc7\uff0c\u4f1a\u4e0d\u4f1a\u5b58\u5728\u4e00\u4e2a\u533a\u95f4 $[l,r]$ \u6ee1\u8db3 $l\\in [L,mid] \\And r\\in [mid,r]$ \u5e76\u4e14\u6211\u4eec\u6ca1\u8003\u8651\u8fc7\uff0c\u4e8b\u5b9e\u4e0a\u8fd9\u6837\u7684\u533a\u95f4\u662f\u5b58\u5728\u7684\uff0c\u4e0b\u9762\u8bc1\u660e\u8fd9\u6837\u7684\u533a\u95f4\u4e0d\u53ef\u80fd\u66f4\u65b0\u7b54\u6848\u3002\r\n\r\n\u5047\u8bbe\u5b58\u5728 **\u6700\u5927\u4ef7\u503c\u533a\u95f4** $[l,r]$\uff08\u663e\u7136\u6211\u4eec\u53ea\u7528\u8003\u8651**\u6700\u5927\u4ef7\u503c\u533a\u95f4**\uff09\u662f\u533a\u95f4 $[L,R]$ \u5185\u7684\u6700\u4f18\u89e3\uff0c\u90a3\u4e48\u6839\u636e **\u5f15\u74061**\uff0c$[l,mid]$ \u548c $[mid,r]$ \u4e00\u5b9a\u88ab\u62d3\u5c55\u8fc7\uff0c\u90a3\u4e48\u5b58\u5728 $a_n\\in[l,mid)$ \u6070\u597d\u4f4d\u4e8e $[mid,r]$\u7684 **\u7236\u533a\u95f4** \u5de6\u4fa7\u76f8\u90bb\u4f4d\u7f6e\u4e14\u4f7f\u5f97 $a_n$ \u52a0\u5165 $[mid,r]$ \u7684 **\u7236\u533a\u95f4** \u540e\u4f1a\u6539\u53d8\u5176 $\\gcd$\u3002\u540c\u7406\u5b9a\u4e49 $a_m\\in (mid,r]$\u3002\u6839\u636e **\u5f15\u74062\u30013**\uff0c\u53ef\u4ee5\u5f97\u5230\u5982\u4e0b\u4e0d\u7b49\u5f0f\u5173\u7cfb\u3002\r\n\r\n\u5b9a\u4e49\u533a\u95f4 $[l,r]$ \u957f\u5ea6\u4e3a $S$\u3001$\\gcd$ \u4e3a $E$\uff0c\u533a\u95f4 $[l,mid]$ **\u7236\u533a\u95f4** \u957f\u5ea6\u4e3a $S_l$\u3001$\\gcd$ \u4e3a $E_l$\uff0c\u540c\u7406\u5b9a\u4e49 $S_r$\u3001$E_r$\u3002\r\n\r\n$$\\begin{cases}SE>S_lE_l\\\\SE>S_rE_r\\\\S_l+S_r>S\\\\E\\le \\frac{E_l}{2}\\\\E\\le \\frac{E_r}{2}\\end{cases}$$\r\n\r\n\u4e0d\u7b49\u5f0f $1$\u3001$2$ \u63cf\u8ff0\u4e86\u6700\u4f18\u6743\u503c\u5173\u7cfb\uff0c\u9650\u5b9a\u4e86 $[l,r]$ \u80fd\u5c1d\u8bd5\u66f4\u65b0\u7b54\u6848\u3002\u4e0d\u7b49\u5f0f $3$ \u63cf\u8ff0\u7684\u957f\u5ea6\u5173\u7cfb\u6765\u81ea\u4e8e $[l,mid]$ \u548c $[mid,r]$ \u7684 **\u7236\u533a\u95f4** \u81f3\u5c11\u5171\u540c\u5305\u542b\u4e86 $a_{mid}$ \u8fd9\u4e2a\u6570\u3002\u4e0d\u7b49\u5f0f $3$\u3001$4$ \u8bf4\u660e\u4e86 $[l,r]$ \u4e0d\u53ef\u88ab\u62d3\u5c55\u5230\u7684\u6027\u8d28\u548c **\u5f15\u74063**\u3002\r\n\r\n\u5c06\u4e0d\u7b49\u5f0f $4$ \u5e26\u5165 $1$\uff0c$5$ \u5e26\u5165 $2$ \u53ef\u5f97\uff1a\r\n\r\n$$\\begin{cases}S_l<\\frac{S}{2}\\\\S_l<\\frac{S}{2}\\end{cases}$$\r\n\r\n\u76f8\u52a0\u4fbf\u548c\u4e0d\u7b49\u5f0f $3$ \u63a8\u51fa\u4e86\u77db\u76fe\u3002\r\n\r\n**\u6240\u4ee5\uff0c\u4e0d\u5b58\u5728\u8fd9\u6837\u7684\u533a\u95f4\u6709\u673a\u4f1a\u66f4\u65b0\u7b54\u6848**\r\n\r\n\u8bc1\u6bd5\uff0c\u8fd9\u5c31\u662f\u6b63\u786e\u6027\u3002",
        "postTime": 1568533583,
        "uid": 133236,
        "name": "saxiy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5502 \u3010[JSOI2015]\u6700\u5927\u516c\u7ea6\u6570\u3011"
    },
    {
        "content": "# \u524d\u8a00\n\n- \u8fd9\u7bc7\u9898\u89e3\u601d\u8def\u53ef\u80fd\u6bd4\u8f83\u8be1\u5f02\uff0c\u4e14\u4ee3\u7801\u5197\u957f\uff0c\u53ea\u662f\u5728\u8fd9\u91cc\u8bb0\u5f55\u4e00\u4e0b\u81ea\u5df1\u7684\u601d\u8def\u4f9b\u5927\u5bb6\u53c2\u8003\uff0c\u8bf7\u6025\u4e8e\u4e86\u89e3\u5e38\u89c4\u601d\u8def\u7684\u5927\u4f6c\u79fb\u6b65QwQ\n\n---\n\n# \u601d\u8def\n\n- \u9996\u5148\uff0c\u6211\u4eec\u56fa\u5b9a\u53f3\u7aef\u70b9\uff0c\u7136\u540e\u6211\u4eec\u5c31\u53ea\u9700\u8981\u5feb\u901f\u627e\u5230 ***\u80fd\u66f4\u65b0\u7b54\u6848\u7684\u5de6\u7aef\u70b9***\uff0c\u5e76\u66f4\u65b0\u7b54\u6848\n- \u7b2c\u4e00\u6b65\u975e\u5e38\u7b80\u5355\uff0c\u6211\u4eec\u8981\u627e\u51fa\u7b2c\u4e00\u4e2a\u80fd\u66f4\u65b0\u7b54\u6848\u7684\u5de6\u7aef\u70b9\u3002\u7531\u4e8e\u6bcf\u6b21\u5de6\u79fb\u5de6\u7aef\u70b9\uff0c$gcd$ \u53ea\u53ef\u80fd\u53d8\u5c0f\u6216\u4e0d\u53d8\uff0c\u4e0d\u53ef\u80fd\u53d8\u5927\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u627e\u5230\u5f53\u524d ***\u53ef\u80fd\u7684\u6700\u5927 $gcd$ \uff0c\u7136\u540e\u5224\u65ad\u5de6\u7aef\u70b9\u81f3\u5c11\u5728\u54ea\u91cc\uff0c\u4e4b\u540e\u5224\u65ad\u8be5\u5de6\u7aef\u70b9\u5230\u5f53\u524d\u53f3\u7aef\u70b9\u7684\u533a\u95f4 $gcd$ \u662f\u5426\u4ecd\u662f\u5f53\u524d\u9700\u8981\u7684 $gcd$*** \uff0c\u5982\u679c\u662f\u5c31\u505c\u4e0b\uff0c\u5426\u5219\u66f4\u65b0\u5f53\u524d\u6700\u5927\u53ef\u80fd\u7684 $gcd$ \u5e76\u91cd\u590d\u8fd9\u4e00\u6b65\u3002\u6ce8\u610f\u5982\u679c\u5de6\u7aef\u70b9\u5df2\u7ecf\u5c0f\u4e8e\u7b49\u4e8e0\uff0c\u5c31\u8868\u660e\u5f53\u524d\u53f3\u7aef\u70b9\u4e0d\u53ef\u80fd\u66f4\u65b0\u7b54\u6848\uff0c\u6240\u4ee5 $continue$\n- \u6ce8\u610f\u505c\u4e0b\u4e4b\u540e\uff0c$while$ \u5faa\u73af\u627e\u5230\u6ee1\u8db3\u5f53\u524d $gcd$ \u7684\u6700\u5de6\u7aef\u70b9\uff0c\u7136\u540e\u518d\u66f4\u65b0\u7b54\u6848\n- \u7b2c\u4e8c\u6b65\uff0c\u6211\u4eec\u9700\u8981\u518d\u5411\u5de6\u627e\u5230\u4e0b\u4e00\u4e2a\u3001\u4e0b\u4e0b\u4e2a\u2026\u2026\u6240\u6709\u80fd\u66f4\u65b0\u7b54\u6848\u7684\u5de6\u7aef\u70b9\n- \u5728\u4ed4\u7ec6\u601d\u8003~~\u770b\u4e86\u9898\u89e3~~\u4e4b\u540e\uff0c\u6211\u4eec\u53d1\u73b0\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u6709\u4e86\u4e00\u4e2a\u5de6\u7aef\u70b9\uff0c\u5e76\u4e14\u7b54\u6848\u5c31\u662f\u7531\u8be5\u7aef\u70b9\u4ea7\u751f\u7684\uff0c\u5e76\u4e14\u5de6\u79fb\u5de6\u7aef\u70b9\u540e $gcd$ \u5fc5\u7136\u53d8\u5c0f\uff08\u4e0d\u4f1a\u4e0d\u53d8\uff09\u3002 ***\u6ce8\u610f\u5230 $gcd$ \u53d8\u5c0f\u540e\uff0c\u65b0\u7684 $gcd$ \u4e00\u5b9a\u88ab\u539f\u6765\u7684 $gcd$ \u6574\u9664\uff0c\u6240\u4ee5\u65b0\u7684 $gcd$ \u4e00\u5b9a\u5c0f\u4e8e\u7b49\u4e8e\u539f $gcd$ \u7684\u4e00\u534a\u3002*** \u4e3a\u4e86\u80fd\u591f\u66f4\u65b0\u7b54\u6848\uff0c ***\u4e0d\u96be\u53d1\u73b0\u533a\u95f4\u957f\u5ea6\u81f3\u5c11\u9700\u8981 * 2*** \u3002\u56e0\u6b64\uff0c\u6211\u4eec\u6bcf\u6b21\u66f4\u65b0\u5de6\u7aef\u70b9\u4f7f\u5f97\u533a\u95f4\u957f\u5ea6\u7ffb\u500d\u5373\u53ef\n\n- \u4ee3\u7801\u4e2d\u6709\u4e9b\u91ca\uff0c\u4e0d\u7406\u89e3\u7684\u8bdd\u53ef\u4ee5\u53c2\u8003\u4ee3\u7801\u54e6~\n\n\n---\n\n# \u4ee3\u7801\n\n```\n\n//P5502 [JSOI2015]\u6700\u5927\u516c\u7ea6\u6570  \n//submit 1             \n//By sxt on 2020.3.14    \n#include<iostream>   \n#include<cstdio>   \n#include<cstdlib>   \n#include<cstring>   \n#include<algorithm>    \n\n#define rg register int   \n#define il inline    \n#define int long long    \n#define in read()                   \n#define pint(x) printf(\"%lld\\n\", x)    \n#define _num(x) (x >= '0' && x <= '9')  \n#define mid ((l+r)>>1)   \n#define el else if  \n\nusing namespace std;  \n\nconst int N = 1e5 + 7;\n\ninline int read(){  \n\tint x=0,f=1;      \n\tchar ch=getchar();   \n\twhile(!_num(ch)){   \n\t\tif(ch=='-')    \n\t\t\tf=-1;  \n\t\tch=getchar();   \n\t}  \n\twhile(_num(ch)){   \n\t\tx=x*10+ch-'0';   \n\t\tch=getchar();   \n\t}           \n\treturn x*f;    \n}    \n\nstruct Tree{    \n\tint g;    \n}tr[N<<2];    \n    \nint a[N], m, n, now, kk;\n\n//\u7ebf\u6bb5\u6811\uff0cO(logn)\u67e5\u8be2\u533a\u95f4gcd\n\nil void upd(int rt){    \n\ttr[rt].g = __gcd(tr[rt<<1].g, tr[rt<<1|1].g);    \n}   \n \nvoid build(int l, int r, int rt){   \n\tif(l == r){   \n\t\ttr[rt].g = a[l];   \n\t\treturn;   \n\t}    \n\tbuild(l, mid, rt<<1), build(mid+1, r, rt<<1|1);    \n\tupd(rt);    \n\treturn;     \n}      \n\nint query(int l, int r, int lx, int rx, int rt){   \n\tif(l == lx && r == rx){   \n\t\treturn tr[rt].g;   \n\t}    \n\tif(rx <= mid) return query(l, mid, lx, rx, rt<<1);    \n\tel(lx > mid) return query(mid+1, r, lx, rx, rt<<1|1);                                 \n\telse return __gcd(query(l, mid, lx, mid, rt<<1), query(mid+1, r, mid+1, rx, rt<<1|1));   \n}\n\nint gcd(int u, int v){    \n\tif(u < v) swap(u, v);    \n\treturn v == 0 ? u : gcd(v, u % v);    \n}    \n\nint x, y, ans, ls;   \n\nsigned main()   \n{   \n\tn = in;   \n\tfor(rg i = 1; i <= n; ++ i){   \n\t\ta[i] = in;            \n\t\tans = max(ans, a[i]);   \n\t}   \n\tbuild(1, n, 1);    \n\tfor(rg i = 2; i <= n; ++i){   \n\t\tnow = i-1;    \n\t\tx = gcd(a[now], a[i-1]);//\u521d\u59cb\u6700\u5927gcd     \n\t\ty = ans / x;//\u533a\u95f4\u957f\u5ea6\u81f3\u5c11\u662fy\u624d\u80fd\u66f4\u65b0\u7b54\u6848    \n\t\tls = i - y;//\u5de6\u7aef\u70b9    \n\t\tif(ls <= 0) continue;//\u8be5\u53f3\u7aef\u70b9\u5df2\u7ecf\u4e0d\u53ef\u80fd\u66f4\u65b0\u7b54\u6848\uff0c\u5c31continue   \n\t\ty = query(1, n, ls, i, 1);//\u533a\u95f4\u5b9e\u9645gcd    \n\t\twhile(y != x){//\u5b9e\u9645gcd\u4e0d\u7b49\u4e8e\u9700\u8981\u7684gcd\uff0c\u6211\u4eec\u9700\u8981\u7ee7\u7eed\u7b2c\u4e00\u6b65    \n\t\t\tx = y;//\u5f53\u524d\u6700\u5927\u53ef\u80fdgcd     \n\t\t\ty = ans / x;//\u533a\u95f4\u957f\u5ea6\u81f3\u5c11\u662fy\u624d\u80fd\u66f4\u65b0\u7b54\u6848  \n\t\t\tls = i - y;   \n\t\t\tif(ls <= 0) break;    \n\t\t\ty = query(1, n, ls, i, 1);    \n\t\t}    \n\t\tif(ls <= 0) continue;    \n\t\twhile(a[ls-1] % y == 0 && ls > 1) --ls;//\u627e\u5230\u5f53\u524dgcd\u7684\u6700\u5de6\u7aef\u70b9   \n\t\tans = y * (i - ls + 1);//\u66f4\u65b0\u7b54\u6848   \n\t\twhile(ls > i/2){//\u7b2c\u4e8c\u6b65    \n\t\t\tls = ls * 2 - i;//ls\u4f9d\u7136\u662f\u5de6\u7aef\u70b9          \n\t\t\ty = query(1, n, ls, i, 1);\n            \t\tif(ans > (i - ls + 1) * y){//\u65e0\u6cd5\u66f4\u65b0\u7b54\u6848\uff0c\u5c31\u7a0d\u5fae\u5904\u7406\u4e00\u4e0b\uff0c\u5176\u5b9e\u6ca1\u5565\u5927\u7528QwQ\n                    \t\tls = i - ans / y;\n                            \tcontinue;\n                        }\n\t\t\tans = max(ans, (i - ls + 1) * y);    \n\t\t}  \n\t}  \n\tpint(ans);   \n\treturn 0;   \n}  \n\n```\n\n___\n\n_$PS\uff1a\u8fd9\u9898\u7eaf\u7cb9\u662f\u56e0\u4e3a\u6211\u4e00\u4e0d\u5c0f\u5fc3\u628a\u4e00\u7bc7\u9898\u89e3\u4ece\u5934\u5230\u5c3e\u4ed4\u7ec6\u770b\u4e86\u4e00\u904d\uff0c\u7136\u540e\u5c31\u53ea\u597d\u5f3a\u8feb\u81ea\u5df1\u60f3\u4e2a\u65b0\u601d\u8def\u51fa\u6765\u4e86QwQ$_\n\n_$\u4ece13\u53f7\u65e9\u4e0a\u4e00\u76f4\u60f3\u76f4\u523014\u53f7\u624d\u60f3\u660e\u767d\u554aQwQ$_\n\n---\n\n___THE \u00b7 END .___\n\n",
        "postTime": 1584170927,
        "uid": 69263,
        "name": "stansxt",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5502 \u3010[JSOI2015]\u6700\u5927\u516c\u7ea6\u6570\u3011"
    },
    {
        "content": "# \u9898\u76ee\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[\u70b9\u8fd9\u91cc](https://www.luogu.com.cn/problem/P5502)\u770b\u9898\u76ee\u3002  \n# \u5206\u6790\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~~\u611f\u89c9\u6709\u70b9\u65e0\u8111\u7684~~ \u5206\u6cbb\u9898\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u5bf9\u4e8e\u5de6\u53f3\u7aef\u70b9\u90fd\u5728$[L,R]$\u7684\u533a\u95f4\u6765\u8bf4\uff0c\u5b83\u4eec\u65e0\u5916\u4e4e\u51fa\u73b0\u4e09\u79cd\u60c5\u51b5\u2014\u2014  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$1.$\u5728\u533a\u95f4$[L,(L+R)/2]$\u91cc\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$2.$\u5728\u533a\u95f4$[(L+R)/2+1,R]$\u91cc\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$3.$\u8de8\u8fc7\u4e86\u4e2d\u70b9$(L+R)/2$\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u7b2c\u4e00\u7b2c\u4e8c\u79cd\u60c5\u51b5\u663e\u7136\u53ef\u4ee5\u7ee7\u7eed\u5212\u5206\u4e0b\u53bb\u89e3\u51b3\u3002\u8003\u8651\u7b2c\u4e09\u79cd\u60c5\u51b5\uff0c\u6b64\u65f6\u8fd9\u4e2a\u533a\u95f4\u4e00\u5b9a\u8de8\u8fc7\u4e86$(L+R)/2$\u3002\u4e0d\u96be\u60f3\u5230\u518d\u7ef4\u62a4\u4e24\u4e2a\u6307\u9488$lp$\u548c$rp$\u3002\u521d\u59cb\u5c06\u5b83\u4eec\u6307\u5411$(L+R)/2$\uff0c\u7136\u540e\u79fb\u52a8\u5b83\u4eec\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u5047\u8bbe\u6211\u4eec\u73b0\u5728\u5df2\u7ecf\u79fb\u52a8\u4e86\u51e0\u6b65\u4e86\uff0c\u6b64\u65f6\u5e8f\u5217\u7684$\\gcd$\u4e3a$g$\u3002\u6211\u4eec\u79fb\u52a8$lp$\u548c$rp$\uff0c\u76f4\u5230\u518d\u79fb\u52a8\u5b83\u4eec\u5c31\u4f1a\u4f7f$g$\u53d8\u5316\uff0c\u4e5f\u5c31\u662f\u627e\u5230\u4e86\u8be5\u60c5\u51b5\u4e0b\u6700\u957f\u7684\u90a3\u4e2a\u533a\u95f4\uff08\u8d2a\u5fc3\u7684\u601d\u60f3\uff09\u3002\u8ba1\u7b97\u7b54\u6848\uff0c\u5e76\u4e14\u9009\u62e9\u5de6\u8fb9\u6216\u53f3\u8fb9\u5411\u5916\u8d70\u4e00\u6b65\uff0c\u6539\u53d8\u5f53\u524d\u7684$g$\uff0c\u7ee7\u7eed\u91cd\u590d\u4e0a\u9762\u7684\u6b65\u9aa4\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u81f3\u4e8e\u6bcf\u6b21\u9009\u62e9\u54ea\u4e00\u8fb9\u7684\u95ee\u9898\uff0c\u6211\u4eec\u5176\u5b9e\u53ef\u4ee5\u9009\u62e9\u8d70\u4e24\u904d\uff0c\u4e00\u904d\u6bcf\u6b21\u90fd\u9009\u62e9\u5de6\u8fb9\u63a8\u8fdb\uff0c\u53e6\u4e00\u904d\u6bcf\u6b21\u90fd\u9009\u62e9\u53f3\u8fb9\u63a8\u8fdb\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u65f6\u95f4\u4e3a$O(n\\log_2n)$\u3002  \n# \u4ee3\u7801\n```cpp\n#include <cstdio>\n\ntypedef long long LL;\n\nconst int MAXN = 1e5 + 5;\n\ntemplate<typename _T>\nvoid read( _T &x )\n{\n\tx = 0;char s = getchar();int f = 1;\n\twhile( s > '9' || s < '0' ){if( s == '-' ) f = -1; s = getchar();}\n\twhile( s >= '0' && s <= '9' ){x = ( x << 3 ) + ( x << 1 ) + ( s - '0' ), s = getchar();}\n\tx *= f;\n}\n\ntemplate<typename _T>\nvoid write( _T x )\n{\n\tif( x < 0 ){ putchar( '-' ); x = ( ~ x ) + 1; }\n\tif( 9 < x ){ write( x / 10 ); }\n\tputchar( x % 10 + '0' );\n}\n\ntemplate<typename _T>\n_T MAX( const _T a, const _T b )\n{\n\treturn a > b ? a : b;\n}\n\nLL A[MAXN];\nint N;\n\nLL gcd( const LL a, const LL b ) { return b ? gcd( b, a % b ) : a; }\n\nLL divide( const int L, const int R )\n{\n\tif( L == R ) return A[L];\n\tLL ret = 0, g;\n\tint mid = L + R >> 1, l, r;\n\tl = r = mid, g = A[mid];\n\twhile( L < l && r <= R )\n\t{\n\t\tg = gcd( g, A[-- l] );\n\t\twhile( r < R && ! ( A[r + 1] % g ) ) r ++;\n\t\twhile( L < l && ! ( A[l - 1] % g ) ) l --;\n\t\tret = MAX( ret, ( r - l + 1 ) * g );\n\t}\n\tl = r = mid, g = A[mid];\n\twhile( L <= l && r < R )\n\t{\n\t\tg = gcd( g, A[++ r] );\n\t\twhile( L < l && ! ( A[l - 1] % g ) ) l --;\n\t\twhile( r < R && ! ( A[r + 1] % g ) ) r ++;\n\t\tret = MAX( ret, ( r - l + 1 ) * g );\n\t}\n\treturn MAX( ret, MAX( divide( L, mid ), divide( mid + 1, R ) ) );\n}\n\nint main()\n{\n\tread( N );\n\tfor( int i = 1 ; i <= N ; i ++ ) read( A[i] );\n\twrite( divide( 1, N ) ), putchar( '\\n' ); \n\treturn 0;\n}\n```",
        "postTime": 1577339656,
        "uid": 123809,
        "name": "crashed",
        "ccfLevel": 0,
        "title": "[JSOI2015]\u6700\u5927\u516c\u7ea6\u6570"
    },
    {
        "content": "\u6709\u4e00\u4e2a\u77e5\u8bc6\u70b9\uff1a\u957f\u5ea6n\u7684\u5e8f\u5217\u7684\u6240\u6709\u5b50\u5e8f\u5217\u7684\u516c\u7ea6\u6570\uff0c\u6700\u591a\u6709logn\u4e2a\u3002\n\n\u679a\u4e3e\u53f3\u7aef\u70b9\uff0c\u90a3\u4e48\u53f3\u7aef\u70b9\u4e4b\u524d\u7684\u516c\u7ea6\u6570\u4e2a\u6570\u6700\u591alogn\u4e2a\u3002\u7ef4\u62a4\u8fd9\u4e9b\u516c\u7ea6\u6570\uff0c\u6bcf\u4e2a\u51fa\u73b0\u7684\u6700\u5de6\u5750\u6807\uff08L\uff09\u3002\n\n\u626b\u63cf\u6240\u6709\u516c\u7ea6\u6570\uff0c\u53d6\u6700\u4f18\u89e3\n\n```\n#include <cstdio>\n#include <cctype>\n#pragma G++ optimize(2)\ntemplate<class code>inline code read(const code &a){\n    code x=0;short w=0;char ch=0;\n    while(!isdigit(ch)) {w|=ch=='-';ch=getchar();}\n    while(isdigit(ch)) {x=(x<<3)+(x<<1)+(ch^48);ch=getchar();}\n    return w?-x:x;\n}\ninline long long gcd(long long n1,long long m1) {\n\tif(m1==0) return n1;\n\tgcd(m1,n1%m1);\n}\ninline long long max(long long x1,long long y1) {\n\tif(x1>y1) return x1;\n\treturn y1;\n}\nlong long n,now,k,wei_zhi[100005],yue_shu[100005];\nlong long a[100005],ans;\nint main(){\n\tn=read(n);\n\tfor(int i=1;i<=n;++i) a[i]=read(a[i]);\n\tnow=0; ans=0;\n\tfor(int i=1;i<=n;++i) {\n\t\t++now;\n\t\twei_zhi[now]=i;\n\t\tyue_shu[now]=a[i];\n\t\tfor(int j=now-1;j>=1;--j) yue_shu[j]=gcd(yue_shu[j],yue_shu[j+1]);\n\t\tk=0;\n\t\tfor(int j=1;j<=now;) {\n\t\t\t++k;\n\t\t\twei_zhi[k]=wei_zhi[j];\n\t\t\tyue_shu[k]=yue_shu[j];\n\t\t\twhile(yue_shu[k]==yue_shu[j]) ++j;\n\t\t}\n\t\tnow=k;\n\t\tfor(int j=1;j<=now;++j) ans=max(ans,(i-wei_zhi[j]+1)*yue_shu[j]);\n\t}\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1565580742,
        "uid": 177796,
        "name": "HeartBlock_Love",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P5502 \u3010[JSOI2015]\u6700\u5927\u516c\u7ea6\u6570\u3011"
    },
    {
        "content": "\u5bf9\u4e8e\u6c42\u89e3\u533a\u95f4\u6743\u503c $=value *length$ \u7684\u6700\u503c\u95ee\u9898\u65f6\uff0c\u6211\u4eec\u901a\u5e38\u53ef\u4ee5\u679a\u4e3e\u533a\u95f4\u5de6\u7aef\u70b9\uff0c\u7136\u540e\u9ad8\u6548\u5730\u627e\u51fa\u53f3\u7aef\u70b9\u66f4\u65b0\u7b54\u6848\u3002\n\n\u6734\u7d20\u7684\u60f3\u6cd5\u662f\u679a\u4e3e\u53f3\u7aef\u70b9 $r\\in [l,n]$ \u3002\u6839\u636e\u663e\u7136\u7684\u8d2a\u5fc3\u7b56\u7565\uff0c\u5982\u679c\u53f3\u7aef\u70b9\u5728\u67d0\u4e00\u533a\u95f4\u79fb\u52a8\u65f6\uff0c$\\gcd(a_l,a_{l+1},...,a_r)$ \u4fdd\u6301\u4e0d\u53d8\uff0c\u5219\u53f3\u7aef\u70b9\u8d8a\u5927\u8d8a\u597d\u3002\n\n\u56e0\u6b64\u53ef\u4ee5\u7528\u500d\u589e\u4f18\u5316\u53f3\u7aef\u70b9\u7684\u786e\u5b9a\u3002\u4f46\u662f\u5728\u500d\u589e\u7684\u8fc7\u7a0b\u4e2d\uff0c\u9700\u8981\u591a\u6b21\u67e5\u8be2\u533a\u95f4\u6700\u5927\u516c\u7ea6\u6570\uff1b\u6211\u4eec\u53ef\u4ee5\u7528ST\u8868\u7684\u601d\u8def\u5bf9\u5e8f\u5217\u9884\u5904\u7406\uff0c\u505a\u5230 $O(1)$ \u590d\u6742\u5ea6\u67e5\u8be2\u3002\n\n\u4f46\u662f\uff0c\u5982\u679c\u5df2\u7ecf\u786e\u5b9a\u5de6\u7aef\u70b9 $l$ \uff0c\u4e0d\u540c\u7684\u53f3\u7aef\u70b9\u9009\u53d6\u4f1a\u5bf9\u5e94\u8bb8\u591a\u4e0d\u540c\u7684\u6700\u5927\u516c\u7ea6\u6570\u503c\uff0c\u90a3\u4e48\u8be5\u7b97\u6cd5\u7684\u590d\u6742\u5ea6\u5c06\u65e0\u6cd5\u627f\u53d7\u3002\n\n\u7a0d\u52a0\u89c2\u5bdf\uff0c\u53ef\u4ee5\u53d1\u73b0\u5f53\u5de6\u7aef\u70b9\u786e\u5b9a\u65f6\uff0c\u53f3\u7aef\u70b9\u53f3\u79fb\u4e00\u4e2a\u5355\u4f4d\uff0c\u539f\u5b50\u6bb5\u7684\u6700\u5927\u516c\u7ea6\u6570\u8981\u4e48\u7ef4\u6301\u4e0d\u53d8\uff1b\u8981\u4e48\u53d8\u4e3a\u539f\u6700\u5927\u516c\u7ea6\u6570\u7684\u4e00\u4e2a\u7ea6\u6570\u3002\u6362\u8a00\u4e4b\uff0c\u5f53\u5de6\u7aef\u70b9\u786e\u5b9a\u65f6\uff0c\u4e0d\u540c\u7684\u53f3\u7aef\u70b9\u6700\u591a\u5bf9\u5e94 $\\log_2n$ \u4e2a\u4e0d\u540c\u7684\u6700\u5927\u516c\u7ea6\u6570\u503c\u3002\u7b97\u6cd5\u590d\u6742\u5ea6\u5f97\u4ee5\u63a7\u5236\u5728 $O(n(\\log n)^2)$ \u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\ninline ll gcd(ll a, ll b) {\n    return b == 0 ? a : gcd(b, a % b);\n}\n\nint T, N;\nll ans;\nll a[100005];\nll st[100005][18];\nint lg[100005];\n\ninline ll query(int l, int r) {\n    int k = lg[r - l + 1];\n    return gcd(st[l][k], st[r - (1 << k) + 1][k]);\n}\n\nint main() {\n    lg[1] = 0;\n    for (register int i = 2; i <= 100000; ++i)\n        lg[i] = lg[i >> 1] + 1;\n    scanf(\"%d\", &N);\n    for (register int i = 1; i <= N; ++i)\n        scanf(\"%lld\", &st[i][0]);\n    for (register int j = 1; j <= lg[N]; ++j)\n        for (register int i = 1; i + (1 << j) - 1 <= N; ++i)\n            st[i][j] = gcd(st[i][j - 1], st[i + (1 << (j - 1))][j - 1]);\n    for (register int l = 1; l <= N; ++l) {\n        int r = l;\n        while (r <= N) {\n            ll cur = query(l, r);\n            for (register int i = lg[N]; i >= 0; --i) {\n                if (r + (1 << i) <= N && query(l, r + (1 << i)) == cur)\n                    r += (1 << i);\n            }\n            ans = max(ans, cur * (r - l + 1));\n            r += 1;\n        }\n    }\n    printf(\"%lld\", ans);\n    return 0;\n}\n```",
        "postTime": 1566573651,
        "uid": 116851,
        "name": "_\u98ce\u4f11\u4f4f",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5502 \u3010[JSOI2015]\u6700\u5927\u516c\u7ea6\u6570\u3011"
    }
]
[
    {
        "content": "~~\u6211\u4e0d\u77e5\u9053\u5927\u5bb6\u4e3a\u4ec0\u4e48\u8981\u5199\u8fd9\u4e48\u957f~~\uff0c\u5f53\u7136\u4e5f\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u5927\u5bb6\u7684\u8fd9\u4e48\u5feb\n\n\u539f\u7406\u5c31\u662f\u5bf9\u4e24\u8fb9\u540c\u65f6\u6c42\u5bfc\n$$G(x)=F(A(x)),F(x)=ln(x)$$\n$$G'(x)=F'(A(x))A'(x)=\\frac{A'(x)}{A(x)}$$\n\u6240\u4ee5\u5bf9A\u6c42\u5bfc\u6c42\u4e2a\u9006\u5c31\u7b97\u51fa\u4e86G\n\n\u7136\u540e\u7531\u4e8e\u6c42\u5bfc\u548c\u4e0d\u5b9a\u79ef\u5206\u662f\u4e92\u9006\u7684\uff0c\u6240\u4ee5\u5bf9G\u6c42\u4e2a\u4e0d\u5b9a\u79ef\u5206\u5c31\u597d\u4e86\n\n\u8865\u5145\u4e00\u4e0b\uff1a\n\n**\u6c42\u5bfc\u516c\u5f0f**$$x^{a'}=ax^{a-1}$$\n**\u79ef\u5206\u516c\u5f0f**$$\\int x^adx=\\frac{1}{a+1}x^{a+1}$$\n\u8be6\u60c5\u8bf7\u89c1\u4ee3\u7801\u4e2d\u4e24\u4e2a\u51fd\u6570*Dao()/Jifen()*\n```cpp\n#include<iostream>\n#include<cstdio>\nusing namespace std;\nconst int N=400100;\nconst int mod=998244353;\nint n,m,A[N],B[N],C[N],D[N],F[N],G[N],r[N],l,tt;\nint ksm(int a,int k)\n{\n\tint s=1;for(;k;k>>=1,a=1ll*a*a%mod)\n\tif(k&1) s=1ll*s*a%mod; return s;\n}\nvoid Getl(int len)\n{\n\tfor(l=1,tt=0;l<=len;l<<=1) tt++;tt--;\n\tfor(int i=0;i<l;i++) r[i]=(r[i>>1]>>1)|((i&1)<<tt);\n}\nvoid NTT(int *P,int op)\n{\n\tfor(int i=0;i<l;i++) if(i<r[i]) swap(P[i],P[r[i]]);\n\tfor(int i=1;i<l;i<<=1)\n\t{\n\t\tint W=ksm(3,(mod-1)/(i<<1));\n\t\tif(op<0) W=ksm(W,mod-2);\n\t\tfor(int j=0,p=i<<1;j<l;j+=p)\n\t\t\tfor(int k=0,w=1;k<i;k++,w=1ll*w*W%mod)\n\t\t\t{\n\t\t\t\tint X=P[j+k],Y=1ll*P[j+k+i]*w%mod;\n\t\t\t\tP[j+k]=(X+Y)%mod;P[j+k+i]=((X-Y)%mod+mod)%mod;\n\t\t\t}\n\t}\n\tif(op<0) for(int i=0,u=ksm(l,mod-2);i<l;i++) P[i]=1ll*P[i]*u%mod;\n}\nvoid GetInv(int *f,int *g,int n)\n{\n\tif(n==1) {g[0]=ksm(f[0],mod-2);return;}\n\tGetInv(f,g,n>>1); Getl(n);\n\tfor(int i=0;i<n;i++) C[i]=f[i],D[i]=g[i];\n\tfor(int i=n;i<l;i++) C[i]=D[i]=0; NTT(C,1);NTT(D,1);\n\tfor(int i=0;i<l;i++) C[i]=1ll*C[i]*D[i]%mod*D[i]%mod; NTT(C,-1);\n\tfor(int i=0;i<n;i++) g[i]=((2ll*g[i]%mod-C[i])%mod+mod)%mod;\n}\nvoid Dao(int *A,int *B,int len)\n{\n\tfor(int i=1;i<len;i++) B[i-1]=1ll*i*A[i]%mod;B[len-1]=0;\n}\nvoid Jifen(int *A,int *B,int len)\n{\n\tfor(int i=1;i<len;i++) B[i]=1ll*A[i-1]*ksm(i,mod-2)%mod;B[0]=0;\n}\nvoid Getln(int *f,int *g,int n)\n{\n\tDao(f,A,n); GetInv(f,B,n);\n\tGetl(n); NTT(A,1);NTT(B,1);\n\tfor(int i=0;i<l;i++) A[i]=1ll*A[i]*B[i]%mod;\n\tNTT(A,-1); Jifen(A,g,n);\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=0;i<n;i++) scanf(\"%d\",&F[i]);\n\tfor(m=1;m<=n;m<<=1); Getln(F,G,m);\n\tfor(int i=0;i<n;i++) printf(\"%d \",G[i]);\n}\n\n```\n~~\u5e7f\u544a\uff1a[\u535a\u4e3b\u6709\u591a\u9879\u5f0f\u7b97\u6cd5\u9898\u5355\u54e6](https://www.cnblogs.com/xzyxzy/)~~",
        "postTime": 1530793978,
        "uid": 43628,
        "name": "xzyxzy",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4725 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5bf9\u6570\u51fd\u6570\u3011"
    },
    {
        "content": "### \u5173\u4e8e\u5728\u6a21\u610f\u4e49\u4e0b\u5f53\u4e14\u4ec5\u5f53$[x^0]f(x) = 1$\u65f6\uff0c$f(x)$\u6709\u5bf9\u6570\u591a\u9879\u5f0f\u7684\u95ee\u9898\n\n\u770b\u5230\u9898\u89e3\u6709\u4e00\u6837\u548c\u6211\u611f\u5230\u7591\u60d1\u7684\u8c37\u53cb\uff1a\n\n- $[x^0]f(x) \\neq 1$\u65f6\u8981\u600e\u4e48\u6c42\uff1f\n\n\u8c8c\u4f3c\u4e5f\u6ca1\u6709\u5927\u4f6c\u7ed9\u4e00\u4e2a\u6bd4\u8f83\u5145\u5206\u7684\u89e3\u91ca\uff0c\u8fd9\u91cc\u5c31\u5173\u4e8e\u8fd9\u4e2a\u95ee\u9898\u5199~~\uff08\u6c34\uff09~~\u4e00\u7bc7\u535a\u5ba2\u5427\u3002\n\n> \u5b9a\u7406\uff1a\u5728\u6a21\u610f\u4e49\u4e0b\u5f53\u4e14\u4ec5\u5f53$[x^0]f(x) = 1$\u65f6\uff0c$f(x)$\u6709\u5bf9\u6570\u591a\u9879\u5f0f\u3002\n\n\u8bc1\u660e\uff1a\n\n\u6839\u636e\u5fae\u79ef\u5206\u7684\u57fa\u672c\u8fd0\u7b97\u89c4\u5219\uff0c\u6211\u4eec\u53ef\u4ee5\u7528**\u6c42\u5bfc\uff0c\u518d\u79ef\u5206**\u7684\u65b9\u5f0f\u6c42\u5f97\u591a\u9879\u5f0f$f$\u7684\u5bf9\u6570\uff1a$\\ln{f(x)} \\equiv \\int \\mathrm{d} \\ln f(x) \\equiv \\int\\frac{f'(x)}{f(x)} \\mathrm{d} x  \\pmod{x^{n}},$\u5176\u4e2d$\\int\\frac{f'(x)}{f(x)}dx$\u662f$\\frac{f'(x)}{f(x)}$\u7684 **\u53cd\u5bfc\u51fd\u6570**\uff0c\u4ea6\u79f0\u4e0d\u5b9a\u79ef\u5206\uff0c\u5176\u7b49\u4e8e$\\ln f(x) + c$\uff0c$c$\u4e3a\u79ef\u5206\u5e38\u6570\uff1b\u7531\u4e8e$\\ln f(x)$\u662f\u5df2\u7ecf\u786e\u5b9a\u7684\u51fd\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u786e\u5b9a\u5e94\u7528**\u5fae\u79ef\u5206\u57fa\u672c\u5b9a\u7406**$\\ln f(x) = \\int_0^x\\frac{f'(t)}{f(t)}dt + \\ln f(0)$\u6765\u786e\u5b9a\u79ef\u5206\u5e38\u6570$c = \\ln f(0)$\u3002\n\n\u6211\u4eec\u77e5\u9053\u4e00\u4e2a\u6570\u5728$\\bmod p$\u4e0b\u6709\u610f\u4e49\u5f53\u4e14\u4ec5\u5f53\u8be5\u6570\u662f\u6709\u7406\u6570\uff0c\u5176\u8868\u793a\u4e3a$\\frac{a}{b},(a,b)=1,$\u4e14$(b,p) = 1$\u3002\u7531\u4e8e\u91c7\u7528\u6c42\u5bfc\u518d\u79ef\u5206\u7684\u65b9\u5f0f\u6765\u6c42\u591a\u9879\u5f0f$f$\u7684\u5bf9\u6570\uff0c\u5bf9\u4e8e$a'_ix^i,i>0$\u7684\u9879\u6570\u6765\u8bf4\uff0c\u7cfb\u6570\u5747\u662f\u975e\u8d1f\u6574\u6570\uff0c\u6545\u5728\u6a21$p,$\u4e00\u822c$p = 998244353$\u4e0b\u5fc5\u5b9a\u662f\u6709\u610f\u4e49\u7684\uff0c\u6545\u662f\u5426\u5b58\u5728\u5bf9\u6570\u591a\u9879\u5f0f\uff0c\u7b49\u4ef7\u4e8e\u8ba8\u8bba**\u5e38\u6570\u9879\u662f\u5426\u5728\u6a21p\u4e0b\u6709\u610f\u4e49**\u3002\n\n\u5bf9\u4e8e\u591a\u9879\u5f0f$f(x) = \\sum\\limits_{i=0}^n a_ix^i,f(0) = a_0$\uff0c\u6545\u79ef\u5206\u5e38\u6570\u4e3a$c = \\ln a_0,a_0\\in Z$\u3002\n\n\u6b64\u65f6\u518d\u7ed9\u51fa\u4e00\u4e2a\u5f15\u7406\uff1a\u5f53$a_0 \\neq 1$\uff0c$\\ln a_0 \\notin Q,Q$\u4e3a\u6709\u7406\u6570\u3002\u8bc1\u660e\uff1a\u5f0f\u5b50$c = \\ln a_0 \\Leftrightarrow a_0 = e^c,$\u800c\u5bf9\u4e8e$\\forall c \\in Q,e^c \\notin Q$\uff0c\u7531\u4e8e\u5e95\u6570$e$\u662f**\u8d85\u8d8a\u6570**\uff0c\u6545\u4e0d\u5b58\u5728\u6709\u7406\u6570$a_0$\u4f7f\u5f97\u5b58\u5728\u6709\u7406\u6570$c$\u8ba9$e^c$\u4e5f\u4e3a\u6709\u7406\u6570\uff0c\u4e5f\u5c31\u662f$a_0,c\\in Q$\u65f6\u7b49\u5f0f\u4e0d\u6210\u7acb\u3002\n\n> \u6240\u8c13**\u8d85\u8d8a\u6570**\u662f\u76f8\u5bf9\u4e8e**\u4ee3\u6570\u6570**\u6765\u8bf4\u7684\u3002\u4ee3\u6570\u6570\u6307\u7684\u662f\u80fd\u4f5c\u4e3a\u4e00\u4e2a\u6574\u6570\u7cfb\u6570\u591a\u9879\u5f0f\u7684\u590d\u6839\uff0c\u5373\u5f53\u4e00\u4e2a\u6570$x_0$\u4e3a\u4ee3\u6570\u6570\uff0c\u5fc5\u5b58\u5728\u4e00\u4e2a\u6574\u6570\u591a\u9879\u5f0f$f$\u6ee1\u8db3$f(x_0) = \\sum\\limits_{i=0}^{n-1}a_ix_0^i = 0$\uff08\u5177\u4f53\u53ef\u4ee5\u770b[wikipedia-\u4ee3\u6570\u6570](https://zh.wikipedia.org/wiki/%E4%BB%A3%E6%95%B8%E6%95%B8)\uff09\u3002\u800c\u8d85\u8d8a\u6570\u5219\u4e0d\u80fd\u6210\u4e3a\u4efb\u4f55\u6574\u6570\u591a\u9879\u5f0f\u7684\u6839\u3002\u5173\u4e8e\u81ea\u7136\u5e38\u6570$e$\u4e3a\u4ec0\u4e48\u662f\u8d85\u8d8a\u6570\uff0c\u94fe\u63a5\u91cc\u6709\u6839\u636e[\u91c7\u53d6\u5e0c\u5c14\u4f2f\u7279\u7684\u7b56\u7565\u6765\u8bc1\u660ee\u662f\u8d85\u8d8a\u6570](https://zh.wikipedia.org/wiki/%E8%B6%85%E8%B6%8A%E6%95%B8#%E7%B0%A1%E8%A6%81%E5%9C%B0%E8%AD%89%E6%98%8E%7F'%22%60UNIQ--postMath-00000046-QINU%60%22'%7F%E6%98%AF%E8%B6%85%E8%B6%8A%E6%95%B8)\uff0c\u6709\u57fa\u672c\u9ad8\u6570\u77e5\u8bc6\u5c31\u80fd\u7406\u89e3~~\uff08\u83dc\u9e21\u7b14\u8005\u7406\u89e3\u4e86\u4e00\u665a\u4e0aQAQ\uff09~~\u3002\n\n\u5f15\u7406\u7684\u8bc1\u660e\uff1a\n\n\u7531\u4e8e$e$\u662f\u8d85\u8d8a\u6570\uff0c\u6545\u4e0d\u5b58\u5728\u6574\u6570\u591a\u9879\u5f0f$f$\u4f7f$f(e) = 0$\u3002\u6211\u4eec\u6784\u9020\u4e00\u4e2a\u6574\u6570\u591a\u9879\u5f0f$f(x) = x^n  - b_0$\uff0c$f(e) = e^n - b_0 \\neq 0$\uff0c\u5f15\u7406\u5f97\u8bc1\u3002\u6545\u53ea\u8981$[x^0]f(x) \\neq 1$\uff0c\u53d6\u5bf9\u6570\u540e\u5c31\u4e0d\u53ef\u80fd\u662f\u6709\u7406\u6570\uff0c\u4e5f\u5c31\u5728\u6a21\u610f\u4e49\u4e0b\u4e0d\u5b58\u5728\u5566~\uff08\u53e6\u5916\u5f97\u5230\u4e86Karry\u8001\u5e08\u7684\u5e2e\u52a9\uff0c\u4ed6\u662f\u7528\u201c\u5f53\u539f\u51fd\u6570\u7684\u5e38\u6570\u9879\u4e0d\u7b49\u4e8e1\uff0c\u5176\u53d6\u5bf9\u6570\u540e\u4e0d\u6536\u655b\u201d\u7684\u7528\u8bed\uff0c\u53ef\u4ee5\u7b49\u4ef7\u4e8e\u5728\u6a21\u4e0b\u6ca1\u6709\u610f\u4e49\uff09\u3002\n\n\u6545\u5bf9\u4e8e\u591a\u9879\u5f0f$f$\uff0c\u5f53\u4e14\u4ec5\u5f53$[x^0]f(x) = 1$\u65f6\u6709\u5bf9\u6570\u591a\u9879\u5f0f$\\ln f$\uff1b\u6307\u6570\u591a\u9879\u5f0f\u4ea6\u662f\u540c\u7406\u3002",
        "postTime": 1599302401,
        "uid": 132396,
        "name": "Kinesis",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4725 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5bf9\u6570\u51fd\u6570\uff08\u591a\u9879\u5f0f ln\uff09\u3011"
    },
    {
        "content": "\u672c\u6587\u6536\u5f55\u4e8e\uff1a[\u591a\u9879\u5f0f\u7b97\u6cd5\u5b66\u4e60\u7b14\u8bb0](https://venusnero.github.io/2019/03/19/poly_algorithm_note/)\u3002\n\n\u5df2\u77e5 $F(x)$\uff0c\u8981\u6c42 $G(x)$ \u4ee4 $G(x)\\equiv \\ln F(x)$\u3002\n\n\u8fd9\u4e2a\u4e1c\u897f\u5176\u5b9e\u4e0d\u96be\u6c42\uff0c\u6211\u4eec\u4ee4\u51fd\u6570 $f(x)=\\ln(x)$\uff0c\u5219\u539f\u5f0f\u53ef\u4ee5\u5316\u4f5c\uff1a\n\n$$G(x)\\equiv f(F(x))\\ (\\text{mod}\\ \\ x^n)$$ \n\n\u7136\u540e\u4e24\u8fb9\u6c42\u5bfc\uff0c\u53ef\u4ee5\u53d1\u73b0 $f(F(x))$ \u662f\u4e2a\u590d\u5408\u51fd\u6570\uff0c\u590d\u5408\u51fd\u6570\u6c42\u5bfc\u516c\u5f0f\u4e3a $f(g(x))'=f'(g(x))g'(x)$\uff0c\u6240\u4ee5\u5de6\u53f3\u6c42\u5bfc\u4e4b\u540e\u4e3a\uff1a\n\n$$G'(x)=f'(F(x))F'(x)\\ (\\text{mod}\\ \\ x^n)$$\n\n\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u60f3\u4e00\u60f3 $\\ln$ \u7684\u6c42\u5bfc\u516c\u5f0f\uff0c$\\ln'(x)={1\\over x}$\uff0c\u6240\u4ee5\u63a5\u7740\u53ef\u4ee5\u5316\u4e3a\uff1a\n\n$$G'(x)={F'(x)\\over F(x)}\\ (\\text{mod}\\ \\ x^n)$$\n\n\u8fd9\u4e2a\u65f6\u5019\u4f60\u53ef\u80fd\u8981\u95ee\u4e86\uff1a\u8bf6\u591a\u9879\u5f0f\u9664\u6cd5\uff1f\u4f60\u5728\u9017\u6211\u5417\uff1f\n\n\u5f53\u7136\u4e0d\u662f\u8fa3\u2026\u2026\u6211\u4eec\u521a\u521a\u624d\u5b66\u591a\u9879\u5f0f\u7684\u9006\u5143\uff0c\u53cd\u6b63\u6211\u4eec\u4e0d\u8981\u6c42\u5546\u53ea\u8981\u6c42\u4f59\u6570\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u62ff\u51fa\u6765\u7528\u5462\uff1f\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u5c06\u8bfb\u5165\u7684 $F$ \u6c42\u5bfc\u4f5c\u4e3a $a$\uff0c\u6c42\u9006\u4f5c\u4e3a $b$\uff0c\u8ba1\u7b97\u51fa $a\\times b\\ (\\text{mod}\\ \\ 998244353)$\uff0c\u6b64\u65f6\u6c42\u51fa\u7684\u662f $G'$\uff0c\u5bf9\u5b83\u6c42\u79ef\u5206\u5c31\u53ef\u4ee5\u5f97\u51fa\u6211\u4eec\u8981\u6c42\u7684 $G$ \u4e86\u3002\n\n\u4ec0\u4e48\uff1f\u4f60\u4e0d\u4f1a\u6c42\u5bfc\u548c\u79ef\u5206\uff1f~~em\u90a3\u4f60\u4e3a\u4ec0\u4e48\u8981\u505a\u591a\u9879\u5f0f\u9898~~\n\n\u7ed9\u51fa\u6c42\u5bfc\u4e0e\u79ef\u5206\u516c\u5f0f\u5982\u4e0b\uff1a\n\n$${x^a}'=ax^{a-1},\\quad \\int x^{a}dx={1\\over a+1}x^{a+1}$$\n\n```cpp\nvoid GetDev(int *f,int *g,int len)\n{\n    for(int i=1;i<len;i++) g[i-1]=i*f[i]%Mod;\n    g[len-1]=0;\n}\nvoid GetInvDev(int *f,int *g,int len)\n{\n    for(int i=1;i<len;i++) g[i]=f[i-1]*QuickPow(i,Mod-2)%Mod;\n    g[0]=0;\n}\nvoid GetLn(int *f,int *g,int len)\n{\n    GetDev(f,a,len);\n    GetInv(f,b,len);\n    lim=1;\n    m=0;\n    while(lim<(len<<1))\n    {\n        lim<<=1;\n        m++;\n    }\n    for(int i=1;i<lim;i++) rev[i]=(rev[i>>1]>>1)|((i&1)<<(m-1));\n    NTT(a,1);\n    NTT(b,1);\n    for(int i=0;i<lim;i++) a[i]=a[i]*b[i]%Mod;\n    NTT(a,-1);\n    GetInvDev(a,g,len);\n}\n```",
        "postTime": 1553087306,
        "uid": 23243,
        "name": "VenusM1nT",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4725 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5bf9\u6570\u51fd\u6570\u3011"
    },
    {
        "content": "\u7ed9\u5b9a $f(x)$\uff0c\u6c42 $g(x)$ \u4f7f\u5f97 $g(x)\u2261\\ln f(x)\\pmod{x^n}$\u3002\n\n------------\n\u8fd9\u91cc\u6709\u4e2a\u590d\u5408\u51fd\u6570\uff0c\u6bd4\u8f83\u96be\u5f04\uff0c\u56e0\u6b64\u53ef\u4ee5\u5c06\u5176\u6c42\u5bfc\u7136\u540e\u79ef\u5206\u6765\u62c6\u5f00\u3002\n\n\u8bbe\u51fd\u6570 $h(x)$ \u5728 $X$ \u4e0a\u5b9a\u4e49\uff0c\u4e14\u5bf9\u4e8e\u4efb\u610f $x\\in X$\uff0c$f(x)=\\ln x$\u3002\u56e0\u6b64\n\n$$\ng(x)\u2261h(f(x))\\pmod{x^n}\n$$\n\n\u6c42\u5bfc\u5f97\n\n$$\ng'(x)\u2261h'(f(x))f'(x)\\pmod{x^n}$$\n\n$$\n\\qquad\\;\\,\u2261\\frac{f'(x)}{f(x)}\\qquad\\quad\\;\\pmod{x^n}\n$$\n\n\u7136\u540e\u79ef\u56de\u53bb\n\n$$\ng(x)\u2261\\int\\frac{f'(x)}{f(x)}\\pmod{x^n}\n$$\n\n------------\n\n**$f'(x)$ \u53ef\u4ee5\u6c42\u5bfc\uff0c$\\frac{1}{f(x)}$ \u53ef\u4ee5\u6c42\u9006\uff0c\u56e0\u6b64 $\\frac{f'(x)}{f(x)}$ \u53ea\u987b\u5c06\u4e24\u8005\u76f8\u4e58\u5373\u53ef\u5f97\u5230\u3002\u6700\u540e\u79ef\u5206\u4e00\u4e0b\u5c31\u884c\u4e86\uff01**\n\n\n\u6c42\u5bfc\uff08\u5f97\u5230 $f'(x)$\uff09\uff1a\n\n```cpp\nvoid Differential(ll *f,ll *g,ll n){for(ll i=1;i<n;i++)g[i-1]=i*f[i]%mod;g[n-1]=0;}\n```\n\n\u6c42\u9006\uff08\u5f97\u5230 $\\frac{1}{f(x)}$\uff09\uff1a\n\n```cpp\nvoid Inv(ll *f,ll *g,ll m){\n\tif(m==1){g[0]=Quickly_Power(f[0],mod-2);return;}\n\tInv(f,g,(m+1)>>1);ll n=1;\n\twhile(n<(m<<1))n<<=1;\n\tll invn=Quickly_Power(n,mod-2);\n\tfor(ll i=0;i<n;i++)tr[i]=((tr[i>>1]>>1)|((i&1)?n>>1:0)),w[i]=f[i];\n\tfor(ll i=m;i<n;i++)w[i]=0;\n\tNTT(w,1,n),NTT(g,1,n);\n\tfor(ll i=0;i<n;i++)g[i]=(2-w[i]*g[i]%mod+mod)*g[i]%mod;\n\tNTT(g,0,n);\n\tfor(ll i=0;i<m;i++)g[i]=invn*g[i]%mod;\n\tfor(ll i=m;i<n;i++)g[i]=0;\n}\n```\n\n\u4e58\u6cd5\uff08\u5f97\u5230 $\\frac{f'(x)}{f(x)}$\uff09\uff1a\n\n```cpp\nvoid Mul(ll *f,ll *g,ll *p,ll n,ll m){\n\tm+=n,n=1;\n\twhile(n<m)n<<=1;\n\tfor(ll i=0;i<n;i++)tr[i]=((tr[i>>1]>>1)|((i&1)?n>>1:0));\n\tll invn=Quickly_Power(n,mod-2);\n\tNTT(f,1,n),NTT(g,1,n);\n\tfor(ll i=0;i<n;i++)p[i]=f[i]*g[i]%mod;\n\tNTT(p,0,n);\n\tfor(ll i=0;i<n;i++)p[i]=p[i]*invn%mod;\n}\n```\n\n\u6c42\u79ef\uff08\u5f97\u5230 $\\int\\frac{f'(x)}{f(x)}$\uff09\uff1a\n\n```cpp\nvoid Integral(ll *f,ll *g,ll n){for(ll i=1;i<n;i++)g[i]=f[i-1]*Quickly_Power(i,mod-2)%mod;g[0]=0;}\n```\n\n\u8fd9\u5c31\u597d\u5566qaq\uff01\uff01\uff01\n\n------------\n#### \u603b\u7ed3\u4e00\u4e0b\n\n\u7ed9\u5b9a $f(x)$\uff0c\u6c42 $g(x)$ \u4f7f\u5f97\n\n$$\ng(x)\u2261\\ln f(x)\\pmod{x^n}\n$$\n\n\u7ecf\u8fc7\u5904\u7406\u4e4b\u540e\u53d8\u4e3a \n\n$$\ng(x)\u2261\\int\\frac{f'(x)}{f(x)}\\pmod{x^n}\n$$\n\n\u7136\u540e\u5206\u522b\u6c42\u5bfc\u548c\u6c42\u9006\uff0c\u4e58\u8d77\u6765\u4e4b\u540e\u79ef\u5206\u4e00\u4e0b\u5373\u53ef\u3002\n\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\uff0c\u5361\u8fdb\u6700\u4f18\u89e3\u7b2c\u4e94\u9875\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\n\ntypedef long long ll;\nconst ll mod=998244353;\n#define G 3\n#define MAXN 400040\n#define invG 332748118\n#define ck(x) ((x)>=mod?(x)-mod:(x))\ninline ll read()\n{\n\tll q=0;char ch=' ';\n\twhile(ch<'0'||ch>'9')ch=getchar();\n\twhile(ch>='0'&&ch<='9')q=(q<<3)+(q<<1)+ch-'0',ch=getchar();\n\treturn q;\n}\n\nll n,tr[MAXN],f[MAXN],g[MAXN],w[MAXN];\nll ff[MAXN],_f[MAXN],_g[MAXN],h[MAXN];\ninline ll Quickly_Power(ll a,ll b)\n{\n\tll ans=1;\n\twhile(b)\n\t{\n\t\tif(b&1)ans=ans*a%mod;\n\t\ta=a*a%mod,b>>=1;\n\t}\n\treturn ans;\n}\n\n//\u5feb\u901f\u6570\u8bba\u53d8\u6362\nvoid NTT(ll *f,ll flag,ll n)\n{\n\tfor(ll i=0;i<n;i++)\n\t\tif(i<tr[i])swap(f[i],f[tr[i]]);\n\tfor(ll p=2;p<=n;p<<=1)\n\t{\n\t\tll len=(p>>1);\n\t\tll wn=Quickly_Power(flag?G:invG,(mod-1)/p);\n\t\tfor(ll k=0;k<n;k+=p)\n\t\t{\n\t\t\tll buf=1;\n\t\t\tfor(ll i=k;i<k+len;i++)\n\t\t\t{\n\t\t\t\tll tmp=buf*f[i+len]%mod;\n\t\t\t\tf[i+len]=ck(f[i]-tmp+mod);\n\t\t\t\tf[i]=ck(f[i]+tmp);\n\t\t\t\tbuf=buf*wn%mod;\n\t\t\t}\n\t\t}\n\t}\n}\n\n//\u591a\u9879\u5f0f\u6c42\u9006\nvoid Inv(ll *f,ll *g,ll m)\n{\n\tif(m==1)\n\t{\n\t\tg[0]=Quickly_Power(f[0],mod-2);\n\t\treturn;\n\t}\n\tInv(f,g,(m+1)>>1);\n\tll n=1;\n\twhile(n<(m<<1))n<<=1;\n\tll invn=Quickly_Power(n,mod-2);\n\tfor(ll i=0;i<n;i++)\n\t\ttr[i]=((tr[i>>1]>>1)|((i&1)?n>>1:0)),w[i]=f[i];\n\tfor(ll i=m;i<n;i++)w[i]=0;\n\tNTT(w,1,n),NTT(g,1,n);\n\tfor(ll i=0;i<n;i++)\n\t\tg[i]=(2-w[i]*g[i]%mod+mod)*g[i]%mod;\n\tNTT(g,0,n);\n\tfor(ll i=0;i<m;i++)\n\t\tg[i]=invn*g[i]%mod;\n\tfor(ll i=m;i<n;i++)g[i]=0;\n}\n\n//\u591a\u9879\u5f0f\u4e58\u6cd5\nvoid Mul(ll *f,ll *g,ll *p,ll n,ll m)\n{\n\tm+=n,n=1;\n\twhile(n<m)n<<=1;\n\tfor(ll i=0;i<n;i++)\n\t\ttr[i]=((tr[i>>1]>>1)|((i&1)?n>>1:0));\n\tll invn=Quickly_Power(n,mod-2);\n\tNTT(f,1,n),NTT(g,1,n);\n\tfor(ll i=0;i<n;i++)\n\t\tp[i]=f[i]*g[i]%mod;\n\tNTT(p,0,n);\n\tfor(ll i=0;i<n;i++)\n\t\tp[i]=p[i]*invn%mod;\n}\n\n//\u6c42\u5bfc\u3001\u79ef\u5206\nvoid Differential(ll *f,ll *g,ll n)\n{\n\tfor(ll i=1;i<n;i++)\n\t\tg[i-1]=i*f[i]%mod;\n\tg[n-1]=0;\n}\nvoid Integral(ll *f,ll *g,ll n)\n{\n\tfor(ll i=1;i<n;i++)\n\t\tg[i]=f[i-1]*Quickly_Power(i,mod-2)%mod;\n\tg[0]=0;\n}\n\n//\u6c42\u591a\u9879\u5f0f\u5bf9\u6570\u51fd\u6570\uff08ln\uff09\nvoid Ln(ll *f,ll *g,ll n)\n{\n\tDifferential(f,ff,n);\n\tInv(f,_f,n);\n\tMul(ff,_f,_g,n,n);\n\tIntegral(_g,g,n);\n}\nint main()\n{\n\tn=read();\n\tfor(ll i=0;i<n;i++)f[i]=read();\n\tLn(f,g,n);\n\tfor(ll i=0;i<n;i++)\n\t\tprintf(\"%lld \",g[i]);\n\treturn 0;\n}\n```",
        "postTime": 1607740053,
        "uid": 246979,
        "name": "SalomeJLQ",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P4725 \u591a\u9879\u5f0f\u5bf9\u6570\u51fd\u6570\uff08\u591a\u9879\u5f0f ln\uff09"
    },
    {
        "content": "\u591a\u9879\u5f0f Pascal \u9898\u89e3\u00b7\u7b2c\u56db\u5f39\n\n\u6211\u4eec\u6765\u63a8\u4e00\u6ce2\u5f0f\u5b50\uff1a\n\n$$ B(x) \\equiv ln(A(x)) $$\n\n$ ln(x) $ \u7684\u5bfc\u6570\u662f $ \\frac{1}{x} $\uff0c\u4f3c\u4e4e\u5f88\u597d\u5904\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u6c42\u5bfc\u518d\u79ef\u5206\u6c42\u56de\u6765\uff1a\n\n$$ B'(x) \\equiv ln'(A(x)) A'(x) $$\n\n$$ B'(x) \\equiv \\frac{1}{A(x)} A'(x) $$\n\n$$ B'(x) \\equiv \\frac{A'(x)}{A(x)} $$\n\n\u8bf6\uff0c\u8fd9\u91cc\u597d\u50cf\u51fa\u73b0\u4e86\u591a\u9879\u5f0f\u9664\u6cd5\uff0c\u6211\u4e0d\u4f1a\u600e\u4e48\u529e\uff01\n\n\u7136\u800c\u95ee\u9898\u4e0d\u5927\uff0c\u8fd9\u91cc\u53ea\u8981\u6c42\u4f59\u6570\u5373\u53ef\uff0c\u53ea\u9700\u8981\u591a\u9879\u5f0f\u6c42\u9006\u5373\u53ef\uff0c~~\u4e0d\u50cf\u591a\u9879\u5f0f\u9664\u6cd5\u4e00\u6837\u9700\u8981\u7ffb\u8f6c\u3002~~\n\n\u4e0d\u8fc7\u7531\u4e8e\u6c42\u5bfc\u518d\u79ef\u5206\u7684\u65f6\u5019\u4f1a\u635f\u5931\u51fd\u6570\u7684\u4e00\u4e9b\u4fe1\u606f\uff0c\u6211\u4eec\u518d\u770b\u9898\u76ee\uff1a$ a_0 = 1 $\uff0c\u90a3\u4e48\u7ed3\u679c\u91cc\u9762\u7684 $ a_0 $ \u4e5f\u5fc5\u4e3a $ 1 $\u3002\u8fd9\u4e2a\u6bd4\u8f83\u663e\u7136\uff0c\u53ef\u4ee5\u81ea\u5df1\u63a8\u4e00\u4e0b\u3002\n\n\u6240\u4ee5\u5c31\u597d\u4e86\uff01~~\u518d\u6b21\u628a\u591a\u9879\u5f0f\u6c42\u9006\u7684\u677f\u5b50\u7c98\u8d34\u4e00\u4e0b~~\u5173\u4e8e\u591a\u9879\u5f0f\u6c42\u9006\uff0c\u53ef\u4ee5\u770b[\u7a9d\u7684\u8fd9\u7bc7\u9898\u89e3](/blog/dblark/solution-p4238)\n\n\n```pas\ntype\n  arr = array[0..524287] of longint; //\u6709\u5f88\u591a\u5b9a\u4e49\u90fd\u5728\u7a9d\u591a\u9879\u5f0f\u9664\u6cd5\u7684\u90a3\u7bc7\u9898\u89e3\u91cc\u89e3\u91ca\u8fc7\u5566\uff0c\u7a9d\u5728\u8fd9\u91cc\u5c31\u4e0d\u91cd\u590d\u4e86\uff0c\u53ef\u4ee5\u53bb\u770b\u90a3\u7bc7\u9898\u89e3\uff08\u591a\u9879\u5f0f\u6c42\u9006\u90e8\u5206\u4ee3\u7801\u662f\u5b8c\u5168\u4e00\u6837\u7684\uff09\nconst\n  p  = 998244353;\n  g  = 3;\n  gi = 332748118;\nvar\n  a, b, pow, r: arr;\n  n, i: longint;\n\n  procedure swap(var x, y: longint); //\u65e5\u5e38\n  var\n    t: longint;\n  begin\n    t := x;\n    x := y;\n    y := t;\n  end;\n\n  function power(x, y: longint): longint; //\u65e5\u5e38\n  begin\n    power := 1;\n    while y > 0 do\n    begin\n      if odd(y) then\n        power := int64(power) * x mod p;\n      x := sqr(int64(x)) mod p;\n      y := y shr 1;\n    end;\n  end;\n\n  function inv(x: longint): longint; //\u65e5\u5e38\n  begin\n    exit(power(x, p - 2));\n  end;\n\n  function dev(a: arr; n: longint): arr; //\u6c42\u5bfc\n  var\n    i: longint;\n  begin\n    for i := 1 to n do\n      a[i - 1] := int64(a[i]) * i mod p;\n    a[n] := 0;\n    exit(a);\n  end;\n\n  function int(a: arr; n: longint): arr; //\u79ef\u5206\n  var\n    i: longint;\n  begin\n    for i := n + 1 downto 1 do\n      a[i] := int64(a[i - 1]) * inv(i) mod p;\n    a[0] := 0;\n    exit(a);\n  end;\n\n  procedure ntt(var a: arr; n, s: longint); //\u65e5\u5e38\n  var\n    i, j, k, x, y, w: longint;\n  begin\n    for i := 0 to n - 1 do\n      if i < r[i] then\n        swap(a[i], a[r[i]]);\n    i := 1;\n    while i < n do\n    begin\n      j := 0;\n      if s = 1 then\n        w := power(g, (p - 1) div (i shl 1))\n      else\n        w := power(gi, (p - 1) div (i shl 1));\n      pow[0] := 1;\n      for k := 1 to i - 1 do\n        pow[k] := int64(pow[k - 1]) * w mod p;\n      while j < n do\n      begin\n        for k := 0 to i - 1 do\n        begin\n          x := a[j + k];\n          y := int64(a[i + j + k]) * pow[k] mod p;\n          a[j + k] := (x + y) mod p;\n          a[i + j + k] := (x - y) mod p;\n        end;\n        Inc(j, i shl 1);\n      end;\n      i := i shl 1;\n    end;\n    if s = -1 then\n    begin\n      x := inv(n);\n      for i := 0 to n - 1 do\n        a[i] := (int64(a[i]) * x mod p + p) mod p;\n    end;\n  end;\n\n  function mul(a, b: arr; n, m: longint): arr; //\u591a\u9879\u5f0f\u4e58\u6cd5\n  var\n    i, l, num: longint;\n  begin\n    num := 1;\n    l := 0;\n    while num <= n + m do\n    begin\n      num := num shl 1;\n      Inc(l);\n    end;\n    for i := 0 to num - 1 do\n      r[i] := (r[i shr 1] shr 1) or ((i and 1) shl (l - 1));\n    ntt(a, num, 1);\n    ntt(b, num, 1);\n    for i := 0 to num - 1 do\n      mul[i] := int64(a[i]) * b[i] mod p;\n    ntt(mul, num, -1);\n  end;\n\n  function inv(x: arr; n: longint): arr; //\u591a\u9879\u5f0f\u6c42\u9006\n  var\n    t: arr;\n    i, l, num: longint;\n  begin\n    num := 2;\n    l := 1;\n    inv[0] := inv(x[0]);\n    while num <= n shl 1 do\n    begin\n      num := num shl 1;\n      Inc(l);\n      for i := 0 to num - 1 do\n        r[i] := (r[i shr 1] shr 1) or ((i and 1) shl (l - 1));\n      for i := 0 to num shr 1 - 1 do\n        t[i] := x[i];\n      ntt(inv, num, 1);\n      ntt(t, num, 1);\n      for i := 0 to num - 1 do\n        inv[i] := int64((p + 2 - int64(inv[i]) * t[i] mod p) mod p) * inv[i] mod p;\n      ntt(inv, num, -1);\n      for i := num shr 1 to num - 1 do\n        inv[i] := 0;\n    end;\n    for i := n + 1 to num shr 1 - 1 do\n      inv[i] := 0;\n  end;\n\n  function ln(a: arr; n: longint): arr; //\u591a\u9879\u5f0f\u5bf9\u6570\u51fd\u6570\uff0c\u8fd9\u624d\u662f\u91cd\u70b9\n  var\n    i: longint;\n  begin\n    ln := mul(dev(a, n), inv(a, n), n - 1, n); //A'(i) * (1 / A(i))\n    for i := n to 2 * n do //\u6e05\u96f6\u6570\u7ec4\uff08\u8bef\u5dee\uff09\n      ln[i] := 0;\n    ln := int(ln, n - 1);  //\u79ef\u5206\u56de\u53bb\n  end;                     //\u7136\u540e\u2026\u2026\u5c31\u6ca1\u4e86\n\nbegin                      //\u4e3b\u7a0b\u5e8f\uff0c\u975e\u5e38\u7b80\u5355\n  Read(n);\n  for i := 0 to n - 1 do\n    Read(a[i]);\n  b := ln(a, n - 1);\n  for i := 0 to n - 1 do\n    Write(b[i], ' ');\n  writeln;\nend.\n```",
        "postTime": 1554980460,
        "uid": 40241,
        "name": "dblark",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4725 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5bf9\u6570\u51fd\u6570\u3011"
    },
    {
        "content": "\u8bbe\u591a\u9879\u5f0f\u4e3a$A(x)$\u73b0\u5728\u8981\u6c42$G(x)=ln(A(x))$  \n\u6211\u4eec\u8bbe\u53e6\u4e00\u4e2a\u51fd\u6570$F(x)=ln(x)$\u5219\u8981\u6c42\u7684\u51fd\u6570\u8f6c\u5316\u6210$G(x)=F(A(x))$  \n\u6211\u4eec\u6c42\u4e00\u6ce2\u5bfc\uff0c\u53f3\u8fb9\u662f\u4e2a\u590d\u5408\u51fd\u6570\uff0c\u6211\u4eec\u8fd0\u7528\u590d\u5408\u51fd\u6570\u6c42\u5bfc\u7684\u94fe\u5f0f\u6cd5\u5219$G'(x)=F'(A(x))A'(x)$    \n\u7136\u540e\u6211\u4eec\u5957\u7528\u6c42\u5bfc\u516c\u5f0f\u8fd8\u77e5\u9053$F'(x)=\\frac{1}{x}$  \n\u6240\u4ee5\u4ee3\u5165\u4e00\u4e0b$G'(x)=\\frac{A'(x)}{A(x)}$  \n$\\frac{1}{A(x)}$\u53ef\u4ee5\u6c42\u9006\uff0c\u591a\u9879\u5f0f\u6c42\u5bfc\u4e5f\u4e0d\u662f\u4ec0\u4e48\u96be\u70b9$A'(x)=\\sum_{i=0}^{n-1} (i+1)\\times a_{i+1}x^i$  \n\u4e4b\u540e\u5bf9$G'(i)$\u518d\u79ef\u4e0b\u5206\uff0c\u5c31\u53ef\u4ee5\u6c42\u51fa$G(i)$\u4e86\uff0c\u79ef\u5206\u662f\u6c42\u5bfc\u7684\u9006\u8fd0\u7b97\uff0c\u600e\u4e48\u79ef\u5206\u5c31\u4e0d\u518d\u8d58\u8ff0\u4e86  \n\u4f46\u662f\u8fd9\u6837\u5b50\u6709\u6ca1\u6709\u70b9\u95ee\u9898\u5462\uff1f\u4e0d\u77e5\u9053\u6709\u6ca1\u6709\u4eba\u6ce8\u610f\u5230\u9898\u9762\u91cc\u4fdd\u8bc1$a_0=1$\u8fd9\u53e5\u8bdd  \n\u6211\u4eec\u6c42\u5bfc\u518d\u79ef\u5206\u7684\u8fc7\u7a0b\u4e2d\u662f\u4f1a\u5ffd\u7565\u5e38\u6570\u9879\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u628a\u5b83\u8865\u56de\u53bb\uff0c\u53ef\u4ee5\u53d1\u73b0\u5728\u53d6\u6a21\u7684\u60c5\u51b5\u4e0b$ln(1)=0$\u662f\u552f\u4e00\u6bd4\u8f83\u597d\u7b97\u7684\uff0c\u6240\u4ee5\u8fd9\u9898\u4f5c\u4e3a\u6a21\u677f\u9898\u94a6\u5b9a\u4e86$a_0=1$  \n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define mod 998244353\n#define gg 3\nusing namespace std;\n\nlong long x[400040],x1[400040],x2[400040],y[400040],y2[400040];\nint r[400040],n,lim,cnt;\n\nlong long kasumi(long long a,long long b)\n{\n\tlong long ans=1;\n\twhile(b)\n\t{\n\t\tif(b&1) ans=ans*a%mod;\n\t\ta=a*a%mod;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\n\nvoid NTT(long long *a,int kd)\n{\n\tfor(int i=0;i<lim;i++)\n\t{\n\t\tif(i<r[i]) swap(a[i],a[r[i]]);\n\t}\n\tfor(int mid=1;mid<lim;mid<<=1)\n\t{\n\t\tlong long wn=kasumi(gg,(mod-1)/(mid<<1));\n\t\tif(kd) wn=kasumi(wn,mod-2);\n\t\tfor(int i=0;i<lim;i+=(mid<<1))\n\t\t{\n\t\t\tlong long w=1;\n\t\t\tfor(int j=0;j<mid;j++,w=wn*w%mod)\n\t\t\t{\n\t\t\t\tlong long x=a[i+j];\n\t\t\t\tlong long y=a[i+j+mid]*w%mod;\n\t\t\t\ta[i+j]=(x+y)%mod;\n\t\t\t\ta[i+j+mid]=(x-y+mod)%mod;\n\t\t\t}\n\t\t}\n\t}\n\tif(kd)\n\t{\n\t\tint invl=kasumi(lim,mod-2);\n\t\tfor(int i=0;i<lim;i++) a[i]=a[i]*invl%mod;\n\t}\n}\n\nvoid rev(int cnt)\n{\n\tint tmp=1<<cnt;\n\tfor(int i=0;i<tmp;i++)\n\t{\n\t\tr[i]=(r[i>>1]>>1)|((i&1)<<(cnt-1));\n\t}\n}\n\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=0;i<n;i++) scanf(\"%lld\",&x[i]);\n\tfor(int i=1;i<n;i++) x1[i-1]=x[i]*i%mod;\n\tlim=1;\n\ty[0]=kasumi(x[0],mod-2);\n\tfor(;lim<n*2;)\n\t{\n\t\tcnt++;\n\t\tlim<<=1;\n\t\trev(cnt);\n\t\tfor(int i=0;i<lim>>1;i++)\n\t\t{\n\t\t\tx2[i]=x[i];\n\t\t\ty2[i]=y[i];\n\t\t}\n\t\tNTT(x2,0);NTT(y2,0);\n\t\tfor(int i=0;i<lim;i++)\n\t\t{\n\t\t\ty2[i]=(y2[i]*2ll%mod-x2[i]*y2[i]%mod*y2[i]%mod+mod)%mod;\n\t\t}\n\t\tNTT(y2,1);\n\t\tfor(int i=0;i<lim>>1;i++)\n\t\t{\n\t\t\ty[i]=y2[i];\n\t\t}\n\t}\n\tNTT(x1,0);NTT(y,0);\n\tfor(int i=0;i<lim;i++) x1[i]=x1[i]*y[i]%mod;\n\tNTT(x1,1);\n\tfor(int i=lim-1;i>=1;i--) x1[i]=x1[i-1]*kasumi(i,mod-2)%mod;\n\tx1[0]=0;\n\tfor(int i=0;i<n;i++) printf(\"%lld \",x1[i]);\n}\n```",
        "postTime": 1552614890,
        "uid": 185441,
        "name": "\u30cb\u30d2\u30eb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4725 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5bf9\u6570\u51fd\u6570\u3011"
    },
    {
        "content": "[\u53ef\u80fd\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.luogu.com.cn/blog/happydef-blog/duo-xiang-shi-quan-jia-tong-xue-xi-bi-ji)\n\n\u524d\u7f6e\u829d\u58eb\uff1a\u591a\u9879\u5f0f\u6c42\u5bfc\u3001\u79ef\u5206\uff0c\u591a\u9879\u5f0f\u6c42\u9006\u3002\n$$G(x)\\equiv \\ln F(x)\\pmod{x^n}$$\n\u4e24\u8fb9\u540c\u65f6\u6c42\u5bfc\n$$G'(x)\\equiv \\frac{F'(x)}{F(x)}\\pmod{x^{n-1}}$$\n\u79ef\u56de\u53bb\n$$G(x)\\equiv \\int \\frac{F'(x)}{F(x)}dx\\pmod{x^n}$$\nover\u3002\n\n\u590d\u6742\u5ea6$O(n\\log n)$.\n\n\u6838\u5fc3\u4ee3\u7801\uff1a\n```cpp\ninline void getln(ll*f,ll*g,ll len){\n   getdev(f,a,len);\n   getinv(f,b,len);\n   mul(a,b,len<<1);\n   getinvdev(a,g,len);\n   clear(a),clear(b);\n}\n```\n\u5b8c\u6574\u7248\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll; \nconst ll N=100005*3;\nll n,f[N],g[N];\nnamespace Poly{\n\tconst ll P=998244353,G=3;\n\tll lmt,rev[N],a[N],b[N],c[N];\n\tinline ll qpow(ll a,ll k){\n\t\tll ret=1;\n\t\twhile(k){\n\t\t\tif(k&1)ret=ret*a%P;\n\t\t\ta=(a*a)%P;\n\t\t\tk>>=1;\n\t\t}\n\t\treturn ret%P;\n\t}\n\tinline void init(ll n){\n\t\tlmt=1;ll t=0;\n\t\twhile(lmt<n)lmt<<=1,t++;\n\t\tfor(ll i=1;i<lmt;i++)rev[i]=(rev[i>>1]>>1)|(i&1)<<(t-1);\n\t}\n\tinline void NTT(ll *A,ll lmt,ll tp){\n\t\tfor(ll i=0;i<lmt;i++)if(i<rev[i])swap(A[i],A[rev[i]]);\n\t\tfor(ll m=1;m<lmt;m<<=1)\n\t\t\tfor(ll j=0,Wn=qpow(G,(P-1)/(m<<1));j<lmt;j+=m<<1)\n\t\t\t\tfor(ll k=0,w=1,x,y;k<m;k++,w=w*Wn%P)\n\t\t\t\t\tx=A[j+k],y=w*A[j+k+m]%P,A[j+k]=(x+y)%P,A[j+k+m]=(x-y+P)%P;\n\t\tif(tp==1)return;\n\t\treverse(A+1,A+lmt);\n\t\tfor(ll i=0,inv=qpow(lmt,P-2);i<=lmt;i++)A[i]=A[i]*inv%P;\n\t} \n\tinline void mul(ll *f,ll *g,ll len){\n\t\tinit(len);\n\t\tNTT(f,lmt,1);NTT(g,lmt,1);\n\t\tfor(ll i=0;i<lmt;i++)f[i]=(f[i]*g[i])%P;\n\t\tNTT(f,lmt,-1);\n\t} \n\tvoid getinv(ll*f,ll*g,ll len){\n\t\tif(len==1){g[0]=qpow(f[0],P-2);return;}\n\t\tgetinv(f,g,len+1>>1);\n\t\tinit(len<<1);\n\t\tfor(ll i=0;i<len;i++)c[i]=f[i];\n\t\tfor(ll i=len;i<lmt;i++)c[i]=0;\n\t\tNTT(c,lmt,1),NTT(g,lmt,1);\n\t\tfor(ll i=0;i<lmt;i++)g[i]=(2LL-g[i]*c[i]%P+P)%P*g[i]%P;\n\t\tNTT(g,lmt,-1);\n\t\tfor(ll i=len;i<lmt;i++)g[i]=0; \n\t}\n\tvoid getdev(ll*f,ll*g,ll len){\n\t\tfor(ll i=1;i<len;i++)g[i-1]=i*f[i]%P;\n\t\tg[len-1]=0;\n\t}\n\tvoid getinvdev(ll*f,ll*g,ll len){\n\t\tfor(ll i=1;i<len;i++)g[i]=f[i-1]*qpow(i,P-2)%P;\n\t\tg[0]=0;\n\t}\n\tvoid getln(ll*f,ll*g,ll len){\n\t\tmemset(a,0,sizeof(a));\n\t\tmemset(b,0,sizeof(b));\n\t\tgetdev(f,a,len);\n\t\tgetinv(f,b,len);\n\t\tmul(a,b,len<<1);\n\t\tgetinvdev(a,g,len);\n\t}\n}\nusing Poly::getln;\nint main(){\n\tscanf(\"%lld\",&n);\n\tfor(ll i=0;i<n;i++)scanf(\"%lld\",&f[i]);\n\tgetln(f,g,n);\n\tfor(ll i=0;i<n;i++)printf(\"%lld \",g[i]);\n\treturn 0;\n}\n```",
        "postTime": 1594819751,
        "uid": 121027,
        "name": "Spasmodic",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4725 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5bf9\u6570\u51fd\u6570\uff08\u591a\u9879\u5f0f ln\uff09\u3011"
    },
    {
        "content": "\u6a21\u677f\u9898\uff0c\u6211\u4eec\u77e5\u9053\n$$\\ln F(x)=\u222bF'(x)F^{-1}(x)\\ \\text{d}x$$\n\u7531\u6307\u6570\u51fd\u6570\u7684\u6c42\u5bfc\u516c\u5f0f\n$$(x^{\\alpha})'=\\alpha x^{\\alpha-1}$$\n$$\u222bx^{\\alpha}\\ \\text{d}x=\\frac{x^{\\alpha+1}}{\\alpha+1}$$\n\u6211\u4eec\u4ee4\n$$F(x)=\\sum_{i=1}^{n}a_ix^i$$\n$$n=\\text{Deg}(F)$$\n\u4e8e\u662f\u6709\n$$F'(x)=\\sum_{i=1}^ni\\cdot a_ix^{i-1}$$\n$$\u222bF(x)\\ \\text{d}x=\\sum_{i=1}^na_i\\frac{x^{i+1}}{i+1}$$\n\n- \u6c42\u5bfc\u51fd\u6570\u53ef\u4ee5\u53c2\u8003\u7a0b\u5e8f$\\rm derivative$\u6bb5\n\n- \u6c42\u4e0d\u5b9a\u79ef\u5206\u53ef\u4ee5\u53c2\u8003\u7a0b\u5e8f$\\rm inter$\u6bb5\n\n\u5269\u4e0b\u7684\u5c31\u662f\u591a\u9879\u5f0f\u6c42\u9006\u4e86.\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\nconst int N = 1<<20;\n\nint read() {\n\tint x = 0, f = 1; char c = getchar();\n\twhile(c < '0' || c > '9') {if(c == '-') f = -1; c = getchar();}\n\twhile(c >= '0' && c <= '9') x = (x<<1) + (x<<3) + c - '0', c = getchar();\n\treturn x * f;\n}\nnamespace Polynomial\n{\n\tconst ll P = 998244353, g = 3, gi = 332748118;\n\tstatic int rev[N];\n\tint lim, bit;\n\tll add(ll a, ll b)\n\t{\n\t\treturn (a += b) >= P ? a - P : a;\n\t}\n\tll qpow(ll a, ll b) \n\t{\n\t\tll prod = 1;\n\t\twhile(b)\n\t\t{\n\t\t\tif(b & 1) prod = prod * a % P;\n\t\t\ta = a * a % P;\n\t\t\tb >>= 1;\n\t\t}\n\t\treturn (prod + P) % P;\n\t}\n\tvoid calrev() {\n\t\tfor(int i = 1; i < lim; i++)\n\t\t\trev[i] = (rev[i >> 1] >> 1) | ((i & 1) << (bit - 1));\n\t}\n\tvoid NTT(ll *A, int inv) \n\t{\n\t\tfor(int i = 0; i < lim; i++)\n\t\t\tif(i < rev[i]) swap(A[i], A[rev[i]]);\n\t\tfor(int mid = 1; mid < lim; mid <<= 1) \n\t\t{\n\t\t\tll tmp = qpow(inv == 1 ? g : gi, (P - 1) / (mid << 1));\n\t\t\tfor(int j = 0; j < lim; j += (mid << 1)) \n\t\t\t{\n\t\t\t\tll omega = 1;\n\t\t\t\tfor(int k = 0; k < mid; k++, omega = (omega * tmp) % P) \n\t\t\t\t{\n\t\t\t\t\tint x = A[j + k], y = omega * A[j + k + mid] % P;\n\t\t\t\t\tA[j + k] = (x + y) % P;\n\t\t\t\t\tA[j + k + mid] = (x - y + P) % P;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(inv == 1) return;\n\t\tint invn = qpow(lim, P - 2);\n\t\tfor(int i = 0; i < lim; i++)\n\t\t\tA[i] = A[i] * invn % P;\n\t}\n\tstatic ll x[N], y[N];\n\tvoid mul(ll *a, ll *b)\n\t{\n\t\tmemset(x, 0, sizeof x);\n\t\tmemset(y, 0, sizeof y);\n\t\tfor(int i = 0; i < (lim >> 1); i++)\n\t\t\tx[i] = a[i], y[i] = b[i];\n\t\tNTT(x, 1), NTT(y, 1);\n\t\tfor(int i = 0; i < lim; i++)\n\t\t\tx[i] = x[i] * y[i] % P;\n\t\tNTT(x, -1);\n\t\tfor(int i = 0; i < lim; i++)\n\t\t\ta[i] = x[i];\n\t}\n\tstatic ll c[2][N];\n\tvoid Inv(ll *a, int n) \n\t{\n\t\tint p = 0;\n\t\tmemset(c, 0, sizeof c);\n\t\tc[0][0] = qpow(a[0], P - 2);\n\t\tlim = 2, bit = 1;\n\t\twhile(lim <= (n << 1))\n\t\t{\n\t\t\tlim <<= 1, bit++;\n\t\t\tcalrev();\n\t\t\tp ^= 1;\n\t\t\tmemset(c[p], 0, sizeof c[p]);\n\t\t\tfor(int i = 0; i <= lim; i++)\n\t\t\t\tc[p][i] = add(c[p^1][i], c[p^1][i]);\n\t\t\tmul(c[p^1], c[p^1]);\n\t\t\tmul(c[p^1], a);\n\t\t\tfor(int i = 0; i <= lim; i++)\n\t\t\t\tc[p][i] = add(c[p][i], P - c[p^1][i]);\n\t\t}\n\t\tfor(int i = 0; i < lim; i++)\n\t\t\ta[i] = c[p][i];\n\t}\n\tvoid derivative(ll *a, int n)\n\t{\n\t\tfor(int i = 1; i <= n; i++)\n\t\t\ta[i - 1] = a[i] * i % P;\n\t\ta[n] = 0;\n\t}\n\tvoid inter(ll *a, int n)\n\t{\n\t\tfor(int i = n; i >= 1; i--)\n\t\t\ta[i] = a[i - 1] * qpow(i, P - 2) % P;\n\t\ta[0] = 0;\n\t}\n\tll b[N];\n\tvoid ln(ll *a, int n) \n\t{\n\t\tmemcpy(b, a, sizeof b);\n\t\tInv(b, n), derivative(a, n);\n\t\twhile(lim <= (n << 2)) lim <<= 1, bit++;\n\t\tcalrev();\n\t\tmul(a, b);\n\t\tinter(a, n);\n\t\tfor(int i = n + 1; i <= lim; i++)\n\t\t\ta[i] = 0;\n\t}\n}\nusing namespace Polynomial;\nint n;\nll F[N];\nint main()\n{\n\tn = read();\n\tfor(int i = 0; i < n; i++)\n\t\tF[i] = read();\n\tlim = 2, bit = 1;\n\twhile(lim <= (n<<1)) lim <<= 1, bit++;\n\tln(F, n);\n\tfor(int i = 0; i < n; i++)\n\t\tprintf(\"%d \", F[i]);\n\treturn 0;\t\t\n}\n```\n",
        "postTime": 1558587186,
        "uid": 139340,
        "name": "Gauss0320",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4725\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5bf9\u6570\u51fd\u6570\uff08\u591a\u9879\u5f0f ln\uff09"
    },
    {
        "content": "\u6a21\u677f\uff0c\u76f4\u63a5\u4f7f\u7528\u591a\u9879\u5f0f$Ln$\u5373\u53ef\u3002\n\u4f60\u53ef\u4ee5\u770b\u770b[\u8fd9\u4e2a](https://www.luogu.org/blog/user7035/duo-xiang-shi-zong-jie)\u3002\n\n\u591a\u9879\u5f0f$Ln$\u5229\u7528\u4ee5\u4e0b\u516c\u5f0f:\n\n$$LnF=\\int \\frac{F'}{F}\\mathbb{d}x=\\int F'F^{-1}\\mathbb{d}x$$\n\n\u76f4\u63a5\u4f7f\u7528\u591a\u9879\u5f0f\u6c42\u9006+\u591a\u9879\u5f0f\u79ef\u5206\u6c42\u5bfc\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6$O(nlogn)$\u3002\n\n\u4ee3\u7801:\n\n```\n#include<bits/stdc++.h>\n#include<ext/pb_ds/assoc_container.hpp>\n#include<ext/pb_ds/priority_queue.hpp>\n#define For(i,a,b) for(i=(a);i<=(b);++i)\n#define Forward(i,a,b) for(i=(a);i>=(b);--i)\n#define Rep(i,a,b) for(register int i=(a),i##end=(b);i<=i##end;++i)\n#define Repe(i,a,b) for(register int i=(a),i##end=(b);i>=i##end;--i)\nusing namespace std;\ntemplate<typename T>inline void read(T &x){\n    T s=0,f=1;char k=getchar();\n    while(!isdigit(k)&&k^'-')k=getchar();\n    if(!isdigit(k)){f=-1;k=getchar();}\n    while(isdigit(k)){s=s*10+(k^48);k=getchar();}\n    x=s*f;\n}\nvoid file(void){\n    freopen(\"polynomial.in\",\"r\",stdin);\n    freopen(\"polynomial.out\",\"w\",stdout);\n}\nconst int MAXN=1<<22;\n\ntypedef long long ll;\n\nnamespace polynomial \n{\n    static int mod=998244353,gen=3,g[21],rev[MAXN],Len;\n\n    inline int ad(int a,int b){return (a+=b)>=mod?a-mod:a;}\n\n    inline int power(int a,int b)\n    {\n        static int sum;\n        for(sum=1;b;b>>=1,a=(ll)a*a%mod)if(b&1)\n            sum=(ll)sum*a%mod;\n        return sum;\n    }\n\n    inline void predone()\n    {\n        static int i,j;\n        for(i=1,j=2;i<=20;++i,j<<=1)g[i]=power(gen,(mod-1)/j);\n    }\n\n    inline void calrev(int Len)\n    {\n        static int Logl;Logl=(int)floor(log(Len)/log(2)+0.3)-1;\n        Rep(i,1,Len-1)rev[i]=(rev[i>>1]>>1)|((i&1)<<Logl);\n    }\n\n    inline void NTT(int X[],int typ)\n    {\n        Rep(i,1,Len-1)if(i<rev[i])swap(X[i],X[rev[i]]);\n        static int i,j,k,kk,w,t,wn,r;\n        for(k=2,kk=1,r=1;k<=Len;k<<=1,kk<<=1,++r)\n        {\n            wn=g[r];\n            for(i=0;i<Len;i+=k)for(j=0,w=1;j<kk;++j,w=(ll)w*wn%mod)\n            {\n                t=(ll)w*X[i+j+kk]%mod;\n                X[i+j+kk]=ad(X[i+j],mod-t);\n                X[i+j]=ad(X[i+j],t);\n            }\n        }\n        if(typ==-1)\n        {\n            reverse(X+1,X+Len);\n            static int invn;invn=power(Len,mod-2);\n            Rep(i,0,Len-1)X[i]=(ll)X[i]*invn%mod;\n        }\n    }\n\n    static int x[MAXN],y[MAXN];\n    inline void mul(int a[],int b[])\n    {\n        memset(x,0,sizeof x);memset(y,0,sizeof y);\n        Rep(i,0,(Len>>1)-1)x[i]=a[i],y[i]=b[i];\n        NTT(x,1);NTT(y,1);\n        Rep(i,0,Len-1)x[i]=(ll)x[i]*y[i]%mod;\n        NTT(x,-1);\n        Rep(i,0,Len-1)a[i]=x[i];\n    }\n    \n    static int c[2][MAXN];\n    \n    inline void Inv(int a[],int n)\n    {\n        static int t;t=0;\n        memset(c,0,sizeof c);\n        c[0][0]=power(a[0],mod-2);\n        Len=2;\n        while(Len<=(n<<1))\n        {\n            Len<<=1;calrev(Len);t^=1;\n            memset(c[t],0,sizeof c[t]);\n            Rep(i,0,Len)c[t][i]=ad(c[t^1][i],c[t^1][i]);\n            mul(c[t^1],c[t^1]);mul(c[t^1],a);\n            Rep(i,0,Len)c[t][i]=ad(c[t][i],mod-c[t^1][i]);\n        }\n        Rep(i,0,Len-1)a[i]=c[t][i];\n    }\n    \n    static int sq[2][MAXN];\n\n    inline void Sqrt(int *a,int n)\n    {\n        static int t,z;t=0;\n        memset(sq,0,sizeof sq);\n        sq[0][0]=sqrt(a[0]);\n        Len=z=2;\n        while(z<=(n<<1))\n        {\n            z<<=1;t^=1;\n            memset(sq[t],0,sizeof sq[t]);\n            Rep(i,0,z)sq[t][i]=sq[t^1][i],sq[t^1][i]=ad(sq[t^1][i],sq[t^1][i]);\n            calrev(Len=z);\n            mul(sq[t],sq[t]);\n            Rep(i,0,z)sq[t][i]=ad(sq[t][i],a[i]);\n            Inv(sq[t^1],z>>1);\n            calrev(Len=z);\n            mul(sq[t],sq[t^1]);\n        }\n        Rep(i,0,n)a[i]=sq[t][i];\n    }\n\n    static int X[MAXN],Y[MAXN];\n\n    inline void Div(int *a,int n,int *b,int m)\n    {\n        memcpy(X,a,sizeof X);memcpy(Y,b,sizeof Y);\n        reverse(b,b+m+1);reverse(X,X+n+1);\n        Rep(i,n-m+1,n)X[i]=0;\n        Inv(b,n-m+1);\n        while(Len<=(n<<2))Len<<=1;\n        calrev(Len);\n        mul(X,b);reverse(X,X+n-m+1);\n        Rep(i,n-m+1,n)X[i]=0;\n        mul(Y,X);\n        Rep(i,0,m-1)b[i]=ad(a[i],mod-Y[i]);\n        memcpy(a,X,sizeof X);\n    }\n\n    inline void Direv(int *a,int n)\n    {Rep(i,1,n)a[i-1]=(ll)a[i]*i%mod;a[n]=0;}\n    \n    inline void Inter(int *a,int n)\n    {Repe(i,n,1)a[i]=(ll)a[i-1]*power(i,mod-2)%mod;a[0]=0;}\n\n    inline void Ln(int *a,int n)\n    {\n        memcpy(X,a,sizeof X);\n        Inv(X,n);Direv(a,n);\n        while(Len<=(n<<2))Len<<=1;\n        calrev(Len);\n        mul(a,X);\n        Inter(a,n);\n        Rep(i,n+1,Len)a[i]=0;\n    }\n\n    static int T[MAXN],K[MAXN];\n\n    inline void Exp(int *a,int n)\n    {\n        static int t,z;t=0;\n        memset(K,0,sizeof K);K[0]=1;\n        Len=z=2;\n        while(z<=(n<<1))\n        {\n            z<<=1;t^=1;\n            Rep(i,0,(z>>1)-1)T[i]=K[i];\n            Ln(T,(z>>1)-1);\n            Rep(i,0,(z>>1)-1)T[i]=ad(a[i]+(i==0),mod-T[i]);\n            calrev(Len=z);\n            mul(K,T);\n            Rep(i,z,z<<1)K[i]=T[i]=0;\n        }\n        Rep(i,0,n)a[i]=K[i];\n    }\n}\nusing namespace polynomial;\n\nstatic int n,F[MAXN];\n\nint main(void){\n//    file();\n    predone();\n    read(n);\n    Rep(i,0,n-1)read(F[i]);\n    Len=2;\n    while(Len<=n<<1)Len<<=1;\n    Ln(F,n);\n    Rep(i,0,n-1)printf(\"%d \",F[i]);\n//\tcerr<<1.0*clock()/CLOCKS_PER_SEC<<endl;\n    return 0;\n}\n```",
        "postTime": 1530620985,
        "uid": 7035,
        "name": "Great_Influence",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4725 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5bf9\u6570\u51fd\u6570\u3011"
    },
    {
        "content": "\u524d\u7f6e\u829d\u58eb\uff1a\u5fae\u79ef\u5206\uff08\u6709\u6240\u4e86\u89e3\u5373\u53ef\uff09\uff08\u53ef\u4ee5\u770b\u770b[\u8fd9\u7bc7](https://blog.csdn.net/u010182633/article/category/6303247/2)\uff0c\u5199\u5f97\u975e\u5e38\u8be6\u7ec6\u6211\u770b\u4e86\u4e24\u7ae0\u5c31\u770b\u4e0d\u4e0b\u53bb\u4e86\uff09\n\n\u4ee5\u4e0b\u90fd\u662f\u4e00\u4e9b\u7b80\u5355\u7684\u6559\u7a0b\u5207\u83ab\u5f53\u771f\uff0c\u4ec5\u4f9b\u7406\u89e3\uff0c\u5efa\u8bae\u770b\u66f4\u4e25\u8c28\u7684\n\n\u5bfc\u6570\uff1a\u5bf9\u4e8e\u4e00\u4e2a\u51fd\u6570$f(x)$\uff0c\u5b83\u7684\u5bfc\u6570$f'(x)$\u4e3a\u4e00\u4e2a\u65b0\u7684\u51fd\u6570\u3002\u7b80\u5355\u7406\u89e3\u7684\u8bdd\uff0c$f'(x)$\u8868\u793a\u5728\u539f\u51fd\u6570\u56fe\u50cf\u4e0a\u8be5\u70b9\u5207\u7ebf\u7684\u659c\u7387\uff0c\u8bb0\u4e3a$\\frac{dy}{dx}$\u6216$\\frac{d}{dx}f(x)$\n\n\u79ef\u5206\uff1a\u5bf9\u4e8e\u4e00\u4e2a\u5bfc\u6570$f'(x)$\uff0c\u5b83\u6240\u5bf9\u5e94\u7684\u539f\u51fd\u6570\u4e3a\u5b83\u7684\u79ef\u5206\uff0c\u8bb0\u4e3a$\\int f'(x)dx$\n\n\u5bf9\u4e8e\u4e00\u4e2a\u591a\u9879\u5f0f$F(x)=\\sum_{i=0}^na_ix^i$\u6765\u8bf4\uff08\u4e00\u4e2a\u591a\u9879\u5f0f\u5b9e\u9645\u4e0a\u53ef\u4ee5\u770b\u505a\u4e00\u4e2a\u51fd\u6570\uff09\uff0c\u5b83\u7684\u5bfc\u6570\u548c\u79ef\u5206\u5982\u4e0b\n$$F'(x)=\\sum_{i=1}^nia_ix^{i-1}$$\n$$\\int F(x)=\\sum_{i=1}^n\\frac{a_ix^{i+1}}{i+1}$$\n\n\u8fd9\u4e24\u4e2a\u662f\u53ef\u4ee5$O(n)$\u8ba1\u7b97\u7684\uff0c\u53ef\u4ee5\u4e92\u76f8\u8f6c\u6362\n\n\u7136\u540e\u6211\u4eec\u8981\u8ba1\u7b97$ln\\ F$\uff0c\u9996\u5148\u56e0\u4e3a$ln'(x)=\\frac{1}{x}$\uff0c\u800c\u8fd9\u91cc\u662f\u4e00\u4e2a\u591a\u9879\u5f0f\uff0c\u6839\u636e\u94fe\u5f0f\u6cd5\u5219\uff08\u6211\u4e5f\u4e0d\u77e5\u9053\u4ec0\u4e48\u4e1c\u897f\uff09\uff0c$\\frac{dy}{dx}=\\frac{dy}{du}\\frac{du}{dx}$\uff0c\u7136\u540e\u628a$F(x)$\u5e26\u8fdb\u53bb\uff0c\u5f97$$\\frac{d}{dx}ln(F(x))=\\frac{d}{dF(x)}ln(F(x))\\frac{dF(x)}{dx}$$\n$$\\frac{d}{dx}ln(F(x))=\\frac{1}{F}F'$$\n$$ln(F(x))\\equiv \\int F'F^{-1}\\pmod{x^n}$$\n\u6c42\u5bfc\u548c\u79ef\u5206\u7684\u8fd0\u7b97\u4ee3\u7801\u633a\u77ed\u7684\u2026\u2026\u7136\u540e\u5269\u4e0b\u7684\u57fa\u672c\u5c31\u662f\u591a\u9879\u5f0f\u677f\u5b50\u4e86\n```\n//minamoto\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#define swap(x,y) (x^=y,y^=x,x^=y)\n#define mul(x,y) (1ll*x*y%P)\n#define add(x,y) (x+y>=P?x+y-P:x+y)\n#define dec(x,y) (x-y<0?x-y+P:x-y)\nusing namespace std;\n#define getc() (p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\nchar buf[1<<21],*p1=buf,*p2=buf;\ninline int read(){\n    #define num ch-'0'\n    char ch;bool flag=0;int res;\n    while(!isdigit(ch=getc()))\n    (ch=='-')&&(flag=true);\n    for(res=num;isdigit(ch=getc());res=res*10+num);\n    (flag)&&(res=-res);\n    #undef num\n    return res;\n}\nchar sr[1<<21],z[20];int K=-1,Z;\ninline void Ot(){fwrite(sr,1,K+1,stdout),K=-1;}\ninline void print(int x){\n    if(K>1<<20)Ot();if(x<0)sr[++K]=45,x=-x;\n    while(z[++Z]=x%10+48,x/=10);\n    while(sr[++K]=z[Z],--Z);sr[++K]=' ';\n}\nconst int N=400005,P=998244353;\ninline int ksm(int a,int b){\n\tint res=1;\n\twhile(b){\n\t\tif(b&1) res=mul(res,a);\n\t\ta=mul(a,a),b>>=1;\n\t}\n\treturn res;\n}\nint n,r[N],A[N],B[N],C[N],D[N],F[N],G[N],O[N];\nvoid NTT(int *A,int type,int len){\n\tint limit=1,l=0;\n\twhile(limit<len) limit<<=1,++l;\n\tfor(int i=0;i<limit;++i)\n\tr[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\tfor(int i=0;i<limit;++i)\n\tif(i<r[i]) swap(A[i],A[r[i]]);\n\tfor(int mid=1;mid<limit;mid<<=1){\n\t\tint R=mid<<1,Wn=ksm(3,(P-1)/R);O[0]=1;\n\t\tfor(int j=1;j<limit;++j) O[j]=mul(O[j-1],Wn);\n\t\tfor(int j=0;j<limit;j+=R){\n\t\t\tfor(int k=0;k<mid;++k){\n\t\t\t\tint x=A[j+k],y=mul(O[k],A[j+k+mid]);\n\t\t\t\tA[j+k]=add(x,y),A[j+k+mid]=dec(x,y);\n\t\t\t}\n\t\t}\n\t}\n\tif(type==-1){\n\t\treverse(A+1,A+limit);\n\t\tfor(int i=0,inv=ksm(limit,P-2);i<limit;++i)\n\t\tA[i]=mul(A[i],inv);\n\t}\n}\nvoid Inv(int *a,int *b,int len){\n\tif(len==1) return (void)(b[0]=ksm(a[0],P-2));\n\tInv(a,b,len>>1);int l=len<<1;\n\tfor(int i=0;i<len;++i) C[i]=a[i],D[i]=b[i];\n\tNTT(C,1,l),NTT(D,1,l);\n\tfor(int i=0;i<l;++i) C[i]=mul(mul(C[i],D[i]),D[i]);\n\tNTT(C,-1,l);\n\tfor(int i=0;i<len;++i) b[i]=dec(add(b[i],b[i]),C[i]);\n}\nvoid Direv(int *A,int *B,int len){\n\t//\u6c42\u5bfc\n\tfor(int i=1;i<len;++i) B[i-1]=mul(A[i],i);B[len-1]=0; \n}\nvoid Inter(int *A,int *B,int len){\n\t//\u79ef\u5206\n\tfor(int i=1;i<len;++i) B[i]=mul(A[i-1],ksm(i,P-2)),B[0]=0; \n}\nvoid Ln(int *a,int *b,int len){\n\tDirev(a,A,len),Inv(a,B,len);int l=len<<1;\n\tNTT(A,1,l),NTT(B,1,l);\n\tfor(int i=0;i<l;++i) A[i]=mul(A[i],B[i]);\n\tNTT(A,-1,l),Inter(A,b,len);\n}\nint main(){\n//\tfreopen(\"testdata.in\",\"r\",stdin);\n\tn=read();\n\tfor(int i=0;i<n;++i) F[i]=read();\n\tint len;for(len=1;len<n;len<<=1);\n\tLn(F,G,len);\n\tfor(int i=0;i<n;++i) print(G[i]);\n\tOt();\n\treturn 0;\n}\n```",
        "postTime": 1538821435,
        "uid": 41781,
        "name": "bztMinamoto",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4725 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5bf9\u6570\u51fd\u6570\u3011"
    },
    {
        "content": "\u524d\u7f6e\u77e5\u8bc6\uff1a\u6c42\u5bfc\u4e0e\u79ef\u5206\u3002  \n\n\u6c42\u5bfc\u516c\u5f0f\n$$x^{a'}=ax^{a-1}$$\n\u4e0d\u5b9a\u79ef\u5206\u516c\u5f0f\n$$\\int x^adx=\\dfrac{1}{a+1}x^{a+1}$$\n\u7136\u540e\u5f00\u59cb\u63a8\u5f0f\u5b50\u3002\n$$G(x)\\equiv \\ln(F(x))(\\bmod\\ x^n)$$\n\u4ee4 \n$$f(x)=\\text{ln}(x)$$\n$$G(x)\\equiv f(F(x))(\\bmod\\ x^n)$$  \n\n\u89c2\u5bdf\u53d1\u73b0\u8fd9\u662f\u4e2a\u590d\u5408\u51fd\u6570\uff0c\u4e24\u8fb9\u6c42\u5bfc\u5f97\n$$G(x)'\\equiv f'(F(x))F'(x)(\\bmod\\ x^n)$$\n\u7531 $\\text{ln}'(x)=\\frac{1}{x}$ \u5f97\n$$G'(x)\\equiv \\dfrac{F'(x)}{F(x)}(\\bmod\\ x^n)$$\n\n\u4e24\u8fb9\u518d\u79ef\u8d77\u6765\n$$\\therefore \\int G'(x)\\equiv\\int\\dfrac{F'(x)}{F(x)}(\\bmod\\ x^n)$$\n$$\\therefore G(x)\\equiv\\int\\dfrac{F'(x)}{F(x)}(\\bmod\\ x^n)$$\n\u591a\u9879\u5f0f\u6c42\u9006\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nnamespace IO {\n\t//read and write\n} using namespace IO;\nconst int N = 2.7e5 + 10;\nnamespace Polynomial {\n\tconst int P = 998244353, G = 3, Gi = 332748118, inv2 = 499122177;\n\tint lim, rev[N], a[N], b[N], c[N], d[N], e[N], f[N];\n\tint qpow(int n, int k) {\n\t\tint res = 1;\n\t\tfor(; k; n = 1ll * n * n % P, k >>= 1)\n\t\t\tif(k & 1) res = 1ll * res * n % P;\n\t\treturn res;\n\t}\n\tvoid NTT(int *f, int T) {\n\t\tfor(int i = 0; i < lim; i++)\n\t\t\tif(i < rev[i]) \n\t\t\t\tswap(f[i], f[rev[i]]);\n\t\tfor(int mid = 1; mid < lim; mid <<= 1) {\n\t\t\tint wn = qpow(T == 1 ? G : Gi, (P - 1) / (mid << 1));\n\t\t\tint len = mid << 1;\n\t\t\tfor(int i = 0; i < lim; i += (mid << 1)) {\n\t\t\t\tint w = 1;\n\t\t\t\tfor(int j = 0; j < mid; j++, w = 1ll * w * wn % P) {\n\t\t\t\t\tint x = f[i + j], y = 1ll * w * f[i + j + mid] % P;\n\t\t\t\t\tf[i + j] = (x + y) % P;\n\t\t\t\t\tf[i + j + mid] = (x - y + P) % P;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(T == -1) {\n\t\t\tint inv = qpow(lim, P - 2);\n\t\t\tfor(int i = 0; i < lim; i++) \n\t\t\t\tf[i] = 1ll * f[i] * inv % P;\n\t\t}\n\t}\n\tvoid init(int n) {\n\t\tfor(lim = 1; lim < n; lim <<= 1);\n\t\tfor(int i = 0; i < lim; i++)\n\t\t\trev[i] = (rev[i >> 1] >> 1) | ((i & 1) * (lim >> 1));\n\t} \n\tvoid mul(int *f, int *g, int *h, int n, int m) {\n\t\tstatic int a[N], b[N];\n\t\tinit(n + m - 1);\n\t\tmemset(a, 0, lim << 2);\n\t\tmemcpy(a, f, n << 2);\n\t\tmemset(b, 0, lim << 2);\n\t\tmemcpy(b, g, m << 2);\n\t\tNTT(a, 1), NTT(b, 1);\n\t\tfor(int i = 0; i < lim; i++) \n\t\t\th[i] = 1ll * a[i] * b[i] % P;\n\t\tNTT(h, -1);\n\t}\n\tvoid inv(int *f, int *g, int n) {\n\t\tif(n == 1) { g[0] = qpow(f[0], P - 2); return; }\n\t\tinv(f, g, n + 1 >> 1);\n\t\tinit(n << 1);\n\t\tcopy(f, f + n, a);\n\t\tfill(a + n, a + lim, 0);\n\t\tNTT(a, 1), NTT(g, 1);\n\t\tfor(int i = 0; i < lim; i++)\n\t\t\tg[i] = (2 - 1ll * a[i] * g[i] % P + P) % P * g[i] % P;\n\t\tNTT(g, -1);\n\t\tfill(g + n, g + lim, 0);\n\t}\n\tvoid dev(int *f, int *g, int n) {\n\t\tfor(int i = 1; i < n; i++)\n\t\t\tg[i - 1] = 1ll * i * f[i] % P;\n\t\tg[n - 1] = 0;\n\t}\n\tvoid invdev(int *f, int *g, int n) {\n\t\tfor(int i = n - 1; i; i--)\n\t\t\tg[i] = 1ll * f[i - 1] * qpow(i, P - 2) % P;\n\t\tg[0] = 0;\n\t}\n\tvoid ln(int *f, int *g, int n) {\n\t\tstatic int a[N];\n\t\tinit(n << 1);\n\t\tmemset(a, 0, n << 2);\n\t\tinv(f, a, n);\n\t\tdev(f, g, n);\n\t\tmul(g, a, g, n, n);\n\t\tinvdev(g, g, n);\n\t}\n}\nusing Polynomial::ln;\nint n, f[N], g[N];\nint main() {\n\tn = read();\n\tfor(int i = 0; i < n; i++) f[i] = read();\n\tln(f, g, n);\n\tfor(int i = 0; i < n; i++) write(g[i]), putc(' ');\n\tflush();\n\treturn 0;\n}\n```\n",
        "postTime": 1627739697,
        "uid": 365107,
        "name": "Terac",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4725 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5bf9\u6570\u51fd\u6570\uff08\u591a\u9879\u5f0f ln\uff09"
    },
    {
        "content": "## $\\mathtt{Description}$\n\n\u7ed9 $\\deg = n$ \u7684\u591a\u9879\u5f0f $f$\uff0c\u6c42\u4e00\u591a\u9879\u5f0f $g$\uff0c\u4f7f $g= \\ln f$\u3002\n\n\u5bf9 $998244353$ \u53d6\u6a21\u3002\n\n$\\mathtt{restrictions:}1\\le n \\le 10^5$\u3002\n\n## $\\mathtt{Solution}$\n\n$\\ln$ \u663e\u7136\u662f\u4e0d\u597d\u6c42\u7684\uff0c\u6211\u4eec\u601d\u8003\u5982\u4f55\u8f6c\u5316\u3002\n\n\u8003\u8651\u6c42\u5bfc:$\\ln (x)'=\\dfrac 1 x$\n\n$$\\because g = \\ln f(x)$$\n\n\u7531\u590d\u5408\u51fd\u6570\u7684\u6c42\u5bfc\u6cd5\u5219\uff1a\n$$g(f(x))'=g'(f(x))f'(x)$$\n\u53ef\u5f97\n\n$$ g' = \\frac {f'(x)} {f(x)}$$\n\n\u6c42\u51fa $f$ \u7684\u5bfc\u6570\u548c\u9006\u5143\uff0c\u76f8\u4e58\u53ef\u5f97 $g'$\uff0c\u5bf9 $g'$ \u79ef\u5206\u53ef\u5f97 $g$\u3002\n\n\u6c42\u5bfc\u548c\u79ef\u5206\u516c\u5f0f\uff1a\n\n$$f(x)=x^n,f'(x)=nx^{n-1},\\int x^n \\text{dx}=\\dfrac{1}{n+1}x^{n+1}$$\n\n## $\\mathtt{Code}$\n\n```cpp\n//\u51fd\u6570\u53c2\u6570\u542b\u4e49\uff1a\n//dev(f,g,len) \u6c42 f \u7684\u5bfc\u6570\uff0c\u7ed3\u679c\u4e3a g\n//itg(f,g,len) \u6c42 f \u7684\u79ef\u5206\uff0c\u7ed3\u679c\u4e3a g\n//Getln(f,g,len) \u6c42 f \u7684 ln\uff0c\u7ed3\u679c\u4e3a g\n//Getinv(f,g,len) \u6c42 f \u7684\u9006\u5143\uff0c\u7ed3\u679c\u4e3a g\n//mul(f,g,r,len) \u6c42 f \u548c g \u7684\u5377\u79ef\uff0c\u7ed3\u679c\u4e3a r\n//\u4e0a\u8ff0 len \u8868\u793a\u5728\u6a21 x^len \u610f\u4e49\u4e0b\u8fdb\u884c\n\tinline void dev(const int f[],int g[],const int len) {\n\t\tfor (int i = 1; i < len; ++i) g[i-1] = 1ll * f[i] * i % mod ;\n\t\tg[len-1] = 0  ;\n\t}\n\n\tinline void itg(const int f[],int g[],const int len) {\n\t\tfor (int i = 1; i < len; ++i) g[i] = 1ll * f[i-1] * inv[i] % mod ;\n\t\tg[0] = 0 ; \n\t}\n\n\tinline void Getln(const int f[],int g[],const int len) {\n\t\tstatic int A[N],B[N] ;\n\t\tdev(f,A,len),Getinv(f,B,len),mul(A,B,A,len<<1),itg(A,g,len),memset(A,0,len<<2),memset(B,0,len<<2);\n\t}\n\n```",
        "postTime": 1624532993,
        "uid": 413147,
        "name": "_Alejandro_",
        "ccfLevel": 0,
        "title": "P4725\u9898\u89e3"
    },
    {
        "content": "### \u9898\u76ee\u5927\u610f\n\u7ed9\u5b9a $n-1$ \u6b21\u591a\u9879\u5f0f $g(x)$ \uff0c\u6c42\u591a\u9879\u5f0f $f(x)$ \u6ee1\u8db3\uff1a\n\n$f(x)\\equiv\\ln_{}{g(x)}$ $(mod$ $x^n)$\n\n\u7cfb\u6570\u5bf9 $998244353$ \u53d6\u6a21\u3002\n\n\u6570\u636e\u8303\u56f4 $n\\leq 10^5$ \u3002\n\n### solution\n\u524d\u7f6e\u829d\u58eb\uff1a\n\n\u591a\u9879\u5f0f\u6c42\u9006\uff0c~~\u975e\u5e38\u5165\u95e8\u7684~~\u6c42\u5bfc\uff0c\u79ef\u5206 \u3002\n\n\u7b2c\u4e00\u4e2a\u4e0d\u4f1a\u51fa\u95e8\u5de6\u62d0\uff0c\u540e\u4e24\u4e2a\u7684\u8bdd\uff0c\u8fd9\u91cc\u53ea\u8981\uff1a\n\n\u6c42\u5bfc\u516c\u5f0f $\\mathrm{d}$ $x^{a}=ax^{a-1}$ \u3002\n\n\u6c42\u5bfc\u6cd5\u5219 $\\mathrm{d}$ $f[g(x)]=f^{'}[g(x)]\\cdot g^{'}(x)$ \u3002\n\n\u79ef\u5206\u516c\u5f0f $\\int x^a=\\frac{1}{a+1}x^{a+1}$ \u3002\n\n\u5bf9\u4e8e\u591a\u9879\u5f0f\u521a\u521a\u6760\u5230\u8fd9\u9898\u7684\u6211\u4eec\u6765\u8bf4\uff0c $\\ln$ \u5b9e\u5728\u6709\u70b9\u964c\u751f\u3002\n\n\u4f46\u662f\u806a\u660e\u7684\u4f60\u4e00\u5b9a\u6ce8\u610f\u5230\u4e86 $\\ln_{}{x}$ \u6c42\u5bfc\u540e $\\Longrightarrow \\large\\frac{1}{x}$ \u3002\n\n\u6240\u4ee5\u6109\u5feb\u7684\u63a8\u67ff\u5b50\u53ea\u6709\u4e00\u884c\uff01\n\n$f(x)\\equiv\\ln_{}{g(x)}$ $(mod$ $x^n)$\n\n$f^{'}(x)\\equiv\\Large\\frac{g^{'}(x)}{g(x)}$ $(mod$ $x^n)$\n\n\u5b8c\u4e86\uff0c\n\n\u73c2\u4ee5\u5148\u6c42\u4e00\u4e0b $f^{'}(x)$ \uff0c\u518d\u79ef\u5206\u56de\u53bb\u5c31\u597d\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log_{2}{n})$ \u3002\n\n\u4eba\u50bb\u5e38\u719f\u5927 wtcl \u3002\u3002\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N=4e5+10;\ntypedef ll arr[N];\nconst int mod=998244353;\nconst int inv3=332748118;\nint n,inv,lim=1,fre,id[N];\narr f,g,ans,tmp;\ninline ll inc(ll x,ll y){return x+y>=mod?x+y-mod:x+y;}\ninline ll dec(ll x,ll y){return x-y<0?x-y+mod:x-y;}\ninline ll mul(ll x,ll y){return 1ll*x*y%mod;}\ninline int read()\n{\n\tint s=0,w=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9') s=s*10+ch-'0',ch=getchar();\n\treturn s*w;\n}\ninline int ksm(int a,int b)\n{\n\tint tmp=1;\n\twhile(b)\n\t{\n\t\tif(b&1)tmp=(1ll*tmp*a)%mod;\n\t\tb>>=1,a=(1ll*a*a)%mod;\n\t}\n\treturn tmp;\n}\ninline void Never_Tell_TLE(ll* NTT,int sign)\n{\n\tfor(int i=0;i<=lim;++i)if(i<id[i])\n\t{\n\t\tll NTt=NTT[i];\n\t\tNTT[i]=NTT[id[i]];\n\t\tNTT[id[i]]=NTt;\n\t}\n\tfor(int mid=1;mid<lim;mid<<=1)\n\t{\n\t\tint Unit_root;\n\t\tif(sign==1)Unit_root=ksm(3,(mod-1)/(mid<<1));\n\t\telse Unit_root=ksm(inv3,(mod-1)/(mid<<1));\n\t\tfor(int R=mid<<1,r=0;r<lim;r+=R)\n\t\t{\n\t\t\tint pw=1;\n\t\t\tfor(int l=0;l<mid;++l,pw=(1ll*pw*Unit_root)%mod)\n\t\t\t{\n\t\t\t\tint butt=NTT[l+r],rfly=(1ll*pw*NTT[l+r+mid])%mod;\n\t\t\t\tNTT[l+r]=inc(butt,rfly);\n\t\t\t\tNTT[l+r+mid]=dec(butt,rfly);\n\t\t\t}\n\t\t}\n\t}\n\tif(sign==-1)\n\t{\n\t\tint inv_lim=ksm(lim,mod-2);\n\t\tfor(int i=0;i<=lim;++i)NTT[i]=(1ll*NTT[i]*inv_lim)%mod;\n\t}\n}\ninline void Derivation(ll* F,ll* G,int nm)\n{\n\tfor(int i=1;i<nm;++i)\n\tG[i-1]=mul(1ll*i,F[i]);\n\tG[nm-1]=0;\n}\ninline void Inv(ll* F,ll* G,int nm)\n{\n\tif(nm==1)\n\t{\n\t\tG[0]=ksm(F[0],mod-2);\n\t\treturn;\n\t}\n\tInv(F,G,(nm+1)>>1);\n\tlim=1,fre=0;\n\tfor(;lim<(nm<<1);lim<<=1)++fre;\n\tfor(int i=0;i<=lim;++i)id[i]=(id[i>>1]>>1)|((i&1)<<(fre-1));\n\tfor(int i=0;i<nm;++i)ans[i]=F[i];\n\tfor(int i=nm;i<=lim;++i)ans[i]=0;\n\tNever_Tell_TLE(ans,1),Never_Tell_TLE(G,1);\n\tfor(int i=0;i<=lim;++i)G[i]=mul(inc(2ll,-mul(ans[i],G[i])+mod),G[i]);\n\tNever_Tell_TLE(G,-1);\n\tfor(int i=nm;i<=lim;++i)G[i]=0;\n}\ninline void Mul(ll* F,ll* G,int nm)\n{\n\tlim=1,fre=0;\n\tfor(;lim<(nm<<1);lim<<=1)++fre;\n\tfor(int i=0;i<=lim;++i)id[i]=(id[i>>1]>>1)|((i&1)<<(fre-1));\n\tint inv_lim=ksm(lim,mod-2);\n\tNever_Tell_TLE(G,1),Never_Tell_TLE(F,1);\n\tfor(int i=0;i<=lim;++i)G[i]=mul(F[i],G[i]);\n\tNever_Tell_TLE(G,-1);\n}\ninline void Integral(ll* F,ll* G,int nm)\n{\n\tfor(int i=1;i<nm;++i)\n\tG[i]=mul(F[i-1],ksm(i,mod-2));\n\tG[0]=0;\n}\ninline void solve(ll* F,ll* G,int nm)\n{\n\tInv(F,tmp,nm);\n\tfor(int i=0;i<=lim;++i)ans[i]=0;\n\tDerivation(F,ans,nm);\n\tMul(tmp,ans,nm);\n\tIntegral(ans,G,nm);\n}\nint main()\n{\n\tn=read();\n\tfor(int i=0;i<n;++i)f[i]=read();\n\tsolve(f,g,n);\n\tfor(int i=0;i<n;++i)printf(\"%d \",g[i]);\n\treturn 0;\n}\n```\n\u53ea\u6c42\u80fd\u5e2e\u52a9\u5230\u51e0\u4e2a\u4eba\u7f62\u3002\u3002",
        "postTime": 1617112977,
        "uid": 206024,
        "name": "Illusory_dimes",
        "ccfLevel": 7,
        "title": "\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5bf9\u6570\u51fd\u6570\uff08\u591a\u9879\u5f0f ln\uff09 \u9898\u89e3"
    },
    {
        "content": "\u4e00\u4e2a\u57fa\u7840\u7684\u7b97\u6cd5\u3002\n\n\u8003\u8651\u591a\u9879\u5f0f\u7684\u6c42\u5bfc\uff0c\u79ef\u5206\u90fd\u662f $O(n)$ \u7684\uff0c\u800c $\\ln$ \u7684\u6c42\u5bfc\u6709\u5947\u5999\u7684\u6027\u8d28\uff0c\u4e8e\u662f\u5f80\u8fd9\u65b9\u9762\u60f3\u3002\n\n$$\\ln f(x)\\equiv g(x)\\pmod {x^n}$$\n\n$$(\\ln f(x))'\\equiv (g(x))'\\pmod{x^n}$$\n\n$$\\frac{f'(x)}{f(x)}\\equiv g'(x)\\pmod{x^n}$$\n\n\u4e8e\u662f\u628a $f(x)$ \u6c42\u5bfc\uff0c\u6c42\u9006\u540e\u76f8\u4e58\u518d\u79ef\u5206\u5c31\u884c\u4e86\u3002\n\n\u9898\u76ee\u4e2d\u7684 $a_0 = 1$ \u662f\u4e3a\u4e86\u4fdd\u8bc1\u539f\u591a\u9879\u5f0f\u4e3a\u6574\u7cfb\u6570\u7684\u60c5\u51b5\u4e0b\uff0c $\\ln$ \u591a\u9879\u5f0f\u7684\u5e38\u6570\u7528\u6574\u6570\u7b97\u5f97\u51fa\u6765\u3002\u6240\u4ee5\u6700\u540e\u7b54\u6848\u5e38\u6570\u9879\u59cb\u7ec8\u4e3a $\\ln 1 = 0$\u3002\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n#include <algorithm>\n\ntypedef long long ll;\nconst int p = 998244353;\nconst int MAXN = 4000001;\n\ninline ll read() {\n    ll x = 0,f = 1; char ch = getchar();\n    while(ch > '9' || ch < '0') { if(ch == '-') f = -1; ch = getchar(); }\n    do x = (x * 10 + ch - 48) % p, ch = getchar(); while(ch >= '0' && ch <= '9');\n    return (x * f % p + p) % p;\n}\n\nint n,r[MAXN];\nll a[MAXN],b[MAXN],c[MAXN],t[MAXN];\n\nll fastpow(ll a,int b) {\n    ll res = 1; a %= p;\n    while(b) {\n        if(b & 1) res = res * a % p;\n        a = a * a % p;\n        b >>= 1;\n    }\n    return res;\n}\n\nvoid NTT(ll *a,int N) {\n    for(int i = 0;i < N;i++) if(i < r[i]) std::swap(a[i],a[r[i]]);\n    for(int n = 2,m = 1;n <= N;m = n, n <<= 1) {\n        ll g1 = fastpow(3,(p - 1) / n);\n        for(int l = 0;l < N;l += n) {\n            ll g = 1,t1,t2;\n            for(int i = l;i < l + m;i++) {\n                t1 = a[i], t2 = g * a[i + m] % p;\n                a[i] = (t1 + t2) % p;\n                a[i + m] = (t1 - t2 + p) % p;\n                g = g * g1 % p;\n            }\n        }\n    }\n    return;\n}\n\nvoid INTT(ll *a,int N) {\n    NTT(a,N);\n    std::reverse(a + 1,a + N);\n    int invN = fastpow(N,p - 2);\n    for(int i = 0;i < N;i++) a[i] = a[i] * invN % p;\n}\n\nvoid Dervt(ll *a,ll *b,int N) {\n    for(int i = 0;i < N - 1;i++) b[i] = a[i + 1] * (i + 1) % p;\n    b[N - 1] = 0;\n    return;\n}\n\nvoid Integ(ll *a,ll *b,int N) {\n    for(int i = 1;i < N;i++) b[i] = a[i - 1] * fastpow(i,p - 2) % p;\n    b[0] = 0;\n    return;\n}\n\nvoid Inv(ll *a,ll *b,int n) {\n    if(n == 1) return void(b[0] = fastpow(a[0],p - 2));\n    Inv(a,b,(n + 1) >> 1);\n    int N = 1, l = -1; while(N <= n << 1) N <<= 1, l++;\n    for(register int i = 1;i < N;i++) r[i] = (r[i >> 1] >> 1) | ((i & 1) << l);\n    for(register int i = 0;i < n;i++) t[i] = a[i];\n    for(register int i = n;i < N;i++) t[i] = 0;\n    NTT(t,N); NTT(b,N);\n    for(register int i = 0;i < N;i++) b[i] = ((b[i] << 1) % p + p - t[i] * b[i] % p * b[i] % p) % p;\n    INTT(b,N);\n    for(register int i = n;i < N;i++) b[i] = 0;\n    return;\n}\n\nvoid Ln(ll *a,int n) {\n    Dervt(a,b,n);\n    Inv(a,c,n);\n    int N = 1, l = -1; while(N <= n << 1) N <<= 1, l++;\n    for(register int i = 1;i < N;i++) r[i] = (r[i >> 1] >> 1) | ((i & 1) << l);\n    NTT(b,N); NTT(c,N);\n    for(int i = 0;i < N;i++) b[i] = b[i] * c[i] % p;\n    INTT(b,N); Integ(b,a,n);\n    return;\n}\n\nint main() {\n    n = read();\n    for(int i = 0;i < n;i++) a[i] = read();\n    Ln(a,n);\n    for(int i = 0;i < n;i++) std::printf(\"%lld \",a[i]);\n    return 0;\n}\n\n```",
        "postTime": 1594086583,
        "uid": 219595,
        "name": "Vocalise",
        "ccfLevel": 9,
        "title": "\u591a\u9879\u5f0fln--\u9898\u89e3 P4725 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u5bf9\u6570\u51fd\u6570\uff08\u591a\u9879\u5f0f ln\uff09\u3011"
    }
]
[
    {
        "content": "upd\uff1a\u5f88\u62b1\u6b49\u6700\u540e\u4e00\u4e2a\u5f0f\u5b50\u6253\u9519\u4e86\uff0c\u73b0\u5df2\u4fee\u590d\u3002\n\n\u9996\u5148\u5bb9\u6613\u53d1\u73b0\u6027\u8d28\uff1a\u4e24\u4e2a\u7403\u7ecf\u8fc7 $t$ \u65f6\u95f4\u82e5\u5728\u540c\u4e00\u4f4d\u7f6e\uff0c**\u5f53\u4e14\u4ec5\u5f53\u5b83\u4eec\u7684\u77ac\u79fb\u6b21\u6570\u6a21 2 \u540c\u4f59\u3002**\n\n\u90a3\u4e48\u679a\u4e3e\u9898\u76ee\u4e2d\u9009\u62e9\u7684\u65f6\u523b\uff08\u5373\u4e8c\u5143\u7ec4\u4e2d\u7684 $j$\uff0c\u4e3a\u4e86\u65b9\u4fbf\u8fd9\u91cc\u8bb0\u4e3a $k$\uff09\uff0c\u8ba8\u8bba\u4e24\u4e2a\u7403\u5728\u540c\u4e00\u4f4d\u7f6e\u65f6\u77ac\u79fb\u7684\u6b21\u6570\uff1a\n$$\\text{even}_k=\\sum_{i=0}^k \\binom kip^i(1-p)^{k-i}[i \\bmod 2 = 0]$$\n$$\\text{odd}_k =\\sum_{i=0}^k \\binom kip^i(1-p)^{k-i}[i \\bmod 2 = 1] $$\n\u7b97\u51fa\u7684\u5c31\u662f\u5728 $k$ \u65f6\u523b\u77ac\u79fb\u6b21\u6570\u5206\u522b\u4e3a \u5947\u6570/\u5076\u6570 \u7684\u6982\u7387\u3002  \n\u4e8e\u662f\u76f4\u63a5\u5f97\u5230\u7b54\u6848\u8ba1\u7b97\u5f0f\uff1a\n\n$$\\text{ans} = \\frac{1}{2n} \\frac{1}{t+1}\\sum_{k=1}^{t+1} \\text{even}_k^2+\\text{odd}_k^2$$\n\uff08\u8fd9\u91cc\u679a\u4e3e\u4ece $1 \\sim k+1$ \u662f\u56e0\u4e3a\uff0c\u9898\u76ee\u4e2d\u7684\u96f6\u65f6\u523b\u4e5f\u53ef\u4ee5\u77ac\u79fb\uff0c\u800c\u8fd9\u91cc\u7684 $k$ \u5b9e\u9645\u4e0a\u662f\u77ac\u79fb\u6b21\u6570\u4e0a\u9650\uff09\n\n\u6ce8\u610f\u5230\u4e0a\u9762\u4e24\u4e2a\u5f0f\u5b50\u5f88\u50cf\u4e8c\u9879\u5f0f\u5c55\u5f00\uff0c\u8003\u8651\u62c6 $[i \\bmod 2 = 0]$ \u4e3a $(1+(-1)^i)/2$\uff1a\n\n$$\\text{even}_k= \\sum_{i=0}^k \\binom kip^i(1-p)^{k-i}[2|i]$$\n$$= \\frac 12\\sum_{i=0}^k \\binom ki p^i(1-p)^{k-i}(1+(-1)^i)$$\n$$ = \\frac 12\\left( \\sum_{i=0}^k \\binom kip^i(1-p)^{k-i}+\\sum_{i=0}^k\\binom ki(-p)^i(1-p)^{k-i} \\right)$$\n$$= \\frac 12(1+(1-2p)^k)$$\n\u7c7b\u4f3c\u5730\u4e5f\u80fd\u5f97\u5230\n$$\\text{odd}_k= \\frac 12(1-(1-2p)^k)$$\n\u628a\u5e73\u65b9\u5c55\u5f00\uff0c\u7b54\u6848\u5c31\u5f88\u660e\u663e\u4e86\uff1a\n\n$$\\text{ans} = \\frac{1}{2n}\\frac{1}{t+1}\\sum_{k=1}^{t+1} \\frac{1+(1-2p)^{2k}}{2}$$\n\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(\\log n + \\log t)$\u3002",
        "postTime": 1591437897,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "\u300cEZEC-2\u300d\u673a\u5668 Solution"
    },
    {
        "content": "![](https://cdn.luogu.com.cn/upload/image_hosting/s6ozu5pj.png)\n\n\u5783\u573e\u7684\u5b98\u65b9\u9898\u89e3\u3002\n\n\u6982\u7387 $dp$\u3002    \n\n\u9996\u5148\u6709\u4e00\u4e2a\u6613\u9519\u70b9\uff0c\u9898\u76ee\u4e2d\u4e5f\u6807\u51fa\u6765\u4e86\uff0c\u5373\u8ba1\u7b97\u7684\u6982\u7387\u662f**\u505c\u7559**\u7684\u800c\u975e**\u7ecf\u8fc7**\u7684\u3002   \n\n\u4e0b\u9762\u8bb0\u5c0f\u5b54 $i$ \u5bf9\u9762\u7684\u5c0f\u5b54\u4e3a $to_i$\uff0c\u4e0a\u4e00\u4e2a\u5c0f\u5b54\u4e3a $lst_i$\u3002  \n\n\u6211\u4eec\u8bbe $P_{i,j}$ \u4e3a\u65f6\u95f4\u4e3a $i$ \u65f6\uff0c\u5c0f\u5b54 $j$ \u6709\u5c0f\u7403\u901a\u8fc7\u7684\u6982\u7387\u3002  \n\n\u5bb9\u6613\u770b\u51fa\uff1a   \n$$P_{i,j}=(1-p)P_{i-1,lst_j}+pP_{i-1,lst_{to_j}}$$     \n\n\u4f46\u662f\u5982\u679c\u4e0d\u6ce8\u610f\u7ec6\u8282\u5c31\u4f1a\u51fa\u73b0\u5f88\u591a\u9519\u8bef\uff0c\u6bd4\u5982\uff1a   \n\n\u9012\u63a8\u5f0f\u4e3a\u4ec0\u4e48\u4e0d\u662f $P_{i,j}=(1-p)P_{i-1,lst_j}+pP_{i,to_j}$\uff1f    \n\u56e0\u4e3a $P_{i,to_j}$ \u662f\u5728\u5c0f\u5b54 $to_j$ \u4e0a**\u505c\u7559**\u7684\u6982\u7387\uff0c\u5c31\u4e0d\u4f1a\u77ac\u79fb\u8fc7\u6765\u4e86\u3002  \n\n\u7cfb\u6570\u7684\u610f\u4e49\uff1f    \n\u5728 $lst_j$ \u4e0a\u505c\u7559\u7684\u5c0f\u7403\u4e00\u5b9a\u4f1a\u7ecf\u8fc7 $j$ ,\u8fd9\u91cc\u7684 $1-p$ \u7cfb\u6570\u53ea\u662f\u4fdd\u969c\u5c0f\u7403\u5728 $j$ \u4e0d\u77ac\u79fb\u3002     \n\n\u540c\u7406\uff0c\u7cfb\u6570 $p$ \u8868\u793a\u5c0f\u7403\u5728 $to_j$ \u53ef\u4ee5\u77ac\u79fb\uff0c\u7531\u4e8e\u6bcf\u79d2\u53ea\u80fd\u77ac\u79fb\u4e00\u6b21\uff08\u4e5f\u5c31\u662f\u4e0d\u80fd\u5728\u9762\u5bf9\u9762\u7684\u4e24\u4e2a\u5b54\u4e4b\u95f4\u77ac\u79fb $>1$ \u6b21\uff09\uff0c\u6240\u4ee5\u5e76\u4e0d\u9700\u8981\u5176\u4ed6\u7cfb\u6570\u4e86\u3002    \n\n\u5f53\u7136\u8fd9\u8fd8\u4e0d\u591f\u3002    \n\n\u5206\u6790\u95ee\u9898\uff0c\u6211\u4eec\u53d1\u73b0\u8981\u6c42\u7684\u4e3a\uff1a   \n\n$$\\dfrac{1}{2n(t+1)}\\sum\\limits_{i=0}^t(P_{i,(i+1)\\bmod 2n}^2+P_{i,to_{(i+1)\\bmod 2n}}^2)\\;\\;\\bmod 10^9+7$$      \n\n\u9996\u5148\u7531\u4e8e $2n\u00d72n$ \u7684\u77e9\u9635\u8fc7\u5927\uff0c\u590d\u6742\u5ea6\u4f1a\u57ae\uff08~~\u4e3a\u4e86\u826f\u5fc3\uff0c\u6211\u8fd8\u662f\u7ed9\u4e86\u4e00\u4e9b\u5206\u7684~~\uff09\u3002    \n\n\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u6709\u9012\u63a8\u5f0f:\n$$P_{i,j}=(1-p)P_{i-1,lst_j}+pP_{i-1,lst_{to_j}}$$      \n\u540c\u7406\u53c8\u6709\uff1a   \n$$P_{i,to_j}=(1-p)P_{i-1,lst_{to,j}}+pP_{i-1,lst_j}$$    \n\n\u53ef\u4ee5\u770b\u6210\u4e00\u7ec4\uff0c\u4e14\u76f8\u5173\u5143\u7d20\u76f8\u540c\uff0c\u6df1\u4e00\u6b65\u53d1\u73b0\uff1a   \n\n$lst_j$ \u548c $lst_{to_j}$ \u4e5f\u662f\u76f8\u5bf9\u7684\u3002     \n\n\u6211\u4eec\u6784\u9020\u51fd\u6570\uff08~~\u5176\u5b9e\u662f\u4e3a\u4e86\u597d\u8868\u8fbe~~\uff09$f_i,g_i$ \u5206\u522b\u4ee3\u8868 $P_{i,(i+1)\\bmod 2n},P_{i,to_{(i+1)\\bmod 2n}}$\uff0c\u6362\u53e5\u8bdd\u8bf4\u5c31\u662f\u5c0f\u7403\u505c\u7559\u5728\u5047\u8bbe\u524d\u9762\u7684\u70b9\u90fd\u4e0d\u77ac\u79fb\u65f6\u95f4 $i$ \u5230\u8fbe\u7684\u5b54\u7684\u6982\u7387\uff0c\u548c\u505c\u7559\u5728\u4e0e\u90a3\u4e2a\u5b54\u76f8\u5bf9\u7684\u5b54\u7684\u6982\u7387\u3002   \n\n\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u7684\u91cd\u70b9\u5728\u7ef4\u62a4\uff1a   \n\n$$\\sum\\limits_{i=0}^t (f_i^2+g_i^2)$$     \n\n\u7136\u540e\u8fd9\u4e2a\u4e1c\u897f\u662f\u53ef\u4ee5\u7528\u77e9\u9635\u7ef4\u62a4\u7684\u3002    \n\n\u5177\u4f53\u5730\u63a8\u4e00\u4e0b(\u5176\u5b9e\u5e26\u5165\u4e24\u4e2a\u9012\u63a8\u5f0f\u5373\u53ef/xk)\uff1a   \n\n$$f_{i}^2=((1-p)f_{i-1}+pg_{i-1})^2=(1-p)^2f_{i-1}^2+2p(1-p)f_{i-1}g_{i-1}+p^2g_{i-1}^2$$     \n$$g_{i}^2=(pf_{i-1}+(1-p)g_{i-1})^2=p^2f_{i-1}^2+2p(1-p)f_{i-1}g_{i-1}+(1-p)^2g_{i-1}^2$$   \n$$f_ig_i=((1-p)f_{i-1}+pg_{i-1})(pf_{i-1}+(1-p)g_{i-1})=p(1-p)f_{i-1}^2+(p^2+(1-p)^2)f_{i-1}g_{i-1}+p(1-p)g_{i-1}^2=p(1-p)f_{i-1}^2+(1+2p^2-2p)f_{i-1}g_{i-1}+p(1-p)g_{i-1}^2$$     \n\n\u90a3\u4e48\u6784\u9020\u77e9\u9635\uff1a   \n\n$$\\begin{pmatrix}\\sum\\limits_{i=0}^0 f_i^2+g_i^2\\\\f_0g_0\\\\f_0^2\\\\g_0^2\\end{pmatrix}\u00d7\\begin{pmatrix}1&4p(1-p)&1+2p^2-2p&1+2p^2-2p\\\\0&1+2p^2-2p&p(1-p)&p(1-p)\\\\0&2p(1-p)&(1-p)^2&p^2\\\\0&2p(1-p)&p^2&(1-p)^2\\end{pmatrix}^t$$      \n\n\u77e9\u9635\u521d\u59cb\u503c\uff1a  \n\n$$\\begin{pmatrix}p^2+(1-p)^2\\\\p(1-p)\\\\p^2\\\\(1-p)^2\\end{pmatrix}$$    \n\n\u6700\u540e\u5f97\u51fa $2n(t+1)$ \u7684\u9006\u5143\u4e58\u4e0a\u5373\u53ef\u3002\n\n\u8fd8\u6709\u4e00\u79cd\u505a\u6cd5\uff1a   \n\n\u6211\u4eec\u5bb9\u6613\u53d1\u73b0\u4e00\u79d2\u5c0f\u7403\u53ea\u53ef\u80fd\u5728\u4e24\u4e2a\u4f4d\u7f6e\uff08\u76f8\u5bf9\u7684\u4e24\u4e2a\u5b54\uff09\u51fa\u73b0\uff0c\u4e5f\u5c31\u662f\u8bf4\uff1a  \n\n$$f_i+g_i=1$$    \n  \n\u90a3\u4e48:  \n$$(f_i+g_i)^2=f_i^2+g_i^2+2f_ig_i=1$$       \n\n\u90a3\u4e48\u539f\u5f0f\u4e3a\uff1a  \n$$\\dfrac{1}{2n(t+1)}(t+1-2\\sum\\limits_{i=0}^t f_ig_i)$$    \n\u4e5f\u53ef\u4ee5\u7c7b\u4f3c\u524d\u9762\u7684\u505a\u6cd5\u6784\u9020\uff0c\u5c31\u4e0d\u591a\u8bf4\u4e86\u3002        \n\n\u603b\u7ed3\uff1a\u8fd9\u662f\u4e00\u9053\u7b80\u5355\u7684\u6982\u7387 $dp$ \uff0c\u4e3b\u8981\u8003\u5bdf\u5bf9\u6982\u7387\u7684\u7406\u89e3\u548c\u5bf9\u77e9\u9635\u7684\u7075\u6d3b\u5e94\u7528\uff0c\u662f\u4e00\u9053\u4e0d\u53ef\u591a\u5f97\u7684\u7b7e\u5230\u9898\u3002   \n\n\u6709\u4e0d\u9700\u8981\u77e9\u9635\u7684\u505a\u6cd5\uff0c\u5f53\u65f6\u6ca1\u6709\u8003\u8651\u5230\uff0c\u671b\u89c1\u8c05\uff0c\u6bd5\u7adf\u6761\u6761\u5927\u8def\u901a\u7f57\u9a6c\uff0c\u5e76\u4e14\u4e24\u79cd\u505a\u6cd5\u5728\u5b9e\u9645\u7684\u901f\u5ea6\u4e0a\u6ca1\u6709\u4efb\u4f55\u5dee\u8ddd\uff0c\u56e0\u4e3a\u672c\u6765 $\\mathcal O(\\log n)$ \u5c31\u5f88\u5c0f\u554a\u3002",
        "postTime": 1589327790,
        "uid": 184500,
        "name": "hanzhongtlx",
        "ccfLevel": 4,
        "title": "\u9898\u89e3\u3010\u673a\u5668\u3011"
    },
    {
        "content": "\u8bf4\u70b9\u95f2\u8bdd\uff1a\n\n\u5728\u6211\u7684\u5f3a\u70c8\u8981\u6c42\u4e0b\uff0c\u51fa\u9898\u4eba\u628a\u8fd9\u9898\u52a0\u5f3a\u4e86\u3002\n\n\u539f\u9898\u662f $n=2$\uff0c\u800c\u4e14\u95ee\u9898\u53ea\u662f\u6c42\u5355\u65f6\u95f4\u4f4d\u7f6e\u7684\u6982\u7387\u3002\n\n\u5f53\u7136\u4e4b\u540e\u6211\u5f88\u826f\u5fc3\u5730\u8bf7\u6c42~~\u5f3a\u8feb~~\u4ed6\u591a\u7ed9\u4e86\u5f88\u591a\u90e8\u5206\u5206\u3002\n\n------------\n\n\u9996\u5148\uff0c\u8bbe $f_{i,j}$ \u4e3a\u65f6\u95f4\u4e3a $j$ \u65f6\u67d0\u4e2a\u5f15\u529b\u673a\u5668\u7684\u5c0f\u5b54 $i$ \u6709\u5c0f\u7403\u505c\u7559\u7684\u6982\u7387\uff0c\u7531\u4e8e\u4e24\u4e2a\u673a\u5668\u4e00\u6837\uff0c\u663e\u7136\u540c\u65f6\u6709\u5c0f\u7403\u505c\u7559\u7684\u6982\u7387\u4e3a $f_{i,j}^2$\n\n### Subtask 1\uff1a\u6c42\u9006\u5143\u6a21\u677f\u9898\u3002\n\n\u7531\u4e8e $p\\in \\{0,1\\}$\uff0c\u5f88\u663e\u7136\u4e24\u4e2a\u88c5\u7f6e\u7684\u5c0f\u7403\u5728\u6bcf\u4e2a\u65f6\u523b\u90fd\u4e00\u5b9a\u662f\u5728\u540c\u4e00\u4e2a\u4f4d\u7f6e\u3002\n\n\u6240\u4ee5\u7b54\u6848\u4e3a $\\frac{1}{2\\times n} \\mod 1000000007$\n\n### Subtask 2\uff1a$O(2^t)$ \u7206\u641c\u5373\u53ef\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u8981\u77e5\u9053 **$1-p$ \u5728\u8fd9\u91cc\u7b49\u4ef7\u4e8e $mod+1-p$**\n\ndfs \u65f6\u8bb0\u5f55\u5f53\u524d\u4f4d\u7f6e\u7684\u6982\u7387\uff0c\u679a\u4e3e\u77ac\u79fb\u548c\u4e0d\u77ac\u79fb\u518d\u5c06\u6982\u7387\u76f8\u4e58\u5373\u53ef\u3002\n\n### Subtask 3,4\uff1a$O(tn)$ dp\u3002\n\n\u8bbe $f_{i,j}$ \u4e3a\u5c0f\u7403\u5728 $i$ \u65f6\u523b\u4f4d\u4e8e $j$ \u5c0f\u5b54\u7684\u6982\u7387\u3002\n\n\u6839\u636e\u9898\u610f\uff0c\u6709 $f_{i,j} = f_{i-1,j-1} \\times (1-p) + f_{i-1,j+n-1} \\times p$\n\n\n\u4e3a\u4e86\u4fdd\u8bc1 $j-1$ \u548c $j+n-1$ \u5728 $1$ \u5230 $2n$ \u95f4\uff0c\u52a0\u52a0\u51cf\u51cf\u6a21\u4e00\u6a21\u5373\u53ef\u3002\n\n\u7b54\u6848\u5373\u4e3a $\\frac{\\sum \\limits _{i=0}^t \\sum \\limits _{j=1} ^ {2n} f_{i,j}^2}{2\\times n \\times (t+1)} \\mod 1000000007$\n\n### Subtask 5\uff1a$O(t)$ dp\u3002\n\n\u624b\u52a8\u6a21\u62df\u4e00\u4e0b\u5373\u53ef\u53d1\u73b0\uff0c\u5728\u4efb\u4e00\u65f6\u523b\uff0c\u5c0f\u7403\u90fd\u6700\u591a\u53ea\u53ef\u80fd\u5728\u4e24\u4e2a\u5c0f\u5b54\u5904\u3002\n\n\u6240\u4ee5\u53ea\u9700\u8bbe $f_{i,0}$ \u4e3a\u5c0f\u7403\u5728 $i$ \u65f6\u523b\u4f4d\u4e8e $i \\mod 2n +1$ \u5c0f\u5b54\u7684\u6982\u7387\u3002\n\n\u8bbe $f_{i,1}$ \u4e3a\u5c0f\u7403\u5728 $i$ \u65f6\u523b\u4f4d\u4e8e $(i+n) \\mod 2n +1$ \u5c0f\u5b54\u7684\u6982\u7387\u3002\n\n\u5219 $f_{i,0} = f_{i-1,0} \\times (1-p) + f_{i-1,1} \\times p$\n\n$f_{i,1} = f_{i-1,0} \\times p + f_{i-1,1} \\times (1-p)$\n\n### Subtask 6\uff1a$O(n^3logt)$ \u5373 Subtask 3,4 \u7684\u601d\u8def\u76f4\u63a5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u5b9e\u73b0\u3002\n\n~~\u597d\u50cf\u5b9e\u73b0\u8d77\u6765\u6709\u70b9\u9ebb\u70e6\uff0c\u8fd8\u4e0d\u77e5\u9053\u80fd\u4e0d\u80fd\u8fc7\u3002~~\n\n### Subtask 7\uff1a$O(logt)$ \u5373 Subtask 5 \u7684\u601d\u8def\u76f4\u63a5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u5b9e\u73b0\u3002\n\n\u8bbe $F_{i,0}$ \u4e3a\u5c0f\u7403\u5728 $i$ \u65f6\u523b\u4f4d\u4e8e $i \\mod 2n +1$ \u5c0f\u5b54\u7684\u6982\u7387\u3002\n\n\u8bbe $F_{i,1}$ \u4e3a\u5c0f\u7403\u5728 $i$ \u65f6\u523b\u4f4d\u4e8e $(i+n) \\mod 2n +1$ \u5c0f\u5b54\u7684\u6982\u7387\u3002\n\n\u521d\u59cb\u503c\uff1a$F_{0,0} = 1 - p,F_{0,1} = p$\n\n$F_{i+1,0} = F_{i,0} \\times (1-p) +F_{i,1} \\times p$\n\n$F_{i+1,1} = F_{i,0} \\times p +F_{i,1} \\times (1-p)$\n\n\u6211\u4eec\u9700\u8981\u6c42 $\\sum \\limits _{i=0}^t F_{i,0}^2+F_{i,1}^2$\n\n\u4e8e\u662f\u6211\u4eec\u628a\u4e0a\u9762\u4e24\u4e2a\u5f0f\u5b50\u5206\u522b\u5e73\u65b9\u540e\u62c6\u5f00\u3002\n\n$F_{i+1,0}^2 = F_{i,0}^2\\times (1-p)^2+F_{i,1}^2\\times p^2 +  F_{i,0}\\times F_{i,1}\\times2\\times (1-p)\\times p$\n\n$F_{i+1,1}^2 = F_{i,0}^2\\times p^2+F_{i,1}^2\\times (1-p)^2 +  F_{i,0}\\times F_{i,1}\\times2\\times (1-p)\\times p$\n\n\u6211\u4eec\u518d\u5c06\u90a3\u4e24\u4e2a\u5f0f\u5b50\u76f8\u4e58\u3002\n\n$F_{i,0}\\times F_{i,1} = F_{i,0}^2\\times (1-p)\\times p +F_{i,1}^2\\times (1-p)\\times p + F_{i,0} \\times F_{i,1} \\times ((1-p)^2+p^2)$\n\n\u6700\u540e\u76f4\u63a5\u77e9\u9635\u5feb\u901f\u5e42\u5373\u53ef\u3002\n\n\u8bb0 $S_i$ \u4e3a $\\sum \\limits _{j=0}^i F_{j,0}^2+F_{j,1}^2$\n\n\u6784\u9020\u77e9\u9635\u5982\u4e0b\uff1a\n\n$\\begin{Bmatrix}S_{i-1}&F_{i,0}^2&F_{i,1}^2&F_{i,0}\\times F_{i,1} \\end{Bmatrix}  \\times \\begin{Bmatrix}1&0&0&0 \\\\ 1&(1-p)^2&p^2&(1-p)\\times p \\\\ 1&p^2&(1-p)^2&(1-p)\\times p \\\\ 0&2\\times (1-p)\\times p&2\\times (1-p)\\times p&(1-p)^2+p^2\\end{Bmatrix}$\n\n\u77e9\u9635\u521d\u59cb\u503c\uff1a\n\n$\\begin{Bmatrix}0&(1-p)^2&p^2&(1-p)\\times p \\end{Bmatrix} $\n\n\n------------\n\n\nCode\uff1a\n\n```cpp\n#include<cmath>\n#include<cstdio>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\n#define G() Cr=getchar()\n#define LL long long\n#define mod 1000000007\nLL Xr; char Cr;\ninline LL rd(){\n    Xr = 0, G();\n    while(Cr < '0' || Cr > '9') G();\n    while(Cr >= '0' && Cr <= '9') Xr = (Xr<<3) + (Xr<<1) + (Cr & 15), G();\n    return Xr;\n}\n\nLL t, p, k, n;\nLL Ans[10], Base[10][10];\n\nvoid mul_ans() {\n\tLL A[10];\n\tfor(int i = 1; i <= 4; i++) A[i] = Ans[i], Ans[i] = 0;\n\tfor(int j = 1; j <= 4; j++)\n\t\tfor(int k = 1; k <= 4; k++)\n\t\t\tAns[j] = (Ans[j] + A[k] * Base[k][j]) % mod;\n}\n\nvoid mul_base() {\n\tLL A[10][10];\n\tfor(int i = 1; i <= 4; i++)\n\t\tfor(int j = 1; j <= 4; j++)\n\t\t\tA[i][j] = Base[i][j], Base[i][j] = 0;\n\tfor(int i = 1; i <= 4; i++)\n\t\tfor(int j = 1; j <= 4; j++)\n\t\t\tfor(int k = 1; k <= 4; k++)\n\t\t\t\tBase[i][j] = (Base[i][j] + A[i][k] * A[k][j]) % mod;\n}\n\nLL qui(LL x, LL y) {\n\tLL s = 1;\n\twhile(y) {\n\t\tif(y&1) s = s * x % mod;\n\t\ty /= 2;\n\t\tx = x * x % mod;\n\t}\n\treturn s;\n}\n\nLL work(LL x, LL y) {\n\treturn x * qui(y, mod-2) % mod;\n}\n\nint main() {\n    n = rd(), p = rd(), t = rd();\n    Ans[2] = (mod + 1 - p) * (mod + 1 - p) % mod, Ans[3] = p * p % mod, Ans[4] = (mod + 1 - p) * p % mod;\n    Base[1][1] = Base[2][1] = Base[3][1] = 1;\n    Base[2][2] = Base[3][3] = (mod + 1 - p) * (mod + 1 - p) % mod;\n    Base[3][2] = Base[2][3] = p * p % mod;\n    Base[4][2] = Base[4][3] = 2 * (mod + 1 - p) * p % mod;\n    Base[2][4] = Base[3][4] = (mod + 1 - p) * p % mod;\n    Base[4][4] = (Base[2][2] + Base[3][2]) % mod;\n\tLL s = t + 1;\n\twhile(s) {\n\t\tif(s&1) mul_ans();\n\t\tmul_base();\n\t\ts /= 2;\n\t}\n\tcout<<work(Ans[1], 2*n*(t+1)%mod);\n}\n```\n",
        "postTime": 1589367749,
        "uid": 250469,
        "name": "\u541b\u306eNOIP\u3002",
        "ccfLevel": 6,
        "title": "\u300cEZEC-2\u300d\u673a\u5668"
    },
    {
        "content": "~~\u8003\u8651\u540a\u6253std\u3002~~\n\n\u524d\u7f6e\u829d\u58eb\uff1a\u9006\u5143\uff0c\u5feb\u901f\u5e42\uff0c\u7b80\u5355\u6570\u5b66\uff0c\u4e8c\u9879\u5f0f\u5b9a\u7406\u3002\n\n\u9996\u5148\u6761\u4ef6\u5206\u6210\u4e24\u90e8\u5206\uff1a\n\n\uff081\uff09\u4e24\u4e2a\u7403\u5728\u540c\u4e00\u4e2a\u4f4d\u7f6e\u3002\n\n\uff082\uff09\u5728\uff081\uff09\u7684\u6761\u4ef6\u4e0b\uff0c\u6070\u597d\u9009\u62e9\u4e86 $i$ \u662f\u90a3\u4e00\u4e2a\u4f4d\u7f6e\u3002\u8fd9\u90e8\u5206\u7684\u6982\u7387\u663e\u7136\u662f $\\dfrac{1}{2n}$\u3002\n\n\u8003\u8651\u6c42 \uff081\uff09 \u7684\u6982\u7387\uff0c\u5047\u8bbe\u9009\u7684\u4e8c\u5143\u7ec4\u65f6\u95f4\u7ef4\u4e3a $j$\u3002\n\n\u7ed3\u8bba\uff1a\u8fd9\u7b49\u4ef7\u4e8e\u4e24\u4e2a\u7403\u5728 $2j+2$ \u4e2a\u53ef\u80fd\u77ac\u79fb\u7684\u65f6\u95f4\u5185\u6070\u597d\u9009\u62e9\u4e86\u5076\u6570\u4e2a\u3002\n\n\u8bc1\u660e\uff1a\u7531\u4e8e\u4e00\u6b21\u77ac\u79fb\u591a\u8d70\u4e86\u534a\u5708\uff0c\u5e76\u4e14\u6b63\u5e38\u8d70\u7684\u8bdd\u8d70\u7684\u8def\u7a0b\u662f\u4e00\u6837\u7684\u3002\u6240\u4ee5\u4e24\u4e2a\u7403\u77ac\u79fb\u6b21\u6570\u5dee\u662f\u5076\u6570\u5c31\u662f\u591a\u8d70\u4e86\u6574\u6570\u5708\uff0c\u4e5f\u5c31\u662f\u5728\u540c\u4e00\u4e2a\u70b9\u3002\u800c\u5dee\u662f\u5076\u6570\u548c\u548c\u662f\u5076\u6570\u7b49\u4ef7\uff0c\u5f97\u8bc1\u3002\n\n\u7b80\u5355\u7684\u8ba1\u7b97\u53ef\u4ee5\u5f97\u5230\u7b54\u6848\u662f $\\dfrac{1}{2}(1+(2p-1)^{2j+2})$\u3002\u8fd9\u4e00\u90e8\u5206\u5f88\u7ecf\u5178\uff0c\u5177\u4f53\u8ba1\u7b97\u653e\u5230\u6700\u540e\u3002\n\n\u7531\u4e8e $j$ \u4e00\u7ef4\u4e0a\u662f\u7b49\u6982\u7387\u7684\uff0c\u679a\u4e3e\u6240\u6709\u7684\u548c\uff0c\u6c42\u4e2a\u5e73\u5747\u6570\u5373\u53ef\u3002\u8fd9\u6b63\u597d\u662f\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u7684\u5f62\u5f0f\uff0c\u53ef\u4ee5\u5feb\u901f\u8ba1\u7b97\uff1a\n\n$$\\frac{1}{t+1}\\sum_{i=0}^{t}\\frac{1}{2}(1+(2p-1)^{2i+2})=\\frac{1}{2}(1+\\frac{(2p-1)^2}{(t+1)(4p^2-4p)}((2p-1)^{2t+2}-1))$$\n\n\u6ce8\u610f\u8fd9\u91cc\u7684\u65f6\u95f4\u662f\u4ece $0$ \u5f00\u59cb\u7684\u6240\u4ee5\u662f $t+1$\u3002\n\n\u524d\u9762\u63d0\u5230\u7559\u5728\u6700\u540e\u7684\u90e8\u5206\uff1a\n\n\u4e5f\u5c31\u662f\u4e00\u4e2a\u957f\u5ea6\u4e3a $t$ \u7684 $01$ \u5e8f\u5217\uff0c\u662f $0$ \u7684\u6982\u7387\u662f $p$\uff0c\u662f $1$ \u7684\u6982\u7387\u662f $1-p$\uff0c\u6c42\u5076\u6570\u4e2a $0$ \u7684\u6982\u7387\u3002\uff08\u540c\u65f6\u4e5f\u6709\u5076\u6570\u4e2a $1$\uff0c\u4e0a\u9762 $t$ \u662f\u5076\u6570\uff09\n\n\u6709 $x$ \u4e2a $0$ \u7684\u6982\u7387\u662f $C_t^xp^x(1-p)^{t-x}$\u3002\uff08\u9009\u62e9 $x$ \u4e2a\u4f4d\u7f6e $C_t^x$\uff0c\u6bcf\u4e00\u4f4d\u90fd\u662f\u76f8\u5e94\u7684 $01$ \u662f\u540e\u8005\uff09\n\n\u5bf9\u4e8e $x$ \u6c42\u548c\uff1a\n\n$$\\sum_{i = 0}^{[t/2]}\\binom{t}{2i}p^{2i}(1-p)^{t-2i}=\\frac{1}{2}(p+(1-p))^{t}+\\frac{1}{2}(p-(1-p))^t=\\frac{1}{2}(1+(2p-1)^t)$$\n\n\u8fd9\u91cc\uff0c$[x]$ \u8868\u793a\u4e0d\u5927\u4e8e $x$ \u7684\u6700\u5927\u6574\u6570\uff0c$=$ \u53f3\u8fb9\u7684\u5f0f\u5b50\u7ecf\u8fc7\u4e8c\u9879\u5f0f\u5b9a\u7406\u5c55\u5f00\u6070\u597d\u662f\u5de6\u5f0f\u3002",
        "postTime": 1591507889,
        "uid": 254752,
        "name": "JohnVictor",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P6601 \u3010\u300cEZEC-2\u300d\u673a\u5668\u3011"
    }
]
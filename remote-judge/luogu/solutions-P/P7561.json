[
    {
        "content": "\u8fd9\u5e94\u8be5\u662f JOISC2021 \u6700\u7b80\u5355\u7684\u4e00\u9898\u4e86\u3002\n\n\u6c42\u524d $k $ \u5927\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\uff0c\u5148\u8003\u8651\u6c42\u7b2c $k$ \u5927\u7684\u8ddd\u79bb\u3002\n\n\u7b2c $k$ \u5927\u7684\u8ddd\u79bb\uff0c\u6bd4\u8f83\u5957\u8def\u7684\u505a\u6cd5\u662f\u4e8c\u5206\u7b54\u6848\uff0c\u7136\u540e\u8ba1\u7b97\u8ddd\u79bb $\\le dis$ \u7684\u70b9\u5bf9\u6570\u3002\n\n\u66fc\u54c8\u987f\u8ddd\u79bb\u4e0d\u597d\u6c42\uff0c\u8003\u8651\u8f6c\u5316\u4e3a\u5207\u6bd4\u96ea\u592b\u8ddd\u79bb\uff0c\u539f\u6765\u7684\u70b9 $(x,y)\\to (x+y,x-y)$ \u3002\n\n\u90a3\u4e48\u8fd9\u5c31\u662f\u4e00\u4e2a\u7ecf\u5178\u7684\u4e8c\u7ef4\u6570\u70b9\u95ee\u9898\u3002\n\n\u540c\u65f6\u6211\u4eec\u4e0d\u9700\u8981\u771f\u6b63\u6570\u6709\u591a\u5c11\u70b9\u5bf9\uff0c\u70b9\u5bf9\u6570 $\\ge k$ \u65f6\u76f4\u63a5\u8fd4\u56de\u5373\u53ef\u3002\n\n\u6240\u4ee5\u5177\u4f53\u64cd\u4f5c\u662f\u5bf9\u6240\u6709\u70b9\u6309 $x$ \u5750\u6807\u6392\u5e8f\uff0c\u7528\u961f\u5217\u7ef4\u62a4 $x$ \u5750\u6807\u5728 $dis$ \u8303\u56f4\u5185\u7684\u70b9\uff0c\u540c\u65f6\u7528 ``set`` \u7ef4\u62a4\u961f\u5217\u4e2d\u7684\u70b9\u7684 $y$ \u5750\u6807\u3002\n\n\u503c\u57df\u4e3a $S$ \uff0c\u5219\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal{O}((n+k)\\log n\\log S+k\\log k)$ \u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<=b;i++)\n#define pre(i,a,b) for(int i=a;i>=b;i--)\n#define N 250005\n#define inf 0x3f3f3f3f3f3f3f3fLL\n#define int long long\nusing namespace std;\nint n,k;\ntypedef pair<int,int> Pr;\n#define X first\n#define Y second\nset<Pr>s;queue<Pr>q;Pr a[N];\nint ans[N],T;\nbool check(int dis){\n\tT=0;s.clear();\n\twhile(!q.empty())q.pop();\n\trep(i,1,n){\n\t\twhile(!q.empty()&&q.front().X+dis<a[i].X)s.erase(make_pair(q.front().Y,q.front().X)),q.pop();\n\t\tset<Pr>::iterator it=s.lower_bound(make_pair(a[i].Y-dis,-inf));\n\t\twhile(it!=s.end()&&(*it).X<=dis+a[i].Y){\n\t\t\tans[++T]=max(abs((*it).X-a[i].Y),a[i].X-(*it).Y);\n\t\t\tit++;if(T>=k)return true;\n\t\t}\n\t\ts.insert(make_pair(a[i].Y,a[i].X));q.push(make_pair(a[i].X,a[i].Y));\n\t}\n\treturn false;\n}\nsigned main(){\n\tscanf(\"%lld%lld\",&n,&k);\n\trep(i,1,n){\n\t\tint x,y;scanf(\"%lld%lld\",&x,&y);\n\t\ta[i].X=x+y;a[i].Y=x-y;\n\t}\n\tsort(a+1,a+n+1);puts(\"No Copy\");\n\tint l=1,r=4000000000,ed=0;\n\twhile(l<=r){\n\t\tint mid=(0LL+l+r)>>1;\n\t\tif(check(mid))ed=mid,r=mid-1;\n\t\telse l=mid+1;\n\t}\n\tcheck(ed-1);\n\tsort(ans+1,ans+T+1);\n\trep(i,1,T)printf(\"%lld\\n\",ans[i]);\n\trep(i,1,k-T)printf(\"%lld\\n\",ed);\n\treturn 0;\n} \n```",
        "postTime": 1622359949,
        "uid": 119261,
        "name": "7KByte",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011\u9053\u8def\u306e\u5efa\u8a2d\u6848"
    },
    {
        "content": "### $\\rm KDT$\n\n\u66fc\u54c8\u987f\u8ddd\u79bb$k$\u8fd1\u70b9\u5bf9\uff1f\u770b\u8d77\u6765\u5341\u5206\u795e\u4ed9\u7684\u6837\u5b50\u3002\n\n\u4f46\u662f\uff01\u6211\u4eec\u90fd\u4f1a\u4e71\u641e\uff01\n\n\u542c\u8d77\u6765\u597d\u50cf\u6709\u70b9\u50cf[Luogu4357[CQOI2016]K \u8fdc\u70b9\u5bf9](https://www.luogu.com.cn/problem/P4357)\uff0c\u4f46\u662f$k$\u6bd4\u8f83\u5927\uff0c\u6211\u4eec\u53ef\u4ee5\u8bd5\u4e00\u8bd5\u3002\n\n\u5bf9\u4e8e\u6240\u6709\u70b9\u5efa$\\rm KDT$\uff0c\u7136\u540e\u7ef4\u62a4\u4e00\u4e2a\u5806\uff0c\u4e00\u4e2a\u70b9\u4e00\u4e2a\u70b9\u679a\u4e3e\uff0c\u5982\u679c\u5806\u9876\u5143\u7d20\u5c0f\u4e8e\u7b49\u4e8e\u5f53\u524d\u8282\u70b9\u5230\u8be2\u95ee\u77e9\u5f62\u4e2d\u53ef\u80fd\u7684\u6700\u77ed\u8ddd\u79bb\uff0c\u505c\u6b62\u641c\u7d22\u3002\u6ce8\u610f\u9700\u8981\u53bb\u9664\u4e00\u4e2a\u70b9\u4e0e\u81ea\u5df1\u5339\u914d\u7684\u8d21\u732e\u3002\n\n\u5728$\\rm KDT$\u4e2d\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u4e00\u4e2a\u70b9\u5230\u4e00\u4e2a\u77e9\u5f62\u7684\u6700\u77ed\u8ddd\u79bb\u4e0d\u518d\u662f\u8fd9\u4e2a\u70b9\u5230\u77e9\u5f62\u56db\u4e2a\u9876\u70b9\u7684\u6700\u77ed\u8ddd\u79bb\uff0c\u800c\u662f\u5404\u7ef4\u5ea6\u5750\u6807\u5230\u77e9\u5f62\u5bf9\u5e94\u7ef4\u5ea6\u8fb9\u754c\u7684\u7edd\u5bf9\u503c\u5dee\u7684\u6700\u5c0f\u503c\u4e4b\u548c\u3002\n\n\u7531\u4e8e\u8be2\u95ee\u4e3a\u65e0\u5e8f\u70b9\u5bf9\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u5806\u4e2d\u5b58\u50a8$2k$\u4e2a\u6709\u5e8f\u70b9\u5bf9\u7684\u8ddd\u79bb\uff0c\u8f93\u51fa\u65f6\u9694\u4e00\u4e2a\u6570\u4f9d\u6b21\u9009\u53d6$k$\u4e2a\u8ddd\u79bb\u5373\u4e3a\u7b54\u6848\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u8349\u7387\u5730\u901a\u8fc7\u4e86\u8fd9\u9053\u9898\uff0c\u5438\u6c27\u540e\u6700\u5927\u70b9\u4ec5\u4ec5\u8017\u65f6$1.60s$\u3002\n\n$Code:$\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<queue>\n#define N 250005\n#define ll long long\nusing namespace std;\nint n,k;\nll ans[N];\nstruct Point\n{\n    int x,y;\n    Point () {}\n    Point (int xx,int yy):x(xx),y(yy) {}\n}a[N];\nll dis(Point A,Point B)\n{\n    return (ll)abs(A.x-B.x)+abs(A.y-B.y);\n}\npriority_queue<ll>q;\nbool cmpX(const Point &A,const Point &B)\n{\n    return A.x<B.x;\n}\nbool cmpY(const Point &A,const Point &B)\n{\n    return A.y<B.y;\n}\nstruct node\n{\n    int xl,xr,yl,yr;\n}tr[N << 2];\nvoid build(int p,int l,int r,bool opt)\n{\n    if (l==r)\n    {\n        tr[p].xl=tr[p].xr=a[l].x;\n        tr[p].yl=tr[p].yr=a[l].y;\n        return;\n    }\n    int mid(l+r >> 1);\n    nth_element(a+l,a+mid,a+r+1,(!opt)?cmpX:cmpY);\n    build(p << 1,l,mid,!opt),build(p << 1 | 1,mid+1,r,!opt);\n    tr[p].xl=min(tr[p << 1].xl,tr[p << 1 | 1].xl);\n    tr[p].xr=max(tr[p << 1].xr,tr[p << 1 | 1].xr);\n    tr[p].yl=min(tr[p << 1].yl,tr[p << 1 | 1].yl);\n    tr[p].yr=max(tr[p << 1].yr,tr[p << 1 | 1].yr);\n}\nvoid ckmax(int &x,int y)\n{\n    x=(x>y)?x:y;\n}\nvoid calc(int p,int l,int r,int x)\n{\n    if (q.size()==k)\n    {\n        ll D=0;\n        if (tr[p].xl>a[x].x || tr[p].xr<a[x].x)\n            D+=min(abs(a[x].x-tr[p].xl),abs(a[x].x-tr[p].xr));\n        if (tr[p].yl>a[x].y || tr[p].yr<a[x].y)\n            D+=min(abs(a[x].y-tr[p].yl),abs(a[x].y-tr[p].yr));\n        if (D>=q.top())\n            return;\n    }\n    if (l==r)\n    {\n        ll D=dis(a[x],Point(tr[p].xl,tr[p].yl));\n        if (!D)\n            return;\n        if (q.size()==k)\n            q.pop();\n        q.push(D);\n        return;\n    }\n    int mid(l+r >> 1);\n    calc(p << 1,l,mid,x);\n    calc(p << 1 | 1,mid+1,r,x);\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&k);\n    k=k << 1;\n    for (int i=1;i<=n;++i)\n        scanf(\"%d%d\",&a[i].x,&a[i].y);\n    build(1,1,n,0);\n    for (int i=1;i<=n;++i)\n        calc(1,1,n,i);\n    for (int i=1;i<=(k >> 1);++i)\n        ans[i]=q.top(),q.pop(),q.pop();\n    for (int i=(k >> 1);i;--i)\n        printf(\"%lld\\n\",ans[i]);\n    return 0;\n}\n```",
        "postTime": 1619870238,
        "uid": 10341,
        "name": "GK0328",
        "ccfLevel": 0,
        "title": "P7561 [JOISC 2021 Day2] \u9053\u8def\u306e\u5efa\u8a2d\u6848 \u9898\u89e3"
    },
    {
        "content": "### \u7b80\u8981\u9898\u610f\n\n\u4e00\u4e2a\u5e73\u9762\u4e0a\u5171 $n$ \u4e2a\u70b9\uff0c\u6c42\u51fa\u524d $k$ \u5c0f\u7684\u4e24\u70b9\u4e4b\u95f4\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\n\n### \u601d\u8def\n\n\u66fc\u54c8\u987f\u8ddd\u79bb\u975e\u5e38\u611a\u8822\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u8f6c\u6210\u5207\u6bd4\u96ea\u592b\u8ddd\u79bb\u3002\u5373 $\\left(x,y\\right)$ \u8f6c\u5316\u4e3a $\\left(x+y,x-y\\right)$\uff0c\u6b64\u65f6\u4e24\u70b9\u7684\u5207\u6bd4\u96ea\u592b\u8ddd\u79bb\u5c31\u662f\u539f\u56fe\u4e0a\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u3002\n\n\u6211\u4eec\u8003\u8651\u4e8c\u5206\u51fa\u7b2c $k$ \u5c0f\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u2014\u2014\u8fd9\u4e2a\u660e\u663e\u662f\u6709\u5355\u8c03\u6027\u7684\u2014\u2014\u8003\u8651 check \u600e\u4e48\u5199\u3002\n\n\u5148\u8bbe\u6211\u8fd9\u6b21\u4e8c\u5206\u51fa\u6765\u7684\u503c\u4e3a $mid$\uff0c\u5728 check \u91cc\u9762\u6211\u4eec\u53ea\u5173\u5fc3\u6709\u591a\u5c11\u70b9\u5bf9\u800c\u4e0d\u5173\u5fc3\u70b9\u5bf9\u7684\u8ddd\u79bb\uff0c\u90a3\u4e48\u6211\u4eec\u5f88\u5bb9\u6613\u5c31\u80fd\u60f3\u5230\u5148\u7528\u5c3a\u53d6\u6cd5\u7b5b\u6389 $x$ \u7684\u95f4\u9694\u8d85\u8fc7 $mid$ \u7684\u70b9\uff0c\u5bf9\u4e8e\u6211\u65b0\u52a0\u5165\u8fdb\u6765\u7684\u70b9 $rt$\uff0c\u67e5\u8be2\u51fa\u76ee\u524d\u8fd8\u5728\u6211\u5c3a\u53d6\u7684\u533a\u95f4\u5185\u7684\u70b9\u4e2d\uff0c$y$ \u5750\u6807\u5728 $\\left[y_{rt}-mid,y_{rt}+mid\\right]$ \u4e4b\u5185\u7684\u70b9\u6709\u591a\u5c11\u4e2a\uff0c\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u79bb\u6563\u5316\u540e\u4e22\u8fdb BIT \u91cc\u9762\u3002\n\n\u4e8c\u5206\u51fa\u7b2c $k$ \u5c0f\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u540e\uff0c\u7528\u4e0a\u8ff0\u65b9\u6cd5\u5c3a\u53d6\uff0c\u4f46\u662f\u6211\u4eec\u73b0\u5728\u53ea\u5173\u5fc3\u70b9\u5bf9\u7684\u8ddd\u79bb\uff0c\u6240\u4ee5\u6211\u4eec\u5f00 $n$ \u4e2a set\uff0c$st_i$ \u5b58\u50a8\u6ee1\u8db3 $y_j=i$ \u7684 $x_j$\u3002\n\n\u7136\u540e\u5728 $\\left[y_{rt}-mid,y_{rt}+mid\\right]$ \u7684 set \u91cc\u9762\u67e5\u51fa $x$ \u7684\u8868\u4e22\u8fdb\u5c0f\u6839\u5806\u5c31\u884c\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O\\left(n \\log^2 n\\right)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nint n, k,pos;\nstruct node\n{\n    int x, y,id;\n} a[250005];\nbool cmp(node a, node b)\n{\n    return a.x < b.x || a.x == b.x && a.y < b.y;\n}\nbool cmp2(node a,node b){\n    return a.y<b.y;\n}\nint val[250005];\nunordered_map<int,int> mp;\ninline int findsuf(int x){\n    int lt=0,rt=pos+1;\n    while(lt+1<rt){\n        int mid=lt+rt>>1;\n        if(val[mid]>=x){\n            rt=mid;\n        }\n        else{\n            lt=mid;\n        }\n    }\n    return rt;\n}\ninline int findpre(int x){\n    int lt=0,rt=pos+1;\n    while(lt+1<rt){\n        while(lt+1<rt){\n            int mid=lt+rt>>1;\n            if(val[mid]>x){\n                rt=mid;\n            }\n            else{\n                lt=mid;\n            }\n        }\n    }\n    return lt;\n}\nset<int> st[250005];\nmultiset<int> q;\nbool tag;\nclass BIT{\n    public:\n    int c[250005];\n    int lowbit(int x){\n        return x&-x;\n    }\n    void add(int x,int y){\n        while(x<=pos){\n            c[x]+=y;\n            x+=lowbit(x);\n        }\n        return;\n    }\n    int ask(int x){\n        int sum=0;\n        while(x){\n            sum+=c[x];\n            x-=lowbit(x);\n        }\n        return sum;\n    }\n    int query(int x,int y){\n        return ask(y)-ask(x-1);\n    }\n    void clean(){\n        for(int i=1;i<=pos;i++){\n            c[i]=0;\n        }\n        return;\n    }\n}P;\ninline bool check(int X){\n    P.clean();\n    int sum=0;\n    int lt=1,rt=0;\n    while(rt<n){\n        rt++;\n        while(lt<rt&&a[rt].x-a[lt].x>X){\n            P.add(mp[a[lt].y],-1);\n            lt++;\n        }\n        int L=findsuf(a[rt].y-X);\n        int R=findpre(a[rt].y+X);\n        sum+=P.query(L,R);\n        P.add(mp[a[rt].y],1);\n    }\n    return sum>=k;\n}\ninline bool getans(int X){\n    q.clear();\n    for(int i=1;i<=pos;i++){\n        st[i].clear();\n    }\n    int lt=1,rt=0;\n    int sum=0;\n    while(rt<n){\n        rt++;\n        while(lt<rt&&a[rt].x-a[lt].x>X){\n            st[mp[a[lt].y]].erase(a[lt].x);\n            lt++;\n        }\n        int L=findsuf(a[rt].y-X);\n        int R=findpre(a[rt].y+X);\n        for(int i=L;i<=R;i++){\n            for(int v:st[i]){\n                if(max(abs(a[rt].y-val[i]),abs(v-a[rt].x))<=X){\n                    q.insert(max(abs(a[rt].y-val[i]),abs(v-a[rt].x))),sum++;\n                    if(q.size()>k){\n                        q.erase(q.begin(),q.begin());\n                    }\n                }\n            }\n        }\n        st[mp[a[rt].y]].insert(a[rt].x);\n    }\n    return sum>=k;\n}\nsigned main()\n{\n    scanf(\"%lld%lld\", &n, &k);\n    for (int i = 1; i <= n; i++)\n    {\n        scanf(\"%lld%lld\", &a[i].x,&a[i].y);\n        int tmpx=a[i].x+a[i].y;\n        int tmpy=a[i].x-a[i].y;\n        a[i].x=tmpx;\n        a[i].y=tmpy;\n    }\n    sort(a + 1, a + 1 + n, cmp2);\n    pos=1;\n    val[pos]=a[1].y;\n    mp[a[1].y]=pos;\n    for(int i=2;i<=n;i++){\n        if(a[i].y!=a[i-1].y){\n            pos++;\n            mp[a[i].y]=pos;\n            val[pos]=a[i].y;\n        }\n    }\n    sort(a+1,a+1+n,cmp);\n    int lt=0,rt=4000000000+1;\n    while(lt+1<rt){\n        int mid=lt+rt>>1;\n        if(check(mid)){\n            rt=mid;\n        }\n        else{\n            lt=mid;\n        }\n    }\n    tag=true;\n    getans(rt);\n    for(int v:q){\n        printf(\"%lld\\n\",v);\n        k--;\n        if(!k)break;\n    }\n    return 0;\n}\n```",
        "postTime": 1667621108,
        "uid": 679749,
        "name": "EastSnowLotus",
        "ccfLevel": 0,
        "title": "BIT\u4e4b\u62fc\u640f1.33s\u6211\u8981\u540a\u6253Splay"
    },
    {
        "content": "\u770b\u5230\u9898\u89e3\u533a\u90fd\u662f\u53cc $\\log$ \u7684\u505a\u6cd5\uff0c\u6211\u63d0\u4f9b\u4e00\u79cd\u5355 $\\log$ \u7684\u505a\u6cd5\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u5148\u66fc\u54c8\u987f\u8ddd\u79bb\u8f6c\u5207\u6bd4\u96ea\u592b\u8ddd\u79bb\u3002\n\n\u770b\u5230\u4e86\u7b2c $k$ \u5927\uff0c\u6211\u4eec\u8003\u8651\u4e8c\u5206\u7b54\u6848\uff0c\u8003\u8651\u5982\u4f55\u5224\u65ad\u662f\u5426\u5408\u6cd5\u3002\n\n\u8fd9\u91cc\u6211\u4eec\u91c7\u53d6\u5bf9\u5e73\u9762\u8fdb\u884c\u5206\u5757\uff0c\u5047\u8bbe\u5f53\u524d\u4e8c\u5206\u7684\u7b54\u6848\u4e3a $d$\uff0c\u6211\u4eec\u5c31\u6bcf $d$ \u4e2a\u5206\u6210\u4e00\u5757\u3002\n\n\u5982\u4f55\u7edf\u8ba1\u7b54\u6848\u5462\uff1f\u8003\u8651\u5230\u76f4\u63a5\u5bf9\u4e8e\u5f53\u524d\u70b9\u6240\u5728\u7684\u5757\u4ee5\u53ca\u76f8\u5173\u7684\u516b\u4e2a\u65b9\u5411\u7206\u679a\u4e00\u901a\u3002\n\n\u53ef\u4ee5\u8bc1\u660e\uff0c\u8fd9\u6837\u7684\u590d\u6742\u5ea6\u662f $O(n)$ \u7684\u3002\n\n\u6240\u4ee5\u603b\u590d\u6742\u5ea6 $O(n\\log a)$\u3002\n\n\u4e0d\u8fc7\u5e38\u6570\u592a\u5927\u4e86\uff0c\u6240\u4ee5\u8dd1\u5f97\u8ddf\u4e24\u4e2a $\\log$ \u4f30\u8ba1\u4e5f\u5dee\u4e0d\u591a\u3002\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<unordered_map>\n#include<vector>\n#define ll long long\n#define pir pair<ll,ll>\nusing namespace std;\nconst int N=5e5+10,P=1e7+7;\nvector<pir> v[N];\nnamespace ht\n{\n\tstruct edge{\n\t\tint next;\n\t\tll x,y;\n\t}e[N];\n\tint first[P],len,q[N],cnt;\n\tint qry(ll x,ll y,bool p)\n\t{\n\t\tint w=(x*1919+y*811)%P;\n\t\tif(w<0) w+=P;\n\t\tfor(int i=first[w];i;i=e[i].next)\n\t\t\tif(e[i].x==x&&e[i].y==y) return i;\n\t\tif(!p) return -1;\n\t\te[++len]=edge{first[w],x,y};\n\t\tif(!first[w]) q[++cnt]=w;\n\t\tfirst[w]=len;\n\t\treturn len;\n\t}\n\tvoid clear()\n\t{\n\t\tfor(int i=1;i<=len;i++) v[i].clear();\n\t\tfor(int i=1;i<=cnt;i++) first[q[i]]=0;\n\t\tlen=cnt=0;\n\t}\n}\nint len,k,p,n;\nll ans[N<<2];\nll calc(ll a,ll b)\n{\n\tif(a>=0) return a/b;\n\telse return (a+1)/b-1;\n}\nvoid push(ll x)\n{\n\tans[++len]=x;\n}\nvoid work(ll d,ll x,ll y,int i)\n{\n\tif(i<0) return;\n\tif(len>=k&&p) return;\n\tll w;\n\tfor(pir a:v[i])\n\t{\n\t\tw=max(abs(a.first-x),abs(a.second-y));\n\t\tif(w<=d) push(w);\n\t}\n}\nconst int f1[10]={0,1,1,1,0,-1,-1,-1,0},f2[10]={0,1,0,-1,-1,-1,0,1,1};\nll x[N],y[N],a,b;\nbool chk(ll d)\n{\n\tht::clear(),len=0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\ta=calc(x[i],d),b=calc(y[i],d);\n\t\tfor(int k=0;k<9;k++)\n\t\t\twork(d,x[i],y[i],ht::qry(a+f1[k],b+f2[k],0));\n\t\tv[ht::qry(a,b,1)].push_back({x[i],y[i]});\n\t\tif(p&&len>=k) return 1;\n\t}\n\treturn 0;\n}\nint main()\n{\n\tscanf(\"%d%d\",&n,&k);\n\tfor(int i=1;i<=n;i++)\n\t\tscanf(\"%lld%lld\",&a,&b),x[i]=a+b,y[i]=a-b;\n\tll l=1,r=4e9,mid;\n\tp=1;\n\twhile(l<r)\n\t{\n\t\tmid=(l+r)>>1;\n\t\tif(chk(mid)) r=mid;\n\t\telse l=mid+1;\n\t}\n\tchk(l);\n\tsort(ans+1,ans+len+1);\n\tfor(int i=1;i<=k;i++)\n\t\tprintf(\"%lld\\n\",ans[i]);\n}\n```",
        "postTime": 1666700024,
        "uid": 99506,
        "name": "_LHF_",
        "ccfLevel": 0,
        "title": "[JOISC 2021 Day2] \u9053\u8def\u306e\u5efa\u8a2d\u6848 (Road Construction) \u89e3\u9898\u62a5\u544a"
    },
    {
        "content": "> \u7ed9\u5b9a\u5e73\u9762\u4e0a $n$ \u4e2a\u70b9 $\\left(x_i,y_i\\right)$\uff0c\u6c42\u66fc\u54c8\u987f\u8ddd\u79bb\u524d $k$ \u5c0f\u7684\u65e0\u5e8f\u70b9\u5bf9\u3002\n>\n> $2\\le n\\le2.5\\times10^5$\uff0c$1\\le k\\le\\min\\left(2.5\\times 10^5,\\ \\dfrac{n\\cdot(n-1)}{2}\\right)$\uff0c$\\left|x_i\\right|,\\left|y_i\\right|\\le10^9$\u3002\n\n\u8bbe\u5b9a\u9608\u503c $m\\ge k$\u3002\u4e8c\u5206\u8ddd\u79bb $d$ \u5e76\u6c42\u51fa\u66fc\u54c8\u987f\u8ddd\u79bb\u5c0f\u4e8e\u7b49\u4e8e $d$ \u7684\u70b9\u5bf9\u7684\u8ddd\u79bb\u3002\u6c42\u8fd9\u4e9b\u8ddd\u79bb\u7684\u8fc7\u7a0b\u4e2d\u4e00\u65e6\u53d1\u73b0\u70b9\u5bf9\u4e2a\u6570\u8d85\u8fc7 $m$ \u5c31\u7acb\u523b\u9000\u51fa\u5e76\u7f29\u5c0f $d$\uff1b\u5982\u679c\u70b9\u5bf9\u4e2a\u6570\u4e0d\u5230 $k$ \u5c31\u589e\u5927 $d$\uff1b\u5426\u5219\u9009\u62e9\u524d $k$ \u5c0f\u8ddd\u79bb\u5373\u53ef\u3002\u5047\u8bbe $\\left|x_i\\right|,\\left|y_i\\right|\\le a$\uff0c\u90a3\u4e48\u4f7f\u7528\u6570\u7ec4\u5b58\u50a8\u8fd9\u4e9b\u8ddd\u79bb\u5e76\u6700\u540e\u6c42\u51fa\u524d $k$ \u5c0f\u53ef\u4ee5\u505a\u5230\u65f6\u95f4\u590d\u6742\u5ea6 $O\\left(\\left(n\\log n+m\\right)\\log a+k\\log k\\right)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $O\\left(n+m\\right)$ \uff1b\u4f7f\u7528\u5806\u52a8\u6001\u7ef4\u62a4\u524d $k$ \u5c0f\u53ef\u4ee5\u505a\u5230\u65f6\u95f4\u590d\u6742\u5ea6 $O\\left(\\left(n\\log n+m\\log k\\right)\\log a\\right)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $O\\left(n+k\\right)$\u3002\u7406\u8bba\u4e0a $m=k$ \u65f6\u6700\u4f18\uff0c\u4f46\u662f\u503c\u5f97\u6ce8\u610f\u7684\u662f $m$ \u589e\u5927\u65f6\uff0c\u4e8c\u5206\u7684\u6b21\u6570\u5c31\u4f1a\u76f8\u5e94\u5730\u51cf\u5c0f\u3002\n\n\u5173\u4e8e\u4e8c\u5206\u8ddd\u79bb $d$ \u540e\u6c42\u51fa\u66fc\u54c8\u987f\u8ddd\u79bb\u5c0f\u4e8e\u7b49\u4e8e $d$ \u7684\u70b9\u5bf9\uff1a\u53ef\u4ee5\u8f6c\u5316\u4e3a\u5207\u6bd4\u96ea\u592b\u8ddd\u79bb\u540e\u5c06\u70b9\u6309\u7167\u6a2a\u5750\u6807\u4e3a\u7b2c\u4e00\u5173\u952e\u5b57\uff0c\u7eb5\u5750\u6807\u4e3a\u7b2c\u4e8c\u5173\u952e\u5b57\u6392\u5e8f\uff0c\u7136\u540e\u4f7f\u7528\u53cc\u6307\u9488\u5f97\u5230\u6a2a\u5750\u6807\u5728\u8303\u56f4\u5185\u7684\u5176\u4ed6\u70b9\u3002\u7ef4\u62a4\u6309\u7167\u7eb5\u5750\u6807\u6392\u5e8f\u7684 `std::set`\uff0c\u90a3\u4e48\u53ea\u9700\u8981\u4f9d\u5e8f\u904d\u5386\u7eb5\u5750\u6807\u4e5f\u5728\u8303\u56f4\u5185\u7684\u70b9\u5373\u53ef\u3002\n\n\u4ee3\u7801\u5199\u8d77\u6765\u5f88\u7b80\u5355\uff0c\u4e0d\u653e\u4e86\u3002",
        "postTime": 1619872081,
        "uid": 55251,
        "name": "Daniel13265",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P7561 \u3010[JOISC 2021 Day2] \u9053\u8def\u306e\u5efa\u8a2d\u6848\u3011"
    }
]
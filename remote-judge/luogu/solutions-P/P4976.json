[
    {
        "content": "\u6839\u636e NOI2019 \u7684\u6559\u8bad\uff0c\u5728\u505a\u6570\u5b66\u9898\u65f6\u4e00\u5b9a\u8981\u8bd5\u7740\u63d2\u503c\u4e00\u4e0b\uff0c\u8bf4\u4e0d\u5b9a\u7b54\u6848\u662f\u4e2a\u4f4e\u6b21\u591a\u9879\u5f0f\u5462\uff1f \n\n\u800c\u8fd9\u9898\u5c31\u662f\u8fd9\u6837\uff0c\u968f\u4fbf\u5199\u4e2a\u66b4\u529b\u8dd1\u4e00\u4e0b\uff0c\u518d\u5199\u4e2a\u63d2\u503c\uff0c\u53d1\u73b0\u7b54\u6848\u662f\u4e2a\u5173\u4e8e $n$ \u7684\u4e00\u4e2a $6$ \u6b21\u591a\u9879\u5f0f\u3002\u7136\u540e\u5199\u51fa\u524d\u9762 $7$ \u9879\uff0c\u7136\u540e\u66b4\u529b\u63d2\u503c\u4e00\u6ce2\u5c31\u8fc7\u4e86\u3002\n\n\u81f3\u4e8e\u8bc1\u660e\uff0c\u9898\u76ee\u4e2d\u7b54\u6848\u76f8\u5173\u7684\u5730\u65b9\u6ca1\u6709\u51fa\u73b0\u5f62\u5982 $n^k$ \u4e4b\u7c7b\u7684\u5f0f\u5b50\uff0c\u6240\u4ee5\u7b54\u6848\u80af\u5b9a\u662f\u5173\u4e8e $n$ \u7684\u4f4e\u6b21\u591a\u9879\u5f0f\u5bf9\u5427\uff0c\uff0c\u611f\u6027\u7406\u89e3\u4e00\u4e0b\u5c31\u597d\u3002\n\n\u5173\u4e8e\u600e\u4e48\u63d2\u503c\uff0c\u8fd9\u91cc\u8981\u7528\u5230\u70b9\u503c $x$ \u5750\u6807\u8fde\u7eed\u65f6\u7684\u9ad8\u6548\u505a\u6cd5\uff0c\u5982\u679c\u4e0d\u4f1a\u53ef\u4ee5\u6765 [\u8fd9\u9898](https://www.luogu.org/problem/P5437) \u770b\u770b\uff08 \n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(T)$\uff0c\u6807\u7b97\u4e3a $\\Theta(T+n)$\uff0c\u540a\u6253std\uff08\n\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#define ll long long\n#define reg register\n#define p 998244853\n#define K 20\nusing namespace std;\n\ninline void read(int &x){\n\tx = 0;\n\tchar c = getchar();\n\twhile(c<'0'||c>'9') c = getchar();\n\twhile(c>='0'&&c<='9'){\n\t\tx = (x<<3)+(x<<1)+(c^48);\n\t\tc = getchar();\n\t}\n}\n\nvoid print(int x){\n\tif(x>9) print(x/10);\n\tputchar(x%10+'0');\n}\n\ninline int power(int a,int t){\n\tint res = 1;\n\twhile(t){\n\t\tif(t&1) res = (ll)res*a%p;\n\t\ta = (ll)a*a%p;\n\t\tt >>= 1;\n\t}\n\treturn res;\n}\n\ninline int add(int a,int b){\n\treturn a+b>=p?a+b-p:a+b;\n}\n\ninline int dec(int a,int b){\n\treturn a<b?a-b+p:a-b;\n}\n\nconst int a[8] = {0,0,4,43,225,812,2324,5670};\nint pre[K],suf[K],ifac[K];\n\ninline int solve(int n){\n\tif(n<8) return a[n];\n\tint res = 0,g;\n\tpre[0] = suf[8] = 1;\n\tfor(reg int i=1;i<8;++i) pre[i] = (ll)pre[i-1]*(n-i)%p;\n\tfor(reg int i=7;i>=1;--i) suf[i] = (ll)suf[i+1]*(n-i)%p;\n\tfor(reg int i=1;i<8;++i){\n\t\tg = (ll)a[i]*ifac[i-1]%p*ifac[7-i]%p*pre[i-1]%p*suf[i+1]%p;\n\t\tif((7-i)&1) res = dec(res,g);\n\t\telse res = add(res,g);\n\t}\n\treturn res;\n}\n\nint main(){\n\tifac[0] = ifac[1] = 1;\n\tfor(reg int i=2;i<K;++i) ifac[i] = (ll)ifac[i-1]*i%p;\n\tifac[K-1] = power(ifac[K-1],p-2);\n\tfor(reg int i=K-2;i>1;--i) ifac[i] = (ll)ifac[i+1]*(i+1)%p;\n\tint T,n;\n\tread(T);\n\twhile(T--){\n\t\tread(n);\n\t\tprint(solve(n));\n\t\tputchar('\\n');\n\t}    \n    return 0;\n}\n```",
        "postTime": 1569733275,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4976 \u3010\u6bd2\u7624\u4e4b\u795eTM\u83f1\u6811-\u2461\u3011"
    },
    {
        "content": "#### $Subtask 1$\n\n\u611f\u89c9\u4e0d\u5fc5\u591a\u8bf4..\u66b4\u529b\u5efa\u56fe$+Floyd(O(N^6)) / Dijkstra(O(N^4 \\times log_2N^2))$\u62ff\u8d70\u4f60\u7684$10$\u5206..\n\n#### $Subtask 2$\n\n\u4e5f\u4e0d\u5fc5\u591a\u8bf4..\u628a$T4$\u7684\u6b63\u89e3\u5077\u8fc7\u6765\u66b4\u529b\u7b97\u6bcf\u4e00\u4e2a\u70b9\u7684\u8ddd\u79bb\u5373\u53ef\u3002\u3002\n\n\u590d\u6742\u5ea6$O(N^4)$\u3002\u5174\u8bb8$Dijkstra$\u4e5f\u80fd\u8dd1\u8fc7\u3002\u3002\n\n#### $Subtask 3$\n\n\u5230\u8fd9\u91cc\u5c31\u9700\u8981\u4e00\u4e9b\u63a8\u7406\u4e86\u3002\u3002\n\n\u9996\u5148\u6211\u4eec\u53d1\u73b0\u83f1\u6811\u4e00\u4e2a\u6027\u8d28\uff1a\u6bcf\u4e00\u5c42\u7684\u8fb9\u6743\u76f8\u7b49\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u76f4\u63a5\u8ba1\u7b97\u6bcf\u4e00\u5c42\u7684\u8d21\u732e\u3002\n\n\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u5c31\u5206\u4e3a\u4e24\u79cd\u60c5\u51b5\uff1a\n\n\u7b2c\u4e00\u79cd\u662f\u5728\u56fe\u4e2d\u9009\u62e9\u7684\u4e24\u4e2a\u70b9\u4e00\u4e2a\u5728\u8fd9\u4e00\u5c42\u7684\u4e0b\u65b9\uff0c\u4e00\u4e2a\u5728\u8fd9\u4e00\u5c42\u7684\u4e0a\u65b9\u3002\n\n\u6839\u636e$T4$\u7684\u6700\u77ed\u8def\u7684\u7ed3\u8bba\uff0c\u6211\u4eec\u53ef\u4ee5\u63a8\u65ad\u51fa\u8fd9\u79cd\u60c5\u51b5\u53ea\u53ef\u80fd\u901a\u8fc7\u8fd9\u4e00\u5c42\u4e00\u6b21\u3002\n\n\u7b2c\u4e8c\u79cd\u662f\u4e24\u4e2a\u70b9\u90fd\u5728\u8fd9\u4e00\u5c42\u7684\u4e0b\u65b9\u3002\n\n\u8fd9\u6837\u4e00\u4e0a\u4e00\u4e0b\uff0c\u80af\u5b9a\u8981\u7ecf\u8fc7\u4e24\u6b21\u3002\n\n\u90a3\u4e48\u8003\u8651\u76f4\u63a5\u8ba1\u7b97\u8d21\u732e\u3002\n\n\u9996\u5148\u7b2c\u4e00\u79cd\u7684\u65b9\u6848\u975e\u5e38\u597d\u6c42\u3002\u5c31\u662f\u8fd9\u4e00\u5c42\u4e0a\u9762\u7684\u8282\u70b9\u4e2a\u6570$\\times$\u4e0b\u9762\u7684\u8282\u70b9\u4e2a\u6570\u3002\u8f6c\u5316\u4e3a\u5f0f\u5b50\u5c31\u662f:\n\n$$ \\frac{i \\times (i+1)}{2} \\times (\\frac{n \\times (n + 1)}{2} - \\frac{i \\times (i+1)}{2}) $$\n\n\u7136\u540e\u8ba1\u7b97\u7b54\u6848\u5c31\u4e58\u4e0a\u4e00\u4e2a$i$\u5c31\u597d\u4e86\u3002\n\n\u7b2c\u4e8c\u79cd\u7684\u8bdd\u3002\u3002\n\n\u9996\u5148\u53ef\u4ee5\u591a\u753b\u51e0\u4e2a\u8349\u56fe\uff0c\u53d1\u73b0\u9700\u8981\u6ee1\u8db3\u53f3\u8fb9\u7684\u70b9\u5230\u8fd9\u4e00\u5c42\u7684\u8ddd\u79bb\u9700\u8981\u5927\u4e8e\u6216\u7b49\u4e8e\u5de6\u8fb9\u7684\u70b9\u4e0e\u53f3\u8fb9\u7684\u70b9\u5728\u8be5\u5c42\u4ece\u5de6\u5f80\u53f3\u6570\u7684\u76f8\u5bf9\u4f4d\u7f6e\u7684\u5dee\u3002\n\n\u4e8b\u5b9e\u4e0a\u5982\u679c\u63a8\u51fa\u4e86$T4$\u7684\u4e09\u79cd\u60c5\u51b5\uff0c\u90a3\u8fd9\u4e2a\u8fd8\u662f\u633a\u597d\u60f3\u5230\u7684\u3002\n\n\u90a3\u4e48\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u5c31\u8003\u8651\u679a\u4e3e\u5de6\u8fb9\u7684\u70b9\u3002\u7136\u540e\u53f3\u8fb9\u53ef\u4ee5\u9009\u62e9\u7684\u70b9\u5c31\u662f\u4e00\u4e2a\u516c\u5dee\u4e3a$(n-i)$\u7684\u7b49\u5dee\u6570\u5217\u3002\u7136\u540e\u5de6\u8fb9\u6bcf\u4e00\u5217\u7684\u70b9\u4e00\u5171\u6709$(n-i)$\u4e2a\uff0c\u5219\u53ef\u4ee5\u5f97\u5230\u65b9\u6848\u6570\u4e3a\uff1a\n\n$$(n-i)^2 \\times \\frac{i \\times (i+1)}{2}$$\n\n\u7136\u540e\u7531\u4e8e\u9700\u8981\u4e00\u4e0a\u4e00\u4e0b\uff0c\u6240\u4ee5\u7b54\u6848\u9700\u8981\u4e58\u4e0a\u4e00\u4e2a$2 i$\u3002\n\n\u7efc\u4e0a\u6240\u8ff0\uff0c\u6700\u540e\u7684\u7b54\u6848\u5c31\u662f\n\n$$\\sum_{i=1}^{n-1}( \\frac{i \\times (i+1)}{2} \\times (\\frac{n \\times (n + 1)}{2} - \\frac{i \\times (i+1)}{2}) \\times i + (n-i)^2 \\times i ^ 2 \\times (i+1))$$\n\n\u590d\u6742\u5ea6$O(N^2)$\n\n#### $Subtask 4$\n\n\u8fd8\u662f\u7528\u4e0a\u9762\u7684\u5f0f\u5b50\u3002~~\u4e5f\u8bb8~~\u53ef\u4ee5\u5316\u7b80\u4e00\u4e0b\u53d8\u6210$O(N)$\n\n\u6211\u4eec\u628a\u5b83\u62c6\u5206\u4e00\u4e0b:\n\n$$\\frac{n \\times (n + 1)}{2} \\times \\sum_{i=1}^{n-1}(\\frac{i \\times (i+1)}{2} \\times i) - \\sum_{i=1}^{n-1} ((\\frac{i \\times (i+1)}{2})^2 \\times i) + \\sum_{i=1}^{n-1} (n^2-2\\times i \\times n +i^2) \\times i ^ 2 \\times (i+1))$$\n\n$$= \\frac{n \\times (n + 1)}{2} \\times \\sum_{i=1}^{n-1}(\\frac{i \\times (i+1)}{2} \\times i) - \\sum_{i=1}^{n-1} ((\\frac{i \\times (i+1)}{2})^2 \\times i) + n ^ 2 \\times \\sum_{i=1}^{n-1} (i ^ 2 \\times (i + 1)) - 2\\times n \\times \\sum_{i=1}^{n-1} (i ^ 3 \\times (i+1)) + \\sum_{i=1}^{n-1}(i ^ 4 \\times (i+1))$$\n\n\u7136\u540e\u53d1\u73b0\u6240\u6709$\\sum$\u91cc\u9762\u7684\u4e1c\u897f\u90fd\u53ef\u4ee5$O(N)$\u9012\u63a8\uff0c\u6240\u4ee5\u7b54\u6848\u4e5f\u53ef\u4ee5$O(N)$\u9012\u63a8\u4e86\u3002",
        "postTime": 1543480508,
        "uid": 20782,
        "name": "CYJian",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P4976 \u3010\u6bd2\u7624\u4e4b\u795eTM\u83f1\u6811-\u2461\u3011"
    },
    {
        "content": "\u697c\u4e0a\u7684\u9898\u89e3\u8bf4\u5f97\u90fd\u5f88\u8be6\u7ec6\u4e86\uff0c\u6211\u6765\u8865\u5145\u4e00\u6ce2\u600e\u4e48\u9012\u63a8\u90a3\u4e2a~~\u6bd2~~\u7624\u5f0f\u5b50\u3002\n\n\u9996\u5148\u53ef\u4ee5\u60f3\u5230\u5f005\u4e2a\u6570\u7ec4\u5206\u522b\u8bb0\u5f55\u6bcf\u4e2a$\\sum$\u91cc\u7684\u503c\uff0c\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u4f1a$MLE$\uff0c\u600e\u4e48\u529e\u5462?\n\n\u5176\u5b9e\u6211\u4eec\u53ef\u4ee5\u4e0d\u7528\u5f00\u6570\u7ec4\u3002\n\n\u7ef4\u62a4\u4e00\u4e2a $temp$ \u8868\u793a$\\sum$\u7684\u524d\u7f00\u548c\uff0c\u7136\u540e\u6211\u4eec\u53d1\u73b0 $i$ \u7684\u524d\u7f00\u548c\u53ea\u4f1a\u5bf9 $ans[i+1]$ \u4ea7\u751f\u8d21\u732e\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u5f00\u4e00\u4e2a $ans$ \u6570\u7ec4\u5c31\u53ef\u4ee5\u5566\uff01\u8bb0\u5f97\u5f00 $long\\ long$ \u54e6\u3002\uff08~~\u6211\u4e0d\u4f1a\u544a\u8bc9\u4f60\u6211\u56e0\u4e3a\u6ca1\u5f00longlong\u8c03\u4e86\u4e00\u4e2a\u665a\u4e0a~~\uff09\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long \ninline int read()\n{\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch<='9'&&ch>='0'){x=(x<<1)+(x<<3)+ch-'0';ch=getchar();}\n\treturn x*f;\n}\n\nconst int N=5e6+5;\nconst long long mod=998244853LL;\n\nunsigned long long  ans[N+10];\n\nsigned main(){\n\tlong long temp=0;\n\tfor(int i=1;i<=N-1;i++){\n\t\ttemp=( temp + 1LL*i * ( i + 1 ) / 2 % mod * i % mod ) % mod ;\n\t\tans[i+1] = ( ans[i+1] + 1LL*( i+1 ) * ( i + 2 ) / 2 % mod * temp % mod ) % mod ;\t\n\t}\n\t\n\ttemp=0;\n\tfor(int i=1;i<=N-1;i++){\n\t\ttemp=( temp + 1LL*i * ( i + 1 ) / 2 % mod * ( i * ( i + 1 ) / 2 % mod ) % mod * i % mod ) % mod ;\n\t\tans[i+1] = 1LL*( ans[i+1] + mod - temp ) % mod ;\t\n\t}\n\n\ttemp=0;\n\tfor(int i=1;i<=N-1;i++){\n\t\ttemp=( temp + 1LL*i * ( i + 1 ) % mod * i % mod ) % mod ;\n\t\tans[i+1] = ( ans[i+1] +1LL* ( i + 1 ) * ( i + 1 ) % mod * temp % mod ) % mod ;\t\n\t}\n\t\n\ttemp=0;\n\tfor(int i=1;i<=N-1;i++){\n\t\ttemp=( temp + 1LL*i * ( i + 1 ) % mod * i % mod * i % mod ) % mod ;\n\t\tans[i+1] = ( ans[i+1] + mod - 1LL*2 * ( i + 1 ) % mod * temp % mod ) % mod ;\t\n\t}\n\t\n\ttemp=0;\n\tfor(int i=1;i<=N-1;i++){\n\t\ttemp=( temp + 1LL*i *1LL* ( i + 1 ) % mod *1LL* i % mod * i % mod * i % mod ) % mod ;\n\t\tans[i+1] = ( ans[i+1] + 1LL* temp % mod ) % mod ;\t\n\t}\n\n\tint t=read();\n\twhile(t--){\n\t\tint n=read();\n\t\tprintf(\"%d\\n\",ans[n]);\n\t}\n\treturn 0;\n}\n \n ```",
        "postTime": 1569631868,
        "uid": 145596,
        "name": "AquaRio",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4976 \u3010\u6bd2\u7624\u4e4b\u795eTM\u83f1\u6811-\u2461\u3011"
    }
]
[
    {
        "content": "\u63a8\u5f0f\u5b50\u3002\n\n\u9996\u5148 $n$ \u4e3a\u5076\u6570\u65f6 $1+e^{\\frac{2\\pi i\\cdot (\\frac{n}{2})\\cdot (1)^{t-1}}{n}}=0$\uff0c\u6545\u7b54\u6848\u4e3a $0$\u3002\n\n\u4e0b\u9762\u770b $n$ \u4e3a\u5947\u6570\u3002\u8003\u8651\u53d6 $\\log$ \u5c06\u4e58\u79ef\u8f6c\u5316\u6210\u6c42\u548c\uff0c\u6253\u4e9b\u5c0f\u6570\u636e~~\u4ece\u6837\u4f8b 1 \u731c\u7ed3\u8bba~~\u53d1\u73b0\u7b54\u6848\u57fa\u672c\u90fd\u662f $2$ \u7684\u5e42\u3002\u4ee4 $f(n,t)=\\log_2\\left(\\prod_{x_1=1}^{n}\\prod_{x_2=1}^{n}\\dots\\prod_{x_t=1}^{n}\\left( 1+e^{\\frac{2\\pi ix_1x_2\\dots x_t}{n}} \\right)\\right)$\u3002\n\n\u8bbe $\\omega=e^{\\frac{2\\pi i}{n}}$\u3002\u9996\u5148\u6709 $\\prod\\limits_{x=1}^{n}\\left( u-\\omega^x \\right)=u^n-1$\uff0c $\\prod\\limits_{x=1}^{n}\\left( 1+e^{\\frac{2\\pi ix}{n}} \\right)=(-1)^n\\cdot((-1)^n-1)=2=2^1$\u3002\u6545 $f(n,1)=1$\u3002\n\n\u5176\u4ed6\u65f6\u5019\u6211\u4eec\u8003\u8651\u5904\u7406 $x_1$\uff0c\u5f53 $\\gcd(x_1,n)=d,x_1=dy,n=dm$ \u65f6\uff0c\n\n$$\\begin{aligned}\n\\prod_{x_2=1}^{n}\\dots\\prod_{x_t=1}^{n}\\left( 1+e^{\\frac{2\\pi ix_1x_2\\dots x_t}{n}} \\right)&=\\prod_{x_2=1}^{n}\\dots\\prod_{x_t=1}^{n}\\left( 1+e^{\\frac{2\\pi iyx_2\\dots x_t}{m}} \\right)\\\\\n&=\\left(\\prod_{x_2=1}^{m}\\dots\\prod_{x_t=1}^{m}\\left( 1+e^{\\frac{2\\pi ix_2\\dots x_t}{m}} \\right)\\right)^{d^{t-1}}\\\\\n&=2^{d^{t-1}f(m,t-1)},\n\\end{aligned}$$\n\n\u6545\uff08$d=\\gcd(x,n),m=\\dfrac{n}{d}$\uff0c\u4e0b\u540c\uff09\n\n$$\\begin{aligned}\nf(n,t)&=\\sum_{x=1}^{n}d^{t-1}f(m,t-1)\\\\\n&=\\sum_{d|n}\\sum_{\\gcd(x,n)=d}d^{t-1}f(m,t-1)\\\\\n&=\\sum_{d|n}\\varphi(m)d^{t-1}f(m,t-1),\n\\end{aligned}$$\n\n\u663e\u7136\u5f53 $f(n,t-1)$ \u79ef\u6027\u65f6 $f(n,t)$ \u4e5f\u79ef\u6027\u3002\n\n\u90a3\u4e48\u5c31\u53ea\u8981\u5bf9 $n$ \u5206\u89e3\u8d28\u56e0\u5b50\uff0c\u6c42\u51fa\u6bcf\u4e2a $f(p^v,t)$\u3002\n\n\u4ee3\u5165\u4e0a\u5f0f\u8ba1\u7b97\u5f97\n\n$$f(p^v,t)=\\dfrac{(v+t-1)!p^{(t-1)v}}{(v-1)!}\\sum_{j=0}^{t-1}\\dfrac{(-1)^j}{j!(t-j-1)!(v+j)}p^{-j}.$$\n\n\u8bc1\u660e\uff1a\n\n\u5148\u5c06\u5f0f\u5b50\u8868\u793a\u4e3a\n\n$$\\dfrac{(v+t-1)!}{(v-1)!(t-1)!}\\sum_{j=0}^{t-1}\\dfrac{(-1)^j\\binom{t-1}{j}}{v+j}p^{(t-1)v-j}$$\n\n\u8003\u8651\u5f52\u7eb3\u3002\u663e\u7136 $f(p^v,t+1)$ \u4e2d\u53ea\u6709 $p^{tv-t}$ \u5230 $p^{tv}$ \u7cfb\u6570\u4e0d\u4e3a $0$\u3002\u8003\u8651\u8ba1\u7b97 $f(p^v,t+1)$ \u4e2d $p^{tv-j}$ \u7684\u7cfb\u6570\u3002\n\n\u9996\u5148\u5904\u7406\u6389\u4e00\u5934\u4e00\u5c3e\u3002$p^{tv}$ \u7684\u7cfb\u6570\u4e3a\n\n$$\\begin{aligned}\n[p^{tv}]f(p^v,t+1)&=\\sum_{u=0}^v[p^{(t-1)(v-u)}]f(p^{v-u},t)\\\\\n&=\\sum_{u=0}^{v}\\binom{v-u+t-1}{v-u}\\\\\n&=\\sum_{u=0}^{v}\\binom{u+t-1}{u}\\\\\n&=\\binom{v+t}{v},\n\\end{aligned}$$\n\n\u8fd9\u4e2a\u53ef\u4ee5\u5f52\u7eb3\u3002\n\n\u7c7b\u4f3c\u7684\uff0c$p^{t(v-1)}$ \u7684\u7cfb\u6570\u4e3a\n\n$$\\begin{aligned}\n[p^{t(v-1)}]f(p^v,t+1)&=(-1)^{t}\\sum_{u=0}^{v-1}[p^{(t-1)(v-u-1)}]f(p^{v-u},t)\\\\\n&=(-1)^t\\sum_{u=0}^{v-1}\\binom{v-u+t-2}{v-u}\\\\\n&=(-1)^t\\sum_{u=0}^{v-1}\\binom{u+t-2}{u}\\\\\n&=(-1)^t\\binom{v+t-1}{v}.\n\\end{aligned}$$\n\n\u7136\u540e\u5904\u7406\u4e2d\u95f4\u7684\u9879\u3002\u4e0b\u9762\u8bbe $1 \\le j \\le t-1$\u3002\u7b2c\u4e09\u5230\u7b2c\u56db\u884c\u5bf9 $\\sum$ \u91cc\u7684\u6bcf\u4e00\u9879\u5316\u7b80\uff0c\u663e\u7136\u7528 $u$ \u4ee3\u66ff $v-u$ \u5f0f\u5b50\u4e0d\u53d8\u3002\n\n$$\\begin{aligned}[p^{tv-j}]f(p^v,t+1)&=\\sum_{u=0}^{v-1}\\left([p^{(t-1)(v-u)-j}]f(p^{v-u},t)-[p^{(t-1)(v-u)-j+1}]f(p^{v-u},t)\\right)\\\\\n&=[p^{(t-1)v-j}]f(p^v,t)-[p^{t-1-j}]f(p,t)+\\sum_{u=1}^{v-1}\\left([p^{(t-1)(v-u)-j}]f(p^{v-u},t)-[p^{(t-1)(v-u+1)-j+1}]f(p^{v-u+1},t)\\right)\\\\\n&=\\dfrac{(v+t-1)!}{(t-1)!(v-1)!}\\cdot\\dfrac{(-1)^j\\binom{t-1}{j}}{v+j}+\\dfrac{t!}{(t-1)!0!}\\cdot\\dfrac{(-1)^{j}\\binom{t-1}{j-1}}{j}+\\sum_{u=1}^{v-1}\\left(\\dfrac{(v-u+t-1)!}{(t-1)!(v-u-1)!}\\cdot\\dfrac{(-1)^j\\binom{t-1}{j}}{v-u+j}+\\dfrac{(v-u+t)!}{(t-1)!(v-u)!}\\cdot\\dfrac{(-1)^j\\binom{t-1}{j-1}}{v-u+j}\\right)\\\\\n&=\\binom{u+t-1}{u}\\cdot\\dfrac{(-1)^j}{u+j}\\cdot\\left((u+t)\\binom{t-1}{j-1}+u\\binom{t-1}{j}\\right)\\\\\n&=\\binom{u+t-1}{u}\\cdot\\dfrac{(-1)^j}{u+j}\\cdot(t-1)!\\cdot\\dfrac{(u+t)j+(t-j)u}{(t-j)!j!}\\\\\n&=(-1)^j\\binom{t}{j}\\binom{u+t-1}{u}.\n\\end{aligned}$$\n\n\u53c8\n\n$$\\dfrac{(v+t-1)!}{(t-1)!(v-1)!}\\cdot\\dfrac{(-1)^j\\binom{t-1}{j}}{v+j}=\\dfrac{(-1)^j(t-j)}{v+j}\\binom{t}{j}\\binom{v+t-1}{v-1},$$\n\n$$\\dfrac{t!}{(t-1)!0!}\\cdot\\dfrac{(-1)^j\\binom{t-1}{j-1}}{j}=(-1)^j\\binom{t}{j}\\binom{t-1}{0}.$$\n\n\u56e0\u6b64\n\n$$\\begin{aligned}\n&\\ \\ \\ \\ \\ \\dfrac{(v+t-1)!}{(t-1)!(v-1)!}\\cdot\\dfrac{(-1)^j\\binom{t-1}{j}}{v+j}+\\dfrac{t!}{(t-1)!0!}\\cdot\\dfrac{(-1)^{j}\\binom{t-1}{j-1}}{j}+\\sum_{u=1}^{v-1}\\left(\\dfrac{(v-u+t-1)!}{(t-1)!(v-u-1)!}\\cdot\\dfrac{(-1)^j\\binom{t-1}{j}}{v-u+j}+\\dfrac{(v-u+t)!}{(t-1)!(v-u)!}\\cdot\\dfrac{(-1)^j\\binom{t-1}{j-1}}{v-u+j}\\right)\\\\\n&=(-1)^j\\binom{t}{j}\\left(\\dfrac{t-j}{v+j}\\binom{v+t-1}{v-1}+\\sum_{u=0}^{v-1}\\binom{u+t-1}{u}\\right)\\\\\n&=(-1)^j\\binom{t}{j}\\binom{v+t-1}{v-1}\\left(\\dfrac{t-1}{v+j}+1\\right)\\\\\n&=\\dfrac{(v+t)!}{t!(v-1)!}\\cdot\\dfrac{(-1)^j\\binom{t}{j}}{v+j}.\n\\end{aligned}$$\n\n\u8bc1\u6bd5\u3002\n\n\u8003\u8651\u5904\u7406\u8fd9\u4e2a\u5f0f\u5b50\u3002\u663e\u7136\u53ef\u4ee5\u5377\u79ef\u540e\u518d\u4f9d\u6b21\u4e58\u4e0a\u524d\u9762\u7684\u4e1c\u897f\u3002\n\n\u7528\u8d39\u9a6c\u5c0f\u5b9a\u7406\u6c42\u89e3\uff0c$335544323-1=335544322=2 \\times 167772161$\uff0c$167772161$ \u662f NTT \u6a21\u6570\uff0c\u53c8\u7531\u9012\u63a8\u5f0f\u5bb9\u6613\u77e5\u9053 $f(n,t)$ \u4e3a\u5947\u6570\uff08\u53ea\u9700\u6ce8\u610f\u5230 $\\varphi(n)$ \u53ea\u6709\u5728 $n=1,2$ \u65f6\u4e3a\u5947\u6570\uff09\uff0c\u76f4\u63a5 CRT \u5408\u5e76\u5373\u53ef\uff08\u5176\u5b9e\u5c31\u662f\u5076\u6570\u7ed9\u5b83\u52a0\u4e0a\u4e2a $167772161$\uff09\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(a^{\\frac{1}{4}}+k\\log{k}\\log{a})$\u3002\n\nCode:\n```cpp\n#include<map>\n#include<ctime>\n#include<cstdio>\n#include<cstdlib>\n#include<algorithm>\n#define rg register\n#define LL __int128\n#define ll long long\n#define mabs(a,b) (a>b?a-b:b-a)\nusing std::map;\nusing std::reverse;\nconst int NtF=335544323;\nconst int Ntf=335544322;\nconst int ntf=167772161;\ninline ll qpw(ll x,ll v,ll NTF)\n{\n\tll r=1;\n\twhile(v)\n\t{\n\t\t(v&1)&&(r=(LL)r*x%NTF);\n\t\tx=(LL)x*x%NTF,v>>=1;\n\t}\n\treturn r;\n}\ninline ll _gcd(ll a,ll b)\n{\n\twhile(b^=a^=b^=a%=b);return a;\n}\ninline bool witness(ll a,ll n)\n{\n\tll t=n-1;\n\twhile(t)\n\t{\n\t\tll x=qpw(a,t,n);\n\t\tif(x!=1&&x!=n-1)return false;\n\t\tif((t&1)||x==n-1)return true;\n\t\tt>>=1;\n\t}\n}\ninline bool MR(ll n)\n{\n\tif(n==1)return 0;\n\tif(n==2||n==3)return 1;\n\tif(n%6!=1&&n%6!=5)return 0;\n\tif(n==46856248255981ll)return 0;\n\tif(n==7||n==61||n==24251)return 1;\n\treturn (witness(2,n)&&witness(61,n));\n}\ninline ll fnc(ll x,ll c,ll ntf)\n{\n\treturn ((LL)x*x+c)%ntf;\n}\ninline ll PR(ll n)\n{\n\tll x=0,y=0,v=1,c=rand()%(n-1)+1;\n\tfor(rg int m=1;;m<<=1,x=y,v=1)\n\t{\n\t\tfor(rg int s=0;s<m;++s)\n\t\t{\n\t\t\ty=fnc(y,c,n);\n\t\t\tv=(LL)v*mabs(x,y)%n;\n\t\t\tif(!(s%127))\n\t\t\t{\n\t\t\t\tll d=_gcd(v,n);\n\t\t\t\tif(d>1)return d;\n\t\t\t}\n\t\t}\n\t\tll d=_gcd(v,n);\n\t\tif(d>1)return d;\n\t}\n}\nmap<ll,int>_exp;\ninline void solve(ll n)\n{\n\tif(n<2)return;\n\tif(MR(n))\n\t{\n\t\t(_exp.count(n))?++_exp[n]:_exp[n]=1;\n\t\treturn;\n\t}\n\tll p=n;\n\twhile(p==n)p=PR(p);\n\tsolve(n/p),solve(p);\n}\nll prr[300007];\nint rev[300007];\ninline void init(int lim,int l)\n{\n\tfor(rg int i=0;i<lim;++i)rev[i]=(rev[i>>1]>>1)|((i&1)<<(l-1));\n\tll w;\n\tfor(rg int i=1,b=1;i<lim;i<<=1,++b)\n\t{\n\t\tprr[i]=1;\n\t\tw=qpw(3,(ntf-1)>>b,ntf);\n\t\tfor(rg int j=1;j<i;++j)prr[i+j]=prr[i+j-1]*w%ntf;\n\t}\n}\ninline void NTT(ll *a,int lim,int opt)\n{\n\tfor(rg int i=0;i<lim;++i)if(i<rev[i])a[i]^=a[rev[i]]^=a[i]^=a[rev[i]];\n\tfor(rg int i=1;i<lim;i<<=1)\n    {\n    \tfor(rg int j=0;j<lim;j+=(i<<1))\n    \t{\n    \t\tfor(rg int k=0;k<i;++k)\n    \t\t{\n    \t\t\tll tx=a[i|j|k]*prr[i|k]%ntf;\n\t\t\t\ta[i|j|k]=(a[j|k]-tx+ntf)%ntf,a[j|k]=(a[j|k]+tx)%ntf;\n\t\t\t}\n\t\t}\n\t}\n\tif(opt)return;\n\treverse(a+1,a+lim);\n\tll x=qpw(lim,ntf-2,ntf);\n\tfor(rg int i=0;i<lim;++i)a[i]=a[i]*x%ntf;\n}\nll n,v,res;\nint k,lim,l;\nll fac[300007];\nll fic[300007];\nll ans[300007];\nll f[300007],g[300007];\nint main()\n{\n\tscanf(\" %lld %lld %d\",&n,&v,&k);\n\tif(!(n&1))\n\t{\n\t\tputs(\"0\");\n\t\treturn 0;\n\t}\n\tsolve(n);v%=ntf;\n\tfor(rg int i=1;i<=k;++i)ans[i]=1;\n\tlim=1,l=0;\n\twhile(lim<=(k<<1))lim<<=1,++l;\n\tinit(lim,l);\n\tfac[0]=1;\n\tfor(rg int i=1;i<=k;++i)fac[i]=fac[i-1]*i%ntf;\n\tfic[k]=qpw(fac[k],ntf-2,ntf);\n\tfor(rg int i=k;i;--i)fic[i-1]=fic[i]*i%ntf;\n\tfor(auto ex:_exp)\n\t{\n\t\tll prm=ex.first%ntf;\n\t\tll tim=ex.second*v%ntf;\n\t\tfor(rg int i=0;i<k;++i)\n\t\t{\n\t\t\tf[i]=fic[i]*qpw(i+tim,ntf-2,ntf)%ntf*qpw(prm,ntf-1-i,ntf)%ntf;\n\t\t\tg[i]=fic[i];((i&1)&&(f[i]))&&(f[i]=ntf-f[i]);\n\t\t}\n\t\tfor(rg int i=k;i<lim;++i)f[i]=g[i]=0;\n\t\tNTT(f,lim,1);NTT(g,lim,1);\n\t\tfor(rg int i=0;i<lim;++i)f[i]=f[i]*g[i]%ntf;\n\t\tNTT(f,lim,0);\n\t\tll t1=tim,t2=tim,t3=qpw(prm,tim,ntf),t4=1;\n\t\tfor(rg int i=0;i<k;++i,++t1,t2=t2*t1%ntf,t4=t4*t3%ntf)f[i]=f[i]*t2%ntf*t4%ntf;\n\t\tfor(rg int i=0;i<k;++i)ans[i+1]=(ans[i+1]*f[i])%ntf;\n\t}\n\tfor(rg int i=1;i<=k;++i)(!(ans[i]&1))&&(ans[i]+=ntf),res^=qpw(2,ans[i],NtF);\n\tprintf(\"%lld\\n\",res);\n\treturn 0;\n}\n```",
        "postTime": 1615442674,
        "uid": 59388,
        "name": "VinstaG173",
        "ccfLevel": 7,
        "title": "C \u5170\u4ead\u5e8f \u52a0\u5f3a\u7248 \u9898\u89e3"
    },
    {
        "content": "update\uff1a\u5df2\u8865\u5145\u5b8c\u6574\u8bc1\u660e\u3002\n\n\u672c\u9898\u89e3\u63d0\u4f9b\u4e86\u4e00\u79cd $\\Theta(\\sqrt[4]{a}+\\sqrt p+k\\omega(a))$\uff08\u5176\u4e2d $\\omega(a)$ \u8868\u793a $a$ \u7684\u8d28\u56e0\u5b50\u4e2a\u6570\uff09\u7684\u6574\u5f0f\u9012\u63a8\u505a\u6cd5\uff0c\u663e\u8457\u4f18\u4e8e std\u3002\n\n\u81f3\u4e8e\u5176\u4e2d\u7684 $\\sqrt p$ \u662f\u56e0\u4e3a\u8981\u505a\u5230\u4ee5 $\\Theta(k)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u8ba1\u7b97 $k$ \u4e2a\u540c\u5e95\u7684\u5feb\u901f\u5e42\uff0c\u9700\u8981\u9884\u5904\u7406\u3002\n\n\u4e3a\u4e86\u5927\u5bb6\u770b\u7684\u65b9\u4fbf\uff0c\u8fd9\u91cc\u8bd5\u7740\u5c3d\u91cf\u628a\u5f0f\u5b50\u5b8c\u6574\u63a8\u4e00\u904d\u3002\n****\n\u6839\u636e\u5355\u4f4d\u6839\u7684\u57fa\u672c\u6027\u8d28\n$$\\prod_{i=1}^{n}(x-\\omega_n^i)=x^n-1$$\n\u4ee3\u5165 $x=-1$ \u5c31\u5f97\u5230\n$$\\prod_{i=1}^n(1+\\omega_n^i)=(-1)^n((-1)^n-1) = 2\\times(n\\bmod 2)$$\n\u7531\u4e8e\u8fde\u4e58\u4e2d\u53ea\u8981\u6709\u4e00\u9879\u4e3a\u96f6\uff0c\u7b54\u6848\u5c31\u662f\u96f6\uff0c\u6240\u4ee5 $n$ \u4e3a\u5076\u6570\u65f6\u7b54\u6848\u5c31\u662f\u96f6\u3002\n\n\u82e5 $n$ \u4e3a\u5947\u6570\uff0c\u8bbe\u7b54\u6848\n$$f(n,t)=\n\\prod_{x_1=1}^n\\prod_{x_2=1}^n\\cdots\\prod_{x_t=1}^n\\left( 1+\\exp \\left( \\frac{2\\pi \\text i}{n}\\prod_{i=1}^t x_i\\right) \\right)$$\n\u800c $g(n,t)=\\log_2f(n,t)$\u3002\n\n\u8003\u8651\u9012\u63a8\uff0c\u628a $\\exp$ \u4e2d\u4e58\u79ef\u7684 $x_1$ \u63d0\u51fa\u6765\uff0c\u8bbe $d=\\gcd(x_1,n)$ \u8fd9\u6837\u5c31\u80fd\u7ea6\u5206\uff1a\n\n$$f(n,t)=\\prod_{x_1=1}^n\\prod_{x_2=1}^n\\cdots\\prod_{x_t=1}^n\\left( 1+\\exp \\left( \\frac{2\\pi \\text i x_1/d}{n/d}\\prod_{i=2}^t x_i\\right) \\right)$$\n\u6839\u636e\u5355\u4f4d\u6839\u7684\u53e6\u4e00\u4e2a\u6027\u8d28\uff0c\u5f53 $n,k$ \u4e92\u8d28\u65f6\u6709\uff1a\n$$\\prod_{i=0}^{n-1}(x-\\omega_n^{ki})=\\prod_{i=0}^{n-1}(x-\\omega_n^i)=x^n-1$$\n\u8fd9\u662f\u56e0\u4e3a $ki\\bmod n \\ (i\\in[0,n-1])$ \u53ef\u4ee5\u53d6\u904d\u6240\u6709 $[0,n-1]$ \u7684\u6574\u6570\u3002  \n\n\u6839\u636e\u8fd9\u4e2a\u6027\u8d28\uff0c\u524d\u9762\u5f0f\u5b50\u4e2d\u7684 $x_1/d$ \u5c31\u53ef\u4ee5\u76f4\u63a5\u53bb\u6389\uff0c\u5bf9\u7b54\u6848\u6ca1\u6709\u5f71\u54cd\u3002\n$$f(n,t)= \\prod_{x_1=1}^n\\prod_{x_2=1}^n\\cdots\\prod_{x_t=1}^n\\left( 1+\\exp \\left( \\frac{2\\pi \\text i }{n/d}\\prod_{i=2}^t x_i\\right) \\right)$$\n$$=\\prod_{x_1=1}^{n}\\left(\\prod_{x_2=1}^{n/d}\\cdots\\prod_{x_t=1}^{n/d}\\left( 1+\\exp \\left( \\frac{2\\pi \\text i }{n/d}\\prod_{i=2}^t x_i\\right) \\right)\\right)^{d^{t-1}}$$\n$$=\\prod_{x_1=1}^nf(n/d,t-1)^{d^{t-1}}$$\n\u4e5f\u5373\n$$g(n,t)=\\sum_{i=1}^n g\\left(\\frac{n}{\\gcd(n,i)},t-1\\right)\\gcd(n,i)^{t-1}$$\n$$=\\sum_{d|n}g\\left(\\frac{n}{d},t-1\\right)d^{t-1}\\sum_{i=1}^n [\\gcd(n,i)=d]$$\n$$=\\sum_{d|n} g( d,t-1)\\varphi(d)\\left(\\frac nd \\right)^{t-1}$$\n\u6839\u636e\u6700\u5f00\u59cb\u7684\u63a8\u8bba\uff0c\u6211\u4eec\u77e5\u9053 $g(n,1)=1$\uff0c\u5173\u4e8e $n$ \u662f\u79ef\u6027\u51fd\u6570\uff0c\u6545 $g(n,t)$ \u5173\u4e8e $n$ \u4e5f\u662f\u79ef\u6027\u51fd\u6570\uff0c\u53ea\u9700\u5bf9\u8f93\u5165\u7684 $a$ \u8d28\u56e0\u6570\u5206\u89e3\uff0c\u8ba1\u7b97 $g(p^m,t)$ \u7684\u503c\u5373\u53ef\u3002\n\n$$g(p^m,t)=\\sum_{i=0}^{m}g(p^i,t-1)\\varphi(p^i)p^{(m-i)(t-1)}$$\n\u4e0d\u8981\u5fd8\u4e86 $\\varphi(p^k)=(p-1)p^{k-1}$ \u4ec5\u5728 $k\\geq 1$ \u65f6\u6210\u7acb\u3002\n$$g(p^m,t)= p^{(t-1)m-1}+\\frac{p-1}{p}\\sum_{i=0}^m g(p^i,t-1)p^i\\times p^{(t-1)(m-i)}$$\n~~\u5173\u4e8e\u7b54\u6848\u7684\u5f0f\u5b50\u4e2a\u4eba\u6ca1\u60f3\u5230\u6bd4\u8f83\u7b80\u6d01\u7684\u8bc1\u6cd5\uff0c\u6682\u65f6\u628a\u539f\u9898\u89e3\u7684\u642c\u8fc7\u6765\uff0c\u5230\u65f6\u5019\u518d\u8865~~  \n\u5b8c\u6574\u8bc1\u660e\u5df2\u7ecf\u51fa\u7089\uff0c\u901f\u6233 $\\to$ [Link](https://www.luogu.com.cn/blog/NaCly-Fish-blog/P7513-prove) $\\leftarrow$\n\n$$g(p^m,t)= \\frac{m^{\\overline t}p^{(t-1)m}}{(t-1)!}\\sum_{j=0}^{t-1} \\binom {t-1}{j} \\frac{(-p^{-1})^j}{m+j}$$\n\u6ce8\u610f\u5230\u8fd9\u4e2a\u548c\u5f0f\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u4e8c\u9879\u5377\u79ef\uff0c\u629b\u5f00\u770b\u5230\u5377\u79ef\u5c31\u7528 FFT \u5904\u7406\u7684\u601d\u7ef4\u5b9a\u52bf\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4e0b\u9762\u8fd9\u4e2a\u5f0f\u5b50\u5982\u4f55\u9012\u63a8\u8ba1\u7b97\uff0c\u539f\u95ee\u9898\u5c31\u80fd\u8fce\u5203\u800c\u89e3\uff1a\n$$a_n=\\sum_{i=0}^{n} \\binom {n}i \\frac{q^i}{m+i}$$\n\u8bbe $\\mathcal A(x)$ \u4e3a $\\{ a_n\\}_{n=0}^{\\infty}$ \u7684 EGF\uff0c$\\mathcal H(x)$ \u4e3a $\\left\\{ \\dfrac{q^n}{m+n} \\right\\}_{n=0}^\\infty$ \u7684 EGF\uff0c\u5c31\u6709\n$$\\mathcal A(x) = \\text e^x\\mathcal H(x)$$\n\u6839\u636e\u4e00\u70b9\u6574\u5f0f\u9012\u63a8\u7684\u77e5\u8bc6\uff0c$\\mathcal H(x)$ \u7684\u7cfb\u6570\u53ef\u4ee5\u6574\u5f0f\u9012\u63a8\uff0c$\\text e^x$ \u7684\u7cfb\u6570\u663e\u7136\u4e5f\u53ef\u4ee5\u6574\u5f0f\u9012\u63a8\uff0c\u6240\u4ee5 $\\mathcal A(x)$ \u7684\u7cfb\u6570\u4e5f\u53ef\u4ee5\u6574\u5f0f\u9012\u63a8\u3002\n\n\u8fdb\u4e00\u6b65\u5730\uff0c\u6211\u4eec\u77e5\u9053\n$$(m+n)h_n=q^n$$\n\u5c06\u5176\u7528\u5fae\u5206\u65b9\u7a0b\u8868\u793a\uff0c\u6ce8\u610f EGF \u4e2d\u7684\u7b2c $n$ \u9879\u90fd\u8981\u9664\u4ee5 $n!$\u3002\n$$m \\frac{h_n}{n!}+\\frac{h_n}{(n-1)!}=\\frac{q^n}{n!}$$\n$$m\\mathcal H(x)+x\\mathcal H'(x)=\\text e^{qx}$$\n\u4ee3\u5165 $\\mathcal A(x)$ \u7684\u8ba1\u7b97\u5f0f\uff1a\n$$\\mathcal A'(x) =\\text e^x(\\mathcal H(x)+\\mathcal H'(x))$$\n$$\\mathcal A'(x) =\\mathcal A(x)+\\text e^x\\mathcal H'(x)$$\n$$\\mathcal x\\mathcal A'(x)=x\\mathcal A(x)+\\text e^x\\left( \\text e^{qx}-m\\mathcal H(x)\\right)$$\n$$x\\mathcal A'(x)=(x-m)\\mathcal A(x)+\\text e^{(q+1)x}$$\n\u63a8\u5230\u8fd9\u4e00\u6b65\u5c31\u53ef\u4ee5\u76f4\u63a5\u63d0\u7cfb\u6570\u4e86\uff1a\n$$na_n=na_{n-1}-ma_n+ (q+1)^n$$\n\u76f4\u63a5\u505a\u5c31\u80fd\u4ee5 $\\Theta(n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u6c42\u51fa\u524d $n$ \u9879\u3002\n****\n\u6700\u540e\u5c31\u662f\u7ec6\u8282\u90e8\u5206\uff0c\u6c42 $g(n,t)$ \u9700\u8981\u5bf9 $335544322$ \u53d6\u6a21\uff0c\u505a CRT \u5316\u4e3a\u5bf9 $2$ \u548c\u53e6\u4e00\u4e2a\u5927\u8d28\u6570\u53d6\u6a21\u3002\n\n\u7531 $g(n,t)$ \u7684\u521d\u59cb\u9012\u63a8\u5f0f\u77e5\u9053\u7b54\u6848\u4e00\u5b9a\u662f\u5947\u6570\uff0c\u5728\u6a21 $2$ \u4e0b\u53ef\u4ee5\u76f4\u63a5\u51fa\u7ed3\u679c\u3002  \n\u6700\u540e\u522b\u5fd8\u4e86\u5206\u89e3 $a$ \u7684\u8d28\u56e0\u6570\u8fd8\u9700\u8981 Pollard-Rho\u3002\n\n\u53c2\u8003\u4ee3\u7801\uff1a\n\uff08\u611f\u8c22 [LinearODE](https://www.luogu.com.cn/user/134757) \u63d0\u4f9b\u7684 pollard-rho \u6a21\u677f\uff09\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<cstring>\n#include<algorithm>\n#include<ctime>\n#define ll long long\n#define reg register\n#define N 200003\n#define p 167772161\n#define md 335544323\n#define i128 __int128_t\nusing namespace std;\n\ninline int power(int a,int t){\n    int res = 1;\n    while(t){\n        if(t&1) res = (ll)res*a%p;\n        a = (ll)a*a%p;\n        t >>= 1;\n    }\n    return res;\n}\n\nll gcd(ll a,ll b){ return b==0?a:gcd(b,a%b); }\n\ninline ll poww(ll a,ll t,ll m){\n    ll res = 1;\n    while(t){\n        if(t&1) res = (i128)res*a%m;\n        a = (i128)a*a%m;\n        t >>= 1;\n    }\n    return res;\n}\n\ninline bool miller_rabin(ll x,ll b){\n    ll k = x-1;\n    while(k){\n        ll cur = poww(b,k,x);\n        if(cur!=1&&cur!=x-1) return false;\n        if((k&1)||cur==x-1) return true;\n        k >>= 1;\n    }\n    return true;\n}\n\ninline bool prime(ll x){\n    if(x==46856248255981ll||x<2) return false;\n    if(x==2||x==3||x==7||x==61||x==24251) return true;\n    return miller_rabin(x,2)&&miller_rabin(x,61);\n}\n\ninline ll pollard_rho(ll x){ // \u7531\u4e8e\u6211\u4e0d\u4f1a pr,\u8fd9\u6bb5\u662f\u84af\u6765\u7684\u677f\u5b50\n    ll s = 0,t = 0,c = (rand()*rand()+rand())%(x-1)+1;\n    for(int goal=1;;goal<<=1,s=t){\n        ll val = 1;\n        for(int stp=1;stp<=goal;++stp){\n            t = ((i128)t*t+c)%x;\n            val = (i128)val*abs(t-s)%x;\n            if(stp%127==0){\n                ll d = gcd(val,x);\n                if(d>1) return d;\n            }\n        }\n        ll d = gcd(val,x);\n        if(d>1) return d;\n    }\n    return -1;\n}\n\nll max_factor;\n\ninline void find_factor(ll x){\n    if(x<=max(max_factor,2ll)) return;\n    if(prime(x)){\n        max_factor = max(max_factor,x);\n        return;\n    }\n    ll d = x;\n    while(d>=x) d = pollard_rho(x);\n    while(x%d==0) x /= d;\n    find_factor(x);\n    find_factor(d);\n}\n\nint fac[N],ifac[N];\n\nvoid init(int n){\n    fac[0] = fac[1] = ifac[0] = ifac[1] = 1;\n    for(int i=2;i<=n;++i) fac[i] = (ll)fac[i-1]*i%p;\n    ifac[n] = power(fac[n],p-2);\n    for(int i=n-1;i;--i) ifac[i] = (ll)ifac[i+1]*(i+1)%p;\n}\n\ninline int binom(int n,int m){\n    if(n<m) return 0;\n    return (ll)fac[n]*ifac[m]%p*ifac[n-m]%p;\n}\n\nint ans[N];\nint k;\n\nvoid solve(int pr,ll m){ // \u6574\u5f0f\u9012\u63a8\u90e8\u5206\n    static int pre[N],suf[N],a[N];\n    int q = p-power(pr,p-2),mul,upf = 1,pt = power(pr,m%(p-1));\n    int _m = m%p;\n    a[0] = power(_m,p-2);\n    pre[0] = suf[k+1] = 1;\n    for(int i=1;i<=k;++i) pre[i] = (ll)pre[i-1]*(i+_m)%p;\n    for(int i=k;i;--i) suf[i] = (ll)suf[i+1]*(i+_m)%p;\n    mul = power(suf[1],p-2);\n    for(int i=1;i<=k;++i){\n        upf = (ll)upf*(q+1)%p;\n        a[i] = ((ll)i*a[i-1]%p+upf)*mul%p*pre[i-1]%p*suf[i+1]%p;\n    }\n    upf = q = 1;\n    for(int i=1;i<=k;++i){\n        upf = (ll)upf*(_m+i-1)%p;\n        ans[i] = (ll)ans[i]*a[i-1]%p*upf%p*q%p*ifac[i-1]%p;\n        q = (ll)q*pt%p;\n    }\n}\n\nll a,b,cnt;\nint low[1<<15],high[12003];\n\nint main(){\n    srand(time(0));\n    int m,xx,out = 0;\n    scanf(\"%lld%lld%d\",&a,&b,&k);\n    if(!(a&1)){\n        putchar('0');\n        return 0;\n    }\n    init(k+3);\n    for(int i=0;i<=k;++i) ans[i] = 1;\n    while(a>1){\n        max_factor = cnt = 0;\n        find_factor(a);\n        while(a%max_factor==0) a /= max_factor,++cnt;\n        solve(max_factor%p,b*cnt);\n    }\n    for(int i=1;i<=k;++i) ans[i] = (p+(ll)ans[i]*(p+1))%(md-1); // crt\n    low[0] = high[0] = 1;\n    for(int i=1;i!=32768;++i) low[i] = (low[i-1]<<1)>=md?(low[i-1]<<1)-md:(low[i-1]<<1);\n    m = (low[32767]<<1)%md;\n    for(int i=1;i!=12000;++i) high[i] = (ll)high[i-1]*m%md;\n    for(int i=1;i<=k;++i){\n        xx = (ll)low[ans[i]&32767]*high[ans[i]>>15]%md;\n        out ^= xx;\n    }\n    printf(\"%d\",out);\n    return 0;\n}\n```\n****\n\u4e2a\u4eba\u9690\u7ea6\u89c9\u5f97\u8fd9\u4e2a\u505a\u6cd5\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u4f18\u5316\uff0c\u5373\u505a\u5230 $\\Theta(\\sqrt[4]a + \\sqrt p + k)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u4f46\u4e0d\u77e5\u53ef\u884c\u4e0e\u5426\u3002\n\n\u5982\u679c\u6709\u61c2\u54e5\u7684\u8bdd\u8fd8\u8bf7\u6307\u70b9\u4e00\u4e0b\uff08",
        "postTime": 1632234437,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "P7513 Solution"
    }
]
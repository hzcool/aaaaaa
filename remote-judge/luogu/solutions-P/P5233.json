[
    {
        "content": "[\u6d1b\u8c37\u9898\u9762\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5233)\n\n\u9996\u5148\u5f88\u660e\u663e\u9898\u76ee\u6697\u793a\u6211\u4eec\u5148\u6c42\u51fa\u7b26\u5408\u6761\u4ef6\u7684\u6212\u6307\u6570\u91cf\uff0c\u518d\u8ba1\u7b97\u51fa\u7531\u8fd9\u4e9b\u6212\u6307\u80fd\u591f\u6784\u6210\u7684\u9879\u94fe\u7684\u4e2a\u6570\uff0c\u56e0\u6b64\u8003\u8651\u5206\u522b\u8ba1\u7b97\u5b83\u4eec\u3002\u9996\u5148\u662f\u8ba1\u7b97\u7b26\u5408\u6761\u4ef6\u7684\u6212\u6307\u6570\u91cf\uff0c\u9898\u76ee\u4e2d\u201c\u53ef\u4ee5\u901a\u8fc7\u65cb\u8f6c\u91cd\u5408\u7684\u6212\u6307\u89c6\u4f5c\u76f8\u540c\u201d\u53ef\u4ee5\u8ba9\u6211\u4eec\u8054\u60f3\u5230 Polya \u5b9a\u7406\uff0c\u5177\u4f53\u6765\u8bf4\u6839\u636e Polya \u90a3\u5957\u7406\u8bba\uff0c\u7b26\u5408\u6761\u4ef6\u7684\u6212\u6307\u4e2a\u6570\u5c31\u662f $C=\\dfrac{1}{m}\\sum\\limits_{d\\mid n}R^d\\varphi(\\dfrac{n}{d})$\uff0c$\\mathcal O(\\sqrt{n})$ \u5730\u679a\u4e3e\u56e0\u5b50\u5e76\u8ba1\u7b97 $\\varphi$ \u5373\u53ef\u3002\u6ce8\u610f\u8fd9\u91cc $m$ \u6709\u53ef\u80fd\u662f $3214567$ \u7684\u500d\u6570\uff0c\u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u8003\u8651\u5c06\u6a21\u6570\u53d8\u6210 $3214567^2$\uff0c\u8fd9\u6837\u8ba1\u7b97\u5b8c\u4e4b\u540e\u9664\u4ee5 $m$ \u8fd9\u4e00\u6b65\u53ef\u4ee5\u5148\u4ee4\u4e58\u4e0a $\\dfrac{m}{3214567}$ \u5728\u6a21 $3214567^2$ \u610f\u4e49\u4e0b\u7684\u9006\u5143\uff0c\u7136\u540e\u7b54\u6848\u9664\u4ee5 $3214567$\uff08\u867d\u7136\u4f3c\u4e4e\u6570\u636e\u6ca1\u6709\u8fd9\u6837\u7684\u60c5\u51b5\uff1f\uff09\n\n\u63a5\u4e0b\u6765\u8003\u8651\u6b64\u9898\u7684\u7b2c\u4e8c\u90e8\u5206\uff0c\u5982\u4f55\u901a\u8fc7\u7b26\u5408\u6761\u4ef6\u7684\u6212\u6307\u6570\u91cf $C$ \u8ba1\u7b97\u9879\u94fe\u4e2a\u6570\uff0c\u4e00\u4e2a\u5f88 naive \u7684\u60f3\u6cd5\u662f $C\u00b7(C-1)^{n-1}$\uff0c\u4e0d\u8fc7\u7531\u4e8e\u201c\u7eaa\u5ff5\u54c1\u4e24\u4fa7\u6212\u6307\u4e0d\u540c\u201d\u8fd9\u4e00\u6761\u4ef6\u7684\u5b58\u5728\uff0c\u8fd9\u4e2a\u60f3\u6cd5\u662f\u9519\u8bef\u7684\u3002\u6b63\u786e\u7684\u65b9\u6cd5\u662f\uff0c\u8bbe $f_i$ \u8868\u793a\u957f\u5ea6\u4e3a $i$ \u7684\u6ee1\u8db3\u6761\u4ef6\u7684\u9879\u94fe\u4e2a\u6570\uff0c\u6211\u4eec\u8003\u8651\u4ece\u7eaa\u5ff5\u54c1\u4e00\u4fa7\u7684\u6212\u6307\u5f00\u59cb\uff0c\u7ed9 $i$ \u679a\u6212\u6307\u5206\u522b\u6807\u53f7 $1,2,3,\\cdots,i$\uff0c\u90a3\u4e48\u6211\u4eec\u8003\u8651\u5206 $1$ \u548c $i-1$ \u6212\u6307\u76f8\u540c \u4e0e $1$ \u548c $i-1$ \u6212\u6307\u4e0d\u540c\u8fd9\u4e24\u7c7b\u8fdb\u884c\u5904\u7406\uff0c\u5bf9\u4e8e $1,i-1$ \u6212\u6307\u4e0d\u540c\u7684\u60c5\u51b5\uff0c\u5982\u679c\u6211\u4eec\u628a\u6212\u6307 $i$ \u62ff\u6389\uff0c\u5176\u4f59\u6212\u6307\u7ec4\u6210\u4e86\u957f\u5ea6\u4e3a $i-1$ \u7684\u7b26\u5408\u6761\u4ef6\u7684\u9879\u94fe\uff0c\u800c\u7531\u4e8e $1,i-1$ \u6212\u6307\u4e0d\u540c\uff0c\u7b2c $i$ \u4e2a\u6212\u6307\u7684\u65b9\u6848\u6570\u5c31\u662f $C-2$\uff0c\u603b\u65b9\u6848\u6570 $f_{i-1}\u00b7(C-2)$\uff0c\u5bf9\u4e8e $1,i-1$ \u6212\u6307\u76f8\u540c\u7684\u60c5\u51b5\uff0c\u7531\u4e8e $i-2,i-1$ \u76f8\u90bb\uff0c$i-2,i-1$ \u6212\u6307\u5fc5\u5b9a\u4e0d\u540c\uff0c\u6545 $1,i-2$ \u5bf9\u5e94\u7684\u6212\u6307\u4e5f\u4e0d\u540c\uff0c\u56e0\u6b64\u5982\u679c\u6211\u4eec\u628a $i-1,i$ \u6212\u6307\u62ff\u6389\uff0c\u90a3\u5269\u4f59 $i-2$ \u4e2a\u6212\u6307\u8fd8\u662f\u53ef\u4ee5\u7ec4\u6210\u957f\u5ea6\u4e3a $i-2$ \u7684\u7b26\u5408\u6761\u4ef6\u7684\u9879\u94fe\uff0c\u8fd9\u90e8\u5206\u7684\u8d21\u732e\u4e5f\u5c31\u662f $f_{i-2}\u00b7(C-1)$\u3002\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u9012\u63a8\u5f0f $f_i=f_{i-1}\u00b7(C-2)+f_{i-2}\u00b7(C-1)$\uff0c\u8fb9\u754c\u6761\u4ef6 $f_1=0,f_2=C(C-1)$\uff0c\u76f4\u63a5\u66b4\u529b\u63a8\u662f $\\mathcal O(n)$ \u7684\uff0c\u65e0\u6cd5\u901a\u8fc7\uff0c\u4e0d\u8fc7\u5f88\u660e\u663e\u5bf9\u4e8e\u8fd9\u6837 $f_i=af_{i-1}+bf_{i-2}$ \u7684\u9012\u63a8\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u7279\u5f81\u6839\u65b9\u7a0b\u4f18\u5316\uff0c\u5177\u4f53\u6765\u8bf4\u6211\u4eec\u6c42\u51fa $x^2=ax+b$ \u7684\u4e24\u6839 $\\alpha,\\beta$\uff0c\u90a3\u4e48 $f_i$ \u7edf\u7edf\u53ef\u4ee5\u8868\u793a\u4e3a $A\\alpha^i+B\\beta^i$ \u7684\u5f62\u5f0f\u3002\u6b64\u9898\u4e5f\u4e0d\u4f8b\u5916\uff0c\u4ee3\u5165 $a=C-2,b=C-1$ \u53ef\u5f97\u7279\u5f81\u6839\u65b9\u7a0b\u4e24\u6839 $\\alpha=-1,\\beta=C-1$\uff0c\u518d\u4ee3\u5165 $f_1=0,f_2=C(C-1)$ \u53ef\u5f97 $A=(C-1),B=1$\uff0c\u56e0\u6b64 $f_i=(C-1)(-1)^n+(C-1)^n$\u3002\n\nu1s1 \u611f\u89c9\u6b64\u9898\u548c[\u8fd9\u9898](https://www.luogu.com.cn/problem/P3307)\u51fa\u5947\u5730\u76f8\u4f3c\uff0c\u9898\u89e3\u5199\u5f97\u4e5f\u51fa\u5947\u5730\u76f8\u4f3c\uff08\n\n```cpp\nll n,MMOD=MOD;int m,r;\nll getmul(ll x,ll y){return (__int128_t)(1)*x*y%MMOD;}\nint qpow(int x,ll e){\n\tint ret=1;\n\tfor(;e;e>>=1,x=1ll*x*x%MOD) if(e&1) ret=1ll*ret*x%MOD;\n\treturn ret;\n}\nll _qpow(int x,int e){\n\tll ret=1;\n\tfor(;e;e>>=1,x=getmul(x,x)) if(e&1) ret=getmul(ret,x);\n\treturn ret;\n}\nvoid exgcd(ll x,ll y,ll &a,ll &b){\n\tif(!y) return a=1,b=0,void();exgcd(y,x%y,a,b);\n\tll tmp=a;a=b;b=tmp-(x/y)*b;\n}\nll getinv(ll a,ll mod){\n\tll x,y;exgcd(a,mod,x,y);\n\treturn (x+mod)%mod;\n}\nint getphi(int x){\n\tint res=x,tmp=x;\n\tfor(int i=2;i*i<=x;i++) if(tmp%i==0){\n\t\tres=res/i*(i-1);\n\t\twhile(tmp%i==0) tmp/=i;\n\t} if(tmp>1) res=res/tmp*(tmp-1);\n\treturn res;\n}\nint main(){\n\tscanf(\"%lld%d%d\",&n,&m,&r);ll ret=0;\n\tbool flg=0;if(m%MOD==0) flg=1,MMOD=1ll*MOD*MOD;\n\tfor(int i=1;i*i<=m;i++) if(m%i==0){\n\t\tret=(ret+getmul(_qpow(r,i),getphi(m/i)))%MMOD;\n\t\tif(m/i!=i) ret=(ret+getmul(_qpow(r,m/i),getphi(i)))%MMOD;\n\t} ret=1ll*ret*getinv((flg)?(m/MOD):m,MMOD)%MMOD;\n\tif(flg) ret/=MOD,ret%=MOD;\n\tprintf(\"%d\\n\",(1ll*(ret-1)*qpow((MOD-1),n)%MOD+qpow(ret-1,n))%MOD);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1634205053,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5233 [JSOI2012]\u7231\u4e4b\u9879\u94fe"
    },
    {
        "content": "\u7406\u89e3\u672c\u9898\u89e3\u9700\u8981\u7684\u524d\u7f6e\u77e5\u8bc6\uff1aP\u00f3lya \u5b9a\u7406\u3001\u5bb9\u65a5\u539f\u7406\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\u672c\u9898\u5206\u4e3a\u4e24\u90e8\u5206\uff1a\n\n1. \u6c42\u672c\u8d28\u4e0d\u540c\u6212\u6307\u6570\u91cf\u3002\n2. \u6c42\u672c\u8d28\u4e0d\u540c\u9879\u94fe\u6570\u91cf\u3002\n\n\u5148\u6765\u770b\u7b2c\u4e00\u90e8\u5206\uff0c\u6c42\u672c\u8d28\u4e0d\u540c\u6212\u6307\u6570\u91cf\uff1a\n\n\u6212\u6307\u53ef\u4ee5\u770b\u505a\u957f\u5ea6\u4e3a $m$ \u7684\u73af\uff0c\u7528 $r$ \u79cd\u989c\u8272\u8fdb\u884c\u67d3\u8272\uff0c\u53ea\u5b58\u5728\u65cb\u8f6c\u540c\u6784\u3002\u8fd9\u4e2a\u4e1c\u897f\u5176\u5b9e\u5c31\u662f [P4980 \u3010\u6a21\u677f\u3011P\u00f3lya \u5b9a\u7406](https://www.luogu.com.cn/problem/P4980)\uff0c\u4e0b\u9762\u6211\u4eec\u6765\u63a8\u4e00\u4e0b\u5f0f\u5b50\u3002\n\n\u7f6e\u6362\u7fa4 $G$ \u4e3a\u987a\u65f6\u9488\u65cb\u8f6c $0\\sim m-1$ \u4e2a\u4f4d\u7f6e\u8fd9\u4e9b\u7f6e\u6362\uff0c\u7b54\u6848\u5373\u4e3a\u5728 $G$ \u4f5c\u7528\u4e0b\u7b49\u4ef7\u7c7b\u7684\u6570\u91cf\u3002\u540c\u65f6\uff0c\u5b9a\u4e49\u96c6\u5408 $M$ \u4e3a $1\\sim m$ \u6240\u6709\u53ef\u80fd\u6392\u5217\uff0c\u5c31\u662f\u521d\u59cb\u7684\u6392\u5217\u60c5\u51b5\u3002\n\n\u6211\u4eec\u8bbe $c(g)$ \u4e3a\u7f6e\u6362 $g\\in G$ \u62c6\u6210\u7684\u5faa\u73af\u7f6e\u6362\u4e2a\u6570\uff0c\u90a3\u4e48\u65cb\u8f6c $k$ \u4e2a\u4f4d\u7f6e\u7684\u7f6e\u6362 $g$ \u7684\u5faa\u73af\u7f6e\u6362\u4e2a\u6570\u4e3a\u591a\u5c11\u5462\uff1f$|g|=\\frac{\\textrm{lcm}(m,k)}{k}=\\frac{m}{\\gcd(m,k)}$\uff0c\u56e0\u6b64 $c(g)=\\gcd(m,k)$\u3002\n\n\u6839\u636e P\u00f3lya \u5b9a\u7406\uff0c\u5957\u8def\u63a8\u5f0f\u5b50\u5f97\uff1a\n\n$$\n\\begin{aligned}\nans&=\\frac{1}{|G|}\\sum\\limits_{g\\in G}r^{c(g)}\\\\\n&=\\frac{1}{m}\\sum\\limits_{i=1}^mr^{\\gcd(m,k)}\\\\\n&=\\frac{1}{m}\\sum\\limits_{i=1}^m\\sum\\limits_{d}r^d[\\gcd(m,i)==d]\\\\\n&=\\frac{1}{m}\\sum\\limits_{d=1}^mr^d\\sum\\limits_{i=1}^{\\frac{m}{d}}[\\gcd(\\frac{m}{d},i)==1]\\\\\n&=\\frac{1}{m}\\sum\\limits_{d\\mid m}r^d\\varphi(\\frac{m}{d})\n\\end{aligned}\n$$\n\n\u4e8e\u662f\u7b2c\u4e00\u90e8\u5206\u5c31\u505a\u5b8c\u4e86\uff0c\u5047\u8bbe\u4e0a\u9762\u8fd9\u4e2a\u7b54\u6848\u4e3a $k$\uff0c\u518d\u770b\u7b2c\u4e8c\u90e8\u5206\uff0c\u6c42\u672c\u8d28\u4e0d\u540c\u9879\u94fe\u6570\u91cf\uff1a\n\n\u5982\u679c\u4e0d\u8003\u8651\u7279\u6b8a\u7eaa\u5ff5\u54c1\u4e24\u4fa7\u4e0d\u80fd\u76f8\u540c\uff0c\u53ea\u8003\u8651\u628a\u6212\u6307\u4e32\u6210\u4e00\u6761\u94fe\u65f6\u76f8\u90bb\u4e0d\u80fd\u76f8\u540c\uff0c\u6b64\u65f6\u4e0d\u96be\u5f97\u5230\u6570\u91cf\u4e3a $k\\cdot(k-1)^{n-1}$\u3002\u4f46\u662f\u7279\u6b8a\u7eaa\u5ff5\u54c1\u4e24\u4fa7\u8fd8\u4e0d\u80fd\u76f8\u540c\uff0c\u600e\u4e48\u529e\u5462\uff1f\u4f7f\u7528\u5bb9\u65a5\uff0c\u89c4\u5b9a\u7279\u6b8a\u7eaa\u5ff5\u54c1\u4e24\u4fa7\u76f8\u540c\u7684\u65b9\u6848\u6570\u4e3a $n\\gets n-1$ \u7684\u60c5\u51b5\u3002\n\n\u9012\u5f52\u4e0b\u53bb\u8ba1\u7b97\u65f6\u95f4\u663e\u7136\u7206\u70b8\uff0c\u6211\u4eec\u53ef\u4ee5\u624b\u73a9\u4e00\u4e0b\u9012\u5f52\u7684\u8fc7\u7a0b\uff0c\u5229\u7528\u5bb9\u65a5\u7684\u6027\u8d28\u52a0\u51cf\u76f8\u6d88\uff0c\u4e0d\u96be\u627e\u5230\u89c4\u5f8b\uff0c\u7b54\u6848\u4e3a $(k-1)^n+(k-1)(-1)^n$\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u4f7f\u7528\u7279\u5f81\u65b9\u7a0b\u7b49\u65b9\u5f0f\u8fdb\u884c\u63a8\u5bfc\u3002\n\n\u7ed3\u5408\u4e00\u4e0b\u4e0a\u9762\u4e24\u90e8\u5206\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\u6700\u7ec8\u7684\u7b54\u6848\u4e86\u3002\n\n\u653e\u4e00\u4efd\u4ee3\u7801\uff08\u4ec5\u4f9b\u53c2\u8003\uff09\uff1a\n\n```cpp\n//By: Luogu@rui_er(122461)\n#include <bits/stdc++.h>\n#define rep(x,y,z) for(ll x=y;x<=z;x++)\n#define per(x,y,z) for(ll x=y;x>=z;x--)\n#define debug printf(\"Running %s on line %d...\\n\",__FUNCTION__,__LINE__)\n#define fileIO(s) do{freopen(s\".in\",\"r\",stdin);freopen(s\".out\",\"w\",stdout);}while(false)\nusing namespace std;\ntypedef long long ll;\nconst ll mod = 3214567;\n\nll n, m, r;\ntemplate<typename T> void chkmin(T& x, T y) {if(x > y) x = y;}\ntemplate<typename T> void chkmax(T& x, T y) {if(x < y) x = y;}\nll qpow(ll x, ll y) {\n\tll ans = 1;\n\tfor(;y;y>>=1,x=x*x%mod) if(y & 1) ans = ans * x % mod;\n\treturn ans;\n}\nll inv(ll x) {return qpow(x, mod-2);}\nll phi(ll x) {\n\tll ans = x;\n\tfor(ll i=2;i*i<=x;i++) {\n\t\tif(!(x % i)) {\n\t\t\tans = ans / i * (i - 1);\n\t\t\twhile(!(x % i)) x /= i;\n\t\t}\n\t}\n\tif(x > 1) ans = ans / x * (x - 1);\n\treturn ans;\n}\n\nint main() {\n\tscanf(\"%lld%lld%lld\", &n, &m, &r);\n\tll k = 0, lim = sqrt(m);\n\trep(d, 1, lim) {\n\t\tif(!(m % d)) {\n\t\t\tk = (k + qpow(r, d) * phi(m/d) % mod) % mod;\n\t\t\tif(d != m / d) k = (k + qpow(r, m/d) * phi(d) % mod) % mod;\n\t\t}\n\t}\n\tk = k * inv(m) % mod;\n\tll ans = (qpow(k-1, n) + ((n & 1) ? -1 : 1) * (k - 1) + mod) % mod;\n\tprintf(\"%lld\\n\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1644795441,
        "uid": 122461,
        "name": "rui_er",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5233\u3010[JSOI2012]\u7231\u4e4b\u9879\u94fe\u3011"
    },
    {
        "content": "\u5bf9\u4e8e\u672c\u9898\uff0c\u9898\u610f\u5c31\u4e0d\u8bb2\u89e3\u4e86\u5427\uff1b\n\n\u6211\u4eec\u770b\u9898\uff1a\n\u6c42\u89e3\u7684\u662f\u65b9\u6848\u603b\u6570\n\n\u90a3\u4e48\u6211\u4eec\u60f3\uff1a\u6211\u4eec\u662f\u4e0d\u662f\u53ef\u4ee5\u9996\u5148\u6c42\u51fa\u4e00\u5171\u6709\u591a\u5c11\u79cd\u4e0d\u540c\u7684\u6212\u6307\uff0c\u53c8\u7531\u4e8e\u6709\u90a3\u4e2a\u7279\u6b8a\u7684\u4e1c\u897f\uff0c\u76f8\u5f53\u4e8e\u8fd9\u4e32\u9879\u94fe\u5373\u4f7f\u65cb\u8f6c\u540e\u76f8\u540c\uff0c\u4f46\u7279\u6b8a\u7684\u4e1c\u897f\u63d2\u5165\u7684\u4f4d\u7f6e\u4e5f\u80af\u5b9a\u662f\u4e0d\u540c\u7684\uff0c\u56e0\u6b64\u5373\u4e0d\u8003\u8651\u65cb\u8f6c\uff0c\u53ea\u8003\u8651\u76f8\u90bb\u4f4d\u7f6e\u4e0d\u540c\u7684\u7231\u4e4b\u9879\u94fe\u7684\u65b9\u6848\u6570\u3002\n\n\u7136\u540e\u8fd9\u4e2a\u95ee\u9898\u7ecf\u8fc7\u5927\u5bb6\u52aa\u529b\u6c42\u89e3\u4e4b\u540e\uff0c\uff0c\n\n\u5c31\u89e3\u51b3\u4e86\u5f88\u591a\uff0c\u63a5\u4e0b\u6765\u4e0a\u91cd\u70b9\uff08\u6572\u9ed1\u677f\uff01\uff09\n\n>\u63a5\u4e0b\u6765\u5c31\u662f\u8fd0\u7528\u5bb9\u65a5\u539f\u7406\u3002\u5bf9\u4e8e\u7b2ci\u4e2a\u6212\u6307\u548c\u7b2ci+1\u4e2a\u6212\u6307\u76f8\u540c\uff0c\u53ef\u4ee5\u770b\u6210\u7b2ci\u4e2a\u9650\u5236\uff0c\u7136\u540e\u7b2cn\u4e2a\u9650\u5236\u5373\u7b2cn\u4e2a\u6212\u6307\u548c\u7b2c1\u4e2a\u9650\u5236\u4e0d\u540c\uff0c\u90a3\u4e48\u5373\u8981\u6c42\u6ee1\u8db3\u6240\u6709\u9650\u5236\u7684\u65b9\u6848\u6570\u3002\u4ee4Si\u4e3a\u6ee1\u8db3\u7b2ci\u4e2a\u9650\u5236\u7684\u65b9\u6848\u6570\u7684\u96c6\u5408\uff0c\u90a3\u4e48\u5373\u6c42S1~Sn\u7684\u4ea4\uff0c\u4e5f\u5c31\u662f\u5176\u8865\u96c6\u7684\u5e76\uff0c\u90a3\u4e48\u5c31\u662f\u603b\u65b9\u6848\u6570\u51cf\u53bb\u6240\u6709\u4e0d\u6ee1\u8db3\u4efb\u610f\u4e00\u4e2a\u9650\u5236\u6570\u52a0\u4e0a\u6240\u6709\u4e0d\u6ee1\u8db3\u4efb\u610f\u4e8c\u4e2a\u9650\u5236\u6570......\n\n\u7136\u540e\u4e00\u5927\u5806\u5b50\u83ab\u540d\u5176\u5999\u7684\u4e1c\u4e1c\uff0c\uff0c\n\n\u5c31\u53ef\u4ee5\u4e86\u2026\u2026\n\n\u4f46\u662f\u540e\u6765\u8981\u6ce8\u610f\u4e00\u70b9\uff1a\n\t\t\t\n            \u9996\u5148\u603b\u65b9\u6848\u6570\u663e\u7136\u5c31\u662fans^n\uff0c\n            \u7136\u540e\u4e0d\u6ee1\u8db3\u4efb\u610f\u4e00\u4e2a\u9650\u5236\u6570\u5373\u6709\u4e24\u4e2a\u76f8\u90bb\u7684\u76f8\u540c\uff0c\n            \u53ef\u4ee5\u770b\u6210\u4e00\u6761\u8fb9\u8fde\u63a5\u7684\u4e24\u4e2a\u70b9\u76f8\u540c\uff0c\u5c31\u662fC(n,1)*ans^(n-1)\uff0c\n            \u4ee5\u6b64\u7c7b\u63a8\uff0c\u7136\u540e\u53ef\u4ee5\u5f97\u5230\uff1asigma(0<=i<=n,(-1)^i*C(n,i)*ans^(n-i))\uff0c\n            \u7136\u540e\u53d1\u73b0\u8fd9\u5c31\u662f\u4e8c\u9879\u5f0f\u5b9a\u7406\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230(ans-1)^n\uff0c\n            \u4f46\u771f\u7684\u5c31\u662f\u8fd9\u6837\u5417\uff1f\u5f53i=n\u65f6\uff0c\u5c31\u4f1a\u6709\u4e00\u4e2aBug\uff0c\n            \u7528\u516c\u5f0f\u7b97\u5f97\u7684\u7b54\u6848\u662f(-1)^n\uff0c\n            \u7136\u800cn\u4e2a\u9650\u5236\u5747\u4e0d\u6ee1\u8db3\u65f6\u7684\u60c5\u51b5\u5373\u6240\u6709\u989c\u8272\u90fd\u4e00\u6837\uff0c\n            \u6709ans\u79cd\uff0c\u56e0\u6b64\u8fd8\u8981\u52a0\u4e0a(n&1?1-m:m-1)\u624d\u884c\u3002\n            \n      \n\u55ef\uff0c\u8fd9\u91cc\u5c31\u76f4\u63a5\u628a\u6211\u770b\u7684\u9898\u89e3code\u653e\u4e0a\u53bb\u5566\uff0c\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<cmath>\nusing namespace std;\n#define p 3214567\n#define maxn 200020\n \nint m,r,tot;\nint prime[maxn],phi[maxn];\nbool isprime[maxn];\nlong long n;\n \nint power(int a,long long k){\n    if (k==0) return 1;\n    if (k==1) return a%p;\n    int x=power(a,k/2),ans=1ll*x*x%p;\n    if (k&1) ans=1ll*a*ans%p;\n    return ans;\n}\n \nint fphi(int x){\n    int ans=x;\n    for (int i=2;i*i<=x;i++)\n        if (x%i==0){\n            ans=ans-ans/i;\n            while (x%i==0) x/=i;\n        }\n    if (x!=1) ans=ans-ans/x;\n    return ans;\n}\n \nint main(){\n    scanf(\"%lld%d%d\",&n,&m,&r);tot=0,memset(isprime,1,sizeof(isprime)),phi[1]=1;\n    for (int i=2;i<maxn;i++){\n        if (isprime[i]) prime[++tot]=i,phi[i]=i-1;\n        for (int j=1;j<=tot && i*prime[j]<maxn;j++){\n            isprime[i*prime[j]]=0;\n            if (i%prime[j]==0){\n                phi[i*prime[j]]=phi[i]*prime[j];\n                break;\n            }\n            phi[i*prime[j]]=phi[i]*(prime[j]-1);\n        }\n    }\n    int ans=0;\n    for (int i=1;i*i<=m;i++)\n        if (m%i==0){\n            ans=(ans+1ll*power(r,i)*fphi(m/i)%p)%p;\n            if (i*i!=m) ans=(ans+1ll*power(r,m/i)*phi[i]%p)%p;\n        }\n    ans=1LL*ans*power(m,p-2)%p;\n    int t=(1ll*power(ans-1,n)+(n&1?1-ans:ans-1))%p;\n    printf(\"%d\\n\",(t+p)%p);\n    return 0;\n}\n```\n[\u9898\u89e3\u6765\u6e90](https://www.cnblogs.com/DUXT/p/5951747.html)",
        "postTime": 1571837392,
        "uid": 211665,
        "name": "ccsc",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5233 \u3010[JSOI2012]\u7231\u4e4b\u9879\u94fe\u3011"
    }
]
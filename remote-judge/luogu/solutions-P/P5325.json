[
    {
        "content": "\u6d1b\u8c37\u9898\u5e93\u91cc\u9762\u7ec8\u4e8e\u6709\u6211\u7684\u9898\u4e86\uff08\u867d\u7136\u662f\u4e00\u9053\u677f\u5b50\uff09\uff0c\u5fc5\u987b\u53d1\u4e00\u4efd\u9898\u89e3\u5e86\u795d\u4e00\u4e0b\u3002\n\n## \u9898\u610f\n\n\u6c42$\\sum_{i=1}^nf(i)$\uff0c\u5176\u4e2d$f(i)$\u662f\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\uff0c\u4e14$f(p^k)=p^k(p^k-1)$\u3002\n\n## Min_25\u7b5b\n\n\u4e3a\u4ec0\u4e48\u8fd9\u4e2a\u7b5b\u6cd5\u53eb\u505aMin25\u7b5b\u5462\uff1f\u56e0\u4e3a\u8fd9\u4e2a\u7b97\u6cd5\u662fMin25\u53d1\u660e\u7684\u3002\n\n\u5047\u8bbe\u6211\u4eec\u8981\u6c42\u4e00\u4e2a$\\sum_{i=1}^nf(i)$\uff0c\u6ee1\u8db3$f(x)$\u662f\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\uff0c\u4e14$f(p^e)$\u662f\u4e00\u4e2a\u5173\u4e8e$p$\u7684\u4f4e\u9636\u591a\u9879\u5f0f\u3002\n\n\u56e0\u4e3a\u591a\u9879\u5f0f\u53ef\u4ee5\u62c6\u6210\u82e5\u5e72\u4e2a\u5355\u9879\u5f0f\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651\u6c42\u51fa$f(p)=p^k$\u7684\u524d\u7f00\u548c\uff0c\u7136\u540e\u6bcf\u4e00\u9879\u52a0\u8d77\u6765\u5c31\u884c\u4e86\u3002\n\n\u90a3\u4e48\u5982\u4f55\u6c42\u51fa\u6bcf\u4e00\u9879\u7684\u548c\u5462\uff1f\n\n### Step1 \u5206\u7c7b\n\n\u8ba9\u6211\u4eec\u5148\u5bf9$i$\u6309\u7167\u8d28\u6570\u548c\u5408\u6570\u5206\u7c7b\uff1a\n\n$$\\sum_{i=1}^nf(i)=\\sum_{1\\le p\\le n}f(p)+\\sum_{i=1\\&\\text{i is not a prime}}^nf(i)$$\n\n\u7136\u540e\uff0c\u6211\u4eec\u679a\u4e3e\u540e\u9762\u5408\u6570\u7684\u6700\u5c0f\u8d28\u56e0\u5b50\u4ee5\u53ca\u6700\u5c0f\u8d28\u56e0\u5b50\u7684\u6b21\u6570\u3002\u6ce8\u610f\u6240\u6709\u5408\u6570\u7684\u6700\u5c0f\u8d28\u56e0\u5b50\u4e00\u5b9a\u90fd\u5c0f\u4e8e\u7b49\u4e8e$\\sqrt n$\uff1a\n\n$$\\sum_{1\\le p\\le n}f(p)+\\sum_{1\\le p^e\\le n,1\\le p\\le \\sqrt n}f(p^e)\\left(\\sum_{1\\le i\\le n/p^e\\&minp>p}f(i)\\right)$$\n\n\u5176\u4e2d$minp$\u8868\u793a$i$\u7684\u6700\u5c0f\u8d28\u56e0\u5b50\uff0c\u56e0\u4e3a\u516c\u5f0f\u4e2d\u6587\u592a\u4e11\u4e86\u6240\u4ee5\u5c31\u53ea\u597d\u5199\u82f1\u6587\u4e86\u3002\n\n\u8fd9\u6837\uff0c\u6574\u4e2a\u5f0f\u5b50\u5c31\u53d8\u6210\u4e86\u4e24\u4e2a\u90e8\u5206\uff0c\u7b2c\u4e00\u90e8\u5206\u662f\u6240\u6709\u8d28\u6570\u7684$f$\u4e4b\u548c\uff0c\u53e6\u4e00\u90e8\u5206\u662f\u679a\u4e3e\u6700\u5c0f\u8d28\u56e0\u5b50\u540e\uff0c\u6c42\u6240\u6709\u6700\u5c0f\u8d28\u56e0\u5b50\u5927\u4e8e\u8fd9\u4e2a\u8d28\u56e0\u5b50\u7684$f$\u4e4b\u548c\u3002\n\n### Step2 \u7b2c\u4e00\u90e8\u5206\n\n\u7531\u4e8e$n$\u5b9e\u5728\u592a\u5927\uff0c\u6240\u4ee5\u6211\u4eec\u6ca1\u6cd5\u7528\u7ebf\u6027\u7b5b\u6c42\u51fa\u6240\u6709\u8d28\u6570\u7684$f$\u548c\u3002\n\n\u6211\u4eec\u8003\u8651\u4e00\u4e2aDP\u7684\u601d\u8def\uff08\u5929\u54ea\u8fd9\u662f\u600e\u4e48\u60f3\u5230\u7684\uff09\uff1a\u6211\u4eec\u4e0d\u77e5\u9053\u4ece\u54ea\u91cc\u627e\u6765\u4e86\u4e00\u4e2aDP\u6570\u7ec4$g(n,i)$\uff0c\u6ee1\u8db3\n\n$$g(n,j)=\\sum_{i=1}^n[\\text{i is a prime or minp$> p_j$}]i^k$$\n\n\u8fd9\u91cc\u7684$k$\u5c31\u662f\u524d\u9762\u6211\u4eec\u8bf4\u7684\u4f4e\u9636\u591a\u9879\u5f0f\u7684\u4e00\u9879\u3002\u6ce8\u610f$i^k$\u5e76\u4e0d\u662f\u6211\u4eec\u8981\u6c42\u7684$f$\uff0c\u53ea\u662f\u4e00\u4e2a\u548c$f$\u5728\u8d28\u6570\u5904\u7684\u53d6\u503c\u4e00\u6837\u7684\u5b8c\u5168\u79ef\u6027\u51fd\u6570\uff0c\u8fd9\u6837\u540e\u9762\u8ba1\u7b97\u8d77\u6765\u6bd4\u8f83\u65b9\u4fbf\u3002\n\n\u8fd9\u4e2a\u5f0f\u5b50\u8bf4\u4eba\u8bdd\u5c31\u662f$g(n,j)$\u8868\u793a\u6c42$1$\u5230$n$\u4e4b\u95f4\u6240\u6709\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u7684$k$\u6b21\u65b9\u548c\uff0c\u6761\u4ef6\u5c31\u662f\u8981\u4e48\u662f\u8d28\u6570\u8981\u4e48\u6700\u5c0f\u8d28\u56e0\u5b50\u5927\u4e8e$p_j$\u3002\n\n\u6211\u4eec\u8003\u8651$g(n,j-1)$\u5982\u4f55\u8f6c\u79fb\u5230$g(n,j)$\u3002\u968f\u7740$j$\u7684\u589e\u5927\uff0c\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u53d8\u5c11\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u51cf\u53bb\u4e00\u4e9b\u539f\u6765\u6ee1\u8db3\u6761\u4ef6\u800c\u73b0\u5728\u4e0d\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u3002\n\n\u8fd9\u4e9b\u6570\u5e94\u8be5\u662f\u6700\u5c0f\u8d28\u56e0\u5b50\u6070\u597d\u4e3a$p_{j}$\u7684\u5408\u6570\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u63d0\u51fa\u6765\u4e00\u4e2a$p_{j}$\u4f5c\u4e3a\u6700\u5c0f\u8d28\u56e0\u5b50\uff0c\u8fd9\u6837\u5269\u4e0b\u7684\u5c31\u4e0d\u80fd\u6709\u5c0f\u4e8e\u5b83\u7684\u8d28\u56e0\u5b50\u4e86\uff0c\u4e5f\u5c31\u662f$g\\left(\\dfrac{n}{p_{j}},j\\right)-g(p_{j-1},j-1)$\uff0c\u540e\u9762\u90a3\u4e2a$g$\u662f\u4e3a\u4e86\u628a\u6240\u6709\u7684\u8d28\u6570\u53bb\u6389\u3002\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u5f97\u5230\u4e86$g$\u7684\u9012\u63a8\u5f0f\uff1a\n\n$$g(n,j)=g(n,j-1)-p_j^k\\left(g\\left(\\dfrac{n}{p_j},j-1\\right)-g(p_{j-1},j-1)\\right)$$\n\n\u5b8c\u5168\u79ef\u6027\u51fd\u6570\u7684\u597d\u5904\u5728\u8fd9\u91cc\u5c31\u4f53\u73b0\u51fa\u6765\u4e86\uff1a\u7531\u4e8e\u53ea\u63d0\u51fa\u4e86\u4e00\u4e2a$p_i$\uff0c\u6240\u4ee5\u540e\u9762\u8fd8\u6709\u53ef\u80fd\u6709$p_i$\u8fd9\u4e2a\u56e0\u5b50\uff0c\u5982\u679c\u662f\u5b8c\u5168\u79ef\u6027\u51fd\u6570\u7684\u8bdd\u5c31\u53ef\u4ee5\u5c06\u51fd\u6570\u503c\u76f4\u63a5\u76f8\u4e58\uff0c\u800c\u4e0d\u7528\u7ba1\u662f\u5426\u4e92\u8d28\u3002\n\n\u6ce8\u610f\u5230\u540e\u9762\u7684$g(p_{j-1},j-1)$\u5176\u5b9e\u5c31\u662f\u524d$j-1$\u4e2a\u8d28\u6570\u7684$k$\u6b21\u65b9\u548c\u3002\u7531\u4e8e$p_j\\le \\sqrt n$\uff0c\u6240\u4ee5\u8fd9\u4e00\u90e8\u5206\u53ef\u4ee5\u7528\u7ebf\u6027\u7b5b\u9884\u5904\u7406\uff0c\u6211\u4eec\u8bbe$sp_n=\\sum_{i=1}^np_i^k$\uff0c\u4e5f\u5c31\u662f\u524d$n$\u4e2a\u8d28\u6570\u7684$k$\u6b21\u65b9\u548c\u3002\n\n$1$\u5230$n$\u4e2d\u6240\u6709\u8d28\u6570\u7684$k$\u6b21\u65b9\u548c\u5176\u5b9e\u5c31\u662f$g(n,x)$\uff0c\u5176\u4e2d$p_x$\u662f\u6700\u540e\u4e00\u4e2a\u5c0f\u4e8e\u7b49\u4e8e$\\sqrt n$\u7684\u8d28\u6570\u3002\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u628a\u5b83\u8bb0\u4f5c$g(n)$\u3002\n\n\u4f46\u662f\u56e0\u4e3a$n$\u592a\u5927\uff0c\u6211\u4eec\u8fd8\u662f\u6ca1\u6cd5\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$n$\u6c42\u51fa$g(n,x)$\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u53e6\u4e00\u4e2a\u91cd\u8981\u7684\u7ed3\u8bba\uff1a\n\n$$\\left\\lfloor\\dfrac{\\lfloor\\dfrac na\\rfloor}{b}\\right\\rfloor=\\lfloor\\dfrac{n}{ab}\\rfloor$$\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u65e0\u8bba\u4f60\u6bcf\u4e00\u6b21\u628a$n$\u9664\u4ee5\u51e0\uff0c\u6700\u540e\u4f60\u80fd\u5f97\u5230\u7684\u6570\u4e00\u5b9a\u662f\u67d0\u4e00\u4e2a$\\lfloor\\dfrac nx\\rfloor$\uff0c\u6240\u4ee5\u6211\u4eec\u6ca1\u5fc5\u8981\u7b97\u51fa\u6765\u6240\u6709\u7684$n$\uff0c\u53ea\u9700\u8981\u7b97\u51fa\u53ef\u4ee5\u5199\u6210$\\lfloor\\dfrac{n}{x}\\rfloor$\u8fd9\u79cd\u5f62\u5f0f\u7684\u6570\uff0c\u8fd9\u6837\u7684\u6570\u4e00\u5171\u6709$O(\\sqrt n)$\u4e2a\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5982\u4f55\u5b58\u50a8\u8fd9$\\sqrt n$\u4e2a\u6570\u5462\uff1f\n\n\u9996\u5148\u6211\u4eec\u4e0d\u80fd\u76f4\u63a5\u4e0b\u6807\u8bbf\u95ee\uff0c\u8fd9\u6837\u4e0b\u6807\u53ef\u4ee5\u5230$n$\u3002\u6211\u4eec\u9700\u8981\u5bf9\u4e0b\u6807\u79bb\u6563\u5316\u3002\n\n\u4f46\u662f\u79bb\u6563\u5316\u4e4b\u540e\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u77e5\u9053\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$\\lfloor\\dfrac nx\\rfloor$\uff0c\u5b83\u5bf9\u5e94\u7684\u4e0b\u6807\u662f\u4ec0\u4e48\u3002\n\n\u5982\u679c\u5077\u61d2\u7684\u8bdd\u53ef\u4ee5\u7528map\uff0c\u4f46\u662f\u65f6\u95f4\u590d\u6742\u5ea6\u4f1a\u591a\u4e00\u4e2a$\\log$\u3002\u6211\u4eec\u53ef\u4ee5\u7528$ind1[x]$\u8868\u793a$x$\u8fd9\u4e2a\u6570\u5bf9\u5e94\u7684\u6570\u7ec4\u4e0b\u6807\uff0c$ind2[x]$\u8868\u793a$n/x$\u8fd9\u4e2a\u6570\u5bf9\u5e94\u7684\u4e0b\u6807\u3002\u8fd9\u6837\u4e24\u4e2a$ind$\u6570\u7ec4\u6700\u5927\u90fd\u53ea\u4f1a\u5230$\\sqrt n$\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u53ef\u4ee5\u770b\u4ee3\u7801\u3002\u6570\u7ec4\u7684\u8bb0\u5f55\u4e0a\u9700\u8981\u7cbe\u7ec6\u5b9e\u73b0\u4e00\u4e0b\u3002\n\n### Step2 \u6c42\u89e3\u7b54\u6848\n\n\u7b54\u6848\u5c31\u662f\u5148\u6c42\u51fa\u6240\u6709\u8d28\u6570\u7684\u51fd\u6570\u548c\uff0c\u7136\u540e\u5148\u679a\u4e3e\u4e86\u4e00\u4e2a$p^e$\uff0c\u518d\u679a\u4e3e\u6700\u5c0f\u8d28\u56e0\u5b50\u5927\u4e8e$p$\u7684\u6570\u3002\n\n\u6211\u4eec\u8fd8\u662f\u53ef\u4ee5\u8003\u8651DP\u7684\u601d\u60f3\u3002\u8bbe$S(n,x)$\u8868\u793a\u6c42$1$\u5230$n$\u4e2d\u6240\u6709\u6700\u5c0f\u8d28\u56e0\u5b50\u5927\u4e8e$p_x$\u7684\u51fd\u6570\u503c\u4e4b\u548c\uff0c\u6ce8\u610f\u8fd9\u91cc\u662f$f$\u800c\u4e0d\u662f$k$\u6b21\u65b9\u3002\u7b54\u6848\u5c31\u662f$S(n,0)$\u3002\n\n\u6211\u4eec\u5c06\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u5206\u6210\u4e24\u90e8\u5206\uff0c\u7b2c\u4e00\u90e8\u5206\u662f\u5927\u4e8e$p_x$\u7684\u8d28\u6570\uff0c\u4e5f\u5c31\u662f$g(n)-sp_x$\uff0c\u53e6\u4e00\u90e8\u5206\u662f\u6700\u5c0f\u8d28\u56e0\u5b50\u5927\u4e8e$p_x$\u7684\u5408\u6570\uff0c\u679a\u4e3e\u6700\u5c0f\u8d28\u56e0\u5b50\uff1a\n\n$$S(n,x)=g(n)-sp_x+\\sum_{p_k^e\\le n\\&k>x}f(p_k^e)\\left(S\\left(\\dfrac{n}{p_k^e},k\\right)+[e\\neq 1]\\right)$$\n\n\u8fd9\u6837\u95ee\u9898\u5c31\u89e3\u51b3\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u9012\u5f52\u6c42\u89e3\u8fd9\u4e2a\u95ee\u9898\u3002\u6839\u636e\u67d0\u7384\u5b66\u5b9a\u7406\uff0c\u4e0d\u9700\u8981\u8bb0\u5fc6\u5316\u3002\n\n### \u4e00\u4e9b\u7ec6\u8282\n\n$1$\u65e2\u4e0d\u662f\u8d28\u6570\u4e5f\u4e0d\u662f\u5408\u6570\uff0c\u4e0d\u542b\u4efb\u4f55\u4e00\u4e2a\u8d28\u56e0\u5b50\uff0c\u90a3\u4e48\u6c42\u89e3\u7684\u8fc7\u7a0b\u4e2d$g$\u548c$S$\u5230\u5e95\u662f\u5426\u5305\u542b$1$\u5462\uff1f\u5176\u5b9e\u662f\u5426\u5305\u542b\u90fd\u53ef\u4ee5\uff0c\u4f46\u662f\u5904\u7406\u4e0a\u7565\u6709\u5dee\u522b\u3002\u6211\u7684$g$\u548c$S$\u90fd\u6ca1\u6709\u5305\u542b$1$\uff0c\u53ea\u9700\u8981\u6700\u540e\u52a0\u4e00\u5c31\u884c\u4e86\u3002\n\nmin25\u7b5b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u636e\u8bf4\u662f$O\\left(\\dfrac{n^{3/4}}{\\log n}\\right)$\uff0c\u4e5f\u6709\u4eba\u8bf4\u662f$O(n^{1-\\epsilon})$\uff0c\u5728\u8fd9\u9053\u9898\u4e0a\u5927\u81f4\u662f1e10\u8dd11s\u5de6\u53f3\u7684\u6837\u5b50\u3002\u4f46\u662f\u8fd9\u4e2a\u7b97\u6cd5\u5e38\u6570\u5f88\u5c0f\uff0c\u5177\u4f53\u8868\u73b0\u53c2\u52a0WC2019\u8bfe\u4ef6\u91cc\u9762\u7684\u4e00\u5f20\u56fe\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/56355.png)\n\n## \u4ee3\u7801\u5b9e\u73b0\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n#define ll long long\nusing namespace std;\nconst ll MOD=1000000007,inv2=500000004,inv3=333333336;\nll prime[1000005],num,sp1[1000005],sp2[1000005];\nll n,Sqr,tot,g1[1000005],g2[1000005],w[1000005],ind1[1000005],ind2[1000005];\nbool flag[1000005];\nvoid pre(int n)//\u9884\u5904\u7406\uff0c\u7ebf\u6027\u7b5b\n{\n    flag[1]=1;\n    for(int i=1;i<=n;i++)\n    {\n        if(!flag[i])\n        {\n            prime[++num]=i;\n            sp1[num]=(sp1[num-1]+i)%MOD;\n            sp2[num]=(sp2[num-1]+1ll*i*i)%MOD;\n        }\n        for(int j=1;j<=num&&prime[j]*i<=n;j++)\n        {\n            flag[i*prime[j]]=1;\n            if(i%prime[j]==0)break;\n        }\n    }\n}\nll S(ll x,int y)//\u7b2c\u4e8c\u90e8\u5206\n{\n    if(prime[y]>=x)return 0;\n    ll k=x<=Sqr?ind1[x]:ind2[n/x];\n    ll ans=(g2[k]-g1[k]+MOD-(sp2[y]-sp1[y])+MOD)%MOD;\n    for(int i=y+1;i<=num&&prime[i]*prime[i]<=x;i++)\n    {\n        ll pe=prime[i];\n        for(int e=1;pe<=x;e++,pe=pe*prime[i])\n        {\n            ll xx=pe%MOD;\n            ans=(ans+xx*(xx-1)%MOD*(S(x/pe,i)+(e!=1)))%MOD;\n        }\n    }\n    return ans%MOD;\n}\nint main()\n{\n    scanf(\"%lld\",&n);\n    Sqr=sqrt(n);\n    pre(Sqr);\n    for(ll i=1;i<=n;)\n    {\n        ll j=n/(n/i);\n        w[++tot]=n/i;\n        g1[tot]=w[tot]%MOD;\n        g2[tot]=g1[tot]*(g1[tot]+1)/2%MOD*(2*g1[tot]+1)%MOD*inv3%MOD;\n        g2[tot]--;\n        g1[tot]=g1[tot]*(g1[tot]+1)/2%MOD-1;\n        if(n/i<=Sqr)ind1[n/i]=tot;\n        else ind2[n/(n/i)]=tot;\n        i=j+1;\n    }//g1,g2\u5206\u522b\u8868\u793a\u4e00\u6b21\u9879\u548c\u4e8c\u6b21\u9879\uff0cind1\u548cind2\u7528\u6765\u8bb0\u5f55\u8fd9\u4e2a\u6570\u5728\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e\n    for(int i=1;i<=num;i++)//\u7531\u4e8eg\u6570\u7ec4\u53ef\u4ee5\u6eda\u52a8\uff0c\u6240\u4ee5\u5c31\u53ea\u5f00\u4e86\u4e00\u7ef4\n    {\n        for(int j=1;j<=tot&&prime[i]*prime[i]<=w[j];j++)\n        {\n            ll k=w[j]/prime[i]<=Sqr?ind1[w[j]/prime[i]]:ind2[n/(w[j]/prime[i])];\n            g1[j]-=prime[i]*(g1[k]-sp1[i-1]+MOD)%MOD;\n            g2[j]-=prime[i]*prime[i]%MOD*(g2[k]-sp2[i-1]+MOD)%MOD;\n            g1[j]%=MOD,g2[j]%=MOD;\n            if(g1[j]<0)g1[j]+=MOD;\n            if(g2[j]<0)g2[j]+=MOD;\n        }\n    }\n    printf(\"%lld\\n\",(S(n,0)+1)%MOD);\n    return 0;\n}\n```",
        "postTime": 1556373216,
        "uid": 54214,
        "name": "wucstdio",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5325 \u3010\u3010\u6a21\u677f\u3011Min_25\u7b5b\u3011"
    },
    {
        "content": "\u4f5c\u4e3a min-25 \u7b5b\u7684\u6a21\u677f\u9898\uff0c\u672c\u9898\u53ef\u4ee5\u4f7f\u7528 min-25 \u7b5b / \u6d32\u9601\u7b5b \u7b49\u4e9a\u7ebf\u6027\u79ef\u6027\u51fd\u6570\u6c42\u548c\u7684\u65b9\u6cd5\u5728 $O\\left(\\frac{n^{\\frac{3}{4}}}{\\log n}\\right)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u89e3\u51b3\u3002\u4e0b\u9762\u63d0\u4f9b\u4e00\u79cd\u89e3\u51b3\u8fd9\u9053\u9898\u7684\u65b0\u7684\u601d\u8def\uff0c\u8fd9\u79cd\u7b97\u6cd5\u53c2\u8003\u81ea [zzq's blog](https://www.cnblogs.com/zzqsblog/p/9904271.html)\u3002\n\n### \u5b9a\u4e49\uff1aPowerful Number ###\n\n\u82e5\u6b63\u6574\u6570 $x$ \u6ee1\u8db3\u5b83\u6240\u6709\u8d28\u56e0\u5b50\u7684\u5e42\u6b21\u90fd $\\geq 2$\uff0c\u5219\u79f0 $x$ \u662f\u4e00\u4e2a $\\mathbf{Powerful\\;Number}$\u3002\n\n### \u6027\u8d28 ###\n\n$[1,n]$ \u95f4\u7684 $\\mathbf{Powerful\\;Number}$ \u6709 $O(\\sqrt n)$ \u4e2a\u3002\n\n> \u8bc1\u660e\uff1a\n> \u663e\u7136\u6240\u6709 $\\mathbf{Powerful\\;Number}$ \u90fd\u53ef\u4ee5\u8868\u793a\u6210 $a^2b^3$ \u7684\u5f62\u5f0f\u3002\u8003\u8651\u679a\u4e3e $a$ \uff0c\u5219 $n$ \u4ee5\u5185\u8fd9\u79cd\u6570\u7684\u6570\u91cf\u4e3a\n>$$\\begin{aligned}&O\\left(\\sum_{a=1}^{\\sqrt n}\\left(\\frac n{a^2}\\right)^{\\frac 1 3}\\right)\\\\&=O\\left(\\int_1^{\\sqrt n}\\left(\\frac n{x^2}\\right)^{\\frac 1 3}dx\\right)\\\\&=O(\\sqrt n)\\\\\\end{aligned}$$\n\n\u8fd9\u4e2a\u6027\u8d28\u4fdd\u8bc1\u4e86\u8be5\u7b97\u6cd5\u7684\u590d\u6742\u5ea6\u3002\n\n### \u672c\u9898\u601d\u8def ###\n\n\u8bbe $F(x)$ \u4e3a\u8981\u6c42\u7684\u79ef\u6027\u51fd\u6570\u3002\u5bf9\u4e8e\u8d28\u6570 $p$\uff0c\u6709 $F(p)=p(p-1)$\u3002\u8bbe\u6570\u8bba\u51fd\u6570 $G(x)=x\\varphi(x)$\uff0c\u663e\u7136 $G(x)$ \u662f\u79ef\u6027\u51fd\u6570\uff0c\u4e14\u6ee1\u8db3 $G(p)=F(p)$\u3002\u8bbe\u6570\u8bba\u51fd\u6570 $H(x)$ \u6ee1\u8db3 $F=G*H$\uff0c\u5176\u4e2d $*$ \u8868\u793a\u72c4\u5229\u514b\u96f7\u5377\u79ef\u3002\u5219\u6709\n\n$$\nF(p)=G(1)H(p)+G(p)H(1)\n$$\n\n\u56e0\u4e3a $F,G$ \u5747\u4e3a\u79ef\u6027\u51fd\u6570\uff0c\u6240\u4ee5 $H$ \u4e5f\u4e3a\u79ef\u6027\u51fd\u6570\u3002\u6240\u4ee5 $G(1)=H(1)=1$\uff0c\u53c8\u56e0\u4e3a $G(p)=F(p)$\uff0c\u53ef\u4ee5\u5f97\u51fa $H(p)=0$\u3002\u7531\u4e8e $H$ \u662f\u79ef\u6027\u51fd\u6570\uff0c\u6240\u4ee5\u4ec5\u5f53 $x$ \u662f $\\mathbf{Powerful\\;Number}$ \u65f6\uff0c$H(x)$ \u624d\u53ef\u80fd\u4e0d\u4e3a $0$\u3002\n\n\u8003\u8651\u7b54\u6848\u4e3a\n\n$$\n\\sum_{i=1}^{n}F(i)=\\sum_{ij\\leq n}G(i)H(j)=\\sum_{i=1}^{n}H(i)\\sum_{j=1}^{\\lfloor\\frac{n}{i}\\rfloor}G(j)\n$$\n\n$G$ \u672c\u8eab\u662f\u7b80\u5355\u7684\u79ef\u6027\u51fd\u6570\uff0c\u53ef\u4ee5\u4f7f\u7528\u675c\u6559\u7b5b\u5728 $O(n^{\\frac{2}{3}})$ \u7684\u65f6\u95f4\u5185\u7b5b\u51fa\u6240\u6709 $\\lfloor\\frac{n}{i}\\rfloor$ \u4f4d\u7f6e\u4e0a\u7684\u524d\u7f00\u548c\u3002\u63a5\u4e0b\u6765\u53ea\u9700\u8003\u8651 $i$ \u4e3a $\\mathbf{Powerful\\;Number}$ \u65f6\uff0c$H(i)$ \u5982\u4f55\u8ba1\u7b97\u3002\u56e0\u4e3a $H$ \u662f\u79ef\u6027\u51fd\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa $H(p^k)$\u3002\u7531\u72c4\u5229\u514b\u96f7\u5377\u79ef\uff0c\u6709\n\n$$\nF(p^k)=\\sum_{i=0}^{k}G(p^i)H(p^{k-i})\n$$\n\n\u6839\u636e\u6b27\u62c9\u51fd\u6570\u7684\u6709\u5173\u6027\u8d28\uff0c$G(p^k)=p^k\\varphi(p^k)=p^k(p-1)p^{k-1}=(p-1)p^{2k-1}$\u3002\u5c06 $F,G$ \u5c55\u5f00\uff0c\u5f97\n\n$$\np^k(p^k-1)=\\sum_{i=0}^{k}(p-1)p^{2i-1}H(p^{k-i})\n$$\n\n\u5f52\u7eb3\u53ef\u8bc1 $H(p^k)=(k-1)(p^{k+1}-p^k)$\u3002\n\n\u641c\u7d22 $[1,\\sqrt n]$ \u5185\u8d28\u6570\uff0c\u5e76\u4ece 2 \u5f00\u59cb\u679a\u4e3e\u5b83\u4eec\u7684\u5e42\u6b21\uff0c\u5373\u53ef\u5f97\u5230 $[1,n]$ \u5185\u7684\u6240\u6709 $\\mathbf{Powerful\\;Number}$\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u540c\u65f6\u5f97\u5230\u8fd9\u4e9b\u6570\u7684 $H$ \u51fd\u6570\u503c\u3002\u4e8b\u5b9e\u4e0a\uff0c\u5982\u679c $H(p^k)$ \u4e0d\u50cf\u672c\u9898\u4e00\u6837\u53ef\u4ee5\u5feb\u901f\u6c42\u51fa\uff0c\u7531\u4e8e $\\sqrt n$ \u4ee5\u5185\u7684\u8d28\u6570\u53ea\u6709 $O\\left(\\frac{\\sqrt n}{\\log n}\\right)$ \u4e2a\u4e14 $p$ \u7684\u5e42\u6b21\u662f $O(\\log n)$ \u7684\uff0c\u4e5f\u53ef\u4ee5\u66b4\u529b\u5730\u8ba1\u7b97\u51fa\u5b83\u4eec\u3002\n\n\u8fd9\u4e2a\u505a\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n^{\\frac{2}{3}})$ \u7684\uff0c\u5176\u74f6\u9888\u5728\u4e8e\u675c\u6559\u7b5b $G(x)$ \u7684\u524d\u7f00\u548c\u3002\u6e10\u8fdb\u610f\u4e49\u4e0a\u8fd9\u4e2a\u590d\u6742\u5ea6\u4f4e\u4e8e min-25 \u7b5b\u7684\u590d\u6742\u5ea6 $O\\left(\\frac{n^{\\frac{3}{4}}}{\\log n}\\right)$\uff0c\u4f46\u5728\u672c\u9898\u7684\u6570\u636e\u8303\u56f4\u4e0b\u8868\u73b0\u7a0d\u4e0d\u5982\u540e\u8005\u3002\u4f46\u662f\u8fd9\u4e2a\u7b97\u6cd5\u4e5f\u6709\u5b83\u7684\u4f18\u70b9\uff1a\u5b9e\u73b0\u7b80\u5355\uff1b\u5f53 $G$ \u7684\u524d\u7f00\u548c\u53ef\u4ee5\u5feb\u901f\u6c42\u51fa\u65f6\u590d\u6742\u5ea6\u53ef\u4ee5\u964d\u4f4e\u5230 $O(\\sqrt n)$ \uff0c\u6709\u660e\u663e\u4f18\u52bf\u3002\n\n### \u4ee3\u7801 ###\n\n```cpp\n#include <cstdio>\n#include <cmath>\n#include <cstring>\ntypedef long long ll;\nconst int MAXN=5500000;\nconst int MOD=1E9+7;\nconst int INV2=500000004, INV6=166666668;\nll n; int lim, cp, ans;\nint pri[MAXN], phi[MAXN];\nbool flag[MAXN];\nint g1[MAXN], g2[MAXN];\nvoid prework()\n{\n\tmemset(flag, 0, sizeof flag);\n\tphi[1]=1;\n\tfor (int i=2; i<=lim; i++)\n\t{\n\t\tif (!flag[i]) pri[++cp]=i, phi[i]=i-1;\n\t\tfor (int j=1; j<=cp&&i*pri[j]<=lim; j++)\n\t\t{\n\t\t\tflag[i*pri[j]]=1;\n\t\t\tif (i%pri[j]==0)\n\t\t\t{\n\t\t\t\tphi[i*pri[j]]=phi[i]*pri[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tphi[i*pri[j]]=phi[i]*(pri[j]-1);\n\t\t}\n\t}\n\tfor (int i=1; i<=lim; i++) g1[i]=(g1[i-1]+1ll*i*phi[i])%MOD;\n}\nint djs(ll m)\n{\n\tif (m<=lim) return g1[m];\n\tif (g2[n/m]) return g2[n/m];\n\tint res=(m%MOD)*((m+1)%MOD)%MOD*((2*m+1)%MOD)%MOD*INV6%MOD;\n\tfor (ll i=2, j; i<=m; i=j+1)\n\t{\n\t\tj=m/(m/i);\n\t\tres=(res-((i+j)%MOD)*((j-i+1)%MOD)%MOD*INV2%MOD*djs(m/i)%MOD+MOD)%MOD;\n\t}\n\treturn g2[n/m]=res;\n}\nvoid dfs(int k, ll m, int h)\n{\n\tif (k>cp||m*pri[k]>n)\n\t{\n\t\tif (n/m<=lim) ans=(ans+1ll*h*g1[n/m])%MOD;\n\t\telse ans=(ans+1ll*h*g2[n/(n/m)])%MOD;\n\t\treturn;\n\t}\n\tll p=1ll*pri[k]*pri[k];\n\tdfs(k+1, m, h);\n\tfor (int e=2; m*p<=n; p*=pri[k], e++)\n\t\tdfs(k+1, m*p, p%MOD*(pri[k]-1)%MOD*(e-1)%MOD*h%MOD);\n}\nint main()\n{\n//\tfreopen(\"P5325.in\", \"r\", stdin);\n//\tfreopen(\"P5325.out\", \"w\", stdout);\n\tscanf(\"%lld\", &n);\n\tlim=pow(n, 2.0/3);\n\tprework(); djs(n);\n\tdfs(1, 1, 1);\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1576245649,
        "uid": 43064,
        "name": "\u6500\u5ca9\u9ad8\u624b",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5325 \u3010\u3010\u6a21\u677f\u3011Min_25\u7b5b\u3011"
    },
    {
        "content": "[\u6b22\u8fce\u6765\u849f\u84bb\u7684\u535a\u5ba2\u56ed\u91cc\u770b](https://www.cnblogs.com/zkyJuruo/p/13445596.html)\n\n[\u6a21\u677f](https://www.luogu.com.cn/problem/P5325)\n\n## \u524d\u8a00\n\u597d\u4e0d\u5bb9\u6613 ~~\u5bf9\u7740\u9898\u89e3\u6284\u4f1a\u4e86~~ \u5b66\u4f1a\u4e86 $\\rm Min\\_25$ \u7b5b\u3002\u3002\u3002\u5b66\u4e86\u4e00\u5929\uff0c\u5e0c\u671b\u8fd9\u7bc7\u9898\u89e3\u80fd\u5e2e\u5230\u4f60\u3002\n\n\u5728\u672c\u6587\u4e2d\u7528 $p$ \u8868\u793a\u8d28\u6570\uff0c$P_i$ \u8868\u793a\u7b2c $i$ \u4e2a\u8d28\u6570\u3002\n\n## \u9898\u89e3\n\n### \u9884\u5904\u7406\n\u8bbe**\u5b8c\u5168**\u79ef\u6027\u51fd\u6570 $f'$ \u5728\u8d28\u6570\u5904\u53d6\u503c\u4e0e $f$ \u76f8\u540c\n\n\u8bbe\u4e00\u4e2a\u51fd\u6570 $g$\uff0c\u6ee1\u8db3 $g(n,j)=\\sum\\limits_{i=1}^n f'(i)(i \\in prime | \\min\\limits_{p|i} p > P_j)$\u3002\n\n\u8003\u8651 $g(n, j) - g(n, j-1)$\u3002\n\n\u5f53 $P_j^2 > n$ \u65f6, $g(n, j)$ \u663e\u7136\u6ca1\u6709\u591a\u4f59\u8d21\u732e\uff0c$g(n, j) = g(n, j-1)$\u3002\n\n\u5426\u5219\u5728 $g(n, j)$ \u4e2d\u6709\u591a\u4f59\u8d21\u732e\u7684\u6570\uff0c \u4e00\u5b9a\u6709\u8d28\u56e0\u5b50 $P_j$\u3002\u53ef\u4ee5\u5148\u628a\u8fd9\u4e9b\u6570\u90fd\u9664\u4ee5 $P_j$ \u3002\u8fd9\u4e9b\u6570\u7684\u6240\u6709\u8d28\u56e0\u5b50\u90fd\u5927\u4e8e\u7b49\u4e8e $P_j$\uff0c\u56e0\u6b64\u662f $g(\\frac{n}{P_j})$\u3002\u8fd9\u6837\u4f1a\u591a\u7b97\u5c0f\u4e8e $P_j$ \u7684\u8d28\u6570, \u56e0\u6b64\u8fd8\u8981\u51cf\u53bb $\\sum\\limits_{i=1}^{j-1}f'(P_i)$\u3002\n\n\u56e0\u6b64\u5f97\u51fa\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b:\n\n$$g(n, j)=\\begin{cases}g(n, j-1) (P_j^2 > n)\\\\g(n, j-1) - f'(P_j)(g(\\frac{n}{P_j}, j-1) - \\sum\\limits_{i=1}^{j-1}f'(P_i))(P_j^2 \\le n)\\end{cases}$$\n\n### \u6c42\u503c\n\u8bbe\u51fd\u6570 $S$\uff0c$S(n, j) = \\sum\\limits_{i=1}^n f(i) (\\min\\limits_{p|i} p > P_j)$\u3002\n\n\u5206\u6210\u8d28\u6570\u548c\u5408\u6570\u6765\u8ba8\u8bba\u3002\n\n\u8003\u8651\u5230 $f'$ \u548c $f$ \u5728\u8d28\u6570\u5904\u53d6\u503c\u76f8\u540c\uff0c\u6240\u4ee5\u5728\u8d28\u6570\u65f6\u7b54\u6848\u4e3a $g(n, |P|)$ \u3002\u8fd9\u6837\u591a\u7b97\u4e86\u524d $j$ \u4e2a\u8d28\u6570\uff0c\u51cf\u53bb $\\sum\\limits_{i = 1}^{j} f'(P_i)$\u3002\n\n\u5728\u5408\u6570\u5904\u7b54\u6848\u8003\u8651\u679a\u4e3e\u6bcf\u4e00\u4e2a\u6570\u7684\u6700\u5c0f\u8d28\u56e0\u6570\u53ca\u4ed6\u7684\u6b21\u6570\uff0c\u7b54\u6848\u4e3a $\\sum\\limits_{k>j} \\sum\\limits_{e=1}^{P_k^e \\le n} f(P_k^e)[S(\\frac{n}{P_k^e}, k) + (e>1)]$\u3002\n\n\u540e\u9762\u7684 $e>1$ \u8868\u793a\u5982\u679c $k$ \u6b21\u6570\u4e0d\u4e3a $1$ \u90a3\u4e48\u5c31\u8fd8\u8981\u518d\u589e\u52a0\u4e00\u4e2a $f(P_k^e)$\uff0c\u56e0\u4e3a $S$ \u662f\u4e0d\u7b97\u4e0a\u4e3a $1$ \u7684\u6570\u3002\u800c\u8d28\u6570\u7684 $1$ \u6b21\u65b9\u5df2\u7ecf\u5728\u524d\u9762\u679a\u4e3e\u8d28\u6570\u7684\u5730\u65b9\u7b97\u8fc7\u4e86\u3002\n\n\u56e0\u6b64 \n$$S(n, j) = g(n, |P|) - \\sum\\limits_{i = 1}^{j} f'(P_i) + \\sum\\limits_{k>j} \\sum\\limits_{e=1}^{P_k^e \\le n} f(P_k^e)[S(\\frac{n}{P_k^e}, k) + (e>1)]$$\n\u6700\u7ec8\u6c42\u7684\u7b54\u6848\u662f $S(n, 0) + f(1)$\uff0c\u8fd8\u8981\u52a0\u4e0a $f(1)$ \u56e0\u4e3a $S$ \u51fd\u6570\u4e0d\u4f1a\u8ba1\u7b97\u5230$1$\u3002\n\n### \u7ec6\u8282\n\u5728\u6c42 $g$ \u7684\u65f6\u5019\u9700\u8981\u4f18\u5316\u3002$g$ \u9700\u8981\u7684\u5730\u65b9\u90fd\u662f $g(\\frac{n}{k}, ...)$ \u7684\u5f62\u5f0f\uff0c\u4f17\u6240\u5468\u77e5 $\\frac{n}{k}$ \u7684\u53d6\u503c\u53ea\u6709$2\\sqrt{n}$\u79cd\u60c5\u51b5\uff0c\u8ba9 $id1_k$ \u8bb0\u5f55 $k\\le\\sqrt n$\uff0c$id2_k$ \u8bb0\u5f55 $\\frac{n}{k} \\le \\sqrt n$\uff0c\u6240\u4ee5\u53ef\u4ee5\u53ea\u679a\u4e3e\u8fd9 $2\\sqrt n$ \u79cd\u60c5\u51b5\u3002\n\n\u5728\u5904\u7406\u8d28\u6570\u5904\u7684\u5b8c\u5168\u79ef\u6027\u51fd\u6570\u65f6\uff0c$p^k(p^k-1)$ \u53ef\u4ee5\u7528 $p^{2k}$ \u51cf $p^k$ \u8868\u793a\u3002\n\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\n#define L(i, j, k) for(int i = j, i##E = k; i <= i##E; i++)\n#define R(i, j, k) for(int i = j, i##E = k; i >= i##E; i--)\n#define ll long long\n#define ull unsigned long long\n#define db double\n#define pii pair<int, int>\n#define mkp make_pair\n#define ll long long\nusing namespace std;\nconst int N = 2e5 + 7;\nconst int mod = 1e9 + 7;\nbool Prime[N];\nint tot;\nll p[N], n, sq, w[N], m, sum1[N], sum2[N], g1[N], g2[N], id1[N], id2[N];\n// id1 id2 \u5982\u6587\u4e2d\u6240\u793a w[k] \u4e3a\u7b2c k \u4e2a\u9700\u8981\u5904\u7406\u7684\u6570 \n// \u6587\u4e2d\u7684 g \u4e3a g2 - g1, g1 : f'(k) = k, g2: f'(k) = k ^ 2\n// sum1 : \u8d28\u6570\u524d\u7f00\u548c ; sum2: \u8d28\u6570\u5e73\u65b9\u524d\u7f00\u548c\nvoid xxs() { // \u7ebf\u6027\u7b5b\n\tL(i, 2, sq)  {\n\t\tif(!Prime[i]) ++tot, p[tot] = i;\n\t\tfor(int j = 1; p[j] * i <= sq && j <= tot; j++) {\n\t\t\tPrime[p[j] * i] = 1;\n\t\t\tif(i % p[j] == 0) break;\n\t\t}\n\t}\n\tL(i, 1, tot) {\n\t\tsum1[i] = (sum1[i - 1] + p[i]) % mod;\n\t\tsum2[i] = (sum2[i - 1] + p[i] * p[i] % mod) % mod;\n\t}\n}\nll getid(ll x) {\n\tif(x <= sq) return id1[x];\n\telse return id2[n / x];\n}\nll f1(ll x) { // 1 ~ x \u524d\u7f00\u548c\n\tx %= mod;\n\treturn x * (x + 1) / 2 % mod;\n}\nll f2(ll x) { // 1 ~ x \u524d\u7f00\u5e73\u65b9\u548c\n\tx %= mod;\n\treturn x * (x + 1) % mod * (2 * x % mod + 1) % mod * 166666668 % mod;\n}\nll S(ll x, int j) {\n\tif(p[j] > x) return 0;\n\tll Ans = ((g2[getid(x)] - g1[getid(x)] + mod) % mod - (sum2[j] - sum1[j] + mod) % mod + mod) % mod;\n\tfor(int i = j + 1; i <= tot && p[i] * p[i] <= x; i ++) \n\t\tfor(ll e = 1, sp = p[i]; sp <= x; sp *= p[i], e ++) \n\t\t\tAns = (Ans + sp % mod * (sp % mod - 1) % mod * (S(x / sp, i) + (e > 1)) % mod) % mod;\n\treturn Ans;\n}\nint main() {\n\tscanf(\"%lld\", &n), sq = sqrt(n), xxs();\n\tfor(ll l = 1, r; l <= n; l = r + 1) {\n\t\tr = (n / (n / l)), w[++m] = n / l;\n\t\tg1[m] = f1(w[m]) - 1, g2[m] = f2(w[m]) - 1; // \u5904\u7406 g(?, 0)\n\t\tif(w[m] <= sq) id1[w[m]] = m;\n\t\telse id2[n / w[m]] = m;\n\t}\n\tL(i, 1, tot) { // dp \u5904\u7406 g \u51fd\u6570\n\t\tfor(int j = 1; j <= m && p[i] * p[i] <= w[j]; j++) {\n\t\t\tg1[j] = (g1[j] - p[i] * (g1[getid(w[j] / p[i])] - sum1[i - 1]) % mod + mod) % mod;\n\t\t\tg2[j] = (g2[j] - p[i] * p[i] % mod * (g2[getid(w[j] / p[i])] - sum2[i - 1]) % mod + mod) % mod;\n\t\t}\n\t}\n\tprintf(\"%lld\\n\", (S(n, 0) + 1) % mod);\n\treturn 0;\n}\n```",
        "postTime": 1596689338,
        "uid": 173660,
        "name": "zhoukangyang",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5325 \u3010\u3010\u6a21\u677f\u3011Min_25\u7b5b\u3011"
    },
    {
        "content": "# Min25\u7b5b\n\n\n\n---\n\n[yyb\u535a\u5ba2](https://www.cnblogs.com/cjyyb/p/9185093.html)\n\n\u8981\u6c42\uff1a$\\sum_{i=1}^nF(x)$\n\n$F(x)$\u662f\u79ef\u6027\u51fd\u6570\u3002\n\n$Min25$\u7b5b\u80fd\u7528\u7684\u524d\u63d0\uff1a\u8d28\u6570\u5904\u7684$f(p)$\u503c\u662f\u5173\u4e8e$p$\u7684\u591a\u9879\u5f0f\uff0c\u8d28\u6570\u6b21\u65b9\u5904\u7684$f(p^e)$\u503c \u53ef\u4ee5\u5feb\u901f\u8ba1\u7b97\u3002\n\n## \u9884\u5904\u7406\n\n\u8bbe\u5b8c\u5168\u79ef\u6027\u51fd\u6570$F'(x)$\uff0c\u5728\u8d28\u6570\u5904\u53d6\u503c$F(p)=F'(p)$\u3002\n\n\u9884\u5904\u7406\u4e00\u4e2a$g$\u51fd\u6570\u3002$g(n,j)=\\sum_{i=1}^nF'(i)[i\\in\\mathbb{P}\\text{ or }\\min_{p|i}p>P_j]$\n\n\u4e5f\u5c31\u662f$i$\u662f\u8d28\u6570\u6216\u8005$i$\u6700\u5c0f\u503c\u56e0\u5b50$>P_j$\u7684\u8d21\u732e\uff08\u6ce8\u610f\u6c42\u7684\u662f$F'$\uff09\n\n\u8f6c\u79fb\uff1a\n\n$g(n,j)=\\begin{cases}g(n,j-1) (P_j^2>n)\\\\g(n,j-1)-F'(P_j)[g(\\frac{n}{P_j},j-1)-g(P_{j-1},j-1)](P_j\\leq n)\\end{cases}$\n\n\u8003\u8651$g(n,j-1)-g(n,j)$\u3002\u5982\u679c$P_j^2>n$\u663e\u7136\u6ca1\u6709\u591a\u4f59\u8d21\u732e\u3002\n\n\u5426\u5219\u4f1a\u591a\u4f59\u7684\u4e00\u5b9a\u662f$P_j$\u7684\u500d\u6570\uff0c\u90a3\u4e48\u56e0\u4e3a$F'$\u662f\u5b8c\u5168\u79ef\u6027\u51fd\u6570\uff0c\u53ef\u4ee5\u5c06\u591a\u4f59\u7684\u6570\u5168\u90e8\u9664\u4ee5$P_j$\uff0c\u5e76\u4e58\u4e0a\u8d21\u732e$F'(P_j)$\u3002\u90a3\u4e48\u51cf\u6389\u7684\u662f$F'(P_j)$\u4e58\u3010$\\frac{n}{P_j}$\u4ee5\u5185\u6700\u5c0f\u8d28\u56e0\u6570$\\geq P_j$\u7684\u6570\u7684\u8d21\u732e\u548c\u3011\u3002\u8fd9\u4e2a\u503c\u5c31\u662f$g(\\frac{n}{P_j},j-1)-g(P_{j-1},j-1)$\u3002\u524d\u9762\u591a\u7b97\u4e86$<P_j$\u7684\u8d28\u6570\uff0c\u540e\u9762\u51cf\u6389\u4e86\u8fd9\u4e00\u90e8\u5206\u3002\n\n\u53ef\u4ee5\u770b\u51fa\u53ea\u6709$\\sqrt n$\u5185\u7684\u8d28\u6570\u6709\u7528\uff0c\u7ebf\u6027\u7b5b\u5230$\\sqrt n$\u5c31\u884c\u4e86\u3002\n\n\u540e\u9762\u7684$g(P_{j-1},j-1)$\u6309\u7167\u5b9a\u4e49\u7b49\u4e8e$\\sum_{i=1}^{P_{j-1}}F'(i)$\u3002\u7ebf\u6027\u7b5b\u65f6\u9884\u5904\u7406\u4e00\u4e0b\u5c31\u884c\u4e86\u3002\n\n\u8fd9\u4e2a$g$\u540e\u9762\u53ea\u7528\u4e86\u8d28\u6570\u5904\u7684$F'$\uff0c\u6240\u4ee5\u662f\u5bf9\u7684~~\u800c\u4e14\u5f88\u5999~~\n\n## \u6c42\u503c\n\n\u8bbe$S(n,j)=\\sum_{i=1}^nF(i)[\\min_{p|i}p>P_j]$\uff0c\u5373\u6700\u5c0f\u8d28\u56e0\u6570\u5927\u4e8e$P_j$\u7684\u6240\u6709\u6570\u7684$F$\u548c\uff0c\u90a3\u4e48\u8981\u6c42\u7684\u7b54\u6848\u662f$S(n,0)$\u3002\n\n$S$\u7684\u9012\u63a8\u5f0f\u4e3a\uff1a$S(n,j)=g(n,|P|)-\\sum_{i=1}^{j-1}f(P_i)+\\sum_{p_k^e\\leq n,k>j}F(p_k^e)(S(\\frac{n}{p_k^e},k)+[e>1])$\n\n\u524d\u9762\u90e8\u5206\u662f\u8d28\u6570\u7684\u8d21\u732e\uff0c\u540e\u9762\u662f\u5408\u6570\u7684\n\n\u540e\u9762\u7684$\\sum$\u610f\u601d\u5c31\u662f\u679a\u4e3e\u5408\u6570\u6700\u5c0f\u7684\u8d28\u56e0\u5b50\u53ca\u6b21\u6570\uff0c\u56e0\u4e3a\u662f\u79ef\u6027\u51fd\u6570\u53ef\u4ee5\u76f4\u63a5\u4e58\u8d77\u6765\u3002$[e>1]$\u610f\u601d\u662f\u5982\u679c$e>1$\u90a3\u4e48\u6709\u4e00\u4e2a$p_k^e$\u6ca1\u7b97\u8fdb\u7b54\u6848\uff08$S$\u4e0d\u8ba1\u7b97$1$\u7684\u8d21\u732e\uff0c\u4f46$e=1$\u65f6$p_k^e$\u5c31\u662f\u8d28\u6570\u5df2\u7ecf\u5728\u524d\u9762\u7b97\u8fc7\u4e86\uff09\uff0c\u8981\u7b97\u8fdb\u7b54\u6848\u3002\n\n## \u4ee3\u7801\n\n\u4e00\u4e9b\u7ec6\u8282\uff1a\n\n- $n$\u4e00\u76f4\u6574\u9664\u4e00\u4e2a\u6570\u4e4b\u540e\u8fd8\u662f$n$\u6574\u9664\u4e00\u4e2a\u6570\uff0c\u4e5f\u5c31\u662f\u53ea\u9700\u8981\u7528\u5230\u6240\u6709$\\frac ni$\u3002\u5f00\u4e24\u4e2a\u6570\u7ec4$a1,a2$\uff0c\u5bf9\u4e8e$\\sqrt n$\u7684\u5411$a1$\u5b58\uff0c\u4e0b\u6807\u4e3a$\\frac ni$\uff0c\u5426\u5219\u5411$a2$\u5b58\uff0c\u4e0b\u6807\u4e3a$i$\u3002\u4e24\u4e2a\u6570\u7ec4\u90fd\u662f$\\sqrt n$\u7684\u3002\n- \u7531\u4e8e$S$\u6ca1\u6709\u7b97$1$\uff0c\u6700\u540e\u8fd8\u8981\u52a0\u4e0a$1$\u7684\u8d21\u732e\u3002\n\n```\n#include<bits/stdc++.h>\n#define il inline\n#define vd void\n#define mod 1000000007\ntypedef long long ll;\nil ll gi(){\n    ll x=0,f=1;\n    char ch=getchar();\n    while(!isdigit(ch))f^=ch=='-',ch=getchar();\n    while(isdigit(ch))x=x*10+ch-'0',ch=getchar();\n    return f?x:-x;\n}\nll n;\nint qt;\nint pr[100010],yes[100010],cnt,gp1[100010],gp2[100010];\nll w[200010],sw;\nint g1[200010],g2[200010];\nint id1[100010],id2[100010];\nil int S(ll x,int y){\n    if(pr[y]>=x)return 0;\n    int p=x<=qt?id1[x]:id2[n/x];\n    int ret=((0ll+g2[p]-g1[p]-(gp2[y]-gp1[y]))%mod+mod)%mod;\n    for(int i=y+1;i<=cnt&&1ll*pr[i]*pr[i]<=x;++i){\n        ll pe=pr[i];\n        for(int e=1;pe<=x;++e,pe*=pr[i]){\n            int o=pe%mod;\n            ret=(ret+1ll*o*(o-1)%mod*(S(x/pe,i)+(e!=1)))%mod;\n        }\n    }\n    return ret;\n}\nint mian(){\n    n=gi();qt=sqrt(n);\n    yes[1]=1;\n    for(int i=2;i<=qt;++i){\n        if(!yes[i])pr[++cnt]=i;\n        for(int j=1;j<=cnt&&i*pr[j]<=qt;++j){\n            yes[i*pr[j]]=1;\n            if(i%pr[j]==0)break;\n        }\n    }\n    for(int i=1;i<=cnt;++i)gp1[i]=(gp1[i-1]+pr[i])%mod,gp2[i]=(gp2[i-1]+1ll*pr[i]*pr[i])%mod;//\u9012\u63a8\u65f6\u7528\u7684\u8d28\u6570\u5904F\u524d\u7f00\u548c\n    for(ll l=1,r;l<=n;l=r+1){//\u9884\u5904\u7406(n/i) & \u8ba1\u7b97g\u7684j=0\u8fb9\u754c\uff0c\u8fb9\u754c\u5c31\u662fF'\u7684\u524d\u7f00\u548c\uff0c\u7531\u4e8e\u8d28\u6570\u5904F(p)\u662f\u591a\u9879\u5f0f\u6240\u4ee5\u53ef\u4ee5\u5feb\u901f\u7b97\n        r=n/(n/l);w[++sw]=n/r;\n        g1[sw]=w[sw]%mod;\n        g2[sw]=(1ll*g1[sw]*(g1[sw]+1)%mod*(g1[sw]*2+1)%mod*166666668%mod-1)%mod;//1..w[sw]\u5e73\u65b9\u548c\n        g1[sw]=(1ll*g1[sw]*(g1[sw]+1)%mod*500000004-1)%mod;//1..w[sw]\u7b49\u5dee\u6570\u5217\u548c\n        if(n/r<=qt)id1[n/r]=sw;else id2[r]=sw;\n    }\n    //j\u4ece1\u5230|P|\u9012\u63a8g\n    for(int i=1;i<=cnt;++i){\n        ll sqr_pi=1ll*pr[i]*pr[i];\n        for(int j=1;j<=sw&&sqr_pi<=w[j];++j){\n            ll p=w[j]/pr[i];\n            p=(p<=qt?id1[p]:id2[n/p]);//\u5b9a\u4f4dp\u7684\u5750\u6807\n            g1[j]=(g1[j]-1ll*pr[i]*(g1[p]-gp1[i-1]+mod)%mod+mod)%mod;\n            g2[j]=(g2[j]-1ll*pr[i]*pr[i]%mod*(g2[p]-gp2[i-1]+mod)%mod+mod)%mod;\n        }\n    }\n    printf(\"%d\\n\",(S(n,0)+1)%mod);\n    return 0;//}\n```",
        "postTime": 1561465047,
        "uid": 23118,
        "name": "\u03bb\u1d09\u028d",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5325 \u3010\u3010\u6a21\u677f\u3011Min_25\u7b5b\u3011"
    },
    {
        "content": "\u8fd9\u7bc7\u9898\u89e3\u662f\u4ece $\\text{DGF}$ \u7684\u89d2\u5ea6\u63a8\u5f0f\u5b50\u3002\n\n\u5173\u4e8e $\\text{DGF}$ \u7684\u524d\u7f6e\u77e5\u8bc6\u53ef\u4ee5\u770b\u6211\u7684[\u535a\u5ba2](https://www.luogu.com.cn/blog/gxy001/di-li-ke-lei-sheng-cheng-han-shuo-qian-tan)\n\n\u6211\u4eec\u5148\u5c1d\u8bd5\u628a\u8fd9\u4e2a\u4e1c\u897f\u7684 $\\text{DGF}$ \u7528 $\\zeta$ \u8868\u793a\u3002\n$$\n\\begin{aligned}\n &\\prod\\limits_{p\\in\\mathrm{Prime}}\\left(1+\\sum\\limits_{i=1}^\\infin\\frac{p^i(p^i-1)}{p^{ix}}\\right)\\\\\n=&\\prod\\limits_{p\\in\\mathrm{Prime}}\\left(1+\\sum\\limits_{i=1}^\\infin\\frac{p^{2i}}{p^{ix}}-\\sum\\limits_{i=1}^\\infin\\frac{p^i}{p^{ix}}\\right)\\\\\n=&\\prod\\limits_{p\\in\\mathrm{Prime}}\\left(1+\\sum\\limits_{i=1}^\\infin p^{i(2-x)}-\\sum\\limits_{i=1}^\\infin p^{i(1-x)}\\right)\\\\\n=&\\prod\\limits_{p\\in\\mathrm{Prime}}\\left(1+\\frac{p^{2-x}}{1-p^{2-x}}-\\frac{p^{1-x}}{1-p^{1-x}}\\right)\\\\\n=&\\prod\\limits_{p\\in\\mathrm{Prime}}\\frac{(1-p^{2-x})(1-p^{1-x})+p^{2-x}(1-p^{1-x})-p^{1-x}(1-p^{2-x})}{(1-p^{2-x})(1-p^{1-x})}\\\\\n=&\\prod\\limits_{p\\in\\mathrm{Prime}}\\frac{1-p^{1-x}-p^{2-x}+p^{3-2x}+p^{2-x}-p^{3-2x}-p^{1-x}+p^{3-2x}}{1-p^{1-x}-p^{2-x}+p^{3-2x}}\\\\\n=&\\prod\\limits_{p\\in\\mathrm{Prime}}\\frac{1-2p^{1-x}+p^{3-2x}}{1-p^{1-x}-p^{2-x}+p^{3-2x}}\\\\\n=&\\zeta(x-1)\\zeta(x-2)\\prod\\limits_{p\\in\\mathrm{Prime}}(1-2p^{1-x}+p^{3-2x})\\\\\n\\end{aligned}\n$$\n\u6211\u4eec\u53d1\u73b0\u540e\u9762\u90a3\u4e2a\u4e1c\u897f\u4f3c\u4e4e\u4e0d\u80fd\u5f88\u597d\u7684\u7528 $\\zeta$ \u8868\u793a\uff0c\u8003\u8651\u6362\u4e2a\u65b9\u5411\u63a8\u3002\n\n\u5982\u679c\u6709\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\u7684 $\\text{DGF}$ \u4e3a $\\prod\\limits_{p\\in\\mathrm{Prime}}(1+\\sum\\limits_{i=2}^\\infin\\frac{f(p^i)}{p^{ix}})$\uff0c\u90a3\u4e48\u6211\u4eec\u662f\u53ef\u4ee5\u5728 $\\mathrm O(\\sqrt n)$ \u5185\u6c42\u51fa\u5b83\u7684\u524d\u7f00\u548c\u7684\uff0c\u56e0\u4e3a $[1,n]$ \u4e4b\u95f4\u7684 $\\text{Powerful Number}$\uff08\u6240\u6709\u8d28\u56e0\u5b50\u6b21\u6570\u90fd\u5927\u4e8e $1$ \u7684\u6570\uff09\u53ea\u6709 $\\mathrm O(\\sqrt n)$ \u4e2a\u3002\n\n\u8bc1\u660e\uff1a\u663e\u7136\u6240\u6709 $\\text{Powerful Number}$ \u90fd\u53ef\u4ee5\u8868\u793a\u6210 $a^2b^3$ \u7684\u5f62\u5f0f\u3002\n$$\n\\begin{aligned}\n&\\mathrm O\\left(\\sum_{a=1}^{\\sqrt n}\\left(\\frac{n}{a^2}\\right)^{\\frac{1}{3}}\\right)\\\\\n=&\\mathrm O\\left(\\int_{1}^{\\sqrt n}\\left(\\frac{n}{x^2}\\right)^{\\frac{1}{3}}dx\\right)\\\\\n=&\\mathrm O(\\sqrt n)\\\\\n\\end{aligned}\n$$\n\u6211\u4eec\u73b0\u5728\u60f3\u8981\u628a\u540e\u9762\u90a3\u4e2a\u4e1c\u897f\u63a8\u6210 $\\prod\\limits_{p\\in\\mathrm{Prime}}(1+\\sum\\limits_{i=2}^\\infin\\frac{f(p^i)}{p^{ix}})$ \u7684\u5f62\u5f0f\u3002\n$$\n\\begin{aligned}\n&\\zeta(x-1)\\zeta(x-2)\\prod\\limits_{p\\in\\mathrm{Prime}}(1-2p^{1-x}+p^{3-2x})\\\\\n=&\\zeta(x-1)\\zeta(x-2)\\prod_{p\\in\\mathrm{Prime}}(1-2p^{1-x}+p^{2(1-x)+1})\\\\\n=&\\zeta(x-1)\\zeta(x-2)\\prod_{p\\in\\mathrm{Prime}}((1-p^{1-x})^2+p^{2(1-x)+1}-p^{2(1-x)})\\\\\n=&\\frac{\\zeta(x-2)}{\\zeta(x-1)}\\prod_{p\\in\\mathrm{Prime}}\\frac{(1-p^{1-x})^2+p^{2(1-x)+1}-p^{2(1-x)}}{(1-p^{1-x})^2}\\\\\n=&\\frac{\\zeta(x-2)}{\\zeta(x-1)}\\prod_{p\\in\\mathrm{Prime}}(1+\\frac{p^{2(1-x)+1}}{(1-p^{1-x})^2}-\\frac{p^{2(1-x)}}{(1-p^{1-x})^2})\\\\\n=&\\frac{\\zeta(x-2)}{\\zeta(x-1)}\\prod_{p\\in\\mathrm{Prime}}(1+\\sum_{i=2}^\\infin (i-1)p^{i(1-x)+1}-\\sum_{i=2}^\\infin (i-1)p^{i(1-x)})\\\\\n=&\\frac{\\zeta(x-2)}{\\zeta(x-1)}\\prod_{p\\in\\mathrm{Prime}}(1+\\sum_{i=2}^\\infin\\frac{ip^{i+1}-p^{i+1}-ip^{i}+p^i}{p^{ix}})\\\\\n\\end{aligned}\n$$\n\n\u8bbe\u8981\u6c42\u7684\u51fd\u6570\u4e3a $f$\uff0c$\\frac{\\zeta(x-2)}{\\zeta(x-1)}$ \u5bf9\u5e94\u7684\u51fd\u6570\u4e3a $g$\uff0c$\\prod\\limits_{p\\in\\mathrm{Prime}}(1+\\sum_{i=2}^\\infin\\frac{ip^{i+1}-p^{i+1}-ip^{i}+p^i}{p^{ix}})$ \u5bf9\u5e94\u7684\u51fd\u6570\u4e3a $h$\u3002\n\n\u5219\u6709 $f=g*h$\uff0c$g$ \u53ef\u4ee5\u76f4\u63a5\u675c\u6559\u7b5b\uff0c\u81f3\u4e8e\u675c\u6559\u7b5b\u7684\u6784\u9020\uff0c\u663e\u7136\u6709 $g*id_1=id_2$\uff0c$h$ \u663e\u7136\u53ea\u5728 $\\text{Powerful Number}$ \u5904\u6709\u503c\uff0c\u76f4\u63a5\u7206\u641c\u6240\u6709\u5c0f\u4e8e $\\sqrt n$ \u7684\u8d28\u6570\u5373\u53ef\uff0c\u7b97\u5230\u6bcf\u4e00\u4e2a $\\text{Powerful Number}$ \u5904\u7edf\u8ba1 $h(x)(\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{x}\\rfloor} g(i))$ \u5373\u53ef\u6c42\u51fa $\\sum\\limits_{i=1}^n f(i)$\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<cmath>\nint const mod=1000000007,inv6=1000000008/6,inv2=1000000008/2;\nint np[4641600],lim,cnt,p[464160],g[4641600],g2[4641600];\nlong long n;\nint getsum(long long x){\n\tif(x<=lim) return g[x];\n\tif(g2[n/x]) return g2[n/x];\n\tint ans=x%mod*((x+1)%mod)%mod*((2*x+1)%mod)%mod*inv6%mod;\n\tfor(long long l=2,r,d;l<=x;l=r+1){\n\t\tr=x/(x/l);\n\t\tans=(ans-(l+r)%mod*(r-l+1)%mod*inv2%mod*getsum(x/l)%mod+mod)%mod;\n\t}\n\treturn g2[n/x]=ans;\n}\nint ans;\nvoid dfs(int k,long long m,int h){\n\tif(k>cnt||m*p[k]>n||m*p[k]*p[k]>n){\n\t\tlong long const &p=n/m;\n\t\tif(p<=lim)ans=(ans+1ll*h*g[p])%mod;\n\t\telse ans=(ans+1ll*h*g2[n/p])%mod;\n\t\treturn;\n\t}\n\tlong long p=1ll*::p[k]*::p[k];\n\tdfs(k+1,m,h);\n\tfor(int e=2;m*p<=n;p*=::p[k],++e)dfs(k+1,m*p,p%mod*(::p[k]-1)%mod*(e-1)%mod*h%mod);\n}\nint main(){\n\tscanf(\"%lld\",&n);\n\tlim=pow(n,2.0/3.0);if(!lim)++lim;\n\tg[1]=1;\n\tfor(int i=2;i<=lim;i++){\n\t\tif(!np[i])p[++cnt]=i,g[i]=i-1;\n\t\tfor(int j=1,tmp;j<=cnt&&(tmp=i*p[j])<=lim;j++){\n\t\t\tnp[tmp]=1;\n\t\t\tif(i%p[j]==0){\n\t\t\t\tg[tmp]=g[i]*p[j];\n\t\t\t\tbreak;\n\t\t\t}else g[tmp]=g[i]*g[p[j]];\n\t\t}\n\t}\n\tfor(int i=1;i<=lim;i++)g[i]=(g[i-1]+1ll*i*g[i])%mod;\n\tgetsum(n);\n\tdfs(1,1,1);\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n} \n```",
        "postTime": 1611731763,
        "uid": 55707,
        "name": "gxy001",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5325 \u3010\u6a21\u677f\u3011Min_25\u7b5b"
    },
    {
        "content": "# \u524d\u8a00\n\u7531\u4e8e\u5176\u7531 Min_25 \u53d1\u660e\u5e76\u6700\u65e9\u5f00\u59cb\u4f7f\u7528\uff0c\u6545\u79f0\u300cMin_25 \u7b5b\u300d\u3002\n   * \u4ece\u6b64\u79cd\u7b5b\u6cd5\u7684\u601d\u60f3\u65b9\u6cd5\u6765\u8bf4\uff0c\u5176\u53c8\u88ab\u79f0\u4e3a\u300cExtended Eratosthenes Sieve\u300d\u3002\n\n\u5176\u53ef\u4ee5\u5728 $O(\\frac{n^{\\frac{3}{4}}}{logn})$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e0b\u89e3\u51b3\u4e00\u7c7b **\u79ef\u6027\u51fd\u6570** \u7684\u524d\u7f00\u548c\u95ee\u9898\u3002\n\n\u8981\u6c42\uff1a $f(p)$ \u662f\u4e00\u4e2a\u5173\u4e8e $p$ \u7684\u9879\u6570\u8f83\u5c11\u7684\u591a\u9879\u5f0f\u6216\u53ef\u4ee5\u5feb\u901f\u6c42\u503c\uff1b $f(p^{c})$ \u53ef\u4ee5\u5feb\u901f\u6c42\u503c\u3002\n\n\u6458\u81ea [OI wiki](https://oi-wiki.org/math/min-25/)\n# \u89e3\u6790\n## [\u4f8b\u9898](https://www.luogu.com.cn/problem/P5325)\n\u79ef\u6027\u51fd\u6570 $f(p^k) = p^k(p^k - 1)$\n\u6c42\uff1a$\\sum_{i = 1} ^ n f(i)$\n### \u51c6\u5907 $1$\n\u89c4\u5b9a $p$ \u4ee3\u8868\u8d28\u6570, $minp(i)$ \u4ee3\u8868 $i$ \u7684\u6700\u5c0f\u8d28\u56e0\u5b50\uff08\u5176\u4e2d $minp(p) = p$\uff09\uff0c\u5219\uff1a\n\n$\\sum_{i = 1} ^ n f(i) = \\sum_{p \\leq n} f(p) + \\sum_{i \\leq n \\ and \\ i \\notin p} f(i)$\n\n\u8fd9\u4e00\u6b65\u8868\u793a\u5c06\u7b54\u6848\u62c6\u6210\u8d28\u6570\u7684\u7b54\u6848\u548c\u5408\u6570\u7684\u7b54\u6848\u3002\n\u90a3\u4e48\u5bf9\u4e8e\u5408\u6570\u90e8\u5206\uff1a\n\n\u6839\u636e\u79ef\u6027\u51fd\u6570\u7684\u6027\u8d28\uff0c\u5219\u6709\uff1a\n\n$f(i) = \\prod_{k = 1} ^ m f(p_k ^ {c_k})$\u3002\n\n\u63d0**\u5c3d** $i$ \u7684\u6700\u5c0f\u8d28\u56e0\u5b50 $p_e$\uff0c\u5c06 $i$ \u5206\u6210\u4e24\u90e8\u5206\uff1a\n$p_e ^ {c_e} \\times \\frac{i}{p_e ^ {c_e}}$\n\n\u5219\u4e0a\u5f0f\u53ef\u53d8\u4e3a\uff1a\n\n$f(i) = f(p_e ^ {c_e}) \\times f(\\frac{i}{p_e ^ {c_e})})$\n\n\u90a3\u4e48\u5408\u6570\u90e8\u5206\u7684\u7b54\u6848\u53ef\u8f6c\u5316\u4e3a\uff1a\n\n$\\sum_{p ^ e \\leq n} f(p ^ e) \\sum_{1 \\leq i \\leq n \\ and \\ p ^ e \\mid i \\ and \\  minp(\\frac{i}{p ^ e}) > p} f(\\frac{i}{p ^ e})$\n\n\u4ee3\u8868\u7684\u610f\u601d\u662f\uff1a\n\n\u679a\u4e3e\u8d28\u6570 $p$ \u53ca\u5b83\u7684\u6307\u6570 $e$\uff0c\n\n\u5728\u53ef\u4ee5\u63d0\u7684\u5408\u6570 $i$ \u4e2d\u63d0\u51fa $p ^ e$\uff0c\u5c06\u5408\u6570 $i$ \u8f6c\u5316\u4e3a $p ^ e \\times \\frac{i}{p ^ e}$\uff0c\u5373\u4e0a\u5f0f\u4e58\u6cd5\u5206\u914d\u5f8b\u5c55\u5f00\u7684\u7ed3\u679c\u3002\n\n\u7136\u540e\u518d\u5224\u65ad\u5982\u4e0b\u6761\u4ef6\uff1a\n* $p$ \u662f\u5426\u662f $i$ \u7684\u6700\u5c0f\u8d28\u56e0\u5b50\n* $p$ \u662f\u5426\u63d0\u5c3d\n\n\u8fd9\u4e24\u4e2a\u6761\u4ef6\u5747\u53ef\u901a\u8fc7 $minp(\\frac{i}{p ^ e})$ \u662f\u5426\u5927\u4e8e $p$ \u6765\u5224\u65ad\uff1a\n\n\u5bf9\u4e8e $minp(\\frac{i}{p ^ e}) < p$ \u7684 $i$\uff0c\u90a3\u4e48\u4e0d\u6ee1\u8db3\u6761\u4ef6 $1$\u3002\n\n\u5bf9\u4e8e $minp(\\frac{i}{p ^ e}) = p$ \u7684 $i$\uff0c\u90a3\u4e48\u4e0d\u6ee1\u8db3\u6761\u4ef6 $2$\u3002\n\n\u8fd9\u4e9b\u5747\u53ef\u901a\u8fc7\u5bf9 $i$ \u5206\u89e3\u8d28\u56e0\u6570\u6765\u7406\u89e3\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e $f(p ^ e)$ \u7531\u9898\u610f\u53ef\u4ee5\u76f4\u63a5\u6c42\uff0c\u5bf9\u4e8e $f(\\frac{i}{p ^ e})$ \u5219\u662f\u540c\u6837\u7684\u6c42\u6cd5\uff0c\u76f4\u5230 $\\frac{i}{p ^ e}$ \u662f $p_k ^ {c_k}$ \u53ef\u4ee5\u76f4\u63a5\u6c42\u3002\n\n\u800c\u4e0a\u8ff0\u7684\u7ea6\u675f\u5219\u4fdd\u8bc1\u4e86\u4e0d\u4f1a\u591a\u6c42\u6f0f\u6c42\u3002\n### \u51c6\u5907 $2$\n\u6240\u4ee5\u6211\u4eec\u73b0\u5728\u9700\u8981\u6c42\u51fa\u6240\u6709 $f(p ^ k)$ \u7684\u503c\u3002\n\n\u56e0\u4e3a $n$ \u7684\u8303\u56f4\u5f88\u5927\uff0c\u6240\u4ee5\u6211\u4eec\u6ca1\u6cd5\u7ebf\u6027\u7b5b\u6c42\u51fa $f$ \u7684\u524d\u7f00\u548c\u3002\n\n\u8003\u8651 DP\u3002\u3002\u3002\n\n\u8bbe $h_k(i) = i ^ k$\uff0c\u663e\u7136 $h_k$ \u662f\u4e00\u4e2a\u5b8c\u5168\u79ef\u6027\u51fd\u6570\u3002\n\n\u8bbe\uff1a $g_k(n,j) = \\sum_{i = 1} ^ n [i \\in Prime \\ or \\  minp(i) > p_j] h_k(i)$\n\n\u5176\u4e2d $p_j$ \u8868\u793a\u7b2c $j$ \u4e2a\u8d28\u6570\u3002\n\n\u6362\u53e5\u8bdd\u8bf4 $g_k(n,j)$ \u4e5f\u5c31\u662f $1$ ~ $n$ \u4e2d\u8d28\u6570\u6216\u8005\u6700\u5c0f\u8d28\u56e0\u6570\u5927\u4e8e $p_j$ \u7684 $i$ \u7684 $h_k(i)$ \u7684\u524d\u7f00\u548c\u3002\n\n$g_k$ \u7684\u4f5c\u7528\u5728\u4e0b\u6587\uff0c\u4f46\u4e5f\u53ef\u4ee5\u5148\u629b\u5f00\u95ee\u9898\u672c\u8eab\uff0c\u770b\u61c2 $g_k$ \u7684\u6c42\u6cd5\u3002\n\n\u8003\u8651\u8f6c\u79fb\u3002\u3002\u3002\n\n\u5bf9\u4e8e $g_k(n, j - 1)$ \u6839\u636e\u5b9a\u4e49\uff0c\u5176\u4e2d\u5305\u542b\u4e24\u90e8\u5206\uff1a\n* $g_k(n, j)$ \n* \u6700\u5c0f\u8d28\u56e0\u6570\u7b49\u4e8e $p_j$ \u7684 $h_k(i)$ \u7684\u548c\u3002\n\n\u6240\u4ee5\u53ef\u7531 $g_k(n, j - 1)$ \u51cf\u53bb\u591a\u4f59\u7684\u90e8\u5206\u5f97\u5230 $g_k(n, j)$\u3002\n\n\u6240\u4ee5\u6709\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5982\u4e0b\uff1a\n\n$g_k(n,j) = g_k(n, j - 1) - p_{j} ^ k (g_k(\\frac{n}{p_{j}}, j - 1) - g_k(p_{j - 1}, j - 1))$\n\n\u4ece\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u53ef\u4ee5\u770b\u51fa\uff1a\n\n\u6700\u5c0f\u8d28\u56e0\u6570\u7b49\u4e8e $p_j$ \u7684 $h_k(i)$ \u7684\u548c\u5373\u4e3a\uff1a\n\n$g_k(n, j - 1) - p_{j} ^ k (g_k(\\frac{n}{p_j}, j - 1) - g_k(p_{j - 1}, j - 1))$\u3002\n\n\u539f\u56e0\u5982\u4e0b\uff1a\n\n\u6839\u636e\u5b9a\u4e49\u4e0d\u96be\u5f97\u5230 $g_k(p_{j - 1}, j - 1)$ \u5373\u4e3a\u524d $j - 1$ \u4e2a\u8d28\u6570\u7684 $k$ \u6b21\u65b9\u548c\u3002\n\n\u800c\u5bf9\u4e8e $g_k(\\frac{n}{p_j}, j - 1)$\uff0c\u5305\u542b\u4e86\u4e24\u90e8\u5206\uff1a\n* $1$ ~ $p_{j - 1}$ \u7684\u8d28\u6570\u548c\n* \u6700\u5c0f\u8d28\u56e0\u6570\u5927\u4e8e\u7b49\u4e8e $p_j$ \u7684\u5408\u6570\u548c\uff0c\u53ca $p_{j}$ ~ $\\frac{n}{p_j}$ \u7684\u8d28\u6570\u548c\n\n\u6ce8\u610f\u7b2c\u4e8c\u70b9\uff0c\u5982\u679c\u6211\u4eec\u5c06\u8fd9\u4e9b\u6700\u5c0f\u8d28\u56e0\u6570\u5927\u4e8e\u7b49\u4e8e $p_j$ \u7684\u5408\u6570\u6216\u8005\u540e\u4e00\u90e8\u5206\u7684\u8d28\u6570\u540c\u65f6\u4e58\u4e0a $p_j$ \u90a3\u4e48\u6211\u4eec\u5f97\u5230\u7684\u662f\u4e0d\u662f\u90fd\u662f\u6700\u5c0f\u8d28\u56e0\u6570\u7b49\u4e8e $p_j$ \u7684\u5408\u6570\uff0c\u8fd9\u70b9\u5e94\u8be5\u5f88\u597d\u7406\u89e3\u3002\n\n\u90a3\u4e5f\u5c31\u662f\u8bf4\u5f97\u5230\u4e86\u6211\u4eec\u60f3\u8981\u7b5b\u53bb\u7684\u5408\u6570\u3002\n\n\u56e0\u4e3a\u6211\u4eec\u53ea\u77e5\u9053\u4e0a\u8ff0\u4e24\u90e8\u5206\u7684\u548c $g_k(\\frac{n}{p_j}, j - 1)$\uff0c\u6240\u4ee5\u5728\u4e58\u7684\u8fc7\u7a0b\u4e2d\u7b2c\u4e00\u90e8\u5206\u4e5f\u4f1a\u88ab\u4e58\u4e0a\u4e00\u4e2a $p_j$\uff0c\u90a3\u4e48\u6211\u4eec\u5e94\u8be5\u628a\u8fd9\u4e00\u90e8\u5206\u8d28\u6570\u51cf\u53bb\u3002\n\n\u4e5f\u5c31\u662f $g_k(p_j, j - 1)$\u3002\n\n\u53c8\u56e0\u4e3a $h_k$ \u662f\u5b8c\u5168\u79ef\u6027\u51fd\u6570\uff0c\u800c\u6211\u4eec\u8c08\u8bba\u7684\u548c\u662f $h_k$ \u7684\u7d2f\u52a0\uff0c\u6839\u636e\u4e58\u6cd5\u5206\u914d\u5f8b\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9 $g_k$ \u8fd0\u7528\u5b8c\u5168\u79ef\u6027\u51fd\u6570\u7684\u6027\u8d28\uff08$f(ab) = f(a)f(b)$\uff09\u3002\n\n\u90a3\u4e48\u8981\u5f97\u5230\u6700\u5c0f\u8d28\u56e0\u6570\u7b49\u4e8e $p_j$ \u7684 $h_k(i)$ \u7684\u548c\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u7ed9\u6211\u4eec\u7684\u7b2c\u4e8c\u90e8\u5206\u4e58\u4e0a $h_k(p_j)$ \u7684\u503c\uff0c\u4e5f\u5c31\u662f $p_j ^ k$\uff0c\u5f97\u5230\u6211\u4eec\u8981\u6c42\u7684\u51fd\u6570\u503c\u3002\n\n\u6240\u4ee5\u5173\u4e8e\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u7684\u89e3\u91ca\u5c31\u7ed3\u675f\u4e86\u3002\n\n\u5173\u4e8e\u521d\u59cb\u5316\uff1a\n\n\u663e\u7136\u5bf9\u4e8e $g_k(n, 0) = \\sum_{i = 1} i ^ k$\n### \u6c42\u89e3\n\u800c\u6211\u4eec\u5f97\u5230\u7684 $g_k$ \u6709\u4ec0\u4e48\u7528\u5462\uff1f\n\n\u8bbe $g(n, j) = \\sum_{i = 1} ^ n [i \\in Prime \\ or \\ minp(i) > p_j] f(i)$\u3002\n\n\u56e0\u4e3a $f(p) = p(p - 1) = p ^ 2 - p$\u3002\n\n\u90a3\u4e48\u5c06\u6ee1\u8db3\u6761\u4ef6\u7684 $f(i)$ \u7d2f\u52a0\uff0c\u5c31\u5f97\u5230\u4e24\u90e8\u5206\uff1a\n* $i ^ 2$ \u7684\u548c\n* $i$ \u7684\u548c\u7684\u76f8\u53cd\u6570\n\n\u5982\u679c\u4ee4\u4e0a\u6587\u7684 $k$ \u5206\u522b\u7b49\u4e8e $1, 2$\u3002\n\n\u90a3\u4e48\u5c31\u6709\uff1a $g(n, j) = g_2(n, j) - g_1(n, j)$\u3002\n\n\u5982\u679c\u8bbe $p_x$ \u4e3a\u5c0f\u4e8e\u7b49\u4e8e $\\sqrt{n}$ \u7684\u6700\u5927\u7684\u8d28\u6570\uff0c\u90a3\u4e48 $1$ ~ $n$ \u7684\u8d28\u6570\u7684 $f$ \u7684\u548c $g(n, x)$ \u8bb0\u4e3a $g(n)$\u3002\n\n\u8bbe $S(n, j) = \\sum_{minp(i) > p_j} f(i)$\u3002\n\n\u663e\u7136\u6211\u4eec\u4e5f\u9700\u8981 DP \u3002\u3002\u3002\n\n\u540c\u6837\u7684\uff0c\u8003\u8651 $S(n, j)$ \u7684\u7ec4\u6210\uff1a\n* \u8d28\u6570\u90e8\u5206\uff1a\u5927\u4e8e $p_j$ \u5c0f\u4e8e\u7b49\u4e8e $n$ \u7684\u8d28\u6570\n* \u5408\u6570\u90e8\u5206\n\n\u8bbe $sum_k(x)$ \u8868\u793a\u5c0f\u4e8e\u7b49\u4e8e $p_x$ \u7684\u8d28\u6570\u7684 $k$ \u6b21\u65b9\u7684\u548c\u3002\n\n\u90a3\u4e48\u8d28\u6570\u90e8\u5206\u5c31\u7b49\u4e8e\uff1a\n\n$g(n) - (sum_{2}(j) - sum_{1}(j))$\n\n\u5bf9\u4e8e\u5408\u6570\u90e8\u5206\uff1a\n\n\u6211\u4eec\u6a21\u4eff $g_k$ \u7684\u6c42\u6cd5\n\n\u56e0\u4e3a $f$ \u4e0d\u662f\u5b8c\u5168\u79ef\u6027\u51fd\u6570\uff0c\u800c\u662f\u79ef\u6027\u51fd\u6570\uff0c\u6211\u4eec\u4e0d\u80fd\u50cf\u6c42 $g_k$ \u90a3\u6837\u53ea\u63d0\u4e00\u4e2a $p_j$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8981\u628a $p_j$ \u63d0\u5c3d\u3002\n\n\u5f97\u5230\uff1a\n$\\sum_{k > j \\ and \\ p_k ^ e \\leq n} f(p_k ^ e)(S(\\frac{n}{p_k ^ e} + [e \\neq 1]))$\n\n\u5229\u7528 $S(\\frac{n}{p_k ^ e}$ \u7684\u601d\u60f3\u548c\u6c42 $g_k$ \u7684\u65f6\u5019\u5b8c\u5168\u4e00\u6837\uff0c\u8fd9\u91cc\u5c31\u4e0d\u5728\u8d58\u8ff0\u4e86\uff0c\u5b9e\u5728\u4e0d\u61c2\u7684\u540c\u5b66\u53ef\u4ee5\u624b\u63a8\u4e00\u4e0b\u3002\n\n\u540e\u9762\u52a0\u4e0a\u4e00\u4e2a $[e \\neq 1]$ \u662f\u56e0\u4e3a\u5982\u679c $e > 1$\uff0c\u90a3\u4e48$p ^ e$ \u5728\u6211\u4eec\u63d0 $p_k ^ e$ \u65f6\u6ca1\u6709\u7b97\u8fdb\u53bb\uff0c\u800c $e = 1$ \u65f6\uff0c\u5728\u8d28\u6570\u90e8\u5206\u5c31\u7b97\u4e86\uff0c\u5c31\u4e0d\u7528\u4e86\u7b97\u8fdb\u53bb\u3002\n# \u4e0b\u6807\u7684\u79bb\u6563\u5316\n\u56e0\u4e3a $n = 1e10$\uff0c\u76f4\u63a5\u5f00\u80af\u5b9a\u4e0d\u884c\u3002\n\u7531\u6027\u8d28 $\\lfloor \\frac{\\lfloor \\frac{x}{a} \\rfloor}{b} \\rfloor = \\lfloor \\frac{x}{ab} \\rfloor$\uff0c\u5728\u9012\u5f52\u7684\u65f6\u5019\uff0c\u65e0\u8bba\u6211\u4eec\u628a $n$ \u9664\u4ee5\u51e0\uff0c\u5f97\u5230\u7684\u90fd\u662f $n$ \u9664\u4ee5\u67d0\u4e2a\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u53ea\u4fdd\u5b58 $n / x$ \u7684\u503c\u3002\n\u6765\u81ea wucstdio \u5927\u4f6c\n# \u4ee3\u7801\n```cpp\n#include<cstdio>\n#include<cmath>\n#include<cstring>\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst LL mod = 1e9 + 7, inv2 = 500000004, inv3 = 333333336;\nconst int N = 1e5 + 5;\n\nLL n, Prime[N + 5], num, sp1[N + 5], sp2[N + 5], tot =  0, w[3 * N], g1[3 * N], g2[3 * N], sqr;\nint id1[N + 5], id2[N + 5];\nbool notPrime[N + 5];\n\nvoid init() {\n\tmemset(notPrime, false, sizeof(notPrime));\n\tnum = 0;\n\tfor(int i = 2; i <= N; i++) {\n\t\tif(!notPrime[i]) {\n\t\t\tPrime[++num] = i;\n\t\t\tsp1[num] = (sp1[num - 1] + i) % mod;\n\t\t\tsp2[num] = (sp2[num - 1] + 1ll * i * i % mod) % mod;\n\t\t}\n\t\tfor(int j = 1; j <= num && Prime[j] * i <= N; j++) {\n\t\t\tnotPrime[i * Prime[j]] = true;\n\t\t\tif(i % Prime[j] == 0) break;\n\t\t}\n\t}\n}\n\nLL s(LL x, int y) {\n\tif(Prime[y] >= x) return 0;\n\tLL k = x <= sqr ? id1[x] : id2[n / x];\n\tLL ans = (g2[k] - g1[k] + mod - (sp2[y] - sp1[y]) + mod) % mod;\n\tfor(int i = y + 1; i <= num && Prime[i] * Prime[i] <= x; i++) {\n\t\tLL P = Prime[i];\n\t\tfor(int e = 1; P <= x; e++, P = P * Prime[i]) {\n\t\t\tLL xx = P % mod;\n\t\t\tans = (ans + xx * (xx - 1) % mod * (s(x / P, i) + (e != 1))) % mod;\n\t\t}\n\t}\n\treturn ans % mod;\n}\n\nint main() {\n\tinit();\n\tscanf(\"%lld\", &n);\n\tsqr = sqrt(n);\n\tfor(LL l = 1, r; l <= n; l = r + 1) {\n\t\tr = (n / (n / l));\n\t\tw[++tot] = n / l;\n\t\tg1[tot] = w[tot] % mod;\n\t\tg2[tot] = g1[tot] * (g1[tot] + 1) / 2 % mod * (2 * g1[tot] + 1) % mod * inv3 % mod - 1;\n\t\tif(g2[tot] < 0) g2[tot] += mod;\n\t\tg1[tot] = g1[tot] * (g1[tot] + 1) / 2 % mod - 1;\n\t\tif(g1[tot] < 0) g1[tot] += mod;\n\t\tif(w[tot] <= sqr) id1[w[tot]] = tot;\n\t\t\telse id2[n / w[tot]] = tot;\n\t}\n\tfor(int i = 1; i <= num; i++)\n\t\tfor(int j = 1; j <= tot && Prime[i] * Prime[i] <= w[j]; j++) {\n\t\t\tLL k = w[j] / Prime[i];\n\t\t\tk = k <= sqr ? id1[k] : id2[n / k];\n\t\t\tg1[j] -= Prime[i] * (g1[k] - sp1[i - 1] + mod) % mod;\n\t\t\tg2[j] -= Prime[i] * Prime[i] % mod * (g2[k] - sp2[i - 1] + mod) % mod;\n\t\t\tg1[j] %= mod, g2[j] %= mod;\n\t\t\tif(g1[j] < 0) g1[j] += mod;\n\t\t\tif(g2[j] < 0) g2[j] += mod;\n\t\t}\n\tprintf(\"%lld\", (s(n, 0) + 1) % mod); \n\treturn 0;\n}\n```",
        "postTime": 1626063816,
        "uid": 385145,
        "name": "\u795e\u7737\u4e4b\u6a31\u82b1",
        "ccfLevel": 4,
        "title": "Min_25 \u7b5b \u9898\u89e3"
    },
    {
        "content": "**\u5982\u679cLatex\u6709\u95ee\u9898\uff0c\u8bf7\u79fb\u6b65\u526a\u5207\u677f\uff1a** \n\nhttps://www.luogu.com.cn/paste/nyd6rs6i\n\n\n# \u5229\u7528 Powerful Number \u6c42\u6570\u8bba\u51fd\u6570\u524d\u7f00\u548c\n\n## 0. \u524d\u8a00\n\n**Powerful Number** \u53ef\u4ee5\u7528\u6765\u5feb\u901f\u6c42\u89e3\u6570\u8bba\u51fd\u6570\u7684\u524d\u7f00\u548c\u3002\n\n\u672c\u6587\u53c2\u8003\u4e86\uff1a\n\n[zzq's blog](https://www.cnblogs.com/zzqsblog/p/9904271.html)\n\n[\u6500\u5ca9\u9ad8\u624b \u7684\u535a\u5ba2](https://www.luogu.com.cn/blog/lengyanze/solution-p5325)\n\n\u5728\u6b64\u5411\u4ee5\u4e0a\u6587\u7ae0\u7684\u4f5c\u8005\u5448\u4e0a\u771f\u631a\u7684\u611f\u8c22\uff01\n\n[\u6211\u7684 csdn \u535a\u5ba2](https://blog.csdn.net/qq_41996523)\uff0c\u6b22\u8fce\u6765\u901b\u3002\n\n## 1. Powerful Number\n\n### 1.1 \u5b9a\u4e49\n\n\u6b63\u6574\u6570 $n=p_1^{a_1}p_2^{a_2}\\cdots p_s^{a_s}$ \u6ee1\u8db3 $a_i\\ge 2(1\\le i\\le s)$\uff0c\u5373 $n$ \u7684\u6240\u6709\u8d28\u56e0\u5b50\u7684\u5e42\u6b21\u90fd $\\ge 2$ \uff0c\u5219\u79f0 $n$ \u662f\u4e00\u4e2a **Powerful Number**\u3002\u7279\u522b\u5730\uff0c1 \u4e3a **Powerful Number**\u3002\n\n### 1.2 \u6027\u8d28\n\n$[1,n]$ \u5185\u7684 **Powerful Number** \u6709 $O(\\sqrt n)$ \u4e2a\u3002\n\n**\u8bc1\uff1a** \u663e\u7136 **Powerful Number** \u90fd\u53ef\u4ee5\u8868\u793a\u6210 $a^2b^3$ \u7684\u5f62\u5f0f\uff0c\u6211\u4eec\u679a\u4e3e $a$\uff0c\u5219 $[1,n]$ \u5185 **Powerful Number** \u7684\u6570\u91cf\u4e3a\n$$\nO\\left(\\sum_{a=1}^{\\sqrt n}\\sqrt [3]{\\dfrac{n}{a^2}}\\right)\n\\\\\n=O\\left(\\sqrt[3] n\\int_1^{\\sqrt n}a^{-2/3}da\\right)\n\\\\\n=O(\\sqrt n)\\\\\\Box\n$$\n\u8fd9\u4e2a\u6027\u8d28\u4fdd\u8bc1\u4e86\u7b97\u6cd5\u7684\u590d\u6742\u5ea6\u3002\n\n## 2. \u5e94\u7528\n\n[P5325 \u3010\u6a21\u677f\u3011Min_25\u7b5b](https://www.luogu.com.cn/problem/P5325)\n\n\u5df2\u77e5\u79ef\u6027\u51fd\u6570 $f(n)$\uff0c\u6ee1\u8db3 $f(p^k)=p^k(p^k-1)$\u3002\u6c42\n$$\n\\sum_{i=1}^nf(i)\n$$\n$1\\le n\\le 10^{10}$\u3002\n\n\u5148\u627e\u5230\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\u4f7f\u5f97\u5b83\u4e0e $f$ \u5728\u7d20\u6570\u7684\u53d6\u503c\u4e00\u81f4\uff0c\u6211\u4eec\u53ef\u4ee5\u627e\u5230 $g(n)=n\\varphi(n)$\u3002\n\n\u8bbe $h$ \u6ee1\u8db3 $f=g*h$\uff0c\u5176\u4e2d $*$ \u4e3a Dirichlet \u5377\u79ef\uff0c\u6545\u6709\n$$\nf(p)=g(1)h(p)+g(p)h(1)\n$$\n\u7531\u4e8e $f,g$ \u90fd\u662f\u79ef\u6027\u51fd\u6570\uff0c\u5219 $h$ \u4e5f\u662f\u79ef\u6027\u51fd\u6570\uff0c\u6545\u6709 $h(1)=g(1)=1$\uff0c\u5219\u53c8\u7531\u4e8e $f(p)=g(p)$\uff0c\u6709 $h(p)=0$\u3002\n\n\u7531\u4e8e $h$ \u662f\u79ef\u6027\u51fd\u6570\uff0c\u5219 $h$ \u4ec5\u5728 **Powerful Number** \u5904\u53ef\u80fd\u4e0d\u4e3a 0\u3002\n\n\u6211\u4eec\u7ee7\u7eed\u63a8\u5f0f\u5b50\uff0c\u9898\u76ee\u6240\u6c42\u4e3a\n$$\n\\sum_{i=1}^nf(i)=\\sum_{i=1}^n\\sum_{d|i}g(d)h\\left(\\dfrac i d\\right)\n\\\\\n=\\sum_{ij\\le n}g(i)h(j)=\\sum_{i=1}^nh(i)\\sum_{j=1}^{n/i}g(j)\n$$\n\u6839\u636e\u4e0a\u6587\u6240\u8bf4\uff0c\u6211\u4eec\u53ea\u9700\u8003\u8651 $i$ \u4e3a **Powerful Number** \u65f6 $g$ \u7684\u524d\u7f00\u548c\u600e\u4e48\u6c42\uff0c$h$ \u7684\u51fd\u6570\u503c\u600e\u4e48\u6c42\uff08\u8fd9\u4e24\u70b9\u4e5f\u662f\u6700\u91cd\u8981\u7684\uff09\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u675c\u6559\u7b5b\u7b80\u5355\u5730\u6c42\u5f97 $g$ \u5728\u6240\u6709\u7279\u6b8a\u70b9 $\\left\\lfloor\\dfrac ni\\right\\rfloor$ \u5904\u7684\u524d\u7f00\u548c\u3002\n\n\u90a3\u4e48\u552f\u4e00\u5269\u4e0b\u7684\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u6c42 $h$ \u5728 **Powerful Number** \u5904\u7684\u524d\u7f00\u548c\u3002\n\n\u7531\u4e8e $h$ \u662f\u79ef\u6027\u51fd\u6570\uff0c\u6211\u4eec\u8003\u8651\u8ba1\u7b97 $h(p^k)$ \u7684\u503c\u3002\u6ce8\u610f\u5230\u5f53 $p>\\sqrt n$ \u65f6\u4e0d\u53ef\u80fd\u6709 **Powerful Number** \u6709\u8d28\u56e0\u5b50 $p$\uff0c\u6545\u6211\u4eec\u53ea\u8981\u8ba1\u7b97 $p\\le \\sqrt n$ \u65f6\u7684\u60c5\u51b5\u3002\n\n\u6211\u4eec\u6709\u4e24\u79cd\u65b9\u6cd5\u8ba1\u7b97\u3002\n\n**Way1 \u63a8\u5f0f\u5b50**\n\n\u6709\n$$\nf(p^k)=(h*g)(p^k)=\\sum_{i=0}^kg(p^i)h(p^{k-i})\n$$\n\u800c\n$$\ng(p^i)=p^i\\varphi(p^i)=(p-1)p^{2i-1}(i\\ge1)\n\\\\\ng(1)=1\n$$\n\u5c55\u5f00\u5f97\n$$\np^k(p^k-1)=h(p^k)+\\sum_{i=1}^k(p-1)p^{2i-1}h(p^{k-i})\n$$\n\u540e\u9762\u90a3\u90e8\u5206\u5f88\u96be\u770b\uff0c\u6211\u4eec\u4e0d\u59a8\u6539\u4e00\u4e0b $h$ \u7684\u6307\u6570\uff0c\u6709\n$$\np^k(p^k-1)=h(p^k)+\\sum_{i=0}^{k-1}(p-1)p^{2k-2i-1}h(p^i)\n$$\n\u63a5\u4e0b\u6765\u8003\u5bdf\u4f60\u9ad8\u4e2d\u6570\u5217\u7684\u89e3\u9898\u6c34\u5e73\u4e86\uff0c\u505a\u4e0d\u51fa\u6765\u7684\u8bf7\u95ee\u4f60\u7684\u9ad8\u4e2d\u6570\u5b66\u8001\u5e08\u3002\n\n\u7528 $k-1$ \u4ee3\u66ff\u539f\u5f0f\uff0c\u6709\n$$\np^{k-1}(p^{k-1}-1)=h(p^{k-1})+\\sum_{i=0}^{k-2}(p-1)p^{2k-2i-3}h(p^i)\n\\\\\np^{k+1}(p^{k-1}-1)=p^2h(p^{k-1})+\\sum_{i=0}^{k-2}(p-1)p^{2k-2i-1}h(p^i)\n$$\n\u4e24\u5f0f\u76f8\u51cf\u5f97\n$$\np^{2k}-p^k-p^{2k}+p^{k+1}=h(p^{k})-p^2h(p^{k-1})+(p-1)ph(p^{k-1})\n$$\n\u7a0d\u4f5c\u5316\u7b80\u5f97\n$$\nh(p^k)-ph(p^{k-1})=p^{k+1}-p^k\n$$\n\u8bbe $H(k)=h(p^k)$\uff0c\u5219\n$$\nH(k)-pH(k-1)=p^{k+1}-p^k\n\\\\\n\\dfrac{H(k)}{p^k}-\\dfrac{H(k-1)}{p^{k-1}}=p-1\n$$\n\u7d2f\u52a0\u6cd5\uff0c\u53c8 $H(1)=h(p)=0$ \u5f97\n$$\n\\dfrac{H(k)}{p^k}=(k-1)(p-1)\n\\\\\nH(k)=h(p^k)=(k-1)(p-1)p^k\n$$\n\u4e8e\u662f\u6211\u4eec\u5f97\u5230\u4e86\u901a\u9879\uff0c\u76f4\u63a5\u4ee3\u5165\u8ba1\u7b97\u5373\u53ef\u3002\n\n**Way2 \u66b4\u529b\u8ba1\u7b97**\n\n\u6839\u636e\n$$\np^k(p^k-1)=h(p^k)+\\sum_{i=0}^{k-1}(p-1)p^{2k-2i-1}h(p^i)\n$$\n\u5f97\n$$\nh(p^k)=p^k(p^k-1)-\\sum_{i=0}^{k-1}(p-1)p^{2k-2i-1}h(p^i)\n$$\n\u76f4\u63a5\u8ba1\u7b97 $h(p^k)$\uff0c\u6bcf\u4e2a\u8d28\u56e0\u5b50\u9012\u63a8\u8ba1\u7b97\u5373\u53ef\u3002\u8fd9\u6837\u7684\u590d\u6742\u5ea6\u4e3a $O(\u8d28\u6570\u4e2a\u6570\\times \u5e42\u6b21)$\n\n\u800c $\\sqrt n$ \u4ee5\u5185\u7d20\u6570\u4e2a\u6570\u4e3a $\\pi(\\sqrt n)=O(\\dfrac{\\sqrt n}{\\log n})$\uff0c\u5e42\u6b21\u4e3a $O(\\log n)$\uff0c\u6545\u590d\u6742\u5ea6\u4ecd\u4e3a $O(\\sqrt n)$\u3002\u8fd9\u79cd\u65b9\u6cd5\u4e0d\u7528\u52a8\u592a\u591a\u8111\u5b50\u3002\uff08\u5f53\u7136\u4f60\u4e0d\u597d\u9012\u63a8\u7684\u8bdd\uff0c\u7eaf\u66b4\u529b\u8ba1\u7b97$O(\\sqrt n\\log n)$ ~~\u4f3c\u4e4e\u4e5f\u6ca1\u5565\u5927\u95ee\u9898~~\uff09\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\ntypedef long long ll;\nchar In[1 << 20], *ss = In, *tt = In;\n#define getchar() (ss == tt && (tt = (ss = In) + fread(In, 1, 1 << 20, stdin), ss == tt) ? EOF : *ss++)\nll read() {\n\tll x = 0, f = 1; char ch = getchar();\n\tfor(; ch < '0' || ch > '9'; ch = getchar()) if(ch == '-') f = -1;\n\tfor(; ch >= '0' && ch <= '9'; ch = getchar()) x = x * 10 + int(ch - '0');\n\treturn x * f;\n}\nconst int MAXK = 5e6 + 5;\nconst int P = 1e9 + 7, inv6 = 166666668;\nll pls(ll a, ll b) {return a + b < P ? a + b : a + b - P;}\nll mns(ll a, ll b) {return a < b ? a + P - b : a - b;}\nll mul(ll a, ll b) {return a * b % P;}\nll n, g[MAXK], sg[MAXK], tb_g[MAXK];\nint pr[MAXK], ip[MAXK], tot; \nvoid Sieve(int n) {\n\tip[1] = 1; g[1] = 1;\n\tfor(int i = 2; i <= n; i++) {\n\t\tif(!ip[i]) {\n\t\t\tpr[++tot] = i;\n\t\t\tg[i] = i-1;\n\t\t}\n\t\tfor(int j = 1; j <= tot && 1ll * i * pr[j] <= n; j++) {\n\t\t\tint k = i * pr[j];\n\t\t\tip[k] = 1;\n\t\t\tif(i % pr[j]) g[k] = g[i] * (pr[j] - 1);\n\t\t\telse {\n\t\t\t\tg[k] = g[i] * pr[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i = 1; i <= n; i++) g[i] = mul(g[i], i);\n\tfor(int i = 1; i <= n; i++) sg[i] = pls(sg[i-1], g[i]);\n}\nll S1(ll n) {n %= P; return n * (n + 1) / 2 % P;}\nll S2(ll n) {n %= P; return n * (n + 1) % P * (n + n + 1) % P * inv6 % P;}\nll calcsg(ll x) {\n\tif(x < MAXK) return sg[x];\n\tif(~tb_g[n / x]) return tb_g[n / x];\n\tll ret = S2(x);\n\tfor(ll i = 2, j; i <= x; i = j + 1) {\n\t\tll t = x / i; j = x / t;\n\t\tret = mns(ret, mul(calcsg(t), mns(S1(j), S1(i-1))));\n\t}\n\treturn tb_g[n / x] = ret;\n}\nll calch(ll p, ll pk, ll e) {p %= P; pk %= P; e %= P; return (e-1) * (p-1) % P * pk % P;}\nll dfs(ll k, ll lst, ll h) {\n\tll ans = mul(h, calcsg(n / lst));\n\tfor(ll g = n / lst; 1ll * pr[k] * pr[k] <= g; k++) {\n\t\tfor(ll e = 2, p = 1ll * pr[k] * pr[k]; p <= g; p *= pr[k], e++)\n\t\t\tans = pls(ans, dfs(k+1, lst * p, mul(h, calch(pr[k], p, e))));\n\t}\n\treturn ans;\n}\nint main() {\n\tn = read();\n\tSieve(MAXK - 1);\n\tmemset(tb_g, -1, sizeof tb_g);\n\tprintf(\"%lld\\n\", dfs(1, 1, 1));\n\treturn 0;\n}\n```\n\n\n\n",
        "postTime": 1613910927,
        "uid": 73032,
        "name": "\u65e5\u5c45\u6708\u8bf8",
        "ccfLevel": 8,
        "title": "\u5229\u7528 Powerful Number \u6c42\u6570\u8bba\u51fd\u6570\u524d\u7f00\u548c"
    },
    {
        "content": "# P5325 \u3010\u6a21\u677f\u3011Min_25\u7b5b\n\n## \u9898\u76ee\u63cf\u8ff0\n\u5b9a\u4e49\u4e00\u4e2a\u79ef\u6027\u51fd\u6570 $f(p^k)=p^k(p^k-1)$\uff0c\u6c42\n$$\\sum_{i=1}^{n}f(i)$$\n\u5bf9 $1e9+7$ \u53d6\u6a21\uff0c$n \\leq 1e10$\u3002\n\n## Solution\n\n### step1\n\n\u5b9a\u4e49\n$$h_k(i)=i^k$$\n$$g_k(n,j)=\\sum_{i=1}^{n} [i \\in p \\ or \\ minp(i)>p_j] \\ h_k(i)$$\n\n\u8003\u8651 $g_k(n,j)$ \u5982\u4f55\u7531 $g_k(n,j-1)$ \u8f6c\u79fb\u3002\n$$g_k(n,j)=g_k(n,j-1)-\\sum_{i=1}^{n}[i \\notin p \\ and \\ minp(i)=p_{j-1}] \\ h_k(i)$$\n\n\u4e00\u4e2a\u795e\u5947\u7684\u601d\u8def\u3002\u89c2\u5bdf $g_k(\\frac{n}{p_j},j-1)$ \u5305\u62ec\u4e24\u90e8\u5206\uff1a\n\n1. $1$ ~ $p_{j-1}$ \u7684\u8d28\u6570\u548c\u3002\n2. $p_j$ ~ $\\frac{n}{p_j}$ \u7684\u8d28\u6570\u548c\uff0c$1$ ~ $\\frac{n}{p_j}$ \u4e2d $minp > p_j$ \u7684\u5408\u6570\u548c\u3002\n\n\u5c06\u7b2c $2$ \u90e8\u5206\u4e58\u4e0a $p_j$\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230 $minp = p_j$ \u7684\u5408\u6570\u548c\u3002\n\n\u6240\u4ee5\n\n$$g_k(n,j)=g_k(n,j-1)-h(p_j)[g_k(\\frac{n}{p_j},j-1)-g_k(p_{j-1},j-1)]$$\n\n\u56e0\u4e3a $g_k$ \u662f\u5bf9\u5b8c\u5168\u79ef\u6027\u51fd\u6570 $h_k$ \u7684\u6c42\u548c\uff0c\u6839\u636e\u4e58\u6cd5\u5206\u914d\u5f8b\u53ef\u5f97\u7b49\u5f0f\u6210\u7acb\u3002\n\n### step 2\n\n\u5b9a\u4e49\n$$f'(i)=i(i-1)=i^2-i$$\n$$g(n,j)= \\sum_{i=1}^{n} [i \\in p \\ or \\ minp(i)>p_j] \\ f'(i)$$\n$$=g_2(n,j)-g_1(n,j)$$\n$$g(n)=\\sum_{i=1}^{n}[i \\in p] \\ f'(i)$$\n$$sum_k(x)=\\sum_{i=1}^{p_x}[i\\in p] \\ i^k$$\n$$S(n,j)=\\sum_{i=1}^{n}[minp(i)>p_j] \\ f(i)$$\n\n\u5bf9\u4e8e $S(n,j)$ \u8003\u8651\u4ece\u8d28\u6570\u3001\u5408\u6570\u4e24\u65b9\u9762\u5206\u522b\u6765\u6c42\u3002\n\n\u5bf9\u4e8e\u8d28\u6570\u90e8\u5206\uff0c\u503c\u4e3a\uff1a\n$$g(n)-(sum_2(j)-sum_1(j))$$\n\u5bf9\u4e8e\u5408\u6570\u90e8\u5206\uff0c\u4e0e $g_k$ \u7684\u63a8\u5bfc\u7c7b\u4f3c\uff0c\u4f46\u56e0\u4e3a $f$ \u975e\u5b8c\u5168\u79ef\u6027\u51fd\u6570\uff0c\u6240\u4ee5\u8981\u5c06\u8d28\u56e0\u5b50\u63d0\u5c3d\uff0c\u503c\u4e3a\uff1a\n$$\\sum_{k>j \\ and \\ p_k^e \\leq n}f(p_k^e)(S(\\frac{n}{p_k^e}+[e \\neq 1]))$$\n\n\u4e4b\u6240\u4ee5\u8981\u52a0 $[e \\neq 1]$\uff0c\u662f\u56e0\u4e3a\u5f53 $[e \\neq 1]$ \u65f6\uff0c$p_k^e$ \u4e5f\u662f\u5408\u6570\u3002\n\n### step3\n\n**\u4e0b\u6807\u79bb\u6563\u5316**\n\n\u56e0\u4e3a $n \\leq 1e10$\uff0c\u6240\u4ee5\u76f4\u63a5\u5f00\u80af\u5b9a\u5f00\u4e0d\u4e0b\u3002\n\n\u6839\u636e\n$$\\lfloor \\frac{\\lfloor \\frac{n}{a} \\rfloor}{b} \\rfloor=\\lfloor \\frac{n}{ab} \\rfloor$$\n\n\u5f97\uff0c$n$ \u9664\u4ee5\u5f88\u591a\u6b21\u4e4b\u540e\uff0c\u4f9d\u7136\u7b49\u4e8e\u9664\u4ee5\u67d0\u4e00\u4e2a\u6570\u3002\n\n## \u4ee3\u7801\u5c55\u793a\n```cpp\n#include<cstdio>\n#include<cmath>\n#define LL long long\n#define int long long\nusing namespace std;\n\nconst int MAXN = 1e6 +5;\nconst LL MOD = 1e9 + 7;\n\nLL n, sqr, inv6, inv2;\nLL cnt, prime[MAXN], v[MAXN];\nLL sp1[MAXN], sp2[MAXN];\nint tot; LL w[MAXN], g1[MAXN], g2[MAXN];\nint id1[MAXN], id2[MAXN];\n\nLL expow(LL x, LL y) {\n\tLL res = 1;\n\twhile(y) {\n\t\tif(y & 1) res = res * x % MOD;\n\t\ty >>= 1, x = x * x % MOD; \n\t}\n\treturn res;\n}\n\nvoid init(int x) {\n\tfor(int i = 2; i <= x; i++) {\n\t\tif(!v[i]) {\n\t\t\tv[i] = i, prime[++cnt] = i;\n\t\t\tsp1[cnt] = (sp1[cnt - 1] + i) % MOD;\n\t\t\tsp2[cnt] = (sp2[cnt - 1] + 1ll * i * i % MOD) % MOD;\n\t\t}\n\t\tfor(int j = 1; j <= cnt && prime[j] * i <= x; j++) {\n\t\t\tv[i * prime[j]] = prime[j];\n\t\t\tif(i % prime[j] == 0) break;\n\t\t}\n\t}\n\tinv6 = expow(6, MOD - 2);\n\tinv2 = expow(2, MOD - 2);\n}\n\nLL S(LL x, int y) {\n\tif(prime[y] >= x) return 0;\n\tLL k = (x <= sqr) ? id1[x] : id2[n / x];\n\t//printf(\"%lld %lld %d\\n\",x, k, y);\n\tLL res = (g2[k] - g1[k] + MOD - (sp2[y] - sp1[y]) + MOD) % MOD;\n\t//printf(\"%lld\\n\",res);\n\tfor(int i = y + 1; i <= cnt && prime[i] * prime[i] <= x; i++) {\n\t\tLL P = prime[i];\n\t\tfor(int e = 1; P <= x; e++, P *= prime[i]) {\n\t\t\tLL mul = P % MOD;\n\t\t\tres = (res + mul * (mul - 1) % MOD * (S(x / P, i) + (e != 1)) % MOD) % MOD;\n\t\t\t//printf(\"%lld %lld\\n\",mul, res);\n\t\t}\n\t}\n\treturn res;\n}\n\nmain() {\n\tscanf(\"%lld\",&n);\n\tsqr = sqrt(n);\n\tinit(sqr);\n\tfor(LL l = 1, r; l <= n; l = r + 1) {\n\t\tr = n / (n / l);\n\t\tw[++tot] = n / l;\n\t\tg1[tot] = w[tot] % MOD;\n\t\tg2[tot] = g1[tot] * (g1[tot] + 1) % MOD * (2 * g1[tot] + 1) % MOD * inv6 % MOD - 1;\n\t\tif(g2[tot] < 0) g2[tot] += MOD;\n\t\tg1[tot] = g1[tot] * (g1[tot] + 1) % MOD * inv2 % MOD - 1;\n\t\tif(g1[tot] < 0) g1[tot] += MOD;\n\t\tif(w[tot] <= sqr) id1[w[tot]] = tot;\n\t\telse id2[n / w[tot]] = tot;\n\t}\n\tfor(int i = 1; i <= cnt; i++) {\n\t\tfor(int j = 1; j <= tot && prime[i] * prime[i] <= w[j]; j++) {\n\t\t\tint k = w[j] / prime[i];\n\t\t\tk = (k <= sqr) ? id1[k] : id2[n / k];\n\t\t\tg1[j] = (g1[j] - prime[i] * (g1[k] - sp1[i - 1] + MOD) % MOD) % MOD;\n\t\t\tg2[j] = (g2[j] - prime[i] * prime[i] % MOD * (g2[k] - sp2[i - 1] + MOD) % MOD) % MOD;\n\t\t\tif(g1[j] < 0) g1[j] += MOD;\n\t\t\tif(g2[j] < 0) g2[j] += MOD;\n\t\t\t//printf(\"%lld %lld\\n\",g1[j], g2[j]);\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",(S(n, 0) + 1) % MOD);\n\treturn 0;\n}\n```\n",
        "postTime": 1626138547,
        "uid": 304556,
        "name": "zym417",
        "ccfLevel": 7,
        "title": "Min_25"
    },
    {
        "content": "### min25 \u7b5b\n\n\u5728 $\\mathrm o(n)$ \u65f6\u95f4\u5185\u6c42\u7279\u5b9a\u79ef\u6027\u51fd\u6570 $f$ \u7684\u524d $n$ \u9879\u7684\u548c\u3002\n\n\u4f7f\u7528\u8be5\u7b97\u6cd5\u7684\u5148\u51b3\u6761\u4ef6\uff1a$f$ \u5728\u8d28\u6570 $p$ \u5904\u7684\u503c\u53ef\u4ee5\u7528\u5173\u4e8e $p$ \u7684\u4f4e\u6b21\u591a\u9879\u5f0f\u8868\u8fbe\u51fa\u6765\uff0c\u5e76\u4e14\u5728\u8d28\u6570\u7684\u5e42\u5904\u7684\u503c\u53ef\u4ee5\u8f83\u5feb\u7b97\u51fa\u3002\u4e8b\u5b9e\u4e0a\u5bf9\u4e8e\u524d\u8005\uff0c\u5927\u90e8\u5206\u79ef\u6027\u51fd\u6570\u90fd\u6ee1\u8db3\uff0c\u4f8b\u5982 $\\sigma_k(p)=p^k+1$\uff0c$\\varphi(p)=p-1$\uff0c$\\mu(p)=-1$\uff1b\u5bf9\u540e\u8005\u4e5f\u662f\u5927\u90e8\u5206\u79ef\u6027\u51fd\u6570\u90fd\u6ee1\u8db3\u3002\u6240\u4ee5\u53ef\u4ee5\u53d1\u73b0 min25 \u7b5b\u7684\u9002\u7528\u6027\u8fd8\u662f\u5f88\u5e7f\u7684\uff0c\u4f46\u5b83\u4e5f\u6709\u5b83\u81ea\u5df1\u7684\u7f3a\u70b9\uff0c\u5c31\u662f\u4e0d\u80fd\u987a\u4fbf\u83b7\u5f97\u5173\u952e\u70b9 $\\left\\lfloor\\dfrac nx\\right\\rfloor$ \u5904\u7684\u524d\u7f00\u548c\u3002\n\nmin25 \u7b5b\u5206\u6210\u4e24\u4e2a\u90e8\u5206\uff1a\u4e00\u662f\u7b97 $n$ \u4ee5\u5185\u8d28\u6570\u7684\u603b\u8d21\u732e\uff0c\u4e8c\u662f\u7b97\u5408\u6570\uff08\u5f53\u7136\u6700\u540e\u8981\u628a $1$ \u5904\u7684\u503c $1$ \u52a0\u4e0a\uff09\u3002\n\n\u7b2c\u4e00\u90e8\u5206\uff1a\u8003\u8651\u6a21\u62df\u57c3\u6c0f\u7b5b\u7684\u8fc7\u7a0b\uff0c\u7528\u4e00\u4e2a\u4e2a\u8d28\u6570\u628a\u6240\u6709\u5408\u6570\u7b5b\u6389\uff0c\u6700\u7ec8\u53ea\u5269\u4e0b\u8d28\u6570\u3002\u7531\u4e8e\u5408\u6570\u6700\u7ec8\u4e0d\u4f1a\u88ab\u7b97\uff0c\u6240\u4ee5\u5408\u6570\u5904\u7684\u503c\u641e\u6210\u4ec0\u4e48\u6837\u90fd\u53ef\u4ee5\uff0c\u4e0d\u59a8\u5f53\u4f5c\u8d28\u6570\uff0c\u548c\u8d28\u6570\u4eab\u6709\u4e00\u6837\u7684\u4f4e\u9636\u591a\u9879\u5f0f\u8868\u8fbe\u5f0f\u3002\u8003\u8651\u5bf9\u591a\u9879\u5f0f\u7684\u6bcf\u4e00\u9879\u6c42\u548c\uff0c\u6700\u7ec8\u52a0\u8d77\u6765\uff0c\u8fd9\u6837\u4e0d\u4ec5\u7531\u4e8e\u591a\u9879\u5f0f\u4f4e\u9636\uff0c\u8ba1\u7b97\u6b21\u6570\u53ef\u4ee5\u5ffd\u7565\uff0c\u800c\u4e14\u5bf9\u4e00\u4e2a\u6bcf\u5904\u7684\u503c\u90fd\u662f\u8be5\u5904\u7684\u5e42\u7684\u51fd\u6570\uff08\u6052\u7b49\u51fd\u6570\uff09\u662f\u5b8c\u5168\u79ef\u6027\u51fd\u6570\uff0c\u5e76\u4e14\u524d\u7f00\u548c\u6709\u901a\u9879\u3002\u8003\u8651\u8bbe $g(i,j)$ \u8868\u793a $i$ \u4ee5\u5185\u7684\u6570\u7528\u524d $j$ \u4e2a\u8d28\u6570\u7b5b\u8fc7\u4ee5\u540e\u5269\u4e0b\u6765\u7684\u6240\u6709\u6570\u7684\u5e42\u7684\u548c\uff0c\u5373\u6240\u6709\u8d28\u6570\u548c\u6700\u5c0f\u8d28\u56e0\u5b50\u5927\u4e8e\u7b2c $j$ \u4e2a\u8d28\u6570\u7684\u5408\u6570\u7684\u603b\u8d21\u732e\u3002\u8003\u8651\u57c3\u6c0f\u7b5b\u7684\u8fc7\u7a0b\uff0c\u82e5 $P_j^2>i$\uff0c\u5219\u663e\u7136 $g(i,j)=g(i,j-1)$\uff1b\u5426\u5219 $g(i,j-1)\\to g(i,j)$ \u663e\u7136\u7b5b\u6389\u4e86\u6700\u5c0f\u8d28\u56e0\u5b50\u6070\u597d\u7b49\u4e8e\u7b2c $j$ \u4e2a\u8d28\u6570\u7684\u6240\u6709\u5408\u6570\uff0c\u6839\u636e\u5b8c\u5168\u79ef\u6027\u51fd\u6570\u7684\u6027\u8d28\uff0c\u8f6c\u79fb\u65b9\u7a0b\u663e\u7136\u6709\uff1a\n$$\ng(i,j)=g(i,j-1)-f(P_j)\\!\\left(g\\!\\left(\\left\\lfloor\\dfrac i{P_j}\\right\\rfloor\\!,j-1\\right)-g(P_{j-1},j-1)\\right)\n$$\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u8f6c\u79fb\u5230\u7684 $i$\uff0c\u7531\u4e8e $\\left\\lfloor\\dfrac{\\left\\lfloor\\dfrac na\\right\\rfloor}b\\right\\rfloor=\\left\\lfloor\\dfrac n{ab}\\right\\rfloor$\uff0c\u4e00\u5b9a\u662f\u67d0\u4e2a $\\left\\lfloor\\dfrac nx\\right\\rfloor$ \u7684\u503c\uff0c\u53ea\u6709\u6839\u53f7\u4e2a\u3002\u5b58\u50a8\u7684\u8bdd\uff0c\u8fd8\u8981\u8fdb\u884c\u79bb\u6563\u5316\uff0c\u8fd9\u91cc\u6709\u4e2a\u5de7\u65b9\u6cd5\uff1a\u5bf9 $\\leq \\sqrt n$ \u7684\u503c\u8bb0\u5f55 $i$\uff0c\u5426\u5219\u8bb0\u5f55 $\\left\\lfloor\\dfrac nx\\right\\rfloor=i$ \u7684\u552f\u4e00\u89e3 $x=\\left\\lfloor\\dfrac ni\\right\\rfloor$\u3002$g(P_{j-1},j-1)$ \u8868\u793a\u5c0f\u4e8e $P_j$ \u7684\u8d28\u6570\u8d21\u732e\u548c\u3002\u7531\u4e8e\u4ec5\u5f53 $P_j^2\\leq i\\leq n$ \u7684\u65f6\u5019\u624d\u4f1a\u7528\u5230\u8fd9\u4e2a\u8f6c\u79fb\u5f0f\uff0c\u6240\u4ee5\u8fd9\u4e2a\u8d28\u6570\u7684\u524d\u7f00\u548c\u53ef\u4ee5\u76f4\u63a5\u7ebf\u7b5b\uff0c\u7b5b\u5230 $\\sqrt n$\u3002\u7136\u540e $j$ \u8fd9\u4e00\u7ef4\u663e\u7136\u53ef\u4ee5\u6eda\u6389\uff0c\u5c31\u5916\u5c42\u679a\u4e3e $j$\uff0c\u5185\u5c42\u5012\u8fc7\u6765\u679a\u4e3e $i$ \u8f6c\u79fb\u3002\u8fd9\u6837\u6eda\u52a8\u8fd8\u6709\u4e2a\u597d\u5904\uff0c\u5c31\u662f\u5c06 $i$ \u6392\u5e8f\u540e\uff0c\u5bf9\u6bcf\u4e2a $j$ \u9700\u8981\u66f4\u65b0\u7684 $i$ \u662f\u4e00\u4e2a\u540e\u7f00\uff0c\u53ef\u4ee5\u76f4\u63a5\u641e\u3002\u4e0d\u96be\u53d1\u73b0\u7b2c\u4e00\u90e8\u5206\u5229\u7528\u4e86\u4f4e\u9636\u591a\u9879\u5f0f\u7684\u79cd\u79cd\u4f18\u7f8e\u6027\u8d28\uff0c\u4ee5\u53ca\u57c3\u6c0f\u7b5b\u4e2d $>\\sqrt n$ \u7684\u8d28\u6570\u4e0d\u8d77\u4f5c\u7528\u8fd9\u4e2a\u91cd\u8981\u7684\u4fdd\u969c\u590d\u6742\u5ea6\u7684\u4e8b\u60c5\u3002\n\n\u7b2c\u4e8c\u90e8\u5206\uff1a\u8bbe $h(i,j)$ \u8868\u793a $i$ \u4ee5\u5185\u6700\u5c0f\u8d28\u56e0\u5b50\u5927\u4e8e $P_j$ \u7684\u6240\u6709\u6570\u7684\u539f\u79ef\u6027\u51fd\u6570\u503c\u548c\u3002\u8fd9\u6b21\u662f\u5012\u8fc7\u6765\u8f6c\u79fb\u7684\uff0c\u5373\u4e4b\u524d $g$ \u7684\u8fb9\u754c $g(i,0)$ \u7531\u4e8e\u6052\u7b49\u51fd\u6570\u7684\u4f18\u7f8e\u6027\u8d28\u53ef\u4ee5\u76f4\u63a5\u7b97\uff0c\u800c\u8fd9\u6b21\u8fb9\u754c\u4e3a $h(i,pcnt)$ \u4ec5\u5305\u542b\u8d28\u6570\u7684\u8d21\u732e\uff0c\u6700\u540e\u7b54\u6848\u662f $h(n,0)$\u3002\u8003\u8651\u8f6c\u79fb\uff0c\u8ba1\u7b97 $h(i,j)$ \u65f6\u5148\u628a\u4e4b\u524d\u7b97\u8fc7\u7684\u8d28\u6570\u7684\u8d21\u732e\u7b97\u4e0a\uff08\u4ee5\u4e0b\u76f4\u63a5\u5047\u5b9a $g$ \u4e3a\u7b2c\u4e00\u90e8\u5206\u6240\u8ba1\u7b97\u51fa\u7684\u5bf9\u591a\u9879\u5f0f\u6bcf\u4e00\u9879\u5206\u522b\u7684 $g$ \u7684\u548c\uff09\uff0c\u7136\u540e\u679a\u4e3e\u5408\u6570\u7684\u6700\u5c0f\u8d28\u56e0\u5b50\u53ca\u5176\u6b21\u6570\uff0c\u5229\u7528\u79ef\u6027\u51fd\u6570\u7684\u6027\u8d28\u628a\u503c\u62c6\u51fa\u6765\u8f6c\u79fb\uff1a\n$$\nh(i,j)=g(i,pcnt)-g(P_j,j)+\\sum_{p>j,P_p^2\\leq i}\\sum_{k\\geq1,P_p^k\\leq i}f\\!\\left(P_p^k\\right)\\!\\left(h\\!\\left(\\left\\lfloor\\dfrac i{P_p^k}\\right\\rfloor\\!,p\\right)+[k>1]\\right)\n$$\n$g(P_j,j)$ \u4f9d\u7136\u662f\u90a3\u4e2a\u88ab\u7ebf\u7b5b\u9884\u5904\u7406\u7684\u73a9\u610f\u3002\u5408\u6570\u7684\u6700\u5c0f\u8d28\u56e0\u5b50\u4e00\u5b9a $\\leq\\sqrt n$ \u8fd9\u4e2a\u6027\u8d28\u518d\u4e00\u6b21\u4fdd\u969c\u4e86\u590d\u6742\u5ea6\uff0c\u4fdd\u969c\u4e86 $j$ \u7684\u8303\u56f4\u662f\u5230\u6839\u53f7\uff0c\u4f7f\u5f97 $g$ \u548c $h$ \u7684\u72b6\u6001\u7ed3\u6784\u76f8\u540c\uff08\u53e6\u4e00\u4e2a point \u662f $h$ \u7684\u6709\u6548 $i$ \u503c\u4e5f\u662f\u6574\u9664\u7684\u5f62\u5f0f\uff09\u3002\u679a\u4e3e\u6700\u5c0f\u8d28\u56e0\u5b50\u7684\u65f6\u5019\uff0c\u4e5f\u7528\u5230\u4e86\u8fd9\u4e2a\u6027\u8d28\u6765\u4fdd\u969c\u590d\u6742\u5ea6\u3002\u7136\u540e\u5c31\u76f4\u63a5\u7206\u641c\u9012\u5f52\u8f6c\u79fb\uff0c\u8fb9\u754c\u662f $h(i,j)=0(P_j>i)$\uff0c\u751a\u81f3\u4e0d\u9700\u8981\u8bb0\u5fc6\u5316\u3002\n\n\u8fd9\u4e24\u4e2a\u90e8\u5206\u7684\u603b\u590d\u6742\u5ea6\u88ab\u8bc1\u660e\u662f $\\mathrm O\\!\\left(n^{0.75}\\log^{-1}n\\right)$ \u6216\u8005\u662f $\\mathrm O\\!\\left(n^{1-\\epsilon}\\right)$ ~~\u6211\u4e5f\u4e0d\u77e5\u9053~~\u3002\u603b\u4e4b\u633a\u5feb\u7684\uff0c$n=10^{10}$ \u5927\u6982\u8dd1 1s\u3002\n\n[min25 \u7b5b\u6a21\u677f](https://www.luogu.com.cn/record/46654469) [\u675c\u6559\u7b5b\u6a21\u677f\uff08\u7528 min25 \u7b5b\u5199\u7684\uff09](https://www.luogu.com.cn/record/46653242)",
        "postTime": 1613490201,
        "uid": 138400,
        "name": "chenxia25",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5325 \u3010\u3010\u6a21\u677f\u3011Min_25\u7b5b\u3011"
    },
    {
        "content": "[\u535a\u5ba2\u98df\u7528\u66f4\u4f73](https://www.cnblogs.com/zimindaada/p/13791651.html)\n\n# Min_25\u7b5b\u5b66\u4e60\u7b14\u8bb0\n\nMin_25\u7b5b\u53ef\u4ee5\u7528\u6765\u6c42\u89e3\u4e00\u7c7b$f(n)$\u7684\u524d\u7f00\u548c\uff0c\u5176\u4e2d$f$\u662f\u79ef\u6027\u51fd\u6570\uff0c$f(P)$\u662f\u5173\u4e8e\u8d28\u6570$P$\u7684\u4f4e\u9636\u591a\u9879\u5f0f\uff0c\u4e14$\\forall k\\in N^+,f(P^k)$\u53ef\u4ee5\u901a\u8fc7\u67d0\u4e9b\u65b9\u5f0f\u5feb\u901f\u6c42\u89e3\u3002\u200b\n\n## \u7406\u8bba\u90e8\u5206\n\n**\u9996\u5148\u6211\u4eec\u6c42\u89e3$\\sum_{i=1}^n [i \\in P]f(i)$\u3002**\n\n\u9996\u5148\u7531\u4e8e$f(P) $\u662f\u591a\u9879\u5f0f\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a$f(P)$\u7684\u6bcf\u4e00\u9879\u62c6\u5f00\u6765\u3002\n\n\u6211\u4eec\u4ee4$g_{n,j} = \\sum_{i=1}^n [i \\in P  \\space or \\space MinFactor(i) > P_j ]i^k$\uff0c\u5176\u4e2d$MinFactor(i)$\u4e3a$i$\u7684\u6700\u5c0f\u8d28\u56e0\u5b50\uff08\u540e\u7b80\u5199\u6210$MF$\uff09\uff0c$P$\u4e3a\u8d28\u6570\u96c6\uff0c$P_j$\u4e3a\u7b2c$j$\u4e2a\u8d28\u6570\u3002\u7531\u5b9a\u4e49\u53ef\u4ee5\u5f97\u5230$g_{n,|P|}$\u5373\u4e3a\u6211\u4eec\u6240\u6c42,$g_{n,0} = \\sum_{i=2}^{n}i^k$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u8be5\u600e\u4e48\u8f6c\u79fb\u5462\uff1f\n\n\u6211\u4eec\u5206\u7c7b\u8003\u8651\u4e00\u4e0b\u3002\u5982\u679c$P_j^2 > n$\uff0c\u90a3\u4e48\u5c31\u4e0d\u5b58\u5728$MF(i) > P_j$\u8fd9\u6761\u9650\u5236\u4e86\uff0c\u6bd5\u7adf\u4e0d\u5b58\u5728\u4e00\u4e2a\u5408\u6570\u6709\u5927\u4e8e$\\sqrt n$\u7684\u8d28\u56e0\u5b50\u3002\n\n\u5982\u679c$P_j^2 \\leq n$\uff0c\u5219\u7531\u4e8e$g_{n,j}$\u6240\u56ca\u62ec\u7684\u88ab\u8ba1\u7b97$i^k$\u7684$i$\u5fc5\u5b9a\u662f$g_{n,j-1}$\u6240\u56ca\u62ec\u7684\u7684\u4e00\u4e2a\u5b50\u96c6\uff0c\u6240\u4ee5$g_{n,j} = g_{n,j-1}-\\Delta$\u3002\n\n\u5177\u4f53\u8003\u8651$\\Delta$\u6240\u5305\u542b\u7684\u4e1c\u897f\u3002\u5bb9\u6613\u53d1\u73b0$g_{n,j}$\u6240\u6ca1\u6709\u5305\u542b\u7684\uff0c\u800c$g_{n,j-1}$\u6240\u5305\u542b\u7684\u5c31\u662f\u6700\u5c0f\u8d28\u56e0\u5b50\u6070\u597d\u7b49\u4e8eP_j\u7684\u3002$\u2234\\Delta = \\sum_{i=1}^n [MF(i)=p_j]i^k =\\sum_{i=1}^{\\lfloor\\frac{n}{P_j}\\rfloor}[MF(i)\\geq p_j] i^k \\cdot P_j^k =P_j^k\\cdot\\sum_{i=1}^{\\lfloor\\frac{n}{P_j}\\rfloor}[MF(i)=p_j]i^k=P_j^k\\cdot(g_{\\lfloor\\frac{n}{P_j}\\rfloor,j-1}-\\sum_{i=1}^{j-1}[i\\in P]i^k)$\n\n\u628a$f$\u7684\u90a3\u4e9b\u5404\u4e2a\u9879\u5408\u5728\u4e00\u8d77\uff0c\u5f97\u5230\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a\n\n$g_{n,j}=\\begin{cases} g_{n,j-1}&,P_j>\\sqrt n\\\\ g_{n,j-1}-f(P_j)\\times(g_{\\lfloor \\frac{n}{P_j}\\rfloor,j-1}-\\sum_{i=1}^{j-1} f(P_i))&,P_j\\le \\sqrt n \\end{cases}$\n\n\u5176\u4e2d\u6700\u540e\u7684\u8d28\u6570\u524d\u7f00\u548c\u53ef\u4ee5\u5728\u7b5b\u8d28\u6570\u7684\u65f6\u5019\u987a\u5e26\u5904\u7406\uff0c\u590d\u6742\u5ea6\u4e0d\u8ba1\u3002\n\n\u5728\u6574\u5b8c\u4e86\u8d28\u6570\u90e8\u5206\u7684\u7b54\u6848\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u5408\u8d77\u6765\uff0c**\u8003\u8651\u6574\u4f53\u7684\u7b54\u6848\u4e86**\u3002\n\n\u6211\u4eec\u4ee4$S_{n,j}=\\sum_{i=1}^n[MF(i)>P_j]f(i)$\uff0c\u5219\u7531\u5b9a\u4e49\u6709$ans = S_{n,0}+f(1)$\uff0c\u5219\n\n$S_{n,j} = (g_{n,|P|} - \\sum_{i=1}^j P_i) + (\\sum_{k=j+1}^{P_k\\leq \\sqrt n} \\sum_{e=1}^{P_k^e \\leq n}S_{n,k+1} + f(p_k^{e+1})) = (g_{n,|P|}-\\sum_{i=1}^j P_i) + (\\sum_{k=j+1}^{P_k\\leq \\sqrt n} \\sum_{e=1}^{P_k^e \\leq n}f(p_k^e)\\cdot S_{\\lfloor\\frac{n}{p_k^e}\\rfloor,k+1} + f(p_k^{e+1}))$\n\n\uff08\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u80fd\u5012\u817e\u5230\u7b2c\u4e8c\u4e2a\u662f\u56e0\u4e3a$f(p_k^e)$\u4e0e$S_{\\lfloor\\frac{n}{p_k^e}\\rfloor,k+1}$\u4e92\u8d28\uff09\n\n\u7b2c\u4e8c\u4e2a\u5f0f\u5b50\u7b2c\u4e00\u4e2a\u62ec\u53f7\u5185\u7684\u662f\u524d\u6587\u4e2d\u7684\u8d28\u6570\u90e8\u5206\u7684\u548c\uff0c\u7b2c\u4e8c\u4e2a\u62ec\u53f7\u5185\u7684\u5219\u662f\u548c\u6570\u90e8\u5206\u7684\u548c\u3002\n\n\u7b2c\u4e8c\u4e2a\u62ec\u53f7\u5185\u7684\u7b2c\u4e00\u4e2a$\\Sigma$\u76f8\u5f53\u4e8e\u5728\u679a\u4e3e\u6700\u5c0f\u8d28\u56e0\u5b50\uff0c\u7b2c\u4e8c\u4e2a\u5219\u662f\u5728\u679a\u4e3e\u6700\u5c0f\u8d28\u56e0\u5b50\u7684\u6307\u6570\u3002\u8fd9\u4e2a$S_{\\lfloor\\frac{n}{p_k^e}\\rfloor,k+1}$\u662f\u4e2a\u9012\u5f52\uff0c\u7531\u4e8e\u6211\u4eec\u4e0d\u53ef\u80fd\u4ece\u540e\u9762\u7684\u4e1c\u897f\u63a8\u524d\u9762\uff0c\u6240\u4ee5\u6211\u4eec\u679a\u4e3e\u4ed6\u7684\u6700\u5c0f\u8d28\u56e0\u5b50\u548c\u6307\u6570\uff0c\u7136\u540e\u53ea\u9700\u8981\u8003\u8651\u9664\u5b8c\u4e4b\u540e\u5269\u4e0b\u90e8\u5206\u7684\u7b54\u6848\u5c31\u597d\u4e86\uff0c\u5373$\\lfloor\\frac{n}{p_k^e}\\rfloor$\u3002\u56e0\u4e3a\u6700\u5c0f\u8d28\u56e0\u6570\u5df2\u7ecf\u88ab\u9664\u5b8c\uff0c\u6240\u4ee5\u5269\u4e0b\u90e8\u5206\u4e2d\u4e0d\u80fd\u518d\u542b\u6709\u6700\u5c0f\u8d28\u56e0\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u9012\u5f52\u4e0b\u53bb\u7684\u90e8\u5206\u8981\u8003\u8651\u7684\u6700\u5c0f\u8d28\u56e0\u5b50\u95e8\u69db\u8981\u63d0\u9ad8\uff0c\u5373$k+1$\u3002\n\n\u540c\u65f6\uff0c\u4e3a\u4e86\u8865\u4e0a\u6240\u6709\u88ab\u7b5b\u6389\u7684$p_k^e $\u7c7b\u7684\u5408\u6570\uff0c\u6211\u4eec\u8981\u628a\u4ed6\u4eec\u7684\u503c\u52a0\u56de\u53bb\uff0c\u5373\u5f0f\u5b50\u6700\u540e\u7684$f(p_k^{e+1}))$\u3002\n\n\u7136\u800c\uff0c\u6211\u4eec\u770b\u5230\uff0c\u5149\u662f\u63a8\u8fd9\u4e2a$g$\u7684\u65f6\u7a7a\u590d\u6742\u5ea6\uff0c\u8c8c\u4f3c\u662f$O(n|P|)$\u7684\uff0c\u8fd9\u5f88\u660e\u663e\u65e0\u6cd5\u88ab\u63a5\u53d7~~\u6bd4\u66b4\u529b\u8fd8\u6162\u7684\u5c51\u7b97\u6cd5\u6709\u4ec0\u4e48\u5b58\u5728\u7684\u5fc5\u8981\u5417~~\uff0c\u6240\u4ee5\u8bf4\u6211\u4eec\u5728\u5b9e\u9645\u7684\u4ee3\u7801\u4e2d\u80af\u5b9a\u9700\u8981\u4e00\u4e9b\u4f18\u5316\u3002\n\n## \u4ee3\u7801\u5b9e\u73b0\u90e8\u5206\n\n\u9996\u5148\u6211\u4eec\u770b\u5230$g_{n,j}$\u5728 $j\\leq \\sqrt n$\u7684\u9012\u63a8\u90a3\u91cc\uff0c\u5373$g_{n,j}=g_{n,j-1}-f(P_j)\\times(g_{\\lfloor \\frac{n}{P_j}\\rfloor,j-1}-\\sum_{i=1}^{j-1} f(P_i))$\u3002\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\uff0c\n\n1. \u4ece$j$\u7684\u89d2\u5ea6\u770b\uff0c$g_{n,j}$\u90fd\u662f\u4ece$g_{x,j-1}$\u8f6c\u79fb\u6765\u7684\uff1b\n\n2. \u4ece$n$\u7684\u89d2\u5ea6\u770b\uff0c$g_{n,j}$\u90fd\u662f\u4ece$g_{\\lfloor \\frac{n}{P_j}\\rfloor, y}$\u8f6c\u79fb\u6765\u7684\uff1b\n\n   \u8fd9\u610f\u5473\u7740\u4ec0\u4e48\u5462\uff1f\n\n\u4ece\u7b2c\u4e00\u70b9\u770b\uff0c\u6211\u4eec\u53ef\u4ee5\u538b\u6389\u7b2c\u4e8c\u7ef4\u6570\u7ec4\u3002\n\n\u4ece\u7b2c\u4e8c\u70b9\u770b\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u6c42\u51fa\u6240\u6709\u7684$g_{x}$\uff0c\u53ea\u9700\u8981\u6c42$g_{\\lfloor \\frac{n}{x}\\rfloor}$\u3002\u7531\u6574\u9664\u5206\u5757\u7684\u77e5\u8bc6\u5f97\u5230\uff0c\u8fd9\u4e2a\u4e1c\u897f\u53ea\u6709\u53ef\u80fd\u6709$\\sqrt n$\u79cd\u53d6\u503c\u3002\u4e8e\u662f\u65f6\u95f4\u590d\u6742\u5ea6\u964d\u5230\u4e86$O(\\sqrt n \\times |P|) < O(n)$\uff08\u56e0\u4e3a\u9884\u5904\u7406\u7684\u8d28\u6570\u53ea\u7528\u5230$\\sqrt n$\u5c31\u884c\uff09\u3002\n\n\u4f46\u662f\u7531\u4e8eN\u5f88\u5927\uff0c\u6240\u4ee5\u6211\u4eec\u5149\u628a\u4e0b\u6807\u53d8\u6210$\\lfloor \\frac{n}{x}\\rfloor$\u4e0d\u591f\uff0c\u8fd8\u8981\u518d\u79bb\u6563\u5316\u3002\u5177\u4f53\u7684\uff0c\u6211\u4eec\u628a$\\lfloor \\frac{n}{x}\\rfloor > \\sqrt n$\u548c$\\lfloor \\frac{n}{x}\\rfloor \\leq \\sqrt n$\u4e24\u79cd\u5206\u6210\u4e24\u7c7b\u7f16\u53f7\u6765\u201c\u79bb\u6563\u5316\u201d\uff0c\u8fd9\u6837\u5b50\u5c31\u628a\u7a7a\u95f4\u590d\u6742\u5ea6\u538b\u4e0b\u53bb\u4e86\u3002\n\n\u7531\u4e8e\u5728$g$\u7684\u8f6c\u79fb\u65b9\u7a0b\u4e2d\u6211\u4eec\u662f\u628a\u5404\u4e2a\u8d28\u56e0\u5b50\u62c6\u5f00\u6765\u60f3\u7684\uff0c\u6240\u4ee5\u5728\u4ee3\u7801\u91cc\u9762\u4e5f\u5f97\u8fd9\u4e48\u505a\u3002\u5177\u4f53\u5230\u4e0b\u9762\u7684\u4ee3\u7801\u5c31\u662f$g1$\u548c$g2$\uff0c\u5206\u522b\u4ee3\u8868\u4e00\u6b21\u9879\u548c\u4e8c\u6b21\u9879\u3002\n\n\u5c3d\u7ba1\u6d1b\u8c37\u7684\u6a21\u677f\u9898\u4e0d\u9700\u8981\u7279\u6b8a\u8003\u86512\u8fd9\u4e2a\u552f\u4e00\u7684\u5076\u8d28\u6570\uff0c\u4f46\u662f\u5728\u6709\u4e9b\u9898\u6bd4\u5982[LOJ6053 \u7b80\u5355\u7684\u51fd\u6570](https://loj.ac/problem/6053)\u5c31\u8981\u8003\u8651\u5230\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(n^{1-\\epsilon})$\uff0c\u4e00\u8bf4$O(\\frac{n^{\\frac{3}{4}}}{\\log n})$\uff0c\u53cd\u6b63\u6211\u4e5f\u4e0d\u4f1a\u8bc1QAQ\n\n### \u4ee3\u7801\uff08 [\u6d1b\u8c37\u6a21\u677f\uff08P5325\uff09](https://www.luogu.com.cn/problem/P5325) \uff09\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <cmath>\nnamespace ztd{\n    using namespace std;\n    typedef long long ll;\n    template<typename T> inline T read(T& t) {//fast read\n        t=0;short f=1;char ch=getchar();double d = 0.1;\n        while (ch<'0'||ch>'9') {if (ch=='-') f=-f;ch=getchar();}\n        while (ch>='0'&&ch<='9') t=t*10+ch-'0',ch=getchar();\n        if(ch=='.'){ch=getchar();while(ch<='9'&&ch>='0') t+=d*(ch^48),d*=0.1,ch=getchar();}\n        t*=f;\n        return t;\n    }\n}\nusing namespace ztd;\nconst int maxn = 1e6+7;\nconst int mod = 1e9+7;\nconst ll INV6 = 166666668;//\u9884\u5904\u74066\u7684\u9006\u5143\nll n, sqrn;\ninline ll f(ll x){//\u9898\u9762\u7684f\u51fd\u6570\uff0c\u5176\u5b9a\u4e49\u57df\u53ea\u6709prime^k\n\tx %= mod;\n\treturn x*(x-1)%mod;\n}\nll prime[maxn], sump1[maxn], sump2[maxn], pcnt;\n//sump1\u548csump2\u5206\u522b\u662f\u8d28\u6570\u7684\u524d\u7f00\u548c\u4ee5\u53ca\u4e8c\u6b21\u524d\u7f00\u548c(2^2+3^2+5^2\u2026\u2026)\nbool vis[maxn];\ninline void preprocess_prime(int uplimit){//\u7ebf\u6027\u7b5b\u7b5b\u8d28\u6570\n    for(int i = 2; i <= uplimit; ++i){\n        if(!vis[i]){\n        \tprime[++pcnt] = i;\n        \tsump1[pcnt] = (sump1[pcnt-1]+i) % mod;\n        \tsump2[pcnt] = (sump2[pcnt-1]+1ll*i*i%mod) % mod;\n        } \n        for(int j = 1; j <= pcnt && i*prime[j] <= uplimit; ++j){\n            vis[i*prime[j]] = 1;\n            if(i % prime[j] == 0) break;\n        }\n    }\n}\n\nll g1[maxn], g2[maxn], match1[maxn], match2[maxn], w[maxn], tot;\n//g1,g2\u5373\u4e0a\u6587\u6240\u8bf4\uff0c match1\u548cmatch2\u548cw\u5c31\u662f\u4e0a\u9762\u6240\u8bf4\u7684\u79bb\u6563\u5316\u4e86\u3002\ninline void preprocess_g(){//\u9884\u5904\u7406g\u548c\u79bb\u6563\u5316\n\tll tmp;\n\tfor(ll l = 1, r = 0; l <= n; l = r+1){\n\t\tr = n/(n/l); ++tot;\n\t\tw[tot] = n/l;\n\t\tif(w[tot] < sqrn) match1[n/l] = tot;\n\t\telse match2[n/(n/l)] = tot;\n\t\ttmp = w[tot] % mod;\n\t\tg1[tot] = tmp * (tmp+1) / 2 % mod-1;\n\t\tg2[tot] = tmp * (tmp+1) % mod * (tmp*2+1) % mod * INV6 % mod - 1;\n\t}\n}\ninline void process_g(){//g\u7684\u9012\u63a8\n\tfor(int i = 1; i <= pcnt && prime[i]*prime[i] <= n; ++i){\n\t\tfor(int j = 1; j <= tot && 1ll*prime[i]*prime[i] <= w[j]; ++j){\n\t\t\tll pmt = w[j]/prime[i];\n\t\t\tll tmp = (pmt >= sqrn) ? (match2[n/pmt]) : (match1[pmt]);\n\t\t\tg1[j] = (g1[j] - prime[i] * (g1[tmp]-sump1[i-1]+mod) % mod  % mod + mod) % mod;\n\t\t\tg2[j] = (g2[j] - prime[i]*prime[i]%mod * (g2[tmp]-sump2[i-1]+mod) % mod + mod) % mod;\n\t\t}\n\t}\n}\nll S(ll N, ll y){//\u6700\u540e\u6c42\u7b54\u6848\u7684\n\tif(prime[y] > N) return 0;\n\tll k = (N >= sqrn) ? (match2[n/N]) : (match1[N]);\n\tll prans = (g2[k]-g1[k]+mod - (sump2[y-1]-sump1[y-1])+mod) % mod;//\u6307\u8d28\u6570\u65b9\u9762\u7684\u7ed3\u679c\n\tll cpans = 0;//\u5408\u6570\u65b9\u9762\u7684\u7ed3\u679c\n\tfor(int i = y; i <= pcnt && 1ll * prime[i]*prime[i] <= N; ++i){\n\t\tfor(ll pk = prime[i]; prime[i]*pk <= N; pk *= prime[i]){\n\t\t\tcpans = (cpans + (f(pk) * S(N/pk, i+1) % mod + f(prime[i]*pk)) % mod) %mod;\n\t\t}\n\t}\n\treturn (prans+cpans) % mod;\n}\nsigned main(){\n    read(n);  sqrn = sqrt(n);\n    preprocess_prime(maxn-5);\n    preprocess_g();\n    process_g();\n    cout << (S(n,1) + 1) % mod << '\\n';//\u8fd9\u9053\u9898\u5b9a\u4e49\u4e86f(1)=1\n    return 0;\n}\n```\n\nP.S.1:\u611f\u8c22[\u8fd9\u4f4d](https://www.cnblogs.com/cjyyb/p/9185093.html)\uff0c[\u8fd9\u4f4d](https://www.cnblogs.com/p-b-p-b/p/10807098.html)\uff0c[\u548c\u8fd9\u4f4d](https://www.cnblogs.com/AThousandMoons/p/10827172.html)dalao\u4eec\u7684\u9898\u89e3 \uff0c\u6211\u662f\u9760\u62dc\u8bfb\u8fd9\u4e9b\u5927\u4f6c\u7684\u9898\u89e3\u624d\u52c9\u5f3a\u641e\u61c2\u7684QAQ\n\nP.S.2:\u5982\u679c\u65e5\u8bed\u6c34\u5e73\u597d\u7684\u53ef\u4ee5\u53bb\u653b\u8bfb[min25\u672c\u4eba\u7684\u535a\u5ba2](https://min-25.hatenablog.com/entry/2018/11/11/172216)",
        "postTime": 1602301999,
        "uid": 134635,
        "name": "zimindaada",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5325 \u3010\u3010\u6a21\u677f\u3011Min_25\u7b5b\u3011"
    },
    {
        "content": "\u4e00\u79cd\u4e9a\u7ebf\u6027\u590d\u6742\u5ea6\u6c42\u79ef\u6027\u51fd\u6570\u524d\u7f00\u548c\u7684\u7b5b\u6cd5\u3002\n\n\u9002\u7528\u6761\u4ef6\uff1a\n\n-  $f(p)$ \u4e3a\u591a\u9879\u5f0f\uff08\u9664\u4ee3\u7801\u5916\uff0c\u672c\u6587 $p$ \u5747\u6307\u8d28\u6570\uff09\n\n- $f(p^k)$ \u4fbf\u4e8e\u8ba1\u7b97\n\n\u6211\u4eec\u4ee5 LuoguP5325 \u4e3a\u4f8b\u7b80\u5355\u4ecb\u7ecd\u3002\n\n\u6c42 $\\sum\\limits_{i=1}^nf(i)$\uff0c\u5176\u4e2d $f$ \u662f\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\uff0c\u4e14 $f(p^k)=p^k(p^k-1)$\u3002$n\\leqslant10^{10}$\u3002\n\nMin_25 \u7b5b\u7684\u4e3b\u8981\u601d\u60f3\u662f\u628a\u8981\u6c42\u7684\u524d\u7f00\u548c\u8f6c\u5316\u4e3a\u8d28\u6570\u548c\u975e\u8d28\u6570\u4e24\u90e8\u5206\u8fdb\u884c\u8ba1\u7b97\u3002\n\n\n\n##### \u7b2c\u4e00\u90e8\u5206\n\n\u5bf9\u4e8e\u8d28\u6570\u90e8\u5206\uff0c\u6211\u4eec\u5b9a\u4e49\u4ee5\u4e0b\u51fd\u6570\uff1a\n$$\ng(n,j)=\\sum\\limits_{i=2}^n[i\\ \\text{is a prime or}\\ \\text{minp}(i)>p_j]i^k\n$$\n\u5176\u4e2d\uff0c$p_j$ \u8868\u793a\u7b2c $j$ \u4e2a\u8d28\u6570\uff0c$\\text{minp}(i)$ \u8868\u793a $i$ \u7684\u6700\u5c0f\u8d28\u56e0\u5b50\u3002\u7ffb\u8bd1\u6210\u4e2d\u6587\u5c31\u662f\u5bf9\u6240\u6709\u8d28\u6570\u548c\u6700\u5c0f\u8d28\u56e0\u5b50\u5927\u4e8e\u7b2c $j$ \u4e2a\u8d28\u6570\u7684 $k$ \u6b21\u5e42\u6c42\u548c\u3002\n\n\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\uff0c\u5982\u679c\u6211\u4eec\u6c42\u7684 $f(p)$ \u662f\u4e00\u4e2a\u591a\u9879\u5f0f\uff0c\u5c31\u62c6\u6210\u5355\u9879\u5f0f\u3002\u6bd4\u5982\u8fd9\u9898\u5c31\u662f $p^2-p$\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u8ba1\u7b97 $g_1$ \u548c $g_2$ \u5206\u522b\u4ee3\u8868\u4e00\u6b21\u9879\u7684\u548c\u4ee5\u53ca\u4e8c\u6b21\u9879\u7684\u548c\uff0c\u8fd9\u91cc\u5148\u4e0d\u7ba1\u7cfb\u6570\uff0c\u4f1a\u5728\u540e\u9762\u7b97\u4e0a\u3002\n\n\u6211\u4eec\u8003\u8651\u8ba1\u7b97 $g(n,j)$\uff0c\u8fd9\u662f\u4e00\u4e2a\u6bd4\u8f83\u660e\u663e\u7684\u53ef\u4ee5\u9012\u63a8\u7684\u5f0f\u5b50\uff0c\u4e8e\u662f\u6211\u4eec\u5c1d\u8bd5\u4ece $g(n,j-1)$ \u9012\u63a8\u5230 $g(n,j)$\u3002\n\n\u53d1\u73b0 $g(n,j-1)$ \u548c $g(n,j)$ \u5b9e\u9645\u4e0a\u53ea\u5dee\u4e86\u6700\u5c0f\u8d28\u56e0\u5b50\u4e3a $p_j$\uff08\u4e0d\u5305\u62ec $p_j$ \u672c\u8eab\uff09\u7684\u51fd\u6570\u503c\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u51cf\u6389\u8fd9\u4e9b\u591a\u51fa\u6765\u7684\u503c\u5c31\u53ef\u4ee5\u4e86\uff0c\u4e0b\u9762\u5148\u7ed9\u51fa\u5f0f\u5b50\uff1a\n$$\ng(n,j)=g(n,j-1)-p_j^k\\left(g(\\frac{n}{p_j},j-1)-g(p_{j-1},j-1)\\right)\n$$\n\u6ce8\u610f\u4e00\u4e0b\u8fd9\u91cc\u9664\u6cd5\u4e3a\u4e86\u7f8e\u89c2\u6ca1\u6709\u5199\u53d6\u6574\u3002\u6211\u4eec\u53d1\u73b0 $i^k$ \u662f\u4e00\u4e2a\u5b8c\u5168\u79ef\u6027\u51fd\u6570\uff0c\u6240\u4ee5\u5bf9\u4e8e\u6240\u6709\u6700\u5c0f\u8d28\u56e0\u5b50\u4e3a $p_j$ \u7684\u6570\uff0c\u6211\u4eec\u90fd\u53ef\u4ee5\u63d0\u4e00\u4e2a $p_j$ \u51fa\u6765\u800c\u4e14\u4e0d\u9700\u8981\u7ba1\u662f\u5426\u4e92\u8d28\uff08\u4e5f\u5c31\u662f\u5269\u4e0b\u7684\u4ecd\u6709 $p_j$ \u8fd9\u4e2a\u56e0\u5b50\uff09\uff0c\u7136\u540e\u5269\u4e0b\u7684\u6570\u4e00\u5b9a\u5c0f\u4e8e\u7b49\u4e8e $\\frac{n}{p_j}$ \u4e14\u6700\u5c0f\u8d28\u56e0\u5b50\u4ecd\u5927\u4e8e\u7b49\u4e8e $p_j$\uff0c\u6240\u4ee5\u5c31\u662f $g(\\frac{n}{p_j},j-1)$\u3002\u7136\u540e\u53d1\u73b0\u6240\u6709\u5c0f\u4e8e $p_j$ \u7684\u8d28\u6570\u90fd\u88ab\u591a\u51cf\u6389\u4e86\uff0c\u6240\u4ee5\u518d\u7528 $g(p_{j-1},j-1)$\uff0c\u5373\u6240\u6709\u5c0f\u4e8e\u7b49\u4e8e $p_{j-1}$ \u7684\u8d28\u6570\u7684\u5e42\u6b21\u548c\u3002\n\n\u6211\u4eec\u6ce8\u610f\u5230\u5c0f\u4e8e\u7b49\u4e8e $n$ \u7684\u5408\u6570\uff0c\u5b83\u7684\u6700\u5c0f\u8d28\u56e0\u5b50\u4e00\u5b9a\u5c0f\u4e8e\u7b49\u4e8e $\\sqrt n$\uff0c\u5373\u5982\u679c $p_j>\\sqrt n$ \u90a3\u4e48 $g(n,j)=g(n,j-1)$\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u679a\u4e3e\u5c0f\u4e8e\u7b49\u4e8e $\\sqrt n$ \u7684\u8d28\u6570\u3002\u7136\u540e\u6211\u4eec\u53d1\u73b0 $g(p_{j-1},j-1)$ \u6c42\u7684\u5c31\u662f\u6240\u6709\u5c0f\u4e8e\u7b49\u4e8e $p_{j-1}$ \u7684\u8d28\u6570\u7684\u5e42\u6b21\u548c\uff0c\u800c\u4e14 $p_{j-1}$ \u662f\u5c0f\u4e8e\u7b49\u4e8e $\\sqrt n$ \u7684\u3002\u6240\u4ee5\u6211\u4eec\u4e00\u5f00\u59cb\u7ebf\u6027\u7b5b\u5230 $\\sqrt n$ \u6c42\u51fa\u6bcf\u4e2a\u8d28\u6570\u7684\u8fd9\u4e2a\u4e1c\u897f\uff0c\u6211\u4eec\u8bbe\u5b83\u4e3a $sp(j-1)$\u3002\u7136\u540e\u5bf9\u4e8e $1$ \u5230 $n$ \u7684 $k$ \u6b21\u65b9\u548c\uff0c\u4e5f\u5373\u662f $g(n,\\text{maxp}(n))$\uff0c\u5176\u4e2d $p_{\\text{maxp}(n)}$ \u662f\u5c0f\u4e8e\u7b49\u4e8e $n$ \u7684\u6700\u5927\u8d28\u6570\u3002\n\n\u4f46\u662f\u8fd9\u6837\u679a\u4e3e\u91cf\u8fd8\u662f\u592a\u5927\uff0c\u6211\u4eec\u53d1\u73b0\u4e00\u4e2a\u5f88\u91cd\u8981\u7684\u5f0f\u5b50\uff1a$\\lfloor\\frac{\\lfloor\\frac{n}{a}\\rfloor}{b}\\rfloor=\\lfloor\\frac{n}{ab}\\rfloor$\u3002\u6240\u4ee5\u6240\u6709\u80fd\u7528\u5230\u7684\u7b2c\u4e00\u4e2a\u6570\u503c\u90fd\u5f62\u5982 $\\lfloor\\frac{n}{a}\\rfloor$\uff0c\u800c\u4f17\u6240\u5468\u77e5\u8fd9\u6837\u7684\u6570\u53ea\u6709 $O(\\sqrt n)$ \u4e2a\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa\u8fd9\u6837\u7684 $g$ \u5c31\u53ef\u4ee5\u4e86\u3002\u5177\u4f53\u5b9e\u73b0\u56e0\u4e3a\u4e0b\u6807\u8fd8\u662f\u5f88\u5927\uff0c\u7528 `map` \u548c `unordered_map` \u90fd\u6bd4\u8f83\u6162\u3002\u6839\u636e\u90a3\u4e2a $O(\\sqrt n)$ \u7684\u8bc1\u660e\uff0c\u6211\u4eec\u624b\u52a8\u79bb\u6563\u5316\u4e00\u4e0b\uff1a\u8bb0 `id1[x]` \u4e3a $x$ \u79bb\u6563\u5316\u7684\u4e0b\u6807\uff0c`id2[x]` \u4e3a $\\lfloor\\frac{n}{x}\\rfloor$ \u7684\u4e0b\u6807\uff0c\u53ef\u4ee5\u770b\u4ee3\u7801\u3002\n\n\u8fd9\u4e00\u90e8\u5206\u7684\u590d\u6742\u5ea6\u662f $O(\\frac{n^{\\frac{3}{4}}}{\\log n})$ \u7684\u3002\n\n\n\n##### \u7b2c\u4e8c\u90e8\u5206\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u8ba1\u7b97\u6240\u6709\u6570\u7684\u548c\uff0c\u8bb0 $s(n,j)$ \u4e3a $\\sum\\limits_{i=2}^n[\\text{minp}(i)>j]f(i)$\uff0c\u5373\u6240\u6709\u6700\u5c0f\u8d28\u56e0\u5b50\u5927\u4e8e $p_j$ \u7684 $f$ \u7684\u548c\u3002\n\n\u6211\u4eec\u4f9d\u65e7\u5c1d\u8bd5\u9012\u63a8\uff0c\u9996\u5148\uff0c\u6211\u4eec\u628a\u6240\u6709\u5927\u4e8e \u8d28\u6570\u7684\u51fd\u6570\u548c $\\sum g(n,\\text{maxp}(n))-sp(j)$ \u7b97\u4e0a\uff08\u8fd9\u91cc\u5e26\u4e0a\u7cfb\u6570\uff0c\u6bd4\u5982\u677f\u5b50\u9898\u5c31\u662f $g2(n,\\text{maxp}(n))-sp2(j)-(g1(n,\\text{maxp}(n))-sp1(j))$ \uff0c\u90a3\u4e48\u5269\u4e0b\u5408\u6570\u90e8\u5206\u679a\u4e3e\u63d0\u51fa\u4e00\u4e2a\u6700\u5c0f\u8d28\u56e0\u5b50\uff0c\u5148\u770b\u5f0f\u5b50\uff1a\n$$\ns(n,j)=\\sum(g(n,\\text{maxp}(n))-sp(j))+\\sum\\limits_{c>j,p_c^e\\leqslant n}f(p_c^e)\\left(s(\\frac{n}{p_c^e},c)+[e\\not=1]\\right)\n$$\n\u56e0\u4e3a\u8fd9\u4e00\u6b21\u5e76\u4e0d\u662f\u5b8c\u5168\u79ef\u6027\u51fd\u6570\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u4e00\u6b21\u628a\u6700\u5c0f\u8d28\u56e0\u5b50\u63d0\u5168\uff0c\u8fd9\u6837\u7684\u8bdd\u5269\u4e0b\u7684\u6700\u5c0f\u8d28\u56e0\u5b50\u90fd\u5927\u4e8e $p_c$\uff0c\u7136\u540e\u56e0\u4e3a\u6211\u4eec\u6ca1\u7b97 $1$\uff0c\u6240\u4ee5\u5f53 $e\\not=1$ \u7684\u65f6\u5019 $f(p_c^e)$ \u6ca1\u6709\u7b97\u8fdb\u53bb\uff0c\u5f53 $e=1$ \u65f6\u4f1a\u5728\u524d\u9762\u8d28\u6570\u90e8\u5206\u7b97\u5230\u3002\n\n\u5219 $s(n,0)+f(1)$ \u5373\u4e3a\u7b54\u6848\u3002\u8fd9\u91cc\u76f4\u63a5\u9012\u5f52\u8ba1\u7b97\uff0c\u4e0d\u9700\u8981\u8bb0\u5fc6\u5316\u3002\n\n\u8fd9\u4e00\u90e8\u5206\u7684\u590d\u6742\u5ea6\u636e\u8bf4\u662f $O(n^{1-\\epsilon})$ \u7684\uff0c\u5373\u5927\u4e8e\u4efb\u4f55\u4e00\u4e2a $O(n^k),k<1$\uff0c\u4f46\u662f\u5e38\u6570\u5f88\u5c0f\u3002\n\n\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll const p=1e9+7,inv2=500000004,inv6=166666668;\nll n,pr[100005],cnt,sp1[100005],sp2[100005],tot,bas[300005],g1[300005],\ng2[300005],sqr;\nint id1[100005],id2[100005];\nbool flag[100005];\ninline ll mod(ll const &x){return x>=p?x-p:x;}\nll s(ll i,int j)\n{\n    if(pr[j]>=i)return 0;\n    int t=(i<=sqr)?id1[i]:id2[n/i];\n    if(sp1[j]<0||sp2[j]<0)exit(-1);\n    ll res=(g2[t]-sp2[j]-(g1[t]-sp1[j])+p+p)%p;//part1:\u8d28\u6570\u90e8\u5206\n    for(int c=j+1;c<=cnt&&pr[c]*pr[c]<=i;c++)//part2 \u6ce8\u610f\u8fd9\u91cc\u4f9d\u65e7\u53ea\u9700\u8981\u6d88\u53bb sqrti \u7684\u6700\u5c0f\u8d28\u56e0\u5b50\n    {\n        ll now=pr[c];\n        for(int e=1;now<=i;e++,now*=pr[c])\n        {\n            ll tmp=now%p;\n            res=(res+tmp*(tmp-1+p)%p*(s(i/now,c)+(int)(e!=1)))%p;\n        }\n    }\n    return res;\n}\nint main()\n{\n    scanf(\"%lld\",&n);\n    sqr=sqrt(n);\n    for(ll i=2;i<=sqr;i++)//get prime\n    {\n        if(!flag[i])pr[++cnt]=i;\n        for(int j=1;j<=cnt&&i*pr[j]<=sqr;j++)\n        {\n            flag[i*pr[j]]=1;\n            if(!(i%pr[j]))break;\n        }\n    }\n    for(int i=1;i<=cnt;i++)//\u8ba1\u7b97sp\n        sp1[i]=mod(sp1[i-1]+pr[i]),\n        sp2[i]=mod(sp2[i-1]+pr[i]*pr[i]%p);\n    for(ll l=1,r;l<=n;l=r+1)\n    {//\u8ba1\u7b97 g(x,0)\uff0c\u56e0\u4e3a g(n,j) \u603b\u662f\u7531 g(xxx,j-1) \u63a8\u51fa\u800c\u4e14\u540e\u9762\u53ea\u9700\u8981 g(n,maxp(n)) \u6240\u4ee5\u6eda\u52a8\u6389\u4e00\u7ef4\n        r=n/(n/l);\n        bas[++tot]=n/l;//\u8fd9\u4e00\u6b21\u8ba1\u7b97 g(n/l,0) \u4e5f\u5c31\u662f 2 \u5230 n/l \u7684\u5e42\u6b21\u548c\n        g1[tot]=bas[tot]%p;//\u56e0\u4e3a\u51cf\u5c11\u53d6\u6a21\u6240\u4ee5\u6682\u65f6\u501f\u7528\u4e00\u4e0b\u8fd9\u4e2a\u6570\n        g2[tot]=(g1[tot]*(g1[tot]+1)%p*(2*g1[tot]+1)%p*inv6+p-1)%p;\n        g1[tot]=mod((g1[tot]+1)*g1[tot]%p*inv2%p+p-1);\n        if(bas[tot]<=sqr)id1[bas[tot]]=tot;\n        else id2[l]=tot;//\u6b64\u65f6\u4e00\u5b9a\u6709 l=r\n    }\n    for(int j=1;j<=cnt;j++)//\u4e3a\u4e86\u548c\u5199\u7684\u5f0f\u5b50\u4e00\u6837\u6362\u4e86\u4e00\u4e0b\u5185\u5916\u5c42\u53d8\u91cf\n        for(int i=1;i<=tot&&pr[j]*pr[j]<=bas[i];i++)//\u9012\u63a8 g(bas[i],j)\n        {\n            ll t=bas[i]/pr[j];\n            t=(t<=sqr)?id1[t]:id2[n/t];//\u627e\u5230 bas[i]/pr[j] \u5bf9\u5e94\u7684\u4e0b\u6807\n            g1[i]=mod(g1[i]-pr[j]*(g1[t]-sp1[j-1]+p)%p+p);\n            g2[i]=mod(g2[i]-pr[j]*pr[j]%p*(g2[t]-sp2[j-1]+p)%p+p);\n        }\n    printf(\"%lld\",mod(s(n,0)+1));\n    return 0;\n}\n```\n\n",
        "postTime": 1594725876,
        "uid": 96912,
        "name": "AzusaCat",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5325 \u3010\u3010\u6a21\u677f\u3011Min_25\u7b5b\u3011"
    },
    {
        "content": "\u9898\u610f\uff1a\u5b9a $f(n)$ \u4e3a\u79ef\u6027\u51fd\u6570\u5e76\u4e14\n\n$$f(p^k)=p^{2k}-p^k$$\n\n\u6c42 $f(n)$ \u7684\u524d\u7f00\u548c\u3002\n\n---\n\n\u6211\u4eec\u5148\u5f31\u5316\u4e00\u4e0b\u95ee\u9898\uff0c\u5982\u4f55\u7edf\u8ba1 $f(n)$ \u5728\u524d $p$ \u4e2a\u8d28\u6570\u7684\u524d\u7f00\u548c\uff1f\n\n\u89c2\u5bdf\u5230 $f(n)$ \u5728\u8d28\u6570\u5e42\u5904\u4e3a\u591a\u9879\u5f0f\uff0c\u8003\u8651\u5bf9\u51fd\u6570\u9010\u9879\u7edf\u8ba1\u524d\u7f00\u548c\u3002\u90a3\u4e48\u6211\u4eec\u672c\u8d28\u60f3\u6c42\n\n$$S(n)=\\sum_{i=1}^n[i\\in\\mathbb P]i^T$$\n\n\u5176\u4e2d $\\mathbb{P}(i)$ \u4e3a $i$ \u7684\u6700\u5c0f\u8d28\u56e0\u5b50\u3002\u53d1\u73b0\u968f\u7740 $\\mathbb P(i)$ \u7684\u589e\u5927\uff0c\u66f4\u591a $i^T$ \u4f1a\u88ab \u201c\u7b5b\u201d \u8d70\u3002\u8bbe $p_i$ \u4e3a\u7b2c $i$ \u8d28\u6570\uff0c\u4e8e\u662f\u8003\u8651\u5b9a\u4e49\n\n$$S(n,j)=\\sum_{i=1}^n[i\\in\\mathbb P\\lor\\mathbb P(i)>p_j]i^T$$\n\n\u5f53 $j\\rightarrow\\infty$ \u5219 $\\max(n:S(n,j)=S(n))\\rightarrow\\infty$\u3002\n\n\u4ece\u5b9a\u4e49\u53ef\u5f97\u8fb9\u754c\uff1a\n\n$$S(n,0)=\\sum_{i=2}^ni^T$$\n\n\u8003\u8651\u5982\u4f55\u4ece $j-1$ \u8f6c\u79fb\u5230 $j$\u3002\u7b5b\u8d70\u7684\u5408\u6570\u5fc5\u987b\u6709\u6700\u5927\u8d28\u56e0\u6570 **\u7b49\u4e8e** $p_j$\u3002\u5219\n\n$$S(n,j)=S(n,j-1)-p_j^T(S(\\frac{n}{p_j},j-1)-S(p_{j-1},j-1))$$\n\n\u5176\u4e2d $S(n,j-1)$ \u4e3a\u539f\u6709\u7684\u8d28\u6570\u6216\u8005\u5408\u6570\u8d21\u732e\uff1b$S(\\frac{n}{p_j},j-1)-S(p_{j-1},j-1)$ \u4e3a\u8fd9\u4e2a\u4e1c\u897f\n\n$$\\sum_{i=1}^n[\\mathbb P(i)>p_j]i^T$$\n\n\u6ce8\u610f\uff0c\u6211\u4eec\u5fc5\u987b\u51cf\u53bb $[i\\in\\mathbb P]$ \u7684\u8d21\u732e\u624d\u80fd\u771f\u4fdd\u8bc1\u7b5b\u8d70\u7684\u6700\u5c0f\u8d28\u56e0\u5b50\u4e3a $p_j$\u3002\n\n\u901a\u8fc7\u5408\u5e76\u82e5\u5e72\u4e2a $T$ \u7684 $S$ \u503c\uff0c\u53ef\u4ee5\u5f97\u5230 $f$ \u5728\u8d28\u6570\u5904\u7684\u524d\u7f00\u548c\u3002\n\n\u4e8e\u662f\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u8ba1\u7b97 $S(n)$ \u4efb\u610f\u5904\u7684\u503c\uff0c\u8003\u8651\u5982\u4f55\u7528\u6765\u8ba1\u7b97\u7b54\u6848\u3002\u5148\u5047\u8bbe $1$ \u4e0d\u5b58\u5728\u3002\n\n$$\\sum_{i=2}^nf(i)=\\sum_{i=2}^n[i\\in\\mathbb P]f(i)+\\sum_{i=2}^n[i\\notin\\mathbb P]f(i)$$\n\n\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u5408\u6570\u91cc\u7684\u6700\u5c0f\u8d28\u56e0\u5b50\uff1a\n\n$$\\sum_{i=2}^nf(i)=\\sum_{i=2}^n[i\\in\\mathbb P]f(i)+\\sum_{p\\in\\mathbb P}\\sum_{h=2}f(p^h)\\sum_{j=1,\\mathbb P(j)>p}^{\\frac{n}{p^h}}f(j)$$\n\n\u73b0\u5728\u518d\u6b21\u8003\u8651 dp\uff0c\u4ecd\u7136\u6309\u7167\u6700\u5c0f\u8d28\u56e0\u5b50\u5927\u4e8e $p_j$ \u8fdb\u884c\u8ba1\u7b97\u3002\u5b9a\n\n$$R(n,j)=\\sum_{i=2}^n[\\mathbb P(i)>p_j]f(i)$$\n\n\u6211\u4eec\u5e0c\u671b\u6c42 $R(n,0)$\uff0c\u5176\u4e2d\u8fb9\u754c\u60c5\u51b5\u4e3a $R(n,j)=0\\iff p_j>n$\n\n\u5219\u81ea\u7136\u6709\n\n$$R(n,j)=\\sum_{i=p_j+1}^n[i\\in\\mathbb P]f(i)+\\sum_{p\\in\\mathbb P\\cup[p_j+1,\\infty)}^n\\sum_{h=1}f(p^h)\\sum_{i=1+[h=1]}^{\\frac{n}{p^h}}[\\mathbb P(i)>p]f(i)$$\n\n\u5176\u4e2d\u5fc5\u987b\u6709 $i=1+[h=1]$ \u800c\u4e0d\u662f $i=1$\uff0c\u56e0\u4e3a\u5982\u679c $h=1$ \u4e0d\u5f97\u7b97 $i=1$ \u7684\u8d21\u732e\uff08\u5426\u5219 $ip^h$ \u4e3a\u8d28\u6570\uff0c\u5df2\u7ecf\u88ab\u5de6\u8fb9\u8d21\u732e\u8ba1\u7b97\uff09\uff0c\u5982\u679c $h\\neq 1$ \u5fc5\u987b\u8ba1\u7b97\uff08\u5426\u5219 $ip^h$ \u662f\u5408\u6570\u4f46\u662f\u6ca1\u88ab\u7b97\u4e0a\uff09\u3002\n\n\u6211\u4eec\u4e5f\u5fc5\u5b9a\u6709 $[\\mathbb P(i)>p]$\uff0c\u56e0\u4e3a\u5df2\u7ecf\u8ba1\u7b97\u4e0a $i$ \u91cc $p$ \u5f53\u8d28\u56e0\u5b50\u7684\u6574\u4f53\u8d21\u732e\uff0c\u4e0b\u4e00\u4e2a\u8d28\u56e0\u5b50\u4e0d\u5f97\u542b\u6709 $p$\u3002\n\n\u5229\u7528 $R(n,j)$ \u8868\u793a\uff1a\n\n$$R(n,j)=\\sum_{i=p_j+1}^n[i\\in\\mathbb P]f(i)+\\sum_{r=j+1}\\sum_{h=1}f(p^h_r)\\sum_{i=1+[h=1]}^{\\frac{n}{p_r^h}}[\\mathbb P(i)>p_r]f(i)$$\n$$R(n,j)=\\sum_{i=p_j+1}^n[i\\in\\mathbb P]f(i)+\\sum_{r=j+1}\\sum_{h=1}f(p^h_r)(R(\\frac{n}{p^h_r},r)+[h\\neq 1])$$\n$$R(n,j)=S(n)-S(p_j)+\\sum_{r=j+1}\\sum_{h=1}f(p^h_r)(R(\\frac{n}{p^h_r},r)+[h\\neq 1])$$\n\n\u4ed4\u7ec6\u89c2\u5bdf $n$ \u6c38\u8fdc\u4e3a $N/x$ \u7684\u5f62\u5f0f\uff0c\u7136\u540e\u53ea\u6709 $O(\\sqrt N)$ \u4e2a\u672c\u8d28\u4e0d\u540c\u7684 $N/x$\uff0c\u4e8e\u662f\u5904\u7406 $R$ \u548c $S$ \u7684\u65f6\u5019\u53ea\u5728\u8fd9\u4e9b\u5904\u8ba1\u7b97\u3002\n\n\u518d\u4ed4\u7ec6\u89c2\u5bdf\u53d1\u73b0 $np_j\\le N$\uff0c\u5f97\u5230 $p_j\\le O(\\sqrt N)$\uff0c\u53ef\u4ee5\u9884\u5904\u7406 $S(p_j)$\u3002\n\n\u505a\u5b8c\u5566\uff01\n\n```cpp\n// writer: w33z8kqrqk8zzzx33\n#include <bits/stdc++.h>\nusing namespace std;\n\n// begin fast read template by CYJian (source: https://www.luogu.com.cn/paste/i11c3ppx)\n\nnamespace io {\n\tconst int __SIZE = (1 << 21) + 1;\n\tchar ibuf[__SIZE], *iS, *iT, obuf[__SIZE], *oS = obuf, *oT = oS + __SIZE - 1, __c, qu[55]; int __f, qr, _eof;\n\t#define Gc() (iS == iT ? (iT = (iS = ibuf) + fread (ibuf, 1, __SIZE, stdin), (iS == iT ? EOF : *iS ++)) : *iS ++)\n\tinline void flush () { fwrite (obuf, 1, oS - obuf, stdout), oS = obuf; }\n\tinline void gc (char &x) { x = Gc(); }\n\tinline void pc (char x) { *oS ++ = x; if (oS == oT) flush (); }\n\tinline void pstr (const char *s) { int __len = strlen(s); for (__f = 0; __f < __len; ++__f) pc (s[__f]); }\n\tinline void gstr (char *s) { for(__c = Gc(); __c < 32 || __c > 126 || __c == ' ';)  __c = Gc();\n\t\tfor(; __c > 31 && __c < 127 && __c != ' '; ++s, __c = Gc()) { *s = __c; } *s = 0; }\n\ttemplate <class I> inline bool gi (I &x) { _eof = 0;\n\t\tfor (__f = 1, __c = Gc(); (__c < '0' || __c > '9') && !_eof; __c = Gc()) { if (__c == '-') __f = -1; _eof |= __c == EOF; }\n\t\tfor (x = 0; __c <= '9' && __c >= '0' && !_eof; __c = Gc()) { x = x * 10 + (__c & 15), _eof |= __c == EOF; x *= __f; } return !_eof; }\n\ttemplate <class I> inline void print (I x) { if (!x) pc ('0'); if (x < 0) pc ('-'), x = -x;\n\t\twhile (x) { qu[++ qr] = x % 10 + '0',  x /= 10; } while (qr) pc (qu[qr --]); }\n\tstruct Flusher_ {~Flusher_(){flush();}}io_flusher_;\n} using io::pc; using io::gc; using io::pstr; using io::gstr; using io::gi; using io::print;\n\n// end fast read template by CYJian\n\n#define iter(i, a, b) for(int i=(a); i<(b); i++)\n#define rep(i, a) iter(i, 0, a)\n#define rep1(i, a) iter(i, 1, (a)+1)\n#define log(a) cerr<<\"\\033[32m[DEBUG] \"<<#a<<'='<<(a)<<\" @ line \"<<__LINE__<<\"\\033[0m\"<<endl\n#define all(a) a.begin(), a.end()\n#define fi first\n#define se second\n#define pb push_back\n#define mp make_pair\n \nusing ll=long long;\nusing pii=pair<int, int>;\n#define int ll\nconst int MOD = 1000000007;\n\nconst int msqn = 100100;\nbool isc[msqn+5];\nll ps1[msqn+5], ps2[msqn+5];\nint primes[10000]; int prc, c;\nvoid sieve(int M) {\n\tisc[0]=isc[1]=1;\n\titer(i, 2, M+1) {\n\t\tif(!isc[i]) {\n\t\t\tprimes[++prc] = i;\n\t\t\tps1[prc] = (ps1[prc-1] + i) % MOD;\n\t\t\tps2[prc] = (ps2[prc-1] + 1ll * i * i) % MOD;\n\t\t}\n\t\tif(!(i&1)&&(i<<1)<=M) {\n\t\t\tisc[i<<1] = 1;\n\t\t\tcontinue;\n\t\t}\n\t\tfor(register int j=1; j<=prc; j+=5) {\n\t\t\tif(primes[j] * i > M+1) break;\n\t\t\tisc[primes[j] * i] = 1;\n\t\t\tif(!(i % primes[j]) || !primes[j+1] || (primes[j+1] * i > M+1)) break;\n\t\t\tisc[primes[j+1] * i] = 1;\n\t\t\tif(!(i % primes[j+1]) || !primes[j+2] || (primes[j+2] * i > M+1)) break;\n\t\t\tisc[primes[j+2] * i] = 1;\n\t\t\tif(!(i % primes[j+2]) || !primes[j+3] || (primes[j+3] * i > M+1)) break;\n\t\t\tisc[primes[j+3] * i] = 1;\n\t\t\tif(!(i % primes[j+3]) || !primes[j+4] || (primes[j+4] * i > M+1)) break;\n\t\t\tisc[primes[j+4] * i] = 1;\n\t\t}\n\t}\n}\n\nconstexpr int threeI = 333333336;\n\nnamespace PCF {\n\tll ans1[2*msqn+5], ans2[2*msqn+5], ind1[2*msqn+5], ind2[2*msqn+5], w[2*msqn+5], tot = 0, sqr, NN;\n\tvoid init(ll n) {\n\t\tsqr = sqrt(n);\n\t\ttot = 0;\n\t\tfor(ll l = 1, r; l <= n; l = r + 1) {\n\t\t\tr = n / (n / l);\n\t\t\tw[++tot] = n / l;\n\t\t\tans1[tot] = w[tot] % MOD;\n\t\t\tans2[tot] = ((ans1[tot] * (ans1[tot] + 1) / 2 % MOD) * (2 * ans1[tot] + 1) % MOD * threeI + MOD - 1) % MOD;\n\t\t\tans1[tot] = ((ans1[tot] * (ans1[tot] + 1) / 2) + MOD - 1) % MOD;\n\t\t\tif(n / l <= sqr) ind1[n / l] = tot;\n\t\t\telse ind2[r] = tot;\n\t\t}\n\t\trep1(i, prc)\n\t\t\tfor(int j = 1; j <= tot && 1ll * primes[i] * primes[i] <= w[j]; j++) {\n\t\t\t\tll v = w[j] / primes[i];\n\t\t\t\tll k = (v <= sqr) ? ind1[v] : ind2[n / v];\n\t\t\t\tans1[j] = (MOD + ans1[j] - primes[i] * (MOD + ans1[k] - ps1[i-1]) % MOD) % MOD;\n\t\t\t\tans2[j] = (MOD + ans2[j] - primes[i] * primes[i] % MOD * (MOD + ans2[k] - ps2[i-1]) % MOD) % MOD;\n\t\t\t\tassert(0 <= ans1[j] && ans1[j] < MOD);\n\t\t\t\tassert(0 <= ans2[j] && ans2[j] < MOD);\n\t\t\t}\n\t\tNN = n;\n\t}\n\tll S(ll n, ll x) {\n\t\tif(primes[x] >= n) return 0;\n\t\tll k = (n <= sqr) ? ind1[n] : ind2[NN / n];\n\t\tll ans = (ans2[k] - ans1[k] + MOD - ps2[x] + ps1[x] + MOD) % MOD;\n\t\tfor(int i = x+1; i <= prc && primes[i] * primes[i] <= n; i ++ ) {\n\t\t\tll pe = primes[i];\n\t\t\tfor(int e = 1; pe <= n; e++, pe = pe * primes[i]) {\n\t\t\t\tll v = pe % MOD;\n\t\t\t\tans = (ans + v * (v - 1) % MOD * (S(n/pe, i) + (e != 1))) % MOD;\n\t\t\t}\n\t\t}\n\t\treturn ans;\n\t}\n}\n\nsigned main() {\n    ios_base::sync_with_stdio(false); cin.tie(0);\n    sieve(msqn);\n    ll n; gi(n);\n    assert(n <= (ll)(1e10+1));\n    PCF::init(n);\n    print((PCF::S(n, 0) + 1) % MOD); \n}\n```",
        "postTime": 1612754209,
        "uid": 220037,
        "name": "w33z8kqrqk8zzzx33",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5325 \u3010\u3010\u6a21\u677f\u3011Min_25\u7b5b\u3011"
    }
]
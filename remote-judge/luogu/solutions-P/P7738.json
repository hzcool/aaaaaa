[
    {
        "content": "> [\u9898\u76ee\u4f20\u9001\u95e8\u3002](https://www.luogu.com.cn/problem/P7738)\n>\n> \u9898\u610f\u7b80\u8ff0\uff1a\u7ed9\u51fa $n$ \u4e2a $256$ \u4f4d\u4e8c\u8fdb\u5236\u6570\uff08\u968f\u673a\u751f\u6210\uff09$a_i$\u3002\u5bf9\u4e8e $m$ \u4e2a\u8be2\u95ee\uff0c\u6bcf\u6b21\u7ed9\u51fa\u4e00\u4e2a $256$ \u4f4d\u4e8c\u8fdb\u5236\u6570 $x$ \u548c\u4e00\u4e2a\u5341\u8fdb\u5236\u6570 $k$\uff0c\u6c42\u662f\u5426\u5b58\u5728 $a_i$ \u4f7f\u5f97 $x,a_i$ \u4e0d\u540c\u4f4d\u6570\u4e2a\u6570\u4e0d\u5927\u4e8e $k$\u3002\n\n\u6ce8\u610f\u5230\u8fd9\u4e2a $k\\leq 15$\uff0c\u4e00\u5b9a\u662f\u672c\u9898\u7684\u7a81\u7834\u70b9\u3002\u518d\u6839\u636e $16^2=256$ \u4e0e\u62bd\u5c49\u539f\u7406\uff0c\u4e0d\u96be\u60f3\u5230\u5c06 $256$ \u4f4d\u7684\u4e8c\u8fdb\u5236\u6570\u770b\u6210 $16$ \u4f4d\u7684 $65536$ \u8fdb\u5236\u6570\u3002\u8fd9\u6837\u4e00\u6765\uff0c\u5982\u679c $x$ \u4e0e $a_i$ \u5728\u4e8c\u8fdb\u5236\u4e0b\u4e0d\u540c\u4f4d\u6570\u4e2a\u6570\u4e0d\u5927\u4e8e $15$\uff0c\u90a3\u4e48\u5b83\u4eec\u5728 $65536$ \u8fdb\u5236\u4e0b**\u5fc5\u5b9a\u81f3\u5c11\u6709\u4e00\u4f4d\u5b8c\u5168\u76f8\u7b49**\u3002\u8fd9\u662f\u663e\u7136\u7684\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e $x$ \u5728 $65536$ \u8fdb\u5236\u4e0b\u7684 $16$ \u4f4d\uff0c\u5e76\u68c0\u67e5\u4e0e $x$ \u5728\u8be5\u4f4d\u76f8\u7b49\u7684\u6240\u6709 $a_i$ \u662f\u5426\u7b26\u5408\u8981\u6c42\u3002**\u7531\u4e8e\u6570\u636e\u968f\u673a\u751f\u6210\uff0c\u6240\u4ee5\u67d0\u4e00\u4f4d\u4e3a\u67d0\u4e2a\u6570\u7684 $a_i$ \u7684\u671f\u671b\u4e2a\u6570\u4e3a $\\dfrac{n}{65536}\\approx 7$**\u3002\u6240\u4ee5**\u5bf9\u4e8e\u6bcf\u4e00\u4f4d\uff0c\u6211\u4eec\u671f\u671b\u68c0\u67e5 $7$ \u4e2a $a_i$ \u662f\u5426\u7b26\u5408\u8981\u6c42**\u3002\u800c\u6ee1\u8db3\u5728 $65536$ \u8fdb\u5236\u4e0b\u7b2c $b$ \u4f4d\u4e3a $c$ \u7684 $a_i$ \u7684\u6240\u6709 $i$ \u53ef\u4ee5\u5f00 `vector` \u5b58\u50a8\u3002\n\n\u68c0\u67e5\u65b9\u6cd5\u5f88\u7b80\u5355\uff1a\u8981\u6c42\u51fa $65536$ \u8fdb\u5236\u6570 $x,y$ \u5728\u4e8c\u8fdb\u5236\u4e0b\u6709\u591a\u5c11\u4f4d\u4e0d\u540c\uff0c\u53ea\u9700\u8981\u9884\u5904\u7406\u51fa $0\\sim 65535$ \u5728\u4e8c\u8fdb\u5236\u4e0b $1$ \u7684\u4e2a\u6570\uff0c\u7136\u540e\u679a\u4e3e $x,y$ \u7684\u6bcf\u4e00\u4f4d\uff08\u4e00\u5171 $16$ \u4f4d\uff09\uff0c\u52a0\u4e0a \u5b83\u4eec\u5728\u8fd9\u4e00\u4f4d\u7684\u503c\u7684\u5f02\u6216\u548c \u5728\u4e8c\u8fdb\u5236\u4e0b $1$ \u7684\u4e2a\u6570\u5373\u53ef\u3002\n\n\u6781\u9650\u6570\u636e\u4e0b\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a $16n$\uff0c**\u671f\u671b**\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $m\\times 16\\times 7\\times 16\\approx 2\\times 10^8$\uff0c\u5176\u4e2d $m$ \u8868\u793a\u8be2\u95ee\u4e2a\u6570\uff0c\u7b2c\u4e00\u4e2a $16$ \u8868\u793a\u679a\u4e3e\u7684 $16$ \u4f4d\uff0c$7$ \u8868\u793a\u4e0e $x$ \u5728\u679a\u4e3e\u7684\u67d0\u4e00\u4f4d\u7684\u503c\u76f8\u7b49\u7684 $a_i$ \u7684\u671f\u671b\u4e2a\u6570\uff0c\u800c\u7b2c\u4e8c\u4e2a $16$ \u8868\u793a\u68c0\u67e5\u7684\u590d\u6742\u5ea6\u3002 \n\n\u4e3a\u4e86\u5361\u5e38\uff0c\u53ef\u4ee5\u8fdb\u884c\u4ee5\u4e0b\u4f18\u5316\uff1a\n\n- \u628a `vector` \u6362\u6210\u94fe\u5f0f\u524d\u5411\u661f\u3002\n- \u4f7f\u7528 `fread`\u3002\n- \u68c0\u67e5\u65f6\u4f7f\u7528\u6307\u9488\u800c\u4e0d\u662f\u6570\u7ec4\u3002\n- \u5982\u679c\u5df2\u7ecf\u4e0d\u7b26\u5408\u6761\u4ef6\uff0c\u9000\u51fa\u68c0\u67e5\uff08\u4e0d\u52a0\u8fd9\u4e2a\u4f18\u5316\u4f1a T \u6389\u51e0\u4e2a\u70b9\uff09\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define gc getchar()\n#define mem(x,v) memset(x,v,sizeof(x))\n\ntypedef unsigned long long ull;\ntypedef unsigned short us;\n\nnamespace IO{\n\tchar buf[1<<23],*p1=buf,*p2=buf;\n\t#ifdef __WIN32\n\t\t#define gc getchar()\n\t#else\n\t\t#define gc (p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<22,stdin),p1==p2)?EOF:*p1++)\n\t#endif\n\tinline int read(){\n\t\tint x=0;char s=gc;\n\t\twhile(!isdigit(s))s=gc;\n\t\twhile(isdigit(s))x=(x<<1)+(x<<3)+(s-'0'),s=gc;\n\t\treturn x;\n\t}\n} using namespace IO;\n\nconst int N=400000+5;\nconst int W=65536;\nbool s[N][256],q[256];\n\null myRand(ull &k1,ull &k2){\n    ull k3=k1,k4=k2;\n    k1=k4,k3^=(k3<<23),k2=k3^k4^(k3>>17)^(k4>>26);\n    return k2+k4;\n}\nvoid gen(int n,ull a1,ull a2){\n    for(int i=0;i<n;i++)\n        for(int j=0;j<256;j++)\n            s[i][j]=(myRand(a1,a2)&(1ull<<32))?1:0;\n}\n\nstruct EDGE{\n\tint cnt,hd[W],nxt[N],to[N];\n\tvoid add(int x,int y){nxt[++cnt]=hd[x],hd[x]=cnt,to[cnt]=y;}\n}buc[16];\n\null n,m,a1,a2;\nus val[N][16],mp[W],qq[16];\nint main(){\n\tcin>>n>>m>>a1>>a2,gen(n,a1,a2);\n\tfor(int i=0;i<n;i++)\n\t\tfor(int j=0;j<16;j++){\n\t\t\tfor(int k=0;k<16;k++)\n\t\t\t\tval[i][j]+=s[i][j*16+k]<<k;\n\t\t\tbuc[j].add(val[i][j],i);\n\t\t}\n\tfor(int i=1;i<W;i++)mp[i]=mp[i>>1]+(i&1);\n\tfor(int i=0,las=0,k;i<m;i++,mem(qq,0)){\n\t\tfor(int j=0,vv=0;j<64;j++,vv=0){\n\t\t\tchar s=gc;\n\t\t\tif(isdigit(s))vv=s-'0';\n\t\t\telse if(s>='A'&&s<='F')vv=10+s-'A';\n\t\t\telse {j--; continue;}\n\t\t\tfor(int l=0;l<4;l++)q[j*4+l]=(vv>>3-l)&1;\n\t\t}\n\t\tbool ok=0; k=read();\n\t\tfor(int j=0;j<16;j++)\n\t\t\tfor(int l=0;l<16;l++)\n\t\t\t\tqq[j]+=(q[j*16+l]^las)<<l;\n\t\tfor(int j=0;j<16;j++){\n\t\t\tfor(int p=buc[j].hd[qq[j]];p;p=buc[j].nxt[p]){\n\t\t\t\tint it=buc[j].to[p],cnt=0;\n\t\t\t\tus *pval=val[it],*pq=qq;\n\t\t\t\tfor(int l=0;l<16;l++,pval++,pq++){\n\t\t\t\t\tcnt+=mp[(*pval)^(*pq)];\n\t\t\t\t\tif(cnt>k)break;\n\t\t\t\t} if(cnt<=k){ok=1; break;}\n\t\t\t} if(ok)break;\n\t\t} cout<<(las=ok)<<'\\n';\n\t}\n    return 0;\n}\n```\n\n",
        "postTime": 1627460088,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "P7738 [NOI2021] \u91cf\u5b50\u901a\u4fe1"
    },
    {
        "content": "### \u5f15\u8a00\n\n\u540c\u6b65\u8d5b\uff0c\u5927\u5e38\u6570\u9009\u624b\u5361\u5e38\u9898\u8fc7\u4e86\uff01\u611f\u52a8\uff01\n\n\u770b\u5230\u8fd9\u9898\u2014\u2014az\uff0c\u4ec0\u4e48\u5b57\u7b26\u4e32\u795e\u4ed9\u9898\uff1f01-Trie \u4e0a\u81ea\u52a8\u673a\uff1f\n\n\u770b\u5230 `gen.cpp`\uff0c\u7b11\u4e86\uff0c\u5b57\u5178\u662f\u968f\u673a\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4e71\u641e\u3002\n\n\u8bf4\u53e5\u95f2\u8bdd\uff0c\u6709\u6ca1\u6709\u4eba\u5f3a\u5236\u79bb\u7ebf\u8fc7\u7684\uff1f\u5f88\u597d\u5947\u3002\n\n### \u601d\u8def\n\n\u6ce8\u610f\u5230 $k\\le15$\uff0c\u56e0\u6b64\u6211\u4eec\u5982\u679c\u628a\u957f\u4e3a $256$ \u7684\u4e32\u5747\u5206 $16$ \u5757\uff0c\u6bcf\u5757\u957f\u4e3a $16$\uff0c\u90a3\u4e48\u566a\u97f3\u5e72\u6270\u4f4d\uff08\u4e0d\u5339\u914d\u4f4d\uff09\u6700\u591a\u53ea\u4f1a\u5728\u5176\u4e2d $15$ \u5757\u4e2d\uff0c\u56e0\u6b64\u5fc5\u7136\u4f1a\u6709\u4e00\u5757\u662f\u5168\u5339\u914d\u7684\u3002\n\n\u5bf9\u6bcf\u4e00\u5757\uff0c\u6211\u4eec\u8003\u8651\uff0c\u5176\u72b6\u6001\u4e0d\u4f1a\u8d85\u8fc7 $65536$ \u79cd\uff0c\u800c\u5b57\u5178\u5927\u81f4\u968f\u673a\u5747\u5206\u5176\u4e2d\uff0c\u6bcf\u79cd\u60c5\u51b5\u6709 $\\dfrac{400000}{65536}\\approx6$ \u7684\u5355\u8bcd\u6ee1\u8db3\u3002\n\n\u4e8e\u662f\u628a\u5b57\u5178\u4e2d\u7684\u6bcf\u79cd\u60c5\u51b5\u63d2\u8fdb\u4e00\u4e2a `vector` \u8868\u4e2d\uff0c\u6bcf\u6b21\u66b4\u529b\u67e5\u8868\uff0c\u67e5\u5230\u5373\u6709\u89e3\uff0c\u5426\u5219\u65e0\u89e3\u3002\n\n\u5224\u65ad\u65f6\u53ef\u80fd\u8981 `bitset` \u7684\u5f02\u6216\u4e0e `count` \u7b49\uff0c\u5efa\u8bae\u624b\u5199\u4e00\u4e2a\uff0c\u907f\u514d\u5361\u5e38\u3002\n\n### \u590d\u6742\u5ea6\u5206\u6790\n\n#### \u65f6\u7a7a\u5206\u6790\n\n\u4e3a\u4e86\u66f4\u76f4\u89c2\uff0c\u6211\u4eec\u628a\u5e38\u6570\u5199\u8fdb\u65f6\u95f4\u590d\u6742\u5ea6\u8bb0\u53f7\u4e2d\u3002\n\n\u9884\u5904\u7406\uff08\u5305\u62ec `count` \u9884\u5904\u7406\uff09\u7ea6 $O(256n+16n+65536)$\u3002\n\n\u5355\u6b21\u8be2\u95ee\u7ea6 $O(16\\times6\\times\\frac{256}{w})$\uff0c\u624b\u5199\u7684\u8bdd $w$ \u7ea6 $64$\uff1f\n\n\u56e0\u4e3a\u53c8\u8981\u5f02\u6216\u53c8\u8981 `count`\uff0c\u53ef\u80fd\u8fd8\u6709\u4e00\u4e2a $2$ \u7684\u5e38\u6570\u5f97\u4e58\u4e0a\u3002\n\n\u7a7a\u95f4\u7684\u8bdd\u7a0d\u5fae\u8bc1\u4e00\u4e0b\u662f\u4f1a\u53d1\u73b0\u4e0d\u4f1a\u7206\u7684\u3002\n\n#### \u4ee3\u7801\u96be\u5ea6\u5206\u6790\n\n\u8fd8\u597d\u5427\uff08\uff1f\uff09\uff0c\u53cd\u6b63\u662f\u6211\u540c\u6b65\u8d5b\u552f\u4e00\u505a\u51fa\u7684\u9898\uff08\u5230\u65f6\u5019\u88ab\u4e0d\u88ab\u5c11\u7237\u673a\u5361\u5e38\u5c31\u4e0d\u77e5\u9053\u4e86\uff09\u3002\n\n\u4e0a\u4ee3\u7801\u3002\n\n```cpp\n#include <stdio.h>\n#include <vector>\ntypedef long long llt;\ntypedef unsigned short usint;\ntypedef unsigned uint;typedef unsigned long long ullt;\ntypedef bool bol;typedef char chr;typedef void voi;\ntypedef double dbl;\ntemplate<typename T>bol _max(T&a,T b){return(a<b)?a=b,true:false;}\ntemplate<typename T>bol _min(T&a,T b){return(b<a)?a=b,true:false;}\ntemplate<typename T>T power(T base,T index,T mod){return((index<=1)?(index?base:1):(power(base*base%mod,index>>1,mod)*power(base,index&1,mod)))%mod;}\ntemplate<typename T>T lowbit(T n){return n&-n;}\ntemplate<typename T>T gcd(T a,T b){return b?gcd(b,a%b):a;}\ntemplate<typename T>T lcm(T a,T b){return(a!=0||b!=0)?a/gcd(a,b)*b:(T)0;}\nconst uint N = 400000;bol s[N+1][265];\nullt myRand(ullt &k1,ullt &k2){ullt k3=k1,k4=k2;k1=k4;k3^=(k3<<23);k2=k3^k4^(k3>>17)^(k4>>26);return k2+k4;}\nvoi gen(uint n,ullt a1,ullt a2){for(uint i=0;i<n;i++)for(uint j=0;j<256;j++)s[i][j]=(myRand(a1,a2)&(1ull<<32))?1:0;}\nusint Count[66005];ullt Turn[150];\nstruct my_bitset\n{\n\tullt A,B,C,D;\n\tmy_bitset():A(0),B(0),C(0),D(0){}\n\tmy_bitset(bol*T){A=B=C=D=0;for(uint i=0;i<64;i++)A=(A<<1)|T[i];for(uint i=64;i<128;i++)B=(B<<1)|T[i];for(uint i=128;i<192;i++)C=(C<<1)|T[i];for(uint i=192;i<256;i++)D=(D<<1)|T[i];}\n\tmy_bitset(chr*T)\n\t{\n\t\tA=B=C=D=0;\n\t\tfor(uint i=0;i<16;i++)A=(A<<4)|Turn[(uint)T[i]];for(uint i=16;i<32;i++)B=(B<<4)|Turn[(uint)T[i]];\n\t\tfor(uint i=32;i<48;i++)C=(C<<4)|Turn[(uint)T[i]];for(uint i=48;i<64;i++)D=(D<<4)|Turn[(uint)T[i]];\n\t}\n\tusint get(uint p){return((p<8)?((p<4)?(D>>(p<<4)):(C>>((p&3)<<4))):((p<12)?(B>>((p&3)<<4)):(A>>((p&3)<<4))))&65535;}\n\tmy_bitset operator^(my_bitset b){return b.A^=A,b.B^=B,b.C^=C,b.D^=D,b;}\n\tvoi chg(){A=~A,B=~B,C=~C,D=~D;}\n\tusint count()\n\t{\n\t\treturn\n\t\t\tCount[A&65535]+Count[(A>>16)&65535]+Count[(A>>32)&65535]+Count[(A>>48)&65535]+Count[B&65535]+Count[(B>>16)&65535]+Count[(B>>32)&65535]+Count[(B>>48)&65535]+\n\t\t\tCount[C&65535]+Count[(C>>16)&65535]+Count[(C>>32)&65535]+Count[(C>>48)&65535]+Count[D&65535]+Count[(D>>16)&65535]+Count[(D>>32)&65535]+Count[(D>>48)&65535];\n\t}\n};\nmy_bitset B[400005],Q;\nstd::vector<uint>V[25][66005];\nchr C[105];\nint main()\n{\n\tfor(usint i=1;i;i++)Count[i]=Count[i>>1]+(i&1);\n\tuint n,m,k;ullt a1,a2;bol ok=false;scanf(\"%u%u%llu%llu\",&n,&m,&a1,&a2),gen(n,a1,a2);\n\tfor(uint i=0;i<n;i++){B[i]=s[i];for(uint j=0;j<16;j++)V[j][B[i].get(j)].push_back(i);}\n\tfor(uint i=0;i<10;i++)Turn[i+'0']=i;\n\tfor(uint i=0;i<6;i++)Turn[i+'A']=10+i;\n\twhile(m--)\n\t{\n\t\tscanf(\"%s%u\",C,&k),Q=my_bitset(C);\n\t\tif(ok)Q.chg(),ok=false;\n\t\tfor(uint i=0;i<16&&!ok;i++)\n\t\t{\n\t\t\tstd::vector<uint>&W=V[i][Q.get(i)];\n\t\t\tfor(uint p=W.size()-1;~p;p--)if((B[W[p]]^Q).count()<=k){ok=true;break;}\n\t\t}\n\t\tputs(ok?\"1\":\"0\");\n\t}\n\treturn 0;\n}\n```\n\n### \u540e\u8bb0\n\n\u8c14\uff0c\u5e0c\u671b\u4e0d\u8981\u6709\u5361\u5e38\u9898\u4e86QAQ\n\n\u653e\u5f20\u56fe\uff0c[\u53c2\u89c1](https://www.noi.cn/ccf/contentcore/resource/show?ID=152179)\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5y9g24mj.png)\n\n",
        "postTime": 1627460431,
        "uid": 105050,
        "name": "myee",
        "ccfLevel": 7,
        "title": "7738"
    },
    {
        "content": "\u7edd\u8d5e\u5361\u5e38\u9898/kk\n\n\u5fc3\u8def\u5386\u7a0b\uff1a\n\n\u5f3a\u5236\u5728\u7ebf\u554a\uff01\n\n\u54e6\u53ef\u4ee5\u79bb\u7ebf\u505a\u554a\uff0c\u4f46\u662f\u597d\u50cf\u4e5f\u6ca1\u6cd5\u505a\u2026\u2026\n\n\u8fd9\u53ef\u4ee5\u5728\u7ebf\u505a\u554a\uff01\n\n\u2026\u2026\n\n\u9996\u5148\u5148\u89c2\u5bdf\u8fd9\u4e2a\u6570\u636e\u8303\u56f4\uff0c\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e2a $k$ \u7684\u8303\u56f4\u5f88\u5c0f\u3002\n\n\u56e0\u4e3a $k \\le 15$\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u628a\u539f\u4e32\u5206\u4e3a $16$ \u4efd\u3002\n\n\u90a3\u4e48\u6839\u636e\u9e3d\u5de2\u539f\u7406\uff0c\u5c06\u8bfb\u5165\u7684\u4e32\u5206\u6210 $16$ \u4efd\uff0c\u82e5\u9700\u6ee1\u8db3\u6761\u4ef6\uff0c\u5219\u5fc5\u7136\u6709\u4e00\u4e2a\u533a\u95f4\u7684\u4e32\u76f8\u7b49\u3002\n\n\u6211\u7b2c\u4e00\u6b21\u505a\u5230\u8fd9\u513f\u5c31\u4e0d\u4f1a\u4e86\u3002\n\n\u540e\u9762\u89c2\u5bdf gen.cpp \uff0c\u53ef\u4ee5\u53d1\u73b0\uff0c**\u5b57\u5178\u662f\u5b8c\u5168\u968f\u673a\u7684**\u3002\n\n\u6240\u4ee5\u8bf4\u5c31\u53ef\u4ee5\u8003\u8651\u5747\u644a\u4e86\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u6bb5\uff0c\u8bbe\u4e00\u4e2a vector $B_{i,j}$ \u8868\u793a\u5728\u7b2c $i$ \u5757\uff0c\u8fd9\u4e00\u5757\u7684\u503c\u4e3a $j$ \u4e2d\u6709\u54ea\u4e9b\u5b57\u5178\u3002\n\n\u63a5\u4e0b\u6765\u76f4\u63a5\u5bf9\u4e8e\u4e24\u4e2a $256$ \u4f4d\u7684\u6570\uff0c\u9884\u5904\u7406\u51fa\u6bcf\u4e2a $[0,2^{16}-1]$ \u7684\u6570\u4e2d\u5404\u81ea\u5305\u542b\u51e0\u4e2a $1$\uff0c\u7136\u540e\u6bcf $16$ \u4e2a\u6570\u5206\u4e00\u4f4d\uff0c\u5f02\u6216\u67e5\u627e\u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6\u7684\u8bdd\u9996\u5148\u53d1\u73b0\u51e0\u4e4e\u662f\u5747\u644a\u7684\u3002\n\n\u6240\u4ee5\u8bf4\u67e5\u627e\u4e00\u4e2a\u5757\u4e2d\u7684 vector \u6570\u91cf\u5927\u6982\u662f $\\dfrac{n}{2^{16}}$ \u4e2a\u3002\n\n\u603b\u5171\u6709 $16$ \u4e2a vector\uff0c\u6bcf\u6b21\u67e5\u627e\u90fd\u6709 $16$ \u7684\u5e38\u6570\u3002\n\n\u90a3\u4e48\u5c31\u662f $O(n \\times m \\times \\dfrac{1}{2^8})$ \u7684\u590d\u6742\u5ea6\u3002\n\n\u73b0\u5728\u770b\u4e0a\u53bb\u4e00\u5207\u90fd\u5f88\u7f8e\u597d\uff0c\u6837\u4f8b\u8dd1\u7684\u4e5f\u4e0d\u6162\u3002\n\n\u4f46\u5f53\u4f60\u81ea\u9020\u6570\u636e\u4e00\u770b\u2014\u2014$2.2s$\u3002\n\n\u8003\u8651\u600e\u4e48\u4f18\u5316\u8fd9\u4e2a\u5e38\u6570\u3002\n\n\u6211\u7528\u4e86 fread \u5feb\u8bfb\uff0c\u5faa\u73af\u5c55\u5f00\u7b49\u529e\u6cd5\u90fd\u4e0d\u662f\u5f88\u5b9e\u7528\uff0c\u53ea\u6709\u4e00\u6b65\u5faa\u73af + break\uff08\u89c1\u4ee3\u7801\uff09\u7684\u65b9\u6cd5\u52a0\u5feb\u4e86\u4e0d\u5c11\u3002\n\n\u4f46\u8fd8\u662f\u5361\u4e0d\u8fc7\u53bb\u3002\u8d5b\u540e\u4e00\u6d4b\u786e\u5b9e\u4e5f\u6ca1\u6709\u8fc7\u3002\n\n\u901a\u8fc7\u4e00\u4e9b\u795e\u4ed9\u7684\u63d0\u9192\uff0c\u53d1\u73b0\u53ef\u4ee5\u7528 resize \u63d0\u524d\u5904\u7406\u5185\u5b58\u6765\u4f18\u5316 push_back \u7684\u5e38\u6570\u3002\n\n\u56e0\u4e3a\u662f\u968f\u673a\u7684\u6240\u4ee5 resize \u5f00\u5230 $32$ \u7684\u8bdd\u51b2\u7a81\u6982\u7387\u5c31\u6781\u5c0f\u4e86\u3002\n\n\u7136\u540e\u5c31\u8fc7\u4e86\u3002\n\n\u8be6\u7ec6\u7ec6\u8282\u89c1\u4ee3\u7801\u3002\n\n```cpp\n/*\n\t\u300e\u90a3\u4e48\u2026\u5047\u5982\u6211\u73b0\u5728\u8d70\u8fdb\u6d77\u91cc\u53bb\u7684\u8bdd\u2026\u300f\n\t\u300e\u4f60\u4f1a\u2026\u62c9\u4f4f\u6211\u5417\uff1f\u300f\n\t\u300e\u5982\u679c\u4f60\u5e0c\u671b\u6211\u62c9\u4f4f\u4f60\u7684\u8bdd\uff0c\u6211\u5c31\u4f1a\u62c9\u4f4f\u4f60\u300f\n\t\u300e\u4e0d\u2026\u6211\u4e0d\u662f\u8fd9\u4e2a\u610f\u601d\u300f\n\t\u300e\u90a3\u5c31\u662f\u8bf4\uff0c\u6211\u6ca1\u6709\u5fc5\u8981\u62c9\u4f4f\u4f60\u4e86\uff1f\u300f\n\t\u300e\u2026\u2026\u2026\u2026\u300f\n\n\t\u5979\u6ca1\u6709\u56de\u7b54\u6211\u7684\u63d0\u95ee\u3002\n\t\u4f46\u662f\uff0c\u5979\u4e5f\u6ca1\u6709\u518d\u6b21\u8fc8\u51fa\u5df2\u505c\u4e0b\u7684\u811a\u6b65\u3002\n\t\u2026\u6211\u60f3\uff0c\u8fd9\u5c31\u662f\u5979\u7684\u56de\u7b54\u5427\u3002\n\t\t\t\t\t\t\t\t\t\t\u2014\u2014\u300aNaicissus\u300b\n*/\n//#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,avx2,tune=native\")\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef unsigned long long ull;\nconst int N = 400009, M = (1 << 16) + 9;\nbool s[N+5][259];\nbitset <259> now, dic[N + 9], tot;\nint n, m, lstans, to[259], k;\nvector<int> B[18][M];\nint p[N][18], ccf[18], pep[M], tuu[18][M];\nchar a[259];\nint cnt[M];\nbool flag;\null a1, a2;\nbool pp[259];\nchar buf[1<<23],*p1=buf,*p2=buf;\n#define getchar() (p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<22,stdin),p1==p2)?EOF:*p1++)\ninline int read()\n{\n\tint sum = 0, nega = 1;\n\tchar ch = getchar();\n\twhile (ch > '9'||ch < '0')\n\t{\n\t    if (ch == '-') nega = -1;\n\t\tch = getchar();\n\t}\n\twhile (ch <= '9'&&ch >= '0')sum=sum*10+ch-'0',ch=getchar();\n\treturn sum * nega;\n}\ninline ull readull()\n{\n\tull sum = 0, nega = 1;\n\tchar ch = getchar();\n\twhile (ch > '9'||ch < '0')\n\t{\n\t    if (ch == '-') nega = -1;\n\t\tch = getchar();\n\t}\n\twhile (ch <= '9'&&ch >= '0')sum=sum*10ull+ch-'0',ch=getchar();\n\treturn sum * nega;\n}\null myRand(ull &k1, ull &k2) {\n    ull k3 = k1, k4 = k2;\n    k1 = k4;\n    k3 ^= (k3 << 23);\n    k2 = k3 ^ k4 ^ (k3 >> 17) ^ (k4 >> 26);\n    return k2 + k4;\n}\nvoid gen(int n, ull a1, ull a2) {\n    for (int i = 1; i <= n; i++)\n        for (int j = 0; j < 256; j++)\n        {\n            s[i][j] = (myRand(a1, a2) & (1ull << 32)) ? 1 : 0;\n   //         dic[i][j] = (s[i][j] == 1);\n        }\n    int res = 0;\n    for (int i = 1; i <= n; i++)\n    \tfor (int j = 0; j < 256; j++)\n    \t{\n\t\t\tres = res << 1;\n\t\t\tres = res + (s[i][j] == 1);\n    \t\tif(pp[j]) \n    \t\t{\t\n    \t\t\tp[i][j / 16] = res;\n    \t\t\t//cout << i << \" \" << j << \" \" << res << endl;\n    \t\t\tB[j / 16][res][tuu[j / 16][res]++] = i;\n    \t\t\tres = 0;\n\t\t\t}\n\t\t}\n}\ninline bool check (int x, int k)\n{ \n\tint cnt = 0;\n\tcnt = cnt + pep[p[x][0] ^ ccf[0]];;\n\tcnt = cnt + pep[p[x][1] ^ ccf[1]];\n\tif(cnt > k) return 0;\n\tcnt = cnt + pep[p[x][2] ^ ccf[2]];\n\tcnt = cnt + pep[p[x][3] ^ ccf[3]];\n\tif(cnt > k) return 0;\n\tcnt = cnt + pep[p[x][4] ^ ccf[4]];\n\tcnt = cnt + pep[p[x][5] ^ ccf[5]];\n\tcnt = cnt + pep[p[x][6] ^ ccf[6]];\n\tcnt = cnt + pep[p[x][7] ^ ccf[7]];\n\tif(cnt > k) return 0;\n\tcnt = cnt + pep[p[x][8] ^ ccf[8]];\n\tcnt = cnt + pep[p[x][9] ^ ccf[9]];\n\tcnt = cnt + pep[p[x][10] ^ ccf[10]];\n\tcnt = cnt + pep[p[x][11] ^ ccf[11]];\n\tcnt = cnt + pep[p[x][12] ^ ccf[12]];\n\tcnt = cnt + pep[p[x][13] ^ ccf[13]];\n\tcnt = cnt + pep[p[x][14] ^ ccf[14]];\n\tcnt = cnt + pep[p[x][15] ^ ccf[15]];\n\tif(cnt > k) return 0;\n\treturn 1;\n}\ninline void init()\n{\n\tfor (int i = 0; i < 16; i++)\n\t\tfor (int j = 0; j < (1 << 16); j++)\n\t \t\tB[i][j].resize(32);\n}\nint main() \n{\n//  freopen(\"qi.in\", \"r\", stdin);\n//\tfreopen(\"qi.out\", \"w\", stdout);\n\tinit();\n//\treturn 0;\n\tn = read(); m = read();\n\ta1 = readull(), a2 = readull();\n\tfor (int i = 0; i < 256; i++)\n\t\tif (i % 16 == 15) pp[i] = 1;\n\tgen(n, a1, a2);\t\n\tto['0'] = 0;\n\tto['1'] = 1;\n\tto['2'] = 2;\n\tto['3'] = 3;\n\tto['4'] = 4;\n\tto['5'] = 5;\n\tto['6'] = 6;\n\tto['7'] = 7;\n\tto['8'] = 8;\n\tto['9'] = 9;\n\tto['A'] = 10;\n\tto['B'] = 11;\n\tto['C'] = 12;\n\tto['D'] = 13;\n\tto['E'] = 14;\n\tto['F'] = 15;\n\t//return 0;\n\tfor (int i = 0; i < (1 << 16); i++)\n\t\tfor (int j = 0; j < 16; j++)\n\t\t\tif((i & (1 << j))) pep[i]++;\n\tfor (int ttt = 1; ttt <= m; ttt++)\n\t{\n\t\tflag = 0;\n\t\tchar ch = getchar(), awa = 0;\n\t\twhile((ch > 'F' || ch < 'A') && (ch > '9' || ch < '0')) ch = getchar();\n\t\twhile((ch <= 'F' && ch >= 'A') || (ch <= '9' && ch >= '0')) a[awa++] = ch, ch = getchar();\n\t\tk = read();\n\t\tfor (int i = 0; i < 64; i++)\n\t\t{\n\t\t\tint qwq = to[a[i]];\n\t\t\t//cout << qwq << endl;\n\t\t\tif(qwq & 8) now[i * 4] = 1;\n\t\t\telse now[i * 4] = 0;\n\t\t\tif(qwq & 4) now[i * 4 + 1] = 1;\n\t\t\telse now[i * 4 + 1] = 0;\n\t\t\tif(qwq & 2) now[i * 4 + 2] = 1;\n\t\t\telse now[i * 4 + 2] = 0;\n\t\t\tif(qwq & 1) now[i * 4 + 3] = 1;\n\t\t\telse now[i * 4 + 3] = 0;\n\t\t}\n\t\tfor (int i = 0; i < 256; i++)\n\t\t\tif(lstans) now[i] = (!now[i]);\n\t\tint res = 0;\n\t\tfor (int i = 0; i < 256; i++)\n\t\t{\n\t\t\tres = res << 1;\n\t\t\tres = res + (now[i] == 1);\n\t\t\tif (pp[i])\n\t\t\t\tccf[i / 16] = res, res = 0;\n\t\t}\n\t\tfor (int i = 0; i < 256; i++)\n\t\t{\n\t\t\tres = res << 1;\n\t\t\tres = res + (now[i] == 1);\n\t\t\tif (pp[i])\n\t\t\t{\n\t\t\t//\tcout << res << endl;\n\t\t\t\tint siz = tuu[i / 16][res];\n\t\t\t\tfor (int j = 0; j < siz; j++)\n\t\t\t\t{\n\t\t\t\t\tif (!B[i / 16][res][j]) break;\n\t\t\t\t\tif (check(B[i / 16][res][j], k)) flag = 1; \n\t\t\t\t}\n\t\t\t\tres = 0;\n\t\t\t}\n\t\t\tif(flag) break;\n\t\t}\n\t\tlstans = (flag == 1);\n\t\tif(lstans) puts(\"1\");\n\t\telse puts(\"0\");\n\t}\n    return 0;\n}\n```\n\n",
        "postTime": 1627485148,
        "uid": 97304,
        "name": "Mophie",
        "ccfLevel": 0,
        "title": "P7738 [NOI2021] \u91cf\u5b50\u901a\u4fe1 \u9898\u89e3"
    },
    {
        "content": "\u4e3a\u5565 D2T1 \u6bd4 D1T1 \u6c34\u554a\uff1f\n\n\u6ce8\u610f\u5230 $k\\le 15$\uff0c\u8bf4\u660e\u5982\u679c\u4e24\u4e2a\u4e32\u53ef\u4ee5\u8f6c\u6362\u5230\u7684\u8bdd\u5fc5\u7136\u6709\u5f88\u591a\u76f8\u540c\u7684\u4f4d\u3002\n\n\u4e0d\u540c\u7684\u4f4d\u7f6e\u6700\u591a $15$ \u4f4d\uff0c\u6240\u4ee5\u5982\u679c\u628a $256$ \u4f4d\u7684\u4e32\u5206\u6210 $16$ \u5757\uff0c\u90a3\u4e48\u81f3\u5c11\u6709\u4e00\u5757\u662f\u6ca1\u6709\u533a\u522b\u7684\u3002\n\n\u679a\u4e3e\u54ea\u4e00\u5757\u6ca1\u6709\u533a\u522b\u5373\u53ef\u3002\n\n\u7531\u4e8e\u5b57\u5178\u968f\u673a\u751f\u6210\uff0c\u6bcf\u6b21\u9700\u8981\u627e\u7684\u671f\u671b\u6570\u91cf\u662f $\\dfrac n {65536} \\times 16$\uff0c\u4e00\u6b21\u5224\u65ad\u6b21\u6570\u662f $16$\uff0c\u6240\u4ee5\u6700\u7ec8\u7a0b\u5e8f\u6267\u884c\u6b21\u6570\u5728 $\\dfrac{nm}{256}$ \u7ea7\u522b\u3002\u53ef\u4ee5\u901a\u8fc7\u3002\n\n\u5177\u4f53\u5b9e\u73b0\uff1a\u9884\u5904\u7406\u51fa\u7b2c $i$ \u4e2a\u5757\u7684\u6570\u662f $j$ \u7684\u4e32\u7684\u4f4d\u7f6e\u3002\n\n\n[Code here](https://paste.ubuntu.com/p/7pNpNfGSrT/)",
        "postTime": 1627471253,
        "uid": 171487,
        "name": "cmll02",
        "ccfLevel": 8,
        "title": "mo"
    },
    {
        "content": "\u5199\u4e00\u4e2a\u81ea\u8ba4\u4e3a\u8be6\u7ec6\u7684\u9898\u89e3\uff1f\n\n\u9996\u5148\u8003\u8651\u66b4\u529b\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u6b21\u8be2\u95ee\u66b4\u529b\u679a\u4e3e\u5339\u914d\u4e32\uff0c\u4ee4 $L=256$\uff0c\u8868\u793a\u4e32\u957f\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(nmL)$ \u6216 $O(\\dfrac{nmL}\\omega )$\u3002\n\n\u53d1\u73b0\u8fd9\u4e2a\u66b4\u529b\u5b8c\u5168\u6ca1\u6709\u6269\u5c55\u7a7a\u95f4\uff0c\u8003\u8651\u53d1\u6398\u9898\u76ee\u6027\u8d28\u3002\n\n$1.$ $L$ \u4e3a\u5b9a\u503c $256$\u3002\n\n$2.$ $k_i\\leq 15$\u3002\n\n$3.$ \u5f3a\u5236\u5728\u7ebf\u662f\u5047\u7684\u3002\n\n$4.$ \u6211\u4eec\u53ea\u9700\u8981\u5224\u65ad\u662f\u5426\u5b58\u5728\uff0c\u4e0d\u9700\u8981\u8ba1\u6570\u3002\n\n$5.$ \u539f\u4e32\u662f\u968f\u673a\u7684\uff0c\u4f46\u8be2\u95ee\u4e0d\u662f\u3002\n\n\u8fd9\u4e9b\u6761\u4ef6\u4f7f\u5f97\u9898\u76ee\u53d8\u5f97\u53ef\u505a\uff0c\u4f46\u5e76\u4e0d\u9700\u8981\u5168\u90e8\u7528\u4e0a\u3002\n\n\u770b\u5230 $k_i\\leq 15$\uff0c\u4f46\u4e0d\u662f\u72b6\u538b\uff0c\u4e5f\u6ca1\u6cd5\u679a\u4e3e\uff0c\u53ef\u4ee5\u4e0e\u5b9a\u503c $256$ \u4ea7\u751f\u8054\u7cfb\u3002\n\n\u53d1\u73b0\u82e5\u5c06\u4e00\u4e2a\u957f\u5ea6\u4e3a $256$ \u7684\u4e32\u5206\u4e3a $16$ \u6bb5\uff0c\u6839\u636e\u9e3d\u5de2\u539f\u7406\uff0c\u90a3\u4e48\u4fee\u6539 $k_i$ \u4e2a\u6570\u4e4b\u540e\u81f3\u5c11\u6709\u4e00\u6bb5\u6ca1\u53d8\uff01\n\n$2^{16}=65536$\uff0c\u90a3\u4e48\u5176\u4e2d\u7684\u67d0\u4e00\u6bb5\u503c\u76f8\u540c\u7684\u671f\u671b\u53ea\u6709 $\\dfrac n {65536}$ \u4e2a\uff0c\u90a3\u4e48\u5bf9\u4e8e\u6bcf\u4e00\u6b21\u8be2\u95ee\uff0c\u53ef\u4ee5\u76f4\u63a5\u66b4\u529b\u67e5\u8be2\u6bcf\u4e00\u6bb5\u76f8\u540c\u7684\u51e0\u4e2a\u4e32\uff0c\u7528 bitset \u4f18\u5316\u5339\u914d\u5373\u53ef\u3002\n\n~~\u4e8e\u662f\u6211\u4eec\u5e76\u6ca1\u6709\u7528\u5230\u6027\u8d28 3,4~~\n\n\u5b9e\u9645\u4e0a\uff0c\u7531\u4e8e\u8be2\u95ee\u4e0d\u662f\u968f\u673a\u7684\uff0c\u4e0a\u9762\u7684\u671f\u671b\u53ef\u4ee5\u5361\u51fa\u4e00\u4e2a\u4e8c\u500d\u7684\u5e38\u6570\uff0c\u6240\u4ee5\u9700\u8981\u8fdb\u884c\u4e00\u4e9b\u5e38\u6570\u4f18\u5316\uff08\u4f46\u611f\u89c9\u6570\u636e\u6ca1\u5361\uff09\uff1a\n\n$1.$ \u4e0d\u8981\u8bbf\u95ee bitset\uff0c\u975e\u5e38\u6162\u3002\n\n$2.$ \u53ef\u4ee5\u7528\u56db\u4e2a unsigned long long \u76f4\u63a5\u4ee3\u66ff\u4e00\u4e2a bitset\u3002\n\n$3.$ \u7528\u94fe\u8868\u4e0d\u8981\u7528 vector\u3002\n\n\u7531\u4e8e\u8003\u573a\u5361\u5e38\uff0c\u4e14\u4e0d\u786e\u5b9a\u80fd\u4e0d\u80fd\u7528 popcount\uff0c\u5f88\u591a\u4e1c\u897f\u662f\u624b\u5199\u7684\uff0c\u7a0d\u7a0d\u6709\u70b9\u957f\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define re register\n#define ull unsigned long long\nint st;\nchar s[400002][256],Q[256];\nchar rbuf[32000002];\nint pt=-1;\null myRand(ull &k1, ull &k2) {\n    ull k3=k1,k4=k2;\n    k1=k4;\n    k3^=(k3<<23);\n    k2=k3^k4^(k3>>17)^(k4>>26);\n    return k2+k4;\n}\nvoid gen(int n, ull a1, ull a2) {\n    for(int i=1;i<=n;++i)\n        for(int j=0;j<256;++j)\n            s[i][j]=(myRand(a1, a2) & (1ull << 32)) ? 1 : 0;\n}\nint n,m,cnt,la,head[1048576],popcnt[65536];\nstruct edge{\n\tint to,next;\n}e[6400002];\ninline void add(re int x,re int y){e[++cnt]=(edge){y,head[x]},head[x]=cnt;}\null a1,a2;\ninline void read(char* A){\n\tre char v=rbuf[++pt];\n\twhile((v<'0'||v>'9')&&(v<'A'||v>'F'))v=rbuf[++pt];\n\tre int tot=0;\n\twhile((v>='0'&&v<='9')||(v>='A'&&v<='F')){\n\t\tre int tmp=(v>='A')?v-'A'+10:v-'0';\n\t\tA[tot++]=(tmp&8)>0,A[tot++]=(tmp&4)>0,A[tot++]=(tmp&2)>0,A[tot++]=tmp&1;\n\t\tv=rbuf[++pt];\n\t}\n}\null A[400002],B[400002],C[400002],D[400002];\ninline ull read(){\n\tre ull t=0;re char v=rbuf[++pt];\n\twhile(v<'0')v=rbuf[++pt];\n\twhile(v>='0')t=(t<<3)+(t<<1)+v-48,v=rbuf[++pt];\n\treturn t;\n}\ninline int P(re ull x){return popcnt[x&65535]+popcnt[(x>>16)&65535]+popcnt[(x>>32)&65535]+popcnt[(x>>48)&65535];}\nint ed;\nint main(){\n//\tfreopen(\"qi.in\",\"r\",stdin);\n//\tfreopen(\"qi.out\",\"w\",stdout);\n\tfread(rbuf,1,32000000,stdin),n=read(),m=read(),a1=read(),a2=read(),gen(n,a1,a2);\n\tfor(re int i=1;i<=65536;++i)popcnt[i]=popcnt[i>>1]+(i&1);\n\tfor(re int i=1;i<=n;++i){\n\t\tfor(re int j=0;j<64;++j)A[i]=(A[i]<<1)+s[i][j];\n\t\tfor(re int j=64;j<128;++j)B[i]=(B[i]<<1)+s[i][j];\n\t\tfor(re int j=128;j<192;++j)C[i]=(C[i]<<1)+s[i][j];\n\t\tfor(re int j=192;j<256;++j)D[i]=(D[i]<<1)+s[i][j];\n\t\tfor(re int j=0;j<4;++j)add((j<<16)+((A[i]>>(((j&3)^3)<<4))&65535),i);\n\t\tfor(re int j=4;j<8;++j)add((j<<16)+((B[i]>>(((j&3)^3)<<4))&65535),i);\n\t\tfor(re int j=8;j<12;++j)add((j<<16)+((C[i]>>(((j&3)^3)<<4))&65535),i);\n\t\tfor(re int j=12;j<16;++j)add((j<<16)+((D[i]>>(((j&3)^3)<<4))&65535),i);\n\t}\n\twhile(m--){\n\t\tread(Q);re int K=read(),ss=0,vv=0;\n\t\tre ull a=0,b=0,c=0,d=0;\n\t\tfor(re int j=0;j<256;++j)Q[j]=Q[j]^la;\n\t\tfor(re int j=0;j<64;++j)a=(a<<1)+Q[j];\n\t\tfor(re int j=64;j<128;++j)b=(b<<1)+Q[j];\n\t\tfor(re int j=128;j<192;++j)c=(c<<1)+Q[j];\n\t\tfor(re int j=192;j<256;++j)d=(d<<1)+Q[j];\n\t\tfor(re int j=0;j<4&&ss==0;++j){\n\t\t\tre int T=j*65536+((a>>(((j&3)^3)<<4))&65535);\n\t\t\tfor(re int k=head[T];k;k=e[k].next){\n\t\t\t\tre int x=e[k].to;\n\t\t\t\tif(P(a^A[x])+P(b^B[x])+P(c^C[x])+P(d^D[x])<=K){ss=1;break;}\n\t\t\t}\n\t\t}\n\t\tfor(re int j=4;j<8&&ss==0;++j){\n\t\t\tre int T=j*65536+((b>>(((j&3)^3)<<4))&65535);\n\t\t\tfor(re int k=head[T];k;k=e[k].next){\n\t\t\t\tre int x=e[k].to;\n\t\t\t\tif(P(a^A[x])+P(b^B[x])+P(c^C[x])+P(d^D[x])<=K){ss=1;break;}\n\t\t\t}\n\t\t}\n\t\tfor(re int j=8;j<12&&ss==0;++j){\n\t\t\tre int T=j*65536+((c>>(((j&3)^3)<<4))&65535);\n\t\t\tfor(re int k=head[T];k;k=e[k].next){\n\t\t\t\tre int x=e[k].to;\n\t\t\t\tif(P(a^A[x])+P(b^B[x])+P(c^C[x])+P(d^D[x])<=K){ss=1;break;}\n\t\t\t}\n\t\t}\n\t\tfor(re int j=12;j<16&&ss==0;++j){\n\t\t\tre int T=j*65536+((d>>(((j&3)^3)<<4))&65535);\n\t\t\tfor(re int k=head[T];k;k=e[k].next){\n\t\t\t\tre int x=e[k].to;\n\t\t\t\tif(P(a^A[x])+P(b^B[x])+P(c^C[x])+P(d^D[x])<=K){ss=1;break;}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",la=ss);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1627569288,
        "uid": 41476,
        "name": "gyh20",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P7738 [NOI2021] \u91cf\u5b50\u901a\u4fe1"
    },
    {
        "content": "[\u6d1b\u8c37\u9898\u9762\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P7738)\u3002\n\n\u9898\u610f\uff1a\n\n* \u7ed9\u5b9a $n$ \u4e2a $256$ \u4f4d $01$ \u4e32 $s_i$ \u4e14 $s_i$ \u4e3a\u968f\u673a\u751f\u6210\u3002\n* $m$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee\u7ed9\u4e00\u4e2a $256$ \u4f4d $01$ \u4e32 $x$ \u548c\u4e00\u4e2a\u6574\u6570 $k$\uff0c\u95ee\u662f\u5426\u5b58\u5728 $s_i$\uff0c\u4f7f\u5f97 $x$ \u4e0e $s_i$ \u6309\u4f4d\u5f02\u6216\u4e4b\u540e $1$ \u7684\u4e2a\u6570\u4e0d\u5927\u4e8e $k$\u3002\n* \u5f3a\u5236\u5728\u7ebf\u3002\u8f93\u5165\u7ecf\u8fc7\u538b\u7f29\u5904\u7406\u3002\n* $1 \\le n \\le 4\\times 10^5, 1 \\le m \\le 1.2\\times 10^5, 0 \\le k \\le 15$\u3002\n\nNOI2021 \u4e2d\u7b80\u5355\u4f46\u6bd4\u8f83\u6709\u610f\u601d\u7684\u4e00\u9053\u9898\u3002\n\n---\n\n### Solution\uff1a\n\n\u4e00\u770b\u5230\u8fd9\u9898\u5c31\u5e94\u8be5\u6709\u4e00\u79cd\u53cd\u5e94\uff1a$\\boldsymbol{0 \\le k \\le 15}$ \u548c **\u968f\u673a\u751f\u6210** \u8fd9\u4e24\u4e2a\u8f83\u4e3a\u5947\u602a\u7684\u6761\u4ef6\u5fc5\u5b9a\u4f1a\u6709\u4e9b\u7528\u5904\u3002\n\n\u6ce8\u610f\u5230\u9898\u76ee\u4e2d\u6240\u7ed9\u7684 $01$ \u4e32\u5747\u4e3a $256$ \u4f4d\uff0c\u800c $256 = 16\\times 16$\uff0c\u518d\u7ed3\u5408 $0 \\le k \\le 15$ \u8fd9\u4e2a\u6761\u4ef6\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u628a\u6bcf\u4e2a $256$ \u4e3a $01$ \u4e32\u770b\u6210 $16$ \u4e2a $16$ \u4f4d\u7684 $01$ \u4e32\u3002\u8fd9\u6837\u5904\u7406\u7684\u597d\u5904\u662f\uff1a**\u5982\u679c\u4e32 $x$ \u7b26\u5408\u6761\u4ef6\uff0c\u90a3\u4e48\u4e32 $x$ \u81f3\u5c11\u6709\u4e00\u4e2a $16$ \u4f4d $01$ \u4e32\u4e0e $s_i$ \u5bf9\u5e94\u7684 $16$ \u4f4d $01$ \u4e32\u76f8\u540c**\u3002\u800c\u8fd9\u4e2a\u7ed3\u8bba\u53ef\u4ee5\u7528\u62bd\u5c49\u539f\u7406\u7b80\u5355\u5f97\u5230\u3002\n\n\u8003\u8651\u5c06\u6240\u6709 $s_i$ \u7684 $16$ \u4e2a $01$ \u4e32\u90fd\u9884\u5904\u7406\u51fa\u6765\u3002\u6211\u4eec\u5f00\u4e00\u4e2a `vector`\uff0c\u5176\u4e2d `vec[j][k]` \u7528\u6765\u5b58\u50a8\u6ee1\u8db3\u7b2c $j$ \u4e2a $16$ \u4f4d $01$ \u4e32\u4e3a $k$ \u7684\u6240\u6709 $s_i$\u3002\u5728\u6bcf\u6b21\u8be2\u95ee\u7684\u65f6\u5019\uff0c\u6211\u4eec\u628a $x$ \u7684 $16$ \u4e2a $16$ \u4f4d $01$ \u4e32\u4e5f\u5904\u7406\u51fa\u6765\uff0c\u8bb0\u4e3a $y_j(0 \\le j \\le 15)$\uff0c\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $16$ \u4f4d $01$ \u4e32 $y_j$\uff0c\u5229\u7528\u521a\u624d\u7684 `vector` \u67e5\u627e\u6240\u6709\u6ee1\u8db3\u7b2c $j$ \u4e2a $16$ \u4f4d $01$ \u4e32\u4e3a $y_j$ \u7684 $s_i$\uff0c\u6700\u540e\u9a8c\u8bc1\u8fd9\u4e9b $a_i$ \u662f\u5426\u6ee1\u8db3\u6761\u4ef6\u5373\u53ef\u3002\n\n\u9a8c\u8bc1\u7684\u65f6\u5019\u4e5f\u6709\u4e00\u4e2a\u5c0f trick\uff1a\u53ef\u4ee5\u5148\u9884\u5904\u7406\u51fa $0\\sim2^{16}-1$ \u4e2d\u6240\u6709\u6570\u4e8c\u8fdb\u5236\u4e0b\u7684 $1$ \u7684\u4e2a\u6570\u3002\u7136\u540e\u9a8c\u8bc1\u65f6\u4ec5\u9700\u8981\u628a\u6bcf\u4e2a $16$ \u4f4d $01$ \u4e32\u5f02\u6216\u8d77\u6765\uff0c\u6700\u540e\u628a\u8fd9\u4e9b $1$ \u7684\u4e2a\u6570\u52a0\u8d77\u6765\u5373\u53ef\u3002\n\n\u5206\u6790\u4e00\u4e0b\u65f6\u95f4\u590d\u6742\u5ea6\u3002\u7531\u4e8e **\u968f\u673a\u751f\u6210**\uff0c\u56e0\u6b64\u6bcf\u4e00\u6b21\u67e5\u627e\u7684\u671f\u671b\u6b21\u6570\u4e3a $\\dfrac{n}{2^{16}}$\uff0c\u4e8e\u662f\u6839\u636e\u4e0a\u8ff0\u5206\u6790\uff0c\u603b\u671f\u671b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(m\\times 16\\times \\dfrac{n}{2^{16}}\\times 16) = O(\\dfrac{nm}{256})$\uff0c\u6781\u9650\u60c5\u51b5\u4e0b\u662f\u8981 $1.875 \\times 10^8$ \u6b21\u8fd0\u7b97\u3002\u7406\u8bba\u4e0a\u53ef\u4ee5\u901a\u8fc7\u3002\n\n~~\u672c\u4ee5\u4e3a\u9700\u8981\u5361\u5361\u5e38\uff0c\u6ca1\u60f3\u5230\u4ea4\u4e00\u53d1\u5c31\u8fc7\u4e86\uff08~~\n\n---\n\n### Code\uff1a\n\n\u5b9e\u73b0\u8d77\u6765\u8f83\u4e3a\u7b80\u5355\uff0c~~\u5927\u5e38\u6570\u9009\u624b\u6ce8\u610f\u5361\u5e38\uff08~~\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\n#include <cmath>\n#include <vector>\n#include <queue>\n#include <map>\n#include <set>\nusing namespace std;\n#define ll long long\n#define ull unsigned long long\n#define us unsigned short\n#define fi first\n#define se second\n#define dingyi int mid = l + r >> 1, ls = p << 1, rs = p << 1 | 1\n#define y0 y_csyakioi_0\n#define y1 y_csyakioi_1\n#define rep(i, x, y) for(int i = x; i <= y; ++i)\n#define per(i, x, y) for(int i = x; i >= y; --i)\n#define repg(i, u) for(int i = head[u]; i; i = e[i].nxt)\ninline ull read(){\n\tull x = 0, f = 1; char ch = getchar();\n\twhile(ch < '0' || ch > '9'){ if(ch == '-') f = -1; ch = getchar(); }\n\twhile(ch >= '0' && ch <= '9'){ x = x * 10 + (ch ^ 48); ch = getchar(); }\n\treturn x * f;\n}\nconst int N = 400010, M = 65536;\nint n, m, k; ull a1, a2;\nbool s[N + 10][256], b[256], lst;\null myRand(ull &k1, ull &k2) {\n    ull k3 = k1, k4 = k2;\n    k1 = k4;\n    k3 ^= (k3 << 23);\n    k2 = k3 ^ k4 ^ (k3 >> 17) ^ (k4 >> 26);\n    return k2 + k4;\n}\nvoid gen(int n, ull a1, ull a2) {\n    for (int i = 1; i <= n; i++)\n        for (int j = 0; j < 256; j++)\n            s[i][j] = (myRand(a1, a2) & (1ull << 32)) ? 1 : 0;\n}\nvector <int> vec[16][M];\nus num[N][16], pcnt[M], c[16];\ninline void mian(){\n\tn = read(); m = read(); a1 = read(); a2 = read();\n\tgen(n, a1, a2);\n\trep(i, 1, n){\n\t\trep(j, 0, 15){\n\t\t\trep(k, 0, 15){\n\t\t\t\tnum[i][j] += s[i][(j << 4) + k] << k;\n\t\t\t}\n\t\t\tvec[j][num[i][j]].push_back(i);\n\t\t}\n\t}\n\trep(i, 1, M - 1) pcnt[i] = pcnt[i >> 1] + (i & 1);\n\trep(i, 1, m){\n\t\tmemset(b, 0, sizeof(b));\n\t\tmemset(c, 0, sizeof(c));\n\t\trep(j, 0, 63){\n\t\t\tint x = 0;\n\t\t\tchar ch = getchar();\n\t\t\tif(ch >= '0' && ch <= '9') x = ch ^ 48;\n\t\t\telse if(ch >= 'A' && ch <= 'F') x = ch - 'A' + 10;\n\t\t\telse{\n\t\t\t\t--j;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\trep(l, 0, 3) b[(j << 2) + l] = (x >> 3 - l) & 1;\n\t\t}\n\t\tbool ans = 0; k = read();\n\t\tif(lst) rep(j, 0, 255) b[j] ^= lst;\n\t\trep(j, 0, 15) rep(l, 0, 15){\n\t\t\tc[j] += b[j * 16 + l]  << l;\n\t\t} \n\t\trep(j, 0, 15){\n\t\t\tfor(int t : vec[j][c[j]]){\n\t\t\t\tint tot = 0;\n\t\t\t\trep(l, 0, 15){\n\t\t\t\t\ttot += pcnt[num[t][l] ^ c[l]];\n\t\t\t\t\tif(tot > k) break;\n\t\t\t\t}\n\t\t\t\tif(tot <= k){\n\t\t\t\t\tans = 1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(ans) break;\n\t\t}\n\t\tcout << (lst = ans) << '\\n';\n\t}\n}\nint main(){\n\tint qwq = 1; while(qwq--) mian(); return 0;\n}\n```\n",
        "postTime": 1632144681,
        "uid": 147999,
        "name": "Warriors_Cat",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P7738\u3010[NOI2021] \u91cf\u5b50\u901a\u4fe1\u3011"
    },
    {
        "content": "## \u89e3\u9898\u601d\u8def\n\n\u8fd9\u9053\u9898\uff0c\u600e\u4e48\u770b\uff0c\u7b2c\u4e00\u773c\u90fd\u611f\u89c9\u50cf $01$ trie \u554a\u3002\u3002\u3002\u3002\n\n\u5728\u540c\u6b65\u8d5b\u4e2d\u6211\u53d1\u73b0\u4e86 $\\sqrt {256}\\approx 15$\uff0c\u4f46\u662f\u6ca1\u6709\u597d\u597d\u5229\u7528\u3002\n\n\u5176\u5b9e\u8fd9\u5c31\u662f\u672c\u9898\u7684\u7a81\u7834\u53e3\u3002\n\n\u4ee4 $x=2^{16}=65536$\uff0c\u6211\u4eec\u628a\u8be2\u95ee\u4e32\u548c\u5b57\u5178\u4e32\u7531 $16$ \u8fdb\u5236\u548c $2$ \u8fdb\u5236\u6539\u4e3a $x$ \u8fdb\u5236\u3002\u7531\u4e8e\u5728 $2$ \u8fdb\u5236\u4e0b\uff0c\u6700\u591a\u6709 $k$ \u4f4d\u4e0d\u540c\uff0c\u800c $k\\leq 15$\uff0c\u4e5f\u5c31\u662f\u8bf4\u5728 $16$ \u4f4d\u7684 $x$\u200b \u8fdb\u5236\u6570\u4e2d\uff0c\u5b57\u5178\u4e32\u548c\u8be2\u95ee\u4e32\u81f3\u5c11\u4e00\u6709\u4e00\u4f4d\u5b8c\u5168\u76f8\u540c\u3002\u200b\u8fd9\u4e2a\u7531\u62bd\u5c49\u539f\u7406\u53ef\u4ee5\u8bc1\u660e\u3002\n\n\u90a3\u4e48\u601d\u8def\u5c31\u5f88\u660e\u6670\u4e86\u3002\u6211\u4eec\u5148\u9884\u5904\u7406\u5b57\u5178\u4e32\uff0c\u7136\u540e\u7528 `vector` \u8bb0\u5f55\u5728\u7b2c $i$ \u4f4d\u4e0a\u4e3a $j$ \u7684\u8be2\u95ee\u4e32\u7684\u7f16\u53f7\u3002\u90a3\u4e48\u5bf9\u4e8e\u6bcf\u4e00\u4e2a `vector`\uff0c\u5b83\u7684\u5927\u5c0f\u5e73\u5747\u4e3a $\\frac{n}{x}$\u3002\u7531\u4e8e\u6570\u636e\u662f\u7528\u7ed9\u5b9a\u51fd\u6570 `gen` \u751f\u6210\u7684\uff0c\u6570\u636e\u76f8\u5bf9\u6bd4\u8f83\u968f\u673a\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\u5927\u5c0f\u5c31\u57fa\u672c\u4e3a $\\frac nx$ \u5de6\u53f3\u200b\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8be2\u95ee\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u5728 $x$ \u8fdb\u5236\u4e0b\uff0c\u54ea\u4e00\u4f4d\u4e0e\u5b57\u5178\u4e32\u76f8\u7b49\uff0c\u7136\u540e\u53d6\u51fa\u5bf9\u5e94 `vector` \u4e2d\u7684\u6240\u6709\u5b57\u5178\u4e32\uff0c\u66b4\u529b\u7b97\u4e00\u904d\u770b\u770b\u662f\u5426\u7b26\u5408\u8981\u6c42\u5373\u53ef\u3002\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(m\\cdot 16\\cdot \\frac nx\\cdot 256)$\u3002\u628a $x=65536$ \u4ee3\u5165\uff0c\u590d\u6742\u5ea6\u4e3a $O(\\frac{nm}{16})$\u3002\u8fd9\u4e0d\u80af\u5b9a\u7206\u70b8\u5417\uff1f\n\n\u6211\u4eec\u8003\u8651\u5982\u4f55\u7ee7\u7eed\u4f18\u5316\u4e00\u4e0b\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u68c0\u67e5\u5b57\u5178\u4e32\u548c\u8be2\u95ee\u4e32\u662f\u5426\u7b26\u5408\u8981\u6c42\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u8fc7\u9ad8\u3002\u60f3\u529e\u6cd5\u4f18\u5316\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5148\u9884\u5904\u7406\u51fa $\\forall i\\in [0,x),i\\in N^+$\u200b\u200b \u7684 `popcnt`\uff0c\u5373\u4e8c\u8fdb\u5236\u4e0b $1$\u200b\u200b \u7684\u4f4d\u6570\uff0c\u7136\u540e\u5bf9\u4e8e $x$\u200b\u200b \u8fdb\u5236\u4e0b\u7684\u6bcf\u4e00\u4f4d\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5feb\u901f\u6c42\u51fa\u8fd9\u4e00\u4f4d\u4e0a\u6709\u591a\u5c11\u4f4d\u4e8c\u8fdb\u5236\u662f\u4e0d\u540c\u7684\u8fd9\u6837\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u53d8\u4e3a\u4e86 $O(m\\cdot 16\\cdot \\frac nx\\cdot 16)=O(\\frac{nm}{256})$\u200b\u200b \u3002\u628a $n,m$\u200b\u200b \u7684\u6781\u503c\u4ee3\u5165\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5927\u7ea6\u4e3a $O(1.8*10^8)$\u200b\u200b\u200b \u200b\u200b\u3002\n\n\u663e\u7136\u6211\u4eec\u8fd8\u8981\u5361\u5361\u5e38\u3002\n\n\u8fd8\u662f\u518d\u68c0\u9a8c\uff0c\u6211\u4eec\u5b9e\u65f6\u6bd4\u8f83 $k$ \u548c\u5f53\u524d\u4e8c\u8fdb\u5236\u4e0d\u540c\u4f4d\u6570\uff0c\u82e5\u5df2\u7ecf\u8d85\u8fc7\u4e86 $k$\uff0c\u76f4\u63a5\u9000\u51fa\uff0c\u6240\u4ee5\u65f6\u95f4\u662f\u8dd1\u4e0d\u6ee1\u7684\u3002\u5728\u52a0\u4e2a \u5feb\u8bfb\uff0c\u57fa\u672c\u5c31\u8fc7\u4e86\u3002~~\u5f53\u7136\u4f60\u8981\u4fdd\u8bc1\u4f60\u7684\u5176\u4ed6\u5e38\u6570\u4e0d\u662f\u7279\u522b\u5927\u3002~~\n\n\u5982\u679c\u4f60\u5728\u8003\u573a\u4e0a\u60f3\u518d\u7a33\u4e00\u4e9b\uff0c\u8fd8\u53ef\u4ee5\u505a\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n\n- \u628a `vector` \u6539\u6210\u94fe\u8868\u3002\n- \u4e0d\u8981\u7528 `bitset`\u3002\u3001\n- \u5faa\u73af\u5c55\u5f00\n- \u2026\u2026\uff08\u53ef\u4ee5\u53c2\u8003\u5176\u4ed6\u5927\u4f6c\u7684\u535a\u5ba2\uff09\n\n## \u4ee3\u7801\n\n```cpp\n//Don't act like a loser.\n//This code is written by huayucaiji\n//You can only use the code for studying or finding mistakes\n//Or,you'll be punished by Sakyamuni!!!\n#include<bits/stdc++.h>\nusing namespace std;\n\nint read() {\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9') {\n\t\tif(ch>='A'&&ch<='Z')\n\t\t\treturn ch-'A'+10;\n\t\tch=getchar();\n\t}\n\tif(ch>='0'&&ch<='9') {\n\t\treturn ch-'0';\n\t}\n}\n\nconst int MAXN=4e5+10; \n\ntypedef unsigned long long ull;\null n,m,a1,a2;\nint lastans;\nbool s[MAXN][256];\nint cnt[256*256],a[20],b[MAXN][20];\nvector<int> v[17][256*256]; \n\null myRand(ull &k1, ull &k2) {\n    ull k3 = k1, k4 = k2;\n    k1 = k4;\n    k3 ^= (k3 << 23);\n    k2 = k3 ^ k4 ^ (k3 >> 17) ^ (k4 >> 26);\n    return k2 + k4;\n}\n\nvoid gen(int n, ull a1, ull a2) {\n    for (int i = 1; i <= n; i++)\n        for (int j = 0; j < 256; j++)\n            s[i][j] = (myRand(a1, a2) & (1ull << 32)) ? 1 : 0;\n}\n\nint popc(int x) {\n\tint ret=0;\n\twhile(x) {\n\t\tif(x&1) {\n\t\t\tret++;\n\t\t}\n\t\tx>>=1;\n\t}\n\treturn ret;\n}\n\nvoid insert(int k) {\n\tfor(int i=1;i<=16;i++) {\n\t\tint w=0;\n\t\tfor(int j=0;j<16;j++) {\n\t\t\tw=w*2+(s[k][(i-1)*16+j]? 1:0);\n\t\t}\n\t\tb[k][i]=w;\n\t\tv[i][w].push_back(k);\n\t}\n}\n\nbool ok(int j,int k) {\n\tfor(int i=1;i<=16;i++) {\n\t\tk-=cnt[b[j][i]^a[i]];\n\t\tif(k<0) {\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn 1;\n}\nint check(int k) {\n\tfor(int i=1;i<=16;i++) {\n\t\tint sz=v[i][a[i]].size();\n\t\tfor(int j=0;j<sz;j++) {\n\t\t//\tputs(\"ohhhh\");\n\t\t\tif(ok(v[i][a[i]][j],k)) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n\nsigned main() {\n\tfreopen(\"qi.in\",\"r\",stdin);\n\tfreopen(\"qi.out\",\"w\",stdout);\n\n\tfor(int i=0;i<256*256;i++) {\n\t\tcnt[i]=popc(i);\n\t}\n\tcin>>n>>m>>a1>>a2;\n\t\n\tgen(n,a1,a2);\n\tfor(int i=1;i<=n;i++) {\n\t\tinsert(i);\n\t}\n\t\n\twhile(m--) {\n\t\tfor(int i=1;i<=16;i++) {\n\t\t\tint x=read(),y=read(),z=read(),xx=read();\n\t\t\ta[i]=x*16*16*16+y*16*16+z*16+xx;\n\t\t\tif(lastans) {\n\t\t\t\ta[i]=(256*256-1)^a[i];\n\t\t\t}\n\t\t}\n\t\tint k;\n\t\tscanf(\"%d\",&k);\n\t\tprintf(\"%d\\n\",lastans=check(k));\n\t}\n\n\tfclose(stdin);\n\tfclose(stdout);\n\treturn 0;\n}\n\n\n```\n\n",
        "postTime": 1628477682,
        "uid": 132976,
        "name": "huayucaiji",
        "ccfLevel": 6,
        "title": "NOI2021D2T1\u91cf\u5b50\u901a\u4fe1"
    },
    {
        "content": "\u6ce8\uff1a\u672c\u9898\u4e3a NOI2021 D2T1\u3002\n\n## \u9898\u610f\u7b80\u8ff0\n\n\u7ed9\u5b9a\u7531 $n$ \u4e2a\u957f\u5ea6\u4e3a $256$ \u7684 01 \u4e32\u7ec4\u6210\u7684\u5b57\u5178\uff0c\u7136\u540e\u6709 $m$ \u4e2a\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee\u7ed9\u51fa\u4e00\u4e2a\u957f\u5ea6\u4e3a $256$ \u7684 01 \u4e32\u548c\u6574\u6570 $k$\uff0c\u95ee\u5b57\u5178\u4e2d\u662f\u5426\u5b58\u5728\u4e00\u4e2a 01 \u4e32\uff0c\u548c\u8be2\u95ee\u7684 01 \u4e32\u76f8\u6bd4\uff0c\u4e0d\u540c\u7684\u4f4d\u6570 $\\le k\\;(0 \\le k \\le 15)$\u3002\n\n\u5b57\u5178\u7684\u751f\u6210\u65b9\u5f0f\u4e3a\uff1a\u8f93\u5165\u79cd\u5b50 $a_1,a_2$\uff0c\u5c06 $a_1,a_2$ \u4f20\u5165**\u9898\u76ee\u6240\u7ed9\u7684\u968f\u673a\u51fd\u6570**\u4e2d\uff0c\u4fdd\u8bc1 $a_1,a_2$ **\u968f\u673a\u751f\u6210**\u3002\n\n\u672c\u9898\u5f3a\u5236\u5728\u7ebf\uff0c\u52a0\u5bc6\u65b9\u5f0f\u4e3a\uff1a\u6bcf\u6b21\u8be2\u95ee\u7ed9\u51fa\u7684 01 \u4e32\u7684\u6bcf\u4e00\u4f4d\uff0c\u90fd\u8981\u5f02\u6216\u4e0a\u4e00\u6b21\u7684\u7b54\u6848\uff08\u5b58\u5728\u4e3a $1$\uff0c\u5426\u5219\u4e3a $0$\uff0c\u7b2c\u4e00\u6b21\u5c06\u5176\u89c6\u4e3a $0$\uff09\u3002\n\n**\u6570\u636e\u8303\u56f4**\uff1a$1 \\le n \\le 4 \\times 10^5$\uff0c$1 \\le m \\le 1.2 \\times 10^5$\uff0c$a_1,a_2 \\in [0,2^{64}-1]$\u3002\n\n## \u9898\u89e3\n\n\u66b4\u529b\u5f88\u597d\u505a\uff1a\u628a $n$ \u4e2a 01 \u4e32\u6bcf\u4e2a\u90fd\u62ff\u6765\u548c\u5f53\u524d\u8be2\u95ee 01 \u4e32\u6bd4\u8f83\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(256nm)$\u3002\n\n\u8003\u8651\u4f18\u5316\u66b4\u529b\uff1a\u7531\u4e8e $O(nm)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u5df2\u7ecf\u7206\u70b8\uff0c\u56e0\u6b64\u5fc5\u987b\u8981\u51cf\u5c11\u6bd4\u8f83\u7684 01 \u4e32\u4e2a\u6570\u3002\n\n\u6ce8\u610f\u5230 $k \\le 15$\uff0c\u53c8\u56e0\u4e3a\u957f\u5ea6\u4e3a $256=16 \\times 16$\uff0c\u4e8e\u662f\u628a\u6bcf\u4e2a 01 \u4e32**\u5747\u5300\u5212\u5206\u4e3a $16$ \u6bb5**\uff0c\u90a3\u4e48\u4e0e\u5f53\u524d\u8be2\u95ee\u4e32\u4e0d\u540c\u4f4d\u6570 $\\le 15$ \u7684 01 \u4e32\uff0c**\u5fc5\u7136\u6709\u81f3\u5c11\u4e00\u6bb5\u4e0e\u5f53\u524d\u8be2\u95ee\u4e32\u5b8c\u5168\u76f8\u540c**\u3002\n\n\u9884\u5904\u7406 $id[i][j]$\uff0c\u7528\u4e8e\u5b58\u50a8\u5b57\u5178\u4e2d\u7b2c $i$ \u6bb5\u4e3a $j$ \u7684\u6240\u6709 01 \u4e32\u7684\u7f16\u53f7\u3002  \n\uff08\u7b2c $i$ \u6bb5\u4e3a $j$\uff1a\u5c06\u8fd9\u4e00\u6bb5\u770b\u6210\u4e8c\u8fdb\u5236\u6570\uff0c\u5176\u503c\u4e3a $j$\uff09\n\n\u90a3\u4e48\u679a\u4e3e\u76f8\u540c\u7684\u662f\u54ea\u4e00\u6bb5\uff0c\u5c31\u53ef\u4ee5\u53ea\u6bd4\u8f83\u5b57\u5178\u4e2d\u6709\u81f3\u5c11\u4e00\u6bb5\u4e0e\u5f53\u524d\u8be2\u95ee\u4e32\u5b8c\u5168\u76f8\u540c\u7684 01 \u4e32\u3002\n\n\u6bd4\u8f83\u65b9\u6cd5\u4e3a\uff1a\u9884\u5904\u7406 $[0,2^{16}-1]$ \u4e2d\u6bcf\u4e2a\u6570\u5728\u4e8c\u8fdb\u5236\u4e0b $1$ \u7684\u4e2a\u6570\uff0c\u7136\u540e**\u5bf9\u4e8e $16$ \u6bb5\u4e2d\u7684\u6bcf\u4e00\u6bb5\uff0c\u5c06\u8981\u6bd4\u8f83\u7684\u4e32\u548c\u5f53\u524d\u8be2\u95ee\u4e32\u5f02\u6216\uff0c\u5f02\u6216\u503c\u5728\u4e8c\u8fdb\u5236\u4e0b $1$ \u7684\u4e2a\u6570\u5373\u4e3a\u8fd9\u4e00\u6bb5\u4e0d\u540c\u7684\u4f4d\u6570\u3002**\n\n\u7531\u4e8e\u5b57\u5178\u4e2d\u7684 01 \u4e32\u968f\u673a\u751f\u6210\uff0c\u5355\u6b21\u8be2\u95ee\u671f\u671b\u6bd4\u8f83\u7684 01 \u4e32\u4e2a\u6570\u4e3a $O(16 \\times \\dfrac{n}{65536})$\uff0c**\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\dfrac{nm}{256})$**\u3002\n\n## \u4ee3\u7801\n\n\u542c\u8bf4\u8fd9\u9898\u5f88\u5361\u5e38\uff1f\u4e2a\u4eba\u89c9\u5f97\u8fd8\u597d\u2014\u2014\u9664\u4e86 **$16$ \u6bb5\u6bd4\u8f83\u7684\u90e8\u5206\u7528\u4e86\u5faa\u73af\u5c55\u5f00**\uff0c\u5176\u5b83\u4e5f\u6ca1\u6709\u7279\u610f\u5361\u5e38\u3002\n\n\u6ce8\uff1a\u5faa\u73af\u5c55\u5f00\u7684\u90e8\u5206\uff0c\u53ef\u4ee5\u6bcf\u52a0 $1$ \u6b21\u5c31\u5224\u65ad\u4e00\u4e0b\u662f\u5426 $>k$\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\n\n``` cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N = 400000;\nbool s[N+1][256];\nnamespace generator\n{\n\ttypedef unsigned long long ull;\n\tull myRand(ull &k1, ull &k2) {\n\t    ull k3 = k1, k4 = k2;\n\t    k1 = k4;\n\t    k3 ^= (k3 << 23);\n\t    k2 = k3 ^ k4 ^ (k3 >> 17) ^ (k4 >> 26);\n\t    return k2 + k4;\n\t}\n\tvoid gen(int n, ull a1, ull a2) {\n\t    for (int i = 1; i <= n; i++)\n\t        for (int j = 0; j < 256; j++)\n\t            s[i][j] = (myRand(a1, a2) & (1ull << 32)) ? 1 : 0;\n\t}\n}\nvector<int> id[16][65536];\nchar str[70];\nint val[N+1][16],cnt_bits[65536],vis[N+1];\nint main()\n{\n\tint n,m;\n\tunsigned long long a1,a2;\n\tscanf(\"%d%d%llu%llu\",&n,&m,&a1,&a2);\n\tgenerator::gen(n,a1,a2);\n\tfor(int k=1;k<=n;++k)\n\t\tfor(int i=0;i<16;++i)\n\t\t{\n\t\t\tint l=i<<4,r=l^15,v=0;\n\t\t\tfor(int j=l;j<=r;++j)\n\t\t\t\tv=v<<1|s[k][j];\n\t\t\tval[k][i]=v;\n\t\t\tid[i][v].push_back(k);\n\t\t}\n\tfor(int i=1;i<65536;++i)\n\t\tcnt_bits[i]=cnt_bits[i>>1]+(i&1);\n\tint ans=0;\n\tfor(int t=1;t<=m;++t)\n\t{\n\t\tint k;\n\t\tscanf(\"%s%d\",str,&k);\n\t\tfor(int i=0;i<16;++i)\n\t\t{\n\t\t\tval[0][i]=0;\n\t\t\tint l=i<<2,r=l^3;\n\t\t\tfor(int j=l;j<=r;++j)\n\t\t\t{\n\t\t\t\tint v=str[j]>='0'&&str[j]<='9'?str[j]^48:str[j]-'A'+10; \n\t\t\t\tval[0][i]=val[0][i]<<4|v;\n\t\t\t}\n\t\t\tif(ans)\n\t\t\t\tval[0][i]^=65535;\n\t\t}\n\t\tans=0;\n\t\tfor(int i=0;i<16;++i)\n\t\t{\n\t\t\tint v=val[0][i];\n\t\t\tfor(vector<int>::iterator it=id[i][v].begin();it!=id[i][v].end();++it)\n\t\t\t{\n\t\t\t\tint x=*it;\n\t\t\t\tif(vis[x]!=t)\n\t\t\t\t{\n\t\t\t\t\tvis[x]=t;\n\t\t\t\t\tint cnt_dif=0;\n\t\t\t\t\tcnt_dif+=cnt_bits[val[x][0]^val[0][0]];\n\t\t\t\t\tcnt_dif+=cnt_bits[val[x][1]^val[0][1]];\n\t\t\t\t\tif(cnt_dif>k)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcnt_dif+=cnt_bits[val[x][2]^val[0][2]];\n\t\t\t\t\tcnt_dif+=cnt_bits[val[x][3]^val[0][3]];\n\t\t\t\t\tif(cnt_dif>k)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcnt_dif+=cnt_bits[val[x][4]^val[0][4]];\n\t\t\t\t\tcnt_dif+=cnt_bits[val[x][5]^val[0][5]];\n\t\t\t\t\tif(cnt_dif>k)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcnt_dif+=cnt_bits[val[x][6]^val[0][6]];\n\t\t\t\t\tcnt_dif+=cnt_bits[val[x][7]^val[0][7]];\n\t\t\t\t\tif(cnt_dif>k)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcnt_dif+=cnt_bits[val[x][8]^val[0][8]];\n\t\t\t\t\tcnt_dif+=cnt_bits[val[x][9]^val[0][9]];\n\t\t\t\t\tif(cnt_dif>k)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcnt_dif+=cnt_bits[val[x][10]^val[0][10]];\n\t\t\t\t\tcnt_dif+=cnt_bits[val[x][11]^val[0][11]];\n\t\t\t\t\tif(cnt_dif>k)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcnt_dif+=cnt_bits[val[x][12]^val[0][12]];\n\t\t\t\t\tcnt_dif+=cnt_bits[val[x][13]^val[0][13]];\n\t\t\t\t\tif(cnt_dif>k)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcnt_dif+=cnt_bits[val[x][14]^val[0][14]];\n\t\t\t\t\tcnt_dif+=cnt_bits[val[x][15]^val[0][15]];\n\t\t\t\t\tif(cnt_dif<=k)\n\t\t\t\t\t{\n\t\t\t\t\t\tans=1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(ans==1)\n\t\t\t\tbreak;\n\t\t}\n\t\tprintf(\"%d\\n\",ans);\n\t}\n    return 0;\n}\n```",
        "postTime": 1627634947,
        "uid": 145355,
        "name": "wsyhb",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011\u6d1b\u8c37 P7738 [NOI2021] \u91cf\u5b50\u901a\u4fe1"
    },
    {
        "content": "\u8fd9\u91cc\u662f\u4e00\u4e2a\u7a33\u5b9a\u6b63\u786e\u7684\u505a\u6cd5\uff08\uff09\n\n\u6ce8\u610f\u5230 $k \\leq 15$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u4e2a\u5206\u6210 $\\text{16}$ \u4e2a\u5757\u3002\n\n\u6bcf\u4e00\u5757\u4e3a $\\text{65536}$\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u6709\u4e00\u4e2a\u5757\u91cc\u9762\u80af\u5b9a\u662f\u6ca1\u6709\u7ffb\u8f6c\u7684\u3002\n\n\u7531\u4e8e\u5b57\u5178\u662f\u968f\u673a\u7684\uff0c\u7b26\u5408\u7684\u4e2a\u6570\u671f\u671b\u662f $400000 \\div 65536$\u3002\n\n\u7136\u540e\u6211\u4eec\u679a\u4e3e\u54ea\u4e00\u5757\u6ca1\u6709\u5b8c\u5168\u88ab\u7ffb\u8f6c\uff0c$\\text{bitset}$ \u6bd4\u5bf9\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u5355\u6b21\u671f\u671b\u590d\u6742\u5ea6 $\\frac{256}w{}\\times \\frac{n}{65536}\\times 16 \\approx \\frac{n}{64w}$\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, x, y) for (int i = x; i < y; i++)\n#define all(v) begin(v), end(v)\n#ifdef LOCAL\n#include \"C:\\Users\\15328\\Desktop\\tmp.hpp\"\n#define debug(...) cerr << \"[\" << #__VA_ARGS__ << \"]:\", debug_out(__VA_ARGS__)\n#else\n#define debug(...) 42\n#endif\nusing namespace std;\nmt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\ntemplate<class T>\nistream &operator>> (istream &in, vector<T> &v) {\n for (auto &x : v) {\n  in >> x;\n }\n return in;\n}\ninline int gc() {\n static char buf[1048576], *p1 = buf, *p2 = buf;\n return (p1 == p2) && (p2 = (p1 = buf) + fread(buf, 1, 1048576, stdin), p1 == p2) ? EOF : *p1++;\n}\nvoid read(int &x) {\n char c = gc();\n while (!isdigit(c)) {\n  c = gc();\n }\n x = 0;\n while (isdigit(c)) {\n  x = x * 10 + c - '0';\n  c = gc();\n }\n}\nvoid read(unsigned long long &x) {\n char c = gc();\n while (!isdigit(c)) {\n  c = gc();\n }\n x = 0;\n while (isdigit(c)) {\n  x = x * 10 + c - '0';\n  c = gc();\n }\n}\nvoid read(char &x) {\n x = gc();\n while (isspace(x)) {\n  x = gc();\n }\n}\ntypedef unsigned long long ull;\nint n, m;\null a1, a2;\nvector<int> a[16][65536];\nvector<bitset<256>> s;\nvector<array<int, 16>> ss;\ninline ull myRand(ull &k1, ull &k2) {\n ull k3 = k1, k4 = k2;\n k1 = k4;\n k3 ^= (k3 << 23);\n k2 = k3 ^ k4 ^ (k3 >> 17) ^ (k4 >> 26);\n return k2 + k4;\n}\nvoid gen(int n, ull a1, ull a2) {\n s.resize(n);\n rep (i, 0, n)\n  rep (j, 0, 256)\n   s[i][j] = (myRand(a1, a2) & (1ull << 32)) ? 1 : 0;\n ss.resize(n);\n rep (i, 0, n) {\n  rep (j, 0, 16) {\n   int l = j * 16;\n   int r = (j + 1) * 16;\n   int x = 0;\n   rep (k, l, r) {\n    x = x << 1 | s[i][k];\n   }\n   ss[i][j] = x;\n  }\n }\n}\nbool ans;\nbitset<256> t;\narray<int, 16> tt;\nvoid solve() {\n int tmp = 0;\n rep (j, 0, 64) {\n  char c;\n  read(c);\n  int a;\n  if (c <= '9') {\n   a = c - 48;\n  } else {\n   a = c - 55;\n  }\n  t[tmp++] = a >> 3;\n  t[tmp++] = a >> 2 & 1;\n  t[tmp++] = a >> 1 & 1;\n  t[tmp++] = a & 1;\n }\n if (ans) {\n  rep (i, 0, 256) {\n   t[i] = !t[i];\n  }\n }\n ans = false;\n int K;\n read(K);\n rep (j, 0, 16) {\n  int l = j * 16;\n  int r = (j + 1) * 16;\n  int x = 0;\n  rep (k, l, r) {\n   x = x << 1 | t[k];\n  }\n  tt[j] = x;\n }\n int *T = tt.data();\n rep (j, 0, 16) {\n  const auto &v = a[j][*T++];\n  for (const auto &i : v) {\n   if ((int) (t ^ s[i]).count() <= K) {\n    ans = true;\n    return;\n   }\n  }\n }\n}\nint main() {\n read(n);\n read(m);\n read(a1);\n read(a2);\n gen(n, a1, a2);\n rep (i, 0, n) {\n  rep (j, 0, 16) {\n   a[j][ss[i][j]].emplace_back(i);\n  }\n }\n rep (i, 0, m) {\n  solve();\n  if (ans) {\n   putchar('1');\n  } else {\n   putchar('0');\n  }\n  putchar('\\n');\n }\n}\n```",
        "postTime": 1627461618,
        "uid": 96580,
        "name": "SXNhdW5veWE",
        "ccfLevel": 7,
        "title": "NOI 2021 D2T1"
    },
    {
        "content": "\u795e\u5fc5\u968f\u673a\u9898\uff0c\u88ab\u5404\u79cd\u4e71\u6740\u3002                 \n\n\u9898\u610f\uff1a\u6709 $n$ \u4e2a\u957f\u4e3a $256$ \u7684\u539f\u4e32\uff0c\u73b0\u5728\u7ed9\u51fa\u591a\u4e2a\u957f\u4e3a $256$ \u7684\u8be2\u95ee\u4e32\u8be2\u95ee\u662f\u5426\u6709\u81f3\u5c11\u4e00\u4e2a\u539f\u4e32\u6ee1\u8db3\u8fd9\u4e2a\u8be2\u95ee\u4e32\u548c\u539f\u4e32\u53ea\u6709\u81f3\u591a $k$ \u4e2a\u4f4d\u7f6e\u4e0d\u4e00\u6837\uff0c\u5176\u4e2d $k$ \u968f\u6bcf\u4e2a\u8be2\u95ee\u4e32\u53d8\u5316\u3002\n\n\u6211\u4eec\u8003\u8651\u5b57\u5178\u4e32\u662f\u968f\u673a\u7684\uff0c\u7531\u4e8e $k$ \u53ea\u6709 $15$ \u4ee5\u5185\u6240\u4ee5\u5982\u679c\u6211\u4eec\u628a\u957f\u4e3a $256$ \u7684\u4e32\u5206\u6210\u957f\u4e3a $16$ \u7684 $16$ \u4e2a\u5757\u7684\u8bdd\uff0c\u5c31\u5fc5\u5b9a\u6709\u4e00\u4e2a\u5757\u6ee1\u8db3\u8be2\u95ee\u4e32\u7684\u5757\u548c\u5339\u914d\u539f\u4e32\u7684\u5757\u957f\u7684\u4e00\u6a21\u4e00\u6837\uff0c\u6240\u4ee5\u6211\u4eec\u5982\u679c\u76f4\u63a5\u679a\u4e3e\u8fd9\u4e2a\u5339\u914d\u5757\u7684\u8bdd\uff0c\u7531\u4e8e\u5b57\u5178\u4e32\u968f\u673a\u6240\u4ee5\u6b64\u65f6\u5177\u6709\u8fd9\u4e2a\u5339\u914d\u5757\u7684\u671f\u671b\u5b57\u5178\u4e32\u6570\u91cf\u5f88\u5c11\uff0c\u6240\u4ee5\u6211\u4eec\u628a\u8fd9\u4e9b\u5b57\u5178\u4e32\u62ff\u51fa\u6765\u66b4\u529b\u5339\u914d\u5373\u53ef\u3002             \n\n\u8fd9\u91cc\u4ecb\u7ecd\u51e0\u4e2a\u6bd4\u8f83\u5b9e\u7528\u7684\u5361\u5e38\u6280\u5de7\uff1a              \n\n- \u6211\u4eec\u5728\u9884\u5904\u7406\u65f6\u6709\u4e00\u4e2a $O(256n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u8fd9\u91cc\u5927\u5bb6\u6ce8\u610f\u5b9e\u73b0\u7684\u65f6\u5019\u5e38\u6570\u4e0d\u80fd\u8d85\u8fc7 $2$ \u4e0d\u7136\u57fa\u672c\u4e0a\u5c31 T \u4e86\uff1b              \n\n- \u5728\u66b4\u529b\u5339\u914d\u4e24\u4e2a\u4e32\u7684\u65f6\u5019\u53ef\u4ee5\u5199 bitset \u6216\u8005\u76f4\u63a5\u5206\u5757\u7b97 $1$ \u7684\u6570\u91cf\uff0c\u8fd9\u91cc\u6211\u7528\u7684\u662f\u5206\u5757\u7b97 $1$ \u7684\u4e2a\u6570\u3002             \n\n- \u6362 vector \uff1b",
        "postTime": 1627475094,
        "uid": 132533,
        "name": "Hakuoro",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P7738 [NOI2021] \u91cf\u5b50\u901a\u4fe1"
    },
    {
        "content": "\u8bb0 $256$\u200b \u4f4d 01 \u4e32\u4e3a Z \u4e32\u3002\u5bf9\u4e8e\u4e24 Z \u4e32 $s, t$\uff0c\u5b9a\u4e49 $c(s, t) = \\sum [s_i \\neq t_i]$\u3002\n\n\u7ed9\u51fa\u5305\u542b $n$\u200b\u200b \u4e2a Z \u4e32 $s_{1 \\cdots n}$\u200b\u200b \u7684\u5b57\u5178 $S$\u200b\u200b\u3002$m$\u200b\u200b\u200b \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u7ed9\u51fa Z \u4e32 $t_i$\u200b\u200b \u4e0e\u975e\u8d1f\u6574\u6570 $k_i$\uff0c\u95ee\u662f\u5426\u5b58\u5728 $s_i$ \u6ee1\u8db3 $c(s_i, t) \\leq k_i$\u200b\u3002\n\n$S$ \u968f\u673a\u751f\u6210\uff0c$1 \\leq n \\leq 4 \\times 10^5$\uff0c$1 \\leq m \\leq 1.2 \\times 10^5$\uff0c$0 \\leq k_i \\leq 15$\u3002\n\n---\n\n\u8003\u8651\u5c06\u6240\u6709 Z \u4e32\u5206\u4e3a $16$ \u6bb5\u5206\u522b\u538b\u5165\u6574\u6570\u4e2d\uff0cZ \u4e32 $s$ \u7684\u7b2c $i$ \u6bb5\u8bb0\u4e3a $s_i(0 \\le i \\lt 16)$\u3002\n\n\u53d1\u73b0 $a_1, a_2$\u200b\u200b \u968f\u673a\uff0c\u53c8\u53d1\u73b0 $k \\le 15$\u200b\u200b\u200b\u200b\uff0c\u8003\u8651\u5230 $c(s_j, t_i) \\le k \\implies \\exists s_{j, p} = t_{i, p}$\u200b\u200b\uff0c\u4e8e\u662f\u8003\u8651\u7528\u4e00\u4e0d\u5b9a\u957f\u6570\u7ec4 $id_{i, j}$\u200b\u200b \u5b58\u50a8\u6240\u6709\u6ee1\u8db3 $s_{l, i} = j$\u200b\u200b \u7684 $s_l$\u200b\u200b \u7684\u7f16\u53f7 $l$\u200b\u200b\u200b\u3002\n\n$\\forall 0 \\le j \\lt 16$\uff0c\u8bbf\u95ee\u6240\u6709\u7684 $id(j, t_{i, j})$\u200b\uff0c\u5224\u65ad\u662f\u5426\u6ee1\u8db3\u6761\u4ef6\u5373\u53ef\u3002\n\n> \u8fd9\u91cc\u7684\u5224\u65ad\u53ef\u4ee5\u7528 $\\operatorname{xor}$\u200b\u200b & $\\operatorname{lowbit}$\u200b\u200b \u8fdb\u884c\u4f18\u5316\u3002\n>\n> \u6211\u4eec\u5c06\u6bcf\u56db\u6bb5\u538b\u6210\u4e00\u4e2a `long long unsigned int` \u5b58\u50a8\uff0c\u5c06\u56db\u5bf9 `long long unsigned int` \u5206\u522b\u5f02\u6216\uff0c\u91cd\u590d\u53d6 $\\operatorname{lowbit}$ \u5373\u53ef\u3002\n>\n> \u8fd9\u6837\u5176\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal O(res)$\u200b \u7684\u3002\n>\n> \u4e00\u65e6\u627e\u5230\u8d85\u8fc7 $k_i$ \u4f4d\u4e0d\u540c\u5c31\u4e0d\u518d\u7ee7\u7eed\u5bfb\u627e\u3002\u8fd9\u6837\u53ef\u4ee5\u5c06\u4e00\u4e2a $256$ \u7684\u5e38\u6570\u53d8\u4e3a $\\mathcal O(k_i)$\u200b\u200b\u3002\n\n$16$\u200b\u200b \u4e0e $k_i$\u200b\u200b \u540c\u9636\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(\\frac{nmk^2}{2^k})$\u200b\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $\\mathcal O(k(n + 2^k))$\u200b\uff0c\u590d\u6742\u5ea6\u7a0d\u5927\uff0c\u53ef\u8fc7\u3002\n\n---\n\n\uff08\u5220\u53bb\u8c03\u8bd5\u8bed\u53e5\u7684\u8003\u573a\u4ee3\u7801\u5982\u4e0b\uff0c\u53ef\u80fd\u7a0d\u6709\u5b9a\u4e49\u4e0a\u7684\u4e0d\u540c\u3002\u5c06\u9760\u524d\u7684\u4f4d\u7f6e\u538b\u5165\u4e86\u4f4e\u4f4d\u3002\uff09\n\n```cpp\n# include <cctype>\n# include <ciso646>\n# include <cstdio>\n# include <vector>\n\nnamespace Main {\n  namespace File {\n    struct File {\n      File() { freopen(\"qi.in\", \"r\", stdin), freopen(\"qi.out\", \"w\", stdout); }\n      compl File() { fclose(stdin), fclose(stdout); }\n    } file;\n  }\n  typedef unsigned int uint;\n  typedef short unsigned int hu;\n  typedef long long unsigned int llu;\n  typedef std::vector<uint> vector;\n  template <typename T> static inline const T lowbit(const T x) { return x bitand ~x + 1; }\n  static const uint N(4e5);\n  static uint n, m;\n  static llu a1, a2;\n  static llu s[N + 1][4];\n  static llu b[4];\n  static hu k;\n  static vector id[16][1 << 16];\n  static bool vis[N + 1];\n  static bool lastans;\n  static inline const llu myRand(llu& k1, llu& k2) {\n    llu k3(k1), k4(k2);\n    k1 = k4, k3 ^= k3 << 23, k2 = k3 ^ k4 ^ (k3 >> 17) ^ (k4 >> 26);\n    return k2 + k4;\n  }\n  static inline const void gen(const uint n, llu a1, llu a2) {\n    for (register uint i = 1; i <= n; i++)\n      for (hu j(0); j < 4; ++j) for (hu k(0); k < 64; ++k) s[i][j] or_eq (myRand(a1, a2) >> 32 & 1) << k;\n  }\n  static inline const void init() {\n    for (hu j(0); j < 16; ++j) for (register uint i(1); i <= n; ++i)\n      id[j][s[i][j / 4] >> j % 4 * 16 & (1 << 16) - 1].push_back(i);\n  }\n  static inline const hu count(const llu s[4], const llu t[4]) {\n    hu r(0);\n    for (hu i(0); i < 4; ++i) {\n      llu u(s[i] xor t[i]);\n      while (r <= k and u) ++r, u ^= lowbit(u);\n    }\n    return r;\n  }\n  static inline const hu reverse4(const hu x) {\n    hu o(x >> 0 bitand 1), p(x >> 1 bitand 1), q(x >> 2 bitand 1), r(x >> 3 bitand 1);\n    return o << 3 bitor p << 2 bitor q << 1 bitor r << 0;\n  }\n  static inline const void solve() {\n    static char t[64 + 1]; /*static hu k;*/ scanf(\"%s%hu\", t, &k), b[3] = b[2] = b[1] = b[0] = 0;\n    for (hu i(0); i < 64; ++i) b[i / 16] or_eq (const llu)reverse4(isdigit(t[i]) ? t[i] - '0' : t[i] - 'A' + 10) << i % 16 * 4;\n    if (lastans) b[0] = ~b[0], b[1] = ~b[1], b[2] = ~b[2], b[3] = ~b[3];\n    for (hu i(0); i < 4; ++i) for (hu l(0); l < 4; ++l) for (uint j(0); j < id[i * 4 + l][b[i] >> l * 16 & (1 << 16) - 1].size(); ++j)\n      if (count(s[id[i * 4 + l][b[i] >> l * 16 & (1 << 16) - 1][j]], b) <= k) { puts(\"1\"), lastans = 1; return; }\n    puts(\"0\"), lastans = 0;\n  }\n  static inline const void main() {\n    scanf(\"%u%u%llu%llu\", &n, &m, &a1, &a2), gen(n, a1, a2), init();\n    for (register uint i(0); i < m; ++i) solve();\n  }\n}\n\nsigned int main() { Main::main(); return 0; }\n```",
        "postTime": 1627471443,
        "uid": 236807,
        "name": "Mitama",
        "ccfLevel": 9,
        "title": "[Solution] NOI 2021 D2A qi"
    },
    {
        "content": "\u8003\u8651\u5230\u5355\u8bcd\u968f\u673a\uff0c\u6bcf\u4e00\u4e2a\u8be2\u95ee\u80fd\u5339\u914d\u5230\u7684\u5355\u8bcd\u671f\u671b\u4e4b\u591a\u4e3a 1\u3002\n\n\u518d\u8003\u8651\u5230 $k$ \u6700\u5927\u4e3a 15\uff0c\u968f\u673a\u53d6 $p$ \u4e2a\u4f4d\u7f6e\u7684\u65f6\u5019\uff0c**\u5982\u679c\u6709\u89e3** \u8fd9 $p$ \u4e2a\u4f4d\u7f6e **\u5168\u5339\u914d** \u7684\u6982\u7387\u81f3\u5c11\u4e3a $\\left(1-\\frac{k}{256}\\right)^p$\u3002\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u5728\u6240\u6709\u8be2\u95ee\u4e4b\u524d\u63d0\u524d\u8bbe\u5b9a\u8fd9 $p$ \u4e2a\u4f4d\u7f6e\uff0c\u5e76\u5bf9\u8fd9 $p$ \u4e2a\u4f4d\u7f6e\u4e0a\u7684\u6240\u6709 $2^p$ \u53ef\u80fd\u7684\u7ec4\u5408\uff0c\u5904\u7406\u51fa\u8be5\u7ec4\u5408\u5728\u54ea\u4e9b\u5355\u8bcd\u91cc\u51fa\u73b0\u3002\n\n\u6765\u56de\u7b54\u8be2\u95ee\uff0c\u627e\u5230\u8be2\u95ee\u4e2d\u8fd9 $p$ \u4e2a\u4f4d\u7f6e\u5bf9\u5e94\u7684\u7ec4\u5408\u3002\u63a5\u4e0b\u6765\u53ef\u4ee5\u627e\u5230\u6240\u6709\u5728\u8fd9 $p$ \u4e2a\u4f4d\u7f6e\u4e0a\u548c\u8be5\u8be2\u95ee\u4e00\u6837\u7684\u5355\u8bcd\uff0c\u5c06\u5b83\u4eec\u66b4\u529b bitset \u5c1d\u8bd5\u5339\u914d\u5373\u53ef\u3002\n\n\u8fd9\u6837\u6bcf\u4e00\u6b21\u8be2\u95ee\u5e73\u5747\u8981\u505a $\\frac{n}{2^k}$ \u6b21 bitset \u5339\u914d\u3002\u5f53 $k$ \u592a\u5c0f\u8fd9\u548c\u66b4\u529b\u6ca1\u6709\u672c\u8d28\u533a\u522b\uff0c\u4f46\u662f\u5f53 $k$ \u592a\u5927\u6b63\u786e\u7387\u8fc7\u4e8e\u5c0f\u3002\u4e8e\u662f\u53ef\u4ee5\u9009 $q$ \u5957 $p$ \u4e2a\u4f4d\u7f6e\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u65e0\u89e3\u8be2\u95ee\uff0c\u4e0d\u53ef\u80fd\u627e\u5230\u89e3\uff0c\u4f46\u662f\u5bf9\u4e8e\u4e00\u4e2a\u6709\u89e3\u8be2\u95ee\u53ef\u80fd\u4f1a\u5931\u8d25\uff0c\u5e76\u9700\u8981\u5206\u6790\u5931\u8d25\u6982\u7387\u3002\u901a\u8fc7 $q$ \u5957\u4f4d\u7f6e\u4e2d **\u81f3\u5c11\u4e00\u4e2a** \u7684\u6982\u7387\u81f3\u5c11\u4e3a\n\n$$1-\\left(1-\\left(1-\\frac{k}{256}\\right)^p\\right)^q$$\n\n\u901a\u8fc7\u6240\u6709\u8be2\u95ee\u7684\u6982\u7387\u5219\u4e3a\n\n$$\\left(1-\\left(1-\\left(1-\\frac{k}{256}\\right)^p\\right)^q\\right)^m$$\n\n\u800c\u603b\u5171\u9700\u8981\u8fdb\u884c\n\n$$\\frac{nmq}{2^k}$$\n\n\u6b21 bitset \u5339\u914d\u3002\u9700\u8981\u5e73\u8861\u6b63\u786e\u7387\u548c\u6240\u7528\u65f6\u95f4\uff0c\u6211\u53d6\u4e86 $k=16$ $q=36$\u3002\u8fd9\u6837\u901a\u8fc7\u6240\u6709\u8be2\u95ee\u7684\u6982\u7387\u4e3a $99.7\\%$\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define all(a) a.begin(), a.end()\n#define fi first\n#define se second\n#define pb push_back\n#define mp make_pair\n\nusing ll = long long;\nusing pii = pair<int, int>;\n//#define int ll\n\nconst int MOD = 1000000007;\n\ntypedef unsigned long long ull;\nconst int maxN = 400000;\nbitset<256> s[maxN + 5];\nvoid gen(int n, ull a1, ull a2) {\n  for (int i = 1; i <= n; i++)\n    for (int j = 0; j < 256; j++) {\n      ull k3 = a1, k4 = a2;\n      a1 = k4;\n      k3 ^= (k3 << 23);\n      a2 = k3 ^ k4 ^ (k3 >> 17) ^ (k4 >> 26);\n      s[i][j] = ((a1 + a2) & (1ull << 32)) ? 1 : 0;\n    }\n}\n\nconst int ITS = 36;\nconst int BT = 16;\nint pos[ITS][BT];\nint reality[ITS][400005];\nint reality_begin[ITS][(1 << BT) + 1];\nint tva[400005];\n\nmt19937 rng(108616);\n\nvoid init(int n) {\n  for (int idx = 0; idx < ITS; idx++) {\n    set<int> poss;\n    while (poss.size() != BT)\n      poss.insert(rng() % 256);\n    copy(all(poss), pos[idx]);\n    for (int i = 1; i <= n; i++) {\n      int va = 0;\n      for (int j = 0; j < BT; j++)\n        va |= (s[i][pos[idx][j]] << j);\n      tva[i] = va;\n      reality_begin[idx][va]++;\n    }\n    for (int i = 1; i <= (1 << BT); i++)\n      reality_begin[idx][i] += reality_begin[idx][i - 1];\n    for (int i = 1; i <= n; i++)\n      reality[idx][--reality_begin[idx][tva[i]]] = i;\n  }\n}\n\nbitset<256> q;\nint pp[256];\n\nint main() {\n  ios_base::sync_with_stdio(false);\n  cin.tie(0);\n  int n, m;\n  ull a1, a2;\n  cin >> n >> m >> a1 >> a2;\n  gen(n, a1, a2);\n  init(n);\n  for (char c = '0'; c <= '9'; c++)\n    pp[c] = c - '0';\n  for (char c = 'A'; c <= 'F'; c++)\n    pp[c] = c - 'A' + 10;\n  int la = 0;\n  while (m--) {\n    string st;\n    cin >> st;\n    for (int i = 0; i < 64; i++)\n      for (int j = 0; j < 4; j++)\n        q[i * 4 + j] = (pp[st[i]] & (1 << (3 - j)));\n    if (la)\n      for (int i = 0; i < 256; i++)\n        q[i] = q[i] ^ 1;\n    int k;\n    cin >> k;\n    int found = 0;\n    for (int idx = 0; idx < ITS; idx++) {\n      int va = 0;\n      for (int j = 0; j < BT; j++)\n        va |= (q[pos[idx][j]] << j);\n      int be = reality_begin[idx][va], en = reality_begin[idx][va + 1];\n      for (int i = be; i < en; i++)\n        if ((q ^ s[reality[idx][i]]).count() <= k) {\n          found = 1;\n          break;\n        }\n      if (found)\n        break;\n    }\n    cout << (la = found) << '\\n';\n  }\n  return 0;\n}\n```",
        "postTime": 1627466292,
        "uid": 220037,
        "name": "w33z8kqrqk8zzzx33",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 [NOI2021] \u91cf\u5b50\u901a\u4fe1"
    },
    {
        "content": "~~\u5efa\u8bae\u964d\u7eff\u4ee5\u4e0b~~\n\n\u6ce8\u610f\u5230 $ k_i\\le15=16-1=\\frac{256}{16} $\uff0c\u4e8e\u662f~~\u5bb9\u6613~~\u60f3\u5230\u628a $256$ \u4f4d\u7684 $01$ \u4e32\u548c\u6536\u5230\u7684 $16$ \u8fdb\u5236\u4e32\u5206\u6210 $16$ \u7ec4\uff0c\u6bcf\u7ec4\u53ef\u4ee5\u7528\u4e00\u4e2a $x$ \u8868\u793a\uff08 $0\\le x\\le65535$ \uff09\n\n\u63a5\u4e0b\u6765\u6839\u636e~~\u5c0f\u5b66\u5b66\u7684~~\u62bd\u5c49\uff08\u9e3d\u5de2\uff09\u539f\u7406\u5f97\u5230\u5176\u4e2d\u5fc5\u6709\u81f3\u5c11\u4e00\u4f4d\u76f8\u540c\uff0c\u6240\u4ee5\u679a\u4e3e\u6bcf\u4e00\u4f4d\uff0c\u5982\u679c\u6709 $a_i$ \u4e0e\u6536\u5230\u7684\u4e32\u8fd9\u4e00\u4f4d\u76f8\u540c\uff0c\u90a3\u4e48\u66b4\u529b\u5224\u65ad\u662f\u5426\u4e0d\u53d7\u5e72\u6270\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5f97\u5230\u7b54\u6848\u3002\u7b2c $i$ \u4f4d\u4e3a $x$ \u7684\u6240\u6709 $a_k$ \u7684\u7f16\u53f7\u53ef\u4ee5\u7528 vector \u6216\u8005\u94fe\u5f0f\u524d\u5411\u661f\u4fdd\u5b58\u3002\n\n~~\uff08\u6211\u8d5b\u540e\u5199\u94fe\u5f0f\u524d\u5411\u661f\u7684\u539f\u56e0\u4e0d\u662f\u4e3a\u4e86\u5361\u5e38\uff0c\u53ea\u662f\u4e3a\u4e86\u7ec3\u4e60\u7f62\u4e86\uff09~~\n\n\u6ce8\u610f\u5230\u6570\u636e\u662f\u968f\u673a\u751f\u6210\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u77e5\u671f\u671b\u590d\u6742\u5ea6\u4e3a $ O(\\frac{n}{65536}\\times 16\\times m) $ \u53ef\u80fd\u4f1a\u4e0e\u8fd9\u4e2a\u590d\u6742\u5ea6\u6709\u4e9b\u5dee\u522b ~~\uff08\u53cd\u6b63\u5c31\u662fO(\u80fd\u8fc7)\u5c31\u884c\u4e86\uff09~~ \n\n~~\u7efc\u4e0a\u6240\u8ff0\uff0c\u672c\u9898\u4e3a\u5c0f\u5b66\u751f\u90fd\u4f1a\u7684\u9898~~\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef unsigned long long ull;\nint ask[256],n,m,ki,temp[400010][20],head[20][70000],cnt,ycl[70000];\nstruct edge{\n\tint to,nxt;\n}eg[8000000];\null a1,a2;\nbool lastans;\ninline int read(){\n\tint x=0;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9') ch=getchar();\n\twhile(ch>='0'&&ch<='9'){\n\t\tx=(x<<3)+(x<<1)+ch-'0';\n\t\tch=getchar();\n\t}\n\treturn x;\n}\null asdf(ull &k1,ull &k2){\n\tull k3=k1,k4=k2;\n\tk1=k4;\n\tk3^=(k3<<23);\n\tk2=k3^k4^(k3>>17)^(k4>>26);\n\treturn k2+k4;\n}\nvoid add(int x,int y,int idx){\n\teg[++cnt]=(edge){idx,head[x][y]};\n\thead[x][y]=cnt;\n}\nvoid gun(int n,ull a1,ull a2){\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=0;j<16;j++){\n\t\t\tfor(int k=0;k<16;k++){\n\t\t\t\ttemp[i][j]=(temp[i][j]<<1)|((asdf(a1,a2)&(1ull<<32))?1:0);\n\t\t\t}\n\t\t\tadd(j,temp[i][j],i);\n\t\t}\n\t}\n}\ninline int hhh(char ch){\n\tif(ch<='9') return ch-'0';\n\treturn ch-'A'+10;\n}\ninline void gt(){\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9'&&ch<'A'||ch>'F') ch=getchar();\n\tfor(int i=0;i<16;i++){\n\t\task[i]=0;\n\t\tfor(int j=0;j<4;j++){\n\t\t\task[i]=(ask[i]<<4)|hhh(ch);\n\t\t\tch=getchar();\n\t\t}\n\t\task[i]^=((lastans<<16)-lastans);\n\t}\n}\nint ws(int x){\n\tint ret=0;\n\twhile(x) ++ret,x-=x&(-x);\n\treturn ret;\n}\nint main(){\n//\tfreopen(\"qi.in\",\"r\",stdin);\n//\tfreopen(\"qi.out\",\"w\",stdout);\n\tn=read();\n\tm=read();\n\tscanf(\"%llu%llu\",&a1,&a2);\n\tgun(n,a1,a2);\n\tfor(int i=0;i<65536;i++) ycl[i]=ws(i);\n\twhile(m--){\n\t\tgt();\n\t\tki=read();\n\t\tlastans=0;\n\t\tfor(int i=0;i<16;i++){\n\t\t\tfor(int j=head[i][ask[i]];j;j=eg[j].nxt){\n\t\t\t\tint tmp=0;\n\t\t\t\tfor(int k=0;k<16;k++){\n\t\t\t\t\ttmp+=ycl[ask[k]^temp[eg[j].to][k]];\n\t\t\t\t}\n\t\t\t\tif(tmp<=ki){\n\t\t\t\t\tlastans=1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\t\n\t\t\t}\n\t\t\tif(lastans) break;\n\t\t}\n\t\tputchar(lastans+'0');\n\t\tputchar('\\n');\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1627790075,
        "uid": 289230,
        "name": "ricky0916",
        "ccfLevel": 7,
        "title": "P7738 \u9898\u89e3"
    },
    {
        "content": "### Description\n\n\uff08\u82e5\u60f3\u77e5\u9053\u6e05\u695a\u7ec6\u8282\u8bf7\u79fb\u6b65\u539f\u9898\u8f93\u5165\u683c\u5f0f\uff09\n\n\u7ed9\u5b9a\u4e8c\u8fdb\u5236\u5b57\u5178 $S_n$ \u548c $m$ \u4e2a\u4e8c\u8fdb\u5236\u8be2\u95ee\u4e32\uff08\u957f\u5ea6\u5747\u4e3a $256$\uff09\uff0c\u8be2\u95ee\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\u4e32\uff0c $S$ \u4e2d\u662f\u5426\u5b58\u5728 $S_i$\uff0c\u4f7f\u5f97 $S_i$ \u4e0e\u8be2\u95ee\u4e32\u4e0d\u540c\u7684\u5b57\u7b26\u4e0d\u8d85\u8fc7 $k$\u3002\n\n### Solution\n\n\u9996\u5148\u6ce8\u610f\u5230\u6570\u636e\u8303\u56f4\u91cc\uff0c$k\\le 15$\u3002\u8fd9\u542f\u793a\u6211\u4eec\u5f80\u5947\u602a\u7684\u5730\u65b9\u60f3\u3002\n\n\u8003\u8651\u628a $S$ \u548c\u8be2\u95ee\u4e32\u90fd\u5206\u4e3a $16$ \u6bb5\u3002\n\n\u5148\u9884\u5904\u7406\u4e00\u904d $S$\uff0c\u5c06 $16n$ \u6bb5\u8f6c\u6362\u6210\u5341\u8fdb\u5236\u6254\u8fdb hash \u8868\u91cc\uff0c\u540c\u65f6\u8bb0\u5f55\u6bcf\u4e00\u6bb5\u6240\u5728\u7684\u5b57\u7b26\u4e32\u7f16\u53f7\u3002\n\n\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\u4e32\uff0c\u5206\u6210 $16$ \u4e2a\u6570\u5206\u522b\u5728\u5bf9\u5e94\u7684 hash \u8868\u91cc\u627e\u76f8\u540c\u7684\u6570\u3002\u627e\u5230\u4e86\u5c31\u7528 $in$ \u5b58\u50a8\u8be5\u6570\u6240\u5728\u5b57\u7b26\u4e32\u7684\u4e0b\u6807\u3002\u63a5\u4e0b\u6765\u904d\u5386 $s_{in}$\uff0c\u627e\u4e0d\u540c\u7684\u5b57\u7b26\u6570\u5e76\u7edf\u8ba1\uff0c\u5224\u65ad $cnt$ \u6709\u6ca1\u6709\u8d85\u8fc7 $k$\u3002\n\n### Optimization\uff08\u4f18\u5316\uff09\n\n\u7531\u4e8e\u524d\u9762\u7684\u51e0\u4f4d\u5de8\u4f6c\u8bb2 Solution \u5df2\u7ecf\u5f88\u597d\u4e86\uff0c\u6240\u4ee5\u4e3b\u8981\u6765\u8c08\u8c08\u4f18\u5316\uff0c\u5373\u5361\u5e38\u3002\n\n\uff08\u4ee5\u4e0b\u8bc4\u6d4b\u6570\u636e\u5747\u6765\u81ea LOJ\uff09\n\n\u672c\u4eba\u6700\u5f00\u59cb\u5199\u7684\u4ee3\u7801 80pts\uff0c\u7ecf\u8fc7\u6c42\u52a9\u5f97\u77e5\uff0c\u601d\u8def\u6b63\u786e\uff0c\u8981\u5f00\u59cb\u5361\u5e38\u4e86\u3002\n\n\u6211\u5148\u540e\u91c7\u7528\u4e86\u4ee5\u4e0b\u65b9\u6cd5\uff1a\n\n- \u628a lowbit \u6c42 `1` \u7684\u4e2a\u6570\u6539\u6210\u7528 popcnt\u3002\uff08$80\\to80$\uff09\n- \u628a hash \u8868\u539f\u672c\u5b9e\u73b0\u4f9d\u6258\u7684 vector \u6539\u6210\u6570\u7ec4\u3002\uff08$80\\to80$\uff09\n- \u628a `while(m--)` \u5faa\u73af\u91cc\u7684\u64cd\u4f5c\u5206\u79bb\u6210\u51fd\u6570 `Sol()`\u3002\uff08$80\\to80$\uff09\n- \u52a0\u4e0a\u5feb\u8bfb\u3002\uff08$80\\to80$\uff09\n- \u628a popcnt \u6539\u6210 `__builtin_popcount()` \u51fd\u6570\u3002\uff08$80\\to84$\uff09\n- \u52a0\u5165\u7279\u5224 `if(cnt > k) break`\u3002\uff08$84\\to100$\uff09\n\n\u4e0d\u8fc7\u73b0\u5728\u5728\u6d1b\u8c37\u4e0a\u8fd8\u662f 96 \u5206\uff0c\u6253\u7b97\u6708\u9ed1\u98ce\u9ad8\u7684\u65f6\u5019\u518d\u4ea4\u4e00\u904d\u8bd5\u8bd5\uff08\n\n### Code\n\n**\u51fd\u6570\u7528\u9014**\n\n- `Tr_rea` \u628a 16 \u8fdb\u5236\u4e32\u53d8\u6210 2 \u8fdb\u5236\n- `Tr_sol` \u5904\u7406\u5f3a\u5236\u5728\u7ebf\n- `Tr_num` \u628a\u4e8c\u8fdb\u5236\u5206\u6210 $16$ \u6bb5\u8f6c\u6362\u6210 int\n- `Dif_bet` \u5224\u65ad $a,b$ \u4e4b\u95f4\u4e0d\u540c\u7684\u4f4d\u6570\n\n**\u4ee3\u7801**\n\n```cpp\n#include <cstdio>\n#include <cstring>\n\n#define ull unsigned long long\n#define N 400000\n#define mod 23333\n#define T 65536\nusing namespace std;\ninline int rd(){\n\tchar c;\n\tbool flag = 0;\n\twhile((c = getchar()) < '0' || c > '9')\n\t    if(c == '-') flag = 1;\n\tint res = c - '0';\n\twhile((c = getchar()) >= '0' && c <= '9')\n\t    res = (res << 3) + (res << 1) + c - '0';\n\treturn flag ? -res : res;\n}\nstruct node{\n\tint val, ind;\n};\nbool r[300], s[N + 1][300];\nint Pre_work(char c){\n\tif(c >= '0' && c <= '9') return c - '0';\n\telse return 10 + c - 'A';\n}\nvoid Tr_rea(char p[]){\n\tfor(int i = 0 ; i < 64 ; i++){\n\t\tint x = Pre_work(p[i]);\n\t\tfor(int j = 0 ; j < 4 ; j++)\n\t\t    r[i * 4 + 4 - j - 1] = x % 2, x /= 2;\n\t}\n}\nvoid Tr_sol(){\n\tfor(int i = 0 ; i < 256 ; i++)\n\t\tr[i] ^= 1;\n}\nint Tr_num(bool r[], int l){\n\tint ans = 0;\n\tint base = 1;\n\tfor(int i = l + 15 ; i >= l ; i--){\n\t\tans += base * r[i];\n\t\tbase *= 2;\n\t}\n\treturn ans;\n}\nint Dif_bet(int a, int b){\n\tint c = a ^ b;\n\treturn __builtin_popcount(c);\n}\null myRand(ull &k1, ull &k2){\n    ull k3 = k1, k4 = k2;\n    k1 = k4;\n    k3 ^= (k3 << 23);\n    k2 = k3 ^ k4 ^ (k3 >> 17) ^ (k4 >> 26);\n    return k2 + k4;\n}\nvoid gen(int n, ull a1, ull a2){\n    for (int i = 1 ; i <= n ; i++)\n        for (int j = 0 ; j < 256 ; j++)\n            s[i][j] = (myRand(a1, a2) & (1ull << 32)) ? 1 : 0;\n}\nchar c[300];\null a1, a2;\nint n, m, k, ans = 0, in;\nint len[20][mod];\nnode h[20][mod][20];\nvoid Sol(){\n\tscanf(\"%s\", c);\n\tk = rd();\n\tTr_rea(c);\n\tif(ans) Tr_sol();\n\tfor(int i = 0 ; i < 256 ; i += 16){\n\t\tint x = Tr_num(r, i), nu = i / 16;\n\t\tint siz = len[nu][x % mod];\n\t\tfor(int j = 0 ; j < siz ; j++){\n\t\t\tif(h[nu][x % mod][j].val == x){\n\t\t\t\tin = h[nu][x % mod][j].ind;\n\t\t\t\tint cnt = 0;\n\t\t\t\tfor(int o = 0 ; o < 256 ; o += 16){\n\t\t\t\t    int y = Tr_num(s[in], o);\n\t\t\t\t    int z = Tr_num(r, o);\n\t\t\t\t\tcnt += Dif_bet(z, y);\n\t\t\t\t\tif(cnt > k) break;\n\t\t\t\t}\n\t\t\t\tif(cnt <= k){\n\t\t\t\t    ans = 1;\n\t\t\t\t\tputs(\"1\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tans = 0;\n\tputs(\"0\");\n}\nint main(){\n\tfreopen(\"qi.in\", \"r\", stdin);\n\tfreopen(\"qi.out\", \"w\", stdout);\n\tn = rd(), m = rd();\n\tscanf(\"%llu%llu\", &a1, &a2);\n\tgen(n, a1, a2);\n\tfor(int i = 1 ; i <= n ; i++){\n\t\tfor(int j = 0 ; j < 256 ; j += 16){\n\t\t\tint x = Tr_num(s[i], j);\n\t\t\tnode tmp;\n\t\t\ttmp.val = x, tmp.ind = i;\n\t\t\th[j / 16][x % mod][len[j / 16][x % mod]++] = tmp;\n\t\t}\n\t}\n\twhile(m--)\n\t\tSol();\n\treturn 0;\n}\n```\n\n\u5171\u8ba1 114 \u884c\uff0c\u7801\u91cf 2.8 KB\uff0c\u5360\u7528\u5185\u5b58 173.7 MB\uff0c\u603b\u7528\u65f6 15476 ms\u3002\n\n[AC \u8bb0\u5f55 & \u66f4\u597d\u7684\u4ee3\u7801\u9605\u8bfb\u4f53\u9a8c](https://loj.ac/s/1203256)",
        "postTime": 1627531968,
        "uid": 224931,
        "name": "CSP_Sept",
        "ccfLevel": 6,
        "title": "P7738 [NOI2021] \u91cf\u5b50\u901a\u4fe1 - \u9898\u89e3"
    },
    {
        "content": "\u6570\u636e\u968f\u673a\u662f\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u4e1c\u897f\u3002\n\n\u6ce8\u610f\u5230 $15<16$\uff0c\u8003\u8651\u628a\u4e32\u62c6\u6210 $16$ \u4e2a `unsigned short`\u3002\n\n\u90a3\u4e48\uff0c\u56e0\u4e3a\u6570\u636e\u968f\u673a\uff0c\u6240\u4ee5\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u6bb5\u4e2d\u7684\u6bcf\u4e00\u4e2a\u6570\uff0c\u53ea\u6709\u5927\u6982 $\\dfrac{4\\times 10^5}{2^{16}}$ \u4e2a\u5927\u4e32\u5728\u8fd9\u6bb5\u7ec4\u6210\u7684\u6570\u662f\u8fd9\u4e2a\u6570\uff0c\u7528 `vector` \u6216\u524d\u5411\u661f\u6765\u5b58\u50a8\u3002\n\n\u8003\u8651\u5bf9\u4e8e\u6bcf\u6b21\u8be2\u95ee\uff0c\u53ef\u4ee5\u679a\u4e3e\u6240\u6709\u53ef\u80fd\u7684\u6570\u3002\u90a3\u4e48\u5982\u4f55\u5224\u65ad\u4e00\u4e2a\u6570\u662f\u5426\u53ef\u80fd\uff1f\u9e3d\u5de2\u539f\u7406\uff0c\u80af\u5b9a\u8fd9 $16$ \u4e2a\u6bb5\u6709\u4e00\u4e2a\u6bb5\u548c\u67e5\u8be2\u7684\u4e32\u5728\u8fd9\u6bb5\u7ec4\u6210\u7684\u6570\u5b8c\u5168\u76f8\u7b49\uff0c\u6240\u4ee5\u5728\u8fd9\u4e2a `vector` \u91cc\u8dd1\u4e00\u7f16\u6240\u6709\u7684\u5c31\u884c\u4e86\u3002\n\n\u590d\u6742\u5ea6 $O(\\dfrac{n\\times m\\times 16^2}{2^{16}})$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ull unsigned long long\nusing namespace std;\nchar cc[1005];\nint dy[1005],pc[1<<16];\nstruct div_16\n{\n\tunsigned short a[16];\n\tvoid init(){for(int i=0;i<16;i++)a[i]=0;}\n}s[400005];\nint TOT=0,ind[16][1<<16],mw[16][1<<16],nxt[10000005],zhi[10000005];\nvoid addedge(int u1,int u2,int v)\n{\n\tif(!ind[u1][u2])ind[u1][u2]=++TOT;\n\telse nxt[mw[u1][u2]]=++TOT;\n\tmw[u1][u2]=TOT,zhi[TOT]=v;\n}\null myRand(ull &k1,ull &k2)\n{\n\tull k3=k1,k4=k2;\n\tk1=k4,k3^=(k3<<23);\n\tk2=k3^k4^(k3>>17)^(k4>>26);\n\treturn k2+k4;\n}\nvoid gen(int n,ull a1,ull a2)\n{\n\tfor(int i=1;i<=n;i++)for(int j=0;j<16;j++)for(int k=0;k<16;k++)\n\t\ts[i].a[j]|=(1<<15-k)*((myRand(a1,a2)&(1ull<<32))?1:0);\n\tfor(int i=1;i<=n;i++)for(int j=0;j<16;j++)addedge(j,s[i].a[j],i);\n}\nint main()\n{\n\tfreopen(\"qi.in\",\"r\",stdin);\n\tfreopen(\"qi.out\",\"w\",stdout);\n\tfor(int i=1;i<(1<<16);i++)pc[i]=pc[i^(i&-i)]+1;\n\tfor(int i=0;i<10;i++)dy['0'+i]=i;\n\tfor(int i='A';i<='F';i++)dy[i]=i-'A'+10;\n\tint n,m;\n\tunsigned short zz=0,lastans=0;\n\tull a1,a2;\n\tscanf(\"%d%d%llu%llu\",&n,&m,&a1,&a2);\n\tgen(n,a1,a2);\n\twhile(m--)\n\t{\n\t\tdiv_16 f;\n\t\tf.init();\n\t\tint kk,tt=0,flag=0;\n\t\tscanf(\"%s%d\",cc+1,&kk);\n\t\tfor(int i=0;i<16;i++)for(int j=0;j<4;j++)\n\t\t\tf.a[i]|=(1<<(3-j<<2))*dy[cc[++tt]];\n\t\tfor(int i=0;i<16;i++)f.a[i]^=zz-lastans;\n\t\tfor(int i=0;i<16;i++)\n\t\t{\n\t\t\tunsigned short dd=f.a[i];\n\t\t\tfor(int j=ind[i][dd];j;j=nxt[j])\n\t\t\t{\n\t\t\t\tint cu=zhi[j],he=0,ff=1;\n\t\t\t\tfor(int k=0;k<16;k++)\n\t\t\t\t{\n\t\t\t\t\the+=pc[(s[cu].a[k])^(f.a[k])];\n\t\t\t\t\tif(he>kk)\n\t\t\t\t\t{\n\t\t\t\t\t\tff=0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(ff)\n\t\t\t\t{\n\t\t\t\t\tflag=1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(flag)break;\n\t\t}\n\t\tlastans=flag;\n\t\tputchar('0'+flag);\n\t\tputchar('\\n');\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1627460477,
        "uid": 107484,
        "name": "wmy_goes_to_thu",
        "ccfLevel": 8,
        "title": "P7738 \u9898\u89e3"
    }
]
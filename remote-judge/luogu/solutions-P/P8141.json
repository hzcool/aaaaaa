[
    {
        "content": "## \u9898\u76ee\u5927\u610f\n\n\u4f60\u5728\u4e00\u4e2a $d$ \u7ef4\u7a7a\u95f4\u4e2d\u3002\n\n\u7ed9\u51fa\u7a7a\u95f4\u4e2d $n$ \u4e2a\u70b9\u7684\u5750\u6807 $\\vec{y}_1,\\vec{y}_2,\\cdots,\\vec{y}_n$ \u53ca\u5b83\u4eec\u4e0e\u4f60\u7684\u8ddd\u79bb $r_1,r_2,\\cdots,r_n$\uff0c\n\n\u8bf7\u4f60\u6c42\u51fa\u4f60\u6240\u5728\u7684\u5750\u6807 $\\vec{x}$\u3002\n\n\u82e5\u6709\u591a\u4e2a\u89e3\uff0c\u8f93\u51fa\u4efb\u610f\u4e00\u4e2a\u3002\n\n$\\texttt{Data Range}:1\\le n,d\\le 500$\uff0c\u5750\u6807\u8303\u56f4 $[-100,100]$\uff0c\u4fdd\u8bc1\u6570\u636e\u968f\u673a\u4e14\u6709\u89e3\u3002\n\n## \u9898\u89e3\n\n\u7ed9\u51fa\u4e00\u4e2a naive \u7684\u6570\u5f62\u7ed3\u5408\u7684\u505a\u6cd5\u3002\n\n\u6839\u636e\u9898\u610f\uff0c\u4e0d\u96be\u5217\u51fa\u65b9\u7a0b\n\n$$\n\\begin{cases}\n\t(\\vec{x}-\\vec{y}_1)^2=r_1^2\\\\\n\t(\\vec{x}-\\vec{y}_2)^2=r_2^2\\\\\n\t\\cdots  \\\\\n\t(\\vec{x}-\\vec{y}_n)^2=r_n^2\n\\end{cases}\n$$\n\n\u8fd9\u4e2a\u65b9\u7a0b\u542b\u6709\u5e73\u65b9\uff0c\u6240\u4ee5\u6ca1\u6cd5\u76f4\u63a5\u9ad8\u65af\u6d88\u5143\u3002\n\n\u4f46\u6ce8\u610f\u5230\n\n$$(\\vec{x}-\\vec{y})^2=\\vec{x}^2-2\\vec{y}\\cdot\\vec{x}+\\vec{y}^2$$\n\n\u5176\u4e2d $\\vec{x}^2$ \u662f\u76f8\u540c\u7684\u3002\n\n\u8003\u8651\u5c06\u539f\u70b9\u5e73\u79fb\u5230 $\\vec{y}_1$\uff0c\u8bbe $\\vec{x}'=\\vec{x}-\\vec{y}_1,\\forall k,\\vec{y}_k'=\\vec{y}_k-\\vec{y}_1$\uff0c\u5219\n\n$$\n\\begin{cases}\n\t\\vec{x}'^2=r_1^2&(1)\\\\\n\t(\\vec{x}'-\\vec{y}_2')^2=r_2^2\\\\\n\t(\\vec{x}'-\\vec{y}_3')^2=r_3^2\\\\\n\t\\cdots\\\\\n\t(\\vec{x}'-\\vec{y}_n')^2=r_n^2\n\\end{cases}\n$$\n\n\u4e0b\u9762 $n-1$ \u4e2a\u5f0f\u5b50\u540c\u65f6\u51cf\u53bb $(1)$\uff0c\u5f97\u5230\n\n$$\n\\begin{cases}\n-2\\vec{y}'_2\\cdot\\vec{x}+\\vec{y}_2'^2=r_2^2-r_1^2\\\\\n-2\\vec{y}'_3\\cdot\\vec{x}+\\vec{y}_3'^2=r_3^2-r_1^2\\\\\n\\cdots\\\\\n-2\\vec{y}'_n\\cdot\\vec{x}+\\vec{y}_n^2=r_n^2-r_1^2\n\\end{cases}\n$$\n\n\u8fd9\u7b49\u4ef7\u4e8e\u7ebf\u6027\u65b9\u7a0b\u7ec4\n\n$$A\\vec{x}=\\vec{a}$$\n\n$$A=\\begin{bmatrix}\n\t(\\vec{y}_2')^T\\\\\n\t\\hline(\\vec{y}_3')^{T^{^{^{}}}}\\\\\n\t\\hline\\vdots \\\\\n\t\\hline(\\vec{y}_n')^{T^{^{^{}}}}\n\\end{bmatrix},\\vec{a}=-\\dfrac{1}{2}\\begin{bmatrix}\n\tr_2^2-r_1^2-\\vec{y}_2^2\\\\\n\tr_3^2-r_1^2-\\vec{y}_3^2\\\\\n\t\\vdots\\\\\n\tr_n^2-r_1^2-\\vec{y}_n^2\n\\end{bmatrix}$$\n\n\u9ad8\u65af\u6d88\u5143\u6c42\u89e3\u8be5\u7ebf\u6027\u65b9\u7a0b\u7ec4\uff0c\u82e5\u5176\u6709\u552f\u4e00\u89e3\uff0c\u5219\u89e3\u5c31\u662f\u7b54\u6848\u3002\n\n---------------------\n\n\u5982\u679c\u89e3\u4e0d\u662f\u552f\u4e00\u7684\u600e\u4e48\u529e\uff1f\u8fd9\u65f6\u201c\u5f62\u201d\u4fbf\u6d3e\u4e0a\u7528\u573a\u3002\n\n\u8ba9\u6211\u4eec\u8f6c\u6362\u4e00\u4e0b\u9898\u610f\uff1a\u7ed9\u5b9a $d$ \u7ef4\u7a7a\u95f4\u4e2d $n$ \u4e2a\u8d85\u7403\uff0c  \n\n\u7403\u5fc3\u4e3a $\\vec{y}_1,\\vec{y}_2,\\cdots,\\vec{y}_n$\uff0c\u534a\u5f84\u4e3a $r_1,r_2,\\cdots,r_n$\uff0c\u6c42\u5b83\u4eec\u7684\u4ea4\u70b9\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/p1s6vcb3.png)\n\n\u5148\u628a\u8fd9\u4e2a\u95ee\u9898\u6401\u7f6e\u4e00\u8fb9\uff0c\u6765\u770b\u770b\u8fd9\u4e2a\u9ad8\u4e2d\u6587\u5316\u8bfe\u5e38\u7528\u7684 trick\uff1a\n\n\u7ed9\u5b9a\u4e8c\u7ef4\u7a7a\u95f4\u4e24\u4e2a\u5706\u7684\u65b9\u7a0b\uff1a\n\n$$\n\\begin{cases}\n\t(x-a_1)^2+(y-b_1)^2=r_1^2&(1)'\\\\\n\t(x-a_2)^2+(y-b_2)^2=r_2^2&(2)'\n\\end{cases}\n$$\n\n\u5b83\u4eec\u7684\u4ea4\u7ebf\u5982\u56fe\u6240\u793a\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qyimro1a.png)\n\n\u73b0\u5728\u6211\u4eec\u8981\u6c42\u4ea4\u7ebf\u7684\u65b9\u7a0b\uff0c\u4e00\u822c\u4eba\u7684\u60f3\u6cd5\u662f\u5c06 $(1)',(2)'$ \u8054\u7acb\uff0c\u6c42\u5f97\u4ea4\u70b9\u540e\u518d\u6c42\u4ea4\u7ebf\u3002\n\n\u4f46\u6700\u5feb\u7684\u65b9\u6cd5\u662f\u5c06 $(1)',(2)'$ \u76f8\u51cf\uff0c\u76f4\u63a5\u6c42\u5f97\u4ea4\u7ebf\u7684\u65b9\u7a0b\n\n$$(x-a_1)^2-(x-a_2)^2+(y-b_1)^2-(y-b_2)^2=r_1^2-r_2^2$$\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u7b80\u77ed\u8bc1\u660e\u4e0b\u8fd9\u4e48\u505a\u7684\u6b63\u786e\u6027\uff1a\n\n> - $(1)',(2)'$ \u4e2d $x^2,y^2$ \u7cfb\u6570\u5747\u4e3a $1$\uff0c\u56e0\u6b64 $(1)'-(2)'$ \u4e00\u5b9a\u662f\u4e2a\u4e8c\u5143\u4e00\u6b21\u4e0d\u5b9a\u65b9\u7a0b\uff0c  \n  \u4e5f\u5c31\u4e00\u5b9a\u662f\u4e00\u6761\u76f4\u7ebf\u3002\n> - $(2)'+[(1)'-(2)']=(1)'$\uff0c\u56e0\u6b64\u5706 $2$ \u4e0e\u8be5\u76f4\u7ebf\u7684\u4ea4\u70b9\u4e00\u5b9a\u5728\u5706 $1$ \u4e0a\u3002  \n  \u540c\u7406\uff0c\u5706 $1$ \u4e0e\u8be5\u76f4\u7ebf\u7684\u4ea4\u70b9\u4e00\u5b9a\u5728\u5706 $2$ \u4e0a\u3002    \n  \u56e0\u6b64\u8be5\u76f4\u7ebf\u4e0e\u4e24\u4e2a\u5706\u4e2d\u4e00\u4e2a\u7684\u4ea4\u70b9\u7b49\u4ef7\u4e8e\u4e24\u4e2a\u5706\u7684\u4ea4\u70b9\u3002  \n> \u7efc\u4e0a\uff0c$(1)'-(2)'$ \u5c31\u662f\u4e24\u4e2a\u5706\u7684\u4ea4\u7ebf\u65b9\u7a0b\u3002\n\n\u663e\u7136\u8fd9\u4e2a\u7ed3\u8bba\u53ca\u5176\u8bc1\u660e\u53ef\u4ee5\u63a8\u5e7f\u5230\u9ad8\u7ef4\u7a7a\u95f4\uff0c\u82e5\u5df2\u77e5\u4e09\u7ef4\u7a7a\u95f4\u4e24\u4e2a\u7403\u7684\u65b9\u7a0b\uff1a\n\n$$\n\\begin{cases}\n\t(x-a_1)^2+(y-b_1)^2+(z-c_1)^2=r_1^2&(1)''\\\\\n\t(x-a_2)^2+(y-b_2)^2+(z-c_2)^2=r_2^2&(2)''\\\\\n\\end{cases}\n$$\n\n\u5b83\u4eec\u7684\u4ea4\u9762\u5982\u56fe\u6240\u793a\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/gw7w5m8i.png)\n\n\u628a $(1)''$ \u548c $(2)''$ \u76f8\u51cf\uff0c\u53ef\u76f4\u63a5\u5f97\u5230\u4ea4\u9762\u7684\u65b9\u7a0b\n\n$$(x-a_1)^2-(x-a_2)^2+(y-b_1)^2-(y-b_2)^2+(z-c_1)^2+(z-c_2)^2=r_1^2-r_2^2$$\n\n\u4e14\u4ea4\u9762\u4e0e\u5176\u4e2d\u4e00\u4e2a\u7403\u7684\u4ea4\u70b9\u7b49\u4ef7\u4e8e\u4e24\u7403\u7684\u4ea4\u70b9\u3002\n\n\u540c\u7406\uff0c\u82e5\u5df2\u77e5 $d$ \u7ef4\u7a7a\u95f4\u7684\u4e24\u4e2a\u8d85\u7403\uff1a\n\n$$\n\\begin{cases}\n\t(\\vec{x}-\\vec{y}_1)^2=r_1^2\\\\\n\t(\\vec{x}-\\vec{y}_2)^2=r_2^2\n\\end{cases}\n$$\n\n\u5c06\u4e24\u4e2a\u8d85\u7403\u7684\u65b9\u7a0b\u76f8\u51cf\uff0c\u53ef\u5f97\u5230 $d-1$ \u7ef4\u8d85\u4ea4\u9762\u7684\u65b9\u7a0b\n\n$$(\\vec{x}-\\vec{y}_1)^2-(\\vec{x}-\\vec{y}_2)^2=r_1^2-r_2^2$$\n\n\u4e14\u8d85\u4ea4\u9762\u4e0e\u5176\u4e2d\u4e00\u4e2a\u8d85\u7403\u7684\u4ea4\u70b9\u7b49\u4ef7\u4e8e\u4e24\u4e2a\u8d85\u7403\u7684\u4ea4\u70b9\u3002\n\n\u6b64\u65f6\u6211\u4eec\u5df2\u7ecf\u80fd\u89e3\u91ca\u4e4b\u524d\u7684\u9ad8\u65af\u6d88\u5143\u5728\u505a\u4ec0\u4e48\u4e86\uff1a\n\n- \u5c06\u6240\u6709\u65b9\u7a0b\u51cf\u53bb $(1)$ \u7b49\u4ef7\u4e8e\u6c42\u8d85\u7403 $1$ \u4e0e\u5176\u4ed6\u6240\u6709\u8d85\u7403\u7684\u8d85\u4ea4\u9762\u65b9\u7a0b\u3002\n- \u9ad8\u65af\u6d88\u5143\u7b49\u4ef7\u4e8e\u6c42\u8fd9\u4e9b\u8d85\u4ea4\u9762\u7684\u4ea4\u3002\n- \u8fd9\u4e9b\u8d85\u4ea4\u9762\u7684\u4ea4\u4e0e\u8d85\u7403 $1$ \u7684\u4ea4\u70b9\u90fd\u662f\u5408\u6cd5\u7684\u89e3\uff0c\u5373\u6240\u6709\u8d85\u7403\u7684\u4ea4\u70b9\u3002\n\n---------------------------------\n\n\u5206\u6790\u5b8c\u8fd9\u4e9b\u540e\uff0c\u89e3\u4e0d\u552f\u4e00\u7684\u60c5\u51b5\u53d8\u6210\u4e86\u4e00\u4e2a\u8fd9\u6837\u7684\u95ee\u9898\uff1a\n\n\u8bbe\u9ad8\u65af\u6d88\u5143\u540e\u81ea\u7531\u5143\u7684\u4e2a\u6570\u4e3a $k$\uff0c  \n\u5219\u6211\u4eec\u9700\u8981\u6c42\u89e3\u4e00\u4e2a $d$ \u7ef4\u8d85\u7403\u548c\u4e00\u4e2a $k$ \u7ef4 \u201c\u5e73\u9762\u201d \uff08\u51c6\u786e\u7684\u8bf4\u662f\u7ebf\u6027\u6d41\u5f62\uff09\u7684\u4ea4\u70b9\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jirajkqx.png)\n\n\u540c\u6837\u8003\u8651\u4e8c\u7ef4\u7a7a\u95f4\u7684\u60c5\u51b5\uff1a\u6c42\u89e3\u4e00\u4e2a\u5706\u548c\u4e00\u6761\u76f4\u7ebf\u7684\u4ea4\u70b9\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3ptqq5vf.png)\n\n\u4e00\u4e2a\u663e\u7136\u7684\u505a\u6cd5\u662f\u8fc7\u5706\u5fc3\u5411\u76f4\u7ebf\u4f5c\u5782\u7ebf\uff0c\u7136\u540e\u52fe\u80a1\u5b9a\u7406\u7b97\u51fa\u5782\u8db3\u5230\u4ea4\u70b9\u7684\u8ddd\u79bb\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jv8u8fz5.png)\n\n\u62d3\u5c55\u5230\u4e09\u7ef4\u7a7a\u95f4\u65f6\uff0c\u60c5\u51b5\u662f\u7c7b\u4f3c\u7684\uff1a\n\n- \u5bf9\u4e8e\u4e09\u7ef4\u7a7a\u95f4\u4e00\u6761\u76f4\u7ebf\u548c\u7403\u76f8\u4ea4\uff0c\u8ddf\u521a\u624d\u7684\u60c5\u51b5\u662f\u4e00\u6837\u7684\u3002\n  ![](https://cdn.luogu.com.cn/upload/image_hosting/hesarb5n.png)\n- \u5bf9\u4e8e\u4e09\u7ef4\u7a7a\u95f4\u4e00\u4e2a\u5e73\u9762\u548c\u7403\u76f8\u4ea4\uff0c\u53ef\u4ee5\u786e\u5b9a\u622a\u9762\u4e00\u5b9a\u662f\u4e2a\u5706\u3002\n  \u540c\u6837\u4f5c\u5782\u7ebf\u5f97\u5230\u5706\u5fc3\u540e\u52fe\u80a1\u5b9a\u7406\u6c42\u89e3\u3002\n  ![](https://cdn.luogu.com.cn/upload/image_hosting/31yw1dkl.png)\n\n\u60f3\u4e00\u60f3\u600e\u4e48\u5f52\u7eb3\u5230\u9ad8\u7ef4\u7a7a\u95f4\uff0c\u63d0\u793a\u4e00\u4e0b\uff1a\u4e00\u7ef4\u7a7a\u95f4\u7684\u8d85\u7403\u662f\u4e24\u4e2a\u70b9\u3002\n\n$\\qquad$\n\n------------------------------------------\n\n$\\qquad$\n\n\u7b54\u6848\u63ed\u6653\uff1a$d$ \u7ef4\u7a7a\u95f4\u4e00\u4e2a\u8d85\u7403\u4e0e\u4e00\u4e2a $k(k\\le d)$ \u7ef4\u7ebf\u6027\u6d41\u5f62\u76f8\u4ea4\uff0c\u622a\u9762\u4e00\u5b9a\u662f\u4e2a $k$ \u7ef4\u8d85\u7403\u3002  \n\u8fc7\u539f\u8d85\u7403\u7403\u5fc3\u5411\u7ebf\u6027\u6d41\u5f62\u4f5c\u5782\u7ebf\u5373\u53ef\u5f97\u5230\u622a\u9762\u7684\u7403\u5fc3\uff0c\u518d\u52fe\u80a1\u5b9a\u7406\u5373\u53ef\u5f97\u5230\u7403\u5fc3\u7684\u534a\u5f84\u3002\n\n\u6211\u4eec\u7531\u6b64\u5f97\u5230\u6c42\u89e3\u539f\u95ee\u9898\u7684\u4e00\u4e2a\u5927\u81f4\u7684\u601d\u8def\uff1a\n\n- \u8fc7\u8d85\u7403\u5fc3\u5411\u7ebf\u6027\u6d41\u5f62\u4f5c\u5782\u7ebf\uff0c\u6c42\u51fa\u5782\u8db3\u7684\u5750\u6807 $\\vec{p}$\u3002\n- \u52fe\u80a1\u5b9a\u7406\u7b97\u51fa\u622a\u9762\u7684\u534a\u5f84 $r'$\u3002\n- \u5728\u7ebf\u6027\u6d41\u5f62\u4e0a\u968f\u4fbf\u627e\u4e00\u4e2a\u957f\u5ea6\u4e3a $r'$ \u7684\u5411\u91cf $\\vec{q}$\uff0c$\\vec{p}+\\vec{q}$ \u5c31\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u89e3\u3002\n\n------------------------------\n\n\u56de\u5230\u4e4b\u524d\u7684\u7ebf\u6027\u65b9\u7a0b\u7ec4\u3002\u9ad8\u65af\u6d88\u5143\u540e\uff0c\u5176\u4e00\u5b9a\u4f1a\u53d8\u4e3a\u5982\u4e0b\u5f62\u5f0f\uff1a\n\n$$\n\\left[\n\\begin{array}{ccccc|}\n\t1&&&&&v_{1,1}&v_{2,1}&\\cdots&v_{k,1}\\\\\n\t&1&&&&v_{1,2}&v_{2,2}&\\cdots&v_{k,2}\\\\\n\t&&\\ddots&&&\\vdots&\\vdots&\\vdots&\\vdots\\\\\n\t&&&1&&v_{1,d-k-1}&v_{2,d-k-1}&\\cdots&v_{k,d-k-1}\\\\\n\t&&&&1&v_{1,d-k}&v_{2,d-k}&\\cdots&v_{k,d-k}\\\\\n\t\\hline 0&0&0&0&0&0&0&0&0\\\\\n\t\\vdots&\\vdots&\\vdots&\\vdots&\\vdots&\\vdots&\\vdots&\\vdots&\\vdots\n\\end{array}\\right]\n\\begin{bmatrix}\n\tx_1\\\\x_2\\\\\\vdots\\\\x_{d-k}\\\\\\hline x_{d-k+1}\\\\ x_{d-k+2}\\\\ \\vdots \\\\x_d\n\\end{bmatrix}=\\begin{bmatrix}\n\ta_1'\\\\ a_2'\\\\ \\vdots\\\\ a_{d-k}'\\\\\\hline 0\\\\0\\\\ \\vdots \\\\0\n\\end{bmatrix}\n$$\n\n\u7b80\u8bb0\u4e3a\u5982\u4e0b\u5f62\u5f0f\uff1a\n\n$$\n\\left[\\begin{array}{c|c|c|c|c}\n\tI&\\vec{v}_1&\\vec{v}_2&\\cdots&\\vec{v}_k\\\\\n\t\\hline O&\\vec{0}&\\vec{0}&\\vec{0}&\\vec{0}\n\\end{array}\\right]\n\\begin{bmatrix}\\vec{x}_0\\\\ \\hline\\vec{x}_1\\end{bmatrix}\n=\\begin{bmatrix}\\vec{a}'\\\\ \\hline\\vec{0}\\end{bmatrix}\n$$\n\n\u6211\u4eec\u9700\u8981\u786e\u5b9a\u7ebf\u6027\u65b9\u7a0b\u7ec4\u7684\u89e3\u96c6\uff0c\u4ece\u800c\u786e\u5b9a\u6574\u4e2a\u7ebf\u6027\u6d41\u5f62\u3002\n\n- \u82e5 $\\vec{x}_1=\\vec{0}$\uff0c\u663e\u7136 $\\vec{x}_0=\\vec{a}'$\u3002  \n  \u56e0\u6b64 $\\begin{bmatrix}\\vec{a}'\\\\ \\hline\\vec{0}\\end{bmatrix}$ \u662f\u8be5\u7ebf\u6027\u65b9\u7a0b\u7ec4\u7684\u4e00\u7ec4\u7279\u89e3\u3002\n- \u82e5 $x_{d-k+1}=\\lambda,x_{d-k+2}=x_{d-k+3}=\\cdots=x_d=0$\uff0c  \n  \u5219 $\\vec{x}_0+\\lambda\\vec{v}_1=\\vec{a}',\\vec{x}_0=\\vec{a}-\\lambda\\vec{v}_1$\u3002   \n  \u56e0\u6b64 $x_{d-k+1}$ \u6bcf\u589e\u52a0 $\\lambda$\uff0c$\\vec{x}_0$ \u5c31\u8981\u51cf\u53bb $\\lambda\\vec{v}_1$\u3002\n\n\u7efc\u4e0a\uff0c\u8bbe\n\n$$\n\\vec{u}_1=\\begin{bmatrix}-\\vec{v}_1\\\\\\hline 1\\\\0\\\\0\\\\0\\\\ \\vdots\\end{bmatrix}\n,\\vec{u}_2=\\begin{bmatrix}-\\vec{v}_2\\\\\\hline 0\\\\1\\\\0\\\\0\\\\ \\vdots\\end{bmatrix},\n\\vec{u}_3=\\begin{bmatrix}-\\vec{v}_3\\\\\\hline 0\\\\0\\\\1\\\\0\\\\ \\vdots\\end{bmatrix},\\cdots\n$$\n\n$$\n\\vec{b}=\\begin{bmatrix}\n\t\\vec{a}'\\\\ \\hline \\vec{0}\n\\end{bmatrix},V=\\{[\\vec{u}_1|\\vec{u}_2|\\cdots|\\vec{u}_k]\\vec{x}_1|\\vec{x}_1\\in\\mathbb{R}_k\\}\n$$\n\n\u5219\u7ebf\u6027\u65b9\u7a0b\u7ec4\u7684\u89e3\u96c6\u4e3a \n\n$$X=\\{\\vec{b}+\\vec{\\Delta}|\\vec{\\Delta}\\in V\\}$$\n\n\u5373\u7ebf\u6027\u7a7a\u95f4 $V$ \u5185\u7684\u6240\u6709\u5411\u91cf\u52a0\u4e0a\u7279\u89e3 $\\vec{b}$\uff0c\u4e0e\u7ebf\u6027\u6d41\u5f62\u7684\u5b9a\u4e49\u4e00\u81f4\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u4f5c\u5782\u7ebf\uff0c\u7531\u4e8e\u7403\u5fc3\u4e3a $\\vec{0}$\uff0c$V$ \u7684\u57fa\u5e95\u4e3a $\\vec{u}_1,\\vec{u}_2,\\cdots,\\vec{u}_k$\uff0c  \n\u6211\u4eec\u7684\u76ee\u6807\u662f\u627e\u51fa $\\vec{p}\\in X$\uff0c\u4f7f\u5f97 $\\vec{p}$ \u4e0e $V$ \u4e2d\u6240\u6709\u7684\u57fa\u5411\u91cf\u5782\u76f4\uff0c\u5373\n\n$$\n\\vec{u}_1\\cdot \\vec{p}=\\vec{u}_2\\cdot\\vec{p}=\\cdots=\\vec{u}_k\\cdot \\vec{p}=0\n\\qquad{(2)}$$\n\n\u628a $\\vec{p}$ \u62c6\u5f00\uff1a\n\n$$\\vec{p}=\\vec{b}+[\\vec{u}_1|\\vec{u}_2|\\cdots|\\vec{u}_k]\\vec{x}_1\\qquad{(3)}$$\n\n\u7136\u540e\u5c06 $(2)$ \u8868\u793a\u6210\u77e9\u9635\u5f62\u5f0f\uff1a\n\n$$\n\\begin{bmatrix}\n\t\\vec{u}_1^T\\\\\n\t\\hline\\vec{u}_2^{T^{^{^{}}}}\\\\\n\t\\hline\\cdots\\\\\n\t\\hline\\vec{u}_k^{T^{^{^{}}}}\n\\end{bmatrix}(\\vec{b}+[\\vec{u}_1|\\vec{u}_2|\\cdots|\\vec{u}_k]\\vec{x}_1)=\\vec{0}\n$$\n\n\u6ce8\u610f\u5230 $\\begin{bmatrix}\\vec{u}_1^T\\\\\\hline\\vec{u}_2^{T^{^{^{}}}}\\\\\\hline\\cdots\\\\\\hline\\vec{u}_k^{T^{^{^{}}}}\n\\end{bmatrix}[\\vec{u}_1|\\vec{u}_2|\\cdots|\\vec{u}_k]$ \u4e3a $k$ \u9636\u65b9\u9635 \uff0c\u56e0\u6b64\u9ad8\u65af\u6d88\u5143\u89e3\u7ebf\u6027\u65b9\u7a0b\u7ec4\n\n$$\n\\begin{bmatrix}\\vec{u}_1^T\\\\\\hline\\vec{u}_2^{T^{^{^{}}}}\\\\\\hline\\cdots\\\\\\hline\\vec{u}_k^{T^{^{^{}}}}\n\\end{bmatrix}[\\vec{u}_1|\\vec{u}_2|\\cdots|\\vec{u}_k]\\vec{x}_1=-\\begin{bmatrix}\\vec{u}_1^T\\\\\\hline\\vec{u}_2^{T^{^{^{}}}}\\\\\\hline\\cdots\\\\\\hline\\vec{u}_k^{T^{^{^{}}}}\n\\end{bmatrix}\\vec{b}\n$$\n\n\u5373\u53ef\u5f97\u5230 $\\vec{x}_1$\uff0c\u4ee3\u5165 $(3)$ \u5373\u53ef\u6c42\u51fa $\\vec{p}$\u3002\n\n\u56e0\u4e3a\u8fc7\u7ebf\u6027\u6d41\u5f62\uff08\u76f4\u7ebf/\u5e73\u9762\uff09\u4e0a\u4e00\u70b9\u6709\u4e14\u53ea\u6709\u4e00\u6761\u76f4\u7ebf\u4e0e\u8be5\u6d41\u5f62\uff08\u76f4\u7ebf/\u5e73\u9762\uff09\u5782\u76f4\uff0c\n\n\u8fd9\u4e2a\u7ebf\u6027\u65b9\u7a0b\u7ec4\u4e00\u5b9a\u6709\u552f\u4e00\u89e3\uff0c\u4e5f\u5c31\u4e00\u5b9a\u80fd\u89e3\u51fa $\\vec{p}$\u3002\n\n\u89e3\u51fa $\\vec{p}$ \u540e\uff0c\u52fe\u80a1\u5b9a\u7406\u5f97\u5230\n\n$$r'=\\sqrt{r^2-\\vec{p}^2}$$\n\n\u7136\u540e $\\vec{p}+\\dfrac{r'}{\\sqrt{\\vec{u}_1^2}}\\vec{u}_1$ \u5c31\u662f\u4e00\u7ec4\u5408\u6cd5\u7684\u89e3\u4e86\u3002\n\n\n------------------------\n\n\u6700\u540e\u4e0d\u8981\u5fd8\u8bb0\uff0c\u6211\u4eec\u4e00\u5f00\u59cb\u5c06\u539f\u70b9\u5e73\u79fb\u5230\u4e86 $\\vec{y}_1$\uff0c\u8981\u5e73\u79fb\u56de\u53bb\u624d\u884c\u54e6\uff01\n\n## Code\n```cpp\n/*\nthis code is made by wangrx\n2022.3.11 15:30\n*/\n#include<stdio.h>\n#include<string.h>\n#include<math.h>\n#include<algorithm>\ntypedef double db;\nstruct READ{//\u5feb\u8bfb\n\tchar c,w;\n\tinline READ(){c=getchar();}\n\ttemplate<typename type>\n\tinline READ& operator >>(type& num){\n\t\tfor(w=1;'0'>c||c>'9';c=getchar())\n\t\t\tw=c=='-'? -1:1;\n\t\tfor(num=0;'0'<=c&&c<='9';c=getchar())\n\t\t\tnum=num*10+(c-'0');\n\t\tif(c=='.') for(db i=1;c=getchar(),'0'<=c&&c<='9';)\n\t\t\ti*=0.1L,num+=i*(c-'0');\n\t\treturn num*=w,*this;\n\t}\n}cin;\nint d,n;\nint pos[512],pos_[512];\ndb y[512],r;\ndb A[512][512],a[512];\ndb B[512][512],b[512];\nint top,top_;\ntemplate<typename type1,typename type2,typename type3>\ninline void gauss(type1 &A,type2 &a,type3 &pos,//\u9ad8\u65af\u6d88\u5143\n\tint &top,const int d,const int n){\n\ttop=d;\n\tfor(int id=0;id<top&&id<n;++id){\n\t\twhile(A[id][id]==0){\n\t\t\tfor(int i=id+1;i<n;++i) if(A[i][id]){\n\t\t\t\tfor(int j=id;j<d;++j)\n\t\t\t\t\tstd::swap(A[id][j],A[i][j]);\n\t\t\t\tstd::swap(a[id],a[i]);break;\n\t\t\t}\n\t\t\tif(A[id][id]==0){//\u628a\u6d88\u5143\u5931\u8d25\u7684\u7ef4\u5ea6\u653e\u5230\u6700\u540e\u9762\n\t\t\t\tif(id>=--top) return;\n\t\t\t\tstd::swap(pos[top],pos[id]);\n\t\t\t\tfor(int i=0;i<n;++i)\n\t\t\t\t\tstd::swap(A[i][id],A[i][top]);\n\t\t\t}\n\t\t}\n\t\tif(A[id][id]!=1){\n\t\t\tdb get=A[id][id];\n\t\t\tfor(int i=id+1;i<d;++i) A[id][i]/=get;\n\t\t\tA[id][id]=1,a[id]/=get;\n\t\t}\n\t\tfor(int i=0;i<n;++i) if(i!=id&&A[i][id]){\n\t\t\tdb get=A[i][id];\n\t\t\tfor(int j=id+1;j<d;++j) A[i][j]-=A[id][j]*get;\n\t\t\tA[i][id]=0,a[i]-=a[id]*get;\n\t\t}\n\t}\n}\ninline void print(){//\u5e73\u79fb\u56de\u6765\u5e76\u8f93\u51fa\u7b54\u6848\n\tfor(int i=0;i<d;++i) y[pos[i]]+=a[i];\n\tfor(int i=0;i<d;++i) printf(\"%0.6lf \",y[i]);\n}\nint main(){\n\tcin>>d>>n;\n\tfor(int i=0;i<d;++i) cin>>y[i],pos[i]=i;//\u8f93\u5165 (1) \u5f0f\n\tcin>>r,--n;\n\tfor(int id=0;id<n;++id){\n\t\tfor(int i=0;i<d;++i){//\u51cf\u53bb (1) \u5f0f\n\t\t\tcin>>A[id][i],A[id][i]-=y[i];\n\t\t\ta[id]+=A[id][i]*A[id][i];\n\t\t}\n\t\tdb get;\n\t\tcin>>get,a[id]=(a[id]+r*r-get*get)/2;\n\t}\n\tgauss(A,a,pos,top,d,n),top=std::min(top,n);//\u7b2c\u4e00\u6b21\u9ad8\u65af\u6d88\u5143\n\tif(top==d) return print(),0;//\u552f\u4e00\u89e3\n\tfor(int i=top;i<d;++i) A[i][i]=-1;\n\tconst int k=d-top;\n\tfor(int id=0;id<k;++id){//\u8ba1\u7b97 \\vec{p} \u7684\u7ebf\u6027\u65b9\u7a0b\u7ec4\n\t\tpos_[id]=id;\n\t\tfor(int i=0;i<k;++i)\n\t\t\tfor(int j=0;j<d;++j)\n\t\t\t\tB[id][i]+=A[j][id+top]*A[j][i+top];\n\t\tfor(int j=0;j<d;++j)\n\t\t\tb[id]-=A[j][id+top]*a[j];\n\t}\n\tgauss(B,b,pos_,top_,k,k);//\u7b2c\u4e8c\u6b21\u9ad8\u65af\u6d88\u5143\n\tfor(int id=0;id<k;++id)//\u5c06 \\vec{x}_1 \u4ee3\u56de \\vec{p} \n\t\tfor(int i=0;i<d;++i)\n\t\t\ta[i]+=b[id]*A[i][id+top];\n\tdb r_=r*r,r__=0;\n\tfor(int i=0;i<d;++i){//\u52fe\u80a1\u5b9a\u7406\u8ba1\u7b97 r'\n\t\tr__+=A[i][top]*A[i][top];\n\t\tr_-=a[i]*a[i];\n\t}\n\tr_=sqrtl(r_/r__);\n\tfor(int i=0;i<d;++i) a[i]+=A[i][top]*r_;\n\treturn print(),0;\n}\n```",
        "postTime": 1646983849,
        "uid": 104726,
        "name": "wangrx",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P8141 \u3010ICPC2020 WF\u3011 What\u2019s Our Vector, Victor?"
    },
    {
        "content": "\u5907\u6ce8\uff1a`\\pmb` \u5728\u9898\u89e3\u533a\u53ef\u4ee5\u6b63\u5e38\u6e32\u67d3\u3002\u4ec5\u9884\u89c8\u4e0d\u652f\u6301\u3002\n\nUpdate on 2.24\uff1a\u89c4\u8303\u6570\u5b66\u516c\u5f0f\u7528\u6cd5\uff08\u53bb\u6389\u4e86\u6240\u6709\u77e9\u9635\u524d\u9762\u7684 `\\pmb`\uff09\u3002\n\nUpdate on 4.14\uff1a\u4fee\u6539\u4e00\u4e2a Typo\u3002\n\n> *[P8141 [ICPC2020 WF] What\u2019s Our Vector, Victor?](https://www.luogu.com.cn/problem/P8141)*\n>\n> \u7ed9\u5b9a $n$ \u4e2a $d$ \u7ef4\u5411\u91cf $v_i$ \u4e0e $e_i$\uff0c\u6c42 $d$ \u7ef4\u5411\u91cf $x$ \u6ee1\u8db3 $\\|x - v_i\\| = e_i$\u3002\u4fdd\u8bc1\u6709\u89e3\u3002$n, d \\leq 500$\u3002\n\n\u6839\u636e\u9898\u610f\uff0c\u53ef\u4ee5\u5217\u51fa\u4ee5\u4e0b\u65b9\u7a0b\u3002\n$$\n\\begin{cases}\n(x_1 - v_{1, 1}) ^ 2 + (x_2 - v_{1, 2}) ^ 2 + \\cdots = e_1 ^ 2 \\\\\n(x_1 - v_{2, 1}) ^ 2 + (x_2 - v_{2, 2}) ^ 2 + \\cdots = e_2 ^ 2 \\\\\n\\cdots\n\\end{cases}\n$$\n\u5c06\u5e73\u65b9\u9879\u5c55\u5f00\u540e\uff0c\u51fa\u73b0\u4e86 $x_i ^ 2$ \u9879\u3002\u4f17\u6240\u5468\u77e5\u9ad8\u65af\u6d88\u5143\u53ea\u80fd\u5904\u7406\u7ebf\u6027\u65b9\u7a0b\u7ec4\uff0c\u6240\u4ee5\u8003\u8651\u5e38\u7528\u5957\u8def **\u5dee\u5206\u6d88\u53bb\u5e73\u65b9\u9879**\u3002\u5904\u7406\u540e\uff0c\u6211\u4eec\u5f97\u5230\u4e86 $n - 1$ \u4e2a $d$ \u5143\u7ebf\u6027\u65b9\u7a0b\u7ec4\uff0c\u548c\u6700\u5f00\u59cb\u7684\u4e00\u4e2a $d$ \u5143\u4e8c\u6b21\u65b9\u7a0b\u3002\u5f62\u5982\n$$\n\\begin{cases}\n(x_1 - v_{1, 1}) ^ 2 + (x_2 - v_{1, 2}) ^ 2 + \\cdots = e_1 ^ 2 \\\\\n2(v_{1, 1} - v_{2, 1})  x_1 + 2(v_{1, 2} - v_{2, 2}) x_2 + \\cdots = e_2 ^ 2 - e_1 ^ 2 + v_{1, 1} ^ 2 - v_{2, 1} ^ 2 + v_{1, 2} ^ 2 - v_{2, 1} ^ 2  + \\cdots \\\\\n2(v_{2, 1} - v_{3, 1}) x_1 + 2(v_{2, 2} - v_{3, 2}) x_2 + \\cdots = e_3 ^ 2 - e_2 ^ 2 + v_{2, 1} ^ 2 - v_{3, 1} ^ 2 + v_{2, 2} ^ 2 - v_{3, 1} ^ 2  + \\cdots \\\\\n\\cdots\n\\end{cases}\n$$\n\u7528\u5411\u91cf\u548c\u77e9\u9635\u63cf\u8ff0 $x$ \u524d\u7684\u7cfb\u6570\uff0c\u5219\u6709\n$$\n\\begin{cases}\n\\| \\pmb x - \\pmb v_1 \\| ^ 2 = e_1 ^ 2 \\\\\nA\\pmb x = \\pmb b\n\\end{cases}\n$$\n\u5176\u4e2d $A$ \u4e3a $(n - 1) \\times d$ \u77e9\u9635\uff0c$\\pmb x$ \u4e3a $d$ \u7ef4\u5411\u91cf\u5373\u6240\u6c42\u7b54\u6848\uff0c$\\pmb b$ \u4e3a $n - 1$ \u7ef4\u5411\u91cf\u3002\n\n\u9996\u5148\u8003\u8651\u5316\u7b80\u4e8c\u6b21\u5f0f\u3002\u4ee4 $\\pmb x' = \\pmb x - \\pmb v_1$\u3002\u5219\u65b9\u7a0b\u53ef\u5199\u4e3a\n$$\n\\begin{cases}\n\\| \\pmb x' \\| ^ 2 = e_1 ^ 2 \\\\\n A\\pmb x' = \\pmb b - A\\pmb {v}_1\n\\end{cases}\n$$\n\u63a5\u4e0b\u6765\u6211\u4eec\u7528 $\\pmb x'$ \u4ee3\u66ff $\\pmb x$\uff0c\u6c42\u89e3\u540e\u518d\u52a0\u4e0a $\\pmb v_1$\u3002\n\n\u9ad8\u65af\u6d88\u5143\u6c42\u89e3\u7ebf\u6027\u65b9\u7a0b\u7ec4 $A \\pmb x = \\pmb b - A\\pmb v_1$\uff0c\u5f97\u5230\u7ebf\u6027\u65b9\u7a0b\u7ec4\u7684\u89e3\u96c6\u7684 **\u53c2\u6570\u5411\u91cf\u5f62\u5f0f**\u3002\u5373 $\\pmb x = \\pmb x_{\\rm base} + \\sum\\limits_{i = 1} ^ r c_i\\pmb v_i$\uff0c\u5176\u4e2d $r$ \u662f **\u81ea\u7531\u5143** \u4e2a\u6570\u3002\n\n- \u4f17\u6240\u5468\u77e5\uff0c\u5bf9\u4e8e\u7ebf\u6027\u65b9\u7a0b\u7ec4\u7684\u89e3\u96c6\uff0c\u4efb\u4f55 **\u4e3b\u5143** \u90fd\u53ef\u4ee5\u5199\u4f5c\u81ea\u7531\u5143\u7684 **\u7ebf\u6027\u7ec4\u5408** \u5f62\u5f0f\u3002\u8003\u8651\u4ee4\u6240\u6709\u81ea\u7531\u5143\u7b49\u4e8e $0$\uff0c\u6211\u4eec\u5f97\u5230\u4e86 $\\pmb x_{\\rm base}$\u3002\u5c06\u6240\u6709\u81ea\u7531\u5143\u79fb\u5230\u65b9\u7a0b\u53f3\u4fa7\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u6240\u6709\u4e3b\u5143\u5173\u4e8e\u6240\u6709\u81ea\u7531\u5143\u7684\u7ebf\u6027\u7ec4\u5408\u7684\u6743\uff0c\u7a0d\u505a\u53d8\u5f62\u5373\u53ef\u5f97\u5230\u5bf9\u5e94\u5411\u91cf\u3002\n\n    \u4f8b\u5982\u4e00\u4e2a\u7b80\u5316\u884c\u9636\u68af\u578b\u589e\u5e7f\u77e9\u9635\u5bf9\u5e94\u7684\u7ebf\u6027\u65b9\u7a0b\u7ec4\n    $$\n    \\begin{cases}\n    x_1 + 6x_2 + 3x_4 = 0 \\\\\n    x_3 - 4x_4 = 5 \\\\\n    x_5 = 7\n    \\end{cases}\n    $$\n    \u5176\u4e2d $x_1, x_3, x_5$ \u662f\u4e3b\u5143\uff0c$x_2, x_4$ \u662f\u81ea\u7531\u5143\u3002\u56e0\u6b64\uff0c\u5176\u89e3\u96c6\u7684\u53c2\u6570\u8868\u793a\u4e3a\n    $$\n    \\begin{cases}\n    x_1 = -6x_2 - 3x_4 \\\\\n    x_2 = x_2 \\\\\n    x_3 = 5 + 4x_4 \\\\\n    x_4 = x_4 \\\\\n    x_5 = 7\n    \\end{cases}\n    $$\n    \u5373 $\\pmb x = \\begin{bmatrix} -6x_2 - 3x_4 \\\\ x_2 \\\\ 5 + 4x_4 \\\\ x_4 \\\\ 7 \\end{bmatrix}$\u3002\u5c06\u5e38\u6570\uff0c$x_2$ \u548c $x_4$ \u5206\u79bb\uff0c\u5f97\u5230 $\\pmb x = \\begin{bmatrix} 0 \\\\ 0 \\\\ 5 \\\\ 0 \\\\ 7 \\end{bmatrix} + x_2\\begin{bmatrix} -6 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix} + x_4\\begin{bmatrix} -3 \\\\ 0 \\\\ 4 \\\\ 1 \\\\ 0 \\end{bmatrix}$\u3002\u5373\u65b9\u7a0b\u7ec4\u7684\u89e3\u53ef\u5199\u4e3a\u4e00\u4e2a\u5e38\u5411\u91cf $\\pmb x_{\\rm base}$ \u52a0\u4e0a\u82e5\u5e72\u5411\u91cf\u7684\u7ebf\u6027\u7ec4\u5408\u3002\u7ebf\u6027\u7ec4\u5408\u7684\u6743\u5bf9\u5e94\u4e86\u81ea\u7531\u53d8\u91cf\u7684\u53d6\u503c\u3002\n\n\u4e3a\u4e86\u8ba9 $\\pmb x$ \u6ee1\u8db3 $\\| \\pmb x \\| = e_1$\uff0c\u901a\u5e38\u91c7\u7528\u7684\u624b\u6bb5\u662f\u5148\u6c42\u51fa $\\pmb x$ \u7684 **\u6700\u5c0f\u8303\u6570\u89e3** $\\pmb x_{\\min}$\uff0c\u518d\u901a\u8fc7\u8c03\u6574\u6cd5\u6c42\u89e3\u3002\u663e\u7136\uff0c\u5982\u679c $\\| \\pmb x_{\\min}\\| > e_1$ \u5219\u65e0\u89e3\uff0c\u4e0e\u9898\u610f\u77db\u76fe\uff0c\u56e0\u6b64 $\\| \\pmb x_{\\min} \\| \\leq e_1$\u3002\u800c\u901a\u8fc7\u52a0\u4e0a\u8db3\u591f\u5927\u7684 $\\pmb v_i$\uff08\u4efb\u610f\u4e00\u4e2a\u5747\u53ef\uff09\uff0c\u6211\u4eec\u603b\u80fd\u8ba9\u5f97\u5230\u7684 $\\pmb x$ \u7684\u6a21\u957f\u8d8b\u4e8e\u65e0\u7a77\u5927\u3002\u53c8\u56e0\u4e3a $\\| \\pmb x \\|$ \u5373 $\\| \\pmb x_{\\min} + k\\pmb v_i \\|$ \u7684\u53d8\u5316\u968f\u7740 $\\pmb v_i$ \u7684\u6743 $k$ \u7684\u53d8\u5316 **\u8fde\u7eed**\uff0c\u56e0\u6b64\u8c03\u6574\u6cd5\u6b63\u786e\u3002\n\n- \u5173\u4e8e\u6700\u5c0f\u8303\u6570\u89e3 $\\pmb x_{\\min}$\uff0c\u5b83\u4e0e\u6240\u6709 $\\pmb v_i$ \u5782\u76f4\u3002\u82e5\u4e0d\u4e0e\u67d0\u4e2a $\\pmb v_i$ \u5782\u76f4\uff0c\u4ee4 $\\pmb x = \\pmb x_{\\min} + k\\pmb v_i$ \u4e14 $\\pmb x \\perp \\pmb v_i$\uff0c\u901a\u8fc7\u70b9\u79ef\u7684\u6027\u8d28\u548c\u6570\u503c\u5206\u6790\u5bb9\u6613\u8bc1\u660e $\\| \\pmb x \\| < \\| \\pmb x_{\\min} \\|$\u3002\u56e0\u6b64\u53ef\u4ee5\u5217\u51fa\u65b9\u7a0b $\\pmb x_{\\min} \\cdot \\pmb v_i = 0\\ (1\\leq i \\leq r)$\uff0c\u5373 $\\pmb v_i ^ T \\pmb x_{\\min} = 0$\u3002\u82e5\u5c06 $\\pmb v_i$ \u770b\u6210\u77e9\u9635 $V = \\begin{bmatrix} \\pmb v_1 & \\pmb v_2 & \\cdots & \\pmb v_r \\end{bmatrix}$\uff0c\u5219 $V ^ T \\pmb x_{\\min} = \\pmb 0$\u3002\u53c8\u56e0\u4e3a $\\pmb x = \\pmb x_{\\rm base} + \\sum\\limits_{i = 1} ^ r c_i \\pmb v_i = \\pmb x_{\\rm base} + V\\pmb c$\uff0c\u5176\u4e2d $\\pmb c$ \u662f $r\\times 1$ \u7684\u5217\u5411\u91cf\uff0c\u56e0\u6b64 $V ^ T (\\pmb x_{\\rm base} + V\\pmb c) = \\pmb 0$\u3002\u636e\u6b64\u53ef\u9ad8\u65af\u6d88\u5143\u6c42\u5f97 $\\pmb c$\uff0c\u7ee7\u800c\u6c42\u51fa\u5bf9\u5e94\u7684 $\\pmb x_{\\min}$\u3002\n\n\u7531\u4e8e $\\pmb x_{\\min}$ \u5782\u76f4\u4e8e\u6240\u6709 $\\pmb v_i$\uff0c\u6240\u4ee5\u8c03\u6574\u65f6\u76f4\u63a5\u4f7f\u7528\u52fe\u80a1\u5b9a\u7406\uff0c\u968f\u4fbf\u9009\u51fa\u4e00\u4e2a\u5411\u91cf $\\pmb v_1$\uff0c\u7136\u540e\u4ee4 $\\pmb x = \\pmb x_{\\min} + \\sqrt {e_1 ^ 2 - \\| \\pmb x_{\\min} \\| ^ 2} \\times \\dfrac {\\pmb v_1} {\\| \\pmb v_1\\|}$ \u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n ^ 3)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst int N = 500 + 5;\nconst double eps = 1e-9;\nint n, d, fr, ma, fre[N], mai[N], rev[N];\ndouble v[N][N], A[N][N], dis[N], ans[N];\ndouble b[N], xm[N], co[N][N];\n\nint find(int m, double *A) {\n\tfor(int i = 1; i <= m; i++) if(fabs(A[i]) > eps) return i;\n\treturn -1;\n}\n\ntemplate <class T>\n\tvoid Gauss(int n, int m, T A) {\n\t\tint r = 1;\n\t\tfor(int c = 1; c < m && r <= n; c++) {\n\t\t\tint p = r;\n\t\t\tfor(int i = r + 1; i <= n; i++) if(fabs(A[i][c]) > fabs(A[p][c])) p = i;\n\t\t\tswap(A[r], A[p]);\n\t\t\tif(fabs(A[r][c]) < eps) continue;\n\t\t\tfor(int i = m; i >= c; i--) A[r][i] /= A[r][c];\n\t\t\tfor(int i = r + 1; i <= n; i++) for(int j = m; j >= c; j--) A[i][j] -= A[r][j] * A[i][c];\n\t\t\tr++;\n\t\t}\n\t\t\n\t\tfor(int i = n - 1; i > 0; i--) {\n\t\t\tfor(int j = i + 1; j <= n; j++) {\n\t\t\t\tint main = find(m - 1, A[j]);\n\t\t\t\tif(main == -1) continue;\n\t\t\t\tif(fabs(A[i][main]) > eps) for(int k = m; k >= main; k--) A[i][k] -= A[i][main] * A[j][k];\n\t\t\t}\n\t\t\tint main = find(m - 1, A[i]);\n\t\t\tif(main == -1) continue;\n\t\t\tfor(int j = m; j >= main; j--) A[i][j] /= A[i][main];\n\t\t}\n\t}\n\nvoid init() {\n\tfor(int i = 1; i < n; i++) {\n\t\tint main = find(d, A[i]);\n\t\tif(main != -1) rev[main] = -1, mai[++ma] = main;\n\t}\n\tfor(int i = 1; i <= d; i++) if(!rev[i]) fre[++fr] = i, co[rev[i] = fr][i] = 1;\n}\n\nvoid solve() {\n\tfor(int i = 1; i < n; i++) {\n\t\tint main = find(d, A[i]);\n\t\tb[main] = A[i][d + 1];\n\t\tfor(int j = main + 1; j <= d; j++) if(~rev[j]) co[rev[j]][main] = -A[i][j];\n\t}\n\n\tmemset(A, 0, sizeof(A));\n\tfor(int i = 1; i <= fr; i++) for(int j = 1; j <= d; j++) A[i][fr + 1] -= co[i][j] * b[j];\n\tfor(int i = 1; i <= fr; i++) for(int j = 1; j <= d; j++) for(int k = 1; k <= fr; k++) A[i][k] += co[i][j] * co[k][j];\n\tGauss(fr, fr + 1, A);\n\tfor(int i = 1; i <= fr; i++) for(int j = 1; j <= d; j++) xm[j] += A[i][fr + 1] * co[i][j];\n\tfor(int i = 1; i <= d; i++) xm[i] += b[i];\n\t\n\tdouble normx = 0, normc = 0;\n\tfor(int i = 1; i <= d; i++) normx += xm[i] * xm[i], normc += co[1][i] * co[1][i];\n\tnormc = sqrt(normc);\n\tfor(int i = 1; i <= d; i++) ans[i] = xm[i] + co[1][i] / normc * sqrt(dis[1] * dis[1] - normx);\n\t\n\t\n}\n\nint main() {\n\tcin >> d >> n;\n\tfor(int i = 1; i <= n; i++) {\n\t\tfor(int j = 1; j <= d; j++) scanf(\"%lf\", &v[i][j]);\n\t\tscanf(\"%lf\", &dis[i]);\n\t}\n\tfor(int i = 1; i < n; i++) {\n\t\tA[i][d + 1] = dis[i + 1] * dis[i + 1] - dis[i] * dis[i];\n\t\tfor(int j = 1; j <= d; j++) {\n\t\t\tA[i][j] = 2 * (v[i][j] - v[i + 1][j]);\n\t\t\tA[i][d + 1] += v[i][j] * v[i][j] - v[i + 1][j] * v[i + 1][j];\n\t\t}\n\t}\n\tfor(int i = 1; i < n; i++) for(int j = 1; j <= d; j++) A[i][d + 1] -= A[i][j] * v[1][j];\n\t\n\tGauss(n - 1, d + 1, A), init();\n\tif(fr) solve();\n\telse for(int i = 1; i <= d; i++) ans[i] = A[i][d + 1];\n\tfor(int i = 1; i <= d; i++) printf(\"%.17lf\\n\", ans[i] + v[1][i]);\n\t\n\treturn 0;\n}\n\n/*\nstupid mistakes:\n\tforget to check if main is -1\n\t\u6ce8\u610f co[i][j] \u7684\u610f\u4e49\uff0c\u8868\u793a v_{i_{j, 1}}\uff0c\u5373\u7b2c i \u4e2a\u81ea\u7531\u5143\u6539\u53d8\u65f6\uff0cx_j \u7684\u53d8\u5316\u7cfb\u6570 \n\t\u52fe\u80a1\u5b9a\u7406\u5fd8\u8bb0\u5f00\u6839 =.=\n\tv1 \u6b63\u8d1f\u641e\u9519 \n\t\u6c42\u8303\u6570\u5fd8\u8bb0\u5f00\u6839 \n*/\n```",
        "postTime": 1645494353,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "P8141 [ICPC2020 WF] What\u2019s Our Vector, Victor?"
    },
    {
        "content": "\uff08`$\\pmb$` \u5728\u9898\u89e3\u533a\u548c\u535a\u5ba2\u91cc\u662f\u53ef\u4ee5\u6e32\u67d3\u7684\uff01\uff01\uff01\uff09\n\n\u7ebf\u6027\u4ee3\u6570\u597d\u9898\u3002\n\n\u6362\u4e00\u4e0b\u8212\u670d\u7684\u53d8\u91cf\u540d\uff1a\u8bbe\u6709 $n$ \u4e2a\u5411\u91cf\uff0c\u7a7a\u95f4\u4e3a $m$ \u7ef4\uff0c\u7b2c $i$ \u4e2a\u5411\u91cf\u4e3a $\\pmb v_i$\uff0c\u8ddd\u79bb\u4e3a $d_i$\u3002\n\n\u5217\u5f97\u65b9\u7a0b\uff1a\u5bf9 $i\\in[1,n]$ \u90fd\u6709 $\\|\\pmb v_i-\\pmb x\\|=s_i$\u3002\u5c55\u5f00\u5f97\u5230 $\\sum\\limits_{j=1}^m(v_{i,j}-x_j)^2=d_i^2$\uff0c\u5373 $\\sum\\limits_{j=1}^mv_{i,j}^2-2\\sum\\limits_{j=1}^mv_{i,j}x_j+\\sum\\limits_{j=1}^mx_j^2=s_i^2$\u3002\u7b49\u5f0f\u5de6\u8fb9\u7b2c\u4e00\u9879\u4e3a\u5e38\u6570\uff0c\u53ef\u4ee5\u79fb\u5230\u53f3\u8fb9\u53bb\uff1b\u7b2c\u4e8c\u9879\u662f $\\pmb x$ \u5404\u5206\u91cf\u7684\u7ebf\u6027\u7ec4\u5408\uff1b\u7b2c\u4e09\u9879\u662f\u4e8c\u6b21\u7684\uff0c\u6709\u70b9\u96be\u529e\u3002\u4e0d\u8fc7\u89c2\u5bdf\u5230\u7b2c\u4e09\u9879\u867d\u7136\u662f\u672a\u77e5\u91cf\uff0c\u4f46\u662f\u5bf9\u4e8e\u6240\u6709\u65b9\u7a0b\u90fd\u76f8\u7b49\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5dee\u5206\u5c06\u5176\u6d88\u53bb\u3002\u5177\u4f53\u5730\uff0c\u5bf9\u7b2c $i\\in[2,n]$ \u4e2a\u65b9\u7a0b\uff0c\u4ee4\u5176\u51cf\u53bb\u7b2c\u4e00\u4e2a\u65b9\u7a0b\uff0c\u5f97\u5230 $n-1$ \u4e2a\u7ebf\u6027\u65b9\u7a0b\u548c\u4e00\u4e2a\u4e8c\u6b21\u65b9\u7a0b\u3002\n\n\u4e0d\u59a8\u5148\u5c06\u8fd9 $n-1$ \u4e2a\u7ebf\u6027\u65b9\u7a0b\u9ad8\u65af\u6d88\u5143\u89e3\u4e00\u4e0b\u3002\u5982\u679c\u89e3\u662f\u552f\u4e00\u7684\uff0c\u7531\u4e8e\u9898\u76ee\u4fdd\u8bc1\u6709\u89e3\uff0c\u90a3\u4e48\u8fd9\u7ec4\u89e3\u4e00\u5b9a\u662f\u89e3\uff0c\u76f4\u63a5\u8f93\u51fa\u5c31\u53ef\u4ee5\u4e86\uff08\u4e8b\u5b9e\u4e0a\u7406\u8bba\u4e0a\u8fd9\u91cc\u4e0d\u7528\u7279\u5224\uff0c\u4f46\u662f\u7531\u4e8e\u540e\u9762\u7684\u505a\u6cd5\u4e0d\u592a\u80fd\u5904\u7406\u5927\u5c0f\u4e3a $0$ \u7684\u77e9\u9635\uff0c\u6240\u4ee5\u2026\u2026\uff09\u3002\u5426\u5219\u6211\u4eec\u5f97\u5230\u89e3\u96c6\u7684\u53c2\u6570\u5411\u91cf\u5f62\u5f0f $\\pmb x\\in\\mathrm{Span}\\{\\pmb u_{1\\sim k}\\}+\\pmb b$\uff0c\u5176\u4e2d $k$ \u4e3a\u81ea\u7531\u53d8\u91cf\u4e2a\u6570\u3002\u73b0\u5728\u53ea\u8981\u627e\u5230\u8fd9\u4e2a\u89e3\u96c6 $X+\\pmb b$ \u4e2d\u4efb\u610f\u4e00\u4e2a\u6ee1\u8db3\u7b2c\u4e00\u4e2a\u4e8c\u6b21\u65b9\u7a0b $\\|\\pmb x-\\pmb v_1\\|=s_1$ \u7684 $\\pmb x$ \u5373\u53ef\u3002\u6c42 $\\pmb x-\\pmb v_1$ \u7684\u8303\u6570\u4e0d\u592a\u597d\u5904\u7406\uff0c\u6211\u4eec\u4e0d\u59a8\u5728\u4e00\u5f00\u59cb\u5c31\u4ee4 $\\pmb x'=\\pmb x-\\pmb v_1 $\uff0c\u6c42\u51fa $\\pmb x'$ \u540e\u8fd8\u539f $\\pmb x$ \u5373\u53ef\u3002\u8bbe $n-1$ \u4e2a\u7ebf\u6027\u65b9\u7a0b\u7684\u77e9\u9635\u5f62\u5f0f\u4e3a $Q\\pmb x=\\pmb d$\uff0c\u7531 $\\pmb x=\\pmb x'+\\pmb v_1$ \u5f97 $Q\\pmb x'=\\pmb d-Q\\pmb v_1$\uff0c\u4f9d\u7136\u662f\u7ebf\u6027\u65b9\u7a0b\u7ec4\uff0c\u4e0d\u5f71\u54cd\u4ec0\u4e48\u3002\u4e4b\u540e\u90fd\u8ba4\u4e3a $\\pmb x$ \u5c31\u4ee3\u6307 $\\pmb x'$\u3002\n\n\u4e8e\u662f\u6211\u4eec\u8981\u6c42\u4e00\u4e2a\u7ebf\u6027\u7a7a\u95f4 $X$ \u5e73\u79fb\u4e00\u4e2a\u5411\u91cf $\\pmb b$ \u5f97\u5230\u7684\u89e3\u96c6\u4e2d\u8303\u6570\u7b49\u4e8e $s$ \u7684\u5411\u91cf\u3002\u6ce8\u610f\u5230\uff1a\u8bbe $X+\\pmb b$ \u4e2d\u7684\u8303\u6570\u6700\u5c0f\u7684\u5411\u91cf\u7684\u8303\u6570\u4e3a $M$\uff0c\u5219 $X+\\pmb b$ \u4e2d\u7684\u8303\u6570\u8303\u56f4\u4e3a $[M,+\\infty)$\u3002\u4e8e\u662f\u6211\u4eec\u5c1d\u8bd5\u6c42\u51fa\u6700\u5c0f\u8303\u6570\u89e3\uff0c\u7136\u540e\u8c03\u6574\u4e3a\u8303\u6570\u6070\u597d\u7b49\u4e8e $s$\u3002\n\n\u5148\u8bb2\u5982\u4f55\u8c03\u6574\u3002\u5047\u8bbe\u6211\u4eec\u627e\u5230\u4e86\u6700\u5c0f\u8303\u6570\u89e3 $\\pmb x_{\\min}$\uff0c\u6211\u4eec\u77e5\u9053 $X+\\pmb x_{\\min}=X+\\pmb b$\uff08\u8ddf\u636e\u82e5 $\\pmb v\\in V$ \u5219 $V+\\pmb v=V$\uff08\u5176\u4e2d $V$ \u662f\u7ebf\u6027\u7a7a\u95f4\u7684\u6027\u8d28\u6613\u8bc1\uff09\uff09\uff0c\u4e8e\u662f\u6211\u4eec\u53ea\u8981\u6c42\u51fa $\\pmb x\\in X$ \u4f7f $\\|\\pmb x_{\\min}+\\pmb x\\|=s$\u3002\u4e4d\u4e00\u770b\u611f\u89c9\u8fd8\u662f\u4e0d\u5bb9\u6613\uff0c\u4f46\u662f\u6ce8\u610f\u5230\u6211\u4eec\u53ea\u8981\u6c42\u4efb\u610f\u4e00\u7ec4\u89e3\uff08\u800c\u4e0d\u8981\u6c42\u6240\u6709\u89e3\uff09\uff0c\u90a3\u4e48\u5bb9\u6613\u6ce8\u610f\u5230\u4ec5\u4ee4 $\\pmb x$ \u53d6\u904d $c\\pmb u_1$ \u8fd9\u4e00\u6761\u76f4\u7ebf\u4fbf\u5fc5\u7136\u80fd\u627e\u5230\u89e3\u3002\u5177\u4f53\u5730\uff1a\u6211\u4eec\u719f\u77e5 $\\pmb x_{\\min}\\perp X$\uff0c\u6240\u4ee5 $\\pmb x_{\\min},\\pmb x+\\pmb x_{\\min},\\pmb 0$ \u4e09\u70b9\u6784\u6210\u76f4\u89d2\u4e09\u89d2\u5f62\uff0c\u5df2\u77e5\u5176\u4e2d\u4e24\u6761\u8fb9\u4e3a $\\|\\pmb x_{\\min}\\|,s$\uff0c\u53ef\u4ee5\u901a\u8fc7\u52fe\u80a1\u5b9a\u7406\u6c42\u51fa $\\pmb x+\\pmb x_{\\min}$ \u4e0e $\\pmb x_{\\min}$ \u7684\u8ddd\u79bb $D$\uff0c\u4e8e\u662f $\\pmb x=\\pm\\dfrac{D}{\\|\\pmb u_1\\|}\\pmb u_1$\uff0c\u4efb\u53d6\u4e00\u4e2a\u5c31\u597d\u3002\n\n\u4e0b\u9762\u6765\u8bb2\u5982\u4f55\u6c42\u6700\u5c0f\u8303\u6570\u89e3\u3002\u6ce8\u610f\u5230\u5982\u679c\u5e73\u79fb\u4e00\u4e0b\u5750\u6807\u7cfb\uff0c$\\pmb x\\in X+\\pmb b$ \u7684\u8303\u6570\u76f8\u5f53\u4e8e $\\pmb x-\\pmb b\\in X$ \u4e0e $-\\pmb b$ \u7684\u8ddd\u79bb\u3002\u7531\u4e8e\u7ebf\u6027\u7a7a\u95f4\u5173\u4e8e\u539f\u70b9\u5bf9\u79f0\uff0c\u6c42 $\\pmb b$ \u5230 $X$ \u7684\u6700\u8fd1\u5411\u91cf\uff0c\u6700\u540e\u53d6\u53cd\u5373\u53ef\u3002\u8fd9\u663e\u7136\u5c31\u662f $\\pmb b$ \u5230 $X$ \u7684\u6295\u5f71 $\\mathrm{proj}_X\\pmb b$\u3002\u6295\u5f71\u8ba1\u7b97\u516c\u5f0f\u9700\u8981\u7a7a\u95f4\u7684\u4e00\u7ec4\u6b63\u4ea4\u57fa\uff0c\u800c\u6211\u4eec\u73b0\u5728\u53ea\u6709\u666e\u901a\u57fa $\\pmb u_{1\\sim k}$\uff0c\u8fd8\u8981\u901a\u8fc7\u683c\u62c9\u59c6-\u65bd\u5bc6\u7279\u65b9\u6cd5\u6c42\u51fa\u4e00\u7ec4\u6b63\u4ea4\u57fa\uff0c\u6709\u70b9\u9ebb\u70e6\uff0c\u4e0d\u59a8\u76f4\u63a5\u8003\u8651\u7528\u666e\u901a\u57fa\u6c42\u6295\u5f71\u3002\u8bbe $\\pmb p=\\mathrm{proj}_X\\pmb b$\uff0c\u6211\u4eec\u77e5\u9053 $\\pmb b-\\pmb p\\perp X$ \u4e14 $\\pmb p\\in X$\uff0c\u5e76\u4e14\u5411\u91cf\u4e0e\u7ebf\u6027\u7a7a\u95f4\u5782\u76f4\u5f53\u4e14\u4ec5\u5f53\u5176\u4e0e\u4e00\u7ec4\u57fa\u5782\u76f4\uff0c\u4e8e\u662f\u5bf9 $i\\in[1,k]$ \u6709 $\\pmb u_i\\cdot(\\pmb b-\\pmb p)=0$\u3002\u8bbe $U=\\begin{bmatrix}\\pmb u_{1\\sim k}\\end{bmatrix},\\pmb p=U\\pmb c$\uff0c\u6709 $U^{\\mathrm T}(\\pmb b-U\\pmb c)=\\pmb 0$\uff0c\u5373 $\\pmb c=\\!\\left(U^{\\mathrm T}U\\right)^{-1}U^{\\mathrm T}\\pmb b$\u3002\n\n\u6b64\u5904\u6709\u4e9b\u540c\u5b66\u5173\u4e8e\u65b9\u9635 $U^{\\mathrm T}U$ \u7684\u6ee1\u79e9\u6027\u6709\u4e9b\u7591\u95ee\uff0c\u4e8b\u5b9e\u4e0a\u8fd9\u4e0d\u4f9d\u8d56\u4e8e\u968f\u673a\u6027\u3002\u4e8b\u5b9e\u4e0a\u6211\u4eec\u6709\u66f4\u5f3a\u7684\u7ed3\u8bba\uff1a\u5bf9\u4efb\u610f $m\\times n$ \u77e9\u9635 $A$\uff0c\u6709 $\\operatorname{rank}A^{\\mathrm T}A=\\operatorname{rank}A$\u3002  \n\u968f\u4fbf\u80e1\u4e2a\u8bc1\u660e\uff1a\u4e00\u65b9\u9762\uff0c\u82e5 $A\\pmb x=\\pmb 0$\uff0c\u5219\u663e\u7136 $A^{\\mathrm T}A\\pmb x=\\pmb 0$\uff0c\u6240\u4ee5 $\\operatorname{Nul}A\\subseteq\\operatorname{Nul}A^{\\mathrm T}A$\uff1b\u53e6\u4e00\u65b9\u9762\uff0c\u82e5 $A^{\\mathrm T}A\\pmb x=\\pmb 0$\uff0c\u5219 $\\pmb x^{\\mathrm T}A^{\\mathrm T}A\\pmb x=\\pmb 0_1$\uff0c\u5373 $(A\\pmb x)^2=0$\uff0c\u6240\u4ee5 $A\\pmb x=\\pmb 0$\uff0c\u6240\u4ee5 $\\operatorname{Nul}A^{\\mathrm T}A\\subseteq \\operatorname{Nul}A$\u3002\u5f97\u5230 $\\operatorname{Nul}A^{\\mathrm T}A=\\operatorname{Nul}A$\u3002\u53c8\u56e0\u4e3a\u8fd9\u4e24\u4e2a\u77e9\u9635\u7684\u5217\u6570\u90fd\u4e3a $n$\uff0c\u79e9\u90fd\u4e3a $n-\\dim\\operatorname{Nul}$\uff0c\u539f\u547d\u9898\u5f97\u8bc1\u3002  \n\u6b64\u5904 $m\\times k$ \u77e9\u9635 $U$ \u5404\u5217\u662f $X$ \u7684\u57fa\uff0c\u6240\u4ee5\u5404\u5217\u7ebf\u6027\u65e0\u5173\uff0c\u79e9\u4e3a $k$\uff0c\u6240\u4ee5 $\\operatorname{rank} U^{\\mathrm T}U=k$\uff0c\u6ee1\u79e9\u3002\uff08\u6240\u4ee5\u81f3\u6b64\u4e0d\u77e5\u9053\u8fd9\u9898\u6570\u636e\u968f\u673a\u6709\u5565\u7528\uff1f\u53ef\u80fd\u662f\u4e3a\u4e86\u9632\u7206\u7cbe\u5ea6\u5427\uff09\n\nu1s1 \u77e9\u9635\u5c01\u88c5\u8d77\u6765\u5199\u771f\u8212\u9002\uff08\n\n```cpp\nconstexpr db eps = 1e-8;\nconstexpr int N = 510;\n\nint n, m, s;\ndb dis[N];\n\nusing vd = vector<db>;\nusing vvd = vector<vd>;\nvd operator-(vd f, vd g) {\n\tint n = SZ(f) - 1;\n\tREP(i, 1, n) f[i] -= g[i];\n\treturn f;\n}\nstruct matrix : vvd {\n\tusing vvd::vvd;\n\tmatrix() {}\n\tmatrix(int n, int m) { resize(n + 1, vector<db>(m + 1, 0.)); }\n\tmatrix(int n, int m, auto f) {\n\t\tresize(n + 1, vector<db>(m + 1));\n\t\tREP(i, 1, n) REP(j, 1, m) (*this)[i][j] = f;\n\t}\n\tfriend matrix operator~(matrix f) {\n\t\tint n = SZ(f) - 1, m = SZ(f[1]) - 1;\n\t\tmatrix g(m, n);\n\t\tREP(i, 1, n) REP(j, 1, m) g[j][i] = f[i][j];\n\t\treturn g;\n\t}\n\tfriend matrix operator+(matrix f, matrix g) {\n\t\tint n = SZ(f) - 1, m = SZ(f[1]) - 1;\n\t\tREP(i, 1, n) REP(j, 1, m) f[i][j] += g[i][j];\n\t\treturn f;\n\t}\n\tfriend matrix operator-(matrix f, matrix g) {\n\t\tint n = SZ(f) - 1, m = SZ(f[1]) - 1;\n\t\tREP(i, 1, n) REP(j, 1, m) f[i][j] -= g[i][j];\n\t\treturn f;\n\t}\n\tfriend matrix operator-(matrix f) {\n\t\tint n = SZ(f) - 1, m = SZ(f[1]) - 1;\n\t\tREP(i, 1, n) REP(j, 1, m) f[i][j] = -f[i][j];\n\t\treturn f;\n\t}\n\tvoid operator&=(matrix g) {\n\t\tmatrix &f = *this;\n\t\tint n = SZ(f) - 1, m = SZ(g[1]) - 1;\n\t\tREP(i, 1, n) REP(j, 1, m) f[i].pb(g[i][j]);\n\t}\n\tvoid gauss() {\n\t\tvvd &a = *this;\n\t\tint n = SZ(a) - 1, m = SZ(a[1]) - 1;\n\t\tauto tadd = [&](int x, db v, int y) {\n\t\t\tREP(i, 1, m) a[y][i] += v * a[x][i];\n\t\t};\n\t\tauto times = [&](int x, db v) {\n\t\t\tREP(i, 1, m) a[x][i] *= v;\n\t\t};\n\t\tfor(int i = 1; ; ++i) {\n\t\t\tint x = 0, y = 0;\n\t\t\tREP(j, 1, m) REP(k, i, n) if(abs(a[k][j]) > eps) {\n\t\t\t\tx = k, y = j; \n\t\t\t\tdb mx = 0;\n\t\t\t\tREP(k, i, n) if(abs(a[k][j]) > mx) mx = a[k][j], x = k;\n\t\t\t\tgoto edlp;\n\t\t\t} edlp:;\n\t\t\tif(!x) break;\n\t\t\ta[x].swap(a[i]);\n\t\t\tREP(j, 1, n) if(i != j) tadd(i, -a[j][y] / a[i][y], j);\n\t\t\ttimes(i, 1 / a[i][y]);\n\t\t}\n\t}\n\tfriend matrix operator*(db f, matrix g) {\n\t\tint n = SZ(g) - 1, m = SZ(g[1]) - 1;\n\t\tREP(i, 1, n) REP(j, 1, m) g[i][j] *= f;\n\t\treturn g;\n\t}\n\tfriend matrix operator*(matrix f, matrix g) {\n\t\tint n = SZ(f) - 1, m = SZ(g) - 1, s = SZ(g[1]) - 1;\n\t\tmatrix h(n, s);\n\t\tREP(k, 1, m) REP(i, 1, n) REP(j, 1, s) h[i][j] += f[i][k] * g[k][j];\n\t\treturn h;\n\t}\n\tdb len2() { return (~*this * *this)[1][1]; }\n\tdb len() { return sqrt(len2()); }\n} v[N], Q, d, U, UT, b, xmin, c, ans;\n\nvoid mian() {\n\tm = read(), n = read();\n\tREP(i, 1, n) {\n\t\tv[i] = matrix(m, 1);\n\t\tREP(j, 1, m) scanf(\"%Lf\", &v[i][j][1]);\n\t\tscanf(\"%Lf\", dis + i);\n\t}\n\tQ = matrix(n, m), d = matrix(n, 1);\n\tREP(i, 1, n) {\n\t\td[i][1] = dis[i] * dis[i];\n\t\tREP(j, 1, m) d[i][1] -= v[i][j][1] * v[i][j][1];\n\t\tREP(j, 1, m) Q[i][j] = -2 * v[i][j][1];\n\t}\n\tREP(i, 2, n) Q[i] = Q[i] - Q[1], d[i][1] = d[i][1] - d[1][1];\n\tQ[1].swap(Q[n]), Q.resize(n); swap(d[1][1], d[n][1]), d.resize(n);\n\td = d - Q * v[1];\n\tQ &= d, Q.gauss();\n\tstatic bool isbase[N];\n\tREP(i, 1, n - 1) {\n\t\tint x = 0;\n\t\tPER(j, m, 1) if(abs(Q[i][j]) > eps) x = j;\n\t\tisbase[x] = true;\n\t}\n\tif(count(isbase + 1, isbase + m + 1, true) == m) {\n\t\tans = matrix(m, 1);\n\t\tREP(i, 1, m) ans[i][1] = Q[i][m + 1];\n\t\tans = ans + v[1];\n\t\tgoto skip;\n\t}\n\tUT.pb();\n\tb = matrix(m, 1);\n\tREP(i, 1, m) if(!isbase[i]) {\n\t\t++s;\n\t\tUT.pb(m + 1);\n\t\tvd &u = UT.back();\n\t\tint now = 0;\n\t\tREP(j, 1, m) \n\t\t\tif(j == i) u[j] = 1;\n\t\t\telse if(!isbase[j]) u[j] = 0;\n\t\t\telse u[j] = -Q[++now][i], b[j][1] = Q[now][m + 1];\n\t}\n\tU = ~UT;\n\tQ = UT * U, Q &= -UT * b, Q.gauss();\n\tc = matrix(s, 1); REP(i, 1, s) c[i][1] = Q[i][s + 1];\n\txmin = U * c + b;\n\tans = xmin + (sqrt(dis[1] * dis[1] - xmin.len2()) / (~matrix(2, UT[1])).len()) * ~matrix(2, UT[1]), ans = ans + v[1];\n\tskip: REP(i, 1, m) printf(\"%.12Lf\\n\", ans[i][1]);\n}\n```\n\n",
        "postTime": 1645495445,
        "uid": 138400,
        "name": "chenxia25",
        "ccfLevel": 9,
        "title": "p8141"
    }
]
[
    {
        "content": "\u9898\u76ee\u8981\u6c42\u662f\u7ed9\u5b9a $n$ \u4e2a\u6570 $a_1,a_2,\\ldots,a_n$\uff0c\u4ee5\u53ca\u4e00\u4e2a\u6570 $k$ \u3002\r\n\r\n\u8ba1\u6570\u5668 $c$ \u4e00\u5f00\u59cb\u4e3a $0$\uff0c\u4e00\u6b21\u53ea\u80fd\u52a0 $1$\uff0c\u4e14 $c$ \u8fd9\u4e2a\u8ba1\u6570\u5668\u6bcf\u4e00\u6b21\u5230 $k$ \u90fd\u4f1a\u8df3\u56de $0$\u3002\r\n\r\n\u518d\u7ed9\u5b9a\u4e00\u4e9b\u4e0b\u6807 $b_1,b_2,\\ldots,b_m$\uff0c\u8868\u793a\u5982\u679c\u5728\u52a0 $a_{b_i}$ \u4e2a $1$ \u7684\u65f6\u5019\u521a\u597d\u6709\u52a0\u6700\u540e\u4e00\u4e2a\u6570\u65f6\u8ba1\u6570\u5668\u8df3\u56de 0\uff0c\u90a3\u4e48\u79f0\u8fbe\u6210\u4e00\u6b21\u4e8b\u4ef6\u3002\u6211\u4eec\u8981\u8fbe\u6210\u5c3d\u91cf\u591a\u7684\u4e8b\u4ef6\u3002\r\n\r\n\u6211\u4eec\u5c06\u4f9d\u6b21\u628a\u8ba1\u6570\u5668\u52a0 $a_1$ \u6b21 $1$ \uff0c$a_2$ \u6b21 $1$ \uff0c$\\ldots$\uff0c$a_n$ \u6b21 $1$ \uff0c\u4f46\u6211\u4eec\u53ef\u4ee5\u7528bomb\u8df3\u8fc7\u5176\u4e2d\u4e00\u6bb5\u52a0\u6570\u3002\u95ee\u8fbe\u6210\u4e8b\u4ef6\u6570\u91cf\u7684\u6700\u5927\u503c\u3002\r\n\r\n---\r\n\r\n\u9996\u5148\uff0c\u7531\u4e8e\u8ba1\u6570\u5668\u6bcf\u52a0\u5230 $k$ \u8df3\u56de $0$ \uff0c\u6240\u4ee5\u53ea\u8981\u6709\u67d0\u4e00\u6b21\u52a0 $1$ \u4f7f\u5f97\u52a0\u5b8c\u540e\u603b\u5171\uff08\u8ba1\u6570\u5668\u4e0d\u8df3\u56de\uff09\u7684\u6570\u5b57\u4e3a $k$ \u7684\u500d\u6570\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u8ba4\u5b9a\u8fd9\u4e00\u6b21\u52a0 $1$ \u5bfc\u81f4\u8ba1\u6570\u5668\u8df3\u56de\u3002\r\n\r\n\u6240\u4ee5\uff0c\u5728\u4e0d\u4f7f\u7528 bomb \u7684\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u5bf9\u4e8e\u67d0\u4e00\u4e2a**\u5728 $b$ \u4e2d\u7684** $i$\uff0c\u8981\u4f7f\u52a0\u5b8c $a_i$ \u65f6\u89e6\u53d1\u4e8b\u4ef6\u53ea\u8981 $a_1+a_2+...+a_i$ \u662f $k$ \u7684\u500d\u6570\u3002\r\n\r\n---\r\n\r\n\u5982\u679c\u4f7f\u7528 bomb\uff0c\u5047\u8bbe\u653e\u5728\u4e86 $j$ \u4f4d\uff0c\u5219\u5bf9\u6240\u6709\u7684 $i$ \u5c0f\u4e8e $j$ \uff0c\u52a0\u5230 $a_i$ \u65f6\u52a0\u7684 $1$ \u7684\u6570\u91cf\u4ecd\u7136\u4e3a $a_1+a_2+...+a_i$ \uff0c\u4e0d\u6539\u53d8\u5bf9\u89e6\u53d1\u4e8b\u4ef6\u6570\u91cf\u7684\u8d21\u732e\u3002\r\n\r\n\u7531\u4e8e\u52a0 $a_j$ \u88ab\u8df3\u8fc7\uff0c\u52a0\u5b8c $a_j$ \u4e0d\u5e94\u5f53\u89e6\u53d1\u4e8b\u4ef6\u3002\r\n\r\n\u5bf9\u4e8e\u53e6\u5916\u7684 $i$ \u5927\u4e8e $j$ \uff0c\u52a0\u5230 $a_i$ \u65f6\u52a0\u7684 $1$ \u7684\u6570\u91cf\u53d8\u4e3a $a_1+a_2+...+a_i -a_j$\uff0c\u5176\u4e3a $k$ \u7684\u500d\u6570\u5f53\u4e14\u4ec5\u5f53$a_1+a_2+...+a_i$ \u548c $a_j$ \u6a21 $k$ \u540c\u4f59\u3002\r\n\r\n---\r\n\r\n\u8bb0 $S_i=a_1+a_2+\\ldots+a_i$ \u8868\u793a\u6570\u7ec4 $a_n$ \u7684\u7b2c $i$ \u4e2a\u524d\u7f00\u548c\u3002\r\n\r\n\u6211\u4eec\u53ef\u4ee5\u5148\u7edf\u8ba1 $a_n$ \u6570\u7ec4\u7684 $n$ \u4e2a\u524d\u7f00\u662f $k$ \u7684\u500d\u6570\u7684**\u5728 $b$ \u4e2d\u7684\u4e0b\u6807**\u4e2a\u6570\u8bb0\u4e3a $t$\uff0c\u5e76\u5c06\u7b54\u6848\u8bbe\u7f6e\u6210\u4e0d\u653e bomb \u7684\u60c5\u51b5\uff0c\u4e5f\u5c31\u662f $t$\u3002\r\n\r\n\u63a5\u7740\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u653e bomb \u7684\u4f4d\u7f6e $j$ \u4ece $n$ \u5f00\u59cb\u679a\u4e3e\u5230 $1$\u3002\u6211\u4eec\u8ba9 $t$ \u8868\u793a $S_1,S_2,\\ldots,S_{j}$ \u4e2d $k$ \u7684\u500d\u6570\uff0c\u53ea\u7edf\u8ba1\u5728 $b$ \u4e2d\u7684\u3002\r\n\r\n\u6211\u4eec\u5f00\u4e00\u4e2a\u6570\u7ec4 $x_0,x_1,\\ldots,x_{k-1}$\uff0c\u5728\u6bcf\u4e00\u4e2a $j$ \u65f6\u8868\u793a $S_{j+1},S_{j+2}...,S_n$ \u4e2d\u6a21 $k$ \u4f59 $i$ \u7684\u6570\u6709 $x_i$ \u4e2a\u3002\r\n\r\n\u7531\u4e8e\u6bcf\u4e00\u6b21\u8003\u8651\u7684\u662f $S_1,S_2,\\ldots,S_{j-1}$\u4e2d $k$ \u7684\u500d\u6570\u7684\u4e2a\u6570 \u4ee5\u53ca\u548c $S_{j+1},S_{j+2},...,S_n$ \u4e2d\u4e0e $a_j$ \u5177\u6709\u6a21 $k$ \u76f8\u540c\u4f59\u6570\u7684\u6570\u7684\u4e2a\u6570\u3002\r\n\r\n\u5982\u679c $S_j$ \u662f $k$ \u7684\u500d\u6570\uff0c\u6211\u4eec\u8ba9 $t$ \u53d8\u6210 $t-1$ \uff0c\u8fd9\u6837 $t$ \u5c31\u8868\u793a $S_1,S_2,\\ldots,S_{j-1}$\u4e2d $k$ \u7684\u500d\u6570\u7684\u4e2a\u6570\u4e86\u3002\r\n\r\n\u7136\u540e\u5c06\u7b54\u6848\u66f4\u65b0\u4e3a $t+x_{a_j}$\uff08\u53ca\u548c\u5148\u540e\u7b54\u6848\u53d6 $\\max$\uff09\u3002\r\n\r\n\u6700\u540e\uff0c\u5982\u679c $j$ \u5728 $b$ \u4e2d\uff0c\u5c06 $x_{S_j\\mod k}$ \u8fd9\u4e2a\u6570\u52a0 $1$ \uff0c\u4ee5\u4fbf $j$ \u53d8\u4e3a $j-1$ \u65f6 $x$ \u6570\u7ec4\u8868\u793a  $S_j,S_{j+1},...,S_n$ \u4e2d**\u5173\u952e\u70b9**\u6a21 $k$ \u4f59 $i$ \u7684\u6570\u6709 $x_i$ \u4e2a\u3002\r\n\r\n---\r\n\r\n\u679a\u4e3e\u5b8c\u6210\u540e\u8f93\u51fa\u7b54\u6848\u5373\u53ef\u3002",
        "postTime": 1647760024,
        "uid": 100250,
        "name": "minstdfx",
        "ccfLevel": 7,
        "title": "P8226 \u300cWdoi-5\u300d\u6a31\u70b9\u6536\u96c6 \u9898\u89e3"
    },
    {
        "content": "\u9898\u610f\uff1a\n\n\u4e00\u4e2a\u4eba\u5403\u8c46\u8c46\uff0c\u6cbf\u8def\u4e0a\u6709\u82e5\u5e72\u6bb5\u8c46\u8c46\uff0c\u8fd9\u4e2a\u4eba\u6328\u7740\u5403\uff0c\u5403 $k$ \u4e2a\u5c31\u4f1a\u7acb\u9a6c\u5410\u5149\u7ee7\u7eed\u5403\u3002\u67d0\u4e9b\u76f8\u90bb\u4e24\u6bb5\u4e4b\u95f4\u6709\u5783\u573e\u6876\uff0c\u8fd9\u4e2a\u4eba\u53ef\u4ee5\u9009\u62e9\u4e00\u6bb5\u4e0d\u5403\uff0c\u95ee\u6700\u591a\u5f80\u5783\u573e\u6876\u91cc\u5410\u51e0\u6b21\u3002\n\n\u5047\u8bbe\u6bcf\u4e00\u6bb5\u90fd\u6709\u8c46\u8c46\u3002\n\n\u9996\u5148\u8003\u8651\u4e0d\u80fd\u4e0d\u5403\u7684\u60c5\u51b5\uff1a\n\n\u5c06\u6bcf\u6bb5\u8c46\u8c46\u6570\u91cf\u505a\u524d\u7f00\u548c\uff0c\u7edf\u8ba1\u6709\u5783\u573e\u6876\u4e14\u524d\u7f00\u548c\u6a21 $k$ \u7b49\u4e8e0\u7684\u4f4d\u7f6e\u6570\u3002\n\n\u518d\u52a0\u4e0a\u53ef\u4ee5\u6709\u4e00\u6bb5\u4e0d\u5403\u7684\u60c5\u51b5\uff1a\n\n\u679a\u4e3e\u8df3\u8fc7\u7684\u4e00\u6bb5\uff0c\u5982\u679c\u540e\u9762\u67d0\u4e00\u4e2a\u4f4d\u7f6e\u7684\u524d\u7f00\u548c\u51cf\u53bb\u8fd9\u6bb5\u8c46\u8c46\u6570\u540e\u6a21 $k$ \u7684\u503c\u4e3a $0$\uff0c\n\u90a3\u4e48\u5b83\u6a21 $k$ \u5c31\u7b49\u4e8e\u8fd9\u6bb5\u8c46\u8c46\u6570\u6a21 $k$\u3002\u6240\u4ee5\u8fd9\u4e00\u6bb5\u540e\u9762\u7edf\u8ba1\u524d\u7f00\u548c\u6a21 $k$ \u7b49\u4e8e \u8fd9\u6bb5\u8c46\u8c46\u6570\u6a21 $k$ \u7684\u4f4d\u7f6e\u6570\uff0c\u8fd9\u4e00\u6bb5\u524d\u9762\u4ecd\u7136\u53ea\u7edf\u8ba1\u524d\u7f00\u548c\u6a21 $k$ \u7b49\u4e8e $0$ \u7684\u4f4d\u7f6e\u6570(\u5747\u6709\u5783\u573e\u6876)\uff0c\u4e8c\u8005\u76f8\u52a0\u5373\u53ef\u3002\n\n\u7531\u4e8e $k$ \u53ea\u6709 $10^6$\uff0c\u5f00\u4e24\u4e2a\u5927\u5c0f\u4e3a $10^6$ \u7684\u6570\u7ec4 $l$ \u548c $r$\uff0c$l[i]$ \u548c $r[i]$ \u5206\u522b\u5b58\u50a8**\u67d0\u4e00\u6bb5**\u524d\u9762\u548c\u540e\u9762\u6709\u5783\u573e\u6876\u4e14\u524d\u7f00\u548c\u6a21 $k$ \u4e3a $i$ \u7684\u4f4d\u7f6e\u6570\u3002\u5047\u5b9a\u8fd9\u6bb5\u521d\u59cb\u65f6\u4e3a $0$ \u6216 $n+1$\uff0c\u5219\u5148\u628a\u5168\u90e8\u6709\u5783\u573e\u6876\u4e14\u524d\u7f00\u548c\u6a21 $k$ \u4e3a $i$ \u7684\u4f4d\u7f6e\u6570\u50a8\u5b58\u5728 $r[i]$ \u6216 $l[i]$ \u4e2d\uff0c\u4ece\u524d\u5f80\u540e\u6216\u4ece\u540e\u5f80\u524d\u8fb9\u679a\u4e3e\u8df3\u8fc7\u7684\u4e00\u6bb5\uff0c\u8fb9\u66f4\u65b0 $l$ \u548c $r$ \u548c\u7b54\u6848\u5373\u53ef\u3002\n\n\u8ba1\u7b97\u65f6\u82e5\u67d0\u4e00\u6bb5\u65e0\u8c46\u8c46\uff0c\u5219\u8df3\u8fc7\uff0c\u4e0d\u7528\u5176\u524d\u7f00\u548c\u66f4\u65b0\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(n)$\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <iostream>\n#include <cstring>\n#include <cstdio>\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int N = 300010, M = 1000010;\nint n, m;\nLL a[N], s[N], res, K;\nint nl[M], nr[M];\nbool st[N];\n\nint main(){\n    scanf(\"%d%d%lld\", &n, &m, &K);\n    for(int i = 1; i <= m; i ++){\n        int t;\n        scanf(\"%d\", &t);\n        st[t] = true;\n    }\n\n    for(int i = 1; i <= n; i ++){\n        scanf(\"%lld\", &a[i]);\n        s[i] = a[i] + s[i - 1];\n        if(a[i] && st[i]) nl[s[i] % K] ++;\n    }\n\n    int res = nl[0];\n    for(int i = n; i >= 1; i --){\n        if(a[i] && st[i]) nl[s[i] % K] --;\n        res = max(res, nl[0] + nr[a[i] % K]);\n        if(a[i] && st[i]) nr[s[i] % K] ++;\n    }\n    printf(\"%d\\n\", res);\n    return 0;\n}\n```",
        "postTime": 1648026400,
        "uid": 318008,
        "name": "liqize15235204345",
        "ccfLevel": 0,
        "title": "P8226 \u300cWdoi-5\u300d\u6a31\u70b9\u6536\u96c6 \u9898\u89e3"
    },
    {
        "content": "### \u7b80\u5316\u9898\u610f\n\n\u7ed9\u5b9a\u4e24\u4e2a\u4e2a\u5e8f\u5217 $a_1 , a_2 ,\\cdots, a_n$ , $b_1 , b_2 ,\\cdots, b_m$ \u548c $k$\n\n\u53ef\u4ee5\u5220\u9664 $0$ \u6216 $1$ \u4e2a $a_i$ \u4f7f\u5f97 $(\\sum_{j=1}^{b_i}a_j)mod \\:k=0$ \u7684 $i$ \u6700\u591a\n\n### \u601d\u8def\n\u8003\u8651\u7ef4\u62a4\u4e00\u4e2a\u524d\u7f00\u548c\u6570\u7ec4 $sum$\n\n\u4e0d\u59a8\u8bbe\u5c06 $a_x$ \u5220\u9664\uff0c\u5bf9\u4e8e $sum_1$ \u5230 $sum_{x-1}$ \u90fd\u4e0d\u4f1a\u53d7\u5f71\u54cd\uff0c\u800c $sum_x$ \u5230 $sum_n$  \u90fd\u51cf\u5c11\u4e86 $a_x$\n\n\u6240\u4ee5\u6211\u4eec\u4e0d\u59a8\u679a\u4e3e\u5220\u9664\u6bcf\u4e00\u4e2a $a_i$ \u53bb\u7edf\u8ba1\u7b54\u6848\u7684\u53d8\u5316\n\n\u5f53\u6211\u4eec\u5220\u9664 $a_x$ \u65f6\uff0c\u7b54\u6848\u4e3a $\\sum_{i=1}^{x-1}[sum_i \\equiv 0\\:(mod\\:k)]+\\sum_{i=x}^nsum_i \\equiv a_x\\:(mod\\:k)$\n\n### AC code\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,m,k,ans;\nint b[300005],sum[300005],a[300005],t[300005];\nint main(){\n    scanf(\"%d%d%d\",&n,&m,&k);\n    for(int i=1;i<=m;i++){\n        int x;\n        scanf(\"%d\",&x);\n        b[x]=1;\n    }\n    for(int i=1;i<=n;i++){\n        scanf(\"%d\",&a[i]);\n        sum[i]=(sum[i-1]+a[i])%k;\n        if(b[i]) t[sum[i]]++;\n    }\n    int tmp=0;\n    for(int i=1;i<=n+1;i++){\n        if(b[i]) t[sum[i]]--;\n        ans=max(ans,tmp+t[a[i]%k]);\n        if(!sum[i]&&b[i]) tmp++;\n    }\n    printf(\"%d\",ans);\n    return 0;\n}\n```\n",
        "postTime": 1652103619,
        "uid": 100690,
        "name": "kawaii__yuyu",
        "ccfLevel": 0,
        "title": "P8226 [WDOI-5] \u6a31\u70b9\u6536\u96c6 \u9898\u89e3"
    },
    {
        "content": "### \u9898\u610f\u63cf\u8ff0\n- \u6709\u4e00\u4e2a\u6570\u5217 $a$ \u5171 $n$ \u4e2a\u6570\uff0c\u6bcf\u4e2a\u6570\u4e3a $a_i$\u3002\n- \u4e00\u5f00\u59cb $c=0$\uff0c\u4e4b\u540e\u6bcf\u6b21\u5c06 $c$ \u52a0\u4e0a $a_i$\uff0c\u5728\u5bf9 $k$ \u53d6\u6a21\u3002\u5982\u679c\u6b64\u65f6 $c$ \u53d8\u4e3a\u4e86 $0$\uff0c\u5219\u79f0\u5728 $i$ \u9636\u6bb5\u8fbe\u6210\u4e86\u8981\u6c42\u3002\n- \u6bcf\u4e00\u6b21\u5f00\u59cb\u65f6\uff0c\u90fd\u6709\u4e00\u6b21 bomb \u673a\u4f1a\uff0c\u53ef\u4ee5\u8df3\u8fc7\u4efb\u610f\u4e00\u4e2a $a_i$\u3002\n- \u8bf7\u95ee\u5728\u7ed9\u5b9a\u7684 $b$ \u6570\u5217\u4e2d\uff0c\u5bf9\u4e8e\u6240\u6709\u7684 $b_j$ \u9636\u6bb5\u6709\u51e0\u4e2a\u8fbe\u6210\u4e86\u8981\u6c42\uff1f\n### \u89e3\u9898\u601d\u8def\n$40$ \u5206\u505a\u6cd5\uff1a\u6a21\u62df\u3002\u904d\u5386\u6bcf\u4e00\u4e2a $a_i$\uff0c\u5c06 bomb \u7528\u5728\u8be5\u6570\u4e0a\uff08\u5f53\u7136\u4e5f\u53ef\u4ee5\u4e0d\u4f7f\u7528 bomb\uff09\u3002\u7136\u540e\u66b4\u529b\u904d\u5386\uff0c\u5982\u679c\u904d\u5386\u5230 $c=0$\uff0c\u5219\u5728 $b$ \u6570\u5217\u4e2d\u5bfb\u627e\u6709\u6ca1\u6709 $b_j=i$\uff0c\u5982\u679c\u6709 $ans$ \u5c31\u81ea\u589e $1$\uff0c\u6700\u540e\u8f93\u51fa $ans$\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2k)$\u3002\u4ee3\u7801\u4e0d\u63d0\u4f9b\u3002\n\n$70$ \u5206\u505a\u6cd5\uff1a\n\n\u65b9\u6cd5 $1$\uff1a\u5c06 $40$ \u5206\u505a\u6cd5\u4e2d\u7684\u67e5\u627e\u6539\u4e3a\u4e8c\u5206\u67e5\u627e\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u53d8\u4e3a $O(n^2\\log k)$\u3002\u4ee3\u7801\u89c1\u4e0b\u9762\u53c2\u8003\u4ee3\u7801\u7684\u7b2c\u4e00\u4e2a\u4ee3\u7801\uff08\u6211\u8003\u573a\u7684\u505a\u6cd5\uff09\u3002\n\n\u65b9\u6cd5 $2$: \u7531\u4e8e\u6240\u6709\u7684 $b_i$ \u90fd\u5728 $[1,n]$ \u8303\u56f4\u5185\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5f00\u4e00\u4e2a\u6570\u7ec4 $p$ \u8868\u793a\u8be5\u5904\u662f\u5426\u6709\u8981\u6c42\uff0c\u4e4b\u540e\u5c31\u4e0d\u7528\u67e5\u627e\u4e86\uff0c\u76f4\u63a5\u770b $p_{b_i}$ \u662f\u5426\u4e3a\u771f\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2)$\u3002\u4ee3\u7801\u4e0e\u6ee1\u5206\u4ee3\u7801\u6bd4\u8f83\u76f8\u4f3c\uff0c\u4e0d\u63d0\u4f9b\u3002\n\n\u6ee1\u5206\u505a\u6cd5\uff1a\u7531\u4e8e $n$ \u8fbe\u5230\u4e86 $3\\times10^5$\uff0c\u6240\u4ee5\u8003\u8651\u5982\u4f55\u5c06 $O(n^2)$ \u538b\u5230 $O(n)$\u3002\n\n\u89c2\u5bdf\u9898\u76ee\u53ef\u4ee5\u53d1\u73b0\uff1a\u5728 $i$ \u5904\u4f7f\u7528 bomb\uff0c\u53ea\u5f71\u54cd\u4e86 $i\\in [i,n]$ \u7684\u6240\u6709\u7684 $a_i$\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u7528\u4e00\u4e2a\u524d\u7f00\u548c $sum$\uff0c\u7528 $sum_i$ \u8868\u793a $a$ \u6570\u5217\u524d $i$ \u9879\u4e4b\u548c\u3002\u518d\u7528\u4e00\u4e2a\u6570\u7ec4 $num$\uff0c\u7528 $num_j$ \u8868\u793a\u6240\u6709\u7684\u6709\u9700\u6c42\u7684 $sum_i$ \u5bf9 $k$ \u53d6\u6a21\u540e\uff0c\u503c\u4e3a $j$ \u7684\u4e2a\u6570\u3002\u904d\u5386\u6bcf\u4e00\u4e2a $a_i$\uff0c\u5c06 bomb \u4f5c\u7528\u5728\u8be5\u6570\u4e0a\u3002\n\n\u5982\u679c\u8fd9\u662f\u4e00\u4e2a\u6709\u9700\u6c42\u7684\u6570\uff0c\u90a3\u4e48 $sum_i\\bmod k$ \u7684\u6570\u91cf\u5c31\u4f1a\u51cf\u5c11 $1$\u3002\n\n\u6211\u4eec\u7528 $now$ \u8868\u793a\u5728 bomb \u4e4b\u524d\u7684\u7b54\u6848\u8d21\u732e\u503c\u3002\u5728\u4f7f\u7528\u70b8\u5f39\u540e\uff0c\u5982\u679c\u6b64\u65f6\u5728 bomb \u4e4b\u524d\u7684\u7ed3\u679c\uff08\u5373 $now$\uff09\u52a0\u4e0a bomb \u4e4b\u540e\u7684\u7ed3\u679c\u5927\u4e8e\u7b54\u6848\uff0c\u90a3\u4e48\u5c31\u628a\u7b54\u6848\u66ff\u6362\u4e3a\u6b64\u65f6\u7684\u503c\u3002\n\n\u63a5\u4e0b\u6765\uff0c\u5982\u679c\u6b64\u65f6 $sum_i\\bmod k=0$ \u4e14\u8fd9\u4e2a\u4f4d\u7f6e\u662f\u6709\u9700\u6c42\u7684\uff0c\u90a3\u4e48\u4e0b\u6b21\u64cd\u4f5c\u5b83\u5c31\u53ef\u4ee5\u4e3a\u70b8\u5f39\u4e4b\u524d\u505a\u8d21\u732e\uff0c$now$ \u8981\u81ea\u589e $1$\u3002\n\n\u6700\u540e\u8f93\u51fa\u7b54\u6848\u5373\u53ef\u3002\n\n### \u53c2\u8003\u4ee3\u7801\n$70$ \u5206\u65b9\u6cd5 $1$\uff1a[\u8fd9\u91cc\u81ea\u53d6](https://www.luogu.com.cn/record/71889996) qwq\n\n\u6ee1\u5206\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define maxn 900010\nusing namespace std;\nlong long n,now,ans,m,k,b[maxn],a[maxn],sum[maxn],num[1000100];\nbool p[maxn];\nint main(){\n\tcin>>n>>m>>k;\n\tfor(int i=1;i<=m;i++){\n\t\tcin>>b[i];\n\t\tp[b[i]]=1;\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tcin>>a[i];\n\t\tsum[i]=sum[i-1]+a[i];\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tif(p[i])\n\t\t\tnum[sum[i]%k]++;\n\tans=num[0];\n\tfor(int i=1;i<=n;i++){\n\t\tif(p[i])num[sum[i]%k]--;\n\t\tif(now+num[a[i]%k]>ans)ans=now+num[a[i]%k];\n\t\tif(sum[i]%k==0&&p[i])now++;\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1648819297,
        "uid": 525374,
        "name": "sgl654321",
        "ccfLevel": 0,
        "title": "P8226 \u9898\u89e3"
    },
    {
        "content": "\u8981\u662f\u8d5b\u65f6\u5bf9 `pb_ds` \u6709\u638c\u63e1\u5c31 $200$ \u5206\u4e86\uff01\n\n\u63d0\u4f9b\u4e00\u4e2a\u5e73\u8861\u6811\u5199\u6cd5\uff0c\u867d\u7136\u5e73\u8861\u6811\u6211\u5e76\u4e0d\u4f1a\u5199\uff0c\u4f46\u662f `pbds` \u5185\u7f6e\u6709\u5e73\u8861\u6811\u554a\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u7528\u5185\u7f6e\u7684\u5e73\u8861\u6811\u5199\uff0c\u6ce8\u610f\u8981\u7528 `rb_tree_tag` \u800c\u975e `splay_tree_tag`\uff0c\u5185\u7f6e\u7684 Splay \u5f88\u6162\uff0c\u5f00\u4e86 O2 \u8fd8\u662f\u8d85\u65f6\uff0c\u800c\u5185\u7f6e\u7ea2\u9ed1\u6811\u4e0d\u5f00 O2 \u90fd\u80fd\u8fc7\u3002\n\n\u8bf4\u4e86\u7528\u5e73\u8861\u6811\uff0c\u4f46\u662f\u5177\u4f53\u4ec0\u4e48\u610f\u601d\u5462\uff1f\u6211\u4eec\u8003\u8651\u8bb0\u5f55\u524d\u7f00\u548c\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $sum_i$ \u6211\u4eec\u8bb0\u5f55 $sum_i$ \u6a21 $k$ \u7684\u4f59\u6570\u51fa\u73b0\u5728\u54ea\u4e9b\u4f4d\u7f6e\uff0c\u90a3\u4e48\u663e\u7136\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5730\u65b9 $i$ \u653e\u70b8\u5f39\u4ed6\u7684\u7b54\u6848\u5176\u5b9e\u5c31\u662f\uff1a $\\sum_{j=1}^{i-1} \\begin{cases} 1 & sum_j \\equiv 0 \\pmod k  \\\\ 0 & \\text{otherwise}\\end{cases} + \\sum_{j=i+1}^n \\begin{cases} 1 & sum_j \\equiv a_i \\pmod k \\\\ 0 & \\text{otherwise} \\end{cases}$\u3002\n\n\u663e\u7136\u8fd9\u4e24\u4e2a\u4e1c\u897f\u53ef\u4ee5\u5e73\u8861\u6811\u8ba1\u7b97\uff0c\u603b\u590d\u6742\u5ea6 $O(n \\log n)$\uff0c\u4e8b\u5b9e\u4e0a\u4f60\u4f1a\u53d1\u73b0\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u503c\u57df\u7ebf\u6bb5\u6811\uff0c\u5e38\u6570\u66f4\u5c0f\uff0c\u4e0d\u8fc7\u8fd9\u6837\u4e5f\u80fd\u8fc7\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#include <bits/extc++.h>\nusing namespace std;\nusing namespace __gnu_pbds; \n\n#define ll long long\n\nconstexpr int N(3e5 + 5);\n\ntree<ll, null_type, less<ll>, rb_tree_tag, tree_order_statistics_node_update> tr[N];\n\nint n, m;\nll k, ans = 0;\n\nll a[N], sum[N], b[N];\n\nint main()\n{\n\tscanf(\"%d%d%lld\", &n, &m, &k);\n\tfor (register int i(1); i <= m; ++i)\n\t{\n\t\tscanf(\"%lld\", &b[i]);\n\t}\n\tfor (register int i(1); i <= n; ++i)\n\t{\n\t\tscanf(\"%lld\", &a[i]);\n\t\tsum[i] = sum[i - 1] + a[i];\n\t}\n\tfor (register int i(1); i <= m; ++i)\n\t{\n\t\ttr[sum[b[i]] % k].insert(b[i]);\n\t}\n\tfor (register ll i(1); i <= n; ++i)\n\t{\n\t\tans = max(ans, (ll)(tr[0].order_of_key(i) - tr[0].order_of_key(1) + (tr[a[i] % k].order_of_key(n + 1) - tr[a[i] % k].order_of_key(i + 1))));\n\t}\n\tans = max(ans, (ll)(tr[0].order_of_key(n + 1) - tr[0].order_of_key(1)));\n\tprintf(\"%lld\\n\", ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1647852053,
        "uid": 332914,
        "name": "happybob",
        "ccfLevel": 6,
        "title": "P8226 \u300cWdoi-5\u300d\u6a31\u70b9\u6536\u96c6 \u9898\u89e3"
    },
    {
        "content": "## \u9898\u76ee\u5927\u610f\n\u7ed9\u5b9a\u5e8f\u5217 $\\{a_n\\}$\uff0c$\\{b_m\\}$ \u548c\u5e38\u6570 $k$\u3002\n\n\u53ef\u4ee5\u5220\u9664 $x(0\\le x\\le1)$ \u4e2a $a_i$\uff08\u4e3a $0$\uff09\uff0c\u4f7f\u5f97 $(\\sum\\limits_{i=1}^{b_i} a_i)\\bmod k=0$ \u7684 $b_i$ \u6700\u591a\u3002\n\n## \u601d\u8def\n\n\u5148\u6765\u8003\u8651\u66b4\u529b\uff1a\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u5220\u9664\u54ea\u4e00\u4e2a $a_i$ \u7136\u540e\u904d\u5386\u5e8f\u5217 $a$\uff0c\u524d\u7f00\u548c\u4f9d\u6b21\u6bcf\u4e00\u4e2a\u8ba1\u7b97 $(\\sum\\limits_{j=1}^{i} a_j)\\bmod k$\uff0c\u7edf\u8ba1\u6ee1\u8db3\u6761\u4ef6 $b_i$ \u6709\u51e0\u4e2a\u5c31\u884c\u4e86\u3002\n\n\u4e0a\u8ff0\u7a0b\u5e8f\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n^2)$\uff0c\u53ef\u4ee5\u901a\u8fc7 $\\frac{14}{20}=70\\%$ \u7684\u6570\u636e\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651\u4f18\u5316\u3002\n\n\u5176\u5b9e\u601d\u8003\u4e4b\u540e\u53ef\u4ee5\u53d1\u73b0\uff0c\u6211\u4eec\u8fc7\u591a\u7684\u628a\u65f6\u95f4\u6d6a\u8d39\u5728\u4e86\u5bf9\u4e8e\u5220\u9664\u6bcf\u4e00\u4e2a $a_i$ \u7684****\u524d\u7f00\u548c\u8ba1\u7b97\u4e0a****\u3002\u601d\u8003\u4e00\u4e0b\u5982\u679c\u6211\u4eec\u5220\u9664\u4e86 $a_i$\uff0c\u90a3\u4e48\u54ea\u4e9b\u70b9\u7684\u524d\u7f00\u548c\u4f1a\u53d7\u5230\u5f71\u54cd\u5462\uff1f\u662f\u7684\uff0c\u524d $i-1$ \u4e2a\u70b9\u5e76\u4e0d\u4f1a\u56e0\u6b64\u800c\u53d7\u5230\u5f71\u54cd\uff0c\u771f\u6b63\u53d7\u5230\u5f71\u54cd\u7684\u503c\u662f $a_i$ \u81f3 $a_n$\uff0c\u51c6\u786e\u6765\u8bf4\u662f\u6bcf\u4e00\u4e2a\u6ee1\u8db3 $(\\sum\\limits_{j=1}^{t} a_j)\\bmod k=0$ \u4e14 $t\\ge i$ \u7684 $a_t$ \u548c $(\\sum\\limits_{j=1}^{t} a_j)\\bmod k=a_i$ \u7684 $a_t$\u3002\n\n\u524d\u8005\u53d7\u5230\u5f71\u54cd\u7684\u539f\u56e0\u662f\u53bb\u6389\u4e86 $a_i$ \u4ed6\u4eec\u7684\u524d\u7f00\u53d7\u5f71\u54cd\u800c\u4e0d\u518d\u6ee1\u8db3\u6761\u4ef6\uff0c\u540e\u8005\u53d7\u5f71\u54cd\u662f\u56e0\u4e3a\u4ed6\u4eec\u7684\u524d\u7f00\u53d8\u6210\u4e86 $\\sum\\limits_{j=1}^{t} a_j-a_i=a_i$\uff0c$\\bmod k$ \u540e\u53d8\u4e3a $a_i-a_i=0$\uff0c\u4ece\u4e0d\u6ee1\u8db3\u6761\u4ef6\u53d8\u6210\u6ee1\u8db3\u6761\u4ef6\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u53bb\u6389 $a_i$ \u540e\u6ee1\u8db3\u6761\u4ef6\u7684 $b_t$ \u53d8\u6210\u4e86 $t<i$ \u6ee1\u8db3\u6761\u4ef6\u7684 $b_t$ \u6570\u91cf\u52a0\u4e0a $t\\ge i$ \u6ee1\u8db3 $(\\sum\\limits_{j=1}^{b_t} a_j)\\bmod k=a_i$ \u7684 $b_t$ \u6570\u91cf\u3002\n\n\u90a3\u4e48\u6211\u4eec\u8981\u600e\u4e48\u7edf\u8ba1\u4e0a\u8ff0\u4e24\u9879\u7684\u503c\u5462\uff1f\n\n\u9996\u5148\u5bf9\u4e8e\u7b2c\u4e00\u70b9\uff0c\u6211\u4eec\u4e0d\u59a8\u7528 $c_{i-1}$ \u6765\u8868\u793a $t<i$ \u6ee1\u8db3\u6761\u4ef6\u7684 $b_t$ \u6570\u91cf\u3002\u90a3\u4e48\u5f53 $(\\sum\\limits_{j=1}^{i} a_j)\\bmod k=0$ \u4e14 $i\\in \\{b_n\\}$ \u65f6\u6211\u4eec\u5c31\u5c06 $c_i\\gets c_{i-1}+1$\uff0c\u5426\u5219\u4fdd\u5b58 $c_{i-1}$ \u7684\u503c\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e8c\u70b9\uff0c\u6211\u4eec\u4e0d\u59a8\u53cd\u7740\u5faa\u73af $i$ \u4ece $n$ \u5230 $1$\uff0c\u770b\u89c1 $k\\le10^6$\uff0c\u90a3\u4e48\u4e0d\u5982\u4f7f\u7528\u6876\u8ba1\u6570 $t_x$ \u8868\u793a\u5728\u5faa\u73af\u5230 $i$ \u4e4b\u524d\u524d\u7f00\u4e3a $x$ \u7684 $b_t$ \u7684\u6570\u91cf\u3002\n\n\u63a5\u4e0b\u6765\u53d6\u6700\u5927\u503c\u5373\u53ef\u3002\n\n## Code:\n\n```cpp\n#include<bits/stdc++.h>\n#define pd push_back\n//#define int long long\n#define PII pair<int,int>\n#define _for(a,b,c) for(int a=b;a<=c;a++)\n#define _rep(a,b,c) for(int a=b;a>=c;a--)\nusing namespace std;\ntemplate <typename T> inline void read(T& x) {\n\tx=0; T f=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9') { if(ch=='-') f=-1; ch=getchar(); }\n\twhile(ch>='0'&&ch<='9') { x=(x<<1)+(x<<3)+(ch&15); ch=getchar(); }\n\tx=x*f;\n\treturn;\n}\ntemplate <typename T,typename ...Arg>void read(T& x,Arg& ...arg){\n\tread(x); read(arg...);\n}\nconst int N=1e6+5;\nint a[N],b[N],used[N],c[N],sum[N],tmp[N],n,m,k,ans;\nsigned main() {\n\tread(n,m,k);\n\t_for(i,1,m)\n\t\tread(b[i]),used[b[i]]=1;\n\t_for(i,1,n) {\n\t\tread(a[i]); a[i]%=k; sum[i]=(sum[i-1]+a[i])%k; c[i]=c[i-1];  if(used[i]&&sum[i]==0) ++c[i];\n\t}\n\tans=c[n];\n\t_rep(i,n,1) {\n\t\tans=max(ans,c[i-1]+tmp[a[i]]); if(used[i]) tmp[sum[i]]++;\n\t}\n\tprintf(\"%d\",ans);\n\treturn 1;\n}\n```",
        "postTime": 1647759205,
        "uid": 468657,
        "name": "lsj2009",
        "ccfLevel": 6,
        "title": "P8226"
    },
    {
        "content": "## P8226 \u300cWdoi-5\u300d\u6a31\u70b9\u6536\u96c6 \u9898\u89e3\n\n\u200b\t\t\u666e\u53ca\u6708\u8d5b\u7684\u7b2c\u4e8c\u9898\uff08\u786e\u5b9e\u5f88\u666e\u53ca\uff09\n\n[![R1xCpv.png](https://www.helloimg.com/images/2022/03/22/R1xCpv.png)](https://www.helloimg.com/image/R1xCpv)\n\n### \u9898\u610f\u5206\u6790\n\n\u200b\t\t\u7b80\u5355\u62bd\u8c61\u4e00\u4e0b\u9898\u610f\u5c31\u662f $n$ \u957f\u5ea6\u7684\u5e8f\u5217\uff0c\u82e5\u5728\u6070\u597d\u5728 $b_i$ \u7684\u4f4d\u7f6e\u524d\u7684 $a_i$ \u7684\u524d\u7f00\u548c\u4e3a $k$ \u7684\u500d\u6570\uff0c\u6ee1\u8db3\u7684\u6761\u4ef6\u6570\u5c31\u4f1a $+1$ \uff0c\u8fd8\u6709\u4e00\u79cd\u64cd\u4f5c $bomb$ \uff0c\u53ef\u4ee5\u5728\u5e8f\u5217\u4e2d\u53bb\u6389\u91ca\u653e $bomb$ \u4f4d\u7f6e\u7684 $a$ \uff0c\u6c42\u89e3\u5728\u53ef\u4ee5\u91ca\u653e\u4e00\u6b21 $bomb$ \u7684\u60c5\u51b5\u4e0b\uff08\u53ef\u4ee5\u4e0d\u91ca\u653e\uff09\u80fd\u6ee1\u8db3\u7684\u6700\u591a\u8981\u6c42\u6570\u3002\n\n\u200b\t\t\u5728 $bomb$ \u4e4b\u524d\u7684\u90e8\u5206\u90fd\u662f\u5f88\u597d\u89e3\u51b3\u7684\uff0c\u4f46\u6211\u4eec\u8981\u8003\u8651 $bomb$ \u64cd\u4f5c\u5230\u5e95\u610f\u5473\u7740\u4ec0\u4e48\n\n\u200b\t\t\u5148\u8003\u8651 $bomb$ \u5bf9 $j$ \u4e4b\u524d\u7684\u5f71\u54cd\uff08$j$ \u8bb0\u4e3a $bomb$ \u91ca\u653e\u7684\u4f4d\u7f6e\uff09\uff0c\u56e0\u4e3a\u6211\u4eec\u9700\u8981\u7684\u662f\u5e8f\u5217\u7684\u524d\u7f00\u548c\uff0c\u6240\u4ee5 $bomb$ \u5bf9 $j$ \u4e4b\u524d\u7684\u5e8f\u5217**\u6ca1\u6709\u5f71\u54cd**\uff0c**\u5bf9\u4e4b\u524d\u7684\u6ee1\u8db3\u8981\u6c42\u6570\u4e5f\u6ca1\u6709\u5f71\u54cd**\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5206\u522b\u8bb0\u5f55\u5728 $j$ \u4f4d\u7f6e\u4e4b\u524d\u7684\u8981\u6c42\u6ee1\u8db3\u6570\u5728\u4e4b\u540e\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\uff0c\u91ca\u653e $bomb$ \u65f6\u7684\u7b54\u6848\u53d8\u6210\u4e86\n$$\nans_j=j \u4e4b\u524d\u7684\u6ee1\u8db3\u8981\u6c42\u6570+bomb\u6240\u5f71\u54cd\u7684\u540e\u9762\u7684\u6ee1\u8db3\u8981\u6c42\u6570\n$$\n\u200b\t\t$j$ \u4e4b\u524d\u7684\u6ee1\u8db3\u8981\u6c42\u6570\u53ef\u4ee5\u5728\u8ba1\u7b97\u524d\u7f00\u548c\u7684\u8fc7\u7a0b\u4e2d\u8fb9\u6a21\u8fb9\u8bb0\n\n\u200b\t\t$bomb$ \u6240\u5f71\u54cd\u7684\u540e\u9762\u76f8\u5f53\u4e8e\u5728\u540e\u9762\u5168\u90e8\u524d\u7f00\u548c\u5171\u540c\u51cf\u53bb $a_j$ \uff0c\u6839\u636e\u6a21\u8fd0\u7b97\u7684\u6027\u8d28\uff0c**\u540e\u9762\u6ee1\u8db3\u8981\u6c42\u7684\u6570\u91cf\u76f8\u5f53\u4e8e\u539f\u672c\u524d\u7f00\u548c\u6a21 $k$ \u7b49\u4e8e $a_j$ \u7684\u6570\u91cf**\uff08$a_j-a_j=0$\uff09\uff0c\u6211\u4eec\u7528\u4e00\u4e2a\u6876\u6765\u5b58\u50a8\n\n### \u4ee3\u7801\u5b9e\u73b0\n\n\u200b\t\t\u8003\u573a\u4ee3\u7801\uff1a\n\n```cpp\n//\u524d\u7f00\u548c\u6c42\u4f59\n//bomb\u4e00\u5b9a\u4e0d\u4f1a\u5728Stage last\u4f7f\u7528\n//bomb\u5bf9\u524d\u540e\u7684\u5f71\u54cd\uff1a\n//bomb\u5bf9\u524d\u9762\u7684\u60c5\u51b5\u6ca1\u6709\u5f71\u54cd\n//\u524d\u9762\u4e0d\u540c\u4f4d\u7f6e\u7684\u8fbe\u6210\u8981\u6c42\u7684\u6570\u91cf\u53ef\u4ee5\u7d2f\u52a0\n//bomb\u5bf9\u540e\u9762\u7684\u5f71\u54cd\uff1a\n//\u6876\u7684\u601d\u60f3\u5411\u524d\u63a8\u5bfc\n//qwq\n//\u5148\u6c42\u4e00\u904d\u524d\u7f00\u548c\u6c42\u4f59\uff0c\u8bb0\u5f55\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\u53ca\u4e4b\u524d\u7684\u65e0\u5f71\u54cd\u6ee1\u8db3\u8981\u6c42\u7684\u72b6\u6001\n//\u4ece\u540e\u9762\u8fc7\u4e00\u904d\u6876\u518d\u76f8\u52a0\n\n#include<iostream>\nusing namespace std;\n\nint k,n,m,tot[1000005],a[300005],b[300005],s[300005],ans[300005],lastans;\n\nvoid read ()\n{\n\tint x;\n\tcin>>n>>m>>k;\n\tfor (int i=1;i<=m;i++)\n\t{\n\t\tcin>>x;\n\t\tb[x]++;\n\t}\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tcin>>a[i];\n\t\ts[i]=(s[i-1]+a[i])%k;\n\t\tif (b[i]&&!s[i])\n\t\t\tans[i]++;\n\t\tans[i]+=ans[i-1];\n\t}\n\treturn;\n}\n\nvoid tong ()\n{\n\tlastans=ans[n];\n\tfor (int i=n-1;i>=1;i--)\n\t{\n\t\ttot[s[i+1]]+=b[i+1];\n\t\tans[i-1]+=tot[a[i]%k];\n\t\tlastans=max(ans[i],lastans);\n\t}\n\tlastans=max(ans[0],lastans);\n\treturn;\n}\n\nvoid print ()\n{\n\tcout<<lastans;\n\treturn;\n}\n\nint main()\n{\n\tread();\n\ttong();\n\tprint();\n\treturn 0;\n}",
        "postTime": 1647948138,
        "uid": 513261,
        "name": "wanglingZ1Z",
        "ccfLevel": 5,
        "title": "P8226 \u300cWdoi-5\u300d\u6a31\u70b9\u6536\u96c6 \u9898\u89e3"
    },
    {
        "content": "\u96be\u5ea6\u9002\u4e2d\u7684\u601d\u7ef4\u9898\uff0c\u4f46\u6211\u89c9\u5f97\u653e\u5728PJT2\u504f\u96be\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/hwk6msvy.png)\n\n------------\n\n\u5148\u8bf4\u4e00\u4e2a\u867d\u7136\u663e\u7136\uff0c\u4f46\u5374\u662f\u89e3\u51fa\u672c\u9898\u6838\u5fc3\u7684\u4e00\u4e2a\u7ed3\u8bba\uff1a\u5982\u679c\u5728\u7b2c $i$ \u5173\u4f7f\u7528\u4e00\u4e2abomb\uff0c\u90a3\u8fd9\u4e2abomb\u4e0d\u4f1a\u5f71\u54cd $[1,i-1]$ \u8fd9\u4e00\u533a\u95f4\u5bf9\u7b54\u6848\u7684\u8d21\u732e\uff0c\u4ec5\u4ec5\u4f1a\u5f71\u54cd\u533a\u95f4 $[i,n]$ \u5bf9\u7b54\u6848\u7684\u8d21\u732e\u3002\u6bd5\u7adf\u5728\u4f7f\u7528\u70b8\u5f39\u4e4b\u524d\u7684\u5173\u5361\u4e2d\u6211\u4eec\u53ef\u4ee5\u5c55\u5f00\u6a31\u4e4b\u7ed3\u754c\u7684\u6b21\u6570\u662f\u6052\u5b9a\u7684\u3002\n\n\u6211\u4eec\u6765\u7b80\u5316\u95ee\u9898\uff0c\u5982\u679c\u628a $b$ \u6570\u7ec4\u7684\u9650\u5236\u53bb\u6389\uff0c\u8be5\u600e\u4e48\u505a\uff1f\n\n\u6211\u4eec\u9996\u5148\u7ef4\u62a4\u4e00\u4e2a\u524d\u7f00\u548c\u6570\u7ec4 $sum$\uff0c\u8868\u793a $a$ \u6570\u7ec4\u7684\u524d\u7f00\u548c\u3002\n\n\u5b9a\u4e49\u6570\u7ec4 $wt$ \uff08want\uff09\uff0c\u8868\u793a\u5bf9\u4e8e\u7b2c $i$ \u4e2a\u5173\u5361\uff0c\u5728\u5173\u5361\u672b\u6070\u597d\u5c55\u5f00\u6a31\u4e4b\u7ed3\u754c\uff08\u5728\u4e0b\u6587\u79f0\u4e4b\u4e3a\u201c\u5408\u6cd5\u201d\uff09\u8fd8\u9700\u53bb\u6389\u7684\u6700\u5c11\u7684\u6a31\u70b9\u6570\u3002\u53ef\u4ee5\u53d1\u73b0\u5728\u4e0d\u4f7f\u7528bomb\u7684\u60c5\u51b5\u4e0b\uff0c$wt_i=sum_i \\%k$\u3002\n\n\u4e3a\u4ec0\u4e48\u5462\uff1f\u56e0\u4e3a\u82e5\u60f3\u5728\u7b2c $i$ \u4e2a\u5173\u5361\u5408\u6cd5\uff0c\u6211\u4eec\u9700\u8981\u8ba9\u6211\u4eec\u76ee\u524d\u6240\u7d2f\u79ef\u7684\u6a31\u70b9\u6570\u91cf\u4e4b\u548c\u4e3a $k$ \u7684\u500d\u6570\u3002\u5982\u679c\u76ee\u524d\u6a31\u70b9\u6570\u4e4b\u548c\u5e76\u4e0d\u662f $k$ \u7684\u500d\u6570\uff0c\u90a3\u4e48\u552f\u4e00\u53ef\u80fd\u4f7f\u8fd9\u4e2a\u70b9\u5408\u6cd5\u7684\u529e\u6cd5\uff0c\u5c31\u662f\u5728\u5b83\u8fd9\u4e2a\u5173\u5361\u4e4b\u524d\u4f7f\u7528bomb\uff0c\u4f7f\u5f97\u70b8\u6389\u8fd9\u4e2a\u5173\u5361 $i$ \u6ee1\u8db3 $a_i\\%k=wt_i$\uff0c\u8fd9\u6837\u5c31\u80fd\u4f7f\u8be5\u5173\u5361\u4e0e\u5176\u4ed6\u5728 $i$ \u5173\u5361\u4e4b\u540e\uff08 $j>i$ \uff09\uff0c\u540c\u6837\u6ee1\u8db3 $a_j\\%k=wt_j$ \u7684 $j$ \u5173\u5361\u5408\u6cd5\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u679c\u6211\u4eec\u5728\u7b2c $i$ \u5173\u5361\u4f7f\u7528bomb\uff0c\u6839\u636e\u6587\u7ae0\u5f00\u5934\u7684\u7ed3\u8bba\uff0c\u5728 $[i,n]$ \u533a\u95f4\u4e2d\u539f\u5148\u5408\u6cd5\u7684\u5173\u5361\u5c31\u4f1a\u53d8\u5f97\u4e0d\u5408\u6cd5\u3002\u8bbe\u8fdb\u884c\u201cbomb\u201d\u64cd\u4f5c\u4e4b\u540e\u5bf9\u7b54\u6848\u7684\u53d8\u5316\u4e3a $\\Delta ans$\uff0c\u90a3\u4e48 $\\Delta ans$ \u7684\u503c\u5c31\u662f\u6211\u4eec\u73b0\u5728\u8fdb\u884c\u64cd\u4f5c\u540e\u53d8\u6210\u5408\u6cd5\u7684\u5173\u5361\u6570\u91cf\u4e4b\u548c\u51cf\u53bb\u5728\u6240\u88ab\u5f71\u54cd\u5230\u533a\u95f4\u5185\u539f\u5148\u5408\u6cd5\u7684\u5173\u5361\u6570\u4e4b\u548c\u3002\u5982\u679c\u6211\u4eec\u53ef\u4ee5\u7528 $O(1)$ \u7684\u590d\u6742\u5ea6\u7b97\u51fa $\\Delta ans$ \uff0c\u518d\u5957\u4e0a\u590d\u6742\u5ea6\u4e3a $O(n)$ \u7684\u679a\u4e3e\u8fdb\u884c\u201cbomb\u201d\u64cd\u4f5c\u7684\u70b9\uff0c\u7b97\u51fa\u6700\u5927\u7684 $\\Delta ans$\uff0c\u90a3\u8fd9\u9898\u5c31\u53ef\u4ee5\u88ab\u6211\u4eec\u6109\u5feb\u7684A\u6389\u4e86\u3002\u8bbe\u4e0d\u4f7f\u7528\u70b8\u5f39\u65f6\u7b54\u6848\u4e3a $ans$ \uff0c\u5219\u6700\u7ec8\u7b54\u6848\u5373\u4e3a $ans+\\Delta ans$\u3002\n\n\u770b\u5230 $k\\le10^6$\uff0c\u8003\u8651\u5f00\u6876\u3002\u7528\u6876\u6765\u8bb0\u5f55 $i\u2208[1,n]$ \u533a\u95f4\u4e2d\u7684 $wt$ \u6570\u7ec4\u4e2d\u6570\u5b57\u7684\u51fa\u73b0\u6b21\u6570\u3002\u8bbe\u6876\u540d\u4e3a $bu$\uff0c$A$ \u533a\u95f4\u4e3a\u76ee\u524d\u6876\u5185\u5143\u7d20\u6240\u5305\u542b\u7684\u533a\u95f4\u3002\u90a3\u4e48 $bu_0$ \u5c31\u6307 $A$ \u533a\u95f4\u4e2d\u539f\u5148\u5408\u6cd5\u7684\u5173\u5361\u6570\u91cf\uff0c\u90a3\u4e48\u5bf9\u4e8e\u5173\u5361 $i$\uff0c$bu_{a_i\\%k}$ \u5c31\u662f\u5bf9 $i$ \u5173\u5361\u4f7f\u7528\u70b8\u5f39\u540e\u6240\u80fd\u589e\u591a\u7684\u5408\u6cd5\u5173\u5361\u6570\u91cf\u3002\u6211\u4eec\u5728\u679a\u4e3e $i$ \u7684\u540c\u65f6\u53ef\u4ee5\u5c06\u6876\u91cc\u7684\u5143\u7d20\u6254\u51fa\u53bb\uff0c\u4ee5\u4fdd\u8bc1 $A$ \u533a\u95f4\u59cb\u7ec8\u662f\u6240\u80fd\u8d21\u732e\u7b54\u6848\u7684\u533a\u95f4\u3002\u70b8\u6389\u8fd9\u4e00\u4e2a\u5173\u5361\u6240\u5f97\u5230\u7684 $\\Delta ans=bu_{a_i\\%k}-bu_0$\u3002\n\n\u9700\u8981\u6ce8\u610f\uff0c\u5f53 $wt_i\\neq0$ \u65f6\uff0c$A$ \u533a\u95f4\u662f $[i+1,n]$\uff0c\u5426\u5219\u4fbf\u4e3a $[i,n]$\u3002\u5728 $wt_i\\neq0$ \u7684\u60c5\u51b5\u4e2d\uff0c\u70b8\u6389 $i$ \u5173\u5361\u540e\uff0c\u82e5\u6309\u7167 $A=[i,n]$ \u8ba1\u7b97\uff0c\u6b64\u65f6 $i$ \u5173\u5361\u5df2\u7ecf\u6ca1\u6709\u6a31\u82b1\uff0c\u800c\u8c03\u7528 $bu_{a_i\\%k}$ \u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u70b9\u5c31\u4f1a\u88ab\u5f53\u505a\u6709\u6a31\u82b1\u88ab\u8ba1\u7b97\u4e00\u6b21\uff0c\u5bfc\u81f4\u559c\u63d0\u9519\u8bef\u7ed3\u679c\u3002\u53cd\u4e4b\u4ea6\u7136\u3002\n\n\u5f15\u5165 $b$ \u6570\u7ec4\u540e\u8fd9\u9053\u9898\u8fd8\u662f\u53ef\u4ee5\u8fd9\u6837\u505a\uff0c\u53ea\u4e0d\u8fc7 $A$ \u5185\u7684\u5143\u7d20\u6709\u6240\u53d8\u5316\uff0c\u53d8\u6210\u4e86\u4e00\u4e2a\u5143\u7d20\u5747\u6765\u81ea $b$ \u6570\u7ec4\u7684\u96c6\u5408\u3002\n\n### Code Time\uff01\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nint read()\n{\n    int x=0,fh=1;\n    char ch=getchar();\n    while(!isdigit(ch))\n\t{\n        if(ch=='-') fh=-1;\n        ch=getchar();\n    }\n    while(isdigit(ch))\n\t{\n        x=(x<<1)+(x<<3)+ch-'0';\n        ch=getchar();\n    }\n    return x*fh;\n}\nconst int MAXN=3e5+5,MAXB=1e6+5;\nint n,m,k,a[MAXN],b[MAXN],sum[MAXN],ans,wt[MAXN],bu[MAXB];\nsigned main()\n{\n\tcin>>n>>m>>k;\n\tfor(int i=1;i<=m;i++)b[i]=read();\n\tfor(int i=1;i<=n;i++)a[i]=read(),sum[i]=sum[i-1]+a[i];\n\tfor(int j=1;j<=m;j++)\n\t{\n\t\tint i=b[j];\n\t\twt[i]=sum[i]%k;\n\t\tbu[wt[i]]++;\n\t}\n\tfor(int i=1;i<=m;i++)if(sum[b[i]]%k==0)ans++;\n\tint j=1,maxn=0;//\u8fd9\u91cc\u7684maxn\u5c31\u662f\u6587\u4e2d\u6700\u5927\u7684delta_ans\u3002\u521d\u59cb\u503c\u4e3a0\uff0c\u56e0\u4e3a\u5982\u679cdelta_ans\u4e3a\u8d1f\uff0c\u90a3\u8fd8\u4e0d\u5982\u4e0d\u4f7f\u7528bomb\u3002 \n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(i==b[j]&&wt[i])bu[wt[i]]--,j++;\n\t\tmaxn=max(maxn,bu[a[i]%k]-bu[0]);\n\t\tif(i==b[j]&&!wt[i])bu[wt[i]]--,j++;\n\t}\n\tcout<<ans+maxn;\n\treturn 0;\n}\n```",
        "postTime": 1647758256,
        "uid": 19228,
        "name": "\u849f\u84bb\u7092\u6247\u8d1d",
        "ccfLevel": 6,
        "title": "\u300cWdoi-5\u300d\u6a31\u70b9\u6536\u96c6 solution"
    },
    {
        "content": "\u672c\u6587\u540c\u6b65\u66f4\u65b0\u4e8e[\u535a\u5ba2\u56ed](https://www.cnblogs.com/Gingerhe/p/16029769.html)\n# \u524d\u8a00\n\u622a\u6b62\u5230 $3.21$\uff0c\u6700\u4f18\u89e3 $rank1$\u3002\n# \u9898\u89e3\n\u5148\u6c42\u51fa $a_i$ \u5728\u6a21 $k$ \u610f\u4e49\u4e0b\u7684\u524d\u7f00\u548c\uff0c\u8bb0\u4e3a $s_i$\uff0c\u987a\u4fbf\u7528\u6876\u8bb0\u5f55\u4e0b\u6bcf\u79cd\u4f59\u6570\u51fa\u73b0\u7684\u6b21\u6570\u3002  \n\u63a5\u4e0b\u6765\u6211\u4eec $O(n)$ \u679a\u4e3e\u5bf9\u6bcf\u4e2a\u5173\u5361\u4f7f\u7528 bomb \u7684\u7b54\u6848\uff0c\u5047\u8bbe\u679a\u4e3e\u5230\u7b2c $x$ \u5173\u3002\u4e0d\u96be\u53d1\u73b0\uff0c\u6211\u4eec\u4e0d\u9009 $a_x$ \u5bf9 $s_1,s_2,\\cdots,s_{x-1}$\uff0c\u6ca1\u6709\u5f71\u54cd\uff0c\u4ec5\u4ec5\u4f1a\u8ba9 $s_{x+1},s_{x+2},\\cdots s_n$ \u90fd\u51cf\u6389 $a_x$\u3002\u6240\u4ee5\u5bf9\u4e8e\u6bcf\u4e2a $x$\uff0c\u7b54\u6848\u4e3a $\\sum\\limits_{i=1}^x[s_i\\equiv0(\\mathrm{mod}\\;k)]+\\sum\\limits_{i=x+1}^n[s_i\\equiv a_x(\\mathrm{mod}\\;k)]$\uff0c\u7528\u521a\u624d\u7684\u6876\u8fdb\u884c\u8ba1\u7b97\u5373\u53ef\u3002\n## \u6ce8\u610f\n- \u5faa\u73af\u5230 $n+1$ \u662f\u56e0\u4e3a\u8981\u8ba1\u7b97\u4e0d\u4f7f\u7528 bomb \u65f6\u7684\u7b54\u6848\u3002\n- \u8bb0\u5f97\u6bcf\u6b21\u66f4\u65b0\u6876\u3002\n\n## Code\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=1e6+5;\nconst int maxx=3e5+5;\ninline int read()\n{\n    int x=0,f=1;\n    char ch=getchar();\n    while(ch<'0'||ch>'9')\n\t{\n        if(ch=='-')\n            f=-1;\n        ch=getchar();\n    }\n    while(ch>='0'&&ch<='9')\n\t{\n        x=(x<<1)+(x<<3)+(ch^48);\n        ch=getchar();\n    }\n    return x*f;\n}//\u5feb\u8bfb\nint n,m,k,a[maxx],t[maxn],tmp,res,ans;\nbool vis[maxx];\nint main()\n{\n\tn=read(),m=read(),k=read();\n\tfor(int i=1;i<=m;i++)\n\t\tvis[read()]=1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\ta[i]=(a[i-1]+read())%k;//\u8bb0\u5f97\u53d6\u6a21\n\t\tif(vis[i])\n\t\t\tt[a[i]]++;//\u7528\u6876\u8bb0\u5f55\u6a21k\u7684\u4f59\u6570\n\t}\n\tfor(int i=1;i<=n+1;i++)\n\t{\n\t\ttmp=(a[i]-a[i-1]+k)%k;//\u8ba1\u7b97\u539f\u6765\u7684a[i],\u4f46\u6709\u53ef\u80fd\u4e3a\u8d1f\u6570\uff0c\u56e0\u6b64\u52a0\u4e0ak\u518d\u53d6\u6a21\n\t\tif(vis[i])\n\t\t\tt[a[i]]--;//\u8bb0\u5f97\u8981\u51cf\u6389\n\t\tans=max(ans,res+t[tmp]);\n\t\tif(vis[i]&&!a[i])\n\t\t\tres++;\n\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1647751506,
        "uid": 379058,
        "name": "Ginger_he",
        "ccfLevel": 0,
        "title": "\u6d1b\u8c37P8226\u9898\u89e3"
    },
    {
        "content": "# \u5206\u6790\n\n\u4e0d\u4f7f\u7528 bomb \u7684\u60c5\u51b5\u662f\u7528\u524d\u7f00\u548c\uff0c\u518d\u4e0e $k$ \u53d6\u6a21\uff0c\u82e5\u662f 0 \u4e14\u53c8\u5728\u7edf\u8ba1\u5e8f\u5217\u4e2d\uff0c\u5c31\u6c42\u5b83\u4eec\u7684\u4e2a\u6570\u3002\n\n\u4f7f\u7528 bomb \u7684\u60c5\u51b5\u662f\u7528\u524d\u7f00\u548c\u51cf\u53bb\u8df3\u8fc7\u7684\u5173\u5361\u6240\u83b7\u5f97\u7684\u6a31\u70b9\u4e2a\u6570\uff0c\u518d\u4e0e $k$ \u53d6\u6a21\uff0c\u82e5\u662f 0 \u4e14\u53c8\u5728\u7edf\u8ba1\u5e8f\u5217\u4e2d\uff0c\u5c31\u6c42\u5b83\u4eec\u7684\u4e2a\u6570\uff0c\u5219\u82e5\u4f7f\u7528 bomb\uff0c\u53ea\u6709\u524d\u7f00\u548c\u4e0e $k$ \u53d6\u6a21\u7684\u503c\u662f\u8df3\u8fc7\u7684\u5173\u5361\u6240\u83b7\u5f97\u7684\u6a31\u70b9\u4e2a\u6570\u4e14\u53c8\u5728\u7edf\u8ba1\u5e8f\u5217\u4e2d\uff0c\u8fd9\u4e2a\u5173\u5361\u5c31\u662f\u4e00\u4e2a\u5408\u6cd5\u89e3\u3002\n\n# \u601d\u8def\n\n\u5148\u8ba1\u7b97 $ai$ \u6570\u7ec4\u7684\u524d\u7f00\u548c $sum$ \u6570\u7ec4\uff0c\u8bb0\u5f97\u9700\u8981\u4e0e $k$ \u53d6\u6a21\u3002\n\n\u518d\u5728\u6240\u6709\u7684\u8981\u6c42\u4e2d\u6c42 $sum[i]$ \u7684\u4e2a\u6570\u3002\n\n\u679a\u4e3e\u6240\u6709\u7684 bomb \u5730\u70b9\uff0c\u4e0e\u4ee5\u524d\u7684\u6700\u4f18\u7b54\u6848\u53d6\u6700\u5927\u503c\u3002\n\n\u5f53\u7b2c $i$ \u4e2a\u70b9\u4f5c\u4e3a bomb \u5730\u70b9\u7684\u5408\u6cd5\u5173\u5361\u4e2a\u6570\u4e3a $sum$ \u6570\u7ec4\u4e2d\u503c\u4e3a $ai[i]$ \u603b\u5171\u4e2a\u6570\uff0c\u51cf\u53bb $1\\sim i-1$ \u4e2d $sum$ \u6570\u7ec4\u4e2d\u503c\u4e3a $ai[i]$ \u603b\u5171\u4e2a\u6570\uff0c\u52a0\u4e0a $1\\sim i-1$ \u4e2d $sum$ \u6570\u7ec4\u4e2d\u503c\u4e3a 0 \u603b\u5171\u4e2a\u6570\u3002\n\n# Code\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint read(){\n\tint x=0,f=1;char c=getchar();\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\n\treturn x*f;\n}\nconst int N=3*1e5+10,K=1e6+10;\nint n,m,k;\nint b[N];\nint ai[N],sum[N],a[K],tong[K];\nint ans,t;\nsigned main(){\n\tn=read(),m=read(),k=read();\n\tfor(int i=1;i<=m;i++)\n\t\tb[read()]=true;\n\tfor(int i=1;i<=n;i++){\n\t\tai[i]=read()%k;\n\t\tsum[i]=(sum[i-1]+ai[i])%k;\n\t\tif(b[i])\n\t\t\ta[sum[i]]++;\n\t}\n\tans=a[0];\n\tfor(int i=1;i<=n;i++){\n\t\tif(b[i])\n\t\t\ttong[sum[i]]++;\n\t\tif(a[ai[i]]-tong[ai[i]]+t>ans)\n\t\t    ans=a[ai[i]]-tong[ai[i]]+t;\n\t\tif(b[i]&&sum[i]==0)\n\t\t\tt++;\n\t}\n\tcout<<ans;\n\treturn 0;\n}\n\n```\n",
        "postTime": 1648096669,
        "uid": 501923,
        "name": "duchengjun",
        "ccfLevel": 5,
        "title": "P8226\u9898\u89e3"
    },
    {
        "content": "\u8fd9\u9898\u8d28\u91cf\u5f88\u9ad8\u3002\u8ba4\u8bc6\u7684\u4eba\u90fd\u7528 $O(n)$ \u8fc7\u4e86\u5c31\u6211\u4e00\u4e2a\u662f $O(n \\log m)$ \u7684\u2026\u2026\n\n\u63d0\u4f9b\u4e00\u79cd\u7c7b\u4f3c\u4e8e\u83ab\u961f\u7684\u4ece\u66b4\u529b\u4f18\u5316\u7684\u601d\u8def\uff0c\u4e2a\u4eba\u611f\u89c9\u6bd4\u8f83\u597d\u60f3\u3002\n\n---\n\n### Step 1\n\n\u9996\u5148\u8003\u8651\u9898\u76ee\u7684\u9000\u5316\u7248\u672c\uff1a\u5982\u679c\u6ca1\u6709 bomb \u64cd\u4f5c\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u7edf\u8ba1\u4e00\u4e2a\u524d\u7f00\u548c $s_i=s_{i-1}+a_i$\uff0c\u5982\u679c\u5230\u4e86\u67d0\u4e00\u4e2a\u70b9 $x$\uff0c$s_x \\mod k=0$\uff0c\u90a3\u4e48\u8fd9\u4e00\u4e2a\u70b9\u5c31\u53ef\u4ee5\u5c55\u5f00\u6a31\u4e4b\u7ed3\u754c\u3002\u539f\u56e0\u5f88\u663e\u7136\uff1a\u4f46\u51e1\u6a31\u70b9\u4e2a\u6570\u5230\u8fbe\u4e86 $k$ \u5c31\u4f1a\u5f52\u96f6\uff0c\u6240\u4ee5 $s_x$ \u548c $s_x \\mod k$ \u610f\u4e49\u662f\u4e00\u6837\u7684\u3002\n\n\u5f53\u52a0\u4e0a\u4e86 bomb \u64cd\u4f5c\uff0c\u6211\u4eec\u5148\u8003\u8651\u66b4\u529b\uff1a\u5bf9\u4e8e\u9898\u76ee\u8981\u6c42\u7684 $b$ \u4e2d\u7684\u6bcf\u4e00\u4e2a $b_i$\uff0c\u4ee4 $d_{b_i}\\gets s_{b_i} \\mod k$\u3002\u6211\u4eec\u7528 $p_x$ \u8868\u793a\u8d70\u5230\u70b9 $x$ \u65f6\uff0c**\u6ca1\u6709\u4efb\u4f55** bomb \u64cd\u4f5c\u6240\u80fd\u5c55\u5f00\u6a31\u4e4b\u7ed3\u754c\u7684\u6b21\u6570\u3002\u5bb9\u6613\u53d1\u73b0\u5728 $i$ \u8fdb\u884c bomb \u64cd\u4f5c\u65f6\uff0c\u5c55\u5f00\u6a31\u4e4b\u7ed3\u754c\u6b21\u6570\u5c31\u662f $p_{i-1}+q$\uff0c$q$ \u8868\u793a $[i+1,n]$ \u80fd\u5c55\u5f00\u6a31\u4e4b\u7ed3\u754c\u7684\u70b9\u6570\u3002\u8fd9\u4e2a $q$ \u8981\u600e\u4e48\u6c42\u5462\uff1f\u8bbe\u4e00\u4e2a\u70b9 $y\\in[i+1,n]$\uff0c$y$ \u7684\u6a31\u70b9\u5c31\u4f1a\u51cf\u53bb $a_i$\uff0c**\u539f\u6765 $\\mod k=a_i$ \u7684\u70b9\u73b0\u5728\u5c31\u53d8\u6210 $\\mod k=0$ \u4e86**\u3002\u6211\u4eec\u627e\u5230 $b$ \u4e2d**\u7b2c\u4e00\u4e2a\u5927\u4e8e** $i$ \u7684\u6570\uff0c\u8bbe\u4e3a $b_{pos}$\uff0c\u7136\u540e\u4ece $pos$ \u5230 $m$ \u679a\u4e3e\uff0c\u627e\u5230 $d_{b_j} \\mod k=a_i $ \u7684 $b_j$ \u4e2a\u6570\u3002$b_{pos}$ \u53ef\u4ee5\u901a\u8fc7\u4e8c\u5206\u67e5\u627e\u5f97\u5230\uff0c\u7136\u540e\u5bfb\u627e $b_j$ \u53ef\u4ee5\u901a\u8fc7 $O(m)$ \u7684\u5faa\u73af\u5f97\u5230\u3002\u590d\u6742\u5ea6\u662f $O(nm\\log m)$\uff0c\u5176\u5b9e $O(nm)$ \u66f4\u5bb9\u6613\u5199\uff0c~~\u53ea\u4e0d\u8fc7\u4e3a\u4e86\u5f15\u51fa\u4e0b\u6587\u624d\u5f3a\u884c\u52a0\u4e86\u4e2a $\\log$~~\u3002\n\n\u66b4\u529b[\u4ee3\u7801](https://www.luogu.com.cn/paste/i2xwwqot)\u53ef\u4ee5\u81ea\u53d6\uff0cAC \u4ee3\u7801\u662f\u5728\u66b4\u529b\u4ee3\u7801\u57fa\u7840\u4e0a\u7565\u5fae\u4fee\u6539\u5f97\u5230\u7684\u3002\n\n---\n\n### Step 2\n\n\u66b4\u529b\u4ee3\u7801\u6162\u5728\u54ea\u91cc\uff1f\u539f\u56e0\u5c31\u5728\u4e8e $O(m)$ \u7684\u67e5\u627e\u3002\u6211\u4eec\u5206\u6790\u4e00\u4e0b\u8fd9\u4e2a\u67e5\u627e\u7684\u672c\u8d28\u662f\u4ec0\u4e48\uff1a\u4ece $pos$\uff08\u5373\u4e3a\u4e0a\u8ff0 $b$ \u4e2d\u7b2c\u4e00\u4e2a\u5927\u4e8e $i$ \u7684\u70b9\uff09\u5230 $n$\uff0c\u5bfb\u627e $d_{b_j}$ \u6a21 $k$ \u7b49\u4e8e $a_i$ \u7684 $j$\uff0c\u4e5f\u5c31\u662f**\u5bfb\u627e\u533a\u95f4\u67d0\u4e2a\u6570\u51fa\u73b0\u7684\u6b21\u6570**\u3002\u6709\u6ca1\u6709\u4e00\u79cd\u719f\u6089\u7684\u611f\u89c9\uff0c\u8fd9\u4e0d\u5c31\u662f**\u83ab\u961f**\u5417\uff01\u53ea\u4e0d\u8fc7\u533a\u95f4\u53f3\u7aef\u70b9\u662f\u6052\u4e3a $n$ \u7684\u3002\u90a3\u8fd9\u4e2a\u83ab\u961f\u5c31\u7b80\u5355\u5f88\u591a\u4e86\uff0c\u590d\u6742\u5ea6\u4e5f\u53ea\u662f $O(n)$ \u7684\u3002\u4f60\u53ea\u9700\u8981\u4e00\u4e2a\u6570\u7ec4\uff0c\u5148\u9884\u5904\u7406\u51fa $i \\in [1,m]$ \u4e2d\u6bcf\u4e00\u4e2a $d_{b_{i}}$ \u51fa\u73b0\u6b21\u6570\u3002\u7136\u540e\u6bcf\u6b21\u83ab\u961f\u66b4\u529b\u8f6c\u79fb\u3002\u5148\u4e8c\u5206\u67e5\u627e $pos$\uff0c\u4ece\u4e0a\u4e00\u6b21\u7684\u70b9\u8f6c\u79fb\u5230 $pos$\uff0c\u628a\u626b\u8fc7\u7684\u70b9\u7684 $d$ \u503c\u51fa\u73b0\u6b21\u6570\u5168\u90e8\u51cf $1$\uff0c\u5c31\u5f97\u5230\u4e86\u4f60\u8981\u627e\u7684\u7b54\u6848\u4e86\u3002\u590d\u6742\u5ea6\u662f $O(n \\log m)$ \u7684\uff0c\u74f6\u9888\u5728\u4e8c\u5206\u3002\u5176\u5b9e\u4e8c\u5206\u662f\u53ef\u4ee5\u4f18\u5316\uff08\u9884\u5904\u7406\uff09\u6389\u7684\uff0c\u5c31\u7559\u7ed9\u8bfb\u8005\u81ea\u884c\u601d\u8003\u4e86\u3002\n\n\u53e6\u5916\uff0c\u4e3a\u4ec0\u4e48\u8981\u4ece $1$ \u679a\u4e3e\u5230 $n+1$ \u5462\uff1f\u56e0\u4e3a\u4f60\u53ef\u4ee5\u4e0d\u8fdb\u884c bomb \u64cd\u4f5c\u554a\uff01\u5230\u4e86 $n+1$\uff0c$p_n$ \u6070\u597d\u5c31\u4ee3\u8868\u4e86\u4e0d\u8fdb\u884c\u64cd\u4f5c\u6240\u80fd\u5f97\u5230\u7684\u7b54\u6848\u3002\n\n### Code\uff1a\n\n```c++\n#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\nint n, m, k, ans, maxx, a[300010], b[300010], s[300010];\nint d[300010], p[300010], cnt[300010];\nmap <int, int> mp;\nvoid shan(int x){\n\tmp[d[b[x]]] --;\n}\nsigned main(){\n\tmemset(d, 9, sizeof(d));\n\tscanf (\"%lld%lld%lld\", &n, &m, &k);\n\tfor (int i=1; i<=m; i++){\n\t\tscanf (\"%lld\", &b[i]);\n\t}\n\tfor (int i=1; i<=n; i++){\n\t\tscanf (\"%lld\", &a[i]);\n\t\ts[i] = s[i-1] + a[i];\n\t}\n\tfor (int i=1; i<=m; i++){\n\t\td[b[i]] = s[b[i]] % k;\n\t}\n\tfor (int i=1; i<=n; i++){\n\t\tif (d[i] == 0) p[i] = p[i-1] + 1;\n\t\telse p[i] = p[i-1];\n\t\ta[i] %= k;\n\t}\n\tint l = 0;\n\tfor (int i=1; i<=m; i++){\n\t\tmp[d[b[i]] % k] ++;\n\t}\n\tfor (int i=1; i<=n+1; i++){\n\t\tans = 0;\n\t\tans += p[i-1];\n\t\tif (i > b[m]){\n\t\t\tmaxx = max(maxx, ans);\n\t\t\tcontinue;\n\t\t}\n\t\tint pos = lower_bound(b+1, b+m+1, i) - b;\n\t\twhile (l < pos) shan(++l);\n\t\tans += mp[a[i]];\n\t\tmaxx = max(maxx, ans);\n\t}\n\tprintf (\"%lld\\n\", maxx);\n\treturn 0;\n}\n```",
        "postTime": 1647754008,
        "uid": 399286,
        "name": "\u82cf\u8054\u5c0f\u6e23",
        "ccfLevel": 0,
        "title": "[\u9898\u89e3] P8226 \u300cWdoi-5\u300d\u6a31\u70b9\u6536\u96c6"
    },
    {
        "content": "\u8fd9\u9053\u9898\u5bb9\u6613\u53d1\u73b0\uff0c\u8bbe\u539f\u6765\u7684\u6bcf\u4e2a\u5730\u65b9\u6a31\u70b9\u4e3a $a$\uff0c\u5728 $k$ \u4f4d\u7f6e\u653e\u51fa $\\texttt{bomb}$ \u540e\uff0c\u63a5\u4e0b\u6765\u7684\u6a31\u70b9\u4e3a\uff1a\n\n$$a_1,a_2\\cdots a_{k-1}, 0,a_{k+1}-a_k,a_{k+2}-a_k,\\cdots a_n-a_k$$\n\n\u6211\u4eec\u518d\u5f00\u4e00\u4e2a\u6876\u7edf\u8ba1\u6ca1\u6709 $\\texttt{bomb}$ \u7684\u60c5\u51b5\u4e0b\u5230 $i$ \u4e3a\u6b62\u6700\u591a\u80fd\u6ee1\u8db3\u591a\u5c11\u8981\u6c42\uff0c\u518d\u8bb0\u4e00\u4e0b\u4ece\u540e\u5f80\u524d\u5230\u73b0\u5728\u540c\u4f59\u7684\u6570\u5373\u53ef\u3002\n\n\u81f3\u6b64\uff0c\u601d\u8def\u5c31\u5f88\u660e\u786e\u4e86\uff0c\u5f00\u4e00\u4e2a\u6876\u7ef4\u62a4\u540e\u7f00\u5230\u73b0\u5728\u6a21 $k$ \u540c\u4f59\u7684\u6570\uff0c\u4ece\u540e\u5f80\u524d\u626b\uff0c\u7edf\u8ba1\u7b54\u6848\u518d\u52a0\u4e0a\u524d\u7f00\u4e0d\u4f7f\u7528 $\\texttt{bomb}$ \u7684\u7b54\u6848\u5373\u53ef\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n//By: Luogu@?\u00cc\u00bf\u00d6\u00ce\u00c0\u00c9?(a.k.a. Kamado_Tanjiro)(LuoguID:308854)\n#include <bits/stdc++.h>\n#define int long long\n\nusing namespace std;\n\nconst int INF=(sizeof(int)==4?0x3f3f3f3f:0x3f3f3f3f3f3f3f3f);\nconst int MOD=998244353;\nconst long double EPS=1e-7;\n\nstruct Stage_t{\n\tbool IsRequire;\n\tint StageId;\n\tint PreSum;\n};\nint SakuraPowerSum[300010];\nint SakuraPower[300010];\nbool IsRequired[300010];\nint PreSum[300010];\nint BackSum[1000010];\n\nsigned main()\n{\n\tint n,m,k;\n\n\tcin>>n>>m>>k;\n\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint t;\n\n\t\tcin>>t;\n\n\t\tIsRequired[t]=1;\n\t}\n\n\tint Sum=0;\n\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tcin>>SakuraPower[i];\n\t\t\n\t\tSakuraPower[i]%=k;\n\t\tSakuraPowerSum[i]=SakuraPowerSum[i-1]+SakuraPower[i];\n\t\tSakuraPowerSum[i]%=k;\n\t\n\t\tPreSum[i]=PreSum[i-1]+(SakuraPowerSum[i]==0 && IsRequired[i]);\n\t\tSakuraPowerSum[i]=SakuraPowerSum[i-1]+SakuraPower[i];\n\t}\n\n\tint ans=PreSum[n];\n\n\tfor(int i=n;i>=1;i--)\n\t{\n\t\tans=max(ans,PreSum[i-1]+BackSum[SakuraPower[i]%k]);\n\t\t\n\t\tBackSum[SakuraPowerSum[i]%k]+=IsRequired[i];\n\t}\n\n\tcout<<ans<<endl;\n\n\treturn 0;\n}\n```",
        "postTime": 1651984067,
        "uid": 308854,
        "name": "tzl_Dedicatus545",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P8226\u3010\u300cWdoi-5\u300d\u6a31\u70b9\u6536\u96c6\u3011"
    },
    {
        "content": "### Solution\n\n------------\n\n- \u9996\u5148\u8003\u8651\u4e0d\u4f7f\u7528 bomb \u7684\u60c5\u51b5\u3002\u663e\u7136\uff0c\u53ea\u8981\u5728\u4e00\u6b21\u52a0 $ 1 $ \u540e\uff08\u4e0d\u6e05\u96f6\uff09\u4e3a $ k $ \u7684\u500d\u6570\uff0c\u5c31\u4f1a\u5bfc\u81f4 $ c \\gets 0 $\u3002\u56e0\u6b64\uff0c$ \\forall 1\\le x\\le m $\uff0c\u4e8b\u4ef6\u89e6\u53d1\u7684\u6761\u4ef6\u4e3a $ \\sum\\limits_{i=1}^{b_x}\\mod k =0 $\u3002\n\n- \u518d\u8003\u8651\u4f7f\u7528 bomb \u7684\u60c5\u51b5\u3002\u8bbe\u653e\u5728\u7b2c $ j $ \u4f4d\uff0c\u5219\u5bf9\u4e8e $ i<j $\uff0c\u4e8b\u4ef6\u89e6\u53d1\u6761\u4ef6\u4e0d\u53d8\u3002\u4f46\u5bf9\u4e8e $ i>j $\uff0c\u7531\u4e8e\u8df3\u8fc7\u4e86 $ a_j $\uff0c\u56e0\u6b64\uff0c\u4e8b\u4ef6\u89e6\u53d1\u6761\u4ef6\u53d8\u4e3a $ \\sum\\limits_{i=1}^{b_x}-a_j\\mod k =0 $\u3002\n\n\u7531\u4e8e\u9700\u8981\u6c42\u533a\u95f4\u548c\uff0c\u53ef\u4ee5\u7528\u524d\u7f00\u548c\u628a\u65f6\u95f4\u590d\u6742\u5ea6\u4ece $ \\Theta(n^2) $ \u964d\u81f3 $ \\Theta(n) $\u3002\n\n### Code\n \n------------\n\n\u6839\u636e\u7ed3\u8bba\u76f4\u63a5\u6a21\u62df\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6  $ \\Theta(n) $\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define N 300001\n#define ll long long\nusing namespace std;\nll n,m,k;\nll cnt,ans;\nll b[N],a[N];\nll x[N],pre[N];\nmap<int,int>mp;\nint main()\n{\n\tios::sync_with_stdio(0);\n\tcin.tie(0);cout.tie(0);\n\tcin>>n>>m>>k;\n\tfor(int i=1;i<=m;i++)\n\t\tcin>>b[i],mp[b[i]]=1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tcin>>a[i];\n\t\tpre[i]=pre[i-1]+a[i];\n\t\tans+=(pre[i]%k==0&&mp[i]);\n\t}\n\tcnt=ans;\n\tfor(int i=n;i>=1;i--)\n\t{\n\t\tcnt-=(pre[i]%k==0&&mp[i]);\n\t\tans=max(ans,cnt+x[a[i]%k]);\n\t\tx[pre[i]%k]+=mp[i]; \n\t}\n\tcout<<ans;\n\treturn 0;\n}\n```\n",
        "postTime": 1649060629,
        "uid": 202474,
        "name": "zhongcy",
        "ccfLevel": 5,
        "title": "P8226 \u300cWdoi-5\u300d\u6a31\u70b9\u6536\u96c6"
    },
    {
        "content": "[P8226](https://www.luogu.com.cn/problem/P8226)  \n\u6211\u4eec\u628a\u9898\u610f\u7a0d\u5fae\u7b80\u5316\u4e00\u4e0b\u5148\uff1a\n\n>\u4ece\u6570\u5217\u5c06\u67d0\u4e00\u4e2a\u6570\u7528 $ 0 $ \u66ff\u4ee3\uff08\u4e5f\u53ef\u4ee5\u4e0d\u64cd\u4f5c\uff09\uff0c\u4f7f\u5f97\u8be5\u6570\u5217\u5f62\u6210\u7684\u524d\u7f00\u548c\u5728\u67d0\u4e9b\u6307\u5b9a\u4f4d\u7f6e\u4e0a\u5c3d\u53ef\u80fd\u591a\u7684\u843d\u5728 $ k $ \u7684\u500d\u6570\u7684\u96c6\u5408\u4e4b\u4e2d\n\n\n\u90a3\u6211\u4eec\u5c31\u5148\u5c06\u6570\u5217\u7684\u524d\u7f00\u548c\u7ed9\u8ba1\u7b97\u51fa\u6765\uff0c\u7136\u540e\u5c06\u5176\u5bf9 $ k $ \u53d6\u6a21\uff0c\u8868\u793a\u6211\u4eec\u8fd8\u9700\u8981\u5c11\u62ff\u8fd9\u4e48\u591a\u7684\u70b9\u6570\uff08\u5f53\u7136\u518d\u591a\u5c11\u62ff $ n * k $ \u7684\u70b9\u6570\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u7c7b\u4f3c\u4e8e\u5468\u671f\u51fd\u6570\u6709\u591a\u4e2a\u89e3\u7684\u60c5\u51b5\uff09\u624d\u80fd\u6ee1\u8db3\u8be5\u70b9\u7684\u8981\u6c42\uff0c\u5982\u679c\u8be5\u70b9\u5904\u7406\u5b8c\u5f97\u5230\u7684\u503c\u4e3a$ 0 $,\u8868\u793a\u4e0d\u7528 bomb \u7684\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e2a\u70b9\u4e5f\u662f\u53ef\u4ee5\u5b8c\u6210\u4efb\u52a1\u7684\uff0c\n**\u4f46\u5982\u679c\u4f60\u5728\u8fd9\u4e2a\u70b9\u4e4b\u524d\u4f7f\u7528 bomb \uff0c\u8fd9\u4e2a\u70b9\u5c31\u6ca1\u6cd5\u5b8c\u6210\u4e86\u3002**  \n\n\n\u540c\u65f6\uff0c\u5bf9\u8be5\u5173\u5361\u6240\u80fd\u5f97\u5230\u7684\u70b9\u6570\u4e5f\u5bf9 $ k $ \u53d6\u6a21\uff0c\u8868\u793a\u5982\u679c\u4e0d\u62ff\u8fd9\u4e2a\u70b9\u7684\u70b9\u6570\uff0c\u5bf9\u540e\u9762\u7ed3\u679c\u6709\u591a\u5927\u7684**\u5b9e\u9645**\u5f71\u54cd\u3002  \n\n\u90a3\u4e48\u8fd9\u91cc\u6700\u5173\u952e\u7684\u601d\u60f3\u6765\u4e86\uff0c\u5728\u5173\u5361 $ i $ \u5904\u4f7f\u7528 bomb \u548c\u4e0d\u4f7f\u7528 bomb\uff0c\u5176\u5b9e\u5c31\u76f8\u5f53\u4e8e\u5c06\u5173\u5361 $ i $ \u4e4b\u540e\u6240\u6709\u8fdb\u884c\u53d6\u6a21\u540e\u7684\u524d\u7f00\u548c\uff0c\u51cf\u53bb\u5f53\u524d\u5173\u5361\u6240\u80fd\u5f97\u5230\u7684\u70b9\u6570\uff0c\u5982\u679c\u51cf\u53bb\u4e4b\u540e\u7684\u503c\u662f $ 0 $ \u6216\u8005 $ - n * k $ \u7684\u8bdd\uff0c\u5c31\u8868\u793a\u8fd9\u4e2a\u70b9\u53ef\u4ee5\u5b8c\u6210\u4efb\u52a1\u3002\uff08\u5bf9\u5f53\u524d\u5173\u5361\u505a\u53d6\u6a21\u7684\u539f\u56e0\u5c31\u5728\u8fd9\uff0c\u56e0\u4e3a\u5f97\u5230\u7684\u524d\u7f00\u548c\u51cf\u5230 0 \u4e0e\u51cf\u5230 $ - n * k $ \u7684\u6570\u503c\u4e0a\uff0c\u90fd\u8868\u793a\u53ef\u4ee5\u5b8c\u6210\uff0c\u90a3\u4e48\u6211\u4eec\u5c06\u5b83\u8fdb\u884c\u53d6\u6a21\uff0c\u5c31\u53ef\u4fdd\u8bc1\u8fdb\u884c\u4e0a\u8ff0\u64cd\u4f5c\u4e4b\u540e\uff0c\u5f97\u5230\u7684\u7ed3\u679c\u4e00\u5b9a\u4e3a\u4e00\u4e2a\u975e\u8d1f\u6574\u6570,\u65b9\u4fbf\u6211\u4eec\u76f4\u63a5\u7528\u5f53\u524d\u70b9\u5173\u5361\u7684\u503c\u76f4\u63a5\u53bb\u67e5\u8be2\u662f\u5426\u80fd\u5b8c\u6210\uff09\n\n\u6240\u4ee5\u6211\u4eec\u5c31\u53ef\u4ee5\u60f3\u5230\u4ee5\u4e0b\u64cd\u4f5c\uff1a  \n1.  **\u5168\u7a0b\u4e0d\u4f7f\u7528 bomb:**  \n$ \\text{\u53ef\u5b8c\u6210\u7684\u4efb\u52a1\u6570} = \\text{\u5904\u7406\u540e\u7684\u524d\u7f00\u548c\u5217\u8868\u6570\u5b570\u7684\u4e2a\u6570} $  \n1.   **\u5728\u5173\u5361 $ i $ \u5904\u4f7f\u7528 bomb:**  \n$ \\text{\u53ef\u5b8c\u6210\u7684\u4efb\u52a1\u6570} =  \\text{i\u4e4b\u524d\u5904\u7406\u540e\u7684\u524d\u7f00\u548c\u5217\u8868\u6570\u5b570\u7684\u4e2a\u6570} + \\text{i\u4e4b\u540e\u5904\u7406\u540e\u7684\u524d\u7f00\u548c\u5217\u8868\u4e2d\u5904\u7406\u540e\u7684\u5bf9\u5e94\u8be5\u5173\u5361\u70b9\u6570\u7684\u6570\u5b57\u7684\u4e2a\u6570}   $    \n\n**\u7136\u540e\u8ba9 $ i $ \u4ece $ 1 $ \u5f00\u59cb\u8fdb\u884c $ n $ \u8f6e\u5faa\u73af,\u4e0d\u65ad\u6bd4\u8f83\u4e0a\u9762\u4e24\u79cd\u64cd\u4f5c\u54ea\u4e2a\u6700\u5927\uff0c\u5e76\u5c06\u8fc7\u7a0b\u4e2d\u80fd\u5f97\u5230\u7684\u6700\u5927\u503c\u5b58\u50a8\u8d77\u6765**\n\n\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u5c31\u662f\u4f60\u4f7f\u7528 bomb \u53ea\u4f1a\u5bf9\u4e4b\u540e\u7684\u5173\u5361\u9020\u6210\u5f71\u54cd\uff0c\u800c\u524d\u9762\u7684\u70b9\u662f\u4e0d\u53d7\u5f71\u54cd\u7684\uff0c\u6240\u4ee5\u7528\u4e8e\u7edf\u8ba1\u7684\u5217\u8868\u8981\u66f4\u6539\u3002\n\nAC Code:(\u9644\u5e26\u4e00\u4e9b\u89e3\u91ca)\n```cpp\n#include<iostream>\nconst int MAX_N=3e6+5;\nusing namespace std;\n\nint n,m,k,temp;\nbool Achipoint[MAX_N];//\u8bb0\u5f55\u9700\u8981\u505a\u4efb\u52a1\u7684\u70b9\nint Sumlist[MAX_N],Selflist[MAX_N],ans;\n//Sumlist\u7edf\u8ba1\u524d\u7f00\u548c\uff0cSelflist\u7edf\u8ba1\u5173\u5361\u672c\u8eab\u6570\u503c\nint counter[MAX_N];\n//\u8fd9\u4e2a\u662f\u7528\u6765\u7edf\u8ba1\u5728\u5173\u5361i\u4e4b\u540e\u7684\u524d\u7f00\u548c\u4f59\u6570\u4e2a\u6570\u7684\u8868\u683c\n\n\n\nint main()\n{\n\tcin >> n >> m >> k;\n\tfor(int i = 1;i <= m;i ++)\n\t{\n\t\tcin >> temp;\n\t\tAchipoint[temp] = true;\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tcin >> Selflist[i];\n        \n\t\tSelflist[i] %= k;\n\t\tSumlist[i] = (Selflist[i] + Sumlist[i-1]) % k;\n      //\u8fd9\u91cc\u7528\u4e86mod\u8fd0\u7b97\u6027\u8d28,\u7406\u89e3\u6210\u8fd9\u4e24\u4e2a\u6570\u7ec4\u90fd\u9700\u8981\u5bf9k\u53d6\u6a21\u5904\u7406\u5c31\u597d\n       \n\t\tif(Achipoint[i]) \n        counter[Sumlist[i]] ++;\n        \n\t\tif( (!Sumlist[i]) && Achipoint[i] )\t\n\t\t\tans ++;//\u7edf\u8ba1\u4e0d\u9700\u8981\u65f6\u5019bomb\u7684\u6700\u5927\u503c\n\t}\n\tint tra0 = 0;//\u7edf\u8ba1\u5173\u5361i\u4e4b\u524d\u7684\u4e0d\u7528bomb\u5c31\u53ef\u4ee5\u5b8c\u6210\u7684\u4e2a\u6570\n\tfor(int i = 1;i <= n;i ++)\n\t{\n\t\tif(Achipoint[i])\n\t\t\tcounter[Sumlist[i]] --;//\u672c\u8f6e\u5b8c\u4e0d\u6210\u7684\uff0c\u4e4b\u540e\u4e5f\u4e0d\u884c\uff0c\u5220\u6389\n\t\tans=max(ans,tra0 + counter[Selflist[i]]);\n\t\tif( Achipoint[i] && (!Sumlist[i]) )//\u5982\u679c\u4e0d\u7528bomb\u4e5f\u80fd\u5b8c\u6210\n\t\t\ttra0 ++;//\u90a3\u5728\u5b83\u540e\u9762\u70b8\uff0c\u8fd9\u4e2a\u70b9\u4e5f\u662f\u53ef\u4ee5\u5b8c\u6210\u4efb\u52a1\u7684\n\t}\n\tcout << ans;\n}\n```\n",
        "postTime": 1648097258,
        "uid": 171521,
        "name": "SCWLine",
        "ccfLevel": 3,
        "title": "P8226 \u300cWdoi-5\u300d\u6a31\u70b9\u6536\u96c6"
    },
    {
        "content": "\u5148\u8003\u8651\u6ca1\u6709\u653e\u7b26\u7684\u60c5\u51b5\uff1a\n\n\u8ba1\u7b97\u6570\u5217\u6a21 $k$ \u610f\u4e49\u4e0b\u7684\u524d\u7f00\u548c\uff0c\u7edf\u8ba1\u6709\u591a\u5c11\u6807\u8bb0\u4f4d\u7f6e\uff08\u5373 $b_n$ \u6570\u7ec4\uff09\u524d\u7f00\u548c\u4e3a 0 .\n\n\u7136\u540e\u8003\u8651\u653e\u7b26\u7684\u60c5\u51b5\uff1a\n\n\u5b9a\u4e49\u4e00\u4e2a\u8ba1\u6570\u5668 $cnt$ ,\u521d\u59cb\u5316\u4e3a\u4e0d\u653e\u7b26\u60c5\u51b5\u4e0b\u7684\u7b54\u6848 $ans$ .\n\n\u4ece $n$ \u9006\u5e8f\u904d\u5386\u5230 1 \uff0c\u663e\u7136\u5f53\u7075\u68a6\u5728\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u653e\u7b26\u5361\u65f6\uff0c\u7b2c $i$ \u5173\u80af\u5b9a\u4e0d\u4f1a\u5c55\u5f00\u7ed3\u754c\uff0c\u540c\u65f6 $s_i$ \u5230 $s_n$  ( $s$ \u4e3a\u524d\u7f00\u548c\u6570\u7ec4\uff09 \u51cf\u5c11 $a_i$ .\n\n\u6240\u4ee5\u6211\u4eec\u6bcf\u6b21\u904d\u5386\u5230 $i$ \u7684\u65f6\u5019\uff0c\u7b54\u6848\u5373\u4e3a $[1,i-1]$ \u6709\u591a\u5c11\u6807\u8bb0\u4f4d\u7f6e\u7684\u524d\u7f00\u548c\u4e3a 0 \u52a0\u4e0a $[i+1,n]$ \u6709\u591a\u5c11\u6807\u8bb0\u4f4d\u7f6e\u7684\u524d\u7f00\u548c\u4e3a $a_i$ .\n\n\n\u82e5\u904d\u5386\u5230\u7684 $i$ \u4e3a\u6807\u8bb0\u4f4d\u7f6e\u4e14\u524d\u7f00\u548c\u4e3a 0\uff0c\u5219 $cnt--$\u3002\n\n\u65b0\u521b\u5efa\u4e00\u4e2a\u6570\u7ec4 $sum_i$ ,\u610f\u4e49\u4e3a $[i+1,n]$ \u4e2d\u6709\u591a\u5c11\u6807\u8bb0\u4f4d\u7f6e\u524d\u7f00\u548c\u4e3a $i$ \u7684\u3002\n\n\n\u6bcf\u6b21\u7edf\u8ba1\u7b54\u6848\u5373\u4e3a $cnt-sum(a_i)$ ,\u7136\u540e\u548c\u73b0\u6709\u7b54\u6848\u6bd4\u8f83\uff0c\u53d6\u6700\u5927\u503c\u5373\u53ef\u3002\n\n\n\u4ee3\u7801\uff1a\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1e6+10;\nint a[N],b[N],s[N],sum[N];\nint n,m,k;\nint ans,cnt;\nint main() {\n    cin>>n>>m>>k;\n    for(int i=1;i<=m;i++)\n      {\n          int x;\n          cin>>x;\n          b[x]=1;\n      }\n    for(int i=1;i<=n;i++)\n      {\n          cin>>a[i];\n          a[i]%=k;\n          s[i]=(s[i-1]+a[i])%k;\n          if(s[i]==0&&b[i]) ans++;\n      }\n    cnt=ans;\n    for(int i=n;i>=1;i--)\n      {\n          if(b[i]&&s[i]==0) cnt--;\n          cnt+=sum[a[i]];\n          ans=max(ans,cnt);\n          cnt-=sum[a[i]];\n          if(b[i]) sum[s[i]]++;\n      }\n    cout<<ans;\n}\n```\n",
        "postTime": 1648014933,
        "uid": 147401,
        "name": "koishi_offical",
        "ccfLevel": 4,
        "title": "P8226 \u6a31\u70b9\u6536\u96c6\u9898\u89e3"
    }
]
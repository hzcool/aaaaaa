[
    {
        "content": "\u76f4\u63a5\u66b4\u529b\u6a21\u62df\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n^2 T)$\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u4f4d\u8fd0\u7b97\u4f18\u5316\uff0c\u4f46\u6211\u4eec\u8fd8\u6709\u9884\u5904\u7406\u6bcf\u4e2a\u65f6\u95f4\u80fd\u5230\u8fbe\u7684\u683c\u5b50\u72b6\u6001\uff0c\u6240\u4ee5\u6700\u591a\u4f18\u5316\u4e00\u4e0b\u5e38\u6570\uff0c\u4e0d\u80fd\u4f7f\u65f6\u95f4\u590d\u6742\u5ea6\u5f97\u5230\u663e\u8457\u7684\u63d0\u5347\u3002\n\n\u6240\u4ee5\u8bf4\u73b0\u5728\u6574\u4e2a\u7b97\u6cd5\u7684\u74f6\u9888\u5728\u4e8e\u9884\u5904\u7406\u6bcf\u4e2a\u65f6\u95f4\u80fd\u5230\u8fbe\u7684\u683c\u5b50\u72b6\u6001\u3002\u6211\u4eec\u60f3\u529e\u6cd5\u7528\u6839\u53f7\u5206\u6cbb\u8fdb\u884c\u4f18\u5316\u3002\n\n\u5bf9\u4e8e\u5927\u4e8e $1000$ \u7684 $x$ \u53ef\u4ee5\u66b4\u529b\u6c42\u3002\n\n\u800c\u5bf9\u4e8e\u5c0f\u4e8e\u7b49\u4e8e $1000$ \u7684\u6570\u6765\u8bf4\uff0c$1000$ \u4e4b\u5185\u7684\u8d28\u6570\u5e76\u4e0d\u591a\uff0c\u53ea\u6709 $100$ \u591a\u4e2a\uff0c\u4ee4 $f_{i, j, k}$ \u8868\u793a\u5f53\u524d\u65f6\u95f4\u662f\u7b2c $i$ \u4e2a\u8d28\u6570\u7684 $j$ \u6b21\u65b9\u7684\u500d\u6570\u65f6\uff0c\u7b2c $k$ \u884c\u7684\u72b6\u6001\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u65f6\u95f4 $T$\uff0c\u6211\u4eec\u5c06\u5176\u8d28\u56e0\u6570\u5206\u89e3\uff0c\u8bbe $T = \\prod\\limits_{i=1}^n p_i^{c_i}(c_i\\ge 0)$\uff0c\u5bf9\u4e8e\u7b2c $k$ \u884c\uff0c\u6211\u4eec\u6c42\u51fa $f_{1, c_1, k},f_{2, c_2, k} \\cdots f_{n, c_n, k}$ \u8fd9\u4e9b\u6570\u6309\u4f4d\u4e0e\u540e\u7684\u7ed3\u679c\u5373\u53ef\u3002\n\n\u4f46\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u8fd8\u4e0d\u5982\u66b4\u529b\u3002\u7531\u4e8e $ > 0$ \u7684 $c_i$ \u5e76\u4e0d\u591a\uff0c\u6211\u4eec\u76f4\u63a5\u9884\u5904\u7406\u4e00\u4e0b $f_{i, 0, k}$ \u7684\u6309\u4f4d\u4e0e\u533a\u95f4\u548c\u5373\u53ef\u3002\u7531\u4e8e $2 \\times 3 \\times 5 \\times 7 \\times 11 \\times 13 \\times 17 \\times 19 > 10^6$\uff0c\u6545\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(7 \\cdot Tn)$\u3002\u5e38\u6570\u4e0d\u8981\u592a\u5927\uff0c\u5c31\u53ef\u4ee5\u8fc7\u3002\n\n\u4f46\u8fd9\u6837\u8fd8\u4f1a\u51fa\u73b0\u7a7a\u95f4\u95ee\u9898\u3002\u4e3a\u4e86\u4f18\u5316\uff0c\u6211\u4eec\u4e0d\u80fd\u76f4\u63a5\u5f00\u4e00\u4e2a $30 \\times 10^6$ \u7684\u6570\u7ec4\uff0c\u800c\u5e94\u8be5\u7528 vector \u6765\u5b58\u5927\u4e8e $1000$ \u7684\u90a3\u4e9b $x$ \u7684\u4e0b\u6807\u3002\u5e76\u4e14\u6211\u4eec\u53ef\u4ee5\u628a\u4e00\u4e2a\u4e8c\u5143\u7ec4 $(x, y)$ \u538b\u6210\u4e00\u4e2a short \u53d8\u91cf\u3002\u800c\u6211\u4eec\u4e5f\u4e0d\u7528\u8bb0\u5f55\u6bcf\u4e2a $T$ \u8d28\u56e0\u6570\u5206\u89e3\u7684\u7ed3\u679c\uff0c\u800c\u53ef\u4ee5\u8bb0\u5f55\u6700\u5927\u7684\u6574\u9664 $T$ \u7684\u8d28\u6570 $p$\uff0c\u90a3\u4e48\u4fbf\u53ef\u4ee5\u505a\u5230\u5feb\u901f\u5206\u89e3\u56e0\u6570\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u7a81\u7834\u7a7a\u95f4\u9650\u5236\u4e86\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint n, m, dp[2][31], a[31], f[200][30][31], b[31], pri[200005], tot, g[200][200][31], ff[1000005];\nconst int B = 100;\nvector<int> vec[1000005];\nint main() {\n    for (int i = 2; i <= 1000000; ++i) {\n        if (ff[i])\n            continue;\n        pri[++tot] = i;\n        ff[i] = tot;\n        for (int j = 2 * i; j <= 1000000; j += i) ff[j] = tot;\n    }\n    for (int i = 1; i <= tot; ++i)\n        if (pri[i] > B) {\n            tot = i - 1;\n            break;\n        }\n    int sx, sy;\n    scanf(\"%d%d%d%d\", &n, &m, &sx, &sy);\n    --sx, --sy;\n    dp[0][sx] |= 1 << sy;\n    for (int i = 0; i < n; ++i)\n        for (int j = 0, x; j < n; ++j) {\n            scanf(\"%d\", &x);\n            if (x > B)\n                for (int k = x; k <= m; k += x) vec[k].push_back(i * 30 + j);\n            else {\n                int now = x;\n                while (now != 1) {\n                    int xx = ff[now], cnt = 0;\n                    while (now % pri[xx] == 0) now /= pri[xx], ++cnt;\n                    f[xx][cnt][i] |= 1 << j;\n                }\n                for (int k = 1; k <= tot; ++k)\n                    if (x % pri[k])\n                        f[k][0][i] |= 1 << j;\n            }\n        }\n    for (int i = 1; i <= tot; ++i) {\n        for (int k = 0; k < n; ++k)\n            for (int j = 1; j <= 29; ++j) f[i][j][k] |= f[i][j - 1][k];\n    }\n    bool at = 0;\n    for (int l = 1; l <= tot; ++l) {\n        for (int i = 0; i < n; ++i) {\n            g[l][l][i] = f[l][0][i];\n            for (int r = l + 1; r <= tot; ++r) g[l][r][i] = g[l][r - 1][i] & f[r][0][i];\n        }\n    }\n    for (int cas = 1; cas <= m; ++cas) {\n        for (int i = 0; i < n; ++i) a[i] = (1 << n) - 1;\n        int x = cas, last = tot;\n        while (x != 1) {\n            int now = ff[x], cnt = 0;\n            while (x % pri[now] == 0) ++cnt, x /= pri[now];\n            if (now > tot)\n                continue;\n            for (int i = 0; i < n; ++i) a[i] &= f[now][cnt][i];\n            if (last >= now + 1)\n                for (int i = 0; i < n; ++i) a[i] &= g[now + 1][last][i];\n            last = now - 1;\n        }\n        if (last)\n            for (int i = 0; i < n; ++i) a[i] &= g[1][last][i];\n        for (auto v : vec[cas]) {\n            int r = v / 30, c = v % 30;\n            a[r] |= 1 << c;\n        }\n        for (int i = 0; i < n; ++i) dp[at ^ 1][i] = 0;\n        for (int i = 0; i < n; ++i) {\n            if (i >= 1)\n                dp[at ^ 1][i - 1] |= (dp[at][i] << 2) | (dp[at][i] >> 2);\n            if (i + 1 < n)\n                dp[at ^ 1][i + 1] |= (dp[at][i] << 2) | (dp[at][i] >> 2);\n            if (i >= 2)\n                dp[at ^ 1][i - 2] |= (dp[at][i] << 1) | (dp[at][i] >> 1);\n            if (i + 2 < n)\n                dp[at ^ 1][i + 2] |= (dp[at][i] << 1) | (dp[at][i] >> 1);\n        }\n        for (int i = 0; i < n; ++i) dp[at ^ 1][i] &= a[i];\n        at ^= 1;\n    }\n    int ans = 0;\n    for (int i = 0; i < n; ++i) ans += __builtin_popcount(dp[at][i]);\n    printf(\"%d\\n\", ans);\n    for (int i = 0; i < n; ++i)\n        for (int j = 0; j < n; ++j)\n            if (dp[at][i] >> j & 1)\n                printf(\"%d %d\\n\", i + 1, j + 1);\n}\n```\n\n~~\u533a\u533a 3K \u7684\u4ee3\u7801\uff0c\u4e0d\u8981\u614c\u3002~~",
        "postTime": 1658632721,
        "uid": 162196,
        "name": "\u4f1f\u5927\u7684\u738b\u592b\u5b50",
        "ccfLevel": 6,
        "title": "P7630 [COCI2011-2012#1] SKAKAC \u9898\u89e3"
    },
    {
        "content": "\u6709\u5220\u51cf\uff0c\u539f\u6587\u89c1[**\u6211\u7684\u535a\u5ba2**](https://www.cnblogs.com/SharpnessV/p/14928842.html)\u3002\n\n\n\u76f4\u63a5\u6734\u7d20\u6a21\u62df\u4e00\u4e0b\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\mathcal{O}(TN^2)$ \uff0c\u53ef\u4ee5\u901a\u8fc7 $40\\%$ \u4e2a\u6d4b\u8bd5\u70b9\u3002\n\n\u6211\u4eec\u53ea\u9700\u8981\u8bb0\u5f55 $0/1$ \u8868\u793a\u662f\u5426\u53ef\u8fbe\uff0c\u76f4\u63a5\u72b6\u538b\uff0c\u53ef\u4ee5\u505a\u5230 $\\mathcal{O}(TN)$ \u8f6c\u79fb\u3002\u4f46\u662f\u6709\u4e9b\u683c\u5b50\u5728\u67d0\u4e9b\u65f6\u95f4\u4e0d\u53ef\u5230\u8fbe\uff0c\u5904\u7406\u8fd9\u4e2a\u9650\u5236\u4ecd\u7136\u662f $\\mathcal{O}(TN^2)$ \u3002\u8fd9\u4e2a\u505a\u6cd5\u53ef\u4ee5\u4f18\u5316\u7ea6 $10$ \u500d\u5e38\u6570\uff0c\u53ef\u4ee5\u901a\u8fc7 $70\\%$ \u7684\u6d4b\u8bd5\u70b9\u3002\n\n\n\u8003\u8651\u6839\u53f7\u5206\u6cbb\uff0c\u5bf9\u4e8e $a_{i,j}\\ge \\sqrt{T}$  \uff0c\u6700\u591a\u6709 $\\sqrt T$ \u4e2a\u65f6\u95f4\u70b9\u8be5\u683c\u5b50\u662f\u5f00\u653e\u7684\uff0c\u66b4\u529b\u7ef4\u62a4\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(N^2\\sqrt T)$ \u3002\n\n\u5bf9\u4e8e $a_{i,j}< \\sqrt T$ \uff0c\u6700\u591a\u6709 $168$ \u4e2a\u8d28\u6570\u3002\n\n\u6211\u4eec\u8bb0\u5f55 $f[i][j][k]$ \u8868\u793a\u7b2c $i$ \u4e2a\u8d28\u6570 $p_i$\uff0c\u65f6\u95f4\u4e3a $p_i^j$ \u7684\u500d\u6570\uff0c\u7b2c $k$ \u884c\u7684\u72b6\u6001\uff0c\u5bf9\u6bcf\u4e2a $a_{i,j}$ \u5206\u89e3\u8d28\u56e0\u6570\u5373\u53ef\u3002\n\n\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u65f6\u95f4 $t$ \uff0c\u6211\u4eec\u5bf9 $t$ \u5206\u89e3\u8d28\u56e0\u6570\uff0c\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u8d28\u6570\u7684 $f[i][j]$ \u6309\u4f4d\u4e0e\u5373\u53ef\u3002\u6ce8\u610f\u8fd9\u91cc $j=0$ \u7684\u8d28\u6570 $p_i$ \u4e5f\u8981\u8ba1\u7b97\u8fdb\u53bb\u3002\n\n\u76f4\u63a5\u8ba1\u7b97\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\mathcal{O}(|P|TN)$ \uff0c$|P|=168$ \uff0c\u6bd4\u6734\u7d20\u6a21\u62df\u8fd8\u8981\u52a3\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u9884\u5904\u7406 $g[l][r][k]=f[l][0][k]\\ \\&\\ f[l+1][0][k]\\ \\&\\ \\cdots\\ \\&\\ f[r][0][k]$ \u3002\u8fd9\u90e8\u5206\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\mathcal{O}(|P|^2N)$ \u3002\n",
        "postTime": 1624544626,
        "uid": 119261,
        "name": "7KByte",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011[COCI2011-2012#1] SKAKAC"
    },
    {
        "content": "\u9996\u5148\u6709\u4e00\u4e2a\u7684\u72b6\u538b DP\uff0c$dp(i,j)$ \u8868\u793a $i$ \u65f6\u523b\u7684 $j$ \u884c\u53ef\u80fd\u5230\u8fbe\u7684\u5217\u7684\u96c6\u5408\uff08\u72b6\u6001\u538b\u7f29\uff09\u3002\n\n\u8f6c\u79fb\uff1a $dp(i,j)$ \u4e8c\u8fdb\u5236\u6216\u4e0a\u300c$dp(i-1,j\\pm 1)$ \u5de6\u79fb/\u53f3\u79fb $2$\u300d\u548c\u300c$dp(i-1,j\\pm2)$ \u5de6\u79fb/\u53f3\u79fb $1$\u300d\u3002\n\n\u4f46\u662f\u53d1\u73b0\u5e76\u6ca1\u6709\u8003\u8651\u5230\u300c\u5f53\u65f6\u95f4\u662f\u8fd9\u4e2a\u683c\u5b50\u6570\u5b57\u7684\u500d\u6570\u65f6\u624d\u53ef\u4ee5\u5230\u8fbe\u300d\u7684\u6761\u4ef6\uff0c\u8003\u8651\u9884\u5904\u7406\u6570\u7ec4 $ct(i,j)$ \u4e3a\u7b2c $i$ \u65f6\u523b\u7684\u7b2c $j$ \u5217\u6240\u6709\u7b26\u5408\u8981\u6c42\u7684\u5217\u6570\u7684\u96c6\u5408\uff0c\u5c06 $dp(i,j)$ \u4e8c\u8fdb\u5236\u4e0e\u4e0a $ct(i,j)$ \u5373\u53ef\u3002\n\n\u8fd9\u4e2a DP \u672c\u8eab\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(TN)$\uff0c\u7a7a\u95f4\u53ef\u4ee5\u7528\u6eda\u52a8\u6570\u7ec4\u505a\u5230 $O(N)$\u3002\n\n\u8981\u6ce8\u610f\u7684\u662f\uff0c$ct$ \u6570\u7ec4\u7531\u4e8e\u7a7a\u95f4\u9650\u5236\u4e0d\u80fd\u50a8\u5b58\uff0c\u53ea\u80fd\u5728 DP \u5230 $i$ \u65f6\u523b\u65f6\u4e34\u65f6\u6c42\u51fa\uff0c\u63a5\u4e0b\u6765\u7684\u95ee\u9898\u5c31\u7b80\u5316\u4e3a\u5982\u4f55\u9884\u5904\u7406 $ct$ \u6570\u7ec4\u3002\n\n\u8003\u8651\u6570\u636e\u5206\u6cbb\uff0c\u5bf9\u4e8e\u6570\u5b57\u5927\u4e8e $D$ \u7684\u683c\u5b50\uff0c\u80fd\u5230\u8fbe\u5176\u7684\u65f6\u95f4\u53ea\u6709 $\\frac T D$ \u4e2a\uff0c\u8003\u8651\u5c06\u8fd9\u4e2a\u70b9\u7684\u5750\u6807\u4e8c\u5143\u7ec4\u653e\u8fdb\u8fd9 $ \\frac T D$ \u4e2a\u65f6\u523b\u7684`vector`\u91cc\uff0c\u5728 DP \u5230\u8fd9\u4e2a\u65f6\u523b\u7684\u65f6\u5019\u518d\u628a\u8fd9\u4e9b\u4e8c\u5143\u7ec4\u7684\u4f4d\u7f6e\u7684 $ct$ \u8d4b\u4e0a $1$\u3002\u7a7a\u95f4\u548c\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u662f $O(N^2\\frac TD)$ \u7684\u3002\n\n\u5bf9\u4e8e\u6570\u5b57\u5c0f\u4e8e\u7b49\u4e8e $D$ \u7684\u683c\u5b50\uff0c\u8003\u8651\u5148\u5bf9\u4e8e\u5c0f\u4e8e\u7b49\u4e8e $D$ \u7684\u6bcf\u4e2a\u65f6\u523b $i$\uff0c\u9884\u5904\u7406\u6bcf\u4e00\u884c\u6709\u591a\u5c11\u4e2a\u6570\u5b57\u4e3a $i$ \u7684\uff0c\u5373 $cx(i,j)$ \u8868\u793a\u68cb\u76d8\u4e0a\u7b2c $j$ \u884c\u6570\u5b57\u4e3a $i$ \u7684\u5217\u7684\u96c6\u5408\u3002\n\n\u518d\u5728 DP \u7684\u65f6\u5019\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u65f6\u523b $i$\uff0c\u627e\u51fa\u6240\u6709\u5c0f\u4e8e\u7b49\u4e8e $D$ \u4e14\u662f $i$ \u56e0\u5b50\u7684\u65f6\u523b $j$\uff0c\u5c06\u8fd9 $N$ \u5217\u7684 $ct(i,x)$ \u4e8c\u8fdb\u5236\u6216\u4e0a $cx(j,x)$\u3002\u7a7a\u95f4\u590d\u6742\u5ea6 $O(DN)$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(TDN)$\uff0c\u4f46\u7531\u4e8e\u6ee1\u8db3\u8981\u6c42\u7684 $j$ \u5f88\u5c11\uff0c\u6240\u4ee5\u8dd1\u4e0d\u6ee1\u3002\n\n\u5b9e\u6d4b\uff0c$D$ \u4e3a\u4e8c\u5341\u51e0\u65f6\u6700\u5feb\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\n#define pii pair<int,int>\nusing namespace std;\nconst int N=32,T=1e6+10;\nbool st;\nint n,t,sx,sy,D=27;\nunsigned int cx[N][1010],dp[2][N],ct[N];\nstruct node{short x,y;};\nvector<node>cd[T];\nbool ed;\nint main(){\n    cin>>n>>t>>sx>>sy;\n    for(int i=0;i<n;i++){\n        for(int j=0;j<n;j++){\n            int v;cin>>v;\n            if(v>D) for(int k=v;k<=t;k+=v)\n                cd[k].push_back((node){i,j});\n            else cx[v][i]|=(1<<j);\n        }\n    }\n    dp[0][sx-1]|=(1<<(sy-1));\n    for(int i=1;i<=t;i++){\n        memset(dp[i&1],0,sizeof(dp[i&1]));\n        memset(ct,0,sizeof(ct));\n        for(node p:cd[i]) ct[p.x]|=(1<<p.y);\n        for(int j=1;j<=D;j++) if(!(i%j)) for(int k=0;k<n;k++) ct[k]|=cx[j][k];\n        for(int j=0;j<n;j++){\n            if(j>=1) dp[i&1][j-1]|=dp[(i-1)&1][j]<<2,dp[i&1][j-1]|=dp[(i-1)&1][j]>>2;\n            if(j<n-1) dp[i&1][j+1]|=dp[(i-1)&1][j]<<2,dp[i&1][j+1]|=dp[(i-1)&1][j]>>2;\n            if(j>=2) dp[i&1][j-2]|=dp[(i-1)&1][j]<<1,dp[i&1][j-2]|=dp[(i-1)&1][j]>>1;\n            if(j<n-2) dp[i&1][j+2]|=dp[(i-1)&1][j]<<1,dp[i&1][j+2]|=dp[(i-1)&1][j]>>1;\n        }\n        for(int j=0;j<n;j++) dp[i&1][j]&=ct[j];\n    }\n    int cnt=0;\n    for(int i=0;i<n;i++) for(int j=0;j<n;j++) if(dp[t&1][i]&(1<<j)) cnt++;\n    cout<<cnt<<'\\n';\n    for(int i=0;i<n;i++) for(int j=0;j<n;j++) if(dp[t&1][i]&(1<<j)) cout<<i+1<<' '<<j+1<<'\\n';\n    return 0;\n}\n```\n\n\n\n",
        "postTime": 1671456324,
        "uid": 238310,
        "name": "2019gzy",
        "ccfLevel": 3,
        "title": "P7630\u9898\u89e3"
    }
]
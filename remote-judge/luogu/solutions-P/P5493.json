[
    {
        "content": "\u6211\u4eec\u8003\u8651\u501f\u9274\u57c3\u5f0f\u7b5b\u6cd5\u7684\u601d\u60f3,\u9010\u6e10\u4f7f\u7528\u8d28\u6570\u5c06\u4e0d\u5408\u6cd5\u7684\u6570\u7b5b\u53bb\u3002\n\n- \u5f15\u7406 : \u5408\u6570$m$\u5fc5\u6709\u4e00\u4e2a$\\sqrt{m}$\u4ee5\u5185\u7684\u56e0\u5b50\u3002\n\n\u56e0\u6b64,\u5b9e\u73b0\u57c3\u5f0f\u7b5b\u7684\u65f6\u5019,\u53ea\u9700\u8981\u5229\u7528$\\sqrt{N}$\u4ee5\u5185\u7684\u8d28\u6570\u6765\u7b5b\u9664,\u5c31\u80fd\u6b63\u786e\u5730\u5f97\u5230$N$\u4ee5\u5185\u6240\u6709\u7684\u8d28\u6570\u3002\n\n\u4ee4$h(n,k)$\u8868\u793a\u57c3\u5f0f\u7b5b\u6cd5\u679a\u4e3e\u4e86\u524d$k$\u4e2a\u8d28\u6570\u540e,\u4e0d\u8d85\u8fc7$n$\u7684,\u8fd8\u5269\u4e0b\u7684\u6570\u7684$c$\u6b21\u65b9\u548c,\u5373\n\n$$\\sum\\limits_{i=1}^n\\large i^c\\ \\small[\\text{i\u4e0d\u542b}\\leq p_k\\text{\u7684\u7d20\u56e0\u5b50}]$$\n\n\u6211\u4eec\u4ee5$k$**\u4ece\u5c0f\u5230\u5927**\u7684\u65b9\u5f0f,\u7b5b\u53bb\u201c**\u6700\u5c0f\u7d20\u56e0\u5b50**\u4e3a$p_k$\u7684\u6570\u201d,\u6ce8\u610f\u53ea\u7b5b\u5230$\\sqrt{N}$\u5373\u53ef\u3002\n\n\u8003\u8651\u6bcf\u6b21\u51cf\u53bb\u88ab\u7b5b\u6389\u7684\u6570\u7684\u8d21\u732e,\u53ef\u4ee5\u5f97\u5230\u9012\u63a8\u5f0f :\n\n$$h(n,k)=h(n,k-1)-p_k^c\\begin{cases}{\\big(h(\\lfloor n/p_k\\rfloor,k-1)-h(p_k-1,k-1)\\big)}&(p^k\\leq\\sqrt{n})\\\\0&(p^k>\\sqrt{n})\\end{cases}$$\n\n\u8fb9\u754c : $h(n,0)=\\sum\\limits_{i=2}^ni^k$,\u6b64\u65f6\u53ea\u6709$1$\u88ab\u7b5b\u53bb\u3002\n\n\u81f3\u4e8e\u5982\u4f55\u6c42\u89e3\u81ea\u7136\u6570\u5e42\u548c,\u4e0d\u5728\u672c\u6587\u7684\u8303\u56f4,\u53ef\u89c1 `P4593` & `CF622F` , \u4f7f\u7528\u62c9\u683c\u6717\u65e5\u63d2\u503c\u8fd9\u90e8\u5206\u590d\u6742\u5ea6\u4e3a$O(k\\sqrt{n})$\n\n- **\u89e3\u91ca** :\n\n\u6211\u4eec\u5fc5\u987b\u4e0d\u91cd\u4e0d\u6f0f\u5730\u9009\u51fa\u6700\u5c0f\u7d20\u56e0\u5b50\u4e3a$p_k$\u7684\u6570\u3002\n\n\u8003\u8651\u57c3\u5f0f\u7b5b\u662f\u600e\u4e48\u7b5b\u7684 : \u6bcf\u6b21\u4ece\u5df2\u77e5\u7684\u6570\u8303\u56f4\u5185\u679a\u4e3e$x$,\u5982\u679c\u5176\u6ca1\u6709\u88ab\u7b5b\u6389,\u90a3\u4e48\u5c31\u80fd\u5f97\u5230$x$\u6ca1\u6709\u5c0f\u4e8e$p_k$\u7684\u7d20\u56e0\u5b50\u3002\n\n\u90a3\u4e48\u5c31\u80fd\u5f97\u5230$x*p_k$\u6700\u5c0f\u7d20\u56e0\u5b50\u4e3a$p_k$(**\u4e0d\u91cd**),\u6211\u4eec\u7b5b\u53bb$x*p_k$,\u8fd9\u91cc\u80fd\u5f97\u5230$x\\leq\\lfloor n/p_k\\rfloor$\u3002\n\n\u4e0d\u6f0f\u7684\u6027\u8d28\u663e\u7136\u3002\n\n\u8fd9\u6837\u5b50,\u6211\u4eec\u53bb\u9664$h(\\lfloor n/p_k\\rfloor,k-1)$\u7684\u8d21\u732e\u3002\n\n\u6ce8\u610f\u5230$h(p_k-1,k-1)$\u4e2d\u7684\u8d21\u732e\u90fd\u662f\u8d28\u6570,\u660e\u663e\u62e5\u6709\u5c0f\u4e8e$p_k$\u7684\u7d20\u56e0\u5b50,\u8fd9\u90e8\u5206\u4e0d\u5e94\u51cf\u53bb\u3002\n\n\u5f53$p_k>\\sqrt{n}$\u65f6,\u6709$h(n,k)=h(n,k-1)$,\u5373\u6ca1\u6709\u6570\u88ab\u7b5b\u9664,\u7ed3\u5408\u5f15\u7406\u5bb9\u6613\u7406\u89e3\u3002\n\n\u5f62\u5f0f\u4e0a\u5c31\u662f : $\\lfloor n/p_k\\rfloor<p_k$\u3002\n\n------------\n\n\u6ce8\u610f\u5230\u6211\u4eec\u5728\u9012\u63a8\u4e2d\u9700\u8981\u5229\u7528$\\lfloor n/p_k\\rfloor$\u5904\u7684\u53d6\u503c,\u6709\u5f15\u7406:\n$\\lfloor\\frac{N}{ab}\\rfloor=\\left\\lfloor\\frac{\\lfloor\\frac{N}{a}\\rfloor}{b}\\right\\rfloor$,\u6bd4\u8f83\u7ecf\u5178,\u8bc1\u660e\u4ece\u7565\u3002\n\n\u7ed3\u5408\u6574\u9664\u5206\u5757\u7684\u7ed3\u8bba,\u6211\u4eec\u4ece$N$\u51fa\u53d1,\u9664\u4e0a\u4e00\u7cfb\u5217\u6574\u6570,\u53ea\u4f1a\u5f97\u5230$O(\\sqrt{N})$\u79cd\u7ed3\u679c\u3002\n\n\u6211\u4eec\u53ea\u7528\u7ef4\u62a4\u4efb\u610f\u7684$\\lfloor N/d\\rfloor$\u5904\u7684\u7b54\u6848\u5373\u53ef,\u8fd9\u4e00\u5171$O(\\sqrt{N})$\u4e2a\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u8ba8\u8bba\u5b9e\u73b0\u65b9\u6cd5\u3002\n\n- \u2460 \n\n\u5982\u679c\u91c7\u7528\u66b4\u529b\u5b9e\u73b0,\u5728\u6bcf\u4e2a\u8d28\u6570\u5904\u4f7f\u7528\u4e0a\u8ff0\u9012\u63a8\u5f0f,\u590d\u6742\u5ea6\u4e3a:\n\n\u8d28\u6570\u4e2a\u6570$O(\\frac{\\sqrt{N}}{logN})$,\u7ef4\u62a4\u7684\u503c$O(\\sqrt{N})$,\u603b\u590d\u6742\u5ea6\u4e3a$O(\\frac{N}{logN})$,\u65e0\u6cd5\u901a\u8fc7\u3002\n\n- \u2461\n\n\u6ce8\u610f\u5230\u67d0\u4e9b\u503c\u5728\u9012\u63a8\u4e2d\u662f\u4e0d\u4f1a\u6539\u53d8\u7684,\u5728\u9012\u63a8\u5f0f\u4e2d\u4e0d\u65ad`+0`\u3002\n\n\u6709$O(\\frac{\\sqrt{m}}{logm})$\u4e2a\u8d28\u6570\u5728\u8f6c\u79fb\u65f6\u4f1a\u5f71\u54cd\u5230$h(m,?)$\u5730\u503c,\u53d6\u6700\u5927\u7684$\\sqrt{n}$\u4e2a$\\lfloor N/d\\rfloor$\u79ef\u5206,\n\n\u603b\u590d\u6742\u5ea6 : $O(\\sum\\limits_{d=1}^{\\sqrt{N}}\\frac{\\sqrt{N/d}}{log(N/d)})=O(\\frac{N^{3/4}}{logN})$,\u8fd9\u4e5f\u5c31\u662f\u6d32\u9601\u7b5b\u7b2c\u4e00\u90e8\u5206\u7684\u7ecf\u5178\u590d\u6742\u5ea6\u3002\n\n\u5927\u591a\u6570\u9898\u76ee\u91cc,\u505a\u5230\u8fd9\u6837\u5df2\u7ecf\u591f\u4e86,\u7531\u4e8e\u4ee3\u7801\u7b80\u5355,\u5e38\u6570\u5c0f,**\u5b9e\u6218\u4e2d\u6700\u4e3a\u5e38\u7528**\u3002\n\n- \u2462\n\n\u5f53\u7136,\u53ef\u4ee5\u8003\u8651\u5229\u7528\u6734\u7d20\u7b5b\u6cd5\u9884\u5904\u7406\u4e00\u90e8\u5206,\u5047\u8bbe\u6211\u4eec\u9884\u5904\u7406$[1,K]$\u3002\n\n\u6bcf\u6b21\u65b0\u52a0\u8d28\u6570\u7684\u65f6\u5019\u90fd\u628a$K$\u4ee5\u5185\u66b4\u529b\u7b5b\u9664\u4e00\u904d,\u9700\u8981**\u6811\u72b6\u6570\u7ec4**\u7ef4\u62a4\u52a8\u6001\u524d\u7f00\u548c,\u590d\u6742\u5ea6$O(KlogK)$\n\n\u9012\u63a8\u7684\u8fd0\u7b97\u6b21\u6570$O(\\sum\\limits_{d=1}^{N/K}\\frac{\\sqrt{N/d}}{logN})=O(\\frac{N}{logN\\sqrt{K}})$,\u4e0d\u8fc7\u6ce8\u610f\u5230\u6811\u72b6\u6570\u7ec4\u9700\u8981\u4e00\u4e2a$O(logK)$,\u8fd9\u90e8\u5206\u590d\u6742\u5ea6\u4e3a$O(\\frac{N}{\\sqrt{K}})$\n\n\u603b\u7684\u590d\u6742\u5ea6\u5c31\u662f$O(\\frac{N}{\\sqrt{K}}+KlogK)$,\u53d6$K=O((\\frac{N}{logN})^{2/3})$\u53ef\u5f97\u590d\u6742\u5ea6\u4e3a$O(N^{2/3}log^{1/3}N)\\rightarrow O(N^{2/3+e})$\u3002\n\n\u8fd9\u8fd8\u4e0d\u591f\u4f18\u79c0,\u5e76\u4e14\u7531\u4e8e\u5e38\u6570\u95ee\u9898,\u8dd1\u8fc7\u66b4\u529b\u9700\u8981\u7cbe\u7ec6\u5b9e\u73b0\u3002\n\n- \u2463\n\n\u8003\u8651\u7701\u6389\u9012\u63a8\u8fd0\u7b97\u4e2d\u7684\u90e8\u5206\u6811\u72b6\u6570\u7ec4\u64cd\u4f5c\u3002\n\n\u6ce8\u610f\u5230$h(n,k)$\u4e2d\u5982\u679c$p_k>\\sqrt{n}$\u7684\u8bdd\u51fd\u6570\u503c\u4e0d\u518d\u6539\u53d8,\u6b64\u65f6\u6211\u4eec\u76f4\u63a5\u5b58\u4e0b\u5bf9\u5e94\u7684\u51fd\u6570\u503c\u5373\u53ef,\u6ca1\u5fc5\u8981\u518d\u4f7f\u7528\u6811\u72b6\u6570\u7ec4\u3002\n\n\u89c2\u5bdf$h(n,k)$\u9012\u63a8\u5f0f\u4e2d\u4f7f\u7528\u7684\u51fd\u6570\u503c:\n\n$h(\\lfloor n/p_k\\rfloor,k-1)$\n\n\u6b64\u65f6,\u8fd9\u4e2a\u51fd\u6570\u503c\u4ecd\u5728\u53d8\u5316\u7684\u6761\u4ef6\u662f$\\sqrt{n/p_k}>p_k\\rightarrow n>p_k^3$\n\n\u4e5f\u5c31\u662f\u8bf4,\u5728$h(m,?)$\u7684\u6c42\u503c\u4e2d\u6709$O(\\frac{\\sqrt[3]{m}}{logm})$\u4e2a\u6811\u72b6\u6570\u7ec4\u64cd\u4f5c,\u590d\u6742\u5ea6\u5373\u4e3a$O(\\sqrt[3]{m})$\u3002\n\n\u8fd9\u90e8\u5206\u603b\u590d\u6742\u5ea6\u662f$O(\\sum\\limits_{d=1}^{N/K}\\sqrt[3]{N/d})=O(\\frac{N}{K^{2/3}})<O(\\frac{N}{logN\\sqrt{K}})$,\u53ef\u4e0d\u8ba1\u3002\n\n$h(p_k-1,k-1)$\n\n\u8fd9\u65f6\u8be5\u51fd\u6570\u503c\u65e9\u5df2\u786e\u5b9a,\u524d\u7f00\u548c\u5373\u53ef\u3002\n\n\u8fd9\u6837\u5b50\u7684\u603b\u590d\u6742\u5ea6\u662f$O(\\frac{N}{logN\\sqrt{K}}+KlogK)$\u53d6$K=O(\\frac{N^{2/3}}{log^{4/3}N})$\u53ef\u5f97\u590d\u6742\u5ea6\u4e3a$O(\\frac{N^{2/3}}{log^{1/3}N})\\rightarrow O(N^{2/3-e})$\u3002\n\n- \u2464\n\n\u60f3\u8981\u66f4\u5feb\u7684\u8bdd\u8bf7\u89c1 : zzt\u5de8\u795e :\u300a\u4e00\u4e9b\u7279\u6b8a\u7684\u6570\u8bba\u51fd\u6570\u6c42\u548c\u95ee\u9898\u300b(2018\u56fd\u5bb6\u5019\u9009\u961f\u961f\u8bba\u6587)\n\n\u91cc\u9762\u63d0\u51fa\u4e86\u4e00\u79cd$O((\\frac{N}{logN})^{2/3})$\u7684\u505a\u6cd5,\u4f46\u662f\u5b9e\u73b0\u8f83\u4e3a\u590d\u6742\u3002\n\n- \u2465 \u542c\u8bf4\u6709$O(\\frac{n^{2/3}}{logn})$\u7684\u505a\u6cd5\u3002\n\n------------\n\n\u8fd9\u91cc\u53ea\u7ed9\u51fa$O(\\frac{n^{3/4}}{logn}+k\\sqrt{n})$\u7684\u4ee3\u7801\u5b9e\u73b0\u3002\n\n\u4f7f\u7528\u4e86\u4e00\u4e2a\u9664\u6cd5\u4f18\u5316\u3002\n\n```cpp\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\n#define Limit 320000\ntypedef long long ll;\nusing namespace std;\nint mod;\nll powM(ll a,int t)\n{\n  ll ans=1;\n  while(t){\n    if (t&1)ans=ans*a%mod;\n    a=a*a%mod;\n    t>>=1;\n  }return ans;\n}\nint k,m;\nll lf[15],rf[15],ifac[15],y[15];\nvoid Init()\n{\n  m=k+2;\n  for (int i=1;i<=m;i++)\n    y[i]=(y[i-1]+powM(i,k))%mod;\n  ifac[0]=ifac[1]=1;\n  for (int i=2;i<=m;i++)\n    ifac[i]=ifac[mod%i]*(mod-mod/i)%mod;\n  for (int i=2;i<=m;i++)\n    ifac[i]=ifac[i]*ifac[i-1]%mod;\n  lf[0]=1;\n}\nll gPows(ll N)\n{\n  N%=mod;\n  for (int i=1;i<=m;i++)\n    lf[i]=lf[i-1]*(N-i)%mod;\n  rf[m+1]=1;\n  for (int i=m;i;i--)\n    rf[i]=rf[i+1]*(N-i)%mod;\n  ll ans=0;\n  for (int i=1;i<=m;i++)\n    ans=(ans+y[i]*lf[i-1]%mod*\n         rf[i+1]%mod*ifac[i-1]%mod*\n         ((m-i)&1 ? mod-ifac[m-i] : ifac[m-i]))%mod;\n  return ans;\n}\nll N,h0[Limit],h1[Limit];\nint lim;\nint main()\n{\n  scanf(\"%lld%d%d\",&N,&k,&mod);\n  Init();\n  lim=sqrtl(N);\n  for(int i=1;i<=lim;++i){ \n    h1[i]=gPows(N/i)-1; \n    h0[i]=gPows(i)-1;\n  }\n  for(int i=2;i<=lim;++i){\n    h0[i]=(h0[i]+mod)%mod;\n    if(h0[i]==h0[i-1])continue;\n    ll x0=h0[i-1],r=(ll)i*i,p0=powM(i,k);\n    int u=min((ll)lim,N/((ll)i*i)),uu=min(u,lim/i);\n    for(int j=1;j<=uu;++j)\n      h1[j]=(h1[j]-p0*(h1[j*i]-x0))%mod;\n    ll t=N/i;\n    if (t<(1ll<<31))\n      for(int tt=t,j=uu+1;j<=u;++j)\n        h1[j]=(h1[j]-p0*(h0[tt/j]-x0))%mod;\n    else \n      for(int j=uu+1;j<=u;++j)\n        h1[j]=(h1[j]-p0*(h0[t/j]-x0))%mod;\n    for(int j=lim;j>=r;--j)\n      h0[j]=(h0[j]-p0*(h0[j/i]-x0))%mod;\n  }\n  ll ans=0;\n  for (int i=1;i<=lim;i++)\n    ans=(ans+h1[i]*i%mod*i)%mod;\n  printf(\"%lld\\n\",(ans+mod)%mod);\n}\n```",
        "postTime": 1580113838,
        "uid": 58705,
        "name": "command_block",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P6021 \u3010\u3010\u6a21\u677f\u3011\u8d28\u6570\u524d\u7f00\u7edf\u8ba1\u3011"
    },
    {
        "content": "### \u5f15\u8a00\n\n\u6765\u5b66\u6d32\u9601\u7b5b\uff0c\u987a\u5e26\u8865\u7bc7\u9898\u89e3\u3002\n\n### \u601d\u8def\n\n\u8bbe $T=\\lfloor\\sqrt n\\rfloor$\u3002\n\n\u8bbe $T$ \u4ee5\u5185\u7684\u8d28\u6570\u7531\u5c0f\u5230\u5927\u4f9d\u6b21\u4e3a $p_1,p_2,\\dots,p_m$\u3002\n\n\u5373\u6c42\n\n$$\n\\sum_{i=1}^Ti^2S(\\lfloor\\frac ni\\rfloor)\n$$\n\n\u5bf9\u4e8e $S(y)$\uff0c\u6211\u4eec\u628a\u8d21\u732e\u62c6\u6210 $\\le T$ \u7684\u8d28\u6570\u4e0e $>T$ \u7684\u8d28\u6570\u4e24\u90e8\u5206\u3002\n\n$\\le T$ \u7684\u90e8\u5206\u663e\u7136\u53ef\u4ee5\u9884\u5904\u7406\uff0c\u8003\u8651\u540e\u534a\u90e8\u5206\u3002\n\n\u8bbe\n\n$$g(j,y)=\\sum_{v=1}^yv^k[\\forall1\\le i\\le j,p_i\\nmid v]$$\n\n\u663e\u7136\u540e\u534a\u90e8\u5206\u8d21\u732e\u53ef\u4ee5\u76f4\u63a5\u8868\u793a\u4e3a $g(m,y)-1$\u3002\n\n\u4e8e\u662f\u8003\u8651\u5982\u4f55\u5feb\u901f\u8ba1\u7b97 $g$\u3002\n\n\u5bf9\u4e8e $g(0,y)$\uff0c\n\n$$g(0,y)=\\sum_{v=1}^yv^k$$\n\n\u8fd9\u4e2a\u663e\u7136\u53ef\u4ee5 Lagrange \u63d2\u503c\uff0c\u5728 $O(k)$ \u65f6\u95f4\u5185\u8ba1\u7b97\u5355\u9879\u3002\u5f53 $k$ \u662f\u5e38\u6570\u65f6\uff0c\u5176\u53ef\u89c6\u4f5c $O(1)$\u3002\uff08\u4ee5\u4e0b\u5747\u8ba4\u4e3a $k$ \u4e3a\u5e38\u6570\uff0c\u6bd5\u7adf $O(k\\sqrt n)$ \u5b9e\u9645\u4e0a\u4e5f\u51e0\u4e4e\u4e0d\u5f71\u54cd\u603b\u590d\u6742\u5ea6\uff09\n\n\u8003\u8651\u5bf9 $g(j,y)$ \u505a\u9012\u63a8\u3002\n\n\u8003\u8651 $j$ \u589e\u91cf $1$ \u65f6\uff0c\u54ea\u90e8\u5206\u8d21\u732e\u4f1a\u88ab\u9664\u53bb\u3002\n\n\u663e\u7136\u662f\u662f $p_j$ \u500d\u6570\u7684\u90e8\u5206\u3002\n\n\u8fd9\u90e8\u5206\u7684\u8d21\u732e\u53ef\u4ee5\u4e0e $g(j-1,\\lfloor\\frac y{p_j}\\rfloor)$ \u7684\u8d21\u732e\u6784\u6210\u53cc\u5c04\uff0c\u5373\n\n$$g(j,y)=g(j-1,y)-p_j^kg_k(j-1,\\lfloor\\frac y{p_j}\\rfloor)$$\n\n\u76f4\u63a5\u9012\u63a8\u505a\u7684\u590d\u6742\u5ea6\u662f $O(\\frac n{\\log n})$ \u7684\uff0c\u9700\u8981\u4f18\u5316\u3002\n\n\u8003\u8651\u5982\u4e0b\u4e8b\u5b9e\uff1a\n\n$p_{j+1}>y$ \u65f6\uff0c$g(j,y)=1$\u3002\n\n\u56e0\u6b64\u5f53 $p_j\\le y<p_j^2$ \u65f6\uff0c\n\n$$g(j,y)=g(j-1,y)-p_j^kg_k(j-1,\\lfloor\\frac y{p_j}\\rfloor)=g(j-1,y)-p_j^k$$\n\n\u4e5f\u5373\uff0c\u53ea\u7528\u8ba1\u7b97\u5230\u6700\u540e\u4e00\u4e2a\u4f7f\u5f97 $p_j^2\\ge y$ \u7684\u90e8\u5206\u4e3a\u6b62\uff0c\u5269\u4e0b\u7684 $p_j^k$ \u7684\u8d21\u732e\u53ef\u4ee5\u540e\u7f00\u548c\u9884\u5904\u7406\u3002\n\n\u81f3\u6b64\uff0c\u603b\u8ba1\u7b97\u590d\u6742\u5ea6\u88ab\u4f18\u5316\u81f3 $O(\\frac{n^{\\frac34}}{\\log n})$\u3002\n\n### Code\n\n\u6ce8\u610f\u672c\u9898\u8981\u901a\u8fc7\u6eda\u52a8\u6570\u7ec4\u4f18\u5316\u7a7a\u95f4\u5230 $O(\\sqrt n)$\u3002\n\n\u5373\uff0c\u5bf9\u540c\u4e00\u4e2a $j$ \u8ba1\u7b97\u51fa\u5176\u5bf9\u591a\u4e2a $y$ \u7684\u89e3\u3002\n\n\u65b9\u4fbf\u8d77\u89c1\uff0c\u8fd9\u91cc\u6c42\u81ea\u7136\u5e42\u548c\u91c7\u7528\u4e86\u4f2f\u52aa\u5229\u6570\u3002\n\n```cpp\ntypedef AnyMod::ModInt modint;\nullt SQRT(ullt v){\n    ullt ans=sqrt(v);\n    while(ans*ans<=v)ans++;\n    while(ans*ans>v)ans--;\n    return ans;\n}\nmodint B[25],P[25],Q[25];\nuint k;\nmodint S(modint n){\n    if(k)n++;\n    modint ans,v(1);\n    for(uint i=k;~i;i--)ans+=P[k]*Q[i]*Q[k+1-i]*B[i]*(v*=n);\n    return ans;\n}\nullt T,Prime[200005];uint tp;\nmodint SufSum[200005],Val[200005];\nuint Pre[200005];\nstd::vector<ullt>V;\nmodint M[400005];uint End[400005],Top[400005];\nuint turn(ullt v){return std::lower_bound(V.begin(),V.end(),v,std::greater<ullt>())-V.begin();}\nmodint find(uint j,ullt v){\n    uint a=turn(v);\n    return M[a]-(SufSum[Top[a]]-SufSum[j]);\n}\nint main()\n{\n#ifdef MYEE\n    freopen(\"QAQ.in\",\"r\",stdin);\n    // freopen(\"QAQ.out\",\"w\",stdout);\n#endif\n    ullt n;uint p;scanf(\"%llu%u%u\",&n,&k,&p);AnyMod::ChgMod(p),T=SQRT(n);\n    P[0]=1;for(uint i=1;i<=k+1;i++)P[i]=P[i-1]*i;\n    Q[k+1]=P[k+1].inv();for(uint i=k+1;i;i--)Q[i-1]=Q[i]*i;\n    B[0]=1;for(uint i=1;i<=k+1;i++)for(uint j=0;j<i;j++)B[i]-=P[i]*Q[j]*Q[i-j+1]*B[j];\n    for(ullt i=2;i<=T;i++){\n        static bol B[200005];if(B[i])continue;\n        Prime[++tp]=i;for(ullt j=i;j<=T;j+=i)B[j]=1;\n    }\n    for(uint v=0;v<=T;v++){\n        uint l=0,r=tp;\n        while(l<r){uint mid=(l+r+1)>>1;if(v<Prime[mid])r=mid-1;else l=mid;}\n        Pre[v]=l;\n    }\n    for(uint i=tp;i;i--)SufSum[i-1]=SufSum[i]+(Val[i]=modint(Prime[i])^k);\n    for(ullt l=1,r;l<=n;l=r+1)V.push_back(n/l),r=n/(n/l);\n    for(uint i=0;i<V.size();i++)\n        End[i]=Pre[std::min(T,SQRT(V[i]))],M[i]=S(V[i]);\n    for(uint j=1;j<=tp;j++)for(uint i=0;i<V.size()&&End[i]>=j;i++)\n        M[i]-=Val[j]*find(j-1,V[i]/Prime[j]),Top[i]++;\n    modint ans;for(ullt i=1;i<=T;i++)ans+=(find(tp,n/i)+SufSum[0]-1)*i*i;\n    ans.println();\n    return 0;\n}\n```\n\n\n\n\n\n",
        "postTime": 1667995589,
        "uid": 105050,
        "name": "myee",
        "ccfLevel": 7,
        "title": "5493"
    },
    {
        "content": "~~\u5361\u5b8c\u5e38\u540e\u6765\u9020\u798f\u4e00\u4e0b\u4eba\u7c7b~~\n## \u5982\u4f55\u4ece4.80s\u5361\u5230920ms.jpg\n![](https://cdn.luogu.com.cn/upload/image_hosting/xzj0rynq.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/uqba51ra.png)\n\n\u672c\u9898\u89e3\u7684\u590d\u6742\u5ea6\u4e3a $ O(\\frac {n^{3/4}} {\\log n}) $\uff0c\u7136\u800c\u6807\u7b97\u662f $ O(\\frac {n^{2/3}} {\\log^{1/3} n}) $ \u7684\u3002\u3002\u3002\n\n\u6709\u65f6\u95f4\u5c1d\u8bd5\u5361\u4e00\u4e0b\u6807\u7b97\uff0c\u4f46\u662f\u770b\u6837\u5b50\u597d\u50cf\u5df2\u7ecf\u5361\u8fc7\u4e00\u4e9b\u4e86\uff0c\u4e0d\u77e5\u9053\u80fd\u4e0d\u80fd\u6bd4\u6211\u8fd9\u4e2a\u4ee3\u7801\u5feb\uff08\n\n\u9996\u5148\u4eae\u51fa\u7ecf\u5178 DP\uff1a\n$$ f(n,id)=f(n,id-1)-p_{id}^k \\times (f(\\frac n {p_{id}},id-1)-f(p_{id},id-1)) $$\n\u7136\u540e\u4f60\u5199\u5b8c\u4e4b\u540e\u7a0d\u5fae\u5361\u4e00\u4e0b\uff0c\u518d\u5438\u4e2a\u6c27\u5c31\u80fd\u5f97\u52304.80s\u7684\u4ee3\u7801\u4e86\u3002\n\n\u7a0d\u5fae\u5361\u4e00\u4e0b\u6307\u628aDP\u7684\u90e8\u5206\u4e2d\u7684int\u548cll\u5206\u5f00\uff0c\u5e76\u4e14\u7ebf\u6027\u7b5b\u8fdb\u884c\u4e86\u4e00\u4e9b\u795e\u5947\u7684\u4f18\u5316\uff08\n\n\u7136\u540e\u6211\u4eec\u5f00\u59cb\u5361\u3002\n\n\u9996\u5148\u52a0\u4e86\u4e00\u4e2aFastMod\uff0c\u901f\u5ea6\u53d8\u6210\u4e862.57s\n\n\u7136\u540e\u4f17\u6240\u5468\u77e5\u7684\u662f\uff0c\u5b9e\u6570\u9664\u6cd5\u6bd4\u6574\u6570\u9664\u6cd5\u8981\u5feb\uff0c\u53d8\u6210\u4e861.31s\u3002\n\n\u7136\u540e\u6211\u4eec\u77e5\u9053\u7ebf\u6027\u7b5b\u7684\u539f\u7406\u662f **\u7528\u81ea\u8eab\u6700\u5c0f\u7684\u8d28\u56e0\u5b50\u7b5b\u6389\u81ea\u5df1**\uff0c\u90a3\u4e48\u6211\u4eec\u6ca1\u6709\u5fc5\u8981\u7528\u9664\u6cd5\uff0c\u5c06\u5176\u8bb0\u5f55\u4e0b\u6765\u5373\u53ef\uff0c1.13s\u3002\n\n\u7136\u540e\u6211\u4eec\u5c06\u51cf\u6cd5\u4f18\u5316\u6539\u6210\u66b4\u529b\u53d6\u6a21\uff0c\u53d1\u73b0\u53d8\u6210\u4e861.06s\u3002\n\n\u7136\u540e\u7531\u4e8e\u6211\u7684DP\u8fc7\u7a0b\u4e2d\u8fb9\u754c\u662f\u8fd9\u6837\u5224\u7684\uff1a\n```cpp\nfor(;j<=tot&&pri[i]<=(m1=w[j]*invp[i]);++j)\n```\n\u6211\u4eec\u53d1\u73b0\u53ea\u9700\u8981\u5c06pri[top+1]\u6539\u4e3aINF\u5c31\u80fd\u591f\u907f\u514d\u6389\u524d\u9762\u7684\u90a3\u4e2a`j<=tot`\uff0c\u8fd9\u6b21\u5361\u8fdb\u4e861s\uff0c970ms\u3002\n\n\u7136\u540e\u7531\u4e8e\u6211\u4eecDP\u65f6\u6bcf\u6b21\u90fd\u8ba1\u7b97\u4e86\u4e00\u904d`sum[i-1]+p`\uff0c\u6211\u4eec\u5c31\u65b0\u5f00\u4e86\u4e00\u4e2a\u53d8\u91cfs\u5c06\u5176\u5b58\u4e0b\u6765\uff0c920ms\u3002\n\n### upd:\u628af\u4e2d\u7684n\u6545\u6280\u91cd\u65bd\u80fd\u5361\u5230915ms\u3002\n\n\u4e0d\u77e5\u9053\u8fd8\u80fd\u4e0d\u80fd\u5361/youl\n\n### upd:\u628a\u524d\u9762\u7684\u4e00\u4e9b\u201c\u4f18\u5316\u201d\u5220\u6389\u4e4b\u540e\u8dd1\u4e86885ms\u3002\n```cpp\n#include<cstdio>\n#include<cmath>\ntypedef long long ll;\ntypedef __uint128_t L;\ntypedef unsigned long long ull;\nconst ll M=2e5+5;\nint k,p,a[15],ifac[15],sl[15],sr[15];\nint S,id1[M],id2[M];ll tot,g[M<<1];ll n,w[M<<1];\nint top,F[17985],pri[17985],sum[17985],pos[M];bool zhi[M];\ndouble invp[17985];\nstruct FastMod{\n    ull b,m;\n    FastMod(ull b):b(b),m(ull((L(1)<<64)/b)){}\n    friend inline ull operator%(const ull&a,const FastMod&mod){\n        ull q=(L(mod.m)*a)>>64;\n        ull r=a-q*mod.b;\n        return r>=mod.b?r-mod.b:r;\n    }\n}mod(2);\ninline int pow(int a,int b){\n\tregister int ans=1;\n\tfor(;b;b>>=1,a=1ll*a*a%mod)if(b&1)ans=1ll*ans*a%mod;\n\treturn ans;\n}\ninline void init(){\n\tregister int i;k+=2;a[1]=sl[0]=sr[k+1]=ifac[0]=ifac[1]=1;\n\tfor(i=2;i<=k;++i)a[i]=(a[i-1]+pow(i,k-2))%mod,ifac[i]=1ll*(p-p/i)*ifac[p%i]%mod;\n\tfor(i=2;i<=k;++i)ifac[i]=1ll*ifac[i-1]*ifac[i]%mod;\n\tfor(i=1;i<=k;++i)a[i]=1ll*ifac[i-1]*(k-i&1?p-ifac[k-i]:ifac[k-i])%mod*a[i]%mod;\n}\ninline int f(const int&n){\n\tregister int i,N=n+p;register ull ans=0;\n\tfor(i=1;i<=k;++i)sl[i]=1ll*sl[i-1]*(N-i)%mod;\n\tfor(i=k;i>=1;--i)sr[i]=1ll*sr[i+1]*(N-i)%mod;\n\tfor(i=1;i<=k;++i)ans+=1ll*sr[i+1]*sl[i-1]%mod*a[i];\n\treturn ans%mod;\n}\ninline void sieve(const int&n){\n\tregister int i=6,j,x,m;top=2;\n\tF[1]=pow(pri[1]=2,k);F[2]=pow(pri[2]=3,k);\n\tsum[1]=F[1];sum[2]=F[1]+F[2];\n\tinvp[1]=1./2*(1+1e-15);invp[2]=1./3*(1+1e-15);\n\tdo{\n\t\tif(!zhi[m=i-1]&&i-1<=n){\n\t\t\tpri[++top]=m;sum[top]=(sum[top-1]+(F[top]=pow(m,k)))%mod;\n\t\t\tinvp[top]=1./m*(1+1e-15);\n\t\t}\n\t\tfor(j=3;j<=top&&(x=m*pri[j])<=n;++j){\n\t\t\tzhi[x]=true;if((pos[x]=j)==pos[m])break;\n\t\t}\n\t\tif(!zhi[m=i+1]&&i+1<=n){\n\t\t\tpri[++top]=m;sum[top]=(sum[top-1]+(F[top]=pow(m,k)))%mod;\n\t\t\tinvp[top]=1./m*(1+1e-15);\n\t\t}\n\t\tfor(j=3;j<=top&&(x=m*pri[j])<=n;++j){\n\t\t\tzhi[x]=true;if((pos[x]=j)==pos[m])break;\n\t\t}\n\t}while((i+=6)-1<=n);pri[++top]=p;invp[top]=0;\n}\nvoid Solve(const ll&n){\n\tconst ll&n9=n/1e9;\n\tregister int i,j,k,s;register ll m,L=1,R;\n\tfor(;L<=n;L=R+1,--g[tot]){\n\t\tR=n/(m=w[++tot]=1.*n/L);g[(m<=S?id1[m]:id2[R])=tot]=f(m%mod);\n\t}\n\tfor(i=1;i<=top;++i){\n\t\ts=sum[i-1]+p;\n\t\tfor(j=1;pri[i]<=(m=w[j]*invp[i]);++j){\n\t\t\tg[j]+=1ll*F[i]*(s-g[m<=S?id1[m]:id2[int(1.*n/m)]])%mod;\n\t\t\tif(g[j]>=p)g[j]-=p;\n\t\t}\n\t}\n}\nsigned main(){\n\tregister int i=1;register ull ans=0;\n\tscanf(\"%lld%d%d\",&n,&k,&p);mod=FastMod(p);\n\tsieve(S=sqrt(n));init();Solve(n);\n\tfor(register ll m;i<=S;++i){\n\t\tm=1.*n/i;\n\t\tans+=1ll*i*i%mod*g[m<=S?id1[m]:id2[ll(1.*n/m)]]%mod;\n\t\tif(ans>=p)ans-=p;\n\t}\n\tprintf(\"%d\",ans);\n}\n```",
        "postTime": 1621045128,
        "uid": 160839,
        "name": "Prean",
        "ccfLevel": 7,
        "title": "\u6570\u8bba \u7b5b\u6cd5+\u62c9\u683c\u6717\u65e5\u63d2\u503c P5493\u9898\u89e3"
    },
    {
        "content": "- \u9898\u76ee\u5927\u610f\uff1a\n\u8bbe $S(n)$ \u4e3a $n$ \u4ee5\u5185\u8d28\u6570\u7684 $k$ \u6b21\u65b9\u548c\u3002\u6c42\uff1a\n$$\n\\sum_{i=1}^{\\lfloor\\sqrt n\\rfloor}i^2S\\left(\\left\\lfloor\\frac{n}{i}\\right\\rfloor\\right)\n$$\n\n\n- \u524d\u7f6e\u829d\u58eb\uff1a[\u62c9\u683c\u6717\u65e5\u63d2\u503c](https://www.luogu.com.cn/problem/P4781)\n\n\u53ef\u4ee5\u5728 $O(k)$ \u7684\u65f6\u95f4\u5e2e\u52a9\u6211\u4eec\u5feb\u901f\u8ba1\u7b97 $\\sum_{i=1}^{n}i^k$ \u3002\n\n\u5f88\u660e\u663e\u8fd9\u9053\u9898\u6c42\u7684\u662f min_25 \u7b5b\u7684\u7b2c\u4e00\u90e8\u5206\u3002\n\u5173\u4e8e min_25 \u7b5b\uff0c[\u6a21\u7248\u9898](https://www.luogu.com.cn/problem/P5325) \u8bb2\u7684\u5f88\u8be6\u7ec6\u4e86\uff0c\u7b80\u5355\u518d\u63d0\u4e24\u53e5\uff1a\n\n\u8bbe $min(p)$ \u4e3a$i$\u7684\u6700\u5c0f\u8d28\u56e0\u5b50\uff0c$p_j$\u4e3a\u4ece\u5c0f\u5230\u5927\u7684\u7b2c$j$\u4e2a\u8d28\u6570\uff0c\u8bbe\uff1a\n\n$$\ng(n,j)=\\sum_{i=1}^{n}[i\\in prime\\  ||\\  min(p)>p_j]\\cdot f(i)\n$$\n\u8bbe $f(j)$ \u4e3a\u8d28\u6570\u5904\u70b9\u503c\u7b49\u4e8e $g(j)$ \u7684\u5b8c\u5168\u79ef\u6027\u51fd\u6570\u3002\u5219\u6709\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$\ng(n,j)=\n\\begin{cases}\ng(n,j-1)& {p_j^2>n}\\\\\ng(n,j-1)-f(j)\\left(g(\\frac{n}{p_j},j-1)-g(p_{j-1},j-1)\\right) & {p_j^2\\leq n}\n\\end{cases}\n$$\n\u56e0\u6b64$g(n,0)$\u5373\u4e3a\u8f6c\u79fb\u6700\u5f00\u59cb\uff0c\u7b5b\u63891\u4e4b\u540e\u6240\u6709\u6570\u70b9\u503c\u4e4b\u548c\u3002\u91c7\u7528\u6eda\u52a8\u6570\u7ec4\u7701\u7565\u7b2c\u4e8c\u7ef4\u3002\n\n\u6ce8\u610f\u5230\u6211\u4eec\u8981\u6c42\u7684 $i$ \u503c\u603b\u662f\u5c0f\u4e8e $\\sqrt{n}$\uff0c\u6240\u4ee5$S\\left(\\left\\lfloor\\frac{n}{i}\\right\\rfloor\\right)$ \u5728\u8f6c\u79fb\u4e2d\u5373\u5bf9\u5e94 $g(i,tot)$\uff0ctot\u4e3an\u4ee5\u5185\u8d28\u6570\u4e2a\u6570\uff08\u5373\u8f6c\u79fb\u7684\u8f6e\u6b21\uff09\u3002\n\n\u53e6\u5916\u6ce8\u610f\u4e00\u4e2a\u7ec6\u8282\uff1a\u9884\u5904\u7406\u51fa\u6240\u6709\u8d28\u6570\u7684 $k$ \u6b21\u65b9\uff0c\u53ef\u4ee5\u7701\u6389\u5feb\u901f\u5e42\u7684\u4e00\u4e2a$log$\uff0c\u5426\u5219\u4f1a\u8d85\u65f6\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int MAXN = 2e5 + 50;\nint k, mod, inv6;\nll n, lim;\n\nint prime[MAXN], num[MAXN], tot, sp[MAXN];\nint powp[MAXN];\nint x[15], y[15];\nint s1[15], s2[15], ifac[15];\n\nint ksm(int a, int b, int p)\n{\n    int ans = 1;\n    for(; b; b >>= 1, a = 1LL * a * a % p) if(b & 1) ans = 1LL * ans * a % p;\n    return ans;\n}\n\nvoid init()\n{\n    for(int i = 2; i < MAXN; i++)\n    {\n        if(!num[i])\n        {\n            prime[++tot] = i;\n            sp[tot] = (sp[tot-1] + ksm(i, k, mod)) % mod;\n        }\n        for(int j = 1; j <= tot && i * prime[j] < MAXN; j++)\n        {\n            num[i*prime[j]] = 1;\n            if(i % prime[j] == 0) break;\n        }\n    }\n    for(int i = 1; i <= tot; i++) powp[i] = ksm(prime[i], k, mod);\n    ifac[0] = ifac[1] = 1;\n    for (int i = 2; i < 15; i++) ifac[i] = -1LL * mod / i * ifac[mod%i] % mod;\n    for (int i = 2; i < 15; i++) ifac[i] = 1LL * ifac[i] * ifac[i-1] % mod;\n    for(int i = 1; i <= k+1; i++)\n    {\n        x[i] = i;\n        y[i] = (y[i-1] + ksm(i, k, mod)) % mod;\n    }\n    inv6 = ksm(6, mod-2, mod);\n}\n\ninline int Lagrange(int n, int *x, int *y, ll xi)\n{\n    ll ans = 0; xi %= mod;\n    s1[0] = (xi - x[0] + mod) % mod; s2[n+1] = 1;\n    for (int i = 1; i <= n; i++) s1[i] = 1LL * s1[i-1] * (xi-x[i]) % mod;\n    for (int i = n; i >= 0; i--) s2[i] = 1LL * s2[i+1] * (xi-x[i]) % mod;\n    \n    for (int i = 0; i <= n; i++)\n        (ans += 1LL * y[i] * (i == 0 ? 1 : s1[i-1]) % mod * s2[i+1] % mod\n         * ifac[i] % mod * (((n-i)&1) ? -1 : 1) * ifac[n-i] % mod);\n    return (ans % mod + mod) % mod;\n}\n\ninline int qm(int k, ll n)\n{\n    return Lagrange(k+1, x, y, n);\n}\n\nll g[MAXN << 1], id1[MAXN << 1], id2[MAXN << 1], val[MAXN << 1];\nvoid pre(ll n)\n{\n    lim = sqrt(n); int m = 0;\n    for(ll l = 1, r; l <= n; l = r + 1)\n    {\n        r = n / (n / l);\n        val[++m] = n / l;\n        if(val[m] <= lim) id1[val[m]] = m;\n        else id2[n/val[m]] = m;\n        g[m] = (qm(k, val[m]) - 1 + mod) % mod;\n    }\n    for(int j = 1; j <= tot; j++)\n    {\n        for(int i = 1; 1LL * prime[j] * prime[j] <= val[i]; i++)\n        {\n            ll tmp = val[i] / prime[j];\n            if(tmp <= lim) tmp = id1[tmp];\n            else tmp = id2[n/tmp];\n            g[i] -= 1LL * powp[j] * (g[tmp] - sp[j-1] + mod) % mod;\n            if(g[i] < 0) g[i] += mod;\n        }\n    }\n}\n\nint sum(ll x)\n{\n    x %= mod;\n    return x * (x+1) % mod * (2*x+1) % mod * inv6 % mod;\n}\n\nint solve()\n{\n    ll ret = 0;\n    for(ll l = 1, r; l <= lim; l = r + 1)\n    {\n        r = n / (n / l);\n        ll sz = sum(min(lim, r)) - sum(l-1) + mod; // sum\u662fi^2\u524d\u7f00\u548c\n        ret += 1LL * sz * g[l] % mod; // g[l]\u5c31\u662fn/l\u4ee5\u5185\u8d28\u6570\u70b9\u503c\u7684\u524d\u7f00\u548c\n    }\n    return ret % mod;\n}\n\nint main()\n{\n    scanf(\"%lld%d%d\", &n, &k, &mod);\n    init(); pre(n);\n    printf(\"%d\\n\", solve());\n    return 0;\n}\n\n```\n\n",
        "postTime": 1581649149,
        "uid": 188886,
        "name": "\u90ae\u5dee\u5c06\u519b",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5493 \u3010\u3010\u6a21\u677f\u3011\u8d28\u6570\u524d\u7f00\u7edf\u8ba1\u3011"
    }
]
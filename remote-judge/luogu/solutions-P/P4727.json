[
    {
        "content": "\u8f6c\u81ea\u6211\u5728\u77e5\u4e4e\u4e0a\u5199\u7684\u6587\u7ae0\uff0c\u53ef\u4ee5\u770b\u4e00\u770b\u5440\uff1a[https://zhuanlan.zhihu.com/p/347566986](https://zhuanlan.zhihu.com/p/347566986)\n\n---\n\n$$\\,$$\n$$\\Large{1,2,4,11,34,156,1044\\cdots}$$\n$$\\,$$\n\n$\\color{red}{\\sf Part. 1}$\n\n\u5728\u6b23\u8d4f\u4e00\u4e2a\u6709\u8da3\u7684\u6570\u5217\u524d\uff0c\u6211\u4eec\u9700\u8981\u5f15\u5165\u4e00\u4e2a\u56fe\u8bba\u6982\u5ff5\uff1a**\u540c\u6784**\u3002\n\n$A,B$ \u4e24\u56fe\u540c\u6784\u7684\u610f\u601d\u662f\uff1a$A$ \u56fe\u7684\u9876\u70b9\u53ef\u4ee5\u7ecf\u8fc7\u4e00\u5b9a\u7684\u91cd\u65b0\u6807\u53f7\uff0c\u4f7f\u5f97\u5b83\u7684\u70b9\u96c6\u548c\u8fb9\u96c6\u4e0e $B$ \u76f8\u540c\u3002\n\u4f8b\u5982\uff0c\u4ee5\u4e0b\u4e24\u4e2a\u56fe\u662f\u540c\u6784\u7684\uff1a\n\n![](https://pic3.zhimg.com/v2-bbb9c60577330c5fe70e6c3e7d980f26_b.png)\n\n\u56e0\u4e3a\u5982\u679c\u5c06\u5de6\u56fe\u7684 (3,4) \u4e24\u70b9\u4ea4\u6362\uff0c\u4e24\u56fe\u7684\u70b9\u96c6\u548c\u8fb9\u96c6\u662f\u76f8\u7b49\u7684\u3002\n\n\u518d\u5982\uff0c\u5bf9\u4e8e\u6709 $4$ \u4e2a\u9876\u70b9\u7684\u7b80\u5355\u65e0\u5411\u56fe\uff0c\u5171\u6709 $11$ \u79cd\u4e92\u4e0d\u540c\u6784\u7684\u56fe\uff1a\n\n![](https://pic1.zhimg.com/v2-6049c5b820fd42eef9ed535ab2489c4c_b.png)\n\n#### \u73b0\u5728\u95ee\u9898\u6765\u4e86\uff1a $n$ \u4e2a\u9876\u70b9\u7ec4\u6210\u7684\u7b80\u5355\u65e0\u5411\u56fe\u4e2d\uff0c\u6709\u591a\u5c11\u79cd\u56fe\u4e92\u4e0d\u540c\u6784\uff1f\n\n\u8fd9\u4e2a\u95ee\u9898\u7684\u7b54\u6848\u4fbf\u662f\u6587\u7ae0\u5f00\u5934\u7684\u6570\u5217\u2014\u2014[A000088](https://oeis.org/A000088)\u3002\n\n$$\\,$$\n$\\color{red}{\\sf Part.2}$\n\n\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u9700\u8981\u6c42\u52a9\u4e8e\u6570\u5b66\u7684\u53e6\u4e00\u9886\u57df\uff1a\u7fa4\u8bba\u3002\n\n\u5c06\u56fe\u7684\u9876\u70b9\u91cd\u65b0\u6807\u53f7\uff0c\u5c31\u76f8\u5f53\u4e8e\u5bf9\u70b9\u96c6\u8fdb\u884c\u7f6e\u6362\uff0c\u6240\u6709\u7684\u6807\u53f7\u65b9\u5f0f\u4fbf\u6784\u6210\u4e86\u4e00\u4e2a\u7f6e\u6362\u7fa4 $G$ \u3002\u6211\u4eec\u8981\u6c42\u7684\u5373\u662f\u5728 $G$ \u4f5c\u7528\u4e0b\u672c\u8d28\u4e0d\u540c\u7684\u56fe\u7684\u4e2a\u6570\u3002\u5bf9\u4e8e\u6709 $n$ \u4e2a\u9876\u70b9\u7684\u56fe\uff0c\u6240\u6709\u7684\u6807\u53f7\u65b9\u5f0f\u4fbf\u662f\u9876\u70b9\u7684\u5168\u6392\u5217\uff0c\u5373 $|G|=n!$ \u3002\n\n\u73b0\u5728\u9686\u91cd\u8bf7\u51fa ${\\rm Burnside}$ \u5f15\u7406\uff1a\n\n$$|X/G|=\\frac{1}{|G|}\\sum_{g\\in G}|X^g|$$\n\n$|X/G|$ \uff1a\u96c6\u5408 $X$ \u5728\u7fa4 $G$ \u4f5c\u7528\u4e0b\u7684\u8f68\u9053\u6570\uff08\u6216\u672c\u8d28\u4e0d\u540c\u5143\u7d20\u6570\uff09\n\n$|X^g|$ \uff1a\u5728\u53d8\u6362 $g$ \u4e0b\uff0c$X$ \u96c6\u5408\u4e2d\u7684\u4e0d\u52a8\u70b9\u6570\n\n\u8fd9\u4e2a\u5b9a\u7406\u5bf9\u89e3\u51b3\u8ba1\u6570\u95ee\u9898\u6709\u91cd\u8981\u4f5c\u7528\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff1a\n\n![\u7ef4\u57fa\u767e\u79d1](https://pic2.zhimg.com/v2-6d3461b4db0bc4299c4268fbd86f42e5_b.png)\n\n\u5728\u672c\u9898\u4e2d\uff0c$X$ \u5373\u4e3a $n$ \u4e2a\u9876\u70b9\u53ef\u4ee5\u6784\u6210\u7684 $2^{n(n-1)/2}$ \u4e2a\u7b80\u5355\u65e0\u5411\u56fe\u7684\u96c6\u5408\uff0c$|X/G|$ \u5373\u4e3a\u6240\u6c42\u3002\u96be\u70b9\u5728\u4e8e\u600e\u4e48\u6c42 $|X^g|$\uff0c**\u5373\u5bf9\u4e8e\u67d0\u4e2a\u70b9\u96c6\u7f6e\u6362 $g$ \u800c\u8a00\uff0c\u6709\u591a\u5c11\u5f20\u56fe\u5728\u7ecf\u5386\u53d8\u6362 $g$ \u540e\u4f9d\u7136\u548c\u539f\u6765\u7684\u56fe\u76f8\u540c**\uff1f\n\n$$\\,$$\n$\\color{red}{\\sf Part.3}$\n\n\u597d\u4e86\uff0c\u8ba9\u6211\u4eec\u968f\u673a\u62bd\u53d6\u4e00\u540d\u5e78\u8fd0\u7f6e\u6362 $g$ \u8fdb\u884c\u7814\u7a76\uff0c\u770b\u770b\u6709\u591a\u5c11\u5f20\u56fe\u5728\u7ecf\u5386 $g$ \u540e\u7eb9\u4e1d\u4e0d\u52a8\u3002\n\n\u82e5\u9690\u82e5\u73b0\u7684\u8fb9\u592a\u9ebb\u70e6\u5566\uff01\u4e0d\u59a8\u5047\u8bbe\u6240\u6709\u8fb9\u90fd\u5df2\u5b58\u5728\uff0c\u73b0\u5728\u5728\u6211\u4eec\u9762\u524d\u7684\u662f\u4e00\u4e2a $n$ \u4e2a\u8282\u70b9\u7684\u5b8c\u5168\u56fe\uff0c\u7136\u540e\u6211\u4eec\u9700\u8981\u7ed9\u8fb9\u4eec\u67d3\u8272\uff0c\u67d3\u6210\u5b58\u5728\u6216\u4e0d\u5b58\u5728\u4e24\u79cd\u989c\u8272\uff0c\u4ece\u800c\u5f97\u5230 $X$ \u4e2d\u6240\u6709\u7684\u56fe\u3002\n\n![](https://pic4.zhimg.com/v2-b0053228b459fddf2a43210f21fdf45b_b.png)\n\n\u5982\u4f55\u5224\u65ad\u67d3\u6210\u4ec0\u4e48\u6837\u5b50\u53ef\u4ee5\u4f7f\u5f97\u5b83\u6210\u4e3a\u7f6e\u6362 $g$ \u4e2d\u7684\u4e0d\u52a8\u70b9\u5462\uff1f\n\n\u6ce8\u610f\u5230\u6709\u4e9b\u8fb9\u662f**\u7b49\u4ef7**\u7684\uff0c**\u7b49\u4ef7\u7684\u8fb9\u4e00\u5b9a\u8981\u67d3\u6210\u540c\u4e00\u4e2a\u989c\u8272\uff0c\u8981\u4e48\u540c\u65f6\u5b58\u5728\uff0c\u8981\u4e48\u540c\u65f6\u4e0d\u5b58\u5728**\u3002\n\n>\u4f8b\u5982\u4e00\u4e2a\u4e09\u4e2a\u9876\u70b9\u7684\u4e09\u89d2\u5f62\uff0c\u5982\u679c\u7f6e\u6362 $g$ \u7684\u4f5c\u7528\u662f\u5c06\u4e09\u4e2a\u9876\u70b9\u987a\u65f6\u9488\u8f6e\u6362\uff0c\u90a3\u4e48\u8fd9\u4e09\u6761\u8fb9\u662f\u7b49\u4ef7\u7684\uff08\u540c\u5c5e\u4e00\u4e2a\u7b49\u4ef7\u7c7b\uff09\uff0c\u8981\u4e48\u540c\u65f6\u5b58\u5728\uff08\u5f62\u6210\u4e00\u4e2a\u5b8c\u6574\u7684\u4e09\u89d2\u5f62\uff09\uff0c\u8981\u4e48\u540c\u65f6\u4e0d\u5b58\u5728\uff08\u5f62\u6210\u4e09\u4e2a\u5b64\u7acb\u7684\u9876\u70b9\uff09\u3002\u4e0d\u53ef\u80fd\u51fa\u73b0\u6709\u4e24\u6761\u8fb9\u5b58\u5728\uff0c\u4e00\u6761\u8fb9\u4e0d\u5b58\u5728\u7684\u60c5\u51b5\uff0c\u5426\u5219\u7ecf\u8fc7\u4e00\u6b21\u65cb\u8f6c\uff0c\u7f3a\u53e3\u4fbf\u5230\u4e86\u53e6\u5916\u4e24\u4e2a\u70b9\u95f4\uff0c\u4e0e\u539f\u6765\u7684\u56fe\u5c31\u4e0d\u540c\u4e86\u3002\u6ce8\u610f\u5230\u6b64\u65f6\u4e09\u8fb9\u540c\u5c5e $1$ \u4e2a\u7b49\u4ef7\u7c7b\uff0c\u6bcf\u4e2a\u7b49\u4ef7\u7c7b\u8981\u4e48\u67d3\u8981\u4e48\u4e0d\u67d3\uff0c\u56e0\u6b64\u5728\u6b64\u7f6e\u6362 $g$ \u4e0b\u6709 $2^1=2$ \u4e2a\u4e0d\u52a8\u70b9\u3002\n\n>\u8fd8\u662f\u8fd9\u4e2a\u4e09\u89d2\u5f62\uff0c\u8fd9\u56de\u7f6e\u6362 $g$ \u53d8\u4e3a\u4ea4\u6362\u4e24\u4e2a\u70b9\uff0c\u53e6\u4e00\u4e2a\u70b9\u4e0d\u52a8\u3002\u90a3\u4e48\u4e24\u4e2a\u52a8\u70b9\u95f4\u7684\u8fb9\u5355\u72ec\u5c5e\u4e8e\u4e00\u4e2a\u7b49\u4ef7\u7c7b\uff0c\u53e6\u5916\u4e24\u6761\u8fb9\u5c5e\u4e8e\u53e6\u4e00\u7b49\u4ef7\u7c7b\uff0c\u4e00\u5171\u6709 $2$ \u4e2a\u7b49\u4ef7\u7c7b\u3002\u6bcf\u4e2a\u7b49\u4ef7\u7c7b\u8981\u4e48\u67d3\u8981\u4e48\u4e0d\u67d3\uff0c\u56e0\u6b64\u518d\u6b64\u7f6e\u6362 $g$ \u4e0b\u6709 $2^2=4$ \u4e2a\u4e0d\u52a8\u70b9\u3002\n\n\u6362\u53e5\u8bdd\u8bf4\uff0c\u5bf9\u4e8e\u7f6e\u6362 $g$ \u5982\u679c\u5b58\u5728 $k$ \u4e2a\u8fb9\u7684\u7b49\u4ef7\u7c7b\uff0c\u90a3\u4e48 $X$ \u4e2d\u5c31\u6709 $2^k$ \u4e2a\u4e0d\u52a8\u70b9\u3002\u5373\uff1a\n\n$$|X^g|=2^k$$\n\n$$\\,$$\n$\\color{red}{\\sf Part.4}$\n\n\u597d\u5566\uff0c\u63a5\u4e0b\u6765\u7684\u95ee\u9898\u5c31\u662f\u6c42 $k$ \u2014\u2014\u7f6e\u6362 $g$ \u4e0b\u8fb9\u7684\u7b49\u4ef7\u7c7b\u4e2a\u6570\u3002\u8fd9\u90e8\u5206\u662f\u5173\u952e\uff0c\u800c\u4e14\u6709\u4e9b\u7ed5\uff0c\u6211\u4eec\u5206\u4e24\u6b65\u8d70\uff1a\n\n#### \u7b2c\u4e00\u6b65\uff0c\u6211\u4eec\u8981\u5c06 $g$ \u62c6\u5206\u4e3a\u82e5\u5e72\u4e2a\u4e0d\u76f8\u4ea4\u7684\u5faa\u73af\u7f6e\u6362\u3002\n\n\u8fd9\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f\u4e3e\u4e2a\u4f8b\u5b50\uff0c $g$ \u53ef\u4ee5\u628a\u70b9 $\\{1,2,3,4,5,6\\}$ \u7f6e\u6362\u6210 $\\{2,3,1,5,4,6\\}$ \uff0c\u53ef\u4ee5\u8bb0\u4f5c\uff1a $g= \\begin{pmatrix}  1 & 2 & 3 & 4 & 5 & 6\\\\  2 & 3 & 1 & 5 & 4 & 6 \\end{pmatrix}$ \u3002\u6ce8\u610f\u5230\u8fd9\u4e2a\u7f6e\u6362\u53ef\u4ee5\u5206\u89e3\u6210\u51e0\u4e2a\u4e0d\u76f8\u4ea4\u7684\u90e8\u5206\uff0c\u5176\u4e2d\u6bcf\u4e2a\u90e8\u5206\u90fd\u662f\u4e00\u4e2a\u5faa\u73af\uff1a\n\n$$\n\\begin{pmatrix}  1 & 2 & 3 & 4 & 5 & 6\\\\  2 & 3 & 1 & 5 & 4 & 6 \\end{pmatrix}=\\begin{pmatrix}  1 & 2 & 3\\\\  2 & 3 & 1 \\end{pmatrix} \\circ \\begin{pmatrix}  4 & 5\\\\  5 & 4 \\end{pmatrix} \\circ \\begin{pmatrix}  6\\\\ 6 \\end{pmatrix}\n$$\n\n\u73b0\u5728\u5c06\u6211\u4eec\u5f53\u524d\u7814\u7a76\u7684\u7f6e\u6362 $g$ \u62c6\u6210 $K$ \u4e2a\u5faa\u73af\uff0c\u957f\u5ea6\u5206\u522b\u4e3a $b_1,b_2,\\cdots,b_K$ \u3002\n\n#### \u7b2c\u4e8c\u6b65\uff0c\u5c06\u8fb9\u6309\u7167\u7aef\u70b9\u5206\u6210\u4e24\u7c7b\n\n1._\u7aef\u70b9\u540c\u65f6\u5b58\u5728\u4e8e\u540c\u4e00\u5faa\u73af\u5185\u7684\u8fb9_\u3002\u8bbe\u5faa\u73af\u957f\u5ea6\u4e3a $b$ \uff0c\u5219\u6b21\u5faa\u73af\u5171\u6709 $\\left \\lfloor \\frac{b}{2} \\right \\rfloor$  \u4e2a\u7b49\u4ef7\u7c7b\u3002\u4f8b\u5982\u5bf9\u4e8e\u957f\u5ea6\u4e3a $6$ \u7684\u5faa\u73af\u7f6e\u6362 $\\begin{pmatrix}  1 & 2 & 3 & 4 & 5 & 6\\\\  2 & 3 & 4 & 5 & 6 & 1 \\end{pmatrix}$ \uff0c\u6211\u4eec\u628a\u8fd9 $6$ \u4e2a\u70b9\u6392\u6210\u6b63\u516d\u8fb9\u5f62\uff1a\n\n![](https://pic3.zhimg.com/v2-f596d56c7d6b70c876da8549b0e418ae_b.png)\n\n\uff08\u989c\u8272\u76f8\u540c\u7684\u8fb9\u540c\u5c5e\u4e8e\u4e00\u4e2a\u7b49\u4ef7\u7c7b\uff09\n\n\u4e0d\u96be\u53d1\u73b0\u4e24\u6761\u8fb9\u7b49\u4ef7\u5f53\u4e14\u4ec5\u5f53\u5b83\u4eec\u957f\u5ea6\u76f8\u7b49\uff0c\u7b49\u4ef7\u7684\u8fb9\u5fc5\u987b\u540c\u65f6\u67d3/\u4e0d\u67d3\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4\u56fe\u6848\u4e0d\u5177\u6709\u65cb\u8f6c\u5bf9\u79f0\u6027\uff0c\u7ecf\u8fc7\u5faa\u73af\u7f6e\u6362\u540e\u4e5f\u5fc5\u5b9a\u4e0e\u539f\u56fe\u4e0d\u540c\u3002\u800c\u6b63 b \u8fb9\u5f62\u4e2d\uff0c\u5171\u6709 $\\left \\lfloor \\frac{b}{2} \\right \\rfloor$  \u79cd\u957f\u5ea6\u4e0d\u540c\u7684\u7ebf\u6bb5\uff0c\u4e5f\u5c31\u662f\u5bf9\u5e94 $\\left \\lfloor \\frac{b}{2} \\right \\rfloor$ \u4e2a\u8fb9\u7684\u7b49\u4ef7\u7c7b\u3002\u5f97\u8bc1\u3002\n\n\u56e0\u6b64\u8fd9\u4e00\u7c7b\u8fb9\u4e00\u5171\u8d21\u732e\u4e86 $\\sum_{i=1}^K\\left \\lfloor \\frac{b_i}{2} \\right \\rfloor$  \u4e2a\u7b49\u4ef7\u7c7b\u3002\n\n2._\u7aef\u70b9\u5b58\u5728\u4e8e\u4e0d\u540c\u5faa\u73af\u5185\u7684\u8fb9_ \u3002\u4f8b\u5982 $\\begin{pmatrix}  1 & 2 & 3\\\\  2 & 3 & 1 \\end{pmatrix} \\circ \\begin{pmatrix}  4 & 5\\\\  5 & 4 \\end{pmatrix} \\circ \\begin{pmatrix}  6\\\\ 6 \\end{pmatrix}$ \uff0c\u5219\u8fde\u63a5 $3,4$ \u7684\u8fb9\u4e0d\u5728\u540c\u4e00\u5faa\u73af\u5185\u3002\u8fd9\u65f6\uff0c\u8bbe\u4e24\u4e2a\u5faa\u73af\u7684\u957f\u5ea6\u5206\u522b\u4e3a $b_1,b_2$ \uff0c\u90a3\u4e48\u4e24\u4e2a\u5faa\u73af\u95f4\u5171\u6709 $b_1b_2$ \u6761\u8fd9\u6837\u7684\u8fb9\u3002\n\n![](https://pic2.zhimg.com/v2-3093b059a2542dd991dedfe20a38ecbd_b.png)\n\n\uff08\u5982\u4e0a\u56fe\uff0c\u5faa\u73af $(1,2,3)$ \u4e0e $(4,5)$ \u95f4\u5171\u6709 $6$ \u6761\u8fb9\uff0c\u4f46\u540c\u5c5e\u4e8e $\\gcd(2,3)=1$ \u4e2a\u7b49\u4ef7\u7c7b\uff09\n\n\u6bcf\u6761\u8fb9\u7ecf\u8fc7 ${\\rm lcm}(b_1,b_2)$ \u6b21\u5faa\u73af\u540e\u4f1a\u56de\u5f52\u539f\u4f4d\uff0c\u6240\u4ee5\u6bcf\u4e2a\u7b49\u4ef7\u7c7b\u5927\u5c0f\u4e3a ${\\rm lcm}(b_1,b_2)$ \u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e00\u5171\u6709 $\\frac{b_1b_2}{{\\rm lcm}(b_1,b_2)}=\\gcd(b_1,b_2)$ \u4e2a\u7b49\u4ef7\u7c7b\u3002\u522b\u5fd8\u4e86\uff0c\u8fd9\u53ea\u662f $g$ \u5185\u5176\u4e2d\u4e24\u4e2a\u5faa\u73af\u4ea7\u751f\u7684\u8d21\u732e\uff0c\u8981\u628a\u6bcf\u5bf9\u5faa\u73af\u7684\u8d21\u732e\u7d2f\u52a0\u8d77\u6765\uff0c\u4e5f\u5c31\u662f\uff1a $\\sum_{i=1}^K\\sum_{j=1}^{i-1}\\gcd(b_i,b_j)$ \u4e2a\u7b49\u4ef7\u7c7b\u3002\n\n\u81f3\u6b64\u4e24\u79cd\u60c5\u51b5\u5df2\u7ecf\u5206\u7c7b\u8ba8\u8bba\u5b8c\u6bd5\uff0c\u8fb9\u7684\u7b49\u4ef7\u7c7b\u4e2a\u6570\u5c31\u7b49\u4e8e\u4e24\u79cd\u60c5\u51b5\u6570\u91cf\u4e4b\u548c\uff1a\n\n$$k=\\sum_{i=1}^K\\left \\lfloor \\frac{b_i}{2} \\right \\rfloor +\\sum_{i=1}^K\\sum_{j=1}^{i-1}\\gcd(b_i,b_j)$$\n\n$$|X/G|=\\frac{1}{|G|}\\sum_{g\\in G}2^k$$\n\n\u662f\u4e0d\u662f\u611f\u89c9\u79bb\u6210\u529f\u4e0d\u8fdc\u4e86\u5462\uff08\n\n$$\\,$$\n$\\color{red}{\\sf Part.5}$\n\n\u5176\u5b9e\u5230\u4e86\u8fd9\u91cc\uff0c\u6211\u4eec\u5df2\u7ecf\u627e\u5230\u8ba1\u7b97\u6587\u7ae0\u5f00\u5934\u6570\u5217\u7684\u65b9\u6cd5\u4e86\u3002\u4f46\u662f\uff0c\u522b\u5fd8\u4e86 $|G|=n!$ \uff0c\u679a\u4e3e\u6bcf\u4e00\u4e2a\u7f6e\u6362 $g$ \uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5c11\u8bf4\u4e5f\u5f97 $O(n!)$ \u3002\u6211\u4eec\u662f\u5426\u4ee5\u4f18\u5316\u4e00\u4e0b\u8ba1\u7b97\u65b9\u6cd5\u5462\uff1f\n\n\u6ce8\u610f\u5230\u6709\u8bb8\u591a\u7f6e\u6362\u4f1a\u88ab\u91cd\u590d\u8ba1\u7b97\uff0c\u5982\u4e0b\u9762\u4e24\u4e2a\u7f6e\u6362\uff1a\n\n$$\\begin{pmatrix}  1 & 2 & 3\\\\  2 & 3 & 1 \\end{pmatrix} \\circ \\begin{pmatrix}  4 & 5\\\\  5 & 4 \\end{pmatrix} \\circ \\begin{pmatrix}  6\\\\ 6 \\end{pmatrix}\\qquad\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\circ  \\begin{pmatrix}  2 & 3\\\\  3 & 2 \\end{pmatrix} \\circ  \\begin{pmatrix}  4 & 5 & 6\\\\  6 & 4 & 5 \\end{pmatrix}$$\n\n\u5b83\u4eec\u95f4\u6ca1\u6709\u672c\u8d28\u4e0a\u7684\u533a\u522b\uff0c\u5bf9\u5e94\u7684 $k$ \u503c\u90fd\u76f8\u7b49\uff08\u56e0\u4e3a $b$ \u90fd\u662f $1,2,3$ \uff09\uff0c\u672c\u53ef\u4ee5\u7edf\u4e00\u8ba1\u7b97\u3002\n\n\u4e00\u822c\u5730\uff0c\u5982\u679c\u4e24\u4e2a\u7f6e\u6362\u7684\u5faa\u73af\u957f\u5ea6\u6392\u5e8f\u540e\u4e00\u4e00\u76f8\u7b49\uff0c\u90a3\u4e48\u4e24\u8005\u5bf9\u7b54\u6848\u7684\u8d21\u732e $2^k$ \u662f\u76f8\u7b49\u7684\u3002\u56e0\u6b64\uff0c\u4e0e\u5176\u679a\u4e3e\u6bcf\u4e00\u79cd\u7f6e\u6362\u518d\u62c6\u5206\uff0c\u4e0d\u5982\u679a\u4e3e $n$ \u7684\u62c6\u5206\u4ee3\u8868**\u4e00\u7c7b\u7f6e\u6362**\uff0c\u518d\u7edf\u4e00\u8ba1\u7b97\u8d21\u732e\u3002\n\u4f8b\u5982 $n=5$ \u65f6\uff0c\u5b83\u7684\u62c6\u5206\u6709 $(1,1,1,1,1),(1,1,1,2),(1,1,3),(1,2,2),(1,4),(2,3),(5)$ \uff0c\u5176\u4e2d $(1,2,2)$ \u7edf\u4e00\u4ee3\u8868\u4e86\u5f62\u5982\n\n$$\\begin{pmatrix} * \\\\ * \\end{pmatrix} \\circ  \\begin{pmatrix}  * & *\\\\  * & * \\end{pmatrix} \\circ  \\begin{pmatrix}  * & *\\\\  * & * \\end{pmatrix}$$\n\n\u7684\u7f6e\u6362\u3002\u4e5f\u5c31\u662f\u5faa\u73af\u957f\u5ea6 $b=\\{1,2,2\\}$ \u7684\u7f6e\u6362\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e\u67d0\u4e2a\u62c6\u5206\uff0c\u5982\u4f55\u8ba1\u7b97\u6709\u591a\u5c11\u5bf9\u5e94\u7684\u7f6e\u6362\u5462\uff1f\n\n\u9996\u5148 $1\\sim n$ \u968f\u4fbf\u653e\u4e00\u5171\u6709 $n!$ \u79cd\u65b9\u6848\uff0c\u4f46\u957f\u5ea6\u4e3a $b$ \u7684\u5faa\u73af\u4f1a\u8d21\u732e $b!$ \u500d\u91cd\u590d\u65b9\u6848\u3002\u6240\u4ee5\u5355\u662f\u5206\u914d\u6bcf\u4e2a\u5143\u7d20\u5728\u54ea\u4e2a\u5faa\u73af\u4e2d\u5c31\u6709 $\\frac{n!}{\\prod(b_i!)}$ \u79cd\u65b9\u6848\u3002\n\n\u63a5\u7740\u662f\u5faa\u73af\u7684\u5185\u90e8\u5206\u914d\uff0c\u4e5f\u5c31\u662f $b_i$ \u4e2a\u5143\u7d20\u7684\u5706\u6392\u5217\uff0c\u6709 $\\prod(b_i-1)!$ \u79cd\u65b9\u6848\u3002\n\n\u4f46\u4e8b\u5b9e\u4e0a\uff0c\u5bf9\u4e8e\u957f\u5ea6\u76f8\u7b49\u7684\u5faa\u73af\u5b83\u4eec\u4e4b\u95f4\u53ef\u4ee5\u5f7c\u6b64\u4ea4\u6362\uff0c\u672c\u8d28\u4e0a\u662f\u4e00\u6837\u7684\uff0c\u56e0\u6b64\u8fd8\u662f\u4f1a\u7b97\u91cd\u3002\u8bbe $c$ \u8868\u793a\u8868\u67d0\u4e2a\u957f\u5ea6\u7684\u5faa\u73af\u7684\u4e2a\u6570\uff0c\u5219\u4f1a\u7b97\u91cd $c!$ \u500d\u3002\u56e0\u6b64\u7b54\u6848\u8fd8\u9700\u9664\u4ee5 $\\prod(c_i!)$ \u3002\n\n\u7ed3\u5408\u4e0a\u8ff0\u4e09\u9879\uff0c\u53ef\u4ee5\u5f97\u5230\uff0c\u62c6\u5206 $b_i$ \u6240\u5bf9\u5e94\u7684\u7f6e\u6362\u4e2a\u6570\u4e3a\uff1a\n\n$$\\frac{n!}{\\prod(b_i)\\prod(c_i!)}$$\n\n\u7528\u8fd9\u4e2a\u5f0f\u5b50\u6539\u8fdb\u4e4b\u524d\u7684 n! \u679a\u4e3e\u7b97\u6cd5\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$|X/G|=\\frac{1}{|G|}\\sum_b \\frac{n!}{\\prod(b_i)\\prod(c_i!)} 2^k$$ \n\n$|G|=n!$ \uff0c\u91cc\u5916\u4e24\u9879\u6b63\u597d\u62b5\u6d88\uff0c\u5f97\u5230\u6700\u7ec8\u7684\u5f62\u5f0f\uff1a\n\n$$\\,$$\n$$\\large{|X/G|=\\sum_b \\frac{2^k}{\\prod(b_i)\\prod(c_i!)}}$$\n\n$$\\large{k=\\sum_{i=1}^K\\left \\lfloor \\frac{b_i}{2} \\right \\rfloor +\\sum_{i=1}^K\\sum_{j=1}^{i-1}\\gcd(b_i,b_j)}$$\n$$\\,$$\n\n**\u5927\u529f\u544a\u6210\u3002**\n\n\u6700\u540e\u518d\u63d0\u4e00\u4e0b\u65f6\u95f4\u590d\u6742\u5ea6\u3002DFS\u679a\u4e3e $n$ \u7684\u62c6\u5206 $b$ \uff0c\u518d $O(K^2)$ \u6c42 $k$ \u3002\u589e\u957f\u901f\u5ea6\u662f [A000041](http://oeis.org/A000041)\uff0c[A296010](https://oeis.org/A296010) \u7684\u4e58\u79ef\u3002\u524d\u8005\u589e\u901f\u662f $O\\left (\\frac{e^{\\sqrt{n}}}{n}\\right )$\uff0c\u540e\u8005\u4e0d\u77e5\u9053\u3002\u4f30\u8ba1\u603b\u590d\u6742\u5ea6\u5927\u6982\u5728 $O(10^{\\sqrt{x}})$ \u5de6\u53f3\u3002\n\n$$\\,$$\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\n\nint ans, n, p = 997, b[70], jc[70], jd[70];\n\nint gcd(int a, int b){\n\treturn !b ? a : gcd(b, a % b);\n}\n\nint qpow(int A, int B){\n\tint C = 1;\n\twhile(B){\n\t\tif(B & 1) C = C * A % p;\n\t\tA = A * A % p, B >>= 1;\n\t}\n\treturn C;\n}\n\nvoid init(){\n\tjc[0] = 1;\n\tfor(int i = 1; i < 70; i++){\n\t\tjc[i] = i * jc[i - 1] % p;\n\t}\n\t// \u9884\u5904\u7406\u9636\u4e58\n}\n\nvoid work(int len){\n\tint u = 0, v = 1;\n\tfor(int i = 1; i <= len; i++){\n\t\tu += b[i] >> 1;\n\t\tfor(int j = 1; j < i; j++){\n\t\t\tu += gcd(b[i], b[j]);\n\t\t}\n\t\t// \u8ba1\u7b97\u8fb9\u7684\u7b49\u4ef7\u7c7b\u4e2a\u6570\uff0cu \u5373\u9898\u89e3\u7684 k\n\t}\n\tfor(int i = 1; i <= len; i++){\n\t\tv = v * b[i] % p;\n\t}\n\tfor(int i = 1, j; i <= len;){\n\t\tfor(j = i; b[i] == b[j] && j <= len; j++);\n\t\tv = v * jc[j - i] % p;\n\t\t// \u53bb\u9664\u957f\u5ea6\u76f8\u7b49\u7684\u5faa\u73af\u5e26\u6765\u7684\u91cd\u590d\u8ba1\u7b97\n\t\ti = j;\n\t}\n\tans = (ans + qpow(v, p - 2) * qpow(2, u) % p) % p;\n}\n\nvoid dfs(int now, int last, int rem){\n\tif(!rem){\n\t\t// DFS \u679a\u4e3e n \u7684\u6240\u6709\u62c6\u5206\n\t\twork(now - 1);\n\t\treturn;\n\t}\n\tfor(int i = last; i <= rem; i++){\n\t\tb[now] = i;\n\t\tdfs(now + 1, i, rem - i);\n\t}\n}\n\nsigned main(){\n\tcin >> n;\n\tinit();\n\tdfs(1, 1, n);\n\tcout << ans;\n\treturn 0;\n}\n```\n$$\\,$$\n\n$\\color{red}{\\sf Part.6}$\n\n\u4e0d\u59a8\u601d\u8003\u5f62\u5f0f\u66f4\u4e00\u822c\u7684\u95ee\u9898\uff1a\n\n#### $n$ \u4e2a\u8282\u70b9\u7684\u5b8c\u5168\u65e0\u5411\u56fe\uff0c\u7528 $m$ \u79cd\u989c\u8272\u7ed9\u6bcf\u6761\u8fb9\u67d3\u8272\uff0c\u53ef\u4ee5\u67d3\u51fa\u51e0\u79cd\u4e92\u4e0d\u540c\u6784\u7684\u56fe\uff1f\n\n\u7b54\u6848\u5341\u5206\u7b80\u5355\uff0c\u53ea\u9700\u8981\u5c06\u4e0a\u8ff0\u5f0f\u5b50\u4e2d\u7684 2 \u6539\u4e3a m \u5373\u53ef\uff1a\n\n$$\\,$$\n$$\\large{|X/G|=\\sum_b \\frac{\\color{red}{m}^\\color{black}k}{\\prod(b_i)\\prod(c_i!)}}$$\n\n$$\\large{k=\\sum_{i=1}^K\\left \\lfloor \\frac{b_i}{2} \\right \\rfloor +\\sum_{i=1}^K\\sum_{j=1}^{i-1}\\gcd(b_i,b_j)}$$\n$$\\,$$\n\n\u56e0\u4e3a\u5728\u539f\u95ee\u9898\u4e2d\uff0c\u6bcf\u6761\u8fb9\u6709\u5b58\u5728/\u4e0d\u5b58\u5728\u4e24\u79cd\u60c5\u51b5\uff0c\u8fd9\u7b49\u4ef7\u4e8e\u7528\u4e24\u79cd\u989c\u8272\u7ed9\u6bcf\u6761\u8fb9\u67d3\u8272\uff0c\u4e0d\u52a8\u70b9\u6570\u4e3a $2^k$ \u3002\u73b0\u5728\u6539\u4e3a\u7528 $m$ \u79cd\u989c\u8272\u67d3\u8272\uff0c\u81ea\u7136\u5c31\u662f $m^k$ \u4e86\u3002\n\n~~\u53cc\u500d\u7ecf\u9a8c\uff1aP4128~~",
        "postTime": 1611834932,
        "uid": 142338,
        "name": "pythoner713",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4727 \u3010[HNOI2009]\u56fe\u7684\u540c\u6784\u8ba1\u6570\u3011"
    },
    {
        "content": "\u6c42\u672c\u8d28\u4e0d\u540c\u7684\u65b9\u6848\u6570\uff0c\u5f88\u660e\u663e\u5c31\u662f\u7fa4\u8bba\u8fd9\u5957\u7406\u8bba\u4e86\u3002  \n\u7f6e\u6362\u4e00\u5171\u6709$n!$\u4e2a\uff0c\u8003\u8651\u5982\u4f55\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u7f6e\u6362\u6c42\u4e0d\u52a8\u70b9\u6570\u91cf\u3002  \n\u9996\u5148\u8fb9\u5b58\u5728\u6216\u8005\u4e0d\u5b58\u5728\u592a\u9ebb\u70e6\u4e86\uff0c\u6211\u4eec\u5047\u88c5\u6240\u6709\u8fb9\u90fd\u5df2\u7ecf\u5b58\u5728\uff0c\u51fa\u73b0\u8fc7\u7684\u8fb9\u548c\u4e0d\u5b58\u5728\u7684\u8fb9\u7528\u4e24\u79cd\u4e0d\u540c\u7684\u989c\u8272\u67d3\u8272\u5373\u53ef\u3002\u8fd9\u6837\u5b50\u6211\u4eec\u5c31\u5047\u88c5\u6240\u6709\u7684\u8fb9\u90fd\u51fa\u73b0\u4e86\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2a\u5b8c\u5168\u56fe\u3002  \n\u663e\u7136\u5faa\u73af\u662f\u5bf9\u4e8e\u70b9\u800c\u8bba\u7684\uff0c\u4f46\u662f\u8fd9\u9898\u540c\u6784\u662f\u5bf9\u4e8e\u8fb9\u800c\u8bba\u7684\u3002\u90a3\u4e48\u6211\u4eec\u5bf9\u4e8e\u4e00\u4e2a\u70b9\u7684\u5faa\u73af\uff0c\u8003\u8651\u5b83\u7684\u4e24\u4e2a\u9876\u70b9\u3002\u8fd9\u4e24\u4e2a\u9876\u70b9\u53ea\u6709\u4e24\u79cd\u4e0d\u540c\u60c5\u51b5\uff0c\u8981\u4e48\u5728\u540c\u4e00\u4e2a\u5faa\u73af\u5185\uff0c\u8981\u4e48\u4e0d\u5728\u540c\u4e00\u4e2a\u5faa\u73af\u5185\u3002\u8003\u8651\u6240\u6709\u5728\u540c\u4e00\u4e2a\u5faa\u73af\u4e2d\u7684$n$\u70b9\u5f62\u6210\u7684\u5b8c\u5168\u56fe\uff0c\u90a3\u4e48\u5b83\u7684\u8fb9\u6784\u6210\u4e86$n/2$\u4e2a\u5faa\u73af\uff0c\u611f\u6027\u7406\u89e3\u5c31\u662f\uff0c\u6211\u4eec\u628a$n$\u4e2a\u70b9\u62c9\u6210\u4e00\u6392\uff0c\u628a\u76f8\u90bb\u8ddd\u79bb\u4e3a\u5b9a\u503c\u7684\u70b9\u8fde\u4e0a\u8fb9\uff0c\u663e\u7136\u8fd9\u6837\u5b50\u4f1a\u6784\u6210\u4e00\u4e2a\u73af\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u8ddd\u79bb\u7684\u5b9a\u503c$d$\u548c$n-d$\u662f\u7b49\u4ef7\u7684\uff0c\u6240\u4ee5\u8fb9\u6784\u6210\u4e86$n/2$\u4e2a\u5faa\u73af\u3002  \n\u8003\u8651\u4e24\u4e2a\u9876\u70b9\u4e0d\u5728\u4e00\u4e2a\u5faa\u73af\u5185\uff0c\u90a3\u4e48\u6784\u6210\u5faa\u73af\u5fc5\u5b9a\u662f\u5728\u4e00\u4e2a\u70b9\u96c6\u4e2d\u9009\u62e9\u4e00\u6761\u8fb9\u8fde\u5411\u53e6\u5916\u4e00\u4e2a\u70b9\u96c6\uff0c\u518d\u4ece\u53e6\u5916\u4e00\u4e2a\u70b9\u96c6\u4e2d\u9009\u4e00\u6761\u8fb9\u8fde\u56de\u6765\uff0c\u6211\u4eec\u628a\u70b9\u96c6\u770b\u6210\u4e24\u4e2a\u73af\uff0c\u90a3\u4e48\u6bcf\u6b21\u53ef\u4ee5\u628a\u73af\u4e0a\u6240\u6709\u7684\u70b9\u65cb\u8f6c\u4e00\u4e0b\uff0c\u90a3\u4e48\u65cb\u8f6c$lcm$\u6b21\u4e4b\u540e\u5c31\u8f6c\u56de\u6765\u4e86\uff0c\u610f\u5473\u7740\u8fd9$lcm$\u6761\u8fb9\u5fc5\u987b\u76f8\u540c\uff0c\u5373\u6784\u6210\u4e00\u4e2a\u5faa\u73af\uff0c\u90a3\u4e48\u8fb9\u7684\u5faa\u73af\u7684\u4e2a\u6570\u5c31\u662f$gcd$\u4e86\u3002  \n\u5047\u8bbe\u6709\u8fb9\u7684\u7f6e\u6362\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u77e5\u9053\u4e0d\u52a8\u70b9\u7684\u6570\u91cf\u5c31\u662f$2^m$\uff0c\u5176\u4e2d$m$\u662f\u8fb9\u7f6e\u6362\u7684\u6570\u91cf\uff0c\u663e\u7136\u4f60\u7684\u4e2a\u7f6e\u6362\u4e2d\u7684\u8fb9\u7684\u989c\u8272\u90fd\u662f\u76f8\u540c\u7684\u3002   \n\u8fd9\u6837\u4e00\u6765\uff0c\u6211\u4eec\u5c31\u628a\u70b9\u7f6e\u6362\u8f6c\u6362\u4e3a\u8fb9\u7f6e\u6362\u4e86\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u65b9\u4fbf\u7684\u8ba1\u7b97\u4e86\u3002  \n$60$\u7684\u62c6\u5206\u6570\u5927\u6982\u662f\u767e\u4e07\u7ea7\u522b\u7684\uff0c\u6211\u4eec\u4f3c\u4e4e\u662f\u53ef\u4ee5\u7206\u641c\u62c6\u5206\u6570\u8ba1\u7b97\u7b54\u6848\u7684\u3002  \n\u90a3\u4e48\u8003\u8651\u4e00\u4e2a\u62c6\u5206\u6570\u5b9e\u9645\u4e0a\u5bf9\u5e94\u7684\u65b9\u6848\u6570\uff0c\u8fd9\u4e2a\u6392\u5217\u7ec4\u5408\u8ba1\u7b97\u4e00\u4e0b\u5c31\u597d\u4e86\u3002  \n\u6211\u4eec\u5047\u8bbe\u6709$k$\u4e2a\u5faa\u73af\uff0c\u6bcf\u4e2a\u7684\u5927\u5c0f\u5206\u522b\u662f$a_1,a_2,...$\uff0c\u6bcf\u4e2a\u5927\u5c0f\u7684\u7f6e\u6362\u4e2a\u6570\u662f$num_1,num_2...$  \n\u90a3\u4e48\u8fd9\u79cd\u60c5\u51b5\u7684\u8d21\u732e\u5c31\u662f$\\frac{n!}{(\\prod a_i!)*(\\prod num_i!)}$\uff0c\u539f\u56e0\u5c31\u662f\uff0c$n!$\u662f\u6240\u6709\u65b9\u6848\uff0c\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u7f6e\u6362\u5185\uff0c\u663e\u7136\u73af\u7684\u4f4d\u7f6e\u4e0d\u5f71\u54cd\uff0c\u51fa\u53bb\u7b49\u4ef7\u7684\u73af\uff0c\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u7b49\u5927\u5c0f\u7684\u7f6e\u6362\uff0c\u663e\u7136\u4f4d\u7f6e\u662f\u53ef\u4ee5\u4ea4\u6362\u7684\uff0c\u90a3\u4e48\u9664\u53bb\u9636\u4e58\u7684\u6392\u5217\u7684\u5f71\u54cd\u3002\n  \n\u597d\u4e86\uff0c\u8fd9\u6837\u5b50\u5927\u6982\u53ef\u4ee5\u7b97\u5b8c\u6240\u6709\u7f6e\u6362\u7684\u4e0d\u52a8\u70b9\u6570\u91cf\uff0c\u7136\u540e\u9664\u6389\u4e00\u4e2a\u7f6e\u6362\u603b\u6570\u5c31\u5bf9\u4e86\uff0c\u663e\u7136\u7f6e\u6362\u603b\u6570\u662f$n!$\u3002\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#define MOD 997\n#define MAX 75\nint n,ans,jc[MOD],inv[MOD],jv[MOD];\nint g[MAX][MAX],a[MAX],b[MAX],bin[MAX*MAX];\nvoid calc()\n{\n\tint ret=jc[n],tot=0,sum=0;\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tret=ret*jv[a[i]]%MOD;\n\t\tfor(int j=1;j<=a[i];++j)\n\t\t\tret=ret*inv[i]%MOD,b[++tot]=i;\n\t}\n\tfor(int i=1;i<=tot;++i)sum+=b[i]/2;\n\tfor(int i=1;i<=tot;++i)\n\t\tfor(int j=i+1;j<=tot;++j)\n\t\t\tsum+=g[b[i]][b[j]];\n\tret=ret*bin[sum]%MOD;\n\tans=(ans+ret)%MOD;\n}\nvoid dfs(int x,int sum)\n{\n\tif(x==1){a[x]=n-sum;calc();return;}\n\tfor(int i=0;sum+i*x<=n;++i)\n\t\ta[x]=i,dfs(x-1,sum+i*x);\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tjc[0]=jv[0]=inv[0]=inv[1]=bin[0]=1;\n\tfor(int i=2;i<MOD;++i)inv[i]=inv[MOD%i]*(MOD-MOD/i)%MOD;\n\tfor(int i=1;i<MOD;++i)jc[i]=jc[i-1]*i%MOD;\n\tfor(int i=1;i<MOD;++i)jv[i]=jv[i-1]*inv[i]%MOD;\n\tfor(int i=1;i<MAX*MAX;++i)bin[i]=bin[i-1]*2%MOD;\n\tfor(int i=1;i<=n;++i)\n\t\tfor(int j=1;j<=n;++j)\n\t\t\tg[i][j]=__gcd(i,j);\n\tdfs(n,0);ans=ans*jv[n]%MOD;\n\tprintf(\"%d\\n\",ans);return 0;\n}\n```",
        "postTime": 1539266955,
        "uid": 21283,
        "name": "yybyyb",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P4727 \u3010[HNOI2009]\u56fe\u7684\u540c\u6784\u8bb0\u6570\u3011"
    },
    {
        "content": "\u4e00\u9053Burnside\u9898\u7684\u6d41\u7a0b\u5927\u6982\u662f\u4e24\u6b65\uff1a\n\n1. \u627e\u51fa\u7f6e\u6362\u7fa4$<G,*>$\u548c\u76ee\u6807\u96c6\u5408$S$\u3002\n2. \u6c42\u51fa$G$\u4e2d\u6bcf\u4e00\u4e2a\u7f6e\u6362\u5728$S$\u4e2d\u7684\u4e0d\u52a8\u70b9\u96c6\u5408\u5927\u5c0f\u4e4b\u548c\u3002\n\n\u8bb0\u4e00\u4e2a\u7f6e\u6362$t(t\\in G)$\u5728$S$\u4e2d\u7684\u4e0d\u52a8\u70b9\u96c6\u5408\u662f$S_t=\\{x\\in S |x*t=x\\}$\u3002\n\n\u6b64\u9898\u4e2d\uff0c\u7f6e\u6362\u7fa4$G$\u662f\u6240\u6709\u7684\u9636\u4e3a$n$\u7684\u7f6e\u6362\uff0c$|G|=n!$\u3002\u76ee\u6807\u96c6\u5408\u662f\u6240\u6709\u6709\u6807\u53f7\u7684\u3001\u70b9\u6570\u4e3a$n$\u7684\u56fe\u7684\u4e2a\u6570\uff0c\u56e0\u4e3a\u6709$\\frac{n(n-1)}{2}$\u6761\u53ef\u80fd\u7684\u8fb9\uff0c\u6240\u4ee5$|S|=2^{\\frac{n(n-1)}{2}}$\u3002\n\n\u663e\u7136$G$\u592a\u5927\u4e86\uff0c\u4e0d\u80fd\u62ff\u51fa\u5176\u4e2d\u7684\u6bcf\u4e00\u4e2a\u7f6e\u6362\u4e00\u4e2a\u4e2a\u7b97\u4e0d\u52a8\u70b9\u96c6\u5408\u5927\u5c0f\u3002\u901a\u8fc7\u5bf9\u5c0f\u6570\u636e\u7684\u624b\u52a8\u8ba1\u7b97\u53ef\u4ee5\u53d1\u73b0\uff0c\u7531\u4e8e\u56fe\u7684\u5bf9\u79f0\u6027\uff0c\u5bf9\u4e8e\u4efb\u610f\u4e24\u4e2a\u7f6e\u6362$t_1,t_2\\in G$\uff0c$|S_{t_1}|=|S_{t_2}|$\u7684\u5145\u5206\u6761\u4ef6\u662f$t_1,t_2$\u7684\u5faa\u73af\u4e2a\u6570\u76f8\u540c\uff0c\u800c\u4e14\u628a\u5404\u4e2a\u5faa\u73af\u6309\u7167\u5927\u5c0f\u6392\u5e8f\u4e4b\u540e\u4e5f\u5206\u522b\u76f8\u540c\u3002\n\n\u6240\u4ee5\uff0c\u4e0d\u59a8\u628a$G$\u4e2d\u7684\u5143\u7d20\u4ee5\u6b64\u4e3a\u636e\u5206\u7c7b\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4f7f\u5f97\u6bcf\u4e00\u7c7b\u4e2d\u7684\u6240\u6709\u7f6e\u6362$t$\u7684$|S_t|$\u90fd\u662f\u76f8\u7b49\u7684\u3002\u8fd9\u4e00\u7c7b\u7f6e\u6362\u7ec4\u6210\u7684\u96c6\u5408\u7528$G_i$\u8868\u793a\uff1b\u4e5f\u5c31\u662f\u8bf4\uff0c$G_i$\u5c31\u662f\u7531\u5404\u4e2a\u5faa\u73af\u5206\u522b\u76f8\u7b49\u7684\u4e00\u4e9b\u7f6e\u6362\u7ec4\u6210\u7684\u4e00\u4e2a$G$\u7684\u5b50\u96c6\u3002\n\n\u5b9e\u9645\u4e0a\uff0c\u6bcf\u4e00\u4e2a$G_i$\u4e2d\u7684\u7f6e\u6362\u4eec\u7684\u5faa\u73af\u4eec\u7684\u5927\u5c0f\uff0c\u90fd\u662f\u6574\u6570$n$\u7684\u67d0\u4e00\u4e2a\u5212\u5206\u2014\u2014\u6240\u8c13\u5212\u5206\u5c31\u662f\u6307\u628a$n$\u8868\u793a\u4e3a\u4efb\u610f\u591a\u4e2a\u6574\u6570\u4e4b\u548c\uff0c\u800c\u4e14\u6574\u6570\u662f\u65e0\u5e8f\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u5982\u679c$n=3$\uff0c\u90a3\u4e48$2+1$\u548c$1+2$\u662f\u540c\u4e00\u79cd\u5212\u5206\u3002$n$\u7684\u5212\u5206\u7684\u603b\u65b9\u6848\u6570\uff0c\u5c31\u662f\u653e\u82f9\u679c\u95ee\u9898\u4e2d\uff0c\u82f9\u679c\u6570\u4e3a$n$\u800c\u76d8\u5b50\u4e2a\u6570\u4ece$1$\u5230$n$\u7684\u7b54\u6848\u4e4b\u548c\u3002$n=60$\u65f6\uff0c\u603b\u5212\u5206\u6570\u5927\u7ea6\u662f\u767e\u4e07\u7ea7\u522b\uff08\u8bed\u51fayyb\uff09\u3002\n\n\u73b0\u5728\u6211\u4eec\u901a\u8fc7dfs\u5f97\u5230\u4e86\u4e00\u4e2a\u5355\u8c03\u4e0d\u4e0b\u964d\u7684\u5e8f\u5217${a_1,a_2,...,a_m}$\uff0c\u6ee1\u8db3$1\\le m,a_i \\le n,\\sum_{i=1}^m a_i = n$\u3002\u8fd9\u5c31\u662f\u4e00\u4e2a$n$\u7684\u5212\u5206\u3002\u8fd9\u4e2a\u5e8f\u5217\u5bf9\u5e94\u4e86\u67d0\u4e00\u4e2a$G_i$\uff0c\u8868\u793a$G_i$\u4e2d\u7f6e\u6362\u7684\u5404\u4e2a\u5faa\u73af\u7684\u5927\u5c0f\u3002\u4e3a\u6c42\u51fa\u8fd9\u4e2a$G_i$\u4e2d\u7684\u7f6e\u6362\u4eec\u7684\u4e0d\u52a8\u70b9\u96c6\u5408\u5927\u5c0f\u4e4b\u548c\uff0c\u6211\u4eec\u8981\u6c42\u51fa\u4e24\u4e2a\u503c\uff1a$G_i$\u4e2d\u5143\u7d20\u7684\u4e2a\u6570\uff0c\u4ee5\u53ca\u90a3\u4e2a\u76f8\u7b49\u7684$|S_t|$\u662f\u591a\u5c11\u3002\n\n\u524d\u4e00\u4e2a\u503c\u662f\uff1a\n$$\n\\frac{n!}{(\\prod a_i)(\\prod b_x!)}\n$$\n\u5176\u4e2d$b_x = \\sum_{i=1}^m [a_i = x]$\u3002\n\n\u8fd9\u4e2a\u7684\u8bc1\u660e\u53ef\u4ee5\u7528\u4f20\u7edf\u7684\u6392\u5217\u7ec4\u5408\u77e5\u8bc6\u89e3\u51b3\u3002\n\n\u540e\u4e00\u4e2a\u503c\u8f83\u4e3a\u590d\u6742\u3002\u540e\u4e00\u4e2a\u503c\u8981\u6c42\u7684\u5c31\u662f\u6709\u591a\u5c11\u79cd\u8fde\u8fb9\u7684\u65b9\u6cd5\uff0c\u4f7f\u5f97\u5728\u56fe\u7684\u70b9\u7f16\u53f7\u88ab\u7f6e\u6362\u4e00\u6b21\u4e4b\u540e\uff0c\u56fe\u7684\u5404\u4e2a\u5faa\u73af\u5185\u90e8\u4ee5\u53ca\u5faa\u73af\u4e4b\u95f4\u4ecd\u7136\u662f\u4e00\u6a21\u4e00\u6837\u7684\u3002\n\n\u6211\u4eec\u9700\u8981\u518d\u6b21\u628a\u95ee\u9898\u5206\u6210\u4e24\u90e8\u5206\uff1a\u5faa\u73af\u5185\u548c\u5faa\u73af\u95f4\u3002\n\n\u5bf9\u4e8e$m$\u4e2a\u5faa\u73af\u4e2d\u7684\u4e00\u4e2a\u5927\u5c0f\u4e3a$a_i$\u7684\u5faa\u73af\uff0c\u4e0d\u59a8\u9009\u53d6\u5176\u4e2d\u4efb\u610f\u7684\u4e00\u4e2a\u70b9k\u4f5c\u4e3a\u8003\u8651\u7684\u6838\u5fc3\u3002\u628a$a_i$\u4e2a\u70b9\u6309\u7167\u5faa\u73af\u7684\u987a\u5e8f\u4e00\u5b57\u94fa\u5f00\uff0c\u5e76\u628ak\u653e\u5728\u7b2c\u4e00\u4e2a\uff0c\u5982\u679ck\u6709\u4e00\u6761\u8fb9\u8fde\u5230\u4e86\u5b83\u540e\u9762\u8ddd\u79bb\u5b83\u4e3a$d(d\\ge1)$\u7684\u70b9\uff0c\u90a3\u4e48\u6bcf\u4e00\u4e2a\u5176\u4ed6\u70b9\u90fd\u9700\u8981\u6709\u4e00\u6761\u8fb9\u8fde\u5230\u5b83\u540e\u9762\u8ddd\u79bb\u5b83\u4e3a$d$\u7684\u70b9\u3002\u6240\u4ee5\u4ecek\u51fa\u53d1\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8de8\u5ea6$d$\uff0c\u53ef\u4ee5\u9009\u62e9\u8fde\u4e00\u6761\u8de8\u5ea6\u4e3a$d$\u7684\u8fb9\u6216\u8005\u4e0d\u8fde\uff1b\u800c\u968f\u5373\u6240\u6709\u5176\u4ed6\u5730\u65b9\u7684\u8fde\u8fb9\u60c5\u51b5\u4e5f\u5c31\u90fd\u88ab\u786e\u5b9a\u4e86\u3002\n\n\u5230\u8fd9\u91cc\uff0c\u9700\u8981\u53d1\u73b0\u7684\u4e00\u70b9\u662f\uff0c\u56e0\u4e3a\u8fb9\u662f\u65e0\u5411\u7684\uff0c\u6240\u4ee5\u5982\u679ck\u8fde\u51fa\u7684\u8fb9\u4e2d\uff0c\u6709\u67d0\u4e00\u6761\u8fb9\u8de8\u5ea6\u8d85\u8fc7\u4e86$\\lfloor \\frac{a_i}{2}\\rfloor$\uff08\u8bb0\u8fd9\u4e2a\u8de8\u5ea6\u4e3a$d$\uff09\uff0c\u90a3\u4e48\u5c31\u76f8\u5f53\u4e8e\u5f80\u524d\u9762\u8fde\u4e86\u4e00\u6761\u8de8\u5ea6\u4e3a$a_i-d$\u7684\u8fb9\u2014\u2014\u6545\u800ck\u5f80\u540e$a_i-d$\u6761\u8fb9\u7684\u90a3\u4e2a\u70b9\u4e5f\u5fc5\u5b9a\u4f1a\u6709\u4e00\u6761\u8fb9\u8fde\u5230k\u3002\u8fd9\u4e5f\u5c31\u76f8\u5f53\u4e8e\u662f$k$\u5f80\u540e\u8fde\u4e86\u4e00\u6761\u8de8\u5ea6\u4e3a$a_i - d$\u7684\u8fb9\u3002\u7efc\u4e0a\u6240\u8ff0\uff0c$k$\u5f80\u540e\u8fde\u4e00\u6761\u8de8\u5ea6\u4e3a$a_i-d$\u7684\u8fb9\u548c\u8de8\u5ea6\u4e3a$d$\u7684\u8fb9\u662f\u7b49\u4ef7\u7684\uff0c\u6700\u540e\u968f\u4e4b\u786e\u5b9a\u7684\u6574\u4e2a\u5faa\u73af\u4e2d\u7684\u8fb9\u662f\u76f8\u540c\u7684\u4e00\u4e9b\u8fb9\uff0c\u6240\u4ee5\u4e0d\u80fd\u91cd\u590d\u8ba1\u7b97\u3002\n\n\u90a3\u4e48\uff0c\u6bcf\u4e00\u4e2a\u5faa\u73af\u5185\u90e8\u7684\u65b9\u6848\u6570\u5c31\u662f$2^{\\lfloor \\frac{a_i}{2}\\rfloor}$\u3002\n\n\uff08\u8fd9\u4e5f\u5c31\u662fyyb\u9898\u89e3\u4e2d\u8bf4\u7684\u201c\u4e00\u4e2an\u4e2a\u70b9\u7684\u5faa\u73af\u53ea\u6709$\\frac{n}{2}$\u4e2a\u8fb9\u7684\u5faa\u73af\u201d\u3002\uff09\n\n\u73b0\u5728\u8003\u8651\u5faa\u73af\u4e4b\u95f4\u7684\u8fde\u8fb9\u65b9\u6848\u6570\u3002\u4ece$m$\u4e2a\u5faa\u73af\u4e2d\u6311\u51fa\u4e24\u4e2a$a_i,a_j$\u6765\uff08$i < j$\uff09\uff0c\u8003\u8651\u5b83\u4eec\u4e4b\u95f4\u7684\u8fde\u8fb9\u3002\u4ecd\u7136\u4ece$a_i$\u5faa\u73af\u4e2d\u62ff\u51fa\u4e00\u4e2a\u70b9$k$\uff0c\u4ece$a_j$\u5faa\u73af\u4e2d\u62ff\u51fa\u4e00\u4e2a\u70b9$l$\u6765\u4f5c\u4e3a\u8003\u8651\u7684\u6838\u5fc3\uff0c\u5e76\u628a\u4e24\u4e2a\u5faa\u73af\u4e2d\u7684\u70b9\u90fd\u4e00\u5b57\u94fa\u5f00\u3002\n\n\u5982\u679c$k$\u548c$l$\u8fde\u4e86\u8fb9\uff0c\u90a3\u4e48$a_i$\u5faa\u73af\u4e2d$k$\u7684\u4e0b\u4e00\u4e2a\u4e5f\u8981\u548c$a_j$\u5faa\u73af\u4e2d$l$\u7684\u4e0b\u4e00\u4e2a\u8fde\u8fb9\uff0c$k$\u5f80\u540e\u4e24\u4e2a\u7684\u70b9\u4e5f\u8981\u548c$l$\u5f80\u540e\u4e24\u4e2a\u7684\u70b9\u8fde\u8fb9......\u8fd9\u6837\u4e24\u8fb9\u540c\u65f6\u6cbf\u7740\u5404\u81ea\u7684\u5faa\u73af\u8f6c\uff0c\u4e0d\u77e5\u9053\u8f6c\u4e86\u591a\u5c11\u5708\u4e4b\u540e\uff0c$k$\u70b9\u4e00\u5171\u5f80$a_j$\u5faa\u73af\u4e2d\u8fde\u4e86\u591a\u5c11\u6761\u8fb9\uff1f\u663e\u7136\uff0c$k$\u5f80$a_j$\u5faa\u73af\u4e2d\u6bcf\u9694$gcd(a_i,a_j)$\u6761\u8fb9\u7684\u8ddd\u79bb\u5c31\u4f1a\u8fde\u4e00\u6761\u8fb9\u8fc7\u53bb\uff0c\u4e00\u5171\u8fde\u4e86$\\frac{a_j}{gcd(a_i,a_j)}$\u6761\u3002\u8fd9\u6837\u6765\u8bf4\uff0c$a_j$\u5faa\u73af\u4e2d\u7684$a_j$\u4e2a\u70b9\uff0c\u4e00\u5171\u88ab\u5206\u4e3a\u4e86$gcd(a_i,a_j)$\u7ec4\uff0c\u6bcf\u4e00\u7ec4\u5305\u62ec\u4e86$\\frac{a_j}{gcd(a_i,a_j)}$\u4e2a\u70b9\uff0c\u8fd9\u4e9b\u70b9\u4e2d\uff0c\u6bcf\u76f8\u90bb\u7684\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684\u8ddd\u79bb\u90fd\u662f$gcd(a_i,a_j)$\u3002\u800c\u4e14\uff0c\u6bcf\u4e00\u7ec4\u8981\u4e48\u4e00\u8d77\u5411$k$\u8fde\u8fb9\uff0c\u8981\u4e48\u90fd\u4e0d\u5411$k$\u8fde\u8fb9\u3002\u90a3\u4e48\u603b\u8fde\u8fb9\u65b9\u6848\u81ea\u7136\u5c31\u662f$2^{gcd(a_i,a_j)}$\u3002\n\n\u7efc\u4e0a\u6240\u8ff0\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5212\u5206$a_1,a_2,...a_m$\uff0c\u8fd9\u4e2a\u5212\u5206\u5bf9\u5e94\u7684$G_i$\u4e2d\u5143\u7d20\u7684\u5171\u540c\u7684$|S_t|$\u503c\uff0c\u5c31\u662f\uff1a\n$$\n\\prod_{i=1}^m 2^{\\lfloor \\frac{a_i}{2}\\rfloor} \\prod _{i=1}^{m}\\prod_{j=i+1}^m 2^{gcd(a_i,a_j)}\n$$\n\u518d\u628a\u8fd9\u4e2a\u503c\u4e58\u4e0a$G_i$\u7684\u5143\u7d20\u7684\u4e2a\u6570\uff1a\n$$\n\\frac{n!}{(\\prod a_i)(\\prod b_x!)}\\prod_{i=1}^m 2^{\\lfloor \\frac{a_i}{2}\\rfloor} \\prod _{i=1}^{m}\\prod_{j=i+1}^m 2^{gcd(a_i,a_j)}\n$$\n\u5c31\u662f\u8fd9\u4e2a\u5212\u5206$a_1,a_2,...a_m$\u7684\u7b54\u6848\u4e86\u3002\n\n\u628a\u6240\u6709\u5212\u5206\u7684\u7b54\u6848\u52a0\u8d77\u6765\u4e4b\u540e\uff0c\u6839\u636eBurnside\u5b9a\u7406\u7684\u516c\u5f0f\uff0c\u8fd8\u8981\u4e58\u4e0a\u4e00\u4e2a$\\frac{1}{n!}$\u624d\u662f\u7b54\u6848\u3002\n\n\u800c\u8fd9\u4e2a$\\frac{1}{n!}$\u53ef\u4ee5\u4e0e\u4e0a\u9762\u5f0f\u5b50\u4e2d\u7684$n!$\u7ea6\u6389\u3002\u6240\u4ee5\u5982\u679c\u4f60\u591f\u61d2\uff0c\u5c31\u76f4\u63a5\u7b97\u5404\u4e2a\u5212\u5206\u7684\u8fd9\u4e2a\u5f0f\u5b50\u7684\u548c\uff1a\n$$\n\\frac{1}{(\\prod a_i)(\\prod b_x!)}\\prod_{i=1}^m 2^{\\lfloor \\frac{a_i}{2}\\rfloor} \\prod _{i=1}^{m}\\prod_{j=i+1}^m 2^{gcd(a_i,a_j)}\n$$\n\n\n\u628a\u6240\u6709$gcd(i,j)$\u9884\u5904\u7406\u51fa\u6765\u4f1a\u5feb\u4e00\u70b9\u3002\n\n```c++\n/*\n\u51e0\u4e2a\u9519\u8bef\u8c03\u8bd5\u4e86\u597d\u4e45\u3002\n*///using CRLF, UTF-8\n\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\n#define pr printf\n#define F(i, j, k) for(register int i = j, kkllkl = k; i <= kkllkl; ++i)\n#define G(i, j, k) for(register int i = j, kkllkl = k; i >= kkllkl; --i)\n#define clr(a, v) memset((a), v, sizeof(a))\nusing namespace std;\ntypedef long long ll;\n\n#define isd(x) (('0' <= (x) && (x) <= '9') || (x) == '-')\nint rd() {\n    int ans = 0, sign = 1; char c = getchar();\n    while(!isd(c)) c = getchar();\n    if(c == '-') sign = -1, c = getchar();\n    while(isd(c)) ans = (ans << 3) + (ans << 1) + c - '0', c = getchar();\n    return sign == 1 ? ans : -ans;\n}\n\n#define chkmin(x, y) ((x) = min((x), (y)))\n#define chkmax(x, y) ((x) = max((x), (y)))\n\n/* --------------------------------------------------- */\n\nconst int N = 65, MOD = 997;\nint Gcd(int x, int y) { return y ? Gcd(y, x % y) : x; }\nint fsp(int a, int x) {\n    int ans = 1;\n    for(; x; x >>= 1, a = a * a % MOD)\n        if(x & 1) ans = ans * a % MOD;\n    return ans;\n}\n\nint n, frac[N], ifrac[N], gcd[N][N], p2[N], inv[N];\n\nint a[N], m, b[N];\nint solve() {\n    // F(i, 1, m) pr(\"%d%c\", a[i], \" \\n\"[i == m]);\n    int ret = 1;\n    F(i, 1, m) ret = (ret * inv[a[i]]) % MOD;\n    F(i, 1, n) ret = (ret * ifrac[b[i]]) % MOD;\n    F(i, 1, m) ret = (ret * p2[a[i] / 2]) % MOD;\n    F(i, 1, m) F(j, i + 1, m) ret = (ret * p2[gcd[a[i]][a[j]]]) % MOD;\n    // pr(\"ret = %d\\n\", ret);\n    return ret;\n}\n\nint ans = 0;\nvoid dfs(int level, int sum) {\n    if(sum == n) {\n        m = level - 1;\n        ans = (ans + solve()) % MOD;\n        return ;\n    }\n    F(i, max(1, a[level - 1]), n - sum) {\n        a[level] = i;\n        ++b[i];\n        dfs(level + 1, sum + i);\n        --b[i];\n    }\n}\n\nint main() {\n    n = rd();\n    F(i, 1, n) inv[i] = fsp(i, MOD - 2);\n    frac[0] = 1;\n    F(i, 1, n) frac[i] = frac[i - 1] * i % MOD;\n    ifrac[n] = fsp(frac[n], MOD - 2);\n    G(i, n - 1, 0) ifrac[i] = ifrac[i + 1] * (i + 1) % MOD;\n    F(i, 1, n) F(j, 1, n) gcd[i][j] = Gcd(i, j);\n    p2[0] = 1;\n    F(i, 1, n) p2[i] = (p2[i - 1] * 2) % MOD;\n    dfs(1, 0);\n    pr(\"%d\\n\", ans);\n    return 0;\n}\n/*\n*/\n```\n\n",
        "postTime": 1601091938,
        "uid": 61904,
        "name": "lightmain",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4727 \u3010[HNOI2009]\u56fe\u7684\u540c\u6784\u8bb0\u6570\u3011"
    },
    {
        "content": "\u663e\u7136\u8981\u7528\u5230\u7fa4\u8bba\u3002\u3002\u3002\u548cP4128\u5f88\u50cf\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u628a\u539f\u95ee\u9898\u8f6c\u5316\u4e3a\u7528\u9ed1\u767d\u4e24\u79cd\u989c\u8272\u7ed9$n$\u4e2a\u70b9\u5f97\u5b8c\u5168\u56fe\u67d3\u8272\uff0c\u672c\u8d28\u4e0d\u540c\u5f97\u65b9\u6848\u6570\u3002\n\n\u5982\u679c\u662f\u70b9\u90a3\u597d\u6c42\uff0c\u8003\u8651\u600e\u4e48\u7528\u70b9\u7684\u7f6e\u6362\u6c42\u8fb9\n\n\u5bf9\u4e8e\u4e00\u6761\u8fb9\uff0c\u5b83\u7684\u4e24\u4e2a\u9876\u70b9\u53ef\u80fd\u5728\u540c\u4e00\u5faa\u73af\u5185\u4e5f\u53ef\u80fd\u5728\u4e0d\u540c\u5faa\u73af\u5185\u3002\u5bf9\u4e8e\u5728\u540c\u4e00\u5faa\u73af\u5185\u7684\u60c5\u51b5\uff0c\u4ed6\u7684\u8fb9\u6784\u6210\u4e86$n\\over2$\u4e2a\u5faa\u73af\u3002\u53ef\u4ee5\u7406\u89e3\u6210\u628a$n$\u4e2a\u70b9\u56f4\u6210\u4e00\u4e2a\u5706\uff0c\u90a3\u957f\u5ea6\u4e3a$x$\u548c$n-x$\u672c\u8d28\u662f\u4e00\u6837\u7684\u3002\n\n\u82e5\u5728\u4e0d\u540c\u5faa\u73af\u5185\uff0c\u8bbe\u5faa\u73af\u957f\u5ea6\u5206\u522b\u4e3a$x,y$\uff0c\u663e\u7136\u6bcf\u6761\u8fb9\u5728$lcm(x,y)$\u6b21\u7f6e\u6362\u4e4b\u540e\u4f1a\u56de\u5230\u81ea\u5df1\uff0c\u957f\u5ea6\u5373\u4e3a$lcm(x,y)$\u3002\u5faa\u73af\u6570\u5373\u662f${xy\\over lcm(x,y)}=\\gcd(x,y)$\n\n\u603b\u6570\u5c31\u662f\u628a\u4e24\u79cd\u60c5\u51b5\u52a0\u8d77\u6765\u3002\n\n\u8bbe\u8fb9\u7f6e\u6362\u603b\u6570\u4e3a$m$\uff0c\u5219\u4e0d\u52a8\u70b9\u6570\u91cf\u4e3a$2^m$\n\n\u70b9\u7f6e\u6362\u7684\u603b\u6570\u4e3a$n!$\uff0c\u76f4\u63a5\u679a\u4e3e\u663e\u7136\u4f1aT\u3002\u6bcf\u4e2a\u7f6e\u6362\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u53ea\u4f1a\u4e0e\u4ed6\u7684\u5927\u5c0f\u6709\u5173\u3002\u6211\u4eec\u53ea\u9700\u8981\u679a\u4e3e$n$\u7684\u62c6\u5206\u3002\u7ec4\u5408\u6570\u5b66\u7b97\u5c31\u597d\u4e86\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\n#include <cmath>\n\nusing namespace std;\n\nint n;\nconst int p = 997;\n\ntypedef long long ll;\n\ninline ll power(ll a, ll b, int p) {\n\tll t = 1, y = a, k = b;\n\twhile (k) {\n\t\tif (k & 1) t = (t * y) % p;\n\t\ty = (y * y) % p; k >>= 1;\n\t} return t;\n}\n\n// inv\n\nint inv[61], fac[61], invfac[61];\n\ninline void getinv() {\n\tinv[1] = 1;\n\tfor (int i = 2; i <= n; ++i)\n\t\tinv[i] = 1ll * (p - p / i) * inv[p % i] % p;\n\tfac[0] = invfac[0] = 1;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tfac[i] = 1ll * fac[i - 1] * i % p;\n\t\tinvfac[i] = 1ll * invfac[i - 1] * inv[i] % p;\n\t}\n}\n\nint ans = 0;\nint stk[1005], top = 0, cb = 1, up = 0;\n\ninline int min_(int a, int b) {\n\treturn a < b ? a : b;\n}\n\ninline int gcd(int a, int b) {\n\treturn !b ? a : gcd(b, a % b);\n}\n\ninline void dfs(int now, int mn, int c) {\n\tif (now == 0) {\n\t\tans = (ans + 1ll * cb * power(2, up, p)) % p;\n\t\treturn ;\n\t} int u = up, cc = cb;\n\tfor (int i = 1; i <= mn; ++i) {\n\t\tstk[++top] = i;\n\t\tup = u + i / 2;\n\t\tfor (int j = 1; j < top; ++j) up += gcd(stk[j], i);\n\t\tcb = (1ll * cc * inv[i]) % p;\n\t\tif (i == stk[top - 1]) cb = ((1ll * cb * fac[c]) % p * invfac[c + 1]) % p;\n\t\tdfs(now - i, min_(now - i, i), (i == stk[top - 1]) * c + 1);\n\t\t--top;\n\t}\n}\n\nint main() { \n\tscanf(\"%d\", &n);\n\tgetinv();\n\tdfs(n, n, 0);\n\tprintf(\"%d\", ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1595042461,
        "uid": 98096,
        "name": "Smallbasic",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4727 \u3010[HNOI2009]\u56fe\u7684\u540c\u6784\u8bb0\u6570\u3011"
    },
    {
        "content": "\u8fd9\u9898\u611f\u89c9\u50cf\u662f$Polya$\u8ba1\u6570\u3002\u3002\u3002\n\n\u7136\u540e\u501f\u9274\u4e86\u8fd9\u4f4d\u5927\u4f6c\u7684\u535a\u5ba2\u8bc1\u660e\u4e86\u8fd9\u9898\u662f$Polya$\u8ba1\u6570\uff1a[\u535a\u5ba2](https://blog.csdn.net/sdfzyhx/article/details/70035662)\n\n\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u95ee\u9898\u8f6c\u5316\u6210\u5728\u5b8c\u5168\u56fe\u4e0a\u5bf9\u8fb9\u8fdb\u884c\u9ed1\u767d\u67d3\u8272\uff0c\u6c42\u4e0d\u540c\u6784\u65b9\u6848\u6570\u3002 \n\n\u7136\u540e\u5c31\u8ddf\u8fd9\u9898\u5dee\u4e0d\u591a\u4e86\uff1a[P4128 [SHOI2006]\u6709\u8272\u56fe](https://www.luogu.org/problemnew/show/P4128)\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\u7684\u7f6e\u6362\uff0c\u8981\u6c42\u51fa\u6709\u591a\u5c11\u5173\u4e8e\u8fb9\u7684\u4e0d\u52a8\u70b9\u3002\n\n\u628a\u7f6e\u6362\u5199\u6210\u5faa\u73af\uff0c\u53ef\u4ee5\u53d1\u73b0\u4e24\u6761\u6027\u8d28\uff1a\n\n1. \u4e00\u4e2a\u957f\u5ea6\u4e3a$x$\u7684\u70b9\u7684\u5faa\u73af\u5185\u90e8\u6709$\\lfloor \\frac{x}{2}\\rfloor$\u4e2a\u8fb9\u7684\u5faa\u73af\u3002\n\n2. \u4e24\u4e2a\u957f\u5ea6\u5206\u522b\u4e3a$x$\u548c$y$\u7684\u70b9\u7684\u5faa\u73af\u4e4b\u95f4\u6709$gcd(x,y)$\u4e2a\u8fb9\u7684\u5faa\u73af\uff0c\u8fd9\u6837\u5173\u4e8e\u8fb9\u7684\u4e0d\u52a8\u70b9\u603b\u6570\u5c31\u662f$2m$\uff0c\u5176\u4e2d$m$\u8868\u793a\u8fb9\u7684\u5faa\u73af\u7684\u603b\u6570\u3002 \n\n\u4f46\u662f\u76f4\u63a5\u679a\u4e3e\u70b9\u7684\u7f6e\u6362\u6709$n!$\u79cd\uff0c$TLE$\u3002\n\n\u6211\u4eec\u8003\u8651\uff0c\u56e0\u4e3a\u6bcf\u79cd\u7f6e\u6362\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u53ea\u548c\u6bcf\u4e2a\u5faa\u73af\u7684\u5927\u5c0f\u6709\u5173\uff0c\u53ef\u4ee5\u679a\u4e3e$n$\u7684\u6b63\u6574\u6570\u62c6\u5206\uff0c\u7136\u540e\u5bf9\u6bcf\u79cd\u62c6\u5206\u8ba1\u7b97\u5bf9\u5e94\u7684\u7f6e\u6362\u4e2a\u6570\u3002\n\n\u5177\u4f53\u6765\u8bf4\uff0c\u8bb0\u6709$m$\u4e2a\u5faa\u73af\uff0c\u6bcf\u4e2a\u5faa\u73af\u7684\u957f\u5ea6\u4e3a$l_i$,\u6bcf\u4e2a\u957f\u5ea6\u7684\u5faa\u73af\u6709$c_i$\u4e2a\u3002\n\n\u9996\u5148\u7ed9\u6bcf\u4e2a\u5faa\u73af\u5206\u914d\u4e00\u4e2a\u4f4d\u7f6e\uff1a\n$$\\left(\\begin{array}{c}n\\\\l_1\\end{array}\\right)\\left(\\begin{array}{c}n-l_1\\\\l_2\\end{array}\\right)...\\left(\\begin{array}{c}n-l_1-l_2-...-l_{m-1}\\\\l_m\\end{array}\\right)$$\n\n\u7136\u540e\u56fa\u5b9a\u7b2c\u4e00\u4e2a\u5143\u7d20\uff0c\u6bcf\u4e2a\u5faa\u73af\u6709 $(l_i-1)!$ \u79cd\u6392\u6cd5\u3002\n\n\u4f46\u662f\u76f8\u540c\u957f\u5ea6\u7684\u5faa\u73af\u5f7c\u6b64\u4e4b\u95f4\u7684\u987a\u5e8f\u88ab\u91cd\u590d\u8003\u8651\u3002\n\n\u6240\u4ee5\u6700\u540e\u7684\u7b54\u6848\u5c31\u53ef\u6c42\u4e86\uff1a\n$$Ans=\\frac{n!}{\\prod_{i=1}^ml_i\\prod_{i=1}^mc_i}$$\n\n\u9664\u8f6c\u4e58\u76f4\u63a5\u9006\u5143\uff0c\u800c$997\\in prime$\uff0c\u6240\u4ee5\u76f4\u63a5\u8d39\u9a6c\u5c0f\u5b9a\u7406\u5373\u53ef\u3002\n\n\u9644\u4ee3\u7801\uff1a\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\n#define MAXN 70\n#define MOD 997\nusing namespace std;\nlong long n,ans=0;\nlong long val[MAXN],num[MAXN],fact[MAXN],inv[MAXN],invfact[MAXN],gcd[MAXN][MAXN];\ninline long long read(){\n    long long date=0,w=1;char c=0;\n    while(c<'0'||c>'9'){if(c=='-')w=-1;c=getchar();}\n    while(c>='0'&&c<='9'){date=date*10+c-'0';c=getchar();}\n    return date*w;\n}\nlong long Gcd(long long x,long long y){//\u8bb0\u5fc6\u5316gcd\n    if(gcd[x][y])return gcd[x][y];\n    else if(!y)return x;\n    return Gcd(y,x%y);\n}\nlong long mexp(long long a,long long b,long long c){//\u5feb\u901f\u5e42\u5e94\u8be5\u90fd\u4f1a\n    long long s=1;\n    while(b){\n        if(b&1)s=s*a%c;\n        a=a*a%c;\n        b>>=1;\n    }\n    return s;\n}\nvoid get_answer(){//\u7d2f\u8ba1\u7b54\u6848\n    int top=0;\n    long long sum=0,now=fact[n];\n    for(int i=1;i<=n;i++){\n        now=now*invfact[num[i]]%MOD;\n        for(int j=1;j<=num[i];j++){\n            val[++top]=i;\n            now=now*inv[i]%MOD;\n        }\n    }\n    for(int i=1;i<=top;i++){\n        sum+=val[i]/2;\n        for(int j=i+1;j<=top;j++)sum+=gcd[val[i]][val[j]];\n    }\n    now=now*mexp(2,sum,MOD)%MOD;\n    ans=(ans+now)%MOD;\n}\nvoid dfs(int x,int s){//\u76f4\u63a5\u66b4\u641c\n    if(x==1){\n        num[1]=n-s;\n        get_answer();\n        return;\n    }\n    for(int i=0;s+i*x<=n;i++){\n        num[x]=i;\n        dfs(x-1,s+i*x);\n        num[x]=0;\n    }\n}\nvoid work(){\n    dfs(n,0);\n    ans=ans*invfact[n]%MOD;//\u522b\u5fd8\u4e86\uff01\n    printf(\"%lld\\n\",ans);\n}\nvoid init(){//\u9884\u5904\u7406\u9636\u4e58\u3001\u9006\u5143\u3001gcd\n    n=read();\n    fact[0]=invfact[0]=1;\n    for(int i=1;i<=n;i++){\n        fact[i]=fact[i-1]*i%MOD;\n        inv[i]=mexp(i,MOD-2,MOD);\n        invfact[i]=mexp(fact[i],MOD-2,MOD);\n    }\n    for(int i=1;i<=n;i++)\n    for(int j=1;j<=n;j++)\n    gcd[i][j]=Gcd(i,j);\n}\nint main(){//\u4e3b\u51fd\u6570So easy!\n    init();\n    work();\n    return 0;\n}\n\n```",
        "postTime": 1532859684,
        "uid": 49998,
        "name": "\u65af\u5fb7\u54e5\u5c14\u6469",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4727 \u3010[HNOI2009]\u56fe\u7684\u540c\u6784\u8bb0\u6570\u3011"
    },
    {
        "content": "Update on 2023.4.1\uff1a\u611f\u8c22 [TernaryTree](https://www.luogu.com.cn/user/362750)\u3002\n\n------------\n\n**\u53cc\u500d\u7ecf\u9a8c\uff1a[P4128 [SHOI2006] \u6709\u8272\u56fe](https://www.luogu.com.cn/problem/P4128)\u3002**\n\n------------\n\n\u6ce8\u610f\u5230\u6211\u4eec\u5e76\u4e0d\u5173\u5fc3\u8fb9\u7684\u8fde\u901a\u6027\u7b49\u4fe1\u606f\uff0c\u800c\u53ea\u5173\u5fc3\u8fb9\u5b58\u4e0d\u5b58\u5728\u3002\n\n\u8003\u8651\u5c06\u8fde\u4e0a\u7684\u8fb9\u6807\u6210\u9ed1\u8272\u3001\u6ca1\u8fde\u7684\u8fb9\u6807\u6210\u767d\u8272\uff0c\u5219\u8f6c\u5316\u6210\u4e86\u4e0a\u9762\u90a3\u9053\u9898 $m = 2, p = 997$ \u7684\u60c5\u51b5\u3002\n\n~~\u4e8e\u662f\u5c31\u53ef\u4ee5\u628a\u4ee3\u7801\u7c98\u8fc7\u6765\uff0c\u7136\u540e\u6539\u4e24\u53e5\u8bdd\u5c31\u884c\u3002~~\n\n------------\n\n\u672c\u9898\u4e2d\u6211\u4eec\u7684\u7f6e\u6362\u7fa4\u4e3a\u6240\u6709\u957f\u4e3a $n$ \u7684\u7f6e\u6362\uff0c\u8868\u793a\u70b9\u91cd\u7f16\u53f7\u7684\u7ed3\u679c\u3002\n\n\u4f46\u662f\u672c\u9898\u4e2d\u6211\u4eec\u662f**\u5bf9\u8fb9\u67d3\u8272**\uff0c\u8003\u8651\u5982\u4f55\u7b97\u4e0d\u52a8\u70b9\u6570\u91cf\u3002\u7c7b\u4f3c\u4e8e\u70b9\u67d3\u8272\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u53ea\u9700\u8981\u77e5\u9053\u8fb9\u7684\u7b49\u4ef7\u7c7b\u4e2a\u6570\u5373\u53ef\u3002\n\n\u8003\u8651\u6293\u51fa\u8fd9\u4e2a\u7f6e\u6362\u7684\u6240\u6709\u73af\uff08\u8bbe\u73af\u957f\u4e3a $cnt_1, cnt_2, \\cdots, cnt_k$\uff09\uff0c\u7136\u540e\u6765\u8ba8\u8bba\u7b49\u4ef7\u7c7b\uff1a\n\n- \u73af\u5185\u5230\u73af\u5185\uff1a\u6b64\u65f6\u6211\u4eec\u53ea\u5173\u5fc3\u4e24\u70b9\u5728\u73af\uff08\u8bbe\u4e3a $i$\uff09\u4e0a\u7684\u8ddd\u79bb\uff0c\u800c\u8fd9\u4e2a\u8ddd\u79bb $\\leq \\lfloor \\frac{cnt_i}{2} \\rfloor$\uff0c\u5219\u65b9\u6848\u6570\u4e3a $\\lfloor \\frac{cnt_i}{2} \\rfloor$\u3002\n- \u73af\u5185\u5230\u73af\u5916\uff1a\u6b64\u65f6\u6211\u4eec\u53ea\u5173\u5fc3\u4e24\u4e2a\u73af\uff08\u8bbe\u4e3a $i, j$\uff09\u7684\u5927\u5c0f\uff0c\u800c\u4ece\u4efb\u610f\u4e00\u4e2a\u72b6\u6001\u51fa\u53d1\u5728\u4e24\u4e2a\u73af\u4e0a\u6bcf\u6b21\u5b9a\u5411\u524d\u8fdb\u4e00\u6b65\uff0c\u56de\u5230\u539f\u70b9\u6240\u9700\u6b65\u6570\u5747\u4e3a $\\operatorname{lcm}(cnt_i, cnt_j)$\uff0c\u5219\u672c\u8d28\u4e0d\u540c\u4e2a\u6570\u4e3a $\\gcd(cnt_i, cnt_j)$\u3002\n\n\u7efc\u4e0a\uff0c\u4e0d\u52a8\u70b9\u6570\u91cf\u4e3a $2^{\\sum_{i = 1}^k \\lfloor \\frac{cnt_i}{2} \\rfloor  + \\sum_{i = 1}^{k - 1} \\sum_{j = i + 1}^k \\gcd(cnt_i, cnt_j)}$\u3002\n\n\u6ce8\u610f\u5230 $n$ \u5f88\u5c0f\uff0c\u5219\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u679a\u4e3e $n$ \u7684\u62c6\u5206\u6570\uff0c\u5bf9\u6bcf\u79cd\u65b9\u6848\u8ba1\u7b97\u4e0a\u9762\u8fd9\u4e2a\u4e1c\u897f\uff0c\u7136\u540e\u518d\u4e58\u4e0a\u65b9\u6848\u6570\uff0c\u5373 $\\dfrac{n!}{\\displaystyle\\prod_{i = 1}^k cnt_i \\displaystyle\\prod_{\\text{There exists i item j that } cnt_j = t} i!}$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n \\operatorname{Partition}(n) \\log n)$\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <stdio.h>\n\ntypedef long long ll;\n\nconst int mod = 997;\nint cnt1[67], cnt2[67];\nll inv[67];\n\ninline ll quick_pow(ll x, ll p, ll mod){\n\tll ans = 1;\n\twhile (p){\n\t\tif (p & 1) ans = ans * x % mod;\n\t\tx = x * x % mod;\n\t\tp >>= 1;\n\t}\n\treturn ans;\n}\n\ninline void init(int n){\n\tinv[0] = inv[1] = 1;\n\tfor (int i = 2; i <= n; i++){\n\t\tinv[i] = mod - (mod / i) * inv[mod % i] % mod;\n\t}\n}\n\ninline int max(int a, int b){\n\treturn a > b ? a : b;\n}\n\nint gcd(int a, int b){\n\treturn b == 0 ? a : gcd(b, a % b);\n}\n\nll dfs(int cur, int lst, int pre, int sum){\n\tif (lst == 0) return quick_pow(2, sum, mod);\n\tint cur_i = cur + 1;\n\tll ans = 0;\n\tfor (int i = max(pre, 1); i <= lst; i++){\n\t\tint cur_sum = sum + i / 2;\n\t\tcnt1[cur] = i;\n\t\tif (i == pre){\n\t\t\tcnt2[cur] = cnt2[cur - 1] + 1;\n\t\t} else {\n\t\t\tcnt2[cur] = 1;\n\t\t}\n\t\tfor (int j = 1; j < cur; j++){\n\t\t\tcur_sum += gcd(cnt1[j], i);\n\t\t}\n\t\tans = (ans + dfs(cur_i, lst - i, i, cur_sum) * inv[i] % mod * inv[cnt2[cur]] % mod) % mod;\n\t}\n\treturn ans;\n}\n\nint main(){\n\tint n;\n\tscanf(\"%d\", &n);\n\tinit(n);\n\tprintf(\"%lld\", dfs(1, n, 0, 0));\n\treturn 0;\n}\n```",
        "postTime": 1680360232,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P4727 \u3010[HNOI2009] \u56fe\u7684\u540c\u6784\u8ba1\u6570\u3011"
    }
]
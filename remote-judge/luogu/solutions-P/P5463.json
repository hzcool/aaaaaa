[
    {
        "content": "\u8003\u8651\u4e00\u7ec4\u9006\u5e8f\u5bf9$(a[i],a[j])$\u8d21\u732e\u4e86\u51e0\u6b21,\u4e0d\u96be\u53d1\u73b0\u8d21\u732e\u4e86$i*(n - j + 1)$\u6b21\u3002\n\n\u8003\u8651\u600e\u4e48\u7edf\u8ba1\uff0c\u901a\u5e38\u6c42\u9006\u5e8f\u5bf9\u6211\u4eec\u662f\u8ba9\u6811\u72b6\u6570\u7ec4\u4e0a\u7684\u503c$+1$\uff0c\u73b0\u5728\u6211\u4eec\u5b9e\u9645\u4e0a\u53ea\u8981\u628a$+1$\u6539\u6210$+(n - j + 1)$\u5c31\u884c\u4e86\uff08\u60f3\u60f3\u4e58\u6cd5\u5206\u914d\u5f8b\u5c31\u77e5\u9053\u8fd9\u662f\u5bf9\u7684\uff09\u3002\n\n\u90a3\u4e48\u63a5\u4e0b\u6765\u5c31\u662f\u5e38\u89c4\u7684\u79bb\u6563\u5316\u52a0\u6811\u72b6\u6570\u7ec4\u8fa3~\n\n\uff08\u7b54\u6848\u4f1a\u7206$longlong$,\u6211\u5077\u61d2\u5199\u4e86\u4e2a$int128$\u5c31\u6b27\u514b\u4e86QWQ)\n\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef __int128 ll;\nconst ll maxn=1000010;\nconst ll INF=2147483647;\nll n,a[maxn],b[maxn],c[maxn],tot,res,f[maxn];\ninline ll read()\n{\n\tll x=0,f=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9')\n\t{\n\t\tif(ch=='-')f=-1;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0'&&ch<='9')\n\t{\n\t\tx=(x<<3)+(x<<1)+ch-'0';\n\t\tch=getchar();\n\t}\n\treturn x*f;\n}\ninline void write(ll x)\n{\n\tif(x<0)\n\t{\n\t\tputchar('-');\n\t\tx=-x;\n\t}\n\tif(x>9)\n\t{\n\t\twrite(x/10);\n\t}\n\tputchar(x%10+'0');\n}\nll lowbit(ll x)\n{\n\treturn x & (-x);\n}\nvoid update(ll x,ll det)\n{\n\twhile(x <= n)\n\t{\n\t\tf[x] += det;\n\t\tx += lowbit(x);\n\t}\n\treturn;\n}\nll qry(ll x)\n{\n\tll tem = 0;\n\tx--;\n\twhile(x)\n\t{\n\t\ttem += f[x];\n\t\tx -= lowbit(x);\n\t}\n\treturn tem;\n}\nint main()\n{\n\tn = read();\n\tfor(int i = 1;i <= n;i++)\n\t{\n\t\ta[i] = read();\n\t\tb[i] = a[i];\n\t}\n\tsort(b + 1,b + n + 1);\n\ttot = unique(b + 1,b + n + 1) - b - 1;\n\tfor(int i = 1;i <= n;i++)\n\t{\n\t\tc[i] = lower_bound(b + 1,b + tot + 1,a[i]) - b;\n\t}\n\tfor(int i = n;i >= 1;i--)\n\t{\n\t\tll item = i;\n\t\tll idet = n - i + 1;\n\t\tres += (ll)(item * qry(c[i]));\n\t\tupdate(c[i],idet);\n\t}\n\twrite(res);\n\treturn 0;\n}\n```\n",
        "postTime": 1563102282,
        "uid": 64166,
        "name": "Frozencode",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5463 \u3010\u5c0f\u9c7c\u6bd4\u53ef\u7231\uff08\u52a0\u5f3a\u7248\uff09\u3011"
    },
    {
        "content": "[\u5199\u535a\u5ba2\u4e0d\u6613\uff0c\u6765\u73a9\u4f1a\uff1f](https://www.cnblogs.com/lost-in-tianyi/p/11186213.html)\n\n## \u8fd9\u9053\u9898\u6211\u548c$dalao$\u4eec\u7684\u505a\u6cd5\u7565\u6709\u4e0d\u540c\uff0c\u6211\u7528\u7684\u662f\u5f52\u5e76\u6392\u5e8f\u505a\u6cd5$qwq$\n\n\u5f52\u5e76\u6392\u5e8f\u6c42\u9006\u5e8f\u5bf9\u5927\u5bb6\u5e94\u8be5\u5f88\u6e05\u695a\u4e86\uff0c\u6211\u8fd9\u91cc\u5c31\u6765\u8bb2\u8bb2\u5982\u4f55\u7528\u5f52\u5e76\u6392\u5e8f\u6c42\u51fa\u8fd9\u9053\u9898\u7684\u7b54\u6848\n\n\u8ba9\u6211\u4eec\u5148\u89c2\u5bdf\u4e00\u4e0b\u89c4\u5f8b\n\n\u4e3e\u4e2a\u6817\u5b50\uff0c\u82e5\u5b58\u5728\u4e00\u7ec4\u9006\u5e8f\u5bf9$a[3],a[4]$\uff0c$n = 5$\uff0c\u5219\u8fd9\u7ec4\u9006\u5e8f\u5bf9\u5b58\u5728\u4e8e\u4ee5\u4e0b\u533a\u95f4\u5185\uff1a$[1 , 4],[1,5],[2,4],[2,5],[3,4],[3,5]$\uff0c\u5171$6$\u4e2a\u3002\u6211\u4eec\u53ef\u4ee5\u753b\u4e2a\u56fe\u5e2e\u52a9\u7406\u89e3\uff1a\n\n![\u6355\u83b7.png](https://i.loli.net/2019/07/14/5d2b39c0531e712528.png)\n\n\u5c06\u5176\u63a8\u5e7f\uff0c\u82e5\u6709\u9006\u5e8f\u5bf9$a[l],a[r]$\uff0c\u5982\u56fe\u6240\u793a\uff1a\n\n![\u6355\u83b7.png](https://i.loli.net/2019/07/14/5d2b3aa41cb0622917.png)\n\n\u5219\u5305\u542b\u5176\u7684\u533a\u95f4\u6570\uff0c\u5373\u8be5\u533a\u95f4\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e3a$(l + 1 - 1) * (n - r + 1  ) = l * (n-r+1)$\u3002\n\n\u7136\u540e\u518d\u7528\u5f52\u5e76\u6392\u5e8f\u5373\u53ef\u3002\n\n\u6ce8\u610f\u4e24\u4e2a\u70b9\uff1a\n\n$1.$\u672c\u9898\u8981\u7528\u4e00\u4e2a\u7c7b\u4f3c\u524d\u7f00\u548c\u7684\u53d8\u91cf\u6765\u8bb0\u5f55\u6240\u6709\u5de6\u534a\u8fb9\u7684\u4f4d\u7f6e\u4e4b\u548c\uff0c\u641c\u5230\u7684\u65f6\u5019\u518d\u4ece$sum$\u4e2d\u51cf\u53bb\uff0c\u5426\u5219\u4f1aT\uff08\u81f3\u5c11\u6211T\u4e86\uff09\n\n$2.$\u4f1a\u7206\u7cbe\u5ea6\u3002\u8bb0\u5f97\u5f00__$int$ $128$\u6216\u8005\u6253\u9ad8\u7cbe\uff08\u53cd\u6b63\u6211\u5f00\u7684__$int$ $128$ $qwq$\uff09\n\n### code\uff1a\n```cpp\n// Author : Kasugano_Sora\n#include<bits/stdc++.h>\nusing namespace std;\nstruct item\n{\n    int pl , val;\n} a[1100000] , b[1100000];\nint n;\n__int128 ans;\ninline __int128 read()\n{\n    __int128 x = 0 , f = 1;\n    char ch = getchar();\n    while(ch < '0' || ch > '9')\n    {\n        if(ch == '-')\n            f = -1;\n        ch = getchar();\n    }\n    while(ch >= '0' && ch <= '9')\n    {\n        x = x * 10 + ch - '0';\n        ch = getchar();\n    }\n    return x * f;\n}\n\ninline void print( __int128 x )    //int 128\u5fc5\u5907\u64cd\u4f5c\n{\n    if(x < 0)\n    {\n        putchar('-');\n        x = -x;\n    }\n    if(x > 9)\n        print(x / 10);\n    putchar(x % 10 + '0');\n}\nvoid msort( int l , int r )\n{\n    if(l == r)\n    return ;\n    int mid = (l + r) >> 1;\n    msort(l , mid);\n    msort(mid + 1 , r);\n    long long sum = 0LL;        //\u6240\u8c13\u7684\u524d\u7f00\n    for(int i = l ; i <= mid ; i++ )\n    {\n        sum += 1ll * a[i].pl;\n    }\n    int i = l , j = mid + 1 , k = l;\n    while(1)        //\u5f52\u5e76\n    {\n        if(i > mid || j > r)\n        break;\n        if(a[i].val <= a[j].val)\n        sum -= 1ll * a[i].pl , b[k++] = a[i++];\n        else\n        {\n            ans += sum * 1ll * (n - a[j].pl + 1);\n            b[k++] = a[j++];\n        }\n    }\n    if(i > mid) for( ; j <= r ; j++ , k++ )\n    {\n        b[k] = a[j];\n    }\n    else for( ; i <= mid ; i++ , k++ )\n    {\n        b[k] = a[i];\n    }\n    for(int i = l ; i <= r ; i++ )\n    {\n        a[i] = b[i];\n    }\n    return ;\n}\nint main()\n{\n//  freopen(\"1.txt\" , \"r\" , stdin);\n    cin >> n;\n    for(int i = 1 ; i <= n ; i++ )\n    {\n        scanf(\"%d\" , &a[i].val);\n        a[i].pl = i;\n    }\n    msort(1 , n);\n    print(ans);\n    return 0;\n}\n```\n",
        "postTime": 1563114865,
        "uid": 116368,
        "name": "BinDir0",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5463 \u3010\u5c0f\u9c7c\u6bd4\u53ef\u7231\uff08\u52a0\u5f3a\u7248\uff09\u3011"
    },
    {
        "content": "\u4e24\u7bc7\u9898\u89e3\u90fd\u662f\u7528\u7684\u6811\u72b6\u6570\u7ec4\uff0c\u90a3\u6211\u6765\u4e00\u7bc7\u5f52\u5e76\u6392\u5e8f\u7684\u5427\uff08\u6211\u89c9\u5f97\u5f52\u5e76\u5b9e\u5728\u6bd4\u6811\u72b6\u6570\u7ec4\u597d\u60f3\u5f97\u591a\uff09\n\n\u9996\u5148\uff0c\u5982\u679c\u8981\u628a$n * (n+1)/2$\u4e2a\u533a\u95f4\u7684\u9006\u5e8f\u5bf9\u5168\u90e8\u5206\u522b\u6c42\u51fa\u6765\uff0c\u663e\u7136\u662f\u4e0d\u53ef\u80fd\u7684\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u8003\u8651\u628a\u95ee\u9898\u62c6\u5206\uff0c\u8bbe\u539f\u6570\u5217\u4e3aa,\u8003\u8651\u6bcf\u4e2a\u9006\u5e8f\u5bf9\u3002\u4e0d\u96be\u53d1\u73b0\uff0c\u82e5\u5b58\u5728\u9006\u5e8f\u5bf9k={ai,aj},\u90a3\u4e48\u80fd\u4f7f\u5f97$k\u2286C\u2286U$\u7684\u533a\u95f4C\u5c31\u4f1a\u6709$i * (n-j+1)$\u4e2a\uff0c\u8fd9\u5c31\u662f\u6bcf\u4e2a\u9006\u5e8f\u5bf9\u5bf9\u7b54\u6848\u4ea7\u751f\u7684\u8d21\u732e\n\n\u518d\u8003\u8651\u5f52\u5e76\u6392\u5e8f\u6c42\u9006\u5e8f\u5bf9\u7684\u672c\u8d28\uff0c\u5176\u5b9e\u5c31\u662f\u901a\u8fc7\u4e24\u4e2a\u5e8f\u5217\u7684\u975e\u4e25\u683c\u5355\u8c03\u6027\u6c42\u51fa\u9006\u5e8f\u5bf9\u4e2a\u6570\uff0c\u800c\u8fd9\u91cc\u6211\u4eec\u9700\u8981\u8ba1\u7b97\u7684\u662f\u9006\u5e8f\u5bf9\u4ea7\u751f\u7684\u8d21\u732e,\u6240\u4ee5\u5bf9\u4e8e\u6bcf\u6b21\u5408\u5e76\u533a\u95f4$[ l , r ]$,\u5728\u7edf\u8ba1\u7b54\u6848\u6570\u91cf\u9047\u5230\u9006\u5e8f\u5bf9$(ai,aj)$\u65f6,$ans$+=$\\sum_{k=i}^{mid}sub[k] * (n-sub[j]+1)$\u5373\u53ef\uff0c\u5176\u4e2dsub\u662f\u6570\u5217a\u4e2d\u6bcf\u4e2a\u6570\u5728\u539f\u672c\u7684\u6570\u5217\u4e2d\u7684\u4e0b\u6807\n\n\u6bcf\u6b21\u5408\u5e76\u533a\u95f4\u7684\u65f6\u5019\u8dd1\u4e00\u904d\u524d\u7f00\u548c\u5c31\u662f\u7684\u4e86\uff0c\u8fd9\u6837\u590d\u6742\u5ea6\u8fd8\u662f$O(nlogn)$\u7684\n\n#### \u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define N 1000010\n#define Pn printf(\"\\n\")\n#define int __int128\n//\u8bb0\u5f97\u7528int128\uff0clonglong\u4f1a\u70b8\u3002\u3002\u3002\uff08\u5f53\u7136\u624b\u6253\u9ad8\u7cbe\u6700\u597d\uff09\nusing namespace std;\n\ninline int read(){\n    int x=0;char c=getchar();bool y=1;\n    for(;c<'0' || c>'9';c=getchar()) if(c=='-') y=0;\n    for(;c>='0' && c<='9';c=getchar()) x=(x<<1)+(x<<3)+c-48;\n    if(y) return x;\n    return -x;\n}\n\nint a[N][2],n,m,hc[N][2];\nint ans;\nint sum[N];\n\nvoid gb(int x,int y){\n    if(y==x) return;\n    int mid=(x+y)>>1;\n    gb(x,mid);\n    gb(mid+1,y);\n\n    int i=x,j=mid+1;\n\n    sum[mid]=a[mid][1];\n    for(int i0=mid-1;i0>=x;i0--)//\u524d\u7f00\u548c\u7edf\u8ba1\n        sum[i0]=sum[i0+1]+a[i0][1];\n    for(int k=x;k<=y;k++)//\u5f52\u5e76\u6392\u5e8f\uff0c\u8ba1\u7b97\u51fa\u6bcf\u4e2a\u9006\u5e8f\u5bf9\u7684\u8d21\u732e\n    {\n        if(j>y || i<=mid && a[i][0]<=a[j][0]) hc[k][0]=a[i][0],hc[k][1]=a[i][1],i++;\n        else {if(i<=mid) ans+=sum[i]*(n-a[j][1]+1);/*\u8ba1\u7b97\u9006\u5e8f\u5bf9\u6570\u65f6\u8fd9\u91cc\u662fans+=mid-i+1,\u7531\u6b64\u63a8\u51fa\u73b0\u5728\u7684ans\u7684\u8ba1\u7b97\u65b9\u6cd5*/hc[k][0]=a[j][0],hc[k][1]=a[j][1],j++;}\n    }\n    for(int i0=x;i0<=y;i0++)\n    a[i0][0]=hc[i0][0],a[i0][1]=hc[i0][1];\n    return;\n}\n\ninline void write(int x)\n{\n    if(x<0)\n        putchar('-'),x=-x;\n    if(x>9)\n        write(x/10);\n    putchar(x%10+'0');\n}\n\nsigned main(){\n    n=read();\n    for(int i=1;i<=n;i++)\n    a[i][0]=read(),a[i][1]=i;\n    for(int i=1;i<=n;i++);\n    gb(1,n);\n    write(ans);\n    return 0;\n}\n```\n",
        "postTime": 1563149628,
        "uid": 55357,
        "name": "Thaumaturge",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5463 \u3010\u5c0f\u9c7c\u6bd4\u53ef\u7231\uff08\u52a0\u5f3a\u7248\uff09\u3011"
    },
    {
        "content": "### \u9898\u610f\uff1a\n\n**\u7edf\u8ba1\u6240\u6709\u533a\u95f4\u7684\u9006\u5e8f\u5bf9\u6570**\n\n### \u5206\u6790\uff1a\n\n\u4e00\u770b\u5230\u201c\u7edf\u8ba1\u6240\u6709\u533a\u95f4\u7684xxxx\u201d\n\n\u5e38\u7528\u7684\u5957\u8def\u81ea\u7136\u662f  **\u8d21\u732e\u6cd5**\n\n\u9996\u5148,\u672c\u9898\u9006\u5e8f\u5bf9\u7684\u5b9a\u4e49\u6ca1\u6709\u53d8\n\n\u6240\u4ee5\u9006\u5e8f\u5bf9\u7684\u6570\u91cf\u8fd8\u662f\u90a3\u4e48\u591a\n\n\u8003\u8651\u6211\u4eec\u627e\u4e86\u4e00\u7ec4$(L,R)$\n\n\u6ee1\u8db3 $A[L]>A[R],L<R$\t\u8bb0\u8fd9\u6837\u7684$(L,R)$\t\u4e3a\u4e00\u7ec4\u9006\u5e8f\u5bf9\n\n\u6211\u4eec\u8003\u8651\u4ed6\u53ef\u80fd\u5bf9\u7b54\u6848\u4ea7\u751f\u7684\u8d21\u732e\n\n\u5bb9\u6613\u53d1\u73b0\n\n$\\forall x\\in [1,L],y\\in[R,n]$ \u533a\u95f4$[x,y]$\u90fd\u5305\u542b\u4e86\u9006\u5e8f\u5bf9$(L,R)$ \n\n\u6839\u636e**\u4e58\u6cd5\u539f\u7406**\n\n \u9006\u5e8f\u5bf9$(L,R)$ \u5bf9\u7b54\u6848\u4ea7\u751f\u7684\u8d21\u732e\u4e3a $L*(n-R+1)$\n\n\u4e8e\u662f\n\n$ans =\\sum_{i=1}^n \\ \\sum_{j=1,i<j,A[i]>A[j]}^n i*(n-j+1)$\n\n\u81f3\u6b64\uff0c\u6211\u4eec\u5df2\u7ecf\u6709\u4e86\u4e00\u4e2a\n\n### 60\u5206\u7684\u5b8c\u7f8e\u505a\u6cd5\uff1a\n\n```cpp\nfor(int i=1;i<=n;++i)\n\tfor(int j=L+1;j<=n;++j)\n\t\tif(a[i]>a[j])\tans +=i*(n-j+1);\n```\n\n~~\u4e8b\u5b9e\u4e0a\uff0c\u4f60\u60f3\u51fa\u4e86\u6b63\u89e3\u9ad8\u7cbe\u5199\u6302\u4e5f\u662f60\u5206~~\n\n### \u6b63\u89e3\uff1a\n\n\u8003\u8651\u5982\u4f55\u9ad8\u6548\u7684\u7ef4\u62a4$(1)$\u5f0f\n\n\u80af\u5b9a\u7528\u6570\u636e\u7ed3\u6784\u554a\n\n\u6811\u72b6\u6570\u7ec4\u6c42\u9006\u5e8f\u5bf9\u4f60\u4eec\u4f1a\u5427\n[\u4e0d\u4f1a\u7684\u70b9\u6211\u53bb\u5b66\u4e60\u4e00\u4e0b](https://www.luogu.org/problemnew/show/P1774)\n\n\u7b80\u5355\u63d0\u4e00\u4e0b\n\n\u503c\u57df$1e9$,\u5148**\u79bb\u6563\u5316** \u8bb0\u6700\u5927\u503c\u4e3a$m$\n\n\u4e4b\u540e\u7edf\u8ba1\u7684\u65f6\u5019\u5c06$A_i$\u63d2\u5165BIT \n\n\u5411\u540e\u67e5\u8be2$[Ai+1,m]$ \u8fd9\u4e00\u6bb5\u533a\u95f4\n\n\u5982\u4f55\u5e94\u5bf9\u8fd9\u4e2a\u9898\uff1f\n\n\u9996\u5148\u6211\u4eec\u53ea\u7528\u4e00\u91cd\u5faa\u73af,\u8bb0\u5f53\u524d\u5904\u7406\u5230\u7684\u6570\u4e3a$i$\n\n$(n-i+1)$\u8fd9\u4e00\u9879\u6211\u4eec\u80af\u5b9a\u662f\u5f88\u96be\u641e\u7684\uff0c\u800c\u4e14\u8ddfi\u524d\u9762\u7684\u503c\u6ca1\u6709\u5173\u7cfb\uff0c\u8003\u8651\u63d0\u5230\u5f0f\u5b50\u5916\u9762\n\n\u91cd\u70b9\u5c31\u662f\u6211\u4eec\u5982\u4f55\u5904\u7406i\u524d\u9762\u7684\u4e58\u79ef\u9879\n\n~~\u786e\u5b9a\u4e0d\u81ea\u5df1\u601d\u8003\u4e00\u4e0b\u561b~~\n \n\n\u6211\u4eec\u5728\u63d2\u5165\u7684\u65f6\u5019,\u4e0d\u662f\u63d2\u5165(A[i],1)\uff0c\u800c\u662f\u5c06\u6743\u503c\u63d2\u5165\u8fdb\u53bb\u5c31\u53ef\u4ee5\u4e86\n\n\u8c03\u7528`add(A[i],i)`\u5373\u53ef\n\n\n\n\u8fd8\u6709\u4e00\u4ef6\u6076\u5fc3\u5230\u6bc1\u5929\u706d\u5730\u7684\u4e8b\u60c5,\u8fd9\u9898\u7684\u7b54\u6848\u53ef\u4ee5\u8fbe\u5230$n^4$\u8d85\u8fc7\u4e86long long \n\n\u9700\u8981\u624b\u5199\u9ad8\u7cbe\n\n\u7531\u4e8e\u6211\u4e0d\u4f1a\u6253py\u7684\u6811\u72b6\u6570\u7ec4\uff0c\u5c31\u7528 **int128**\u6c34\u8fc7\u53bb\u4e86\n\n## AC\u4ee3\u7801:\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\nconst int N =2e6;\ntypedef __int128 ll;\nll a[N],b[N],n,m,c[N];\n\ninline int read(){\n    int x;scanf(\"%d\",&x);return x;\n}\ninline void print(ll x){\n\tif(x>9)\tprint(x/10);\n\tputchar(x%10+48);\n}\t//int128\u53ea\u80fd\u624b\u5199\u8f93\u51fa\n\ninline void add(int x,ll v){\n    for(;x<=m;x +=x&-x)\tc[x] +=v;\n}\ninline ll sum(int x){\n    ll ans =0;\n    for(;x;x -=x&-x)\tans +=c[x];\n    return ans;\n}\t//\u6811\u72b6\u6570\u7ec4 \n\nint main(){\n    n =read();\n    for(int i=1;i<=n;++i)   a[i] =b[i] =read();\n    \n    sort(b+1, b+n+1);\n    m = unique(b+1,b+n+1)-b-1;\n    for (int i=1;i<=n;++i)\ta[i] = lower_bound(b+1,b+m+1,a[i])-b;\t//\u79bb\u6563\u5316\u4e09\u884c \n    \n    ll ans =0;\n    for(int i=1;i<=n;++i){\n    \tadd(a[i],i);\n    \tans += 1LL *(n-j+1) *(sum(m)-sum(a[i]) ;\n    }\tprint(ans);\n}\n```\n\n\n\n",
        "postTime": 1563114740,
        "uid": 104000,
        "name": "Kisaragi_77",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5463 \u3010\u5c0f\u9c7c\u6bd4\u53ef\u7231\uff08\u52a0\u5f3a\u7248\uff09\u3011"
    },
    {
        "content": "### \u4fee\u6539\u7b2c\u4e8c\u7248\uff01\n#### \u94fe\u63a5\n------------\n[\u9006\u5e8f\u961f\u6a21\u677f\u9898](https://www.luogu.org/problemnew/show/P1908)\n\n[\u9898\u76ee\u5730\u5740](https://www.luogu.org/problemnew/show/P5463)\n\n------------\n## \u9898\u76ee\u89e3\u6790\n\n##### \u524d\u9762\u4e3a\u6211\u7684\u4e2a\u4eba\u601d\u7ef4\uff0c\u6807\u51c6\u89e3\u6cd5\u76f4\u63a5\u770b\u6700\u540e\u9762\u3002\n\n\u8fd9\u9898\u662f\u6211\u89c1\u8fc7\u7684\u9898\u76ee\u4e2d**\u6bd4\u8f83\u5751**\u7684\u4e86\uff01\n\n#### \u5751\u70b9\u5982\u4e0b\uff1a\n\n+ \u9898\u76ee\u7684**\u4e0d\u53cb\u597d\u7684\u6570\u636e\u8303\u56f4**\uff08N<=1000000\uff09\n\n+ \u9898\u76ee\u7684\u6570\u636e\u5927\u5c0f\uff08**\u7206LL**\uff09\n\n+ \u82e5\u4f7f\u7528\u6811\u72b6\u6570\u7ec4\u9700\u8981**\u79bb\u6563\u5316**\n\n------------\n\n## \u58f9.\u66b4\u529b\u6cd5\n#### \u5148\u6765\u4e00\u6ce2**\u66b4\u529b**\u5427\uff1a\n\n\t\u679a\u4e3e\u533a\u95f4\u8d77\u70b9\u4e0e\u533a\u95f4\u7ec8\u70b9\uff08\u7531\u4e8e\u4e0d\u91cd\u590d\u6027\uff0c\u5355\u4e2a\u5143\u7d20\u5fc5\u5b9a\u65e0\u9006\u5e8f\u961f\uff0c\u4e0d\u59a8\u8bbe\u8d77\u70b9\u5c0f\u4e8e\u7ec8\u70b9\uff09\n    \n    \u90a3\u4e48\u518d\u5728\u6b64\u533a\u95f4\u5185\u6c42\u9006\u5e8f\u961f\u7684\u4e2a\u6570\n#### \u4ee3\u7801\u5982\u4e0b \n\t\n$O$($N^{4}$)\n\n$30$\u5206\n\n------------\n```\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n#include<cstring>\nusing namespace std;\nlong long Ans,N,A[1000005];\nint main()\n{\n    scanf(\"%lld\",&N);\n    for(int i=1;i<=N;i++)scanf(\"%lld\",&A[i]);\n    for(int i=1;i<N;i++)\n    {\n    \tfor(int j=i+1;j<=N;j++)\n    \t{\n    \t\tfor(int k=i;k<j;k++)\n    \t\t{\n    \t\t\tfor(int z=k+1;z<=j;z++)\n    \t\t\t{\n    \t\t\t\tif(A[k]>A[z])Ans++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\",Ans);\n\treturn 0;\n}\n```\n------------\n### \u90a3\u4e48\u6211\u4eec\u5982\u4f55\u6765\u4f18\u5316\u5462\uff1f\n\n------------\n\n+ \u79bb\u6563\u5316 $O$($N$ $log_2N$)\n```\nfor(int i=1;i<=N;i++)scanf(\"%lld\",&A[i]),B[i]=A[i];\n    sort(B+1,B+1+N);//\u6392\u5e8f\n    int Num=unique(B+1,B+N+1)-B-1;//\u4e0d\u540c\u5143\u7d20\u4e2a\u6570\n    for(int i=1;i<=N;i++)A[i]=lower_bound(B+1,B+1+Num,A[i])-B;//\u4e8c\u5206\u627e\u5230\u76f8\u5e94\u7684\u503c\n```\n\n\n- \u6811\u72b6\u6570\u7ec4\n\n\t\u6570\u5217\u4e2d\u7684\u5143\u7d20\u6709\u8fde\u4e2a\u5c5e\u6027\uff1a\u4f4d\u7f6e\u4e0e\u503c\n\n\t\u6ce8\u610f\u5230\u6811\u72b6\u6570\u7ec4\u4fdd\u5b58\u4e86\u4f4d\u7f6e\u4e0e\u503c\u7684\u7279\u6027\u5e76\u652f\u6301\u4e24\u79cd\u64cd\u4f5c\uff1a\u67e5\u8be2\u4e0e\u52a0\u5165\n    \n    $A[i]>A[j]$\u4e14$i<j$\n    \n    \u67e5\u8be2\u6bd4$A[i]$\u5c0f\uff08\u6216\u7b49\uff09\u7684\u5143\u7d20\u4e2a\u6570$Num$\uff0c\u5df2\u63d2\u5165\u4e2a\u6570\u4e3a$I$\uff0c\u5219\u7b54\u6848\u5e94\u52a0\u4e0a$I-Num$\u3002\u540c\u65f6\u5728$A[i]$\u5904\u4ee5\u53ca\u5176\u4ee5\u524d\u52a0\u51651\u3002\n\n- \u5f52\u5e76\u6392\u5e8f\n\n\t\u7b54\u6848\u5c06\u662f\u6392\u5e8f\u9700\u8981\u7684\u4ea4\u6362\u6b21\u6570\uff0c\u6b64\u5904\u7701\u7565\n    \n#### \u4ee3\u7801\u5982\u4e0b \uff08\u6811\u72b6\u6570\u7ec4\uff09\n\n$O$($N^{3}$ $log_2N$)\n\n$30$\u5206\n\n------------\n```\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n#include<cstring>\nusing namespace std;\nlong long Ans,N,A[1000005],B[1000005],C[1000005];\nint L_B(int x){return x&(-x);}\nint Ask(int x)\n{\n\tint Ans=0;\n\tfor(int i=x;i;i-=L_B(i))Ans+=C[i];\n\treturn Ans;\n}\nvoid Add(int x,int Num)\n{\n\tfor(int i=x;i<=N;i+=L_B(i))C[i]+=Num;\n}\nint main()\n{\n    scanf(\"%lld\",&N);\n    for(int i=1;i<=N;i++)scanf(\"%lld\",&A[i]),B[i]=A[i];\n    sort(B+1,B+1+N);//\u6392\u5e8f\n    int Num=unique(B+1,B+N+1)-B-1;//\u4e0d\u540c\u5143\u7d20\u4e2a\u6570\n    for(int i=1;i<=N;i++)A[i]=lower_bound(B+1,B+1+Num,A[i])-B;\n    for(int i=1;i<N;i++)\n    {\n    \t\n    \tfor(int j=i+1;j<=N;j++)\n    \t{\n    \t\tfor(int k=1;k<=N;k++)C[k]=0;\n    \t\tfor(int k=i;k<=j;k++)\n    \t\t{\n    \t\t\tAns+=(k-i-Ask(A[k]));\n    \t\t\tAdd(A[k],1);\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",Ans);\n\treturn 0;\n}\n```\n------------\n### \u7ee7\u7eed\u601d\u8003\n\t\u53ef\u4ee5\u679a\u4e3e\u957f\u5ea6\u4e0e\u8d77\u70b9\n#### \u8d21\u732e\uff1a\n\n\u8d21\u732e\u6307\u7684\u662f\u5bf9\u7b54\u6848\u7684\u8d21\u732e\n\n#### \u6269\u5f20\uff1a\n\n\u6269\u5f20\u6307\u7684\u662f\u7531\u533a\u95f4$[L,R]$\u6269\u5c55\u5230$[L+1,R+1]$\u7684\u53d8\u5316\n\n\u5373\u5c06$A[L]$\u5bf9\u5f53\u524d\u9006\u5e8f\u961f\u7684\u8d21\u732e**\u5220\u53bb**\uff0c\u518d**\u52a0\u4e0a**$A[R+1]$\u5bf9\u5f53\u524d\u7684\u8d21\u732e\n\n\u5220\u53bb\u53ef\u4ee5\u7528\u52a0$-1$\u7684\u65b9\u6cd5**\u89e3\u51b3**\n\n#### \u4ee3\u7801\u5982\u4e0b \uff08\u6811\u72b6\u6570\u7ec4\uff09\n\n$O$($N^{2}$ $log_2N$)\n\n$60$\u5206\n\n------------\n```\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n#include<cstring>\nusing namespace std;\nlong long Ans,A[1000005],N,B[1000005],C[1000005];\nlong long L_B(long long x){return x&(-x);}\nvoid Add(long long X,long long Num)\n{\n    for(long long i=X;i<=N;i+=L_B(i))\n    {\n        C[i]+=Num;\n    }\n}\nlong long Ask(long long x)\n{\n    long long Ans=0;\n    for(long long i=x;i;i-=L_B(i))\n    {\n        Ans+=C[i];\n    }\n    return Ans;\n}\nint main()\n{\n    scanf(\"%lld\",&N);\n    for(long long i=1;i<=N;i++)scanf(\"%lld\",&A[i]),B[i]=A[i];\n    sort(B+1,B+1+N);\n    long long Num=unique(B+1,B+N+1)-B-1;\n    for(long long i=1;i<=N;i++)A[i]=lower_bound(B+1,B+1+Num,A[i])-B;\n    for(long long i=2;i<=N;i++)//\u679a\u4e3e\u533a\u95f4\u957f\u5ea6 \n    {\n    \tlong long Num=0;\n        for(long long j=0;j<=N;j++)C[j]=0;\n    \tfor(long long j=1;j<=i;j++)\n    \t{\n    \t\tAdd(A[j],1);\n    \t\tNum+=j-Ask(A[j]);\n        }\n        Ans+=Num;\n        for(long long j=1;j<=N-i;j++)\n        {\n            Add(A[j],-1);Num-=Ask(A[j]-1);\n            Add(A[j+i],1);Num+=i-Ask(A[j+i]);\n            Ans+=Num;\n        }\n    }\n    printf(\"%lld\\n\",Ans);\n}\n```\n------------\n## \u8d30.\u6807\u51c6\u6cd5\n\n\u5bf9\u4e8e$A[i]>A[j]$\u4e14$i<j$\u8fd9\u4e00\u7ec4\u9006\u5e8f\u961f\u53ea\u8981\u88ab\u533a\u95f4\u6240\u5305\u542b\u5c31\u4f1a\u6709\u8d21\u732e\n\u53ef\u4ee5\u679a\u4e3e\u77e5\u9053\u8d21\u732e\u4e86$i*(N-j+1)$\u6b21\n\n\u8bc1\u660e\uff1ai\u5de6\u8fb9\u53ef\u4ee5\u6709$i$\u79cd\u53d6\u6cd5\uff0cj\u53f3\u8fb9\u6709$(N-j+1)$\u79cd\u53d6\u6cd5\uff0c\u7531\u4e8e\u4e58\u6cd5\u539f\u7406\u77e5\u65b9\u6848\u6570\u91cf\u4e3a$i*(N-j+1)$\u6b21\n\n## \u5982\u56fe\n![](https://cdn.luogu.com.cn/upload/pic/63927.png)\n\n**\u8003\u8651\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\uff1a**\n\n\u90a3\u4e48\u53ea\u9700\u8981\u628a**\u6570\u7ec4\u7684\u4f4d\u7f6e**\u52a0\u5165\u5373\u53ef\uff08\u800c\u975e$1$\uff09\n\n------------\n\n#### \u7528__int128\u89e3\u51b3\u9ad8\u7cbe\u5ea6\uff08\u8003\u8bd5\u52ff\u7528\uff09\n\n**__int128**\u90e8\u5206\u501f\u9274\u4e86**Frozencode\u5927\u4f6c**\u7684\u4ee3\u7801\n\n\u6ce8\u610f__int128\u8fc7\u4e0d\u4e86**C++**\u5185\u90e8\u7684\u7f16\u8bd1**\u5f88\u6b63\u5e38**\n\n------------\n\n#### \u4ee3\u7801\u5982\u4e0b \uff08\u6811\u72b6\u6570\u7ec4\uff09\n\n$O$($N$ $log_2N$)\n\n$100$\u5206\n\n------------\n```\n#pragma GCC optimize(5)//O5\u4f18\u5316\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n#include<cstring>\n#define LOLO __int128\nusing namespace std;\nLOLO AA,Ta,Ans,GG[1005],A[1000005],N,B[1000005],C[1000005];\nLOLO L_B(LOLO x){return x&(-x);}\ninline LOLO Read()\n{\n    LOLO x=0,f=1;\n    char ch=getchar();\n    while(ch<'0'||ch>'9')\n    {\n        if(ch=='-')f=-1;\n        ch=getchar();\n    }\n    while(ch>='0'&&ch<='9')\n    {\n        x=x*10+ch-'0';\n        ch=getchar();\n    }\n    return x*f;\n}\ninline void Write(LOLO x)\n{\n    if(x<0)\n    {\n        putchar('-');\n        x=-x;\n    }\n    if(x>9)\n    {\n        Write(x/10);\n    }\n    putchar(x%10+'0');\n}\nvoid Add(LOLO X,LOLO Num)\n{\n    for(LOLO i=X;i<=N;i+=L_B(i))\n    {\n        C[i]+=Num;\n    }\n}\nLOLO Ask(LOLO x)\n{\n    LOLO Ans=0;\n    for(LOLO i=x;i;i-=L_B(i))\n    {\n        Ans+=C[i];\n    }\n    return Ans;\n}\nint main()\n{\n    N=Read();\n    for(LOLO i=1;i<=N;i++)A[i]=Read(),B[i]=A[i];\n    sort(B+1,B+1+N);\n    LOLO Num=unique(B+1,B+N+1)-B-1;\n    for(LOLO i=1;i<=N;i++)A[i]=lower_bound(B+1,B+1+Num,A[i])-B;\n    for(LOLO i=N;i>=1;i--)//\u679a\u4e3e\u533a\u95f4\u957f\u5ea6 \n    {\n        LOLO Num=0;\n    \tNum=(Ask(A[i]-1))*i;\n        Add(A[i],N-i+1);\n        Ans+=Num;\n    }\n    Write(Ans);\n    return 0;\n}\n```\n------------\n\u611f\u8c22\u8003\u8bd5\u65f6\u7684**\u6765\u4e4b\u4e0d\u6613**\u768460\u5206\u3002",
        "postTime": 1563121628,
        "uid": 122599,
        "name": "\u3010\u5929\u671d\u3011MILK",
        "ccfLevel": 4,
        "title": "P5463 \u5c0f\u9c7c\u6bd4\u53ef\u7231\uff08\u52a0\u5f3a\u7248\uff09"
    },
    {
        "content": "### \u601d\u8def\n\u8fd9\u9898\u7684\u91cd\u70b9\uff1a\u4e00\u5171\u6709 n \u53ea\u5c0f\u9c7c\uff0c\u603b\u5171\u6709 n\u00d7(1+n)/2 \u4e2a\u4e0d\u540c\u7684\u533a\u95f4\uff0c\u6c42\u533a\u95f4\u9006\u5e8f\u5bf9\u6570\u548c\n\n\u90a3\u4e48\u66b4\u529b\u7edf\u8ba1\u80af\u5b9a\u662f\u8981\u53bb\u4e16\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\uff0c\u5bf9\u4e8e\u5927\u533a\u95f4\u7684\u6bcf\u4e00\u4e2a\u9006\u5e8f\u5bf9\uff0c\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u662f\u591a\u5c11\u3002\n\n\u5206\u6790\u6837\u4f8b\u5427\uff1a\n\n8\n\n1 **9** 2 6 0 **8** 1 7\n\n\u6211\u4eec\u628a\uff089,8\uff09\u8fd9\u4e2a\u9006\u5e8f\u5bf9\u62bd\u51fa\u6765\uff0c\u90a3\u4e48\u5305\u542b\u8fd9\u4e2a\u9006\u5e8f\u5bf9\u7684\u533a\u95f4\u6709\uff1a\n\n- **9 2 6 0 8**\n- 1 **9 2 6 0 8**\n- **9 2 6 0 8** 1\n- 1 **9 2 6 0 8** 1\n- **9 2 6 0 8** 1 7\n- 1 **9 2 6 0 8** 1 7\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c**9 2 6 0 8**\u8fd9\u4e2a\u533a\u95f4\u662f\u6c38\u8fdc\u88ab\u5305\u542b\u7684\uff08\u5e9f\u8bdd\uff09\u3002\u8fd9\u516d\u4e2a\u533a\u95f4\u6240\u4e0d\u540c\u7684\u53ea\u662f**9 2 6 0 8**\u524d\u540e\u7684\u6570\u5b57\u7684\u4e2a\u6570\u3002\u90a3\u4e48\u524d\u9762\u7684\u6570\u53ef\u4ee5\u53d60\u4e2a\u62161\u4e2a\uff0c\u51712\u79cd\uff0c\u540e\u9762\u53ef\u4ee5\u53d60,1\u62162\u4e2a\uff0c\u5171\u4e09\u79cd\u3002\u90a3\u4e48**\u524d\u9762\u67092\u79cd\u60c5\u51b5\uff0c\u540e\u9762\u67093\u79cd\u60c5\u51b5\uff0c\u4e00\u5171\u6709\u51e0\u79cd\u60c5\u51b5\u5462\uff1f**\n\n\u5f53\u7136\u662f\u516d\u79cd\u3002\n\n\u62d3\u5c55\u5f00\u6765\uff0c\u5bf9\u4e8e\u9006\u5e8f\u5bf9$(a_i,a_j)$,\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5e94\u8be5\u662f$i*(n-j+1)$\uff08\u8fc7\u7a0b\u4e0d\u518d\u8d58\u8ff0\uff0c\u4e0d\u61c2\u7684\u53ef\u4ee5\u79c1\u4fe1\u6211\uff09\n\n### \u4ee3\u7801\n\u6211\u4eec\u5f00\u59cb\u60f3\u4ee3\u7801\uff0c\u5148\u770b\u770b\u6811\u72b6\u6570\u7ec4\u7edf\u8ba1\u666e\u901a\u9006\u5e8f\u5bf9\n~~~\n for(int i=1;i<=n;i++)\n        ans+=sum(a[i]-1),add(a[i],1);\n~~~\n\u6bcf\u6b21\u7edf\u8ba1\u524d\u9762\u6bd4\u81ea\u5df1\u5c0f\u7684\u6570\u7684\u4e2a\u6570\uff0c\u7d2f\u52a0\u7ed9\u7b54\u6848\uff1b\u7136\u540e\u7ed9\u6811\u72b6\u6570\u7ec4\u91cc\u52a0\u4e0a\u4e00\u4e2aa[i]\uff0c\u5f88\u5bb9\u6613\u7406\u89e3\u3002\u4f46\u662f\u9996\u5148\uff0ca[i]\u7ed9\u7b54\u6848\u7684\u8d21\u732e\u8981\u4e58\u4e0ai,\u6240\u4ee5\u5e94\u8be5\u662fadd(a[i],i);\u6bcf\u4e00\u4e2aa[j]\u7ed9\u7b54\u6848\u7684\u8d21\u732e\u8981\u4e58\u4e0a\uff08n-j+1\uff09,\u6240\u4ee5\u5e94\u8be5ans+=sum(a[i]-1)*(n-j+1)\uff0c\u56e0\u6b64\n\n~~~\nfor(int i=1;i<=n;i++)\n        ans+=sum(a[i]-1)*(n-i+1),add(a[i],i);\n~~~\n\n### \u6ce8\u610f\n\n- \u672c\u9898\u4f1a\u7206long long \uff0c\u56e0\u6b64\u9700\u7528int128\u6216\u9ad8\u7cbe\n- \u56e0\u4e3aa[i]\u4f1a\u523010^9\uff0c\u6240\u4ee5\u8981\u79bb\u6563\u5316\n\n### \u6211\u7684\u4ee3\u7801\n\n~~~\n#include<bits/stdc++.h>\n#define int __int128\n#define N 20000005\nusing namespace std;\nstruct point {\n    int id,num;\n}e[N];\ninline int read() \n{\n    int X=0,w=1;\n    char ch=getchar();\n    while(ch<'0' || ch>'9') {if(ch=='-') w=-1;ch=getchar();}\n    while(ch>='0' && ch<='9') X=(X<<3)+(X<<1)+ch-'0',ch=getchar();\n    return X*w;\n}\n\nint n,a[N],p[N];\nvoid print(int x)\n{\n    if(!x) return;\n    if(x) print(x/10);\n    putchar(x%10+'0');\n}\nbool cmd(point a,point b){\n    return a.num>b.num;\n}\nint lowbit(int n){\n    return n&-n;\n}\nint sum(int n,int sum=0){\n    while(n)sum+=p[n],n-=lowbit(n);\n    return sum;\n}\nvoid add(int x,int y){\n    while(x<=n)p[x]+=y,x+=lowbit(x);\n}\nsigned main(){\n    n=read();\n    if(n==1){\n    \tprintf(\"0\");return 0;\n    }\n    for(int i=1;i<=n;i++)\n        e[i].num=read(),e[i].id=i;\n    sort(e+1,e+n+1,cmd);\n    int t=1;a[e[1].id]=1;\n    for(int i=2;i<=n;i++){\n        if(e[i].num!=e[i-1].num)t++;\n        a[e[i].id]=t; \n    }\n    int ans=0;\n    for(int i=1;i<=n;i++)\n        ans+=sum(a[i]-1)*(n-i+1),add(a[i],i);\n    print(ans);\n    return 0;\n}\n~~~\n",
        "postTime": 1563102410,
        "uid": 210021,
        "name": "Felis",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5463 \u3010\u5c0f\u9c7c\u6bd4\u53ef\u7231\uff08\u52a0\u5f3a\u7248\uff09\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u7684\u8981\u6c42\u5176\u5b9e\u5c31\u662f\u6c42\u9006\u5e8f\u5bf9\u3002\u6c42\u9006\u5e8f\u5bf9\u53ef\u4ee5\u501f\u52a9\u6811\u72b6\u6570\u7ec4\uff0c\u5c06\u6c42\u9006\u5e8f\u5bf9\u7684\u8fc7\u7a0b\u7b49\u4ef7\u4e8e\u4ece\u5927\u5230\u5c0f\u628a\u6bcf\u4e2a\u6570\u79fb\u5230\u6700\u524d\u9762\u53bb\uff0c\u8bb0\u5f55\u9014\u4e2d\u8de8\u8d8a\u7684\u6bd4\u81ea\u5df1\u5927\u7684\u6570\u4e2a\u6570\u3002\n\n\u4e0e\u5e38\u89c1\u7684\u9006\u5e8f\u5bf9\u6a21\u677f\u9898\u4e0d\u540c\uff0c\u672c\u9898\u9700\u8981\u8fdb\u884c\u4e00\u4e9b\u53d8\u5316\u3002\u663e\u7136\uff0c\u8bb8\u591a\u9006\u5e8f\u5bf9\u90fd\u8981\u7edf\u8ba1\u591a\u6b21\uff0c\u6211\u4eec\u8fdb\u884c\u7684\u53d8\u5316\u5c31\u662f\u6c42\u51fa\u6bcf\u4e2a\u9006\u5e8f\u5bf9\u88ab\u7edf\u8ba1\u7684\u6b21\u6570\uff0c\u53d6\u9006\u5e8f\u5bf9\uff08i\uff0cj\uff09\u2014\u2014i<j\u4e14\u7b2ci\u4e2a\u6570\u5927\u4e8e\u7b2cj\u4e2a\u6570\uff0c\u89c2\u5bdf\u53ef\u5f97\uff0c\u7edf\u8ba1\u7684\u6b21\u6570\u5c31\u662fi,j\u4e24\u70b9\u5230\u6570\u5217\u4e24\u7aef\u8ddd\u79bb\u7684\u4e58\u79ef\uff0c\u5373i*\uff08n-j+1\uff09\uff0c\u90a3\u4e48\u5177\u4f53\u5230\u6bcf\u4e00\u4e2a\u6570\uff0c\u4ee5\u7b2ci\u4e2a\u6570\u4e3a\u53f3\u7aef\u5c0f\u6570\u7684\u9006\u5e8f\u5bf9\u7edf\u8ba1\u6b21\u6570\u4e4b\u548c\u4e3a\u7b2c1\u81f3i-1\u4e2a\u6570\u4e2d\u6bd4\u7b2ci\u4e2a\u6570\u5927\u7684\u6570\u7684\u7f16\u53f7\u4e4b\u548c\u4e0e\uff08n-i+1\uff09\u7684\u4e58\u79ef\u3002\n\n\u5982\u679c\u4e00\u4e2a\u4e00\u4e2a\u7edf\u8ba1\u8fc7\u53bb\uff0cO\uff08n^2\uff09\u7684\u590d\u6742\u5ea6\u80af\u5b9a\u8fc7\u4e0d\u4e86\u3002\u4e0d\u8fc7\u8bd5\u7740\u5c06\u8fd9\u4e2a\u516c\u5f0f\u4ee3\u5165\u6211\u4eec\u7684\u6c42\u9006\u5e8f\u5bf9\u6a21\u677f\uff0c\u53ea\u9700\u5c06add\u64cd\u4f5c\u4e2d\u52a0\u7684\u201c1\u201d\u6539\u4e3a\u7f16\u53f7\u6570\u5373\u53ef\u3002\n\n\u800cn<=1e6\uff0c\u7edf\u8ba1\u51fa\u7684\u7ed3\u679c\u5e94\u8be5\u4f1a\u7206long long\u3002\u6240\u4ee5\u9700\u8981\u518d\u52a0\u4e2a\u9ad8\u7cbeQwq\u3002\n\n\u849f\u84bb\u4ee3\u7801\u2014\u2014\n\n```\n#include<cstdio>\n#include<algorithm>\n#define ll long long\n#define MAX 100000\nusing namespace std;\nll c[1000001],n;\nll k,ans[1001],d,gmax;\nstruct qwq{\n    ll m,t;\n}a[1000001];\nbool cmp(qwq x,qwq y){\n\tif(x.m==y.m) return x.t<y.t;\n    //\u82e5\u7b49\u5927\uff0c\u7f16\u53f7\u5c0f\u7684\u653e\u524d\u9762\uff0c\u907f\u514d\u88ab\u5f71\u54cd\n\telse return x.m<y.m;\n}\nint l(int x){return x&-x;}\nvoid add(ll x,ll y){while(x<=n) c[x]+=y,x+=l(x);}\nll sum(int x){\n    ll k=0;while(x){k+=c[x],x-=l(x);}\n    return k;\n}\n\nvoid gao(){//\u9ad8\u7cbe\uff085\u4f4d\uff09\n\tfor(int i=0;i<=gmax;i++){\n\t\tif(ans[i]>=MAX){\n\t\t\tans[i+1]+=ans[i]/MAX;\n\t\t\tans[i]=ans[i]%MAX;\n\t\t\tif(i==gmax) gmax++;\n\t\t}\n\t\telse break;\n\t}\n}\n\nvoid ling(int x){//\u4e0d\u8db35\u4f4d\u8865\u96f6\n\tint kk=MAX/10;\n\twhile(kk>ans[x]){\n\t\tprintf(\"0\");\n\t\tkk/=10;\n\t}\n}\n\nint main(){\n    scanf(\"%lld\",&n);\n    for(int i=1;i<=n;i++){\n        scanf(\"%lld\",&a[i].m);\n        a[i].t=i,c[i]=0;\n    }\n    stable_sort(a+1,a+n+1,cmp);\n    for(int i=n;i>=1;i--){\n        ans[0]+=sum(a[i].t-1)*(n-a[i].t+1);\n        add(a[i].t,a[i].t);//\u6811\u72b6\u6570\u7ec4\u64cd\u4f5c\n        gao();\n    }\n    for(int i=gmax;i>=0;i--){\n    \tif(i!=gmax) ling(i);\n    \tprintf(\"%lld\",ans[i]);\n\t}\n    return 0;\n}\n```\n",
        "postTime": 1563101237,
        "uid": 108365,
        "name": "LesterYu",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5463 \u3010\u5c0f\u9c7c\u6bd4\u53ef\u7231\uff08\u52a0\u5f3a\u7248\uff09\u3011"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5463)\n\n## \u9898\u76ee\u5927\u610f\n- \u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217\uff0c\u6c42\u6240\u6709\u533a\u95f4\u9006\u5e8f\u5bf9\u6570\u91cf\u7684\u603b\u548c\u3002\n- $n\\leq 10^6$\n\n\n------------\n\n\n\u76f4\u63a5\u66b4\u529b\u662f $O(n^4)$ \u7684\uff0c\u53ea\u80fd\u83b7\u5f97 $30$pts\uff0c\u4e8e\u662f\u6211\u4eec\u8003\u8651\u8d21\u732e\u6cd5\uff0c\u8003\u8651  $a_i,a_j(i<j,a_i>a_j)$ \u8fd9\u5bf9\u9006\u5e8f\u5bf9\u5bf9\u7b54\u6848\u4ea7\u751f\u7684\u8d21\u732e\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u5305\u542b $a_i$ \u4e0e $a_j$ \u7684\u533a\u95f4\uff0c\u8fd9\u5bf9\u9006\u5e8f\u5bf9\u90fd\u80fd\u5e26\u6765 $1$ \u7684\u8d21\u732e\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa\u6709\u591a\u5c11\u4e2a\u533a\u95f4\u5305\u542b $a_i$ \u4e0e $a_j$\u3002\n![](https://cdn.luogu.com.cn/upload/image_hosting/gzzkbhhd.png)\n\u6ee1\u8db3\u6761\u4ef6\u7684\u533a\u95f4\u7684\u5de6\u7aef\u70b9\u53ef\u4ee5\u53d6 $1\\sim i$\uff0c\u5171\u6709 $i$ \u79cd\u53d6\u503c\uff0c\u53f3\u7aef\u70b9\u53ef\u4ee5\u53d6 $j\\sim n$\uff0c\u5171\u6709 $n-j+1$ \u79cd\u53d6\u503c\uff0c\u6839\u636e\u4e58\u6cd5\u539f\u7406\u53ef\u5f97\uff0c\u6709 $i\\times (n-j+1)$ \u4e2a\u5305\u542b $a_i$ \u4e0e $a_j$ \u7684\u533a\u95f4\u3002\n\n\u679a\u4e3e\u6bcf\u5bf9\u9006\u5e8f\u5bf9\uff0c\u5c06\u7b54\u6848\u52a0\u4e0a $i\\times (n-j+1)$\uff0c\u8fd9\u79cd $O( n^2 )$ \u505a\u6cd5\u53ef\u4ee5\u83b7\u5f97 $60$pts\u3002\n\n\u4f7f\u7528\u5f52\u5e76\u6392\u5e8f\u53ef\u4ee5 $O( n \\log n )$ \u901a\u8fc7\u672c\u9898\u3002\u6b64\u5904\u6211\u91cd\u70b9\u8bb2\u89e3\u6811\u72b6\u6570\u7ec4\u7684\u505a\u6cd5\u3002\n\n\u5728\u8bb2\u89e3\u4e4b\u524d\uff0c\u6211\u9ed8\u8ba4\u4f60\u4eec\u5df2\u7ecf\u4f1a\u4f7f\u7528\u6811\u72b6\u6570\u7ec4\u901a\u8fc7 [P1428](https://www.luogu.com.cn/problem/P1428)  ~~\uff08 \u8c01\u4f1a\u7528\u6811\u72b6\u6570\u7ec4\u505a\u7ea2\u9898\u5462~~\n\n\u5f00\u4e00\u4e2a\u503c\u57df\u7684\u6811\u72b6\u6570\u7ec4\uff0c\u4ece $n\\sim 1$ \u904d\u5386\uff0c\u6bcf\u6b21\u5c06 $a_i$ \u7684\u4f4d\u7f6e\u52a0\u4e0a $n-i+1$\uff0c\u5373 `add(a[i],n-i+1)`\uff0c\u5e76\u5c06\u7b54\u6848\u52a0\u4e0a `i*query(a[i-1])`\uff0c\u56e0\u4e3a\u662f\u4ece\u540e\u5f80\u524d\u904d\u5386\uff0c\u6811\u72b6\u6570\u7ec4\u5df2\u7ecf\u7edf\u8ba1\u5b8c $i$ \u4ee5\u540e\u7684\u6570\uff0c`query(a[i-1])` \u5373\u6240\u6709\u6bd4 $a_i$ \u5c0f\u7684\u6570\u5bf9\u5e94\u8d21\u732e\u7684\u548c\uff0c\u628a\u548c\u518d\u4e58 $i$\uff0c\u6839\u636e\u4e58\u6cd5\u5206\u914d\u5f8b\uff0c\u5373\u53ef\u5f97\u5230\u7ed3\u679c\u662f $a_i$ \u4e0e\u540e\u9762\u7684\u6570\u6784\u6210\u9006\u5e8f\u5bf9\u7684\u5e26\u6765\u7684\u603b\u8d21\u732e\uff0c \u628a\u4ece $1\\sim n$ \u7684 $i$ \u5e26\u6765\u7684\u8d21\u732e\u52a0\u8d77\u6765\uff0c\u5c31\u662f\u6700\u7ec8\u7684\u7b54\u6848\u3002\u8be5\u65b9\u6cd5\u7684\u590d\u6742\u5ea6\u4e5f\u662f $O( n \\log n )$ \u7684\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\uff0c\u4e14\u4e0d\u7528\u62c5\u5fc3\u5e38\u6570\uff0c\u56e0\u4e3a\u672c\u9898\u65f6\u9650\u4e3a $2$s\u3002\n## \u6ce8\u610f\u4e8b\u9879\n1. \u672c\u9898 $n\\leq 10^6$\uff0c\u4f46 $a_i\\leq 10^9$\uff0c\u6240\u4ee5\u6570\u636e\u9700\u8981\u79bb\u6563\u5316\uff0c[P1908](https://www.luogu.com.cn/problem/P1908) \u4e0e [P1774](https://www.luogu.com.cn/problem/P1774)  \u662f\u7ec3\u4e60\u79bb\u6563\u5316\u4e0d\u9519\u7684\u9898\u76ee\uff0c\u82e5\u4f60\u901a\u8fc7\u672c\u9898\uff0c\u540c\u65f6\u60a8\u53ef\u4ee5\u83b7\u5f97\u4e09\u500d\u7ecf\u9a8c\u3002\n2. \u672c\u9898\u7b54\u6848\u662f $n^4$ \u6570\u91cf\u7ea7\u7684\uff0c\u8d85\u8fc7 `long long` \u7c7b\u578b\u7684\u8303\u56f4\uff0c\u4f60\u53ef\u4ee5\u5f00 `long long` \u7c7b\u578b\u7684\u6811\u72b6\u6570\u7ec4\uff0c\u5e76\u7528\u9ad8\u7cbe\u5ea6\u52a0\u6cd5\u7d2f\u52a0\u7b54\u6848\uff0c\u4e5f\u53ef\u4ee5\u5f00  `__int128`\uff0c\u4f7f\u7528\u5feb\u8bfb\u4e0e\u5feb\u5199\uff0c~~\u7528 Python~~ \u3002\n\n\n------------\n\n\n \u4ee3\u7801\u5c31\u4e0d\u5c55\u793a\u4e86\uff0c\u82e5\u4f60\u719f\u7ec3\u638c\u63e1\u63d0\u5230\u7684\u6570\u636e\u7ed3\u6784\u4e0e\u7b97\u6cd5\uff0c\u4f60\u4e00\u5b9a\u80fd\u72ec\u81ea\u901a\u8fc7\u672c\u9898\u3002",
        "postTime": 1659245743,
        "uid": 283416,
        "name": "_Extroversion",
        "ccfLevel": 4,
        "title": "P5463 \u5c0f\u9c7c\u6bd4\u53ef\u7231\uff08\u52a0\u5f3a\u7248\uff09\u9898\u89e3"
    },
    {
        "content": "\u6211\u4e00\u5b9a\u8981\u5410\u69fd\u4e00\u4e0b\u8fd9\u9898$n^2$\u66b4\u529b60\u5206\uff0c$n\\ log(n)$\u4e0d\u5f00\u9ad8\u7cbe\u4e5f60\u5206\n\n~~\u90a3\u6211\u5199\u4ec0\u4e48\u6b63\u89e3~~\n\n**\u8bf4\u660e\uff1a\u672c\u9898\u89e3\u4e2d\uff0c\u6587\u5b57\u4e0a\u9762\u5e26$^ 1$\u7b49\u6570\u5b57\u7684\uff0c\u8868\u793a\u6ce8\u91ca\uff0c\u5199\u5728\u6587\u7ae0\u6700\u4e0b\u9762**\n\n- **\u5206\u6790**\n \n   \u4ece\u6bcf\u4e2a\u533a\u95f4\u7684\u89d2\u5ea6\u53bb\u8003\u8651\u95ee\u9898\u663e\u7136\u6bd4\u8f83\u56f0\u96be\uff0c\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u6837\u505a$^1$\u6700\u4f18\u4e5f\u53ea\u80fd\u505a\u5230$n ^ 2\\ log(n)$\n   \n   \u6240\u4ee5\u6211\u4eec\u9700\u8981\u8f6c\u53d8\u4e00\u4e0b\u601d\u8def\uff0c\u8003\u8651\u8003\u8651\u4e00\u5bf9\u9006\u5e8f\u5bf9$(i,j)$\u4f1a\u88ab\u591a\u5c11\u4e2a\u533a\u95f4\u5305\u542b\uff1a\n\n   \u5de6\u8fb9\u6709$i$\u79cd\u9009\u62e9\uff08\u8fd9\u4e2a\u533a\u95f4\u7684\u5de6\u8fb9\u754c\u53ef\u4ee5\u662f$[1,i]$\u4e2d\u7684\u4efb\u610f\u6574\u6570\uff0c\u90fd\u4f1a\u5305\u542b\u6570\u5bf9$(i,j)$\uff09\n\n   \u540c\u6837\uff0c\u53f3\u8fb9\u754c\u53ef\u4ee5\u662f$[j,n]$\u4e2d\u7684\u4efb\u610f\u6574\u6570\uff0c$[j,n]$\u6709$n - j + 1$\u4e2a\u6574\u6570\n   \n   \u4f7f\u7528\u5c0f\u5b66\u5c31\u5b66\u8fc7\u7684\u4e58\u6cd5\u539f\u7406\uff0c\u4e00\u5171\u7684\u533a\u95f4\u6570\u662f\uff1a\n   \n   $i \\times (n - j + 1)$\n\n   \u4e8e\u662f\uff0c\u66b4\u529b\u679a\u4e3e\u6bcf\u4e2a$(i,j)$\u7684$n^2$\u66b4\u529b\u5c31\u53ef\u4ee5\u5199\u4e86\uff1a\n   \n```cpp\n#include <cstdio>\n#define ll long long\nint n,ans = 0;\nint arr[1000005];\n\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i = 1;i <= n;i++){\n\t\tscanf(\"%d\",&arr[i]);\n\t}\n\tll ans = 0;\n\tfor(int i = 1;i <= n;i++){\n\t\tfor(int j = i + 1;j <= n;j++){\n\t\t\tif(arr[i] > arr[j]){\n\t\t\t\tans += (ll)i * (n - j + 1);\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n\n- **\u4f18\u5316**\n\n  \u5148\u5199\u51fa\u6765\u521a\u624d\u7684\u5f0f\u5b50\uff1a\n  \n  $\\sum\\limits_{i=1}^n \\sum\\limits_{j=i+1} ^ n [a_i > a_j] \\times i \\times (n - j + 1)$\n  \n  \u8fd9\u4e2a\u4e1c\u897f\u5e76\u4e0d\u662f\u5f88\u597d\u7b97\uff0c\u6240\u4ee5\u8003\u8651\u679a\u4e3e\u4e00\u4e2a$i$\u6765\u7edf\u8ba1\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ea\u9700\u8981\u7b97\uff1a\n  \n  $\\sum\\limits_{j=i+1} ^ n [a_i > a_j] \\times (n - j + 1)$\n  \n  \u5c31\u884c\u4e86\n  \n  \u4f46\u662f$[a_i > a_j]$\u8fd9\u4e2a\u4e1c\u897f\u8fd8\u662f\u6bd4\u8f83\u96be\u7b97\u7684$^2$\uff0c\u9700\u8981\u518d\u53d8\u6362\u4e00\u4e0b\uff0c\u4ece\u7528$j$\u8868\u793a$a_j$\uff0c\u6539\u4e3a\u7528$a_j$\u8868\u793a$j$\uff1a\n\n  $\\sum\\limits_{k = 1}^{a_i-1} (n - id_k + 1)$\n\n  \u5176\u4e2d\uff0c$id_k$\u8868\u793a\u5728\u533a\u95f4$[i,n]$\u4e2d\uff0c\u6bcf\u4e2a$a[j] = k$\u7684$j$\u4e4b\u548c$^3$\n  \n  \u8fd9\u4e2a\u4e1c\u897f\u770b\u4f3c\u4e0d\u597d\u7b97\uff0c\u5f88\u590d\u6742\n  \n  \u4f46\u662f\u5176\u5b9e\u6bcf\u6b21$id_k$\u7684\u533a\u95f4\u53f3\u7aef\u70b9\u90fd\u4e0d\u53d8\uff0c\u53ea\u6709\u5de6\u7aef\u70b9\u5728\u5de6\u79fb\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u5728\u4e0a\u6b21\u7684\u57fa\u7840\u4e0a\uff0c\u52a0\u5165\u65b0\u7684\u4e00\u4e2a$k$\u7684\u8d21\u732e\u5c31\u53ef\u4ee5\u4e86\n  \n  \u6240\u4ee5\u5c31\u662f\u8981\u7ef4\u62a4\u6570\u7ec4$id$\uff0c\u90a3\u4e48\u6bcf\u6b21\u8fdb\u884c\u5355\u70b9\u4fee\u6539\u6216\u8005\u533a\u95f4\u67e5\u8be2\n  \n  \u90a3\u4e48\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u7528\u6811\u72b6\u6570\u7ec4\u6765\u7ef4\u62a4\n  \n  \u6700\u540e\u522b\u5fd8\u4e86\u628a\u7b54\u6848$\\times i$\n  \n  \u7136\u540e\u672c\u9898\u8981\u5f00\u9ad8\u7cbe\u5ea6$^4$\uff0c\u4e00\u5f00\u59cb\u5bf9$a_i$\u8981\u8fdb\u884c\u79bb\u6563\u5316\u3002\u79bb\u6563\u5316\u4e0d\u4f1a\u7684\u8bdd\uff0c\u53bb[\u8fd9\u91cc](https://www.luogu.com.cn/problemnew/solution/P1908)\u5b66\u4e60\u4e00\u4e0b\n\n- \u6ce8\u91ca\n\n  1) \u8fd9\u79cd\u505a\u6cd5\u662f\uff1a\u679a\u4e3e$i$\uff0c\u4ece\u5de6\u5230\u53f3\u626b\u4e00\u904d$j$\uff0c\u7136\u540e\u8ba1\u7b97\u51fa\u6bd4\u8d77\u533a\u95f4$[i,j -1]$\uff0c$[i,j]$\u591a\u51fa\u4e86\u591a\u5c11\u8d21\u732e\uff0c\u4f7f\u7528\u6743\u503c\u6811\u72b6\u6570\u7ec4\u89e3\u51b3\u8fd9\u4e2a\u8ba1\u7b97\u3002\u540c\u6837\u53ef\u4ee5\u5f97\u523060pts\uff0c\u4f46\u662f\u8fc7\u4e8e\u91ce\u86ee\uff0c\u6240\u4ee5\u4e0d\u591a\u4ecb\u7ecd\n\n  2) \u6bcf\u6b21\u67e5\u8be2\u533a\u95f4$[l,r]\\le x$\u7684\u6570\u7684\u6743\u503c\u4e4b\u548c\uff0c\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u5957\u4e3b\u5e2d\u6811\u6a21\u677f\u89e3\u51b3\u3002\u4f46\u662f\u548c\u672c\u9898\u7684\u505a\u6cd5\u6ca1\u6709\u672c\u8d28\u533a\u522b\uff0c\u6211\u5728\u89e3\u91ca\u7684\u4e1c\u897f\u5c31\u662f\u4e3b\u5e2d\u6811\u7684\u505a\u6cd5\n  \n  3) \u5982\u679c\u4f60\u60f3\u77e5\u9053\u4e3a\u4ec0\u4e48\uff0c\u90a3\u6211\u4e5f\u89e3\u91ca\u4e0d\u4e86\uff0c\u53cd\u6b63\u8fd9\u5c31\u662f\u89e3\u51b3\u8fd9\u7c7b\u95ee\u9898\u7684\u6807\u51c6\u505a\u6cd5\u2026\u2026\n  \n  4) \u6709$n ^ 2$\u4e2a\u533a\u95f4\uff0c\u6bcf\u4e2a\u533a\u95f4\u53ef\u80fd\u4f1a\u6709$n ^ 2$\u4e2a\u9006\u5e8f\u5bf9\uff0c\u6240\u4ee5\u7b54\u6848\u6700\u5927\u662f$n ^ 4$\uff0c\u5f53$n = 10 ^ 6$\u65f6\uff0c$n ^ 4 = 10 ^ {24}$\uff0c\u771f\u7684\u7206\u4e86$long\\ long$\u2026\u2026\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <cstdio>\n#include <algorithm>\n#define ll long long\nusing namespace std;\nint n,cnt = 0;\nll a[1000005];\nll c[1000005];//\u8fd9\u91cc\u5f00int\u4f1a\u70b8\uff0clonglong\u4e0d\u4f1a\nint ans[50],len = 1;//\u8fd9\u4e2a\u662f\u5b58\u7b54\u6848\u7684\n\nstruct node{\n\tint val,id;\n}b[1000005];\n\nbool cmp(node a,node b){\n\treturn a.val < b.val;\n}\n\nint lowbit(int x){\n\treturn x & -x;\n}\n\nll sum(int i){\n    ll ret = 0;\n    while(i > 0){\n        ret += c[i];\n        i -= lowbit(i);\n    }\n    return ret;\n} \n\nvoid update(int i,int val){\n    while(i <= cnt){\n        c[i] += val;\n        i += lowbit(i);\n    }\n} \n\nint main(){\n    scanf(\"%d\",&n);\n\tfor(int i = 1;i <= n;i++){\n\t\tscanf(\"%d\",&b[i].val);\n\t\tb[i].id = i;\n\t}\n\tsort(b+1,b+n+1,cmp);\n\tfor(int i = 1;i <= n;i++){\n\t\tif(b[i].val != b[i - 1].val || i == 1){\n\t\t\tcnt++;\n\t\t}\n\t\ta[b[i].id] = cnt;\n\t}//\u79bb\u6563\u5316\n\tfor(int i = n;i >= 1;i--){\n\t\tif(i != n){\n\t\t\tll now = i * sum(a[i] - 1);//\u8fd9\u91cc\u7684now\u4e5f\u8981long long\uff0c\u6bcf\u6b21\u4e58\u7684\u503c\u6700\u9ad8\u4e5f\u5c311000000^3\uff0c\u4e5f\u5c31\u662f10^18\u7684\u6837\u5b50\n\t\t\tint count = 0;\n\t\t\twhile(now != 0 || count != len){\n\t\t\t\tans[++count] += now % 10;\n\t\t\t\tif(ans[count] >= 10){\n\t\t\t\t\tans[count + 1] += ans[count] / 10;\n\t\t\t\t\tans[count] = ans[count] % 10;\n\t\t\t\t}\n\t\t\t\tif(ans[count + 1] != 0){\n\t\t\t\t\tlen = max(len,count + 1);\n\t\t\t\t}else{\n\t\t\t\t\tlen = max(len,count);\n\t\t\t\t}\n\t\t\t\tnow /= 10;\n\t\t\t}\n\t\t}\n\t\tupdate(a[i],n - i + 1);\n\t}\n\tfor(int i = len;i >= 1;i--){\n\t\tprintf(\"%d\",ans[i]);\n\t}\n\treturn 0;\n}\n```\n\n\u4e0d\u5f97\u4e0d\u8bf4\uff0c\u672c\u9898\u63a8\u5f0f\u5b50\u7684\u90e8\u5206\u8fd8\u771f\u662f\u53ea\u53ef\u610f\u4f1a\uff0c\u4e0d\u53ef\u8a00\u4f20\u3002\u6211\u611f\u89c9\u6211\u8bb2\u5f97\u4e0d\u592a\u6e05\u695a\uff0c\u4f46\u662f\u4e5f\u6ca1\u6709\u529e\u6cd5\u4e86\n\n**update on 2020.1.29 \u4fee\u4e86latex\uff0c\u4ece\u611f\u6027\u7406\u89e3\u6539\u4e3a\u4e86\u7528\u5f0f\u5b50\u8868\u793a**",
        "postTime": 1564814013,
        "uid": 49776,
        "name": "chenxinyang2006",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5463 \u3010\u5c0f\u9c7c\u6bd4\u53ef\u7231\uff08\u52a0\u5f3a\u7248\uff09\u3011"
    },
    {
        "content": "1.\u601d\u8defdalao\u5df2\u7ecf\u8bb2\u7684\u5f88\u6e05\u695a\u4e86\uff0c\u5c31\u662fn^2logn\u8f6cnlogn\uff0c\u9664\u4e86\u8f6c\u5316\u5c31\u662f\u4e00\u9053\u88f8\u7684\u9006\u5e8f\u5bf9\uff1b\n\n2.\u90fd\u662f\u6811\u72b6\u6570\u7ec4\uff0c\u7ebf\u6bb5\u6811\u83dc\u9e21\u8d34\u4e2a\u6743\u503c\u7ebf\u6bb5\u6811\uff08\u6a21\u677f\u9898\u5427\u3002\u3002\u3002\uff09\n\n3.\u7206long long\uff0c\u7528__int128\n\n4.\u79bb\u6563\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef __int128 LL;\nint const maxn=1e6+5;\nLL n,a[maxn],tmp[maxn],c[maxn],size;\nLL ans,cnt[maxn<<2];\ninline LL read(){\n    char ch=getchar();\n    LL f=1,x=0;\n    while (ch<'0' || ch>'9'){\n        if (ch=='-') f=-1;\n        ch=getchar();\n    }\n    while (ch>='0' && ch<='9'){\n        x=x*10+ch-'0';\n        ch=getchar();\n    }\n    return f*x;\n}\nvoid _print(__int128 x){\n    if (x==0) return; \n    _print(x/10);\n    putchar(x%10+'0');\n}\n\n void init(LL rt,LL l,LL r,LL x,LL id){\n     if ((l==r)&&(l==x)) {\n        cnt[rt]+=id;\n        return;\n     }\n     LL mid=(l+r)>>1;\n     if (x<=mid) init(rt<<1,l,mid,x,id);\n     else if (x>mid) init(rt<<1|1,mid+1,r,x,id);\n     cnt[rt]=cnt[rt<<1]+cnt[rt<<1|1];\n }//\u63d2\u5165\u6743\u503c\u7ebf\u6bb5\u6811\nLL sum(LL rt,LL l,LL r,LL x,LL y){\n     if ((x<=l)&&(y>=r)) return cnt[rt];\n     LL anss=0;\n     LL mid=(l+r)>>1;\n     if (x<=mid) anss+=sum(rt<<1,l,mid,x,y);\n     if (y>mid) anss+=sum(rt<<1|1,mid+1,r,x,y);\n     return anss;\n }//\u6c42\u533a\u95f4\u548c\n int main(){\n    n=read();\n    for (long long int i=1;i<=n;i++){\n          a[i]=read();\n          tmp[i]=a[i];\n\t}   \n         sort(tmp+1,tmp+1+n);\n         size=unique(tmp+1,tmp+1+n)-(tmp+1);\n    for (long long int i=1;i<=n;i++) a[i]=lower_bound(tmp+1,tmp+1+size,a[i])-tmp;//\u79bb\u6563\u5316\n    for (long long int i=1;i<=n;i++){\n        init(1,1,n,a[i],i);\n        ans+=sum(1,1,n,a[i]+1,n)*(n-i+1);\n    }\n    if(!ans) cout<<0;\n    else _print(ans); \n return 0;\n}\n```\n",
        "postTime": 1563119568,
        "uid": 76230,
        "name": "ZQYZQY",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5463 \u3010\u5c0f\u9c7c\u6bd4\u53ef\u7231\uff08\u52a0\u5f3a\u7248\uff09\u3011"
    },
    {
        "content": "\u65e2\u7136\u5df2\u7ecf\u6709\u4e86\u4e24\u7bc7\u6811\u72b6\u6570\u7ec4\u7684\u9898\u89e3\uff0c\u90a3\u6211\u5c31\u53d1\u4e00\u7bc7\u5f52\u5e76\u6392\u5e8f\u7684\u9898\u89e3\u5427\n\n\u4e0d\u4f1a\u5f52\u5e76\u6392\u5e8f\uff1f\u8bf7\u5148\u505a\u4e00\u505a[\u8fd9\u9898](https://www.luogu.org/problemnew/show/P1908)\uff0c\u5e76\u5b66\u4e60\u5176\u5f52\u5e76\u6392\u5e8f\u7684\u505a\u6cd5\n\n\u672c\u9898\u5f52\u5e76\u6392\u5e8f\u90e8\u5206\u4ee3\u7801\n\n```cpp\n//\u8981\u6392\u5e8f\u7684\u533a\u95f4\u662f[l,r)  \u6ce8\u610f\u662f\u4e0d\u5305\u542br\u7684\n//\u8fd9\u91cc\u6709\u4e9b\u540c\u5b66\u53ef\u80fd\u5199\u6cd5\u4e0d\u592a\u4e00\u6837\uff0c\u9700\u8981\u5fae\u8c03\u4e00\u4e0b\nvoid MergeSort(long l, long r)\n{\n\tif (l + 1L < r)\n\t{\n\t\tlong i = l, j, k = 0L, mid = (l + r + 1L) >> 1;\n\t\tlong long s = 0LL;\n\t\tj = mid;\n\t\tMergeSort(l, mid);\n\t\tMergeSort(mid, r);\n\t\tfor (long _ = l; _ < mid; ++_) s += num[_];\n\t\twhile (i < mid&&j < r)\n\t\t{\n\t\t\tif (a[i] > a[j])\n\t\t\t{\n\t\t\t\ttmp[0][k] = a[j];\n\t\t\t\ttmp[1][k++] = num[j];\n\t\t\t\tans += (__int128)(s + mid - i)*(n - num[j++]);  //\u6ce8\u610f\u8fd9\u91cc\uff01\uff01\uff01\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttmp[0][k] = a[i];\n\t\t\t\ttmp[1][k++] = num[i];\n\t\t\t\ts -= num[i++];\n\t\t\t}\n\t\t}\n\t\twhile (i < mid)\n\t\t{\n\t\t\ttmp[0][k] = a[i];\n\t\t\ttmp[1][k++] = num[i++];\n\t\t}\n\t\twhile (j < r)\n\t\t{\n\t\t\ttmp[0][k] = a[j];\n\t\t\ttmp[1][k++] = num[j++];\n\t\t}\n\t\tmemcpy(a + l, tmp[0], sizeof(long)*(size_t)k);\n\t\tmemcpy(num + l, tmp[1], sizeof(long)*(size_t)k);\n\t}\n\treturn;\n}\n```\n\n\u5728\u5e73\u65f6\u7edf\u8ba1\u9006\u5e8f\u5bf9\u65f6\uff0c\u4e0a\u9762\u90a3\u4e2a\u5730\u65b9\u4e00\u822c\u5199\u7684\u662f`ans += mid - i`\uff0c\u56e0\u4e3a\u4ece$a_i$\u5230$a_{mid-1}$\u90fd\u53ef\u4ee5\u548c$a_j$\u7ec4\u6210\u9006\u5e8f\u5bf9\n\n\uff08\u4e0b\u6587\u4e2d$num_i$\u8868\u793a\u5f53\u524d\u4e0b\u6807\u4e3a$i$\u7684\u5143\u7d20\u5728\u539f\u6765\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e\uff08$0,\\cdots,n-1$\uff09\uff09\n\n\u5bf9\u4e8e\u9006\u5e8f\u5bf9$(i,j)\\space(0\\le i,j<n)$\uff0c\u5b83\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u663e\u7136\u4e3a$(num_i+1)(n-num_j)$\n\n\u800c\u4e0a\u9762\u90a3\u4e2a\u5730\u65b9\u7684\u9006\u5e8f\u5bf9\u6709$(i,j),\\cdots,(mid-1,j)$\n\n\u56e0\u6b64\u603b\u8d21\u732e\u4e3a$\\sum_{k=i}^{mid-1}{(num_k+1)(n-num_j)}$\n\n\u7a0d\u5fae\u5316\u7b80\u4e00\u4e0b\u5c31\u662f$((\\sum_{k=i}^{mid-1}{num_k})+mid-i)(n-num_j)$\n\n\u6ce8\u610f\u5230$i$\u662f\u9012\u589e\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u9884\u5148\u6c42\u51fa$\\sum_{k=l}^{mid-1}{num_k}$\uff0c\u7136\u540e\u6bcf\u6b21`++i`\u4e4b\u524d\u8ba9sum\u51cf\u6389$num_i$\n\n\u6700\u540e\u518d\u6ce8\u610f\u4e00\u4e0b\u8981\u6253\u9ad8\u7cbe\u5ea6\u6216\u8005`__int128`\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u6109\u5feb\u5730AC\u672c\u9898\u4e86\n\n[\u5b8c\u6574AC\u4ee3\u7801](https://www.luogu.org/paste/vkmeiain)",
        "postTime": 1563114324,
        "uid": 110634,
        "name": "zhanghengrui",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5463 \u3010\u5c0f\u9c7c\u6bd4\u53ef\u7231\uff08\u52a0\u5f3a\u7248\uff09\u3011"
    },
    {
        "content": "\u5bf9\u4e8e\u9006\u5e8f\u5bf9\uff08num[j],num[i]\uff09\uff0c\u5b83\u4f1a\u88ab\u8ba1\u7b97\uff08N-i+1) * j\u6b21\uff08\u8d77\u70b9\u4e3a[1,j]\u4e2d\u4efb\u610f\u4e00\u4e2a\uff0c\u7ec8\u70b9\u4e3a[i,N]\u4e2d\u4efb\u610f\u4e00\u4e2a\u7684\u533a\u95f4\u90fd\u4f1a\u8ba1\u7b97\u5230\u5b83\u3002\u7531\u4e58\u6cd5\u539f\u7406\uff0c\u5b83\u4f1a\u88ab\u8ba1\u7b97\uff08N-i+1\uff09*j\u6b21\uff09\n\n\u4e8e\u662f\u987a\u4f4d\u63a8\uff0c\u7b2ci\u4f4d\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e3a\uff08N-i+1\uff09*\uff08j1+j2+j3+j4+...\uff09,\u5176\u4e2dnum[jk]>num[i]\n\n\u4e8e\u662f\u5230\u8fd9\u4e00\u6b65\uff0c\u5b83\u88ab\u8f6c\u4e3a\u4e86\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u9898\n\nemmm\uff0c\u4f3c\u4e4e\u5927\u591a\u6570\u4eba\u90fd\u60f3\u5230\u4e86\u79bb\u6563\u5316+\u6811\u72b6\u6570\u7ec4......\n\n\u6211\u8111\u56de\u8def\u6bd4\u8f83\u6e05\u5947\uff08\u5176\u5b9e\u5c31\u662f\u8111\u5b50\u7b80\u5355\uff09\uff0c\u60f3\u5230\u4e86**Splay**\n\n\u5927\u6982\u601d\u8def\u662f\uff0c\u4ee5num[i]\u4e3a\u5173\u952e\u5b57\uff0c\u5f00\u4e24\u4e2a\u9644\u52a0\u57df\uff0c\u5206\u522b\u53eb\u505aseg\u3001sumseg\uff0c\u7528\u4e8e\u7edf\u8ba1\u4e0b\u6807\u548c\n\n\u7edf\u8ba1\u5230\u7b2ci\u4f4d\u65f6\uff0c\u6211\u4eec\u5c31\u628a**\u5b83\u7684\u503c\u548c\u4e0b\u6807**\u7ed9\u63d2\u5165\u5230Splay\u4e2d\uff0c\u7136\u540e\u628a\u5b83\u65cb\u8f6c\u5230\u6839\uff0c\u8fd9\u4e2a\u65f6\u5019**\u6839\u7684\u53f3\u5b50\u6811**\u5c31\u4e00\u5b9a\u662f\u4e0b\u6807<i\u7684\u6570\u4e2d\uff0c\u503c>num[i]\u7684\u7ed3\u70b9\u7684\u96c6\u5408\n\n\u4e8e\u662f\u53ea\u9700\u8981\u628a\u53f3\u5b50\u6811\u7684segsum\u4e58\u4e0a\uff08N-i+1\uff09\u518d\u52a0\u8fdbans\u4e2d\u5c31\u53ef\u4ee5\u6c42\u5f97\u7b2ci\u4f4d\u7684\u8d21\u732e\u4e86\n\n\u6700\u540e\u8f93\u51faans\u5373\u53ef\uff08\u55ef\u6211\u5e9f\u8bdd\u662f\u4e0d\u662f\u6709\u70b9\u591a......\uff09\n\n\u5173\u4e8e\u9ad8\u7cbe\u95ee\u9898\uff0c\u6709\u4e2a\u64cd\u4f5c\u53eb\u505a**int128**\uff0c\u53ef\u4ee5\u5728luogu\u4e2d\u52c9\u5f3a\u5f53\u9ad8\u7cbe\u7528\uff08\u5212\u91cd\u70b9\uff0cNOIP\u4ec0\u4e48\u7684\u4e0d\u884c\u7684\uff09\u3002**int128**\u7c7b\u578b\u53ea\u80fd\u7528\u5feb\u8bfb\u6765\u8bfb\uff0c\u7528\u5feb\u5199\u6765\u5199\uff08\u5f53\u7136\u4f60\u4f1a\u91cd\u8f7d>>\u7684\u8bdd\u5f53\u6211\u6ca1\u8bf4\uff09\u3002\u5982\u679c\u5728\u672c\u673a\u4e0a\u7f16\u8bd1\u4e0d\u8fc7\uff0c\u53ef\u4ee5\u7528luogu\u7684\u5728\u7ebfIDE\uff08\u597d\u4e1c\u897f\uff09\u3002\n\n\u6700\u540e\u6709\u8c01\u613f\u610f\u548c\u6211\u4ea4\u6362\u4e00\u4e0b\u53cb\u94fe\u5417\uff0c~~\u6211\u7684\u670b\u53cb\u5f88\u5c11\uff0c~~ \u6211\u60f3\u8981\u591a\u5411dalao\u4eec\u4e86\u89e3\u5b66\u4e60OI\u7684\u65b9\u6cd5\uff08\u6211\u592a\u5f31\u4e86......)\n\n\u653e\u4e00\u653e\u4ee3\u7801\uff0c\u8bb0\u5f97\u8981\u81ea\u5df1\u52a0\u4e00\u70b9\u4f18\u5316\uff0c\u4e0d\u7136\u662f\u8fc7\u4e0d\u4e86\u7684\u3002\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=1000005;\nint N,num[maxn];\n__int128 ans;\nstruct BT{\n    int root,cnt,ch[maxn][2],val[maxn],fa[maxn],seg[maxn];\n    __int128 segsum[maxn];\n    inline int Chk(int x){\n        return x==ch[fa[x]][1];\n    }\n    inline void Upt(int x){\n        segsum[x]=seg[x]+segsum[ch[x][0]]+segsum[ch[x][1]];\n    }\n    inline void Rotate(int x){\n        int y=fa[x],z=fa[y],k=Chk(x),w=ch[x][k^1];\n        ch[z][Chk(y)]=x;fa[x]=z;\n        ch[x][k^1]=y;fa[y]=x;\n        ch[y][k]=w;fa[w]=y;\n        Upt(y);Upt(x);\n    }\n    inline void Splay(int x,int v=0){\n        while(fa[x]!=v){\n            int y=fa[x],z=fa[y];\n            if(z!=v){\n                if(Chk(y)==Chk(z))Rotate(y);\n                else Rotate(x);\n            }\n            Rotate(x);\n        }\n        if(!v)root=x;\n    }\n    inline void Insert(int v,int s){\n        int x=root,pa=0;\n        while(x&&v!=val[x]){\n            pa=x;x=ch[x][v>val[x]];\n        }\n        if(x&&v==val[x])seg[x]+=s;\n        else{\n            x=++cnt;\n            val[x]=v;\n            seg[x]=s;\n            fa[x]=pa;\n            if(pa)ch[pa][v>val[pa]]=x;\n        }\n        Splay(x);\n    }\n}T;\ninline void Read(int&x){\n    x=0;int f=1;char c=getchar();\n    while(!isdigit(c)){if(c=='-')f=-1;c=getchar();}\n    while(isdigit(c)){x=x*10+c-'0';c=getchar();}\n    x*=f;return;\n}\ninline void Write(__int128 x){\n    if(x>=10)\n    Write(x/10);\n    putchar(x%10+'0');\n}\nint main(){\n    //freopen(\"in.txt\",\"r\",stdin);\n    Read(N);\n    for(register int i=1;i<=N;i++)Read(num[i]);\n    T.Insert(INT_MAX,0);\n    for(register int i=1;i<=N;i++){\n        T.Insert(num[i],i);\n        ans+=(N-i+1)*T.segsum[T.ch[T.root][1]];\n    }\n    Write(ans);\n    return 0;\n} \n```\n",
        "postTime": 1563109465,
        "uid": 109396,
        "name": "Uniecho1",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5463 \u3010\u5c0f\u9c7c\u6bd4\u53ef\u7231\uff08\u52a0\u5f3a\u7248\uff09\u3011"
    },
    {
        "content": "\u8003\u8bd5\u7684\u65f6\u5019\u5f88\u591a\u4eba$95$\u5206\u5e94\u8be5\u90fd\u662f\u56e0\u4e3a\u6ca1\u6709\u5f00$int128$\u5427\n\n\u771f\u7684\u5751 QAQ\uff0c\u53d6\u4e2a\u819c\u591a\u597d\n\n\u6211\u4eec\u5bf9\u6bcf\u5bf9\u9006\u5e8f\u5bf9\u5355\u72ec\u8003\u8651\uff0c\u8003\u8651\u5176\u4f1a\u88ab\u591a\u5c11\u4e2a\u533a\u95f4\u7b97\n\n\u6ce8\u610f\u5230\u4e00\u5bf9\u9006\u5e8f\u5bf9\uff0c\u5047\u8bbe\u5176\u7531$(i,j)$\u53f7\u5143\u7d20\u6784\u6210\uff0c\u90a3\u4e48\u5176\u5bf9\u7b54\u6848\u4ea7\u751f\u7684\u8d21\u732e\u4e3a\uff1a\n\n$$i*(n-j+1)$$\n\n$ps:($\u67d0\u4e2a\u533a\u95f4\u7684\u5de6\u7aef\u70b9\u53d6$1,2..i$\uff0c\u53f3\u7aef\u70b9\u53d6$j,j+1..n$\u65f6\uff0c\u8fd9\u4e9b\u533a\u95f4\u90fd\u5305\u62ec\u4e86\u8fd9\u4e2a\u9006\u5e8f\u5bf9\uff0c\u6240\u4ee5\u8fd9\u4e2a\u9006\u5e8f\u5bf9\u4f1a\u88ab\u7b97$i*(n-j+1)$\u6b21$)$\n\n\u4e0d\u59a8\u5bf9\u67d0\u4e00\u4e2a$j$\u5355\u72ec\u8003\u8651\uff0c\u5047\u8bbe$k1,k2...k_n$\u4f4d\u7f6e\u5bf9\u5e94\u7684\u6743\u503c\u90fd\u6bd4$j$\u4f4d\u5143\u7d20\u5bf9\u5e94\u6743\u503c\u5927\uff0c\u90a3\u4e48$j$\u7684\u7b54\u6848\u4e3a\uff1a\n\n$$\\sum_{i=1}^nk_i*(n-j+1)$$\n\n\u5229\u7528\u4e00\u4e0b\u4e58\u6cd5\u5206\u914d\u5f8b\uff0c\u6211\u4eec\u7ef4\u62a4\u4e00\u4e0b$k_i$\u7684\u548c\u5373\u53ef\uff0c\u7528\u4e00\u4e0b\u6743\u503c\u6811\u72b6\u6570\u7ec4\uff0c\u7ef4\u62a4\u4f4d\u7f6e\u548c\u3002\n\n\u5148\u5904\u7406\u51fa$1-n$\u533a\u95f4\u7684\u6811\u72b6\u6570\u7ec4\uff0c\u7136\u540e\u4ece$n$\u4f4d\u5f00\u59cb\u5012\u63a8\u6c42\u7b54\u6848\uff0c\u6bcf\u6b21\u79fb\u52a8\u4e00\u4f4d\u540e\u5c06\u8fd9\u4e00\u4f4d\u7684\u4f4d\u7f6e\u4ece\u5bf9\u5e94\u6743\u503c\u51cf\u53bb\u5373\u53ef\n\n\u590d\u6742\u5ea6$O(n \\log n)$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std ; \n#define rep( i, s, t ) for( register int i = s; i <= t; ++ i )\n#define re register\n#define int __int128\nint read() {\n    char cc = getchar(); int cn = 0, flus = 1;\n    while(cc < '0' || cc > '9') {  if( cc == '-' ) flus = -flus;  cc = getchar();  }\n    while(cc >= '0' && cc <= '9')  cn = cn * 10 + cc - '0', cc = getchar();\n    return cn * flus;\n}\nconst int N = 1e6 + 5 ; \nint n, a[N], tree[N], num, Ans ; \nstruct S {\n    int id, s ; \n} s[N];\nbool cmp( S x, S y ) {\n    return x.s < y.s ; \n}\nbool cmp2( S x, S y ) {\n    return x.id < y.id ; \n}\nint lowbit( int x ) {\n    return ( x & ( -x ) ) ;\n}\nvoid add( int x, int k ) {\n    for( int i = x; i <= n; i += lowbit(i) ) tree[i] += k ;\n}\nint query( int x ) {\n    int ans = 0;\n    for( int i = x; i; i -= lowbit(i) ) ans += tree[i] ; \n    return ans ;\n}\nsigned main() {\n    n = read() ; \n    rep( i, 1, n ) a[i] = read(), s[i].id = i, s[i].s = a[i] ;\n    sort( s + 1, s + n + 1, cmp ) ; \n    s[0].s = -1 ; num = 0 ;\n    rep( i, 1, n ) {\n        if( s[i].s != s[i - 1].s ) a[s[i].id] = ++ num ; \n        else a[s[i].id] = num ; \n    }\n    sort( s + 1, s + n + 1, cmp2 ) ; \n    rep( i, 1, n ) add( a[i], i ) ; \n    int ll, rr ; \n    for( re int i = n; i >= 1; -- i ) {\n        rr = n - i + 1 ; \n        ll = query(n) - query( a[i] ) ; \n        Ans += ll * rr ; add( a[i], -i ) ; \n    }\n    printf(\"%d\\n\", Ans ) ; \n    return 0 ; \n}\n```",
        "postTime": 1563103739,
        "uid": 30036,
        "name": "Soulist",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5463 \u3010\u5c0f\u9c7c\u6bd4\u53ef\u7231\uff08\u52a0\u5f3a\u7248\uff09\u3011"
    },
    {
        "content": "\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u5206\u6790\u9898\u610f\uff0c\u5373\u6c42\u533a\u95f4\u9006\u5e8f\u5bf9\u7684\u548c\n\n\n\u6211\u4eec\u8003\u8651\u4f7f\u7528\u6811\u72b6\u6570\u7ec4\uff0c\u5bf9\u6bcf\u4e00\u6761\u9c7c\u6c42\u9006\u5e8f\u5bf9\u5373\u53ef   \n\n\n\u4f46\u8fd9\u8fd8\u6ca1\u6709\u5b8c\u6210\uff0c\u6211\u4eec\u8003\u8651\u6bcf\u6761\u9c7c\u7684\u4ef7\u503c\u5bf9\u603b\u7b54\u6848\u7684\u8d21\u732e\u4e4b\u548c\u7684\u6c42  \u6cd5\n  \n\u4e0b\u9762\u5c06\u8be6\u7ec6\u8bb2\u89e3\u4e00\u4e0b\u5176\u4ed6\u9898\u89e3\u6ca1\u6709\u63d0\u5230\u7684**\u5982\u4f55\u63a8\u51fa\u8d21\u732e\u7684\u65b9\u7a0b**\n\n### \u9996\u5148\uff0c\u6211\u4eec\u6784\u9020\u4e00\u4e2a\u5e8f\u5217\uff1a\uff08\u5f53\u7136\u8fd9\u4e0d\u662f\u7b54\u6848\uff09\n\n$1$ $2$ $3$ $4$ $5$\n\n\u5b83\u6240\u80fd\u7ec4\u5408\u7684\u533a\u95f4\u670915\u79cd\uff08\u5373$C\\binom 2 5=15$\uff09\uff0c\u5982\u4e0b\uff1a\n\n\u5355\u5143\u7d20\uff1a $1$ $2$ $3$ $4$ $5$  \n\u53cc\u5143\u7d20\uff1a $12$ $23$ $34$ $45$  \n\u4e09\u5143\u7d20\uff1a $123$ $234$ $345$  \n\u56db\u5143\u7d20\uff1a $1234$  $2345$   \n\u4e94\u5143\u7d20\uff1a $12345$\n\n\u5176\u4e2d\uff0c$1$\u8d21\u732e\u4e86$5$\u6b21\uff0c$2$\u8d21\u732e\u4e86$8$\u6b21\uff0c$3$\u8d21\u732e\u4e86$9$\u6b21\uff0c$4$\u8d21\u732e\u4e86$8$\u6b21\uff0c$5$\u8d21\u732e\u4e86$5$\u6b21\n\n### \u4ee5\u6b64\u7c7b\u63a8\uff1a\n\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u8fd9\u4e2a\u8868\uff1a     \n   \n$1$  \n$2$ $2$  \n$3$ $4$ $3$  \n$4$ $6$ $6$ $4$  \n$5$ $8$ $9$ $8$ $5$  \n$6$ $10$ $12$ $12$ $10$ $6$    \n\n...........\n\n$n\\ 2(n-1)\\ 3(n-2)\\ 4(n-3)\u2026\u2026i(n-i+1)$\n\n### \u7efc\u4e0a\uff0c\u5bf9\u4e8e\u603b\u957f\u5ea6\u4e3an\u7684\u5e8f\u5217\uff1a  \n \n\u6bcf\u4e2a\u5143\u7d20\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e3a$i\u00d7(n-i+1)$\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u7528\u6811\u72b6\u6570\u7ec4\u5bf9\u9006\u5e8f\u5bf9\u8fdb\u884c\u5904\u7406\uff0c\u968f\u540e\u7edf\u8ba1\u603b\u8d21\u732e\u5373\u53ef\u3002  \n\n~~\u5446~~\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define in inline\n#define reg register\n#define MAX 20030813\n#define int __int128\nusing namespace std;\nnamespace qwq{\n\tin void read(int &o)\n\t{\n\t\to=0;int w=1;\n\t\tchar c=getchar();\n\t\twhile(c<'0'||c>'9')\n\t\t{\n\t\t\tif(c=='-')w*=-1;\n\t\t\tc=getchar();\n\t\t}\n\t\twhile(c>='0'&&c<='9')\n\t\t{\n\t\t\to=(o<<3)+(o<<1)+(c^48);\n\t\t\tc=getchar();\n\t\t}\n\t\to*=w;\n\t}\n\tin void write(int x)\n\t{\n\t\tif(x<0)putchar('-');\n\t\tif(x>9)write(x/10);\n\t\tputchar(x%10+48);\n\t}\n\tin int max(int a,int b){return a>b?a:b;}\n\tin int min(int a,int b){return a<b?a:b;}\n}\nusing namespace qwq;\nint n,t[MAX],ans,b[MAX];\nclass Num\n{\npublic:\n\tint id,N;\n\tvoid input(int i){read(N),id=i;}\n\tbool operator<(const Num&n)const{return (N==n.N)?(id<n.id):(N<n.N);}\n}a[MAX];\n#define lowbit(x) x&-x\nvoid add(int x,int k)\n{\n\tfor(;x<=n;x+=lowbit(x))t[x]+=k;\n}\nin int query(int x)\n{\n\tint sum=0;\n\tfor(;x;x-=lowbit(x))sum+=t[x];\n\treturn sum;\n}\nsigned main()\n{\n\tread(n);\n\tint sum=0;\n\tfor(reg int i=1;i<=n;++i)a[i].input(i);\n\tsort(a+1,a+n+1);\n\tfor(reg int i=n;i>=1;--i)\n\t{\n\t\tb[i]=query(a[i].id-1);\n\t\t//write(b[i]),putchar(' ');\n\t\tadd(a[i].id,a[i].id);\n\t}\n\tfor(reg int i=1;i<=n;++i)\n\t{\n\t\tans+=(n-a[i].id+1)*b[i];\n\t}\n\twrite(ans);\n\treturn 0;\n}\n\n```\n### $n<=10^6$\uff0c\u7528 $int128$\u6c34\u4e00\u4e0b\n",
        "postTime": 1563105015,
        "uid": 112742,
        "name": "_MRCMRC_",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P5463 \u3010\u5c0f\u9c7c\u6bd4\u53ef\u7231\uff08\u52a0\u5f3a\u7248\uff09\u3011"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://llf0703.com/p/luogu-monthly-201907.html#c-p5463%E5%B0%8F%E9%B1%BC%E6%AF%94%E5%8F%AF%E7%88%B1%EF%BC%88%E5%8A%A0%E5%BC%BA%E7%89%88%EF%BC%89)\n\n## \u9898\u610f\n\n\u7528 $\\text{cnt[i][j]}$ \u8868\u793a\u533a\u95f4 $[i,j]$ \u7684\u9006\u5e8f\u5bf9\u4e2a\u6570\uff0c\u6c42\uff1a\n\n$$\\sum_{i=1}^n \\sum_{j=i}^n \\text{cnt[i][j]}$$\n\n## \u9898\u89e3\n\n\u8003\u8651\u6bcf\u4e2a\u9006\u5e8f\u5bf9 $(S_i,S_j)$ \u5bf9\u7b54\u6848\u7684\u8d21\u732e\u3002\u663e\u7136\u5b83\u4f1a\u5bf9\u6240\u6709 **\u8d77\u70b9 $\\in [1,i]$ \u4ee5\u53ca\u7ec8\u70b9 $\\in [j,n]$ \u7684\u533a\u95f4** \u4ea7\u751f $1$ \u7684\u8d21\u732e\uff0c\u603b\u7684\u8d21\u732e\u4e3a\n\n$$i\\times (n-j+1)$$\n\n\u7136\u540e\u8003\u8651\u56fa\u5b9a\u7684 $S_j$ \u7684\u8d21\u732e\uff0c\u5bf9\u4e8e\u6240\u6709 $i<j$ \u4e14 $S_i>S_j$ \uff0c\u8fd9\u4e2a $S_i$ \u90fd\u4f1a\u4ea7\u751f\u4e0a\u5f0f\u7684\u8d21\u732e\u3002\u8bbe $T_k$ \u8868\u793a\u5728 $j$ \u4e4b\u524d\u6240\u6709\u6570\u503c $k$ \u7684**\u4e0b\u6807\u548c**\uff0c\u90a3\u4e48\u6bcf\u4e2a $j$ \u7684\u8d21\u732e\u4e3a\n\n$$\\sum T_k \\ , \\ k>S_j$$\n\n\u663e\u7136 $T_k$ \u53ef\u4ee5\u79bb\u6563\u5316\u540e\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\uff0c\u7136\u540e\u679a\u4e3e\u6bcf\u4e2a $j$ \u5c31\u53ef\u4ee5\u5f97\u5230\u7b54\u6848\u3002\n\n\u5b9e\u9645\u4e0a\u5c31\u662f\u628a\u6c42\u9006\u5e8f\u5bf9\u65f6 $+1$ \u7ed9\u6362\u6210\u4e86 $+$ \u5f53\u524d\u4e0b\u6807\uff0c\u67e5\u8be2\u65f6\u628a\u7b54\u6848 $\\times (n-i+1)$ \u3002\n\n\u7b54\u6848\u4f1a\u7206 `long long` \uff0c\u6211\u76f4\u63a5\u7528 `__int128` \u6c34\u8fc7\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n\nusing namespace std;\n\ninline ll read()\n{\n    char ch=getchar();\n    ll f=1,x=0;\n    while (ch<'0' || ch>'9')\n    {\n        if (ch=='-') f=-1;\n        ch=getchar();\n    }\n    while (ch>='0' && ch<='9')\n    {\n        x=x*10+ch-'0';\n        ch=getchar();\n    }\n    return f*x;\n}\n\nstruct node {\n    ll s,id;\n} s[1000005];\nll n,ord[1000005],t[1000005];\n\ninline ll lowbit(ll x) { return x&-x; }\n\ninline void add(ll x,ll y) { for (;x<=n;x+=lowbit(x)) t[x]+=y; }\n\ninline ll query(ll x)\n{\n    ll ans=0;\n    for (;x;x-=lowbit(x)) ans+=t[x];\n    return ans;\n}\n\ninline bool cmp(const node &x,const node &y) { return x.s==y.s ? x.id>y.id : x.s>y.s; }\n\nvoid print(__int128 x)\n{\n    if (x==0) return;\n    print(x/10);\n    putchar(x%10+'0');\n}\n\nsigned main()\n{\n    n=read();\n    for (ll i=1;i<=n;i++) s[i].s=read(),s[i].id=i;\n    sort(s+1,s+n+1,cmp);\n    for (ll i=1;i<=n;i++) ord[s[i].id]=i; //\u79bb\u6563\u5316\n    __int128 ans=0;\n    for (ll i=1;i<=n;i++)\n    {\n        add(ord[i],i);\n        ans+=query(ord[i]-1)*(n-i+1);\n    }\n    if (ans==0) puts(\"0\");\n    else print(ans);\n    return 0;\n}\n```",
        "postTime": 1563103470,
        "uid": 29696,
        "name": "Llf0703",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5463 \u3010\u5c0f\u9c7c\u6bd4\u53ef\u7231\uff08\u52a0\u5f3a\u7248\uff09\u3011"
    },
    {
        "content": "## ~~\u8fd9\u4e0d\u662f\u5f52\u5e76\u6392\u5e8f\u5417~~\n\n\u5927\u5bb6\u5e94\u8be5\u90fd\u505a\u8fc7\u6c42\u9006\u5e8f\u5bf9\u8fd9\u9053\u9898\n\n## [\u5f52\u5e76\u6392\u5e8f\u677f\u5b50\u9898](https://www.luogu.org/problemnew/show/P1908)\n\n\u5176\u6838\u5fc3\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n\tint mid=(l+r)>>1;\n\tmsort(l,mid);msort(mid+1,r);\n\tint i=l,j=mid+1,len=l-1;\n\twhile(i<=mid&&j<=r)\n\t{\n\t\tif(a[i]>a[j])\n\t\t{\n\t\t\tmmp[++len]=a[j++];\n\t\t\tans+=mid-i+1;\n\t\t}\n\t\telse mmp[++len]=a[i++];\n\t}\n\twhile(i<=mid)mmp[++len]=a[i++];\n\twhile(j<=r)mmp[++len]=a[j++];\n\tfor(int i=l,j=l;i<=r;i++,j++)a[i]=mmp[j];\n```\n\u5177\u4f53\u5b9e\u73b0 ~~\uff08\u8bf7\u5927\u4f6c\u548c\u840c\u65b0\u8df3\u8fc7\u8fd9\u6bb5\uff0c\u849f\u84bb\u7559\u4e0b\uff0c\u90a3\u4e9b\u81ea\u79f0\u521a\u5b66OI\u4e00\u79d2\u7684\u840c\u65b0tql\uff09~~ \uff1a\n\n\u8bbe$a[i]$\u4e3a\u4e0b\u6587\u4e2d\u5de6\u6bb5\u7684\u4e00\u4e2a\u6570\uff0c$a[j]$\u4e3a\u4e0b\u6587\u4e2d\u53f3\u6bb5\u7684\u4e00\u4e2a\u6570\n\n1. \u9012\u5f52\u7529\u9505\uff0c\u5c06\u5e8f\u5217\u4e8c\u5206\uff0c\u5206\u522b\u5c06\u5de6\u53f3\u4e24\u6bb5\u6392\u5e8f\uff0c\u5e76\u5206\u522b\u6c42\u51fa\u4e00\u6bb5\u5185\u7684\u9006\u5e8f\u5bf9\u6570\n\n2. \u73b0\u5728\u6211\u4eec\u6709\u4e86\u4e24\u4e2a**\u5355\u8c03\u9012\u589e**\u7684\u6570\u6bb5\u4e86\uff0c\u4e0b\u4e00\u6b65\u662f\u5408\u5e76\u4e24\u6bb5+\u6c42\u9006\u5e8f\u5bf9\u6570\n\n3. \u9c7f\u9c7c\u6211\u4eec**\u5df2\u7ecf\u6c42\u5b8c\u4e86\u5de6\u3001\u53f3\u5b50\u6bb5\u7684\u9006\u5e8f\u5bf9\u6570**\uff0c\u6240\u4ee5\u5269\u4e0b\u8fd8\u6ca1\u7edf\u8ba1\u7684\u9006\u5e8f\u5bf9\u4f1a\u4ee5$(a[i],a[j])$\u7684\u5f62\u5f0f\u51fa\u73b0\uff0c\u5176\u4e2d$a[i]>a[j]$\n\n\u8bc1\u660e\uff1a\n\n\u4e00\u4e2a\u9006\u5e8f\u5bf9\u6709\u4e24\u4e2a\u6570\uff0c\u4ed6\u4eec\u8981\u4e48**\u90fd\u5728\u5de6\u5b50\u6bb5**\uff1b\u8981\u4e48**\u90fd\u5728\u53f3\u5b50\u6bb5**\uff1b\u8981\u4e48**\u4e00\u4e2a\u5728\u5de6\u5b50\u6bb5\uff0c\u4e00\u4e2a\u5728\u53f3\u5b50\u6bb5**\uff1b\uff08\u51713\u79cd\u60c5\u51b5\uff09\n\n\u5bf9\u4e8e\u90fd\u5728\u5de6\u5b50\u6bb5\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u5df2\u7ecf\u9012\u5f52\u7529\u9505\u7edf\u8ba1\u8fc7\u4e86\uff0c\u53f3\u5b50\u6bb5\u540c\u7406\uff0c\u6240\u4ee5\uff0c\u4ec5\u5269**\u4e00\u5de6\u4e00\u53f3**\u7684\u60c5\u51b5\u4e86\n\n4. \u7edf\u8ba1\u9006\u5e8f\u5bf9$(a[i],a[j])$\u7684\u4e2a\u6570\uff08\u987a\u4fbf\u6392\u5e8f\uff09\n\n\u5b9a\u4e49 $i$ \u4e3a\u5de6\u6bb5\u5230\u8fbe\u7684\u7f16\u53f7\uff0c$j$\u4e3a\u53f3\u6bb5\u5230\u8fbe\u7684\u7f16\u53f7\n\n$i$ \u4ece $l$ \u5f00\u59cb\uff08\u5de6\u6bb5\uff09\uff0c$j$\u4ece$mid+1$\u5f00\u59cb\uff08\u53f3\u6bb5\uff09\n\n\u5f53\u524d\uff0c\u82e5$a[i]>a[j]$\uff0c\u7531\u4e8e\u5b50\u6bb5\u5355\u8c03\u9012\u589e\uff0c$so$\uff0c$a[mid]>a[mid-1]>...>a[i+1]>a[i]$\n\n\u6240\u4ee5 $a[i$~$mid]$ \u5168\u90fd\u5927\u4e8e$a[j]$\n\n$i$~$mid$\u6709$mid-i+1$\u4e2a\u6570\uff0c$ans+=mid-i+1$\u7136\u540e$j++$\n\n\u82e5$a[i]<=a[j]$\uff0c\u5219$i++$\n\n\u6bcf\u6b21 $i$ \u6216$j$\u53d8\u5316\u65f6\uff0c\u5c06\u6570\u5b57\u5b58\u5165~~\u590d\u5236\u7c98\u8d34~~\u6570\u7ec4\u91cc\uff08\u5165\u961f\u7684\u90a3\u4e2a\u4e00\u5b9a\u662f\u66f4\u5c0f\u7684\uff09\n\n\u82e5 $i$ \u6216$j$\u6ca1\u5230\u8fb9\u754c\uff0c\u5c31\u628a\u5269\u4f59\u90e8\u5206\u5806\u8fdb\u53bb\u597d\u4e86\n\n\u6700\u540e\u8d34\u56de\u6765\u5c31\u80fd\u4f7f\u6570\u5217\u6709\u5e8f\n\n\u4e3a\u4ec0\u4e48\u8fd9\u6837\u8ba1\u7b97\u7684\u9006\u5e8f\u5bf9\u6570\u662f\u6b63\u786e\u7684\uff1a\n\n\u6839\u636e\u7b2c3\u70b9\uff0c\u6211\u4eec\u6709$a[i]>a[j]$\uff0c\u6211\u4eec\u662f\u679a\u4e3e\u6bcf\u4e2a$a[j]$\uff08\u5b83\u66f4\u5c0f\uff09\uff0c\u6c42\u5de6\u6bb5\u6bd4\u5b83\u5927\u7684\u6709\u591a\u5c11\u4e2a\u6570\uff08\u8fd9\u91cc\u8ba8\u8bba\u2018\u2018\u4e00\u5de6\u4e00\u53f3\u2019\u2019\u7684\u60c5\u51b5\uff09\n\n\u56e0\u4e3a$a[j]$\u968f\u7740$j$\u7684\u589e\u52a0\u4f1a\u8d8a\u6765\u8d8a\u5927\uff0c\u6240\u4ee5\u5bf9$a[i]$\u7684\u8981\u6c42\u4e5f\u4f1a\u8d8a\u6765\u8d8a\u5927\uff0c$i$\u4e5f\u4f1a\u6162\u6162\u589e\u52a0\n\n\u8fd9\u4fbf\u662f~~\u4f20\u8bf4\u4e2d\u7684~~\u5355\u8c03\u6027\uff0c\n\n\u6839\u636e$while$\u6761\u4ef6\uff0c\u6700\u540e\u4f1a\u5269\u4e0b\u5de6\u8fb9\u672b\u5c3e\u4e00\u622a\u6216\u53f3\u8fb9\u672b\u5c3e\u4e00\u622a\n\n\u8fd9\u65f6\u65e0\u9700\u7edf\u8ba1\n\n\u5269\u4e0b\u5de6\u8fb9\u672b\u5c3e\u4e00\u622a\uff1a\u6211\u4eec\u679a\u4e3e\u7684\u662f$a[j]$\uff0c$j$\u90fd\u6ca1\u4e86\uff08\u8fc7\u4e86$r$\uff09\u3002\u3002\u3002\n\n\u5269\u4e0b\u53f3\u8fb9\u672b\u5c3e\u4e00\u622a\uff1a\u6b64\u65f6$a[j]$\u6bd4\u6240\u6709$a[i]$\u5927\uff0c\u5c31\u6ca1\u6709\u9006\u5e8f\u5bf9\u4e86\n\n5. \u4e0d\u65ad\u5206\u6cbb\uff0c\u4e0d\u65ad\u5408\u5e76\uff0c\u590d\u6742\u5ea6$O($\u5de8\u5927\u5e38\u6570$+NlogN)$\u7684\u5f52\u5e76\u6392\u5e8f\u51fa~~\u9505~~\u7089\u4e86\n\n## ~~\u8fd9\u53ea\u662f\u524d\u7f6e\u829d\u58eb\uff0c\u5982\u679c\u4f60\u5acc\u9ebb\u70e6\uff0c\u8c01\u53eb\u4f60\u4e0d\u770b\u4e0a\u9762\u63d0\u793a~~\n\n### \u6b63\u9898\uff08\u6ed1\u7a3d\uff09\n\n\u6ce8\u610f\u5f00\u9ad8\u7cbe\u6216\u8005__int128\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u9006\u5e8f\u5bf9$(a[i],a[j])$\n\n\u4ed6\u4eec\u4f1a\u88ab$i*(n-j+1)$\u4e2a\u533a\u95f4\u626b\u5230\uff08\u5de6\u8fb9\u5ef6\u4f38\uff0c\u53f3\u8fb9\u5ef6\u4f38~\uff09\n\n\u6211\u4eec\u7ee7\u7eed\u7528\u5f52\u5e76\u6392\u5e8f\u505a\n\n\u53ea\u4e0d\u8fc7\uff0c\u4ee3\u7801\u6709\u4e9b\u6539\u52a8\n\n```cpp\n#include<cstdio>\nusing namespace std;\ntypedef __int128 ll;\nstruct node\n{\n    ll z,p;\n}a[1000005],mmp[1000005];\nvoid swap(node &x,node &y){node t=x;x=y;y=t;}\nll read()\n{\n    ll s=0,f=1;\n    char c=getchar();\n    while(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n    while(c>='0'&&c<='9'){s=(s<<3)+(s<<1)+c-'0';c=getchar();}\n    return s*f;\n}\nvoid write(ll x)\n{\n    if(x<0){putchar('-');x=-x;}\n    if(x>9)write(x/10);\n    putchar(x%10+'0');\n}\nll n;\nll ans=0;\nvoid msort(ll l,ll r)\n{\n    if(l>=r)return ;\n    if(r-l==1)\n    {\n        if(a[l].z>a[r].z){ans+=(n-a[r].p+1)*a[l].p;swap(a[l],a[r]);}\n        return ;\n    }//\u4e2a\u4eba\u4e60\u60ef\uff0c\u53ef\u4ee5\u53bb\u6389\n    ll mid=(l+r)>>1;\n    msort(l,mid);msort(mid+1,r);\n    ll i=l,j=mid+1,len=l-1,sum=0;\n    bool bk=false;\n    while(i<=mid&&j<=r)\n    {\n        if(a[i].z>a[j].z)\n        {\n        \tsum+=(n-a[j].p+1);\n            if(!bk)ans+=a[i].p*sum;\n            else ans+=a[i].p*(n-a[j].p+1);\n            mmp[++len]=a[j++];\n            bk=true;\n        }\n        else\n        {\n            if(!bk)ans+=a[i].p*sum;\n            mmp[++len]=a[i++];\n            bk=false;\n        }\n    }\n    while(i<=mid)\n    {\n        mmp[++len]=a[i++];\n        if(i<=mid)ans+=a[i].p*sum;\n    }\n    while(j<=r)mmp[++len]=a[j++];\n    for(ll i=l,j=l;i<=r;i++,j++)a[i]=mmp[j];\n}\nint main()\n{\n    n=read();\n    ans=0;\n    for(ll i=1;i<=n;i++)\n    {\n        a[i].z=read();\n        a[i].p=i;\n    }\n    msort(1,n);\n    write(ans);puts(\"\");\n    return 0;\n}\n```\n\u8fd9\u6b21\u679a\u4e3e\u7684\u662f$a[i]$\uff0c\u5982\u679c\u679a\u4e3e$a[j]$\uff0c\u90a3\u4e48\u539f\u6765\u7684$ans+=mid-i+1$\u64cd\u4f5c\u4f1a\u53d8\u5f97\u9ebb\u70e6\n\n\u679a\u4e3e$a[i]$\u5c31\u80fd\u6b63\u5e8f\u8fd0\u884c\u4e86\n\n\u8fd0\u7528\u524d\u7f00\u548c\u601d\u60f3\uff0c$bk$\u662f\u9632\u6b62\u91cd\u590d\u7edf\u8ba1\n\n### \u81f3\u6b64\uff0c\u5b8c\u7ed3\u6492$huaji$~",
        "postTime": 1563109212,
        "uid": 120634,
        "name": "2018heyuyang",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5463 \u5c0f\u9c7c\u6bd4\u53ef\u7231\uff08\u52a0\u5f3a\u7248\uff09"
    },
    {
        "content": "\u4e00\u7ec4\u9006\u5e8f\u5bf9(a[i],a[j]) \u8d21\u732e\u4e86 i*(n-j+1)\u6b21\n\n\u8003\u8651\u6811\u72b6\u6570\u7ec4\u6c42\u9006\u5e8f\u5bf9\uff0c\u5148\u79bb\u6563\u5316\uff0c\u53ea\u662f\u52a0\u5165\u7684\u65f6\u5019\u52a0\u5165n-i+1\uff0c\u7d2f\u8ba1\u6c42\u548c\u7684\u65f6\u5019\u4e58\u4e0ai\u5c31\u884c\u4e86\n\n\u6ce8\u610f\u8fd9\u9053\u9898\u4f1a\u7206long long,\u7528\u9ad8\u7cbe\u5ea6\u5c31\u597d\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nstruct note{\n    int id,x;\n}a[1000005];\nbool cmp(note ax,note bx){return ax.x==bx.x?ax.id<bx.id:ax.x<bx.x;}\nint n,b[1000005],d[1005],ans[1005];\nunsigned long long s,c[1000005];\ninline long long read(){\n   long long s=0,w=1;\n   char ch=getchar();\n   while(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n   while(ch>='0'&&ch<='9') s=s*10+ch-'0',ch=getchar();\n   return s*w;\n}\n//////////////\u9ad8\u7cbe\u5ea6 \nvoid jia(){\n    memset(d,0,sizeof(d));\n    while(s>0){\n        d[++d[0]]=s%10;\n        s/=10;\n    }\n    if(ans[0]<d[0])ans[0]=d[0];\n    for(int i=1;i<=ans[0];i++)ans[i]+=d[i];\n    for(int i=1;i<=ans[0];i++){ans[i+1]+=ans[i]/10;ans[i]=ans[i]%10;}\n    if(ans[ans[0]+1]>0)ans[0]++;\n}\nvoid out(){if(ans[0]==0)cout<<0;for(int i=ans[0];i>=1;i--)cout<<ans[i];}\n//////////////\n\n//////////////\u6811\u72b6\u6570\u7ec4 \ninline int lowbit(int x){return x&(-x);}\nvoid Add(int x,int k){for(register int i=x;i<=n;i+=lowbit(i))c[i]+=k;}\nlong long Sum(int x){long long Ans=0;for(register int i=x;i>0;i-=lowbit(i))Ans+=c[i];return Ans;}\n//////////////\n\nint main(){\n    ans[0]=1;\n    n=read();\n    for(register int i=1;i<=n;i++)a[i].x=read(),a[i].id=i;\n    sort(a+1,a+n+1,cmp);\n    for(int i=1;i<=n;i++)b[a[i].id]=i;//\u79bb\u6563\u5316 \n    for(register long long i=n;i>=1;i--){\n        s=Sum(b[i]-1)*i;\n        jia();s=0;\n//\t\tcout<<ans<<'\\n';\n//\t\tcout<<a[i].id<<\" \"<<a[i].x<<\" \"<<b[i]<<\"\\n\";\n        Add(b[i],n-i+1);\n    }\n    out();\n    return 0;\n}\n```\n",
        "postTime": 1563113574,
        "uid": 88137,
        "name": "greenheadstrange",
        "ccfLevel": 7,
        "title": "\u6811\u72b6\u6570\u7ec4+\u9006\u5e8f\u5bf9 P5463\u3010\u5c0f\u9c7c\u6bd4\u53ef\u7231\uff08\u52a0\u5f3a\u7248\uff09\u3011"
    },
    {
        "content": "# \u770b\u4e86\u4f17\u591a\u6811\u72b6\u6570\u548c\u5f52\u5e76\u6392\u5e8f\uff0c\u6211\u51b3\u5b9a\u63d0\u4ea4\uff1aN^2\u9012\u63a8\u7b97\u6cd5\uff0860 points\uff09\uff01\n\n## \u6027\u80fd\u6bd4\u8f83\uff1a\n### 1. \u65f6\u95f4\uff1a2*N^2\uff08\u8f7b\u677e\u8fc710^6\u6570\u636e\uff09\n### 2.\u7a7a\u95f4\uff1aN^2\u4e8c\u7ef4\u6570\u7ec4(\u540e4\u4e2a\u70b9MLE\uff0c\u7a7a\u95f4\u7206\u4e86)\n### 3. \u4ee3\u7801\u91cf\uff1a20\u884c\u4ee3\u7801\n### 4. \u601d\u8003\u91cf\uff1a\u5b9e\u73b0\u524d\u7f00\u548c\u5f88\u70e7\u8111\n\n## \u7b97\u6cd5\u601d\u60f3\uff1a\n\n### \u6211\u4eec\u4e0d\u96be\u53d1\u73b0\uff0c\u533a\u95f4[i,j]\u7684\u9006\u5e8f\u5bf9\u6570=\u533a\u95f4[i,j-1]\u7684\u9006\u5e8f\u5bf9\u6570+a[i~j-1]\u8fd9\u4e2d\u5927\u4e8ea[j]\u7684\u4e2a\u6570\uff08\u5176\u5b9e\u5c31\u662f\u65b0\u589e\u7684\u9006\u5e8f\u5bf9\u6570\uff09\u3002\n### Therefore,all we need to do is making preparations.\n#### 1.\u7528f[i][j]\u8868\u793aa[i]\u548ca[j]\u7684\u5927\u5c0f\u5173\u7cfb\uff0ca[i]>a[j]\u5219f[i][j]=1,\u5426\u5219\u4e3a0\uff1b\n#### 2. \u91c7\u7528\u524d\u7f00\u548c\uff0c\u7528sum[i][j]\u5b58a[i~j-1]\u4e2d\u6bd4a[j]\u5927\u7684\u4e2a\u6570;\n#### 3.sum[i][j]=sum[i+1][j]+f[i][j]\uff1b\u65e2\u7136\u90fd\u8fd9\u4e48\u4e9b\u4e86\uff0c\u90a3\u4e48\u5916\u5c42\u5faa\u5316\u5e94\u8be5\u662fj\uff0c\u5185\u5c42\u662fi\u3002\n### \u73b0\u5728\u4f9b\u4e0a\u9884\u5904\u7406\u4ee3\u7801\uff1a\n```cpp\nint n;cin>>n;\n    for(int i=1;i<=n;i++) cin>>a[i];\n    for(int R=n;R>=2;R--){\n        for(int L=R-1;L>=1;L--){\n        \tif(a[L]>a[R]) f[L][R]=1;\n        \tsum[L][R]=sum[L+1][R]+f[L][R];\n        }\n    }//sum[L][R]\u8868\u793a\u4eceL\u5230R-1\u7684\u6570\u4e2d\u5927\u4e8ea[R]\u7684\u6570 \n```\n### \u6709\u4e86\u9884\u5904\u7406ans[i][j]=ans[i][j-1]+sum[i][j],\u518d\u7528tot\u7d2f\u52a0\u5373\u53ef;\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\nlong long a[10001],sum[1001][1001],f[1001][1001],ans[1001][1001],tot;\n\nint main(){\n    int n;cin>>n;\n    for(int i=1;i<=n;i++) cin>>a[i];\n    for(int R=n;R>=2;R--){\n        for(int L=R-1;L>=1;L--){\n        \tif(a[L]>a[R]) f[L][R]=1;\n        \tsum[L][R]=sum[L+1][R]+f[L][R];\n        }\n    }//sum[L][R]\u8868\u793a\u4eceL\u5230R-1\u7684\u6570\u4e2d\u5927\u4e8ea[R]\u7684\u6570 \n    for(int i=1;i<=n-1;i++){\n        for(int j=i+1;j<=n;j++){\n            ans[i][j]=ans[i][j-1]+sum[i][j];\n            tot+=ans[i][j]; \n        }\n    }\n    cout<<tot;\n    \n    return 0;\n}\n```\n\n",
        "postTime": 1563160267,
        "uid": 104308,
        "name": "Capitalism_Gao",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5463 \u3010\u5c0f\u9c7c\u6bd4\u53ef\u7231\uff08\u52a0\u5f3a\u7248\uff09\u3011"
    }
]
[
    {
        "content": "### \u5206\u5c42\u56fe\u6700\u5927\u6d41\n\n\u5efa\u8bae\u548c[[CTSC1999]\u5bb6\u56ed](https://www.luogu.org/problemnew/show/P2754)\u4e00\u8d77\u505a\uff0c\u56e0\u4e3a\u8fd9\u4e24\u9053\u9898\u7684\u601d\u8def\u57fa\u672c\u4e0a\u662f\u4e00\u6837\u7684\u3002\n\n\u6309\u7167\u65f6\u95f4\u5efa$T+1$\u5c42\u5206\u5c42\u56fe\uff0c\u6bcf\u4e00\u5c42\u90fd\u662f$n*m$\u4e2a\u70b9\u5bf9\u5e94\u7740\u8fd9\u4e2a\u65f6\u523b\u539f\u56fe\u7684$n*m$\u4e2a\u70b9\u3002\n\n\u9996\u5148\u6e90\u70b9\u5411\u7b2c0\u5c42\u7684\u6bcf\u4e2a\u63a2\u9669\u961f\u5458\u70b9\u8fde\u6d41\u91cf\u4e3a1\u7684\u8fb9\uff0c\u5982\u679c\u6700\u7ec8\u80fd\u6d41\u5230\u4e86\u6c47\u70b9\u8bf4\u660e\u8fd9\u4e2a\u4eba\u9003\u8131\u4e86\u3002\n\n\u5bf9\u4e8e\u4efb\u610f\u4e00\u5c42\uff1a\n\n(\u9996\u5148\u89c4\u5b9a\u969c\u788d\u6c38\u4e0d\u8fde\u8fb9)\n\n\u6bcf\u4e2a\u4f4d\u7f6e\u5728\u8fd9\u4e00\u5c42\u5bf9\u5e94\u70b9\u5411\u6bcf\u4e2a\u4ed6\u80fd\u5230\u8fbe\u7684\u4f4d\u7f6e(\u4e0a\u4e0b\u5de6\u53f3)\u5728\u4e0b\u4e00\u5c42\u5bf9\u5e94\u70b9\u8fde\u4e00\u6761\u6d41\u91cf\u4e3a$inf$\u7684\u8fb9\uff0c\u8868\u793a\u8fd9\u4e00\u79d2\u53ef\u4ee5\u6709\u4efb\u610f\u591a\u7684\u4eba\u4ece\u4e00\u4e2a\u7a7a\u5730\u79fb\u52a8\u5230\u53e6\u4e00\u5757\u7a7a\u5730\u3002\n\n\u6bcf\u4e2a\u7a7a\u5730/\u51fa\u53e3\u5728\u8fd9\u4e00\u5c42\u7684\u5bf9\u5e94\u70b9\u5411\u5b83\u5728\u4e0b\u4e00\u5c42\u7684\u5bf9\u5e94\u70b9\u8fde$inf$\u7684\u8fb9\u8868\u793a\u8fd9\u4e2a\u4f4d\u7f6e\u53ef\u4ee5\u5bb9\u7eb3inf\u4e2a\u4eba\u4e0d\u52a8\u3002\n\n\u6bcf\u4e2a\u51fa\u53e3\u5728\u8fd9\u4e00\u5c42\u7684\u5bf9\u5e94\u70b9\u5411\u6c47\u70b9\u8fde\u4e00\u6761\u6d41\u91cf\u4e3a1\u7684\u8fb9\u8868\u793a\u6bcf\u4e2a\u65f6\u523b\u53ea\u5141\u8bb8\u4e00\u4e2a\u4eba\u8131\u9669\u3002\n\n\u7136\u540e\u76f4\u63a5\u8dd1$dinic$\u6c42\u6700\u5927\u6d41\u5373\u4e3a\u7b54\u6848\n\n```cpp\n#include<map>\n#include<cmath>\n#include<ctime>\n#include<queue>\n#include<vector>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define qmin(x,y) (x=min(x,y))\n#define qmax(x,y) (x=max(x,y))\n#define mp(x,y) make_pair(x,y)\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> pii;\ninline int read(){\n\tint ans=0,fh=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9'){\n\t\tif(ch=='-') fh=-1;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0'&&ch<='9')\n\t\tans=ans*10+ch-'0',ch=getchar();\n\treturn ans*fh;\n}\nconst int maxn=1e4+100,maxm=5e5+100,maxd=20;\nconst int inf=0x7fffffff;\nint n,m,T,head[maxn],nex[maxm],v[maxm],w[maxm],num=1;\nint p[maxd][maxd],bh[maxd][maxd],cur[maxn],cc[maxn],s,t;\nint uu[4]={1,0,-1,0},vv[4]={0,-1,0,1};\nchar c[maxd];\nqueue<int>q;\ninline void add(int x,int y,int z){\n\tv[++num]=y,w[num]=z,nex[num]=head[x],head[x]=num;\n\tv[++num]=x,w[num]=0,nex[num]=head[y],head[y]=num;\n}\ninline void build(){\n\ts=0,t=maxn-1;\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++)\n\t\t\tif(p[i][j]==2) add(s,bh[i][j],1);\n\tint nm=n*m;\n\tfor(int d=0;d<=T;d++){\n\t\tint st=nm*d;\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tfor(int j=1;j<=m;j++){\n\t\t\t\tif(!p[i][j]) continue;\n\t\t\t\tint x=st+bh[i][j];\n\t\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\t\tint vx=i+uu[k],vy=j+vv[k];\n\t\t\t\t\tif(vx<1||vx>n||vy<1||vy>m) continue;\n\t\t\t\t\tif(p[vx][vy]) add(x,st+nm+bh[vx][vy],inf);\n\t\t\t\t}\n\t\t\t\tif(p[i][j]==3) add(x,t,1),add(x,x+nm,1);\n\t\t\t\telse add(x,x+nm,inf);\n\t\t\t}\n\t}\n}\ninline bool bfs(){\n\tmemset(cc,0,sizeof(cc));\n\tcc[s]=1,q.push(s);\n\twhile(!q.empty()){\n\t\tint x=q.front();q.pop();\n\t\tfor(int i=head[x];i;i=nex[i]){\n\t\t\tint y=v[i];if(!w[i]) continue;\n\t\t\tif(!cc[y]) cc[y]=cc[x]+1,q.push(y);\n\t\t}\n\t}\n\treturn cc[t];\n}\nint dfs(int x,int lv){\n\tif(x==t) return lv;\n\tfor(int &i=cur[x];i;i=nex[i]){\n\t\tint y=v[i];if(!w[i]) continue;\n\t\tif(cc[y]==cc[x]+1){\n\t\t\tint pp=dfs(y,lv>w[i]?w[i]:lv);\n\t\t\tif(pp){\n\t\t\t\tw[i]-=pp,w[i^1]+=pp;\n\t\t\t\treturn pp;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\ninline int dinic(){\n\tint maxl=0,lv=0;\n\twhile(bfs()){\n\t\tmemcpy(cur,head,sizeof(cur));\n\t\twhile(lv=dfs(s,inf)) maxl+=lv;\n\t}\n\treturn maxl;\n}\nint main(){\n//\tfreopen(\"nh.in\",\"r\",stdin);\n//\tfreopen(\"zhy.out\",\"w\",stdout);\n\tn=read(),m=read(),T=read();\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%s\",c+1);\n\t\tfor(int j=1;j<=m;j++){\n\t\t\tbh[i][j]=(i-1)*m+j;\n\t\t\tif(c[j]=='.') p[i][j]=1;\n\t\t\tif(c[j]=='P') p[i][j]=2;\n\t\t\tif(c[j]=='O') p[i][j]=3;\n\t\t}\n\t}\n\tbuild();\n\tprintf(\"%d\\n\",dinic());\n\treturn 0;\n}\n```\n",
        "postTime": 1560826145,
        "uid": 53421,
        "name": "nianheng",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3851 \u3010[TJOI2007]\u8131\u9669\u3011"
    },
    {
        "content": "### \u4e8c\u5206\u56fe\u6700\u5927\u5339\u914d\n#### \u5206\u6790\n\u4ece\u6bcf\u4e2a\u4eba\u8dd1\u4e00\u904dbfs,\u5f97\u5230\u8fd9\u4e2a\u4eba\u5230\u67d0\u4e2a\u51fa\u53e3\u7684\u6700\u77ed\u65f6\u95f4t\n\n\u90a3\u4e48\u5982\u679c\u5c06\u95e8\u548c\u65f6\u95f4\u7684\u4e8c\u5143\u7ec4\u770b\u4f5c\u4e00\u4e2a\u72b6\u6001\n\n\u5373(id,tim),\u7136\u540e\u4eba\u5411(id,t),(id,t+1)....(id,T)\u8fde\u8fb9\n\n\u8868\u793a\u8fd9\u4e2a\u4eba\u5728\u8fd9\u4e9b\u65f6\u95f4\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u51fa\u53e3\n\n\u7136\u540e\u5c31\u6784\u6210\u4e86\u4e8c\u5206\u56fe,\u4eba\u548c\u4e00\u4e2a\u4e8c\u5143\u7ec4\n\n\u8dd1\u5308\u7259\u5229\u7b97\u6cd5\u5c31\u53ef\u4ee5\u4e86\n\n#### Code\n```cpp\n#include<algorithm>\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<queue>\n#define N 550\nusing namespace std;\ninline int read(){\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();}\n\treturn x*f;\n}\nstruct node{\n\tint x,y,len;\n\tnode(){}\n\tnode(int a,int b,int c){x=a;y=b;len=c;}\n};\nchar ch[N];\nqueue<node> q;\nbool used[N][N],e[N][N][N];\nint dx[4]={1,-1,0,0},dy[4]={0,0,1,-1};\nint ans,R,C,T,t1,t2,vis[N][N],id[N][N],map[N][N],mat[N][N];\nbool ok(int x,int y){\n\tif(x<1||x>R||y<1||y>C) return 0;\n\tif(map[x][y]==3) return 0;\n\treturn 1;\n}\nvoid add(int x,int y,int d){\n\tfor(;d<=T;++d)\n\t\te[x][y][d]=1;\n}\nvoid bfs(int sx,int sy){\n\tq.push(node(sx,sy,0));\n\tmemset(vis,0,sizeof(vis));\n\twhile(!q.empty()){\n\t\tnode A=q.front();q.pop();\n\t\tint x=A.x,y=A.y,len=A.len;\n\t\tif(vis[x][y]) continue;\n\t\tvis[x][y]=1;\n\t\tif(map[x][y]==2) \n\t\t\tadd(id[sx][sy],id[x][y],len);\n\t\tfor(int i=0;i<4;++i){\n\t\t\tint nex=x+dx[i],ney=y+dy[i];\n\t\t\tif(ok(nex,ney)) q.push(node(nex,ney,len+1));\n\t\t}\t\n\t}\n}\nbool find(int x){\n\tfor(int i=1;i<=t2;++i)\n\t\tfor(int j=1;j<=T;++j){\n\t\t\tif(e[x][i][j]&&!used[i][j]){\n\t\t\t\tused[i][j]=1;\n\t\t\t\tif(!mat[i][j]||find(mat[i][j])){\n\t\t\t\t\tmat[i][j]=x;\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\treturn 0;\t\t\n}\nint main(){\n\tR=read();C=read();T=read();\n\tfor(int i=1;i<=R;++i){\n\t\tscanf(\"%s\",ch+1);\n\t\tfor(int j=1;j<=C;++j){\n\t\t\tif(ch[j]=='P'){\n\t\t\t\tmap[i][j]=1;\n\t\t\t\tid[i][j]=++t1;\n\t\t\t}\n\t\t\tif(ch[j]=='O'){\n\t\t\t\tmap[i][j]=2;\n\t\t\t\tid[i][j]=++t2;\n\t\t\t}\n\t\t\tif(ch[j]=='*')\n\t\t\t\tmap[i][j]=3;\n\t\t}\n\t}\n\tfor(int i=1;i<=R;++i)\n\t\tfor(int j=1;j<=C;++j)\n\t\t\tif(map[i][j]==1) bfs(i,j);\n\tfor(int i=1;i<=t1;++i){\n\t\tmemset(used,0,sizeof(used));\n\t\tif(find(i)) ++ans;\n\t}\t\n\tprintf(\"%d\\n\",ans);\t\n}\n```",
        "postTime": 1572333161,
        "uid": 133410,
        "name": "Resonance",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3851 \u3010[TJOI2007]\u8131\u9669\u3011"
    }
]
[
    {
        "content": "\u8fd9\u91cc\u590d\u8ff0\u4e00\u904d\u7f51\u4e0a\u5e38\u89c1\u7684\u4e00\u79cd\u505a\u6cd5\u3002\n\n**\u524d\u7f6e\u77e5\u8bc6**\uff1a\u6570\u8bba\u57fa\u7840\u77e5\u8bc6\u3001\u6269\u5c55 $\\text{Euclid}$ \u7b97\u6cd5\u3001\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\uff08$\\text{CRT}$\uff09\u3001\u5927\u6b65\u5c0f\u6b65\u7b97\u6cd5\uff08$\\text{BSGS}$ \u7b97\u6cd5\uff09\u3002\n\n## \u7b2c\u4e00\u90e8\u5206\uff1a\u5206\u89e3\u95ee\u9898\n\n\u6211\u4eec\u9700\u8981\u6c42 $x^A\\equiv B \\pmod m$ \u7684\u6240\u6709\u89e3\u3002\n\n\u7531\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u6c42 $x^A\\equiv B\\pmod{p_i^{\\alpha_i}}$ \u7684\u6240\u6709\u89e3\u3002\n\n\u5728\u6bcf\u4e2a\u65b9\u7a0b\u9009\u51fa\u4e00\u4e2a\u89e3\u5373\u53ef\u552f\u4e00\u5bf9\u5e94\u4e00\u4e2a\u539f\u65b9\u7a0b\u7684\u89e3\u3002\n***\n\u4e3e\u4e2a\u4f8b\u5b50\n\n\u5728 $x^2\\equiv 9\\pmod {2^3}$ \u4e2d\u9009\u53d6\u89e3 $x\\equiv 7\\pmod {2^3}$\n\n\u5728 $x^2\\equiv 9\\pmod {5^2}$ \u4e2d\u9009\u53d6\u89e3 $x\\equiv 3\\pmod {5^2}$\n\n\u8fd9\u5bf9\u5e94\u7740\u539f\u65b9\u7a0b $x^2\\equiv 9\\pmod {2^3\\times5^2}$ \u7684\u4e00\u4e2a\u89e3 $x\\equiv 103\\pmod{2^3\\times 5^2}$\n***\n\n\u56e0\u6b64\u6211\u4eec\u5c06\u95ee\u9898\u8f6c\u5316\u4e3a\u4e86\u6c42\u5f88\u591a\u4e2a\u65b9\u7a0b $x^A\\equiv B\\pmod{p^{\\alpha}}$ \u7684\u95ee\u9898\u3002\n\n\u5982\u679c\u53ea\u9700\u8981\u6c42\u89e3\u6570\uff0c\u5c31\u662f\u5404\u90e8\u5206\u7684\u89e3\u6570\u7b80\u5355\u76f8\u4e58\u3002\n\n\u5982\u679c\u8981\u6c42\u6240\u6709\u7684\u89e3\uff0c\u5c31\u9700\u8981\u679a\u4e3e\u6240\u6709\u60c5\u51b5\uff0c\u4f7f\u7528\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u6c42\u89e3\u7b54\u6848\u3002\n\n\n**\u6ce8\uff1a\u4ee5\u4e0b\u90e8\u5206\u8bb0 $M=p^{\\alpha}$\u3002**\n\n## \u7b2c\u4e8c\u90e8\u5206\uff1a$p$ \u4e3a\u5947\u7d20\u6570\n\n#### \u60c5\u51b5 1\uff1a$B\\equiv 0\\pmod M$\n\n\u5bb9\u6613\u53d1\u73b0\u5f53\u4e14\u4ec5\u5f53 $x$ \u662f $p^{\\left\\lfloor\\frac{\\alpha}A\\right\\rfloor}$ \u7684\u500d\u6570\uff0c\u81ea\u7136\u5f88\u5bb9\u6613\u5f97\u5230\u6240\u6709\u7684\u89e3\u3002\n\n#### \u60c5\u51b5 2\uff1a$B$\u3001$M$ \u4e92\u8d28\n\n\u6ce8\u610f\u5230 $M=p^{\\alpha}$ \u5177\u6709\u539f\u6839\uff0c\u627e\u5230\u539f\u6839\u4e4b\u540e\u89e3\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\u5373\u53ef\u3002\n\n\u5177\u4f53\u5730\uff1a\n\n\u8bbe $g$ \u662f $M$ \u7684\u4e00\u4e2a\u539f\u6839\uff0c$y=\\mathrm{ind~}x$\uff0c$z=\\mathrm{ind~}B$\u3002\n\n\u5219\u6709 $Ay\\equiv z\\pmod{\\varphi(M)}$\uff0c\u8bbe $k=\\gcd(A,z,\\varphi(M))$\u3002\n\n$y\\equiv \\left(\\dfrac{z}{k}\\right)\\cdot \\left(\\dfrac{A}{k}\\right)^{-1}\\left(\\bmod~\\dfrac {\\varphi(M)}k\\right)$\n\n\u7279\u6b8a\u5730\uff0c\u5f53\u9006\u5143\u4e0d\u5b58\u5728\u65f6\u5219\u65e0\u89e3\u3002\n\n\u9700\u8981\u6ce8\u610f\u6b64\u65f6\u7684 $y$ \u5728 $\\left[0, \\varphi(M)-1\\right]$ \u5185\u4e5f\u53ef\u80fd\u6709\u5f88\u591a\u4e2a\u89e3\u3002\n\n\u800c $x\\equiv g^y\\pmod{M}$\u3002\n\n#### \u60c5\u51b5 3\uff1a$\\gcd(B,M)=p^q(1\\leq q \\lt \\alpha)$\n\n\u5bb9\u6613\u53d1\u73b0\u6b64\u65f6 $A$ \u5fc5\u987b\u662f $q$ \u7684\u7ea6\u6570\uff0c\u5426\u5219\u65e0\u89e3\u3002\n\n\u8bbe $x=p^{\\frac qA}\\cdot y$\uff0c$B=p^q\\cdot z$\u3002\n\n\u53ef\u4ee5\u5f97\u5230\uff1a$y^A\\equiv z\\pmod{p^{\\alpha-q}}$\n\n\u6b64\u65f6\u53d8\u4e3a\u4e86\u7b2c\u4e8c\u79cd\u60c5\u51b5\u3002\n\n\u9700\u8981\u6ce8\u610f\u6b64\u65f6\u53ea\u6c42\u51fa\u4e86 $y\\bmod p^{\\alpha-q}$ \u7684\u503c\uff0c\u53ea\u6709\u786e\u5b9a $y\\bmod p^{\\alpha-\\frac qA}$ \u7684\u503c\u624d\u80fd\u786e\u5b9a $x$ \u7684\u503c\uff0c\u56e0\u6b64\u5bf9\u4e8e\u4e00\u4e2a $y$ \u53ef\u80fd\u4e5f\u5bf9\u5e94\u7740\u591a\u4e2a $x$\uff08\u4e2a\u6570\u4e3a $p^{q-\\frac qA}$\uff09\u3002\n\n## \u7b2c\u4e09\u90e8\u5206\uff1a$p=2$\n\n\u524d\u4e24\u4e2a\u90e8\u5206\u542c\u8d77\u6765\u590d\u6742\u5ea6\u90fd\u975e\u5e38\u6b63\u786e\uff08\u5728\u4fdd\u8bc1\u89e3\u4e0d\u591a\u7684\u60c5\u51b5\u4e0b\uff09\u3002\n\n\u8fd9\u4e00\u4e2a\u90e8\u5206\u7f51\u4e0a\u7684\u8bb8\u591a\u535a\u5ba2\u90fd\u6ca1\u6709\u5177\u4f53\u8bc1\u660e\u590d\u6742\u5ea6\uff0c\u672c\u4eba\u4e5f\u4e0d\u4f1a\u8bc1\u3002\n\n\u8fd9\u4e00\u90e8\u5206\u7684\u4e3b\u8981\u601d\u8def\u662f\uff1a\n\n\u82e5 $x^A\\equiv B\\pmod{2^k}$\uff0c\u90a3\u4e48\u6c42\u51fa $y^A\\equiv B\\pmod {2^{k-1}}$ \u89e3\u4e4b\u540e\uff0c\u8981\u4e48 $x=y$\uff0c\u8981\u4e48 $x=y+2^{k-1}$\uff0c\u66b4\u529b\u68c0\u9a8c\u5373\u53ef\u3002\n\n\u7f51\u4e0a\u5f88\u591a\u9898\u89e3\u4e00\u7b14\u5e26\u8fc7\uff0c\u8bf4\u89e3\u6570\u4e0d\u591a\u7684\u60c5\u51b5\u4e0b\u590d\u6742\u5ea6\u6b63\u786e\u3002\n\n\u672c\u4eba\u89c9\u5f97\u4e0d\u662f\u5f88\u663e\u7136\uff0c\u539f\u56e0\u662f\u6709\u53ef\u80fd\u6c42 $x^A\\equiv B\\pmod {2^{k-1}}$ \u65f6\u6709\u53ef\u80fd\u89e3\u51fa\u975e\u5e38\u591a\u7684\u89e3\uff08\u5bfc\u81f4\u65f6\u95f4\u590d\u6742\u5ea6\u7206\u70b8\uff09\uff0c\u800c\u8fd9\u6b21\u68c0\u9a8c\u89e3\u65f6\u5168\u90e8\u820d\u6389\u4e86\uff0c\u4ece\u800c\u4fdd\u8bc1\u6700\u7ec8\u89e3\u6570\u4e0d\u591a\u3002\n\n**\u5e0c\u671b\u6709\u795e\u4ed9\u80fd\u89e3\u51b3\u6211\u7684\u56f0\u60d1\u3002**\n\n\u81f3\u6b64\uff0c\u4f7f\u7528\u4e0a\u8ff0\u601d\u8def\u5c31\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u9898\u3002\n\n\u6709\u4e9b\u7ec6\u8282\u53ef\u4ee5\u89c1\u4ee3\u7801~~\uff08\u5e94\u8be5\u8fd8\u7b97\u6e05\u6670\u7684\u5427\uff09~~\u3002\n\n## \u7b2c\u56db\u90e8\u5206\uff1a\u53c2\u8003\u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n\ntypedef long long LL;\n\nint A, B, mod;\nint pow(int x, int y, int mod = 0, int ans = 1) {\n\tif (mod) {\n\t\tfor (; y; y >>= 1, x = (LL) x * x % mod)\n\t\t\tif (y & 1) ans = (LL) ans * x % mod;\n\t} else {\n\t\tfor (; y; y >>= 1, x = x * x)\n\t\t\tif (y & 1) ans = ans * x;\n\t}\n\treturn ans;\n}\n\nstruct factor {\n\tint prime[20], expo[20], pk[20], tot;\n\tvoid factor_integer(int n) {\n\t\ttot = 0;\n\t\tfor (int i = 2; i * i <= n; ++i) if (n % i == 0) {\n\t\t\tprime[tot] = i, expo[tot] = 0, pk[tot] = 1;\n\t\t\tdo ++expo[tot], pk[tot] *= i; while ((n /= i) % i == 0);\n\t\t\t++tot;\n\t\t}\n\t\tif (n > 1) prime[tot] = n, expo[tot] = 1, pk[tot++] = n;\n\t}\n\tint phi(int id) const {\n\t\treturn pk[id] / prime[id] * (prime[id] - 1);\n\t}\n} mods, _p;\n\nint p_inverse(int x, int id) {\n\tassert(x % mods.prime[id] != 0);\n\treturn pow(x, mods.phi(id) - 1, mods.pk[id]);\n}\n\nvoid exgcd(int a, int b, int &x, int &y) {\n\tif (!b) x = 1, y = 0;\n\telse exgcd(b, a % b, y, x), y -= a / b * x;\n}\nint inverse(int x, int mod) {\n\tassert(std::__gcd(x, mod) == 1);\n\tint ret, tmp;\n\texgcd(x, mod, ret, tmp), ret %= mod;\n\treturn ret + (ret >> 31 & mod);\n}\n\nstd::vector<int> sol[20];\n\nvoid solve_2(int id, int k) {\n\tint mod = 1 << k;\n\tif (k == 0) { sol[id].emplace_back(0); return; }\n\telse {\n\t\tsolve_2(id, k - 1); std::vector<int> t;\n\t\tfor (int s : sol[id]) {\n\t\t\tif (!((pow(s, A) ^ B) & mod - 1))\n\t\t\t\tt.emplace_back(s);\n\t\t\tif (!((pow(s | 1 << k - 1, A) ^ B) & mod - 1))\n\t\t\t\tt.emplace_back(s | 1 << k - 1);\n\t\t}\n\t\tstd::swap(sol[id], t);\n\t}\n}\n\nint BSGS(int B, int g, int mod) { // g^x = B (mod M) => g^iL = B*g^j (mod M) : iL - j\n\tstd::unordered_map<int, int> map;\n\tint L = std::ceil(std::sqrt(mod)), t = 1;\n\tfor (int i = 1; i <= L; ++i) {\n\t\tt = (LL) t * g % mod;\n\t\tmap[(LL) B * t % mod] = i;\n\t}\n\tint now = 1;\n\tfor (int i = 1; i <= L; ++i) {\n\t\tnow = (LL) now * t % mod;\n\t\tif (map.count(now)) return i * L - map[now];\n\t}\n\tassert(0);\n}\n\nint find_primitive_root(int id) {\n\tint phi = mods.phi(id); _p.factor_integer(phi);\n\tauto check = [&] (int g) {\n\t\tfor (int i = 0; i < _p.tot; ++i)\n\t\t\tif (pow(g, phi / _p.prime[i], mods.pk[id]) == 1)\n\t\t\t\treturn 0;\n\t\treturn 1;\n\t}; \n\tfor (int g = 2; g < mods.pk[id]; ++g) if (check(g)) return g;\n\tassert(0);\n}\n\nvoid division(int id, int a, int b, int mod) { //  ax = b (mod M)\n\tint M = mod, g = std::__gcd(std::__gcd(a, b), mod);\n\ta /= g, b /= g, mod /= g;\n\tif (std::__gcd(a, mod) > 1) return;\n\tint t = (LL) b * inverse(a, mod) % mod;\n\tfor (; t < M; t += mod) sol[id].emplace_back(t);\n}\n\nvoid solve_p(int id, int B = ::B) {\n\tint p = mods.prime[id], e = mods.expo[id], mod = mods.pk[id];\n\tif (B % mod == 0) {\n\t\tint q = pow(p, (e + A - 1) / A);\n\t\tfor (int t = 0; t < mods.pk[id]; t += q)\n\t\t\tsol[id].emplace_back(t);\n\t} else if (B % p != 0) {\n\t\tint phi = mods.phi(id);\n\t\tint g = find_primitive_root(id), z = BSGS(B, g, mod);\n\t\tdivision(id, A, z, phi);\n\t\tfor (int &x : sol[id]) x = pow(g, x, mod);\n\t} else {\n\t\tint q = 0; while (B % p == 0) B /= p, ++q;\n\t\tint pq = pow(p, q);\n\t\tif (q % A != 0) return;\n\t\tmods.expo[id] -= q, mods.pk[id] /= pq;\n\t\tsolve_p(id, B);\n\t\tmods.expo[id] += q, mods.pk[id] *= pq;\n\t\tif (!sol[id].size()) return;\n\t\t\n\t\tint s = pow(p, q - q / A);\n\t\tint t = pow(p, q / A);\n\t\tint u = pow(p, e - q);\n\n\t\tstd::vector<int> res;\t\t\n\t\tfor (int y : sol[id]) {\n\t\t\tfor (int i = 0; i < s; ++i)\n\t\t\t\tres.emplace_back((i * u + y) * t);\n\t\t}\n\t\tstd::swap(sol[id], res);\n\t}\n}\n\nstd::vector<int> allans;\nvoid dfs(int dep, int ans, int mod) {\n\tif (dep == mods.tot) {allans.emplace_back(ans); return;}\n\tint p = mods.pk[dep], k = p_inverse(mod % p, dep);\n\tfor (int a : sol[dep]) {\n\t\tint nxt = (LL) (a - ans % p + p) * k % p * mod + ans;\n\t\tdfs(dep + 1, nxt, mod * p);\n\t}\n}\n\nvoid solve() {\n\tstd::cin >> A >> mod >> B, mods.factor_integer(mod);\n\tallans.clear();\n\tfor (int i = mods.tot - 1; ~i; --i) {\n\t\tsol[i].clear();\n\t\tmods.prime[i] == 2 ? solve_2(i, mods.expo[i]) : solve_p(i);\n\t\tif (!sol[i].size()) {return std::cout << 0 << '\\n', void(0);}\n\t}\n\tdfs(0, 0, 1), std::sort(allans.begin(), allans.end());\n\tstd::cout << allans.size() << '\\n';\n\tfor (int i : allans) std::cout << i << ' '; std::cout << '\\n';\n}\n\nint main() {\n\tstd::ios::sync_with_stdio(0), std::cin.tie(0);\n\tint tc; std::cin >> tc; while (tc--) solve();\n\treturn 0;\n}\n```",
        "postTime": 1576858374,
        "uid": 26127,
        "name": "Weng_Weijie",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5668 \u3010N\u6b21\u5269\u4f59\u3011"
    },
    {
        "content": "\u6c42 $x^a\\equiv b\\pmod p$ \u5728 $[0,p)$ \u5185\u7684\u6240\u6709\u89e3\u3002\n\n\u6838\u5fc3\u601d\u60f3\u662f\u901a\u8fc7\u539f\u6839\u5c06\u5e42\u53d8\u6210\u6307\u6570\u3002\u4f46\u662f\u666e\u901a\u7684\u6a21\u6570 $p$ \u4e0d\u4e00\u5b9a\u6709\u539f\u6839\u554a\uff0c\u90a3\u8003\u8651\u4f7f\u7528\u5206\u89e3\u8d28\u56e0\u6570 $p=\\prod p_i^{\\alpha_i}$\uff0c\u5947\u8d28\u6570\u7684\u5e42\u662f\u6709\u539f\u6839\u7684\u3002\u62c6\u5f00\u7684\u7406\u8bba\u4f9d\u636e\u662f\u4ec0\u4e48\uff1f\u6362\u4e2a\u5143\uff0c\u4ee4 $y=x^a$\uff0c\u90a3\u4e48 $y\\equiv b\\pmod p$ \u53ef\u4ee5\u7531\u82e5\u5e72\u4e2a $y\\equiv b\\pmod{p_i^{\\alpha_i}}$ \u8054\u7acb\u800c\u6210\u7684\u65b9\u7a0b\u7ec4\u7b49\u4ef7\u8868\u8fbe\uff0c\u6839\u636e\u7684\u662f\u6a21\u6570\u4e24\u4e24\u4e92\u8d28\u7684 ExCRT\uff08\u5176\u5b9e\u5c31\u662f CRT\uff0c\u53ef\u60dc\u6211\u4e0d\u4f1a\u5199\uff09\u3002\u90a3\u4e48\u6211\u4eec\u5f97\u5230 $y\\equiv b\\pmod{p_i^{\\alpha_i}}$ \u7684\u89e3\u96c6 $X_i$ \u540e\uff0c\u5176\u5b9e\u5c31\u662f $x$ \u662f\u539f\u65b9\u7a0b\u7684\u89e3\u5f53\u4e14\u4ec5\u5f53\uff08\u65b9\u7a0b\u548c\u65b9\u7a0b\u7ec4\u7684\u7b49\u4ef7\u6027\u5df2\u7ecf\u7528 CRT \u8bc1\u660e\uff09\u5bf9\u6240\u6709 $i$ \u90fd\u6709 $x\\in X_i\\pmod{p_i^{\\alpha_i}}$\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u4ece\u6bcf\u4e2a $X_i$ \u5404\u6311\u4e00\u4e2a\u503c\u51fa\u6765\u7528 CRT \u5408\u5e76\uff0c\u5f97\u5230 $\\prod|X_i|$ \u4e2a $[0,p)$ \u5185\u7684 $x$ \u4fbf\u662f\u539f\u65b9\u7a0b\u7684\u6240\u6709\u89e3\u3002\u8fd9\u91cc\u4f7f\u7528\u4e86\u4e24\u6b21 CRT\uff0c\u6b63\u7740\u4e00\u6b21\u53cd\u7740\u4e00\u6b21\uff0c\u6b65\u6b65\u4e3a\u7b49\u4ef7\u53d8\u6362\u3002\n\n\u4e0b\u9762\u8ba8\u8bba $x^a\\equiv b\\pmod{p^\\alpha}(p\\in\\mathbb P)$ \u600e\u4e48\u89e3\u3002\u6ce8\u610f\u5230\u5f53 $p\\neq 2$ \u65f6 $p^{\\alpha}$ \u5fc5\u6709\u539f\u6839\uff0c\u6211\u4eec\u5206\u6210 $p\\overset{?}=2$ \u4e24\u79cd\u60c5\u51b5\u8ba8\u8bba\uff0c\u5148\u8003\u8651 $p\\neq 2$\u3002\u9996\u5148\u5982\u679c $b=0$\uff0c\u90a3\u4e48\u663e\u7136\u89e3\u96c6\u4e3a $p^{\\left\\lceil\\frac \\alpha a\\right\\rceil}\\mid x$\uff0c\u4e0b\u9762 $b\\neq0$\u3002\u82e5 $b\\perp p^{\\alpha}$\uff0c\u6c42\u5f97 $p^{\\alpha}$ \u7684\u4efb\u610f\u4e00\u4e2a\u539f\u6839\uff08\u53ef\u4ee5\u7528 1/4 \u6b21 log \u7684\u7b97\u6cd5\u6c42\u6700\u5c0f\u539f\u6839\uff09$g$\uff0c\u7136\u540e\u7528 BSGS \u6c42\u51fa $b=g^\\beta$ \u7684 $\\left[0,\\varphi=\\varphi\\!\\left(p^\\alpha\\right)\\right)$ \u5185\u552f\u4e00 $\\beta$\u3002\u6b64\u65f6\u663e\u7136 $x$ \u662f\u89e3\u4ec5\u5f53 $x\\perp p^\\alpha$\uff0c\u4e8e\u662f\u4ee4 $x=g^y(y\\in[0,\\varphi))$\uff0c\u6c42\u51fa $y$ \u5728 $\\bmod\\varphi$ \u610f\u4e49\u4e0b\u6240\u6709\u89e3\uff0c\u5c31\u76f8\u5f53\u4e8e\u6c42\u51fa\u4e86 $x$ \u7684\u6240\u6709\u89e3\u3002\u539f\u65b9\u7a0b\u5373 $g^{ay}\\equiv g^\\beta\\pmod{p^\\alpha}$\uff0c\u8ddf\u636e\u539f\u6839\u7684\u5e42\u5468\u671f\u4e3a $\\varphi$\uff0c\u8fd9\u663e\u7136\u7b49\u4ef7\u4e8e $ay\\equiv\\beta\\pmod{\\varphi}$\u3002\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\u5c31\u6ca1\u4ec0\u4e48\u8bb2\u7684\u5fc5\u8981\u4e86\u5427\uff0cexgcd \u627e\u7279\u89e3\u7136\u540e\u679a\u4e3e\u901a\u89e3\u5728 $[0,\\varphi)$ \u5185\u6240\u6709\u53d6\u503c\u5373\u53ef\u3002\n\n\u5982\u679c $b\\not\\perp p^\\alpha$ \u5462\uff1f\u6b64\u65f6 $b$ \u5728\u6a21\u610f\u4e49\u4e0b\u6ca1\u6709\u539f\u6839\u3002\u8bbe $b=p^\\beta q$\uff0c\u4ee4 $x=p^\\gamma r$\uff0c\u90a3\u4e48\u539f\u65b9\u7a0b\u7b49\u4ef7\u4e8e $p^{a\\gamma}r^a\\equiv p^\\beta q\\pmod{p^\\alpha}$\u3002\u6b64\u65f6\u6211\u4eec\u53d1\u73b0\uff0c\u7531\u4e8e $b\\neq 0$\uff0c\u4e5f\u5c31\u662f $\\beta<+\\infty$ \u5373 $\\beta<\\alpha$\uff0c\u90a3\u4e48 $p^{\\beta} q$ \u6240\u5728\u5269\u4f59\u7cfb\u4e2d\u90fd\u6070\u597d\u5305\u542b $\\beta$ \u4e2a\u8d28\u56e0\u5b50 $p$\uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981 $a\\gamma=\\beta$\uff08\u5e76\u4e0d\u662f\u6a21\u610f\u4e49\u4e0b\uff0c\u800c\u662f\u4e25\u683c\u76f8\u7b49\uff01\uff09\uff01\u90a3\u4e48\u5224\u4e00\u624b $a\\mid\\beta$\uff0c\u76f4\u63a5\u5f97\u5230 $\\gamma=\\dfrac\\beta a$\uff0c\u5b83\u73b0\u5728\u662f\u5e38\u6570\u4e86\u3002\u8ddf\u636e\u540c\u4f59\u5f0f\u7684\u6027\u8d28\u5c06\u4e09\u8fb9\u7684 $p^\\beta$ \u7ea6\u6389\uff0c\u5f97\u5230 $r^a\\equiv q\\pmod{p^{\\alpha-\\beta}}$\uff0c\u6b64\u65f6\u6709 $p\\nmid q$\uff0c\u4e8e\u662f\u5f52\u7ea6\u5230\u4e86 $b\\perp p^\\alpha$ \u7684\u60c5\u51b5\u3002\u6c42\u51fa $r\\bmod p^{\\alpha-\\beta}$ \u7684\u6240\u6709\u53ef\u80fd\u503c\u540e\uff0c\u5bf9\u4e8e\u5176\u4e2d\u6bcf\u4e00\u4e2a\uff0c\u6211\u4eec\u8981\u627e\u51fa\u5bf9\u5e94\u7684\u6240\u6709 $\\left[0,p^\\alpha\\right)$ \u5185\u7684 $p^\\gamma r$\uff0c\u90a3\u4e48\u627e\u5230\u6240\u6709 $r\\in\\left[0,p^{\\alpha-\\gamma}\\right)$ \u5373\u53ef\uff0c\u968f\u4fbf\u904d\u5386\u4e00\u6ce2\uff0c\u6709 $p^{(\\alpha-\\gamma)-(\\alpha-\\beta)}=p^{\\beta-\\gamma}$ \u4e2a\u503c\u3002\n\n\u6700\u540e\u6211\u4eec\u6765\u8003\u8651 $p=2$ \u7684\u60c5\u5f62\u3002\u7531\u4e8e\u6ca1\u6709\u539f\u6839\uff0c\u5f88\u53ef\u60dc\uff0c\u8fd9\u79cd\u60c5\u51b5\u53ea\u80fd\u66b4\u529b\uff08\u6709\u539f\u6839\u7684\u60c5\u51b5\u4e0b\u590d\u6742\u5ea6\u663e\u7136\u662f $|X|+\\mathrm O\\!\\left(\\sqrt {p^\\alpha}\\right)$\uff0c\u800c $|X|$ \u4e0a\u9650\u662f\u6709\u4fdd\u8bc1\u7684\uff09\u3002\u76f4\u63a5\u66b4\u529b\u679a\u4e3e $[0,2^\\alpha)$ \u5185\u6240\u6709 $x$ \u663e\u7136\u4f1a T\uff0c\u6211\u4eec\u53ef\u4ee5\u526a\u679d\u5440\uff01\u8003\u8651\u5bf9 $\\alpha$ \u8fdb\u884c\u8fed\u4ee3\uff0c\u5047\u8bbe $x^a\\equiv b\\pmod{2^{\\alpha-1}}$ \u7684\u89e3\u96c6\u5df2\u7ecf\u7b97\u51fa\u4e3a $X_{\\alpha-1}$\uff0c\u90a3\u4e48 $x$ \u662f $x^a\\equiv b\\pmod{2^{\\alpha}}$ \u7684\u89e3\u7684\u5fc5\u8981\u6761\u4ef6\u662f\u6ee1\u8db3 $\\alpha-1$ \u7684\u65b9\u7a0b\uff0c\u5373 $x\\in X_{\\alpha-1}\\pmod{2^{\\alpha-1}}$\uff0c\u800c\u5bf9\u4e8e\u6bcf\u4e2a $x_0\\in X_{\\alpha-1}$\uff0c\u5728 $\\bmod 2^\\alpha$ \u610f\u4e49\u4e0b\u6709\u4e24\u4e2a\u5bf9\u5e94\u503c\uff0c\u90fd\u5feb\u901f\u5e42\u5224\u4e00\u4e0b\u5373\u53ef\u3002\u8fd9\u6837\u6700\u574f\u590d\u6742\u5ea6\u4f9d\u7136\u662f\u8dd1\u6ee1\u7684\uff0c\u4f46\u662f\u526a\u679d\u6548\u679c\u5f88\u597d\uff08\u53ef\u4ee5\u901a\u8fc7\u6a21\u677f\u9898\uff09\uff0c\u6bd5\u7adf $2^\\beta$ \u65f6\u51cf\u6389\u4e00\u4e2a\u679d\u76f8\u5f53\u4e8e\u76f4\u63a5\u780d\u6389 $2^{\\alpha-\\beta}$ \u4e2a\u53ef\u80fd\u7684\u7b54\u6848\u3002\n\nupd\uff1a\u88ab[\u8fd9\u4e2a\u5e16\u5b50](https://www.luogu.com.cn/discuss/445485) hack \u6389\u4e86\u3002\u8fd8\u4ee5\u4e3a\u662f\u4ec0\u4e48\u5927\u95ee\u9898\uff0c\u6ca1\u60f3\u5230\u662f\u4e2a\u5077\u88ad\uff08\u96fe\uff09\u3002\u8bbe\u5206\u89e3\u5230\u7684\u6bcf\u4e2a\u8d28\u56e0\u5b50\u7684\u89e3\u6570\u4e3a $X_i$\uff0c\u90a3\u4e48\u603b\u5171\u8981\u505a $\\mathrm O(X=\\prod X_i)$ \u6b21 CRT\uff0c\u800c CRT \u4e0d\u4f1a\u51fa\u73b0\u65e0\u6cd5\u5408\u5e76\uff0c\u4e5f\u5c31\u662f\u603b\u89e3\u6570\u4e5f\u662f $\\mathrm O(X)$\uff0c\u800c\u9898\u76ee\u4fdd\u8bc1 $X$ \u4e0d\u4f1a\u592a\u5927\uff0c\u6240\u4ee5\u590d\u6742\u5ea6\u662f\u5bf9\u7684\u3002\u4f46\u6709\u4e00\u4e2a\u6f0f\u6d1e\uff1a\u6709 $X_i=0$ \u7684\u8bdd\uff0c\u300c\u53ea\u8981\u505a $\\mathrm O(X)$ \u6b21 CRT\u300d\u4fbf\u4e0d\u6210\u7acb\uff0c\u8fd9\u91cc\u5728\u5f00\u59cb CRT \u4e4b\u524d\u7279\u5224\u4e00\u4e0b\u5c31\u597d\u4e86\u3002\n\n\u4ee3\u7801\uff08\u5df2\u7ecf\u6362\u7801\u98ce\u4e86\uff0c\u8fd8\u8981\u9002\u5e94\u4e4b\u524d\u7684\u7801\u98ce\u597d\u70e6\uff09\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\n#define pb push_back\n#define mp make_pair\n#define X first\n#define Y second\nint qpow(int x,int y,int p){\n    int res=1;\n    while(y){\n        if(y&1)res=res*x%p;\n        x=x*x%p;\n        y>>=1;\n    }\n    return res;\n}\nint exgcd(int a,int b,int &x,int &y){\n    if(!b)return x=1,y=0,a;\n    int d=exgcd(b,a%b,y,x);\n    return y-=a/b*x,d;\n}\nint inv(int a,int p){\n    int x,y,d=exgcd(a,p,x,y);\n    if(d==1)return 0;\n    return (x%p+p)%p;\n}\nint excrt(int a1,int a2,int p1,int p2){\n    int k1,k2,d=exgcd(p1,p2,k1,k2);\n    assert(d==1);\n    k1=(k1%(p1*p2)*(a2-a1)%(p1*p2)+p1*p2)%(p1*p2);\n    return (a1+p1*k1)%(p1*p2);\n}\nvector<int> solve2(int a,int b,int alpha){\n    b%=1<<alpha;\n    if(alpha==0)return vector<int>({0});\n    vector<int> v=solve2(a,b,alpha-1),ret;\n    for(int i=0;i<v.size();i++){\n        if(qpow(v[i],a,1<<alpha)==b)ret.pb(v[i]);\n        if(qpow(v[i]+(1<<alpha-1),a,1<<alpha)==b)ret.pb(v[i]+(1<<alpha-1));\n    }\n    return ret;\n}\nint proot(int p,int alpha,int palpha){\n    int phi=palpha/p*(p-1);\n    vector<int> dsr;\n    for(int i=2;i*i<=phi;i++)if(phi%i==0){\n        dsr.pb(i);\n        while(phi%i==0)phi/=i;\n    }\n    if(phi>1)dsr.pb(phi);\n    phi=palpha/p*(p-1);\n    for(int i=2;;i++)if(i%p){\n        bool flg=true;\n        for(int j=0;j<dsr.size();j++)flg&=qpow(i,phi/dsr[j],palpha)!=1;\n        if(flg)return i;\n    }\n}\nint bsgs(int g,int b,int p){\n    unordered_map<int,int> mmp;\n    int B=sqrt(p)+1,now=1,now0=1;\n    for(int i=1;i<=B;i++)now=now*g%p,mmp[now*b%p]=i;\n    for(int i=1;i<=B;i++){\n        now0=now0*now%p;\n        int j=mmp[now0];\n        if(j)return i*B-j;\n    }\n}\nvector<int> solve(int a,int b,int p,int alpha){\n    int palpha=qpow(p,alpha,1e12);\n//  cout<<palpha<<\"!!\\n\";\n    b%=palpha;\n    if(p==2)return solve2(a,b,alpha);\n    if(b==0){\n        int div=(alpha+a-1)/a,fst=qpow(p,div,1e12);\n        vector<int> ret;\n        for(int i=0;i<palpha;i+=fst)ret.pb(i);\n        return ret;\n    }\n    if(b%p==0){\n        int beta=0,q=b;\n        while(q%p==0)beta++,q/=p;\n        if(beta%a)return vector<int>();\n        vector<int> v=solve(a,q,p,alpha-beta);\n        int gamma=beta/a;\n        vector<int> ret;\n        int lim=qpow(p,beta-gamma,1e12),mul=qpow(p,alpha-beta,1e12),pgamma=qpow(p,gamma,1e12);\n        for(int i=0;i<v.size();i++)for(int j=0;j<lim;j++)ret.pb((v[i]+j*mul)%palpha*pgamma%palpha);\n        return ret;\n    }\n    int g=proot(p,alpha,palpha),beta=bsgs(g,b,palpha),phi=palpha/p*(p-1);\n    int x,y,d=exgcd(a,phi,y,x);\n    if(beta%d)return vector<int>();\n    int mod=phi/d,gap=qpow(g,mod,palpha);y=(y*(beta/d)%mod+mod)%mod;\n    int now=qpow(g,y,palpha);\n    vector<int> ret;\n    for(int i=0;y+i*mod<phi;i++)ret.pb(now),now=now*gap%palpha;\n    return ret;\n}\nvoid mian(){\n    int a,p,b;\n    cin>>a>>p>>b;\n//  cerr<<a<<\" \"<<b<<\" \"<<p<<\":\\n\";\n    vector<pair<int,int> > dsr;\n    for(int i=2;i*i<=p;i++)if(p%i==0){\n        int cnt=0;\n        while(p%i==0)cnt++,p/=i;\n        dsr.pb(mp(i,cnt));\n    }\n    if(p>1)dsr.pb(mp(p,1));\n    vector<int> ans;ans.pb(0);\n    int now=1;\n    vector<vector<int>> vv;\n    for(int i=0;i<dsr.size();i++){\n        vector<int> v=solve(a,b,dsr[i].X,dsr[i].Y);\n        vv.pb(v);\n        if(v.empty())return puts(\"0\"),void();\n    }\n    for(int i=0;i<dsr.size();i++){\n        auto v=vv[i];\n        vector<int> nw;\n        for(int j=0;j<ans.size();j++)for(int k=0;k<v.size();k++)nw.pb(excrt(ans[j],v[k],now,qpow(dsr[i].X,dsr[i].Y,1e12)));\n        ans.swap(nw),now*=qpow(dsr[i].X,dsr[i].Y,1e12);\n    }\n    sort(ans.begin(),ans.end());\n    cout<<ans.size()<<\"\\n\";\n    for(int i=0;i<ans.size();i++)printf(\"%lld%c\",ans[i],\" \\n\"[i+1==ans.size()]);\n}\nsigned main(){\n//  freopen(\"P5668_1.in\",\"r\",stdin);freopen(\"out.out\",\"w\",stdout);\n    int t;\n    cin>>t;\n    while(t--)mian();\n    return 0;\n}\n```",
        "postTime": 1645692694,
        "uid": 138400,
        "name": "chenxia25",
        "ccfLevel": 9,
        "title": "p5668"
    },
    {
        "content": "\u524d\u7f6e\u829d\u58eb\uff1a[\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\uff08CRT\uff09](https://oi-wiki.org/math/number-theory/crt/)\u3001[\u539f\u6839](https://oi-wiki.org/math/number-theory/primitive-root/)\u3001[\u5927\u6b65\u5c0f\u6b65\u7b97\u6cd5\uff08BSGS\uff09](https://oi-wiki.org/math/number-theory/bsgs/)\u3001[\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\uff08exgcd\uff09](https://oi-wiki.org/math/number-theory/gcd/#_7)\n\n\u8fd9\u91cc\u7684 $m$ \u6ca1\u6709\u7279\u6b8a\u6027\u8d28\uff0c\u8003\u8651\u5c06\u5176\u5206\u89e3\u4e3a $m = \\displaystyle\\prod_{i = 1}^{\\omega(m)} p_i^{q_i}$\uff0c\u5e76\u5728\u4f9d\u6b21\u6c42\u51fa\u6bcf\u4e2a $x^n \\equiv k \\pmod{p_i^{q_i}}$ \u7684\u6240\u6709\u89e3\u540e\u66b4\u529b\u5408\u5e76\u3002\n\n\u95ee\u9898\u8f6c\u5316\u4e3a\u6c42\u51fa\u5f62\u5982 $x^n \\equiv k \\pmod{p^q}$ \u7684\u65b9\u7a0b\u7684\u6240\u6709\u89e3\u3002\n\n1. $p = 2$\n\n\u8003\u8651\u8fed\u4ee3\u6cd5\u3002\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u6c42\u51fa\u4e86 $x^n \\equiv k \\pmod{2^{q - 1}}$ \u7684\u6240\u6709\u89e3\uff0c\u5219\u4efb\u4e00\u4e0a\u8ff0\u65b9\u7a0b\u7684\u89e3 $x_0$ \u4f1a\u5728 $x^n \\equiv k \\pmod{2^q}$ \u4e2d\u5bf9\u5e94**\u81f3\u591a**\u4e24\u4e2a\u89e3 $x_0, x_0 + 2^{q - 1}$\u3002\n\n\u4e8e\u662f\u8bbe\u521d\u59cb\u72b6\u6001\u4e0b $r = 0, x = \\{0\\}$\uff0c\u6309\u4e0a\u8ff0\u6b65\u9aa4\u8fed\u4ee3\u5e76\u68c0\u9a8c\u5f97\u51fa\u7684\u6bcf\u4e24\u4e2a\u89e3\u662f\u5426\u5206\u522b\u7b26\u5408\u6761\u4ef6\u5373\u53ef\u3002\n\n2. $p \\neq 2 \\operatorname{and} k \\bmod p^q = 0$\n\n\u6b64\u65f6\u8bbe $x = ap^b, k = p^c$\uff08$a \\bmod p \\neq 0 \\operatorname{and} b, c \\in Z$\uff09\uff0c\u5219 $bn \\geq c$ \u5373 $b \\geq \\lceil \\frac{c}{n} \\rceil$\uff0c\u4e8e\u662f\u6b64\u65f6 $x$ \u53ef\u4ee5\u53d6\u904d $p^q$ \u4ee5\u5185\u6240\u6709**\u5305\u542b $0$ \u5728\u5185\u7684** $p^{\\lceil \\frac{c}{n} \\rceil}$ \u7684\u500d\u6570\u3002\u76f4\u63a5\u66b4\u529b\u679a\u4e3e\u5373\u53ef\u3002\n\n3. $p \\neq 2 \\operatorname{and} k \\bmod p^q \\neq 0 \\operatorname{and} k \\bmod p = 0$\n\n\u6b64\u65f6\u8bbe $x = ap^b, k = cp^d$\uff08$a, c \\bmod p \\neq 0 \\operatorname{and} b, d \\in Z$\uff09\uff0c\u5219 $bn = d$ \u4e14 $a^n \\equiv c \\pmod{p^{q - d}}$\u3002\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u89e3\u51fa $b = \\frac{d}{n}$\uff0c\u6c42\u4f59\u4e0b\u90a3\u4e2a\u65b9\u7a0b\u4ea4\u7ed9\u63a5\u4e0b\u6765\u8981\u8bb2\u7684\u60c5\u51b5 4\u3002\n\n\u8003\u8651\u89e3\u51fa\u6240\u6709 $a$ \u540e\u7684\u64cd\u4f5c\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u7b26\u5408\u6761\u4ef6\u7684 $a$ \u548c $t \\in Z$\uff0c\u4ee4 $a' = a + tp^{q - d}$\uff0c\u5219\u6240\u6709 $x = a'p^b < p^q$ \u90fd\u662f\u53ef\u884c\u7684\u89e3\u3002\n\n4. $p \\neq 2 \\operatorname{and} k \\bmod p \\neq 0$\n\n\u6b64\u65f6\u6c42\u51fa $p^q$ \u7684\u4e00\u4e2a\u539f\u6839 $g$\uff0c\u8bbe $x = g^a, k = g^b$\uff0c\u5219 $na \\equiv b \\pmod{\\varphi(p^q)}$\u3002\u5728\u6c42\u51fa\u539f\u6839\u540e\uff0c$b$ \u53ef\u4ee5\u7528 BSGS \u89e3\u51fa\uff0c$a$ \u53ef\u4ee5\u7528 exgcd \u89e3\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\u5f97\u51fa\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u770b\u8d77\u6765\u5f88\u9ad8\uff0c\u4f46\u7531\u4e8e\u8fd9\u9053\u9898\u4fdd\u8bc1\u6bcf\u4e2a\u8d28\u56e0\u6570\u5e42\u6b21\u5bf9\u5e94\u7684\u89e3\u6570\u548c\u6240\u6709\u8be2\u95ee\u7684\u603b\u89e3\u6570 $\\leq 10^6$\uff0c\u5b9e\u9645\u4e0a\u53ef\u4ee5\u901a\u8fc7\u3002\n\n\u9700\u8981\u6ce8\u610f\u7684\u662f #11 \u8fd9\u7ec4\u79bb\u8c31\u7684 Hack \u6570\u636e\uff0c\u6709\u53ef\u80fd\u67d0\u4e00\u4e2a\u8d28\u56e0\u6570\u5e42\u6b21\u5bf9\u5e94\u7684\u65b9\u7a0b\u65e0\u89e3\u4f46\u5176\u4ed6\u8d28\u56e0\u6570\u5e42\u6b21\u5bf9\u5e94\u7684\u65b9\u7a0b\u89e3\u6570\u90fd\u5f88\u5927\uff0c\u6b64\u65f6\u9700\u8981\u63d0\u524d\u5224\u65ad\u662f\u5426\u5b58\u5728\u4e00\u4e2a\u8d28\u56e0\u6570\u5e42\u6b21\u5bf9\u5e94\u7684\u65b9\u7a0b\u65e0\u89e3\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <iostream>\n#include <algorithm>\n#include <map>\n#include <vector>\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef struct {\n\tint mod;\n\tvector<ll> v;\n\t\n\tinline void clear(){\n\t\tmod = 1;\n\t\tv.clear();\n\t}\n} Equation;\n\nmap<int, int> mp_decompound;\nmap<ll, int> mp_bsgs;\nvector<Equation> v;\n\nint gcd(int a, int b){\n\treturn b == 0 ? a : gcd(b, a % b);\n}\n\ninline int lcm(int a, int b){\n\treturn a * b / gcd(a, b);\n}\n\nvoid exgcd(ll a, ll b, ll &x, ll &y){\n\tif (b == 0){\n\t\tx = 1;\n\t\ty = 0;\n\t\treturn;\n\t}\n\tll t;\n\texgcd(b, a % b, x, y);\n\tt = x;\n\tx = y;\n\ty = t - a / b * y;\n}\n\nEquation operator +(Equation &a, Equation &b){\n\tint sizea = a.v.size(), sizeb = b.v.size();\n\tll d = gcd(a.mod, b.mod), x, y, t1 = a.mod / d;\n\tEquation ans;\n\tvector<ll>::iterator it;\n\tans.mod = lcm(a.mod, b.mod);\n\texgcd(a.mod, b.mod, x, y);\n\tfor (register int i = 0; i < sizea; i++){\n\t\tfor (register int j = 0; j < sizeb; j++){\n\t\t\tll t2 = ((a.v[i] - b.v[j]) % a.mod + a.mod) % a.mod;\n\t\t\tif (t2 % d == 0) ans.v.push_back(((b.v[j] + b.mod * (y * (t2 / d) % t1) % ans.mod) % ans.mod + ans.mod) % ans.mod);\n\t\t}\n\t}\n\tsort(ans.v.begin(), ans.v.end());\n\tit = unique(ans.v.begin(), ans.v.end());\n\tans.v.erase(it, ans.v.end());\n\treturn ans;\n}\n\nEquation operator +=(Equation &a, Equation &b){\n\treturn a = a + b;\n}\n\ninline int euler(int n){\n\tint ans = n;\n\tfor (register int i = 2; (ll)i * i <= n; i++){\n\t\tif (n % i == 0){\n\t\t\tans = ans / i * (i - 1);\n\t\t\twhile (n % i == 0){\n\t\t\t\tn /= i;\n\t\t\t}\n\t\t}\n\t}\n\tif (n > 1) ans = ans / n * (n - 1);\n\treturn ans;\n}\n\ninline void decompound(int n){\n\tmp_decompound.clear();\n\tfor (register int i = 2; i * i <= n; i++){\n\t\twhile (n % i == 0){\n\t\t\tn /= i;\n\t\t\tmp_decompound[i]++;\n\t\t}\n\t}\n\tif (n > 1) mp_decompound[n] = 1;\n}\n\ninline ll quick_pow(ll x, ll p, ll mod){\n\tll ans = 1;\n\twhile (p){\n\t\tif (p & 1) ans = ans * x % mod;\n\t\tx = x * x % mod;\n\t\tp >>= 1;\n\t}\n\treturn ans;\n}\n\ninline int get_least_primitive_root(int n){\n\tint phi_n = euler(n);\n\tdecompound(phi_n);\n\tfor (register int i = 0; i < n; i++){\n\t\tif (gcd(i, n) > 1) continue;\n\t\tbool flag = true;\n\t\tfor (register map<int, int>::iterator j = mp_decompound.begin(); j != mp_decompound.end(); j++){\n\t\t\tif (quick_pow(i, phi_n / j->first, n) == 1){\n\t\t\t\tflag = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (flag) return i;\n\t}\n\treturn -1;\n}\n\ninline ll inv(ll a, ll b){\n\tll x, y;\n\texgcd(a, b, x, y);\n\treturn (x % b + b) % b;\n}\n\ninline int bsgs(int a, int b, int p){\n\tif (p == 1) return 0;\n\ta %= p;\n\tb %= p;\n\tif (b == 1) return 0;\n\tif (a == 0) return b == 0 ? 1 : -1;\n\tint n = ceil(sqrt(euler(p))), i = 0;\n\tll t = quick_pow(a, n, p);\n\tmp_bsgs.clear();\n\tfor (register ll j = b; i < n; i++, j = j * a % p){\n\t\tmp_bsgs[j] = i;\n\t}\n\ti = 1;\n\tfor (register ll j = t; i <= n; i++, j = j * t % p){\n\t\tif (mp_bsgs.count(j)) return i * n - mp_bsgs[j];\n\t}\n\treturn -1;\n}\n\ninline Equation solve(int a, int b, int p){\n\tint g = get_least_primitive_root(p), c = bsgs(g, b, p), phi_p = euler(p), d = gcd(a, phi_p);\n\tEquation ans;\n\tans.clear();\n\tans.mod = p;\n\tif (c % d != 0) return ans;\n\tint t = phi_p / d;\n\tll e = quick_pow(g, t, p), x, y, z;\n\tvector<ll>::iterator it;\n\texgcd(a, phi_p, x, y);\n\tx = (x * (c / d) % t + t) % t;\n\tz = quick_pow(g, x, p);\n\twhile (x < phi_p){\n\t\tans.v.push_back(z);\n\t\tx += t;\n\t\tz = z * e % p;\n\t}\n\tsort(ans.v.begin(), ans.v.end());\n\tit = unique(ans.v.begin(), ans.v.end());\n\tans.v.erase(it, ans.v.end());\n\treturn ans;\n}\n\nvoid write(int n){\n\tif (n >= 10) write(n / 10);\n\tputchar(n % 10 + '0');\n}\n\nvoid write(ll n){\n\tif (n >= 10) write(n / 10);\n\tputchar(n % 10 + '0');\n}\n\nint main(){\n\tint t;\n\tcin >> t;\n\tfor (register int i = 1; i <= t; i++){\n\t\tint n, m, k, ansa;\n\t\tbool flag = false;\n\t\tEquation ansb;\n\t\tcin >> n >> m >> k;\n\t\tv.clear();\n\t\tfor (register int j = 2; j <= m; j++){\n\t\t\tif (j * j > m){\n\t\t\t\tif (m == 1) break;\n\t\t\t\tj = m;\n\t\t\t}\n\t\t\tif (m % j == 0){\n\t\t\t\tint power = 0;\n\t\t\t\tEquation equation;\n\t\t\t\tequation.clear();\n\t\t\t\twhile (m % j == 0){\n\t\t\t\t\tm /= j;\n\t\t\t\t\tequation.mod *= j;\n\t\t\t\t\tpower++;\n\t\t\t\t}\n\t\t\t\tif (j == 2){\n\t\t\t\t\tequation.v.push_back(0);\n\t\t\t\t\tfor (register int x = 1, y = 2; x <= power; x++, y *= 2){\n\t\t\t\t\t\tint size = equation.v.size(), pre = y / 2;\n\t\t\t\t\t\tEquation t = equation;\n\t\t\t\t\t\tequation.v.clear();\n\t\t\t\t\t\tfor (register int z = 0; z < size; z++){\n\t\t\t\t\t\t\tif (quick_pow(t.v[z], n, y) == k % y) equation.v.push_back(t.v[z]);\n\t\t\t\t\t\t\tt.v[z] += pre;\n\t\t\t\t\t\t\tif (quick_pow(t.v[z], n, y) == k % y) equation.v.push_back(t.v[z]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (k % equation.mod == 0){\n\t\t\t\t\t\tll x = quick_pow(j, (power - 1) / n + 1, 0x7fffffffffffffffll);\n\t\t\t\t\t\tfor (register int y = 0; y < equation.mod; y += x){\n\t\t\t\t\t\t\tequation.v.push_back(y);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (k % j == 0){\n\t\t\t\t\t\tint u = k, v = 1, w = 0;\n\t\t\t\t\t\twhile (u % j == 0){\n\t\t\t\t\t\t\tu /= j;\n\t\t\t\t\t\t\tv *= j;\n\t\t\t\t\t\t\tw++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (w % n != 0){\n\t\t\t\t\t\t\tflag = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tint size;\n\t\t\t\t\t\tll mul = quick_pow(j, w / n, equation.mod);\n\t\t\t\t\t\tEquation t = solve(n, k / v, equation.mod / v);\n\t\t\t\t\t\tsize = t.v.size();\n\t\t\t\t\t\tfor (register int x = 0; x < size; x++){\n\t\t\t\t\t\t\tfor (register int y = 0; ; y++){\n\t\t\t\t\t\t\t\tll val = (t.v[x] + y * t.mod) * mul;\n\t\t\t\t\t\t\t\tif (val >= equation.mod) break;\n\t\t\t\t\t\t\t\tequation.v.push_back(val);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tequation = solve(n, k, equation.mod);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (equation.v.empty()){\n\t\t\t\t\tflag = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tv.push_back(equation);\n\t\t\t}\n\t\t}\n\t\tif (flag){\n\t\t\twrite(0);\n\t\t\tputchar('\\n');\n\t\t} else {\n\t\t\tint size = v.size();\n\t\t\tansb.clear();\n\t\t\tansb.v.push_back(0);\n\t\t\tfor (register int j = 0; j < size; j++){\n\t\t\t\tansb += v[j];\n\t\t\t}\n\t\t\tansa = ansb.v.size();\n\t\t\twrite(ansa);\n\t\t\tputchar('\\n');\n\t\t\tif (ansa != 0){\n\t\t\t\tfor (register int j = 0; j < ansa; j++){\n\t\t\t\t\twrite(ansb.v[j]);\n\t\t\t\t\tputchar(' ');\n\t\t\t\t}\n\t\t\t\tputchar('\\n');\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1655389653,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P5668 \u3010\u3010\u6a21\u677f\u3011N \u6b21\u5269\u4f59\u3011"
    },
    {
        "content": "\u6b64\u9898\u89e3\u5c06\u4f7f\u7528\u53e6\u4e00\u65b9\u6cd5\u89e3\u51b3\u6a21 $2^q$ \u7684\u60c5\u51b5\u3002\u8bb0 $\\{0,1,\\dots,m-1\\}$ \u4e3a $\\Z_m$\u3002\n\n\u89e3\u5173\u4e8e\u6574\u6570 $x$ \u7684\u65b9\u7a0b\uff0c$x^n\\equiv k\\pmod m$\uff0c\u5176\u4e2d $x\\in\\Z_m$\u3002\n\n\u9996\u5148\u6309\u7167\u60ef\u4f8b\uff0c\u5206\u89e3 $m=\\prod p_i^{q_i}$\uff0c\u63a5\u4e0b\u6765\u53ea\u9700\u8981\u8003\u8651\u7d20\u6570\u7684\u5e42\u3002$2$ \u7684\u5e42\u6bd4\u8f83\u7279\u6b8a\uff0c\u6ca1\u6709\u539f\u6839\uff0c\u5206\u5f00\u8003\u8651\u3002\n\n\u56de\u60f3 $m$ \u662f\u7d20\u6570\u65f6\u5982\u4f55\u6c42\u89e3\uff0c\u7279\u5224\u6389 $0$ \u7684\u60c5\u51b5\uff0c\u9996\u5148\u627e\u5230 $m$ \u7684\u4e00\u4e2a\u539f\u6839 $g$\uff0c\u63a5\u7740\u6c42\u89e3\u65b9\u7a0b $g^a\\equiv k\\pmod m$\u3002\u663e\u7136 $x$ \u4e00\u5b9a\u53ef\u4ee5\u8868\u793a\u4e3a $g^t$\uff0c\u5f97\u5230\u65b9\u7a0b $g^{tn}\\equiv g^a\\pmod m$\uff0c\u4e24\u4fa7\u540c\u65f6\u53d6\u79bb\u6563\u5bf9\u6570\uff0c\u6709 $tn\\equiv a\\pmod{(m-1)}$\uff0c\u6269\u6b27\u6c42\u5f97 $t$\uff0c\u5feb\u901f\u5e42\u5f97 $x$ \u5373\u53ef\u3002\u540c\u65f6\u77e5\u9053\u6b64\u65b9\u7a0b\u82e5\u6709\u89e3\uff0c\u5219\u6709 $\\gcd(n,m-1)$ \u4e2a\u89e3\u3002\n\n\u540c\u6837\u7684\u65b9\u6cd5\u53ef\u4ee5\u5e94\u7528\u5230\u6b64\u9898\u3002\u4e8e\u662f\u5206\u60c5\u51b5\uff1a\n\n1. $k=0$\uff1b\n1. $p_i=2$\uff1b\n1. $p_i$ \u4e3a\u5947\u7d20\u6570\u3002\n\n\u9996\u5148\u662f $k=0$\u3002\u5219\u6709 $x^n\\bmod p^q=0$\uff0c\u6ee1\u8db3\u65f6\u5f53\u4e14\u4ec5\u5f53 $x\\bmod p^{\\lceil\\frac qn\\rceil}=0$\u3002\n\n\u7136\u540e\u5f53 $k$ \u548c $p$ \u4e0d\u4e92\u8d28\u5c31\u4e0d\u592a\u884c\uff0c\u6240\u4ee5\u5c06 $k$ \u5206\u89e3\u4e3a $u\\cdot p^t(u\\bmod p\\ne0)$\uff0c\u91cd\u65b0\u89e3 $x^n\\equiv u\\pmod{p^{q-t}}$ \u5373\u53ef\u3002\n\n\u63a5\u4e0b\u6765\u662f $p_i=2$\u3002\u6709 $x^n\\equiv k\\pmod{2^q}$\u3002\n\u53ef\u4ee5\u53d1\u73b0\u6bcf\u4e2a\u6570\u53ef\u4ee5\u552f\u4e00\u5730\u8868\u793a\u4e3a $(-1)^a5^b\\bmod 2^q$\uff0c\u5176\u4e2d $a\\in\\Z_2,b\\in\\Z_{2^{q-2}}$\u3002\u4e24\u4e2a\u7ef4\u5ea6\u662f\u72ec\u7acb\u7684\uff0c\u4e8e\u662f\u5957\u7528 $m$ \u662f\u7d20\u6570\u7684\u89e3\u6cd5\u3002\n\n\u6700\u540e\u662f $p_i$ \u4e3a\u5947\u7d20\u6570\u3002\u5957\u7528 $m$ \u662f\u7d20\u6570\u7684\u5199\u6cd5\u5373\u53ef\u3002\n\n\u601d\u8def\u8fd8\u662f\u86ee\u6e05\u6670\u7684\uff0c\u5c31\u8fd9\u6837\u3002\u63a5\u4e0b\u6765\u662f\u8be6\u7ec6\u63a8\u5bfc\u3002\n\n\u5f15\u7406 1 $\\quad$ \u8bbe $m=\\prod p_i^{q_i}$\uff0c$p_i$ \u4e3a\u7d20\u6570\u4e14 $q_i>0$\uff0c\u5219 $\\Z_m$ \u548c $\\Z_{p_1^{q_1}}\\times\\Z_{p_2^{q_2}}\\times\\cdots$ \u53ef\u4ee5\u5efa\u7acb\u4e00\u4e2a\u552f\u4e00\u7684\u53cc\u5c04\uff0c\u6ee1\u8db3\u8fd9\u4e2a\u53cc\u5c04\u7684\u4e00\u4fa7\u7684\u6620\u5c04 $f:\\Z_m\\to\\Z_{p_1^{q_1}}\\times\\Z_{p_2^{q_2}}\\times\\cdots$\uff0c\u8868\u793a\u4e3a $f(x)=(x\\bmod p_1^{q_1},x\\bmod p_2^{q_2},\\dots)$\u3002\n>\u8bc1\u660e\uff1a\u663e\u7136\u6620\u5c04 $f$ \u6210\u7acb\uff0c\u8003\u8651\u8bc1\u660e $f$ \u6620\u5c04\u5230\u7684\u4e24\u4e24\u4e0d\u540c\u3002\u4f7f\u7528\u53cd\u8bc1\u6cd5\uff0c\u5047\u8bbe $x_1!=x_2$\uff0c\u540c\u65f6 $x_1\\bmod p_1^{q_1}=x_2\\bmod p_1^{q_1},x_1\\bmod p_2^{q_2}=x_2\\bmod p_2^{q_2},\\dots$\u3002\u53ef\u4ee5\u53d1\u73b0 $x_1-x_2$ \u5fc5\u7136\u662f\u6240\u6709 $p_i^{q_i}$ \u7684\u500d\u6570\uff0c\u53c8\u56e0\u4e3a $p_i^{q_i}$ \u90fd\u662f\u4e24\u4e24\u4e92\u7d20\uff0c\u6240\u4ee5\u5f97\u5230 $x_1-x_2$ \u662f $m$ \u7684\u500d\u6570\uff0c\u77db\u76fe\u3002\u8bc1\u6bd5\u3002\n\n\u6ce8\uff1a\u5c31\u662f\u5b59\u5b50\u5b9a\u7406\uff08CRT\uff09\u7684\u7279\u6b8a\u60c5\u51b5\u7684\u6709\u89e3\u8bc1\u660e\u90e8\u5206\u3002\n\n\u4e8e\u662f\u53ef\u4ee5\u5206\u89e3\u539f\u65b9\u7a0b\u4e3a\u82e5\u5e72\u4e92\u76f8\u72ec\u7acb\u7684\u65b9\u7a0b\uff0c\u5e76\u9010\u4e2a\u6c42\u89e3\uff0c\u6700\u540e\u5408\u5e76\u3002\n\n\u5f15\u7406 2 $\\quad$ \u82e5\u5173\u4e8e\u6574\u6570 $x$ \u7684\u65b9\u7a0b $x^n\\equiv k\\pmod m$ \u6709\u89e3\uff0c\u5f53\u4e14\u4ec5\u5f53 $k^{\\frac{\\varphi(m)}{\\gcd(n,\\varphi(m))}}\\equiv1\\pmod m$\u3002\u5176\u4e2d $m$ \u6709\u539f\u6839\u4e14 $\\gcd(k,m)=1$\u3002\uff08\u6ce8\u610f\uff0c\u6b64\u5904 $\\gcd(0,x)=x(x>0)$\u3002\uff09\n>\u8bc1\u660e\uff1a\n>\n>\u5145\u5206\u6027\uff1a\u5219\u987b\u8bc1\u660e\u5bf9\u4e8e\u6240\u6709 $x$\uff0c$(x^n)^{\\frac{\\varphi(m)}{\\gcd(n,\\varphi(m))}}\\equiv1\\pmod m$\u3002\u663e\u7136\u53ef\u5316\u4e3a $x^{\\operatorname{lcm}(n,\\varphi(m))}\\equiv1\\pmod m$\uff0c\u7531\u6b27\u62c9\u5b9a\u7406\u53ef\u8bc1\u3002\n>\n>\u5fc5\u8981\u6027\uff1a\u8bbe $m$ \u7684\u4e00\u4e2a\u539f\u6839\u4e3a $g$\uff0c\u663e\u7136\u5b58\u5728\u552f\u4e00 $k'\\in\\Z_{\\varphi(m)}$ \u6ee1\u8db3 $g^{k'}\\equiv k\\pmod m$\uff0c\u4ea6\u5b58\u5728\u552f\u4e00 $x'\\in\\Z_{\\varphi(m)}$ \u6ee1\u8db3 $g^{x'}\\equiv x\\pmod m$\u3002\u5219\u6761\u4ef6\u53d8\u4e3a $k'\\cdot\\frac{\\varphi(m)}{\\gcd(n,\\varphi(m))}\\equiv0\\pmod{\\varphi(m)}$\uff0c\u53ef\u5f97 $k'$ \u5fc5\u7136\u662f $\\gcd(n,\\varphi(m))$ \u7684\u500d\u6570\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u8981\u8bc1\u660e\u539f\u65b9\u7a0b\u6709\u89e3\uff0c\u5219\u8981\u8bc1\u660e $x'n\\equiv k'\\pmod{\\varphi(m)}$ \u6709\u89e3\uff0c\u800c\u6b64\u65b9\u7a0b\u6709\u89e3\u7684\u6761\u4ef6\u5373\u4e3a $k'$ \u662f $\\gcd(n,\\varphi(m))$ \u7684\u500d\u6570\uff08\u6839\u636e B\u00e9zout's Lemma\uff09\u3002\u5f97\u8bc1\u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u5224\u522b\u5bf9\u4e8e\u4e00\u4e2a $p^q$ \u6709\u6ca1\u6709\u89e3\u4e86\u3002\u4e0d\u5e78\u7684\u662f\uff0c\u5f53 $q>2$ \u65f6\uff0c$2^q$ \u5e76\u6ca1\u6709\u539f\u6839\uff0c\u6240\u4ee5\u53e6\u5916\u5904\u7406\u3002\u5148\u8bc1\u660e\u51e0\u4e2a\u57fa\u7840\u7684\u3002\n\n\u5f15\u7406 3 $\\quad$ $5^{2^{q-3}}\\equiv2^{q-1}+1\\pmod{2^q}$\uff0c\u5176\u4e2d $q>2$\u3002\n>\u8bc1\u660e\uff1a\u4f7f\u7528\u5f52\u7eb3\u6cd5\u3002\u663e\u7136 $q=3$ \u65f6\u6210\u7acb\u3002\u5047\u8bbe $q=i$ \u6210\u7acb\uff0c\u6709 $5^{2^{i-3}}\\equiv2^{i-1}+1\\pmod{2^i}$\uff0c\u5219 $5^{2^{i-3}}\\equiv2^{i-1}+1\\pmod{2^{i+1}}$ \u6216\u8005 $5^{2^{i-3}}\\equiv2^i+2^{i-1}+1\\pmod{2^{i+1}}$\u3002\u4e24\u4fa7\u540c\u65f6\u5e73\u65b9\uff0c\u524d\u4e00\u4e2a\u5f97\u5230 $5^{2^{i-2}}\\equiv2^{2i-2}+2^i+1\\equiv2^i+1\\pmod{2^{i+1}}$\uff0c\u540e\u4e00\u4e2a\u5f97\u5230 $5^{2^{i-2}}\\equiv2^{2i+1}+2^{2i-2}+2^{i+1}+2^i+1\\equiv2^i+1\\pmod{2^{i+1}}$\u3002\u4e8e\u662f $q=i+1$ \u6210\u7acb\u3002\u6839\u636e\u5f52\u7eb3\uff0c\u8bc1\u6bd5\u3002\n\n\u5f15\u7406 4 $\\quad$ $5$ \u5728\u6a21 $2^q$ \u610f\u4e49\u4e0b\u7684\u9636\u4e3a $2^{q-2}$\uff0c\u5176\u4e2d $q>2$\u3002\n>\u8bc1\u660e\uff1a\u6613\u77e5 $5$ \u7684\u9636\u5fc5\u5b9a\u662f $\\varphi(2^q)=2^{q-1}$ \u7684\u56e0\u6570\uff0c\u4e5f\u5c31\u662f $2^i(i\\in\\Z_q)$\u3002\u800c\u5982\u679c $5^{2^i}\\equiv1\\pmod{2^q}$\uff0c\u5219 $5^{2^j}\\equiv1\\pmod{2^q}(j\\ge i)$\uff0c\u4e8e\u662f\u6839\u636e\u5f15\u7406 3\uff0c$5$ \u7684\u9636\u5fc5\u7136 $>2^{q-3}$\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u5f15\u7406 3 \u4e24\u4fa7\u540c\u65f6\u5e73\u65b9\uff0c\u6709 $5^{2^{q-2}}\\equiv2^{2q-2}+2^q+1\\equiv1\\pmod{2^q}$\uff0c\u6240\u4ee5 $5$ \u7684\u9636\u5fc5\u7136 $\\le2^{q-2}$\u3002\u7efc\u4e0a\u6709 $5$ \u7684\u9636\u4e3a $2^{q-2}$\uff0c\u8bc1\u6bd5\u3002\n\n\u5f15\u7406 5 $\\quad$ \u5173\u4e8e $a,b$ \u7684\u65b9\u7a0b $(-1)^a5^b\\equiv x\\pmod{2^q}$\uff0c\u5176\u4e2d $q>2,a\\in\\Z_2,b\\in\\Z_{2^{q-2}},\\gcd(x,2)=1$\uff0c\u6709\u552f\u4e00\u89e3\u3002\n>\u8bc1\u660e\uff1a\u9996\u5148\uff0c\u6839\u636e\u5f15\u7406 4\uff0c$5$ \u7684\u9636\u662f $2^{q-2}$\uff0c\u6240\u4ee5 $\\{5^0\\bmod2^q,5^1\\bmod2^q,\\dots,5^{2^{q-2}-1}\\bmod2^q\\}$ \u4e2d\u7684\u5143\u7d20\u4e92\u4e0d\u76f8\u540c\u3002\u8bc1\u660e\u6ca1\u6709\u4e8c\u89e3\uff0c\u4f7f\u7528\u53cd\u8bc1\u6cd5\uff0c\u5047\u8bbe $(-1)^{a_1}5^{b_1}\\equiv(-1)^{a_2}5^{b_2}\\pmod{2^q}$\uff0c\u7531\u4e0a\u5f97 $a_1\\ne a_2$\u3002\u4e8e\u662f\u6709 $5^{b_1}+5^{b_2}\\equiv0\\pmod{2^q}$\uff0c\u4f46\u662f\u5de6\u4fa7\u6a21 $4$ \u4e3a $2$\uff0c\u53f3\u4fa7\u6a21 $4$ \u4e3a $0$\uff0c\u77db\u76fe\u3002\u4ece\u800c\u5f97\u8bc1\u3002\u8bc1\u660e\u4e0d\u53ef\u80fd\u65e0\u89e3\uff0c\u5219\u7531\u4e0a\u6709\u6240\u6709 $(-1)^a5^b$ \u4e92\u4e0d\u76f8\u540c\uff0c\u800c\u4e00\u5171\u6709 $2^{q-1}$ \u4e2a $(-1)^a5^b$\uff0c\u4e8e\u662f\u4e00\u5b9a\u53ef\u4ee5\u548c\u6240\u6709 $x$ \u5bf9\u5e94\uff0c\u8bc1\u6bd5\u3002\n\n\u53d1\u73b0 $x=(-1)^a5^b\\pmod{2^q}$ \u6709\u552f\u4e00\u89e3\uff0c\u6240\u4ee5\u8003\u8651\u6539\u5199\u65b9\u7a0b\u4e3a $(-1)^{a_xn}5^{b_xn}\\equiv(-1)^{a_k}5^{b_k}\\pmod{2^q}$\u3002$a_k$ \u548c $b_k$ \u53ef\u7531\u4e24\u6b21\u79bb\u6563\u5bf9\u6570\u5f97\u5230\u3002\u7136\u540e\u56e0\u4e3a\u76f8\u4e92\u72ec\u7acb\uff0c\u62c6\u89e3\u4e3a\u4e24\u4e2a\u65b9\u7a0b $a_xn\\equiv a_k\\pmod2$ \u548c $b_xn\\equiv b_k\\pmod{2^{p-2}}$\u3002\u6269\u6b27\u6c42\u89e3\u5373\u53ef\u3002\n\n\u81f3\u6b64\u5b8c\u6574\u5730\u7ed9\u51fa\u4e86 $x^n\\equiv k\\pmod{p^q}$\uff08$p$ \u662f\u7d20\u6570\u4e14 $\\gcd(k,p)=1$\uff09\u7684\u6c42\u89e3\u7684\u63a8\u5bfc\u3002\u63a5\u4e0b\u6765\u7684\u95ee\u9898\u662f\uff1a\u5982\u679c $k=0$ \u6216\u662f $\\gcd(k,p)=p$ \u600e\u4e48\u529e\uff1f\n\n\u5148\u89e3\u51b3 $k=0$\u3002\n\n\u5f15\u7406 6 $\\quad$ \u5173\u4e8e\u6574\u6570 $x$ \u7684\u65b9\u7a0b $x^n\\equiv0\\pmod{p^q}$ \u7684\u89e3\u4e3a $x\\equiv0\\pmod{p^{\\lceil\\frac qn\\rceil}}$\u3002\n>\u8bc1\u660e\uff1a\u53cd\u8bc1\u3002\u82e5 $x$ \u542b $p$ \u5c11\u4e8e $\\lceil\\frac qn\\rceil$\uff0c\u5219 $x^n$ \u542b $p$ \u5c11\u4e8e $\\lceil\\frac qn\\rceil\\cdot n$\uff0c\u4e5f\u5c31\u5c11\u4e8e $q$\uff0c\u77db\u76fe\u3002\u8bc1\u6bd5\u3002\n\n\u7136\u540e\u662f\u4e0d\u4e92\u7d20\u3002\n\n\u5f15\u7406 7 $\\quad$ \u5173\u4e8e\u6574\u6570 $x$ \u7684\u65b9\u7a0b $x^n\\equiv u\\cdot p^t\\pmod{p^q}$\uff0c\u5176\u4e2d $\\gcd(u,p)=1$\uff0c\u6709\u89e3\u5f53\u4e14\u4ec5\u5f53 $t\\bmod n=0$\u3002\n>\u8bc1\u660e\uff1a\u76f4\u63a5\u6784\u9020\u3002\u8bbe $x^n\\equiv u\\pmod{p^{q-t}}$ \u7684\u89e3\u4e3a $x_0$\uff0c\u5219\u539f\u65b9\u7a0b\u89e3\u4e3a $(x_0+z\\cdot p^{q-t})\\cdot p^{\\frac tn}$\u3002\u8bc1\u6bd5\u3002\n\n\u81f3\u6b64\u5168\u90e8\u60c5\u51b5\u68b3\u7406\u5b8c\u6bd5\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\sqrt m+\\tau\\log m+s)$\uff0c$s$ \u4e3a\u89e3\u6570\uff0c$\\tau$ \u4e3a\u79bb\u6563\u5bf9\u6570\u65f6\u95f4\u590d\u6742\u5ea6\u3002\n\n\u4ee3\u7801\u7528\u4e86\u4e0b `pb_ds` \u7684\u54c8\u5e0c\u8868\uff08\u7528\u6765\u52a0\u901f BSGS\uff09\u3002\u5904\u7406 $p=2$ \u65f6\u9a6c\u8702\u8f83\u4e3a\u9634\u95f4\uff0c\u4e14\u542b\u6709\u538b\u884c\uff0c\u5efa\u8bae\u4e0d\u9605\u8bfb\u3002\n```cpp\n#include<stdio.h>\n#include<vector>\n#include<ext/pb_ds/assoc_container.hpp>\ntypedef long long ll;\nbool f;\nint lp,le,e[2000001];\nll n,m,k,p[21],pw[21],c[21];\nstd::vector<ll>r[21];\n__gnu_pbds::gp_hash_table<ll,ll>h;\nll gcd(ll x,ll y){return y?gcd(y,x%y):x;}\nll Pow(ll a,ll b,ll m)\n{\n\tll s=1;\n\tfor(a%=m;b;a=a*a%m,b>>=1)\n\t\tif(b&1)\n\t\t\ts=s*a%m;\n\treturn s;\n}\nll BSGS(ll a,ll b,ll m)\n{\n\ta%=m,b%=m,h.clear();\n\tif(b==1)\n\t\treturn 0;\n\tif(!a&&b)\n\t\treturn -1;\n\tll s=sqrt(m)+1,aa=1;\n\tfor(ll i=0;i<s;i++)\n\t\th[b*aa%m]=i,aa=aa*a%m;\n\tfor(ll i=1,j=aa;i<=s;i++,j=j*aa%m)\n\t{\n\t\tint x=h[j];\n\t\tif(x||j==b)\n\t\t\treturn i*s-x;\n\t}\n\treturn -1;\n}\nll exgcd(ll a,ll b,ll&x,ll&y)\n{\n\tif(!b)\n\t\treturn x=1,y=0,a;\n\tint g=exgcd(b,a%b,y,x);\n\treturn y-=a/b*x,g;\n}\nbool DiscreteRoots(ll z)\n{\n\tif(k%pw[z])\n\t{\n\t\tll kp=k%pw[z],pk=1,mk=0;\n\t\twhile(kp%p[z]==0)\n\t\t\tkp/=p[z],pk*=p[z],mk++;\n\t\tif(mk%n)\n\t\t\treturn 1;\n\t\tll pwk=pw[z]/pk,h=pwk/p[z]*(p[z]-1),g,le=0,e[21];\n\t\tif(Pow(kp,h/gcd(n,h),pwk)!=1)\n\t\t\treturn 1;\n\t\tfor(ll i=2;i*i<=h;i++)\n\t\t\tif(h%i==0)\n\t\t\t{\n\t\t\t\twhile(h%i==0)\n\t\t\t\t\th/=i;\n\t\t\t\te[le++]=i;\n\t\t\t}\n\t\tif(h>1)\n\t\t\te[le++]=h;\n\t\tfor(g=1;;g++)\n\t\t{\n\t\t\tbool f=1;\n\t\t\tfor(int i=0;i<le&&f;i++)\n\t\t\t\tif(Pow(g,pwk/p[z]*(p[z]-1)/e[i],pwk)==1) \n\t\t\t\t\tf=0;\n\t\t\tif(f)\n\t\t\t\tbreak;\n\t\t}\n\t\tll x=BSGS(g,kp,pwk),ka,kb,y=exgcd(n,pwk/p[z]*(p[z]-1),ka,kb);\n\t\tif(x%y)\n\t\t\treturn 1;\n\t\th=pwk/p[z]*(p[z]-1)/y,kb=Pow(p[z],mk/n,pw[z]),r[z].resize(y*(pk/kb)),r[z][0]=Pow(g,(ka*(x/y)%h+h)%h,pwk),ka=kb,kb=Pow(g,h,pwk);\n\t\tfor(ll i=1;i<y;i++)\n\t\t\tr[z][i]=r[z][i-1]*kb%pwk;\n\t\tfor(ll i=y;i<y*(pk/ka);i++)\n\t\t\tr[z][i]=(r[z][i-y]+pwk)%(pw[z]/ka);\n\t\tfor(ll i=0;i<y*(pk/ka);i++)\n\t\t\tr[z][i]=r[z][i]*ka;\n\t}\n\telse\n\t{\n\t\tll x=0,y=1,o=Pow(p[z],n,pw[z]);\n\t\twhile(y)\n\t\t\tx++,y=y*o%pw[z];\n\t\tr[z].resize(o=pw[z]/(y=Pow(p[z],x,pw[z]+1)));\n\t\tfor(ll i=0;i<o;i++)\n\t\t\tr[z][i]=i*y;\n\t}\n\treturn 0;\n}\nvoid dfs(ll st,ll x)\n{\n\tif(st==lp)\n\t{\n\t\te[le++]=x;\n\t\treturn;\n\t}\n\tfor(ll i:r[st])\n\t\tdfs(st+1,(x+i*c[st])%m);\n\treturn;\n}\nint main()\n{\n\tint t;\n\tscanf(\"%d\",&t);\n\twhile(t--)\n\t{\n\t\tscanf(\"%lld%lld%lld\",&n,&m,&k),f=1,lp=le=0;\n\t\tif(n==1)\n\t\t{\n\t\t\tprintf(\"1\\n%lld\\n\",k);\n\t\t\tcontinue;\n\t\t}\n\t\tif(!(m&7))\n\t\t{\n\t\t\tll mp=3;\n\t\t\tp[0]=2,pw[0]=8,m>>=3;\n\t\t\twhile(!(m&1))\n\t\t\t\tm>>=1,pw[0]<<=1,mp++;\n\t\t\tif(k&pw[0]-1)\n\t\t\t{\n\t\t\t\tll k2=k&pw[0]-1,r2=0;\n\t\t\t\twhile(!(k2&1))\n\t\t\t\t\tk2>>=1,r2++;\n\t\t\t\tif(r2%n)\n\t\t\t\t{\n\t\t\t\t\tputs(\"0\");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(pw[0]>>r2>4)\n\t\t\t\t{\n\t\t\t\t\tll w_1=0,w5=BSGS(5,k2,pw[0]>>r2);\n\t\t\t\t\tif(!~w5)\n\t\t\t\t\t\tw_1=1,w5=BSGS(5,(pw[0]>>r2)-k2,pw[0]>>r2);\n\t\t\t\t\tif(n&1)\n\t\t\t\t\t{\n\t\t\t\t\t\tll x,y,g=exgcd(n,pw[0]>>r2+2,x,y);\n\t\t\t\t\t\tif(w5%g)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tputs(\"0\");\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tw5/=g,x=x*w5&(pw[0]>>r2+2)/g-1,y=Pow(5,(pw[0]>>r2+2)/g,pw[0]>>r2),r[0].resize(g),r[0][0]=w_1?(pw[0]>>r2)-Pow(5,x,pw[0]>>r2):Pow(5,x,pw[0]>>r2);\n\t\t\t\t\t\tfor(ll i=1;i<g;i++)\n\t\t\t\t\t\t\tr[0][i]=r[0][i-1]*y&(pw[0]>>r2)-1;\n\t\t\t\t\t}\n\t\t\t\t\telse if(w_1)\n\t\t\t\t\t{\n\t\t\t\t\t\tputs(\"0\");\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tll x,y,g=exgcd(n,pw[0]>>r2+2,x,y);\n\t\t\t\t\t\tif(w5%g)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tputs(\"0\");\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tw5/=g,x=x*w5&(pw[0]>>r2+2)/g-1,y=Pow(5,(pw[0]>>r2+2)/g,pw[0]>>r2),r[0].resize(g<<1),r[0][g]=(pw[0]>>r2)-(r[0][0]=Pow(5,x,pw[0]>>r2));\n\t\t\t\t\t\tfor(ll i=1;i<g;i++)\n\t\t\t\t\t\t\tr[0][i]=r[0][i-1]*y&(pw[0]>>r2)-1,r[0][i+g]=r[0][i+g-1]*y&(pw[0]>>r2)-1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tfor(ll i=0;i<pw[0]>>r2;i++)\n\t\t\t\t\t\tif(Pow(i,n,pw[0]>>r2)==k&(pw[0]>>r2)-1)\n\t\t\t\t\t\t\tr[0].emplace_back(i);\n\t\t\t\tll s=r[0].size();\n\t\t\t\tr[0].resize(s<<r2-r2/n);\n\t\t\t\tfor(ll i=s;i<s<<r2-r2/n;i++)\n\t\t\t\t\tr[0][i]=r[0][i-s]+(pw[0]>>r2)&(pw[0]>>r2/n)-1;\n\t\t\t\tfor(ll i=0;i<s<<r2-r2/n;i++)\n\t\t\t\t\tr[0][i]=r[0][i]<<r2/n;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tll l=1ll<<mp-(mp-1)/n-1;\n\t\t\t\tr[0].resize(l);\n\t\t\t\tfor(ll i=0;i<l;i++)\n\t\t\t\t\tr[0][i]=i<<(mp-1)/n+1;\n\t\t\t}\n\t\t\tlp++;\n\t\t}\n\t\telse if(!(m&3))\n\t\t{\n\t\t\tp[0]=2,pw[0]=4,m>>=2;\n\t\t\tfor(ll i=0;i<4;i++)\n\t\t\t\tif(Pow(i,n,4)==(k&3))\n\t\t\t\t\tr[0].emplace_back(i);\n\t\t\tif(r[0].empty())\n\t\t\t{\n\t\t\t\tputs(\"0\");\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlp++;\n\t\t}\n\t\telse if(!(m&1))\n\t\t\tp[0]=2,pw[0]=2,m>>=1,r[0].emplace_back(k&1),lp++;\n\t\tfor(ll i=3;i*i<=m;i+=2)\n\t\t\tif(m%i==0)\n\t\t\t{\n\t\t\t\tp[lp]=i,pw[lp]=1;\n\t\t\t\twhile(m%i==0)\n\t\t\t\t\tm/=i,pw[lp]*=i;\n\t\t\t\tif(DiscreteRoots(lp))\n\t\t\t\t{\n\t\t\t\t\tf=0;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tlp++;\n\t\t\t}\n\t\tif(!f)\n\t\t{\n\t\t\tputs(\"0\");\n\t\t\twhile(lp--)\n\t\t\t\tr[lp].clear();\n\t\t\tcontinue;\n\t\t}\n\t\tif(m>1)\n\t\t{\n\t\t\tp[lp]=pw[lp]=m,m=1;\n\t\t\tif(DiscreteRoots(lp))\n\t\t\t{\n\t\t\t\tputs(\"0\");\n\t\t\t\twhile(lp--)\n\t\t\t\t\tr[lp].clear();\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlp++;\n\t\t}\n\t\tfor(ll i=0;i<lp;i++)\n\t\t\tm*=pw[i];\n\t\tfor(ll i=0;i<lp;i++)\n\t\t\tc[i]=m/pw[i]*Pow(m/pw[i],pw[i]/p[i]*(p[i]-1)-1,pw[i])%m;\n\t\tdfs(0,0),std::sort(e,e+le),printf(\"%lld\\n\",le);\n\t\tfor(ll i=0;i<le;++i,i<le?putchar(' '):putchar('\\n'))\n\t\t\tprintf(\"%lld\",e[i]);\n\t\twhile(lp--)\n\t\t\tr[lp].clear();\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1681133670,
        "uid": 335096,
        "name": "Eznibuil",
        "ccfLevel": 7,
        "title": "\u9898\u89e3\uff1aP5668 \u3010\u6a21\u677f\u3011N \u6b21\u5269\u4f59"
    }
]
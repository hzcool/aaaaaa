[
    {
        "content": "\u9996\u5148\u8003\u8651\u79bb\u7ebf\u626b\u63cf\u7ebf\uff0c\u626b\u63cf $r$\uff0c\u7136\u540e\u5bf9\u6bcf\u4e2a $i$ \u7ef4\u62a4 $l\\le i$ \u7684\u7b54\u6848\u4e4b\u548c $s_i$\uff0c\u8fd9\u6837\u7b54\u6848\u5c31\u53ef\u4ee5\u5199\u4e3a $s_r-s_{l-1}$\u3002\n\n\u6211\u4eec\u8bbe $A_i=a_i\\operatorname{bitand} \\cdots\\operatorname{bitand} a_r$\uff0c$B_i=b_i\\operatorname{bitor} \\cdots\\operatorname{bitor} b_r$\uff0c$C_i=\\gcd(c_i,\\cdots,c_r)$\u3002\n\n\u7136\u540e\u8003\u8651 $r$ \u5411\u53f3\u79fb $1$\uff0c\u8fd9\u4e2a\u65f6\u5019 $s_i$ \u7684\u53d8\u5316\u91cf\uff0c\u5982\u679c $A_i,B_i,C_i$ \u90fd\u6ca1\u6709\u53d1\u751f\u53d8\u5316\uff0c\u90a3\u4e48 $s_i$ \u7684\u53d8\u5316\u91cf\u4e5f\u548c\u4e0a\u6b21\u53f3\u79fb\u7684\u65f6\u5019\u4e00\u81f4\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a\u6bcf\u4e2a $s_i$ \u5199\u6210 $p_ir+q_i$ \u7684\u5f62\u5f0f\uff0c\u90a3\u4e48\u9700\u8981\u4fee\u6539 $p_i,q_i$ \u7684 $i$ \u5c31\u53ea\u6709 $A_i,B_i,C_i$ \u53d1\u751f\u53d8\u5316\u7684\u90e8\u5206\uff0c\u7531\u4e8e $A_i,B_i,C_i$ \u90fd\u53ea\u4f1a\u53d1\u751f $O(\\log v)$ \u6b21\u4fee\u6539\uff08$v$ \u662f\u503c\u57df\uff09\uff0c\u6240\u4ee5\u603b\u53d8\u5316\u6b21\u6570\u53ea\u6709 $O(n\\log v)$ \u6b21\uff0c\u66b4\u529b\u4fee\u6539\u5373\u53ef\u3002\n\n\u67e5\u8be2\u662f $O(1)$ \u7684\uff0c\u6240\u4ee5\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log v+m)$\u3002\n\n```cpp\n#include<iostream>\n#include<vector>\n#include<utility>\nusing std::cin;\nusing std::cout;\n#define int unsigned\nint n,m,a[1000010],b[1000010],c[1000010];\nint gcd(int x,int y){\n\treturn x?gcd(y%x,x):y;\n}\nstd::vector<std::pair<int,int>> vec[1000010];\nint ans[5000010];\nint T;\nint val[1000010],ad[1000010],nt[1000010];\nint query(int p){\n\treturn val[p]+ad[p]*(T-nt[p]);\n}\nsigned main(){\n\tstd::ios::sync_with_stdio(false),cin.tie(nullptr);\n\tcin>>n>>m;\n\tfor(int i=1;i<=n;i++) cin>>a[i];\n\tfor(int i=1;i<=n;i++) cin>>b[i];\n\tfor(int i=1;i<=n;i++) cin>>c[i];\n\tfor(int i=1,l,r;i<=m;i++) cin>>l>>r,vec[r].emplace_back(l,i);\n\tfor(int i=1;i<=n;i++){\n\t\tint p=i-1;\n\t\twhile(p!=0){\n\t\t\tint u=a[p]&a[p+1];\n\t\t\tint v=b[p]|b[p+1];\n\t\t\tint w=gcd(c[p],c[p+1]);\n\t\t\tif(u==a[p]&&v==b[p]&&w==c[p]) break;\n\t\t\ta[p]=u,b[p]=v,c[p]=w;\n\t\t\t--p;\n\t\t}\n\t\tval[i]=query(i-1);\n\t\tfor(int j=p+1;j<=i;j++){\n\t\t\tval[j]=query(j);\n\t\t\tad[j]=ad[j-1]+a[j]*b[j]*c[j];\n\t\t\tnt[j]=T;\n\t\t}\n\t\t++T;\n\t\tfor(auto [l,id]:vec[i]) ans[id]=query(i)-query(l-1);\n\t}\n\tfor(int i=1;i<=m;i++) cout<<ans[i]<<'\\n';\n\treturn 0;\n}\n```\n\n",
        "postTime": 1659690178,
        "uid": 55707,
        "name": "gxy001",
        "ccfLevel": 9,
        "title": "P8421 [THUPC2022 \u51b3\u8d5b] rsraogps"
    },
    {
        "content": "\u9996\u5148\u79bb\u7ebf\u95ee\u9898\uff0c\u8003\u8651\u5bf9\u533a\u95f4\u53f3\u7aef\u70b9 $r$ \u505a $1\\to n$ \u7684\u626b\u63cf\u7ebf\u3002\n\n\u626b\u63cf\u7ebf\u8fc7\u7a0b\u4e2d\u7ef4\u62a4\n\n+ ${a^\\prime}_i=a_i\\operatorname{and}\\cdots\\operatorname{and}a_r$\n+ ${b^\\prime}_i=b_i\\operatorname{or}\\cdots\\operatorname{or}a_r$\n+ ${c^\\prime}_i=\\gcd(c_i,\\cdots,c_r)$\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u8fd9\u6837\u4e00\u4e2a\u6027\u8d28\uff08\uff1f\uff1a\u968f\u7740 $r$ \u7684\u589e\u5927\uff0c\n\n+ ${a^\\prime}_i$ \u7684 $1$ \u4f4d\u4f1a\u9010\u6e10\u53d8\u6210 $0$\u3002\n+ ${b^\\prime}_i$ \u7684 $0$ \u4f4d\u4f1a\u9010\u6e10\u53d8\u6210 $1$\u3002\n+ ${c^\\prime}_i$ \u7684\u8d28\u56e0\u5b50\u4f1a\u9010\u6e10\u88ab\u53bb\u6389\u3002\n\n\u800c\u8fd9\u4e09\u8005\u7684\u53d8\u5316\u6b21\u6570\u90fd\u662f $\\log n$ \u7ea7\u522b\u3002\n\n\u6211\u4eec\u7ef4\u62a4 $s_i$ \u4e3a\u5de6\u7aef\u70b9 $\\le i$\uff0c\u53f3\u7aef\u70b9 $\\le r$ \u7684\u533a\u95f4\u4ef7\u503c\u603b\u548c\uff0c\u5bf9\u4e8e $L,R$ \u7684\u8be2\u95ee\uff0c\u7b54\u6848\u5c31\u662f $s_{R}-s_{L-1}$\u3002\n\n\u8003\u8651 $r$ \u7684\u4e00\u6b21\u53f3\u79fb\u5bf9 ${a^\\prime}_i,{b^\\prime}_i,{c^\\prime}_i$ \u7684\u5f71\u54cd\uff0c\u8fdb\u800c\u8003\u8651\u5bf9 $s_i$ \u7684\u5f71\u54cd\uff08\u5176\u5b9e\u5c31\u662f $[i,r+1],[i+1,r+1],\\cdots,[r+1,r+1]$ \u7684\u4ef7\u503c\u548c\uff09\u3002\n\n\u6839\u636e\u4e0a\u9762\u7684\u6027\u8d28\uff0c\u6211\u4eec\u53d1\u73b0\uff1a\u5bf9\u4e8e ${a^\\prime}_i,{b^\\prime}_i,{c^\\prime}_i$ \u800c\u8a00\uff0c\u5728 $i$ \u5f88\u9760\u8fd1 $r$ \u65f6\u5f71\u54cd\u5f88\u5927\uff0c\u800c\u6bcf\u8fdc\u79bb\u4e00\u70b9\u5f71\u54cd\u5c31\u6bd4\u524d\u4e00\u6b21\u5c0f\u3002\u5230\u8fbe\u4e00\u4e2a\u4f4d\u7f6e $p$ \u4e4b\u540e\u5c31\u518d\u4e5f\u6ca1\u6709\u5f71\u54cd\u4e86\u3002\n\n\u5e76\u4e14\uff0c\u6709\u5f71\u54cd\u7684\u4f4d\u7f6e\u6bcf\u6b21\u90fd\u662f $O(\\log n)$ \u4e2a\uff0c\u56e0\u6b64\u53ef\u4ee5\u8003\u8651\u5bf9\u4e8e\u6bcf\u6b21\u79fb\u52a8 $r$\uff0c\u90fd\u66b4\u529b\u904d\u5386\u627e\u5230 $p$\uff0c\u590d\u6742\u5ea6\u662f $O(n\\log n)$ \u7684\u3002\u7136\u540e\u5bf9\u4e8e $p,\\cdots,r$ \u7684\u4f4d\u7f6e\uff0c\u66b4\u529b\u8ba1\u7b97\u65b0\u4ef7\u503c\u548c\u3002\n\n\u90a3 $1,\\cdots,p-1$ \u7684\u4f4d\u7f6e\u7684\u7b54\u6848\u600e\u4e48\u529e\u5462\uff1f\u6211\u4eec\u53d1\u73b0\u8fd9\u4e00\u8f6e\u6ca1\u6709\u5f71\u54cd\u4ed6\u4eec\u7684\u7b54\u6848\uff0c\u6240\u4ee5\u4ed6\u4eec\u7684\u7b54\u6848\u66f4\u65b0\u5176\u5b9e\u548c\u4e0a\u4e00\u8f6e\u4fee\u6539\u7684\u7b54\u6848\u66f4\u65b0\u662f\u4e00\u6837\u7684\uff0c\u4e0d\u9700\u8981\u518d\u8ba1\u7b97\u3002\n\n\u4e8e\u662f\u6211\u4eec\u7ed9\u6bcf\u4e2a\u4f4d\u7f6e\u90fd\u6253\u4e0a\u6807\u8bb0\uff0c\u4ee3\u8868\u5b83\u4e0a\u4e00\u6b21\u4fee\u6539\u589e\u52a0\u7684\u4ef7\u503c\u548c $w$\uff0c\u540c\u65f6\u591a\u7ef4\u62a4\u4e00\u4e2a\u4e0a\u4e00\u8f6e\u4fee\u6539\u7684\u65f6\u95f4 $t$\uff0c\u90a3\u4e48 $r$ \u65f6\u523b\u603b\u4f53\u7b54\u6848\u53ef\u4ee5\u7406\u89e3\u4e3a $s_i+(r-t)\\times w$\u3002\n\n\u5f53\u7136\u66b4\u529b\u8ba1\u7b97\u7b54\u6848\u8fd9\u4e00\u6b65\u8981\u5148\u628a\u4e4b\u524d\u6253\u7684\u6807\u8bb0\u7684\u8d21\u732e\u7b97\u5230 $s_i$ \u91cc\u9762\u53bb\uff0c\u518d\u628a\u65b0\u7684\u8d21\u732e\u6253\u5728\u6807\u8bb0\u91cc\u9762\u3002\n\n\u5206\u6790\u4e00\u4e0b\u65f6\u95f4\u3002\u6211\u4eec\u679a\u4e3e $p$ \u8fd9\u6b65\u5c31 $O(n\\log n)$ \u4e86\uff0c\u6309\u4f4d\u4e0e\u548c\u6309\u4f4d\u6216\u4f5c\u4e3a\u4f4d\u8fd0\u7b97\u662f $O(1)$ \u7684\u3002$\\gcd$ \u770b\u8d77\u6765\u590d\u6742\u5ea6\u4e0d\u592a\u5bf9\uff0c\u4f46\u662f\u603b\u5171\u53ea\u4f1a\u6709 $O(\\log n)$ \u4e2a\u56e0\u5b50\uff0c\u4f60\u7528\u8f97\u8f6c\u76f8\u9664\u6c42 $\\gcd$ \u5373\u4f7f\u6c42 $\\log n$ \u6b21\u4e5f\u53ea\u6709 $O(\\log n)$ \u7684\u8ba1\u7b97\u91cf\u3002",
        "postTime": 1683817345,
        "uid": 368107,
        "name": "xfrvq",
        "ccfLevel": 7,
        "title": "P8421 [THUPC2022 \u51b3\u8d5b] rsraogps"
    },
    {
        "content": "\u4ee4 $A[l:r]$\uff0c$B[l:r]$\uff0c$C[l:r]$ \u4e3a $l\\dots r$ \u7684\u6309\u4f4d\u4e0e\uff0c\u6309\u4f4d\u6216\uff0c\u548c\u516c\u7ea6\u6570\u3002\u5f53\u56fa\u5b9a $l$\uff0c\u6700\u591a\u6709 $O(\\log n)$ \u4e2a\u4e0d\u540c\u7684 $A[l:r]$\uff0c$B[l:r]$\uff0c$C[l:r]$\uff0c\u4e8e\u662f\u6709 $O(\\log n)$ \u4e2a\u4e0d\u540c\u7684\u4ef7\u503c\uff0c\u5e76\u4e14\u6bcf\u4e00\u4e2a\u4ef7\u503c\u5bf9\u5e94\u4e00\u4e2a $r$ \u533a\u95f4\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5bf9 $l=n\\to 1$ \u626b\u63cf\u7ebf\u5e76\u540c\u65f6\u7ef4\u62a4 $s_r$ \u4e3a $[l:r],[l+1:r],\\dots,[r:r]$ \u6240\u6709\u533a\u95f4\u4ef7\u503c\u4e4b\u548c\uff1b\u5f53\u66f4\u65b0 $l+1\\to l$ \u9700\u8981\u5bf9 $s$ \u7684 $O(\\log n)$ \u4e2a\u533a\u95f4\u52a0\u5bf9\u5e94\u4ef7\u503c\u3002\n\n\u8be2\u95ee\u7b54\u6848\u5bf9\u5e94\u5f53\u65f6\u5019\u7684 $l$ \u7684 $s[l:r]$ \u4e4b\u548c\uff0c\u53ef\u4ee5\u4f7f\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log^2 n+q\\log n)$\u3002\u53ef\u4ee5\u7528 p8283 trick \u505a\u5230 $O((n+q)\\log n)$\u3002",
        "postTime": 1656576979,
        "uid": 220037,
        "name": "w33z8kqrqk8zzzx33",
        "ccfLevel": 7,
        "title": "[THUPC2022 \u51b3\u8d5b] rsraogps"
    }
]
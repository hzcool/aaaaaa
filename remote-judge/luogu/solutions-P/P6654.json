[
    {
        "content": "\u8fd9\u91cc\u63d0\u4f9b\u4e00\u79cd $\\mathbf O(n^4)$ \u7684\u505a\u6cd5\uff0c\u6765\u81ea @[skydogli](https://www.luogu.com.cn/user/7480)\uff0c\u5c31\u662f\u51fa\u9898\u4eba\u8bf4\u7684\u90a3\u4e2a\u3002  \n\n\u6839\u636e\u9898\u610f\uff0c\u8bbe $f_{i,j,k}$ \u8868\u793a\u5c06 $s_{1\\dots i-1}$ \u5f52\u96f6\u4e00\u5171\u505a\u4e86 $j$ \u6b21\u64cd\u4f5c\uff0c\u5176\u4e2d\u7b2c $k$ \u6b21\u64cd\u4f5c\u662f $i-1$ \u5411 $i$ \u8fdb\u4f4d\u7684\u60c5\u51b5\u7684\u65b9\u6848\u6570\u3002\u7279\u522b\u5730\uff0c$k=0$ \u8868\u793a\u6ca1\u6709\u8fdb\u4f4d\u7684\u60c5\u51b5\u3002  \n\n\u5bf9\u4e8e\u6bcf\u4e00\u4f4d\uff0c\u663e\u7136\u6709\u4ee5\u4e0b\u51e0\u79cd\u60c5\u51b5\uff1a  \n1. $s_i=0$\n\t1. \u88ab\u8fdb\u4f4d\uff08$k\\not=0$\uff09\n    \t1. \u88ab\u8fdb\u4f4d\u540e\u64cd\u4f5c\u4e00\u6b21\uff0c\u4e0d\u8fdb\u4f4d  \n        \t$f_{i+1,j+1,0}\\leftarrow(j-k+1)f_{i,j,k}$\n    1. \u6ca1\u88ab\u8fdb\u4f4d\uff08$k=0$\uff09\n    \t1. \u4e0d\u64cd\u4f5c  \n        \t$f_{i+1,j,0}\\leftarrow f_{i,j,k}$\n1. $s_i=1,2,3$\n\t1. \u88ab\u8fdb\u4f4d\uff08$k\\not=0$\uff09\n    \t1. \u88ab\u8fdb\u4f4d\u540e\u64cd\u4f5c\u4e00\u6b21\uff0c\u4e0d\u8fdb\u4f4d  \n        \t$f_{i+1,j+1,0}\\leftarrow(j-k+1)f_{i,j,k}$\n        1. \u88ab\u8fdb\u4f4d\u524d\u64cd\u4f5c\u4e00\u6b21\uff0c\u88ab\u8fdb\u4f4d\u540e\u518d\u64cd\u4f5c\u4e00\u6b21\uff0c\u4e0d\u8fdb\u4f4d  \n        \t$f_{i+1,j+2,0}\\leftarrow k(j-k+1)f_{i,j,k}$\n    1. \u6ca1\u88ab\u8fdb\u4f4d\uff08$k=0$\uff09\n    \t1. \u64cd\u4f5c\u4e00\u6b21\uff0c\u4e0d\u8fdb\u4f4d  \n        \t$f_{i+1,j+1,0}\\leftarrow(j+1)f_{i,j,k}$  \n1. $s_i=4$\n\t1. \u88ab\u8fdb\u4f4d\uff08$k\\not=0$\uff09\n    \t1. \u88ab\u8fdb\u4f4d\u540e\u64cd\u4f5c\u4e00\u6b21\uff0c\u8fdb\u4f4d  \n        \t$\\forall p\\in[k+1,j+1],f_{i+1,j+1,p}\\leftarrow f_{i,j,k}$\n        1. \u88ab\u8fdb\u4f4d\u524d\u64cd\u4f5c\u4e00\u6b21\uff0c\u88ab\u8fdb\u4f4d\u540e\u518d\u64cd\u4f5c\u4e00\u6b21\uff0c\u4e0d\u8fdb\u4f4d  \n        \t$f_{i+1,j+2,0}\\leftarrow k(j-k+1)f_{i,j,k}$\n    1. \u6ca1\u88ab\u8fdb\u4f4d\uff08$k=0$\uff09\n    \t1. \u64cd\u4f5c\u4e00\u6b21\uff0c\u4e0d\u8fdb\u4f4d  \n        \t$f_{i+1,j+1,0}\\leftarrow(j+1)f_{i,j,k}$  \n1. $s_i=5,6,7,8$\n\t1. \u88ab\u8fdb\u4f4d\uff08$k\\not=0$\uff09\n    \t1. \u88ab\u8fdb\u4f4d\u540e\u64cd\u4f5c\u4e00\u6b21\uff0c\u8fdb\u4f4d  \n        \t$\\forall p\\in[k+1,j+1],f_{i+1,j+1,p}\\leftarrow f_{i,j,k}$\n        1. \u88ab\u8fdb\u4f4d\u524d\u64cd\u4f5c\u4e00\u6b21\uff0c\u88ab\u8fdb\u4f4d\u540e\u518d\u64cd\u4f5c\u4e00\u6b21\uff0c\u8fdb\u4f4d  \n        \t$\\forall p\\in[1,k],f_{i+1,j+2,p}\\leftarrow (j-k+1)f_{i,j,k}$\n    1. \u6ca1\u88ab\u8fdb\u4f4d\uff08$k=0$\uff09\n    \t1. \u64cd\u4f5c\u4e00\u6b21\uff0c\u8fdb\u4f4d  \n        \t$\\forall p\\in[1,j+1]f_{i+1,j+1,p}\\leftarrow f_{i,j,k}$\n1. $s_i=9$\n\t1. \u88ab\u8fdb\u4f4d\uff08$k\\not=0$\uff09\n    \t1. \u88ab\u8fdb\u4f4d\u540e\u4e0d\u64cd\u4f5c\uff0c\u8fdb\u4f4d  \n        \t$f_{i+1,j,k}\\leftarrow f_{i,j,k}$\n        1. \u88ab\u8fdb\u4f4d\u524d\u64cd\u4f5c\u4e00\u6b21\uff0c\u88ab\u8fdb\u4f4d\u540e\u518d\u64cd\u4f5c\u4e00\u6b21\uff0c\u8fdb\u4f4d  \n        \t$\\forall p\\in[1,k],f_{i+1,j+2,p}\\leftarrow (j-k+1)f_{i,j,k}$\n    1. \u6ca1\u88ab\u8fdb\u4f4d\uff08$k=0$\uff09\n    \t1. \u64cd\u4f5c\u4e00\u6b21\uff0c\u8fdb\u4f4d  \n        \t$\\forall p\\in[1,j+1]f_{i+1,j+1,p}\\leftarrow f_{i,j,k}$\n\n\u50cf\u8fd9\u6837\uff0c\u5bf9\u6bcf\u4e00\u79cd\u60c5\u51b5\u5206\u522b\u8f6c\u79fb\uff0c\u590d\u6742\u5ea6 $\\mathbf O(n^4)$\uff0c\u76ee\u524d\u662f\u6700\u4f18\u89e3\u3002\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nconst int N=70,p=998244353;\nint n,m,f[N][N<<1][N<<1],ans;\nchar s[N];\ninline void add(int &a,int b){bool f=(a+=b)<p;a-=(f-1)&p;}\nint main()\n{\n\tint i,j,k,l;scanf(\"%s\",s+1);n=strlen(s+1);\n\tstd::reverse(s+1,s+1+n);s[++n]='0';f[1][0][0]=1;\n\tfor(i=1;i<=n;i++,m+=2)\n\tfor(j=0;j<=m;j++)\n\tfor(k=0;k<=j;k++)\n\tif(s[i]=='0')\n\t\tif(k) add(f[i+1][j+1][0],1ll*f[i][j][k]*(j-k+1)%p);\n\t\telse add(f[i+1][j][0],f[i][j][k]);\n\telse if(s[i]>='1'&&s[i]<='3')\n\t\tif(k) add(f[i+1][j+1][0],1ll*f[i][j][k]*(j-k+1)%p),add(f[i+1][j+2][0],1ll*f[i][j][k]*k*(j-k+1)%p);\n\t\telse add(f[i+1][j+1][0],1ll*f[i][j][k]*(j+1)%p);\n\telse if(s[i]=='4')\n\t\tif(k)\n\t\t{\n\t\t\tfor(l=k+1;l<=j+1;l++)add(f[i+1][j+1][l],f[i][j][k]);\n\t\t\tadd(f[i+1][j+2][0],1ll*f[i][j][k]*k*(j-k+1)%p);\n\t\t}\n\t\telse add(f[i+1][j+1][0],1ll*f[i][j][k]*(j+1)%p);\n\telse if(s[i]>='5'&&s[i]<='8')\n\t\tif(k)\n\t\t{\n\t\t\tfor(l=k+1;l<=j+1;l++)add(f[i+1][j+1][l],f[i][j][k]);\n\t\t\tfor(l=1;l<=k;l++)add(f[i+1][j+2][l],1ll*f[i][j][k]*(j-k+1)%p);\n\t\t}\n\t\telse for(l=1;l<=j+1;l++)add(f[i+1][j+1][l],f[i][j][k]);\n\telse\n\t\tif(k)\n\t\t{\n\t\t\tadd(f[i+1][j][k],f[i][j][k]);\n\t\t\tfor(l=1;l<=k;l++)add(f[i+1][j+2][l],1ll*f[i][j][k]*(j-k+1)%p);\n\t\t}\n\t\telse for(l=1;l<=j+1;l++)add(f[i+1][j+1][l],f[i][j][k]);\n\tfor(i=0;i<=m;i++)for(j=0;j<=i;j++)add(ans,f[n+1][i][j]);\n\tprintf(\"%d\\n\",ans);return 0;\n}\n```",
        "postTime": 1624091450,
        "uid": 35137,
        "name": "a___",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P6654 [YsOI2020]\u5f52\u96f6"
    },
    {
        "content": "\u8fd9\u6ce2\u662f\u6807\u7a0b\u88ab\u8e29\uff0c\u5df2\u7ecf\u6ca1\u8138\u89c1\u4eba\u4e86\u3002\u4e07\u4eba\u8840\u4e66 @skydogli \u5199\u4e00\u4efd\u9898\u89e3\u3002\n\n**\u6807\u7b7e\uff1adp**\n\n### \u9898\u610f\u7b80\u8ff0\n\n\u7ed9\u5b9a\u6570\u5b57 $S$\uff0c\u6bcf\u6b21\u9009\u62e9\u4e00\u4f4d\u56db\u820d\u4e94\u5165\uff0c\u95ee\u6570\u5b57\u53d8\u6210 $0$ \u7684\u64cd\u4f5c\u65b9\u6848\u6570\u3002\u7b54\u6848\u53d6\u6a21\u3002\n\n-------\n\n### ${\\rm{subtask\\ 0}}\\ (n\\le6)$\n\n\u6309\u9898\u610f\u6a21\u62df\u7206\u641c / dp\u3002\n\n### ${\\rm{subtask\\ 1}}\\ (n \\le 15)$\n\n\u5bb9\u6613\u53d1\u73b0 $1\\sim3$ \u672c\u8d28\u76f8\u540c\uff0c\u7b80\u5e76\u4e3a $1$\u3002$5\\sim8$ \u672c\u8d28\u76f8\u540c\uff0c\u7b80\u5e76\u4e3a $5$\u3002\u6240\u4ee5\u53ea\u6709\u53ef\u80fd\u51fa\u73b0 $5$ \u79cd\u6570\u5b57\uff1a$0,1,4,5,9$\u3002\uff08\u5947\u5999\u7684\u662f\u5b83\u4eec\u53ef\u4ee5\u7ec4\u6210 114514191910\uff0c\u8fd9\u4e00\u5b9a\u4e0d\u662f\u5de7\u5408\uff01\uff09\n\n\u540c\u65f6\uff0c\u4e00\u4e2a\u6570\u4f4d\u4e0d\u53ef\u80fd $5$ \u79cd\u60c5\u51b5\u90fd\u5b58\u5728\uff0c\u6700\u591a\u4f1a\u6709\u5176\u4e2d\u7684 $4$ \u79cd\u3002\u610f\u601d\u662f\u8bf4\uff0c__\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u81f3\u5c11\u6709\u4e00\u79cd\u6570\u5b57\u4e0d\u53ef\u80fd\u51fa\u73b0\u3002__\n\n\u9884\u5904\u7406\u51fa\u6bcf\u4e2a\u6570\u4f4d\u53ef\u80fd\u88ab\u54ea\u4e9b\u6570\u5b57\u5360\u636e\u3002\u7136\u540e\u72b6\u538b $dp$ \u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6 $O(4^nn)$\uff0c\u611f\u89c9\u5927\u6982\u8dd1\u4e0d\u6ee1(?)\u3002\u5982\u679c\u4e0d\u5e78\u88ab\u5361\u90a3\u6211\u8c22\u7f6a\u3002\n\n### ${\\rm{subtask\\ 2}}\\ (S_i\\in[0,4])$\n\n\u4e0d\u4f1a\u4ea7\u751f\u8fdb\u4f4d\uff0c\u53ea\u9700\u8981\u627e\u5230\u6709\u51e0\u4e2a\u4f4d\u7f6e\u4e0d\u662f $0$\uff0c\u6c42\u4e2a\u9636\u4e58\u3002\n\n### ${\\rm{subtask\\ 3}}\\ (S_i=9)$\n\n\u53d1\u73b0\u3010\u56db\u820d\u4e94\u5165\u3011\u4e00\u4e2a \u2468 \u4e4b\u540e\uff0c\u4f1a\u4f7f\u524d\u9762\u8fde\u7eed\u7684 $9$ \u53d8\u6210 $0$\uff0c\u518d\u5728\u6700\u524d\u9762\u52a0\u4e00\u4e2a $1$\u3002\u8fd9\u4e2a $1$ \u662f\u4e0e\u4e16\u9694\u7edd\u7684\uff0c\u5b83\u4e0d\u4f1a\u4f7f\u522b\u4eba\u8fdb\u4f4d\uff0c\u522b\u4eba\u4e5f\u4e0d\u80fd\u8ba9\u4ed6\u8fdb\u4f4d\u3002\n\n\u5927\u6982\u5f88\u5bb9\u6613\u60f3\u5230 $dp$\u3002\u8bbe $dp_{i,j}$ \u8868\u793a\u4ece\u9ad8\u5230\u4f4e\u8003\u8651\u5230\u7b2c $i$ \u4f4d\uff0c\u4e14\u524d $i-1$ \u4f4d\u5df2\u7ecf\u6ca1\u6709 $9$ \u4e86\uff0c\u4e14\u5269\u4f59 $j$ \u4e2a\u4e0e\u4e16\u9694\u7edd\u7684 $1$ \u7684\u65b9\u6848\u6570\u3002\n\n\u8003\u8651\u7528\u8bb0\u5fc6\u5316\u641c\u7d22\u5b9e\u73b0\u3002\u8f6c\u79fb\u6bcf\u6b21\u627e\u4e00\u4e2a\u540e\u9762\u7684 $9$ \u3010\u56db\u820d\u4e94\u5165\u3011\u6216\u8005\u6d88\u9664\u4e00\u4e2a\u4e0e\u4e16\u9694\u7edd\u7684 $1$ \u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6 $O(n^3)$\uff0c\u524d\u7f00\u548c\u4f18\u5316\u53ef\u4ee5\u505a\u5230 $O(n^2)$\u3002\n\n\u53c2\u8003\u4ee3\u7801\uff1a\n\n```cpp\n// O(n^2)\n#include <bits/stdc++.h>\n\nconst int MX = 56;\nconst int MOD = 998244353;\n\nint dp[MX][MX][2];\nchar str[233];\nint dapai(int x ,int y ,int t){\n\tif(~dp[x][y][t]) return dp[x][y][t];\n\tint ret = (x == 0 && y == 0);\n\tif(y && t) ret = (ret + 1LL * y * dapai(x ,y - 1 ,1)) % MOD;\n\tif(x){\n\t\tif(x != 1) ret = (ret + dapai(x - 1 ,y ,0)) % MOD;\n\t\tret = (ret + dapai(x - 1 ,y + 1 ,1)) % MOD;\n\t}\n\treturn dp[x][y][t] = ret;\n}\n\nint main(){\n\tmemset(dp ,-1 ,sizeof dp);\n\tinit();\n\tscanf(\"%s\" ,str);\n\tint n = strlen(str);\n\tprintf(\"%d\\n\" ,dapai(n ,0 ,0));\n\treturn 0;\n} \n```\n\n### ${\\rm{subtask\\ 4}}\\ (S_i\\in[5,8])$\n\n\u51fa\u9898\u4eba\u5e76\u4e0d\u4f1a\uff0c\u4ed6\u51fa\u8fd9\u4e2a\u90e8\u5206\u5206\u53ea\u662f\u89c9\u5f97\u597d\u50cf\u6709\u4ec0\u4e48\u505a\u6cd5\u3002\n\n\u9a8c\u9898\u4eba\u7ed9\u51fa\u4e86\u4e00\u79cd\u505a\u6cd5\uff1a\n\n\u6709\u4e00\u79cd\u590d\u6742\u5ea6\u4e0e\u5212\u5206\u6570\u65b9\u6848\u76f8\u5173\u7684\u66b4\u529b\uff0c\u8bbe $dp[st][i]$ \u4e3a\u5f53\u524d\u5212\u5206\u533a\u95f4\u72b6\u6001\u4e3a $st$\uff0c\u6709 $i$ \u4e2a\u4e0e\u4e16\u9694\u7edd\u7684 $1$ \u7684\u65b9\u6848\u6570\u3002\n\n\u6bcf\u6b21\u679a\u4e3e\u3010\u56db\u820d\u4e94\u5165\u3011\u54ea\u4e2a\u6216\u8005\u9009\u62e9\u6d88\u53bb\u4e00\u4e2a $1$ \u5373\u53ef\u8f6c\u79fb\uff0c\u603b\u590d\u6742\u5ea6 $O(\\text{\u5212\u5206\u6570}(n)\\times n^2)$\u3002\n\n\u672c\u5730\u8dd1\u51fa\u7ed3\u679c\u540e\u6253\u8868\u5373\u53ef\u3002\n\n### ${\\rm{subtask\\ 5}}\\ (n \\le 40)$\n\n\u51fa\u9898\u4eba\u51fa\u8fd9\u4e2a\u90e8\u5206\u5206\u53ea\u4e3a\u653e\u8fc7\u590d\u6742\u5ea6\u6b63\u786e\u4f46\u5e38\u6570\u5927\u7684\u3002\n\n### ${\\rm{subtask\\ 6}}\\ (n \\le 64)$\n\n\u4e09\u53e5\u8bdd\u9898\u89e3\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/v6lprfn9.png)\n\n\n\u6ce8\u610f\u5230\u4e00\u4e2a\u4e8b\u5b9e\uff1a\u3010\u56db\u820d\u4e94\u5165\u3011\u4e00\u4e2a\u4f4d\u7f6e\u4e4b\u540e\u53ef\u4ee5\u628a\u5de6\u53f3\u4e24\u90e8\u5206\u5206\u6210\u5b50\u95ee\u9898\u3002\n\n\u8bbe $dp_{l,r,c,1/0}$ \u8868\u793a\u9664\u4e86 $[l,r]$ \u4f4d\u5176\u5b83\u6570\u4f4d\u90fd\u53d8\u6210\u4e86 $0$\uff0c\u8fd8\u9700\u3010\u56db\u820d\u4e94\u5165\u3011 $c$ \u6b21\u8fd9\u4e2a\u533a\u95f4\u4e5f\u5168\u90fd\u53d8\u6210 $0$\uff0c\u3010\u56db\u820d\u4e94\u5165\u3011\u7b2c $l-1$ \u4f4d\u7684\u65f6\u5019\u662f\u5426\u5bf9\u7b2c $l$ \u4f4d\u9020\u6210\u8fdb\u4f4d\uff0c\u7684\u65b9\u6848\u6570\u3002\u8fdb\u4f4d\u540e\u7684\u6570\u5b57\u53ef\u4ee5\u76f4\u63a5\u9884\u5904\u7406\u3002\n\n\n\u8f6c\u79fb\u53ea\u9700\u8981\u679a\u4e3e\u5f53\u524d\u3010\u56db\u820d\u4e94\u5165\u3011\u54ea\u4e00\u4f4d $mid$\uff0c\u4ee5\u53ca\u533a\u95f4 $[l,mid-1],[mid+1,r]$ \u5982\u4f55\u5206\u914d\u5269\u4f59\u7684 $c-1$ \u6b21\u3010\u56db\u820d\u4e94\u5165\u3011\u5373\u53ef\u3002\n\u6ce8\u610f\u6709\u7684\u65f6\u5019\u3010\u56db\u820d\u4e94\u5165\u3011\u8fdb\u4f4d\u4f1a\u5bfc\u81f4\u53f3\u7aef\u70b9 $+1$\uff0c\u76f4\u63a5\u7279\u5224\u6389\u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6 $O(n^5) = 1,073,741,824$\uff0c\u526a\u526a\u679d/\u5361\u5361\u5e38\u5373\u53ef\u901a\u8fc7\u3002\n\n\u526a\u679d\u65b9\u6cd5\uff1a\u9884\u5904\u7406\u6bcf\u4e2a\u533a\u95f4\u6700\u591a\u548c\u6700\u5c11\u3010\u56db\u820d\u4e94\u5165\u3011\u6b21\u6570\u3002\u4e0d\u6ee1\u8db3\u7684\u533a\u95f4\u5219\u4e0d\u9012\u5f52\u3002\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <iostream>\n\nconst int MX = 64 + 3;\nconst int MOD = 998244353;\n\nint dp[MX][MX][MX * 2][2] ,n;\nint C[MX * 2][MX * 2];\nchar str[MX][MX];\nint maxmv[MX][MX][MX] ,minmv[MX][MX][MX];\n\nvoid init(){\n\tfor(int i = 0 ; i < MX * 2 ; ++i) C[i][0] = 1;\n\tfor(int i = 1 ; i < MX * 2 ; ++i)\n\t\tfor(int j = 1 ; j < MX * 2 ; ++j)\n\t\t\tC[i][j] = (C[i - 1][j - 1] + C[i - 1][j]) % MOD;\n}\n\nint calc(int n ,int m){\n\treturn C[n + m][m];\n}\n\nint dapai(int l ,int r ,int c ,int jw){\n\tif(c < 0) return 0;\n\tif(l > r) return !c;\n\tint ind = (!jw) * n + jw * l;\n\tif(~dp[l][r][c][jw]) return dp[l][r][c][jw];\n\n\tif(c == 0) return !maxmv[ind][l][r];\n\t\n\tint cur = 0;\n\tint book[MX] = {0};\n\tint ok = 1;\n\tfor(int k = r ; k >= l && ok ; --k){\n\t\tbook[k] = ok && str[ind][k] >= 5;\n\t\tok = ok && str[ind][k] == 9;\n\t}\n\tfor(int k = l ; k <= r ; ++k){\n\t\tif(str[ind][k] == 0) continue;\n\t\tif(book[k] || (k == r && str[ind][k] >= 5)){\n\t\t\tcur = (cur + 1LL * dapai(l ,k - 1 ,c - 2 ,jw) * calc(c - 2 ,1)) % MOD;\n\t\t\tcontinue;\n\t\t}\n\t\tint tind = ((str[ind][k] < 5) * n + (str[ind][k] >= 5) * (k + 1));\n\t\tfor(int s = minmv[ind][l][k - 1] ; s <= c - 1 ; ++s){\n\t\t\tif(s > maxmv[ind][l][k - 1]\n\t\t\t|| (c - 1 - s) > maxmv[tind][k + 1][r]\n\t\t\t|| (c - 1 - s) < minmv[tind][k + 1][r]) continue;\n\t\t\tcur = (cur + 1LL\n\t\t\t\t* dapai(l ,k - 1 ,s ,jw) \n\t\t\t\t* dapai(k + 1 ,r ,c - s - 1 ,str[ind][k] >= 5) % MOD\n\t\t\t\t* calc(s ,c - s - 1)) % MOD;\n\t\t}\n\t}\n\treturn dp[l][r][c][jw] = cur;\n}\n\nint main(){\n\tmemset(dp ,-1 ,sizeof dp);\n\tinit();\n\tstd::cin >> str[0];\n\tn = strlen(str[0]);\n\tstd::reverse(str[0] ,str[0] + n);\n\tstr[0][n] = '0' ,n = n + 1;\n\tfor(int i = 0 ; i < n ; ++i) str[0][i] -= '0';\n\tmemcpy(str[n] ,str[0] ,sizeof str[0]);\n\n\tfor(int i = 0 ; i < n ; ++i){ // \u00c4\u00a3\u00c4\u00e2\u00bd\u00ab\u00b4\u00cb\u00ce\u00bb\u00bd\u00f8\u00ce\u00bb\n\t\tmemcpy(str[i] ,str[n] ,sizeof str[i]);\n\t\tstr[i][i]++;\n\t\tfor(int j = i ; j < n ; ++j){\n\t\t\tstr[i][j + 1] += str[i][j] / 10;\n\t\t\tstr[i][j] %= 10;\n\t\t}\n\t}\n\t\n\tfor(int i = 0 ; i <= n ; ++i){\n\t\tfor(int l = 0 ; l < n ; ++l){\n\t\t\tfor(int r = l ; r < n ; ++r){\n\t\t\t\tfor(int s = r ; s >= l ; --s){\n\t\t\t\t\tmaxmv[i][l][r] += (str[i][s] != 0);\n\t\t\t\t\tmaxmv[i][l][r] += (str[i][s] >= 5);\n\t\t\t\t}\n\t\t\t\tint ret = 0;\n\t\t\t\tfor(int s = l ; s <= r ; ++s){\n\t\t\t\t\tret += str[i][s];\n\t\t\t\t\tif(ret % 10) minmv[i][l][r]++;\n\t\t\t\t\tif(ret >= 5) ret = 1;\n\t\t\t\t\telse ret = 0;\n\t\t\t\t}\n\t\t\t\tif(ret % 10) minmv[i][l][r]++;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tint Ans = 0;\n\tfor(int i = minmv[n][0][n - 1] ; i <= maxmv[n][0][n - 1] ; ++i){\n\t\tint ret = dapai(0 ,n - 1 ,i ,0);\n\t\tAns = (Ans + ret) % MOD;\n\t}\n\tprintf(\"%d\\n\" ,Ans);\n\treturn 0;\n}\n\n```",
        "postTime": 1593072822,
        "uid": 47863,
        "name": "Imakf",
        "ccfLevel": 0,
        "title": "[YsOI2020]\u5f52\u96f6"
    }
]
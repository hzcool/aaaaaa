[
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5796)\n\n\u8fd9\u79cd\u5339\u914d\u7684\u95ee\u9898\u4e00\u770b\u5c31\u77e5\u9053\u662f\u7f51\u7edc\u6d41\u4e86\u5427qwq\n\n\u56e0\u4e3a$n$\u975e\u5e38\u5c0f\u3002\u3002\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u679a\u4e3e\u6240\u6709\u76ee\u6807\u72b6\u6001\n\n\u7136\u540e\u4ece\u6e90\u70b9$S$\u5411\u6bcf\u4e00\u4e2a\u521d\u59cb\u8282\u70b9\u8fde\u8fb9\u6743\u4e3a$1$\uff0c\u8d39\u7528\u4e3a$0$\u7684\u8fb9\n\n\u4ece\u6bcf\u4e2a\u76ee\u6807\u8282\u70b9\u5411\u6c47\u70b9$T$\u8fde\u4e00\u6761\u8fb9\u6743\u4e3a$1$\uff0c\u8d39\u7528\u4e3a$0$\u7684\u8fb9\n\n\u5bf9\u4e8e\u6bcf\u5bf9$(i,j)$\uff08$i$\u4e3a\u7b2c$i$\u4e2a\u521d\u59cb\u8282\u70b9\uff0c$j$\u4e3a\u7b2c$j$\u4e2a\u76ee\u6807\u8282\u70b9\uff09\n\n\u8fde\u4e00\u6761\u8fb9\u6743\u4e3a$1$\uff0c\u8d39\u7528\u4e3a\u6700\u77ed\u8def\u957f\u5ea6\u7684\u8fb9\n\n\u6700\u540e\u8dd1\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\u5c31\u53ef\u4ee5\u4e86qwq\n\n\u9644\u4e0a\u4ee3\u7801:\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <cmath>\n#include <iostream>\n#include <algorithm>\n#include <queue>\n#define INF 1000000000\n#define M 10005\n#define N 55\nusing namespace std;\nint nxt[M],head[M],to[M],adj[M],cost[M],X[M],Y[M],XX[M],YY[M],nowX[M],nowY[M],dist[M],cur[M],F[N][N][N];\nint mincost,tot,n,m,S,T,Ans=INF;\nbool inq[M],vis[M],G[N][N];\nint dx[10]={0,1,-1,0,0};\nint dy[10]={0,0,0,1,-1};\nint read(){//\u6ca1\u4ec0\u4e48\u7528\u7684\u5feb\u901f\u8bfb\u5165\n\tint ans=0;char c=getchar();\n\twhile (c<'0'||c>'9') c=getchar();\n\twhile (c>='0'&&c<='9') ans=ans*10+c-'0',c=getchar();\n\treturn ans;\n}\nvoid Write(int x){//\u6ca1\u4ec0\u4e48\u7528\u7684\u5feb\u901f\u8f93\u51fa\n\tif (x<0) putchar('-'),x=-x;\n\tif (x<10) putchar(x^48);\n\telse Write(x/10),putchar((x%10)^48);\n\treturn;\n}\nvoid add(int u,int v,int w,int Cost){\n\tnxt[tot]=head[u];head[u]=tot;to[tot]=v;adj[tot]=w;cost[tot]=Cost;tot++;\n\tnxt[tot]=head[v];head[v]=tot;to[tot]=u;adj[tot]=0;cost[tot]=-Cost;tot++;\n\treturn;\n}\nbool SPFA(){\n\tfor (register int i=S;i<=T;i++) dist[i]=INF,inq[i]=0;\n\tqueue <int> Q;Q.push(T);inq[T]=1;dist[T]=0;\n\twhile (!Q.empty()){\n\t\tint now=Q.front();Q.pop();inq[now]=0;\n\t\tfor (register int i=head[now];~i;i=nxt[i])\n\t\t\tif (adj[i^1]>0&&dist[to[i]]>dist[now]-cost[i]){\n\t\t\t\tdist[to[i]]=dist[now]-cost[i];\n\t\t\t\tif (!inq[to[i]]) inq[to[i]]=1,Q.push(to[i]);\n\t\t\t}\n\t}\n\treturn dist[S]<INF;\n}\nint dfs(int x,int low){\n\tvis[x]=1;if (x==T) return low;int used=0,a;\n\tfor (register int &i=cur[x];~i;i=nxt[i])\n\t\tif (!vis[to[i]]&&adj[i]>0&&dist[to[i]]==dist[x]-cost[i]){\n\t\t\ta=dfs(to[i],min(low-used,adj[i]));\n\t\t\tif (a) adj[i]-=a,adj[i^1]+=a,mincost+=a*cost[i],used+=a;\n\t\t\tif (used==low) break;\n\t\t}\n\treturn used;\n}\nint costflow(){\n\tint ans=0,a;\n\twhile (SPFA()){\n\t\tvis[T]=1;\n\t\twhile (vis[T]){\n\t\t\tfor (register int i=S;i<=T;i++) cur[i]=head[i],vis[i]=0;\n\t\t\twhile (a=dfs(S,INF)) ans+=a;\n\t\t}\n\t}\n\treturn mincost;\n}\nint work(){\n\tmemset(head,-1,sizeof(head));mincost=tot=0;//\u8bb0\u5f97\u521d\u59cb\u5316\n\tfor (register int i=1;i<=n;i++)\n\t\tif (G[nowX[i]][nowY[i]]) return INF;//\u5224\u65ad\u76ee\u6807\u72b6\u6001\u662f\u5426\u5408\u6cd5\n\tfor (register int i=1;i<=n;i++){\n\t\tadd(S,i+1,1,0),add(i+n+1,T,1,0);\n\t\tfor (register int j=1;j<=n;j++) add(i+1,j+n+1,1,F[i][nowX[j]][nowY[j]]);\n\t}\n\treturn costflow();\n}\nvoid BFS(int x){//BFS\u627e\u6700\u77ed\u8def\n\tqueue <pair<int,int> > Q;\n\tfor (register int i=1;i<=n;i++)\n\t\tfor (register int j=1;j<=n;j++) F[x][i][j]=INF;\n\tF[x][X[x]][Y[x]]=0;Q.push(make_pair(X[x],Y[x]));\n\twhile (!Q.empty()){\n\t\tpair <int,int> now=Q.front();Q.pop();\n\t\tfor (register int i=1;i<=4;i++){\n\t\t\tint xx=now.first+dx[i],yy=now.second+dy[i];\n\t\t\tif (xx<1||xx>n||yy<1||yy>n||F[x][xx][yy]<INF||G[xx][yy]) continue;\n\t\t\tF[x][xx][yy]=F[x][now.first][now.second]+1;\n\t\t\tQ.push(make_pair(xx,yy));\n\t\t}\n\t}\n\treturn;\n}\nint main(){\n\tn=read(),m=read();S=1,T=n+n+2;\n\tfor (register int i=1;i<=n;i++) X[i]=read(),Y[i]=read();\n\tfor (register int i=1,x,y;i<=m;i++) x=read(),y=read(),G[x][y]=1;\n\tfor (register int i=1;i<=n;i++) BFS(i);\n\tfor (register int i=1;i<=n;i++){\n\t\tfor (register int j=1;j<=n;j++) nowX[j]=i,nowY[j]=j;\n\t\tAns=min(Ans,work());\n\t\tfor (register int j=1;j<=n;j++) nowX[j]=j,nowY[j]=i;\n\t\tAns=min(Ans,work());\n\t}\n\tfor (register int i=1;i<=n;i++) nowX[i]=nowY[i]=i;\n\tAns=min(Ans,work());\n\tfor (register int i=1;i<=n;i++) nowX[i]=i,nowY[i]=n+1-i;\n\tAns=min(Ans,work());\n\tWrite(Ans==INF?-1:Ans);//\u4e0d\u8981\u5fd8\u4e86\u8f93\u51fa-1\n\treturn 0;\n}\n```\n\n\u867d\u7136\u4ee3\u7801\u957f\u4f46\u4e0d\u96be\u5199qwq\n\n~~\u8bb0\u5f97\u70b9\u8d5e\u554a~~",
        "postTime": 1578580639,
        "uid": 40985,
        "name": "Binary_Search_Tree",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5796 \u3010[CQOI2006]\u79fb\u52a8\u68cb\u5b50\u3011"
    },
    {
        "content": "## \u524d\u8a00\n\n\u4e3a\u6d1b\u8c37\u793e\u533a\u505a\u51fa\u8d21\u732e\uff01\n\n## \u89e3\u6cd5\n\n\u9996\u5148\u4e00\u770b\u8fd9\u6570\u636e\u8303\u56f4\uff0c\u611f\u89c9\u66b4\u529b\u80fd\u8fc7\uff0c\u518d\u770b $ n\\leq 50$\uff0c\u4e00\u4e0b\u4fbf\u53ef\u4ee5\u60f3\u5230\u7f51\u7edc\u6d41\u3002\n\n\u679a\u4e3e\u6bcf\u4e00\u79cd\u6700\u7ec8\u60c5\u51b5\uff0c\u518d\u5c06\u6bcf\u4e00\u4e2a\u68cb\u5b50\u7684\u539f\u59cb\u4f4d\u7f6e\u548c\u6bcf\u4e00\u4e2a\u7ec8\u70b9\u4e4b\u95f4\u90fd\u8fde\u4e00\u6761\u6d41\u91cf\u4e3a $1$\uff0c\u8d39\u7528\u4e3a\u5b83\u4eec\u4e4b\u95f4\u7684\u6700\u77ed\u8ddd\u79bb\u7684\u8fb9\uff0c\u7136\u540e\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\u4e00\u904d\u5e26\u8d70\u3002\n\n\u5bf9\u4e8e\u6c42\u6700\u77ed\u8ddd\u79bb\uff0c\u6211\u4eec\u76f4\u63a5\u5e7f\u641c\u4e00\u6ce2\u3002\n\n\u53e6\u5916\uff0c\u5bf9\u4e8e\u68cb\u5b50\u6321\u9053\u7684\u95ee\u9898\uff0c\u56e0\u4e3a\u4efb\u610f\u4e24\u4e2a\u68cb\u5b50\u662f\u7b49\u4ef7\u7684\uff0c\u53ef\u4ee5\u6362\u4f4d\u7f6e\uff0c\u6240\u4ee5\u5e76\u4e0d\u4f1a\u5bf9\u4e8e\u8ddd\u79bb\u5e26\u6765\u5f71\u54cd\u3002\n\n## AC Code\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define INF 0x3f3f3f3f\n#define inf 0x7f7f7f7f\nint n,m,s,t,N;\nconst int maxn=2e6+10;\ninline int read()\n{\n    int x=0,f=1;char ch=getchar();\n    while(!isdigit(ch)) {if(ch=='-')f=-1;ch=getchar();}\n    while(isdigit(ch))  {x=x*10+ch-48;ch=getchar();}\n    return x*f;\n}\nint to[maxn],cap[maxn],cost[maxn],head[maxn],nt[maxn],cnt;\nint dis[maxn],incf[maxn],vis[maxn],pre[maxn],mincost,maxflow;\ninline void addedge(int u,int v,int w,int c)\n{\n    to[++cnt]=v,cap[cnt]=w,cost[cnt]=c,nt[cnt]=head[u],head[u]=cnt;\n    to[++cnt]=u,cap[cnt]=0,cost[cnt]=-c,nt[cnt]=head[v],head[v]=cnt;\n}\ninline void init() \n{\n\tmemset(head,0,sizeof(head));cnt=1,mincost=maxflow=0;\n    for(int i=1;i<=n;++i)   addedge(s,i,1,0),addedge(i+n,t,1,0);\n}\ninline int spfa()\n{\n    queue <int> que;\n    for(int i=0;i<=N;++i)   vis[i]=0,dis[i]=INF;\n    incf[s]=INF,dis[s]=0,vis[s]=1;que.push(s);\n    while(!que.empty())\n    {\n        int u=que.front(),v;\n        que.pop();vis[u]=0;\n        for(int i=head[u];i;i=nt[i])\n        {\n            v=to[i];\n            if(dis[v]<=dis[u]+cost[i]||!cap[i])  continue;\n            dis[v]=dis[u]+cost[i],incf[v]=min(incf[u],cap[i]),pre[v]=i;\n            if(!vis[v]) vis[v]=1,que.push(v);\n        }\n    }\n    return dis[t]!=INF;\n}\ninline void mcmf()\n{\n    while(spfa())\n    {\n        int x=t,i;\n        maxflow+=incf[t];\n        mincost+=incf[t]*dis[t];\n        while(x!=s)\n        {\n            i=pre[x];\n            cap[i]-=incf[t],cap[i^1]+=incf[t];\n            x=to[i^1];\n        }\n    }\n}\nint G[200][200],d[200][200][200];\nstruct point{\n    int x,y;\n}p[maxn];\nint tx[5]={1,0,-1,0},ty[5]={0,1,0,-1};\ninline void bfs(int S)\n{\n    queue <point> que;\n    que.push(p[S]),d[p[S].x][p[S].y][S]=0;\n    while(!que.empty())\n    {\n        int x=que.front().x,y=que.front().y,xx,yy;\n        que.pop();\n        for(int i=0;i<4;++i)\n        {\n            xx=x+tx[i],yy=y+ty[i];\n            if(xx<1||xx>n||yy<1||yy>n||G[xx][yy]==1||d[xx][yy][S]<INF)    continue;\n            d[xx][yy][S]=d[x][y][S]+1;\n            que.push({xx,yy});\n        }\n    }\n}\nint ans=INF;\nint Shu[maxn],Hen[maxn],X1,X2;\nsigned main(){\n    n=read(),m=read(),N=t=2*n+1,s=0;\n    for(int i=1;i<=n;++i)   p[i].x=read(),p[i].y=read();\n    for(int i=1,a,b;i<=m;++i)  \n\t{\n\t\ta=read(),b=read(),G[a][b]=1,Hen[a]=1,Shu[b]=1;\n\t\tif(a==b)\tX1=1;\n\t\tif(a==n-b+1)\tX2=1;\n\t}\n    memset(d,INF,sizeof(d));\n    for(int i=1;i<=n;++i)   bfs(i);\n    if(!X1)\n    {\n\t    init();\n\t    for(int i=1;i<=n;++i)\n\t    \tfor(int j=1;j<=n;++j)\taddedge(i,j+n,1,d[j][j][i]);\n\t    mcmf();\n\t    ans=min(ans,mincost);\n\t}\n\tif(!X2)\n\t{\n\t    init();\n\t    for(int i=1;i<=n;++i)\n\t    \tfor(int j=1;j<=n;++j)\taddedge(i,j+n,1,d[j][n-j+1][i]);\n\t    mcmf();\n\t    ans=min(ans,mincost);\n\t}\n    for(int k=1;k<=n;++k)\n    {\n    \tif(!Shu[k])\n    \t{\n\t    \tinit();\n\t\t    for(int i=1;i<=n;++i)\n\t\t    \tfor(int j=1;j<=n;++j)\taddedge(i,j+n,1,d[j][k][i]);\n\t\t    mcmf();\n\t\t    ans=min(ans,mincost);\n\t\t}\n\t\tif(!Hen[k])\n\t\t{\n\t    \tinit();\n\t\t    for(int i=1;i<=n;++i)\n\t\t    \tfor(int j=1;j<=n;++j)\taddedge(i,j+n,1,d[k][j][i]);\n\t\t    mcmf();\n\t\t    ans=min(ans,mincost);\n\t\t}\n\t}\n    printf(\"%d\\n\",ans<INF?ans:-1);\n    return 0;\n}\n/*\n\u8fd9\u91cc\u63d0\u4f9b\u4e00\u7ec4\u8f83\u5f3a\u7684\u6837\u4f8b\n5 2\n1 2\n2 4\n3 4\n5 1\n5 3\n5 2\n4 3\n\n\n9\n\n*/\n\n\n```\n\n\u6700\u540e\uff0c\u8bf4\u53e5\u95f2\u8bdd\uff0c\u8fd9\u9053\u9898\u6709\u7740\u6d53\u6d53\u7684\u8fdc\u53e4\u9898\u76ee\u98ce\u683c\u2014\u2014\u6570\u636e\u8303\u56f4\u8d85\u5c0f\uff0c\u60c5\u51b5\u53c8\u8d3c\u591a\uff0c\u6211\u6700\u5f00\u59cb\u6ca1\u6709\u770b\u5230\u6700\u7ec8\u60c5\u51b5\u6709 $2n+2$ \u79cd\uff0c\u6536\u8d27\u4e86\u9038\u4e00\u65f6\u8bef\u4e00\u4e16\u4e2a Wa\u3002",
        "postTime": 1644404174,
        "uid": 187081,
        "name": "jockbutt",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5796 \u3010[CQOI2006]\u79fb\u52a8\u68cb\u5b50\u3011"
    }
]
[
    {
        "content": "[\u524d\u7f6e\u829d\u58eb](https://www.luogu.com.cn/paste/2jowtv8m)\u7684\u5149\u901f\u5e42\u6280\u5de7\u3002\n\n\u672c\u9898\u89e3\u4e0d\u662f\u6b63\u89e3\uff0c\u548c\u6b63\u89e3\u552f\u4e00\u7684\u5dee\u522b\u5728\u4e8e\u5bf9\u5e42\u7684\u5904\u7406\u3002\n\n\u6211\u4eec\u80fd\u591f\u53d1\u73b0\u6709\uff1a\n$$ F(n,m,k)=\\frac 1 n \\binom {n+m-1} m $$\n\u8bc1\u660e\u89c1[\u8fd9\u91cc](https://www.luogu.com.cn/paste/mvhuutmb)\u3002\n\n\u7136\u540e\u6211\u4eec\u5f00\u59cb\u63a8\u67ff\u5b50\uff1a\n$$ \\prod_{i=1}^n\\prod_{j=1}^m\\prod_{x=0}^k(\\frac 1 i \\binom {i+j-1} j )^{[\\gcd(i,j)=1]} $$\n$$ (\\prod_{i=1}^n\\prod_{j=1}^m(\\frac {(i+j-1)!} {i!j!})^{[\\gcd(i,j)=1]})^{k+1} $$\n\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u628a\u7b54\u6848\u62c6\u6210\u4e24\u90e8\u5206\uff1a\n$$ \\prod_{i=1}^n\\prod_{j=1}^m((i+j-1)!)^{[\\gcd(i,j)=1]} $$\n$$ \\prod_{i=1}^n\\prod_{j=1}^m(i!j!)^{[\\gcd(i,j)=1]} $$\n\n## 1\n\n$$ \\prod_{i=1}^n\\prod_{j=1}^m((i+j-1)!)^{\\sum_{d|i,d|j}\\mu(d)} $$\n$$ \\prod_{d=1}^n\\prod_{i=1}^{\\lfloor \\frac n d \\rfloor}\\prod_{j=1}^{\\lfloor \\frac m d \\rfloor} (di+dj-1)!^{\\mu(d)} $$\n$$ \\prod_{d=1}^n\\prod_{i=1}^{\\lfloor \\frac n d \\rfloor}\\prod_{j=1}^{\\lfloor \\frac m d \\rfloor} \\frac {(d(i+j))!^{\\mu(d)}} {(d(i+j))^{\\mu(d)}} $$\n\n## 1.1\n\n$$ \\prod_{d=1}^n\\prod_{i=1}^{\\lfloor \\frac n d \\rfloor}\\prod_{j=1}^{\\lfloor \\frac m d \\rfloor} {(d(i+j))!^{\\mu(d)}} $$\n\u771f\u6b63\u7684\u6bd2\u7624\u3002\n$$ \\prod_{d=1}^n\\prod_{k=1}^{{\\lfloor \\frac n d \\rfloor}+{\\lfloor \\frac m d \\rfloor}}(dk)!^{num_{{\\lfloor \\frac n d \\rfloor},{\\lfloor \\frac m d \\rfloor}}[k]\\mu(d)} $$\n$$ \\prod_{d=1}^n\\prod_{k=1}^{\\lfloor \\frac n d \\rfloor}(dk)!^{(k-1)\\mu(d)} \\times\\prod_{k={\\lfloor \\frac n d \\rfloor}+1}^{{\\lfloor \\frac m d \\rfloor}} (dk)!^{{\\lfloor \\frac n d \\rfloor}\\mu(d)} \\times \\prod_{k={\\lfloor \\frac m d \\rfloor}+1}^{{\\lfloor \\frac n d \\rfloor}+{\\lfloor \\frac m d \\rfloor}} (dk)!^{({\\lfloor \\frac n d \\rfloor}+{\\lfloor \\frac m d \\rfloor}-k+1)\\mu(d)} $$\n\n## 1.1.1\n\n$$ \\prod_{d=1}^n\\prod_{k=1}^{\\lfloor \\frac n d \\rfloor} (dk)!^{(k-1)\\mu(d)} $$\n$$ \\prod_{d=1}^nd!^{\\sum_{k|d} k \\mu(\\frac d k)} \\div \\prod_{d=1}^n d!^{\\sum_{k|d}\\mu(\\frac d k)} $$\n$$ \\prod_{d=1}^nd!^{\\varphi(d)} $$\n\n\u6709\u8da3\u7684\u4e00\u70b9\u662f\uff0c\u8fd9\u73a9\u610f\u513f\u548c $ \\prod_{d=1}^n\\prod_{k=1}^{\\lfloor \\frac n d \\rfloor} (dk)!^{k\\mu(d)} $ \u662f\u4e00\u4e2a\u4e1c\u897f\u3002\u4ee5\u53ca\u8fd9\u73a9\u610f\u513f\u548c\u540e\u9762\u7684 $ 1.1.3.1 $ \u662f\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u4e0d\u7528\u63a8\u3002\u3002\u3002\n\n## 1.1.2\n\n$$ \\prod_{d=1}^n\\prod_{k={\\lfloor \\frac n d \\rfloor}+1}^{\\lfloor \\frac m d \\rfloor} (dk)^{{\\lfloor \\frac n d \\rfloor}\\mu(d)} $$\n$$ \\prod_{d=1}^n\\prod_{k=1}^{\\lfloor \\frac m d \\rfloor} (dk)^{{\\lfloor \\frac n d \\rfloor}\\mu(d)} \\div \\prod_{k=1}^{\\lfloor \\frac n d \\rfloor} (dk)!^{{\\lfloor \\frac n d \\rfloor}\\mu(d)} $$\n\u53f3\u8fb9\uff1a\n$$ \\prod_{d=1}^n\\prod_{k=1}^{\\lfloor \\frac n d \\rfloor} (dk)!^{\\mu(d){\\lfloor \\frac n d \\rfloor}} $$\n$$ \\prod_{d=1}^n(\\prod_{k=1}^{\\lfloor \\frac n d \\rfloor} (dk)!^{\\mu(d)})^{\\lfloor \\frac n d \\rfloor} $$\n\u8bbe\uff1a\n$$ f_1(d,n)=\\prod_{k=1}^n(dk)!^{\\mu(d)} $$\n\u53ef\u4ee5\u53d1\u73b0\uff1a\n$$ f_1(d,n)=f_1(d,n-1) \\times (dn)!^{\\mu(d)} $$\n$ (dn)!^{mu(d)} $ \u7528\u5149\u901f\u5e42\u641e\u5b9a\uff0c\uff08\u8fd9\u91cc\u7684 $ dn $ \u4e00\u5b9a\u4e0d\u5927\u4e8e\u6570\u636e\u8303\u56f4\uff09\u5c31\u53ef\u4ee5 $ O(n \\log n) $ \u9012\u63a8 $ f_1 $ \u4e86\u3002\n\n\u8fd9\u4e00\u90e8\u5206\u6700\u7ec8\u80fd\u591f\u63a8\u5f97\uff1a\n$$ \\prod_{d=1}^n f_1(d,{\\lfloor \\frac n d \\rfloor})^{\\lfloor \\frac n d \\rfloor} $$\n\u5bf9 $ f_1 $ \u5728\u7b2c\u4e8c\u7ef4\u5ea6\u4e0a\u505a\u524d\u7f00\u79ef\u5373\u53ef\u6574\u9664\u5206\u5757\u5e26\u8d70\u3002\n\n\u5de6\u8fb9\u7684\u548c\u53f3\u8fb9\u7684\u662f\u4e00\u6837\u7684\uff0c\u5c31\u4e0d\u518d\u8bba\u8ff0\u4e86\u3002\n\n## 1.1.3\n\n$$ \\prod_{d=1}^n\\prod_{k={\\lfloor \\frac m d \\rfloor}+1}^{{\\lfloor \\frac n d \\rfloor}+{\\lfloor \\frac m d \\rfloor}} (dk)!^{({\\lfloor \\frac n d \\rfloor}+{\\lfloor \\frac m d \\rfloor}-k+1)\\mu(d)} $$\n\u5b83 \u662f \u6bd2 \u7624\n\n\u9996\u5148\u62c6\u4e00\u4e0b\uff1a\n$$ \\prod_{d=1}^n((\\prod_{k=1}^{{\\lfloor \\frac n d \\rfloor}+{\\lfloor \\frac m d \\rfloor}} (dk)!^{({\\lfloor \\frac n d \\rfloor}+{\\lfloor \\frac m d \\rfloor})\\mu(d)} \\div \\prod_{k=1}^{\\lfloor \\frac m d \\rfloor} (dk)!^{({\\lfloor \\frac n d \\rfloor}+{\\lfloor \\frac m d \\rfloor})\\mu(d)}) $$\n\n$$  \\div (\\prod_{k=1}^{{\\lfloor \\frac n d \\rfloor}+{\\lfloor \\frac m d \\rfloor}} (dk)!^{k\\mu(d)} \\div \\prod_{k=1}^{\\lfloor \\frac m d \\rfloor} (dk)!^{k\\mu(d)}) $$\n\n$$ \\times (\\prod_{k=1}^{{\\lfloor \\frac n d \\rfloor}+{\\lfloor \\frac m d \\rfloor}} (dk)!^{\\mu(d)} \\div \\prod_{k=1}^{\\lfloor \\frac m d \\rfloor} (dk)!^{\\mu(d)})) $$\n\u540e\u9762\u56db\u4e2a\u597d\u50cf\u5bb9\u6613\u4e00\u4e9b\uff0c\u5148\u641e\u540e\u9762\u56db\u4e2a\u3002\n\n## 1.1.3.1\n\n$$ \\prod_{d=1}^n\\prod_{k=1}^{\\lfloor \\frac m d \\rfloor}(dk)!^{k\\mu(d)} $$\n\u8bbe\uff1a\n$$ f_2(d,n)=\\prod_{k=1}^n(dk)!^{k\\mu(d)} $$\n\u660e\u663e\u6709\uff1a\n$$ f_2(d,n)=f_2(d,n-1) \\times (dn)!^{n\\mu(d)} $$\n\u548c $ f_1 $ \u4e00\u6837\u5373\u53ef\u4ee5 $ O(n\\log n) $ \u5904\u7406\u8fd9\u73a9\u610f\u513f\u3002\n\n## 1.1.3.2\n\n$$ \\prod_{d=1}^n\\prod_{k=1}^{\\lfloor \\frac m d \\rfloor} (dk)!^{\\mu(d)} $$\n\u4f60\u53d1\u73b0\u8fd9\u73a9\u610f\u513f\u5c31\u662f $ f_1 $\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u8349\u4e86\u3002\n\n## 1.1.3.3\n\n$$ \\prod_{d=1}^n\\prod_{k=1}^{\\lfloor \\frac m d \\rfloor} (dk)!^{({\\lfloor \\frac n d \\rfloor}+{\\lfloor \\frac m d \\rfloor})\\mu(d)} $$\n\n\u8fd9\u73a9\u610f\u513f\u597d\u50cf\u5c31\u53ea\u662f $ f_1 $ \u52a0\u4e0a\u4e86\u4e00\u4e2a\u5e42\uff1f\u7528\u4e00\u4e2a\u5149\u901f\u5e42\u5c31\u53ef\u4ee5\u5e26\u8d70\u4e86\u3002\n\n## 1.2\n\n$$ \\prod_{d=1}^n\\prod_{i=1}^{\\lfloor \\frac n d \\rfloor}\\prod_{j=1}^{\\lfloor \\frac m d \\rfloor} {(d(i+j))^{\\mu(d)}} $$\n\n\u8fd9\u4e00\u90e8\u5206\u51e0\u4e4e\u548c $ 1.1 $ \u662f\u76f8\u540c\u7684\uff0c\u6240\u4ee5\u4e0d\u518d\u8bba\u8ff0\uff0c\u5c06 $ (dk)! $ \u6362\u6210 $ (dk) $ \u5373\u53ef\u3002\n\n## 2\n\n$$ \\prod_{i=1}^n\\prod_{j=1}^m(i!j!)^{\\sum_{d|i,d|j} \\mu(d)} $$\n\u5176\u5b9e\u8fd9\u4e00\u90e8\u5206\u660e\u663e\u6bd4\u524d\u9762\u7b80\u5355\u5f97\u591a\uff0c\u4ee5\u81f3\u4e8e\u6211\u524d\u9762\u521a\u5199\u5b8c\u5c31\u4ee5\u4e3a\u6574\u4e2a\u9898\u89e3\u5199\u5b8c\u4e86\uff08\n$$ \\prod_{d=1}^n\\prod_{i=1}^{\\lfloor \\frac n d \\rfloor}\\prod_{i=1}^{\\lfloor \\frac m d \\rfloor}(di)!^{\\mu(d)}(dj)!^{\\mu(d)} $$\n$$ \\prod_{d=1}^n(\\prod_{i=1}^{\\lfloor \\frac n d \\rfloor}(di)!^{\\mu(d){\\lfloor \\frac m d \\rfloor}} \\times \\prod_{i=1}^{\\lfloor \\frac m d \\rfloor}(dj)!^{\\mu(d){\\lfloor \\frac n d \\rfloor}}) $$\n$$ \\prod_{d=1}^n(\\prod_{i=1}^{\\lfloor \\frac n d \\rfloor} (di)!^{\\mu(d)})^{\\lfloor \\frac m d \\rfloor} \\times (\\prod_{d=1}^n \\prod_{j=1}^{\\lfloor \\frac m d \\rfloor} (dj)!^{\\mu(d)})^{\\lfloor \\frac n d \\rfloor} $$\n\n\u6211\u4eec\u53d1\u73b0\u8fd9\u73a9\u610f\u513f\u5c31\u662f $ f_3 $\uff0c\u76f4\u63a5\u5149\u901f\u5e42\u5373\u53ef\u3002\n\n\u867d\u7136\u590d\u6742\u5ea6\u662f $ O(n^{\\frac 5 4}\\log n+T\\sqrt n) $ \u7684\uff0c\u4f46\u662f\u5e38\u6570\u5de8\u5927\u3002\u3002\u3002\n\n\u4ee5\u53ca\uff0c\u5149\u901f\u5e42\u7a7a\u95f4\u8fc7\u5927\uff0c\u6240\u4ee5\u53ef\u80fd\u9700\u8981 $ \\rm vector $ \u6765\u5b9e\u73b0\uff0c\u4ee5\u53ca\u79bb\u7ebf\u5361\u5e38\u3002\n\n\u6765\u60f3\u60f3\u9700\u8981\u5bf9\u54ea\u4e9b\u4e1c\u897f\u9884\u5904\u7406\u5149\u901f\u5e42\n\n$ f_1 $\u548c $ 1.2 $ \u4e2d\u7684 \u201c$ f_1 $\u201d\u3002\u957f\u5ea6\u5206\u522b\u4e3a $ O(n\\log n) $ \u548c $ O(n\\log n) $\u3002\n\n\u5bf9\u4e8c\u8005\u540c\u65f6\u5149\u901f\u5e42\u3002\u6ce8\u610f\u5149\u901f\u5e42\u79bb\u7ebf\u540e\u4e00\u5171\u6709 $ O(n\\log n) $ \u4e2a\u5e95\u6570\uff0c\u5bf9\u5176\u5206\u5757\u540e\u53ef\u4ee5\u5361\u8fdb cache\uff0c\u5bf9\u4e0a\u9762\u7684\u4e8c\u8005\u540c\u6b65\u9884\u5904\u7406\u5149\u901f\u5e42\u5373\u53ef\u3002",
        "postTime": 1633345666,
        "uid": 160839,
        "name": "Prean",
        "ccfLevel": 7,
        "title": "\u6570\u8bba \u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14+\u5149\u901f\u5e42 P7890\u9898\u89e3"
    },
    {
        "content": "\u524d\u7f6e\u829d\u58eb\uff1a[\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14](https://oi-wiki.org/math/number-theory/mobius/)\u3001[Index Calculus \u7b97\u6cd5](https://www.luogu.com.cn/blog/Leasier/Index-Calculus)\n\n**Warning\uff1a\u672c\u9898\u6781\u4e3a\u5361\u5e38\u3002~~\u5e38\u6570\u8ddf\u6211\u4e00\u6837\u5de8\u5927\u7684\u4eba\u614e\u5165\u3002~~**\n\n\u9996\u5148\u8003\u8651 $F$ \u51fd\u6570\u3002\u6253\u8868\u53ef\u5f97\uff1a$F(n, m, k) = \\frac{C_{n + m - 1}^{m}}{n} = \\frac{(n + m - 1)!}{n! m!}$\u3002\n\n~~\u653e\u4e00\u4efd\u51fa\u9898\u4eba\u7684\u8bc1\u660e\uff1ahttps://www.luogu.com.cn/paste/mvhuutmb\u3002~~\n\n\u4ee4 $F'(n, m) = F(n, m, k)$\uff0c\u6709\uff1a\n\n\u539f\u5f0f $= (\\displaystyle\\prod_{i = 1}^N \\prod_{j = 1}^M F'(i, j)^{[\\gcd(i, j) = 1]})^K$\n\n$ = (\\displaystyle\\prod_{i = 1}^N \\prod_{j = 1}^M (\\frac{(i + j - 1)!}{i!j!})^{[\\gcd(i, j) = 1]})^K$\n\n\u8003\u8651\u5c06\u5206\u5b50\u548c\u5206\u6bcd\u5206\u5f00\u5904\u7406\u3002\n\n1. \u8ba1\u7b97 $\\displaystyle\\prod_{i = 1}^N \\prod_{j = 1}^M ((i + j - 1)!)^{[\\gcd(i, j) = 1]}$\n\n\u539f\u5f0f $= \\displaystyle\\prod_{i = 1}^N \\prod_{j = 1}^M ((i + j - 1)!)^{\\displaystyle\\sum_{d \\mid \\gcd(i, j)} \\mu(d)}$\n\n$ = \\displaystyle\\prod_{d = 1}^{\\min(N, M)} (\\prod_{d \\mid i}^N \\prod_{d \\mid j}^M (i + j - 1)!)^{\\mu(d)}$\n\n$ = \\displaystyle\\prod_{d = 1}^{\\min(N, M)} (\\prod_{i = 1}^{\\lfloor \\frac{N}{d} \\rfloor} \\prod_{j = 1}^{\\lfloor \\frac{M}{d} \\rfloor} (d(i + j) - 1)!)^{\\mu(d)}$\n\n$ = \\displaystyle\\prod_{d = 1}^{\\min(N, M)} (\\prod_{q = 1}^{\\lfloor \\frac{N}{d} \\rfloor + \\lfloor \\frac{M}{d} \\rfloor} (dq - 1)!^{\\displaystyle\\sum_{i = 1}^{\\lfloor \\frac{N}{d} \\rfloor} \\sum_{j = 1}^{\\lfloor \\frac{M}{d} \\rfloor} [i + j = q]})^{\\mu(d)}$\n\n$ = \\displaystyle\\prod_{d = 1}^{\\min(N, M)} ((\\prod_{q = 1}^{\\lfloor \\frac{\\min(N, M)}{d} \\rfloor} ((dq - 1)!)^{q - 1}) (\\prod_{q = \\lfloor \\frac{\\min(N, M)}{d} \\rfloor + 1}^{\\lfloor \\frac{\\max(N, M)}{d} \\rfloor} (dq - 1)!)^{\\lfloor \\frac{\\min(N, M)}{d} \\rfloor} (\\prod_{q = \\lfloor \\frac{\\max(N, M)}{d} \\rfloor + 1}^{\\lfloor \\frac{N}{d}                        \\rfloor + \\lfloor \\frac{M}{d} \\rfloor} ((dq - 1)!)^{\\lfloor \\frac{N}{d} \\rfloor + \\lfloor \\frac{M}{d} \\rfloor - q + 1}))^{\\mu(d)}$\n\n\u5c06\u9636\u4e58\u62c6\u5f00\uff08\u5373 $(i - 1)! = \\frac{i!}{i}$\uff09\u5e76\u9884\u5904\u7406 $f_{n, m} = \\displaystyle\\prod_{i = 1}^n (im)!$ \u548c $g_{n, m} = \\displaystyle\\prod_{i = 1}^n ((im)!)^i$ \u4ee5\u53ca $f'_{n, m} = \\displaystyle\\prod_{i = 1}^n f_{n, i}^{\\mu(i)}$ \u548c $g'_{n, m} = \\displaystyle\\prod_{i = 1}^n g_{n, i}^{\\mu(i)}$ \u4ee5\u6570\u8bba\u5206\u5757\u5373\u53ef\u3002\n\n\u7531\u4e8e\u672c\u9898\u5361\u65f6\u95f4\uff0c\u5efa\u8bae\u7528\u4e0a\u4f60\u6240\u80fd\u60f3\u5230\u7684\u4e00\u5207\u5361\u5e38\u65b9\u5f0f\u5e76\u7528\u66b4\u529b\u5904\u7406\u4e00\u90e8\u5206\u6570\u8bba\u5206\u5757\u4e2d $l, r$ \u8f83\u5c0f\u7684\u90e8\u5206\u3002\n\n\u7531\u4e8e\u672c\u9898\u5361\u65f6\u95f4\u548c\u7a7a\u95f4\uff0c\u5efa\u8bae\u624b\u5199\u5185\u5b58\u6c60\u5e76\u4f7f\u7528\u79bb\u7ebf\u4f7f\u5f97 $f, f'$ \u548c $g, g'$ \u80fd\u4f7f\u7528\u540c\u4e00\u4e2a\u6570\u7ec4\u8fdb\u884c\u8f6c\u79fb\u3002\n\n2. \u8ba1\u7b97 $\\displaystyle\\prod_{i = 1}^N \\prod_{j = 1}^M (i!j!)^{[\\gcd(i, j) = 1]}$\n\n\u539f\u5f0f $= \\displaystyle\\prod_{i = 1}^N \\prod_{j = 1}^M (i!j!)^{\\displaystyle\\sum_{d \\mid \\gcd(i, j)} \\mu(d)}$\n\n$ = \\displaystyle\\prod_{d = 1}^{\\min(N, M)} (\\prod_{d \\mid i}^N \\prod_{d \\mid j}^M (i!j!))^{\\mu(d)}$\n\n$ = \\displaystyle\\prod_{d = 1}^{\\min(N, M)} (\\prod_{i = 1}^{\\lfloor \\frac{N}{d} \\rfloor} \\prod_{j = 1}^{\\lfloor \\frac{M}{d} \\rfloor} (id)!(jd)!)^{\\mu(d)}$\n\n$ = \\displaystyle\\prod_{d = 1}^{\\min(N, M)} ((\\prod_{i = 1}^{\\lfloor \\frac{N}{d} \\rfloor} (id!))^{\\lfloor \\frac{M}{d} \\rfloor} (\\prod_{i = 1}^{\\lfloor \\frac{M}{d} \\rfloor} (id!))^{\\lfloor \\frac{N}{d} \\rfloor})^{\\mu(d)}$\n\n3. \u5b9e\u73b0\u4e0a\u7684\u95ee\u9898\n\n\u5bb9\u6613\u53d1\u73b0\uff0c\u5982\u679c\u4e0d\u4f7f\u7528\u5149\u901f\u5e42\uff0c\u8fd9\u6837\u505a\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(T \\sqrt{\\min(n, m)} (\\log n + \\log m) + N \\log N \\ln N)$\uff0c\u800c\u4e14\u4e58\u6cd5\u548c\u53d6\u6a21\u5e38\u6570\u6781\u5927\u3002\u5373\u4f7f\u4f7f\u7528\u5149\u901f\u5e42\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u53ea\u4f1a\u964d\u5230 $O(TM \\sqrt{\\min(n, m)} + M N^{1 + \\frac{1}{2^{M - 1}}} \\ln N)$\uff0c\u800c\u4e14\u5e38\u6570\u5c06\u4f1a\u53d8\u5f97\u66f4\u5927\u3002\n\n\u53d1\u73b0 $p$ \u4e3a\u8d28\u6570\uff0c\u4e8e\u662f\u76f4\u63a5\u4e0a Index Calculus \u7b97\u6cd5\u6c42\u51fa\u524d\u7f00\u79bb\u6563\u5bf9\u6570\uff0c\u5c06\u4e58\u6cd5\u53d8\u4e3a\u52a0\u6cd5\u5373\u53ef\u3002\n\n~~\u4f60\u8fd8\u9700\u8981\u6709\u6781\u5927\u7684\u8010\u5fc3\u3002~~\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(T \\sqrt{\\min(n, m)} + \\sqrt{p} + \\alpha \\beta^{\\beta} (\\frac{M}{\\ln M})^2 + \\alpha(\\frac{M}{\\ln M})^3 \\log p + \\frac{\\alpha^{\\alpha} NM}{\\ln N \\ln M} + N \\ln N)$\u3002\n\nUpdate\uff1a\u4e3a\u9632\u6b62\u8d3a\u9898\uff0c\u4ee3\u7801\u5c31\u4e0d\u653e\u4e86\uff0c\u800c\u4e14\u6211\u4e5f\u4e0d\u80fd\u4fdd\u8bc1\u6211\u7684\u4ee3\u7801\u968f\u65f6\u53ef\u4ee5 AC\uff08",
        "postTime": 1638871716,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P7890 \u3010\u300cMCOI-06\u300dLost Desire\u3011"
    },
    {
        "content": "\u672c\u9898\u89e3\u65e8\u5728\u63d0\u4f9b\u4e00\u79cd\u7b80\u6d01\u7684\u63a8\u5bfc\u65b9\u6cd5\uff0c~~\u51cf\u5c11\u5404\u4f4d\u7684\u8111\u7ec6\u80de\u7684\u635f\u8017~~\u3002\n\n------------\n\n\u5728\u6b64\u9898\u89e3\u4e2d\uff0c\u6211\u4eec\u7ea6\u5b9a\uff1a\n\n$$F^ * (x)=\\prod_{i=1}^xF(i)$$\n\n$$F^ {* * } (x)=\\prod_{i=1}^xF^*(i)$$\n\n\u5373 $F^ * (x)$ \u76f8\u5f53\u4e8e\u5bf9 $F(x)$ \u505a\u4e00\u6b21\u524d\u7f00\u79ef\uff0c$F^{* * }(x)$ \u5c31\u662f\u5bf9 $F(x)$ \u505a\u4e24\u6b21\u524d\u7f00\u79ef\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u6709 **\u5b9a\u7406** $1$\uff1a\n\n$$\n\\prod_{i=1}^n\\prod_{j=1}^mF(i+j)=\\prod_{i=1}^n\\dfrac{F^* (i+m)}{F^* (i)}=\\dfrac{F^{* * }(n + m)}{F^{* * }(n)F^{* * }(m)}\n$$\n\n\u540c\u6837\u5730\uff0c\u5728 $\\sum$ \u4e2d\u4e5f\u6709\u7c7b\u4f3c\u7ed3\u8bba\u3002\n\n------------\n\n\u6ce8\uff1a\u4ee5\u4e0b\u63a8\u5bfc\u7701\u7565\u5411\u4e0b\u53d6\u6574\u7b26\u53f7 $\\lfloor\\rfloor$\u3002\n\n\u63a5\u4e0b\u6765\u5f00\u59cb\u63a8\u5f0f\u5b50\uff0c\u5047\u8bbe $n\\le m$\uff0c\u5148\u770b\u5206\u5b50\u90e8\u5206\uff1a\n\n$$\n\\begin{aligned}\n\\prod_{i=1}^n\\prod_{j=1}^m(i+j-1)!^{[i\\perp j]}=\\prod_{d=1}^n\\prod_{i=1}^{n/d}\\prod_{j=1}^{m/d}[d(i+j)-1]!^{\\mu(d)}\n\\end{aligned}\n$$\n\n\u8bbe $F_d(x)=(dx-1)!^{\\mu(d)}$\uff0c\u90a3\u4e48\u7531\u5b9a\u7406 $1$ \u5f97\uff1a\n\n$$\n\\begin{aligned}\\prod_{d=1}^n\\prod_{i=1}^{n/d}\\prod_{j=1}^{m/d}[d(i+j)-1]!^{\\mu(d)}=\\prod_{d=1}^n\\dfrac{F^{* * }_ d (\\frac nd+\\frac md)}{F^{* * }_ d(\\frac nd)F^{* * }_ d(\\frac md)}\n\\end{aligned}\n$$\n\n\u8fd9\u6837\u5206\u5b50\u5c31\u7b97\u63a8\u5b8c\u4e86\uff0c\u63a5\u4e0b\u6765\u662f\u5206\u6bcd\uff1a\n\n$$\\prod_{i=1}^n\\prod_{j=1}^m(i!j!)^{[i\\perp j]}=\\prod_{d=1}^n\\prod_{i=1}^{n/d}\\prod_{j=1}^{m/d}[(di)!(dj)!]^{\\mu(d)}$$\n\n\u8bb0 $G_d(x)=(dx)!^{\\mu(d)}$\uff0c\u5219\uff1a\n\n$$\\prod_{d=1}^n\\prod_{i=1}^{n/d}\\prod_{j=1}^{m/d}[(di)!(dj)!]^{\\mu(d)}=\\prod_{d=1}^nG_d^* (\\frac nd)^{\\frac md}G_d^ * (\\frac md)^{\\frac nd}$$\n\n\u628a\u5206\u5b50\u5206\u6bcd\u7ed3\u5408\u8d77\u6765\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$\\prod_{d=1}^n\\dfrac{F^{* * }_ d (\\frac nd+\\frac md)}{F^{* * }_ d(\\frac nd)F^{* * }_ d(\\frac md)G_d^* (\\frac nd)^{\\frac md}G_d^ * (\\frac md)^{\\frac nd}}$$\n\n\u4e3a\u4e86\u80fd\u591f\u6574\u9664\u5206\u5757\uff0c\u6211\u4eec\u8bbe\uff1a\n\n$$H_d(x)=\\prod_{i=1}^dF_i^{* * }(x)$$\n$$L_d(x)=\\prod_{i=1}^dG_i^* (x)$$\n\n\u90a3\u4e48\u5bf9\u4e8e\u6574\u9664\u5206\u5757\u4e2d\u7684\u533a\u95f4 $[l,r]$\uff0c\u5176\u8ba1\u7b97\u5f0f\u5c31\u662f\uff1a\n\n$$\\dfrac{H_ r(\\frac nl+\\frac ml)H_ {l-1}(\\frac nl)H_ {l-1}(\\frac ml)L_{l-1} (\\frac nl)^{\\frac ml}L_{l-1}(\\frac ml)^{\\frac nl}}{H_ {l-1}(\\frac nl+\\frac ml)H_ r(\\frac nl)H_ r(\\frac ml)L_r (\\frac nl)^{\\frac ml}L_r (\\frac ml)^{\\frac nl}}$$\n\n------------\n\n\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8ba1\u7b97\u51fa\u6240\u6709\u9700\u8981\u7684 $H_d(x),L_d(x)$\uff0c\u518d\u52a0\u4e0a\u6574\u9664\u5206\u5757\uff0c\u5c31\u80fd\u5728 $O(n\\ln n+T\\sqrt n\\log n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u5b8c\u6210\u8ba1\u7b97\u3002\n\n\u5982\u679c\u518d\u52a0\u4e0a Index Calculus \u6216\u5176\u4ed6\u6c42\u79bb\u6563\u5bf9\u6570\u7684\u7b97\u6cd5\uff0c\u90a3\u5c31\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u4e86\u3002\n\n\u4ee5\u4e0b\u7ed9\u51fa\u4e00\u4e2a\u53ea\u80fd\u8fc7\u524d\u56db\u4e2a Subtask \u7684\u4ee3\u7801\uff0c\u4ec5\u4f9b\u53c2\u8003 or \u5bf9\u62cd\uff1a\n\n```cpp\n#include <iostream>\n#include <cstring>\n#include <cstdio>\n#include <cmath>\n#define ll long long\nusing namespace std;\n\nint Read(){\n    int res = 0; char c = getchar();\n    while(c < '0' || c > '9') c = getchar();\n    while(c >= '0' && c <= '9') res = res * 10 + (c ^ 48), c = getchar();\n    return res;\n}\nvoid Write(int x){ if(x > 9) Write(x / 10); putchar(48 ^ (x % 10));}\n\nconst int Mx = 1e6 + 1, Nx = 13970040;\nint Mod;\n\nint FastPow(ll a, int b){\n\tint res = 1;\n\twhile(b){\n\t\tif(b & 1) res = res * a % Mod;\n\t\tb >>= 1, a = a * a % Mod;\n\t}\n\treturn res;\n}\n\nbool Vis[Mx];\nint Prime[78500], tot, Miu[Mx];\nint Frac[Mx], Infs[Mx];\nint St[Mx];\nint MF[Nx], MG[Nx];\nvoid TestifyInit(){\n\tMiu[1] = Frac[0] = Frac[1] = 1;\n\tfor(int i = 2; i < Mx; ++i){\n\t\tif(!Vis[i]) Prime[++tot] = i, Miu[i] = -1;\n\t\tfor(int j = 1; j <= tot && Prime[j] * i < Mx; ++j){\n\t\t\tVis[i * Prime[j]] = 1;\n\t\t\tif(i % Prime[j] == 0) break;\n\t\t\tMiu[i * Prime[j]] = -Miu[i];\n\t\t}\n\t\tFrac[i] = 1ll * Frac[i - 1] * i % Mod;\n\t}\n\tSt[1] = -1, Infs[Mx - 1] = FastPow(Frac[Mx - 1], Mod - 2);\n\tfor(int i = 1; i < Mx - 1; ++i) St[i + 1] = St[i] + (Mx - 1) / i;\n\tfor(int i = Mx - 1; i; --i) Infs[i - 1] = 1ll * Infs[i] * i % Mod;\n\tfor(int d = 1; d < Mx; ++d){\n\t\tint lim = St[d] + (Mx - 1) / d;\n\t\tif(Miu[d] & 2){\n\t\t\tMF[St[d] + 1] = Infs[d], MG[St[d] + 1] = Infs[d - 1];\n\t\t\tfor(int x = St[d] + 2, t = d; x <= lim; ++x){\n\t\t\t\tMF[x] = 1ll * Infs[t += d] * MF[x - 1] % Mod;\n\t\t\t\tMG[x] = 1ll * Infs[t - 1] * MG[x - 1] % Mod;\n\t\t\t}\n\t\t\tfor(int x = St[d] + 2; x <= lim; ++x) MG[x] = 1ll * MG[x] * MG[x - 1] % Mod;\n\t\t}\n\t\telse if(Miu[d]){\n\t\t\tMF[St[d] + 1] = Frac[d], MG[St[d] + 1] = Frac[d - 1];\n\t\t\tfor(int x = St[d] + 2, t = d; x <= lim; ++x){\n\t\t\t\tMF[x] = 1ll * Frac[t += d] * MF[x - 1] % Mod;\n\t\t\t\tMG[x] = 1ll * Frac[t - 1] * MG[x - 1] % Mod;\n\t\t\t}\n\t\t\tfor(int x = St[d] + 2; x <= lim; ++x) MG[x] = 1ll * MG[x] * MG[x - 1] % Mod;\n\t\t}\n\t\telse for(int x = St[d] + 1; x <= lim; ++x) MF[x] = MG[x] = 1;\n\t}\n\tfor(int d = 2; d < Mx; ++d){\n\t\tint lim = St[d] + (Mx - 1) / d;\n\t\tfor(int x = St[d] + 1, y = St[d - 1] + 1; x <= lim; ++x, ++y)\n\t\t\tMF[x] = 1ll * MF[x] * MF[y] % Mod, MG[x] = 1ll * MG[x] * MG[y] % Mod;\n\t}\n}\n\nint main(){\n\tint T = Read(); Mod = Read();\n\tTestifyInit();\n\twhile(T--){\n\t\tint n = Read(), m = Read(), k = Read();\n\t\tif(n > m) swap(n, m);\n\t\tint A = MG[n + m - 1];\n\t\tint B = 1ll * MG[n - 1] * MG[m - 1] % Mod * FastPow(MF[n - 1], m) % Mod * FastPow(MF[m - 1], n) % Mod; // Ans = A / B\n\t\tfor(int l = 2, r; l <= n; l = r + 1){\n\t\t\tint N = n / l, M = m / l;\n\t\t\tr = min(n / N, m / M);\n\t\t\tA = 1ll * A * MG[St[r] + N + M] % Mod\n\t\t\t\t\t* MG[St[l - 1] + N] % Mod\n\t\t\t\t\t* MG[St[l - 1] + M] % Mod\n\t\t\t\t\t* FastPow(MF[St[l - 1] + N], M) % Mod\n\t\t\t\t\t* FastPow(MF[St[l - 1] + M], N) % Mod;\n\t\t\tB = 1ll * B * MG[St[l - 1] + N + M] % Mod\n\t\t\t\t\t* MG[St[r] + N] % Mod\n\t\t\t\t\t* MG[St[r] + M] % Mod\n\t\t\t\t\t* FastPow(MF[St[r] + N], M) % Mod\n\t\t\t\t\t* FastPow(MF[St[r] + M], N) % Mod;\n\t\t}\n\t\tprintf(\"%d\\n\", FastPow(1ll * A * FastPow(B, Mod - 2) % Mod, k));\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1676179450,
        "uid": 375984,
        "name": "\u98de\u96e8\u70df\u96c1",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P7890 \u300cMCOI-06\u300dLost Desire"
    },
    {
        "content": "\u611f\u89c9\u8fd9\u9898\u63a8\u5bfc\u633a trivial\uff0c\u6240\u4ee5\u51b3\u5b9a\u53ea\u8bb2\u4e0b\u4e00\u79cd\u7ed5\u5f00\u5149\u901f\u5e42\u548c Index Calculus \u7b97\u6cd5\u7684\u505a\u6cd5\u3002\r\n\r\n\u4e0b\u8bb0 $a$ \u5728\u6a21 $p$ \u610f\u4e49\u4e0b\u7684\u79bb\u6563\u5bf9\u6570\u4e3a $\\log_g{a}$\uff0c\u5176\u4e2d $g$ \u4e3a $p$ \u7684\u4e00\u4e2a\u539f\u6839\u3002\r\n\r\n\u4e0d\u52a0\u8bc1\u660e\u7684\u7ed9\u51fa\u4e24\u4e2a\u663e\u7136\u7684\u5f15\u7406\u3002\r\n\r\n-  Lemma 1: $\\log_g{ab}\\equiv(\\log_g{a}+\\log_g{b})\\pmod{\\varphi(p)}$\r\n\r\n-  Lemma 2: $x(\\left\\lfloor\\dfrac{p}{x}\\right\\rfloor+1)\\equiv x-(x\\bmod{p})\\pmod{p}$\r\n\r\n\u6839\u636e\u5f15\u7406 1,2 \u5f53 $x>\\sqrt{p}$ \u65f6\u6709\uff1a\r\n\r\n$$\\log_g{x}\\equiv\\log_{g}{(x-(x\\bmod{p}))}-\\log_g{(\\left\\lfloor\\dfrac{p}{x}\\right\\rfloor+1)}\\pmod{\\varphi(p)}$$\r\n\r\n\u6240\u4ee5\u5f53 $x>\\sqrt{p}$ \u65f6\u53ef\u4ee5 $O(1)$ \u9012\u63a8\u6c42\u51fa $\\log_{g}x$ \u7684\u503c\u3002\r\n\r\n\u7531 Lemma 1 \u77e5 $\\log_g{x}$ \u4e3a\u5b8c\u5168\u52a0\u6027\u51fd\u6570\uff0c\u6545\u53ea\u8981\u6c42\u51fa\u7d20\u6570\u70b9\u5904\u503c\u3002\r\n\r\n\u7efc\u4e0a\uff0c\u53ea\u9700\u6c42\u6240\u6709\u5c0f\u4e8e $\\sqrt{p}$ \u7684\u7d20\u6570\u7684\u539f\u6839\u3002\r\n\r\n\u8003\u8651 BSGS \u7b97\u6cd5\u672c\u8d28\uff0c\u7528 $O(B)$ \u9884\u5904\u7406\uff0c\u6bcf\u6b21\u8be2\u95ee $O(\\frac{p}{B})$ \u7684\u590d\u6742\u5ea6\u3002\r\n\r\n\u5e73\u8861\u4e0b\u590d\u6742\u5ea6\uff1a\r\n\r\n\u4ee4 $B=\\frac{p}{B}\\frac{\\sqrt{p}}{\\ln{p}}$\uff0c\u89e3\u5f97 $B=\\frac{p^\\frac{3}{4}}{\\sqrt{\\ln{p}}}$\u3002\r\n\r\n\u6c42\u524d $n$ \u4e2a\u6570\u7684\u79bb\u6563\u5bf9\u6570\u603b\u590d\u6742\u5ea6\u4e3a $O(\\frac{p^\\frac{3}{4}}{\\sqrt{\\ln{p}}}+n)$\u3002\r\n\r\n\u5e94\u51fa\u9898\u4eba\u4e0d\u653e\u4ee3\u7801\uff0c\u672c\u4eba\u4e0d\u4fdd\u8bc1\u8fd9\u7bc7\u9898\u89e3\u505a\u6cd5\u80fd\u7a33\u5b9a\u901a\u8fc7\uff0c\u8bfb\u8005\u5e94\u81ea\u884c\u5361\u5e38\uff08",
        "postTime": 1664895505,
        "uid": 133954,
        "name": "wkywkywky",
        "ccfLevel": 8,
        "title": "P7890\u9898\u89e3"
    }
]
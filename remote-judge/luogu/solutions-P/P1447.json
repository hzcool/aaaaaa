[
    {
        "content": "\u9898\u76ee\u5927\u610f:\u7ed9\u5b9an\u548cm,\u6c42\u03a3(1<=i<=n)\u03a3(1<=j<=m)GCD(i,j)\\*2-1\n\ni\u548cj\u7684\u9650\u5236\u4e0d\u540c,\u4f20\u7edf\u7684\u7ebf\u6027\u7b5b\u6cd5\u5931\u6548\u4e86,\u8fd9\u91cc\u6211\u4eec\u8003\u8651\u5bb9\u65a5\u539f\u7406\n\n\u4ee4f[x]\u4e3aGCD(i,j)=x\u7684\u6570\u5bf9(i,j)\u7684\u4e2a\u6570,\u8fd9\u4e2a\u4e0d\u662f\u5f88\u597d\u6c42\n\n\u6211\u4eec\u4ee4g[x]\u4e3a\u5b58\u5728\u516c\u56e0\u6570=x\u7684\u6570\u5bf9(i,j)\u7684\u4e2a\u6570(\u6ce8\u610f\u4e0d\u662f\u6700\u5927\u516c\u56e0\u6570\uff01),\u663e\u7136\u6709g[x]=(n/x)\\*(m/x)\n\n\u4f46\u662f\u8fd9\u4e9b\u6570\u5bf9\u4e2d\u6709\u4e00\u4e9b\u7684\u6700\u5927\u516c\u56e0\u6570\u4e3a2d,3d,4d,\u6211\u4eec\u8981\u628a\u4ed6\u4eec\u51cf\u6389\n\n\u4e8e\u662f\u6700\u7ec8f[x]=(n/x)\\*(m/x)-\u03a3(2\\*x<=i\\*x<=min(m,n))f[i\\*x]\n\n\u4ece\u540e\u5411\u524d\u679a\u4e3ex\u5373\u53ef\n\n\u65f6\u95f4\u590d\u6742\u5ea6O(nlogn)\n\n\u6ce8\u610f\u8ba1\u7b97g[x]\u7684\u65f6\u5019(n/x)\\*(m/x)\u53ef\u80fd\u4f1a\u4e58\u7206 \u4f1a\u6302\u6389\u4e00\u4e2a\u70b9\n\n```cpp\n#include<cstdio>\n#define re register int\nconst int N=100010;\nint n,m;long long f[N],ans;\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    if(n>m)n^=m^=n^=m; \n    for(re i=n;i;--i){\n        f[i]=(long long)(n/i)*(m/i);\n        for(re j=i<<1;j<=n;j+=i)f[i]-=f[j];\n        ans+=((i<<1)-1)*f[i];\n    }\n    printf(\"%lld\",ans);\nreturn 0;\n}\n```",
        "postTime": 1501853302,
        "uid": 20156,
        "name": "Kelin",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P1447 \u3010\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "## \u7eaa\u5ff5\u8fd9\u9053\u81ea\u5df1\u624b\u63a8\u51fa\u6765\u7684\u6570\u8bba\u9898\u3002\n\n\u989d\uff0c\u4e0a\u53e4\u9898\u89e3\u4e86\uff0c\u8bf7\u5927\u4f6c\u4e0d\u8981\u5632\u8bbd\uff0c\u6b27\u62c9\u51fd\u6570\u7684\u5377\u79ef\u53ef\u4ee5\u79d2\u6389...\n\n####  \u9996\u5148\u770b\u5230\u8fd9\u9053\u6bd2\u7624\u9898,\u6211\u4eec\u53ef\u4ee5\u5148\u8f6c\u5316\u4e00\u4e0b\u7b54\u6848\n\n\u4e0d\u8fc7\u597d\u50cf\u6709\u4e00\u70b9\u95ee\u9898@communist \u611f\u8c22\u5927\u4f6c\uff0c\u5df2\u7ecf\u4fee\u6539\n\n$$\\text{answer} \\iff 2\\times\\sum_{x=1}^n \\sum_{y=1}^m (\\gcd(x,y)-1)$$\n$$\\iff 2\\times\\sum_{x=1}^n \\sum_{y=1}^m (\\gcd(x,y)) \\ -n\\times m$$\n\n\u6240\u4ee5\u6c42\u51fa$\\sum_{x=1}^n \\sum_{y=1}^m (\\gcd(x,y))$\u5c31\u597d\u4e86\n\n\u6b63\u597d\u521a\u5b66\u8fc7\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u8fd8\u6709\u72c4\u5229\u514b\u96f7\u5377\u79ef\uff0c\n\n\u7136\u540e\u6211\u5c31\u5f00\u59cb\u66b4\u529b\u809d\u9898\u4e86\u3002\n\n\u524d\u7f6e\u77e5\u8bc6($\\text{[POI2007]ZAP-Queries}$) \u5148\u505a\u8fd9\u9053\u9898\u76ee\n\n[\u6211\u7684\u72c4\u5229\u514b\u96f7\u5377\u79ef\u603b\u7ed3](https://www.luogu.org/blog/wohaocaia/di-li-ke-lei-juan-ji-xiao-jie-yi-ji-mu-bi-wu-si-fan-yan-ding-li-di-zhe)\u4e0d\u4f1a\u7684\u770b\u8fd9\u91cc\n\n\u7136\u540e\u6211\u4eec\u5f00\u59cb\u6109\u5feb\u7684\u809d\u9898:\n#### \n\u5148\u4e0a\u5957\u8def:\n\n$$f(d)=\\sum_{i=1}^{n}\\sum_{j=1}^{m}[\\gcd(i,j)==d]$$\n\n\u8bbe$i=id,j=jd,$\u5c31\u53ef\u4ee5\u628a$d$\u63d0\u51fa\u6765\u4e86\n\n$$f(d)=\\sum_{i=1}^{\\lfloor\\frac nd\\rfloor}\\sum_{j=1}^{\\lfloor\\frac md\\rfloor}[\\gcd(i,j)==1]$$\n\n$$\u2235[x==1]\\Leftrightarrow \\sum_{q|x}\\mu(q)$$\n\n$$\u2234f(d)=\\sum_{i=1}^{\\lfloor\\frac nd\\rfloor}\\sum_{j=1}^{\\lfloor\\frac md\\rfloor}\\sum_{q|i,q|j}\\mu(q)$$\n\n\u66ff\u6362\u679a\u4e3e$q$\u65b9\u5f0f\n\n$$\u2234f(d)=\\sum_{i=1}^{\\lfloor\\frac nd}\\sum_{j=1}^{\\lfloor\\frac md}\\sum_{q=1}^{\\lfloor\\frac {\\min(n,m)}d\\rfloor}\\mu(q)[q|i,q|j]$$\n\n\u8bbe$i=iq,j=jq,$\u5c31\u53ef\u4ee5\u628a$\\sum_{q=1}^{\\lfloor\\frac {\\min(n,m)}d\\rfloor}$\u63d0\u51fa\u6765\u4e86\n\n$$\u2234f(d)=\\sum_{q=1}^{\\lfloor\\frac {\\min(n,m)}d\\rfloor}\\mu(q)\\sum_{i=1}^{\\lfloor\\frac n{dq}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac m{dq}\\rfloor}1$$\n\n$$f(d)=\\sum_{q=1}^{\\lfloor\\frac {\\min(n,m)}d\\rfloor}\\mu(q)\\lfloor\\frac n{dq}\\rfloor\\lfloor\\frac m{dq}\\rfloor$$\n\n\u8fd0\u7528\u4e00\u4e0b\u6574\u9664\u5206\u5757\uff0c\u66b4\u529b\u6c42\u51fa\u6bcf\u4e00\u4e2a$f(k)\\times k$\u52a0\u8d77\u6765\u5c31\u662f$\\sum_{x=1}^n \\sum_{y=1}^m \\gcd(x,y)$\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(\\min(n,m)\\sqrt {\\min(n,m)})$\n\n\u7ed3\u679c\u53ea\u6709$90$\u5206\uff0c\u8d85\u65f6\u4e86\u3002\n\n\u6211\u5f88\u7edd\u671b\u554a\uff0c\u7ed3\u679c\u91cd\u65b0\u63a8\u516c\u5f0f\u540e\uff0c\u6211\u53d1\u73b0\u6709\u4e00\u6b65\u53ef\u4ee5\u4f18\u5316:\n\n$$\\sum_{x=1}^n \\sum_{y=1}^m \\gcd(x,y)$$\n\n$$=\\sum_{d=1}^{\\min(n,m)}f(d)\\times d$$\n\n$$=\\sum_{d=1}^{\\min(n,m)}d\\sum_{q=1}^{\\frac {\\min(n,m)}d}\\mu(q)\\lfloor\\frac n{dq}\\rfloor\\lfloor\\frac m{dq}\\rfloor$$\n\n$$=\\sum_{d=1}^{\\min(n,m)}d\\sum_{dq=1}^{\\min(n,m)}\\mu(q)\\lfloor\\frac n{dq}\\rfloor\\lfloor\\frac m{dq}\\rfloor$$\n\n\u8bbe$T=dq$\n\n$$\u2234\\ =\\sum_{d=1}^{\\min(n,m)}d\\sum_{T=1}^{\\min(n,m)}[d|T]\\mu(\\frac Td )\\lfloor\\frac n{T}\\rfloor\\lfloor\\frac m{T}\\rfloor$$\n\n$$=\\sum_{d=1}^{\\min(n,m)}\\sum_{d|T}^{\\min(n,m)}d\\mu(\\frac Td )\\lfloor\\frac n{T}\\rfloor\\lfloor\\frac m{T}\\rfloor$$\n\n\u66ff\u6362$d,T$\u679a\u4e3e\u65b9\u5f0f\n\n$$=\\sum_{T=1}^{\\min(n,m)}\\sum_{d|T}^{\\min(n,m)}d\\mu(\\frac Td )\\lfloor\\frac n{T}\\rfloor\\lfloor\\frac m{T}\\rfloor$$\n\n$$=\\sum_{T=1}^{\\min(n,m)}\\lfloor\\frac n{T}\\rfloor\\lfloor\\frac m{T}\\rfloor\\sum_{d|T}^{\\min(n,m)}d\\mu(\\frac Td )$$\n\n\u540e\u9762\u7684\u4e1c\u897f\u6709\u70b9\u773c\u719f\u3002\u3002\u3002\n\n\u8fd9\u4e0d\u662f\u72c4\u5229\u514b\u96f7\u5377\u79ef\u5417?\n\n\u8bbe$h(T)=\\sum_{d|T}d\\times\\mu(\\frac{T}{d}),$\u5199\u6210\u5377\u79ef\u5176\u5b9e\u5c31\u662f\n\n$$h=id*\\mu$$\n\n\u7136\u540e\u4e24\u8fb9\u90fd\u4e58\u4e0a\u51fd\u6570$1$\n\n$$h*1=id*(\\mu*1)$$\n\n$$\u2235\\mu*1=\u03f5$$\n\n$$\u2234h*1=id*\u03f5$$\n\n$$\u2234h*1=id$$\n\n\u6211\u4eec\u53c8\u60ca\u5947\u7684\u53d1\u73b0\n\n$$\u2235\u03c6*1=id$$\n\n$$\u2234h=\u03c6$$\n\n$h$\u5c31\u662f\u6b27\u62c9\u51fd\u6570!\n\n\u89e3\u4e86\u8fd9\u4e48\u4e45\u518d\u5e26\u5165\u539f\u5f0f\n\n$$\\sum_{x=1}^n \\sum_{y=1}^m \\gcd(x,y)$$\n\n$$=\\sum_{T=1}^{\\min(n,m)}\\lfloor\\frac{n}{T}\\rfloor\\lfloor\\frac{m}{T}\\rfloor \\varphi(T)$$\n\n\u7136\u540e\u5c31\u5f88\u5957\u8def\u4e86\u3002\u548c$\\text{ZAP Queries}$\u4e00\u6837\uff0c\u9884\u5904\u7406\u51fa\u6b27\u62c9\u51fd\u6570\u524d\u7f00\u548c\uff0c\u7136\u540e\u7528\u6574\u9664\u5206\u5757\uff0c\u8fd9\u4e2a\u9898\u76ee\u5c31$O(\\min(n,m))$\u5730\u89e3\u51b3\u4e86\u3002\n\n\u6b27\u62c9\u51fd\u6570\u524d\u7f00\u548c\u7528\u6b27\u62c9\u7b5b\u6c42(\u4ec0\u4e48\u9b3c)\n\n## \u540e\u8bb0\n\n\u4fe1\u606f\u6570\u8bba\u548c\u666e\u901a\u6570\u8bba\u7684\u533a\u522b\u5c31\u5728\u4e8e:\u5b83\u4e0d\u4e00\u5b9a\u662f\u4e2a\u7ed3\u8bba\u9898\u3002\u4f60\u5728\u63a8\u5bfc\u7684\u8fc7\u7a0b\u4e2d\uff0c\u9700\u8981\u8003\u8651\u2014\u2014\u4ec0\u4e48\u65f6\u5019\u8981\u505c\u7b14\u53bb\u679a\u4e3e\u3002\n\n\u8fd9\u4e5f\u5c31\u662f\u4fe1\u606f\u6570\u8bba\u7684\u96be\u70b9\u6240\u5728\u3002\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nint tot,T,vis[100004];\nlong long phi[100004],sum[100004],p[100004],n,m;\ninline void init(){//\u7b5b\u6b27\u62c9\u51fd\u6570\n    int nx=100000;phi[1]=1;\n    for (register int i=2;i<=nx;i++){\n        if (!vis[i]) p[++tot]=i,phi[i]=i-1;\n        for (register int j=1;j<=tot&&i*p[j]<=nx;j++){\n        \tif (i*p[j]>nx) continue;\n            vis[i*p[j]]=1;\n            phi[i*p[j]]=phi[i]*phi[p[j]];\n            if((i%p[j])==0){\n                phi[i*p[j]]=phi[i]*p[j];\n                break;\n            }\n        }\n    }\n    for (int i=1;i<=nx;i++){\n        sum[i]=sum[i-1]+phi[i];//\u6c42\u524d\u7f00\u548c\n    }\n}\nint main(){\n    scanf(\"%lld%lld\",&n,&m);\n    init();\n    long long ans=0;\n    for (int l=1,r;l<=min(n,m);l=r+1){\n        r=min(n/(n/l),m/(m/l));\n        ans+=(long long)(sum[r]-sum[l-1])*(n/l)*(m/l);//\u6574\u9664\u5206\u5757\n    }\n    ans=(long long)2*ans-n*m;\n    printf(\"%lld\",ans);\n}\n```",
        "postTime": 1538468675,
        "uid": 20309,
        "name": "Fading",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P1447 \u3010[NOI2010]\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "# \u2460 \u62bd\u8c61\u4e3a\u6a21\u578b:\n\n\u5c31\u662f\u7ed9\u4f60\u4e00\u4e2a$n\\cdot m$\u7684\u65b9\u9635,\u95ee\u6bcf\u4e2a\u70b9\u4e0e\u539f\u70b9\u7684\u8fde\u7ebf\u4e2d\u6709\u591a\u5c11\u70b9(\u4e0d\u5305\u62ec\u4e24\u5934\u7684)*2+1\u518d\u6c42\u548c,\n\n\u5f62\u5f0f\u5316\u5730\u8bf4,\u5c31\u662f\u6c42\n\n$$\\color{blue}\\sum_{i=1}^{n}\\sum_{j=1}^{m}gcd_{i,j}\\cdot2-1$$\n\n\u6ce8\u610f\u662f\u51cf,\u56e0\u4e3a\u6211\u4eec\u4e0d\u8ba1\u7b97\u8fd9\u6761\u7ebf\u6bb5\u4e24\u7aef\u70b9\n\n\u5373\u4e3a\n\n$$\\color{blue}\\left[\\sum_{i=1}^{n}\\sum_{j=1}^{m}gcd_{i,j}\\right]\\color{black}\\cdot2\\ -\\ nm$$\n\n\u597d\u73b0\u5728\u7684~~\u4e3b\u8981\u77db\u76fe~~\u5c31\u662f\u6c42\u84dd\u8272\u90a3\u90e8\u5206.\n\n# \u2461 \u5f00\u59cb\u4e71\u641e\n\n\u6b63\u5411\u4e0d\u597d\u6c42,\u6211\u4eec\u8003\u8651~~\u66b4\u529b(\u987a\u4fbf\u8bf4\u4e00\u53e5,\u8fd9\u9898\u66b4\u529b\u6c42\u4e0a\u9762\u5f0f\u5b50\u6709$\\color{green}80$\u5206qwq)~~\u53cd\u7740\u6c42,\u5373\n\n\u5f00\u4e00\u4e2a$cnt$\u6570\u7ec4, $cnt_i$\u8868\u793a**\u516c\u7ea6\u6570**\u4e3ai\u7684**\u6570\u5bf9**\u4e2a\u6570.(\u6ce8\u610f\u4e0d\u662f\u6700\u5927\u516c\u56e0\u6570)\n\n~~\u663e\u7136~~\u6839\u636e\u4e58\u6cd5\u539f\u7406,\n\n$$\\color{Blue}cnt_i = \\left\\lfloor\\frac{n}{i}\\right\\rfloor+\\left\\lfloor\\frac{m}{i}\\right\\rfloor$$\n\n\u4f46\u662f\u6211\u4eec\u5ffd\u7565\u4e86\u4e00\u70b9,\u5c31\u662f\u4e00\u4e2a\u6570\u5bf9\u53ef\u4ee5\u4ea7\u751f\u516c\u56e0\u6570$x$,\u4e5f**\u53ef\u80fd**\u4ea7\u751f\u516c\u56e0\u6570$2x,3x......$\n\n\u6240\u4ee5\u548b\u6574?\u51cf\u6389\u5c31\u884c!\n\n# Code:\n\n\u6ce8\u610f\u4e00\u70b9:\u6700\u7ec8\u51cf\u6389$nm$\u65f6\u8981\u51cf\u53bb`1LL*n*m`,\u4e0d\u7136\u4f1a\u7206\n\n(\u53ea\u8d34\u51fa\u5173\u952e\u90e8\u5206)\n\n```cpp\n\tRead(n,m);\n\tFor(i,max(n,m))\n\t\tcnt[i] = 1LL * (n/i) * (m/i);\n\tfOR(i,max(n,m)){\n\t\tint x = i+i;\n\t\tg[i] = cnt[i];\n\t\twhile( x <= max(n,m) ){\n\t\t\tg[i] -= g[x];\n\t\t\tx += i;\n\t\t}\n\t}\n\tFor(i,max(n,m))\n\t\tans += 1LL * i * g[i];\n\n\tprintf(\"%lld\",ans*2LL-1LL*n*m);\n```",
        "postTime": 1534173779,
        "uid": 25630,
        "name": "interestingLSY",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P1447 \u3010[NOI2010]\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "[\u9898\u76ee](https://www.luogu.org/problem/P1447)\n\n\u8fd9\u9898\u4e0d\u8981\u7528\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u7528\u6b27\u62c9\u53cd\u6f14\u66f4\u5feb\n\n---\n\n**\u3010\u5206\u6790\u3011**\n--\n\n\u8bbe\u70b9 $(x,y)$ \u7684\u80fd\u91cf\u635f\u5931\u4e3a $f(x,y)$\n\n\u5219 $\\displaystyle Ans=\\sum_{i=1}^n\\sum_{j=1}^m f(i,j)$\n\n---\n\n\u6211\u4eec\u5148\u89e3\u51b3 $f(x,y)$ \u5177\u4f53\u662f\u591a\u5c11\uff1a\n\n~~\u663e\u7136~~ \u662f $2gcd(x,y)-1$\n\n\u8bc1\u660e\u5982\u4e0b \uff08\u4e0d\u60f3\u4e86\u89e3\u7684\u5c0f\u4f19\u4f34\u53ef\u4ee5\u8df3\u8fc7\uff09\n\n\u8bbe\u70b9 $(x,y)$ \u4e0e $(0,0)$ \u4e4b\u95f4\u6709\u4e14\u4ec5\u6709 $k$ \u4e2a\u6574\u6570\u70b9\uff0c\u5b83\u4eec\u5206\u522b\u4e3a $({x\\over \\lambda _1},{y\\over \\lambda_1})$ ~ $({x\\over \\lambda _k},{y\\over \\lambda_k})$\n\n( $\\forall i\\in[1,k],\\lambda_i>1$ )\n\n$\\because \\forall i\\in[1,k]$ \u90fd\u6709 $({x\\over \\lambda_i},{y\\over \\lambda_i})$ \u4e3a\u6574\u6570\u70b9\n\n\u5373 ${x\\over \\lambda_i},{y\\over \\lambda_i}\\in Z$\n\n\u56e0\u4e3a\u4e0d\u4fdd\u8bc1 $\\lambda\\in Z$ \u6240\u4ee5\u4e0d\u80fd\u5199\u6210 $\\lambda_i\\mid x\\bigwedge\\lambda_i\\mid y$\n\n\u90a3\u4e48\uff0c\u6211\u4eec\u4ee4 $p={x\\over \\lambda_i},q={y\\over \\lambda_i},p,q\\in Z$\n\n$\\therefore gcd(x,y)=gcd(p\\lambda_i,q\\lambda_i)$\n\n$\\therefore {gcd(x,y)\\over \\lambda_i}=gcd(p,q)$\n\n$\\because$ $\\lambda_i$ \u6709\u4e14\u4ec5\u6709 $k$ \u4e2a\u53d6\u503c\n\n$\\therefore$ $gcd(p,q)$ \u6709\u4e14\u4ec5\u6709 $k$ \u4e2a\u53d6\u503c\uff0c\u4e14\u5fc5\u5b9a\u4e3a\u6574\u6570\n\n$\\therefore $ \u5bf9 $\\forall n>1,{gcd(x,y)\\over n}$ \u6709\u4e14\u4ec5\u6709 $k$ \u4e2a\u6574\u6570\u53d6\u503c\n\n> \u6ce8\uff1a$n$ \u53ef\u4e3a\u5206\u6570\n\n$\\therefore$ \u5bf9 $\\forall n>0,{gcd(x,y)\\over n}$ \u6709\u4e14\u4ec5\u6709 $(k+1)$ \u4e2a\u6574\u6570\u53d6\u503c\n\n\u8fd9\u4e0d\u5c31\u8bf4\u660e\u4e86 $gcd(x,y)=k+1$ \u5417\uff1f\n\n$\\therefore f(x,y)=2k+1=2(k+1)-1=2gcd(x,y)-1$\n\n---\n\n\u597d\u4e86\uff0c\u9898\u76ee\u5f88\u663e\u7136\u4e86\uff0c\u6c42 $\\displaystyle Ans=\\sum_{i=1}^n\\sum_{j=1}^m[2gcd(x,y)-1]$\n\n\u8003\u8651 $-1$ \u7684\u8d21\u732e\uff1a $\\displaystyle Ans=\\sum_{i=1}^n\\sum_{j=1}^m2gcd(x,y)-nm$\n\n\u6c42\u548c\u7b26\u53f7\u4e2d\u63d0\u53d6\u516c\u56e0\u5f0f $2$ :$\\displaystyle Ans=2\\sum_{i=1}^n\\sum_{j=1}^mgcd(x,y)-nm$\n\n\u63a5\u4e0b\u6765\uff0c\u6709\u8bf7 **\u6b27\u62c9** ~~\u7e41\u884d~~ **\u53cd\u6f14** \u95ea\u4eae\u767b\u573a\uff1a\n\n\u5b83\u7684\u6839\u672c\u662f\u4e00\u4e2a\u516c\u5f0f $\\displaystyle \\sum_{d\\mid n}\\boldsymbol \\varphi(d)=n$\n\n\u8fd9\u4e2a\u516c\u5f0f\u600e\u4e48\u6765\u7684\uff1f\u6211\u4e0a\u6b21\u770b\u5230\u67d0\u4e2a dalao \u7ed9\u51fa\u4e86\u5f62\u8c61\u7684\u8bc1\u660e\uff1a\n\n> \u5047\u8bbe\u6211\u4eec\u6709 ${1\\over n},{2\\over n},{3\\over n}\\dots {n-1\\over n},{n\\over n}$ \u5171 $n$ \u4e2a\u5206\u6570\u3002\u5c06\u5b83\u4eec\u80fd\u7ea6\u5206\u7684\u5168\u90e8\u7ea6\u5206\uff0c\u5219\u7ea6\u5206\u540e\u7684\u5206\u6bcd $d$ \uff0c\u5fc5\u5b9a\u6ee1\u8db3 $d\\mid n$ \u3002\u4e14\u5bf9 $\\forall d\\mid n$ \uff0c\u5206\u6bcd\u4e3a $d$ \u7684\u5206\u6570\u4e00\u5171\u51fa\u73b0 $\\boldsymbol \\varphi(d)$ \u6b21\u3002\u6240\u4ee5 $\\displaystyle \\sum_{d\\mid n}\\boldsymbol \\varphi(d)=n$ \u3002\n\n\u8fd8\u662f\u4e0d\u4e86\u89e3\u7684\u53ef\u4ee5\u8bd5\u7740\u7528\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u8bc1\u660e\uff0c\u4e5f\u662f\u53ef\u884c\u7684\n\n\u6240\u4ee5\u539f\u5f0f\u53c8\u80fd\u7ee7\u7eed\u5316\u7b80\uff1a $\\displaystyle Ans=2\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{d\\mid gcd(i,j)}\\boldsymbol \\varphi(d)-nm$\n\n\u56e0\u4e3a $n,m$ \u5bf9\u7b54\u6848\u7684\u8d21\u732e\u662f\u5bf9\u79f0\u7684\uff0c\u6211\u4eec\u4e0d\u59a8\u8bbe $n<m$\n\n\u8c03\u6362\u987a\u5e8f\uff0c\u679a\u4e3e $d$\n\n$\\therefore\\displaystyle  Ans=2\\sum_{d=1}^n\\boldsymbol \\varphi(d)\\sum_{i=1}^n\\sum_{j=1}^m[d\\mid gcd(i,j)]-nm$\n\n$\\displaystyle \\qquad\\quad=2\\sum_{d=1}^n\\boldsymbol \\varphi(d)\\sum_{i=1}^n\\sum_{j=1}^m[d\\mid i\\bigwedge d\\mid j]-nm$\n\n$\\displaystyle \\qquad\\quad=2\\sum_{d=1}^n\\boldsymbol \\varphi(d)\\sum_{i=1}^n[d\\mid i]\\sum_{j=1}^m[d\\mid j]-nm$\n\n\u5206\u522b\u8003\u8651 $i,j$ \u7684\u8d21\u732e\uff1a\n\n$\\displaystyle Ans=2\\sum_{d=1}^n\\boldsymbol \\varphi(d)\\sum_{i=1}^{\\lfloor{n\\over d}\\rfloor}[1\\mid i]\\sum_{j=1}^{\\lfloor{m\\over d}\\rfloor}[1\\mid j]-nm$\n\n$\\displaystyle \\qquad=2\\sum_{d=1}^n\\boldsymbol \\varphi(d){\\lfloor{n\\over d}\\rfloor}{\\lfloor{m\\over d}\\rfloor}-nm$\n\n\u5269\u4e0b\u7684\u6574\u9664\u5206\u5757\u641e\u4e00\u641e\u5c31\u51fa\u6765\u4e86\n\n---\n\n**\u3010\u4ee3\u7801\u3011**\n---\n\n\u90a3\u672c\u849f\u84bb\u5c31\u653e ~~\u6211\u7801\u98ce\u6781\u4e11\u7684~~ \u4ee3\u7801\u4e86\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#define f(a,b,c,d) for(register int a=b,c=d;a<=c;a++)\n#define g(a,b,c,d) for(register int a=b,c=d;a>=c;a--)\n//#define LOCAL\ntypedef int i32;\ntypedef unsigned int u32;\ntypedef long long int i64;\ntypedef unsigned long long int u64;\nconst i32 MAXN=1e5;\ntypedef i64 ar[MAXN+10];\n\nnamespace HABIT{\n    template<typename T> inline T Max(T a) { return a; }\n    template<typename T,typename... Args> inline T Max(T a,Args... args){\n        T b=Max(args...);\n        return (a>b)?a:b;\n    }\n    template<typename T> inline T Min(T a) { return a; }\n    template<typename T,typename... Args> inline T Min(T a,Args... args){\n        T b=Min(args...);\n        return (a<b)?a:b;\n    }\n\n    #ifdef LOCAL\n        inline char gc() { return getchar(); }\n    #else\n        inline char gc() {\n            static char s[1<<20|1]={0},*p1=s,*p2=s;\n            return (p1==p2)&&(p2=(p1=s)+fread(s,1,1<<20,stdin),p1==p2)?EOF:*(p1++);\n        }\n    #endif\n    inline i32 read(){\n        register i32 ans=0;register char c=gc();register bool neg=0;\n        while(c<48||c>57) neg^=!(c^'-'),c=gc();\n        while(c>=48&&c<=57) ans=(ans<<3)+(ans<<1)+(c^48),c=gc();\n        return neg?-ans:ans;\n    }\n\n    char Output_Ans[1<<20|1],*Output_Cur=Output_Ans;\n    inline bool output() { Output_Cur-=fwrite(Output_Ans,1,Output_Cur-Output_Ans,stdout); }\n    inline void print(char c) { (Output_Cur-Output_Ans+1>>20)&&output(),*(Output_Cur++)=c; }\n    inline void print(i64 x){\n        char buf[21]={0}; (Output_Cur-Output_Ans+sprintf(buf,\"%lld\",x)>>20)&&output();\n        Output_Cur+=sprintf(Output_Cur,\"%lld\",x);\n    }\n}\nusing namespace HABIT;\n\nar ar_d_Fc,ar_d_Prime,ar_d_Phi;\ninline void pre(i32 d_Lim){\n    i64 *ptr_d_Prime=ar_d_Prime;\n    ar_d_Phi[1]=1;\n    f(i,2,I,d_Lim){\n        if(!ar_d_Fc[i]) ar_d_Phi[i]=(*(ptr_d_Prime++)=ar_d_Fc[i]=i)-1;\n        for(register i64 *p=ar_d_Prime;p<ptr_d_Prime&&*p*i<=d_Lim;p++){\n            ar_d_Fc[*p*i]=*p;\n            ar_d_Phi[*p*i]=*p*ar_d_Phi[i];\n            if(*p<ar_d_Fc[i]) ar_d_Phi[*p*i]-=ar_d_Phi[i];\n            else break;\n        }\n        ar_d_Phi[i]+=ar_d_Phi[i-1];\n    }\n}\n\nint main(){\n    i32 d_N=read(),d_M=read();\n    i64 lld_Ans=-1ll*d_N*d_M;\n    if(d_N>d_M) d_N^=d_M^=d_N^=d_M;\n    pre(d_N);\n    for(register i32 l=1,r;l<=d_N;l=r+1){\n        r=Min( d_N/(d_N/l) , d_M/(d_M/l) );\n        lld_Ans+=(ar_d_Phi[r]-ar_d_Phi[l-1])*(d_N/r)*(d_M/r)*2;\n    }\n    print(lld_Ans);\n    output();\n    return 0;\n}\n```\n\n\u6700\u540e\u5b89\u5229\u4e00\u4e0b [\u672c\u849f\u84bb\u7684\u535a\u5ba2](https://www.luogu.org/blog/JustinRochester/)",
        "postTime": 1566792437,
        "uid": 36031,
        "name": "JustinRochester",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P1447 \u3010[NOI2010]\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "\u9898\u610f\u5927\u81f4\u7ffb\u8bd1\u4e00\u4e0b\uff0c\u76f8\u4fe1\u5927\u5bb6\u80af\u5b9a\u90fd\u505a\u8fc7 [\u4eea\u4ed7\u961f](https://www.luogu.org/problemnew/show/P2158)\u5427 QWQ \n\n\u63d0\u524d$ps:$ \u672c\u9898\u89e3\u7684\u9664\u6cd5\u5747\u4e3a\u4e0b\u53d6\u6574\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u4e00\u4e2a\u690d\u7269$(x,y)$\u6240\u4ea7\u751f\u7684\u80fd\u91cf\u635f\u5931\u4e3a$2*(gcd(x,y)-1) + 1 = 2 * gcd(x,y)-1$\n\n\u6240\u4ee5\u9898\u76ee\u8981\u6c42\u7684\u5373\uff1a\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m(2*gcd(i,j)-1)$$\n\n\u7a0d\u5fae\u5316\u7b80\u4e00\u4e0b\uff1a\n\n$$2*\\sum_{i=1}^n\\sum_{j=1}^mgcd(i,j) - n * m$$\n\n\u5229\u7528\u4e00\u4e0b\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u7684\u6027\u8d28\uff0c\u4e0d\u9020\u7684\u540c\u5b66\u53ef\u4ee5\u770b\u4e0b[\u8fd9\u91cc](https://www.luogu.org/blog/Soulist/guan-yu-mu-bi-wu-si-di-yi-dian-xue-xi-post)\n\n\u6211\u4eec\u53ea\u5173\u6ce8\u524d\u9762\u90a3\u4e00\u90e8\u5206\n\n$$2*\\sum_{d=1}^nd*\\sum_{i=1}^{\\frac{n}{d}}\\sum_{j=1}^{\\frac{m}{d}}\\sum_{k|gcd(i,j)}\\mu(k)$$\n\n$$2*\\sum_{d=1}^nd*\\sum_{k=1}^{\\frac{n}{d}}\\mu(k)*\\frac{n}{kd}*\\frac{m}{kd}$$\n\n\u8c8c\u4f3c\u73b0\u5728\u5c31\u5df2\u7ecf\u53ef\u4ee5\u8fc7\u8fd9\u9053\u9898\u4e86\uff1f\u590d\u6742\u5ea6$O(N\\sqrt N)$\n\n\n\u7136\u800c\u590d\u6742\u5ea6\u53ef\u4ee5\u66f4\u4f18\uff0c\u6bd4\u5982\u6211\u4eec\u53ef\u4ee5\u591a\u6b21\u8be2\u95ee\u4ec0\u4e48\u7684\uff1f\n\n\u4e00\u4e2a\u975e\u5e38\u8001\u7684\u5957\u8def\uff1a\n\n\u8bbe $T = kd$\n\n\u90a3\u4e48\u6211\u4eec\u5bf9\u6bcf\u4e2a $T$ \u7684\u6784\u6210\u5355\u72ec\u8003\u8651\uff1a\u53d1\u73b0\u5bf9\u4e8e\u6bcf\u4e2a $T$ \u5b83\u5b58\u5728\u5f88\u591a\u56e0\u5b50\uff0c\u5728\u8003\u8651\u6bcf\u4e2a\u56e0\u5b50 $d$ \u5b83\u5bf9\u7b54\u6848\u4ea7\u751f\u7684\u8d21\u732e\u4e3a\uff1a$\\sum\\mu(d)*k*\\dfrac{n}{kd}\\dfrac{m}{kd}=\\sum\\mu(d)*\\dfrac{T}{d}*\\dfrac{n}{T}*\\dfrac{m}{T}$\n\n\u91cd\u65b0\u5199\u4e00\u4e0b\uff1a\n\n$$\\sum_{T=1}^n\\sum_{d|T}\\mu(d)*\\dfrac{T}{d}*\\frac{n}{T}*\\frac{m}{T}$$\n\n$$\\sum_{T=1}^n\\dfrac{n}{T}*\\dfrac{m}{T} * \\sum_{d|T}\\mu(d)*\\dfrac{T}{d}$$\n\n\u4e0d\u96be\u53d1\u73b0\u5b83\u4e4b\u548c $T$ \u6709\u5173...\uff0c\u4e14\u540e\u9762\u8fd9\u4e00\u5768\u4e3a\uff1a$\\sum_{d|T}\\mu(d)*\\frac{T}{d}$\uff0c\u90a3\u4e48\u5b83\u5176\u5b9e\u662f\u4ec0\u4e48\u5462\uff1f\u5176\u5b9e\u5c31\u662f$\\mu$\u51fd\u6570\u548c$Id$\u51fd\u6570\u7684\u5377\u79ef\u3002\u89c1\u6b64\u5904\uff1a[\u79ef\u6027\u51fd\u6570\uff0c\u8fea\u5229\u514b\u96f7\u5377\u79ef](https://www.luogu.org/blog/Hakuryu/du-jiao-shai)\n\n\u7136\u800c\u6709\u8da3\u7684\u662f\uff1a$\\mu*Id=\\phi$ [\u5173\u4e8e\u8fd9\u4e2a\u4e1c\u897f\u7684\u8bc1\u660e\u5728\u6b64\u5904(\u89c1\u52a0\u7c97\u5b57\u4f53\u8bc1\u660e\u90e8\u5206)](https://www.luogu.org/blog/Hakuryu/solution-p3768)\n\n\u5982\u679c\u5c06\u540e\u9762\u8fd9\u4e00\u5768\u8bbe\u4e3a$f(T)$\uff0c\u5219$f(T)=\\phi(T)$\n\n\u6240\u4ee5\u539f\u5f0f\u5373\uff1a\n\n$$2*\\sum_{T=1}^{n}\\dfrac{n}{T}*\\dfrac{m}{T}*\\phi(T) - n * m$$\n\n\u5f53\u7136\uff0c\u56e0\u4e3a\u5176\u4e2d\u7684\u9664\u6cd5\u90fd\u662f\u4e0b\u53d6\u6574\uff0c\u4e8e\u662f\u559c\u95fb\u4e50\u89c1\u7684\u6574\u9664\u5206\u5757\u6765\u4e86\uff01\n\n\u5f53\u7136\uff0c\u8981\u8bb0\u5f55$\\phi$\u51fd\u6570\u7684\u524d\u7f00\u548c\u3002\n\n\u6700\u540e\u590d\u6742\u5ea6\uff1a$O(N+\\sqrt N )$\n\n\uff08\u7136\u800c\u5f53\u8be2\u95ee\u591a\u6b21\u7684\u65f6\u5019\u8fd9\u4e2a\u505a\u6cd5\u5bf9\u6bcf\u6b21\u8be2\u95ee\u5904\u7406\u7684\u590d\u6742\u5ea6\u5747\u4e3a$\\sqrt N$\uff09\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint read() {\n\tchar cc = getchar(); int cn = 0, flus = 1;\n\twhile(cc < '0' || cc > '9') {  if( cc == '-' ) flus = -flus;  cc = getchar();  }\n\twhile(cc >= '0' && cc <= '9')  cn = cn * 10 + cc - '0', cc = getchar();\n\treturn cn * flus;\n}\nconst int N = 1e5 + 5;\n#define int long long \n#define rep( i, s, t ) for( register int i = s; i <= t; ++ i )\nint n, m, phi[N], sum[N], maxn, p[N], top;\nbool isp[N];\nvoid init() {\n\tmaxn = N - 5, phi[1] = sum[1] = 1;\n\trep( i, 2, maxn ) {\n\t\tif( !isp[i] ) phi[i] = i - 1, p[++ top] = i;\n\t\trep( j, 1, top ) {\n\t\t\tif( p[j] * i > maxn ) break;\n\t\t\tisp[p[j] * i] = 1;\n\t\t\tif( i % p[j] == 0 ) {\n\t\t\t\tphi[p[j] * i] = phi[i] * p[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tphi[p[j] * i] = phi[p[j]] * phi[i];\n\t\t}\n\t\tsum[i] = sum[i - 1] + phi[i];\n\t}\n} \nint solve( int x, int y ) {\n\tint l, r, ans = 0 ; if( x > y ) swap( x, y ); \n\tfor( l = 1; l <= x; l = r + 1 ) {\n\t\tr = min( ( x / ( x / l ) ), ( y / ( y / l ) ) ); //\u6574\u9664\u5206\u5757\n\t\tans += ( sum[r] - sum[l - 1] ) * ( x / l ) * ( y / l ); //\u8bb0\u5f55\u4e86phi\u7684\u524d\u7f00\u548c \n\t}\n\treturn 2 * ans - x * y ;\n}\nsigned main()\n{\n\tinit(); n = read(), m = read();\n\tprintf(\"%lld\\n\", solve( n, m ) );\n\treturn 0;\n}\n\n```",
        "postTime": 1553774106,
        "uid": 30036,
        "name": "Soulist",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P1447 \u3010[NOI2010]\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "\u6211\u4eec\u5148\u6765\u5206\u6790\u4e00\u4e0b\u9898\u610f\uff0c\u53d1\u73b0\u6240\u6709\u6ca1\u6709\u88ab\u906e\u6321\u4f4f\u7684\u690d\u7269\u7684\u6a2a\u7eb5\u5750\u6807$(x,y)$\u90fd\u6ee1\u8db3$n\\bot m$\uff0c\u800c\u4e00\u6761\u7ebf\u4e0a\u4ece$(x,y)$\u5230$(0,0)$\u4e0a\u88ab\u6321\u4f4f\u7684\u690d\u7269\u6709$gcd(x,y)-1$\u4e2a\n\n\u6240\u4ee5\u9898\u610f\u5c31\u88ab\u6211\u4eec\u8f6c\u5316\u6210\u4e86\u6c42\u89e3$\\sum\\limits_{i = 1}^n {\\sum\\limits_{j = 1}^m {((2*\\gcd (i,j) - 1) + 1) = } } \\sum\\limits_{i = 1}^n {\\sum\\limits_{j = 1}^m {(2*\\gcd (i,j) - 1)} }  = 2*\\sum\\limits_{i = 1}^n {\\sum\\limits_{j = 1}^m {(\\gcd (i,j)) - n*m} } $\n\n\u5176\u5b9e\u5c31\u662f\u6c42\u89e3$\\sum\\limits_{i = 1}^n {\\sum\\limits_{j = 1}^m {\\gcd ({\\rm{i,j}})} }$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u6211\u4eec\u53ef\u4ee5\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n\n\u6211\u4eec\u5148\u8bbe\u51fa$f(d) = \\sum\\limits_{i = 1}^n {\\sum\\limits_{j = 1}^m {[d =\\gcd (i,j)]} }$\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u6b64\u65f6\u7b54\u6848\u53d8\u6210\u4e86$ans = \\sum\\limits_{d = 1}^n {f(d)*d}$\n\n\u518d\u8bbe\u51fa$F(d) = \\sum\\limits_{i = 1}^n {\\sum\\limits_{j = 1}^m {[d|\\gcd (i,j)]} }$\n\n\u540c\u65f6\u4e5f\u4e0d\u96be\u53d1\u73b0$F(d) = \\left\\lfloor {\\frac{n}{d}} \\right\\rfloor \\left\\lfloor {\\frac{m}{d}} \\right\\rfloor$\n\n\u901a\u8fc7\u4e24\u4e2a\u5f0f\u5b50\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u4e0d\u96be\u60f3\u51fa\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14$\\mu$\u7684\u516c\u5f0f\n\n\u6211\u4eec\u8fdb\u884c\u4e00\u4e2a\u7b80\u5355\u7684\u6570\u5b66\u53d8\u6362\uff0c\u4f7f\u5f97\u679a\u4e3e$i|d$\u53d8\u4e3a\u679a\u4e3e$i$\n\n\u5c31\u53ef\u4ee5\u5f97\u5230\u516c\u5f0f$f(d) = \\sum\\limits_{i = 1}^{\\left\\lfloor {\\frac{n}{d}} \\right\\rfloor } {\\mu (i)} \\left\\lfloor {\\frac{n}{{d*i}}} \\right\\rfloor \\left\\lfloor {\\frac{m}{{d*i}}} \\right\\rfloor $\n\n\u7b54\u6848\u5c31\u53d8\u6210\u4e86\n\n$ans = \\sum\\limits_{d = 1}^n {d*} \\sum\\limits_{i = 1}^{\\left\\lfloor {\\frac{n}{d}} \\right\\rfloor } {\\mu (i)} \\left\\lfloor {\\frac{n}{{d*i}}} \\right\\rfloor \\left\\lfloor {\\frac{m}{{d*i}}} \\right\\rfloor $\n\n\u6839\u636e\u8c03\u548c\u7ea7\u6570\u5b9a\u7406\uff0c\u590d\u6742\u5ea6\u4e3a$O(ln(n)+H_n)$\u90a3\u4e2a$H_n$\u53ef\u4ee5\u770b\u6210\u5e38\u6570\n\n\u4ee3\u7801\u5f88\u597d\u5199,\u8dd1\u5f97\u4e5f\u4e0d\u6162\n\n```cpp\n#include<iostream>\n#include<stdio.h>\nusing namespace std;\nconst int maxn=100001;\nlong long int n,m,mu[maxn],ans,tot;\nlong long int p[maxn],np[maxn];\nvoid get_mu()\n{\n    mu[1]=1;\n    for(int i=2;i<=n;i++)\n    {\n        if(!np[i]) p[++p[0]]=i,mu[i]=-1;\n        for(int j=1;j<=p[0]&&p[j]*i<=n;j++)\n        {\n            int k=p[j]*i;\n            np[k]=1;\n            if(!(i%p[j])) break;\n            mu[k]=-mu[i];\n        }\n    }\n}\nvoid solve()\n{\n    cin>>n>>m;\n    get_mu();\n    for(int d=1;d<=n;d++) for(int i=1;i<=min(n,m)/d;i++)\n    ans+=d*mu[i]*(n/(d*i))*(m/(d*i));\n    cout<<(long long int)ans*2-n*m;\n}\nint main()\n{\n    solve();\n    return 0;\n} \n```",
        "postTime": 1506485702,
        "uid": 47497,
        "name": "FendtSilence",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1447 \u3010\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "dalao\u4eec\u7684\u9898\u89e3\u7ecf\u5e38\u957f\u8fd9\u6837\uff1a\u6c34\u9898\uff0c\u8d34\u4ee3\u7801\n\n\u6c34\u5417......\u672c\u849f\u84bb\u6cea\u6d41\u6ee1\u9762\u3002\n\n\u597d\u5427\u597d\u5427\uff0c\u90a3\u672c\u849f\u84bb\u5c31\u6765\u8ddf\u7740dalao\u63a8\u4e00\u63a8\u3002\n\n1.\u5bb9\u6613\u610f\u4f1a\u5f97\u5230\uff0c\u4e00\u9897\u5750\u6807\u4e3a(x,y)\u690d\u7269\u8fde\u7ebf\u4e0a\u7684\u690d\u7269\u6570\u91cf\u5c31\u662fgcd(x,y)-1;\n\n\u9898\u76ee\u4e2d\u7684\u5f0f\u5b50\u53d8\u4e00\u4e0b\uff0c\u4e3b\u8981\u77db\u76fe\u662f\u6c42$$ \\sum_{x=1}^n \\sum_{y=1}^m gcd(x,y) $$\n\n2.\u9996\u5148\u6709\u4e00\u6761\u7ed3\u8bba\uff1a\u4e00\u4e2a\u6570\u7684\u6240\u6709\u56e0\u5b50\u7684\u6b27\u62c9\u51fd\u6570\u4e4b\u548c\u7b49\u4e8e\u8fd9\u4e2a\u6570\u672c\u8eab\u3002\n\n\u7136\u540ex\u548cy\u7684\u516c\u56e0\u5b50\u80af\u5b9a\u662f\u4ed6\u4eec\u6700\u5927\u516c\u7ea6\u6570\u7684\u56e0\u5b50\uff0c\u6240\u4ee5\u5c31\u662f\u6c42$$\\sum_{x=1}^n \\sum_{y=1}^m \\sum_{d=1}^n[d|n\u4e14d|m] \\phi(d)$$\n3.\u968f\u4fbf\u4ea4\u6362\u5f8b\u4e00\u4e0b\u5f97\u5230\uff1a$$\\sum_{d=1}^n \\sum_{i=1}^n[d|n] \\sum_{j=1}^m[d|m]\\phi(d)*(n/i)*(m/i)$$\n\u6ce8\u610f\uff1an/i\u548cm/i\u662f\u5411\u4e0b\u53d6\u6574\uff0c\u4e0b\u540c\n\n4.\u73b0\u5728\u6c42\u8d77\u6765\u5c31\u65b9\u4fbf\u591a\u4e86\uff0c\u4e0d\u8fc7\u5462\uff0c\u8fd8\u6709\u4e00\u4e2a\u4f18\u5316\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u6570i\u6765\u8bf4\uff0c\u8bbe\u5b83\u7684$n/i=k_1,m/i=k_2$\uff0c\u5219\u540c\u6837\u6ee1\u8db3$n/j=k_1,m/j=k_2$\u7684\u6700\u5927$j=min(n/k_1,m/k_2);$\n\n5.\u6700\u540e\u628a\u5f97\u5230\u7684\u7ed3\u679c\u4e58\u4ee52\u518d\u51cf\u53bbm\\*n\u5373\u53ef\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<climits>\n#include<algorithm>\n#include<cstring>\nusing namespace std;\n#define ll long long\nll n,m,ans;int tot;\nbool is[1000010];\nint pri[1000010],phi[10000100];\nll sum[1000010];\nvoid init(){\n    ll i,j,k;\n    phi[1]=1;\n    for(i=2;i<=n;i++){\n        if(!is[i]){phi[i]=i-1;pri[++tot]=i;}\n        for(j=1;j<=tot;j++){\n            k=pri[j]*i;if(k>n)break;\n            is[k]=1;\n            if(i%pri[j]==0){phi[k]=(ll)phi[i]*pri[j];break;}\n            else phi[k]=(ll)(pri[j]-1)*phi[i];\n        }\n    }\n    for(i=1;i<=n;i++)sum[i]=sum[i-1]+phi[i];\n}\nint main()\n{\n    ll i,j;\n    scanf(\"%lld%lld\",&n,&m);\n    if(n>m)swap(n,m);\n    init();\n    for(i=1;i<=n;i=j+1){\n        j=min(m/(m/i),n/(n/i));\n        ans+=(ll)(sum[j]-sum[i-1])*(m/i)*(n/i);\n    }\n    ans=(ll)ans*2-(ll)n*m;\n    printf(\"%lld\",ans);\n    return 0;\n}\n```",
        "postTime": 1496064708,
        "uid": 20604,
        "name": "litble",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P1447 \u3010\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "## \u4e00\u9053\u7ec3\u4e60\u6570\u8bba\u7684\u597d\u9898\n\u65e5\u5e38\u4e22\u4eba\u3002   \n\u5f53\u6211\u770b\u5230\u8fd9\u5f20\u56fe\u65f6\uff0c\u6211\u8111\u5b50\u91cc\u60f3 \uff1a   \n\u8fd9\u4e0d\u5c31[\u4eea\u4ed7\u961f](https://www.luogu.com.cn/problem/P2158)\u5417 \uff1f  \n\u6b27\u62c9\u51fd\u6570\u8d70\u8d77\uff01   \n\u4f46\u6211\u4ed4\u7ec6\u4e00\u770b\uff1a  \n**\u201c\u80fd\u91cf\u6c47\u96c6\u673a\u5668\u5728\u6c47\u96c6\u7684\u8fc7\u7a0b\u4e2d\u6709\u4e00\u5b9a\u7684\u80fd\u91cf\u635f\u5931\u3002\u5982\u679c\u4e00\u68f5\u690d\u7269\u4e0e\u80fd\u91cf\u6c47\u96c6\u673a\u5668\u8fde\u63a5\u800c\u6210\u7684\u7ebf\u6bb5\u4e0a\u6709 kk \u68f5\u690d\u7269\uff0c\u5219\u80fd\u91cf\u7684\u635f\u5931\u4e3a 2k +1\u3002** \n  \n~~cao\u597d\u50cf\u4e0d\u592a\u4e00\u6837\u3002~~  \n\u4e8e\u662f\u5220\u4e86\u4ee3\u7801\u56de\u53bb\u63a8\u5f0f\u5b50  \u3002\n\n\u63a8\u51fa\u6765\u4e2a\n$$\n\\sum_{i=1}^n\\sum^m_{j=1}2*gcd(i,j)+1\n$$\n\n\u6211\u518d\u4e00\u60f3  \u3002  \n\u8fd9\u4e0d\u662f[SDOI\u90a3\u9053\u9898](https://www.luogu.com.cn/problem/P2303)\u5417\uff0c\u4e5f\u662f\u6b27\u62c9\u51fd\u6570\u3002  \n\u7b54\u6848\u597d\u50cf\u662f$\\phi(\\frac n d)$\u3002  \n\u7136\u540e\u5c31\u9505\u5230\u6b7b \u3002  \n~~\u4e8e\u662f\u6211\u5c31\u53bb\u53c2\u8003\u4e86\u9898\u89e3qwq\u3002~~\uff0c\u4f1a\u4e86\u3002  \n\u8003\u8651dp+\u5bb9\u65a5\uff08\u5176\u5b9e\u4e5f\u4e0d\u7b97dp\uff09\u3002  \ndp[i]\u8868\u793a**\u6700\u5927\u516c\u56e0\u6570**\u4e3ai\u7684\u6570\u5bf9\u6709\u51e0\u4e2a\u3002  \n\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c\u6211\u4eec\u6709**\u516c\u56e0\u6570**\u4e3ai\u7684\u6570\u5bf9\u6570\u4e3a$(\\frac n i*\\frac m i)$\u4e2a\u3002  \n\u8003\u8651\u5bb9\u65a5\uff0c\u8fd9\u91cc\u9762\u5305\u542b2i\uff0c3i\u2026\u2026\u7684\u60c5\u51b5\u3002  \n\u6240\u4ee5\u8981\u5206\u522b\u51cf\u6389\u4ed6\u4eec\u7684dp\u503c\u3002\n$$\ndp[i]=(\\frac n i)*(\\frac m i)-\\sum_{j=2}^{i*j<=min(n,m)}dp[i*j]\n$$\n\n\u7b54\u6848\u4e3adp[i]\u7684\u4e24\u500d\u51cf\u4e00\u3002  \n\u56e0\u4e3ai\u548cj\u53ef\u4ee5\u4e92\u6362\uff0c\u518d\u51cf\u53bb\u5b83\u4eec\u76f8\u7b49\u7684\u4e00\u79cd\u60c5\u51b5\u3002  \n\u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\n\nint n,m,ans;\nint dp[100009];\n\nsigned main()\n{\n\tscanf(\"%lld%lld\",&n,&m);\n\tfor(int i=n;i>=1;i--)\n\t{\n\t\tdp[i]=(n/i)*(m/i);\n\t\tfor(int j=2;j*i<=min(m,n);j++) dp[i]-=dp[i*j];\n\t}\n\tfor(int i=1;i<=n;i++) ans+=(i*2-1)*dp[i];\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1582250395,
        "uid": 237308,
        "name": "AlanSP",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1447 \u3010[NOI2010]\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "### \u4ee5\u4e0b\u8bbe$n\\ge m$\u3002\n\n\u9996\u5148,\u4e00\u4e2a\u70b9$(x,y)$\u5230$(0,0)$\u7684\u8def\u5f84\u4e0a\u7ecf\u8fc7\u7684\u70b9\u7684\u6570\u91cf(**\u4e0d\u5305\u62ec\u9996\u5c3e**)\u4e3a$gcd(x,y)-1$\u3002\n\n\u6240\u4ee5\u5b83\u7684\u80fd\u91cf\u635f\u8017\u4e3a$2\\times gcd(x,y)-1$\u3002\n\n\u8003\u8651\u5982\u4f55\u7edf\u8ba1$\\sum_{i=1}^n\\sum_{j=1}^m 2\\times gcd(i,j)-1$\u3002\n\n\u8bb0$f_x=\\sum_{i=1}^n\\sum_{j=1}^m[gcd(i,j)=x]$,\u5373$1\\le i\\le n,1\\le j\\le m$\u65f6,$gcd(i,j)=x$\u7684\u6570\u91cf\u3002\n\n\u6211\u4eec\u518d\u8bb0$F_x=\\sum_{x|i}f_i$\u3002\n\n~~\u83ab\u540d\u5176\u5999\u60f3\u5230\u4e86\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14,\u4f46\u662f\u5728\u8fd9\u91cc\u663e\u7136\u4e0d\u80fd\u7528~~\n\n\u6211\u4eec\u53d1\u73b0$F(x)$\u5176\u5b9e\u5c31\u662f\u6ee1\u8db3$1\\le i\\le n,1\\le j\\le m,i|x,j|x$\u7684$(i,j)$\u6570\u91cf,\u5373$\\lfloor\\frac{n}{x}\\rfloor\\lfloor\\frac{m}{x}\\rfloor$\u3002\n\n\u6211\u4eec\u8fd8\u53d1\u73b0$f_i=F_i-\\sum_{x=2}^{\\lfloor\\frac{n}{i}\\rfloor}f_{xi}$,\u5373$F_i$\u51cf\u53bb  $f_k$\u7684\u548c  ,\u5176\u4e2d$k$\u662f$i$\u7684\u500d\u6570\u4e14\u4e0d\u7b49\u4e8e$i$\u3002\n\n\u4e8e\u662f\u6211\u4eec**\u4ece\u5927\u5230\u5c0f**\u679a\u4e3e$i$\u5e76\u8ba1\u7b97$f_i$,\u7b54\u6848\u5c31\u662f$\\sum_{i=1}^n(2\\times i-1)\\times f_i$\u3002\n\n\u6839\u636e\u8c03\u548c\u7ea7\u6570,\u5176\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(nlogn)$\u3002\n\ncode:\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,m;\nlong long num[100010],ans;\nint main(){\n    scanf(\"%d%d\",&n,&m),n<m?swap(n,m),0:0;\n    for(int i=n;i>=1;--i){\n        num[i]=1ll*(n/i)*(m/i);\n        for(int j=i+i;j<=n;j+=i)num[i]-=num[j];\n        ans+=(2*i-1)*num[i];\n    }\n    printf(\"%lld\",ans);\n    return 0;\n}\n```",
        "postTime": 1547552468,
        "uid": 26294,
        "name": "xryjr233",
        "ccfLevel": 9,
        "title": "[2019.1.14]LuoguP1447/BZOJ2005 [Noi2010]\u80fd\u91cf\u91c7\u96c6(\u6570\u5b66)"
    },
    {
        "content": "[\u67e5\u770b\u539f\u9898\u8bf7\u6233\u8fd9\u91cc](https://www.luogu.org/problem/P1447)\n\n\u4e00\u5f00\u59cb\u4ee5\u4e3a\u9700\u8981\u7528\u7ebf\u6027\u7b5b\uff08\u5f53\u7136\u6211\u4e0d\u4f1a\uff09\uff0c\u540e\u6765\u624d\u77e5\u9053\u539f\u6765\u5bb9\u65a5\u4e00\u4e0b\u5c31\u53ef\u4ee5\u901a\u8fc7\u8fd9\u9053\u9898\u76ee\u2026\u2026\n\n\u9996\u5148\uff0c\u6709\u4e00\u4e2a\u5947\u602a\u7684\u7ed3\u8bba\uff1a\u6a2a\u7eb5\u5750\u6807gcd\u4e3a$k$\u7684\u70b9\u524d\u9762\u5171\u6709$k-1$\u4e2a\uff08\u5b83\u4eec\u7684gcd\u5206\u522b\u4e3a$1,2...k-1$\uff09\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u5bf9\u4e8e\u4e00\u4e2a$n\\times m$\u7684\u56fe\uff0c\u6a2a\u7eb5\u5750\u6807\u7684\u516c\u56e0\u6570\u542b\u6709$k$\u7684\u70b9\u5171\u6709$((n/k)\\times(m/k))$\u4e2a\uff0c\u5373\u5171\u6709$n/k$\u4e2a\u6a2a\u5750\u6807\u4e3a$k$\u7684\u500d\u6570\uff0c\u6709$m/k$\u4e2a\u7eb5\u5750\u6807\u4e3a$k$\u7684\u500d\u6570\uff0c\u90a3\u4e48\u70b9\u6570\u4e3a$((n/k)\\times(m/k))$\u4e2a\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u5feb\u901f\u9884\u5904\u7406\u51fa$x$\u5750\u6807\u548c$y$\u5750\u6807\u516c\u56e0\u6570\u4e3a$k$\u7684\u70b9\u3002\n\n\u7136\u540e\u6211\u4eec\u8003\u8651\u5bb9\u65a5\u3002\n\n\u6bd4\u5982\uff0c\u6211\u4eec\u8981\u6c42\u6a2a\u5750\u6807\u548c\u7eb5\u5750\u6807gcd\u4e3a$2$\u7684\u70b9\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u7528\u516c\u56e0\u6570\u5305\u542b$2$\u7684\u70b9\u51cf\u53bbgcd\u4e3a$4$\u7684\u70b9\u5728\u51cf\u53bbgcd\u4e3a$8$\u7684\u70b9\uff0c\u518d\u51cf\u53bbgcd\u4e3a$16$\u7684\u70b9\uff0c\u518d\u51cf\u53bb\u2026\u2026\n\n\u597d\u5427\uff0c\u8fd9\u4e2a\u5bb9\u65a5\u8c8c\u4f3c\u88ab\u9b54\u6539\u8fc7\u2026\u2026\n\n\u4f46\u662f\u5bb9\u65a5\u7684\u590d\u6742\u5ea6\u5f88\u5927\u600e\u4e48\u529e\uff1f\n\n\u6211\u4eec\u53ef\u4ee5\u4ece\u5927\u6570\u5411\u5c0f\u6570\u679a\u4e3e\uff0c\u6bd4\u5982\u6211\u4eec\u679a\u4e3e\u5230$4$\u65f6\uff0c\u6211\u4eec\u5c31\u76f4\u63a5\u628a\u5176\u4e2dgcd\u4e3a$4$\u7684\u500d\u6570\uff08\u9664\u4e86$4$\uff09\u7684\u70b9\u7684\u6570\u91cf\u76f4\u63a5\u5220\u53bb\u5c31\u597d\u4e86\u3002\n\ncode\uff1a\n\n```cpp\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\n#define ll long long\n#define INF 0x7fffffff\n#define re register\n\nusing namespace std;\n\nint read()\n{\n    register int x = 0,f = 1;register char ch;\n    ch = getchar();\n    while(ch > '9' || ch < '0'){if(ch == '-') f = -f;ch = getchar();}\n    while(ch <= '9' && ch >= '0'){x = x * 10 + ch - 48;ch = getchar();}\n    return x * f;\n}\n\nlong long n,m,cnt,ans,a[1000005];\n\nint main()\n{\n\tn = read(); m = read();\n\tfor(int i = 1; i <= n; i++) a[i] = (n / i) * (m / i);\n\tfor(int i = n; i >= 1; i--)\n\t{\n\t\tfor(int j = 2; j <= n / i; j++) a[i] = a[i] - a[i * j];\n\t\tans = ans + a[i] * (i * 2 - 1);\n\t}\n\tcout << ans << endl;\n    return 0;\n}\n```",
        "postTime": 1572342440,
        "uid": 150821,
        "name": "Azuree",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P1447 \u3010[NOI2010]\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "\u4e3a\u4ec0\u4e48\u9898\u89e3\u91cc\u6ca1\u6709\u4eba\u7528 $\\phi$ \u51fd\u6570\u8fea\u5229\u514b\u96f7\u5377\u79ef\u7684\u65b9\u6cd5\u505a\u5462\n\n\u9898\u610f\u7406\u89e3\u4e0d\u96be\uff0c\u5c31\u662f\u6c42\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u7684\u503c\uff1a\n\n## $\\sum_{i=1}^n \\sum_{j=1}^m (2\\times gcd(i,j)-1)$\n\n\u5c06\u4e00\u4e9b\u5e38\u6570\u9879\u53bb\u6389\u53ef\u8f6c\u5316\u4e3a\n\n## $2\\times\\sum_{i=1}^n \\sum_{j=1}^m  gcd(i,j)-mn$\n\n\u6240\u4ee5\u4e2d\u95f4\u7684\u90e8\u5206\u5c31\u662f\u6211\u4eec\u9700\u8981\u5173\u5fc3\u7684\u5185\u5bb9\n\n\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c$gcd$ \u8fd9\u4e2a\u4e1c\u897f\u5728\u6211\u4eec\u7684\u5f0f\u5b50\u4e2d\u51fa\u73b0\u662f\u5341\u5206\u70e6\u4eba\u7684\u3002\u5b9e\u9645\u4e0a\uff0c\u5982\u679c\u6211\u4eec\u628a\u5b83\u5206\u89e3\u6210 $gcd$ \u7684\u4e00\u4e9b\u56e0\u5b50\u5c31\u4f1a\u597d\u505a\u7684\u591a\u3002\n\n\uff08\u4e3a\u4ec0\u4e48\u975e\u5f97\u8fd9\u4e48\u505a\u5462\uff0c\u4e3b\u8981\u662f\u56e0\u4e3a\u4e24\u4e2a\u6570\u7684 $gcd$ \u7684\u6240\u6709\u56e0\u5b50\u80af\u5b9a\u662f**\u8fd9\u4e24\u4e2a\u6570\u7684\u6240\u6709\u516c\u56e0\u6570**\uff0c\u6240\u4ee5\u6211\u4eec\u8fd9\u4e48\u8f6c\u6362\u5c31\u628a $gcd$ \u7684\u5f71\u54cd\u6d88\u6389\u4e86\uff09\n\n\u8f6c\u5316\u53ef\u4ee5\u901a\u8fc7\u8fea\u5229\u514b\u96f7\u5377\u79ef\u5b8c\u6210\n\n~~\u4f17\u6240\u5468\u77e5~~\uff0c$\\phi*1=Id$\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c$\\sum_{d|n}\\phi(d)=n$ \uff0c\u5176\u4e2d $\\phi$ \u662f\u6b27\u62c9\u51fd\u6570\uff0c\u7528\u4e8e\u8ba1\u7b97\u6bd4\u67d0\u4e00\u4e2a\u6570\u5c0f\u4e14\u4e0e\u5b83\u4e92\u8d28\u7684\u6570\u7684\u4e2a\u6570\uff0c\u53ef\u4ee5 $O(n)$ \u9884\u5904\u7406~~\u65b9\u6cd5\u8bf7\u767e\u5ea6\u3002~~\n\n\u6240\u4ee5,$gcd(i,j)=\\sum_{k|gcd(i,j)}\\phi(k)=\\sum_{k|i,k|j}\\phi(k)$\n\n\u4e2d\u95f4\u7684\u5f0f\u5b50\u53d8\u4e3a\n## $\\sum_{i=1}^n \\sum_{j=1}^m\\sum_{k|i,k|j}\\phi(k)$\n\n\u6211\u4eec\u6539\u53d8\u679a\u4e3e\u7684\u65b9\u5f0f\uff0c\u5148\u679a\u4e3e $k$ \uff0c~~\u7384\u5b66\u8f6c\u6362\u4e00\u6ce2~~\n\n## $\\sum_{k=1}^{min(m,n)}\\phi(k)\\sum_{i=1}^{[\\frac{n}{k}]}\\sum_{j=1}^{[\\frac{m}{k}]}1$\n\n\n~~\u7b49\u4ef7\u4ec0\u4e48\u7684\u770b\u7740\u50cf\u5c31\u884c~~\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u7f29\u5c0f $i,j$ \u7684\u679a\u4e3e\u8303\u56f4\uff0c\u4f7f\u5f97\u679a\u4e3e\u5230\u7684 $i,j$ \u5b9e\u9645\u4e0a\u5bf9\u5e94\u7740 $ik$ \u4e0e $jk$\n\n\u4e8e\u662f\u540e\u9762\u7684\u4e1c\u897f\u53ef\u4ee5\u6539\u6210\u5e38\u6570\u6c42\n\n## $\\sum_{i=1}^{[\\frac{n}{k}]}\\sum_{j=1}^{[\\frac{m}{k}]}1={[\\frac{n}{k}]}{[\\frac{m}{k}]}$\n\n\u6700\u540e\u539f\u5f0f\u5373\u4e3a\n\n## $2\\times\\sum_{k=1}^{min(m,n)}\\phi(k){[\\frac{n}{k}]}{[\\frac{m}{k}]}-mn$\n\n\u66b4\u529b\u6c42\u548c\u5373\u53ef\n\n$O(n)$\u53cb\u5584\u7248\n\n```cpp\n#include<bits/stdc++.h>\n//#define TIME\nusing namespace std;\ntypedef long long ll;\nconst int maxn=100005;\nconst int inf=0x3f3f3f3f;\nconst int mod=998244353;\nll n,m;\nll phi[maxn];\nvector<ll> p;\nbool isp[maxn];\nvoid getphi(){\n\tmemset(isp,1,sizeof(isp));\n\tphi[1]=1;\n\tfor(int i=2;i<maxn;i++){\n\t\tif(isp[i]){\n\t\t\tp.push_back(i);\n\t\t\tphi[i]=i-1;\n\t\t}\n\t\tfor(int j=0;j<p.size();j++){\n\t\t\tif(i*p[j]>=maxn) break;\n\t\t\tisp[i*p[j]]=0;\n\t\t\tif(i%p[j]==0) phi[i*p[j]]=phi[i]*p[j];\n\t\t\telse phi[i*p[j]]=phi[i]*(p[j]-1);\n\t\t}\n\t}\n\treturn;\n}\nint main()\n{\n\tint i,j;\n\tcin>>n>>m;\n\tgetphi();\n    ll ans=0;\n\tfor(i=1;i<=min(n,m);i++){\n    \tans+=phi[i]*(n/i)*(m/i);\n    }\n    cout<<ans;\n\treturn 0;\n}\n\n```\n$O\\sqrt{n}$ \u6570\u8bba\u5206\u5757~~\u88c5\u903c~~\u7248\n\n```cpp\n#include<bits/stdc++.h>\n//#define TIME\nusing namespace std;\ntypedef long long ll;\nconst int maxn=100005;\nconst int inf=0x3f3f3f3f;\nconst int mod=998244353;\nll n,m;\nll phi[maxn];\nvector<ll> p;\nbool isp[maxn];\nvoid getphi(){\n\tmemset(isp,1,sizeof(isp));\n\tphi[1]=1;\n\tfor(int i=2;i<maxn;i++){\n\t\tif(isp[i]){\n\t\t\tp.push_back(i);\n\t\t\tphi[i]=i-1;\n\t\t}\n\t\tfor(int j=0;j<p.size();j++){\n\t\t\tif(i*p[j]>=maxn) break;\n\t\t\tisp[i*p[j]]=0;\n\t\t\tif(i%p[j]==0) phi[i*p[j]]=phi[i]*p[j];\n\t\t\telse phi[i*p[j]]=phi[i]*(p[j]-1);\n\t\t}\n\t}\n\tfor(int i=1;i<maxn;i++) phi[i]+=phi[i-1];\n\treturn;\n}\nll f(ll x,ll y){\n\tll cnt=0,l=1,r;\n\tif(x>y) swap(x,y);\n\twhile(l<=x){\n\t\tll t1=x/l,t2=y/l;\n\t\tr=min(x/t1,y/t2);\n\t\tcnt+=(phi[r]-phi[l-1])*t1*t2;\n\t\tl=r+1;\n\t}\n\treturn cnt;\n}\nint main()\n{\n\tint i,j;\n\tread(n,m);\n\tgetphi();\n\tcout<<2*f(n,m)-m*n;\n\treturn 0;\n}\n\n```",
        "postTime": 1548684554,
        "uid": 62948,
        "name": "Crabby_Maskiv",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P1447 \u3010[NOI2010]\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "\u81ea\u884c\u63a8\u4e86\u4e00\u756a\uff0c\u7136\u540eA\u4e86\uff0c\u901b\u4e86\u4e0b\u9898\u89e3\u533a\uff0c\u53d1\u73b0\u5927\u5bb6\u7684\u65b9\u6cd5\u90fd\u597d\u795e\u5947\u554a\u3002\u3002\u3002\n\n\u6211\u662f\u8fd9\u6837\u63a8\u7684:\n\n\u9996\u5148\uff0c$Ans=\\sum_{i=1}^{n}\\sum_{j=1}^{m}(2*gcd(i,j)-1)$,\u8fd9\u4e2a\u4e0d\u89e3\u91ca\u3002\u3002\u3002\n\n\u7136\u540e\uff0c\u6211\u4eec\u5c06\u5b83\u5206\u5f00:\n\n$Ans=2*\\sum_{i=1}^{n}\\sum_{j=1}^{m}gcd(i,j)-\\sum_{i=1}^{n}\\sum_{j=1}^{m}1$\n\n$=2*\\sum_{i=1}^{n}\\sum_{j=1}^{m}gcd(i,j)-n*m$\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u4e3b\u8981\u5c31\u662f\u8981\u6c42$\\sum_{i=1}^{n}\\sum_{j=1}^{m}gcd(i,j)$\u7684\u503c\n\n\u90a3\u4e48\uff0c\u6211\u4eec\u5957\u8def\u6027\u7684\u8bbe$f(x)=\\sum_{i=1}^{n}\\sum_{j=1}^{m}[gcd(i,j)=x]$,$F(d)=\\sum_{d|t}f(t)=\\lfloor\\frac{n}{d}\\rfloor*\\lfloor\\frac{m}{d}\\rfloor$\n\n\u53cd\u6f14\u4e00\u4e0b:$f(t)=\\sum_{t|d}u(\\frac{d}{t})*F(d)$\n\n\u800c$\\sum_{i=1}^{n}\\sum_{j=1}^{m}gcd(i,j)$\u5176\u5b9e\u5c31\u7b49\u4e8e$\\sum_{i=1}^{min(n,m)}f(i)*i$\n\n\u4ee3\u5165\u5f97:\n\n$\\sum_{i=1}^{n}\\sum_{j=1}^{m}gcd(i,j)$=$\\sum_{i=1}^{min(n,m)}f(i)*i$\n\n$=\\sum_{i=1}^{min(n,m)}\\sum_{i|j}u(\\frac{j}{i})*F(j)*i$\n\n$=\\sum_{i=1}^{min(n,m)}\\sum_{i|j}u(\\frac{j}{i})*\\lfloor\\frac{n}{j}\\rfloor*\\lfloor\\frac{m}{j}\\rfloor*i$\n\n\n\n\u5316\u7b80\u5230\u8fd9\u4e00\u6b65\uff0c\u4f60\u5c31\u53ef\u4ee5O(nlogn)AC\u4e86\uff0c\u8bb0\u5f97\u5904\u7406\u5269\u4e0b\u7684\u8ba1\u7b97\u54e6\uff01\n\n\u4ee3\u7801\u5982\u4e0b:\n```c\n#include<bits/stdc++.h>\n#define int long long//\u9632\u6b62\u7206int~ \nusing namespace std;\nconst int N=1e5+1;\nint u[N],zhi[N],e;//\u5206\u522b\u4e3a:\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570,\u8d28\u6570\u8868,\u8d28\u6570\u8868\u7684\u5927\u5c0f \nbool f[N];//\u5224\u65ad\u662f\u5426\u88ab\u7b5b\u53bb \ninline void sai(int maxe){//\u7ebf\u6027\u7b5b\uff0c\u7b5b\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570 \n\tu[1]=1;\n\tfor(int i=2;i<=maxe;++i){\n\t\tif(!f[i]){\n\t\t\tzhi[++e]=i;\n\t\t\tu[i]=-1;\n\t\t}\n\t\tfor(int j=1;j<=e;++j){\n\t\t\tif(i*zhi[j]>maxe){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tf[i*zhi[j]]=1;\n\t\t\tif(i%zhi[j]==0){\n\t\t\t\tu[i*zhi[j]]=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tu[i*zhi[j]]=-u[i];\n\t\t}\n\t}\n}\nsigned main(){\n\tsai(N-1);\n\tint n,m;\n\tscanf(\"%lld%lld\",&n,&m);\n\tint C=min(n,m);\n\tlong long ans=0;\n\tfor(int t=1;t<=C;++t){ \n\t\tfor(int d=t;d<=C;d+=t){\n\t\t\tans+=u[d/t]*(n/d)*(m/d)*t;//\u5e26\u516c\u5f0f\u8ba1\u7b97 \n\t\t}\n\t}\n\tans*=2;//\u8bb0\u5f97\u5b8c\u6210\u5269\u4e0b\u7684\u8ba1\u7b97 \n\tans-=(n*m);\n\tprintf(\"%lld\",ans);//\u8f93\u51fa\uff0cAC\uff01 \n\treturn 0;\n}\n\n```\n",
        "postTime": 1546503391,
        "uid": 81847,
        "name": "ThinkofBlank",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1447 \u3010[NOI2010]\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "#### Solution\n\u867d\u7136\u8fd9\u4e2a\u9898\u7684\u505a\u6cd5\u4e2d\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u505a\u6cd5\u5e76\u4e0d\u662f\u6700\u597d\u7684, \u4f46\u4ecd\u503c\u5f97\u5b66\u4e60.\n![](https://cdn.luogu.com.cn/upload/pic/21263.png)\n\n\u3000\u3000\u8fd9\u4e2a$h(T)$\u53ef\u4ee5\u901a\u8fc7\u679a\u4e3e\u56e0\u5b50\u5f97\u5230, \u4e5f\u53ef\u4ee5\u901a\u8fc7\u7ebf\u6027\u7b5b, \u4f1a\u53d1\u73b0\u8fd9\u4e2a\u51fd\u6570\u5c31\u662f**\u6b27\u62c9\u51fd\u6570**, \u5f53\u7136\u6211\u6ca1\u7528\u7ebf\u6027\u7b5b\u6c42$h(T)$, \u53cd\u800c\u662f\u901a\u8fc7\u590d\u6742\u5ea6\u4e3a$O(\\sqrt{T})$\u7684\u65b9\u6cd5\u6c42\u4e86\u51fa\u6765.\n\u8fd9\u662f\u6c42$h(i)$\u90e8\u5206\u7684\u4ee3\u7801\n```c++\n\tfor(int i=1;i<=n;++i)\n\t\tfor(int j=i;j<=n;j+=i)\n\t\t\tnumber[j]+=i*mu[j/i];\n```\n\u6c42\u51fa\u8fd9\u4e2a\u51fd\u6570\u4e4b\u540e, \u518d\u5229\u7528\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u4e2d\u5e38\u89c1\u7684\u6280\u5de7**\u9664\u6cd5\u5206\u5757**\u548c**\u524d\u7f00\u548c**\u5c31\u80fd\u901a\u8fc7\u6b64\u9898.\n#### Code\n```c++\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#define N 200005\nusing namespace std;\n\ntypedef long long ll;\n\nint tot;\nint mu[N];\nint sum[N];\nbool mark[N];\nint prime[N];\nll number[N];\n\nvoid getmu(int n){\n    mu[1]=1;\n    for(int i=2;i<=n;i++){\n    \tif(!mark[i]){\n    \t\tprime[++tot]=i;\n    \t\tmu[i]=-1;\n    \t}\n        for(int j=1;prime[j]*i<=n;j++){\n            if(prime[j]*i>=n)break;\n            mark[prime[j]*i]=1;\n            if(i%prime[j]==0){\n    \t\t\tmu[prime[j]*i]=0;\n    \t\t\tbreak;\n    \t\t}\n            mu[prime[j]*i]=-mu[i];\n        }\n    }\n\tfor(int i=1;i<=n;++i)\n\t\tfor(int j=i;j<=n;j+=i)\n\t\t\tnumber[j]+=i*mu[j/i];\n\tfor(int i=1;i<=n;++i)\n\t\tsum[i]=sum[i-1]+number[i];\n}    \nll query(int n,int m){\n    int last;\n    ll ans=0;\n    for(ll i=1;i<=min(n,m);i=last+1){\n        last=min(n/(n/i),m/(m/i));\n        ans+=(n/i)*(m/i)*(sum[last]-sum[i-1]);\n    }\n    return 2*ans-n*m;\n}\n\nint main(){\n    getmu(100000);\n    int n,m,T=1;\n    while(T--){\n        scanf(\"%d%d\",&n,&m);\n        printf(\"%lld\\n\",query(n,m));\n    }\n    return 0;\n}\n```",
        "postTime": 1529222755,
        "uid": 39067,
        "name": "aiyougege",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1447 \u3010[NOI2010]\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "\u8d3e\u5fd7\u9e4f\u7ebf\u6027\u7b5b\u6c42phi\u51fd\u6570\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u5230\u8fbe(x,y)\u7684\u6574\u70b9\u4e2a\u6570\u4e3agcd(x,y)-1\u4e2a\uff0c\u56e0\u4e3a\u8fd9\u91cc\u5b9e\u5728\u662f\u4e0d\u597d\u6253\u7b26\u53f7\uff0c\u7ed9\u4e2a\u5206\u6790\u8be6\u7ec6\u7684blog\u5427\u3002\n\n```cpp\n<http://blog.csdn.net/S_Black/article/details/51958938>%%%%\n#include<bits/stdc++.h>\n#define N 1000010\n#define ll long long\nusing namespace std;\nint prime[N],mu[N],d[N],c[N];\nll tot;\nll phi[N];\nbool vis[N];\nint f[N];\nvoid calcall(){\n    ll cnt=0;\n    memset(vis,true,sizeof(vis));\n    phi[1]=1;mu[1]=1;d[1]=1;\n    for(ll i=2;i<=tot;i++){\n        if(vis[i])prime[++cnt]=i,phi[i]=i-1,mu[i]=-1,d[i]=2,c[i]=1;\n        for(ll j=1;j<=cnt&&1LL*i*prime[j]<=tot;j++){\n            vis[i*prime[j]]=false;int t=i*prime[j];\n            if(i%prime[j]) phi[i*prime[j]]=phi[i]*(prime[j]-1),mu[t]-=mu[i],c[t]=1,d[t]=d[i]*2;\n        else { phi[i*prime[j]]=phi[i]*prime[j];mu[t]=0;\n        c[t]=c[i]+1;d[t]=d[i]/(c[i]+1)*(c[t]+1);break; }\n        }\n    }\n    //for test\n    for(int i=2;i<=tot;i++)phi[i]+=phi[i-1]; \n}\nll n,m;\nint main(){\n    scanf(\"%lld%lld\",&n,&m);tot=min(n,m);\n    calcall();\n    ll last=0,t=min(n,m);\n    ll ans=0;\n    for (int i=1;i<=t;i=last+1)\n    {\n        last=min(n/(n/i),m/(m/i));\n        ans+=(ll) (n/i)*(m/i)*(phi[last]-phi[i-1]);\n    }\n    ans=(ll)ans*2-n*m;\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1484709493,
        "uid": 2978,
        "name": "zcysky",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1447 \u3010\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "[\u5728\u849f\u84bb\u7684\u535a\u5ba2\u91cc\u67e5\u770b](https://xcfubuki.cn/2019/Mengbiwusi/)\n\n\u636e\u5927\u4f6c\u4eec\u8bf4\uff0c\u8fd9\u9898\u5c31\u662f\u6c42$(\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{m}gcd(i, j))*2-n*m$\n\n\u90a3\u4e48\u53ea\u8981\u6c42 $\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{m}gcd(i, j)$ \u5c31\u597d\u4e860v0\n\n#### $\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{m}gcd(i, j)$\n\n\u679a\u4e3e$gcd$\uff1a\n\n#### $\\sum\\limits_{k=1}^{n}k*\\sum\\limits_{i=1}^{n}\\sum\\limits_{J=1}^{m}[gcd(i,j)=k]$\n\n\u8001\u5957\u8def\u62ce\u51fa$k$\uff1a\n\n#### $\\sum\\limits_{k=1}^{n}k*\\sum\\limits_{i=1}^{\\lfloor n/k\\rfloor}\\sum\\limits_{J=1}^{\\lfloor m/k\\rfloor}[gcd(i,j)=1]$\n\n$gcd$ \u6539\u6210 $\\mu$\uff1a\n\n#### $\\sum\\limits_{k=1}^{n}k*\\sum\\limits_{i=1}^{\\lfloor n/k\\rfloor}\\sum\\limits_{j=1}^{\\lfloor m/k\\rfloor}\\sum\\limits_{d|gcd(i,j)}\\mu(d)$\n\n\u628a$d$ \u62ce\u5230\u5916\u9762\n\n#### $\\sum\\limits_{k=1}^{n}k*\\sum\\limits_{d=1}^{\\lfloor n/k\\rfloor}\\lfloor \\frac{n}{kd}\\rfloor \\lfloor \\frac{m}{kd}\\rfloor*\\mu(d)$\n\n\u6700\u540e\u628a $\\mu$ \u7b5b\u51fa\u6765\uff0c\u518d\u7528\u8fd9\u4e2a\u5f0f\u5b50\u5f04\u4e00\u4e0b\u5c31\u597d\u4e86\n\n\u53ef\u4ee5\u8bc1\u660e\u5176\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(n log n)\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#define maxn 100005\n\nusing namespace std;\n\nint n, m, mu[maxn], p[maxn], cnt;\nlong long ans = 0;\nbool vis[maxn];\n\nvoid Init()\n{\n\tvis[1] = 1, mu[1] = 1;\n\tfor (int i = 2; i < maxn; ++i)\n\t{\n\t\tif (!vis[i])\n\t\t\tp[++cnt] = i, mu[i] = -1;\n\t\tfor (int j = 1; j <= cnt && p[j] * i < maxn; ++j)\n\t\t{\n\t\t\tint x = i * p[j];\n\t\t\tvis[x] = 1, mu[x] = -mu[i];\n\t\t\tif (i % p[j] == 0)\n\t\t\t{\n\t\t\t\tmu[x] = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main()\n{\n\tfreopen(\"test.in\", \"r\", stdin);\n\tfreopen(\"test.out\", \"w\", stdout);\n\tInit();\n\tn = read(), m = read();\n\tif (n > m)\n\t\tswap(n, m);\n\tfor (int k = 1; k <= n; ++k)\n\t{\n\t\tint lim = n / k, res = 0;\n\t\tfor (int d = 1; d <= lim; ++d)\n\t\t\tres += (n / (k * d)) * (m / (k * d)) * mu[d];\n\t\tans += 1ll * res * k;\n\t}\n\tans = ans * 2 - n * m;\n\tprintf(\"%lld\\n\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1546566699,
        "uid": 32831,
        "name": "\u5439\u96ea\u5439\u96ea\u5439",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1447 \u3010[NOI2010]\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "\u4ec0\u4e48\u65f6\u5019\u6211\u8fd9\u79cd\u849f\u84bb\u4e5f\u5f00\u59cb\u770b$\\text{NOI}$\u7684\u9898\u4e86\u5462\uff1f\uff08\u9003\n\n\u597d\u5427\uff0c\u4e5f\u662f[$\\text{hkr04}$](https://www.luogu.org/space/show?uid=111528)\u8fd9\u4f4d\u795e\u7287\u4ecb\u7ecd\u6211\u770b\u7684\uff0c\u800c\u770b\u5230\u8fd9\u9053\u9898\u4e4b\u524d[$\\text{HKZeril}$](https://www.luogu.org/space/show?uid=66073)\u795e\u7287\u628a\u4e0e\u8fd9\u9898\u6709\u5173\u7684\u4e00\u4e2a\u7ed3\u8bba\u4ecb\u7ecd\u7ed9\u4e86\u6211\u3002\u5728\u6b64\u5411\u8fd9\u4e24\u4f4d\u795e\u7287\u8868\u793a\u6df1\u6df1\u7684\u8c22\u610f\uff01\n\n\u597d\u7684\uff0c\u8a00\u5f52\u6b63\u4f20\u3002\u6211\u4eec\u5148\u770b\u4e00\u4e2a\u7ed3\u8bba\uff08\u5b9a\u7406\uff09\u3002~~\u8fd9\u6b21\u4e0d\u4f1a\u662f\u4ec0\u4e48\u604b\u7231\u5faa\u73af\u5b9a\u7406\u5566~~\n\n\u5b9a\u7406 $2.33$ \u8bbe$A(0,0),B(n,m)(n,m\\in \\mathbb{N}_{+})$\uff0c\u90a3\u4e48\u7ebf\u6bb5$AB$\u4e0a\u6574\u70b9\u7684\u4e2a\u6570\u5373\u4e3a$\\gcd(n,m)+1$\u3002\n\n\u5982\u4f55\u8bc1\u660e\u8fd9\u4e2a\u5b9a\u7406\u5462\uff1f\n\n\u8bbe\u70b9$C(x,y)(x,y\\in \\mathbb{N})$\u5728\u7ebf\u6bb5$AB$\u4e0a\uff0c\u90a3\u4e48\u6709$\\frac{x}{n}=\\frac{y}{m}$\u3002\n\n\u8bbe$g=\\gcd(n,m),n'=\\frac{n}{g},m'=\\frac{m}{g}$\u3002\u5219\u4e0a\u5f0f\u53ef\u5316\u4e3a$\\frac{x}{n'}=\\frac{y}{m'}$\uff0c\u5219$xm'=yn'$\u3002\n\n\u7531$n'\\perp m'$\uff0c\u5f97$n'\\mid x,m'\\mid y$\u3002\u73b0\u5728\u53ef\u8bbe$k=\\frac{x}{n'}=\\frac{y}{m'}(k\\in \\mathbb{N})$\uff0c\u53c8\u7531\u7ebf\u6bb5\u7684\u6761\u4ef6\u77e5$0\\le k \\le g$\u3002\n\n\u6211\u4eec\u6784\u9020\u4e00\u4e2a\u70b9\u96c6$S=\\{(kn',km')\\mid k\\in \\mathbb{N}, 0\\le k\\le g\\}$\uff0c\u53ef\u4ee5\u53d1\u73b0\u70b9\u96c6\u4e2d\u7684\u70b9\u5168\u90e8\u90fd\u5728\u7ebf\u6bb5$AB$\u4e0a\u3002\u53c8\u6839\u636e\u4e0a\u9762\u7684\u8ba8\u8bba\u77e5\u9053\u7ebf\u6bb5$AB$\u4e0a\u7684\u6574\u70b9\u5fc5\u987b\u6ee1\u8db3\u96c6\u5408$S$\u7684\u6761\u4ef6\uff0c\u56e0\u6b64\u6211\u4eec\u5c31\u53ef\u4ee5\u4e0b\u5b9a\u8bba\uff1a$S$\u662f\u7ebf\u6bb5$AB$\u4e0a\u7684\u6240\u6709\u6574\u70b9\u7684\u96c6\u5408\u3002\u6613\u77e5$\\left| S \\right|=g+1$\u3002\u5b9a\u7406\u8bc1\u6bd5\u3002\n\n\u73b0\u5728\u8bf7\u770b\u9898\uff08\u9003\n\n[P1447 [NOI2010]\u80fd\u91cf\u91c7\u96c6](https://www.luogu.org/problemnew/show/P1447)\n\n\u8bfb\u9898\u5e76\u7ed3\u5408\u5b9a\u7406\uff0c\u8fd9\u9053\u9898\u8981\u6c42\u7684\u5c31\u662f$$2\\sum^{n}_{i=1}\\sum^{m}_{j=1}(\\gcd(i,j))-nm$$\n\n\uff08\u6ce8\u610f\u8fd9\u9898\u7684\u7ebf\u6bb5$AB$\u4e0d\u542b\u7aef\u70b9\uff0c\u56e0\u6b64\u6bcf\u4e00\u6761\u7ebf\u6bb5\u4e0a\u7684\u6574\u70b9\u6570\u5e94\u4e3a$\\gcd(i,j)-1$\u3002\uff09\n\n\u4e0a\u5f0f\u7684\u96be\u70b9\u5c31\u5728\u4e8e$\\sum^{n}_{i=1}\\sum^{m}_{j=1}\\gcd(i,j)$\u3002\u4e0b\u9762\u8bf7\u770b\u4e00\u4e9b\u795e\u5947\u7684\u63a8\u5bfc\uff01\n\n\u9996\u5148\uff0c\u6211\u4eec\u518d\u770b\u4e00\u4e2a\u5b9a\u7406\uff1a\n\n\u5b9a\u7406$2.333$  $\\text{ }\\varphi$\u51fd\u6570\u5bf9\u7ea6\u6570\u6c42\u548c\u5b9a\u7406 \uff08\u300a\u6570\u8bba\u5165\u95e8\u300b$\\text{P35}$\uff09\n\n$$\\forall n\\in \\mathbb{N_{+}},\\sum_{d\\mid n}\\varphi(d)=n$$\n\n\u8bc1\u660e\uff1a\u6839\u636e$\\varphi$\u51fd\u6570\u7684\u5b9a\u4e49\uff0c$\\varphi(n)$\u8868\u793a$[1,n]$\u4e2d\u4e0e$n$\u4e92\u8d28\u7684\u6574\u6570\u7684\u6570\u76ee\u3002\n\n\u8bbe$d\\mid n,n=kd(k\\in\\mathbb{N})$\uff0c\u8bbe\u96c6\u5408$S=\\{x\\in\\mathbb{N_{+}}\\mid x\\perp d\\}$\uff0c\u5219$\\left| S\\right|=\\varphi (d)$\u3002\u8bbe\u51fd\u6570$f:S\\rightarrow \\mathbb{N}$\uff0c$f(x)=kx$\u3002\u8bbe$f(x)$\u7684\u503c\u57df\u4e3a$S'$\u3002\u7531\u4e8e$f$\u662f\u5355\u5c04\uff0c\u56e0\u6b64$\\left|S'\\right|=\\left|S\\right|=\\varphi(d)$\u3002\n\n\u5bf9\u4e8e$S'$\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5143\u7d20$f(x)=kx$\uff0c\u7531\u4e8e$x\\perp d$\uff0c\u56e0\u6b64$\\gcd(f(x),n)=\\gcd(kx,kd)=k\\gcd(x,d)=k$\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u8bf4\uff0c$S'=\\{x\\in\\mathbb{N_{+}}\\mid \\gcd(x,n)=k\\}$\u3002\n\n$\\{k\\}$\u548c$\\{d\\}$\u4e2d\u7684\u5143\u7d20\u662f\u4e00\u4e00\u5bf9\u5e94\u7684\uff0c\u4e14\u4e0d\u540c$k$\u7684$S'$\u4e24\u4e24\u4e0d\u4ea4\uff0c\u56e0\u6b64$\\bigcup S'$\u5373\u4e3a$[1,n]\\cap\\mathbb{N}$\uff0c\u5b9a\u7406\u8bc1\u6bd5\u3002\n\n\u6839\u636e\u8fd9\u4e2a\u5b9a\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9$\\sum^{n}_{i=1}\\sum^{m}_{j=1}\\gcd(i,j)$\u8fd9\u4e2a\u5f0f\u5b50\u505a\u4e00\u4e9b\u4f3c\u4e4e\u65e0\u610f\u4e49\u7684\u53d8\u5f62\uff1a$$\\sum^{n}_{i=1}\\sum^{m}_{j=1}\\gcd(i,j)=\\sum^{n}_{i=1}\\sum^{m}_{j=1}\\sum_{d\\mid \\gcd(i,j)}\\varphi (d)=\\sum^{n}_{i=1}\\sum^{m}_{j=1}\\sum_{d\\mid i,d\\mid j}\\varphi (d)$$\n\n\u7136\u800c\uff0c\u8fd9\u4e00\u6b65\u53d8\u5f62\u5374\u662f$\\text{AC}$\u7684\u5f00\u59cb\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651\u66f4\u6362\u679a\u4e3e\u987a\u5e8f\uff08\u5373\u4ea4\u6362\u6c42\u548c\u53f7\u7684\u987a\u5e8f\uff09\u3002\n\n\u8003\u8651\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u6570$d$\uff0c$\\varphi(d)$\u4f1a\u88ab\u52a0\u51e0\u6b21\u5462\uff1f\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728$1\\le i\\le n,1\\le j\\le m$\u7684\u8303\u56f4\u5185\uff0c\u6709\u591a\u5c11\u5bf9$(n,m)$\u6ee1\u8db3$d\\mid i,d\\mid j$\u5462\uff1f\n\n\u5728\u8303\u56f4\u5185\uff0c$i$\u6709$\\lfloor \\frac{n}{d} \\rfloor$\u79cd\u9009\u6cd5\uff0c$j$\u6709$\\lfloor \\frac{m}{d} \\rfloor$\u79cd\u9009\u6cd5\uff0c\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u5bf9\u5c31\u6709$\\lfloor \\frac{n}{d} \\rfloor\\lfloor \\frac{m}{d} \\rfloor$\u4e2a\u3002\u4e8e\u662f$\\varphi(d)$\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4fbf\u662f$\\lfloor \\frac{n}{d} \\rfloor\\lfloor \\frac{m}{d} \\rfloor \\varphi(d)$\u3002\n\n\u5199\u5230\u8fd9\u91cc\uff0c\u7b54\u6848\u5df2\u7ecf\u547c\u4e4b\u6b32\u51fa\u4e86\uff0c\u4fbf\u662f\n$$\\sum^{\\min(n,m)}_{i=1}\\lfloor \\frac{n}{d} \\rfloor\\lfloor \\frac{m}{d} \\rfloor \\varphi(d)$$\n\n\u63a5\u4e0b\u6765\u7684\u4e8b\u60c5\u4fbf\u5341\u5206\u7b80\u5355\uff0c\u4f7f\u7528\u6b27\u62c9\u7b5b\uff08\u7ebf\u6027\u7b5b\uff09\u8ba1\u7b97\u51fa$\\varphi$\u51fd\u6570\u7684\u503c\uff0c\u518d\u76f4\u63a5\u6c42\u548c\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6$\\text{O}(n)$\u3002\n\n\u5f53\u7136\uff0c\u63a8\u5bfc\u5230\u8fd9\u4e00\u6b65\u9700\u8981\u5f88\u5f3a\u7684\u601d\u7ef4\u80fd\u529b\u3002\u4e3a\u4e86\u7b80\u5316\u601d\u7ef4\u96be\u5ea6\uff0c\u5927\u4f6c\u4eec\u7814\u53d1\u51fa\u4e86\u83ab\u6bd4\u4e4c\u65af~~\u7e41\u884d~~\u53cd\u6f14\u3001\u72c4\u5229\u514b\u96f7\u5377\u79ef\u7b49\u5de5\u5177\u3002\u8fd9\u9898\u5f53\u7136\u4e5f\u53ef\u4ee5\u7528\u8fd9\u4e9b\u65b9\u6cd5\u63a8\u5bfc\u5f0f\u5b50\u3002\n\n\u6700\u540e\u4e0a\u4ee3\u7801\u3002\n\n```cpp\n#include <iostream>\n#include <algorithm>\n#define MAXN 100005\nusing namespace std;\nvoid eular(int n); //\u7ebf\u6027\u7b5b\u6c42\u6b27\u62c9\u51fd\u6570\nint phi[MAXN]; //\u7528\u6765\u4fdd\u5b58\u6b27\u62c9\u51fd\u6570\u7684\u503c\nint minp[MAXN],prime[MAXN],pr; //\u8d28\u6570\u8868\uff0c\u7ebf\u6027\u7b5b\u7528\n\nint main(void){\n    int n,m;\n    long long ans=0;\n    cin >> n >> m;\n    if (n>m)\n        swap(n,m); //n=min(n,m)\n    eular(n);\n    for (int i=1;i<=n;i++)\n        ans+=((long long)(n)/i)*((long long)(m)/i)*phi[i];\n    ans*=2; //2\u500dgcd\u4e4b\u548c\n    ans-=(long long)(n)*m; //\u518d\u51cf\u53bbmn\n    cout << ans << endl;\n    return 0;\n}\n\nvoid eular(int n){\n    phi[1]=1;\n    int t;\n    for (int i=2;i<=n;i++){\n        if (!minp[i]){\n            minp[i]=i;\n            phi[i]=i-1; //phi(p)=p-1,\u5176\u4e2dp\u662f\u8d28\u6570\n            prime[pr++]=i;\n        }\n        for (int j=0;j<pr && (t=i*prime[j])<=n;j++){\n            minp[t]=prime[j]; //minp\u8868\u793a\u6700\u5c0f\u8d28\u56e0\u5b50\n            if (prime[j]==minp[i]){\n                phi[t]=prime[j]*phi[i];\n                break;\n            }\n            //else\n            phi[t]=(prime[j]-1)*phi[i];\n        }\n    }\n}\n```",
        "postTime": 1539866820,
        "uid": 25008,
        "name": "Sweetlemon",
        "ccfLevel": 9,
        "title": "\u5316\u795e\u5947\u4e3a\u8150\u673d\u7684\u6570\u8bba\u2014\u2014 \u80fd\u91cf\u91c7\u96c6 \u603b\u7ed3"
    },
    {
        "content": "\u7ecf\u8fc7\u5206\u6790,\u53d1\u73b0\u5f53\u67d0\u68f5\u690d\u7269\u4e0e\u673a\u5668\u7684\u8fde\u7ebf\u4e0a\u6ca1\u6709\u5176\u4ed6\u70b9\u65f6,\u8fd9\u68f5\u690d\u7269\u7684\u5750\u6807(x,y)\u5fc5\u5b9a\u6ee1\u8db3gcd(x,y)=1,\u635f\u5931\u80fd\u91cf\u4e3a1;\u800c\u5f53\u67d0\u68f5\u690d\u7269\u4e0e\u673a\u5668\u7684\u8fde\u7ebf\u4e0a\u6709\u5176\u4ed6\u70b9\u65f6,\u8fde\u7ebf\u4e0a\u70b9\u7684\u4e2a\u6570\u662fgcd(x,y)-1,\u635f\u5931\u80fd\u91cf\u4e3a(gcd(x,y)-1)\\*2+1 = gcd(x,y)\\*2-1\n\n\u8fd9\u662f\u9053\u826f\u5fc3\u9898,\u6309\u7167\u8fd9\u4e2a\u60f3\u6cd5\u66b4\u529b\u5206\u5c31\u8fbe\u5230\u4e8680\n\n\u6211\u4eec\u600e\u4e48\u4f18\u5316\u66b4\u529b\u5462?\u7528f[i]\u8868\u793agcd(x,y)=i\u7684\u70b9\u5bf9(x,y)\u6709\u591a\u5c11\u4e2a\n\n\u901a\u8fc7mn\u7684\u679a\u4e3e\u592a\u8d39\u65f6\u95f4\u4e86,\u6240\u4ee5\u6211\u4eec\u6362\u4e00\u79cd\u65b9\u6cd5\n\n\u5171\u6709m\u884cn\u5217\u690d\u7269(n\u662f\u6a2a\u5750\u6807,m\u662f\u7eb5\u5750\u6807),n/i\u662f\u6709\u591a\u5c11\u4e2a\u6a2a\u5750\u6807\u542b\u6709i\u8fd9\u4e2a\u56e0\u6570,m/i\u662f\u6709\u591a\u5c11\u4e2a\u7eb5\u5750\u6807\u542b\u6709i\u8fd9\u4e2a\u56e0\u6570,\u901a\u8fc7n/i\\*(m/i)\u5c31\u5f97\u5230\u4e86\u5728\u8fd9m\u884cn\u5217\u690d\u7269\u4e2d\u6709\u591a\u5c11\u68f5\u690d\u7269\u7684\u5750\u6807\u542b\u6709i\u8fd9\u4e2a\u516c\u56e0\u6570,\u4f46\u662f\u8fd9\u4e2a\u70b9\u5bf9\u7684\u6700\u5927\u516c\u56e0\u6570\u4e0d\u4e00\u5b9a\u662fi,\u6240\u4ee5\u8981\u51cf\u53bb\u542b\u67092i,3i,4i...\u516c\u56e0\u6570\u7684\u70b9\u6570\u6570\u91cf,\u8fd9\u624d\u80fd\u5f97\u5230\u6700\u7ec8\u9700\u8981\u7684f[i]\n\n\u6700\u540e\u7d2f\u8ba1\u7b54\u6848\u5c31\u597d\u4e86\n\nAC\u4ee3\u7801\n\n```cpp\n#include<cstdio>\nusing namespace std;\n#define ll long long\n#define R register \nint n,m;\nll f[100002];\ninline int gcd(int a,int b){\n    return b==0?a:gcd(b,a%b);\n}\nll sum;\ninline int dy(){\n    scanf(\"%d%d\",&n,&m);\n    if(n<m){\n        R int t=n; n=m; m=t;\n    }\n    for(R int i=n;i;--i){\n        f[i]=1ll*n/i*(m/i);\n        for(R int j=i+i;j<=n;j+=i) f[i]-=f[j];\n        sum+=f[i]*(2*i-1);\n    }\n    printf(\"%lld\\n\",sum);\n    return 0;\n}\nint QAQ = dy();\nint main(){;}\n```",
        "postTime": 1511321575,
        "uid": 36080,
        "name": "\u51cc\u5e7d",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1447 \u3010\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "\u628a\u6bcf\u4e00\u4e2a\u5750\u6807\u7684\u6700\u5927\u516c\u7ea6\u6570\\*2-1\uff0c\u800c\u516c\u7ea6\u6570\u4e2d\u6700\u5927\u7684\u4e00\u5b9a\u662fmin(n,m); so \u6211\u4eec\u53ef\u4ee5\u8bb0\u5f55\u516c\u7ea6\u6570\u7684\u591a\u5c11\uff0c\u4e5f\u5c31\u662f\u6bcf\u4e00\u4e2a\u6570\u4e00\u5171\u662f\u591a\u5c11\u4e2a\u70b9\u7684\u6700\u5927\u516c\u7ea6\u6570\uff0c\u8fd9\u4e2a\u561b\uff0c\u5012\u4e5f\u4e0d\u96be\uff0c1\u2014\u2014n\u4e2d\u6709n div i \u4e2a\u6570\u662fi\u7684\u500d\u6570\uff0c1\u2014\u2014m\u4e2d\u6709m div i \u4e2a\u6570\u662fi\u7684\u500d\u6570\uff0c\u7ec4\u5408\u4e00\u4e0b\u5c31\u662f\uff08n div i\uff09\\*\uff08m div i\uff09\u4e2a\u7ea6\u6570\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\nvar \n    n,m,i,j:longint;sum,ans:int64; \n    f:array[1..100000]of int64; \nbegin \n    readln(n,m);\n    if n<m then begin i:=n;n:=m;m:=i;end;\n    for i:=m downto 1 do begin \n        sum:=(int64(n div i))*(int64(m div i)); \n        for j:=2 to m div i do sum:=sum-f[i*j];\n            f[i]:=sum;ans:=ans+(2*i-1)*f[i];\n    end;\n    write(ans); \nend.\n```",
        "postTime": 1435655107,
        "uid": 3911,
        "name": "Skywalker_David",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1447 \u3010\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "\u770b\u8fd9\u9898\u4e4b\u524d \u5148\u6765\u51e0\u9053\u7c7b\u4f3c\u7684\n\n# [GCD SUM](<https://www.luogu.org/problem/P2398>)\n\n\u9898\u610f\u7b80\u5355\u660e\u4e86 \u5341\u5206\u53cb\u5584\n\n\u5982\u679c\u7528\u6b27\u62c9\u51fd\u6570\u7684\u65b9\u6cd5\u505a\u53ef\u4ee5\u5f88\u8f7b\u677e\u7684\u8fc7\u6389 \n\n\u8be6\u60c5\u8bf7\u770b[\u4eea\u4ed7\u961f](<https://www.luogu.org/problem/P2158>)\n\n![img](https://cdn.luogu.com.cn/upload/pic/1149.png)\n\n```cpp\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\n#include<cstring>\n#include<iostream>\nusing namespace std;\nint p[1000000],phi[1000000],vis[1010101];\nlong long ans;\nint  main(){\n\t\n    int n;\n    scanf(\"%d\",&n);\n    if(n==1){\n    \tcout<<0;\n    \treturn 0;\n\t}\n    phi[1]=1;\n    for(int i=2;i<=n;i++)\n    {\n    \tif(!vis[i])\n    \tp[++p[0]]=i,phi[i]=i-1;\n    \tfor(int j=1;j<=p[0]&&i*p[j]<=n;j++)\n    \t{\n    \t\tvis[i*p[j]]=1;\n    \t\tif(i%p[j]==0)\n    \t\t{\n    \t\t\tphi[i*p[j]]=phi[i]*p[j];\n    \t\t\tbreak;\n\t\t\t}\n\t\t\telse phi[i*p[j]]=phi[i]*(p[j]-1);\n\t\t}\n\t\t//ans+=phi[i];\n\t}\n\tn--;\n    ans=0;\n    for(int i=1;i<=n;i++)\n    {\n    \tans+=phi[i];\n\t}\n    cout<<ans*2+1;\n    return 0;\n}\n```\n\n\u4ee3\u7801\u4f1a\u53ca\u5176\u5197\u957f\n\n\u4f46\u662f\u5982\u679c\u6362\u4e2a\u601d\u8def\n\n![img](D:\\OneDrive - langlangago\\Pictures\\2608.png)\n\n\u89c2\u5bdf\u8fd9\u5f20\u56fe\u7247 \u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u51e0\u4e2a\u6027\u8d28\n\n1.\u76f8\u540c\u70b9\u7684\u6807\u53f7\u7b49\u4e8e\u4ed6\u4eec\u7684GCD\n\n2.\u8bbe\u4e00\u4e2a\u70b9\u5750\u6807\u4e3ax,y  \u4ee5gcd(x,y)\u4e3agcd\u7684\u4e2a\u6570\u7b49\u4e8e$(n/x)*(m/x)$\n\n3.\u8003\u8651\u5bf9\u7b2c\u4e8c\u6b65\u4ece\u53f3\u4e0a\u5230\u5de6\u4e0b\u5bb9\u65a5 \n\n![](http://101.200.56.58/wp-content/uploads/2019/10/%E5%9B%BE%E7%89%87.png)\n\n\u8fd9\u6837 \u6211\u4eec\u53ea\u9700\u8981\u679a\u4e3egcd\u5373\u53ef\n\n# p2398\n\n```cpp\n#include<cstdio>\nint main()\n{\n\tlong long n,m,a[100000],ans=0;\n\tscanf(\"%lld\",&n);m=n;\n\tfor(int i=1;i<=n;i++) a[i]=(n/i)*(m/i);\n\tfor(int i=n;i>=1;i--) {\n\t\tfor(int j=2;j<=n/i;j++)\n\t\t\ta[i]-=a[j*i];ans+=(a[i]*i);\n\t}\tprintf(\"%lld\",ans);\n}\n```\n\n# p1447\n\n```cpp\n#include<cstdio>\nint main()\n{\n\tlong long n,m,a[100000],ans=0;\n\tscanf(\"%lld%lld\",&n,&m);\n\tfor(int i=1;i<=n;i++) a[i]=(n/i)*(m/i);\n\tfor(int i=n;i>=1;i--) {\n\t\tfor(int j=2;j<=n/i;j++)\n\t\t\ta[i]-=a[j*i];ans+=(a[i]*(i*2-1));\n\t}\tprintf(\"%lld\",ans);\n}\n```\n\n",
        "postTime": 1572357459,
        "uid": 58064,
        "name": "COUPDETAT",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1447 \u3010[NOI2010]\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "\u4e00\u9053\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5165\u95e8\u9898\uff08\u5f53\u7136\u6211\u7684\u505a\u6cd5\u53ef\u80fd\u4e0d\u662f\u5f88\u4f18\u79c0\u6bd5\u7adf\u90fd\u6392\u523040\u9875\u5f00\u5916\u4e86\uff09\n\n\u6ce8\uff1a\u63a5\u4e0b\u6765\u6240\u6709\u516c\u5f0f\u4e2d\uff0c\u9ed8\u8ba4\u4e3a$n\u2264m$\u3002\n\n\u901a\u8fc7\u4ed4\u7ec6\u89c2\u5bdf\u53d1\u73b0\uff0c\u4e00\u4e2a\u70b9$(i,j)$\u5f15\u8d77\u7684\u80fd\u91cf\u635f\u5931\u4e3a$2gcd(i,j)-1$\u3002\n\n\u5176\u5b9e\u4e5f\u5f88\u597d\u8bc1\u660e\u3002\uff08\u968f\u4fbf\u4e71\u5199\u7684\u8bc1\u660e\uff09\n\n\u5bf9\u4e8e\u70b9$(i,j)$\uff0c\u8bbe\u5b83\u4eec\u7684\u6700\u5927\u516c\u56e0\u6570\u4e3a$gcd$\uff0c\u5219$(i,j)$\u53ef\u4ee5\u8868\u793a\u4e3a$(gcd\u00d7x,gcd\u00d7y)$\u3002\u663e\u7136\uff0c\u5982\u679c\u4e24\u4e2a\u70b9\u4e0e\u539f\u70b9\u7684\u8fde\u7ebf\u662f\u540c\u4e00\u6761\u76f4\u7ebf\uff0c\u5219\u5b83\u4eec\u7684\u659c\u7387\u76f8\u7b49\uff0c\u90fd\u7b49\u4e8e$\\frac{y}{x}$\u3002\u6240\u4ee5\u5728\u539f\u70b9\u4e0e$(i,j)$\u7684\u8fde\u7ebf\u4e0a\uff0c\u8fd8\u5b58\u5728$(x,y),(2x,2y),(3x,3y)\u2026\u2026((gcd-1)x,(gcd-1)y)$\u8fd9\u4e9b\u70b9\uff0c\u4e00\u5171\u6709$gcd-1$\u4e2a\uff0c\u635f\u5931\u7684\u80fd\u91cf\u4e3a$2(gcd-1)+1=2gcd-1$\u3002\n\n\u4e8e\u662f\u9898\u76ee\u8ba9\u6211\u4eec\u6c42\u7684\u4e1c\u897f\u5c31\u53d8\u6210\u4e86\n\n$\\sum_{i=1}^n\\sum_{j=1}^m(2gcd(i,j)-1)$\n\n\u7ecf\u8fc7\u7b80\u5355\u7684\u5316\u7b80\u4e4b\u540e\u53d8\u4e3a\n\n\n$2\\sum_{i=1}^n\\sum_{j=1}^mgcd(i,j)-nm$\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u8003\u8651\u5982\u4f55\u8ba1\u7b97\n\n$sum=\\sum_{i=1}^n\\sum_{j=1}^mgcd(i,j)$\n\n\u6211\u4eec\u628a$d=gcd(i,j)$\u4f5c\u4e3a\u679a\u4e3e\u7684\u9879\u540e\u53d8\u4e3a\n\n$sum=\\sum_{d=1}^nd\\sum_{i=1}^n\\sum_{j=1}^m[gcd(i,j)=d]$\n\n=$\\sum_{d=1}^nd\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}[gcd(i,j)=1]$\n\n\u6211\u4eec\u8bbe$s(x,y)$\u8868\u793a$\\sum_{i=1}^x\\sum_{j=1}^y[gcd(i,j)=1]$\uff0c\u5219\u4e0a\u5f0f\u53ef\u4ee5\u8868\u793a\u4e3a$sum=\\sum_{d=1}^nd\u00d7s(\\lfloor\\frac{n}{d}\\rfloor,\\lfloor\\frac{m}{d}\\rfloor)$\uff0c\u663e\u7136\u53ef\u4ee5\u7528\u6574\u9664\u5206\u5757\u89e3\u51b3\u3002\u5173\u952e\u5728\u4e8e\u5982\u4f55\u8ba1\u7b97$s(x,y)$\u3002\n\n\u8fd9\u4e5f\u662f\u4e00\u9053\u7ecf\u5178\u9898\u4e86\u3002\u8c8c\u4f3c\u53ef\u4ee5\u5229\u7528$\\varphi$\u6765\u89e3\u51b3\uff0c\u4f46\u65b9\u6cd5\u662f\u591a\u5143\u5316\u7684\uff0c\u8fd9\u91cc\u4f7f\u7528\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u6765\u505a\u3002\n\n\u6211\u4eec\u8bbe$f(x)=\\sum_{i=1}^n\\sum_{j=1}^m[gcd(i,j)=x]$\n\n$g(x)=\\sum_{x|d}f(d)=\\sum_{i=1}^n\\sum_{j=1}^m[x|gcd(i,j)]=\\lfloor\\frac{n}{x}\\rfloor\\lfloor\\frac{m}{x}\\rfloor$\n\n\u53cd\u6f14\u56de\u53bb\u5f97$f(x)=\\sum_{x|d}\\mu(\\frac{d}{x})g(d)$\n\n\u6211\u4eec\u8981\u6c42\u7684\u662f$f(1)$\u7684\u503c\uff0c\u6240\u4ee5\u5f97$s(n,m)=f(1)=\\sum_{d=1}^n\\mu(d)g(d)=\\sum_{d=1}^n\\mu(d)\\lfloor\\frac{n}{d}\\rfloor\\lfloor\\frac{m}{d}\\rfloor$\n\n\u9884\u5904\u7406$\\mu$\u7684\u524d\u7f00\u548c\u518d\u52a0\u4e0a\u6574\u9664\u5206\u5757\u53ef\u4ee5\u5728$\\sqrt{n}$\u7684\u65f6\u95f4\u5185\u7b97\u51fa\u3002\u522b\u5fd8\u4e86\u5916\u9762\u8fd8\u6709\u4e00\u5c42\u6574\u9664\u5206\u5757\u5957\u7740\uff0c\u4e8e\u662f\u5206\u5757\u5957\u5206\u5757\u6211\u5c31\u4e0d\u4f1a\u7b97\u65f6\u95f4\u590d\u6742\u5ea6\u4e86$QAQ$\uff0c\u5b9e\u6d4b\u8dd1\u7684\u5f88\u5feb\u3002\n\n\uff08\u7b2c\u4e00\u6b21\u5199\u6570\u8bba\u9898\u89e3\uff0c\u6240\u4ee5\u5199\u7684\u4e0d\u597d\u8bf7\u6307\u6b63\uff09\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nconst int N=200000;\n\nint n,m,mul[N],prime[N],len;\nbool vis[N];\n\nll f(int n,int m)\n{\n\tint i=1;ll ans=0;\n\twhile (i<=n)\n\t{\n\t\tint j=min(n/(n/i),m/(m/i));\n\t\tans+=(ll)(mul[j]-mul[i-1])*(n/i)*(m/i);\n\t\ti=j+1;\n\t}\n\treturn ans;\n}\n\nll sum(int n,int m)\n{\n\tint i=1;ll ans=0;\n\twhile (i<=n)\n\t{\n\t\tint j=min(n/(n/i),m/(m/i));\n\t\tans+=f(n/i,m/i)*(ll)(j+i)*(ll)(j-i+1)/2;\n\t\ti=j+1;\n\t}\n\treturn ans;\n}\n\nint main()\n{\n\tcin>>n>>m;\n\tif (n>m) swap(n,m);\n\tmul[1]=1;\n\tfor (int i=2;i<=m;i++)\n\t{\n\t\tif (!vis[i]) {mul[i]=-1;prime[++len]=i;}\n\t\tfor (int j=1;j<=len&&i*prime[j]<=n;j++)\n\t\t{\n\t\t\tvis[i*prime[j]]=true;\n\t\t\tif (i%prime[j]==0) {mul[i*prime[j]]=0;break;}\n\t\t\t\telse mul[i*prime[j]]=-mul[i];\n\t\t}\n\t}\n\tfor (int i=1;i<=m;i++) mul[i]+=mul[i-1];\n\tprintf(\"%lld\\n\",sum(n,m)*2-(ll)n*m);\n}\n```\n",
        "postTime": 1557209390,
        "uid": 29575,
        "name": "Holy_Push",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1447 \u3010[NOI2010]\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "#### Preface\n\n\u6700\u8fd1**\u53cd\u6f14**\u9898\u505a\u591a\u4e86\u770b\u4ec0\u4e48\u90fd\u60f3\u53cd\u6f14\u3002\u8fd9\u9053\u9898\u7531\u4e8e**\u6570\u636e\u5f31**\uff0c\u89e3\u6cd5\u591a\u79cd\u591a\u6837\uff0c\u8fd9\u91cc\u7b80\u5355\u5206\u6790\u4e00\u4e0b\u3002\n\n\u9996\u5148\u8f6c\u5316\u4e0b\u9898\u76ee\u5c31\u662f\u5bf9\u4e8e\u4e00\u4e2a\u70b9$(x,y)$\uff0c\u6240\u6d88\u8017\u7684\u80fd\u91cf\u5c31\u662f$2(\\gcd(x,y)-1)+1=2\\cdot\\gcd(x,y)-1$\uff08**\u5c0f\u5b66\u5965\u6570\u9898**\uff09\n\n\u6240\u4ee5\u6c42\u548c\u5c31\u662f\u6c42$\\sum_{i=1}^n\\sum_{j=1}^m2\\cdot\\gcd(i,j)-1=2\\cdot\\sum_{i=1}^n\\sum_{j=1}^m\\gcd(i,j)-nm$\uff0c\u56e0\u6b64\u4e3b\u8981\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u6c42\u89e3$\\sum_{i=1}^n\\sum_{j=1}^m\\gcd(i,j)$\uff08\u5bf9\u4e8e\u53cd\u6f14\u6765\u8bf4\uff0c**\u5bb9\u65a5**\u7684\u8bdd\u76f4\u63a5\u600e\u4e48\u66b4\u529b\u600e\u4e48\u6765\uff09\n\n------\n\n#### \u4e00.\u8f6c\u5316+\u9012\u63a8+\u5bb9\u65a5\u6cd5\n\n\u9996\u5148\u8f6c\u5316\u95ee\u9898\uff0c\u6211\u4eec\u8003\u8651\u6bcf\u4e00\u4e2a\u6570\u5f53\u5b83\u4f5c\u4e3a\u5176\u5b83\u4e24\u4e2a\u6570\u7684$\\gcd$\u65f6\u4f1a\u4ea7\u751f\u591a\u5c11\u8d21\u732e\u3002\n\n\u5148\u628a\u95ee\u9898\u7b80\u5355\u5316\uff0c\u6211\u4eec\u5148\u6c42\u51fa\u4e00\u4e2a\u6570\u4e3a\u5176\u5b83\u4e24\u4e2a\u6570\u7684**\u7ea6\u6570**\u7684\u65b9\u6848\u6570$f(i)$\uff0c\u663e\u7136~~\u5c0f\u5b66\u751f\u90fd\u77e5\u9053~~$f(i)=\\lfloor\\frac{n}{i} \\rfloor\\lfloor\\frac{m}{i} \\rfloor$\n\n\u4f46\u662f\u53ef\u80fd$f(i)$\u4f1a\u591a\u7b97\u5f53$i|j$\u65f6$j$\u7684\u8d21\u732e\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u51cf\u6389$\\sum_{i|j} f(j)$\n\n\u56e0\u6b64\u6211\u4eec**\u4ece\u5927\u5230\u5c0f**\u679a\u4e3e\u5e76\u8ba1\u7b97$f(i)$\u5373\u53ef\uff0c\u7ed3\u5408**\u8c03\u548c\u7ea7\u6570**\u7684\u516c\u5f0f\u53d1\u73b0\u590d\u6742\u5ea6\u4e3a$O(n(\\ln(n)+H_n))$\uff08$H_n$\u662f**\u6b27\u62c9\u5e38\u6570**\uff09\n\nCODE\n\n```cpp\n#include<cstdio>\n#define RI register int\nusing namespace std;\nint n,m,lim; long long ans,f[100005];\ninline int min(int a,int b)\n{\n    return a<b?a:b;\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&m); lim=min(n,m);\n    for (RI i=lim;i;--i)\n    {\n        f[i]=1LL*(n/i)*(m/i);\n        for (RI j=i<<1;j<=lim;j+=i) f[i]-=f[j];\n        ans+=1LL*((i<<1LL)-1)*f[i];\n    }\n    return printf(\"%lld\",ans),0;\n}\n```\n\n\n\n------\n\n#### \u4e8c.\u6211\u7684\u849f\u84bb\u53cd\u6f14\u505a\u6cd5\n\n\u53cd\u6f14\u9898\u505a\u7684\u591a\u4e86\u5c31\u7b97\u662f\u50cf\u6211\u8fd9\u6837\u7684**\u849f\u84bb**\u4e5f\u80fd\u81ea\u5df1\u63a8\u4e00\u63a8\u4e86\u3002\n\n\u611f\u89c9\u8fd9\u4e2a\u5f88\u5957\u8def\u5c31\u90a3\u4ee5\u524d\u7684\u5957\u8def\u53bb\u5957~~\u7ed3\u679c5min\u5c31\u641e\u51fa\u6765\u4e00\u4e2a\u770b\u4e0a\u53bb\u5f88\u6b63\u786e\u7684\u5f0f\u5b50~~\u7136\u540e\u5c31\u8fc7\u4e86\u3002\n\n\u8fd9\u91cc\u8bb2\u4e00\u8bb2\u6211\u7684\u505a\u6cd5\uff0c\u6839\u636e\u4e4b\u524d\u505a\u7684\u4e00\u4e9b\u53cd\u6f14\u9898\uff08\u5982[Luogu P2257 YY\u7684GCD](https://www.cnblogs.com/cjjsb/p/9852268.html)\uff09\u6211\u4eec\u5f88\u5957\u8def\u7684\u6765\uff1a\n\n\u4ee4$f(d)$\u4e3a$\\gcd(i,j)(i\\in[1,n],j\\in[1,m])=d$\u7684\u4e2a\u6570\uff0c$F(s)$\u4e3a$d|\\gcd(i,j)$\u7684\u4e2a\u6570\n\n\u5373\uff1a\n\n$$f(d)=\\sum_{i=1}^n\\sum_{j=1}^m [\\gcd(i,j)=d]$$\n\n$$F(s)=\\sum_{s|d}f(d)=\\lfloor\\frac{n}{s} \\rfloor \\lfloor\\frac{m}{s} \\rfloor$$\n\n\u8003\u8651\u6240\u6c42\uff0c\u5219\u6709\uff1a\n\n$ans=\\sum_{d=1}^{\\min(n,m)}f(d)\\cdot d$\n\n\u8fd8\u662f\u7528**\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5b9a\u7406**\uff0c\u5f97\u5230\uff1a\n\n$$f(d)=\\sum_{d|s} \\mu(\\lfloor\\frac{s}{d} \\rfloor)F(s)$$\n\n\u628a$F(s)=\\lfloor\\frac{n}{s} \\rfloor \\lfloor\\frac{m}{s} \\rfloor$\u4ee3\u8fdb\u53bb\u6709\uff1a\n\n$$f(d)=\\sum_{d|s} \\mu(\\lfloor\\frac{s}{d} \\rfloor)\\lfloor\\frac{n}{s} \\rfloor \\lfloor\\frac{m}{s} \\rfloor$$\n\n\u4e00\u4e2a\u7b80\u5355\u7684\u5957\u8def\uff0c\u628a\u679a\u4e3e$d$\u53d8\u6210$n$\u662f$d$\u7684\u591a\u5c11\u500d\uff0c\u5373\uff1a\n\n$$f(d)=\\sum_{i=1}^{\\lfloor\\frac{n}{d} \\rfloor} \\mu(i)\\lfloor\\frac{n}{d\\cdot i} \\rfloor \\lfloor\\frac{m}{d\\cdot i} \\rfloor$$\n\n\u518d\u628a\u8fd9\u4e2a\u4ee3\u56de\u53bb\u5c31\u6709\uff1a\n\n$$ans=\\sum_{d=1}^{\\min(n,m)} d\\cdot\\sum_{i=1}^{\\lfloor\\frac{n}{d} \\rfloor} \\mu(i)\\lfloor\\frac{n}{d\\cdot i} \\rfloor \\lfloor\\frac{m}{d\\cdot i} \\rfloor$$\n\n\u8fd8\u8981\u5316\u7b80\u4e48\uff1f\u6211\u4eec\u770b\u770b\u8fd9\u9053\u9898\u7684\u6570\u636e\u8303\u56f4\uff0c$n,m\\le100000$\uff0c\u800c\u4e14\u662f**\u5355\u7ec4\u8be2\u95ee**\n\n\u56e0\u6b64\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50\u7684\u590d\u6742\u5ea6\u6839\u636e**\u8c03\u548c\u7ea7\u6570\u5b9a\u7406**\u4e3a$O(n(\\ln(n)+H_n))$\uff0c\u56e0\u6b64**\u66b4\u529b**\u5373\u53ef\u8fc7\n\nCODE\n\n```cpp\n#include<cstdio>\n#define RI register int\nusing namespace std;\nconst int P=100000;\nint prime[P+5],cnt,phi[P+5],n,m,lim; bool vis[P+5]; long long ans,sum[P+5];\n#define Pi prime[j]\ninline void Euler(void)\n{\n\tvis[1]=phi[1]=1; RI i,j; for (i=2;i<=P;++i)\n\t{\n\t\tif (!vis[i]) prime[++cnt]=i,phi[i]=i-1;\n\t\tfor (RI j=1;j<=cnt&&i*Pi<=P;++j)\n\t\t{\n\t\t\tvis[i*Pi]=1; if (i%Pi) phi[i*Pi]=phi[i]*(Pi-1);\n\t\t\telse { phi[i*Pi]=phi[i]*Pi; break; }\n\t\t}\n\t}\n\tfor (i=1;i<=P;++i) sum[i]=sum[i-1]+phi[i];\n}\ninline int min(int a,int b)\n{\n\treturn a<b?a:b;\n}\nint main()\n{\n\tscanf(\"%d%d\",&n,&m); Euler(); lim=min(n,m);\n\tfor (RI l=1,r;l<=lim;l=r+1)\n\t{\n\t\tr=min(n/(n/l),m/(m/l)); ans+=1LL*(n/l)*(m/l)*(sum[r]-sum[l-1]);\n\t}\n\treturn printf(\"%lld\",(ans<<1LL)-1LL*n*m),0;\n}\n```\n\n------\n\n#### \u4e09.\u5229\u7528\u72c4\u5229\u514b\u96f7\u5377\u79ef\u518d\u52a0\u901f\n\n\u6211\u4eec\u60f3\u4e00\u4e0b\uff0c\u5982\u679c\u8fd9\u9898\u591a\u7ec4\u8be2\u95ee\u600e\u4e48\u529e~~\u4e0d\u4fdd\u8bc1\u6bd2\u7624\u51fa\u9898\u4eba\u4e0d\u4f1a\u51fa~~\n\n\u56e0\u6b64\u6211\u4eec\u601d\u8003\u5e94\u8be5\u8fd8\u6709\u66f4**\u4f18\u79c0**\u7684\u505a\u6cd5~~\u4e8b\u5b9e\u4e0a\u4e5f\u662f\u6709\u7684~~\n\n\u4ece\u7b2c\u4e8c\u79cd\u505a\u6cd5\u7684$f(d)=\\sum_{d|s} \\mu(\\lfloor\\frac{s}{d} \\rfloor)\\lfloor\\frac{n}{s} \\rfloor \\lfloor\\frac{m}{s} \\rfloor$\u5f00\u59cb\uff0c\u6211\u4eec\u4ee4$T=ds$\uff0c\u5219\u6709\uff1a\n\n$$f(d)=\\sum_{T=1}^{\\min(n,m)}\\lfloor\\frac{n}{T} \\rfloor\\lfloor\\frac{m}{T} \\rfloor\\sum_{d|T}\\mu(\\lfloor\\frac{T}{d} \\rfloor)$$\n\n\u7531\u4e8e\u7ecf\u5178\u7684**\u72c4\u5229\u514b\u96f7\u5377\u79ef**\u6211\u4eec\u77e5\u9053$\\mu$\u7684\u4e00\u4e2a\u6027\u8d28\uff1a$\\sum_{d|n}d\\cdot\\mu(\\lfloor\\frac{n}{d} \\rfloor)=\\phi(n)$\n\n\uff08\u8fd9\u4e2a\u8c8c\u4f3c\u4e5f\u53ef\u4ee5\u7528**\u6b27\u62c9\u51fd\u6570**\u7684\u6027\u8d28$\\sum_{d|n}\\phi(d)=n$\u518d**\u53cd\u6f14**\u5f97\u6765~~\u53cd\u6b63\u6211\u4e0d\u4f1a\u8bc1~~\uff09\n\n\u6240\u4ee5\u5230\u73b0\u5728\u5c31\u5f88\u7b80\u5355\u4e86\uff0c\u628a\u8fd9\u4e2a\u4ee3\u8fdb\u53bb\u5c31\u6709\uff1a\n\n$$ans=\\sum_{T=1}^{\\min(n,m)}\\lfloor\\frac{n}{T} \\rfloor\\lfloor\\frac{m}{T} \\rfloor\\cdot\\phi(T)$$\n\n\u7136\u540e\u5c31\u662f$O(n)$\u7684\u5f0f\u5b50\u4e86\uff0c\u5f53\u7136\uff0c\u8fd9\u4e2a\u660e\u663e\u4e5f\u53ef\u4ee5\u505a\u4e00\u53d1**\u6b27\u62c9\u51fd\u6570\u7684\u524d\u7f00\u548c**\u7ed3\u5408**\u9664\u6cd5\u5206\u5757**\u505a\u5230\u5355\u6b21\u8be2\u95ee$O(\\sqrt {\\min(n,m))}$\u7684\u3002\u56e0\u6b64\u591a\u7ec4\u8be2\u95ee\u4e5f\u4e0d\u518d\u8bdd\u4e0b\u3002\n\nCODE\n\n```cpp\n#include<cstdio>\n#define RI register int\nusing namespace std;\nconst int P=100000;\nint prime[P+5],cnt,phi[P+5],n,m,lim; bool vis[P+5]; long long ans,sum[P+5];\n#define Pi prime[j]\ninline void Euler(void)\n{\n    vis[1]=phi[1]=1; RI i,j; for (i=2;i<=P;++i)\n    {\n        if (!vis[i]) prime[++cnt]=i,phi[i]=i-1;\n        for (RI j=1;j<=cnt&&i*Pi<=P;++j)\n        {\n            vis[i*Pi]=1; if (i%Pi) phi[i*Pi]=phi[i]*(Pi-1);\n            else { phi[i*Pi]=phi[i]*Pi; break; }\n        }\n    }\n    for (i=1;i<=P;++i) sum[i]=sum[i-1]+phi[i];\n}\ninline int min(int a,int b)\n{\n    return a<b?a:b;\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&m); Euler(); lim=min(n,m);\n    for (RI l=1,r;l<=lim;l=r+1)\n    {\n        r=min(n/(n/l),m/(m/l)); ans+=1LL*(n/l)*(m/l)*(sum[r]-sum[l-1]);\n    }\n    return printf(\"%lld\",(ans<<1LL)-1LL*n*m),0;\n}\n```\n\n------\n\n#### Postscript\n\n\u8fd9\u771f\u662f\u4e00\u9053\u5f88\u4e0d\u9519\u7684\u6570\u5b66\u9898\uff0c\u4e0a\u9762\u7684\u4e09\u79cd\u505a\u6cd5\u611f\u89c9\u90fd\u53ef\u4ee5\u3002\n\n\u7136\u800c\u7406\u8bba\u590d\u6742\u5ea6\u6700\u4f18\u7684[\u7b97\u6cd5\u4e09](https://www.luogu.org/record/show?rid=12521705)\u8dd1\u7684\u548c[\u7b97\u6cd5\u4e8c](https://www.luogu.org/record/show?rid=12519795)\u4e00\u6837\u3002\u4f30\u8ba1\u662f\u9664\u6cd5\u505a\u7684\u592a\u591a\u5e38\u6570**\u504f\u5927**\n\n\u800c[\u7b97\u6cd5\u4e00](https://www.luogu.org/record/show?rid=12572323)\u5c31\u5f88\u4f18\u79c0\u4e86\uff0c\u5e38\u6570\u6781\u5c0f\u4e14\u4e0d\u7528**\u6b27\u62c9\u7b5b**\u7684\u9884\u5904\u7406\uff0c\u56e0\u6b64\u518d\u901f\u5ea6\u4e0a\u78be\u538b\u4e86\u5176\u5b83\u4e24\u79cd\u89e3\u6cd5\u3002\n\n\u800c\u4e14\u66b4\u529b~~\u4e0d\u52a8\u8111~~\u7684\u63a8\u5bfc\u8fc7\u7a0b\uff0c\u5567\u5567\u79f0\u5947\u3002",
        "postTime": 1548393834,
        "uid": 41698,
        "name": "hl666",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1447 \u3010[NOI2010]\u80fd\u91cf\u91c7\u96c6\u3011"
    },
    {
        "content": "\u8fd9\u9898\u6211\u4eec\u9700\u8981\u5f52\u7eb3\u4e00\u4e0b\u5427\uff01\u53d1\u73b0\u7b54\u6848\u662fsigma(gcd(x,y)), 1<=x<=n, 1<=y<=m\n\u7136\u540e\u6211\u4eec\u8981\u7b97\u8fd9\u4e2a\u4e1c\u897f\uff0c\n\n\u4ee4f[d]\u4e3a(x, y) = d\u7684\u5bf9\u6570\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662fsigma(f[i] *((i-1)*2+1))\n\nf[i]\u600e\u4e48\u6c42\u5462\uff1f\n\n\u57281 <= x <= n, 1 <= y <= m\u4e2d\uff0cgcd(x, y) | d\u7684\u6709[n/d] * [m/d]\u4e2a\u3002\n\n\u4e0d\u8fc7\u6211\u4eec\u8981\u6263\u6389\u6240\u6709\u7684\u500d\u6570\uff0cf[i] = [n/d] * [m/d] - f[2i] - f[3i] - f[4i] - \n\n...\u3002\n\n\u9006\u5e8f\u505a\u5373\u53ef\u3002\u5177\u4f53\u89c1\u4ee3\u7801\uff1a\n```pascal\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N = 100005;\nlong long ans = 0, f[N];\nint main() {\n\tint i, j, n, m; scanf(\"%d %d\", &n, &m);\n\tif (n > m) swap(n, m);\n\tfor (i = n; i; --i) {\n\t\tf[i] = 1ll * (n / i) * (m / i);\n\t\tfor (j = (i << 1); j <= n; j += i) f[i] -= f[j];\n\t\tans += 1ll * f[i] * ((i << 1) - 1); \n\t}\n\tprintf(\"%lld\\n\", ans);\n\treturn 0;\n}\n\n```",
        "postTime": 1546848090,
        "uid": 30817,
        "name": "muller",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1447 \u3010[NOI2010]\u80fd\u91cf\u91c7\u96c6\u3011"
    }
]
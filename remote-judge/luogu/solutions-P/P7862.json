[
    {
        "content": "\u9898\u610f\uff1a\u7ed9\u5b9a $n\\in[1,5e4]$ \u4e2a\u70b9\uff0c\u70b9\u6709\u5750\u6807\u53ca\u70b9\u6743\uff0c\u8fde\u4e00\u4e9b\u8fb9\uff0c\u4f7f\u67d0\u4e00\u4e2a\u8fde\u901a\u5757\u4e2d\uff0c\u67d0\u4e9b\u70b9\u6743\u76f8\u52a0\u6574\u9664\u7ed9\u5b9a\u7684 $k\\in[1,30]$\uff0c\u6700\u5c0f\u5316\u8fb9\u6743\uff08\u5373\u70b9\u4e4b\u95f4\u7684\u8ddd\u79bb\uff09\u6700\u5927\u503c\u3002\n\n\u770b\u5230\u6700\u5c0f\u5316\u6700\u5927\u503c\uff0c\u7b2c\u4e00\u65f6\u95f4\u60f3\u5230\u4e8c\u5206\u3002\u53ef\u4ee5\u8bbe\u5b9a\u8fb9\u754c $l=0,r=1e8\\sqrt{2}$\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5c06 $n$ \u4e2a\u70b9\u6bcf\u4e24\u4e2a\u5339\u914d\uff0c\u7136\u540e\u7528\u4e00\u4e2a\u5e76\u67e5\u96c6\u628a\u8054\u901a\u7684\u70b9\u7ef4\u62a4\u4e0b\uff0c\u5224\u65ad\u53ef\u884c\u6027\u5c31\u7528 01 \u80cc\u5305\uff0c\u7528 $f_{x,i}$ \u8868\u793a $x$ \u7684\u70b9\u96c6\u5185\u6709 $i$ \u4e2a\u4eba\u662f\u5426\u53ef\u884c\u3002\n\n\u6ce8\u610f\u5230 $i$ \u53ef\u80fd\u5341\u5206\u5927\uff0c\u4f46 $k$ \u53ea\u6709 $30$\uff0c\u4e14\u9898\u76ee\u53ea\u8981\u6c42\u6574\u9664 $k$\uff0c\u6240\u4ee5\u6ca1\u5fc5\u8981\u628a\u4eba\u6570\u5177\u4f53\u5b58\u4e0b\uff0c\u53ea\u8981\u5b58\u4e00\u4e2a\u53d6\u6a21 $k$ \u7684\u503c\u3002$f_{x,0}=1$ \u5c31\u4ee3\u8868\u53ef\u4ee5\u6574\u9664\u3002\n\n\u521d\u59cb\u65f6 $f_{x,val_x}=1$\uff0c\u5408\u5e76 $x$ \u548c $y$ \u5c31 $k^2$ \u679a\u4e3e\u4e0b\uff0c\u628a\u6240\u6709\u7684 $f_{x,i}~\\text{and}~f_{y,p-i}(p\\in[0,2k])$ \u6216\u8d77\u6765\uff0c\u5408\u5e76\u5230 $g_p$ \u91cc\u9762\u3002\n\n$g$ \u662f\u4e2d\u95f4\u8f6c\u79fb\u7684\u6570\u7ec4\uff0c\u8f6c\u79fb\u540e\u628a $g$ \u8d4b\u503c\u7ed9 $f_x$\u3002\n\n\u8fd8\u6709\u5c31\u662f\u56e0\u4e3a $f_{x,0}$ \u6ca1\u503c\uff0c\u8981\u5148\u7528 $f_x$ \u548c $f_y$ \u628a $g$ \u8d4b\u4e0b\u521d\u59cb\u503c\uff0c\u5c31\u662f $g_i=f_{x,i}~\\text{or}~f_{y,i}$\u3002\n\n\u8fd9\u6837\u505a\u6bcf\u4e2a\u70b9\u5bf9\u90fd\u679a\u4e3e\u4e86\u4e00\u6b21\uff0c\u5355\u6b21\u5224\u65ad\u590d\u6742\u5ea6\u662f $O(n^2)$ \u7684\uff0c\u660e\u663e\u8fc7\u4e0d\u4e86\u3002\n\n\u8003\u8651\u526a\u679d\u3002\u5148\u5bf9\u6240\u6709\u70b9\u6309\u6a2a\u5750\u6807\u6392\u5e8f\uff0c\u53ea\u679a\u4e3e\u6a2a\u5750\u6807\u4e4b\u5dee\u5728\u4e8c\u5206\u7684\u7b54\u6848\u4e4b\u5185\u7684\uff0c\u7136\u540e\u628a\u5df2\u7ecf\u5728\u540c\u4e00\u70b9\u96c6\u7684\u70b9\u6392\u9664\u6389\uff0c\u627e\u5230\u53ef\u884c\u7684\u65b9\u6848\u76f4\u63a5\u8fd4\u56de\uff0c\u5c31\u53ef\u4ee5\u8fc7\u4e86\u3002\n\n# $code$\n```cpp\n#include<bits/stdc++.h>\n#define esp 1e-6\n#define db double\nusing namespace std;\nconst int N=1e6+50;\n\nstruct node\n{\n\tint x,y,val;\n\t\n\tfriend bool operator<(node a,node b)\n\t{\n\t\treturn a.x==b.x?a.y<b.y:a.x<b.x;\n\t}\n}a[N];\n\nint n,k,ro[N];\nbool f[N][35];\n\ndb dis(int x,int y)\n{\n\treturn sqrt(1ll*(a[x].x-a[y].x)*(a[x].x-a[y].x)+1ll*(a[x].y-a[y].y)*(a[x].y-a[y].y));\n}\n\nint find(int x)\n{\n\treturn x==ro[x]?x:(ro[x]=find(ro[x]));\n}\n\nint check(db x)\n{\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=0;j<=k;j++)f[i][j]=0;\n\t\tro[i]=i;f[i][a[i].val]=1;\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=i+1;j<=n;j++)\n\t\t{\n\t\t\tif(a[j].x-a[i].x>x)break;\n\t\t\tint ri=find(i),rj=find(j);\n\t\t\tif(dis(i,j)>x||ri==rj)continue;\n\t\t\tint g[65];memset(g,0,sizeof g);\n\t\t\tfor(int l=0;l<=k;l++)if(f[ri][l])\n\t\t\tfor(int r=0;r<=k;r++)if(f[rj][r])\n\t\t\tg[l+r]=1;\n\t\t\tfor(int l=0;l<=k+k;l++)f[ri][l%k]|=g[l]|f[rj][l%k];\n\t\t\tro[ri]=ro[rj]=ri;\n\t\t\tif(f[ri][0])return 1;\n\t\t}\n\t}\n\treturn 0;\n}\n\nmain()\n{\n\tstd::ios::sync_with_stdio(false);\n\tstd::cin.tie(0);\n\tcin>>n>>k;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tcin>>a[i].x>>a[i].y>>a[i].val;\n\t\ta[i].val%=k;\n\t}\n\tsort(a+1,a+1+n);\n\tdb l=0,r=2e8,ans=1919810;\n\twhile(l<=r-esp)\n\t{\n\t\tdb mid=(l+r)/2;\n\t\tif(check(mid))ans=mid,r=mid;\n\t\telse l=mid;\n\t}\n\tcout<<fixed<<setprecision(3)<<ans<<'\\n';\n}\n```",
        "postTime": 1658206351,
        "uid": 344416,
        "name": "zsq147258369",
        "ccfLevel": 7,
        "title": "P7862 [COCI2015-2016#2] DR\u017dAVA \u9898\u89e3"
    },
    {
        "content": "\u62e5\u6709\u4e8c\u5206\u7684\u6807\u7b7e\u600e\u4e48\u80fd\u6ca1\u6709\u4e8c\u5206\u7684\u9898\u89e3\u5462\uff0c\u90a3\u5c31\u53d1\u4e00\u4e2a\u4e8c\u5206\u5927\u6cd5\u3002\n\n## \u7a81\u7834\u70b9 1 \u300c\u4e0d\u8d85\u8fc7 $D$\u300d\n\n\u300c\u7531\u4e8e\u7f3a\u4e4f\u9884\u7b97\uff0c\u4ed6\u4eec\u5c06\u4e0d\u4fee\u5efa\u8d85\u8fc7 $D$ \u516c\u91cc\u7684\u9053\u8def\u3002\u300d\n\n\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u4e8c\u5206\u7b54\u6848\u8fd9\u4e2a $D$\uff0c\u5c06\u8ddd\u79bb\u4e0d\u8d85\u8fc7 $D$ \u7684\u4e24\u57ce\u5e02\u4e4b\u95f4\u5168\u90e8\u4fee\u4e0a\u9053\u8def\uff0c\u7136\u540e\u5224\u65ad\u662f\u5426\u300c\u81f3\u5c11\u6709\u4e00\u4e2a\u53bf\u5b58\u5728\u4e00\u4e2a\u975e\u7a7a\u5b50\u53bf\uff08\u53ef\u4ee5\u5305\u62ec\u8be5\u53bf\u7684\u6240\u6709\u57ce\u5e02\uff09\uff0c\u4f7f\u5f97\u5b50\u53bf\u5185\u7684\u5c45\u6c11\u603b\u6570\u53ef\u4ee5\u88ab $K$ \u6574\u9664\u300d\u3002\u6bd5\u7adf\u5c06\u4e0d\u8d85\u8fc7 $D$ \u7684\u8fb9\u591a\u9009\u51e0\u4e2a\u9009\u4e0a\uff0c\u603b\u4e0d\u4f1a\u8ba9\u539f\u672c\u4e00\u4e2a\u53bf\u7684\u5b50\u53bf\u88ab\u62c6\u5f00\u5427\u3002\n\n## \u7a81\u7834\u70b9 2 \u300c$1\\leq K\\leq 30$\u300d\n\n\u65e2\u7136 $K$ \u8fd9\u4e48\u5c0f\uff0c\u90a3\u4e48\u80af\u5b9a\u6709\u732b\u817b\u3002\n\n\u6211\u4eec\u4e8c\u5206\u51fa\u4e00\u4e2a\u7b54\u6848 $D$ \u8fc7\u540e\uff0c\u5df2\u7ecf\u5c06\u4e0d\u8d85\u8fc7 $D$ \u7684\u8fb9\u5168\u90e8\u9009\u4e0a\uff0c\u8fd9\u91cc\u53ef\u4ee5\u8003\u8651\u7528\u5e76\u67e5\u96c6\u5c06\u7edf\u4e00\u8fde\u901a\u5757\u5185\u7684\u70b9\u653e\u5230\u4e00\u8d77\u3002\u90a3\u4e48\u6b64\u65f6\u6211\u4eec\u81ea\u7136\u5bf9\u6bcf\u4e2a\u8fde\u901a\u5757\u90fd\u6709\u4e86\u4e00\u4e2a\u7f16\u53f7\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u5e76\u67e5\u96c6\u4e2d\u67e5\u8be2\u5230\u7684 $f(x)$\u3002\n\n\u5bf9\u6bcf\u4e2a\u8fde\u901a\u5757\u4e5f\u5c31\u662f\u300c\u53bf\u300d\uff0c\u65e2\u7136\u641c\u7d22\u4f1a\u8d85\u65f6\uff0c\u90a3\u4e48\u6211\u4eec\u4e0d\u53ef\u907f\u514d\u5730\u60f3\u5230\u4e86 DP\u3002\u5047\u8bbe\u4e0d\u52a0\u5165\u7b2c $i$ \u4e2a\u70b9\u7684\u65f6\u5019\uff0c\u6211\u4eec\u7684\u53bf $f(i)$ \u4e2d\u53ef\u4ee5\u7ec4\u5408\u51fa\u7684\u6743\u503c\u548c\u5bf9 $K$ \u4f59\u6570\u7684\u96c6\u5408\u4e3a $\\{r_1,r_2,...,r_m\\}$\uff0c\u90a3\u4e48\u5982\u679c\u9009\u4e0a\u7b2c $i$ \u4e2a\u70b9\u4e5f\u5c31\u662f\u57ce\u5e02\uff0c\u5c31\u53ef\u4ee5\u4ea7\u751f\u4f59\u6570\u96c6\u5408 $\\{(r_1+w_i)\\mod K,(r_2+w_i)\\mod K,...,(r_m+w_i)\\mod K\\}$\uff0c\u4e5f\u5c31\u662f\u8bf4\u6b64\u65f6\u53bf $f(i)$ \u4e2d\u53ef\u4ee5\u7ec4\u5408\u51fa\u7684\u6743\u503c\u548c\u5bf9 $K$ \u7684\u4f59\u6570\u7684\u96c6\u5408\u4e3a $\\{r_1,r_2,...,r_m\\}\\cup\\{(r_1+w_i)\\mod K,(r_2+w_i)\\mod K,...,(r_m+w_i)\\mod K\\}$\u3002\n\n\u65e2\u7136\u8fd9\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u5f00\u4e00\u4e2a\u5e03\u5c14\u7c7b\u578b\u7684 DP \u6570\u7ec4 $dp_{i,j}$\uff0c\u8868\u793a\u73b0\u5728\u7b2c $i$ \u4e2a\u53bf\u4e2d\u80fd\u5426\u7ec4\u5408\u51fa\u5bf9 $K$ \u4f59\u6570\u4e3a $j$ \u7684\u6743\u503c\u548c\uff0c\u6bcf\u6b21\u52a0\u70b9\u7684\u65f6\u5019\u7528 $\\mathrm{O}(K)$ \u7684\u65f6\u95f4\u626b\u63cf\u4e00\u904d\u66f4\u65b0\u5373\u53ef\u3002\u6ce8\u610f\uff0c\u4e3a\u4e86\u8ba9\u6bcf\u4e2a\u70b9\u53ea\u7528\u4e00\u6b21\uff0c\u56e0\u6b64\u66f4\u65b0\u6570\u7ec4\u7684\u65f6\u5019\u73a9\u5b8c\u4e0d\u53ef\u5728\u539f\u6570\u7ec4\u4e0a\u66f4\u65b0\uff0c\u53ef\u4ee5\u5f00\u4e00\u4e2a\u6682\u5b58\u6570\u7ec4\u3002\n\n## \u7a81\u7834\u70b9 3 \u4e8c\u7ef4\u5e73\u9762\u5750\u6807\u7684\u6392\u5e8f\n\n\u4e3a\u4e86\u907f\u514d\u7528 $\\mathrm{O}(n^2)$ \u7684\u65f6\u95f4\u53bb\u626b\u63cf\u6bcf\u4e00\u6761\u8fb9\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5bf9\u5750\u6807\u8fdb\u884c\u6392\u5e8f\uff0c\u7136\u540e\u7528\u4e8c\u5206\u67e5\u627e\u7684\u624b\u6bb5\u3002\u4e0e\u5f53\u524d\u70b9 $(x_0,y_0)$ \u8ddd\u79bb\u6700\u5927\u4e3a $D$ \u7684\u70b9\u4e2d\uff0c$x$ \u5750\u6807\u4e00\u5b9a\u5728 $[x_0-D,x_0+D]$ \u7684\u8303\u56f4\u5185\uff0c\u56e0\u6b64\u53ef\u4ee5\u501f\u52a9\u6309 $x$ \u5750\u6807\u6392\u5e8f\uff0c\u901a\u8fc7\u4e8c\u5206\u67e5\u627e\u7f29\u5c0f\u533a\u95f4\u3002\u5f53\u7136\uff0c$y$ \u5750\u6807\u600e\u4e48\u9650\u5236\uff0c\u5c31\u4e0d\u5728\u6211\u7684\u80fd\u529b\u8303\u56f4\u5185\u4e86\uff0c\u5982\u679c\u6709\u5927\u795e\u6709\u529e\u6cd5\uff0c\u8fd8\u8bf7\u4e0d\u541d\u8d50\u6559\u3002\n\n---\n\n\u4e8b\u5230\u5982\u4eca\uff0c\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u5199\u51fa\u4e00\u4e2a\u52c9\u52c9\u5f3a\u5f3a\u7684\u4ee3\u7801\uff0c\u5927\u6982\u80fd\u62ff 112 \u5206\uff08\u5f53\u7136\u662f TLE \u6389\uff09\uff0c\u5b83\u5e94\u8be5\u662f\u957f\u8fd9\u6837\u7684\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <algorithm>\n#include <utility>\n\nusing namespace std;\n\nint N, K;\npair<pair<double, double>, int> x[50005];   // x[i].first \u8bb0\u5f55\u5750\u6807\uff0cx[i].second \u8bb0\u5f55\u6743\u503c\nbool ok[50005][31];    // DP \u6570\u7ec4\nbool ko[50005][31];    // \u6682\u5b58 DP \u6570\u7ec4\n\nnamespace US    // \u5e76\u67e5\u96c6\n{\n\tint F[50005];\n\t\n\tint f(int x)\n\t{\n\t\tif (F[x] == x) return x;\n\t\telse return F[x] = f(F[x]);\n\t}\n\t\n\tvoid unite(int x, int y)\n\t{\n\t\tx = f(x);\n\t\ty = f(y);\n\t\tF[x] = y;\n\t}\n}\n\nint main()\n{\n\tscanf(\"%d%d\", &N, &K);\n\tfor (int i = 1; i <= N; ++i)\n\t{\n\t\tscanf(\"%lf%lf%d\", &x[i].first.first, &x[i].first.second, &x[i].second);\n\t\tx[i].second = x[i].second % K;    // \u5148\u9664\u4ee5\u4e00\u4e2a K \u518d\u8bf4\n\t}\n\t\n\tsort(x + 1, x + N + 1);\n\t\n\tdouble l = 0, r = sqrt(2e16), eps = 0.00001;\n\t\n\twhile (r - l > eps)\n\t{\n\t\tdouble mid = (l + r) / 2;\n\t\t\n\t\tfor (int i = 1; i <= N; ++i) US::F[i] = i;\n\t\tfor (int i = 1; i <= N; ++i)\n\t\t{\n\t\t\tfor (int j = lower_bound(x + 1, x + N + 1, make_pair(make_pair(x[i].first.first - mid, x[i].first.second), 0)) - x; j < i; ++j)    // \u53ea\u641c\u5f53\u524d\u70b9\u524d\u9762\u7684\uff0c\u907f\u514d\u91cd\u590d\n\t\t\t{\n\t\t\t\tif ((x[i].first.first - x[j].first.first) * (x[i].first.first - x[j].first.first) + (x[i].first.second - x[j].first.second) * (x[i].first.second - x[j].first.second) <= mid * mid)\n\t\t\t\t{\n\t\t\t\t\tUS::unite(i, j);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tmemset(ok, 0, sizeof ok);\n\t\tfor (int i = 1; i <= N; ++i)\n\t\t{\n\t\t\tok[US::f(i)][0] = 1;    // \u7b2c\u4e8c\u7ef4\u4e3a 0 \u662f\u521d\u59cb\u4e00\u4e2a\u90fd\u6ca1\u9009\uff0c\u5982\u679c\u9009\u5230\u6574\u9664\u90a3\u4e48\u5e94\u8be5\u662f K\n\t\t\tfor (int j = 0; j < K; ++j) ko[US::F[i]][(j + x[i].second - 1) % K + 1] = ok[US::F[i]][j];\n\t\t\tif (ko[US::F[i]][K]) goto Label;    // \u6210\u529f\n\t\t\tfor (int j = 0; j < K; ++j) ok[US::F[i]][j] |= ko[US::F[i]][j];\n\t\t}\n\t\t\n\t\tl = mid;    // \u5931\u8d25\n\t\tcontinue;\n\tLabel:\n\t\tr = mid;\n\t}\n\t\n\tprintf(\"%.3lf\", l);\n\t\n\treturn 0;\n}\n```\n\n## \u7a81\u7834\u70b9 4 \u964d\u4f4e\u4e8c\u5206\u4e0a\u754c\n\n\u6709\u4e00\u4e2a\u5947\u5947\u602a\u602a\u7684\u89c4\u5f8b\u80fd\u6d3e\u4e0a\u5927\u7528\u3002\n\n\u8fd9\u4e2a\u89c4\u5f8b\u544a\u8bc9\u6211\u4eec\uff0c\u5982\u679c\u6211\u4eec\u9009\u4e86 $K$ \u5ea7\u57ce\u5e02\uff0c\u90a3\u4e48\u4e00\u5b9a\u6709\u4e00\u79cd\u7ec4\u5408\u6743\u503c\u548c\u5bf9 $K$ \u7684\u4f59\u6570\u4e3a $0$\u3002\n\n\u5b83\u672c\u8eab\u7684\u63cf\u8ff0\u662f\uff0c\u5bf9\u4e8e\u6709 $k$ \u4e2a\u5143\u7d20\u7684\u6570\u96c6\uff0c\u4e00\u5b9a\u6709\u4e00\u4e2a\u5b50\u96c6\u7684\u5143\u7d20\u4e4b\u548c\u80fd\u88ab $k$ \u6574\u9664\uff0c\u4e0b\u9762\u6765\u4e00\u4e2a\u5c0f\u5c0f\u7684\u8bc1\u660e\u3002\n\n\u5c06\u8fd9\u4e2a\u6570\u96c6\u6392\u6210\u6709\u5e8f\u6570\u5217\uff0c\u8ba1\u7b97\u524d\u7f00\u548c\u5bf9 $k$ \u7684\u4f59\u6570 $s_i$\uff0c\u5982\u679c\u4e0d\u5b58\u5728 $s_i=s_j(i\\neq j)$\uff0c\u90a3\u4e48 $k$ \u4e2a\u6570\u6709 $k$ \u4e2a\u4e0d\u540c\u7684\u6570\u503c\uff0c\u8bf4\u660e\u4e00\u5b9a\u5b58\u5728 $s_i=0$\uff0c\u4e5f\u5c31\u662f\u4e00\u5b9a\u5b58\u5728\u4e00\u4e2a\u524d\u7f00\u548c\u662f $k$ \u7684\u500d\u6570\uff1b\u5982\u679c\u4e0d\u5b58\u5728 $s_i=0$\uff0c\u90a3\u4e48 $k$ \u4e2a\u6570\u6709 $k-1$ \u4e2a\u4e0d\u540c\u7684\u6570\u503c\uff0c\u8bf4\u660e\u4e00\u5b9a\u5b58\u5728 $s_i=s_j(i\\neq j)$\uff0c\u4e5f\u5c31\u662f\u533a\u95f4 [i+1,j] \u7684\u548c\u80fd\u591f\u88ab $k$ \u6574\u9664\u3002\n\n\u65e2\u7136\u8fd9\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u6bcf\u4e2a\u70b9\uff0c\u627e\u4e0e\u5b83\u8ddd\u79bb\u6700\u8fd1\u7684 $k-1$ \u4e2a\u70b9\uff0c\u8fde\u4e0a\u8fb9\uff0c\u4e00\u5b9a\u662f\u4e00\u79cd\u53ef\u884c\u89e3\uff0c\u8fd9\u6837\u5c31\u964d\u4f4e\u4e86\u4e0a\u754c\u3002\n\n\u8bf4\u7740\u5bb9\u6613\uff0c\u505a\u8d77\u6765\u96be\uff0c\u300c\u627e\u4e0e\u5b83\u8ddd\u79bb\u6700\u8fd1\u7684 $k-1$ \u4e2a\u70b9\u300d\u53ef\u96be\u627e\u4e86\u3002\u4e8b\u5b9e\u4e0a\uff0c\u6211\u4eec\u53ea\u7528\u968f\u4fbf\u627e\u51e0\u4e2a\u4e0e\u5b83\u8ddd\u79bb\u76f8\u8fd1\u7684\u70b9\u5c31\u884c\u4e86\u3002\u5728\u6392\u597d\u5e8f\u8fc7\u540e\uff0c\u6211\u4eec\u4ece $\\max\\{1,i-k+1\\}$ \u5f00\u59cb\u627e $k$ \u4e2a\u70b9\u8ba1\u7b97\u8ddd\u79bb\uff0c\u5bf9\u6bcf\u4e2a\u70b9\u627e\u5230\u6700\u5927\u8ddd\u79bb\uff0c\u4e4b\u540e\u518d\u7edf\u8ba1\u8fd9\u4e9b\u70b9\u7684\u8ba1\u7b97\u51fa\u7684\u6700\u5927\u8ddd\u79bb\u4e2d\u7684\u6700\u5c0f\u503c\uff0c\u4f5c\u4e3a\u4e0a\u754c\u3002\n\n\u6211\u4eec\u5728\u4e0a\u9762\u4ee3\u7801\u8fdb\u884c\u4e8c\u5206\u4e4b\u524d\u52a0\u4e0a\u4ee5\u4e0b\u4ee3\u7801\u3002\n\n```cpp\nfor (int i = 1; i <= N; ++i)\n{\n\tdouble ans = 0;\n\tfor (int j = max(i - K + 1, 1), c = 1; c <= K; ++j, ++c) ans = max(ans, sqrt((x[i].first.first - x[j].first.first) * (x[i].first.first - x[j].first.first) + (x[i].first.second - x[j].first.second) * (x[i].first.second - x[j].first.second)));\n\tr = min(r, ans);\n}\n```\n\n\u5f53\u7136\uff0c\u4ec5\u9760\u8fd9\u4e2a\u8fd8\u4e0d\u591f\uff0c\u4e0d\u7136\u5c31\u6ca1\u6709\u4e0b\u6587\u4e86\u3002\n\n## \u7a81\u7834\u70b9 5 \u780d\u8fb9\n\n\u6211\u4eec\u4ed4\u7ec6\u89c2\u5bdf\u4e0a\u9762\u7684\u4ee3\u7801\uff0c\u867d\u7136\u5c0f\u5c0f\u5730\u4f18\u5316\u4e86\uff0c\u4f46\u662f\u8fd8\u662f\u611f\u89c9\u6bcf\u6b21\u627e\u53ef\u884c\u8fb9\u7684\u65f6\u5019\u90fd\u5f88\u8d39\u65f6\u8bf6\u3002\u5f53\u521d\u6211\u4eec\u56e0\u4e3a $(5\\times 10^4)^2$ \u592a\u5927\u5b58\u4e0d\u4e0b\uff0c\u56e0\u6b64\u653e\u5f03\u4e86\u5b58\u8fb9\uff0c\u4f46\u662f\u6211\u4eec\u521a\u624d\u5df2\u7ecf\u627e\u5230\u4e86\u4e00\u4e2a\u4e0a\u754c\uff0c\u5728\u4e8c\u5206\u8fc7\u7a0b\u4e2d\uff0c$mid$ \u4e00\u5b9a\u4e0d\u4f1a\u8d85\u8fc7\u4e0a\u754c\u7684\uff0c\u4e8e\u662f\u5927\u4e8e\u4e0a\u754c\u7684\u8fb9\u6211\u4eec\u53ef\u4ee5\u653e\u5fc3\u820d\u53bb\u4e86\u3002\u5269\u4e0b\u4e3a\u6570\u4e0d\u591a\u7684\u8fb9\uff0c\u5c31\u53ef\u4ee5\u5b58\u8d77\u6765\u3002\n\n\u8bf6\u5b58\u8d77\u6765\u5c31\u597d\u529e\u4e86\u554a\u670b\u53cb\u4eec\uff0c\u518d\u6392\u4e2a\u5e8f\uff0c\u6bcf\u6b21\u4e8c\u5206\u7b54\u6848\u51fa\u4e00\u4e2a $D$ \u8fc7\u540e\u5c06\u6392\u5728\u524d\u9762\u7684\u4e00\u4e9b\u8fb9\u52a0\u8fdb\u53bb\u7ef4\u62a4\u5e76\u67e5\u96c6\u5c31\u53ef\u4ee5\u4e86\u8bf6\u3002\n\n\u6240\u4ee5\u8bf4\uff0c\u6c38\u8fdc\u4e0d\u8981\u5fd8\u4e86\u6765\u65f6\u7684\u8def\uff0c\u5f53\u521d\u53ef\u80fd\u4e00\u65e0\u662f\u5904\uff0c\u5f53\u73af\u5883\u6539\u53d8\uff0c\u4e5f\u6709\u53ef\u80fd\u7115\u53d1\u5f02\u5f69\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <algorithm>\n#include <utility>\n\nusing namespace std;\n\nint N, K, M = 0;\npair<pair<double, double>, int> x[50005];\nbool ok[50005][31];\nbool ko[50005][31];\n\nstruct edge\n{\n\tint u, v;\n\tdouble d;\n\tedge() {}\n\tedge(int _u, int _v, double _d): u(_u), v(_v), d(_d) {}\n} e[1500005];\n\nbool cmp(edge x, edge y)\n{\n\treturn x.d < y.d;\n}\n\nnamespace US\n{\n\tint F[50005];\n\t\n\tint f(int x)\n\t{\n\t\tif (F[x] == x) return x;\n\t\telse return F[x] = f(F[x]);\n\t}\n\t\n\tvoid unite(int x, int y)\n\t{\n\t\tx = f(x);\n\t\ty = f(y);\n\t\tF[x] = y;\n\t}\n}\n\nint main()\n{\n\tscanf(\"%d%d\", &N, &K);\n\tfor (int i = 1; i <= N; ++i)\n\t{\n\t\tscanf(\"%lf%lf%d\", &x[i].first.first, &x[i].first.second, &x[i].second);\n\t\tx[i].second = x[i].second % K;\n\t}\n\t\n\tsort(x + 1, x + N + 1);\n\t\n\tdouble l = 0, r = sqrt(2e16), eps = 0.00001;\n\t\t\n\tfor (int i = 1; i <= N; ++i)\n\t{\n\t\tdouble ans = 0;\n\t\tfor (int j = max(i - K + 1, 1), c = 1; c <= K; ++j, ++c)\n\t\t\tans = max(ans, sqrt((x[i].first.first - x[j].first.first) * (x[i].first.first - x[j].first.first)\n\t\t\t                + (x[i].first.second - x[j].first.second) * (x[i].first.second - x[j].first.second)));\n\t\tr = min(r, ans);\n\t}\n\t\t\n\tfor (int i = 1; i <= N; ++i)\n\t{\n\t\tfor (int j = max(i - K + 1, 1), c = 1; c <= K; ++j, ++c)\n\t\t{\n\t\t\tdouble dist = sqrt((x[i].first.first - x[j].first.first) * (x[i].first.first - x[j].first.first)\n\t\t\t\t           + (x[i].first.second - x[j].first.second) * (x[i].first.second - x[j].first.second));\n\t\t\tif (dist <= r) e[++M] = edge(i, j, dist);\n\t\t}\n\t}\n\t\n\tsort(e + 1, e + M + 1, cmp);\n\t\n\twhile (r - l > eps)\n\t{\n\t\tdouble mid = (l + r) / 2;\n\t\t\n\t\tfor (int i = 1; i <= N; ++i) US::F[i] = i;\n\t\t\n\t\tfor (int i = 1; e[i].d <= mid; ++i) US::unite(e[i].u, e[i].v);\n\t\t\n\t\tmemset(ok, 0, sizeof ok);\n\t\tfor (int i = 1; i <= N; ++i)\n\t\t{\n\t\t\tok[US::f(i)][0] = 1;\n\t\t\tfor (int j = 0; j < K; ++j) ko[US::F[i]][(j + x[i].second - 1) % K + 1] = ok[US::F[i]][j];\n\t\t\tif (ko[US::F[i]][K]) goto Label;\n\t\t\tfor (int j = 0; j < K; ++j) ok[US::F[i]][j] |= ko[US::F[i]][j];\n\t\t}\n\t\t\n\t\tl = mid;\n\t\tcontinue;\n\tLabel:\n\t\tr = mid;\n\t}\n\t\n\tprintf(\"%.3lf\", l);\n\t\n\treturn 0;\n}\n```",
        "postTime": 1658242219,
        "uid": 193684,
        "name": "Sukwants",
        "ccfLevel": 0,
        "title": "P7862 [COCI2015-2016#2] DR\u017dAVA"
    },
    {
        "content": "## P7862 [COCI2015-2016#2] DR\u017dAVA \u9898\u89e3\n\n[\u9898\u76ee\u94fe\u63a5\uff1aP7862 [COCI2015-2016#2] DR\u017dAVA](https://www.luogu.com.cn/problem/P7862)\n\n\u611f\u89c9\u8fd9\u4e2a\u9898\u505a\u7684\u4eba\u6bd4\u8f83\u5c11\uff0c\u9898\u610f\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u3002\n\n\u8fd9\u4e2a\u9650\u5236\u201c\u4e0d\u4fee\u5efa\u8d85\u8fc7 $D$ \u516c\u91cc\u7684\u9053\u8def\u201d\u542c\u8d77\u6765\u975e\u5e38\u50cf\u4e8c\u5206\u7b54\u6848\u7684\u95ee\u9898\uff0c\u53ef\u60dc\u5b83\u4e0d\u662f\u3002\uff08\u6216\u662f\u6709\u5bf9\u5e94\u505a\u6cd5\u6211\u4e0d\u4f1a\uff09\n\n\u9996\u5148\u8bc1\u660e\u4e00\u4e2a\u5f88\u5999\u7684\u4e1c\u897f\uff1a\u4efb\u610f $k$ \u4e2a\u81ea\u7136\u6570\u7ec4\u6210\u7684\u53ef\u91cd\u96c6\uff0c\u5fc5\u5b9a\u6709\u4e00\u4e2a\u5b50\u96c6\u5176\u5143\u7d20\u548c\u53ef\u4ee5\u88ab $k$ \u6574\u9664\u3002\n\n### \u8bc1\u660e\n\n\u5c06\u8fd9 $k$ \u4e2a\u81ea\u7136\u6570\u4efb\u610f\u6392\u6210\u4e00\u4e2a\u6392\u5217\uff0c\u6c42\u51fa $i$ \u4f4d\u7f6e\u7684**\u53d6\u6a21\u540e**\u7684\u524d\u7f00\u548c $sum_i$ \u3002\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u679c\u5b58\u5728 $sum_i=sum_j$ \u7684\u60c5\u51b5\uff0c\u5373 $sum_i-sum_j=0$ \uff0c\u4e5f\u5c31\u662f\u5c06\u8be5\u6392\u5217\u4f4d\u4e8e $[j+1,i]$ \u4e2d\u7684\u5143\u7d20\u53d6\u51fa\u540e\u6c42\u548c\uff0c\u4e00\u5b9a\u662f\u53ef\u4ee5\u88ab $k$ \u6574\u9664\u7684\u3002\n\n\u90a3\u4e48\u5982\u679c\u6709 $k$ \u4e2a\u6570\uff0c\u7b97\u4e0a $0$ \u6211\u4eec\u4f1a\u6709 $31$ \u4e2a\u524d\u7f00\u548c\uff0c\u6839\u636e\u9e3d\u5de2\u539f\u7406\uff0c\u5fc5\u81f3\u5c11\u6709\u4e00\u5bf9\u662f\u76f8\u7b49\u7684\uff0c\u4e5f\u5c31\u662f\u6709\u4e00\u4e2a\u5b50\u96c6\u7684\u548c\u662f\u53ef\u4ee5\u88ab $k$ \u6574\u9664\u7684\uff0c\u8bc1\u6bd5\u3002 \n\n### \u7b97\u6cd5\u7b80\u6790\n\n\u90a3\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\uff0c\u7b54\u6848\u4e0a\u754c\u4e00\u5b9a\u662f\u8ddd\u79bb\u5404\u70b9\u7b2c $k-1$ \u8fdc\u7684\u70b9\u7684\u6700\u5c0f\u8ddd\u79bb\uff0c\u56e0\u4e3a\u8fd9\u6837\u4e00\u5b9a\u53ef\u4ee5\u8fde\u6210\u4e00\u4e2a\u83ca\u82b1\u72b6\u7684\u5927\u5c0f\u4e3a $k$ \u7684\u8fde\u901a\u5757\uff0c\u6839\u636e\u4e0a\u9762\u7684\u8bc1\u660e\u4e00\u5b9a\u662f\u6ee1\u8db3\u7b54\u6848\u7684\u3002\n\n\u6240\u4ee5\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\u6765\u8bf4\uff0c\u771f\u6b63\u6709\u7528\u7684\u70b9\u53ea\u6709\u79bb\u5b83\u6700\u8fd1\u7684 $k-1$ \u4e2a\u70b9\uff0c\u800c\u4e14\u4e0d\u4e00\u5b9a\u90fd\u627e\u5168\u3002\u56e0\u4e3a\u53ea\u8981\u968f\u4fbf\u6709\u4e00\u4e2a\u8fde\u901a\u5757\u5927\u5c0f\u4e3a $k$ \u5c31\u5df2\u7ecf\u6ee1\u8db3\u7b54\u6848\u4e86\u3002\n\n\u56e0\u4e3a $k$ \u4e0d\u5927\uff0c\u6211\u8fd9\u91cc\u76f4\u63a5\u7528\u66b4\u529b\u7684\u65b9\u5f0f\u627e\u5230\u53ef\u884c\u7684\u70b9\u3002\u5f00\u59cb\u5bf9\u4e8e $x$ \u6392\u4e2a\u5e8f\uff0c\u7136\u540e\u7528\u6bcf\u4e2a\u70b9\u524d\u9762\u7684\u70b9\u66f4\u65b0\u5f53\u524d\u70b9\uff0c\u5982\u679c\u6a2a\u5750\u6807\u4e4b\u5dee\u90fd\u5927\u4e8e $mx$ \uff08\u5373\u6700\u8fd1\u7684 $k-1$ \u8fdc\u8fb9\u8ddd\u79bb\uff09\u90a3\u4e48\u5c31\u8df3\u51fa\u3002\u4e3a\u4e86\u9632\u6b62\u88ab\u5361\uff0c\u8fd0\u7528\u7ecf\u5178\u4eba\u7c7b\u667a\u6167\u5750\u6807\u8f74\u65cb\u8f6c $\\frac{\\pi}{4}$ \uff0c\u6211\u6ca1\u5199\u65cb\u8f6c\u7684\u65f6\u5019\u786e\u5b9e\u6709\u4e2a\u70b9\u88ab\u5361\u5230\u4e86 1.02s \uff0c\u65cb\u8f6c\u4e4b\u540e 477ms \uff08\u9003\uff09\u3002\n\n\u8ba1\u7b97\u7b54\u6848\u65f6\u628a\u6709\u7528\u7684\u8fb9\u6309\u957f\u5ea6\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u4f7f\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\uff0c\u5e76\u8bb0\u5f55\u6bcf\u4e2a\u8fde\u901a\u5757\u5185\u662f\u5426\u5b58\u5728\u6a21 $k$ \u4e3a $i$ \u7684\u5b50\u96c6\u3002\u5408\u5e76\u7684\u65f6\u5019 $k^2$ \u641e\u4e00\u4e0b\u5c31\u53ef\u4ee5\u3002\n\n### \u8d34\u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define lint long long\n#define rint register int\nusing namespace std;\ninline int read(){\n\tchar c;int f=1,res=0;\n\twhile(c=getchar(),!isdigit(c))if(c=='-')f*=-1;\n\twhile(isdigit(c))res=res*10+c-'0',c=getchar();\n\treturn res*f;\n}\nconst int N=5e4+5,K=35,M=N*K;\nconst double inf=1e18;\ndouble x[N],y[N],dis[N][K],mx,ans=inf;\nint ver[N][K];\n//dis\u7528\u6765\u5b58\u5404\u70b9\u524dk\u5927\u7684\u957f\u5ea6\uff0cmx\u4e3a\u6240\u6709\u70b9\u7b2ck\u5927\u957f\u5ea6\u7684\u6700\u5927\u503c\n//\u8fd9\u6837\u53ef\u4ee5\u786e\u5b9a\u7b54\u6848\u4e0a\u754c\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u8ba1\u7b97 \nint n,k,w[N];//\u4eba\u53e3\u7528w\u5b58 \ninline void cg(){\n\tdouble C=1.0/sqrt(2);\n\tfor(rint i=1;i<=n;++i){\n\t\tdouble _x,_y;\n\t\t_x=x[i]*C+y[i]*C;\n\t\t_y=-x[i]*C+y[i]*C;\n\t\tx[i]=_x;y[i]=_y;\n\t}\n}\ninline double d(int a,int b){\n\tdouble dx=x[a]-x[b],dy=y[a]-y[b];\n\treturn sqrt(dx*dx+dy*dy);\n}\n//\u4ec5\u7528b\u6765\u66f4\u65b0a\u7684\u7b54\u6848\uff0c\u53cc\u5411\u66f4\u65b0\u5199\u4e24\u6b21 \ninline void upd(int a,int b){\n\tdouble di=d(a,b);\n\tfor(rint i=1;i<=k;++i)\n\t\tif(di<=dis[a][i]){\n\t\t\tfor(rint j=k;j>i;--j){\n\t\t\t\tdis[a][j]=dis[a][j-1];\n\t\t\t\tver[a][j]=ver[a][j-1];\n\t\t\t}\n\t\t\tdis[a][i]=di;\n\t\t\tver[a][i]=b;\n\t\t\tbreak;\n\t\t}\n\tmx=min(mx,dis[a][k]);\n}\nint q[N];//\u6784\u9020\u904d\u5386\u7684\u5e8f\u5217 \ninline bool cp(int a,int b){\n\tif(x[a]==x[b])\n\t\treturn y[a]<y[b];\n\treturn x[a]<x[b];\n}\nstruct edge{int u,v;double d;}e[M];\ninline bool ce(edge a,edge b){\n\treturn a.d<b.d;\n}\nint tot=0;//\u53ef\u7528\u8fb9\u6570 \ninline void init(){\n\tfor(rint i=1;i<=n;++i){\n\t\tq[i]=i;\n\t\tfor(rint j=1;j<=k;++j){\n\t\t\tdis[i][j]=inf;\n\t\t\tver[i][j]=0;\n\t\t}\n\t}mx=1e17;\n\tsort(q+1,q+1+n,cp);\n\tfor(rint i=1;i<=n;++i){\n\t\tint u=q[i];\n\t\tfor(rint j=i-1;j>=1;--j){\n\t\t\tint v=q[j];\n\t\t\tif(x[u]-x[v]>mx)break;\n\t\t\tupd(u,v);\n\t\t\t//\u5355\u5411\u66f4\u65b0\u5c31\u53ef\u4ee5\u4e86,uv\u548cvu\u90fd\u662f\u4e00\u6837\u7684\n\t\t\t//\u4fdd\u8bc1\u8fb9\u4e0d\u91cd\u4e0d\u6f0f \n\t\t}\n\t}\n\t//\u6700\u540e\u52a0\u8fb9\u5c31\u6ca1\u6709q\u4ec0\u4e48\u4e8b\u4e86 \n\tfor(rint u=1;u<=n;++u){\n\t\tfor(rint j=1;j<=k;++j){\n\t\t\tif(dis[u][j]>mx)break;\n\t\t\tint v=ver[u][j];\n\t\t\te[++tot]=edge{u,v,dis[u][j]};\n\t\t}\n\t}\n\tsort(e+1,e+1+tot,ce);\n}\nint fa[N];bool vis[N][K]={0};\nint find(int x){\n\tif(x==fa[x])return x;\n\treturn fa[x]=find(fa[x]);\n}\n//\u628ab\u5408\u5e76\u5230a\u4e0a\uff0c\u8fd4\u56de%k=0\u7684\u60c5\u51b5 \ninline bool merge(int a,int b){\n\tfa[b]=a;bool res[K]={0};\n\tfor(rint i=0;i<k;++i){\n\t\tres[i]|=vis[a][i]|vis[b][i];\n\t\tfor(rint j=0;j<k;++j)\n\t\t\tres[(i+j)%k]|=vis[a][i]&vis[b][j];\n\t}\n\tmemcpy(vis[a],res,sizeof res);\n\treturn vis[a][0];\n}\ninline void solve(){\n\tfor(rint i=1;i<=n;++i){\n\t\tfa[i]=i;\n\t\tvis[i][w[i]%k]=true;\n\t\tif(w[i]%k==0)return;\n\t}\n\tfor(rint i=1;i<=tot;++i){\n\t\tint u=e[i].u,v=e[i].v;;\n\t\tu=find(u);v=find(v);\n\t\tif(u==v)continue;\n\t\tif(merge(u,v)){ans=e[i].d;break;}\n\t}\n}\nint main(){\n\tn=read();k=read();\n\tfor(rint i=1;i<=n;++i)\n\t\tscanf(\"%lf%lf%d\",&x[i],&y[i],&w[i]);\n\tcg();init();solve();\n\tprintf(\"%.3lf\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1632446443,
        "uid": 206258,
        "name": "SDNetFriend",
        "ccfLevel": 7,
        "title": "P7862 [COCI2015-2016#2] DR\u017dAVA \u9898\u89e3"
    },
    {
        "content": "## [P7862 [COCI2015-2016#2] DR\u017dAVA](https://www.luogu.com.cn/problem/P7862)\r\n\r\n**\u3010\u9898\u610f\u7b80\u8ff0\u3011**\r\n\r\n\u5728\u4e00\u4e2a\u5e73\u9762\u4e0a\u7ed9\u5b9a $n$ \u4e2a\u70b9\uff0c\u6bcf\u4e2a\u70b9\u6709\u4e00\u7ec4\u5750\u6807\u5e76\u4e14\u6709\u4e00\u4e2a\u6743\u91cd $w$\uff0c\u5408\u5e76\u4e24\u70b9\u7684\u4ee3\u4ef7\u4e3a\u4e24\u70b9\u95f4\u8ddd\u79bb\uff0c\u7ed9\u5b9a\u5e38\u6570 $K$\uff0c\u6c42\u4e00\u79cd\u65b9\u6848\u7684\u4f7f\u5f97\u5408\u5e76\u51fa\u7684\u70b9\u5b58\u5728\u4e00\u4e2a\u5b50\u96c6\u4f7f\u5f97 $(\\sum_{i=1}^{s}w_i) \\bmod K$ \u4e3a $0$\uff0c\u5e76\u4e14\u6700\u5c0f\u5316\u6240\u6709\u5408\u5e76\u4ee3\u4ef7\u4e2d\u7684\u6700\u5927\u503c $D$\uff08$s$ \u4e3a\u5b50\u96c6\u5927\u5c0f\uff0c$i$ \u4e3a\u5728\u5b50\u96c6\u4e2d\u7684\u8282\u70b9\u7f16\u53f7\uff09\u3002\r\n\r\n**\u3010\u89e3\u9898\u601d\u8def\u3011**\r\n\r\n\u770b\u5b8c\u9898\uff0c\u5e94\u8be5\u53ef\u4ee5\u53d1\u73b0\u9898\u76ee\u6240\u6c42\u7684 $D$ \u663e\u7136\u662f\u5177\u6709\u5355\u8c03\u6027\u7684\uff0c\u53ef\u4ee5\u8003\u8651\u4e8c\u5206\u7b54\u6848\u6c42\u89e3\u3002\r\n\r\n\u8bbe\u4e8c\u5206\u7684\u7b54\u6848\u4e3a $d$\uff0c\u63a5\u4e0b\u6765\u8003\u8651\u68c0\u9a8c\u6bcf\u4e2a\u7b54\u6848\u53ef\u4e0d\u53ef\u884c\uff0c\u5148\u8003\u8651\u66b4\u529b\u7684\u601d\u8def\uff0c\u66b4\u529b\u679a\u4e3e\u6bcf\u4e2a\u53ef\u80fd\u7684\u70b9\u5bf9 $(i,j)$\uff0c\u5bf9\u4e8e\u6240\u6709 $\\operatorname{dis}(i,j)<d$ \u7684\u60c5\u51b5\uff0c\u90fd\u66b4\u529b\u5c06 $i$\uff0c$j$ \u7ef4\u62a4\u5728\u4e00\u8d77\uff0c\u5408\u5e76\u7b54\u6848\u7684\u53ef\u80fd\u7ed3\u679c\u3002\r\n\r\n\u8003\u8651 $K$ \u5f88\u5c0f\uff0c\u5c31\u4ec5\u5b58\u50a8 $val \\bmod K$ \u4e4b\u540e\u7684\u503c\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\u90fd\u5f00\u4e00\u4e2a\u5927\u5c0f\u4e3a $30$ \u7684\u6570\u7ec4\u8bb0\u5f55\u53ef\u4e0d\u53ef\u4ee5\u5f97\u5230\u8fd9\u4e2a\u4f59\u6570\u3002\u800c\u5bf9\u4e8e\u5408\u5e76\u4f59\u6570\u7684\u64cd\u4f5c\u6709\u4e00\u79cd\u4f18\u5316\u65b9\u6848\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u96c6\u5408\u4ec5\u7ef4\u62a4\u96c6\u5408\u7684\u6839\u7684\u4fe1\u606f\u3002\u5f53\u5408\u5e76\u4e24\u4e2a\u96c6\u5408\u65f6\uff0c\u4e5f\u4ec5\u5408\u5e76\u6839\u7684\u4fe1\u606f\uff0c\u6548\u7387\u4e3a $O(K^2)$\u3002\u800c\u5408\u5e76\u96c6\u5408\u53ef\u4ee5\u7528\u5e76\u67e5\u96c6\u4f18\u5316\uff0c\u6548\u7387\u4e3a $O(\\log N)$ \u3002\r\n\r\n\u4f46\u662f\u8003\u8651\u5230 $N$ \u7684\u5927\u5c0f\u4e3a $5\\times 10^4$ \u66b4\u529b\u679a\u4e3e\u8fb9\u4e00\u5b9a\u4f1a TLE\uff0c\u56e0\u6b64\u8003\u8651\u6392\u5e8f\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\u4ee5 $x$ \u4e3a\u5173\u952e\u5b57\u6392\u5e8f\uff0c\u800c\u679a\u4e3e\u53ef\u80fd\u7684\u70b9\u5bf9\u65f6\uff0c\u4ec5\u8003\u8651 $x_j - x_i < d$ \u7684\u70b9\u5bf9\uff0c\u7531\u4e8e\u5df2\u7ecf\u6392\u5e8f\u4e86\uff0c\u6240\u4ee5\u5982\u679c $x_j - x_i < d$ \u4e86\uff0c\u90a3\u4e48\u4e4b\u540e\u7684\u70b9\u5bf9\u4e5f\u4e00\u5b9a\u4e0d\u5408\u6cd5\u4e86\u3002\r\n\r\n\u5177\u4f53\u7ec6\u8282\u89c1\u4ee3\u7801\u3002\r\n\r\n**\u3010AC \u4ee3\u7801\u3011**\r\n\r\n```cpp\r\n#include<bits/stdc++.h>\r\n#define MAXN 50505\r\nusing namespace std;\r\nstruct Node{\r\n\tint x, y, val; // x\u3001y \u5b58\u50a8\u539f\u59cb\u5750\u6807\r\n\tdouble _x, _y; // _x\u3001_y \u5b58\u50a8\u53d8\u6362\u540e\u5750\u6807\r\n} dot[MAXN];\r\nint fa[MAXN], N, K; // \u5e76\u67e5\u96c6 & \u8bfb\u5165\r\nbool modify[32], rest[MAXN][32]; // rest[x] \u8868\u793a\u6bcf\u4e2a\u4ee5x\u4e3a\u6839\u7684\u96c6\u5408\uff0c\u6a21\u4e0aK\u7684\u53ef\u80fd\u4f59\u6570 modify \u7528\u6765\u5b58\u50a8\u4fee\u6539\u8fc7\u7a0b\u4e2d\u7684\u6570\u7ec4\r\ninline bool cmp(const Node &a, const Node &b) { return a._x == b._x ? a._y < b._y : a._x < b._x; } // \u4ee5\u65cb\u8f6c45\u5ea6\u540e\u7684\u5750\u6807\u6392\u5e8f\r\ninline double dis(int a, int b) { return sqrt(1.0 * (dot[a].x - dot[b].x) * (dot[a].x - dot[b].x) + 1.0 * (dot[a].y - dot[b].y) * (dot[a].y - dot[b].y)); }\r\ninline int find(int x) { while (fa[x]) x = fa[x]; return x; }\r\ninline void trans() {\r\n\tdouble rotate = 1.0 / 1.414;\r\n\tfor (int i = 1; i <= N; ++i) {\r\n\t\tdot[i]._x = dot[i].x * 1.0 * rotate + dot[i].y * 1.0 * rotate;\r\n\t\tdot[i]._y = -dot[i].x * 1.0 * rotate + dot[i].y * 1.0 * rotate;\t\t\r\n\t}\r\n} //\u5750\u6807\u53d8\u6362\r\n\r\ninline bool check(double mid) {\r\n\tmemset(fa, 0, sizeof(fa)); // \u6ce8\u610f\u521d\u59cb\u5316\r\n\tmemset(rest, 0, sizeof(rest));\r\n\tfor (int i = 1; i <= N; ++i) rest[i][dot[i].val] = 1; // \u91cd\u8bbe\u6bcf\u4e2a\u70b9\u7684\u521d\u59cb\u53ef\u80fd\u4f59\u6570\r\n\tfor (int i = 1; i <= N; ++i) {\r\n\t\tfor (int j = i + 1; j <= N; ++j) {\r\n\t\t\tmemset(modify, 0, sizeof(modify)); // \u521d\u59cb\u5316\u8f85\u52a9\u6570\u7ec4\r\n\t\t\tif (dot[j]._x - dot[i]._x >= 1.15 * mid) break; // *1.15 \u662f\u4e3a\u4e86\u4fdd\u9669\r\n\t\t\tint ru = find(i), rv = find(j); // \u627e\u5230\u6839\u8282\u70b9\r\n\t\t\tif (dis(i, j) > mid || ru == rv) continue; // \u5982\u679c\u5f53\u524d\u679a\u4e3e\u4e24\u70b9\u8ddd\u79bb\u6bd4\u9884\u60f3\u7684\u5927\r\n\t\t\tfor (int i = 0; i < K; ++i)\r\n\t\t\t\tif (rest[ru][i]) \r\n\t\t\t\t\tfor (int j = 0; j < K; ++j)\r\n\t\t\t\t\t\tif (rest[rv][j]) modify[(i + j) % K] = 1;\r\n\t\t\tfor (int i = 0; i < K; ++i) rest[ru][i] |= (modify[i] | rest[rv][i]); // \u5408\u5e76\u96c6\u5408\r\n\t\t\tfa[j] = i; // union \u64cd\u4f5c\r\n\t\t\tif (rest[ru][0]) return true; // \u5982\u679c\u7b26\u5408\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nint main() {\r\n\tscanf(\"%d %d\", &N, &K);\r\n\tfor (int i = 1; i <= N; ++i) {\r\n\t\tscanf(\"%d %d %d\", &dot[i].x, &dot[i].y, &dot[i].val);\r\n\t\tdot[i].val %= K; // \u9884\u5904\u7406 val \u503c\r\n\t}\r\n\ttrans();\r\n\tsort(dot + 1, dot + N + 1, cmp);\r\n\tdouble L = 0, R = 50000000, mid;\r\n\twhile (R - L > 0.0001) { // \u4e8c\u5206\u7b54\u6848\r\n\t\tmid = (L + R) / 2;\r\n\t\tif (check(mid)) R = mid;\r\n\t\telse L = mid;\r\n\t}\r\n\tprintf(\"%.3lf\\n\", mid);\r\n\treturn 0;\r\n}\r\n\r\n```\r\n\r\n",
        "postTime": 1663895751,
        "uid": 675237,
        "name": "DiruiXiao",
        "ccfLevel": 6,
        "title": "P7862 [COCI2015-2016#2] DR\u017dAVA"
    },
    {
        "content": "\u9002\u5f53\u8fdb\u884c\u9a97\u5206\u662f\u771f\u7684\u6709\u7528\u3002\n\n$40pts$\uff1a\n\n\u5bf9\u4e8e\u6bcf\u4e24\u4e2a\u70b9\u5efa\u7acb\u4e00\u6761\u8fb9\uff0c\u7136\u540e\u5728\u8d2a\u5fc3\u6bcf\u6b21\u6c42\u6700\u5c0f\u8fb9\uff0c\u5728\u671f\u95f4\u8fdb\u884c01\u80cc\u5305\u5373\u53ef\uff0c01\u80cc\u5305\u7528\u4e8e\u5904\u7406\u6a21\u6570\u3002\n\n\u8bbe $dp_{i,j}$ \u4ee3\u8868\u4ee5 $i$ \u4e3a\u7f16\u53f7\u7684\u4e00\u4e2a\u5e76\u67e5\u96c6\uff0c\u5b50\u96c6\u7684\u548c\u6a21\u6570\u662f\u5426\u53ef\u4ee5\u4e3a $j$\u3002\n\n\u6bcf\u6b21\u5c06 $t$ \u96c6\u5408\u5408\u5e76\u7ed9 $i$ \u96c6\u5408\u3002\n\n$dp_{i,j}|=dp_{t,j}$\n\n\u518d\u4ece $1$ \u5230 $n$ \u679a\u4e3e $k$ \u96c6\u5408\u4e2d\u7684\u6570 $p$\u3002\uff08\u5982\u679c\u679a\u4e3e $0$ \u8bf4\u660e\u5728\u6b64\u5df2\u7ecf\u6709\u7b54\u6848\u4e86\uff0c\u6240\u4ee5\u679a\u4e3e $0$ \u65e0\u610f\u4e49\uff09\n\n$dp_{i,j}|=dp_{t,(j+p)\\bmod k}$\n\n\u5f53\u5408\u5e76\u540e $dp_{i,0}=1$\uff0c\u53d6\u8fd9\u6761\u8fb9\u4e3a\u7b54\u6848\u5373\u53ef\u3002\n\n\u975e\u6b63\u89e3\u505a\u6cd5\uff08\u8fd9\u91cc\u6ce8\u91cd\u8003\u573a\u4e0a\u6ca1\u60f3\u51fa\u6765\u5982\u4f55\u9a97\u5206\uff0c\u770b\u6b63\u89e3\u53ef\u4ee5\u79fb\u6b65\u5176\u4ed6\u9898\u89e3\uff0c\u6ce8\uff1a\u76ee\u524d\u8fd9\u4e2a\u89e3\u6cd5\u53ef\u4ee5\u8fc7\uff09\uff1a\n\n\u4e00\u6765\u60f3\u4e0d\u592a\u51fa\u6765\uff0c\u4f46\u662f\u63a8\u51fa\u4e2a\u7ed3\u8bba\uff0c\u8981\u63a8\u51fa\u6a21\u6570 $0$\uff0c\u6700\u591a\u9700 $k$ \u4e2a\u6570\u3002\n\n\u8bc1\u660e\uff1a\u5982\u679c\u4e00\u4e2a\u65b0\u7684\u6570\u52a0\u8fdb\u6765\uff0c\u4e0d\u4f1a\u4ea7\u751f\u5176\u4ed6\u6a21\u6570\uff0c\u90a3\u4e48\u539f\u6765\u7684\u6a21\u6570\u662f\u4e2a\u7b49\u5dee\u6570\u5217\uff0c\u5e76\u4e14\u7b49\u5dee\u6570\u5217\u4f1a\u4ece $0$ \u5f00\u59cb\uff0c\u516c\u5dee\u4e3a\u65b0\u6570\uff0c\u6240\u4ee5\u539f\u6765\u53d6\u7684\u6570\u90fd\u662f\u4e00\u6837\u7684\u3002\u5982\u679c\u4e0d\u4f1a\u4ea7\u751f\u6a21\u6570\uff0c\u90a3\u4e48\u8bc1\u660e\u8fd9\u4e9b\u76f8\u540c\u7684\u6570 $x$ \u6ee1\u8db3 $k\\bmod x=0$\uff0c\u90a3\u4e48\u6b64\u65f6\u53ea\u9700\u8981\u7528 $k\\div x$ \u5373\u53ef\u63a8\u51fa\u6a21\u6570 $0$\uff0c\u5982\u679c\u53ef\u4ee5\u66f4\u65b0\u6a21\u6570\u6bcf\u4e00\u6b21\u66f4\u65b0\u4e00\u4e2a\uff0c\u6700\u591a\u9700\u8981 $k$ \u6b65\uff0c\u82e5 $x=1$ \u4e5f\u662f $k$ \u6b65\uff0c\u5373\u53ef\u8bc1\u3002\n\n\u90a3\u4e48\u53ef\u4ee5\u60f3\u5230\u5176\u5b9e\u53ea\u9700\u8981\u6c42\u4e00\u4e2a\u70b9\u79bb\u7684\u6700\u8fd1\u7684 $k$ \u4e2a\u70b9\u5373\u53ef\u3002\n\n\u5982\u679c\u5728\u8003\u573a\u60f3\u4e0d\u5230\u4e8c\u5206\u4ec0\u4e48\u7684\uff0c\u5e94\u8be5\u8003\u8651\u63e3\u6469\u51fa\u9898\u4eba\u5fc3\u7406\uff0c\u8fdb\u884c\u5173\u952e\u5b57\u6392\u5e8f\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u70b9 $(x,y)$\uff1a\n\n\u4ee5 $x$ \u4e3a\u5173\u952e\u5b57\u6392\u5e8f\uff1a$160pts$\u3002\n\n\u4ee5 $y$ \u4e3a\u5173\u952e\u5b57\u6392\u5e8f\uff1a$160pts$\n\n\u4ee5 $x^2+y^2$ \u4e3a\u5173\u952e\u5b57\u6392\u5e8f\uff1a$160pts$\n\n\u4ee5 $x\\times y$ \u4e3a\u5173\u952e\u5b57\u6392\u5e8f\uff1a$160pts$\n\n\u4ee5 $x^2+y^2-2x-2y$ \u4e3a\u5173\u952e\u5b57\u6392\u5e8f\uff1a$160pts$\n\n\u2026\u2026\n\n~~\u597d\u5427\u5f53\u6211\u6ca1\u8bf4\u3002~~\n\n\u8fd9\u91cc\u9009\u62e9\u7b2c\u4e09\u79cd\u6392\u5e8f\uff0c\u6392\u5e8f\u540e\u53d6\u5728\u81ea\u5df1\u540e\u9762\u7684\u70b9\uff0c\u8fd9\u91cc\u56e0\u4e3a $k\\le30$\uff0c\u6240\u4ee5\u9009\u62e9 $40$ \u4e2a\u70b9\u7a33\u4e00\u70b9\u3002\n\n\u6700\u540e\u4e0e\u4e0a\u9762\u505a\u6cd5\u5c31\u4e00\u6837\u4e86\uff0c\u591a\u52a0\u4e86\u4e2a\u542f\u53d1\u5f0f\u5408\u5e76\uff0c\u5bf9\u4e8e\u5355\u72ec\u4e00\u4e2a\u70b9\u7684\u5e76\u67e5\u96c6\u63d2\u5165\u8fdb\u884c\u7279\u6b8a\u5904\u7406\uff0c\u4e0d\u7528\u4e5f\u53ef\u4ee5\u8fc7\u3002\n\n\u603b\u7ed3\uff1a\u5982\u679c\u8003\u8bd5\u60f3\u4e0d\u51fa\u6765\uff0c\u5229\u7528\u4e00\u4e9b\u975e\u6b63\u5e38\u529e\u6cd5\u4e5f\u53ef\u4ee5\u62ff\u9ad8\u5206\u7684\u3002\n\n\u590d\u6742\u5ea6 $O(k\\times n\\times \\log(n))$\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\n#define int long long\nusing namespace std;\nconst int N=5e4+5;\nint n,k,cnt,f[N],siz[N],s[N][35],q[N];\nstruct node\n{\n\tint x,y,data;\n}a[N];\nint cmp(node fi,node se)\n{\n\treturn fi.x*fi.x+fi.y*fi.y<se.x*se.x+se.y*se.y;\n}\nstruct node2\n{\n\tint from,to,data;\n}t[N*40];\nint cmp2(node2 fi,node2 se)\n{\n\treturn fi.data<se.data;\n}\nint afind(int x)\n{\n\tif(f[x]==x)return x;\n\treturn f[x]=afind(f[x]);\n}\nint krus()\n{\n\tfor(int i=1;i<=cnt;i++)\n\t{\n\t\tint from=afind(t[i].from),to=afind(t[i].to);\n\t\tif(from==to)continue;\n\t\tif(siz[to]==1)swap(from,to);\n\t\tfor(int j=1;j<k;j++)q[j]=0;\n\t\tfor(int j=1;j<k;j++)\n\t\t{\n\t\t\tif(!s[to][j])continue;\n\t\t\tif(siz[from]==1)q[(j+a[from].data)%k]=1,q[a[from].data]=1;\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor(int p=1;p<k;p++)\n\t\t\t\t{\n\t\t\t\t\tif(!s[from][p])continue;\n\t\t\t\t\tq[(j+p)%k]=1;\n\t\t\t\t\tq[p]=1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int j=0;j<k;j++)s[to][j]|=q[j];\n\t\tsiz[to]+=siz[from];\n\t\tf[from]=to;\n\t\tif(s[to][0])return t[i].data;\n\t}\n\treturn t[cnt].data;\n}\nsigned main()\n{\n\t//freopen(\"drzava.in\",\"r\",stdin);\n\t//freopen(\"drzava.out\",\"w\",stdout);\n\tscanf(\"%lld%lld\",&n,&k);\n\tfor(int i=1;i<=n;i++)scanf(\"%lld%lld%lld\",&a[i].x,&a[i].y,&a[i].data),a[i].data%=k;\n\tsort(a+1,a+1+n,cmp);\n\tint kt=2000000ll/n;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tf[i]=i;\n\t\tsiz[i]=1;\n\t\ts[i][a[i].data]=1;\n\t\tfor(int j=i+1;j<=min(n,i+kt);j++)t[++cnt]=(node2){i,j,(a[i].x-a[j].x)*(a[i].x-a[j].x)+(a[i].y-a[j].y)*(a[i].y-a[j].y)};\n\t}\n\t\n\tsort(t+1,t+1+cnt,cmp2);\n\tdouble ans=sqrt(1.0*krus());\n\tprintf(\"%.3lf\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1663837901,
        "uid": 275793,
        "name": "Gmt\u4e36FFF",
        "ccfLevel": 5,
        "title": "P7862 [COCI2015-2016#2] DR\u017dAVA \u9898\u89e3"
    }
]
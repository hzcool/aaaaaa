[
    {
        "content": "\u8981\u505a\u8fd9\u9053\u9898\uff0c\u5148\u4fdd\u8bc1\u4f60\u4f1a[\u591a\u9879\u5f0f\u6c42\u9006](https://www.luogu.org/problemnew/show/P4238)\u3002\n\n\u518d\u53d1\u4e00\u4e0b\u6211\u53c2\u8003\u7684\u535a\u5ba2: [Miskcoo's Space](http://blog.miskcoo.com/2015/05/polynomial-division)\u3002\n\n\u5177\u4f53\u6765\u8bf4\uff0c\u8bbe\u591a\u9879\u5f0f $A$ \u4e3a $n$ \u6b21\u591a\u9879\u5f0f\uff0c\u8003\u8651\u4e00\u79cd\u64cd\u4f5c $R$ \uff0c\u4f7f\u5f97\n\n$$A_R(x) = x^n A(\\frac{1}{x})$$\n\n\u7a0d\u5fae\u60f3\u8c61\u4e00\u4e0b\uff0c\u53ef\u4ee5\u53d1\u73b0 $A_R[i] = A[n-i]$ ( $[i]$ \u8868\u793a\u591a\u9879\u5f0f\u7684\u7b2c $i$ \u6b21\u7cfb\u6570)\u3002\n\n\u8fd9\u4e2a\u64cd\u4f5c\u53ef\u4ee5 $O(n)$ \u5b8c\u6210\u3002\n\n\u7136\u540e\u5f00\u59cb\u5316\u5f0f\u5b50\u3002\n\n$$F(x) = Q(x) * G(x) + R(x)$$\n\n$$F(\\frac{1}{x}) = Q(\\frac{1}{x}) * G(\\frac{1}{x}) + R(\\frac{1}{x})$$\n\n$$x^n F(\\frac{1}{x}) = x^{n-m} Q(\\frac{1}{x}) * x^m G(\\frac{1}{x}) + x^{n-m+1} * x^{m-1} R(\\frac{1}{x})$$\n\n$$F_R(x) = Q_R(x) * G_R(x) + x^{n-m+1} * R_R(x)$$\n\n$$F_R(x) \\equiv Q_R(x) * G_R(x) + x^{n-m+1} * R_R(x)\\pmod {x^{n-m+1}}$$\n\n$$F_R(x) \\equiv Q_R(x) * G_R(x)\\pmod {x^{n-m+1}}$$\n\n$$Q_R(x) \\equiv F_R(x) * G_R^{-1}(x)\\pmod {x^{n-m+1}}$$\n\n\u6c42\u4e00\u904d $G_R$ \u7684\u9006\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u5229\u7528\u591a\u9879\u5f0f\u4e58\u6cd5\u6c42\u51fa $Q$ \u3002\u7136\u540e\n\n$$R(x) = F(x) - G(x) * Q(x)$$\n\n\u76f4\u63a5\u8ba1\u7b97\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\log n)$\u3002\n\n\u4ee3\u7801:\n\n```cpp\n#include<bits/stdc++.h>\n#define For(i,a,b) for(i=(a);i<=(b);++i)\n#define Forward(i,a,b) for(i=(a);i>=(b);--i)\n#define Rep(i,a,b) for(register int i=(a),i##end=(b);i<=i##end;++i)\n#define Repe(i,a,b) for(register int i=(a),i##end=(b);i>=i##end;--i)\nusing namespace std;\ntemplate<typename T>inline void read(T &x){\n    T s=0,f=1;char k=getchar();\n    while(!isdigit(k)&&k^'-')k=getchar();\n    if(!isdigit(k)){f=-1;k=getchar();}\n    while(isdigit(k)){s=s*10+(k^48);k=getchar();}\n    x=s*f;\n}\nvoid file(void){\n    #ifndef ONLINE_JUDGE\n    freopen(\"NTT.in\",\"r\",stdin);\n    freopen(\"NTT.out\",\"w\",stdout);\n    #endif\n}\nconst int MAXN=1<<20;\n\ntypedef long long ll;\n\nnamespace polynomial\n{\n\tstatic int mod=998244353,gen=3,g[21],rev[MAXN],Len;\n\n\tinline int ad(int a,int b){return (a+=b)>=mod?a-mod:a;}\n\n\tinline int power(int a,int b)\n\t{\n\t\tstatic int sum;\n\t\tfor(sum=1;b;b>>=1,a=(ll)a*a%mod)if(b&1)\n\t\t\tsum=(ll)sum*a%mod;\n\t\treturn sum;\n\t}\n\n\tinline void predone()\n\t{\n\t\tstatic int i,j;\n\t\tfor(i=1,j=2;i<=19;++i,j<<=1)g[i]=power(gen,(mod-1)/j);\n\t}\n\n\tinline void calrev(int Len)\n\t{\n\t\tstatic int Logl;Logl=(int)floor(log(Len)/log(2)+0.3)-1;\n\t\tRep(i,1,Len-1)rev[i]=(rev[i>>1]>>1)|((i&1)<<Logl);\n\t}\n\n\tinline void NTT(int X[],int typ)\n\t{\n\t\tRep(i,1,Len-1)if(i<rev[i])swap(X[i],X[rev[i]]);\n\t\tstatic int i,j,k,kk,w,t,wn,r;\n\t\tfor(k=2,kk=1,r=1;k<=Len;k<<=1,kk<<=1,++r)\n\t\t{\n\t\t\twn=g[r];\n\t\t\tfor(i=0;i<Len;i+=k)for(j=0,w=1;j<kk;++j,w=(ll)w*wn%mod)\n\t\t\t{\n\t\t\t\tt=(ll)w*X[i+j+kk]%mod;\n\t\t\t\tX[i+j+kk]=ad(X[i+j],mod-t);\n\t\t\t\tX[i+j]=ad(X[i+j],t);\n\t\t\t}\n\t\t}\n\t\tif(typ==-1)\n\t\t{\n\t\t\treverse(X+1,X+Len);\n\t\t\tstatic int invn;invn=power(Len,mod-2);\n\t\t\tRep(i,0,Len-1)X[i]=(ll)X[i]*invn%mod;\n\t\t}\n\t}\n\n\tstatic int x[MAXN],y[MAXN];\n\tinline void mul(int a[],int b[])\n\t{\n\t\tmemset(x,0,sizeof x);memset(y,0,sizeof y);\n\t\tRep(i,0,(Len>>1)-1)x[i]=a[i],y[i]=b[i];\n\t\tNTT(x,1);NTT(y,1);\n\t\tRep(i,0,Len-1)x[i]=(ll)x[i]*y[i]%mod;\n\t\tNTT(x,-1);\n\t\tRep(i,0,Len-1)a[i]=x[i];\n\t}\n\t\n\tstatic int c[2][MAXN];\n\t\n\tinline void Inv(int a[],int n)\n\t{\n\t\tstatic int t;t=0;\n\t\tmemset(c,0,sizeof c);\n\t\tc[0][0]=power(a[0],mod-2);\n\t\tLen=2;\n\t\twhile(Len<=(n<<1))\n\t\t{\n\t\t\tLen<<=1;\n\t\t\tcalrev(Len);t^=1;\n\t\t\tmemset(c[t],0,sizeof c[t]);\n\t\t\tRep(i,0,Len)c[t][i]=ad(c[t^1][i],c[t^1][i]);\n\t\t\tmul(c[t^1],c[t^1]);mul(c[t^1],a);\n\t\t\tRep(i,0,Len)c[t][i]=ad(c[t][i],mod-c[t^1][i]);\n\t\t}\n\t\tRep(i,0,Len-1)a[i]=c[t][i];\n\t}\n}\nusing namespace polynomial;\n\nint n,m,F[MAXN],G[MAXN],Q[MAXN],R[MAXN],Gr[MAXN];\n\nint main(void){\n    file();\n\tread(n);read(m);\n\tRep(i,0,n)read(F[i]),Q[n-i]=F[i];\n\tRep(i,0,m)read(G[i]),Gr[m-i]=G[i];\n\tRep(i,n-m+2,m)Gr[i]=0;\n\tpredone();\n\tInv(Gr,n-m+1);\n\tmul(Q,Gr);\n\treverse(Q,Q+n-m+1);\n\tRep(i,n-m+1,n)Q[i]=0;\n\tRep(i,0,n-m)printf(\"%d \",Q[i]);\n\tputs(\"\");\n\twhile(Len<=(n<<2))Len<<=1;\n\tcalrev(Len);\n\tmul(Q,G);\n\tRep(i,0,m-1)printf(\"%d \",ad(F[i],mod-Q[i]));\n\tputs(\"\");\n\treturn 0;\n}\n```",
        "postTime": 1525695557,
        "uid": 7035,
        "name": "Great_Influence",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4512 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u9664\u6cd5\u3011"
    },
    {
        "content": "upd : \u4fee\u6b63\u4e86\u9898\u89e3\u683c\u5f0f\uff0c\u66f4\u6539\u4e86\u5c0f bug\uff0c\u66f4\u65b0\u4e86\u4ee3\u7801\uff0c~~\u52a0\u4e86 [cnblogs](https://www.cnblogs.com/zkyJuruo/p/14289013.html) \u7684\u94fe\u63a5~~\n\n## -1.\u63a8\u8350\n\n\u63a8\u8350\u4e00\u4e2a\u975e\u5e38\u597d\u7684blog\uff1a[$\\color{black}{\\text{F}}\\color{red}{\\text{roggy}}$\u7684\u591a\u9879\u5f0f\u5927\u6742\u70e9](https://www.luogu.com.cn/blog/1445353309froggy/duo-xiang-shi-tai-za-hui)\n\n## 0.\u524d\u8a00\n\n\u5fc5\u5907\u5185\u5bb9\uff1aNTT\uff0c\u591a\u9879\u5f0f\u6c42\u9006\n\n\u5efa\u8bae\u5230\u535a\u5ba2\u4e2d\u67e5\u770b\n\n## 1.\u6b63\u6587\n\u5b9a\u4e49 $F_R(x)$ \u4e3a\u628a $F(x)$ \u7cfb\u6570\u7ffb\u8f6c\u540e\u7684\u51fd\u6570\n\n\u82e5 $F_R(x)$ \u6b21\u6570\u4e3a $k$ \uff0c\u90a3\u4e48 $F_R(x)=F(\\frac{1}{x})*x^k$\n\n\u82e5 $f(x)=g(x)*q(x)+r(x)$\uff0c $f$ \u6b21\u6570\u4e3a $n$ \uff0c$g$ \u6b21\u6570\u4e3a $m$\uff0c $q$ \u6b21\u6570\u4e3a $n-m$ \uff0c $r$ \u6b21\u6570\u4e3a $m-1$\n\n\u6211\u4eec\u53ef\u4ee5\u628a $\\frac{1}{x}$ \u5e26\u5165\u51fd\u6570\n\n\u5f97\n$$f(\\frac{1}{x})=g(\\frac{1}{x})*q(\\frac{1}{x})+r(\\frac{1}{x})$$\n\n\n$$f(\\frac{1}{x})*x^n=g(\\frac{1}{x})*x^mq(\\frac{1}{x})*x^{n-m}+r(\\frac{1}{x})*x^{m-1}*x^{n-m+1}$$\n\n$$f_R(x)=g_R(x)*q_R(x)+r_R(x)*x^{n-m+1}$$\n\n$$f_R(x) \\equiv g_R(x)*q_R(x) \\pmod {x^{n-m+1}}$$\n\n$$q_R(x)\\equiv \\frac{f_R(x)}{g_R(x)} \\pmod {x^{n-m+1}}$$\n\n\u4ece\u800c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053 $q(n) \\bmod x^{n-m+1}$\n\n\u6211\u4eec\u77e5\u9053 $q$ \u6b21\u6570\u4e3a $n-m$ \uff0c\u800c\u6a21\u6570\u6b21\u6570\u4e3a $n-m+1$\n\n\u4e8e\u662f\u5c31\u53ef\u4ee5\u7b97\u51fa $q$ \u5566\uff01\uff01\uff01\uff01\uff01\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u7528\n\n$$r(x)=f(x)-g(x)*q(x)$$\n\n\u7136\u540e $r$ \u4e5f\u7b97\u51fa\u6765\u5566\uff01\n\n## 2.\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define L(i, j, k) for(int i = j, i##E = k; i <= i##E; i++)\n#define R(i, j, k) for(int i = j, i##E = k; i >= i##E; i--)\n#define ll long long\n#define ull unsigned long long\n#define db double\n#define pii pair<int, int>\n#define mkp make_pair\nusing namespace std;\nconst int N = 524288, mod = 998244353, G = 3, iG = (mod + 1) / G;\nint qpow(int x, int y = mod - 2) {\n\tint res = 1;\n\tfor(; y; x = (ll) x * x % mod, y >>= 1) if(y & 1) res = (ll) res * x % mod;\n\treturn res;\n}\nint lim, pp[N];\nvoid revlim() { L(i, 0, lim - 1) pp[i] = ((pp[i >> 1] >> 1) | ((i & 1) * (lim >> 1))); }\nvoid up(int x) { lim = 1; for(; lim <= x; lim <<= 1); }\nvoid cle(int *f) { L(i, 0, lim - 1) f[i] = 0; }\nvoid NTT(int *f, int flag) {\n\tL(i, 0, lim - 1) if(pp[i] < i) swap(f[pp[i]], f[i]);\n\tfor(int i = 2; i <= lim; i <<= 1) \n\t\tfor(int j = 0, l = (i >> 1), ch = qpow(flag == 1 ? G : iG, (mod - 1) / i); j < lim; j += i) \n\t\t\tfor(int k = j, now = 1; k < j + l; k ++) {\n\t\t\t\tint pa = f[k], pb = (ll) f[k + l] * now % mod;\n\t\t\t\tf[k] = (pa + pb) % mod, f[k + l] = (pa + mod - pb) % mod;\n\t\t\t\tnow = (ll) now * ch % mod;\n\t\t\t}\n\tif(flag == -1) {\n\t\tint nylim = qpow(lim);\n\t\tL(i, 0, lim - 1) f[i] = (ll) f[i] * nylim % mod;\n\t}\n}\nint sav[N], sv[N];\nvoid inv(int *f, int *g, int len) { \n\tif(len == 1) return g[0] = qpow(f[0]), void();\n\tinv(f, g, (len + 1) >> 1), up(len << 1), cle(sav), copy(f, f + len, sav), revlim(), NTT(sav, 1), NTT(g, 1);\n\tL(i, 0, lim - 1) g[i] = (ll) g[i] * (2ll + mod - (ll) g[i] * sav[i] % mod) % mod;\n\tNTT(g, -1), fill(g + len, g + lim, 0);\n}\nint sava[N], savb[N];\nvoid div(int *f, int *g, int *ansa, int *ansb, int n, int m) {\n\tup(n << 1), cle(sava), cle(savb), copy(g, g + m, sava), reverse(sava, sava + m);\n\tinv(sava, savb, n), up(n << 1), revlim(), copy(f, f + n, sava), reverse(sava, sava + n);\n\tNTT(sava, 1), NTT(savb, 1); \n\tL(i, 0, lim - 1) ansa[i] = (ll) sava[i] * savb[i] % mod;\n\tNTT(ansa, -1), fill(ansa + n - m + 1, ansa + lim, 0), reverse(ansa, ansa + n - m + 1);\n\tcle(sav), cle(sava), copy(ansa, ansa + n - m + 1, sav), copy(g, g + m, sava), NTT(sav, 1), NTT(sava, 1);\n\tL(i, 0, lim - 1) sav[i] = (ll) sav[i] * sava[i] % mod;\n\tNTT(sav, -1);\n\tL(i, 0, m - 2) ansb[i] = (f[i] + mod - sav[i]) % mod;\n}\nint n, m, f[N], g[N], ansa[N], ansb[N];\nint main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0), cout.tie(0);\n\tcin >> n >> m, ++n, ++m;\n\tL(i, 0, n - 1) cin >> f[i];\n\tL(i, 0, m - 1) cin >> g[i];\n\tdiv(f, g, ansa, ansb, n, m);\n\tL(i, 0, n - m) cout << ansa[i] << \" \";\n\tcout << endl;\n\tL(i, 0, m - 2) cout << ansb[i] << \" \";\n\tcout << endl;\n\treturn 0;\n} \n```\n\n**\u795d\u5927\u5bb6\u5b66\u4e60\u6109\u5feb\uff01**",
        "postTime": 1589546969,
        "uid": 173660,
        "name": "zhoukangyang",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4512 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u9664\u6cd5\u3011"
    },
    {
        "content": "[P4512 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u9664\u6cd5](https://www.luogu.com.cn/problem/P4512)\n\n\u524d\u7f6e\u77e5\u8bc6: [\u591a\u9879\u5f0f\u6c42\u9006](https://www.luogu.com.cn/problem/P4238)\uff0c\u987a\u4fbf\u63a8\u9500\u7a9d\u7684 [blog](https://www.luogu.com.cn/blog/legendgod/duo-xiang-shi-qiu-ni-yuan)\u3002\n\n\u9898\u610f\u7b80\u8ff0\uff1a\n\n> \u7ed9\u5b9a\u591a\u9879\u5f0f $F, G$ \u6c42\u51fa\u591a\u9879\u5f0f $R, Q$ \u4f7f\u5f97 $F = G \\times Q + R$\u3002\n\n> \u5176\u4e2d $F$ \u7684\u6b21\u6570\u4e3a $n,G$ \u7684\u6b21\u6570\u4e3a $m$\u3002\n\n\u53ef\u4ee5\u60f3\u5230\u5982\u679c\u6ca1\u6709\u4f59\u6570\u7684\u8bdd\uff0c\u6211\u4eec\u76f4\u63a5\u7528\u591a\u9879\u5f0f\u6c42\u9006\u5c31\u53ef\u4ee5\u6c34\u6389\u3002\n\n\u56e0\u4e3a\u8fd9\u662f\u4e2a\u591a\u9879\u5f0f\uff0c\u6211\u4eec\u8003\u8651\u5c06 R \u7ed9\u6d88\u6389\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u4e0e\u6109\u5feb\u5f97\u6c42\u9006\u4e86\u3002\n\n\u8003\u8651\u6784\u9020 4 \u4e2a\u591a\u9879\u5f0f\uff0c\u6ee1\u8db3 $F_1 = G_1 \\times Q_1 + x^k R_1$ \u8fd9\u6837\u5b50\u53ea\u8981 $\\mod x^k$ \u5c31\u53ef\u4ee5\u5f97\u5230\u7b54\u6848\u4e86\u3002\u8003\u8651\u6784\u9020\u8fd9\u4e2a\u591a\u9879\u5f0f\uff0c\u4e3a\u4e86\u8ba9\u5916\u9762\u6709 $x^k$ \u8fd9\u4e2a\u7cfb\u6570\uff0c\u6240\u4ee5\u8003\u8651\u5c06 $F(x)$ \u53d8\u6210 $F(\\frac{1}{x})$\u3002 \u53ef\u4ee5\u77e5\u9053\u53d8\u6210\u8fd9\u6837\u4e4b\u540e\u7684\u5f0f\u5b50\u4ecd\u7136\u662f\u6ee1\u8db3\u7684\uff0c\u6211\u4eec\u8003\u8651\u4e24\u8fb9\u540c\u65f6\u4e58\u4ee5 $x^n$\u3002\n\n$x^nF(\\frac{1}{x}) = x^{n}G \\times Q + x^n R$ \u6211\u4eec\u8003\u8651 $x^nF(\\frac{1}{x})$ \u7684\u6bcf\u4e00\u4e2a\u7cfb\u6570\u5176\u5b9e\u7b49\u4ef7\u4e8e\u5c06\u539f\u6765\u7684 F \u7ed9\u7ffb\u8f6c\u4e00\u4e0b\u7684\u7cfb\u6570\u3002\u90a3\u4e48\u6211\u4eec\u4e0d\u59a8\u8ba9 $F_1 = x^nF(\\frac{1}{n}), Q_1 = x^mQ(\\frac{1}{n})$ \u5176\u4ed6\u540c\u7406\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5f97\u5230 $F_1 = G_1 \\times Q_1 + x^{n - m + 1}R_1$ \u770b\u51fa $k = n - m + 1$\u3002\u4e4b\u540e\u53d1\u73b0\u4e00\u4e2a\u795e\u5947\u7684\u4e8b\u60c5 $Q_1$ \u7684\u6b21\u6570\u662f $n - m$ \u6240\u4ee5\u6211\u4eec\u5373\u4f7f $\\mod x^{n - m + 1}$ \u4e5f\u4e0d\u4f1a\u5f71\u54cd $Q_1$\u3002\u6240\u4ee5\u6211\u4eec\u5f97\u5230\u5f0f\u5b50 $F_1(x) = G_1(x) \\times Q_1(x) \\mod x^{n - m + 1}$ \u4e5f\u5c31\u662f $Q_1(x) = \\frac{F_1(x)}{G_1(x)}$\u3002\n\n\u4e4b\u540e\u6211\u4eec\u6c42\u51fa\u4e86 $G_1$ \u4e4b\u540e\u5c06\u5176\u7ffb\u8f6c\u4e00\u4e0b\u5c31\u53d8\u6210 $G$ \u4e86\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u5f97\u5230 $R(x) = F(x) - G(x) \\times Q(x)$\u3002\n\n\u8fd9\u91cc\u7ed9\u51fa\u4e00\u4e2a\u5e2e\u52a9\u8c03\u8bd5\u7684\u6837\u4f8b\uff08\u5bf9\u62cd\u5f97\u5230\u7684\uff09\u3002\n\n\n**\u8f93\u5165\uff1a**\n```c++\n10 3\n31442 14973 29976 10529 12135 2982 26408 2967 8792 5912 32322\n26417 17680 17825 2260\n```\n**\u8f93\u51fa\uff1a**\n```cpp\n629124157 868682045 949778870 343287130 657387632 813303130 444869061 329508991\n197409070 189348691 393212223\n```\n\n\u8fd9\u91cc\u7ed9\u51fa\u6838\u5fc3\u4ee3\u7801\uff0c\u4e0b\u9762\u6709\u5b8c\u6574\u7684\u5c01\u88c5\u4ee3\u7801\u3002\n\n$Main\\ Code$\n\n```cpp\nPoly Quotient(Poly F, Poly G) {\n        for(int i = 0; i <= F.n; ++ i) if(i < F.n - i) swap(F.a[i], F.a[F.n - i]);\n        for(int i = 0; i <= G.n; ++ i) if(i < G.n - i) swap(G.a[i], G.a[G.n - i]);\n        int s = F.n + G.n;\n        G.n = F.n - G.n;\n        G.getroom(G.n);\n        Poly Ginv = G.Inv();\n//        for(int i = 0; i <= Ginv.n; ++ i) printf(\"%d \", Ginv.a[i].z);\n//        puts(\"\");\n        getrev(s << 1);\n//        puts(\"DDD\");\n        F.getroom(lim), Ginv.getroom(lim);\n        NTT(F, 1), NTT(Ginv, 1);\n        for(int i = 0; i < lim; ++ i) F.a[i] *= Ginv.a[i];\n        NTT(F, -1);\n        for(int i = Ginv.n + 1; i < lim; ++ i) F.a[i] = 0;\n        F.n = Ginv.n;\n        for(int i = 0; i <= F.n; ++ i) if(i < F.n - i) swap(F.a[i], F.a[F.n - i]);\n//        for(int i = 0; i <= F.n; ++ i) printf(\"%d \", F.a[i].z);\n//        puts(\"\");\n        return F;\n    }\n    pair<Poly,Poly> Div(Poly F) { // Quotient and rest\n        Poly Q = Quotient((*this), F), Z;\n        Z = Q;\n//        for(int i = 0; i <= Z.n; ++ i) printf(\"%d \", Z.a[i].z);\n//        puts(\"\");\n        getrev((*this).n << 1);\n        Q.getroom(lim), F.getroom(lim);\n        NTT(Q, 1), NTT(F, 1);\n        for(int i = 0; i < lim; ++ i) Q.a[i] = Q.a[i] * F.a[i];\n        NTT(Q, -1);\n        for(int i = (*this).n + 1; i < lim; ++ i) Q.a[i] = 0;\n        for(int i = 0; i < lim; ++ i) Q.a[i] = (*this).a[i] - Q.a[i];\n        Q.n = F.n - 1;\n        return make_pair(Z, Q);\n    }\n```\n\n\u56e0\u4e3a\u7a9d\u5f53\u65f6\u8c03\u4ee3\u7801\u7684\u65f6\u5019\uff0c\u5728\u9898\u89e3\u533a\u4e2d\u6ca1\u6709\u627e\u5230\u5c01\u88c5\u7684\u4ee3\u7801\uff0c\u6240\u4ee5\u653e\u4e00\u4efd\uff0c\u5e0c\u671b\u53ef\u4ee5\u5e2e\u5230\u5404\u4f4d\u5927\u4f6c\u3002\n\n\u5b8c\u6574\u7684\u5c01\u88c5\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n//#define Fread\n\n#ifdef Fread\n#define getchar() ((p1 == p2 && p2 = (p1 = buf) + fread(buf, 1, 1 << 21, stdin)) ? EOF : *p1 ++)\nchar buf[1 << 21], *p1, *p2;\n#endif // Fread\n\ntemplate <typename T>\nvoid r1(T &x) {\n    x = 0;\n    char c(getchar());\n    int f(1);\n    for(; !isdigit(c); c = getchar()) if(c == '-') f = -1;\n    for(; isdigit(c);c = getchar()) x = (x * 10) + (c ^ 48);\n    x *= f;\n}\n\nconst int maxn = 4e6 + 5; // \u5176\u5b9e\u53ea\u8981 2 \u500d\nconst int maxm = maxn << 1;\nconst int mod = 998244353;\nconst int g = 3, invg = 332748118;\ntypedef int room[maxn];\n\nint n, m;\nint rev[maxn], lim, len;\n\ntemplate <int mod>\nstruct typemod {\n    int z;\n    typemod(int a = 0) : z(a) {}\n    inline int inc(int a,int b) const {return a += b - mod, a + ((a >> 31) & mod);}\n    inline int dec(int a,int b) const {return a -= b, a + ((a >> 31) & mod);}\n    inline int mul(int a,int b) const {return 1ll * a * b % mod;}\n    typemod<mod> operator + (const typemod<mod> &x) const {return typemod(inc(z, x.z));}\n    typemod<mod> operator - (const typemod<mod> &x) const {return typemod(dec(z, x.z));}\n    typemod<mod> operator * (const typemod<mod> &x) const {return typemod(mul(z, x.z));}\n    typemod<mod>& operator += (const typemod<mod> &x) {*this = *this + x; return *this;}\n    typemod<mod>& operator -= (const typemod<mod> &x) {*this = *this - x; return *this;}\n    typemod<mod>& operator *= (const typemod<mod> &x) {*this = *this * x; return *this;}\n    int operator == (const typemod<mod> &x) const {return x.z == z;}\n    int operator != (const typemod<mod> &x) const {return x.z != z;}\n};\n\ntypedef typemod<mod> Tm;\n\nstruct Poly {\n    typedef vector<Tm> vtm;\n    vtm a;\n    int n; //\u8868\u793a\u6b21\u6570\n    void getroom(int x) { a.resize(x + 1); } //x \u8868\u793a\u6b21\u6570\n    Tm ksm(Tm x,int mi) {\n        Tm res(1);\n        while(mi) {\n            if(mi & 1) res = res * x;\n            mi >>= 1;\n            x = x * x;\n        }\n        return res;\n    }\n    int ksm(int x,int mi) {\n        int res(1);\n        while(mi) {\n            if(mi & 1) res = 1ll * res * x % mod;\n            mi >>= 1;\n            x = 1ll * x * x % mod;\n        }\n        return res;\n    }\n    inline void getrev(int x) { // \u6b21\u6570\n        ::lim = 1, ::len = 0;\n        while(lim <= x) ::lim <<= 1, ++ ::len;\n        for(int i = 1; i < lim; ++ i) ::rev[i] = ::rev[i >> 1] >> 1 | ((i & 1) << (::len - 1));\n    }\n    void NTT(vtm &A,int opt,int lim = ::lim) {\n        A.resize(lim);\n        for(int i = 0; i < lim; ++ i) if(i < rev[i]) swap(A[i], A[::rev[i]]);\n        for(int mid = 1; mid < lim; mid <<= 1) {\n            Tm gn = ksm((opt == 1) ? g : invg, (mod - 1) / (mid << 1));\n            for(int j = 0; j < lim; j += (mid << 1)) {\n                Tm w(1);\n                for(int k(0); k < mid; k += 1, w = w * gn) {\n                    Tm x = A[j + k], y = A[j + k + mid] * w;\n                    A[j + k] = x + y;\n                    A[j + k + mid] = x - y;\n                }\n            }\n        }\n        if(opt != 1) {\n            Tm z = ksm(Tm(lim), mod - 2);\n            for(int i = 0; i < lim; ++ i) A[i] = A[i] * z;\n        }\n    }\n    inline void NTT(Poly &A,int opt,int lim = ::lim) {return NTT(A.a, opt, lim), void();}\n    void Inv(const Poly F,Poly &G1,int x) { // x \u8868\u793a\u9879\u6570\n        if(x == 1) return G1.a[0] = ksm(F.a[0], mod - 2), void();\n        Inv(F, G1, (x + 1) >> 1);\n        Poly c = F;\n        getrev(x << 1);\n        c.getroom(lim);\n        for(int i = x; i < lim; ++ i) c.a[i] = 0;\n        NTT(c.a, 1), NTT(G1.a, 1);\n        for(int i = 0; i < lim; ++ i) G1.a[i] = (Tm(2) - c.a[i] * G1.a[i])* G1.a[i];\n        NTT(G1.a, -1);\n        for(int i = x; i < lim; ++ i) G1.a[i] = 0;\n    }\n    Poly Inv() {\n        Poly ans; ans.getroom(0);\n        Inv(*this, ans, n + 1);\n        ans.n = (*this).n;\n        return ans;\n    }\n    Poly Deri() {\n        Poly z = *this;\n        for(int i = 1; i <= z.n; ++ i) z.a[i - 1] = z.a[i] * i;\n        z.a[z.n] = 1;\n        z.n > 0 ? -- z.n : 0;\n        return z;\n    }\n    Poly reward() {\n        Poly z = *this;\n        z.getroom(z.n + 1);\n        for(int i = z.n; ~ i; -- i) z.a[i + 1] = z.a[i] * ksm(Tm(i + 1), mod - 2);\n        z.a[0] = 0;\n        return z;\n    }\n    Poly Ln() { // x \u6b21\n        Poly F = *this, ans = (*this).Inv();\n        F = F.Deri();\n        getrev((*this).n << 1);\n        NTT(F, 1), NTT(ans, 1);\n        for(int i = 0; i < lim; ++ i) ans.a[i] = ans.a[i] * F.a[i];\n        NTT(ans, -1);\n        ans = ans.reward();\n        ans.n = (*this).n;\n        return ans;\n    }\n    void Exp(const Poly a,Poly &b,int x) { //\u9879\u6570\n        if(x == 1) return b.a[0] = 1, b.n = 0, void();\n        Exp(a, b, (x + 1) >> 1);\n        getrev(x << 1);\n        b.getroom(lim), b.n = x - 1;\n        Poly lnb = b.Ln();\n        for(int i = 0; i < x; ++ i) lnb.a[i] = a.a[i] - lnb.a[i];\n        for(int i = x; i < lim; ++ i) lnb.a[i] = b.a[i] = 0;\n        lnb.a[0] += 1;\n        NTT(lnb, 1), NTT(b, 1);\n        for(int i = 0; i < lim; ++ i) b.a[i] = b.a[i] * lnb.a[i];\n        NTT(b, -1);\n        for(int i = x; i < lim; ++ i) b.a[i] = 0;\n        b.n = x - 1;\n    }\n    Poly Exp() {\n        Poly ans;\n        ans.getroom(0);\n        Exp(*this, ans, (*this).n + 1);\n        ans.n = (*this).n;\n        return ans;\n    }\n//    void Sqrt(const Poly a, Poly &b,int x) {\n//        Tm inv2 = ksm(Tm(2), mod - 2);\n//        b.n = 0, b.getroom(0), b.a[0] = 1;\n//        Poly A;\n//        for(int mid = 1; mid < (x << 1); mid <<= 1) {\n//            b.n = mid - 1;\n//            Poly invb = b.Inv();\n//            getrev(mid);\n//            invb.getroom(lim);\n//            A.getroom(lim);\n//            b.getroom(lim);\n//            for(int i = 0; i < mid; ++ i) A.a[i] = a.a[i];\n//            for(int i = mid; i < lim; ++ i) A.a[i] = 0;\n//            NTT(A, 1), NTT(invb, 1);\n//            for(int i = 0; i < lim; ++ i) A.a[i] *= invb.a[i];\n//            NTT(invb, -1);\n//            for(int i = 0; i < mid; ++ i) b.a[i] = (b.a[i] + A.a[i]) * inv2;\n//            for(int i = x; i < lim; ++ i) b.a[i] = 0;\n//            printf(\"%d : \", mid);\n//            for(int i = 0; i < mid; ++ i) printf(\"%d \", b.a[i].z);\n//            puts(\"\");\n//        }\n//        b.n = x - 1;\n//        for(int i = x; i < lim; ++ i) b.a[i] = 0;\n//    }\n     void Sqrt(const Poly a,Poly &b,int x,Tm inv2) {\n        if(x == 1) {b.a[0] = 1;return;}\n        Sqrt(a, b,(x + 1) >> 1, inv2);\n//        puts(\"DDD\");\n        b.n = x - 1;\n        Poly invb = b.Inv();\n        Poly D = a;\n        getrev(x << 1);\n        b.getroom(lim);\n        invb.getroom(lim);\n        D.getroom(lim);\n        for(int i = x; i < lim; ++ i) D.a[i] = 0;\n        NTT(D, 1), NTT(invb, 1);\n        for(int i = 0; i < lim; ++ i) D.a[i] *= invb.a[i];\n        NTT(D, -1);\n        for(int i = 0; i < x; ++ i) b.a[i] = (b.a[i] + D.a[i]) * inv2;\n        for(int i = x; i < lim; ++ i) b.a[i] = 0;\n    }\n    Poly Sqrt() {\n        Poly ans;\n        ans.getroom(0);\n        ans.n = 0;\n        Sqrt(*this, ans, n + 1, ksm(Tm(2), mod - 2));\n        ans.n = (*this).n;\n        return ans;\n    }\n    Poly Quotient(Poly F, Poly G) {\n        for(int i = 0; i <= F.n; ++ i) if(i < F.n - i) swap(F.a[i], F.a[F.n - i]);\n        for(int i = 0; i <= G.n; ++ i) if(i < G.n - i) swap(G.a[i], G.a[G.n - i]);\n        int s = F.n + G.n;\n        G.n = F.n - G.n;\n        G.getroom(G.n);\n        Poly Ginv = G.Inv();\n//        for(int i = 0; i <= Ginv.n; ++ i) printf(\"%d \", Ginv.a[i].z);\n//        puts(\"\");\n        getrev(s << 1);\n//        puts(\"DDD\");\n        F.getroom(lim), Ginv.getroom(lim);\n        NTT(F, 1), NTT(Ginv, 1);\n        for(int i = 0; i < lim; ++ i) F.a[i] *= Ginv.a[i];\n        NTT(F, -1);\n        for(int i = Ginv.n + 1; i < lim; ++ i) F.a[i] = 0;\n        F.n = Ginv.n;\n        for(int i = 0; i <= F.n; ++ i) if(i < F.n - i) swap(F.a[i], F.a[F.n - i]);\n//        for(int i = 0; i <= F.n; ++ i) printf(\"%d \", F.a[i].z);\n//        puts(\"\");\n        return F;\n    }\n    pair<Poly,Poly> Div(Poly F) { // Quotient and rest\n        Poly Q = Quotient((*this), F), Z;\n        Z = Q;\n//        for(int i = 0; i <= Z.n; ++ i) printf(\"%d \", Z.a[i].z);\n//        puts(\"\");\n        getrev((*this).n << 1);\n        Q.getroom(lim), F.getroom(lim);\n        NTT(Q, 1), NTT(F, 1);\n        for(int i = 0; i < lim; ++ i) Q.a[i] = Q.a[i] * F.a[i];\n        NTT(Q, -1);\n        for(int i = (*this).n + 1; i < lim; ++ i) Q.a[i] = 0;\n        for(int i = 0; i < lim; ++ i) Q.a[i] = (*this).a[i] - Q.a[i];\n        Q.n = F.n - 1;\n        return make_pair(Z, Q);\n    }\n    inline Poly operator + (const Poly &z) const {\n        Poly X = *this; X.n = max((*this).n, z.n);\n        for(int i = 0; i <= X.n; ++ i) X.a[i] += z.a[i];\n        return X;\n    }\n    inline Poly operator - (const Poly &z) const {\n        Poly X = *this; X.n = max((*this).n, z.n);\n        for(int i = 0; i <= X.n; ++ i) X.a[i] -= z.a[i];\n        return X;\n    }\n    inline Poly operator * (const Poly &z) {\n        Poly X = (*this), Y = z; X.n += z.n;\n        getrev(X.n);\n        NTT(X.a, 1), NTT(Y.a, 1);\n//        puts(\"ZZZ\");\n        for(int i = 0; i < lim; ++ i) X.a[i] *= Y.a[i];\n        NTT(X.a, -1);\n        return X;\n    }\n    inline Poly operator / (Poly &z) {\n        Poly X = z.Inv();\n        return X * (*this);\n    }\n    inline Poly& operator += (const Poly &z) { return *this = *this + z; }\n    inline Poly& operator -= (const Poly &z) { return *this = *this - z; }\n    inline Poly& operator *= (const Poly &z) { return *this = *this * z; }\n    inline Poly& operator /= (Poly &z) { return *this = *this / z; } //\n\n}F, G;\n\nsigned main() {\n//    freopen(\"Q.in\", \"r\", stdin);\n//    freopen(\"S.out\", \"w\", stdout);\n    int i, j;\n    r1(F.n), r1(G.n);\n    F.getroom(F.n), G.getroom(G.n);\n    for(i = 0; i <= F.n; ++ i) r1(F.a[i]);\n    for(i = 0; i <= G.n; ++ i) r1(G.a[i]);\n    pair<Poly, Poly> x = F.Div(G);\n    for(i = 0; i <= F.n - G.n; ++ i) printf(\"%d \", x.first.a[i].z);\n    puts(\"\");\n    for(i = 0; i <= G.n - 1; ++ i) printf(\"%d \", x.second.a[i].z);\n    return 0;\n}\n\n```\n\n",
        "postTime": 1617954796,
        "uid": 151723,
        "name": "legendgod",
        "ccfLevel": 7,
        "title": "\u591a\u9879\u5f0f\u9664\u6cd5 \u521d\u63a2"
    },
    {
        "content": "\u524d\u7f6e\u77e5\u8bc6\uff1a[\u591a\u9879\u5f0f\u4e58\u6cd5FFT/NTT](https://blog.csdn.net/qq_38944163/article/details/81835205)\n\n\u4ec0\u4e48\uff1f\uff1f\u4f60\u4e0d\u4f1a\u591a\u9879\u5f0f\u6c42\u9006\uff0c\u6ca1\u4e8b\uff0c\u4e0d\u7528\u51fa\u95e8\u5de6\u8f6c\uff0c\u8fd9\u91cc\u987a\u4fbf\u8bb2\u4e86\n# \u591a\u9879\u5f0f\u6c42\u9006\n\n$F(x)G(x) \u2261 1( mod \\ x^n)$\n\n\u5df2\u77e5$F(x)$\u6c42$G(x)$\n\n\u89e3\u6cd5:\n\n\u5047\u8bbe\u5df2\u7ecf\u6c42\u51fa\u4e86$F(x)G'(x) \u2261 1( mod x^{\\lceil {\\frac{n}{2}} \\rceil})$\n\n\u663e\u7136\n\n$F(x)G(x) \u2261 1( mod \\ x^{\\lceil {\\frac{n}{2}} \\rceil})$\n\n\u62ff\u4e0b\u9762\u90a3\u4e2a\u51cf\u4e00\u4e0b\u4e0a\u9762\u90a3\u4e2a\n\n$F(x)(G(x) - G'(x)) \u2261 0( mod \\ x^{\\lceil {\\frac{n}{2}} \\rceil})$\n\n\n\u56e0\u4e3a$F(x) \u2261 0( mod \\ x^{\\lceil {\\frac{n}{2}} \\rceil})$\u662f\u4e0d\u6210\u7acb\u7684\n\n\u6240\u4ee5\n\n$G(x) - G'(x) \u2261 0( mod \\ x^{\\lceil {\\frac{n}{2}} \\rceil})$\n\n\u7136\u540e~~\u5f88naive\u5730~~\u628a\u5b83\u5de6\u53f3\u5e73\u65b9\n\n\n$G(x) ^ 2 + G'(x) ^ 2  - 2 G(x)G'(x)\u2261 0( mod \\ x^n)$\n\n\u518d\u4e58$F(x)$\n\n\n$G(x) + G'(x) ^ 2F(x)  - 2G'(x)\u2261 0( mod \\ x^n)$\n\n\n\u79fb\u9879\n\n$G(x) \u2261 2G'(x) - G'(x) ^ 2F(x) ( mod \\ x^n)$\n\n\u7136\u540e\u5c31\u76f4\u63a5\u505a\u5c31\u597d\u4e86\n\n\u6839\u636e\u4e3b\u5b9a\u7406\u8fd9\u4e2a\u4e1c\u4e1c\u7684\u4e4b\u95f4\u590d\u6742\u5ea6\u662f$T(n) = T(n/2) + n log n =n log n$\n\ncode:\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define mod 998244353\t\n#define G 3\n#define N 8000005\nusing namespace std;\nint qpow(int x, int y){\n\tint ret = 1;\n\tfor(; y; y >>= 1, x = x * x % mod) if(y & 1) ret = ret * x % mod;\n\treturn ret;\n}\nint rev[N], G_inv, len_inv;\nvoid ntt(int *a, int len, int o){//NTT\u677f\u5b50\n\tlen_inv = qpow(len, mod - 2);\n\tfor(int i = 0; i <= len; i ++) rev[i] = (rev[i >> 1] >> 1) | ((i&1) * len >> 1);\n\tfor(int i = 0; i <= len; i ++) if(i < rev[i]) swap(a[i], a[rev[i]]);\n\tfor(int i = 2; i <= len; i <<= 1){\n\t\tint wn = qpow((o == 1)? G:G_inv, (mod - 1) / i);\n\t\tfor(int j = 0, p = i / 2; j + i - 1 <= len; j += i){\n\t\t\tint w0 = 1;\n\t\t\tfor(int k = j; k < j + p; k ++, w0 = w0 * wn % mod){\n\t\t\t\tint X = a[k], Y = w0 * a[k + p] % mod;\n\t\t\t\ta[k] = (X + Y) % mod;\n\t\t\t\ta[k + p] = (X - Y + mod) % mod;\n\t\t\t}\n\t\t}\n\t}\n\tif(o == -1) \n\t\tfor(int i = 0; i <= len; i ++) a[i] = a[i] * len_inv % mod;\n}\nint c[N];\nvoid inv(int *a, int *b, int sz){\n\tif(sz == 1) {b[0] = qpow(a[0], mod - 2); return;}//\u5e38\u6570\u76f4\u63a5\u6c42\u9006\u5143\n\tinv(a, b, (sz + 1) / 2);//\u628a\u5c0f\u7684\u5148\u6c42\u51fa\u6765\n\tint len = 1;\n\tfor(; len <= sz + sz; len <<= 1);\n\tfor(int i = 0; i < sz; i ++) c[i] = a[i];//\u6ce8\u610f\u8981\u7528c\u66ff\u6362\u4e00\u4e0b\uff0c\u4e0d\u7136a\u4f1a\u505a\u5f88\u591a\u6b21NTT\n\tfor(int i = sz; i <= len; i ++) c[i] = 0;\n\tntt(c, len, 1), ntt(b, len, 1);\n\tfor(int i = 0; i <= len; i ++) b[i] = (b[i] * 2 % mod - b[i] * b[i] % mod * c[i] % mod + mod) % mod;//\u76f4\u63a5\u7b97\n\tntt(b, len, -1);\n\tfor(int i = sz; i <= len; i ++) b[i] = 0;//\u6ce8\u610f\uff0cb\u8981\u7528\u5f88\u591a\u6b21\uff0c\u6240\u4ee5\u8981\u628a\u540e\u9762\u7684\u6e05\u7a7a\u4e00\u4e0b\n}\nint a[N], b[N], n, m;\nsigned main(){\n\tG_inv = qpow(G, mod - 2);\n\tscanf(\"%lld\", &n);\n\tfor(int i = 0; i < n; i ++) scanf(\"%lld\", &a[i]);\n\tinv(a, b, n);\n\tfor(int i = 0; i < n; i ++) printf(\"%lld \", b[i]);\n\treturn 0;\n}\n```\n\n# \u591a\u9879\u5f0f\u9664\u6cd5\n$F(x)$\u6700\u9ad8\u6b21\u662f$n$, $G(x)$\u6700\u9ad8\u6b21\u662f$m$, \u5219$Q(x)$\u6700\u9ad8\u6b21\u662f$n-m$, $R$\u6700\u9ad8\u6b21\u662f$m-1$\n\n$F(x)=Q(x)G(x)+R(x)$\n\n\u628a$\\frac{1}{x}$\u4ee3\u5165\n\n$F(\\frac{1}{x})=Q(\\frac{1}{x})G(\\frac{1}{x})+R(\\frac{1}{x})$\n\n$x^nF(\\frac{1}{x})=x^nQ(\\frac{1}{x})G(\\frac{1}{x})+x^nR(\\frac{1}{x})$\n\n\n\u7136\u540e\u53d1\u73b0$x^nF(\\frac{1}{x}) = F_R(x)$ \u5373\u5c06$F$\u7684\u7cfb\u6570\u524d\u540e\u7ffb\u8f6c\u4e00\u4e0b$\n\n\n$x^nF(\\frac{1}{x})=x^{n - m}Q(\\frac{1}{x})x^mG(\\frac{1}{x})+x^{n-m+1}x^{m-1}R(\\frac{1}{x})$\n\n\n$F_R(x)=Q_R(x)G_R(x)+x^{n-m+1}R_R(x)$\n\n\u4e24\u8fb9$\\mod \\ \\ \\ x^{n-m+1}$\n\n$F_R(x)=Q_R(x)G_R(x)(mod \\ \\ \\ x^{n-m+1})$\n\n\u56e0\u4e3a$Q(x)$ \u7684\u6700\u9ad8\u6b21\u662f $n-m < n-m+1$\u6240\u4ee5\u6ca1\u5173\u7cfb\uff08\u4f46\u6ce8\u610f\u8981\u8865\u9f50\uff09\n\n\u7136\u540e\u53d8\u4e00\u4e0b\u5f62\n$Q_R(x)=F_R(x)G_R^{-1}(x)(mod \\ \\ \\ x^{n-m+1})$\n\n\u6c42$G_R(x)$\u7684\u9006\u5143\u5373\u53ef\n\n\n$R(x) = F(x) - G(x)Q(x)$\n\n```cpp\n\n#include<bits/stdc++.h>\n#define int long long\n#define mod 998244353\t\n#define GG 3\n#define N 8000005\nusing namespace std;\nint qpow(int x, int y){\n\tint ret = 1;\n\tfor(; y; y >>= 1, x = x * x % mod) if(y & 1) ret = ret * x % mod;\n\treturn ret;\n}\nint rev[N], GG_inv, len_inv;\nvoid ntt(int *a, int len, int o){//NTT\u677f\u5b50\n\tlen_inv = qpow(len, mod - 2);\n\tfor(int i = 0; i <= len; i ++) rev[i] = (rev[i >> 1] >> 1) | ((i&1) * len >> 1);\n\tfor(int i = 0; i <= len; i ++) if(i < rev[i]) swap(a[i], a[rev[i]]);\n\tfor(int i = 2; i <= len; i <<= 1){\n\t\tint wn = qpow((o == 1)? GG:GG_inv, (mod - 1) / i);\n\t\tfor(int j = 0, p = i / 2; j + i - 1<= len; j += i){\n\t\t\tint w0 = 1;\n\t\t\tfor(int k = j; k < j + p; k ++, w0 = w0 * wn % mod){\n\t\t\t\tint X = a[k], Y = w0 * a[k + p] % mod;\n\t\t\t\ta[k] = (X + Y) % mod;\n\t\t\t\ta[k + p] = (X - Y + mod) % mod;\n\t\t\t}\n\t\t}\n\t}\n\tif(o == -1) \n\t\tfor(int i = 0; i <= len; i ++) a[i] = a[i] * len_inv % mod;\n}\nint c[N];\nvoid inv(int *a, int *b, int sz){//\u591a\u9879\u5f0f\u6c42\u9006\u677f\u5b50\n\tif(sz == 0) {b[0] = qpow(a[0], mod - 2); return;}\n\tinv(a, b, sz / 2);\n\tint len = 1;\n\tfor(; len <= sz + sz; len <<= 1);\n\tfor(int i = 0; i <= sz; i ++) c[i] = a[i];\n\tfor(int i = sz + 1; i <= len; i ++) c[i] = 0;\n\tntt(c, len, 1), ntt(b, len, 1);\n\tfor(int i = 0; i <= len; i ++) b[i] = (b[i] * 2 % mod - b[i] * b[i] % mod * c[i] % mod + mod) % mod;\n\tntt(b, len, -1);\n\tfor(int i = sz + 1; i <= len; i ++) b[i] = 0;\n}\nvoid mul(int *a, int *b, int n, int m){//\u591a\u9879\u5f0f\u4e58\u6cd5\u677f\u5b50\n\tint len = 1;\n\tfor(; len <= n + m; len <<= 1);\n\tntt(a, len, 1), ntt(b, len, 1);\n\tfor(int i = 0; i <= len; i ++) a[i] = a[i] * b[i] % mod;\n\tntt(a, len, -1);\n}\nint a[N], b[N], F[N], G[N], Q[N], GR[N], FR[N], GR_inv[N], R[N], n, m;\nsigned main(){\n\tGG_inv = qpow(GG, mod - 2);\n\tscanf(\"%lld%lld\", &n, &m);\n\tfor(int i = 0; i <= n; i ++) scanf(\"%lld\", &F[i]), FR[n - i] = F[i];\n\tfor(int i = 0; i <= m; i ++) scanf(\"%lld\", &G[i]), GR[m - i] = G[i];\n\tfor(int i = n - m + 1; i <= m; i ++) GR[i] = 0;// mod n - m + 1, \u5373\u628a\u540e\u9762\u7684\u5168\u90e8\u6e050\n\tinv(GR, GR_inv, n - m);//\u6ce8\u610f\u957f\u5ea6\u662f n - m, \u8981\u8865\u9f50\n\tmul(FR, GR_inv, n, n - m);\t//\u957f\u5ea6\u8981\u8865\u9f50\n\tfor(int i = 0; i <= n - m; i ++) Q[i] = FR[n - m - i];//\u7ffb\u8f6c\n\tfor(int i = 0; i <=  n - m; i ++) printf(\"%lld \", Q[i]); printf(\"\\n\");//\u8f93\u51fa\n\tmul(G, Q, m, n - m);//\u76f4\u63a5\u7b97\u4f59\u6570R\n\tfor(int i = 0; i < m; i ++) R[i] = (F[i] - G[i] + mod) % mod;\n\tfor(int i = 0; i <  m; i ++) printf(\"%lld \", R[i]); printf(\"\\n\");\n\treturn 0;\n}\n```\n",
        "postTime": 1570089670,
        "uid": 31656,
        "name": "lomit",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P4512 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u9664\u6cd5\u3011"
    },
    {
        "content": "### \u9898\u76ee\u63cf\u8ff0\n\u7ed9\u5b9a $n$ \u6b21\u591a\u9879\u5f0f $f(x)$ \u548c\u4e00\u4e2a $m$ \u6b21\u591a\u9879\u5f0f $g(x)$ \uff0c\u6c42\u591a\u9879\u5f0f $q(x)$ \uff0c $r(x)$ \u6ee1\u8db3\uff1a\n\n$q(x)$ \u7684\u6b21\u6570\u4e3a $n-m$ \uff0c $r(x)$ \u6b21\u6570\u5c0f\u4e8e $m$ \uff1b\n\n$f(x)=q(x)\\cdot g(x)+r(x)$\n\n\u7cfb\u6570\u5bf9 $998244353$ \u53d6\u6a21\u3002\n\n\u6570\u636e\u8303\u56f4 $1\\leq m<n\\leq 10^5$ \u3002\n\n### \u524d\u7f6e\u829d\u58eb\uff1a\n\u591a\u9879\u5f0f\u6c42\u9006\u3002\uff08\u4e0d\u7528\u725b\u987f\u8fed\u4ee3\uff0c\u751a\u81f3~~\u975e\u5e38\u5165\u95e8\u7684~~\u6c42\u5bfc\uff0c\u79ef\u5206\u90fd\u4e0d\u8981\uff0c\u8001\u5c11\u54b8\u5b9c\uff01\uff09\n\n\u4e0d\u4f1a\u51fa\u95e8\u5de6\u62d0\u5373\u53ef\u3002\u3002\uff08\u5e94\u8be5\u5df2\u7ecf\u6ca1\u6709\u4eba\u8bfb\u5230\u8fd9\u91cc\u5c31\u8d70\u4e86\u5427\uff09\n\n### solution\n\u6765\u4e24\u4e2a\u8bb0\u53f7\uff0c\n\n1.\u5b9a\u4e49 $f^{R}(x)$ \u4e3a $f(x)$ \u7cfb\u6570\u53cd\u8f6c\u7684\u591a\u9879\u5f0f\u3002\n\n2.\u5b9a\u4e49 $deg(f(x))$ \u4e3a $f(x)$ \u7684\u6700\u9ad8\u6b21\u5e42\u6570\u3002\n\n\u663e\u7136\u7684\u4e00\u4e2a\u5c0f\u63a8\u8bba\uff0c\n\n$f^{R}(x)=x^{deg(f(x))}\\cdot f(\\large\\frac{1}{x}$ $)$\n\n\uff08\u968f\u4fbf\u4e3e\u4e2a\u4f8b\u5b50\u5c31\u61c2\u4e86\uff09\n\n$f(x)=q(x)\\cdot g(x)+r(x)$\n\n\u5c06\u4e0a\u5f0f\u4e2d\u7684 $x$ \u4ee4\u4e3a $\\large\\frac{1}{x}$ \uff0c\u518d\u4e58\u4e0a\u4e00\u4e2a $x^{deg(f(x))}$ \uff0c\u5c31\u53ef\u4ee5\u5957\u4e0a\u9762\u7684\u5c0f\u63a8\u8bba\u3002\n\n\uff08\u6ce8\uff1a $q(x)\\cdot g(x)$ \u6b21\u6570\u7b49\u4e8e $f(x)$ \uff0c\u800c $r(x)$ \u7684\u6b21\u6570\u5fc5\u7136\u5c0f\u4e8e $f(x)$ \uff08\u5e94\u8be5\u663e\u7136\u5427\u3002\u3002\uff09\uff09\n\n\u6240\u4ee5\u5f97\u5230\uff1a\n\n$f^{R}(x)=q^{R}(x)\\cdot g^{R}(x)+x^{n-deg(r(x))}\\cdot r^{R}(x)$\n\n\u56e0\u4e3a\u5df2\u77e5 $deg(r(x))<m$ \u5373 $deg(r(x))\\leq m-1$ \uff08\u56e0\u4e3a\u8fd9\u91cc\u53ea\u4f1a\u51fa\u73b0\u6574\u6570\u6b21\u5e42\uff09\n\n\u6240\u4ee5 $n-deg(r(x))\\geq n-m+1$ \u3002\n\n\u5982\u679c\u6b64\u65f6\u4e24\u8fb9\u540c\u65f6\u5bf9 $x^{n-m+1}$ \u53d6\u6a21\uff0c\u90a3\u4e48\uff1a\n\n$f^{R}(x)\\equiv q^{R}(x)\\cdot g^{R}(x)$ $(mod$ $x^{n-m+1})$\n\n\u6700\u68d2\u7684\u662f\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u6ca1\u6709\u7b54\u6848\u7684\u635f\u5931\uff0c\u56e0\u4e3a $q^{R}(x)$ \u7684\u6b21\u6570\u662f $n-m$ \u5c0f\u4e8e $n-m+1$ ,\u975e\u5e38\u5b8c\u7f8e\u3002\n\n\u6240\u4ee5 $q^{R}(x)$ \u53ef\u4ee5\u5728\u4e0d\u635f\u5931\u7684\u60c5\u51b5\u4e0b\u6c42\u51fa\u6765\uff0c\u6700\u540e\u518d\u56de\u5230\u539f\u6765\u7684\u67ff\u5b50\uff0c\u79fb\u4e00\u4e2a\u9879\uff0c\u518d\u6c42 $r(x)$ \u5c31\u884c\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log_{2}{n})$ \u3002\n\n\u4eba\u50bb\u5e38\u719f\u5927 wtcl \u3002\u3002\n\n**\uff08\u6ce8\uff1a\u591a\u9879\u5f0f\u662f $0$ \u6b21\u5230 $n$ \u6216 $m$ \u6b21\u800c\u975e $0$ \u6b21\u5230 $n-1$ \u6216 $m-1$ \u6b21\uff09**\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N=4e5+10;\ntypedef ll arr[N];\nconst int mod=998244353;\nconst int inv3=332748118;\nint n,m,inv,lim=1,fre,id[N];\narr f,g,fr,gr,gi,q,r,ans;\ninline ll inc(ll x,ll y){return x+y>=mod?x+y-mod:x+y;}\ninline ll dec(ll x,ll y){return x-y<0?x-y+mod:x-y;}\ninline ll mul(ll x,ll y){return 1ll*x*y%mod;}\ninline int read()\n{\n\tint s=0,w=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9') s=s*10+ch-'0',ch=getchar();\n\treturn s*w;\n}\ninline int ksm(int a,int b)\n{\n\tint tmp=1;\n\twhile(b)\n\t{\n\t\tif(b&1)tmp=(1ll*tmp*a)%mod;\n\t\tb>>=1,a=(1ll*a*a)%mod;\n\t}\n\treturn tmp;\n}\ninline void Never_Tell_TLE(ll* NTT,int sign)\n{\n\tfor(int i=0;i<=lim;++i)if(i<id[i])\n\t{\n\t\tll NTt=NTT[i];\n\t\tNTT[i]=NTT[id[i]];\n\t\tNTT[id[i]]=NTt;\n\t}\n\tfor(int mid=1;mid<lim;mid<<=1)\n\t{\n\t\tint Unit_root;\n\t\tif(sign==1)Unit_root=ksm(3,(mod-1)/(mid<<1));\n\t\telse Unit_root=ksm(inv3,(mod-1)/(mid<<1));\n\t\tfor(int R=mid<<1,r=0;r<lim;r+=R)\n\t\t{\n\t\t\tint pw=1;\n\t\t\tfor(int l=0;l<mid;++l,pw=(1ll*pw*Unit_root)%mod)\n\t\t\t{\n\t\t\t\tint butt=NTT[l+r],rfly=(1ll*pw*NTT[l+r+mid])%mod;\n\t\t\t\tNTT[l+r]=inc(butt,rfly);\n\t\t\t\tNTT[l+r+mid]=dec(butt,rfly);\n\t\t\t}\n\t\t}\n\t}\n\tif(sign==-1)\n\t{\n\t\tint inv_lim=ksm(lim,mod-2);\n\t\tfor(int i=0;i<=lim;++i)NTT[i]=mul(NTT[i],inv_lim);\n\t}\n}\n/*\n\u6b64Inv\u975e\u5f7cInv\uff0c\u4e00\u5b9a\u8981\u6ce8\u610f\n\u56e0\u4e3a\u591a\u9879\u5f0f\u662f0~n/m\u800c\u975e0~(n-1)/(m-1)\n*/\ninline void Inv(ll* F,ll* G,int nm)\n{\n\tif(nm==0)\n\t{\n\t\tG[0]=ksm(F[0],mod-2);\n\t\treturn;\n\t}\n\tInv(F,G,nm>>1);\n\tlim=1,fre=0;\n\tfor(;lim<=(nm<<1);lim<<=1)++fre;\n\tfor(int i=0;i<=lim;++i)id[i]=(id[i>>1]>>1)|((i&1)<<(fre-1));\n\tfor(int i=0;i<=nm;++i)ans[i]=F[i];\n\tfor(int i=nm+1;i<=lim;++i)ans[i]=0;\n\tNever_Tell_TLE(ans,1),Never_Tell_TLE(G,1);\n\tfor(int i=0;i<=lim;++i)G[i]=mul(inc(2ll,-mul(ans[i],G[i])+mod),G[i]);\n\tNever_Tell_TLE(G,-1);\n\tfor(int i=nm+1;i<=lim;++i)G[i]=0;\n}\ninline void Mul(ll* F,ll* G,int nm)\n{\n\tlim=1,fre=0;\n\tfor(;lim<=nm;lim<<=1)++fre;\n\tfor(int i=0;i<=lim;++i)id[i]=(id[i>>1]>>1)|((i&1)<<(fre-1));\n\tNever_Tell_TLE(F,1),Never_Tell_TLE(G,1);\n\tfor(int i=0;i<=lim;++i)F[i]=mul(F[i],G[i]);\n\tNever_Tell_TLE(F,-1);\n}\ninline void solve(ll* F,ll* G,ll* FR,ll* GR,ll* GI,ll* Q,ll* R)\n{\n\tInv(GR,GI,n-m);\n\tMul(FR,GI,n+n-m);\n\tfor(int i=0;i<=n-m;++i)Q[i]=FR[n-m-i];\n\tfor(int i=0;i<=n-m;++i)printf(\"%d \",Q[i]);\n\tprintf(\"\\n\");\n\tMul(G,Q,n);\n\tfor(int i=0;i<m;++i)R[i]=inc(F[i],-G[i]+mod);\n\tfor(int i=0;i<m;++i)printf(\"%d \",R[i]);\n}\nint main()\n{\n\tn=read(),m=read();\n\tfor(int i=0;i<=n;++i)f[i]=read(),fr[n-i]=f[i];\n\tfor(int i=0;i<=m;++i)g[i]=read(),gr[m-i]=g[i];\n\tfor(int i=n-m+1;i<=m;++i)gr[i]=0;\n\tsolve(f,g,fr,gr,gi,q,r);\n\treturn 0;\n}\n```\n\u53ea\u6c42\u80fd\u5e2e\u52a9\u5230\u51e0\u4e2a\u4eba\u7f62\u3002\u3002",
        "postTime": 1617286903,
        "uid": 206024,
        "name": "Illusory_dimes",
        "ccfLevel": 7,
        "title": "\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u9664\u6cd5 \u9898\u89e3"
    },
    {
        "content": "\u7ec8\u4e8e\u8c03\u5bf9\u4e86\uff0c\uff08\u3002\uff0d_\uff0d\u3002\uff09\n\n------------\n\u8981\u5148$A$\u6389\u672c\u9898\uff0c\u51fa\u95e8\u5de6\u8f6c\u591a\u9879\u5f0f\u6c42\u9006\u3002\n\n\u6211\u4eec\u4ee4\n$$A_r(x)=x^{\\text{Deg}(A)}A(x^{-1})$$\n\u5f88\u660e\u663e\u8fd9\u662f\u5c06\u539f\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u7ffb\u8f6c\uff0c\u8bc1\u660e\u5982\u4e0b\n\n\u5047\u8bbe\n$$A(x)=\\sum_{i=0}^{\\text{Deg(A)}}a_ix^i$$\n\u5219\n$$x^{\\text{Deg}(A)}A(x^{-1})=x^{\\text{Deg}(A)}\\sum_{i=0}^{\\text{Deg(A)}}a_i(x^{-1})^i=\\sum_{i=0}^{^{\\text{Deg}(A)}}a_ix^{\\text{Deg}(A)-i}$$\n\u5f97\u8bc1\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5f00\u59cb\u63a8\u5bfc\n\n\u7531\u9898\u610f\u5f97\n$$F(x)=G(x)Q(x)+R(x)$$\n\u5e26\u5165$x^{-1}$\n$$F(x^{-1})=G(x^{-1})Q(x^{-1})+R(x^{-1})$$\n\u4e24\u8fb9\u540c\u65f6\u4e58\u4e0a$x^n$\n$$x^nF(x^{-1})=x^nG(x^{-1})Q(x^{-1})+x^nR(x^{-1})$$\n$$F_r(x)=x^mG(x^{-1})\\cdot x^{n-m}Q(x^{-1})+x^{n-m+1}\\cdot x^{m-1}R(x^{-1})$$\n\u53f3\u8fb9\u518d\u5408\u5e76\n$$F_r(x)=G_r(x)Q_r(x)+x^{n-m+1}R_r(x)$$\n\u53d1\u73b0\u4e24\u8fb9\u540c\u65f6\u6a21$x^{n-m+1}$\u53ef\u4ee5\u62b5\u6d88$R_r(x)$\n$$F_r(x)\\equiv G_r(x)Q_r(x)\\ ({\\rm mod}\\ x^{n-m+1})$$\n\u53cd\u6f14\u4e00\u4e0b\n$$Q_r(x)\\equiv F_r(x)G_r^{-1}(x)\\ ({\\rm mod}\\ x^{n-m+1})$$\n\u7cfb\u6570\u7ffb\u8f6c\u53ef\u4ee5\u7528\u81ea\u5e26\u7684$\\rm reverse$\u51fd\u6570\uff0c\u9006\u5143\u6700\u597d\u8fed\u4ee3\u6c42\u89e3\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\nconst int N = 1<<20;\n\nint read() \n{\n\tint x = 0, f = 1; char c = getchar();\n\twhile(c < '0' || c > '9') {if(c == '-') f = -1; c = getchar();}\n\twhile(c >= '0' && c <= '9') x = (x<<1) + (x<<3) + c - '0', c = getchar();\n\treturn x * f;\n}\nnamespace Polynomial\n{\n\tconst ll P = 998244353, g = 3, gi = 332748118;\n\tstatic int rev[N];\n\tint lim, bit;\n\tll add(ll a, ll b)\n\t{\n\t\treturn (a += b) >= P ? a - P : a;\n\t}\n\tll qpow(ll a, ll b) \n\t{\n\t\tll prod = 1;\n\t\twhile(b)\n\t\t{\n\t\t\tif(b & 1) prod = prod * a % P;\n\t\t\ta = a * a % P;\n\t\t\tb >>= 1;\n\t\t}\n\t\treturn (prod + P) % P;\n\t}\n\tvoid calrev() {\n\t\tfor(int i = 1; i < lim; i++)\n\t\t\trev[i] = (rev[i >> 1] >> 1) | ((i & 1) << (bit - 1));\n\t}\n\tvoid NTT(ll *A, int inv) \n\t{\n\t\tfor(int i = 0; i < lim; i++)\n\t\t\tif(i < rev[i]) swap(A[i], A[rev[i]]);\n\t\tfor(int mid = 1; mid < lim; mid <<= 1) \n\t\t{\n\t\t\tll tmp = qpow(inv == 1 ? g : gi, (P - 1) / (mid << 1));\n\t\t\tfor(int j = 0; j < lim; j += (mid << 1)) \n\t\t\t{\n\t\t\t\tll omega = 1;\n\t\t\t\tfor(int k = 0; k < mid; k++, omega = (omega * tmp) % P) {\n\t\t\t\t\tint x = A[j + k], y = omega * A[j + k + mid] % P;\n\t\t\t\t\tA[j + k] = (x + y) % P;\n\t\t\t\t\tA[j + k + mid] = (x - y + P) % P;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(inv == 1) return;\n\t\tint invn = qpow(lim, P - 2);\n\t\tfor(int i = 0; i < lim; i++)\n\t\t\tA[i] = A[i] * invn % P;\n\t}\n\tstatic ll x[N], y[N];\n\tvoid mul(ll *a, ll *b) \n\t{\n\t\tmemset(x, 0, sizeof x);\n\t\tmemset(y, 0, sizeof y);\n\t\tfor(int i = 0; i < (lim >> 1); i++)\n\t\t\tx[i] = a[i], y[i] = b[i];\n\t\tNTT(x, 1), NTT(y, 1);\n\t\tfor(int i = 0; i < lim; i++)\n\t\t\tx[i] = x[i] * y[i] % P;\n\t\tNTT(x, -1);\n\t\tfor(int i = 0; i < lim; i++)\n\t\t\ta[i] = x[i];\n\t}\n\tstatic ll c[2][N];\n\tvoid Inv(ll *a, int n) \n\t{\n\t\tint p = 0;\n\t\tmemset(c, 0, sizeof c);\n\t\tc[0][0] = qpow(a[0], P - 2);\n\t\tlim = 2, bit = 1;\n\t\twhile(lim <= (n << 1))\n\t\t{\n\t\t\tlim <<= 1, bit++;\n\t\t\tcalrev();\n\t\t\tp ^= 1;\n\t\t\tmemset(c[p], 0, sizeof c[p]);\n\t\t\tfor(int i = 0; i <= lim; i++)\n\t\t\t\tc[p][i] = add(c[p^1][i], c[p^1][i]);\n\t\t\tmul(c[p^1], c[p^1]);\n\t\t\tmul(c[p^1], a);\n\t\t\tfor(int i = 0; i <= lim; i++)\n\t\t\t\tc[p][i] = add(c[p][i], P - c[p^1][i]);\n\t\t}\n\t\tfor(int i = 0; i < lim; i++)\n\t\t\ta[i] = c[p][i];\n\t}\n}\nusing namespace Polynomial;\nint n,  m;\nll F[N], G[N], Q[N], R[N], Gr[N];\nint main()\n{\n\tn = read(), m = read();\n\tfor(int i = 0; i <= n; i++)\n\t\tF[i] = read(), Q[n - i] = F[i];\n\tfor(int i = 0; i <= m; i++)\n\t\tG[i] = read(), Gr[m - i] = G[i];\n\tfor(int i = n - m + 2; i <= m; i++)\n\t\tGr[i] = 0;\n\tInv(Gr, n - m + 1);\n\tmul(Q, Gr);\n\treverse(Q, Q + n - m + 1);\n\tfor(int i = n - m + 1; i <= n; i++)\n\t\tQ[i] = 0;\n\tfor(int i = 0; i <= n - m; i++)\n\t\tprintf(\"%lld \", Q[i]);\n\tprintf(\"\\n\");\n\tlim = 1, bit = 0;\n\twhile(lim <= (n << 2))\n\t\tlim <<= 1, bit++;\n\tcalrev();\n\tmul(Q, G);\n\tfor(int i = 0; i < m; i++)\n\t\tprintf(\"%lld \", add(F[i], P - Q[i]));\n\treturn 0;\t\t\n}\n```\n",
        "postTime": 1558501978,
        "uid": 139340,
        "name": "Gauss0320",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4512\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u9664\u6cd5"
    },
    {
        "content": "\u524d\u7f6e\u77e5\u8bc6\uff1a**\u5206\u6cbbFFT** ~~(\u5c31\u8fd9\uff1f)~~\n\n------------\n\n\u770b\u5230\u8fd9\u9053\u9898\uff0c\u5148\u60f3\u5230\u66b4\u529b\u9664\uff0c\u7136\u9e45\u5543\u952d\u8fc7\u4e0d\u4e86\n\n\u5148\u8ba1\u7b97$Q$\n\n\u624b\u52a8\u505a\u9664\u6cd5\uff0c\u53d1\u73b0$F$\u524d$m$\u9879\u4e0d\u80fd\u518d\u9664\u4e0b\u53bb\u4e86\n\n\u4e8e\u662f\u77e5\u9053$F$\u7684\u524d$m$\u9879\u4e0d\u5f71\u54cd$Q$\u7684\u7ed3\u679c\uff0c\u6682\u65f6\u5ffd\u7565\n\n\u7136\u540e$R$\u5b83\u5c31\u6ca1\u4e86\u3002\u3002\u5269\u4e0b$F=QG$ \u76f4\u63a5\u5c55\u5f00\n\n$$F_i=\\sum_{j=i-m}^{i}Q_jG_{i-j}$$\n\n$$F_i=\\sum_{j=i-m+1}^{i}Q_jG_{i-j}+Q_{i-m}G_m$$\n\n$$Q_{i-m}=\\frac{F_i-\\sum_{j=i-m+1}^{i}Q_jG_{i-j}}{G_m}$$\n\n\u4e8e\u662f\u5f88\u5bb9\u6613\u60f3\u5230\u5206\u6cbbFFT\uff0c\u6c42\u51fa$n-m+1$\u4f4d\u7684$Q$\u4e4b\u540e\n\n\u4ee3\u56de$R=F-QG$\u5f97\u5230$R$\uff0c\u5c31\u53ef\u4ee5AC\u4e86\n\n\u6700\u540e\u653e\u4e0a\u4e0d\u53ef\u8bfb\u7684\u4ee3\u7801\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define rll register long long\nconst int P=998244353,S=18,N=1<<S;\nint r[N],f[N],q[N],g[N],a[N],b[N],w[N],n,m,*mi,*ni;\nint pw(int x,int y){\n\trll i=y,j=x;x=1;\n\tfor(;i;i>>=1,j=j*j%P)if(i&1)x=j*x%P;\n\treturn x;\n}\nvoid ntt(int*x,int*y,int s){\n\trll p;int u,v=log2(s);\n\tfor(int i=0;i<s;i++)if(r[i<<S-v]<i)swap(x[i],x[r[i<<S-v]]);\n\tfor(int i=1,d=1;i<s;i<<=1,d++)\n\t\tfor(int j=0;j<s;j+=i<<1)\n\t\t\tfor(int k=0;k<i;k++){\n\t\t\t\tu=j+k;v=i+u;\n\t\t\t\tp=1ll*y[k<<S-d]*x[v]%P;\n\t\t\t\tx[v]=x[u]-p;\n\t\t\t\tx[v]+=x[v]<0?P:0;\n\t\t\t\tx[u]=x[u]+p;\n\t\t\t\tx[u]-=x[u]<P?0:P;\n\t\t\t}\n\tp=pw(s,P-2);if(y==ni)for(int i=0;i<s;i++)x[i]=p*x[i]%P;\n}\nvoid start(){\n\trll q=1,p=pw(3,P-1>>S);mi=w;\n\tfor(int k=0;k<N>>1;k++)w[k]=q,q=q*p%P;\n\tq=1,p=pw(332748118,P-1>>S);ni=w+(N>>1);\n\tfor(int k=N>>1;k<N;k++)w[k]=q,q=q*p%P;\n\tfor(int i=0;i<N;i++)r[i]=r[i>>1]>>1|(i&1)<<S-1;\n}\nvoid cdq(int*x,int*y,int s){\n\tif(s==1)*x=1ll*(*y-*x+P)*pw(*g,P-2)%P;\n\tif(s==1||x-q>n-m)return;\n\tcdq(x,y,s>>1);\n\tfor(int i=0;i<s>>1;i++)a[i]=x[i];\n\tfor(int i=0;i<s;i++)b[i]=g[i];\n\tntt(a,mi,s);ntt(b,mi,s);\n\tfor(int i=0;i<s;i++)a[i]=1ll*a[i]*b[i]%P;\n\tntt(a,ni,s);\n\tfor(int i=s>>1;i<s;i++)x[i]=(x[i]+a[i])%P;\n\tfor(int i=0;i<s;i++)a[i]=b[i]=0;\n\tcdq(x+(s>>1),y+(s>>1),s>>1);\n}\nint main(){\n\tstart();\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=n;~i;i--)scanf(\"%d\",&f[i]);\n\tfor(int i=m;~i;i--)scanf(\"%d\",&g[i]);\n\tcdq(q,f,N);\n\tfor(int i=n-m+1;i<N;i++)q[i]=0;\n\tfor(int i=0;i<=n>>1;i++)swap(f[i],f[n-i]);\n\tfor(int i=0;i<=m>>1;i++)swap(g[i],g[m-i]);\n\tfor(int i=0;i<=n-m>>1;i++)swap(q[i],q[n-m-i]);\n\tfor(int i=0;i<=n-m;i++)printf(\"%d \",q[i]);\n\tntt(q,mi,N);ntt(g,mi,N);\n\tfor(int i=0;i<N;i++)q[i]=1ll*q[i]*g[i]%P;\n\tntt(q,ni,N);puts(\"\");\n\tfor(int i=0;i<m;i++)printf(\"%d \",(f[i]-q[i]+P)%P);\n\treturn 0;\n}\n```\n",
        "postTime": 1609860909,
        "uid": 188945,
        "name": "ch\u82cf\u5bd2",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4512 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u9664\u6cd5\u3011"
    },
    {
        "content": "\u8fd9\u662f\u6211\u53d1\u5e03\u7684\u7b2c\u4e00\u7bc7\u9898\u89e3\n\n\u524d\u7f6e\u77e5\u8bc6\uff1antt,\u591a\u9879\u5f0f\u9006\u5143\n\n\u6839\u636e\u9898\u610f\uff0c\u7ed9\u5b9a\u591a\u9879\u5f0fF,G,\u6c42P,Q,\u5176\u4e2d\n$$\nF(x)= G(x)Q(x)+R(x)\n$$\n\u6211\u4eec\u8bbe$H^R(x)=x^{digitH}H(\\frac 1 x)$\n\n\u7ee7\u7eed\u63a8\u5f0f\u5b50\u2026\u2026\n$$\nF(x)=G(x)Q(x)+R(x)\n$$\n$$\nx^nF(\\frac 1 x)= x^mG(\\frac 1 x)x^{n-m}Q(\\frac 1 x)+x^{n-m+1}x^{m-1}R(\\frac 1 x)\n$$\n$$\nF^R(x)=G^R(x)Q^R(x)+x^{n-m+1}R^R(x)\n$$\n$$\nF^R(x)\\equiv G^R(x)Q^R(x)\\mod x^{n-m+1}\n$$\n$$\nF^R(x){G^R}^{-1}(x)\\equiv Q^R(x)\\mod x^{n-m+1}\n$$\n\u7b97\u51fa\u6765\u540e\u628aQ\u53cd\u5e26\u5165\u6c42\u51faR\u5373\u53ef\n\nO(nlogn)\n\ncode:\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nint ksm(int a,int b,int mod){\n    if(b==1)return a%mod;\n    if(b==0)return 1;\n    int ans=ksm(a,b/2,mod);\n    ans*=ans;\n    ans%=mod;\n    if(b%2)ans*=a,ans%=mod;\n    return ans;\n}\nconst int mod=998244353;\nconst int g=3;\nint r[1000000];\nvoid ntt(int a[],int len,int mode){\n    for(int i=0;i<len;i++)if(r[i]<i)swap(a[r[i]],a[i]);\n    for(int i=1;i<len;i<<=1){\n        int wn=ksm(g,(mod-1)/(i*2),mod);\n        if(mode==-1)wn=ksm(wn,(mod-2),mod);\n        for(int j=0;j<len;j+=(i<<1)){\n            int wnk=1;\n            for(int k=0;k<i;k++){\n                int x=a[j+k],y=(wnk*a[i+j+k])%mod;\n                a[j+k]=(x+y)%mod;\n                a[i+j+k]=(x-y+mod)%mod;\n                wnk*=wn;\n                wnk%=mod;\n            }\n        }\n    }\n    if(mode==-1){\n        int invlen=ksm(len,mod-2,mod);\n        for(int i=0;i<len;i++){\n            a[i]*=invlen;\n            a[i]%=mod;\n        }\n    }\n}\nint c[1000000];\nvoid work(int a[],int b[],int n){\n    if(n==1){\n        b[0]=ksm(a[0],mod-2,mod);\n        return;\n    }\n    work(a,b,(n+1)/2);\n    memset(c,0,sizeof(c));\n    for(int i=0;i<n;i++){\n        c[i]=a[i];\n    }\n    int len=1,l=0;\n    while(len<(n*2))len<<=1,l++;\n    for(int i=0;i<len;i++){\n        r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n    }\n    ntt(c,len,1);\n    ntt(b,len,1);\n    for(int i=0;i<len;i++){\n        b[i]=((2+mod-c[i]*b[i]%mod)%mod*b[i])%mod;\n    }\n    ntt(b,len,-1);\n    for(int i=n;i<len;i++)b[i]=0;\n}\nint n,m,f[1000000],G[1000000],fr[1000000],gr[1000000],gt[1000000];\nsigned main(){\n    cin>>n>>m;\n    for(int i=0;i<=n;i++){\n        scanf(\"%d\",f+i);\n        fr[n-i]=f[i];\n    }\n    for(int i=0;i<=m;i++){\n        scanf(\"%d\",G+i);\n        gr[m-i]=G[i];\n        gt[i]=G[i];\n    }\n    for(int i=n-m+2;i<=m;i++)gr[i]=0;\n    memset(G,0,sizeof(G));\n    work(gr,G,n-m+1);\n    int kkksc03=1,l=0;\n    while(kkksc03<2*n+2){\n        kkksc03<<=1;\n        l++;\n    }\n    for(int i=0;i<kkksc03;i++){\n        r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n    }\n    ntt(G,kkksc03,1);\n    ntt(fr,kkksc03,1);\n    for(int i=0;i<kkksc03;i++){\n        fr[i]*=G[i];\n        fr[i]%=mod;\n    }\n    ntt(fr,kkksc03,-1);\n    /*for(int i=n-m;i>=0;i--)cout<<fr[i]<<\" \";\n    cout<<endl;*/\n    reverse(fr,fr+n-m+1);\n    for(int i=n-m+1;i<n;i++)fr[i]=0;\n    for(int i=0;i<=n-m;i++)cout<<fr[i]<<\" \";\n    cout<<endl;\n    for(int i=n-m+1;i<1000000;i++)fr[i]=0;\n    kkksc03=1,l=0;\n    while(kkksc03<n+2)kkksc03<<=1,l++;\n    for(int i=0;i<kkksc03;i++){\n        r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n    }\n    ntt(gt,kkksc03,1);\n    ntt(fr,kkksc03,1);\n    for(int i=0;i<kkksc03;i++){\n        gt[i]*=fr[i];\n        gt[i]%=mod;\n    }\n    ntt(gt,kkksc03,-1);\n    //for(int i=0;i<kkksc03;i++)cout<<gt[i]<<endl;\n    for(int i=0;i<m;i++){\n        cout<<((f[i]-gt[i]+mod)%mod+mod)%mod<<\" \";\n    }\n    cout<<endl;\n    return 0;\n}\n```\n\nUpd in 5/5:\u6539\u6b63\u4e86\u4e00\u4e2a\u5fae\u5c0f\u9519\u8bef\n\n\u4eba\u751f\u7b2c\u4e00\u9053\u9ed1\u9898\u5c31\u6b64\u7ed3\u675f",
        "postTime": 1577015092,
        "uid": 92840,
        "name": "Komodo",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4512 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u9664\u6cd5\u3011"
    },
    {
        "content": "\u591a\u9879\u5f0fPascal\u9898\u89e3\u00b7\u7b2c\u4e09\u5f39\n\n\u628a[\u591a\u9879\u5f0f\u6c42\u9006](https://www.luogu.org/problemnew/show/P4512)\u7684\u677f\u5b50\u590d\u5236\u4e0b\u6765\u6539\u4e00\u6539\u5c31\u597d\u4e86\uff08\u6211\u7684[\u591a\u9879\u5f0f\u6c42\u9006\u9898\u89e3](qwq\n\n\u8fd9\u9898 $ Q_R(x) = F_R(x)G_R^{-1}(x) $\uff0c$ R(x) $ \u76f4\u63a5\u6c42\u5c31\u597d\u4e86\u3002\n\n\u4ee3\u7801\u5199\u7684\u8d85\u4e11\uff0c\u51d1\u5408\u7740\u770b\u5427\n\n~~\u5410\u69fd\u4e00\u53e5\u8fd9\u9898\u9898\u89e3\u600e\u4e48\u90a3\u4e48\u5c11\u554a~~\n\n```pas\ntype\n  arr = array[0..524287] of longint;//\u5b9a\u4e49\u591a\u9879\u5f0f\nconst\n  p  = 998244353;              //\u6a21\u6570\n  g  = 3;                      //\u539f\u6839\n  gi = 332748118;\nvar\n  a, b, q, rr, pow, r: arr;\n  n, m, i: longint;\n\n  procedure swap(var x, y: longint);//\u4ea4\u6362\n  var\n    t: longint;\n  begin\n    t := x;\n    x := y;\n    y := t;\n  end;\n\n  function power(x, y: longint): longint;//\u5feb\u901f\u5e42\n  begin\n    power := 1;\n    while y > 0 do\n    begin\n      if odd(y) then\n        power := int64(power) * x mod p;\n      x := sqr(int64(x)) mod p;\n      y := y shr 1;\n    end;\n  end;\n\n  function inv(x: longint): longint;//\u9006\u5143\n  begin\n    exit(power(x, p - 2));\n  end;\n\n  procedure reverse(var a: arr; n: longint);//\u7ffb\u8f6c\n  var\n    i: longint;\n  begin\n    for i := 0 to n div 2 do\n      swap(a[i], a[n - i]);\n  end;\n\n  procedure ntt(var a: arr; n, s: longint);//NTT\uff0c\u4e0d\u8be6\u7ec6\u5199\u4e86\n  var\n    i, j, k, x, y, w: longint;\n  begin\n    for i := 0 to n - 1 do\n      if i < r[i] then\n        swap(a[i], a[r[i]]);\n    i := 1;\n    while i < n do\n    begin\n      j := 0;\n      if s = 1 then\n        w := power(g, (p - 1) div (i shl 1))\n      else\n        w := power(gi, (p - 1) div (i shl 1));\n      pow[0] := 1;\n      for k := 1 to i - 1 do\n        pow[k] := int64(pow[k - 1]) * w mod p;\n      while j < n do\n      begin\n        for k := 0 to i - 1 do\n        begin\n          x := a[j + k];\n          y := int64(a[i + j + k]) * pow[k] mod p;\n          a[j + k] := (x + y) mod p;\n          a[i + j + k] := (x - y) mod p;\n        end;\n        Inc(j, i shl 1);\n      end;\n      i := i shl 1;\n    end;\n    if s = -1 then\n    begin\n      x := inv(n);\n      for i := 0 to n - 1 do\n        a[i] := (int64(a[i]) * x mod p + p) mod p;\n    end;\n  end;\n\n  function mul(a, b: arr; n, m: longint): arr;//\u591a\u9879\u5f0f\u4e58\u6cd5\uff0c\u4e0d\u8be6\u7ec6\u5199\u4e86\n  var\n    i, l, num: longint;\n  begin\n    num := 1;\n    l := 0;\n    while num <= n + m do\n    begin\n      num := num shl 1;\n      Inc(l);\n    end;\n    for i := 0 to num - 1 do\n      r[i] := (r[i shr 1] shr 1) or ((i and 1) shl (l - 1));\n    ntt(a, num, 1);\n    ntt(b, num, 1);\n    for i := 0 to num - 1 do\n      mul[i] := int64(a[i]) * b[i] mod p;\n    ntt(mul, num, -1);\n  end;\n\n  function inv(x: arr; n: longint): arr;//\u6c42\u9006\u5143\uff0c\u4e0d\u8be6\u7ec6\u5199\u4e86\n  var\n    t: arr;\n    i, l, num: longint;\n  begin\n    num := 2;\n    l := 1;\n    inv[0] := inv(x[0]);\n    while num <= n shl 1 do\n    begin\n      num := num shl 1;\n      Inc(l);\n      for i := 0 to num - 1 do\n        r[i] := (r[i shr 1] shr 1) or ((i and 1) shl (l - 1));\n      for i := 0 to num shr 1 - 1 do\n        t[i] := x[i];\n      ntt(inv, num, 1);\n      ntt(t, num, 1);\n      for i := 0 to num - 1 do\n        inv[i] := int64((p + 2 - int64(inv[i]) * t[i] mod p) mod p) * inv[i] mod p;\n      ntt(inv, num, -1);\n      for i := num shr 1 to num - 1 do\n        inv[i] := 0;\n    end;\n    for i := n + 1 to num shr 1 - 1 do\n      inv[i] := 0;\n  end;\n\n  function dv(a, b: arr; n, m: longint): arr;//\u591a\u9879\u5f0f\u9664\u6cd5\u5566\u5566\u5566\n  var\n    i: longint;\n  begin\n    reverse(a, n);              //\u7ffb\u8f6ca\n    reverse(b, m);              //\u7ffb\u8f6cb\n    dv := mul(a, inv(b, n - m), n, n - m);//a*b^-1\n    reverse(dv, n - m);         //\u7b54\u6848\u518d\u7ffb\u8f6c\n    for i := n - m + 1 to 2 * n do//\u6e05\u96f6\n      dv[i] := 0;\n  end;\n\nbegin\n  Read(n, m);\n  for i := 0 to n do\n    Read(a[i]);\n  for i := 0 to m do\n    Read(b[i]);\n  q := dv(a, b, n, m);\n  for i := 0 to n - m do\n    Write(q[i], ' ');\n  writeln;\n  rr := mul(q, b, n - m, m);\n  for i := 0 to m - 1 do        //\u8fb9\u7b97\u8fb9\u8f93\u51fa\n    Write((p + a[i] - rr[i]) mod p, ' ');\n  writeln;\nend.\n```",
        "postTime": 1554974068,
        "uid": 40241,
        "name": "dblark",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4512 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u9664\u6cd5\u3011"
    },
    {
        "content": "\n\u9898\u76ee\u94fe\u63a5\uff1a[$\\texttt{P4512}$](https://www.luogu.com.cn/problem/P4512)\n\n\u672c\u6587\u6536\u5f55\u4e8e[\u591a\u9879\u5f0f\u5168\u5bb6\u6876\u5b66\u4e60\u7b14\u8bb0](https://www.luogu.com.cn/blog/144853/Polynomial-notes-and-codes)\u3002\n\n---\n\n\u524d\u7f6e\u77e5\u8bc6\uff1a[\u591a\u9879\u5f0f\u6c42\u9006](https://www.luogu.com.cn/problem/P4238) \u548c [\u591a\u9879\u5f0f\u4e58\u6cd5](https://www.luogu.com.cn/problem/P3803)\u3002\n\n\u8fd9\u91cc\u9898\u76ee\u8981\u6c42\u7684\u662f\u4e24\u4e2a\u591a\u9879\u5f0f $D(x)$ \u548c $R(x)$ \uff0c\u4f7f\u5f97 $F(x)=D(x)\\cdot G(x)+R(x)$\u3002\n\n\u8bbe\u6709\u4e00\u79cd\u64cd\u4f5c $r$\uff0c\u4f7f\u5f97 $F_r(x)$ \u4e3a\u539f\u6570\u7ec4 $F(x)$ \u7684\u7cfb\u6570\u53cd\u8fc7\u6765\uff0c\u5373\u8bbe $F(x)=1+2x+3x^2$\uff0c\u5219 $F_r(x)=3+2x+x^3$\u3002\u7528\u6570\u5b66\u8868\u8fbe\u5c31\u662f\uff1a\n\n$$F_r(x)=\\sum^n_{i=0}x^nF[i]$$\n\n\u5176\u4e2d $F[i]$ \u8868\u793a\u591a\u9879\u5f0f $F$ \u7684 $i$ \u6b21\u9879\u3002\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f00\u59cb\u5316\u5f0f\u5b50\u4e86\u3002\n\n$$F(x)=D(x)\\cdot G(x)+R(x)$$\n$$x^nF(x)=x^n\\cdot D(x)\\cdot G(x)+x^nR(x)$$\n$$x^nF(x)=\\left(x^m\\cdot D(x)\\right)\\cdot\\left(x^{n-m}\\cdot G(x)\\right)+x^{n-m+1}\\cdot\\left(x^{m-1}\\cdot R(x)\\right)$$\n$$F_r(x)=D_r(x)\\cdot G_r(x)+x^{n-m+1}\\cdot R_r(x)$$\n$$F_r(x)=D_r(x)\\cdot G_r(x)\\pmod{x^{n-m+1}}$$\n$$D_r(x)=\\frac{F_r(x)}{G_r(x)}\\pmod{x^{n-m+1}}$$\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u4e24\u4e2a\u591a\u9879\u5f0f\u53cd\u8f6c\u4e00\u4e0b\uff0c\u9664\u6570\u6c42\u9006\u4e4b\u540e\u518d\u4e58\u8d77\u6765\uff0c\u518d\u53cd\u8f6c\u5c31\u53ef\u4ee5\u6c42\u51fa $D(x)$ \u5566\u3002\n\n\u800c $R(x)$ \u6c42\u51fa\u7684\u65b9\u6cd5\u53ef\u4ee5\u7531\u4e0a\u9762\u7684\u5f0f\u5b50\u79fb\u9879\u4e4b\u540e\u5f97\u5230\uff0c\u5373\uff1a\n\n$$R(x)=F(x)-G(x)\\cdot D(x)$$\n\n**Code**\n```cpp\nvoid getDiv(int *f,int *g,int *q,int *r,int lenf,int leng)\n{\n    memset(div1,0,sizeof(div1));//invgR(x)\n    memset(div2,0,sizeof(div2));//fR(x)\n    memset(div3,0,sizeof(div3));//gR(x)\n    memset(div4,0,sizeof(div4));//q\n    memset(div5,0,sizeof(div5));//f\n    memset(div6,0,sizeof(div6));//g\n    for(int i=0,x=lenf-1; x>=0; i++,x--)\n        div2[i]=f[x],div5[i]=f[i];\n    for(int i=0,x=leng-1; x>=0; i++,x--)\n        div3[i]=g[x],div6[i]=g[i];\n    int len=lenf-leng+1;\n    getInv(div3,div1,len);\n    init(len);\n    for(int i=len; i<lenf; i++)\n        div2[i]=div3[i]=0;\n    NTT(div2,lim,1);\n    NTT(div1,lim,1);\n    for(int i=0; i<lim; i++)\n        div2[i]=1ll*div2[i]%p*div1[i]%p;\n    NTT(div2,lim,-1);\n    for(int i=0,j=len-1; j>=0; i++,j--)\n        div4[i]=div2[j],q[i]=div4[i];\n    for(int i=len; i<lenf; i++)\n        div4[i]=q[i]=0;\n    len=lenf;\n    init(len);\n    NTT(div6,lim,1);\n    NTT(div4,lim,1);\n    for(int i=0; i<lim; i++)\n        div4[i]=1ll*div4[i]*div6[i]%p;\n    NTT(div4,lim,-1);\n    for(int i=0; i<leng-1; i++)\n        r[i]=((f[i]-div4[i])%p+p)%p;\n    return;\n}\n```",
        "postTime": 1647351920,
        "uid": 144853,
        "name": "\u9759\u8c27\u5e7d\u84dd",
        "ccfLevel": 6,
        "title": "P4512 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u9664\u6cd5"
    },
    {
        "content": "\u4eba\u751f\u7b2c\u4e00\u9053\u9ed1\u9898\uff0c\u796d\u4e4b\u3002\n\n\n\u524d\u7f6e\u77e5\u8bc6\uff1a[FFT&NTT](https://www.luogu.com.cn/problem/P3803)\uff0c[\u591a\u9879\u5f0f\u4e58\u6cd5\u9006](https://www.luogu.com.cn/problem/P4238)\uff0c\u4e0d\u4f1a\u7684\u5148\u51fa\u95e8\u5de6\u8f6c\u5427\u3002\n\n---\n### $Solution:$\n\n\u8fd9\u9053\u9898\u5982\u679c\u6ca1\u6709\u8fd9\u4e2a $R(x)$ \u90a3\u5c31\u76f4\u63a5\u4e58\u6cd5\u9006\u505a\u5b8c\u4e86\u3002\u4e8e\u662f\u6211\u4eec\u7684\u76ee\u7684\u5c31\u662f\u628a\u8fd9\u4e2a $R(x)$ \u6d88\u6389\u3002\n\n\u7531\u4e8e\u8fd9\u662f\u4e2a\u591a\u9879\u5f0f\uff0c\u6211\u4eec\u53ea\u80fd\u9760\u53d6\u6a21\u8fd9\u4e00\u64cd\u4f5c\u628a $R(x)$ \u9879\u6d88\u6389\u3002\n\n\u90a3\u4e48\u6211\u4eec\u6700\u540e\u5e94\u8be5\u5f97\u5230\u8fd9\u6837\u4e00\u4e2a\u5f0f\u5b50\uff1a\n\n$$F^*(x)=Q^*(x)G^*(x)+x^kR^*(x)$$\n\n\u5176\u4e2d $F^*(x), Q^*(x), G^*(x), R^*(x)$ \u662f\u7531\u539f\u6765\u7684\u5f0f\u5b50\u7ecf\u8fc7\u4e00\u7cfb\u5217\u53d8\u6362\u5f97\u6765\u7684\u3002\u8fd9\u6837\u5b50\u76f4\u63a5\u6a21\u4e00\u4e2a $x^k$ \u5c31\u884c\u4e86\u3002\n\n\u9898\u9762\u4e2d\u8bf4\u5230 $R(x)$ \u6b21\u6570\u5c0f\u4e8e $m$ \uff0c\u4e5f\u5c31\u662f\u5c0f\u4e8e\u7b49\u4e8e $m-1$\uff0c\u800c\u4e14 $F(x)$ \u548c $Q(x)G(x)$ \u7684\u6b21\u6570\u5747\u4e3a $n$\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u8ba9 $k=n-m+1$\u3002\n\n\u90a3\u600e\u4e48\u5f97\u5230\u8fd9\u79cd\u5f0f\u5b50\u5462\uff1f\n\n\u8fd9\u91cc\u6709\u4e00\u4e2a\u5f88~~naive~~\u795e\u4ed9\u7684\u64cd\u4f5c\uff1a\u5b9a\u4e49 $k$ \u6b21\u591a\u9879\u5f0f $F^*(x)=x^kF(x^{-1})$\uff01\n\n\u6211\u4eec\u6765\u7528\u8fd9\u4e2a\u63a8\u4e00\u4e0b\u5f0f\u5b50\uff1a\n\n$$F(x)=Q(x)G(x)+R(x)$$\n\n$$x^nF(x^{-1})=x^nQ(x^{-1})G(x^{-1})+x^nR(x^{-1})$$\n\n$$F^*(x)=Q^*(x)G^*(x)+x^{n-m+1}R^*(x)$$\n\n\u8fd9\u4e0b\u6211\u4eec\u9700\u8981\u7684\u5f0f\u5b50\u5c31\u63a8\u51fa\u6765\u4e86/cy\n\n\u800c\u4e14\uff0c$Q^*(x)$ \u662f $n-m$ \u6b21\u7684\uff0c\u6a21\u4e00\u4e0b\u4e5f\u6ca1\u4ec0\u4e48\u95ee\u9898\uff01\n\n\u81f3\u4e8e $F^*(x)$\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e2a\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u6070\u597d\u662f $F(x)$ \u7cfb\u6570\u7ffb\u8f6c\u8fc7\u540e\u5f97\u6765\u7684\uff0c\u8bc1\u660e\u7684\u8bdd\uff0c\u76f4\u63a5\u5c55\u5f00\u5c31\u884c\u3002\n\n\u5bf9\u4e0a\u9762\u90a3\u4e2a\u5f0f\u5b50\u6a21\u4e00\u4e2a $x^{n-m+1}$\uff1a\n\n$$F^*(x)\\equiv Q^*(x)G^*(x)(\\!\\!\\!\\!\\!\\!\\mod\\ x^{n-m+1})$$\n\n$$Q^*(x)\\equiv\\frac{F^*(x)}{G^*(x)}(\\!\\!\\!\\!\\!\\!\\mod\\ x^{n-m+1})$$\n\n$Q^*(x)$ \u5c31\u7528\u4e00\u4e2a\u591a\u9879\u5f0f\u4e58\u6cd5\u9006\u5c31\u77e5\u9053\u4e86\u3002\u5f97\u5230 $Q^*(x)$ \u540e $Q(x)$ \u4e5f\u5c31\u77e5\u9053\u4e86\u3002\n\n\u5f97\u5230 $Q(x)$\uff0c$R(x)$ \u5c31\u4e0d\u96be\u5566\uff1a\n\n$$R(x)=F(x)-Q(x)G(x)$$\n\n\u81f3\u6b64\uff0c\u6574\u9053\u9898\u8fce\u5203\u800c\u89e3\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\log n)$\u3002\n\n\u653e\u4e00\u4e0b\u6838\u5fc3\u4ee3\u7801\uff1a\n\n### $Code:$\n\n```cpp\ninline ll fpow(ll n, ll p){\n\tll ans = 1, base = n;\n\twhile(p){\n\t\tif(p & 1) ans = ans * base % mod;\n\t\tbase = base * base % mod;\n\t\tp >>= 1;\n\t}\n\treturn ans;\n}//\u5feb\u901f\u5e42\nll n, m, r[N], A[N], a[N], b[N], f[N], rev, c[N], d[N], e[N];\ninline void clr(ll *A, ll x, ll y){\n\tfor(int i = x; i < y; ++i) A[i] = 0;\n}//\u6e05\u7a7a\ninline void cpy(ll *A, ll *B, ll x, ll y){\n\tfor(int i = x; i < y; ++i) A[i] = B[i];\n}//\u8d4b\u503c\ninline void NTT(ll typ, ll *a, ll lim){\n\tif(lim != rev){\n\t\trev = lim;\n\t\tfor(int i = 0; i < lim; ++i) r[i] = (r[i >> 1] >> 1) | ((i & 1) ? (lim >> 1) : 0); \n\t}\n\tfor(ll i = 0; i < lim; ++i) if(i < r[i]) swap(a[i], a[r[i]]);\n\tfor(ll mid = 1; mid < lim; mid <<= 1){\n\t\tll R = mid << 1, rt = fpow(typ == 1 ? g : invg, (mod - 1) / R);\n\t\tfor(ll j = 0; j < lim; j += R){\n\t\t\tll w = 1;\n\t\t\tfor(ll k = 0; k < mid; k++, w = w * rt % mod){\n\t\t\t\tll x = a[j | k], y = w * a[j | k | mid] % mod;\n\t\t\t\ta[j | k] = (x + y) % mod;\n\t\t\t\ta[j | k | mid] = (x - y + mod) % mod;\n\t\t\t}\n\t\t}\n\t}\n\tif(typ < 0) for(ll i = 0, k = fpow(lim, mod - 2); i < lim; ++i) a[i] = a[i] * k % mod; \n}//NTT \u677f\u5b50\ninline void ptm(ll *A, ll *B, ll len){\n\tfor(int i = 0; i < len; ++i) A[i] = A[i] * B[i] % mod; \n} //point multiple\uff0c\u70b9\u4e58\ninline void print(ll *A, ll len){\n\tfor(ll i = 0; i < len; ++i) printf(\"%lld \", A[i]);\n\tprintf(\"\\n\");\n}//\u8f93\u51fa\ninline void Polymul(ll *A, ll *B, ll len, ll m){\n\tll lim = 1; while(lim < len) lim <<= 1;\n\tcpy(e, B, 0, lim); clr(e, len, lim);\n\tNTT(1, A, lim); NTT(1, e, lim); ptm(A, e, lim);\n\tNTT(-1, A, lim); clr(A, m, lim);\n}//\u591a\u9879\u5f0f\u4e58\u6cd5\ninline void Polyinv(ll *A, ll len){\n\tll lim = 1; while(lim < len) lim <<= 1;\n\ta[0] = fpow(A[0], mod - 2);\n\tfor(ll m = 2; m <= lim; m <<= 1){\n\t\tfor(ll i = 0; i < (m >> 1); ++i) b[i] = (a[i] << 1) % mod;\n\t\tcpy(f, A, 0, m);\n\t\tNTT(1, a, m << 1); ptm(a, a, m << 1);\n\t\tNTT(1, f, m << 1); ptm(a, f, m << 1);\n\t\tNTT(-1, a, m << 1); clr(a, m, m << 1);\n\t\tfor(ll i = 0; i < m; ++i) a[i] = (b[i] - a[i] + mod) % mod;\n\t}\n\tcpy(A, a, 0, len);\n\tclr(f, 0, lim << 1); clr(a, 0, lim << 1); clr(b, 0, lim << 1);\n}//\u591a\u9879\u5f0f\u6c42\u9006\ninline void Rev(ll *A, ll len){\n\tfor(register int i = 0; i < len / 2; ++i) swap(A[i], A[len - i - 1]);\n}//\u7ffb\u8f6c\u7cfb\u6570\ninline void Polydiv(ll *A, ll *B, ll n, ll m){\n\tint len = n - m + 1;\n\tRev(B, m); cpy(c, B, 0, len); Rev(B, m);\n\tRev(A, n); cpy(d, A, 0, len); Rev(A, n);\n\tPolyinv(c, len); Polymul(c, d, len << 1, len); Rev(c, len);\n\tPolymul(B, c, n << 1, n);\n\tfor(register int i = 0; i < m - 1; ++i) B[i] = (A[i] - B[i] + mod) % mod;\n\tclr(B, m - 1, n); cpy(A, c, 0, len); clr(A, len, n);  \n}//\u6838\u5fc3\u4e2d\u7684\u6838\u5fc3\uff1a\u591a\u9879\u5f0f\u9664\u6cd5\n```\n\n\u5269\u4f59\u7684 IO\uff0c\u7b80\u5355\u5934\u6587\u4ef6\u548c main \u51fd\u6570\u5c31\u4e0d\u653e\u4e86\uff0c\u770b\u61c2\u7684\u540c\u5b66\u5e94\u8be5\u53ef\u4ee5\u5199\u51fa\u6765\u3002",
        "postTime": 1596716342,
        "uid": 147999,
        "name": "Warriors_Cat",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4512 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u9664\u6cd5\u3011"
    },
    {
        "content": "\u8fd9\u6ce2\u6ca1\u6709\u9ad8\u6570\u4f46\u662f\u601d\u8def\u786e\u5b9e\u5f88\u5de7\u5999\u554a  \n\u5bf9\u4e8e$F(x)=H(x)*G(x)+R(x)$ \u6c42$H(x)\\,R(x)$ \n$F(\\frac{1}{x})=H(\\frac{1}{x})*G(\\frac{1}{x})+R(\\frac{1}{x})$\u540c\u6837\u6210\u7acb  \n$x^nF(\\frac{1}{x})=x^{n}H(\\frac{1}{x})*G(\\frac{1}{x})+x^{n}R(\\frac{1}{x})$ \n$x^nF(\\frac{1}{x})=x^{n-m}H(\\frac{1}{x})*x^mG(\\frac{1}{x})+x^{n-m+1}*x^{m-1}R(\\frac{1}{x})$ \n\u5bf9\u4e8e\u6700\u9ad8\u4f4d\u4e3an\u7684$F(x)$\u6765\u8bf4$x^nF(\\frac{1}{x})$\u5c31\u662f\u628a\u5404\u9879\u7cfb\u6570\u53cd\u8f6c\u4ee5\u540e\u7684$F(x)$  \n\u6211\u4eec\u628a\u5b83\u8bb0\u4e3a$F_r(x)$  \n\u540c\u7406\u53ef\u4ee5\u5f97\u5230$F_r(x)=H_r(x)*G_r(x)+x^{n-m+1}R_r(x)$  \n\u5728\u6a21$x^{n-m+1}$\u7684\u60c5\u51b5\u4e0b\n$F_r(x)=H_r(x)*G_r(x)$  \n$H_r(x)=F_r(x)*G_r(x)^{-1}$  \n\u6c42\u51fa$H_r(x)$\u5c31\u53ef\u4ee5\u53cd\u8f6c\u51fa$H(x)$  \n\u63a5\u7740\u6839\u636e$R(x)=F(x)-H(x)*G(x)$\u7b97\u51fa$R(x)$  \n\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define mod 998244353\n#define gg 3\nusing namespace std;\n\nlong long f[400040],g[400040],h[400040],rr[400040],inv[400040],tmp1[400040],tmp2[400040],tmp3[400040],tmp4[400040];\nint r[400040];\nint n,m;\n\nlong long kasumi(long long a,long long b)\n{\n    long long ans=1;\n    while(b)\n    {\n        if(b&1) ans=ans*a%mod;\n        a=a*a%mod;\n        b>>=1;\n    }\n    return ans;\n}\n\nvoid get_rev(int cnt)\n{\n    int lim=1<<cnt;\n    for(int i=0;i<lim;i++)\n    {\n        r[i]=(r[i>>1]>>1)|((i&1)<<(cnt-1));\n    }\n}\n\nvoid NTT(long long *a,int kd,int cnt)\n{\n    int lim=1<<cnt;\n    for(int i=0;i<lim;i++) if(r[i]>i) swap(a[i],a[r[i]]);\n    for(int mid=1;mid<lim;mid<<=1)\n    {\n        long long wn=kasumi(gg,(mod-1)/(mid<<1));\n        if(kd) wn=kasumi(wn,mod-2);\n        for(int i=0;i<lim;i+=(mid<<1))\n        {\n            long long w=1;\n            for(int j=0;j<mid;j++,w=wn*w%mod)\n            {\n                long long x=a[i+j];\n                long long y=a[i+j+mid]*w%mod;\n                a[i+j]=(x+y)%mod;\n                a[i+j+mid]=(x-y+mod)%mod;\n            }\n        }\n    }\n    if(kd)\n    {\n        long long invl=kasumi(lim,mod-2);\n        for(int i=0;i<lim;i++) a[i]=a[i]*invl%mod;\n    }\n}\n\nvoid get_inv(long long *a,int len)\n{\n    inv[0]=kasumi(a[0],mod-2);\n    int lim=1,cnt=0;\n    while(lim<=len)\n    {\n        lim<<=1;\n        cnt++;\n        get_rev(cnt);\n        for(int i=0;i<lim>>1;i++)\n        {\n            tmp1[i]=inv[i];\n            tmp2[i]=a[i];\n        }\n        NTT(tmp1,0,cnt),NTT(tmp2,0,cnt);\n        for(int i=0;i<lim;i++)\n        {\n            tmp1[i]=(tmp1[i]*2ll%mod-tmp1[i]*tmp1[i]%mod*tmp2[i]%mod+mod)%mod;\n        }\n        NTT(tmp1,1,cnt);\n        for(int i=0;i<lim>>1;i++)\n        {\n            inv[i]=tmp1[i];\n        }\n    }\n}\n\nint main()\n{\n    int lim=1,cnt=0;\n    scanf(\"%d%d\",&n,&m);\n    while(lim<=n*2) lim<<=1,cnt++; \n    for(int i=0;i<=n;i++) scanf(\"%lld\",&f[i]),tmp3[n-i]=f[i];\n    for(int i=0;i<=m;i++) scanf(\"%lld\",&g[i]),tmp4[m-i]=g[i];\n    for(int i=n-m+2;i<=m;i++) tmp4[i]=0;\n    get_inv(tmp4,(n-m+1)<<1);\n    get_rev(cnt);\n    memset(tmp4,0,sizeof(tmp4));\n    for(int i=0;i<=n-m+1;i++) tmp4[i]=inv[i];\n    NTT(tmp3,0,cnt),NTT(tmp4,0,cnt);\n    for(int i=0;i<lim;i++) tmp3[i]=tmp3[i]*tmp4[i]%mod;\n    NTT(tmp3,1,cnt);\n    for(int i=0;i<=(n-m+1);i++) h[i]=tmp3[i];\n    lim=1,cnt=0;\n    for(int i=0;i<=n-m;i++) if(i>(n-m-i)) swap(tmp3[i],tmp3[n-m-i]),swap(h[i],h[n-m-i]);\n    while(lim<=n*2) lim<<=1,cnt++;\n    for(int i=(n-m+1);i<lim;i++) tmp3[i]=0;\n    get_rev(cnt);\n    NTT(g,0,cnt),NTT(tmp3,0,cnt);\n    for(int i=0;i<lim;i++) g[i]=g[i]*tmp3[i]%mod;\n    NTT(g,1,cnt);\n    for(int i=0;i<lim;i++) rr[i]=(f[i]-g[i]+mod)%mod;\n    for(int i=0;i<=(n-m);i++) printf(\"%lld \",h[i]);\n    puts(\"\");\n    for(int i=0;i<=m-1;i++) printf(\"%lld \",rr[i]);\n    puts(\"\"); \n}\n```",
        "postTime": 1554101899,
        "uid": 185441,
        "name": "\u30cb\u30d2\u30eb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4512 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u9664\u6cd5\u3011"
    }
]
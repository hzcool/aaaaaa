[
    {
        "content": "\u4e00\u4e2a\u663e\u7136\u7684\u7ed3\u8bba\u662f\uff0c\u53f3\u62ec\u53f7\u6570\u76ee\u76f8\u540c\u7684\u62ec\u53f7\u5e8f\u5217\u51fa\u73b0\u7684\u6982\u7387\u76f8\u540c\u3002\n\n\u4ee4$f_{i,j}$\u8868\u793a\u5f53\u524d\u53c2\u6570\u4e3a$i$\uff0c$S$\u4e2d\u53f3\u62ec\u53f7\u7684\u6570\u76ee\u662f$j$\u3002\n\n\u5219\uff0c\n$$\nf_{i-1,j}=\\frac{N-j+1}{N}\\sum_{k=j-1}f_{i,k}\\prod_{l=j}^{k}\\frac{l}{N}\n$$\n\u5bb9\u6613\u7528\u524d\u7f00\u548c\u4f18\u5316\u5f97\u5230\u5168\u90e8\u7684$f_{0,d}$\u3002\u8ba1\u7b97\u51fa\u4e86\u6700\u7ec8\u6709$d$\u4e2a\u62ec\u53f7\u5e8f\u5217\u7684\u6982\u7387\uff0c\u9664\u4ee5\u4e2a\u6570\uff0c\u5373\u53ef\u5f97\u5230\u6bcf\u4e00\u79cd\u6709$d$\u4e2a\u53f3\u62ec\u53f7\u7684\u62ec\u53f7\u5e8f\u5217\u7684\u6982\u7387\u3002\n\n\u63a5\u4e0b\u6765\u7684\u95ee\u9898\u8f6c\u5316\u4e3a\u5bf9\u957f\u5ea6\u7ed9\u5b9a\u7684\u6700\u957f\u5408\u6cd5\u62ec\u53f7\u5b50\u5e8f\u5217\u8ba1\u6570\u3002\n\n\u8003\u8651\u600e\u4e48\u6c42\u89e3\u4e00\u4e2a\u62ec\u53f7\u5e8f\u5217\u7684\u6700\u957f\u5408\u6cd5\u5b50\u5e8f\u5217\u957f\u5ea6\uff0c\u7ed9\u51fa\u7ed3\u8bba\uff1a\n\n> \u4ee4$sum_i$\u8868\u793a\u4ee4$'('$\u4e3a$1$\uff0c$')'$\u4e3a$ -1$\u7684\u524d\u7f00\u548c\uff0c\u5219\u6709$ans=N-sum_n+2min\\space sum_i$\u3002\n\n\u8bc1\u660e\u7684\u8bdd\uff0c\u8003\u8651\u4ee4$x$\u8868\u793a$sum_x$\u6700\u5c0f\u7684\u4f4d\u7f6e\uff0c\u90a3\u4e48\u5728\u6b64\u4e4b\u524d\u6709$-sum_x$\u4e2a\u53f3\u62ec\u53f7\u662f\u4e0d\u80fd\u5339\u914d\u7684\uff0c\u4e4b\u540e\u53c8\u6709$(sum_n-sum_x)$\u4e2a\u5de6\u62ec\u53f7\u4e0d\u80fd\u5339\u914d\u3002\u51cf\u53bb\u4e0d\u5339\u914d\u7684\uff0c\u5373\u5408\u6cd5\u7684\u3002\n\n\u95ee\u9898\u5373\uff0c\u4e3a\u957f\u5ea6\u4e3a$N$\uff0c\u5171\u6709\u7ed9\u5b9a\u4e2a$\\pm 1$\uff0c\u5bf9\u524d\u7f00\u548c\u4e0d\u5c0f\u4e8e\u67d0\u4e00\u7ed9\u5b9a\u503c\u7684\u5e8f\u5217\u8ba1\u6570\u3002\u8003\u8651\u5176\u7ec4\u5408\u610f\u4e49\uff0c\u76f8\u5f53\u4e8e\u521d\u59cb\u5728$(0,0)$\uff0c\u6bcf\u6b21\u6a2a\u5750\u6807$+1$\uff0c\u7eb5\u5750\u6807$\\pm 1$\uff0c\u6c42\u51fa\u4e0d\u7ecf\u8fc7\u67d0\u4e00\u6761\u76f4\u7ebf\u5230\u8fbe\u67d0\u4e00\u4e2a\u70b9\u7684\u65b9\u6848\u6570\u3002\u6298\u7ebf\u6cd5\u5373\u53ef\u3002\n\n\u603b\u590d\u6742\u5ea6$O(NK+N^2)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntemplate<typename T>inline T read(){\n\tT f=0,x=0;char c=getchar();\n\twhile(!isdigit(c)) f=c=='-',c=getchar();\n\twhile(isdigit(c)) x=x*10+c-48,c=getchar();\n\treturn f?-x:x;\n}\nnamespace run{\n\tconst int N=5009,mod=998244353;\n\tinline int add(int x,int y){return x+y>=mod?x-mod+y:x+y;}\n\tinline int sub(int x,int y){return x>=y?x-y:x+mod-y;}\n\tinline int qpow(int x,int y){\n\t\tint ret=1;\n\t\twhile(y){\n\t\t\tif(y&1) ret=1LL*x*ret%mod;\n\t\t\tx=1LL*x*x%mod,y>>=1;\n\t\t}\n\t\treturn ret;\n\t}\n\tint fac[N],ifac[N];\n\tinline int C(int n,int m){\n\t\tif(n<0 || m<0 || n<m) return 0;\n\t\treturn 1LL*fac[n]*ifac[m]%mod*ifac[n-m]%mod;\n\t}inline int calc(int n,int d,int m){return sub(C(n,n-d-m),C(n,n-d-m+1));}\n\n\tint f[N][N],n,k,inv;\n\tint main(){\n\t\tn=read<int>(),k=read<int>(),inv=qpow(n,mod-2);\n\t\tfac[0]=ifac[0]=ifac[1]=1;\n\t\tfor(int i=1;i<=n;i++) fac[i]=1LL*fac[i-1]*i%mod;\n\t\tifac[n]=qpow(fac[n],mod-2);\n\t\tfor(int i=n-1;i>=1;i--) ifac[i]=1LL*ifac[i+1]*(i+1)%mod;\n\t\tassert(1LL*fac[n-1]*ifac[n-1]%mod==1);\n\n\t\tf[0][0]=1;\n\t\tfor(int i=1;i<=k;i++){\n\t\t\tint sum=f[i-1][n];\n\t\t\tfor(int j=min(n,i);j;j--){\n\t\t\t\tsum=(1LL*sum*j%mod*inv+f[i-1][j-1])%mod;\n\t\t\t\tf[i][j]=1LL*inv*(n-j+1)%mod*sum%mod;\n\t\t\t}\n\t\t}\n\t\tint chk=0;\n\t\tfor(int i=0;i<=n;i++) chk=add(chk,f[k][i]);\n\t\tassert(chk==1);\n\n\t\tfor(int i=1;i<=n;i++) f[k][i]=1LL*f[k][i]*qpow(C(n,i),mod-2)%mod;\n\t\tint ans=0;\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tfor(int j=2;j<=n && min(i,n-i)>=j/2;j+=2)\n\t\t\t\tans=(1LL*f[k][i]*calc(n,i,(j-2*i)/2)%mod*j+ans)%mod;\n\t\tprintf(\"%d\\n\",ans);\n\t\treturn 0;\n\t}\n}\nint main(){\n#ifdef my\n\tfreopen(\"sequence.in\",\"r\",stdin);\n\tfreopen(\"sequence.out\",\"w\",stdout);\n#endif\n\treturn run::main();\n}\n```\n",
        "postTime": 1595672489,
        "uid": 139717,
        "name": "\u9752\u8471",
        "ccfLevel": 9,
        "title": "P6689 \u5e8f\u5217"
    },
    {
        "content": "\u6765\u4e3a\u6b64\u9898\uff0c\u63d0\u4f9b\u4e2a\u505a\u6cd5  \n\u975e\u5e38\u663e\u7136\u7684\u601d\u8def\u662fk\u4e2a\u53f3\u62ec\u53f7\u7684\u6982\u7387\u662f\u76f8\u540c\u7684  \n\u524d\u9762\u505a\u4e00\u6b21DP\u5c31\u53ef\u4ee5\u4e86\uff0c\u5176\u4ed6\u9898\u89e3\u8bf4\u7684\u5f88\u8be6\u7ec6\u4e0d\u518d\u8d58\u8ff0  \n\u8003\u8651\u600e\u4e48\u6c42\u540e\u9762\u7684\u6709k\u4e2a\u53f3\u62ec\u53f7\u65f6\u7684\u671f\u671b  \n\u6ce8\u610f\u5230\u5728\u5220\u9664\u6240\u6709\u5339\u914d\u62ec\u53f7\u5bf9\u540e  \n\u539f\u5e8f\u5217\u6784\u6210 $)))(((($\u7684\u5f62\u5f0f  \n\u8bbe\u5171\u6709k\u4e2a\uff0c\u90a3\u4e48\u628a\u539f\u56fe\u5206\u6210\u4e86k+1\u6bb5  \n\u6bcf\u4e00\u6bb5\u7684\u65b9\u6848\u6570\u662f\u5361\u7279\u5170\u6570\uff0c\u90a3\u4e48\u6211\u4eec\u8981\u6c42\u5361\u7279\u5170\u65701\u5230n+1\u6b21\u65b9\u4e2d\u5404\u4e00\u9879  \n$\\frac{1}{\\sqrt{1-4x}}(\\frac{1-\\sqrt{1-4x}}{2x})^k=\\sum C_{2*i+k}^{i}x^i$  \n\u8fd9\u662f\u5e7f\u4e49\u4e8c\u9879\u7ea7\u6570\u5f0f\u5b50\uff0c\u53ef\u4ee5\u4f7f\u7528\u62c9\u683c\u6717\u65e5\u53cd\u6f14\u8bc1\u660e\uff0c\u60f3\u4e86\u89e3\u7684\u53ef\u4ee5\u53bb\u770bEI\u7684\u535a\u5ba2  \n\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u6c42\u4e00\u9879\uff0c\u6240\u4ee5\u66b4\u529b\u5377\u79ef\u4e00\u4e2a$\\sqrt{1-4x}$\u5c31\u597d  \n\u6700\u540e\u66b4\u529b\u679a\u4e3e\u5de6\u53f3\u62ec\u53f7\u6570\u91cf\u7b97\u7b54\u6848\u5373\u53ef  \n$O(n^2)$\n```cpp\n#include<iostream>\n#include<iomanip>\n#include<cstring>\n#include<cmath>\n#include<cstdio>\n#include<queue>\n#include<algorithm>\nusing namespace std;\nconst int maxn=15000;\nconst int mod=998244353;\nint n,k;\nlong long ans=0,fir[maxn+5],inv[maxn+5],c[maxn+5],p[5005],s[5005],A[5005],B[5005];\nint f[5005][5005],sum[5005],dp[5005][5005];\nlong long revn;\nlong long ksm(long long x,long long n)\n{\n\tlong long ans=1;\n\twhile(n)\n\t{\n\t\tif(n&1) ans=ans*x%mod;\n\t\tx=x*x%mod;\n\t\tn>>=1;\n\t}\n\treturn ans;\n}\nvoid pre()\n{\n\tfir[0]=1;\n\tfor(int i=1;i<=maxn;i++) fir[i]=fir[i-1]*i%mod;\n\tinv[maxn]=ksm(fir[maxn],mod-2);\n\tfor(int i=maxn-1;i>=0;i--) inv[i]=inv[i+1]*(i+1)%mod;\n}\nlong long C(int n,int m)\n{\n\tif(n<m) return 0;\n\t\n\treturn fir[n]*inv[m]%mod*inv[n-m]%mod;\n}\nint main()\n{\n\tpre();\n\tscanf(\"%d%d\",&n,&k);revn=ksm(n,mod-2);\n\tc[0]=1;\n\tfor(int i=1;i<=n;i++) c[i]=(C(2*i,i)-C(2*i,i-1)+mod)%mod;\n\tdp[0][0]=1;\n\tfor(int i=1;i<=k;i++)\n\t{\n\t\tfor(int j=1;j<=n;j++) dp[i][j]=(dp[i][j]+1ll*dp[i-1][j-1]*(n-j+1)%mod*revn%mod)%mod;\n\t\tif(i!=k) for(int j=n;j>=0;j--) dp[i][j]=(dp[i][j]+1ll*dp[i][j+1]*(j+1)%mod*revn%mod)%mod;\n\t}\n\tfor(int i=0;i<=n;i++) p[i]=dp[k][i]*ksm(C(n,i),mod-2)%mod;\n\tfor(int i=1;i<=n+1;i++)\n\t{\n\t\tfor(int j=0;j<=n;j++) A[j]=C(2*j+i,j);\n\t\tB[0]=1;\n\t\tfor(int j=0;j<=n;j++) B[j+1]=-2*c[j]%mod;\n\t\tint x=(n-i+1)/2;\n\t\tfor(int j=0;j<=x;j++) s[i]=(s[i]+A[j]*B[x-j]%mod)%mod;\n\t}\n\tlong long ans=0;\n\tfor(int i=0;i<=n;i++)\n\tfor(int j=0;j+i<=n;j++) if(!((n-i-j)&1)) ans=(ans+s[i+j+1]*p[i+(n-i-j)/2]%mod*(n-i-j)%mod)%mod;\n\tprintf(\"%lld\\n\",ans);\n}\n```\n",
        "postTime": 1596116964,
        "uid": 78488,
        "name": "b2019dy",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P6689 \u3010\u5e8f\u5217\u3011"
    },
    {
        "content": "### \u3010\u9898\u89e3\u3011P6689 \u5e8f\u5217\n\n[blogs](https://www.cnblogs.com/winlere/p/13378564.html)\n\n\u4efb\u4f55\u4e00\u4e2a\u6709$i$\u4e2a\u53f3\u62ec\u53f7\u7684\u62ec\u53f7\u5e8f\u5217\u88ab\u90a3\u4e2a\u7b97\u6cd5\u751f\u6210\u7684\u6982\u7387\u662f\u4e00\u6837\u7684\uff0c\u5148\u8bbe$dp(i,j)$\u8868\u793a\u5df2\u7ecf\u586b\u4e86$i$\u4e2a\u62ec\u53f7\u5176\u4e2d$j$\u4e2a\u662f\u5de6\u62ec\u53f7\u7684\u6982\u7387\u3002\n\n\u8f6c\u79fb\u662f\n$$\ndp(i,j)={n-i+1\\over n}dp(i-1,j-1)+\\sum_{j=i}^n { j\\times (j-1)\\times (j-2)\\dots \\times i=j^{\\underline {j-i+1}} \\over n^{j-i+2}}(n-i+1)\n$$\n\u53ef\u4ee5\u7b80\u5355\u505a\u5230$O(n^2)$\n\n\u73b0\u5728\u8fd8\u5c11\u4e00\u4e2a\u4e1c\u897f\uff0c\u90a3\u5c31\u662f\u4e00\u4e2a\u6709$f_j=j$\u4e2a\u53f3\u62ec\u53f7\u7684\u957f\u5ea6\u4e3a$n$\u7684\u62ec\u53f7\u5e8f\u5217\u671f\u671b\u6709\u591a\u5c11\u5339\u914d(\u62ec\u53f7\u5339\u914d\u6307\u65b9\u6848\u6570\u662f\u5361\u7279\u5170\u6570\u90a3\u79cd\u5339\u914d)\u6570\uff0c\u679a\u4e3e\u4e00\u5bf9\u62ec\u53f7\u5339\u914d\u5728\u54ea\u4e2a\u5730\u65b9\u5e76\u4e14\u4ea7\u751f\u4e00\u7684\u8d21\u732e\uff0c\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e00\u5bf9\u62ec\u53f7\u5339\u914d\u4e4b\u95f4\u5fc5\u987b\u5b8c\u7f8e\u5339\u914d\uff0c\u65b9\u6848\u6570\u662f\u5361\u7279\u5170\u6570\u3002\n$$\nf_j=\\sum_{i=2}^n \\sum_{j=0}^{\\lfloor{i-2\\over 2}\\rfloor}  C_j {n-2j-2\\choose t-1-j}= \\sum_{j=0}^{\\lfloor{n-2\\over 2}\\rfloor} C_j (n-(2j-2)+1){n-2j-2\\choose t-1-j}\n$$\n\u590d\u6742\u5ea6$O(n^2)$\n\n```cpp\n//@winlere\n#include<iostream>\n#include<cstring>\n#include<algorithm>\n#include<cstdio>\n#include<initializer_list>\n\nusing namespace std; typedef long long ll;\nint qr(){\n\tint ret=0,c=getchar(),f=0;\n\twhile(!isdigit(c)) f|=c==45,c=getchar();\n\twhile( isdigit(c)) ret=ret*10+c-48,c=getchar();\n\treturn f?-ret:ret;\n}\nconst int maxn=5015;\nconst int mod=998244353;\nint jc[maxn<<1],inv[maxn<<1],invc[maxn<<1],dp[maxn][maxn],f[maxn<<1],temp[maxn],mi[maxn];\nint MOD(const int&x,const int&y){return 1ll*x*y%mod;}\nint MOD(const int&x){return x>=mod?x-mod:x;}\nint MOD(const initializer_list<int>&ve){int ret=1;for(auto t:ve) ret=MOD(ret,t); return ret;}\n\nint ksm(const int&ba,const int&p){\n\tint ret=1;\n\tfor(int t=p,b=ba;t;t>>=1,b=MOD(b,b))\n\t\tif(t&1) ret=MOD(ret,b);\n\treturn ret;\t\t\n}\nvoid pre(const int&n){\n\tjc[0]=inv[0]=1; jc[1]=inv[1]=invc[1]=1;\n\tfor(int t=2;t<=n;++t) jc[t]=MOD(jc[t-1],t),invc[t]=MOD(invc[mod%t],mod-mod/t),inv[t]=MOD(inv[t-1],invc[t]);\n}\n\nint c(const int&n,const int&m){return n<m||m<0?0:MOD(jc[n],MOD(inv[n-m],inv[m]));}\nint cat(int n){return MOD(c(2*n,n),invc[n+1]);}\n\nint main(){\n\tpre(1e4+5);\n\tint n=qr(),k=qr();\n\tdp[0][0]=1; mi[0]=1;\n\tfor(int t=1;t<=n+5;++t) mi[t]=MOD(mi[t-1],invc[n]);\n\tfor(int t=1;t<=k;++t){\n\t\tfor(int i=n;i;--i) temp[i]=MOD(MOD({dp[t-1][i],jc[i],mi[i+2]})+temp[i+1]);\n\t\tfor(int i=1,g=n;i<=n;++i,g=MOD(g,n)){\n\t\t\tint ret=0;\t\t\t\n\t\t\tret=MOD(ret+MOD({dp[t-1][i-1],n-i+1,invc[n]}));\n\t\t\tret=MOD(ret+MOD({temp[i],n-i+1,g,inv[i-1]}));\n\t\t\tdp[t][i]=ret;\n\t\t}\n\t}\n\tint ans=0;\n\tfor(int t=0;t<=n;++t){\n\t\tint ret=0;\n\t\tfor(int j=0;j<=n/2-1;++j){\n\t\t\tint sav=MOD({cat(j),n-2*j-1,c(n-2*j-2,t-1-j)});\n\t\t\tret=MOD(ret+sav);\n\t\t}\n\t\tans=MOD(ans+MOD({inv[n],jc[t],jc[n-t],dp[k][t],ret,2}));\n\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n\n\n```\n",
        "postTime": 1596019538,
        "uid": 113460,
        "name": "\u8c01\u662f\u9e3d\u738b",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P6689 \u3010\u5e8f\u5217\u3011"
    }
]
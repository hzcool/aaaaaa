[
    {
        "content": "# \u9898\u89e3-[BJWC2018]\u9910\u5dfe\u8ba1\u5212\u95ee\u9898\n\u597d\u597d\u7684\u7f51\u7edc\u6d41\u9898\uff0c\u53d8\u6210\u4e86\u961f\u5217\u52a0\u6a21\u62df\u3002\n\n**\u53c2\u8003\u8d44\u6599**\n> \u6682\u65e0\n\n**[\u535a\u5ba2\u4e2d\u539f\u6587](https://blog.csdn.net/KonnyWen/article/details/104659156)**\n\n---\n## $\\color{#000}\\texttt{Introduction}$\n\u849f\u84bb\u5728\u5237\u7701\u9009\u6c34\u9898\u65f6\u53d1\u73b0\u4e00\u9053 [\\[HNOI2001\\]\u8f6f\u4ef6\u5f00\u53d1](https://www.luogu.com.cn/record/31354488)\uff0c\u4e0e\u5f53\u5e74\u7684\u7f51\u7edc\u6d41\u9898 [\u9910\u5dfe\u8ba1\u5212\u95ee\u9898](https://www.luogu.com.cn/problem/P1251) \u4e00\u6a21\u4e00\u6837\u3002\u7136\u540e\u849f\u84bb\u53c8\u770b\u4e86\u8ba8\u8bba\uff0c\u8fd9\u4e24\u9898\u53c8\u548c [\\[USACO08NOV\\]Toys G](https://www.luogu.com.cn/problem/P2917) \u548c [\\[BJWC2018\\]\u9910\u5dfe\u8ba1\u5212\u95ee\u9898](https://www.luogu.com.cn/problem/P4480) \u9664\u4e86\u6570\u636e\u8303\u56f4\u4ee5\u5916\u4e00\u6a21\u4e00\u6837\u3002\u7136\u540e\u8fd9\u9898\u5c31\u662f\u5176\u4e2d\u6570\u636e\u8303\u56f4\u6700\u5f3a\u7684\u4e86\uff0c\u505a\u6cd5\u7adf\u7136\u662f\u961f\u5217\u548c\u6a21\u62df\u3002\n\n---\n## $\\color{#000}\\texttt{Description}$\n> [\\[BJWC2018\\]\u9910\u5dfe\u8ba1\u5212\u95ee\u9898](https://www.luogu.com.cn/problem/P4480)\n\n> \u6709 $n$ \u5929\uff0c\u6bcf\u5929\u9700\u8981 $r_i$ \u5757\u5e72\u51c0\u9910\u5dfe\u7ed9\u4eba\u7528\uff0c\u7528\u5b8c\u540e\u4f1a\u810f\u3002\u6bcf\u5929\u4e70\u65b0\u5e72\u51c0\u9910\u5dfe $p$ \u5143\u6bcf\u5757\uff0c\u6d17\u810f\u9910\u5dfe\u9700\u8981 $c_1$ \u5143\u6bcf\u5757\u8017\u65f6 $m_1$  \u5929\u6216 $c_2$ \u5143\u6bcf\u5757\u8017\u65f6 $m_2$ \u5929\u3002\u6c42\u6700\u5c11\u82b1\u8d39\u3002\n\n> \u6570\u636e\u8303\u56f4\uff1a$1\\le n\\le 2\\times 10^5$\uff0c$1 \\le m_1, m_2 \\le n$\uff0c$1 \\le c_1, c_2, p \\le 100$\uff0c$1 \\le r_i \\le 100$ \u3002\n---\n## $\\color{#000}\\texttt{Solution}$\n\n\u7f51\u7edc\u6d41\u7684 $50\\sim90$ \u5206\u505a\u6cd5\u5c31\u4e0d\u8d58\u8ff0\u4e86\u3002\n\n\u9996\u5148\u4ece\u4e24\u79cd\u6d17\u9910\u5dfe\u65b9\u5f0f\u5165\u624b\u3002\u628a $m$ \u5927\u7684\u6d17\u9910\u5dfe\u65b9\u5f0f\u53eb\u6162\u6d17\uff0c\u53cd\u4e4b\u53eb\u5feb\u6d17\u3002\u5982\u679c\u6162\u6d17\u6bd4\u5feb\u6d17\u8d35\uff0c\u628a\u6162\u6d17\u8bbe\u4e3a\u548c\u5feb\u6d17\u4e00\u6a21\u4e00\u6837\u3002\u8fd9\u6837\u6211\u4eec\u5c31\u6709**\u5feb\u6d17\u5feb\u800c\u8d35\uff0c\u6162\u6d17\u6162\u800c\u4fbf\u5b9c**\u4e24\u79cd\u6d17\u6cd5\u4e86\u3002\u4ee4\u5feb\u6d17\u65f6\u95f4\u4e3a $t_k$\uff0c\u4ef7\u683c\u4e3a $f_k$ \u6bcf\u5757\uff1b\u6162\u6d17\u65f6\u95f4\u4e3a $t_m$\uff0c\u4ef7\u683c\u4e3a $f_m$ \u6bcf\u5757\uff08$t_k\\le t_m,f_k\\ge f_m$\uff09\u3002\n\n\u4e70\u7684\u9910\u5dfe\u603b\u6570 $x$ \u662f\u4e0d\u5b9a\u7684\uff0c\u5982\u679c\u4e70\u591a\u4e86\u4e5f\u8017\u94b1\uff0c\u4e70\u5c11\u4e86\u6d17\u5f97\u591a\u4e5f\u8017\u94b1\u3002\u6240\u4ee5\u53ef\u4ee5\u76f4\u89c9\u63a8\u65ad**\u4e70\u9910\u5dfe\u6570\u91cf\u4e00\u5b9a\u7684\u60c5\u51b5\u4e0b\u6700\u5c11\u8017\u94b1\u968f $x$ \u800c\u53d8\u5316\u7684\u56fe\u50cf\u662f $V$ \u5b57\u578b**\uff0c\u6240\u4ee5\u53ef\u4ee5\u4e09\u5206\u6216\u659c\u7387\u4e8c\u5206\uff0c\u627e\u5230\u8fd9\u4e2a $x$\u3002\n\n\u4f46\u662f\u77e5\u9053\u4e86 $x$\uff0c\u600e\u4e48\u8ba1\u7b97\u6700\u4f18\u8017\u94b1\u5462\uff1f\u9996\u5148\u8981**\u65e9\u4e70\u9910\u5dfe**\uff0c\u56e0\u4e3a\u65e9\u70b9\u4e70\u65e9\u70b9\u7528\u65e9\u70b9\u6d17\u5bf9\u6bcf\u4e2a\u9910\u5dfe\u7684\u5229\u7528\u7387\u9ad8\u3002\u6240\u4ee5\u53ef\u4ee5\u7528\u4e70\u9910\u5dfe\u89e3\u51b3\u524d\u51e0\u5929\u7684\u9700\u6c42\u3002\n\n\u7136\u540e\u662f**\u80fd\u7528\u6162\u6d17\u4e0d\u7528\u5feb\u6d17**\uff0c\u5f88\u660e\u663e\uff0c\u56e0\u4e3a\u5feb\u6d17\u8d35\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u7528**\u4e09\u4e2a\u53cc\u5411\u961f\u5217\u7ef4\u62a4\u810f\u9910\u5dfe\uff08\u6bcf\u5929\u7528\u5b8c\u7684\u9910\u5dfe\uff09\u3001\u6162\u6d17\u5b8c\u7684\u9910\u5dfe\uff08\u7528\u5b8c\u540e\u81f3\u5c11 $t_m$ \u5929\uff09\u3001\u5feb\u6d17\u5b8c\u7684\u9910\u5dfe\uff08\u7528\u5b8c\u540e $t_k\\sim t_m-1$\uff09**\u3002\u6bcf\u5929\u628a\u810f\u9910\u5dfe\u961f\u5217\u7684\u672b\u5c3e\u7528\u5b8c\u65f6\u95f4\u5230 $t_k$ \u5929\u7684\u9910\u5dfe\u653e\u8fdb\u5feb\u6d17\u5b8c\u7684\u9910\u5dfe\u961f\u5217\u5934\uff0c\u7136\u540e\u628a\u5feb\u6d17\u5b8c\u7684\u9910\u5dfe\u961f\u5217\u672b\u5c3e\u65f6\u95f4\u5230 $t_m$ \u7684\u9910\u5dfe\u653e\u8fdb\u6162\u6d17\u5b8c\u7684\u961f\u5217\u5934\u3002\u7136\u540e\u6309**\u5148\u4e70\u518d\u6162\u6d17\u6700\u540e\u5feb\u6d17**\u7684\u987a\u5e8f\u6a21\u62df\u5373\u53ef\u3002\n\n\u7279\u522b\u7684\uff0c\u5982\u679c\u67d0\u5929\u7684\u8981\u6c42\u600e\u4e48\u90fd\u6ee1\u8db3\u4e0d\u4e86\uff0c\u5c31\u8fd4\u56de $\\infty$\u3002\n\n\u6700\u540e\u7b54\u6848\u5c31\u662f\u4e09\u5206\u6216\u659c\u7387\u4e8c\u5206\u5f97\u5230\u7684\u8017\u94b1\u8c37\u70b9\u7684\u8017\u94b1\u6570\u3002\n\n---\n\n## $\\color{#000}\\texttt{Code}$\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n//&Start\n#define lng long long\n#define lit long double\nconst int inf=0x3f3f3f3f;\nconst lng Inf=1e17;\n\n//&Check\nconst int N=2e5+10;\nint n,r[N],fx,fm,fk,Tm,Tk,sm,ans=inf;\nstruct bag{int T,v;};\n//\u4e70\u6765\u7684\u65f6\u95f4\u3001\u6570\u91cf\uff08\u628a\u591a\u4efd\u4e00\u8d77\u4e70\u7684\u9910\u5dfe\u6253\u5305\uff09\ndeque<bag> qx,qm,qk;//\u65b0\u4e70\u3001\u6162\u6d17\u3001\u5feb\u6d17\nint f(int x){//\u4e70x\u5757\u9910\u5dfe\u8ba1\u7b97\u6700\u4f18\u8017\u94b1\n\tint res=x*fx;//\u4e70\u9910\u5dfe\u7684\u94b1\n\tqx.clear(),qm.clear(),qk.clear();\n\tfor(int i=1;i<=n;i++){\n\t\twhile(qx.size()&&qx.front().T+Tk<=i)\n\t\t\tqk.push_back(qx.front()),qx.pop_front();\n\t\t//\u628a\u65e7\u9910\u5dfe\u5feb\u6d17\u5b8c\u7684\u4e22\u8fdb\u5feb\u6d17\u961f\u5217\n\t\twhile(qk.size()&&qk.front().T+Tm<=i)\n\t\t\tqm.push_back(qk.front()),qk.pop_front();\n\t\t//\u628a\u5feb\u6d17\u5b8c\u7684\u9910\u5dfe\u6162\u6d17\u5b8c\u7684\u4e22\u8fdb\u6162\u6d17\u961f\u5217\n\t\tint nd=r[i],by=min(nd,x);//\u5982\u679c\u8fd8\u53ef\u4ee5\u4e70\u9910\u5dfe\u5c31\u5148\u4e70\n\t\tx-=by,nd-=by;\n\t\twhile(nd&&qm.size()){//\u5148\u6162\u6d17\n\t\t\tby=min(nd,qm.back().v);\n\t\t\tnd-=by,res+=by*fm;\n\t\t\tif(by==qm.back().v) qm.pop_back();//\u7528\u5b8c\u4e86\n\t\t\telse qm.back().v-=by;\n\t\t}\n\t\twhile(nd&&qk.size()){//\u518d\u5feb\u6d17\n\t\t\tby=min(nd,qk.back().v);\n\t\t\tnd-=by,res+=by*fk;\n\t\t\tif(by==qk.back().v) qk.pop_back();//\u7528\u5b8c\u4e86\n\t\t\telse qk.back().v-=by;\n\t\t}\n\t\tif(nd) return inf;\n\t\tqx.push_back((bag){i,r[i]});\n\t}\n\treturn res;\n}\n\n//&Main\nint main(){\n\tscanf(\"%d%d%d%d%d%d\",&n,&Tm,&Tk,&fm,&fk,&fx);\n\tif(Tm<Tk) swap(Tm,Tk),swap(fm,fk);\n\tif(fm>fk) Tm=Tk,fm=fk;//\u4fdd\u8bc1\u5feb\u6d17\u5feb\u8d35\uff0c\u6162\u6d17\u6162\u4fbf\u5b9c\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",r+i),sm+=r[i];\n\tint l=0,r=sm+1;\n\twhile(l<r-1){//\u659c\u7387\u4e8c\u5206\n\t\tint mid=(l+r)>>1;\n\t\tif(f(mid)<f(mid+1)) r=mid;\n\t\telse l=mid;\n\t}\n\tprintf(\"%d\\n\",f(r));//Go!\n\treturn 0;\n}\n```\n\n---\n\u7136\u540e\u628a\u8fd9\u4efd\u4ee3\u7801\u4ea4\u5230\u53e6\u5916\u4e09\u9898\uff0c\u5c31\u59a5\u59a5\u56db\u500d\u7ecf\u9a8c\u4e86\u3002\u6211\u8fd8\u662f\u592a\u84bb\u4e86\u3002**\u795d\u5927\u5bb6\u5b66\u4e60\u6109\u5feb\uff01**",
        "postTime": 1583328237,
        "uid": 118365,
        "name": "George1123",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4480 \u3010[BJWC2018]\u9910\u5dfe\u8ba1\u5212\u95ee\u9898\u3011"
    },
    {
        "content": "\u4e3a\u4ec0\u4e48\u90fd\u8bf4\u8fd9\u9898\u7f51\u7edc\u6d41\u53ea\u670950~90\u5206\u554a\uff0c\u6211\u76f4\u63a5\u628a[P1251](https://www.luogu.com.cn/problem/P1251)\u7684\u4ee3\u7801\u642c\u8fc7\u6765\uff0c\u6570\u636e\u8303\u56f4\u6539\u5927\u4e00\u70b9\u5c31\u76f4\u63a5\u8fc7\u4e86\u3002 ~~\uff08\u5361\u5e38\u90fd\u4e0d\u7528\u662f\u6211\u6ca1\u60f3\u5230\u7684\uff09~~\n\n\u6211\u611f\u89c9\u53ef\u80fd\u662f\u6211\u7f51\u7edc\u6d41\u5199\u7684\u4e0d\u7b97\u96be\u770b\uff0c\u90a3\u6211\u5c31\u7a0d\u5fae\u5206\u4eab\u4e00\u4e0b\u7f51\u7edc\u6d41\u7684\u51e0\u70b9\u4f18\u5316\u5427\u3002\n\n1. zkw\u8d39\u7528\u6d41\u662f\u5fc5\u987b\u7684\uff0c\u6216\u8005\u591a\u8def\u589e\u5e7fspfa\u4e5f\u884c\uff08\u8bdd\u8bf4\u8fd9\u9053\u9898\u591a\u8def\u589e\u5e7fspfa\u751a\u81f3\u6bd4zkw\u8dd1\u5f97\u8fd8\u5feb\uff09\n\n2. \u63a8\u8350\u6700\u77ed\u8defspfa\u7528\u53cc\u7aef\u961f\u5217\u4f18\u5316\u7684spfa\uff08\u4e0d\u52a0\u5199\u597d\u770b\u70b9\u4e5f\u80fd\u8fc7\uff0c\u4f46\u6700\u540e\u4e00\u4e2a\u70b9\u5b8c\u5168\u662f\u5361\u7740\u8fc7\u4e86\uff09\n\n3. \u5fc5\u987b\u8981\u52a0\u5f53\u524d\u5f27\u4f18\u5316\uff0c\u4e0d\u7136\u4f60\u5c31\u4f1a\u6df1\u6df1\u611f\u53d7\u7b2c10\u4e2a\u70b9\u7684\u9669\u6076\n\n4. \u5efa\u8bae\u5199\u5feb\u8bfb\uff0c\u5feb\u51fa\u5728\u8fd9\u9053\u9898\u6ca1\u5fc5\u8981\n\n5. \u6e05\u96f6\u5c3d\u53ef\u80fd\u7528memset\uff08\u597d\u50cfmemset\u6bd4for\u5faa\u73af\u8981\u5feb\u4e00\u70b9\u5427\uff1f\uff09\n\n6. \u8bb0\u5f97\u5f00\u5176\u4ed6\u5927\u5927\u5c0f\u5c0f\u7684\u7384\u5b66\u4f18\u5316\n\n7. \u5207\u8bb0\u8981\u5438\u6c27\n\n\u7531\u4e8e\u6211\u4e60\u60ef\u6253zkw\uff0c\u90a3\u6211\u5c31\u628a\u6211\u7684zkw\u4ee3\u7801\u653e\u4e0a\u6765\u5427\uff08\u7801\u98ce\u6709\u4ebf\u70b9\u70b9\u5947\u602a\uff09\n\n```cpp\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<queue>\n#define ll long long\n#define inf 1e17\n#define inff 1e9\n#define M 3000005\n#define N 400005\nusing namespace std;\nstruct nood{\n\tint x,y,z,w;\n}q[M];\nint k[N],c[N];\nll d[N];\nint su=1,s,t,n;\nll co;\nbool v[N]; \ninline int r()\n{\n\tchar h=getchar();\n\tint y=0,q=1;\n\twhile(h<'0'||h>'9'){if(h=='-')q=-1;h=getchar();}\n\twhile(h>='0'&&h<='9'){y=y*10+h-'0';h=getchar();}\n\treturn y*q;\n}\ninline void jr(int a,int b,int c,int d)\n{\n\tq[++su]=(nood){k[a],b,c,d};\n\tk[a]=su;\n\tq[++su]=(nood){k[b],a,0,-d};\n\tk[b]=su;\n}\ninline bool spfa()\n{\n\tmemset(d,0x3f,sizeof d);\n\tdeque<int>dl;\n\tdl.push_front(t);\n\td[t]=0;\n\twhile(!dl.empty())\n\t{\n\t\tif(dl.size()>1&&d[dl.front()]>d[dl.back()])swap(dl.front(),dl.back());\n\t\tint x=dl.front();dl.pop_front();\n\t\tv[x]=0;\n\t\tfor(int i=k[x];i;i=q[i].x)\n\t\t{\n\t\t\tint y=q[i].y,z=q[i^1].z,w=q[i].w;\n\t\t\tif(!z)continue;\n\t\t\tif(d[y]>d[x]-w)\n\t\t\t{\n\t\t\t\td[y]=d[x]-w;\n\t\t\t\tif(!v[y])\n\t\t\t\t{\n\t\t\t\t\tv[y]=1;\n\t\t\t\t\tif(dl.size()&&d[y]<d[dl.front()])dl.push_front(y);\n\t\t\t\t\telse dl.push_back(y);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn d[s]!=d[0];\n}\nint dfs(int x,int nl)\n{\n\tif(x==t||!nl)return nl;\n\tv[x]=1;\n\tint sl=0;\n\tfor(int i=c[x];i;i=q[i].x)\n\t{\n\t\tc[x]=i;\n\t\tint y=q[i].y,z=q[i].z,w=q[i].w;\n\t\tll l;\n\t\tif(!v[y]&&d[y]==d[x]-w&&z&&(l=dfs(y,min(nl,z))))\n\t\t{\n\t\t\tnl-=l;\n\t\t\tsl+=l;\n\t\t\tq[i].z-=l;\n\t\t\tq[i^1].z+=l;\n\t\t\tco+=w*l;\n\t\t\tif(!nl)break;\n\t\t}\n\t}\n\tif(nl)d[x]=-1;\n\tv[x]=0;\n\treturn sl;\n}\ninline void zkw()\n{\n\tint x;\n\twhile(spfa())\n\t{\n\t\tmemcpy(c,k,sizeof k);\n\t\twhile((x=dfs(s,inff)));\n\t}\n}\nsigned main()\n{\n\tn=r();int a=r(),b=r(),c=r(),d=r(),e=r();\n\ts=(n<<1)+1,t=s+1;\n\tfor(int x,i=1;i<=n;i++)x=r(),jr(s,i,x,0),jr(i+n,t,x,0);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(i+1<=n)jr(i,i+1,inff,0);\n\t\tif(i+a<=n)jr(i,i+a+n,inff,c);\n\t\tif(i+b<=n)jr(i,i+b+n,inff,d);\n\t\tjr(s,i+n,inff,e);\n\t}\n\tzkw();\n\tprintf(\"%lld\\n\",co);\n}\n```\n\n~~\u53cc\u500d\u7ecf\u9a8c\u5230\u624b~~",
        "postTime": 1610026447,
        "uid": 203743,
        "name": "\u6ed1\u5927\u7a3d",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4480 \u3010[BJWC2018]\u9910\u5dfe\u8ba1\u5212\u95ee\u9898\u3011"
    },
    {
        "content": "[P4480 [BJWC2018]\u9910\u5dfe\u8ba1\u5212\u95ee\u9898](https://www.luogu.com.cn/problem/P4480)\n\n\u53cc\u500d\u7ecf\u9a8c[P2917 [USACO08NOV]Toys G](https://www.luogu.com.cn/problem/P2917)\n\n\u5148\u8003\u8651\u4e00\u4e0b\u8fd9\u9898\u7684\u90e8\u5206\u5206/\u5f31\u5316\u7248[P1251 \u9910\u5dfe\u8ba1\u5212\u95ee\u9898](https://www.luogu.com.cn/problem/P1251)\uff0c\u8fd9\u662f\u4e00\u4e2a\u7ecf\u5178\u7684**\u8d39\u7528\u6d41\u95ee\u9898**\uff0c\u505a\u6cd5\u5982\u4e0b\uff1a\n\n* \u9996\u5148\u62c6\u70b9\u3002\u628a\u6bcf\u4e00\u5929\u62c6\u6210\u65e9\u4e0a\u548c\u665a\u4e0a\uff0c\u65e9\u4e0a\u7528\u5e72\u51c0\u7684\u9910\u5dfe\uff0c\u665a\u4e0a\u56de\u6536\u810f\u7684\u9910\u5dfe\u3002\n\n- \u6e90\u70b9\u5411\u6bcf\u4e00\u5929\u7684\u665a\u4e0a\u8fde\u4e00\u6761\u6d41\u91cf\u4e3a $r_i$\uff0c\u8d39\u7528\u4e3a0\u7684\u8fb9\uff0c\u8868\u793a\u8fd9\u4e00\u5929\u5f97\u5230\u7684\u810f\u9910\u5dfe\u3002\u6bcf\u4e00\u5929\u7684\u65e9\u4e0a\u5411\u6c47\u70b9\u8fde\u4e00\u6761\u6d41\u91cf\u4e3a $r_i$\uff0c\u8d39\u7528\u4e3a0\u7684\u8fb9\uff0c\u8868\u793a\u8fd9\u4e00\u5929\u8981\u63d0\u4f9b $r_i$ \u6761\u5e72\u51c0\u6bdb\u5dfe\u3002\u8fd9\u6837\u8fde\u8fb9\u7684\u76ee\u7684\u662f\u4fdd\u8bc1\u6709 $r_i$ \u7684\u5e72\u51c0\u6bdb\u5dfe\u7684\u6d41\u91cf\u6d41\u8fc7\u8fd9\u4e00\u5929\u3002\uff08\u611f\u89c9\u8fd9\u4e00\u6b65\u4e0d\u592a\u597d\u60f3\uff0c\u4e2a\u4eba\u8ba4\u4e3a\u8fd9\u662f**\u672c\u9898\u6838\u5fc3**\u4e86\uff09\n- \u6bcf\u4e00\u5929\u665a\u4e0a\u5411\u4e0b\u4e00\u5929\u665a\u4e0a\u8fde\u4e00\u6761\u6d41\u91cf\u4e3aINF\uff0c\u8d39\u7528\u4e3a0\u7684\u8fb9\uff0c\u5904\u7406\u4e0d\u6d17\u7684\u60c5\u51b5\n- \u6bcf\u4e00\u5929\u665a\u4e0a\u5411\u5feb\u6d17\u7ed3\u675f\u4e4b\u540e\u7684\u90a3\u5929\u65e9\u4e0a\u8fde\u4e00\u6761\u6d41\u91cf\u4e3aINF\uff0c\u8d39\u7528\u4e3a\u5feb\u6d17\u8d39\u7528\u7684\u8fb9\uff0c\u5904\u7406\u5feb\u6d17\u7684\u60c5\u51b5\u3002\u6162\u6d17\u7684\u8fde\u8fb9\u65b9\u5f0f\u4e0e\u5feb\u6d17\u76f8\u540c\u3002\n- \u6e90\u70b9\u5411\u6bcf\u4e00\u5929\u65e9\u4e0a\u8fde\u4e00\u6761\u6d41\u91cf\u4e3aINF\uff0c\u8d39\u7528\u4e3a\u4e70\u65b0\u6bdb\u5dfe\u8d39\u7528\u7684\u8fb9\uff0c\u4ee3\u8868\u65b0\u4e70\u6bdb\u5dfe\u3002\n\n\u5230\u8fd9\u91cc\u6211\u4eec\u5c31\u53ef\u4ee5 AC [P1251 \u9910\u5dfe\u8ba1\u5212\u95ee\u9898](https://www.luogu.com.cn/problem/P1251)\u548c\u5b83\u7684\u53cc\u500d\u7ecf\u9a8c[P2223 [HNOI2001]\u8f6f\u4ef6\u5f00\u53d1](https://www.luogu.com.cn/problem/P2223)\u4e86\u3002\u540e\u8005\u8f7b\u5fae\u5361\u5e38\u3002\u8fd9\u91cc\u653e\u4e00\u4e0bP1251\u7684\u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nnamespace FGF\n{\n\tint n,p,m1,m2,f1,f2;\n\tconst int N=1e4+5;\n\tconst int INF=0x3f3f3f3f;\n\tstruct edg{\n\t\tint to,nxt,w,d;\n\t}e[N<<2];\n\tint a[N],cnt=1,head[N],S,T,lst[N],vis[N],flo[N],dis[N];\n\tll ans=0;\n\tvoid add(int u,int v,int w,int d)\n\t{\n\t\tcnt++;\n\t\te[cnt].to=v;\n\t\te[cnt].nxt=head[u];\n\t\thead[u]=cnt;\n\t\te[cnt].w=w,e[cnt].d=d;\n\t}\n\tvoid Add(int u,int v,int w,int d){add(u,v,w,d),add(v,u,0,-d);}\n\tqueue<int> q;\n\tbool spfa()\n\t{\n\t\tmemset(vis,0,sizeof(vis)),memset(dis,0x3f,sizeof(dis));\n\t\tdis[S]=0,vis[S]=1,flo[S]=0x3f3f3f3f;q.push(S);\n\t\twhile(q.size())\n\t\t{\n\t\t\tint u=q.front();q.pop();\n\t\t\tvis[u]=0;\n\t\t\tfor(int i=head[u];i;i=e[i].nxt)\n\t\t\t{\n\t\t\t\tint v=e[i].to;\n\t\t\t\tif(dis[v]>dis[u]+e[i].d&&e[i].w)\n\t\t\t\t{\n\t\t\t\t\tdis[v]=dis[u]+e[i].d,flo[v]=min(flo[u],e[i].w),lst[v]=i;\n\t\t\t\t\tif(!vis[v])q.push(v),vis[v]=1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn dis[T]!=0x3f3f3f3f;\n\t}\n\tvoid work()\n\t{\n\t\tscanf(\"%d\",&n);\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tscanf(\"%d\",&a[i]);\n\t\tT=2*n+1;\n\t\tscanf(\"%d%d%d%d%d\",&p,&m1,&f1,&m2,&f2);\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tAdd(S,i+n,a[i],0),Add(i,T,a[i],0);\n\t\t\tAdd(S,i,INF,p);\n\t\t\tif(i<n)Add(i+n,i+n+1,INF,0);\n\t\t\tif(i+m1<=n)Add(i+n,i+m1,INF,f1);\n\t\t\tif(i+m2<=n)Add(i+n,i+m2,INF,f2);\n\t\t}\n\t\twhile(spfa())\n\t\t{\n\t\t\tint now=T;\n\t\t\tans+=1LL*flo[T]*dis[T];\n\t\t\twhile(now!=S)\n\t\t\t\te[lst[now]].w-=flo[T],e[lst[now]^1].w+=flo[T],now=e[lst[now]^1].to;\n\t\t}\n\t\tprintf(\"%lld\",ans);\n\t}\n}\nint main()\n{\n\tFGF::work();\n\treturn 0;\n}\n```\n\n\u4f46\u8d39\u7528\u6d41\u663e\u7136\u662f\u4e0d\u80fd\u5904\u7406 $2e5$ \u7684\u6570\u636e\u7684\uff08\u542c\u8bf4\u8fd9\u9898\u6570\u636e\u6c34\u53ef\u4ee5\u5361\u8fc7\u53bb\uff0c\u5f53\u7136\u50cf\u6211\u8fd9\u6837\u7684\u5927\u5e38\u6570\u9009\u624b\u80af\u5b9a\u662f\u4e0d\u884c\u7684\uff09\uff0c\u6211\u4eec\u9700\u8981\u66f4\u4f18\u79c0\u7684\u89e3\u6cd5\u3002\n\n\u9996\u5148\u6709\u4e24\u4e2a\u663e\u7136\u7684\u6027\u8d28\uff1a\n\n* \u5982\u679c\u4e70\u7684\u6bdb\u5dfe\u7684\u603b\u91cf\u4e00\u5b9a\uff0c\u8d8a\u65e9\u4e70\u4e00\u5b9a\u8d8a\u4f18\u3002\n* \u5982\u679c\u6162\u6d17\u6bd4\u5feb\u6d17\u8d35\uff0c\u90a3\u4e48\u5c31\u4e0d\u7528\u6162\u6d17\uff0c\u5c06\u5176\u76f4\u63a5\u6539\u4e3a\u5feb\u6d17\u3002\n\n\u5047\u8bbe\u5728\u8fd9 $n$ \u5929\u5185\u4e00\u5171\u8d2d\u4e70\u4e86 $x$ \u5757\u65b0\u9910\u5dfe\uff0c\u8bbe $f(x)$ \u8868\u793a\u4e00\u5171\u8d2d\u4e70\u4e86 $x$ \u5757\u65b0\u9910\u5dfe\u7684\u6700\u5c0f\u4ee3\u4ef7\uff0c\u6700\u4f18\u89e3\u4e00\u5171\u8d2d\u4e70\u4e86 $x'$\u5757\u65b0\u9910\u5dfe\u3002\u9996\u5148\u4e70\u591a\u4f59\u7684\u9910\u5dfe\u653e\u7740\u4e0d\u7528\u80af\u5b9a\u4e0d\u4f18\u3002\u82e5 $x=x'-k$\uff0c\u90a3\u4e48\u5728\u8d39\u7528\u6d41\u7684\u56fe\u4e0a\u8868\u793a\u4e70\u65b0\u9910\u5dfe\u7684\u8fb9\u5c31\u5c11\u6d41\u4e86 $k$ \u6b21\u3002\u7531\u4e8e\u5728\u8d39\u7528\u6d41\u4e2d\u6211\u4eec\u5bfb\u627e\u7684\u662f\u6700\u77ed\u8def\uff0c\u5c11\u6d41\u4e00\u6761\u6700\u77ed\u8def\u4e2d\u7684\u8fb9\u5c31\u8bf4\u660e\u8d70\u4e86\u4e00\u6761\u8f83\u957f\u8def\uff0c\u56e0\u6b64\u5c11\u4e70\u4e5f\u4e0d\u4f18\u3002\u7efc\u4e0a\uff0c$f(x)$\u4e3a\u5355\u5cf0\u51fd\u6570\uff0c\u6b64\u9898\u53ef\u7528**\u4e09\u5206**\u89e3\u51b3\u3002\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a\u4e86\u5982\u4f55\u6c42 $f(x)$\uff0c\u6211\u4eec\u8fdb\u884c\u8d2a\u5fc3\uff1a\n\n* \u5982\u679c\u8fd8\u80fd\u4e70\u65b0\u9910\u5dfe\u5c31\u4e70\n* \u65b0\u9910\u5dfe\u7528\u5b8c\u540e\u4f18\u5148\u7528\u6162\u6d17\u7684\u9910\u5dfe\uff0c\u518d\u7528\u5feb\u6d17\u7684\u9910\u5dfe\u3002\u56e0\u4e3a\u7ecf\u8fc7\u4e0a\u9762\u7684\u8f6c\u5316\uff0c\u6162\u6d17\u7684\u6bdb\u5dfe\u66f4\u4fbf\u5b9c\u3002\n* \u7528\u5feb\u6d17\u7684\u9910\u5dfe\u65f6\u8981\u4f18\u5148\u7528\u65f6\u95f4\u8f83\u665a\u7684\uff0c\u56e0\u4e3a\u65f6\u95f4\u8f83\u65e9\u7684\u66f4\u6709\u53ef\u80fd\u5728\u4e4b\u540e\u53d8\u4e3a\u6162\u6d17\u7684\u9910\u5dfe\u4ece\u800c\u51cf\u5c0f\u4ee3\u4ef7\u3002\n* \u5982\u679c\u6ca1\u6709\u53ef\u7528\u7684\u9910\u5dfe\u4e86\uff0c\u8bf4\u660e\u5f53\u524d\u6240\u8bbe\u7684 $x$ \u65e0\u6cd5\u6ee1\u8db3\u8981\u6c42\uff0c\u8fd4\u56de INF \u3002\n\n\u5177\u4f53\u5b9e\u73b0\u65f6\uff0c\u5f00\u4e09\u4e2a deque \u5206\u522b\u5b58\u5f04\u810f\u540e\u8fd8\u6ca1\u6d17\u597d\u7684\u9910\u5dfe\u3001\u5df2\u7ecf\u5feb\u6d17\u597d\u4e86\u7684\u9910\u5dfe\u548c\u5df2\u7ecf\u6162\u6d17\u597d\u4e86\u7684\u9910\u5dfe\uff0c\u6309\u4e0a\u9762\u8bf4\u7684\u56db\u6761\u539f\u5219\u6a21\u62df\u5373\u53ef\u3002\n\n~~\u6240\u4ee5\u8fd9\u9898\u5b9e\u9645\u4e0a\u662f\u56db\u500d\u7ecf\u9a8c~~\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nnamespace FGF\n{\n\tint n,m1,m2,f1,f2,p;\n\tconst int INF=2e9;\n\tconst int N=2e5+5;\n\tint a[N],sum,ans=INF;\n\tdeque<pair<int,int> >qs,qn,qf;//qn\u8868\u793a\u6b63\u5728\u6d17\u7684\uff0cqs\u8868\u793a\u5df2\u7ecf\u6162\u6d17\u597d\u4e86\u7684\uff0cqf\u8868\u793a\u5df2\u7ecf\u5feb\u6d17\u597d\u4e86\u7684 \n\tint calc(int x)\n\t{\n\t\tint s=p*x;\n\t\tqs.clear(),qn.clear(),qf.clear();\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\twhile(qn.size()&&qn.front().first<=i-m1)//\u5148\u66f4\u65b0\u961f\u5217\t\n\t\t\t\tqf.push_back(qn.front()),qn.pop_front();\n\t\t\twhile(qf.size()&&qf.front().first<=i-m2)\n\t\t\t\tqs.push_back(qf.front()),qf.pop_front();\n\t\t\tint nd=a[i],mn=min(nd,x);nd-=mn,x-=mn;//\u80fd\u4e70\u65b0\u7684\u5c3d\u91cf\u4e70 \n\t\t\twhile(nd&&qs.size())//\u80fd\u6162\u6d17\u5c31\u6162\u6d17 \n\t\t\t{\n\t\t\t\tmn=min(nd,qs.back().second);\n\t\t\t\ts+=mn*f2,nd-=mn;\n\t\t\t\tif(mn==qs.back().second)qs.pop_back();//\u7528\u5b8c\u7684\u53ca\u65f6\u5f39\u51fa\u4ee5\u4fdd\u8bc1\u590d\u6742\u5ea6 \n\t\t\t\telse qs.back().second-=mn;\n\t\t\t}\n\t\t\twhile(nd&&qf.size())//\u4e0d\u80fd\u6162\u6d17\u5c31\u5feb\u6d17 \n\t\t\t{\n\t\t\t\tmn=min(nd,qf.back().second);\n\t\t\t\ts+=mn*f1,nd-=mn;\n\t\t\t\tif(mn==qf.back().second)qf.pop_back();\n\t\t\t\telse qf.back().second-=mn;\n\t\t\t}\n\t\t\tif(nd)return INF;//\u6ee1\u8db3\u4e0d\u4e86\u9700\u6c42\uff0c\u8bf4\u660e\u5f53\u524d\u4e70\u7684\u603b\u91cf\u4e0d\u5408\u6cd5\u3002 \n\t\t\tqn.push_back(make_pair(i,a[i]));//\u628a\u8fd9\u4e00\u5929\u5f04\u810f\u7684\u62ff\u53bb\u6d17 \n\t\t}\n\t\treturn s;\n\t}\t\n\tvoid work()\n\t{\n\t\tscanf(\"%d%d%d%d%d%d\",&n,&m1,&m2,&f1,&f2,&p);\n\t\tif(m1>m2)swap(m1,m2),swap(f1,f2);\n\t\tif(f2>f1)f2=f1,m2=m1;//\u5982\u679c\u6162\u7684\u8fd8\u8d35\uff0c\u5c31\u4e0d\u7528\u5b83\uff0c\u628a\u5b83\u76f4\u63a5\u6539\u6210\u5feb\u7684\u65b9\u5f0f \n\t\tfor(int i=1;i<=n;i++)\n\t\t\tscanf(\"%d\",&a[i]),sum+=a[i];\n\t\tint l=0,r=sum+1;\n\t\twhile(r-l>2)\n\t\t{\n\t\t\tint k=(r-l)/3,mid1=l+k,mid2=r-k;\n\t\t\tcalc(mid1)>=calc(mid2)?l=mid1:r=mid2;\n\t\t}\n\t\tfor(int i=l;i<=r;i++)ans=min(ans,calc(i));\n\t\tprintf(\"%d\\n\",ans);\n\t}\n}\nint main()\n{\n\tFGF::work();\n\treturn 0;\n}\n```\n",
        "postTime": 1610506232,
        "uid": 224403,
        "name": "\u6728xx\u6728\u5927",
        "ccfLevel": 9,
        "title": "P4480 [BJWC2018]\u9910\u5dfe\u8ba1\u5212\u95ee\u9898\uff08\u8d39\u7528\u6d41->\u8d2a\u5fc3\uff09"
    },
    {
        "content": "\u4eba\u751f\u7b2c\u4e8c\u9053\u9ed1\u9898\u9898\u89e3\u3002\n\n**\u6b65\u5165\u6b63\u9898**\n\n\u770b\u89c1\u8fd9\u9053\u9898\u51e0\u4e4e\u90fd\u662f\u8d2a\u5fc3\uff0c\u6240\u4ee5\u8d21\u732e\u4e00\u4e2a\u7f51\u7edc\u6d41\u9898\u89e3\uff0c\u91cd\u70b9\u8bb2\u5982\u4f55\u5361\u5e38\uff0c\u60f3\u77e5\u9053\u4e3a\u4ec0\u4e48\u8fd9\u6837\u5efa\u6a21\u7684\u53ef\u4ee5\u53bb\u770b\u5f31\u5316\u7248\u9898\u89e3\u3002\n\n**\u5efa\u6a21\u65b9\u6cd5\uff1a**\n\n\u53ef\u4ee5\u6309\u7167[\u5f31\u5316\u7248](https://www.luogu.com.cn/problem/P4480)\u7684\u505a\u6cd5\u3002\n\n1. \u8003\u8651\u62c6\u70b9\uff0c\u5c06\u4e00\u4e2a\u70b9\u62c6\u6210\u65e9\u4e0a\u548c\u665a\u4e0a\uff0c\u65e9\u4e0a\u63a5\u53d7\u5e72\u51c0\u9910\u5dfe\uff0c\u665a\u4e0a\u53d1\u51fa\u810f\u9910\u5dfe\uff0c\u5efa\u7acb\u8d85\u7ea7\u6e90 $s$ \u548c\u8d85\u7ea7\u6c47 $t$\uff0c\u4ece $s$ \u8fde\u5411\u6bcf\u4e00\u5929\u65e9\u4e0a\uff0c\u5bb9\u91cf\u4e3a $r_i$\uff0c\u8d39\u7528\u4e3a $0$\uff1b\u4ece\u6bcf\u4e2a\u7ed3\u70b9\u7684\u665a\u4e0a\u8fde\u5411 $t$\uff0c\u5bb9\u91cf\u4e3a $r_i$\uff0c\u8d39\u7528\u4e3a $0$\u3002\n\n2. $s$ \u5411\u6bcf\u4e00\u5929\u665a\u4e0a\u8fde\u5bb9\u91cf\u4e3a $+\\infty$\uff0c\u8d39\u7528\u4e3a $p$ \u7684\u8fb9\uff0c\u8868\u793a\u4e70\u65b0\u9910\u5dfe\u3002\n\n3. \u6bcf\u4e2a\u7ed3\u70b9 $u_i$ \u5411 $u_{i+m_1}$ \u8fde\u5bb9\u91cf\u4e3a $+\\infty$\uff0c\u8d39\u7528\u4e3a $c_1$ \u7684\u8fb9\uff0c\u8868\u793a\u9001\u5feb\u6d17\u5e97\uff0c\u6162\u6d17\u5e97\u7c7b\u4f3c\u5904\u7406\u3002\n\n4. \u6bcf\u4e00\u5929\u65e9\u4e0a\u53ef\u4ee5\u9009\u62e9\u7559\u4e0b\u5e72\u51c0\u9910\u5dfe\u5907\u7528\uff0c\u6240\u4ee5\u4ece $u_i$ \u8fde\u5411 $u_{i+1}$\uff0c\u5bb9\u91cf\u4e3a $+\\infty$\uff0c\u8d39\u7528\u4e3a $0$\u3002\n\n5. \u6c42\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\uff0c\u6700\u5c0f\u8d39\u7528\u5373\u4e3a\u6240\u6c42\u3002\n\n**\u5361\u5e38**\n\n\u9996\u5148\uff0c\u5355\u8def\u589e\u5e7f\u7684 MCMF \u80af\u5b9a\u6b7b\u7684\u4e0d\u80fd\u518d\u6b7b\u4e86\uff0c\u8003\u8651\u5bf9\u5176\u4f18\u5316\uff0c\u60f3\u5230\u591a\u8def\u589e\u5e7f MCMF\uff0c\u6253\u4e86\u4e00\u6ce2\u677f\u5b50\uff0c\u4ea4\u4e0a\u53bb\u4ecd\u7136 TLE\u3002\n\n\u96be\u9053\u53ea\u80fd\u8d2a\u5fc3\u4e86\u5417\uff1f\n\n**SLF \u4f18\u5316**\n\nSPFA \u5f88\u5bb9\u6613\u88ab\u7f51\u7edc\u56fe\u548c\u83ca\u82b1\u56fe\u5361\u6210 $O(nm)$\uff0c\u4f46\u662f\u6709\u4e00\u79cd\u4f18\u5316\u80fd\u4f7f SPFA \u8fc7\u6389\u7f51\u7edc\u56fe\u7684 Hack\uff0c\u5e76\u4e14\u5728\u5b9e\u8df5\u4e2d\u5feb\u4e0a\u5927\u7ea6 $40\\%$\uff0c\u8fd9\u5c31\u662f **Small Label First** \u4f18\u5316\u3002\n\n\u5982\u679c\u8bbe $\\operatorname{dis}(u)$ \u4e3a\u7ed3\u70b9 $u$ \u7684\u9884\u6d4b\u8ddd\u79bb\uff0c\u5177\u4f53\u662f\u8fd9\u6837\u7684\uff1a\n\n- \u6bd4\u8f83\u5c06\u8981\u5165\u961f\u7684\u7ed3\u70b9\u7ecf\u8fc7\u677e\u5f1b\u540e\u7684 dis \u503c\u4e0e\u961f\u9996\u7ed3\u70b9\u7684 dis \u503c\n\n- \u5982\u679c\u6bd4\u961f\u9996\u7ed3\u70b9\u7684 dis \u503c\u5c0f\uff0c\u5219\u8fdb\u5165\u961f\u9996\n\n- \u5426\u5219\u4e0d\u5c0f\u4e8e\u961f\u9996\u7ed3\u70b9\u7684 dis \u503c\uff0c\u5219\u8fdb\u5165\u961f\u5c3e\n\n\u8fd9\u4e2a\u4f18\u5316\u770b\u8d77\u6765\u5f88\u5fae\u5c0f\uff0c\u4f46\u53ef\u4ee5\u8ba9\u961f\u5217\u66f4\u63a5\u8fd1\u4f18\u5148\u961f\u5217\uff0c\u4ece\u800c\u5927\u5927\u51cf\u5c11\u677e\u5f1b\u6b21\u6570\u3002\n\n\u7ecf\u8fc7 SLF \u4f18\u5316\uff0c\u7ec8\u4e8e\u6709 90pts \u4e86\uff01\n\n**LLL \u4f18\u5316**\n\nLLL \u4f18\u5316\u5373 **Large Label Last** \u4f18\u5316\uff0c\u770b\u8d77\u6765\u8ddf SLF \u4f18\u5316\u6ca1\u4ec0\u4e48\u5dee\u522b\uff0c\u4f46\u5b9e\u9645\u4e0a\u914d\u5408 SLF \u4f18\u5316\u5f80\u5f80\u80fd\u4f7f SPFA \u4f18\u5316 $60\\%$\uff01\n\n\u8bbe $ave$ \u4e3a\u5f53\u524d\u961f\u5217\u4e2d\u7ed3\u70b9\u7684 $dis$ \u7684\u5e73\u5747\u503c\uff0c\u7b97\u6cd5\u6b65\u9aa4\u662f\u8fd9\u6837\u7684\uff1a\n\n- \u6bcf\u6b21\u961f\u9996\u7ed3\u70b9\u51fa\u961f\u540e\uff0c\u7ee7\u7eed\u6bd4\u8f83\u961f\u9996\u7ed3\u70b9\u7684 $dis$ \u4e0e\u961f\u5217\u5185 $ave$ \u7684\u5927\u5c0f\n\n- \u5982\u679c\u961f\u9996\u7ed3\u70b9 $dis$ \u5927\u4e8e $ave$\uff0c\u5219\u53d6\u51fa\u961f\u9996\u7ed3\u70b9\uff0c\u5e76\u5c06\u5176\u653e\u5165\u961f\u5c3e\uff0c\u5e76\u91cd\u590d\u6b65\u9aa4\u4e00\n\n- \u5426\u5219\uff0c\u961f\u9996\u7ed3\u70b9 $dis$ \u4e0d\u5927\u4e8e $ave$\uff0c\u9000\u51fa\u5faa\u73af\n\n\u7ecf\u8fc7\u4e24\u4e2a\u4f18\u5316\uff0c\u518d\u5361\u4e00\u5361\u5e38\uff0c\u5438\u4e00\u5438\u6c27\uff0c\u7f51\u7edc\u6d41\u5c31\u80fd\u8fc7\u8fd9\u9053\u6bd2\u7624\u9898\u4e86\uff01\n\nACcode\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define inf 1000000000000000\n#define V 1000100\n#define E 5000100\ntypedef long long int ll;\nstruct edge {\n\tint to, next;\n\tll capa, cost;\n};\nint cnt = 0, head[V], n, m; edge node[E];\ninline void add(register int fir,register int nxt,register ll w,register ll c) {\n\tnode[cnt].to = nxt,\n\t\tnode[cnt].capa = w,\n\t\tnode[cnt].cost = c,\n\t\tnode[cnt].next = head[fir],\n\t\thead[fir] = cnt++;\n}\nint s, t, cur[V]; deque<int>que; ll dep[V], sum = 0, cost = 0, num = 0;\nbool vis[V];\ninline bool spfa() {\n\tfor (register int i = 1; i <= t; ++i)dep[i] = inf;\n\tdep[s] = 0; que.push_back(s); int u, v;\n\twhile (!que.empty()) {\n\t\tv = que.front(); que.pop_front();\n\t\twhile (dep[v] * que.size() > num)que.pop_front(), que.push_back(v), v = que.front();\n\t\tfor (register int i = head[v]; i != -1; i = node[i].next) {\n\t\t\tu = node[i].to;\n\t\t\tif (dep[v] + node[i].cost < dep[u] && node[i].capa) {\n\t\t\t\tdep[u] = dep[v] + node[i].cost, num += dep[u];\n\t\t\t\tif (!que.empty() && dep[u] < dep[que.front()])que.push_front(u);\n\t\t\t\telse que.push_back(u);\n\t\t\t}\n\t\t}\n\t}\n\tnum = 0;\n\treturn (dep[t] != inf);\n}\nll dfs(register int v, register ll flow) {\n\tif (flow == 0 || v == t)return flow; ll used = 0, wei = 0;\n\tvis[v] = true;\n\tfor (register int i = cur[v]; i != -1; i = node[i].next) {\n\t\tcur[v] = i;\n\t\tif (!vis[node[i].to] && dep[node[i].to] == dep[v] + node[i].cost && node[i].capa) {\n\t\t\twei = dfs(node[i].to, min(flow - used, node[i].capa));\n\t\t\tif (wei) {\n\t\t\t\tnode[i].capa -= wei,\n\t\t\t\t\tnode[i ^ 1].capa += wei,\n\t\t\t\t\tused += wei,\n\t\t\t\t\tcost += node[i].cost * wei;\n\t\t\t}\n\t\t}\n\t\tif (used == flow)break;\n\t}\n\tvis[v] = false;\n\treturn used;\n}\ninline void Dinic() {\n\twhile (spfa()) {\n\t\tmemcpy(cur, head, (t + 1) * sizeof(int));\n\t\tsum += dfs(s, inf);\n\t}\n}\ninline void addE(int u, int v, ll w, ll c) {\n\tadd(u, v, w, c);\n\tadd(v, u, 0, -c);\n}\nint main() {\n\tios::sync_with_stdio(0);\n\tcin.tie(); cout.tie();\n\tmemset(head, -1, V * sizeof(int));\n\tint fast, sown; ll p, f, ss;\n\tcin >> n >> fast >> sown >> f >> ss >> p;\n\ts = 2 * n + 1, t = 2 * n + 2; ll w;\n\tfor (register int i = 1; i <= n; ++i) {\n\t\tcin >> w;\n\t\taddE(s, i, w, 0);\n\t\taddE(i + n, t, w, 0);\n\t}\n\t\n\tfor (register int i = 1; i <= n; ++i) {\n\t\taddE(s, i + n, inf, p);\n\t\tif(i + fast <= n)addE(i, i + fast + n, inf, f);\n\t\tif(i + sown <= n)addE(i, i + sown + n, inf, ss);\n\t\tif (i + 1 <= n)addE(i, i + 1, inf, 0);\n\t}\n\tDinic();\n\tcout << cost;\n\treturn 0;\n}\n```\n",
        "postTime": 1651632171,
        "uid": 551861,
        "name": "wql_cai",
        "ccfLevel": 4,
        "title": "P4480\u9898\u89e3"
    },
    {
        "content": "\u8be5\u81ea\u4e00\u4e2aAFO\u7684\u849f\u84bb\u7684\u535a\u5ba2\uff1ahttps://www.cnblogs.com/luyouqi233/p/8933397.html\n\n\u8fd9\u9053\u9898\u548c\u7f51\u7edc\u6d4124\u9898\u4e2d\u7684\u9910\u5dfe\u8ba1\u5212\u7684\u786e\u4e0d\u4e00\u6837,[BJWC2018]\u9910\u5dfe\u8ba1\u5212\u95ee\u9898\u7684\u6570\u636e\u8303\u56f4\u66f4\u5927\u3002\n\n\u4e00\u4e2a\u9910\u5385\u5728\u76f8\u7ee7\u7684n\u5929\u91cc\uff0c\u6bcf\u5929\u9700\u7528\u7684\u9910\u5dfe\u6570\u4e0d\u5c3d\u76f8\u540c\u3002\u5047\u8bbe\u7b2ci\u5929(i=1,2,...,n)\u9700\u8981ri\u5757\u9910\u5dfe\u3002\u9910\u5385\u53ef\u4ee5\u5728\u4efb\u610f\u65f6\u523b\u8d2d\u4e70\u65b0\u7684\u9910\u5dfe\uff0c\u6bcf\u5757\u9910\u5dfe\u7684\u8d39\u7528\u4e3ap\u3002\n\n\u4f7f\u7528\u8fc7\u7684\u65e7\u9910\u5dfe\uff0c\u5219\u9700\u8981\u7ecf\u8fc7\u6e05\u6d17\u624d\u80fd\u91cd\u65b0\u4f7f\u7528\u3002\u628a\u4e00\u5757\u65e7\u9910\u5dfe\u9001\u5230\u6e05\u6d17\u5e97A\uff0c\u9700\u8981\u7b49\u5f85m1\u5929\u540e\u624d\u80fd\u62ff\u5230\u65b0\u9910\u5dfe\uff0c\u5176\u8d39\u7528\u4e3ac1\uff1b\u628a\u4e00\u5757\u65e7\u9910\u5dfe\u9001\u5230\u6e05\u6d17\u5e97B\uff0c\u9700\u8981\u7b49\u5f85m2\u5929\u540e\u624d\u80fd\u62ff\u5230\u65b0\u9910\u5dfe\uff0c\u5176\u8d39\u7528\u4e3ac2\u3002\n\n\u4f8b\u5982\uff0c\u5c06\u4e00\u5757\u7b2ck\u5929\u4f7f\u7528\u8fc7\u7684\u9910\u5dfe\u9001\u5230\u6e05\u6d17\u5e97A\u6e05\u6d17\uff0c\u5219\u53ef\u4ee5\u5728\u7b2ck+m1\u5929\u4f7f\u7528\u3002\n\n\n\u5bf9\u4e8e50%\u7684\u6570\u636e\uff0c\u6211\u4eec\u6709\u4e00\u4e2a\u5f88\u7ecf\u5178\u7684\u7f51\u7edc\u6d41\u505a\u6cd5\uff1a[\u9910\u5dfe\u8ba1\u5212\u95ee\u9898](http://www.cnblogs.com/luyouqi233/p/8483640.html)\u3002\n\n\u4f46\u662f\u6570\u636e\u89c4\u6a21\u6269\u5927\u540e\u5c31\u663e\u7136\u4e0d\u80fd\u7528\u7f51\u7edc\u6d41\u6c42\u89e3\u4e86\u3002\n\n\u5206\u4e24\u79cd\u60c5\u51b5\uff1a\n\n1.\u5feb\u6d17\u5e97\u66f4\u8d35\uff1a\n\n\u8003\u8651\u5230\u5148\u4e70\u548c\u540e\u4e70\u9910\u5dfe\u6240\u5bf9\u7b54\u6848\u548c\u8fc7\u7a0b\u4e0d\u4f1a\u9020\u6210\u5f71\u54cd\uff0c\u4e14\u5f53\u4e70\u9910\u5dfec\u6761\u8fbe\u5230\u6700\u4f18\u89e3\u65f6\uff0c\u663e\u7136c+k\u7684\u82b1\u8d39\u6bd4c+k+1\u7684\u82b1\u8d39\u66f4\u5c11\u3002\n\n\u5e76\u4e14\u4e0d\u96be\u611f\u6027\u8bc1\u51fac-k\u7684\u82b1\u8d39\u6bd4c-k-1\u7684\u82b1\u8d39\u66f4\u5c11\uff08\u4f1a\u5728\u6700\u4f18\u60c5\u51b5\u4e0b\u591a\u6b21\u4f7f\u7528\u5feb\u6d17\u5e97\u7684\u9910\u5dfe\u4f7f\u5f97\u94b1\u53d8\u591a\uff09\u3002\n\n\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u4e09\u5206\u6c42\u89e3\u3002\n\n\u6700\u4fbf\u5b9c\u7684\u663e\u7136\u662f\u5148\u4f7f\u7528\u65b0\u7684\u6bdb\u5dfe\uff0c\u7b49\u5230\u6ca1\u4e86\u7684\u65f6\u5019\u4f7f\u7528\u6162\u6d17\u5e97\u7684\uff0c\u6700\u5dee\u4f7f\u7528\u5feb\u6d17\u5e97\u7684\u5f97\u51fa\u7b54\u6848\uff0c\u4f7f\u7528\u961f\u5217\u7ef4\u62a4\u4e00\u4e0b\u5373\u53ef\uff08\u867d\u7136\u8fd9\u4e48\u8bf4\uff0c\u4e5f\u662f\u633a\u6076\u5fc3\u7684\uff0c\u6211\u5bf9\u7740\u522b\u4eba\u7684\u4ee3\u7801\u8c03\u4e863h\u624d\u8fc7\uff0c\u53ef\u80fd\u73b0\u5728\u8ba9\u6211\u89e3\u91ca\u4ee3\u7801\u90fd\u89e3\u91ca\u4e0d\u660e\u767d\u3002\uff09\n\n2.\u5feb\u6d17\u70b9\u66f4\u4fbf\u5b9c\uff1a\n\n\u90a3\u5c31\u90fd\u5feb\u6d17\uff0c\u8fd9\u662f\u663e\u7136\u7684\u3002\n\n\u8fd9\u662f\u53ef\u7231\u7684\u4ee3\u7801\n```cpp\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nconst int N=200010;\nconst int INF=2147483647;\ninline int read(){\n    int X=0,w=1;char ch=0;\n    while(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n    while(ch>='0'&&ch<='9')X=(X<<1)+(X<<3)+ch-'0',ch=getchar();\n    return X*w;\n}\nint t[N],num[N],q[N],cnt,d,n1,n2,c1,c2,tc;\nint sn,sm,so,en,em,eo;\ninline void add(int x,int p){\n    q[en]=x;num[en++]=p;\n}\nint f(int k){\n    sn=sm=so=en=em=eo=0;\n    int ans=(tc-c2)*k;\n    add(-2000000,k);\n    for(int i=1;i<=d;i++){\n        int j=t[i];\n        while(sn!=en&&i-q[sn]>=n1){\n            num[em]=num[sn];\n            q[em++]=q[sn++];\n        }\n        while(sm!=em&&i-q[sm]>=n2){\n            num[eo]=num[sm];\n            q[eo++]=q[sm++];\n        }\n        while(j>0){\n            if(so!=eo){\n                if(num[eo-1]>j){\n                    ans+=c2*j;\n                    num[eo-1]-=j;\n                    break;\n                }\n                else{\n                    ans+=c2*num[eo-1];\n                    j-=num[eo-1];\n                    eo--;\n                }\n            }\n            else if(sm!=em){\n                if(num[em-1]>j){\n                    ans+=c1*j;\n                    num[em-1]-=j;\n                    break;\n                }\n                else{\n                    ans+=c1*num[em-1];\n                    j-=num[em-1];\n                    em--;\n                }\n            }\n            else return INF;\n        }\n        add(i,t[i]);\n    }\n    return ans;\n}\nint sfen(int l,int r){\n    while(233){\n        if(r-l<=2){\n            int m=INF;\n            for(int i=l;i<r;i++)m=min(m,f(i));\n            return m;\n        }\n        int mid1=l+(r-l)/3,mid2=l+2*(r-l)/3;\n        int a=f(mid1);\n        if(a!=INF&&a<=f(mid2))r=mid2;\n        else l=mid1;\n    }\n}\nint main(){\n    d=read(),n1=read(),n2=read(),c1=read(),c2=read(),tc=read();\n    if(n1>n2){swap(n1,n2);swap(c1,c2);}\n    if(c1<=c2)n2=2000001,c2=101;\n    int tsum=0;\n    for(int i=1;i<=d;i++){\n        t[i]=read();tsum+=t[i];\n    }\n    printf(\"%d\\n\",sfen(0,tsum+1));\n    return 0;\n}\n```",
        "postTime": 1547780016,
        "uid": 125109,
        "name": "\u767d\u3044\u30d0\u30e9\u306e\u591c",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4480 \u3010[BJWC2018]\u9910\u5dfe\u8ba1\u5212\u95ee\u9898\u3011"
    },
    {
        "content": "\u770b\u8fc7\u8ba8\u8bba\u7684\u5404\u4f4d\u5927\u4f6c\u5e94\u8be5\u5df2\u7ecf\u53d1\u73b0\u4e86\uff0c\u8fd9\u9053\u9898\u4e0e[P2917](https://www.luogu.org/problemnew/show/P2917)\uff0c[P1251](https://www.luogu.org/problemnew/show/P1251)\u4ec5\u5728\u6570\u636e\u8303\u56f4\u53ca\u6570\u636e\u5f3a\u5ea6\u4e0a\u7565\u6709\u4e0d\u540c\u3002\u56e0\u6b64\u672c\u6587\u4f1a\u5148\u7ed9\u51fa[P2917](https://www.luogu.org/problemnew/show/P2917)\u7684\u6807\u51c6\u89e3\u6cd5\uff0c\u518d\u5bf9\u672c\u9898\u6240\u589e\u52a0\u7684\u7279\u6b8a\u60c5\u51b5\u8fdb\u884c\u8ba8\u8bba\u3002~~\u4e09\u500d\u7ecf\u9a8c\u7f8e\u6ecb\u6ecb~~\n## P2917\n\u663e\u800c\u6613\u89c1\u7684\u662f\uff0c\u7167\u6284[P1251](https://www.luogu.org/problemnew/show/P1251)\u7684\u8d39\u7528\u6d41\u89e3\u6cd5\u4f1a\u5bfc\u81f4\u7a0b\u5e8f $TLE$\uff0c\u56e0\u6b64\u6211\u4eec\u5fc5\u987b\u5bfb\u627e\u4e00\u4e2a $O(nlogn)$ \u7684\u4f18\u79c0\u89e3\u6cd5\u89e3\u51b3\u8fd9\u9053\u9898\u3002\u6211\u4eec\u5047\u8bbe\u5728\u8fd9 $n$ \u5929\u5185\u4e00\u5171\u8d2d\u4e70\u4e86 $m$ \u5757\u65b0\u9910\u5dfe\uff0c\u800c\u6700\u4f18\u89e3\u4e00\u5171\u8d2d\u4e70\u4e86 $m_{ans}$ \u5757\u65b0\u9910\u5dfe\u3002\u82e5 $m=m_{ans}+k$\uff0c\u7531\u4e8e\u8d2d\u4e70\u65b0\u9910\u5dfe\u5fc5\u7136\u6bd4\u6d17\u65e7\u9910\u5dfe\u8d35\uff0c\u56e0\u6b64\u591a\u4e70\u5fc5\u5b9a\u4e0d\u4f18\u3002\u82e5 $m=m_{ans}-k$\uff0c\u90a3\u4e48\u5728\u7f51\u7edc\u6d41\u7684\u56fe\u4e0a\u8868\u793a\u4e70\u65b0\u9910\u5dfe\u7684\u8fb9\u5c31\u5c11\u6d41\u4e86\u4e00\u6b21\u3002\u7531\u4e8e\u5728\u7f51\u7edc\u6d41\u4e2d\u6211\u4eec\u5bfb\u627e\u7684\u662f\u6700\u77ed\u8def\uff0c\u90a3\u4e48\u5c11\u6d41\u4e00\u6761\u6700\u77ed\u8def\u4e2d\u7684\u8fb9\u4e5f\u5c31\u8bf4\u660e\u8d70\u4e86\u4e00\u6761\u8f83\u957f\u8def\uff0c\u56e0\u6b64\u5c11\u4e70\u5fc5\u5b9a\u4e0d\u4f18\u3002\u7efc\u4e0a\uff0c\u603b\u82b1\u8d39\u5173\u4e8e\u65b0\u9910\u5dfe\u8d2d\u4e70\u6570\u7684\u51fd\u6570 $f(x)$ \u5fc5\u4e3a\u5355\u5cf0\u51fd\u6570\uff0c\u6240\u4ee5\u6b64\u9898\u53ef\u7528**\u4e09\u5206**\u89e3\u51b3\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u70b9 $x_i$\uff0c\u5982\u4f55\u8ba1\u7b97 $f(x)$ \u5462\uff1f\n\n\u901a\u8fc7\u5206\u6790\u7f51\u7edc\u6d41\u89e3\u6cd5\u7684\u5efa\u56fe\u65b9\u5f0f\u53ef\u4ee5\u53d1\u73b0\uff0c\u6bcf\u5929\u7684\u5e72\u51c0\u9910\u5dfe\u6765\u6e90\u67094\u4e2a\uff1a\n\n1. \u5728\u524d\u51e0\u5929\u4e70\u4e86\u4f46\u8fd8\u6ca1\u7528\u5b8c\u7684\u5e72\u51c0\u9910\u5dfe\uff1b\n2. \u5728\u4eca\u5929\u4e70\u7684\u5e72\u51c0\u9910\u5dfe\uff1b\n3. \u5728 $t_1$ \u5929\u524d\u9001\u53bb\u6162\u6d17\u90e8\u7684\u810f\u9910\u5dfe\uff1b\n4. \u5728 $t_2$ \u5929\u524d\u9001\u53bb\u5feb\u6d17\u90e8\u7684\u810f\u9910\u5dfe\u3002\n\n\u53ef\u4ee5\u4f9d\u636e\u4ee5\u4e0a\u56db\u6761\u8fdb\u884c\u8d2a\u5fc3\uff1a\n\n1. \u82e5\u8fd8\u6709\u65b0\u9910\u5dfe\u6ca1\u7528\u5b8c\uff0c\u5219\u5148\u7528\u65b0\u9910\u5dfe\uff1b\n2. \u65b0\u9910\u5dfe\u7528\u5b8c\u540e\uff0c\u4f18\u5148\u7528\u6162\u6d17\u90e8\u9001\u6765\u7684\u9910\u5dfe\uff0c\u4e14\u4f18\u5148\u7528\u8f83\u665a\u9001\u6765\u7684\u9910\u5dfe\uff1b\n3. \u6162\u6d17\u90e8\u9001\u6765\u7684\u9910\u5dfe\u7528\u5b8c\u540e\uff0c\u7528\u5feb\u6d17\u90e8\u9001\u6765\u7684\u9910\u5dfe\uff0c\u4e14\u4f18\u5148\u7528\u8f83\u665a\u9001\u6765\u7684\u9910\u5dfe\uff1b\n4. \u82e5\u5feb\u6d17\u90e8\u9001\u6765\u7684\u9910\u5dfe\u7528\u5b8c\u540e\u4ecd\u4e0d\u6ee1\u8db3\u4eca\u65e5\u6240\u9700\uff0c\u5219\u8bf4\u660e\u6b64\u60c5\u51b5\u65e0\u89e3\u3002\n\n**Q1. \u4e3a\u4ec0\u4e48\u8981\u5148\u7528\u6162\u6d17\u90e8\u9001\u6765\u7684\u9910\u5dfe\uff1f**\n\n**A1. \u56e0\u4e3a\u82e5\u6162\u6d17\u90e8\u9001\u6765\u7684\u9910\u5dfe\u5df2\u7ecf\u6ee1\u8db3\u4e86\u4eca\u65e5\u6240\u9700\uff0c\u5c31\u6ca1\u5fc5\u8981\u7528\u5feb\u6d17\u90e8\u9001\u6765\u7684\u9910\u5dfe\u4e86\u3002**\n\n**Q2. \u4e3a\u4ec0\u4e48\u8981\u4f18\u5148\u7528\u8f83\u665a\u9001\u6765\u7684\u9910\u5dfe\uff1f**\n\n**A2. \u4e3a\u4e86\u4ee5\u540e\u51cf\u5c11\u6e05\u6d17\u8d39\u7528\uff0c\u800c\u8f83\u65e9\u9001\u6765\u7684\u9910\u5dfe\u66f4\u6709\u53ef\u80fd\u4ee5\u66f4\u4f4e\u5ec9\u7684\u4ef7\u683c\u8fdb\u884c\u6e05\u6d17\u3002\u4f8b\u5982\uff0c\u73b0\u5728\u67092\u5757\u5feb\u6d17\u90e8\u9001\u6765\u7684\u9910\u5dfe\uff0c\u4e00\u5757\u662f\u4eca\u5929\u521a\u9001\u6765\u7684\uff0c\u53e6\u4e00\u5757\u662f\u597d\u51e0\u5929\u524d\u9001\u6765\uff0c\u518d\u591a\u4e00\u5929\u5c31\u80fd\u7528\u6162\u6d17\u90e8\u6d17\u7684\uff0c\u800c\u4eca\u65e5\u8fd8\u9700\u9910\u5dfe1\u5757\u3002\u82e5\u7528\u4eca\u5929\u9001\u6765\u7684\u90a3\u5757\u9910\u5dfe\uff0c\u5230\u660e\u5929\u65f6\u53e6\u4e00\u5757\u9910\u5dfe\u5c31\u80fd\u7528\u6162\u6d17\u90e8\u6e05\u6d17\uff0c\u4ece\u800c\u51cf\u5c11\u4e86\u6e05\u6d17\u8d39\u7528\u3002**\n\n\u4f9d\u7167\u4ee5\u4e0a\u8d2a\u5fc3\u601d\u8def\uff0c\u5f00\u4e09\u4e2a\u53cc\u7aef\u961f\u5217\u5206\u522b\u5b58\u50a8\u5269\u4f59\u7684\u65b0\u9910\u5dfe\uff0c\u5feb\u6d17\u90e8\u6d17\u7684\u9910\u5dfe\u4ee5\u53ca\u6162\u6d17\u90e8\u6d17\u7684\u9910\u5dfe\u5373\u53ef\u3002\n\n## P4480\n\u5173\u4e8e\u8fd9\u9053\u9898\uff0c\u5176\u6570\u636e\u4e0d\u4ec5\u5728\u8303\u56f4\u4e0a\u6709\u6240\u589e\u5f3a\uff0c\u8fd8\u589e\u52a0\u4e86\u4e00\u79cd\u7279\u6b8a\u60c5\u51b5\u3002\u5373\uff1a\u6162\u6d17\u90e8\u7684\u4ef7\u683c\u9ad8\u4e8e\u5feb\u6d17\u90e8\u7684\u4ef7\u683c\u3002~~(\u55b5\u55b5\u55b5\uff1f\uff1f\uff1f)~~ \u9488\u5bf9\u8fd9\u79cd\u7279\u6b8a\u60c5\u51b5\u7684\u7279\u5224\u4e5f\u662f\u663e\u800c\u6613\u89c1\u7684\uff1a\u53ea\u9700\u628a\u6162\u6d17\u90e8\u7684\u65f6\u95f4\u548c\u4ef7\u683c\u90fd\u6539\u4e3a\u5feb\u6d17\u90e8\u7684\u5373\u53ef\u3002\n\n\u7136\u800c\uff0c\u6309\u7167\u4ee5\u4e0a\u89e3\u6cd5\u6784\u5efa\u7684\u4ee3\u7801\u662f\u65e0\u6cd5\u901a\u8fc7\u672c\u9898\u7684\u3002(\u540e\u4e09\u4e2a\u70b9 $TLE$ )\u539f\u56e0\u662f\u6211\u4eec\u5f00\u4e86\u4e09\u4e2a\u6781\u6162\u7684\u53cc\u7aef\u961f\u5217\uff0c\u5927\u5927\u62d6\u6162\u4e86\u7a0b\u5e8f\u901f\u5ea6\u3002\u89e3\u51b3\u65b9\u6cd5\u6709\u4e24\u4e2a\uff1a\n\n1. \u5438\u6c27\u3002\u4f17\u6240\u5468\u77e5\uff0c $O2$ \u4f18\u5316\u5bf9\u4e8e $STL$ \u7684\u5e38\u6570\u4f18\u5316\u662f\u6781\u5176\u660e\u663e\u7684\u3002\u5f00 $O2$ \u540e\u7b2c6\u4e2a\u70b9\u7684\u901f\u5ea6\u6bd4\u4e0d\u5f00 $O2$ \u5feb\u4e86\u5341\u51e0\u500d\u3002(109ms --> 8ms)\n2. \u53ea\u5f00\u4e00\u4e2a\u53cc\u7aef\u961f\u5217\uff0c\u4e14\u4e0d\u7528 $STL$\uff0c\u7eaf\u9760\u624b\u5199\u3002\u5173\u4e8e\u8fd9\u79cd\u89e3\u6cd5\uff0c\u7531\u4e8e\u6211\u5b9e\u5728\u662f\u592a\u8fc7~~\u61d2\u60f0~~\u849f\u84bb\uff0c\u56e0\u6b64\u6ca1\u6709\u7814\u7a76\u3002\u8fd8\u8bf7\u5404\u4f4d\u5927\u4f6c\u81ea\u884c\u5206\u6790\uff0c\u6784\u5efa\u4ee3\u7801\u3002\n\n\u4ee5\u4e0b\u662f\u849f\u84bb\u5199\u7684\u4e0d\u5438\u6c27\u53ea\u80fd\u62ff70\u5206\u7684\u8fa3\u9e21 $TLE$ \u4ee3\u7801\uff1a\n```\n#include<algorithm>//STL\u901a\u7528\u7b97\u6cd5\n#include<bitset>//STL\u4f4d\u96c6\u5bb9\u5668\n#include<cctype>\n#include<cmath>\n#include<complex>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<ctime>\n#include<deque>//STL\u53cc\u7aef\u961f\u5217\u5bb9\u5668\n#include<list>//STL\u7ebf\u6027\u5217\u8868\u5bb9\u5668\n#include<map>//STL\u6620\u5c04\u5bb9\u5668\n#include<iostream>\n#include<queue>//STL\u961f\u5217\u5bb9\u5668\n#include<set>//STL\u96c6\u5408\u5bb9\u5668\n#include<stack>//STL\u5806\u6808\u5bb9\u5668\n#include<utility>//STL\u901a\u7528\u6a21\u677f\u7c7b\n#include<vector>//STL\u52a8\u6001\u6570\u7ec4\u5bb9\u5668\n#define INF 0x3f3f3f3f\n#define ll long long\nusing namespace std;\ntypedef pair<int,int> pr;//first \u65e5\u671f second \u4e2a\u6570 \nint n,tot[200001],sum,pri_slw,pri_fst,pri_new,tim_slw,tim_fst;\ndeque<pr> ava_slw,ava_fst,ava_new;\nint calc(int buy)\n{\n\tint ans=pri_new*buy;\n\tava_slw.clear(),ava_fst.clear(),ava_new.clear();\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\twhile(!ava_new.empty()&&ava_new.front().first<=i-tim_fst)//\u80fd\u5feb\u6d17\u5c31\u4e0d\u65b0\u4e70 \n\t\t\tava_fst.push_back(ava_new.front()),ava_new.pop_front();\n\t\twhile(!ava_fst.empty()&&ava_fst.front().first<=i-tim_slw)//\u80fd\u6162\u6d17\u5c31\u4e0d\u5feb\u6d17 \n\t\t\tava_slw.push_back(ava_fst.front()),ava_fst.pop_front();\n\t\tint need=tot[i],mn=min(need,buy);need-=mn,buy-=mn;\n\t\twhile(need&&!ava_slw.empty())//\u80fd\u7528\u6162\u6d17\u5c31\u7528\u6162\u6d17 \n\t\t{\n\t\t\tint tmp=min(need,ava_slw.back().second);//\u4f18\u5148\u7528\u65f6\u95f4\u6700\u9760\u540e\u7684 \n\t\t\tans+=tmp*pri_slw,need-=tmp;\n\t\t\tif(tmp==ava_slw.back().second) ava_slw.pop_back();\n\t\t\telse ava_slw.back().second-=tmp;\n\t\t}\n\t\twhile(need&&!ava_fst.empty())//\u5b9e\u5728\u4e0d\u884c\u518d\u7528\u5feb\u6d17 \n\t\t{\n\t\t\tint tmp=min(need,ava_fst.back().second);//\u4f18\u5148\u7528\u65f6\u95f4\u6700\u9760\u540e\u7684 \n\t\t\tans+=tmp*pri_fst,need-=tmp;\n\t\t\tif(tmp==ava_fst.back().second) ava_fst.pop_back();\n\t\t\telse ava_fst.back().second-=tmp;\n\t\t}\n\t\tif(need) return INF;\n\t\tava_new.push_back(make_pair(i,tot[i]));\n\t}\n\treturn ans;\n}\nint main()\n{\n\tscanf(\"%d%d%d%d%d%d\",&n,&tim_fst,&tim_slw,&pri_fst,&pri_slw,&pri_new);\n\tif(tim_slw<tim_fst) swap(tim_slw,tim_fst),swap(pri_slw,pri_fst);\n\tif(pri_slw>pri_fst) pri_slw=pri_fst,tim_slw=tim_fst;\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&tot[i]),sum+=tot[i];\n\tint l=0,r=sum;\n\twhile(r-l>2)\n\t{\n\t\tint midl=(l*2+r)/3,midr=(l+r*2+2)/3;\n\t\tint pril=calc(midl),prir=calc(midr);\n\t\t(pril>=prir? l=midl:r=midr);\n\t}\n\tint ans=INF;\n\tfor(int i=l;i<=r;i++) ans=min(ans,calc(i));\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1539610852,
        "uid": 52186,
        "name": "radish\u5e03\u56e3",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4480 \u3010[BJWC2018]\u9910\u5dfe\u8ba1\u5212\u95ee\u9898\u3011"
    },
    {
        "content": "~~\u5237\u4e86n\u6b21\u7528\u4e86\u5947\u6deb\u6280\u5de7\u624d\u62ff\u5230rk1\uff0c\u4ea5~~\n\n\u8fd9\u9053\u9898\u662f\u7f51\u7edc\u6d41\u4e8c\u5341\u56db\u9898\u4e2d\u300c\u9910\u5dfe\u8ba1\u5212\u95ee\u9898\u300d\u7684\u52a0\u5f3a\u7248\u3002\n\n\u4e8e\u662f\u6000\u7740\u8bd5\u4e00\u8bd5\u7684\u5fc3\u60c5\u7528\u8d39\u7528\u6d41\u4ea4\u4e86\u4e00\u53d1\uff1a\n\n\u54c7\u585e\uff0c\u8fc7\u4e869\u4e2a\u70b9\uff01\uff08~~\u5f3a\u70c8\u8c34\u8d23\u51fa\u9898\u4eba\u7528*\u9020\u6570\u636e~~\n\n\u4e0b\u9762\u662f\u8d39\u7528\u6d41\u89e3\u6cd5\u7b80\u8ff0\uff1a\n\n\u90a3\u4e48\u6211\u4eec\u628a\u6bcf\u4e00\u5929\u62c6\u4e3a\u65e9\u4e0a\u548c\u665a\u4e0a\u4e24\u4e2a\u70b9\uff0c\u8bbe\u4e3a $day_i,night_i$ \u3002\n\n\u9996\u5148\u53ef\u4ee5\u4eba\u4e3a\u5730\u89c4\u5b9a\u4e00\u70b9\uff1a\u5bf9\u4e00\u5757\u9910\u5dfe\uff0c\u6211\u4eec\u8981\u4e48\u5728\u5176\u810f\u4e86\u4e4b\u540e\u7acb\u5373\u9001\u6d17\uff0c\u8981\u4e48\u4e70\u4e00\u5757\u65b0\u5e72\u51c0\u9910\u5dfe\u6765\u4ee3\u66ff\u5b83\u3002\n\n\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u64cd\u4f5c\uff0c\u6211\u4eec\u53ef\u4ee5\u5982\u4e0b\u8fde\u8fb9\uff1a\n\n\u5bf9\u4e8e\u4e70\u65b0\u5e72\u51c0\u9910\u5dfe\uff1a\u6211\u4eec\u53ef\u4ee5\u89c6\u4f5c\u4ece\u6e90\u70b9\u4e70\u9910\u5dfe\uff0c\u4ece $s$ \u5411 $day_i$ \u8fde\u8fb9\u5373\u53ef\n\n\u5bf9\u4e8e\u9001\u6162\u6d17\u90e8\uff1a\u4ece $night_i$ \u5411 $day_{i+n}$ \u8fde\u8fb9\uff0c\u6d41\u91cf\u4e3a $inf$ ,\u8d39\u7528\u4e3a $f$\u3002\n\n\u5bf9\u4e8e\u9001\u5feb\u6d17\u90e8\uff1a\u4ece $night_i$ \u5411 $day_{i+m}$ \u8fde\u8fb9\uff0c\u6d41\u91cf\u4e3a $inf$ ,\u8d39\u7528\u4e3a $s$\u3002 \n\n\u4f46\u662f\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u53ef\u80fd\u5b58\u5728\u67d0\u4e00\u5929\u7684\u5e72\u51c0\u9910\u5dfe\u5197\u4f59\u3002\n\n\u4e8e\u662f\u6211\u4eec\u8981\u4ece $day_i$ \u5411 $day_{i+1}$ \u8fde\u4e00\u6761\u8d39\u7528\u4e3a\u96f6\uff0c\u6d41\u91cf\u4e3a $inf$ \u7684\u5355\u5411\u8fb9\u3002\n\n\u5982\u4f55\u4fdd\u8bc1\u6bcf\u5929\u521a\u597d\u53ea\u7528 $r_i$ \u5757\u9910\u5dfe\uff1f\n\n\u5c06\u5176\u62c6\u6210\u4e24\u4e2a\u677f\u5757\uff1a\n\n\u4ece $day_i$ \u5411 $t$ \u8fde\u8fb9\uff0c\u6d41\u91cf\u4e3a $r_i$\uff0c\u8d39\u7528\u4e3a $0$\u3002\n\n\u4ece $s$ \u5411 $night_i$ \u8fde\u8fb9\uff0c\u6d41\u91cf\u4e3a $r_i$\uff0c\u8d39\u7528\u4e3a $0$\u3002\n\n------\n\n\u4f18\u5316\u65e0\u679c\uff0c\u4e8e\u662f\u731c\u60f3\u53ef\u4ee5\u4e0d\u7528\u8d39\u7528\u6d41\u3002\n\n\u9996\u5148\u65e0\u8bba\u9910\u5dfe\u662f\u6700\u5f00\u59cb\u4e00\u8d77\u4e70\u8fd8\u662f\u9700\u8981\u7528\u65f6\u518d\u4e70\uff0c\u4e0d\u4f1a\u5f71\u54cd\u6700\u7ec8\u7684\u7b54\u6848\u3002\n\n\u90a3\u4e48\u5982\u679c\u6211\u4eec\u5df2\u7ecf\u786e\u5b9a\u4e86\u8981\u4e70\u7684\u65b0\u9910\u5dfe\u7684\u5f20\u6570\uff0c\u90a3\u4e48\u662f\u5426\u53ef\u4ee5\u786e\u5b9a\u4e00\u79cd\u552f\u4e00\u7684\u65b9\u6848\u4f7f\u5f97\u603b\u82b1\u8d39\u6700\u5c0f\u5462\uff1f\n\n\u4e0d\u96be\u5f97\u5230\u6709\u8fd9\u6837\u4e00\u79cd\u8d2a\u5fc3\u7b56\u7565\uff1a\n\n\u5728\u80fd\u591f\u7528\u65b0\u9910\u5dfe\u7684\u65f6\u5019\uff0c\u5c3d\u91cf\u4f7f\u7528\u65b0\u9910\u5dfe\u3002\n\n\u8bbe $m$ \u4e3a\u6162\u6d17\u7684\u5929\u6570\u3002\n\n\u5982\u679c\u65e0\u65b0\u9910\u5dfe\u53ef\u7528\uff0c\u5219\u5012\u56de\u5230 $m$ \u5929\u524d\uff0c\u627e\u7528\u8fc7\u7684\u65e7\u9910\u5dfe\u8fdb\u884c\u6162\u6d17\u3002\n\n\u5982\u679c\u6ca1\u6709 $m$  \u5929\u4ee5\u524d\u7684\u65e7\u9910\u5dfe\u53ef\u7528\uff0c\u5219**\u7531\u65f6\u95f4\u7ebf\u4ece\u8fd1\u5230\u8fdc**\u5730\u627e\u65e7\u9910\u5dfe\u8fdb\u884c\u5feb\u6d17\u3002\n\n\u8fd9\u6837\u505a\u4f7f\u5f97\u65f6\u95f4\u7ebf\u8f83\u8fdc\u7684\u65e7\u9910\u5dfe\u66f4\u6709\u53ef\u80fd\u6162\u6d17\u3002\n\n\u5982\u679c\u6162\u6d17\u6bd4\u5feb\u6d17\u8d35\uff0c\u90a3\u4e48\u76f4\u63a5\u5c06\u6162\u6d17\u7684\u65f6\u95f4\u548c\u4ef7\u683c\u90fd\u6539\u4e3a\u5feb\u6d17\u7684\u65f6\u95f4\u548c\u4ef7\u683c\u5373\u53ef\u3002\n\n\u6734\u7d20\u4ee3\u7801\u65e0O2\u53ea\u80fd\u8fc7\u638970\u5206\u3002\n\n\u4e8e\u662f\u6211\u6000\u7591\u5355\u6b21\u5224\u65ad\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u8fc7\u9ad8\u3002\u6709\u7684\u9898\u89e3\u91cc\u8bf4\u662f $O(n)$ \u7684\uff0c\u4f46\u6211\u6b7b\u6d3b\u6ca1\u770b\u51fa\u6765\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u4f18\u5316\u5e38\u6570\u3002\n\n\u6ce8\u610f\u5230\u5728\u5982\u679c\u5728\u7b2c $i$ \u5929\u9700\u8981\u6162\u6d17\uff0c\u6240\u6709\u5728\u7b2c $i-m$ \u5929\u524d\u7684\u65e7\u9910\u5dfe\u5bf9\u4e8e\u6211\u4eec\u6765\u8bf4\u662f\u7b49\u6548\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u663e\u7136\u6ca1\u6709\u529e\u6cd5\u5c06\u5176\u62ff\u53bb\u5feb\u6d17\u3002\n\n\u6240\u4ee5\u6211\u4eec\u6bcf\u6b21\u5c06\u7b2c $i-m$ \u5929\u524d\u7684\u65e7\u9910\u5dfe\u5168\u90e8\u7d2f\u52a0\u81f3\u7b2c $i-m$ \u5929\u5373\u53ef\u3002\u8fd9\u6837\u53ef\u4ee5\u4f18\u5316\u4e00\u5b9a\u7684\u5e38\u6570\u3002\n\n\u8fd9\u6837\u53ef\u4ee5\u4fdd\u8bc1\u5728\u8ba1\u7b97\u6162\u6d17\u7684\u65f6\u5019\u4e00\u5b9a\u662f\u7ebf\u6027\u7684\uff0c\u4f46\u4ecd\u7136\u4e0d\u80fd\u4fdd\u8bc1\u8ba1\u7b97\u5feb\u6d17\u90e8\u5206\u65f6\u4e3a\u7ebf\u6027\u3002\n\n\u6700\u540e\u6211\u4eec\u9700\u8981\u786e\u5b9a\u6700\u4f18\u89e3\u65f6\u9700\u8d2d\u4e70\u9910\u5dfe\u7684\u5f20\u6570 $c$\u3002\n\n\u8bbe\u6700\u4f18\u89e3\u65f6\u6700\u5c0f\u4ee3\u4ef7\u4e3a $f(c)$,\u8bbe\u5f53\u524d\u679a\u4e3e\u5230\u4e86 $x$\u3002\n\n\u5219\u5f53 $x \\ge c $,\u4e00\u5b9a\u6709 $f(x) \\ge f(c)$\uff0c\u56e0\u4e3a\u4f60\u8fd8\u9700\u8981\u591a\u51fa\u94b1\u4e70\u65b0\u9910\u5dfe\u3002\n\n\u5f53 $x \\le c$\uff0c\u5219\u8981\u4e48\u4e0d\u5b58\u5728 $f(x)$ \uff0c\u5373\u8d2d\u4e70 $x$ \u5f20\u9910\u5dfe\u4e0d\u80fd\u8fbe\u5230\u76ee\u7684\uff0c\u8981\u4e48\u6b64\u65f6\u591a\u6d17\u4e00\u5f20\u9910\u5dfe\u4e00\u5b9a\u52a3\u4e8e\u591a\u4e70\u4e00\u5f20\u9910\u5dfe\uff0c\u4e5f\u6709 $f(x) \\ge f(c)$\u3002\n\n\u6240\u4ee5\u5bf9\u4e8e\u6700\u4f18\u89e3 $c$ \u6211\u4eec\u53ef\u4ee5\u4e09\u5206\u6c42\u89e3\u3002\n\n\u4e2a\u4eba\u8ba4\u4e3a\u4ee3\u7801\u53ef\u8bfb\u6027\u8fd8\u662f\u633a\u9ad8\u7684\uff0c\u53ef\u4ee5\u5eb7\u5eb7\u4ee3\u7801\uff1a\n\n```cpp\n/*---Author:HenryHuang---*/\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll maxn=5e5+5;\nconst ll inf=1ll<<50;\nll sumr=0;\nll r[maxn],res[maxn];\nll n,m1,m2,c1,c2,p;\nll f(ll num){\n\tll ans=1ll*num*p;//\u63d0\u524d\u7b97\u597d\u65b0\u9910\u5dfe\u4ee3\u4ef7 \n\tll now=0;\n\tfor(ll i=1;i<=n;++i){\n\t\tres[i]=0;\n\t\tif(r[i]){\n\t\t\tll tmp=r[i];\n\t\t\tif(num){\n\t\t\t\tll k=min(tmp,num);\n\t\t\t\ttmp-=k,res[i]+=k,num-=k;\n\t\t\t\tif(!tmp) continue;\n\t\t\t}//\u76f4\u63a5\u7528\u65b0\u7684 \n\t\t\tfor(ll j=now;j<i-m2;++j){\n\t\t\t\tres[j+1]+=res[j],res[j]=0;\n\t\t\t}//\u7d2f\u52a0\u65e7\u6d17\u9910\u5dfe \n\t\t\tnow=max(now,i-m2);\n\t\t\tif(now<i&&res[now]){\n\t\t\t\tll k=min(tmp,res[now]);\n\t\t\t\tres[now]-=k,res[i]+=k;\n\t\t\t\ttmp-=k,ans+=1ll*k*c2;\n\t\t\t\tif(!tmp) continue;\n\t\t\t}//\u6162\u6d17 \n\t\t\tfor(ll j=i-m1;j>=1&&j>i-m2;--j){\n\t\t\t\tif(res[j]){\n\t\t\t\t\tll k=min(tmp,res[j]);\n\t\t\t\t\tres[j]-=k,res[i]+=k;\n\t\t\t\t\ttmp-=k,ans+=1ll*k*c1;\n\t\t\t\t}\n\t\t\t\tif(!tmp) break;\n\t\t\t}//\u5feb\u6d17 \n\t\t\tif(tmp) return inf;\n\t\t}\n\t}\n\treturn ans;\n}\nint main(){\n\tios::sync_with_stdio(0);\n\tcin.tie(0),cout.tie(0);\n\tcin>>n>>m1>>m2>>c1>>c2>>p;\n\tif(m1>m2) swap(m1,m2),swap(c1,c2);//1\u5feb2\u6162\n\tif(c1<c2) c2=c1,m2=m1; \n\tfor(ll i=1;i<=n;++i)\n\t\tcin>>r[i],sumr+=r[i];\n\tll l=1,r=max(10000ll,sumr/3);//\u5947\u6deb\u6280\u5de7 \n\tll ans=inf;\n\twhile(r-l>2){\n\t\tll k=(r-l)/3;\n\t\tll mid1=l+k,mid2=r-k;\n\t\tll aa=f(mid1),bb=f(mid2);\n\t\tif(aa<bb) ans=min(ans,aa),r=mid2;\n\t\telse ans=min(ans,bb),l=mid1;\n\t}\n\tfor(ll i=l;i<=r;++i) ans=min(ans,f(i));\n\tcout<<ans<<'\\n';\n\treturn 0;\n}\n```\n\n",
        "postTime": 1576639558,
        "uid": 43957,
        "name": "HenryHuang",
        "ccfLevel": 9,
        "title": "P4480 \u300cBJWC2018\u300d\u300c\u7f51\u7edc\u6d41\u4e0e\u7ebf\u6027\u89c4\u521224\u9898\u300d\u9910\u5dfe\u8ba1\u5212\u95ee\u9898"
    }
]
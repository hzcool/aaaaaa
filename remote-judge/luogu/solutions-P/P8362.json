[
    {
        "content": "#### \u9898\u89e3\n\n\u8003\u8651\u5982\u4f55\u7edf\u8ba1\u7b54\u6848\uff0c\u4ece $a_1 \\sim a_k$ \u51fa\u53d1\u663e\u7136\u662f\u96be\u4ee5\u540c\u65f6\u5904\u7406\u7684\uff0c\u56e0\u6b64\u53ea\u80fd\u4ece $S=\\sum_{i=1}^k$ \u5f00\u59cb\u5904\u7406\u3002\u5728 $S$ \u786e\u5b9a\u540e\uff0c\u65b9\u6848\u6570\u4e0d\u96be\u901a\u8fc7\u5bb9\u65a5 + \u9694\u677f\u6cd5\u6c42\u51fa\uff0c\u5373\u4e3a $\\sum_{i=0}^k (-1)^i \\binom{k}{i}\\binom{S-k(L-1)-i(R-L+1)-1}{k-1}$\u3002\n\n\u8003\u8651\u5982\u4f55\u8ba1\u7b97\u7ec4\u5408\u6570\uff0c\u4e0d\u96be\u53d1\u73b0\u7ec4\u5408\u6570\u662f\u5173\u4e8e $S$ \u7684 $k-1$ \u6b21\u591a\u9879\u5f0f\uff0c\u56e0\u6b64\u53ef\u4ee5\u76f4\u63a5\u7528\u6570\u4f4d dp \u8ba1\u7b97 $S$ \u7684\u82e5\u5e72\u6b21\u65b9\u548c\uff1a\u8bbe $f_{i,j,0/1,r}$ \u8868\u793a\u524d $i$ \u4f4d\uff0c\u6700\u540e\u4e00\u4f4d\u4e3a $j$\uff0c$S$ \u662f\u5426\u8fbe\u5230\u4e0a\u754c\u7684 $S^r$ \u4e4b\u548c\uff0c\u8f6c\u79fb\u4e0d\u96be\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\u63a8\u51fa\u3002\u7edf\u8ba1\u7b54\u6848\u53ef\u4ee5\u7528\u65af\u7279\u6797\u6570\u8ba1\u7b97\u51fa\u4e0b\u964d\u5e42\u7684\u5c55\u5f00\u7cfb\u6570\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(k^3B^2 \\log_B R)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $O(kB\\log_B R)$\uff0c\u5176\u4e2d $B=10$\u3002\n\n\u5982\u679c\u91c7\u7528\u524d\u7f00\u548c\u4f18\u5316\u6216\u6539\u4e3a\u8bb0\u5f55 $S$ \u7684\u4e0b\u964d\u5e42\u4e4b\u548c\u53ef\u4ee5\u505a\u7684\u66f4\u4f18\u3002\n\n#### \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nconst int mod = 998244353;\nstruct Int\n{\n\tint a[1010];\n\tinline int & operator [] (int x) {return a[x];}\n\tinline bool friend operator < (Int a, Int b) {for (int i = 1002; ~i; i--) if (a[i] != b[i]) return a[i] < b[i]; return false;}\n\tinline Int friend operator + (Int a, int b) {a[0] += b; for (int i = 0; i <= 1002; i++) a[i + 1] += a[i] > 9, a[i] -= 10 * (a[i] > 9); return a;}\n\tinline Int friend operator + (Int a, Int b) {for (int i = 0; i <= 1002; i++) a[i] += b[i], a[i + 1] += a[i] > 9, a[i] -= 10 * (a[i] > 9); return a;}\n\tinline Int friend operator - (Int a, Int b) {for (int i = 0; i <= 1002; i++) a[i] -= b[i], a[i + 1] -= a[i] < 0, a[i] += 10 * (a[i] < 0); return a;}\n\tinline Int friend operator * (Int a, int b) {a[0] *= b; for (int i = 1; i <= 1002; i++) a[i] = a[i] * b + a[i - 1] / 10, a[i - 1] %= 10; return a;}\n\tinline int friend operator % (Int a, int p) {int res = 0; for (int i = 1002; ~i; i--) res = (10LL * res + a[i]) % p; return res;}\n\tinline void read (void) {std::string s; std::cin >> s; for (int i = 0; i < (int)s.length(); i++) a[s.length() - i - 1] = s[i] ^ 48;}\n} L, R, Q[2];\nint k, wl, wr, sgn[2], inv[60], P[12][60], C[60][60], S[60][60], tr[60][60][10], Pow[60], f[1010][10][2][60], g[60], h[60], ans;\ninline void dp (int *g, Int Q)\n{\n\tfor (int j = 1002, p = 1; j >= 1; j--) f[j][9][p &= (Q[j] == 0)][0] = 1;\n\tfor (int j = 1001; j >= 0; j--) for (int x = 0; x <= 9; x++)\n\t\tfor (int p = 0; p < 2; p++) for (int t = 0; t < k; t++) if (f[j + 1][x][p][t])\n\t\t\tfor (int y = 0; y <= x and y <= (p ? Q[j] : 9); y++)\n\t\t\t\tfor (int r = t, q = p & (y == Q[j]); r < k; r++) f[j][y][q][r] = (f[j][y][q][r] + 1LL * tr[r][t][y] * f[j + 1][x][p][t]) % mod;\n\tfor (int x = 0; x <= 9; x++) for (int p = 0; p < 2; p++) for (int r = 0; r < k; r++) g[r] = (g[r] + f[0][x][p][r]) % mod;\n\tfor (int j = 1002; ~j; j--) for (int x = 0; x <= 9; x++) for (int p = 0; p < 2; p++) for (int r = 0; r < k; r++) f[j][x][p][r] = 0;\n}\nsigned main ()\n{\n\tL.read(); R.read(); std::cin >> k; wl = L % mod; wr = R % mod;\n\tinv[0] = inv[1] = sgn[0] = 1; sgn[1] = mod - 1;\n\tfor (int i = 2; i <= k; i++) inv[i] = 1LL * (mod - mod / i) * inv[mod % i] % mod;\n\tfor (int i = 3; i <= k; i++) inv[i] = 1LL * inv[i - 1] * inv[i] % mod;\n\tfor (int i = 0; i <= 10; i++) for (int j = P[i][0] = 1; j <= k; j++) P[i][j] = 1LL * P[i][j - 1] * i % mod;\n\tfor (int i = 0; i <= k; i++) for (int j = C[i][0] = 1; j <= i; j++) C[i][j] = (C[i - 1][j] + C[i - 1][j - 1]) % mod;\n\tfor (int i = S[0][0] = 1; i <= k; i++) for (int j = 1; j <= i; j++) S[i][j] = (S[i - 1][j - 1] + 1LL * (i - 1) * S[i - 1][j]) % mod;\n\tfor (int i = 0; i < k; i++) for (int j = 0; j <= i; j++) for (int k = 0; k <= 9; k++) tr[i][j][k] = 1LL * C[i][j] * P[10][j] % mod * P[k][i - j] % mod;\n\tQ[0] = L * k + (-1); Q[1] = R * k; R = R - L + 1; dp(h, Q[1]);\n\tfor (int i = 0; i <= k and Q[0] < Q[1]; i++, Q[0] = Q[0] + R)\n\t{\n\t\tdp(g, Q[0]); for (int j = 0; j < k; j++) g[j] = (h[j] - g[j] + mod) % mod;\n\t\tint w = 1LL * sgn[i & 1] * C[k][i] % mod * inv[k - 1] % mod;\n\t\tPow[0] = 1; Pow[1] = (mod - (1LL * k * (wl - 1) + 1LL * i * (wr - wl + 1) + 1) % mod) % mod;\n\t\tfor (int j = 2; j < k; j++) Pow[j] = 1LL * Pow[j - 1] * Pow[1] % mod;\n\t\tfor (int j = k - 1; j >= 0; j--) for (int r = 0; r < j; r++) g[j] = (g[j] + 1LL * C[j][r] * g[r] % mod * Pow[j - r]) % mod;\n\t\tfor (int j = 0; j < k; j++) ans = (ans + 1LL * w * sgn[(k - 1 - j) & 1] % mod * S[k - 1][j] % mod * g[j]) % mod, g[j] = 0;\n\t}\n\treturn !printf(\"%d\\n\", ans);\n}\n```",
        "postTime": 1661748600,
        "uid": 46197,
        "name": "_RSY_",
        "ccfLevel": 10,
        "title": "\u3010\u9898\u89e3\u3011P8362"
    },
    {
        "content": "\u770b\u5230\u8fd8\u6ca1\u6709\u9898\u89e3\uff0c\u8d76\u7d27\u5077\u8dd1\u4e00\u7bc7\u3002\n\nyysy\uff0c\u770b\u5230\u51fa\u9898\u4eba\u5728\u77e5\u4e4e\u5410\u69fd\u8003\u573a\u4e0a\u6ca1\u6709\u4ec0\u4e48\u4eba\u5c1d\u8bd5\u8fd9\u9053\u9898\uff0c\u5c31\u6765\u770b\u4e86\u4e00\u773c\u3002\u4f46\u662f\u6211\u505a\u5b8c\u4e4b\u540e\uff0c\u4e5f\u786e\u5b9e\u611f\u89c9\uff0c\u5982\u679c\u6211\u5728\u8003\u573a\u4e0a\u4e5f\u4e0d\u4f1a\u53bb\u5c1d\u8bd5\u5199\u8fd9\u9053\u9898\uff0c\u56e0\u4e3a\u771f\u7684\u592a\u96be\u5199\u4e86!!!!!!\n\n\u4f46\u662f\u603b\u4f53\u6765\u8bf4\u4f5c\u4e3a\u4e00\u9053\u7701\u9009\u7684\u538b\u8f74\u9898\uff0c\u4ee3\u7801\u96be\u4e00\u70b9\u4e5f\u65e0\u53ef\u539a\u975e\u3002\n\n\u601d\u8def\u4e0a\u6765\u8bf4\uff0c\u611f\u89c9\u6ca1\u4eba\u7279\u522b\u96be\u60f3\u7684\u5730\u65b9\uff0c\u4f5c\u4e3a\u7701\u961f\u6c34\u5e73\u9009\u624b\u5927\u6982 $10$ \u5230 $20$ \u5206\u949f\u5e94\u8be5\u5c31\u80fd\u60f3\u5230\u5927\u81f4\u601d\u8def\u3002\n\n### \u89e3\u9898\u601d\u8def\n\n\u9996\u5148\u6211\u4eec\u5148\u770b\u770b\u5982\u679c\u786e\u5b9a\u4e86 $\\sum{a_i}=S$ \u662f\u4ec0\u4e48\uff0c\u600e\u4e48\u8ba1\u7b97\u7b54\u6848\u3002\n\n\u4f17\u6240\u5468\u77e5\uff0c\u5982\u679c\u628a\u9650\u5236\u6539\u6210 $a_i \\in [L,+\\infty)$ \u7684\u505a\u6cd5\u662f\u76f4\u63a5\u4f7f\u7528\u9694\u677f\u6cd5\uff0c\u7b54\u6848\u4e3a ${S-k(L-1)-1}\\choose{k-1}$\u3002\n\n\u4f46\u662f\u73b0\u5728\u9650\u5236\u662f $a_i \\in [L,R]$\uff0c\u76f4\u63a5\u505a\u663e\u7136\u662f\u4e0d\u597d\u505a\u7684\u3002\u90a3\u6211\u4eec\u8003\u8651\u5bb9\u65a5\u3002\u679a\u4e3e\u6709\u591a\u5c11 $a_i$ \u7a81\u7834\u4e86 $R$ \u7684\u9650\u5236\uff0c\u6b64\u65f6\u7b54\u6848\u4e3a\uff1a\n\n$$\n\\sum_{i=0}^{k}{(-1)^i{{k}\\choose{i}}{{S-k(l-1)-i(R-L+1)-1}\\choose{k-1}}}\n$$\n\n\u65e2\u7136\u6709\u4e86\u8fd9\u79cd\u505a\u6cd5\uff0c\u6211\u4eec\u7684\u601d\u8def\u5c31\u53ef\u4ee5\u8f6c\u53d8\u4e3a\u679a\u4e3e $i$\uff0c\u7528\u6570\u4f4d `dp` \u8ba1\u7b97 ${{S-k(l-1)-i(R-L+1)-1}\\choose{k-1}}$ \u7684\u548c\u3002\n\n\u8fd9\u4e2a\u4e1c\u897f\u663e\u7136\u4e5f\u662f\u4e0d\u597d\u7b97\u7684\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u5c06 $S-k(l-1)-i(R-L+1)-1$ \u8bbe\u4e3a $x$\u3002\u6211\u4eec\u77e5\u9053\u7684\u662f $x \\choose k-1$ \u53ef\u4ee5\u5199\u6210 $\\sum_{i=0}^{k-1}{a_ix^i}$ \u7684\u5f62\u5f0f\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u8ba1\u7b97\u51fa\u6240\u6709 $x$ \u7684\u6240\u6709 $k$ \u6b21\u5e42\u548c\u5373\u53ef\u6c42\u5f97\u7b54\u6848\u3002\u8003\u8651\u5230 $k$ \u6b21\u5e42\u548c\u4e4b\u95f4\u7684\u9012\u63a8\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\uff0c\u6240\u4ee5\u6211\u4eec\u7684\u6570\u4f4d `dp` \u53ef\u4ee5\u76f4\u63a5\u8bb0\u5f55\uff0c\u8003\u8651\u5230\u7b2c\u51e0\u4f4d\uff0c\u662f\u5426\u9700\u8981\u501f\u4f4d\uff0c\u4e0a\u4e00\u4e2a\u586b\u7684\u6570\u662f\u4ec0\u4e48\uff0c\u5f53\u524d\u7ef4\u62a4\u7684\u662f\u51e0\u6b21\u5e42\u548c\u3002\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5927\u6982\u662f $O(10k^3|R|)$\uff0c\u611f\u89c9\u5f88\u5361\uff0c\u4f46\u662f\u5b9e\u6d4b\u662f\u53ef\u8fc7\u7684\u3002\uff08\u5176\u5b9e\u662f\u6211\u672c\u5730\u6ca1\u8dd1\u8fc7\u611f\u89c9\u975e\u5e38\u614c\uff0c\u4f46\u662f\u4ea4\u4e0a\u53bb\u5c31\u8fc7\u4e86\uff09\n\n\u4e0b\u9762\u662f\u4ee3\u7801\u3002QwQ\n\n```cpp\n#include <stdio.h>\n#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int N = 1110, M = 1010;\nconst int P = 998244353;\nchar s[N];\n\ninline int add(int x, int y) {return x + y >= P ? x + y - P : x + y;}\ninline int sub(int x, int y) {return x < y ? x - y + P : x - y;}\ninline int mul(int x, int y) {return 1ll * x * y % P;}\ninline void upd(int &x, int y) {x = add(x, y);}\ninline int Pow(int x, int y) {int r = 1; for (; y; y >>= 1, x = mul(x, x)) if (y & 1) r = mul(r, x); return r;}\n\nstruct BigInt {\n\tint a[N], len;\n\tBigInt() {\n\t\tlen = 0;\n\t\tmemset(a, 0, sizeof a);\n\t}\n\tvoid input() {\n\t\tscanf(\"%s\", &s);\n\t\tlen = strlen(s);\n\t\tfor (int i = 0; i < len; i++)\n\t\t\ta[i] = s[len - i - 1] - '0';\n\t}\n};\n\nBigInt operator + (BigInt x, BigInt y) {\n\tBigInt ret; ret.len = max(x.len, y.len);\n\tfor (int i = 0; i < ret.len; i++)\n\t\tret.a[i] = x.a[i] + y.a[i];\n\tfor (int i = 0; i < ret.len; i++)\n\t\tif (ret.a[i] > 9) ret.a[i] -= 10, ret.a[i + 1]++;\n\twhile (ret.a[ret.len]) ret.len++;\n\treturn ret;\n}\n\nBigInt operator - (BigInt x, BigInt y) {\n\tBigInt ret; ret.len = x.len;\n\tfor (int i = 0; i < ret.len; i++)\n\t\tret.a[i] = x.a[i] - y.a[i];\n\tfor (int i = 0; i < ret.len; i++)\n\t\tif (ret.a[i] < 0) ret.a[i] += 10, ret.a[i + 1]--;\n\twhile (ret.len && !ret.a[ret.len - 1]) ret.len--;\n\treturn ret;\n}\n\nBigInt L, R, AL;\nint K, C[52][52], ans, dp[N][10][2][52], sdp[N][10][2][52], pw[10][52], pw10[N * 52], coe[52];\n\nint main() {\n\tL.input(), R.input(), scanf(\"%d\", &K);\n\tL.a[0]--;\n\tfor (int i = 0; ; i++) {\n\t\tif (L.a[i] < 0) L.a[i] += 10, L.a[i + 1]--;\n\t\telse break;\n\t}\n\twhile (L.len && !L.a[L.len - 1]) L.len--;\n\tR = R - L; AL.len = 1, AL.a[0] = 1;\n\tfor (int i = 1; i <= K; i++) AL = AL + L;\n\tfor (int i = 0; i <= K; i++) {\n\t\tC[i][0] = C[i][i] = 1;\n\t\tfor (int j = 1; j < i; j++)\n\t\t\tC[i][j] = add(C[i - 1][j - 1], C[i - 1][j]);\n\t}\n\tfor (int i = 0; i < 10; i++) {\n\t\tpw[i][0] = 1;\n\t\tfor (int j = 1; j <= K; j++)\n\t\t\tpw[i][j] = mul(pw[i][j - 1], i);\n\t}\n\tpw10[0] = 1;\n\tfor (int i = 1; i < N * 52; i++)\n\t\tpw10[i] = mul(pw10[i - 1], 10);\n\tcoe[1] = 1;\n\tfor (int i = 1; i < K - 1; i++) {\n\t\tfor (int j = K; j > 0; j--)\n\t\t\tcoe[j] = coe[j - 1];\n\t\tcoe[0] = 0;\n\t\tfor (int j = 0; j < K; j++)\n\t\t\tcoe[j] = sub(coe[j], mul(i, coe[j + 1]));\n\t}\n\tif (K == 1) coe[1] = 0, coe[0] = 1;\n\tfor (int T = 0; T <= K; T++) {\n\t\tfor (int i = 0; i < K; i++)\n\t\t\tfor (int j = 0; j < 10; j++)\n\t\t\t\tfor (int o = 0; o < 2; o++)\n\t\t\t\t\tdp[0][j][o][i] = 0;\n\t\tfor (int i = 0; i < K; i++)\n\t\t\tfor (int j = 0; j < 10; j++) {\n\t\t\t\tif (AL.a[0] > j) dp[0][j][1][i] = pw[j - AL.a[0] + 10][i];\n\t\t\t\telse dp[0][j][0][i] = pw[j - AL.a[0]][i];\n\t\t\t}\n\t\tint temp = 0;\n\t\tfor (int i = 0; i < M; i++) {\n\t\t\tif (i + 1 >= AL.len)\n\t\t\t\tfor (int k = 1; k < 10; k++)\n\t\t\t\t\tfor (int o = 0; o < K; o++)\n\t\t\t\t\t\tupd(temp, mul(coe[o], dp[i][k][0][o]));\n\t\t\tfor (int j = 0; j < 2; j++)\n\t\t\t\tfor (int k = 0; k < 10; k++)\n\t\t\t\t\tfor (int o = 0; o < K; o++) {\n\t\t\t\t\t\tsdp[i][k][j][o] = dp[i][k][j][o];\n\t\t\t\t\t\tif (k > 0) sdp[i][k][j][o] = add(sdp[i][k][j][o], sdp[i][k - 1][j][o]);\n\t\t\t\t\t}\n\t\t\tfor (int j = 0; j < 2; j++)\n\t\t\t\tfor (int k = 0; k < 10; k++)\n\t\t\t\t\tfor (int o = 0; o < K; o++)\n\t\t\t\t\t\tdp[i + 1][k][j][o] = 0;\n\t\t\tint num = AL.a[i + 1];\n\t\t\tfor (int j = 0; j < 2; j++)\n\t\t\t\tfor (int o = 0; o < K; o++)\n\t\t\t\t\tfor (int p = 0; p < 10; p++) {\n\t\t\t\t\t\tif (!sdp[i][p][j][o]) continue;\n\t\t\t\t\t\tint tr = sdp[i][p][j][o];\n\t\t\t\t\t\tfor (int m = o; m < K; m++) {\n\t\t\t\t\t\t\tif (p - j < num) {\n\t\t\t\t\t\t\t\tint tmp = p - j - num + 10;\n\t\t\t\t\t\t\t\tupd(dp[i + 1][p][1][m], mul(tr, mul(C[m][o], mul(pw[tmp][m - o], pw10[(i + 1) * (m - o)]))));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tint tmp = p - j - num;\n\t\t\t\t\t\t\t\tupd(dp[i + 1][p][0][m], mul(tr, mul(C[m][o], mul(pw[tmp][m - o], pw10[(i + 1) * (m - o)]))));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\t\tfor (int k = 1; k < 10; k++)\n\t\t\tfor (int o = 0; o < K; o++)\n\t\t\t\tupd(temp, mul(coe[o], dp[M][k][0][o]));\n\t\tfor (int i = 2; i < K; i++)\n\t\t\ttemp = mul(temp, Pow(i, P - 2));\n\t\ttemp = mul(temp, C[K][T]);\n\t\tif (T & 1) ans = sub(ans, temp);\n\t\telse ans = add(ans, temp);\n\t\tAL = AL + R;\n\t}\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n\n```",
        "postTime": 1653588337,
        "uid": 111892,
        "name": "Cherished",
        "ccfLevel": 9,
        "title": "[SNOI2022] \u6570\u4f4d \u9898\u89e3"
    },
    {
        "content": "\u8bbe $m=10$ \u662f\u8fdb\u5236\u6570\uff08\u5b57\u7b26\u96c6\u5927\u5c0f\uff09\u3002\n\n\u9996\u5148\uff0c$x\\in [L,R]$ \u7684\u9650\u5236\u53ef\u4ee5\u76f4\u63a5\u53bb\u6389\u4e0b\u754c\uff1a\u5148\u7b97\u51fa $kL$ \u7684\u503c\uff0c\u7136\u540e\u8ba4\u4e3a $x\\in [0,R-L]$\u3002\u5728\u4e4b\u540e\u7684\u6570\u4f4d dp \u8fc7\u7a0b\u4e2d\uff0cdp \u5230\u7b2c $i$ \u4f4d\u65f6\u52a0\u4e0a $kL$ \u7684\u7b2c $i$ \u4f4d\u7684\u8d21\u732e\u5373\u53ef\u3002\n\n\u4e8b\u5b9e\u4e0a\uff0c\u4e0a\u754c $R-L$ \u7684\u9650\u5236\u4e5f\u80fd\u5982\u6cd5\u70ae\u5236\uff1a\u5bb9\u65a5\uff0c\u94a6\u5b9a $i$ \u4e2a\u8d85\u8fc7\u4e0a\u754c\uff0c\u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\u51cf\u53bb $i(R-L+1)$ \u5373\u53ef\u3002\u73b0\u5728\u6211\u4eec\u9700\u8981\u5bf9\u4e8e\u6bcf\u4e2a $i$\uff0c\u90fd\u7b97\u51fa\u94a6\u5b9a\u5b8c\u6210\u540e\uff0c\u65e2\u65e0\u4e0a\u754c\u4e5f\u65e0\u4e0b\u754c\u7684\u65b9\u6848\u6570\u3002\n\n\u4e0d\u96be\u8bbe\u8ba1\u51fa dp\uff1a$f(x,val,digit)$ \u8868\u793a\u5df2\u7ecf\u5b8c\u6210 $[0,x)$ \u4f4d\uff0c$x-1$ \u4f4d\u5411 $x$ \u4f4d\u8fdb\u4f4d $val$\uff0c$x-1$ \u4f4d\u662f $digit$ \u7684\u65b9\u6848\u6570\u3002$x\\in [0,n]$\uff0c$val\\in [0,k]$\uff0c$digit\\in [0,9]$\u3002\u8f6c\u79fb\u65f6\u679a\u4e3e\u7b2c $x$ \u4f4d\u7684\u6570\u7684\u603b\u548c $s$\uff0c\u7528\u4e4b\u524d\u9884\u5904\u7406\u7684\u503c\u53ef\u4ee5\u76f4\u63a5\u5f97\u5230\u65b9\u6848\u6570 $g(s)$\uff0c\u5219\u8fd9\u4e00\u4f4d\u7684\u65b0\u503c\u662f $val+s+bound_x$\uff08$bound$ \u662f\u7531\u4e4b\u524d\u7684\u4e0b\u754c\u5e26\u6765\u7684\u989d\u5916\u8d21\u732e\uff09\u3002\u76f4\u63a5 dp \u590d\u6742\u5ea6\u662f $O(k\\times nkm\\times km)=O(nk^3m^2)$ \u7684\uff08\u4e09\u90e8\u5206\u5206\u522b\u662f dp \u6b21\u6570\uff0c\u72b6\u6001\u6570\uff0c\u8f6c\u79fb\u590d\u6742\u5ea6\uff09\u3002\u770b\u4e0a\u53bb\u5f88\u5927\uff0c\u4f46\u5e38\u6570\u5f88\u5c0f\uff0c\u53ef\u4ee5\u5f97\u5230 92 \u5206\u3002[\u63d0\u4ea4\u8bb0\u5f55](https://loj.ac/s/1473729)\n\n\u8003\u8651\u4f18\u5316\u4e0a\u9762\u7684\u7b97\u6cd5\u3002\u4e0d\u96be\u53d1\u73b0 $f(\\dots,val)\\times g(s)\\to f'(\\dots,val+s)$ \u7684\u8fc7\u7a0b\u662f\u5377\u79ef\uff0c\u4f7f\u7528 NTT \u5373\u53ef\u505a\u5230 $O(nk^2m^2(\\log k+\\log m))$\uff0c\u4f46\u4ecd\u7136\u53ea\u6709 92 \u5206\u3002\n\n\u6ce8\uff1a\u5982\u679c\u60a8\u7406\u89e3\u4e0b\u9762\u7684\u4f18\u5316\u6709\u56f0\u96be\uff0c\u53ef\u4ee5\u5bf9\u7167 LOJ \u4e0a\u7528\u6237 2222 \u7684\u63d0\u4ea4\u6765\u7406\u89e3\u662f\u5982\u4f55\u4f18\u5316\u7684\uff1a\u6211\u628a\u4f18\u5316\u7684\u4e2d\u95f4\u8fc7\u7a0b\u5199\u6210\u4ee3\u7801\u90fd\u4ea4\u4e86\u4e00\u904d\u3002\n\n\u6ce8\u610f\u5230\u6bcf\u8f6e\u8f6c\u79fb\u6211\u4eec\u8981\u505a $m$ \u6b21 $n\\times (nm)$ \u7684\u5377\u79ef\uff0c\u6bcf\u6b21\u5377\u4e0a\u7684\u957f\u4e3a $nm$ \u7684\u5e8f\u5217 $b$ \u90fd\u662f\u4e00\u6837\u7684\u3002\u4f46\u8fd9\u4e9b\u5377\u79ef\u7684\u7ed3\u679c\u4fdd\u7559\u4e0e\u5426\uff0c\u53ea\u4e0e $a_{t,i}b_j\\to c_{i+j}$ \u65f6 $(i+j)\\bmod m$ \u4e0e $t$ \u7684\u5927\u5c0f\u5173\u7cfb\u6709\u5173\u3002\n\n\u8003\u8651\u6309\u7167 $i,j$ \u6a21 $m$ \u7684\u4f59\u6570\u5206\u7c7b\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u7c7b $j\\bmod m$ \u5148\u7528 $O(m^2n)$ \u7684\u65f6\u95f4\u679a\u4e3e\u6240\u6709 $(t,i)$ \u9884\u5904\u7406\u51fa\u4e0e\u8fd9\u4e00\u7c7b $j$ \u505a\u5377\u79ef\u7684\u7ed3\u679c\u4f1a\u88ab\u4fdd\u7559\u7684 $a_{t,i}$\uff0c\u518d\u7528 $O((mn/m)\\times n)$ \u7684\u65f6\u95f4\u4e00\u6b21\u5377\u79ef\u5b8c\u3002\u8fd9\u6837\u5747\u644a\u4e0b\u6765\u76f8\u5f53\u4e8e\u53ea\u505a\u4e86\u4e00\u6b21\u5377\u79ef\u3002\n\n\u590d\u6742\u5ea6\u4f18\u5316\u81f3 $O(nk^3m+nk^2m^2)$\uff0c\u5e38\u6570\u4ecd\u7136\u5f88\u5c0f\uff0c\u5df2\u7ecf\u53ef\u4ee5\u901a\u8fc7\u3002\u5728\u5377\u79ef\u5904\u4f7f\u7528 unsigned long long \u907f\u514d\u591a\u6b21\u53d6\u6a21\uff0c\u53ef\u4ee5\u5728 1s \u4ee5\u5185\u51fa\u89e3\u3002[\u63d0\u4ea4\u8bb0\u5f55](https://loj.ac/s/1473883)\n\n\u4ee3\u7801\u4e0d\u8d85\u8fc7 2kb\u3002",
        "postTime": 1654081101,
        "uid": 42156,
        "name": "feecle6418",
        "ccfLevel": 0,
        "title": "SNOI2022 \u6570\u4f4d \u597d\u5199\u505a\u6cd5"
    }
]
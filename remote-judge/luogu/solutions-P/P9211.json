[
    {
        "content": "## \u9898\u76ee\u5206\u6790\n\n\u611f\u89c9\u6ca1\u6709\u5f88\u597d\u7684\u6027\u8d28\uff0c\u4f46\u662f\u89c2\u5bdf $n=3\\times10^3,m=10^4,l=3\\times10^5$ \u7684\u6570\u636e\u8303\u56f4\u53d1\u73b0\u9650\u5236\u7ed9\u7684\u5f88\u677e\uff0c\u4e00\u65b9\u9762\u662f $S_\\text{real}$ \u4e0e $S_\\text{fin}$ \u7684\u5dee\u8ddd\u5f88\u5c0f\uff0c\u53e6\u4e00\u65b9\u9762\u662f $S'_\\text{fin}$ \u7684\u5bb9\u9519\u7387\u6bd4\u8f83\u5927\uff0c\u6240\u4ee5\u8003\u8651\u7b80\u5355\u7684\u968f\u673a\u7b97\u6cd5\u3002\n\n\u6211\u4eec\u76f4\u63a5\u679a\u4e3e $S'_0$ \u7684\u957f\u5ea6 $len$, \u5bf9\u4e8e\u6bcf\u4e2a\u957f\u5ea6\u968f\u4e00\u4e9b\u4f4d\u7f6e $p_{1\\dots k}$, \u68c0\u6d4b\u5728\u968f\u7684\u8fd9\u4e9b $p_i$ \u4e2d\u6709\u591a\u5c11\u4e2a\u6ee1\u8db3 $S_\\text{real}[p_i]=S_\\text{real}[p_i+len]$, \u8bb0\u4f5c $f_{len}$, \u7136\u540e\u53d6 $\\max f_{len}$ \u6240\u5bf9\u5e94\u7684 $len$ \u4f5c\u4e3a $l_0$ \u5373\u53ef\uff0c\u770b\u6570\u636e\u8303\u56f4\u5bb9\u6613\u53d1\u73b0\u6b63\u786e\u7387\u6781\u9ad8\uff08\u56e0\u4e3a\u65f6\u95f4\u9650\u5236\u8db3\u591f\u968f\u5f88\u591a\u6b21\uff0c\u4e8e\u662f $f_{len}\\over k$ \u4e0e\u6574\u4f53\u60c5\u51b5\u7684\u504f\u5dee\u8d85\u8fc7 $m\\over n$ \u7684\u6982\u7387\u6781\u4f4e\uff09\u3002\n\n\u90a3\u4e48\u968f $600$ \u6b21\uff0c\u4ee4 $S'_0$ \u7684\u6bcf\u4e00\u4f4d $S'_0[i]$ \u53d6 $S_\\text{real}[k\\times l_0+i]$ \u4e2d\u51fa\u73b0\u6b21\u6570\u6700\u591a\u7684\u5b57\u7b26\u5373\u53ef\u901a\u8fc7\u672c\u9898\u3002\n\n## \u4ee3\u7801\n\n```cpp\n/*\n  author: PEKKA_l  \n*/\n#include <iostream>\n#include <cstring>\n#include <algorithm>\n#include <random>\nusing namespace std;\n\nint l,n,m,lmx,cnt[35];\nchar s[300005],ans[300005];\nmt19937 mt_rand(time(0));\n\nint getrd(int l,int r) {return l+mt_rand()%(r-l+1);}\n\nint check(int len)//\u968f\u673a\n{\n\tint cntt=0;\n\tfor(int i=1;i<=600;i++) {int wz=getrd(0,l-len-1); if(s[wz]==s[wz+len]) cntt++;}\n\treturn cntt;\n}\n\nsigned main()\n{\n\tcin>>l>>lmx>>n>>m>>s;\n\tint mxx=0,nmm;//\u679a\u4e3e l_0\n\tfor(int i=lmx;i>=1;i--) {int nans=check(i); if(nans>mxx) {mxx=nans; nmm=i;}}\n\tfor(int j=0;j<nmm;j++)\n\t{\n\t\tmemset(cnt,0,sizeof(cnt)); int nnum=-1,nmax=0;\n\t\tfor(int k=j;k<l;k+=nmm)\n\t\t{\n\t\t\tcnt[s[k]-'a'+1]++; if(cnt[s[k]-'a'+1]>nmax) {nmax=cnt[s[k]-'a'+1]; nnum=s[k]-'a'+1;}\n\t\t}\n\t\tans[j]=(char)(nnum+'a'-1);\n\t}\n\tcout<<nmm<<endl<<ans<<endl;\n}\n```\n",
        "postTime": 1681518702,
        "uid": 529697,
        "name": "PEKKA_l",
        "ccfLevel": 6,
        "title": "P9211 \u9898\u89e3"
    }
]
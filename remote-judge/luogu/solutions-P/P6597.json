[
    {
        "content": "\u611f\u89c9\u8fd9\u9898\u6bd4\u70f7\u70c3\u8ba1\u6570\u6c34\u597d\u591a\u554a,\u53ea\u8981\u4f1a[\u70f7\u57fa\u8ba1\u6570](https://loj.ac/problem/6538)\u5c31\u884c\n## \u70ef\u70c3\u8ba1\u6570\n\n\u5df2\u77e5\u78b3\u539f\u5b50\u4e2a\u6570 $n$\uff0c\u6c42\u5bf9\u5e94\u7684\u70ef\u70c3\u6709\u591a\u5c11\u79cd\u540c\u5206\u5f02\u6784\u4f53\n\n\u4e0d\u8003\u8651\u7a7a\u95f4\u5f02\u6784\n\n### \u9898\u89e3\n\n\u628a\u78b3-\u78b3\u53cc\u952e\u770b\u4f5c\u5173\u952e\u8fb9,\u65ad\u5f00\u8fd9\u6761\u5173\u952e\u8fb9,\u4e24\u8fb9\u5206\u522b\u662f\u4e00\u68f5\u6839\u8282\u70b9\u7684\u5b50\u8282\u70b9\u4e2a\u6570 $\\leq 2$ ,\u9664\u6839\u8282\u70b9\u5916\u5b50\u8282\u70b9\u4e2a\u6570 $\\leq 3$ \u7684\u65e0\u6807\u53f7\u6709\u6839\u6811\n\n\u5148\u7528 $Burnside$ \u5f15\u7406\u6c42\u51fa\u8fd9\u68f5\u6811\u7684\u65b9\u6848\u518d\u5408\u5e76\u5373\u53ef\n\n\u8bbe $n$ \u4e2a\u70b9\u7684\u70f7\u57fa\u8ba1\u6570\u7684$OGF$\u4e3a$A(x)$,\u8981\u6c42\u7684\u6811\u7684 $OGF$ \u4e3a $P(x)$\n\n$$P(x)=x\\frac{A(x)^2+A(x^2)}{2}$$\n\n\u8bbe\u7b54\u6848\u7684 $OGF$ \u4e3a $Q(x)$\n\n$$Q(x)=\\frac{(P(x)-1)^2+P(x^2)-1}{2}$$\n\n\u540c\u6837,$-1$\u662f\u56e0\u4e3a$0$\u4e2a\u70b9\u4e0d\u80fd\u88ab\u7b97\u5165\u65b9\u6848\n\n[\u4ee3\u7801](https://www.luogu.com.cn/paste/qvm2pjej)",
        "postTime": 1598426923,
        "uid": 114409,
        "name": "9AC8E2",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6597 \u3010\u70ef\u70c3\u8ba1\u6570\u3011"
    },
    {
        "content": "## \u70f7\u57fa\u8ba1\u6570\n\n\u6c42 $n$ \u4e2a\u70b9\u7684\u6bcf\u4e2a\u70b9\u5ea6\u6570\u4e0d\u8d85\u8fc7 $4$ \u4e14\u6839\u7684\u5ea6\u6570\u4e0d\u8d85\u8fc7 $3$ \u7684\u65e0\u6807\u53f7\u6709\u6839\u6811\u7684\u6570\u76ee\u3002\n\n\u8bbe\u7b54\u6848\u7684 $\\text{OGF}$ \u4e3a $A(x)$\uff0c\u8003\u8651\u6839\u7684\u5b50\u8282\u70b9\uff0c\u4f7f\u7528 $\\text {Burside}$ \u5f15\u7406\u5f97\u5230\uff1a\n$$\nA(x)=x\\frac{A(x)^3+3A(x^2)A(x)+2A(x^3)}{6}+1\n$$\n\u8003\u8651\u725b\u987f\u8fed\u4ee3\uff0c\u8bbe $A_*(x)$ \u4e3a $\\bmod x^{\\frac{n}{2}}$ \u7684\u7b54\u6848\u3002\n$$\nF(A(x))=x\\frac{A(x)^3+3A(x^2)A(x)+2A(x^3)}{6}+1-A(x)=0\\\\\nA(x)=A_*(x)-\\frac{F(A_*(x))}{F'(A_*(x))}\\pmod{x^n}\\\\\nF'(A(x))=x\\frac{A(x)^2+A(x^2)}{2}-1\n$$\n\n## \u70ef\u70c3\u8ba1\u6570\n\n\u65ad\u5f00\u78b3-\u78b3\u53cc\u952e\u4e24\u8fb9\u662f\u6839\u8282\u70b9\u5ea6\u6570\u4e0d\u8d85\u8fc7 $2$\uff0c\u5176\u4ed6\u70b9\u5b50\u8282\u70b9\u4e2a\u6570\u5c0f\u4e8e\u7b49\u4e8e $3$ \u7684\u65e0\u6807\u53f7\u6709\u6839\u6811\u3002\n\n\u8fd9\u68f5\u6811\u7684 $\\text{OGF}$ \u4e3a $P(x)$\uff1a\n$$\nP(x)=x\\frac{A(x)^2+A(x^2)}{2}+1\n$$\n\u70ef\u70c3\u7684 $\\text{OGF}$ \u4e3a $G(x)$\uff1a\n$$\nG(x)=x\\frac{(P(x)-1)^2+P(x^2)-1}{2}\n$$\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nint const mod=998244353,g=3,gi=998244354/3,inv2=998244354/2,inv6=998244354/6,maxn=800010;\nint pow(int x,int y){\n\tint res=1;\n\twhile(y){\n\t\tif(y&1)res=1ll*x*res%mod;\n\t\tx=1ll*x*x%mod,y>>=1;\n\t}\n\treturn res;\n}\nstruct NTT{\n\tint r[maxn],lim;\n\tNTT():r(),lim(){}\n\tvoid getr(int const &li){\n\t\tlim=li;\n\t\tfor(int i=0;i<lim;i++)r[i]=(r[i>>1]>>1)|((i&1)*(lim>>1));\n\t}\n\tvoid operator ()(int *a,int const &type)const{\n\t\tfor(int i=0;i<lim;i++)if(i<r[i])std::swap(a[i],a[r[i]]);\n\t\tfor(int mid=1;mid<lim;mid<<=1){\n\t\t\tint rt=pow(type==1?g:gi,(mod-1)/(mid<<1));\n\t\t\tfor(int r=mid<<1,j=0;j<lim;j+=r){\n\t\t\t\tint p=1;\n\t\t\t\tfor(int k=0;k<mid;k++,p=1ll*p*rt%mod){\n\t\t\t\t\tint x=a[j+k],y=1ll*p*a[j+k+mid]%mod;\n\t\t\t\t\ta[j+k]=(x+y)%mod,a[j+mid+k]=(x-y+mod)%mod;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(type==-1)for(int p=pow(lim,mod-2),i=0;i<lim;i++)a[i]=1ll*a[i]*p%mod;\n\t}\n}ntt;\nvoid inv(int const *a,int *ans,int const &m){\n\tstatic int tmp[maxn];\n\tfor(int i=0;i<m<<1;i++)tmp[i]=ans[i]=0;\n\tans[0]=pow(a[0],mod-2);\n\tfor(int n=2,lim;n<=m;n<<=1){\n\t\tfor(int i=0;i<n;i++)tmp[i]=a[i];\n\t\tntt.getr(lim=n<<1);\n\t\tntt(tmp,1),ntt(ans,1);\n\t\tfor(int i=0;i<lim;i++)ans[i]=ans[i]*(2-1ll*ans[i]*tmp[i]%mod+mod)%mod;\n\t\tntt(ans,-1);\n\t\tfor(int i=n;i<lim;i++)ans[i]=0;\n\t}\n}\nvoid solve(int *ans,int const &m){\n\tstatic int a3[maxn],a2[maxn],a1[maxn],fz[maxn],fm[maxn];\n\tans[0]=1;\n\tfor(int n=2,lim;n<=m;n<<=1){\n\t\tfor(int i=0;i<n<<1;i++)a1[i]=a2[i]=a3[i]=fz[i]=fm[i]=0;\n\t\tfor(int i=0;i<n;i++)a1[i]=ans[i];\n\t\tfor(int i=0;i<n;i+=2)a2[i]=ans[i/2];\n\t\tfor(int i=0;i<n;i+=3)a3[i]=ans[i/3];\n\t\tntt.getr(lim=n<<2);\n\t\tntt(a1,1);\n\t\tfor(int i=0;i<lim;i++)a1[i]=1ll*a1[i]*a1[i]%mod*a1[i]%mod;\n\t\tntt(a1,-1);\n\t\tfor(int i=0;i<n;i++)fz[i]=a1[i],a1[i]=ans[i],fm[i]=a2[i];\n\t\tfor(int i=n;i<lim;i++)a1[i]=0;\n\t\tntt.getr(lim=n<<1);\n\t\tntt(a1,1),ntt(a2,1);\n\t\tfor(int i=0;i<lim;i++)a2[i]=1ll*a2[i]*a1[i]%mod,a1[i]=1ll*a1[i]*a1[i]%mod;\n\t\tntt(a1,-1),ntt(a2,-1);\n\t\tfor(int i=n-1;i;i--)fz[i]=(1ll*inv6*fz[i-1]+1ll*inv2*a2[i-1]+1ll*gi*a3[i-1])%mod;\n\t\tfz[0]=1;\n\t\tfor(int i=0;i<n;i++)fz[i]=(fz[i]-ans[i]+mod)%mod;\n\t\tfor(int i=n-1;i;i--)fm[i]=1ll*inv2*(a1[i-1]+fm[i-1])%mod;\n\t\tfm[0]=mod-1;\n\t\tfor(int i=n;i<lim;i++)fz[i]=fm[i]=0;\n\t\tinv(fm,a1,n);\n\t\tntt.getr(lim);\n\t\tntt(a1,1),ntt(fz,1);\n\t\tfor(int i=0;i<lim;i++)a1[i]=1ll*a1[i]*fz[i]%mod;\n\t\tntt(a1,-1);\n\t\tfor(int i=0;i<n;i++)ans[i]=(ans[i]-a1[i]+mod)%mod;\n\t}\n}\nint a[maxn],b[maxn],lim=1<<17;\nint main(){\n\tsolve(a,lim);\n\tfor(int i=0;i<lim;i++)b[i]=a[i];\n\tfor(int i=0;i<lim;i++)a[i]=0;\n\tfor(int i=0;i<lim;i+=2)a[i]=b[i>>1];\n\tntt.getr(lim<<1);\n\tntt(b,1);\n\tfor(int i=0;i<lim<<1;i++)b[i]=1ll*b[i]*b[i]%mod;\n\tntt(b,-1);\n\tfor(int i=lim-1;i;i--)a[i]=1ll*inv2*(a[i-1]+b[i-1])%mod;\n\ta[0]=0;\n\tfor(int i=0;i<lim<<1;i++)b[i]=0;\n\tfor(int i=0;i<lim;i+=2)b[i]=a[i>>1];\n\tntt(a,1);\n\tfor(int i=0;i<lim<<1;i++)a[i]=1ll*a[i]*a[i]%mod;\n\tntt(a,-1);\n\tfor(int i=lim-1;~i;i--)a[i]=1ll*inv2*(a[i]+b[i])%mod;\n\tint t;\n\tscanf(\"%d\",&t);\n\tfor(int i=2;i<=t;i++)printf(\"%d\\n\",a[i]);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1612426586,
        "uid": 55707,
        "name": "gxy001",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P6597 \u3010\u70ef\u70c3\u8ba1\u6570\u3011"
    },
    {
        "content": "\u524d\u5929 whk \u5b66\u5230\u6709\u673a\u5316\u5b66\u5165\u95e8\uff08~~\u4f46\u6211\u6709\u673a\u4e0d\u4f1a~~\uff09\uff0c\u8001\u5e08\u4f7f\u7528\u7a77\u4e3e\u6cd5\u8bb2\u4e86\u5982\u4f55\u6570 $n\u22647$ \u65f6\u7684\u70f7\u70c3\u8ba1\u6570\u3001\u70f7\u57fa\u8ba1\u6570\uff0c\u4e8e\u662f\u60f3\u5230\u4e86\u4e2a\u4eba\u6570\u5b66\u9898\u5355\u91cc\u8fd9\u9053\u4e00\u76f4\u6ca1\u52a8\u7684\u9898\u3002\u5c31\u4ece\u96be\u5ea6\u4f4e\u4e00\u4e9b\u7684\u70ef\u70c3\u8ba1\u6570\u5f00\u59cb\u5427\u3002\n\n## \u70f7\u57fa\u8ba1\u6570\uff08$ -C_nH_{2n+1} $\uff09\n\n\u5c06\u5931\u6389\u4e00\u4e2a\u6c22\u7684\u78b3\u4f5c\u4e3a\u6839,$f$ \u7b49\u4ef7\u4e8e\u975e\u53f6\u7ed3\u70b9\u5171 $n$ \u4e2a\uff0c\u6bcf\u4e2a\u975e\u53f6\u7ed3\u70b9\u6070\u6709 $3$ \u4e2a\u513f\u5b50\u7684**\u65e0\u6807\u53f7\u6709\u6839\u6811\u8ba1\u6570**\uff0c\u8bbe\u5176\u751f\u6210\u51fd\u6570\u4e3a $F(x)$ \uff08$n=0$ \u65f6 $f_n=1$\uff0c\u5373\u5355\u4e2a\u6c22\u539f\u5b50\uff09\u3002\n\n\u8bbe\u60f3\u5982\u679c\u6c42\u7684\u662f**\u6709\u6807\u53f7\u6709\u6839\u6811\u8ba1\u6570**\uff0c\u5219\u7b54\u6848\u663e\u7136\u4e3a\n $F(x)=xF^3(x)+1$\uff0c\u53ef\u60dc\u6c42\u7684\u662f\u65e0\u6807\u53f7\uff0c\u4e5f\u5c31\u662f\u6c42\u901a\u8fc7\u968f\u610f\u4ea4\u6362 $3$ \u68f5\u5b50\u6811\u4f4d\u7f6e\u540e\u4e0d\u80fd\u4e0e\u53e6\u4e00\u79cd\u76f8\u540c\u7684\uff0c**\u672c\u8d28\u4e0d\u540c\u7684\u65b9\u6848\u6570**\u3002\n\n\u5c06**\u65e0\u6807\u53f7\u8ba1\u6570**\u7528\u8fd9\u79cd\u65b9\u5f0f\u63cf\u8ff0\uff0c\u5bb9\u6613\u60f3\u5230\u52a8\u7528\u7fa4\u8bba\u89e3\u51b3\u8be5\u95ee\u9898\u3002\u6240\u6c42\u5373\u5728\u7f6e\u6362\u7fa4 $G=$ {\u4efb\u610f\u91cd\u6392\u5b50\u6811}\u4e0b\u7684**\u7b49\u4ef7\u7c7b\u6570**\uff0c\u8fd9\u91cc\u4e13\u4e1a\u5bf9\u53e3\u7684\u662f **Burnside \u5b9a\u7406**\u3002\n\n$|X/G|=\\frac{1}{|G|}\\sum\\limits_{g\u2208G}|X^g|$\n\n $|X/G|$ \u8868\u793a $X$ \u5728\u4f5c\u7528\u4e8e $X$ \u7684\u7f6e\u6362\u7fa4 $G$ \u4e0b\u7684\u7b49\u4ef7\u7c7b\u6570,$|X^g|$ \u8868\u793a $X$ \u5728\u7f6e\u6362 $g$ \u4f5c\u7528\u4e0b\u7684\u7a33\u5b9a\u5b50\u6570\uff0c\u5173\u4e8e\u7fa4\u8bba\u57fa\u7840\u77e5\u8bc6\u548c Burnside \u4e0e P\u00f5lya \u5b9a\u7406\u63a8\u5bfc\u53ef\u4ee5\u53c2\u8003[\u8fd9\u9053\u9898\u4e0b\u7684\u795e\u4ed9\u9898\u89e3\u4eec](https://www.luogu.com.cn/problem/solution/P4980 )\uff0c\uff08\u5176\u5b9e\u4ece\u7fa4\u8bba\u96f6\u57fa\u7840\u5b66\u5230\u63a8\u5bfc burnside \u548c p\u00f5lya \u4e5f\u57fa\u672c\u53ea\u662f\u7528\u4e00\u79cd\u65b0\u7684\u89d2\u5ea6\u770b\u5f85\u5e38\u89c1\u7684\u95ee\u9898\uff0c\u5e76\u4e0d\u6050\u6016\uff09\u3002\n\n\u73b0\u5728 $G$ \u4e2d\u6709 6 \u79cd\u7f6e\u6362\uff08\u5c31\u662f\u6392\u5217\uff09\uff0c\u53ef\u4ee5\u5206\u4e3a\u4e09\u7c7b\uff1a\n\n\u5565\u90fd\u4e0d\u5e72 $\\begin{pmatrix}1&2&3\\\\1&2&3\\end{pmatrix}$,\u6b64\u65f6\u6240\u6709\u6709\u6807\u53f7\u65b9\u6848\u6570\u90fd\u662f\u7a33\u5b9a\u5b50\uff0c$F(x)=xF^3(x)+1$\u3002\n\n\u4ea4\u6362\u4e24\u4e2a\uff0c\u7b2c\u4e09\u4e2a\u4e0d\u52a8\u5982 $\\begin{pmatrix}1&2&3\\\\2&1&3\\end{pmatrix}$\uff0c\u5171 3 \u4e2a\uff0c\u7a33\u5b9a\u5b50\u987b\u6ee1\u8db3\u81f3\u5c112\u68f5\u5b50\u6811\u76f8\u540c\uff0c$F(x)=xF(x)F(x^2)+1$\u3002\n\n\u5168\u90e8\u79fb\u52a8\u4f4d\u7f6e\u5982 $\\begin{pmatrix}1&2&3\\\\2&3&1\\end{pmatrix}$\uff0c\u5171 2 \u4e2a\uff0c\u7a33\u5b9a\u5b50\u987b\u6ee1\u8db3 3 \u68f5\u5b50\u6811\u76f8\u540c\uff0c$F(x)=xF(x^3)+1$\u3002\n\n\u4ee3\u5165\u539f\u5f0f\u6c42\u5e73\u5747\u503c\uff0c\u5f97\u5230\u6700\u7ec8\u7b54\u6848 $F(x)=x\\frac{F^3(x)+3F(x)F(x^2)+2F(x^3)}{6}+1$\u3002\n\n\u5bf9\u4e8e\u8fd9\u4e2a\u5413\u4eba\u7684\u5f0f\u5b50\uff0c\u66b4\u529b\u5206\u6cbb FFT \u56fa\u7136\u53ef\u884c\uff0c\u4f46\u53ef\u4ee5\u7528\u66f4\u57fa\u7840\u4e5f\u66f4\u4f18\u7684[\u591a\u9879\u5f0f\u725b\u987f\u8fed\u4ee3\u6cd5](https://www.cnblogs.com/lfri/p/9804801.html)\u4e3a\u4f55\u4e0d\u7528\u5462\uff08\u76f8\u4fe1\u5927\u5bb6\u591a\u9879\u5f0f\u6c42\u9006\u548c\u591a\u9879\u5f0f exp \u90fd\u5199\u8fc7\u5427\uff09\u3002\n\n\u8981\u6c42\u89e3\u7684\u65b9\u7a0b\u662f $x(F(x^3)+3F(x)F(x^2)+2F(x^3))+6-6F(x)=0$,\n\u628a\u5df2\u77e5 $n$ \u9636\u8fd1\u4f3c $x_n$ \u6c42 $x_{n+1}$ \u7684\u8fc7\u7a0b\u8f6c\u5316\u6210\u5df2\u77e5 $F(x)(\\bmod$ $x^{k})$ \u6c42 $F(x)(\\bmod$ $x^{2k})$ \u7684\u8fc7\u7a0b\u518d\u9012\u5f52\u500d\u589e\u6c42\u89e3\uff0c\u4ee4 $H(x)$ \u8868\u793a\u5df2\u77e5\u7684 $F(x)$ \u524d\u534a\u8fb9,\u6c42\u5bfc\u65f6\u53ef\u4ee5\u628a $H(x^2)$ \u548c $H(x^3)$ \u90fd\u5f53\u6210\u5e38\u6570\uff0c\u5bf9\u539f\u65b9\u7a0b\u6c42\u5bfc\u518d\u5e26\u8fdb\u725b\u987f\u8fed\u4ee3\u7684\u5f0f\u5b50\u91cc\uff0c\u5f97\u5230 $F(x)=H(x)-\\frac{x(H^3(x)+3H(x^2)H^2(x)+2H(x^3))+6-6H(x)}{x(3H^2(x)+3H(x^2))-6} (\\bmod$  $x^{2k})$ \u5c31\u80fd~~\u4e0d\u90a3\u4e48\u8f7b\u8f7b\u677e\u677e\u5730~~\u5b9e\u73b0\u4e86\u3002\n\n## \u70ef\u70c3\u8ba1\u6570\uff08$C_nH_{2n}$\uff09\n\n\u7b49\u4ef7\u4e8e\u8fd9\u6837\u4e00\u68f5\u6709\u6839\u6811\uff1a\u6839\u8282\u70b9\u4e3a\u53cc\u952e\uff0c\u7b2c $2$ \u5c42 $2$ \u4e2a\u65e0\u6807\u53f7\u5b50\u8282\u70b9\u5bf9\u5e94\u53cc\u952e\u4e24\u8fb9\u7684\u78b3\uff0c\u6bcf\u4e2a\u4e0b\u9762\u518d\u8fde\u63a5 $2$ \u4e2a\u65e0\u6807\u53f7\u70f7\u57fa\u6709\u6839\u6811\uff08\u53ef\u4ee5\u4e3a\u5355\u4e2a\u6c22\uff09\u3002\n\n\u6c42\u51fa\u70f7\u57fa\u7684\u751f\u6210\u51fd\u6570\u540e\uff0c\u57fa\u672c\u5927\u529f\u544a\u6210\uff0c\u73b0\u5728\u53ea\u9700\u8981\u5206 $2$ \u5c42\uff0c\u4f7f\u7528\u540c\u6837\u65b9\u5f0f\u5904\u7406\uff0c\u4e0d\u8fc7\u4e0d\u9700\u8981\u725b\u987f\u8fed\u4ee3\u4e86\uff0c\u8bbe $G(x)$ \u8868\u793a\u7b2c $2$ \u5c42\u5b50\u6811\u7684\u751f\u6210\u51fd\u6570\uff0c\u6b64\u65f6\u53ea\u6709 $2$ \u4e2a\u5b50\u6811\uff0c\u6839\u636e burnside \u5b9a\u7406\uff0c\u4e0d\u96be\u5f97\u51fa $G(x)=x\\frac{F(x^2)+F^2(x)}{2}$ (\u53cc\u952e\u4e0d\u80fd\u8fde\u5355\u4e2a\u6c22\uff0c\u663e\u7136\u4e0d\u80fd $+1$ )\uff0c\u8bbe\u7b54\u6848\u7684\u751f\u6210\u51fd\u6570\u4e3a $E(x)$,\u6ce8\u610f\u53cc\u952e\u672c\u8eab\u4e0d\u8ba1\u5165 $n$\uff0c\u4e0d\u96be\u5f97\u51fa $E(x)=\\frac{G(x^2)+G^2(x)}{2}$\uff0cQ.E.D\u3002\n\n\u4ee3\u7801\u5982\u4e0b\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nint a1[500011],k1,q[500011],b1[500011],c[500011],p=998244353,b3[500011],b2[500011],c2[500011],c3[500011],c1[500011],r[500011];\nint u[500011],dn[500011],fl,n;\ninline int add(int x,int y){return x+y>=p?x+y-p:x+y;}\ninline int minn(int x,int y){return x<y?x:y;}\ninline void bter(){int i;\n\tfor(i=0;i<k1;i++)r[i]=(r[i>>1]>>1)|(i&1?k1>>1:0);\n} //\u5904\u7406\u8774\u8776\u53d8\u6362\u6570\u7ec4 \ninline int ksm(int x,int y){\n\tint k=1,l=x;if(x==1||y==1)return x;\n\twhile(y){if(y&1)k=1ll*k*l%p;l=1ll*l*l%p,y>>=1;}\n\treturn k;\n}\ninline void bz(int *f){int i,j;\n\tfor(i=0,j=ksm(k1,p-2);i<k1;i++)f[i]=1ll*f[i]*j%p;\n} //\u51fd\u6570\u540d\u968f\u4fbf\u5199\u7684,\u5904\u7406\u9006\u53d8\u6362\u4e4b\u540e\u9664\u4ee5k1\u64cd\u4f5c \ninline void ntt(int *f,bool m){\n\tint i,j,h,k,l;\n\tfor(i=0;i<k1;i++)if(i<r[i])k=f[i],f[i]=f[r[i]],f[r[i]]=k;\n\tfor(i=1;i<k1;i<<=1){\n\t\tl=ksm(m?3:332748118,(p-1)/(i<<1));\n\t\tfor(j=q[0]=1;j<i;j++)q[j]=1ll*q[j-1]*l%p;//q\u6570\u7ec4\u662f\u4e60\u60ef\u6027\u9632\u5361\u5e38\u7684\uff0c\u867d\u7136\u8fd9\u9898\u4e0d\u5361\u5e38 \n\t\tfor(j=0;j<k1;j+=i<<1)\n\t\t\tfor(h=j;h<j+i;h++)\n\t\t\t\tk=1ll*f[h+i]*q[h-j]%p,f[h+i]=add(f[h],p-k),f[h]=add(f[h],k);}\n}\ninline void dxsinv(int k,int *a,int *b){\n\tint i,j;\n\tif(k==1){b[0]=ksm(a[0],p-2);return;}\n\tdxsinv(k+1>>1,a,b);\n\tfor(k1=1;k1<k<<1;k1<<=1);\n\tfor(i=0;i<k;i++)c[i]=a[i];\n\tfor(i=k;i<k1;i++)c[i]=0;\n\tfor(i=k+1>>1;i<k1;i++)b[i]=0;\n\tbter();ntt(c,1);ntt(b,1);\n\tfor(i=0;i<k1;i++)b[i]=1ll*b[i]*add(2,p-1ll*c[i]*b[i]%p)%p;\n\tntt(b,0);bz(b);\n}//\u591a\u9879\u5f0f\u6c42\u9006 \ninline void dxsane(int k,int *b){\n\tint i,j;if(k==1){b[0]=1;return;}\n\tdxsane(k+1>>1,b);\n\tmemset(c1,0,sizeof(c1));memset(c2,0,sizeof(c2));memset(c,0,sizeof(c));\n\tfor(i=0;i<k+1>>1;i++)\n\t\tc1[i<<1]=i<<1<k?b[i]:0,c2[i*3]=i*3<k?b[i]:0;\n\tfor(k1=1;k1<k<<1;k1<<=1);\n\tfor(i=k+1>>1;i<k1;i++)b[i]=0;\n\tbter();ntt(b,1);ntt(c1,1);ntt(c2,1);\n\tfor(i=0;i<k1;i++)\n\t\tb2[i]=1ll*b[i]*b[i]%p,b3[i]=1ll*b2[i]*b[i]%p;//b2\u4e3aF^2(x),b3\u4e3aF^3(x),c1\u4e3aF(x^2),c2\u4e3aF(x^3) \n\tfor(i=0;i<k1;i++)\n\t\tu[i]=add(add(b3[i],c2[i]),add(c2[i],3ll*c1[i]*b[i]%p)),\\\n\t\tdn[i]=add(3ll*b2[i]%p,3ll*c1[i]%p);\n\tntt(u,0);ntt(dn,0);bz(u);bz(dn);\n\tfor(i=k-1;i;i--)u[i]=u[i-1],dn[i]=dn[i-1];\n\tu[0]=6,dn[0]=p-6;\n\tfor(i=k;i<k1;i++)u[i]=dn[i]=0;\n\tntt(u,1);dxsinv(k,dn,c3);\n\tfor(i=k;i<k1;i++)c3[i]=0;ntt(c3,1);\n\tfor(i=0;i<k1;i++)\n\t\tu[i]=1ll*add(u[i],p-6ll*b[i]%p)*c3[i]%p,b[i]=add(b[i],p-u[i]);\n\tntt(b,0);bz(b);\n}//\u70f7\u57fa\u8ba1\u6570 \ninline void dxsene(){\n\tlong long i,j,k;\n\tmemset(c1,0,sizeof(c1));\n\tfor(i=0;i<n+1>>1;i++)\n\t\tc1[i<<1]=i<<1<n?b1[i]:0; \n\tfor(k1=1;k1<n<<1;k1<<=1);\n\tfor(i=n;i<k1;i++)b1[i]=c1[i]=0;\n\tbter();ntt(b1,1);ntt(c1,1);\n\tfor(i=0;i<k1;i++)\n\t\tb1[i]=1ll*b1[i]*b1[i]%p,a1[i]=add(b1[i],c1[i]);\n\tntt(a1,0);bz(a1);\n\tmemset(c1,0,sizeof(c1));\n\tfor(i=n-1;i;i--)\n\t\ta1[i]=1ll*a1[i-1]*499122177%p;a1[0]=0;\n\tfor(i=n;i<k1;i++)a1[i]=0;//\u5904\u7406\u7b2c2\u5c42 \n\tfor(i=0;i<n+1>>1;i++)\n\t\tc1[i<<1]=i<<1<n?a1[i]:0; \n\tfor(i=n;i<k1;i++)a1[i]=c1[i]=0;\n\tbter();ntt(a1,1);ntt(c1,1);\n\tfor(i=0;i<k1;i++)\n\t\ta1[i]=1ll*add(1ll*a1[i]*a1[i]%p,c1[i])*499122177%p;\n\tntt(a1,0);bz(a1);//\u5904\u7406\u7b54\u6848 \n}//\u70ef\u70c3\u8ba1\u6570 \nint main()\n{\n\tint i,j,k,m;scanf(\"%d\",&n);\n\tdxsane(++n,b1);\n\tdxsene();\n\tfor(i=2;i<n;i++)printf(\"%d\\n\",a1[i]);\n\treturn 0;\n}\n```\np.s. \u8dd1\u4e86\u4e00\u904d\u540e\uff0c\u53d1\u73b0 $n\u226526$ \u65f6\u7b54\u6848\u5c31\u7834 $10^9$ \u4e86\uff0c\u6240\u4ee5 whk \u8bd5\u5377\u5927\u62b5\u662f\u4e0d\u4f1a\u8003 $n\u22658$ \u7684\u60c5\u51b5\u7684\u3002",
        "postTime": 1683440328,
        "uid": 111172,
        "name": "Anoshag_Ruwan",
        "ccfLevel": 6,
        "title": "P6597 <\u70ef\u70c3\u8ba1\u6570> \u9898\u89e3"
    }
]
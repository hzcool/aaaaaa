[
    {
        "content": "\u6765\u4e00\u4e2a$dfs$\u7248\u7684\u6570\u4f4d$dp$\u3002\n\n\u8fd9\u79cd\u7edf\u8ba1\u548c\u7684\u6570\u4f4d$dp$\uff0c\u76f8\u5bf9\u4e8e\u7edf\u8ba1\u4e2a\u6570\u7684\u6570\u4f4d$dp$\uff0c\u65e2\u8981\u8bb0\u5f55\u4e2a\u6570\uff0c\u53c8\u8981\u8bb0\u5f55\u548c\u3002\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e00\u4f4d\uff0c\u7d2f\u52a0\u4e2a\u6570\u4e58\u4ee5\u8fd9\u4e00\u4f4d\u4f4d\u7f6e\u7684\u8d21\u732e\uff0c\u5373\u767e\u4f4d\u5c31\u662f\u4e2a\u6570\u4e58\u4ee5$100$\uff0c\u5343\u4f4d\u5c31\u662f\u4e58\u4ee5$1000$\uff0c\u4f9d\u6b64\u7c7b\u63a8\u3002\n\n\u6709\u4e00\u4e2a\u5730\u65b9\u88ab\u5751\u4e86\u597d\u4e45\uff0c\u4e0d\u80fd\u7528\u7684\u6570\u5b57\u6211\u62ff\u6570\u7ec4\u8bb0\u4e0b\u6765\uff0c\u7136\u540e\u5728\u679a\u4e3e\u5f53\u524d\u4f4d\u7684\u65f6\u5019\uff0c\u6ca1\u6709\u5224\u524d\u5bfc\u96f6\uff0c\u4e5f\u5c31\u662f\u5982\u679c\u96f6\u4e0d\u80fd\u7528\uff0c\u524d\u5bfc\u96f6\u6211\u5c31\u4e0d\u4f1a\u679a\u4e3e\u5230\u3002~~\u8c03\u4e86\u4e00\u5e74\u3002\u3002~~\n\n\u6ca1\u6709\u4ec0\u4e48\u601d\u7ef4\u96be\u5ea6\uff0c\u8003\u5bdf\u4e86\u6570\u4f4d$dp$\u6a21\u677f\u7684\u638c\u63e1\u7a0b\u5ea6\u3002\n\n$Code\\ Below:$\n```cpp\n#include<bits/stdc++.h>\n#define ts cout<<\"ok\"<<endl\n#define int long long\n#define hh puts(\"\")\n#define pc putchar\n//#define getchar() (p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\n//char buf[1<<21],*p1=buf,*p2=buf;\nusing namespace std;\nint s1,s2,nd,no,l,r,a[15],mi[15];\nstruct node{\n    int cnt,sum;\n}dp[16][1<<10];\ninline int read(){\n    int ret=0,ff=1;char ch=getchar();\n    while(!isdigit(ch)){if(ch=='-') ff=-1;ch=getchar();}\n    while(isdigit(ch)){ret=ret*10+(ch^48);ch=getchar();}\n    return ret*ff;\n}\nvoid write(int x){if(x<0){x=-x,pc('-');}if(x>9) write(x/10);pc(x%10+48);}\nvoid writeln(int x){write(x),hh;}\nvoid writesp(int x){write(x),pc(' ');}\nnode dfs(int pos,int zt,int lead,int lim){\n    if(!pos){\n        if((zt&nd)==nd&&(zt&no)==0) return (node){1,0};\n        return (node){0,0};\n    }\n    if(!lead&&!lim&&dp[pos][zt].sum!=-1) return dp[pos][zt];\n    int mx=lim?a[pos]:9;\n    node res=(node){0,0};\n    for(int i=0;i<=mx;i++){\n        node t;\n        if(lead&&!i) t=dfs(pos-1,zt,1,lim&&(i==mx));\n        else t=dfs(pos-1,zt|(1<<i),0,lim&&(i==mx));\n        res.cnt+=t.cnt;\n        res.sum+=t.sum+t.cnt*i*mi[pos-1];\n    }\n    if(!lead&&!lim) dp[pos][zt]=res;\n    return res;\n}\nint work(int x){\n    if(!x) return 0;\n    int len=0;\n    while(x){\n        a[++len]=x%10;\n        x/=10;\n    }\n    return dfs(len,0,1,1).sum;\n}\nsigned main(){\n    mi[0]=1;\n    for(int i=1;i<=15;i++) mi[i]=mi[i-1]*10;\n    int T=read();\n    while(T--){\n        memset(dp,-1,sizeof(dp));\n        l=read(),r=read();\n        nd=no=0;\n        s1=read();\n        for(int i=1;i<=s1;i++) nd|=1<<(read());\n        s2=read();\n        for(int i=1;i<=s2;i++) no|=1<<(read());\n        writeln(work(r)-work(l-1));\n    }\n    return 0;\n}\n```\n",
        "postTime": 1573207572,
        "uid": 27858,
        "name": "ycyaw",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4950 \u3010\u5b8c\u7f8e\u6570\u5b57\u3011"
    },
    {
        "content": "## \u9898\u76ee\u5927\u610f\n\n\u6c42$[l,r]$\u5185\u5404\u4f4d\u6570\u7684\u7ec4\u6210\u96c6\u5408\u5305\u542bS\u5185\u6240\u6709\u6570\u4e14\u4e0d\u5305\u542bT\u5185\u6240\u6709\u6570\u7684\u6570\u7684\u548c\u3002\u591a\u7ec4\u8be2\u95ee\u3002\n\n## \u7b97\u6cd5\u4e00\n\n\u201c\u5bf9\u4e8e\u524d$30\\%$\u7684\u6570\u636e\uff0c$l,r<10^4$\u3002\u201d\n\n\u76f4\u63a5\u66b4\u529b\u770b\u533a\u95f4\u5185\u6bcf\u4e2a\u6570\u662f\u5426\u7b26\u5408\u6761\u4ef6\u3002\n\n\u590d\u6742\u5ea6$O(Tr)$\u3002\n\n## \u7b97\u6cd5\u4e8c\n\n\u201c\u5bf9\u4e8e\u53e6$10\\%$\u7684\u6570\u636e\uff0c$|S|=|T|=0$\u3002\"\n\n\u6bcf\u4e2a\u6570\u90fd\u7b26\u5408\u6761\u4ef6\uff0c\u7b54\u6848\u5c31\u662f$\\sum_{i=l}^{r}i=r*(r+1)/2-l*(l-1)/2$\n\n\u7ed3\u5408\u7b97\u6cd5\u4e00\u53ef\u4ee5\u5f97\u5230$40$\u5206\u3002\n\n## \u7b97\u6cd5\u4e09\n\n\u6b63\u89e3\uff1a\u6570\u4f4dDP\u3002\n\n\u6570\u4f4d+\u72b6\u538bDP\u3002\n\n\u6c42\u51fa$1$\u5230$r$\u7684\u7b54\u6848\u51cf\u53bb$1$\u5230$l-1$\u7684\u7b54\u6848\u5373\u53ef\u3002\n\n\u5148\u9884\u5904\u7406\u5f97\u5230$f[i][j][k]$\uff1a$i$\u4f4d\u3001\u7531$j$\u96c6\u5408\u7ec4\u6210\u7684\u3001\u6700\u9ad8\u4f4d\u662f$k$\u7684\u6570\u7684\u548c\uff0c\u548c$g[i][j][k]$\uff1a\u540c\u4ee5\u4e0a\u6761\u4ef6\u7684\u6570\u7684\u4e2a\u6570\u3002\n\n\u7edf\u8ba1$x$\u7684\u7b54\u6848\u65f6\uff1a\n\n\u5148\u628a\u4f4d\u6570\u5c0f\u4e8e$x$\u7684\u6ee1\u8db3\u6761\u4ef6\u7684\u5168\u52a0\u4e0a\u3002\n\n\u6309\u4f4d\u4ece\u9ad8\u5230\u4f4e\u679a\u4e3e\uff0c\u52a0\u4e0a\u6700\u9ad8\u4f4d\u5c0f\u4e8e\u5f53\u524d\u4f4d\u7684\u6240\u6709\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u7684\u548c\u3002\n\n#### \u6ce8\u610f\uff0c\u8fd8\u8981\u52a0\u4e0a\u5df2\u7ecf\u786e\u5b9a\u7684\u4f4d\u6570\u4e58\u4e2a\u6570\u3002\n\n\u7279\u5224\u4e00\u4e0b\u4e0a\u754c\u662f\u5426\u6ee1\u8db3\u6761\u4ef6\u3002\n\n~~\u5168\u662f\u6570\u4f4dDP\u7684\u5957\u8def~~\n\n\u590d\u6742\u5ea6$O(t*10*2^{10}*len)$\n\n\u4ee3\u5165\u7b97\u4e00\u4e0b\uff0c$2*10^{8}$\u3002\n\n\u597d\u50cf$TLE$\u4e86\uff1f\uff1f\n\n$|S|$\u6216\u8005$|T|$\u53ea\u8981\u6709\u4e00\u4e2a\u4e0d\u4e3a\u7a7a\uff0c\u5c31\u53ea\u6709\u5c11\u4e8e$512$\u79cd\u96c6\u5408\u6ee1\u8db3\u6761\u4ef6\u4e86\uff01\n\n#### \u4e8e\u662f\u7279\u5224$|S|=|T|=0$\u7684\u60c5\u51b5\uff0c\u8f93\u51fa\u7b97\u6cd5\u4e8c\u7684\u7b54\u6848\uff0c\u5176\u4ed6\u65f6\u5019\u7528\u7b97\u6cd5\u4e09\uff0c~~\u5361\u5361\u5e38~~\u5c31\u8fc7\u4e86\u3002\n\n## \u6807\u7a0b\n\n```\n#include<cstdio>\n#include<cstring>\n#include<iostream>\nusing namespace std;\ntypedef long long ll;\ninline int read(){\n\tint res=0;char c=getchar(),f=1;\n\twhile(c<48||c>57){if(c=='-')f=0;c=getchar();}\n\twhile(c>=48&&c<=57)res=(res<<3)+(res<<1)+(c&15),c=getchar();\n\treturn f?res:-res;\n}\n\nint t,k,S,T,p[11];\nint l,r,g[11][1024][10],sumg[11][1024];\nll f[11][1024][10],sumf[11][1024];\nll dp(int x){\n\tint h=0,d[11];\n\tll res=0;\n\twhile(x)d[h++]=x%10,x/=10;\n\tfor(int i=0;i<h-1;++i)\n\t\tfor(int j=0;j<1024;++j)\n\t\t\tif((j&S)==S&&!(j&T))\n\t\t\t\tfor(int k=1;k<10;++k)\n\t\t\t\t\tres+=f[i][j][k];\n\tint now=0,num=0;\n\tfor(int i=h-1;~i;--i){\n\t\tfor(int j=0;j<1024;++j)\n\t\t\tif(((now|j)&S)==S&&!((now|j)&T))\n\t\t\t\tfor(int k=i==h-1?1:0;k<=(i==0?d[i]:d[i]-1);++k)\n\t\t\t\t\tres+=f[i][j][k]+(ll)g[i][j][k]*num;\n\t\tnow|=1<<d[i],num+=p[i]*d[i];\n\t}\n\treturn res;\n}\n\nint main(){\n\tp[0]=1;\n\tfor(int i=1;i<10;++i)p[i]=p[i-1]*10;\n\tfor(int i=0;i<10;++i){\n\t\tf[0][1<<i][i]=i;\n\t\tg[0][1<<i][i]=1;\n\t}\n\tfor(int i=0;i<10;++i)\n\t\tfor(int j=0;j<1024;++j){\n\t\t\tfor(int k=0;k<10;++k){\n\t\t\t\tsumf[i][j]+=f[i][j][k];\n\t\t\t\tsumg[i][j]+=g[i][j][k];\n\t\t\t}\n\t\t\tfor(int k=0;k<10;++k){\n\t\t\t\tf[i+1][j|(1<<k)][k]+=sumf[i][j]+(ll)sumg[i][j]*p[i+1]*k;\n\t\t\t\tg[i+1][j|(1<<k)][k]+=sumg[i][j];\n\t\t\t}\n\t\t}\n\t\n\tt=read();\n\twhile(t--){\n\t\tl=read(),r=read();\n\t\tS=T=0;\n\t\tk=read();\n\t\twhile(k--)S|=1<<read();\n\t\tk=read();\n\t\twhile(k--)T|=1<<read();\n\t\tif(!S&&!T){\n\t\t\tprintf(\"%lld\\n\",(ll)r*(r+1)/2-(ll)l*(l-1)/2);\n\t\t\tcontinue;\n\t\t}\n\t\tprintf(\"%lld\\n\",dp(r)-dp(l-1));\n\t}\n}\n```\n\n$Update$(2018.10.22)\n\n\u8fd8\u53ef\u4ee5\u901a\u8fc7\u524d\u7f00\u548c\u4f18\u5316\u5230$O(t*10*2^{10})$\n\n\u7279\u5224\u53ef\u4ee5\u4e0d\u7528\u4e86\u3002\u800c\u4e14$T$\u53ef\u4ee5\u51fa\u5230$5000$\n\n```\n#include<cstdio>\n#include<cstring>\n#include<iostream>\nusing namespace std;\ntypedef long long ll;\ninline int read(){\n    int res=0;\n    char c=getchar(),f=1;\n    while(c<48||c>57){if(c=='-')f=0;c=getchar();}\n    while(c>=48&&c<=57)res=(res<<3)+(res<<1)+(c&15),c=getchar();\n    return f?res:-res;\n}\n\nint t,k,S,T,p[11];\nint l,r,g[11][1024][10];\nll f[11][1024][10];\nll pref[11][1024][10],preg[11][1024][10];\nll dp(int x){\n    int h=0,d[11];\n    ll res=0;\n    while(x)d[h++]=x%10,x/=10;\n    for(int i=0;i<h-1;++i)\n        for(int j=0;j<1024;++j)\n            if((j&S)==S&&!(j&T))\n                res+=pref[i][j][9]-f[i][j][0];\n    int now=0,num=0;\n    for(int i=h-1;~i;--i){\n        for(int j=0,k;j<1024;++j)\n            if(((now|j)&S)==S&&!((now|j)&T)){\n                if(i==h-1)res-=f[i][j][0]+(ll)g[i][j][0]*num;\n                k=i==0?d[i]:d[i]-1;\n                if(~k)res+=pref[i][j][k]+(ll)preg[i][j][k]*num;\n            }\n        now|=1<<d[i],num+=p[i]*d[i];\n    }\n    return res;\n}\n\nint main(){\n    p[0]=1;\n    for(int i=1;i<10;++i)p[i]=p[i-1]*10;\n    for(int i=0;i<10;++i){\n        f[0][1<<i][i]=i;\n        g[0][1<<i][i]=1;\n    }\n    for(int i=0;i<10;++i)\n        for(int j=0;j<1024;++j){\n            for(int k=0;k<10;++k){\n                pref[i][j][k]=f[i][j][k];\n                preg[i][j][k]=g[i][j][k];\n                if(k){\n                    pref[i][j][k]+=pref[i][j][k-1];\n                    preg[i][j][k]+=preg[i][j][k-1];\n                }\n            }\n            for(int k=0;k<10;++k){\n                f[i+1][j|(1<<k)][k]+=pref[i][j][9]+(ll)preg[i][j][9]*p[i+1]*k;\n                g[i+1][j|(1<<k)][k]+=preg[i][j][9];\n            }\n        }\n\n    t=read();\n    while(t--){\n        l=read(),r=read();\n        S=T=0;\n        k=read();\n        while(k--)S|=1<<read();\n        k=read();\n        while(k--)T|=1<<read();\n        if(!S&&!T) {\n            printf(\"%lld\\n\",(ll)r*(r+1)/2-(ll)l*(l-1)/2);\n            continue;\n        }\n        printf(\"%lld\\n\",dp(r)-dp(l-1));\n    }\n}\n```\n\n## \u7b97\u6cd5\u56db\n\n\u9884\u5904\u7406\u6240\u6709\u96c6\u5408\u7684\u7b54\u6848\uff08\u7136\u800c\u597d\u50cf\u51fa\u4e86\u70b9\u9505\uff1f\uff09\n\n\u8be6\u89c1[2017sjb\u7684\u535a\u5ba2](https://www.luogu.org/blog/shanjingbo0221/T2-solution)\n",
        "postTime": 1539918556,
        "uid": 49260,
        "name": "fr200110217102",
        "ccfLevel": 9,
        "title": "DLYMOI\u6a21\u62df\u8d5b T2 \u5b8c\u7f8e\u6570\u5b57 \u9898\u89e3"
    }
]
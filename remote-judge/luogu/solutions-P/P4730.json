[
    {
        "content": "## \u300a\u6c5f\u96ea\u300b\u7cfb\u5217\u7b2c\u4e09\u9898\n\u8fd9\u9053\u9898\u53ef\u4ee5bfs\u505a\n\n\u4f60\u5efa\u7acb\u4e00\u4e2a\u65b0\u56fe\uff0c\u5148\u628a\u6bcf\u4e00\u5bf9\u53ef\u505c\u987f\u70b9(Pa,Pb)\u5f53\u505a\u65b0\u56fe\u4e00\u4e2a\u70b9\uff0c\u7136\u540e\u628adis(Pa,Pb)>Dmax\u548cdis(Pa,Pb)<Dmin\u7684\u70b9\u5224\u6389\uff0c\u518d\u628a\u53ef\u62b5\u8fbe\u7684\u70b9\u8fde\u8fb9\uff0c\u8fd9\u6837\u9898\u76ee\u5c31\u8f6c\u5316\u6210\u4e86\u4e00\u4e2a\u65b0\u95ee\u9898\uff1a\u7ed9\u4f60\u4e00\u4e2a\u65e0\u5411\u56fe\uff0c\u8fb9\u6743\u662f1\uff0c\u7ed9\u4f60\u4e00\u4e9b\u5173\u952e\u70b9\uff0c\u8ba9\u4f60\u6c42\u8ddd\u79bb\u6bcf\u4e00\u4e2a\u5173\u952e\u70b9\u6700\u77ed\u7684\u5173\u952e\u70b9\u3002\n\n\u7136\u540e\u6211\u4eec\u628a\u6240\u6709\u7684\u5173\u952e\u70b9push\u8fdb\u961f\u5217\u91ccbfs\uff0c\u53ef\u4ee5\u6c42\u51fa\u79bb\u6bcf\u4e2a\u70b9\u6700\u8fd1\u7684\u5173\u952e\u70b9\u8ddd\u79bbdis\uff0c\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u6bcf\u4e00\u6761\u8fb9,\u8bbe\u4ed6\u4e24\u7aef\u70b9\u662fx,y\u7136\u540e\u6211\u4eec\u5c31\u5206\u522b\u66f4\u65b0\u8ddd\u79bbx\uff0cy\u6700\u8fd1\u7684\u5173\u952e\u70b9\uff0c\u628a\u8fd9\u4e2a\u70b9\u7684\u7b54\u6848\u548cdis[x]+dis[y]\u53d6\u6700\u5c0f\u503c\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<vector>\n#include<cmath>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nint q[1010101],viss[1010101],dis[1010101],ans[1010101],x[10101],y[10101],a[10101],b[10101],type[10101],vis[1010101],u[1010101],v[1010101];\nvector<int>s[1010101];\nint n,k;\nvoid jiantu(int x,int y)\n{\n\tif(!vis[x]||!vis[y])\n\t\treturn;\n\ts[x].push_back(y);\n\ts[y].push_back(x);\n}\nint get_dis(int a,int b)\n{\n\treturn abs(x[a]-x[b])+abs(y[a]-y[b]);\n}\nint calc(int x,int y)\n{\n\treturn (x-1)*n+y;\n}\nvoid bfs()\n{\n\tint t,i,c,y,h,x;\n\th=0,t=0;\n\tfor(i=1;i<=k;i++)\n\t\tq[t++]=calc(u[i],v[i]),viss[calc(u[i],v[i])]=i,dis[calc(u[i],v[i])]=0;\n\twhile(h<t)\n\t{\n\t\tx=q[h++];\n\t\tc=s[x].size();\n\t\tfor(i=0;i<c;i++)\n\t\t{\n\t\t\ty=s[x][i];\n\t\t\tif(viss[y])\n\t\t\t\tcontinue;\n\t\t\tdis[y]=dis[x]+1;\n\t\t\tviss[y]=viss[x];\n\t\t\tq[t++]=y;\n\t\t}\n\t}\n}\nint main()\n{\n\tint m,mx,mn,di,i,j,kk,xx,yy;\n\tscanf(\"%d%d\",&n,&m);\n\tscanf(\"%d%d\",&mn,&mx);\n\tfor(i=1;i<=n;i++)\n\t\tscanf(\"%d%d\",&x[i],&y[i]);\n\tfor(i=1;i<=n;i++)\n\t{\n\t\tfor(j=1;j<=n;j++)\n\t\t{\n\t\t\tdi=get_dis(i,j);\n\t\t\tif(di<mn||di>mx)\n\t\t\t\tcontinue;\n\t\t\tvis[calc(i,j)]=1;\n\t\t}\n\t}\n\tscanf(\"%d\",&k);\n\tfor(i=1;i<=k;i++)\n\t\tscanf(\"%d%d\",&u[i],&v[i]),ans[i]=1000000007;\n\tfor(i=1;i<=m;i++)\n\t{\n\t\tscanf(\"%d%d%d\",&a[i],&b[i],&type[i]);\n\t\tif(type[i]==0)\n\t\t{\n\t\t\tfor(j=1;j<=n;j++)\n\t\t\t\tjiantu(calc(a[i],j),calc(b[i],j));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor(j=1;j<=n;j++)\n\t\t\t\tjiantu(calc(j,a[i]),calc(j,b[i]));\n\t\t}\n\t}\n\tfor(i=1;i<=m;i++)\n\t{\n\t\tfor(j=1;j<=m;j++)\n\t\t{\n\t\t\tif(type[i]==0&&type[j]==1)\n\t\t\t{\n\t\t\t\tjiantu(calc(a[i],a[j]),calc(b[i],b[j]));\n\t\t\t\tjiantu(calc(a[i],b[j]),calc(b[i],a[j]));\n\t\t\t}\n\t\t}\n\t}\n\t\n\tbfs();\n\tfor(i=1;i<=n;i++)\n\t\tfor(j=1;j<=m;j++)\n\t\t{\n\t\t\txx=calc(i,j);\n\t\t\tfor(kk=0;kk<s[xx].size();kk++)\n\t\t\t{\n\t\t\t\tyy=s[xx][kk];\n\t\t\t\tif(viss[xx]!=viss[yy])\n\t\t\t\t{\n\t\t\t\t\tans[viss[xx]]=min(ans[viss[xx]],dis[xx]+dis[yy]+1);\n\t\t\t\t\tans[viss[yy]]=min(ans[viss[yy]],dis[xx]+dis[yy]+1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\tfor(i=1;i<=k;i++)\n\t{\n\t\tif(ans[i]==1000000007)\n\t\t\tans[i]=-1;\n\t\tprintf(\"%d\\n\",ans[i]);\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1545204438,
        "uid": 26201,
        "name": "chaojidouding",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4730 \u3010\u5b64\u821f\u84d1\u7b20\u7fc1\u3011"
    }
]
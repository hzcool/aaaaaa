[
    {
        "content": "## [\u9898\u610f](https://blog.csdn.net/benoble_/article/details/80315131)\n\n$n$\u79cd\u679c\u6c41$,$\u7b2c$i$\u79cd\u679c\u6c41\u7684\u7f8e\u5473\u7a0b\u5ea6\u662f$d_i,$\u6709$l_i$\u5347$,$\u4ef7\u683c\u662f$p_i/$\u5347\n\n$m$\u4e2a\u8be2\u95ee$,$\u8981\u6c42\u4f7f\u7528\u679c\u6c41\u7684\u603b\u91cf\u4e0d\u5c0f\u4e8e$Lim,$\u4ef7\u683c\u4e0d\u8d85\u8fc7$G,$\u6700\u5927\u5316\u6240\u7528\u7684\u679c\u6c41\u7684\u7f8e\u5473\u7a0b\u5ea6\u6700\u5c0f\u503c\n\n---\n\n\u5148\u5f00\u6700\u7b80\u5355\u7684\u9898\n\n\u4f3c\u4e4e\u597d\u4e45\u6ca1\u5199$Blog$\u4e86$($\u5927\u96fe\n\n---\n\n## \u9898\u89e3\n\n\u9996\u5148\u628a$d$\u6392\u5e8f$,$\u679a\u4e3e\u4e00\u4e2a\u7b54\u6848$d,$\u90a3\u4e48\u6211\u4eec\u80af\u5b9a\u662f\u8d2a\u5fc3\u5730\u9009\u62e9\u7f8e\u5473\u7a0b\u5ea6\u4e0d\u5c0f\u4e8e$d$\u7684\u5e76\u4e14\u6700\u4fbf\u5b9c\u7684\u679c\u6c41\n\n\u53ef\u4ee5\u53d1\u73b0\u5176\u5177\u6709\u5355\u8c03\u6027$,$\u8003\u8651\u4e8c\u5206\u4e00\u4e2a$d,$\u7ed9\u7f8e\u5473\u7a0b\u5ea6\u4e0d\u5c0f\u4e8e$d$\u7684\u679c\u6c41\u5efa\u7acb\u4e00\u9897\u4ee5\u4ef7\u683c\u4e3a\u4e0b\u6807\u7684\u7ebf\u6bb5\u6811\n\n\u6bcf\u4e2a\u8282\u70b9\u8bb0\u5f55\u4e00\u4e0b\u679c\u6c41\u603b\u91cf\u548c\u4ef7\u683c\u548c$,$\u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u7ebf\u6bb5\u6811\u4e0a\u4e8c\u5206\u5f97\u5230$Lim$\u5bf9\u5e94\u7684\u4ef7\u683c\u4e86\n\n\u7136\u540e\u8fd9\u4e2a\u7ebf\u6bb5\u6811\u662f\u53ef\u4ee5\u5bf9$d$\u8fdb\u884c\u53ef\u6301\u4e45\u5316\u7684\n\n\u590d\u6742\u5ea6$O(n\\log^2n)$\n\n```\n#include<bits/stdc++.h>\n#define fp(i,a,b) for(register int i=a,I=b+1;i<I;++i)\n#define fd(i,a,b) for(register int i=a,I=b-1;i>I;--i)\n#define go(u) for(register int i=fi[u],v=e[i].to;i;v=e[i=e[i].nx].to)\n#define file(s) freopen(s\".in\",\"r\",stdin),freopen(s\".out\",\"w\",stdout)\ntemplate<class T>inline bool cmax(T&a,const T&b){return a<b?a=b,1:0;}\ntemplate<class T>inline bool cmin(T&a,const T&b){return a>b?a=b,1:0;}\nusing namespace std;\nchar ss[1<<17],*A=ss,*B=ss;\ninline char gc(){return A==B&&(B=(A=ss)+fread(ss,1,1<<17,stdin),A==B)?-1:*A++;}\ntemplate<class T>inline void sd(T&x){\n    char c;T y=1;while(c=gc(),(c<48||57<c)&&c!=-1)if(c==45)y=-1;x=c-48;\n    while(c=gc(),47<c&&c<58)x=x*10+c-48;x*=y;\n}\nchar sr[1<<21],z[20];int C=-1,Z;\ninline void Ot(){fwrite(sr,1,C+1,stdout),C=-1;}\ntemplate<class T>inline void we(T x){\n    if(C>1<<20)Ot();if(x<0)sr[++C]=45,x=-x;\n    while(z[++Z]=x%10+48,x/=10);\n    while(sr[++C]=z[Z],--Z);sr[++C]='\\n';\n}\nconst int N=1e5+5,M=1e5;\ntypedef int arr[N];\ntypedef long long ll;\nstruct Juice{\n    int d,p,l;\n    inline void init(){sd(d),sd(p),sd(l);}\n    inline bool operator<(const Juice b){return d<b.d;}\n}a[N];\nstruct Pt{int l,r;ll s,w;}tr[N*20];\nint n,m,pt;arr T;\nvoid ins(int&p,int L,int R,int x,int s,ll w){\n    tr[++pt]=tr[p],p=pt;tr[p].s+=s,tr[p].w+=w;\n    if(L==R)return;int mid=(L+R)>>1;\n    if(x<=mid)ins(tr[p].l,L,mid,x,s,w);\n    else ins(tr[p].r,mid+1,R,x,s,w);\n}\nll qry(int p,int L,int R,ll s){\n    if(L==R)return s*L;int mid=(L+R)>>1;\n    if(s<=tr[tr[p].l].s)return qry(tr[p].l,L,mid,s);\n    return tr[tr[p].l].w+qry(tr[p].r,mid+1,R,s-tr[tr[p].l].s);\n}\ninline int sol(){\n    ll G,Lim;sd(G),sd(Lim);\n    if(Lim>G)return -1;\n    int L=0,R=M,mid,tp=0;\n    while(L<=R){\n        mid=(L+R)>>1;\n        if(Lim<=tr[T[mid]].s&&qry(T[mid],0,M,Lim)<=G)tp=mid,L=mid+1;\n        else R=mid-1;\n    }return a[tp].d;\n}\nint main(){\n    #ifndef ONLINE_JUDGE\n        file(\"s\");\n    #endif\n    sd(n),sd(m);a[0].d=-1;\n    fp(i,1,n)a[i].init();\n    sort(a+1,a+n+1);\n    fd(i,n,1)ins(T[i]=T[i+1],0,M,a[i].p,a[i].l,(ll)a[i].p*a[i].l);\n    T[0]=T[1];while(m--)we(sol());\nreturn Ot(),0;\n}\n```",
        "postTime": 1526372755,
        "uid": 20156,
        "name": "Kelin",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P4602 \u3010[CTSC2018]\u6df7\u5408\u679c\u6c41\u3011"
    },
    {
        "content": "## \u9898\u89e3 P4602 \u3010[CTSC2018]\u6df7\u5408\u679c\u6c41\u3011\n\n[\u6d1b\u8c37\u9898\u9762\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4602)\n\n\u4e00\u773c\u5c31\u80fd\u770b\u51fa\uff0c\u8fd9\u9053\u9898\u53ef\u4ee5\u4e8c\u5206\u7b54\u6848\u3002\n\n\u5047\u8bbe\u4e8c\u5206\u51fa\u7684\u679c\u6c41\u6700\u5c0f\u7f8e\u5473\u503c\u662f $m$\uff0c\u5219\u6211\u4eec\u53ea\u8981\u8003\u8651\u7f8e\u5473\u503c $d_i\\geq m$ \u7684\u679c\u6c41\u5373\u53ef\u3002\u6240\u4ee5\u6211\u4eec\u60f3\u5230\u628a\u679c\u6c41\u6309\u7167 $d_i$ \u6392\u5e8f\uff0c\u8fd9\u6837\u6bcf\u6b21\u5c31\u4e0d\u7528\u4e00\u4e2a\u4e00\u4e2a\u679a\u4e3e\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u5c31\u8981\u60f3\u600e\u4e48 $\\mathrm{check}$ \u5c31\u597d\u4e86\u3002\u8d2a\u5fc3\u7684\u60f3\uff0c\u6211\u4eec\u5c31\u6309\u7167\u4ef7\u683c $p_i$ \u4ece\u5c0f\u5f80\u5927\u53d6\uff0c\u80af\u5b9a\u662f\u6700\u4f18\u7684\u3002\n\n\u6240\u4ee5\u5173\u952e\u95ee\u9898\u662f\u4ef7\u683c\uff0c\u518d\u770b\u6570\u636e\u8303\u56f4\uff0c\u53ea\u591f\u6211\u4eec\u518d\u52a0\u4e00\u4e2a $\\mathrm{logn}$\uff0c\u90a3\u6211\u4eec\u5c31\u80fd\u60f3\u5230\u6839\u636e\u4ef7\u683c\u5efa\u7acb\u6743\u503c\u7ebf\u6bb5\u6811\uff0c\u53c8\u56e0\u4e3a\u6211\u4eec\u8981\u67e5\u8be2\u7684\u90fd\u662f\u533a\u95f4\uff0c\u628a\u5b83\u4f18\u5316\u6210\u4e3b\u5e2d\u6811\uff0c\u5c31\u4f1a\u65b9\u4fbf\u8bb8\u591a\u3002\n\n\u73b0\u5728\uff0c\u6211\u4eec\u60f3\u5982\u4f55\u6309\u7167\u6211\u4eec\u7684\u8d2a\u5fc3\u601d\u8def\u5728\u4e3b\u5e2d\u6811\u4e0a\u67e5\u8be2\u3002\u5047\u8bbe\u6211\u4eec\u73b0\u5728\u5728\u8282\u70b9 $o$ \u4e0a\uff0c\u6211\u4eec\u80af\u5b9a\u4f18\u5148\u5148\u5f80\u5de6\u5b50\u6811\u8d70\uff0c\u56e0\u4e3a\u5de6\u5b50\u6811\u5bf9\u5e94\u7684\u4ef7\u683c\u66f4\u5c0f\u561b\u3002\u4f46\u6211\u4eec\u8fd8\u8981\u4fdd\u8bc1\u679c\u6c41\u6570\u91cf\u8981 $\\geq L$\u3002\u6240\u4ee5\uff0c\u8fd9\u4e2a\u95ee\u9898\u5c31\u6709\u70b9\u7c7b\u4f3c\u4e8e\u533a\u95f4\u7b2c $k$ \u5c0f\u7684\u95ee\u9898\u3002\u5982\u679c\u5de6\u5b50\u6811\u4e2d\u7684\u679c\u6c41\u6570\u91cf $\\gep L$\uff0c\u6211\u4eec\u5c31\u53bb\u5de6\u5b50\u6811\u627e\uff1b\u53cd\u4e4b\uff0c\u6211\u4eec\u8981\u53d6\u5b8c\u5de6\u5b50\u6811\u7684\u6240\u6709\u679c\u6c41\uff0c\u5e76\u628a\u5269\u4e0b\u7684\u679c\u6c41\u5e26\u5230\u53f3\u5b50\u6811\u4e2d\u627e\u5c31\u884c\u4e86\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u5728\u4e3b\u5e2d\u6811\u4e2d\u5c31\u8981\u5b58\u4e24\u4e2a\u4fe1\u606f\u3002\u4e00\u662f\u5bf9\u5e94\u533a\u95f4\u7684\u679c\u6c41\u6570\u91cf\uff0c\u800c\u662f\u5bf9\u5e94\u533a\u95f4\u679c\u6c41\u5168\u53d6\u7684\u4ef7\u683c\u3002\n\n\u6700\u540e\uff0c\u8d2a\u5fc3\u53d6\u51fa\u7684\u4ef7\u683c\u5982\u679c $\\leq g$\uff0c\u5e76\u4e14\u679c\u6c41\u6570\u91cf $\\geq L$\uff0c\u5c31\u662f\u5408\u6cd5\u7684\u3002\n\n\u4e0b\u9762\u662f AC \u4ee3\u7801\n\n```cpp\n/*\nluogu P4602\n*/\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n#define mid (l+r>>1)\n\nconst int N = 1e5;\n\nint n,q,ans;\nstruct juice{\n\tint d,p,m;\n\tbool operator < (const juice b) const\n\t{\n\t\treturn d>b.d;\n\t}\n}a[100005];\nint cnt,root[100005];\nstruct hjtree{\n\tint l,r,s,sum;\n}t[100005<<6];\n\nvoid insert(int &o,int pre,int l,int r,int x,int v)\n{\n\to = ++cnt;\n\tt[o] = t[pre];\n\tt[o].s += v, t[o].sum += x*v;\n\tif(l==x && r==x)\n\t\treturn;\n\tif(x<=mid)\n\t\tinsert(t[o].l,t[pre].l,l,mid,x,v);\n\telse\n\t\tinsert(t[o].r,t[pre].r,mid+1,r,x,v);\n}\n\nint query(int o,int l,int r,int k)\n{\n\tif(l==r)\n\t\treturn l*k;\n\tif(t[t[o].l].s>=k)\n\t\treturn query(t[o].l,l,mid,k);\n\telse\n\t\treturn t[t[o].l].sum+query(t[o].r,mid+1,r,k-t[t[o].l].s);\n}\n\nsigned main()\n{\n\tcin>>n>>q;\n\tfor(int i=1;i<=n;cin>>a[i].d>>a[i].p>>a[i].m,i++);\n\tsort(a+1,a+1+n);\n\tfor(int i=1;i<=n;i++)\n\t\tinsert(root[i],root[i-1],1,N,a[i].p,a[i].m);\n\twhile(q--)\n\t{\n\t\tint g,lim;\n\t\tcin>>g>>lim;\n\t\tans = -1;\n\t\tint l=1,r=n;\n\t\twhile(l<=r)\n\t\t{\n\t\t\tint res=query(root[mid],1,N,lim);\n\t\t\tif(res<=g && t[root[mid]].s>=lim)\n\t\t\t\tans = mid, r = mid-1;\n\t\t\telse\n\t\t\t\tl = mid+1;\n\t\t}\n\t\tcout<<(ans==-1 ? -1 : a[ans].d)<<endl;\n\t}\n}\n```\n\n\u795d\u5927\u5bb6 AC \u6109\u5feb\uff01",
        "postTime": 1599142030,
        "uid": 123298,
        "name": "kouylty",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4602 \u3010[CTSC2018]\u6df7\u5408\u679c\u6c41\u3011"
    },
    {
        "content": "\u4f3c\u4e4e\u6ca1\u6709\u601d\u8def\u4e00\u6837\u7684\u9898\u89e3\uff0c\u90a3\u4e48\u5c31\u6765\u5192\u4e2a\u6ce1\u5427\uff01\n\n### \u9898\u610f\n\u6709 $ N $ \u79cd\u7269\u54c1\uff0c\u6bcf\u79cd\u5404\u6709 $l_i $ \u4ef6\uff0c\u5355\u4ef7\u4e3a $ p_i $ \u5143\uff0c\u5355\u4ef6\u7f8e\u5473\u5ea6\u4e3a $ d_i $\u3002\u7ed9\u51fa $ M $ \u4e2a\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee\u7528\u81f3\u591a $ g_i $ \u5143\u4e14\u4e70\u5230 $ L_i $ \u4ef6\u7269\u54c1\u7684\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u7269\u54c1\u7684\u6700\u5c0f\u7f8e\u5473\u5ea6\u6700\u5927\u80fd\u4e3a\u591a\u5c11\u3002\n### \u524d\u7f6e\u59ff\u52bf\n\n\u6574\u4f53\u4e8c\u5206\uff0c\u4e00\u4e2a\u6bd4\u8f83\u597d\u7528\u7684\u5c0ftips\u3002\n\n\u6574\u4f53\u4e8c\u5206\u6307\u7684\u662f\u5bf9\u4e8e\u5355\u4e2a\u8be2\u95ee\u53ef\u4ee5\u7528\u4e8c\u5206\u7b54\u6848\u89e3\u51b3\u7684\u95ee\u9898\uff0c\u5c06\u6240\u6709\u7684\u8be2\u95ee\u653e\u5728\u4e00\u8d77\u4e8c\u5206\u7684\u65b9\u6cd5\u3002\u5982\u679c\u4e0d\u7406\u89e3\u7684\u8bdd\uff0c\u53ef\u4ee5\u5148\u53bb\u770b\u770bP1527\u3002\n### \u9898\u89e3\n\n\u9996\u5148\u8003\u8651\u4e00\u4e0b\u5355\u4e2a\u8be2\u95ee\u5e94\u8be5\u5982\u4f55\u89e3\u51b3\u3002\u6211\u4eec\u5c06\u6240\u6709\u7269\u54c1\u6309 $ d_i $ \u6392\u5e8f\uff0c\u4e8c\u5206\u7b54\u6848\u3002\u6bcf\u6b21 $ check $ \u7684\u65f6\u5019\u8d2a\u5fc3\u5730\u9009\u62e9 $ d_j \\ge mid $ \u4e14 $ p_j $ \u6700\u5c0f\u7684\u7269\u54c1\uff0c\u76f4\u5230\u8fbe\u6210\u8981\u6c42\u6216\u4f59\u989d\u4e0d\u8db3\u4e3a\u6b62\u3002\n\n\u8003\u8651\u4ee5\u5355\u4ef7\u4e3a\u4e0b\u6807\u5efa\u51fa\u7ebf\u6bb5\u6811\uff0c\u6bcf\u4e2a\u8282\u70b9\u4fdd\u5b58\u8be5\u8282\u70b9\u8868\u793a\u7684\u5355\u4ef7\u533a\u95f4\u4e2d\u6240\u6709\u7269\u54c1\u7684\u4ef6\u6570\u4e4b\u548c\u4ee5\u53ca\u8be5\u533a\u95f4\u4e2d\u7269\u54c1\u7684\u603b\u4ef7\u3002\u8fd9\u6837\uff0c\u6bcf\u6b21\u5355\u72ec\u4e8c\u5206\u7b54\u6848\u7684\u65f6\u5019\uff0c\u5c06\u6240\u6709\u7684\u53ef\u9009\u7269\u54c1\u63d2\u5165\u7ebf\u6bb5\u6811\uff0c\u5c31\u53ef\u4ee5\u8f6c\u5316\u4e3a\u5728\u7ebf\u6bb5\u6811\u4e0a\u4e8c\u5206\u8fdb\u884c $ check $ \u3002\n\n\u8f6c\u6362\u4e3a\u6574\u4f53\u4e8c\u5206\u7684\u65f6\u5019\uff0c\u8003\u8651\u7ef4\u62a4\u4e00\u68f5\u5168\u5c40\u7ebf\u6bb5\u6811\uff0c\u6bcf\u6b21\u6839\u636e\u5f53\u524d\u7684\u9650\u5236\u8c03\u6574\u7ebf\u6bb5\u6811\u4e2d\u5b58\u50a8\u7684\u8282\u70b9\uff0c\u5c31\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e00\u9898\u4e86\u3002\u4e00\u4e9b\u7ec6\u8282\u53ef\u4ee5\u53c2\u8003\u4ee3\u7801\u5b9e\u73b0\u3002\n### Code\n\n\u7801\u98ce\u4e11\u964b\uff0c\u671b\u8f7b\u55b7\u3002\n```cpp\n#include<bits/stdc++.h>\n#define reg register\nusing namespace std;\ntypedef long long ll;\nconst int MN=1e5;\nconst int inf=0x3f3f3f3f;\nstruct data{//\u7269\u54c1 \n\tint val,p,lim;\n\tfriend bool operator<(data a,data b){return a.val>b.val;}\n}a[MN+5];\nstruct ask{int id;ll p,v;}q[MN+5],t1[MN+5],t2[MN+5];//\u8be2\u95ee \nint n,m,cur,ans[MN+5];\n//\u7ebf\u6bb5\u6811 \nll tr[MN+5<<2],pri[MN+5<<2];\n#define mid (l+r>>1)\n#define ls (t<<1)\n#define rs (t<<1|1)\ninline void pushup(int t){tr[t]=tr[ls]+tr[rs];pri[t]=pri[ls]+pri[rs];}\nvoid update(int t,int l,int r,int pos,int v){//\u66f4\u65b0\u8282\u70b9 \n\tif(l==r){tr[t]+=v;pri[t]=1ll*l*tr[t];return;}\n\tif(pos<=mid)update(ls,l,mid,pos,v);\n\telse update(rs,mid+1,r,pos,v);pushup(t);\n}\nll query(int t,int l,int r,ll v){//\u7ebf\u6bb5\u6811\u4e0a\u4e8c\u5206 \n\tif(!v)return 0;//\u4f59\u989d\u4e0d\u8db3\uff0c\u5f53\u524d\u60c5\u51b5\u65e0\u89e3 \n\tif(l==r)return v*l;//\u533a\u95f4\u957f\u5ea6\u4e3a1\uff0c\u76f4\u63a5\u8fd4\u56de \n\tif(tr[ls]>=v)return query(ls,l,mid,v);//\u5de6\u534a\u8fb9\u4e0d\u80fd\u53d6\u5b8c \n\treturn pri[ls]+query(rs,mid+1,r,v-tr[ls]);//\u5de6\u534a\u8fb9\u53ef\u4ee5\u53d6\u5b8c \n}\nvoid solve(int l,int r,int a,int b){//\u6574\u4f53\u4e8c\u5206 \n\tif(l>r||a>b)return;reg int cnt1=0,cnt2=0;\n\tif(l==r){for(reg int i=a;i<=b;i++)ans[q[i].id]=::a[l].val;return;}//\u5f97\u5230\u7b54\u6848 \n\twhile(cur<mid)cur++,update(1,1,MN,::a[cur].p,::a[cur].lim);\n\twhile(cur>mid)update(1,1,MN,::a[cur].p,-::a[cur].lim),cur--;//\u8c03\u6574\u7269\u54c1 \n\tfor(reg int i=a;i<=b;i++)//\u5bf9\u4e8e\u6bcf\u4e2a\u7269\u54c1check \n\t\tif(q[i].v>tr[1])t2[++cnt2]=q[i];\n\t\telse if(query(1,1,MN,q[i].v)<=q[i].p)t1[++cnt1]=q[i];\n\t\telse t2[++cnt2]=q[i];\n\tfor(reg int i=1;i<=cnt1;i++)q[i+a-1]=t1[i];\n\tfor(reg int i=1;i<=cnt2;i++)q[i+a+cnt1-1]=t2[i];//\u5c06\u8be2\u95ee\u5206\u5230\u4e24\u8fb9 \n\tsolve(l,mid,a,a+cnt1-1);solve(mid+1,r,a+cnt1,b);//\u4e0b\u4e00\u5c42\u4e8c\u5206 \n}\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(reg int i=1;i<=n;i++)scanf(\"%d%d%d\",&a[i].val,&a[i].p,&a[i].lim);\n\tfor(reg int i=1;i<=m;i++)scanf(\"%lld%lld\",&q[i].p,&q[i].v),q[i].id=i;\n\ta[++n]=(data){-1,0,inf};//\u6dfb\u52a0\u4e00\u79cd\u65e0\u610f\u4e49\u7684\u7269\u54c1\u6765\u5904\u7406\u65e0\u89e3 \n\tsort(a+1,a+1+n);solve(1,n,1,m);\n\tfor(reg int i=1;i<=m;i++)printf(\"%d\\n\",ans[i]);\n\treturn 0;\n}\n```",
        "postTime": 1546580460,
        "uid": 17930,
        "name": "Marser",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4602 \u3010[CTSC2018]\u6df7\u5408\u679c\u6c41\u3011"
    },
    {
        "content": "\u54ea\u6765\u8fd9\u4e48\u591a\u4e8b\uff0c\u8fd9\u9898\u6570\u636e\u7ed3\u6784\u7528\u4e24\u4e2a\u666e\u901a\u7684\u6811\u72b6\u6570\u7ec4\u5c31\u884c\u4e86\u3002\n\n\u9996\u5148\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\u7b54\u6848\u662f\u53ef\u4ee5\u4e8c\u5206\u7684\uff0c\u4f46\u662f\u6bcf\u4e2a\u8be2\u95ee\u4e8c\u5206\u7684 check \u90fd\u662f\u7ebf\u6027\u7684\u3002  \n\u8003\u8651 check \u7684\u672c\u8d28\uff0c\u5b9e\u9645\u5c31\u662f\u5728\u7f8e\u5473\u5ea6\u4e0d\u5c0f\u4e8e mid \u7684\u679c\u6c41\u4e2d\u6309\u4ef7\u683c\u4ece\u4f4e\u5230\u9ad8\u9009\u5230\u4f53\u79ef\u6ee1\u8db3\u8981\u6c42\u3002  \n\u5047\u8bbe\u628a\u7f8e\u5473\u5ea6\u6ee1\u8db3\u8981\u6c42\u7684\u679c\u6c41\u6309\u4ef7\u683c\u6392\u5e8f\uff0c\u90a3\u4e48\u9009\u7684\u4e00\u5b9a\u662f\u6bb5\u8fde\u7eed\u533a\u95f4\uff0c  \n\u90a3\u4e48\u7ef4\u62a4\u524d\u7f00\u548c\u540e\u53ef\u4ee5\u4e8c\u5206\u6765 check \uff0c\u74f6\u9888\u5728\u4e8e\u6392\u5e8f\u548c\u524d\u7f00\u548c\u9884\u5904\u7406\u3002\n\n**\u6574\u4f53\u4e8c\u5206**\u53ef\u4ee5\u505a\u5230\u4e00\u8fb9\u4e8c\u5206\u7b54\u6848\u4e00\u8fb9\u7ef4\u62a4 check \u6240\u9700\u8981\u7684\u4fe1\u606f\u3002  \n\u5047\u8bbe\u5f53\u524d\u5728\u4e8c\u5206\u7b54\u6848 [L, R] \uff0c\u6b64\u65f6\u5df2\u7ecf\u5c06\u7f8e\u5473\u5ea6\u8d85\u8fc7 R \u7684\u63d0\u51fa\u6765\u5b58\u8fdb\u4e86\u6570\u636e\u7ed3\u6784\uff0c  \n\u59d1\u4e14\u8ba4\u4e3a\u5728\u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u91cc\u679c\u6c41\u6309\u4ef7\u683c\u6392\u597d\u4e86\u5e8f\u4e14\u7ef4\u62a4\u597d\u4e86\u524d\u7f00\u548c\u4fe1\u606f\u3002  \n\u8bbe M = (L + R + 1) / 2 \uff0c\u90a3\u4e48\u5c06\u7f8e\u5473\u5ea6\u5728 [M, R] \u7684\u679c\u6c41\u6254\u8fdb\u8be5\u6570\u636e\u7ed3\u6784\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u5b9e\u9645\u4e0a\u6811\u72b6\u6570\u7ec4\u5c31\u53ef\u4ee5\u4e86\uff0c\u4ee5\u4ef7\u683c\u4e3a\u4e0b\u6807\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <cstdio>\n#include <algorithm>\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n\ntypedef long long lolong;\ninline int input() { int x; scanf(\"%d\", &x); return x; }\ninline lolong linput() { lolong x; scanf(\"%lld\", &x); return x; }\n\nconst int maxn = 100005;\n\nstruct Juice {\n\tint d, p, l;\n};\nJuice ju[maxn];\n\nlolong qg[maxn], ql[maxn];\nint ans[maxn];\nint shit[maxn], shit_l[maxn], shit_r[maxn];\nlolong bit_p[maxn], bit_l[maxn];\n\ninline void add(int p, int l, int typ) {\n\tfor(int k = p; k < maxn; k += k & -k) {\n\t\tbit_p[k] += 1ll * p * l * typ;\n\t\tbit_l[k] += l * typ;\n\t}\n}\n\ninline lolong query_p(int p) {\n\tlolong res = 0;\n\tfor(int k = p; k; k -= k & -k)\n\t\tres += bit_p[k];\n\treturn res;\n}\n\ninline lolong query_l(int p) {\n\tlolong res = 0;\n\tfor(int k = p; k; k -= k & -k)\n\t\tres += bit_l[k];\n\treturn res;\n}\n\nbool cmp(Juice a, Juice b) {\n\treturn a.d < b.d;\n}\n\nvoid solve(int l, int r, int L, int R) {\n\tif(L == R) {\n\t\tfor(int i = l; i <= r; i ++)\n\t\t\tans[shit[i]] = ju[L].d;\n\t\tadd(ju[L].p, ju[L].l, 1);\n\t\treturn;\n\t}\n\n\tint M = (L + R + 1) >> 1;\n\n\tfor(int i = M; i <= R; i ++)\n\t\tadd(ju[i].p, ju[i].l, 1);\n\n\tint lp = 0, rp = 0;\n\n\tfor(int i = l; i <= r; i ++) {\n\t\tint id = shit[i];\n\n\t\tint ll = 0, rr = maxn - 1;\n\t\twhile(ll < rr) {\n\t\t\tint mid = (ll + rr) >> 1;\n\t\t\tif(query_l(mid) >= ql[id])\n\t\t\t\trr = mid;\n\t\t\telse\n\t\t\t\tll = mid + 1;\n\t\t}\n\n\t\tlolong now_l = query_l(ll), now_p = query_p(ll);\n\t\tif(now_l >= ql[id] and now_p - (now_l - ql[id]) * ll <= qg[id])\n\t\t\tshit_r[++ rp] = id;\n\t\telse\n\t\t\tshit_l[++ lp] = id;\n\t}\n\n\tfor(int i = 1; i <= lp; i ++)\n\t\tshit[l + i - 1] = shit_l[i];\n\tfor(int i = 1; i <= rp; i ++)\n\t\tshit[l + lp + i - 1] = shit_r[i];\n\n\tfor(int i = M; i <= R; i ++)\n\t\tadd(ju[i].p, ju[i].l, -1);\n\n\tsolve(l + lp, r, M, R);\n\tsolve(l, l + lp - 1, L, M - 1);\n}\n\nint main() {\n\tint n = input(), q = input();\n\n\tfor(int i = 1; i <= n; i ++) {\n\t\tju[i].d = input();\n\t\tju[i].p = input();\n\t\tju[i].l = input();\n\t}\n\n\tju[0].d = -1;\n\tju[0].p = 1;\n\tju[0].l = 1;\n\n\tstd::sort(ju, ju + n + 1, cmp);\n\n\tfor(int i = 1; i <= q; i ++) {\n\t\tqg[i] = linput();\n\t\tql[i] = linput();\n\t\tshit[i] = i;\n\t}\n\n\tsolve(1, q, 0, n);\n\n\tfor(int i = 1; i <= q; i ++)\n\t\tprintf(\"%d\\n\", ans[i]);\n}\n```",
        "postTime": 1568017472,
        "uid": 52232,
        "name": "Kewth",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P4602 \u3010[CTSC2018]\u6df7\u5408\u679c\u6c41\u3011"
    },
    {
        "content": "\u597d\u9898\u554a~~\u5dee\u70b9\u5c31\u505a\u51fa\u6765\u4e86\u6ca1\u60f3\u5230\u6392\u5e8f\u800c\u5df2~~\n\n\u663e\u7136\u7684\u4e8c\u5206\uff0c\u4e8c\u5206\u6700\u5927\u7f8e\u5473\u503c\u3002\n\n\u7136\u540e\u5c31\u4f1a\u53d1\u73b0\u4e00\u4e2a\u6709\u8da3\u7684\u4e8b\u60c5\uff1a\n\n\u5bf9\u4e8e\u4e00\u4e2a\u4e8c\u5206\u7684\u7b54\u6848$d$\uff0c\u53ea\u8981\u53d6$\\geq d\\ $\u7684\u679c\u6c41\u5c31\u53ef\u4ee5\u4e86\n\n\u8fd9\u91cc\u663e\u7136\u5c31\u6709\u4e00\u4e2a\u8d2a\u5fc3\uff1a\u4f18\u5148\u9009\u62e9\u7f8e\u5473\u5ea6$\\geq d\\ $\u4e14\u4ef7\u683c\u6700\u5c0f\u7684\u679c\u6c41\n\n\u95ee\u9898\u662f\u600e\u4e48\u5feb\u901f\u627e\u5230\u6211\u4eec\u8981\u7684\u6700\u5c0f\u4ef7\u683c\u679c\u6c41\u5462\uff1f\n\n\u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2a\u91cd\u8981\u7684\u9650\u5236\uff0c\u5c31\u662f\u9009\u62e9\u7684\u679c\u6c41\u7f8e\u5473\u5ea6\u5fc5\u987b$\\geq  d$\n\n\u6700\u5c0f\u4ef7\u683c\u679c\u6c41\u9009\u5b8c\u5c31\u8981\u9009\u62e9\u6b21\u5c0f\uff0c\u6b21\u6b21\u5c0f\u2026\u2026\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u6765\u8bb0\u5f55\u6240\u6709\u4ef7\u683c\u7684\u679c\u6c41\uff1f\uff1f\uff1f\n\n\u73b0\u5728\u5c31\u660e\u663e\u4e86\u2014\u2014\u6743\u503c\u7ebf\u6bb5\u6811\u3002\u5efa\u7acb\u4e00\u68f5\u4ee5\u4ef7\u683c\u4e3a\u4e0b\u6807\u7684\u6743\u503c\u7ebf\u6bb5\u6811\n\n\u4f46\u662f$\\geq d$ \u600e\u4e48\u529e\u5462$\\text{QAQ}$\n\n~~\u7136\u540e\u6211\u5c31\u4e0d\u4f1a\u4e86~~\n\n\u540e\u6765~~\u6253\u5f00\u9898\u89e3~~\u53d1\u73b0\u53ef\u4ee5\u628a\u6743\u503c\u7ebf\u6bb5\u6811\u53ef\u6301\u4e45\u5316\uff0c\u53d8\u6210\u4e00\u68f5\u4e3b\u5e2d\u6811\uff01\uff01\uff01\n\n\u4ec0\u4e48\u610f\u601d\u5462\uff1f\n\n\u5148\u628a\u6240\u6709\u679c\u6c41\u6309\u7167\u7f8e\u5473\u5ea6$d$\u6392\u4e2a\u5e8f\uff0c\u7136\u540e\u987a\u5e8f\u63d2\u5165\u4e3b\u5e2d\u6811\n\n\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8282\u70b9\u8bb0\u5f55\u6b64\u4ef7\u683c\u533a\u95f4\u5185\u6240\u6709\u679c\u6c41\u7684\u4f53\u79ef\u603b\u548c\u4ee5\u53ca\u8d2d\u4e70\u8fd9\u4e9b\u679c\u6c41\u7684\u4ef7\u683c\u548c\u3002\n\n\u56e0\u4e3a\u7b54\u6848\u7684\u7f8e\u5473\u5ea6\u8fd9\u4e2a\u6570\u503c\u5fc5\u5b9a\u51fa\u73b0\u5728\u4e00\u79cd\u679c\u6c41\u91cc\uff0c\u6240\u4ee5\u6211\u4eec\u6bcf\u4e00\u6b21\u4e8c\u5206\u4e00\u4e2a\u7b54\u6848\u6240\u5728\u679c\u6c41\u7684\u4f4d\u7f6e$mid$\u3002\n\n\u6ee1\u8db3\u6761\u4ef6\u7684\u679c\u6c41\u7ec4\u6210\u7684\u6743\u503c\u7ebf\u6bb5\u6811\u5c31\u662f\n\n$[\\ root[mid-1],root[n]\\ ]$\n\n\u76f4\u63a5\u4e8c\u5206\u8ba1\u7b97\u6700\u5c0f\u7b54\u6848(\u7c7b\u4f3c\u533a\u95f4\u7b2c$k$\u5c0f)\u5c31\u597d\u4e86\uff01\n\n\u5f53\u4f60\u4e8c\u5206\u5230\u4e00\u4e2a\u8282\u70b9\u662f\u65f6\uff0c\u8ba1\u7b97\u8fd9\u4e2a\u8282\u70b9\u5de6\u5b50\u6811\u53ef\u4ee5\u63d0\u4f9b\u7684\u6240\u6709\u4f53\u79ef\u3002\u5982\u679c\u8fd9\u4e9b\u4f53\u79ef\u591f\u7528\u4e86\u5219\u9012\u5f52\u8fdb\u5165\u5de6\u5b50\u6811\u7ee7\u7eed\u66f4\u65b0\uff08\u8d2a\u5fc3\uff09\uff0c\u5426\u5219\u5168\u90e8\u8d2d\u4e70\uff0c\u8fdb\u5165\u53f3\u5b50\u6811\u7ee7\u7eed\u66f4\u65b0\u3002\n\n\u600e\u4e48\u5224\u65ad\u7b54\u6848\u662f\u5426\u6ee1\u8db3\u6761\u4ef6\u5462\uff1f\n\n\u7b97\u51fa\u6700\u5c0f\u51d1\u9f50$L$\u4f53\u79ef\u7684\u82b1\u8d39\uff0c\u5224\u65ad\u662f\u5426 $\\leq G$ \u5373\u53ef\n\n\u5f53\u7136\u5982\u679c\u8fd9\u4e9b\u679c\u6c41\u603b\u4f53\u79ef\u5c0f\u4e8e$L$\u7684\u8bdd\u4e5f\u662f\u4e0d\u6ee1\u8db3\u7684\uff0c\u9700\u8981\u7279\u5224\u3002\n\n\u5982\u679c\u8fd8\u662f\u6709\u70b9\u4e0d\u7406\u89e3\u7684\u8bdd\u53ef\u4ee5\u770b\u770b\u4ee3\u7801\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```\n#include<bits/stdc++.h>\n#define maxn 100005\n#define ll long long\nusing namespace std;\ninline ll read(){\n    ll x=0,f=1;char ch=getchar();\n    while (!isdigit(ch)){if (ch=='-') f=-1;ch=getchar();};\n    while (isdigit(ch)){x=(x<<1)+(x<<3)+ch-48;ch=getchar();};\n    return x*f; \n}\nstruct juice{\n    ll d,p,l;\n}x[maxn];\ninline bool cmp(juice a,juice b){\n    return a.d<b.d;\n}\nint n,m,root[maxn],cnt;\nstruct node{\n    int l,r;\n    ll lit,W;//lit\u8bb0\u5f55\u533a\u95f4\u603b\u4f53\u79ef\uff0cW\u8bb0\u5f55\u8d2d\u4e70\u8fd9\u4e9b\u4f53\u79ef\u7684\u4ef7\u683c\n}g[maxn*21];\nvoid update(int &rt,int lb,int rb,ll P,ll LIT){//LIT\u8868\u793a\u52a0\u5165\u7684\u4f53\u79ef\uff0cP\u8868\u793a\u4ef7\u683c\n    g[++cnt]=g[rt];rt=cnt;g[rt].lit+=LIT;g[rt].W+=P*LIT;//\u4e3b\u5e2d\u6811\u90e8\u5206\n    if (lb==rb) return;\n    int mid=lb+rb>>1;\n    if (mid>=P) update(g[rt].l,lb,mid,P,LIT);\n    else update(g[rt].r,mid+1,rb,P,LIT);\n}\nll query(int i,int j,int lb,int rb,ll LIT){\n    if (lb==rb) return 1LL*LIT*lb;\n    int mid=lb+rb>>1;ll TOT=g[g[j].l].lit-g[g[i].l].lit;//\u5de6\u5b50\u6811\u7684\u6240\u6709\u4f53\u79ef\uff0c\u5982\u679c\u8fd9\u4e9b\u4f53\u79ef\u591f\u7528\u4e86\u9012\u5f52\u8fdb\u5165\u5de6\u5b50\u6811\uff08\u8d2a\u5fc3\uff09\uff0c\u5426\u5219\u5168\u90e8\u8d2d\u4e70\uff0c\u8fdb\u5165\u53f3\u5b50\u6811\u7ee7\u7eed\u66f4\u65b0\n    if (TOT>=LIT) return query(g[i].l,g[j].l,lb,mid,LIT);\n    return g[g[j].l].W-g[g[i].l].W+query(g[i].r,g[j].r,mid+1,rb,LIT-TOT);\n}\nsigned main(){\n    n=read(),m=read();\n    ll MAXP=0;//\u6700\u5927\u4ef7\u683c\uff0c\u4f5c\u4e3a\u4e3b\u5e2d\u6811\u4e0b\u6807\n    for (int i=1;i<=n;i++){\n        x[i].d=read(),x[i].p=read(),x[i].l=read();\n        MAXP=max(MAXP,x[i].p);\n    }\n    sort(x+1,x+1+n,cmp);//\u6392\u5e8f\n    for (int i=1;i<=n;i++){\n        root[i]=root[i-1];\n        update(root[i],1,MAXP,x[i].p,x[i].l);\n    }\n    while (m--){\n        ll G=read(),L=read();\n        ll lb=1,rb=n,ans=-1;\n        while (lb<=rb){\n            ll mid=lb+rb>>1;\n            if (query(root[mid-1],root[n],1,MAXP,L)<=G&&g[root[n]].lit-g[root[mid-1]].lit>=L){//\u4e8c\u5206\u6761\u4ef6\n                lb=mid+1;ans=mid;\n            }else{\n                rb=mid-1;\n            }\n        }\n        if (ans==-1) printf(\"-1\\n\");\n        else printf(\"%lld\\n\",x[ans].d);\n    }\n}\n```",
        "postTime": 1547646427,
        "uid": 20309,
        "name": "Fading",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4602 \u3010[CTSC2018]\u6df7\u5408\u679c\u6c41\u3011"
    },
    {
        "content": "\u6ce8\u610f\u5230\u95ee\u9898\u5177\u6709\u5355\u8c03\u6027\uff0c\u6240\u4ee5\u4e00\u4e2a\u8be2\u95ee\u53ef\u4ee5\u901a\u8fc7\u4e8c\u5206\u7b54\u6848\u6765\u89e3\u51b3\u3002\n\n\u5bf9\u4e8e\u591a\u7ec4\u8be2\u95ee\uff0c\u5c31\u91c7\u7528\u6574\u4f53\u4e8c\u5206\u6765\u5904\u7406\u3002\n\n\u5c06\u679c\u6c41\u6309$d$\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\uff0c\u4e8c\u5206\u51fa\u4e00\u4e2a\u4f4d\u7f6e$mid$\uff0c\u53ea\u8003\u8651\u5728\u4f4d\u7f6e$mid$\u4e4b\u524d\u7684\u679c\u6c41\uff0c\u5176\u4e2d\u4f4d\u7f6e$mid$\u7684\u679c\u6c41\u7684$d$\u5373\u4e3a\u4e8c\u5206\u51fa\u7684\u6240\u6709\u53c2\u4e0e\u6df7\u5408\u7684\u679c\u6c41\u7684\u7f8e\u5473\u5ea6\u7684\u6700\u5c0f\u503c\u3002\n\n\u5728\u5224\u65ad\u4e00\u4e2a$mid$\u5408\u4e0d\u5408\u6cd5\u65f6\uff0c\u5c06\u5176\u4e4b\u524d\u6240\u6709\u679c\u6c41\u7684\u4f53\u79ef\u7684\u524d\u7f00\u548c\u548c\u5404\u81ea\u7684\u4f53\u79ef\u4e58\u4ef7\u683c\u524d\u7f00\u548c\u5904\u7406\u51fa\u6765\uff0c\u540e\u8005\u5c31\u662f\u4e70\u4e0b\u6240\u6709\u679c\u6c41\u7684\u4ef7\u683c\u3002\n\n\u7136\u540e\u5bf9\u4e8e\u4e00\u4e2a\u8be2\u95ee\uff0c\u518d\u8fdb\u884c\u4e00\u6b21\u4e8c\u5206\uff0c\u627e\u5230\u6700\u5c0f\u7684\u4ef7\u683c\u6765\u6ee1\u8db3\u5176\u4f53\u79ef\u7684\u9700\u6c42\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u5224\u65ad\u4e00\u4e2a$mid$\u662f\u5426\u5408\u6cd5\u4e86\u3002\n\n\u5bf9\u4e8e\u524d\u7f00\u548c\u7684\u64cd\u4f5c\uff0c\u53ef\u4ee5\u901a\u8fc7\u6811\u72b6\u6570\u7ec4\u6765\u5b9e\u73b0\uff0c\u968f\u7740$mid$\u7684\u6539\u53d8\u8c03\u6574\u5373\u53ef\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u7ec6\u8282\u770b\u4ee3\u7801\u5427\u3002\n\n$code$\n\n```cpp\n#include<bits/stdc++.h>\n#define maxn 200010\n#define inf 1000000000000000000\n#define lowbit(x) (x&(-x))\nusing namespace std;\ntypedef long long ll;\ntemplate<typename T> inline void read(T &x)\n{\n    x=0;char c=getchar();bool flag=false;\n    while(!isdigit(c)){if(c=='-')flag=true;c=getchar();}\n    while(isdigit(c)){x=(x<<1)+(x<<3)+(c^48);c=getchar();}\n    if(flag)x=-x;\n}\nll n,m,now,ma;\nll ans[maxn];\nstruct node\n{\n    ll d,p,l;\n}t[maxn];\nbool cmp(const node &a,const node &b)\n{\n    return a.d>b.d;\n}\nstruct query\n{\n    ll g,l;\n    int id;\n}q[maxn],q1[maxn],q2[maxn];\nstruct Tree\n{\n    ll tr[maxn];\n    void update(int x,ll v)\n    {\n        while(x<=ma)\n            tr[x]+=v,x+=lowbit(x);\n    }\n    ll query(int x)\n    {\n        ll sum=0;\n        while(x)\n            sum+=tr[x],x-=lowbit(x);\n        return sum;\n    }\n}Li,Pr;\nvoid change(int x,int type)\n{\n    Li.update(t[x].p,type*t[x].l),Pr.update(t[x].p,type*t[x].p*t[x].l);\n}\nll find(int x)\n{\n    int l=1,r=ma,pr=ma;\n    while(l<=r)\n    {\n        int mid=(l+r)>>1;\n        if(Li.query(mid)>=q[x].l) pr=mid,r=mid-1;\n        else l=mid+1;\n    }\n    return pr;\n}\nvoid solve(int L,int R,int l,int r)\n{\n    if(L>R) return;\n    if(l==r)\n    {\n        for(int i=L;i<=R;++i) ans[q[i].id]=t[l].d;\n        return;\n    }\n    int mid=(l+r)>>1;\n    while(now<mid) change(++now,1);\n    while(now>mid) change(now--,-1);\n    int cnt1=0,cnt2=0;\n    for(int i=L;i<=R;++i)\n    {\n        ll pr=find(i),lv=Li.query(pr),pv=Pr.query(pr);\n        if(lv>=q[i].l&&pv-pr*(lv-q[i].l)<=q[i].g) q1[++cnt1]=q[i];\n        else q2[++cnt2]=q[i];\n    }\n    for(int i=1;i<=cnt1;++i) q[L+i-1]=q1[i];\n    for(int i=1;i<=cnt2;++i) q[L+cnt1+i-1]=q2[i];\n    solve(L,L+cnt1-1,l,mid),solve(L+cnt1,R,mid+1,r);\n}\nint main()\n{\n    read(n),read(m);\n    for(int i=1;i<=n;++i)\n        read(t[i].d),read(t[i].p),read(t[i].l),ma=max(ma,t[i].p);\n    t[++n].d=-1,t[n].p=1,t[n].l=inf,sort(t+1,t+n+1,cmp);\n    for(int i=1;i<=m;++i) read(q[i].g),read(q[i].l),q[i].id=i;\n    solve(1,m,1,n);\n    for(int i=1;i<=m;++i) printf(\"%lld\\n\",ans[i]);\n    return 0;\n}\n```",
        "postTime": 1585933861,
        "uid": 172489,
        "name": "lhm_",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4602 \u3010[CTSC2018]\u6df7\u5408\u679c\u6c41\u3011"
    },
    {
        "content": "[\u5b89\u5229\u6ce2$blog$](https://ctz45562.github.io/2019/03/17/%E9%A2%98%E8%A7%A3-%E6%B4%9B%E8%B0%B7-P4602-%E3%80%90-CTSC2018-%E6%B7%B7%E5%90%88%E6%9E%9C%E6%B1%81%E3%80%91/)\n\n[\u4f20\u9001\u95e8](https://www.luogu.org/problemnew/show/P4602)\n\n\u90fd\u8bf4\u662f$CTSC2018$\u6700\u6c34\u7684\u9898\u3002\u3002\u3002\u8fd8\u662f\u592a\u84bb\u4e86\u60f3\u4e86\u5f88\u957f\u65f6\u95f4\u3002\u3002\u3002$QAQ$\n\n\n\u8003\u8651\u4e00\u4e0b\u6734\u7d20\u7684\u89e3\u6cd5\uff1a\n\n\u5bf9$d_i$\u6392\u5e8f\uff0c\u5bf9$d_i$\u4e8c\u5206\u7b54\u6848\u3002\u56e0\u4e3a\u7b54\u6848\u53d6\u7684\u662f\u6700\u5c0f\u503c\uff0c\u6240\u4ee5\u6bd4\u5b83\u5927\u7684\u968f\u4fbf\u52a0\u3002$d_i$\u8d8a\u5c0f\u80fd\u52a0\u7684\u8303\u56f4\u5c31\u8d8a\u5927\uff0c\u7b54\u6848\u5177\u6709\u5355\u8c03\u6027\uff0c\u56e0\u6b64\u53ef\u4ee5\u4e8c\u5206\u3002\u7136\u540e\u5c3d\u53ef\u80fd\u628a\u6240\u6709\u8f83\u5c0f\u7684$p_i$\u52a0\u4e0a\uff0c\u770b\u770b\u52a0\u5230\u6700\u5927\u540e$\\sum l_i$\u662f\u5426\u6ee1\u8db3\uff0c\u4ee5\u6b64\u5224\u65ad\u4e8c\u5206\u8303\u56f4\u3002\n\n\u590d\u6742\u5ea6$O(n^2logn)$\n\n\u74f6\u9888\u5728\u4e8e\u9009\u53d6\u5c3d\u53ef\u80fd\u591a\u5f97\u9009\u53d6\u8f83\u5c0f\u7684$p_i$\u3002\u53ef\u4ee5\u53d1\u73b0\u5b83\u80fd\u7528\u4e3b\u5e2d\u6811\u7ef4\u62a4\u3002\u9996\u5148\u6309$p_i$\u6392\u5e8f\uff0c\u83b7\u53d6\u6bcf\u79cd\u679c\u6c41$p_i$\u7684\u6392\u540d\uff1b\u518d\u6309$d_i$\u6392\u5e8f\uff0c\u4f9d\u6b21\u6309\u7167$p_i$\u7684\u6392\u540d\u63d2\u5165\u4e3b\u5e2d\u6811\uff0c\u6bcf\u4e2a\u8282\u70b9\u7ef4\u62a4\u4e00\u4e0b$\\sum p_i*l_i$\uff08\u628a\u8fd9\u4e9b\u679c\u6c41\u5168\u52a0\u4e0a\u7684\u4ef7\u683c\uff09\u548c$\\sum l_i$\uff08\u8fd9\u4e9b\u679c\u6c41\u7684\u603b\u5bb9\u91cf\uff09\u3002\n\n\u67e5\u8be2\u65f6\uff0c\u5c3d\u53ef\u80fd\u628a\u5de6\u513f\u5b50\u9009\u4e0a\uff0c\u4e5f\u5c31\u662f\u53ea\u8981$\\sum p_i*l_i \\le g_j$\u5c31\u628a\u603b\u5bb9\u91cf\u52a0\u4e0a$\\sum l_i$\uff0c$g_j$\u51cf\u53bb$\\sum p_i*l_i$\uff0c\u8d70\u53f3\u513f\u5b50\u3002\u5f53\u7136\u53ef\u80fd\u51fa\u73b0\u9012\u5f52\u5230\u53f6\u5b50\u8282\u70b9\uff0c\u5269\u4f59\u7684$g_j$\u4e0d\u8db3\u4ee5\u5168\u52a0\u4e0a\u8fd9\u79cd\u679c\u6c41\uff0c\u5c3d\u53ef\u80fd\u591a\u52a0\uff0c\u5373\u8fd4\u56de$min\\{g_j/p_i,l_i\\}$\u3002\n\n\u603b\u4e4b\u90fd\u662f\u57fa\u4e8e\u8d2a\u5fc3\u601d\u60f3\u3002\u5176\u4ed6\u8fc7\u7a0b\u8fd8\u662f\u548c\u5f00\u59cb\u7684\u505a\u6cd5\u4e00\u6837\u3002\u65f6\u95f4\u590d\u6742\u5ea6$O(nlog^2n)$\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cmath>\n#include <cstring>\n\n#define maxn 100005\n#define inf 0x3f3f3f3f\n\nusing namespace std;\n\ninline int read(){\n\tint x=0,y=0;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')y=1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9')x=(x<<1)+(x<<3)+(ch^48),ch=getchar();\n\treturn y?-x:x;\n}\ntemplate<typename T>\ninline T read(){\n\tT x=0;\n\tint y=0;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')y=1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9')x=(x<<1)+(x<<3)+(ch^48),ch=getchar();\n\treturn y?-x:x;\n}\nint root[maxn];\nstruct Drink{\n\tint d,l,num;\n\tlong long p;\n}d[maxn];\nstruct Chairman_Tree{\n\tint ls[maxn<<5],rs[maxn<<5],cnt;\n\tlong long sum[maxn<<5],con[maxn<<5],p[maxn<<5];\n    //sum\u662fli*pi\u7684\u548c\uff0ccon\u662fli\u7684\u548c\uff0cp\u662f\u53f6\u5b50\u8282\u70b9\u7684pi\n#define ls(x) ls[x]\n#define rs(x) rs[x]\n\tvoid build(int poi,int l,int r,int &node,int ol,long long L,long long P){\n\t\tnode=++cnt;\n\t\tsum[node]=sum[ol]+L*P;\n\t\tcon[node]=con[ol]+L;\n\t\tif(l==r){\n\t\t\tp[node]=P;\n\t\t\treturn;\n\t\t}\n\t\tint mid=l+r>>1;\n\t\tif(poi<=mid)rs(node)=rs(ol),build(poi,l,mid,ls(node),ls(ol),L,P);\n\t\telse ls(node)=ls(ol),build(poi,mid+1,r,rs(node),rs(ol),L,P);\n\t}\n\tlong long ask(int l,int r,int node,long long g){\n\t\tif(l==r)return node?min((g/p[node]),con[node]):0;\n        //\u7a7a\u8282\u70b9\u6ce8\u610f\u5224\u65ad\u4e00\u4e0b\uff0c\u5426\u5219\u4f1a\u51fa\u73b0\u9664\u4ee50\u7684\u60c5\u51b5\n\t\tint mid=l+r>>1;\t\n\t\tif(sum[ls(node)]>g)return ask(l,mid,ls(node),g);\n        //\u5269\u4e0b\u7684\u94b1\u4e0d\u8db3\u4ee5\u5168\u52a0\u4e0a\uff0c\u8d70\u5de6\u513f\u5b50\n\t\telse return ask(mid+1,r,rs(node),g-sum[ls(node)])+con[ls(node)];\n        //\u4ed8\u5f97\u8d77\uff0c\u8d2a\u5fc3\u5168\u52a0\u4e0a\uff0c\u8d70\u53f3\u513f\u5b50\n\t}\n}ct;\ninline bool cmp1(Drink x,Drink y){\n\treturn x.p<y.p;\n}\ninline bool cmp2(Drink x,Drink y){\n\treturn x.d>y.d;\n}\nint main(){\n\tint n=read(),m=read();\n\tfor(register int i=1;i<=n;++i)\n\t\td[i].d=read(),d[i].p=read<long long>(),d[i].l=read();\n\tsort(d+1,d+1+n,cmp1);//\u6309pi\u6392\u5e8f\n\tfor(register int i=1;i<=n;++i)\n\t\td[i].num=i;//\u83b7\u53d6\u6392\u540d\n\tsort(d+1,d+1+n,cmp2);//\u6309di\u6392\u5e8f\n\tfor(register int i=1;i<=n;++i)\n\t\tct.build(d[i].num,1,n,root[i],root[i-1],d[i].l,d[i].p);\n    //\u4ee5pi\u7684\u6392\u540d\u5efa\u6811\n\tint l,r;\n\twhile(m--){\n\t\tlong long g=read<long long>(),L=read<long long>();\n\t\tint ans=-1;\n\t\tl=1,r=n;\n\t\twhile(l<=r){\n\t\t\tint mid=l+r>>1;\n\t\t\tlong long k=ct.ask(1,n,root[mid],g);\n\t\t\tif(k>=L)ans=d[mid].d,r=mid-1;\n\t\t\telse l=mid+1;\n\t\t}\n\t\tprintf(\"%d\\n\",ans);\n\t}\n}\n\n```\n\n",
        "postTime": 1552791494,
        "uid": 111762,
        "name": "_ctz",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4602 \u3010[CTSC2018]\u6df7\u5408\u679c\u6c41\u3011"
    },
    {
        "content": "\u6765\u53d1\u4e00\u4e2a\u4e0d\u540c\u7684\u3002\n\n## \u6574\u4f53\u4e8c\u5206\n\n\u89c2\u5bdf\u53ef\u4ee5\u53d1\u73b0\uff0c\u7b54\u6848\u660e\u663e\u5177\u6709\u5355\u8c03\u6027\u3002\u4f46\u662f\u4e00\u4e2a\u4e2a\u6765\u4e8c\u5206\u7684\u8bdd\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(n^2log^2n)$\u7684\uff0c\u660e\u663e\u65e0\u6cd5\u901a\u8fc7\u6b64\u9898\u3002\u6240\u4ee5\u8003\u8651\u6574\u4f53\u4e8c\u5206\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u964d\u4e3a$O(nlog^2n)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\n\n\u6ce8\u610f\u4e00\u4e0b\uff0c\u6bcf\u6b21\u90fd\u5c06\u5de6\u7aef\u70b9\u5230\u6700\u53f3\u8fb9\u6392\u5e8f\u7684\u8bdd\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4f1a\u53d8\u6210$O(n^2log^2n)$\uff0c\u76f4\u63a5\u6302\u6210$60pts$\u3002\u8003\u8651\u7528\u4e00\u4e2a$multiset$\u7ef4\u62a4\u679c\u6c41\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u53ef\u4ee5\u4fdd\u8bc1\u3002\n\n\u4ee3\u7801:\n\n```cpp\n#include<bits/stdc++.h>\n#include<ext/pb_ds/assoc_container.hpp>\n#define Rep(i,a,b) for(register int i=(a),i##end=(b);i<=i##end;++i)\n#define Repe(i,a,b) for(register int i=(a),i##end=(b);i>=i##end;--i)\n#define For(i,a,b) for(i=(a),i<=(b);++i)\n#define Forward(i,a,b) for(i=(a),i>=(b);--i)\ntemplate<typename T>inline void read(T &x)\n{\n    T f=1;x=0;char c;\n    for(c=getchar();!isdigit(c);c=getchar())if(c=='-')f=-1;\n    for(;isdigit(c);c=getchar())x=x*10+(c^48);\n    x*=f;\n}\nusing namespace std;\nvoid file()\n{\n#ifndef ONLINE_JUDGE\n    freopen(\"water.in\",\"r\",stdin);\n    freopen(\"water.out\",\"w\",stdout);\n#endif\n}\n\nconst int MAXN=1e5+7;\n\nstatic int n,m;\n\nstatic struct juice\n{\n    int d;\n    long long p,l;\n}p[MAXN];\n\ninline bool cmp1(juice a,juice b){return a.d<b.d;}\n\nstatic struct boy\n{\n    long long g,l;\n    int id;\n}q[MAXN],ret[MAXN];\n\ninline bool cmp2(boy a,boy b){return a.g<b.g;}\n\ninline void init()\n{\n    read(n);read(m);\n    Rep(i,1,n)read(p[i].d),read(p[i].p),read(p[i].l);\n    p[n+1].d=-1;p[n+1].p=0;p[n+1].l=1e18;++n;\n    sort(p+1,p+n+1,cmp1);\n    Rep(i,1,m)read(q[i].g),read(q[i].l),q[i].id=i;\n}\n\nstatic int ans[MAXN],pos;\n\ntypedef pair<long long,int>Pr;\n\nstatic multiset<Pr>K;\n\nstatic multiset<Pr>::iterator it;\n\nvoid div(int l,int r,int x,int y)\n{\n    if(x>y)return;\n    if(l==r){Rep(i,x,y)ans[q[i].id]=p[l].d;return;}\n    static int mid,lp,rp;mid=(l+r)>>1,lp=x,rp=y;\n    static long long sm,cost;sm=0,cost=0;\n    sort(q+x,q+y+1,cmp2);\n    while(pos>mid+1)--pos,K.insert(Pr(p[pos].p,p[pos].l));\n    while(pos<mid+1)K.erase(K.lower_bound(Pr(p[pos].p,p[pos].l)))\n        ,++pos;\n    it=K.begin();\n    Rep(i,x,y)\n    {\n        while(it!=K.end()&&cost+it->first*it->second<=q[i].g)\n            cost+=it->first*it->second,sm+=it->second,++it;\n        //cerr<<sm<<' '<<cost<<' '<<q[i].l<<' '<<q[i].g<<endl;\n        if(q[i].l<=sm||it!=K.end()\n            &&sm+(q[i].g-cost)/it->first>=q[i].l)\n                ret[rp--]=q[i];\n        else ret[lp++]=q[i];\n    }\n    Rep(i,x,y)q[i]=ret[i];\n    div(mid+1,r,lp,y);\n    div(l,mid,x,lp-1);\n}\n\ninline void solve()\n{\n    pos=n+1;div(1,n,1,m);\n    Rep(i,1,m)printf(\"%d\\n\",ans[i]);\n}\n\nint main()\n{\n    file();\n    init();\n    solve();\n    //cerr<<1.0*clock()/CLOCKS_PER_SEC<<endl;\n    return 0;\n}\n\n\n```",
        "postTime": 1526470657,
        "uid": 7035,
        "name": "Great_Influence",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4602 \u3010[CTSC2018]\u6df7\u5408\u679c\u6c41\u3011"
    },
    {
        "content": "[LOJ \u9898\u76ee\u94fe\u63a5](https://loj.ac/problem/2555) & [\u6d1b\u8c37\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/P4602)\n\n> \u9898\u610f\uff1a\u5546\u5e97\u91cc\u6709 $n$ \u676f\u679c\u6c41\uff0c\u7b2c $i$ \u676f\u679c\u6c41\u6709\u7f8e\u5473\u5ea6 $d_i$\uff0c\u5355\u4ef7\u4e3a $p_i$ \u5143/\u5347\u3002\u6700\u591a\u53ef\u4ee5\u6dfb\u52a0 $l_i$ \u5347\u3002\u6709 $m$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u7ed9\u51fa\u4e24\u4e2a\u6570 $G,L$\uff0c\u4f60\u53ef\u4ee5\u5c06\u5546\u5e97\u91cc\u7684\u4e00\u4e9b\u679c\u6c41\u6df7\u5408\u8d77\u6765\uff0c\u4f7f\u5f97\u4ed6\u4eec\u7684\u603b\u4f53\u79ef\u4e0d\u5c0f\u4e8e $L$ \u5347\uff0c\u603b\u4ef7\u683c\u4e0d\u8d85\u8fc7 $G$ \u5143\uff0c\u95ee\uff1a\u9009\u62e9\u7684\u679c\u6c41\u4e2d\u7f8e\u5473\u5ea6\u6700\u5c0f\u503c\u7684\u6700\u5927\u503c\u662f\u591a\u5c11\u3002\n\n> $1 \\leq n,m \\leq 10^5$\uff0c$1 \\leq d_i,p_i,l_i \\leq 10^5$\n\n\u770b\u5230\u8fd9\u79cd\u201c\u6700\u5c0f\u503c\u6700\u5927\u201d\u7684\u5b57\u773c\uff0c\u7b2c\u4e00\u53cd\u5e94\u5e94\u8be5\u662f\u4e8c\u5206\u5427\uff08\n\n\u5c06 $d$ \u6570\u7ec4\u6392\u4e2a\u5e8f\uff0c\u4e8c\u5206\u51fa $mid$\uff0c\u663e\u7136\u6211\u4eec\u53ea\u80fd\u53d6 $d_i \\geq mid$ \u7684\u679c\u6c41\u3002\n\n\u6839\u636e\u8d2a\u5fc3\u7684\u7b56\u7565\uff0c\u6211\u4eec\u80af\u5b9a\u5148\u53d6\u5355\u4ef7\u6700\u5c0f\u7684\u679c\u6c41\uff0c\u7528 $min(l_i,L)$ \u5347\u4f53\u79ef\u505a\u6210\u6df7\u5408\u679c\u6c41\uff0c\u9700\u8981 $p_i \\times min(l_i,L)$ \u5143\u7684\u4ee3\u4ef7\uff0c\u5982\u679c\u8fd8\u6709\u5269\u4f59\u7684\u4f53\u79ef\u5c31\u53d6\u5355\u4ef7\u7b2c\u4e8c\u5c0f\u7684\u679c\u6c41\uff0c\u5982\u679c\u8fd8\u6709\u5c31\u53d6\u7b2c\u4e09\u5c0f\u7684\uff0c\u4ee5\u6b64\u7c7b\u63a8\u2026\u2026\n\n\u7136\u540e\u6211\u5c31\u6b7b\u5728\u4e86\u8fd9\u4e2a\u5730\u65b9\uff0c\u8fd8\u662f\u592a\u83dc\u4e86\u554a qwq\uff08\n\n\u6211\u4eec\u8003\u8651\u4ee5\u5355\u4ef7\u4e3a\u4e0b\u6807\u5efa\u4e00\u68f5\u6743\u503c\u7ebf\u6bb5\u6811\uff0c\u6bcf\u4e2a\u8282\u70b9\u4e0a\u7ef4\u62a4\u4e24\u4e2a\u503c\uff0c$sum$ \u8868\u793a\u4ef7\u683c\u5728 $[l,r]$ \u533a\u95f4\u4e2d\u6240\u6709\u679c\u6c41\u7684\u4f53\u79ef\u4e4b\u548c\uff0c$cst$ \u8868\u793a\u4ef7\u683c\u5728 $[l,r]$ \u4e2d\u6240\u6709\u679c\u6c41\u7684\u5355\u4ef7\u4e0e\u4f53\u79ef\u7684\u4e58\u79ef\u4e4b\u548c\u3002\n\n\u6bcf\u6b21\u6211\u4eec\u4ece\u6839\u8282\u70b9\u5f00\u59cb\uff0c\u5982\u679c $L$ \u4e0d\u8d85\u8fc7\u5de6\u5b50\u6811\u7684 $sum$ \u503c\uff0c\u9012\u5f52\u5de6\u5b50\u6811\uff0c\u5426\u5219\u7b54\u6848\u52a0\u4e0a\u53f3\u5b50\u6811\u7684\u4ee3\u4ef7\u518d\u9012\u5f52\u53f3\u5b50\u6811\u3002\n\n\u7531\u4e8e $mid$ \u503c\u4e0d\u786e\u5b9a\uff0c\u9700\u8981\u53ef\u6301\u4e45\u5316\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $n\\log^2n$\u3002\n\u6ce8\u610f\u4e8b\u9879\uff1a\u9700\u8981\u5224\u603b\u4f53\u79ef\u662f\u5426 $\\geq L$ \u5347\u3002\n\n\u6700\u540e\u662f\u4ee3\u7801\uff1a\n\n```cpp\n//Coded by tzc_wk\n/*\n\u6570\u636e\u4e0d\u6e05\u7a7a\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u591a\u6d4b\u4e0d\u8bfb\u5b8c\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8fb9\u754c\u4e0d\u7279\u5224\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8d2a\u5fc3\u4e0d\u8bc1\u660e\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\nD P \u987a\u5e8f\u9519\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u5927\u5c0f\u5c11\u7b49\u53f7\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u53d8\u91cf\u4e0d\u7edf\u4e00\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8d8a\u754c\u4e0d\u5224\u65ad\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8c03\u8bd5\u4e0d\u6ce8\u91ca\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u6ea2\u51fa\u4e0d l l\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n*/\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi\t\t\tfirst\n#define se\t\t\tsecond\n#define fz(i,a,b)\tfor(int i=a;i<=b;i++)\n#define fd(i,a,b)\tfor(int i=a;i>=b;i--)\n#define foreach(it,v) for(__typeof(v.begin()) it=v.begin();it!=v.end();it++)\n#define all(a)\t\ta.begin(),a.end()\n#define giveup(...) return printf(__VA_ARGS__),0;\n#define fill0(a)\tmemset(a,0,sizeof(a))\n#define fill1(a)\tmemset(a,-1,sizeof(a))\n#define fillbig(a)\tmemset(a,0x3f,sizeof(a))\n#define fillsmall(a) memset(a,0xcf,sizeof(a))\n#define mask(a)\t\t(1ll<<(a))\n#define maskx(a,x)\t((a)<<(x))\n#define _bit(a,x)\t(((a)>>(x))&1)\n#define _sz(a)\t\t((int)(a).size())\n#define filei(a)\tfreopen(a,\"r\",stdin);\n#define fileo(a)\tfreopen(a,\"w\",stdout);\n#define fileio(a) \tfreopen(a\".in\",\"r\",stdin);freopen(a\".out\",\"w\",stdout)\n#define eprintf(...) fprintf(stderr,__VA_ARGS__)\n#define put(x)\t\tputchar(x)\n#define eoln        put('\\n')\n#define space\t\tput(' ')\n#define y1\t\t\ty_chenxiaoyan_1\n#define y0\t\t\ty_chenxiaoyan_0\n#define int long long\ntypedef pair<int,int> pii;\ninline int read(){\n\tint x=0,neg=1;char c=getchar();\n\twhile(!isdigit(c)){\n\t\tif(c=='-')\tneg=-1;\n\t\tc=getchar();\n\t}\n\twhile(isdigit(c))\tx=x*10+c-'0',c=getchar();\n\treturn x*neg;\n}\ninline void print(int x){\n\tif(x<0){\n\t\tputchar('-');\n\t\tprint(abs(x));\n\t\treturn;\n\t}\n\tif(x<=9)\tputchar(x+'0');\n\telse{\n\t\tprint(x/10);\n\t\tputchar(x%10+'0');\n\t}\n}\ninline int qpow(int x,int e,int _MOD){\n\tint ans=1;\n\twhile(e){\n\t\tif(e&1)\tans=ans*x%_MOD;\n\t\tx=x*x%_MOD;\n\t\te>>=1;\n\t}\n\treturn ans;\n}\nint n=read(),m=read();\nint key[100005],hs[100005],cntt;\nstruct juice{\n\tint d,p,l;\n\tjuice(){/*ycxakioi*/}\n\tjuice(int _d,int _p,int _l){\n\t\td=_d;p=_p;l=_l;\n\t}\n\tfriend bool operator <(juice a,juice b){\n\t\treturn a.d<b.d;\n\t}\n} a[100005];\nstruct node{\n\tint l,r,ch[2],sum,cst;\n} s[100005<<5];\nint ncnt=0,rt[100005];\ninline void build(int &k,int l,int r){\n\tk=++ncnt;s[k].l=l;s[k].r=r;\n\tif(l==r)\treturn;\n\tint mid=(l+r)>>1;\n\tbuild(s[k].ch[0],l,mid);\n\tbuild(s[k].ch[1],mid+1,r);\n}\ninline void update(int &k,int pre,int p,int l){\n\tk=++ncnt;s[k]=s[pre];\n\tif(s[k].l==s[k].r){\n\t\ts[k].sum+=l;\n\t\ts[k].cst+=hs[p]*l;\n\t\treturn;\n\t}\n\tint mid=(s[k].l+s[k].r)>>1;\n\tif(p<=mid)\tupdate(s[k].ch[0],s[pre].ch[0],p,l);\n\telse\t\tupdate(s[k].ch[1],s[pre].ch[1],p,l);\n\ts[k].sum=s[s[k].ch[0]].sum+s[s[k].ch[1]].sum;\n\ts[k].cst=s[s[k].ch[0]].cst+s[s[k].ch[1]].cst;\n}\ninline bool check(int mid,int g,int l){\n\tif(s[rt[mid]].sum<l)\treturn 0;\n\tint cur=rt[mid];\n\twhile(1){\n\t\tif(s[cur].l==s[cur].r){\n\t\t\tg-=hs[s[cur].l]*l;\n\t\t\tbreak;\n\t\t}\n\t\tif(l<=s[s[cur].ch[0]].sum){\n\t\t\tcur=s[cur].ch[0];\n\t\t}\n\t\telse{\n\t\t\tl-=s[s[cur].ch[0]].sum;\n\t\t\tg-=s[s[cur].ch[0]].cst;\n\t\t\tcur=s[cur].ch[1];\n\t\t}\n\t}\n\treturn g>=0;\n}\nsigned main(){\n\tfz(i,1,n)\ta[i].d=read(),a[i].p=read(),a[i].l=read(),key[i]=a[i].p;\n\tsort(key+1,key+n+1);\n\tsort(a+1,a+n+1);\n\tfz(i,1,n)\tif(key[i]!=key[i-1])\ths[++cntt]=key[i];\n\tfz(i,1,n)\ta[i].p=lower_bound(hs+1,hs+cntt+1,a[i].p)-hs;\n\tbuild(rt[n+1],1,cntt);\n\tfd(i,n,1)\tupdate(rt[i],rt[i+1],a[i].p,a[i].l);\n\ta[0].d=-1;\n\twhile(m--){\n\t\tint g=read(),l=read();\n\t\tint L=1,R=n,ans=0;\n\t\twhile(L<=R){\n\t\t\tint mid=(L+R)>>1;\n\t\t\tif(check(mid,g,l))\tans=mid,L=mid+1;\n\t\t\telse\t\t\t\tR=mid-1;\n\t\t}\n\t\tcout<<a[ans].d<<endl;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1587567507,
        "uid": 123543,
        "name": "ET2006",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4602 \u3010[CTSC2018]\u6df7\u5408\u679c\u6c41\u3011"
    },
    {
        "content": "# \u6574\u4f53\u4e8c\u5206\n\n\u770b\u5230\u591a\u4e2a\u8be2\u95ee\u548c\u6700\u5c0f\u503c\u7684\u6700\u5927\u503c\u5e94\u8be5\u53ef\u4ee5\u9a6c\u4e0a\u60f3\u5230\u6574\u4f53\u4e8c\u5206~~\u5427~~\n\n\u6211\u4eec\u628a\u679c\u6c41\u6309\u7167\u7f8e\u5473\u5ea6**\u4ece\u5927\u5230\u5c0f**\u6392\u5e8f\uff0c\u4e8c\u5206\u7f8e\u5473\u5ea6\uff0c\u7136\u540e\u628a\u5927\u4e8e\u8fd9\u4e2a\u7f8e\u5473\u5ea6\u7684\u679c\u6c41\u90fd\u53d6\u51fa\u6765\uff0c\u7136\u540e\u53ea\u9700\u8981\u8003\u8651\u7528\u8fd9\u4e9b\u679c\u6c41\u80fd\u6df7\u5408\u51fa\u7684\u4f53\u79ef\u8db3\u591f\u3001\u4ef7\u683c\u6700\u5c0f\u7684\u679c\u6c41\u80fd\u5426\u6ee1\u8db3\u8981\u6c42\u5373\u53ef\n\n\u4e00\u4e2a\u663e\u7136\u7684\u8d2a\u5fc3\uff1a\u6bcf\u6b21\u9009\u62e9\u4ef7\u683c\u6700\u5c0f\u7684\u679c\u6c41\uff0c\u76f4\u5230\u4f53\u79ef\u6ee1\u8db3\u8981\u6c42\n\n\u6211\u4eec\u628a\u88ab\u53d6\u51fa\u6765\u7684\u679c\u6c41\u653e\u5230\u4e00\u4e2a\u5e73\u8861\u6811\u4e2d\uff0c\u7136\u540e\u628a\u6240\u6709\u8be2\u95ee\u6309\u7167L\u6392\u5e8f\uff0c\u7136\u540e\u4e24\u4e2a\u6307\u9488\u5f80\u540e\u626b\u5373\u53ef\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(nlog^3 n)$\n\n```python\nwhile \u4e4b\u524d\u7d2f\u79ef\u7684\u679c\u6c41\u4f53\u79ef + \u5f53\u524d\u679c\u6c41\u4f53\u79ef < L\n\t\u52a0\u5165\u5f53\u524d\u679c\u6c41\n    \u679c\u6c41\u7684\u6307\u9488\u5411\u540e\u79fb\nif \u679c\u6c41\u4f53\u79ef\u4e0d\u591f\n\t\u653e\u5165\u53f3\u8fb9\u4e8c\u5206\nif \u4e4b\u524d\u7d2f\u79ef\u7684\u679c\u6c41\u4ef7\u683c + \u8fd8\u9700\u679c\u6c41\u4f53\u79ef * \u5f53\u524d\u679c\u6c41\u4ef7\u683c <= g\n\t\u653e\u5165\u5de6\u8fb9\u4e8c\u5206\nelse\n\t\u653e\u5165\u53f3\u8fb9\u4e8c\u5206\n```\n\n## \u5173\u4e8e\u5e73\u8861\u6811\n\n\u5e73\u8861\u6811\u8fd9\u91cc\u53ef\u80fd\u4f1a\u51fa\u5f88\u591a\u9505\uff08\u6bd4\u5982\u6211\u88ab\u8fd9\u4e2a\u4e1c\u897f\u5361\u4e86\u51e0\u4e2a\u5c0f\u65f6\uff09\uff0c\u4ee5\u4e0b\u662f\u51e0\u4e2a\u8981\u6ce8\u610f\u7684\u5730\u65b9\n\n\u9996\u5148\u6bcf\u6b21$solve$\u6211\u4eec\u4e0d\u80fd\u91cd\u5efa\u5e73\u8861\u6811\uff08\u8fd9\u4e2a\u5e94\u8be5\u662f\u5e38\u8bc6\uff09\n\n\u5982\u679c\u4f7f\u7528set\u4f5c\u5e73\u8861\u6811\uff0c\u9700\u8981\u5bf9\u6bcf\u4e2a\u679c\u6c41\u52a0\u4e0a\u7f16\u53f7\u5e76\u4e14\u5728\u6bd4\u8f83\u51fd\u6570\u4e2d\u9700\u8981\u6bd4\u8f83\uff08\u5177\u4f53\u89c1\u6211\u7684\u4ee3\u7801\uff09\n\n\u5982\u679c\u4f7f\u7528multiset\u4f5c\u5e73\u8861\u6811\uff0cerase\u7684\u65f6\u5019\u9700\u8981\u7528lower_bound\uff0c\u6bd4\u8f83\u51fd\u6570\u8981\u5199\u5b8c\u6574\uff08\u4e0d\u7136\u4f60\u5c31\u7b49\u7740\u50cf\u6211\u4e00\u6837\u51fa\u5947\u5947\u602a\u602a\u7684\u9519\u8bef\uff09\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ninline int gi() {\n\tregister int x; register char op = 1, c;\n\twhile(c = getchar(), c < '0' || c > '9') if(c == '-') op = !op;\n\tx = c ^ 48;\n\twhile(c = getchar(), c >= '0' && c <= '9') x = (x << 3) + (x << 1) + (c ^ 48);\n\treturn op ? x : -x;\n}\nstruct juice {\n\tlong long d, p, l, id;\n\tbool operator < (const juice& a)const {\n\t\treturn p == a.p ? id < a.id : p < a.p;\n\t}\n} a[100001];\nstruct child {\n\tlong long g, l;\n\tint id;\n\tbool operator < (const child a)const {\n\t\treturn l < a.l;\n\t}\n};\nint ans[100001];\nint n, m;\nset<juice> s;\nset<juice>::iterator it;\nint pos;\nvoid solve(vector<child> v, int l, int r) {\n\tif(v.empty()) return;\n\tif(l == r) {\n\t\tfor(vector<child>::iterator i = v.begin(); i != v.end(); i ++)\n\t\t\tans[i->id] = a[l].d;\n\t\treturn;\n\t}\n\tint mid = (l + r) >> 1;\n\twhile(pos > mid) s.erase(a[pos --]);\n\twhile(pos < mid) s.insert(a[++ pos]);\n\tit = s.begin();\n\tvector<child> tl, tr;\n\tlong long L = 0, P = 0;\n\tfor(vector<child>::iterator i = v.begin(); i != v.end(); i ++) {\n\t\twhile(it != s.end() && L + it->l < i->l) L += it->l, P += it->l * it->p, it ++;\n\t\tif(it == s.end()) tr.push_back(*i);\n\t\telse if(i->g >= P + it->p * (i->l - L)) tl.push_back(*i);\n\t\telse tr.push_back(*i);\n\t}\n\tsolve(tl, l, mid);\n\tsolve(tr, mid + 1, r);\n}\nbool cmp(const juice a, const juice b) {\n\treturn a.d == b.d ? a.p < b.p : a.d > b.d;\n}\nint main() {\n\tn = gi(), m = gi();\n\tpos = 0;\n\tfor(int i = 1; i <= n; i ++) a[i].d = gi(), a[i].p = gi(), a[i].l = gi(), a[i].id = i;\n\tsort(a + 1, a + n + 1, cmp);\n\tvector<child> v;\n\tfor(int i = 1; i <= m; i ++) {\n\t\tchild x;\n\t\tx.id = i;\n\t\tscanf(\"%lld%lld\", &x.g, &x.l), v.push_back(x);\n\t}\n\tsort(v.begin(), v.end());\n\ta[n + 1].d = -1, a[n + 1].l = 1e18, a[n + 1].p = 0, a[n + 1].id = n + 1;\n\tsolve(v, 1, n + 1);\n\tfor(int i = 1; i <= m; i ++) printf(\"%d\\n\", ans[i]);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1550038383,
        "uid": 70310,
        "name": "wuzhaoxin",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P4602 \u3010[CTSC2018]\u6df7\u5408\u679c\u6c41\u3011"
    },
    {
        "content": "\u7b2c\u4e00\u6b21\u81ea\u5df1\u60f3\u51fa\u4e3b\u5e2d\u6811\u7684\u9898\u76ee\u796d\u3002\n\n$\\%\\%\\%Fading$ \u524d\u5929\u665a\u4e0a\u624b\u5207\u6b64\u9898\u540e\u7ed9\u6211\u5207\u4e86\u3002\n\n\u73b0\u5728\u6709\u4e09\u4e2a\u9650\u5236\uff1a$d,p,l$\uff0c\u600e\u4e48\u641e\u5462\uff1f\n\n\u5982\u679c\u53ea\u6709\u4e24\u4e2a\u9650\u5236\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u8f6c\u5316\u4e3a\u4e8c\u7ef4\u6570\u70b9\u95ee\u9898\u3002\u6240\u4ee5\u6211\u4eec\u8003\u8651\u4e8c\u5206 $d$\uff0c\u7136\u540e\u5728\u6ee1\u8db3 $g$ \u548c $L$ \u7684\u9650\u5236\u3002\n\n\u53d1\u73b0\u5f53\u9650\u5b9a\u4e00\u4e2a\u96c6\u5408\u5185\u53d6 $p$ \u548c $l$\uff0c\u6211\u4eec\u5c06 $p$ \u6392\u5e8f\u540e\u7136\u540e\u8d2a\u5fc3\u53d6 $p_1\\times l_1+p_2\\times l_2+...+p_k\\times l_k<=g$ \u5e76\u68c0\u67e5$l_1+l_2+...+l_k$ \u662f\u5426 $\\geq L$\n\n\u90a3\u4e48\u6bcf\u6b21\u6392\u5e8f\u540e\u66b4\u529b\u53d6\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2\\log^2 n)$\n\n\u5176\u5b9e\u4e0d\u7528\u4e8c\u5206\u7684\u65f6\u5019\u6211\u4eec\u5c06 $d$ \u6392\u4e2a\u5e8f\uff0c\u7136\u540e\u7528 $set$ \u66b4\u529b\u63d2\u5165\u540e\u7edf\u8ba1\u7b54\u6848\uff0c\u53ef\u4ee5\u5c11\u6389\u4e00\u4e2a $\\log$\n\n\u7136\u800c\u6ca1\u4ec0\u4e48\u7528\u3002\u3002\u3002\n\n\u6211\u4eec\u53d1\u73b0 $p$ \u662f\u53ef\u6301\u4e45\u5316\u7684\uff0c$sum_l$ \u548c $sum_{p\\times l}$ \u662f\u53ef\u4ee5\u5728\u4e3b\u5e2d\u6811\u4e0a\u641e\u7684\u3002\u90a3\u4e48\u6bcf\u6b21\u4e8c\u5206 $d$\uff0c\u7136\u540e\u5728\u4e3b\u5e2d\u6811\u4e0a\u7edf\u8ba1\u7b54\u6848\uff0c\u68c0\u67e5\u662f\u5426 $\\geq L$\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log^2 n)$\n\n$Code\\ Below:$\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int maxn=100000+10;\nconst int lim=100000;\nint n,m,suml[maxn],T[maxn],L[maxn*20],R[maxn*20],sum[maxn*20],siz[maxn*20],cnt;\n\nstruct Juice{\n\tint d,p,l;\n}a[maxn];\n\nbool cmp(Juice a,Juice b){\n\treturn a.d>b.d;\n}\n\ninline int read(){\n\tregister int x=0,f=1;char ch=getchar();\n\twhile(!isdigit(ch)){if(ch=='-')f=-1;ch=getchar();}\n\twhile(isdigit(ch)){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\n\treturn (f==1)?x:-x;\t\n}\n\nvoid update(int &now,int pre,int l,int r,int x,int v){\n\tnow=++cnt;L[now]=L[pre];R[now]=R[pre];\n\tsum[now]=sum[pre]+x*v;siz[now]=siz[pre]+v;\n\tif(l == r) return ;\n\tint mid=(l+r)>>1;\n\tif(x <= mid) update(L[now],L[pre],l,mid,x,v);\n\telse update(R[now],R[pre],mid+1,r,x,v);\n}\n\nint query(int now,int l,int r,int x){\n\tif(!now) return 0;\n\tif(l == r) return x/l;\n\tint mid=(l+r)>>1;\n\tif(sum[L[now]]>x) return query(L[now],l,mid,x);\n\treturn query(R[now],mid+1,r,x-sum[L[now]])+siz[L[now]];\n}\n\nsigned main()\n{\n\tn=read(),m=read();\n\tfor(int i=1;i<=n;i++) a[i].d=read(),a[i].p=read(),a[i].l=read();\n\tsort(a+1,a+n+1,cmp);\n\tfor(int i=1;i<=n;i++){\n\t\tsuml[i]=suml[i-1]+a[i].l;\n\t\tupdate(T[i],T[i-1],1,lim,a[i].p,a[i].l);\n\t}\n\tint g,w,l,r,mid,ans;\n\tfor(int i=1;i<=m;i++){\n\t\tg=read(),w=read();\n\t\tif(suml[n]<w){\n\t\t\tprintf(\"-1\\n\");\n\t\t\tcontinue;\n\t\t}\n\t\tl=lower_bound(suml+1,suml+n+1,w)-suml;r=n;ans=0;\n\t\twhile(l<=r){\n\t\t\tmid=(l+r)>>1;\n\t\t\tif(query(T[mid],1,lim,g)>=w) r=mid-1,ans=mid;\n\t\t\telse l=mid+1;\n\t\t}\n\t\tif(ans==0) printf(\"-1\\n\");\n\t\telse printf(\"%lld\\n\",a[ans].d);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1547777560,
        "uid": 35069,
        "name": "Owen_codeisking",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4602 \u3010[CTSC2018]\u6df7\u5408\u679c\u6c41\u3011"
    },
    {
        "content": "## \u9898\u76ee\u5927\u610f\r\n\r\n\u73b0\u5728\u6709 $n$ \u79cd\u724c\u5b50\u7684\u679c\u6c41\uff0c\u6bcf\u79cd\u6709\u4e09\u4e2a\u5143\u7d20\uff1a\u7f8e\u5473\u5ea6 $d_{i}$\uff0c\u6bcf\u5347\u7684\u4ef7\u683c $p_{i}$\uff0c\u4f53\u79ef\u7684\u9650\u5236 $l_{i}$\u3002\u6709 $m$ \u4f4d\u5c0f\u670b\u53cb\u8981\u6765\u70b9\u6df7\u5408\u679c\u6c41\uff0c\u8981\u6c42\u603b\u4ef7\u683c\u5c0f\u4e8e\u7b49\u4e8e $g_{i}$\uff0c\u603b\u4f53\u79ef\u5927\u4e8e\u7b49\u4e8e $L_{i}$\uff0c\u6c42\u6bcf\u4e2a\u5c0f\u670b\u53cb\u80fd\u914d\u51fa\u7684\u6700\u4f4e\u7f8e\u5473\u5ea6\u6700\u9ad8\u7684\u996e\u6599\u3002\r\n\r\n## \u9898\u76ee\u5206\u6790\r\n\r\n\u8fd9\u4e00\u9898\u7684\u4e2d\u5fc3\u601d\u60f3\u9898\u89e3\u533a\u7684 dl \u4eec\u5df2\u7ecf\u603b\u7ed3\u7684\u5f88\u8be6\u5c3d\u4e86\uff0c\u91c7\u7528\u6574\u4f53\u4e8c\u5206\u4ee5\u53ca\u8d2a\u5fc3\u7684\u601d\u60f3\uff0c\u6309\u7167\u7f8e\u5473\u5ea6\u4e8c\u5206\u7b54\u6848\uff0c\u7136\u540e\u5728\u7f8e\u5473\u5ea6\u5927\u4e8e $mid$ \u7684\u679c\u6c41\u4e2d\u4f18\u5148\u9009\u62e9\u4ef7\u683c\u4f4e\u7684\u3002\r\n\r\n\u5c31\u662f\u5728\u7ef4\u62a4\u8fd9\u6837\u4e00\u4e2a\u679c\u6c41\u4fe1\u606f\u7684\u8fc7\u7a0b\u4e2d\u5f88\u591a\u4eba\u91c7\u7528\u4e86\u6bd4\u8f83\u7ed5\u7684\u60f3\u6cd5\u4ee5\u53ca\u7a0d\u5fae\u9ad8\u7ea7\u7684\u6570\u636e\u7ed3\u6784\u3002\u7136\u800c\uff0c\u4e00\u79cd\u975e\u5e38\u6734\u7d20\u7684\u60f3\u6cd5\u4e5f\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\r\n\r\n\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u5728\u6574\u4f53\u4e8c\u5206\u524d\u5c06\u64cd\u4f5c\u6309\u7167\u4ef7\u683c\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u5e76\u628a\u6240\u6709\u679c\u6c41\u7684\u4fe1\u606f\u52a0\u5165\u4e24\u4e2a\u6811\u72b6\u6570\u7ec4\u2014\u2014\u4e00\u4e2a\u7ef4\u62a4\u4f53\u79ef\uff0c\u4e00\u4e2a\u7ef4\u62a4\u4f53\u79ef\u4e58\u5355\u4ef7\uff08\u5373\u52a0\u6ee1\u7684\u603b\u4ef7\uff09\u8fd9\u6837\u4fdd\u8bc1\u4e86\u53ef\u4ee5\u7528\u524d\u7f00\u5904\u7406\u3002\r\n\r\n\u5728\u6574\u4f53\u4e8c\u5206\u7684\u8fc7\u7a0b\u4e2d\uff0c\u53ea\u8981\u628a\u7f8e\u5473\u5ea6\u5c0f\u4e8e\u7b49\u4e8e $mid$ \u7684\u679c\u6c41\u4ece\u6811\u72b6\u6570\u7ec4\u5f53\u4e2d\u5220\u6389\u5c31\u53ef\u4ee5\u4e86\u3002\u8fd9\u6837\u6811\u72b6\u6570\u7ec4\u4e2d\u5269\u4e0b\u7684\u5c31\u5168\u662f\u7f8e\u5473\u5ea6\u5927\u4e8e $mid$ \u7684\u679c\u6c41\u4e86\u3002\u9047\u5230\u8be2\u95ee\u5c31\u53ef\u4ee5\u76f4\u63a5\u5728\u6811\u72b6\u6570\u7ec4\u4e0a\u4e8c\u5206\u3002\u5728\u8fdb\u5165\u9012\u5f52\u8fdb\u5165\u53f3\u533a\u95f4\u4e4b\u524d\u4fdd\u7559\u5220\u9664\uff0c\u5904\u7406\u5b8c\u53f3\u533a\u95f4\u540e\u518d\u6062\u590d\u5de6\u533a\u95f4\u7684\u4fe1\u606f\uff0c\u518d\u9012\u5f52\u8fdb\u5165\u5de6\u533a\u95f4\u5c31\u884c\u4e86\u3002\r\n\r\n\u8fd9\u6837\u5c31\u4e0d\u9700\u8981\u8bf7\u51fa\u7ebf\u6bb5\u6811\uff0c\u4e3b\u5e2d\u6811\uff0c\u5e73\u8861\u6811\u548c\u5404\u79cd\u9ad8\u6df1\u7684\u6280\u5de7\uff0c\u7528 $O((n+m){log}^{2}{(n+m)})$ \u7684\u590d\u6742\u5ea6\u8fc7\u6389\u8fd9\u9898\u3002\u53ea\u662f\u8fd9\u79cd\u505a\u6cd5\u7684\u4e24\u652f $log$ \u662f\u4f1a\u8dd1\u6ee1\u7684\uff0c\u4f1a\u6162\u4e00\u4e9b\u3002\u7f3a\u70b9\u662f\u6162\uff0c\u4f18\u70b9\u662f\u60f3\u6cd5\u6734\u7d20\uff0c\u4ee3\u7801\u5b9e\u73b0\u7b80\u6d01\u3002\r\n\r\n```cpp\r\n#include<bits/stdc++.h>\r\n#define ll long long\r\nusing namespace std;\r\nconst int N=1e5+5;\r\nint n,m,ans[N],tmp,maxd;\r\nstruct node{ll opt,q,w,v,id,p;}q[N*2],lq[N*2],rq[N*2];//p\u662f\u4fee\u6539\u5728\u6811\u72b6\u6570\u7ec4\u4e2d\u7684\u7f16\u53f7 \r\nll s[N*2],fs[N*2],val[N*2];//s\u662f\u4f53\u79ef\u7684\u6811\u72b6\u6570\u7ec4\uff0cfs\u662f\u82b1\u8d39\u7684\u6811\u72b6\u6570\u7ec4\uff0cval\u662f\u8be5\u679c\u6c41\u7684\u5355\u4ef7 \r\nint lowbit(int x){return x&(-x);}\r\nvoid add(int x,ll k){\r\n\twhile(x<=tmp)s[x]+=k,x+=lowbit(x);\r\n}\r\nll query(int x){\r\n\tif(!x)return 0;\r\n\tll ans=0;\r\n\twhile(x)ans+=s[x],x-=lowbit(x);return ans;\r\n}\r\nvoid Add(int x,ll k){while(x<=tmp)fs[x]+=k,x+=lowbit(x);}\r\nll Query(int x){if(!x)return 0;ll ans=0;while(x)ans+=fs[x],x-=lowbit(x);return ans;}\r\ninline ll read(){ll s=0,w=1;char c=getchar();while(c<48||c>57) {if(c=='-') w=-1;c=getchar();}while(c>=48&&c<=57) s=(s<<1)+(s<<3)+c-48,c=getchar();return s*w;}\r\nvoid solve(int l,int r,int L,int R){\r\n\tif(l>r)return;\r\n\tif(L==R){\r\n\t\tfor(int i=l;i<=r;i++)if(q[i].opt==2&&L)ans[q[i].id]=L;\r\n\t\treturn;\r\n\t}\r\n\tint mid=(L+R>>1),cntl=0,cntr=0;\r\n\tfor(int i=l;i<=r;i++)\r\n\t\tif(q[i].opt==1){\r\n\t\t\tif(q[i].q<=mid)lq[++cntl]=q[i],add(q[i].p,-q[i].v),Add(q[i].p,-q[i].w*q[i].v);//\u7f8e\u5473\u5ea6\u5c0f\u4e8e\u7b49\u4e8emid\uff0c\u4ece\u6811\u72b6\u6570\u7ec4\u4e2d\u5220\u9664 \r\n\t\t\telse rq[++cntr]=q[i];\r\n\t\t}\r\n\tfor(int i=l;i<=r;i++){\r\n\t\tif(q[i].opt==2){\r\n\t\t\tint lL=1,rr=tmp,as=0;//\u8d2a\u5fc3\uff0c\u5728\u6811\u72b6\u6570\u7ec4\u4e2d\u4e8c\u5206 \r\n\t\t\twhile(lL<=rr){\r\n\t\t\t\tint md=(lL+rr>>1);\r\n\t\t\t\tif(query(md)>=q[i].v)as=md,rr=md-1;\r\n\t\t\t\telse lL=md+1;\r\n\t\t\t}\r\n\t\t\tif(as==0)lq[++cntl]=q[i];\r\n\t\t\telse {//\u68c0\u67e5\u82b1\u8d39 \r\n\t\t\t\tll delta=q[i].v-query(as-1),cost=Query(as-1)+delta*val[as];\r\n\t\t\t\tif(cost<=q[i].w)rq[++cntr]=q[i];\r\n\t\t\t\telse lq[++cntl]=q[i];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tfor(int i=l;i<=l+cntl-1;i++)q[i]=lq[i-l+1];\r\n\tfor(int i=l+cntl;i<=r;i++)q[i]=rq[i-cntl-l+1];\r\n\tsolve(l+cntl,r,mid+1,R);//\u5148\u5904\u7406\u53f3\u533a\u95f4 \r\n\tfor(int i=l;i<=l+cntl-1;i++)if(q[i].opt==1)add(q[i].p,q[i].v),Add(q[i].p,q[i].v*q[i].w);//\u6062\u590d\u4fe1\u606f \r\n\tsolve(l,l+cntl-1,L,mid);//\u518d\u5904\u7406\u5de6\u533a\u95f4 \r\n}\r\nbool cmp(node a,node b){\r\n\treturn a.w<b.w;\r\n}//\u6309\u7167\u4ef7\u683c\u6392\u5e8f \r\nint main(){\r\n\tcin >> n >> m;\r\n\tfor(int i=1,x,y,z;i<=n;i++)x=read(),y=read(),z=read(),maxd=max(maxd,x),q[++tmp]=node{1,x,y,z,0,0};\r\n\tfor(int i=1;i<=m;i++){ll x=read(),y=read();q[++tmp]=node{2,0,x,y,i,0};}\r\n\tsort(q+1,q+tmp+1,cmp);\r\n\tfor(int i=1;i<=tmp;i++)q[i].p=i,val[i]=q[i].w;\r\n\tfor(int i=1;i<=tmp;i++)if(q[i].opt==1)add(i,q[i].v),Add(i,q[i].v*q[i].w);//\u4e8c\u5206\u524d\uff0c\u5c06\u6240\u6709\u4fe1\u606f\u52a0\u5165\u6811\u72b6\u6570\u7ec4 \r\n\tmemset(ans,-1,sizeof(ans)),solve(1,tmp,0,maxd);\r\n\tfor(int i=1;i<=m;i++)printf(\"%d\\n\",ans[i]);\r\n\treturn 0;\r\n}\r\n```\r\n",
        "postTime": 1684912602,
        "uid": 565742,
        "name": "\u672a\u6765\u59da\u73edzyl",
        "ccfLevel": 5,
        "title": "P4602 [CTSC2018] \u6df7\u5408\u679c\u6c41 \u9898\u89e3"
    },
    {
        "content": "# \u9898\u89e3  \n\u5178\u578b\u7684\u4e8c\u5206\u5957\u4e3b\u5e2d\u6811  \n\u9996\u5148\u6211\u4eec\u8981\u5f00\u4e00\u9897\u4e3b\u5e2d\u6811  \n\u6bcf\u4e2a\u8282\u70b9\u8868\u793a\u4e00\u4e2a\u4ef7\u503c  \n\u7136\u540e\u6211\u4eec\u8981\u7ef4\u62a4\u67d0\u4e2a\u533a\u95f4\u91cc\u9762\u7684\u5bb9\u91cf\u603b\u548c\u4ee5\u53ca\u8fd9\u4e9b\u5bb9\u91cf\u7684\u4ef7\u503c\u603b\u548c  \n\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\uff0c\u6211\u4eec\u53ef\u4ee5\u4e8c\u5206\u679a\u4e3e\u4e00\u4e2a\u6700\u5c0f\u7684\u7f8e\u5473\u5ea6d  \n\u5e76\u4e14\u7528\u4e3b\u5e2d\u6811\u52a0\u4ee5\u5224\u65ad  \n### \u4ee3\u7801\n```.cpp\n#include<bits/stdc++.h>\n#define int long long \nusing namespace std;\nconst int N=100005;\nint cnt,ls[N*20],rs[N*20],n,m,T[N],x,y,t,w,ans,mid,nn,b[N],Max;\nstruct node\n{\n\tint d,p,l;\n}a[N];\nstruct Node\n{\n\tint x,y;\n}tree[N*20];\nbool cmp(node o,node l)\n{\n\treturn o.d<l.d;\n}\nvoid addition(int k,int t,int w,int x,int y,int p)\n{\n\tif (t==w)\n\t{\n\t\ttree[k].x=tree[p].x+y;\n\t\ttree[k].y=tree[p].y+x*y;\n\t    return;\n\t}\n\tint mid=(t+w)/2;\n\tif (x>mid)\n\t{\n\t\trs[k]=++cnt;\n\t\tls[k]=ls[p];\n\t\taddition(cnt,mid+1,w,x,y,rs[p]);\n\t}\n\telse\n\t{\n\t\trs[k]=rs[p];\n\t\tls[k]=++cnt;\n\t\taddition(cnt,t,mid,x,y,ls[p]);\n\t}\n\ttree[k].x=tree[p].x+y;\n\ttree[k].y=tree[p].y+x*y;\n}\nbool query(int k,int t,int w,int x,int y,int p) //\u60f3\u8981x\u5347\u679c\u6c41\uff0c\u6709y\u5143\u94b1 \n{\n\tif (x==0) return true;\n\tif (t==w)\n\t{\n\t\tif (tree[k].x-tree[p].x<x) return false;\n\t\tif (y<t*x) return false;\n\t\treturn true;\n\t}\n\tint optx=tree[ls[k]].x-tree[ls[p]].x;\n\tint opty=tree[ls[k]].y-tree[ls[p]].y;\n\tint mid=(t+w)/2; \n\tif (x>=optx && y>=opty)\n\t  return query(rs[k],mid+1,w,x-optx,y-opty,rs[p]);\n\telse\n\t  if (x<optx)\n\t    return query(ls[k],t,mid,x,y,ls[p]);\n\t  else\n\t    return false;\n}\nsigned main()\n{\n\t\n\tscanf(\"%lld%lld\",&n,&m);\n\tfor (int i=1;i<=n;i++)\n\t  scanf(\"%lld%lld%lld\",&a[i].d,&a[i].p,&a[i].l),Max=max(a[i].p,Max);\n\tsort(a+1,a+n+1,cmp);\n\tfor (int i=1;i<=n;i++)\n\t  if (a[i].d!=a[i-1].d)\n\t  {\n\t  \tnn++;\n\t  \tb[nn]=i;\n\t  } \n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tT[i]=++cnt;\n\t\taddition(T[i],1,Max,a[i].p,a[i].l,T[i-1]);\n\t}\n\tfor (int i=1;i<=m;i++)\n\t{\n\t\tscanf(\"%lld%lld\",&x,&y);\n\t\tt=1;w=nn;ans=-1;\n\t\twhile (t<=w)\n\t\t{\n\t\t\tmid=(t+w)/2;\n\t\t\tif (query(T[n],1,Max,y,x,T[b[mid]-1]))\n\t\t\t{\n\t\t\t\tans=a[b[mid]].d;\n\t\t\t\tt=mid+1;\n\t\t\t}\n\t\t\telse\n\t\t\t  w=mid-1;\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1545966522,
        "uid": 88040,
        "name": "\u82e5\u7389",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4602 \u3010[CTSC2018]\u6df7\u5408\u679c\u6c41\u3011"
    }
]
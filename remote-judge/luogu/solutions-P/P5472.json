[
    {
        "content": "\u8fd9\u662f\u4e2a\u7ed3\u8bba\u9898\u2026\u2026\u800c\u4e14\u7ed3\u8bba\u8fd8\u5f88\u597d\u731c\u2026\u2026\n\n\u53ef\u4ee5\u89c2\u5bdf\uff0c$n$\u90a3\u4e48\u5927\uff0c\u800c\u521a\u5f00\u59cb\u53ea\u6709$f(i)=i$\u548c$f(i)=i^2$\uff0c\u53ef\u4ee5\u731c\u4e00\u4e2a\u7ed3\u8bba\uff1a\n\n#### \u4e00\u6b21\u51fd\u6570\u6d17\u724c\u4e4b\u540e\u7684\u671f\u671b\u8fd8\u662f\u4e00\u6b21\u51fd\u6570\uff0c\u4e8c\u6b21\u51fd\u6570\u6d17\u724c\u4e4b\u540e\u7684\u671f\u671b\u8fd8\u662f\u4e8c\u6b21\u51fd\u6570\u3002\n\n\u800c\u6d17\u724c\u4e24\u6b21\u540e\u7684\u671f\u671b\uff0c\u548c\u7528\u6d17\u724c\u4e00\u6b21\u540e\u7684\u671f\u671b\u4f5c\u4e3a\u6743\u503c\uff0c\u518d\u6d17\u7b2c\u4e8c\u6b21\u724c\u5f97\u5230\u7684\u671f\u671b\uff0c\u7ed3\u679c\u5e94\u8be5\u662f\u4e00\u6837\u7684\u3002\u8fd9\u4e2a\u5f88\u597d\u8bc1\uff0c\u56e0\u4e3a\u671f\u671b\u662f\u7ebf\u6027\u53ef\u52a0\u7684\uff0c\u800c\u6bcf\u6b21\u6d17\u724c\u540e\uff0c\u4e00\u4e2a\u7279\u5b9a\u4f4d\u7f6e\u4e0a\u7684\u503c\uff0c\u662f\u6bcf\u4e2a\u4f4d\u7f6e\u539f\u6765\u7684\u6743\u503c\u4e58\u4ee5\u7279\u5b9a\u7684\u5e38\u6570\uff08\u8fd9\u4e2a\u5e38\u6570\u5728\u4e0b\u9762\u7684\u8bc1\u660e\u8fc7\u7a0b\u4e2d\u6709\u63a8\u5bfc\uff09\u76f8\u52a0\uff0c\u53ea\u6d89\u53ca\u5230\u4e00\u4e9b\u53d8\u91cf\u671f\u671b\u7684\u7ebf\u6027\u76f8\u52a0\uff0c\u6240\u4ee5\u662f\u53ef\u4ee5\u7684\u3002\u6ce8\u610f\uff0c\u8fd9\u70b9\u867d\u7136\u6bd4\u8f83\u663e\u7136\uff0c\u4f46\u6709\u4e9b\u65f6\u5019\u4e0d\u4e00\u5b9a\u662f\u5bf9\u7684\uff0c\u6240\u4ee5\u8fd9\u79cd\u4e1c\u897f\u8fd8\u8981\u5148\u601d\u8003\u4e00\u4e0b\u3002\n\n\u90a3\u524d\u9762\u8fd9\u4e2a\u7ed3\u8bba\u662f\u4e0d\u662f\u5bf9\u7684\u5462\uff1f\u53ef\u4ee5\u5199\u4e2a\u8fd9\u6837\u7684\u7a0b\u5e8f\u8bd5\u8bd5\uff0c\u6d4b\u4e00\u4e0b\u6837\u4f8b\uff0c\u5bf9\u62cd\u4e00\u4e0b\uff0c\u597d\u50cf\u8fd8\u771f\u662f\u8fd9\u6837\u3002\u90a3\u4e0d\u662f\u5c31\u505a\u5b8c\u4e86\u5417\uff1f\u5177\u4f53\u505a\u6cd5\uff1a\u6bcf\u4e00\u6b21\u9009\u4e09\u4e2a\u597d\u7b97\u7684\u7b97\u51fa\u6765\uff0c\u7136\u540e\u628a\u4e8c\u6b21\u51fd\u6570\u7ed9\u7b97\u51fa\u6765\uff08\u53ef\u4ee5\u5f85\u5b9a\u7cfb\u6570\u89e3\u65b9\u7a0b\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u62c9\u683c\u6717\u65e5\u63d2\u503c\uff09\uff0c\u4e0d\u5c31\u53ef\u4ee5\u4e86\u5417\uff1f\u9009\u7684\u65f6\u5019\u53ef\u4ee5\u9009\u6700\u5f00\u59cb\u7684\u4e09\u4e2a\uff08\u8fd9\u6837\u53ef\u4ee5\u4e8c\u9636\u5dee\u5206\uff09\uff0c\u4e5f\u53ef\u4ee5\u9009\u524d\u4e24\u4e2a\u52a0\u6700\u540e\u4e00\u4e2a\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u6d17\u724c\u7684\u8fc7\u7a0b\u53ef\u4ee5\u60f3\u6210\u5728\u7b2c\u4e00\u5806\u548c\u7b2c\u4e8c\u5806\u4e2d\u4efb\u9009\u4e00\u4e2a\u653e\u5230\u724c\u5806\u9876\uff0c\u4e5f\u5c31\u662f\u968f\u673a\u6253\u4e71\uff08\u8fd9\u4e2a\u5728\u8bc1\u660e2\u4e2d\u6709\u8bf4\u660e\uff09\uff0c\u7136\u540e\uff0c\u628a\u7b2c\u4e00\u5806\u7684\u62ff\u51fa\u6765\u5b89\u539f\u6765\u7684\u987a\u5e8f\u6392\u597d\uff0c\u628a\u7b2c\u4e8c\u5806\u6309\u539f\u6765\u7684\u987a\u5e8f\u6392\u597d\u3002\u8fd9\u6837\u5c31\u4f1a\u53d1\u73b0\u7b97\u6700\u540e\u4e00\u4e2a\u548c\u7b97\u7b2c\u4e00\u4e2a\u662f\u4e00\u6837\u597d\u7b97\u7684\u3002\n\n\u8bb0\u7b2c$i$\u4e2a\u6570\u662f$x_i$\uff0c\u6d17\u724c\u540e\u7b2c\u4e00\u4e2a\u6570\u7684\u671f\u671b$x_i'=\\frac Anx_1+\\frac{n-A}nx_{A+1}$\uff0c\u6700\u540e\u4e00\u4e2a\u6570\u7684\u671f\u671b$x_n'=\\frac Anx_A+\\frac{n-A}nx_n$\uff08\u6709$\\frac An$\u7684\u6982\u7387\u662f\u62bd\u5230\u7b2c\u4e00\u5806\uff0c$\\frac{n-A}n$\u7684\u6982\u7387\u662f\u62bd\u5230\u7b2c\u4e8c\u5806\uff0c\u800c\u4e14\u80af\u5b9a\u662f\u6700\u540e\u4e00\u4e2a\uff09\uff0c\u7b2c\u4e8c\u4e2a\u6570\u7684\u671f\u671b$x_2'=\\frac An(\\frac{A-1}{n-1}x_2+\\frac{n-A}{n-1}x_{A+1})+\\frac{n-A}n(\\frac A{n-1}x_1+\\frac{n-A-1}{n-1}x_{A+2})$\uff0c\u524d\u8005\u662f\u5bf9\u5e94\u7b2c\u4e00\u4e2a\u62bd\u5230\u7684\u662f\u7b2c\u4e00\u5806\uff0c\u540e\u8005\u662f\u5bf9\u5e94\u7b2c\u4e00\u4e2a\u62bd\u5230\u7684\u662f\u7b2c\u4e8c\u5806\u3002\n\n\u8fd9\u5c31\u53ef\u4ee5\u6109\u5feb\u5730\u628a\u8fd9\u9898A\u4e86\u3002\u4ee3\u7801\u5728\u6700\u540e\uff08\u4ee3\u78011\uff09\u3002\n\n\u5f53\u7136\u6709\u4e2a\u975e\u5e38\u5173\u952e\u7684\u95ee\u9898\uff0c\u8fd9\u4e2a\u7ed3\u8bba\u4e3a\u4ec0\u4e48\u662f\u5bf9\u7684\uff1f\n\n### \u8bc1\u660e1\n\n\u6211\u4eec\u8bc1\u660e\u8fd9\u6837\u4e00\u4e2a\u4e1c\u897f\uff1a\u4e00\u4e2a\u5e8f\u5217$\\{a_i\\}$\uff08\u7b49\u4e00\u4e0b\uff0c\u4e0a\u9762\u662f$x$\u600e\u4e48\u5c31\u53d8$a$\u4e86\u2026\u2026~~\u61d2\u5f97\u6539\u4e86~~\uff09\u6ee1\u8db3$a_i=f(i)$\uff0c\u5176\u4e2d$f(i)$\u4e3a\u591a\u9879\u5f0f\uff0c\u5219\u5bf9\u4e8e\u6d17\u724c\u540e\u7684\u5e8f\u5217$\\{a_i'\\}$\uff0c\u5b58\u5728\u4e00\u4e2a\u591a\u9879\u5f0f$f'(i)$\u4f7f\u5f97$a_i'=f'(i)$\u4e14$\\deg f\\geqslant\\deg g$\uff0c\u8fd9\u6837\u5c31\u80fd\u4fdd\u8bc1\u9009$\\deg f+1$\u4e2a\u6570\u63d2\u503c\u540e\u7684\u7ed3\u679c\u5c31\u662f$f'$\u3002\u4e3a\u4e86\u65b9\u4fbf\uff0c\u8bb0$\\deg f=m$\u3002\n\n**\u5927\u91cf\u516c\u5f0f\u8b66\u544a**\n\n\u6211\u4eec\u5148\u8981\u77e5\u9053\u8f6c\u79fb\u5f0f\u3002\u8003\u8651$a_j\\ (j\\leqslant A)$\u5bf9$a_i'$\u7684\u8d21\u732e\uff0c\u5373$a_j$\u4e58\u4ee5\u6d17\u724c\u540e\u7b2c$i$\u5f20\u662f\u539f\u5148\u7684\u7b2c$j$\u5f20\u5f97\u6982\u7387\u3002\u8003\u8651\u67d0\u4e00\u79cd\u60c5\u51b5\u7684\u6982\u7387\u5927\u6982\u957f\u8fd9\u6837\uff08\u67d0\u4e00\u7279\u6b8a\u4f46\u5e73\u51e1\u7684\u60c5\u51b5\uff09\uff1a$\\frac An\\cdot\\frac {A-1}{n-1}\\cdot\\frac {n-A}{n-2}\\cdot\\cdots\\cdot\\frac{A-j+1}{n-i+2}\\cdot\\frac{n-A-i+j+1}{n-i+1}$\u3002\u89c2\u5bdf\u53d1\u73b0\u867d\u7136\u6bcf\u4e2a\u5206\u6570\u90fd\u6ca1\u4ec0\u4e48\u89c4\u5f8b\uff0c\u6bcf\u6b21\u4e58\u7684\u5206\u6570\u4e5f\u4e0d\u662f\u56fa\u5b9a\u7684\uff0c\u4f46\u662f\u5bb9\u6613\u53d1\u73b0\u5206\u5b50\u662f$A^\\frac{j}{}(n-A)^\\frac{i-j}{}$\uff0c\u5206\u6bcd\u662f$n^\\frac{i}{}$\u3002\u800c$a_i'$\u524d\u9762\u6709$i-1$\u4e2a\u6570\uff0c\u5f53\u4e2d\u6709$j-1$\u7684\u6570\u662f\u7b2c\u4e00\u5806\u7684\uff0c\u6240\u4ee5\u8981\u518d\u4e58\u4e00\u4e2a$\\binom{i-1}{j-1}$\u3002$j>A$\u65f6\u540c\u7406\u3002\n\n\u90a3\u4e48\u5c31\u6709\n$$a_i'=\\sum_{j=1}^Aa_j\\dbinom{i-1}{j-1}A^\\frac{j}{}(n-A)^\\frac{i-j}{}\\frac1{n^\\frac i{}}+\\sum_{j=1}^{n-A}a_{A+j}\\dbinom{i-1}{j-1}A^\\frac{i-j}{}(n-A)^\\frac j{}\\frac1{n^\\frac{i}{}}$$\n\u5176\u5b9e\u524d\u540e\u4e24\u4e2a\u5f0f\u5b50\u5f62\u5f0f\u4e0a\u8fd8\u662f\u6ca1\u4ec0\u4e48\u533a\u522b\uff0c\u6211\u4eec\u5c31\u5148\u770b\u524d\u4e00\u90e8\u5206\u3002\u5316\u7b80\u5b83\u3002\n$$\\begin{aligned}&\\sum_{j=1}^Aa_j\\dbinom{i-1}{j-1}A^\\frac{j}{}(n-A)^\\frac{i-j}{}\\frac1{n^\\frac i{}}\\\\=&\\sum_{j=1}^Aa_j\\dbinom{i-1}{j-1}\\frac{A!}{(A-j)!}\\cdot\\frac{(n-A)!}{(n-A-i+j)!}\\cdot\\frac{(n-i)!}{n!}\\\\=&\\sum_{j=1}^Aa_j\\dbinom{i-1}{j-1}\\frac{(n-i)!}{(A-j)!(n-A-i+j)!}\\cdot\\frac{A!(n-A)!}{n!}\\\\=&\\frac{A!(n-A)!}{n!}\\sum_{j=1}^Aa_j\\dbinom{i-1}{j-1}\\frac{(n-i)!}{(A-j)!(n-A-i+j)!}\\\\=&\\frac1{\\dbinom nA}\\sum_{j=1}^Aa_j\\dbinom{i-1}{j-1}\\dbinom{n-i}{A-j}\\end{aligned}$$\n\u597d\u50cf\u5316\u7b80\u4e0d\u4e86\u4e86\u2026\u2026\u4f46\u6211\u4eec\u597d\u50cf\u5fd8\u4e86\u4e00\u4e2a\u6761\u4ef6\uff1f$a_i$\u53ef\u4ee5\u8868\u793a\u6210\u81f3\u591a$m$\u6b21\uff08\u672c\u9898$m\\leqslant2$\uff09\u7684\u591a\u9879\u5f0f\uff01\u8fd9\u53c8\u6709\u4ec0\u4e48\u7528\u5462\uff1f\n\n\u6ce8\u610f\u5230\uff0c\u8fd9\u91cc\u7684\u8f6c\u79fb\uff0c\u90fd\u662f\u67d0\u4e2a\u4f4d\u7f6e\u7684\u6570\u3002\u4e58\u4e0a\u4e00\u4e2a\u548c\u8fd9\u4e2a\u6570\u65e0\u5173\u7684\u5e38\u6570\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5b83\u662f\u7ebf\u6027\u7684\uff0c\u5c31\u662f\u5c06\u8f93\u5165\u7684\u4e00\u4e9b\u6570\u636e\u7ebf\u6027\u76f8\u52a0\uff08\u5373\u4e58\u4e00\u4e2a\u5e38\u6570\u540e\u76f8\u52a0\uff09\u7684\u7ed3\u679c\uff0c\u548c\u539f\u5148\u8fd9\u4e9b\u8f93\u5165\u540e\u5206\u522b\u5f97\u5230\u7684\u7ed3\u679c\uff0c\u8fdb\u884c\u76f8\u540c\u7684\u7ebf\u6027\u76f8\u52a0\uff0c\u5f97\u5230\u7684\u7ed3\u679c\u662f\u4e00\u6837\u7684\uff08\u8fd9\u4e5f\u4e0d\u96be\u9a8c\u8bc1\uff09\u3002\u82e5\u5bf9\u4e8e\u6240\u6709\u5c0f\u4e8e$m$\u6b21\u7684\u591a\u9879\u5f0f$f(x)$\u90fd\u53ef\u4ee5\u8868\u793a\u6210$\\sum_{k=0}^mc_kf_k(x)$\uff0c\u5176\u4e2d$c_k$\u4e3a\u5e38\u6570\uff0c$f_k$\u662f\u6b21\u6570\u4e3a$k$\u7684\u591a\u9879\u5f0f\uff0c\u6211\u4eec\u5c31\u53ea\u9700\u8981\u8bc1\u660e\u5f53$a_i=f_k(i)$\u65f6\uff0c$a_i'$\u53ef\u4ee5\u88ab\u8868\u793a\u6210\u81f3\u591a$k$\u6b21\u7684\u591a\u9879\u5f0f\u5373\u53ef\u3002\n\n\u73b0\u5728\uff0c\u53ea\u9700\u8981\u627e\u5230\u4e00\u4e2a\u4fbf\u4e8e\u6211\u4eec\u8bc1\u660e\u7684$f_k$\u5373\u53ef\u3002\u9996\u5148\u60f3\u5230\u7684\u53ef\u80fd\u662f$f_i(x)=x^i$\uff0c\u4f46\u8fd9\u91cc\u7684\u7cfb\u6570\u90fd\u662f\u9636\u4e58\u548c\u4e8c\u9879\u5f0f\uff0c\u6240\u4ee5\u66f4\u5e94\u8be5\u5c1d\u8bd5\u4e0b\u964d\u5e42\uff08\u6211\u4eec\u77e5\u9053$m$\u6b21\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u53ef\u4ee5\u548c$m$\u6b21\u591a\u9879\u5f0f\u4e00\u4e00\u5bf9\u5e94\uff09\uff0c\u5c1d\u8bd5\u540e\u53d1\u73b0\u597d\u50cf$f_k(x)=(x-1)^\\frac k{}$\u6700\u65b9\u4fbf\uff08\u53ef\u80fd\u4e00\u4e2a\u7406\u7531\u662f\u4e0b\u6807\u4ece$0$\u5f00\u59cb\u66f4\u81ea\u7136\uff1f~~\u6211\u968f\u4fbf\u8bf4\u7684\u3002~~\uff09\uff0c\u800c\u4e14\u6211\u4eec\u77e5\u9053\uff0c\u4e00\u4e2a\u4efb\u610f\u7684$m$\u6b21\u591a\u9879\u5f0f\uff0c\u603b\u662f\u53ef\u4ee5\u88ab\u8868\u793a\u6210$m$\u6b21\u7684\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u3002\u90a3\u4e48\u5c06$a_j=(j-1)^\\frac k{}$\u5e26\u5165\u5e76\u6765\u4e00\u4e9b\u64cd\u4f5c\u5f97\uff1a\n$$\\begin{aligned}&\\frac1{\\dbinom nA}\\sum_{j=1}^Aa_j\\dbinom{i-1}{j-1}\\dbinom{n-i}{A-j}\\\\=&\\frac1{\\dbinom nA}\\sum_{j=1}^A(j-1)^\\frac k{}\\dbinom{i-1}{j-1}\\dbinom{n-i}{A-j}\\\\=&\\frac1{\\dbinom nA}\\sum_{j=1}^A\\frac{(j-1)!}{(j-1-k)!}\\cdot\\frac{k!}{k!}\\cdot\\dbinom{i-1}{j-1}\\dbinom{n-i}{A-j}\\\\=&\\frac1{\\dbinom nA}\\sum_{j=1}^Ak!\\dbinom{j-1}{k}\\dbinom{i-1}{j-1}\\dbinom{n-i}{A-j}\\\\=&\\frac{k!}{\\dbinom nA}\\sum_{j=1}^A\\dbinom{j-1}{k}\\dbinom{i-1}{j-1}\\dbinom{n-i}{A-j}\\end{aligned}$$\n\u800c\u4e8c\u9879\u5f0f\u5f53\u4e2d\u6709\u4e2a\u4e1c\u897f\uff1a\n$$\\begin{aligned}\\dbinom ab\\dbinom ca&=\\frac{a!}{b!(a-b)!}\\cdot\\frac{c!}{a!(c-a)!}\\\\&=\\frac{c!}{b!(c-b)!}\\cdot\\frac{(c-b)!}{(a-b)!(c-a)!}\\\\&=\\dbinom cb\\dbinom{c-b}{a-b}\\end{aligned}$$\n\u6240\u4ee5\u4ee4$j-1=a,\\ k=b,\\ i-1=c$\uff0c\u5219\u6709\n$$\\begin{aligned}&\\frac{k!}{\\dbinom nA}\\sum_{j=1}^A\\dbinom{j-1}k\\dbinom{i-1}{j-1}\\dbinom{n-i}{A-j}\\\\=&\\frac{k!}{\\dbinom nA}\\sum_{j=1}^A\\dbinom{i-1}k\\dbinom{i-1-k}{j-1-k}\\dbinom{n-i}{A-j}\\\\=&\\frac{k!}{\\dbinom nA}\\dbinom{i-1}k\\sum_{j=1}^A\\dbinom{i-1-k}{j-1-k}\\dbinom{n-i}{A-j}\\\\=&\\frac{k!}{\\dbinom nA}\\dbinom{i-1}k\\sum_j\\dbinom{i-1-k}{j-1-k}\\dbinom{n-i}{A-j}\\\\=&\\frac{k!}{\\dbinom nA}\\dbinom{i-1}k\\sum_j\\dbinom{i-1-k}j\\dbinom{n-i}{A-j-1-k}\\end{aligned}$$\n\uff08\u5012\u6570\u7b2c\u4e8c\u884c\u53ef\u4ee5\u628a\u9650\u5236\u53bb\u6389\u56e0\u4e3a\u663e\u7136$j-1-k\\geqslant0,\\ j\\leqslant A$\uff0c\u5373$A\\geqslant j\\geqslant1+k\\geqslant1$\u65f6\u540e\u4e00\u4e32\u4e0d\u4e3a0\u3002\u6700\u540e\u4e00\u884c\u662f\u628a$j$\u7528$j+1+k$\u4ee3\u66ff\u3002\uff09\u6211\u4eec\u53c8\u63d0\u51fa\u4e86\u4e00\u9879\uff01\u7ee7\u7eed\u3002\u4e8c\u9879\u5f0f\u5f53\u4e2d\u8fd8\u6709\u4e00\u4e2a\u4e1c\u897f\uff1a\n$$\\sum_j\\dbinom nj\\dbinom m{k-j}=\\dbinom{n+m}k$$\n\u8fd9\u4e2a\u5f0f\u5b50\u4e3a\u4ec0\u4e48\u662f\u5bf9\u7684\u5462\uff1f\u8003\u8651\u7ec4\u5408\u610f\u4e49\u3002\u8bbe\u6709$n$\u4e2a\u7ea2\u7403\uff0c$m$\u4e2a\u84dd\u7403\uff0c\u5de6\u5f0f\u4e3a\u5bf9\u4e8e\u6bcf\u4e2a$j$\uff0c\u5f53\u7ea2\u7403\u53d6$j$\u4e2a\uff0c\u84dd\u7403\u53d6$k-j$\u4e2a\u7684\u65b9\u6848\u6570\u4e4b\u548c\uff0c\u76f8\u5f53\u4e8e\u603b\u5171$n+m$\u4e2a\u7403\u4e2d\u53d6$k$\u4e2a\u7403\u7684\u65b9\u6848\u6570\uff0c\u5373\u4e3a\u53f3\u5f0f\u3002\n\n\u4ee4$i-1-k=n,\\ n-i=m,\\ A-1-k=k$\uff08\u8fd9\u91cc\u53f3\u5f0f\u7684$n,m,k$\u4e3a\u4e0a\u5f0f\u4e2d\u7684\uff09\uff0c\u7ee7\u7eed\uff1a\n$$\\begin{aligned}&\\frac{k!}{\\dbinom nA}\\dbinom{i-1}k\\sum_j\\dbinom{i-1-k}j\\dbinom{n-i}{A-j-1-k}\\\\=&\\frac{k!}{\\dbinom nA}\\dbinom{i-1}k\\dbinom{i-1-k+n-i}{A-1-k}\\\\=&\\frac{k!}{\\dbinom nA}\\dbinom{i-1}k\\dbinom{n-k-1}{A-k-1}\\end{aligned}$$\n\u6211\u4eec\u628a\u548c\u5f0f\u6253\u5f00\u4e86\uff01\u7ee7\u7eed\u7a0d\u5fae\u5316\u7b80\u4e00\u4e0b\uff1a\n$$\\begin{aligned}&\\frac{k!}{\\dbinom nA}\\dbinom{i-1}k\\dbinom{n-k-1}{A-k-1}\\\\=&k!\\frac{(i-1)!}{k!(i-1-k)!}\\cdot\\frac{\\dbinom{n-k-1}{A-k-1}}{\\dbinom nA}\\\\=&\\frac{(i-1)!}{(i-1-k)!}\\cdot\\frac{\\dbinom{n-k-1}{A-k-1}}{\\dbinom nA}\\\\=&(i-1)^\\frac k{}\\cdot\\frac{\\dbinom{n-k-1}{A-k-1}}{\\dbinom nA}\\end{aligned}$$\n\u641e\u51fa\u6765\u4e86\uff01\uff1f\u4e5f\u5c31\u662f\u8bf4\u5f53$a_i=(i-1)^\\frac k{}$\u65f6\uff0c$a_i'$\u7684\u4e00\u90e8\u5206\u662f$\\begin{aligned}(i-1)^\\frac k{}\\cdot\\frac{\\binom{n-k-1}{A-k-1}}{\\binom nA}\\end{aligned}$ \uff0c\u4e5f\u662f$k$\u6b21\u7684\u4e0b\u964d\u5e42\u3002\u7ed3\u5408\u524d\u9762\u7684\u8bf4\u660e\uff0c\u53ef\u5f97\u5f53$a_i$\u662f$m$\u6b21\u591a\u9879\u5f0f\u65f6\uff0c$a_i'$\u7684\u8fd9\u4e00\u90e8\u5206\u4e5f\u662f\u4e0d\u591a\u4e8e$m$\u6b21\u7684\u591a\u9879\u5f0f\u3002\n\n\u800c\u53e6\u4e00\u90e8\u5206\u5462\uff1f\uff08\u867d\u7136\u540c\u7406\u4f46\u8fd8\u6709\u4e00\u4e9b\u5dee\u522b\u3002\uff09\u8bbe$b_i=a_{A+i}$\uff0c\u6bd4\u8f83\u4e00\u4e0b\u5f0f\u5b50\uff0c\u5f53$b_i=(i-1)^\\frac k{}$\u65f6\uff0c\u8fd8\u662f\u6709$a_i'$\u7684\u53e6\u4e00\u90e8\u5206\u662f$\\begin{aligned}(i-1)^\\frac k{}\\cdot\\frac{\\binom{n-k-1}{n-A-k-1}}{\\binom n{n-A}}\\end{aligned}$\uff08\u5176\u5b9e\u4e0b\u9762\u5206\u6bcd\u4e5f\u662f$\\begin{aligned}\\binom nA\\end{aligned}$\uff09\uff0c\u6240\u4ee5$a_i'$\u5c31\u662f\u81f3\u591a$m$\u6b21\u7684\u591a\u9879\u5f0f\u3002 \u8bc1\u6bd5\u3002\n\n\u5f53\u7136\uff0c\u6709\u4e86\u8fd9\u4e2a\u5f0f\u5b50\u4e5f\u53ef\u4ee5\u5199\u4e00\u4efd\u4ee3\u7801\uff0c\u5c31\u662f\u6bcf\u6b21\u8bb0\u5f55\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u7684\u7cfb\u6570\uff08\u521d\u59cb\u6761\u4ef6\u53ef\u80fd\u8981\u624b\u7b97\u4e00\u4e0b\uff09\uff0c\u7136\u540e\u53ef\u4ee5\u76f4\u63a5\u8f6c\u79fb\uff0c\u6bcf\u4e00\u9879\u6309\u7167\u8fd9\u4e2a\u5f0f\u5b50\u7ed9\u51fa\u7684\uff0c\u4e58\u4e0a\u4e00\u4e2a\u7cfb\u6570\uff0c\u5c31\u4e0d\u7528\u63d2\u503c\u4e86\u3002\u5f53\u7136\u8981\u6ce8\u610f\uff0c\u8981\u5c06$a_i$\u7684\u591a\u9879\u5f0f\u5e73\u79fb\u540e\u624d\u662f$b_i$\uff08\u8bbe$a_i=f(i)$\uff0c\u5219$b_i=a_{A+i}=f(A+i)$\u3002\u8fd9\u4e2a\u5e73\u79fb\u53ef\u80fd\u53c8\u8981\u624b\u7b97\u4e00\u4e0b\uff09\u3002\u53ef\u4ee5\u53c2\u8003\u4ee3\u78012\uff08\u5982\u679c\u61d2\u5f97\u624b\u7b97\u5c31\u53c2\u8003\u4e00\u4e0b\u4ee3\u7801\u91cc\u7684\u90a3\u4e9b\u7cfb\u6570\uff09\u3002\n\n\u8fd9\u4e2a\u8bc1\u660e\u7b97\u662f\u6bd4\u8f83\u5b8c\u6574\u4e86\uff0c\u4f46\u597d\u50cf\u8fd8\u6709\u70b9\u95ee\u9898\uff0c\u6700\u540e\u8fd9\u4e2a\u5f0f\u5b50\u597d\u50cf\u6709\u70b9\u8fc7\u4e8e\u7b80\u5355\uff1f\u6709\u6ca1\u6709\u66f4\u597d\u7684\u8bc1\u660e\u65b9\u6cd5\uff1f\n\n### \u8bc1\u660e2\n\n\u4e3a\u4e86\u65b9\u4fbf\u8d77\u89c1\uff0c\u6839\u636e\u6211\u4eec\u4e0a\u9762\u7684\u8ba8\u8bba\uff0c\u6211\u4eec\u53ea\u8981\u8bc1\u660e\uff1a\u4e00\u5806\u724c\u6709$A$\u5f20\uff0c\u5176\u4e2d$a_i=(i-1)^\\frac k{}\\ (1\\leqslant i\\leqslant A)$\uff1b\u53e6\u4e00\u5806\u724c\u6709$n-A$\u5f20\uff0c\u5176\u4e2d\u6240\u6709\u724c\u7684\u6570\u90fd\u4e3a$0$\uff0c\u5219\u6d17\u5b8c\u724c\u540e\u6bcf\u5f20\u7684\u671f\u671b\u4e3a$\\begin{aligned}a_i'=(i-1)^\\frac k{}\\cdot\\frac{\\binom{n-k-1}{A-k-1}}{\\binom nA}\\end{aligned}\\ (1\\leqslant i\\leqslant n)$\u3002\uff08\u56e0\u4e3a\u524d\u9762\u8bf4\u7684\u201c\u4e00\u90e8\u5206\u201d\u5176\u5b9e\u5c31\u662f\u7b2c\u4e00\u5806\u5bf9\u7b54\u6848\u7684\u8d21\u732e\uff0c\u800c\u6211\u4eec\u8fd9\u91cc\u76f4\u63a5\u628a\u7b2c\u4e8c\u5806\u7684\u8d21\u732e\u7701\u7565\uff0c\u4e0b\u9762\u4e5f\u4e0d\u8ba8\u8bba\u7b2c\u4e8c\u5806\u7684\u8d21\u732e\uff0c\u56e0\u4e3a\u5c31\u662f$0$\uff09\u3002\n\n\u90a3\u4e48\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u6d17\u724c\u7684\u8fc7\u7a0b\u662f\u7ebf\u6027\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u6240\u6709\u7684\u6743\u503c\u90fd\u7f29\u5c0f\u5230\u539f\u6765\u7684$\\frac1{k!}$\uff0c\u6211\u4eec\u77e5\u9053$\\begin{aligned}\\frac{(i-1)^\\frac k{}}{k!}=\\frac{(i-1)!}{k!(i-1-k)!}=\\binom{i-1}{k}\\end{aligned}$\uff0c\u5219\u6211\u4eec\u53ea\u9700\u8981\u8bc1\u660e\u5f53$\\begin{aligned}a_i=\\binom{i-1}k\\end{aligned}$\u65f6\uff0c$\\begin{aligned}a_i'=\\frac{\\binom{i-1}k\\binom{n-k-1}{A-k-1}}{\\binom nA}\\end{aligned}$\u5373\u53ef\u3002\n\n\u6211\u4eec\u5148\u8bc1\u660e\u4e00\u4e2a\u524d\u9762\u63d0\u5230\u8fc7\u7684\u7ed3\u8bba\uff08\u8fd9\u91cc\u5199\u5f97\u6e05\u6670\u4e00\u4e9b\uff09\uff1a\u8fd9\u6837\u7684\u6d17\u724c\u76f8\u5f53\u4e8e\uff0c\u628a\u6240\u6709\u7684\u6df7\u5728\u4e00\u8d77\uff0c\u7136\u540e\u628a\u6bcf\u4e00\u5806\u4e2d\u7684\u5143\u7d20\uff0c\u6309\u5728\u539f\u6765\u5806\u4e2d\u7684\u987a\u5e8f\uff0c\u5728\u65b0\u5806\u4e2d\u6392\u597d\u3002\u53ef\u80fd\u6709\u70b9\u62bd\u8c61\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff1a\n\n\u4e3a\u4e86\u65b9\u4fbf\u8ba8\u8bba\uff0c\u8fd9\u91cc\u548c\u4e0b\u9762\u90fd\u7528\u989c\u8272\u4ee3\u8868\u6240\u5c5e\u7684\u5806\u3002\u5047\u8bbe\u4e24\u5806\u724c\u662f$\\color{red}1,\\color{red}2,\\color{red}3$\u548c$\\color{blue}4,\\color{blue}5,\\color{blue}6$\uff0c\u90a3\u4e48\u968f\u673a\u6253\u4e71\u540e\u6709\u53ef\u80fd\u662f\u8fd9\u6837\u7684\uff1a$\\color{red}2,\\color{red}1,\\color{blue}5,\\color{blue}4,\\color{red}3,\\color{blue}6$\uff0c\u7136\u540e$\\color{red}2,\\color{red}1,\\color{red}3$\u6392\u6210$\\color{red}1,\\color{red}2,\\color{red}3$\uff0c$\\color{blue}5,\\color{blue}4,\\color{blue}6$\u6392\u6210$\\color{blue}4,\\color{blue}5,\\color{blue}6$\uff0c\u7136\u540e\u6309$\\color{red}2,\\color{red}1,\\color{blue}5,\\color{blue}4,\\color{red}3,\\color{blue}6$\u7684\u989c\u8272\u63d2\u56de\u53bb\u53d8\u6210$\\color{red}1,\\color{red}2,\\color{blue}4,\\color{blue}5,\\color{red}3,\\color{blue}6$\u3002\u5dee\u4e0d\u591a\u5c31\u662f\u8fd9\u4e2a\u610f\u601d\u3002\n\n\u8bc1\u660e\u7684\u8bdd\u8003\u8651\u6d17\u724c\u7684\u8fc7\u7a0b\uff0c\u6211\u4eec\u4e0d\u8003\u8651\u6bcf\u4e00\u5f20\u724c\u5177\u4f53\u662f\u54ea\u4e00\u5f20\uff0c\u800c\u53ea\u8003\u8651\u989c\u8272\uff0c\u6709$\\frac X{X+Y}$\u7684\u6982\u7387\u62bd\u5230\u7ea2\u8272\uff0c\u800c\u7ea2\u8272\u6709$X$\u5f20\uff0c\u6240\u4ee5\u62bd\u5230\u7ea2\u8272\u7684\u7279\u5b9a\u4e00\u5f20\u7684\u6982\u7387\u662f$\\frac X{X+Y}\\cdot\\frac1X=\\frac1{X+Y}$\uff0c\u84dd\u8272\u540c\u7406\uff0c\u800c\u5269\u4e0b\u724c\u7684\u6570\u91cf\u521a\u597d\u662f$X+Y$\uff0c\u5c31\u76f8\u5f53\u4e8e\uff0c\u6bcf\u4e00\u6b21\u90fd\u968f\u673a\u6478\u4e00\u5f20\u724c\u3002\u8fd9\u4e0d\u5c31\u548c\u968f\u673a\u6253\u4e71\u4e00\u6837\u4e86\u5417\u3002\u800c\u6d17\u724c\u524d\u540e\u76f8\u5bf9\u4f4d\u7f6e\u4e0d\u53d8\uff0c\u6240\u4ee5\u6211\u4eec\u786e\u5b9a\u4e86\u989c\u8272\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u786e\u5b9a\u6bcf\u4e00\u5f20\u724c\u7684\u6570\u3002\u8fd9\u4e2a\u6027\u8d28\u53ef\u4ee5\u5f53\u7ed3\u8bba\u8bb0\u4e00\u4e0b\u3002\n\n\u6709\u4e86\u8fd9\u4e2a\u5f88\u597d\u7684\u6027\u8d28\uff0c\u8be5\u600e\u4e48\u7528\u5462\uff1f\n\n\u5148\u8003\u8651\u6709\u591a\u5c11\u79cd\u60c5\u51b5\uff0c\u663e\u7136\uff0c\u6839\u636e\u989c\u8272\u6253\u4e71\u540e\u6709$\\begin{aligned}\\binom nA\\end{aligned}$\u4e2d\u7b49\u6982\u7387\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u53ea\u8981\u7b97\u51fa\u6240\u6709\u60c5\u51b5\u4e0b$a_j'$\u7684\u548c\uff0c\u5148\u770b\u4e00\u4e0b$a_i$\u5bf9$a_j'$\u7684\u8d21\u732e\u3002\n\n\u56e0\u4e3a$\\begin{aligned}a_i=\\binom{i-1}k\\end{aligned}$\uff0c\u6211\u4eec\u628a\u5b83\u770b\u6210\uff0c\u5728$1$\u5230$i-1$\u4e2d\uff0c\u628a\u5176\u4e2d$k$\u4e2a\u505a\u4e0a\u6807\u8bb0\u7684\u65b9\u6848\u6570\u3002\u8003\u8651\u5bf9$a_j'$\u7684\u8d21\u732e\u65f6\uff0c\u8981\u628a$a_i$\u5f3a\u884c\u653e\u5230$a_j'$\u4e0a\uff0c\u6b64\u65f6\uff08\u6d17\u724c\u540e\u7684\u6392\u961f\u4e2d\uff09$1$\u5230$j-1$\u8fd8\u8981\u518d\u9009$i-1$\u4e2a\u7ea2\u7684\uff0c\u540e\u9762$j+1$\u5230$n$\u4e2d\u8fd8\u8981\u9009$A-i$\u4e2a\u7ea2\u7684\uff0c\u7136\u540e\u7edf\u8ba1\u65b9\u6848\u6570\uff0c\u800c$\\begin{aligned}a_i=\\binom{i-1}k\\end{aligned}$\uff0c\u6240\u4ee5\u5b83\u7684\u8d21\u732e\u8fd8\u8981\u518d\u4e58\u4e0a$a_i$\uff0c\u4e5f\u5c31\u662f\u76f8\u5f53\u4e8e\u518d\u5728$1$\u5230$j-1$\u4e2d\u7684$i-1$\u4e2a\u7ea2\u7684\uff0c\u8fd8\u8981\u518d\u9009$k$\u4e2a\u505a\u6807\u8bb0\uff0c\u8d21\u732e\u5176\u5b9e\u662f\u8fd9\u6837\u4e00\u4e2a\u65b9\u6848\u6570\u3002\u7406\u4e00\u4e0b\uff0c\u5176\u5b9e\u5c31\u662f\u76f8\u5f53\u4e8e\u5728$1$\u5230$j-1$\u4e2d\uff0c\u6709$k$\u4e2a\u505a\u4e86\u6807\u8bb0\uff0c\u8fd8\u6709$i-k-1$\u4e2a\u7ea2\u7684\uff0c\u800c\u5728$j+1$\u5230$n$\u4e2d\uff0c\u6709$A-i$\u4e2a\u7ea2\u7684\u3002\n\n\u5f53\u6211\u4eec\u8003\u8651\u6574\u4e2a\u7684\u8d21\u732e\u65f6\uff0c\u56e0\u4e3a$1\\leqslant i\\leqslant A$\uff0c\u6240\u4ee5\u5728$j$\u524d\u540e\u53ef\u4ee5\u6709\u6240\u6709\u60c5\u51b5\u7684\u7ea2\u8272\u7684\u4e2a\u6570\uff0c\u6240\u4ee5\u76f8\u5f53\u4e8e\u5728$1$\u5230$j-1$\u4e2d\u6807\u8bb0$k$\u4e2a\uff0c\u5728\u5269\u4e0b\u6ca1\u6709\u6807\u8bb0\u4e14\u4e0d\u662f$j$\u7684\u4f4d\u5b50\u4e0a\uff08\u4e00\u5171\u6709$n-k-1$\u4e2a\u4f4d\u7f6e\uff09\uff0c\u9009$A-k-1$\u4e2a\u7ea2\u7684\uff0c\u6240\u4ee5\u603b\u7684\u548c\u662f$\\begin{aligned}\\binom{j-1}k\\binom{n-k-1}{A-k-1}\\end{aligned}$\u3002\n\n\u800c\u6211\u4eec\u77e5\u9053\u603b\u7684\u60c5\u51b5\u6570\u662f$\\begin{aligned}\\binom nA\\end{aligned}$\uff0c\u6240\u4ee5$\\begin{aligned}a_j'=\\frac{\\binom{j-1}k\\binom{n-k-1}{A-k-1}}{\\binom nA}\\end{aligned}$\uff0c\u548c\u524d\u9762\u6211\u4eec\u8981\u8bc1\u660e\u7684\u5f0f\u5b50\u4e00\u6a21\u4e00\u6837\uff01\n\n\u6240\u4ee5\u6211\u4eec\u7528\u4e86\u4e00\u4e2a\u975e\u5e38\u5de7\u5999\u7684\u65b9\u6cd5\u8bc1\u51fa\u6765\u4e86\uff0c\u6211\u89c9\u5f97\u8fd9\u4e2a\u8bc1\u660e\u65b9\u6cd5\u8fd8\u662f\u975e\u5e38\u795e\u5947\u7684\uff08\u6211\u60f3\u4e86\u597d\u4e45\uff09\u3002\n\n------\n\n\u597d\u4e86\uff0c\u8bf4\u4e86\u8fd9\u4e48\u591a\uff0c\u53ef\u4ee5\u4e0a\u4ee3\u7801\u4e86\u3002\n\n#### \u4ee3\u78011\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int kcz=998244353;\nconst int maxn=10000005;\nll a,b,c,f[maxn];\nint n;\ninline ll qpow(ll a,ll k)\n{\n    ll res=1;\n    while(k)\n    {\n        if(k&1) res=res*a%kcz;\n        if(k>>=1) a=a*a%kcz;\n    }\n    return res;\n}\ninline ll calc(ll x) { return ((a*x+b)%kcz*x+c)%kcz; } // \u7b97\u7b2cx\u4e2a\u6570\u7684\u671f\u671b\nint main()\n{\n    int m,tp,i;\n    ll _,__,t1,t2,t3,t,___,sqn;\n    freopen(\"landlords.in\",\"r\",stdin),freopen(\"landlords.out\",\"w\",stdout);\n    scanf(\"%d%d%d\",&n,&m,&tp),sqn=n*(ll)n%kcz;\n    _=qpow(n-1,kcz-2),__=qpow(n,kcz-2),___=qpow((-sqn+3*n-2)%kcz,kcz-2);\n    if(tp==1) a=c=0,b=1;\n    else a=1,b=c=0; // x_i=ai^2+bi+c\n    while(m--)\n    {\n        scanf(\"%lld\",&t);\n        if(t==0 || t==n) continue;\n        t1=(calc(1)*t+calc(t+1)*(n-t))%kcz*__%kcz; // \u7b2c\u4e00\u4e2a\n        t2=((calc(2)*(t-1)+calc(t+1)*(n-t))%kcz*t+(calc(1)*t+calc(t+2)*(n-t-1))%kcz*(n-t))%kcz*__%kcz*_%kcz; // \u7b2c\u4e8c\u4e2a\n        t3=(calc(t)*t+calc(n)*(n-t))%kcz*__%kcz; // \u7b2cn\u4e2a\n        a=((2-n)*t1+(n-1)*t2-t3)%kcz*___%kcz;\n        b=((sqn-4)*t1+(1-sqn)*t2+3*t3)%kcz*___%kcz;\n        c=((4*n-2*sqn)*t1+(sqn-n)*t2-2*t3)%kcz*___%kcz; // \u6781\u5176\u4e11\u7684\u5dee\u503c\n    }\n    for(i=1;i<=n;i++)\n        f[i]=(calc(i)+kcz)%kcz;\n    scanf(\"%d\",&m);\n    while(m--)\n        scanf(\"%lld\",&t),printf(\"%lld\\n\",f[t]);\n    fclose(stdin),fclose(stdout);\n    return 0;\n}\n```\n\n#### \u4ee3\u78012\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int kcz=998244353;\nconst int maxn=10000005;\nll a,b,c,a_,b_,c_,fac[maxn],inv[maxn],inv_fac[maxn];\nint n;\ninline ll f(ll x) { return (a+b*(x-1)+c*(x-1)%kcz*(x-2))%kcz; } // \u7b97\u7b2cx\u4e2a\u6570\u7684\u671f\u671b\ninline ll C(int n,int m) { return (m>=0 && m<=n)?fac[n]*inv_fac[m]%kcz*inv_fac[n-m]%kcz:0; } // \u5224\u4e00\u4e0b0\u7684\u60c5\u51b5\ninline ll invC(int n,int m) { return inv_fac[n]*fac[m]%kcz*fac[n-m]%kcz; }\nint main()\n{\n    int i,q,op,A;\n    ll t;\n    freopen(\"landlords.in\",\"r\",stdin),freopen(\"landlords.out\",\"w\",stdout);\n    scanf(\"%d%d%d\",&n,&q,&op);\n    if(op==1) a=b=1,c=0; // a_i=a+b*(i-1)+c*(i-1)*(i-2)\n    else a=1,b=3,c=1;\n    fac[0]=inv_fac[0]=inv[1]=fac[1]=inv_fac[1]=1;\n    for(i=2;i<=n;i++)\n    {\n        fac[i]=fac[i-1]*i%kcz;\n        inv[i]=-(kcz/i)*inv[kcz%i]%kcz;\n        inv_fac[i]=inv_fac[i-1]*inv[i]%kcz;\n    }\n    while(q--)\n    {\n        scanf(\"%d\",&A);\n        a_=(a+b*A+c*A%kcz*(A-1ll))%kcz; // \u5e73\u79fbx->x+A\n        b_=(b+c*2*A)%kcz;\n        c_=c;\n        t=invC(n,A);\n        a=(a*C(n-1,A-1)+a_*C(n-1,n-A-1))%kcz*t%kcz; // \u66f4\u65b0\u7cfb\u6570\n        b=(b*C(n-2,A-2)+b_*C(n-2,n-A-2))%kcz*t%kcz;\n        c=(c*C(n-3,A-3)+c_*C(n-3,n-A-3))%kcz*t%kcz;\n    }\n    scanf(\"%d\",&q);\n    while(q--)\n        scanf(\"%d\",&i),printf(\"%lld\\n\",(f(i)+kcz)%kcz);\n    fclose(stdin),fclose(stdout);\n    return 0;\n}\n```",
        "postTime": 1563589904,
        "uid": 36998,
        "name": "ljc1301",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5472 \u3010[NOI2019]\u6597\u4e3b\u5730\u3011"
    },
    {
        "content": "\u90a3\u6211\u4eec\u5148\u6765\u770b\u770b\u90e8\u5206\u5206\u5427\u3002\n\n### \u7b97\u6cd5 $1$\uff1a\u66b4\u641c\n\n\u671f\u671b\u5f97\u5206 $10pts$\n\n### \u7b97\u6cd5 $2$\uff1a$dp$\n\n$f[i][j]$ \u4e3a\u5de6\u8fb9 $i$ \u5f20\u724c\uff0c\u53f3\u8fb9 $j$ \u5f20\u724c\u7684\u6982\u7387\u3002\n\n\u7136\u540e\u6211\u4eec\u5728\u8f6c\u79fb $f[i][j]$ \u65f6\u987a\u4fbf\u7b97\u7b97\u671f\u671b\u5c31\u884c\u4e86\uff0c\u671f\u671b\u5f97\u5206 $30pts$\n\n```cpp\nfor(int i=1;i<=m;i++)\n{\n    memset(f,0,sizeof(f));\n    memset(h,0,sizeof(h));\n    f[a[i]][n-a[i]]=1;\n    for(int j=1;j<=a[i];j++) l[j]=g[j];\n    for(int j=1;j<=n-a[i];j++) r[j]=g[j+a[i]];\n    for(int j=a[i];j>=0;j--)\n        for(int k=n-a[i];k>=0;k--)\n        {\n            if(!f[j][k]) continue;\n            if(j>0)\n            {\n                ll tmp=f[j][k]*j%mod*inv(j+k)%mod;\n                (f[j-1][k]+=tmp)%=mod;\n                (h[n-j-k+1]+=tmp*l[j])%=mod;\n            }\n            if(k>0)\n            {\n                ll tmp=f[j][k]*k%mod*inv(j+k)%mod;\n                (f[j][k-1]+=tmp)%=mod;\n                (h[n-j-k+1]+=tmp*r[k])%=mod;\n            }\n        }\n    for(int j=1;j<=n;j++) g[j]=h[n-j+1];\n}\n```\n\n### \u7b97\u6cd5 $3$\uff1a\u5f53 $a_i$ \u5168\u76f8\u7b49\uff0c\u77e9\u9635\u5feb\u901f\u5e42\n\n\u628a $dp$ \u7684\u5f62\u5f0f\u8f6c\u6210\u77e9\u9635\uff0c\u66b4\u529b\u500d\u589e\u3002\u914d\u5408\u7b97\u6cd5 $3$\uff0c\u671f\u671b\u5f97\u5206 $40pts$\n\n### \u7b97\u6cd5 $4$\uff1a\u731c\u7ed3\u8bba\n\n\u4f60\u8981\u77e5\u9053\uff0c\u8fd9\u9053\u9898\u731c\u4e2a\u7ed3\u8bba\u5c31 AC \u4e86\u3002\n\n~~\u867d\u7136\u6211\u4e5f\u4e0d\u4f1a\u8bc1~~\n\n\u56e0\u4e3a\u8fd9\u4e2a\u5206\u6570\u975e\u5e38\u7279\u6b8a\uff0c\u6211\u4eec\u53ef\u4ee5\u731c\uff1a\n\n**\u4e00\u6b21\u51fd\u6570\u6d17\u724c\u540e\u7684\u671f\u671b\u662f\u4e00\u6b21\u51fd\u6570\uff0c\u4e8c\u6b21\u51fd\u6570\u6d17\u724c\u540e\u7684\u671f\u671b\u662f\u4e8c\u6b21\u51fd\u6570\u3002**\n\n\u8003\u540e\u6211\u590d\u5236\u4e86\u4e00\u4e2a\u591a\u9879\u5f0f\u63d2\u503c\u7684\u677f\u5b50\uff0c\u9a8c\u8bc1\u4e00\u4e0b\uff0c\u53d1\u73b0\u8fd9\u4e2a\u7ed3\u8bba\u662f\u6b63\u786e\u7684\u3002\n\n\u7136\u540e\u4f60\u4f1a\u53d1\u73b0\u4f60\u7528\u7b97\u6cd5 $2$\uff0c\u628a\u524d\u4e09\u9879\u641e\u51fa\u6765\u5bf9\u4e8c\u6b21\u51fd\u6570\u6c42\u4e2a A,B,C \u5c31\u884c\u4e86\u2026\u2026\n\n$$A+B+C\\equiv X(\\text{mod}\\ 998244353)$$\n\n$$3A+2B+C\\equiv Y(\\text{mod}\\ 998244353)$$\n\n$$9A+3B+C\\equiv Z(\\text{mod}\\ 998244353)$$\n\n\u63a8\u51fa\uff1a\n\n$$A\\equiv \\frac {Z-2Y+X}{2}(\\text{mod}\\ 998244353)$$\n\n$$B\\equiv \\frac {8Y-5X-3Z}{2}(\\text{mod}\\ 998244353)$$\n\n$$C\\equiv 3X-3Y+Z(\\text{mod}\\ 998244353)$$\n\n$Code\\ Below:$\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int maxn=500000+10;\nconst int maxm=10000000+10;\nconst int mod=998244353;\nconst int inv2=(mod+1)>>1;\nint n,m,q,type;ll A,B,C,f[10][10],g[10],h[10],w[10],inv[maxm];\n\ninline ll F(int x) {return (A*x%mod*x+B*x+C)%mod;}\n\nint main()\n{\n    scanf(\"%d%d%d\",&n,&m,&type);\n    inv[0]=inv[1]=1;\n    for(int i=2;i<=n;i++) inv[i]=(mod-mod/i)*inv[mod%i]%mod;\n    if(type==1) A=0,B=1,C=0;\n    else A=1,B=0,C=0;\n    int tmp;ll X,Y,Z;\n    for(int i=1;i<=m;i++)\n    {\n        scanf(\"%d\",&tmp);\n        for(int j=1;j<=3;j++) g[j]=F(j),h[j]=F(j+tmp),w[j]=0;\n        for(int j=0;j<3;j++)\n            for(int k=0;k<3;k++) f[j][k]=0;\n        f[0][0]=1;\n        for(int j=0;j<3;j++)\n            for(int k=0;k<3;k++)\n            {\n                if(j+k>=3) break;\n                if(j<tmp)\n                {\n                    ll val=f[j][k]*(tmp-j)%mod*inv[n-j-k]%mod;\n                    (f[j+1][k]+=val)%=mod;\n                    (w[j+k+1]+=val*g[j+1])%=mod;\n                }\n                if(k<n-tmp)\n                {\n                    ll val=f[j][k]*(n-tmp-k)%mod*inv[n-j-k]%mod;\n                    (f[j][k+1]+=val)%=mod;\n                    (w[j+k+1]+=val*h[k+1])%=mod;\n                }\n            }\n        X=w[1];Y=w[2];Z=w[3];\n        A=((Z-2*Y+X)*inv2%mod+mod)%mod;\n        B=((8*Y-5*X-3*Z)*inv2%mod+mod)%mod;\n        C=((3*X-3*Y+Z)%mod+mod)%mod;\n    }\n    scanf(\"%d\",&q);\n    while(q--)\n    {\n        scanf(\"%d\",&tmp);\n        printf(\"%lld\\n\",F(tmp));\n    }\n    return 0;\n}\n```\n\n\u603b\u7ed3\uff1a\u8fd9\u4e2a\u6545\u4e8b\u544a\u8bc9\u6211\u4eec\uff0c\u6709\u4e9b\u65f6\u5019\u8981\u5927\u529b\u731c\u7ed3\u8bba\uff0c\u5c0f\u5fc3\u9a8c\u8bc1\u3002",
        "postTime": 1563584002,
        "uid": 35069,
        "name": "Owen_codeisking",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5472 \u3010[NOI2019]\u6597\u4e3b\u5730\u3011"
    },
    {
        "content": "\u5047\u8bbe\u5de6\u8fb9 $L$ \u5f20\u724c\u53f3\u8fb9 $R$ \u5f20\u724c\uff0c\u603b\u5171 $N=L+R$ \u5f20\u3002\n\n\u5de6\u8fb9\u4ece\u4e0a\u5f80\u4e0b\u7b2c $x$ \u5f20\u724c\u5bf9\u5408\u5e76\u8fc7\u540e\u4ece\u4e0a\u5f80\u4e0b\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u4ea7\u751f\u8d21\u732e\uff08\u8981\u6ee1\u8db3 $i\\in[x,x+R]$\uff09\n\n$${i-1\\choose x-1}{N-i\\choose L-x}w_x$$\n\n\u5bf9\u67d0\u4e2a\u4f4d\u7f6e\u6c42\u671f\u671b\u6743\u503c\uff0c\u5c31\u628a $i$ \u770b\u6210\u5e38\u6570\uff0c\u5148\u5bf9\u5de6\u8fb9\u6240\u6709\u7684 $x$ \u6c42\u548c\u3002\u9ed8\u8ba4 $x$ \u5728\u5408\u6cd5\u8303\u56f4\u3002\u8bf7\u6ce8\u610f\u8fd9\u91cc\u5f80\u4e0b\u4e3a\u4e86\u65b9\u4fbf\u6ca1\u6709\u9664\u4ee5 ${n\\choose L}$\u3002\n\n$$\\sum_{x}{i-1\\choose x-1}{N-i\\choose L-x}w_x$$\n\n\u8003\u8651\u5f53 $w_x=x$ \u65f6\uff0c\u53d8\u6210\n\n$$\\sum_{x}{i-1\\choose x-1}{N-i\\choose L-x}x$$\n\n\u8003\u8651\u6d88\u53bb $x$\n\n$$\n\\begin{aligned}\n&\\sum_x{i-1\\choose x-1}{N-i\\choose L-x}x\\\\\n=&\\sum_x\\left({i\\choose x}-{i-1\\choose x}\\right){N-i\\choose L-x}x\\\\\n=&\\sum_x\\left(i{i-1\\choose x-1}-(i-1){i-2\\choose x-1}\\right){N-i\\choose L-x}\n\\end{aligned}\n$$\n\n\u53d1\u73b0 $x$ \u6d88\u6389\u4e86\uff0c\u5269\u4e0b\u7684\u5f88\u5bb9\u6613\u6839\u636e **\u8303\u5fb7\u8499\u6052\u7b49\u5f0f** \u5f97\u5230\u7ed3\u679c\u4e3a\n\n$$\\left\\{{N-1\\choose L-1}-{N-2\\choose L-1}\\right\\}i+{n-2\\choose L-1}$$\n\n\u6211\u4eec\u53d1\u73b0\u4e00\u4e2a\u5148\u524d\u5173\u4e8e\u4f4d\u7f6e\u7684\u4e00\u6b21\u5f0f\uff08$x$\uff09\u5728\u4e00\u8f6e\u64cd\u4f5c\u540e\u5f97\u5230\u7684\u4ecd\u7136\u662f\u5173\u4e8e\u4f4d\u7f6e\u7684\u4e00\u6b21\u5f0f\uff08\u53d8\u6210\u4e86 $i$\uff09\uff01\u8fd9\u542f\u8fea\u6211\u4eec\u53bb\u7ef4\u62a4\u4e00\u4e2a\u7c7b\u4f3c\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u3002\n\n\u53cd\u590d\u901a\u8fc7\u4e0a\u9762\u7684\u65b9\u6cd5\uff0c\u5229\u7528\u7ec4\u5408\u9012\u63a8\u5f0f\u51d1\u51fa\u6765 $x$ \u7ea6\u5206\uff0c\u4e00\u8f6e\u63a8\u5bfc\u540e\u6211\u4eec\u5f97\u5230\u4e0b\u5217\u4e09\u5927\u5173\u7cfb\uff1a\n\n$$1\\rightarrow{n-1\\choose L-1}$$\n\n$$i\\rightarrow\\left\\{{n-1\\choose L-1}-{n-2\\choose L-1}\\right\\}i+{n-2\\choose L-1}$$\n\n$$i^2\\rightarrow\\left\\{{n-1\\choose L-1}-2{n-2\\choose L-1}+{n-3\\choose L-1}\\right\\}i^2+3\\left\\{{n-2\\choose L-1}-{n-3\\choose L-1}\\right\\}i+\\left\\{{n-2\\choose L-1}-2{n-3\\choose L-1}\\right\\}$$\n\n\u5bf9\u4e8e $R$ \u7531\u5bf9\u79f0\u6027\uff0c\u540c\u7406\u3002\u540c\u7406\uff1f\n\n\u4e0d\u5b8c\u5168\u4e00\u81f4\uff01\u6ce8\u610f\u5230\u5206\u5b8c\u5de6\u8fb9\u7684\u724c\u4ee5\u540e\uff0c\u53f3\u8fb9\u724c\u6700\u5c0f\u7f16\u53f7 $r_{min}=L+1$ \u53ef\u80fd $>1$\uff0c\u800c\u6211\u4eec\u7684 $i$ \u4ece $1$ \u5f00\u59cb\u6c42\u548c\u3002\u6211\u4eec\u4e3a\u4e86\u4ece $L+1$ \u5f00\u59cb\u6c42\u548c\uff0c\u5f3a\u5236\u8ba9 $i\\rightarrow i+L$\uff0c\u5c55\u5f00\u5f0f\u5b50\u8ba1\u7b97\u7cfb\u6570\n\n$$ai^2+bi+c\\rightarrow a(i+L)^2+b(i+L)+c=ai^2+(2aL+b)i+(aL^2+bL+c)$$\n\n\u8fd9\u6837\u6211\u4eec\u4ecd\u7136\u80fd\u591f\u5957\u7528\u524d\u9762\u7684\u53d8\u6362\u4e86\u3002\u6700\u7ec8\u590d\u6742\u5ea6 $\\mathcal O(n+md^2+Q)$\uff0c$d$ \u8868\u793a\u6700\u9ad8\u6b21\u6570 $+1$\uff0c\u8fd9\u91cc\u662f $3$\u3002\u6bcf\u8f6e\u522b\u5fd8\u4e86\u9664\u6389 ${n\\choose L}$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nconst int N = 10000007, P = 998244353;\nint n, m, Q, type, fac[N], ifac[N], inv[N];\nint C(int n, int m) {\n\tif (m < 0 || m > n) return 0;\n\treturn 1LL * fac[n] * ifac[m] % P * ifac[n - m] % P;\n}\nint qpow(int a, int b) {\n\tint t = 1;\n\tfor (; b; b >>= 1, a = 1LL * a * a % P)\n\t\tif (b & 1) t = 1LL * t * a % P;\n\treturn t;\n}\nstruct Node {\n\tint a, b, c;\n\tNode(int a, int b, int c) : a(a), b(b), c(c) {};\n};\nint main() {\n\tscanf(\"%d%d%d\", &n, &m, &type);\n\tinv[1] = fac[0] = ifac[0] = 1;\n\tfor (int i = 2; i <= n; i++)\n\t\tinv[i] = 1LL * (P - P / i) * inv[P % i] % P;\n\tfor (int i = 1; i <= n; i++)\n\t\tfac[i] = 1LL * fac[i - 1] * i % P, ifac[i] = 1LL * ifac[i - 1] * inv[i] % P;\n\tNode res = Node(0, type == 1, type == 2);\n\tfor (int i = 1; i <= m; i++) {\n\t\tint L, R; scanf(\"%d\", &L); R = n - L;\n\t\tNode tmpl = res, tmpr = Node((1LL * res.c * L % P * L + 1LL * res.b * L + res.a) % P, (2LL * res.c * L + res.b) % P, res.c);\n\t\tres.a = (1LL * tmpl.a * C(n - 1, L - 1) % P + 1LL * tmpl.b * C(n - 2, L - 1) % P + 1LL * tmpl.c * ((C(n - 2, L - 1) - 2LL * C(n - 3, L - 1)) % P + P) % P\n\t\t\t   + 1LL * tmpr.a * C(n - 1, R - 1) % P + 1LL * tmpr.b * C(n - 2, R - 1) % P + 1LL * tmpr.c * ((C(n - 2, R - 1) - 2LL * C(n - 3, R - 1)) % P + P) % P) % P;\n\t\tres.b = (1LL * tmpl.b * (C(n - 1, L - 1) - C(n - 2, L - 1) + P) % P + 3LL * tmpl.c * (C(n - 2, L - 1) - C(n - 3, L - 1) + P) % P\n\t\t\t   + 1LL * tmpr.b * (C(n - 1, R - 1) - C(n - 2, R - 1) + P) % P + 3LL * tmpr.c * (C(n - 2, R - 1) - C(n - 3, R - 1) + P) % P) % P;\n\t\tres.c = (1LL * tmpl.c * ((C(n - 1, L - 1) - 2LL * C(n - 2, L - 1) + C(n - 3, L - 1)) % P + P)\n\t\t\t   + 1LL * tmpr.c * ((C(n - 1, R - 1) - 2LL * C(n - 2, R - 1) + C(n - 3, R - 1)) % P + P)) % P;\n\t\tint Inv = qpow(C(n, L), P - 2);\n\t\tres.a = 1LL * res.a * Inv % P;\n\t\tres.b = 1LL * res.b * Inv % P;\n\t\tres.c = 1LL * res.c * Inv % P;\n\t}\n\tscanf(\"%d\", &Q);\n\twhile (Q--) {\n\t\tint c; scanf(\"%d\", &c);\n\t\tprintf(\"%lld\\n\", (1LL * c * c % P * res.c + 1LL * c * res.b + res.a) % P);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1620055727,
        "uid": 7706,
        "name": "AC_Evil",
        "ccfLevel": 9,
        "title": "[NOI2019] \u6597\u4e3b\u5730 \u9898\u89e3"
    },
    {
        "content": "## ~~\u65e2\u7136\u767e\u5ea6\u7684\u9898\u89e3\u90fd\u662f\u62c9\u683c\u6717\u65e5\u63d2\u503c\uff0c\u6211\u6765\u5199\u4e00\u4e2a\u521d\u4e2d\u6570\u5b66\u6c34\u5e73\u7684~~\n\n\u9996\u5148\u770b\u5230\u5404\u6b21\u6d17\u724c\u662f\u65e0\u5173\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u4e00\u6b21\u6b21\u6765\n\n\u7136\u540e\u5bf9\u4e8e\u7b2c\u4e00\u5806\u6709$a$\u4e2a\uff0c\u9009\u5230\u6b63\u6570\u7b2c$i$\u4e2a\uff0c\u7b2c\u4e8c\u5806\u6709$b$\u4e2a\uff0c\u9009\u5230\u7b2c$j$\u4e2a\uff0c\u6211\u4eec\u8bb0\u8fd9\u79cd\u60c5\u51b5\u53d1\u751f\u7684\u6982\u7387\u4e3a$E_{a,b,i,j}$\uff0c\u4e0d\u96be\u770b\u51fa\u65b0\u7684$a_i'=\\sum^A_{i=0}\\sum^{n-A-i}_{j=0}\\frac{i\\times a_i+j\\times a_{A+j}}{i+j}\\times E_{A,n-A,i,j}$\uff08\u82e5$i\\le 0,i>A,j\\le 0,j>n-A$\u5219\u5bf9\u5e94\u9879\u4e3a$0$\uff09\n\n\u90a3\u4e48\u8fd9\u4e2a$E_{a,b,i,j}$\u600e\u4e48\u6c42\u5462\uff1f\u5982\u679c\u6211\u4eec\u5148\u9009\u5230\u7b2c\u4e00\u5806\u7684$i$\u4e2a\uff0c\u518d\u9009\u5230\u7b2c\u4e8c\u5806\u7684$j$\u4e2a\uff0c\u5219\u6982\u7387\u4e3a$\\frac{a\\times (a-1)\\times(a-2)\\times\\cdots\\times(i+1)\\times b\\times (b-1)\\times (b-2)\\times\\cdots\\times(j+1)}{(a+b)\\times (a+b-1)\\times(a+b-2)\\times\\cdots\\times(i+j+1)}$\uff1b\u82e5\u5148\u9009\u5230\u7b2c\u4e8c\u5806\u7684$j$\u4e2a\uff0c\u518d\u9009\u5230\u7b2c\u4e00\u5806\u7684$i$\u4e2a\uff0c\u5219\u6982\u7387\u4e3a$\\frac{b\\times (b-1)\\times (b-2)\\times\\cdots\\times(j+1)\\times a\\times (a-1)\\times(a-2)\\times\\cdots\\times(i+1)}{(a+b)\\times (a+b-1)\\times(a+b-2)\\times\\cdots\\times(i+j+1)}$\u3002\n\n**\u5b83\u4eec\u662f\u4e00\u6837\u7684\uff01**\n\n\u5bf9\u4e8e\u5176\u5b83\u60c5\u51b5\uff0c\u6613\u77e5\u6982\u7387\u4ecd\u662f\u4e00\u6837\u7684\uff0c\u5747\u4e3a$\\frac{\\frac{a!}{i!}\\times\\frac{b!}{j!}}{\\frac{(a+b)!}{(i+j)!}}=\\frac{a!\\times b!\\times (i+j)!}{(a+b)!\\times i!\\times j!}$\uff0c\u800c\u5f88\u5bb9\u6613\u770b\u51fa\u60c5\u51b5\u6709$C^{a-i}_{a-i+b-j}=\\frac{(a-i+b-j)!}{(a-i)!\\times (b-j)!}$\u79cd\uff0c\u7528~~\u4eba\u5c3d\u7686\u77e5\u7684~~$O(n+log998244353)$[\u65b9\u6cd5](https://www.luogu.org/problemnew/show/P5431)\u6c42\u51fa$i^{-1}$\uff0c$i!$\u548c$(i!)^{-1}(mod998244353)$\u5c31\u53ef\u4ee5$O(1)$\u6c42$E_{a,b,i,j}$\uff0c\u5957\u4e0a$dp$\u5c31\u662f$O(mn^2)$\u7684\uff0c\u62ff\u5230$30pts$\uff0c\u52a0\u4e0a\u77e9\u9635\u52a0\u901f\u5373\u53ef\u4ee5\u62ff\u5230$40pts$\u3002\n\n$100pts$\u600e\u4e48\u62ff\u5462\uff1f\u8ba9\u6211\u4eec\u89c2\u5bdf\u6837\u4f8b\u91cc4\u4e2a\u4f4d\u7f6e\u7684\u671f\u671b\u5206\u6570\uff1a$\\frac{7}{4},\\frac{9}{4},\\frac{11}{4},\\frac{13}{4}$\n\n**\u5b83\u4eec\u662f\u7b49\u5dee\u6570\u5217\uff01**\n\n\u4e8e\u662f\u6211\u4eec\u5927\u80c6\u731c\u60f3\uff1a$type=2$\u65f6\u7b54\u6848\u662f\u4e8c\u9636\u7b49\u5dee\u6570\u5217\uff0c~~\u6253\u8868~~\u53ef\u8bc1\u8fd9\u4e2a\u7ed3\u8bba\u662f\u6b63\u786e\u7684\n\n\u7531\u4e8e\u7b49\u5dee\u6570\u5217\u53ef\u4ee5\u770b\u4f5c\u7279\u6b8a\u7684\u4e8c\u9636\u7b49\u5dee\u6570\u5217\uff0c\u6240\u4ee5\u53ea\u63a8\u51fa\u524d3\u9879\u5c31\u53ef\u4ee5\u6c42\u51fa\u6574\u4e2a\u6570\u5217\u4e86\uff0c\u590d\u6742\u5ea6\u4e0b\u964d\u5230$O(m)$\uff0c\u53ef\u4ee5AC\n\n\u53ef\u600e\u4e48\u6c42\u5462\uff1fdalao\u4eec\u90fd\u7528\u62c9\u683c\u6717\u65e5\u63d2\u503c\uff0c\u672c\u849f\u84bb\u63d0\u51fa\u4e00\u4e2a\u5c0f\u5b66\u65b9\u6cd5\uff1a\n\n\u8bbe$d=a_2-a_1,d'=(a_3-a_2)-(a_2-a_1)=a_3+a_1-2a_2$\uff0c\u5219\u6839\u636e$d'$\u4e3a\u6570\u5217\u7684\u4e8c\u9636\u516c\u5dee\uff0c\u5219$a_2=a_1+d$\uff0c$a_3=a_1+d+(d+d')$\uff0c$a_4=a_1+d+(d+d')+(d+2d')$\uff0c\u2026\u2026\uff0c$a_i=a_1+(i-1)d+[1+2+\\cdots+(i-2)]d'=a_1+(i-1)d+\\frac{(i-1)(i-2)}{2}d'$\u3002\n\n\u90a3\u4e48\u5c31\u53ef\u4ee5\u6109\u5feb\u5730\u4e0a\u4ee3\u7801\u4e86~\n\n```cpp\n#include<cstdio>\ntypedef long long ll;\nconst int mod=998244353;\nconst int N=10000050;\nchar rB[1<<21],*S,*T,wB[1<<21];\nint wp=-1;\ninline char gc(){return S==T&&(T=(S=rB)+fread(rB,1,1<<21,stdin),S==T)?EOF:*S++;}\ninline void flush(){fwrite(wB,1,wp+1,stdout);wp=-1;}\ninline void pc(char c){if(wp+1==(1<<21))flush();wB[++wp]=c;}\ninline int rd(){\n    char c=gc();\n    while(c<48||c>57)c=gc();\n    int x=c&15;\n    for(c=gc();c>=48&&c<=57;c=gc())x=(x<<3)+(x<<1)+(c&15);\n    return x;\n}\nshort buf[15];\ninline void wt(int x){\n    short l=-1;\n    while(x>9){\n        buf[++l]=x%10;\n        x/=10;\n    }\n    pc(x|48);\n    while(l>=0)pc(buf[l--]|48);\n    pc('\\n');\n}\nint a[5],b[5],c[5],f[N],g[N],v[N],n;\nvoid exgcd(int a,int b,int &x,int &y){\n    if(!b){x=1;y=0;}\n    else{\n        exgcd(b,a%b,y,x);\n        y-=a/b*x;\n    }\n}\ninline int inv(int a){\n    int x,y;\n    exgcd(a,mod,x,y);\n    return x<0?x+mod:x;\n}\ninline int E(int a,int b,int p,int q){  //\u7b97E\n    return (ll)g[n]*f[p+q]%mod*f[a]%mod*g[p]%mod*f[b]%mod*g[q]%mod*f[n-p-q]%mod*g[a-p]%mod*g[b-q]%mod;\n}\ninline int val(int p){  //\u6839\u636ea1,a2,a3\u7b97ap\n    if(p>n)return 0;\n    int d=(a[2]-a[1]+mod)%mod,dd=((ll)a[3]+a[1]-(a[2]<<1)+(mod<<1))%mod;\n    return (a[1]+(ll)d*(p-1)+(ll)dd*(p-1)%mod*(p-2)%mod*499122177)%mod;  //499122177\u662f2\u7684\u9006\u5143\n}\nint main(){\n    int m,q,type,i,j,A;\n    n=rd();m=rd();type=rd();\n    f[0]=g[0]=1;\n    for(i=1;i<=n;++i)f[i]=(ll)f[i-1]*i%mod;\n    v[n]=(ll)(g[n]=inv(f[n]))*f[n-1];\n    for(i=n-1;i;--i)v[i]=(ll)(g[i]=(ll)g[i+1]*(i+1)%mod)*f[i-1];\n    if(type==1){a[1]=1;a[2]=2;a[3]=3;}\n    else{a[1]=1;a[2]=4;a[3]=9;}\n    while(m--){\n        A=rd();\n        b[1]=a[1];b[2]=A>=2?a[2]:0;b[3]=A>=3?a[3]:0;\n        c[1]=val(1+A);c[2]=val(2+A);c[3]=val(3+A);\n//\u628aa\u8981\u7528\u5230\u7684\u503c\u5206\u4e24\u5806\u5b58\u4e0b\u6765\uff0ca\u5c31\u53ef\u4ee5\u88ab\u8986\u76d6\u6389\u4e86\n        a[1]=a[2]=a[3]=0;\n        for(i=0;i<=3&&i<=A;++i)\n            for(j=0;j<=3-i&&j<=n-A;++j)if(i+j)a[i+j]=(a[i+j]+((ll)i*b[i]+(ll)j*c[j])%mod*v[i+j]%mod*E(A,n-A,i,j))%mod;\n//\u8fd9\u91cc\u8d8a\u754c\u7684b[0]\u548cc[0]\u90fd\u662f0\uff0c\u6392\u9664\u4e86\u60c5\u51b5i+j==0\u65f6\u6ca1\u5fc5\u8981\u7b97\n    }\n    q=rd();\n    while(q--){\n        i=rd();\n        wt(val(i));\n    }\n    flush();\n    return 0;\n}\n```\n",
        "postTime": 1563691888,
        "uid": 57926,
        "name": "Thinking",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5472 \u3010[NOI2019]\u6597\u4e3b\u5730\u3011"
    },
    {
        "content": "\u5927\u6982\u5199\u4e00\u4e0b\u601d\u7ef4\u5386\u7a0b\u3002\n\n- \u9996\u5148\u80af\u5b9a\u5f97\u4ece\u591a\u9879\u5f0f\u590d\u6742\u5ea6\u505a\u6cd5\u5f00\u59cb\u4f18\u5316\u3002\n- \u54c7\u8fd9\u4e2a\u968f\u673a\u65b9\u5f0f\u662f smg \u554a\u3002\n\n\u90a3\u5c31\u5148\u7814\u7a76\u4e00\u4e0b\u8fd9\u4e2a\u968f\u673a\u65b9\u5f0f\u5230\u5e95\u5728\u5e72\u4ec0\u4e48\u3002\u53ef\u4ee5\u53d1\u73b0\uff1a**\u4ee5\u9898\u9762\u7ed9\u5b9a\u7684\u968f\u673a\u65b9\u5f0f\uff0c\u4e00\u6b21\u968f\u673a\u540e\uff0c\u6240\u6709\u53ef\u80fd\u51fa\u73b0\u7684\u60c5\u51b5\u51fa\u73b0\u7684\u6982\u7387\u90fd\u662f\u76f8\u7b49\u7684\u3002**\n\n---\n\n\u8bc1\u660e\uff1a\n\n\u5c06\u7b2c\u4e00\u5806\u724c\uff08\u5171 $A$ \u5f20\uff09\u89c6\u4e3a $0$\uff0c\u5c06\u7b2c\u4e8c\u5806\uff08\u5171 $n-A$ \u5f20\uff09\u89c6\u4e3a $1$\uff0c\u90a3\u4e48\u4efb\u610f\u7ed3\u679c\u90fd\u7b49\u4ef7\u4e8e\u4e00\u4e2a $0/1$ \u5e8f\u5217\u3002\n\n\u800c\u9898\u76ee\u4e2d\u63cf\u8ff0\u7684\u8fc7\u7a0b\u53ef\u4ee5\u7b49\u4ef7\u4e3a\u4ece\u6240\u6709\u5269\u4f59\u5143\u7d20\u91cc\u9762\u7b49\u6982\u7387\u968f\u673a\u9009\u53d6\u4e00\u4e2a\u3002\n\n\u90a3\u4e48\u6211\u4eec\u7ed9\u6bcf\u4e00\u4e2a\u5143\u7d20\u90fd\u8d4b\u4e00\u4e2a\u7f16\u53f7\uff0c\u90a3\u4e48\u6240\u6709\u7f16\u53f7\u6392\u5217\u51fa\u73b0\u7684\u6982\u7387\u90fd\u662f\u76f8\u7b49\u7684\u3002\u800c\u6bcf\u4e00\u4e2a 01 \u5e8f\u5217\u5bf9\u5e94\u7684\u7f16\u53f7\u6392\u5217\u4e2a\u6570\u4e5f\u90fd\u662f $A!(n-A)!$\uff0c\u6240\u4ee5\u6bcf\u4e00\u4e2a 01 \u5e8f\u5217\u51fa\u73b0\u90fd\u662f\u7b49\u6982\u7387\u7684\uff0c\u6240\u4ee5\u4efb\u610f\u7ed3\u679c\u90fd\u662f\u7b49\u6982\u7387\u7684\u3002\n\n---\n\n\u6709\u4e86\u8fd9\u4e2a\u7ed3\u8bba\uff0c\u76f4\u63a5\u7684\u60f3\u6cd5\u5c31\u662f\u6982\u7387 DP\uff0c\u8bbe $f_{i,j,k}$ \u8868\u793a\u7ecf\u8fc7\u524d $i$ \u6b21\u91cd\u6392\uff0c\u539f\u672c\u5728\u7b2c $j$ \u4e2a\u4f4d\u7f6e\u7684\u5143\u7d20\u88ab\u6392\u5230\u7b2c $k$ \u4f4d\u7684\u6982\u7387\u3002\n\n\u8f6c\u79fb\u5c31\u679a\u4e3e\u4e0a\u4e00\u6b21\u6240\u5728\u7684\u4f4d\u7f6e $l$\uff0c\u5982\u679c\u5728\u524d\u9762\u4e00\u6bb5\uff0c\u90a3\u4e48\u65b9\u6848\u6570\u5c31\u662f $\\dbinom{k-1}{l-1}\\dbinom{n-k}{A-l}$\uff0c\u610f\u4e49\u662f\u679a\u4e3e $l$ \u524d\u9762\u7684\u5143\u7d20\u653e\u5728\u54ea\u4e9b\u4f4d\u7f6e\u4ee5\u53ca\u540e\u9762\u7684\u5143\u7d20\u653e\u5728\u54ea\u4e9b\u4f4d\u7f6e\u3002\u5728\u540e\u9762\u4e00\u6bb5\u662f\u7c7b\u4f3c\u7684\uff0c\u65b9\u6848\u6570\u4e3a $\\dbinom{k-1}{l-A-1}\\dbinom{n-k}{n-l}$\u3002\u6240\u4ee5\u6709\u8f6c\u79fb\uff1a\n\n$$f_{i,j,k}=\\sum_{l=1}^{A_i}\\dfrac{\\binom{k-1}{l-1}\\binom{n-k}{A_i-l}}{\\binom{n}{A_i}}f_{i-1,j,l}+\\sum_{l=A_i+1}^{n}\\dfrac{\\binom{k-1}{l-A_i-1}\\binom{n-k}{n-l}}{\\binom{n}{A_i}}f_{i-1,j,l}$$\n\n\u7531\u6b64\u53ef\u4ee5\u5f97\u5230 $O(mn^3)$ \u7684\u7b97\u6cd5\uff0c\u83b7\u5f97 $30$ \u5206\u3002\u5728 $A_i$ \u5168\u90fd\u4e00\u6837\u7684\u65f6\u5019\u53ef\u4ee5\u6539\u5199\u6210\u77e9\u9635\u4e58\u6cd5\uff0c\u7528\u500d\u589e\u7684\u5957\u8def\u7a0d\u5fae\u4f18\u5316\u4e00\u4e0b\u5c31\u53ef\u4ee5 $O(n^3\\log m)$\uff0c\u62fc\u8d77\u6765\u5c31\u6709 $40$ \u5206\u3002\n\n\u8003\u8651\u4e00\u4e0b\u600e\u4e48\u4f18\u5316\u3002\n\n---\n\n- \u6709 $50$ \u5206\u6ee1\u8db3 $f(i)=i$\uff0c\u8fd9\u80af\u5b9a\u5f97\u6709\u70b9\u7528\u554a\u3002\n- \u4f46\u662f\u76f4\u63a5\u62c6\u6210\u6982\u7387\u5c31\u5565\u90fd\u6ca1\u7528\u4e86\uff0c\u6240\u4ee5\u663e\u7136\u5f97\u5148\u6539\u5199\u6210\u671f\u671b\u7684\u5f62\u5f0f\u3002\n\n\u8bbe $f_{i,j}$ \u8868\u793a\u7ecf\u8fc7\u524d $i$ \u6b21\u6253\u4e71\u4e4b\u540e\u7b2c $j$ \u4e2a\u4f4d\u7f6e\u7684\u671f\u671b\u5206\u503c\u3002\u6ce8\u610f\u5230\u5728\u4e0a\u9762\u7684\u6982\u7387 DP \u4e2d\uff0c\u6574\u4e2a\u7b97\u6cd5\u7684\u4efb\u4f55\u4e00\u6b65\u90fd\u6ca1\u6709\u628a\u4e24\u4e2a $f$ \u4e58\u8d77\u6765\u8fd9\u79cd\u64cd\u4f5c\uff0c\u6240\u4ee5\u8f6c\u79fb\u53ef\u4ee5\u76f4\u63a5\u7167\u642c\u8fc7\u6765\uff1a\n\n$$f_{i,j}=\\sum_{l=1}^{A_i}\\dfrac{\\binom{j-1}{l-1}\\binom{n-j}{A_i-l}}{\\binom{n}{A_i}}f_{i-1,l}+\\sum_{l=A_i+1}^{n}\\dfrac{\\binom{j-1}{l-A_i-1}\\binom{n-j}{n-l}}{\\binom{n}{A_i}}f_{i-1,l}$$\n\n\u8fd9\u662f $O(mn^2)$ \u7684\u505a\u6cd5\uff0c\u53ef\u60dc\u6ca1\u6709\u4efb\u4f55\u5206\u3002\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u7528\u6574\u4f53 DP \u7684\u60f3\u6cd5\u4f18\u5316\u8fd9\u4e2a DP\u3002\u65b9\u4fbf\u8d77\u89c1\uff0c\u4e0b\u9762\u5c06 $f_{i,j}$ \u8bb0\u4e3a $f_i(j)$ \u6765\u8868\u793a\u8fd9\u4e2a\u7edf\u4e00\u7ef4\u62a4\u7684\u60f3\u6cd5\u3002\n\n---\n\n- \u8fd9\u4e2a DP \u597d\u50cf\u8fd8\u662f\u6ca1\u5565\u4f18\u5316\u7684\u524d\u9014\u554a\u3002\n- \u5e9f\u8bdd\u8fd9\u73a9\u610f\u6709\u524d\u9014\u90a3\u4e0a\u9762\u7684\u6982\u7387 dp \u5c31\u4e5f\u6709\u524d\u9014\u4e86\uff0c\u4e0d\u662f\u8bf4\u8981\u7528 $tp=1$ \u5417\u3002\u5bf9\u5e94\u5230 DP \u4e0a\u9762\u5c31\u662f $f_0(i)=i$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u4e0d\u59a8\u5c1d\u8bd5\u8ba1\u7b97\u4e00\u4e0b $f_1$\u3002\n\n$$f_1(x)=\\sum_{j=1}^{A_i}\\dfrac{\\binom{x-1}{j-1}\\binom{n-x}{A_i-j}}{\\binom{n}{A_i}}\\cdot j+\\sum_{j=A_i+1}^{n}\\dfrac{\\binom{x-1}{j-A_i-1}\\binom{n-x}{n-j}}{\\binom{n}{A_i}}\\cdot j$$\n\n\u4e24\u90e8\u5206\u5206\u5f00\u8ba1\u7b97\uff1a\n\n$$\\sum_{j=1}^{A_i}\\dfrac{\\binom{x-1}{j-1}\\binom{n-x}{A_i-j}}{\\binom{n}{A_i}}\\cdot j$$\n\n\u8fd9\u4e2a\u770b\u8d77\u6765\u975e\u5e38\u50cf\u8303\u5fb7\u8499\u5fb7\u5377\u79ef\uff0c\u53ef\u60dc\u6709\u4e2a $j$ \u5728\u90a3\u91cc\u3002\u4f46\u662f\u4e0a\u9762\u53c8\u6709\u4e2a\u7ec4\u5408\u6570\u7684\u4e0b\u6307\u6807\u662f $j-1$\uff0c\u90a3\u4e48\u6211\u4eec\u5c1d\u8bd5\u901a\u8fc7\u62c6\u51fa\u53bb\u4e00\u4e2a $1$ \u6765\u628a $j$ \u5438\u6536\u6389\u3002\n\n$$\\sum_{j=1}^{A_i}\\dfrac{\\binom{x-1}{j-1}\\binom{n-x}{A_i-j}}{\\binom{n}{A_i}}\\cdot (j-1)+\\sum_{j=1}^{A_i}\\dfrac{\\binom{x-1}{j-1}\\binom{n-x}{A_i-j}}{\\binom{n}{A_i}}$$\n\n\u540e\u9762\u662f\u4e2a\u6807\u51c6\u7684\u7ec4\u5408\u6570\u5377\u79ef\uff0c\u524d\u9762\u7528 $\\dbinom{x-1}{j-1}$ \u628a $j-1$ \u5438\u6536\u6389\u3002\n\n$$\\sum_{j=1}^{A_i}\\dfrac{\\binom{x-2}{j-2}\\binom{n-x}{A_i-j}}{\\binom{n}{A_i}}\\cdot (x-1)+\\dfrac{\\binom{n-1}{A_i-1}}{\\binom{n}{A_i}}$$\n\n\u63d0\u51fa $x-1$\uff0c\u90a3\u4e48\u540e\u9762\u7684\u4e00\u9879\u4e5f\u53d8\u6210\u4e86\u6807\u51c6\u7684\u7ec4\u5408\u6570\u5377\u79ef\u3002\n\n$$\\dfrac{\\binom{n-2}{A_i-2}}{\\binom{n}{A_i}}\\cdot (x-1)+\\dfrac{\\binom{n-1}{A_i-1}}{\\binom{n}{A_i}}$$\n\n\u540e\u9762\u90a3\u4e00\u90e8\u5206\u662f\u7c7b\u4f3c\u7684\uff0c\u63d0\u51fa\u53bb $A_i+1$\uff0c\u7136\u540e\u5728\u91cc\u9762\u628a $j-A_i-1$ \u7ed9\u5438\u6536\u6389\uff0c\u53d8\u6210\u4e24\u4e2a\u7ec4\u5408\u6570\u5377\u79ef\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53d1\u73b0 $f_1(x)$ \u662f\u5173\u4e8e $x$ \u7684\u7ebf\u6027\u51fd\u6570\uff01\n\n\u90a3\u4e48\u65e2\u7136\u8fd9\u6837\uff0c$f_2(x)$ \u5c31\u7b49\u4ef7\u4e8e\u628a $f_1(x)$ \u7684\u5f0f\u5b50\u91cc\u9762\u7684 $j$ \u5168\u90fd\u6362\u6210 $k_1j+b_1$\u3002\u63a8\u4e00\u4e0b\u5bb9\u6613\u53d1\u73b0 $f_2(x)$ \u4ecd\u7136\u5173\u4e8e $x$ \u7ebf\u6027\uff01\u4e8e\u662f\u6240\u6709\u7684 $f_i(x)$ \u5c31\u90fd\u662f\u5173\u4e8e $x$ \u7ebf\u6027\u7684\u4e86\u3002\u56de\u7b54\u8be2\u95ee\u7b49\u4ef7\u4e8e\u5bf9 $f_n(x)$ \u8fdb\u884c\u4e00\u4e2a\u6c42\u503c\uff0c\u6240\u4ee5\u76f4\u63a5\u641e\u5c31\u662f $O(n+m+q)$ \u7684\u4e86\u3002\u7ed3\u5408\u4e0a\u9762\u7684\u4e24\u4e2a\u66b4\u529b\u53ef\u4ee5\u83b7\u5f97 $70$ \u5206\u3002\n\n---\n\n- \u8fd8\u5dee\u70b9\u5565\u554a\u2026\u2026\u5dee\u4e2a $tp=2$\u2026\u2026\u8fd9\u65f6\u5206\u6570\u662f $i^2$\u2026\u2026\u90a3\u4e0d\u5c31\u662f\u4e2a\u4e8c\u6b21\u51fd\u6570\u2026\u2026\n- \u7b49\u7b49\uff0c\u662f\u4e0d\u662f\u4e8c\u6b21\u51fd\u6570\uff1f\n\n\u548c\u4e0a\u9762\u662f\u7c7b\u4f3c\u7684\uff0c\u5982\u679c $f_{i-1}(x)$ \u662f\u4e2a\u4e8c\u6b21\u51fd\u6570 $ax^2+bx+c$\uff0c\u90a3\u4e48\u6211\u4eec\u5f88\u5bb9\u6613\u5c06\u5b83\u6539\u5199\u4e3a $p(x-1)(x-2)+q(x-1)+r$ \u7684\u5f62\u5f0f\u3002\u8fd9\u6837\uff0c\u5e38\u6570\u9879\u548c\u4e00\u6b21\u9879\u5e26\u5165\u4e0a\u9762\u7684\u8f6c\u79fb\u5f0f\u7684\u7b2c\u4e00\u90e8\u5206\u7684\u65f6\u5019\u548c $tp=1$ \u7684\u65f6\u5019\u662f\u5b8c\u5168\u4e00\u6837\u7684\u3002\u4e8c\u6b21\u9879\u5e26\u5165\u7684\u65f6\u5019\u53ef\u4ee5\u53d1\u73b0\u4e0e\u4e00\u6b21\u9879\u662f\u7c7b\u4f3c\u7684\uff0c\u53ea\u4e0d\u8fc7\u9700\u8981\u8fdb\u884c\u4e24\u6b21\u5438\u6536\uff0c\u5269\u4e0b\u7684\u662f\u4e00\u4e2a\u5e38\u6570\u4e58\u4e00\u4e2a\u4e8c\u6b21\u9879\u3002\n\n\u5e26\u5165\u7b2c\u4e8c\u90e8\u5206\u7684\u65f6\u5019\u7a0d\u6709\u533a\u522b\uff0c\u9700\u8981\u6539\u5199\u4e3a $u(x-A_i-1)(x-A_i-2)+v(x-A_i-1)+w$ \u7684\u5f62\u5f0f\u3002\u5269\u4e0b\u7684\u90fd\u662f\u4e00\u6837\u7684\u3002\n\n\u6240\u4ee5\u6b64\u65f6\u6240\u6709 $f_i(x)$ \u5c31\u90fd\u662f\u4e8c\u6b21\u51fd\u6570\u3002\u6240\u4ee5\u8fd9\u4e00\u90e8\u5206\u548c $tp=1$ \u662f\u57fa\u672c\u76f8\u540c\u7684\uff0c\u53ea\u662f\u624b\u7b97\u6539\u5199\u51fd\u6570\u5f62\u5f0f\u7684\u7cfb\u6570\u4f1a\u9ebb\u70e6\u5f88\u591a\u3002\n\n\u90a3\u4e48\u8fd9\u9898\u5c31\u505a\u5b8c\u4e86\uff0c\u590d\u6742\u5ea6 $O(n+m+q)$\u3002\u5b9e\u9645\u5b9e\u73b0\u7684\u65f6\u5019\u4e0d\u9700\u8981\u5206\u7c7b\u8ba8\u8bba\uff0c\u56e0\u4e3a\u4e00\u6b21\u51fd\u6570\u53ef\u4ee5\u76f4\u63a5\u5f53\u4f5c\u4e8c\u6b21\u51fd\u6570\u5904\u7406\u3002\n\n```cpp\nconst long long mod = 998244353;\nconst int N = 10000005, M = 500005;\nint n, m, tp;\nlong long fac[N], ifac[N], len[M], a[M], b[M], c[M];\n\ninline void Read() {\n    n = qread(); m = qread(); tp = qread();\n    for (int i = 1;i <= m;i++) len[i] = qread();\n}\n\ninline void Prefix() {\n    ifac[1] = 1;\n    for (int i = 2;i <= n;i++) ifac[i] = (mod - mod / i) * ifac[mod % i] % mod;\n    fac[0] = fac[1] = ifac[0] = 1;\n    for (int i = 2;i <= n;i++) {\n        fac[i] = fac[i - 1] * i % mod;\n        ifac[i] = ifac[i - 1] * ifac[i] % mod;\n    }\n}\n\ninline long long C(long long n, long long r) {\n    if (n < r || r < 0) return 0;\n    return fac[n] * ifac[r] % mod * ifac[n - r] % mod;\n}\n\ninline long long Cinv(long long n, long long r) {\n    return fac[r] * fac[n - r] % mod * ifac[n] % mod;\n}\n\ninline long long Eval(int i, long long x) {\n    return (a[i] * (x + mod - 1) % mod * (x + mod - 2) % mod + b[i] * (x + mod - 1) % mod + c[i]) % mod;\n}\n\ninline void Solve() {\n    if (tp == 1) {\n        a[0] = 0; b[0] = 1; c[0] = 1;\n    } else {\n        a[0] = 1; b[0] = 3; c[0] = 1;\n    }\n    for (int i = 1;i <= m;i++) {\n        long long iv = Cinv(n, len[i]);\n        long long amv = a[i - 1];\n        long long bmv = (b[i - 1] + 2 * a[i - 1] * len[i] % mod) % mod;\n        long long cmv = (c[i - 1] + b[i - 1] * len[i] % mod + a[i - 1] * len[i] % mod * len[i] % mod - a[i - 1] * len[i] % mod + mod) % mod;\n        a[i] = (C(n - 3, len[i] - 3) * iv % mod * a[i - 1] % mod + C(n - 3, len[i]) * iv % mod * amv % mod) % mod;\n        b[i] = (C(n - 2, len[i] - 2) * iv % mod * b[i - 1] % mod + C(n - 2, len[i]) * iv % mod * bmv % mod) % mod;\n        c[i] = (C(n - 1, len[i] - 1) * iv % mod * c[i - 1] % mod + C(n - 1, len[i]) * iv % mod * cmv % mod) % mod;\n    }\n    int q = qread();\n    while (q--) {\n        int x = qread();\n        cout << Eval(m, x) << '\\n';\n    }\n}\n```",
        "postTime": 1651239239,
        "uid": 61088,
        "name": "Solystic",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5472 \u3010[NOI2019] \u6597\u4e3b\u5730\u3011"
    },
    {
        "content": "\u65e2\u7136\u6ca1\u6709\u9898\u89e3\u2026\u2026\u90a3\u672c\u849f\u84bb\u5c31\u6597\u80c6\u6765\u586b\u4e2a\u5751\u5427\u2026\u2026\n\n\u4e0b\u9762\u63d0\u5230\u7684\u505a\u6cd5\u662f\u67d0\u4e2a\u7fa4\u91cc\u7684$dalao$\u4eec\u544a\u8bc9\u6211\u7684\u2026\u2026\u5e76\u975e\u539f\u521b\uff0c\u6c42\u8f7b\u55b7\u3002\n\n\u8003\u8651\u5047\u8bbe\u7b54\u6848\u662f\u4e00\u4e2a$tp$\u6b21\u591a\u9879\u5f0f\u2026\u2026\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981$tp + 1(\u22643)$\u4e2a\u6570\uff0c\u4e5f\u5c31\u662f\u6c42\u51fa$i= 1,2,3$\u65f6\u7684\u7b54\u6848\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u63d2\u503c\u6c42\u51fa\u6240\u6709\u7684\u7b54\u6848\u4e86\u3002\n\n\u90a3\u4e48\u2026\u2026\u600e\u4e48\u6c42$f(1),f(2),f(3)$\u5462\uff1f\n\n\u8003\u8651\u4ece\u7b2c$i-1$\u6b21\u6d17\u724c\u540e\u7684\u591a\u9879\u5f0f\u6c42\u51fa\u7b2c$i$\u6b21\u6d17\u724c\u540e\u7684\u591a\u9879\u5f0f\u3002\n\n\u6211\u4eec\u8003\u8651\u66b4\u529b\u2026\u2026\n\n\u628a\u4e24\u4e2a\u5e8f\u5217\u7684\u524d$3$\u4e2a\u6570\u5373$1,2,3,a[i]+1,a[i]+2,a[i]+3$\u7684\u51fd\u6570\u503c\u63d2\u503c\u51fa\u6765\uff0c\u7136\u540e$2^3$\u679a\u4e3e\u6240\u6709\u7684\u60c5\u51b5\uff0c\u66b4\u529b\u7b97\u5373\u53ef\u3002\n\n\u6ca1\u4e86$?$\u6ca1\u4e86\u3002~~\u53cd\u6b63\u6b63\u89e3\u6211\u770b\u4e0d\u61c2\uff0c\u8fd8\u4e0d\u5982\u76f4\u63a5\u6309\u7167\u731c\u51fa\u6765\u7684\u7ed3\u8bba\u5199\uff0c\u4f60\u5982\u679c\u73b0\u573a\u5199\u4e86\u53d1\u73b0\u5b83\u8fc7\u5927\u6837\u4f8b\u4e86\uff0c\u4f60\u5c31\u8d5a\u7ffb\u4e86~~\n\n\u590d\u6742\u5ea6$O(2^3m+q)$,\u56e0\u4e3a\u6709\u63d2\u503c\uff0c\u6240\u4ee5\u6709\u8f83\u5927\u7684\u5e38\u6570\u3002\n\n~~\u5c31\u8fd9\u6837\u6211\u8fd8\u62ff\u4e86\u63d0\u4ea4\u65f6\u7684~~$luogu$  $rk2?$\n\n\u4ee3\u7801\uff1a$($\u6570\u636e\u5206\u6cbb\u6211\u61d2\u5f97\u5220\u4e86$)$\n\n```cpp\n#include <bits/stdc++.h>\n#define LL long long\nusing namespace std;\ninline int read(){\n    int x = 0; char c = getchar();\n    while (!isdigit(c)) c = getchar();\n    while (isdigit(c)) x = x * 10 + c - '0',c = getchar();\n    return x;\n}\ninline void write(int x){ if (x > 9) write(x/10); putchar(x%10+'0'); }\ninline void writeln(int x){ write(x),putchar('\\n'); }\n\nconst int P = 998244353,M = 500050,inv2 = (P+1) >> 1;\nint n,m,tp,a[M],q;\n\nnamespace subtask1{\n\tint f[85][85],rate[85][85],ans[85],inv[85],t[85][85],w[85][85];\n\tinline void add(int &x,int y){ x += y; if (x >= P) x -= P; }\n\tinline void work(int x,int y){\n\t\tstatic int i,j,k,v;\n\t\tmemset(t,0,sizeof(t));\n\t\tmemset(f,0,sizeof(f));\n\t\tf[0][0] = 1;\n\t\tfor (i = 0; i <= x; ++i)\n\t\tfor (j = 0; j <= y; ++j) if (f[i][j]){\n\t\t\tif (i < x){ v = (LL)f[i][j] * inv[n-i-j] % P * (x-i) % P; add(f[i+1][j],v); add(t[i+1][i+j+1],v); }\n\t\t\tif (j < y){ v = (LL)f[i][j] * inv[n-i-j] % P * (y-j) % P; add(f[i][j+1],v); add(t[x+j+1][i+j+1],v); }\n\t\t}\n\t\tfor (i = 1; i <= n; ++i)\n\t\tfor (j = 1; j <= n; ++j) w[i][j] = rate[i][j],rate[i][j] = 0;\n\t\tfor (i = 1; i <= n; ++i)\n\t\tfor (j = 1; j <= n; ++j)\n\t\tfor (k = 1; k <= n; ++k) add(rate[i][j],(LL)w[i][k] * t[k][j] % P);\n\t}\n\tinline void solve(){\n\t\tint i,j;\n\t\tmemset(rate,0,sizeof(rate));\n\t\tfor (inv[0] = inv[1] = 1,i = 2; i <= 80; ++i) inv[i] = (LL)(P-P/i) * inv[P%i] % P;\n\t\tfor (i = 1; i <= n; ++i) rate[i][i] = 1;\n\t\tfor (i = 1; i <= m; ++i) work(a[i],n-a[i]);\n\t\tfor (i = 1; i <= n; ++i)\n\t\tfor (j = 1; j <= n; ++j) ans[i] = (ans[i] + (LL)rate[j][i] * j % P * (tp == 2 ? j : 1)) % P;\n\t\twhile (q--) i = read(),writeln(ans[i]);\t\n\t}\n}\nnamespace subtask2{\n\tinline bool check(){ for (int i = 2; i <= m; ++i) if (a[i] ^ a[i-1]) return 0; return 1; }\n\tint t[105][105],f[105][105],inv[105],A[105][105],B[105][105],C[105][105],ans[105];\n\tinline void add(int &x,int y){ x += y; if (x >= P) x -= P; }\n\tinline void work(int x,int y){\n\t\tstatic int i,j,v;\n\t\tmemset(t,0,sizeof(t));\n\t\tmemset(f,0,sizeof(f));\n\t\tf[0][0] = 1;\n\t\tfor (i = 0; i <= x; ++i)\n\t\tfor (j = 0; j <= y; ++j) if (f[i][j]){\n\t\t\tif (i < x){ v = (LL)f[i][j] * inv[n-i-j] % P * (x-i) % P; add(f[i+1][j],v); add(t[i+1][i+j+1],v); }\n\t\t\tif (j < y){ v = (LL)f[i][j] * inv[n-i-j] % P * (y-j) % P; add(f[i][j+1],v); add(t[x+j+1][i+j+1],v); }\n\t\t}\n\t\tfor (i = 1; i <= n; ++i)\n\t\tfor (j = 1; j <= n; ++j) A[i][j] = t[i][j],B[i][j] = i == j ? 1 : 0;\n\t}\n\tinline void Mpow(int m){\n\t\tstatic int i,j,k;\n\t\twhile (m){\n\t\t\tif (m&1){\n\t\t\t\tfor (i = 1; i <= n; ++i)\n\t\t\t\tfor (j = 1; j <= n; ++j)\n\t\t\t\tfor (C[i][j] = 0,k = 1; k <= n; ++k) add(C[i][j],(LL)B[i][k] * A[k][j] % P);\n\t\t\t\tfor (i = 1; i <= n; ++i)\n\t\t\t\tfor (j = 1; j <= n; ++j) B[i][j] = C[i][j];\n\t\t\t}\n\t\t\tfor (i = 1; i <= n; ++i)\n\t\t\tfor (j = 1; j <= n; ++j)\n\t\t\tfor (C[i][j] = 0,k = 1; k <= n; ++k) add(C[i][j],(LL)A[i][k] * A[k][j] % P);\n\t\t\tfor (i = 1; i <= n; ++i)\n\t\t\tfor (j = 1; j <= n; ++j) A[i][j] = C[i][j];\n\t\t\tm >>= 1;\n\t\t}\n\t}\n\tinline void solve(){\n\t\tint i,j;\n\t\tfor (inv[0] = inv[1] = 1,i = 2; i <= 100; ++i) inv[i] = (LL)(P-P/i) * inv[P%i] % P;\n\t\twork(a[1],n-a[1]);\n\t\tMpow(m);\n\t\tfor (i = 1; i <= n; ++i)\n\t\tfor (j = 1; j <= n; ++j) ans[i] = (ans[i] + (LL)B[j][i] * j % P * (tp == 2 ? j : 1)) % P;\n\t\twhile (q--) i = read(),writeln(ans[i]);\t\n\t}\n}\n\nint y_1,y_2,y_3;\ninline int add(int x,int y){ return (x+=y)>=P?x-P:x; }\ninline int dev(int x,int y){ return (x-=y)<0?x+P:x; }\ninline int mul(LL x,int y){ return x*y-x*y/P*P; }\ninline int qpow(int x,int y){ static int ret; ret = 1; while (y){ if (y&1) ret = mul(ret,x); x = mul(x,x),y >>= 1; } return ret; }\n\ninline int F(int x){ return dev(mul(inv2,add(mul(y_1,mul(dev(x,2),dev(x,3))),mul(y_3,mul(dev(x,1),dev(x,2))))),mul(y_2,mul(dev(x,1),dev(x,3)))); }\n//\u63d2\u503c\uff0c\u76f4\u63a5\u624b\u7b97\u4e00\u4e0b\u5f0f\u5b50\u6253\u8fdb\u7a0b\u5e8f\u91cc(\u52a0\u4e86\u53d6\u6a21\u4f18\u5316\u4e4b\u540e\u60e8\u4e0d\u5fcd\u7779\u7684\u4ee3\u7801)\n\nint x[4],lx;\nint y[4],ly;\n\nint main(){\n\tint i,j,k,val,p1,p2,v;\n\tint v1,v2,v3;\n\tn = read(),m = read(),tp = read();\n\tfor (i = 1; i <= m; ++i) a[i] = read();\n\tq = read();\n\tif (n <= 80 && m <= 80){subtask1::solve(); return 0;}\n\tif (n <= 100 && subtask2::check()){ subtask2::solve(); return 0; }\n\tval = qpow(mul(n,mul(n-1,n-2)),P-2);\n\ty_1 = 1,y_2 = tp == 2 ? 4 : 2,y_3 = tp == 2 ? 9 : 3;\n\tfor (i = 1; i <= m; ++i){\n\t\tlx = 0; for (j = 1; j <= 3 && j <= a[i]; ++j) x[++lx] = F(j);\n\t\tly = 0; for (j = a[i]+1; j <= 3 + a[i] && j <= n; ++j) y[++ly] = F(j);\n\t\ty_1 = y_2 = y_3 = 0;\n\t\tfor (j = 0; j < 8; ++j){ //\u66b4\u529b\u22648\u79cd\u60c5\u51b5\n\t\t\tp1 = p2 = v = 1;\n\t\t\tif (j & 1){ v = mul(v,a[i]-p1+1); if (p1 > lx) p1 = -1; v1 = x[p1],++p1; }\n\t\t\telse{ v = mul(v,n-a[i]-p2+1); if (p2 > ly) p2 = -1; v1 = y[p2],++p2; }\n\t\t\tif (!p1 || !p2) continue;\n\t\t\t\n\t\t\tif (j >> 1 & 1){ v = mul(v,a[i]-p1+1); if (p1 > lx) p1 = -1; v2 = x[p1],++p1; }\n\t\t\telse{ v = mul(v,n-a[i]-p2+1); if (p2 > ly) p2 = -1; v2 = y[p2],++p2; }\n\t\t\tif (!p1 || !p2) continue;\n\t\t\t\n\t\t\tif (j >> 2 & 1){ v = mul(v,a[i]-p1+1); if (p1 > lx) p1 = -1; v3 = x[p1],++p1; }\n\t\t\telse{ v = mul(v,n-a[i]-p2+1); if (p2 > ly) p2 = -1; v3 = y[p2],++p2; }\n\t\t\tif (!p1 || !p2) continue;//\u8ba1\u7b97f(1),f(2),f(3)\n\t\t\ty_1 = add(y_1,mul(v1,v));\n\t\t\ty_2 = add(y_2,mul(v2,v));\n\t\t\ty_3 = add(y_3,mul(v3,v));\n\t\t}\n\t\ty_1 = mul(y_1,val),y_2 = mul(y_2,val),y_3 = mul(y_3,val);\n\t}\n\twhile (q--) v = read(),writeln(F(v));//\u56de\u7b54\u8be2\u95ee\n   return 0;\n}\n```",
        "postTime": 1563616108,
        "uid": 52518,
        "name": "s_r_f",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5472 \u3010[NOI2019]\u6597\u4e3b\u5730\u3011"
    },
    {
        "content": "~~\u849f\u84bb\u540c\u6b65\u8d5b\u9009\u624b~~\n\n\u8003\u8bd5\u7684\u65f6\u5019\u624b\u63a8\u5f0f\u5b50\u63a8\u4e86\u534a\u5929\uff0c\u7ed3\u679c\u53ea\u5199\u4e2a\u4e2a$\\ O(mn^{2})$\uff0c\u6c34\u4e86$\\ 30$\n\n\n\u6211\u4eec\u8bbe$\\ f_{i,j}$\u662f\u7ecf\u8fc7$\\ i$\u6b21\u6d17\u724c\u7b2c$\\ j$\u5f20\u724c\u7684\u671f\u671b\uff08\u4ece\u4e0b\u5f80\u4e0a\uff09\uff0c$\\ fa_{i,j},fb_{i,j}$\u662f\u4e24\u5806\u724c\u7ecf\u8fc7$\\ i$\u6b21\u6d17\u724c\u7684$\\ j$\u5f20\u724c\u7684\u671f\u671b\uff0c\u6211\u4eec\u6709\uff1a\n\n\u8bbe$\\ A,B$\u662f\u4e24\u5806\u724c\u7684\u9ad8\u5ea6\u3002\n\n$$f_{i,j}=\\sum_{k=1}^{j} \\frac{\\binom{j-1}{k-1}A^{\\underline{k}}B^{\\underline{j-k}}(fa_{i-1,k})+\\binom{j-1}{k-1}B^{\\underline{k}}A^{\\underline{j-k}}(fb_{i-1,k})}{n^{\\underline{j}}}$$\n\n\u4e3a\u751a\u4f1a\u5f97\u5230\u8fd9\u4e2a\u5f0f\u5b50\u5462\uff1f\n\n\u6211\u4eec\u6709\u4ee5\u4e0b\u5206\u6790\uff1a\n\n\u5148\u770b\u8fd9\u4e2a\u56fe\uff1a\n\n![](https://img-blog.csdnimg.cn/20190719070125854.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N0YXJ0YWlkb3U=,size_16,color_FFFFFF,t_70)\n\n\n$\\ c$\u7684\u9ad8\u5ea6\u4e3a$\\ A$\uff0c$\\ d$\u7684\u9ad8\u5ea6\u4e3a$\\ B$\n\n\u6211\u4eec\u9010\u4e2a\u5206\u6790\uff1a\n\n\n\u5148\u4e0d\u8003\u8651\u5176\u987a\u5e8f\u3002\n\n\u7b2c\u4e00\u5f20\u724c\uff1a\n- \u5982\u679c\u6211\u4eec\u53d6$\\ c1$\uff0c\u663e\u7136$\\ c1$\u7684\u8d21\u732e\u4e3a$\\ \\frac{A}{n}c1$\n- \u5982\u679c\u6211\u4eec\u53d6$\\ d1$\uff0c\u663e\u7136$\\ d1$\u7684\u8d21\u732e\u4e3a$\\ \\frac{B}{n}d1$\n\n\u7b2c\u4e8c\u5f20\u724c\n- \u5982\u679c\u6211\u4eec\u53d6$\\ c1$\uff0c\u8d21\u732e\u4e3a$\\ \\frac{AB}{n(n-1)}c1$\n- \u5982\u679c\u6211\u4eec\u53d6$\\ d1$\uff0c\u8d21\u732e\u4e3a$\\ \\frac{AB}{n(n-1)}d1$\n- \u5982\u679c\u6211\u4eec\u53d6$\\ c2$\uff0c\u8d21\u732e\u4e3a$\\ \\frac{A(A-1)}{n(n-1)}c2$\n- \u5982\u679c\u6211\u4eec\u53d6$\\ d2$\uff0c\u8d21\u732e\u4e3a$\\ \\frac{B(B-1)}{n(n-1)}d2$\n\n\n$\\cdots$\n\n\n\u663e\u7136\u7684\uff0c\u5f53\u6211\u4eec\u7b2c$\\ j$\u5f20\u9009\u4e86$\\ ck$\u65f6\uff0c\u5206\u5b50\u4e0a\u80af\u5b9a\u6709$\\ n^{\\underline{num}}$\uff0c\u5206\u5b50\u4e0a\u80af\u5b9a\u6709$\\ A^{\\underline{k}}$\u548c$\\ B^{\\underline{j-k}}$\u3002\u5bf9\u4e8e$\\ dk$\uff0c\u6211\u4eec\u6709\u540c\u6837\u7684\u5206\u6790\u3002\n\n\u90a3\u4e48\u8003\u8651\u987a\u5e8f\u7684\u8bdd\u662f\u5f88\u4e48\u5462\uff1f\u663e\u7136\u662f\u4e00\u4e2a\u7ec4\u5408\u6570$\\ \\binom{j-1}{k-1}$\u3002\u8fd9\u4e2a\u8bf7\u8bfb\u8005\u81ea\u5df1\u5206\u6790\u3002\n\n\u81f4\u8f9e\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long \nconst long long mod=998244353;\n//char buf[1<<20],*fs,*ft;\n//inline char getc()\n//{return (fs==ft&&(ft=(fs=buf)+fread(buf,1,1<<15,stdin),fs==ft))? 0 : *fs++;}\ninline long long read()\n{long long s=0,w=1;char ch=getchar();\nwhile(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\nwhile(ch>='0'&&ch<='9'){s=s*10+ch-'0';ch=getchar();}\nreturn s*w;}\n//char buf1[1<<21],a1[20];int p11,p12=-1;\n//inline void flush()\n//{fwrite (buf1,1,p12+1,stdout),p12=-1;}\n//inline void print(int x)\n//{if(p12>1<<20) flush();if(x<0) buf1[++p12]=45,x=-x;\n//do{a1[++p11]=x%10+48;}while(x/=10);\n//do{buf1[++p12]=a1[p11];}while(--p11);buf1[++p12]='\\n';}\n/*\ng the two line\nf the c\nfrac n!\ninvf the inv of frac\na A\n*/\nlong long n,m,a[100100],f[2][100100],frac[100100],invf[100100],g[1100][1100],type;\nlong long fa[100100],fb[100100];\ninline long long poww(long long a,long long b)\n{\n\tlong long res=1ll;\n\ta%=mod;\n\twhile(b)\n\t{\n\t\tif(b&1)\n\t\t{\n\t\t\tres*=a;\n\t\t\tres%=mod;\n\t\t}\n\t\ta*=a;\n\t\ta%=mod;\n\t\tb>>=1;\n\t}\n\treturn res;\n}\ninline long long sum(int aa,int bb,int num,int k)\n{\n\tlong long ans=invf[n]*frac[n-num-1];\n\tans%=mod;\n\tans*=g[k-1][num-(k-1)];\n\tans%=mod;\n\tint aused1,bused1,aused2,bused2;\n\t//ues in a\n\taused1=k-1ll;\n\tbused1=num-(k-1ll);\n\t//use in b\n\taused2=num-(k-1ll);\n\tbused2=k-1ll;\n\tlong long suma=frac[aa]*invf[aa-aused1];\n\tsuma%=mod;\n\tif((aused1<aa)&&(bused1<=bb))\n\t{\n\tsuma*=frac[bb];\n\tsuma%=mod;\n\tsuma*=invf[bb-bused1];\n\tsuma%=mod;\n\tsuma*=aa-aused1;\n\tsuma%=mod;\n\tsuma*=fa[k];\n\tsuma%=mod;\n\t}\n\telse suma=0;\n\t\n\tlong long sumb=frac[bb]*invf[bb-bused2];\n\tsumb%=mod;\n\tif((bused2<bb)&&(aused2<=aa))\n\t{\n\tsumb*=frac[aa];\n\tsumb%=mod;\n\tsumb*=invf[aa-aused2];\n\tsumb%=mod;\n\tsumb*=bb-bused2;\n\tsumb%=mod;\n\tsumb*=fb[k];\n\tsumb%=mod;\n\t}\n\telse sumb=0;\n\t\n\tlong long sum=suma+sumb;\n\tsum%=mod;\n\tans*=sum%mod;\n\tans%=mod;\n\treturn ans;\n}\n/*\nhave got num cards and the next is the kth\n*/\nsigned main()\n{\n//\tfreopen(\"landlords.in\",\"r\",stdin);\n//\tfreopen(\"landlords.out\",\"w\",stdout);\n\tmemset(f,0,sizeof(f));\n\tmemset(g,0,sizeof(g)); \n\tn=read();\n\tm=read();\n\ttype=read();\n\tint i=1,j=1,k=1;\n\twhile(i<=m)\n\t{\n\t\ta[i]=read();\n\t\t++i;\n\t}\n\tg[0][0]=1;\n\ti=0;\n\twhile(i<=n)\n\t{\n\t\tj=0;\n\t\twhile(j<=n)\n\t\t{\n\t\t\tif(i) g[i][j]+=g[i-1][j];\n\t\t\tg[i][j]%=mod;\n\t\t\tif(j) g[i][j]+=g[i][j-1];\n\t\t\tg[i][j]%=mod;\n\t\t\t++j;\n\t\t}\n\t\t++i;\n\t}\n\tfrac[0]=1;\n\ti=1;\n\twhile(i<=n)\n\t{\n\t\tfrac[i]=frac[i-1]*i;\n\t\tfrac[i]%=mod;\n\t\t++i;\n\t}\n\ti=0;\n\twhile(i<=n)\n\t{\n\t\tinvf[i]=poww(frac[i],mod-2);\n\t\tinvf[i]%=mod;\n\t\t++i;\n\t}\n\ti=1;\n\twhile(i<=n)\n\t{\n\t\tf[0][n-i+1]=poww(i,type);\n\t\tf[0][n-i+1]%=mod;\n\t\t++i;\n\t}\n\tint cur=0;\n\ti=1;\n\twhile(i<=m)\n\t{\n\t\tcur^=1;\n\t\tint aa=0,bb=0;\n\t\tj=n-a[i]+1;\n\t\tmemset(f[cur],0,sizeof(f[cur]));\n\t\tmemset(fa,0,sizeof(fa));\n\t\tmemset(fb,0,sizeof(fb));\n\t\twhile(j<=n)\n\t\t{\n\t\t\tfa[++aa]=f[cur^1][j];\n\t\t\t++j;\n\t\t}\n\t\tj=1;\n\t\twhile(j<=n-a[i])\n\t\t{\n\t\t\tfb[++bb]=f[cur^1][j];\n\t\t\t++j;\n\t\t}\n\t\tj=1;\n\t\twhile(j<=n)\n\t\t{\n\t\t\tk=1;\n\t\t\twhile(k<=min(j,max(aa,bb)))\n\t\t\t{\n\t\t\t\tf[cur][j]+=sum(aa,bb,j-1,k);\n\t\t\t\tf[cur][j]%=mod;\n\t\t\t\t++k;\n\t\t\t}\n\t\t\t++j;\n\t\t}\n\t\t++i;\n\t}\n\tint qq=read();\n\twhile(qq--)\n\t{\n\t\tint cc=read();\n//\t\twhile(f[cur][n-cc+1]<0) f[cur][n-cc+1]+=mod;\n\t\tprintf(\"%lld\\n\",f[cur][n-cc+1]);\n\t}\n\treturn 0;\n}\n```\n\n\n\n\n\u5f53\u7136\u53ea\u6709\u4e09\u5341\u5206\uff0c$\\ O(mn^{2})$\u7684\u590d\u6742\u5ea6\u662f\u5f88\u4e0d\u4f18\u79c0\u7684\u3002\n\n\u6211\u4eec\u7ecf\u8fc7~~\u6253\u8868~~\u8bc1\u660e\u53d1\u73b0\u5728$\\ f(i)=i$\u65f6\u7b54\u6848\u662f\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ea\u9700\u8981\u8bb0\u5f55\u524d\u4e24\u9879\u4e86\u3002\n\n\u8bc1\u660e\uff1a\n\n\n\u6211\u4eec\u601d\u8003\u4e00\u4e0b\u8fd9\u4e2a\u8fc7\u7a0b\uff1a\u6211\u4eec\u53d1\u73b0\u4efb\u610f\u65f6\u523b\u6211\u4eec\u7684\u724c\u5806\u90fd\u662f\u4e0a\u9762\u7684\u724c\u6ca1\u6709\u4e0b\u9762\u7684\u724c\u5927\u7684\uff08\u4e0d\u53d6\u819c\uff09\u3002\u6211\u4eec\u6316\u6398\u8fd9\u4e2a\u4e1c\u897f\u7684\u6027\u8d28\uff0c\u53d1\u73b0\u5b83\u5b9e\u9645\u4e0a\u662f\u57fa\u6570\u6392\u5e8f\u7684\u9006\u8fc7\u7a0b\u3002\u800c\u4e14\u539f\u5e8f\u5217\u7684\u6240\u6709\u60c5\u51b5\u6982\u7387\u662f\u76f8\u540c\u7684\u3002\n\n\n\n\u540c\u7406\u53ef\u5f97$\\ f(i)=i^{2}$\u7684\u65f6\u5019\u662f\u4e8c\u6b21\u51fd\u6570\n\n\n\u5b9e\u9645\u4e0a\u6211\u4eec\u4e0d\u9700\u8981\u5206\u60c5\u51b5\u8ba8\u8bba\uff0c\u4e00\u6b21\u51fd\u6570\u672c\u8eab\u5c31\u662f\u7279\u6b8a\u7684\u4e8c\u6b21\u51fd\u6570\u3002\n\n\u6b64\u5904\u6211\u7528\u62c9\u683c\u6717\u65e5\u63d2\u503c\u5c31\u4e8c\u6b21\u51fd\u6570\u901a\u9879\uff0c\u5927\u4f6c\u53ef\u4ee5\u7528\u4e8c\u9636\u5dee\u5206\u5565\u7684\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long \nconst long long mod=998244353;\n//char buf[1<<20],*fs,*ft;\n//inline char getc()\n//{return (fs==ft&&(ft=(fs=buf)+fread(buf,1,1<<15,stdin),fs==ft))? 0 : *fs++;}\ninline long long read()\n{long long s=0,w=1;char ch=getchar();\nwhile(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\nwhile(ch>='0'&&ch<='9'){s=s*10+ch-'0';ch=getchar();}\nreturn s*w;}\n//char buf1[1<<21],a1[20];int p11,p12=-1;\n//inline void flush()\n//{fwrite (buf1,1,p12+1,stdout),p12=-1;}\n//inline void print(int x)\n//{if(p12>1<<20) flush();if(x<0) buf1[++p12]=45,x=-x;\n//do{a1[++p11]=x%10+48;}while(x/=10);\n//do{buf1[++p12]=a1[p11];}while(--p11);buf1[++p12]='\\n';}\n/*\ng the two line\nf the c\nfrac n!\ninvf the inv of frac\na A\n*/\nlong long n,m,a[500500],f[2][5],frac[10001000],invf[10001000],type;\nlong long fa[5],fb[5];\nlong long g(long long i,long long j)\n{\n\tlong long ans=frac[i+j];\n\tans*=invf[i];\n\tans%=mod;\n\tans*=invf[j];\n\tans%=mod;\n\treturn ans;\n}\ninline long long poww(long long a,long long b)\n{\n\tlong long res=1ll;\n\ta%=mod;\n\twhile(b)\n\t{\n\t\tif(b&1)\n\t\t{\n\t\t\tres*=a;\n\t\t\tres%=mod;\n\t\t}\n\t\ta*=a;\n\t\ta%=mod;\n\t\tb>>=1;\n\t}\n\treturn res;\n}\ninline long long sum(int aa,int bb,int num,int k)\n{\n\tlong long ans=invf[n]*frac[n-num-1];\n\tans%=mod;\n\tans*=g(k-1,num-(k-1));\n\tans%=mod;\n\tint aused1,bused1,aused2,bused2;\n\t//ues in a\n\taused1=k-1ll;\n\tbused1=num-(k-1ll);\n\t//use in b\n\taused2=num-(k-1ll);\n\tbused2=k-1ll;\n\tlong long suma=frac[aa]*invf[aa-aused1];\n\tsuma%=mod;\n\tif((aused1<aa)&&(bused1<=bb))\n\t{\n\tsuma*=frac[bb];\n\tsuma%=mod;\n\tsuma*=invf[bb-bused1];\n\tsuma%=mod;\n\tsuma*=aa-aused1;\n\tsuma%=mod;\n\tsuma*=fa[k];\n\tsuma%=mod;\n\t}\n\telse suma=0;\n\t\n\tlong long sumb=frac[bb]*invf[bb-bused2];\n\tsumb%=mod;\n\tif((bused2<bb)&&(aused2<=aa))\n\t{\n\tsumb*=frac[aa];\n\tsumb%=mod;\n\tsumb*=invf[aa-aused2];\n\tsumb%=mod;\n\tsumb*=bb-bused2;\n\tsumb%=mod;\n\tsumb*=fb[k];\n\tsumb%=mod;\n\t}\n\telse sumb=0;\n\t\n\tlong long sum=suma+sumb;\n\tsum%=mod;\n\tans*=sum%mod;\n\tans%=mod;\n\treturn ans;\n}\n/*\nhave got num cards and the next is the kth\n*/\ninline void getabc(long long x0,long long y0,long long x1,long long y1,long long x2,long long y2,long long &aa,long long &bb,long long &cc)\n{\n\taa=0;\n\tbb=0;\n\tcc=0;\n\tlong long sum=0;\n\t//0a 0b\n\tsum=(x0-x1)*(x0-x2);\n\tsum%=mod;\n\tsum=poww(sum,mod-2);\n\tsum*=y0;\n\tsum%=mod;\n\taa+=sum;\n\taa%=mod;\n\tsum*=(x1+x2);\n\tsum%=mod;\n\tbb+=sum;\n\tbb%=mod;\n\t//1a 1b\n\tsum=(x1-x0)*(x1-x2);\n\tsum%=mod;\n\tsum=poww(sum,mod-2);\n\tsum*=y1;\n\tsum%=mod;\n\taa+=sum;\n\taa%=mod;\n\tsum*=(x0+x2);\n\tsum%=mod;\n\tbb+=sum;\n\tbb%=mod;\n\t//2a 2b\n\tsum=(x2-x0)*(x2-x1);\n\tsum%=mod;\n\tsum=poww(sum,mod-2);\n\tsum*=y2;\n\tsum%=mod;\n\taa+=sum;\n\taa%=mod;\n\tsum*=(x0+x1);\n\tsum%=mod;\n\tbb+=sum;\n\tbb%=mod;\n\t\n\tbb*=-1;\n\tbb%=mod;\n\tif(bb<0) bb+=mod;\n\t//0c\n\tsum=(x0-x1)*(x0-x2);\n\tsum%=mod;\n\tsum=poww(sum,mod-2);\n\tsum*=y0;\n\tsum%=mod;\n\tsum*=x1;\n\tsum%=mod;\n\tsum*=x2;\n\tsum%=mod;\n\tcc+=sum;\n\tcc%=mod;\n\t//1c\n\tsum=(x1-x0)*(x1-x2);\n\tsum%=mod;\n\tsum=poww(sum,mod-2);\n\tsum*=y1;\n\tsum%=mod;\n\tsum*=x0;\n\tsum%=mod;\n\tsum*=x2;\n\tsum%=mod;\n\tcc+=sum;\n\tcc%=mod;\n\t//2c\n\tsum=(x2-x0)*(x2-x1);\n\tsum%=mod;\n\tsum=poww(sum,mod-2);\n\tsum*=y2;\n\tsum%=mod;\n\tsum*=x0;\n\tsum%=mod;\n\tsum*=x1;\n\tsum%=mod;\n\tcc+=sum;\n\tcc%=mod;\n}\nsigned main()\n{\n//\tfreopen(\"landlords2.in\",\"r\",stdin);\n//\tfreopen(\"landlords2.out\",\"w\",stdout);\n\tmemset(f,0,sizeof(f)); \n\tn=read();\n\tm=read();\n\ttype=read();\n\tint i=1,j=1,k=1;\n\twhile(i<=m)\n\t{\n\t\ta[i]=read();\n\t\t++i;\n\t}\n\tfrac[0]=1;\n\ti=1;\n\twhile(i<=n)\n\t{\n\t\tfrac[i]=frac[i-1]*i;\n\t\tfrac[i]%=mod;\n\t\t++i;\n\t}\n\tinvf[n]=poww(frac[n],mod-2);\n\ti=n;\n\twhile(i>=1)\n\t{\n\t\tinvf[i-1]=invf[i]*i;\n\t\tinvf[i-1]%=mod;\n\t\t--i;\n\t}\n\ti=n;\n\twhile(i>=n-3)\n\t{\n\t\tf[0][n-i+1]=poww(i,type);\n\t\tf[0][n-i+1]%=mod;\n\t\t--i;\n\t}\n\tint cur=0;\n\ti=1;\n\twhile(i<=m)\n\t{\n\t\tcur^=1;\n\t\tint aa=0,bb=0;\n\t\tmemset(f[cur],0,sizeof(f[cur]));\n\t\tmemset(fa,0,sizeof(fa));\n\t\tmemset(fb,0,sizeof(fb));\n\t\tj=1;\n\t\twhile(j<=3)\n\t\t{\n\t\t\tfb[++bb]=f[cur^1][j];\n\t\t\t++j;\n\t\t}\n\t\tbb=n-a[i];\n\t\taa=a[i];\n\t\tlong long ax,bx,cx;\n\t\tgetabc(1,fb[1],2,fb[2],3,fb[3],ax,bx,cx);\n\t\tint x=n-a[i]+1;\n\t\tj=1;\n\t\twhile(j<=3)\n\t\t{\n\t\t\tfa[j]=ax*x;\n\t\t\tfa[j]%=mod;\n\t\t\tfa[j]*=x;\n\t\t\tfa[j]%=mod;\n\t\t\tfa[j]+=(bx*x)%mod;\n\t\t\tfa[j]%=mod;\n\t\t\tfa[j]+=cx;\n\t\t\tfa[j]%=mod;\n\t\t\t++x;\n\t\t\t++j;\n\t\t}\n\t\tj=1;\n\t\twhile(j<=3)\n\t\t{\n\t\t\tk=1;\n\t\t\twhile(k<=3)\n\t\t\t{\n\t\t\t\tf[cur][j]+=sum(aa,bb,j-1,k);\n\t\t\t\tf[cur][j]%=mod;\n\t\t\t\t++k;\n\t\t\t}\n\t\t\t++j;\n\t\t}\n\t\t++i;\n\t}\n\tlong long aaa,bbb,ccc;\n\tgetabc(1,f[cur][1],2,f[cur][2],3,f[cur][3],aaa,bbb,ccc);\n\tint qq=read();\n\twhile(qq--)\n\t{\n\t\tint cc=read();\n\t\tcc=n-cc+1;\n\t\tint ans=0;\n\t\tans=aaa*cc;\n\t\tans%=mod;\n\t\tans*=cc;\n\t\tans%=mod;\n\t\tans+=(cc*bbb)%mod;\n\t\tans%=mod;\n\t\tans+=ccc;\n\t\tans%=mod;\n\t\tif(ans<0) ans+=mod;\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n\n\n$\\ \\color{white}\\text{\u4e3a\u4eac\u963f\u5c3c\u7948\u798f}$\n\n\n\n\n\n",
        "postTime": 1563498382,
        "uid": 138391,
        "name": "orecic",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5472 \u3010[NOI2019]\u6597\u4e3b\u5730\u3011"
    }
]
[
    {
        "content": "[P2260 [\u6e05\u534e\u96c6\u8bad2012]\u6a21\u79ef\u548c](https://www.luogu.com.cn/problem/P2260)\u89e3\u9898\u62a5\u544a\uff1a\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://zybuluo.com/xiaoziyao/note/1724317)\n\n\u53cc\u500d\u7ecf\u9a8c\uff1a[P2834 \u80fd\u529b\u6d4b\u9a8c](https://www.luogu.com.cn/problem/P2834)\n\n## \u9898\u610f\n\u9898\u610f\uff1a\u6c42$\\sum_{i=1}^n\\sum_{j=1}^m[i\\ne j](n\\bmod i)\\cdot(m\\bmod j)$\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\leqslant n,m\\leqslant 10^9$\u3002\n\n## \u5206\u6790\n\n\u8fd9\u662f\u4e00\u9053\u7b80\u5355\u7684\u63a8\u5f0f\u5b50\u9898\uff0c\u4f46\u662f\u5b9e\u73b0\u6bd4\u8f83\u6076\u5fc3\u3002\n\n\u9996\u5148\u4e0d\u59a8\u8bbe$n\\leqslant m$\uff08\u5982\u679c$n>m$\u4ea4\u6362\u4e00\u4e0b\u5c31\u597d\u4e86\uff09\n\n\u7136\u540e\u53ef\u4ee5\u7528\u5bb9\u65a5\u5c06\u9898\u76ee\u62c6\u6210\u4e24\u4e2a\u90e8\u5206\uff1a\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m(n\\bmod i)\\cdot(m\\bmod j)-\\sum_{i=1}^n(n\\bmod i)\\cdot(m\\bmod i)$$\n\n\u5c06\u4e24\u4e2a\u6c42\u548c\u62c6\u5f00\uff1a\n\n$$\\sum_{i=1}^n(n\\bmod i)\\cdot\\sum_{j=1}^m(m\\bmod j)-\\sum_{i=1}^n(n\\bmod i)\\cdot(m\\bmod i)$$\n\n\u56e0\u4e3a\u53d6\u6a21\u5f88\u96be\u641e\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528\u4e00\u4e2a\u6027\u8d28$a\\bmod b=a-\\lfloor\\frac{a}{b}\\rfloor\\cdot b$\uff08\u53d6\u6a21\u7684\u5b9a\u4e49\uff09\uff0c\u5c06\u4e0a\u5f0f\u8f6c\u6362\u4e3a\uff1a\n\n$$\\sum_{i=1}^n(n-\\lfloor\\frac{n}{i}\\rfloor\\cdot i)\\cdot\\sum_{j=1}^m(m-\\lfloor\\frac{m}{j}\\rfloor\\cdot j)-\\sum_{i=1}^n(n-\\lfloor\\frac{n}{i}\\rfloor\\cdot i)\\cdot(m-\\lfloor\\frac{m}{i}\\rfloor\\cdot i)$$\n\n\u5c06\u62ec\u53f7\u62c6\u5f00\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$(n^2-\\sum_{i=1}^ni\\cdot\\lfloor\\frac{n}{i}\\rfloor)\\cdot(m^2-\\sum_{i=1}^mi\\cdot\\lfloor\\frac{m}{i}\\rfloor)-\\sum_{i=1}^n(nm-mi\\cdot\\lfloor\\frac{n}{i}\\rfloor-ni\\cdot\\lfloor\\frac{m}{i}\\rfloor+i^2\\cdot\\lfloor\\frac{n}{i}\\rfloor\\cdot\\lfloor\\frac{m}{i}\\rfloor)$$\n\n\u6b64\u65f6\u6211\u4eec\u7684\u590d\u6742\u5ea6\u5df2\u7ecf\u662f$O(n)$\u4e86\uff0c\u7136\u800c\u8fd9\u4e2a\u590d\u6742\u5ea6\u4ecd\u7136\u4e0d\u8db3\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n\u8981\u505a\u8fd9\u9053\u9898\u9700\u8981\u4e00\u4e2a\u7b80\u5355\u7684\u6280\u5de7\u2014\u2014\u6574\u9664\u5206\u5757\u3002\n\n\u6211\u4eec\u5f88\u5bb9\u6613\u53d1\u73b0\u5f88\u591a$\\lfloor\\frac{n}{i}\\rfloor$\u7684\u503c\u662f\u4e00\u6837\u7684\uff0c\u4e14\u6240\u6709\u7684$\\lfloor\\frac{n}{i}\\rfloor$\u4e3a\u4e00\u4e2a\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\uff0c\u5448\u5757\u72b6\u5206\u5e03\n\n\u901a\u8fc7\u7b80\u5355\u7684\u8ba1\u7b97\u53ef\u4ee5\u5f97\u5230\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8d77\u70b9\u4e3a$i$\u7684\u5757\uff0c\u5b83\u7684\u503c\u4e3a$\\lfloor\\frac{n}{i}\\rfloor$\uff0c\u7ec8\u70b9\u4e3a$\\lfloor\\frac{n}{\\lfloor\\frac{n}{i}\\rfloor}\\rfloor$\uff0c\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u7528$O(\\sqrt{n})$\u7684\u7b97\u6cd5\u8ba1\u7b97$\\sum_{i=1}^ni\\cdot \\lfloor\\frac{n}{i}\\rfloor$\u4e86\uff1a\n\n\u4e3b\u8981\u6b65\u9aa4\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5757$[l,r]$\uff0c\u5b83\u4e58\u53f7\u524d\u9762\u524d\u7f00\u548c\u5dee\u5206\u5f97\u5230\uff0c\u5373$(1+2+\\cdots+r)-(1+2+\\cdots+(l-1))$\uff0c\u4e58\u53f7\u540e\u9762\u7684\u5c31\u662f$\\lfloor\\frac{n}{l}\\rfloor$\u3002\n\n\u4ee3\u7801\uff1a\n\n```\ninline long long sum1(long long x){\n\treturn x*(x+1)%mod*inv2%mod;\n}\n\nl=1,sum=n*n%mod;\nwhile(l<=n){\n\tr=n/(n/l);\n\tsum=(sum-(sum1(r)-sum1(l-1)+mod)%mod*(n/l)%mod+mod)%mod;\n\tl=r+1;\n}\n```\n\n\u540c\u6837\uff0c$\\sum_{i=1}^mi\\cdot \\lfloor\\frac{m}{i}\\rfloor$\u7684\u503c\u4e5f\u53ef\u4ee5\u7528\u76f8\u540c\u7684\u65b9\u6cd5\u6c42\u5f97\u3002\n\n\u8003\u8651\u6c42$\\sum_{i=1}^n(nm-mi\\cdot\\lfloor\\frac{n}{i}\\rfloor-ni\\cdot\\lfloor\\frac{m}{i}\\rfloor+i^2\\cdot\\lfloor\\frac{n}{i}\\rfloor\\cdot\\lfloor\\frac{m}{i}\\rfloor)$\uff0c\u53d1\u73b0\u7528\u6574\u9664\u5206\u5757\u5b8c\u6210\u5b83\u9700\u8981\u4f7f\u533a\u95f4$[l,r]$\u4e2d\u6240\u6709\u7684$i$\u90fd\u6ee1\u8db3$\\lfloor\\frac{n}{i}\\rfloor$\u4e0e$\\lfloor\\frac{m}{i}\\rfloor$\u76f8\u540c\u3002\n\n\u53ef\u4ee5\u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\uff0c\u5c06\u4e0a\u9762\u4ee3\u7801\u4e2d\u7684```r=n/(n/l);```\u6539\u4e3a```r=min(n/(n/l),m/(m/l));```\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u76f4\u63a5\u6c42\u503c\u4e86\uff01\n\n\u4e14\u6162\uff0c\u867d\u7136\u524d\u4e09\u9879$nm,mi\\cdot\\lfloor\\frac{n}{i}\\rfloor,ni\\cdot\\lfloor\\frac{m}{i}\\rfloor$\u90fd\u5f88\u5bb9\u6613\u6c42\u5f97\uff0c\u4f46\u662f$i^2\\cdot\\lfloor\\frac{n}{i}\\rfloor\\cdot\\lfloor\\frac{m}{i}\\rfloor$\u4e0d\u662f\u5f88\u5bb9\u6613\u6c42\uff0c\u56e0\u4e3a$(1^2+2^2+\\cdots+i^2)$\u4e0d\u597d\u5904\u7406\u3002\n\n\u8fd9\u91cc\u6709\u4e00\u4e2a\u7b80\u5355\u7684\u7ed3\u8bba\uff1a$1^2+2^2+\\cdots+n^2=\\frac{n(n+1)(2n+1)}{6}$\uff0c\u4f1a\u5728\u6587\u540e\u8bc1\u660e\uff0c\u73b0\u5728\u5148\u7ed9\u51fa\u8fd9\u4e00\u90e8\u5206\u7684\u4ee3\u7801\uff1a\n\n```\ninline long long sum2(long long x){\n\treturn x*(x+1)%mod*(2*x+1)%mod*inv6%mod;\n}\n\nl=1,tmp3=0;\nwhile(l<=n){\n\tlong long a,b,c;\n\tr=min(n/(n/l),m/(m/l));\n\ta=(r-l+1)*n%mod*m%mod;\n\tb=(sum1(r)-sum1(l-1)+mod)%mod*((n/l)*m%mod+(m/l)*n%mod)%mod;\n\tc=(sum2(r)-sum2(l-1)+mod)%mod*(n/l)%mod*(m/l)%mod;\n\ttmp3=(tmp3+a-b+c+mod)%mod;\n\tl=r+1;\n}\n```\n\n## \u4ee3\u7801\n- \u8bb0\u5f97\u5f00long long\n- \u53d6\u6a21\u5f88\u6076\u5fc3\uff0c\u5982\u679c\u9519\u4e86\u591a\u534a\u662f\u8fd9\u79cd\u539f\u56e0\n- \u56e0\u4e3a\u4e09\u4e2a\u6574\u6570\u76f8\u4e58\u4f1a\u7206long long\uff0c\u56e0\u6b64\u9664\u6cd5\u7528\u9006\u5143\u5b9e\u73b0\uff08\u9006\u5143\u63d0\u524d\u6c42\u5f97\uff09\n\n```\n#include<stdio.h>\nconst long long mod=19940417,inv2=9970209,inv6=3323403;\nlong long i,j,k,m,n,l,r,ans,tmp1,tmp2,tmp3;\ninline long long min(long long a,long long b){\n\treturn a<b? a:b; \n}\ninline void swp(long long &a,long long &b){\n\ta+=b,b=a-b,a-=b;\n}\ninline long long sum1(long long x){\n\treturn x*(x+1)%mod*inv2%mod;\n}\ninline long long sum2(long long x){\n\treturn x*(x+1)%mod*(2*x+1)%mod*inv6%mod;\n}\nint main(){\n\tscanf(\"%lld%lld\",&n,&m);\n\tif(n>m)\n\t\tswp(n,m);\n\tl=1,tmp1=n*n%mod;\n\twhile(l<=n){\n\t\tr=n/(n/l);\n\t\ttmp1=(tmp1-(sum1(r)-sum1(l-1)+mod)%mod*(n/l)%mod+mod)%mod;\n\t\tl=r+1;\n\t}\n\tl=1,tmp2=m*m%mod;\n\twhile(l<=m){\n\t\tr=m/(m/l);\n\t\ttmp2=(tmp2-(sum1(r)-sum1(l-1)+mod)%mod*(m/l)%mod+mod)%mod;\n\t\tl=r+1;\n\t}\n\tl=1,tmp3=0;\n\twhile(l<=n){\n\t\tlong long a,b,c;\n\t\tr=min(n/(n/l),m/(m/l));\n\t\ta=(r-l+1)*n%mod*m%mod;\n\t\tb=(sum1(r)-sum1(l-1)+mod)%mod*((n/l)*m%mod+(m/l)*n%mod)%mod;\n\t\tc=(sum2(r)-sum2(l-1)+mod)%mod*(n/l)%mod*(m/l)%mod;\n\t\ttmp3=(tmp3+a-b+c+mod)%mod;\n\t\tl=r+1;\n\t}\n\tans=(tmp1*tmp2%mod-tmp3+mod)%mod;\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n} \n```\n\n## \u7b80\u5355\u7684\u8bc1\u660e\n\u8bc1\u660e\uff1a\n\n$$1^2+2^2+\\cdots+n^2=\\frac{n(n+1)(2n+1)}{6}$$\n\n\uff08\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u7528\u7b80\u5355\u6784\u9020\u6cd5\u4e0e\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bc1\u660e\uff0c\u7531\u4e8e\u5927\u90e8\u5206\u9898\u89e3\u90fd\u662f\u7528\u7684\u6570\u5b66\u5f52\u7eb3\u6cd5\uff0c\u4e14\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bfb\u8005\u81ea\u8bc1\u4e0d\u96be\uff0c\u56e0\u6b64\u8fd9\u91cc\u4f7f\u7528\u7b80\u5355\u6784\u9020\u6cd5\uff09\n\n\u7531\u4e8e\u6709\u8fd9\u6837\u4e00\u4e2a\u5f0f\u5b50\uff1a$i^2=i^2-i+i(i-1)\\cdot i+i$\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u62c6\u5f00\uff1a\n\n$$1^2+2^2+\\cdots+n^2=\\sum_{i=1}^ni^2=\\sum_{i=1}^n(i-1)\\cdot i+\\sum_{i=1}^ni$$\n\n\u7136\u540e\u4e58\u4e0a$\\frac{1}{3}$\uff1a\n\n$$\\sum_{i=1}^ni^2=\\frac{1}{3}\\sum_{i=1}^n(i-1)\\cdot i\\cdot3+\\sum_{i=1}^ni$$\n\n\u6784\u9020\u4e00\u4e0b\uff1a\n\n$$\\sum_{i=1}^ni^2=\\frac{1}{3}\\sum_{i=1}^n(i-1)\\cdot i\\cdot((i+1)-(i-2))=\\frac{1}{3}\\sum_{i=1}^n(-(i-2)\\cdot(i-1)\\cdot i+(i-1)\\cdot i\\cdot(i+1))+\\sum_{i=1}^ni$$\n\n\u628a\u5b83\u4eec\u5168\u90e8\u5c55\u5f00\uff1a\n\n$$\\sum_{i=1}^ni^2=\\frac{1}{3}(-(-1)\\cdot0\\cdot1+0\\cdot1\\cdot2-0\\cdot1\\cdot2+1\\cdot2\\cdot3-1\\cdot2\\cdot3+\\cdots(n-1)\\cdot n\\cdot(n+1))+\\frac{n\\cdot(n+1)}{2}$$\n\n\u53d1\u73b0\u62ec\u53f7\u91cc\u7684\u5f88\u591a\u9879\u90fd\u53ef\u4ee5\u62b5\u6d88\uff1a\n\n$$\\sum_{i=1}^ni^2=\\frac{(n-1)\\cdot n\\cdot(n+1)}{3}+\\frac{n\\cdot(n+1)}{2}=\\frac{n\\cdot(n+1)\\cdot(2(n-1)+3)}{6}=\\frac{n\\cdot(n+1)\\cdot(2n+1)}{6}$$\n\n\u8bc1\u6bd5\u3002",
        "postTime": 1594730063,
        "uid": 35754,
        "name": "Verdandi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2260 \u3010[\u6e05\u534e\u96c6\u8bad2012]\u6a21\u79ef\u548c\u3011"
    },
    {
        "content": "\u9884\u5907\u77e5\u8bc6:\n\n1.\u5bf9\u4e8e\u4efb\u610f\u6b63\u6574\u6570$a,p$,\u5982\u679c$(a,p)=1$,\u5219$a^{\\phi(p)}\\equiv1 (mod)$  $p$.\n\u4e0a\u5f0f\u88ab\u79f0\u4e3a\u6b27\u62c9\u5b9a\u7406.\n\n2.$\\sum\\limits_{i=1}^n i^2=\\frac{n(n+1)(2n+1)}{6}$ ,\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u6613\u8bc1.\n\n3.$\\sum\\limits_{i=1}^n \\lfloor \\frac{n}{i} \\rfloor$\u53ef\u4ee5\u5728$O(\\sqrt n)$\u65f6\u95f4\u5185\u6c42\u51fa,\u56e0\u4e3a$\\lfloor \\frac{n}{i} \\rfloor$\u6700\u591a\u53ea\u6709$O(\\sqrt n)$\u79cd\u53d6\u503c.\n\n\u4e0b\u9762\u5f00\u59cb\u672c\u9898\u7684\u63a8\u5bfc\n\n$\\sum\\limits_{i=1}^n \\sum\\limits_{j=1,j\\neq i}^m (n$ $mod$ $i)$ $\\cdot (m$  $mod$ $j)$\n\n\u5229\u7528\u5bb9\u65a5\u539f\u7406,\u628a$j\\neq i$\u7684\u6761\u4ef6\u8f6c\u6362\u51fa\u6765,\n\n$\\sum_{i=1}^{n}\\sum_{j=1}^{m}(n-{\\left \\lfloor \\frac{n}{i} \\right \\rfloor}i)(m-{\\left \\lfloor \\frac{m}{j} \\right \\rfloor}j)-\\sum_{i=1}^{min(n,m)}(n-{\\left \\lfloor \\frac{n}{i} \\right \\rfloor}i)(m-{\\left \\lfloor \\frac{m}{i} \\right \\rfloor}i)$\n\n\u628a\u540e\u9762\u7684\u5f0f\u5b50\u5c55\u5f00\n\n$\\sum_{i=1}^{n}\\sum_{j=1}^{m}(n-{\\left \\lfloor \\frac{n}{i} \\right \\rfloor}i)(m-{\\left \\lfloor \\frac{m}{j} \\right \\rfloor}j)-\\sum_{i=1}^{min(n,m)}(nm+{\\left \\lfloor \\frac{n}{i} \\right \\rfloor}{\\left \\lfloor \\frac{m}{i} \\right \\rfloor}i^2-(m{\\left \\lfloor \\frac{n}{i} \\right \\rfloor}+n{\\left \\lfloor \\frac{m}{i} \\right \\rfloor})i)$\n\n\u7136\u540e\u63d0\u51fa\u6765\u4e00\u4e2a\u6c42\u548c,\n\n$\\sum_{i=1}^{n}(n-{\\left \\lfloor \\frac{n}{i} \\right \\rfloor}i)\\sum_{j=1}^{m}(m-{\\left \\lfloor \\frac{m}{j} \\right \\rfloor}j)-\\sum_{i=1}^{min(n,m)}(nm+{\\left \\lfloor \\frac{n}{i} \\right \\rfloor}{\\left \\lfloor \\frac{m}{i} \\right \\rfloor}i^2-(m{\\left \\lfloor \\frac{n}{i} \\right \\rfloor}+n{\\left \\lfloor \\frac{m}{i} \\right \\rfloor})i)$\n\n\u7136\u540e\u524d\u4e24\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u7528\u6570\u8bba\u5206\u5757\u505a,\u540e\u4e09\u4e2a\u53c2\u89c1\u9884\u5907\u77e5\u8bc6.\n\n\u849f\u84bb\u7684\u4ee3\u7801:\n\n\u6ce8:\u9006\u5143\u4e5f\u53ef\u4ee5\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u6c42\u51fa.\n\n```cpp\n#include<algorithm>\n#include<cctype>\n#include<cmath>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<iostream>\n#include<map>\n#include<queue>\n#include<stack>\n#include<vector>\n#define size 500010\n#define debug(x) cerr<<#x<<\"=\"<<x\n#define gc getchar()\n#define db double\n#define ll long long\n#define rep(i,s,n) for (register int i=s;i<=n;i++)\n#define drep(i,n,s) for (register int i=n;i>=s;i--)\n#define il inline\nusing namespace std;\n\nil ll read()\n{\n\tchar c; ll x,f=1;\n\tfor (c=gc;!isdigit(c);c=gc) if (c=='-') f=-1; x=c-'0';\n\tfor (c=gc;isdigit(c);c=gc) x=(x<<1)+(x<<3)+c-'0';\n\treturn f*x;\n}\n\nconst ll M=19940417;\n\nll ksm(ll x,ll y)\n{\n\tll res=1;\n\twhile (y)\n\t{\n\t\tif (y&1) res=res*x%M;\n\t\tx=x*x%M;\n\t\ty>>=1;\n\t}\n\treturn res;\n}\n\nll n,m,k,ans=0,inv=ksm(6,17091779);\nil ll sum1(ll p,ll q) {return (q+p)*(q-p+1)/2%M;}\nil ll sum2(ll x) {return (x*(x+1))%M*(2*x+1)%M*inv%M;}\n\n\nll calc(ll n)\n{\n\tll res=0;\n\tfor (ll l=1,r; l<=n; l=r+1) r=n/(n/l),res=(res+n*(r-l+1)%M-sum1(l,r)*(n/l)%M+M)%M;\n\treturn res;\n}\n\nvoid work(ll n,ll m)\n{\n\tans=calc(n)*calc(m)%M;\n\tfor (ll l=1,r,sum=0,SUM=0,Sum=0;l<=n;l=r+1)\n\t{\n\t\tr=min(n/(n/l),m/(m/l));\n\t\tSUM=(m*n%M*(r-l+1))%M;\n\t\tSum=(n/l)*(m/l)%M*(sum2(r)-sum2(l-1)+M)%M;\n\t\tsum=(n/l*m%M+m/l*n%M)*sum1(l,r)%M;\n\t\tans=(ans-(SUM+Sum-sum+M)%M+M)%M;\n\t}\n\tcout<<ans%M<<endl;\n}\n\nint main()\n{\n\tn=read(); m=read(); if (n>m) swap(n,m); \n\twork(n,m);\n\treturn 0;\n}\n\n\n```\n",
        "postTime": 1521772206,
        "uid": 44273,
        "name": "\u786b\u4ee3\u786b\u9178\u94a0",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2260 \u3010[\u6e05\u534e\u96c6\u8bad2012]\u6a21\u79ef\u548c\u3011"
    },
    {
        "content": "\u6211\u4eec\u4e00\u6b65\u4e00\u6b65\u5730\u6765\u3002\n\n------------\n\u5148\u5316\u7b80\u4e00\u6ce2\u67ff\u5b50qaqq\n\n\u65b9\u4fbf\u8d77\u89c1\uff0c\u5047\u8bbe $n\\leqslant m$\uff0c\u7a0b\u5e8f\u5177\u4f53\u5b9e\u73b0\u7684\u65f6\u5019\uff0c\u5982\u679c $n>m$ \u5219\u4ea4\u6362\u4e00\u4e0b\u5373\u53ef\u3002\u89c2\u5bdf\u67ff\u5b50\n\n$$\n\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m (n\\bmod i)\\times(m\\bmod j)\\;\\left[i\\ne j\\right]\n$$\n\n\u597d\u50cf\u6c42\u548c\u53f7\u91cc\u9762\u7b2c\u4e00\u4e2a\u56e0\u5f0f\u548c $j$ \u6ca1\u4ec0\u4e48\u5173\u7cfb\u554a\uff0c\u90a3\u4e48\u5c31\u8d76\u7d27\u63d0\u51fa\u53bb\n\n$$\n\\sum\\limits_{i=1}^n(n\\bmod i)\\times\\sum\\limits_{j=1}^m (m\\bmod j)\\;\\left[i\\ne j\\right]\n$$\n\n\u4f17\u6240\u5468\u77e5\u8fd9\u79cd $i\\ne j$ \u662f\u53ef\u4ee5\u5bb9\u65a5\u7684\uff0c\u6211\u4eec\u8f6c\u6362\u6210\u4e24\u4e2a\u6c42\u548c\u5f0f\u76f8\u51cf\n\n$$\n\\sum\\limits_{i=1}^n(n\\bmod i)\\times\\sum\\limits_{j=1}^m (m\\bmod j)-\\sum\\limits_{i=1}^n (n\\bmod i)\\times(m\\bmod i)\n$$\n\n\u8fd9\u4e2a $\\bmod$ \u4e00\u770b\u5c31\u5f88\u4e0d\u987a\u773c\uff0c\u6211\u4eec\u628a $a\\bmod b$ \u5199\u6210 $a-\\lfloor\\frac{a}{b}\\rfloor\\times b$ \u7684\u5f62\u5f0f\n\n$$\n\\sum\\limits_{i=1}^n\\left(n-\\Big\\lfloor\\frac{n}{i}\\Big\\rfloor\\times i\\right)\\times\\sum\\limits_{j=1}^m \\Big(m-\\Big\\lfloor\\frac{m}{j}\\Big\\rfloor\\times j\\Big)-\\sum\\limits_{i=1}^n\\left(n-\\Big\\lfloor\\frac{n}{i}\\Big\\rfloor\\times i\\right)\\times\\left(m-\\Big\\lfloor\\frac{m}{i}\\Big\\rfloor\\times i\\right)\n$$\n\n\u73b0\u5728\u67ff\u5b50\u770b\u4e0a\u53bb\u597d\u591a\u4e86\uff01\n\n\u6211\u4eec\u628a\u4fe9\u6c42\u548c\u5206\u5f00\u6765\u770b\u3002\n\n------------\n\u9996\u5148\u6211\u4eec\u6765\u770b\n\n$$\n\\sum\\limits_{i=1}^n\\left(n-\\Big\\lfloor\\frac{n}{i}\\Big\\rfloor\\times i\\right)\\times \\sum\\limits_{j=1}^m \\Big(m-\\Big\\lfloor\\frac{m}{j}\\Big\\rfloor\\times j\\Big)\n$$\n\n\u6211\u4eec\u53c8\u770b\u5230\u4e86\u6c42\u548c\u53f7\u91cc\u6709\u4e00\u4e9b\u548c $i$ \u6216 $j$ \u65e0\u5173\u7684\u4e1c\u897f\uff0c\u6240\u4ee5\u53ef\u4ee5\u8fdb\u4e00\u6b65\u63d0\u53d6\u51fa\uff0c\u67ff\u5b50\u5c31\u53d8\u6210\u4e86\n\n$$\n\\left(n^2-\\sum\\limits_{i=1}^n\\Big\\lfloor\\frac{n}{i}\\Big\\rfloor\\times i\\right)\\times \\left(m^2-\\sum\\limits_{j=1}^m\\Big\\lfloor\\frac{m}{\nj}\\Big\\rfloor\\times j\\right)\n$$\n\n\u6211\u4eec\u77e5\u9053\u5bf9\u4e8e\u4e00\u6bb5\u7684 $i$\uff0c $\\lfloor\\frac{n}{i}\\rfloor$ \u7684\u503c\u4e8b\u4e00\u6837\u7684\u3002\u6211\u4eec\u5982\u4f55\u627e\u5230\u8fd9\u4e00\u6bb5\u533a\u95f4\u7684\u7aef\u70b9 $l,r$\uff1f\n\n\u9996\u5148\u8fd9\u4e2a $l$ \u6551\u4e16\u4e0a\u4e00\u4e2a\u533a\u95f4\u7684 $r+1$\uff0c\u7b2c\u4e00\u4e2a $l$ \u5c31\u662f $1$\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8003\u8651 $r$ \u600e\u4e48\u51fa\u6765\u3002\u5176\u5b9e\u662f\u8981\u627e\u5230\u4e00\u4e2a$r$\uff0c\u4f7f\n$\\Big\\lfloor\\frac{n}{l}\\Big\\rfloor\\times r\\leqslant n$\u3002\n\n\u4e8e\u662f\u6211\u4eec\u968f\u4fbf\u79fb\u9879\u4e00\u4e0b\uff0c\u4fbf\u53ef\u5f97 $r=\\bigg\\lfloor\\dfrac{n}{\\lfloor\\frac{n}{l}\\rfloor}\\bigg\\rfloor$\n\n\u8fd9\u5c31\u662f\u6211\u4eec\u7684\u9664\u6cd5\u5206\u5757qaqq\n\n\u597d\u5bb6\u4f19\u6211\u4eec\u5728\u524d\u9762\u63a8\u51fa\u7684\u67ff\u5b50\u91cc\u770b\u5230\u4e86\u9664\u6cd5\u5206\u5757\u7684\u5f71\u5b50\uff0c\u78b0\u5de7 $i$ \u7684\u524d\u7f00\u548c\u5f88\u597d\u6c42\uff0c\u6240\u4ee5\u8fd9\u91cc\u9664\u6cd5\u5206\u5757\u975e\u5e38\u5bb9\u6613\uff01\n\n\u770b\u4e0b\u4ee3\u7801\u7f62\uff1a\n\n```cpp\nsum=n*n%p;\nfor(ll l=1,r;l<=n;l=r+1)\n{\n\tr=min(n/(n/l),n);\n\tsum=(sum-(s1(r)-s1(l-1)+p)%p*(n/l)%p+p)%p;\n}\nans+=sum,sum=m*m%p;\nfor(ll l=1,r;l<=m;l=r+1)\n{\n\tr=min(m/(m/l),m);\n\tsum=(sum-(s1(r)-s1(l-1)+p)%p*(m/l)%p+p)%p;\n}\nans*=sum,ans%=p,sum=0;\n```\n\n------------\n\u7136\u540e\u6211\u4eec\u518d\u770b\u540e\u9762\u4e00\u90e8\u5206\u3002\n\n$$\n\\sum\\limits_{i=1}^n\\left(n-\\Big\\lfloor\\frac{n}{i}\\Big\\rfloor\\times i\\right)\\times\\left(m-\\Big\\lfloor\\frac{m}{i}\\Big\\rfloor\\times i\\right)\n$$\n\n\u4e0a\u9762\u770b\u5230\u4e86\u9664\u6cd5\u5206\u5757\uff0c\u90a3\u4e48\u8fd9\u513f\u591a\u534a\u4e5f\u662f\u4e86\u3002\u8fd9\u8fb9\u6709\u4e2a $n$ \u548c $m$ \u5728\u62ec\u53f7\u91cc\u9762\u4e0d\u597d\u5f04\uff0c\u6240\u4ee5\u6211\u4eec\u66b4\u529b\u62c6\u62ec\u53f7\u628a\u548c $i$ \u65e0\u5173\u7684\u8fd9\u4e2a $n,m$ \u5206\u79bb\u51fa\u6765\n\n\n\n$$\n\\sum\\limits_{i=1}^n\\left(nm-ni\\Big\\lfloor\\frac{m}{i}\\Big\\rfloor-mi\\Big\\lfloor\\frac{n}{i}\\Big\\rfloor+i^2\\Big\\lfloor\\frac{n}{i}\\Big\\rfloor\\Big\\lfloor\\frac{m}{i}\\Big\\rfloor\\right)\n$$\n\n\u524d\u4e09\u9879\u975e\u5e38\u597d\u5f04\uff0c\u7b2c\u56db\u9879\u597d\u50cf\u4e5f\u53ef\u4ee5\u9664\u6cd5\u5206\u5757\uff0c\u53ea\u4e0d\u8fc7\u4fe9\u53d8\u91cf\u6240\u4ee5\u5757\u591a\u4e00\u70b9\u4e0d\u8981\u7d27\u3002\u95ee\u9898\u662f $i^2$ \u524d\u7f00\u548c\u548b\u641e\uff1f\n\n\u6211\u4eec\u77e5\u9053 $i^2=i(i-1)+i=\\binom{i}{2}+\\binom{i}{1}$\uff0c\u56e0\u6b64\n\n$$\n\\sum_{i=1}^n i^2=\\sum_{i=1}^n\\binom{i}{2}+i\n$$\n\n\u8fd9\u4e2a\u4e8c\u9879\u5f0f\u7cfb\u6570\u662f\u8ba4\u771f\u7684\uff1f\n\n\u4e0d\u8981\u7d27\u6211\u4eec\u6709\u5e15\u65af\u5361\u516c\u5f0f\uff1a$\\binom{n}{k}=\\binom{n-1}{k}+\\binom{n-1}{k-1}$\u3002\u56e0\u4e3a\u5f53 $n<k$ \u7684\u65f6\u5019\u4e8c\u9879\u5f0f\u7cfb\u6570\u4e3a $0$\uff0c\u6211\u4eec\u5bf9\u7b49\u5f0f\u53f3\u4fa7\u7684\u7b2c\u4e00\u4e2a\u6c42\u548c\u53cd\u590d\u9006\u7528\u5e15\u65af\u5361\u516c\u5f0f\uff1a\n\n$$\n\\begin{aligned}\n\\\\ \\sum_{i=1}^n= &\\binom{0}{3}+\\binom{1}{2}+\\binom{2}{2}+\\dots+\\binom{n}{2}\n\\\\ =& \\binom{3}{3}+\\binom{2}{2}+\\dots+\\binom{n-1}{2}+\\binom{n}{2}\n\\\\=&\\binom{4}{3}+\\dots+\\binom{n-1}{2}+\\binom{n}{2}\n\\\\ =&\\binom{n+1}{3}=\\frac{n(n+1)(n-1)}{6}\n\\end{aligned}\n$$\n\n\u90a3\u4e48\u6211\u4eec\u628a $\\frac{n(n+1)(n-1)}{6}$ \u5e26\u56de\u539f\u6765\u7684\u6c42\u548c\u5f0f\uff0c\u6700\u7ec8\u5f97\u5230\n\n$$\n\\sum_{i=1}^n i^2=\\frac{n(n+1)(n-1)}{6}+\\frac{n(n+1)}{2}=\\frac{n(n+1)(2n+1)}{6}\n$$\n\n\u539f\u6765\u6211\u4eec\u7684 $i^2$ \u7684\u524d\u7f00\u548c\u4e5f\u662f\u53ef\u4ee5\u5904\u7406\u7684\uff01\uff01\n\n```cpp\n\nfor(ll l=1,r;l<=n;l=r+1)\n{\n\tr=min(min(n/(n/l),m/(m/l)),n);\n\tsum+=(r-l+1)*n%p*m%p;\n\tsum-=(s1(r)-s1(l-1)+p)%p*((n/l)*m%p+(m/l)*n%p)%p;\n\tsum+=(s2(r)-s2(l-1)+p)%p*(n/l)%p*(m/l)%p;\n\tsum+=p,sum%=p;\n}\n```\n\n\u7136\u540e\u5462\uff1f\u6211\u4eec\u8fd9\u9053\u9898\u5c31\u505a\u5b8c\u5566qaqq\n\n------------\n\u4ee3\u7801\u5b9e\u73b0\u6ce8\u610f\u968f\u65f6\u8981 $\\bmod\\,p$\uff0c\u5426\u5219\u5c31\u662f\u4e00\u7247WA\u3002\n\n\u5176\u4ed6\u6551\u4e16\u5957\u8def\u5566qaqq\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\ninline ll read()\n{\n\tll x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\n\treturn x*f;\n}\nconst ll p=1000000007,inv2=500000004,inv6=166666668;\nll n,m,ans,sum;\n#define s1(x) (x)*((x)+1)%p*inv2%p\n#define s2(x) (x)*((x)+1)%p*(2*(x)+1)%p*inv6%p\ninline ll min(ll a,ll b){return a<b?a:b;}\nint main(){\n\tn=read(),m=read();\n\tif(n>m)swap(n,m);\n\tsum=n*n%p;\n\tfor(ll l=1,r;l<=n;l=r+1)\n\t{\n\t\tr=min(n/(n/l),n);\n\t\tsum=(sum-(s1(r)-s1(l-1)+p)%p*(n/l)%p+p)%p;\n\t}\n\tans+=sum,sum=m*m%p;\n\tfor(ll l=1,r;l<=m;l=r+1)\n\t{\n\t\tr=min(m/(m/l),m);\n\t\tsum=(sum-(s1(r)-s1(l-1)+p)%p*(m/l)%p+p)%p;\n\t}\n\tans*=sum,ans%=p,sum=0;\n\tfor(ll l=1,r;l<=n;l=r+1)\n\t{\n\t\tr=min(min(n/(n/l),m/(m/l)),n);\n\t\tsum+=(r-l+1)*n%p*m%p;\n\t\tsum-=(s1(r)-s1(l-1)+p)%p*((n/l)*m%p+(m/l)*n%p)%p;\n\t\tsum+=(s2(r)-s2(l-1)+p)%p*(n/l)%p*(m/l)%p;\n\t\tsum+=p,sum%=p;\n\t}\n\tans-=sum,ans+=p,ans%=p;\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n} \n```",
        "postTime": 1613651964,
        "uid": 246979,
        "name": "SalomeJLQ",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P2834 \u80fd\u529b\u6d4b\u9a8c"
    },
    {
        "content": "## \u5206\u6790\n\u5df2\u77e5\uff1a\n$$\nn \\mod m=n-\\lfloor \\frac{n}{m} \\rfloor \\times m\n$$\n$$\nans=ans_1-ans_2\n$$\n$$\nans_1=\\sum_i^n\\sum_j^m(n - \\lfloor \\frac{n}{i} \\rfloor \\times i)\\times (m-\\lfloor \\frac{m}{j} \\rfloor \\times j)\n$$\n$$\nans_1=\\sum_i^n(n - \\lfloor \\frac{n}{i} \\rfloor \\times i)\\times \\sum_j^m(m-\\lfloor \\frac{m}{j} \\rfloor \\times j)\n$$\n$$\nans_2=\\sum_i^n(n - \\lfloor \\frac{n}{i} \\rfloor \\times i)\\times (m-\\lfloor \\frac{m}{i} \\rfloor \\times i)\n$$\n$$\nans_2=\\sum_i^n(n m-\\lfloor \\frac{n}{i} \\rfloor \\times i\\times m-\\lfloor \\frac{m}{i} \\rfloor \\times i\\times n+\\lfloor \\frac{n}{i} \\rfloor\\lfloor \\frac{m}{i} \\rfloor\\times i^2)\n$$\n\u4ee4\uff1a\n$$\nf(x) = \\sum_i^x(x - \\lfloor \\frac{x}{i} \\rfloor \\times i)=x^2-\\sum_i^x (\\lfloor \\frac{x}{i} \\rfloor \\times i) \n$$\n$$\ng(x) = \\sum_i^n(\\lfloor \\frac{n}{i} \\rfloor \\times i)\n$$\n\u8003\u8651 $g(x)$ \u7684\u5feb\u901f\u6c42\u6cd5\uff0c\u56e0\u4e3a\u4e00\u4e2a\u4e3a $n$ \u7684\u6570\u4e0d\u53ef\u80fd\u6709\u8d85\u8fc7 $\\sqrt{n}$ \u4e2a\u9664\u6570\uff0c\u6240\u4ee5\uff1a\n$$\ng(x) = \\sum_i^n(\\lfloor \\frac{n}{i} \\rfloor \\times i) \n$$\n\u56e0\u4e3a $k$ \u7684\u53d6\u503c\u4e0d\u8d85\u8fc7 $\\sqrt{n}$ \u6240\u4ee5\u590d\u6742\u5ea6\u4e3a $O(\\sqrt{n})$ \u3002\n\u6240\u4ee5 $f(x) = x^2-g(x)$ \uff0c\u5219\uff1a\n$$\nans_1=f(n)\\times f(m) = n^2m^2-n^2g(m)-m^2g(n)+g(n)g(m)\n$$\n\u73b0\u5728\u8003\u8651 $ans_2$ :\n$$\nans_2=(n^2 m-m\\times g(n)-n \\times g(m) +\\sum_i^n\\lfloor \\frac{n}{i} \\rfloor\\lfloor \\frac{m}{i} \\rfloor\\times i^2)\n$$\n\u7531\u4e8e \n$$\n\\sum_i^ni^2=\\frac{n(2n+1)(n+1)}{6}\n$$\n\u6240\u4ee5 \n$\n\\sum_i^n\\lfloor \\frac{n}{i} \\rfloor\\lfloor \\frac{m}{i} \\rfloor\\times i^2 \n$\n\u53ef\u4ee5\u5728 $O(\\sqrt{n})$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u6c42\u51fa\u6765\u3002\n$$\nans=n^2m^2-n^2g(m)-m^2g(n)+g(n)g(m)-(n^2 m-m\\times g(n)-n \\times g(m) +\\sum_i^n\\lfloor \\frac{n}{i} \\rfloor\\lfloor \\frac{m}{i} \\rfloor\\times i^2)\n$$\n## \u4ee3\u7801\n\u56e0\u4e3a\u53d6\u6a21\u6302\u4e86\uff0c\u76f4\u63a5__int128\uff0c\u5982\u6709\u5927\u4f6c\u53d1\u73b0\u662f\u54ea\u91cc\u6302\u4e86\uff0c\u6c42\u89e3\u3002\n```cpp\n#include<bits/stdc++.h>\n#define int __int128\nusing namespace std;\nconst int mod = 1000000007;\ninline int read()\n{\n    int x=0,f=1;\n    char ch=getchar();\n    while(ch<'0'||ch>'9')\n    {\n        if(ch=='-')\n            f=-1;\n        ch=getchar();\n    }\n    while(ch>='0'&&ch<='9')\n    {\n        x=x*10+ch-'0';\n        ch=getchar();\n    }\n    return x*f;\n}\n\ninline void write(int x)\n{\n    if(x<0)\n    {\n        putchar('-');\n        x=-x;\n    }\n    if(x>9)\n        write(x/10);\n    putchar(x%10+'0');\n}\nvoid exgcd(int a,int b,int &x,int &y)\n{\n\tif(b == 0){x = 1;y = 0;return;}\n\texgcd(b,a%b,x,y);\n\tint k = x;\n\tx = y;\n\ty = k - a/b*x;\n}\nint inv2,inv6,n,m,xzc,ans1,ans2,ans;\nint sum2(int x)\n{\n\treturn x%mod*(2*x+1)%mod*(x+1)%mod*inv6%mod;\n}\nint sum1(int x)\n{\n\treturn (x*(x+1))%mod*inv2%mod;\n}\nint solve(int n)\n{\n\tint ans = 1LL*n*n % mod;\n\tfor(int l = 1,r;l <= n;l=r+1)\n\t{\n\t\tr = n/(n/l);\n\t\tans = (ans-(sum1(r)-sum1(l-1))*(n/l)+mod)%mod;\n\t}\n\treturn ans;\n}\nsigned main()\n{\n\texgcd(2,mod,inv2,xzc);\n\texgcd(6,mod,inv6,xzc);\n\tn = read();m = read();\n\tif(n>m) swap(n,m);\n\tans1 = solve(n) * solve(m) % mod;\n\tans2 = 1LL*n*m*n%mod;\n\tfor(int l = 1,r;l<=n;l=r+1)\n\t{\n\t\tr = min(n/(n/l),m/(m/l));\n\t\tans2 = (ans2-((sum1(r)-sum1(l-1)+mod)%mod*(((n/l)*m +(m/l)*n)+mod)%mod+mod)%mod+mod)%mod;\n\t\tans2 = (ans2+1LL*(sum2(r)-sum2(l-1)+mod)%mod*(n/l)%mod*(m/l)%mod+mod) % mod;\n\t}\n\tans = ans1-ans2;\n\tans = (ans+mod)%mod;\n\twrite(ans);\n}\n```\n[\u535a\u5ba2\u5730\u5740](https://www.luogu.com.cn/blog/xzc/solution-p2834)",
        "postTime": 1590669521,
        "uid": 227824,
        "name": "JK_LOVER",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2834 \u3010\u80fd\u529b\u6d4b\u9a8c\u3011"
    },
    {
        "content": "\u9898\u610f\uff1a\u7ed9\u5b9a $n,m$\uff0c\u9700\u8981\u5728 $O(\\sqrt n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u6c42\u5f97\u4e0b\u9762\u5f0f\u5b50\u7684\u503c\uff1a\n\n$$\\sum_{i=1}^n \\sum_{j=1}^m (n \\bmod i)(m \\bmod j)[i \u2260j]$$\n\n\u9996\u5148\u7b80\u5355\u5bb9\u65a5\uff0c\u5047\u8bbe $n<m$\uff0c\u53ef\u4ee5\u5c06\u5f0f\u5b50\u5316\u4e3a\u4e0b\u9762\u7684\u6837\u5b50:\n\n$$\\sum_{i=1}^n \\sum_{j=1}^m (n \\bmod i)(m \\bmod j)-\\sum_{i=1}^{n}(n \\bmod i)(m \\bmod i)$$\n\n\u4e24\u4e2a\u5f0f\u5b50\u4e0d\u76f8\u5173\uff0c\u8003\u8651\u5206\u522b\u8ba1\u7b97\u3002\u5de6\u8fb9\u4e00\u5f0f\u957f\u5f97\u4e0d\u597d\u770b\uff0c\u9996\u5148\u5c06 $(n \\bmod i) $ \u4e00\u9879\u79fb\u51fa\u6765\u3002\u539f\u5f0f\u5316\u4e3a\uff1a\n\n$$\\sum_{i=1}^n (n \\bmod i) \\sum_{j=1}^m (m \\bmod j)$$\n\n\u6839\u636e\u53d6\u6a21\u7684\u5b9a\u4e49\u5f97\u5230\uff1a\n\n$$\\sum_{i=1}^n (n-i\\times \\lfloor \\dfrac{n}{i} \\rfloor) \\times \\sum_{i=1}^m (m-i\\times \\lfloor \\dfrac{m}{i} \\rfloor)$$\n\n\u53c8\u5c06 $n$ \u548c $m$ \u63d0\u51fa\u6765\uff1a\n\n$$(n^2 - \\sum_{i=1}^n i\\times \\lfloor \\dfrac{n}{i} \\rfloor) \\times (m^2 -\\sum_{i=1}^mi\\times \\lfloor \\dfrac{m}{i} \\rfloor)$$\n\n\u6709\u6574\u9664\u5206\u5757\u7684\u6837\u5b50\u4e86\u3002\n\n---\n\u8003\u8651\u6574\u7406\u53f3\u8fb9\u7684\u5f0f\u5b50\u3002\u6839\u636e\u5b9a\u4e49\u5f0f\u5c06\u5176\u5316\u4e3a\uff1a\n\n$$\\sum_{i=1}^n(nm-m\\times i\\times \\lfloor \\dfrac{n}{i} \\rfloor - n \\times i \\times \\lfloor \\dfrac{m}{i} \\rfloor + \\lfloor \\dfrac{n}{i} \\rfloor \\times \\lfloor \\dfrac{m}{i} \\rfloor \\times i^2)$$\n\n\u4e5f\u662f\u6574\u9664\u5206\u5757\u7684\u6837\u5b50\u3002\u63a5\u4e0b\u6765\u8003\u8651\u7684\u662f $\\sum_{i=1}^n i^2$ \u600e\u4e48\u7b97\u3002\n\n\u4ece\u4e09\u6b21\u65b9\u5165\u624b\u5f00\u59cb\u964d\u6b21\u3002\u5199\u51fa $(n+1)^3-n^3=3n^2+3n+1$\u3002\u540c\u7406\u53ef\u5f97 $n^3-(n-1)^3=3(n-1)^2+3(n-1)+1$\u3002\u7ee7\u7eed\u5199\u4e0b\u53bb\uff0c\u4f1a\u5f97\u5230 $2^3-1^3=3\\times 1^3+3\\times 1+1$\u3002\u5c06\u8fd9 $n$ \u4e2a\u5f0f\u5b50\u52a0\u8d77\u6765\uff0c\u5f97\u5230 $(n+1)^3-1=3 \\times (\\sum_{i=1}^n i^2)+3\\times (\\sum_{i=1}^n i)$\u3002\n\n\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86 $\\sum_{i=1}^n i=\\dfrac{i \\times (i+1)}{2}$\uff0c\u79fb\u9879\u5f97\u5230 $\\sum_{i=1}^n i^2=\\dfrac{n \\times(n+1 \\times (2n+1))}{6}$\u3002\n\n\u6700\u540e\u5904\u7406\u51fa $2,6$ \u7684\u9006\u5143\u3002\u8fd9\u9053\u9898\u5c31\u89e3\u51b3\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef __int128 LL;\nchar buf[1<<21],*p1=buf,*p2=buf;\n#define getchar() (p1==p2 && (p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\nLL read()\n{\n\tLL x=0,f=1;\n\tchar c=getchar();\n\twhile(c<'0' || c>'9')\n\t{\n\t\tif(c=='-')\tf=-1;\n\t\tc=getchar();\n\t}\n\twhile(c>='0' && c<='9')\tx=(x<<1)+(x<<3)+(c^'0'),c=getchar();\n\treturn x*f;\n}\nvoid write(LL x)\n{\n\tif(x<0)\tputchar('-'),x=-x;\n\tif(x>9)\twrite(x/10);\n\tputchar(x%10+'0');\n}\nconst LL MOD=19940417,inv2=9970209,inv6=3323403;\nLL line(LL p){return p*(p+1)/2;}\nLL square(LL p){return p*(p+1)*(2*p+1)/6;}\nLL n,m;\nint main(){\n\tn=read(),m=read();\n\tif(n>m)\tn^=m^=n^=m;\n\tLL a=0;\n\tfor(LL l=1,r;l<=n;l=r+1)\n\t{\n\t\tr=n/(n/l);\n\t\ta+=(n/l)*(line(r)-line(l-1));\n\t}\n\ta=n*n-a;\n\tLL b=0;\n\tfor(LL l=1,r;l<=m;l=r+1)\n\t{\n\t\tr=m/(m/l);\n\t\tb+=(m/l)*(line(r)-line(l-1));\n\t}\n\tb=m*m-b;\n\tLL c=n*m*n;\n\tLL k=0;\n\tfor(LL l=1,r;l<=n;l=r+1)\n\t{\n\t\tr=min(n/(n/l),m/(m/l));\n\t\tr=min(r,n);\n\t\tk+=(n/l)*(line(r)-line(l-1));\n\t}\n\tc-=k*m;\n\tk=0;\n\tfor(LL l=1,r;l<=n;l=r+1)\n\t{\n\t\tr=min(n/(n/l),m/(m/l));\n\t\tr=min(r,n);\n\t\tk+=(m/l)*(line(r)-line(l-1));\n\t}\n\tc-=k*n;\n\tk=0;\n\tfor(LL l=1,r;l<=n;l=r+1)\n\t{\n\t\tr=min(n/(n/l),m/(m/l));\n\t\tr=min(r,n);\n\t\tk+=(n/l)*(m/l)*(square(r)-square(l-1));\n\t}\n\tc+=k;\n\tLL res=a*b-c;\n\tres%=MOD;\n\tres+=MOD;\n\tres%=MOD;\n\twrite(res);\n\treturn 0;\n}\n```",
        "postTime": 1595406984,
        "uid": 184977,
        "name": "pomelo_nene",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2260 \u3010[\u6e05\u534e\u96c6\u8bad2012]\u6a21\u79ef\u548c\u3011"
    },
    {
        "content": "\u534a\u4e2a\u6708\u524d\u5c31\u60f3\u505a\u8fd9\u9898\u4e86\uff08\u4eca\u5929AC\u6765\u6c34\u4e2a\u9898\u89e3\u3002\n\n---\n\n\u9ed8\u8ba4 $n\\le m,a/b=\\lfloor\\frac{a}{b}\\rfloor$\n\n\u6709\u4eba\u95ee\u6211\u4e3a\u4ec0\u4e48\u53ef\u4ee5\u9ed8\u8ba4 $n\\le m$ \uff0c\u5176\u5b9e\u5c31\u662f\u4e3a\u4e86\u4e00\u822c\u6027\uff0c\u5728\u7a0b\u5e8f\u4e2d\u53ea\u8981\u4f53\u73b0\u6210 \u5f53 $n>m$ \u5c31 `swap(n,m)` \u5c31\u884c\u3002\uff08\u5176\u5b9e\u662f\u4e3a\u4e86\u5c11\u5199 $\\min(n,m)$\n\n\u9996\u5148\u6709\n\n$a\\bmod b=a-b(a/b)$\n\n\u8003\u8651\u5bb9\u65a5\n\n$$\\sum_{i=1}^{n}(n \\bmod i)\\sum_{j=1}^{m}(m\\bmod j)-\\sum_{i=1}^{n}(n\\bmod i)(m\\bmod i)$$\n\n\u7136\u540e\u8bbe\n\n$$f(n,x)=\\sum_{i=1}^{n}i(x/i)$$\n\n\u5219 \n$$\\sum_{i=1}^{n}(n\\bmod i)=\\sum_{i=1}^{n}n-i(n/i)=n^2-\\sum_{i=1}^{n}i(n/i)$$\n\n\u8fd9\u6837\u7684\u5f0f\u5b50\u53ef\u4ee5\u7528\u7c7b\u4f3c\u6c42\u6cd5\u3002\n\n\u8fd9\u4e2a\u548c\u4f59\u6570\u6c42\u548c\u90a3\u9898\u6bd4\u8f83\u50cf\uff0c\u53ef\u4ee5\u6570\u8bba\u5206\u5757 $O(\\sqrt n)$\uff0cso\n\n$$\u539f\u5f0f=(n^2-f(n,n))(m^2-f(m,m))-\\sum_{i=1}^{n}(n\\bmod i)(m\\bmod i)$$\n\n$$=(n^2-f(n,n))(m^2-f(m,m))-\\sum_{i=1}^{n}(n-i(n/i))(m-i(m/i))$$\n\n\u8003\u8651\u63a8\u5012\u5bb9\u65a5\u7684\u90e8\u5206\n\n$$\\sum_{i=1}^{n}(n-i(n/i))m-(n-i(n/i))i(m/i)$$\n$$=\\sum_{i=1}^{n}nm-mi(n/i)-ni(m/i)+i^2(n/i)(m/i)$$\n$$=n^2m-m\\sum_{i=1}^{n}i(n/i)-n\\sum_{i=1}^{n}i(m/i)+\\sum_{i=1}^{n}i^2(n/i)(m/i)$$\n\n$$=n^2m-mf(n,n)-nf(n,m)+\\sum_{i=1}^{n}i^2(n/i)(m/i)$$\n\n\u53d1\u73b0\u6700\u540e\u4e00\u4e2a sigma \u8fd8\u662f\u53ef\u4ee5\u6570\u8bba\u5206\u5757 $O(\\sqrt n)$ \u6c42\u3002\n\nso \u9884\u5904\u7406 $f(n,n),f(n,m),f(m,m)$ \u548c \u4e0a\u9762\u7684\u4e1c\u897f\uff0c\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u6700\u7ec8\u590d\u6742\u5ea6$O(\\sqrt n)$\n\n$Code:$\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\nusing namespace std;\ntypedef long long ll;\nconst ll P=19940417;\ninline ll read(){\n\tregister ll x=0,f=0,ch=getchar();\n\twhile('0'>ch||ch>'9')f^=ch=='-',ch=getchar();\n\twhile('0'<=ch&&ch<='9')x=(x<<1)+(x<<3)+(ch^'0'),ch=getchar();\n\treturn f?-x:x;\n}\ninline ll sum0(ll l,ll r){\n\treturn 1LL*(r-l+1)*(l+r)%P*9970209%P;\n}\ninline ll sum(ll x){\n\tx%=P;\n\treturn (1LL*x*(x+1)%P*((x+x)%P+1)%P*3323403%P)%P;\n}\ninline ll solve(ll t,ll x){\n\tregister ll res=0;\n\tfor(register int l=1,r;l<=t;l=r+1){\n\t\tif(x/l==0)r=t;\n\t\telse r=min(x/(x/l),t);\n\t\tres+=1LL*sum0(l,r)*(x/l)%P;\n\t\tres%=P;\n\t}\t\n\treturn res%P;\n}\nll a,b,c;\nll n,m,f1,f2,f3,f4,ans;\ninline void solved(){\n\tfor(register int l=1,r;l<=n;l=r+1){\n\t\tr=min(n/(n/l),m/(m/l));\n\t\tf4+=1LL*(sum(r)%P-sum(l-1)%P+P)%P*(n/l)%P*(m/l)%P;\n\t\tf4%=P;\n\t}\n}\nsigned main(){\n\tn=read(),m=read();\n\tif(n>m)n^=m^=n^=m;\n\tf1=solve(n,n);\n\tf2=solve(n,m);\n\tf3=solve(m,m);\n\tsolved();\n\tans=1LL*(1LL*n*n%P-f1+P)%P*(1LL*m*m%P-f3+P)%P;\n\tans-=1LL*(1LL*n*n%P*m%P-(1LL*m*f1%P)-(1LL*n*f2%P)+f4)%P;\n\tans=(ans+P)%P;\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n\n```",
        "postTime": 1589544794,
        "uid": 119062,
        "name": "Lates",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2260 \u3010[\u6e05\u534e\u96c6\u8bad2012]\u6a21\u79ef\u548c\u3011"
    },
    {
        "content": "### \u524d\u8a00\n\n\u6ca1\u60f3\u5230\u6e05\u534e\u96c6\u8bad\u4e5f\u6709\u53ef\u505a\u9898\uff0c\u800c\u4e14\u8fd8\u633a\u65e0\u8111\u2026\u2026\n\n[P2260 [\u6e05\u534e\u96c6\u8bad2012]\u6a21\u79ef\u548c](https://www.luogu.com.cn/problem/P2260)\u3002\n\n---\n\n### \u6b63\u6587\n\n\u6c42\u7684\u662f\u8fd9\u6837\u4e00\u4e2a\u5f0f\u5b50\uff1a\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m(n\\operatorname{mod}i)(m\\operatorname{mod}j),i\u2260j$$\n\n\u663e\u7136\u5982\u679c\u6ca1\u6709 $i\u2260j$ \u4f1a\u5f88\u597d\u505a\u3002\u6240\u4ee5\u6211\u4eec\u8003\u8651\u5927\u529b\u5206\u7c7b\u8ba8\u8bba\u3002\n\n$$ys=\\sum_{i=1}^n\\sum_{j=1}^m(n\\operatorname{mod}i)(m\\operatorname{mod}j)-\\sum_{i=1}^{\\min(n,m)}(n\\operatorname{mod}i)(m\\operatorname{mod}i)$$\n\n\u7136\u540e\u6211\u4eec\u5206\u5f00\u6765\u770b\uff0c\u6211\u4eec\u5047\u8bbe\uff1a\n\n$$x=\\sum_{i=1}^n\\sum_{j=1}^m(n\\operatorname{mod}i)(m\\operatorname{mod}j)$$\n\n$$y=\\sum_{i=1}^{\\min(n,m)}(n\\operatorname{mod}i)(m\\operatorname{mod}j)$$\n\n\u90a3\u4e48\u539f\u5f0f\u5c31\u53ef\u4ee5\u8868\u793a\u6210 $ys=x-y$\u3002\u6211\u4eec\u5206\u89e3\u5f00\u6765\u5bf9 $x$ \u548c $y$ \u53bb\u5206\u6790\u4e00\u6ce2\u3002\n\n$$x=\\sum_{i=1}^n(n\\operatorname{mod}i)\\sum_{j=1}^m(m\\operatorname{mod}j)$$\n\u770b\u5230\u53d6\u6a21\u6709\u5e38\u89c4\u64cd\u4f5c $a\\operatorname{mod}b=a-b\\times\\lfloor\\frac{a}{b}\\rfloor$\u3002\u6240\u4ee5\u6211\u4eec\u628a\u8fd9\u4e2a\u5f0f\u5b50\u5f80\u4e0a\u9762\u56de\u4ee3\uff1a\n\n$$x=\\sum_{i=1}^n(n-\\lfloor\\frac{n}{i}\\rfloor\\times i)\\sum_{j=1}^m(m-\\lfloor\\frac{m}{j}\\rfloor\\times j)$$\n\n\u5bf9\u4e8e\u8fd9\u4e2a\u5f0f\u5b50\u6709\u4e2a\u6bd4\u8f83\u597d\u7684\u5904\u7406\u65b9\u6cd5\u3002\u56e0\u4e3a\u8fd9\u4e24\u90e8\u5206\u770b\u8d77\u6765\u975e\u5e38\u76f8\u4f3c\u6240\u4ee5\u6211\u4eec\u8bbe\uff1a\n\n$$p(x)=\\sum_{i=1}^x(x-\\lfloor\\frac{x}{i}\\rfloor\\times i)$$\n\n\u663e\u7136\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$x=p(n)p(m)$$\n\n\u7136\u540e\u6211\u4eec\u5bf9\u8fd9\u4e2a $p(x)$ \u8fdb\u884c\u5316\u7b80\uff1a\n\n$$p(x)=x^2-\\sum_{i=1}^x(\\lfloor\\frac{x}{i}\\rfloor\\times i)$$\n\n\u540e\u9762\u90a3\u4e2a\u5f0f\u5b50\u597d\u50cf\u5728 [\u8fd9\u91cc](https://www.luogu.com.cn/problem/P2261) \u89c1\u8fc7\uff0c\u6240\u4ee5\u6211\u4eec\u8bbe\uff1a\n\n$$l(x,k)=\\sum_{i=1}^x(\\lfloor\\frac{k}{i}\\rfloor\\times i)$$\n\n\u8fd9\u4e2a $l$ \u5c31\u53ef\u4ee5\u7528\u6574\u9664\u5206\u5757\u6c42\u89e3\u3002\u7136\u540e\u6211\u4eec\u628a\u4ed6\u56de\u4ee3\uff1a\n\n$$p(x)=x^2\\times l(x,x)$$\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u628a\u524d\u9762\u534a\u90e8\u5206\u641e\u5b9a\u4e86\uff0c\u63a5\u4e0b\u6765\u641e\u540e\u534a\u90e8\u5206\uff0c\n\n$$y=\\sum_{i=1}^{\\min(n,m)}(n\\operatorname{mod}i)(m\\operatorname{mod}i)$$\n\n\u540c\u6837\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u628a $\\operatorname{mod}$ \u5316\u51fa\u6765\uff1a\n\n$$y=\\sum_{i=1}^{\\min(n,m)}(n-\\lfloor\\frac{n}{i}\\rfloor\\times i)(m-\\lfloor\\frac{m}{i}\\rfloor\\times i)$$\n\n\u7136\u540e\u628a\u8fd9\u4e2a\u62ec\u53f7\u6253\u5f00\uff1a\n\n$$y=\\sum_{i=1}^{\\min(n,m)}(nm-\\lfloor\\frac{n}{i}\\rfloor\\times i\\times m-\\lfloor\\frac{m}{i}\\rfloor\\times i\\times n-\\lfloor\\frac{n}{i}\\rfloor\\times\\lfloor\\frac{m}{i}\\rfloor\\times i^2)$$\n\n\u8fd9\u4e2a\u65f6\u5019\u628a $\\sum$ \u62c6\u5f00\u662f\u4e2a\u6bd4\u8f83\u597d\u7684\u9009\u62e9\u3002\u5982\u679c\u4ecd\u7136\u4fdd\u7559\u7740 $\\min$ \u4f1a\u5f88\u96be\u53d7\uff0c\u6240\u4ee5\u6211\u4eec\u8bbe $n=\\min(n,m)$\u3002\n\n$$y=n^2m-m\\sum_{i=1}^n(\\lfloor\\frac{n}{i}\\rfloor\\times i)-n\\sum_{i=1}^n(\\lfloor\\frac{m}{i}\\rfloor\\times i)-\\sum_{i=1}^n(i^2\\times\\lfloor\\frac{n}{i}\\rfloor\\times\\lfloor\\frac{m}{i}\\rfloor)$$\n\n\u4f60\u4f1a\u53d1\u73b0\u524d\u9762\u4e24\u4e2a\u5f0f\u5b50\u6211\u4eec\u66fe\u7ecf\u5b9a\u4e49\u8fc7\uff0c\u76f4\u63a5\u4f7f\u7528\u5c31\u884c\uff1a\n\n$$y=n^2m-m\\times l(n,n)-n\\times l(n,m)-\\sum_{i=1}^n(i^2\\times \\lfloor\\frac{n}{i}\\rfloor\\times\\lfloor\\frac{m}{i}\\rfloor)$$\n\n\u7136\u540e\u9664\u6389 $n^2m$ \u53ef\u4ee5\u7528 $\\Theta(1)$ \u6c42\u51fa\uff0c\u524d\u9762\u540e\u9762\u90fd\u53ef\u4ee5\u7528\u6574\u9664\u5206\u5757\u89e3\u51b3\u3002\u5e76\u4e14\u6211\u4eec\u6709\uff1a\n\n$$\\sum_{i=1}^ni^2=\\frac{n\\times(n+1)\\times(2n+1)}{6}$$\n\n\u6240\u4ee5\u6211\u4eec\u628a $x,y$ \u5408\u5e76\u4e00\u4e0b\uff1a\n\n$$ys=n^2m^2\\times l(n,n)\\times l(m,m)-n^2m+m\\times l(n,n)+n\\times l(n,m)+\\sum_{i=1}^n(i^2\\times \\lfloor\\frac{n}{i}\\rfloor\\times\\lfloor\\frac{m}{i}\\rfloor)$$\n\n\u518d\u5904\u7406\u4e00\u4e0b\u5c31\u53ef\u4ee5\u6574\u9664\u5206\u5757\u89e3\u51b3\u4e86\u3002\n\n\u5904\u7406\u7ec6\u8282\u4e5f\u662f\u6709\u7684\uff0c\u6bd4\u5982\u8fd9\u4e2a\u6a21\u6570\u4e0d\u662f\u7d20\u6570\uff0c\u6240\u4ee5\u8981\u7528 $\\text{ksm}$ \u9884\u5904\u7406\u4e00\u4e0b $2$\uff08\u7528\u4e8e\u6574\u9664\u5206\u5757\uff09\u548c $6$\uff08\u7528\u4e8e\u533a\u95f4\u5e73\u65b9\u548c\uff09\u7684\u9006\u5143\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u6109\u5feb\u7684\u628a\u8fd9\u9898\u5207\u4e86\u3002\n\n---\n\n### \u53c2\u8003\u6587\u732e\n\n[command_block \u6574\u9664\u5206\u5757\u5165\u95e8\u5c0f\u8bb0](https://www.luogu.com.cn/blog/command-block/zheng-chu-fen-kuai-ru-men-xiao-ji)",
        "postTime": 1587562148,
        "uid": 143271,
        "name": "HohleFeuerwerke",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2260 \u3010[\u6e05\u534e\u96c6\u8bad2012]\u6a21\u79ef\u548c\u3011"
    },
    {
        "content": "\u4f60\u8c37\u4e0d\u8d44\u74f7\u516c\u5f0f\u5757\uff0c\u5dee\u8bc4\n\n\u76f4\u63a5\u7ed9\u56fe\u7247\n\n![TIM\u622a\u56fe20181231222419.png](https://i.loli.net/2018/12/31/5c2a26d1a9f2b.png)\n\n\u5b9e\u5728\u770b\u4e0d\u60ef\u8fd9\u56fe\u7247\u7684\u53ef\u4ee5\u5230\u6211\u7684[\u535a\u5ba2\u56ed\u7684blogs](https://www.cnblogs.com/henry-1202/p/10201032.html)\u770b\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define ll long long\n#define N 2010\n#define mod 19940417\nconst ll m6 = 3323403;\nll n, m;\nll ans = 0;\n\nll sum(ll l, ll r) {\n    return (r - l + 1) * (l + r) / 2 % mod;\n}\n\nll calc(ll k) {\n    ll ans = k * k % mod;\n    for(int l = 1, r; l <= k; l = r + 1) {\n        r = k / (k / l);\n        ans = ((ans - sum(l, r) * (k / l) % mod) % mod + mod) % mod; \n    } \n    return ans;\n}\n\nll cal(ll x) {\n    return x * (x + 1) % mod * (2 * x + 1) % mod * m6 % mod;\n}\n\nll sum2(ll l, ll r) {\n    return (cal(r) - cal(l - 1) + mod) % mod;\n} \n\nint main() {\n    scanf(\"%lld%lld\", &n, &m);\n    if(n > m) swap(n, m);\n    ans = calc(n) * calc(m) % mod;\n    ans = ((ans - n * n % mod * m % mod) % mod + mod) % mod; \n    for(int l = 1, r; l <= n; l = r + 1) {\n        r = min(n / (n / l), m / (m / l));\n        ans = (ans + sum(l, r) * ((n/l)*m % mod + (m/l)*n % mod) % mod % mod);\n        ans = (ans - sum2(l, r) * (n/l) % mod * (m/l) % mod + mod) % mod;\n    }\n    printf(\"%lld\\n\", (ans % mod + mod) % mod);\n    return 0;\n}\n```",
        "postTime": 1546266364,
        "uid": 36526,
        "name": "henry_y",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2260 \u3010[\u6e05\u534e\u96c6\u8bad2012]\u6a21\u79ef\u548c\u3011"
    },
    {
        "content": "\u8bdd\u8bf4\u8fd9\u9053\u9898\u4e0e[P2260](https://www.luogu.org/problemnew/show/P2260#sub)\n\u4e00\u6837\u554a\uff0c\u53ea\u662f\u6a21\u6570\u4e0d\u4e00\u6837\u3002\n\n\u4e5f\u662f[P2261](https://www.luogu.org/problemnew/show/P2261)\u7684\u5347\u7ea7\u7248\uff0c\u4e09\u500d\u7ecf\u9a8c\u6536\u4e0b\u4e86\u3002\n\n\u8fd9\u9053\u9898\u6211\u7684\u89e3\u6cd5\u6765\u81ea2261\u7684\u5206\u5757\u9898\u89e3\uff0c\u8dd1\u5f97\u4e0d\u6bd4\u53cd\u6f14\u6162\u3002\n\n$ans=\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{m}(n\\mod i)\\times (m\\mod j)(i!=j)$\n\n\u6839\u636e\u5bb9\u65a5\uff0c$ans=\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{m}(n\\mod i)\\times (m\\mod j)-\\sum\\limits_{i=1}^{min(n,m)}(n\\mod i)\\times (m\\mod i)$\n\n\u8fd9\u6837\u6211\u4eec\u53d1\u73b0\u5c31\u662f\u4e24\u4e2aP2260\u7d2f\u4e58\u518d\u51cf\u53bb\u4e00\u4e2a\u503c\u3002\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5206\u6210\u4e24\u5757\u4e86\n\n$n\\mod i=n-[n/i]$\n\n$\\sum\\limits_{i=1}^{n}(n\\mod i)=\\sum\\limits_{i=1}^{n}[n/i]\\times i=n^2-\\sum\\limits_{i=1}^{n}[n/i]*i$\n\n$m$ \u4e5f\u662f\u540c\u7406\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5957\u5206\u5757\u4e86\uff0c\u73b0\u5728\u8003\u8651\n\n\n$\\sum\\limits_{i=1}^{min(n,m)}(n\\mod i)\\times (m\\mod i)$\n\n$\\sum\\limits_{i=1}^{min(n,m)}(n-[n/i])\\times (m-[m/i])$\n\n\u62c6\u5f00\u62ec\u53f7\n\n$\\sum\\limits_{i=1}^{min(n,m)}(n\\times m-i\\times (m\\times [n/i]+n\\times [m/i])+[n/i]\\times [m/i]*i^2)$\n\n\u5176\u4ed6\u8fd8\u597d\uff0c$\\sum\\limits_{i=1}^{min(n,m)}i^2$\u600e\u4e48\u6c42\uff1f\n\n\u5176\u5b9e\u6709\u4e00\u4e2a\u516c\u5f0f\uff1a$\\sum\\limits_{i=1}^{n}i^2=n\\times (n+1)\\times (2n+1)/6$\n\n\u4e5f\u5bb9\u6613\u8bc1\u660e\n\n\u6211\u4eec\u5148\u8ba1\u7b97\u5f97\u5f53 $n=1,2$ \u65f6\u7b49\u5f0f\u6210\u7acb\u3002\n\n\u518d\u5047\u8bbe\u5f53 $n=x$ \u65f6\u7b49\u5f0f\u6210\u7acb\u3002\n\n\u5373 $1^2+2^2+3^3+...+x^2=x\\times (x+1)\\times (2x+1)/6$\n\n\u6211\u4eec\u518d\u8003\u8651 $x+1$\n\n$1^2+2^2+3^3+...+x^2+(x+1)^2$\n\n$=x\\times (x+1)\\times (2x+1)/6+(x+1)^2$\n\n$=(x+1)\\times (2x^2+x+6x+6)/6$\n\n$=(x+1)\\times (2x^2+7x+6)/6$\n\n$=(x+1)\\times (2x+3)\\times (x+2)/6$\n\n\u4ed4\u7ec6\u89c2\u5bdf\uff0c\u8fd9\u4e0d\u5c31\u662f $n=x+1$ \u65f6\uff0c\u516c\u5f0f\u7684\u60c5\u51b5\u5417\uff1f\n\n\u5982\u679c\u8fd9\u6837\u9012\u63a8\u4e0b\u53bb\uff0c\u53d1\u73b0\u5f53 $n$ \u4e3a\u6b63\u6574\u6570\u65f6\u7b49\u5f0f\u6210\u7acb\uff0c\u8fd9\u5c31\u662f\u6570\u5b66\u5f52\u7eb3\u6cd5\n\n\u6240\u4ee5\u5c31\u53ef\u4ee5 $O(1)$ \u7b97\u4e86\u3002\n\n\u4f46\u662f\u8fd8\u6709\u4e00\u4e2a\u5730\u65b9\uff0c\u516c\u5f0f\u9664 $6$ \u662f\u4e0d\u80fd\u76f4\u63a5\u7b97\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u7528\u5feb\u901f\u5e42\u6216\u6269\u6b27\u6c42\u4e00\u4e0b\u9006\u5143\u5c31\u597d\u4e86\u3002\n\n\u81f3\u4e8e\u4ee3\u7801\uff0c\u56e0\u4e3a\u592a\u4e11\u6211\u5c31\u4e0d\u53d1\u4e86\uff0c\u57fa\u672c\u4e0a\u5c31\u662f\u88f8\u7684\u5206\u5757\u4e86\uff0c\u5c31\u51e0\u4e2a\u8fd9\u79cdfor\u5faa\u73af\n```\nfor(long long i=1,j;i<=min(n,m);i=j+1)\n```\n",
        "postTime": 1540424558,
        "uid": 57026,
        "name": "\u9648\u66e6",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2834 \u3010\u80fd\u529b\u6d4b\u9a8c\u3011"
    },
    {
        "content": "\u9898\u610f\uff1a\u7ed9\u5b9a $n,m$\uff0c\u9700\u8981\u5728 $O(\\sqrt n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u6c42\u5f97\u4e0b\u9762\u5f0f\u5b50\u7684\u503c\uff1a\n\n$$\\sum_{i=1}^n \\sum_{j=1}^m (n \\bmod i)(m \\bmod j)[i \u2260j]$$\n\n\u9996\u5148\u7b80\u5355\u5bb9\u65a5\uff0c\u5047\u8bbe $n<m$\uff0c\u53ef\u4ee5\u5c06\u5f0f\u5b50\u5316\u4e3a\u4e0b\u9762\u7684\u6837\u5b50:\n\n$$\\sum_{i=1}^n \\sum_{j=1}^m (n \\bmod i)(m \\bmod j)-\\sum_{i=1}^{n}(n \\bmod i)(m \\bmod i)$$\n\n\u4e24\u4e2a\u5f0f\u5b50\u4e0d\u76f8\u5173\uff0c\u8003\u8651\u5206\u522b\u8ba1\u7b97\u3002\u5de6\u8fb9\u4e00\u5f0f\u957f\u5f97\u4e0d\u597d\u770b\uff0c\u9996\u5148\u5c06 $(n \\bmod i) $ \u4e00\u9879\u79fb\u51fa\u6765\u3002\u539f\u5f0f\u5316\u4e3a\uff1a\n\n$$\\sum_{i=1}^n (n \\bmod i) \\sum_{j=1}^m (m \\bmod j)$$\n\n\u6839\u636e\u53d6\u6a21\u7684\u5b9a\u4e49\u5f97\u5230\uff1a\n\n$$\\sum_{i=1}^n (n-i\\times \\lfloor \\dfrac{n}{i} \\rfloor) \\times \\sum_{i=1}^m (m-i\\times \\lfloor \\dfrac{m}{i} \\rfloor)$$\n\n\u53c8\u5c06 $n$ \u548c $m$ \u63d0\u51fa\u6765\uff1a\n\n$$(n^2 - \\sum_{i=1}^n i\\times \\lfloor \\dfrac{n}{i} \\rfloor) \\times (m^2 -\\sum_{i=1}^mi\\times \\lfloor \\dfrac{m}{i} \\rfloor)$$\n\n\u6709\u6574\u9664\u5206\u5757\u7684\u6837\u5b50\u4e86\u3002\n\n---\n\u8003\u8651\u6574\u7406\u53f3\u8fb9\u7684\u5f0f\u5b50\u3002\u6839\u636e\u5b9a\u4e49\u5f0f\u5c06\u5176\u5316\u4e3a\uff1a\n\n$$\\sum_{i=1}^n(nm-m\\times i\\times \\lfloor \\dfrac{n}{i} \\rfloor - n \\times i \\times \\lfloor \\dfrac{m}{i} \\rfloor + \\lfloor \\dfrac{n}{i} \\rfloor \\times \\lfloor \\dfrac{m}{i} \\rfloor \\times i^2)$$\n\n\u4e5f\u662f\u6574\u9664\u5206\u5757\u7684\u6837\u5b50\u3002\u63a5\u4e0b\u6765\u8003\u8651\u7684\u662f $\\sum_{i=1}^n i^2$ \u600e\u4e48\u7b97\u3002\n\n\u4ece\u4e09\u6b21\u65b9\u5165\u624b\u5f00\u59cb\u964d\u6b21\u3002\u5199\u51fa $(n+1)^3-n^3=3n^2+3n+1$\u3002\u540c\u7406\u53ef\u5f97 $n^3-(n-1)^3=3(n-1)^2+3(n-1)+1$\u3002\u7ee7\u7eed\u5199\u4e0b\u53bb\uff0c\u4f1a\u5f97\u5230 $2^3-1^3=3\\times 1^3+3\\times 1+1$\u3002\u5c06\u8fd9 $n$ \u4e2a\u5f0f\u5b50\u52a0\u8d77\u6765\uff0c\u5f97\u5230 $(n+1)^3-1=3 \\times (\\sum_{i=1}^n i^2)+3\\times (\\sum_{i=1}^n i)$\u3002\n\n\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86 $\\sum_{i=1}^n i=\\dfrac{i \\times (i+1)}{2}$\uff0c\u79fb\u9879\u5f97\u5230 $\\sum_{i=1}^n i^2=\\dfrac{n \\times(n+1 \\times (2n+1))}{6}$\u3002\n\n\u6700\u540e\u5904\u7406\u51fa $2,6$ \u7684\u9006\u5143\u3002\u8fd9\u9053\u9898\u5c31\u89e3\u51b3\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef __int128 LL;\nchar buf[1<<21],*p1=buf,*p2=buf;\n#define getchar() (p1==p2 && (p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\nLL read()\n{\n\tLL x=0,f=1;\n\tchar c=getchar();\n\twhile(c<'0' || c>'9')\n\t{\n\t\tif(c=='-')\tf=-1;\n\t\tc=getchar();\n\t}\n\twhile(c>='0' && c<='9')\tx=(x<<1)+(x<<3)+(c^'0'),c=getchar();\n\treturn x*f;\n}\nvoid write(LL x)\n{\n\tif(x<0)\tputchar('-'),x=-x;\n\tif(x>9)\twrite(x/10);\n\tputchar(x%10+'0');\n}\nconst LL MOD=1000000007,inv2=500000004,inv6=166666668;\nLL line(LL p){return p*(p+1)/2;}\nLL square(LL p){return p*(p+1)*(2*p+1)/6;}\nLL n,m;\nint main(){\n\tn=read(),m=read();\n\tif(n>m)\tn^=m^=n^=m;\n\tLL a=0;\n\tfor(LL l=1,r;l<=n;l=r+1)\n\t{\n\t\tr=n/(n/l);\n\t\ta+=(n/l)*(line(r)-line(l-1));\n\t}\n\ta=n*n-a;\n\tLL b=0;\n\tfor(LL l=1,r;l<=m;l=r+1)\n\t{\n\t\tr=m/(m/l);\n\t\tb+=(m/l)*(line(r)-line(l-1));\n\t}\n\tb=m*m-b;\n\tLL c=n*m*n;\n\tLL k=0;\n\tfor(LL l=1,r;l<=n;l=r+1)\n\t{\n\t\tr=min(n/(n/l),m/(m/l));\n\t\tr=min(r,n);\n\t\tk+=(n/l)*(line(r)-line(l-1));\n\t}\n\tc-=k*m;\n\tk=0;\n\tfor(LL l=1,r;l<=n;l=r+1)\n\t{\n\t\tr=min(n/(n/l),m/(m/l));\n\t\tr=min(r,n);\n\t\tk+=(m/l)*(line(r)-line(l-1));\n\t}\n\tc-=k*n;\n\tk=0;\n\tfor(LL l=1,r;l<=n;l=r+1)\n\t{\n\t\tr=min(n/(n/l),m/(m/l));\n\t\tr=min(r,n);\n\t\tk+=(n/l)*(m/l)*(square(r)-square(l-1));\n\t}\n\tc+=k;\n\tLL res=a*b-c;\n\tres%=MOD;\n\tres+=MOD;\n\tres%=MOD;\n\twrite(res);\n\treturn 0;\n}\n```",
        "postTime": 1595407049,
        "uid": 184977,
        "name": "pomelo_nene",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2834 \u3010\u80fd\u529b\u6d4b\u9a8c\u3011"
    },
    {
        "content": "## [\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/P2260)\n\n## \u601d\u8def\n\n\u6c42 $\\sum\\limits_{i = 1}^{n} (n \\mod i)\\sum\\limits_{j=1}^{m}(m\\mod j)[i\\neq j]$\n\n\u5047\u8bbe\u6ca1\u6709\u9650\u5236\u60c5\u51b5$i\\neq j$\n\n$\\sum\\limits_{i = 1}^{n} (n \\mod i)\\sum\\limits_{j=1}^{m}(m\\mod j)$\n\n\u53ea\u770b\u5de6\u534a\u90e8\u5206\uff1a\n\n$\\ \\ \\ \\sum\\limits_{i=1}^{n}(n\\% i)$\n\n$= \\sum\\limits_{i=1}^{n}(n - \\lfloor \\frac{n}{i}\\rfloor * i)$\n\n$= \\sum\\limits_{i=1}^{n}n - \\sum\\limits_{i = 1}^{n}\\lfloor\\frac{n}{i}\\rfloor*i$\n\n\u663e\u7136\u6570\u8bba\u5206\u5757\uff0c\u53f3\u534a\u90e8\u5206\u540c\u7406\uff0c\u90fd\u53ef\u4ee5\u6570\u8bba\u5206\u5757\u505a(\u4f59\u6570\u6c42\u548c\u90a3\u9053\u9898\u7684\u5b8c\u5168\u4e00\u6837\u7684\u505a\u6cd5)\n\n\u518d\u770b$i=j$\u7684\u60c5\u51b5\uff0c\u5373\n\n$ \\sum\\limits_{i=1}^{k=\\min(n,m)}(n\\mod i)(m\\mod i)$\n\n$=\\sum\\limits_{i=1}^{k}(n-\\lfloor\\frac{n}{i}\\rfloor*i)(m-\\lfloor\\frac{m}{i}\\rfloor*i)$\n\n$=\\sum\\limits_{i=1}^{k}(nm-(\\lfloor\\frac{n}{i}\\rfloor*m+\\lfloor\\frac{m}{i}\\rfloor*n)*i+\\lfloor\\frac{n}{i}\\rfloor*\\lfloor\\frac{m}{i}\\rfloor*i^2)$\n\n\u7528\u6570\u8bba\u5206\u5757\u6c42\u51fa\u4e0a\u9762\u4e24\u4e2a\u5f0f\u5b50\uff0c\u7528\u603b\u7684\u51cf\u53bb\u4e0b\u9762\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u6ce8\u610f\u9664\u6cd5\u8981\u7528\u9006\u5143\n\n> $ps$\uff1a\n>\n> 1. \u80fd\u6a21\u5c31\u6a21\uff0c\u597d\u4e8b\u591a\u6a21\n>\n> 2. \u5c0f\u77e5\u8bc6\u70b9\n>\n>    $$\\sum\\limits_{i = l}^{r}i=(r -l + 1)*(l + r) / 2$$\n>\n>    $$\\sum\\limits_{i = 1} ^{n}i^2= n * (n + 1) * (2* n + 1)/ 6$$\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(\\sqrt{n})$\n\n## \u4ee3\u7801\n\n```cpp\n/*\nAuthor:loceaner\n*/\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\n#define int long long\nusing namespace std;\n\nconst int A = 5e5 + 11;\nconst int B = 1e6 + 11;\nconst int inv6 = 3323403;\nconst int inv2 = 9970209;\nconst int mod = 19940417;\nconst int inf = 0x3f3f3f3f;\n\ninline int read() {\n\tchar c = getchar();\n\tint x = 0, f = 1;\n\tfor( ; !isdigit(c); c = getchar()) if(c == '-') f = -1;\n\tfor( ; isdigit(c); c = getchar()) x = x * 10 + (c ^ 48);\n\treturn x * f;\n}\n\nint n, m, k;\n\ninline int sum(int l, int r) {\n\treturn (r - l + 1) * (l + r) / 2 % mod;\n}\n\ninline int sum1(int r) {\n\treturn r * (r + 1) % mod * (2 * r + 1) % mod * inv6 % mod;\n}\n\ninline int sum2(int l, int r) {\n\treturn (sum1(r) - sum1(l - 1)) % mod;\n}\n\ninline int solve(int n) {\n\tint ans = n * n;\n\tfor (int l = 1, r; l <= n; l = r + 1) {\n\t\tif (n / l == 0) break;\n\t\tr = min(n / (n / l), n);\n\t\tans -= (n / l) % mod * sum(l, r) % mod;\n\t\tans %= mod;\n\t}\n\treturn (ans % mod + mod) % mod;\n}\n\nsigned main() {\n\tn = read(), m = read();\n\tint ans1 = solve(n) * solve(m) % mod, ans2 = 0;\n\tfor (int l = 1, r, now1, now2, now3, now4; l <= min(n, m); l = r + 1) {\n\t\tr = min(n / (n / l), m / (m / l));\n\t\tnow1 = n * m % mod * (r - l + 1) % mod;\n\t\tnow2 = ((n / l) * (m / l) % mod * sum2(l, r) % mod + mod) % mod;\n\t\tnow3 = ((n / l) * m % mod + (m / l) * n % mod) * sum(l, r) % mod;\n\t\tnow4 = (now1 + now2 - now3 + mod) % mod;\n\t\tans2 = (ans2 + now4) % mod;\n\t}\n\tcout << ((ans1 - ans2) % mod + mod) % mod;\n\treturn 0;\n}\n```",
        "postTime": 1587283227,
        "uid": 198323,
        "name": "loceaner",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2260 \u3010[\u6e05\u534e\u96c6\u8bad2012]\u6a21\u79ef\u548c\u3011"
    },
    {
        "content": "\u505a\u6cd5\u53c2\u8003\u81ea[hzwer\u7684Blog](http://hzwer.com/6113.html)\u3002\n\n\u63a8\u5f0f\u5b50\u8fc7\u7a0b\u53ef\u4ee5\u524d\u5f80\u4e0a\u8ff0Blog\u89c2\u770b\u3002\n\n\n\u8fd9\u91cc\u5206\u4eab\u9700\u8981\u6ce8\u610f\u7684\u51e0\u4e2a\u5c0f\u7ec6\u8282\uff1a\n\n1. \u6d89\u53ca\u7206int\u7684\u5730\u65b9\u5168\u90e8\u8981\u7528long long\u3002\n\n\n2. \u7a0b\u5e8f\u4e2d\uff0c\u6211\u4eec\u8ba1\u7b97$\\sum\\limits_{i=1}^{n}i^2$\u7684\u65f6\u5019\u9700\u8981\u96646\uff0c\u6d89\u53ca\u5230\u6c426\u7684\u9006\u5143\u3002\u4f46\u6a21\u6570\u4e0d\u662f\u8d28\u6570\u7684\u65f6\u5019\u4e0d\u80fd\u7528\u8d39\u9a6c\u5c0f\u5b9a\u7406\u6c42\u9006\u5143\uff0c\u5e94\u6362\u7528\u6b27\u62c9\u5b9a\u7406\u6216\u62d3\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\uff08exgcd\uff09\uff0c\u4e0b\u9762\u7684\u7a0b\u5e8f\u5c31\u662f\u7528exgcd\u6c426\u7684\u9006\u5143\u7684\u3002\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u4e8b\u5148\u8ba1\u7b97\u597d6\u7684\u9006\u5143\uff0c\u5728\u4ee3\u7801\u4e2d\u76f4\u63a5\u4f7f\u7528\u3002\n\n\n3. \u6b64\u7c7b\u6570\u5b66\u9898\u5728\u8c03\u8bd5\u7684\u65f6\u5019\u53ef\u4ee5\u4f7f\u7528\u5355\u5143\u6d4b\u8bd5\u7684\u65b9\u5f0f\uff0c\u5373\u5206\u522b\u6d4b\u8bd5\u4e00\u4e2a\u4e2a\u5c0f\u51fd\u6570\u662f\u5426\u5199\u9519\uff0c\u8fd9\u6837\u67e5\u9519\u4f1a\u6bd4\u8f83\u5feb\u3002\n\n\n4. \u5b81\u53ef\u591a\u7528\u51e0\u4e2a`%MOD`\uff0c\u4e5f\u4e0d\u8981\u6f0f\u5199\u4efb\u4f55\u4e00\u4e2a`%MOD`\u3002\u6bd4\u5982\u8bf4\u51cf\u7684\u65f6\u5019\u4e00\u822c\u8981`+ MOD) % MOD`\uff0c\u6709\u7684\u65f6\u5019\u751a\u81f3\u9700\u8981`((x-y)%MOD+MOD)%MOD`\u3002\n\n\n\u5176\u4f59\u5b9e\u73b0\u7ec6\u8282\u8be6\u89c1\u4ee3\u7801\u3002\n\n\n```cpp\n#include <cstdio>\n#define MOD 19940417\n#define Lovelive long long\n#define lld \"%lld\"\n#define min(a, b) ((a) < (b) ? (a) : (b))\n// \u62d3\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\nLovelive exgcd(Lovelive a, Lovelive b, Lovelive& x, Lovelive& y) {\n    if(!b) {\n        x = 1, y = 0;\n        return a;\n    }\n    else {\n        Lovelive ret = exgcd(b, a % b, y, x);\n        y -= a / b * x;\n        return ret;\n    }\n}\n// \u8ba1\u7b97\u9006\u5143\nLovelive getinv(int arg) {\n    Lovelive x, y;\n    exgcd(MOD, arg, x, y);\n    return y > 0 ? y : -y; // \u53d6abs\n}\n\nconst Lovelive inv6 = getinv(6); // \u5f53\u7136\u53ef\u4ee5\u63d0\u524d\u7b97\u51fa\u5b83\u5c31\u662f3323403\u3002\n\nLovelive sum1(Lovelive x) { // \u8ba1\u7b97sigma(i)\n    return x * (x + 1) / 2 % MOD;\n}\n\nLovelive dif1(Lovelive l, Lovelive r) {\n    return (sum1(r) - sum1(l - 1) + MOD) % MOD;\n}\n\nLovelive sum2(Lovelive x) { // \u8ba1\u7b97sigma(i^2)\n    return x * (x + 1) % MOD * (2 * x + 1) % MOD * inv6 % MOD;\n}\n\nLovelive dif2(Lovelive l, Lovelive r) {\n    return (sum2(r) - sum2(l - 1) + MOD) % MOD;\n}\n\nLovelive calc(Lovelive n) { // \u8ba1\u7b97sigma(n % i)\n    Lovelive ret = 0;\n    for(int i = 1, j; i <= n; i = j + 1) {\n        j = n / (n/i);\n        ret = (ret + n * (j-i+1) % MOD - dif1(i, j) * (n/i) % MOD + MOD) % MOD;\n    }\n    return (ret + MOD) % MOD;\n}\n\nLovelive n, m, li, s1, s2, s3;\n\nint main() {\n    scanf(lld lld, &n, &m);\n    Lovelive ans = calc(n) * calc(m) % MOD;\n    li = min(n, m);\n    for(int i = 1, j; i <= li; i = j + 1) {\n        j = min(n / (n/i), m / (m/i)); // \u6839\u53f7\u5206\u5757\n        s1 = (s1 + n * m % MOD * (j-i+1)) % MOD; // \u5e38\u6570\u9879\n        s2 = (s2 + (n * (m/i) + m * (n/i)) % MOD * dif1(i, j)) % MOD; // \u4e00\u6b21\u9879\n        s3 = (s3 + (n/i) * (m/i) % MOD * dif2(i, j) % MOD) % MOD; // \u4e8c\u6b21\u9879\n    }\n    ans = ((ans - s1 + s2 - s3) % MOD + MOD) % MOD;\n    printf(lld, ans);\n}\n```",
        "postTime": 1515434350,
        "uid": 21421,
        "name": "pantw",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2260 \u3010\u6a21\u79ef\u548c\u3011"
    },
    {
        "content": "~~\u5176\u5b9e\u662fP2260\u7684\u53cc\u500d\u7ecf\u9a8c~~\n\n\u5957\u8def\u63a8\u5f0f\u5b50\u9898~~\u597d\u50cf\u8fd8\u633a\u65e0\u8111\u7684\u554a~~\u3002\n\n\u89c4\u5b9a $n<m$\u3002\u539f\u5f0f\u73c2\u4ee5\u7b49\u4e8e\u8fd9\u4e00\u5768\u3002\n\n$$\n(\\sum\\limits^n_{i=1}(n\\operatorname{mod} i) )(\\sum\\limits^m_{j=1}(m\\operatorname{mod} j))-\\sum\\limits^n_{i=1}((n\\operatorname{mod} i)\\times (m\\operatorname{mod} i))\n$$\n\n\u90a3\u4e48\u53ef\u4ee5\u628a\u51cf\u53f7\u5de6\u53f3\u4e24\u8fb9\u7684\u548c\u5f0f\u5206\u522b\u5904\u7406\u3002\u5148\u5904\u7406\u597d\u641e\u7684\u5de6\u8fb9\u3002\u6309\u7167[\u8fd9\u9898](https://www.luogu.com.cn/problem/P2261)\u7684\u65b9\u6cd5\u5f3a\u884c\u628a\u6a21\u8f6c\u5316\u4e3a\u9664\u6cd5\u7136\u540e\u7528\u6574\u9664\u5206\u5757\u6c42\u89e3\u3002\u90a3\u4e48 $\\sum\\limits^n_{i=1}n\\operatorname{mod} i$ \u5b9e\u9645\u4e0a\u7b49\u4e8e $\\sum\\limits^n_{i=1}(n-\\lfloor \\frac{n}{i}\\rfloor\\times i)$\u3002$\\sum\\limits^m_{j=1}m\\operatorname{mod} j$ \u4e00\u4e2a\u9053\u7406\u3002\n\n\u73b0\u5728\u5904\u7406\u53f3\u8fb9\u7684\u548c\u5f0f\u3002\n\n$$\n\\begin{aligned}\n\\sum\\limits^n_{i=1}(n\\operatorname{mod} i)\\times (m\\operatorname{mod} i)&=\\sum\\limits^n_{i=1}(n-\\lfloor\\frac{n}{i}\\rfloor\\times i)(m-\\lfloor\\frac{m}{i}\\rfloor\\times i)\\\\\n&=\\sum\\limits^n_{i=1}nm-ni\\lfloor\\frac{m}{i}\\rfloor-mi\\lfloor\\frac{n}{i}\\rfloor+\\lfloor\\frac{n}{i}\\rfloor\\lfloor\\frac{m}{i}\\rfloor i^2\\\\\n&=n^2m-n\\sum\\limits^n_{i=1}i\\lfloor\\frac{m}{i}\\rfloor-m\\sum\\limits^{n}_{i=1}i\\lfloor\\frac{n}{i}\\rfloor+\\sum\\limits^n_{i=1}\\lfloor\\frac{n}{i}\\rfloor\\lfloor\\frac{m}{i}\\rfloor i^2\n\\end{aligned}\n$$\n\n~~\u628a\u4e00\u4e2a\u548c\u5f0f\u786c\u62c6\u6210\u4e09\u4e2a\u548c\u5f0f\u6709\u610f\u601d\u5417\uff1f~~\n\n\u6700\u540e\u5c55\u5f00\u7684\u5f0f\u5b50\uff0c\u524d\u4e24\u4e2a\u548c\u5f0f\u6734\u7d20\u5730\u6574\u9664\u5206\u5757\u5373\u53ef\uff0c\u6700\u540e\u90a3\u4e2a\u548c\u5f0f\u2026\u2026\u6211\u4eec\u597d\u50cf\u786e\u5b9a\u4e86\u4e00\u4e2a $[l,r]$ \u533a\u95f4\u5546\u90fd\u4e3a $k$ \u540e\u9700\u8981\u8ba1\u7b97 $\\sum\\limits^r_{i=l}i^2$\u3002\n\n\u6839\u636e\u5c0f\u5b66\u5965\u6570\u77e5\u8bc6\uff0c$\\sum\\limits^n_{i=1}i^2=\\frac{n(n+1)(2n+1)}{6}$\u3002\u6240\u4ee5\u524d\u7f00\u548c\u4e00\u4e0b $\\sum\\limits^r_{i=l}i^2=\\sum\\limits^r_{i=1}i^2-\\sum\\limits^{l-1}_{i=1}i^2$\uff0c\u5957\u516c\u5f0f\u5373\u53ef\u3002\n\n```cpp\n#include <cstdio>\n#define int long long\n\nconst int mod = 1e9 + 7;\ninline int min(const int x, const int y) {return x < y ? x : y;}\n\nint qpow(int a, int b) {\n\tint ret = 1LL;\n\twhile (b) {\n\t\tif (b & 1) ret = ret * a % mod;\n\t\ta = a * a % mod;\n\t\tb >>= 1; \n\t}\n\treturn ret;\n}\n\nint calc(int n) {\n\tint ans = 0;\n\tans = n * n;\n\tfor (int l = 1, r; l <= n; l = r + 1) {\n\t\tr = n / (n / l);\n\t\tans -= (n / l) * (r - l + 1) * (l + r) / 2;\n\t}\n\tans = (ans % mod + mod) % mod;\n\treturn ans;\n}\nint calc2(int n, int k) {\n\tint sum = 0;\n\tif (k > n) k = n;\n\tfor (int l = 1, r; l <= k; l = r + 1) {\n\t\tr = min(n / (n / l), k);\n\t\tsum = (sum + (n / l) * (r - l + 1) * (l + r) / 2 % mod) % mod;\n\t}\n\treturn sum;\n}\nint calc4(int n) {\n\tif (!n) return 0;\n\tint a[] = {n, n + 1, 2 * n + 1};\n\tfor (int i = 0; i <= 2; ++ i)\n\t\tif (a[i] % 2 == 0) {a[i] /= 2; break;}\n\tfor (int i = 0; i <= 2; ++ i)\n\t\tif (a[i] % 3 == 0) {a[i] /= 3; break;}\n\treturn a[0] * a[1] % mod * a[2] % mod;\n}\nint calc3(int n, int m) {\n\tint sum = 0;\n\tfor (int l = 1, r; l <= n; l = r + 1) {\n\t\tr = min(n / (n / l), m / (m / l));\n\t\tint k = (calc4(r) - calc4(l - 1) + mod) % mod;\n\t\tsum = (sum + (n / l) * (m / l) * k % mod) % mod;\n\t}\n\treturn sum % mod;\n}\n\nsigned main() {\n\tint n, m, ans;\n\tscanf(\"%lld%lld\", &n, &m);\n\tif (n > m) n ^= m ^= n ^= m;\n\tans = calc(n) * calc(m) % mod;\n\tans = (ans - n * n % mod * m % mod) % mod;\n\tans = (ans - calc3(n, m)) % mod;\n\tans = (ans + n * calc2(m, n) % mod + m * calc2(n, m) % mod) % mod;\n\tprintf(\"%lld\", (ans + mod) % mod);\n\treturn 0;\n}\n```",
        "postTime": 1621343242,
        "uid": 361308,
        "name": "Stinger",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 \u3010P2834 \u80fd\u529b\u6d4b\u9a8c\u3011"
    },
    {
        "content": "[P2834 \u80fd\u529b\u6d4b\u9a8c](https://www.luogu.com.cn/problem/P2834)\u89e3\u9898\u62a5\u544a\uff1a\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://zybuluo.com/xiaoziyao/note/1724305)\n\n\u53cc\u500d\u7ecf\u9a8c\uff1a[P2260 [\u6e05\u534e\u96c6\u8bad2012]\u6a21\u79ef\u548c](https://www.luogu.com.cn/problem/P2260)\n\n## \u9898\u610f\n\u9898\u610f\uff1a\u6c42$\\sum_{i=1}^n\\sum_{j=1}^m[i\\ne j](n\\bmod i)\\cdot(m\\bmod j)$\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\leqslant n,m\\leqslant 10^9$\u3002\n\n## \u5206\u6790\n\n\u8fd9\u662f\u4e00\u9053\u7b80\u5355\u7684\u63a8\u5f0f\u5b50\u9898\uff0c\u4f46\u662f\u5b9e\u73b0\u6bd4\u8f83\u6076\u5fc3\u3002\n\n\u9996\u5148\u4e0d\u59a8\u8bbe$n\\leqslant m$\uff08\u5982\u679c$n>m$\u4ea4\u6362\u4e00\u4e0b\u5c31\u597d\u4e86\uff09\n\n\u7136\u540e\u53ef\u4ee5\u7528\u5bb9\u65a5\u5c06\u9898\u76ee\u62c6\u6210\u4e24\u4e2a\u90e8\u5206\uff1a\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m(n\\bmod i)\\cdot(m\\bmod j)-\\sum_{i=1}^n(n\\bmod i)\\cdot(m\\bmod i)$$\n\n\u5c06\u4e24\u4e2a\u6c42\u548c\u62c6\u5f00\uff1a\n\n$$\\sum_{i=1}^n(n\\bmod i)\\cdot\\sum_{j=1}^m(m\\bmod j)-\\sum_{i=1}^n(n\\bmod i)\\cdot(m\\bmod i)$$\n\n\u56e0\u4e3a\u53d6\u6a21\u5f88\u96be\u641e\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528\u4e00\u4e2a\u6027\u8d28$a\\bmod b=a-\\lfloor\\frac{a}{b}\\rfloor\\cdot b$\uff08\u53d6\u6a21\u7684\u5b9a\u4e49\uff09\uff0c\u5c06\u4e0a\u5f0f\u8f6c\u6362\u4e3a\uff1a\n\n$$\\sum_{i=1}^n(n-\\lfloor\\frac{n}{i}\\rfloor\\cdot i)\\cdot\\sum_{j=1}^m(m-\\lfloor\\frac{m}{j}\\rfloor\\cdot j)-\\sum_{i=1}^n(n-\\lfloor\\frac{n}{i}\\rfloor\\cdot i)\\cdot(m-\\lfloor\\frac{m}{i}\\rfloor\\cdot i)$$\n\n\u5c06\u62ec\u53f7\u62c6\u5f00\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$(n^2-\\sum_{i=1}^ni\\cdot\\lfloor\\frac{n}{i}\\rfloor)\\cdot(m^2-\\sum_{i=1}^mi\\cdot\\lfloor\\frac{m}{i}\\rfloor)-\\sum_{i=1}^n(nm-mi\\cdot\\lfloor\\frac{n}{i}\\rfloor-ni\\cdot\\lfloor\\frac{m}{i}\\rfloor+i^2\\cdot\\lfloor\\frac{n}{i}\\rfloor\\cdot\\lfloor\\frac{m}{i}\\rfloor)$$\n\n\u6b64\u65f6\u6211\u4eec\u7684\u590d\u6742\u5ea6\u5df2\u7ecf\u662f$O(n)$\u4e86\uff0c\u7136\u800c\u8fd9\u4e2a\u590d\u6742\u5ea6\u4ecd\u7136\u4e0d\u8db3\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n\u8981\u505a\u8fd9\u9053\u9898\u9700\u8981\u4e00\u4e2a\u7b80\u5355\u7684\u6280\u5de7\u2014\u2014\u6574\u9664\u5206\u5757\u3002\n\n\u6211\u4eec\u5f88\u5bb9\u6613\u53d1\u73b0\u5f88\u591a$\\lfloor\\frac{n}{i}\\rfloor$\u7684\u503c\u662f\u4e00\u6837\u7684\uff0c\u4e14\u6240\u6709\u7684$\\lfloor\\frac{n}{i}\\rfloor$\u4e3a\u4e00\u4e2a\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\uff0c\u5448\u5757\u72b6\u5206\u5e03\n\n\u901a\u8fc7\u7b80\u5355\u7684\u8ba1\u7b97\u53ef\u4ee5\u5f97\u5230\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8d77\u70b9\u4e3a$i$\u7684\u5757\uff0c\u5b83\u7684\u503c\u4e3a$\\lfloor\\frac{n}{i}\\rfloor$\uff0c\u7ec8\u70b9\u4e3a$\\lfloor\\frac{n}{\\lfloor\\frac{n}{i}\\rfloor}\\rfloor$\uff0c\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u7528$O(\\sqrt{n})$\u7684\u7b97\u6cd5\u8ba1\u7b97$\\sum_{i=1}^ni\\cdot \\lfloor\\frac{n}{i}\\rfloor$\u4e86\uff1a\n\n\u4e3b\u8981\u6b65\u9aa4\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5757$[l,r]$\uff0c\u5b83\u4e58\u53f7\u524d\u9762\u524d\u7f00\u548c\u5dee\u5206\u5f97\u5230\uff0c\u5373$(1+2+\\cdots+r)-(1+2+\\cdots+(l-1))$\uff0c\u4e58\u53f7\u540e\u9762\u7684\u5c31\u662f$\\lfloor\\frac{n}{l}\\rfloor$\u3002\n\n\u4ee3\u7801\uff1a\n\n```\ninline long long sum1(long long x){\n\treturn x*(x+1)%mod*inv2%mod;\n}\n\nl=1,sum=n*n%mod;\nwhile(l<=n){\n\tr=n/(n/l);\n\tsum=(sum-(sum1(r)-sum1(l-1)+mod)%mod*(n/l)%mod+mod)%mod;\n\tl=r+1;\n}\n```\n\n\u540c\u6837\uff0c$\\sum_{i=1}^mi\\cdot \\lfloor\\frac{m}{i}\\rfloor$\u7684\u503c\u4e5f\u53ef\u4ee5\u7528\u76f8\u540c\u7684\u65b9\u6cd5\u6c42\u5f97\u3002\n\n\u8003\u8651\u6c42$\\sum_{i=1}^n(nm-mi\\cdot\\lfloor\\frac{n}{i}\\rfloor-ni\\cdot\\lfloor\\frac{m}{i}\\rfloor+i^2\\cdot\\lfloor\\frac{n}{i}\\rfloor\\cdot\\lfloor\\frac{m}{i}\\rfloor)$\uff0c\u53d1\u73b0\u7528\u6574\u9664\u5206\u5757\u5b8c\u6210\u5b83\u9700\u8981\u4f7f\u533a\u95f4$[l,r]$\u4e2d\u6240\u6709\u7684$i$\u90fd\u6ee1\u8db3$\\lfloor\\frac{n}{i}\\rfloor$\u4e0e$\\lfloor\\frac{m}{i}\\rfloor$\u76f8\u540c\u3002\n\n\u53ef\u4ee5\u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\uff0c\u5c06\u4e0a\u9762\u4ee3\u7801\u4e2d\u7684```r=n/(n/l);```\u6539\u4e3a```r=min(n/(n/l),m/(m/l));```\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u76f4\u63a5\u6c42\u503c\u4e86\uff01\n\n\u4e14\u6162\uff0c\u867d\u7136\u524d\u4e09\u9879$nm,mi\\cdot\\lfloor\\frac{n}{i}\\rfloor,ni\\cdot\\lfloor\\frac{m}{i}\\rfloor$\u90fd\u5f88\u5bb9\u6613\u6c42\u5f97\uff0c\u4f46\u662f$i^2\\cdot\\lfloor\\frac{n}{i}\\rfloor\\cdot\\lfloor\\frac{m}{i}\\rfloor$\u4e0d\u662f\u5f88\u5bb9\u6613\u6c42\uff0c\u56e0\u4e3a$(1^2+2^2+\\cdots+i^2)$\u4e0d\u597d\u5904\u7406\u3002\n\n\u8fd9\u91cc\u6709\u4e00\u4e2a\u7b80\u5355\u7684\u7ed3\u8bba\uff1a$1^2+2^2+\\cdots+n^2=\\frac{n(n+1)(2n+1)}{6}$\uff0c\u4f1a\u5728\u6587\u540e\u8bc1\u660e\uff0c\u73b0\u5728\u5148\u7ed9\u51fa\u8fd9\u4e00\u90e8\u5206\u7684\u4ee3\u7801\uff1a\n\n```\ninline long long sum2(long long x){\n\treturn x*(x+1)%mod*(2*x+1)%mod*inv6%mod;\n}\n\nl=1,tmp3=0;\nwhile(l<=n){\n\tlong long a,b,c;\n\tr=min(n/(n/l),m/(m/l));\n\ta=(r-l+1)*n%mod*m%mod;\n\tb=(sum1(r)-sum1(l-1)+mod)%mod*((n/l)*m%mod+(m/l)*n%mod)%mod;\n\tc=(sum2(r)-sum2(l-1)+mod)%mod*(n/l)%mod*(m/l)%mod;\n\ttmp3=(tmp3+a-b+c+mod)%mod;\n\tl=r+1;\n}\n```\n\n## \u4ee3\u7801\n- \u8bb0\u5f97\u5f00long long\n- \u53d6\u6a21\u5f88\u6076\u5fc3\uff0c\u5982\u679c\u9519\u4e86\u591a\u534a\u662f\u8fd9\u79cd\u539f\u56e0\n- \u56e0\u4e3a\u4e09\u4e2a\u6574\u6570\u76f8\u4e58\u4f1a\u7206long long\uff0c\u56e0\u6b64\u9664\u6cd5\u7528\u9006\u5143\u5b9e\u73b0\uff08\u9006\u5143\u63d0\u524d\u6c42\u5f97\uff09\n\n```\n#include<stdio.h>\nconst long long mod=1000000007,inv2=500000004,inv6=166666668;\nlong long i,j,k,m,n,l,r,ans,tmp1,tmp2,tmp3;\ninline long long min(long long a,long long b){\n\treturn a<b? a:b; \n}\ninline void swp(long long &a,long long &b){\n\ta+=b,b=a-b,a-=b;\n}\ninline long long sum1(long long x){\n\treturn x*(x+1)%mod*inv2%mod;\n}\ninline long long sum2(long long x){\n\treturn x*(x+1)%mod*(2*x+1)%mod*inv6%mod;\n}\nint main(){\n\tscanf(\"%lld%lld\",&n,&m);\n\tif(n>m)\n\t\tswp(n,m);\n\tl=1,tmp1=n*n%mod;\n\twhile(l<=n){\n\t\tr=n/(n/l);\n\t\ttmp1=(tmp1-(sum1(r)-sum1(l-1)+mod)%mod*(n/l)%mod+mod)%mod;\n\t\tl=r+1;\n\t}\n\tl=1,tmp2=m*m%mod;\n\twhile(l<=m){\n\t\tr=m/(m/l);\n\t\ttmp2=(tmp2-(sum1(r)-sum1(l-1)+mod)%mod*(m/l)%mod+mod)%mod;\n\t\tl=r+1;\n\t}\n\tl=1,tmp3=0;\n\twhile(l<=n){\n\t\tlong long a,b,c;\n\t\tr=min(n/(n/l),m/(m/l));\n\t\ta=(r-l+1)*n%mod*m%mod;\n\t\tb=(sum1(r)-sum1(l-1)+mod)%mod*((n/l)*m%mod+(m/l)*n%mod)%mod;\n\t\tc=(sum2(r)-sum2(l-1)+mod)%mod*(n/l)%mod*(m/l)%mod;\n\t\ttmp3=(tmp3+a-b+c+mod)%mod;\n\t\tl=r+1;\n\t}\n\tans=(tmp1*tmp2%mod-tmp3+mod)%mod;\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n} \n```\n\n## \u7b80\u5355\u7684\u8bc1\u660e\n\u8bc1\u660e\uff1a\n\n$$1^2+2^2+\\cdots+n^2=\\frac{n(n+1)(2n+1)}{6}$$\n\n\uff08\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u7528\u7b80\u5355\u6784\u9020\u6cd5\u4e0e\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bc1\u660e\uff0c\u7531\u4e8e\u5927\u90e8\u5206\u9898\u89e3\u90fd\u662f\u7528\u7684\u6570\u5b66\u5f52\u7eb3\u6cd5\uff0c\u4e14\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bfb\u8005\u81ea\u8bc1\u4e0d\u96be\uff0c\u56e0\u6b64\u8fd9\u91cc\u4f7f\u7528\u7b80\u5355\u6784\u9020\u6cd5\uff09\n\n\u7531\u4e8e\u6709\u8fd9\u6837\u4e00\u4e2a\u5f0f\u5b50\uff1a$i^2=i^2-i+i(i-1)\\cdot i+i$\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u62c6\u5f00\uff1a\n\n$$1^2+2^2+\\cdots+n^2=\\sum_{i=1}^ni^2=\\sum_{i=1}^n(i-1)\\cdot i+\\sum_{i=1}^ni$$\n\n\u7136\u540e\u4e58\u4e0a$\\frac{1}{3}$\uff1a\n\n$$\\sum_{i=1}^ni^2=\\frac{1}{3}\\sum_{i=1}^n(i-1)\\cdot i\\cdot3+\\sum_{i=1}^ni$$\n\n\u6784\u9020\u4e00\u4e0b\uff1a\n\n$$\\sum_{i=1}^ni^2=\\frac{1}{3}\\sum_{i=1}^n(i-1)\\cdot i\\cdot((i+1)-(i-2))=\\frac{1}{3}\\sum_{i=1}^n(-(i-2)\\cdot(i-1)\\cdot i+(i-1)\\cdot i\\cdot(i+1))+\\sum_{i=1}^ni$$\n\n\u628a\u5b83\u4eec\u5168\u90e8\u5c55\u5f00\uff1a\n\n$$\\sum_{i=1}^ni^2=\\frac{1}{3}(-(-1)\\cdot0\\cdot1+0\\cdot1\\cdot2-0\\cdot1\\cdot2+1\\cdot2\\cdot3-1\\cdot2\\cdot3+\\cdots(n-1)\\cdot n\\cdot(n+1))+\\frac{n\\cdot(n+1)}{2}$$\n\n\u53d1\u73b0\u62ec\u53f7\u91cc\u7684\u5f88\u591a\u9879\u90fd\u53ef\u4ee5\u62b5\u6d88\uff1a\n\n$$\\sum_{i=1}^ni^2=\\frac{(n-1)\\cdot n\\cdot(n+1)}{3}+\\frac{n\\cdot(n+1)}{2}=\\frac{n\\cdot(n+1)\\cdot(2(n-1)+3)}{6}=\\frac{n\\cdot(n+1)\\cdot(2n+1)}{6}$$\n\n\u8bc1\u6bd5\u3002",
        "postTime": 1594729666,
        "uid": 35754,
        "name": "Verdandi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2834 \u3010\u80fd\u529b\u6d4b\u9a8c\u3011"
    },
    {
        "content": "[CSDN\u540c\u6b65](https://blog.csdn.net/bifanwen/article/details/106973001)\n\n[\u535a\u5ba2\u56ed\u540c\u6b65](https://www.cnblogs.com/bifanwen/p/13195919.html)\n\n[\u6d1b\u8c37\u9898\u89e3\u540c\u6b65](https://www.luogu.com.cn/blog/bfw/solution-p2260)\n\n[\u539f\u9898\u94fe\u63a5](https://www.luogu.com.cn/problem/P2260)\n\n\u7b80\u8981\u9898\u610f\uff1a\n\n\u7ed9\u5b9a $n,m$\uff0c\u6c42\uff1a\n\n$$\\sum_{i=1}^n \\sum_{j=1}^m (n \\space \\text{mod} \\space i) \\times (m \\space \\text{mod} \\space j) , i \\not = j$$\n\n$n,m \\leq 10^9$.\n\n\u6211\u4eec\u76f4\u63a5\u5954\u7740 $100$ \u5206\u7684\u6570\u636e\u53bb\u5427\uff0c\u4e0d\u8981\u770b\u90e8\u5206\u5206\uff0c\u90e8\u5206\u5206\u5c31\u6ca1\u610f\u601d\u3002\n\n\u8fd9\u4e2a\u5f0f\u5b50\u7684\u74f6\u9888\u5728\u4e8e $n \\space \\text{mod} \\space i$ \u7684\u5c55\u5f00\u95ee\u9898\u3002\u6240\u4ee5\u53ea\u9700\u8981\u7528 $n \\space \\text{mod} \\space i = n - \\lfloor \\frac{n}{i} \\rfloor \\times i$ \uff0c\u7136\u540e\u7075\u6d3b\u7528\u591a\u9879\u5f0f\u7684\u62c6\u5f00\u4e0e\u5408\u5e76\uff0c\u4e00\u6ce2\u6574\u9664\u5206\u5757\u5e26\u8d70\u5373\u53ef\u3002\n\n\u9996\u5148\u8bf4\u597d\uff0c\u8fd9\u4e00\u6b21\u7684\u63a8\u5f0f\u5b50\u6ca1\u6709 **\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14**\uff0c\u4e5f\u6ca1\u6709 **\u5947\u602a\u7684\u7b5b\u6cd5**\uff0c\u6709\u7684\u53ea\u662f **\u591a\u9879\u5f0f\u7684\u7075\u6d3b\u5c55\u5f00 \u4e0e \u6574\u9664\u5206\u5757**\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5f00\u59cb\u63a8\u5f0f\u5b50\u3002\n\n$$\\sum_{i=1}^n \\sum_{j=1}^m (n \\space \\text{mod} \\space i) \\times (m \\space \\text{mod} \\space j) , i \\not = j$$\n\n$$ = \\sum_{i=1}^n \\sum_{j=1}^m (n - \\lfloor \\frac{n}{i} \\rfloor \\times i) \\times (m - \\lfloor \\frac{m}{j} \\rfloor \\times j) , i \\not = j$$\n\n$$ = \\sum_{i=1}^n (n - \\lfloor \\frac{n}{i} \\rfloor \\times i) \\times  \\sum_{j=1}^m (m - \\lfloor \\frac{m}{j} \\rfloor \\times j) , i \\not = j$$\n\n\u9996\u5148\u6211\u4eec\u628a $i=j$ \u7684\u7b54\u6848\u4e22\u6389\uff0c\u5148\u505a\u6240\u6709\u7684\u7b54\u6848\u3002\n\n\u4ee4 $f_n = \\sum_{i=1}^n (n - \\lfloor \\frac{n}{i} \\rfloor \\times i)$\uff0c\u5219 $\\text{ans} = f_n \\times f_m$\uff0c\u8003\u8651\u5982\u4f55\u5feb\u901f\u6c42 $f$.\n\n$$f_n = \\sum_{i=1}^n (n - \\lfloor \\frac{n}{i} \\rfloor \\times i)$$\n\n$$ = n^2 - \\sum_{i=1}^n \\Big( \\lfloor \\frac{n}{i} \\rfloor \\times i \\Big)$$\n\n\u7136\u540e\u4f60\u4f1a\u53d1\u73b0\u8fd9\u4e1c\u897f\u76f4\u63a5 **\u6574\u9664\u5206\u5757**\uff0c$\\mathcal{O}(\n\\sqrt{n})$ \u5f88\u7a33\u3002\n\n\u6700\u540e\u591a\u4f59\u7684 $i=j$ \u7684\u7b54\u6848\u5e94\u8be5\u4f1a\u662f\uff1a\n\n$$\\sum_{i=1}^{\\min(n,m)} (n \\space \\text{mod} \\space i) \\times (m \\space \\text{mod} \\space i)$$\n\n$$ = \\sum_{i=1}^{\\min(n,m)} (n - \\lfloor \\frac{n}{i} \\rfloor \\times i) \\times (m - \\lfloor \\frac{m}{i} \\rfloor \\times i)$$\n\n$$ = \\sum_{i=1}^{\\min(n,m)} \\Big( nm - ni \\lfloor \\frac{m}{i} \\rfloor - mi \\lfloor \\frac{n}{i} \\rfloor + i^2 \\lfloor \\frac{n}{i} \\rfloor \\lfloor \\frac{m}{i} \\rfloor \\Big)$$\n\n$$ = nm \\cdot \\min(n,m) - n \\times \\sum_{i=1}^{\\min(n,m)} i \\lfloor \\frac{m}{i} \\rfloor - m \\times \\sum_{i=1}^{\\min(n,m)} i \\lfloor \\frac{n}{i} \\rfloor + \\sum_{i=1}^{\\min(n,m)} i^2 \\lfloor \\frac{n}{i} \\rfloor \\lfloor \\frac{m}{i} \\rfloor$$\n\n\u4ee4 $g_{n,k} = \\sum_{i=1}^k i \\lfloor \\frac{n}{i} \\rfloor$\n\n\u5219\uff1a\n\n$$ = nm \\cdot \\min(n,m) - n \\times g_{m,\\min(n,m)} - m \\times g_{n,\\min(n,m)} + \\sum_{i=1}^{\\min(n,m)} i^2 \\lfloor \\frac{n}{i} \\rfloor \\lfloor \\frac{m}{i} \\rfloor$$\n\n\u663e\u7136\uff0c$g$ \u53ef\u4ee5\u6574\u9664\u5206\u5757\uff0c\u6240\u4ee5\u6574\u4e2a\u5f0f\u5b50\u90fd\u53ef\u4ee5\u6574\u9664\u5206\u5757\u3002\n\n\u5bf9\u4e8e\u6700\u540e\u7684\u4e00\u5757\uff0c\u6211\u4eec\u4ee4 $h_{n,m,k} = \\sum_{i=1}^{k} i^2 \\lfloor \\frac{n}{i} \\rfloor \\lfloor \\frac{m}{i} \\rfloor$\uff0c\u4f46\u662f\u6ce8\u610f\u5230\uff1a\n\n\n$\\sum_{i=1}^{\\min(n,m)} i^2 \\lfloor \\frac{n}{i} \\rfloor \\lfloor \\frac{m}{i} \\rfloor$ \u7684\u8ba1\u7b97\u9700\u8981\u7528\u5230\u516c\u5f0f\uff1a\n\n$$\\sum_{i=1}^n i^2 = \\frac{n (n+1) (2n+1)}{6}$$\n\n\u4f46\u662f\u6a21\u610f\u4e49\u4e0b\u7684\u9664\u6cd5\u4e0d\u597d\u505a\u3002\u8fd9\u91cc\u6709\u4e09\u79cd\u89e3\u51b3\u65b9\u6cd5\uff1a\n\n- \u6c42\u51fa\u6a21\u610f\u4e49\u4e0b $6$ \u7684\u9006\u5143\uff0c\u53ef\u60dc\u6a21\u6570\u4e0d\u662f\u8d28\u6570\uff0c\u6211\u4eec\u53ea\u80fd\u7528 $\\text{exgcd}$ \u53bb\u505a\u3002\n- \u7531\u4e8e $n(n+1)$ \u4e0d\u4f1a\u6ea2\u51fa\uff0c\u53ef\u4ee5\u8003\u8651 $n(n+1)/2 * (2n+1)/3$\uff0c\u4f46\u662f\u6700\u7ec8\u7684\u7ed3\u679c\u4f1a\u7206 $\\text{long long}$\uff0c\u56e0\u6b64\u8fd9\u79cd\u65b9\u6cd5\u4e0d\u884c\u3002\n- \u76f4\u63a5\u5f00 $\\text{\\_\\_int128}$ \u89e3\u51b3\u6240\u6709\u95ee\u9898\u3002\n\n\u5f53\u7136\u672c\u4eba\u4e3a\u4e86\u65b9\u4fbf\u76f4\u63a5\u5f00\u4e86 $\\text{\\_\\_int128}$\uff0c\u89e3\u51b3\u4e86\u6240\u6709\u7684\u6ea2\u51fa\u8ba1\u7b97\u95ee\u9898\u3002\u53cd\u6b63 $(10^9)^3 = 10^{27}$ \u80af\u5b9a\u4e0d\u4f1a\u8d85\u8fc7 $2^{127}$\uff0c\u56e0\u4e3a $2^{127}$ \u5927\u6982\u6709 $40$ \u4f4d\u3002\n\u4e0a\u8ff0\u65b9\u6cd5\u5df2\u7ecf\u8bf4\u660e\uff0c$f$ \u548c $g$ \u5747\u53ef\u4ee5\u5728 $\\mathcal{O}(\\sqrt{n} + \\sqrt{m} + \\sqrt{\\min(n,m)})$ \u7684\u65f6\u95f4\u5185\u89e3\u51b3\u3002$n$ \uff0c$m$ \u4e0e $\\min(n,m)$ \u5747\u540c\u7ea7\uff0c\u6240\u4ee5\u6700\u7ec8\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal{O}(\\sqrt{n})$.\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(\\sqrt n)$.\n\n\u5b9e\u9645\u5f97\u5206\uff1a$100pts$.\n\n**\u8fd9\u4e2a\u6545\u4e8b\u544a\u8bc9\u6211\u4eec\uff0c\u6e05\u534e\u96c6\u8bad\u7684\u9898\u5e76\u4e0d\u96be\uff0c\u5728\u81ea\u5df1\u64c5\u957f\u7684\u9886\u57df\u5b8c\u5168\u53ef\u4ee5\u540a\u6253\u96c6\u8bad\u961f**\u3002\uff08\u5f53\u7136\u79bb\u90a3\u4e00\u5929\u8fd8\u5f88\u9065\u8fdc\uff09\n\n```cpp\n#pragma GCC optimize(2)\n#include<bits/stdc++.h>\nusing namespace std;\n\ntypedef __int128 ll;\nconst ll MOD=19940417;\n\ninline ll read(){char ch=getchar(); int f=1; while(ch<'0' || ch>'9') {if(ch=='-') f=-f; ch=getchar();}\n\tll x=0; while(ch>='0' && ch<='9') x=(x<<3)+(x<<1)+ch-'0',ch=getchar(); return x*f;}\n\ninline void write(ll x) {\n\tif(x<0) {putchar('-');write(-x);return;}\n\tif(x<10) {putchar(char(x%10+'0'));return;}\n\twrite(x/10);putchar(char(x%10+'0'));\n} //int128 \u9700\u8981\u5feb\u8bfb\u5feb\u8f93\ninline ll sum(ll n) {return n*(n+1)/2%MOD;} //\u4e00\u7ef4\u548c\ninline ll pf(ll n) {return n*(n+1)*(2*n+1)/6%MOD;} //\u5e73\u65b9\u548c\ninline ll min(ll n,ll m) {return n<m?n:m;} //\u624b\u52a8\u6700\u5c0f\u503c\ninline ll f(ll n) {\n\tll ans=0;\n\tfor(ll l=1,r;l<=n;l=r+1) {\n\t\tr=n/(n/l);\n\t\tans=(ans+(n/l)*(sum(r)-sum(l-1))%MOD)%MOD;\n\t} //printf(\"%lld\\n\",ans);\n\treturn (n*n-ans)%MOD;\n} //\u6574\u9664\u5206\u5757\u8ba1\u7b97 f\n\ninline ll g(ll n,ll k) {\n\tll ans=0;\n\tfor(ll l=1,r;l<=k;l=r+1) {\n\t\tr=n/(n/l); r=min(r,k); //\u4fdd\u8bc1\u5757\u4e0d\u8d85\u8fc7 k\n\t\tans=(ans+(n/l)*(sum(r)-sum(l-1))%MOD)%MOD;\n\t} return ans;\n} //\u6574\u9664\u5206\u5757\u8ba1\u7b97 g\n\ninline ll h(ll n,ll m,ll k) {\n\tll ans=0;\n\tfor(ll l=1,r;l<=k;l=r+1) {\n\t\tr=min(n/(n/l),m/(m/l)); r=min(r,k); //\u4fdd\u8bc1\u5757\u4e0d\u8d85\u8fc7 k\n\t\tans=(ans+(n/l)*(m/l)%MOD*(pf(r)-pf(l-1))%MOD)%MOD;\n\t} return ans;\n} //\u6574\u9664\u5206\u5757\u8ba1\u7b97 h\n\nint main() {\n\tll n=read(),m=read(),x=min(n,m);\n\tll tot1=f(n)*f(m)%MOD; //\u539f\u672c\u7b54\u6848\n\tll tot2=(n*m*min(n,m)-n*g(m,x)-m*g(n,x)+h(n,m,x)+MOD+MOD)%MOD; //\u591a\u4f59\u7b54\u6848\n//\twrite(tot1),putchar(' '),write(tot2),putchar('\\n');\n\twrite((tot1-tot2+MOD)%MOD); //\u51cf\u6cd5\u9700\u8981\u5904\u7406\u8d1f\u6570\n\treturn 0;\n}\n\n\n```",
        "postTime": 1593175501,
        "uid": 181276,
        "name": "bifanwen",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2260 \u3010[\u6e05\u534e\u96c6\u8bad2012]\u6a21\u79ef\u548c\u3011"
    },
    {
        "content": "\u6613\u77e5\u539f\u5f0f\u4e3a\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{m}(n-i\\lfloor\\frac{n}{i}\\rfloor)(m-j\\lfloor\\frac{m}{j}\\rfloor),i \\neq j$$\n\n\u4ee4\n$$F(n)=\\sum_{i=1}^{n}(n-i\\lfloor\\frac{n}{i}\\rfloor)$$\n\n\u5219\u539f\u5f0f\u4e3a\n$$F(n)F(m)-\\sum_{i=1}^{n}(n-i\\lfloor\\frac{n}{i}\\rfloor)(m-i\\lfloor\\frac{m}{i}\\rfloor)$$\n\n$F(n)$ \u53ef\u4ee5\u6574\u9664\u5206\u5757\uff0c\u5148\u770b\u540e\u9762\n$$\\sum_{i=1}^{n}(n-i\\lfloor\\frac{n}{i}\\rfloor)(m-i\\lfloor\\frac{m}{i}\\rfloor)$$\n\n\u62c6\u62ec\u53f7\n$$\\sum_{i=1}^{n}nm-ni\\lfloor\\frac{m}{i}\\rfloor-mi\\lfloor\\frac{n}{i}\\rfloor+i^2\\lfloor\\frac{n}{i}\\rfloor\\lfloor\\frac{m}{i}\\rfloor$$\n\n\u76f4\u63a5\u6574\u9664\u5206\u5757\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\sqrt n + \\sqrt m)$\n\n$\\rm{Code}:$\n\n```cpp\n#include <iostream>\n#include <algorithm>\nconst int MOD = 19940417;\nint inv6 = 3323403;\n\nint pm(int x)\n{ return x < 0 ? x + MOD : x; }\n\nint sum1(int a, int b) // a + (a + 1) + ... + b\n{ return (1LL*(a + b)*(b - a + 1) >> 1LL)%MOD; }\n\nint sum2(int a) // 1^2 + 2^2 + 3^2 + ... + a^2\n{ return 1LL*a*(a + 1LL)%MOD*((a << 1LL) + 1LL)%MOD*inv6%MOD; }\n\nint sum2(int a, int b) // a^2 + (a + 1)^2 + (a + 2)^2 + ... + b^2\n{ return pm(sum2(b) - sum2(a - 1)); }\n\n// \u6574\u9664\u5206\u5757\u6c42 F(n) \nint solve1(int n) {\n\tint res = 1LL*n*n%MOD;\n\tfor(int i = 1, ni; i <= n; i = ni + 1) {\n\t\tni = n/(n/i);\n\t\tres = pm(res - 1LL*(n/i)*sum1(i, ni)%MOD);\n\t}\n\treturn res;\n}\n\n// \u6574\u9664\u5206\u5757\u6c42\u5269\u4e0b\u7684\u4e00\u5768 \nint solve2(int n, int m) {\n\tint res = 1LL*n*n%MOD*m%MOD;\n\tfor(int i = 1, ni; i <= n; i = ni + 1) {\n\t\tni = std::min(n/(n/i), m/(m/i));\n\t\tres = (res - 1LL*sum1(i, ni)*(m/i)%MOD*n%MOD - 1LL*sum1(i, ni)*(n/i)%MOD*m%MOD\n\t\t\t\t   + 1LL*(n/i)*(m/i)%MOD*sum2(i, ni)%MOD)%MOD;\n\t}\n\treturn pm(res);\n}\n\nint main() {\n\tint n, m, ans;\n\tstd::cin >> n >> m;\n\tif(n > m)\n\t\tstd::swap(n, m); // \u82e5\u4e0d\u4ea4\u6362\uff0c\u5728solve2\u7684m/(m/i)\u4f1aRE \n\tans = pm(1LL*solve1(n)*solve1(m)%MOD - solve2(n, m));\n\tstd::cout << ans;\n\treturn 0;\n}\n```",
        "postTime": 1592351882,
        "uid": 225734,
        "name": "derta",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2260 \u3010[\u6e05\u534e\u96c6\u8bad2012]\u6a21\u79ef\u548c\u3011"
    },
    {
        "content": "### \u5341\u5e74OI\u4e00\u573a\u7a7a\uff0c\u5fd8\u8bb0\u53d6\u6a21\u89c1\u7956\u5b97\n\n\n------------\n\n\n**\u9898\u76ee\uff1a**\n\n\u6c42\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{m} (n \\bmod i)(m \\bmod i)$$\n(\u5176\u4e2di,j\u4e0d\u76f8\u7b49)\n\n \u66b4\u529b\u62c6\u5f0f\u5b50\uff1a\n\n$$ANS=\\sum_{i=1}^{n}\\sum_{j=1}^{m} (n- \\left \\lfloor \\frac{n}{i} \\right \\rfloor*i)(m- \\left \\lfloor \\frac{m}{i} \\right \\rfloor*i)-\\sum_{i=1}^{min(n,m)} (n- \\left \\lfloor \\frac{n}{i} \\right \\rfloor *i)(m- \\left \\lfloor \\frac{m}{i} \\right \\rfloor *i)$$\n\n\u4ee4$f(n)=\\sum_{i=1}^{n} (n- \\left \\lfloor \\frac{n}{i} \\right \\rfloor *i)$\n\n\u4ee4$g(n)=\\sum_{i=1}^{n}(n- \\left \\lfloor \\frac{n}{i} \\right \\rfloor *i)(m- \\left \\lfloor \\frac{m}{i} \\right \\rfloor *i)$\n\n\u4e0d\u59a8\u8bben<=m\n\n\u5219\u6709\n\n$$ANS=f(n)*f(m)-g(n)$$\n\n\u5176\u4e2d\n$$g(n)=\\sum_{i=1}^{n} n*m-n*\\sum_{i=1}^{n} \\left \\lfloor \\frac{m}{i} \\right \\rfloor *i-m*\\sum_{i=1}^{n} \\left \\lfloor \\frac{n}{i} \\right \\rfloor *i+\\sum_{i=1}^{n} \\left \\lfloor \\frac{n}{i} \\right \\rfloor* \\left \\lfloor \\frac{m}{i} \\right \\rfloor *i^2$$\n\n\u4e14\u7531\u521d\u4e2d\u77e5\u8bc6\u6709\n$$\\sum_{i=1}^{n} i^2=\\frac{n*(n+1)*(2*n+1)}{6}$$\n\n\u7528exgcd\u9884\u5904\u74066\u5728\u6a2119940417\u610f\u4e49\u4e0b\u7684\u9006\u5143\n\n\u7136\u540e\u7528\u6570\u8bba\u5206\u5757\u628a\u4e0a\u9762\u4e00\u5806\u4e1c\u897f\u7b97\u4e00\u4e0b\u5373\u53ef\n\n \n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define writeln(x)  write(x),puts(\"\")\n#define writep(x)   write(x),putchar(' ')\nusing namespace std;\ninline int read(){\n\tint ans=0,f=1;char chr=getchar();\n\twhile(!isdigit(chr)){if(chr=='-') f=-1;chr=getchar();}\n\twhile(isdigit(chr)){ans=(ans<<3)+(ans<<1)+chr-48;chr=getchar();}\n\treturn ans*f;\n}void write(int x){\n    if(x<0) putchar('-'),x=-x;\n    if(x>9) write(x/10);\n    putchar(x%10+'0');\n}const int mod = 19940417;\nint n,m,k;\ninline void Add(int &x,int y){x+=y;x%=mod;}\nvoid exgcd(int a,int b,int &x,int &y){\n\tif(b==0)return x=1,y=0,void();\n\texgcd(b,a%b,x,y);\n\tint t=x;x=y,y=t-a/b*y;\n}int inv(int x){\n\tint xx,y;\n\texgcd(6,mod,xx,y);\n\txx=(xx%mod+mod)%mod;\n\treturn xx;\n}const int inv6=inv(6);\nint sum(int x){return (x)*(x+1)%mod*(2*x%mod+1)%mod*inv6%mod;}\nint query1(int l,int r){return ((sum(r)-sum(l-1))%mod+mod)%mod;}\nint query2(int l,int r){int ans=(r-l+1)*(l+r)/2;return ans%mod;}\nint calc1(int n){\n\tint ans=0;\n\tfor(int i=1,j,t;i<=n;i=j+1){\n\t\tj=n/(n/i);\n\t\tt=n/i*(i+j)*(j-i+1)/2;\n\t\tt%=mod;\n\t\tAdd(ans,t);\n\t}ans=n*n%mod-ans;\n\tans=(ans%mod+mod)%mod;\n\treturn ans;\n}int calc2(int k){\n\tint ans=0;\n\tfor(int i=1,j,t;i<=n;i=j+1){\n\t\tj=min(n/(n/i),m/(m/i));\n\t\tint s1=n*(m/i)%mod*query2(i,j)%mod;\n\t\tint s2=m*(n/i)%mod*query2(i,j)%mod;\n\t\tint s3=(n/i)*(m/i)%mod*query1(i,j)%mod;\n\t\tAdd(s1,s2);\n\t\tAdd(ans,s1);\n\t\tans-=s3;\n\t\tans=((ans)%mod+mod)%mod;\n\t}return ans;\n}\nsigned main(){\n\tn=read(),m=read();\n\tif(n>m)swap(n,m);\n\tint ans=calc1(n)*calc1(m)%mod;\n\tans-=n*m%mod*n%mod;\n\tans=(ans%mod+mod)%mod;\n\tans+=calc2(n);\n\tans=(ans%mod+mod)%mod;\n\tcout<<ans<<endl;\n\treturn 0;\n}\n\n\n```\n \n\n \n\n \n\n ",
        "postTime": 1571627489,
        "uid": 9287,
        "name": "LevenKoko",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2260 \u3010[\u6e05\u534e\u96c6\u8bad2012]\u6a21\u79ef\u548c\u3011"
    },
    {
        "content": "### \u9898\u9762\n\u6c42\n$$ \\sum_{i=1}^n\\sum_{j=1}^m(n~{\\rm{mod}}~i)\\times(m~{\\rm mod}~j)\\mod 19940417,i!=j $$\n$ n,m\\le10^9 $\n### \u9898\u89e3\n\u5148\u5316\u7b80\u5f0f\u5b50  \n$\\sum_{i=1}^n\\sum_{j=1}^m(n~{\\rm{mod}}~i)\\times(m~{\\rm mod}~j)$\n\n$=\\sum_{i=1}^n(n~{\\rm mod}~ i)\\sum_{j=1}^m(m~{\\rm mod}~j)$\n\n\n\n\u5b9e\u9645\u4e0a\u8fd9\u91cc\u5c31\u662f\u4e24\u4e2a\u4f59\u6570\u6c42\u548c\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u5957\u7528\u5957\u8def\u3002\n\n$=\\sum_{i=1}^n(n-i\\times\\left\\lfloor\\frac ni\\right\\rfloor)\\sum_{j=1}^m(m-j\\times\\left\\lfloor\\frac mj\\right\\rfloor)$\n\n\u5de6\u53f3\u5206\u522b\u62c9\u51fa\u6765\u6570\u8bba\u5206\u5757\u6c42\u548c\u5373\u53ef\u3002\n\n\n\n\u4f46\u662f\u8fd9\u6837\u505a\u663e\u7136\u662f\u6709\u95ee\u9898\u7684\uff0c\u6211\u4eec\u6ca1\u6709\u8003\u8651\u9898\u76ee\u4e2d\u7ed9\u51fa\u7684$i\\not=j$\u7684\u9650\u5b9a\u6761\u4ef6\u3002\n\n\u6240\u4ee5\u8003\u8651\u4e00\u4e0b$i=j$\u7684\u60c5\u51b5\uff0c\u51cf\u53bb\u8fd9\u90e8\u5206\u7684\u503c\u5c31\u884c\u4e86\u3002 \n\n\n\n\u4e5f\u5c31\u662f$\\sum_{i=1}^{\\min(n,m)}(n~{\\rm mod}~i)(m~{\\rm mod}~i)$\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf\u8d77\u89c1\uff0c\u5047\u5b9a$n\\le m$\u6210\u7acb\u3002\u518d\u6309\u7167\u4f59\u6570\u6c42\u548c\u7684\u5957\u8def\u5316\u7b80\u4e00\u4e0b\n\n$=\\sum\\limits_{i=1}^n(n-i\\times\\left\\lfloor\\frac ni\\right\\rfloor)(m-i\\times\\left\\lfloor\\frac mi\\right\\rfloor)$\n\n$=\\sum\\limits_{i=1}^n(nm-ni\\left\\lfloor\\frac mi\\right\\rfloor-mi\\left\\lfloor\\frac ni\\right\\rfloor+i^2\\left\\lfloor\\frac ni\\right\\rfloor\\left\\lfloor\\frac mi\\right\\rfloor)$\n\n$=n^2m-n\\sum\\limits_{i=1}^ni\\left\\lfloor\\frac mi\\right\\rfloor-m\\sum\\limits_{i=1}^ni\\left\\lfloor\\frac ni\\right\\rfloor+\\sum\\limits_{i=1}^ni^2\\left\\lfloor\\frac ni\\right\\rfloor\\left\\lfloor\\frac mi\\right\\rfloor$\n\n\u7136\u540e\u53ef\u4ee5\u53d1\u73b0\u540e\u4e09\u4e2a\u90fd\u53ef\u4ee5\u6570\u8bba\u5206\u5757\uff0c\u4e8e\u662f\u5c31\u53ef\u4ee5\u6bd4\u8f83\u5feb\u901f\u7684\u8ba1\u7b97\u51fa\u8fd9\u4e2a\u5f0f\u5b50\u7684\u503c\u4e86\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\n#include<string>\nusing namespace std;\ntypedef long long ll;\n#define p 19940417\n#define inv2 9970209\n#define inv3 6646806\n\nll sum1n(ll x){\n    return x*(x+1)%p*inv2%p;\n}\n\nll sum1n2(ll x){\n    return x*(x+1)%p*(2*x+1)%p*inv3%p*inv2%p;\n}\n\nll Sab(ll a,ll b){\n    return (sum1n(b)-sum1n(a-1))%p;\n}\n\nll S2ab(ll a,ll b){\n    return ((sum1n2(b)-sum1n2(a-1))%p+p)%p;\n}\n\nll f(ll n){\n    ll ans = n*n%p,i=1;\n    while(i<=n){\n        ll nxt = n/(n/i);\n        ans = ((ans-(n/i)*Sab(i,nxt))%p+p)%p;\n        i = nxt+1;\n    }\n    return ans;\n}\n\nll g(ll n,ll m){\n    //n<m\n    ll ans = n*n%p*m%p,i=1;\n    while(i<=n){\n        ll nxt = min(n/(n/i),m/(m/i));\n        ans = (ans-n*((m/i)*Sab(i,nxt)%p)%p+p)%p;\n        ans = (ans-m*((n/i)*Sab(i,nxt)%p)%p+p)%p;\n        ans = (ans+(n/i)*(m/i)%p*S2ab(i,nxt)%p+p)%p;\n        i = nxt+1;\n    }\n    return ans;\n}\n\nint main(){\n    ll n,m;cin>>n>>m;\n    if(m<n)swap(n,m);\n    ll ans = f(n)*f(m);\n    ans%=p;\n    ans-=g(n,m);\n    ans=(ans%p+p)%p;\n    cout<<ans;\n}\n```\n",
        "postTime": 1569369733,
        "uid": 74020,
        "name": "Rainy_chen",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2260 \u3010[\u6e05\u534e\u96c6\u8bad2012]\u6a21\u79ef\u548c\u3011"
    },
    {
        "content": "\u53ef\u4ee5\u8bf4\u662f\u6700\u8fd1\u505a\u7684\u51e0\u9053\u6570\u5b66\u9898\u91cc\u6bd4\u8f83\u5f31\u667a\u7684\u4e86\n\n\u57fa\u672c\u4e0a\u5c31\u662f[\u4f59\u6570\u6c42\u548c](https://www.luogu.org/problemnew/show/P2261)\u7684\u52a0\u5f3a\u7248\uff0c\u6ca1\u6709\u8bbe\u7f6e\u4ec0\u4e48\u969c\u788d\n\n$ans=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m(n\\bmod i)(m\\bmod j)-\\sum\\limits_{i=1}^{\\min(n,m)}(n\\bmod i)(m\\bmod i)$\n\n\u4e0d\u59a8\u8bb0\u4e3a$ans=a-b$\uff0c\u5206\u522b\u8ba1\u7b97\n\n$a=\\sum\\limits_{i=1}^n(n\\bmod i)\\sum\\limits_{j=1}^m(m\\bmod j)$\n\n$=\\sum\\limits_{i=1}^n(n-i\\lfloor\\frac{n}{i}\\rfloor)\\sum\\limits_{j=1}^m(m-j\\lfloor\\frac{m}{j}\\rfloor)$\n\n\u6574\u9664\u5206\u5757\u5373\u53ef\u89e3\u51b3\uff0c\u5c31\u76f8\u5f53\u4e8e\u628a\u4f59\u6570\u6c42\u548c\u8dd1\u4e24\u904d\n\n\u4e0d\u59a8\u8bbe$k=\\min(n,m)$\u90a3\u4e48\n\n$b=\\sum\\limits_{i=1}^k(n-i\\lfloor\\frac{n}{i}\\rfloor)(m-i\\lfloor\\frac{m}{i}\\rfloor)$\n\n$=\\sum\\limits_{i=1}^k(mn-mi\\lfloor\\frac{n}{i}\\rfloor-ni\\lfloor\\frac{m}{i}\\rfloor+i^2\\lfloor\\frac{n}{i}\\rfloor\\lfloor\\frac{m}{i}\\rfloor)$\n\n$=kmn-\\sum\\limits_{i=1}^k(mi\\lfloor\\frac{n}{i}\\rfloor+ni\\lfloor\\frac{m}{i}\\rfloor-i^2\\lfloor\\frac{n}{i}\\rfloor\\lfloor\\frac{m}{i}\\rfloor)$\n\n\u6574\u9664\u5206\u5757\u5373\u53ef\u89e3\u51b3\u3002\n\n\u53e6\u5916\u4e24\u4e2a\u9700\u8981\u77e5\u9053\u7684\u516c\u5f0f\uff1a\n\n$\\sum\\limits_{i=1}^ni=\\frac{n(n+1)}{2}$\n\n$\\sum\\limits_{i=1}^ni^2=\\frac{n(n+1)(2n+1)}{6}$\n\n\u524d\u8005\u4f7f\u7528\u7684\u65f6\u5019\u76f4\u63a5\u7528$\\text{long long}$\u5c31\u884c\u4e86\uff0c\u4f46\u662f\u540e\u8005\u9700\u8981\u6c42$6$\u7684\u9006\u5143\uff0c\u56e0\u4e3a\u4e09\u4e2a\u6570\u76f8\u4e58\u4f1a\u7206$\\text{long long}$\u3002\n\n```cpp\n#include <cctype>\n#include <cstdio>\n#include <climits>\n#include <algorithm>\n\ntemplate <typename T> inline void read(T& x) {\n    int f = 0, c = getchar(); x = 0;\n    while (!isdigit(c)) f |= c == '-', c = getchar();\n    while (isdigit(c)) x = x * 10 + c - 48, c = getchar();\n    if (f) x = -x;\n}\ntemplate <typename T, typename... Args>\ninline void read(T& x, Args&... args) {\n    read(x); read(args...); \n}\ntemplate <typename T> void write(T x) {\n    if (x < 0) x = -x, putchar('-');\n    if (x > 9) write(x / 10);\n    putchar(x % 10 + 48);\n}\ntemplate <typename T> inline void writeln(T x) { write(x); puts(\"\"); }\ntemplate <typename T> inline bool chkmin(T& x, const T& y) { return y < x ? (x = y, true) : false; }\ntemplate <typename T> inline bool chkmax(T& x, const T& y) { return x < y ? (x = y, true) : false; }\n\ntypedef long long LL;\n\nconst LL mod = 19940417;\n\nint n, m;\nint inv6 = 3323403;\n\ninline int s1(int l, int r) {\n    return 1ll * (l + r) * (r - l + 1) / 2 % mod;\n}\ninline int s2(int l, int r) {\n    auto f = [](int x) -> int { return 1ll * x * (x + 1) % mod * (2 * x + 1) % mod * inv6 % mod; };\n    return ((f(r) - f(l - 1)) % mod + mod) % mod;\n}\n\ninline int calc(int n) {\n    int ans = 1ll * n * n % mod;\n    for (int l = 1, r; l <= n; l = r + 1) {\n        r = n / (n / l);\n        ans = (ans - 1ll * s1(l, r) * (n / l) % mod + mod) % mod;\n    }\n    return ans;\n}\n\nint main() {\n    read(n, m);\n    int ans = 1ll * calc(n) * calc(m) % mod;\n    int mn = std::min(n, m);\n    ans = (ans - 1ll * mn * n % mod * m % mod + mod) % mod;\n    for (int l = 1, r; l <= mn; l = r + 1) {\n        r = std::min(n / (n / l), m / (m / l));\n        ans = (ans + 1ll * s1(l, r) * (1ll * n * (m / l) % mod + 1ll * m * (n / l) % mod) % mod) % mod;\n        ans = (ans - 1ll * s2(l, r) * (n / l) % mod * (m / l) % mod + mod) % mod;\n    }\n    writeln((ans % mod + mod) % mod);\n    return 0;\n}\n```\n",
        "postTime": 1555215109,
        "uid": 72071,
        "name": "GKxx",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2260 \u3010[\u6e05\u534e\u96c6\u8bad2012]\u6a21\u79ef\u548c\u3011"
    },
    {
        "content": "$$\nans=\\sum_{i=1}^n\\sum_{j=1}^m(n\\;mod\\;i)\\times(m\\;mod\\;j),i\\neq j\n$$\n\n\u6211\u4eec\u5047\u8bbe\n$$\nn\\leq m\n$$\n\n$$\n\\begin{aligned}\n\nans\n\n   & =\\sum_{i=1}^n\\sum_{j=1}^m(n\\;mod\\;i)\\times(m\\;mod\\;j),i\\neq j\n   \n\\\\ & =\\sum_{i=1}^{n}\\sum_{j=1}^m(n\\;mod\\;i)\\times(m\\;mod\\;j)-\\sum_{i=1}^n(n\\;mod\\;i)\\times(m\\;mod\\;i)    \n\n\\\\ & =\\sum_{i=1}^{n}\\sum_{j=1}^m(n-\\left\\lfloor\\dfrac{n}{i}\\right\\rfloor\\cdot i)\\times(m-\\left\\lfloor\\dfrac{m}{j}\\right\\rfloor\\cdot j)-\\sum_{i=1}^n(n-\\left\\lfloor\\dfrac{n}{i}\\right\\rfloor\\cdot i)\\times(m-\\left\\lfloor\\dfrac{m}{i}\\right\\rfloor\\cdot i)    \n\n\\\\ & =\\sum_{i=1}^{n}(n-\\left\\lfloor\\dfrac{n}{i}\\right\\rfloor\\cdot i)\\sum_{j=1}^m(m-\\left\\lfloor\\dfrac{m}{j}\\right\\rfloor\\cdot j)-\\sum_{i=1}^n(n-\\left\\lfloor\\dfrac{n}{i}\\right\\rfloor\\cdot i)\\times(m-\\left\\lfloor\\dfrac{m}{i}\\right\\rfloor\\cdot i)    \n\n\\\\ & =\\sum_{i=1}^{n}(n-\\left\\lfloor\\dfrac{n}{i}\\right\\rfloor\\cdot i)\\sum_{j=1}^m(m-\\left\\lfloor\\dfrac{m}{j}\\right\\rfloor\\cdot j)-\\sum_{i=1}^n(n\\cdot m - i\\cdot(\\left\\lfloor\\dfrac{n}{i}\\right\\rfloor\\cdot m+\\left\\lfloor\\dfrac{m}{i}\\right\\rfloor\\cdot n)+\\left\\lfloor\\dfrac{n}{i}\\right\\rfloor\\left\\lfloor\\dfrac{m}{i}\\right\\rfloor i^2)   \n\n\\end{aligned}\n$$\n\n\u7136\u540e\n\n\u524d\u9762\u7684\u7b49\u5f0f\u5148\u7528\u6570\u8bba\u5206\u5757\u7b97\u51faj\u5faa\u73af\u7684\u503c\uff0c\u7136\u540e\u7b2c\u4e8c\u6b21\u6570\u8bba\u5206\u5757\u5206i\u7684\u503c\uff0c\u4ece\u800c\u5c06\u524d\u9762\u7684\u7b49\u5f0f\u7b97\u51fa\u6765\u3002\n\n\u540e\u9762\u7684\u7b49\u5f0f\u76f4\u63a5\u6570\u8bba\u5206\u5757\n\n```cpp\nr = min(n / (n / l), m / (m / l));\n```\n\n\u6362\u4e2a\u6837\u5b50\u5c31\u53ef\u4ee5\u5206\u4e86\u3002\n\n\u7136\u540e\u8981\u7528\u5e73\u65b9\u548c\u516c\u5f0f\uff0c\u6240\u4ee5\u5f97\u5148\u628a2,6\u7684\u9006\u5143\u7b97\u51fa\u6765\n$$\n\\sum_{i=1}^ni^2=\\frac{i\\cdot(i+1)\\cdot(2\\cdot i +1)}{6}\n$$\n\u5269\u4e0b\u7684\u5c31\u6ca1\u4ec0\u4e48\u4e86\n\n```cpp\n#include<cstdio>\n#define Starseven main\n#define ll long long\nconst ll mod = 19940417;\n\nll Add(ll l, ll r) {\n\tll re = 0, ny2 = 9970209;\n\tre = (1 + r) * r % mod * ny2 % mod;\n\tre %= mod;\n\tl--;\n\tre = (re - (l + 1) * l % mod * ny2 % mod) % mod;\n\tre = (re + mod) % mod;\n\treturn re;\n}\n\nll All(ll l, ll r) {\n\tll ny6 = 3323403;\n\tll re = 0;\n\tre = r * (r + 1) % mod * ((2 * r + 1) % mod) % mod * ny6 % mod;\n\tl--;\n\tre = (re - (l * (l + 1) % mod *((2 * l + 1) % mod) % mod * ny6 % mod)) % mod;\n\tre = (re + mod) % mod;\n\treturn re; \n}\n\nint Starseven(void) {\n\tll n, m;\n\tread(n);\n\tread(m);\n\tif(n > m) swap(n, m);\n\tll ans = 0, judge = 0;\n\tfor (ll l = 1, r; l <= m; l = r + 1) {\n\t\tr = m / (m / l);\n\t\tll hack = (r - l + 1) * m % mod;\n\t\thack = (hack - (m / l) * Add(l, r) % mod) % mod;\n\t\thack = (hack + mod) % mod;\n\t\tjudge = (judge + hack) % mod;\n\t} \n\tfor (ll l = 1, r; l <= n; l = r + 1) {\n\t\tr = n / (n / l);\n\t\tll hack = (r - l + 1) * n % mod;\n\t\thack = (hack - (n / l) * Add(l, r) % mod) % mod;\n\t\thack = (hack + mod) % mod;\n\t\thack = hack * judge % mod;\n\t\tans = (ans + hack) % mod;\n\t}\n\tfor (ll l = 1, r; l <= n; l = r + 1) {\n\t\tr = min(n / (n / l), m / (m / l));\n\t\tll hack = n * m % mod * (r - l + 1) % mod;\n\t\thack += (n / l) * (m / l) % mod * All(l, r) % mod;\n\t\thack %= mod;\n\t\tll a = m * (n / l) % mod, b = n * (m / l) % mod;\n\t\thack = (hack - Add(l, r) * (a + b) % mod) % mod;\n\t\thack = (hack + mod) % mod;\n\t\tans = (ans - hack) % mod;\n\t\tans = (ans + mod) % mod;\n\t}\n\twrite(ans);\n\tputs(\"\");\n\treturn 0;\t\n}\n```\n\n",
        "postTime": 1598448029,
        "uid": 233198,
        "name": "starseven",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2834 \u3010\u80fd\u529b\u6d4b\u9a8c\u3011"
    },
    {
        "content": "![](http://m.qpic.cn/psb?/V14FBJZS3lmtUs/CDAUAsaqmef3jNHZzBxmOw7Uc762PTsn2VIryNuoJ\\*o!/b/dD8BAAAAAAAA&bo=DQOAAgAAAAADB64!&rf=viewer\\_4)\n\n\n\u4ee3\u7801\uff1a\n\n    \n```cpp\n#include <iostream>\n#include <algorithm>\n#include <cstring>\n#include <cstdio>\nusing namespace std;\n#define LL long long\nconst LL MOD=19940417;\nLL n,m,Ans=0;\ninline void solve(){\n    LL midA=0;\n    for(LL L=1,R;L<=n;L=R+1){\n        R=min(n/(n/L),n);\n        midA=(midA-(n/L)*(((L+R)*(R-L+1)%MOD)*9970209%MOD+MOD)%MOD+MOD)%MOD;\n    }\n    midA=(midA+n*n%MOD)%MOD;\n    LL midB=0;\n    for(LL L=1,R;L<=m;L=R+1){\n        R=min(m/(m/L),m);\n        midB=(midB-(m/L)*(((L+R)*(R-L+1)%MOD)*9970209%MOD+MOD)%MOD+MOD)%MOD;\n    }\n    midB=(midB+m*m%MOD)%MOD;\n    Ans=midA*midB%MOD;\n    //\u51cf\u53bb i==j \u7684\u60c5\u51b5 \n    Ans=(Ans-(n*n%MOD)*m%MOD+MOD)%MOD;\n    for(LL L=1,R;L<=n;L=R+1){ \n        R=min(n/(n/L),min(m/(m/L),n));\n        LL sum=(((L+R)*(R-L+1)%MOD)*9970209%MOD+MOD)%MOD; //\u4ece L\u52a0\u5230R\u7684\u548c\uff0c9970209\u662f2\u5728\u6a2119940417\u4e0b\u7684\u4e58\u6cd5\u9006\u5143 \n        LL sum2=(((R*(R+1)%MOD)*(2*R+1)%MOD-((L-1)*L%MOD)*(2*L-1)%MOD+MOD)%MOD)*3323403%MOD; //L\u5230R\u7684\u5e73\u65b9\u548c\uff0c3323403\u662f6\u5728\u6a2119940417\u4e0b\u7684\u4e58\u6cd5\u9006\u5143 \n        Ans=(Ans+(n*(m/L)%MOD)*sum%MOD)%MOD;\n        Ans=(Ans+(m*(n/L)%MOD)*sum%MOD)%MOD;\n        Ans=(Ans-((n/L)*(m/L)%MOD)*sum2%MOD+MOD)%MOD;\n    }\n}\nint main(){\n    scanf(\"%lld %lld\",&n,&m);\n    if(n>m) swap(n,m);\n    solve();\n    printf(\"%lld\\n\",Ans%MOD);\n    return 0;\n}\n```",
        "postTime": 1512805766,
        "uid": 28172,
        "name": "AE\u9171",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2260 \u3010\u6c42\u548cEX\u3011"
    }
]
[
    {
        "content": "[\u8bbf\u95ee\u535a\u5ba2\u83b7\u5f97\u66f4\u52a0\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/Shinomiya/p/15250193.html)  \n\n---\n\n\u539f\u9898\u94fe\u63a5\uff1a[P5336 [THUSC2016]\u6210\u7ee9\u5355](https://www.luogu.com.cn/problem/P5336)\n\n\u5728\u673a\u623f\u5927\u4f6c\u7684\u5e2e\u52a9\u4e0b\u7ec8\u4e8e\u5199\u51fa\u4e86\u8fd9\u9898\u3002\u518d\u4e00\u770b\u9898\u89e3\u533a\uff0c\u6ca1\u6709\u7c7b\u4f3c\u505a\u6cd5\uff0c\u6545\u849f\u84bb\u6765\u5206\u4eab\u4e00\u4e0b\u3002\n\n## \u9898\u610f\n\n> \u7ed9\u5b9a\u5e8f\u5217 $W_{1\\cdots n}$ \u4e0e\u5e38\u6570 $A$\u3001$B$ \uff0c\u6bcf\u6b21\u4ece\u4e2d\u9009\u53d6**\u8fde\u7eed\u7684**\u4e00\u6bb5\uff0c\u5b9a\u4e49\u6bcf\u4e00\u6bb5\u4ee3\u4ef7\u4e3a $V_k= A+B\\times(x_{\\max}-x_{\\min})^2$ \uff0c $x\\in[l,r]$ \u3002\u6bcf\u6b21\u8fdb\u884c\u9009\u53d6\u540e\uff0c\u5269\u4e0b\u7684\u90e8\u5206\u81ea\u52a8\u53d8\u4e3a\u8fde\u7eed\uff08 $x\\in [1,l)\\cup(r,n]$ \u7684\u90e8\u5206\u53d8\u4e3a\u8fde\u7eed\uff09\u3002  \n\u6c42\uff1a $\\min\\{ \\sum V_k\\}$ .   \n$n\\leq50$.\n\n## \u9898\u89e3\n\n\u6b64\u9898\u662f\u533a\u95f4 dp \u3002\n\n\u8bbe $ans(l,r)$ \u8868\u793a\u5c06 $[l,r]$ \u533a\u95f4**\u5168\u90e8\u53d6\u51fa**\u7684\u6700\u5c0f\u4ee3\u4ef7\uff0c\u4f46\u662f\u53d1\u73b0\u4ec5\u6709\u8fd9\u4e24\u7ef4\u65e0\u6cd5\u8f6c\u79fb\u3002\n\n\u56e0\u4e3a\u6bcf\u4e00\u6bb5\u7684\u4ee3\u4ef7\u4ec5\u4e0e $x_{\\max}$ \u548c $x_{\\min}$ \u6709\u5173\uff0c\u6240\u4ee5\u53ef\u4ee5\u8003\u8651\uff1a\u518d\u5f00\u4e24\u7ef4\u4e3a $dp(l,r,a,b)$ \uff0c\u8868\u793a\u533a\u95f4\u5185\uff0c\u7ecf\u8fc7\u591a\u6b21\u9009\u53d6\u540e\uff0c**\u5269\u4f59\u7684**\u6781\u503c\u5206\u522b\u4e3a a\u3001b \u7684\u4ee3\u4ef7\u3002\n\n\u90a3\u4e48\u5982\u679c\u8981\u628a $dp(l,r,a,b)$ \u4e2d\u6743\u503c\u4e3a $[a,b]$ \u7684\u8fd9\u4e00\u6bb5\u5168\u90e8\u9009\u7a7a\uff0c\u5176\u4ee3\u4ef7\u4e3a $A+B\\times(b-a)^2$ \u3002\n\n\u5219\u53ef\u4ee5\u5f97\u5230 ans \u7684\u8f6c\u79fb\u5f0f\uff1a $ans(l,r) = \\min\\{dp(l,r,a,b)+A+B\\times(b-a)^2\\}$ \uff0c $1\\le a < b \\le W_{\\max}$ .  \n\n\u63a5\u4e0b\u6765\u8003\u8651\u5982\u4f55\u8f6c\u79fb dp .\n\n\u6309\u7167\u533a\u95f4 dp \u7684\u601d\u8def\uff0c\u6211\u4eec\u9700\u8981\u5728 $[l,r]$ \u4e2d\u679a\u4e3e\u65ad\u70b9 $k$ \u3002\n\n\u5219\u6709\u5982\u4e0b\u8f6c\u79fb\uff1a\n\n$dp(l,r,a,b)=\\min\\{ans(l,k) + dp(k+1,r,a,b)\\}$ .\uff08\u5de6\u534a\u533a\u95f4\u5168\u90e8\u9009\u7a7a\uff0c\u53f3\u534a\u533a\u95f4\u5269\u4f59 $[a,b]$ \uff09 \n\n$dp(l,r,a,b)=\\min\\{dp(l,k,a,b)+ans(k+1,r)\\}$.\uff08\u5de6\u534a\u533a\u95f4\u5269\u4f59$[a,b]$\uff0c\u53f3\u534a\u533a\u95f4\u5168\u90e8\u9009\u7a7a\uff09\n\n$dp(l,r,a,b)=\\min\\{dp(l,k,a,b) + dp(k+1,r,a,b)\\}$ .\uff08\u5de6\u53f3\u533a\u95f4\u5747\u90fd\u5269\u4f59 $[a,b]$ \uff09\n\n\n\n\u6211\u4eec\u53ea\u9700\u8981\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $[l,r]$ \uff0c\u679a\u4e3e\u5176 $a,b$ \u5373\u53ef\u6c42\u51fa\u67d0\u4e00\u6bb5\u533a\u95f4\u7684\u6240\u6709\u7b54\u6848\u3002\n\n\u5173\u4e8e $dp$ \u548c $ans$ \u7684\u521d\u503c\uff0c\u5219\u663e\u7136\u6709\uff1a $ans(i,i) = A$ \uff0c $dp(i,i,1\\cdots W_i,W_i\\cdots W_{\\max}) = 0$ \u3002\n\n\n\n\u6700\u540e\uff0c\u56e0\u4e3a $W_i\\le1000$ \uff0c\u79bb\u6563\u5316\u4e00\u4e0b\u5373\u53ef\u3002\n\n\n\n\u590d\u6742\u5ea6\uff1a\u72b6\u6001\u6570\u4e3a $n^4$ \uff0c\u679a\u4e3e\u65ad\u70b9\u4e3a $O(n)$ \uff0c\u603b\u590d\u6742\u5ea6 $O(n^5)$ \uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\n\n## \u4ee3\u7801\n\n\u81ea\u8ba4\u4e3a\u7801\u98ce\u8fd8\u53ef\u4ee5 QwQ \n\n\u628a\u5feb\u8bfb\u548c\u5b8f\u5b9a\u4e49\u53bb\u6389\u4e86\u3002\n\n```cpp\nint n,m,A,B;\nint w[N],dsc[N];\nll ans[N][N],dp[N][N][N][N];\nvoid dfs(int l,int r){\n\tif(l > r)return;\n\tif(ans[l][r] != ans[0][0]) return;//\u8fd9\u91cc\u5e94\u8be5\u662f\u5224\u65adans[l][r] == INF\u7684\uff0c\u4f46\u662f\u6211\u4e0d\u77e5\u9053 long long \u4e0b\u7684 0x3f3f... \u662f\u591a\u5c11 qwq\n\tfor(int a = 1 ; a <= m ; a ++)\n\t\tfor(int b = a ; b <= m ; b ++){\n\t\t\tfor(int k = l ; k < r ; k ++)\n\t\t\t\tdfs(l,k),dfs(k+1,r),\n\t\t\t\tdp[l][r][a][b] = min(dp[l][r][a][b],ans[l][k] + dp[k+1][r][a][b]),\n\t\t\t\tdp[l][r][a][b] = min(dp[l][r][a][b],dp[l][k][a][b] + ans[k+1][r]),\n\t\t\t\tdp[l][r][a][b] = min(dp[l][r][a][b],dp[l][k][a][b] + dp[k+1][r][a][b]),\n\t\t\tans[l][r] = min(ans[l][r],dp[l][r][a][b] + A + B *(dsc[b]-dsc[a])*(dsc[b]-dsc[a]));\n\t\t}\n}\nsigned main(){\n\tmemset(ans,0x3f,sizeof(ans)),memset(dp,0x3f,sizeof(dp));\n\tn = read() , A = read() , B = read();\n\tfor(int i = 1 ; i <= n ; i ++)\n\t\tdsc[i] = w[i] = read();\n\tsort(dsc+1,dsc+n+1);\n\tm = unique(dsc+1,dsc+n+1)-dsc-1;\n\tfor(int i = 1 ; i <= n ; i ++)\n\t\tw[i] = lower_bound(dsc+1,dsc+m+1,w[i]) - dsc;//\u79bb\u6563\u5316\n\tfor(int i = 1 ; i <= n ; i ++){//\u521d\u503c\n\t\tans[i][i] = A;\n\t\tfor(int j = 1 ; j <= w[i] ; j ++)\n\t\t\tfor(int k = w[i] ; k <= m ; k ++)\n\t\t\t\tdp[i][i][j][k] = 0;\n\t}\n\tdfs(1,n);//\u8fd9\u91cc\u6211\u5199\u6210\u4e86\u8bb0\u641c\uff0c\u611f\u89c9\u8bb0\u641c\u66f4\u597d\u5199\n\tprintf(\"%lld\",ans[1][n]);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1631239988,
        "uid": 88028,
        "name": "LastOrder_",
        "ccfLevel": 6,
        "title": "P5336-[THUSC2016]\u6210\u7ee9\u5355 \u9898\u89e3"
    },
    {
        "content": "[blog\u5185\u4f53\u9a8c\u66f4\u4f73](https://blog.csdn.net/qq_38944163/article/details/100824707)\n\n# \u5927\u610f\n\n\u5c31\u662f\u7ed9\u51fa\u4e00\u4e2a\u5e8f\u5217 $a[1...n]$\u8fd8\u6709$A$\u548c$B$\n\n\u6bcf\u6b21\u4ece\u5e8f\u5217\u91cc\u62bd\u51fa\u8fde\u7eed\u7684\u4e00\u6bb5\uff0c\u8fd9\u4e00\u6bb5\u7684\u4ee3\u4ef7\u4e3a\n\n$A + B * (max - min) ^ 2$\n\n___\n\u4e0b\u9762\u7ed9\u4e2a\u6837\u4f8b\u89e3\u91ca\uff1a\n\n$A = 3, B = 1$\n\n\u539f\u5e8f\u5217\u4e3a\n\n7 10 9 10 6 7 10 7 1 2\n\n\u9996\u5148\u628a[5, 6]\u8fd9\u4e2a\u533a\u95f4\u62ff\u51fa\u6765\uff0c\u4ee3\u4ef7\u4e3a $A + B * (7 - 6)^2 = 3 + 1 = 4$\n\n\u5e8f\u5217\u53d8\u4e3a\n\n7 10 9 10 10 7 1 2\n\n\u7136\u540e\u518d\u628a[2,5]\u53d6\u51fa\u6765\uff0c\u4ee3\u4ef7\u4e3a$A + B *(10-9)^2 = 3 + 1 = 4$\n\n\u5e8f\u5217\u53d8\u4e3a\n\n7 7 1 2\n\n\u518d\u628a[1,2]\u53d6\u51fa\u6765\uff0c\u4ee3\u4ef7\u4e3a$A + B *(7 - 7)^2 = 3 + 0 = 3$\n\n\u5e8f\u5217\u53d8\u4e3a\n\n1 2\n\n\u6700\u540e\u628a[1,2\u53d6\u51fa\u6765\uff0c\u4ee3\u4ef7\u4e3a$A + B*(2 - 1)^2 = 3 + 1 = 4$\n\n\n\u6700\u7ec8\u4ee3\u4ef7\u548c\u4e3a$4 + 4 + 3 + 4 = 15$\n\n___\n# \u9898\u89e3\n\u4e00\u770b\u5c31\u77e5\u9053\u662f\u533a\u95f4dp\n\n\u8bbe$f[l][r][x][y]$\u8868\u793a\u533a\u95f4$[l,r]$\u6ca1\u53d6\u8d70\u7684\u5f53\u4e2d\u6700\u5927\u7684\u662f$y$,\u6700\u5c0f\u7684\u662f$x$\u7684\u6700\u5c0f\u4ee3\u4ef7\n\n\u7136\u540e\u8f6c\u79fb\u5c31\u5f88\u5bb9\u6613\u5199\u4e86\n\n\u5206\u4e24\u79cd\u60c5\u51b5\n\n1\u3001$r$\u548c$[l, r-1]$\u5408\u5e76\uff0c\u5373$f[l][r][min(x,a[r])][max(y,a[r]) = f[l][r-1][x][y]$\n\n2\u3001\u679a\u4e3e\u4e00\u4e2ak\uff0c\u7136\u540e\u5206\u6210\u4e24\u6bb5\n\n\u5177\u4f53\u770b\u4ee3\u7801\u5427\uff1a\n\ncode:\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint f[55][55][55][55], g[55][55], a[55], b[55], n, A, B;\nsigned main(){\n\tmemset(f, 0x3f, sizeof f), memset(g, 0x3f, sizeof g); \n\tscanf(\"%lld\", &n);\n\tscanf(\"%lld%lld\", &A, &B);\n\tfor(int i = 1; i <= n; i ++) scanf(\"%lld\", &a[i]), b[i] = a[i];\n\tsort(b + 1, b + 1 + n);\n\tint m = unique(b + 1, b + 1 + n) - b - 1;\n\tfor(int i = 1; i <= n; i ++) a[i] = lower_bound(b + 1, b + 1 + m, a[i]) - b, f[i][i][a[i]][a[i]] = 0, g[i][i] = A;//\u79bb\u6563\u5316\n\tfor(int len = 1; len <= n; len ++){\n\t\tfor(int l = 1; l + len - 1 <= n; l ++){\n\t\t\tint r = l + len - 1;\n\t\t\tfor(int x = 1; x <= m; x ++)\t\n\t\t\t\tfor(int y = x; y <= m; y ++){\n\t\t\t\t\tf[l][r][min(x, a[r])][max(y, a[r])] = min(f[l][r][min(x, a[r])][max(y, a[r])], f[l][r - 1][x][y]);//\u8f6c\u79fb1\n\t\t\t\t\tfor(int k = l; k < r; k ++)\n\t\t\t\t\t\tf[l][r][x][y] = min(f[l][r][x][y], f[l][k][x][y] + g[k + 1][r]);//\u8f6c\u79fb2\n\t\t\t\t}\n\t\t\tfor(int x = 1; x <= m; x ++)\t\n\t\t\t\tfor(int y = x; y <= m; y ++)\n\t\t\t\t\tg[l][r] = min(g[l][r], f[l][r][x][y] + A + B * (b[y] - b[x]) * (b[y] - b[x]));//\u8bb0\u5f55\u5c0f\u4ee3\u4ef7\n\t\t}\n\t}\n\tprintf(\"%lld\", g[1][n]);\n\treturn 0;\n}\n```\n# \u5751\u70b9\n\u79bb\u6563\u5316",
        "postTime": 1568432900,
        "uid": 31656,
        "name": "lomit",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P5336 \u3010[THUSC2016]\u6210\u7ee9\u5355\u3011"
    },
    {
        "content": "### \u4f20\u9001\u95e8\n[\u6d1b\u8c37P5336](https://www.luogu.com.cn/problem/P5336)\n\n[\u53ef\u80fd\u66f4\u597d\u7684\u4f53\u9a8c](https://www.cnblogs.com/tqxboomzero/p/14035992.html)\n\n---\n\n\n\u5bb9\u6613\u53d1\u73b0\u8fd9\u662f\u9053\u533a\u95f4DP\u9898\u76ee\uff0c\u4e8e\u662f\u8d70\u6d41\u7a0b\uff1a\n\n### \u4e00.\u5b9a\u4e49\u72b6\u6001\n\n- \u6839\u636e\u7b54\u6848\uff0c\u8003\u8651 $f[l][r]$ \u8868\u793a\u533a\u95f4 $[l,r]$ \u4e2d\u7684\u6210\u7ee9\u5355\u5168\u90e8\u88ab\u53d1\u653e\u9700\u8981\u7684\u6700\u5c0f\u4ee3\u4ef7\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f $f[1][n]$ \u3002\n\n- \u4f46\u662f\u8fd9\u9053\u9898\u76ee\u7684\u53d1\u653e\u6210\u7ee9\u5355\u65b9\u5f0f\u6bd4\u8f83\u5947\u5999\uff0c\u53d1\u653e\u4e00\u6bb5\u533a\u95f4\u53ef\u80fd\u53ef\u4ee5\u5148\u5728\u533a\u95f4\u4e2d\u968f\u610f\u9009\u62e9\u4e00\u4e9b\u90e8\u5206\u6765\u53d1\u653e\uff0c\u518d\u5c06\u5269\u4e0b\u7684\u90e8\u5206\u53d1\u653e\u3002\n\n- \u6ce8\u610f\u5230\u5206\u53d1\u4ee3\u4ef7\u53ea\u4e0e\u4e00\u6bb5\u533a\u95f4\u4e2d\u5206\u6570\u7684 $max$ \u4e0e $min$ \u6709\u5173\uff0c\u4e8e\u662f\u6211\u4eec\u4ee4 $g[l][r][mn][mx]$ \u4e3a\u533a\u95f4 $[l,r]$ \u4e2d\u7684\u6240\u6709\u6210\u7ee9\u5355\u53d1\u653e\u4e00\u90e8\u5206\u540e\u5269\u4e0b\u7684\u6210\u7ee9\u5355\u7684\u5206\u6570\u6700\u5927\u503c\u4e3a $mx$ \uff0c\u6700\u5c0f\u503c\u4e3a $mn$ \u65f6\u7684\u6700\u5c0f\u4ee3\u4ef7\n\n- \u4e8e\u662f\u6709\n\n$$\nf[l][r]=min(g[l][r][mn][mx]+a+b*(mx-mn)^2)\n$$\n\n---\n### \u4e8c.\u72b6\u6001\u8f6c\u79fb\n- \u8003\u8651$g[l][r][mn][mx]$\u52a0\u5165\u65b0\u6210\u7ee9\u5355 $r+1$ \u65f6\u7684\u8f6c\u79fb\uff1a\n\n- 1.\u4fdd\u7559\u7b2c$r+1$\u5f20\u6210\u7ee9\u5355\u4e0d\u53d6\u8d70\uff0c\u672a\u6765\u4e0e $[l,r]$ \u4e2d\u7684\u6210\u7ee9\u5355\u5171\u540c\u53d6\u8d70\uff1a\n$$\ng[l][r+1][min(mn,w[r+1])][max(mx.w[r+1])]\n=min(g[l][r][mn][mx])\n$$\n\n- 2.\u679a\u4e3e $k$\uff0c\u5c06 $[r+1,k]$ \u8fd9\u6bb5\u533a\u95f4\u7684\u6210\u7ee9\u5355\u5171\u540c\u53d6\u8d70\n$$\ng[l][k][mn][mx]=min(g[l][r][mn][mx]+f[r+1][k])\n$$\n- \u6ce8\u610f\u5230\u7b2c\u4e00\u4e2a\u8f6c\u79fb\u662f\u586b\u8868\uff0c\u7b2c\u4e8c\u4e2a\u8f6c\u79fb\u662f\u5237\u8868\n\n- \u4e8e\u662f\u5c06\u7b2c\u4e8c\u4e2a\u8f6c\u79fb\u7a0d\u5fae\u53d8\u5316\u4e00\u4e0b\u53d8\u5316\u6210\n$$\ng[l][r][mn][mx]=min(g[l][k][mn][mx]+f[k+1][r])\n$$\n\n- \u518d\u5728\u533a\u95f4DP\u679a\u4e3e$len$\u65f6\u4ece1\u5f00\u59cb\u679a\u4e3e\u5373\u53ef\n\n---\n\n\n### \u4e09\u3001\u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=55;\nint n,a,b,w[N],f[N][N],g[N][N][N][N],d[N];\nint tot;\nint main(){\n\tscanf(\"%d%d%d\",&n,&a,&b);\n\tfor(int i=1;i<=n;++i) scanf(\"%d\",&w[i]),d[i]=w[i];\n\tsort(d+1,d+n+1);tot=unique(d+1,d+n+1)-d-1;\n\tfor(int i=1;i<=n;++i) w[i]=lower_bound(d+1,d+tot+1,w[i])-d,f[i][i]=a;\n\tmemset(g,0x3f,sizeof(g));memset(f,0x3f,sizeof(f));\n\tfor(int i=1;i<=n;++i)g[i][i][w[i]][w[i]]=0;\n\tfor(int len=1;len<=n;++len)\n\t\tfor(int l=1,r=len;r<=n;++l,++r)\n\t\t\tfor(int mn=1;mn<=tot;++mn)\n\t\t\t\tfor(int mx=mn;mx<=tot;++mx){\n\t\t\t\t\tint &G=g[l][r][mn][mx];\n\t\t\t\t\tfor(int k=l;k<r;++k)\tG=min(g[l][k][mn][mx]+f[k+1][r],G);\n\t\t\t\t\tint &gg=g[l][r+1][min(mn,w[r+1])][max(mx,w[r+1])];\n\t\t\t\t\tgg=min(gg,G);f[l][r]=min(f[l][r],G+a+b*(d[mx]-d[mn])*(d[mx]-d[mn]));\n\t\t\t\t}\n\tprintf(\"%d\\n\",f[1][n]);\n}\n```",
        "postTime": 1606286959,
        "uid": 66831,
        "name": "T_Q_X",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5336 \u3010[THUSC2016]\u6210\u7ee9\u5355\u3011"
    },
    {
        "content": "\n## [\u6d1b\u8c37\u539f\u9898](https://www.luogu.org/problem/P5336)\n\n~~\u8fd9\u662f\u849f\u84bb\u5199\u7684\u7b2c\u4e00\u7bc7\u9ed1\u9898\u7684\u9898\u89e3~~\n\n\u672c\u9898\u89e3\u521d\u53d1\u4e8e[\u6211\u7684blog](https://wangjunrui666.github.io)\n\n\u8fd9\u9898\u6709\u591a\u4e2a\u8f6c\u79fb\u7684\u65b9\u7a0b\uff0c\u4e00\u4e0b\u6211\u6162\u6162\u53d9\u8ff0\n\n\u8fd9\u9898\u5f88\u660e\u663e\u53ef\u4ee5\u5141\u8bb8\u4e00\u4e2a$O(n^5)$\u7684\u590d\u6742\u5ea6\uff0c\n$O(n^6)$\u5f88\u5e38\u6570\u4e00\u5927\u5c31\u5f88\u53ef\u80fd\u8d85\u65f6\uff0c\n\n\u6211\u4eec\u7528\u4e00\u4e2a\u56db\u7ef4\u6570\u7ec4$f[i][j][l][r]$\u8868\u793a\u628a $i$ \u5230 $j$ \u4e4b\u95f4\u7684\u503c\u79bb\u6563\u5316\u540e\u5728\u53d6\u4e00\u4e9b\u6570(\u53ef\u4ee5\u4e0d\u53d6)\u5728 $[l,r]$ \u4e4b\u95f4\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n\u5f88\u660e\u663e\uff0c\u6211\u4eec\u53ef\u4ee5\u5206\u4e24\u79cd\u60c5\u51b5\n\n$l=r=0$  \u548c  $l \\neq 0 $ \u6216 $r \\neq 0 $\n\n\u5bf9\u4e8e$l=r=0$ \u7684\u60c5\u51b5\n\n\u6211\u4eec\u53ef\u4ee5\u90fd\u53d6\u5b8c\uff0c\u4e5f\u53ef\u4ee5\u5148\u4e0d\u53d6\u8fd9\u4e00\u4e2a\u533a\u95f4\u3002\n\n\u5219 $f[i][j][0][0]=min(a+b * (max_{k=i}^{j}-min_{k=i}^{j})^{2},min_{x=1}^{tot} min_{y=x}^{tot}(w[y]-w[x])^{2})  $\n\n\u5bf9\u4e8e$l \\neq 0 $ \u6216 $r \\neq 0 $ \u7684\u60c5\u51b5\n\n\u6211\u4eec\u53ef\u4ee5\u5206\u4e3a\u56db\u79cd\u60c5\u51b5\n\n\u5982\u679c$i=j$ \u65f6\uff0c\u5f88\u660e\u663e\u533a\u95f4\u53ea\u6709\u4e00\u4e2a\u6570\uff0c\u5f53$l\\leq w[i]$(\u79bb\u6563\u5316\u540e\u7684\u503c)$\\leq r$\uff0c\u4ee3\u4ef7\u4e3a $0$ \uff0c\u5426\u5219\u4e3a$INF$\u3002\n\n\u5982\u679c$i \\neq j$ \u65f6\uff0c\u8fd9\u6709\u679a\u4e3e\u4e2d\u95f4\u8f6c\u79fb\u8282\u70b9\uff0c\n\n\u6709\u4e09\u79cd\u60c5\u51b5\uff0c\u5206\u522b\u662f\uff1a\n\n\u5de6\u533a\u95f4\u53d6\u800c\u53f3\u533a\u95f4\u4e0d\u53d6\n\n\u5de6\u533a\u95f4\u4e0d\u53d6\u800c\u53f3\u533a\u95f4\u53d6\n\n\u5de6\u533a\u95f4\u4e0d\u53d6\u800c\u53f3\u533a\u95f4\u4e0d\u53d6\n\n\u5219 $f[i][j][l][r]=min_{k=i}^{j-1}min(f[i][k][0][0]+f[k+1][j][l][r],f[i][k][l][r]+f[k+1][j][0][0],f[i][k][l][r]+f[k+1][j][l][r])$ \n\n\n\u4ee3\u7801\u5b9e\u73b0\uff1a\n```cpp\n#include<cstdio>\n#include<algorithm>\n#define re register\nusing namespace std;\ntemplate<typename T>\ninline void read(T&x)\n{\n\tx=0;\n\tchar s=getchar();\n\tbool f=false;\n\twhile(!(s>='0'&&s<='9'))\n\t{\n\t\tif(s=='-')\n\t\t\tf=true;\n\t\ts=getchar();\n\t}\n\twhile(s>='0'&&s<='9')\n\t{\n\t\tx=(x<<1)+(x<<3)+s-'0';\n\t\ts=getchar();\n\t}\n\tif(f)\n\t\tx=(~x)+1;\n\treturn;\n}\nconst int N=56,INF=0x3f3f3f3f;\nint n,a,b,f[N][N][N][N],w[N],p[N],tot,c[N];//w[i]\u662f\u79bb\u6563\u5316\u540e\u7684\u503c\uff0cc[i]\u662f\u79bb\u6563\u5316\u524d\u7684\u503c\uff0cp[i]\u662f\u53bb\u91cd\u540e\u7684\u503c \nbool vis[N][N][N][N];\ninline int dp(int i,int j,int l,int r)\n{\n\tint &ans=f[i][j][l][r];\n\tif(vis[i][j][l][r])\n\t\treturn ans;\n\tvis[i][j][l][r]=true;\n\tans=INF;\n\tif(!l&&!r)\n\t{\n\t\tre int x=-INF,y=INF;\n\t\tfor(re int k=i; k<=j; k++)\n\t\t{\n\t\t\tx=max(x,c[k]);\n\t\t\ty=min(y,c[k]);\n\t\t}\n\t\tans=min(ans,a+b*(x-y)*(x-y));\n\t\tfor(x=1; x<=tot; x++)\n\t\t\tfor(y=x; y<=tot; y++)\n\t\t\t\tans=min(ans,dp(i,j,x,y)+a+b*(p[y]-p[x])*(p[y]-p[x]));\n\t\treturn ans;\n\t}\n\telse\n\t{\n\t\tif(i==j)\n\t\t{\n\t\t\tif(l<=w[i]&&w[i]<=r)\n\t\t\t\tans=0;\n\t\t\treturn ans;\n\t\t}\n\t\tfor(re int k=i; k<j; k++)\n\t\t\tans=min(min(ans,dp(i,k,l,r)+dp(k+1,j,l,r)),min(dp(i,k,0,0)+dp(k+1,j,l,r),dp(i,k,l,r)+dp(k+1,j,0,0)));\n\t\treturn ans;\n\t}\n}\nint main()\n{\n\tread(n);\n\tread(a);\n\tread(b);\n\tfor(re int i=1; i<=n; i++)\n\t{\n\t\tread(p[i]);\n\t\tc[i]=w[i]=p[i];\n\t}\n\tsort(p+1,p+1+n);\n\ttot=unique(p+1,p+1+n)-p-1;\n\tfor(re int i=1; i<=n; i++)\n\t\tw[i]=lower_bound(p+1,p+1+tot,c[i])-p;\n\t/*for(re int i=1; i<=tot; i++)\n\t\tprintf(\"%d \",p[i]);\n\tputchar('\\n');*/\n\t/*for(re int i=1; i<=n; i++)\n\t\tprintf(\"%d\\n\",w[i]);*/\n\tprintf(\"%d\\n\",dp(1,n,0,0));\n\treturn 0;\n}\n\n```\n",
        "postTime": 1566615869,
        "uid": 133322,
        "name": "QwQ\u849f\u84bbwjr",
        "ccfLevel": 7,
        "title": "P5336 [THUSC2016]\u6210\u7ee9\u5355 \u9898\u89e3"
    },
    {
        "content": "\u7ecf\u5178\u7684\u533a\u95f4\u6d88\u9664\u95ee\u9898\n\n\u6211\u4eec\u8003\u8651\u4ee5\u4e00\u4e2a\u533a\u95f4\u4f5c\u4e3a\u5b50\u95ee\u9898\uff0c\u8bbe $f[l , r]$ \u8868\u793a\u5c06\u533a\u95f4 $[l , r]$ \u5168\u90e8\u6e05\u9664\u7684\u6700\u5c0f\u4ee3\u4ef7\n\n\u5047\u8bbe\u5f53\u524d\u533a\u95f4 $[l , r]$ \u5e76\u6ca1\u6709\u88ab\u5b8c\u5168\u6d88\u9664\uff0c\u90a3\u4e48\u533a\u95f4 $[l , r]$ \u4e00\u5b9a\u662f\u82e5\u5e72\u4e2a\u8fde\u7eed\u7684\u533a\u95f4\u88ab\u6d88\u9664\u4e86\n\n\u6211\u4eec\u7528 0 \u8868\u793a\u6ca1\u6709\u88ab\u6d88\u9664\uff0c1 \u8868\u793a\u5df2\u7ecf\u88ab\u6d88\u9664\u4e86\uff0c\u90a3\u4e48\u533a\u95f4 $[l , r]$ \u7684\u6d88\u9664\u60c5\u51b5\u5c31\u6709\u53ef\u80fd\u8868\u793a\u6210\u8fd9\u4e2a\u6837 ``` 01111100111011111``` \n\n\u6211\u4eec\u8003\u8651\u533a\u95f4 $[l , r]$ \u6700\u540e\u4e00\u6b21\u88ab\u6d88\u9664\u7684\u5143\u7d20\u662f\u54ea\u4e00\u4e9b\uff0c\u80af\u5b9a\u662f\u5f53\u524d\u5269\u4e0b\u7684\u6ca1\u6709\u88ab\u6d88\u9664\u7684\u5143\u7d20\n\n\u76f4\u63a5\u5730\uff0c\u6211\u4eec\u60f3\u5230\u66b4\u529b\u679a\u4e3e\u6240\u6709\u53ef\u80fd\u7684 01 \u5e8f\u5217\uff0c\u4f46\u662f\u60c5\u51b5\u5b9e\u5728\u662f\u592a\u591a\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u8f85\u52a9\u6570\u7ec4 $g$ \u8f85\u52a9\u8f6c\u79fb\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u77e5\u9053\u5269\u4e0b\u7684\u5143\u7d20\u662f\u54ea\u4e00\u4e9b\uff0c\u6211\u4eec\u53ea\u9700\u8981\u77e5\u9053\u4ed6\u4eec\u7684\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u8bbe $g[l , r , mx , mn]$ \u8868\u793a\u5c06\u533a\u95f4 $[l , r]$ \u6d88\u9664\u4e00\u4e9b\u5143\u7d20\u5e76\u4e14\u5269\u4e0b\u5143\u7d20\u7684\u6700\u5927\u503c\u4e3a $mx$ \uff0c\u6700\u5c0f\u503c\u4e3a $mn$ \u7684\u6700\u5c0f\u82b1\u8d39\n\n\u8f6c\u79fb\u7684\u8fc7\u7a0b\u6211\u4eec\u53ef\u4ee5\u62bd\u8c61\u6210\u586b 01 \u5e8f\u5217\u7684\u8fc7\u7a0b    \u3002\u6211\u4eec\u53ef\u4ee5\u8ba9\u5f53\u524d\u53f3\u7aef\u70b9 $r$ \u548c\u4e2d\u95f4\u70b9 $k$ \u5f62\u6210\u4e00\u6bb5 1 \uff0c\u4ee3\u4ef7\u4e3a $f[l , r]$ \u4e5f\u53ef\u4ee5\u8003\u8651\u8ba9 $r$ \u8fd9\u4e2a\u4f4d\u7f6e\u53d8\u6210 0\n\n\u6211\u4eec\u91c7\u53d6\u679a\u4e3e\u4e0a\u4e00\u4e2a\u72b6\u6001\u7684 $mx$ \u548c $mn$ \u503c\uff0c\u6709\uff1a\n\n$$tmp = min(g[l , k , mx , mn] + f[k + 1 , r])$$\n\n$$g[l , r , max(mx , w[r]) , min(mn , w[r])] = min(g[l , r - 1 , mx , mn] , tmp)$$\n\n$$f[l , r] = min(g[l , r , mx , mn] + b * (mx - mn) ^ 2 + a)$$\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n\nusing namespace std;\n\nconst int N = 55;\n\ninline int du(void){\n    int x = 0 , f = 1;\n    char ch = getchar();\n    while(ch > '9' || ch < '0'){if(ch == '-')f = -1;ch = getchar();}\n    while(ch >= '0' && ch <= '9'){x = x * 10  + ch - '0';ch = getchar();}\n    return x * f;\n}\ninline void write(int x){\n    if(x < 0){putchar('-');x = -x;}\n    if(x > 9)write(x / 10);\n    putchar(x % 10 ^ 48);\n    return;\n}\n\nint n , a , b , w[N] , c[N] , B[N];\nint f[N][N] , g[N][N][N][N];\n\nint main(void){\n\n    scanf(\"%d%d%d\" , &n , &a , &b);\n\n    for(int i = 1 ; i <= n ; ++ i){\n        scanf(\"%d\" , &w[i]) , B[i] = w[i];\n    }\n\n    sort(B + 1 , B + 1 + n);\n\n    int m = unique(B + 1 , B + 1 + n) - B - 1;\n\n    for(int i = 1 ; i <= n ; ++ i){\n        int tmp = lower_bound(B + 1 , B + 1 + m , w[i]) - B;\n        c[tmp] = w[i] , w[i] = tmp;\n    }\n\n    memset(g , 0x3f , sizeof(g)) , memset(f , 0x3f , sizeof(f));\n\n    for(int i = 1 ; i <= n ; ++ i){\n        f[i][i] = a , g[i][i][w[i]][w[i]] = 0;\n    }\n\n    for(int Len = 2 ; Len <= n ; ++ Len){\n        for(int l = 1 ; l + Len - 1 <= n ; ++ l){\n            int r = l + Len - 1;\n            for(int mx = 1 ; mx <= n ; ++ mx)\n                for(int mn = 1 ; mn <= mx ; ++ mn){\n                    g[l][r][max(mx , w[r])][min(mn , w[r])] = min(g[l][r][max(mx , w[r])][min(mn , w[r])] , g[l][r - 1][mx][mn]);\n                    for(int k = l ; k < r ; ++ k){\n                        g[l][r][mx][mn] = min(g[l][r][mx][mn] , g[l][k][mx][mn] + f[k + 1][r]);\n                    }\n                }\n            for(int mx = 1 ; mx <= n ; ++ mx)\n                for(int mn = 1 ; mn <= mx ; ++ mn)\n                    f[l][r] = min(f[l][r] , g[l][r][mx][mn] + (c[mx] - c[mn]) * (c[mx] - c[mn]) * b + a);\n        }\n    }\n\n    printf(\"%d\" , f[1][n]);\n\n    return 0;\n\n}\n```\n",
        "postTime": 1650789805,
        "uid": 120017,
        "name": "JeffZhao",
        "ccfLevel": 0,
        "title": "[THUSC2016]\u6210\u7ee9\u5355\u9898\u89e3"
    },
    {
        "content": "\u601d\u60f3\u548c CF1107E \u4ee5\u53ca UVA10559 \u51e0\u4e4e\u76f8\u540c\u3002\n\n\u5148\u79bb\u6563\u5316\u3002\n\n\u8bbe $f_{l,r,mi,mx}$ \u4e3a\u533a\u95f4 $[l,r]$\uff0c\u5728 $[l,r]$ \u53f3\u8fb9\u8fd8\u80fd\u591f\u548c $r$ \u63a5\u4e0a\u7684\u90a3\u4e00\u5768\u4e2d\uff0c\u6700\u5927\u4e3a $mx$ \u6700\u5c0f\u4e3a $mi$ \u7684\u7b54\u6848\u3002\n\n\u8f6c\u79fb\u5206\u4e24\u79cd\uff1a\n\n- \u76f4\u63a5\u628a $r$ \u4ee5\u53ca $mi,mx$ \u6d88\u6389\uff1b\n- \u679a\u4e3e\u65ad\u70b9 $l\\le k<r$\uff0c\u5148\u6d88\u6389 $[k+1,r)$ \u518d\u628a $r$ \u548c $[l,r]$ \u63a5\u4e0a\u3002\n\n\u8fb9\u754c\u662f $l=r$ \u7684\u65f6\u5019\u76f4\u63a5\u5220\u5b8c\u3002\u7b54\u6848\u662f $f_{1,n,n,1}$\uff08\u8868\u793a\u53f3\u8fb9\u6ca1\u4e1c\u897f\uff09\n\n\u4ee3\u7801\uff08\u5e94\u8be5\u662f\u76ee\u524d\u6700\u77ed\uff09\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,A,B,a[55],b[55],f[55][55][55][55];\nint pw2(int x){\n\treturn x*x;\n}\nint dp(int l,int r,int mi,int mx){\n\tif(l>r)return 0;\n\tif(l==r)return A+B*pw2(b[max(mx,a[l])]-b[min(mi,a[l])]);\n\tint &ans=f[l][r][mi][mx];\n\tif(ans<1e9)return ans;\n\tfor(int i=l;i<r;i++)ans=min(ans,dp(l,i,min(mi,a[r]),max(mx,a[r]))+dp(i+1,r-1,n,1));\n\tans=min(ans,dp(l,r-1,n,1)+A+B*pw2(b[max(mx,a[r])]-b[min(mi,a[r])]));\n\treturn ans;\n}\nint main() {\n\tmemset(f,0x3f,sizeof(f));\n\tcin>>n>>A>>B;\n\tfor(int i=1;i<=n;i++)cin>>a[i],b[i]=a[i];\n\tsort(b+1,b+n+1);\n\tfor(int i=1;i<=n;i++)a[i]=lower_bound(b+1,b+n+1,a[i])-b;\n\tcout<<dp(1,n,n,1);\n\treturn 0;\n}\n```",
        "postTime": 1604931311,
        "uid": 42156,
        "name": "feecle6418",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5336 \u3010[THUSC2016]\u6210\u7ee9\u5355\u3011"
    },
    {
        "content": "> \u6d1b\u8c37 P5336\n\n> \u9898\u610f\uff1a\u6709 $n$ \u4e2a\u6570 $w_1,w_2,\\dots,w_n$\uff0c\u548c\u4e24\u4e2a\u8ba1\u5206\u7cfb\u6570 $a,b$\uff0c\u6bcf\u6b21\u4f60\u53ef\u4ee5\u9009\u62e9\u4e00\u4e2a\u8fde\u7eed\u7684\u533a\u95f4 $[l,r]$ \u5c06\u5b83\u4eec\u5220\u53bb\uff0c\u9700\u8981 $a+b \\times (\\max\\limits_{i=l}^ra_i-\\min\\limits_{i=l}^ra_i)$\u540e\u9762\u7684\u6570\u4f1a\u81ea\u52a8\u5411\u524d\u79fb\u3002\u6c42\u6d88\u9664\u5b8c\u8fd9\u4e9b\u6570\u9700\u8981\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n> $1 \\leq n \\leq 50$\uff0c$1 \\leq w_i \\leq 1000$\n\n\u5176\u5b9e\u4e5f\u6ca1\u6709\u9ed1\u9898\u5427\u2026\u2026\u2026\u2026/fad\n\n\u4e00\u770b\u5c31\u77e5\u9053\u533a\u95f4 $dp$\uff0c\u53ef\u662f\u6211\u60f3\u4e86\u534a\u5929\u90fd\u6ca1\u60f3\u51fa\u6765\uff08\u5e9f\u8bdd\uff09\uff0c\u5077\u7a0e\u770b\u4e86\u522b\u7684\u5927\u4f6c\u7684\u9898\u89e3\u3002\n\n\u6211\u4eec\u5047\u8bbe $dp_{i,j}$ \u8868\u793a\u5c06 $[i,j]$ \u5168\u90e8\u6d88\u9664\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\u4f46\u662f\u6211\u4eec\u4e0d\u96be\u53d1\u73b0\u8f6c\u79fb\u4e0d\u592a\u597d\u5b9e\u73b0\uff0c\u56e0\u4e3a\u4ec5\u4ec5\u77e5\u9053\u5de6\u53f3\u7aef\u70b9\u662f\u4e0d\u80fd\u77e5\u9053\u6700\u540e\u4e00\u6b21\u6d88\u9664\u7684 $\\min$ \u548c $\\max$ \u7684\u3002\n\n\u6211\u4eec\u8003\u8651\u53e6\u4e00\u4e2a\u72b6\u6001 $f_{i,j,l,r}$ \u8868\u793a\u5c06 $[i,j]$ \u6d88\u9664\uff0c\u6700\u540e\u4e00\u6b21\u6d88\u9664\u7684\u6570\u90fd\u5728\u503c\u57df $[l,r]$ \u8303\u56f4\u4e2d\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n\u5f88\u663e\u7136\uff0c\u539f\u6765\u7684 $dp_{i,j}=\\min f_{i,j,l,r}+a+b \\times (r-l)^2$\u3002\n\n\u90a3\u4e48\u6709\u4e24\u79cd\u8f6c\u79fb\u65b9\u5f0f\uff1a\n\n1. \u679a\u4e3e\u65ad\u70b9\uff0c$f_{i,j,l,r}=\\min\\limits_{k=i}^{j-1}f_{i,k,l,r}+f_{k+1,j,l,r}$\n\n2. \u5c06\u4e2d\u95f4\u4e00\u9879\u6d88\u9664\uff0c\u4e24\u7aef\u62fc\u8d77\u6765\u3002\u6211\u4eec\u627e\u51fa\u6700\u9760\u5de6 $p$ \u4f7f\u5f97\u7684 $a_x \\notin [l,r]$\uff0c\u4ee5\u53ca\u6700\u9760\u53f3\u7684 $q$ \u4f7f\u5f97 $a_y \\notin [l,r]$\uff0c\u90a3\u4e48\u53ef\u4ee5\u4ece $dp_{x,y}$ \u8f6c\u79fb\u8fc7\u6765\u3002\n\n```cpp\n//Coded by tzc_wk\n/*\n\u6570\u636e\u4e0d\u6e05\u7a7a\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u591a\u6d4b\u4e0d\u8bfb\u5b8c\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8fb9\u754c\u4e0d\u7279\u5224\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8d2a\u5fc3\u4e0d\u8bc1\u660e\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\nD P \u987a\u5e8f\u9519\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u5927\u5c0f\u5c11\u7b49\u53f7\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u53d8\u91cf\u4e0d\u7edf\u4e00\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8d8a\u754c\u4e0d\u5224\u65ad\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8c03\u8bd5\u4e0d\u6ce8\u91ca\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u6ea2\u51fa\u4e0d l l\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n*/\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi\t\t\tfirst\n#define se\t\t\tsecond\n#define fz(i,a,b)\tfor(int i=a;i<=b;i++)\n#define fd(i,a,b)\tfor(int i=a;i>=b;i--)\n#define foreach(it,v) for(__typeof(v.begin()) it=v.begin();it!=v.end();it++)\n#define all(a)\t\ta.begin(),a.end()\n#define giveup(...) return printf(__VA_ARGS__),0;\n#define fill0(a)\tmemset(a,0,sizeof(a))\n#define fill1(a)\tmemset(a,-1,sizeof(a))\n#define fillbig(a)\tmemset(a,0x3f,sizeof(a))\n#define fillsmall(a) memset(a,0xcf,sizeof(a))\n#define mask(a)\t\t(1ll<<(a))\n#define maskx(a,x)\t((a)<<(x))\n#define _bit(a,x)\t(((a)>>(x))&1)\n#define _sz(a)\t\t((int)(a).size())\n#define filei(a)\tfreopen(a,\"r\",stdin);\n#define fileo(a)\tfreopen(a,\"w\",stdout);\n#define fileio(a) \tfreopen(a\".in\",\"r\",stdin);freopen(a\".out\",\"w\",stdout)\n#define eprintf(...) fprintf(stderr,__VA_ARGS__)\n#define put(x)\t\tputchar(x)\n#define eoln        put('\\n')\n#define space\t\tput(' ')\n#define y1\t\t\ty_chenxiaoyan_1\n#define y0\t\t\ty_chenxiaoyan_0\ntypedef pair<int,int> pii;\ninline int read(){\n\tint x=0,neg=1;char c=getchar();\n\twhile(!isdigit(c)){\n\t\tif(c=='-')\tneg=-1;\n\t\tc=getchar();\n\t}\n\twhile(isdigit(c))\tx=x*10+c-'0',c=getchar();\n\treturn x*neg;\n}\ninline void print(int x){\n\tif(x<0){\n\t\tputchar('-');\n\t\tprint(abs(x));\n\t\treturn;\n\t}\n\tif(x<=9)\tputchar(x+'0');\n\telse{\n\t\tprint(x/10);\n\t\tputchar(x%10+'0');\n\t}\n}\ninline int qpow(int x,int e,int _MOD){\n\tint ans=1;\n\twhile(e){\n\t\tif(e&1)\tans=ans*x%_MOD;\n\t\tx=x*x%_MOD;\n\t\te>>=1;\n\t}\n\treturn ans;\n}\nint n=read(),A=read(),B=read(),a[55],b[55],key[55],hs[55],cnt=0;\nint dp[55][55],f[55][55][55][55];\nsigned main(){\n\tfillbig(dp);fillbig(f);\n\tfz(i,1,n)\ta[i]=read(),key[i]=a[i];\n\tsort(key+1,key+n+1);\n\tfz(i,1,n)\tif(key[i]!=key[i-1])\ths[++cnt]=key[i];\n\tfz(i,1,n)\tb[i]=lower_bound(hs+1,hs+cnt+1,a[i])-hs;\n\tfz(i,1,n){\n\t\tdp[i][i]=A;\n\t\tfz(l,1,cnt){\n\t\t\tfz(r,l,cnt){\n\t\t\t\tif(b[i]<l||b[i]>r)\tf[i][i][l][r]=A;\n\t\t\t\telse\t\t\t\tf[i][i][l][r]=0;\n\t\t\t}\n\t\t}\n\t}\n\tfz(len,2,n){\n\t\tfor(int i=1,j=len;j<=n;i++,j++){\n//\t\t\tdp[i][j]=0x3f3f3f3f;\n\t\t\tfz(l,1,cnt){\n\t\t\t\tfz(r,l,cnt){\n//\t\t\t\t\tf[i][j][l][r]=0x3f3f3f3f;\n\t\t\t\t\tint p=0,q=0;\n\t\t\t\t\tfor(int k=i;k<=j;k++)\tif(b[k]<l||b[k]>r){\n\t\t\t\t\t\tp=k;break;\n\t\t\t\t\t}\n\t\t\t\t\tfor(int k=j;k>=i;k--)\tif(b[k]<l||b[k]>r){\n\t\t\t\t\t\tq=k;break;\n\t\t\t\t\t}\n\t\t\t\t\tif(p&&q){\n\t\t\t\t\t\tf[i][j][l][r]=dp[p][q];\n\t\t\t\t\t}\n\t\t\t\t\tfz(k,i,j-1){\n\t\t\t\t\t\tf[i][j][l][r]=min(f[i][j][l][r],f[i][k][l][r]+f[k+1][j][l][r]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i][j]=min(dp[i][j],f[i][j][l][r]+A+B*(hs[r]-hs[l])*(hs[r]-hs[l]));\n//\t\t\t\t\tcout<<i<<\" \"<<j<<\" \"<<l<<\" \"<<r<<\" \"<<f[i][j][l][r]<<endl;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcout<<dp[1][n]<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1585830205,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5336 \u3010[THUSC2016]\u6210\u7ee9\u5355\u3011"
    },
    {
        "content": "\u819c\u62dc x6 \u5927\u805a\u805a\uff0c%%%%%%%%%%%%%%%%%%%%%%%%%%\n\n\u88ab\u6559\u80b2\u4e86\u4e00\u665a\u4e0a\u8fd8\u662f\u6ca1\u641e\u61c2\uff0c\u666e\u53ca\u7ec4\u9009\u624b\u88ab\u81ea\u5df1\u83dc\u54ed\u4e86\u3002\n\n------------\n\u9898\u610f\uff1a\u7ed9\u4e00\u4e2a\u5e8f\u5217 $w$ \u548c\u4e24\u4e2a\u6570 $a$\uff0c$b$\uff0c\u6bcf\u6b21\u53ef\u4ee5\u5220\u6389\u5e8f\u5217\u4e2d\u7684\u4e00\u4e2a\u533a\u95f4\uff0c\u4ee3\u4ef7\u4e3a $a+b(mx-mn)^2$\uff0c\u7136\u540e\u4e24\u8fb9\u63a5\u8d77\u6765\u6210\u4e3a\u65b0\u7684\u5e8f\u5217\u3002\u95ee\u4f60\u5220\u7a7a\u6574\u4e2a\u5e8f\u5217\u9700\u8981\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n\u4e0b\u6587\u4e2d\u4e3a\u4e86\u65b9\u4fbf\uff0c\u7528 $a$ \u8868\u793a\u6574\u4e2a\u5e8f\u5217\uff0c$w(S)$ \u8868\u793a\u5220\u6389 $S$ \u7684\u4ee3\u4ef7\u3002\n\n------------\n\u4ee4 $f_{l,r,S}$ \u8868\u793a\u82e5\u5f53\u524d\u9700\u8981\u5904\u7406\u7684\u5e8f\u5217\u662f\u539f\u5e8f\u5217\u4e2d\u7684 $[l,r]$ \u540e\u9762\u518d\u52a0\u4e0a\u4e00\u4e2a $S$\uff0c\u5e76\u4e14\u9650\u5b9a\u6574\u4e2a $S$ \u5fc5\u987b\u5728\u540c\u65f6\u88ab\u5220\u9664\uff08\u4f46\u662f\u53ef\u4ee5\u8ddf\u5176\u4ed6\u6570\u4e00\u8d77\uff09\uff0c\u6b64\u65f6\u7684\u7b54\u6848\u3002\u6211\u4eec\u5148\u4e0d\u8003\u8651\u5982\u4f55\u8bb0\u5f55 $S$\u3002\n\n\u8f6c\u79fb\u5206\u4e24\u79cd\u60c5\u51b5\uff1a\n1. \u6211\u53ef\u4ee5\u76f4\u63a5\u5355\u72ec\u628a $S$ \u5220\u6389\uff0c\u8f6c\u79fb\u5230 $f_{l,r,\\varnothing}+w(S)$\uff1b\n2. \u8003\u8651 $S$ \u548c $[l,r]$ \u7684\u54ea\u4e9b\u6570\u4e00\u8d77\u88ab\u5220\u6389\u3002\u5047\u8bbe\u5176\u4e2d\u6700\u53f3\u8fb9\u7684\u4e00\u4e2a\u662f $i$\uff0c\u90a3\u4e48 $[i+1,r]$ \u5fc5\u987b\u5148\u88ab\u5220\u7a7a\uff0c\u5e76\u4e14\u5b83\u4eec\u4e0d\u4f1a\u548c $i$ \u5de6\u8fb9\u7684\u6570\u4e00\u8d77\u88ab\u5220\u3002\u90a3\u4e48\u8fd9\u79cd\u60c5\u51b5\u662f $f_{l,i-1,\\{a_i\\}+S}+f_{i+1,r,\\varnothing}$\u3002\n\n\u5176\u4e2d $\\{a_i\\}+S$ \u8868\u793a\u5728 $S$ \u524d\u9762\u52a0\u4e0a\u4e00\u4e2a $a_i$\u3002$f_{l,r,S}$ \u5373\u662f\u6240\u6709\u8f6c\u79fb\u53d6 min\u3002\u53ef\u4ee5\u53d1\u73b0\uff0c\u6211\u4eec\u53ea\u9700\u8bb0\u5f55 $S$ \u4e2d\u7684\u6700\u5927\u548c\u6700\u5c0f\u503c\u3002\n\n\u6700\u7ec8\u7b54\u6848\u662f $f_{1,n,\\varnothing}$\u3002\u8fb9\u754c\u662f $S=\\varnothing$ \u65f6\u6ca1\u6709\u7b2c\u4e00\u79cd\u8f6c\u79fb\uff0c$l>r$ \u4e14 $S=\\varnothing$ \u65f6 dp \u503c\u4e3a $0$\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^5)$\uff0c\u7528\u8bb0\u5fc6\u5316\u641c\u7d22\u5b9e\u73b0\u5e38\u6570\u5f88\u5c0f\u3002\n\n------------\n\u4e3a\u4ec0\u4e48\u8981\u94a6\u5b9a $S$ \u4e0d\u80fd\u88ab\u5206\u5f00\u5220\u5462\uff1f\u82e5 $S$ \u53ef\u4ee5\u5206\u5f00\u5220\uff0c\u90a3\u4e48\u6211\u4eec\u8981\u4e48\u8003\u8651\u8fd9\u79cd\u8f6c\u79fb\uff0c\u8fd9\u6837\u65e0\u6cd5\u8bb0\u5f55 $S$\uff0c\u8981\u4e48\u8bf4\u660e\u5b83\u662f\u4e0d\u4f18\u7684\uff0c\u8fd9\u4e5f\u5f88\u56f0\u96be\u3002\n\n\u6216\u8005\u6211\u4eec\u8bf4\u660e\u8fd9\u6837\u7684\u60c5\u51b5\u5728\u5176\u4ed6 dp \u72b6\u6001\u4e2d\u88ab\u8003\u8651\uff0c\u6240\u4ee5\u6700\u7ec8\u8ba1\u7b97\u51fa\u7684\u7b54\u6848\u662f\u6b63\u786e\u7684\u3002\u4f46\u8fd9\u6837\u6c42\u51fa\u7684 dp \u503c\u5c31\u4e0d\u4ee3\u8868\u8fd9\u4e2a\u610f\u4e49\u4e86\u3002\u800c\u4e14\u8fd9\u4e2a\u8bf4\u660e\u7684\u8fc7\u7a0b\u4e5f\u53ef\u80fd\u6bd4\u8f83\u590d\u6742\uff0c\u6211\u4eec\u4e0d\u5982\u76f4\u63a5\u628a\u5b83\u5199\u5728\u72b6\u6001\u91cc\u3002\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ninline ll readint(){\n\tll x=0;\n\tbool f=0;\n\tchar c=getchar();\n\twhile(!isdigit(c)&&c!='-') c=getchar();\n\tif(c=='-'){\n\t\tf=1;\n\t\tc=getchar();\n\t}\n\twhile(isdigit(c)){\n\t\tx=x*10+c-'0';\n\t\tc=getchar();\n\t}\n\treturn f?-x:x;\n}\nconst int maxn=50+5;\nint n,a,b,w[maxn],ord[maxn];\nint val(int mn,int mx){\n\treturn a+b*(ord[mx]-ord[mn])*(ord[mx]-ord[mn]);\n}\nint f[maxn][maxn][maxn][maxn];\nbool vis[maxn][maxn][maxn][maxn];\nint dp(int l,int r,int mn,int mx){\n\tif(l>r&&mn>mx) return 0;\n\tint& ans=f[l][r][mn][mx];\n\tif(vis[l][r][mn][mx]) return ans;\n\tvis[l][r][mn][mx]=1;\n\tans=mn<=mx?dp(l,r,n,1)+val(mn,mx):2e9;\n\tfor(int i=l;i<=r;i++)\n\t\tans=min(ans,dp(l,i-1,min(mn,w[i]),max(mx,w[i]))+dp(i+1,r,n,1));\n\treturn ans;\n}\nint main(){\n\t#ifdef LOCAL\n\tfreopen(\"in.txt\",\"r\",stdin);\n\tfreopen(\"out.txt\",\"w\",stdout);\n\t#endif\n\tn=readint();\n\ta=readint();\n\tb=readint();\n\tfor(int i=1;i<=n;i++) ord[i]=w[i]=readint();\n\tsort(ord+1,ord+n+1);\n\tfor(int i=1;i<=n;i++) w[i]=lower_bound(ord+1,ord+n+1,w[i])-ord;\n\tprintf(\"%d\\n\",dp(1,n,n,1));\n\t#ifdef LOCAL\n\tfprintf(stderr,\"%f\\n\",1.0*clock()/CLOCKS_PER_SEC);\n\t#endif\n\treturn 0;\n}\n```",
        "postTime": 1640226263,
        "uid": 174045,
        "name": "FZzzz",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5336 \u3010[THUSC2016]\u6210\u7ee9\u5355\u3011"
    },
    {
        "content": "# P5336 \u9898\u89e3\n\n\u4e00\u9053\u975e\u5e38\u597d\u7684\u533a\u95f4 dp\u3002\n\n\u4e00\u5f00\u59cb\u6211\u7406\u89e3\u9519\u4e86\u9898\u610f\uff0c\u8ba4\u4e3a\u53ea\u662f\u628a\u539f\u5e8f\u5217\u5206\u6210\u51e0\u4e2a\u5c0f\u6bb5\uff0c\u4f46\u662f\u53d1\u73b0\u4e0d\u662f\uff0c\u5728\u53d1\u73b0\u4e24\u8fb9\u7684\u533a\u95f4\u53ef\u4ee5\u5408\u5e76\u7684\u65f6\u5019\uff0c\u6211\u610f\u8bc6\u5230\u8fd9\u662f\u4e00\u9053\u533a\u95f4 dp\u3002\n\n## 1 \u72b6\u6001\u8bbe\u8ba1\n\n\u4e8e\u662f\u6211\u5f00\u59cb\u8003\u8651\u72b6\u6001\u8bbe\u8ba1\uff0c\u5148\u6309\u7167\u533a\u95f4 dp \u6a21\u677f\uff1a\u8bbe $f_{l,r}$ \u8868\u793a $l$ \u5230 $r$ \u8fd9\u4e2a\u533a\u95f4\u7684\u6700\u4f18\u89e3\u3002\u7136\u540e\u6211\u4eec\u8003\u8651\u8fd9\u4e2a\u533a\u95f4\u662f\u5426\u80fd\u591f\u5305\u542b\u6240\u6709\u60c5\u51b5\uff0c\u5373\u5728\u8fd9\u4e2a\u72b6\u6001\u7684\u57fa\u7840\u4e0a\u80fd\u5426\u8f6c\u79fb\u3002\n\n\u4e0d\u96be\u53d1\u73b0\u4ec5\u51ed\u501f\u8fd9\u4e2a\u72b6\u6001\u662f\u6ca1\u6709\u529e\u6cd5\u8f6c\u79fb\u7684\u3002\u6211\u4eec\u770b\u770b\u8fd8\u7f3a\u5c11\u4ec0\u4e48\u3002\n\n\u5176\u5b9e\u6700\u7279\u6b8a\u7684\u60c5\u51b5\u5b9e\u9645\u4e0a\u662f\u8fd9\u79cd\u60c5\u51b5\uff1a\u533a\u95f4 $[l,r]$ \u4e2d\u6709\u82e5\u5e72\u6bb5\u5b8c\u6210\u7684\u533a\u95f4\uff0c\u5269\u4e0b\u7684\u90e8\u5206\u5408\u5e76\u8d77\u6765\u4e00\u8d77\u6d88\u6389\u3002\n\n\u7531\u4e8e\u4ee3\u4ef7\u7684\u8ba1\u7b97\u65b9\u5f0f\uff0c\u6240\u4ee5\u5b9e\u9645\u4e0a\u6211\u53ea\u9700\u8981\u5173\u6ce8\u5269\u4e0b\u90e8\u5206\u7684\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\u662f\u591a\u5c11\u3002\n\n\u4e8e\u662f\u6211\u4eec\u521d\u6b65\u8bbe\u8ba1\u51fa\u6765\u4e00\u4e2a\u72b6\u6001\uff1a$f_{l,r,x,y}$ \u8868\u793a\u533a\u95f4 $[l,r]$\uff0c\u6ca1\u9009\u7684\uff08\u5c31\u662f\u5269\u4e0b\u7684\u90e8\u5206\uff0c\u6211\u4eec\u5148\u4e0d\u7b97\u4ee3\u4ef7\uff09\u6700\u5c0f\u503c\u548c\u6700\u5927\u503c\u5206\u522b\u662f $x,y$\u3002\u90a3\u4e48\u8003\u8651\u8fd9\u4e2a\u72b6\u6001\u4e00\u5b9a\u4f1a\u6709\u4e0d\u5408\u6cd5\u72b6\u6001\uff0c\u6211\u4eec\u628a\u4e0d\u5408\u6cd5\u72b6\u6001\u7edf\u4e00\u8bbe\u4e3a $inf$\u3002\n\n## 2 \u8f6c\u79fb\n\n\u8003\u8651\u8f6c\u79fb\uff0c\u4e0d\u96be\u53d1\u73b0\uff0c\u72b6\u6001 $f_{l,r,x,y}$ \u5305\u542b\u7684\u6240\u6709\u60c5\u51b5\u6211\u4eec\u53ef\u4ee5\u5212\u5206\u6210\u4e24\u4e2a\u96c6\u5408\uff0c\u5176\u4e2d\u4e00\u4e2a\u96c6\u5408\u6700\u53f3\u8fb9\u6709\u5269\u4e0b\u7684\u90e8\u5206\uff0c\u90a3\u4e48\u8fd9\u4e2a\u90e8\u5206\u7684\u8f6c\u79fb\u6211\u4eec\u53ef\u4ee5\u4ece $f_{l,r-1,x',y'}$ \u8f6c\u79fb\u8fc7\u6765\uff0c\u5176\u4e2d $x=\\min(x',a_r),y=max(y',a_r)$\u3002\u53e6\u4e00\u4e2a\u96c6\u5408\u6700\u53f3\u8fb9\u6ca1\u6709\u5269\u4e0b\u7684\u90e8\u5206\uff0c\u6211\u4eec\u8003\u8651\u679a\u4e3e $k$\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u679a\u4e3e\u6240\u6709\u5269\u4e0b\u7684\u90e8\u5206\u90fd\u6765\u81ea $[l,k]$\u3002\u90a3\u4e48\u53f3\u8fb9\u7684\u4ee3\u4ef7\u5e94\u8be5\u662f\u591a\u5c11\uff1f\u4e0d\u96be\u53d1\u73b0\uff0c\u5e94\u8be5\u662f $\\min\\limits_{x,y}\\{ f_{k+1,r,x,y}+A+B\\times (y-x)^2 \\}$\u3002\u6211\u4eec\u4ee4 $g_{k+1,r}$ \u7b49\u4e8e\u53f3\u5f0f\u3002\u81f3\u4e8e $g_{l,r}$ \u7684\u66f4\u65b0\uff0c\u5728\u8ba1\u7b97\u5b8c $f_{l,r,x,y}$ \u540e\u66f4\u65b0\u5373\u53ef\u3002\n\n\u6700\u540e\u7684\u7b54\u6848\u4e0d\u96be\u53d1\u73b0\u662f $g_{1,n}$\u3002\n\n## 3 \u4ee3\u7801\n\n```c++\n#include<bits/stdc++.h>\n#define dd double\n#define ld long double\n#define ll long long\n#define uint unsigned int\n#define ull unsigned long long\n#define N 51\n#define M number\nusing namespace std;\n\nconst int INF=0x3f3f3f3f;\n\ntemplate<typename T> inline void read(T &x) {\n    x=0; int f=1;\n    char c=getchar();\n    for(;!isdigit(c);c=getchar()) if(c == '-') f=-f;\n    for(;isdigit(c);c=getchar()) x=x*10+c-'0';\n    x*=f;\n}\n\ntemplate<typename T> inline T Min(T a,T b){return a<b?a:b;}\ntemplate<typename T> inline T Max(T a,T b){return a<b?b:a;}\n\nint n,a[N],A,B,b[N],id[N];\nint f[N][N][N][N],g[N][N];\n\nint main(){\n    // freopen(\"my.in\",\"r\",stdin);\n    // freopen(\"my.out\",\"w\",stdout);\n    read(n);read(A);read(B);\n    for(int i=1;i<=n;i++){\n        read(a[i]);b[i]=a[i];\n    }\n    sort(b+1,b+n+1);int w=unique(b+1,b+n+1)-b-1;\n    for(int i=1;i<=n;i++){\n        int c=lower_bound(b+1,b+w+1,a[i])-b;\n        id[c]=a[i];a[i]=c;\n    }\n    memset(f,INF,sizeof(f));\n    memset(g,INF,sizeof(g));\n    for(int i=1;i<=n;i++){\n        f[i][i][a[i]][a[i]]=0;\n        g[i][i]=A;\n    }\n    for(int i=2;i<=n;i++){\n        for(int j=1;j<=n-i+1;j++){\n            int l=j,r=j+i-1;\n            for(int mi=1;mi<=w;mi++){\n                for(int mx=mi;mx<=w;mx++){\n                    f[l][r][Min(mi,a[r])][Max(mx,a[r])]=Min(f[l][r][Min(mi,a[r])][Max(mx,a[r])],f[l][r-1][mi][mx]);\n                }\n            }\n            for(int mi=1;mi<=w;mi++){\n                for(int mx=mi;mx<=w;mx++){\n                    for(int k=l;k<=r;k++){\n                        f[l][r][mi][mx]=Min(f[l][r][mi][mx],f[l][k][mi][mx]+g[k+1][r]);\n                    }\n                }\n            }\n            for(int mi=1;mi<=w;mi++){\n                for(int mx=mi;mx<=w;mx++){\n                    g[l][r]=Min(g[l][r],f[l][r][mi][mx]+A+B*(id[mx]-id[mi])*(id[mx]-id[mi]));\n                }\n            }\n        }\n    }\n    printf(\"%d\\n\",g[1][n]);\n    return 0;\n}\n```\n\n",
        "postTime": 1632835131,
        "uid": 194093,
        "name": "\u5929\u68a6",
        "ccfLevel": 6,
        "title": "P5336 \u9898\u89e3"
    },
    {
        "content": "\u6839\u636e\u533a\u95f4\u6d88\u9664\u7684\u5957\u8def\uff0c\u8bbe DP \u72b6\u6001\u4e2d\u8bb0\u4e0b\u533a\u95f4 $[l,r]$\u3002\n\n\u7136\u540e\u9700\u8981\u628a\u524d\u9762\u51c6\u5907\u548c $l$ \u4e00\u8d77\u6d88\u6389\u7684\u4e1c\u897f\u8bb0\u4e0b\u6765\u3002\u8bb0\u5f55\u7684\u4fe1\u606f\u9700\u8981\u652f\u6301\u8ba1\u7b97\u51fa\u6d88\u53bb\u7684\u4ee3\u4ef7\uff0c\u5bb9\u6613\u770b\u51fa\u8bb0\u5f55\u5206\u6570\u6700\u5927\u503c\u548c\u5206\u6570\u6700\u5c0f\u503c\u5373\u53ef\u3002\n\n\u5f97\u5230\u72b6\u6001\u4e3a $f(l,r,a,b)$ \u8868\u793a\u6d88\u53bb\u533a\u95f4 $[l,r]$ \u548c\u4e00\u4e9b\u4e0e $l$ \u4e00\u8d77\u6d88\u7684\u5143\u7d20\uff0c\u5176\u4e2d\u540e\u8005\uff08\u5305\u62ec $l$\uff09\u7684\u5206\u6570\u6700\u5c0f\u503c\u662f $a$\uff0c\u6700\u5927\u503c\u662f $b$\u3002\n\n\u8f6c\u79fb\uff1a\n\n- \u53ef\u4ee5\u7acb\u523b\u6d88\u53bb $l$ \u548c\u5b83\u9644\u5e26\u7684\u5143\u7d20\uff1a$f(l,r,a,b)\\leftarrow f(l+1,r,w_{l+1},w_{l+1})+A+B(b-a)^2$\uff1b\n- \u53ef\u4ee5\u679a\u4e3e\u4e00\u4e2a $l<k\\leq r$\uff0c\u7136\u540e\u6d88\u53bb $(l,k)$\uff0c\u5c06 $l$ \u9644\u5e26\u5230 $k$ \u4e0a\u6d88\u53bb\uff1a$f(l,r,a,b)\\leftarrow f(l+1,k-1,w_{l+1},w_{l+1})+f(k,r,\\min\\{a,w_k\\},\\max\\{b,w_k\\})$\u3002\n\n\u8fb9\u754c\uff1a$f(i,i,w_i,w_i)=A$\uff0c\u76ee\u6807\uff1a$f_{1,n,w_1,w_1}$\u3002\n\n\u8fd9\u6837\uff0c\u72b6\u6001\u6570\u662f $O(n^4)$\uff0c\u8f6c\u79fb\u518d\u6709 $n$ \u7684\u8017\u8d39\uff0c\u603b\u590d\u6742\u5ea6 $O(n^5)$\uff0c\u7528\u8bb0\u5fc6\u5316\u641c\u7d22\u5b9e\u73b0\u5e38\u6570\u5f88\u5c0f\uff0c\u968f\u4fbf\u8dd1\u3002\n\n```cpp\n#include <iostream>\n#include <cmath>\n#include <cstring>\n#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\n#define getchar() (p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\nchar buf[1 << 21], *p1 = buf, *p2 = buf;\n\ninline int qread() {\n\tregister char c = getchar();\n\tregister int x = 0, f = 1;\n\twhile (c < '0' || c > '9') {\n\t\tif (c == '-') f = -1;\n\t\tc = getchar();\n\t}\n\twhile (c >= '0' && c <= '9') {\n\t\tx = (x << 3) + (x << 1) + c - 48;\n\t\tc = getchar();\n\t}\n\treturn x * f;\n}\n\ninline long long Abs(const long long& x) {return (x > 0 ? x : -x);}\ninline long long Max(const long long& x, const long long& y) {return (x > y ? x : y);}\ninline long long Min(const long long& x, const long long& y) {return (x < y ? x : y);}\n\nlong long n, A, B, w[55], v[55], dp[55][55][55][55];\nbool vis[55][55][55][55];\n\ninline void Read() {\n\tn = qread(); A = qread(); B = qread();\n\tfor (int i = 1;i <= n;i++) w[i] = v[i] = qread();\n}\n\ninline void Prefix() {\n\tsort(v + 1, v + n + 1);\n\tfor (int i = 1;i <= n;i++) w[i] = lower_bound(v + 1, v + n + 1, w[i]) - v;\n\tmemset(dp, 0x3f, sizeof(dp));\n\tfor (int i = 1;i <= n;i++) {\n\t\tdp[i][i][w[i]][w[i]] = A;\n\t\tvis[i][i][w[i]][w[i]] = 1;\n\t}\n}\n\ninline long long Dfs(int l, int r, int a, int b) {\n\tif (l > r) return 0;\n\tif (vis[l][r][a][b]) return dp[l][r][a][b];\n\tdp[l][r][a][b] = Min(dp[l][r][a][b], Dfs(l + 1, r, w[l + 1], w[l + 1]) + B * (v[b] - v[a]) * (v[b] - v[a]) + A);\n\tfor (int k = l + 1;k <= r;k++) dp[l][r][a][b] = Min(dp[l][r][a][b], Dfs(l + 1, k - 1, w[l + 1], w[l + 1]) + Dfs(k, r, Min(a, w[k]), Max(b, w[k])));\n\tvis[l][r][a][b] = 1;\n\treturn dp[l][r][a][b];\n}\n\nint main() {\n\tRead();\n\tPrefix();\n\tprintf(\"%lld\", Dfs(1, n, w[1], w[1]));\n\t#ifdef CFA_44\n\twhile (1);\n\t#endif\n\treturn 0;\n}\n\n```",
        "postTime": 1620393845,
        "uid": 61088,
        "name": "Solystic",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5336 \u3010[THUSC2016]\u6210\u7ee9\u5355\u3011"
    },
    {
        "content": "\u8bb2\u9898\u65f6\u73b0\u7406\u89e3\u51fa\u7684\u4e00\u4e9b\u4e1c\u897f\uff0c\u4e00\u672c\u901a\u91cc\u5e76\u6ca1\u6709\u8bf4\u660e\u767d\n\n#### Solution\uff1a\n\n\u8bbe\u72b6\u6001\u4e3a$f[x][y][l][r]$\u8868\u793a\u628a\u533a\u95f4$[x,y]$\u4e2d\u6570\u503c\u4e0d\u5728$[l,r]$\u5185\u7684\u70b9\u53d6\u5b8c\u7684\u6700\u5c0f\u4ee3\u4ef7\uff08\u663e\u7136\u540e\u4e24\u7ef4\u8981\u79bb\u6563\u5316\uff09\uff0c\u201c\u4e0d\u5728...\u5185\u201d\u662f\u56e0\u4e3a\u4e00\u6bb5\u533a\u95f4\u7684\u4ee3\u4ef7\u53ef\u4ee5\u901a\u8fc7\u4e00\u6b21\u64cd\u4f5c\u52a0\u4e0a$A + B \\times (r - l) ^ 2$\u8f7b\u677e\u5f97\u5230\n\n\u5177\u4f53\u600e\u4e48\u8f6c\u79fb\uff0c\u5148\u770b\u6837\u4f8b\n\n```cpp\n10\n3 1\n7 10 9 10 6 7 10 7 1 2\n\nans = 15\n\n\u6b63\u786e\u7684\u53d6\u6cd5\uff1a\n10 9 10\n10\n1 6 7 7\n1 2\n```\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u53ef\u4ee5\u53d6\u4efb\u610f\u591a\u6b21\uff08A\u76f8\u5bf9B\u8db3\u591f\u5c0f\u4f46\u4e0d\u4e3a0\uff09\uff0c\u90a3\u80af\u5b9a\u662f\u6309\u7167\u503c\u57df\u53d6\uff0c\u5148\u5c06\u6700\u5927\u7684\u53d6\u5b8c\uff08\u8fde\u7eed\u76841\u6b21\u53d6\u5b8c\uff09\uff0c\u8fd9\u65f6\u4e00\u4e9b\u6b21\u5927\u7684\u6570\u6709\u53ef\u80fd\u4f1a\u8fde\u8d77\u6765\uff0c\u5c31\u53ef\u4ee5\u8ba9\u53d6\u7684\u6b21\u6570\u51cf\u5c11\uff0c\u518d\u8fd9\u6837\u53d6\u6b21\u5927\u7684\u3001\u4e00\u76f4\u5230\u53d6\u5b8c\n\n\u4f46\u5b9e\u9645\u60c5\u51b5\u5e76\u4e0d\u5982\u6b64\u4e50\u89c2\uff0c\u6240\u4ee5\u6211\u4eec\u6309\u7167\u521a\u521a\u7684\u601d\u60f3\uff0c\u91cd\u65b0\u5b9a\u4e49\u201c\u53d6\u5b8c\u201d\u4e3a\uff1a\n\n\u201c\u5c06\u533a\u95f4$[x,y]$\u53d6\u5b8c\uff0c\u6307\u8fd9\u4e2a\u533a\u95f4\u5185\u6bcf\u6b21\u53d6\u4e00\u6bb5\u503c\u57df\uff08\u8fd9\u4e9b\u6570\u7684\u4f4d\u7f6e\u5e76\u4e0d\u4e00\u5b9a\u8fde\u7eed\uff09\uff0c\u76f4\u81f3\u53d6\u5b8c\u201d\n\n\u4e8e\u662f\u5c31\u53ef\u4ee5\u5f97\u5230l = 0 &&r = 0\u65f6\u7684\u8f6c\u79fb\n\n$f[x][y][0][0] = min(A + B \\times (ma - mi)^2,\\sum_{i = 1}^{tot} \\sum_{j = i} ^ {tot} min(f[x][y][i][j] + A + B \\times (j - i)^2))$\n\n$tot$\u662f\u503c\u57df\n\n\u8fd9\u4e2a\u5f0f\u5b50\u4e2d\u9700\u8981\u7528\u5230\uff1a$f[x][y][i][j]$\uff0c\u73b0\u5728\u6211\u4eec\u6765\u63a8\u8fd9\u4e2a\u60c5\u51b5\n\n\u5982\u679c\u533a\u95f4\u5185\u53ea\u6709\u4e00\u4e2a\u6570\uff0c\u5982\u679c\u4e0d\u5728$[i,j]$\u5185\uff0c\u4ee3\u4ef7\u663e\u7136\u4e3a0\uff0c\u5426\u5219\uff0c\u5b83\u9700\u8981\u88ab\u53d6\uff0c\u56e0\u4e3a$f[x][y][i][j]$\u548c$f[x][y][0][0]$\u662f\u540c\u65f6\n\n\u5982\u679c\u533a\u95f4\u6240\u6709\u6570\u90fd\u4e0d\u5728$[l,r]$\u4e4b\u5185\uff0c\u4e0d\u7528\u7ba1\u8fd9\u79cd\u60c5\u51b5\n\n\u53cd\u4e4b\uff0c\u8981\u6ee1\u8db3$[l,r]$\u7684\u9650\u5236\uff0c\u4e00\u5b9a\u662f\u7531\u4e00\u6bb5\u4e00\u6bb5\u7684\u201c\u53d6\u533a\u95f4\u201d\u64cd\u4f5c\u7ec4\u6210\u7684\uff0c\u4e5f\u5c31\u662f\u4e00\u4e9b$f[xi][yi][0][0]$\u7ec4\u6210\u7684\uff0c\u6211\u4eec\u8981\u5212\u5206\u6210\u4e00\u4e9b\u533a\u95f4\u4f7f\u5f97\u8fd9\u4e9b\u6570\u52a0\u8d77\u6765\u6700\u5c0f\n\n\u679a\u4e3e\u4e2d\u95f4\u65ad\u70b9\uff0c\u5212\u5206\u4e3a\u5de6\u53f3\u4e24\u4e2a\u533a\u95f4\uff0c\u6709\u4e09\u79cd\u60c5\u51b5\uff1a\n\n- \u5de6\u8fb9\u7ee7\u7eed\u5212\u5206\uff0c\u53f3\u8fb9\u76f4\u63a5\u53d6\u5b8c\n\n- \u5de6\u8fb9\u76f4\u63a5\u53d6\u5b8c\uff0c\u53f3\u8fb9\u7ee7\u7eed\u5212\u5206\n\n- \u5de6\u53f3\u90fd\u7ee7\u7eed\u5212\u5206\n\n\u4e8e\u662f\u5c31\u6709\u4e86\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$f[x][y][l][r] = \\sum_{k = x}^{y - 1} min(f[x][k][l][r] + f[k + 1][y][0][0],f[x][k][0][0] + f[k + 1][y][l][r],f[x][k][l][r] + f[k + 1][y][l][r])$\n\n\u8bb0\u641c\u5b9e\u73b0\uff0c\u56e0\u4e3a~~\u4e00\u672c\u901a\u5c31\u7528\u7684\u8bb0\u641c~~\u8fd9\u6837\u597d\u5199\n\n#### Code\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N = 55, INF = 1e8;\n\nint n, A, B, tot, f[N][N][N][N], a[N], tmp[N], b[N];\nbool vis[N][N][N][N];\n\nint dp(int x, int y, int l, int r)\n{\n\tif(vis[x][y][l][r]) return f[x][y][l][r];\n\tvis[x][y][l][r] = 1;\n\n\tif(!l && !r)\n\t{\n\t\tint ma = -INF, mi = INF;\n\t\tfor(int i = x;i <= y; ++i)\n\t\t{\n\t\t\tma = max(ma, a[i]);\n\t\t\tmi = min(mi, a[i]);\n\t\t}\n\t\tf[x][y][l][r] = A + B * (ma - mi) * (ma - mi);\n\n\t\tfor(int i = 1;i <= tot; ++i)\n\t\t\tfor(int j = i;j <= tot; ++j)\n\t\t\t\tf[x][y][l][r] = min(f[x][y][l][r], dp(x, y, i, j) + A + B * (tmp[j] - tmp[i]) * (tmp[j] - tmp[i]));\n\n\t\treturn f[x][y][l][r];\n\t}\n\telse\n\t{\n\t\tif(x == y)\n\t\t{\n\t\t\tif(l <= b[x] && b[x] <= r) return f[x][y][l][r] = 0;\n\t\t\treturn f[x][y][l][r] = A;\n\t\t}\n\n\t\tf[x][y][l][r] = INF;\n\t\tfor(int k = x;k < y; ++k)\n\t\t{\n\t\t\tf[x][y][l][r] = min(f[x][y][l][r], dp(x, k, l, r) + dp(k + 1, y, l, r));\n\t\t\tf[x][y][l][r] = min(f[x][y][l][r], dp(x, k, 0, 0) + dp(k + 1, y, l, r));\n\t\t\tf[x][y][l][r] = min(f[x][y][l][r], dp(x, k, l, r) + dp(k + 1, y, 0, 0));\n\t\t}\n\t\treturn f[x][y][l][r];\n\t}\n}\n\nsigned main()\n{\n\tscanf(\"%d %d %d\", &n, &A, &B);\n\tfor(int i = 1;i <= n; ++i)\n\t{\n\t\tscanf(\"%d\", &a[i]);\n\t\ttmp[i] = a[i];\n\t}\n\n\tsort(tmp + 1, tmp + n + 1);\n\ttot = unique(tmp + 1, tmp + n + 1) - (tmp + 1);\n\tfor(int i = 1;i <= n; ++i)\n\t\tb[i] = lower_bound(tmp + 1, tmp + tot + 1, a[i]) - tmp;\n\n\tprintf(\"%d\", dp(1, n, 0, 0));\n\treturn 0;\n}\n```",
        "postTime": 1602641616,
        "uid": 286239,
        "name": "ql12345",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5336 \u3010[THUSC2016]\u6210\u7ee9\u5355\u3011"
    },
    {
        "content": "[\u771f\u5b9e\u61d2\u4eba\uff0c\u642c\u4e2a\u6211\u535a\u5ba2\u9898\u89e3\u5c31\u597d\u5566](https://foreverlasting1202.github.io/2019/01/24/THUSC2016%E9%A2%98%E8%A7%A3/)\n\n\u52a8\u6001\u89c4\u5212\u3002\n\n\u600e\u4e48\u4f1a\u6709\u8fd9\u4e48\u8822\u7684DP\u9898\u554a\uff1f\u6211\u90fd\u9707\u60ca\u4e86\u3002\n\n$f[l][r][x][y]$\u8868\u793a$l$\u5230$r$\u7684\u4f4d\u7f6e\u533a\u95f4\uff0c\u6700\u7ec8\u5269\u4e0b\u7684\u503c\u662f$x$\u5230$y$\u8303\u56f4\u5185\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\u8f6c\u79fb\u4e5f\u975e\u5e38\u597d\u5199\uff0c\u6709\u4e24\u79cd\u8f6c\u79fb\u65b9\u5f0f\u3002\n\n\u7b2c\u4e00\u79cd\uff1a\u548c$[l,r-1]$\u653e\u5230\u4e00\u8d77\u5220\u9664\uff0c\u8fd9\u6837\u7684\u8bdd\u53ea\u7528\u8003\u8651$w[r]$\u8fd9\u4e2a\u4f4d\u7f6e\u662f\u5426\u6539\u53d8$x$\u548c$y$\uff0c\u6240\u4ee5$f[l][r][min(x,w[r])][max(y,w[r])]=f[l][r-1][x][y]$\u3002\n\n\u7b2c\u4e8c\u79cd\uff1a\u548c\u540e\u9762\u7684$[k+1,r]$\u8fd9\u4e00\u6bb5\u4e00\u8d77\u8fde\u7eed\u88ab\u5220\u9664\uff0c\u8fd9\u6837\u7684\u8bdd\u5c31\u662f$f[l][r][x][y]=f[l][k][x][y]+g[k+1][r]$\u3002\n\n\u5176\u4e2d$g[k+1][r]$\u8868\u793a$min(f[k+1][r][x][y])$\uff0c\u679a\u4e3e$x$\uff0c$y$\u3002\n\n\u4e8e\u662f\u5c31\u505a\u5b8c\u4e86\u3002\n\ncode:\n```cpp\n//2019.1.24 by ljz\n#include<bits/stdc++.h>\nusing namespace std;\n#define res register int\n#define LL long long\n#define inf 0x3f3f3f3f\n#define eps 1e-10\ninline int read() {\n    res s=0;\n    bool w=0;\n    char ch=getchar();\n    while(ch<'0'||ch>'9') {\n        if(ch=='-')w=1;\n        ch=getchar();\n    }\n    while(ch>='0'&&ch<='9')s=s*10+ch-'0',ch=getchar();\n    return w?-s:s;\n}\ninline void _swap(res &x,res &y) {\n    x^=y^=x^=y;\n}\ninline int _abs(const res &x) {\n    return x>0?x:-x;\n}\ninline int _max(const res &x,const res &y) {\n    return x>y?x:y;\n}\ninline int _min(const res &x,const res &y) {\n    return x<y?x:y;\n}\nconst int N=50+10;\nnamespace MAIN {\n    int w[N],c[N];\n    int n,a,b;\n    int f[N][N][N][N],g[N][N];\n    inline void MAIN(){\n        memset(f,inf,sizeof(f)),memset(g,inf,sizeof(g));\n        n=read(),a=read(),b=read();\n        for(res i=1;i<=n;i++)w[i]=c[i]=read();\n        sort(c+1,c+n+1);\n        res nw=unique(c+1,c+n+1)-c-1;\n        for(res i=1;i<=n;i++)w[i]=lower_bound(c+1,c+nw+1,w[i])-c,f[i][i][w[i]][w[i]]=0,g[i][i]=a;\n        for(res len=1;len<n;len++){\n            for(res l=1,r=l+len;r<=n;l++,r++){\n                f[l][r][w[r]][w[r]]=g[l][r-1];\n                for(res x=1;x<=nw;x++)\n                    for(res y=x;y<=nw;y++)f[l][r][_min(x,w[r])][_max(y,w[r])]=_min(f[l][r][_min(x,w[r])][_max(y,w[r])],f[l][r-1][x][y]);\n                for(res k=l;k<r;k++)\n                    for(res x=1;x<=nw;x++)\n                        for(res y=x;y<=nw;y++)f[l][r][x][y]=_min(f[l][r][x][y],f[l][k][x][y]+g[k+1][r]);\n                for(res x=1;x<=nw;x++)\n                    for(res y=x;y<=nw;y++)g[l][r]=_min(g[l][r],f[l][r][x][y]+a+b*(c[x]-c[y])*(c[x]-c[y]));\n            }\n        }\n        printf(\"%d\\n\",g[1][n]);\n    }\n}\nint main() {\n    MAIN::MAIN();\n    return 0;\n}\n```",
        "postTime": 1557128239,
        "uid": 32878,
        "name": "foreverlasting",
        "ccfLevel": 7,
        "title": "\u3010THUSC2016\u3011\u6210\u7ee9\u5355"
    },
    {
        "content": "\u5bf9\u672c\u9898\u7684\u4e00\u79cd\u89e3\u6cd5\u8fdb\u884c\u8be6\u7ec6\u4e00\u70b9\u7684\u89e3\u91ca\u3002\u5b66\u4e60\u8fd9\u9053\u9898\u65f6\u53c2\u8003\u4e86 **\u5929\u68a6\uff08194093\uff09** \u7684\u9898\u89e3\uff0c\u81f4\u4ee5\u611f\u8c22\u3002\n\n&nbsp;\n\n\u4e00\u6b21\u53ef\u4ee5\u62bd\u51fa\u8fde\u7eed\u7684\u4e00\u6bb5\uff0c\u6545\u8003\u8651\u533a\u95f4 DP\u3002\n\n\u8bbe $f[l][r]$ \u8868\u793a\u533a\u95f4 $[l,r]$ \u88ab\u5168\u90e8\u53d6\u8d70\u6240\u9700\u7684\u6700\u5c0f\u4ee3\u4ef7\uff0c\u4f1a\u53d1\u73b0\u4fe1\u606f\u4e0d\u591f\uff0c\u96be\u4ee5\u8f6c\u79fb\u3002\n\n\u4e00\u6b21\u6027\u53d6\u8d70\u4e00\u4e2a\u533a\u95f4\u6240\u9700\u7684\u4ee3\u4ef7\u4e0e\u4e14\u53ea\u4e0e\u8fd9\u4e2a\u533a\u95f4\u7684\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\u76f8\u5173\uff0c\u6240\u4ee5\u4e0d\u59a8\u589e\u8bbe $g[l][r][\\mathrm{mn}][\\mathrm{mx}]$ \u8868\u793a\u533a\u95f4 $[l,r]$ \u53d6\u5230\u5269\u4f59\u6570\u6700\u5c0f\u503c\u4e3a $\\mathrm{mn}$\uff0c\u6700\u5927\u503c\u4e3a $\\mathrm{mx}$ \u6240\u9700\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\u53ef\u77e5\u8fd9\u6837 $f$ \u7684\u8f6c\u79fb\u5373\u4e3a\uff1a\n\n$$f[l][r] = \\min_{1 \\le \\mathrm{mn} \\le \\mathrm{mx} \\le L}\\{g[l][r][\\mathrm{mn}][\\mathrm{mx}] + A + B \\cdot (\\mathrm{mx} - \\mathrm{mn})^2\\}$$\n\n\u8fd9\u91cc $L$ \u4e3a\u6700\u5927\u53ef\u80fd\u7684\u5206\u6570\u503c\u3002\n\n\u63a5\u4e0b\u6765\u5c31\u8be5\u8003\u8651 $g$ \u600e\u4e48\u8f6c\u79fb\u4e86\u3002$g[l][r][\\mathrm{mn}][\\mathrm{mx}]$ \u7684\u610f\u4e49\u662f\u533a\u95f4 $[l,r]$ \u88ab\u53d6\u8d70\u4e00\u4e9b\u6570\uff0c\u8fd8\u5269\u4e0b\u4e00\u4e9b\u6570\uff0c\u4e14\u8fd9\u4e9b\u6570\u91cc\u6700\u5c0f\u503c\u4e3a $\\mathrm{mn}$\uff0c\u6700\u5927\u503c\u4e3a $\\mathrm{mx}$\u3002\u90a3\u5269\u4e0b\u8fd9\u4e9b\u6570\u7684\u60c5\u51b5\uff0c\u5c31\u53ef\u4ee5\u5212\u5206\u6210 **$\\boldsymbol r$ \u4f4d\u7f6e\u7684\u6570\u5728\u8fd9\u4e9b\u6570\u91cc**\uff08\u5373 $r$ \u4f4d\u7f6e\u7684\u6570\u6ca1\u6709\u88ab\u53d6\u8d70\uff09 \u548c **$\\boldsymbol r$ \u4f4d\u7f6e\u7684\u6570\u4e0d\u5728\u8fd9\u4e9b\u6570\u91cc**\uff08\u5373 $r$ \u4f4d\u7f6e\u7684\u6570\u88ab\u53d6\u8d70\uff09\u8fd9\u4e24\u79cd\u60c5\u51b5\u3002\n\n$r$ \u4f4d\u7f6e\u7684\u6570\u6ca1\u6709\u88ab\u53d6\u8d70\uff0c\u5219\u6709\uff1a\n\n$$g[l][r][\\min(\\mathrm{mn},w_r)][\\max(\\mathrm{mx},w_r)] \\gets g[l][r-1][\\mathrm{mn}][\\mathrm{mx}]$$\n\n\u8fd9\u662f\u56e0\u4e3a\uff0c\u65e2\u7136 $r$ \u4f4d\u7f6e\u7684\u6570\u6ca1\u6709\u88ab\u53d6\u8d70\uff0c\u90a3\u4e48\u5728 $[l,r-1]$ \u533a\u95f4\u53d6\u5230\u5269\u4f59\u6570\u6700\u5c0f\u503c\u4e3a $\\mathrm{mn}$\uff0c\u6700\u5927\u503c\u4e3a $\\mathrm{mx}$ \u7684\u64cd\u4f5c\uff0c\u5176\u5728 $[l,r]$ \u533a\u95f4\u7684\u6548\u679c\u5c31\u662f\u53d6\u5230\u5269\u4f59\u6570\u6700\u5c0f\u503c\u4e3a $\\min(\\mathrm{mn},w_r)$\uff0c\u6700\u5927\u503c\u4e3a $\\max(\\mathrm{mx},w_r)$\u3002\n\n$r$ \u4f4d\u7f6e\u7684\u6570\u88ab\u53d6\u8d70\uff0c\u5219 $[l,r]$ \u533a\u95f4\u5fc5\u7136\u53ef\u4ee5\u5212\u5206\u6210\u4e00\u4e2a $[l,k]$ \u533a\u95f4\u548c\u4e00\u4e2a $[k+1,r]$ \u533a\u95f4\uff0c\u6ee1\u8db3 $k < r$\uff0c\u4e14 $[l,r]$ \u533a\u95f4\u6ca1\u6709\u88ab\u53d6\u8d70\u7684\u6570\u90fd\u5728 $[l,k]$ \u533a\u95f4\u5185\uff08\u5373 $[k+1,r]$ \u533a\u95f4\u6240\u6709\u6570\u5747\u88ab\u53d6\u8d70\uff09\u3002\u4ece\u800c\uff1a\n\n$$g[l][r][\\mathrm{mn}][\\mathrm{mx}] = \\min_{k=l}^{r-1}\\{g[l][k][\\mathrm{mn}][\\mathrm{mx}] + f[k+1][r]\\}$$\n\n\u8fd9\u6837\uff0c\u5c31\u5f97\u5230\u4e86 $g$ \u7684\u8f6c\u79fb\u3002\u7efc\u5408\u524d\u9762 $f$ \u7684\u8f6c\u79fb\uff0c\u5373\u89e3\u51b3\u672c\u9898\u3002\n\n&nbsp;\n\n\u5c06\u6570\u503c\u79bb\u6563\u5316\u540e\uff0c\u72b6\u6001\u6570\u548c\u590d\u6742\u5ea6\u53ef\u4ee5\u63a5\u53d7\u3002",
        "postTime": 1661044156,
        "uid": 118109,
        "name": "whhsteven",
        "ccfLevel": 7,
        "title": "P5336 [THUSC2016]\u6210\u7ee9\u5355"
    },
    {
        "content": "# \u601d\u8def\n\n\u9996\u5148\uff0c\u770b\u5230\u8fd9\u4e2a\u9898\u9762\uff0c\u6211\u4eec\u80af\u5b9a\u53ef\u4ee5\u60f3\u5230\u52a8\u6001\u89c4\u5212\n\n\u8bbe $f[i][j][l][r]$ \u8868\u793a\u5728\u7b2c $i$ \u4e2a\u6570\u5230\u7b2c $j$ \u4e2a\u6570\u4e2d\u53d6\u51fa\u4e00\u4e9b\u6570\u540e\uff0c\u5269\u4e0b\u7684\u6570\u7684\u503c\u5728 $[l, r]$ \u8303\u56f4\u5185\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n\u6613\u5f97 $f[i][j][0][0]$ \u5176\u5b9e\u5c31\u662f\u4e00\u6bb5\u6570\u5168\u90e8\u53d6\u5b8c\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n\u56e0\u4e3a $w_i \\leq 1000$ \uff0c\u6240\u4ee5\u8981\u8fdb\u884c\u79bb\u6563\u5316\u3002\n\n\u90a3\u6211\u4eec\u73b0\u5728\u8bb0 $l,r$ \u79bb\u6563\u524d\u7684\u503c\u5206\u522b\u4e3a $x,y$\n\n\u5bf9\u4e8e $f[i][j][0][0]$ \u884d\u751f\u51fa\u4e86\u4e24\u79cd\u60c5\u51b5\n\n1.\u4e00\u6b21\u5168\u90e8\u53d6\u5b8c\n\n\u8bbe $max$ \u4e3a $w_i - w_j$ \u4e2d\u7684\u6700\u5927\u503c\n\n$min$ \u4e3a $w_i - w_j$ \u4e2d\u7684\u6700\u5c0f\u503c\n\n$f[i][j][0][0]=a+b*(max - min)^2$\n\n2.\u5148\u53d6\u5b8c\u4e0d\u5728 $[l, r]$ \u5185\u7684\u6570\uff0c\u5269\u4e0b\u7684\u4e00\u6b21\u53d6\u5b8c\n\n$f[i][j][0][0]=f[i][j][l][r]+a+b*(y-x)^2$\n\n\u5bf9\u4e8e\u8fd9\u4e24\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7ed9\u5b83\u4eec\u5957\u4e0a\u4e00\u4e2a $min$ \u5373\u53ef\n\n\u5bf9\u4e8e $f[i][j][l][r]$ \u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u533a\u95f4\u65ad\u70b9 $k$\n\n\u8868\u793a\u628a $[i,j]$ \u5206\u4e3a\u5de6\u8fb9\u7684 $[i,k]$ \u548c\u53f3\u8fb9\u7684 $[k+1,j]$\n\n\u90a3\u4e48\u6709\u4e00\u6b21\u884d\u751f\u51fa\u4e09\u79cd\u60c5\u51b5\n\n1.\u5de6\u53d6\u5b8c\uff0c\u53f3\u4e0d\u53d6\u5b8c\n\n$f[i][j][l][r]=f[i][k][0][0]+f[k+1][j][l][r]$\n\n\u4e3a\u4e86\u8ba9\u5404\u4f4d\u66f4\u597d\u770b\u61c2\uff0c\u8fd9\u91cc\u8865\u5145\u4e00\u4e0b\u540e\u4e24\u4f4d\u5e26 $[0][0]$ \u7684\u5c31\u662f\u5168\u90e8\u53d6\n\n2.\u5de6\u4e0d\u53d6\u5b8c\uff0c\u53f3\u53d6\u5b8c\n\n$f[i][j][l][r]=f[i][k][l][r]+f[k+1][j][0][0]$\n\n3.\u5de6\u53f3\u90fd\u4e0d\u53d6\u5b8c\n\n$f[i][j][l][r]=f[i][k][l][r]+f[k+1][j][l][r]$\n\n\u7136\u540e\u518d\u5bf9\u8fd9\u4e09\u79cd\u60c5\u51b5\u53d6\u6700\u5c0f\u503c\u3002\n\n\u7136\u540e\u63d0\u4e00\u4e0b\u521d\u503c\uff0c\u5f53 $i=j$ \u4e14 $l \\leq w_i \\leq r$, \u65f6\uff1a\n\n$f[i][j][l][r]=0$, \u5176\u4f59 $inf$ \u5373\u53ef\n\n\u7406\u8bba\u590d\u6742\u5ea6 $O(n^5)$, \u4f46\u5b9e\u9645\u4e0a\u662f\u5c0f\u5f88\u591a\u7684\uff0c\u53ef\u4ee5\u653e\u5fc3\u7528\n\n# \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst int inf=0x3f3f3f3f;\nint n,a,b,w[55],dp[55][55][55][55],c[55],tot,p[55];\nbool vis[55][55][55][55];\n\ninline int DFS(int i,int j,int l,int r)\n{\n\tif(vis[i][j][l][r])\n\t\treturn dp[i][j][l][r];\n\tvis[i][j][l][r]=1;\n\tdp[i][j][l][r]=inf;\n\tif(!l && !r)\n\t{\n\t\tint x=inf,y=-inf,k;\n\t\tfor(k=i;k<=j;k++)\n\t\t{\n\t\t\tx=min(x,c[k]);\n\t\t\ty=max(y,c[k]);\n\t\t}\n\t\tdp[i][j][0][0]=a+b*(y-x)*(y-x);\n\t\tfor(x=1;x<=tot;x++)\n\t\tfor(y=x;y<=tot;y++)\n\t\t{\n\t\t\tint res=DFS(i,j,x,y);\n\t\t\tdp[i][j][0][0]=min(dp[i][j][0][0],res+a+b*\n\t\t\t(p[y]-p[x])*(p[y]-p[x]));\n\t\t}\n\t\treturn dp[i][j][0][0];\n\t}\n\telse\n\t{\n\t\tif(i==j)\n\t\t{\n\t\t\tif(l<=w[i] && w[i]<=r)\n\t\t\t\tdp[i][j][l][r]=0;\n\t\t\treturn dp[i][j][l][r];\n\t\t}\n\t\tfor(int k=i;k<j;k++)\n\t\t{\n\t\t\tdp[i][j][l][r]=min(dp[i][j][l][r],\n\t\t\tDFS(i,k,l,r)+DFS(k+1,j,l,r));\n\t\t\tdp[i][j][l][r]=min(dp[i][j][l][r],\n\t\t\tDFS(i,k,0,0)+DFS(k+1,j,l,r));\n\t\t\tdp[i][j][l][r]=min(dp[i][j][l][r],\n\t\t\tDFS(i,k,l,r)+DFS(k+1,j,0,0));\n\t\t}\n\t\treturn dp[i][j][l][r];\n\t}\n}\n\nint main()\n{\n\tcin>>n>>a>>b;\n\tint i;\n\tfor(i=1;i<=n;i++)\n\t{\n\t \tcin>>c[i];\n\t\tw[i]=p[i]=c[i];\n\t}\n\tsort(p+1,p+n+1);\n\ttot=unique(p+1,p+n+1)-p-1;\n\tfor(i=1;i<=n;i++)\n\tw[i]=lower_bound(p+1,p+tot+1,c[i])-p;\n\tcout<<DFS(1,n,0,0)<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1653654098,
        "uid": 405253,
        "name": "00_00",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011P5336"
    },
    {
        "content": "## \u9898\u610f\uff1a\n\n\u4e00\u5806\u5b69\u5b50\u7684\u6210\u7ee9\u5355\uff0c\u6bcf\u6b21\u53d1\u8fde\u7eed\u7684\u4e00\u6bb5\uff0c\u4ee3\u4ef7\u662f $a + b \\times (maximum - minima)$ \u5176\u4e2d $a$ $b$ \u4e3a\u7ed9\u5b9a\u7cfb\u6570\uff0c $maximum$ $minima$ \u662f\u533a\u95f4\u5185\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\u3002\n\n## \u5206\u6790\uff1a\n\n\u8003\u8651\u533a\u95f4 $dp$ \uff0c\u7531\u4e8e\u533a\u95f4\u6700\u5927\u6700\u5c0f\u503c\u4e0d\u786e\u5b9a\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\u4e24\u79cd\u72b6\u6001\uff1a $g_{i,j}$ \u8868\u793a\u5220\u6389 $[i,j]$ \u533a\u95f4\u7684\u5f97\u5206\u6700\u5927\u503c\uff0c $dp_{i,j,l,r}$ \u8868\u793a\u5220\u6389\u533a\u95f4 $[i,j]$ \u4ee5 $w_{l}$ \u4e3a\u6700\u5c0f\u503c\u548c $w_{r}$ \u5f97\u5206\u6700\u5927\u503c\u3002\u72b6\u6001\u8bbe\u8ba1\u51fa\u6765\u4e86\uff0c\u8f6c\u79fb\u4e5f\u5f88\u597d\u60f3\u3002\n\n$dp_{i,j,l,r} = max({g_{i,k} + dp_{k+1,j,l,r} , dp_{i,k,l,r} + g_{k+1,j} , dp_{i,k,l,r} + dp_{k+1,j,l,r}})$ \u5176\u4e2d $i\\leq k< j$ \n\n$g_{i,j} = max({dp_{i,j,l,r} + a + B \\times (b_{r} - b_{l})^2})$  \n \u8fb9\u754c\u6761\u4ef6\u5c31\u662f $g_{i,i} = a$ $dp_{i,i,l,r} = 0$ \u5176\u4f59\u90fd\u4e3a\u6b63\u65e0\u7a77\u3002\n \n \u7136\u540e\u7ef4\u62a4\u8fd9\u4e2a\u6700\u5927\u6700\u5c0f\u503c\u7684\u679a\u4e3e\uff0c\u6211\u4eec\u79bb\u6563\u5316\u5373\u53ef\u3002\n \n ```cpp\n#include<cstdio>\n#include<queue>\n#include<iostream>\n#include<cstring>\n#include<algorithm>\n#include<cmath>\n#include<cctype>\n#include<vector>\n#include<string>\n#define rep(i,st,ed) for(int i=(st);i<=(ed);++i) \nusing namespace std;\nconst int inf = 0x3f3f3f3f;\nconst int N = 55;\nint n,a,B,dp[N][N][N][N],w[N],b[N],g[N][N]; \ninline void f(int &x,int y){x = min(x,y);}//\u61d2\u4eba\u6700\u5c0f\u503c \nint main(){\n\tmemset(dp,inf,sizeof(dp));\n\tmemset(g,inf,sizeof(g));//\u6b63\u65e0\u7a77 \n\tscanf(\"%d%d%d\",&n,&a,&B);\n\trep(i,1,n)scanf(\"%d\",&w[i]),b[i] = w[i];\n\tsort(b+1,b+1+n);\n\tint m = unique(b+1,b+1+n) - b - 1;//\u79bb\u6563\u5316+\u53bb\u91cd \n\trep(i,1,n)w[i] = lower_bound(b+1,b+m+1,w[i]) - b;\n\trep(i,1,n){\n\t\tg[i][i] = a;\t\n\t\trep(j,1,w[i])\n\t\t\trep(k,w[i],m)//\u679a\u4e3e\u6700\u5c0f\u6700\u5927\u503c \n\t\t\t\tdp[i][i][j][k] = 0;\n\t}//\u521d\u59cb\u5316 \n\trep(len,2,n)\n\t\tfor(int i=1,j;j=i+len-1,j<=n;++i){//\u5c0f\u533a\u95f4 -> \u5927\u533a\u95f4 \n\t\t\trep(l,1,m)//\u8fd9\u662f\u679a\u4e3e\u6700\u5c0f\u503c \n\t\t\trep(r,l,m)\t//\u679a\u4e3e\u5728\u4ed6\u53f3\u8fb9\u7684\u6700\u5927\u503c\uff0c\u56e0\u4e3a\u6211\u4eec\u662f\u79bb\u6563\u5316\u7684 \n\t\t\tfor(int k=i;k<j;++k){\n\t\t\t\tf(dp[i][j][l][r],g[i][k] + dp[k+1][j][l][r]);\n\t\t\t\tf(dp[i][j][l][r],dp[i][k][l][r] + g[k+1][j]);\n\t\t\t\tf(dp[i][j][l][r],dp[i][k][l][r] + dp[k+1][j][l][r]);//\u8f6c\u79fb \n\t\t\t}\n\t\t\trep(l,1,m)\n\t\t\trep(r,l,m)\n\t\t\tf(g[i][j],dp[i][j][l][r] + a + B * (b[r] - b[l]) * (b[r] - b[l]));//\u8f6c\u79fb \n\t\t}\n\tprintf(\"%d\\n\",g[1][n]);\n}\n\n```\n",
        "postTime": 1647995175,
        "uid": 141058,
        "name": "Xu_brezza",
        "ccfLevel": 0,
        "title": "P5336 \u9898\u89e3"
    },
    {
        "content": "$\\color{blue}{\\texttt{[Solution]}}$\n\n\u770b\u5230 $n$ \u8fd9\u4e48\u5c0f\uff0c\u4f30\u8ba1\u5c31\u662f\u8981\u533a\u95f4 dp\u3002\n\n\u4f46\u662f\uff0c\u5982\u679c\u4f60\u5355\u7eaf\u8bb0 $f_{i,j}$ \u8868\u793a\u628a\u533a\u95f4 $[i,j]$ \u5206\u5b8c\u7684\u6700\u5c0f\u4ef7\u503c\uff0c\u597d\u50cf\u90a3\u4e2a $w$ \u4e0d\u662f\u5f88\u597d\u7ef4\u62a4\u3002\n\n\n\n> \u4e0d\u77e5\u542c\u54ea\u4f4d\u5927\u4f6c\u8bf4\u8fc7\u8fd9\u4e48\u4e00\u53e5\u8bdd\uff1a\uff08dp \u65f6\uff09\u4f60\u6253\u4e0d\u8fc7\u7684\u4e1c\u897f\uff08\u7ef4\u62a4\u4e0d\u4e86\u7684\u4e1c\u897f\uff09\uff0c\u90a3\u5c31\u52a0\u5165\u5b83\uff08\u5982\u679c\u5141\u8bb8\uff0c\u5c31\u628a\u5b83\u5199\u5165\u72b6\u6001\uff09\u3002\n\n\u672c\u9898\u5c31\u662f\u8fd9\u6837\uff1a$w$ \u4e0d\u597d\u7ef4\u62a4\uff0c\u6240\u4ee5\u6211\u4eec\u8bb0 $f(i,j,l,r)$ \u8868\u793a\u628a\u533a\u95f4 $[i,j]$ \u4e2d\u9009\u51fa\u4e00\u4e9b\u6570\u540e\uff0c**\u6240\u6709\u7684\u5269\u4e0b\u7684\u6570**\u90fd\u5728 $[l,r]$ \u8303\u56f4\u5185\u7684\u6700\u5c0f\u4ee3\u4ef7\uff08\u800c\u4e14\u4e00\u5b9a\u6709 $l,r$ \u8fd9\u4e24\u4e2a\u6570\u5b57\u5269\u4e0b\uff09\u3002\u7279\u522b\u5730\uff0c$f(i,j,0,0)$ \u8868\u793a\u628a $[i,j]$ \u53d6\u5b8c\u3002\n\n$1 \\leq w_{i} \\leq 1000$\uff0c\u7a7a\u95f4\u591f\u545b\u7684\uff0c\u4f46\u662f $w_{i}$ \u7684\u7edd\u5bf9\u5927\u5c0f\u4e0d\u91cd\u8981\uff0c\u53ef\u4ee5\u79bb\u6563\u5316\u3002\n\n\u4e0b\u9762\u7684\u5206\u6790\u4e2d\u4ecd\u7136\u8ba4\u4e3a $l,r$ \u662f\u79bb\u6563\u5316\u524d\u7684\u6570\u3002\u8003\u8651\u8f6c\u79fb\u3002\n\n- $f(i,j,0,0)$\n\n  \u5982\u679c\u6211\u4eec\u4e00\u6b21\u628a\u533a\u95f4 $[i,j]$ \u5168\u90e8\u53d6\u5b8c\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f\uff1a\n\n  $$a+b \\times \\left ( \\max\\limits_{k=i}^{j}\\{ w_{k} \\} - \\min \\limits_{k=i}^{j}  \\{ w_{k} \\}\\right )^{2}$$\n\n  \u5f53\u7136\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5148\u53d6\u90e8\u5206\u6570\u5b57\uff0c\u7559\u4e0b\u5c5e\u4e8e $[l,r]$ \u8fd9\u4e2a\u8303\u56f4\u7684\u6570\uff0c\u5269\u4e0b\u7684\u4e00\u6b21\u53d6\u5b8c\uff0c\u7b54\u6848\u662f\uff1a\n\n  $$f(i,j,l,r)+a+b \\times (r-l)^{2}$$\n\n- $f(i,j,l,r) \\quad \\text{s.t.} \\quad l,r \\not = 0$\n\n  \u6ca1\u4ec0\u4e48\u7279\u6b8a\u7684\uff0c\u5c31\u662f\u66b4\u529b\u679a\u4e3e\u533a\u95f4\u65ad\u70b9 $k$\uff0c\u5de6\u53f3\u4e24\u7aef\u90fd\u53ef\u4ee5\u53d6\u5b8c\uff0c\u6216\u8005\u7559\u4e0b\u5c5e\u4e8e $[l,r]$ \u7684\u6570\u4e0d\u53d6\uff0c\u4f46\u662f\u4e0d\u80fd\u4e24\u8fb9\u90fd\u53d6\u5b8c\u4e86\u3002\n\n  $$\\min\\{ f(i,k,l,r)+f(k+1,j,l,r), f(i,k,l,r)+f(k+1,j,0,0),f(i,k,0,0)+f(k+1,j,0,0)\\}$$\n\n\n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\u3002\u6211\u5199\u7684\u662f\u8bb0\u5fc6\u5316\uff0c\u5728\u6d1b\u8c37\u4e0a\u4f3c\u4e4e\u8981\u5f00\u6c27\u6c14\u624d\u53ef\u4ee5\u8fc7\uff0c\u4f46\u662f\u4e00\u672c\u901a\u53ef\u4ee5\u76f4\u63a5\u8fc7\u3002\n\n**\u4e3b\u8981\u601d\u8def\u6765\u6e90\u4e8e\u300a\u4e00\u672c\u901a\u00b7\u9ad8\u624b\u8fdb\u9636\u300b**\u3002\n\n$\\color{blue}{\\texttt{[Code]}}$\n\n```cpp\ninline int ckmax(int &a,int b){\n\treturn (a=((a<b)?b:a));\n}\ninline int ckmin(int &a,int b){\n\treturn (a=((a>b)?b:a));\n}\n\nconst int inf=0x3f3f3f3f;\n\nbool vis[55][55][55][55];\nint n,a,b,w[55],p[55],c[55];\nint f[55][55][55][55],tot;\n\nint dp(int i,int j,int l,int r){\n\tif (vis[i][j][l][r])\n\t\treturn f[i][j][l][r];\n\tvis[i][j][l][r]=true;\n\t\n\tint &res=f[i][j][l][r];\n\tres=inf;//Don't forget it\n\t\n\tif (l==0&&r==0){\n\t\tint x=inf,y=-inf;\n\t\t\n\t\tfor(int k=i;k<=j;k++){\n\t\t\tckmin(x,c[k]);\n\t\t\tckmax(y,c[k]);\n\t\t}\n\t\t\n\t\tres=a+b*(y-x)*(y-x);\n\t\t\n\t\tfor(int x=1;x<=tot;x++)\n\t\t\tfor(int y=1;y<=tot;y++)\n\t\t\t\tckmin(res,dp(i,j,x,y)+a+b*(p[y]-p[x])*(p[y]-p[x]));\n\t}\n\telse{\n\t\tif (i==j){\n\t\t\tif (l<=w[i]&&w[i]<=r)\n\t\t\t\treturn res=0;\n\t\t}\n\t\tfor(int k=i;k<j;k++){\n\t\t\tckmin(res,dp(i,k,l,r)+dp(k+1,j,l,r));\n\t\t\tckmin(res,dp(i,k,l,r)+dp(k+1,j,0,0));\n\t\t\tckmin(res,dp(i,k,0,0)+dp(k+1,j,l,r));\n\t\t}\n\t}\n\t\n\treturn res;\n}\n\nint main(){\n\tscanf(\"%d%d%d\",&n,&a,&b);\n\t\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%d\",&c[i]);\n\t\tw[i]=p[i]=c[i];\n\t}\n\t\n\tsort(p+1,p+n+1);\n\ttot=unique(p+1,p+n+1)-p-1;\n\tfor(int i=1;i<=n;i++)\n\t\tw[i]=lower_bound(p+1,p+tot+1,c[i])-p;\n\t\n\tprintf(\"%d\",dp(1,n,0,0));\n\t\n\treturn 0;\n}\n```",
        "postTime": 1643113859,
        "uid": 95624,
        "name": "HPXXZYY",
        "ccfLevel": 7,
        "title": "the Solution of Problem P5336"
    },
    {
        "content": "**\u7b80\u5355\u533a\u95f4dp\u3002**\n\n\u8003\u8651 $f_{i,j,mn,mx}$\u8868\u793a $i,j$ \u533a\u95f4\u7684\u6700\u5927\u503c\u4e3a $mx$\uff0c\u6700\u5c0f\u503c\u4e3a $mn$ \u7684\u6700\u5c0f\u82b1\u8d39\uff0c$g_{i,j}$ \u4e3a\u5220\u6389 $[i,j]$ \u7684\u6700\u5c0f\u82b1\u8d39\u3002\u76ee\u6807\u7b54\u6848:$g_{1,n}$\n\n\u6211\u4eec\u5bb9\u6613\u53d1\u73b0\u8fd9\u4e2a\u72b6\u6001\u53ef\u4ee5\u7531\u533a\u95f4 $[L,R-1]$ \u548c $[R,R]$ \u5408\u5e76\u8d77\u6765\uff0c\u5373\u52a0\u5165\u4e00\u4e2a $v_r$ \uff0c\u7b2c\u4e00\u4e2a\u8f6c\u79fb\u65b9\u7a0b $f_{i,j,\\min(mn,v_r),\\max(mx,v_r)} = \\min \\{f_{i,j-1,mn,mx}\\}$\n\n\u6211\u4eec\u8fd8\u53ef\u4ee5\u679a\u4e3e\u65ad\u70b9 $k$ \uff0c \u628a\u533a\u95f4\u5206\u6210 $[L,k]$ \u548c $[k+1,r]$\n$f_{i,j,mn,mx} = \\min (f_{i,j,mn,mx},f_{i,k,mn,mx} + g_{k+1,r})$\n\n\u66f4\u65b0 $g_{l,r}$\n\n\u679a\u4e3e $f_{l,r,mn,mx}$ \u6700\u5c0f\u503c\u4e3a $mn$\uff0c\u6700\u5c0f\u503c\u4e3a $mx$\uff0c\u6a21\u62df\u5220\u53bb\u8fc7\u7a0b\u5c31\u597d\u4e86\u3002\n\n$g_{l,r} = \\min(f_{l,r,mn,mx}+a+b(mx-mn)^2)$\n\n\u8fd9\u9898\u6ca1\u4e86\n\n```cpp\n// powered by c++11\n// by Isaunoya\n#include<bits/stdc++.h>\n#define rep(i , x , y) for(register int i = (x) ; i <= (y) ; ++ i)\n#define Rep(i , x , y) for(register int i = (x) ; i >= (y) ; -- i)\nusing namespace std ;\nusing db = double ;\nusing ll = long long ;\nusing uint = unsigned int ;\n#define int long long\nusing pii = pair < int , int > ;\n#define ve vector\n#define Tp template\n#define all(v) v.begin() , v.end()\n#define sz(v) ((int)v.size())\n#define pb emplace_back\n#define fir first\n#define sec second\n// the cmin && cmax\nTp < class T > void cmax(T & x , const T & y) {\n\t\tif(x < y) x = y ;\n}\nTp < class T > void cmin(T & x , const T & y) {\n\t\tif(x > y) x = y ;\n}\n// sort , unique , reverse\nTp < class T > void sort(ve < T > & v) {\n\t\tsort(all(v)) ;\n}\nTp < class T > void unique(ve < T > & v) {\n\t\tsort(all(v)) ;\n\t\tv.erase(unique(all(v)) , v.end()) ;\n}\nTp < class T > void reverse(ve < T > & v) {\n\t\treverse(all(v)) ;\n}\nconst int SZ = 0x191981 ;\nstruct FILEIN {\n\t~ FILEIN () {} char qwq[SZ] , * S = qwq , * T = qwq , ch ;\n\tchar GETC() {\n\t\treturn (S == T) && (T = (S = qwq) + fread(qwq , 1 , SZ , stdin) , S == T) ? EOF : * S ++ ;\n\t}\n\tFILEIN & operator >> (char & c) {\n\t\twhile(isspace(c = GETC())) ;\n\t\treturn * this ;\n\t}\n\tFILEIN & operator >> (string & s) {\n\t\twhile(isspace(ch = GETC())) ;\n\t\ts = ch ;\n\t\twhile(! isspace(ch = GETC())) s += ch ;\n\t\treturn * this ;\n\t}\n\tTp < class T > void read(T & x) {\n\t\t\tbool sign = 1 ;\n\t\t\twhile((ch = GETC()) < 0x30) if(ch == 0x2d) sign = 0 ;\n\t\t\tx = (ch ^ 0x30) ;\n\t\t\twhile((ch = GETC()) > 0x2f) x = x * 0xa + (ch ^ 0x30) ;\n\t\t\tx = sign ? x : -x ;\n\t}\n\tFILEIN & operator >> (int & x) {\n\t\treturn read(x) , * this ;\n\t}\n\tFILEIN & operator >> (signed & x) {\n\t\treturn read(x) , * this ;\n\t}\n\tFILEIN & operator >> (unsigned & x) {\n\t\treturn read(x) , * this ;\n\t}\n} in ;\nstruct FILEOUT {\n\tconst static int LIMIT = 0x114514 ;\n\tchar quq[SZ] , ST[0x114] ;\n\tsigned sz , O ;\n\t~ FILEOUT () {\n\t\tsz = O = 0 ;\n\t}\n\tvoid flush() {\n\t\tfwrite(quq , 1 , O , stdout) ;\n\t\tfflush(stdout) ;\n\t\tO = 0 ;\n\t}\n\tFILEOUT & operator << (char c) {\n\t\treturn quq[O ++] = c , * this ;\n\t}\n\tFILEOUT & operator << (string str) {\n\t\tif(O > LIMIT) flush() ;\n\t\tfor(char c : str) quq[O ++] = c ;\n\t\treturn * this ;\n\t}\n\tTp < class T > void write(T x) {\n\t\t\tif(O > LIMIT) flush() ;\n\t\t\tif(x < 0) {\n\t\t\t\tquq[O ++] = 0x2d ;\n\t\t\t\tx = -x ;\n\t\t\t}\n\t\t\tdo {\n\t\t\t\tST[++ sz] = x % 0xa ^ 0x30 ;\n\t\t\t\tx /= 0xa ;\n\t\t\t} while(x) ;\n\t\t\twhile(sz) quq[O ++] = ST[sz --] ;\n\t\t\treturn ;\n\t}\n\tFILEOUT & operator << (int x) {\n\t\treturn write(x) , * this ;\n\t}\n\tFILEOUT & operator << (signed x) {\n\t\treturn write(x) , * this ;\n\t}\n\tFILEOUT & operator << (unsigned x) {\n\t\treturn write(x) , * this ;\n\t}\n} out ;\n\nint n , a , b ;\nconst int maxn = 52 ;\nint f[maxn][maxn][maxn][maxn] ;\nint g[maxn][maxn] ;\nsigned main() {\n#ifdef _WIN64\n\tfreopen(\"testdata.in\" , \"r\" , stdin) ;\n#else\n\tios_base :: sync_with_stdio(false) ;\n\tcin.tie(nullptr) , cout.tie(nullptr) ;\n#endif\n// code begin.\n\tin >> n >> a >> b ;\n\tvector < int > v(n) , c(n) ;\n\tfor(int i = 0 ; i < n ; i ++) {\n\t\tin >> v[i] ;\n\t\tc[i] = v[i] ;\n\t}\n\tunique(c) ; int siz = sz(c) ;\n\tmemset(f , 0x3f , sizeof(f)) ;\n\tmemset(g , 0x3f , sizeof(g)) ; \n\tfor(int i = 0 ; i < n ; i ++) {\n\t\tv[i] = lower_bound(all(c) , v[i]) - c.begin() ;\n\t\tf[i][i][v[i]][v[i]] = 0 ;\n\t\tg[i][i] = a ;\n\t}\n\tfor(int len = 1 ; len <= n ; len ++) {\n\t\tfor(int l = 0 ; l + len - 1 < n ; l ++) {\n\t\t\tint r = l + len - 1 ;\n\t\t\t\n\t\t\tfor(int mn = 0 ; mn < siz ; mn ++)\n\t\t\t\tfor(int mx = mn ; mx < siz ; mx ++)\n\t\t\t\t\tcmin(f[l][r][min(mn , v[r])][max(mx , v[r])] , f[l][r - 1][mn][mx]) ;\n\t\t\t\t\t\n\t\t\tfor(int k = l ; k < r ; k ++)\n\t\t\t\tfor(int mn = 0 ; mn < siz ; mn ++)\n\t\t\t\t\tfor(int mx = mn ; mx < siz ; mx ++)\n\t\t\t\t\t\tcmin(f[l][r][mn][mx] , f[l][k][mn][mx] + g[k + 1][r]) ;\n\t\t\t\t\t\t\n\t\t\tfor(int mn = 0 ; mn < siz ; mn ++)\n\t\t\t\tfor(int mx = mn ; mx < siz ; mx ++)\n\t\t\t\t\tcmin(g[l][r] , f[l][r][mn][mx] + a + b * (c[mx] - c[mn]) * (c[mx] - c[mn])) ;\n\t\t\t\t\t\n\t\t}\n\t}\n\tout << g[0][n - 1] << '\\n' ;\n\treturn out.flush() , 0 ;\n// code end.\n}\n```",
        "postTime": 1580793870,
        "uid": 96580,
        "name": "SXNhdW5veWE",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5336 \u3010[THUSC2016]\u6210\u7ee9\u5355\u3011"
    }
]
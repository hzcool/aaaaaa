[
    {
        "content": "[\u53ef\u80fd\u66f4\u597d\u7684\u4f53\u9a8c](https://mrsrz.github.io/2019/12/13/lg5809/)\r\n\r\n\u5bf9\u4e8e\u6ee1\u8db3 $G(F(x))=x$ \u4e14 $F(x)$ \u7684\u5e38\u6570\u9879\u4e3a $0$\uff0c\u4e00\u6b21\u9879\u6709\u9006\u5143\u7684\u591a\u9879\u5f0f $F(x),G(x)$\uff0c\u6709\u62c9\u683c\u6717\u65e5\u53cd\u6f14\u516c\u5f0f\uff1a\r\n$$[x^n]G(x)=\\frac 1{n}[x^{n-1}](\\frac{x}{F(x)})^n$$\r\n\u8fd9\u4e2a\u53ef\u4ee5\u6c42\u5355\u9879\u7cfb\u6570\u3002\u6211\u4eec\u8981\u6c42\u6240\u6709\u7cfb\u6570\u3002\r\n\r\n\u6309\u591a\u9879\u5f0f\u590d\u5408\u7684\u505a\u6cd5\u6765\u5c31\u53ef\u4ee5\u4e86\u3002\r\n\r\n\u4ee4 $L=\\sqrt n$\u3002\r\n\r\n\u90a3\u4e48\u6709\uff1a\r\n$$G(x)=\\sum_{i=1}^n \\left(\\frac{1}{i}[x^{i-1}](\\frac{x}{F(x)})^i\\right)x^i$$\r\n$$=\\sum_{i=0}^{L-1} \\sum_{j=1}^L \\left(\\frac{1}{iL+j}[x^{iL+j-1}](\\frac{x}{F(x)})^{iL+j}\\right)x^{iL+j}$$\r\n$$=\\sum_{i=0}^{L-1}\\sum_{j=1}^L \\left(\\frac{1}{iL+j}[x^{iL+j-1}](\\frac{x}{F(x)})^{iL}(\\frac{x}{F(x)})^j\\right)x^{iL+j}$$\r\n\u5176\u4e2d\uff0c$(\\frac{x}{F(x)})^{iL}$ \u548c $(\\frac{x}{F(x)})^{j}$ \u6211\u4eec\u53ef\u4ee5\u76f4\u63a5 FFT \u9884\u5904\u7406\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\sqrt n\\log n)$\u3002\r\n\r\n\u89c2\u5bdf $[x^{iL+j-1}] (\\frac{x}{F(x)})^{iL}(\\frac{x}{F(x)})^j$\uff0c\u8fd9\u90e8\u5206\u76f8\u5f53\u4e8e\u7ed9\u51fa\u4e24\u4e2a\u591a\u9879\u5f0f\uff0c\u6c42\u5b83\u4eec\u7684\u4e58\u79ef\u7684\u67d0\u4e00\u9879\u7cfb\u6570\u3002\u8fd9\u4e2a\u53ef\u4ee5 $O(n)$ \u66b4\u529b\u6c42\u5f97\u3002\u5e38\u6570\u5f88\u5c0f\u3002\r\n\r\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2+n\\sqrt n\\log n)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\r\n\r\n## Code\uff1a\r\n\r\n```cpp\r\n#include<iostream>\r\n#include<algorithm>\r\n#include<cmath>\r\n#define lg2(x)(31-__builtin_clz((x)))\r\nusing namespace std;\r\ntypedef long long LL;\r\nconst int N=32769,BS=140,md=998244353;\r\nint n,a[N],b[N],rev[N],lim,LG,L;\r\nint G[15][N];\r\nint B[BS][N],B_[BS][N];\r\ninline void upd(int&a){a+=a>>31&md;}\r\ninline int pow(int a,int b){\r\n\tint ret=1;\r\n\tfor(;b;b>>=1,a=(LL)a*a%md)if(b&1)ret=(LL)ret*a%md;\r\n\treturn ret;\r\n}\r\nvoid init(int n){\r\n\tint l=-1;\r\n\tfor(lim=1;lim<n;lim<<=1)++l;LG=l+1;\r\n\tfor(int i=1;i<lim;++i)\r\n\trev[i]=(rev[i>>1]>>1)|((i&1)<<l);\r\n}\r\nvoid FFT(int*a,int f){\r\n\tfor(int i=1;i<lim;++i)\r\n\tif(i<rev[i])swap(a[i],a[rev[i]]);\r\n\tfor(int i=0;i<LG;++i){\r\n\t\tconst int*g=G[i],c=1<<i;\r\n\t\tfor(int j=0;j<lim;j+=c<<1)\r\n\t\tfor(int k=0;k<c;++k){\r\n\t\t\tconst int x=a[j+k],y=g[k]*(LL)a[j+k+c]%md;\r\n\t\t\tupd(a[j+k]+=y-md),upd(a[j+k+c]=x-y);\r\n\t\t}\r\n\t}\r\n\tif(!f){\r\n\t\tconst int iv=pow(lim,md-2);\r\n\t\tfor(int i=0;i<lim;++i)a[i]=(LL)a[i]*iv%md;\r\n\t\treverse(a+1,a+lim);\r\n\t}\r\n}\r\nvoid INV(int*a,int*B,int n){\r\n\tif(n==1){\r\n\t\t*B=pow(*a,md-2);\r\n\t\treturn;\r\n\t}\r\n\tINV(a,B,n+1>>1);\r\n\tinit(n<<1);\r\n\tstatic int A[N];\r\n\tfor(int i=0;i<n;++i)A[i]=a[i];\r\n\tfor(int i=n;i<lim;++i)A[i]=0;\r\n\tFFT(A,1),FFT(B,1);\r\n\tfor(int i=0;i<lim;++i)B[i]=B[i]*(2-B[i]*(LL)A[i]%md+md)%md;\r\n\tFFT(B,0);\r\n\tfor(int i=n;i<lim;++i)B[i]=0;\r\n}\r\nint main(){\r\n\tios::sync_with_stdio(0),cin.tie(0),cout.tie(0);\r\n\tcin>>n>>a[0];--n;\r\n\tfor(int i=0;i<15;++i){\r\n\t\tint*g=G[i];\r\n\t\tg[0]=1;\r\n\t\tconst int gi=pow(3,(md-1)/(1<<i+1));\r\n\t\tfor(int j=1;j<1<<i;++j)\r\n\t\tg[j]=(LL)g[j-1]*gi%md;\r\n\t}\r\n\tfor(int i=0;i<n;++i)cin>>a[i];\r\n\tcout.put('0');\r\n\tINV(a,b,n);\r\n\tL=sqrt(n)+1;\r\n\tinit(n<<1);\r\n\t**B=1;\r\n\tFFT(*B,1);\r\n\tfor(int i=0;i<lim;++i)B_[0][i]=B[0][i];\r\n\tfor(int i=0;i<n;++i)B[1][i]=b[i];\r\n\tFFT(B[1],1);\r\n\tfor(int i=2;i<=L;++i){\r\n\t\tfor(int j=0;j<lim;++j)\r\n\t\tB[i][j]=(LL)B[i-1][j]*B[1][j]%md;\r\n\t\tFFT(B[i],0);\r\n\t\tfor(int j=n;j<lim;++j)B[i][j]=0;\r\n\t\tFFT(B[i],1);\r\n\t}\r\n\tfor(int i=0;i<lim;++i)B_[0][i]=B[0][i],B_[1][i]=B[L][i];\r\n\tfor(int i=2;i<=L;++i){\r\n\t\tfor(int j=0;j<lim;++j)\r\n\t\tB_[i][j]=(LL)B_[i-1][j]*B_[1][j]%md;\r\n\t\tFFT(B_[i],0);\r\n\t\tfor(int j=n;j<lim;++j)B_[i][j]=0;\r\n\t\tFFT(B_[i],1);\r\n\t}\r\n\tfor(int i=0;i<=L;++i)FFT(B[i],0),FFT(B_[i],0);\r\n\tfor(int i=0;i<L;++i){\r\n\t\tint*g_=B_[i];\r\n\t\tfor(int j=1;j<=L;++j){\r\n\t\t\tconst int x=i*L+j-1;\r\n\t\t\tif(x>=n)return 0;\r\n\t\t\tint*g=B[j];\r\n\t\t\tint ans=0;\r\n\t\t\tfor(register int t=0;t<=x;++t)\r\n\t\t\tans=(ans+(LL)g_[t]*g[x-t])%md;\r\n\t\t\tcout<<' '<<(LL)ans*pow(x+1,md-2)%md;\r\n\t\t}\r\n\t}\r\n\treturn 0;\r\n}\r\n```\r\n",
        "postTime": 1576248214,
        "uid": 6813,
        "name": "mrsrz",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5809 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u590d\u5408\u9006\u3011"
    }
]
[
    {
        "content": "[$\\text{Link}$](https://www.luogu.com.cn/problem/P7335)\n## \u9898\u610f\n\n\u7ed9\u4f60 $n,k$ \u548c\u5e8f\u5217 $a_{1,2\\dots n}$\uff0c\u9009\u51fa $k$ \u4e2a**\u4e0d\u4ea4**\u533a\u95f4 $[l_i,r_i]\\subset[1,n]$\uff0c\u6c42\u51fa\n$$\\max_{l_i,r_i}\\sum_{i=1}^k\\bigoplus_{j=l_i}^{r_i}a_j$$\n\n$1\\le k\\le n\\le 3000,0\\le a_i\\le 10^9$\u3002\n\n**\u4fdd\u8bc1\u6570\u636e\u968f\u673a\u3002**\n\n## \u601d\u8def\n$\\text{Update 2022.4.22}$\uff1a\u91cd\u6784\u5168\u6587\u3002\n### $\\text{Subtask 1}$\n$O(n^{2k})$ \u66b4\u529b\u5bfb\u627e\u5de6\u53f3\u7aef\u70b9\u5373\u53ef\u3002\n\n### $\\text{Subtask }2 \\sim4$\n\u6211\u4eec\u9996\u5148\u601d\u8003\u600e\u4e48\u5904\u7406 $k=1$ \u7684\u60c5\u51b5\uff0c\u8fd9\u662f\u4e00\u4e2a\u7ecf\u5178\u95ee\u9898\u3002\n\n\u8bbe $p_i=\\bigoplus_{j=1}^{i}a_j$\uff0c\u5219 $\\bigoplus_{j=l}^{r}a_j=p_r\\text{ xor }p_{l-1}$\uff0c\u6211\u4eec\u8003\u8651\u5bf9\u4e8e\u6bcf\u4e2a $r$ \u5feb\u901f\u627e\u51fa $l$ \u4f7f\u5f97\u4e0a\u5f0f\u6700\u5927\uff0c\u5bf9 $p$ \u5efa\u51fa $\\text{01Trie}$\uff0c\u5728\u4e0a\u9762\u8d2a\u5fc3\u5730\u9009\u62e9\u4e0d\u540c\u7684\u513f\u5b50\u5373\u53ef\u3002\n\n\u6211\u4eec\u8bbe $f_{l,r}=\\displaystyle\\max_{l\\le i,j\\le r}p_i\\text{ xor }p_j$\uff0c\u5373\u5728 $p_{l,l+1,...,r}$ \u4e2d\u9009 $2$ \u4e2a\u6570\u4f7f\u5b83\u4eec\u5f02\u6216\u548c\u6700\u5927\u3002\n\n\u8bbe\u5904\u7406\u5230\u7b2c $i+1\\sim n$ \u4e2a\u6570\uff0c\u7b2c $j\\sim k$ \u4e2a\u533a\u95f4\u7684\u7b54\u6848\u4e3a $dp_{i,j}$\uff0c\u5219 $dp_{i,j}=\\displaystyle\\max_{k=i}^{n-1}(dp_{k,j+1}+f_{i,k+1})$\u3002\n\n\u66b4\u529b\u5904\u7406\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3)$\u3002\n### $\\text{Subtask }5\\sim7$\n\u53d1\u73b0\u4e0a\u9762\u7684\u72b6\u6001\u8f6c\u79fb\u65b9\u5f88\u96be\u4f18\u5316\uff0c\u56e0\u4e3a $f_{i,k+1}$ \u662f\u53d8\u5316\u7684\uff0c\u5982\u679c $k=f_{i,k+1}$ \u4e0d\u53d8\u7684\u8bdd\uff0c$dp_{i,j}=\\displaystyle\\max_{k=i}^{n-1}(dp_{k,j+1}+f_{i,k+1})=\\displaystyle\\max_{k=i}^{n-1}(dp_{k,j+1})+k$.\n\n\u4e8e\u662f\u6211\u4eec\u6253\u4e00\u4e2a\u8868\u89c2\u5bdf\u4e00\u4e0b\u53d1\u73b0 $i$ \u56fa\u5b9a\u65f6\uff0c\u5bf9\u4e8e $k\\in[i,n]$\uff0c$f_{i,k}$ \u4e0d\u540c\u7684\u503c\u5f88\u5c11\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u628a\u76f8\u540c\u7684 $f_{i,k}$ \u538b\u7f29\u8d77\u6765\uff0c\u5bf9\u4e8e $f_{i,k}$ \u76f8\u540c\u7684\u4e00\u6bb5\u533a\u95f4 $k\\in[l,r]$\uff0c\u6211\u4eec\u6c42\u51fa $f_{i,l}+\\displaystyle\\max_{i=l}^rdp_{i,j+1}$ \u5373\u53ef\u3002\n\n\u6211\u4eec\u53d1\u73b0 $f$ \u6570\u7ec4\u5355\u8c03\u4e0d\u9012\u51cf\uff0c$dp$ \u6570\u7ec4\u5355\u8c03\u4e0d\u9012\u589e\uff0c\u4e8e\u662f\u4e0a\u9762\u7684\u5f0f\u5b50\u5c31\u7b49\u4ef7\u4e8e $dp_{i,j}=\\displaystyle\\max_{l,r}(f_{i,l}+dp_{l,j+1})$\u3002\n\n\u73b0\u5728\u6211\u4eec\u6765\u8bc1\u660e\u8fd9\u4e2a\u7b97\u6cd5\u7684\u590d\u6742\u5ea6\u6b63\u786e\u3002\n\n\u7531\u4e8e\u6570\u636e\u968f\u673a\u751f\u6210\uff0c\u5f53\u6211\u4eec\u63d2\u5165\u4e00\u4e2a\u6570\u65f6\uff0c\u8bbe\u6b64\u65f6\u5df2\u7ecf\u63d2\u5165 $m$ \u4e2a\u6570\uff0c\u8fd9\u65f6\u5019\u4e00\u5171\u6709 $\\dfrac {(m+1)m} 2$ \u4e2a\u5f02\u6216\u548c\uff0c\u8fd9\u4e2a\u6570\u53ef\u4ee5\u8d21\u732e $m$ \u4e2a\u5f02\u6216\u548c\u3002\u5373\u6709 $\\dfrac 2 {m+1} $ \u7684\u51e0\u7387\u6210\u4e3a $\\max$\uff0c\u8fd9\u4e2a\u6570\u8d21\u732e\u4e86 $\\dfrac 2 {m+1} $ \u7684\u671f\u671b\u3002\n\n\u6240\u4ee5 $f_{i,k}$ \u4e2d\u7684\u6570\u7684\u4e2a\u6570\u7684\u671f\u671b\u4e3a $\\sum_{i=1}^{n}\\dfrac 2 {i}\u22482\\times\\log n$\uff0c\u6240\u4ee5\u671f\u671b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^2\\log w+nk\\log n)$\u3002\n\n\u671f\u671b\u5f97\u5206 $100$ \u5206\u3002\n\n\u53e6\u5916\uff0c\u7531\u4e8e\u6570\u636e\u968f\u673a\uff0c\u66b4\u529b\u8f6c\u79fb\u8f83\u5c11\u7684\u6570\u7684 $\\text{dp}$ \u4e5f\u53ef\u4ee5\u8fc7\uff0c\u5bf9\u7b56\u5728\u8003\u8651\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u89c1\u4ee5\u4e0b\u4ee3\u7801\uff08\u6211\u5f88\u4e45\u4ee5\u524d\u5199\u7684\uff0c\u6709\u70b9\u4e11\u8bf7\u89c1\u8c05\uff09\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nint maxn;\nstruct trie{//01-Trie\n\tint cnt;\n\tint son[90005][2];\n\ttrie(){\n\t\tcnt=1;\n\t}\n\tvoid clear(){\n\t\tfor(int i=1;i<=cnt;i++){\n\t\t\tson[i][0]=son[i][1]=0;\n\t\t}\n\t\tcnt=1;\n\t}\n\tvoid insert(int x){\n\t\tint rt=1;\n\t\tfor(int i=29;i>=0;i--) {\n\t\t\tif(!son[rt][(x>>i)&1])\n\t\t\t\tson[rt][(x>>i)&1]=++cnt;\n\t\t\trt=son[rt][(x>>i)&1];\n\t\t}\n\t}\n\tint find(int x){\n\t\tint rt=1,ans=0;\n\t\tfor(int i=29;i>=0;i--){\n\t\t\tif(son[rt][!((x>>i)&1)]) rt=son[rt][!((x>>i)&1)],ans+=1<<i;\n\t\t\telse rt=son[rt][(x>>i)&1];\n\t\t}\n\t\treturn ans;\n\t}\n}t;\nstruct line{\n\tint l,r;\n\tint val;\n\tline(){\n\t\tl=r=val=0;\n\t}\n\tline(int a,int b,int c){\n\t\tl=a,r=b,val=c;\n\t}\n};\nstruct array{\n\tline s[100];\n\tint len;\n\tarray(){\n\t\tlen=0;\n\t}\n\tint operator[](const int &x){\n\t\treturn s[x].val;\n\t}\n\tinline void init(int i){\n\t\tlen=1;\n\t\ts[1].l=0;\n\t\ts[1].r=i;\n\t\ts[1].val=0;\n\t}\n\tinline void insert(int x,int v){//\u538b\u7f29ans\u6570\u7ec4\n\t\tif(v==s[len].val){\n\t\t\ts[len].r=x;\n\t\t}else{\n\t\t\tlen++;\n\t\t\ts[len].l=x;\n\t\t\ts[len].r=x;\n\t\t\ts[len].val=v;\n\t\t}\n\t}\n\tinline int top(){\n\t\treturn s[len].val;\n\t}\n}ans[3005];\nint a[3005];\nint n,k;\nvoid init(){//\u9884\u5904\u7406ans\n\tfor(int i=0;i<=n;i++){\n\t\tt.clear();\n\t\tt.insert(a[i]);\n\t\tans[i].init(i);\n\t\tfor(int j=i+1;j<=n;j++){\n\t\t\tint now=t.find(a[j]);\n\t\t\tans[i].insert(j,max(ans[i].top(),t.find(a[j])));\n\t\t\tt.insert(a[j]);\n\t\t}\n\t}\t\n}\nnamespace IO{\n\t//read()\n}using namespace IO;\nll dp[3005][2];\nint main(){\n\tn=read(),k=read();\n\tfor(int i=1;i<=n;i++)\n\t\ta[i]=read()^a[i-1];\n\tinit();\n\tfor(int i=k-1;i<=n;i++){\n\t\tdp[i][k&1]=ans[i].top();\n\t}\n\tfor(int d=k-1;d;d--){//dp\n\t\tint s=d&1;//\u6eda\u52a8\u6570\u7ec4\u4f18\u5316\n\t\tfor(int l=n;l>=0;l--){\n\t\t\tll mx=0;\n\t\t\tint r=1;\n\t\t\tmx=ans[l][r]+dp[l][!s];\n\t\t\tfor(r++;r<=ans[l].len;r++){\n\t\t\t\tif(dp[ans[l].s[r].l][!s]+ans[l].top()<mx) break;//\u526a\u679d\n\t\t\t\tmx=max(mx,dp[ans[l].s[r].l][!s]+ans[l][r]);\n\t\t\t}\n\t\t\tdp[l][s]=mx;\n\t\t}\n\t}\n\tcout<<dp[0][1];\n}\n```\n\u518d\u89c1 qwq~",
        "postTime": 1610630021,
        "uid": 365127,
        "name": "cyffff",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P7335\u3010[JRKSJ R1] \u5f02\u6216\u3011"
    }
]
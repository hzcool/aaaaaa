[
    {
        "content": "# \u5e8f\u5217 \u9898\u89e3\n\nupd:\u4fee\u4e86\u4e00\u4e0b LaTeX\u3002\n\n### Subtask 1\n\n\u7b54\u6848\u663e\u7136\u662f $k+1$\u3002\n\n### Subtask 2\n\n\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c\u7b54\u6848\u4e3a $(k+1)^n$\u3002\n\n### Subtask 3\n\n\u66b4\u529b\u679a\u4e3e\u5e8f\u5217\u6bcf\u4e00\u4e2a\u6570\u7684\u503c\u7136\u540e\u5224\u65ad\u662f\u5426\u6ee1\u8db3\u6761\u4ef6\u3002\n\n### Subtask 4\n\n\u4e24\u4e2a\u6570\u5f02\u6216\u548c\u4e3a $0$ \u5c31\u662f\u4e24\u4e2a\u6570\u76f8\u7b49\uff0c\u90a3\u4e48\u5982\u679c\u628a\u9650\u5236\u52a0\u8fb9\uff0c\u7b54\u6848\u5c31\u662f $k+1$ \u7684\u8054\u901a\u5757\u4e2a\u6570\u6b21\u65b9\u3002\n\n### Subtask 5\n\n\u6839\u636e Sub 4\uff0c\u53ef\u4ee5\u60f3\u5230\u7edf\u8ba1\u6bcf\u4e2a\u8054\u901a\u5757\u7684\u65b9\u6848\u6570\u4e58\u8d77\u6765\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8054\u901a\u5757\uff0c\u66b4\u529b\u679a\u4e3e\u7b2c\u4e00\u4e2a\u6570\u7684\u503c\uff0c\u8fd9\u6837\u6240\u6709\u6570\u90fd\u662f\u786e\u5b9a\u7684\u3002\u7136\u540e\u5224\u65ad\u662f\u5426\u90fd\u4e0d\u5927\u4e8e $k$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(nk)$\u3002\n\n### Subtask 6\n\n\u6570\u636e\u968f\u673a\uff0c\u5f88\u5bb9\u6613\u51fa\u73b0\u65e0\u89e3\uff0c\u8f93\u51fa $0$ \u5373\u53ef\u3002~~\u8fd9\u4e2a Sub \u6765\u6e90\u662f\u6211\u539f\u6765\u6ca1\u610f\u8bc6\u5230\u8fd9\u70b9\u5bfc\u81f4\u6700\u540e\u4e00\u4e2a\u5b50\u4efb\u52a1\u7b54\u6848\u5168\u662f $0$\uff08\uff08\uff08~~\n\n### Subtask 7\n\n\u5ef6\u7eed Sub 4,5 \u7684\u60f3\u6cd5\uff0c\u6211\u4eec\u8981\u5feb\u901f\u8ba1\u7b97\u7b2c\u4e00\u4e2a\u6570\u6709\u591a\u5c11\u53d6\u503c\u3002\n\n\u56e0\u4e3a\u5f02\u6216\u7684\u7ed3\u5408\u5f8b\uff0c\u6240\u4ee5\u8054\u901a\u5757\u6bcf\u4e00\u4e2a\u6570\u90fd\u662f\u7b2c\u4e00\u4e2a\u6570\u5f02\u6216\u8def\u5f84\u4e0a\u6570\u7684\u5f02\u6216\u548c\uff0c\u5982\u679c\u8def\u5f84\u4e0a\u6570\u5f02\u6216\u548c\u4e0d\u552f\u4e00\u5219\u65e0\u89e3\u3002\u5c06\u8fd9\u4e9b\u6570\u63d2\u5165 01 trie\uff0c\u95ee\u9898\u5c31\u8f6c\u6362\u4e3a\u201c\u6709\u591a\u5c11\u4e2a\u6570\uff0c\u4f7f\u5b83\u4e0e trie \u6811\u4e2d\u6240\u6709\u503c\u7684\u5f02\u6216\u7ed3\u679c\u6700\u5927\u503c\u4e0d\u8d85\u8fc7 $x$ \u201d\u3002\n\n\u4e0b\u9762\uff0c\u6765\u5206\u6790\u600e\u4e48\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\n\n\u6211\u4eec\u5728 trie \u6811\u4e0a dfs \uff0c\u7528 $dfs(now,d,val)$ \u8868\u793a\u5904\u7406\u5230\u4e86\u8282\u70b9 $now$ \uff0c\u5f53\u524d\u4e3a\u7b2c $d$ \u4f4d\uff0c\u5f53\u524d\u503c\u4e3a $val$ \u3002\u5bf9\u4e8e trie \u6811\u4e0a\u7684\u6bcf\u4e2a\u8282\u70b9\uff0c\u6839\u636e\u513f\u5b50\u4e2a\u6570\u8ba8\u8bba\u3002\n\n- \u6ca1\u6709\u513f\u5b50\uff0c\u5219\u4ee3\u8868\u5904\u7406\u5230\u4e86\u53f6\u5b50\u3002\u6b64\u65f6\u82e5\u503c\u4e0d\u5927\u4e8e $x$ \uff0c\u5219\u8fd4\u56de $1$ \u3002\u5426\u5219\u8fd4\u56de $0$ \u3002\n- \u6709\u4e24\u4e2a\u513f\u5b50\uff0c\u5219\u65e0\u8bba\u5f53\u524d\u4f4d\u586b\u4ec0\u4e48\u6570\uff0c\u6700\u5927\u503c\u90fd\u4f1a\u51fa\u73b0\u5728\u201c\u5bf9\u9762\u201d\u5b50\u6811\u4e2d\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5c06\u5f53\u524d\u503c\u52a0\u4e0a $2^d$ \uff0c\u7136\u540e\u9012\u5f52\u5904\u7406 $0/1$ \u4e24\u68f5\u5b50\u6811\u3002\n- \u53ea\u6709\u4e00\u4e2a\u513f\u5b50\uff08\u5047\u8bbe\u4e3a $0$ \u513f\u5b50\uff09\uff0c\u6211\u4eec\u5224\u65ad $val+2^d$ \u4e0d\u5927\u4e8e $x$ \u662f\u5426\u6210\u7acb\u3002\n\n1. \u82e5\u6210\u7acb\uff0c\u5219\u5f53\u524d\u4f4d\u586b $0$ \u65f6\uff0c\u540e\u9762\u4f4d\u65e0\u8bba\u586b\u4ec0\u4e48\u90fd\u6ee1\u8db3\u6761\u4ef6\uff0c\u56e0\u6b64\u586b $0$ \u65f6\u7b54\u6848\u4e3a $2^d$ \uff0c\u586b $1$ \u65f6\uff0c\u5f53\u524d\u503c\u52a0\u4e0a $2^d$ \uff0c\u5904\u7406 $0$ \u513f\u5b50\u3002\n\n2. \u82e5\u4e0d\u6210\u7acb\uff0c\u5219\u5f53\u524d\u4f4d\u53ea\u80fd\u586b $0$ \u3002\u5f53\u524d\u503c\u4e0d\u53d8\uff0c\u5904\u7406 $0$ \u513f\u5b50\u3002\n\n\u8fd9\u6837\uff0c\u6bcf\u4e2a\u8282\u70b9\u53ea\u4f1a\u88ab\u5904\u7406\u4e00\u6b21\u3002\n\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\log k)$ \u3002",
        "postTime": 1596439986,
        "uid": 196899,
        "name": "lndjy",
        "ccfLevel": 9,
        "title": "\u5e8f\u5217 \u9898\u89e3"
    },
    {
        "content": "\u5982\u679c\u4f60\u8fd9\u9053\u9898\u4e00\u4e0a\u6765\u5c31\u80fd\u60f3\u5230\u628a\u5e8f\u5217\u8f6c\u6362\u6210\u4e00\u5f20\u56fe\uff0c\u4f60\u5c31\u5df2\u7ecf\u6210\u529f\u4e00\u534a\u4e86\u3002~~\uff08\u53ef\u60dc\u6211\u6bd4\u8d5b\u65f6\u6ca1\u60f3\u5230\uff09~~\n\n\u9996\u5148\uff0c\u6211\u4eec\u628a\u9898\u76ee\u7ed9\u7684\u6761\u4ef6\u8f6c\u5316\u4e3a\u4e00\u6761\u4e24\u4e2a\u5b9a\u70b9\u4e3a $x$ \u4e0e $y$\uff0c\u8fb9\u6743\u4e3a $z$ \u7684\u8fb9\uff0c\u6574\u4e2a\u5e8f\u5217\u5c31\u53d8\u6210\u4e86\u4e00\u5f20\u56fe\u3002\n\n\u95ee\u9898\u6765\u4e86\uff1a\u5982\u4f55\u8fc5\u901f\u5730\u6c42\u51fa\u6bcf\u4e2a\u70b9\u7684\u6743\u503c\uff1f\n\n\u7531\u4e8e\u6761\u4ef6\u4e0d\u53d8\uff0c\u4e24\u70b9\u4e4b\u95f4\u7684\u5f02\u6216\u548c\u4e0d\u53d8\u3002\u6211\u4eec\u53ef\u4ee5\u5728\u6bcf\u4e00\u4e2a\u8054\u901a\u5757\u4e2d\u4efb\u9009\u4e00\u4e2a\u8d77\u70b9\uff0c\u8ba1\u7b97\u51fa\u8d77\u70b9\u4e0e\u8054\u901a\u5757\u4e2d\u5176\u4ed6\u6bcf\u4e2a\u70b9\u7684\u8def\u5f84\u5f02\u6216\u548c\u3002\u5982\u679c\u4e00\u4e2a\u70b9\u6cbf\u7740\u4e24\u4e2a\u8def\u5f84\u7b97\u51fa\u4e86\u4e24\u4e2a\u6743\u503c\uff0c\u90a3\u4e48\u77db\u76fe\uff0c\u7279\u5224\u8f93\u51fa $0$\u3002\n\n\u7531\u4e8e\u8def\u5f84\u5f02\u6216\u548c\u4e0d\u53d8\uff0c\u4e00\u65e6\u786e\u5b9a\u4e86\u8d77\u70b9\uff0c\u6bcf\u4e00\u4e2a\u70b9\u7684\u6743\u503c\u90fd\u4f1a\u786e\u5b9a\u3002\u672c\u9898\u7684\u6838\u5fc3\u6765\u4e86\uff1a\u5982\u4f55\u8fc5\u901f\u6c42\u51fa\u8d77\u70b9\u7684\u503c\uff1f\n\n\u5982\u679c\u8d77\u70b9\u7684\u503c\u5f02\u6216\u4e0a\u6bcf\u4e00\u4e2a\u70b9\u5bf9\u5e94\u7684\u8def\u5f84\u6743\u503c\u4e0d\u5927\u4e8e $k$\uff0c\u90a3\u4e48\u8fd9\u4e2a\u503c\u5408\u6cd5\u3002\u5229\u7528\u8fd9\u4e2a\u601d\u60f3\uff0c\u6211\u4eec\u53ef\u4ee5\u4e00\u8fb9\u7edf\u8ba1\u8def\u5f84\u5f02\u6216\u548c\u4e00\u8fb9\u628a\u6240\u6709\u7684\u8def\u5f84\u5f02\u6216\u548c\u90fd\u6254\u5230\u4e00\u9897 $01$ Trie \u4e0a\uff0c\u5c31\u50cf\u8fd9\u6837\uff1a\n\n```cpp\nvoid update(int num,int p,int b)\n{\n\tif(b==-1)\n\t{\n\t\treturn;\n\t}\n\tif(tree[p].son[num/(1<<b)])\n\t{\n\t\tupdate(num%(1<<b),tree[p].son[num/(1<<b)],b-1);\n\t\treturn;\n\t}\n\ttree[p].son[num/(1<<b)]=++point;\n\tupdate(num%(1<<b),point,b-1);\n}\nint cnt=0;\nvoid dfs1(int now,int a,int fa)\n{\n\tvis[now]=a;\n\tw[now]=1;\n\tupdate(a,0,30);\n\tfor(int i=h[now];i;i=l[i].nxt)\n\t{\n\t\tif(l[i].to==fa)\n\t\t{\n\t\t\tcontinue;\n\t\t}\t\t\n\t\tif(w[l[i].to])\n\t\t{\n\t\t\tif(vis[l[i].to]!=(a^l[i].val))\n\t\t\t{\n\t\t\t\tcnt=1;\n\t\t\t\treturn;//\u7279\u5224\u65e0\u89e3\u9000\u51fa\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tdfs1(l[i].to,a^l[i].val,now);\t\n\t}\n}\n```\n\n\u73b0\u5728\u6838\u5fc3\u6765\u4e86\uff1a\u5982\u4f55\u8fc5\u901f\u6c42\u51fa\u8d77\u70b9\u7684\u6743\u503c\uff1f\n\n\u5148\u653e\u4ee3\u7801\u518d\u89e3\u91ca\uff1a\n\n```cpp\nint dfs2(int now,int b,int s)\n{\n\tif(tree[now].son[0]==0&&tree[now].son[1]==0)\n\t{\n\t\tif(s<=k)\n\t\t{\n\t\t\treturn 1;\t\n\t\t}\n\t\treturn 0;\n\t}\n\tint ans=0;\n\tif(tree[now].son[0]&&tree[now].son[1])\n\t{\n\t\tans+=dfs2(tree[now].son[0],b-1,s+(1<<b));\n\t\tans+=dfs2(tree[now].son[1],b-1,s+(1<<b));\n\t\tans%=1000000007;\n\t\treturn ans;\n\t}\n\tint p;\n\tif(tree[now].son[0])\n\t{\n\t\tp=0;\n\t}else\n\t{\n\t\tp=1;\n\t}\n\tif(s+(1<<b)<=k)\n\t{\n\t\tans+=(1<<b)%1000000007;\n\t\tans+=dfs2(tree[now].son[p],b-1,s+(1<<b));\n\t\tans%=1000000007;\n\t}else\n\t{\n\t\tans+=dfs2(tree[now].son[p],b-1,s);\t\n\t}\n\treturn ans;\n}\n```\n$now$ \u6307\u5f53\u524d\u7684\u8282\u70b9\uff0c$b$\u6307\u5f53\u524d\u7684\u4f4d\u6570\uff0c$s$ \u6307\u73b0\u5728\u79ef\u7d2f\u7684\u6743\u503c\u3002\n\n\u4ece\u6839\u8282\u70b9\u5f00\u59cb\u904d\u5386\uff0c\u6bcf\u4e00\u4e2a\u70b9\u90fd\u6709\u4e09\u79cd\u60c5\u51b5\uff1a\u6ca1\u6709\u5b50\u8282\u70b9\uff0c\u6709\u4e00\u4e2a\u5b50\u8282\u70b9\uff0c\u6709\u4e24\u4e2a\u5b50\u8282\u70b9\u3002\n\n\u5f53\u5f53\u524d\u8282\u70b9\u6ca1\u6709\u5b50\u8282\u70b9\u65f6\uff0c\u904d\u5386\u7ed3\u675f\uff0c\u8fdb\u884c\u5224\u65ad\uff0c\u5982\u679c $s$ \u4e0d\u6bd4 $k$ \u5927\uff0c\u904d\u5386\u6210\u529f\uff0c\u8fd4\u56de $1$\uff0c\u5426\u5219\u8fd4\u56de $0$\u3002\n\n\u5f53\u5f53\u524d\u8282\u70b9\u6709\u4e00\u4e2a\u5b50\u8282\u70b9\u65f6\uff0c\u5224\u65ad $s$ \u52a0 $2$ \u7684 $b$ \u6b21\u65b9\u662f\u5426\u4e0d\u5927\u4e8e $k$\uff0c\u5982\u679c\u4e0d\u5927\u4e8e $k$ \u8fd9\u4e00\u4f4d\u5c31\u65e2\u53ef\u4ee5\u4e0e\u5f53\u524d\u4f4d\u7684\u6570\u76f8\u540c\uff0c\u53c8\u53ef\u4ee5\u4e0e\u5f53\u524d\u4f4d\u7684\u6570\u4e0d\u540c\uff0c\u5f53\u4e0e\u5f53\u524d\u4f4d\u7684\u6570\u76f8\u540c\u65f6\uff0c\u5f02\u6216\u503c\u4e3a $0$\uff0c\u540e\u9762\u6570\u7684\u5f02\u6216\u503c\u6700\u5927\u4e3a $2$ \u7684 $b$ \u6b21\u65b9\u51cf $1$\uff0c\u660e\u663e\u4e0d\u8d85\u8fc7 $k$\uff0c\u4e00\u5171\u6709 $2$ \u7684 $b$ \u6b21\u65b9\u4e2a\u6570\uff0c $ans$ \u52a0 $2$ \u7684 $b$ \u6b21\u65b9\uff0c\u5f53\u5f53\u524d\u4f4d\u4e0e\u5f53\u524d\u503c\u4e0d\u540c\u65f6\uff0c$s$ \u52a0\u4e0a $2$ \u7684 $b$ \u6b21\u65b9\uff0c\u7ee7\u7eed\u5411\u4e0b\u7edf\u8ba1\u3002\u5982\u679c\u5927\u4e8e $k$\uff0c\u8bf4\u660e\u53ea\u80fd\u4e0e\u5f53\u524d\u4f4d\u76f8\u540c\uff0c\u5411\u4e0b\u904d\u5386\u3002\n\n\u5f53\u5f53\u524d\u8282\u70b9\u6709\u4e24\u4e2a\u5b50\u8282\u70b9\u65f6\uff0c\u65e0\u8bba\u4e0e\u54ea\u4e2a\u5b50\u8282\u70b9\u7684\u503c\u76f8\u540c\uff0c\u5f02\u6216\u4e0a\u53e6\u4e00\u4e2a\u5b50\u8282\u70b9\u7684\u503c\u90fd\u4f1a\u4e3a\u4e00\uff0c\u76f4\u63a5\u628a\u7d2f\u8ba1\u503c\u52a0\u4e0a $2$ \u7684 $b$ \u6b21\u65b9\u540e\u5411\u4e0b\u904d\u5386\u5373\u53ef\u3002\n\n\u6700\u540e\u653e\u5168\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\nstruct node1\n{\n\tint son[3];\n}tree[15000005];\nstruct node2\n{\n\tint to;\n\tint val;\n\tint nxt;\n}l[1000005];\nint tot=0,h[500005],vis[500005],w[500005];\nvoid add(int x,int y,int z)\n{\n\tl[++tot].to=y;\n\tl[tot].val=z;\n\tl[tot].nxt=h[x];\n\th[x]=tot;\n}\nint point=0;\nvoid update(int num,int p,int b)\n{\n\tif(b==-1)\n\t{\n\t\treturn;\n\t}\n\tif(tree[p].son[num/(1<<b)])\n\t{\n\t\tupdate(num%(1<<b),tree[p].son[num/(1<<b)],b-1);\n\t\treturn;\n\t}\n\ttree[p].son[num/(1<<b)]=++point;\n\tupdate(num%(1<<b),point,b-1);\n}\nint cnt=0;\nvoid dfs1(int now,int a,int fa)\n{\n\tvis[now]=a;\n\tw[now]=1;\n\tupdate(a,0,30);\n\tfor(int i=h[now];i;i=l[i].nxt)\n\t{\n\t\tif(l[i].to==fa)\n\t\t{\n\t\t\tcontinue;\n\t\t}\t\t\n\t\tif(w[l[i].to])\n\t\t{\n\t\t\tif(vis[l[i].to]!=(a^l[i].val))\n\t\t\t{\n\t\t\t\tcnt=1;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tdfs1(l[i].to,a^l[i].val,now);\t\n\t}\n}\nint k;\nint dfs2(int now,int b,int s)\n{\n\tif(tree[now].son[0]==0&&tree[now].son[1]==0)\n\t{\n\t\tif(s<=k)\n\t\t{\n\t\t\treturn 1;\t\n\t\t}\n\t\treturn 0;\n\t}\n\tint ans=0;\n\tif(tree[now].son[0]&&tree[now].son[1])\n\t{\n\t\tans+=dfs2(tree[now].son[0],b-1,s+(1<<b));\n\t\tans+=dfs2(tree[now].son[1],b-1,s+(1<<b));\n\t\tans%=1000000007;\n\t\treturn ans;\n\t}\n\tint p;\n\tif(tree[now].son[0])\n\t{\n\t\tp=0;\n\t}else\n\t{\n\t\tp=1;\n\t}\n\tif(s+(1<<b)<=k)\n\t{\n\t\tans+=(1<<b)%1000000007;\n\t\tans+=dfs2(tree[now].son[p],b-1,s+(1<<b));\n\t\tans%=1000000007;\n\t}else\n\t{\n\t\tans+=dfs2(tree[now].son[p],b-1,s);\t\n\t}\n\treturn ans;\n}\nint main()\n{\n\tint n,m;\n\tscanf(\"%d%d%d\",&n,&m,&k);\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint x,y,z;\n\t\tscanf(\"%d%d%d\",&x,&y,&z);\n\t\tadd(x,y,z);\n\t\tadd(y,x,z);\n\t}\n\tlong long fans=1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(w[i]==0)\n\t\t{\n\t\t\tfor(int j=0;j<=point;j++)\n\t\t\t{\n\t\t\t\ttree[j].son[0]=tree[j].son[1]=0;\n\t\t\t}\n\t\t\tpoint=0;\n\t\t\tdfs1(i,0,0);\n\t\t\tif(cnt)\n\t\t\t{\n\t\t\t\tprintf(\"0\");//\u7279\u5224\u65e0\u89e3\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tfans=fans*dfs2(0,30,0)%1000000007;//\u8fdb\u884c\u6392\u5217\u7ec4\u5408\n\t\t}\n\t}\n\tprintf(\"%lld\",fans);\n\treturn 0;\n}\n```",
        "postTime": 1626686063,
        "uid": 279737,
        "name": "lnwzy",
        "ccfLevel": 4,
        "title": "P7717\u9898\u89e3"
    },
    {
        "content": "\u597d\u9898\u3002\n\n\u6211\u4eec\u6ce8\u610f\u5230\u6bcf\u4e2a\u9650\u5236\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u4f9d\u8d56\uff1a\u56e0\u4e3a\u4e00\u4e2a\u6570\u786e\u5b9a\u4e86\uff0c\u53e6\u4e00\u4e2a\u6570\u4e5f\u8ddf\u7740\u786e\u5b9a\u4e86\u3002\u8fd9\u6837\u82e5\u5e72\u4e2a\u9650\u5236\u5c31\u6784\u6210\u4e86\u4e00\u4e2a\u65e0\u5411\u56fe\uff0c\u6bcf\u4e2a\u8054\u901a\u5757\u662f\u4e92\u76f8\u4f9d\u8d56\u7684\u3002\n\n\u5bb9\u6613\u60f3\u5230\u7b54\u6848\u5c31\u662f\u6bcf\u4e2a\u8054\u901a\u5757\u53ef\u884c\u7684\u53d6\u503c\u76f8\u4e58\u3002\u96be\u70b9\u5728\u4e8e\u6bcf\u4e2a\u6570\u4e0d\u80fd\u5927\u4e8e $k$ \u7684\u9650\u5236\u3002\n\n\u6211\u4eec\u8003\u8651\u4e00\u4e2a\u8fde\u901a\u5757\uff0c\u56e0\u4e3a\u5f02\u6216\u6709\u7ed3\u5408\u5f8b\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u8054\u901a\u5757\u5185\u7684\u9650\u5236\u90fd\u96c6\u4e2d\u7684\u5230\u4e00\u4e2a\u70b9\u4e0a\uff0c\u5373\u6bcf\u4e2a\u6570\u90fd\u662f\u7531\u8054\u901a\u5757\u5185\u67d0\u4e2a\u56fa\u5b9a\u7684\u6570\u5f02\u6216\u4e00\u4e2a\u503c\u5f97\u5230\uff0c\u65b9\u4fbf\u5904\u7406\u3002\n\n\u5728\u5757\u5185\u4efb\u9009\u4e00\u4e2a\u6839 dfs\uff0c\u9996\u5148\u53ef\u4ee5\u628a\u73af\u5224\u6389\uff0c\u5982\u679c\u73af\u7684\u4e24\u8fb9\u8d70\u5230\u5f53\u524d\u7684\u4f4d\u7f6e\u5f02\u6216\u548c\u4e0d\u540c\u5c31\u65e0\u89e3\u4e86\u3002\u8fd9\u6837\u4ee5\u540e\u5757\u53d8\u6210\u4e86\u4e00\u68f5\u6811\uff0c\u6709\u82e5\u5e72\u4e2a\u548c\u6811\u6839\u6709\u5173\u7684\u9650\u5236\uff0c\u73b0\u5728\u6211\u4eec\u8981\u8ba1\u7b97\u6811\u6839\u6709\u591a\u5c11\u79cd\u53d6\u503c\u53ef\u4ee5\u8ba9\u6574\u68f5\u6811\u7684\u6700\u5927\u503c\u5c0f\u4e8e\u7b49\u4e8e $k$\u3002\n\n\u8fd9\u4e2a\u95ee\u9898\u7b49\u4ef7\u4e8e\u6c42\u5f02\u6216\u6700\u5927\u503c\u5c0f\u4e8e\u7b49\u4e8e $k$ \u7684\u4e2a\u6570\uff0c\u5957\u8def\u5730\uff0c\u8fd9\u79cd\u95ee\u9898\u5f80\u5f80\u4f7f\u7528 01-trie \u5904\u7406\u3002\n\n\u6211\u4eec\u5728 trie \u4e0a dfs\uff0c\u501f\u7528\u6570\u4f4d dp \u7684\u601d\u60f3\uff0c\u8bb0\u5f55\u8d70\u5230\u5f53\u524d\u4f4d**\u5f02\u6216\u6700\u5927\u503c\u9876\u4e0a\u754c**\u7684\u65b9\u6848\uff0c\u7136\u540e\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n- \u5982\u679c $k$ \u5f53\u524d\u4f4d\u662f $1$\uff0c\u90a3\u4e48\u6811\u6839\u600e\u4e48\u9009\u90fd\u4e0d\u4f1a\u8d8a\u754c\uff0c\u4e24\u8fb9\u5206\u522b dfs\uff0c\u540c\u65f6\u4fee\u6539\u6700\u5927\u662f\u9876\u4e0a\u754c\u7684\u6570\u91cf\uff0c\u5177\u4f53\u5730\u8bf4 $0$ \u513f\u5b50\u9876\u4e0a\u754c\u7684\u662f\u5f53\u6811\u6839\u524d\u4f4d\u53d6 $1$ \u7684\u65b9\u6848\uff0c\u53e6\u4e00\u8fb9\u540c\u7406\u3002\n\n- \u5982\u679c $k$ \u5f53\u524d\u4f4d\u662f $0$\u2026\u2026\u6211\u4eec\u53d1\u73b0\u6211\u4eec\u4e0d\u77e5\u9053\u6811\u6839\u5f53\u524d\u4f4d\u53ef\u4e0d\u53ef\u4ee5\u53d6 $1$\uff0c\u4e8e\u662f\u9700\u8981\u591a\u52a0\u4e00\u4e2a\u53d8\u91cf\u8868\u793a\u6811\u6839\u7684\u53d6\u503c\u662f\u5426\u9876\u4e0a\u754c\uff0c\u7ee7\u7eed\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n  - \u5982\u679c\u9876\u4e0a\u754c\uff0c\u56e0\u4e3a\u6811\u6839\u53d6\u503c\u4e5f\u4e0d\u80fd\u8d85\u8fc7 $k$\uff0c\u90a3\u53ea\u80fd\u586b $0$\uff0c\u540c\u65f6\u8981\u6c42\u6240\u6709\u5f02\u6216\u51fa\u6765\u7684\u503c\u5f53\u524d\u4f4d\u4e5f\u662f $0$\u3002\u56e0\u6b64\u5982\u679c\u5f53\u524d\u70b9\u6709 $1$ \u513f\u5b50\uff0c\u90a3\u5c31\u6302\u4e86\uff0c\u4e0d\u8ba1\u7b97\u8d21\u732e\u3002\u5426\u5219\u641c\u7d22 $0$ \u513f\u5b50\uff0c\u9876\u4e0a\u754c\u65b9\u6848\u6570\u76f4\u63a5\u7ee7\u627f\u3002\n  \n  - \u5982\u679c\u4e0d\u9876\u4e0a\u754c\uff0c\u90a3\u4e48\u6811\u6839\u5f53\u524d\u4f4d $0,1$ \u90fd\u53ef\u4ee5\u9009\u3002\u4f46\u5982\u679c\u5f53\u524d\u70b9\u540c\u65f6\u6709 $0,1$ \u4e24\u4e2a\u513f\u5b50\uff0c\u90a3\u4e0d\u7ba1\u6811\u6839\u600e\u4e48\u9009\uff0c\u5f53\u524d\u4f4d\u5f02\u6216\u503c\u4e00\u5b9a\u51fa\u73b0 $1$\uff0c\u4e5f\u5c31\u6302\u4e86\uff0c\u4e0d\u8ba1\u7b97\u8d21\u732e\u3002\u5426\u5219\u641c\u7d22\u552f\u4e00\u7684\u513f\u5b50\uff0c\u6b64\u65f6\u9876\u4e0a\u754c\u7684\u65b9\u6848\u6570\u6539\u4e3a\u56fa\u5b9a\u5f53\u524d\u4f4d\u9009 $0/1$ \u6570\u91cf\u3002\n  \n- \u6700\u540e\uff0c\u641c\u7d22\u7684\u8fb9\u754c\u662f\u641c\u7d22\u5230\u4e86\u53f6\u5b50\u4ecd\u7136\u5408\u6cd5\uff0c\u8bf4\u660e\u5f53\u524d\u641c\u7d22\u5230\u7684\u9876\u4e0a\u754c\u7684\u65b9\u6848\u5168\u90e8\u662f\u5408\u6cd5\u7684\uff0c\u4e8e\u662f\u7d2f\u52a0\u7b54\u6848\u3002\n\n\u6700\u540e\u6ce8\u610f\u4e00\u4e9b\u7ec6\u8282\u5c31\u597d\u4e86\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#define int long long\nstruct edge\n{\n    int nxt,to,weight;\n}e[500001<<1];\nconst int mod=1000000007;\nint n,m,maxn,tot,h[500001],ans,ch[500001*31][2],cnt,tmp[500001];\nbool vis[500001];\ninline int read()\n{\n    int x=0;\n    char c=getchar();\n    while(c<'0'||c>'9')\n        c=getchar();\n    while(c>='0'&&c<='9')\n    {\n        x=(x<<1)+(x<<3)+(c^48);\n        c=getchar();\n    }\n    return x;\n}\ninline void add(int x,int y,int w)\n{\n    e[++tot].nxt=h[x];\n    h[x]=tot;\n    e[tot].to=y;\n    e[tot].weight=w;\n}\ninline void insert(int x)\n{\n    int node=1;\n    for(register int i=30;~i;--i)\n    {\n        if(!ch[node][(x>>i)&1])\n            ch[node][(x>>i)&1]=++cnt;\n        node=ch[node][(x>>i)&1];\n    }\n}\nint query(int node,int val,int x,int g,bool tag)\n{\n    if(!ch[node][0]&&!ch[node][1])\n        return val;\n    if((maxn>>g)&1)\n        return query(ch[node][0],val-(1ll<<g),x,g-1,tag)+query(ch[node][1],1ll<<g,x,g-1,0);\n    if(tag)\n    {\n        if(ch[node][1])\n            return 0;\n        return query(ch[node][0],val,x,g-1,tag);\n    }\n    if(ch[node][0]&&ch[node][1])\n        return 0;\n    if(ch[node][0])\n        return query(ch[node][0],val>>1,x,g-1,0);\n    return query(ch[node][1],val>>1,x,g-1,tag);\n}\nvoid dfs(int k,int val)\n{\n    vis[k]=1;\n    tmp[k]=val;\n    for(register int i=h[k];i;i=e[i].nxt)\n    {\n        if(vis[e[i].to])\n        {\n            if(val^e[i].weight^tmp[e[i].to])\n            {\n                puts(\"0\");\n                exit(0);\n            }\n            continue;\n        }\n        insert(val^e[i].weight);\n        dfs(e[i].to,val^e[i].weight);\n    }\n}\nsigned main()\n{\n    n=read(),m=read(),maxn=read();\n    ans=1;\n    for(register int i=1;i<=m;++i)\n    {\n        int x=read(),y=read(),w=read();\n        add(x,y,w);\n        add(y,x,w);\n    }\n    cnt=1;\n    for(register int i=1;i<=n;++i)\n        if(!vis[i])\n        {\n            dfs(i,0);\n            ans=ans*query(1,maxn+1,maxn,30,1)%mod;\n            for(register int j=1;j<=cnt;++j)\n                ch[j][0]=ch[j][1]=0;\n            cnt=1;\n        }\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```\n",
        "postTime": 1626062777,
        "uid": 85682,
        "name": "\u7edd\u9876\u6211\u4e3a\u5cf0",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P7717 \u3010\u300cEZEC-10\u300d\u5e8f\u5217\u3011"
    },
    {
        "content": "\u9a8c\u9898\u4eba\u6c34\u9898\u89e3\n\n\u9996\u5148\u8003\u8651\u6ca1\u6709\u4efb\u4f55\u9650\u5236\u6761\u4ef6\u3002\u53ef\u4ee5\u53d1\u73b0\u7b54\u6848\u5c31\u662f $(k+1)^n$\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5c06\u6bcf\u7ec4\u9650\u5236\u5f53\u505a\u4e00\u6761\u8fb9\u6743\u4e3a $c$ \u7684\u53cc\u5411\u8fb9\u3002\u7531\u4e8e\u8fb9\u7684\u7279\u6b8a\u9650\u5236\uff0c\u5f53\u4e00\u4e2a\u8fde\u901a\u5757\u4e2d\u7684\u67d0\u4e00\u4e2a\u6570\u5b57\u88ab\u786e\u8ba4\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u786e\u8ba4\u6574\u5408\u8fde\u901a\u5757\u91cc\u7684\u6570\u5b57\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u8fde\u901a\u5757\uff0c\u6211\u4eec\u53ef\u4ee5\u968f\u673a\u9009\u53d6\u4e00\u4e2a\u8282\u70b9\u5f53\u505a\u6839\uff0c\u5e76\u4e14\u6c42\u51fa\u5230\u6240\u6709\u5176\u4ed6\u8282\u70b9\u7684\u5f02\u6216\u548c\u3002\u5982\u679c\u67d0\u4e00\u4e2a\u8fde\u901a\u5757\u7684\u5f02\u6216\u548c\u4e0e\u9898\u76ee\u4e0d\u7b26\uff0c\u90a3\u4e48\u5c06\u4e0d\u53ef\u80fd\u5b58\u5728\u7b54\u6848\u3002\n\n\u6ce8\u610f\u5230\u8fde\u901a\u5757\u4e4b\u95f4\u4e0d\u4f1a\u9020\u6210\u5f71\u54cd\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u5c06\u6bcf\u4e2a\u8fde\u901a\u5757\u53ef\u4ee5\u53d6\u503c\u7684\u6570\u91cf\u7b97\u51fa\u5e76\u4e58\u8d77\u6765\u5373\u53ef\u5f97\u5230\u7b54\u6848\u3002\n\n\u8003\u8651\u5c06\u4e00\u4e2a\u8fde\u901a\u5757\u91cc\u4ece\u6839\u8282\u70b9\u51fa\u53d1\u7684\u6240\u6709\u5f02\u6216\u548c\u4e22\u8fdb trie \u5185\uff0c\u7136\u540e\u4f60\u5c31\u4f1a\u53d1\u73b0\u8ddf[\u8fd9\u9898](https://www.luogu.com.cn/problem/solution/P6824)\u7684 trie \u505a\u6cd5\u975e\u5e38\u76f8\u4f3c\u3002\n\n\u4ece\u6700\u9ad8\u4f4d\u5f00\u59cb\u586b\u6570\uff0c\u6211\u4eec\u53ea\u9700\u8981\u4fdd\u8bc1\u4efb\u4f55\u65f6\u5019\u7b54\u6848\u4e0d\u5927\u4e8e $k$ \u5373\u53ef\uff0c\u5177\u4f53\u586b\u6cd5\u53c2\u8003\u5b98\u65b9\u89e3\u6cd5\u3002\n\n\u6ce8\u610f\u9898\u76ee\u5176\u5b9e\u6709\u4e00\u4e2a\u5751\u70b9\uff0c\u5c31\u662f\u8fd9\u4e2a\u9898\u76ee\u7684 trie \u8282\u70b9\u6570\u5b9e\u9645\u4e0a\u662f $n\\log z$ \u7ea7\u522b\uff0c\u4e25\u683c\u610f\u4e49\u4e0a\u6765\u8bf4 trie \u7684\u7a7a\u95f4\u9700\u8981\u5f00\u5200 $10^7+5\n\\times 10^6$\uff0c\u4f46\u9898\u76ee\u7684\u6570\u636e\u5e76\u6ca1\u6709\u5361\u6ee1\uff0c\u800c\u6211\u4eec\u53c8\u5f00\u5927\u4e86\u7a7a\u95f4\u9650\u5236\uff0c\u6240\u4ee5\u6700\u540e\u51b3\u5b9a\u4e0d\u6539\u6570\u636e\u8303\u56f4\uff08\n\n```cpp\nconst int MAXN = 5e6+5;\nconst int MAXM = 5e6+5;\nconst int MAXL = 25;\nconst int MAXA = 23;\nconst ll mod = 1e9+7;\nint dx[4] = {1,0,-1,0}, dy[4] = {0,1,0,-1};\nll n,m,t,l,k,a,b,c,pos[MAXN],dist[MAXN];\nll ans=1LL;\nnamespace AdjEdge{\n  //var\n  int head[MAXN],tot;\n  struct Edge{\n    int u,v,d,nxt;\n  }edge[MAXM<<1];\n  inline void add(int u, int v, int d=0){\n    edge[++tot].u = u;\n    edge[tot].v = v;\n    edge[tot].d = d;\n    edge[tot].nxt = head[u];\n    head[u] = tot;\n  }\n}\nusing namespace AdjEdge;\nnamespace Trie{\n  int cnt,sz;\n  int ch[MAXN][3];\n  inline void trie(){\n\t\tFor(i,1,sz) ch[i][0] = ch[i][1] = 0;\n\t\tsz = 2;\n  }\n  inline void insert(int s){\n    int u = 1;\n    for (int i=30;i>=0;i--){\n      int c = (s>>i) & 1;\n      if (!ch[u][c]) ch[u][c] = sz++;\n      u = ch[u][c];\n    }\n  }\n\n}\nusing namespace Trie;\nbool vis[MAXN];\ninline void dfs(int u){\n\tinsert(dist[u]);\n\tvis[u] = true;\n\ttrav(i,u){\n\t\tint v = edge[i].v, d = edge[i].d;\n\t\tif (dist[v]!=-1 && (dist[u]^d)!=dist[v]) {\n\t\t\tcout << 0;\n\t\t\texit(0);\n\t\t}//\u5224\u65e0\u89e3\n\t\tdist[v] = dist[u]^d;\n\t\tif (!vis[v])dfs(v);\n\t}\n}\ninline ll dfs2(ll now, ll d, ll value){\n\tif (!ch[now][0] && !ch[now][1]) return value<=k;\n\tif (ch[now][0] && ch[now][1]) return dfs2(ch[now][0],d-1,value+qpow(2,d))+dfs2(ch[now][1],d-1,value+qpow(2,d));\n\tif (ch[now][0]){\n\t\tif (value+qpow(2,d)<=k) return qpow(2,d)+dfs2(ch[now][0],d-1,value+qpow(2,d));\n\t\telse return dfs2(ch[now][0],d-1,value);\n\t}else{\n\t\tif (value+qpow(2,d)<=k) return qpow(2,d) + dfs2(ch[now][1],d-1,value+qpow(2,d));\n\t\telse return dfs2(ch[now][1],d-1,value);\n\t}\n}//\u586b\u6570\u65b9\u6cd5\nsigned main(){\n  n = read(); m = read(); k = read();\n  For(i,1,m){\n    a = read(); b = read(); c = read();\n    add(a,b,c);\n    add(b,a,c);\n  }\n\tmem(dist,0xff);\n\tFor(i,1,n) if (!vis[i]) {\n\t\tif (!head[i]) {ans = (ans*1LL*(k+1LL))%mod; continue;}\n\t\ttrie(),dist[i] = 0,dfs(i);\n\t\tans = (1LL*ans*dfs2(1,30,0))%mod;\n\t}\n\tcout << ans;\n}\n```",
        "postTime": 1626070556,
        "uid": 219099,
        "name": "pocafup",
        "ccfLevel": 0,
        "title": "\u300cEZEC-10\u300d\u5e8f\u5217 \u9898\u89e3"
    },
    {
        "content": "**\u9898\u76ee\u5927\u610f:**\n\n\u6c42\u6709\u591a\u5c11\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217 $a$ \u6ee1\u8db3\uff0c\u90fd\u5728 $[0,k]$ \u7684\u8303\u56f4\u5185\u4e14\u6ee1\u8db3 $m$ \u4e2a\u9650\u5236\u5f62\u5982\uff1a\n$$\na_x \\bigoplus a_y  = z \n$$\n**\u6570\u636e\u8303\u56f4:**\n$$\n0 \\le n, m \\le 5\\times10^5, 0 \\le k < 230\n$$\n\n**\u89e3\u9898\u601d\u8def:**\n\n\u9996\u5148\u5047\u8bbe\u6709\u5408\u6cd5\u65b9\u6848\uff0c\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e2a\u4f4d\u7f6e $a_x$ \u786e\u5b9a\u4e4b\u540e\u4e0e\u5b83\u76f4\u63a5\u6216\u95f4\u63a5\u9650\u5236\u7684 $a_y$ \u90fd\u5c06\u88ab\u786e\u5b9a\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u8bbe\u9650\u5236\u4e3a\u4e00\u6761\u8fb9\uff0c\u7136\u540e\u5148 dfs \u5224\u65ad\u4e00\u6b21\u662f\u5426\u9650\u5236\u4e4b\u95f4\u6ca1\u6709\u51b2\u7a81\u3002\n\n\u7136\u540e\u8003\u8651\u5bf9\u4e8e\u6bcf\u4e2a\u8054\u901a\u5757\u6211\u4eec\u968f\u610f\u627e\u5230\u4e00\u4e2a\u4f4d\u7f6e $x$\uff0c\u90a3\u4e48\u5176\u4ed6\u7684\u70b9\u90fd\u5c06\u88ab\u8868\u8fbe\u4e3a:\n$$\na_x \\bigoplus w\n$$\n\u7684\u5f62\u5f0f\u3002\n\n\u7136\u540e\u6211\u4eec\u8981\u6c42\u627e\u5230\u6709\u591a\u5c11\u4e2a $a_x$ \u6ee1\u8db3\u5bf9\u4e8e\u6240\u6709\u7684 $w$ \u90fd\u6709:\n$$\na_x \\bigoplus w \\le k\n$$\n\u8fd9\u4e2a\u53ef\u4ee5\u7528 Trie \u6765\u505a\uff0c\u6bcf\u6b21\u5c01\u95ed\u7684\u662f\u4e00\u4e2a\u5b50\u6811\uff0c\u76f4\u63a5\u5904\u7406\u5c31\u597d\u4e86\u3002\n\n**\u65f6\u95f4\u590d\u6742\u5ea6:**\n\n$O(n \\log k)$\n\n**Code:**\n\n```cpp\n#include<bits/stdc++.h>\n#define _ ios::sync_with_stdio(false),cin.tie(0),cout.tie(0)\n#define rep(i,l,r) for(long long i=l;i<=r;i++)\n#define lep(i,l,r) for(long long i=l;i>=r;i--)\n#define ll long long\n#define ull unsigned long long\nusing namespace std;\nconst ll N=5e5+10,P=1e9+7;\nstruct node{\n\tll to,next,w;\n}a[N<<1];\nll n,m,k,tot,ls[N],z[N];\nll cnt,t[N][2],res,ans=1;\nbool v[N];stack<ll > s;\nvoid addl(ll x,ll y,ll w){\n\ta[++tot].to=y;\n\ta[tot].next=ls[x];\n\tls[x]=tot;a[tot].w=w;\n\treturn;\n}\nbool dfs(ll x){\n\tv[x]=1;s.push(z[x]);\n\tfor(ll i=ls[x];i;i=a[i].next){\n\t\tll y=a[i].to;\n\t\tif(v[y]){\n\t\t\tif((z[x]^a[i].w)!=z[y])\n\t\t\t\treturn 1;\n\t\t}\n\t\telse{\n\t\t\tz[y]=z[x]^a[i].w;\n\t\t\tif(dfs(y))return 1;\t\n\t\t}\n\t}\n\treturn 0;\n}\nvoid Limit(ll &x,ll w,ll p){\n\tif(x==-1||p<0)return;\n\tif(!x){x=++cnt;t[x][0]=t[x][1]=0;}\n\tif((k>>p)&1)Limit(t[x][(w>>p)&1^1],w,p-1);\n\telse{\n\t\tt[x][(w>>p)&1^1]=-1;\n\t\tLimit(t[x][(w>>p)&1],w,p-1);\n\t}\n\treturn;\n}\nvoid Count(ll x,ll L,ll R){\n\tif(L>k)return;\n\tif(x==-1)res-=min(R,k)-L+1;\n\tif(x<=0)return;\n\tll mid=(L+R)>>1;\n\tCount(t[x][0],L,mid);\n\tCount(t[x][1],mid+1,R);\n\treturn;\n}\nsigned main()\n{\n\tscanf(\"%lld%lld%lld\",&n,&m,&k);\n\trep(i,1,m){\n\t\tll x,y,w;\n\t\tscanf(\"%lld%lld%lld\",&x,&y,&w);\n\t\taddl(x,y,w);addl(y,x,w);\n\t}\n\tres=0;\n\trep(i,1,n){\n\t\tif(v[i])continue;cnt=t[0][0]=0;\n\t\tif(dfs(i))return puts(\"0\")&0;\n\t\twhile(!s.empty())Limit(t[0][0],s.top(),29),s.pop();\n\t\tres=k+1;Count(1,0,(1<<30)-1);\n\t\tans=ans*res%P;\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n**\u6ce8\u660e:**\n\u601d\u8def\u6765\u81ea QuantAsk \u3002",
        "postTime": 1626693070,
        "uid": 484784,
        "name": "_YyD_",
        "ccfLevel": 6,
        "title": "P7717 \u300cEZEC-10\u300d\u5e8f\u5217"
    },
    {
        "content": "\u5f88\u597d\u7684\u9898\u3002\n\n\u9996\u5148\u6761\u4ef6\u53ef\u4ee5\u8f6c\u5316\u4e3a $a_{y_i}=a_{x_i}\\oplus z_i$\uff0c\u56e0\u6b64 $a_{x_i}$ \u4e00\u65e6\u786e\u5b9a\u4e86\uff0c\u90a3\u4e48 $a_{y_i}$ \u540c\u6837\u4e5f\u5c31\u786e\u5b9a\u4e86\u3002\n\n\u6211\u4eec\u8003\u8651\u8fde\u8fb9\uff1a\u5bf9\u4e8e\u6bcf\u6761\u9650\u5236 $(x_i,y_i,z_i)$\uff0c\u6211\u4eec\u5728 $x_i,y_i$ \u95f4\u8fde\u53cc\u5411\u8fb9\uff0c\u8fb9\u6743\u4e3a $z_i$\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e2a\u8fde\u901a\u5757\uff0c\u53ea\u8981\u4e00\u4e2a\u6570\u786e\u5b9a\u4e86\uff0c\u6240\u6709\u6570\u5c31\u90fd\u786e\u5b9a\u4e86\u3002\u53ea\u9700\u8981\u8ba1\u7b97\u6bcf\u4e2a\u8fde\u901a\u5757\u7684\u7b54\u6848\u7136\u540e\u4e58\u8d77\u6765\u5c31\u884c\u4e86\u3002\n\n\u6211\u4e00\u5f00\u59cb\u4ee5\u4e3a\u7b54\u6848\u5c31\u662f $k+1$\uff0c\u4f46\u662f\u601d\u8003\u4e4b\u540e\u53d1\u73b0\uff0c\u5c3d\u7ba1 $a_{x_i}\\le k,z_i\\le k$\uff0c$a_{x_i}\\oplus z_i$ \u7684\u503c\u4ecd\u7136\u53ef\u80fd $> k$\u3002\n\n\u56e0\u6b64\u95ee\u9898\u5c31\u53d8\u4e3a\uff1a\u5bf9\u4e8e\u6bcf\u4e2a\u8fde\u901a\u5757\uff0c\u968f\u4fbf\u9009\u4e00\u4e2a\u70b9 $x$\uff0c\u4f60\u9700\u8981\u6c42\u51fa\u6709\u591a\u5c11\u4e2a\u503c\u662f\u300c\u5408\u6cd5\u300d\u7684\uff0c\u5373\uff1a\u5bf9\u4e8e\u6bcf\u6761 $x\\to p$ \u7684\u94fe\uff0c\u94fe\u4e0a\u7684\u8fb9\u6743\u5f02\u6216\u548c\u4e0e $a_x$ \u7684\u53d6\u503c\u5f02\u6216\u5f97\u5230\u7684\u503c\u4e0d\u80fd\u8d85\u8fc7 $k$\u3002\n\n\u76f4\u63a5\u679a\u4e3e $[0,k]$ \u5185\u7684\u6240\u6709\u53d6\u503c\uff0c\u590d\u6742\u5ea6 $O(nk)$\u3002\u8fd9\u5c31\u662f\u6211\u534a\u5e74\u524d\u573a\u4e0a\u7684\u505a\u6cd5\uff08\n\n\u5b9e\u9645\u4e0a\u53ef\u4ee5\u6ce8\u610f\u5230\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u70b9 $p$\uff0c\u5bf9\u4e8e\u4efb\u610f\u4e00\u6761 $x\\to p$ \u7684\u8def\u5f84\uff0c\u5176\u8fb9\u6743\u5f02\u6216\u548c\u5fc5\u7136\u76f8\u540c\uff1b\u5426\u5219\u7b54\u6848\u5373\u4e3a $0$\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5bf9\u6bcf\u4e2a\u70b9 $p$ \u6c42\u51fa $x\\to p$ \u8def\u5f84\u4e0a\u7684\u8fb9\u6743\u5f02\u6216\u548c\uff0c\u7136\u540e\u628a\u8fd9\u4e9b\u6570\u5168\u90fd\u653e\u8fdb\u4e00\u4e2a $\\text{01-Trie}$ \u91cc\u3002\n\n\u73b0\u5728\u5c31\u76f8\u5f53\u4e8e\u8981\u6c42\u51fa\uff1a\u6709\u591a\u5c11\u4e2a\u6570\uff0c\u4f7f\u5f97\u5b83\u4e0e $\\text{Trie}$ \u5185\u7684\u6240\u6709\u6570\u4e2d\u5f02\u6216\u6700\u5927\u503c\u4e0d\u8d85\u8fc7 $k$\u3002\n\n\u6211\u4eec\u4ece\u6839\u5f00\u59cb\u5f80\u4e0b\u8d70\uff0c\u4f9d\u6b21\u51b3\u5b9a\u6bcf\u4e00\u4f4d\u5e94\u8be5\u9009\u4ec0\u4e48\u3002\n\n\u53d6\u5230\u7b2c $i$ \u4f4d\u65f6\u8bb0\u5f55\u6b64\u65f6\u5f02\u6216\u6700\u5927\u503c $S$\uff0c\u7136\u540e\u8ba8\u8bba\u8fd9\u4e00\u4f4d\u4e0a\u80fd\u5426\u9009 $0/1$\uff1a\n\n- \u5982\u679c $S>k$\uff0c\u90a3\u4e48\u76f4\u63a5\u9012\u5f52\u7ec8\u6b62\uff0c\u7136\u540e `return` \u56de\u53bb\u3002\n\n- \u5f53\u524d\u8282\u70b9\u6709\u4e24\u4e2a\u5b50\u8282\u70b9\uff1a\u90a3\u4e48\u4e0d\u7ba1\u73b0\u5728\u53d6\u4ec0\u4e48\u90fd\u5fc5\u7136\u4f1a\u51fa\u73b0\u4e00\u4e2a $1$\u3002\u56e0\u6b64\u76f4\u63a5\u4ee4 $S$ \u52a0\u4e0a $2^i$\uff0c\u5f80\u5de6\u53f3\u5b50\u6811\u9012\u5f52\u5373\u53ef\u3002\n- \u5f53\u524d\u8282\u70b9\u6709\u4e00\u4e2a\u5b50\u8282\u70b9\uff1a\u90a3\u4e48\u5982\u679c\u5728\u8fd9\u4e00\u4f4d\u4e0a\u9009\u4e86\u76f8\u540c\u7684\u6570\uff0c$S$ \u81f3\u591a\u52a0\u4e0a $2^i-1$\u3002\u5982\u679c $S+2^i-1\\le k$ \u90a3\u4e48\u80af\u5b9a\u53ef\u4ee5\uff0c\u56e0\u6b64\u53ef\u4ee5\u76f4\u63a5\u5c06\u7b54\u6848\u52a0\u4e0a $2^{i-1}$\uff0c\u540c\u65f6\u5c06 $S$ \u52a0\u4e0a $2^i$\uff08\u76f8\u5f53\u4e8e\u8fd9\u4e00\u4f4d\u4e0a\u53d6\u4e86\u76f8\u53cd\u7684\u6570\uff09\uff0c\u7ee7\u7eed\u9012\u5f52\uff1b\u5426\u5219\u8fd9\u4e00\u4f4d\u4e0a\u5fc5\u7136\u4e0d\u80fd\u53d6\u4e0d\u540c\u7684\u503c\uff0c\u90a3\u4e48\u76f4\u63a5\u5f80\u76f8\u540c\u65b9\u5411\u9012\u5f52\u5373\u53ef\u3002\n- \u5f53\u524d\u8282\u70b9\u662f\u53f6\u5b50\u7ed3\u70b9\uff1a\u90a3\u4e48\u5982\u679c $S\\le k$ \u5c31\u8fd4\u56de $1$\uff0c\u5426\u5219\u4e3a $0$\u3002\n\n\u8fd9\u6837\u4e00\u6765\uff0c\u6211\u4eec\u76f8\u5f53\u4e8e\u53ea\u904d\u5386\u4e86\u4e00\u6b21 $\\text{Trie}$\uff0c\u603b\u7684\u590d\u6742\u5ea6\u5c31\u662f $O(n\\log V)$\u3002\u5176\u4e2d $V=2^{30}$ \u4e3a\u503c\u57df\u3002\n\n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\n\n#define int long long\n\nusing namespace std;\n\ninline int read(){\n\tint x=0,f=1;char c=getchar();\n\tfor(;(c<'0'||c>'9');c=getchar()){if(c=='-')f=-1;}\n\tfor(;(c>='0'&&c<='9');c=getchar())x=x*10+(c&15);\n\treturn x*f;\n}\n\nconst int MN=5e5+5;\nconst int mod=1e9+7;\nint n,m,k;\n\nstruct Trie{\n\tint d[MN<<5][2],tot;\n\n\tvoid clear(){\n\t\tfor(int i=1;i<=tot;i++)d[i][0]=d[i][1]=0;\n\t\ttot=1;\n\t}\n\n\tvoid ins(int x){\n\t\tint p=1;\n\t\tfor(int i=30;i>=0;i--){\n\t\t\tint c=(x>>i)&1;\n\t\t\tif(!d[p][c])d[p][c]=++tot;\n\t\t\tp=d[p][c];\n\t\t}\n\t}\n\n\tint query(int p,int S,int w){\n\t\tif(S>k)return 0;\n\t\tif(w<0)return 1;\n\t\tif(d[p][0]&&d[p][1])return (query(d[p][0],S+(1ll<<w),w-1)+query(d[p][1],S+(1ll<<w),w-1))%mod;\n\t\telse{\n\t\t\tint q=(d[p][0]|d[p][1]);\n\t\t\tif(S+(1ll<<w)-1<=k)return (query(q,S+(1ll<<w),w-1)+(1ll<<w))%mod;\n\t\t\telse return query(q,S,w-1);\n\t\t}\n\t}\n}tree;\n\nstruct Edge{\n\tint to,cost;\n\tEdge(int T,int C):to(T),cost(C){}\n\tEdge(){}\n};\nvector<Edge>G[MN];\nint dis[MN];\nbool vis[MN];\n\nvoid dfs(int u){\n\tvis[u]=1,tree.ins(dis[u]);\n\tfor(auto e:G[u]){\n\t\tint v=e.to,w=e.cost;\n\t\tif(vis[v]&&(dis[v]!=(dis[u]^w))){puts(\"0\");exit(0);}\n\t\tif(vis[v])continue;\n\t\tdis[v]=(dis[u]^w),dfs(v);\n\t}\n}\n\nsigned main(void){\n\n#ifndef ONLINE_JUDGE\n\tfreopen(\"in.in\",\"r\",stdin);\n#endif\t\t\n\n\tn=read(),m=read(),k=read();\n\tfor(int i=1;i<=m;i++){\n\t\tint x=read(),y=read(),z=read();\n\t\tG[x].push_back(Edge(y,z)),G[y].push_back(Edge(x,z));\n\t}\n\n\tint ans=1;\n\tfor(int i=1;i<=n;i++){\n\t\tif(!vis[i])tree.clear(),dfs(i),ans=ans*tree.query(1,0,30)%mod;\n\t}\n\tcout<<ans<<endl;\n\n\treturn 0;\n}\n```",
        "postTime": 1647957724,
        "uid": 307453,
        "name": "\u4e91\u6d45\u77e5\u5904",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P7717 \u300cEZEC-10\u300d\u5e8f\u5217"
    },
    {
        "content": "## [Link](https://www.luogu.com.cn/problem/P7717)\n\n\u4e0d\u77e5\u9053\u8fd9\u9898\u8ddf\u6570\u4f4d dp \u6709\u4ec0\u4e48\u5173\u7cfb\u2026\u2026\n\n\u5bb9\u6613\u53d1\u73b0\u5bf9\u4e8e\u4e00\u7ec4 $(x_i,y_i,z_i)$\uff0c\u5f53 $a_{x_i}$ \u786e\u5b9a\u65f6\uff0c$a_{y_i}$ \u4e5f\u786e\u5b9a\u4e86\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53 $a_{pos}$ \u786e\u5b9a\u65f6\uff0c\u6240\u6709\u548c $a_{pos}$ \u6709\u5173\u7684 $a_{x_i}$ \u6216 $a_{y_i}$ \u4e5f\u786e\u5b9a\u4e86\u3002\n\n\u6211\u4eec\u628a\u5b83\u5efa\u6210\u4e00\u4e2a\u56fe\uff0c$x_i$ \u548c $y_i$ \u4e3a\u70b9\uff0c$z_i$ \u4e3a\u8fb9\u6743\u3002\u8bbe $div_{u,v}$ \u8868\u793a\u70b9 $u$ \u5230 \u70b9 $v$ \u7684\u8def\u5f84\u5f02\u6216\u548c\u3002\n\n\u5bb9\u6613\u53d1\u73b0\uff0c\u53ea\u8981\u5bf9\u4e8e\u8fde\u901a\u5757\u4e2d\u4efb\u610f\u4e00\u4e2a\u70b9\u8d4b\u4e00\u4e2a\u503c\uff0c\u90a3\u4e48\u5176\u4ed6\u7684\u70b9\u4e5f\u90fd\u4f1a\u786e\u5b9a\u3002\n\n\u73b0\u5728\u5047\u8bbe\u627e\u5230\u4e00\u4e2a\u8054\u901a\u5757\uff0c\u4efb\u53d6\u4e00\u4e2a\u70b9 $u$\uff0c\u8d4b\u503c\u4e3a $val$\u3002\u90a3\u4e48\u5bf9\u4e8e\u8fde\u901a\u5757\u4e2d\u53e6\u5916\u4efb\u610f\u70b9 $v$\uff0c\u503c\u90fd\u4e3a $val\u2295dis_{u,v}$\u3002\u663e\u7136\uff0c\u82e5\u4e00\u4e2a\u70b9\u6709\u591a\u4e2a\u70b9\u6743\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5e8f\u5217\u663e\u7136\u6784\u4e0d\u6210\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5c06\u70b9 $u$ \u7684\u503c\u8d4b\u4e3a $[0,k]$ \u4e2d\u7684\u4efb\u610f\u6574\u6570\u3002\u4f46\u662f\u6709\u4e9b\u503c\u53ef\u80fd\u4f1a\u4f7f\u5f97\u4e00\u4e9b\u70b9 $v$ \u7684\u503c\u5927\u4e8e $k$\u3002\n\n\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u662f\u679a\u4e3e $u$ \u7684\u503c\uff0c\u7136\u540e\u4e00\u4e00\u5224\u65ad\u5176\u4ed6\u70b9 $v$ \u6ee1\u4e0d\u6ee1\u8db3\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(nk)$\u3002\n\n\u518d\u89c2\u5bdf\u4e00\u4e0b\u9898\u76ee\u3002\u6211\u4eec\u5df2\u7ecf\u6c42\u51fa\u4e86 $dis_{u,v}$\uff0c\u800c\u73b0\u5728\u6211\u4eec\u9700\u8981\u627e\u51fa\u6ee1\u8db3 $val\u2295dis_{u,v}\\le k$ \u7684 $val$ \u7684\u4e2a\u6570\u3002\n\n\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u7528 $\\tt Trie$ \u6811\u6765\u505a\u3002\n\n\u6211\u4eec\u628a\u6240\u6709 $dis_{u,v}$ \u4e22\u8fdb\u4e00\u4e2a $\\tt 01-Trie$ \u91cc\uff0c\u7136\u540e\u904d\u5386 $\\tt Trie$ \u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n\\log k)$\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define mod 1000000007\nusing namespace std;\ninline int read()\n{\n\tint s=0;char c=getchar();\n\tfor(;!isdigit(c);c=getchar());\n\tfor(;isdigit(c);c=getchar())\n\t\ts=s*10+c-'0';\n\treturn s;\n}\nint n,m,k,ans=1;\nint tot,head[500005];\nstruct edge{\n\tint to,dis,nxt;\n}e[1000005];\nbool vis[500005];\nint dis[500005];\nint cnt=1,son[500005*30][2];\ninline void add(int u,int v,int w)\n{\n\te[++tot].to=v;\n\te[tot].dis=w;\n\te[tot].nxt=head[u];\n\thead[u]=tot;\n}\ninline void insert(int x)\n{\n\tint u=1;\n\tfor(int i=30;i>=0;i--)\n\t{\n\t\tint ch=(x>>i)&1;\n\t\tif(!son[u][ch])son[u][ch]=++cnt;\n\t\tu=son[u][ch];\n\t}\n}\nint query(int u,int x,int w)\n{\n\tif(x>k)return 0;\n\tif(w<0)return 1;\n\tif(son[u][0]&&son[u][1])\n\t\treturn (query(son[u][0],x+(1<<w),w-1)+query(son[u][1],x+(1<<w),w-1))%mod;\n\t//query(son[u][0],x+(1<<w),w-1)\uff1a\u7b2cw\u4f4d\u90091\n\t//query(son[u][1],x+(1<<w),w-1)\uff1a\u7b2cw\u4f4d\u90090 \n\tint v=max(son[u][0],son[u][1]);\n\tif(x+(1<<w)<=k)\n\t\treturn (query(v,x+(1<<w),w-1)+(1<<w))%mod;\n\t//\u7b2cw\u4f4d\u90090\u90091\u90fd\u53ef\u4ee5 \n\treturn query(v,x,w-1);//\u7b2cw\u4f4d\u53ea\u80fd\u9009\u76f8\u53cd\u7684\u90a3\u4e00\u4e2a \n}\nvoid dfs(int u)\n{\n\tvis[u]=true;\n\tinsert(dis[u]);\n\tfor(int i=head[u];i;i=e[i].nxt)\n\t{\n\t\tint v=e[i].to;\n\t\tif(vis[v]&&dis[v]!=(dis[u]^e[i].dis))\n\t\t{\n\t\t\tprintf(\"0\\n\");\n\t\t\texit(0);\n\t\t}\n\t\tif(vis[v])continue;\n\t\tdis[v]=dis[u]^e[i].dis;\n\t\tdfs(v);\n\t}\n}\nint main()\n{\n\tn=read(),m=read(),k=read();\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint u=read(),v=read(),w=read();\n\t\tadd(u,v,w),add(v,u,w);\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tif(!vis[i])\n\t\t{\n\t\t\tdfs(i);\n\t\t\tans=1ll*ans*query(1,0,30)%mod;\n\t\t\tfor(int j=1;j<=cnt;j++)\n\t\t\t\tson[j][0]=son[j][1]=0;\n\t\t\tcnt=1;\n\t\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1658828227,
        "uid": 306049,
        "name": "Utilokasteinn",
        "ccfLevel": 0,
        "title": "P7717 \u300cEZEC-10\u300d\u5e8f\u5217"
    }
]
[
    {
        "content": "\u597d\u50cf\u53c8\u662f\u5168\u7f51\u6728\u5927\u9898\u89e3\uff0c\u8fd8\u6709\u8fd9\u9898 luogu \u76ee\u524d\u7f3a\u4e4f spj\uff08on 2022.6.13\uff09\n\n\u5728 LOJ \u4e0a[\u5df2\u7ecf\u901a\u8fc7](https://loj.ac/s/1482146)\uff0c\u4e14\u5927\u6570\u636e\u4e0b\u8c8c\u4f3c\u6bd4 std \u7684\u6784\u9020\u7528\u7684\u6b21\u6570\u5c11\u633a\u591a\uff1f\n\n[\u79fb\u52a8\u6570\u7ec4](https://www.luogu.com.cn/problem/P6347)\n\n> \u652f\u6301\u5bf9\u67d0\u884c\u6216\u67d0\u5217\u7684 shift\uff0c\u6784\u9020\u64cd\u4f5c\u4f7f\u5f97\u77e9\u9635\u53d8\u4e3a\u76ee\u6807\u77e9\u9635\u3002\n\n\u667a\u6167\u6784\u9020\u9898\u3002\n\n\u9996\u5148\u53d1\u73b0\u64cd\u4f5c\u6b21\u6570\u9650\u5236\u8fdc\u5927\u4e8e\u5b9e\u9645\u9700\u8981\uff0c\u6545\u4e0d\u662f\u91cd\u70b9\u3002\u5728\u601d\u8003\u4e00\u756a\u4e4b\u540e\uff0c\u53d1\u73b0\u9010\u4e2a\u786e\u5b9a\u8fd8\u662f\u6700\u76f4\u63a5\u4e14\u6709\u6548\u7684\u65b9\u6cd5\u3002\n\n\u5373\u6bcf\u6b21\u786e\u5b9a\u65b0\u4f4d\u7f6e\u7684\u540c\u65f6\uff0c\u4e0d\u6539\u53d8\u4e4b\u524d\u786e\u5b9a\u7684\u4f4d\u7f6e\u4e0a\u7684\u6570\u3002\n\n\u53d1\u73b0\u53ef\u4ee5\u9010\u884c\u9010\u5217\u7684\u786e\u5b9a\uff0c\u5047\u8bbe\u5f53\u524d\u786e\u5b9a\u5230\u4e86 $(i,j)$\uff0c\u5373\u786e\u5b9a\u4e86 $1\\sim i-1$ \u884c\u548c\u7b2c $i$ \u884c\u7684\u7b2c $1\\sim j-1$ \u4e2a\u3002\n\n\u5047\u8bbe $(i-1)\\times m+j$\uff08\u8fd9\u91cc\u4e0b\u6807\u4ece 1 \u5f00\u59cb\uff09\u5728 $(i',j')$\uff0c\u6839\u636e $i=i'$ \u6216 $j=j'$ \u6216\u5e73\u51e1\u60c5\u51b5\u8ba8\u8bba\uff0c\u5206\u522b\u80fd\u7528 $4,4,3$ \u6b65\u89e3\u51b3\u3002\n\n\u4f46\u662f\uff0c\u8fd9\u53ea\u80fd\u786e\u5b9a\u524d $n-1$ \u884c\uff0c\u56e0\u4e3a\u4ee5\u4e0a\u64cd\u4f5c\u5747\u57fa\u4e8e**\u5f80\u4e0b\u79fb\u52a8\u6709\u591a\u4f59\u884c**\u3002\n\n\u4f46\u81f3\u5c11\u53ea\u5269\u4e0b\u4e00\u884c\u4e86\u3002\n\n\u8fd8\u662f\u8003\u8651\u4ece\u5de6\u5f80\u53f3\u786e\u5b9a\uff0c\u5047\u8bbe\u5f53\u524d\u5230 $j$\uff0c\u800c $(n-1)\\times m+j$ \u5728 $j'$\uff0c\u9700\u8981\u5728\u4e0d\u6539\u53d8\u524d $n-1$ \u884c\u7684\u524d\u63d0\u4e0b\u4f7f $j'\\to j$\u3002\n\n\u53d1\u73b0\u53ef\u4ee5\u5229\u7528\u4e00\u5217\u505a\u201c\u4e2d\u8f6c\u7ad9\u201d\uff0c\u4f8b\u5982\u6700\u540e\u4e00\u5217\uff0c\u6bcf\u6b21\u663e\u7136 $j'>j$\uff08$j'=j$ \u5c31\u65e0\u9700\u79fb\u52a8\u4e86\uff09\u3002\n\n\u90a3\u4e48\u8f6c\u79fb\u5c31\u662f\uff1a\n\n1. \u5c06 $j'$ \u53f3\u79fb\u5230 $m$ \u5217\u3002\n2. $m$ \u5217\u4e0a\u79fb\u4e00\u683c\u3002\n3. \u5c06 $j$ \u53f3\u79fb\u5230 $m$ \u5217\u3002\n4. $m$ \u5217\u4e0b\u79fb\u4e00\u683c\u3002\n5. \u5c06 $j'$ \u5de6\u79fb\u5230 $m$ \u5217\u3002\n6. $m$ \u5217\u4e0a\u79fb\u4e00\u683c\u3002\n7. \u5c06 $j'$ \u5de6\u79fb\u5230\u539f\u672c\u7684 $j'$\u3002\n\n~~\u5b9e\u9645\u4e0a\u8fd9\u91cc\u6700\u597d\u662f\u753b\u56fe\u7406\u89e3\uff0c\u4e0d\u8fc7\u5b9e\u5728\u61d2\u4e86~~\n\n\u552f\u4e00\u95ee\u9898\uff0c\u4f60\u53d1\u73b0 $m$ \u5217\u7684\u524d $n-1$ \u884c\u88ab\u4f60 shift \u4e86\uff01\n\n\u5982\u679c\u6bcf\u505a\u4e00\u6b21\u5c31\u8fd9\u6837 shift \u4e00\u6b21\uff0c\u9664\u975e\u8fd9\u79cd\u64cd\u4f5c\u662f $n-1$ \u7684\u500d\u6570\uff0c\u5426\u5219\u5c31\u5f97\u5230\u4e86\u5728\u6700\u540e\u4e00\u5217\u65b9\u5411\u4e0a\u7684\u540c\u6837\u7684\u5b50\u95ee\u9898\uff0c\u76f8\u5f53\u4e8e\u6ca1\u6709\u8fdb\u5c55\u3002\n\n\u4f46\u5bc4\u5e0c\u671b\u4e8e $n-1$ \u7684\u500d\u6570\u8fd9\u4e00\u70b9\u663e\u7136\u4e0d\u592a\u73b0\u5b9e\u3002\n\n\u4f46\u662f\u5f88\u5de7\u5999\u7684\uff0c\u53d1\u73b0\u53ef\u4ee5\u5c06\u6bcf\u6b21 shift \u7684\u65b9\u5411\u4ea4\u66ff\uff0c\u53ea\u9700\u8981\u6bcf\u6b21\u8ba9 $m$\uff08\u7b2c $m$ \u5217\u7684\u6700\u5c0f\u5143\u7d20\uff09\u8fdb\u5165\u7b2c $n$ \u884c\u5373\u53ef\u3002\n\n\u4e5f\u5c31\u662f\u5bf9\u5e94\u7b2c $2$ \u548c $4$ \u548c $6$ \u7684\u65f6\u5019\uff0c\u5224\u4e00\u4e0b $m$ \u5728\u54ea\u91cc\u800c\u5bf9\u5e94\u4e0a\u8ff0\u6b65\u9aa4\u6216\u8005\u5747\u53d6\u53cd\u3002\n\n\u53d1\u73b0\u8fd9\u6837\u82e5\u4e0a\u4e00\u6b21 $m$ \u5728\u7b2c $1$ \u884c\uff0c\u90a3\u4e48\u4e4b\u540e\u5c31\u4f1a\u51fa\u73b0\u5728 $n-1$ \u884c\uff0c\u53cd\u4e4b\u5219\u53c8\u4f1a\u56de\u5230\u7b2c $1$ \u884c\uff01\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6700\u7ec8\u8981\u4e48\u5df2\u7ecf\u6210\u529f\u4e86\uff0c\u8981\u4e48\u5c31\u662f\u7b2c $m$ \u5217\u957f\u6210\u8fd9\u6837\uff1a\uff08\u5047\u8bbe $m\\to 1,2m\\to2,\\cdots$\uff09\n\n```plain\n2\n3\n4\n.\n.\n.\nn - 1\n1\nn\n```\n\n\u8fd9\u65f6\u5019\u8fd8\u662f\u53ef\u4ee5\u5ef6\u7eed\u201c\u4e2d\u8f6c\u7ad9\u201d\u7684\u601d\u8def\uff0c\u7528\u7b2c $1$ \u884c\u4f5c\u4e3a\u201c\u4e2d\u8f6c\u7ad9\u201d\uff0c\u7136\u540e\u7c7b\u4f3c\u6700\u540e\u7684\u4ea4\u66ff\u601d\u60f3\uff0c\u5c06\u6700\u540e\u4e00\u5217\u4e0d\u65ad\u4e0a\u79fb\uff0c\u548c\u4ea4\u66ff\u5de6\u53f3\u79fb\u52a8\u7b2c\u4e00\u884c\u3002\n\n\u624b\u73a9\u4e00\u4e0b\uff1a\n\n```   plain\n 2    x 2    3 2    3 2    3 4    3 4   5 4    5 4    5 1    5 1    6 1    x 1    1\n 3    3      4        4      5    5     1        1      6    6      x      2      2\n 4 -> 4   -> 5   ->   5 ->   1 -> 1  -> 6   ->   6 ->   x -> x   -> 2   -> 3   -> 3\n 5    5      1        1      6    6     x        x      2    2      3      4      4\n 1    1      6        6      x    x     2        2      3    3      4      5      5\n 6    6      x        x      2    2     3        3      4    4      5      6      6\n```\n\n\u4f60\u53d1\u73b0 x \u786e\u5b9e\u662f\u4ece\u5de6\u8fb9\u501f\u6765\u7684\uff0c\u6240\u4ee5\u5b83\u4ece\u54ea\u6765\u56de\u54ea\u53bb\u4e86\u3002\n\n\u8fd9\u79cd\u4ea4\u66ff\u80fd\u6210\u529f\uff0c\u57fa\u4e8e $n-1$ \u662f\u5947\u6570\uff0c\u4e5f\u5c31\u662f\u9898\u76ee\u4fdd\u8bc1\u7684 $n,m$ \u5747\u4e3a\u5076\u6570\u7684\u6761\u4ef6\u3002\n\n\u5c0f\u62d3\u5c55\u4e00\u4e0b\uff0c\u5b9e\u9645\u4e0a\u53ea\u9700\u8981\u6709\u4e00\u4e2a\u662f\u5076\u6570\u5c31\u884c\u4e86\uff0c\u5982\u679c\u53ea\u6709 $m$ \u4e3a\u5076\u6570\u5c31 reverse \u4e00\u4e0b\u6574\u4e2a\u77e9\u9635\u3002\n\n\u518d\u62d3\u5c55\u4e00\u4e0b\uff0c\u5982\u679c\u4e24\u4e2a\u90fd\u662f\u5947\u6570\uff0c\u6211\u65ad\u8a00\u53ea\u6709\u4e0d\u51fa\u73b0\u6700\u540e\u7b2c $m$ \u5217\u88ab shift \u7684\u60c5\u51b5\u624d\u6709\u89e3\uff0c\u5426\u5219\u65e0\u89e3\u3002\uff08\u5728\u7ebf\u6c42\u6784\u9020\u5927\u5e08\u8bc1\u660e/kel\uff09\n\n\u6bdb\u5495\u5495\u4e00\u4e0b\u590d\u6742\u5ea6\u662f $O(4n^2+9n)$ \u7684\u3002\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long LL;\n#define rep(i, a, b) for(int i = (a); i <= (b); i ++)\n#define per(i, a, b) for(int i = (a); i >= (b); i --)\n#define Ede(i, u) for(int i = head[u]; i; i = e[i].nxt)\nusing namespace std;\n\nint read() {\n\tint x = 0, f = 1; char c = getchar();\n\twhile(c < '0' || c > '9') f = (c == '-') ? - 1 : 1, c = getchar();\n\twhile(c >= '0' && c <= '9') x = x * 10 + c - 48, c = getchar();\n\treturn x * f;\n}\n\nconst int N = 110, M = N * N;\nint n, m, a[N][N], idx[M], idy[M];\nint tot; struct node {int o, x, d;} ans[M * 10];\n\nint tmp[N];\n\nvoid work(int o, int x, int d) {\n\tif(o == 1) {\n\t\tif(d == m) return;\n\t\tans[++ tot] = (node) {o, x, d};\n\t\trep(j, 1, m) tmp[j + d > m ? j + d - m : j + d] = a[x][j];\n\t\trep(j, 1, m) a[x][j] = tmp[j], idy[a[x][j]] = j;\n\t}\n\telse {\n\t\tif(d == n) return;\n\t\tans[++ tot] = (node) {o, x, d};\n\t\trep(i, 1, n) tmp[i + d > n ? i + d - n : i + d] = a[i][x];\n\t\trep(i, 1, n) a[i][x] = tmp[i], idx[a[i][x]] = i;\n\t}\n}\n\nint main() {\n\tn = read(), m = read();\n\trep(i, 1, n) rep(j, 1, m) a[i][j] = read() + 1, idx[a[i][j]] = i, idy[a[i][j]] = j;\n\trep(i, 1, n - 1) rep(j, 1, m) if(a[i][j] != (i - 1) * m + j) {\n\t\tint v = (i - 1) * m + j, cx = idx[v], cy = idy[v];\n\t\tif(cx == i) {\n\t\t\twork(1, i, m - (cy - j));\n\t\t\twork(2, j, n - 1);\n\t\t\twork(1, i, cy - j);\n\t\t\twork(2, j, 1);\n\t\t}\n\t\telse if(cy == j) {\n\t\t\twork(1, cx, 1);\n\t\t\twork(2, j, cx - i);\n\t\t\twork(1, cx, m - 1);\n\t\t\twork(2, j, n - (cx - i));\n\t\t}\n\t\telse {\n\t\t\twork(2, j, cx - i);\n\t\t\tint dis = j > cy ? j - cy : m - (cy - j);\n\t\t\twork(1, cx, dis);\n\t\t\twork(2, j, n - (cx - i));\n\t\t}\n\t}\n\trep(j, 1, m) if(a[n][j] != (n - 1) * m + j) {\n\t\tint cy = idy[(n - 1) * m + j];\n\t\tif(cy != m) work(1, n, m - cy);\n\t\tint o = (a[n - 1][m] == m);\n\t\twork(2, m, o ? 1 : n - 1);\n\t\twork(1, n, cy - j);\n\t\twork(2, m, o ? n - 1 : 1);\n\t\twork(1, n, m - (cy - j));\n\t\twork(2, m, o ? 1 : n - 1);\n\t\twork(1, n, m - (m - cy));\n\t}\n\tif(a[1][m] != m) {\n\t\twork(1, 1, m - 1), work(2, m, n - 1);\n\t\tint o = 0;\n\t\trep(k, 1, n) {\n\t\t\tif(a[1][m] == n * m) {work(2, m, n - 1); continue;}\n\t\t\twork(1, 1, o ? m - 1 : 1), o ^= 1;\n\t\t\tif(a[1][m] == m) break;\n\t\t\twork(2, m, n - 1);\n\t\t}\n\t}\n\t//rep(c, 1, n) rep(d, 1, m) printf(\"%d%c\", a[c][d], d == m ? '\\n' : ' '); puts(\"\");\n\tprintf(\"%d\\n\", tot);\n\trep(i, 1, tot) printf(\"%d %d %d\\n\", ans[i].o, ans[i].x, ans[i].d);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1655128267,
        "uid": 117941,
        "name": "_LPF_",
        "ccfLevel": 9,
        "title": "P6347 [CCO 2017]\u79fb\u52a8\u6570\u7ec4"
    }
]
[
    {
        "content": "\u663e\u7136\uff0c$i$ \u53f7\u673a\u5668\u4eba\u7684\u72ec\u7acb\u6570\u5c31\u662f $\\varphi(i)$\uff08\u7279\u522b\u5730\uff0c$1$ \u53f7\u673a\u5668\u4eba\u7684\u72ec\u7acb\u6570\u4e3a $0$\uff09\u3002\n\n\u653f\u5ba2\u548c\u519b\u4eba\u7684\u72ec\u7acb\u6570\u4e4b\u548c\u53ef\u4ee5\u5f88\u5bb9\u6613\u7528 DP \u6c42\u51fa\u3002\n\n\u8bbe $f(i,0/1)$ \u8868\u793a\u524d $i$ \u4e2a\u56e0\u5b50\u4e2d\uff0c\u9009\u4e86\u5947\u6570\u4e2a\u6216\u5076\u6570\u4e2a\u56e0\u5b50\u7684\u72ec\u7acb\u6570\u7684\u548c\u3002\n\n\u5bf9\u4e8e\u5f53\u524d\u56e0\u5b50\u6709\u9009\u548c\u4e0d\u9009\u4e24\u79cd\u51b3\u7b56\uff0c\u6240\u4ee5\u6709\uff0c\n\n$$\nf(i,j)=f(i-1,j \\oplus 1) \\times \\varphi(p_i) + f(i-1,j)\n$$\n\n\uff08\u522b\u5fd8\u4e86 $p_i$ \u90fd\u662f\u8d28\u6570\uff0c\u6240\u4ee5$\\varphi(p_i)=p_i-1$\uff09\n\n\u7279\u522b\u5730\uff0c\u56e0\u4e3a\u653f\u5ba2\u548c\u519b\u4eba\u7684\u8ba8\u8bba\u8303\u56f4\u90fd\u662f\u5947\u7d20\u6570\uff0c\u56e0\u6b64\u8981\u5bf9 $p_i=2$ \u7684\u60c5\u51b5\u7279\u6b8a\u5904\u7406\u3002\n\n\u6700\u540e\u7528\u603b\u72ec\u7acb\u6570\u51cf\u53bb\u653f\u5ba2\u548c\u519b\u4eba\u7684\u72ec\u7acb\u6570\u5373\u53ef\u5f97\u5230\u5b66\u8005\u7684\u72ec\u7acb\u6570\u3002\n\n\u603b\u72ec\u7acb\u6570\u5e76\u4e0d\u96be\u7b97\uff0c\u56e0\u4e3a $m= \\sum_{d|m} \\varphi(d)$\uff0c\u6545\u603b\u72ec\u7acb\u6570\u4e3a $m-1$\uff08\u522b\u5fd8\u4e86 $1$ \u53f7\u673a\u5668\u4eba\u5e76\u4e0d\u5728\u6211\u4eec\u7684\u8ba8\u8bba\u8303\u56f4\u4e4b\u5185\uff09\u3002\n\n```cpp\n#include <cstdio>\n#define MOD 10000\nint f[1005][2];\nint fpow(int x,int y)\n{\n int ans=1;\n while(y)\n {\n  if(y&1)ans=ans*x%MOD;\n  x=x*x%MOD;\n  y>>=1;\n }\n return ans;\n}\nint main()\n{\n int k;\n scanf(\"%d\",&k);\n int tot=1;\n f[0][0]=1;\n for(int i=1;i<=k;i++)\n {\n  int p,e;\n  scanf(\"%d%d\",&p,&e);\n  tot=tot*fpow(p,e)%MOD;\n  for(int j=0;j<=1;j++)\n   f[i][j]=(f[i-1][j^1]*(p==2?0:p-1)+f[i-1][j])%MOD;\n }\n f[k][0]=(f[k][0]-1+MOD)%MOD;\n printf(\"%d\\n\",f[k][0]);\n printf(\"%d\\n\",f[k][1]);\n printf(\"%d\\n\",((tot-f[k][0]-f[k][1]-1)%MOD+MOD)%MOD);\n return 0;\n}\n```\n",
        "postTime": 1575784817,
        "uid": 22030,
        "name": "StudyingFather",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5746 \u3010[NOI2002]\u673a\u5668\u4ebaM\u53f7\u3011"
    },
    {
        "content": "\u901a\u8bfb\u4e00\u904d\u9898\u9762\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u51e0\u4e2a\u6027\u8d28\uff1a\n\n- $u$ \u662f $v$ \u7684\u8001\u5e08 $\\iff$ $u|v$ \u5e76\u4e14 $u \\ne 1$\u3002\n- \u82e5 $u \\ne 1$\uff0c\u90a3\u4e48 $u$ \u7684\u72ec\u7acb\u6570 $= \\varphi(u)$\u3002\n\n\u6211\u4eec\u4f1a\u53d1\u73b0\u653f\u5ba2\u548c\u519b\u4eba\u53ea\u80fd\u7531\u4e0d\u540c\u7684\u5947\u7d20\u6570\u4e58\u8d77\u6765\u5f97\u5230\uff0c\u56e0\u4e3a $\\varphi$ \u662f\u79ef\u6027\u51fd\u6570\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5f88\u5bb9\u6613\u7528 dp \u8ba1\u7b97\uff1a\n\n\u8bbe $f_{i,j}$ \u8868\u793a\u8003\u8651\u4e86\u524d $i$ \u4e2a\u8d28\u6570\uff0c\u9009\u4e2d\u5947\u6570\u8fd8\u662f\u5076\u6570\u4e2a\u7684\u7b54\u6848\uff0c\u8f6c\u79fb\uff1a$f_{i,j}=f_{i-1,j \\ \\text{xor}\\  1}\\times \\varphi(p_i)+f_{i-1,j}$\u3002\n\n\u4f46\u662f\u5b66\u8005\u7684\u72ec\u7acb\u6570\u4e0d\u662f\u5f88\u597d\u7b97\uff0c\u6211\u4eec\u8003\u8651\u5bb9\u65a5\uff0c\u7528\u603b\u7684\u72ec\u7acb\u6570\u51cf\u53bb\u4e0a\u9762\u6c42\u7684\u653f\u5ba2\u548c\u519b\u4eba\u7684\u72ec\u7acb\u6570\u3002\n\n\u56e0\u4e3a $\\sum_{d|n}\\varphi(d) = n$\uff0c\u90a3\u4e48\u603b\u7684\u72ec\u7acb\u6570\u5c31\u662f $m-1$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i, x, y) for(int i = (x); i <= (y); ++ i)\n#define rop(i, x, y) for(int i = (x); i <  (y); ++ i)\n#define per(i, x, y) for(int i = (x); i >= (y); -- i)\n#define por(i, x, y) for(int i = (x); i >  (y); -- i)\n\ntypedef long long LL;\nconst int mod = 10000;\n\nLL ksm(LL x, int p) {\n\tLL a = 1;\n\twhile(p) {\n\t\tif(p & 1) a = a * x % mod;\n\t\tx = x * x % mod;\n\t\tp >>= 1;\n\t}\n\treturn a;\n}\n\nLL f[1050][2];\n\nint main() {\n\tint n; scanf(\"%d\", &n);\n\tLL tot = 1;\n\tf[0][0] = 1;\n\trep(i, 1, n) {\n\t\tint p, k;\n\t\tscanf(\"%d%d\", &p, &k);\n\t\ttot = tot * ksm(p, k) % mod;\n\t\tf[i][1] = (f[i - 1][0] * (p == 2 ? 0 : (p - 1)) % mod + f[i - 1][1]) % mod;\n\t\tf[i][0] = (f[i - 1][1] * (p == 2 ? 0 : (p - 1)) % mod + f[i - 1][0]) % mod;\n\t}\n\tf[n][0] = (f[n][0] - 1 + mod) % mod;\n\tprintf(\"%lld\\n%lld\\n%lld\\n\", f[n][0], f[n][1], ((tot - f[n][0] - f[n][1] - 1) % mod + mod) % mod);\n}\n```\n\n",
        "postTime": 1575690195,
        "uid": 44777,
        "name": "djh123",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5746 \u3010[NOI2002]\u673a\u5668\u4ebaM\u53f7\u3011"
    },
    {
        "content": "\u4e0d\u9700\u8981\u7528\u4e0aDP\u7684\u7eaf\u6570\u5b66\u505a\u6cd5\u3002\n\n\u9996\u5148\u629b\u51fa\u51e0\u4e2a\u7ed3\u8bba\uff1a\n\n1\u3001 $m$ \u7684\u72ec\u7acb\u6570\u5c31\u662f $\\varphi(m)$ \uff1b\n\n2\u3001 $m$ \u7684\u8001\u5e08\u5c31\u662f\u4ed6\u7684\u7ea6\u6570\uff1b\n\n3\u3001 $m$ \u53ca\u4ed6\u8001\u5e08\u7684\u72ec\u7acb\u6570\u548c\u5c31\u662f $m$ \uff08\u5982\u679c\u7b97\u4e0a1\uff09\uff0c\u8fd9\u662f\u56e0\u4e3a $\\sum_{d\\mid m}\\varphi(d)=m$ \u5bf9\u4efb\u610f\u6b63\u6574\u6570 $m$ \u5747\u6210\u7acb\u3002\n\n\n\n------------\n\u7531\u4e0a\u8ff0\u7ed3\u8bba\uff0c\u6211\u4eec\u77e5\u9053\u6700\u540e\u8f93\u51fa\u7684\u4e09\u4e2a\u6570\u7684\u7b54\u6848\u603b\u548c\u5c31\u662f$m-1$\uff0c\u6211\u4eec\u6765\u8003\u8651\u524d\u9762\u4e24\u4e2a\u6570\u600e\u4e48\u6c42\u3002\n\n\u7b2c\u4e00\u4e2a\u7c7b\u522b\u7684\u6570\u6ee1\u8db3\u80fd\u88ab\u5206\u89e3\u6210\u5076\u6570\u4e2a\u4e0d\u540c**\u5947\u7d20\u6570**\u7684\u79ef\uff0c\u7b2c\u4e8c\u4e2a\u7c7b\u522b\u7684\u6570\u6ee1\u8db3\u80fd\u88ab\u5206\u89e3\u6210**\u5076\u6570\u4e2a**\u4e0d\u540c\u5947\u7d20\u6570\u7684\u79ef\uff0c\u6211\u4eec\u4e0d\u59a8\u6765\u6c42\u4e00\u4e0b**\u80fd\u88ab\u5206\u89e3\u6210\u4e0d\u540c\u5947\u7d20\u6570\u7684\u79ef**\u7684\u6570\u5bf9\u5e94\u7684\u72ec\u7acb\u6570\u548c\u3002\n\n\u5047\u8bbe\u8f93\u5165\u7684\u6570 $m$ \u7684\u5947\u8d28\u56e0\u5b50\u4e3a $p_1,p_2,...,p_k$ \uff0c\u90a3\u4e48\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u5c31\u662f\u5728\u8fd9 $k$ \u4e2a\u6570\u5b57\u91cc\u9009\u82e5\u5e72\u4e2a\u6570\u76f8\u4e58\u7684\u7ed3\u679c\uff0c\u90a3\u4e48\u4ed6\u4eec\u7684\u72ec\u7acb\u6570\u662f\u4ec0\u4e48\u5462\uff1f\n\n\u7531\u4e8e\u6b27\u62c9\u51fd\u6570 $\\varphi$ \u6ee1\u8db3\uff1a\u5f53\u4e24\u4e2a\u6570 $p,q$ \u4e92\u8d28\u65f6\uff0c\u6709 $\\varphi(p)\\cdot \\varphi(q)=\\varphi(p\\cdot q)$ \u3002\u6240\u4ee5\u6211\u4eec\u60ca\u559c\u7684\u53d1\u73b0\uff0c\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u5bf9\u5e94\u7684\u72ec\u7acb\u6570\u5c31\u662f\u9009\u51fa\u6765\u7684\u82e5\u5e72\u4e2a $p_i$ \u5bf9\u5e94\u7684\u6b27\u62c9\u51fd\u6570\u7684\u4e58\u79ef\u3002\n\n\u6240\u4ee5\u8fd9\u4e9b\u6570\u7684\u72ec\u7acb\u6570\u4e4b\u548c\u4e3a\n\n$(1+\\varphi(p_1))(1+\\varphi(p_2))...(1+\\varphi(p_k))$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u7684\u610f\u4e49\u5c31\u662f\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8d28\u56e0\u5b50\uff0c\u6211\u8003\u8651\u9009\u6216\u8005\u4e0d\u9009\uff0c\u5982\u679c\u9009\u7684\u8bdd\u5c31\u4f1a\u6709 $\\varphi(p_i)$ \u7684\u8d21\u732e\u3002\uff08\u8054\u60f3\u4e00\u4e0b\u7ea6\u6570\u4e2a\u6570\u4ee5\u53ca\u7ea6\u6570\u548c\u7684\u5f0f\u5b50\uff09\n\n\n------------\n\u6211\u4eec\u56de\u5230\u9898\u76ee\uff0c\u53d1\u73b0\u4ed6\u8981\u6c42\u7684\u662f\u80fd\u88ab\u5206\u89e3\u6210\u5076\u6570\u4e2a\u4e0d\u540c**\u5947\u7d20\u6570**\u7684\u79ef\u7684\u6570\u5b57\u5bf9\u5e94\u7684\u72ec\u7acb\u6570\u548c\uff0c\u90a3\u8fd9\u4e2a\u600e\u4e48\u505a\u5462\uff1f\n\n\n\n------------\n\n\n\u6211\u4eec\u6765\u63d2\u64ad\u4e00\u9053\u4e2d\u5b66\u6570\u5b66\u9898\uff08\u60f3\u770b\u7ed3\u8bba\u8df3\u8fc7\u6b64\u90e8\u5206\uff09\uff1a\u6c42 $(x+1)^5$ \u7684\u5c55\u5f00\u5f0f\u4e2d\uff0c $x,x^3,x^5$ \u7684\u7cfb\u6570\u548c\u3002\n\n\u6211\u4eec\u77e5\u9053\uff0c\u7531\u4e8c\u9879\u5f0f\u5b9a\u7406\uff0c\u6709 $(x+1)^5=\\sum_{i=0}^{5}C_5^i\\cdot x^i$ \uff0c\u90a3\u5982\u679c\u8981\u6c42\u6240\u6709\u7cfb\u6570\u548c\u7684\u8bdd\u6211\u4eec\u77e5\u9053\u7b54\u6848\u5c31\u662f $(1+1)^5=32$ \uff0c\u90a3\u4e48 $x,x^3,x^5$ \u7684\u7cfb\u6570\u548c\u600e\u4e48\u6c42\u5462\uff1f\n\n\u8003\u8651 $(x-1)^5$ \u7684\u5c55\u5f00\u5f0f\uff0c $(x-1)^5=\\sum_{i=0}^{5}C_5^i\\cdot x^i\\cdot(-1)^{5-i}$ \uff0c\u6211\u4eec\u53d1\u73b0\u5728\u8fd9\u4e2a\u5f0f\u5b50\u4e2d\uff0c\u5982\u679c $x$ \u7684\u6b21\u6570 $i$ \u662f\u5076\u6570\uff0c\u90a3\u4e48 $-1$ \u7684\u6b21\u6570 $5-i$ \u5c31\u4f1a\u662f\u5947\u6570\uff0c\u4e5f\u5c31\u662f\u8bf4\u5bf9\u5e94\u7684\u7b26\u53f7\u53d8\u6210\u4e86\u8d1f\u53f7\u3002\u5982\u679c\u6211\u4eec\u628a\u8fd9\u4e2a\u5f0f\u5b50\u548c\u4e4b\u524d\u7684 $(x+1)^5$ \u76f8\u52a0\uff0c\u5c31\u4f1a\u628a\u6240\u6709\u5076\u6570\u6b21\u9879\u6d88\u6389\uff0c\u5269\u4e0b\u7684\u5c31\u53ea\u5269\u4e0b\u5947\u6570\u6b21\u9879 $x,x^3,x^5$ \u4e86\uff01\n\n\u6240\u4ee5\u8fd9\u9053\u9898\u7684\u7b54\u6848\u5c31\u662f $\\frac{(1+1)^5+(1-1)^5}{2}=16$ \u3002\n\n\n------------\n\u770b\u5b8c\u4e0a\u9762\u7684\u4f8b\u9898\uff0c\u4f60\u662f\u4e0d\u662f\u5bf9\u8fd9\u9898\u6709\u4e86\u4e9b\u8bb8\u601d\u8def\u5462\uff1f\n\n\u8003\u8651\u5f0f\u5b50 $(1-\\varphi(p_1))(1-\\varphi(p_2))...(1-\\varphi(p_k))$ \uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u6211\u9009\u53d6\u4e86\u5076\u6570\u4e2a\u56e0\u5b50\uff0c\u90a3\u4e48\u5bf9\u5e94\u7684 $-\\varphi(p_i)$ \u5c31\u4f1a\u88ab\u4e58\u5076\u6570\u6b21\uff0c\u7cfb\u6570\u5c31\u662f $1$ \u3002\u53cd\u4e4b\uff0c\u5982\u679c\u6211\u9009\u53d6\u4e86\u5947\u6570\u4e2a\u56e0\u5b50\uff0c\u90a3\u4e48\u5bf9\u5e94\u7684 $-\\varphi(p_i)$ \u5c31\u4f1a\u88ab\u4e58\u5947\u6570\u6b21\uff0c\u7cfb\u6570\u5c31\u662f $-1$ \u3002\u90a3\u4e48\u6211\u4eec\u628a\u8fd9\u4e2a\u5f0f\u5b50\u4e0e\u4e4b\u524d\u7684\u5f0f\u5b50\u76f8\u52a0\uff0c\u5c31\u53ef\u4ee5\u628a\u5947\u6570\u4e2a\u56e0\u5b50\u5bf9\u5e94\u7684\u72ec\u7acb\u6570\u6d88\u6389\uff0c\u628a\u7ed3\u679c\u9664\u4ee5\u4e8c\u5c31\u662f\u5076\u6570\u4e2a\u8d28\u56e0\u5b50\u7684\u6570\u5bf9\u5e94\u7684\u7b54\u6848\u4e86\uff01\n\n\n\n------------\n\u4e0a\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define N 1010\n#define MOD 10000\n#define LL long long\nLL n,p[N],e,s=1,a,k1=1,k2=1,b;\nLL qow(LL x,LL y){return y?(y&1?x*qow(x,y-1)%MOD:qow(x*x%MOD,y/2)):1;}\nint main()\n{\n\tscanf(\"%lld\",&n);\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%lld%lld\",&p[i],&e);\n\t\ts=(s*qow(p[i],e))%MOD;\n\t\tif(p[i]&1)k1=k1*p[i]%(2*MOD);\n\t\tif(p[i]&1)k2=k2*(2*MOD+2-p[i])%(2*MOD);\n\t}\n\ta=((k1+k2)/2+MOD)%MOD,b=k1+MOD-a;\n\tprintf(\"%lld\\n%lld\\n%lld\\n\",(a-1)%MOD,b%MOD,((s-a-b)%MOD+MOD)%MOD);\n}\n```\n\n\u53ef\u4ee5\u53d1\u73b0\u6211\u5728\u8ba1\u7b97 $k1$ \u548c $k2$ \u7684\u65f6\u5019\u662f\u5bf9 $20000$ \u800c\u4e0d\u662f $10000$ \u53d6\u6a21\uff0c\u8fd9\u662f\u56e0\u4e3a\u5982\u679c\u5bf9\u540e\u8005\u53d6\u6a21\uff0c\u7531\u4e8e\u5728\u8ba1\u7b97\u7b54\u6848\u65f6\u6709\u4e00\u4e2a $/2$ \uff0c\u6240\u4ee5\u4f1a\u7b97\u51fa\u7b54\u6848\u6a21 $5000$ \u7684\u503c\uff0c\u6240\u4ee5\u8981\u9884\u5148\u5bf9\u6a21\u6570\u4e58\u4e8c\u3002",
        "postTime": 1643022982,
        "uid": 4672,
        "name": "DeaphetS",
        "ccfLevel": 3,
        "title": "[P5746 \u673a\u5668\u4ebaM\u53f7]\u7eaf\u6570\u5b66\u505a\u6cd5"
    },
    {
        "content": "## \u601d\u8def\n\u8bfb\u5b8c\u4e00\u904d\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff1a\u82e5\u673a\u5668\u4eba $u$ \u4e3a\u673a\u5668\u4eba $v$ \u7684\u8001\u5e08\uff0c\u90a3\u4e48\u663e\u7136 $u|v$ \u4e14 $u\\not=1$\u3002\u53c8\u4ece $u\\not=1$ \u53ef\u4ee5\u5f97\u5230\u673a\u5668\u4eba $u$ \u7684\u72ec\u7acb\u6570\u4e3a $\u03c6(u)$\u3002\n\n\u4ece\u9898\u76ee\u4e2d\u53ef\u4ee5\u77e5\u9053\uff0c\u653f\u5ba2\u548c\u519b\u4eba\u662f\u7531\u51e0\u4e2a\u4e0d\u540c\u7684\u7684\u5947\u7d20\u6570\u4e58\u8d77\u6765\u5f97\u5230\uff0c\u76f4\u63a5\u7528 dp \u5373\u53ef\u3002\n\n### \u72b6\u6001\n\n$dp_{i,j}$ \u4e3a\u524d $i$ \u4e2a\u8d28\u6570\u4e2d\uff0c\u9009\u5947\u6570\u6216\u5076\u6570\u4e2a\u8d28\u6570\u7684\u7b54\u6848\u3002\u5176\u4e2d $j=0$ \u65f6\u9009\u5076\u6570\u4e2a\uff0c$j=1$ \u65f6\u9009\u5947\u6570\u4e2a\u3002\n\n### \u8f6c\u79fb\u65b9\u7a0b\n\n$dp_{i,j}=dp_{i-1,j\u22951}\\times\u03c6(P_i)+dp_{i-1,j}$\u3002\n\n\u5b66\u8005\u7684\u72ec\u7acb\u6570\u600e\u4e48\u6c42\u5462\uff1f\n\n\u6211\u4eec\u53ea\u9700\u8981\u7528\u603b\u7684\u72ec\u7acb\u6570\u51cf\u53bb\u4e0a\u9762\u6c42\u7684\u653f\u5ba2\u548c\u519b\u4eba\u7684\u72ec\u7acb\u6570\u5373\u53ef\u3002\n\n\u603b\u7684\u72ec\u7acb\u6570\u53c8\u8be5\u600e\u4e48\u6c42\uff1f\n\n\u663e\u7136\uff0c\u7531\u4e8e $\\sum_{d|n}\u03c6(d)=n$\uff0c\u6240\u4ee5\u603b\u7684\u72ec\u7acb\u6570\u5fc5\u4e3a $m-1$\u3002\n\n## code\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define int __int128\ntemplate <typename T> inline void read(T& x) {\n\tx=0;T f=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9') {if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9')x=(x<<1)+(x<<3)+(ch^48),ch=getchar();\n\tx=x*f;\n\treturn;\n}\ntemplate <typename T,typename ...Arg>void read(T& x,Arg& ...arg){\n\tread(x);\n\tread(arg...);\n}\ntemplate <typename T>inline void write(T x) {\n\tif(x<0)putchar('-'),x=-x;\n\tif(x<10)putchar(x+'0');\n\telse write(x/10),putchar(x%10+'0');\n}\nconst int mod=10000;\nint n,tot,dp[1005][2];\nint power(int x,int p) {\n\tint a=1;\n\twhile(p){\n\t\tif(p%2){\n\t\t\ta=a*x%mod;\n\t\t}\n\t\tx=x*x%mod;\n\t\tp>>=1;\n\t}\n\treturn a;\n}\nsigned main() {\n\tread(n);\n\ttot=dp[0][0]=1;\n\tfor(int i=1;i<=n;i++){\n\t\tint p,e;\n\t\tread(p,e);\n\t\ttot=tot*power(p,e)%mod;\n\t\tdp[i][1]=dp[i-1][1];\n\t\tdp[i][0]=dp[i-1][0];\n\t\tif(p!=2){\n\t\t\tdp[i][1]=((dp[i-1][0]*(p-1))%mod+dp[i][1])%mod;\n\t\t\tdp[i][0]=((dp[i-1][1]*(p-1))%mod+dp[i][0])%mod;\n\t\t}\n\t}\n\tdp[n][0]=(dp[n][0]-1+mod)%mod;\n\twrite(dp[n][0]);putchar('\\n');\n\twrite(dp[n][1]);putchar('\\n');\n\twrite(((tot-dp[n][0]-dp[n][1]-1)%mod+mod)%mod);putchar('\\n');\n}\n```",
        "postTime": 1647447674,
        "uid": 357311,
        "name": "little_cindy",
        "ccfLevel": 6,
        "title": "P5746 [NOI2002] \u673a\u5668\u4ebaM\u53f7 \u9898\u89e3"
    },
    {
        "content": "\u6570\u5b66\u6027\u8d28+DP\n\n\u9996\u5148\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u7f16\u53f7\u4e3ax\u7684\u673a\u5668\u4eba\u7684\u8001\u5e08\u5373\u4e3a\u7f16\u53f7\u4e3ax\u7684\u56e0\u6570\u7684\u673a\u5668\u4eba\uff08\u4e0d\u5305\u62ecx\u548c1\uff09\uff0c\u4e8e\u662f\uff0c\u82e5\u673a\u5668\u4ebay\u4e0ex\u6709\u5171\u540c\u8001\u5e08\uff0c\u5f53\u4e14\u4ec5\u5f53x,y\u4e0d\u4e92\u8d28\uff0c\u56e0\u6b64\u7f16\u53f7\u4e3ax\u7684\u673a\u5668\u4eba\u72ec\u7acb\u6570\u5373\u4e3a\u03c6(x)\u3002\n\n\u63a5\u4e0b\u6765\uff0c\u8003\u8651\u6c42\u51fa\u653f\u5ba2\u548c\u519b\u4eba\u7684\u72ec\u7acb\u6570\u3002\u653f\u5ba2\u548c\u519b\u4eba\u6ee1\u8db3\u4e00\u4e2a\u6027\u8d28\uff0c\u5373\uff1a\u7f16\u53f7x\u7684\u6240\u6709\u8d28\u56e0\u6570\u6307\u6570\u90fd\u4e3a1\u3002\u82e5\u5947\u7d20\u6570y\u4e0ex\u4e92\u8d28\uff0c\u5219\u82e5x\u4e3a\u653f\u5ba2\uff0cxy\u4e3a\u519b\u4eba\uff1b\u82e5x\u4e3a\u519b\u4eba\uff0cxy\u4e3a\u653f\u5ba2\u3002\u5e76\u4e14\uff0cxy\u7684\u72ec\u7acb\u6570\u4e3ax\u7684\u72ec\u7acb\u6570\u4e58y-1\uff08\u6c42\u03c6\u7684\u516c\u5f0f\uff09\u3002\u56e0\u6b64\u53ef\u4ee5\u8003\u8651DP\u6c42\u653f\u5ba2\u548c\u519b\u4eba\u7684\u72ec\u7acb\u6570\u3002\n\n\u6b27\u62c9\u51fd\u6570\u03c6\u6ee1\u8db3\u91cd\u8981\u6027\u8d28\uff0c\u5373x\u7684\u56e0\u6570\u7684\u6b27\u62c9\u51fd\u6570\u4e4b\u548c\u7b49\u4e8ex\uff0c\u56e0\u6b64\u53ea\u9700\u5feb\u901f\u5e42\u6c42m\u7684\u503c\uff0c\u518d\u51cf\u53bb\u653f\u5ba2\u548c\u519b\u4eba\uff0c\u518d\u51cf1\uff08\u7f16\u53f7\u4e3a1\u7684\u673a\u5668\u4eba\u4e0d\u662f\u5176\u4ed6\u673a\u5668\u4eba\u7684\u8001\u5e08\uff09\uff0c\u5373\u53ef\u6c42\u51fa\u5b66\u8005\u3002\n\n\u6ce8\u610f\uff1an=1\u8981\u7279\u5224\uff01\u5426\u5219WA94\u5206\u3002\n\n\u7b80\u6d01\u7684\u4ee3\u7801\uff1a\n```cpp\n#include<cstdio>\nconst int q=10000;\nint p[1009],e[1009],f[1009],g[1009];\nint qp(int a,int b){//\u5feb\u901f\u5e42\n\tint r=1;\n\twhile(b){\n\t\tif(b&1)r=r*a%q;\n\t\ta=a*a%q,b>>=1;\n\t}\n\treturn r;\n}\nint main(){\n\tregister int n,i,s=1;\n\tscanf(\"%d\",&n);\n\tfor(i=1;i<=n;++i)scanf(\"%d%d\",p+i,e+i);\n\tif(n==1){//\u7279\u5224\uff01\n\t\tif(p[1]==2)printf(\"%d\\n%d\\n%d\",0,0,qp(2,e[1]));\n\t\telse printf(\"%d\\n%d\\n%d\",0,p[1]-1,(qp(p[1],e[1])-p[1]+q)%q);\n\t\treturn 0;\n\t}\n\tif(p[1]==2)f[2]=0,g[2]=p[2]-1;else f[2]=(p[1]-1)*(p[2]-1)%q,g[2]=(p[1]+p[2]-2)%q;\n\tfor(i=3;i<=n;++i)f[i]=(f[i-1]+g[i-1]*(p[i]-1))%q,g[i]=((f[i-1]+1)*(p[i]-1)+g[i-1])%q;//DP\uff0cf\u4e3a\u653f\u5ba2\uff0cg\u4e3a\u519b\u4eba\uff0c\u6c42\u519b\u4eba\u65f6\u8981\u628a\u7f16\u53f7p[i]\u7684\u673a\u5668\u4eba\u52a0\u4e0a\n\tfor(i=1;i<=n;++i)s=s*qp(p[i],e[i])%q;//\u6c42\u51fam\n\tprintf(\"%d\\n%d\\n%d\",f[n],g[n],(s+q+q-f[n]-g[n]-1)%q);\n\treturn 0;\n}\n```\n",
        "postTime": 1575559237,
        "uid": 221955,
        "name": "panyf",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5746 \u3010[NOI2002]\u673a\u5668\u4ebaM\u53f7\u3011"
    }
]
[
    {
        "content": "## \u600e\u4e48\u6709\u4eba\u7279\u5224AC\uff0c\u64a4\u6389\u6570\u636e\u4e86\n\n\u5fc3\u7d2f\u3002\u3002\u3002\u7b2c\u4e00\u773c\u770b\u5230\u539f\u6709\u9898\u89e3\u5c31\u89c9\u5f97\u4e0d\u5bf9\u52b2\uff0c\u7136\u540e\u62cd\u3001\u6539\u4e86\u597d\u957f\u65f6\u95f4\n\n-----------------\n\n\u672c\u7bc7\u9898\u89e3\u4e4b\u524d\u7684\u6240\u6709\u9898\u89e3\u4ee3\u7801**\u5747\u4e0d\u5bf9**\n\n\uff08\u6211\u4e00\u4e2a\u4e00\u4e2a\u62d6\u4e0b\u6765\u8bd5\u7684\uff09\n\n\u9519\u8bef\u4e4b\u5904\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\uff1a\n\n- \u4e0d\u5f00long long\uff0c\u5168\u7a0bint\uff0c\u8bfb\u51651e10\u5c31gg\u4e86\n\n- \u4e58\u6cd5\u7206long long\n\n- \u590d\u6742\u5ea6\u4e0d\u5bf9\uff08\u627e\u5faa\u73af\u8282\u7684\uff09\n\n- \u67d0\u4e9b\u60c5\u51b5\u4e0b\u8f93\u51fa0\n\n\u4ee5\u53ca\u4ee3\u7801\u6284\u88ad\u7684\u90a3\u4e48\u660e\u663e\u771f\u7684\u597d\u5417\n\n### \u66b4\u529b\u4ee3\u7801\n\n//\u4e0d\u5b58\u5728n\u8f6e\u4ee5\u540e\u4f1a\u53d8\u6210\u521d\u59cb\u72b6\u6001\u7684\u89c4\u5f8b\uff0c\u53ef\u4ee5\u7528\u8fd9\u4e2a\u8bd5\u4e00\u4e0b\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define MAXN 100009\nint a[MAXN], b[MAXN], n, m;\ninline void refresh() {\n  int *p1 = a + 1, *p2 = a + 1 + (n >> 1), *p = b + 1;\n  for (int i = 1; i <= (n >> 1); ++i) *p++ = *p2++, *p++ = *p1++;\n}\n\nint main() {\n  cin >> n >> m;\n  for(int i = 1; i <= n; ++i) a[i] = i;\n  for(int i = 1; i <= m; ++i) {\n    refresh();\n    for(int i = 1; i <= n; ++i) cout << b[i] << ' ';\n    puts(\"\");\n    swap(a, b);\n  }\n  return 0;\n}\n```\n\n### \u6b63\u89e3\u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll x, y, a, b, n, m, l;\n\ninline ll exgcd(ll a, ll b, ll &x, ll &y) {\n  return !b ? (x = 1, y = 0, a) : (exgcd(b, a % b, y, x), y -= (a / b) * x);\n}\ninline ll mul(ll a, ll b, ll mod) {\n  ll ret = 0;\n  while (b) {\n    if (b & 1) ret = (ret + a) % mod;\n    a = (a + a) % mod;\n    b >>= 1;\n  }\n  return ret % mod;\n}\ninline ll Pow(ll a, ll b, ll mod) {\n  ll ret = 1;\n  while (b) {\n    if (b & 1) ret = mul(ret, a, mod);\n    a = mul(a, a, mod);\n    b >>= 1;\n  }\n  return ret % mod;\n}\n\nint main() {\n  cin >> n >> m >> l;\n  exgcd(2, n + 1, x, y);\n  x = (x % (n + 1) + n + 1) % (n + 1);\n  x = Pow(x, m, n + 1);//\u9006\u5143\u662f\u79ef\u6027\u51fd\u6570\n  cout << mul(l, x, n + 1);\n  return 0;\n}\n```",
        "postTime": 1542351107,
        "uid": 29089,
        "name": "qqvq",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "\u5177\u4f53\u89c1\u535a\u5ba2\u5427\uff08\u6253\u4e2a\u5e7f\u544a\uff09[qwq]\n\u6211\u4eec\u5148\u6309\u6837\u4f8b\u627e\u4e0b\u89c4\u5f8b\uff1a\n\n1,4,2,1\n\n2,1,4,2\n\n3,5,6,3\n\n4,2,1,4\n\n5,6,3,5\n\n6,3,5,6\n\n//\u6bcf\u4e00\u5217\u4ee3\u8868\u4e00\u6b21\u6d17\u724c\u3002\n\n\u6211\u4eec\u53d1\u73b0\u6bcf\u6b21\u7684\u4f4d\u7f6e\u53d8\u5316\u4e3a\u5f53\u524d\u4f4d\u7f6e*2\u518d\u53d6\u4f59\uff08n+1\uff09\uff0c\n\n\u8bbe\u5f53\u524d\u4f4d\u7f6e\u4e3ax\n\n\u90a3\u4e48\u4e0b\u4e00\u6b21\u4f4d\u7f6e\u4e3a2*x%(n+1)\n\n\u4e0bm\u6b21\u4f4d\u7f6e\u4e3a2m*x%(n+1)\n\n\u6211\u4eec\u8981\u6c42\u7684\u5c31\u662f\u6ee1\u8db32m*x\u2261l (mod n+1)\u7684x.\n\n\u90a3\u4e48x\u2261l*(2m)-1(mod n+1)\n\n\u6240\u4ee5\u53ea\u8981\u6c42\u51fa2m\u5728\u6a21n+1\u610f\u4e49\u4e0b\u7684\u9006\u5143\u5c31\u53ef\u4ee5\u6c42\u51fax\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#define mod (n+1)\nusing namespace std;\nint n,l,m,x,y;\nint _pow(int x,int y)\n{\n    int ans=1;\n    for(;y;y>>=1)\n    {\n        if(y&1)\n        ans=(long long)ans*x%(n+1);\n        x=(long long)x*x%(n+1);\n    }\n    return ans%(n+1);\n}\nvoid exgcd(int a,int b)\n{\n    if(b==0)\n    {\n        x=1;\n        y=0;\n        return;\n    }\n    exgcd(b,a%b);\n    x^=y^=x^=y;\n    y-=a/b*x;\n}\nint main()\n{\n    scanf(\"%d%d%d\",&n,&m,&l);\n    int a=_pow(2,m);\n    exgcd(a,n+1);\n    while(x<=0)x+=n+1;\n    if((long long)x*l%(n+1)==0)\n    {\n        cout<<n+1;\n        return 0;\n    }\n    printf(\"%lld\",(long long)x*l%(n+1));\n}\n```",
        "postTime": 1523756453,
        "uid": 27398,
        "name": "_ZZH",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "\u8fd9\u4e00\u9898\u662f\u9006\u5143\u7684\u6a21\u677f\u9898\u3002\n\n------------\n\n\n\u6a21\u8fd0\u7b97\u4e2d\u7684\u52a0\u6cd5\u3001\u51cf\u6cd5\u548c\u4e58\u6cd5\uff0c\u90fd\u53ef\u4ee5\u76f4\u63a5\u7528\u666e\u901a\u8fd0\u7b97\u4e2d\u7684\u52a0\u51cf\u4e58\u4e00\u4e00\u5bf9\u5e94\u3002\u4f46\u662f\uff0c\u9664\u6cd5\u4e0d\u4e00\u6837\u3002\u6a21\u8fd0\u7b97\u4e2d\u7684\u9664\u6cd5\u4f1a\u5f02\u5e38\u5730\u590d\u6742\u3002\uff08\u5f62\u5982$ (a/b) mod P $)\n\u4e3a\u4e86\u7b80\u4fbf\u5316\u6a21\u8fd0\u7b97\u7684\u9664\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u6c42\u4e00\u4e2a\u6570mod P\u7684\u9006\u5143\u3002\u8bbe\u6b32\u6c42\u6570\u4e3aa\uff0c\u5219\u8bb0\u5b83\u7684\u9006\u5143\u4e3a$a^{-1}$\u3002$a(mod P)$\u7684\u9006\u5143\u7b49\u4ef7\u4e3a\u6c42\u65b9\u7a0b$a*a^{-1}\u22611(mod P)$\u3002\u5018\u82e5\u77e5\u9053\u4e00\u4e2a\u6570\u7684\u9006\u5143\uff0c\u5219a/b\u5c31\u53ef\u4ee5\u7b49\u4ef7\u4e3a$a*b^{-1}$\uff0c\u4e8e\u662f\u5c31\u5b9e\u73b0\u4e86\u7b80\u4fbf\u5316\u6a21\u8fd0\u7b97\u4e2d\u7684\u9664\u6cd5\u3002\n\n\u4e3a\u4e86\u6c42\u89e3\u65b9\u7a0b$a*x\u22611(mod P)$\uff0c\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u62d3\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u3002\n\n\u5f15\u74061\uff1a[\u88f4\u8700\u5b9a\u7406](https://baike.baidu.com/item/%E8%A3%B4%E8%9C%80%E5%AE%9A%E7%90%86/5186593)\u3002\u8fd9\u4e00\u5b9a\u7406\u8bf4\u660e\u4e86\uff0c\u5bf9\u4e8e\u4efb\u610f\u7684\u4e00\u7ec4\u6b63\u6574\u6570$(a,b)$\uff0c\u4e00\u5b9a\u5b58\u5728\u81f3\u5c11\u4e00\u7ec4x,y\u4f7f\u5f97\u65b9\u7a0b$gcd(a,b)=a*x+b*y$\uff0c\u5176\u4e2d\u51fd\u6570$gcd$\u8868\u793a\u6c42\u6700\u5927\u516c\u56e0\u6570\u3002\n    \n\n\n\u5728\u8bc1\u660e\u4e86\u6709\u89e3\u4e4b\u540e\uff0c\u6211\u4eec\u9700\u8981\u627e\u5230\u4e00\u79cd\u6c42\u89e3\u7684\u65b9\u6cd5\uff0c\u8fd9\u79cd\u65b9\u6cd5\u88ab\u79f0\u4e3a\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5($Exgcd$)\uff0c\u53ef\u4ee5\u57fa\u4e8e\u8f97\u8f6c\u76f8\u9664\u6cd5\u6765\u7406\u89e3\uff08\u5e76\u4e14\uff0c\u590d\u6742\u5ea6\u4e5f\u7b49\u540c\u4e8e\u8f97\u8f6c\u76f8\u9664\u6cd5\uff09\u7684\u590d\u6742\u5ea6\u3002\n\u5bf9\u4e8e\u4efb\u610f\u7684(a,b)\uff0c\u8003\u8651\u8bbe\n\n$$gcd(a,b)=a*x_{1}+b*y_{1}$$\n\n$$gcd(b, amodb)=b*x_{2}+(amodb)y_{2}$$\n\u5219\u53ef\u4ee5\u8fdb\u884c\u5982\u4e0b\u8bc1\u660e\uff1a\n\n\u5f15\u74062\uff1a\u5bf9\u4e8e\u4efb\u610f\u6b63\u6574\u6570\u5bf9 $(a,b)$ \uff0c\u53ef\u4ee5\u8bc1\u660e$gcd(a,b)=gcd(b,amodb)$\u3002\n\n\u8bbed\u4e3a$gcd(a,b)$\uff0c\u5219\u53ef\u8bbe$a=k_{1}*d$,$b=k_{2}*d$\u3002\u8bbe\n\n$$k_{1}=n*k_{2}+t(t\u2208[0,k_{2}))$$\n\n\u5219\u6709\uff1a\n\n$$a=n*k_{2}*d+t*d$$\n\n\u6545\u6709\uff0c\n\n$$amodb\u2261t*d$$\n\n\u53c8$\u2235$\n\n$$b=k2*d$$\n\n\u4e14\n\n$$(t\u2208[0,k_{2}))$$\n\n\u6545\u53ef\u5f97\n\n$$gcd(b,amodb)=d$$\n\n\u5f97\u8bc1\u3002\n\n\u6545\uff0c\n\n$$a*x_{1}+b*y_{1}=b*x{2}+(amodb)*y_{2}$$\n\n\u6574\u7406\u6709\uff1a\n\n$$a*x_{1}+b*y_{1}=b*x_{2}+(a-[a/b]*b)*y_{2}$$\n\n$$a*x_{1}+b*y_{1}=a*y_{2}+b*(x_{2}-[a/b])*y_{2}$$\n\u7531\u591a\u9879\u5f0f\u5b9a\u7406\u53ef\u5f97\u9012\u5f52\u5f0f\uff1a\n\n$$x_{1}=y_{2}$$\n\n$$y_{1}=(x_{2}-[a/b])*y_{2}$$\n\n\u6545\uff0c\u53ea\u8981\u77e5\u9053\u65b9\u7a0b\uff1a\n\n$$gcd(b,amodb)=a*x_{1}+b*y_{1}$$\n\n\u7684\u89e3\uff0c\u5c31\u53ef\u4ee5\u6c42\u5f97\u65b9\u7a0b\uff1a\n\n$$gcd(b, amodb)=b*x_{2}+(amodb)y_{2}$$\n\n\u7684\u89e3\u3002\n\n\u6613\u77e5\uff0c\u8fd9\u4e00\u9012\u5f52\u65b9\u7a0b\u7ec4\u5728$b=0$\u65f6\u53d6\u5230\u8fb9\u754c\u6761\u4ef6\uff0c\u6b64\u65f6\u6a21$b$\u540c\u4f59\u65e0\u610f\u4e49\u3002\u800c\u6613\u77e5\uff0c\u5f53$b=0$\u65f6\uff0c$gcd(a,b)=a$\uff0c\u65b9\u7a0b$gcd(a,b)=a*x+b*y$\u7684\u89e3\u4e3a\n\n$$x=1,y=0$$\n\n\u6240\u4ee5\u6211\u4eec\u4fbf\u53ef\u4ee5\u5bf9\u65b9\u7a0b\n\n$$gcd(a,b)=a*x+b*y$$\n\n\u9012\u5f52\u6c42\u89e3\u4e86\u3002\n\n\u56de\u5230\u6211\u4eec\u539f\u6765\u7684\u95ee\u9898\u3002\u6211\u4eec\u8981\u6c42a\u7684\u9006\u5143\uff0c\u5b9e\u8d28\u4e0a\u662f\u6c42\u89e3\u65b9\u7a0b\n\n$$a*x\u22611(mod P)$$\n\n\u6211\u4eec\u53c8\u53ef\u4ee5\u5c06\u5b83\u8f6c\u5316\u4e3a\u65b9\u7a0b\uff1a\n\n$$a*x\u2261P*y+1$$\n\n\u5373\n\n$$a*x-P*y\u22611$$;\n\n\u8fd9\u4e00\u5f62\u5f0f\u5f88\u663e\u7136\u4e0e\n\n$$gcd(a,b)=a*x+b*y$$\n\n\u76f8\u540c\u3002\u6545\u53ef\u4ee5\u7528$Exgcd$\u7b97\u6cd5\u6c42\u89e3\u8be5\u4e22\u756a\u56fe\u65b9\u7a0b\uff0c\u5373\u53ef\u7b97\u51fa$x$\u3002\u8be5$x$\u4e3a$a$\u7684\u9006\u5143\u3002\n\u7279\u522b\u5730\uff0c\u5f53\u4e14\u4ec5\u5f53$P$\u4e0e$a$\u4e92\u8d28\u65f6\uff0c\u8be5\u65b9\u7a0b\u6709\u4e14\u4ec5\u6709\u4e00\u7ec4\u89e3\u3002\n\n------------\n\n\u4e3a\u4ec0\u4e48\u8bf4\u8fd9\u4e00\u9898\u548c\u9006\u5143\u6709\u5173\u5462\uff1f\n\u603b\u7ed3\u89c4\u5f8b\u6613\u5f97\uff0c\u5bf9\u4e8e$\u2200x\u2208[1,n]$\u5b58\u5728\u6bcf\u4e00\u6b21\u53d8\u6362\u540e\uff0c\u539f\u5e8f\u53f7\u4e3a$x$\u7684\u5361\u724c\uff0c\u4f1a\u88ab\u7f6e\u6362\u5230$(x*2)mod(n+1)$\u7684\u4f4d\u7f6e\u3002\n\n\u56e0\u6b64\uff0c\u8bbe$m$\u6b21\u53d8\u6362\u540e\uff0c$L$\u6765\u81ea\u4e8e$x$\uff0c\u5219\u6709\u540c\u4f59\u65b9\u7a0b\uff1a\n\n$$(x*2^{m})\u2261L(modP)$$\n\n\u5df2\u77e5$m,L,P$\uff0c\u901a\u8fc7\u9006\u5143\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u6c42\u89e3\u8fd9\u4e2a\u65b9\u7a0b\uff1a\n\n\u5bb9\u6613\u53d8\u6362\u5f97\uff1a\n\n$$(x*2^{m})\u22611*L(modP)$$\n\n\u4e8e\u662f\u5c31\u8f6c\u5316\u4e3a\u5df2\u77e5\u7684\u6c42\u9006\u5143\u95ee\u9898\u3002\n\n------------\n\n\u53e6\u5916\u518d\u8bf4\u4e00\u4e2a\uff0c\u5c31\u662f\u5173\u4e8e\u5de8\u4f6c\u4eec\u4f7f\u7528\u7684\uff1a\n\n```cpp\nx^=y^=x^=y\n```\n\n\u8fd9\u4e2a\u4e1c\u897f\u662f\u7528\u4e8e\u9ad8\u6548\u4ea4\u6362\u53d8\u91cf\u7684\u3002\u5b9e\u9645\u7c7b\u4f3c\u4e8e\n\n$$b=a+b,a=b-a,b=b-a$$\n\n\u8fd9\u6837\u7684\u4e1c\u897f\uff0c\u53ea\u4e0d\u8fc7\u4f4d\u8fd0\u7b97\u7384\u5b66\u64cd\u4f5c\u4e00\u6ce2\u6548\u7387\u66f4\u9ad8\u5f97\u4e86\u3002\n\n\u53e6\uff1a\u4e00\u5f00\u59cb\u6ca1\u641e\u61c2\u8fd9\u4e2a\u73a9\u610f\u513f\u7684\u4f18\u5148\u7ea7\uff0c\u6ca1\u7406\u89e3\uff0c\u4e0d\u8fc7\u6253\u4e2a\u62ec\u53f7\u624b\u7b97\u4e00\u4e0b\u5c31\u5f88\u597d\u7406\u89e3\u4e86\u3002\n\n```cpp\nx^=(y^=(x^=y))\n```\n\n------------\n\n\u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstdio>\nusing namespace std;\n\nint n,m,k;\n\nint pw2(int t){\n    int ans=1;\n    int x=2;\n    while(t){\n        if(t&1){\n            ans=(long long int)ans*x%(n+1);\n        }\n        x=(long long int)x*x%(n+1);\n        t>>=1;\n    }\n    return ans;\n}\n\nvoid exgcd(int a,int b,int &x,int &y){\n    if(!b){\n        x=1,y=0;\n        return;\n    }\n    exgcd(b,a%b,x,y);\n    x^=y^=x^=y;\n    y-=a/b*x;\n}\n\nvoid init(){\n    scanf(\"%d%d%d\",&n,&m,&k);\n    int p=pw2(m);\n    int a,b;\n    exgcd(p,n+1,a,b);\n    while(a<0){\n        a+=n+1;\n    }\n    printf(\"%lld\",(long long)a*k%(n+1));\n}\n\nint main(){\n    init();\n    return 0;\n}\n```\n",
        "postTime": 1530280415,
        "uid": 97512,
        "name": "Smokey_Days",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "\u5148\u6302\u4e2a\u535a\u5ba2[Youngsc](https://youngscc.github.io/)\n\n\u8fd9\u4e2a\u9898\u7684\u8bdd\u66b4\u529b\u662f\u53ef\u4ee5\u8fc7\u53bb\u7684\u800c\u4e14\u8dd1\u5f97\u98de\u5feb\uff0c\u4f46\u662f\u8fd9\u9053\u9898\u8fd9\u4e48\u597d\u4e0d\u7528\u9006\u5143\u505a\u4e00\u4e0b\u771f\u662f\u53ef\u60dc\u4e86\u3002\n\n**\u5bf9\u4e8e\u4e00\u5f20\u724c\u7684\u4f4d\u7f6e\uff0c\u6bcf\u4ea4\u6362\u4e00\u6b21\u5c31\u53d8\u6210\u4e86$(x*2)(mod(n+1))$\n\n\u90a3\u4e48\u7ecf\u8fc7$m$\u6b21\u53d8\u6362\uff0c\u4f4d\u7f6e\u5c31\u5e94\u8be5\u53d8\u6210\u4e86$ (x*2^m)(mod(n+1)) $\n\n\u90a3\u4e48\u4e5f\u5c31\u662f\u8bf4\u5bf9\u4e8e\u7b2c$k$\u5f20\u724c\uff0c\u6ee1\u8db3$x*2^m\u2261k (mod(n+1))$\n\n\u6211\u4eec\u5df2\u77e5$n,m,k$,\u90a3\u4e48\u53ea\u8981\u6c42\u51fa\u6765$(2^m)^{-1}(mod(n+1))$,\u53cd\u63a8\u51fa$x$\u5373\u4e3a\u7b54\u6848\u3002**\n\n\n## \u4ee3\u7801\u5728\u8fd9\u91cc\n\n\n```cpp\n# include <algorithm>\n# include <iostream>\n# include <cstring>\n# include <cstdio>\n# include <cmath>\n# include <queue>\n# define R register\n# define LL long long\n# define N 10010\n\nusing namespace std;\n\nint n,m,k;\n\ntemplate <typename T> inline void in(R T& a){\n    R char c=getchar(); R T x=0,f=1;\n    while(!isdigit(c)) {if(c == '-') f=-1; c=getchar();}\n    while(isdigit(c)) x=(x<<1)+(x<<3)+c-'0',c=getchar();\n    a=x*f;\n}\n\ninline int powe(R int x,R int r){\n    R int ret = 1;\n    while(r){\n        if(r&1) ret = 1LL*ret*x%(n+1); \n        x = 1LL*x*x%(n+1);\n        r>>=1;\n    }\n    return ret;\n}\n\ninline void exgcd(R int a,R int b,R int&x,R int&y){\n    if(b==0){\n        x=1; y=0; return ;\n    }\n    exgcd(b,a%b,x,y);\n    x^=y^=x^=y;\n    y-=a/b*x;\n}\n\nint main(){\n//    freopen(\"gamea.in\",\"r\",stdin);\n//    freopen(\"gamea.out\",\"w\",stdout);\n    in(n),in(m),in(k);\n    R int p = powe(2,m);\n    R int a,b;\n    exgcd(p,n+1,a,b);\n    while(a<0) a+=n+1;\n    printf(\"%lld\",1LL*a*k%(n+1));\n    return 0;\n}\n```",
        "postTime": 1513998920,
        "uid": 36282,
        "name": "Youngsc",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "\u6d17\u724c???\n\n~~\u5410\u69fd\u4e00\u4e0b\u9898\u76ee\u7684\u56fe\u7247\uff0c\u5dee\u70b9\u8bef\u5bfc\u4e86\u6211~~\n\n\u8fd9\u4e48\u9ebb\u70e6\u7684\u9898\u9762\u5f53\u7136\u5148\u6a21\u62df\u5566\u3002\u3002\u3002\n\n\u6253\u8868\u53d1\u73b0\u6bcf\u6b21\u6d17\u724c\u540e\u7b2c $i$ \u5f20\u724c\u4f1a\u8f6c\u79fb\u5230\u7b2c $2*i \\%(n+1)$ \u7684\u4f4d\u7f6e\u4e0a\n\n\u5373\u5728$mod (n+1)$\u610f\u4e49\u4e0b\uff0c$i$ \u548c $2i$ \u662f\u540c\u4f59\u7684\n\nso\uff0c\u53ef\u4ee5\u5217\u51fa\u4e00\u4e2a\u540c\u4f59\u65b9\u7a0b\uff1a\n\n$i * 2^{m} \\equiv l \\qquad(mod (n+1))$\n\n\u518d\u8f6c\u5316\u4e3a\n\n$2^{m} * i + (n+1) * k = l$\n\n$2^{m} * \\frac{i}{l} + (n+1) * \\frac{k}{l} = 1$\n\n\u6b64\u65f6\u5229\u7528$exgcd$\u5b8c\u7f8e\u5730\u7b97\u51fa$\\frac{i}{l}$\uff0c\u4e58\u4e0a$l$\u5373\u53ef\n\n**\u6ce8\u610f\uff1a**\u8303\u56f41e10\uff0c\u5982\u679c\u76f4\u63a5\u4e58\u4f1agg\uff0c\u8981\u7528\u5feb\u901f\u4e58\uff0c\u548c\u5feb\u901f\u5e42\u5dee\u4e0d\u591a\n\n```cpp\n#include <cstdio>\n#include <cctype>\n\nusing namespace std;\n\ntemplate<typename T> inline void read(T &x) {// \u5feb\u8bfb\n\tx = 0; T k = 1; char in = getchar();\n\twhile (!isdigit(in)) { if (in == '-') k = -1; in = getchar(); }\n\twhile (isdigit(in)) x = x * 10 + in - '0', in = getchar();\n\tx *= k;\n}\n\ntypedef long long ll;// \u5f00long long\n\n// \u5feb\u901f\u4e58\ninline ll mul(ll a, ll b, ll p) {\n    // \u5c06\u4e58\u6cd5\u53d8\u4e3a\u52a0\u6cd5\uff0c\u4e8c\u8fdb\u5236\u4f18\u5316\uff0c\u8fb9\u52a0\u8fb9\u6a21\n\tll ans = 0;\n\twhile (b) {\n\t\tif (b & 1)\n\t\t\tans = (ans + a) % p;\n\t\ta = (a + a) % p;\n\t\tb >>= 1;\n\t}\n\treturn ans;\n}\n\n// \u5feb\u901f\u5e42\uff0c\u5176\u5b9e\u53ea\u8981\u5199\u9488\u5bf92\u7684\u6574\u6b21\u5e42\u5c31\u884c\uff0c\u8fd9\u91cc\u72af\u61d2\u3002\u3002\u3002\ninline ll q_pow(ll a, ll b, ll p) {\n\tll ans = 1;\n\twhile (b) {\n\t\tif (b & 1)\n\t\t\tans = mul(ans, a, p) % p;\n\t\ta = mul(a, a, p) % p, b >>= 1;\n\t}\n\treturn ans;\n}\n\n// \u6807\u914d\u6269\u6b27\nvoid exgcd(ll a, ll b, ll &x, ll &y, ll &g) {\n\tif (!b)\n\t\tx = 1, y = 0, g = a;\n\telse {\n\t\texgcd(b, a%b, y, x, g);\n\t\ty -= a / b * x;\n\t}\n}\n\nint main() {\n\tll n, m, l, x, y, g, t;\n\tread(n), read(m), read(l);\n\tt = q_pow(2, m, n+1);// 2\u7684m\u6b21\u5e42\n\texgcd(t, n+1, x, y, g);\n\tx = (x % (n+1) + n+1) % (n+1);// \u6ce8\u610fexgcd\u540e\u89e3\u53ef\u80fd\u4e3a\u8d1f\n\tprintf(\"%lld\\n\", mul(x, l, n+1));// \u4e58\u4e0al\n    return 0;\n}\n```\n\n",
        "postTime": 1565528196,
        "uid": 52243,
        "name": "RenaMoe",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "\u6211\u4eec\u53d1\u73b0\uff0c\u6bcf\u6b21\u6d17\u724c\u65f6\uff0c\u82e5l\u4e3a\u5076\u6570\uff0cl /= 2; \u82e5l\u4e3a\u5947\u6570\uff0c\u5219l = l/2 + n/2 + 1\n\n\u66b4\u529b\u7684\u5faa\u73afm\u6b21\u53ef\u4ee5\u5f9770\u5206\n\n\u6539\u8fdb\uff1a\n\n\u82e5\u53d1\u73b0l\u7ecf\u8fc7x\u6b21\u6d17\u724c\u540e\u53c8\u88ab\u6d17\u56de\u4e86l\u7684\u4f4d\u7f6e\n\n\u6bd4\u5982n = 2, m = 1000000001, l = 1\n\n\u6b64\u65f6x = 2\uff08\u6bcf\u6d17\u724c2\u6b21\u5c31\u56de\u5230\u539f\u70b9\uff09\uff0c\u90a3\u4e48\u6d171000000001\u6b21\u5c31\u76f8\u5f53\u4e8e\u6d17\u4e86\u4e00\u6b21\n\n\u56e0\u6b64\u6211\u4eec\u53ea\u8981\u5f53l\u53c8\u56de\u5230\u539f\u70b9\u65f6\u7528m %= x\u5373\u53ef\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u65e0\uff08bu\uff09\u6cd5\uff08hui\uff09\u8868\u793a\n\n\n\n    \n```cpp\n#include <iostream>\n#define ll long long\nusing namespace std;\nint main(void)\n{\n    ll n, m, l;\n    cin >> n >> m >> l;\n    ll c = l; //\u7528c\u8bb0\u5f55l\u7684\u521d\u59cb\u4f4d\u7f6e\n    n >>= 1; //\u4e0e\u5176\u6bcf\u6b21\u6d17\u724c\u90fd\u7b97n/2\uff0c\u4e0d\u5982\u4e00\u5f00\u59cb\u5c31\u96642\n    for (int i = 1; i <= m; i++) {\n        l = (l % 2) * (n + 1) + (l >> 1); //l\u4e3a\u5076\u6570\u5c31\u96642\uff0c\u4e3a\u5947\u6570\u5c31\u53d8\u6210l/2+n+1\n        if (c == l && i >= 1) { //\u5982\u679cl\u56de\u5230\u4e86\u521d\u59cb\u4f4d\u7f6e\uff08\u5373l == c\uff09\uff0cm %= i\uff08i\u5c31\u76f8\u5f53\u4e8e\u524d\u9762\u7684x\uff09\n            m %= i;\n            i = 0;\n        }// i = 0\u3001m %= i\u540e\u76f8\u5f53\u4e8e\u4ece\u5934\u5f00\u59cb\u4e00\u904d\uff0c\u4f46\u6b21\u6570\u51cf\u5c11\u4e86\u5f88\u591a\n    }\n    cout << l;\n    return 0;\n}\n```",
        "postTime": 1503997297,
        "uid": 47421,
        "name": "star_city",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "\u6211\u662f\u6765\u7ea0\u6b63\u4e00\u4e2a\u4e8b\u7684\u3002\u3002\n\n\u8fd9\u9053\u9898\u597d\u591a\u9898\u89e3\u90fd\u7528\u4e86\u62d3\u5c55\u6b27\u51e0\u91cc\u5f97\uff0c\u5176\u5b9e\u5e76\u4e0d\u7528\n\n\u53d1\u73b0\u6bcf\u6b21\u64cd\u4f5c\u540e\u79fb\u52a8\u7684\u4f4d\u7f6e\u4e3a2^(m)\n\n\u6240\u4ee5\u5982\u679c\u4f4d\u7f6e\u4e3al\u7684\u6570\uff0c\u5728k\u6b21\u64cd\u4f5c\u540e\u4f4d\u7f6e\u4e3a l*(2^(m))mod(n+1)\n\n\u6240\u4ee5\u8fd9\u9053\u9898\u6c42\u7684\u5c31\u662f (x) * (2^(m)) \u540c\u4f59 l mod(n+1)\n\n\u53cd\u63a8\u51fa x \u540c\u4f59 inv[2^(m)]*l mod (n+1)\n\n\u8bf4\u5b9e\u8bdd\u6211\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u8bf8\u4f4d\u795e\u4ed9\u90fd\u8981\u62d3\u5c55\u6b27\u51e0\u91cc\u5f97\u6c422\u7684\u5e42\u6b21\u7684\u9006\u5143\n\n\uff08\u7a9d\u592a\u5f31\u4e86\uff09\n\n\u53cd\u6b63\u6211\u77e5\u9053\u5982\u679cn\u662f\u4e2a\u5076\u6570\uff0c\u90a3\u4e482\u5173\u4e8en+1\u7684\u9006\u5143\u662f(n/2)+1\n\n(\u81ea\u5df1\u4e58\u4e00\u4e0b\u624b\u52a8mod n+1\u8bd5\u4e00\u8bd5)\n\n\u6240\u4ee5\u8fd9\u9053\u9898\u6211\u4eec\u76f4\u63a5\u4e00\u4e2a\u5feb\u901f\u4e58\uff0c\u4e00\u4e2a\u5feb\u901f\u5e42\u5c31\u80fd\u89e3\u51b3\u95ee\u9898\n\n\u6700\u540e\u6c42\u7684x\u5c31\u662f (n/2+1)^m * l\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nll n,m,k;\n\ninline ll qmul(ll a,ll b,ll p)\n{\n\tll base=0;\n\twhile(b)\n\t{\n\t\tif(b&1) base=(base+a)%p;\n\t\ta=(a+a)%p;\n\t\tb>>=1;\n\t}\n\treturn base;\n}\ninline ll qpow(ll a,ll b,ll p)\n{\n\tll base=1;\n\twhile(b)\n\t{\n\t\tif(b&1) base=qmul(base,a,p);\n\t\ta=qmul(a,a,p);\n\t\tb>>=1;\n\t}\n\treturn base;\n}\nint main()\n{\n\tscanf(\"%lld%lld%lld\",&n,&m,&k);\n\tprintf(\"%lld\\n\",qmul(k,qpow(n/2+1,m,n+1),n+1));\n}\n```\n\n\n\n\u6700\u540e\u5982\u679c\u6709\u5565\u5b50\u95ee\u9898\u6293\u7d27\u8054\u7cfb\u6211\uff0c\n\u840c\u65b0\u521a\u5b66OI~~\uff0c\u4e0d\u4f1amarkdown\uff0c\u4e0d\u7406\u89e3\u4e3a\u5565\u8981\u62d3\u5c55\u6b27\u51e0\u91cc\u5f97(\u9003~~",
        "postTime": 1566972047,
        "uid": 118786,
        "name": "2018x5zzt",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "## \u627e\u89c4\u5f8b\n\n\u8fd9\u4e00\u9898\u4e3b\u8981\u662f\u627e\u5230\u89c4\u5f8b\u5c31\u53ef\u4ee5\u4e86\n\n\u6211\u4eec\u628a\u8fd9\u91cc\u628a\u8fd9\u4e00\u53e0\u724c\u5206\u6210\u524d\u540e\u4e24\u4efd\n\n\u5148\u770b\u524d\u9762\u7684\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/p6f9vzh5.png?x-oss-process=image/resize,m_lfit,h_170,w_225)\n\n\u603b\u7ed3\uff1a\n\n\u82e5\u539f\u683c\u5b50\u7f16\u53f7\u4e3a$x$\uff0c\u5219\u540e\u6765\u8fd9\u4e2a\u683c\u5b50\u91cc\u7684\u6570\u5230\u4e86\u7f16\u53f7\u4e3a$2x$\u7684\u683c\u5b50\n\n\u540e\u534a\u90e8\u5206\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/hkrv41f6.png?x-oss-process=image/resize,m_lfit,h_170,w_225)\n\n\u82e5\u539f\u683c\u5b50\u7f16\u53f7\u4e3a$x$\uff0c\u5219\u540e\u6765\u8fd9\u4e2a\u683c\u5b50\u91cc\u7684\u6570\u5230\u4e86\u7f16\u53f7\u4e3a$2x-(n+1)$\u7684\u683c\u5b50\u91cc\n\n\u90a3\u4e48\u7efc\u5408\u8d77\u6765\uff0c\u5373\u4e3a$2x\\;mod\\;(n+1)$\n\n## \u9006\u5143\n\n\u90a3\u4e48\u6211\u4eec\u8981\u6c42\u7684\u6570\u76f8\u5f53\u4e8e\u6d17\u724c$m$\u6b21\u540e\uff0c\u7b2c$l$\u4e2a\u683c\u5b50\u91cc\u7684\u6570\n\n\u8bbe\u8fd9\u4e2a\u6570\u4e3a$x$\n\n\u90a3\u4e48$x*2^m\u2261l(mod\\;n+1)$\n\n\u8bbe$2$\u7684\u9006\u5143\u4e3a$k$\n\n\u90a3\u4e48$x=l*k^m$%$n+1$\n\n\u7136\u540e\u5c31\u6709\u4e86\u6b63\u89e3\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint n,m,l,x,y;\nint exgcd(int a,int b,int &x,int &y){\n    if(b==0){\n        x=1,y=0;\n        return a;\n    }\n    int d=exgcd(b,a%b,x,y);\n    int tmp=x;\n    x=y,y=tmp-a/b*y;\n    return d;\n}\nint qmul(int x,int y,int p){\n\tint tot=0;\n\twhile(y){\n\t\tif(y&1)tot=(tot+x)%p;\n\t\tx=(x+x)%p;\n\t\ty>>=1;\n\t}\n\treturn tot;\n}\nint qpow(int x,int y,int p){\n\tint tot=1;\n\twhile(y){\n\t\tif(y&1)tot=qmul(tot,x,p)%p;\n\t\tx=qmul(x,x,p)%p;\n\t\ty>>=1;\n\t}\n\treturn tot;\n}\nsigned main(){\n\tscanf(\"%lld%lld%lld\",&n,&m,&l),++n;\n\texgcd(2,n,x,y);\n\tx=(x%n+n)%n;\n\tprintf(\"%lld\",qmul(l,qpow(x,m,n),n));\n}\n```\n\n## \u5c0f\u4f18\u5316\n\n\u53c8\u56e0\u4e3a$n+1$\u4e00\u5b9a\u662f\u5076\u6570\n\n\u6240\u4ee5$2$\u5173\u4e8e$n+1$\u7684\u9006\u5143\u4e00\u5b9a\u662f$n/2+1$\u3002~~\u5927\u4f6c\u53ef\u4ee5\u53bb\u8bc1\u4e00\u4e0b~~\n\n\u6240\u4ee5\u5c31\u4e0d\u7528\u6269\u6b27\u6765\u6c42\u89e3\u4e86\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint n,m,l,x,y;\nint exgcd(int a,int b,int &x,int &y){\n    if(b==0){\n        x=1,y=0;\n        return a;\n    }\n    int d=exgcd(b,a%b,x,y);\n    int tmp=x;\n    x=y,y=tmp-a/b*y;\n    return d;\n}\nint qmul(int x,int y,int p){\n\tint tot=0;\n\twhile(y){\n\t\tif(y&1)tot=(tot+x)%p;\n\t\tx=(x+x)%p;\n\t\ty>>=1;\n\t}\n\treturn tot;\n}\nint qpow(int x,int y,int p){\n\tint tot=1;\n\twhile(y){\n\t\tif(y&1)tot=qmul(tot,x,p)%p;\n\t\tx=qmul(x,x,p)%p;\n\t\ty>>=1;\n\t}\n\treturn tot;\n}\nsigned main(){\n\tscanf(\"%lld%lld%lld\",&n,&m,&l),++n;\n\tx=n/2+1;\n\tprintf(\"%lld\",qmul(l,qpow(x,m,n),n));\n}\n```",
        "postTime": 1611663636,
        "uid": 310802,
        "name": "_Diu_",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "\u8fd9\u4e48\u77ed\u7684\u4ee3\u7801\uff0c\u8c03\u4e86\u534a\u5929\uff0c\u6700\u540e\u544a\u8bc9\u6211\u662f\u5feb\u901f\u6a21\u5495\u6389\u4e86\u8bf4...\n\n\u8fd9\u9053\u9898\u53cd\u6b63\u5c31\u662f\u6253\u8868\u627e\u89c4\u5f8b\u7136\u540e\u53d1\u73b0\u5f53\u524d\u7b2c x \u5f20\u724c\u4e0b\u6b21\u51fa\u73b0\u5728 $2*x % (n+1)$ \u5904\uff0c\u7136\u540e\u5c31\u662f\u5404\u79cd\u9a9a\uff0c\u6c42\u51fa\u4e8c\u7684\u9006\u5143\u7136\u540e\u5feb\u901f\u6a21 m \u500d\uff0c\u63a5\u7740\u4e58\u4e0a l \u5c31\u51fa\u89e3\u4e86\u3002\n\n\uff08\u5c31\u662f\u5012\u63a8\u7684\u601d\u8def\u561b\uff09 \u7136\u9e45\u3002\u3002\u3002\n\n\u6ce8\u610f\u5feb\u901f\u6a21\u91cc\u9762\u4e5f\u8981\u7528\u9f9f\u901f\u4e58\u554a\uff01\n\n\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u7528\u5feb\u901f\u4e58\uff08\u4e00\u5f00\u59cb\u8fd8\u4ee5\u4e3a\u6211\u5feb\u901f\u4e58\u5495\u6389\u4e86..\uff09\n\n\u4ee3\u7801\u9644\u4e0a\uff1a\n\n\n```\n//by Judge\n#include<cstdio>\n#include<iostream>\n#define ll long long\n#define ld long double\nusing namespace std;\nll n,m,l,a,mod,x,y;\nvoid ex_gcd(ll a,ll b,ll& x,ll& y){\n\tif(!b) return x=1,y=0,void();\n\tex_gcd(b,a%b,y,x),y-=a/b*x;\n}\ninline ll qmul(ll a,ll b){ ll s=0;\n\tfor(;b;b>>=1,a=(a+a)%mod)\n\t\tif(b&1) s=(s+a)%mod; return s;\n}\ninline ll mul(ll a,ll b){ a%=mod,b%=mod;\n\treturn (ll)(a*b-(ll)(((ld)a*b+0.5)/mod)*mod+mod)%mod;\n}\ninline ll qpow(ll x,ll p){ ll s=1;\n\tfor(;p;p>>=1,x=mul(x,x))\n\t\tif(p&1) s=mul(s,x); return s;\n}\nint main(){\n\tcin>>n>>m>>l,mod=n+1,ex_gcd(2,mod,x,y),\n\tx=(x%mod+mod)%mod,x=qpow(x,m);\n\treturn cout<<mul(l,x)<<endl,0;\n}\n```\n\n\n\u4e0a\u9762\u7684 qmul \u662f\u9f9f\u901f\u4e58\uff0c\u5e76\u6ca1\u6709\u7528\u5230\n",
        "postTime": 1550757683,
        "uid": 38576,
        "name": "J\u03bcdge",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "1. \u6807\u7b7e: \u8f6c\u5316, \u5feb\u901f\u5e42.\n2. \u8bbe$f(i)$\u4e3a\u7b2c$i$\u5f20\u724c\u6d17\u4e00\u6b21\u540e\u7684\u4f4d\u7f6e, \u53d1\u73b0\n\t$$f(i)=i*2\\pmod{N+1}$$\n\t\u6240\u4ee5\u7ecf\u8fc7$M$\u6b21\u6d17\u724c\u540e, \u7b2c$i$\u5f20\u724c\u7684\u4f4d\u7f6e\u4e3a$i*2^M\\pmod{N+1}$, \u56e0\u4e3a$N+1$\u4e3a\u5947\u6570, \u6240\u4ee5$2$\u5728\u6a21$N+1$\u610f\u4e49\u4e0b\u5b58\u5728\u9006\u5143$inv$, \u6240\u4ee5\u7b54\u6848\u5c31\u4e3a\n    $$L*inv^M\\pmod{N+1}$$\n3. \u6ce8\u610f\u8981\u4f7f\u7528\u6162\u901f\u4e58.\n\n```cpp\n#include <iostream>\n#include <cstdio>\nusing namespace std;\nlong long mod;\nlong long mul(long long a, long long b) {\n    long long rt = 0;\n    while (a) {\n        if (a & 1) (rt += b) %= mod;\n        (b += b) %= mod;\n        a >>= 1ll;\n    }\n    return rt;\n}\nlong long fsp(long long base, long long p) {\n    long long rt = 1;\n    while (p) {\n        if (p & 1) rt = mul(rt, base);\n        base = mul(base,base);\n        p >>= 1ll;\n    }\n    return rt;\n}\nint main() {\n    long long n, m, l;\n    scanf(\"%lld%lld%lld\", &n, &m, &l);\n    mod = n + 1;\n    long long tmp = (mod + 1) / 2;\n    printf(\"%lld\\n\", mul(l, fsp(tmp, m)));\n    return 0;\n}\n```\n",
        "postTime": 1550645552,
        "uid": 51237,
        "name": "Kinandra",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "\u6765\u4e2a\u6b63\u5e38\u7684\u6709\u8bc1\u660e\u7684\u9898\u89e3\n\n\u6211\u4eec\u4e0d\u597d\u6765\u8868\u793a\u67d0\u65f6\u523b\u67d0\u4e00\u4e2a\u4f4d\u7f6e\u662f\u54ea\u4e00\u5f20\u724c\uff0c\u4f46\u6211\u4eec\u53ef\u4ee5\u8868\u793a\u67d0\u65f6\u523b\u67d0\u4e00\u5f20\u724c\u5728\u54ea\u4e2a\u4f4d\u7f6e\u3002\n\n\u8bbe\u6570\u5217$\\{a_{i_j}\\}$\u8868\u793a$i$\u53f7\u724c\u7ecf\u8fc7$j$\u6b21\u6d17\u724c\u540e\u7684\u4f4d\u7f6e\uff0c\u6211\u4eec\u8bd5\u7740\u6765\u9012\u63a8\u4e00\u4e0b\n\n\u9996\u5148\uff0c\u5982\u679c\u6b64\u523b\u724c\u5728\u4e0a\u9762\u4e00\u53e0\uff0c\u663e\u7136$a_{i_{j+1}}=2a_{i_j}$\n\n\u63a5\u7740\uff0c\u5982\u679c\u8fd9\u5f20\u724c\u5728\u4e0b\u9762\u4e00\u53e0\uff0c\u90a3\u4e48$a_{i_{j+1}}=2(a_{i_j}-\\frac n2)-1=2a_{i_j}-(n+1)$\uff0c\u5e94\u8be5\u4e5f\u5f88\u597d\u63a8\u51fa\u6765\n\n\u5199\u5728\u4e00\u8d77\uff0c\u89c2\u5bdf\u4e00\u4e0b\n\n$$a_{i_{j+1}}=\\begin{cases}2a_{i_j}\\qquad\\qquad\\ ,a_{i_j}\\leq\\frac n2\\\\2a_{i_j}-(n+1),a_{i_j}>\\frac n2\\end{cases}$$\n\n\u8bf6\uff0c\u4e24\u4e2a\u5f0f\u5b50\u90fd\u6709\u4e00\u4e2a\u7cfb\u6570$2$\u5462\uff01\u90a3\u6211\u4eec\u53ef\u4e0d\u53ef\u4ee5\u628a\u5b83\u770b\u6210\u6a21$n+1$\u610f\u4e49\u4e0b\u7684\u7ed3\u679c\u5462\uff1f\n\n\u4e8e\u662f\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5f97\u5230$a_{i_j}\\equiv2^mi(\\mod n+1)$\uff08$i$\u5c31\u662f$a_{i_0}$\uff09\n\n\u9898\u76ee\u5df2\u7ecf\u77e5\u9053\u4e86$a_{i_j}$\uff0c\u6765\u6c42$i$\uff0c\u4e0d\u5c31\u662f\u4e00\u4e2a\u7ebf\u6027\u540c\u4f59\u4e0d\u5b9a\u65b9\u7a0b\u4e48\uff1fexgcd\u641e\u4e00\u4e0b\u5c31\u597d\u5566\uff01\u56e0\u4e3a$\\gcd(2^m,n+1)=1$\uff0c\u6240\u4ee5\u6839\u672c\u4e0d\u7528\u50cf[\u9752\u86d9\u7684\u7ea6\u4f1a](http://www.cnblogs.com/flashhu/p/9149119.html)\u90a3\u6837\u9ebb\u70e6\u3002\n\n\u770b\u697c\u4e0a\u5927\u4f6c\u7528\u5f02\u6216\u5199swap\uff1f\uff01\u7b2c\u4e00\u6b21\u89c1\u7684\u849f\u84bb\u8868\u793a\u53ea\u80fdOrz\u3002\u7136\u540e\u849f\u84bb\u5c31\u628aexgcd\u8fd9\u4e2a\u51fd\u6570\u6210\u529f\u538b\u7f29\u5230\u4e86\u4e00\u884c\u3002\u3002\u3002\u3002\u3002\u3002\n```cpp\n#include<cstdio>\n#define LL long long\nLL n,m,l,x=1,y;\nLL qpow(LL b,LL k){//\u5feb\u901f\u5e42\u6c422^m\n\tLL a=1;\n\twhile(k){\n\t\tif(k&1)a*=b,a%=n+1;\n\t\tb*=b,b%=n+1;\n\t\tk>>=1;\n\t}\n\treturn a;\n}\nvoid exgcd(LL a,LL b){//\u4e00\u884cexgcd233\n\tif(b)exgcd(b,a%b),(y^=x^=y^=x)-=a/b*x;\n}\nint main(){\n\tscanf(\"%lld%lld%lld\",&n,&m,&l);\n\texgcd(qpow(2,m),n+1);\n\tprintf(\"%lld\\n\",(l*x%(n+1)+n+1)%(n+1));//\u6ce8\u610f\u5316\u6210\u6700\u5c0f\u6b63\u6574\u6570\n\treturn 0;\n}\n```",
        "postTime": 1528378053,
        "uid": 61325,
        "name": "FlashHu",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "\u770b\u5230\u5927\u4f6c\u7528\u5feb\u901f\u4e58\uff0c\u6211\u4e00\u4e2a\u849f\u84bb\u745f\u745f\u6218\u6218\u5162\u5162\uff0c\u4e8e\u662f\u53d1\u4e00\u4e2a\u4e0d\u7528\u5feb\u901f\u4e58\u7684\u9898\u89e3\n\n\u9996\u5148\uff0c\u89c2\u5bdf\u4e00\u4e0b\u724c\u5806\u53d8\u5316\u89c4\u5f8b\uff0c\u4f1a\u53d1\u73b0\u5176\u5b9e\u89c4\u5f8b\u5c31\u662f\uff1a\n\n\u5bf9\u4e8e\u4e00\u4e2a\u4f4d\u7f6ex\uff0c\u5176\u4e0b\u4e00\u4e2a\u4f4d\u7f6e\u4e3ax*2%(n+1)   ~~\uff08\u4f7f\u7528\u5927\u773c\u89c2\u5bdf\u6cd5\uff09~~\n\n\u82e5\u8981\u8bc1\u660e\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u5bf9\u4e8e\u6240\u6709\u6570\uff0c\u90fd\u662f\u6210\u5bf9\u51fa\u73b0\uff0c\u5bf9\u4e8e\u524d\u4e00\u534a\uff0c\u6bcf\u4e00\u6b21\u4f1a\u88ab\u6d17\u5230\u540e\u9762\u7684\u4e00\u4e2a\uff0c\u4e5f\u5c31\u662fx*2=x*2%(n+1);\u5bf9\u4e8e\u540e\u4e00\u534ax\uff0c\u5b83\u662f\u8fd9\u4e00\u534a\u4e2d\u7b2cx-n/2\u4e2a\uff0c\u53c8\u662f\u6210\u5bf9\u51fa\u73b0\uff0c\u6240\u4ee5\u4f1a\u5728\u7b2c2*(x-n/2)-1=2x-n-1\u4e2d\uff0c\u7531\u4e8ex>n/2\uff0c\u6240\u4ee5\u4e5f\u5c31\u662fx*2%(n+1)\n\n\u8bbe\u539f\u4f4d\u7f6e\u4e3ax\uff0c\u7efc\u4e0a\u6240\u8ff0\uff0cx*2^m\u2261l(mod n+1)\n\n\u4e5f\u5c31\u6210\u4e3a\u4e86\u4e00\u9053\u6c42\u9006\u5143\u7684\u9898\n\n\u7531\u4e8en+1\u4e0d\u4e00\u5b9a\u4e3a\u8d28\u6570\uff0c\u6240\u4ee5\u8fd9\u91cc\u4f7f\u7528exgcd\u6c42\n\n\u8bbep=n+1,\u6709ax\u2261l(mod p) --> ax-py=l\n\n\u7528\u6269\u6b27\u6c42\u89e3\u5373\u53ef\n\n\u54a6\uff0c\u548b\u6316\u4e86\uff0c\u89c2\u5bdf\u6570\u636e\uff0c10^10*10^10=10^20 **\u7206longlong\u4e86**\n\n\u548b\u529e\uff0c\u7206int\u548b\u529e\uff1f \u5f00longlong\u554a\n\n\u90a3\u7206longlong\u548b\u529e\uff1f \u5f00__int128\u554a\n\n\u5b83\u6bd4longlong\u518d\u591a\u4e00\u4e2a\u5e73\u65b9\uff0c\u4f46\u4e0d\u652f\u6301\u4e00\u822c\u7684\u8f93\u5165\u8f93\u51fa\uff0c\u6240\u4ee5\u53ea\u80fd\u7528\u5feb\u8bfb\u5feb\u8f93\n\n\u4e8b\u5b9e\u4e0a\uff0cn\uff0cm\uff0cl\u5e76\u4e0d\u7528__int128\uff0c\u6240\u4ee5\u76f4\u63a5cin\u5373\u53ef\n\n\u7531\u4e8e\u9006\u5143*l\u6709\u53ef\u80fd\u7206longlong\uff08#13\uff09\u6240\u4ee5\u8981\u7528\u5feb\u8f93\n\n\u4e0d\u61c2\u5feb\u8bfb\u5feb\u8f93\u7684\u70b9\u8fd9--\u300b[\u5feb\u8bfb\u5feb\u8f93](https://www.luogu.org/blog/shenhy1205/kuai-du-kuai-shu)\n\n\u4e8e\u662f\u7528__int128\u6109\u5feb\u7684\u6c34\u8fc7\u4e86\n\n\n\n------------\n\u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\n#define l7 __int128\nusing namespace std;\nll n,m,l,a,p;\nll ksm(l7\u3000x,ll k) \u3001\u3001\u5feb\u901f\u5e42\n{\n\u3000\u3000l7 ans=1;\n\u3000\u3000while(k)\n\u3000\u3000{\n\u3000\u3000\u3000\u3000if(k&1) ans=ans*x%p;\n\u3000\u3000\u3000\u3000x=x*x%p;\n\u3000\u3000\u3000\u3000k>>=1;\n\u3000\u3000}\n\u3000\u3000return ans;\n}\nvoid exgcd(ll a,ll b,l7 &x,l7 &y) #\u6269\u6b27\n{\n\u3000\u3000if(!b) x=1,y=0;\n\u3000\u3000else exgcd(b,a%b,y,x),y-=a/b*x;\n}\nvoid print(l7 x) \u300a-- \u5feb\u8f93\n{\n\u3000\u3000if(x>9) print(x/10);\n\u3000\u3000putchar(x%10+48);\n}\nint main()\n{\n\u3000\u3000cin>>n>>m>>l;\n\u3000\u3000p=n+1;\n\u3000\u3000a=ksm(2,m);\n\u3000\u3000l7 x,y;\n\u3000\u3000exgcd(a,p,x,y);\n\u3000\u3000x=(x%p+p)%p; //\u9006\u5143\n\u3000\u3000print(x*l%p);\n\u3000\u3000return 0;\n}\u3000\u3000 \n\u3000\u3000\u3000\n```\n",
        "postTime": 1565252761,
        "uid": 11392,
        "name": "shenbear",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "\u5176\u5b9e\u5e76\u4e0d\u9700\u8981\u6269\u6b27\u6c42\u9006\u5143\u3002\n\n2\u5bf9\u4e8e\u4e00\u4e2a\u5947\u6570k\u7684\u9006\u5143\u4e00\u5b9a\u662f$\\frac{k+1}{2}$\n\n\u56e0\u4e3a$2*\\frac{k+1}{2}\u22611(mod$ $(k+1))$\n\n\u601d\u8def\u697c\u4e0b\u90fd\u8bf4\u6e05\u695a\u4e86\uff0c\u6bcf\u4e00\u6b21\u4e582\u6a21(n+1)\n\n\u6240\u4ee5$ans=l*(\\frac{n}{2}+1)^m$ $mod$ $(n+1)$\n\n\u6700\u540e\u6ce8\u610f\u4e00\u4e0b\u7cbe\u5ea6\u5373\u53ef$(10^{20}$\u4e0d\u5728$long$ $long$\u8303\u56f4\u5185$)$\u3002\n\n\u4ee3\u7801\u4e0d\u653e\u4e86",
        "postTime": 1562815578,
        "uid": 118040,
        "name": "\u4ec0\u4e48\u53eb\u4e2d\u4e8c\u5440",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "- \u9898\u76ee\u94fe\u63a5\uff1a\n\n  https://www.luogu.org/problemnew/show/P2054\n  \n  https://www.lydsy.com/JudgeOnline/problem.php?id=1965\n  \n- \u601d\u8def\uff1a\n\n  \u9996\u5148\u4e00\u5f00\u59cb\u6211\u770b\u9519\u9898\u4e86\uff0c\u4f46\u662f\u53d1\u73b0\u4e86\u4e00\u4e9b\u6709\u8da3\u7684\u4e1c\u897f\uff1a\n  \n   ```\n\u6211\u4e00\u5f00\u59cb\u7406\u89e3\u7684\u610f\u601d\uff1a\u7b2cL\u5f20\u6251\u514b\u724c\u7684\u724c\u9762\u5927\u5c0f\u662f\u591a\u5c11\n   ```\n   \n   \u8fd9\u662f\u9898\u76ee\u8981\u6211\u4eec\u6c42\u5f97\uff0c\u7136\u540e\u6211\u770b\u6210\u4e86\u539f\u5e8f\u5217\u4e2d\u7b2cL\u5f20\u6251\u514b\u724c\u7684\u4f4d\u7f6e...\u7136\u540e\u5174\u51b2\u51b2\u5730\u627e\u5230\u4e86\u89c4\u5f8b\uff0c\u6bd4\u8f83\u6709\u8da3: $pos \\equiv (L*2^m) mod (n+1)$,\u5177\u4f53\u600e\u4e48\u8bc1\u6211\u4e0d\u4f1a\uff0c\u53ef\u60dc\u6570\u7ade\u5927\u4f6c\u90fd\u53bb\u96c6\u8bad\u4e86\uff0c\u73b0\u5728\u4e5f\u6ca1\u529e\u6cd5\u3002\n   \n   \u7136\u540e\u6309\u8fd9\u4e2a\u89c4\u5f8b\u4ea4\u4e86\u4e00\u53d1\u53ea\u670910\u5206\uff0c\u624d\u53d1\u73b0\u770b\u9519\u9898\u4e86\u3002\u6211\u4eec\u8981\u6c42\u7684\u662fm\u6b21\u6d17\u724c\u540e\u7b2cL\u5f20\u6251\u514b\u724c\u7684\u724c\u9762\u5927\u5c0f,\u7136\u800c\u521a\u521a\u6211\u4eec\u5df2\u7ecf\u53d1\u73b0\u4e86$pos \\equiv (L*2^m) \\pmod {n+1}$\n   \n   \u4e8e\u662f\u6211\u4eec\u8bbe\u4f4d\u4e8eL\u4f4d\uff0c\u5373\u73b0\u5728\u4f4d\u7f6e\uff08pos\uff09\u5728L\u4e0a\u7684\u724c\u5728\u539f\u5e8f\u5217\u7b2cx\u5f20\uff0c\u6839\u636e\u4e0a\u9762\u89c4\u5f8b\uff1a$(x*2^m) \\equiv L \\pmod {n+1}$ \n   \n   \u6240\u4ee5 $x \\equiv L*{2^m}^{-1} \\pmod {n+1} $\uff0c\u6c42\u51fa$2^m$\u5728\u6a21$(n+1)$\u610f\u4e49\u4e0b\u7684\u9006\u5143\u5373\u53ef\u3002\n   \n- \u5176\u4ed6\uff1a\n\n   \u8fd9\u91cc\u4e0d\u7528$(n+1)$\u4e0d\u4e00\u5b9a\u662f\u8d28\u6570\uff0c\u6240\u4ee5\u6700\u597d\u4e0d\u8981\u7528\u8d39\u9a6c\u5c0f\u5b9a\u7406\u6c42\uff0c\u5426\u5219\u4f60\u53ea\u670940\u5206\uff0c\u7136\u540e\u6211\u4eec\u5c31\u53ea\u80fd\u7528\u62d3\u6b27\u4e86\n   \n   \u540c\u65f6\u6211\u53d1\u73b0\u5f53m\u6ee1\u8db3$2^m \\equiv 1 \\pmod {n+1}$\u65f6\uff0c\u6070\u597d\u53d8\u6210\u6700\u5f00\u59cb\u7684\u5e8f\u5217\uff0c\u7136\u800c\u6211\u8fd8\u662f\u4e0d\u4f1a\u8bc1\u660e\n   \n   \n- \u4ee3\u7801\uff1a\n\n```\n#include <iostream>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <algorithm>\n#include <cctype>\n#define ll long long \nusing namespace std;\nll quick_pow(int a,int b,int c)//a^b%c\n{\n\tif(b==0)return 1;\n\tll x=quick_pow(a,b>>1,c);\n\tx=x*x%c;\n\tif(b&1)x=x*a%c;\n\treturn x; \n}\nvoid ex_gcd(ll a, ll b, ll &x, ll &y, ll &d){\n    if (!b) {d=a,x=1,y=0;}\n    else{\n        ex_gcd(b,a%b,y,x,d);\n        y=y-x*(a/b);\n    }\n    return ;\n}\nll inv(ll t, ll p){\n    ll d,x,y;\n    ex_gcd(t,p,x,y,d);\n    return (x%p+p)%p;\n}\nint main(){\n\tll n,m,l;\n\tcin>>n>>m>>l;\n\tll p=quick_pow(2,m,n+1);\n\tif(p%(n+1)==1){\n\t\tprintf(\"%lld\",l);\n\t}\n\telse{\n\t\tprintf(\"%lld\\n\",(l*inv(p,n+1))%(n+1));\n\t}\n\treturn 0;\n} \n```",
        "postTime": 1525421466,
        "uid": 61382,
        "name": "Rye_Catcher",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "\u4e00\u9053\u597d\u9898\u3002\n\n\u9996\u5148\u662f\u6570\u636e\u8303\u56f4\u3002\n\n\n------------\n\n0\uff1cN\u226410^10 \uff0c0 \u2264M\u226410^10\uff0c\u4e14N\u4e3a\u5076\u6570\n\n\n\n------------\n\u8fd9\u662f\u8fd9\u9053\u9898\u7684\u5751\u70b9\uff0c\u4e5f\u662f\u75db\u70b9\u3002\n\n10^10\u8868\u793a\u8fd9\u8fd9\u9053\u9898\u5fc5\u6709\u89c4\u5f8b\u3002\n\n\u90a3\u4e48\uff0cfirst step\uff0c\u6211\u4eec\u5148\u63a2\u7d22\u89c4\u5f8b\u3002\n\n\u4ee5\u4e0b\u8868\u683c\u4e2d\uff0c\u524dn\u5217\u8868\u793a\u7eb8\u724c\u53d8\u5316\uff0c\u6700\u540e\u4e00\u5217\u8868\u793a1\u7684\u4f4d\u7f6e\u3002\n\n\n------------\n\n1 2 1\n\n2 1 2\n\n1 2 1\n\n\n\n------------\n\n1 2 3 4 1\n\n3 1 4 2 2\n\n4 3 2 1 4\n\n2 4 1 3 3\n\n1 2 3 4 1\n\n\n\n------------\n\n1 2 3 4 5 6 1\n\n4 1 5 2 6 3 2\n\n2 4 6 1 3 5 4\n\n1 2 3 4 5 6 3\n\n\n------------\n\n\u90a3\u4e48\uff0c\u4ece\u4e00\u7684\u4f4d\u7f6e\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\uff0c\n\u5bf9\u4e8e\u5f53\u524d\u4f4d\u7f6en,\u7eb8\u724c\u6570\u91cfa\uff0c\u6765\u8bf4\uff1a\n\n\u82e5n<a/2 n=n*n;\n\n\u82e5n>a/2 n=(n-a/2)*2-1\uff1b\n\n\n\n------------\n\n\u9644\u4e0a\u4ee3\u7801\uff1a\n\n     while(k!=a/2+1)\n    {\n\t  if(k<=a/2)\n\t  {\n\t\t  k=k*2;\n\t\t  o++;\n  \t\t  continue; \n\t  }\n\t  if(k>a/2)\n\t  {\n\t\t  k=(k-a/2)*2-1;\n\t\t  o++;\n\t  \t  continue; \n\t  }\n    }\n    \n------------\n\n\u6709\u4e86\u8fd9\u4e2a\u4ee5\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u76f8\u5f53\u7a0b\u5ea6\u4e0a\u7b80\u5316\u6b64\u95ee\u9898\u3002\n\n\u90a3\u4e48\u7b2c\u4e8c\u6b65\uff0c\u8fd8\u539f\u3002\n\n\u8fd8\u662f\u770b\u4e0a\u8868\u4e2d\u4e00\u7684\u4f4d\u7f6e\n\n1->2->1\n\n1->2->4->3->1\n\n1->2->4->1\n\n\u89c4\u5f8b\u5982\u4e0b\n\n\u5982\u679cn%2==0 n=n/2;\n\nelse n=(n+1)/2+a/2;\n\n\u9644\u4e0a\u4ee3\u7801\uff1a\n\n\n\n------------\n    for(int i=1;i<=b;i++)\n\t{\n\t\tif(c%2==1)\n\t\t{\n\t\t\tc=(c+1)/2+a/2;\n\t\t\tcontinue; \n\t\t}\n\t\tif(c%2==0)\n\t\t{\n\t\t\tc=c/2;\n\t\t\tcontinue;\n\t\t}\n    }\n    \n\n------------\n\n\u7efc\u4e0a\u6240\u8ff0\uff0c\u6b64\u9898\u5b8c\u3002\n\u6c42\u5ba1\u6838\u901a\u8fc7\u3002\n\n\n",
        "postTime": 1520758830,
        "uid": 46816,
        "name": "azihmst",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "\u6211\u4eec\u53d1\u73b0\u7b2cx\u5f20\u724c\u7ecf\u4e00\u6b21\u53d8\u6362\u540e\u4f1a\u6210\u4e3a\u7b2cx/2\u5f20 \uff08x%2==0\uff09\u6216\uff08x+1\uff09/2+n/2\u5f20 (x%2==1\uff09\uff0c\u5e76\u4e14\u4f1a\u6709\u82e5\u5e72\u5faa\u73af\u3002\n\n\u6211\u4eec\u53ea\u8981\u66b4\u529b\u6a21\u62df\u627e\u5230\u7b2cl\u4e2a\u6570\u7684\u5faa\u73af\u8282\u957f\u5ea6\uff0c\u5219\u53d8\u6362m\u6b21\u7b49\u4ef7\u4e8e\u53d8\u6362m%\u5faa\u73af\u8282\u957f\u5ea6\u6b21\uff0c\u518d\u6b21\u66b4\u6a21\u5373\u53ef\u3002\u3002\u3002\n\n```cpp\n#include<cstdio>\nint n,m,l;\nint main()\n{\n    scanf(\"%d%d%d\",&n,&m,&l);\n    int sum=1,x=l&1?((l+1)>>1)+(n>>1):(l>>1);\n    while(x!=l) sum++,x=x&1?((x+1)>>1)+(n>>1):(x>>1);//\u627e\u5faa\u73af\u8282\n    m=m%sum;\n    while(m--) l=l&1?((l+1)>>1)+(n>>1):(l>>1);\u66b4\u529b\u6a21\u62df\n    printf(\"%d\",l);\n    return 0;\n}\n```",
        "postTime": 1506333901,
        "uid": 24337,
        "name": "zhangchengkai",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "- \u9996\u5148\uff0c\u53ef\u4ee5\u53d1\u73b0\uff0c\u4e00\u6b21\u6d17\u724c\uff0c\u5bf9\u4e8e\u4efb\u4f55\u4e00\u4e2a$i<=N/2$\uff0c\u4f1a\u8ba9\u7b2c$i$\u5f20\u724c\u53d8\u6210\u7b2c$i*2$\u5f20\u724c\u3002\u5bf9\u4e8e\u4efb\u4f55\u4e00\u4e2a$i>N/2$\uff0c\u4f1a\u8ba9\u7b2c$i$\u5f20\u724c\u53d8\u6210\u7b2c$(i-N/2)*2-1$\u5f20\u724c\uff0c\u800c$(i-N/2)*2-1=i*2-N/2*2-1=i*2-(N+1)$\u3002\n\n- \u7531\u4e0a\u9762\u7684\u63a8\u5bfc\u5f97\u51fa\uff0c$M$\u6b21\u6d17\u724c\u540e\uff0c\u7b2c$x$\u5f20\u724c\u4f1a\u53d8\u6210\u7b2c$x*2^M \\mod (N+1)$\u5f20\u724c\u3002$2^M \\mod (N+1)$\u7684\u503c\u53ef\u4ee5\u7528\u5feb\u901f\u5e42\u8ba1\u7b97\u3002\n\n- \u800c\u5bf9\u4e8e\u6c42\u89e3\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b$x*2^M\\equiv L(\\mod N+1)$\uff0c\u53ef\u4ee5\u7528\u6269\u6b27\u5b9e\u73b0\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\ntypedef long long ll;\nll n, m, l, rex, rey;\nll qpow(ll a, ll b) {\n    ll res = 1;\n    while (b) {\n        if (b & 1) res = res * a % (n + 1);\n        a = a * a % (n + 1);\n        b >>= 1;\n    }\n    return res;\n}\nll gcd(ll a, ll b) {return b ? gcd(b, a % b) : a;}\nvoid exgcd(ll a, ll b, ll &x, ll &y) {\n    if (b == 0) return (void) (x = 1, y = 0);\n    exgcd(b, a % b, y, x); y -= (a / b) * x;\n}\nint main() {\n    cin >> n >> m >> l; ll c = qpow(2ll, m), g = gcd(c, n + 1);\n    c /= g; (n += 1) /= g; l /= g; exgcd(c, n, rex, rey);\n    rex = (rex % n + n) % n; rex = rex * l % n;\n    cout << rex << endl;\n    return 0;\n}\n```",
        "postTime": 1503475961,
        "uid": 29936,
        "name": "xyz32768",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "\u770b\u5230\u697c\u4e0b\u7684\u9898\u89e3\u90fd\u8fd9\u4e48\u7b80\u6d01\u3002\u3002\u3002\u4e0d\u7981\u60f3\u53d1\u4e00\u4e2a\u770b\u8d77\u6765\u9ad8\u5927\u4e0a\u7684\u9898\u89e3\u3002\u3002\u3002\n\n\u697c\u4e0b\u7684\u60f3\u6cd5\u90fd\u662f\u627e\u5faa\u73af\uff0c\u8fd9\u6837\u7684\u60f3\u6cd5\u80af\u5b9a\u662f\u5bf9\u7684(\u8fd9\u663e\u7136\u662f\u7f6e\u6362\u7fa4\u7684\u7279\u6027)\n\n\u7136\u800c\u5982\u679c\u6570\u5b66\u57fa\u7840\u597d\u7684\u8bdd\uff0c\u5c31\u5b58\u5728\u4e00\u79cd\u66f4\u52a0\u7b80\u5355\uff0c\u7c97\u66b4\uff0c\u65e0\u8111\u7684\u6253\u6cd5\u3002\u3002\u3002\n\n\u9898\u89e3\u5982\u4e0b\uff1a\n\n\u8bbe\u67d0\u5f20\u724c\u5728N\u5f20\u724c\u4e2d\u521d\u59cb\u4f4d\u7f6e\u5728x\uff0c\u90a3\u4e48\u4e00\u6b21\u6d17\u724c\u540e\u4f4d\u7f6e\u5c31\u53d8\u4e3a(2\\*x)%(N+1)\uff1b\n\n\u90a3\u6837\u5c31\u80fd\u5f97\u5230\u65b9\u7a0b\uff1ax\\*(2^M) \u039e L (mod N+1)\n\n\u5176\u4e2d(2^M)\u53ef\u4ee5\u5feb\u901f\u5e42\u53d6\u6a21\uff0c\u4e8e\u662f\u53c8\u5f97\u5230\u65b0\u65b9\u7a0b\uff1ax\\*k \u039e L (mod N+1)\uff1b\n\n\u5176\u4e2dk\u4e3a(2^M)%(N+1)\u7684\u7ed3\u679c\n\n\u73b0\u5728\u7684\u8fd9\u4e2a\u65b9\u7a0b\u5c31\u53ef\u4ee5\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u5f3a\u884c\u653b\u7565\u3002\u3002\u3002\n\n\u4ee3\u7801\n```cpp\n#include<cstdio>\n#define LL long long\nusing namespace std;\nLL d=0,x=0,y=0;\nLL pow(LL a,LL b,LL mod){\n    LL s=1;\n    while(b){\n        if(b&1) s=(s*a)%mod;\n        b>>=1;\n        a=(a*a)%mod;\n    }\n    return s;\n}\nvoid gcd(LL a,LL b,LL &d,LL &x,LL &y){\n    if (b==0){\n        d=a;\n        x=1;\n        y=0;\n        return ;\n    }\n    gcd(b,a%b,d,y,x);\n    y-=a/b*x;\n    return;\n}\nint main(){\n    LL n,m,l,k;\n    scanf(\"%lld%lld%lld\",&n,&m,&l);\n    n++;\n    k=pow(2,m,n);\n    gcd(k,n,d,x,y);\n    while(x<0) x+=n;\n    d=(l/d)*x%n;\n    printf(\"%lld\",d);\n    return 0;\n}\n```",
        "postTime": 1503062433,
        "uid": 46755,
        "name": "Iscream2001",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "\u89c4\u5f8b\u662f\u5bf9\u4e8e\u4f4d\u7f6ex\uff0c\u6bcf\u6b21\u6d17\u724cx\\*=2\uff0c\u5f53x>N\u65f6\uff0cx=x-a-1\u3002\n\n\u75281\u53f7\u724c\u6765\u641c\u7d22\u5faa\u73af\u8282\uff0c\u5373\u8fde\u7eed\u4e24\u6b211\u53f7\u724c\u51fa\u73b0\u5728\u4f4d\u7f6e1\u7684\u65f6\u5019\u3002\u7528M mod = \u5faa\u73af\u8282\uff0c\u7ed3\u679c\u4e0d\u53d8\u3002\n\n\u8ba9\u65f6\u5149\u5012\u6d41\uff0c\u5230\u63a8\u51faL\u7684\u539f\u4f4d\u7f6e\uff0c\u5c31\u53ef\u4ee5\u6c42\u51fa\u7b54\u6848\u3002\n\n\u867d\u7136\u65f6\u95f4\u590d\u6742\u5ea6\u6709\u70b9\u4e0d\u5408\u7406\uff0c\u4f46\u8fd8\u662fAC\u4e86\u3002\n\n\u4e0a\u4ee3\u7801\uff1a\n\n\n```cpp\n#include<cstdio>\nlong long a,b,c,d,e,i;\nint main()\n{\nscanf(\"%lld %lld %lld\",&a,&b,&c);\nd=2;\ne=1;\nwhile(d!=1)\n{\n    d=d*2;\n    if(d>a) d=d-1-a;\n    e=e+1;\n}\nb=b%e;\nfor(i=1;i<=b;i++)\n{\n    if(c%2==0) c/=2;\n    else c=(c+a+1)/2;\n}\nprintf(\"%lld\",c);\nreturn 0;\n}\n```",
        "postTime": 1489808482,
        "uid": 20909,
        "name": "\u9a6c\u5fc5\u8fb0",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "\u7384\u5b66\uff01\n\n\u5148\u5224\u65ad\u4e00\u4e0b\u8fdb\u884cK\u6b21\u4f1a\u56de\u5230\u539f\u6765\u72b6\u6001\uff0c\u7136\u540e\u518d\u628aM mod k\u6700\u540e\u7684\u6570\u636e\u76f4\u63a5\u6a21\u62df\u5373\u53ef\n\n\u5bf9\u4e8e\u5f53\u524d\u4f4d\u7f6e\u4e3ai\uff0c\u4e14\u5076\u6570\uff0c\u5fc5\u5b9a\u4e3a i/2\u8f6c\u79fb\u8fc7\u6765\u7684\n\n\u5bf9\u4e8e\u5f53\u524d\u4f4d\u7f6e\u4e3ai\uff0c\u4e14\u4e3a\u5947\u6570\uff0c\u5fc5\u5b9a\u4e3a i/2+1+n/2 \u8f6c\u79fb\u8fc7\u6765\n\n\u5faa\u73af\u8dd1\u4e00\u8fb9\u5c31\u884c\u4e86~\n\n```cpp\nconst maxn=1000000;\nvar i,j,k:longint;\n    l,n,m:int64;\nprocedure init;\nbegin\n    readln(n,m,l);\n    n:=n div 2;\nend;\nprocedure work;\nvar i,j,k:longint;\nbegin\n    k:=1;i:=2;\n    while i<>1 do\n    begin\n      if i<=n then i:=2*i else\n      if i>n then i:=i-(2*n-i+1);\n      inc(k);\n    end;\n    m:=m mod k;\n    for i:=m downto 1 do\n    begin\n      if(l mod 2=0)then\n      begin\n        l:=l div 2;\n        continue;\n      end;\n      if(l mod 2=1)then l:=(l div 2)+1+n;\n    end;\n    writeln(l);\nend;\nbegin\n    init;\n    work;\nend.\n```",
        "postTime": 1478696630,
        "uid": 20390,
        "name": "lwhllw",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "\u9012\u63a8\u3002\n\n\u627e\u4e00\u627e\u89c4\u5f8b\u5c31\u53ef\u4ee5\u505a\u51fa\u6765\u4e86\u3002\n\n\u5df2\u77e5\u8981\u6c42\u4f4d\u7f6eL\uff0c\u5012\u63a8\u4e0a\u4e00\u8f6e\u4e2d\u8be5\u4f4d\u7f6e\u7eb8\u724c\u6240\u5728\u4f4d\u7f6e\uff0c\u9012\u63a8\u5f0f\uff1a\n\np=(p&1)?((n+p+1)>>1):(p>>1)\uff08\u4ee3\u7801\u4e2d\u7528\u7684\u662ft\uff09\n\n\u5e76\u4e14\uff0c\u4e0d\u96be\u53d1\u73b0\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u662f\u4f1a\u5faa\u73af\u7684\uff0c\u53ea\u8981\u627e\u5230\u5faa\u73af\u8282\u5373\u53ef\u4ee5\u5feb\u901f\u6c42\u89e3\uff0c\u5e76\u4e0d\u9700\u8981\u9012\u63a8M\u6b21\u3002\n\n\u4e0a\u4ee3\u7801\uff1a\n\n\n\n\n```cpp\n#include <iostream>\n#include <vector>\nusing namespace std;\nvector<long long> a;\nint main(){\n    long long n,m,l;\n    cin >> n >> m >> l ;\n    a.push_back(l);\n    bool bo=false;\n    long long t=l;\n    for (long long i=0;i<m;i++){\n        if (t&1){\n            t=(n+t+1)>>1;\n        }\n        else{\n            t>>=1;\n        }\n        if (t==l){\n            bo=true;\n            break;\n        }\n        a.push_back(t);\n    }\n    if (bo){\n        t=m%a.size();\n        cout << a[t] ;\n    }\n    else{\n        cout << t ;\n    }\n    return 0;\n}\n```",
        "postTime": 1478693496,
        "uid": 10507,
        "name": "\u9752\u6625ing",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    },
    {
        "content": "\u6253\u4e86\u4e2a\u8868\u51fa\u6765\uff0c\u5c31\u4f1a\u5f88\u660e\u663e\u7684\u770b\u5230\u8fd9\u9053\u9898\u6709\u5faa\u73af\u8282\uff0c\u4e8e\u662f\u5199\u4e86\u4e2amap\u628a\u5faa\u73af\u8282\u627e\u51fa\u6765mod\u4e86\u5c31\u5b8c\u4e86\n\n\u5f53\u7136\uff0c\u80af\u5b9a\u6709\u6570\u5b66\u8bc1\u660e\uff0c\u5e0c\u671b\u6709\u5927\u795e\u8bc1\u4e00\u8bc1\u3002\n\n\u8fd9\u9053\u9898\u548c1775\u90fd\u6559\u4f1a\u6211\u4eec\u4e00\u4e2a\u9053\u7406\uff0c\u5f53\u4f60\u5199\u4e86\u66b4\u529b\u6ca1\u529e\u6cd5\u4f18\u5316\u7684\u65f6\u5019\uff0c\u4e00\u5b9a\u8981\u6253\u4e2a\u8868\u51fa\u6765\u770b\u770b\uff0c\u8bf4\u4e0d\u5b9a\u5c31\u627e\u51fa\u89c4\u5f8b\u4e86\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<map>\nusing namespace std;\nmap<int,int>g;\nint n,m,l;\nint main()\n{\n    int a,b,c;\n    cin>>n>>m>>l;\n    while(m>0)\n    {\n        m--;\n        if((l&1)==0)(l=l>>1);\n        else l=(l+n)/2+1;\n        if(g.find(l)!=g.end())m=m%(g[l]-m);\n        else g[l]=m;\n    }\n    cout<<l<<\" \";\n}\n```",
        "postTime": 1478525051,
        "uid": 26929,
        "name": "mwyxhh",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2054 \u3010[AHOI2005]\u6d17\u724c\u3011"
    }
]
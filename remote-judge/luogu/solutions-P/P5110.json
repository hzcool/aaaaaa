[
    {
        "content": "\u8fd9\u91cc\u8bb2\u4e00\u79cd\u4e0d\u7528\u751f\u6210\u51fd\u6570\u4ec0\u4e48\u7684\u4e1c\u897f\u6c42\u901a\u9879\u516c\u5f0f\u7684\u65b9\u6cd5\uff1a\u5f85\u5b9a\u7cfb\u6570\u6cd5\n\n\u9996\u5148 $\\Large a_n=233a_{n-1}+666a_{n-2},a_0=0,a_1=1$\n\n\u8bbe$\\Large a_{n+2}+pa_{n+1}=q(a_{n+1}+pa_n)$\n\n\u5219$\\Large p,q$ \u6ee1\u8db3$\\Large q-p=233$  \uff0c $\\Large pq=666$\n\n\u5373$\\Large q^2-233q-666=0$ \n\n\u89e3\u5f97$\\Large q=\\frac{233\\pm\\sqrt{56953}}{2},p=\\frac{-233\\pm\\sqrt{56953}}{2}$ \n\n\u5f53$\\Large q=\\frac{233+\\sqrt{56953}}{2},p=\\frac{-233+\\sqrt{56953}}{2}$ \u65f6\n\n$\\Large a_{n+2}+\\frac{-233+\\sqrt{56953}}{2}a_{n+1}=\\frac{233+\\sqrt{56953}}{2}(a_{n+1}+\\frac{-233+\\sqrt{56953}}{2}a_n)$  \uff08\u2460\u5f0f\uff09\n\n\u8bbe$\\Large b_n=a_{n+1}+\\frac{-233+\\sqrt{56953}}{2}a_n$\n\n\u5219$\\Large b_{n+1}=a_{n+2}+\\frac{-233+\\sqrt{56953}}{2}a_{n+1}$\n\n\u5c06\u4e0a\u4e24\u5f0f\u4ee3\u5165\u2460\u5f0f\u5f97$\\Large b_{n+1}=\\frac{233+\\sqrt{56953}}{2}b_n$\n\n\u4e8e\u662f\u6211\u4eec\u77e5\u9053\u4e86$\\Large \\{b_n\\}$ \u662f\u7b49\u6bd4\u6570\u5217\u3002\n\n\u53c8\u56e0\u4e3a$\\Large b_1=a_2+\\frac{-233+\\sqrt{56953}}{2}a_1=233+\\frac{-233+\\sqrt{56953}}{2}$ \n\n\u6240\u4ee5$\\Large b_n=(\\frac{233+\\sqrt{56953}}{2})^{n-1}(233+\\frac{-233+\\sqrt{56953}}{2})=(\\frac{233+\\sqrt{56953}}{2})^n$\n\n\u6240\u4ee5$\\Large a_{n+1}+\\frac{-233+\\sqrt{56953}}{2}a_n=(\\frac{233+\\sqrt{56953}}{2})^n$ \n\n\u5f53$\\Large q=\\frac{233-\\sqrt{56953}}{2},p=\\frac{-233-\\sqrt{56953}}{2}$ \u65f6\n\n\u540c\u7406\u5f97\u5230$\\Large a_{n+1}+\\frac{-233-\\sqrt{56953}}{2}a_n=(\\frac{233-\\sqrt{56953}}{2})^n$ \n\n\u4e0a\u4e24\u5f0f\u76f8\u51cf\u5c31\u53ef\u4ee5\u5f97\u5230$\\Large \\sqrt{56953}a_n=(\\frac{233+\\sqrt{56953}}{2})^n-(\\frac{233-\\sqrt{56953}}{2})^n$\n\n$\\Large a_n=\\frac{(\\frac{233+\\sqrt{56953}}{2})^n-(\\frac{233-\\sqrt{56953}}{2})^n}{\\sqrt{56953}}$\n\n\u8fd9\u5c31\u5df2\u7ecf\u662f\u8fd9\u4e2a\u6570\u5217\u7684\u901a\u9879\u516c\u5f0f\u4e86\u3002\n\n\u4f46\u662f\u6211\u4eec\u53ea\u9700\u8981\u6c42\u8fd9\u4e2a\u6570\u5217\u5728\u6a21$\\Large 10^9+7$\u610f\u4e49\u4e0b\u7684\u503c\uff0c\u56e0\u6b64\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u63a8\u3002\n\n\u6211\u4eec\u8981\u6c42$\\Large \\sqrt{56953}$ \u5728\u6a21$\\Large 10^9+7$\u610f\u4e49\u4e0b\u7684\u503c\uff0c\u5c31\u662f\u8981\u627e\u5230\u6ee1\u8db3$\\Large x^2 \\equiv 56953 (\\mod 10^9+7)$\u7684$\\Large x$ \u3002\u7136\u540e\u6211\u4eec\u53d1\u73b0\u51fa\u9898\u4eba\u9009\u6570\u9009\u5f97\u521a\u521a\u597d\uff0c\u6211\u4eec\u627e\u5230\u4e86$\\Large 188305837^2 \\equiv 56953 (\\mod 10^9+7)$ \u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u63a8\u51fa$\\Large a_n \\equiv \\frac{(\\frac{233+188305837}{2})^n-(\\frac{233-188305837}{2})^n}{188305837}  (\\mod 10^9+7)$\n\n\u6700\u540e\u5f97\u5230$\\Large a_n=233230706(94153035^n-905847205^n) (\\mod 10^9+7)$\n\n\u5b8c\u7f8e\uff01\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u7528\u5149\u901f\u5e42\u6bcf\u6b21$O(1)$ \u6c42\u7b54\u6848\u4e86\u3002",
        "postTime": 1545540077,
        "uid": 34886,
        "name": "ezoixx130",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P5110 \u3010\u5757\u901f\u9012\u63a8\u3011"
    },
    {
        "content": "\u8fd9\u91cc\u7ed9\u51fa\u4e00\u79cd\u4f7f\u7528\u7279\u5f81\u65b9\u7a0b\u89e3\u6b64\u9898\u7684\u65b9\u6cd5\n\n**Warning: \u5927\u6ce2\u516c\u5f0f\u8b66\u544a**\n\n----\n\n$a_n=233a_{n-1}+666a_{n-2}$\u7684\u7279\u5f81\u65b9\u7a0b\u4e3a\n\n$$x^2=233x+666$$\n\n$$x^2-233x+666=0$$\n\n$$x_1=\\frac{233+\\sqrt{56953}}2,x_2=\\frac{233-\\sqrt{56953}}2$$\n\n$$\\therefore a_n=\\alpha x_1^n+\\beta x_2^n$$\n\n$$\\because a_0=0,a_1=1$$\n\n$$\\therefore \\begin{cases} \\alpha+\\beta=0\\\\ \\alpha x_1+\\beta x_2=1 \\end{cases}$$\n\n$$\\therefore \\begin{cases} \\alpha=\\frac1{\\sqrt{56953}} \\\\ \\beta=-\\frac1{\\sqrt{56953}} \\end{cases}$$\n\n$$\\therefore a_n=\\frac1{\\sqrt{56953}}\\left(\\left(\\frac{233+\\sqrt{56953}}2\\right)^n-\\left(\\frac{233-\\sqrt{56953}}2\\right)^n\\right)$$\n$$\\because 188305837 \\equiv \\sqrt{56953} \\; (\\text{mod}\\;10^9+7)$$\n$$\\therefore a_n \\equiv 233230706 \\times\\left(94153035^n-905847205^n\\right)$$\n\n\u6c42\u91cc\u9762\u4e24\u4e2a\u5e95\u6570\u7684$n$\u6b21\u65b9\u5982\u4f55$O(1)$\u6c42\uff1f~~\u5206\u6bb5\u6253\u8868~~\n\n\u8bbe$f_1(n)=x^{65536n},f_2(n)=x^n$\n\n\u5219\uff1a\n\n$$ x^n=f_1(n/65536)\\times f_2(n\\%65536) $$\n\n\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u590d\u6742\u5ea6$\\text{O}(T)$\uff0c$T$\u662f\u8be2\u95ee\u6b21\u6570\n\n### \u4ee3\u7801\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<cctype>\n#include<algorithm>\n#define RG register\n\nnamespace Maker\n{\n    unsigned long long SA, SB, SC;\n    void init() { scanf(\"%llu%llu%llu\", &SA, &SB, &SC); }\n    inline unsigned long long rand()\n    {\n        SA ^= SA << 32, SA ^= SA >> 13, SA ^= SA << 1;\n        unsigned long long t = SA;\n        SA = SB, SB = SC, SC ^= t ^ SA;\n\t\treturn SC;\n    }\n}\n\nconst int Mod(1e9 + 7), alpha(233230706), x_1(94153035),\n\t  x_2(905847205), x_3(64353223), x_4(847809841);\nconst int maxn(65536 + 5);\nint f_1[maxn], f_2[maxn], f_3[maxn], f_4[maxn], T, ans;\n\ninline int Pow_1(int x) { return 1ll * f_3[x >> 16] * f_1[x & 65535] % Mod; }\ninline int Pow_2(int x) { return 1ll * f_4[x >> 16] * f_2[x & 65535] % Mod; }\n\nint main()\n{\n\tf_1[0] = f_2[0] = f_3[0] = f_4[0] = 1;\n\tfor(RG int i = 1; i < 65536; i++) f_1[i] = 1ll * f_1[i - 1] * x_1 % Mod;\n\tfor(RG int i = 1; i < 65536; i++) f_2[i] = 1ll * f_2[i - 1] * x_2 % Mod;\n\tfor(RG int i = 1; i < 65536; i++) f_3[i] = 1ll * f_3[i - 1] * x_3 % Mod;\n\tfor(RG int i = 1; i < 65536; i++) f_4[i] = 1ll * f_4[i - 1] * x_4 % Mod;\n\tscanf(\"%d\", &T); Maker::init(); unsigned long long n;\n\twhile(T--) n = Maker::rand() % (Mod - 1),\n\t\tans ^= 1ll * alpha * (Pow_1(n) - Pow_2(n) + Mod) % Mod;\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1546915931,
        "uid": 46800,
        "name": "xgzc",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5110 \u3010\u5757\u901f\u9012\u63a8\u3011"
    },
    {
        "content": "\n\n[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5110)\n\n\u53c8\u662f\u4e00\u9053\u5e38\u7cfb\u6570\u7ebf\u6027\u9012\u63a8\u7684\u9898\uff0c\u4e00\u4e0b\u5b50\u4fbf\u80fd\u60f3\u5230\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u4f46\u4e00\u770b\u6570\u636e\u89c4\u6a21\n\n$$\n1\u2264T\u22645\u00d710^7\n$$\n\n\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff0c\u666e\u901a\u7684\u77e9\u9635\u5feb\u901f\u5e42\u80af\u5b9a\u662f\u8fc7\u4e0d\u4e86\u7684\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/q9wyuevj.png)\n\n\u663e\u7136\uff0c\u672c\u9898\u53ea\u80fd\u63a5\u53d7$O(T)$\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u65b9\u6cd5~~(LYT:?)~~ \n\n\u8003\u8651\u5149\u901f\u5e42\n\n> \u5bf9\u4e8e$x^y=(x^b)^{\\lfloor\\frac{y}{b}\\rfloor}x^{y\\%b}$,,\u6211\u4eec\u9884\u5904\u7406\u51fa$x^n(n<b)$,\u518d\u9884\u5904\u7406\u51fa$(x^b)^n$\uff0c\u4ee4$b=a^k(k\\in (0,1))$,\u5219\u9884\u5904\u7406\u65f6\u7a7a\u590d\u6742\u5ea6\u4e3a$O(b+\\frac{y}{b})$,\u5355\u6b21\u67e5\u8be2$O(1)$\u3002\n>\n> \u66f4\u4e00\u822c\u7684,$x^y=x^{a_0}(x^b)^{a_1}(x^{b^2})^{a_2}\\cdots\\Rightarrow y=a_0+a_1b+a_2b^2+a_3b^3\\cdots$,\u5c31\u662f\u5c06$y$\u8fdb\u884c$b$\u8fdb\u5236\u5206\u89e3,\u5bf9\u6bcf\u4e00\u4f4d\u8fdb\u884c\u9884\u5904\u7406\uff0c\u4ee4$b=a^k(k\\in (0,1))$ \u9884\u5904\u7406\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a$O(b=a^k)$,\u67e5\u8be2\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(\\frac{1}{k})$.\n\n\n\n## 1.\u77e9\u9635\u5149\u901f\u5e42\n\n\u4f46\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0,\u56e0\u4e3a$a_i< 2^{64}$,\u6240\u4ee5$k=0.25$\uff0c\u5bf9\u4e8e$5*10^7$,\u54ea\u6015\u5904\u7406\u4e86\u5149\u901f\u5e42\uff0c$3$\u6b21\u77e9\u9635\u4e58\u6cd5(\u7ea6$30$\u7684\u5e38\u6570)\u4e5f\u662f\u96be\u4ee5\u901a\u8fc7\u7684\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/q9wyuevj.png)\n\n\n\n## 2.\u7279\u5f81\u591a\u9879\u5f0f\uff1f\n\n\u6211\u4e0d\u4f1a\uff0c\u8fd9\u91cc\u63a8\u8350\u4e00\u4e2a\u5927\u4f6c\u7684\u535a\u5ba2\uff1a[\u3010\u5b66\u4e60\u7b14\u8bb0\u3011\u7279\u5f81\u591a\u9879\u5f0f](https://blog.csdn.net/qq_42101694/article/details/103811029?ops_request_misc=%25257B%252522request%25255Fid%252522%25253A%252522160871670716780273390997%252522%25252C%252522scm%252522%25253A%25252220140713.130102334.pc%25255Fblog.%252522%25257D&request_id=160871670716780273390997&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v1~rank_blog_v1-1-103811029.pc_v1_rank_blog_v1&utm_term=%E5%AD%A6%E4%B9%A0)\n\n\u4f46$3$\u6b21\u591a\u9879\u5f0f\u4e58\u6cd5(\u7ea6$15$\u7684\u5e38\u6570)\u4f9d\u7136\u96be\u4ee5\u901a\u8fc7\n\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/q9wyuevj.png)\n\n\n\n## 3.\u4f7f\u7528\u751f\u6210\u51fd\u6570\u89e3\u51fa\u8be5\u5f0f\u901a\u89e3\n\n\u5148\u63a8\u5bfc\u4e00\u4e9b\u751f\u6210\u51fd\u6570\u5bf9\u5e94\u7684\u51fd\u6570\n\n\n$$\n\\begin{aligned}\n&\\frac{1}{1-ax}=g\\\\\n&1=g-axg\\\\\n&axg+1=g\\\\\n&g_0=1,g_{n+1}=ag_n\\\\\n\\end{aligned}\n$$\n\n$$\n\\begin{aligned}\n&\\frac{1}{a-x}=g\\\\\n&1=ag-gx\\\\\n&g=\\frac{1+gx}{a}\\\\\n&g_0=\\frac{1}{a},g_{n+1}=\\frac{g_n}{a}\n\\end{aligned}\n$$\n\n\n\n\u8fdb\u5165\u6b63\u9898\n\n\n$$\na_n=233a_{n-1}+666a_{n-2},a_0=0,a_1=1\n$$\n\u6211\u4eec\u8bbe\u51fd\u6570g\u4e3a\u5e8f\u5217a\u7684\u751f\u6210\u51fd\u6570\n\u5219\u6709:\n$$\n\\begin{aligned}\n&233xg+666x^2g+x=g\\\\\n\\Leftrightarrow &g=\\frac{x}{1-233x-666x^2}\\\\\n\\Leftrightarrow &g=-x\\left(\\frac{1}{666x^2+233x-1}\\right)\\\\\n\\Leftrightarrow &-\\frac{g}{x}=\\frac{1}{666(x-\\frac{-233+\\sqrt{56953}}{1332})(x-\\frac{-233-\\sqrt{56953}}{1332})}\\\\\n\\Leftrightarrow &-\\frac{666g}{x}=\\frac{1}{(x-\\frac{-233+\\sqrt{56953}}{1332})(x-\\frac{-233-\\sqrt{56953}}{1332})}\\\\\n\\Leftrightarrow &-\\frac{666g}{x}=\\frac{\\frac{1}{x-\\frac{-233+\\sqrt{56953}}{1332}}-\\frac{1}{x-\\frac{-233-\\sqrt{56953}}{1332}}}{\\frac{\\sqrt{56953}}{666}}\\\\\n\\Leftrightarrow &\\frac{g}{x}=\\frac{\\frac{1}{\\frac{-233+\\sqrt{56953}}{1332}-x}-\\frac{1}{\\frac{-233-\\sqrt{56953}}{1332}-x}}{\\sqrt{56953}}\\\\\n&a_n=\\frac{\\left(\\frac{233+\\sqrt{56953}}{2}\\right)^n-\\left(\\frac{233-\\sqrt{56953}}{2}\\right)^n}{\\sqrt{56953}}\n\\end{aligned}\n$$\n\n\n\n\u8fd9\u91cc\u8865\u5145\u4e00\u4e0b\u6700\u540e\u4e00\u6b65\u7684\u63a8\u5bfc\n\n$$\n\\begin{aligned}\n&set\\ a=\\frac{-233+\\sqrt{56953}}{1332} \\\\\n&\\Rightarrow \\frac{1}{a}=\\frac{233+\\sqrt{56953}}{2}\\\\\n&\\frac{1}{\\frac{-233+\\sqrt{56953}}{1332}-x}\\\\\n&=\\sum_{i=0}^{+\\infty}\\frac{x^i}{a^{i+1}}\\\\\n&set\\ b=\\frac{-233-\\sqrt{56953}}{1332} \\\\\n&\\Rightarrow \\frac{1}{b}=\\frac{233-\\sqrt{56953}}{2}\\\\\n&\\frac{1}{\\frac{-233-\\sqrt{56953}}{1332}-x}\\\\\n&=\\sum_{i=0}^{+\\infty}\\frac{x^i}{b^{i+1}}\n\\end{aligned}\n$$\n\n\n\u5230\u4e86\u8fd9\u4e00\u6b65\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7$2$\u79cd\u65b9\u5f0f\u6765\u89e3\u51b3\n\n\n\n### \u2160.\u6269\u57df\n\n\u53ef\u4ee5\u770b\u51fa\uff0c\u4e0a\u5f0f\u4e2d\u51fa\u73b0\u4e86\u65e0\u7406\u6570\uff0c\u4f46\u5728\u6a21\u610f\u4e49\u4e0b\u65e0\u7406\u6570\u662f\u65e0\u610f\u4e49\u7684\uff0c\u56e0\u4e3a\u6a21\u8fd0\u7b97\u662f\u5b9a\u4e49\u5728$L=Z\\cap [0,mod=1000000007)$\u4e0a\u7684\u3002(\u5982\u65e0\u7279\u6b8a\u8bf4\u660e\uff0c\u4e0b\u6587\u4e2d\u56db\u5219\u8fd0\u7b97\u7686\u4e3a\u6a21\u610f\u4e49\u4e0b)\n\n\u6211\u4eec\u4e0d\u59a8\u5b9a\u4e49\u57df$K=(\\{a+b\\sqrt{56953}|a,b\\in L\\},+,*,-)$\n\n#### \u8bc1\u660e$K$\u4e3a$L$\u7684\u6269\u57df\n\n- \u5c01\u95ed\u6027\n\n $ (a+b\\sqrt{56953})(c+d\\sqrt{56953})=(ac+56953bd)+(ad+bc)\\sqrt{56953}\\in K$\n\n- \u5b58\u5728$+,*$\n\n  \u663e\u7136\n\n\u4e4b\u540e\u5c31\u53ef\u4ee5\u50cf\u590d\u6570\u8fd0\u7b97\u4e00\u6837\u64cd\u4f5c\u4e86\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n# define ll long long\n# define read read1<ll>()\n# define Type template<typename T>\n# define fre(k) freopen(k\".in\",\"r\",stdin);freopen(k\".out\",\"w\",stdout)\nType T read1(){\n\tT t=0;\n\tchar k;\n\tbool vis=0;\n\tdo (k=getchar())=='-'&&(vis=1);while('0'>k||k>'9');\n\twhile('0'<=k&&k<='9')t=(t<<3)+(t<<1)+(k^'0'),k=getchar();\n\treturn vis?-t:t;\n}\nnamespace Mker\n{\n\tunsigned long long SA,SB,SC;\n\tvoid init(){scanf(\"%llu%llu%llu\",&SA,&SB,&SC);}\n\tunsigned long long rand()\n\t{\n\t    SA^=SA<<32,SA^=SA>>13,SA^=SA<<1;\n\t    unsigned long long t=SA;\n\t\tSA=SB,SB=SC,SC^=t^SA;return SC;\n\t}\n}\n# define mod 1000000007\n# define M 32767\n# define N 32768\n# define inv2 500000004ll\nstruct A{\n\tint x,y;\n\tA& operator *=(const A &b){\n\t\tint t=y;\n\t\ty=(1ll*x*b.y+1ll*y*b.x)%mod;\n\t\tx=(1ll*x*b.x+56953ll*t%mod*b.y)%mod;\n\t\treturn *this;\n\t}\n\tA operator *(const A &b){A t=*this;return t*=b;}\n}f[2][N|1],f1[2][N|1],o,p;\nint main(){\n\tint T=read,ans=0;\n\tMker::init();o.x=233*inv2%mod,o.y=inv2;p.x=o.x,p.y=mod-inv2;\n\tf[0][0].x=f1[0][0].x=1;f[1][0].x=f1[1][0].x=1;\n\tfor(int i=1;i<=N;++i)f[0][i]=f[0][i-1]*o,f[1][i]=f[1][i-1]*p;\n\tfor(int i=1;i<=N;++i)f1[0][i]=f1[0][i-1]*f[0][N],f1[1][i]=f1[1][i-1]*f[1][N];\n\twhile(T--){\n\t\tunsigned ll n=Mker::rand()%(mod-1);\n\t\tint w=n>>15&M,t=(1ll*f[0][n&M].x*f1[0][w].y+1ll*f[0][n&M].y*f1[0][w].x-1ll*f[1][n&M].x*f1[1][w].y-1ll*f[1][n&M].y*f1[1][w].x)%mod;\n\t\tif(t<0)t+=mod;ans^=t;\n\t}cout<<ans;\n\treturn 0;\n}\n```\n\n\n\n### \u2161.\u4e8c\u6b21\u5269\u4f59\n\n\u6211\u4eec\u7ecf\u8fc7\u4e8c\u6b21\u5269\u4f59\u53ef\u4ee5\u77e5\u9053\uff0c\u5bf9\u4e8e\u7d20\u6570$mod$\uff0c\u6211\u4eec\u53ef\u4ee5\u627e\u5230\u552f\u4e00\u7684$x$\u6ee1\u8db3$x^2\\equiv 56953 \\mod mod$.\n\n\n\n\u7ecf\u8fc7\u6253\u8868\u53ef\u77e5\uff0c\u5bf9\u4e8e\u672c\u9898\uff0c$188305837 \\equiv 56953 \\mod mod$\n\n\n\n\n\n(\u53ef\u80fd\u4f60\u60f3\u77e5\u9053\n\n> Mker::rand()%(mod-1)\n\n\u662f\u4e3a\u4ec0\u4e48\n\n\n\n\u901a\u8fc7$\u6269\u57df$\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u57df$K$\u662f\u6ee1\u8db3\u57df$L$\u7684\u8fd0\u7b97\u89c4\u5219\u7684\uff0c\u81ea\u7136\u800c\u7136\u6ee1\u8db3\u8d39\u9a6c\u5b9a\u7406\uff0c\u6240\u4ee5\u5728\u6a21\u610f\u4e49\u4e0b$a_n$\u4e0e$a_{n+k(mod-1)}$\u76f8\u7b49",
        "postTime": 1608730471,
        "uid": 108067,
        "name": "\u4e1b\u96e8",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5110 \u3010\u5757\u901f\u9012\u63a8\u3011"
    },
    {
        "content": "\u6ca1\u4eba\u5199\u6b63\u89e3\u51fa\u9898\u4eba\u5f88\u4f24\u5fc3\u554aqwq\u2026\u2026\n\n\u4e3a\u4ec0\u4e48\u5faa\u73af\u8282\u662f$10^9+6$\u554a\uff1f\u56e0\u4e3a\u51fa\u9898\u4eba\u7ed9\u4f60\u51d1\u597d\u4e86\u6a21\u6570\u624d\u662f\u6709\u8fd9\u4e2a\u5faa\u73af\u8282\u7684\n\n\u8003\u8bd5\u65f6\u5019\u4e3a\u4e86\u907f\u514d\u5927\u5bb6\u81ea\u95ed\u6240\u4ee5\u6ca1\u6709\u53bb\u5361\u5206\u6bb5\u77e9\u4e58\u7684\u505a\u6cd5\uff0c\u5176\u5b9e\u5206\u6bb5\u77e9\u4e58\u7684\u7a7a\u95f4\u5360\u7528\u662f\u6807\u7b97\u7684\u4e8c\u500d\uff0c\u6839\u636e\u8fd9\u4e00\u70b9\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5361\u7a7a\u95f4\u7684\u65b9\u5f0f\u6765\u5427\u77e9\u4e58\u5361\u4e0b\u53bb\n\n~~(\u5929\u5450\u4e0a\u9762\u90fd\u662f\u4ec0\u4e48duliu\u4e1c\u897f)~~\n\n__________________\n\n## \u672c\u9898\u9898\u89e3\n\n\u8ba9\u6211\u4eec\u628a\u8fd9\u4e2a\u6570\u5217\u7684\u901a\u9879\u516c\u5f0f\u624b\u73a9\u51fa\u6765\uff0c\u8fd9\u91cc\u7528\u751f\u6210\u51fd\u6570\u7ed9\u51fa\u4e86\u4e00\u79cd\u63a8\u5bfc\uff0c\u5982\u679c\u60a8\u4f1a\u7279\u5f81\u65b9\u7a0b\u53ef\u4ee5\u7528\u7279\u5f81\u65b9\u7a0b\u63a8\n\n\u8bbe\u8fd9\u4e2a\u6570\u5217\u7684\u751f\u6210\u51fd\u6570\u4e3a$G(z)$\n\n$$G(z)=233zG(z)+666z^{2}G(z)+z$$\n\n$$(1-233z-666z^2)G(z)=z$$\n\n$$G(z)=\\frac{z}{1-233z-666z^2}$$\n\n\u8bbe$x_{1},x_{2}$\u4e3a\u65b9\u7a0b$1-233x-666x^2=0$\u7684\u4e24\u4e2a\u6839\n\n$$G(z)=\\frac{z}{-666(x_{1}-z)(x_{2}-z)}$$\n\n$$G(z)=\\frac{z}{-666}\u00d7\\frac{1}{(x_{1}-z)(x_{2}-z)}$$\n\n$$G(z)=\\frac{z}{-666(x_{1}-x_{2})}\u00d7\\frac{x_{1}-z+z-x_{2}}{(x_{1}-z)(x_{2}-z)}$$\n\n$$G(z)=\\frac{z}{-666(x_{1}-x_{2})}\u00d7(\\frac{1}{x_{2}-z}-\\frac{1}{x_{1}-z})$$\n\n$$G(z)=\\frac{1}{-666(x_{1}-x_{2})}\u00d7(\\frac{1}{x_{2}}\u00d7\\frac{z}{1-\\frac{z}{x_{2}}}-\\frac{1}{x_{1}}\u00d7\\frac{z}{1-\\frac{z}{x_{1}}})$$\n\n\u6839\u636e$\\frac{z}{1-\\lambda z}$\u662f\u6570\u5217$0,1,\\lambda^{1},\\lambda^{2},\\lambda^{3}$\u7684\u751f\u6210\u51fd\u6570\u53ef\u77e5\n\n$$a(n)=\\frac{1}{-666(x_{1}-x_{2})}\u00d7((\\frac{1}{x_{2}})^{n}-(\\frac{1}{x_{1}})^{n})$$\n\n\u5c06$$x_{1,2}=\\frac{233\\pm \\sqrt{56953}}{-1332}$$\u5e26\u5165\u5f97\n\n$$a(n)=\\frac{1}{\\sqrt{56953}}((\\frac{233+\\sqrt{56953}}{2})^{n}-(\\frac{233-\\sqrt{56953}}{2})^{n})$$\n\n\u597d\u4e86\u770b\u8d77\u6765\u6211\u4eec\u53d1\u73b0\u901a\u9879\u516c\u5f0f\u91cc\u9762\u6709\u4e00\u4e2a$\\sqrt{56953}$\u8fd9\u8be5\u600e\u4e48\u529e\u5462\uff1f\n\n\u901a\u8fc7\u66b4\u529bfor\u5faa\u73af\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u8fd9\u6837\u4e00\u4e2a\u4e8b\u5b9e\n\n$$188305837^2 \\equiv 56953 \\mod 10^9+7$$\n\n\u597d\u4e86\u6b64\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u516c\u5f0f\u91cc\u9762\u7684$\\sqrt{56953}$\u5168\u90e8\u6362\u6210188305837\u5c31\u884c\u4e86\n\n\u73b0\u5728\u6211\u4eec\u5c31\u662f\u8981\u6c42$O(1)$\u7684\u5b9e\u73b0\u5b9a\u5e95\u6570\u7684\u5feb\u901f\u5e42\n\n\u8fd9\u4e2a\u5176\u5b9e\u76f8\u5f53\u7684\u597d\u529e\u6211\u4eec\u5c06\u6bcf\u4e2a\u6570\u5b57\u7684$n$\u6b21\u5e42\u8868\u793a\u6210$32769k+r$\u7684\u5f62\u5f0f\n\n\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u9700\u8981\u6253\u4e24\u4e2a\u8868\uff0c$f1(n)=x^{32768n},f2(n)=x^{n}$\u800c\u4e14\u8fd9\u4e24\u4e2a\u8868\u7684\u957f\u5ea6\u8303\u56f4\u90fd\u662f32768\u4e4b\u5185\u7684\uff0c\u590d\u6742\u5ea6\u53ef\u4ee5\u63a5\u53d7\n\n\u90a3\u4e48\u6b64\u65f6\n\n$$x^{p}=f1(p/32768)f2(p \\mod 32768)$$\n\n\u5c31\u53ef\u4ee5\u652f\u6301$O(1)$\u7684\u5feb\u901f\u5e42\u4e86,\u7531\u4e8e\u8d39\u9a6c\u5c0f\u5b9a\u7406\u7684\u5b58\u5728\u6211\u4eec\u53ef\u4ee5\u5c06\u6307\u6570\u53d6\u4e2a\u819c\u8fd9\u6837\u6307\u6570\u5c31\u662f$10^9$\u7ea7\u522b\u7684\u4e86\n\n\u8fd9\u91cc\u5c06\u5757\u957f\u5b9a\u4e3a32768\u4e3b\u8981\u662f\u9664\u6cd5\u548c\u819c\u6cd5\u90fd\u53ef\u4ee5\u7528\u53f3\u79fb\u8fd0\u7b97\u548c\u6309\u4f4d\u4e0e\u8fd0\u7b97\u6765\u4ee3\u66ff\uff0c\u53ef\u4ee5\u964d\u4f4e\u4e00\u4e9b\u5e38\u6570\n\n\u5982\u6b64\u8fd9\u822c\u6211\u4eec\u5c31\u5c06\u7b97\u6cd5\u7684\u590d\u6742\u5ea6\u7531$O(Tlogn)$\u4f18\u5316\u5230\u4e86$O(T)$\u65e0\u9700\u5361\u5e38\u6570\u5c31\u53ef\u4ee5\u8f7b\u677e\u7684\u901a\u8fc7\u672c\u9898\u5566~\n\n~~\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u5f88\u591a\u4eba\u5b81\u613f\u53bb\u5361\u77e9\u4e58\u7684\u5e38\u4e5f\u4e0d\u613f\u610f\u9759\u4e0b\u5fc3\u6765\u638f\u51fa\u4e00\u652f\u94c5\u7b14\u548c\u4e00\u5f20\u8349\u7a3f\u7eb8\u63a8\u4e2a\u901a\u9879\u516c\u5f0f~~\n\n\u4e0a\u4ee3\u7801~\n\n```C\n#pragma GCC optimize(Ofast)\n#pragma GCC optimize(3)\n#include<cstdio>\n#include<algorithm>\nusing namespace std;typedef long long ll;const ll mod=1e9+7;const ll sqr=188305837;\nnamespace Mker\n{\n    unsigned long long SA,SB,SC;\n    void init(){scanf(\"%llu%llu%llu\",&SA,&SB,&SC);}\n    unsigned long long rand()\n    {\n        SA^=SA<<32,SA^=SA>>13,SA^=SA<<1;\n        unsigned long long t=SA;\n        SA=SB,SB=SC,SC^=t^SA;return SC;\n    }\n}\nconst ll x1=94153035;const ll x2=905847205;const ll K=233230706;\nconst ll x3=64353223;const ll x4=847809841;\nll mi1[65536+10];ll mi2[65536+10];ll mi3[65536+10];ll mi4[65536+10];\ninline ll po(ll a,ll p){ll r=1;for(;p;p>>=1,a=a*a%mod)if(p&1)r=r*a%mod;return r;}\n# define pw1(x) (mi3[x>>16]*mi1[x&65535]%mod)\n# define pw2(x) (mi4[x>>16]*mi2[x&65535]%mod)\nint T;int ans;\nint main()\n{\n    //freopen(\"tst10.in\",\"r\",stdin);freopen(\"tst10.out\",\"w\",stdout);\n    mi1[0]=1;for(int i=1;i<65536;i++)mi1[i]=mi1[i-1]*x1%mod;\n    mi2[0]=1;for(int i=1;i<65536;i++)mi2[i]=mi2[i-1]*x2%mod;\n    mi3[0]=1;for(int i=1;i<65536;i++)mi3[i]=mi3[i-1]*x3%mod;\n    mi4[0]=1;for(int i=1;i<65536;i++)mi4[i]=mi4[i-1]*x4%mod;\n    scanf(\"%d\",&T);Mker::init();unsigned long long n;\n    for(int i=1;i<=T;i++)n=Mker::rand(),n%=(mod-1),ans^=K*(pw1(n)+mod-pw2(n))%mod;\n    printf(\"%d\",ans);return 0;\n}\n```\n\n\n\n\n\n\n\n",
        "postTime": 1545709848,
        "uid": 56384,
        "name": "shadowice1984",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5110 \u3010\u5757\u901f\u9012\u63a8\u3011"
    },
    {
        "content": "\u8003\u8651**\u77e9\u9635\u5feb\u901f\u5e42**\u3002\n\n\u4f46\u662f\u53ea\u6709**6**\u5206\u3002\n\n\u8003\u8651\u5230\u77e9\u9635\u6709**\u5faa\u73af\u8282**\uff0c\u672c\u9898\u4e3a**1e9+6**\u3002\u5373\u6bcf$10^9+6$\u4e2a\u6570\u5faa\u73af\u4e00\u6b21\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u5c06$n$\u7f29\u5c0f\u5230$10^9+7$\u8303\u56f4\u5185\u3002\n\n\u6b64\u65f6\u5927\u6982\u662f$22s$\u3002\u663e\u7136\u662f\u4e0d\u53ef\u4ee5\u7684\u3002\n\n\u8003\u8651**\u5206\u5757**\u3002\n\n\u6211\u4eec\u5c06$\\sqrt{Mod}$\u5185\u7684**\u7b54\u6848**\u77e9\u9635**\u9884\u5904\u7406**\u51fa\u6765\uff0c\u7136\u540e\u5c06$\\ k\\sqrt{Mod}\\ ,\\ 0\\le k \\le \\sqrt{Mod}\\ $\u7684**\u9012\u63a8**\u77e9\u9635**\u9884\u5904\u7406\u51fa\u6765**\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u8be2\u95ee$\\ n=v\\sqrt{Mod}+u$\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06$u$\u7684\u7b54\u6848\u77e9\u9635\u4e0e$v\\sqrt{Mod}$\u7684\u9012\u63a8\u77e9\u9635\u4e58\u4e00\u6b21\uff0c\u76f4\u63a5\u5f97\u5230\u7b54\u6848\u3002\n\n\u590d\u6742\u5ea6$O(T+20..30\\sqrt{Mod})$\u3002\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\n\n~~\u4ee3\u7801\u6bd4\u8f83\u4e11\u964b\uff0c\u56e0\u4e3a\u6211\u5361\u5e38\u6570\u6765\u7740~~\n\n~~\u5acc\u592a\u957f\u53ef\u4ee5\u4e0d\u770b\uff0c\u6bd5\u7adf\u7406\u89e3\u4e86\u539f\u7406\u81ea\u5df1\u7801\u5c31\u884c\u4e86~~\n\n```\nd[0][i][][]\u5b58\u7b2ci\u4e2a\u7684\u7b54\u6848\u77e9\u9635\nd[1][i][][]\u5b58i*sqrt{Mod}\u7684\u9012\u63a8\u77e9\u9635\n\n\u7b54\u6848\u53ea\u4e0e\u7b54\u6848\u77e9\u9635\u7684\u7b2c\u4e00\u884c\u548c\u9012\u63a8\u77e9\u9635\u7684\u7b2c\u4e00\u5217\u6709\u5173\n\u6240\u4ee5\u6211\u53ea\u5b58\u4e86\u8fd9\u4e24\u4e2a\u3002\n\n#include<cstdio>\ntypedef unsigned long long LL;\nconst int mod=1e9+7;\nconst int N=31625;\nLL SA,SB,SC,t,n;\nint a[2][2],b[2][2],ans,T;\nLL c[2][2];\nint d[2][N+1][2][2];\nint main(){\n    scanf(\"%d%llu%llu%llu\",&T,&SA,&SB,&SC);\n    register int i,j,k,p,u,v;\n    a[0][0]=a[1][0]=a[1][1]=0;\n    a[0][1]=1;\n    b[0][0]=0;\n    b[1][0]=1;\n    b[0][1]=666;\n    b[1][1]=233;\n    d[0][0][0][1]=1;\n    for(n=1;n<=N;n++){\n        c[0][0]=c[0][1]=c[1][0]=c[1][1]=0;\n        for(j=0;j<2;++j)\n        for(k=0;k<2;++k)\n        for(p=0;p<2;++p)\n        c[j][k]=(c[j][k]+1ll*a[j][p]*b[p][k]);\n        a[0][0]=c[0][0]%mod;\n        a[0][1]=c[0][1]%mod;\n        a[1][0]=c[1][0]%mod;\n        a[1][1]=c[1][1]%mod;\n        d[0][n][0][0]=a[0][0];\n        d[0][n][0][1]=a[0][1];\n    }\n    //\u66b4\u529b\u8ba1\u7b97\u7b54\u6848\u77e9\u9635\n    a[0][0]=a[1][1]=1;\n    a[1][0]=a[0][1]=0;\n    b[0][0]=0;\n    b[1][0]=1;\n    b[0][1]=666;\n    b[1][1]=233;\n    n=N;\n    for(;n;n>>=1){\n        if(n&1){\n            c[0][0]=c[0][1]=c[1][0]=c[1][1]=0;\n            for(j=0;j<2;++j)\n            for(k=0;k<2;++k)\n            for(p=0;p<2;++p)\n            c[j][k]=(c[j][k]+1ll*a[j][p]*b[p][k]);\n            a[0][0]=c[0][0]%mod;\n            a[0][1]=c[0][1]%mod;\n            a[1][0]=c[1][0]%mod;\n            a[1][1]=c[1][1]%mod;\n        }\n        c[0][0]=c[0][1]=c[1][0]=c[1][1]=0;\n        for(j=0;j<2;++j)\n        for(k=0;k<2;++k)\n        for(p=0;p<2;++p)\n        c[j][k]=(c[j][k]+1ll*b[j][p]*b[p][k]);\n        b[0][0]=c[0][0]%mod;\n        b[0][1]=c[0][1]%mod;\n        b[1][0]=c[1][0]%mod;\n        b[1][1]=c[1][1]%mod;\n    }\n    //\u8ba1\u7b97sqrt{Mod}\u7684\u7b54\u6848\u77e9\u9635\n    b[0][0]=a[0][0];\n    b[0][1]=a[0][1];\n    b[1][0]=a[1][0];\n    b[1][1]=a[1][1];\n    d[1][1][0][0]=a[0][0];\n    d[1][1][1][0]=a[1][0];\n    d[1][0][0][0]=1;\n    //0\u65f6\u4e3a\u5355\u4f4d\u77e9\u9635\n    for(n=2;n<=N;n++){\n        c[0][0]=c[0][1]=c[1][0]=c[1][1]=0;\n        for(j=0;j<2;++j)\n        for(k=0;k<2;++k)\n        for(p=0;p<2;++p)\n        c[j][k]=(c[j][k]+1ll*a[j][p]*b[p][k]);\n        a[0][0]=c[0][0]%mod;\n        a[0][1]=c[0][1]%mod;\n        a[1][0]=c[1][0]%mod;\n        a[1][1]=c[1][1]%mod;\n        d[1][n][0][0]=a[0][0];\n        d[1][n][1][0]=a[1][0];\n    }\n    //\u8ba1\u7b97k*sqrt{Mod}\u7684\u9012\u63a8\u77e9\u9635\n    for(i=1;i<=T;++i){\n        SA^=SA<<32,SA^=SA>>13,SA^=SA<<1;\n        t=SA;\n        SA=SB,SB=SC,SC^=t^SA;\n        n=SC%(mod-1);u=n%N;v=n/N;\n        //\u5faa\u73af\u77e9\u9635-\u53d6\u6a21\n        ans^=((1ll*d[0][u][0][0]*d[1][v][0][0]+1ll*d[0][u][0][1]*d[1][v][1][0])%mod);\n        //\u8ba1\u7b97\u7b54\u6848\u3002\n    }\n    printf(\"%d\\n\",ans);\n}\n```",
        "postTime": 1545484403,
        "uid": 50092,
        "name": "da32s1da",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P5110 \u3010\u5757\u901f\u9012\u63a8\u3011"
    },
    {
        "content": "\u9996\u5148\u8fd9\u4e2a\u9012\u63a8\u516c\u5f0f\u5728%(1e9+7)\u610f\u4e49\u4e0b\u662f\u6709\u5faa\u73af\u8282\u7684\u3002\n\n~~\u6253\u4e2a\u8868~~\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5faa\u73af\u8282\u662f(1e9+6)\n\n\u90a3\u4e48n\u5c31unsigned long long -> int\u4e86\u3002\n\n\u77e9\u4e58\u5927\u5bb6\u90fd\u4f1a\u5199\u5427\uff1f\n\n\u55ef\u5f88\u597d\u6211\u4eec\u67096\u5206\u4e86\u3002\n\n\u53d1\u73b0\u8fd9\u9898\u548cP5107\u5f88\u50cf\uff0c\u6211\u4eec\u53ef\u4ee5\u7528k\u8fdb\u5236\u77e9\u4e58\u6765\u89e3\u51b3\u628a\u77e9\u4e58\u6b21\u6570\u4eceO(logn)\u964d\u5230O(1)\u6b21,\u4e00\u4e2a\u4f18\u79c0\u7684\u5b9e\u73b0\u6bcf\u7ec4\u8be2\u95ee\u53ef\u4ee5\u53ea\u505a1\u6b21\u77e9\u4e58\u3002\n\n\u4e0d\u8fc7\u8fd9\u6837\u8fd8\u662f\u8d85\u65f6\u554aT_T \n\n\u6211\u4eec\u53d1\u73b0\u6c42\u6700\u7ec8\u7b54\u6848\u65f6\u6211\u4eec\u5e76\u4e0d\u7528\u4e58\u51fa\u5b8c\u6574\u7684\u77e9\u9635,\u53ea\u8981\u4e58\u51faa[1][1]\u4e00\u4e2a\u91cf\u3002\n\n\u90a3\u4e48\u5355\u6b21\u8be2\u95eeO(8) -> O(4)\n\nO(5 \u00d7 1e7 \u00d7 4) = O(2 \u00d7 1e8) ~~\u5f00\u4e2aO2~~\u5c31\u8fc7\u4e86\n\n\u975e\u5e38ugly\u7684\u4ee3\u7801\uff1a\n\n```\n#include <bits/stdc++.h>\n#define LL long long\n#define LLL unsigned long long\nusing namespace std;\ninline int read(){//\u5e76\u65e0\u4f5c\u7528\u7684\u5feb\u8bfb\n    int x = 0,f = 1; char c = getchar();\n    while (c != EOF && !isdigit(c)) {if (c == '-') f = -1;c = getchar();}\n    while (c != EOF && isdigit(c)) {x = x * 10 + c - '0';c = getchar();}\n    return x * f;\n}\n\nnamespace Maker{//\u771f\u6b63\u7684\u8bfb\u5165\u90e8\u5206\n    LLL SA,SB,SC;\n    inline void init(){scanf(\"%llu%llu%llu\",&SA,&SB,&SC);}\n    inline LLL rand(){ SA^=SA<<32,SA^=SA>>13,SA^=SA<<1; LLL t=SA; SA=SB,SB=SC,SC^=t^SA;return SC;}\n}\n\nconst int P = 1e9 + 7;\n\nstruct Matrix{//\u77e9\u9635\n    int n,m,a[3][3];\n    Matrix operator * (Matrix x){\n        Matrix tmp; tmp.n = 2,tmp.m = x.m;\n        int i,j,k,sum;\n        for (i = 1; i <= n; ++i)\n            for (j = 1; j <= x.m; ++j){\n                sum = 0;\n                for (k = 1; k <= m; ++k) sum = (sum + 1LL * a[i][k] * x.a[k][j] % P) % P; \n                tmp.a[i][j] = sum % P;\n            }\n        return tmp;\n    }\n}F,A,G[2][50005],PC[50005];\nint p1[50005],g1[50005],p2[50005],g2[50005];\n\nconst int cyc = 1000000006,M = 1000000,C = 50004;\nint T,x,a[M+5],n,ans = 0,nc[50005];\nint Div,Mod;\nint main(){\n    int i;\n    a[0] = 0,a[1] = 1;\n    for (i = 2; i <= M; ++i) a[i] = (233LL * a[i-1] + 666LL * a[i-2]) % P; // \u9884\u5904\u7406\u5c0f\u8303\u56f4\u7b54\u6848\n    \n    A.n = 2,A.m = 1,A.a[1][1] = a[M],A.a[2][1] = a[M-1];\n    F.n = 2,F.m = 2,F.a[1][1] = 233,F.a[1][2] = 666,F.a[2][1] = 1,F.a[2][2] = 0;\n    \n    // \u9884\u5904\u7406\u77e9\u9635(k\u8fdb\u5236\u77e9\u4e58\u7528)\n    PC[0] = A,G[0][1] = F,PC[1] = G[0][1] * A;\n    for (i = 2; i < C; ++i) G[0][i] = G[0][i-1] * F,PC[i] = G[0][i] * A;\n    G[1][1] = G[0][1] * G[0][C-1];\n    for (i = 2; i < C; ++i) G[1][i] = G[1][i-1] * G[1][1];\n    for (i = 0; i < C; ++i)\n        p1[i] = nc[i] = PC[i].a[1][1],p2[i] = PC[i].a[2][1],\n        g1[i] = G[1][i].a[1][1],g2[i] = G[1][i].a[1][2];\n    //\u8fd9\u91cc\u7684p1,p2,g1,g2\u662f\u4e3a\u4e86\u51cf\u5c11struct\u8bbf\u95ee\u7684\u5e38\u6570\n    T = read();\n    Maker::init();\n    while (T--){\n        x = Maker::rand() % cyc;// \u5bf9\u5faa\u73af\u8282\u53d6\u6a21\n        if (x <= M) ans ^= a[x]; // \u5c0f\u8303\u56f4\u7b54\u6848\u76f4\u63a5\u67e5\u8868\n        else{\n            n = x - M;\n            if (n >= C){//\u53ea\u505a\u4e00\u6b21\u77e9\u4e58,\u53ea\u4e58\u51faa[1][1]\n                Div = n / C,Mod = n % C;\n                ans ^= (1LL * g1[Div] * p1[Mod] + 1LL * g2[Div] * p2[Mod]) % P;//\u8fd9\u91cc\u7684p1,p2,g1,g2\u662f\u4e3a\u4e86\u51cf\u5c11struct\u8bbf\u95ee\u7684\u5e38\u6570\n            }\n            else ans ^= nc[n]; \n        }\n    }\n    cout << ans << endl;\n    return 0;\n}\n```",
        "postTime": 1545484430,
        "uid": 52518,
        "name": "s_r_f",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5110 \u3010\u5757\u901f\u9012\u63a8\u3011"
    },
    {
        "content": "\u7b2c\u4e00\u7bc7\u7d2b\u9898\u9898\u89e3~  \n~~\u81ea\u8ba4\u4e3a\u80fd\u628a\u65b0\u624b\u8bb2\u61c2\u3002~~\n\n--------\n\n$a_n = 233a_{n - 1} + 666a_{n - 2}$ \u7684\u7279\u5f81\u65b9\u7a0b\u4e3a $p^2 = 233p + 666$\uff0c\u5373 $p^2 - 233p + 666 = 0$\u3002$p$ \u7684\u4e24\u4e2a\u89e3\u4e3a\n$$\n\\begin{cases}\np1 = \\dfrac{233 + \\sqrt{56953}}{2} \\\\\\\\\np2 = \\dfrac{233 - \\sqrt{56953}}{2}\n\\end{cases}\n$$\n\n\u8fd9\u4e24\u4e2a\u89e3\u88ab\u79f0\u4e3a\u201c\u7279\u5f81\u6839\u201d\u3002\n\n\u8bbe\u8be5\u6570\u5217\u7684\u901a\u9879\u516c\u5f0f\u4e3a $a_n = c1\\cdot p1^n + c2\\cdot p2^n$\uff0c\u5176\u4e2d $c1,c2$ \u4e3a\u5e38\u6570\u3002  \n\n\u76f4\u5230\u8fd9\u4e00\u6b65\u53ef\u4ee5\u53c2\u8003 [\u7279\u5f81\u6839\u65b9\u7a0b - \u767e\u5ea6\u6587\u5e93](https://wenku.baidu.com/view/37709e32f111f18583d05acb.html)\u3002\n\n\u5c06 $a_0 = 0, a_1 = 1$ \u5e26\u5165\u5f97\uff1a\n\n$$\n\\begin{cases}\n0 = c1 + c2 \\\\\n1 = c1 \\cdot \\dfrac{233 + \\sqrt{56953}}{2} + c2 \\cdot \\dfrac{233 - \\sqrt{56953}}{2}\n\\end{cases}\n$$\n\n\u89e3\u5f97\n\n$$\n\\begin{cases}\nc1 = \\dfrac{1}{\\sqrt{56953}} \\\\\nc2 = -c1 = -\\dfrac{1}{\\sqrt{56953}}\n\\end{cases}\n$$\n\n\u73b0\u5728\u56de\u5230\u6700\u5f00\u59cb\u7684\u901a\u9879\u516c\u5f0f\uff0c\u53ef\u4ee5\u76f4\u63a5\u7528 $c2 = -c1$ \u4ee3\u5165\uff0c\n$$\na_n = c1 \\cdot(p1^n - p2^n) \n$$\n$$\na_n= \\dfrac{(\\dfrac{233 + \\sqrt{56953}}{2})^n - (\\dfrac{233 - \\sqrt{56953}}{2})^n}{\\sqrt{56953}}\n$$\n\u63a5\u4e0b\u6765\u5f00\u59cb\u5927\u529b\u63a8\u5f0f\u5b50\u3002\n\n\u56e0\u4e3a\u662f\u5728\u6a21\u7684\u610f\u4e49\u4e0b\uff0c\u6240\u4ee5\u53ef\u4ee5\u628a $\\sqrt{56953}$ \u6d88\u6389\u3002\n\n\u627e $\\sqrt{56953}$ \u4e0e\u8c01\u5728 $\\bmod\\  10^9 + 7$ \u7684\u610f\u4e49\u4e0b\u540c\u4f59 $\\Leftrightarrow$ \u627e\u4e00\u4e2a $x$ \u4f7f\u5f97 $x^2\\equiv56953\\pmod {10^9 + 7}$\u3002\n\n\u663e\u7136\u6709 $56953 \\bmod (10^9 + 7) = 56953$\uff0c\u6240\u4ee5\u6c42 $x$ \u7684\u7a0b\u5e8f\u4e3b\u4f53\u5982\u4e0b\uff1a\n\n```cpp\ntypedef long long ll;\n\nint main()\n{\n    for (ll i = 56953; ; ++i)\n        if (i * i % mod == 56953)\n            return printf(\"%lld\", i), 0;\n}\n```\n\n\u5f97\u5230\u7ed3\u679c $188305837$\uff0c\u628a\u539f\u5f0f\u4e2d\u7684 $\\sqrt{56953}$ \u5168\u90e8\u66ff\u6362\u4e3a $188305837$ \u540e\uff0c\u4e0e\u539f\u5f0f\u540c\u4f59\uff0c\u5373\n$$\na_n \\equiv \\dfrac{(\\dfrac{233 + 188305837}{2})^n - (\\dfrac{233 - 188305837}{2})^n}{188305837} \\pmod {10^9 + 7}\n$$\n\u5316\u7b80\u5f97\n$$\na_n \\equiv \\dfrac{94153035^n - (-94152802)^ n}{188305837}\\pmod {10^9 + 7}\n$$\n\u800c $-94152802$ \u53ef\u5316\u4e3a $(-94152802) \\bmod(10^9 + 7)  = 905847205$\u3002\n\n\u518d\u6b21\u5316\u7b80\u5f97\n$$\na_n \\equiv \\dfrac{94153035^n - 905847205^ n}{188305837}\\pmod {10^9 + 7}\n$$\n\n\u5728\u6a21\u610f\u4e49\u4e0b\uff0c\u4e00\u4e2a\u6570\u9664\u4ee5 $m$ \u4e0e\u5176\u4e58 $m$ \u7684\u9006\u5143\u7b49\u4ef7\uff1b\u82e5\u6a21\u6570 $p$ \u662f\u4e2a\u8d28\u6570\uff0c\u5219 $x$ \u7684\u9006\u5143\u4e3a $x^{p - 2} \\bmod p$\u3002\n\n\n\u56e0\u4e3a $10^9 + 7$ \u662f\u8d28\u6570\uff08\u53ef\u4ee5\u7b80\u5355\u7684\u5199\u4e00\u4e2a\u51fd\u6570\u5224\u65ad\uff09\uff0c\u6545 $188305837$ \u7684\u9006\u5143\u4e3a $188305837^{10^9 + 7 - 2} \\bmod 10^9 + 7$\uff0c\u53ef\u7528\u5feb\u901f\u5e42\u6216\u8005\u76f4\u63a5\u66b4\u529b\u6c42\u51fa\u3002  \n\n```cpp\nll f(ll a, ll b, ll k)\n{\n\tif (k == 1) return 0;\n\tif (!b) return 1;\n\tll ans = f(a, b >> 1, k);\n\t(ans *= ans) %= k;\n\tif (b&1) (ans *= a) %= k;\n\treturn ans;\n}\n\nint main()\n{\n    cout << f(188305837, 1e9 + 5, 1e9 + 7);\n    return 0;\n}\n```\n\n\u5f97\u5230\u7ed3\u679c $233230706$\uff0c\u5f0f\u5b50\u6700\u7ec8\u7b80\u5316\u4e3a\n$$\na_n \\equiv 233230706\\cdot(94153035^n - 905847205^n)\n$$\n\n\u7136\u540e\u4f60\u524d\u9762\u5199\u7684\u6240\u6709\u7a0b\u5e8f\u90fd\u6ca1\u7528\u4e86\uff0c\u6709\u7528\u7684\u53ea\u6709\u6700\u540e\u8fd9\u4e2a\u7cbe\u534e\u5f0f\u5b50\u3002  \n\n\u63a5\u4e0b\u6765\u5149\u901f\u5e42 $O(\\sqrt{p})$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u9884\u5904\u7406\uff0c\u63a5\u4e0b\u6765\u6bcf\u6b21\u8be2\u95ee $O(1)$ \u7b97\u3002\u5982\u6709\u4e0d\u4e86\u89e3\u7684\uff0c\u53ef\u4ee5\u770b\u770b\u6211\u7684 [\u8fd9\u7bc7\u535a\u5ba2](https://www.luogu.com.cn/blog/liangruichenBlog/guang-su-mi#)\u3002\n\n\u4e00\u4e2a~~\u5947\u6280\u6deb\u5de7~~\u5c0f\u7ec6\u8282\uff0c\u56e0\u4e3a $10^9 + 7 \\in \\mathbb{P}$\uff0c\u6240\u4ee5 $\\varphi(10^9 + 7) = 10^9 + 6$\u3002\n\n[AC code \u8bb0\u5f55](https://www.luogu.com.cn/record/56466616)\n\n```cpp\n#include <bits/stdc++.h>\n#define rep1(i, j, n) for (int i = j; i <= int(n); ++i)\n#define rep2(i, j, n) for (int i = j; i >= int(n); --i)\n#define ptc(x) putchar(x)\n#define il inline\n#define pb push_back\n#define mp make_pair\n#define fst first\n#define snd second\n#define YES ptc('Y'), ptc('E'), ptc('S'), ptc('\\n')\n#define Yes ptc('Y'), ptc('e'), ptc('s'), ptc('\\n')\n#define NO ptc('N'), ptc('O'), ptc('\\n')\n#define No ptc('N'), ptc('o'), ptc('\\n')\n#define rout return 0\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\nconst int MAXN = 4e4 + 10, inf = ~0U >> 2, mod = 1e9 + 7;\nconst int dx[] = {0, 0, 1, -1}, dy[] = {1, -1, 0, 0};\ntemplate <typename T>\nil void read(T &x)\n{\n\tx = 0; T f = 1; char ch = getchar();\n\twhile (!isdigit(ch)) {if (ch == '-') f = -1; ch = getchar();}\n\twhile (isdigit(ch)) {x = (x << 1) + (x << 3) + (ch & 15); ch = getchar();} x *= f;\n}\n\ntemplate <typename T>\nil void write(T x)\n{\n    if (x < 0) ptc('-'), x = -x;\n    if (x > 9) write(x / 10);\n    ptc(x % 10 + '0');\n}\n\nnamespace Mker\n{\n\tull SA, SB, SC;\n\tvoid init(){scanf(\"%llu%llu%llu\", &SA, &SB, &SC);}\n\tull rand()\n\t{\n\t    SA ^= SA << 32, SA ^= SA >> 13, SA ^= SA << 1;\n\t    ull t = SA;\n\t\treturn SA = SB, SB = SC, SC ^= t^SA, SC;\n\t}\n}\nint T, phi = mod - 1, op;\nint a[MAXN << 1], a2[MAXN], b[MAXN << 1], b2[MAXN];\n\nint f(int a, int b)\n{\n\tif (mod == 1) return 0;\n\tif (!b) return 1;\n\tll ans = f(a, b >> 1);\n\t(ans *= ans) %= mod;\n\tif (b&1) (ans *= a) %= mod;\n\treturn ans;\n}\n\nint main()\n{\n\tread(T); Mker::init(); a[0] = a2[0] = b[0] = b2[0] = 1;\n\tconst int k = ceil(sqrt(1e9 + 7)), c1 = 94153035, c2 = 905847205;\n\ta[1] = f(c1, k); a2[1] = c1;\n\trep1(i, 2, 2 * k) a[i] = 1ll * a[i - 1] * a[1] % mod;\n\trep1(i, 2, k) a2[i] = 1ll * a2[i - 1] * a2[1] % mod;\n\tb[1] = f(c2, k); b2[1] = c2;\n\trep1(i, 2, 2 * k) b[i] = 1ll * b[i - 1] * b[1] % mod;\n\trep1(i, 2, k) b2[i] = 1ll * b2[i - 1] * b2[1] % mod;\n\twhile (T--)\n\t{\n\t\tull q = Mker::rand();\n\t\tif (q > phi) q = q % phi + phi;\n\t\tll ans = (1ll * a[q / k] * a2[q % k] % mod - 1ll * b[q / k] * b2[q % k] % mod) % mod;\n\t\t(ans += mod) %= mod;\n\t\t(ans *= 233230706) %= mod;\n\t\top ^= ans;\n\t}\n\twrite(op); rout;\n}\n```\n\n",
        "postTime": 1629463615,
        "uid": 409236,
        "name": "StayAlone",
        "ccfLevel": 6,
        "title": "P5110 \u5757\u901f\u9012\u63a8 C++\u9898\u89e3"
    },
    {
        "content": "\u4ee5\u524d\u5728U\u7fa4\u770b\u5230\u7684\u505a\u6cd5\uff0c\u653e\u5728\u8fd9\u597d\u4e86\n\n\u7ed9\u5b9a\u6570\u5217\n\n$$a_n=\\alpha\\ a_{n-1}+\\beta\\ a_{n-2}$$\n\n\u6c42$a_n\\bmod p$\n\n\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u89e3\u4ed6\u7684\u7279\u5f81\u65b9\u7a0b\n\n$$x^2-\\alpha x-\\beta=0$$\n\n\u4e24\u89e3\u5206\u522b\u4e3a\n\n$$x_1=\\frac{\\alpha+\\sqrt{\\alpha^2+4\\beta}}{2},x_2=\\frac{\\alpha-\\sqrt{\\alpha^2+4\\beta}}{2}$$\n\n\u7136\u540e\u89e3\u4e00\u4e2a\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\u5c31\u53ef\u4ee5\u5f97\u5230\u7528$x_1,x_2$\u8868\u793a\u7684\u901a\u9879\u516c\u5f0f\n\n\u90a3\u4e48\u6211\u4eec\u7684\u95ee\u9898\u5c31\u662f\u600e\u4e48\u89e3\u51b3\u8fd9\u4e2a$x_1$\u548c$x_2$\n\n\u5982\u679c\n\n$$(\\frac{\\alpha^2+4\\beta}{p})=1$$\n\n\u90a3\u4e48\u53ef\u4ee5\u76f4\u63a5\u4e8c\u6b21\u5269\u4f59\u6c42\u51fa\u5566\n\n\u5230\u8fd9\u91cc\u4e3a\u6b62\u5176\u5b9e\u6211\u4eec\u5df2\u7ecf\u89e3\u51b3\u4e86\u8fd9\u9053\u9898\u672c\u8eab\uff0c\u6240\u4ee5\u4e0b\u9762\u662f\u5982\u679c\u628a\u6a21\u6570\u6539\u6210\u522b\u7684\u6570\u7684\u65f6\u5019\u7684\u505a\u6cd5\n\n---\n\n\u4ee5\u4e0b\u505a\u6cd5\u662fU\u7fa4\u7684\u4e00\u7fa4\u795e\u4ed9\u7ed9\u51fa\u7684\n\n\u5982\u679c\u4e0d\u662f\u4e8c\u6b21\u5269\u4f59\u7684\u8bdd\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8003\u8651\u6269\u4e2a\u57df\n\n\u9996\u5148\u8bbe\u96c6\u5408$\\mathbb{Z_p}$\u8868\u793a$\\bmod p$\u7684\u5b8c\u7cfb\uff0c\u7136\u540e\u663e\u7136\u5b83\u662f\u4e2a\u57df\n\n\u5b9a\u4e49\u96c6\u5408\n\n$$S=\\{a+b\\sqrt{\\alpha^2+4\\beta}|a\\in \\mathbb{Z_p},b\\in\\mathbb{Z_p}\\}$$\n\n\u90a3\u4e48\u663e\u7136\u8fd9\u4e5f\u662f\u4e00\u4e2a\u57df\n\n\u7136\u540e\u6211\u4eec\u4f1a\u53d1\u73b0\u4e0a\u9762\u7684\u90a3\u4e2a\u4e1c\u897f\u5b8c\u5168\u53ef\u4ee5\u5728\u8fd9\u4e2a\u7cfb\u91cc\u9762\u7b97\n\n\u6240\u4ee5\u81ea\u5df1\u5b9e\u73b0\u4e00\u4e0b\u8fd9\u4e2a\u57df\u7684\u56db\u5219\u8fd0\u7b97\uff08\u5176\u5b9e\u9664\u6cd5\u6839\u672c\u6ca1\u5fc5\u8981\uff09\uff0c\u7136\u540e\u5feb\u901f\u5e42\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\n\n\u6ce8\u610f\u5230\u6700\u540e\u7b97\u51fa\u6765\u7684\u7b54\u6848\u7684\u6839\u53f7\u90e8\u5206\u7cfb\u6570\u663e\u7136\u4e3a0\uff0c\u56e0\u4e3a\u7b54\u6848\u4e0d\u53ef\u80fd\u662f\u4e00\u4e2a\u5c0f\u6570\n\n\u6240\u4ee5\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u4e00\u4e2a\u5feb\u901f\u5e42\u89e3\u51b3\u5b83\u4e86\u3002",
        "postTime": 1593697600,
        "uid": 121027,
        "name": "Spasmodic",
        "ccfLevel": 7,
        "title": "O(logn)\u505a\u4e8c\u9879\u9012\u63a8\u7684\u7b2c\u4e8c\u79cd\u505a\u6cd5"
    },
    {
        "content": "## Tag\n\n\u751f\u6210\u51fd\u6570\u3002\n\n## Description\n\n\u4f60\u6709\u8fd9\u6837\u4e00\u4e2a\u5f0f\u5b50\uff1a\n\n$$\na_n=233a_{n-1}+666a_{n-2},a_0=0,a_1=1\n$$\n\n\u4e00\u5171 $T$ \u7ec4\u8be2\u95ee\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u7ec4\u8be2\u95ee\u4f1a\u7ed9\u51fa\u4e00\u4e2a $n$\uff0c\u4f60\u9700\u8981\u5feb\u901f\u5f97\u5230 $a_n$ \u7684\u503c\uff0c\u8f93\u51fa\u6240\u6709\u8be2\u95ee\u7684\u5f02\u6216\u548c\u3002\n\n## Solution\n\n### \u66b4\u529b1\n\n\u76f4\u63a5\u9012\u63a8\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(Tn)$\uff0c\u663e\u7136\u4e00\u4e2a\u70b9\u90fd\u8fc7\u4e0d\u53bb\u5427\u2026\u2026\n\n### \u66b4\u529b2\n\n\u8003\u8651\u9898\u9762\u4e2d\u63d0\u5230\u7684\u77e9\u9635\u5feb\u901f\u5e42\u505a\u6cd5\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u53bb\u4f18\u5316\uff0c\u8003\u8651\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u5bf9\u4e8e\uff0c\u90a3\u4e48\u53ef\u4ee5\u5f97\u5230\u8fd9\u6837\u4e00\u4e2a\u77e9\u9635\u3002\n\n$$\n\\begin{pmatrix}\na_1 & a_0\\\\\n0 & 0\n\\end{pmatrix}\n\\times\n\\begin{pmatrix}\n1 & 233\\\\\n0 & 666\n\\end{pmatrix}^n\n$$\n\n\u8fd9\u4e2a\u5c31\u662f\u7b54\u6848\u4e86\u3002\u7136\u540e\u8fd9\u6837\u53ef\u4ee5\u505a\u5230 $O(T\\lg n)$\u3002\n\n\u4f46\u662f\u4f60\u53ea\u80fd\u83b7\u5f97 $\\text{6pts}$ \u7684~~\u597d~~\u6210\u7ee9\u3002\n\n~~md\u77e9\u9635\u5feb\u901f\u5e42\u90fd\u53ea\u80fd\u62ff$6pts$\uff0c\u6de6\u3002~~\n\n### \u6b63\u89e3\n\n\u90a3\u5c31\u53ea\u80fd\u601d\u8003\u6b63\u89e3\u505a\u6cd5\u4e86\uff0c\u4e0b\u6587\u4f1a\u7528\u300a\u7ec4\u5408\u6570\u5b66\u300b\u4e2d\u7279\u5f81\u65b9\u7a0b\u7684\u89e3\u6cd5\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\n\n\u6211\u4eec\u8bbe\u51fa\u8fd9\u4e2a\u5e8f\u5217 $\\{a_n\\}$ \u7684\u751f\u6210\u51fd\u6570\uff1a\n\n$$\nF(x)=\\sum_{i=0}^\\infty a_ix^i\n$$\n\n\u8bd5\u7740\u5c06\u6211\u4eec\u7684\u516c\u5f0f\u5957\u8fdb\u53bb\uff1a\n\n$$\nF(x)-[x^0]F(x)-x[x^1]F(x)=233x(F(x)-[x^0]F(x))+666x^2F(x)\n$$\n\n\u6362\u4e2a\u610f\u601d\u8868\u8fbe\uff1a\n\n$$\nF(x)-a_0-a_1x=233x(F(x)-a_0)+666x^2F(x)\n$$\n\n\u6211\u4eec\u5f88\u597d\u7406\u89e3\u8fd9\u4e2a\u65b9\u7a0b\uff0c\u4ece\u53f3\u5f80\u5de6\u770b\uff0c\u7b2c\u4e00\u4e2a $F(x)$ \u8868\u793a\u7684\u662f $a_{n-2}$ \u7684\u503c\uff0c\u6574\u4f53\u7684\u5e8f\u5217\u5411\u53f3\u5e73\u79fb\u4e86 $2$ \u4f4d\u4e4b\u540e\u5c31\u53ef\u4ee5\u4e0e $a_n$ \u5bf9\u9f50\u4e86\uff0c\u90a3\u4e48\u540c\u7406\u7684\uff0c\u7b2c\u4e8c\u4e2a $F(x)$ \u5c31\u8868\u793a\u7684\u662f $a_{n-1}$ \u7684\u503c\uff0c\u7136\u540e\u6574\u4f53\u5411\u53f3\u5e73\u79fb $1$ \u4f4d\u3002\n\n\u4f46\u662f\u6211\u4eec\u4e0d\u5bb9\u5ffd\u7565\u7684\u662f\uff0c\u5f53 $a_1$ \u4e0e $a_2$ \u5bf9\u9f50\u4e86\u4e4b\u540e $a_0$ \u4ecd\u7136\u5b58\u5728\u4e8e\u8fd9\u4e2a\u5e8f\u5217\u4e2d\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5c06 $a_0$ \u6240\u5e26\u6765\u7684\u7684\u5f71\u54cd\u53bb\u6389\uff0c\u5f53\u7136\u5728\u8fd9\u4e2a\u9898\u4e2d\u95f4\u662f\u6ca1\u6709\u5fc5\u8981\u7684\u2026\u2026\n\n\u6240\u4ee5\u6211\u4eec\u5f97\u5230\u8fd9\u6837\u4e00\u4e2a\u5f0f\u5b50\u4e4b\u540e\u53ef\u4ee5\u8bd5\u7740\u89e3\u4e00\u89e3\u4e86\u3002\n\n$$\n\\begin{aligned}\nF(x)-a_0-a_1x&=666x(F(x)-a_0)+233x^2F(x)\\\\\nF(x)-x&=666xF(x)+233x^2F(x)\\\\\nF(x)&=\\dfrac{x}{1-233x-666x^2}\n\\end{aligned}\n$$\n\n\u6211\u4eec\u5f97\u5230\u4e86\u8fd9\u4e2a\u6bcd\u51fd\u6570\u7684\u5c01\u95ed\u5f62\u5f0f\uff01\n\n\u8fd9\u4e2a\u7ed3\u8bba\u5f88\u8ba9\u4eba\u6fc0\u52a8\uff0c\u4f46\u662f\u6211\u4eec\u8981\u7ee7\u7eed\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6240\u4ee5\u6211\u4eec\u89e3\u4e00\u4e0b\u540e\u9762\u8fd9\u4e2a\u4e27\u5fc3\u75c5\u72c2\u7684\u5f0f\u5b50\u2026\u2026\n\n$$\n\\dfrac{x}{1-233x-666x^2}=\\dfrac{x}{\\left(1-\\dfrac{233-\\sqrt{56953}}{2}x\\right)\\left(1-\\dfrac{233+\\sqrt{56953}}{2}x\\right)}\n$$\n\n\u6211\u4eec\u8bbe $\\alpha,\\beta$ \u4e3a\u5206\u6bcd\u4e2d $x$ \u7684\u7cfb\u6570\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f97\u5230\n\n$$\n\\alpha=\\dfrac{233-\\sqrt{56953}}{2},\\beta=\\dfrac{233+\\sqrt{56953}}{2}\n$$\n\n\u6240\u4ee5\u5c31\u6709\uff1a\n\n$$\nF(x)=\\dfrac{A}{1-\\alpha x}+\\dfrac{B}{1-\\beta x}\n$$\n\n\u8fd9\u91cc\u7684 $A,B$ \u90fd\u662f\u5f85\u5b9a\u7cfb\u6570\uff1a\n\n$$\nF(x)=A\\sum_{i=0}^\\infty \\alpha^ix^i+B\\sum_{i=0}^\\infty \\beta^ix^i\n$$\n\n\u7136\u540e\u89e3\u51fa $A,B$ \u7684\u503c\uff1a\n\n$$\n\\begin{cases}\nA+B=0\\\\\nA\\alpha + B\\beta=1\n\\end{cases}\n$$\n\n\u89e3\u51fa\u6765\u5c31\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$\n\\begin{cases}\nA=-\\dfrac{1}{\\sqrt{56953}}\\\\\nB=\\dfrac{1}{\\sqrt{56953}}\n\\end{cases}\n$$\n\n\u6240\u4ee5\n\n$$\n[x^n]F(x)=\\dfrac{\\beta^n-\\alpha^n}{\\sqrt{56953}}\n$$\n\n\u4f46\u662f\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6\u8fd8\u662f $O(T\\lg n)$ \u7684\u554a\u2026\u2026\n\n\u4e0d\u8fc7 $\\beta,\\alpha$ \u7684\u503c\u90fd\u662f\u786e\u5b9a\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5~~\u6253\u8868~~\u5149\u901f\u5e42\u6c42\u89e3\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(T)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n",
        "postTime": 1631950063,
        "uid": 366935,
        "name": "KAMIYA_KINA",
        "ccfLevel": 7,
        "title": "P5110 \u5757\u901f\u9012\u63a8 \u9898\u89e3"
    },
    {
        "content": "### \u7279\u5f81\u65b9\u7a0b\u6cd5\u6c42\u901a\u9879\u516c\u5f0f\n\n$a_n=pa_{n-1}+qa_{n-2}$\u7684\u7279\u5f81\u65b9\u7a0b$x^2=px+q$\n\n- \u82e5\u6709\u4e24\u4e2a\u4e0d\u540c\u6839$\\alpha,\\beta$\u5219\u901a\u9879\u516c\u5f0f\u4e3a$a_n=A\\alpha^n+B\\beta^n$\n- \u82e5\u6709\u4e24\u4e2a\u76f8\u540c\u6839$\\alpha$\u5219\u901a\u9879\u516c\u5f0f\u4e3a$a_n=(An+B)\\alpha^n$\n- $A,B$\u7531$a_0,a_1$\u786e\u5b9a\n\n$\\therefore a_n=\\frac{(\\frac{233+\\sqrt{56953}}{2})^n-(\\frac{233-\\sqrt{56953}}{2})^n}{\\sqrt{56953}}$\n\n### \u5b9e\u6570\u8fd0\u7b97\u6c42$a_n$\n\n- \u4ee4$c=56953$\u53ef\u77e5\u8be5\u901a\u9879\u516c\u5f0f\u5206\u5b50\u4e2d\u7684\u6570\u5728\u8fd0\u7b97\u65f6\u4fdd\u6301$a+b\\sqrt c$\n- $(a_1+b_1\\sqrt c)\\times(a_2+b_2\\sqrt c)=(a_1a_2+b_1b_2c)+(a_1b_2+a_2b_1)\\sqrt c$\n\n\u672c\u9898\u5206\u5b50\u4e24\u90e8\u5206\u8fd0\u7b97\u7ed3\u679c\u7684$a$\u76f8\u53cd$\\therefore$\u5206\u5b50\u8fd0\u7b97\u7ed3\u679c\u7684$b$\u5373\u4e3a\u6240\u6c42\n\n\u53c8\u672c\u9898\u5206\u5b50\u4e24\u90e8\u5206\u8fd0\u7b97\u7ed3\u679c\u7684$b$\u76f8\u7b49\uff0c$\\therefore$\u7b97\u4e00\u4e2a$\\times2$\u5c31\u884c\n\n- \u5b9e\u6570\u8fd0\u7b97\u4f7f\u6839\u53f7\u7684\u5904\u7406**\u4e00\u822c\u5316**\n\n### \u9006\u5143\u907f\u514d\u9664\u6cd5\n\n- \u82e5$a\\times x\\equiv 1(mod$ $p)$\u8bb0$x=a^{-1}$\u79f0\u4e3a$a$\u7684\u9006\u5143$(p$\u4e3a\u8d28\u6570$)$\n- $1^{-1}=1$\n\n\u53d6\u6a21\u9664\u6cd5\u7b49\u4ef7\u4e58\u9006\u5143\u53d6\u6a21\uff0c\u672c\u9898$div2=(mod>>1)+1=500000004$\uff0c\u4e14$233div2\\equiv116+div2$\n\n#### \u4f4d\u8fd0\u7b97\u6bd4\u9664\u6cd5\u5feb\u90a3\u4e48\u4e00\u4e22\u4e22\n\n```#include<bits/stdc++.h>\n#define LL unsigned long long\nusing namespace std;\nconst int mod=1000000007,div2=(mod>>1)+1,c=56953;\nint t,n,ans;\n\nnamespace Mker\n{\n    unsigned long long SA,SB,SC;\n    void init(){scanf(\"%llu%llu%llu\",&SA,&SB,&SC);}\n    unsigned long long rand()\n    {\n        SA^=SA<<32,SA^=SA>>13,SA^=SA<<1;\n        unsigned long long t=SA;\n        SA=SB,SB=SC,SC^=t^SA;return SC;\n    }\n}\n\nstruct Re{\n    LL a,b;\n    Re(){a=1;b=0;}\n    Re operator*(Re x){\n        Re r;\n        r.a=(a*x.a+b*x.b%mod*c)%mod;\n        r.b=(a*x.b+b*x.a)%mod;\n        return r;\n    }\n}e,e2,e3,u[32769],v[30520];\n\nint main(){\n    e.a=116+div2;\n    e.b=div2;\n    for(int i=1;i<=32768;++i)\n    u[i]=u[i-1]*e;\n    e2=u[32768];\n    for(int i=1;i<30520;++i)\n    v[i]=v[i-1]*e2;\n    cin>>t;\n    Mker::init();\n    while(t--)\n    {\n        n=Mker::rand()%(mod-1);\n        ans^=((u[n&32767]*v[n>>15]).b<<1)%mod;\n    }\n    cout<<ans;\n}\n```",
        "postTime": 1547213050,
        "uid": 128173,
        "name": "betterer",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5110 \u3010\u5757\u901f\u9012\u63a8\u3011"
    },
    {
        "content": "\u9996\u5148\u6211\u4eec\u66b4\u529b\u627e\u4e00\u4e0b\u5faa\u73af\u8282\uff0c\u53d1\u73b0\u662f1e9+6,\u7136\u540e\u8003\u8651\u5982\u4f55\u5bf9\u6bcf\u4e2a\u8be2\u95eeO(1)\u6c42\u51fa  \n\u8fd9\u91cc\u7528\u7684\u662f\u77e9\u9635\u4e58\u6cd5\uff0c\u5355\u4f4d\u77e9\u9635\u4e3a  \n233 666  \n1   0  \n\u8003\u8651\u5c06\u6307\u6570n\u5316\u6210t\\*y+x\u7684\u5f62\u5f0f\uff0c\u5176\u4e2dy\u4e3asqrt(1e9+6)\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u77e9\u9635\u7684mi1[]=0,1,2,3,...,y-1\u6b21\u5e42\u548cmi2[]=y,2y,3y,...,y(y+1)\u6b21\u5e42\uff0c\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\uff0c\u6211\u4eec\u8981\u6c42\u7684\u7b2cn\u9879\u5c31\u662fmi2[(n-1)/y]\\*mi1[(n-1)%y]\\*ans\uff0c\u5176\u4e2dans\u521d\u59cb\u5316\u4e3a  \n1 0  \n0 0  \n\u6b64\u5916\uff0c\u8981\u7279\u522b\u6ce8\u610f\u5e38\u6570\u95ee\u9898\uff0c\u77e9\u9635\u4e58\u6cd5\u4e0d\u80fd\u7528\u6570\u7ec4\u5faa\u73af\u53bb\u6c42\uff0c\u6211\u4eec\u6539\u62104\u4e2a\u53d8\u91cf\u7136\u540e\u624b\u52a8\u53bb\u6c42\uff0c\u5177\u4f53\u770b\u4ee3\u7801  \n```cpp\n#include <bits/stdc++.h>\n#define rg register\n#define inl inline\ntypedef long long ll;\ntypedef unsigned long long ull;\nconst int N = 4e4 + 10, mod = 1e9 + 7;\nusing namespace std;\nnamespace fast_IO {\n    ll read()\n    {\n        rg ll num = 0;\n        rg char ch;\n        rg bool flag = false;\n        while ((ch = getchar()) == ' ' || ch == '\\n' || ch == '\\r');\n        if (ch == EOF)return ch; if (ch == '-')flag = true; else num = ch ^ 48;\n        while ((ch = getchar()) != ' '&&ch != '\\n'&&ch != '\\r'&&~ch)\n            num = (num << 1) + (num << 3) + (ch ^ 48);\n        if (flag)return -num; return num;\n    }\n    void write(rg long long x) { if (x < 0)putchar('-'), x = -x; if (x >= 10)write(x / 10); putchar(x % 10 ^ 48); }\n};\nnamespace Mker\n{\n    unsigned long long SA, SB, SC;\n    void init() { scanf(\"%llu%llu%llu\", &SA, &SB, &SC); }\n    unsigned long long rand()\n    {\n        SA ^= SA << 32, SA ^= SA >> 13, SA ^= SA << 1;\n        unsigned long long t = SA;\n        SA = SB, SB = SC, SC ^= t ^ SA; return SC;\n    }\n}\nstruct Matrix {\n    ll a, b, c, d;\n    Matrix() { a = b = c = d = 0; }\n    Matrix operator *(rg Matrix &s)\n    {\n        Matrix tmp;\n        tmp.a = (a * s.a + b * s.c) % mod, tmp.b = (a * s.b + b * s.d) % mod;\n        tmp.c = (c * s.a + d * s.c) % mod, tmp.d = (c * s.b + d * s.d) % mod;\n        return tmp;\n    }\n}base, mi1[N], mi2[N];\n\nint main()\n{\n    base.a = 233; base.b = 666; base.c = 1;\n    mi1[1] = base; int len = sqrt(1e9 + 6);\n    for (int i = 2; i != len; ++i)mi1[i] = mi1[i - 1] * base;\n    mi2[1] = mi1[len - 1] * base; mi1[0].a = mi1[0].d = 1;\n    mi2[0].a = mi2[0].d = 1;\n    for (int i = 2; i <= len + 1; ++i)mi2[i] = mi2[i - 1] * mi2[1];\n    rg ll T = fast_IO::read(), a = 0; Mker::init();\n    while (T--)\n    {\n        Matrix ans; ans.a = 1;\n        int n = Mker::rand() % 1000000006;\n        if (n <= 1) { a ^= n; continue; }\n        else ans = ans * mi2[(n - 1) / len] * mi1[(n - 1) % len], a ^= ans.a;\n    }\n    fast_IO::write(a);\n    return 0;\n}\n\n```",
        "postTime": 1545490335,
        "uid": 87283,
        "name": "Zechariah",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5110 \u3010\u5757\u901f\u9012\u63a8\u3011"
    },
    {
        "content": "\u592a\u83dc\u4e86\uff0c\u4e0d\u4f1a\u751f\u6210\u51fd\u6570\uff0c\u4e8e\u662f\u7528\u7279\u5f81\u65b9\u7a0b\u6765\u5199\u7684\u8fd9\u9053\u9898\n\n\u9996\u5148\u6211\u4eec\u77e5\u9053\uff0c\u5f62\u5982$a_n=A*a_{n-1}+B*a_{n-2}$\u7684\u7279\u5f81\u65b9\u7a0b\u4e3a$x^2=A*x+B$\n\n\u4e8e\u662f\u6b64\u9898\u7684\u9012\u63a8\u5f0f\u5c31\u662f\uff1a$x^2=233x+666$\uff0c\u5373\uff1a$x^2-233x-666=0$\n\n\u7528\u6c42\u6839\u516c\u5f0f\u89e3\u5f97\uff1a$x_1=\\dfrac{233+\\sqrt{56953}}{2}, x_2=\\dfrac{233-\\sqrt{56953}}{2}$\n\n\u7531\u4e8e$188305837\u2261\\sqrt{56953}(mod\\ 1e9+7)$\n\n\u6240\u4ee5\u53d8\u6210\uff1a$x_1 = $94153035$\u202c$, $x_2=905847205$\n\n\u8ddf\u636e\u7279\u5f81\u65b9\u7a0b\u7684\u7ed3\u8bba\uff1a$a_n=\u03b1x_1^n+\u03b2*x_2^n$\n\n\u56e0\u4e3a$a_0=0, a_1=1$\uff0c\u6240\u4ee5\u6709\uff1a\n\n$\u03b1+\u03b2=0$\n\n$94153035*\u03b1+905847205*\u03b2=1$\n\n\u89e3\u5f97\uff1a$\u03b1=\\dfrac{1}{188305837}=233230706, \u03b2=-\\dfrac{1}{188305837}=-233230706$\n\n\u6240\u4ee5$a_n=233230706*94153035^n-233230706*905847205^n$\n\n\u7531\u4e8e\u8be2\u95ee\u8f83\u591a\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u7528$O(1)$\u5149\u901f\u5e42\u6c42\u89e3\n## $Code:$\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define il inline\n#define re register\nil int read() {\n    re int x = 0, f = 1; re char c = getchar();\n    while(c < '0' || c > '9') { if(c == '-') f = -1; c = getchar();}\n    while(c >= '0' && c <= '9') x = x * 10 + c - 48, c = getchar();\n    return x * f;\n}\n#define rep(i, s, t) for(re int i = s; i <= t; ++ i)\n#define maxn 300\nconst int mod = 1000000007;\nconst int x1 = 94153035, x2 = 905847205, a = 233230706;\nint n, m, ans;\nint f1[65540], f2[65540], f3[65540], f4[65540];\nint g1[65540], g2[65540], g3[65540], g4[65540];\nunsigned long long SA,SB,SC;\nvoid init(){scanf(\"%llu%llu%llu\",&SA,&SB,&SC);}\nunsigned long long Rand() {\n    SA^=SA<<32,SA^=SA>>13,SA^=SA<<1;\n    unsigned long long t=SA;\n    SA=SB,SB=SC,SC^=t^SA;return SC;\n}\nil int mul(int a, int b) {\n    return 1ll * a * b % mod;\n}\nil int qpow1(int x) {\n    return mul(f1[x & 65535], f2[x >> 16]);\n}\nil int qpow2(int x) {\n    return mul(g1[x & 65535], g2[x >> 16]);\n}\nint main() {\n    f1[0] = g1[0] = 1;\n    rep(i, 1, 65536) f1[i] = mul(f1[i - 1], x1), g1[i] = mul(g1[i - 1], x2);\n\tf2[0] = g2[0] = 1, f2[1] = f1[65536], g2[1] = g1[65536];\n\trep(i, 2, 65536) f2[i] = mul(f2[i - 1], f2[1]), g2[i] = mul(g2[i - 1], g2[1]);\n\tint T = read(); init();\n    while(T --) {\n        n = (Rand()) % (mod - 1);\n        ans ^= 1ll * a * (qpow1(n) - qpow2(n) + mod) % mod;\n    }\n    printf(\"%d\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1571753107,
        "uid": 57014,
        "name": "Nemlit",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5110 \u3010\u5757\u901f\u9012\u63a8\u3011"
    },
    {
        "content": "## \u9898\u610f\u7b80\u8ff0\n\n\u5df2\u77e5 $a_n=233a_{n-1}+666a_{n-2},a_0=0,a_1=1$\n\n\u6709 $5\\times 10^7$ \u7ec4\u8be2\u95ee\uff0c\u6c42 $a_n$ \u6a21 $10^9+7$ \u7684\u503c\n\n## \u9898\u89e3\u601d\u8def\n\n\u5fc5\u987b\u8981 $O(1)$ \u5b9e\u73b0\n\n\u8bbe $a_n=c\\cdot q^n$\uff0c\n\n\u5219 $ c \\cdot q^n=233c \\cdot q^{n-1}+666c \\cdot q^{n-2}$\n\n\u5316\u7b80\u540e\u5f97 $q^2-233q-666=0$\uff0c\u89e3\u5f97 $q_1= \\frac{233+\\sqrt{56953}}{2}$\uff0c$q_2= \\frac{233-\\sqrt{56953}}{2}$\n\n\u7136\u540e\u53ef\u4ee5\u53d1\u73b0 $\\sqrt{56953}$ \u5728\u6a21 $10^9+7$ \u610f\u4e49\u4e0b\u6070\u597d\u7b49\u4e8e $188305837$\n\n\u5728\u6a21\u610f\u4e49\u4e0b $q_1=94153035$\uff0c$q_2=905847205$\n\n\u6240\u4ee5 $a_n=c_1\\cdot q_1^n-c_2\\cdot q_2^n$\uff0c\u5c06 $a_0=0,a_1=1$\u5e26\u5165\uff0c\n\n\u5373 $\\begin{cases} c_1-c_2=0 \\\\ c_1\\cdot q_1-c_2\\cdot q_2=1\\end{cases}$ \u89e3\u5f97 $c_1=c_2=\\frac{1}{q1-q2}$ \u5728\u6a21\u610f\u4e49\u4e0b\u5373 $233230706$ \n\n\u6240\u4ee5 $a_n=233230706\\times(94153035^n-905847205^n)$\n\n\u6b64\u65f6\u7528\u5feb\u901f\u5e42\u4ecd\u7136\u4f1aT\uff0c\u7531\u4e8e\u5e95\u6570\u56fa\u5b9a\uff0c\u6240\u4ee5\u53ef\u4ee5\u5206\u5757\u3002\n\n\u53d6$S=\\lceil\\sqrt{n_{max}}\\rceil$\uff0c\u8fd9\u91cc\u4e3a\u4e86\u65b9\u4fbf\u53d6 $S=2^{16}=65536$\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$n$\uff0c\u90fd\u53ef\u4ee5\u8868\u793a\u4e3a$k\\cdot S+r,k\u2208[0,S),r\u2208[0,S)$\n\n\u6240\u4ee5\u5206\u522b\u9884\u5904\u7406\u51fa $f_1[k]=q_1^k,k\\in[0,S)$ \u548c $f_2[k]=q_1^{k\\cdot S},k\\in[0,S)$,\u5219$q^n=f_1[n/S]*f2[n\\%S]=f_1[n>>16]*f1[n\\&S]$\u3002\n\n$q_2$\u540c\u7406\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5$O(1)$\u6c42\u51fa\u7b54\u6848\n\n## \u4ee3\u7801\n\n```c++\n#include <cstdio>\n#define ll long long\n#define ull unsigned ll\nconst int mod=1e9+7,S=65535,c1=94153035,c2=905847205,c3=233230706;\nint T,ans;\nll f11[S+5]={1},f12[S+5]={1},f21[S+5]={1},f22[S+5]={1};\null SA,SB,SC,t;\ninline ull rnd() {\n\tSA^=SA<<32,SA^=SA>>13,SA^=SA<<1;\n\tt=SA,SA=SB,SB=SC; return SC^=t^SA;\n}\nint main() {\n\tscanf(\"%d%llu%llu%llu\",&T,&SA,&SB,&SC);\n\tfor (int i=1;i<=S;++i) f11[i]=f11[i-1]*c1%mod,f21[i]=f21[i-1]*c2%mod;\n\tconst int x1=f11[S]*c1%mod,x2=f21[S]*c2%mod;\n\tfor (int i=1;i<=S;++i) f12[i]=f12[i-1]*x1%mod,f22[i]=f22[i-1]*x2%mod;\n\tfor (;T;--T) {\n\t\tt=rnd()%(mod-1); const int t1=t&S,t2=t>>16;\n\t\tans^=((f11[t1]*f12[t2]-f21[t1]*f22[t2])%mod+mod)*c3%mod;\n\t}\n\tprintf(\"%d\\n\",ans);\n}\n```\n\n",
        "postTime": 1570272360,
        "uid": 10602,
        "name": "xuyixuan",
        "ccfLevel": 0,
        "title": "P5110 \u5757\u901f\u9012\u63a8"
    },
    {
        "content": "\u9996\u5148\u662f\u62ff\u751f\u6210\u51fd\u6570\u63a8\u516c\u5f0f\uff0c\u5927\u5bb6\u53ef\u4ee5\u770b\u51fa\u9898\u4eba\u7684\u9898\u89e3\u3002\u4f46\u63a5\u4e0b\u6765\u8fd8\u6709\u4e00\u6b65\u975e\u5e38\u91cd\u8981\uff1a\u6a21\u610f\u4e49\u4e0b\u5f00\u65b9\u3002\u8fd9\u9898\u7684\u6a21\u6570\u5f88\u5c0f\uff0c\u53ef\u4ee5\u66b4\u529b\u51fa\u6765\uff0c\u4f46\u5bf9\u4e8e\u5927\u6a21\u6570\uff0c\u5c31\u9700\u8981\u4e00\u4e9b\u6280\u5de7\u4e86\u3002  \n\u5047\u8bbe\u6211\u4eec\u8981\u5bf9\u6a21\u7d20\u6570$P$\u610f\u4e49\u4e0b\u7684$a$\u5f00\u65b9\u3002\u9996\u5148\u4f7f\u7528\u4e8c\u6b21\u5269\u4f59\u7684\u6b27\u62c9\u51c6\u5219\u5224\u65ad\u540c\u4f59\u65b9\u7a0b$$x^2\\equiv a(\\text{mod}\\; P)$$\u662f\u5426\u6709\u89e3\u3002  \n       \n\u4e8c\u6b21\u5269\u4f59\u7684\u6b27\u62c9\u51c6\u5219\uff1a$x^2\\equiv a(\\text{mod}\\; P)$\u6709\u89e3\u7684\u5145\u5206\u5fc5\u8981\u6761\u4ef6\u662f$$a^{\\frac{P-1}{2}}\\equiv 1(\\text{mod}\\; P)$$\u8bc1\u660e\uff1a  \n\u5148\u8bc1\u5fc5\u8981\u6027\u3002\u8bbe$x^2\\equiv a(\\text{mod}\\; P)$\u7684\u4e00\u4e2a\u89e3\u4e3a$b$\uff0c\u5219$$a^{\\frac{P-1}{2}}\\equiv(b^2)^{\\frac{P-1}{2}}\\equiv b^{P-1}\\equiv  1(\\text{mod}\\; P)$$\u6700\u540e\u4e00\u6b65\u7528\u5230\u4e86\u8d39\u9a6c\u5c0f\u5b9a\u7406\u3002  \n\u518d\u8bc1\u5145\u5206\u6027\u3002\u901a\u8fc7\u628a$$1,2,\\cdots ,P-1 $$\u8fd9$P-1$\u4e2a\u6570$\\text{mod}P$\u5316\u7b80\u5230$$-\\frac{P-1}{2},-\\frac{P-1}{2}+1,\\cdots,-1,0,1,\\cdots,\\frac{P-1}{2}-1,\\frac{P-1}{2}$$\uff0c\u518d\u8003\u5bdf\u6bcf\u4e2a\u6570\u5b57\u7684\u5e73\u65b9\uff0c\u6211\u4eec\u53d1\u73b0$P$\u7684\u65e2\u7ea6\u5269\u4f59\u7cfb\u4e2d\u6709$\\frac{P-1}{2}$\u4e2a\u4e8c\u6b21\u5269\u4f59\u3002\u53c8\u56e0\u4e3a\u65b9\u7a0b$$x^{\\frac{P-1}{2}}\\equiv 1(\\text{mod}\\; P)$$\u6700\u591a\u6709$\\frac{P-1}{2}$\u4e2a\u89e3~~\uff08\u4f60\u77e5\u9053\u8fd9\u662f\u4e3a\u4ec0\u4e48\u5417\uff1f\uff09~~\uff0c\u6240\u4ee5\u6bcf\u4e2a\u89e3\u548c$P$\u7684\u4e8c\u6b21\u5269\u4f59\u4e00\u4e00\u5bf9\u5e94\u3002\u6240\u4ee5$$a^{\\frac{P-1}{2}}\\equiv 1(\\text{mod}\\; P)$$\u4ec5\u4ec5\u5bf9\u4e8e$P$\u7684\u6bcf\u4e2a\u4e8c\u6b21\u5269\u4f59\u6210\u7acb\u3002\u8fd9\u5c31\u8bc1\u660e\u4e86\u5145\u5206\u6027\u3002\n  \n\u901a\u8fc7\u6b27\u62c9\u51c6\u5219\uff0c\u6211\u4eec\u53d1\u73b0\u672c\u9898\u4e2d\u9700\u8981\u5f00\u65b9\u7684\u6570\u521a\u597d\u662f$P$\u7684\u4e8c\u6b21\u5269\u4f59\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5b83\u53ef\u4ee5\u5728\u6a21$P$\u610f\u4e49\u4e0b\u5f00\u65b9\u3002\u4e8b\u5b9e\u4e0a\uff0c\u5bf9\u4e8e\u67d0\u4e9b\u7279\u6b8a\u7684\u7d20\u6570\uff0c\u6211\u4eec\u6709\u529e\u6cd5\u5b9e\u73b0\u5feb\u901f\u5f00\u65b9\u3002 \n  \n\u5bf9\u4e8e\u6a21$4$\u540c\u4f59$3$\u7684\u7d20\u6570\u7684\u5feb\u901f\u5f00\u65b9\u6280\u5de7\uff1a\u82e5$x^2\\equiv a(\\text{mod}P)$\u6709\u89e3\u4e14$P\\equiv 3(\\text{mod}4)$\uff0c\u5219$a^{\\frac{P+1}{4}}$\u662f$x$\u7684\u4e00\u4e2a\u89e3\u3002  \n\u8bc1\u660e\uff1a  \n$$(a^{\\frac{P+1}{4}})^2\\equiv a^{\\frac{P-1}{2}+1}(\\text{mod}P)$$  \n\u56e0\u4e3a$$a^{\\frac{P-1}{2}}\\equiv 1(\\text{mod}\\; P)$$\u6240\u4ee5$$(a^{\\frac{P+1}{4}})^2\\equiv a^{\\frac{P-1}{2}+1}\\equiv a(\\text{mod}P)$$\uff0c\u6240\u4ee5$a^{\\frac{P+1}{4}}$\u662f$x$\u7684\u4e00\u4e2a\u89e3\u3002  \n   \n\u975e\u5e38\u5de7\u5730\uff0c\u6211\u4eec\u53d1\u73b0$10^9+7\\equiv3(\\text{mod}4)$\u3002\u8fd9\u6837\u4e00\u6765\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u4e0a\u9762\u7684\u6280\u5de7\u8f7b\u677e\u5f97\u5230\u60f3\u8981\u7684\u7ed3\u679c\u3002\u7136\u540e\u5c31\u662f\u7167\u7740\u516c\u5f0f\u8ba1\u7b97\u4e86\u3002  \n~~\u6240\u4ee5\u8bf4\u53ef\u4ee5\u628a\u6a21\u6570\u5f04\u5f97\u66f4\u5927\u4e00\u70b9~~",
        "postTime": 1546607805,
        "uid": 64366,
        "name": "ddwqwq",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5110 \u3010\u5757\u901f\u9012\u63a8\u3011"
    },
    {
        "content": "\u9898\u76ee\u7ed9\u51fa\u7684\u9012\u63a8\u5f0f\u660e\u663e\u8981\u77e9\u9635\u52a0\u901f\uff0c\u4e0d\u4f1a\u7684\u8f6c\u6a21\u677f\n\n\u4f46\u5e38\u89c4\u77e9\u9635\u52a0\u901f\u6548\u7387logn\uff0c\u6b64\u9898t\u975e\u5e38\u5927\u7acb\u523b\u5c31\u8d85\u65f6\n\n\u8003\u8651\u9884\u5904\u7406i<=k\u7684\u6240\u6709\u77e9\u9635a[i]\u4ee5\u53cak*i\u7684\u6240\u6709\u77e9\u9635b[i]\uff0c\u5219\u7b2cn\u9879\u53ef\u4ee5\u76f4\u63a5\u7531a[n%k]*b[n/k]\u6c42\u5f97\uff0c\u590d\u6742\u5ea6O(t+k+n/k)\uff0c\u5f53k\u53d6sqrt(n)\u65f6\u590d\u6742\u5ea6\u6700\u4f18\uff0c\u4e3aO(t+sqrt(n))\n\n\u7136\u800c\u6b64\u9898n\u8303\u56f4\u6781\u5927\uff0csqrt(n)\u4e00\u4e2a\u70b9\u90fd\u8fc7\u4e0d\u53bb\u3002\u6590\u6ce2\u90a3\u5951\u6570\u5217\u5bf9p\u53d6\u6a21\u65f6\u6709\u4e0d\u8d85\u8fc74p\u7684\u5faa\u73af\u8282(\u8bc1\u660e\u89c14000)\uff0c\u53ef\u4ee5\u731c\u60f3\uff0c\u5bf9\u4e8e\u6b64\u9898\u4e5f\u6709O(p)\u7684\u5faa\u73af\u8282\n\n\u66b4\u529b\u9012\u63a8\u53ef\u4ee5\u53d1\u73b0\u5faa\u73af\u8282\u957f\u5ea6\u4e3a(p-1)\uff0c\u6545\u76f4\u63a5\u5bf9(p-1)\u53d6\u6a21\uff0c\u590d\u6742\u5ea6O(t+sqrt(p))\uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\n\n\u7801\u98ce\u6781\u4e11\uff0c\u77e9\u4e58\u5faa\u73af\u5c55\u5f00\u4e86\n\n```cpp\n#include <stdio.h>\n#include <string.h>\ntypedef long long ll;\nconst int p=1e9+7,N=4e4;\nint t,i,ans,n,a,b,c,d;\nint ycl1[N+2][2][2],ycl2[N+2][2][2];\nnamespace Mker\n{\n    unsigned long long SA,SB,SC;\n    void init(){scanf(\"%llu%llu%llu\",&SA,&SB,&SC);}\n    unsigned long long rand()\n    {\n        SA^=SA<<32,SA^=SA>>13,SA^=SA<<1;\n        unsigned long long t=SA;\n        SA=SB,SB=SC,SC^=t^SA;return SC%(p-1);\n    }\n}\nint main()\n{\n    scanf(\"%d\",&t);\n    Mker::init();\n    ycl1[1][0][0]=233;ycl1[1][1][0]=666;ycl1[1][0][1]=1;\n    for (i=2;i<=N;i++)\n    {\n        ycl1[i][0][0]=((ll)ycl1[i-1][0][0]*ycl1[1][0][0]+(ll)ycl1[i-1][0][1]*ycl1[1][1][0])%p;\n        ycl1[i][1][0]=((ll)ycl1[i-1][1][0]*ycl1[1][0][0]+(ll)ycl1[i-1][1][1]*ycl1[1][1][0])%p;\n        ycl1[i][0][1]=((ll)ycl1[i-1][0][0]*ycl1[1][0][1]+(ll)ycl1[i-1][0][1]*ycl1[1][1][1])%p;\n        ycl1[i][1][1]=((ll)ycl1[i-1][1][0]*ycl1[1][0][1]+(ll)ycl1[i-1][1][1]*ycl1[1][1][1])%p;\n    }\n    ycl2[1][0][0]=ycl1[N][0][0];\n    ycl2[1][1][0]=ycl1[N][1][0];\n    ycl2[1][0][1]=ycl1[N][0][1];\n    ycl2[1][1][1]=ycl1[N][1][1];\n    for (i=2;i<=N;i++)\n    {\n        ycl2[i][0][0]=((ll)ycl2[i-1][0][0]*ycl2[1][0][0]+(ll)ycl2[i-1][0][1]*ycl2[1][1][0])%p;\n        ycl2[i][1][0]=((ll)ycl2[i-1][1][0]*ycl2[1][0][0]+(ll)ycl2[i-1][1][1]*ycl2[1][1][0])%p;\n        ycl2[i][0][1]=((ll)ycl2[i-1][0][0]*ycl2[1][0][1]+(ll)ycl2[i-1][0][1]*ycl2[1][1][1])%p;\n        ycl2[i][1][1]=((ll)ycl2[i-1][1][0]*ycl2[1][0][1]+(ll)ycl2[i-1][1][1]*ycl2[1][1][1])%p;\n    }\n    ycl1[0][0][0]=ycl1[0][1][1]=1;\n    ycl2[0][0][0]=ycl2[0][1][1]=1;\n    while (t--)\n    {\n        n=Mker::rand();\n        if (n==0) continue;\n        a=ycl1[n%N][0][0];b=ycl1[n%N][0][1];\n        ans^=((ll)a*ycl2[n/N][0][1]+(ll)b*ycl2[n/N][1][1])%p;\n    }\n    printf(\"%d\",ans);\n}\n```",
        "postTime": 1545486807,
        "uid": 29826,
        "name": "SSerxhs",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5110 \u3010\u5757\u901f\u9012\u63a8\u3011"
    }
]
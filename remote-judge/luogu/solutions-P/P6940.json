[
    {
        "content": "## \u524d\u8a00\uff1a\u8fd9\u9898\u771f\u662f\u626b\u63cf\u7ebf\u597d\u9898\uff01\n\n## $\\text{Solution}$\n\n\u5148\u79bb\u6563\u5316\u4e0b\u3002\n\n\u8003\u8651\u8d2a\u5fc3\uff0c\u6bcf\u6b21\u8ba9\u4e00\u4e2a\u53f3\u4e0b\u89d2\u5339\u914d\u5217\u6700\u8fd1\u7684\u5408\u6cd5\u5de6\u4e0a\u89d2\uff08\u5408\u6cd5\u6307\u7684\u662f\u884c\u5728\u5b83\u540c\u884c\u6216\u8005\u4e0a\u9762\uff09\n\n\u90a3\u4e48\u8fd9\u4e2a\u6837\u5b50\u5339\u914d\u51fa\u6765\u4e00\u5b9a\u662f\u6700\u4f18\u7684\uff0c\u5b9e\u73b0\u53ef\u4ee5\u7528\u4e2a set\u3002\n\n\u65e0\u89e3\u7684\u60c5\u51b5\uff1a\n\n1. \u4ecd\u6709\u4e00\u90e8\u5206\u53f3\u4e0b\u89d2\u65e0\u6cd5\u5339\u914d\u5230\u5de6\u4e0a\u89d2\n\n2. \u5982\u4f55\u5224\u65ad\u77e9\u5f62\u662f\u5426\u5d4c\u5957\u6216\u8005\u4e0d\u4ea4\u5462\uff1f\u8fd9\u5c31\u8981\u7528\u626b\u63cf\u7ebf\u4e86\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/nfd916d1.png)\n\n\u626b\u5230\u7ea2\u8272\u7684\u8fb9 $+1$ \uff0c\u7eff\u8272\u7684\u8fb9 $-1$ \u3002\n\n\u90a3\u4e48\u6211\u4eec\u5728\u67e5\u8be2\u5c0f\u77e9\u9635\u65f6\uff0c\u7b54\u6848\u662f\u4e0d\u662f $4$ \uff1f\u5373 $4$ \u4e2a\u9876\u70b9\u3002\u5728\u67e5\u8be2\u5927\u77e9\u9635\u7684\u65f6\u5019\u7b54\u6848\u4e5f\u662f $4$ \uff0c\u56e0\u4e3a\u5c0f\u77e9\u9635\u7684\u8d21\u732e\u5728\u7ecf\u8fc7\u7b2c\u4e09\u6761\u84dd\u8272\u8fb9\u4e4b\u540e\u5df2\u7ecf\u88ab\u6d88\u9664\u4e86\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5u678n9n.png)\n\n\u8003\u8651\u5d4c\u5957\uff0c\u6211\u4eec\u5728\u67e5\u8be2\u7b2c\u4e00\u4e2a\u77e9\u5f62\u7684\u8d21\u732e\u65f6\uff0c\u81ea\u7136\u5c31\u4e0d\u662f $4$ \u4e86\u3002\n\n\u53ef\u4ee5\u5f97\u5230\uff0c\u5047\u5982\u6211\u4eec\u5339\u914d\u65b9\u6848\u5408\u6cd5\uff0c\u90a3\u4e48\u4e00\u5b9a\u6ee1\u8db3\u626b\u63cf\u7ebf\u51fa\u6765\u7684\u7b54\u6848\u662f $4n$.\n\n\n## $\\text{Code}$\n```cpp\n#include <bits/stdc++.h>\n\n#define N (int)(4e5+5)\n#define fir first\n#define sec second\n#define IT set<pair<int,int> >::iterator\n#define ED return puts(\"syntax error\"),0;\n#define ll long long\n\nusing namespace std;\nint rd() {\n\tint f=1,sum=0; char ch=getchar();\n\twhile(!isdigit(ch)) {if(ch=='-') f=-1;ch=getchar();}\n\twhile(isdigit(ch)) {sum=(sum<<3)+(sum<<1)+ch-'0';ch=getchar();}\n\treturn sum*f;\n}\n\nstruct node {\n\tint x,y,id;\n\tbool operator < (const node &qwq) const {\n\t\treturn x<qwq.x;\n\t}\n}a[N],b[N];\n\npair<int,int>p[N];\nset<pair<int,int> >s;\nvector<int>d[N];\nvector<pair<int,int> >q[N];\nint n,m,c[N],match[N],tot,vcnt;\nIT it;\n\nll sum[N];\nint lowbit(int x) {\n\treturn x&(-x);\n}\n\nvoid add(int x,int v) {\n\twhile(x<N) sum[x]+=1ll*v,x+=lowbit(x);\n}\n\nint qry(int x) {\n\tint res=0;\n\twhile(x) res+=sum[x],x-=lowbit(x);\n\treturn res;\n}\n\nint main() {\n\tn=rd();\n\tfor(int i=1;i<=n;i++) a[i].x=rd(),a[i].y=rd(),a[i].id=i;\n\tfor(int i=1;i<=n;i++) b[i].x=rd(),b[i].y=rd(),b[i].id=i;\n\tfor(int i=1;i<=n;i++) p[++tot]=make_pair(a[i].x,i),p[++tot]=make_pair(b[i].x,i+n);\n\tsort(p+1,p+1+tot);\n\tfor(int i=1;i<=tot;i++) {\n\t\tif(p[i].sec<=n) a[p[i].sec].x=p[i].fir==p[i-1].fir?vcnt:++vcnt;\n\t\telse b[p[i].sec-n].x=p[i].fir==p[i-1].fir?vcnt:++vcnt; \n\t}\n\ttot=vcnt=0;\n\tfor(int i=1;i<=n;i++) p[++tot]=make_pair(a[i].y,i),p[++tot]=make_pair(b[i].y,i+n);\n\tsort(p+1,p+1+tot);\n\tfor(int i=1;i<=tot;i++) {\n\t\tif(p[i].sec<=n) a[p[i].sec].y=p[i].fir==p[i-1].fir?vcnt:++vcnt;\n\t\telse b[p[i].sec-n].y=p[i].fir==p[i-1].fir?vcnt:++vcnt;\n\t} \n\tsort(a+1,a+1+n); sort(b+1,b+1+n);\n\tint j=1;\n\tfor(int i=1;i<=n;i++) {\n\t\twhile(j<=n&&a[j].x<=b[i].x) s.insert(make_pair(a[j].y,j)),++j;\n\t\tit=s.upper_bound(make_pair(b[i].y,n));\n\t\tif(it==s.begin()) ED;\n\t\tc[i]=(--it)->sec; s.erase(it);\n\t}\n\tfor(int i=1;i<=n;i++) {\n\t\td[a[c[i]].x].push_back(b[i].y); d[b[i].x+1].push_back(-b[i].y);\n\t\td[a[c[i]].x].push_back(a[c[i]].y); d[b[i].x+1].push_back(-a[c[i]].y); \n\t\tq[a[c[i]].x].push_back(make_pair(a[c[i]].y,b[i].y));\n\t\tq[b[i].x].push_back(make_pair(a[c[i]].y,b[i].y));\n\t}\n\tll res=0;\n\tfor(int i=1;i<=2*n;i++) {\n\t\tfor(int j=0;j<d[i].size();j++) {\n\t\t\tint qwq=d[i][j];\n\t\t\tif(qwq>0) add(qwq,1);\n\t\t\telse add(-qwq,-1);\n\t\t}\n\t\tfor(int j=0;j<q[i].size();j++) {\n\t\t\tres+=qry(q[i][j].sec)-qry(q[i][j].fir-1);\n\t\t}\n\t}\n\tif(res!=1ll*4*n) ED;\n\tfor(int i=1;i<=n;i++) match[a[c[i]].id]=b[i].id;\n\tfor(int i=1;i<=n;i++) printf(\"%d\\n\",match[i]);\n\treturn 0;\n} \n```",
        "postTime": 1626150562,
        "uid": 125901,
        "name": "FxorG",
        "ccfLevel": 7,
        "title": "P6940 [ICPC2017 WF]Visual Python++"
    }
]
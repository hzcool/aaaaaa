[
    {
        "content": "[link](https://www.luogu.com.cn/problem/P2334) & [\u535a\u5ba2\u56ed\u98df\u7528](https://www.cnblogs.com/dai-se-can-tian/p/16450595.html)\n\n\u8fd9\u79cd\u505a\u6cd5\u9700\u8981\u5438\u6c27\u624d\u80fd\u901a\u8fc7\uff0c\u4e0d\u662f\u6b63\u89e3\uff0c\u6240\u4ee5\u53ea\u662f\u63d0\u4f9b\u4e00\u79cd\u9898\u89e3\u533a\u8fd8\u6ca1\u6709\u7684\u601d\u8def\u3002\n\n\u53ef\u4ee5\u7528\u5206\u5c42\u56fe\u7684\u601d\u8def\u6765\u505a\u8fd9\u9053\u9898\u3002\u6bcf\u6b21\u4ece\u4e00\u4e2a\u65b9\u683c\u8f6c\u79fb\u5230\u53e6\u4e00\u4e2a\u65b9\u683c\u65f6\u65f6\u95f4\u90fd\u53d1\u751f\u4e86\u6539\u53d8\uff0c\u65f6\u95f4\u7684\u6539\u53d8\u53ef\u4ee5\u770b\u6210\u662f\u4e0d\u540c\u5c42\u6b21\u7684\u56fe\u4e4b\u95f4\u7684\u8f6c\u79fb\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u6309\u7167\u9898\u610f\u5728\u76f8\u90bb\u7684\u4e24\u5c42\u56fe\u4e4b\u95f4\u8fde\u8fb9\u8dd1\u6700\u77ed\u8def\u5373\u53ef\u3002\u663e\u7136\u5047\u5982\u6240\u6709\u65b9\u5757\u7684\u5468\u671f\u7684\u6700\u5c0f\u516c\u500d\u6570\u662f $lcm$ \uff0c\u90a3\u4e48\u6240\u6709\u4f4d\u7f6e\u76f8\u540c\u3001\u65f6\u95f4\u6a21\u8fd9\u4e2a\u516c\u500d\u6570\u76f8\u540c\u7684\u72b6\u6001\u5728\u8f6c\u79fb\u4e0a\u662f\u5b8c\u5168\u4e00\u6837\u7684\uff0c\u53ef\u4ee5\u770b\u6210\u662f\u540c\u4e00\u4e2a\u72b6\u6001\uff0c\u6240\u4ee5\u7b2c $lcm-1$ \u5c42\u56fe\u5e94\u8be5\u5411\u7b2c $0$ \u5c42\u56fe\u8fde\u8fb9\u3002\u5176\u5b83\u6709\u4e9b\u7ec6\u8282\u6bd4\u5982\u5efa\u7acb\u8d85\u7ea7\u6e90\u70b9\uff08\u5b83\u53ef\u4ee5\u4e00\u76f4\u5446\u5728\u6700\u5f00\u59cb\u8282\u70b9\u4e0a\u4e0d\u51fa\u53bb\uff09\u548c\u8d85\u7ea7\u6c47\u70b9\u65b9\u4fbf\u6572\u4ee3\u7801\u5c31\u662f\u5206\u5c42\u56fe\u7684\u57fa\u672c\u64cd\u4f5c\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\n//#define feyn\n#define p(a,b) (a*(m+2)+b+2)\nconst int N=3000010;\nconst int M=1010;\nconst int R=12;\nusing namespace std;\ninline void read(int &wh){\n\twh=0;int f=1;char w=getchar();\n\twhile(w<'0'||w>'9'){if(w=='-')f=-1;w=getchar();}\n\twhile(w<='9'&&w>='0'){wh=wh*10+w-'0';w=getchar();}\n\twh*=f;return;\n}\n\ninline int gcd(int s1,int s2){\n\treturn s2==0?s1:gcd(s2,s1%s2);\n}\ninline int lcm(int s1,int s2){\n\treturn s1*s2/gcd(s1,s2);\n}\n\nint m,lc=1,num[M],a[M][R];\n\nstruct edge{\n\tint t,v,next;\n}e[N*3];\nint head[N],esum;\ninline void add(int fr,int to,int val){\n\te[++esum]=(edge){to,val,head[fr]};head[fr]=esum;\n}\n\nint dis[N];\nbool vis[N];\nstruct node{\n\tint pl,dis;\n};\ninline bool operator <(node s1,node s2){\n\treturn s2.dis<s1.dis;\n}\npriority_queue<node>q;\n\nsigned main(){\n\t\n\t#ifdef feyn\n\tfreopen(\"in.txt\",\"r\",stdin);\n\t#endif\n\t\n\tread(m);\n\tfor(int i=1;i<=m;i++){\n\t\tread(num[i]);lc=lcm(lc,num[i]);\n\t\tfor(int j=0;j<num[i];j++)read(a[i][j]);\n\t}\n\tnum[0]=num[m+1]=1;\n\t//0 to 1\n\t//S to 0\n\t//m+1 to T\n\tfor(int i=0;i<lc;i++){\n\t\tadd(0,p(i,0),0);\n\t\tadd(p(i,(m+1)),1,0);\n\t\tint nt=(i+1)%lc;\n\t\tadd(p(i,0),p(nt,1),a[1][nt%num[1]]);\n\t}\n\tfor(int i=1;i<=m;i++){\n\t\tfor(int t=0;t<lc;t++){\n\t\t\tint nt=(t+1)%lc;\n\t\t\tadd(p(t,i),p(nt,i),a[i][nt%num[i]]);\n\t\t\tadd(p(t,i),p(nt,i+1),a[i+1][nt%num[i+1]]);\n\t\t\tadd(p(t,i),p(nt,i-1),a[i-1][nt%num[i-1]]);\n\t\t}\n\t}\n\t\n\tmemset(dis,0x3f,sizeof(dis));\n\tdis[0]=0;q.push((node){0,0});\n\twhile(!q.empty()){\n\t\tnode now=q.top();q.pop();\n\t\tint wh=now.pl,nd=now.dis;\n\t\tif(vis[wh])continue;vis[wh]=true;\n\t\tfor(int i=head[wh],th;i;i=e[i].next){\n\t\t\tint nval=dis[wh]+e[i].v;th=e[i].t;\n\t\t\tif(nval<dis[th]){\n\t\t\t\tdis[th]=nval;q.push((node){th,dis[th]});\n\t\t\t}\n\t\t}\n\t}\n\t\n\tprintf(\"%d\",dis[1]);\n\t\n\treturn 0;\n}\n```",
        "postTime": 1657088711,
        "uid": 302383,
        "name": "Feyn",
        "ccfLevel": 0,
        "title": "P2334"
    }
]
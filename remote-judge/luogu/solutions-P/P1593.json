[
    {
        "content": "[\u535a\u5ba2\u4f20\u9001\u95e8](https://dgsyrc.github.io/2020/05/06/%E6%B4%9B%E8%B0%B7%E9%A2%98%E8%A7%A3%20P1593%20%E3%80%90%E5%9B%A0%E5%AD%90%E5%92%8C%E3%80%91/#more)\r\n\r\n#### \u9898\u610f\u7b80\u8ff0\uff1a\r\n\r\n\u6c42$a^b$\u7684\u6240\u6709\u56e0\u5b50\u548c\r\n\r\n#### \u89e3\u9898\u601d\u8def\uff1a\r\n\r\n\u65e2\u7136\u8981\u6c42\u56e0\u5b50\u548c\uff0c\u90a3\u6211\u4eec\u5fc5\u7136\u8981\u5148\u5206\u89e3\u8d28\u56e0\u6570\r\n\r\n\u6839\u636e\u6574\u6570\u7684\u552f\u4e00\u5206\u89e3\u5b9a\u7406\uff0c\u6574\u6570a\u8fdb\u884c\u8d28\u56e0\u6570\u5206\u89e3\u5bf9\u5e94\u7684\u5f0f\u5b50\u552f\u4e00\uff0c\u6709:\r\n\r\n$$a = p_1^{k_1} * p_2^{k_2} *p_3^{k_3}* \u2026 * p_n^{k_n}$$\r\n\r\n\u53c8\u56e0\u4e3a\u672c\u9898\u8981\u5206\u89e3\u7684\u662f$a^b$\uff0c\u6240\u4ee5\u4e0a\u9762\u7684\u5f0f\u5b50\u53c8\u53ef\u4ee5\u5199\u6210\u8fd9\u6837\uff1a\r\n\r\n$$a^b= p_1^{k_1*b} * p_2^{k_2*b} *p_3^{k_3*b}* \u2026 * p_n^{k_n*b}$$\r\n\r\n\u8bc1\u660e\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u628a\u4e0a\u9762\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u4e58\u4e0a$b$\u6b21\u5373\u53ef\u5f97\u7b2c\u4e8c\u4e2a\u5f0f\u5b50\r\n\r\n\u63a5\u4e0b\u6765\u6211\u4eec\u8981\u6c42\u7684\u662f\u56e0\u5b50\u548c\uff0c\r\n\r\n\u6240\u4ee5\u5c31\u6709\uff1a\r\n\r\n$$ans= (1+p_1^1 + p_1^2 +p_1^3+ \u2026 + p_1^{k_1*b})*(1+p_2^1 + p_2^2 +p_2^3+ \u2026 + p_1^{k_2*b})*...*(1+p_n^1 + p_n^2 +p_n^3+ \u2026 + p_n^{k_n*b})$$\r\n\r\n\u5bf9\u4e8e\u4e0a\u9762\u7684\u5f0f\u5b50\u662f\u4e0d\u662f\u6709\u70b9\u719f\u6089\uff1f\r\n\r\n\u5bf9\uff0c\u4f60\u6ca1\u6709\u770b\u9519\uff0c\u5c31\u662f\u7b49\u6bd4\u6570\u5217\u4e4b\u95f4\u7684\u4e58\u79ef\r\n\r\n\u6839\u636e\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u516c\u5f0f\uff1a\r\n\r\n$$sum=\\frac{p^{n}-1}{p-1}$$\r\n\r\n\u6211\u4eec\u5c31\u80fd\u6c42\u51fa\u5404\u6570\u5217\u7684\u548c\uff0c\r\n\r\n\u5bf9\u4e8e$p^{n+1}$\uff0c\u6211\u4eec\u7528\u5feb\u901f\u5e42\u6c42\r\n\r\n\u53c8\u56e0\u4e3a\u672c\u9898\u8981\u6c42\u7684\u7b54\u6848\u8981\u5bf99901\u53d6\u6a21\r\n\r\n\u6545\u6211\u4eec\u53c8\u53ef\u4ee5\u901a\u8fc7\u9006\u5143\u5c06\u9664$p-1$\u8f6c\u5316\u4e3a\u4e58$p-1$\u7684\u9006\u5143\r\n\r\n\u63a5\u4e0b\u6765\u8981\u6c42\u9006\u5143\uff0c\u6839\u636e\u5b9a\u4e49\uff0c\u5728$mod\\ p$\u7684\u610f\u4e49\u4e0b\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u6574\u6570$a$\uff0c\u6709\uff1a\r\n\r\n$$a*x\u22611(mod\\ p)$$\r\n\r\n$x$\u5373\u4e3a$a$\u7684\u9006\u5143\uff0c\u53cd\u4e4b\u6210\u7acb\r\n\r\n\u6ce8\u610f\u6b64\u5904\u7684$a,p$\u5747\u4e0e\u4e0a\u6587\u7684\u610f\u4e49\u4e0d\u540c\uff0c\u4ec5\u4f5c\u4e3a\u516c\u5f0f\u4e2d\u7684\u672a\u77e5\u6570\r\n\r\n\u5f53$a,p$\u4e0d\u4e92\u8d28\u65f6\uff0c\u9006\u5143\u4e0d\u5b58\u5728\uff0c\u5373\u4e0a\u9762\u7684\u5f0f\u5b50\u8981\u6ee1\u8db3\uff1a\r\n\r\n$$gcd(a,p)=1$$\r\n\r\n\u90a3\u4e48\u8fd9\u4e2a$x$\u600e\u4e48\u6c42\uff1f\r\n\r\n\u90a3\u6211\u4eec\u518d\u5f15\u5165\u4e00\u4e2a\u5b9a\u7406\uff0c\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff1a\r\n\r\n\u5047\u5982$a$\u662f\u4e00\u4e2a\u6574\u6570\uff0c$p$\u662f\u4e00\u4e2a\u8d28\u6570\uff0c\u90a3\u4e48\u5f53$a$\u662f$p$\u7684\u500d\u6570\u65f6\uff0c\u6709\uff1a\r\n\r\n$$a^p\u2261a(mod\\ p)$$\r\n\r\n\u5f53$a$\u4e0d\u662f$p$\u7684\u500d\u6570\u65f6\uff0c\u6709\uff1a\r\n\r\n$$a^{p-1}\u22611(mod\\ p)$$\r\n\r\n\u5bf9\u4e8e\u672c\u9898\uff0c\u663e\u7136\u6211\u4eec\u8981\u7528\u7684\u662f\u7b2c\u4e8c\u79cd\u60c5\u51b5\uff0c\u7b2c\u4e8c\u79cd\u60c5\u51b5\u53c8\u53ef\u4ee5\u53d8\u5f62\u4e3a\uff1a\r\n\r\n$$a*a^{p-2}\u22611(mod\\ p)$$\r\n\r\n\u4e0a\u5f0f\u6070\u597d\u5bf9\u5e94\u9006\u5143\u7684\u5b9a\u4e49\u5f0f\uff0c\u6545$a$\u5728$mod\\ p$\u610f\u4e49\u4e0b\u7684\u9006\u5143\u4e3a$a^{p-2}$\r\n\r\n$a^{p-2}$\u6211\u4eec\u7528\u5feb\u901f\u5e42\u5373\u53ef\u6c42\u5f97\r\n\r\n\u90a3\u9006\u5143\u4e0d\u5b58\u5728\u600e\u4e48\u529e\uff0c\u4e0d\u7528\u62c5\u5fc3\uff0c\u56e0\u4e3a\u5bf9\u5e94\u4e0a\u9762\u7684\u5f0f\u5b50$p-1$\uff0c\u6709\uff1a\r\n\r\n$$(p-1) \\ mod \\ 9901=0$$\r\n\r\n\u5373:\r\n\r\n$$p \\ mod \\ 9901=1$$\r\n\r\n\u6240\u4ee5\u8be5\u7b49\u6bd4\u6570\u5217\u4e4b\u548c($mod\\ p$\u610f\u4e49\u4e0b)\u4e3a\uff1a\r\n\r\n$$sum= 1+({p\\ mod\\ 9901})^1 +({p\\ mod\\ 9901})^2 +({p\\ mod\\ 9901})^3+ \u2026 + ({p\\ mod\\ 9901})^{n}$$\r\n\r\n\u5373\uff1a\r\n\r\n$$sum=1+n$$\r\n\r\n\u81f3\u6b64\uff0c\u672c\u9898\u5c31\u5206\u6790\u5b8c\u4e86\r\n\r\n#### \u4ee3\u7801\u5b9e\u73b0\uff1a\r\n\r\n```cpp\r\n#include<iostream>\r\n#include<cstdio>\r\n#define mod 9901\r\nusing namespace std;\r\n\r\nint a,b,sa,n[10010][2],cot=0,ans=1;\r\n\r\nint quick_pow(int ml,int nl)//\u5feb\u901f\u5e42\r\n{\r\n\tint s=1;\r\n\twhile(nl>0)\r\n\t{\r\n\t\tif(nl%2==1)\r\n\t\t{\r\n\t\t\ts=(s%mod)*(ml%mod)%mod;\r\n\t\t}\r\n\t\tml=ml*ml%mod;\r\n\t\tnl=nl>>1;\r\n\t}\r\n\treturn s%mod;\r\n}\r\n\r\nint sum(int x,int y)\r\n{\r\n\tint k=0;\r\n\ty=y*b;\r\n\tif(x%mod==1)\r\n\t{\r\n\t\tk=(y+1)%mod;//\u5f53\u9006\u5143\u4e0d\u5b58\u5728\u65f6\r\n\t}\r\n\telse\r\n\t{\r\n\t\tk=(quick_pow(x%mod,y+1)-1)%mod*quick_pow((x-1)%mod,mod-2)%mod;//\u5f53\u9006\u5143\u5b58\u5728\u65f6\r\n\t}\r\n\t\r\n\treturn k%mod;\r\n}\r\n\r\nint main()\r\n{\r\n\tscanf(\"%d%d\",&a,&b);\r\n\tif(a==0)//\u7279\u5224\uff0c0\u7684\u56e0\u6570\u548c\u5c31\u662f0\r\n\t{\r\n\t\tprintf(\"0\\n\");\r\n\t\treturn 0;\r\n\t}\r\n\tfor(int i=2;i*i<=a;i++)//\u5206\u89e3\u8d28\u56e0\u6570\r\n\t{\r\n\t\tif(a%i==0)\r\n\t\t{\r\n\t\t\tcot++;\r\n\t\t\tn[cot][0]=i;//\u8bb0\u5f55\u8d28\u56e0\u6570\r\n\t\t\tn[cot][1]=1;//\u8bb0\u5f55\u5e42\u6b21\r\n\t\t\ta=a/i;\r\n\t\t\twhile(a%i==0)\r\n\t\t\t{\r\n\t\t\t\tn[cot][1]++;//\u8bb0\u5f55\u5e42\u6b21\r\n\t\t\t\ta=a/i;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(a!=1)//\u53ef\u80fda\u4ecd\u4e3a\u56e0\u5b50\r\n\t{\r\n\t\tcot++;\r\n\t\tn[cot][0]=a;\r\n\t\tn[cot][1]=1;\r\n\t}\r\n\tfor(int i=1;i<=cot;i++)\r\n\t{\r\n\t\tans=ans*sum(n[i][0],n[i][1])%mod;\r\n\t}\r\n\tprintf(\"%d\\n\",(ans%mod+mod)%mod);\r\n\treturn 0;\r\n}\r\n```\r\n\u6709\u7528\u7684\u8bdd\u70b9\u4e2a\u8d5e\u9876\u4e0a\u53bb\u624d\u80fd\u8ba9\u66f4\u591a\u4eba\u770b\u5230\u54e6QAQ",
        "postTime": 1588743225,
        "uid": 89910,
        "name": "C_Cong",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P1593 \u3010\u56e0\u5b50\u548c\u3011"
    },
    {
        "content": "\u9898\u610f\u5373\u6c42 $a^b$ \u7684\u6240\u6709\u56e0\u5b50\uff08\u5305\u62ec $1$ \u4ee5\u53ca $a,a^b$ \u7b49\uff09\u7684\u548c $\\mathbf{res}$ \uff0c\u66b4\u529b\u679a\u4e3e\u5728\u8fd9\u4e48\u5927\u7684\u8303\u56f4\u4e0b\u663e\u7136\u884c\u4e0d\u901a\uff0c\u5219\u53ef\u4ee5\u8003\u8651\u5206\u89e3\u8d28\u56e0\u5b50\uff0c\u7136\u540e\u6c42\u548c\u3002\n\n$$a^b=p_1^{c_1}\\cdot p_2^{c_2}\\cdot  p_3^{c_3}\\cdots  p_n^{c_n} \\to $$\n$$res=(1+p_1^{1}+p_1^{2}+\\cdots+p_1^{c_1})\\cdot(1+p_2^{1}+p_2^{2}+\\cdots+p_2^{c_2})\\cdots(1+p_n^{1}+p_n^{2}+\\cdots+p_n^{c_n})$$\n\n\u4e3a\u4ec0\u4e48\uff1f\u53ef\u4ee5\u62c6\u62ec\u53f7\u6c42\u8bc1\u3002\u5bf9\u4e8e $6^2=2^2\\cdot3^2$ \u800c\u8a00\uff0c\u5171\u6709 $1,2,3,4,6,9,12,18,36$ \u8fd9\u51e0\u4e2a\u56e0\u5b50\uff0c\u5219\uff1a\n$$res=(1+2+2^2)\\cdot(1+3+3^2)=1+3+9+2+6+18+4+12+36$$\n\n\u90a3\u4e48\u73b0\u5728\u5c31\u53ea\u9700\u8981\u9009\u62e9\u65f6\u95f4\u590d\u6742\u5ea6\u66f4\u5c0f\u7684\u7b97\u6cd5\uff0c\u89e3\u51b3\u53d6\u6a21\u95ee\u9898\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\u7ed3\u679c\u7684\u6bcf\u4e2a\u56e0\u5f0f\u90fd\u662f\u7b49\u6bd4\u6570\u5217\u7684\u548c\uff0c\u5219\u4f7f\u7528$S_n=\\frac{a_1\\cdot(1-q^n)}{1-q}=(p_i^{c_i+1}-1)/(p_i-1)$\u548c\u5feb\u901f\u5e42\u3001\u9006\u5143\u6c42\u548c\u3002\n\n - $\\mathbf{S_n}$\u662f\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u516c\u5f0f\uff0c\u9ad8\u4e2d\u5fc5\u4fee\u4e94\u5185\u5bb9\uff0c\u5efa\u8bae\u63d0\u524d\u4e86\u89e3\u3002\uff08$a_1$ \u4e3a\u9996\u9879\uff0c$n$ \u4e3a\u9879\u6570\uff0c$q$ \u4e3a\u516c\u5dee\uff09\n \n - **\u5feb\u901f\u5e42**\u53ef\u5feb\u901f\u7b97\u5e95\u6570\u7684N\u6b21\u5e42\uff0c\u5176\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\Theta(logN)$ \uff0c\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u500d\u589e\u5feb\u901f\u5e42\u5747\u53ef\u3002\n \n - **\u9006\u5143**\uff1a\n \n \u8bbe $c$ \u4e3a $b$ \u7684\u9006\u5143\uff08\u5728 $b$ \u4e0e $P$ \u4e92\u8d28\u7684\u60c5\u51b5\u4e0b\uff09\uff0c\u5219\u6709 $b\\cdot c \\equiv 1~\\pmod P$ \uff0c\u8bb0\u4e3a $c=b^{-1}$ .\n \n \u90a3\u4e48 $(a/b)\\%P=(a\\cdot c)\\%P$ .\n \n \u53ef\u4ee5\u4f7f\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\uff0c\u8d39\u9a6c\u5c0f\u5b9a\u7406\u6216\u7ebf\u6027\u9012\u63a8\u6cd5\u6c42\u89e3\u3002\u6269\u6b27\u4e00\u822c\u800c\u8a00\u4f1a\u5feb\u4e00\u70b9\uff0c\u7136\u800c\u901a\u8fc7\u8d39\u9a6c\u53ef\u4ee5\u63a8\u51fa $$b^{P-1}\\equiv 1~~\\to~~b^{P-2}\\equiv b^{-1} \\pmod P~~\\to~~b^{-1}=b^{P-2}$$\n \u90a3\u5c31\u4e00\u8d77\u7528\u5feb\u901f\u5e42\u53ef\u4ee5\u7b97\u554a 233\n \n\u7136\u540e\uff0c\u5c31\u53ef\u4ee5\u6109\u5feb\u5730\u5f00\u59cb\u5199\u4ee3\u7801\u4e86\n\n***\n\u771f\u7684\u5417\uff1f[\u770b\u8fd9\u91cc](https://www.luogu.org/discuss/show?postid=52258) [\u4ee5\u53ca\u8fd9\u91cc](https://www.luogu.org/discuss/show?postid=52497)\n\n\u518d\u770b\u4e00\u4e0b\u9006\u5143\u7684\u6027\u8d28orz\uff1a\n>\u5728 $b$ \u4e0e $P$ \u4e92\u8d28\u7684\u60c5\u51b5\u4e0b\n\n\u7136\u540e\u4f60\u5c31\u53ef\u4ee5\u53d1\u73b0\uff0c$p_i$ \u4e0e $9901$ \u4e92\u8d28\u65f6\u6c42\u51fa\u6765\u7684\u9006\u5143\u5f88\u5947\u602a\uff0c\u6bd4\u5982\u4e3a $0$\uff08\u56e0\u4e3a\u5b83\u5e76\u4e0d\u5b58\u5728\uff09\n\n\u90a3\u53c8\u8be5\u600e\u4e48\u529e\uff1f\u56de\u5230\u6700\u5f00\u59cb\u7684\u7ed3\u679c\u5f0f\uff0c\u53ef\u4ee5\u53d1\u73b0$(1+p_i^{1}+p_i^{2}+\\cdots+p_i^{c_i})\\%P=(1+1+1+\\cdots+1)=c_i+1$ \uff0c\u7279\u5224\u5373\u53ef\u3002\n\n\u4e0b\u9762\u5c31\u662f**\u771f\u7684**\u6109\u5feb\u4ee3\u7801\u65f6\u95f4\n\n```cpp\n#include<cstdio>\n#include<cmath>\n#define MOD 9901\nusing namespace std;\n//typedef long long ll;\nlong long mod=0,to[2],get=1;\n\nll ppo(ll x,ll p){//\u5feb\u901f\u5e42\n    ll t=x,res=1;\n    while(p){\n        if(p&1)res=(res*t)%MOD;\n        t=(t*t)%MOD;\n        p>>=1;\n    }\n    return res;\n}\n\nint main(){\n    long long a,b,tmp,lim;\n    scanf(\"%lld%lld\",&a,&b);\n    lim=sqrt(a);\n    for(ll i=2;i<=lim;i++){//2->\u5f53\u524d\u9700\u8981\u5206\u89e3\u7684\u6570\n        if(!(a%i)){\n            tmp=0;\n            while(!(a%i)){a/=i;tmp++;}\n            to[1]=(tmp*b+1);\n            if(i%MOD==1)get=get*(tmp+1)%MOD;\n            else {to[0]=i%MOD;get=get*(ppo(to[0],to[1])-1)*ppo(to[0]-1,MOD-2)%MOD;}\n        }\n    }\n    if(a!=1){//\u5269\u4e0b\u7684\u8f83\u5927\u8d28\u56e0\u6570\n        to[1]=(b+1);\n        if(a%MOD==1)get=get*(b+1)%MOD;\n        else{to[0]=a%MOD;get=get*(ppo(to[0],to[1])-1)*ppo(to[0]-1,MOD-2)%MOD;}\n    }\n    printf(\"%lld\",get);\n    return 0;\n}\n```",
        "postTime": 1533304367,
        "uid": 47366,
        "name": "\u5c0f\u8001\u864e3018",
        "ccfLevel": 7,
        "title": "\u6709\u8da3\u7684\u56e0\u5b50\u548c"
    },
    {
        "content": "\u770b\u4e86\u770b\u697c\u4e0a\u548c\u697c\u4e0b\u7684\u4ee3\u7801\uff0c\u611f\u89c9\u90fd\u633a\u590d\u6742\u7684\u3002  \n\n\u5b9e\u9645\u4e0a\u8fd9\u9898\u5e76\u4e0d\u9700\u8981\u90a3\u4e48\u957f\u7684\u4ee3\u7801\u300212 \u884c\u5c31\u591f\u4e86QwQ\u3002  \n\n### Solution\n\u8981\u6c42 $a^b$ \u7684\u56e0\u5b50\u548c\u3002  \n\n\u9996\u5148\uff0c\u6211\u4eec\u6709\u4e00\u4e2a\u7ed3\u8bba\u3002  \n\n\u5047\u8bbe\u4e00\u4e2a\u6570 $a=a_1^{p_1}\\times a_2^{p_2}\\times...\\times a_n^{p_n}$  \n\u90a3\u4e48\u5b83\u7684\u56e0\u5b50\u4e4b\u548c\u4e3a $(1+a_1+a_1^2+...+a_1^{p_1})\\times(1+a_2+...+a_2^{p_2})\\times...\\times(1+a_n+...+a_n^{p_n})$  \n\n\u7136\u540e\u53ef\u4ee5\u7528\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u516c\u5f0f\u53d8\u6210 $\\frac{a_1^{p_1+1}-1}{a_1-1}\\times...\\times\\frac{a_n^{p_n+1}-1}{a_n-1}$\n\n\u6240\u4ee5\u6211\u4eec\u9700\u8981\u77e5\u9053\u7684\u662f $a_i^{p_i+1}-1$\u548c$\\frac{i}{a_i-1}$  \n\n\u524d\u9762\u90a3\u4e2a\u53ef\u4ee5\u7528\u88f8\u7684\u5feb\u901f\u5e42\u6765\u6c42\uff0c\u540e\u9762\u90a3\u4e2a\u53ef\u4ee5\u7528\u8d39\u9a6c\u5c0f\u5b9a\u7406\u6765\u6c42\u3002  \n\n\u90a3\u4e48 $a^b$ \u4e5f\u662f\u4e00\u6837\u7684\u3002  \n\n$a=a_1^{p_1}\\times a_2^{p_2}\\times...\\times a_n^{p_n}$\uff0c\u90a3\u4e48 $a^b=a_1^{p_1\\times b}\\times...\\times a_n^{p_n\\times b}$  \n\n~~\u7136\u540e\u8fd9\u9898\u5c31\u505a\u5b8c\u4e86\u3002~~  \n\n[\u505a\u5b8c\u4e2a*](https://www.luogu.com.cn/record/29826486)  \n\n\u53ef\u601c\u7684\u7b14\u8005\u5c31\u8fd9\u6837\u5199\u4e86\u4e00\u4efd\u8fd9\u6837\u7684\u4ee3\u7801\uff0c\u7ed3\u679cWA2\u4e2a\u70b9\u3002  \n\n\u7136\u540e\u7b14\u8005\u5c31\u7ffb\u4e86\u7ffb\uff0c\u7ffb\u5230\u4e86\u4e4b\u524d\u7684\u4e00\u4e2a[\u5e16\u5b50](https://www.luogu.com.cn/discuss/show/151677)  \n\n\u6240\u4ee5\u5173\u4e8e\u4e0a\u9762\u90a3\u4e2a\u8d39\u9a6c\u5c0f\u5b9a\u7406\u6765\u6c42\u9006\u5143\u7684\u90a3\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0 $a_i-1$ \u4e0d\u4e00\u5b9a\u6709\u9006\u5143\uff0c\u8fd9\u91cc\u9700\u8981\u6709\u4e00\u4e2a\u7279\u5224\u3002  \n\n\u7136\u540e\u8fd9\u9898\u5c31\u505a\u5b8c\u4e86\u3002  \n\n### Coding\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint a,b,s,e,P=9901;\ninline int qpow(int x,int q=P-2) {int r=1;for(;q;q>>=1,x=x*x%P) if(q&1) r=r*x%P;return (r+P)%P;}\nsigned main()\n{\n    scanf(\"%lld%lld\",&a,&b),s=1,e=sqrt(a);\n    for(int i=2,t=0;i<=e;i++,t=0) {while(a%i==0) a/=i,t++;t*=b,s=s*(i%P!=1?(qpow(i,t+1)-1)%P*qpow(i-1)%P:(t+1)%P)%P;}\n    if(a>1) s=s*(a%P!=1?(qpow(a,b+1)-1)%P*qpow(a-1)%P:2);\n    return printf(\"%lld\\n\",(s+P)%P),0;\n}\n```\n\n\u8f7b\u5fae\u538b\u884c\uff0c\u52ff\u55b7![](https://upload.orzsiyuan.com/images/emotions/kk.png)  ",
        "postTime": 1580284090,
        "uid": 44805,
        "name": "Leap_Frog",
        "ccfLevel": 7,
        "title": "P1593\u56e0\u5b50\u548c\uff08\u9898\u89e3\uff09"
    },
    {
        "content": "n\u8d28\u56e0\u6570\u5206\u89e3\u540e\u5199\u6210$p1^{c1}* p2^{c2}* ...* pn^{cn}$\n\n\u5219\u56e0\u5b50\u548c\u4e3a$(p1^0+p1^1+...+p1^{c1})*(p2^0+p2^1+...+p2^{c2})$\n\n$*...*(pn^0+pn^1+...+pn^{cn})$\n\n\u63a5\u4e0b\u6765\u7528\u5206\u6cbb\u6cd5\u6c42\u7b49\u6bd4\u6570\u5217\u548c\u3002\n\n\u4e0a\u4ee3\u7801\uff1a\n\n```\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nll a,b,ans=1,mod=9901;\nll ksm(ll x,ll y){//\u5feb\u901f\u5e42\n\tll res=1;\n\twhile(y){\n\t\tif(y%2==1)res=res*x%mod;\n\t\tx=x*x%mod;\n\t\ty/=2;\n\t}\n\treturn res;\n}\nll sum(ll x,ll y){//\u7b49\u6bd4\u6570\u5217\u548c\n\tif(x==0)return 1;\n\tif(x%2==1)return sum(x/2,y)*(1+ksm(y,x/2+1))%mod;\n    //\u5076\u6570\u9879\uff0c\u5206\u4e24\u90e8\u5206\u7b97\uff08\u540e\u534a\u5c31\u662f\u524d\u534a\u4e58y^(x/2+1)\uff09\n\treturn (sum(x/2-1,y)*(1+ksm(y,x/2+1))+ksm(y,x/2))%mod;\n    //\u5947\u6570\u9879\uff0c\u52a0\u4e0a\u4e2d\u95f4\u4e00\u9879\n  //\u56e0\u7b97\u4e86y^0\uff0c\u6240\u4ee5x%2==1\u662f\u5076\u6570\u9879\n}\nint main (){\n\tcin>>a>>b;\n\tfor(int i=2;i<=sqrt(a);i++){//\u8d28\u56e0\u6570\u5206\u89e3\n\t\tint c=0;\n\t\twhile(a%i==0){\n\t\t\ta/=i;\n\t\t\tc++;\n\t\t}\n\t\tans=ans*sum(c*b,i)%mod;\n\t}\n\tif(a!=1)\n\tans=ans*sum(b,a)%mod;\n\tcout<<ans;\n}\n```\n",
        "postTime": 1562830418,
        "uid": 134476,
        "name": "wyx__",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1593 \u3010\u56e0\u5b50\u548c\u3011"
    },
    {
        "content": "\u5bf9\u4e8e\u9006\u5143\u505a\u6cd5\u5176\u5b9e\u6ca1\u6709\u592a\u591a\u53ef\u8bf4\u7684\uff0c\u4eca\u5929\u6211\u4e00\u5b9a\u8981\u5199\u8fd9\u7bc7\u9898\u89e3\u662f\u60f3\u8ba9\u5404\u4f4d\u5728\u6d1b\u8c37\u901a\u8fc7\u800c\u5728\u67d0\u77e5\u540doj\u65e0\u6cd5\u901a\u8fc7\u7684\u4eba\u8bf4\u9519\u5728\u54ea\u4e86\uff0c\u8bf7\u770b\u6ce8\u91ca\u3002\n\u540c\u65f6\u8fd9\u4e5f\u662f\u4e00\u79cdhack\u601d\u8def\uff0c\u6211\u8c37\u8fd9\u9053\u9898\u8fd8\u6ca1\u6709\u8fd9\u79cd\u6570\u636e\u70b9\n\n```\n#include<cstdio>\n#include<cstdlib>\n#include<iostream>\n#include<iomanip>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\nusing namespace std;\nconst long long mod=9901;\nlong long A,B;\nlong long prime[500];\nlong long cnt;\nlong long ansA=1;\nlong long ansB=1;\nlong long geshu[500];\ninline void div(long long x)\n{\n\tfor(long long i=2;i<=sqrt(x+1);i++)\n\t{\n\t\tif(x%i==0)\n\t\t{\n\t\t\tprime[++cnt]=i;\n\t\t\twhile(x%i==0)\n\t\t\t{\n\t\t\t\tgeshu[cnt]++;\n\t\t\t\tx/=i;\n\t\t\t}\n\t\t}\n\t}\n\tif(x>1)\n\t{\n\t\tprime[++cnt]=x;\n\t\tgeshu[cnt]=1;\n\t}\n\treturn;\n}\ninline long long mul(long long x,long long y)\n{\n\tlong long res=0;\n\twhile(y)\n\t{\n\t\tif(y&1)\n\t\t{\n\t\t\tres=(res+x)%mod;\n\t\t}\n\t\tx=(x+x)%mod;\n\t\ty>>=1;\n\t}\n\treturn res%mod;\n}\ninline long long quickpow(long long x,long long tim)\n{\n\tlong long res=1;\n\twhile(tim)\n\t{\n\t\tif(tim&1)\n\t\t{\n\t\t\tres=mul(res,x);\n\t\t}\n\t\tx=mul(x,x);\n\t\ttim>>=1;\n\t}\n\treturn res%mod;\n}\nint main()\n{\n\tscanf(\"%lld%lld\",&A,&B);\n/*\tif(A==0)\n\t{\n\t\tcout<<\"0\"<<endl;\n\t\treturn 0;\n\t}*/\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tdiv(A);\n\tfor(long long i=1;i<=cnt;i++)\n\t{\n\t\tif((prime[i]-1)%mod==0)\n\t\t{\n\t\t\tansB=(ansB*((geshu[i]*B+1)%mod))%mod;\n\t\t\tcontinue;\t\n\t\t}\n\t\tansA=(quickpow(prime[i],geshu[i]*B+1)+mod-1)%mod;//\u5c31\u662f\u8fd9\u91cc\uff01\uff01\u5982\u679cprime%mod==0\u7684\u8bdd \u8fd9\u91ccquickpow\u4f1a\u8fd4\u56de0\uff0c\u90a3\u4e48ansA\u5c31\u53d8\u6210-1\u4e86\uff0c\u6240\u4ee5\u8981+mod\uff0c\u5361\u8fd9\u4e2a\u7684\u6570\u636e\u633a\u96be\u51fa\u7684\uff0c\u4f46\u662f\u51fa\u4e86\u5c31\u80fd\u6076\u5fc3\u4eba\u3002\n\t\tansB=(((ansB*ansA)%mod)*(quickpow(prime[i]-1,mod-2)))%mod;\n\t}\n\tcout<<ansB<<endl;\n\treturn 0;\n}\n```\n",
        "postTime": 1569671504,
        "uid": 182738,
        "name": "ZBHRuaRua",
        "ccfLevel": 6,
        "title": "P1593\u56e0\u5b50\u548c"
    },
    {
        "content": "\u53d1\u73b0\u5f88\u591a\u9898\u89e3\u662f\u4e0d\u662f\u90fd\u662f\u52a0\u5f3a\u6570\u636e\u4e4b\u524d\u7684\u554a\uff0c\u5bf9\u4e8e\u4e4b\u540e\u66f4\u65b0\u7684\u4e24\u7ec4\u6570\u636e\u4e0d\u52a0\u7279\u5224\u7684\u8fc7\u4e0d\u4e86\u7684\u3002\u7531\u4e8e\u9006\u5143\u7684\u6027\u8d28\u51b3\u5b9a\u4e86\uff08\u5728b\u4e0ep\u4e92\u8d28\u7684\u60c5\u51b5\u4e0b\uff09\u4f46\u662f\u8ba8\u8bba\u91cc\u63d0\u51fa\u4e86\u8981\u6c42\u9006\u5143\u7684\u6570\u5b8c\u5168\u53ef\u4ee5\u662f9901\u7684\u500d\u6570\uff0c\u90a3\u4e48\u8fd9\u65f6\u5019\u5c31\u9700\u8981\u4e00\u4e2a\u7279\u5224\u3002\u518d\u5229\u7528\u7b49\u6bd4\u6570\u5217\uff0c\u8fd9\u4e2a\u9898\u5c31\u53ef\u4ee5\u8fc7\u5566\u3002\n\u7279\u5224\u4ee3\u7801\uff1a\n```cpp\nif(i%p==1) ans=ans*(cnt[a]+1)%p;\n```\n\u5168\u4ee3\u7801\uff1a\n```\n#include<iostream>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<cstdio>\nusing namespace std;\nlong long bg,bl;\nlong long f[10005],a,b,p=9901;\nlong long cnt[10005];\nlong long ans=1;\n\nlong long ppow (long long a,long long b){\n\tlong long r=1,base=a;\n\twhile(b){\n\t\tif(b&1) r=(base*r)%p;\n\t\tbase=(base*base)%p;\n\t\tb>>=1;\n\t}\n\treturn r;\n}\n\nlong long ga(int i){\n\treturn ppow(i,p-2)%p;\n}\n\nvoid sp(){\n\tfor(long long i=2;i<=bg;i++){\n\t\tif(bg%i==0){\n\t\t\tcnt[a]=0;\n\t\t\twhile(bg%i==0) cnt[a]++,bg/=i; \n\t\t\tif(i%p==1) ans=ans*(cnt[a]+1)%p;\n\t\t\telse ans=ans*((ppow(i,cnt[a]*bl+1)-1)*ga(i-1))%p;\n\t\t}\n\t}\n}\n\nint main(){\n\tcin>>bg>>bl;\n\tsp();\n\tcout<<ans;\n}\n```\noh\u5bf9\u4e86 \u8fd8\u8981\u5c31\u5f97\u6bcf\u6b65\u53d6\u819c\u7684\u95ee\u9898\uff0c\u8981\u4e0d\u8fd8\u662f\u6709\u6570\u636e\u70b9\u8fc7\u4e0d\u53bb\u7684\u3002\n~~\u6211\u624d\u4e0d\u4f1a\u544a\u8bc9\u4f60\u6211\u5f00\u59cb\u60f3\u76f4\u63a5\u628a\u8ba8\u8bba\u91cc\u7684\u4e24\u4e2a\u6570\u636e\u7279\u5224\u8fc7\u4e86\u8fd9\u4e2a\u9898~~",
        "postTime": 1534122715,
        "uid": 51395,
        "name": "7wwwwth",
        "ccfLevel": 4,
        "title": "\u52a0\u4e86\u4e00\u4e2a\u7279\u5224\u7684\u9006\u5143"
    },
    {
        "content": "### \u3010\u7b97\u6cd5\u601d\u8def\u3011\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u6b63\u6574\u6570n\uff1a\n\n\u8d28\u56e0\u6570\u5206\u89e3\u540e\u53ef\u4ee5\u5199\u6210n=a1^k1*a2^k2*\u2026\u2026*ai^ki\n\n\u6240\u6c42\u7684\u6570\u7684\u56e0\u6570\u548cf(n)\u5c31\u7b49\u4e8ef(n)=(1+a1+a1^2+\u2026\u2026+a1^k1)*(1+a2+a2^2+\u2026\u2026+a2^k2)*\u2026\u2026*(1+ai+ai^2+\u2026\u2026+ai^ki)\n\n\u7136\u540e\u6839\u636e\u7b49\u6bd4\u6570\u5217\u6c42\u548c\n    f(n)=(a1^(k1+1)-1)/(a1-1)*(a2^(k2+1)-1)/(a2-1)*\u2026\u2026*(ai^(ki+1)-1)/(ai-1)\n### \u3010\u7b97\u6cd5\u5206\u6790\u3011\n#### \u6b65\u9aa4\u4e00\uff1a\u5e95\u6570\u62c6\u5206\n\u6211\u4eec\u9996\u5148\u5c06\u5e95\u6570\u62c6\u5206\u6210a1^k1*a2^k2*\u2026\u2026*ai^ki\u7684\u5f62\u5f0f\uff0c\u901a\u8fc7\u4e0d\u65ad\u7684\u8bd5\u9664\u5e76\u9664\u5c3d\uff0c\u4ee5\u4fdd\u8bc1\u5f97\u5230\u7684\u5747\u4e3a\u8d28\u56e0\u6570\uff08cnt\u8868\u793a\u5f53\u524d\u62c6\u5206\u51fa\u7684\u8d28\u56e0\u6570\u7684\u5e8f\u6570\uff0cprim[i]\u8868\u793a\u62c6\u5206\u51fa\u7684\u7b2ci\u4e2a\u8d28\u56e0\u6570\uff0ctim[i]\u8868\u793a\u62c6\u5206\u51fa\u7684\u7b2ci\u4e2a\u8d28\u56e0\u6570\u7684\u6570\u76ee\uff09\n```cpp\ninline void chai(){\n\tfor(long long i=2;i*i<=n;i=-~i){\n\t\tif(n%i==0){\n\t\t\tprim[++cnt]=i;\n\t\t\twhile(n%i==0){\n\t\t\t\tn/=i;\n\t\t\t\ttim[cnt]++;\n\t\t\t}\n\t\t}\n\t}\n}\n```\n\n\u7136\u540e\u5c06\u6bcf\u4e00\u4e2a\u8d28\u56e0\u6570\u7684\u6570\u76ee\u90fd\u4e58\u4e0am\uff0c\u4ee5\u786e\u4fdd\u6240\u6709\u8d28\u56e0\u6570\u7684\u79ef\u7b49\u4e8e\u539f\u5148\u7684\u5e42\u7684\u5927\u5c0f\uff08\u56e0\u4e3a\u5f00\u5934\u6ca1\u6709\u8ba1\u7b97\u5e42\uff09\n```cpp\n\tfor(register int i=1;i<=cnt;i=-~i){\n\t\ttim[i]*=m;\n\t}\n```\n#### \u6b65\u9aa4\u4e8c\uff1a\u8ba1\u7b97\u6bcf\u4e00\u4e2a\u8d28\u56e0\u6570\u4ea7\u751f\u7684\u548c\n\u6211\u4eec\u4ece\u627e\u5230\u7684\u7b2c\u4e00\u4e2a\u8d28\u56e0\u6570\u5f00\u59cb\uff0c\u679a\u4e3e\u6bcf\u4e00\u4e2a\u8d28\u56e0\u6570\n```cpp\n\tfor(register int i=1;i<=cnt;i=-~i){\n\t\twork(prim[i],tim[i]);\n\t}\n```\n\u7edf\u8ba1\u5b83\u4eec\u5bf9\u7ed3\u679c\u4ea7\u751f\u7684\u5f71\u54cd\u503c\n```cpp\ninline void work(long long a,long long b){\n\ta%=mod;\n\tlong long now=0,k=b%mod/(mod-1),res=b%(mod-1);\n\tif(k)\n\t\tfor(long long i=0;i<mod;i++)\n\t\t\tnow=(now+(ksm(a,i)))%mod;\n\tfor(long long i=0;i<=res;i++)\n\t\tnow=(now+ksm(a,i))%mod;\n\tans=ans*now%mod;\n}\n```\n\u4e3a\u4e86\u8282\u7701\u65f6\u95f4\uff0c\u6211\u4eec\u5728\u4e2d\u95f4\u4f7f\u7528\u5feb\u901f\u5e42\n```cpp\ninline long long ksm(long long x,long long k){\t\t//\u5feb\u901f\u5e42\u8ba1\u7b97x\u7684k\u6b21\u65b9 \n\tlong long tot=1;\n\twhile(k){\n\t\tif(k%2==1)\n\t\t\ttot=tot*x%mod;\n\t\tx=x*x%mod;\n\t\tk/=2;\n\t}\n\treturn tot;\n}\n```\n#### \u6b65\u9aa4\u4e09\uff1a\u8f93\u51fa\u7b54\u6848\n### \u3010\u6ce8\u610f\u4e8b\u9879\u3011\n1\u3001\u7531\u4e8e\u6570\u636e\u975e\u5e38\u5927\uff0c\u6211\u4eec\u9700\u8981\u5728\u6bcf\u4e00\u6b65\u8fd0\u7b97\u65f6\u90fd\u4e0d\u65ad\u7684\u5bf9\u7b54\u6848\u53d6\u6a21\u3002\n\n2\u3001\u4e3a\u4e86\u9632\u6b62\u5728\u8fd0\u7b97\u8fc7\u7a0b\u4e2d\u8d85\u51fa\u8fd0\u7b97\u8303\u56f4\uff0c\u5efa\u8bae\u5c06\u53d8\u91cf\u5b9a\u4e49\u6210long long\u578b\u3002\n\n**3\u3001\u5728\u62c6\u5206\u5e95\u6570\u65f6\uff0c\u7531\u4e8e\u90e8\u5206\u6570\u636e\u7684\u5e95\u6570\u662f\u7531\u4e00\u4e2a\u5f88\u5927\u7684\u8d28\u6570\uff08\u5b83\u7684\u5e73\u65b9\u5df2\u7ecf\u8d85\u51fa\u539f\u6570\uff09\u548c\u4e00\u4e9b\u8f83\u5c0f\u7684\u8d28\u6570\u76f8\u4e58\u5f97\u5230\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u62c6\u5206\u5b8c\u540e\u8fd8\u9700\u8981\u52a0\u5165\u4e00\u4e9b\u5224\u65ad\u6765\u786e\u4fdd\u539f\u5148\u7684\u5e95\u6570\u5df2\u7ecf\u5b8c\u5168\u62c6\u5206\u5b8c\u6bd5\u3002**\n```cpp\n\tif(n!=1){\n\t\tcnt++;\n\t\tprim[cnt]=n;\n\t\ttim[cnt]++;\n\t}\n```\n#### \u7efc\u4e0a\u6240\u8ff0\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\n### \u3010\u4ee3\u7801\u3011\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int maxn=1000005,mod=9901;\n\nint cnt;\nlong long n,m,ans=1,prim[maxn],tim[maxn];\n\ninline void chai(){\n\tfor(long long i=2;i*i<=n;i=-~i){\n\t\tif(n%i==0){\n\t\t\tprim[++cnt]=i;\n\t\t\twhile(n%i==0){\n\t\t\t\tn/=i;\n\t\t\t\ttim[cnt]++;\n\t\t\t}\n\t\t}\n\t}\n\tif(n!=1){\n\t\tcnt++;\n\t\tprim[cnt]=n;\n\t\ttim[cnt]++;\n\t}\n}\n\ninline long long ksm(long long x,long long k){//\u5feb\u901f\u5e42\u8ba1\u7b97x\u7684k\u6b21\u65b9 \n\tlong long tot=1;\n\twhile(k){\n\t\tif(k%2==1)\n\t\t\ttot=tot*x%mod;\n\t\tx=x*x%mod;\n\t\tk/=2;\n\t}\n\treturn tot;\n}\n\ninline void work(long long a,long long b){\n\ta%=mod;\n\tlong long now=0,k=b%mod/(mod-1),res=b%(mod-1);\n\tif(k)\n\t\tfor(long long i=0;i<mod;i++)\n\t\t\tnow=(now+(ksm(a,i)))%mod;\n\tfor(long long i=0;i<=res;i++)\n\t\tnow=(now+ksm(a,i))%mod;\n\tans=ans*now%mod;\n}\n\nint main(){\n\tscanf(\"%lld%lld\",&n,&m);\n\tchai();\n\tfor(register int i=1;i<=cnt;i=-~i){\n\t\ttim[i]*=m;\n\t\twork(prim[i],tim[i]);\n\t}\n\tans%=mod;\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n\u53cb\u60c5\u94fe\u63a5\uff1a\u611f\u8c22 [CZF](https://www.luogu.org/space/show?uid=21082) \u7ed9\u672c\u4eba\u63d0\u4f9b\u7684\u4ee3\u7801\u53c2\u8003",
        "postTime": 1533300749,
        "uid": 8595,
        "name": "FLASH_CM",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P1593 \u3010\u56e0\u5b50\u548c\u3011"
    },
    {
        "content": "\u4f17\u6240\u5468\u77e5\uff0c\u82e5n=p1^a1\\*p2^a2\\*...\\*pk^ak\uff0c\u5219n\u7684\u56e0\u5b50\u548c=(1+p1+p1^2+...+p1^a1)(1+p2+p2^2+...+p2^a2)...(1+pk+pk^2+...+pk^ak)\n\n\u5148\u628ax\u505a\u8d28\u56e0\u6570\u5206\u89e3\uff0c\u518d\u628a\u6bcf\u4e00\u9879\u7cfb\u6570\u4e58\u4e0ay\uff0c\u6700\u540e\u5957\u516c\u5f0f\u5373\u53ef\u3002\n\n\u6ce8\u610f\uff0c\u7cfb\u6570\u4ecd\u7136\u5f88\u9ad8\uff0c\u6240\u4ee5\u5f97\u4f7f\u7528\u77e9\u9635\u5feb\u901f\u5e42\u3002\n\n\u81f3\u4e8e\u662f\u4ec0\u4e48\u77e9\u9635\uff0c\u81ea\u5df1\u60f3\u5427\u3002\n",
        "postTime": 1380684835,
        "uid": 203,
        "name": "JOHNKRAM",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P1593 \u3010\u56e0\u5b50\u548c\u3011"
    },
    {
        "content": "\n\u3010\u9898\u610f\u3011\uff1a\n- \u7ed9\u5b9a $a,b$\uff0c\u6c42 $a^b$ \u7684\u6240\u6709\u56e0\u5b50\u7684\u548c\u5bf9 $9901$ \u53d6\u6a21\u7684\u503c\uff0c\u5373\u6c42\uff1a\n\n  $$\\sum\\limits_{i=1}^{a^b} i(i|a^b)\\mod 9901$$\n\n- \u6570\u636e\u8303\u56f4\uff1a$1 \\leq a,b \\leq 5 \\times 10^7$\u3002\n\n---------------------------------------\n\n\u3010\u601d\u8def\u3011\uff1a \u8bb0 $a= \\prod\\limits_{i=1}^{m} p_i^{k_i}$\uff0c\u5176\u4e2d $p_i$ \u662f\u8d28\u6570\uff0c$k_i\\geq 0(1 \\leq i \\leq m)$\u3002\n\n\u90a3\u4e48\uff0c$a^b=\\prod\\limits_{i=1}^{m} p_i^{k_i \\times b}$\u3002\u7531\u5b9a\u7406\uff0c\u7b54\u6848 $\\text{ans}=\\prod\\limits_{i=1}^{m} (\\sum\\limits_{j=0}^{k_i \\times b}p_i^j)$\u3002\n\n\u76f4\u63a5\u7b97\u94c1\u5b9a\u4e0d\u884c\uff0c\u4f46\u662f\u7531\u8d39\u9a6c\u5c0f\u5b9a\u7406\u5f97\uff0c$a^{t-1} \\equiv 1 \\pmod t\\ (t$\u662f\u8d28\u6570$)$ \u3002\u7531\u9898\u610f\uff0c$p=9901$\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u7b97\u51fa $\\text{res=}\\sum\\limits_{j=0}^{p-2} p_i^j$\u3002\u7136\u540e\uff0c\u56e0\u4e3a\u540e\u9762\u7684\u9879\u4e00\u5b9a\u4e0e\u524d\u9762\u7684\u67d0\u4e00\u9879\u76f8\u7b49\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u4ee4\u8fd9\u4e2a\u6570\u5217 $t-2$ \u4f4d\u4e3a\u4e00\u4e2a\u5faa\u73af\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u7531 $\\text{res}$ \u5f97\u5230\u6240\u6709\u5faa\u73af\u7684\u603b\u548c\u3002\u5bf9\u4e8e\u540e\u9762\u5269\u4f59\u7684\u9879\uff0c\u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u5f97\u5230\u3002\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u6bd4\u5982 $k_i \\times b = 2 \\times t$\uff0c\u6211\u4eec\u53ef\u4ee5\u6c42\u51fa $\\text{res=}\\sum\\limits_{j=0}^{p-2} p_i^j$\uff0c\u7136\u540e\u7b54\u6848 $\\text{ans = res}  \\times 2 + \\sum\\limits_{\\text{j=0}}^{3} \\text{p}_{\\text{i}}^j$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u6ca1\u7528\u7b49\u6bd4\u6570\u5217\u4f18\uff0c\u4f46\u662f\u9700\u8981\u7684\u77e5\u8bc6\u70b9\u5c11\uff0c\u6bd4\u8f83\u597d\u7406\u89e3\uff08\u81f3\u5c11\u4e2a\u4eba\u8ba4\u4e3a\u5982\u6b64\uff09\u3002\n\n-------------------------------------\n\n\u3010\u4ee3\u7801\u3011\uff1a\n```cpp\nconst int mod=9901;\nint calc(int x,long long t){\n\tint ret=1,ans=0;\n\tif (x==mod) return 1;\n\telse if (t<mod){\n\t\tfor(int i=0;i<=t;i++){\n\t\t\tans=(ans+ret)%mod;\n\t\t\tret=(1ll*ret*x)%mod;\n\t\t}\n\t}\n\telse{\n\t\tfor(int i=0;i<=mod-2;i++){\n\t\t\tans=(ans+ret)%mod;\n\t\t\tret=(1ll*ret*x)%mod;\n\t\t}\n\t\tans=(1ll*ans*((t+1)/(mod-1)))%mod;\n\t\tfor(int i=1;i<=(t+1)%(mod-1);i++){\n\t\t\tans=(ans+ret)%mod;\n\t\t\tret=(1ll*ret*x)%mod;\n\t\t}\n\t}\n\treturn ans;\n}\nint ans=1,a,b,n;\nint main(){\n\tscanf(\"%d%d\",&a,&b);n=a;\n\tfor(int i=2;1ll*i*i<=n;i++)\n\t\tif (n%i==0){\n\t\t\tregister int ret=0;\n\t\t\twhile (n%i==0){\n\t\t\t\tn/=i;ret++;\n\t\t\t}\n\t\t\tans=(1ll*ans*calc(i,1ll*ret*b))%mod;\n\t\t}\n\tif (n>1) ans=(1ll*ans*calc(n,b))%mod;\n\tprintf(\"%d\",(ans+mod)%mod);\n\treturn 0;\n}\n```\n\n--------------------------------------\n\n\u535a\u5ba2\u4f7f\u7528\u6548\u679c\u66f4\u4f73\uff1a [https://blog.csdn.net/ZHUYINGYE_123456/article/details/104859275](https://blog.csdn.net/ZHUYINGYE_123456/article/details/104859275)",
        "postTime": 1584166024,
        "uid": 95624,
        "name": "HPXXZYY",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1593 \u3010\u56e0\u5b50\u548c\u3011"
    },
    {
        "content": "\u5148\u5c06$a$\u5206\u89e3\u8d28\u56e0\u6570\uff0c\u5f97\uff1a\n$$p_1^{c_1}*p_2^{c_2}*p_3^{c_3}*\u2026\u2026*p_n^{c_n}$$\n\u5219\u6709$a^b$\uff1a\n$$p_1^{c_1*b}*p_2^{c_2*b}*p_3^{c_3*b}*\u2026\u2026*p_n^{c_n*b}$$\n\u5bf9\u4e8e\u6bcf\u4e2a$p_i^{k_i}(k_i=c_i*b,i\\in[1,n])$\u7684\u7ea6\u6570\u6709\uff1a$p_i^1,p_i^2\u2026\u2026p_i^k$\n\u6240\u4ee5\uff1a$$sum=\\prod_{i=1}^{n}{\\sum_{j=0}^{k}{p_i^j}}$$\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5199\u4e00\u4e2a$GetSum(p,c)$\u6765\u8ba1\u7b97$\\sum_{j=0}^{k}{p_i^j}$\uff0c\u4e3a\u4e86\u51cf\u5c11\u590d\u6742\u5ea6\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528$c$\u7684\u5947\u5076\u5206$2$\u79cd\u60c5\u51b5\u5904\u7406\u3002\n\u7b2c\u4e00\u79cd\uff0c\u4e3a\u5076\u6570\uff1a\n$$GetSum(p,c)=(1+p^{c/2})*GetSum(p,c/2-1)+p^c$$\n\u7b2c\u4e8c\u79cd\uff0c\u4e3a\u5947\u6570\uff1a\n$$GetSum(p,c)=(1+p^{(c+1)/2})*GetSum(p,(c-1)/2)$$\n\u6700\u540e\uff0c\u4e00\u5b9a\u8981\u5f00$long long\uff01\uff01\uff01$\nAC\u4ee3\u7801\uff1a\n```cpp\n#include<cstdio>\n#define mod 9901\nusing namespace std;\ntypedef long long ll;\nll sum=1;\nll a,b,cnt;\nll p[50000],c[500];\nvoid doit(){\n\tll k=a;\n\tfor(ll i=2;i*i<=k;i++)\n\t\tif(k%i==0){\n\t\t\tp[++cnt]=i;\n\t\t\twhile(k%i==0){\n\t\t\t\tc[cnt]++;\n\t\t\t\tk/=i;\n\t\t\t}\n\t\t}\n\tif(k>1) p[++cnt]=k,c[cnt]++;\n    for(ll i=1;i<=cnt;i++) c[i]*=b;\n}\nll QuickPow(ll x,ll y){\n\tll ret=1;\n\twhile(y){\n\t\tif(y&1) ret=ret*x%mod;\n\t\tx=x*x%mod;\n\t\ty>>=1;\n\t}\n\treturn ret;\n}\nll GetSum(ll x,ll y){\n\tif(y==0) return 1;\n\tif(y%2==0) return (((1+QuickPow(x,y/2))%mod)*(GetSum(x,y/2-1)%mod)+QuickPow(x,y))%mod;\n\telse return ((1+QuickPow(x,(y+1)/2))%mod)*(GetSum(x,(y-1)/2)%mod)%mod;\n}\nint main(){\n\tscanf(\"%lld%lld\",&a,&b);\n\tdoit();\n\tfor(ll i=1;i<=cnt;i++) sum=sum*GetSum(p[i],c[i])%mod;\n\tprintf(\"%lld\",sum);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1561645894,
        "uid": 201280,
        "name": "\u592a\u9633\u9a91\u58eb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1593 \u3010\u56e0\u5b50\u548c\u3011"
    },
    {
        "content": "\u9996\u5148\u6211\u4eec\u770b\u5230\u8fd9\u79cd\u56e0\u6570\u95ee\u9898,~~\u679c\u65ad~~\u8d28\u56e0\u6570\u5206\u89e3\n\n\u6240\u4ee5\u5f53\u524d\u6570$a=p_1^{k_1}*p_2^{k_2}...*p_m^{k_m}$\n\n\u53ef\u5f97$a^b=p_1^{k_1*b}*p_2^{k_2*b}...*p_m^{k_m*b}$\n\n\u8003\u8651\u56e0\u6570\u548c,\u5047\u8bbe\u6570$a$\u53ea\u6709\u4e00\u4e2a\u8d28\u56e0\u5b50$p_1$,\u5219\u56e0\u6570\u548c\u4e3a$\\sum_{i=0}^{k_1}{p_1}^i$\n\n\u5982\u679c\u6709\u7b2c\u4e8c\u4e2a\u8d28\u56e0\u5b50$p_2$\u5219\u56e0\u6570\u548c\u4e3a$\\sum_{i=0}^{k_1}({p_1}^i*\\sum_{j=0}^{k_2}{p_2}^j)=(\\sum_{i=0}^{k_1}{p_1}^i)*(\\sum_{j=0}^{k_2}{p_2}^j)$\n\n\u4ee5\u6b64\u7c7b\u63a8,\u6211\u4eec\u8981\u6c42\u7684\u56e0\u6570\u4e4b\u548c~~\u663e\u7136~~\u4e3a$\\prod_{i=1}^m \\sum_{j=0}^{k_i}{p_i}^j$\n\n\u81f3\u4e8e\u540e\u9762\u90a3\u4e00\u6bb5\u600e\u4e48\u6c42,\u5148\u4ee4$f_i=\\sum_{j=0}^{i}p^j$\n\n\u53ef\u4ee5\u53d1\u73b0$f_{i+1}=\\sum_{j=0}^{i+1}p^j=p*(\\sum_{j=0}^{i}p^j)+1=p*f_i+1$\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u5077\u7a0e\u7684\u4f7f\u7528\u77e9\u4e58\u4e86(\u5982\u679c\u4e0d\u4f1a\u8bf7*\u53c2\u8003*[\u8fd9\u9898](https://www.luogu.org/problemnew/show/P2044))\n\n\u4ee3\u7801\u5982\u4e0b\n\n```cpp\n#include<algorithm>\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<ctime>\n#include<queue>\n#include<map>\n#define LL long long\n#define il inline\n#define re register\n\nusing namespace std;\nconst LL mod=9901;\nil LL rd()\n{\n    re LL x=0,w=1;re char ch;\n    while(ch<'0'||ch>'9') {if(ch=='-') w=-1;ch=getchar();}\n    while(ch>='0'&&ch<='9') {x=(x<<3)+(x<<1)+(ch^48);ch=getchar();}\n    return x*w;\n}\nstruct mrtx\n{\n  LL a[2][2];\n  mrtx(){memset(a,0,sizeof(a));}\n}a,b;\nil mrtx mlt(mrtx a,mrtx b)\n{\n  mrtx c;\n  for(int i=0;i<=1;i++)\n    for(int j=0;j<=1;j++)\n      for(int k=0;k<=1;k++)\n\t    c.a[i][j]=(c.a[i][j]+(a.a[i][k]*b.a[k][j])%mod)%mod;\n  return c;\n}\nil mrtx ksm(mrtx a,mrtx b,LL bb)    //\u8fd9\u91cc\u76f4\u63a5\u628a\u8f6c\u79fb\u77e9\u9635\u4e58\u5230\u521d\u59cb\u77e9\u9635\u4e0a\u53bb\n{\n  while(bb)\n    {\n      if(bb&1) a=mlt(a,b);\n      b=mlt(b,b);\n      bb>>=1;\n    }\n  return a;\n}\nLL p[20][2],tt,n,m,ans=1;\n\nint main()\n{\n  n=rd(),m=rd();\n  int srt=sqrt(n);\n  for(int i=2;i<=srt;i++)\n    {\n      if(n%i!=0) continue;\n      p[++tt][0]=i;\n      while(n%i==0) ++p[tt][1],n/=i;\n    }\n  if(n>1) p[++tt][0]=n,p[tt][1]=1;\n  a.a[0][0]=a.a[0][1]=1,b.a[1][0]=b.a[1][1]=1;\n  for(int i=1;i<=tt;i++)\n    {\n      p[i][1]*=m;\n      b.a[0][0]=p[i][0];\n      ans=(ans*ksm(a,b,p[i][1]).a[0][0])%mod;\n    }\n  printf(\"%lld\\n\",ans);\n  return 0;\n}\n\n```",
        "postTime": 1533643855,
        "uid": 38372,
        "name": "star_magic_young",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P1593 \u3010\u56e0\u5b50\u548c\u3011"
    },
    {
        "content": "##\u7528\u9006\u5143\u7684\u770b\u8fd9\u91cc\uff01\n\n\u8fd8\u662f\u548c\u524d\u9762\u51e0\u4e2a\u4e00\u6837\uff1a\n\n![](http://img.blog.csdn.net/20170914203230797?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc3RvbmU0MTEyMw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n\n\u56e0\u4e3a\u8981\u53d6\u6a21\uff0c\u6240\u4ee5\u9664\u6cd5\u8981\u6362\u6210\u9006\u5143\uff0c\u7136\u540e\u6211\u5c31\u6109\u5feb\u5730\u5199\u5b8c\u4ea4\u4e86\u4e0a\u53bb\uff0c60\u5206\uff0c4\u4e2aWA\uff0c\u53d1\u73b0\uff0c\u9006\u5143\u6c42\u51fa\u6765\u4e4b\u540e\u53ef\u4ee5\u662f\u8d1f\u7684\uff0c\u4e5f\u53ef\u4ee5\u662f\u96f6\uff0c\u4e8e\u662f\u5c31\u52a0\u4e86\u8fd9\u4e48\u4e00\u4e2a\u7279\u5224\uff1a\n\nif(num2<=0)num2+=p;\uff08\u5176\u4e2dnum2\u662f\u6211\u6c42\u7684\u9006\u5143\uff0cp\u662f\u6a21\u6570\uff09\n\n\u7136\u540e\u5c31AC\u4e86\uff0c\u6839\u672c\u4e0d\u9700\u8981\u4ed6\u4eec\u8bf4\u7684\u4ec0\u4e48\u5947\u602a\u7684\u9006\u5143\u65b9\u5f0f\u3002\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<cstdlib>\n#include<cmath>\n#include<vector>\n#include<queue>\n#define ll long long\nusing namespace std;\nll ksm(ll a,ll b,ll p){\n    ll ans=1;\n    a%=p;\n    while(b){\n        if(b&1){\n            ans=(ans*a)%p;\n        }\n        a=(a*a)%p;\n        b>>=1;\n    }\n    return ans;\n}\nconst ll p=9901;\nll a,b;\nll prime[100000];\nll e[100000];\nint cnt;\nint main(){\n    scanf(\"%lld %lld\",&a,&b);\n    for(ll i=2;i*i<=a;i++){\n        if(a%i==0){\n            prime[++cnt]=i;\n            while(a%i==0){\n                a/=i;\n                e[cnt]++;\n            }\n            e[cnt]*=b;\n        }\n    }\n    if(a!=1){\n        prime[++cnt]=a;\n        e[cnt]++;\n        e[cnt]*=b;\n    }\n    ll ans=1;\n    for(int i=1;i<=cnt;i++){\n        ll num=(ksm(prime[i],e[i]+1,p)-1+p)%p;\n        ll num2=ksm(prime[i]-1,p-2,p)%p;\n        if(num2<=0)num2+=p;\n        ans*=num*num2%p;\n        ans%=p;\n    }\n    printf(\"%lld\",(ans+p)%p);\n    return 0;\n}\n```",
        "postTime": 1505392713,
        "uid": 39505,
        "name": "\u73ab\u8475\u4e4b\u8776",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P1593 \u3010\u56e0\u5b50\u548c\u3011"
    },
    {
        "content": "$Answer = A ^ B $ \u7684\u56e0\u5b50\u4e4b\u548c\n\n\u5c06 $A$ \u8fdb\u884c\u8d28\u56e0\u6570\u5206\u89e3\n$A = p_1 ^ {a_1} P_2 ^ {a_2} p_3 ^ {a_3} \\cdots p_k ^ {a_k}$\n\n$A ^ B = p_1 ^ {a_1 * B} P_2 ^ {a_2 * B} p_3 ^ {a_3 * B} \\cdots p_k ^ {a_k * B}$\n\n\u8003\u8651\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8d28\u56e0\u6570$p_i$ \u4f1a\u4ee5\u4efb\u610f\u6307\u6570\u7684\u5f62\u5f0f\u4e0e\u4efb\u610f\u6307\u6570\u5f62\u5f0f\u7684 $p_j$\u76f8\u4e58\u5f97\u5230\u4e00\u4e2a\u56e0\u6570\n\u5f53\u7136\u6307\u6570\u8981\u5728\u8303\u56f4\u5185\n\n\u6240\u4ee5 $Answer = (1 + p_1 + p_1 ^ 2 + \\cdots p_1 ^ {a_{k_1}} ) * (1 + p_2 + p_2 ^ 2 + \\cdots p_2 ^ {a_{k_2}}) * \\cdots (1 + p_k + p_k ^ 2 + \\cdots \\ p_k ^ {a_{k_k}})$\n\n\u8003\u8651\u7b49\u5f0f $T = 1 + p + p ^ 2 + p ^ 3 + \\cdots p^k$\n\u6709\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u516c\u5f0f\n$T = \\frac{p ^ {k + 1} - 1} {p - 1}$\n\n\u5feb\u901f\u5e42 + \u9006\u5143",
        "postTime": 1532002915,
        "uid": 43102,
        "name": "xayata_",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1593 \u3010\u56e0\u5b50\u548c\u3011"
    },
    {
        "content": "\u697c\u4e0b\u9898\u89e3\u8bf4\u8d39\u9a6c\u5c0f\u5b9a\u7406\u4f1aWA\uff0c\u8c8c\u4f3c\u5e76\u4e0d\uff0c\u800c\u4e14\u597d\u50cf\u4e5f\u6ca1\u6709WA\u7684\u7406\u7531\u3002\u58ee\u54c9\u6211\u5927\u98de\u9a6c\u5c0f\u5b9a\u7406\uff0c\u505a\u6570\u8bba\u9898\u4ece\u6765\u4e0d\u9700\u8981\u5199\u65b0\u7684\u4ee3\u7801\uff0c\u76f4\u63a5\u7528\u5feb\u901f\u5e42\u3002\n\n\u8fd9\u9898\u505a\u6cd5\u633a\u663e\u7136\u7684\uff0c\u662f\u4f7f\u7528\u6240\u6709\u8d28\u56e0\u5b50\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u518d\u76f8\u4e58\uff0c\u8fd9\u79cd\u5728\u8003\u573a\u90fd\u53ef\u4ee5\u81ea\u5df1\u63a8\u51fa\u6765\u3002\n\n\u7528vector\u662f\u4e3a\u4e86\u52a0\u901f\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int modd=9901;\nlong long int a,b,ans;\nint prime_list[10005];\nbool dis[500000];\nvector<int>prime_num; \nlong long int fastpow(long long int x,long long int y){\n    if(y==1)return x;\n    long long int r=1,base=x;\n    while(y){\n        if(y&1)r=r%modd*(base%modd)%modd;\n        base=base%modd*base%modd;\n        y>>=1;\n    }\n    return r;\n}\nint main(){\n    cin>>a>>b;\n    for(int i=2;i<=sqrt(a)+1;i++){\n        if(a%i==0){\n            a/=i;\n            prime_list[i]++;\n            if(!dis[i])prime_num.push_back(i);\n            dis[i]=1;\n            i--;\n        }\n    }\n    if(a!=1)prime_num.push_back(a);//a\u4e3a\u552f\u4e00\u5927\u8d28\u6570 \n    ans=1;\n    for(int i=0;i<prime_num.size();i++)\n            if(prime_num[i]==a)ans=ans*(a%modd*(fastpow(a,b)-1)%modd*(fastpow(a-1,modd-2)%modd)%modd+1)%modd;//%modd\n            else ans=ans*(prime_num[i]%modd*((fastpow(prime_num[i],b*prime_list[prime_num[i]])-1)%modd)%modd*(fastpow(prime_num[i]-1,modd-2)%modd)%modd+1)%modd;\n    cout<<ans;\n}    \n//\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u516c\u5f0f\uff1aa1*\uff081-q^n)/(1-q)\n```",
        "postTime": 1506073402,
        "uid": 38055,
        "name": "Npse_D",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1593 \u3010\u56e0\u5b50\u548c\u3011"
    },
    {
        "content": "\u6570\u5b66\u6e23\u4e0d\u4f1a\u77e9\u9635\u7684\u505a\u6cd5QAQ\n\n\n\u4f46\u4f3c\u4e4e\u6709\u4e00\u79cd\u66f4\u52a0\u7b80\u4fbf\u7684\u65b9\u6cd5\uff1a**\u7b49\u6bd4\u6570\u5217\u524dN\u9879\u548c**\n\n\n\u50cf\u697c\u4e0b\u6240\u8bf4\uff0c\u5c06a\u8fdb\u884c\u8d28\u56e0\u6570\u5206\u89e3\uff0c\u5c06\u6bcf\u4e2a\u8d28\u56e0\u5b50\u7684\u6307\u6570\u4e58\u4e0ab\uff0c\u6700\u540e\u7684\u7b54\u6848\u3010p\u8868\u793a\u8d28\u56e0\u5b50,a\u8868\u793a\u6700\u9ad8\u6b21\u3011\n\nans=(1+p1^1+p1^2+......+p1^a1)(1+p2^1+p2^2+......+p2^a2)(1+p3^1+p3^2+......+p3^a3)......(1+pn^1+pn^2+......+pn^an)\n\n\n\u53d1\u73b0\u6ca1\u6709\uff0c\u6bcf\u4e00\u4e2a\u62ec\u53f7\u91cc\u5c31\u662f\u7b49\u6bd4\u6570\u5217\u7684\u524dN\u9879\u548c=(1-q^n)/(1-q)\u3010q\u4e3a\u516c\u6bd4\u3011\n\n\u7531\u4e8e\u6d89\u53ca\u53d6\u6a21\uff0c\u9664\u6cd5\u8981\u7528\u9006\u5143\n\n\n\n\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define LL long long int\nusing namespace std;\nconst int maxn=10005,INF=2000000000,P=9901;\nLL fac[maxn],cnt[maxn],faci=0,A,B;\ninline LL qpow(LL a,LL b){  //\u5feb\u901f\u5e42\n    LL ans=1;\n    for(;b;b>>=1,a=a*a%P) if(b&1) ans=ans*a%P;\n    return ans;\n}\ninline LL inverse(int i){return qpow(i,P-2)%P;}   //\u9006\u5143\nint main(){\n    LL ans=1;\n    cin>>A>>B;\n    for(int i=2;i<=A;i++){        //\u8d28\u56e0\u5b50\u5206\u89e3\n        if(A%i==0){\n            fac[++faci]=i;\n            while(A%i==0) cnt[faci]++,A/=i;\n            ans=ans*((qpow(i,cnt[faci]*B+1)-1)*inverse(i-1))%P;   //\u7b49\u6bd4\u6570\u5217\u6c42\u548c\n        }\n    }\n    cout<<ans<<endl;\n    return 0;\n}\n\n```",
        "postTime": 1504762085,
        "uid": 32842,
        "name": "Mychael",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P1593 \u3010\u56e0\u5b50\u548c\u3011"
    },
    {
        "content": "\u6709\u4e2a\u6570\u8bba\u51fd\u6570\u662f\u03c3(n)=\u2211(d|n)d \u5c31\u662fn\u7684\u7ea6\u6570\u548c\n\n\u697c\u4e0b\u5df2\u7ecf\u8bb2\u4e86\u03c3(A^B)=\u03c0(pi+pi^2+...+pi^(ki\\*B))=\u03c0(pi^(ki\\*B+1)-1)/(pi-1) \u7b49\u6bd4\u6570\u5217\u6c42\u548c\n\n\u53c8\u6709a/b mod c=(a mod(b\\*c))/b\n\n\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u505a\uff1f\u76f4\u63a5\u9006\u5143||\u8d39\u9a6c\u5c0f\u5b9a\u7406\u4f1a\u4e0d\u597d\u591a\u7684\u591a\u5417\uff1f\n\u4f46\u662f\u5b9e\u9645\u4e0a\u4f1awa(luogu\u6211\u4e0d\u77e5\u9053 \u6709\u5174\u8da3\u53ef\u4ee5\u53bbpoj1845\u6d4b\u4e00\u4e0b)\n\n\u2234\u03c3(A^B)%P=\u03c0(pi^(ki\\*B+1)%(P\\*(pi-1))-1)/(pi-1)%P\n\n```cpp\n#include<cstdio>\n#include<cmath>\n#define re register int\n#define file(s) freopen(s\".in\",\"r\",stdin),freopen(s\".out\",\"w\",stdout)\ntypedef long long ll;\nconst int P=9901;\nll n,m,ans=1,sum,Mod;\ninline ll mulMod(ll a,ll b){\n    ll ans=a*b-Mod*(ll)((long double)a/Mod*b+0.5);\n    return ans<0?ans+Mod:ans;\n}\ninline ll powMod(ll a,ll b){\n    ll x=1;a%=Mod;\n    for(;b;b>>=1,a=mulMod(a,a))if(b&1)x=mulMod(a,x);\n    return x;\n}\nint main(){\n    scanf(\"%lld%lld\",&n,&m);\n    for(re i=2,ii=sqrt(n);i<=ii&&i*i<=n;++i){\n        if(n%i)continue;\n        sum=0;while(n%i==0)++sum,n/=i;\n        Mod=P*(i-1);\n        ans=(ans*((powMod(i,sum*m+1)-1)/(i-1)))%P;\n    }\n    if(n>1)Mod=P*(n-1),ans=(ans*((powMod(n,m+1)-1)/(n-1)))%P;\n    printf(\"%lld\",ans);\nreturn 0;\n}\n```",
        "postTime": 1502018876,
        "uid": 20156,
        "name": "Kelin",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P1593 \u3010\u56e0\u5b50\u548c\u3011"
    },
    {
        "content": "\u628aA\u5206\u89e3\u8d28\u56e0\u6570\uff0c\u8868\u793a\u4e3ap1^c1\u00a0\u00d7 p2^c2 \u00d7\u2026\u2026\u00d7 pn^cn\n\n\u2234A^B\u8868\u793a\u4e3ap1^(c1\\*B) \u00d7 p2^(c2\\*B) \u00d7\u2026\u2026\u00d7 pn^(cn\\*B)\n\n\u2234A^B\u7684\u7ea6\u6570\u8868\u793a\u4e3ap1^k1 \u00d7 p2^k2 \u00d7\u2026\u2026\u00d7 pn^kn\uff0c\u5176\u4e2d0<=ki<=ci\\*B\n\n\u2234\u5f0f\u5b50 (1+p1+p1^2+\u2026\u2026+p1^(c1\\*B)) \u00d7\u00a0(1+p2+p2^2+\u2026\u2026+p2^(c2\\*B)) \u00d7\u2026\u2026\u00d7\u00a0(1+pn+pn^2+\u2026\u2026+pn^(cn\\*B)) \u5c55\u5f00\u4e4b\u540e\u5c31\u662f\u6240\u6709\u7ea6\u6570\u4e4b\u548c\n\n\u4e0b\u9762\u7684\u4efb\u52a1\u5c31\u662f\u5bf9\u4e0a\u5f0f\u7684\u6bcf\u4e00\u4e2a\u62ec\u53f7\u8fdb\u884c\u7b49\u6bd4\u6570\u5217\u6c42\u548c(mod 9901)\n\n ![](https://cdn.luogu.com.cn/upload/pic/6201.png) \n\n",
        "postTime": 1499566861,
        "uid": 31383,
        "name": "\u9b4d\u9b49\u00b0",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1593 \u3010\u56e0\u5b50\u548c\u3011"
    },
    {
        "content": "```cpp\nprogram Project1;\nconst inf=9901;\nvar a,b,i,ans,sum:longint;\nfunction work(x,y:longint):longint;\nvar t,tot:longint;\nbegin\n   t:=x; tot:=1;\n   while y>0 do\n    begin\n      if odd(y) then tot:=tot*t mod inf;\n      y:=y div 2;\n      t:=t*t mod inf;\n    end;\n    exit(tot);\nend;             //\u5feb\u901f\u5e42\nfunction calc(p,c:longint):longint;\nbegin\n  if c=0 then exit(1);\n  if c mod 2=0 then  calc:=((work(p,c div 2)+1)*calc(p,c div 2-1)\n                                  +work(p,c) )mod inf\n    else calc:=((work(p,(c+1) div 2)+1)*calc(p,(c-1) div 2)) mod inf\nend;   // \u9012\u5f52\u6c42\u7b49\u6bd4\u6570\u5217\u548c\nbegin\n  readln(a,b);\n  i:=2;\n  sum:=0; ans:=1;\n    while i<=a do\n     begin\n       while a mod i =0 do\n        begin\n          inc(sum);\n          a:=a div i;\n        end;\n       ans:=(ans*calc(i mod inf,sum*b)) mod inf;\n       writeln(i,' ',sum);  //\u8c03\u8bd5\u6b65\u9aa4\n       inc(i);\n       sum:=0;\n     end;\n    writeln(ans);  readln;\nend.\n```\n\u628aA\u5206\u89e3\u8d28\u56e0\u6570\uff0c\u8868\u793a\u4e3ap1^c1\u00a0\u00d7 p2^c2 \u00d7\u2026\u2026\u00d7 pn^cn\n\u2234A^B\u8868\u793a\u4e3ap1^(c1\\*B) \u00d7 p2^(c2\\*B) \u00d7\u2026\u2026\u00d7 pn^(cn\\*B)\n\n\u2234A^B\u7684\u7ea6\u6570\u8868\u793a\u4e3ap1^k1 \u00d7 p2^k2 \u00d7\u2026\u2026\u00d7 pn^kn\uff0c\u5176\u4e2d0<=ki<=ci\\*B\n\n\u2234\u5f0f\u5b50 (1+p1+p1^2+\u2026\u2026+p1^(c1\\*B)) \u00d7\u00a0(1+p2+p2^2+\u2026\u2026+p2^(c2\\*B)) \u00d7\u2026\u2026\u00d7\u00a0(1+pn+pn^2+\u2026\u2026+pn^(cn\\*B)) \u5c55\u5f00\u4e4b\u540e\u5c31\u662f\u6240\u6709\u7ea6\u6570\u4e4b\u548c\n\n\u4e0b\u9762\u7684\u4efb\u52a1\u5c31\u662f\u5bf9\u4e0a\u5f0f\u7684\u6bcf\u4e00\u4e2a\u62ec\u53f7\u8fdb\u884c\u7b49\u6bd4\u6570\u5217\u6c42\u548c(mod 9901)\n\n\n\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u53ef\u4ee5\u7528\u4e58\u6cd5\u9006\u5143......\u4f46\u672c\u84bb\u9a79\u4e0d\u4f1a......\n\n\u6240\u4ee5\u7528\u9012\u5f52\uff0c\u8bbecalc(p,c)=1+p^1+p^2+......+p^n\n\n\u53ef\u5f97\u5f53n=\u5076\u6570\u65f6    calc=(p^(c/2))\\*calc(p,c/2-1)+p^c\n\n\u5f53n=\u5947\u6570\u65f6    calc=\uff08p^(c+1/2)+1\uff09\\*calc(p,(c-1)/2)\n",
        "postTime": 1499566561,
        "uid": 30580,
        "name": "DANNIEL",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1593 \u3010\u56e0\u5b50\u548c\u3011"
    },
    {
        "content": "~~(\u4e3a\u4f55\u73b0\u5728pas\u81ea\u5e264MB\u5e38\u6570\u5f0f\u5185\u5b58...).~~.\n\n\u8865\u4e0a\u77e9\u4e58\u9898\u89e3\u5427..\n\n\u591a\u9879\u5f0f\u5c55\u5f00\u5176\u4ed6\u4eba\u8bb2\u7684\u5f88\u6e05\u695a\u4e86..\n\n\u6784\u9020\u77e9\u9635:\n```\n\n[\u7d2f\u79ef\u548c \u5f53\u524d\u9879] * [\u67d0\u77e9\u9635..].\n\n0 1     1 0 ^y \n     * (   )\n        1 p\n        \n[a]     [b].\n\n//p\u662f\u5206\u89e3\u7684\u56e0\u6570..\n//y\u662fp\u7684\u4e2a\u6570*s+1.\n//\u7b54\u6848\u4e3aa[1,1].\n```\n\u6240\u6709\u56e0\u6570\u505a1\u904d\u4e58\u8d77\u6765..\u6ca1\u4e86...\n\nDiu\u4ee3\u7801..\n```\nprogram P1593;\n type\n  wa=array[1..2,1..2] of longint;\n const\n  d:wa=((0,0),(0,0));\n  e:wa=((1,0),(0,1));\n var\n  a,b,c:wa;\n  i,x,y,s,t,mot,ssum:longint;\n operator *(x,y:wa)z:wa;\n  var\n   i,j,k:longint;\n  begin\n   z:=d;\n   for i:=1 to 2 do\n    for j:=1 to 2 do\n     for k:=1 to 2 do\n      z[i,j]:=(z[i,j]+x[i,k]*y[k,j]) mod mot;\n  end;\n function hahaksm(x:wa;y:int64):wa;        //\u77e9\u9635\u5feb\u901f\u5e42.\n  begin\n   hahaksm:=e;\n   while y>0 do\n    begin\n     if y and 1=1 then hahaksm:=hahaksm*x;\n     x:=x*x;\n     y:=y>>1;\n    end;\n  end;\n procedure haharandize;\n  begin\n   mot:=9901;\n   b[1,1]:=1;\n   b[2,1]:=1;\n   b[1,2]:=0;\n   a[1,1]:=0;\n   a[1,2]:=1;\n   ssum:=1;\n  end;\n procedure hahadiv(k:longint);\n  begin\n   t:=0;\n   while x mod k=0 do            //\u7edf\u8ba1a\u7684\u56e0\u6570..\n    begin\n     inc(t);\n     x:=x div k;\n    end;\n   b[2,2]:=k;\n   c:=a*hahaksm(b,int64(t)*y+1); //\u6c42\u548c.\n   ssum:=ssum*c[1,1] mod mot;\n  end;\n begin\n  haharandize;\n  readln(x,y);\n  for i:=2 to trunc(sqrt(x)) do\n   if x mod i=0 then hahadiv(i); //\u56e0\u6570\u5206\u89e3.\n  if x>1 then hahadiv(x);\n  writeln(ssum);\n end.\n```\n(\u0ca1\u03c9\u0ca1).\n",
        "postTime": 1521081071,
        "uid": 20454,
        "name": "BFSBFSBFSBFS",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1593 \u3010\u56e0\u5b50\u548c\u3011"
    }
]
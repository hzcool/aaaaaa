[
    {
        "content": "#### \u89e3\u9898\u601d\u8def\n\n\u8fd9\u9053\u9898\u76ee\u7684\u5173\u952e\u4e4b\u5904\u5728\u4e8e\u6784\u9020\u521d\u59cb\u77e9\u9635\uff0c\u9898\u76ee\u90fd\u544a\u8bc9\u6211\u4eec\u4e86\u8981\u7528\u77e9\u9635\u52a0\u901f\u3002\u6240\u4ee5\u77e9\u9635\u5feb\u901f\u5e42\u662f\u6838\u5fc3\u6240\u5728\u3002\n\n#### \u5982\u4f55\u6784\u9020\n\n\u6211\u4eec\u9996\u5148\u8981\u786e\u5b9a\u76ee\u6807\u77e9\u9635\u3002\u4e0b\u9762\u8fd9\u4e2a\u77e9\u9635\u5c31\u662f\u6211\u60f3\u8981\u7684\u77e9\u9635.\n$$\\begin{bmatrix}F[i]\\\\F[i-1]\\\\F[i-2]\\end{bmatrix}$$\n\n\u90a3\u4e48\u8fd9\u4e2a\u77e9\u9635\u8981\u600e\u6837\u7b97\u51fa\u6765\u3002\u6839\u636e\u9898\u76ee\u7ed9\u51fa\u7684\u9012\u63a8\u5f0f\u53ef\u4ee5\u5f97\u5230\u4e0b\u9762\u4e09\u4e2a\u5f0f\u5b50\n$$f[i] = f[i-1] \\times 1 + f[i-2] \\times 0 + f[i-3] \\times 1$$\n$$f[i-1] = f[i-1] \\times 1 + f[i-2] \\times 0 + f[i-3] \\times 0$$\n$$f[i-2] = f[i-1] \\times 0 + f[i-2] \\times 1 + f[i-3] \\times 0$$\n\n\u901a\u8fc7\u6bcf\u4e00\u9879\u7684\u7cfb\u6570\u53ef\u4ee5\u5f97\u51fa\u521d\u59cb\u77e9\u9635\u4e3a\n$$\\begin{bmatrix}1&0&1\\\\1&0&0\\\\0&1&0\\end{bmatrix}$$\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u77e9\u9635\u5feb\u901f\u5e42\u8fdb\u884c\u6c42\u89e3\u3002\n\n\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u4e2a\u77e9\u9635\u7684$N$\u6b21\u65b9\u7b97\u51fa\u6765\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u662f$F[N+1]$,\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u8f93\u51fa\u7684\u65f6\u5019\u8f93\u51fa\u7b2c\u4e8c\u884c\u7b2c\u4e00\u4e2a\u5143\u7d20\u3002\n\n#### \u9644\u4e0a\u4ee3\u7801\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n\nusing namespace std;\n\ntypedef long long LL;\nconst int Mod = 1e9+7;\nint T, n;\nstruct mat{\n\tLL m[5][5];\n}Ans, base;\ninline void init() {\n\tmemset(Ans.m, 0, sizeof(Ans.m));\n\tfor(int i=1; i<=3; i++) Ans.m[i][i] = 1;\n\tmemset(base.m, 0, sizeof(base.m));\n\tbase.m[1][1] = base.m[1][3] = base.m[2][1] = base.m[3][2] = 1;\n}\ninline mat mul(mat a, mat b) {\n\tmat res;\n\tmemset(res.m, 0, sizeof(res.m));\n\tfor(int i=1; i<=3; i++) {\n\t\tfor(int j=1; j<=3; j++) {\n\t\t\tfor(int k=1; k<=3; k++) {\n\t\t\t\tres.m[i][j] += (a.m[i][k] % Mod) * (b.m[k][j] % Mod);\n\t\t\t\tres.m[i][j] %= Mod;\n\t\t\t}\n\t\t}\n\t}\n\treturn res;\n}\ninline void Qmat_pow(int p) {\n\twhile (p) {\n\t\tif(p & 1) Ans = mul(Ans, base);\n\t\tbase = mul(base, base);\n\t\tp >>= 1;\n\t}\n}\n\nint main() {\n\tscanf(\"%d\", &T);\n\twhile (T--) {\n\t\tscanf(\"%d\", &n);\n\t\tif(n <= 3) {\n\t\t\tprintf(\"1\\n\");\n\t\t\tcontinue;\n\t\t}\n\t\tinit();\n\t\tQmat_pow(n);\n\t\tprintf(\"%lld\\n\", Ans.m[2][1]);\n\t}\n}\n/*\nf[i-1]       f[i]\nf[i-2] ----> f[i-1]\nf[i-3]       f[i-2]\nf[i] = f[i-1] * 1 + f[i-2] * 0 + f[i-3] * 1\nf[i-1] = f[i-1] * 1 + f[i-2] * 0 + f[i-3] * 0\nf[i-2] = f[i-1] * 0 + f[i-2] * 1 + f[i-3] * 0\nso\n1 0 1\n1 0 0\n0 1 0\n*/\n```",
        "postTime": 1533512863,
        "uid": 60941,
        "name": "\u5954\u6ce2\u513f\u9738",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "\u8fd9\u662f\u672c\u849f\u84bb\u7b2c\u4e00\u7bc7\u9898\u89e3 \u5e0c\u671b\u5ba1\u6838\u8fc7\u5427\n\n\u5173\u4e8e\u8fd9\u9053\u9898\u76ee \u4e3b\u8981\u96be\u70b9\u8fd8\u662f\u5728\u4e8e\u521d\u59cb\u77e9\u9635\u7684\u63a8\u5bfc \u53e6\u5916\u4e00\u9053\u76f8\u4f3c\u7684\u6590\u6ce2\u90a3\u5951 \u4e5f\u662f\u540c\u6837\n\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u8fd9\u9053\u9898\u76ee\u7684\u63a8\u5bfc\u662f\u8fd9\u6837\u7684\n\n\u7531\nF[i-1] , F[i-2] , F[i-3]\n\n\u8fd9\u4e2a\u72b6\u6001 \u63a8\u81f3\n\nF[i] , F[i-1] , F[i-2]\n\n\u8fd9\u4e2a\u77e9\u9635\u7684\u63a8\u5bfc \u53ef\u4ee5\u77e5\u9053\u662f\u8fd9\u6837\u7684\uff1a\n\n           F[i]=F[i-1]*1+F[i-2]*0+F[i-3]*1;\n\n\u6240\u4ee5\u77e9\u9635\u7684\u7b2c\u4e00\u5217 \u5e94\u8be5\u662f 1 0 1;\n\n           F[i-2]=F[i-1]*0+F[i-2]*1+F[i-3]*0;\n\n\u6240\u4ee5\u77e9\u9635\u7b2c\u4e8c\u5217 \u5e94\u8be5\u662f 0 1 0;\n\n\u540c\u6837 F[i-3]=F[i-1]*0+F[i-2]*0+F[i-3]*1;\n\n\u6240\u4ee5\u77e9\u9635\u7b2c\u4e09\u5217\u4fbf\u662f 0 0 1;\n\n\n\u6240\u4ee5\u8bf4 \u6211\u4eec\u901a\u8fc7\u5bf9\u524d\u540e\u77e9\u9635\u7684\u63a8\u5bfc \u4fbf\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a3\\*3\u7684\u77e9\u9635\uff1a\n\n1 0 0\n\n0 1 0\n\n1 0 1\n\n\u7136\u540e\u5c31\u662f\u77e9\u9635\u5feb\u901f\u5e42\u7684\u6a21\u677f\u4e86 (\u5982\u679c\u8fd8\u4e0d\u4f1a\u7684\u8bdd\u5feb\u53bb\u5237\u6a21\u677f)\n\n\u5f53\u7136\u4e86 \u5173\u4e8e\u77e9\u9635\u7684\u63a8\u5bfc\u6709\u5f88\u591a\u4e0d\u540c\u7684\u601d\u8def \u4e0d\u8fc7\u6211\u53ea\u662f\u628a\u6211\u7684\u8be6\u7ec6\u601d\u8def\u548c\u60f3\u6cd5\u5448\u73b0\u51fa\u6765\n\n\u4ed4\u7ec6\u60f3 \u8ba4\u771f\u6253 \u8fd8\u662f\u53ef\u4ee5\u6253\u51fa\u6765\u7684\n\n\n\u4e0a\u4ee3\u7801  \u7565\u4e11\u3002\u3002\n\n\n\n\n```cpp\n#include<algorithm>\n#include<iostream>\n#include<cstdlib>\n#include<cstring>\n#include<vector>\n#include<cstdio>\n#include<cmath>\n#include<queue>\n#include<stack>\n#include<map>\n#include<set>\nusing namespace std;\nstruct sj{\n   long long a[4][4];\n}ss;\nint k,t;\nsj X(sj s,sj kk)\n{\n    sj cx;\n    memset(cx.a,0,sizeof(cx.a));\n    for(int i=1;i<=3;i++)\n    for(int j=1;j<=3;j++)\n    for(int k=1;k<=3;k++)\n    {\n        cx.a[i][j]+=(s.a[i][k]*kk.a[k][j])%1000000007;\n        cx.a[i][j]%=1000000007;\n    }\n    return cx;\n}\nsj quick_pow(sj kk,int n)\n{\n    if(n<=1)return kk;\n    sj cx=kk; n--; \n    while(n>0)\n    {\n        if(n%2==1)\n        cx=X(cx,kk);\n        n/=2;\n        kk=X(kk,kk);\n    }\n    return cx;\n}\nint main()\n{\n    memset(ss.a,0,sizeof(ss.a));\n    ss.a[1][1]=1;\n    ss.a[3][1]=1;\n    ss.a[1][2]=1;\n    ss.a[2][3]=1;\n    cin>>t;\n    for(int i=1;i<=t;i++)\n    {\n    scanf(\"%d\",&k);\n    sj kks; \n    memset(kks.a,0,sizeof(kks.a));\n    kks=quick_pow(ss,k-1);\n    cout<<kks.a[1][1]<<endl;\n    }\n}\n```",
        "postTime": 1509726266,
        "uid": 44008,
        "name": "Beau_Kang",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "\u9996\u5148\u5728\u505a\u8fd9\u9053\u9898\u4e4b\u524d\u4f60\u9700\u8981\u5c06  \u77e9\u9635\u5feb\u901f\u5e42  <https://www.luogu.org/problemnew/show/3390>\u8fd9\u9898A\u6389\uff0c\u5e76\u4e14\u6df1\u523b\u7684\u7406\u89e3\u5982\u4f55   \u6784\u9020\u77e9\u9635  <http://www.cnblogs.com/frog112111/archive/2013/05/19/3087648.html> \u628a\u8fd9\u4e9b\u51c6\u5907\u505a\u597d\u540e\uff0c\u6211\u4eec\u5f00\u59cb\u770b\u9898\u3002\n\n\u9898\u76ee\u7ed9\u51fa\u4e86\u4e00\u4e2a\u9012\u63a8\u5173\u7cfb\u5f0fa[1]=a[2]=a[3]=1\uff0ca[x]=a[x-3]+a[x-1] (x>3)\uff0c\u6211\u4eec\u9700\u8981\u6c42\u5b83\u7684\u7b2cn\u9879\u53d6\u6a21\u7684\u7ed3\u679c\uff0c\u521d\u770b\u8fd9\u9053\u9898\uff0c\u4e5f\u8bb8\u4f1a\u4e0d\u7ecf\u610f\u50cf\u8d77\u6590\u6ce2\u90a3\u5951\u6570\u5217\uff0c\u7684\u786e\u8fd9\u4e2a\u901a\u9879\u516c\u5f0f\u5f88\u50cf\uff0c\u90a3\u4e48\u5c0f\u6570\u636en<100\u66b4\u529b\u6c42\u89e3\u4e00\u5b9a\u80fd\u8fc7\uff1b\u90a3\u66f4\u9ad8\u5206\u5462\uff0c\u5728\u6ca1\u5b66\u77e9\u9635\u4e58\u6cd5\u5feb\u901f\u5e42\u4e4b\u524d\uff0c\u5b8c\u5168\u60f3\u4e0d\u5230\u8fd9\u4e0e\u90a3\u4e2a\u6709\u4ec0\u4e48\u5173\u7cfb\uff08\u5efa\u8bae\u53bb\u770b\u770b\u5927\u5b66\u7684\u7ebf\u6027\u4ee3\u6570\uff0c\u4f1a\u6709\u66f4\u6df1\u7684\u7406\u89e3\uff09\uff0c\u4e8b\u5b9e\u4e0a\u8fd9\u9053\u9898\u5982\u679c\u80fd\u60f3\u5230\u77e9\u9635\u52a0\u901f\u90a3\u4e48\u5c31\u53ea\u5269\u4e0b\u5982\u4f55\u6784\u9020\u77e9\u9635\u4e86\uff0c\u8fd9\u662f\u6700\u5173\u952e\u7684\uff1a\n\n\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u601d\u8003\uff0c\u9898\u76ee\u7ed9\u51fa\u4e86\u521d\u59cb\u6761\u4ef6 a[1]=a[2]=a[3]=1,\u8fd9\u5f88\u91cd\u8981\uff0c\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u4e00\u6b21\u63a8\u7b97\uff0c\u7b97\u51faa[4],\u4e8b\u5b9e\u4e0a\u8fd9\u5df2\u7ecf\u8fdb\u884c\u4e86\u4e00\u6b21\u77e9\u9635\u4e58\u6cd5\uff0c\u5982\u4e0b\u56fe\uff1a\n\n ![](https://cdn.luogu.com.cn/upload/pic/10791.png) \n\n\u7136\u540e\u5957\u7528\u77e9\u9635\u4e58\u6cd5\u5feb\u901f\u5e42\u5c31\u884c\u4e86\uff0c\u5b8c\u7f8e\u3002\n\n```cpp\n#include<iostream>\n#include<cstdlib>\n#include<cstring>\n#include<cstdio>\n#include<cmath>\n#define LL long long\n#define mod 1000000007\nusing namespace std;\nLL T,n,k;\nstruct pl{\n    LL a[105][105];\n}p,pp;\npl work(pl work,pl y)           //\u77e9\u9635\u4e58\u6cd5\n{\n    pl box;\n    memset(box.a,0,sizeof(box.a));\n    for(LL i=1;i<=3;i++)\n    {\n        for(LL k=1;k<=3;k++)\n        {\n            if(work.a[i][k])\n            for(LL j=1;j<=3;j++)\n            {\n                box.a[i][j]=(box.a[i][j]+(work.a[i][k]*y.a[k][j])%mod)%mod;\n            }\n        }\n    }\n    return box;\n}\npl fastpow(LL kk)             //\u5feb\u901f\u5e42\n{\n    pl ans;\n    memset(ans.a,0,sizeof(ans.a));\n    for(LL i=1;i<=3;i++) ans.a[i][i]=1;\n    while(kk)\n    {\n        if(kk&1) ans=work(ans,p);\n        kk>>=1;\n        p=work(p,p);\n    }\n    return ans;\n}\nint main()\n{\n    scanf(\"%lld\",&T);\n    while(T--)\n    {\n        memset(p.a,0,sizeof(p.a));\n        p.a[1][3]=p.a[2][1]=p.a[3][2]=p.a[3][3]=1;\n        scanf(\"%lld\",&k);\n        if(k<=3) printf(\"1\\n\");\n        else\n        {\n            pp=fastpow(k-3);\n            /*for(LL i=1;i<=3;i++)\n            {\n                for(LL j=1;j<=3;j++)\n                printf(\"%lld \",pp.a[i][j]);   \n                printf(\"\\n\");\n            } */\n            printf(\"%lld\\n\",(pp.a[1][3]+pp.a[2][3]+pp.a[3][3])%mod);  //\u56e0\u4e3a\u521d\u59cb\u72b6\u6001\u4e3a a[1]=1,a[2]=1,a[3]=1,\u90fd\u4e3a1\uff0c\u5c31\u6ca1\u5fc5\u8981\u518d\u505a\u4e00\u6b21\u77e9\u9635\u4e58\u6cd5\u4e86\u4e0d\uff0c\u592a\u9ebb\u70e6\u4e86\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1510284352,
        "uid": 44478,
        "name": "kpl000",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "\u672c\u9898\u9700\u8981\u7528\u5230\u77e9\u9635\u52a0\u901f\n\n\u5148\u4ecb\u7ecd\u4e00\u4e0b**\u77e9\u9635\u52a0\u901f**\uff01\n\n#### \u77e9\u9635\u52a0\u901f\n\n###### 1.\u4ece\u77e9\u9635\u5feb\u901f\u5e42\u8bf4\u8d77\n\n\u77e9\u9635\u4e58\u6cd5\u7684\u5b9a\u4e49\u662f\uff1a\u8bbe$C = A * B$\uff0cA\u7684\u884c\u6570\u4e0eB\u7684\u5217\u6570\u76f8\u7b49\uff0c$n$\u4e3a\u77e9\u9635A\u7684\u5217\u6570\uff08\u6216\u77e9\u9635B\u7684\u884c\u6570\uff09\uff0c\u5219$C_{ij} = \\sum^{n}_{k=1} A_{ik} * B_{kj}$\u3002\u77e9\u9635\u7684\u5e42\u8fd0\u7b97\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5feb\u901f\u5e42\uff0c\u53ea\u662f\u5c06\u5b9e\u6570\u4e58\u6362\u4e3a\u4e86\u77e9\u9635\u4e58\u3002\n\n\u6b64\u5916\uff0c\u5728\u77e9\u9635\u4e58\u6cd5\u4e2d\uff0c\u6709\u4e00\u79cd\u7279\u6b8a\u7684\u77e9\u9635\uff0c\u5b83\u7684\u503c\u4e3a:$\\begin{bmatrix} 1 & 0 & ... & 0 \\\\ 0 & 1 & ... & 0 \\\\ ... & ... & ... & ...\\\\ 0 & 0 & ... & 1 \\end{bmatrix}$\n\n\u5373\u9664\u4e86\u5bf9\u89d2\u7ebf\u4e0a\u7684\u6570\u5b57\u4e3a1\u5916\u5176\u4f59\u7686\u4e3a0\u7684\u65b9\u9635\uff0c\u8be5\u77e9\u9635\u4e58\u4efb\u4f55\u77e9\u9635\u7ed3\u679c\u5747\u4e3a\u539f\u77e9\u9635\u3002\u6211\u4eec\u79f0\u8fd9\u4e2a\u77e9\u9635\u4e3a\u5355\u4f4d\u77e9\u9635\uff0c\u5b83\u7684\u4f5c\u7528\u7c7b\u4f3c\u4e8e\u6574\u6570\u4e58\u6cd5\u4e2d\u76841\u3002\n\n\u4e0b\u9762\u8d34\u4ee3\u7801\uff1a\n```cpp\nstruct Matrix {\n  int m[110][110];\n  int size;\n\n  Matrix() {\n    size = 0;\n    memset(m, 0, sizeof(m));\n  }\n\n  Matrix(int mode, int s) {\n    if (mode == 0) {\n      size = s;\n      memset(m, 0, sizeof(m));\n    }\n    if (mode == 1) {\n      size = s;\n      memset(m, 0, sizeof(m));\n      for (int i = 1; i <= size; ++i) {\n        m[i][i] = 1;\n      }\n    } //\u6784\u9020\u5355\u4f4d\u77e9\u9635\n  }\n\n  Matrix operator*(Matrix& rhs) {\n    Matrix t;\n    int n = this->size;\n    for (int i = 1; i <= n; ++i) {\n      for (int j = 1; j <= n; ++j) {\n        for (int k = 1; k <= n; ++k) {\n          t.m[i][j] += this->m[i][k] * rhs.m[k][j];\n        }\n      }\n    }\n    t.size = this->size;\n    return t;\n  } //\u77e9\u9635\u4e58\n\n  void read(int s) {\n    size = s;\n    for (int i = 1; i <= size; ++i) {\n      for (int j = 1; j <= size; ++j) {\n        scanf(\"%lld\", &this->m[i][j]);\n      }\n    }\n  }\n\n  void print() {\n    for (int i = 1; i <= size; ++i) {\n      for (int j = 1; j <= size; ++j) {\n        printf(\"%lld \", this->m[i][j]);\n      }\n      printf(\"\\n\");\n    }\n  }\n}; //\u8f93\u51fa\u77e9\u9635\n\nMatrix fast_power_matrix(Matrix x, int n) {\n  Matrix ans(1, x.size);\n  while (n) {\n    if (n & 1) {\n      ans = ans * x;\n    }\n    x = x * x;\n    n >>= 1;\n  }\n  return ans;\n} //\u77e9\u9635\u5feb\u901f\u5e42\n```\n\n~~(\u76f4\u63a5\u590d\u5236\u7c98\u8d34\u7684\u9001\u4f60\u89c1\u7956\u5b97\u54e6=\u03c9)~~\n\n###### \u77e9\u9635\u52a0\u901f\n\n\u8bb2\u5b8c\u4e86\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u90a3\u4e48\u4ec0\u4e48\u662f\u77e9\u9635\u52a0\u901f\u5462\uff1f\n\n\u5bf9\u4e8e$a_{i}=a_{i-x}+a_{i-y}+a_{i-z}+...$\u8fd9\u6837\u7684\u9012\u63a8\u5f0f\uff08\u8be5\u9012\u63a8\u5f0f\u7684\u9879\u6570\u4e0e\u6700\u540e\u7684\u8fd0\u884c\u65f6\u7684\u65f6\u95f4\u5f00\u9500\u6709\u5173\uff0c\u8bbe\u6c42\u7b2cn\u9879\uff0c\u9012\u63a8\u5f0f\u9879\u6570\u4e3am\uff0c\u5219\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(m^{3}logn)$\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u77e9\u9635$\\begin{bmatrix} a_{i-x}\\\\ a_{i-y}\\\\ a_{i-z}\\\\ ... \\end{bmatrix}$\n\n\u8054\u7cfb\u4e0a\u9762\u6240\u8bf4\u5230\u7684\u77e5\u8bc6\uff0c\u663e\u7136\u8fd9\u91cc\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u77e9\u9635\u4f7f\u4e0a\u9762\u7684\u77e9\u9635\u548c\u6784\u9020\u7684\u77e9\u9635\u76f8\u4e58\u5f97\u51fa\u4ee5\u4e0b\u77e9\u9635\uff1a$\\begin{bmatrix} a_{i}\\\\ a_{i-x}\\\\ a_{i-y}\\\\ ... \\end{bmatrix}$\n\n\u7531\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u9012\u63a8\u5f0f\u5f00\u59cb\u7684\u9012\u63a8\u5f0f\u8d77\u59cb\u7684\u5df2\u77e5\u6216\u6613\u6c42\u5f97\u7684\u51e0\u9879\u7ec4\u6210\u7684\u77e9\u9635\u4e0d\u65ad\u4e58\u4e0a\u4e00\u4e2a\u6784\u9020\u7684\u77e9\u9635\u5f97\u5230\u7b54\u6848\u3002\u53c8\u77e9\u9635\u4e58\u6cd5\u7684\u7ed3\u5408\u5f8b\u53ef\u5f97\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u6784\u9020\u7684\u77e9\u9635\u8fdb\u884c\u6c42\u5e42\u8fd0\u7b97\uff0c\u518d\u4e58\u4e0a\u521d\u59cb\u77e9\u9635\u76f4\u63a5\u5f97\u5230\u7b54\u6848\u3002\n\n\u73b0\u5728\uff0c\u4ee5\u672c\u9898\u4e3a\u4f8b\uff0c\u8bb2\u89e3\u77e9\u9635\u5982\u4f55\u8fdb\u884c\u6784\u9020\u3002\n\n\u672c\u9898\u7684\u9012\u63a8\u5f0f\u4e3a$a_{i}=a_{i-1}+a_{i-3}$\uff0c$a_{1}=a_{2}=a_{3}=1$\uff0c\u5219\u5f97\u521d\u59cb\u77e9\u9635$\\begin{bmatrix} a_{i-3}\\\\ a_{i-2}\\\\ a_{i-1} \\end{bmatrix}$\n\n\u73b0\u5728\u6211\u4eec\u8981\u6c42\u7684\u4e00\u4e2a\u77e9\u9635\u4f7f\u5b83\u4e0e\u521d\u59cb\u77e9\u9635\u76f8\u4e58\u4e3a\uff1a$\\begin{bmatrix} a_{i-2}\\\\ a_{i-1}\\\\ a_{i-3}+a_{i-1} \\end{bmatrix}$\n\n\u6613\u5f97\u8be5\u77e9\u9635\u4e3a:$\\begin{bmatrix} 0 & 1 & 0\\\\ 0 & 0 & 1\\\\ 1 & 0 & 1 \\end{bmatrix}$\n\n###### \u89e3\u91ca\uff1a\n\u8bbe$\\begin{bmatrix} 0 & 1 & 0\\\\ 0 & 0 & 1\\\\ 1 & 0 & 1 \\end{bmatrix}$\u4e0e$\\begin{bmatrix} a_{i-3}\\\\ a_{i-2}\\\\ a_{i-1} \\end{bmatrix}$\u76f8\u4e58\u5f97\u77e9\u9635$C$\uff0c\u5219\n$$C_{11}=a_{i-3}*0+a_{i-2}*1+a_{i-1}*0=a_{i-2}$$\n$$C_{12}=a_{i-3}*0+a_{i-2}*0+a_{i-1}*1=a_{i-1}$$\n$$C_{13}=a_{i-3}*1+a_{i-2}*0+a_{i-1}*1=a_{i-3}+a_{i-1}=a_{i}$$\n\u6240\u4ee5\u5f97\u5230\u7684\u77e9\u9635$C$\u4e3a$\\begin{bmatrix} a_{i-2}\\\\ a_{i-1}\\\\ a_{i} \\end{bmatrix}$\u3002\n\n\u63a5\u4e0b\u6765\u5373\u53ef\u5bf9\u7ed3\u679c\u8fdb\u884c\u8ba1\u7b97\uff0c\u5982\u6c42$a_{i}$:$\\begin{bmatrix} 0 & 1 & 0\\\\ 0 & 0 & 1\\\\ 1 & 0 & 1 \\end{bmatrix}^{i-3} * \\begin{bmatrix} 1\\\\ 1\\\\ 1 \\end{bmatrix} = \\begin{bmatrix} a_{i-2}\\\\ a_{i-1}\\\\ a_{i} \\end{bmatrix}$\n\n\u9644AC\u4ee3\u7801\uff1a\n\n```cpp\n#include <algorithm>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n\nusing namespace std;\n\nconst int MOD = 1000000007;\n\nstruct Matrix {\n  long long m[110][110];\n  int size;\n\n  Matrix() {\n    size = 0;\n    memset(m, 0, sizeof(m));\n  }\n\n  Matrix(int mode, int s) {\n    if (mode == 0) {\n      size = s;\n      memset(m, 0, sizeof(m));\n    }\n    if (mode == 1) {\n      size = s;\n      memset(m, 0, sizeof(m));\n      for (int i = 1; i <= size; ++i) {\n        m[i][i] = 1;\n      }\n    }\n  }\n\n  Matrix operator*(Matrix& rhs) {\n    Matrix t;\n    int n = this->size;\n    for (int i = 1; i <= n; ++i) {\n      for (int j = 1; j <= n; ++j) {\n        for (int k = 1; k <= n; ++k) {\n          t.m[i][j] += (this->m[i][k] % MOD * rhs.m[k][j] % MOD) % MOD;\n          t.m[i][j] %= MOD;\n        }\n      }\n    }\n    t.size = this->size;\n    return t;\n  }\n\n  void read(int s) {\n    size = s;\n    for (int i = 1; i <= size; ++i) {\n      for (int j = 1; j <= size; ++j) {\n        scanf(\"%lld\", &this->m[i][j]);\n      }\n    }\n  }\n\n  void print() {\n    for (int i = 1; i <= size; ++i) {\n      for (int j = 1; j <= size; ++j) {\n        printf(\"%lld \", this->m[i][j]);\n      }\n      printf(\"\\n\");\n    }\n  }\n};\n\nMatrix fast_power_matrix(Matrix x, long long n) {\n  Matrix ans(1, x.size);\n  while (n) {\n    if (n & 1) {\n      ans = ans * x;\n    }\n    x = x * x;\n    n >>= 1;\n  }\n  return ans;\n}\n\nlong long T, n;\nint t[2][30] = { { 0 } }, res[2][30];\nMatrix mt;\n\nint main() {\n  scanf(\"%lld\", &T);\n  mt.size = 3;\n  for (int i = 1; i <= 3; i++) {\n    t[1][i] = 1;\n  }\n  for (int i = 1; i <= T; i++) {\n    memset(res, 0, sizeof(res));\n    memset(mt.m, 0, sizeof(mt.m));\n    scanf(\"%lld\", &n);\n    for (int i = 1; i <= 3; i++) {\n      for (int j = 1; j <= 3; j++) {\n        if (j == i + 1 || (i == 3 && j != 2)) {\n          mt.m[i][j] = 1;\n        }\n      }\n    }\n    if (n > 3) {\n      mt = fast_power_matrix(mt, n - 3);\n      for (int i = 1; i <= 1; ++i) {\n        for (int j = 1; j <= 3; ++j) {\n          for (int k = 1; k <= 3; ++k) {\n            res[i][j] += ((t[i][k] % MOD) * (mt.m[j][k] % MOD)) % MOD;\n            res[i][j] %= MOD;\n          }\n        }\n      }\n      printf(\"%d\\n\", res[1][3]);\n    } else {\n      printf(\"1\\n\");\n    }\n  }\n  return 0;\n}\n```",
        "postTime": 1540816408,
        "uid": 28430,
        "name": "Nerlci_",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "## \u8fd9\u91cc\u63d0\u4f9b\u4e00\u79cd\u4e0d\u4e00\u6837\u7684\u52a0\u901f\u77e9\u9635\n\n\u6211\u770b\u4e86\u4e00\u4e0b\u9898\u89e3\uff0c\u53d1\u73b0\u5927\u4f6c\u4eec\u63d0\u4f9b\u7684\u77e9\u9635\u90fd\u5927\u540c\u5c0f\u5f02\u3002\u4f46\u662f\u6211\u5728\u505a\u8fd9\u9053\u9898\u7684\u65f6\u5019\u624b\u63a8\u51fa\u4e86\u4e00\u79cd\u548c\u5f88\u591a\u4eba\u90fd\u4e0d\u4e00\u6837\u7684\u505a\u6cd5\u3002\n\n\u6211\u5f53\u65f6\u63a8\u5bfc\u7684\u65f6\u5019\u662f\u8fd9\u4e48\u60f3\u7684\uff1a\n\n$$\\begin{bmatrix}a_4 & a_5 & a_6  \\end{bmatrix} = \\begin{bmatrix} a_1 & a_2 & a_3 \\end{bmatrix} \u00d7 \\begin{bmatrix} 1 & 1 &1\\\\ 0 & 1 & 1 \\\\ 1 & 1 & 2\\end{bmatrix}$$\n\n\u5177\u4f53\u7684\u60f3\u6cd5\u662f\u8fd9\u6837\u7684:\n\n$$ a_4=a_1+a_3 $$\n$$ a_5=a_4+a_2=a_1+a_2+a_3 $$\n$$ a_6=a_5+a_3=a_1+a_2+2a_3 $$\n\u4e8e\u662f\u6839\u636e\u77e9\u9635\u4e58\u7684\u539f\u7406\uff0c\u6211\u5c31\u5199\u51fa\u4e86\u8fd9\u4e48\u4e00\u4e2a~~\u770b\u4e0a\u53bb\u5341\u5206\u6076\u5fc3~~\u7684\u5f0f\u5b50\u3002\n\n\u53ef\u4ee5\u6839\u636e\u4e0a\u9762\u63d0\u4f9b\u7684\u6700\u7b80\u5355\u7684\u5f0f\u5b50\u63a8\u51fa\u901a\u5f0f\uff0c\u8fd9\u91cc\u4e0d\u518d\u7ed9\u51fa\u3002\n\n~~Markdown\u77e9\u9635\u662f\u771f\u96be\u5199~~\n\n\u7528\u4e8e\u52a0\u901f\u7684\u77e9\u9635\u5c31\u662f\u4e0b\u9762\u8fd9\u4e2a\uff1a\n\n$$  \\begin{bmatrix} 1 & 1 &1\\\\ 0 & 1 & 1 \\\\ 1 & 1 & 2\\end{bmatrix} $$\n\n\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5bf9\u4e8e\u7ed9\u5b9a\u7684n\uff0c\u5b83\u7684\u6307\u6570\u662f(n-1)/3\uff08\u5f53\u7136\u8981\u4e0b\u53d6\u6574\u5566\uff09\uff0c\u7136\u540e\u53d6\u51fa\u5f97\u5230\u7684\u77e9\u9635\u7684\u7b2cn%3\u9879\uff08\u5982\u679c\u662f0\u5c31\u53d6\u7b2c3\u9879\u554a\uff09\u3002\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#define mod 1000000007\n#define LL long long\nusing namespace std;\nstruct squ{int x,y;LL w[4][4];}base={1,3,{{},{0,1,1,1}}},acc={3,3,{{},{0,1,1,1},{0,0,1,1},{0,1,1,2}}},ans;\nint t,n;\nvoid multi(squ &c,squ a,squ b)\n{\n\tc.x=a.x;c.y=b.y;\n\tmemset(c.w,0,sizeof(c.w));\n\tfor(int i=1;i<=c.x;i++)\n\tfor(int j=1;j<=c.y;j++)\n\tfor(int k=1;k<=a.y;k++)\n\tc.w[i][j]=(c.w[i][j]+a.w[i][k]*b.w[k][j])%mod;\n\treturn;\n}\nsqu ksm(int k)\n{\n\tif(k==1) return acc;\n\tsqu tmp=ksm(k/2),sum;\n\tmulti(sum,tmp,tmp);\n\tif(k%2) multi(sum,sum,acc);\n\treturn sum;\n}\nint main()\n{\n\tscanf(\"%d\",&t);\n\twhile(t--)\n\t{\n\t\tscanf(\"%d\",&n);\n\t\tswitch(n)\n\t\t{\n\t\t\tcase 1:\n\t\t\tcase 2:\n\t\t\tcase 3:printf(\"1\\n\");break;\n\t\t\tdefault:{\n\t\t\t\tmulti(ans,base,ksm((n-1)/3));\n\t\t\t\tint x=n%3;if(!x) x=3;\n\t\t\t\tprintf(\"%d\\n\",ans.w[1][x]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n```\n~~\u5ffd\u7565\u6211\u5947\u4e11\u7684\u7801\u98ce~~",
        "postTime": 1566047734,
        "uid": 88329,
        "name": "Orzalpha",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "### \u697c\u4e0a\u7684\u5927\u4f6c\u5199\u7684\u90fd\u662f\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u6211\u5c31\u4e0d\u518d\u8fdb\u884c\u8bb2\u89e3\u4e86\n\n\u4fd7\u8bdd\u8bf4\uff1a\u201c\u6b8a\u9014\u540c\u5f52\u201d\u3002\u56e0\u6b64\uff0c\u4e00\u4e2a\u9898\u7684\u89e3\u6cd5\u663e\u7136\u6709\u5f88\u591a\u3002~~\u6bd5\u7adf\u5c31\u8fde[a+b](https://www.luogu.org/problemnew/solution/P1001)\u4e5f\u6709LCT\u3001Splay\u7b49~~\n\n\u4e0b\u9762\uff0c\u6211\u5c06\u4ecb\u7ecd\u4e00\u4e2a~~\u795e\u5947\u7684~~\u89e3\u6cd5\u3002\n\n## \u8fc7\u7a0b\u5982\u4e0b\uff1a\n\n\u6839\u636e\u9012\u63a8\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u5f0f\u5b50\uff1a \n\n$$\\text{F(2$\\times$n)=3$\\times$F(2$\\times$n$-$4)$+$F(2$\\times$n$-$5)$+$2$\\times$F(2$\\times$n$-$6)}$$\n\n\u800c\u6211\u4eec\u77e5\u9053\uff0cF(3)$=$1\uff0cF(4)$=$2\uff0cF(5)$=$3\u3002\u56e0\u6b64\n\n$$\\text{F(2$\\times$n)=F(5)$\\times$F(2$\\times$n$-$4)$+$F(3)$\\times$F(2$\\times$n$-$5)+F(4)$\\times$F(2$\\times$n$-$6)}$$\n\n\u5c06 F(2$\\times$n$-$4)$=$F(2$\\times$n$-$5)$+$F(2$\\times$n$-$7) \u4ee3\u5165\uff0c\u5219\n\n$$\\text{F(2$\\times$n)=[F(3)+F(5)]$\\times$F(2$\\times$n$-$5)$+$F(4)$\\times$F(2$\\times$n$-$6)$+$F(5)$\\times$F(2$\\times$n$-$7)}$$\n\n\u800c F(3)$+$F(5)$=$F(6)\uff0c\u6545\uff1a\n\n$$\\text{F(2$\\times$n)=F(6)$\\times$F(2$\\times$n$-$5)$+$F(4)$\\times$F(2$\\times$n$-$6)$+$F(5)$\\times$F(2$\\times$n$-$7)}$$\n\n\u56e0\u6b64\uff0c\u7531\u6570\u5b66\u5f52\u7eb3\u6cd5\u53ef\u77e5\uff1a\n\n$$\\text{F(2$\\times$n)=F(n+1)$\\times$F(n)$+$$F(n-1)^2$$+$F(n)$\\times$F(n-2)}$$\n\n\u5c06 F(n-2) = F(n+1) - F(n) \u4ee3\u5165\uff0c\u53ef\u5f97\uff1a\n\n$$\\text{F(2$\\times$n)=2$\\times$F(n+1)$\\times$F(n)$-$$F(n)^2$$+$$F(n-1)^2$}$$\n\n\u53e6\u4e00\u4e2a\u540c\u7406\u53ef\u5f97\u3002\n\n### \u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u51fa\u4ee5\u4e0b\u7ed3\u8bba\uff1a\n\n$$\\text{F(2$\\times$n)=2$\\times$F(n+1)$\\times$F(n)$-$$F(n)^2$$+$$F(n-1)^2$}$$\n\n$$\\text{F(2$\\times$n+1)=$F(n+1)^2$+2$\\times$F(n)$\\times$F(n-1)}$$\n\n\u7531\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u4ee3\u7801\uff1a\n```cpp\n#include<cstdio>\ntypedef long long ll;\nconst int M=1e9+7;\nll g(ll x)\t{return x*x%M;}\nll f(int x){\n\tif(x<4)\treturn 1;\n\tif(x&1)\treturn (g(f(x+1>>1))+(f(x-1>>1)*f(x-3>>1)<<1))%M;\n\treturn ((f(x+2>>1)*f(x>>1)<<1)-g(f(x>>1))+g(f(x-2>>1)))%M;\n}\ninline int r(){\n    int p=0;char c=getchar();\n    while(c<48||c>57)\tc=getchar();\n    while(c<58&&c>47)\tp=(p<<1)+(p<<3)+(c^48),c=getchar();\n    return p;\n}\nint main(){\n\tint t=r();\n\twhile(t--)\tprintf(\"%lld\\n\",f(r()));\n\treturn 0;\n}\n```\n\u4f46\u662f\uff0c\u5c06\u4e0a\u8ff0\u4ee3\u7801\u63d0\u4ea4\u540e\uff0c\u6211\u4eec\u53d1\u73b0\uff1aTLE\u4e867\u4e2a\u70b9\u3002\n\n\u7a76\u5176\u539f\u56e0\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\uff1a\u6709\u4e9b\u6570\u5b57\u6211\u4eec\u8fdb\u884c\u4e86\u5927\u91cf\u7684\u91cd\u590d\u8fd0\u7b97\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5c06\u5f97\u5230\u7684\u6570\u5b57\u8bb0\u5f55\u4e0b\u6765\u3002\u5f53\u7136\uff0c\u6570\u7ec4\u65e0\u6cd5\u5f00\u8fd9\u4e48\u5927,\u4f46\u662f\u4e5f\u4e0d\u9700\u8981\u5c06\u6bcf\u4e2a\u6570\u90fd\u8bb0\u5f55\u4e0b\u6765\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4f7f\u7528map\u3002\n\n### \u4e0b\u9762\uff0c\u4fbf\u662f\u6838\u5fc3\u4ee3\u7801\uff1a\n```cpp\nll f(int x){\n\tif(!a[x])\n\t\tif(x<4)\ta[x]=1;\n\t\telse if(x&1)\ta[x]=g(f(x+1>>1))+(f(x-1>>1)*f(x-3>>1)<<1);\n\t\telse a[x]=(f(x+2>>1)*f(x>>1)<<1)-g(f(x>>1))+g(f(x-2>>1));\n\treturn a[x]%M;\n}\n```\n~~\u76f8\u4fe1\u5404\u4f4d\u795e\u7287\u90fd\u5df2\u770b\u61c2~~\n\n## \u603b\u7ed3\uff1a\n\n\u8fd9\u79cd\u89e3\u6cd5\u53ea\u5728\u7279\u5b9a\u7684\u6761\u4ef6\u4e0b\u6210\u7acb\uff0c\u5e76\u4e14\u7531\u4e8emap\u7684\u5e38\u6570\u95ee\u9898\uff0c\u8fd9\u79cd\u89e3\u6cd5\u4e5f\u8dd1\u5f97\u6bd4\u77e9\u9635\u5feb\u901f\u5e42\u6162\u3002\u4f46\u662f\uff0c\u5bf9\u4e8e\u90a3\u4e9b\u5bf9\u77e9\u9635\u5feb\u901f\u5e42\u4e0d\u719f\u7684\u4eba\u6765\u8bf4\uff0c\u8fd9\u4e5f\u4e0d\u5931\u4e3a\u4e00\u79cd\u65b0\u7684\u89e3\u6cd5\u3002~~\u8bdd\u8bf4\u6765\u8fd9\u9898\u7684dalao\u4e0d\u4f1a\u77e9\u9635\u5feb\u901f\u5e42\u5417~~\n\n\u6700\u540e\uff0c\u795d\u5927\u5bb6\uff1aCSP-2019 rp++\uff01",
        "postTime": 1560399182,
        "uid": 141555,
        "name": "Trinitrotoluene",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "\u4ece\u77e9\u9635\u57fa\u7840\u8bb2\u8d77\u3002\r\n\r\n$$\\large\\texttt{Part 1 \u57fa\u7840}$$\r\n\r\n$\\large\\texttt{\u5b9a\u4e49}$\r\n\r\n\u7531 $n\\times m$ \u4e2a\u6570\u6392\u6210 $m$ \u884c $n$ \u5217\u77e9\u5f62\u7684\u6570\u8868\r\n\r\n\r\n$$\r\n\r\n\\left(\\begin{array}{cc}\r\na_{11}&a_{12}&\\cdots&a_{1n}\\\\\r\na_{21}&a_{22}&\\cdots&a_{2n}\\\\\r\n\\vdots&\\vdots&\\ddots&\\vdots\\\\\r\na_{m1}&a_{m2}&\\cdots&a_{mn}\\\\\r\n\\end{array}\\right)\r\n\r\n$$\r\n\r\n\u79f0\u4e3a\u4e00\u4e2a $m\\times n$ \u7684\u77e9\u9635\uff0c\u8bb0\u4f5c $A$\u3002\u5176\u4e2d $a_{ij}$ \u79f0\u4e3a\u7b2c $i$ \u884c\u7b2c $j$ \u5217\u7684\u5143\u7d20\u3002\r\n\r\n\r\n$\\large\\texttt{\u7279\u6b8a\u77e9\u9635}$\r\n\r\n$\\texttt{\u96f6\u77e9\u9635}$\r\n\r\n\u6240\u6709\u5143\u7d20\u90fd\u662f\u96f6\u7684\u77e9\u9635\u3002\r\n\r\n$$\r\n\r\n\\left(\\begin{array}{cc}\r\n0&0&\\cdots&0\\\\\r\n0&0&\\cdots&0\\\\\r\n\\vdots&\\vdots&\\ddots&\\vdots\\\\\r\n0&0&\\cdots&0\\\\\r\n\\end{array}\\right)\r\n\r\n$$\r\n\r\n\u8bb0\u4e3a $\\texttt{0}$ \u3002$^{(1)}$\r\n\r\n$\\texttt{\u5bf9\u89d2\u77e9\u9635}$\r\n\r\n\u5728\u4e00\u4e2a $n\\times n$ \u7684\u77e9\u9635\u91cc\uff0c\u53ea\u6709\u4e3b\u5bf9\u89d2\u7ebf\u6709\u503c\u3002\r\n\r\n$$\r\n\r\n\\left(\\begin{array}{cc}\r\na_{11}&0&\\cdots&0\\\\\r\n0&a_{22}&\\cdots&0\\\\\r\n\\vdots&\\vdots&\\ddots&\\vdots\\\\\r\n0&0&\\cdots&a_{nn}\\\\\r\n\\end{array}\\right)\r\n\r\n$$\r\n\r\n$\\texttt{\u5355\u4f4d\u77e9\u9635}$\r\n\r\n\u4e00\u4e2a\u5bf9\u89d2\u77e9\u9635\u5207\u5bf9\u89d2\u7ebf\u4e0a\u90fd\u662f $1$\u3002\r\n\r\n$$\r\n\r\n\\left(\\begin{array}{cc}\r\n1&0&\\cdots&0\\\\\r\n0&1&\\cdots&0\\\\\r\n\\vdots&\\vdots&\\ddots&\\vdots\\\\\r\n0&0&\\cdots&1\\\\\r\n\\end{array}\\right)\r\n\r\n$$\r\n\r\n\u8bb0\u4f5c $I$ \u3002\r\n\r\n$\\texttt{\u4e0a\u4e09\u89d2\u77e9\u9635}$\r\n\r\n\u53ea\u6709\u53f3\u4e0a\u7684\u4e00\u90e8\u5206\u6709\u503c\uff0c\u4e3b\u5bf9\u89d2\u7ebf\u4ee5\u4e0b\u90fd\u662f $0$\u3002\r\n\r\n$$\r\n\r\n\\left(\\begin{array}{cc}\r\na_{11}&a_{12}&\\cdots&a_{1n}\\\\\r\n0&a_{22}&\\cdots&a_{2n}\\\\\r\n\\vdots&\\vdots&\\ddots&\\vdots\\\\\r\n0&0&\\cdots&a_{nn}\\\\\r\n\\end{array}\\right)\r\n\r\n$$\r\n\r\n\u4e3b\u8981\u7684\u7279\u6b8a\u77e9\u9635\u5c31\u8fd9\u4e9b\u3002$^{(2)}$\r\n\r\n$\\large\\texttt{\u77e9\u9635\u8fd0\u7b97}$\r\n\r\n$\\texttt{\u76f8\u7b49}$\r\n\r\n\u77e9\u9635 $A,B$ \u76f8\u7b49\u5f53\u4e14\u4ec5\u5f53\u4ed6\u4eec\u5927\u5c0f\u76f8\u7b49\u4e14\u5bf9\u4e8e\u6240\u6709 $ij$ \u90fd\u6709 $a_{ij}=b_{ij}$\r\n\r\n\u5b98\u65b9\u5b9a\u4e49\uff0c\u603b\u7ed3\u6210\u4e00\u53e5\u8bdd\uff0c\u5c31\u662f\u4ed6\u4eec\u957f\u7684\u4e00\u6a21\u4e00\u6837\u3002\r\n\r\n$$\r\n\\left(\\begin{array}{cc}\r\na_{11}&a_{12}&\\cdots&a_{1n}\\\\\r\na_{21}&a_{22}&\\cdots&a_{2n}\\\\\r\n\\vdots&\\vdots&\\ddots&\\vdots\\\\\r\na_{m1}&a_{m2}&\\cdots&a_{mn}\\\\\r\n\\end{array}\\right)=\\left(\\begin{array}{cc}\r\na_{11}&a_{12}&\\cdots&a_{1n}\\\\\r\na_{21}&a_{22}&\\cdots&a_{2n}\\\\\r\n\\vdots&\\vdots&\\ddots&\\vdots\\\\\r\na_{m1}&a_{m2}&\\cdots&a_{mn}\\\\\r\n\\end{array}\\right)\r\n\r\n$$\r\n\r\n$\\texttt{\u77e9\u9635\u52a0\u6cd5}$\r\n\r\n\u82e5 $C=A+B$ \u5219\u5bf9\u4e8e\u6240\u6709 $ij$ \u90fd\u6709 $c_{ij}=a_{ij}+b_{ij}$ \u3002\r\n\r\n\u8981\u6c42 $A$ \u7684\u5927\u5c0f\u8981\u7b49\u4e8e $B$ \u7684\u5927\u5c0f\u3002\r\n\r\n\u603b\u7ed3\u6210\u4e00\u53e5\u8bdd\uff0c\u4e00\u4e2a\u4e00\u4e2a\u52a0\u3002\r\n\r\n$$\r\n\\left(\\begin{array}{cc}\r\na_{11}&a_{12}&\\cdots&a_{1n}\\\\\r\na_{21}&a_{22}&\\cdots&a_{2n}\\\\\r\n\\vdots&\\vdots&\\ddots&\\vdots\\\\\r\na_{m1}&a_{m2}&\\cdots&a_{mn}\\\\\r\n\\end{array}\\right)+\\left(\\begin{array}{cc}\r\nb_{11}&b_{12}&\\cdots&b_{1n}\\\\\r\nb_{21}&b_{22}&\\cdots&b_{2n}\\\\\r\n\\vdots&\\vdots&\\ddots&\\vdots\\\\\r\nb_{m1}&b_{m2}&\\cdots&b_{mn}\\\\\r\n\\end{array}\\right)=\\left(\\begin{array}{cc}\r\na_{11}+b_{11}&a_{12}+b_{12}&\\cdots&a_{1n}+b_{1n}\\\\\r\na_{21}+b_{21}&a_{22}+b_{22}&\\cdots&a_{2n}+b_{2n}\\\\\r\n\\vdots&\\vdots&\\ddots&\\vdots\\\\\r\na_{m1}+b_{m1}&a_{m2}+b_{m2}&\\cdots&a_{mn}+b_{mn}\\\\\r\n\\end{array}\\right)\r\n\r\n$$\r\n\r\n\u51cf\u540c\u7406\u3002\r\n\r\n$\\texttt{\u77e9\u9635\u7684\u6570\u91cf\u4e58\u6cd5}$\r\n\r\n\u7528\u4e00\u4e2a\u6570 $k$ \u53bb\u4e58 $A$ \u5c31\u7b49\u4e8e $k$ \u6210\u4ed6\u7684\u6bcf\u4e00\u4f4d\u3002\r\n\r\n\u603b\u7ed3\u6210\u4e00\u53e5\u8bdd\uff0c\u4e00\u4e2a\u4e00\u4e2a\u4e58\u3002\r\n\r\n\r\n$$\r\nk\\left(\\begin{array}{cc}\r\na_{11}&a_{12}&\\cdots&a_{1n}\\\\\r\na_{21}&a_{22}&\\cdots&a_{2n}\\\\\r\n\\vdots&\\vdots&\\ddots&\\vdots\\\\\r\na_{m1}&a_{m2}&\\cdots&a_{mn}\\\\\r\n\\end{array}\\right)=\\left(\\begin{array}{cc}\r\nka_{11}&ka_{12}&\\cdots&ka_{1n}\\\\\r\nka_{21}&ka_{22}&\\cdots&ka_{2n}\\\\\r\n\\vdots&\\vdots&\\ddots&\\vdots\\\\\r\nka_{m1}&ka_{m2}&\\cdots&ka_{mn}\\\\\r\n\\end{array}\\right)\r\n\r\n$$\r\n\r\n$\\texttt{\u77e9\u9635\u4e58\u6cd5}$\r\n\r\n\u9996\u5148\u8981\u6c42 $A$ \u7684\u5217\u6570\u8981\u7b49\u4e8e $B$ \u7684\u884c\u6570\u3002\r\n\r\n\u82e5 $A=(a_{ij})_{m\\times r}$ \uff0c$B=(b_{ij})_{r\\times n}$\uff0c\u5219\u4e58\u51fa\u7684\u77e9\u9635\u5927\u5c0f\u662f $C=(c_{ij})_{m\\times n}$\r\n\r\n\u5176\u4e2d \r\n\r\n$$c_{ij}=\\sum_{k=1}^n a_{ik}\u00b7b_{kj}$$\r\n\r\n\u79f0\u4e3a $A$ \u4e0e $B$ \u7684\u4e58\u79ef\uff0c\u8bb0\u505a $C=AB$\u3002$^{(3)}$\r\n\r\n\u77e9\u9635\u4e58\u6cd5\u7684\u6027\u8d28\uff1a\r\n\r\n\u4efb\u4f55\u77e9\u9635\u4e58 $\\texttt{0}$ \u5f97 $\\texttt{0}$\uff1a$\\texttt{0}A=A\\texttt{0}=\\texttt{0}$\r\n\r\n\u4efb\u4f55\u77e9\u9635\u4e58 $I$ \u5f97\u672c\u8eab\uff1a$IA=AI=A$\r\n\r\n\u7ed3\u5408\u5f8b\uff1a$A(BC)=(AB)C$\r\n\r\n\u5de6\u5206\u914d\u5f8b\uff1a$A(B+C)=AB+AC$\r\n\r\n\u53f3\u5206\u914d\u5f8b\uff1a$(B+C)A=BA+CA$\r\n\r\n\u6ce8\u610f\u77e9\u9635\u4e58\u6cd5\u6ca1\u6709\u4ea4\u6362\u5f8b\u3002\r\n\r\n$$\\large\\texttt{Part 2 \u5e94\u7528}$$\r\n\r\n$\\large\\texttt{\u77e9\u9635\u5feb\u901f\u5e42}$\r\n\r\n\u6c42\u4e00\u4e2a\u77e9\u9635 $A$ \u7684 $k$ \u6b21\u65b9\u3002\r\n\r\n\u73b0\u5728\u6765\u5206\u6790\u4e00\u4e0b\u95ee\u9898\uff0c\u5c31\u662f\u6c42\uff1a\r\n\r\n$$\r\n\\begin{matrix} n \\\\ \\overbrace{ A\\times A\\times A\\times A\\times \\dots\\times A } \\end{matrix}\r\n$$\r\n\r\n\u6839\u636e\u7ed3\u5408\u5f8b\uff1a\r\n\r\n$$\r\n\\begin{matrix} \\frac{n}{2} \\\\ \\overbrace{ ( A\\times A\\times \\dots\\times A) } \\end{matrix}\r\n\\begin{matrix} ~~~\\frac{n}{2} \\\\\\times \\overbrace{ (A\\times A\\times \\dots\\times A) } \\end{matrix}\r\n$$\r\n\r\n\u5c31\u662f $(A^{\\frac{n}{2}})^2$\r\n\r\n\u5206\u6cbb\u5feb\u901f\u5e42\u7684\u6027\u8d28\u4ecd\u7136\u5728\u3002$^{(4)}$\r\n\r\n\u5c31\u548c\u5feb\u901f\u5e42\u4e00\u6837\u505a\u5c31\u597d\u4e86\r\n\r\n$\\large\\texttt{\u6590\u6ce2\u90a3\u5951\u6570\u5217}$\r\n\r\n\u7cbe\u5178\uff01\r\n\r\n\u6784\u9020\u4e00\u4e2a $1\\times 2$ \u7684\u77e9\u9635\uff1a\r\n\r\n$$\r\n\\left(\\begin{array}{cc}\r\nF_{2}&F_{1}\\\\\r\n\\end{array}\\right)\r\n$$\r\n\r\n\u548c\u4e00\u4e2a $2\\times 2$ \u7684\u77e9\u9635\uff1a\r\n\r\n$$\r\n\\left(\\begin{array}{cc}\r\n1&1\\\\\r\n1&0\\\\\r\n\\end{array}\\right)\r\n$$\r\n\r\n\u4e24\u4e2a\u505a\u77e9\u9635\u4e58\u6cd5\uff1a\r\n\r\n$$c_{11}=\\sum_{k=1}^n a_{ik}\u00b7b_{kj}=a_{11}\\times b_{11}+a_{12}\\times b_{21}=F_2+F_1=F_3$$\r\n\r\n$$c_{12}=\\sum_{k=1}^n a_{ik}\u00b7b_{kj}=a_{11}\\times b_{12}+a_{12}\\times b_{22}=F_2$$\r\n\r\n\u7ed3\u679c\u662f\r\n\r\n$$\r\n\\left(\\begin{array}{cc}\r\nF_{3}&F_{2}\\\\\r\n\\end{array}\\right)\r\n$$\r\n\r\n\u770b\u5230\u6ca1\u6709\uff0c\u5f80\u524d\u63a8\u4e86\u4e00\u4f4d\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5c06\u4ed6\u4e58 $n-1$ \u4e2a\u77e9\u9635\uff0c\u5c31\u80fd\u5f97\u5230\u7b54\u6848\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u7528\u5feb\u901f\u5e42\u6c42\u3002\r\n\r\n$\\large\\texttt{\u77e9\u9635\u52a0\u901f}$\r\n\r\n\u641e\u4e00\u9053\u4f8b\u9898\r\n\r\n$F_x= \\begin{cases} 1 & x \\in\\{1,2,3\\}\\\\ F_{x-1}+F_{x-3} & x \\geq 4 \\end{cases}$\r\n\r\n\u6c42 $F_x$ \u3002\r\n\r\n\u8fd8\u662f\u9700\u8981\u4e24\u4e2a\u77e9\u9635\uff0c\u5176\u4e2d\u4e00\u4e2a\u5f53\u7136\u662f\r\n\r\n$$\r\n\\left(\\begin{array}{cc}\r\nF_{3}&F_{2}&F_{1}\\\\\r\n\\end{array}\\right)\r\n$$\r\n\r\n\u73b0\u5728\u770b\u770b\u5982\u4f55\u6784\u9020\u51fa\u5355\u4f4d\u77e9\u9635\u3002\r\n\r\n\u4e0b\u9762\u4e00\u4e2a\u8868\u683c\uff0c\u5c55\u793a\u4e86\u4ed6\u6bcf\u884c\u6bcf\u5217\u7684\u610f\u4e49\r\n\r\n|  | $F_{k-1}$ | $F_{k-2}$ | $F_{k-3}$ |  \r\n| -----------: | -----------: | -----------: | -----------: |\r\n| $F_{k}~$ |  |  |  |\r\n| $F_{k-1}$ |  |  |  |\r\n| $F_{k-2}$ |  |  |  |\r\n\r\n\u4ed6\u91cc\u9762\u8981\u586b\u4ec0\u4e48\u5462\uff1f\r\n\r\n\u663e\u7136 $F_{k}=1\\times F_{k-1}+0\\times F_{k-2}+1\\times F_{k-3}$\r\n\r\n\u6240\u4ee5\u7b2c\u4e00\u884c\u662f\r\n\r\n|  | $F_{k-1}$ | $F_{k-2}$ | $F_{k-3}$ |  \r\n| -----------: | -----------: | -----------: | -----------: |\r\n| $F_{k}~$ | $1$ | $0$ | $1$ |\r\n| $F_{k-1}$ |  |  |  |\r\n| $F_{k-2}$ |  |  |  |\r\n\r\n$F_{k-1}=1\\times F_{k-1}+0\\times F_{k-2}+0\\times F_{k-3}$\r\n\r\n$F_{k-2}=0\\times F_{k-1}+1\\times F_{k-2}+0\\times F_{k-3}$\r\n\r\n\u8868\u586b\u5b8c\u662f\r\n\r\n|  | $F_{k-1}$ | $F_{k-2}$ | $F_{k-3}$ |  \r\n| -----------: | -----------: | -----------: | -----------: |\r\n| $F_{k}~$ | $1$ | $0$ | $1$ |\r\n| $F_{k-1}$ | $1$ | $0$ | $0$ |\r\n| $F_{k-2}$ | $0$ | $1$ | $0$ |\r\n\r\n\u5355\u4f4d\u77e9\u9635\u5c31\u6c42\u5f97\u4e86\u3002\r\n\r\n$$\r\n\\left(\\begin{array}{cc}\r\n1&0&1\\\\\r\n1&0&0\\\\\r\n0&1&0\\\\\r\n\\end{array}\\right)\r\n$$\r\n\r\n$(1):$ \u4e3a\u4e86\u548c\u6570\u5b57\u5206\u5f00\u672c\u6587\u8bb0\u4f5c `\\texttt{0}`\uff08\u4e0d\u662f `O` \uff09\uff0c\u4f46\u6b63\u5e38\u60c5\u51b5\u4e0b\u5e94\u8be5\u662f `0` \u3002\r\n\r\n$(2):$ \u8fd8\u6709\u7eaf\u91cf\u77e9\u9635\uff0c\u5bf9\u79f0\u77e9\u9635\uff0c\u4e0b\u4e09\u89d2\u77e9\u9635\u7b49\uff0c\u7528\u7684\u4e0d\u591a\uff0c\u4e0d\u8bb2\u4e86\u3002\r\n\r\n$(3):$ \u4e5f\u6709\u505a $A\\times B$\uff0c$A\u00b7B$ \u7684\u3002\r\n\r\n$(4):$ \u5176\u5b9e\u5feb\u901f\u5e42\u5206\u4e24\u79cd\uff0c\u5e38\u89c1\u7684\u662f\u4e8c\u8fdb\u5236\u5feb\u901f\u5e42\uff0c\u7ecf\u5e38\u6709\u4eba\u628a\u4ed6\u4eec\u6df7\u4e3a\u4e00\u8c08\u3002\u5206\u6cbb\u5feb\u901f\u5e42\u7684\u57fa\u7840\u662f $(a^{\\frac{n}{2}})^2=a$ \u3002\u4e8c\u8fdb\u5236\u5feb\u901f\u5e42\u662f $\\sum 2^{k_i}=n$ \u5219 $\\prod a^{(2^{k_i})}=a^n$ \u3002",
        "postTime": 1611725272,
        "uid": 242524,
        "name": "JRzyh",
        "ccfLevel": 5,
        "title": "\u77e9\u9635\u52a0\u901f"
    },
    {
        "content": "### \u77e9\u9635\u7b80\u4ecb\u53ca\u77e9\u9635\u52a0\u901f\n\n#### \u7b80\u4ecb\n\n> \u5728\u6570\u5b66\u4e2d\uff0c\u77e9\u9635\u662f\u4e00\u4e2a\u6309\u7167\u957f\u65b9\u9635\u5217\u6392\u5217\u7684\u590d\u6570\u6216\u5b9e\u6570\u96c6\u5408\uff0c\u6700\u65e9\u6765\u81ea\u4e8e\u65b9\u7a0b\u7ec4\u7684\u7cfb\u6570\u53ca\u5e38\u6570\u6240\u6784\u6210\u7684\u65b9\u9635\u2014\u2014\u767e\u5ea6\u767e\u79d1\n\n\u901a\u4fd7\u7684\u6765\u8bb2\uff0c\u628a\u96c6\u5408\u91cc\u7684\u4e00\u4e9b\u6570\u586b\u5165\u5230\u4e00\u4e2a\u77e9\u5f62\u4e2d\u5373\u5f97\u5230\u4e00\u4e2a\u77e9\u9635\n\n#### \u5b9a\u4e49\n\n\u7531$m\\times n$\u4e2a\u6570$a_{i,j}$\u6392\u6210\u7684\u6570\u8868\u79f0\u4e3a$m$\u884c$n$\u5217\u7684\u77e9\u9635\u7b80\u79f0$m\\times n$\u77e9\u9635\u3002\n\n\n$$A=\\begin{bmatrix}a_{1,1}&a_{1,2}&...&a_{1,n}\\\\a_{2,1}&a_{2,2}&...&a_{2,n}\\\\...&...&...&...\\\\a_{m,1}&a_{m,2}&...&a_{m,n}\\end{bmatrix}$$\n\n\n\u8fd9$n\\times m$\u4e2a\u6570\u79f0\u4e3a\u77e9\u9635$A$\u7684\u5143\u7d20\uff0c\u7b80\u79f0\u4e3a\u5143\u3002\u3002\u3002\uff08~~\u5269\u4e0b\u7684\u90fd\u662f\u767e\u5ea6\u767e\u79d1\u7684\u5e9f\u8bdd~~\n\n\u6709$m$\u884c$n$\u5217\u7684\u77e9\u9635\u4e5f\u8bb0\u4f5c$A_{mn}$\n\n\u7279\u522b\u7684\uff0c\u4e24\u4e2a$n,m$\u90fd\u76f8\u540c\u7684\u77e9\u9635\u79f0\u4e3a\u540c\u578b\u77e9\u9635\n\n$n=m$\u7684\u77e9\u9635\u79f0\u4e3a$n$\u9636\u77e9\u9635\u6216\u8005$n$\u9636\u65b9\u9635\n\n#### \u57fa\u672c\u8fd0\u7b97\n\n##### \u52a0\u6cd5\n\n$$\\begin{bmatrix}a_{1,1}&...&a_{1,n}\\\\...&...&...\\\\a_{m,1}&...&a_{m,n}\\end{bmatrix}+\\begin{bmatrix}b_{1,1}&...&b_{1,n}\\\\...&...&...\\\\b_{m,1}&...&b_{m,n}\\end{bmatrix}=\\begin{bmatrix}a_{1,1}+b_{1,1}&...&a_{1,n}+b_{1,n}\\\\...&...&...\\\\a_{m,1}+b_{m,1}&...&a_{m,n}+b_{m,n}\\end{bmatrix}$$\n\n\u540c\u65f6\uff0c\u77e9\u9635\u7684\u52a0\u6cd5\u548c\u5b9e\u6570\u7684\u52a0\u6cd5\u4e00\u6837\uff0c\u6ee1\u8db3\u4ea4\u6362\u5f8b\u548c\u7ed3\u5408\u5f8b\n\n\u5373\n$$A+B=B+A$$\n\n$$(A+B)+C=A+(B+C)$$\n\n\u5e94\u5f53\u6ce8\u610f\uff0c\u53ea\u6709\u540c\u578b\u77e9\u9635\u4e4b\u95f4\u624d\u53ef\u4ee5\u8fdb\u884c\u52a0\u6cd5\n\n##### \u51cf\u6cd5\n\n\u5728\u6570\u96c6\u4e2d\uff0c\u51cf\u6cd5\u4f5c\u4e3a\u52a0\u6cd5\u7684\u9006\u8fd0\u7b97\n\n\u5728\u77e9\u9635\u4e2d\u4e5f\u662f\u4e00\u6837\u7684\n$$\\begin{bmatrix}a_{1,1}&...&a_{1,n}\\\\...&...&...\\\\a_{m,1}&...&a_{m,n}\\end{bmatrix}-\\begin{bmatrix}b_{1,1}&...&b_{1,n}\\\\...&...&...\\\\b_{m,1}&...&b_{m,n}\\end{bmatrix}=\\begin{bmatrix}a_{1,1}-b_{1,1}&...&a_{1,n}-b_{1,n}\\\\...&...&...\\\\a_{m,1}-b_{m,1}&...&a_{m,n}-b_{m,n}\\end{bmatrix}$$\n\n##### \u6570\u4e58\n\n\u5728\u77e9\u9635\u4e2d\u5f15\u5165\u4e86\u6570\u4e58\u7684\u6982\u5ff5\uff0c\u5373\u4e3a\u4e00\u4e2a\u6570\u4e58\u4e00\u4e2a\u77e9\u9635\n$$\\mu\u00b7\\begin{bmatrix}a_{1,1}&...&a_{1,n}\\\\...&...&...\\\\a_{m,1}&...&a_{m,n}\\end{bmatrix}=\\begin{bmatrix}\\mu\u00b7 a_{1,1}&...&\\mu\u00b7 a_{1,n}\\\\...&...&...\\\\\\mu\u00b7 a_{m,1}&...&\\mu\u00b7 a_{m,n}\\end{bmatrix}$$\n\n\n\u77e9\u9635\u7684\u6570\u4e58\u6ee1\u8db3\u4ee5\u4e0b\u89c4\u5f8b\uff1a\n$$\\lambda(\\mu A)=\\mu(\\lambda A)$$\n\n$$\\lambda(\\mu A)=(\\lambda\\mu A)$$\n\n$$(\\lambda +\\mu)A=\\lambda A+\\mu A$$\n\n$$\\lambda(A+B)=\\lambda A+\\lambda B$$\n\n##### \u4e58\u6cd5\n\n\u4e24\u4e2a\u77e9\u9635\u7684\u4e58\u6cd5\u4ec5\u5f53\u7b2c\u4e00\u4e2a\u77e9\u9635$A$\u7684\u5217\u6570\u548c\u53e6\u4e00\u4e2a\u77e9\u9635$B$\u7684\u884c\u6570\u76f8\u7b49\u65f6\u624d\u80fd\u5b9a\u4e49\u3002\n\n\u8bb0\u4f5c\n$$A_{mn} B_{np}=C_{mp}$$\n\u4e5f\u4f5c\n$$AB=C$$\n$C$\u7684\u4e00\u4e2a\u5143\u7d20$c_{i,j}$\u7684\u503c\u4e3a\n$$c_{i,j}=\\sum_{k=1}^na_{i,k}\\times b_{k,j}$$\n\u4f8b\u5982\n$$\\begin{bmatrix}1 &0 &2\\\\-1&3&1\\end{bmatrix}\\times\\begin{bmatrix}3&1\\\\2&1\\\\1&0\\end{bmatrix}=\\begin{bmatrix}(1\\times 3+0\\times2+2\\times1)&(1\\times1+0\\times1+2\\times0)\\\\(-1\\times3+3\\times2+1\\times1)&(-1\\times1+3\\times1+1\\times0)\\end{bmatrix}=\\begin{bmatrix}5&1\\\\4&2\\end{bmatrix}$$\n\u540c\u65f6\uff0c\u77e9\u9635\u7684\u4e58\u6cd5\u6ee1\u8db3\u4ee5\u4e0b\u8fd0\u7b97\u5f8b\uff1a\n\n\u7ed3\u5408\u5f8b\uff1a\n$$(AB)C=A(BC)$$\n\u5de6\u5206\u914d\u5f8b\uff1a\n$$(A+B)C=AC+BC$$\n\u53f3\u5206\u914d\u5f8b\uff1a\n$$C(A+B)=CA+CB$$\n\n#### \u77e9\u9635\u52a0\u901f\n\n##### \u5feb\u901f\u5e42\n\n\u8fd9\u4e2a\u8fd8\u9700\u8981\u591a\u8bf4\u4e48\uff1f\n\n``` ksm\nint base=a,ans=1;\nwhile(b>0){\n\tif(b&1){\n\t\tans*=base\n\t\tans%=c;\n\t}\n\tbase*=base\n\tbase%=c;\n\tb=b>>1;\n}\nreturn ans;\n```\n\n\u5c31\u662f\u5f88\u7b80\u5355\u7684\u6309\u4f4d\u8fd0\u7b97\n\n\u6240\u4ee5\u6211\u4eec\u5bf9\u4e8e\u4e00\u4e2a\u77e9\u9635\u7684\u5e42\u4e5f\u53ef\u4ee5\u8fd9\u4e48\u6765\u8fd0\u7b97\uff0c\u4e8e\u662f\u65f6\u95f4\u590d\u6742\u5ea6\u4ece$O(n)$\u964d\u5230\u4e86$O(log_2n)$\n\n~~\u8fd9\u5c31\u5f88\u8212\u670d~~\n\n\u4f46\u662f\u8fd9\u4e2a\u6709\u4ec0\u4e48\u7528\u5462\uff1f\n\n##### [\u4f8b\u9898\u4e00](https://www.luogu.org/problem/P1939)\n\n> a[1]=a[2]=a[3]=1\n>\n> a[x]=a[x-3]+a[x-1] (x>3)\n>\n> \u6c42a\u6570\u5217\u7684\u7b2cn\u9879\u5bf91000000007\uff0810^9+7\uff09\u53d6\u4f59\u7684\u503c\u3002\n\n\u7b2c\u4e00\u773c\u770b\u5230\u8fd9\u4e2a\u9898\n\n**?**\n\n\u8fd9\u4e0d\u662f\u6765\u9001\u5206\u7684\u4e48\n\n\u6211\u4e00\u9879\u4e00\u9879\u53bb\u63a8\u4e0d\u5c31\u597d\u4e86\uff1f\uff1f\uff1f\n\n> \u5bf9\u4e8e100%\u7684\u6570\u636e T<=100\uff0cn<=2*10^9\uff1b\n\n~~\u7b11\u5bb9\u9010\u6e10\u51dd\u56fa~~\n\n\u6240\u4ee5\u73b0\u5728\u5c31\u4f53\u73b0\u51fa\u77e9\u9635\u52a0\u901f\u7684\u7528\u5904\u4e86\n\n\u5bf9\u4e8e\u4e00\u4e2a\u6570\u5217$f(n)=f(n-x)+f(n-y)+...$\n\n\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u51fa\u4e00\u4e2a$k\\times1$\u7684\u77e9\u9635\u8868\u793a\u5f53\u524d\u7684\u72b6\u6001\uff0c\u5373\u7528$f(x),f(y)...$\u6765\u8868\u793a\u6211\u4eec\u5f53\u524d\u5df2\u7ecf\u77e5\u9053\u7684\n\n\u7136\u540e\u6211\u4eec\u518d\u6784\u9020\u4e00\u4e2a\u8f6c\u79fb\u77e9\u9635\uff0c\u4f7f\u6211\u4eec\u7684\u539f\u59cb\u77e9\u9635\u4e58\u4e0a\u8fd9\u4e2a\u8f6c\u79fb\u77e9\u9635\u540e\u53ef\u4ee5\u53d8\u6210\u4e00\u4e2a\u65b0\u7684\u77e9\u9635\uff0c\u5f97\u5230\u5168\u65b0\u7684$f(x)$\uff0c\u4ece\u800c\u4e00\u6b65\u6b65\u7684\u5411\u524d\u63a8\u8fdb\uff0c\u5f97\u5230\u7b54\u6848\n\n\u663e\u800c\u6613\u89c1\uff0c\u7531\u4e8e\u6211\u4eec\u9700\u8981\u7528\u5230$f(n-1)$\u548c$f(n-3)$\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u4fdd\u7559\u4f4f\u8fd9\u4e24\u4e2a\u72b6\u6001\uff0c$f(n-3)$\u662f\u7531\u4e0a\u4e2a\u72b6\u6001\u7684$f(n-2)$\u7ee7\u627f\u8fc7\u6765\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u4e5f\u9700\u8981\u4fdd\u7559\uff0c\u6240\u4ee5\u539f\u59cb\u77e9\u9635\u8981\u6784\u9020\u6210\u8fd9\u4e2a\u6837\u5b50\n$$\\begin{bmatrix}f(3)\\\\f(2)\\\\f(1)\\end{bmatrix}$$\n\u5373\u4e3a\n$$\\begin{bmatrix}1\\\\1\\\\1\\end{bmatrix}$$\n\u7136\u540e\u601d\u8003\u6211\u4eec\u600e\u4e48\u7531\u8fd9\u4e2a\u77e9\u9635\u5f97\u5230\u4e0b\u4e00\u4e2a\u77e9\u9635\n\n\u8bbe\u6211\u4eec\u5f53\u524d\u77e9\u9635\u4e3a\n$$\\begin{bmatrix}f(n-1)\\\\f(n-2)\\\\f(n-3)\\end{bmatrix}$$\n\u6211\u4eec\u5e0c\u671b\u5f97\u5230\u7684\u77e9\u9635\u4e3a\n$$\\begin{bmatrix}f(n)\\\\f(n-1)\\\\f(n-2)\\end{bmatrix}$$\n\u5373\u4e3a\n$$\\begin{bmatrix}f(n-1)\\times1+f(n-2)\\times 0+f(n-3)\\times1\\\\f(n-1)\\times1+f(n-2)\\times0+f(n-3)\\times0\\\\f(n-1)\\times0+f(n-2)\\times1+f(n-3)\\times0\\end{bmatrix}$$\n\u663e\u800c\u6613\u89c1\u6211\u4eec\u7684\u8f6c\u79fb\u77e9\u9635\u4e3a\n$$\\begin{bmatrix}1&0&1\\\\1&0&0\\\\0&1&0\\end{bmatrix}$$\n\u7531\u4e8e\u6211\u4eec\u539f\u59cb\u77e9\u9635\u7684\u7b2c\u4e00\u9879\u4e3a$f(3)$\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u4e58$n-3$\u6b21\u8fd9\u4e2a\u8f6c\u79fb\u77e9\u9635\u5c31\u53ef\u4ee5\u5f97\u5230\u4e86\uff01\n\n\u4f46\u662f\u95ee\u9898\u6765\u4e86\uff0c\u8fd9\u6837\u4e0d\u8fd8\u662f\u4e00\u4e2a$O(n)$\u7684\u7b97\u6cd5\u4e48\uff1f~~\u800c\u4e14\u8fd8\u6162\u4e86\u597d\u591a~~\n\n\u5f53\u7136\u4e0d\u662f\uff01\u60f3\u4e00\u4e0b\u6211\u4eec\u77e9\u9635\u4e58\u6cd5\u7684\u7ed3\u5408\u5f8b\n\n\u6211\u4eec\u8bbe\u539f\u59cb\u77e9\u9635\u4e3a$A$\uff0c\u8f6c\u79fb\u77e9\u9635\u4e3a$B$\uff0c\u90a3\u4e48\u6211\u4eec\u6700\u7ec8\u7b54\u6848\u7684\u77e9\u9635\u5c31\u662f\n$$\\underbrace{B(B(B(B(B(B(B...(B}_{n-3}A))))))$$\n\u6839\u636e\u77e9\u9635\u4e58\u6cd5\u7684\u7ed3\u5408\u5f8b\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u7b80\u5316\u4e3a\n$$B^{n-3}A$$\n\u5230\u4e86\u8fd9\u91cc\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u6765\u6c42\u51fa\u6700\u7ec8\u7b54\u6848\u4e86\uff01\n\n$O(log_2n)$\u662f\u771f\u7684\u5feb\uff08\n\n\u8d34\u4e0a\u6211\u7684\u5de8\u4e11\u65e0\u6bd4\u7684\u4ee3\u7801\uff1a\n\n```c++\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#define mod 1000000007\nusing namespace std;\nstruct Ju{\n\tlong long p[5][5];\n\tJu operator *(const Ju &a)const{\n\t\tJu c;\n\t\tfor(long long i=1;i<=3;i++){\n\t\t\tfor(long long j=1;j<=3;j++){\n\t\t\t\tc.p[i][j]=0;\n\t\t\t}\n\t\t}\n\t\tfor(long long i=1;i<=3;i++){\n\t\t\tfor(long long j=1;j<=3;j++){\n\t\t\t\tfor(long long k=1;k<=3;k++){\n\t\t\t\t\tc.p[i][j]+=(a.p[i][k]*p[k][j])%mod;\n\t\t\t\t\tc.p[i][j]%=mod;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn c;\n\t}\n}ans,base;\nvoid build(){\n\tfor(long long i=1;i<=3;i++){\n\t\tfor(long long j=1;j<=3;j++){\n\t\t\tbase.p[i][j]=0;\n\t\t}\n\t}\n\tbase.p[1][1]=base.p[1][3]=base.p[2][1]=base.p[3][2]=1;\n\tans.p[1][1]=ans.p[2][1]=ans.p[3][1]=1;\n}\nvoid qsm(long long p){\n\twhile(p!=0){\n\t\tif(p&1){\n\t\t\tans=ans*base;\n\t\t}\n\t\tbase=base*base;\n\t\tp>>=1;\n\t}\n}\nlong long T,n;\nint main(){\n\tcin>>T;\n\tfor(long long i=1;i<=T;i++){\n\t\tcin>>n;\n\t\tif(n<=3){\n\t\t\tprintf(\"1\\n\");\n\t\t\tcontinue;\n\t\t}\n\t\tbuild();\n\t\tqsm(n-3);\n\t\tcout<<ans.p[1][1]<<endl;\n\t}\n\treturn 0;\n}\n```\n\n\u540c\u6837\u7684\u9898\u8fd8\u6709[\u8fd9\u4e00\u9053](https://www.luogu.org/problem/P1962)\n\n\u5199\u4f5c\u4e0d\u6613\uff0c\u70b9\u4e2a\u8d5e\u518d\u8d70\u5457QAQ",
        "postTime": 1568776359,
        "uid": 143418,
        "name": "\u5b51\u5f67",
        "ccfLevel": 0,
        "title": "\u77e9\u9635\u52a0\u901f\u5b66\u4e60\u7b14\u8bb0"
    },
    {
        "content": "//\u672c\u849f\u84bb\u7684\u7b2c\u4e00\u7bc7\u9898\u89e3\uff0c\u5e0c\u671b\u53ef\u4ee5\u5ba1\u6838\u8fc7\u5427qwq\u6b22\u8fce\u5404\u4f4d\u5927\u4f6c\u6765\u627e\u9519\uff08\u6709\u4e9b\u662f\u4e2a\u4eba\u7406\u89e3\uff0c\u53ef\u80fd\u6709\u8bef\uff09\n\n\u9996\u5148\u8bf4\u4e00\u4e0b\u6211\u8fd9\u4e2a\u849f\u84bb\u5bf9\u4e8e\u77e9\u9635\u52a0\u901f\u7684\u7406\u89e3\u5427\uff0c\u6211\u89c9\u5f97\u8fd9\u4e2a\u52a0\u901f\u662f\u501f\u52a9\u4e86\u77e9\u9635\u4e58\u6cd5\u5229\u7528\u4e86\u5feb\u901f\u5e42\uff0c\u52a0\u5feb\u4e86\u72b6\u6001\u4e4b\u95f4\u7684\u8f6c\u79fb\uff0c\u6709\u70b9\u50cf\u201c\u500d\u589e\u201d\u5427\uff0c\u5bf9\u4e8e\u5bfb\u627e\u67d0\u4e2a\u76ee\u6807\u72b6\u6001\u6709\u5f88\u5927\u7684\u52a0\u901f\u4f5c\u7528\u3002\u6211\u89c9\u5f97\u5b9e\u73b0\u77e9\u9635\u52a0\u901f\u6bd4\u8f83\u91cd\u8981\u7684\u4e00\u65b9\u9762\u5c31\u662f\u5feb\u901f\u5e42\uff0c\u5feb\u901f\u5e42\u662f\u5229\u7528\u4e8c\u8fdb\u5236\u5b9e\u73b0\u7684\uff0c\u4e0d\u4f1a\u7684\u540c\u5b66\u53ef\u4ee5\u770b\u4e00\u4e0b\u4ee3\u7801\uff0c\u58f0\u660e\uff1a\u5feb\u901f\u5e42\u5728\u77e9\u9635\u52a0\u901f\u4e2d\u5f88\u91cd\u8981\uff01\u5efa\u8bae\u5148\u638c\u63e1\u5feb\u901f\u5e42\u3002(\u53c2\u8003\u4f8b\u9898P1226)\uff1a\n~~~cpp\nlong long quick(long long a,long long b)\n{\n\tlong long base=a,ans=1; \n\twhile(b!=0)  \n\t{\n\t\tif((ans*base)%k!=0) \n\t\tif(b&1!=0) ans=(ans*base)%k;     \n\t\tbase=base*base%k;      \n\t\tb>>=1;\n\t}\n\treturn ans;\n}\n\n~~~\n\u5f88\u660e\u663e\u7684\u662f\uff0c\u8fd9\u9053\u9898\u7684\u5173\u952e\u4e4b\u5904\u7edd\u5bf9\u662f\u627e\u51fa\u72b6\u6001\u8f6c\u79fb\u7528\u7684\u77e9\u9635\uff0c\u770b\u9898\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff0c**a[i]=a[i-1]+a[i-3]**;\u8981\u6c42\u5f97 _**a[i]**_ \u7684\u8bdd\uff0c\u6211\u4eec\u9700\u8981 _**a[i-1**]_ \u4ee5\u53ca _**a[i-3]**_ \u8fd9\u4e24\u4e2a\u72b6\u6001\u3002\u90a3\u6211\u4eec\u4e0d\u59a8\u8bbe\u7f6e\u4e00\u4e2a3\u00d71\u7684\u77e9\u9635\u8bb0\u5f55a[i-1],a[i-2],a[1-3]\u8fd9\u4e09\u4e2a\u72b6\u6001\uff0c\n![](https://cdn.luogu.com.cn/upload/pic/37980.png)\n\n\u7136\u540e\u6211\u4eec\u5728\u7531\u8fd9\u4e09\u4e2a\u72b6\u6001\u5411\u76ee\u6807\u72b6\u6001\u63a8\u3002\n\u597d\u7684\uff0c\u73b0\u5728\u91cd\u70b9\u6765\u4e86\uff0c\u6211\u4eec\u8981\u8003\u8651\u5982\u4f55\u5c06\u8fd9\u4e09\u4e2a\u72b6\u6001\u63a8\u4e3a _**a[i],a[i-1],a[i-2]**_  ;\n\u7531\u4e8e\u77e9\u9635\u4e58\u6cd5\u7684\u6027\u8d28\uff08\u77e9\u9635\u4e58\u6cd5\u7684\u8bdd\uff0c\u8fd9\u91cc\u5c31\u4e0d\u591a\u8bf4\u4e86\uff0c\u53ef\u4ee5\u53bb\u767e\u5ea6\u4e00\u4e0b\uff09\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a3\u00d73\u77e9\u9635\uff0c\u7531\u8fd9\u4e2a3\u00d73\u7684\u77e9\u9635\u4e0e\u6211\u4eec\u4e0a\u9762\u90a3\u4e2a3\u00d71\u7684\u521d\u59cb\u77e9\u9635\u8fdb\u884c\u76f8\u4e58\u3002\u7531\u6b64\u6765\u627e\u5230\u6211\u4eec\u7684\u72b6\u6001\u8f6c\u79fb\u77e9\u9635\uff08\u5c31\u662f\u8fd9\u4e2a3\u00d73\u7684\u77e9\u9635\uff0c\u540e\u9762\u4e5f\u4f1a\u8fd9\u6837\u79f0\u547c\uff0chah\uff09\u3002\n\u8fd9\u662f\u6211\u4eec\u7684\u76ee\u7684\n\n\u5c06\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/37980.png)\n\n\u8f6c\u4e3a\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/37981.png)\n\n\u5f88\u660e\u663e\uff1a\na[i]=a[i-1]\u00d71+(a[i-2]\u00d70)+a[i-3]\u00d71\n\n\u90a3\u6211\u4eec\u76843\u00d73\u77e9\u9635\u7b2c\u4e00\u884c\u5c31\u662f1 0 1\u4e86\n\na[i-1]=a[i-]]\u00d71+(a[i-2]\u00d70+a[i-3]\u00d70)\n\na[i-2]=(a[i-1]\u00d70)+a[i-2]\u00d71+(a[i-3]\u00d70)\n\n\u6240\u4ee53\u00d73\u77e9\u9635\u7684\u7b2c\u4e8c\u3001\u4e09\u884c\u5c31\u662f1 0 0\u548c 0 1 0\u4e86\uff1b\n\uff08\u7b2c\u4e8c\u3001\u4e09\u79cd\u72b6\u6001\u7684\u8f6c\u79fb\u8bf4\u660e\u5728\u77e9\u9635\u52a0\u901f\u627e\u8f6c\u79fb\u72b6\u6001\u7684\u77e9\u9635\u65f6\uff0c\u4e0d\u4e00\u5b9a\u4e00\u5b9a\u8981\u7531\u5b83\u524d\u9762\u7684\u67d0\u51e0\u79cd\u72b6\u6001\u8f6c\u79fb\u6765\uff0c\u4e5f\u6709\u53ef\u80fd\u7531\u5b83\u540e\u9762\u7684\u72b6\u6001\u76f4\u63a5\u8f6c\u8fc7\u6765\uff0c\u6211\u521a\u5f00\u59cb\u505a\u77e9\u9635\u52a0\u901f\u65f6\u6ca1\u5f80\u8fd9\u79cd\u60c5\u51b5\u4e0a\u60f3\uff0c\u5c31\u5f88\u6d6a\u8d39\u65f6\u95f4\u4e86\u3002QAQ\uff09\n\n\u7531\u6b64\u77e9\u9635\u5f00\u59cb\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff0c\u5f53\u524d\u72b6\u6001\u8f6c\u5230\u4e0b\u4e00\u72b6\u6001\u53ea\u9700\u8981\u8fdb\u884c\u521d\u59cb\u77e9\u9635\u4e0e\u6211\u4eec1\u00d73\u7684\u90a3\u4e2a\u521d\u59cb\u77e9\u9635\uff08\u6682\u4e14\u8fd9\u6837\u79f0\u547c\uff0c\u77e5\u9053\u662f\u54ea\u4e2a\u5c31\u597d\u4e86qwq\uff09\u8fdb\u884cn-3\u6b21\u77e9\u9635\u4e58\u6cd5\uff0c\u4e3a\u4ec0\u4e48\u662fn-3\u6b21\u5450\uff1f\u56e0\u4e3a\u6211\u4eec\u7684\u201c\u521d\u59cb\u77e9\u9635\u201d\u5f00\u59cb\u6709\u4e09\u4e2a\u72b6\u6001\uff08\u5373a[i-1],a[i-2],a[i-3]\uff09\uff0c\u6bcf\u6b21\u77e9\u9635\u4e58\u6cd5\u4e4b\u540e\uff0c\u201c\u72b6\u6001\u77e9\u9635\u201d\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u5c31\u662fa[i]\u4e86\uff0c\u90a3\u6211\u4eec\u8981\u5bfb\u627e\u7684a[n]\u5c31\u53ea\u9700\u8981n-3\u6b21\u77e9\u9635\u4e58\u6cd5\u54af\u3002\n\n\u597d\u7684\uff0c\u6211\u4eec\u521d\u59cb\u77e9\u9635\u627e\u5230\u4e86\uff0c\u90a3\u6211\u4eec\u5c31\u8981\u501f\u52a9\u77e9\u9635\u4e58\u6cd5\u4e86\uff0c\u7531a[1],a[2],a[3]\u5411\u540e\u8f6c\u79fb\u77e5\u9053a[n]\u5c31\u597d\u4e86\uff0c\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u662f\uff0c\u56e0\u4e3a\u5feb\u901f\u5e42\u7684\u65f6\u5019\uff0c\u6709\u65f6\u9700\u8981\u6211\u4eec\u5904\u7406\u72b6\u6001\u8f6c\u79fb\u77e9\u9635\uff0c\u800c\u6211\u4eec\u7684\u72b6\u6001\u8f6c\u79fb\u77e9\u9635\u4e0e\u6211\u4eec\u7684\u521d\u59cb\u77e9\u9635\u5927\u5c0f\u4e0d\u4e00\uff0c\u6240\u4ee5\u6211\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u7ed3\u6784\u4f53\uff08\u4e3a\u4ec0\u4e48\u8981\u7528\u7ed3\u6784\u4f53\uff0c\u8fd9\u6837\u7684\u8bdd\u4fbf\u4e8e\u5728\u5404\u4e2a\u51fd\u6570\u4e4b\u95f4\u8f6c\u79fb\uff09\uff0c\u5176\u4e2d\u9664\u4e86\u77e9\u9635\u53d8\u91cf\u4ee5\u5916\uff0c\u518d\u52a0\u4e86\u4e00\u4e2aborder\u7684\u53d8\u91cf\u6765\u5904\u7406\u8fb9\u754c\u95ee\u9898\uff0c\u8fb9\u754c\u4e00\u4e2a\u662f1\uff0c\u53e6\u4e00\u4e2a\u8fb9\u754c\u662f3\uff08\u7531\u77e9\u9635\u7684\u5927\u5c0f\u51b3\u5b9a\u7684ya\uff09\u3002\u6709\u4e00\u9053\u7c7b\u4f3c\u7684\u77e9\u9635\u52a0\u901f\u9898\u53eb\u505a\u6590\u6ce2\u90a3\u5951\u989d\u516c\u7ea6\u6570\uff0c\u6709\u5174\u8da3\u7684\u540c\u5b66\u53ef\u4ee5\u53bb\u8bd5\u4e00\u4e0b\uff0c\u90a3\u662f\u4e00\u4e2a2\u00d72\u7684\u72b6\u6001\u8f6c\u79fb\u77e9\u9635\u3002\n\nAC\u4ee3\u7801\uff1a\n\n~~~cpp\n#include <cstdio> \n#include <iostream>  \nusing namespace std;\n#define INF 1000000007\nlong long n,q[105];\nstruct mat{\n\tlong long s[3][3],border;   \n};\nmat mem(mat a,mat b)//\u77e9\u9635\u4e58\u6cd5\n{\n\tmat q;\n\tfor(int i=0;i<3;i++)\n\t  for(int j=0;j<3;j++)\n\t    q.s[i][j]=0;\n\tfor(int i=0;i<3;i++)\n\t  for(int j=0;j<a.border;j++)\n\t    for(int k=0;k<3;k++)\n\t      q.s[i][j]=((q.s[i][j]%INF)+(a.s[k][j]%INF)*(b.s[i][k]%INF))%INF;\n\tq.border=a.border;//\u5904\u7406\u8fb9\u754c\n\treturn q;\n}\nvoid ksm(long long x)//\u5feb\u901f\u5e42\n{\n\tmat xx,ans;ans.border=1;xx.border=3;\n\tans.s[0][0]=ans.s[1][0]=ans.s[2][0]=1;\n\tfor(int i=0;i<3;i++)\n\t  for(int j=0;j<3;j++) xx.s[i][j]=0;\n\txx.s[0][0]=xx.s[0][2]=xx.s[1][0]=xx.s[2][1]=1;\n\twhile(x)\n\t{\n\t\tif(x&1) ans=mem(ans,xx);\n\t\txx=mem(xx,xx);\n\t\tx>>=1;\n\t}\n\tcout<<ans.s[0][0]%INF<<endl;//n-3\u6b21\u77e9\u9635\u4e58\u6cd5\u4e4b\u540e\u8fd9\u4e2a\u5c31\u662fa[n]\u4e86\uff01\n}\nint main()\n{\n\tcin>>n;   \n\tfor(int i=1;i<=n;i++)  \n\tcin>>q[i];   \n\tfor(int i=1;i<=n;i++)\n    {   \n\t\tif(q[i]<=3) {cout<<1<<endl;continue;}  \n    ksm(q[i]-3);  \n\t} \n\treturn 0;\n}\n~~~",
        "postTime": 1539606215,
        "uid": 65873,
        "name": "Special_zyy",
        "ccfLevel": 0,
        "title": "#\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "# \u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09 \u9898\u89e3\n\n## \u9898\u610f\u5206\u6790\n\n- \u7ed9\u4f60\u4e00\u4e2a\u6570\u5217\uff0c\n\n- ![](https://cdn.luogu.com.cn/upload/image_hosting/cuinaluo.png)\n\n- \u6c42$a_n$\uff08% 1e9+7\uff09\u7684\u503c\n\n## \u89e3\u9898\u601d\u8def\n\n- \u6807\u9898\u8bf4\u7684\u5f88\u6e05\u695a\u4e86\uff0c\u201c\u77e9\u9635\u52a0\u901f\u201d\uff0c\u6240\u4ee5\u8fd9\u9898\u7684\u89e3\u6cd5\u5c31\u662f\u201c\u77e9\u9635\u4e58\u6cd5\u201d\u3002\n\n  ### Prob.1 \u5efa\u7acb\u539f\u59cb\u77e9\u9635\n\n  - \u56e0\u4e3a$a_1=a_2=a_3=1$\uff0c\u6240\u4ee5\u6211\u4eec\u7684\u521d\u59cb\u77e9\u9635\u957f\u8fd9\u6837\uff1a\n\n  - #### \u4e3a\u4ec0\u4e48\u662f1\u884c3\u5217\u7684\uff1f\n  \n    - \u5728$a_{i+1}$\u7684\u8ba1\u7b97\u8fc7\u7a0b\u4e2d\uff0c\u7531\u4e8e$a_i=a_{i-3}+a_{i-1}$\uff0c\u5219$a_{i+1}$\u4e5f\u7b49\u4e8e$a_{i-2}+a_i$\u3002\u8981\u8c03\u7528\u5230$a_{i-2}$\u7684\u503c\uff0c\u5219\u5e94\u8be5\u4fdd\u5b583\u4e2a\u683c\u5b50\uff083\u5217\uff09\uff0c\u5206\u522b\u662f$a_i,a_{i-1},a_{i-2}$\u3002\u6545\u521d\u59cb\u77e9\u9635\u662f1\u884c3\u5217\n\n  - | $a_1$ | $a_2$ | $a_3$ |\n  \t| ----- | ----- | ----- |\n    | 1     | 1     | 1     |\n\n  - \u6240\u4ee5\u521d\u59cb\u77e9\u9635\u5c31\u662f\uff081\uff0c1\uff0c1\uff09\u3002\n\n  ### Prob.2 \u5efa\u7acb\u8f6c\u79fb\u77e9\u9635\n\n  - \u6211\u4eec\u77e5\u9053\u5f53i>=4\u7684\u65f6\u5019\u624d\u9700\u8981\u8f6c\u79fb\u3002\n\n  - \u539f\u5f0f\u4e3a$a_i=a_{i-3}+a_{i-1}$\u3002\n  \n  - \u6211\u4eec\u77e5\u9053\uff0c$a_i$\u8981\u8f6c\u79fb\u5230$a_{i+1}$\uff0c\u5c31\u8981\u5efa\u7acb\u4e00\u4e2a\u77e9\u9635\uff0c\u5b83\u957f\u8fd9\u6837\uff1a\n  \n  - | --   | i+1  | i    | i-1  | i-2  |\n    | ---- | ---- | ---- | ---- | ---- |\n  \t| i    |      |      |      |      |\n    | i-1  |      |      |      |      |\n  \t| i-2  |      |      |      |      |\n    | i-3  |      |      |      |      |\n  \n  - \u7136\u540e\uff0c\u6539\u5199\u539f\u5f0f\uff0c\u65e2\u7136$a_i=a_{i-3}+a_{i-1}$\uff0c\u5219$a_{i+1}$\u4e5f\u7b49\u4e8e$a_{i-2}+a_i$\u3002\n  \n  - \u6211\u4eec\u5f88\u5feb\u5c31\u6839\u636e\u521a\u624d\u6539\u5199\u7684\u5f0f\u5b50\uff0c\u63a8\u51fa\u7b2c\u4e00\u5217\uff1a$a_{i+1}$\u5217\u4ece\u4e0a\u5230\u4e0b\u4f9d\u6b21\u662f\uff1a1\u30010\u30011\u30010\u3002\uff08\u56e0\u4e3a$a_i$\u548c$a_{i-2}$\u5404\u53d6\u4e00\u4efd\uff09\n  \n  - \u81f3\u6b64\uff0c\u77e9\u9635\u5df2\u7ecf\u6210\u4e3a\uff1a\n  \n  - | --   | i+1  | i    | i-1  | i-2  |\n    | ---- | ---- | ---- | ---- | ---- |\n    | i    | 1    |      |      |      |\n    | i-1  | 0    |      |      |      |\n    | i-2  | 1    |      |      |      |\n    | i-3  | 0    |      |      |      |\n  \n  - \u7136\u540e\u770b\u7b2c\u4e8c\u3001\u7b2c\u4e09\u3001\u7b2c\u56db\u5217\u3002\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u540e\u9762\u8fd9\u51e0\u5217\u53ea\u9700\u8981\u539f\u5c01\u4e0d\u52a8\u5730\u8f6c\u79fb\u5c31\u597d\u4e86\u3002$a_i=a_i,a_{i-1}=a_{i-1},a_{i-2}=a_{i-2}$\u3002\n  \n  - \u76f4\u63a5\u5728\u201di\u201c\u5217\u4e0a\u7ed9\u201ci\u201d\u683c\u5b50\u586b\u4e0a1\uff0c\u2026\u2026\u4f9d\u6b64\u7c7b\u63a8\u3002\n  \n  - \u81f3\u6b64\uff0c\u6211\u4eec\u7684\u8f6c\u79fb\u77e9\u9635\u5c31\u5efa\u7acb\u597d\u4e86\u3002\u6700\u7ec8\uff0c\u8f6c\u79fb\u77e9\u9635\u5982\u4e0b\uff1a\n  \n  - | --   | i+1  | i    | i-1  | i-2  |\n    | ---- | ---- | ---- | ---- | ---- |\n    | i    | 1    | 1    | --   | --   |\n    | i-1  | --   | --   | 1    | --   |\n    | i-2  | 1    | --   | --   | 1    |\n    | i-3  | --   | --   | --   | --   |\n  \n  - **\u660e\u786e\u8fd9\u4e2a\u77e9\u9635\u7684\u4f5c\u7528\uff1a** \u5bf9\u4e8e\u4e00\u4e2a\u77e9\u9635$a_i,a_{i+1},a_{i+2}$\uff0c\u4e58\u4e0a\u8fd9\u4e2a\u8f6c\u79fb\u77e9\u9635\u53ef\u4ee5\u8ba9\u77e9\u9635\u8f6c\u6362\u4e3a$a_{i+1},a_i,a_{i-1}$\u3002\n  \n  ### Prob.3 \u8ba1\u7b97\u7b54\u6848\n  \n  - \u4e00\u5f00\u59cb\uff0c\u6211\u4eec\u57fa\u7840\u77e9\u9635\u5b58\u653e\u7684\u662f$a_1,a_2,a_3$\uff0c\u6613\u8bc1\u4e58\u4ee5n\u6b21\u90a3\u4e2a\u8f6c\u79fb\u77e9\u9635\u4e4b\u540e\uff0c\u57fa\u7840\u77e9\u9635\u5b58\u653e\u7684\u662f$a_{n+1},a_{n+2},a_{n+3}$\n  \n  - \u800c\u6211\u4eec\u8981\u7b97$a_n$\uff0c\u5219\u53ea\u9700\u8981\u4e58\u90a3\u4e2a\u8f6c\u79fb\u77e9\u9635n-1\u6b21\uff0c\u7136\u540e\u57fa\u7840\u77e9\u9635\u7684\u7b2c\u4e00\u4e2a\u683c\u5c31\u662f$a_n$\u4e86\u3002\n  \n  - \u95ee\u9898\u8f6c\u6362\u4e3a\n  \n  - $$\n    ans=basic\\space matrix\\space\\times\\space(transfer)^{n-1}\n    $$\n  \n  - \u8981\u662f\u6211\u4eec\u76f4\u63a5\u66b4\u529b\u4e58\u8f6c\u79fb\u77e9\u9635\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5c31O(n)\u5f80\u4e0a\u4e86\uff0c\u80af\u5b9a\u8fc7\u4e0d\u4e86\u7684\u3002\u6211\u4eec\u8981\u60f3\u529e\u6cd5\u4f18\u5316\u3002\n  \n  - \u53d1\u73b0\u540e\u9762\u7684$(transfer)^{n-1}$\u53ef\u4ee5\u7528\u5feb\u901f\u5e42\u76f4\u63a5\u7b97\u51fa\u6765\uff0c\u964d\u4e3alog\u7ea7\u522b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002\n  \n  - \u5219\u6211\u4eec\u53ea\u9700\u8981\u5148\u7528\u5feb\u901f\u5e42\u628a\u8f6c\u79fb\u77e9\u9635\u7684n-1\u6b21\u65b9\u7b97\u51fa\u6765\uff0c\u7136\u540e\u7528\u57fa\u7840\u77e9\u9635\u4e58\u4ee5\u5b83\uff0c\u6700\u540e\u8f93\u51fa\u57fa\u7840\u77e9\u9635\u7684\u7b2c\u4e00\u683c\u3002\n\n## \u53c2\u8003\u7a0b\u5e8f\n\n```cpp\n#include<stdio.h>\nconst int MOD=1000000007;\n\nstruct OneMatrix\n{\n\tlong long m[6][6];\n} basic_matrix,turn;\n\nOneMatrix mul(OneMatrix a,OneMatrix b)\n{\n\tOneMatrix ans;\n\tfor(int i=1;i<=5;i++)\n\t\tfor(int j=1;j<=5;j++)\n\t\t\tans.m[i][j]=0;\n\t\n\tfor(int i=1;i<=5;i++)\n\t\tfor(int j=1;j<=5;j++)\n\t\t\tfor(int k=1;k<=5;k++)\n\t\t\t\tans.m[i][j]=( ans.m[i][j]%MOD + a.m[i][k]*b.m[k][j]%MOD ) % MOD;\n\t\n\treturn ans;\n}\n\nOneMatrix pow(OneMatrix a,int x)\n{\n\t//a^x\n\tOneMatrix ans=a;\n\twhile(x)\n\t\t{\n\t\t\tif(x%2==1)\n\t\t\t\tans=mul(ans,a);\n\t\t\ta=mul(a,a);\n\t\t\tx/=2;\n\t\t}\n\treturn ans;\n}\n\nint main_()\n{\n\t//\u5148\u6784\u9020\u77e9\u9635\n\t//1 1 1\n\tfor(int i=1;i<=5;i++)\n\t\tfor(int j=1;j<=5;j++)\n\t\t\tbasic_matrix.m[i][j]=0;\n\tbasic_matrix.m[1][1]=1;\n\tbasic_matrix.m[1][2]=1;\n\tbasic_matrix.m[1][3]=1;\n\t\n\t//\u5148\u6784\u9020\u8f6c\u79fb\u77e9\u9635\n\t//1 1 0 0\n\t//0 0 1 0\n\t//1 0 0 1\n\tfor(int i=1;i<=5;i++)\n\t\tfor(int j=1;j<=5;j++)\n\t\t\tturn.m[i][j]=0;\n\tturn.m[1][1]=1,turn.m[1][2]=1;\n\tturn.m[2][3]=1;\n\tturn.m[3][1]=1,turn.m[3][4]=1;\n\t\n    //\u8bfb\u5165\u77e9\u9635\n\tint Q;\n\tscanf(\"%d\",&Q);\n\tif(Q==1||Q==2||Q==3)\n\t\t{\n\t\t\tprintf(\"1\\n\");\n\t\t\treturn 0;\n\t\t}\n\telse\n\t\tQ-=3;\t\n    //\u5982\u679c\u8be2\u95ee\u662f4\uff0c\u6211\u4eec\u53ea\u7528\u8f6c\u79fb1\u6b21\uff1b\n    //\u5982\u679c\u8be2\u95ee\u662f5\uff0c\u53ea\u75282\u6b21\uff0c\u4f9d\u6b64\u7c7b\u63a8\u3002\u6240\u4ee5Q\u51cf\u53bb3\n\t\n\t//\u628a\u8f6c\u79fb\u77e9\u9635\u7684n-1\u6b21\u65b9\u7b97\u51fa\u6765\n\tturn=pow(turn,Q-1);\n\t\n\t//\u4e58\u4ee5\u57fa\u7840\u77e9\u9635 \n\tbasic_matrix=mul(basic_matrix,turn);\n\t\n\t//\u8f93\u51fa\u7ed3\u679c\n\tprintf(\"%I64d\\n\",basic_matrix.m[1][1]);\n\t\n\treturn 0;\n}\n\nint main()\t//\u591a\u7ec4\u6570\u636e\n{\n\tint T;\n\tscanf(\"%d\",&T);\n\twhile(T--)\n\t\tmain_();\n\treturn 0;\n}\n```\n\n",
        "postTime": 1572826787,
        "uid": 30391,
        "name": "milk_candy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "$update:$ \u4fee\u590d\u4e86\u90e8\u5206\u77e9\u9635\u7684\u6784\u5efa\u7ed3\u679c\uff0c\u5e76\u4fee\u590d\u4e86\u6587\u672b\u94fe\u63a5\u3002\n\n\u518d $Update:$ \u589e\u52a0\u4e86\u5faa\u73af\u77e9\u9635\u7684\u6784\u9020\u65b9\u5f0f\u3002\n\n\n------------------\n# \u5f00\u4e2a\u65b0\u5751\u3002\n\n\u5f80\u540e\u7684\u53ef\u80fd\u5f88\u957f\u4e00\u6bb5\u65f6\u95f4\uff0c\u8fd9\u90fd\u4f1a\u662f\u7f6e\u9876\u3002\n\n## \u5411\u91cf\n\n------------------\n\n## \u6d45\u8c08\u5982\u4f55\u6784\u9020\u77e9\u9635\n\n```\n\u5173\u4e8e\u77e9\u9635\u7684\u6784\u9020\uff0c\u662f\u77e9\u4e58\u4e2d\u6700\u5173\u952e\u7684\u4e00\u73af\uff0c\u4e00\u822c\u53ea\u9700\u8981\u5b66\u4f1a\u6784\u9020\u77e9\u9635\u548c\u719f\u7ec3\u8fd0\u7528\u77e9\u9635\u5feb\n\n\u901f\u5e42\u7684\u6a21\u677f\uff0c\u5c31\u53ef\u4ee5\u505a(shui)\u51fa(diao)\u975e\u5e38\u591a\u7684\u9898\u76ee\u3002\n\n\u8bdd\u4e0d\u591a\u8bf4\uff0c\u9a6c\u4e0a\u8fdb\u5165\u6b63\u9898\u3002\n\n```\n\n-------------------\n\n\u4f8b\u98981:[\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09](https://www.luogu.org/problemnew/show/P1939)\n\n\u8ba9\u6211\u4eec\u89c2\u5bdf\u4e00\u4e0b\u8fd9\u9898\u7684\u9012\u63a8\u5f0f:\n\n$ f[1] = f[2] = f[3] = 1 $\n\n$ f[n] = f[n - 1] + f[n - 3] $ ($ n > 3 $) $ $\n\n\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c$ f[n] $ \u6700\u65e9\u7531$ f[n-3] $\u8f6c\u79fb\u800c\u6765\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u6784\u9020\u4e00\u4e2a$ 3*3 $\u7684\u77e9\u9635\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u5c06\u4e0e $ f[n] $ \u6709\u5173\u7684\u9700\u8981\u5f97\u5230\u7684\u5f0f\u5b50\u653e\u5165\u4e00\u4e2a\u77e9\u9635:\n$ \\begin{bmatrix}f[n]\\\\f[n - 1]\\\\f[n - 2]\\end{bmatrix} $\n\n\u7136\u540e\uff0c\u6211\u4eec\u5bfb\u627e\u4ed6\u4ece\u54ea\u91cc\u6765: $ f[n-1] = f[n - 2] + f[n - 3] $\uff0c\n\u5373 $ \\begin{bmatrix}f[n-1]\\\\f[n - 2]\\\\f[n - 3]\\end{bmatrix} $\n\n\u7136\u540e\u8bbe\u6211\u4eec\u9700\u8981\u5f97\u5230\u7684\u77e9\u9635\u4e3a$ ans $\uff0c\u6709:$ ans*\\begin{bmatrix}f[n-1]\\\\f[n - 2]\\\\f[n - 3]\\end{bmatrix} = \\begin{bmatrix}f[n]\\\\f[n - 1]\\\\f[n - 2]\\end{bmatrix} $\n\n\u7136\u540e\u6211\u4eec\u4e00\u884c\u4e00\u884c\u6839\u636e\u77e9\u4e58\u7684\u65b9\u5f0f\u9012\u63a8:\n\n\u7b2c\u4e00\u884c\u56e0\u4e3a\u60f3\u5f97\u5230 $ f[n] $\uff0c \u6240\u4ee5\u4e09\u4e2a\u90fd\u9700\u8981:$ \\begin{bmatrix}1&0&1\\end{bmatrix} $\n\n\u7b2c\u4e8c\u884c\u56e0\u4e3a\u60f3\u5f97\u5230$ f[n - 1] $\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u7b2c\u4e00\u4e2a:$ \\begin{bmatrix}1&0&0\\end{bmatrix} $\n\n\u7b2c\u4e09\u884c\u56e0\u4e3a\u60f3\u5f97\u5230$ f[n - 2] $\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u7b2c\u4e8c\u4e2a:$\\begin{bmatrix}0&1&0\\end{bmatrix} $\n\n\u6700\u540e\u5c31\u6784\u9020\u51fa\u4e86\u5b8c\u6574\u7684\u77e9\u9635:\n$ \\begin{bmatrix}1&0&1\\\\1&0&0\\\\0&1&0\\end{bmatrix} $\n\n\u77e9\u4e58\u4ee3\u7801:\n\n```cpp\n#include<bits/stdc++.h>\n#define re register\n#define For( i, j, k ) for( re int i = j; i <= k; i-- )\n#define foR( i, j, k ) for( re int i = j; i >= k; i++ )\nusing namespace std;\ntypedef long long ll;\nconst ll N = 5, p = 1e9 + 7;\n\nstruct matrix {\n    ll mp[N][N];\n    inline void init() {\n        memset( mp, 0, sizeof( mp ) );\n        mp[1][1] = mp[1][3] = mp[2][1] = mp[3][2] = 1;\n    }\n    inline void operator *=( matrix mmp ) {\n        matrix ans;\n        For( i, 1, 3 )For( j, 1, 3 ) {\n            ans.mp[i][j] = 0; \n            For( k, 1, 4 )ans.mp[i][j] += mp[i][k] * mmp.mp[k][j];\n        }For( i, 1, 3 )For( j, 1, 3 )mp[i][j] = ( ans.mp[i][j] + p )% p;\n    }\n};\n\ninline ll read() {\n    ll x = 0; bool f = 0; char ch = getchar();\n    for( ; !isdigit( ch ); ch = getchar() )f^=( ch == '-' );\n    for( ; isdigit( ch ); ch = getchar() )x = ( x<<3 ) + ( x<<1 ) + ( ch^48 );\n    return f? -x: x;\n}\n\ninline void write( ll x ) {\n    if( x < 0 ){ putchar( '-' );x = -x; }\n    if( x > 9 )write( x / 10 );\n    putchar( x % 10 + 48 );\n}\n\ninline ll matrix_power( ll x ) {\n    if( x <= 1 ) return 1;\n    matrix ans, a;\n    ans.init(), a.init();\n    while( x ) { if( x&1 )ans *= a; x>>=1; a *= a; }\n    return ans.mp[1][1];\n}\n\nint main() {\n    ll T = read();\n    while( T-- ) {\n        ll x = read() - 2;\n        write( matrix_power( x ) ), putchar( '\\n' );\n    }return 0;\n}\n\n```\n\u6e29\u99a8\u63d0\u793a\uff1a\u4e0d\u8981\u6284\u4ee3\u7801\u3002\n\n----------------------\n\n\u4f8b\u98982:[\u6590\u6ce2\u90a3\u5951\u6570\u5217](https://www.luogu.org/problemnew/show/P1962)\n\n\u8ba9\u6211\u4eec\u91cd\u590d\u4e0a\u4e00\u9898\u7684\u6b65\u9aa4:\n\n$ f[1] = f[2] = 1 $\n\n$ f[n] = f[n - 1] + f[n - 2] $\n\n\u53ef\u4ee5\u53d1\u73b0 $ f[n] $ \u6700\u65e9\u7531 $ f[n - 2] $ \u8f6c\u79fb\u800c\u6765\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u6784\u5efa\u4e00\u4e2a $ 2 * 2 $\u7684\u77e9\u9635\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u5c06\u9012\u63a8\u5f0f\u653e\u5165\u77e9\u9635: $ \\begin{bmatrix}f[n]\\\\f[n - 1]\\end{bmatrix} $\n\n\u4ed6\u4ece\u54ea\u91cc\u6765: $ \\begin{bmatrix}f[n - 1]\\\\f[n - 2]\\end{bmatrix} $\n\n\u8bbe $ ans * \\begin{bmatrix}f[n - 1]\\\\f[n - 2]\\end{bmatrix} = \\begin{bmatrix}f[n]\\\\f[n - 1]\\end{bmatrix} $\n\n\u7b2c\u4e00\u884c\u9700\u8981\u5f97\u5230 $ f[n] $\uff0c\u6240\u4ee5\u9700\u8981$ f[n - 1] $ \u548c $ f[n - 2] $\uff0c\u56e0\u6b64\u5f97\u5230\u77e9\u9635\u7b2c\u4e00\u884c\u4e3a: $ \\begin{bmatrix}1&1\\end{bmatrix} $\n\n\u7b2c\u4e8c\u884c\u9700\u8981\u5f97\u5230 $ f[n - 1] $\uff0c\u6240\u4ee5\u53ea\u9700\u8981$ f[n - 1] $\u5c31\u53ef\u4ee5\u4e86\uff0c\u56e0\u6b64\u5f97\u5230\u77e9\u9635\u7b2c\u4e8c\u884c\u4e3a: $ \\begin{bmatrix}1&0\\end{bmatrix} $\n\n\u6700\u540e\u6784\u5efa\u51fa\u5b8c\u6574\u7684\u77e9\u9635: $ \\begin{bmatrix}1&1\\\\1&0\\end{bmatrix} $\n\n\u4ee3\u7801:\n\n---------------------------\n\n\u4e60\u9898:\n\n```\n1.[\u4e13\u5fc3OI - \u8df3\u623f\u5b50](https://www.luogu.org/problemnew/show/P5004)\n\n2.[Function](https://www.luogu.org/problemnew/show/U60144)//\u77e9\u4e58\u53ef\u4ee5\u62ff50\n\n3.[\u586b\u6570\u6e38\u620f](https://www.luogu.org/problemnew/show/P5023)//\u77e9\u4e58\u4f9d\u7136\u53ef\u4ee5\u62ff50\n\n```\n\n--------------\n\n[\u9ad8\u65af\u6d88\u5143](https://www.cnblogs.com/Dumblidor/p/5751579.html)\n\n[\u53c2\u8003\u8d44\u6599](https://ask.julyedu.com/article/493)[\u89c6\u9891](https://space.bilibili.com/88461692/channel/detail?cid=9450)\n\n### \u6784\u9020\u77e9\u9635\u7684\u8fdb\u9636\u5185\u5bb9\n\n\u76f4\u63a5\u6784\u9020\u77e9\u9635\u5355\u6b21\u4e58\u6cd5\u662f $O(len^3)$ \uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u7528\u5faa\u73af\u77e9\u9635\u4f18\u5316\u8fd9\u4e2a\u4e1c\u897f\u3002\n\n\u5bf9\u4e8e\u90a3\u79cd\u5927\u4e00\u70b9\u7684\u77e9\u9635\uff0c\u5982\u679c\u4ed6\u7684\u6bcf\u884c\u6216\u8005\u6bcf\u5217\u90fd\u53ef\u4ee5\u901a\u8fc7\u4e0a\u4e00\u884c\u63a8\u51fa\u6765\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u505a\u5230\u6bcf\u6b21\u4e58\u6cd5 $O(n^2)$ \u7684\u590d\u6742\u5ea6\u3002\n\n\u4e3e\u4e2a[\u4f8b\u5b50](https://www.luogu.org/problem/P3746)\u3002\n\n\u5bf9\u4e8e\u8fd9\u9053\u9898\u6211\u4eec\u7684\u8f6c\u79fb\u77e9\u9635\u662f\u8fd9\u6837\u7684\uff1a\n\n$$\\begin{bmatrix}1\\ 1\\ 0\\ \\ldots\\ 0\\\\0\\ 1\\ 1\\ \\ldots\\ 0\\\\0\\ 0\\ 1\\ \\ldots\\ 0\\\\ \\ldots\\\\1\\ 0\\ 0\\ \\ldots\\ 1\\end{bmatrix}$$\n\n\u8fd9\u4e2a\u4e1c\u897f\u5c31\u662f\u7b2c\u4e00\u5217\u5f80\u540e\u6bcf\u6b21\u5411\u540e\u63a8\u4e00\u683c\u5373\u53ef\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8f6c\u79fb\u7684\u65f6\u5019\u5c31\u4e0d\u9700\u8981\u518d\u679a\u4e3e $k$ \uff0c\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u679a\u4e3e\u7b2c\u4e00\u5217\u7684\u60c5\u51b5\u5411\u540e\u63a8\u3002\n\n\u6211\u4eec\u8bbe m \u4e3a\u5217\u6570\uff0c n \u4e3a\u884c\u6570\uff0c\u90a3\u4e48\u7ed9\u51fa\u4e00\u6bb5\u4f2a\u4ee3\u7801\uff1a\n\n```cpp\nfor (i = 1 -> m) for (j = 1 -> n) \n    c.mp[(i + j) % k] += a.mp[i] * b.mp[j]\n```\n\n\u5faa\u73af\u5173\u7cfb\u5728\u672c\u9898\u4e2d\u662f\u7b2c\u4e00\u884c\u5f80\u7b2c\u4e8c\u884c\u5373\u6240\u6709\u5143\u7d20\u53f3\u79fb\u4e00\u4f4d\uff0c\u6240\u4ee5\u5c31\u662f\u679a\u4e3e\u5f53\u524d\u662f\u7b2c\u51e0\u5217\uff0c\u7136\u540e\u5411\u540e\u679a\u4e3e\u5f53\u524d\u8fd9\u5217\u7684\u5143\u7d20\u5728\u540e\u9762\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u7531\u4e8e $i$ \u5217\u7684\u5143\u7d20\u7684\u72b6\u6001\u5168\u90e8\u53ef\u4ee5\u7531\u7b2c\u4e00\u5217\u63a8\u51fa\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u76f4\u63a5\u8ba1\u7b97\u7b2c\u4e00\u5217\u6bcf\u4e2a\u5143\u7d20\u88ab\u7d2f\u52a0\u7684\u4e1c\u897f\uff0c\u5c31\u76f4\u63a5\u628a\u6240\u6709\u4e1c\u897f\u90fd\u7d2f\u52a0\u5230\u7b2c\u4e00\u5217\u4e0a\u53bb\u3002\n\n\u6240\u4ee5\u8fd9\u4e2a\u4e1c\u897f\u5176\u5b9e\u5c31\u662f\u5229\u7528\u4e86\u5faa\u73af\u77e9\u9635\u4f7f\u52a0\u548c\u7ed3\u679c\u4e00\u81f4\u7684\u5730\u65b9\u90fd\u53ef\u4ee5\u4e00\u6837\u7684\u641e\uff0c\u4ece\u800c\u628a\u8f6c\u79fb\u7a7a\u95f4\u538b\u5230\u4e86\u4e00\u7ef4\uff0c\u8f6c\u79fb\u7684\u65f6\u95f4\u538b\u5230\u4e86\u4e8c\u7ef4\u3002\n\n\u6709\u4eba\u8ddf\u6211\u8bf4\u8fd9\u73a9\u610f\u672c\u8d28\u5c31\u662f\u4e00\u4e2a\u5377\u79ef\uff0c\u6240\u4ee5\u53ea\u8981\u6ee1\u8db3\u5faa\u73af\u77e9\u9635\u5c31\u90fd\u662f\u8f6c\u79fb\u5230 $(i+j) \\% k$ \u7684\u3002\n\n\u7531\u4e8e\u8fd9\u4e2a\u4e1c\u897f\u5c31\u662f\u4e2a\u5377\u79ef\uff0c\u6240\u4ee5\u4e5f\u53ef\u4ee5\u7528\u5e38\u7cfb\u6570\u9f50\u6b21\u7ebf\u6027\u9012\u63a8\u505a\u5230\u5355\u6b21 $O(n\\ log\\ n)$ \uff0c\u4f46\u697c\u4e3b\u8fd8\u4e0d\u4f1a\u8fd9\u73a9\u610f\uff0c\u611f\u5174\u8da3\u53ef\u4ee5\u81ea\u5df1\u53bb\u5b66\uff0c\u4e5f\u53ef\u4ee5\u7b49\u6211\u4ec0\u4e48\u65f6\u5019\u4f1a\u4e86\u518d\u8865\u5145\u3002\n",
        "postTime": 1546557768,
        "uid": 104379,
        "name": "Cesare",
        "ccfLevel": 7,
        "title": "Martrix\u5b66\u4e60\u4e0e\u68b3\u7406"
    },
    {
        "content": "## \u77e9\u9635\u52a0\u901f\n\u524d\u7f6e\u77e5\u8bc6\uff1a\u77e9\u9635\u4e58\u6cd5\uff0c\u77e9\u9635\u5feb\u901f\u5e42\u3002\uff08\u4f1a\u7684\u53ef\u4ee5\u8df3\u8fc7\uff09\n### \u77e9\u9635\u4e58\u6cd5\n\u8fd9\u662f\u4e00\u4e2a\u4ee4\u4eba\u5934\u75db\u7684\u4e1c\u897f\u3002\n\n\u5047\u5982\u6709\u4e24\u4e2a\u77e9\u9635\uff0c\u5b83\u4eec\u4e3aA\u548cB\uff0c\n\n$$A=\\begin{bmatrix}a & b\\\\c & d\\\\e & f\\end{bmatrix},B=\\begin{bmatrix}a & b & c\\\\d & e & f\\end{bmatrix}$$\n\u5219\uff1a$A\u00d7B=\\begin{bmatrix}(a^2+bd)\\space\\space\\space\\space\\space\\space(ab+be)\\space\\space\\space\\space\\space\\space(ac+bf)\\\\(ca+d^2)\\space\\space\\space\\space\\space\\space(cb+de)\\space\\space\\space\\space\\space\\space(c^2+df)\\\\(ea+fd)\\space\\space\\space\\space\\space\\space (eb+fe)\\space\\space\\space\\space\\space\\space(ec+f^2)\\end{bmatrix}$\n\n**\u6253\u5f97\u771f\u7d2f\uff0c\u5927\u5bb6\u7ed9\u4e00\u70b9\u529b\u5440\u3002**\n\n\u5f53\u7136\uff0c\u77e9\u9635\u4e58\u6cd5\u53ea\u5f53\u77e9\u9635A\u4e3an\u884ck\u5217\uff0c\u77e9\u9635B\u4e3ak\u884cm\u5217\u65b9\u53ef\u8fdb\u884c\u4e58\u6cd5\u8fd0\u7b97\u3002\u6211\u4eec\u53ef\u4ee5\u603b\u7ed3\u4e00\u4e0b\uff1a\u82e5\u77e9\u9635A\u4e3an\u884ck\u5217\uff0c\u77e9\u9635B\u4e3ak\u884cm\u5217\uff0c\u5219$Ci,j=\\sum_{d=1}^kA_{i,d}\u00d7B_{d,j}$\u3002\n### \u77e9\u9635\u5feb\u901f\u5e42\n\u666e\u901a\u7684\u5feb\u901f\u5e42\u5927\u5bb6\u4e00\u5b9a\u90fd\u61c2\u5427\uff0c\u8fd9\u91cc\u4e0d\u591a\u505a\u8bb2\u89e3\u3002\n\n\u77e9\u9635\u5feb\u901f\u5e42\u548c\u666e\u901a\u5feb\u901f\u5e42\u539f\u7406\u4e00\u6837\uff0c\u53ea\u4e0d\u8fc7\u4e58\u6cd5\u7684\u65f6\u5019\u9ebb\u70e6\u4e86\u4e00\u70b9\u7f62\u4e86\u3002\u8fd8\u662f\u7ed9\u4e00\u4e2a\u4ee3\u7801\u7ed9\u5927\u5bb6\u770b\u4e00\u770b\u5427\uff08\u7801\u98ce\u6bd4\u8f83\u4e11\uff09\uff1a\n```cpp\n#include<cstdio>\n#define N 110\n#define mod 1000000007\nusing namespace std;\nstruct matrix\n{\n\tlong long a[N][N];\n} s,ans;\nint n;\nmatrix operator *(matrix &a,matrix &b)\n{\n\tmatrix x;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tx.a[i][j]=0;\n\t\t\tfor(int k=1;k<=n;k++)\n\t\t\t{\n\t\t\t\tx.a[i][j]=(x.a[i][j]+a.a[i][k]*b.a[k][j])%mod;\n\t\t\t}\n\t\t}\n\t}\n\treturn x;\n}\nlong long k;\nint main()\n{\n\tscanf(\"%d%lld\",&n,&k);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tscanf(\"%lld\",&s.a[i][j]);\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++) ans.a[i][i]=1;\n\twhile(k)\n\t{\n\t\tif(k&1) ans=ans*s;\n\t\tk=k>>1;\n\t\ts=s*s;\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tprintf(\"%lld \",ans.a[i][j]);\n\t\t}\n\t\tprintf(\"\\n\");\n\t}\n}\n```\n\u597d\u4e86\uff0c\u8fdb\u5165\u4e3b\u9898\n# \u77e9\u9635\u52a0\u901f\n\u6211\u4eec\u8981\u6c42\u7684\u662f$f[i]$\uff0c\u5176\u4e2d\uff0c$f[i]=f[i-1]+f[i-3]$\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u538b\u7f29\u4e00\u4e0b\u72b6\u6001\uff0c\u5f97\u5230\u8fd9\u4e48\u4e00\u4e2a\u4e1c\u897f\uff1a\n$$f[i]=1\u00d7f[i-1]+0\u00d7f[i-2]+1\u00d7f[i-3]$$\n$$f[i-1]=1\u00d7f[i-1]+0\u00d7f[i-2]+0\u00d7f[i-3]$$\n$$f[i-2]=0\u00d7f[i-1]+1\u00d7f[i-2]+0\u00d7f[i-3]$$\n\u7136\u540e\u6211\u4eec\u5c1d\u8bd5\u628a\u5b83\u538b\u7f29\u5230\u4e00\u4e2a\u77e9\u9635\u5185\uff1a\n$$A=\\begin{bmatrix}1&0&1\\\\1&0&0\\\\0&1&0\\end{bmatrix}$$\n\u7136\u540e\u8dd1\u4e00\u6b21\u5feb\u901f\u5e42\u3002\n\n\u4e3a\u4ec0\u4e48\u53ef\u4ee5\u8fd9\u6837\u505a\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u77e9\u9635\u4e58\u6cd5\u7684\u539f\u7406\u5f97\u5230\uff0c\u5982\u4e0b\uff1a\n\n$$\\begin{bmatrix}f[i-1]\\\\f[i-2]\\\\f[i-3]\\end{bmatrix}\\times\\begin{bmatrix}1&0&1\\\\1&0&0\\\\0&1&0\\end{bmatrix}=\\begin{bmatrix}f[i-1]+f[i-3]\\\\f[i-1]\\\\f[i-2]\\end{bmatrix}=\\begin{bmatrix}f[i]\\\\f[i-1]\\\\f[i-2]\\end{bmatrix}$$\n\n\u600e\u4e48\u6837\uff0c\u5f88\u795e\u5947\u5427\uff0c\u5176\u5b9e\u77e9\u9635\u5feb\u901f\u5e42\u4e5f\u53ef\u4ee5\u7528\u6765\u4f18\u5316DP\uff0c\u4f5c\u7528\u5f88\u5e7f\u5462\u3002\n\n\u8be5\u4e0a\u4ee3\u7801\u4e86\u3002\n```cpp\n#include<cstdio>\n#define N 110\n#define mod 1000000007\nusing namespace std;\nstruct matrix\n{\n\tlong long a[N][N];\n} s,ans;\nint n=3;\nmatrix operator *(matrix &a,matrix &b)\n{\n\tmatrix x;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tx.a[i][j]=0;\n\t\t\tfor(int k=1;k<=n;k++)\n\t\t\t{\n\t\t\t\tx.a[i][j]=(x.a[i][j]+a.a[i][k]*b.a[k][j])%mod;\n\t\t\t}\n\t\t}\n\t}\n\treturn x;\n}\nint getans(int k)\n{\n\tmatrix ans;\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=n;j++) s.a[i][j]=0,ans.a[i][j]=0;\n\ts.a[1][1]=s.a[1][3]=s.a[2][1]=s.a[3][2]=1;\n\tans.a[1][1]=ans.a[2][2]=ans.a[3][3]=1;\n\twhile(k)\n\t{\n\t\tif(k&1) ans=ans*s;\n\t\tk=k>>1;\n\t\ts=s*s;\n\t}\n\treturn ans.a[2][1];\n}\nint T,a;\nint main()\n{\n\tscanf(\"%d\",&T);\n\twhile(T--)\n\t{\n\t\tscanf(\"%d\",&a);\n\t\tprintf(\"%d\\n\",getans(a));\n\t}\n}\n```\n\u849f\u84bb\u521d\u5b66\u77e9\u9635\u8fd9\u73a9\u610f\u513f\uff0c\u8bf7\u5927\u4f6c\u52ff\u55b7\u3002",
        "postTime": 1579000466,
        "uid": 99506,
        "name": "_LHF_",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "\u9996\u5148\u8981\u5148\u4f1a\u77e9\u9635\u4e58\u6cd5\uff0c\u5927\u4f6c\u4eec\u8bb2\u7684\u5f88\u6e05\u695a\u4e86\uff0c\u4e0d\u7ec6\u8bf4\u4e86\n```cpp\nconst long long Mod=1000000007;\nvoid mul(long long a[4][4],long long b[4][4],long long c[4][4],long long n,long long m,long long p)\n{\n\tmemset(c,0,sizeof(c));\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tfor (int j=1;j<=m;j++)\n\t\t{\n\t\t\tfor (int k=1;k<=p;k++)\n\t\t\t{\n\t\t\t\tc[i][j]+=(a[i][k]*b[k][j])%Mod;\t\n\t\t\t\tc[i][j]%=Mod;\n\t\t\t} \n\t\t}\n\t}\n} \n\n```\n\u7136\u540e\u8981\u5148\u4f1a\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u5927\u4f6c\u4eec\u8bb2\u7684\u4e5f\u5f88\u6e05\u695a\u4e86\uff0c\u4e0d\u7ec6\u8bf4\u4e86\n```cpp\nvoid pow(long long a[4][4],long long n,long long Ans[4][4])\n{\n\tmemset(Ans,0,sizeof(Ans));\n\tlong long y[4][4];\n\tmemset(y,0,sizeof(y));\n\tif (n==1) \n\t{\n\t\tfor (int i=1;i<=3;i++)\n\t\t{\n\t\t\tfor (int j=1;j<=3;j++)\n\t\t\t{\n\t\t\t\tAns[i][j]=a[i][j];\n\t\t\t}\n\t\t}\n\t\treturn;\n\t}\n\tlong long p[4][4];\n\tmemset(p,0,sizeof(p));\n\tif (n%2==0)\n\t{\n\t\tpow(a,n/2,p);\n\t\tmul(p,p,Ans,3,3,3);\n\t\treturn;\n\t}\n\tpow(a,n/2,p);\n\tmul(p,p,y,3,3,3);\n\tmul(y,a,Ans,3,3,3);\n}\n\n```\n\u8fd9\u91cc\u7684\u5feb\u901f\u5e42\u6570\u7ec4\u5e94\u8be5\u662f\n\n1 1 0\n\n0 0 1\n\n1 0 0\n\n\u6700\u540e\uff0c\u8d34\u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nlong long N,T;\nlong long A[4][4],ans[4][4],base[4][4],base2[4][4];\nconst long long Mod=1000000007;\nvoid mul(long long a[4][4],long long b[4][4],long long c[4][4],long long n,long long m,long long p)\n{\n\tmemset(c,0,sizeof(c));\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tfor (int j=1;j<=m;j++)\n\t\t{\n\t\t\tfor (int k=1;k<=p;k++)\n\t\t\t{\n\t\t\t\tc[i][j]+=(a[i][k]*b[k][j])%Mod;\t\n\t\t\t\tc[i][j]%=Mod;\n\t\t\t} \n\t\t}\n\t}\n} \nvoid pow(long long a[4][4],long long n,long long Ans[4][4])\n{\n\tmemset(Ans,0,sizeof(Ans));\n\tlong long y[4][4];\n\tmemset(y,0,sizeof(y));\n\tif (n==1) \n\t{\n\t\tfor (int i=1;i<=3;i++)\n\t\t{\n\t\t\tfor (int j=1;j<=3;j++)\n\t\t\t{\n\t\t\t\tAns[i][j]=a[i][j];\n\t\t\t}\n\t\t}\n\t\treturn;\n\t}\n\tlong long p[4][4];\n\tmemset(p,0,sizeof(p));\n\tif (n%2==0)\n\t{\n\t\tpow(a,n/2,p);\n\t\tmul(p,p,Ans,3,3,3);\n\t\treturn;\n\t}\n\tpow(a,n/2,p);\n\tmul(p,p,y,3,3,3);\n\tmul(y,a,Ans,3,3,3);\n}\nint main()\n{\n\tscanf(\"%lld\",&T);\n\tbase[1][1]=1,base[1][2]=1,base[1][3]=0;\n\tbase[2][1]=0,base[2][2]=0,base[2][3]=1;\n\tbase[3][1]=1,base[3][2]=0,base[3][3]=0;\n\tA[1][1]=1,A[1][2]=1,A[1][3]=1;\n\tfor (int i=1;i<=T;i++)\n\t{\n\t\tmemset(ans,0,sizeof(ans));\n\t\tcin >> N;\n\t\tif (N<=3)\n\t\t{\n\t\t\tprintf(\"1\\n\");\n\t\t\tcontinue;\n\t\t}\n\t\tmemset(base2,0,sizeof(base2));\n\t\tpow(base,N-3,base2);\n\t\tmul(A,base2,ans,1,3,3);\n\t\tcout << ans[1][1] << endl;;\n\t\t\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1565939484,
        "uid": 151475,
        "name": "Little09",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": " \u7b97\u6cd5\uff1a\u77e9\u9635\u52a0\u901f\r\n \r\n \u524d\u7f6e\u77e5\u8bc6\uff1a\r\n \r\n1. \u5565\u662f\u77e9\u9635\uff1f\r\n2. \u77e9\u9635\u5982\u4f55\u8fd0\u7b97\uff1f\r\n\r\n \u63a5\u4e0b\u6765\u5c31\u8ba9\u6211\u4e00\u4e00\u89e3\u7b54\r\n \r\n 1. \u77e9\u9635\r\n \r\n\u5f88\u50cf\u6211\u4eec\u4f7f\u7528\u7684\u4e8c\u7ef4\u6570\u7ec4\uff0c\u4e3e\u4e2a\u4f8b\u5b50\u5c31\u884c\u4e86\uff0c\u5982\u4e0b\u56fe\uff0c\u4e00\u4e2a 3 \u884c 4 \u5217 \u77e9\u9635\uff1a\r\n![](https://cdn.luogu.com.cn/upload/pic/60501.png)\r\n\r\n 2. \u77e9\u9635\u8fd0\u7b97\r\n \r\n- \u52a0\u51cf\u6cd5\r\n\r\n\u5341\u5206\u5bb9\u6613\u7406\u89e3\uff0c\u4e24\u4e2a m \u884c n \u5217\u7684\u77e9\u9635\u53ef\u4ee5\u76f8\u52a0\u51cf\uff08\u89c4\u6a21\u5fc5\u987b\u4e00\u6837\uff09\uff0c\u7ed3\u679c\u77e9\u9635\u4e3a\u5bf9\u5e94\u6bcf\u4e2a\u6570\u5b57\u7684\u548c\u6216\u5dee\r\n![](https://cdn.luogu.com.cn/upload/pic/60502.png)\r\n\r\n- \u4e58\u6cd5\uff08\u6728\u6709\u9664\u6cd5\uff09\r\n\r\n\u6709 n \u884c m \u5217\u77e9\u9635 A \u548c m \u884c p \u5217\u77e9\u9635 B\uff08A\u7684\u5217\u6570\u5fc5\u987b\u7b49\u4e8eB\u7684\u884c\u6570\uff09\r\n\r\n\u82e5 A * B = \u77e9\u9635 C\uff0c\u90a3\u4e48 C[i,j]=\u2211 A[i,k] * B[k,j] (1<=k<=m,1<=i<=n,1<=j<=p)\r\n\r\nM[i,j] \u8868\u793a\u77e9\u9635 i \u884c j \u5217\u7684\u6570\u5b57 \r\n\r\n\u540c\u65f6 C \u4e3a n \u884c p \u5217\u77e9\u9635\r\n\r\n[LaTeX\u4e0d\u4f1a\u7528\u5c06\u5c31\u770b\u5566QAQ]\r\n\r\n\u6709\u70b9\u7ed5\u662f\u4e0d\u662f\uff0c\u6211\u63a5\u4e0b\u6765\u4e3e\u4e2a\u4f8b\u5b50\uff1a\r\n\r\n![](https://cdn.luogu.com.cn/upload/pic/60503.png)\r\n\r\n\u5148\u8ba1\u7b97\u7ed3\u679c\u77e9\u9635 C[2,2] \u4f4d\u7f6e\u7684\u503c\uff0c\u6839\u636e\u4e0a\u9762\u7684\u5f0f\u5b50\uff0cC[2,2] \u7684\u503c\u53ea\u8ddf A \u7684 2 \u884c\u548c   B \u7684 2 \u5217\u6709\u5173\uff0c\u5148\u7531\u84dd\u8272\u7ebf\u6761\u6807\u51fa\r\n\r\n![](https://cdn.luogu.com.cn/upload/pic/60504.png)\r\n\r\n\u770b\u5230 A \u7b2c\u4e8c\u884c\u7684\u7b2c\u4e00\u4e2a\u6570\u5b57\u548c B \u7b2c\u4e8c\u5217\u7684\u7b2c\u4e00\u4e2a\u6570\u5b57\uff0c\u7528\u8089\u8272\u6807\u51fa\r\n\r\n\u6839\u636e\u516c\u5f0f\uff0c\u4e24\u8005\u76f8\u4e58 1 * 0 = 0\uff0c\u5f97\u51fa\u7684\u79ef\u5148\u4fdd\u7559\u7740\r\n\r\n\u63a5\u7740\uff0cA \u7684\u8089\u8272\u683c\u5b50\u5411\u53f3\u4e00\u683c\uff0cB \u7684\u683c\u5b50\u5411\u4e0b\u4e00\u683c\r\n\r\n![](https://cdn.luogu.com.cn/upload/pic/60505.png)\r\n\r\n\u9009\u4e2d\u6570\u5b57\u518d\u76f8\u4e58\uff0c4 * 2 = 8\r\n\r\n\u7136\u540e\u6301\u7eed\u8fd9\u4e48\u5e72\uff0c\u76f4\u5230\u8089\u8272\u683c\u5b50\u79fb\u51fa\u4e86 A \u4e0e B \u77e9\u9635\uff0c\u9014\u4e2d\u6240\u6709\u7684\u79ef\u4e5f\u5f97\u5230\u4e86\r\n\r\n![](https://cdn.luogu.com.cn/upload/pic/60507.png)\r\n\r\n\u628a\u6240\u6709\u79ef\u76f8\u52a0\uff0c\u5c31\u662f\u6a59\u8272\u683c\u5b50\u7684\u6570\u5b57\u4e86\r\n\r\n\u7136\u540e\u628a\u5176 C \u4e2d\u5176\u4ed6\u683c\u5b50\u4e5f\u8fd9\u4e48\u7b97\uff0c\u7ed3\u679c\u662f\r\n\r\n![](https://cdn.luogu.com.cn/upload/pic/60508.png)\r\n\r\n\u6b64\u90e8\u5206\u5185\u5bb9\u9700\u8981\u5404\u4f4d OIer \u4eec\u81ea\u884c\u719f\u6089\r\n\r\n\u77e9\u9635\u4e58\u6cd5\u641e\u8fd9\u4e48\u96be\uff0c\u56fe\u4e2a\u5565\uff1f\u7528\u5904\u5c31\u5728\u8fd9\u9898\r\n\r\n\r\n------------\r\n\r\n\r\n \u77e9\u9635\u52a0\u901f\uff1a\r\n \r\n\u7b2c\u4e00\u773c\u770b\u7740\u9053\u9898\uff1a\u8fd9\u4e0d\u6c34\u9898\u5417\uff1fO(n) \u9012\u63a8\u554a\uff01\u4f46\u8c8c\u4f3c\u4e8b\u60c5\u5e76\u6ca1\u6709\u8fd9\u4e48\u7b80\u5355\u2026\u2026\r\n\r\nn<=2000000000\uff0c\u8fd8\u6709 T<=100\uff0cO(n) \u770b\u4e0a\u53bb\u86ee\u5feb\u7684\uff0c\u5b9e\u9645\u4e0a\u8fd8\u4e0d\u591f\r\n\r\n\u7531\u4e8e\u9898\u76ee\u4e2d a[n]=a[n-3]+a[n-1] \uff0c\u53ef\u89c1\u7b2c n \u4e2a\u6570\u53ea\u8ddf\u524d\u9762 3 \u4e2a\u6570\u6709\u5173\uff0c\u6240\u4ee5\u6bcf\u6b21\u6211\u4eec\u53ea\u7528\u5b58\u4e09\u4e2a\u6570\u5c31\u884c\u4e86\r\n\r\n\u7528\u4e00\u4e2a 1 \u884c 3 \u5217\u77e9\u9635\u53ef\u4ee5\u5982\u6b64\u8868\u793a\uff1a\r\n\r\n[ a[x-3] , a[x-2] , a[x-1] ]\r\n\r\n\u60f3\u77e5\u9053 a[x] ? \u5f53\u7136\u662f\u60f3\u8ba9\u8fd9\u4e2a\u77e9\u9635\u901a\u8fc7\u67d0\u79cd\u8fd0\u7b97\u53d8\u6210 [ a[x-2] , a[x-1] , a[x] ] \u55bd\uff0c\u5982\u679c\u60f3\u7528\u77e9\u9635\u4e58\u6cd5\u8fbe\u5230\u8fd9\u4e2a\u76ee\u7684\uff0c\u90a3\u5c31\u5f97\u5728\u539f\u77e9\u9635\u4e0a\u4e58\u4ee5\u6240\u8c13\u7684\u8f6c\u79fb\u77e9\u9635\uff1a\r\n\r\n![](https://cdn.luogu.com.cn/upload/pic/60513.png)\r\n\r\n\u9012\u63a8\u5230 x \u7684\u77e9\u9635\u7528 A(x) \u8868\u793a\u597d\u4e86\uff0c\u82e5\u77e5\u9053 A(x-1) \uff0c\u60f3\u7b97\u51fa A(x) \u53ea\u9700\u8981\u4e58\u4ee5\u4e0a\u9762\u7684\u8f6c\u79fb\u77e9\u9635 T \u5c31\u884c\u4e86\uff0c\u516c\u5f0f\u8868\u8fbe\u4e3a \uff1a\r\n\r\nA(x)=A(x-1) * T\r\n\r\nA(0)=[1,1,1]\r\n\r\n\u7531\u6b64\u6613\u5f97 A(n)=A(0) * T^n\r\n\r\n\u770b\u5230 T^n \uff0c\u540c\u65f6 n \u53c8\u5f88\u5927\uff0c\u60f3\u5230\u4e86\u4ec0\u4e48\uff1f\r\n\r\n\u5feb\u901f\u5e42\u554a\uff01\r\n\r\n\u800c\u5e95\u6570\u4e3a\u77e9\u9635\u7684\u5feb\u901f\u5e42\u53c8\u79f0\u4e3a\u77e9\u9635\u5feb\u901f\u5e42\r\n\r\n\u5b9e\u9645\u4e0a\u8ddf\u666e\u901a\u5feb\u901f\u5e42\u6ca1\u6709\u4ec0\u4e48\u533a\u522b\uff0c\u53ea\u662f\u77e9\u9635\u4e58\u4ee5\u77e9\u9635\u8981\u81ea\u5df1\u5199\u51fd\u6570\u7f62\u4e86\r\n\r\n\u7a0b\u5e8f\u53ef\u4ee5\u4e0a\u4e86\uff1a\r\n\r\n```cpp\r\n/*\r\na \u884c b \u5217\u7684\u77e9\u9635 A\r\nc \u884c d \u5217\u7684\u77e9\u9635 B\r\nA*B=C\r\n\t\t\t\t\t    m \u4e2a                 m \u4e2a \r\nC \u6bcf\u4e2a\u4f4d\u7f6e\u7684\u6570\u5b57 = A \u8fd9\u4e00\u884c\u4e0a\u7684\u6570\u5b57 * B \u8fd9\u4e00\u5217\u4e0a\u7684\u6570\u5b57 \u4e4b\u548c \r\n\r\n { a[n-2],a[n-1],a[n] }\r\n={ a[n-3],a[n-2],a[n-1] } * { 0,0,1 }\r\n\t\t\t\t\t\t    { 1,0,0 } \r\n\t\t\t\t\t\t    { 0,1,1 } \r\n*/\r\ninclude<bits/stdc++.h>\r\nusing namespace std;\r\n\r\nint n;\r\nlong long a[5],TM[5][5];//\u6ca1\u6709\u9a82\u4eba\u7684\u610f\u601d\uff0c\u771f\u7684\u662f\u8fd9\u4e2a\u7ffb\u8bd1\r\nlong long Example[5][5]=\r\n{\r\n\t{0,0,1},\r\n\t{1,0,0},\r\n\t{0,1,1}\r\n};\r\n\r\nvoid Matrix_Multi()\r\n{\r\n\tlong long cnt[5];\r\n\tmemset(cnt,0,sizeof cnt);\r\n\tfor(int i=0;i<3;i++)//A(x) * T\r\n\t\tfor(int j=0;j<3;j++)\r\n\t\t\tcnt[i]=(cnt[i]+a[j]*TM[j][i])%1000000007;\r\n\tmemcpy(a,cnt,sizeof cnt);//\u522b\u5fd8\u4e86\u628a\u7b97\u51fa\u6765\u7684\u7ed3\u679c\u8986\u76d6\u5230\u77e9\u9635\u91cc\r\n}\r\n\r\nvoid POW2()\r\n{\r\n\tlong long cnt[5][5];\r\n\tmemset(cnt,0,sizeof cnt);\r\n\tfor(int i=0;i<3;i++)//T * T\r\n\t\tfor(int j=0;j<3;j++)\r\n\t\t\tfor(int f=0;f<3;f++)\r\n\t\t\t\tcnt[i][j]=(cnt[i][j]+TM[i][f]*TM[f][j])%1000000007;\r\n\tmemcpy(TM,cnt,sizeof cnt);\r\n}\r\n\r\nint main()\r\n{\r\n\tint T;\r\n\tscanf(\"%d\",&T);\r\n\twhile(T--)\r\n\t{\r\n\t\tscanf(\"%d\",&n);\r\n\t\tn--;\r\n\t\ta[0]=a[1]=a[2]=1;//\u521d\u59cb\u5316\r\n\t\tmemcpy(TM,Example,sizeof Example);\r\n\t\tfor(;n;n>>=1)//\u5feb\u901f\u5e42\r\n\t\t{\r\n\t\t\tif(n&1) Matrix_Multi();\r\n\t\t\tPOW2();\r\n\t\t}\r\n\t\tcout<<a[0]<<endl;\r\n\t}\r\n\treturn 0;\r\n}\r\n```\r\n\r\n\u6211\u4eec\u628a\u957f\u5ea6\u4e3a n \u7684\u4e00\u7ef4\u5411\u91cf\uff081 \u884c n \u5217\u77e9\u9635\uff09\u79f0\u4e3a\u201c\u72b6\u6001\u77e9\u9635\u201d\uff0c\u628a\u7528\u4e8e\u201c\u72b6\u6001\u77e9\u9635\u201d\u76f8\u4e58\u7684\u56fa\u5b9a\u4e0d\u53d8\u7684\u77e9\u9635\u79f0\u4e3a\u201c\u8f6c\u79fb\u77e9\u9635\u201d\u3002\u82e5\u72b6\u6001\u77e9\u9635\u4e2d\u7684\u7b2c x \u4e2a\u6570\u5bf9\u4e0b\u4e00\u4e2a\u5355\u4f4d\u65f6\u95f4\u72b6\u6001\u77e9\u9635\u7684\u7b2c y \u4e2a\u6570\u4ea7\u751f\u5f71\u54cd\uff0c\u8fd9\u628a\u8f6c\u79fb\u77e9\u9635\u7684\u7b2c x \u884c\u7b2c y \u5217\u8d4b\u503c\u4e3a\u76f8\u5e94\u7684\u7cfb\u6570\u3002\u5173\u952e\u5728\u4e8e\u627e\u51fa\u6b63\u786e\u7684\u201c\u8f6c\u79fb\u77e9\u9635\u201d\u3002\r\n\r\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a O(n^3 * log T)\uff0cT \u4e3a\u9012\u63a8\u603b\u8bba\u6570\u3002\r\n\r\n\r\n------------\r\n\r\n[\u4ee5\u4e0a\u8282\u9009\u81ea\u674e\u715c\u4e1c\u7684\u300a\u7b97\u6cd5\u7ade\u8d5b\u8fdb\u9636\u6307\u5357\u300b]\r\n\r\n\r\n------------\r\n\r\n  \u6ce8\u610f\u4e00\u4e2a\u5c0f\u70b9\uff1a \r\n \r\n  _\u7528\u8fd9\u4e2a\u65b9\u6cd5\u4f60\u4f1a\u7b97\u51fa a[n+1] \u800c\u5e76\u975e a[n]\uff0c\u8bfb\u5165\u7684\u65f6\u5019\u8bb0\u5f97\u628a n \u51cf\u4e00_ ",
        "postTime": 1560077640,
        "uid": 54591,
        "name": "Seauy",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "**\u5176\u5b9e\u8fd9\u4e00\u9898\u8fd8\u662f\u633a\u7b80\u5355\u7684\uff08~~\u5982\u679c\u4f60\u4f1a\u77e9\u9635\u5feb\u901f\u5e42\u7684\u8bdd~~\uff09,\u4e0d\u4f1a\u7684\u5feb\u53bb\u5b66\u554a\uff01\uff01\uff01\n\u597d\u5566\uff0c\u56de\u5f52\u6b63\u9898\uff0c\u4e0b\u9762\u5c31\u8bb2\u4e00\u4e0b\u672c\u849f\u84bb\u7684\u62d9\u89c1\u3002**\n\n\n------------\n\n## 1.\u539f\u7406\u90e8\u5206\n\u7531\u9898\u77e5:\n     -   f[n]=f[n-1]+f[n-3]\u3002\u6211\u4eec\u53ea\u8981\u4ece\u8fd9\u4e2a\u516c\u5f0f\u51fa\u53d1\u5c31\u597d\u4e86\u3002\n     -   \u6211\u4eec\u5047\u8bbe\u6709\u4e24\u4e2a\u6570\u7ec4A[],B[]\u3002\n     \n     -   A:f[3],f[2],f[1]\u3002//A\u53ea\u6709\u4e00\u884c\u4e09\u5217\u3002\n     \n  - \u3000B\uff1a               //B\u9700\u8981\u624b\u63a8\u3002\n  \n  \n            1 1 0\n            \n            0 0 1\n            \n            1 0 0\n   -\u5982\u679c\u6211\u4eec\u8ba9A*B\u4f1a\u6709\u4ec0\u4e48\u795e\u5947\u7684\u4e8b\u53d1\u751f\u5462\uff1f\n     -\u806a\u660e\u7684\u4f60\u4e00\u5b9a\u53d1\u73b0\u4e86\n     - A*B=\uff08f[3]+f[1]+0,f[3]+0+0,f[2]+0+0\uff09\n          =f[4],f[3],f[2]\n     - \u8fd9\u65f6\u5019\u6211\u4eec\u628a\u5f97\u5230\u7684\u7ed3\u679c\u518d\u4e58\u4e00\u4e2aB\u6570\u7ec4\n     - \u5b83\u5c31\u795e\u5947\u7684\u53d8\u4e3a f[5],f[4],f[3]\u5566!\n     - \u6211\u4eec\u518d\u4e58\uff0c\u6bcf\u4e2af\u7684\u4e0b\u8868\u5c31\u52a01\u3002\n     \u4e8e\u662f\uff0c\u6211\u4eec\u5f97\u5230\u7ed3\u8bba\u3002\n  ### (f[n],f[n-1],f[n-2])*B=(f[n+1],f[n],f[n-1])\u3002\n    \u6211\u4eec\u6700\u5f00\u59cb\u77e5\u9053 f[3],f[2],f[1]\uff0c\u628a\u5b83\u5f53\u505aA\u6570\u7ec4\u3002\n    \u5982\u679c\u6211\u4eec\u60f3\u77e5\u9053f[x]\u7684\u503c\uff0c\u6211\u4eec\u4e0d\u662f\u53ea\u8981\u4e58x-3\u4e2aB\u5c31\u80fd\u5f97\u5230\u7b54\u6848\u4e86\u4e48\u3002\n   \u55ef\uff08~~too young too sample\uff0c\u54c8\u54c8~~\uff09\uff0c\u4f46\u6211\u7528\u9012\u63a8\u4e5f\u662f\u63a8x-3\u6b21\uff0c\n   \u90a3\u6211\u5e72\u561b\u8fd8\u8981\u7528\u77e9\u9635\u52a0\u901f\u5462\uff1f\n   \n   ##### \u522b\u614c\uff0c\u6211\u6709\u77e9\u9635\u5feb\u901f\u5e42\uff01\uff01\uff01\n   \u867d\u7136\u77e9\u9635\u4e58\u6ca1\u6709\u4ea4\u6362\u7387\uff08\u5373A\u00d7B\u2260B\u00d7A\uff09\uff0c\n   \n   \u4f46\u5b83\u6709\u7ed3\u5408\u7387\u554a\uff08\u5373\uff08A\u00d7B\uff09\u00d7C==A\u00d7\uff08B\u00d7C\uff09\uff09\u3002\n   \n   \u65e2\u7136\u6211\u4eec\u6709x-3\u4e2aB\u8981\u4e58\uff0c\u90a3\u6211\u4eec\u53ef\u4ee5\u5148\u628a\u5b83\u7528\u5feb\u901f\u5e42\u6c42\u51fa\u6765\u3002\n   \n   (\u4ec0\u4e48\uff0c\u4f60\u4e0d\u4f1a\u5feb\u901f\u5e42\uff0c\u5feb\u53bb\u5b66\u554a\u3002\uff09\n   \n   \u5373\u6c42B^(x-3)\u3002\u6700\u540e\u518d\u4e58A\u3002\n   \n   \u5c31\u53ef\u4ee5\u901a\u8fc7\u51cf\u5c11\u76f8\u4e58\u7684\u6b21\u6570\u6765\u52a0\u5feb\u65f6\u95f4\u3002\n   \n   \u662f\u4e0d\u662f\u604d\u7136\u5927\u609f\u4e86\u5462\uff01\n   \n\n## 2.\u4ee3\u7801\u90e8\u5206\n\uff08\u7565\u4e11\uff0c\u522b\u6015\u3002\uff09\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\n#define ll long long\nll p=1000000007;\nstruct node{\n    ll map[4][4];\n}e,ans;\nll t,temp,answer=0;\nnode mul(node a,node b)//\u7528\u6765\u4e24\u4e2a\u77e9\u9635\u76f8\u4e58\u7684\u51fd\u6570\n{\n    node tp;\n    memset(tp.map,0,sizeof(tp));\n    for(int i=1;i<=3;i++)\n    for(int j=1;j<=3;j++)\n    for(int z=1;z<=3;z++)\n    tp.map[i][j]=(tp.map[i][j]+a.map[i][z]*b.map[z][j]%p)%p;\n    return tp;\n}\nvoid quick (node a,ll b)//\u77e9\u9635\u5feb\u901f\u5e42\u3002\n{\n    memset(ans.map,0,sizeof(ans));\n    ans.map[1][1]=ans.map[2][2]=ans.map[3][3]=1;//\u8bbe\u7f6e\u5355\u4f4d\u77e9\u9635\uff0c\u76f8\u5f53\n                                               //\u4e0e\u666e\u901a\u5feb\u901f\u5e42\u91cc\u7684ans \n                                               //\u7528\u6765\u8bb0\u5f55\u7b54\u6848\u3002\n    while(b)\n    {\n    if(b&1)\n    ans=mul(ans,a);\n    a=mul(a,a);\n    b=(b>>1);\n   }\n}\nint main()\n{\n    memset(e.map,0,sizeof(e));\n    e.map[1][1]=e.map[1][2]=e.map[2][3]=e.map[3][1]=1;//B\u6570\u7ec4\u7684\u521d\u503c\u3002\n    scanf(\"%lld\",&t);\n    for(int i=1;i<=t;i++)\n    {\n      scanf(\"%lld\",&temp);\n      if(temp==1||temp==2||temp==3)//\u5982\u679c\u662f\u6c42f[1],f[2]\uff0cf[3]\u76f4\u63a5\u8f93\u51fa\n        {\n            printf(\"%d\\n\",1);\n            continue;\n        }\n        quick(e,temp-3);//\u6c42B^(x-3)\u3002\n    printf(\"%lld\\n\",(ans.map[1][1]+ans.map[2][1]+ans.map[3][1])%p);\n//\u6700\u540e\u7684A*B^(x-3)\u3002\u7531\u4e8e\u53ea\u8981f[x]\uff0c\u6211\u4eec\u624b\u52a8\u76f8\u4e58\uff0c\u4e0d\u518d\u64cd\u4f5cf[x-1]\uff0cf[x-2]\u3002\n    }\nreturn 0;\n}\n\n```\n\u597d\u5566\uff0c\u5982\u679c\u60a8\u6709\u54ea\u91cc\u4e0d\u61c2\u7684\u8bdd\u5e76\u4e14\u4e0d\u5acc\u5f03\u672c\u849f\u84bb\u7684\u8bdd\uff0c\u53ef\u4ee5\u79c1\u4fe1\u6211\u54e6\u3002\n\n\u6709\u54ea\u91cc\u8bb2\u7684\u4e0d\u5bf9\u7684\u8bdddalao\u4e00\u5b9a\u6307\u51fa\u6765\u54e6\uff0c\u671bdalao\u65a7\u6b63\u3002\n\n           \n",
        "postTime": 1532092225,
        "uid": 70257,
        "name": "2413669045luo",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "\u77e9\u9635\u5feb\u901f\u5e42\u7684\u6a21\u677f\u9898\uff0c\u63a8\u5230\u8fc7\u7a0b\u5f88\u7b80\u5355\n$$\n\\begin{matrix}a[i] = 1\\times a[i-1] + 0\\times a[i-2]+1\\times a[i-3]\\\\\na[i-1] = 1\\times a[i-1] + 0\\times a[i-2]+0\\times a[i-3]\\\\\na[i-2] = 0\\times a[i-1] + 1\\times a[i-2]+0\\times a[i-3]\\\\\n\\Downarrow \\\\ \n\\begin{bmatrix}f[i]\\\\f[i-1]\\\\f[i-2]\\end{bmatrix}=\\begin{bmatrix}1&0&1\\\\1&0&0\\\\0&1&0\\end{bmatrix}\\times \\begin{bmatrix}f[i-1]\\\\f[i-2]\\\\f[i-3]\\end{bmatrix}\\end{matrix}\n$$\n\u76f4\u63a5\u66b4\u529b\u77e9\u9635\u5feb\u901f\u5e42\u662f\u53ef\u4ee5\u8fc7\u7684\uff0c\u4f46\u6709\u6ca1\u6709\u4f18\u5316\u5462\uff1f\n\n\u6211\u4eec\u8003\u8651\u79bb\u7ebf\u6765\u505a\u8fd9\u9053\u9898\n\n\u9996\u5148\u6211\u4eec\u628a\u6240\u6709\u7684\u6570\u636e\u8bfb\u5165\uff0c\u7136\u540e\u79bb\u6563\u5316\uff0c\u5e76\u6392\u5e8f\n\n\u5bf9\u4e0e$ans_i$\u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97$d=n_i-n_i$\u5f97\u5230\u4e00\u4e2a\u5dee\u503c\n\n\u7136\u540e\u53ea\u9700\u5c06$ans_{i-1}$\u4e58\u4e0a\u72b6\u6001\u8f6c\u79fb\u77e9\u9635$f$\u7684$d$\u6b21\u65b9\uff0c\u5c31\u662f$ans_i$\n\n\u53ef\u4ee5\u901a\u8fc7\u8fd9\u79cd\u64cd\u4f5c\u6765\u51cf\u5c11\u591a\u6b21\u91cd\u590d\u7684\u8fd0\u7b97\n\n```cpp\n#include <bits/stdc++.h>\n#define LL long long\nusing namespace std;\n\n\nconst int N = 105 , M = 5 , mod = 1e9 + 7;\nint n , key[N] , val[N] , ans[N];\n\nstruct matrix\n{\n\tint x , y;\n\tLL v[M][M];\n\t\n\tmatrix() { memset( v , 0 , sizeof(v) ); }\n\t\n\tinline friend matrix operator *  (matrix a , matrix b )\n\t{\n\t\tregister matrix cur;\n\t\tcur.x = a.x , cur.y = b.y;\n\t\tfor( register int i = 1 ; i <= cur.x ; i ++ )\n\t\t{\n\t\t\tfor( register int j = 1 ; j <= cur.y ; j ++ )\n\t\t\t{\n\t\t\t\tcur.v[i][j] = 0;\n\t\t\t\tfor( register int k = 1 ; k <= a.y ; k ++ ) cur.v[i][j] = ( cur.v[i][j] + a.v[i][k] % mod * b.v[k][j] % mod ) % mod;\n\t\t\t}\n\t\t}\n\t\treturn cur;\n\t}\n} f , res;\n\n\ninline LL read()\n{\n\tregister LL x = 0;\n\tregister char ch = getchar();\n\twhile( ch < '0' || ch > '9' ) ch = getchar();\n\twhile( ch >= '0' && ch <= '9' )\n\t{\n\t\tx = ( x << 3 ) + ( x << 1 ) + ch - '0';\n\t\tch = getchar();\n\t}\n\treturn x;\n}\n\ninline void matrix_I( matrix &t , int k)//\u6784\u9020\u5355\u4f4d\u77e9\u9635\n{\n\tt.x = t.y = k;\n\tfor( register int i = 1 ; i <= k ; i ++ ) t.v[i][i] = 1;\n}\n\ninline matrix matrix_power( matrix x , int k )//\u77e9\u9635\u5feb\u901f\u5e42\n{\n\tif( k == 1 ) return x;\n\tregister matrix t; matrix_I( t , 3 );\n\twhile( k )\n\t{\n\t\tif( k & 1 ) t = t * x ;\n\t\tx = x * x;\n\t\tk >>= 1;\n\t}\n\treturn t;\n}\n\ninline void init()\n{\n\tf.x = f.y = 3;\n\tmemset( f.v , 0 , sizeof( f.v ) );\n\tf.v[1][1] = f.v[1][3] = f.v[2][1] = f.v[3][2] = 1 ;\n}\n\n\nint main()\n{\n\tn = read();\n\tfor( register int i = 1 ; i <= n ; i ++ ) key[i] = val[i] = read();\n\tsort( val + 1 , val + 1 + n ) ;\n\tfor( register int i = 1 ; i <= n ; i ++ ) key[i] = lower_bound( val + 1 , val + 1 + n , key[i] ) - val;\n\tres.x = 3 , res.y = res.v[1][1] = res.v[2][1] = res.v[3][1] = 1;\n\tval[0] = 3;\n\tfor( register int i = 1 ; i <= n ; i ++ )\n\t{\n\t\tif( val[i] <= 3 ) { ans[i] = 1 , val[i] = 3 ; continue; }\n\t\tregister int d = val[i] - val[ i - 1 ];//\u8ba1\u7b97\u5dee\u503c\n\t\tif( d == 0 ) //\u7279\u6b8a\u60c5\u51b5\n\t\t{\n\t\t\tans[i] = ans[ i - 1 ] ;\n\t\t\tcontinue;\n\t\t}\n\t\tinit();//\u521d\u59cb\u5316 \u77e9\u9635f \n\t\tf = matrix_power( f , d );\n\t\tres = f * res;\n\t\tans[i] = res.v[1][1] % mod;\n\t}\n\tfor( register int i = 1 ; i <= n ; i ++ ) printf( \"%d\\n\" , ans[ key[i] ] );\n\treturn 0;\n}\n```\n\n\n\n\n\n# ",
        "postTime": 1570598846,
        "uid": 85348,
        "name": "PHarr",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "\u53d7\u6590\u6ce2\u90a3\u5951\u7684\u5f71\u54cd\uff0c\u672c\u60f3\u5bf9f[i]\u3001f[i-2]\u7ec4\u6210\u7684\u77e9\u9635\u6765\u63a8\uff1a\n\n~~\u7136\u540e\u53d1\u73b0\u4e0d\u4f1a......\u53ef\u80fd\u8fd9\u4e0e\u90a3\u4e2a\u516c\u5f0f\u5f62\u5f0f\u4e0d\u7b26\u5427~~\n\n\u4e8e\u662f\u5728\u4e2d\u95f4\u52a0\u4e86\u4e2af[i-1],\u518d\u4e0ef[i-1]\u3001f[i-2]\u3001f[i-3]\u7ec4\u6210\u7684\u77e9\u9635\u641e\uff0c\u5f97\u51fa\u77e9\u9635\n\n\t1 0 1\n\n\t1 0 0\n\n\t0 1 0\n            \n\u6ee1\u8db3\u6761\u4ef6\uff0c\u4f8b\u5982f[i]=f[i-1]x 1+f[i-2]x 0+f[i-3]x 1\uff0c\u7c7b\u63a8~~\uff08\u4e0d\u8fc7\u600e\u4e48\u662f\u697c\u4e0b\u77e9\u9635\u7684\u65cb\u8f6c\u4f53\uff09~~\n\n\u4e8e\u662f\u5c31\u6709[ f[n]... ] = [\u90a3\u4e2a\u77e9\u9635]^(n-3) * [ f[3]... ]\n\n\u4ee3\u7801\u5982\u4e0b\uff0c\u7528\u4e86\u7ed3\u6784\u4f53\u548c\u91cd\u8f7d\uff1a\n\n```cpp\n#include <iostream>\n#include <cstring>\n#include <cstdio>\nusing namespace std;\ntypedef long long LL;\nconst LL mod=1e9+7;\tLL T,n,f[5]={0,1,1,1,2};\n\nstruct matrix{LL a[5][5];matrix(){memset(a,0,sizeof(a));}}E;\nmatrix operator *(matrix x,matrix y)  //\u91cd\u8f7d\u4e58\u53f7\n{\n    matrix tmp;\n    for(LL i=1;i<=3;i++)\n    for(LL j=1;j<=3;j++)\n    for(LL k=1;k<=3;k++)\n    tmp.a[i][j]=(tmp.a[i][j]+x.a[i][k]*y.a[k][j])%mod;\n    return tmp;\n}\n\nLL qmul(matrix e,matrix ans,LL k) //\u5feb\u901f\u5e42\u51fd\u6570\n{\n    for(;k;k>>=1,e=e*e)if(k&1)ans=ans*e;\n    return(ans.a[1][1]+ans.a[1][2]+ans.a[1][3])%mod;\n}\nint main()\n{\n    E.a[1][1]=E.a[1][3]=E.a[2][1]=E.a[3][2]=1;\n    scanf(\"%lld\",&T);\n    while(T--){scanf(\"%lld\",&n);printf(\"%lld\\n\",(n>4)?qmul(E,E,n-4):f[n]);}\n    //\u521d\u59cb\u77e9\u9635\u5df2\u7ecf\u8d4b\u503c\u4e86\uff0c\u6240\u4ee5\u5c11\u4e58\u4e00\u6b21\uff1an-4\n    return 0;\n}\n```",
        "postTime": 1518336275,
        "uid": 9315,
        "name": "zhyh",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "\u8fd9\u4e00\u7bc7\uff0c\u5176\u5b9e\u5dee\u4e0d\u591a\u7b97\u662f1962\u7684\u52a0\u5f3a\u7248\uff0c\u4f46\u662f\u4e5f\u6ca1\u5565\u96be\u5ea6\n\u77e9\u9635\u4e58\u6cd5\u5982\u4f55\u7528\uff1a\n\n\u6bd4\u5982\u8bf4\uff0c\u6211\u4eec\u6709\u4e00\u4e2a\u77e9\u9635|a b c|\n\n\u90a3\u4e48\uff0c\u8981\u6c42\u4e0b\u4e24\u9879\uff0c\u5c31\u53d8\u6210|b c a+c|\n\n\u6240\u4ee5\uff0c\u8981\u4e58\u7684\u77e9\u9635\u5e94\u8be5\u662f\n\nA=\n\n|0 0 1|\n\n|1 0 0|\n\n|0 1 1|\u8fd9\u6837\u4e00\u4e2a\u4e09\u9636\u77e9\u9635\u3002\uff08\u8bf7\u81ea\u52a8\u8111\u8865\uff09\n\n\u90a3\u4e48\uff0c\u4e58\u7684\u65f6\u5019\u5c31\u53d8\u6210\n\n|a b c|\u00d7A\u00d7A\u00d7A\u00d7A\u00d7A\uff08n\u4e2aA\uff09\n\n\u91cd\u70b9\u51fa\u573a\u4e86\uff0c\u600e\u4e48\u6837\u4f18\u5316\n\n\u8bf7\u6ce8\u610f\uff0c**\u77e9\u9635\u4e58\u6cd5\u6ee1\u8db3\u4e58\u6cd5\u7ed3\u5408\u5f8b**\n\n\u6240\u4ee5\u6211\u4eec\u628a\u540e\u9762\u7684A\u5148\u76f8\u4e58\uff0c\u5c31\u53d8\u6210\u4e86\u5feb\u901f\u5e42\n\n\u5177\u4f53\u89e3\u6cd5\u89c1P3390\u3010\u6a21\u677f\u3011\u77e9\u9635\u5feb\u901f\u5e42\n\n\u4e0d\u591a\u8bf4\uff0c\u89c1\u4ee3\u7801\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nint frog=1e9+7,t;ll n;\nstruct matrix{ll a[4][4];}A,ans;\nvoid multi(matrix &a,matrix b)\n{\n    ll c[4][4]={0};\n    for(int i=1;i<4;i++)for(int j=1;j<4;j++)for(int k=1;k<4;k++)c[i][j]+=a.a[i][k]*b.a[k][j],c[i][j]%=frog;\n    for(int i=1;i<4;i++)for(int j=1;j<4;j++)a.a[i][j]=c[i][j];\n}\ninline void kasumi()\n{\n    for(int i=1;i<4;i++)for(int j=1;j<4;j++)ans.a[i][j]=A.a[i][j];n--;\n    while(n){if(n%2==1)multi(ans,A);multi(A,A);n/=2;}\n}\nint main()\n{\n    scanf(\"%d\",&t);\n    for(int i=1;i<=t;i++)\n    {\n    \tscanf(\"%lld\",&n);\n    \tans.a[1][1]=ans.a[1][2]=ans.a[1][3]=1;\n    \tA.a[1][1]=A.a[1][2]=A.a[2][2]=A.a[2][3]=A.a[3][1]=0,A.a[1][3]=A.a[2][1]=A.a[3][2]=A.a[3][3]=1;\n    \tkasumi();\n    \tprintf(\"%lld\\n\",ans.a[1][3]%frog);\n    }\n}\n/*\na b c\n|0 0 1|\n|1 0 0|\n|0 1 1|\nb c a+c\nc a+c a+b+c\n*/\n//\u8fd9\u91cc\u662f\u77e9\u9635\u4e58\u7684\u63a8\u65ad\u8fc7\u7a0b\n```",
        "postTime": 1517882897,
        "uid": 5880,
        "name": "B_Qu1e7",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1939\u3010 \u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "\u770b\u7740\u4e0b\u9762\u5927\u4f6c\u4eec\u7684\u9898\u89e3\uff0c\u5f88\u591a\u90fd\u662f\u7528\u76844\\*4\u7684\u77e9\u9635\uff0c\u6211\u5c31\u8bf4\u4e00\u79cd3\\*3\u7684\u5427\n\n\u6839\u636e\u9898\u76ee\uff1a\n\na[1]=a[2]=a[3]=1\n\na[x]=a[x-3]+a[x-1] (x>3)\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u4e0b\u9762\u7684\u77e9\u9635a\u548c\u77e9\u9635b\u76f8\u4e58\u5f97\u5230c\n\na:               b:            c:\n\n1  1  1   \\*    0  0  1       2   3  4\n\n1  0  0\n\n0  1  1\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u77e9\u4e58\u4e86\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n#include<cstring>\n#define ll long long\n#define mod 1000000007\nusing namespace std;\nint n,tt;\nstruct matrix{\n    ll m[4][4];\n}a,b,t;\nmatrix mi(matrix a, matrix b){\n    matrix t;//\u77e9\u9635\u4e58\u6cd5\n    for(int i=1;i<=3;++i)\n        for(int j=1;j<=3;++j){\n            t.m[i][j]=0;\n            for(int k=1;k<=3;++k)\n                t.m[i][j]=(t.m[i][j]+a.m[i][k]*b.m[k][j])%mod;\n        }\n    return t;\n}\nmatrix fast_m(matrix a,ll b){//\u77e9\u9635\u5feb\u901f\u5e42\n    matrix s=a,w=a; b--;\n    while(b) {if(b&1) s=mi(w,s);w=mi(w,w);b>>=1;}\n    return s;\n}\nint main(){\n    scanf(\"%d\",&n);\n    b.m[1][1]=1;b.m[1][2]=1;b.m[1][3]=1;\n    for(int i=1;i<=n;++i){\n        scanf(\"%d\",&tt);\n        a.m[1][1]=0;a.m[1][2]=0;a.m[1][3]=1;\n            a.m[2][1]=1;a.m[2][2]=0;a.m[2][3]=0;\n            a.m[3][1]=0;a.m[3][2]=1;a.m[3][3]=1;//\u4ee5\u4e0a\u4e09\u884c\u662f\u8d4b\u521d\u59cb\u503c\n        if(tt==1){ cout<<\"1\\n\";continue;}\n        if(tt==2){ cout<<\"1\\n\";continue;}\n        if(tt==3){ cout<<\"1\\n\";continue;}//tt\u7b49\u4e8e1,2,3\u7684\u60c5\u51b5\u76f4\u63a5\u8f93\u51fa\n        tt-=3;//\u4ece\u7b2c4\u4e2a\u5f00\u59cb\uff0c\u51cf\u53bb3\uff1b\n        a=fast_m(a,tt);//\u5f97\u5230\u77e9\u4e58\u540e\u7684\u4e00\u4e2a\u65b0\u7684\u77e9\u9635\n        for(int i=1;i<=1;++i)//\u518d\u5c06\u8fd9\u4e2a\u77e9\u9635\u4e0e\u4e0a\u8ff0\u6240\u8bf4\u7684a\u77e9\u9635\u76f8\u4e58\uff0c\u5c31\u4f1a\u5f97\u5230\u6700\u540e\u7684c\u77e9\u9635\uff0c\u5728\u4ee3\u7801\u4e2da\u77e9\u9635\u4e3ab\u77e9\u9635\n            for(int j=1;j<=3;++j){\n                t.m[i][j]=0;\n                for(int k=1;k<=3;++k)\n                    t.m[i][j]=(t.m[i][j]+b.m[i][k]*a.m[k][j])%mod;\n            }\n        printf(\"%lld\\n\",t.m[1][3]);//\u56e0\u4e3a\u6211\u4eec\u6bcf\u6b21\u77e9\u4e58\u4e00\u6b21\u53ea\u4f1a\u5f97\u5230\u4e00\u4e2a\u65b0\u7684\u6570\u5b57\uff0c\u5e76\u4e14\u662f\u5904\u4e8e\u4e4b\u524d\u6240\u8bb2\u7684c\u77e9\u9635\u7684\u7b2c\u4e09\u4f4d\uff0c\u6240\u4ee5\u5728\u8fd9\u91cc\u8f93\u51fa\u6700\u540e\u4e00\u4f4d\n    }\n    return 0;\n}\n```",
        "postTime": 1508659707,
        "uid": 17995,
        "name": "\u98ce\u7075\u65e0\u754fYY",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "\n\n\u6211\u4e48\u53ef\u4ee5\u6574\u7406\u51fa\u6765\u8fd9\u6837\u4e00\u4e2a\u5f0f\u5b50\n\n \nF[n] = f[n-2]+f[n-3]+f[n-4] \n\nF[5] = f[1] + f[2] +f[3]\n\nk\u63a81 ,a\u6570\u7ec4\uff08\u7ffb\u500d\u6570\u7ec4\uff09\u5c31\u5f00k\u884ck\u5217,f\u6570\u7ec4\u5c31\u5f00[k]\u884c\n\n\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#define inf 1000000007 \nusing namespace std;\nlong long a[5][5],b[5][5],f[5],c[5];\nlong long n,m,i,j,k,l,T;\n//\u56e0\u4e3a\u662f\u56db\u63a8\u4e00\u6240\u4ee5\u5f00\u56db\u4e2a\u5c31\u884c \n//--------\nvoid kuai();\nint main()\n{\n    scanf(\"%d\",&T);\n    for(i = 1;i <= T; i++)\n    {\n    memset(a,0,sizeof(a));\n    memset(f,0,sizeof(f));\n    scanf(\"%d\",&n);\n    a[1][2] = a[2][3] = a[3][4] = 1;\n    a[4][1] = a[4][2] = a[4][3] = 1;\n    f[1] = f[2] = f[3] = 1;\n    f[4] = 2;    \n    if(n <= 3 )\n      {\n        cout<<1<<endl;\n        continue; \n      } \n        n -= 4; \n      kuai();\n      cout<<f[4]<<endl;\n    }\n    return 0;\n}\nvoid kuai()\n{\n    int i,j,k;\n    while(n > 0)\n    {\n        if(n % 2 == 1)\n        {\n            memset(c,0,sizeof(c));\n            for(i = 1; i <= 4; i++)\n              for(j = 1;j <= 1; j++)\n                for(k = 1;k <= 4; k++)\n                  c[i]  = (c[i] + a[i][k]*f[k])%inf;\n            for(i = 1;i <= 4; i++)\n              f[i] = c[i];          \n        }\n        memset(b,0,sizeof(b));\n        for(i = 1;i <= 4; i++)\n          for(j = 1;j <= 4; j++)\n            for(k = 1;k <= 4; k++)\n                b[i][j] = (b[i][j] + a[i][k]*a[k][j])%inf;\n        for(i = 1;i <= 4; i++)\n          for(j = 1;j <= 4; j++)        \n            a[i][j] = b[i][j];    \n        n /= 2;\n    }\n}\n\n```",
        "postTime": 1508578249,
        "uid": 51524,
        "name": "baolichuqiji",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "# \u524d\u8a00\n\u672c\u7bc7\u9898\u89e3\u662f\u7ee7\u77e9\u9635\u5feb\u901f\u5e42\u4e4b\u540e\u7684\u77e9\u9635\u7684\u7b2c\u4e8c\u7bc7\u9898\u89e3\uff0c\u7b2c\u4e00\u7bc7\u53c2\u770b[\u77e9\u9635\u5feb\u901f\u5e42](https://www.luogu.org/blog/QAQ1246/the-road-from-entry-to-proficiency-of-matrix)\n\n# Tips\n\u672c\u9898\u89e3\u7684\u9605\u8bfb\u524d\u63d0\u662f\u4f60\u9700\u8981\u61c2\u5f97\uff1a\n\n1.\u77e9\u9635\u7684\u57fa\u672c\u77e5\u8bc6\n\n2.\u77e9\u9635\u5feb\u901f\u5e42\n# \u77e9\u9635\u52a0\u901f\n\n\u5176\u5b9e\u8fd9\u4e2a\u4e1c\u897f\u5c31\u662f\u77e9\u9635\u5feb\u901f\u5e42\u7684\u5566\uff01\n\n\u77e9\u9635\u52a0\u901f\u6307\u7684\u662f\u901a\u8fc7\u6784\u5efa\u77e9\u9635\u5c06\u7ebf\u6027\u9012\u63a8\u5f0f\u7684\u8ba1\u7b97\u65f6\u95f4\u590d\u6742\u5ea6\u4ece$O(n)$\u964d\u4f4e\u81f3$O(\\log_2 n)$\n\n\u5148\u6765\u770b\u770b\u4ee5\u4e0b\u7ebf\u6027\u9012\u63a8\u6570\u5217\uff1a\n\n$f(n) =\n\\begin{cases} \n1 & n=1,2,3 \\\\\nf(n-1)+f(n-3) & n>3\n\\end{cases}$\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u7ebf\u6027\u65b9\u7a0b\u7ec4\uff1a\n$\\begin{cases}\nf(n)=f(n-1)+f(n-3) \\\\\nf(n-1)=f(n-1) \\\\\nf(n-2)=f(n-2)\n\\end{cases}$\n\n\u57fa\u4e8e\u8fd9\u4e2a\u7ebf\u6027\u65b9\u7a0b\u7ec4\uff0c\u6211\u4eec\u53ef\u4ee5\u5efa\u7acb\u4e00\u4e2a$1 \\times 3$\u7684\u77e9\u9635\uff08\u5411\u91cf\u7ec4\uff09\n$B=\\left[\\begin{matrix}1\\\\1\\\\1\\\\\\end{matrix}\\right] \\iff B=\\left[\\begin{matrix}f(n)\\\\f(n-1)\\\\f(n-2)\\\\\\end{matrix}\\right]$\n\n\u518d\u5efa\u7acb\u4e00\u4e2a$3 \\times 3$\u7684\u77e9\u9635\n$A=\\left[\\begin{matrix}1 & 0 & 1\\\\1 & 0 & 0\\\\0 & 1 & 0\\\\\\end{matrix}\\right] \\iff \\begin{cases}\nf(n)=f(n-1)+f(n-3) \\\\\nf(n-1)=f(n-1) \\\\\nf(n-2)=f(n-2)\n\\end{cases}$\n\n\u6240\u4ee5\u6709\n\n$f(n) =\n\\begin{cases} \n1 & n=1,2,3 \\\\\nB \\times A^n& n>3\n\\end{cases}$\n\n\u90a3\u4e48\u6211\u4eec\u53d1\u73b0$A^k$\u53ef\u4ee5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u6765\u505a\n\n\u6240\u4ee5\u6709\u4ee3\u7801\u5982\u4e0b\n\n```cpp\n#include<bits/stdc++.h>\n#define Mod 1000000007\nusing namespace std;\nstruct Matrix {\n\tlong long key[10][10];\n};\nMatrix operator *(Matrix &x,Matrix &y) {\n\tMatrix C;\n\tfor(int i=1; i<=3; i++)\n\t\tfor(int j=1; j<=3; j++)\n\t\t\tC.key[i][j]=0;\n\tfor(int i=1; i<=3; i++)\n\t\tfor(int j=1; j<=3; j++)\n\t\t\tfor(int k=1; k<=3; k++)\n\t\t\t\tC.key[i][j]=(C.key[i][j]+x.key[i][k]*y.key[k][j]%Mod)%Mod;\n\treturn C;\n}\nvoid Fastpower(int t) {\n\tMatrix A,I;\n\tfor(int i=1; i<=3; i++)\n\t\tfor(int j=1; j<=3; j++) {\n\t\t\tA.key[i][j]=0;\n\t\t\tI.key[i][j]=0;\n\t\t}\n\tfor(int i=1; i<=3; i++) I.key[i][i]=1;\n\tA.key[1][1]=A.key[1][3]=A.key[2][1]=A.key[3][2]=1;\n\twhile(t) {\n\t\tif(t&1) I=A*I;\n\t\tA=A*A;\n\t\tt=t>>1;\n\t}\n\tcout<<I.key[2][1]<<endl;\n\treturn;\n}\nint T,n;\nint main() {\n\tcin>>T;\n\tfor(int i=1; i<=T; i++) {\n\t\tint k;\n\t\tcin>>k;\n\t\tFastpower(k);\n\t}\n\treturn 0;\n}\n\n```\n\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u56e0\u4e3a\u6b64\u5904$f(1)=f(2)=f(3)=1$\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u9700\u8981\u7528\u8ba1\u7b97\u51fa\u6765\u7684$A^k \\times B$,\u76f4\u63a5\u8f93\u51fa${A^k}_{(21)}$\u5373\u53ef\n\n\n  [1]: https://www.luogu.org/blog/QAQ1246/the-road-from-entry-to-proficiency-of-matrix",
        "postTime": 1568024347,
        "uid": 130376,
        "name": "Maika",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "\n# \u9898\u76ee\n[\u6570\u5217](https://www.luogu.org/problemnew/show/P1939)\n# \u9898\u89e3\n\u9996\u5148\u8bf4\u4e00\u4e0b\u77e9\u9635\u4e58\u6cd5\uff1a\n\n\u5047\u8bbe\u77e9\u9635$A$\u548c\u77e9\u9635$B$\u505a\u4e58\u6cd5\u5f97\u5230\u77e9\u9635$C$\uff0c\u5219\u5fc5\u987b\u6ee1\u8db3\u77e9\u9635$A$\u7684\u5217\u6570\u7b49\u4e8e\u77e9\u9635$B$\u7684\u884c\u6570\n\n\u5373\u5982\u679c\u77e9\u9635$A$\u6709$n$\u884c$m$\u5217\uff0c\u5219\u77e9\u9635$B$\u6709$m$\u884c$p$\u5217\uff0c\u77e9\u9635$C$\u5c31\u6709$n$\u884c$p$\u5217\n\n\u90a3\u4e48\u77e9\u9635\u4e58\u6cd5\u600e\u4e48\u505a\u5462\uff1f\n\u516c\u5f0f\uff1a\n$$C[i][j] = \\sum_{i =1}^{n}\\sum_{j = 1}^{p}\\sum_{k = 1}^{m}A[i][k]*B[k][j]$$\n\u4e00\u53e5\u8bdd\u5c31\u662f$C[i][j]$\u4e3a\u77e9\u9635$A$\u7684\u7b2c$i$\u884c\u548c\u77e9\u9635$B$\u7684\u7b2c$j$\u5217\u5bf9\u4f4d\u76f8\u4e58\u4e4b\u548c\n\n\u6709\u4e86\u8fd9\u4e2a\u90a3\u4e48\u6211\u4eec\u89e3\u9898\u5c31\u65b9\u4fbf\u4e86\u8bb8\u591a\n\n\u6211\u4eec\u5047\u8bbe\u539f\u6765\u7684\u7684\u4e00\u4e2a\u77e9\u9635$A$\u4e3a$\\begin{bmatrix}a[1],a[2],a[3]\\end{bmatrix}$\uff0c\u6211\u4eec\u60f3\u8981\u628a\u8fd9\u4e2a\u77e9\u9635\u53d8\u4e3a$\\begin{bmatrix}a[2],a[3],a[4]\\end{bmatrix}$\uff0c\u6211\u4eec\u5e94\u8be5\u5982\u4f55\u64cd\u4f5c\u5462\uff1f\n\n\u5047\u8bbe\u65b0\u77e9\u9635\u662f\u7531\u77e9\u9635$A$\u4e58\u4e00\u4e2a\u77e9\u9635$P$\u5f97\u5230\uff0c\u90a3\u4e48\u53ef\u4ee5\u786e\u5b9a$P$\u662f\u4e00\u4e2a$3*3$\u7684\u77e9\u9635\n\u4ee4\u77e9\u9635$P$\u4e3a$\\begin{bmatrix}p_{11},p_{12},p_{13}\\\\p_{21},p_{22},p_{23}\\\\p_{31},p_{32},p_{33}\\end{bmatrix}$\n\n\u6839\u636e\u77e9\u9635\u4e58\u6cd5\u7684\u6cd5\u5219\uff0c\u53ef\u4ee5\u5f97\u5230\u65b0\u77e9\u9635\u4e3a\n$\\begin{bmatrix}a[1]*p_{11}+a[2]*p_{21}+a[3]*p_{31},a[1]*p_{12}+a[2]*p_{22}+a[3]*p_{32},a[1]*p_{13}+a[2]*p_{23}+a[3]*p_{33}\\end{bmatrix}$\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u65b9\u7a0b\uff1a$\\begin{cases}a[1]*p_{11}+a[2]*p_{21}+a[3]*p_{31}=a[2]\\\\a[1]*p_{12}+a[2]*p_{22}+a[3]*p_{32}=a[3]\\\\a[1]*p_{13}+a[2]*p_{23}+a[3]*p_{33}=a[4]\\end{cases}$\n$\\because a[i]=a[i-1]+a[i-3]$\n$\\therefore p_{21}=1,p_{32}=1,p_{13}=p_{33}=1$\uff0c\u5176\u5b83\u7684\u6570\u90fd\u4e3a0\n\n\u53ef\u4ee5\u770b\u51fa\u6211\u4eec\u4e58\u4e00\u6b21\u5c31\u53ef\u4ee5\u5f97\u5230$a[4]$\uff0c\u5f97\u5230$a[n]$\u5c31\u9700\u8981\u4e58$n-3$\u6b21\uff0c\u7528\u4e00\u4e2a\u77e9\u9635\u5feb\u901f\u5e42\u5373\u53ef\u6c42\u89e3\n# \u4ee3\u7801\n```cpp\n#include <cstdio>\n#include <cstring>\n#define reg register\n\ntemplate <class T>\ninline T read() {\n    T x = 0; T f = 1; char s = getchar();\n    while(s < '0' || s > '9') {if(s == '-') f = -1; s = getchar();}\n    while(s >= '0' && s <= '9') {x = (x << 3) + (x << 1) + s - 48; s = getchar();}\n    return x * f;\n}\n\ntemplate <typename T>\ninline void wri(T x) {\n    if(x < 0) {x = -x; putchar('-');}\n    if(x / 10) wri(x / 10);\n    putchar(x % 10 + 48);\n}\n\ntemplate <typename T>\ninline void write(T x, char s) {\n    wri(x);\n    putchar(s);\n}\n\n#define LL long long\n\nconst LL mod = 1e9 + 7;\n\nint T;\nLL N;\n\nstruct matrix {\n    int n, m;\n    LL a[5][5];\n    inline void cl() {\n        n = m = 0;\n        memset(a, 0, sizeof a);\n    }\n    inline matrix operator * (const matrix & rhs) const {\n        matrix ans;\n        ans.cl();\n        ans.n = n, ans.m = rhs.m;\n        for(reg int i = 1;i <= n;i ++)\n            for(reg int j = 1;j <= rhs.m;j ++)\n                for(reg int k = 1;k <= m;k ++)\n                    ans.a[i][j] = (ans.a[i][j] + (a[i][k] * rhs.a[k][j]) % mod) % mod;\n        return ans;\n    }\n}A, p;\n\ninline matrix qkpow(matrix x, LL y) {\n    matrix ans;\n    ans.cl();\n    ans.n = x.n, ans.m = x.m;\n    for(reg int i = 1;i <= ans.n;i ++)\n        ans.a[i][i] = 1;\n    while(y) {\n        if(y & 1)\n            ans = ans * x;\n        x = x * x;\n        y >>= 1;\n    }\n    return ans;\n}\n\nint main() {\n    T = read<int>();\n    p.n = 3, p.m = 3, p.a[1][3] = p.a[2][1] = p.a[3][2] = p.a[3][3] = 1;\n    while(T --) {\n        A.cl();\n        A.n = 1, A.m = 3, A.a[1][1] = A.a[1][2] = A.a[1][3] = 1;\n        N = read<LL>();\n        if(N < 3) {\n            write(1, '\\n');\n            continue;\n        }\n        A = A * (qkpow(p, N - 3));\n        write(A.a[1][3], '\\n');\n    }\n    return 0;\n}\n```",
        "postTime": 1563964381,
        "uid": 105150,
        "name": "PI_AC",
        "ccfLevel": 0,
        "title": "[\u77e9\u9635\u52a0\u901f] \u6570\u5217"
    },
    {
        "content": "\u8fd9\u9053\u9898\u662f\u4e00\u9053\u975e\u5e38\u7b80\u5355\u7684\u77e9\u9635\u52a0\u901f\u9898\uff0c\u53ef\u4ee5\u7528\u6765\u7ec3\u7ec3\u624b\n\n\u6ce8\uff1aLGOJ\u4e0a\u7684Markdown\u4e0d\u80fd\u63d2\u5165\u516c\u5f0f\uff0c\u6700\u597d\u5728\u4f5c\u8005\u7684[\u539f\u6587](https://blog.csdn.net/qq_43890190/article/details/89146448)\u4e0a\u770b\n\n\u6211\u4eec\u53ef\u4ee5\u5f88\u8f7b\u677e\u7684\u60f3\u5230\u539f\u6570\u7ec4\uff1aA=[a1 a2 a3]\n\n\u4e5f\u5c31\u662f[ai ai+1 ai+2]\n\n\u90a3\u4e48\u6211\u4eec\u8981\u6784\u9020\u4e00\u4e2a\u7684\u52a0\u901f\u77e9\u9635\n\n\u9996\u5148\uff0cai\u76f4\u63a5\u53ef\u4ee5\u53d8\u6210ai+1\n\n\u6240\u4ee5\u52a0\u901f\u77e9\u9635\u7684\u7b2c\u4e00\u5217\u5c31\u662f[0 1 0]\n\n\u7136\u540e\uff0cai+1\u4e5f\u53ef\u4ee5\u76f4\u63a5\u7531\u539f\u6570\u7ec4\u5f97\u5230ai+2\n\n\u6240\u4ee5\u52a0\u901f\u77e9\u9635\u7684\u7b2c\u4e8c\u5217\u5c31\u662f[0 0 1]\n\n\u6700\u540e\uff0cai+2\u53d8\u5230ai+3\u9700\u8981\u4ed6\u672c\u8eab\u518d\u52a0\u4e0aai\n\n\u6240\u4ee5\u6700\u540e\u4e00\u5217\u5c31\u662f[1 0 1]\n\n\u7efc\u4e0a\uff1a\uff1a\n\nA=[a1 a2 a3]\n\n      |0 0 1|\n    B=|1 0 0|\n      |0 1 1|\n\n\n\u8fd9\u5c31\u662f\u8fd9\u9053\u9898\u7684\u57fa\u672c\u7ed3\u6784\n\n\u8fd8\u8981\u6ce8\u610f\u51e0\u4e2a\u7ec6\u8282\n\n- \u65e0\u9650\u8f93\u5165\n- \u6362\u884c\n- \u4e58n-1\u6b21\n\n\u81ea\u6b64\u6211\u4eec\u53ef\u4ee5\u7ed9\u51fa\u4ee3\u7801\uff1a\uff1a\n```\n#include<cstdio>\n#include<cstring>\ninline void read(long long &x) {\n    x=0;\n    long long f=1;\n    char s=getchar();\n    while(s<'0'||s>'9') {\n        if(s=='-')\n            f=-1;\n        s=getchar();\n    }\n    while(s>='0'&&s<='9') {\n        x=x*10+s-48;\n        s=getchar();\n    }\n    x*=f;\n}\ninline void pr(long long x) {\n    if(x<0) {\n        putchar('-');\n        x=-x;\n    }\n    if(x>9)\n        pr(x/10);\n    putchar(x%10+48);\n}//\u5feb\u8bfb\u5feb\u8f93\u4e0d\u89e3\u91ca\nlong long A[3][3]= {{0,0,1},{1,0,0},{0,1,1}},n,m,ans[3]= {1,1,1},s[3];//\u6784\u5efa\u52a0\u901f\u77e9\u9635\u3001\u521d\u59cb\u77e9\u9635\u3001\u7b54\u6848\u77e9\u9635\ninline void cheng(long long a[3][3],long long b[3][3]) {//\u77e9\u9635\u4e58\u6cd5\u8fd0\u7b97\n    long long c[3][3];\n    memset(c,0,sizeof(c));//\u521d\u59cb\u5316\n    for(long long i=0; i<3; i++)\n        for(long long j=0; j<3; j++)\n            for(long long k=0; k<3; k++)\n                c[i][j]=(c[i][j]+a[i][k]%m*b[k][j]%m)%m;//\u77e9\u9635\u4e58\u6cd5\n    memcpy(a,c,sizeof(c));//\u4f20\u7b54\u6848\n}\ninline void ksm(long long a[3][3],long long k) {//\u6a21\u62df\u5feb\u901f\u5e42\n    if(k==1) {//\u53ea\u6709\u4e00\u6b21\n        memcpy(a,A,sizeof(A));//\u76f4\u63a5\u4f20\n        return;\n    }\n    long long c[3][3];\n    ksm(c,k/2);//\u9664\u4ee5\u4e8c\n    cheng(c,c);//\u5e73\u65b9\n    if(k&1)//k\u4e3a\u5947\u6570\n        cheng(c,A);\n    memcpy(a,c,sizeof(c));//\u4f20\u7b54\u6848\n}\nlong long T;\nint main() {\n    read(T);\n    m=1000000007;\n    while(T--) {\n        read(n);\n        if(n==1||n==2)//\u7279\u6b8a\u5224\u65ad\n            putchar(49),putchar('\\n');//\u6ce8\u610f\u6362\u884c\n        else {\n            ksm(A,n-1);//\u52a0\u901f\n            for(long long j=0; j<3; j++)\n                for(long long k=0; k<3; k++)\n                    s[j]=(s[j]+ans[k]%m*A[k][j]%m)%m;//\u6700\u540e\u8fd8\u8981\u518d\u4e58\u4e00\u6b21\n            pr(s[0]),putchar('\\n');\n        }\n        A[0][0]=A[0][1]=A[1][1]=A[1][2]=A[2][0]=s[0]=s[1]=s[2]=0;\n        A[0][2]=A[1][0]=A[2][1]=A[2][2]=ans[1]=ans[2]=ans[3]=1;//\u65e0\u9650\u8f93\u5165\u6ce8\u610f\u6e05\u96f6\n    }\n}\n```\n\u8fd9\u5c31\u662f\u8fd9\u9053\u9898\u7684\u5168\u90e8\u4ee3\u7801\n\n\u6709\u9519\u8bef\u7684\u6b22\u8fce\u6307\u51fa\n\n[\u4f5c\u8005\u539f\u6587\u5728\u8fd9\u91cc\u54df](https://blog.csdn.net/qq_43890190/article/details/89146448 )",
        "postTime": 1554873350,
        "uid": 104822,
        "name": "\u4e0d\u601d\u8fdb\u53d6\u601d\u4f60",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "\u867d\u7136\u662f\u77e9\u9635\u52a0\u901f\u7684\u677f\u5b50\u9898\uff0c\u4f46\u662f\u4f5c\u4e3a\u673a\u623f\u849f\u84bb\u82b1\u4e86\u633a\u957f\u65f6\u95f4\uff1b \n\u770b\u4e86\u5404\u4f4d\u5927\u4f6c\u4eec\u597d\u60f3\u8ddf\u6211\u7684\u601d\u8def\u4e0d\u592a\u4e00\u6837\uff0c\u800c\u4e14\u51e0\u4e4e\u5168\u662f\u7ed3\u6784\u4f53\uff0c\u5c31\u60f3\u5199\u7bc7\u9898\u89e3~~\u4e3a\u6211\u4eec\u849f\u84bb\u4eec\u91cf\u8eab\u5b9a\u5236\u7684\u975e\u7ed3\u6784\u4f53~~\uff1b\n\u4e0d\u8bf4\u5e9f\u8bdd\u4e86\uff1b\u9996\u5148\u9700\u8981\u5199\u51fa\u521d\u59cb\u77e9\u9635\uff0c\u77e9\u9635\u7684\u6a2a\u7ad6\u5168\u90e8\u6839\u636e\u4e2a\u4eba\u7684\u559c\u597d\uff0c\u6211\u89c9\u5f97\u6a2a\u7740\u5199\u6bd4\u8f83\u5408\u9002\uff1b   \n\u56e0\u4e3a\u8fd9\u9053 \u9898\u7684f[n]=f[n-1]+f[n-3]\u5f88\u5bb9\u6613\u60f3\u5230\u521d\u59cb\u77e9\u9635\u9700\u8981\u7528\u4e09\u4e2a\u6570\uff0cf[n],f[n-1],f[n-2]\u5b83\u4e4b\u524d\u7684\u77e9\u9635\u662ff[n-1],f[n-2],f[n-3];\u7136\u540e\u5c31\u9700\u8981\u53d1\u6325\u51d1\u6570\u80fd\u529b\u4e86\uff0c\u8fd9\u91cc\u4e0d\u518d\u591a\u8bf4\u4e86\uff0c\u8f6c\u79fb\u77e9\u9635\u5c31\u662f\n1 1 0        \n0 0 1  \n1 0 0      \n\u7136\u540e\u77e9\u9635\u5feb\u901f\u5e42\u6700\u540e\u7684\u7b54\u6848\u662f\u8f6c\u79fb\u77e9\u9635\u7684n-4\u6b21\u65b9\u5f97\u5230\u7684\u77e9\u9635\u7684\u7b2c\u4e00\u5217\u7684\u6570\u7684\u548c  \n\u4ee3\u7801\u5982\u4e0b\uff1a\n```\n#include<iostream>\n#include<cstdio>\n#define lint long long \nusing namespace std;\nconst int mod=1e9+7; \nlint t,n,tmp[4][4],x; \nlint ans[4][4],f[4][4];\nvoid tc()\n{\n\tfor(lint i=1;i<=3;i++)\n\t for(lint j=1;j<=3;j++)\n\t   tmp[i][j]=ans[i][j],ans[i][j]=0;   \n\tfor(lint i=1;i<=3;i++)\n\t for(lint j=1;j<=3;j++) \n\t  for(lint k=1;k<=3;k++)\n\t  ans[i][j]=(ans[i][j]+f[i][k]*tmp[k][j])%mod;\n}\nvoid zc()\n{\n\tfor(lint i=1;i<=3;i++)\n\t for(lint j=1;j<=3;j++)\n\t  tmp[i][j]=f[i][j],f[i][j]=0;\n\tfor(lint i=1;i<=3;i++)\n\t for(lint j=1;j<=3;j++)\n\t  for(lint k=1;k<=3;k++)\n\t  f[i][j]=(f[i][j]+tmp[i][k]*tmp[k][j])%mod;\n}\nlint kuai(lint y)\n{\n\tans[1][1]=f[1][1]=1,ans[1][2]=f[1][2]=1,ans[1][3]=f[1][3]=0;\n\tans[2][1]=f[2][1]=0,ans[2][2]=f[2][2]=0,ans[2][3]=f[2][3]=1;\n\tans[3][1]=f[3][1]=1,ans[3][2]=f[3][2]=0,ans[3][3]=f[3][3]=0;\n\twhile(y)\n\t{\n\t\tif(y&1) tc();//\u7c7b\u4f3c\u5feb\u901f\u5e42\u7684res=res*a\uff0c\u5bf9\u7b54\u6848\u77e9\u9635\u8fdb\u884c\u4e58\u6cd5\uff1b\n\t\tzc(); //\u7c7b\u4f3c\u5feb\u901f\u5e42\u7684a=a*a,\u6bcf\u6b21a\u505a\u81ea\u4e58\uff1b\n\t\ty>>=1;\n\t}\n\tlint a=(ans[1][1]+ans[2][1]+ans[3][1])%mod;\n\treturn a;\n}\nint main()\n{\n\tscanf(\"%d\",&t);\n\tfor(lint i=1;i<=t;i++)\n\t{\n\t\tscanf(\"%lld\",&x);\n\t\tif(x<=3) printf(\"1\\n\");\n\t\telse cout<<kuai(x-4)<<endl;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1540124014,
        "uid": 92086,
        "name": "wpgwhpg",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "\tF(n) = F(n - 1) + F(n - 3)\n    \u5f53 n \u6781\u5927\u65f6\uff0c\u4f20\u7edf\u7684\u9012\u63a8\u80af\u5b9a\u4e0d\u80fd\u5728\u89c4\u5b9a\u65f6\u95f4\u91cc\u5b8c\u6210\u3002\u6211\u4eec\u8003\u8651\u5229\u7528\u77e9\u9635\u4e58\u6cd5\u3002\n    \u9996\u5148\u8003\u8651\u7ed3\u679c\u4e2d\u7684\u77e9\u9635\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230F(n)\u7684\u7b54\u6848\u3002\n    \u7b2c\u4e8c\u6b65\u6211\u4eec\u53bb\u8003\u8651\u542b\u6709\u53d8\u91cf\u7684\u77e9\u9635\uff0c\u65e2\u7136\u6211\u9700\u8981\u7684\u5230F(n)\uff0c\u6b64\u65f6\u5c31\u9700\u8981\u5305\u542bF(n - 1)\uff0cF(n - 3)\u3002\n    \u5bf9\u5e94\u7684\u6211\u4eec\u5728\u7ed3\u679c\u4e2d\u4e5f\u8981\u6709\u5bf9\u5e94\u7684F(n - 2)\uff0c\u8fd9\u662f\u6ca1\u6709\u51fa\u73b0\u5728\u7ed3\u679c\u77e9\u9635\u548c\u8f6c\u79fb\u77e9\u9635\u7684\u53d8\u91cf\uff0c\u4e3a\u4e86\u65b9\u4fbf\u8f6c\u79fb\uff0c\u6211\u4eec\u4e5f\u628aF(n - 2)\u653e\u5728\u8f6c\u79fb\u77e9\u9635\u3002\u8fd9\u662f\u7ed3\u679c\u77e9\u9635\u9700\u8981F(n - 1)\u3002\n    ![](https://cdn.luogu.com.cn/upload/pic/27547.png)\n    \u6211\u4eec\u6765\u8003\u8651\u5de6\u8fb9\u7684\u77e9\u9635\u5e94\u8be5\u586b\u4ec0\u4e48\u3002\n    \u5de6\u8fb9\u7b2c\u4e00\u884c * \u53f3\u8fb9\u7684\u7b2c\u4e00\u5217 = \u7ed3\u679c\u7b2c\u4e00\u884c\u7b2c\u4e00\u5217\uff0c\u7b2c\u4e00\u4e2a\u5143\u7d20\uff0c\u7b2c\u4e09\u4e2a\u5143\u7d20\u9700\u8981\u5229\u7528\uff0c\u5373\u4e3a1\u3002\n    \u5de6\u8fb9\u7b2c\u4e8c\u884c * \u53f3\u8fb9\u7684\u7b2c\u4e00\u5217 = \u7ed3\u679c\u7b2c\u4e8c\u884c\u7b2c\u4e00\u5217\uff0c\u53ea\u6709\u7b2c\u4e00\u4e2a\u5143\u7d20\u9700\u8981\u5229\u7528\uff0c\u5373\u4e3a1\u3002\n    \u5de6\u8fb9\u7b2c\u4e09\u884c * \u53f3\u8fb9\u7684\u7b2c\u4e00\u5217 = \u7ed3\u679c\u7b2c\u4e09\u884c\u7b2c\u4e00\u5217\uff0c\u53ea\u6709\u7b2c\u4e8c\u4e2a\u5143\u7d20\u9700\u8981\u5229\u7528\uff0c\u5373\u4e3a1.\n    \u6211\u4eec\u5f97\u5230\u4e86\u5168\u90e8\u7684\u77e9\u9635\u3002\u73b0\u5728\u8003\u8651\u6211\u4eec\u9700\u8981\u4e58\u4e0a\u51e0\u4e2a\u5de6\u8fb9\u7684\u77e9\u9635\u3002\u73b0\u5728\u6211\u4eec\u77e5\u9053F(1)\uff0cF(2)\uff0cF(3)\uff1b\n    \u63a8F(4)\u6211\u4eec\u9700\u8981\u4e58\u4e0a1\u6b21\uff0c\u90a3\u4e48\u6613\u5f97\u63a8F(n)\u6211\u4eec\u53ea\u8981\u4e58\u4e0an-3\u6b21\u3002\n    ```\n\t#include<cstdio>\n\t#include<cstring>\n\tconst int mod = 1000000007;\n\tusing namespace std;\n\tstruct Matrix{\n   \t long long  ans[3][3];\n\t}res;\n\tint T, n;\n\tMatrix Mul(Matrix a, Matrix b){\n    \tMatrix c;\n    \tmemset(c.ans, 0, sizeof(c.ans));\n   \t\tfor (int i = 0; i < 3; ++i)\n   \t \tfor (int j = 0; j < 3; ++j)\n    \tfor (int k = 0; k < 3; ++k) \n    \tc.ans[i][j] = (c.ans[i][j] + a.ans[i][k] * b.ans[k][j] % mod) % mod;\n    \treturn c;\n\t}\n\tMatrix Pow(Matrix a, int n){\n    \tmemset(res.ans, 0, sizeof(res.ans));\n    \tres.ans[0][0] = res.ans[1][1] = res.ans[2][2] = 1;\n    \twhile (n) {\n        \tif (n & 1) res = Mul(a, res);\n        \ta = Mul(a, a);\n        \tn >>= 1;\n    \t}\n    \treturn res;\n\t}\n\tint main(){\n    \tscanf(\"%d\",&T);\n    \twhile (T--) {\n        \tscanf(\"%d\",&n);\n        \tif (n <= 3) puts(\"1\");\n        \telse {\n            \tMatrix p;\n            \tmemset(p.ans, 0, sizeof(p.ans));\n            \tp.ans[0][0] = p.ans[0][2] = p.ans[1][0] = p.ans[2][1] = 1;\n            \tp = Pow(p, n - 3);\n            \tMatrix p1;\n            \tp1.ans[0][0] = p1.ans[1][0] = p1.ans[2][0] = 1;\n            \tp = Mul(p, p1);\n            \tprintf(\"%lld\\n\",p.ans[0][0]);\n        \t}\n    \t}\n\t}\n```",
        "postTime": 1533804529,
        "uid": 16568,
        "name": "Yohe",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "\u5176\u5b9e\u53ea\u8981\u6784\u5efa\u4e86\u4e00\u4e2a\u6b63\u786e\u7684\u9012\u63a8\u77e9\u9635\uff0c\u5c31\u4e0d\u7528\u7279\u5224n<=3\u7684\u60c5\u51b5\u4e86\u3002\n\n\u6211\u4eec\u90fd\u77e5\u9053:\n\u5f53\u6211\u4eec\u5df2\u7ecf\u77e5\u9053a1 a2 a3\u65f6\uff0c\u5c31\u6709a4=a1+a3\u3002\n\u5bf9\u4e8e\u539f\u77e9\u9635\u662f\n\n1 1 1\n\n\u7684\u60c5\u51b5\n\n\u9012\u63a8\u77e9\u9635\u5c31\u662f\uff1a\n\n0 0 1\n\n1 0 0\n\n0 1 1\n\n\n\n\u5728\u6211\u4eec\u65f6\u95f4\u4e0d\u7d27\u5f20\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5176\u5b9e\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e00\u9053\u9898\u76ee\u6765\u5f3a\u5316\u57fa\u7840\u4ee3\u7801\u7684\u80fd\u529b\uff0c\u6bd4\u5982\u901a\u8fc7\u5f3a\u5236\u8f6c\u6362\u5bf9\u8c61\u683c\u5f0f\u6765\u5b9a\u4e49\u77e9\u9635\uff0c\u4ee5\u53ca\u91cd\u8f7d\u8fd0\u7b97\u7b26\u7b49\uff0c\u8fd9\u6b63\u662f\u8fd9\u4efd\u9898\u89e3\u60f3\u4f53\u73b0\u7684\u3002\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int MOD=1000000007;\nint T,n; \nstruct matrix{\n\tint n,m;//n\u884cm\u5217 \n\tint a[3][3];\n\tvoid clear(){memset(a,0,sizeof(a));}\n};\n\nmatrix operator * (const matrix &a,const matrix &b){\n\tmatrix res; res.clear();\n\tres.n=a.n,res.m=b.m;\n\tfor(int i=0;i<res.n;++i)\n\t\tfor(int j=0;j<res.m;++j)\n\t\t\tfor(int k=0;k<res.m;++k)\n\t\t\t\tres.a[i][j]=((long long)res.a[i][j]+(long long)a.a[i][k]*b.a[k][j])%MOD;\n\treturn res;\n}\n\nmatrix quick_pow(matrix const &C,matrix const &A,int q){\n\tmatrix a=A,c=C;\n\tfor(;q;q>>=1){\n\t\tif(q&1) c=c*a;\n\t\ta=a*a;\n\t}\n\treturn c;\n}\n\n\n\nint main(){\n\tmatrix Ori=(matrix){1,3,{1,1,1}};\n\tmatrix Upd=(matrix){3,3,{{0,0,1},{1,0,0},{0,1,1}}};\n\tcin>>T;\n\twhile(T--){\n\t\tcin>>n;\n\t\tcout<<quick_pow(Ori,Upd,n-1).a[0][0]<<endl;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1528710106,
        "uid": 38283,
        "name": "Dog_Two",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "[\u9898\u76ee](https://www.luogu.org/problemnew/show/P1939)\n\n\u9707\u60ca\uff01\u67d0\u849f\u84bb\u7206\u96f6\u8fd1 $10$ \u6b21\u7684\u539f\u56e0\u7adf\u7136\u662f......\n\n\u6ea2\u51fa/\u55b7\u8840\n\n-----------\n\n**\u3010\u5206\u6790\u3011**\n------------\n\n\u5bf9\u4e8e $t$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee $x$ \uff0c\u6bcf\u6b21\u90fd\u76f4\u63a5\u8f93\u51fa\u7b54\u6848 $a_x$ \u5373\u53ef\n\n\u8003\u8651\u5230 $x$ \u7684\u8303\u56f4\uff0c $2\\times 10^9$ \u4ee5\u4e0b\uff0c\u4e0d\u8003\u8651\u91c7\u7528\u6570\u7ec4\u5b58\uff08\u5b58\u4e0d\u4e0b\uff09\n\n\u56e0\u6b64\u53ef\u4ee5\u76f4\u63a5 pass \u4e00\u4e2a\u4e00\u4e2a\u7684\u90a3\u79cd\u9012\u63a8\uff0c\u5982\u679c\u4e00\u4e2a\u4e00\u4e2a\u63a8\uff0c\u7edd\u5bf9\u4f1a\u8d85\u65f6\n\n\u90a3\u4e48\u8003\u8651\u5230 $x$ \u662f\u4e71\u5e8f\u7684\uff0c\u800c\u4e14\u5c31\u7b97 $x$ \u6709\u5e8f\uff0c\u524d\u4e00\u6b21\u7684\u7b54\u6848\u4e5f\u4e0d\u65b9\u4fbf\u63a8\u51fa\u540e\u4e00\u6b21\u7684\u7b54\u6848\uff0c\u56e0\u6b64\u4e0d\u8003\u8651\u5148\u5168\u90e8\u8bfb\u5165\uff0c\u6392\u5e8f\u540e\u518d\u7edf\u4e00\u8ba1\u7b97\u7684\u65b9\u6cd5\n\n\u9996\u5148\uff0c\u6839\u636e\u9898\u610f\uff1a\n\n$ a_{n+3}=a_{n+2}+a_{n} $\n\n$ a_{n+2}=a_{n+2} $\n\n$ a_{n+1}=a_{n+1} $\n\n\n\u4e5f\u5c31\u662f\uff1a\n\n$ a_{n+3}=  1\u00d7a_{n+2}  +0\u00d7a_{n+1}  +1\u00d7a_n $\n\n$ a_{n+2}=  1\u00d7a_{n+2}  +0\u00d7a_{n+1}  +0\u00d7a_n $\n\n$ a_{n+1}=  0\u00d7a_{n+2}  +1\u00d7a_{n+1}  +0\u00d7a_n $\n\n\u8fd9\u91cc\u6709\u4e00\u4e2a\u6bd4\u8f83\u660e\u663e\u7684\u77e9\u9635\u5173\u7cfb\uff1a\n\n$\\left[\\begin{matrix}\\ a_{n+3}\\ \\\\ \\\\a_{n+2}\\\\ \\\\a_{n+1}\\end{matrix}\\right]=\\left[\\begin{matrix}\\ 1&0&1\\ \\\\ \\\\1&0&0\\\\ \\\\0&1&0\\end{matrix}\\right]\\times\\left[\\begin{matrix}\\ a_{n+2}\\ \\\\ \\\\a_{n+1}\\\\ \\\\a_n\\end{matrix}\\right]$\n\n\u90a3\u4e48\uff0c\u5bf9\u4e8e\u6240\u6c42\u7684 $a_x$ ,\u53ef\u4ee5\u77e5\u9053 $a_x$ \u662f $(x-1)$ \u4e2a\u4e2d\u95f4\u7684\u90a3\u4e2a\u77e9\u9635\u4e0e\u53f3\u8fb9\u7684\u77e9\u9635\u76f8\u4e58\u540e\uff0c\u53d6\u6700\u540e\u4e00\u884c\u7684\u7b2c\u4e00\u4e2a\u503c\u800c\u5f97\n\n\u53c8\u56e0\u4e3a:\n\n$\\left[\\begin{matrix}\\ a_3\\ \\\\ \\\\a_2\\\\ \\\\a_1\\end{matrix}\\right]=\\left[\\begin{matrix}\\ 1\\ \\\\ \\\\1\\\\ \\\\1\\end{matrix}\\right]$\n\n\u6545\u6b64\u53ef\u4ee5\u5bf9\u8f93\u5165\u7684 $x$ \u5148\u51cf\u53bb $1$ \uff0c\u800c\u540e\u7528 $(x-1)$ \u8fdb\u884c\u77e9\u9635\u7684\u5feb\u901f\u5e42\u8fd0\u7b97(\u77e9\u9635\u52a0\u901f)\uff0c\u518d\u5b9a\u4e49\u4e00\u4e2a\u77e9\u9635\u4e3a\n\n$\\left[\\begin{matrix}\\ 1&0&0\\ \\\\ \\\\1&0&0\\\\ \\\\1&0&0\\end{matrix}\\right]$\n\n\u5c06\u5feb\u901f\u5e42\u7684\u503c\u4e0e\u4e4b\u76f8\u4e58\uff0c\u7b2c\u4e09\u884c\u7b2c\u4e00\u9879\u5c31\u662f\u7ed3\u679c\n\n\u5feb\u901f\u5e42\u5c31\u63a8\u8350\u7528\u8fd9\u79cd\u6253\u6cd5:\n\n```cpp\nint ans(int n){\n\n//exp[i]\u8868\u793a\u4e2d\u95f4\u90a3\u4e2a\u77e9\u9635\u7684i\u6b21\u65b9\n//vec\u4e3a\u6700\u540e\u9762\u90a3\u4e2a\u77e9\u9635\n\n\tmat a=exp[0];\n\tfor(int i=0;n>0;i++,n>>=1)\n\t\tif(n&1) a=a*exp[i+1];\n\ta=a*vec;\n\treturn a.num[2][0];\n\t\n//\u4e58\u6cd5\u7528\u91cd\u8f7d\u8fd0\u7b97\u7b26\u5199\n}\n```\n\n-------------------\n\n**\u3010\u4ee3\u7801\u3011**\n-------------\n\u90a3\u672c\u849f\u84bb\u5c31\u653e\u4ee3\u7801\u4e86:\n\n```cpp\n#include<cstdio>\nusing namespace std;\n#define isdigit(c) ((c>='0')&(c<='9'))\ninline int read(){\n\tint ans=0;char c=getchar();while(!isdigit(c)) c=getchar();\n\twhile(isdigit(c)) ans=ans*10+c-'0',c=getchar();\n\treturn ans;\n}//\u6761\u4ef6\u53cd\u5c04\u7684\u8bfb\u5165\u4f18\u5316\nstruct mat{\n\tlong long int num[3][3];//\u4e0d\u8fd9\u4e48\u6253\u5f88\u5bb9\u6613\u6ea2\u51fa\n\tmat() { for(int i=0;i<9;i++) num[i/3][i%3]=0; }\n\tmat operator * (const mat &x){\n\t\tmat y;\n\t\tfor(int i=0;i<3;i++)\n\t\t\tfor(int j=0;j<3;j++)\n\t\t\t\tfor(int k=0;k<3;k++)\n\t\t\t\t\ty.num[i][j]=(y.num[i][j]+(num[i][k]%1000000007)*(x.num[k][j]%1000000007)%1000000007)%1000000007;//\u66b4\u529b\u819c\n\t\treturn y;\n\t}\n}exp[32],vec;\nvoid pre(){\n\tvec.num[0][0]=vec.num[1][0]=vec.num[2][0]=1;\n\texp[0].num[0][0]=exp[0].num[1][1]=exp[0].num[2][2]=1;\n\texp[1].num[0][0]=exp[1].num[0][2]=exp[1].num[1][0]=exp[1].num[2][1]=1;\n\tfor(int i=2;i<32;i++) exp[i]=exp[i-1]*exp[i-1];\n}//\u9884\u5904\u7406exp\u548cvec\uff0cexp\u53ea\u8981\u523031\u6b21\u65b9\u5c31\u591f\u4e86(2\u00d710^9 < 2^32)\nint ans(int n){\n\tmat a=exp[0];\n\tfor(int i=0;n>0;i++,n>>=1)\n\t\tif(n&1) a=a*exp[i+1];\n\ta=a*vec;\n\treturn a.num[2][0];\n}\nint main(){\n\tpre();//\u5148\u76ae(pre)\u4e00\u4e0b2333\n\tint t=read();\n\twhile(t--) printf(\"%d\\n\",ans(read()-1));\n\treturn 0;\n}\n```\n\n\u6700\u540e\u5b89\u5229\u4e00\u4e0b [\u672c\u849f\u84bb\u7684\u535a\u5ba2](https://www.luogu.org/blog/JustinRochester/#)",
        "postTime": 1528278131,
        "uid": 36031,
        "name": "JustinRochester",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "# talk is cheep show me the code \n\n\u672c\u9898\u524d\u7f6e\u6280\u80fd\uff1a\u77e9\u9635\u5feb\u901f\u5e42\u6a21\u677f\uff0c\u77e5\u9053\u5982\u4f55\u628a\u4e00\u6b21\uff08\u4e00\u9636?\u6211\u6ca1\u5b66\u8fc7\u6570\u5b66\u62b1\u6b49\uff09\u7684\u9012\u63a8\u5f0f\u7528\u77e9\u9635\u4e58\u6cd5\u8868\u793a\u3002\n\n\u8fd9\u91cc\u63a8\u8350\u4e00\u6ce2\u67d0dalao\u7684blog:[\u77e9\u9635\u6784\u9020\u65b9\u6cd5](http://www.cnblogs.com/frog112111/archive/2013/05/19/3087648.html)\n\u6a21\u677f\u7684\u8bdd,\u968f\u4fbf\u627e\u4e00\u4efd\u770b\u4e00\u6ce2\uff0c\u80fd\u6309\u7167\u81ea\u5df1\u7684\u7406\u89e3\u5199\u51fa\u6765\u5c31\u597d\u4e86\uff0c\u4e0d\u8fc7\u6211\u4ecd\u7136~~\u539a\u989c\u65e0\u803b~~\u63a8\u8350\u6211\u8fd9\u79cd\u6613\u4e8e\u7f16\u5199\u7684\u6a21\u677f\uff0c\u5c31\u662f\u7528vector\u5b58\u6570\u636e\uff0c\u91cd\u8f7d\u8fd0\u7b97\u7b26\u5373\u53ef\uff0c\u4e0d\u9700\u8981\u5199\u5947\u602a\u7684get/set\u4e4b\u7c7b\u7684\u4e1c\u897f\uff0c\u6df1\u62f7\u8d1d\uff1fvector\u5df2\u7ecf\u5e2e\u6211\u4eec\u5199\u597d\u5566\uff0c\u5e76\u4e0d\u9700\u8981\u3002\n\n\u63a8\u5bfc\u8fc7\u7a0b\u8fd9\u91cc\u7b80\u7565\u5199\u4e0b\uff1a\n1.\t\u6c42an\uff0c\u9700\u8981an-1,an-2,an-3,\u8003\u8651\u7528bn = (an+1,an+2,an+3)\u4f5c\u4e3a\u72b6\u6001\n2.\t\u5217\u51fabn\u4e0ebn+1\u7684\u9012\u63a8\u5173\u7cfb(an+2,an+3,an+4)=(0*an+1+1*an+2+0*an+3,0*an+1+0*an+2+1*an+3,1*an+1+0*an+2+1*an+3)\n3.\t\u770b\u4e00\u4e0b1,2\u7684\u5f62\u5f0f\uff0c\u53d1\u73b0\u53ef\u884c\uff08\u80fd\u9012\u63a8\uff0c\u4e0d\u4f1a\u6f0f\u6389\u67d0\u4e9b\u9879\uff09\uff0c\u5f53\u7136\u5982\u679c\u4e0d\u884c\u7684\u8bdd\uff0c\u8003\u8651\u5728\u72b6\u6001\u4e2d\u52a0\u5165an+4\uff0c\u52a0\u5230\u80fd\u4ea7\u751f\u9012\u63a8\u5173\u7cfb\u4e3a\u6b62\n4.\t\u77e9\u9635\u4e58\u662f\u6709\u7ed3\u5408\u5f8b\u7684\uff08\u4ea4\u6362\u5f8b\u5f53\u7136\u6ca1\u6709\u4e86...~~\u524d\u6392\u63a8\u8350\u767e\u5ea6\u767e\u79d1\u77e9\u9635\u4e58\u6cd5~~,bn=b1*A*A*A.......=b1*A^(n-2)\n5.\t\u6572\u4ee3\u7801\u53bb\u4e86\n\n~~\u4e0d\u6015TLE/MLE~~\u53ef\u4ee5\u653e\u5fc3\u4f7f\u7528\n\u524d\u6392\u63d0\u9192\uff0c\u672c\u4ee3\u7801\u4e2d\u4f7f\u7528\u4e86\u4e00\u4e9bC++11\u7279\u6027\uff0c\u4f7f\u7528\u4e86\u5f02\u5e38\uff0c\u53ea\u662f\u8fc7\u9898\u7684\u8bdd\u53ef\u4ee5\u624b\u52a8\u66ff\u6362\u6389/\u5220\u9664\u6389\u3002\n```cpp\n  #include <iostream>\n  #include <functional>\n  #include <algorithm>\n  #include <vector>\n  #include <exception>\n\n  typedef std::vector<unsigned long long> Vector;\n  typedef std::vector<Vector> Matrix;\n\n  unsigned long long mod=1000000007ULL;\n  Matrix matrix(int n=1,int m=1){\n    return Matrix(n,Vector(m,0));\n  }\n  Matrix unit(int n){\n    Matrix ret=matrix(n,n);\n    for(int i=0;i<n;i++)\n      ret[i][i]=1ULL;\n    return ret;\n  }\n  Matrix operator*(const Matrix& a,const Matrix& b){\n    int n=a.size(),m=a[0].size(),p=b[0].size();\n    Matrix ret=matrix(n,p);\n    if(b.size()!=m) throw std::exception();\n    for(int i=0;i<n;i++){\n      for(int j=0;j<p;j++){\n        unsigned long long dot=0ULL;\n        for(int k=0;k<m;k++)\n          dot+=(a[i][k]*b[k][j])%mod;\n        ret[i][j]=dot;\n      }\n    }\n    return ret;\n  }\n  void deepcopy(const Matrix&& from,Matrix& to){\n    for(int i=0;i<from.size();i++)\n    for(int j=0;j<from[0].size();j++)\n      to[i][j]=from[i][j];\n  }\n  Matrix qpow(const Matrix& m,unsigned long long k){\n    if(k==0)return unit(m.size());\n    if(k==1)return m;\n    if(k==2)return m*m;\n    if(k&1) return qpow(qpow(m,k>>1),2)*m;\n    else    return qpow(qpow(m,k>>1),2);\n  }\n  Matrix operator^(const Matrix& m,unsigned long long k){\n    if(m.size()!=m[0].size())throw std::exception();\n    return qpow(m,k);\n  }\n  void out(const Matrix& a){\n    int n=a.size(),m=a[0].size();\n    std::cout << \"Matrix(\"<<n<<\"*\"<<m<<\")[\" << '\\n';\n    for(int i=0;i<n;i++){\n      std::cout << \"[\";\n      for(int j=0;j<m;j++){\n        std::cout << a[i][j] << \",\";\n      }\n      std::cout << \"],\" << '\\n';\n    }\n    std::cout << \"]\" << '\\n';\n  }\n  void out(const Vector& a){\n    int n=a.size();\n    std::cout << \"Vector(\"<<n<<\")[ \" ;\n    for(int i=0;i<n;i++)\n        std::cout << a[i] << \",\";\n    std::cout << \" ]\" << '\\n';\n  }\n\n  int main(){\n    Matrix m=matrix(3,3);\n    m[0]=Vector{0,0,1};\n    m[1]=Vector{1,0,0};\n    m[2]=Vector{0,1,1};\n    int t,n;std::cin >> t;\n    while(t--){\n      std::cin >> n;\n      if(n<=3){\n        std::cout << 1 << '\\n';\n        continue;\n      }\n      Matrix t=matrix(3,3);\n      deepcopy(m^(n-3),t);\n      // out(t);\n      std::cout << (t[0][2]+t[1][2]+t[2][2])%mod << '\\n';\n    }\n    return 0;\n  }\n\n```\n",
        "postTime": 1518491959,
        "uid": 15295,
        "name": "hehelego",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "\u624d\u5b66\u4e86\u77e9\u9635\u52a0\u901f\uff0c\u6765\u7ec3\u7ec3\u624b\n\n\u5148\u770b\u8fd9\u4e2a\u7279\u5f81\u65b9\u7a0bF[i] = F[i - 1] + F[i - 3]\uff0c\u90a3\u4e48\u5c31\u6709\u4e00\u4e2a\u77e9\u9635\u5982\u4e0b ![](https://cdn.luogu.com.cn/upload/pic/10507.png)\n\n\u6211\u4eec\u7684\u76ee\u6807\u77e9\u9635\u5c31\u662f ![](https://cdn.luogu.com.cn/upload/pic/10509.png)\n\n\u90a3\u4e48\uff0c\u9488\u5bf9\u8fd9\u4e2a\u77e9\u9635\u6211\u4eec\u5982\u4f55\u8f6c\u7f6e\u5462\uff1f\n\n\u5148\u770b\u76ee\u6807\u77e9\u9635\u7b2c\u4e00\u4e2a\uff1aF[i]\n\nF[i] = F[i - 1] + F[i - 3]\n\n\u90a3\u4e48\uff0c\u7531\u77e9\u9635\u4e58\u6cd5\uff0c\u8f6c\u7f6e\u77e9\u9635\u7b2c\u4e00\u884c\uff0c\u4f3c\u4e4e\u5c31\u5b9a\u4e86\uff1a1 0 1\n\n\u540c\u6837\u7684\uff0c\u4e8c\u4e09\u884c\u5c31\u662f1 0 0 \u548c 0 1 0\n\n\u6574\u4e2a\u77e9\u9635\u5982\u4e0b\uff1a\n\n ![](https://cdn.luogu.com.cn/upload/pic/10511.png) \n\n\u81f3\u4e8e\u8f6c\u7f6e\u77e9\u9635\u548c\u521d\u59cb\u77e9\u9635\u7684\u7528\u6cd5\uff1f\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u5efa\u8bae\u5148\u8fc7<https://www.luogu.org/problemnew/show/3390>\n\nCode:\n```cpp\n#include <bits/stdc++.h>\nconst int mod = 1000000007;\nint n;\ninline int read()\n{\n    int ch;int x = 0;int f = 1;ch=getchar();\n    while (ch!='-'&&(ch<'0'||ch>'9'))\n        ch=getchar();\n    ch=='-'?f=-1:x=ch-'0',ch=getchar();\n     while(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\n     return x*f;\n}\nstruct Mat {\n    long long mat[3][3];\n};\nMat operator * (Mat a, Mat b) {\n    Mat c;\n    memset(c.mat, 0, sizeof(c.mat));\n    for(int i = 0; i < 3; i++) {\n        for(int k = 0; k < 3; k++) {\n            for(int j = 0; j < 3; j++) {\n                c.mat[i][j] += (a.mat[i][k] % mod) * (b.mat[k][j] % mod) % mod;\n                c.mat[i][j] %= mod;\n            }\n        }\n    }\n    return c;\n}\nMat operator ^ (Mat a, long long k)  {\n    Mat c;\n    for(int i = 0; i < 3; i++)\n        for(int j = 0; j < 3; j++) c.mat[i][j] = (i == j);\n    while(k) {\n        if(k & 1) c = c * a;\n        a = a * a;\n        k >>= 1;\n    }\n    return c;\n}\nMat init;\nMat fi;\nint t;\nsigned main()\n{\n    scanf(\"%d\", &t);\n    while(t--)\n    {\n        memset(init.mat, 0, sizeof(init.mat));\n        memset(fi.mat, 0, sizeof(fi.mat));\n        scanf(\"%d\", &n);\n        init.mat[0][0] = 1;\n        init.mat[0][2] = 1;\n        init.mat[1][0] = 1;\n        init.mat[2][1] = 1;\n        fi.mat[0][0] = 1;\n        fi.mat[1][0] = 1;\n        fi.mat[2][0] = 1;\n        if(n <= 3) printf(\"%d\\n\", 1);\n        else{\n            init = init ^ (n - 3);\n            fi = init * fi;\n            printf(\"%d\\n\", fi.mat[0][0]);\n        }\n    }\n    return 0;\n}\n\n```",
        "postTime": 1509971770,
        "uid": 34332,
        "name": "KKarshilov",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "\u5982\u679c\u6309\u7167\u9898\u76ee\u7ed9\u7684\u9012\u63a8\u516c\u5f0f\u76f4\u63a5\u8ba1\u7b97\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(tn)\uff0c\u65e0\u6cd5\u5728\u65f6\u9650\u5185\u5b8c\u6210\n\n\u6240\u4ee5\u5c31\u8981\u8003\u8651\u4f7f\u7528\u77e9\u9635\u4f18\u5316\uff08\u5e9f\u8bdd\n\n\u539f\u7406\u697c\u4e0b\u7684\u51e0\u4f4ddalao\u5df2\u7ecf\u89e3\u91ca\u6e05\u695a\u4e86\uff0c\u6211\u5c31\u6765\u6254\u53e6\u4e00\u79cd\u77e9\u9635\u548c\u4e00\u4efd\u4e11\u964b\u7684pascal\u4ee3\u7801\n\n\n**\u521d\u59cb\u77e9\u9635**\n\n1 0 0\n**\u9012\u63a8\u77e9\u9635**\n\n1 1 0\n0 0 1\n1 0 0\n\u6700\u7ec8\u7684\u7ed3\u679c\u5c31\u662f\u5c06**\u521d\u59cb\u77e9\u9635**\u4e58\u4ee5**\u9012\u63a8\u77e9\u9635**\u7684(n-1)\u6b21\u5e42\n\n\n\u7136\u540e\u6254\u4ee3\u7801\n\n```pascal\nconst jzm=1000000007;\ntype arr=array [0..3,0..3] of longint;\nvar a,c,d:arr;\n    b,e:array [0..3] of longint;\n    t,n,i,j:longint;\n\nfunction mult(x,y:arr):arr;\nvar i,j,k:longint;\nbegin\nfillchar(mult,sizeof(mult),0);\nfor i:=1 to 3 do\n    for j:=1 to 3 do\n        for k:=1 to 3 do\n            mult[i,j]:=(mult[i,j] mod jzm+((x[i,k] mod jzm)*(y[k,j] mod jzm))) mod jzm;\nend;\n\nfunction mi(p:longint):arr;\nbegin\nif p=0 then exit(d);\nmi:=mi(p shr 1);\nmi:=mult(mi,mi);\nif p mod 2=1 then mi:=mult(mi,c);\nend;\n\nbegin\nread(t);\nwhile t>0 do\n    begin\n     read(n);\n     a[1,1]:=1; a[1,2]:=1; a[1,3]:=0;\n     a[2,1]:=0; a[2,2]:=0; a[2,3]:=1;\n     a[3,1]:=1; a[3,2]:=0; a[3,3]:=0;\n     b[1]:=1;\n     c:=a;\n     d[1,1]:=1; d[2,2]:=1; d[3,3]:=1;\n     a:=mi(n-1);\n     for j:=1 to 3 do\n        begin\n         e[j]:=0;\n         for i:=1 to 3 do\n            e[j]:=(e[j] mod jzm+((a[i,j] mod jzm)*(b[i] mod jzm)) mod jzm) mod jzm;\n        end;\n     writeln(e[1]);\n     dec(t);\n    end;\nend.\n```\n\u6211\u6c38\u8fdc\u559c\u6b22pascal.jpg\n",
        "postTime": 1503365512,
        "uid": 4469,
        "name": "ckd\u98de\u9f20",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "\u521d\u59cb\u77e9\u9635\u6211\u4eec\u8bb0\u4f5cfst\uff0c\u9012\u63a8\u77e9\u9635\u8bb0\u4f5ctrans \u2193\n\n**1 1 1**    **1 1 0**\n\n**0 0 0**    **0 0 1**\n\n**0 0 0**    **1 0 0**\n\n\u90a3\u4e48fst+1=fst\\*trans,fst+2=(fst+1)\\*trans\u2026\u2026\n\n\u6613\u5f97ans=fst\\*(trans^(n-3))\n\n\u6ce8\u610f\u4e58\u79ef\u7206int\u9700\u8981\u5f3a\u8f6clong long\u3002\n\n\u53e6\u5916n<=3\u7684\u60c5\u51b5\u9700\u8981\u7279\u5224\uff0c\u8fd9\u9053\u9898\u5c31\u505a\u5b8c\u4e86\u3002\n\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define mod 1000000007 \nusing namespace std;\nint n; \nstruct Mat \n{\n    int x,y;\n    int arr[5][5];\n    Mat(){}\n    Mat(const int _x,const int _y)\n    {\n        x=_x,y=_y; \n        memset(arr,0,sizeof(arr)); \n    }\n    void unit()\n    {\n        for(int i=1;i<=x;++i) arr[i][i]=1; \n    }\n    Mat operator*(Mat b)\n    {\n        Mat a=*this,c(a.x,b.y);\n        for(int i=1;i<=c.x;++i)\n            for(int j=1;j<=c.y;++j)\n                for(int k=1;k<=a.y;++k)\n                    (c.arr[i][j]+=(long long)a.arr[i][k]*b.arr[k][j]%mod)%=mod;\n        return c; \n    }\n    Mat operator^(const int B)\n    {\n        int b=B; \n        Mat ret(3,3),X=*this;\n        ret.unit();\n        while(b){\n            if(b&1) ret=ret*X;\n            X=X*X; \n            b>>=1; \n        }\n        return ret; \n    }\n};\nint main()\n{\n    int T;\n    scanf(\"%d\",&T);\n    while(T--){\n        scanf(\"%d\",&n);\n        if(n<=3){\n            printf(\"%d\\n\",1);\n            continue; \n        }\n         Mat trans(3,3),fst(3,3);\n        trans.arr[1][1]=trans.arr[1][2]=trans.arr[2][3]=trans.arr[3][1]=fst.arr[1][1]=fst.arr[1][2]=fst.arr[1][3]=1;\n        Mat ans=fst*(trans^(n-3)); \n        printf(\"%d\\n\",ans.arr[1][1]); \n    }\n    return 0; \n} \n```",
        "postTime": 1501997030,
        "uid": 34795,
        "name": "12mango",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "3\\*3\u77e9\u9635\u89e3\u51b3\u65b9\u6cd5\uff1a\n\nan        1 0 1            an-1\n\nan-1 = 1 0 0 ^(n-3) an-2\n\nan-2     0 1 0            an-3\n\n\u800c\u77e9\u9635\u662f\u53ef\u4ee5\u7528\u5feb\u901f\u5e42\u5904\u7406\u7684\uff0c\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a\uff08tlog2n\uff09\u3002\n\n\u552f\u4e00\u7684\u95ee\u9898\u5728\u4e8e\uff0c\u77e9\u9635\u7684\u5904\u7406\u6bd4\u8f83\u9ebb\u70e6\uff0c\u591a\u6570\u540c\u5b66\u7684\u4ee3\u7801\u6bd4\u8f83\u5197\u957f\u3002\u5728\u8fd9\u91cc\u626f\u4e00\u4e2aOI\u4e4b\u5916\u7684\u8bdd\u9898\u2014\u2014MATLAB\u3002\n\nMATLAB\u610f\u4e3a\u201c\u77e9\u9635\u5b9e\u9a8c\u5ba4\u201d\uff0c\u662f\u4e16\u754c\u4e09\u5927\u6570\u5b66\u8f6f\u4ef6\u4e4b\u4e00\uff0c\u6700\u64c5\u957f\u7684\u5c31\u662f\u706d\u77e9\u9635\u3002\n\n\u8fd9\u662f\u89e3\u51b3\u6b64\u9898\u7684MATLAB\u4ee3\u7801\uff0c\u771f\u7684\u5f88\u7b80\u77ed\u3002\n\n```cpp\nfunction ksm= Untitled(n)\n    ksm=0;\n    mat=[1,0,1;1,0,0;0,1,0];\n    ini=ones(3,1);\n    if n==1||n==2||n==3\n        ksm=1;\n    else \n        n=n-3;\n```\nwhile n>0\n```cpp\n            if mod(n,2)==1\n                ini=mod(mat,1000000007)*ini;\n            end\n                n=floor(n/2);\n                mat=mod(mat,1000000007)*mat;\n        end\n        ksm=ini(1,1);\n    end\nend\n```\n\u7136\u540e\u5229\u7528MATLAB\u81ea\u5e26\u7684\u5de5\u5177\u7bb1\uff0c\u751f\u6210C\u4ee3\u7801\uff0c\u518d\u7565\u52a0\u5904\u7406\uff0c\u5373\u53ef\u5b8c\u6210\u3002\u8fd9\u662f\u4fe1\u606f\u7ade\u8d5b\u4e4b\u5916\u7684\u5185\u5bb9\u4e86\uff0c\u4f46\u5927\u5bb6\u53ef\u4ee5\u53c2\u8003\uff0c\u6bd5\u7adf\u4e5f\u662f\u4e00\u4e2a\u89e3\u51b3\u95ee\u9898\u7684\u9014\u5f84\uff0c\u5728\u4ee5\u540e\u7684\u79d1\u7814\u4e2d\u4e5f\u4f1a\u7528\u5230\u3002",
        "postTime": 1501217721,
        "uid": 2248,
        "name": "\u6c47\u6587\u5ba2",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "\u6839\u636e\u9898\u76ee\u63cf\u8ff0\u53ef\u63a8\u51faa[0]=0\uff0c\u56e0\u6b64\u53ef\u5217\u51fa\u521d\u59cb\u77e9\u9635\uff1a\n\n# 0\n# 1\n# 1\n# 1\n\u5728\u6839\u636e\u7ed9\u51fa\u7684\u8f6c\u79fb\u65b9\u7a0ba[i]=a[i-3]+a[i-1]\u53ef\u5217\u51fa\u8f6c\u79fb\u77e9\u9635:\n\n# 0 1 0 0\n\n# 0 0 1 0\n\n# 0 0 0 1\n\n# 0 1 0 1\n\n\u53ef\u4ee5\u8bc1\u660e\uff0c\u521d\u59cb\u77e9\u9635\u4e58\u4ee5\u8f6c\u79fb\u77e9\u9635\u7684(k-3)\u6b21\u65b9\u53ef\u4ee5\u5f97\u5230\u7684\u65b0\u77e9\u9635\u7684\u5404\u9879\u4f9d\u6b21\u4e3a\n\n# a[k-3]\n\n# a[k-2]\n\n# a[k-1]\n\n# a[k]\n\u800c\u77e9\u9635\u4e58\u6cd5\u6ee1\u8db3\u7ed3\u5408\u5f8b\uff0c\u5373A\\*B\\*B=A\\*(B\\*B)[A\u3001B\u7686\u4e3a\u77e9\u9635]\uff0c\u56e0\u6b64\u53ef\u4ee5\u5148\u5c06\u8f6c\u79fb\u77e9\u9635\u5148\u8fdb\u884c\u5e42\u8ba1\u7b97\u540e\u5728\u4e0e\u521d\u59cb\u77e9\u9635\u76f8\u4e58\u3002\n\n\u800c\u5e42\u8ba1\u7b97\u53ef\u4ee5\u52a0\u901f\u7684\u539f\u7406\u662f\uff1a\n\n# A^(2n)=(A^n)^2(n\u2208N\\*)\n\n\u548c\n# A^(2n+1)=A\\*(A^n)^2\n\n\u7406\u89e3\u540e\u5c31\u4e0d\u96be\u4e86\u3002\u987a\u4fbf\u8bf4\u4e00\u4e0b\uff0c\u8981\u7279\u5224a[1]~a[3]\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<iostream>\n#include<cmath>\n#include<algorithm>\nusing namespace std;\nconst long long P=1000000007;\nlong long a[5][5],sum[5][5],k;\nint T,flag;\nvoid mul(long long x[][5],long long y[][5])//\u77e9\u9635\u4e58\u6cd5\uff0c\u642c\u5f97\u5feb\u901f\u5e42\u7684\u6807\u7a0b\n{\n    long long c[5][5]={0};\n    int i,j,k;\n    for(i=1;i<=4;i++)\n        for(j=1;j<=4;j++)\n            for(k=1;k<=4;k++)c[i][j]=(c[i][j]+x[i][k]*y[k][j])%P;\n    for(i=1;i<=4;i++)\n        for(j=1;j<=4;j++)x[i][j]=c[i][j];\n}\nint main()\n{\n    int i,j;\n    scanf(\"%d\",&T);\n    while(T--)\n    {\n        scanf(\"%d\",&k);\n        if(k<=3)//\u7279\u5224\n        {\n            printf(\"1\\n\");\n            continue;\n        }\n        k-=3;//\u6ce8\u610f\u4e58\u65b9\u7684\u6b21\u6570\u8981-3\n        memset(a,0,sizeof(a));//\u6ce8\u610f\u6bcf\u6b21\u91cd\u7f6e\u8f6c\u79fb\u77e9\u9635\n        a[1][2]=a[2][3]=a[3][4]=a[4][2]=a[4][4]=1;\n        flag=false;\n        while(k)//\u5feb\u901f\u5e42\n        {\n            if(k%2)\n            {\n                if(!flag)//\u5176\u5b9e\u53ef\u4ee5\u53bb\u6389\u8fd9\u6b65\uff0c\u53ea\u8981\u5c06sum\u659c\u5bf9\u89d2\u7ebf\u521d\u59cb\u5316\u4e3a1\u5c31\u53ef\u4ee5\u7701\u53bb\u4e86\uff0c\u53ea\u4e0d\u8fc7\u8fd9\u6837\u66f4\u76f4\u89c2\n                {\n                    for(i=1;i<=4;i++)\n                        for(j=1;j<=4;j++)sum[i][j]=a[i][j];\n                    flag++;\n                }\n                else mul(sum,a);\n            }\n            k>>=1;\n            if(k)mul(a,a);\n        }\n        long long s=((sum[4][2]+sum[4][3])%P+sum[4][4])%P;//\u53ef\u4ee5\u6ce8\u610f\u5230\u521d\u59cb\u77e9\u9635\u53ea\u6709\u540e3\u4e2a\u6570\u4e3a1\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u5c06\u8f6c\u79fb\u77e9\u9635\u6bcf\u884c\u540e\u4e09\u4e2a\u6570\u76f8\u52a0\u5373\u53ef\u6c42\u5f97\u76ee\u6807\u77e9\u9635\u3002\u66f4\u8fdb\u4e00\u6b65\uff0c\u6211\u4eec\u9700\u8981\u7684\u53ea\u662fa[n],\u6240\u4ee5\u5b8c\u5168\u53ef\u4ee5\u7701\u53bba[n-3]~a[n-1]\u7684\u8ba1\u7b97\uff0c\u53ea\u8981\u8003\u8651\u6700\u540e\u4e00\u884c\u3002\n        cout<<s<<endl;\n    }\n    return 0;\n}\n```",
        "postTime": 1500536756,
        "uid": 7035,
        "name": "Great_Influence",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "###\u6211\u770b\u6ca1\u6709p\u515a\u53d1\u9898\u89e3\uff0c\u5c31\u6765\u53d1\u4e00\u4e2a\u5427\n\n\n```cpp\n**type zyn=array[1..3,1..3]of longint;\nvar i,j,k,n,m:longint;a,b,t:zyn;\nfunction mul(a,b:zyn):zyn;//\u77e9\u9635\u4e58\u6cd5\nvar i,j,k:longint;c:zyn;\nbegin\n  fillchar(c,sizeof(c),0);\n  for i:=1 to 3 do\n    for j:=1 to 3 do\n      for k:=1 to 3 do\n        c[i,j]:=(a[i,k]*b[k,j]+c[i,j])mod 1000000007;\n  exit(c);\nend;\nfunction power(x:longint):zyn;//\u5feb\u901f\u5e42\nvar t:zyn;\nbegin\n  if x=1 then exit(b);\n  t:=power(x div 2);\n  t:=mul(t,t);\n  if odd(x) then t:=mul(t,b);\n  exit(t)\nend;\nbegin\n  fillchar(a,sizeof(a),0);fillchar(b,sizeof(b),0);\n  a[1,1]:=1;a[1,2]:=1;a[1,3]:=1;b[1,3]:=1;b[2,1]:=1;b[3,2]:=1;b[3,3]:=1;\n  readln(n);\n  for i:=1 to n do\n    begin\n      readln(m);  if m<=3 then begin writeln(1);continue;end;\n      t:=power(m-3);\n      t:=mul(a,t);\n      writeln(t[1,3]);\n    end;\nend.\n**\n```",
        "postTime": 1477747469,
        "uid": 19485,
        "name": "scarborough_fair",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    },
    {
        "content": "\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u8981\u8003\u8651m<=3\n\n\n    \n    \n        \n        \n    \n    \n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <climits>\n#include <cstring>\nusing namespace std;\nstruct maxtrix\n{\n    long long a[3][3];\n    long long h;\n    long long l;\n    };\nmaxtrix a,b;\nlong long n,m;\nconst int mod=1000000007;\nmaxtrix cf(maxtrix x,maxtrix y)\n    {\n        maxtrix ans;\n        ans.h=ans.l=3;\n        memset(ans.a,0,sizeof(ans.a));\n        for (int i=0;i<x.h;i++)\n            for (int j=0;j<y.l;j++)\n                for (int k=0;k<x.l;k++)\n                {\n                    ans.a[i][j]+=x.a[i][k]*y.a[k][j];\n                    ans.a[i][j]=ans.a[i][j]%mod;\n                    }\n        return ans;\n        }\nmaxtrix qsm(maxtrix a,int b)\n    {\n        maxtrix t=a;\n        maxtrix y;\n        memset(y.a,0,sizeof(y.a));\n        y.a[0][0]=1;\n        y.a[1][1]=1;\n        y.a[2][2]=1;\n        y.h=y.l=3;\n        while (b!=0)\n        {\n            if (b&1) y=cf(t,y);\n            t=cf(t,t);\n            b=b>>1;\n            }\n        return y;\n        }\nint main()\n{\n    cin>>n;\n    for (int wtf=0;wtf<n;wtf++){\n        cin>>m;\n        if (m<=3&&m>0) {cout<<1<<endl; continue;} else if (m<=0) {cout<<0<<endl; continue;} \n        memset(a.a,0,sizeof(a.a));\n        memset(b.a,0,sizeof(b.a));\n        a.a[0][0]=1;\n        a.a[0][2]=1;\n        a.a[1][0]=1;\n        a.a[2][1]=1;\n        b.a[0][0]=1;\n        b.a[1][0]=1;\n        b.a[2][0]=1;\n        b.h=3;\n        b.l=1;\n        a.l=a.h=3;\n        a=qsm(a,m-3);\n        a=cf(a,b);\n        cout<<a.a[0][0] % 1000000007<<endl;\n    }\n    return 0;\n}\n```",
        "postTime": 1452160415,
        "uid": 8643,
        "name": "swain",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1939 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09\u3011"
    }
]
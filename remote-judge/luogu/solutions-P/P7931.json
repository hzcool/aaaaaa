[
    {
        "content": "## \u524d\u7f6e\u829d\u58eb\n\nLIS \u7684 $nlog(n)$ \u7b97\u6cd5\n\n\u4e5f\u5c31\u662f\u8bf4\u60a8\u53ef\u4ee5\u53bb\u770b\u770b[\u8fd9\u9053\u535a\u5ba2](https://blog.csdn.net/lxt_Lucia/article/details/81206439)\n\n## \u9898\u89e3\n\n\u957f\u5ea6\u76f4\u63a5\u6c42\u5c31\u597d\u4e86\uff0c\u73b0\u5728\u8003\u8651\u600e\u4e48\u6c42\u65b9\u6848\u6570\u3002\n\n\u6211\u4eec\u628a\u9898\u76ee\u6240\u7ed9\u7684\u5e8f\u5217\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5143\u7d20\u6309\u7167**\u4e0b\u6807**\u548c**\u503c**\u8868\u793a\u6210\u4e00\u4e2a\u70b9\u5bf9\uff0c\u7136\u540e\u5efa\u7acb\u5e73\u9762\u76f4\u89d2\u5750\u6807\u7cfb($x$ \u4e3a\u4e0b\u6807\uff0c$y$ \u4e3a\u503c\uff0c\u8fd9\u91cc\u4ee5\u6837\u4f8b $3$ \u4e3e\u4f8b):\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ev8gswxq.png)\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u4e00\u4e2a\u4e0a\u5347\u5b50\u5e8f\u5217\u53cd\u5e94\u5230\u56fe\u4e0a\u662f\u7531 $x$\uff0c$y$ \u5747\u9012\u589e\u7684\u70b9\u7ec4\u6210\u7684\uff0c\u4e14\u4efb\u610f\u7ec4 $x$ \u9012\u589e\uff0c$y$ \u9012\u51cf\u7684\u70b9\u4e00\u5b9a\u4e0d\u662f\u4e0a\u5347\u5b50\u5e8f\u5217\u3002\n\n\u6211\u4eec\u8003\u8651\u4ece $x=1$ \u5f00\u59cb\uff0c\u5c06\u8fd9\u4e9b\u70b9\u5212\u5206\u6210\u591a\u7ec4 $x$ \u9012\u589e\uff0c$y$ \u9012\u51cf\u7684\u70b9\uff0c\u5982\u56fe:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/h6yltz8m.png)\n\n\u90a3\u4e48\u53ef\u4ee5\u53d1\u73b0\uff0c\u4efb\u610f\u4e00\u4e2a\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u65b9\u6848\u90fd\u53ef\u4ee5\u8868\u73b0\u4e3a\u5728\u6bcf\u4e00\u5c42\u4e2d\u5206\u522b\u9009\u62e9\u4e00\u4e2a\u70b9\u4e14\u6ee1\u8db3\u5b83\u4eec\u5747\u662f $x$\uff0c$y$ \u5747\u9012\u589e\u7684\u70b9\u7684\u524d\u63d0\u4e0b\u7684\u65b9\u6848\u3002\n\n\u4ee5\u6837\u4f8b $3$ \u4e3a\u4f8b\uff0c\u5176\u4e2d\u7684\u4e00\u4e2a\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684\u65b9\u6848\u4e3a `1 3 5` \uff0c\u53cd\u5e94\u5728\u5750\u6807\u7cfb\u4e0a\u5c31\u662f\u9009\u62e9 `A C E` \u4e09\u4e2a\u70b9\u3002\n\n\u90a3\u4e48\u8fd9\u4e2a\u95ee\u9898\u5c31\u795e\u5947\u7684\u8f6c\u6362\u6210\u4e86\uff1a\u5728\u6bcf\u4e00\u5c42\u4e2d\u9009\u4e00\u4e2a\u70b9\uff0c\u5728\u6ee1\u8db3\u5b83\u4eec\u5747\u662f $x$\uff0c$y$ \u5747\u9012\u589e\u7684\u70b9\u7684\u60c5\u51b5\u4e0b\u4e14\u6bcf\u4e2a\u70b9\u53ea\u80fd\u9009\u4e00\u6b21\u7684\u65b9\u6848\u6570\u3002\n\n\n\u6211\u4eec\u5148\u89e3\u51b3\u600e\u4e48\u5206\u5c42\u3002\n\n\u6211\u4eec\u5c06 $LIS_i$ \u5b9a\u4e49\u4e3a\u5728\u4e0b\u6807 $i$ \u5904\u7ed3\u675f\u7684\u6700\u957f\u9012\u589e\u5b50\u5e8f\u5217\u7684\u957f\u5ea6,\u90a3\u4e48\u5176\u5b9e\u7b2c $k$ \u5c42\u5c31\u662f $LIS_i=k$ \u7684\u4e0b\u6807\u7684\u96c6\u5408\u3002\n\n\u7136\u540e\u6211\u4eec\u63a5\u4e0b\u6765\u8bc1\u660e\u4e00\u4e2a\u95ee\u9898\uff1a\u5728\u67d0\u4e00\u5c42\u4e2d\u7684\u70b9\u8df3\u5230\u4e0b\u4e00\u5c42\u4e2d\u65f6\uff0c\u9009\u62e9\u4e0b\u6807\u66f4\u5c0f\u7684\u70b9\u4e00\u5b9a**\u4e0d\u52a3\u4e8e**\u9009\u62e9\u4e0b\u6807\u66f4\u5927\u7684\u70b9\u3002\n\n\u8ba9\u6211\u4eec\u518d\u6765\u770b\u4e00\u770b\u90a3\u5f20\u56fe\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/h6yltz8m.png)\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u6211\u73b0\u5728\u5df2\u7ecf\u9009\u62e9\u4e86 $A$ \u70b9\uff0c\u4e0b\u4e00\u6b65\u53ef\u4ee5\u9009\u62e9 $C$\uff0c$D$ \u70b9\uff0c\u4f46\u6211\u9009\u62e9 $C$ \u70b9\u7684\u603b\u65b9\u6848\u6570\u4e00\u5b9a\u4e0d\u6bd4\u9009\u62e9 $D$ \u70b9\u7684\u65b9\u6848\u6570\u5c11\u3002\n\n\u6211\u4eec\u8003\u8651\u600e\u4e48\u8bc1\u660e\u3002\n\n\u4ee5\u8fd9\u91cc\u7684 `A,B,C,D` \u4e3e\u4f8b\uff0c\u5982\u679c\u6211\u4eec\u9009\u62e9 `A,D`\uff0c\u90a3\u4e48\u8fd8\u6709 `B,C` \u8fd9\u4e00\u6761\u8def\uff1b\u5982\u679c\u6211\u4eec\u9009\u62e9 `A,C`\uff0c\u90a3\u4e48\u8fd8\u6709 `B,D` \u8fd9\u4e00\u6761\u8def\u3002\u63a8\u5e7f\u5230\u5f88\u591a\u4e2a\uff0c\u6211\u4eec\u7684\u9009\u62e9\u4e00\u5b9a\u4e0d\u4f1a\u5bfc\u81f4\u7b54\u6848\u53d8\u5c0f\n\n\u4f46\u662f\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u7528 `A,D`\uff0c`B,C` \u8fd9\u6837\u4ea4\u9519\u7684\u65b9\u6cd5\u5462\uff1f\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/38sj9a9u.png)\n\n\n\u4ee5\u8fd9\u5f20\u56fe\u4e3a\u4f8b\uff0c\u5982\u679c\u6211\u4eec\u9009\u62e9 `A,D`, \u4f1a\u53d1\u73b0 `B,C` \u65e0\u6cd5\u9009\u62e9\uff0c\u4f46\u6211\u4eec\u53ef\u4ee5\u9009\u62e9 `A,C` `B,D` \u8fd9\u4e24\u79cd\u65b9\u6cd5\u3002\u63a8\u5e7f\u4e00\u4e0b\uff0c\u6211\u4eec\u7684\u65b9\u6cd5\u4e00\u5b9a\u662f\u6700\u4f18\u7684\u3002\n\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\nint n,len=0;\nint a[1000005];\nint dp[1000005];\nint id[1000005];\nvector<int> v[1000005],st;\nvector<vector<int> > ans;\n//int ans=0x3f3f3f3f;\n\nvoid File(){\n\tfreopen(\"volunteering.in\",\"r\",stdin);\n\tfreopen(\"volunteering.out\",\"w\",stdout);\n}\n\nvoid Solve(){\n\twhile(1){\n        if(st.empty())\n            if(v[1].empty()) break;\n            else st.push_back(v[1].back()),v[1].pop_back();\n\t\telse if(st.size()==len) ans.push_back(st),st.clear();\n\t\telse{\n            int k=st.size()+1,now=st.back();\n            while (v[k].size()&&v[k].back()<now) v[k].pop_back();\n            if(v[k].empty()||a[now]>a[v[k].back()]) st.pop_back();\n            else st.push_back(v[k].back()),v[k].pop_back();\n        }\n    }\n}\n\nint main(){\n\tcin>>n;\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&a[i]);\n\tfor(int i=1;i<=n;i++){\n\t\tif(dp[len]<a[i]){ ++len;dp[len]=a[i],id[len]=i;v[len].push_back(i);continue; }\n\t\tint now=lower_bound(dp+1,dp+len+1,a[i])-dp;\n\t\tdp[now]=a[i],id[now]=i;\n\t\tv[now].push_back(i); \n\t}\n\tfor(int i=1;i<=len;i++) reverse(v[i].begin(),v[i].end());\n\tSolve();\n\tprintf(\"%d %d\\n\",ans.size(),len);\n\tfor(int i=0;i<ans.size();i++){\n\t\tfor(auto x:ans[i]) printf(\"%d \",x);\n\t\tprintf(\"\\n\"); \n\t}\n\treturn 0;\n} \n/*\n14\n9 12 8 3 5 4 13 1 14 10 6 2 11 7\n\n7\n2 1 6 5 7 3 4\n*/\n```",
        "postTime": 1640593913,
        "uid": 225883,
        "name": "MiRaciss",
        "ccfLevel": 7,
        "title": "[COCI2021-2022#1] Volontiranje \u9898\u89e3"
    },
    {
        "content": "\u54f2\u5b66\u9898\u3002\n\n\u4ee5\u4e0b\u6807\u4e3a\u6a2a\u8f74\uff0c$p_i$ \u4e3a\u7eb5\u8f74\uff0c\u753b\u51fa\u4e00\u4e2a\u5750\u6807\u7cfb\u3002\u7136\u540e\u4f60\u4f1a\u53d1\u73b0\u6bcf\u4e2a\u70b9\u7684\u540e\u7ee7\u5728\u5176\u53f3\u4e0a\u65b9\uff0c\u4ee5\u6b64\u4e3a\u4f9d\u636e\u6765\u5206\u5c42\uff08\u5177\u4f53\u6765\u8bf4\uff0c\u5c31\u662f\u6c42\u51fa\u6bcf\u4e2a\u4f4d\u7f6e\u7684 LIS\uff09\u3002\n\n\u6211\u6bdb\u4e86\u5f20\u56fe\u7ed9\u4f60\u770b\u554a\uff1a\n\n![](https://img-blog.csdnimg.cn/img_convert/bc11a0ef9186b4536572ab0ad1d9a4a1.png)\u3002\n\n\u7136\u540e\u5728\u6bcf\u5c42\u641e\u4e8b\u60c5\u3002\u8fd9\u91cc\u6709\u4e2a\u7ed3\u8bba\uff1a\n\n>**Claim**\uff1a\u5b58\u5728\u4e00\u79cd\u9009\u62e9 LISs \u7684\u65b9\u6848\uff0c\u4f7f\u5f97\u6bcf\u4e2a LIS \u90fd\u4e0d\u4ea4\u53c9\u3002\n\n\u8bc1\u660e\u5e94\u8be5\u4e0d\u96be\u5427\uff0c\u56e0\u4e3a\u6bcf\u4e24\u4e2a\u4e4b\u95f4\u4ea4\u6362\u4e86\u6ca1\u6709\u5f71\u54cd\uff0c\u6bcf\u5c42\u90fd\u770b\u5f97\u5230\u3002\u90a3\u4e48\u9009\u62e9\u4e0b\u6807\u66f4\u5c0f\u7684\u70b9\u4e00\u5b9a~~\u82cf\u5361~~\u4e0d\u52a3\u3002\u7136\u540e\u4f18\u5316\u4e0b\u641c\u7d22\u7684\u65b9\u5f0f\u5c31\u53ef\u4ee5\u89e3\u51b3\u4e86\uff0c\u8fd9\u4e2a\u5177\u4f53\u770b\u4ee3\u7801\u3002\n\n```cpp\nint n,a[1000100],fwt[1000100],dp[1000100],st[1000100],ed[1000100],q[1000100],lis,ans,lst[1000100];\nvector<int> rec;\nvoid Add(int x,const int w) { for(; x<=n; x+=x&-x)\tcmax(fwt[x],w); }\nint Sum(int x) { int res=0; for(; x; x^=x&-x)\tcmax(res,fwt[x]); return res; }\nvoid digger() {\n\tprintf(\"%d %d\\n\",ans,lis);\n\tfor(int i=1; i<=ans; ++i) {\n\t\tfor(int j=(i-1)*lis+1; j<=i*lis; ++j)\tprintf(\"%d \",rec[j-1]);\n\t\tputs(\"\");\n\t}\n\texit(0);\n}\nsigned main() {\n\tn=read();\n\tfor(int i=1; i<=n; ++i) {\n\t\tdp[i]=Sum((a[i]=read())-1)+1;\n\t\tAdd(a[i],dp[i]),cmax(lis,dp[i]);\n\t\ted[dp[i]]++;\n\t}\n\tfor(int i=1; i<=n; ++i)\ted[i]+=ed[i-1],st[i]=ed[i];\n\tfor(int i=n; i; --i)\tq[st[dp[i]]--]=i;\n\tfor(int i=1; i<=n; ++i)\tst[i]=ed[i-1]+1;\n\tfor(int i=1; i<=n; ++i)\tsort(q+st[i],q+ed[i]+1);\n\twhile(233) {\n\t\tfor(int i=1; i<=lis; ++i) { // enumrating layers\n\t\t\tif(st[i]>ed[i])\tdigger();\n\t\t\tif(a[q[st[i]]]<a[lst[i-1]]) {\n\t\t\t\t----i; st[i+1]++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\twhile(q[st[i]]<lst[i-1] && st[i]<=ed[i]) {\n\t\t\t\tst[i]++;\n\t\t\t\tif(a[q[st[i]]]<a[lst[i-1]]) {\n\t\t\t\t\t----i; st[i+1]++;\n\t\t\t\t\tgoto Suc;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(st[i]>ed[i])\tdigger();\n\t\t\tlst[i]=q[st[i]];\n\t\t\tSuc:;\n\t\t}\n\t\tfor(int i=1; i<=lis; ++i)\trec.push_back(lst[i]),st[i]++;\n\t\tans++;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1640673055,
        "uid": 161849,
        "name": "cirnovsky",
        "ccfLevel": 6,
        "title": "Jesus \u2191 Come down \u2193 and kill that \u2191 white t***h \u2193 Jesus \u2191"
    },
    {
        "content": "# COCI2021-2022 Contest1 T5 \u9898\u89e3\r\n\r\n[TOC]\r\n\r\n## [\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\u6233\u6b64\u8fdb\u5165](http://blog.monkey-hyx.tech?t=COCI-2021-2022-Contest1)\r\n\r\n\uff08\u5efa\u8bae\u60a8\u4ece\u4e0a\u65b9\u94fe\u63a5\u8fdb\u5165\u6211\u7684\u4e2a\u4eba\u7f51\u7ad9\u67e5\u770b\u6b64 Blog\uff0c\u5728 Luogu \u4e2d\u56fe\u7247\u4f1a\u88ab\u5899\u6389\uff0c\u90e8\u5206 Markdown \u4e5f\u4f1a\u5931\u6548\uff09\r\n\r\n## [\u539f\u9898\u9762\u94fe\u63a5](https://hsin.hr/coci/contest1_tasks.pdf)\r\n\r\n## [Luogu\u9898\u9762](https://www.luogu.com.cn/problem/list?keyword=COCI2021-2022%231&page=1)\r\n\r\n## T5 Volontiranje\r\n\r\n~~\u8fd9\u9898\u6bd4 T4 \u7b80\u5355\u591a\u4e86\u3002~~\r\n\r\n### \u9898\u9762\r\n\r\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $ n $ \u7684\u6392\u5217\uff0c\u6c42\u6700\u591a\u7684\u4e0d\u4ea4\u53c9\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684\uff08\u5373\u6bcf\u4e2a\u6570\u53ea\u80fd\u7528\u4e00\u6b21\uff09\u3002~~\uff08\u662f\u7684\u5c31\u8fd9\u4e48\u7b80\u6d01\uff09~~\r\n\r\n\u8f93\u51fa\u4e2a\u6570\uff0c\u957f\u5ea6\uff0c\u5e76\u8f93\u51fa\u6bcf\u4e00\u4e2a\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u3002$ n \\le 10^6 $\u3002\r\n\r\n### Examples\r\n\r\n**Input_1**\r\n\r\n> 3\r\n>\r\n> 1 2 3\r\n\r\n**Output_1**\r\n\r\n> 1 3\r\n>\r\n> 1 2 3\r\n\r\n**Input_2**\r\n\r\n> 4\r\n>\r\n> 4 3 2 1\r\n\r\n**Output_2**\r\n\r\n> 4 1\r\n>\r\n> 1\r\n>\r\n> 2\r\n>\r\n> 3\r\n>\r\n> 4\r\n\r\n**Input_3**\r\n\r\n> 7\r\n>\r\n> 2 1 6 5 7 3 4\r\n\r\n**Output_3**\r\n\r\n> 2 3\r\n>\r\n> 1 3 5\r\n>\r\n> 2 6 7\r\n\r\n### Solution\r\n\r\n\u8003\u8651\u6c42 LIS \u7684\u957f\u5ea6\u76f4\u63a5 $ O(n \\log n) $ \u6c42\u5373\u53ef\uff0c\u53ef\u4ee5\u7528 `` lower_bound `` \u6c42\u3002\r\n\r\n\u800c\u5bf9\u4e8e\u6709\u54ea\u4e9b LIS\uff0c\u6211\u4eec\u5219\u9700\u8981\u627e\u5230\u5176\u4e2d\u7684\u4e00\u4e9b\u6027\u8d28\uff0c\u8003\u8651\u5c06\u6bcf\u4e2a\u6570\u7684\u4e0b\u6807\u4f5c\u4e3a $ x $\uff0c\u6570\u503c\u4f5c\u4e3a $ y $\uff0c\u628a\u6bcf\u4e2a\u6570\u4e22\u5230\u4e8c\u7ef4\u5750\u6807\u7cfb\u91cc\u9762\u89c2\u5bdf\u6027\u8d28\uff0c\u6bd4\u5982\u5bf9\u4e8e Input_3\uff0c\u6700\u540e\u4f1a\u5f62\u6210\u4e0b\u56fe\uff1a\r\n\r\n![COCI-Contest1_1.png](http://monkey-hyx.tech/Images/Blog/COCI-Contest1_1.png)\r\n\r\n\u89c2\u5bdf\u8fd9\u4e2a\u5947\u602a\u7684\u56fe\u5f62\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4ece $ x = 1 $ \u5f00\u59cb\u5212\u5206\u5c42\u7ea7\uff0c\u628a $ x $ \u9012\u589e\u800c $ y $ \u9012\u51cf\u7684\u70b9\u4e0e\u521d\u59cb\u70b9\u5212\u5206\u5230\u540c\u4e00\u5c42\u7ea7\u3002\r\n\r\n\u4e5f\u5c31\u662f\u5982\u4e0b\uff1a\r\n\r\n![COCI-Contest1_2.png](http://monkey-hyx.tech/Images/Blog/COCI-Contest1_2.png)\r\n\r\n\u6ce8\u610f\u8fd9\u91cc\u7684\u5c42\u7ea7\u5212\u5206\u662f\u5de6\u4e0b\u5f00\u53f3\u4e0a\u95ed\u7684\u3002\r\n\r\n\u4e8e\u662f\u6211\u4eec\u4fbf\u53ef\u4ee5\u53d1\u73b0\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a LIS \u90fd\u5e94\u8be5\u662f\u4ece\u6bcf\u4e00\u4e2a\u5c42\u7ea7\u4e2d\u9009\u62e9\u4e00\u4e2a\u70b9\u5e76\u4e14\u7b26\u5408\uff0c\u4e0b\u4e00\u5c42\u7ea7\u7684\u70b9\u7b26\u5408\u5728\u5f53\u524d\u70b9\u7684\u53f3\u4e0a\u3002\r\n\r\n\u8fd9\u91cc\u6211\u4eec\u8003\u8651\u5982\u4f55\u5206\u5c42\uff0c\u8003\u8651\u5f53\u6211\u4eec\u8ba1\u7b97 LIS \u65f6\uff0c\u4e00\u822c\u7528\u7684\u72b6\u6001\u662f\uff0c\u4ee5\u5f53\u524d\u70b9\u4e3a\u7ed3\u5c3e\u7684 LIS \u957f\u5ea6\uff0c\u6211\u4eec\u89c2\u5bdf\u53d1\u73b0\uff0c\u7b2c\u4e00\u5c42\u7ea7\u91cc\uff0c$ A, B $ \u957f\u5ea6\u4e00\u5b9a\u4e3a $ 1 $\uff0c\u7b2c\u4e8c\u5c42\u7ea7\u91cc\uff0c$ C, D, F $ \u957f\u5ea6\u4e00\u5b9a\u4e3a $ 2 $\uff0c$ E, G $ \u957f\u5ea6\u4e00\u5b9a\u4e3a $ 3 $\u3002\r\n\r\n\u4e8e\u662f\u6211\u4eec\u4fbf\u53ef\u4ee5\u53d1\u73b0\u6309\u7167 $ LIS_i = k $\uff0c\u5bf9\u4e8e\u540c\u4e00\u4e2a $ k $ \u7684\u6240\u6709\u4e0b\u6807 $ i $ \u4f5c\u4e3a\u540c\u4e00\u5c42\u7ea7\u3002\r\n\r\n\u8ba9\u540e\u6211\u4eec\u8003\u8651\u5982\u4f55\u9009\u62e9\u6bcf\u4e00\u5c42\u7ea7\u7684\u70b9\uff0c\u8fd9\u91cc\u6211\u4eec\u6709\u4e00\u4e2a\u7ed3\u8bba\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u5c42\u7ea7\u4f18\u5148\u9009\u62e9\u7eb5\u6a2a\u5750\u6807\uff0c\u4e5f\u5c31\u662f\u4e0b\u6807\u66f4\u4f4e\u7684\u672a\u9009\u62e9\u8fc7\u7684\u70b9\u4e00\u5b9a\u662f\u66f4\u4f18\u7684\uff0c\u8fd9\u4e2a\u6b63\u786e\u6027\u53ef\u4ee5\u53bb\u4e3e\u4f8b\u7406\u89e3\u4e00\u4e0b\uff0c\u5982\u679c\u5bf9\u4e8e\u4e0a\u56fe\u7684\u60c5\u51b5\uff0c\u8fde\u7ed3 $ AD $ \u4e0e $ BC $ \u548c\u94fe\u7ed3 $ AC $ \u4e0e $ BD $ \u90fd\u53ef\u4ee5\u7b26\u5408\u8981\u6c42\uff0c\u662f\u4e24\u7ec4\u4e0d\u540c\u7684\u5408\u6cd5\u89e3\uff0c\u4f46\u662f\u8003\u8651\u5982\u4e0b\u60c5\u51b5\uff1a\r\n\r\n![COCI-Contest1_3.png](http://monkey-hyx.tech/Images/Blog/COCI-Contest1_3.png)\r\n\r\n\uff08\u8fd9\u91cc\u4e3a\u4e86\u65b9\u4fbf\u8868\u8ff0\u7701\u7565\u4e86\u4e00\u4e9b\u70b9\uff09\r\n\r\n\u663e\u7136\u5c42\u7ea7\u5212\u5206\u7684\u7ebf\u5927\u6982\u662f\u8fd9\u6837\uff0c\u8fd9\u4e2a\u65f6\u5019\u5982\u679c\u6211\u4eec\u5bf9\u4e8e $ A $\uff0c\u4f7f\u5176\u8fde\u7ed3\u6a2a\u5750\u6807\u66f4\u5c0f\u7684 $ C $\uff0c\u4f1a\u4f7f $ BD $ \u4e5f\u662f\u4e00\u7ec4\u5408\u6cd5\u89e3\uff0c\u800c\u5982\u679c\u8fde\u7ed3 $ AD $\uff0c\u5219 $ BC $ \u4e0d\u5408\u6cd5\u3002\u6545\u663e\u7136\u4f18\u5148\u8fde\u7ed3\u672a\u9009\u62e9\u91cc\u9762\u6a2a\u5750\u6807\u66f4\u5c0f\u7684\u662f\u6700\u4f18\u65b9\u6848\u3002\r\n\r\n\u81f3\u6b64\u6211\u4eec\u7684\u63a8\u5bfc\u5df2\u7ecf\u7ed3\u675f\uff0c\u53ef\u4ee5\u8fdb\u884c\u5b9e\u73b0\u4e86\u3002\r\n\r\n### Code\r\n\r\n```cpp\r\n#define _USE_MATH_DEFINES\r\n#include <bits/stdc++.h>\r\n\r\n#define PI M_PI\r\n#define E M_E\r\n#define npt nullptr\r\n\r\n/******************************\r\nabbr\r\n\r\n******************************/\r\n\r\nusing namespace std;\r\n\r\nmt19937 rnd(random_device{}());\r\nint rndd(int l, int r){return rnd() % (r - l + 1) + l;}\r\n\r\ntypedef unsigned int uint;\r\ntypedef unsigned long long unll;\r\ntypedef long long ll;\r\n\r\n\r\n\r\ntemplate<typename T = int>\r\ninline T read(void);\r\n\r\nvector < int > LISv;\r\npair < int, int > LIS[1100000];\r\nint N;\r\nvector < int > current;\r\nvector < int > tier[1100000];\r\nint arr[1100000];\r\nvector < vector < int > > anss;\r\nint main(){\r\n    N = read();\r\n    for(int i = 1; i <= N; ++i){\r\n        arr[i] = read();\r\n        if(LISv.empty() || LISv.back() < arr[i])LISv.push_back(arr[i]), tier[(int)LISv.size()].push_back(i);\r\n        else{\r\n            auto pos = lower_bound(LISv.begin(), LISv.end(), arr[i]);\r\n            int len = distance(LISv.begin(), pos) + 1;\r\n            *pos = arr[i];\r\n            tier[len].push_back(i);\r\n        }\r\n    }\r\n    int maxLen = (int)LISv.size();\r\n    for(int i = 1; i <= maxLen; ++i)\r\n        reverse(tier[i].begin(), tier[i].end());\r\n    while(true){\r\n        if(current.empty()){\r\n            if(tier[1].empty())break;\r\n            current.push_back(tier[1].back());\r\n            tier[1].pop_back();\r\n        }else if((int)current.size() == maxLen){\r\n            anss.push_back(current);\r\n            current.clear();\r\n        }else{\r\n            int pos = current.size() + 1;\r\n            int last = current.back();\r\n            while(!tier[pos].empty() && tier[pos].back() < last)tier[pos].pop_back();\r\n            if(tier[pos].empty() || arr[tier[pos].back()] < arr[last])current.pop_back();\r\n            else current.push_back(tier[pos].back()), tier[pos].pop_back();\r\n        }\r\n    }\r\n    printf(\"%d %d\\n\", (int)anss.size(), maxLen);\r\n    for(auto i : anss){\r\n        for(auto j : i)printf(\"%d \", j);\r\n        printf(\"\\n\");\r\n    }\r\n    fprintf(stderr, \"Time: %.6lf\\n\", (double)clock() / CLOCKS_PER_SEC);\r\n    return 0;\r\n}\r\n\r\n\r\n\r\ntemplate<typename T>\r\ninline T read(void){\r\n    T ret(0);\r\n    short flag(1);\r\n    char c = getchar();\r\n    while(c != '-' && !isdigit(c))c = getchar();\r\n    if(c == '-')flag = -1, c = getchar();\r\n    while(isdigit(c)){\r\n        ret *= 10;\r\n        ret += int(c - '0');\r\n        c = getchar();\r\n    }\r\n    ret *= flag;\r\n    return ret;\r\n}\r\n```\r\n\r\n## UPD\r\n\r\nupdate-2022_08_30 T1-T3\r\n\r\nupdate-2022_09_01 \u5b8c\u6210\u4e00\u90e8\u5206\u7684 T4\r\n\r\nupdate-2022_09_02 T4 \u809d\u5b8c\r\n\r\nupdate-2022_09_04 \u521d\u7a3f\r\n\r\nupdate-2022_09_04 \u53d1\u73b0 T4 \u4e4b\u524d\u7b97\u6cd5\u5047\u6389\u4e86\uff0c\u4fee\u6539\u4e86\u4e00\u4e0b\r\n\r\nupdate-2022_09_06 \u5b8c\u5584 latex \u4ee5\u7b26\u5408 Luogu \u9898\u89e3\u8981\u6c42",
        "postTime": 1662303808,
        "uid": 362938,
        "name": "Tsawke",
        "ccfLevel": 6,
        "title": "COCI2021-2022 Contest1 T5 \u9898\u89e3"
    },
    {
        "content": "# \u9898\u76ee\u5927\u610f\n\u7ed9\u5b9a\u4e00\u4e2a\u6570\u5217\uff0c\u8ba9\u4f60\u6c42\u5176\u4e2d\u7684\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u957f\u5ea6\u4ee5\u53ca\u4e92\u4e0d\u76f8\u4ea4\u7684\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u4e2a\u6570\u3002\n\n# \u9898\u76ee\u601d\u8def\n\u8fd9\u9053\u9898\u81ea\u7136\u53ef\u4ee5\u5206\u6210\u4e24\u90e8\u5206\u53bb\u505a\u3002\n## 1.\u6c42\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\uff08LIS\uff09\nLIS \u4f5c\u4e3a\u7ecf\u5178\u7684 dp \u9898\u76ee\uff0c\u666e\u901a\u7684 $O(n^2)$ dp\uff0c\u5728\u8fd9\u9053\u9898\u91cc\u4f1a\u8d85\u65f6\u3002\u8fd9\u91cc\u6211\u91c7\u7528\u7684\u662f\u6811\u72b6\u6570\u7ec4\u4f18\u5316\u8f6c\u79fb\u7684 $O(n\\log(n))$ \u7684\u505a\u6cd5\u3002\uff08\u5f53\u7136\u6743\u503c\u7ebf\u6bb5\u6811\u548c\u4e8c\u5206\u90fd\u53ef\u4ee5\u505a\u5230 $O(n\\log(n))$\uff09\u3002\n\n## 2.\u6c42\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684\u4e2a\u6570\n\u4e3a\u65b9\u4fbf\u8bb2\u89e3\uff0c\u8fd9\u91cc\u6cbf\u7528\u697c\u4e0a\u5927\u725b\u7684\u56fe\u7247\u3002\n\n![](https://img-blog.csdnimg.cn/img_convert/bc11a0ef9186b4536572ab0ad1d9a4a1.png)\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5728\u6c42\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u627e\u5230\u5728\u4e00\u4e2a\u70b9\u524d\u9762\u6700\u591a\u80fd\u63a5\u4e0a\u591a\u957f\u7684\u5e8f\u5217\uff0c\u518d\u52a0\u8fd9\u4e2a\u503c\u52a0\u4e00\uff0c\u4fbf\u662f\u8fd9\u4e2a\u70b9\u7684 LIS\uff0c\u4e8e\u662f\u6211\u4eec\u4fbf\u5c06\u8fd9\u4e9b\u70b9\u4ee5\u4e0b\u6807\u4e3a\u6a2a\u5750\u6807\uff0c\u6743\u503c\u4e3a\u7eb5\u5750\u6807\u5efa\u7acb\u4e00\u4e2a\u5e73\u9762\u76f4\u89d2\u5750\u6807\u7cfb\uff0c\u7136\u540e\u6211\u4eec\u5c06 LIS \u76f8\u540c\u7684\u70b9\u653e\u5728\u4e00\u8d77\uff0cLIS \u4e0d\u540c\u7684\u70b9\u4e4b\u95f4\u5212\u6761\u7ebf\uff0c\u53ef\u4ee5\u53d1\u73b0\u6bcf\u4e00\u5757\u4e4b\u95f4\u4ece\u5de6\u5f80\u53f3\uff0c\u6743\u503c\u90fd\u662f\u5355\u8c03\u9012\u51cf\u7684\uff08\u8fd9\u662f\u6211\u4eec\u540e\u9762\u4f18\u5316\u590d\u6742\u5ea6\u7684\u91cd\u8981\u7ed3\u8bba\uff09\uff0c\u8fd9\u4e2a\u7ed3\u8bba\u53ef\u4ee5\u901a\u8fc7\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684\u5b9a\u4e49\u8bc1\u660e\u5f97\u51fa\u3002\u90a3\u4e48\u600e\u4e48\u627e\u5230\u4e00\u6761\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u5462\uff1f\u53ef\u4ee5\u53d1\u73b0\u53ea\u8981\u5728\u6bcf\u4e00\u5c42\u4e4b\u95f4\u627e\u5230\u4e00\u4e2a\u70b9\uff0c\u5e76\u4e14\u4ece\u5de6\u5f80\u53f3\u6ee1\u8db3\u6743\u503c\u5355\u8c03\u9012\u589e\u5373\u53ef\u3002\u90a3\u4e48\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2a\u663e\u7136\u7684\u8d2a\u5fc3\uff0c\u5c31\u662f\u4e24\u5c42\u4e4b\u95f4\uff0c\u5728\u90a3\u4e00\u5c42\u4e2d\u6743\u503c\u8f83\u5c0f\u7684\u70b9\u8fde\u5728\u53e6\u4e00\u5c42\u4e2d\u6743\u503c\u8f83\u5c0f\u7684\u70b9\uff0c\u5728\u90a3\u4e00\u5c42\u4e2d\u6743\u503c\u8f83\u5927\u7684\u70b9\u8fde\u5728\u53e6\u4e00\u5c42\u6743\u503c\u8f83\u5927\u7684\u70b9\u4e00\u5b9a\u6bd4\u5728\u90a3\u4e00\u5c42\u4e2d\u6743\u503c\u5c0f\u7684\u70b9\u8fde\u5728\u53e6\u4e00\u5c42\u6743\u503c\u5927\u7684\u70b9\uff0c\u5728\u90a3\u4e00\u5c42\u4e2d\u6743\u503c\u5927\u7684\u70b9\u8fde\u5728\u53e6\u4e00\u5c42\u6743\u503c\u5c0f\u7684\u70b9\u66f4\u4f18\u3002\uff08\u6709\u70b9\u7ed5\uff0c\u6162\u6162\u7406\u89e3\u4e00\u4e0b\uff09\uff0c\u610f\u8bc6\u5730\u8bf4\u5c31\u662f\u8fd9\u6837\u505a\u6709\u66f4\u5927\u7684\u53ef\u80fd\u6709\u66f4\u591a\u7684\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\uff0c\u8bc1\u660e\u53ef\u4ee5\u53c2\u8003\u697c\u4e0a\u5927\u725b\u3002\n\n# \u4ee3\u7801\u5b9e\u9a8c\n\u7531\u4e8e\u7ec6\u8282\u8f83\u591a\uff0c\u8fd9\u91cc\u7ed3\u5408\u4ee3\u7801\u6ce8\u91ca\u7406\u89e3\u4e00\u4e0b\n## AC \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,sum[4000005],p[1000005],ans,cnt=1;//p\u662f\u9898\u76ee\u4e2d\u7684\u5e8f\u5217\uff0csum\u662f\u6811\u72b6\u6570\u7ec4 \nvector<int> e[1000005],f[1000005];//e\u662f\u5b58\u7b54\u6848\u7684\u6570\u7ec4\uff0cf\u662f\u5b58\u5404\u4e2a\u5c42\u4e0a\u6570\u5b57\u7684\u6570\u7ec4 \nint lowbit(int x){\n\treturn x&-x;\n}\nvoid modify(int x,int v){//\u6811\u72b6\u6570\u7ec4\u5355\u70b9\u4fee\u6539 \n\tfor(int i=x;i<=n;i+=lowbit(i)){\n\t\tif(i==x)sum[i]=v;\n\t\tsum[i]=max(sum[i],v);\n\t}\n\treturn ;\n}\nint query(int x){//\u6811\u72b6\u6570\u7ec4\u67e5\u8be2 \n\tint ret=0;\n\tfor(int i=x;i;i-=lowbit(i)){\n\t\tret=max(ret,sum[i]);\n\t}\n\treturn ret;\n}\nvoid dfs(int k,int t,int past){//k\u8868\u793a\u70b9\u7684\u7f16\u53f7\uff0ct\u8868\u793a\u5c42\u6570\uff0cpast\u8868\u793a\u8fc7\u53bb\u7684cnt\u7684\u503c\u662f\u591a\u5c11 \n\tif(t==ans){\n\t\tcnt++;//\u5982\u679c\u627e\u5230\u4e00\u7ec4\u7b54\u6848\uff0c\u90a3\u4e48\u6539\u53d8cnt\u7684\u503c\uff0c\u4ee5\u4fbf\u9000\u51fa \n\t\treturn;\n\t}\n\tfor(int i=f[t+1].size()-1;i>=0;i--){//\u5012\u5e8f\u679a\u4e3e\uff0c\u56e0\u4e3a\u6bcf\u4e00\u5c42\u7684\u503c\u6ee1\u8db3\u5355\u8c03\u9012\u51cf \n\t\tif(p[k]>p[f[t+1][i]]){//\u5982\u679c\u4e0b\u4e00\u5c42\u7684\u70b9\u6bd4\u8fd9\u4e2a\u8fd8\u5c0f\uff0c\u90a3\u4e00\u5b9a\u6ca1\u6709\u8d21\u732e\uff0c\u76f4\u63a5\u5220\u9664 \n\t\t\tf[t+1].pop_back();\n\t\t\tcontinue;\n\t\t}\n\t\tif(!f[t+1].size()||k>f[t+1][i]){//\u5982\u679c\u5339\u914d\u597d\u7684\u8fd9\u4e2a\u70b9\u4e0d\u6ee1\u8db3\u6761\u4ef6\u8fd4\u56de\u4e0a\u4e00\u5c42\u5faa\u73af \n\t\t\te[cnt].pop_back();\n\t\t\treturn;\n\t\t} \n\t\tint d=f[t+1][i];\n\t\te[cnt].push_back(f[t+1][i]);f[t+1].pop_back();//\u9012\u5f52\u7684\u8fc7\u7a0b\u4e2d\u81ea\u52a8\u5b58\u50a8\u7b54\u6848 \n\t\tdfs(d,t+1,cnt);\n\t\tif(cnt!=past) return;//\u5982\u679c\u8fd9\u6b21\u8fdb\u5165\u627e\u5230\u89e3\u4e86\uff0c\u9000\u51fa \n\t}\n}\nsigned main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++){//\u8ba1\u7b97\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684\u957f\u5ea6\u5e76\u6309\u7167\u5c42\u6570\u8fdb\u884c\u81ea\u52a8\u5206\u5c42 \n\t\tscanf(\"%d\",&p[i]);\n\t\tint d=query(p[i])+1;\n\t\tf[d].push_back(i);\n\t\tmodify(p[i],d);\n\t\tans=max(ans,d);\n\t}\n\tfor(int i=f[1].size()-1;i>=0;i--){//\u5c06\u7b2c\u4e00\u5c42\u7684\u6bcf\u4e2a\u70b9\u90fd\u653e\u8fdb\u53bb\u8dd1\u4e00\u904d \n\t\tint d=f[1][i];\n\t\te[cnt].push_back(f[1][i]);\n\t\tf[1].pop_back();\n\t\tdfs(d,1,cnt);\n\t}\n\tcnt--;//\u56e0\u4e3a\u6700\u540e\u4e00\u7ec4\u6ca1\u6709\u627e\u5b8c\uff0c\u6240\u4ee5\u51cf \n\tprintf(\"%d %d\\n\",cnt,ans);\n\tfor(int i=1;i<=cnt;i++){\n\t\tfor(int j=0;j<e[i].size();++j) printf(\"%d \",e[i][j]);\n\t\tprintf(\"\\n\");\n\t}\n\treturn 0;\n}\n```\n\n## \u7ec6\u8282\n1. \u8fd9\u91cc\u6211\u7684 f \u6570\u7ec4\u91cc\u9762\u7684\u503c\u90fd\u662f\u4ece\u5c0f\u5230\u5927\u7684\uff0c\u4fdd\u8bc1\u521a\u521a\u5355\u8c03\u9012\u51cf\u7684\u6027\u8d28\u3002\n\n2. 51-59 \u884c\uff0c\u4e2d\u5c06\u7b2c\u4e00\u5c42\u7684\u6bcf\u4e2a\u70b9\u90fd\u62ff\u6765\u8dd1\u4e00\u904d\uff0c\u56e0\u4e3a\u6bcf\u4e00\u5c42\u90fd\u8981\u8d21\u732e\u4e00\u4e2a\u70b9\uff0c\u6240\u4ee5\u8fd9\u4e48\u5199\u3002\n\n3. 27-41 \u884c\uff0c\u8fd9\u662f\u9898\u76ee\u7684\u6838\u5fc3\u6240\u5728\uff0c\u8fd9\u91cc\u80fd\u5220\u70b9\u7684\u65f6\u5019\u8981\u5220\u70b9\uff0c\u9632\u6b62 TLE\uff0c\u597d\u597d\u7406\u89e3\u4e00\u4e0b\n\n4. \u8fd9\u91cc\u6211\u91c7\u7528\u7684\u56e0\u4e3a\u662f\u641c\u7d22\uff0c\u590d\u6742\u5ea6\u6709\u70b9\u7384\u5b66\uff0c\u53e6\u5916\u6570\u636e\u6c34\u52c9\u5f3a\u80fd\u8fc7\u8fd9\u9053\u9898\u3002",
        "postTime": 1643095957,
        "uid": 399606,
        "name": "Mu_tr",
        "ccfLevel": 7,
        "title": "P7931 \u9898\u89e3"
    }
]
[
    {
        "content": "# \t\t\t\t\t\u6811\u7684\u91cd\u5fc3\n## Description\n\n------------\n\n\u7ed9\u4f60\u4e00\u68f5\u6811\uff0c\u6c42\u548c\u8fd9\u68f5\u6811\u91cd\u5fc3\u5b8c\u5168\u4e00\u6837\u7684\u5b50\u6811\u4e2a\u6570%10007\n\n\n------------\n\n## Solve\n#### \uff08\u81ea\u8ba4\u4e3a\u4f5c\u6cd5\u6bd4\u8f83\u795e\u5947\uff0c\u4ee5\u4e0b\u5185\u5bb9\u8bf7\u8c28\u614e\u9605\u8bfb\uff09\n### \u91cd\u5fc3\u5b9a\u4e49\uff1a\u65ad\u5f00\u540e\uff0c\u4fdd\u8bc1\u6700\u5927\u8054\u901a\u5757\u8282\u70b9\u6700\u5c11\n\n------------\n\n\u6211\u4eec\u5148\u6765\u63a8\u63a8\u91cd\u5fc3\u7684\u6027\u8d28\uff1a\u6bcf\u4e2a\u8054\u901a\u5757\u8282\u70b9\u6570<=\u603b\u8282\u70b9\u6570/2\n### \u5148\u8bc1\u5145\u5206\u6027\uff1a\u91cd\u5fc3\u4fdd\u8bc1\u6bcf\u4e2a\u8054\u901a\u5757\u8282\u70b9\u6570<=\u603b\u8282\u70b9\u6570/2\n\u6bd4\u8f83\u663e\u7136\uff0c\u53cd\u4e4b\u91cd\u5fc3\u53ef\u4ee5\u5f80\u6700\u5927\u7684\u8054\u901a\u5757\u4e0b\u79fb\n### \u5fc5\u8981\u6027\uff1a\u6bcf\u4e2a\u8054\u901a\u5757\u8282\u70b9\u6570<=\u603b\u8282\u70b9\u6570/2\uff0c\u4e00\u5b9a\u662f\u91cd\u5fc3\n\u8bc1\u660e\uff1a\u82e5\u8981\u8ba9\u6700\u5927\u8282\u70b9\u53d8\u5c0f\n\n![](http://a4.qpic.cn/psb?/V11WHhsI2kAdLw/8HQm75cg6xD1vPkVuFSYcfH4JGry9T2mnFQ2eEchUk4!/c/dFMBAAAAAAAA&ek=1&kp=1&pt=0&bo=bwJgAW8CYAERADc!&tl=1&tm=1566288000&sce=0-12-12&rf=0-18)\n\n------------\n\u91cd\u5fc3\u5f80\u6700\u5927\u8054\u901a\u5757\u79fb\u52a8\uff0c\u800c\u65b0\u4ea7\u751f\u7684\u8054\u901a\u5757\u8282\u70b9\u6570\u5c31>=\u603b\u8282\u70b9\u6570/2\n\n\n------------\n \n\u6211\u4eec\u518d\u770b\u770b\u4e24\u4e2a\u91cd\u5fc3\u6709\u4ec0\u4e48\u6027\u8d28\uff1a\n![](http://a3.qpic.cn/psb?/V11WHhsI2kAdLw/kJgwHlgpzDG6z*O0jyE23ycywE2aBF3Lmw6yfqXlD.Q!/c/dL4AAAAAAAAA&ek=1&kp=1&pt=0&bo=mQJTAZkCUwERADc!&tl=1&tm=1566288000&sce=0-12-12&rf=0-18)\n \n\u610f\u601d\u5c31\u662f\u8bf4\u8fd9\u65f6\u5019\u6700\u5927\u8054\u901a\u5757\u521a\u597d\u4e3a:\u603b\u8282\u70b9\u6570/2\n\n------------\n\u8fd9\u4e24\u4e2a\u91cd\u5fc3\u76f8\u90bb\n\u6211\u4eec\u5148\u627e\u5230\u91cd\u5fc3\uff0c\u628a\u4e00\u4e2a\u4f5c\u4e3a\u6811\u7684\u6839\uff0c\u91cd\u65b0\u7edf\u8ba1\u5b50\u6811\u6570\u91cf\uff0c\u5e76dp\n\n\n------------\n\nF[i][j]\u5728\u4ee5i\u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u9009j\u4e2a\u8054\u901a(\u8981\u8fdei)\u7684\u70b9\u6709\u591a\u5c11\u79cd\u9009\u6cd5         \n\u679a\u4e3ex\u7684\u513f\u5b50y\uff0c\u5e76\u679a\u4e3ey\u9009\u51e0\u4e2a\u8054\u901a    \nf[x][k]=(f[x][k]+f[y][j]*f[x][k-j])%mod;                            \n\n\n------------\n\n\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u53ef\u4ee5\u5206\u7c7b\u8ba8\u8bba\uff1a            \n#### 1\u3001\u5f53\u6709\u4e24\u4e2a\u91cd\u5fc3\u65f6                       \n\n------------\n\u6bd4\u8f83\u597d\u5904\u7406\uff0c\u6211\u4eec\u628a\u91cd\u5fc31\u4f5c\u4e3a\u4e86\u6839\uff0c\u53ea\u9700\u8981\u5728\u9664\u91cd\u5fc32\u7684\u5b50\u6811\u91ccdp\uff0c\u8981\u6ee1\u8db3\u91cd\u5fc32\u5b50\u6811\u91cc\u9009\u7684\u70b9\u6570=\u5176\u4ed6\u5b50\u6811\u9009\u7684\u5b50\u6811\u548c+1\n\u4e3e\u4e2a\u6817\u5b50\uff1a\n![](http://a4.qpic.cn/psb?/V11WHhsI2kAdLw/XvS5QJwJe8jqa1Cyuzz87mWG3ApVe1xOmGb98CiuaX0!/c/dL8AAAAAAAAA&ek=1&kp=1&pt=0&bo=YQONAWEDjQERADc!&tl=1&tm=1566288000&sce=0-12-12&rf=0-18)\n\n------------\n\n\u8bbew[i]\uff0c\u5df2\u7ecf\u9009\u4e86i\u4e2a\u8282\u70b9\u7684\u65b9\u6848\u6570                         \n\u679a\u4e3e\u5b50\u6811y\u9009\u62e9j\u4e2a\uff0c\u7136\u540ew[i]=(w[i]+w[i-j] * f[y][j])%mod           \n\u7c7b\u4f3c\u6811\u5f62dp\uff0c\u4f46\u6211\u4eec\u53ea\u9700\u679a\u4e3e\u91cd\u5fc31\u7684\u76f4\u7cfb\u513f\u5b50                   \n\u6700\u540e\u679a\u4e3e\u91cd\u5fc32\u9009i\u4e2a\uff0cans+=f[\u91cd\u5fc32][i] * w[i];                     \n#### 2\u3001\u6709\u4e00\u4e2a\u91cd\u5fc3\u65f6\n\n------------\n\n\u6211\u4eec\u8bbeg[i][j]\u8868\u793a\u5171\u9009\u4e86i\u4e2a\u8282\u70b9\uff0c\u5b50\u6811\u6700\u5927\u8054\u901a\u5757\u4e3aj\u7684\u65b9\u6848\u6570           \n\u5bf9\u4e8e\u6bcf\u4e2a\u5b50\u6811y\n\u5916\u5c42\u679a\u4e3ei\uff08\u5012\u5e8f\uff01\uff01\uff01\uff01\uff01\uff01\uff09                \n\u5185\u5c42\u679a\u4e3e\u8be5\u5b50\u6811\u9009j\u4e2a               \n\u7531\u4e8e\u61d2\u5f97\u521d\u59cb\u5316\uff0c\u6211\u4eec\u8fd8\u8981\u7279\u5224i=j\u65f6\uff0cg[i][j]+=f[y][j]\uff08\u4e0d\u7136g[0][j] * f[y][j]=0\uff09                \n\u7136\u540e\u5bf9\u4e8eg\u7684\u9012\u63a8 ,\u56e0\u4e3ay\u5b50\u6811\u9009\u4e86j\u4e2a\u540e\u53ef\u80fd\u53d6\u4ee3\u539f\u6765\u6700\u5927\u8054\u901a\u5757\u6210\u4e3a\u65b0\u7684\u6700\u5927\u8054\u901a\u5757\uff0c\u6545\u6211\u4eec\u8fd8\u8981\u5728\u9012\u63a8\u65f6\u8003\u8651\u539f\u6765\u6700\u5927\u8054\u901a\u5757\u548cj\u8c01\u5927               \n\u6700\u5185\u5c42\u679a\u4e3e\u524d\u9762\u6700\u5927\u8054\u901a\u5757t                     \ng[i][max(j,t)]+=g[i-j][t] * f[y][j]                 \n\u5bf9\u4e8e\u7b54\u6848\u7684\u7edf\u8ba1          \n\u6839\u636e\u91cd\u5fc3\u5b9a\u4e49\uff0c\u53ea\u8981\u6700\u5927\u8054\u901a\u5757*2<=\u603b\u8282\u70b9\u6570\n\u6545\u6211\u4eec\u679a\u4e3e\u9009\u4e86i\u4e2a\u8282\u70b9\uff0c\u5b50\u6811\u6700\u5927\u8054\u901a\u5757\u4e3aj               \nif(j*2<=(i+1))ans+=g[i][t];\n\u6700\u540e\u8fd8\u8981ans++\uff0c\u56e0\u4e3a\u6ca1\u6709\u7edf\u8ba1\u53ea\u6709\u91cd\u5fc3\u7684\u60c5\u51b5\n```\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n#include<queue>\nusing namespace std;\nint n,cnt,h[201],f[201][201],k,zx1,zx2,ans,son[201],mod=10007,g[201][201],w[201];\nstruct pp\n{\n\tint to,next;\n}a[201*2];\nvoid add(int x,int y)\n{\n\tcnt++;a[cnt].to=y;a[cnt].next=h[x];h[x]=cnt;\n}\nvoid find(int x,int fa)\n{\n\tint maxx=0;son[x]=1;\n\tfor(int i=h[x];i;i=a[i].next)\n\t{\n\t\tint y=a[i].to;\n\t\tif(y==fa)continue;\n\t\tfind(y,x);son[x]+=son[y];maxx=max(son[y],maxx);\n\t}\n\tif(n-son[x]>maxx)maxx=n-son[x];\n\tif(maxx<ans)ans=maxx,k=1,zx1=x;\n\telse if(maxx==ans)k=2,zx2=x;\n\t\n}\nvoid pre(int x,int fa)\n{\n\tf[x][0]=0;f[x][1]=1;son[x]=1;\n\tfor(int i=h[x];i;i=a[i].next)\n\t{\n\t\tint y=a[i].to;\n\t\tif(y==fa)continue;\n\t\tpre(y,x);son[x]+=son[y];\n\t\tfor(int k=son[x];k>=1;k--)\n\t\tfor(int j=1;j<=min(son[y],k-1);j++)\n\t\tf[x][k]=(f[x][k]+f[y][j]*f[x][k-j])%mod;\n\t}\n}\nvoid solve1(int q,int x)\n{\n\tpre(x,0);int ans1=0,tot=0,mx=0;\n\tfor(int i=h[x];i;i=a[i].next)\n\t{\n\t\tint y=a[i].to;\n\t\ttot+=son[y];mx=max(mx,son[y]);\n\t\tfor(int j=tot;j>=1;j--)\n\t\tfor(int u=min(j,son[y]);u>=1;u--)\n\t\t{\n\t\t\tif(j==u)\n\t\t\t{\n\t\t\t\tg[j][u]=(g[j][u]+f[y][u])%mod;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tfor(int t= 1;t<=mx&&t<=j;t++)\n\t\t\t{\n\t\t\t\tg[j][max(t,u)]=(g[j][max(t,u)]+g[j-u][t]*f[y][u])%mod;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int j=1;j<=tot;j++)\n\tfor(int t=1;t<=mx;t++)\n\tif(t*2<(j+1))ans1=(ans1+g[j][t])%mod;\n\tprintf(\"Case %d: %d\\n\",q,(ans1+1)%mod);\t\n\t\n}\nvoid solve2(int q)\n{\n\tpre(zx1,0);int ans1=0,tot=0;\n\tw[0]=1;\n\tfor(int i=h[zx1];i;i=a[i].next)\n\t{\n\t\tint y=a[i].to;\n\t\tif(y==zx2)continue;tot+=son[y];\n\t\tfor(int j=min(tot,son[zx2]-1);j>=1;j--)\n\t\t{\n\t\t\tfor(int u=min(j,son[y]);u>=1;u--)\n\t\t\t{\n\t\t\t\tw[j]=(w[j]+w[j-u]*f[y][u])%mod;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=son[zx2]-1;i>=0;i--)\n\tans1=(ans1+w[i]*f[zx2][i+1])%mod;\n\tprintf(\"Case %d: %d\\n\",q,ans1%mod);\n}\nint main()\n{\n\tint Q,x,y;\n\tcin>>Q;\n\tfor(int q=1;q<=Q;q++)\n\t{\n\t\tmemset(h,0,sizeof(h));cnt=0;memset(son,0,sizeof(son));\n\t\tmemset(f,0,sizeof(f));memset(g,0,sizeof(g));\n\t\tscanf(\"%d\",&n);k=0;ans=0x7fffffff/2;\n\t\tfor(int i=1;i<n;i++)\n\t\tscanf(\"%d%d\",&x,&y),add(x,y),add(y,x);\n\t\tfind(1,0);\n\t\tmemset(son,0,sizeof(son));\n\t\tif(k==1)solve1(q,zx1);\n\t\telse solve2(q),memset(w,0,sizeof(w));\n\t}\n\treturn 0;\n}\n```\n\n\n",
        "postTime": 1566292611,
        "uid": 124076,
        "name": "\u7f04\u9ed8mio",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4582 \u3010[FJOI2014]\u6811\u7684\u91cd\u5fc3\u3011"
    },
    {
        "content": "[$\\Huge\\color{#814514}{\\tt My~Cnblogs}$](https://www.cnblogs.com/Wendigo/p/13086291.html)\n\n---\n[FJOI2014 \u6811\u7684\u91cd\u5fc3](https://www.luogu.com.cn/problem/P4582)\n\n> $Q$ \u7ec4\u6d4b\u8bd5\u6570\u636e\u3002\u7ed9\u4e00\u68f5\u6811\u5927\u5c0f\u4e3a $n$\uff0c\u6c42\u6709\u591a\u5c11\u4e2a\u5b50\u6811\u4e0e\u5176\u91cd\u5fc3\u76f8\u540c\u3002\u91cd\u5fc3\u53ef\u80fd\u6709\u591a\u4e2a\u3002\n\n> \u6570\u636e\u8303\u56f4\uff1a$1\\le Q\\le 50$\uff0c$1\\le n\\le 200$\u3002\n\n---\n\u5c31\u662f\u8981\u5199\u597d\u51e0\u4e2a $\\tt dp$ \u5427\uff0c\u7ec6\u8282\u6bd4\u8f83\u591a\u3002\n\n---\n\u5148 $\\tt Dfs$ \u4e00\u6b21\u627e\u4e2a\u91cd\u5fc3\uff1a\n\n```cpp\nint sz[N+7],g[N+7];\nint Dfs1(int u,int fa){\n\tint res=inf;\n\tsz[u]=1,g[u]=0;\n\tfor(int&v:e[u])if(v!=fa){\n\t\tres=min(res,Dfs1(v,u));\n\t\tsz[u]+=sz[v],g[u]=max(g[u],sz[v]);\n\t}\n\tg[u]=max(g[u],n-sz[u]);\n\tres=min(res,g[u]);\n\treturn res;\n}\n//...\nint ms=Dfs1(1,0);\nvector<int> G;\nfor(int i=1;i<=n;i++)if(g[i]==ms) G.pb(i);\n```\n\u91cd\u5fc3\u53ea\u6709 $1$ \u4e2a\u6216 $2$ \u4e2a\uff0c\u4e8e\u662f\u5206\u7c7b\u8ba8\u8bba \u3002\n\n---\n- **\u6709 $2$ \u4e2a\u91cd\u5fc3**\n\n\u8bbe\u91cd\u5fc3\u4e3a $Gx$ \u548c $Gy$\u3002\n\n\u6240\u4ee5\u5fc5\u7136\u6709\u8fb9 $(Gx,Gy)$\u3002\n\n\u628a $(Gx,Gy)$ \u65ad\u5f00\u540e\u4e24\u90e8\u5206\u5b50\u6811\u5fc5\u7136\u662f\u76f8\u7b49\u7684\uff08\u8981\u4e0d\u7136\u5c31\u53ea\u6709 $1$ \u4e2a\u91cd\u5fc3\uff09\u3002\n\n**\u6240\u4ee5\u53ef\u4ee5\u5728\u4e24\u90e8\u5206\u5b50\u6811\u4ee5 $Gx,Gy$ \u4e3a\u6839\u5404\u5199\u4e2a $\\tt dp$\uff1a**\n\n**$f_{u,i}$ \u8868\u793a $u$ \u70b9\u7684\u5b50\u6811\u9009 $i$ \u4e2a\u70b9\u7684\u8054\u901a\u5b50\u6811\uff08\u5305\u62ec $u$ \u70b9\uff09\u7684\u65b9\u6848\u6570\u3002**\n\n$$f_{u,i}=\\sum_{v\\in son_u}\\sum_{j=1}^{\\min(i-1,sz_v)}f_{u,i-j}\\cdot f_{v,j}$$\n\n\u7136\u540e $Ans=\\sum_{i=1}^{\\min(sz_{Gx},sz_{Gy})}f_{Gx,i}\\cdot f_{Gy,i}$\u3002\n\n\u4e0d\u8fc7\u5199\u4e24\u6b21\u6811\u5f62 $\\tt dp$ \u9ebb\u70e6\uff0c\u6211\u7684\u4ee3\u7801\u4e2d\u7701\u4e86\u4e2a\u6811\u5f62 $\\tt dp$\u3002\n\n---\n- **\u6709 $1$ \u4e2a\u91cd\u5fc3**\n\n\u8bbe\u91cd\u5fc3\u4e3a $G$\u3002\n\n\u6240\u4ee5\u9009\u51fa\u5b50\u6811\u4e2d $G$ \u70b9\u7684**\u6bcf\u4e2a\u5b50\u6811\u5927\u5c0f** $\\le$ **\u6240\u6709\u5b50\u6811\u5927\u5c0f\u4e4b\u548c**\u7684 $\\frac 12$\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u5148\u5982\u4e0a\u8dd1\u4e2a $\\tt dp$\uff0c\u4ee5 $G$ \u4e3a\u6839\u5f97\u51fa\u540c\u4e0a\u7684 $f_{i,j}$\u3002\n\n**$F_{i,j}$ \u9009\u51fa\u5b50\u6811\u5171 $i$ \u4e2a\u70b9\uff08\u9664\u4e86 $G$\uff09\uff0c\u6700\u5927\u5b50\u6811\u5927\u5c0f\u4e3a $j$ \u7684\u65b9\u6848\u6570\u3002**\n\n**\u6240\u4ee5\u521d\u59cb\u5316 $F_{i,i}=\\sum_{v\\in son_G}f_{v,i}$\u3002**\n\n$${\\rm Then}\\forall k\\in[1,i]:F_{i,\\max(j,k)}+=F_{i-j,k}\\cdot f_{v,j}$$\n\n\u6700\u540e $Ans=1+\\sum_{i=1}^n\\sum_{j=1}^n[2j\\le i]F_{i,j}$\u3002\n\n> \u4e3a\u4ec0\u4e48\u8981 $+1$\uff1f\u8868\u793a\u53ea\u9009 $G$ \u70b9\u7684\u60c5\u51b5\u3002\n\n---\n- **\u4ee3\u7801**\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n//Start\ntypedef long long ll;\ntypedef double db;\n#define mp(a,b) make_pair(a,b)\n#define x first\n#define y second\n#define b(a) a.begin()\n#define e(a) a.end()\n#define sz(a) int((a).size())\n#define pb(a) push_back(a)\nconst int inf=0x3f3f3f3f;\nconst ll INF=0x3f3f3f3f3f3f3f3f;\n\n//Data\nconst int N=200,P=1e4+7;\nint n;\nvector<int> e[N+7];\n\n//Treedp\nint sz[N+7],g[N+7],f[N+7][N+7];\nint Dfs1(int u,int fa){\n\tint res=inf;\n\tsz[u]=1,g[u]=0;\n\tfor(int&v:e[u])if(v!=fa){\n\t\tres=min(res,Dfs1(v,u));\n\t\tsz[u]+=sz[v],g[u]=max(g[u],sz[v]);\n\t}\n\tg[u]=max(g[u],n-sz[u]);\n\tres=min(res,g[u]);\n\treturn res;\n}\nvoid Dfs2(int u,int fa){\n\tsz[u]=f[u][0]=f[u][1]=1;\n\tfor(int&v:e[u])if(v!=fa){\n\t\tDfs2(v,u),sz[u]+=sz[v];\n\t\tfor(int i=sz[u];i>=1;i--)\n\t\t\tfor(int j=1;j<=min(sz[v],i-1);j++)\n\t\t\t\t(f[u][i]+=f[u][i-j]*f[v][j]%P)%=P;\t\t\t\n\t}\n}\n\n//KonnyWen\nint F1[N+7][N+7],F2[N+7];\nint KonnyWen(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++) e[i].clear();\n\tfor(int i=1,u,v;i<=n-1;i++){\n\t\tscanf(\"%d%d\",&u,&v);\n\t\te[u].pb(v),e[v].pb(u);\n\t}\n\tint ms=Dfs1(1,0);\n\tvector<int> G;\n\tfor(int i=1;i<=n;i++)if(g[i]==ms) G.pb(i);\n//\tputs(\"G:\");\n//\tfor(int&x:G) printf(\"%d \",x);puts(\"\");\n\tmemset(f,0,sizeof f),Dfs2(G[0],0);\n//\tputs(\"f:\");\n//\tfor(int i=1;i<=n;i++)\n//\t\tfor(int j=1;j<=n;j++)\n//\t\t\tprintf(\"%d%c\",f[i][j],\"\\n \"[j<n]);\n\tint sm=0,res=0; \n\tif(sz(G)==1){\n\t\tmemset(F1,0,sizeof F1),ms=-inf;\n\t\tfor(int&v:e[G[0]]){\n\t\t\tms=max(ms,sz[v]),sm+=sz[v];\n\t\t\tfor(int i=sm;i>=1;i--)\n\t\t\t\tfor(int j=min(sz[v],i);j>=1;j--){\n\t\t\t\t\tif(j==i) (F1[i][j]+=f[v][j])%=P;\n\t\t\t\t\telse for(int k=1;k<=min(i,ms);k++)\n\t\t\t\t\t\t(F1[i][max(j,k)]+=F1[i-j][k]*f[v][j]%P)%=P;\n\t\t\t\t}\n\t\t}\n//\t\tputs(\"F1:\");\n//\t\tfor(int i=1;i<=n;i++)\n//\t\t\tfor(int j=1;j<=n;j++)\n//\t\t\t\tprintf(\"%d%c\",F1[i][j],\"\\n \"[j<n]);\n\t\tfor(int i=1;i<=sm;i++)\n\t\t\tfor(int j=1;j<=i;j++)\n\t\t\t\tif(j*2<=i) (res+=F1[i][j])%=P;\n\t\tres++;\n\t} else if(sz(G)==2){ //\u4e00\u6b21\u6811\u5f62 dp \u4ee3\u66ff\u4e24\u6b21\n\t\tmemset(F2,0,sizeof F2),F2[0]=1;\n\t\tfor(int&v:e[G[0]])if(v!=G[1]){\n\t\t\tsm+=sz[v];\n\t\t\tfor(int i=sm;i>=1;i--)\n\t\t\t\tfor(int j=1;j<=min(sz[v],i);j++)\n\t\t\t\t\t(F2[i]+=F2[i-j]*f[v][j]%P)%=P;\n\t\t}\n//\t\tputs(\"F2:\");\n//\t\tfor(int i=1;i<=n;i++) printf(\"%d \",F2[i]);puts(\"\");\n\t\tfor(int i=1;i<=sm+1;i++)\n\t\t\t(res+=F2[i-1]*f[G[1]][i]%P)%=P;\n\t}\n\treturn res;\t\n}\n\n//Main\nint main(){\n\tint t; scanf(\"%d\",&t);\n\tfor(int i=1;i<=t;i++) \n\t\tprintf(\"Case %d: %d\\n\",i,KonnyWen());\n\treturn 0;\n}\n```\n---\n**\u795d\u5927\u5bb6\u5b66\u4e60\u6109\u5feb\uff01**",
        "postTime": 1591781554,
        "uid": 118365,
        "name": "George1123",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4582 \u3010[FJOI2014]\u6811\u7684\u91cd\u5fc3\u3011"
    },
    {
        "content": "\u6211\u4eec\u53ef\u4ee5\u5206\u522b\u8ba8\u8bba1\u4e2a\u548c2\u4e2a\u4e24\u4e2a\u4e2d\u5fc3\u7684\u60c5\u51b5\uff1a\n1. 1\u4e2a\uff1a\u8003\u8651\u7528\u6811\u5f62dp\u6765\u6c42\u6700\u7ec8\u7684\u7b54\u6848\uff0c\u76f4\u63a5\u4ee5\u91cd\u5fc3\u4e3a\u6839\uff0c\u679a\u4e3e\u8282\u70b9\u6570\uff0c\u7528$f_{i,j}$\u8868\u793a\u4ee5$i$\u4e3a\u6839\uff0c\u9009$j$\u4e2a\u8282\u70b9\u7684\u7b54\u6848\u6570\uff0cdp\u7684\u72b6\u6001\u8f6c\u79fb\u548c[\u6d1b\u8c37P4322 [JSOI2016]\u6700\u4f73\u56e2\u4f53](https://www.luogu.com.cn/blog/jacky0705/solution-p4322)\u6709\u70b9\u50cf\n2. 2\u4e2a\uff1a\u76f4\u63a5\u5bf9\u4e24\u4e2a\u91cd\u5fc3\u5206\u522b\u6c42\u51fa\u7b54\u6848\uff0c\u5229\u7528\u4e58\u6cd5\u539f\u7406\u6c42\u51fa\u6700\u7ec8\u7684\u7b54\u6848\n\n\u9644\u4e0a\u4ee3\u7801\uff1a\n```cpp\n#include<iostream>\n#include<cstring>\n#include<cstdio>\nusing namespace std;\nint n,tot,root,ans,MOD=10007,head[210],big[210],size[210],f[210][210],temp[210];\nstruct ppap\n{\n\tint to,nxt;\n}e[410];\nvoid add(int u,int v)\n{\n\te[++tot].nxt=head[u],e[tot].to=v,head[u]=tot;\n}\nvoid getroot(int x,int fa)\n{\n\tsize[x]=1,big[x]=0;\n\tfor(int i=head[x];i;i=e[i].nxt) if(e[i].to!=fa)\n\t\tgetroot(e[i].to,x),size[x]+=size[e[i].to],big[x]=max(big[x],size[e[i].to]);\n\tbig[x]=max(big[x],n-size[x]);\n\tif(big[x]<=big[root]||(!root)) root=x;\n}\nvoid dfs(int x,int fa)\n{\n\tsize[x]=f[x][0]=f[x][1]=1;\n\tfor(int i=head[x];i;i=e[i].nxt) if(e[i].to!=fa){ \n\t\tdfs(e[i].to,x);\n\t\tfor(int j=1;j<=size[x]+size[e[i].to];j++) temp[j]=0;\n\t\tfor(int j=1;j<=size[x];j++) for(int k=0;k<=size[e[i].to];k++)\n\t\t\ttemp[j+k]=(temp[j+k]+f[x][j]*f[e[i].to][k]%MOD)%MOD;\n\t\tsize[x]+=size[e[i].to];\n\t\tfor(int j=1;j<=size[x];j++) f[x][j]=temp[j];\n    }\n}\nvoid solve1(int x)\n{\n\tmemset(f,0,sizeof(f));\n\tdfs(x,0);\n\tfor(int i=1;i<=n;i++){\n\t\tmemset(f[x],0,sizeof(f[x])),size[x]=f[x][0]=f[x][1]=1;\n\t\tfor(int j=head[x];j;j=e[j].nxt){\n\t\t\tfor(int k=1;k<=size[x]+size[e[j].to];k++) temp[k]=0;\n\t\t\tfor(int k=1;k<=size[x];k++) for(int l=0;l<=size[e[j].to];l++){\n\t\t\t\tif(l*2>=i) break;\n\t\t\t\ttemp[k+l]=(temp[k+l]+f[x][k]*f[e[j].to][l]%MOD)%MOD;\n\t\t\t}\n\t\t\tsize[x]+=size[e[j].to];\n\t\t\tfor(int k=1;k<=size[x];k++) f[x][k]=temp[k];\n\t\t}\n\t\tans=(ans+f[x][i])%MOD;\n\t}\n}\nvoid solve2(int x,int y)\n{\n\tmemset(f,0,sizeof(f));\n\tdfs(x,y),dfs(y,x);\n\tfor(int i=1;i<=n;i++) ans=(ans+f[x][i]*f[y][i]%MOD)%MOD;\n}\nint main()\n{\n\tint test=0,T;\n\tscanf(\"%d\",&T);\n\twhile(T--){\n\t\ttest++,memset(head,0,sizeof(head)),tot=ans=0;\n\t\tscanf(\"%d\",&n);\n\t\tfor(int i=1,x,y;i<n;i++) scanf(\"%d%d\",&x,&y),add(x,y),add(y,x);\n\t\troot=0,getroot(1,0);\n\t\tif(big[root]*2<n) solve1(root);\n\t\telse{\n\t\t\tint y;\n\t\t\tfor(int i=head[root];i>0;i=e[i].nxt){\n\t\t\t\ty=e[i].to;\n\t\t\t\tif(big[root]==size[y]) break;\n\t\t\t}\n\t\t\tsolve2(root,y);\n\t\t}\n\t\tprintf(\"Case %d: %d\\n\",test,ans);\n\t}\n}\n```",
        "postTime": 1585834921,
        "uid": 43373,
        "name": "jacky567",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4582 \u3010[FJOI2014]\u6811\u7684\u91cd\u5fc3\u3011"
    },
    {
        "content": "[P4582 [FJOI2014]\u6811\u7684\u91cd\u5fc3](https://www.luogu.com.cn/problem/P4582)\n\n\u8fd9\u662f\u6211\u7684\u7b2c 514 \u9053\u7d2b\u9898\uff01\u4e3a\u4e86\u7eaa\u5ff5\u8fd9\u4e2a\u65f6\u523b\uff0c\u5199\u7bc7\u9898\u89e3\uff08\n\n+ \u9884\u5904\u7406\n\n\u8bbe\u5728\u8282\u70b9 $u$ \u6240\u5728\u5b50\u6811\u9009\u62e9\u4e00\u4e2a\u5927\u5c0f\u4e3a $i$ \u4e14\u5305\u542b $u$ \u7684\u8054\u901a\u5757\u7684\u65b9\u6848\u6570\u4e3a $f(u,i)$ \uff0c\u5199\u6210 $\\rm OGF$ \u7684\u5f62\u5f0f\u5373 $F(u)=\\sum_{i=0}f(u,i)x^i$\u3002\n\n\u90a3\u4e48\u8f6c\u79fb\u5c31\u662f $F(u)=\\prod_{v\\in son(u)}F(v)$ \u3002\n\n\u6ce8\u610f\u6211\u4eec\u7b97\u7684\u662f\u201c\u5305\u542b $u$\u201d\u7684\uff0c\u6240\u4ee5\u5728\u628a\u513f\u5b50\u751f\u6210\u51fd\u6570\u5377\u8d77\u6765\u7684\u65f6\u5019\u8981\u8bbe $[x^0]F(u)=0,[x^1]F(u)=1$ \uff0c\u5728\u5377\u5b8c\u4e4b\u540e\u4e3a\u4e86\u65b9\u4fbf\u518d\u8bbe $[x^0]F(u)=1$ \uff0c\u56e0\u4e3a\u5bf9\u4e8e\u5b83\u7684\u7236\u4eb2\uff0c\u5b83\u662f\u53ef\u4ee5\u4e0d\u9009\u7684\u3002\n\n> \u663e\u7136\u91cd\u5fc3\u4e2a\u6570\u662f\u8981\u5206\u7c7b\u8ba8\u8bba\u7684\u3002\n\n+ \u6709\u4e24\u4e2a\u91cd\u5fc3\n\n\u8fd9\u4e2a\u6bd4\u8f83\u7b80\u5355\uff0c\u8bbe\u4e24\u4e2a\u91cd\u5fc3\u5206\u522b\u4e3a $rt_0,rt_1$\u3002\n\n\u8054\u901a\u5b50\u6811\u4ecd\u7136\u662f\u8fd9\u4e24\u4e2a\u91cd\u5fc3\u7684\u5145\u8981\u6761\u4ef6\u662f\uff1a\u8fd9\u4e24\u4e2a\u91cd\u5fc3\u6240\u5728\u8054\u901a\u5757\u5927\u5c0f\u76f8\u7b49\uff08\u6216\u8005\u8bf4\uff0c\u5b58\u5728\u4e00\u4e2a\u5b50\u6811\u7684\u5927\u5c0f\u4e3a $\\dfrac{siz}{2}$\uff09\u3002\n\n\u90a3\u4e48 \n\n$$\nans=\\sum_{i=1} [x^i]F(rt_0)\\times[x^i]F(rt_1)\n$$\n\n+ \u6709\u4e00\u4e2a\u91cd\u5fc3\n\n\u8bbe\u8054\u901a\u5b50\u6811\u7684\u5927\u5c0f\u4e3a $s$\u3002\u8fd9\u65f6\u5019\u91cd\u5fc3\u8fd8\u662f\u8fd9\u4e2a\u8282\u70b9\u7684\u5145\u8981\u6761\u4ef6\u662f\uff1a\u6240\u6709\u5b50\u8282\u70b9\u7684\u8054\u901a\u5757\u5927\u5c0f\u90fd\u5c0f\u4e8e $\\lceil\\dfrac{s}{2}\\rceil$\u3002\n\n\u4e0a\u53d6\u6574\u5176\u5b9e\u662f\u5206\u8ba8\u51fa\u6765\u7684 qwq\u3002\n\n\u5f53 $s$ \u4e3a\u5076\u6570\uff1a\u5982\u679c\u6709\u5b50\u6811\u5927\u5c0f\u4e3a $\\dfrac{s}{2}$ \uff0c\u90a3\u4e48\u8fd9\u9897\u6811\u5c31\u4f1a\u6709\u4e24\u4e2a\u91cd\u5fc3\uff0c\u6240\u4ee5\u8981 $<\\dfrac{s}{2}$\u3002\n\n\u5f53 $s$ \u4e3a\u5947\u6570\uff1a\u6bcf\u68f5\u5b50\u6811\u5927\u5c0f\u5c0f\u4e8e $\\lceil\\dfrac{s}{2}\\rceil$ \u5373\u53ef\n\n\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7c97\u66b4\u7684\u65b9\u6cd5\u5c31\u662f\u679a\u4e3e $s$\uff0c\u628a\u6240\u6709\u5b50\u8282\u70b9\u7684\u751f\u6210\u51fd\u6570\u53d6\u524d $s$ \u9879\u5377\u8d77\u6765\uff0c\u7136\u540e\u53d6\u7b2c $s$ \u9879\u5373\u53ef\u3002\n\n+ \u65f6\u95f4\u590d\u6742\u5ea6\n\n\u770b\u8d77\u6765\u6709\u70b9\u5047\uff0c\u4f46\u662f\u7b97\u4e00\u7b97\u521a\u597d\u3002\n\n\u9884\u5904\u7406\u90e8\u5206\uff0c\u6bcf\u4e2a $u$ \u662f $O(siz^2)$ \u7684\uff0c\u90a3\u4e48\u5c31\u662f $O(n^3)$ \u800c\u4e14\u8dd1\u4e0d\u6ee1\u3002\n\n\u6c42\u7b54\u6848\u7684\u90e8\u5206\uff1a\n\n\u6709\u4e24\u4e2a\u91cd\u5fc3\u5c31\u662f $O(n)$ \u7684\u3002\n\n\u6709\u4e00\u4e2a\u91cd\u5fc3\u5c31\u662f\uff0c\u679a\u4e3e\u7684 $O(n)$ \uff0c\u518d\u4e58\u4e0a\u5377\u79ef\u6240\u6709\u513f\u5b50\u751f\u6210\u51fd\u6570\u7684\u590d\u6742\u5ea6\uff0c\u8fd9\u4e2a\u662f $O(n^2)$ \u7684\uff0c\u4ecd\u7136\u8dd1\u4e0d\u6ee1\u3002\n\n\u590d\u6742\u5ea6\u4e0a\u754c $O(Qn^3)$ \uff0c\u4f46\u662f\u8dd1\u4e0d\u6ee1\uff0c\u6240\u4ee5\u80fd\u8fc7\u3002\n\n```cpp\nconst int N = 205;\n#define mod 10007\nint n, ans, siz[N], rt, rtt, mx[N], cas;\ntypedef vector <int> poly;\nvector <int> e[N];\npoly r[N];\npoly operator * (poly A, poly B) {\n\tint n = sz(A), m = sz(B);\n\tpoly res(n + m - 1, 0);\n\tfor(int i = 0; i < n; ++i)\n\t\tfor(int j = 0; j < m; ++j)\n\t\t\t(res[i + j] += A[i] * B[j]) %= mod;\n\treturn res;\n}\nvoid dfs1(int u, int ft) {\n\tsiz[u] = 1, mx[u] = 0;\n\tfor(int v : e[u]) {\n\t\tif(v == ft) continue;\n\t\tdfs1(v, u), siz[u] += siz[v];\n\t\tckmax(mx[u], siz[v]);\n\t}\n\tckmax(mx[u], n - siz[u]);\n\tif(mx[u] < mx[rt]) rt = u, rtt = 0;\n\telse if(mx[u] == mx[rt]) rtt = u;\n}\nvoid dfs2(int u, int ft) {\n\tr[u].resize(2);\n\tr[u][0] = 0, r[u][1] = 1;\n\tfor(int v : e[u]) {\n\t\tif(v == ft) continue;\n\t\tdfs2(v, u), r[u] = r[u] * r[v];\n\t}\n\tr[u][0] = 1;\n}\nvoid Main() {\n\tn = read();\n\trep(i, 1, n) e[i].clear();\n\trt = rtt = 0, mx[0] = n, ans = 0;\n\trep(i, 2, n) {\n\t\tint x = read(), y = read();\n\t\te[x].pb(y), e[y].pb(x);\n\t}\n\tdfs1(1, 0);\n\tif(rtt) {\n\t\tdfs2(rt, rtt), dfs2(rtt, rt);\n\t\trep(i, 1, min(sz(r[rt]),sz(r[rtt])) - 1)\n\t\t\t(ans += r[rt][i] * r[rtt][i]) %= mod;\n\t} else {\n\t\tdfs2(rt, 0);\n\t\trep(i, 1, n) {\n\t\t\tpoly res(2);\n\t\t\tres[0] = 0, res[1] = 1;\n\t\t\tint lim = ((i + 1) >> 1);\n\t\t\tfor(int v : e[rt]) {\n\t\t\t\tpoly tmp = r[v];\n\t\t\t\ttmp.resize(min(sz(tmp), lim));\n\t\t\t\tres = res * tmp;\n\t\t\t}\n\t\t\tif(sz(res) > i) (ans += res[i]) %= mod;\n\t\t}\n\t}\n\tprintf(\"Case %d: %d\\n\", ++cas, ans);\n}\nsigned main() { for(int T = read(); T; --T) Main(); }\n```\n",
        "postTime": 1615353900,
        "uid": 123384,
        "name": "tommy0221",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4582 [FJOI2014]\u6811\u7684\u91cd\u5fc3"
    }
]
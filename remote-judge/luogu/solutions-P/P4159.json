[
    {
        "content": "- \u9996\u5148\u8003\u8651\u8fb9\u6743\u53ea\u6709 $0,1$ \u7684\u60c5\u51b5\u3002\n- \u4ee4 $f_1=$\u7ed9\u5b9a\u77e9\u9635\n- \u56e0\u4e3a\u8fb9\u6743\u53ea\u6709 $0,1$\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u77e9\u9635\u7684\u610f\u4e49\u8f6c\u5316\u6210\uff1a$f_t[i][j]=k \\Longleftrightarrow$ $i$\u5230$j$\u7684\u957f\u5ea6\u4e3a$t$\u7684\u8def\u5f84\u6761\u6570\u4e3a$k$\u3002\n- \u663e\u7136\u5bf9\u4e8e $f_1$ \u8fd9\u4e2a\u610f\u4e49\u6210\u7acb\u3002\n- \u8fd9\u6837\u95ee\u9898\u5c31\u53d8\u5f97\u7b80\u5355\u591a\u4e86\u3002\n- \u663e\u7136\u6709 $f_t[i][j]=\\sum\\limits_{k=1}^nf_{t-1}[i][k]\\times f_1[k][j]$\u3002\n- \u5373 $f_t=f_{t-1}\\times f_1$\u3002\n- \u77e9\u9635\u4e58\u6cd5\u6ee1\u8db3\u7ed3\u5408\u5f8b\uff0c\u6545 $f_t=f_1^t$\u3002\n- \u4e8e\u662f\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7b54\u6848\u5c31\u662f $f_T[1][n]$\u3002\n- \u518d\u8003\u8651\u8fb9\u6743 $w\\in [0,9]\\cap\\mathbb Z$ \u7684\u60c5\u51b5\u3002\n- \u56e0\u4e3a\u8fb9\u6743\u53ef\u80fd\u5927\u4e8e1\uff0c\u6240\u4ee5\u7ed9\u5b9a\u77e9\u9635\u4e0d\u80fd\u76f4\u63a5\u8f6c\u6362\u6210\u90a3\u79cd\u542b\u4e49\u4e86\u3002\n- \u4f46\u662f\u6211\u4eec\u53d1\u73b0 $n\\le 10$\u3002\n- \u8fd9\u610f\u5473\u7740\u6211\u4eec\u53ef\u4ee5~~\u4e71\u641e~~\u5c06\u6bcf\u4e2a\u70b9\u90fd\u62c6\u5f00\uff0c\u5c06\u8fd9\u5f20\u56fe\u8f6c\u5316\u6210\u8fb9\u6743\u53ea\u6709 $0,1$ \u7684\u56fe\uff0c\u8fd9\u6837\u4e0a\u9762\u7684\u610f\u4e49\u5c31\u6210\u7acb\u4e86\u3002\n- ~~\u7ecf\u8fc7\u601d\u8003\uff0c~~\u6211\u4eec\u53d1\u73b0\u53ef\u4ee5\u5c06\u6bcf\u4e2a\u70b9\u62c6\u6210 $9$ \u4e2a\u70b9\uff0c\u4ee4\u6709\u5e8f\u6570\u5bf9 $(i,j)(i\\in [1,n]\\cap\\mathbb Z,j\\in [0,8]\\cap\\mathbb Z)$ \u8868\u793a\u70b9 $i$ \u62c6\u6210\u7684\u7b2c $j$ \u4e2a\u70b9\uff0c\u5176\u4e2d\u7b2c $0$ \u4e2a\u70b9\u662f\u201c\u771f\u201d\u70b9\uff0c\u5176\u4f59\u7684\u662f\u201c\u5047\u201d\u70b9\u3002\n- \u6211\u4eec\u53ef\u4ee5\u4ee4 $(i,j)(j\\in [1,8]\\cap\\mathbb Z)$ \u8868\u793a\u5230\u201c\u771f\u201d\u70b9 $(i,0)$ \u7684\u8ddd\u79bb\u4e3a $j$ \u7684\u201c\u5047\u201d\u70b9\uff0c\u53ea\u8981\u8ba9 $(i,j)(j\\in [1,8]\\cap\\mathbb Z)$ \u5411 $(i,j-1)$ \u8fde\u4e00\u6761\u8fb9\u6743\u4e3a $1$ \u7684\u8fb9\u3002\n- \u800c\u5bf9\u4e8e\u539f\u56fe\u4e2d\u7684\u4e00\u6761 $u\\to v$ \u8fb9\u6743\u4e3a $w$ \u7684\u8fb9\uff0c\u53ea\u8981\u8ba9 $(u,0)$ \u5411 $(v,w-1)$ \u8fde\u4e00\u6761\u8fb9\u6743\u4e3a $1$ \u7684\u8fb9\u3002\n- \u8fd9\u6837\u6211\u4eec\u5c31\u8fd8\u539f\u4e86\u539f\u56fe\u4e2d\u7684\u8fb9\uff0c\u5e76\u4e14\u5c06\u8fb9\u6743\u90fd\u8f6c\u5316\u6210\u4e86 $0,1$\u3002\n- \u800c\u6bcf\u4e2a $(i,j)$ \u53c8\u53ef\u4ee5\u552f\u4e00\u5bf9\u5e94\u4e00\u4e2a\u7f16\u53f7 $i+j\\times n$\uff0c\u56e0\u6b64\u539f\u77e9\u9635\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a $9n\\times 9n$ \u7684\u77e9\u9635 $f_1$\u3002\n- \u6839\u636e\u524d\u9762\u7684\u63a8\u7406\uff0c\u540c\u6837 $f_t=f_1^t$\u3002\n- \u7b54\u6848\u5c31\u662f $f_T[1][n]$\u3002\n- \u5047\u8bbe $m=9n$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f $O(m^3\\log T)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\n\nconst int MaxN = 100; \nconst int mod = 2009; \n\nint n, m, T; \n\nstruct mat\n{\n\tint r, c; \n\tint a[MaxN + 1][MaxN + 1]; \n\t\n\tmat(){}\n\tmat(const int &_r, const int &_c):\n\t\tr(_r), c(_c) \n\t{\n\t\tmemset(a, 0, sizeof(a)); \n\t}\n\t\n\tinline void clear()\n\t{\n\t\tmemset(a, 0, sizeof(a)); \n\t\tfor (int i = 1; i <= r; ++i)\n\t\t\ta[i][i] = 1; \n\t}\n\t\n\tinline mat operator * (const mat &rhs) const\n\t{\n\t\tmat res(r, rhs.c); \n\t\tfor (int i = 1; i <= r; ++i)\n\t\t\tfor (int j = 1; j <= rhs.c; ++j)\n\t\t\t{\n\t\t\t\tfor (int k = 1; k <= c; ++k)\n\t\t\t\t\tres.a[i][j] += a[i][k] * rhs.a[k][j]; \n\t\t\t\tres.a[i][j] %= mod; \n\t\t\t}\n\t\treturn res; \n\t}\n\t\n\tinline mat operator ^ (int p) const\n\t{\n\t\tmat res(r, c), x = *this; \n\t\tres.clear(); \n\t\tfor (; p; p >>= 1, x = x * x)\n\t\t\tif (p & 1)\n\t\t\t\tres = res * x; \n\t\treturn res; \n\t}\n}f; \n\ninline int pos(const int &u, const int &i)\n{\n\treturn u + i * n; \n}\n\nint main()\n{\n\tscanf(\"%d%d\", &n, &T); \n\tm = n * 9; \n\t\n\tf = mat(m, m); \n\t\n\tint x; \n\tfor (int i = 1; i <= n; ++i)\n\t{\n\t\tfor (int j = 1; j <= 8; ++j)\n\t\t\tf.a[pos(i, j)][pos(i, j - 1)] = 1; \n\t\tfor (int j = 1; j <= n; ++j)\n\t\t{\n\t\t\tscanf(\"%1d\", &x); \n\t\t\tif (x)\n \t\t\t\tf.a[i][pos(j, x - 1)] = 1; \n\t\t}\n\t}\n\t\n\tf = f ^ T; \n\tprintf(\"%d\\n\", f.a[1][n]); \n\t\n\treturn 0; \n}\n```",
        "postTime": 1528533137,
        "uid": 20729,
        "name": "\u6211\u597d\u84bb\u5440",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4159 \u3010[SCOI2009]\u8ff7\u8def\u3011"
    },
    {
        "content": "\u8981\u662f\u6240\u6709\u8fb9\u8fb9\u6743\u90fd\u662f1\u90a3\u4e48\u5c31\u662f\u6c42\u90bb\u63a5\u77e9\u9635\u7684T\u6b21\u5e42\u7684\u5927\u6c34\u9898\u4e86\uff0c\u53ef\u60dc\u8fd9\u9898\u4e0d\u662f\n\n\u90a3\u4e48\u6211\u4eec\u600e\u4e48\u8868\u793a\u8fd9\u4e2a\u56fe\u5462\uff1f\n\n\u53d1\u73b0\u8fb9\u6743\u53ea\u67091~\u2468\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u628a\u4e00\u4e2a\u70b9\u62c6\u6210\u2468\u4e2a\u70b9\u5e76\u6309\u987a\u5e8f\u8fde\u4e0a\n\n\u7136\u540e\u4e00\u6761\u8fb9\u6743\u4e3ak\u7684\u8fb9\u5c31\u662f\u4ece\u8d77\u70b9\u62c6\u51fa\u7684\u7b2ck\u4e2a\u70b9\u5230\u7ec8\u70b9\u62c6\u51fa\u7684\u7b2c\u4e00\u4e2a\u70b9\u8fde\u8fb9\n\n\u4e0a\u9762\u8fde\u7684\u8fb9\u8fb9\u6743\u5168\u662f1\uff0c\u4e8e\u662f\u5c31\u53ef\u4ee5\u6109\u5feb\u5730\u77e9\u9635\u4e58\u6cd5\u6c34\u8fc7\u53bb\u4e86\n\n\u4ee3\u7801\n\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=128;\nconst int mo=2009;\nint n,T;\nstruct mat{\n\tint a[N][N];\n\tvoid clr(){\n\t\tmemset(a,0,sizeof(a));\n\t}\n}a;\nmat operator *(mat a,mat b){\n\tmat re;\n\tre.clr();\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tfor(int k=1;k<=n;k++){\n\t\t\t\tre.a[i][j]=(re.a[i][j]+a.a[i][k]*b.a[k][j]%mo)%mo;\n\t\t\t}\n\t\t}\n\t}\n\treturn re;\n}\nmat operator ^(mat a,int b){\n\tmat re;re.clr();\n\tfor(int i=1;i<=n;i++)re.a[i][i]=1;\n\twhile(b){\n\t\tif(b&1)re=re*a;\n\t\ta=a*a;\n\t\tb>>=1;\n\t}\n\treturn re;\n}\nint main(){\n\tscanf(\"%d%d\",&n,&T);\n\tint n1=n;\n\tn=n*9;\n\tfor(int i=1;i<=n1;i++){\n\t\tfor(int j=1;j<=8;j++){\n\t\t\ta.a[9*(i-1)+j][9*(i-1)+j+1]=1;\n\t\t}\n\t}\n\tchar s[32];\n\tfor(int i=1;i<=n1;i++){\n\t\tscanf(\"%s\",s+1);\n\t\tfor(int j=1;j<=n1;j++){\n\t\t\tif(s[j]>'0'){\n\t\t\t\ta.a[9*(i-1)+s[j]-'0'][9*(j-1)+1]=1;\n\t\t\t}\n\t\t}\n\t}\n\ta=a^T;\n\tprintf(\"%d\",a.a[1][n1*9-8]);\n\treturn 0;\n}\n/*\n5 30\n12045\n07105\n47805\n12024\n12345\n*/\n```",
        "postTime": 1522118492,
        "uid": 38725,
        "name": "xiwang",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4159 \u3010[SCOI2009]\u8ff7\u8def\u3011"
    },
    {
        "content": "# \u524d\u4e24\u4e2a\u5927\u4f6c\u7684 operator \u770b\u7684\u6211\u5f88\u8ff7   \u6211\u6765\u6c34\u4e00\u7bc7\u4eb2\u6c11\u9898\u89e3\n```\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cmath>\nusing namespace std;\nint mod=2009;\nint n,t;\nstruct pp{\n\tint m[115][115];\n}a;\nint c;\ninline pp mul(pp b,pp c)//\u77e9\u9635\u5feb\u901f\u5e42\u677f\u5b50 \n{\n\tpp t;\n\tfor(int i=1;i<=10*n;i++)\n\tfor(int j=1;j<=10*n;j++){\n\t\tt.m[i][j]=0;\n\t\tfor(int k=1;k<=10*n;k++){\n\t\t\tt.m[i][j]=(t.m[i][j]+(b.m[i][k]*c.m[k][j])%mod)%mod;// i\u884cj\u5217\u7684\u503c\u7b49\u4e8e\u7b2c\u4e00\u4e2a\u77e9\u9635\u7684\u7b2c\u4e00\u884c*\u7b2c\u4e8c\u4e2a\u77e9\u9635\u7684\u7b2cj\u5217  \n\t\t}//                                                         \u50cf\u5411\u91cf\u90a3\u6837\u4e58  \n\t}\n\treturn t;\n}\ninline int fast(int x)\n{\n\tpp ans=a;\n\tpp base=a;\n\twhile(x)\n\t{\n\t\tif(x&1)ans=mul(ans,base);\n\t\tbase=mul(base,base);\n\t\tx=x>>1;\n\t}\n\treturn ans.m[1][n];//\u8fd4\u56de1\u53f7\u70b9\u5230n\u53f7\u70b9\u7684\u65b9\u6848\u6570 \n}\nint main()\n{\n\tcin>>n>>t;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=8;j++)\n\t\ta.m[i+j*n][i+(j-1)*n]=1;//\u5efa\u865a\u70b9 \n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tscanf(\"%1d\",&c);\n\t\t\ta.m[i][j+n*(c-1)]=1;//\u8fde\u8fb9 \n\t\t\t//a.m[j+n*(c-1)][i]=1;\n\t\t}\n\t}\n\tcout<<fast(t-1);//\u6ce8\u610f \u8981  -1  \uff01\uff01\uff01 t==1\u65f6\u76f8\u5f53\u4e8e\u6ca1\u52a8  \n\treturn 0;\n}\n//  \n```\n\u7d2b\u9898\u3002\u3002\u3002\u614c\uff08\u9003\uff09",
        "postTime": 1552637678,
        "uid": 71844,
        "name": "\u6768\u94e0\u8fdc",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4159 \u3010[SCOI2009]\u8ff7\u8def\u3011"
    },
    {
        "content": "\u77e9\u9635\u4e58\u6cd5\u5165\u95e8\u9898\u3002\n\n\u5148\u8003\u8651\u5047\u5982\u8fb9\u6743\u53ea\u6709 $0,1$ \u7684\u60c5\u51b5\uff1a\n\n\u8bbe $f_t[i,j]$ \u4e3a\u4ece $i$ \u70b9\u5230 $j$ \u70b9\uff0c\u6240\u82b1\u65f6\u95f4\u4e3a $t$ \u7684\u65b9\u6848\u6570\u3002\n\n\u5c31\u6709 $f_t[i,j]=\\sum\\limits_{i=1}^n f_{t-1}[i,k]*f_1[k,j]$\n\n\u4ed4\u7ec6\u89c2\u5bdf\u4e0a\u8ff0\u5f0f\u5b50\uff0c\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50\u8fd8\u53ef\u4ee5\u5199\u6210 $f_t=f_{t-1}*f_1$\uff0c\u6545\u6709\u5f0f\u5b50 $f_t=f_1^t$\u3002\n\n\u7531\u4e8e\u6240\u82b1\u65f6\u95f4\u4e3a $1$ \u65f6\uff0c\u663e\u7136\u53ea\u80fd\u7ecf\u8fc7\u4e00\u6761\u8fb9\uff0c\u6545 $f_1$ \u7684\u503c\u5e94\u4e3a\u521d\u59cb\u7ed9\u51fa\u7684\u90bb\u63a5\u77e9\u9635\u3002\n\n\u4f46\u8fd9\u9053\u9898\u8fb9\u6743\u4e3a $0-9$\uff0c\u6211\u4eec\u65e0\u6cd5\u76f4\u63a5\u7528\u4e0a\u8ff0\u505a\u6cd5\u6c42\u89e3\uff0c\u8003\u8651\u8f6c\u5316\u3002\n\n\u4f5c\u4e00\u4e2a\u7c7b\u4f3c\u5206\u5c42\u56fe\u7684\u4e1c\u897f\uff0c\u628a\u6bcf\u4e2a\u70b9\u62c6\u5f00\uff0c\u62c6\u6210 $9$ \u4e2a\u70b9\uff0c\u6bcf\u4e2a\u62c6\u540e\u7684\u70b9\u7528\u4e00\u4e2a\u70b9\u5bf9 $(i,j)$ \u8868\u793a\uff0c\u8868\u793a\u70b9 $i$ \u5728\u7b2c $j$ \u5c42\u3002\n\n\u90a3\u4e48\u6211\u4eec\u9700\u8981\u91cd\u65b0\u5efa\u8fb9\uff1a\n\n- \u82e5\u70b9 $x,y$ \u4e4b\u95f4\u5b58\u5728\u4e00\u6761\u8fb9\u6743\u4e3a $w$ \u7684\u8fb9\uff0c\u90a3\u4e48\u5728 $(x,0)$ \u4e0e $(y,w-1)$ \u95f4\u8fde\u4e00\u6761\u8fb9\u6743\u4e3a $1$ \u7684\u8fb9\u3002\n- \u5728 $(x,i)$ \u4e0e $(x,i-1)$ \u95f4\u8fde\u4e00\u6761\u8fb9\u3002\n\n\u4e3a\u4ec0\u4e48\u53ef\u4ee5\u8fd9\u6837\u8fde\u5462\uff1f\u6bcf\u4e2a\u70b9 $x$ \u53ea\u4f1a\u4ece\u7b2c $0$ \u5c42\u5411\u5916\u6269\u5c55\uff0c\u800c\u7b2c $w-1$ \u5c42\u7684\u70b9 $y$\uff0c\u9700\u8981\u7ecf\u8fc7 $w-1$ \u6761\u8fb9\u5230\u8fbe\u7b2c $0$ \u5c42\uff0c\u5e76\u4e14\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u5b83\u53ea\u80fd\u591f\u4ece\u70b9 $y$ \u7684\u7b2c $m$ \u5c42\u5230\u8fbe\u7b2c $m-1$ \u5c42\uff0c\u76f4\u5230\u5230\u8fbe\u7b2c $0$ \u5c42\u624d\u80fd\u591f\u6269\u5c55\u5411\u5176\u4ed6\u8282\u70b9\uff0c\u56e0\u6b64\u7b54\u6848\u7684\u8ba1\u6570\u4e0d\u4f1a\u51fa\u73b0\u5dee\u9519\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9\u6837\u505a\u4e8b\u5b9e\u4e0a\u662f\u628a\u70b9 $x,y$ \u4e4b\u95f4\u8fb9\u6743\u4e3a $w$ \u7684\u8fb9\u62c6\u6210\u4e86 $1$ \u6761\u70b9 $x,y$ \u8fb9\u6743\u4e3a $1$ \u7684\u8fb9\u4ee5\u53ca $w-1$ \u6761 $y$ \u8282\u70b9\u5411\u4e0a\u4e00\u5c42\u6b21\u7684\u8fb9\u6743\u4e3a $1$ \u7684\u8fb9\uff0c\u6b63\u786e\u6027\u662f\u53ef\u4ee5\u786e\u4fdd\u7684\u3002\n\n\u90a3\u4e48\u539f\u56fe\u7684\u90bb\u63a5\u77e9\u9635\u5c31\u88ab\u6269\u5c55\u6210\u4e86\u4e00\u4e2a $9n*9n$ \u7684\u53ea\u6709 $0,1$ \u7684\u90bb\u63a5\u77e9\u9635\uff0c\u4e8e\u662f\u76f4\u63a5\u77e9\u9635\u5feb\u901f\u5e42\u5373\u53ef\u3002\n\n**Show the Code** \n\n```cpp\n#include<cstdio>\n#define id(x,y) ((x-1)*9+(y))\nconst int mod=2009;\nint n,t;\nchar s[105][105];\nstruct matrix {\n\tmatrix operator=(matrix b) {\n\t\tfor(register int i=0;i<9*n;++i) {\n\t\t\tfor(register int j=0;j<9*n;++j) {\n\t\t\t\tthis->a[i][j]=b.a[i][j];\n\t\t\t}\n\t\t}\n\t\treturn *this;\n\t}\n\tvoid init() {for(register int i=0;i<9*n;++i) {for(register int j=0;j<9*n;++j) a[i][j]=0;a[i][i]=1;}}\n\tint a[105][105];\n}pw;\nmatrix mul(matrix a,matrix b) {\n\tmatrix c;\n\tfor(register int i=0;i<9*n;++i) {\n\t\tfor(register int j=0;j<9*n;++j) {\n\t\t\tc.a[i][j]=0;\n\t\t\tfor(register int k=0;k<9*n;++k) {\n\t\t\t\tc.a[i][j]+=a.a[i][k]*b.a[k][j]%mod;\n\t\t\t\tc.a[i][j]%=mod;\n\t\t\t}\n\t\t}\n\t}\n\treturn c;\n}\nmatrix pow(matrix a,int k) {\n\tmatrix res;\n\tres.init();\n\tfor(;k;k>>=1) {\n\t\tif(k&1) res=mul(res,a);\n\t\ta=mul(a,a);\n\t}\n\treturn res;\n}\nint main() {\n\t//(n-1)*9+8=9n-1; 0~9n-1;\n\tscanf(\"%d%d\",&n,&t);\n\t//printf(\"%d %d\\n\",n,t);\n\tfor(register int i=1;i<=n;++i) {\n\t\tscanf(\"%s\",s[i]+1);\n\t\tfor(register int j=1;j<=8;++j) pw.a[id(i,j)][id(i,j-1)]=1;\n\t\tfor(register int j=1;j<=n;++j) {if(s[i][j]-'0') pw.a[id(i,0)][id(j,s[i][j]-'0'-1)]=1;}\n\t}\n\tmatrix ans=pow(pw,t);\n\tprintf(\"%d\\n\",ans.a[id(1,0)][id(n,0)]);\n\treturn 0;\n}\n```",
        "postTime": 1585879255,
        "uid": 95244,
        "name": "tommymio",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4159 \u3010[SCOI2009] \u8ff7\u8def\u3011"
    },
    {
        "content": "## P4159 [SCOI2009] \u8ff7\u8def\n\n\u8fd9\u9053\u9898\u4e00\u4e2a\u5f88\u5947\u602a\u7684\u7279\u70b9\u5c31\u662f\u8fb9\u6743\u662f\u4ee5\u5b57\u7b26\u4e32\u7684\u5f62\u5f0f\u7ed9\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u4e24\u70b9\u4e4b\u95f4\u7684\u8ddd\u79bb\u5c0f\u4e8e\u7b49\u4e8e9\u3002\n\n\u4e0d\u59a8\u5148\u8003\u8651\u5f53\u8def\u5f84\u957f\u5ea6\u90fd\u662f1\u7684\u60c5\u51b5\uff0c\u90a3\u4e48\u9898\u76ee\u8981\u6c42\u7684\u5176\u5b9e\u5c31\u662f\u8d70\u4e86$t$\u6b65\u5230\u8fbe$n$\u70b9\u7684\u65b9\u6848\u6570\n\n\u8bbe$f[i][j][t]$\u8868\u793a\u4ece$i$\u5230$j$\u6070\u597d\u8d70\u4e86$t$\u6b65\u7684\u65b9\u6848\u6570\uff0c\u5219\n\n$f[i][j][t] = \\sum\\limits_{k=1}^nf[i][k][t-1]*f[k][j][1]$\n\n\u53d1\u73b0\u8fd9\u4e0d\u6b63\u597d\u662f\u77e9\u9635\u4e58\u6cd5\u7684\u516c\u5f0f\u5417\u3002\n\n\u8bbe$t$\u65f6\u523b\u7684\u77e9\u9635\u4e3a$f_t$\uff0c\u5219$f_t=f_{t-1}*f_1$\uff0c\u4e5f\u5c31\u662f$f_t=f_1^t$\uff0c\u76f4\u63a5\u77e9\u9635\u5feb\u901f\u5e42\u641e\u4e00\u4e0b\u5c31\u597d\u4e86\uff0c\u800c$f_1$\u4e5f\u5c31\u662f\u9898\u4e2d\u6240\u7ed9\u7684\u90bb\u63a5\u77e9\u9635\u3002\n\n\u56de\u5230\u539f\u6765\u7684\u95ee\u9898\u4e0a\uff0c\u8fb9\u6743\u5c0f\u4e8e\u7b49\u4e8e$9$\u600e\u4e48\u505a\uff1f\n\n\u6709\u4e00\u4e2a\u60f3\u6cd5\u5c31\u662f\u628a\u4e00\u4e2a\u70b9\u770b\u6210$9$\u4e2a\u70b9\uff0c\u5728\u8fd9\u4e5d\u4e2a\u70b9\u4e4b\u95f4\u8fde\u8fb9\u3002\u8fd9\u6837\u5c31\u628a\u95ee\u9898\u8f6c\u5316\u6210\u4e86\u5148\u524d\u6211\u4eec\u8ba8\u8bba\u7684\u95ee\u9898\u3002\u90a3\u4e48\u63a5\u4e0b\u6765\u8003\u8651\u7684\u5c31\u662f\u5982\u4f55\u62c6\u70b9\u3002\u4e0d\u59a8\u5148\u8003\u8651\u7b80\u5355\u7684\u60c5\u51b5\uff0c\u4e24\u4e2a\u70b9\uff0c\u8fb9\u6743\u6700\u5927\u4e3a$2$\u3002\n\n\u6709\u5982\u4e0b\u77e9\u9635\uff1a\n$$\n\\begin{Bmatrix}\n\t2&1\\\\\n\t2&0\n\\end{Bmatrix}\n$$\n\u753b\u51fa\u56fe\u5c31\u662f\u8fd9\u6837\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tsas8v0k.png)\n\n\u62c6\u70b9\u540e\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x0n5rxu8.png)\n\n\u8fd9\u91cc\u6bcf\u6761\u8fb9\u7684\u8fb9\u6743\u90fd\u662f1\uff0c\u5176\u4e2d\u70b9$1.1$\u548c$2.1$\u8868\u793a\u5b9e\u9645\u7684\u70b9\uff0c$1.2$\u548c$2.2$\u8868\u793a\u62c6\u51fa\u6765\u7684\u70b9\u3002\n\n\u4ee5\u6b64\u7c7b\u63a8\u5230\u4e5d\u4e2a\u70b9\u4e5f\u662f\u4e00\u6837\u7684\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N = 105;\nconst int mod = 2009;\nint n, t, sz;\nstruct martix\n{\n\tint m[N][N];\n}e, a;\nmartix cheng(martix x, martix y)\n{\n\tmartix c;\n\tfor(int i = 1; i <= sz; i ++)\n\t\tfor(int j = 1; j <= sz; j ++) c.m[i][j] = 0;\n\tfor(int i = 1; i <= sz; i ++)\n\t\tfor(int j = 1; j <= sz; j ++) \n\t\t\tfor(int k = 1; k <= sz; k ++)\n\t\t\t\tc.m[i][j] = (c.m[i][j] + x.m[i][k] * y.m[k][j] % mod) % mod;\n\treturn c;\n}\nmartix pow(martix x, int y)\n{\n\tmartix ans = e;\n\twhile(y)\n\t{\n\t\tif(y & 1) ans = cheng(ans, x);\n\t\tx = cheng(x, x);\n\t\ty >>= 1;\n\t}\n\treturn ans;\n}\nchar s[N];\nint main()\n{\n\tscanf(\"%d%d\", &n, &t);\n\tsz = n * 10;\n\tfor(int i = 1; i <= sz; i ++)\n\t\te.m[i][i] = 1;\n\tfor(int i = 1; i <= n; i ++)\n\t{\n\t\tint now = (i - 1) * 10;\n\t\tfor(int j = 2; j <= 9; j ++)\n\t\t\ta.m[j + now - 1][j + now] = 1;\n\t}\n\tfor(int i = 1; i <= n; i ++)\n\t{\n\t\tscanf(\"%s\", s + 1);\n\t\tint now = (i - 1) * 10;\n\t\tfor(int j = 1; j <= n; j ++)\n\t\t{\n\t\t\tif(s[j] == '0') continue;\n\t\t\tint to = s[j] - '0';\n\t\t\ta.m[now + 9][j * 10 - to] = 1;\n\t\t}\n\t}\n\te = pow(a, t);\n\tprintf(\"%d\\n\", e.m[9][(n-1) * 10 + 9]);\n}\n```\n\n",
        "postTime": 1592656990,
        "uid": 177510,
        "name": "\u5c0f\u849f\u84bb\u76ae\u76ae\u9c7c",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4159 \u3010[SCOI2009] \u8ff7\u8def\u3011"
    },
    {
        "content": "\u770b\u4e00\u773c\u9898\uff0c\u5728\u67d0\u4e00\u65f6\u523b\u5230\u8fbe\u7b2cn\u4e2a\u70b9\uff0c\u4e00\u773c\u5c31\u662f\u4e2aDP\u9898\uff0c\u5b9a\u4e49\u72b6\u6001$dp_{i,j}$\u662f\u5728\u7b2c$j$\u65f6\u523b\u5230\u8fbe$i$\u70b9\u7684\u65b9\u6cd5\u6570\u3002\n\n\u770b\u4e00\u773c\u6570\u636e\u8303\u56f4\uff0c$t\\leq 10^9$\uff0c\u8fd9\u6837\u5c31\u662f\u53c9\u6389\u4e86\u51e0\u4e4e\u6240\u6709\u7684DP\u505a\u6cd5\u3002\n\n\u4f46\u662f\u989d\u5916\u5730\uff0c\u6211\u4eec\u53d1\u73b0n\u6781\u5c0f\uff0c\u5e76\u4e14\u8def\u5f84\u957f\u5ea6\u4e5f\u5c0f\u7684\u8be1\u5f02\u3002\u5b66\u8fc7\u77e9\u9635\u52a0\u901f\u9012\u63a8\u7684\u5927\u6982\u73b0\u5728\u5df2\u7ecf\u8d77\u53cd\u5e94\u4e86\uff0c\u65e2\u7136\u8fd9\u6837\uff0c\u5f71\u54cd\u4e0b\u4e00\u4e2a\u72b6\u6001\u7684\u5c31\u53ea\u5269\u4e0b\u8ddd\u4eca\u65f6\u95f4\u5c0f\u4e8e\u7b49\u4e8e9\u7684\u90a3\u90e8\u5206\u4e86\u3002\u4e5f\u5c31\u662f\uff0c\u5982\u679c\u6211\u4eec\u786e\u5b9a\u8981\u4f7f\u7528\u77e9\u9635\u52a0\u901f\u9012\u63a8\uff0c\u90a3\u4e48\u5269\u4e0b\u7684\u5c31\u975e\u5e38*\u663e\u7136*\u3002\n\n\u4f8b\u5982\u5f53n=3\uff0c\u8def\u5f84\u6700\u5927\u957f\u5ea6\u662f3\u7684\u65f6\u5019\uff0c\u5b9a\u4e49$a_{i,j}$\u662f\u7ecf\u8fc7$i$\u65f6\u95f4\u5230\u8fbe$j$\u7684\u65b9\u6cd5\u6570\uff08\u6c42\u6c42\u4e86\uff0c\u518d\u5927\u624b\u5c31\u4f1a\u6253\u5e9f\u6389\u7684\uff09\uff1a\n\n$$\\begin{bmatrix}1&2&3\\\\3&2&1\\\\1&3&1\\end{bmatrix}$$\n$$\\Downarrow$$\n$$\\begin{bmatrix}0&0&0&1&0&0&0&0&0\\\\0&0&0&0&1&0&0&0&0\\\\0&0&0&0&0&1&0&0&0\\\\0&0&0&0&0&0&1&0&0\\\\0&0&0&0&0&0&0&1&0\\\\0&0&0&0&0&0&0&0&1\\\\0&1&0&0&0&0&1&0&1\\\\0&0&1&1&1&0&0&0&0\\\\1&0&0&0&0&1&0&0&1\\\\\\end{bmatrix}\\begin{bmatrix}a_{1,1}\\\\a_{1,2}\\\\a_{1,3}\\\\a_{2,1}\\\\a_{2,2}\\\\a_{2,3}\\\\a_{3,1}\\\\a_{3,2}\\\\a_{3,3}\\\\\\end{bmatrix}=\\begin{bmatrix}a_{2,1}\\\\a_{2,2}\\\\a_{2,3}\\\\a_{3,1}\\\\a_{3,2}\\\\a_{3,3}\\\\a_{4,1}\\\\a_{4,2}\\\\a_{4,3}\\\\\\end{bmatrix}$$\n\n\u5f88\u5bb9\u6613\u53d1\u73b0\u524d\u51e0\u4e2a\u90fd\u7279\u522b\u5730\u6709\u89c4\u5f8b\u554a\uff0c\u6bd5\u7adf\u53ea\u9700\u8981\u7ee7\u627f\u4e4b\u524d\u63a8\u51fa\u7684\u7ed3\u679c\u5c31\u884c\u4e86\u3002\u53ea\u6709\u6700\u540e\u4e09\u6392\uff0c\u6211\u4eec\u9700\u8981\u6839\u636e\u90bb\u63a5\u77e9\u9635\u6765\u586b\u4e0a0\u62161\u3002\u6613\u4e8e\u53d1\u73b0\uff0c\u626b\u63cf\u67d0\u4e00\u5217\uff0c\u5982\u679c\u8ddd\u79bb\u662f\u4e09\u5c31\u5728\u524d\u9762\u4e09\u4e2a\u627e\u51fa\u6765\uff0c\u53d8\u62101\u3002\u6700\u540e\uff0c\u5229\u7528\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u6211\u4eec\u53ef\u4ee5\u968f\u968f\u4fbf\u4fbf\u5c31\u53d1\u73b0\u7b54\u6848\u3002\n\n\u6ce8\u610f\uff0c\u56e0\u4e3a\u4fdd\u5b58\u72b6\u6001\u53ea\u80fd\u7528\u4e00\u7ef4\u7684\u77e9\u9635\uff08\u8c8c\u4f3c\u4e8c\u7ef4\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c~~\u4f46\u662f\u5e76\u4e0d\u77e5\u9053\u7acb\u65b9\u4f53\u4e58\u6cd5\u600e\u4e48\u505a~~\uff09\u6240\u4ee5\u5fc5\u987b\u628a\u72b6\u6001\u5806\u53e0\u8d77\u6765\uff0c\u8fd9\u6837\u6253\u7740\u6709\u4e9b\u522b\u626d\uff0c\u4f46\u662f\u83ab\u5f97\u529e\u6cd5\u3002\u5728\u5feb\u901f\u5e42\u4e4b\u540e\uff0c\u5c31\u662f\u4e58\u4e0a\u521d\u59cb\u7684\u72b6\u6001\u77e9\u9635\uff0c\u7531\u4e8e\u53ea\u6709\u4e00\u4e2a\u4e00\uff0c\u627e\u4e00\u4e0b\u8f93\u51fa\u5c31\u597d\u4e86\u3002\u53c2\u8003\u4ee3\u7801qwq\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int Mod=2009;\nint t,n,a[15][15],mx;\nstruct node{\n    int a[105][105];\n    void clear(){\n        memset(a,0,sizeof(a));\n    }\n    friend node operator*(node x,node y){\n        node z;\n        z.clear();\n        for(int i=1;i<=10*n;i++)\n            for(int j=1;j<=10*n;j++)\n                for(int k=1;k<=10*n;k++)\n                    z.a[i][j]=(z.a[i][j]+x.a[i][k]*y.a[k][j])%Mod;\n        return z;\n    }\n}x,E;\nint main(){\n    x.clear();\n    E.clear();\n    cin>>n>>t;\n    mx=n;\n    for(int i=1;i<=n;i++)\n        for(int j=1;j<=n;j++){\n            char inp;\n            cin>>inp;\n            a[i][j]=inp-'0';\n        }\n    for(int i=1;i<=9*n;i++)\n        x.a[i][i+n]=1;\n    for(int i=1;i<=10*n;i++)\n        E.a[i][i]=1;\n    for(int i=9*n+1;i<=10*n;i++){\n        int p=i-9*n;\n        for(int j=1;j<=n;j++)\n            if(a[j][p])\n                x.a[i][(10-a[j][p])*n+j]=1;\n    }\n    while(t){\n        if(t%2)\n            E=E*x;\n        t/=2;\n        x=x*x;\n    }\n    // for(int i=1;i<=10*mx;i++){\n    //     for(int j=1;j<=10*mx;j++)\n    //         cout<<E.a[i][j]<<\" \";\n    //     cout<<'\\n';\n    // }\n    cout<<E.a[10*n][n*9+1];\n}\n```",
        "postTime": 1595490597,
        "uid": 251723,
        "name": "Schwarzkopf_Henkal",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4159 \u3010[SCOI2009] \u8ff7\u8def\u3011"
    },
    {
        "content": "[$\\large{\\texttt{P4159}}$](https://www.luogu.com.cn/problem/P4159)\n\n\u9898\u76ee\u548c\u666e\u901a\u7684 $01$ \u8def\u5f84\u77e9\u9635\u52a0\u901f\u6709\u4e00\u70b9\u533a\u522b\uff0c\u505a\u6cd5\u5f88\u5de7\u3002\n\n---\n\n$\\large{\\texttt{Meaning}}$\n\n\u7ed9\u5b9a\u4e00\u4e2a\u90bb\u63a5\u77e9\u9635\uff0c\u5373\u6bcf\u4e2a\u70b9\u4e4b\u95f4\u7684\u8fb9\u6743\uff0c\u82e5\u4e3a $0$ \u5219\u65e0\u8fb9\uff0c\u56e0\u4e3a\u662f $a*a$ \u7684\u77e9\u9635\uff0c\u6240\u4ee5\u9690\u85cf\u542b\u4e49\u662f\u6bcf\u6761\u8fb9\u6743 $1$~$9$ \u3002\n\n---\n\n$\\large{\\texttt{Solution}}$\n\n\u56e0\u4e3a\u8fb9\u6743\u4e0d\u53ea\u662f $1$ \u4e86\uff0c\u6240\u4ee5\u4e0d\u80fd\u76f4\u63a5\u5c31\u5c06\u6bcf\u4e2a\u70b9\u8fde\u63a5\u8fb9\u505a\u77e9\u4e58\uff0c\u4f46\u662f\u6570\u636e\u8303\u56f4\u592a\u5927\u53c8\u4e0d\u80fd\u4e0d\u7528\u77e9\u4e58\u3002\n\n\u6ce8\u610f\u5230\u8fb9\u6743\u4e3a $1$~$9$ \uff0c\u6240\u4ee5\u53ef\u4ee5\u5c06\u6bcf\u4e00\u4e2a\u70b9\u62c6\u6210 $9$ \u4e2a\u70b9\uff0c\u82e5\u539f\u5148\u6bcf\u4e2a\u70b9\u4e3a $i$ \uff0c\u5219\u62c6\u540e\u7684\u70b9\u4e3a $(i-1)*9+n~(1\\le n\\le9)$\uff0c $i$ \u7684\u4e3b\u70b9\u4e3a $(i-1)*9+1$ \uff0c\u5e76\u5c06\u70b9 $(i-1)*9+n$ \u548c $(i-1)*9+n+1$ \u8fde\u8fb9\u957f\u4e3a $1$ \u3002\n\n\u7136\u540e\u8fde\u957f\u5ea6\u4e0d\u4e3a $1$ \u7684\u8fb9\u5c31\u5f88\u65b9\u4fbf\u4e86\uff0c\u82e5\u8fde\u70b9 $u$ \u548c $v$ \u8fb9\u6743\u4e3a $k$ \uff0c\u5219\u8fde\u63a5 $(u-1)*9+k$ \u548c $(v-1)*9+1$ \uff0c\u8fd9\u6837\uff0c\u4ece $u$ \u7684\u4e3b\u70b9\u5fc5\u987b\u8981\u8d70 $k-1$ \u4e2a\u5355\u4f4d\uff0c\u518d\u8d70\u8fd9\u6761\u8fb9\u624d\u5230\u7684\u4e3b\u70b9\uff0c\u4e14\u53ef\u4ee5\u4f7f\u7528\u77e9\u9635\u4e58\u6cd5+\u5feb\u901f\u5e42\u3002\n\n\u6700\u540e\u7b54\u6848\u5373\u4e3a $1$ \u7684\u4e3b\u70b9\u5230 $n$ \u7684\u4e3b\u70b9\u7684\u8ddd\u79bb\u3002\n\n---\n\n$\\large{\\texttt{Code}}$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\n// #define int long long\nconst int mod=2009;\nconst int N=10;\n\nint a,b;\nchar ch;\n\nstruct node {\n    int n,m,s[1010][1010];\n    inline void Mem() {memset(s,0,sizeof(s));}\n    inline void Re() {for(int i=1;i<=n;i++) s[i][i]=1;}\n    inline void print() {for(int i=1;i<=n;i++) {for(int j=1;j<=m;j++) printf(\"%d \",s[i][j]); puts(\"\");}}\n    node operator*(const node b) {\n        node sum;\n        sum.Mem();\n        sum.n=n;\n        sum.m=b.m;\n        for(int i=1;i<=n;i++) for(int j=1;j<=b.m;j++) {for(int k=1;k<=m;k++)  sum.s[i][j]=(sum.s[i][j]+s[i][k]*b.s[k][j]); sum.s[i][j]%=mod;}\n        return sum;\n    }\n} S,A;\n\ninline void Pow(int n) {//\u77e9\u9635\u5feb\u901f\u5e42\n    while(n) {\n        if(n&1) S=S*A;\n        A=A*A;\n        n>>=1;\n    }\n}\n\nsigned main() {\n    // freopen(\"in\",\"r\",stdin);\n    scanf(\"%d%d\",&a,&b);\n    S.n=S.m=a*9;\n    for(int i=1;i<=a;i++) for(int j=1;j<=8;j++) S.s[(i-1)*9+j][(i-1)*9+j+1]=1;\n    for(int i=1;i<=a;i++) {\n        getchar();//\u9632\u6b62scanf\u8bfb\u5165\u504f\u5dee\n        for(int j=1;j<=a;j++) {\n            scanf(\"%c\",&ch);\n            if(ch!='0') S.s[(i-1)*9+ch-'0'][(j-1)*9+1]=1;\n        }\n    }\n    A=S;\n    Pow(b-1);\n    //S.print();\n    printf(\"%d\",S.s[1][(a-1)*9+1]);\n    return 0;\n}\n```\n\n[$\\blue{\\large{\\texttt{My Blog}}}$](https://www.luogu.com.cn/blog/184549/)",
        "postTime": 1595334774,
        "uid": 184549,
        "name": "RedreamMer",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4159 \u3010[SCOI2009] \u8ff7\u8def\u3011"
    },
    {
        "content": "\u5176\u5b9e\u8fd9\u9053\u9898\u6211\u4eec\u53ef\u4ee5\u4e0d\u4ece\u62c6\u70b9\u7684\u89d2\u5ea6\u8003\u8651\n\n\u6839\u636e\u9898\u610f\uff0c\u53ef\u4ee5\u5199\u51fa\u8f6c\u79fb\u65b9\u7a0b\n\n$$f_{i,j}=\\sum f_{r,j-w[r]}$$\n\n$f_{i,j}$\u8868\u793a\u7b2c$j$\u65f6\u523b\u5728\u7b2c$i$\u4e2a\u70b9\u65f6\u7684\u65b9\u6848\u6570\uff0c$r$\u4e3a$i$\u7684\u524d\u9a71\uff0c$w[r]$\u4e3a\u8ddd\u79bb\n\n\u800c$T\\le 10^9$\uff0c\u6240\u4ee5\u80af\u5b9a\u662f\u4e0d\u53ef\u884c\u7684\uff0c\u5c31\u8981\u7528\u5230**\u77e9\u9635\u52a0\u901f**\n\n\u5982\u679c\u5bf9\u4e8e\u4e0a\u9762\u90a3\u4e2a\u8f6c\u79fb\u65b9\u7a0b\u662f\u65e0\u6cd5\u77e9\u9635\u52a0\u901f\u7684\n\n\u4f46\u662f\u8fb9\u6743\u53ea\u6709$1\u20269$\uff0c\u6211\u4eec\u53ef\u4ee5\u628a$j$\u5206\u5f00\u8868\u793a\uff0c\u4e5f\u5c31\u662f\u628a\u6240\u6709\u8ddd\u79bb\u7684\u60c5\u51b5\u90fd\u8868\u793a\u51fa\u6765\n\n\u90a3\u4e48\u5bf9\u4e8e\u4e0a\u9762\u7684\u90a3\u4e2a\u8f6c\u79fb\u65b9\u7a0b\u5c31\u6709\u4e24\u79cd\u8f6c\u79fb\u5f62\u5f0f\n\n- \u8fd9\u4e2a\u8ddd\u79bb$j$\u4e0d\u662f\u771f\u6b63\u7684\u8ddd\u79bb\uff0c\u90a3\u4e48$f_{r,j}$\u53ef\u4ee5\u4ece$f_{r,j-1}$\u7ee7\u627f\n\n- \u8fd9\u4e2a$j$\u662f\u771f\u6b63\u7684\u8ddd\u79bb\uff0c\u90a3\u4e48$f_{r,j}$\u5bf9$f_{i,j}$\u662f\u6709\u8d21\u732e\u7684\n\n\u8fd9\u5c31\u662f\u4e0d\u62c6\u70b9\u7684\u601d\u8def\u4e86\uff0c\u867d\u7136\u4ee3\u7801\u548c\u62c6\u70b9\u662f\u4e00\u6837\u7684\uff0c\u4f46\u8fd9\u4e2a\u601d\u8def\u53ef\u80fd\u4f1a~~\u66f4\u6e05\u6670\u70b9~~\n\n**Code**\n``` cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\nusing namespace std;\nint n,t,d[500][500],s[500][500],b[500][500],p=2009;\nchar ch;\nvoid jzc(int x[500][500],int y[500][500])\n{\n\tfor (int i=1;i<=n*9;i++)\n\t\tfor (int j=1;j<=n*9;j++)\n\t\t\tfor (int k=1;k<=n*9;k++)\n\t\t\t\tb[i][j]=(b[i][j]+x[i][k]*y[k][j]%p)%p;\n\tfor (int i=1;i<=n*9;i++)\n\t\tfor (int j=1;j<=n*9;j++)\n\t\t\tx[i][j]=b[i][j],b[i][j]=0;\n}\nint main()\n{\n\tcin>>n>>t;\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tfor (int j=1;j<=8;j++)     //\u7b2c\u4e00\u4e2a\u7684\u7ee7\u627f\u5173\u7cfb\n\t\t\td[i+j*n][i+(j-1)*n]=1;\n\t\tfor (int j=1;j<=n;j++)\n\t\t{\n\t\t\tcin>>ch;\n\t\t\td[i][j+n*((ch-'0')-1)]=1;   //\u771f\u6b63\u7684\u8fb9\n\t\t}\n\t}\n\tfor (int i=1;i<=n*9;i++)\n\t\ts[i][i]=1;\n\twhile (t)\n\t{\n\t\tif (t&1)jzc(s,d);\n\t\tjzc(d,d);\n\t\tt>>=1;\n\t}\n\tcout<<s[1][n]<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1561427932,
        "uid": 73231,
        "name": "eee_hoho",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4159 \u3010[SCOI2009]\u8ff7\u8def\u3011"
    },
    {
        "content": "\u9898\u76ee\u4f20\u9001\u95e8 [P4159 \\[SCOI2009\\] \u8ff7\u8def](https://www.luogu.com.cn/problem/P4159)\n\n1. \u5982\u679c\u5b8c\u5168\u6ca1\u6709\u601d\u8def\u8bf7\u79fb\u6b65\u81f3 [P2233 [HNOI2002]\u516c\u4ea4\u8f66\u8def\u7ebf](https://www.luogu.com.cn/problem/P2233)\n2. \u5982\u679c\u6ca1\u5b66\u8fc7\u77e9\u9635\u4e58\u6cd5\u53ef\u4ee5\u53bb\n\n[P1939\u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09](https://www.luogu.com.cn/problem/P1939)\n\n[P3390 \u3010\u6a21\u677f\u3011\u77e9\u9635\u5feb\u901f\u5e42](https://www.luogu.com.cn/problem/P3390)\n\n\u770b\u770b\u8fd9\u4e24\u9898\u7684\u9898\u89e3\n\n\u8981\u662f\u4e0d\u4f1a\u5feb\u901f\u5e42\u8bf7\u53bb [P1226 \u3010\u6a21\u677f\u3011\u5feb\u901f\u5e42||\u53d6\u4f59\u8fd0\u7b97](https://www.luogu.com.cn/problem/P1226)\n\n3. \u7136\u540e\u6211\u4eec\u901a\u8fc7 P2233 \u77e5\u9053\u4e86\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u90bb\u63a5\u77e9\u9635\u4e3a $G$ \u7684\uff0c\u8fb9\u6743\u53ea\u6709 0 1 \u7684\u56fe\uff0c\u4ece $i$ \u8d70\u5230 $j$ \u6070\u597d\u8d70 $T$ \u4e2a\u5355\u4f4d\u7684\u65b9\u6848\u6570\u662f $G^T_{ij}$\uff0c\u90a3\u4e48\u8003\u8651\u628a\u8fd9\u9053\u9898\u8f6c\u6362\u6210\u8fb9\u6743\u4e3a 0 1 \u7684\u5f62\u5f0f\n\n4. \u901a\u8fc7\u6df1\u601d\u719f\u8651\uff0c\u6211\u4eec\u53d1\u73b0\u5176\u5b9e\u6211\u4eec\u53ef\u4ee5\u628a\u6bcf\u4e00\u6761\u8fb9\u62c6\u5f00\uff0c\u6bd4\u5982\u628a\u4e00\u4e2a\u8fb9\u6743\u4e3a 9 \u7684\u8fb9\u62c6\u6210 9 \u6bb5\uff0c\u6bcf\u4e00\u6bb5\u8fb9\u6743\u90fd\u662f 1 \uff0c\u5c31\u8f6c\u5316\u6210\u4e86\u8fb9\u6743\u53ea\u6709 0 \u548c 1 \u7684\u56fe\uff0c\u7136\u540e\u6211\u4eec\u60ca\u559c\u7684\u53d1\u73b0\uff0c\u8fb9\u6743\u6700\u5927\u4e5f\u5c31\u662f 9 \uff0c\u6240\u4ee5\u6bcf\u6761\u8fb9\u6700\u591a\u62c6\u6210 9 \u6bb5\uff0c\u6240\u4ee5\u6bcf\u4e2a\u70b9\u6700\u591a\u62c6\u6210 9 \u4e2a\u70b9\uff0c\u800c\u4e14 $n \\le 10$ \uff0c\u6240\u4ee5\u62c6\u5b8c\u4e4b\u540e\u6700\u591a 90 \u4e2a\u70b9\uff0c\u6240\u4ee5\u6700\u540e\u7b97\u6cd5\u7684\u590d\u6742\u5ea6\u5c31\u662f $O((9n)^3 \\log_2T)$ \u7edd\u5bf9\u80fd\u8fc7\n\n\u6700\u540e\u732e\u4e0a\u4ee3\u7801\uff1a\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nconst int NR=15, XR=110, MOD=2009;\nint n, t, tmp;\n#define ps(x, y) ((x)+(y)*n)\n//\u4e3a\u6bcf\u4e00\u4e2a\u70b9\u7f16\u53f7\uff0c\u53c2\u89c1\u4e00\u697c\u9898\u89e3\nstruct mat\n{//\u77e9\u9635\u4e58\u6cd5\u6a21\u677f\n\tint n, m, a[XR][XR];\n\tmat(){n=m=0, memset(a, 0, sizeof(a));}\n\tmat operator*(const mat &b)const\n\t{\n\t\tmat c;\n\t\tif(m!=b.n)return c;\n\t\tc.n=n, c.m=b.m;\n\t\tfor(int k=1;k<=m;k++)\n\t\t\tfor(int i=1;i<=n;i++)\n\t\t\t\tfor(int j=1;j<=b.m;j++)\n\t\t\t\t\tc.a[i][j]=(c.a[i][j]+a[i][k]*b.a[k][j])%MOD;\n\t\treturn c;\n\t}\n\tmat operator*=(const mat &b)\n\t{\n\t\treturn *this=*this*b;\n\t}\n\tvoid I()\n\t{\n\t\tif(n!=m)return;\n\t\tfor(int i=1;i<=n;i++)\n\t\t\ta[i][i]=1;\n\t}\n\tmat operator^(int p)const\n\t{\n\t\tmat a=*this, res;\n\t\tres.n=a.n, res.m=a.m;\n\t\tres.I();\n\t\twhile(p)\n\t\t{\n\t\t\tif(p&1)res*=a;\n\t\t\ta*=a, p>>=1;\n\t\t}\n\t\treturn res;\n\t}\n\tmat operator^=(const int p)\n\t{\n\t\treturn *this=*this^p;\n\t}\n}a;\nint main()\n{\n\tscanf(\"%d%d\", &n, &t);\n\ta.n=a.m=9*n;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=8;j++)\n\t\t\ta.a[ps(i, j)][ps(i, j-1)]=1;\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tscanf(\"%1d\", &tmp);\n\t\t\tif(tmp)a.a[i][ps(j, tmp-1)]=1;\n\t\t}\n\t}\n\tprintf(\"%d\", (a^t).a[1][n]);\n\treturn 0;\n}\n```",
        "postTime": 1618981358,
        "uid": 389050,
        "name": "cszhpdx",
        "ccfLevel": 0,
        "title": "P4159 [SCOI2009] \u8ff7\u8def \u9898\u89e3"
    },
    {
        "content": "\u9996\u5148\uff0c\u9047\u5230\u8fd9\u79cd\u8ba1\u6570\u7c7b\u7684\u9898\u76ee\uff0c\u8003\u8651\u4e24\u4e2a\u4e1c\u897f:**\u641c\u7d22\u6216\u9012\u63a8**\n\n$1\\le t\\le10^9$,\u641c\u7d22\u4e0d\u53ef\u80fd\uff0c\u8003\u8651\u9012\u63a8\u3002\n\n\u8bbe$f_{i,j,k}$ \u8868\u793a\u4ece\u70b9$i$ \u7ecf\u8fc7$k$ \u4e2a\u5355\u4f4d\u7684\u65f6\u95f4\u5230\u8fbe\u70b9$j$ \u7684\u65b9\u6848\u6570\uff0c\u5219\u5f88\u5bb9\u6613\u7684\u53ef\u4ee5\u5217\u51fa\u8f6c\u79fb\u65b9\u7a0b\uff1a\n$$\\large f_{i,j,k}=\\sum\\limits_{(v,j,w)\\in \\mathbf{E}}f_{i,v,k-w}$$\n\n\u5176\u4e2d,$(v,j,w)$ \u8868\u793a\u4e00\u6761\u4ece$v$ \u5230$j$ ,\u6743\u503c\u4e3a$w$ \u7684\u8fb9\uff0cE \u8868\u793a\u539f\u56fe\u8fb9\u96c6\n\n\u5982\u679c$k$ \u4e0d\u5927\u7684\u8bdd\uff0c\u4f60\u5b8c\u5168\u53ef\u4ee5\u7528\u8bb0\u5fc6\u5316\u641c\u7d22\u6765\u8f6c\u79fb\uff0c\u633a\u597d\u7684\u3002\n\n\u4f46\u662f$k$ \u5f88\u5927\u3002\n\n\u6211\u4eec\u5148\u4ece\u5f31\u5316\u7248\u7684$w=1$ \u7684\u60c5\u51b5\u8003\u8651\uff0c\u8fd9\u65f6\u53ef\u4ee5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u6c42\u89e3\uff0c\u4ee4\u90bb\u63a5\u77e9\u9635\u4e3a$G$($G(i,j)=1$ \u8868\u793a $i,j$ \u6709\u8fb9),\u5219$F[k]=F[k-1]*G$(k\u7684\u610f\u4e49\u540c\u4e0a\u65b9\u8f6c\u79fb\u65b9\u7a0b)\n\n\u4f46\u662f\u8fb9\u6743\u662f$w$,\u6ce8\u610f$w$ \u5728$1-9$ \u4e4b\u95f4\uff0c\u6545\u53ef\u4ee5\u8003\u8651\u5c06\u5176\u62c6\u6210$w$ \u6761\u6743\u4e3a$1$ \u7684\u8fb9\uff0c\u4e2d\u95f4\u7528\u4e2d\u8f6c\u70b9\u3002\n\n\u4f46\u662f\u70b9\u7684\u89c4\u6a21\u4e3a$n+9m\\le910$\uff0c\u4f1a\u8d85\u7684\u3002\n\n\n\u8003\u8651\u628a\u62c6\u8fb9\u6539\u4e3a\u62c6\u70b9\uff0c\u5373\u5c06$(u,v,w)$ \u770b\u505a\u201c\u4ece$u$ \u53bb\u5230$v$ \uff0c\u5e76\u5728$v$\u505c\u7559\u4e86$w-1$ \u4e2a\u5355\u4f4d\u65f6\u95f4(\u8def\u4e0a\u8981\u82b1\u8d391\u4e2a\u5355\u4f4d\u65f6\u95f4\uff09\u201d\uff0c\u8fd9\u6837\uff0c\u8bbe$u_i$ \u4e3a\u5728\u7ed3\u70b9$u$\u505c\u7559$u$ \u505c\u7559$i$ \u5929\u6240\u5bf9\u5e94\u7684\u70b9\uff0c\u5219$(u,v,w)$ \u53d8\u4e3a $(u,v_{w-1},1)$\n\n\n\n\u6ce8\u610f\uff0c$u_{i-1}$ \u548c $u_i$ \u4e4b\u95f4\u4e5f\u8981\u8fde\u8fb9\u3002\n\n\u77e9\u9635\u5feb\u901f\u5e42\u4e0d\u591a\u8bb2.\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=101,mod=2009,Node=11;\nstruct matrix{\n\tint a[N][N],r,c;\n\tinline void init()\n\t{\n\t\tfor(int i=1;i<=r;i++)\n\t\tfor(int j=1;j<=c;j++)\n\t\ta[i][j]=(i==j);\n\t}\n\tmatrix(){ memset(a,r=c=0,sizeof a);}\n\tmatrix operator *(const matrix &rhs) \n\t{\n\t\tmatrix res;\n\t\tres.r=this->r;res.c=rhs.c;\n\t\tassert(c==rhs.r);  //\u68c0\u9a8c\u77e9\u9635\u4e58\u6cd5\u7684\u5408\u6cd5\u6027\uff0c\u9519\u8bef\u65f6\u4f1a\u5f39\u51fa\u9519\u8bef\u4fe1\u606f\u5e76\u7ec8\u6b62\u7a0b\u5e8f\n\t\tfor(int i=1;i<=r;i++)\n\t\tfor(int k=1;k<=c;k++)\n\t\tfor(int j=1;j<=rhs.c;j++)\n\t\t(res.a[i][j]+=this->a[i][k]*rhs.a[k][j])%=mod;\n\t\treturn res;\n\t}\n\tmatrix operator ^( int p)\n\t{\n\t\tmatrix res,tmp=*this;\n\t\tres.r=res.c=this->r;\n\t\tres.init();\n\t\twhile(p)\n\t\t{\n\t\t\tif(p&1) res=res*tmp;\n\t\t\ttmp=tmp*tmp;\n\t\t\tp>>=1;\n\t\t}\n\t\treturn res;\n\t}\n\tint *operator [](const int p)  { return a[p];}\n}A;\nint n,t,id[Node][Node],cnt=0;\nchar s[Node][Node];\nint main()\n{\n\tscanf(\"%d%d\",&n,&t);\n\tfor(int i=1;i<=n;i++) cin>>(s[i]+1);\n\n\tfor(int j=0;j<=9;j++) \n\tfor(int i=1;i<=n;i++)\n\tid[i][j]=++cnt;\n\t\tA.r=A.c=cnt;\n\tfor(int i=1;i<=n;i++)\n\tfor(int j=1;j<=n;j++)\n\t{\n\t\tint w=s[i][j]-'0';\n\t\tif(!w) continue;\n\t//\tprintf(\"%d,%d,%d\\n\",i,j,w);\n\t\tfor(int k=1;k<w;k++) A[id[i][k-1]][id[i][k]]=1;   //u_i-1\u548cu_i\u95f4\u7684\u8fb9\n\t\tA[id[i][w-1]][j]=1;    //(u,v_w-1,1)\n\t}\n\tcout<<(A^t)[1][n];\n}\n\n```",
        "postTime": 1605884638,
        "uid": 226435,
        "name": "\u5929\u547d\u4e4b\u8def",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4159 \u3010[SCOI2009] \u8ff7\u8def\u3011"
    },
    {
        "content": "[\u849f\u84bb\u6211\u7684Blog](https://www.chnxuzhiyuan.cn/2019/06/01/%E3%80%8CSCOI2009%E3%80%8D%E8%BF%B7%E8%B7%AF-Solution/)\n\n### \u9898\u89e3\n\n\u5148\u6765\u8003\u8651\u5982\u679c\u8fb9\u6743\u5168\u90fd\u4e3a$1$\u600e\u4e48\u5904\u7406\u3002\n\n\u8bbe$G[i][j][k]$\u8868\u793a\u4ece$i$\u8d70\u5230$j$\uff0c\u6b65\u6570\u6070\u597d\u4e3a$k$\u7684\u65b9\u6848\u6570\u3002\n\n\u4e0d\u96be\u63a8\u51fa\u8f6c\u79fb\u65b9\u7a0b\uff1a\n$$\nG[i][j][k]=\\sum_{t=1}^{n}G[i][t][k-1]*G[t][j][1]\n$$\n\u800c\u8fd9\u6b63\u662f\u4e00\u4e2a\u77e9\u9635\u4e58\u6cd5\u7684\u5f0f\u5b50\u3002\n\n\u4ee4\u8f6c\u79fb\u77e9\u9635\u4e3a$F$\uff0c\u5176\u4e2d$F[i][j]$\u8868\u793a\u4ece$i$\u4e00\u6b65\u8d70\u5230$j$\u7684\u65b9\u6848\u6570\u3002\u5982\u679c$i,j$\u4e4b\u95f4\u6709\u8fb9\u5219$F[i][j]=1$\uff0c\u5426\u5219$F[i][j]=0$\u3002\n\n\u6240\u4ee5\u6709\u7b54\u6848\u77e9\u9635$G_T=F^T$\uff0c\u77e9\u9635\u5feb\u901f\u5e42\u5373\u53ef\u3002\n\n\u8fd8\u6709\u5c31\u662f\u7531\u4e8e\u539f\u9898\u4e2d\u8fb9\u6743\u4e0d\u4e00\u5b9a\u4e3a$1$\uff0c\u4f46\u662f\u5c0f\u4e8e\u7b49\u4e8e$9$\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u66b4\u529b\u62c6\u70b9\uff0c\u628a\u6bcf\u4e2a\u70b9\u62c6\u6210$9$\u4e2a\u70b9\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u628a\u6240\u6709\u8fb9\u7684\u8fb9\u6743\u8f6c\u5316\u4e3a$1$\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O((9n)^3\\log T)$\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<cstdio>\n#include<cstring>\nusing namespace std;\nconst int maxn=100,TT=2009;\nint n,T;\nint GetC()\n{\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9') ch=getchar();\n\treturn ch-'0';\n}\nstruct Matrix\n{\n\tint n,m,a[maxn][maxn];\n\tMatrix(){n=m=0;memset(a,0,sizeof(a));}\n\tMatrix operator * (const Matrix& b)\n\t{\n\t\tMatrix c;\n\t\tc.n=n;c.m=b.m;\n\t\tfor(int i=1;i<=c.n;i++)\n\t\t\tfor(int j=1;j<=c.m;j++)\n\t\t\t\tfor(int k=1;k<=m;k++)\n\t\t\t\t\tc.a[i][j]=(c.a[i][j]+a[i][k]*b.a[k][j])%TT;\n\t\treturn c;\n\t}\n}F,G;\nMatrix QP(Matrix a,int b)\n{\n\tMatrix ret=a,w=a;b--;\n\twhile(b)\n\t{\n\t\tif(b&1) ret=ret*w;\n\t\tw=w*w;b>>=1;\n\t}\n\treturn ret;\n}\nint main()\n{\n\tscanf(\"%d%d\",&n,&T);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tint C=GetC();\n\t\t\tif(C!=0) F.a[(i-1)*9+1][(j-1)*9+C]=1;\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<9;j++)\n\t\t\tF.a[(i-1)*9+j+1][(i-1)*9+j]=1;\n\tF.n=F.m=n*9;\n\tG=QP(F,T);\n\tprintf(\"%d\\n\",G.a[1][(n-1)*9+1]);\n\treturn 0;\n}\n```",
        "postTime": 1563195319,
        "uid": 42392,
        "name": "\u5f90\u81f4\u8fdc",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4159 \u3010[SCOI2009]\u8ff7\u8def\u3011"
    }
]
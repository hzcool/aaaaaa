[
    {
        "content": "\u9996\u5148\uff0c\u9898\u76ee\u4e2d\u662f\u975e\u9f50\u6b21\u9012\u63a8\uff0c\u8003\u8651\u5c06\u5176\u5316\u4e3a\u9f50\u6b21\u7684\u3002  \n\u4ee5\u4e0b\u82e5\u65e0\u8bf4\u660e\uff0c\u5219 $f_0=-1$\u3002\n$$a_n=\\sum\\limits_{i=0}^mp_in^i+\\sum\\limits_{i=1}^kf_i \\times a_{n-i}$$\n$$a_n=p_mn^m+\\sum_{i=0}^{m-1}p_in^i+\\sum_{i=1}^kf_i \\times a_{n-i}$$\n$$p_mn^m=a_n-\\sum_{i=0}^{m-1}p_in^i-\\sum_{i=1}^kf_i \\times a_{n-i}$$\n$$p_m(n-1)^m=a_{n-1}-\\sum_{i=0}^{m-1}p_i(n-1)^i-\\sum_{i=1}^kf_i \\times a_{n-1-i}$$\n\u5f0f\u5b50\u63a8\u5230\u8fd9\u91cc\u5176\u5b9e\u5c31\u53ef\u4ee5\u6536\u624b\u4e86\uff1b\u628a\u5de6\u5f0f\u7684 $(n-1)^m$ \u5c55\u5f00\u540e\uff0c\u9664\u4e86 $p_mn^m$ \u9879\u90fd\u79fb\u5230\u53f3\u8fb9\u53bb\u3002\u7136\u540e\u7528\u53f3\u8fb9\u7684\u5f0f\u5b50\uff0c\u53d6\u4ee3\u539f\u5f0f\u4e2d\u7684 $p_mn^m$\u3002\n\n\u4ee3\u56de\u539f\u5f0f\u4e0a\u9762\u540e\uff0c\u76f8\u5f53\u4e8e\u628a\u9012\u63a8\u7cfb\u6570\u505a\u4e86\u4e2a\u5dee\u5206\uff08\u5f53\u7136\u8fd8\u8981\u5728\u540e\u9762\u52a0\u4e00\u9879\uff09\uff0c\u800c\u548c\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u6ca1\u6709\u5173\u7cfb\u3002  \n\n\u4e5f\u5c31\u662f\u8bf4\u5c06\u9012\u63a8\u7cfb\u6570\u6c42 $m+1$ \u9636\u5dee\u5206\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u7b49\u4ef7\u7684\u9f50\u6b21\u9012\u63a8\u5f0f\u4e86\u3002\n****  \n\u7531\u4e8e\u591a\u4e86 $m+1$ \u9879\uff0c\u5c31\u8981\u518d\u6c42\u51fa $a_k\\sim a_{k+m}$\u3002  \n\u539f\u5f0f\u7684\u9012\u63a8\u53ef\u4ee5\u5199\u6210\u8fd9\u6837\uff1a    \n\uff08\u5176\u4e2d $b$ \u662f\u6211\u4eec\u6784\u9020\u7684\u4e00\u4e2a\u5e8f\u5217\uff09\n$$a_n=b_n+\\sum_{i=1}^kf_i\\times a_{n-i}$$  \n**\u4e3a\u4e86\u4e0b\u9762\u63a8\u5f0f\u5b50\u65b9\u4fbf\uff0c\u5b9a\u4e49 $f_0=0$** \u3002\n$$a_n=b_n+\\sum\\limits_{i=0}^nf_i \\times a_{n-i}$$  \n\u8fd9\u6837\u5c31\u662f\u4e00\u4e2a\u660e\u663e\u7684\u5377\u79ef\uff0c\u8bbe $\\{a_n\\}_{n=0}^\\infty,\\{b_n\\}_{n=0}^\\infty,\\{f_n\\}_{n=0}^\\infty$ \u7684\u751f\u6210\u51fd\u6570\u4e3a $A(x),B(x),F(x)$\uff0c\u90a3\u4e48\u5c31\u6709\uff1a  \n$$A(x)=B(x)+F(x)A(x)$$\n$$(1-F(x))A(x)=B(x)$$\n$$A(x)=\\frac{B(x)}{1-F(x)}$$\n\u6240\u4ee5\u53ea\u8981\u6784\u9020\u51fa\u5e8f\u5217 $b$\uff0c\u5c31\u80fd\u591a\u9879\u5f0f\u6c42\u9006\u7b97\u51fa $a$ \u4e86\u3002\n\n\u9996\u5148\u5bf9\u4e8e $\\forall n \\ge k,b_n=P(n)$\uff0c\u591a\u9879\u5f0f\u591a\u70b9\u6c42\u503c\u5373\u53ef\u3002  \n\u800c\u5bf9\u4e8e $n \\le k-1$\uff1a  \n$$b_n=a_n-\\sum\\limits_{i=0}^nf_i \\times a_{n-i}$$  \n\u8fd9\u53f3\u8fb9\u8fd8\u662f\u4e2a\u5377\u79ef\uff0c\u7531\u4e8e\u8fd9\u91cc $n$ \u53ea\u80fd\u53d6\u5230 $k-1$\uff0c\u6240\u4ee5\u5c31\u53ef\u4ee5\u76f4\u63a5\u7b97\u51fa\u6765\u4e86\u3002  \n\n\u524d\u9762\u505a\u7684\u90fd\u662f\u51c6\u5907\u5de5\u4f5c\uff0c\u641e\u5b8c\u4e86\u4e4b\u540e\u76f4\u63a5\u4e0a\u7ebf\u6027\u9012\u63a8\u677f\u5b50\u5373\u53ef\u3002  \n\n\u53c2\u8003\u4ee3\u7801\uff1a  \n\uff08\u4e3a\u4e86\u53ef\u8bfb\u6027\u6ca1\u6709\u523b\u610f\u5361\u5e38\u6570\uff09\n```cpp\n#pragma GCC optimize (\"unroll-loops\")\n#include<cstdio>\n#include<iostream>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#define N 131077\n#define p 998244353\n#define ll long long\n#define reg register\n#define add(x,y) (x+y>=p?x+y-p:x+y)\n#define dec(x,y) (x<y?x-y+p:x-y)\nusing namespace std;\n\ninline void read(int &x){\n\tx = 0;\n\tchar c = getchar();\n\twhile(c<'0'||c>'9') c = getchar();\n\twhile(c>='0'&&c<='9'){\n\t\tx = (x<<3)+(x<<1)+(c^48);\n\t\tc = getchar();\n\t}\n}\n\nvoid print(int x){\n\tif(x>9) print(x/10);\n\tputchar(x%10+'0');\t\n}\n\ninline int power(int a,int t){\n\tint res = 1;\n\twhile(t){\n\t\tif(t&1) res = (ll)res*a%p;\n\t\ta = (ll)a*a%p;\n\t\tt >>= 1; \n\t}\n\treturn res;\n}\n\nint rt[N],rev[N],inv[N],fac[N],ifac[N];\nint siz;\n\ninline int binom(int x,int y){\n    if(x<y) return 0;\n    return (ll)fac[x]*ifac[y]%p*ifac[x-y]%p;\n}\n\nvoid init(int n){\n\tint w,lim = 1;\n\twhile(lim<=n) lim <<= 1,++siz;\n\tfor(reg int i=1;i!=lim;++i) rev[i] = (rev[i>>1]>>1)|((i&1)<<(siz-1));\n\tw = power(3,(p-1)>>siz);\n\tfac[0] = fac[1] = ifac[0] = ifac[1] = inv[1] = rt[lim>>1] = 1;\n\tfor(reg int i=(lim>>1)+1;i!=lim;++i) rt[i] = (ll)rt[i-1]*w%p;\n\tfor(reg int i=(lim>>1)-1;i;--i) rt[i] = rt[i<<1];\t\n\tfor(reg int i=2;i<=lim;++i) inv[i] = (ll)(p-p/i)*inv[p%i]%p;\n    for(reg int i=2;i<=lim;++i) ifac[i] = fac[i] = (ll)fac[i-1]*i%p;\n    ifac[lim] = power(fac[lim],p-2);\n    for(reg int i=lim-1;i;--i) ifac[i] = (ll)ifac[i+1]*(i+1)%p;\n}\n\ninline int getlen(int n){\n\treturn 1<<(32-__builtin_clz(n));\t\n}\n\ninline void NTT(int *f,int type,int lim){\n\tif(type==-1) reverse(f+1,f+lim);\n\treg int x,shift = siz-__builtin_ctz(lim);\n\tstatic int a[N];\n\tfor(reg int i=0;i!=lim;++i) a[rev[i]>>shift] = f[i];\n\tfor(reg int mid=1;mid!=lim;mid<<=1){\n\t\tfor(reg int j=0;j!=lim;j+=(mid<<1)){\n\t\t\tfor(reg int k=0;k!=mid;++k){\n\t\t\t\tx = (ll)a[j|k|mid]*rt[mid|k]%p;\n\t\t\t\ta[j|k|mid] = dec(a[j|k],x);\n\t\t\t\ta[j|k] = add(a[j|k],x);\n\t\t\t}\n\t\t}\n\t}\n\tmemcpy(f,a,lim<<2);\n\tif(type==1) return;\n\tx = inv[lim];\n\tfor(reg int i=0;i!=lim;++i) f[i] = (ll)f[i]*x%p;\n}\n\nvoid inverse(const int *f,int *R,int n){\n\tstatic int g[N],h[N],q[N];\n\tmemset(g,0,getlen(n<<1)+2<<2);\n\tint lim = 1,top = 0;\n\tint s[30];\n\twhile(n){\n\t\ts[++top] = n;\n\t\tn >>= 1;\n\t}\n\tg[0] = power(f[0],p-2);\n\twhile(top--){\n\t\tn = s[top+1];\n\t\twhile(lim<=(n<<1)) lim <<= 1;\n\t\tmemcpy(q,g,(n+1)<<2);\n\t\tmemcpy(h,f,(n+1)<<2);\n\t\tmemset(h+n+1,0,(lim-n)<<2);\n\t\tNTT(g,1,lim),NTT(h,1,lim);\n\t\tfor(reg int i=0;i!=lim;++i) g[i] = (ll)g[i]*g[i]%p*h[i]%p;\n\t\tNTT(g,-1,lim);\n\t\tfor(reg int i=0;i<=n;++i) g[i] = dec(add(q[i],q[i]),g[i]);\n\t\tmemset(g+n+1,0,(lim-n)<<2);\n\t}\n\tmemcpy(R,g,(n+1)<<2);\n}\n\nvoid divide(const int *f,const int *g,int n,int m,int *R){\n\tstatic int A[N],B[N];\n    memcpy(A,f,(n+1)<<2);\n\tmemcpy(B,g,(m+1)<<2);\n    reverse(A,A+n+1);\n    reverse(B,B+m+1);\n    int tt = n-m,lim = getlen((n-m)<<1);\n    for(reg int i=tt+1;i!=lim;++i) A[i] = 0;\n    for(reg int i=min(m,tt)+1;i!=lim;++i) B[i] = 0;\n    inverse(B,B,tt);\n    NTT(A,1,lim),NTT(B,1,lim);\n    for(reg int i=0;i!=lim;++i) A[i] = (ll)A[i]*B[i]%p;\n    NTT(A,-1,lim);\n    reverse(A,A+tt+1);\n    memcpy(R,A,(tt+1)<<2);\n}\n\nvoid mod(const int *f,const int *g,int n,int m,int *R){\n    if(n<m){\n        memcpy(R,f,(n+1)<<2);\n        return;\n    }   \n    static int A[N],B[N];\n    memcpy(B,f,(n+1)<<2);\n    int lim = getlen(n);\n\tdivide(f,g,n,m,R);\n\tfor(int i=0;i<=m;++i) A[i] = g[i];\n\tfor(int i=m+1;i!=lim;++i) A[i] = 0;\n\tfor(int i=n-m+1;i!=lim;++i) R[i] = 0;\n\tNTT(A,1,lim),NTT(R,1,lim);\n    for(reg int i=0;i!=lim;++i) R[i] = (ll)A[i]*R[i]%p;\n    NTT(R,-1,lim);\n    for(reg int i=0;i!=m;++i) R[i] = dec(B[i],R[i]);\n    for(int i=m;i!=lim;++i) R[i] = 0;\n}\n\n#define mid ((l+r)>>1)\n#define ls (u<<1)\n#define rs (u<<1|1)\nint bflim;\nint *P[N],len[N];\n\nvoid prepare(int l,int r,int u,const int *a){ //\u5206\u6cbb\u4e58,\u591a\u70b9\u6c42\u503c\u7528\n\tif(l==r){\n\t\tlen[u] = 1;\n\t\tP[u] = new int[2];\n\t\tP[u][0] = p-a[l],P[u][1] = 1;\n\t\treturn;\n\t}\n\tprepare(l,mid,ls,a);\n\tprepare(mid+1,r,rs,a);\n\tlen[u] = r-l+1;\n\tint lim = getlen(len[u]);\n\tP[u] = new int[len[u]+1];\n\tint F[lim+1],G[lim+1];\n\tmemcpy(F,P[ls],(len[ls]+1)<<2);\n\tmemcpy(G,P[rs],(len[rs]+1)<<2);\n\tif(r-l>bflim){\n\t\tmemset(F+len[ls]+1,0,(lim-len[ls]+1)<<2);\n\t\tmemset(G+len[rs]+1,0,(lim-len[rs]+1)<<2);\n\t\tNTT(F,1,lim),NTT(G,1,lim);\n\t\tfor(reg int i=0;i!=lim;++i) F[i] = (ll)F[i]*G[i]%p;\n\t\tNTT(F,-1,lim);\n\t\tmemcpy(P[u],F,(len[u]+1)<<2);\n\t}else{\n\t\tmemset(P[u],0,(len[u]+1)<<2);\n\t\tfor(reg int i=0;i<=len[ls];++i)\n\t\tfor(reg int j=0;j<=len[rs];++j)\n\t\t\tP[u][i+j] = (P[u][i+j]+(ll)F[i]*G[j])%p;\n\t}\n}\n\nvoid solve(const int *F,int l,int r,const int *a,int u,int n,int *R){ //\u591a\u70b9\u6c42\u503c\n\tif(r-l<=bflim){ //\u5c0f\u8303\u56f4\u66b4\u529b\n\t\tll pw[17];\n\t\tint res,x;\n\t\tll s1,s2,s3,s4;\n\t\tpw[0] = 1;\n\t\tfor(reg int j=l;j<=r;++j){\n\t\t\tres = F[n],x = a[j];\n\t\t\treg int i = 1;\n\t\t\tfor(;i<=16;++i) pw[i] = pw[i-1]*x%p;\n\t\t\ti = n-1;\n\t\t\twhile(i>=15){\n\t\t\t\ts1 = res*pw[16]+F[i]*pw[15]+F[i-1]*pw[14]+F[i-2]*pw[13];\n\t\t\t\ts2 = F[i-3]*pw[12]+F[i-4]*pw[11]+F[i-5]*pw[10]+F[i-6]*pw[9];\n\t\t\t\ts3 = F[i-7]*pw[8]+F[i-8]*pw[7]+F[i-9]*pw[6]+F[i-10]*pw[5];\n\t\t\t\ts4 = F[i-11]*pw[4]+F[i-12]*pw[3]+F[i-13]*pw[2]+F[i-14]*x;\n\t\t\t\tres = ((F[i-15]+s1+s2)%p+s3+s4)%p;\n\t\t\t\ti -= 16;\n\t\t\t}\n\t\t\ti = (n&15)-1;\n\t\t\tfor(;~i;--i) res = ((ll)res*x+F[i])%p;\n\t\t\tR[j] = res;\n\t\t}\n\t\treturn;\n\t}\n\tint G[getlen(n<<1)+1];\n\tmemset(G,0,sizeof(G));\n\tmod(F,P[ls],n,len[ls],G);\n\tsolve(G,l,mid,a,ls,len[ls]-1,R);\n\tmemset(G,0,sizeof(G));\n\tmod(F,P[rs],n,len[rs],G);\n\tsolve(G,mid+1,r,a,rs,len[rs]-1,R);\n}\n\nvoid evaluation(const int *F,int *a,int n,int m,int *R){\n\tbflim = log2(m);\n\tprepare(1,m,1,a);\n\tsolve(F,1,m,a,1,n,R);\n}\n\n#undef ls\n#undef rs\n#undef mid\n\nvoid multiply(const int *F,const int *G,int n,int m,int len,int *R){\n    static int A[N],B[N];\n    memcpy(A,F,(n+1)<<2);\n    memcpy(B,G,(m+1)<<2);\n    int lim = getlen(n+m);\n    memset(A+n+1,0,(lim-n+2)<<2);\n    memset(B+m+1,0,(lim-m+2)<<2);\n    NTT(A,1,lim),NTT(B,1,lim);\n    for(reg int i=0;i!=lim;++i) R[i] = (ll)A[i]*B[i]%p;\n    NTT(R,-1,lim);\n    memset(R+len+1,0,(lim-len+2)<<2);\n}\n\nvoid mod_power(const int *G,int k,int t,int *R){ //\u591a\u9879\u5f0f\u5feb\u901f\u5e42 (\u6a21G(x))\n    int f[N],g[N];\n    memset(f,0,sizeof(f));\n    memset(g,0,sizeof(g));\n    int n = 1,m = 0;\n    f[1] = g[0] = 1;\n    while(t){\n        if(t&1){\n            multiply(f,g,n,m,n+m,g);\n            mod(g,G,n+m,k,g);\n            m = min(n+m,k-1);\n        }\n        int lim = getlen(n<<1);\n        NTT(f,1,lim);\n        for(reg int i=0;i!=lim;++i) f[i] = (ll)f[i]*f[i]%p;\n        NTT(f,-1,lim);\n        mod(f,G,n<<1,k,f);\n        n = min(n<<1,k-1);\n        t >>= 1;\n    }\n    memcpy(R,g,k<<2);\n}\n\nint n,m,k,ans,T;\nint F[N],G[N],B[N],A[N],a[N],f[N],d[N];\n\nint main(){\n    init(100000);\n\tread(n),read(m),read(k);\n\tfor(reg int i=0;i!=k;++i) read(a[i]);\n\tfor(reg int i=1;i<=k;++i) read(f[i]);\n    for(reg int i=0;i<=m;++i) read(G[i]);\n    for(reg int i=0;i<=m;++i) d[i+1] = i+k;\n\tevaluation(G,d,m,m+1,B); //\u6784\u9020B\u7684\u540e\u534a\u90e8\u5206\n    for(reg int i=k+m;i>=k;--i) B[i] = B[i-k+1];\n    for(reg int i=0;i!=k;++i) B[i] = 0;\n    multiply(f,a,k,k,k-1,d); //\u4e00\u6ce2\u5377\u79ef\u6c42\u51faB\u7684\u524d\u534a\u90e8\u5206\n    for(reg int i=0;i!=k;++i) B[i] = dec(a[i],d[i]);\n    f[0] = p-1;\n    for(reg int i=0;i<=k;++i) F[i] = p-f[i];\n    inverse(F,F,m+k);\n    multiply(F,B,m+k,m+k,m+k,A); //\u6c42\u9006\u7b97\u51faA\n    for(reg int i=0;i<=m+k;++i) a[i] = A[i];\n    memset(F,0,sizeof(F));\n    for(reg int i=0;i<=m+1;++i) F[i] = (m+1-i)&1?p-binom(m+1,i):binom(m+1,i); //\u9ad8\u9636\u5dee\u5206\u7cfb\u6570\n    T = m+k+1;\n    multiply(F,f,m+1,k,T,f); //\u5316\u4e3a\u9f50\u6b21\u9012\u63a8\n    memset(G,0,sizeof(G));\n    for(reg int i=0;i<=T;++i) G[T-i] = p-f[i];\n    mod_power(G,T,n,F);\n    for(reg int i=0;i!=T;++i) ans = (ans+(ll)F[i]*a[i])%p;\n    print(ans);\n\treturn 0;\t\n}\n```",
        "postTime": 1576241236,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5808 \u3010\u5e38\u7cfb\u6570\u975e\u9f50\u6b21\u7ebf\u6027\u9012\u63a8\u3011"
    },
    {
        "content": "\u80e1\u4e00\u4e2a\u76f4\u63a5\u901a\u8fc7\u9f50\u6b21\u7ebf\u6027\u9012\u63a8\u5f97\u5230\u505a\u6cd5\u7684\u65b9\u6cd5\u4ee5\u4f9b\u53c2\u8003\u3002~~\u56e0\u4e3a\u61d2~~\u6ca1\u6709\u5199\u4ee3\u7801\uff0c\u7eaf\u5c5e\u53e3\u80e1\uff0c\u5982\u6709\u9519\u8bef\u8bf7\u53ca\u65f6\u544a\u77e5\uff0c\u5982\u679c\u6211\u6ca1\u6709\u9000\u5f79\u4f1a\u53ca\u65f6\u4fee\u590d\uff0c\u8c22\u8c22\u3002\n\n### \u95ee\u9898\u5f15\u5165\n\n**\u56e0\u4e3a\u4e00\u4e9b\u539f\u56e0\uff0c\u53d8\u91cf\u540d\u4e0e\u9898\u9762\u4e2d\u7684\u53d8\u91cf\u540d\u6709\u4e0d\u540c\uff0c\u9898\u89e3\u4e2d\u4ee5\u8fd9\u91cc\u58f0\u660e\u7684\u53d8\u91cf\u540d\u4e3a\u51c6**\n\n\u7ed9\u51fa\u4e00\u591a\u9879\u5f0f$F(x) = \\sum\\limits_{i=0}^{k} f_ix^i$\u548c\u9012\u63a8\u5f0f$a_p = \\sum\\limits_{i=1}^n b_ia_{p-i} + F(p)(p \\geq n)$\u548c\u521d\u59cb\u503c$a_0,a_1,...,a_{n-1}$\uff0c\u6c42$b_m$\u7684\u503c\u3002$n,k \\leq 30000 , m < 10^9$\u3002\n\n### \u524d\u7f6e\u829d\u58eb\n\n- \u638c\u63e1[\u5e38\u7cfb\u6570\u9f50\u6b21\u7ebf\u6027\u9012\u63a8](https://www.luogu.com.cn/problem/P4723)\u7684\u8bc1\u660e\u8fc7\u7a0b\uff0c\u4e0d\u9700\u8981\u4f1a\u8bc1\u660eCH\u5b9a\u7406\u3002\n\n- [\u5e38\u7cfb\u6570\u9f50\u6b21\u7ebf\u6027\u9012\u63a8](https://www.luogu.com.cn/problem/P4723)\u7684\u677f\u5b50\n\n- \u591a\u9879\u5f0f\u591a\u70b9\u6c42\u503c\n\n- \u57fa\u672c\u7ebf\u6027\u4ee3\u6570\u77e5\u8bc6\n\n### \u7b97\u6cd5\u6d41\u7a0b\n\n\u7c7b\u4f3c\u4e8e\u9f50\u6b21\u7ebf\u6027\u9012\u63a8\uff0c\u6211\u4eec\u5148\u8003\u8651\u77e9\u9635\u5feb\u901f\u5e42\u7684\u66b4\u529b\uff1a\n\n\u8bbe\n\n$$A = \\begin{array}{cccc}(a_{n-1} & a_{n-2} & ... & a_0 & n^k & n^{k-1} & ... & n^0) \\end{array}$$\n\n$$B = \\left(\\begin{array}{cccc} {B_1}_{n \\times n} & 0_{n \\times (k+1)} \\\\ {B_2}_{(k+1) \\times n} & {B_3}_{(k+1) \\times (k+1)} \\end{array} \\right)$$\n\n\u5176\u4e2d\n\n$${B_1}_{n \\times n} = \\left(\\begin{array}{cccc} b_1 & 1 & 0 & 0 & ... & 0 \\\\ b_2 & 0 & 1 & 0 & ... & 0 \\\\ b_3 & 0 & 0 & 1 & ... & 0 \\\\ \\vdots & \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\ b_n & 0 & 0 & 0 & ... & 0 \\end{array}\\right)$$\n\n$${B_2}_{(k+1) \\times n} = \\left(\\begin{array}{cccc} f_k & 0 & 0 & ... & 0 \\\\ f_{k-1} & 0 & 0 & ... & 0 \\\\ \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\ f_0 & 0 & 0 & ... & 0 \\end{array} \\right)$$\n\n$${B_3}_{(k+1) \\times (k+1)} = \\left(\\begin{array}{cccc} \\binom{k}{k} & 0 & 0 & ... & 0 \\\\ \\binom{k}{k-1} & \\binom{k-1}{k-1} & 0 & ... & 0 \\\\ \\binom{k}{k-2} & \\binom{k-1}{k-2} & \\binom{k - 2}{k-2} & ... & 0 \\\\ \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\ \\binom{k}{0} & \\binom{k - 1}{0} & \\binom{k - 2}{0} & ... & \\binom{0}{0} \\end{array} \\right)$$\n\n$B_1$\u77e9\u9635\u5c31\u662f\u9f50\u6b21\u7ebf\u6027\u9012\u63a8\u4e2d\u7684\u77e9\u9635\uff0c$B_2$\u5c06$F(n)$\u52a0\u5165\u8fdb\u5f53\u524d\u7684\u6570\uff0c\u800c$B_3$\u901a\u8fc7\u4e8c\u9879\u5f0f\u5b9a\u7406\u5c06$\\begin{array}{cccc} (n^k & n^{k-1} & ... & n^0) \\end{array}$\u53d8\u4e3a$\\begin{array}{cccc} ((n+1)^k & (n+1)^{k-1} & ... & (n+1)^0) \\end{array}$\u3002\n\n\u90a3\u4e48\u7b54\u6848\u5c31\u662f$(AB^m)_n$\u3002\n\n\u6211\u4eec\u5982\u679c\u53ef\u4ee5\u5f97\u5230$B$\u7684\u7279\u5f81\u591a\u9879\u5f0f$f(\\lambda) = |\\lambda I - B|$\u5c31\u662f\u9f50\u6b21\u7ebf\u6027\u9012\u63a8\u90a3\u4e00\u5957\u4e86\u3002\n\n\u6ce8\u610f\u5230$\\lambda I - B = \\left(\\begin{array}{cccc} \\lambda I - B_1 & 0 \\\\ -B_2 & \\lambda I - B_3 \\end{array} \\right)$\uff0c\u5229\u7528\u77e9\u9635\u5206\u5757\u7684\u7ecf\u5178\u7ed3\u8bba\uff0c$|\\lambda I - B| = |\\lambda I - B_1||\\lambda I - B_3|$\u3002\n\n\u5728\u9f50\u6b21\u7ebf\u6027\u9012\u63a8\u4e2d\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86$|\\lambda I - B_1| = \\lambda^n - \\sum\\limits_{j=1}^{n}b_i \\lambda^{n-i}$\uff0c\u800c$\\lambda I - B_3$\u662f\u4e00\u4e2a\u4e0b\u4e09\u89d2\u77e9\u9635\uff0c\u6545$|\\lambda I - B_3| = (\\lambda - 1)^{k+1}$\uff0c\u90a3\u4e48$|\\lambda I - B| = (\\lambda - 1)^{k+1}(\\lambda^n - \\sum\\limits_{j=1}^{n}b_i \\lambda^{n-i})$\u3002\u5377\u4e00\u4e0b\u5c31\u53ef\u4ee5\u5f97\u5230\u5176\u8868\u793a\u3002\n\n---\n\n\u53ef\u4ee5\u53d1\u73b0\u5176\u7279\u5f81\u591a\u9879\u5f0f\u662f$n+k+1$\u6b21\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8fd8\u9700\u8981\u6c42\u51fa$a_n , a_{n+1} , ... , a_{n+k}$\u624d\u884c\u3002\n\n\u5b9a\u4e49$b_0 = 0$\uff0c\u9012\u63a8\u5f0f\u53ef\u4ee5\u88ab\u8868\u793a\u4e3a$A(x) = A(x) * B(x) + P(x)$\u7684\u5f62\u5f0f\uff0c\u5176\u4e2d$A(x) = \\sum\\limits_{i=0}^ \\infty a_ix^i , B(x) = \\sum\\limits_{i=0}^n b_ix^i$\uff0c\u800c$P(x)$\u5219\u76f8\u5bf9\u590d\u6742\uff1a\u5728$i \\geq n$\u65f6\u9075\u5faa\u9012\u63a8\u5f0f\uff0c\u90a3\u4e48$[x^i]P(x) = F(i)$\uff1b\u5728$i < n$\u65f6\u9700\u8981\u7528$P(x)$\u628a\u7cfb\u6570\u8865\u4e0a\uff0c\u90a3\u4e48$[x^i]P(x) = a_i - \\sum\\limits_{j=0}^i a_jb_{i-j}$\u3002\n\n\u90a3\u4e48$A(x) = \\frac{P(x)}{1 - B(x)}$\uff0c\u6c42\u9006\u5377\u4e00\u4e0b\u7136\u540e\u591a\u70b9\u6c42\u503c\u5c31\u53ef\u4ee5\u5f97\u5230$A(x)$\u7684\u524d$n+k$\u9879\u3002\n\n---\n\n\u7b97\u6cd5\u5230\u6b64\u7ed3\u675f\uff0c\u62c9\u677f\u5b50\u5373\u53ef\u3002\u590d\u6742\u5ea6$O(n \\log n (\\log n + \\log m))$\u3002",
        "postTime": 1579002092,
        "uid": 96296,
        "name": "Itst",
        "ccfLevel": 0,
        "title": "\u5e38\u7cfb\u6570\u975e\u9f50\u6b21\u7ebf\u6027\u9012\u63a8"
    },
    {
        "content": "\u8fd9\u91cc\u662f\u4e00\u79cd\u7528\u65b0\u7ebf\u6027\u9012\u63a8\u7684\u65b9\u6cd5\u6765\u89e3\u51b3\u8fd9\u9053\u9898\u3002\n\n\u65b0\u7ebf\u6027\u9012\u63a8\u672c\u8d28\u4e0a\u662f\u5bf9 $x^n$ \u5bf9\u9996\u4e00\u591a\u9879\u5f0f\u53d6\u6a21\u7684\u7ed3\u679c\uff0c\u4f46\u662f\u5728\u8fd9\u9898\u91cc\u9762\u7279\u5f81\u591a\u9879\u5f0f\u4e0d\u518d\u4e00\u5b9a\u9996\u4e00\u3002\n\n\u4e0d\u8fc7\u6211\u4eec\u89c2\u5bdf\u5230\u5f53\u4e14\u4ec5\u5f53\u5728 $2|m$ \u7684\u65f6\u5019\u9996\u4f4d\u4f1a\u53d8\u6210 $-1$\uff0c\u800c $x^n\\bmod f$ \u548c $x^n\\bmod -f$ \u7684\u7ed3\u679c\u662f\u4e00\u81f4\u7684\uff0c\u800c\u8fd9\u65f6 $f$ \u5c31\u4f1a\u518d\u6b21\u53d8\u6210\u9996\u4e00\uff0c\u56e0\u6b64\u6211\u4eec\u505a\u4e00\u4e2a\u7279\u5224\u5c31\u53ef\u4ee5\u8fc7\u4e86\u3002\n\n\u7531\u4e8e\u65b0\u7ebf\u6027\u9012\u63a8\u7b97\u6cd5\u7684\u4f18\u8d8a\u6027\uff0c\u8fd9\u4efd\u4ee3\u7801\u5373\u4f7f\u662f\u8fdb\u884c\u4e86\u5927\u91cf\u7684\u5c01\u88c5\u4e5f\u4ee5\u524d\u6700\u4f18\u89e3\u6240\u9700\u65f6\u95f4\u7684\u4e00\u534a\u6210\u4e3a\u4e86\uff08\u5230\u76ee\u524d\u4e3a\u6b62\u7684\uff09\u6700\u4f18\u89e3\u3002\n\nCode\uff1a\n```cpp\nmi poly::LNRR(const poly&P,const vec&a,int n)const{\n\tint m=P.deg(),k=a.size();\n\tvec d(m+1);\n\trep(i,0,m)d[i]=i+k;\n\tvec b=tp.eval(P,d);\n\tb.resize(k+m+1);\n\tRep(i,k+m,k)b[i]=b[i-k];\n\tmemset(b.data(),0,sizeof(mi)*k);\n\tauto res=operator*(poly(a)).shift(1);\n\trep(i,0,k-1)b[i]=a[i]-res[i];\n\tpoly B(b),F=shift(1),A=B.quo((poly(1)-F).slice(m+k));\n\tF.redeg(m+1);\n\trep(i,0,m+1)\n\t\tif((m+1-i)&1)F[i]=-math.binom(m+1,i);\n\t\telse F[i]=math.binom(m+1,i);\n\tint T=m+k;\n\tpoly f=((shift(1)-1)*F);\n\tif(f[0]==1)f=-f;//\u4e0a\u6587\u6240\u8bb2\u5230\u7684\u7279\u5224\n\treturn f.shift(-1).slice(T).LHRR(A.a,n);\n}\nint main(){\n\tint n,m,k;\n\tIO>>n>>m>>k;\n\tvec a(k);\n\tpoly f=zeroes(k-1),P=zeroes(m);\n\tIO>>a>>f.a>>P.a;\n\tIO<<f.LNRR(P,a,n);\n\treturn 0;\n}\n```\n",
        "postTime": 1637978378,
        "uid": 121027,
        "name": "Spasmodic",
        "ccfLevel": 7,
        "title": "\u5e38\u7cfb\u6570\u975e\u9f50\u6b21\u7ebf\u6027\u9012\u63a8"
    }
]
[
    {
        "content": "\u9996\u5148\uff0c\u8fdb\u884c\u5982\u4e0b\u5904\u7406\uff1a\n\n1\u3001\u5982\u679c$L$\u662f$K$\u7684\u500d\u6570\uff0c\u90a3\u4e48\u628a$L$\u53d8\u4e3a$\\frac{L}{K}$\uff0c\u5426\u5219\u53d8\u4e3a$\\lfloor\\frac{L}{K}\\rfloor+1$\u3002\n\n2\u3001\u628a$H$\u53d8\u6210$\\lfloor\\frac{H}{K}\\rfloor$\u3002\n\n\u8fd9\u6837\u5b50\u5bb9\u6613\u5f97\u51fa\uff0c\u73b0\u5728\u8981\u6c42\u7684\u5c31\u662f\u5728$[L,H]$\u4e4b\u95f4\uff0c\u9009\u6570$N$\u6b21\u4f7f\u9009\u51fa\u7684\u6570\u6700\u5927\u516c\u7ea6\u6570\u4e3a$1$\u7684\u65b9\u6848\u6570\u3002\n\n\u73b0\u5728\uff0c\u7528$f[i]$\u8868\u793a\u9009\u51fa\u7684\u6570\u7684\u6700\u5927\u516c\u7ea6\u6570$i$\u4e14\u9009\u51fa\u7684\u6570**\u4e0d\u5168\u76f8\u540c**\u7684\u65b9\u6848\u6570\u3002\u6b64\u65f6\u5148\u6c42\u51fa$[L,H]$\u4e4b\u95f4$i$\u7684\u500d\u6570\u7684\u4e2a\u6570$x$\uff0c\u6682\u65f6\u4ee4$f[i]=x^N-x$\u3002\n\n\u4f46\u6b64\u65f6\u5f97\u5230\u7684$f[i]$\u5b9e\u9645\u4e0a\u662f**\u542b\u6709\u516c\u7ea6\u6570**$i$\u7684\u65b9\u6848\u6570\uff0c\u4e0d\u662f\u6700\u5927\u516c\u7ea6\u6570\u4e3a$i$\u7684\u65b9\u6848\u6570\u3002\u4f46\u662f\u53ef\u4ee5\u53d1\u73b0\uff0c\u6b64\u65f6\u7684$f[i]$\u5305\u542b\u6709\u6700\u5927\u516c\u7ea6\u6570\u4e3a$i,2i,3i,...$\u7684\u65b9\u6848\u6570\u3002\u8fd9\u65f6\u5019\u4f7f\u7528\u5bb9\u65a5\u539f\u7406\uff1a\u5047\u8bbe\u5df2\u7ecf\u77e5\u9053\u4e86$f[2i],f[3i],...$\u7684**\u6700\u7ec8\u7ed3\u679c**\uff0c\u90a3\u4e48\u5c31\u628a$f[i]$\u5206\u522b\u51cf\u53bb$f[2i],f[3i],...$\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230$f[i]$\u7684\u6700\u7ec8\u7ed3\u679c\u3002\u5012\u7740\u63a8\u4e00\u904d\u3002\n\n\u7279\u6b8a\u60c5\u51b5\uff1a$L=1$\u65f6\u53ef\u4ee5\u6240\u6709\u7684\u6570\u90fd\u9009$1$\u3002\u6240\u4ee5$L=1$\u65f6\u7b54\u6848\u8981\u52a0$1$\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\ninline int read() {\n    int res = 0; bool bo = 0; char c;\n    while (((c = getchar()) < '0' || c > '9') && c != '-');\n    if (c == '-') bo = 1; else res = c - 48;\n    while ((c = getchar()) >= '0' && c <= '9')\n        res = (res << 3) + (res << 1) + (c - 48);\n    return bo ? ~res + 1 : res;\n}\nconst int N = 1e5 + 5, PYZ = 1e9 + 7;\nint n, K, L, H, f[N];\nint qpow(int a, int b) {\n    int res = 1;\n    while (b) {\n        if (b & 1) res = 1ll * res * a % PYZ;\n        a = 1ll * a * a % PYZ;\n        b >>= 1;\n    }\n    return res;\n}\nint main() {\n    int i, j; n = read(); K = read(); L = read(); H = read();\n    if (L % K) L = L / K + 1; else L /= K; H /= K;\n    if (L > H) return puts(\"0\"), 0;\n    for (i = 1; i <= H - L; i++) {\n        int l = L, r = H;\n        if (l % i) l = l / i + 1; else l /= i; r /= i;\n        if (l > r) continue;\n        f[i] = (qpow(r - l + 1, n) - (r - l + 1) + PYZ) % PYZ;\n    }\n    for (i = H - L; i; i--) for (j = (i << 1); j <= H - L; j += i)\n        f[i] = (f[i] - f[j] + PYZ) % PYZ;\n    if (L == 1) (f[1] += 1) %= PYZ; cout << f[1] << endl;\n    return 0;\n}\n```",
        "postTime": 1508640801,
        "uid": 29936,
        "name": "xyz32768",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3172 \u3010[CQOI2015]\u9009\u6570\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u81ea\u7136\u662f\u53ef\u4ee5\u53cd\u6f14\u7684\n\n\u6309\u7167\u53cd\u6f14\u7684\u5957\u8def\u6211\u4eec\u5148\u8bbe\u51fa\u4e24\u4e2a\u51fd\u6570\n\n$F(n)$\u8868\u793a\u4ece$[L,H]$\u4e2d\u4efb\u9009$N$\u4e2a\u6570\u7684\u6700\u5927\u516c\u7ea6\u6570\u662f$n$\u6216\u8005$n$\u7684\u500d\u6570\u7684\u60c5\u51b5\u6570\n\n$f(n)$\u8868\u793a\u4ece$[L,H]$\u4e2d\u4efb\u9009$N$\u4e2a\u6570\u7684\u6700\u5927\u516c\u7ea6\u6570\u662f$n$\u7684\u60c5\u51b5\u6570\n\n\u975e\u5e38\u663e\u7136\u7684\u662f\n\n$$F(n)=\\sum_{n|d}f(d)$$\n\n$$f(n)=\\sum_{n|d}\\mu(\\frac{d}{n})F(d)$$\n\n\u5f00\u59cb\u53cd\u6f14\u4e86\n\n\u9996\u5148\u6211\u4eec\u53d1\u73b0\u6211\u4eec\u6c42$f(k)$\u5e76\u4e0d\u597d\u6c42\uff0c\u56e0\u4e3a\u6ca1\u6709\u529e\u6cd5\u6574\u9664\u5206\u5757\n\n\u6240\u4e00\u6211\u4eec\u628a$L/k,H/k$\u4e4b\u540e\u6c42$f(1)$\u5c31\u597d\u4e86\n\n\u5417\uff1f\n\n\u663e\u7136\u5e76\u4e0d\u884c\u554a\n\n\u6211\u4eec\u8003\u8651\u4e00\u4e0b\u5982\u679c$L\\%k!=0$\uff0c$\\left \\lfloor \\frac{L}{k} \\right \\rfloor\\times k<L$,\u5c31\u4f1a\u4f7f\u4e00\u4e9b\u4e0d\u5728$[L,H]$\u5185\u7684\u6570\u6df7\u8fdb\u7b54\u6848\u91cc\u4e86\n\n\u6240\u4ee5\u5982\u679c$L\\%k!=0$\u7684\u8bdd\uff0c\u9664\u4ee5$k$\u4e4b\u540e\u518d\u5c06$L+1$\n\n\u4e4b\u540e\u5c31\u662f\u5982\u4f55\u8868\u793a$F$\u4e86\n\n\u975e\u5e38\u663e\u7136\u5c31\u662f\n\n$$F(n)=(\\left \\lfloor  \\frac{H}{n}\\right \\rfloor-\\left \\lfloor  \\frac{L-1}{n}\\right \\rfloor)^N$$\n\n\u4e86\n\n$$f(1)=\\sum_{i=1}\\mu(i)F(i)$$\n\n\u628a$F(i)$\u76f8\u7b49\u7684\u7528\u6574\u9664\u5206\u5757\u5904\u7406\n\n\u4f46\u662f\u8fd9\u9053\u9898\u7684$H$\u975e\u5e38\u5927\uff0c\u751a\u81f3\u90fd\u4e0d\u80fd\u7ebf\u7b5b\n\n\u4e0d\u80fd\u7ebf\u7b5b\u675c\u6559\u7b5b\u603b\u53ef\u4ee5\u4e86\u5427\uff0c\u4e8e\u662f\u5c31\u53ef\u4ee5\u7528$O(H^{\\frac{2}{3}})$\u7684\u590d\u6742\u5ea6\u89e3\u51b3\u8fd9\u9053\u9898\n\n```cpp\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<tr1/unordered_map>\n#define re register\n#define maxn 5000001\n#define LL long long\n#define max(a,b) ((a)>(b)?(a):(b))\n#define min(a,b) ((a)<(b)?(a):(b))\nconst int mod=1000000007;\nusing namespace std::tr1;\nunordered_map<int,int> ma;\nint p[maxn>>1],f[maxn],mu[maxn];\ninline LL quick(int a,int b)\n{\n    LL S=1;\n    while(b) {if(b&1) S=S*a%mod;b>>=1;a=(LL)a*(LL)a%mod;}\n    return S;\n}\nint N,K,L,H,M;\nint solve(int x)\n{\n    if(x<=M) return mu[x];\n    if(ma.find(x)!=ma.end()) return ma[x];\n    int ans=1;\n    for(re int l=2,r;l<=x;l=r+1)\n    {\n        r=x/(x/l);\n        ans-=solve(x/l)*(r-l+1);\n    }\n    return ma[x]=ans;\n}\nint main()\n{\n    scanf(\"%d%d%d%d\",&N,&K,&L,&H);\n    H/=K;\n    if(L%K==0) L=L/K;\n        else L=L/K+1;\n    M=min(H,5000000);\n    mu[1]=f[1]=1;\n    for(re int i=2;i<=M;i++)\n    {\n        if(!f[i]) p[++p[0]]=i,mu[i]=-1;\n        for(re int j=1;j<=p[0]&&p[j]*i<=M;j++)\n        {\n            f[p[j]*i]=1;\n            if(i%p[j]==0) break;\n            mu[i*p[j]]=-1*mu[i];\n        }\n    }\n    for(re int i=1;i<=M;i++) mu[i]+=mu[i-1];\n    LL ans=0;L--;\n    for(re int l=1,r;l<=H;l=r+1)\n    {\n        if(!(L/l)) r=H/(H/l);\n            else r=min(H/(H/l),L/(L/l));\n        ans=(ans+quick(H/l-L/l,N)*(LL)(solve(r)-solve(l-1))%mod)%mod;\n    }\n    printf(\"%lld\\n\",((ans%mod)+mod)%mod);\n    return 0;\n}\n\n```",
        "postTime": 1544354967,
        "uid": 35178,
        "name": "asuldb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3172 \u3010[CQOI2015]\u9009\u6570\u3011"
    },
    {
        "content": "\u9898\u76ee\u8981\u6c42\uff08\u4ee4$H$\u53d8\u4e3a$R$\uff09\n\n$$\\sum\\limits_{a_1=L}^R\\sum\\limits_{a_2=L}^R...\\sum\\limits_{a_n=L}^R[\\gcd\\limits_{i=1}^n(a_i)=K]$$\n\n\u540c\u6837\u7684\uff0c\u6211\u4eec\u4ee4\u6240\u6709\u6570\u6574\u9664\u4e00\u4e2a$K$\uff0c\u6ce8\u610f\u5230$L\\leqslant a_i\\leqslant R$\uff0c\u90a3\u4e48\u518d\u6b21\u679a\u4e3e\u7684$a_i'$\u8981\u6ee1\u8db3$L\\leqslant a_i'\u00d7K\\leqslant R$\uff0c\u6240\u4ee5\u6709\n\n$$\\sum\\limits_{a_1=\\lfloor\\frac{L-1}{d}\\rfloor+1}^{\\lfloor\\frac{R}{d}\\rfloor}...\\sum\\limits_{a_n=\\lfloor\\frac{L-1}{d}\\rfloor+1}^{\\lfloor\\frac{R}{d}\\rfloor}[\\gcd\\limits_{i=1}^n(a_i)=1]$$\n\n\u5bf9\u6700\u540e\u4e00\u90e8\u5206\u53cd\u6f14\uff0c\u5e76\u4e14\u5c06\u679a\u4e3e$x$\u63d0\u524d\uff0c\u5f97\u5230\n\n$$\\sum\\limits_{x=1}^{\\lfloor\\frac{R}{d}\\rfloor}\\mu(x)\\sum\\limits_{a_1=\\lfloor\\frac{L-1}{d}\\rfloor+1}^{\\lfloor\\frac{R}{d}\\rfloor}...\\sum\\limits_{a_n=\\lfloor\\frac{L-1}{d}\\rfloor+1}^{\\lfloor\\frac{R}{d}\\rfloor}1$$\n\n\u540e\u9762\u90a3\u4e00\u5768\u957f\u7684\u90fd\u4e00\u4e2a\u6837\u5b50\uff0c\u800c\u4e14\u53ef\u4ee5\u7ed9\u4ed6\u4eec\u5bb9\u65a5\u4e00\u4e0b\uff0c\u5f97\u5230\n\n$$\\sum\\limits_{x=1}^{\\lfloor\\frac{R}{d}\\rfloor}\\mu(x)(\\lfloor\\dfrac{R}{d}\\rfloor-\\lfloor\\dfrac{L-1}{d}\\rfloor)^n$$\n\n\u5982\u679c\u6211\u4eec\u80fd\u591f\u6c42\u51fa$\\sum\\limits_{i=1}^n\\mu(i)$\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u8fdb\u884c\u6574\u9664\u5206\u5757\u4e86\n\n\u7ebf\u7b5b\uff1f\u6b7b\u4e86\u2026\u2026$n\\leqslant 10^9$\uff1b\u4e8e\u662f\u6211\u4eec\u675c\u6559\u7b5b\u4e00\u6ce2\uff0c\u53ef\u4ee5\u53c2\u8003[\u6d45\u8c08\u7b97\u6cd5\u2014\u2014\u675c\u6559\u7b5b](https://www.cnblogs.com/Wolfycz/p/10266081.html)\n\n\u7136\u540e\u8fd9\u9898\u5c31\u505a\u5b8c\u4e86\n\n```cpp\n/*program from Wolfycz*/\n#include<map>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\n#define Fi first\n#define Se second\n#define inf 0x7f7f7f7f\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int ui;\ntypedef unsigned long long ull;\ninline char gc(){\n\tstatic char buf[1000000],*p1=buf,*p2=buf;\n\treturn p1==p2&&(p2=(p1=buf)+fread(buf,1,1000000,stdin),p1==p2)?EOF:*p1++;\n}\ninline int frd(){\n\tint x=0,f=1; char ch=gc();\n\tfor (;ch<'0'||ch>'9';ch=gc())\tif (ch=='-')\tf=-1;\n\tfor (;ch>='0'&&ch<='9';ch=gc())\tx=(x<<3)+(x<<1)+ch-'0';\n\treturn x*f;\n}\ninline int read(){\n\tint x=0,f=1; char ch=getchar();\n\tfor (;ch<'0'||ch>'9';ch=getchar())\tif (ch=='-')\tf=-1;\n\tfor (;ch>='0'&&ch<='9';ch=getchar())\tx=(x<<3)+(x<<1)+ch-'0';\n\treturn x*f;\n}\ninline void print(int x){\n\tif (x<0)\tputchar('-'),x=-x;\n\tif (x>9)\tprint(x/10);\n\tputchar(x%10+'0');\n}\nconst int N=1e6,p=1e9+7;\nmap<int,int>Sum;\nint prime[N+10],miu[N+10],sum[N+10];\nbool inprime[N+10];\nvoid prepare(){\n\tmiu[1]=sum[1]=1; int tot=0;\n\tfor (int i=2;i<=N;i++){\n\t\tif (!inprime[i])\tmiu[prime[++tot]=i]=-1;\n\t\tfor (int j=1;j<=tot&&i*prime[j]<=N;j++){\n\t\t\tinprime[i*prime[j]]=1;\n\t\t\tif (i%prime[j]==0){\n\t\t\t\tmiu[i*prime[j]]=0;\n\t\t\t\tbreak;\n\t\t\t}miu[i*prime[j]]=-miu[i];\n\t\t}\n\t\tsum[i]=sum[i-1]+miu[i];\n\t}\n}\nint S(int n){\n\tif (n<=N)\treturn sum[n];\n\tmap<int,int>::iterator it=Sum.find(n);\n\tif (it!=Sum.end())\treturn it->Se;\n\tint res=1;\n\tfor (int i=2,pos;i<=n;i=pos+1){\n\t\tpos=n/(n/i);\n\t\tres=(res-1ll*(pos-i+1)*S(n/i)%p)%p;\n\t}\n\tres=(res+p)%p;\n\tSum.insert(map<int,int>::value_type(n,res));\n\treturn res;\n}\nint mlt(int a,int b){\n\tint res=1;\n\tfor (;b;b>>=1,a=1ll*a*a%p)\tif (b&1)\tres=1ll*res*a%p;\n\treturn res;\n}\nint main(){\n\tprepare();\n\tint n=read(),k=read(),L=read(),R=read(),Ans=0;\n\t--L/=k,R/=k;\n\tfor (int i=1,pos;i<=R;i=pos+1){\n\t\tpos=min(L/i?L/(L/i):inf,R/(R/i));\n\t\tAns=(Ans+1ll*(S(pos)-S(i-1))*mlt(R/i-L/i,n)%p)%p;\n\t}\n\tprintf(\"%d\\n\",(Ans+p)%p);\n    return 0;\n}\n```",
        "postTime": 1547519086,
        "uid": 21633,
        "name": "Wolfycz",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3172 \u3010[CQOI2015]\u9009\u6570\u3011"
    },
    {
        "content": "\u8bb0 $D = H - L$.\n\n\u8fd9\u9898\u6709\u4e24\u79cd\u5e38\u89c4\u505a\u6cd5\uff1a\u4e00\u79cd\u662f $\\mathcal{O}(H^{\\frac{2}{3}})$ \u675c\u6559\u7b5b\uff0c\u53e6\u4e00\u79cd\u662f $\\mathcal{O}(D \\log D + D \\log n)$ \u7684\u5bb9\u65a5\u3002\u7136\u800c\u675c\u6559\u7b5b\u5b8c\u5168\u6ca1\u6709\u7528\u5230 $D$ \u8f83\u5c0f\u7684\u6761\u4ef6\uff0c~~\u5e76\u4e14\u4e0d\u9002\u5408\u8be5\u7b97\u6cd5\u8fd8\u6ca1\u666e\u53ca\u7684 CQOI2015~~\uff0c\u5bb9\u65a5\u662f\u7ec4\u5408\u800c\u4e0d\u662f\u6570\u8bba\u65b9\u6cd5\uff0c~~\u4e0d\u5982\u63a8\u83ab\u53cd\u5f0f\u5b50\u6765\u7684\u4f18\u7f8e~~\u3002\u56e0\u6b64\uff0c\u672c\u6587\u7ed9\u51fa\u4e00\u79cd\u7eaf\u6570\u8bba\u7684 $\\mathcal{O}(D + \\sqrt{D} \\log n)$ \u505a\u6cd5\u3002\n\n\u4e0d\u5931\u4e00\u822c\u6027\uff08\u8fd9\u4e00\u6b65\u600e\u4e48\u63a8\u5bfc\u53c2\u89c1\u5176\u4ed6\u4efb\u4f55\u4e00\u7bc7\u9898\u89e3\uff09\uff0c\u5c06\u539f\u95ee\u9898\u53d8\u4e3a\uff1a\n\n- \u6c42\u4ece $(l,r]$ \u4e2d\u9009\u53d6 $N$ \u4e2a\u6574\u6570 $i_1, i_2, \\dots, i_n$\uff0c\u5b83\u4eec\u7684\u6700\u5927\u516c\u7ea6\u6570\u7b49\u4e8e $1$ \u7684\u65b9\u6848\u6570\u3002\n- $l,r \\in \\mathbb{N}$, $N \\in \\mathbb{N}^*$.\n- \u91cd\u5b9a\u4e49 $D = r - l$.\n\n\u4e0d\u96be\u53d1\u73b0\u6240\u6c42\n\n$$\n\\begin{aligned}\n&= \\sum_{i_1 \\in (l, r]} \\sum_{i_2 \\in (l, r]} \\dots \\sum_{i_n \\in (l, r]}[(i_1, i_2, \\dots, i_n) = 1] \\\\\n&= \\sum_{i_1 \\in (l, r]} \\sum_{i_2 \\in (l, r]} \\dots \\sum_{i_n \\in (l, r]}\\sum_{d | (i_1, i_2, \\dots, i_n)} \\mu(d) && (\\mu \\ast 1 = \\epsilon) \\\\\n&= \\sum_{d = 1}^r \\mu(d) \\sum_{\\begin{aligned} i_1 \\in &(l, r] \\\\ d &| i_1 \\end{aligned}} \\dots \\sum_{\\begin{aligned} i_n \\in &(l, r] \\\\ d &| i_n \\end{aligned}}1 && (\\text{\u5148\u679a\u4e3e $d$, \u5e76\u5c06 $\\mu(d)$ \u63d0\u51fa}) \\\\\n&= \\sum_{d = 1}^r \\mu(d)(\\lfloor\\dfrac{r}{d}\\rfloor - \\lfloor \\dfrac{l}{d}\\rfloor)^n && (\\text{$(l, r]$ \u4e2d $d$ \u7684\u500d\u6570\u6709 $\\lfloor\\dfrac{r}{d}\\rfloor - \\lfloor \\dfrac{l}{d}\\rfloor$ \u4e2a})\n\\end{aligned}\n$$\n\n\u5f53 $d > D$ \u65f6\uff0c$\\lfloor\\dfrac{r}{d}\\rfloor - \\lfloor \\dfrac{l}{d}\\rfloor = 0$ \u6216 $1$\uff0c\u6545 $(\\lfloor\\dfrac{r}{d}\\rfloor - \\lfloor \\dfrac{l}{d}\\rfloor) ^ n = \\lfloor\\dfrac{r}{d}\\rfloor - \\lfloor \\dfrac{l}{d}\\rfloor$.\n\n\u5c06\u539f\u5f0f\u62c6\u5f00\n\n$$\n\\begin{aligned}\n&= \\sum_{d = 1}^D\\mu(d)(\\lfloor\\dfrac{r}{d}\\rfloor - \\lfloor \\dfrac{l}{d}\\rfloor)^n + \\sum_{d = D + 1}^r \\mu(d)(\\lfloor\\dfrac{r}{d}\\rfloor - \\lfloor \\dfrac{l}{d}\\rfloor)\n\\end {aligned}\n$$\n\u53f3\u8fb9\u8fd9\u4e00\u9879\n\n$$\n\\begin{aligned}\n&= \\sum_{d = D + 1}^r \\sum_{\\begin{aligned} i \\in &(l, r] \\\\ d &| i \\end{aligned}} \\mu(d) && (\\text{$(l, r]$ \u4e2d $d$ \u7684\u500d\u6570\u6709 $\\lfloor\\dfrac{r}{d}\\rfloor - \\lfloor \\dfrac{l}{d}\\rfloor$ \u4e2a, \u5e76\u5c06 $\\mu(d)$ \u4e58\u8fdb\u53bb}) \\\\ \n&= \\sum_{d = 1}^r \\sum_{\\begin{aligned} i \\in &(l, r] \\\\ d &| i \\end{aligned}} \\mu(d) - \\sum_{d = 1}^D \\sum_{\\begin{aligned} i \\in &(l, r] \\\\ d &| i \\end{aligned}} \\mu(d) && (\u5dee\u5206) \\\\\n&= \\sum_{i \\in (l, r]} \\sum_{d | i} \\mu(d) - \\sum_{d = 1}^D \\mu(d) \\sum_{\\begin{aligned} i \\in &(l, r] \\\\ d &| i \\end{aligned}} 1 && (\\text{\u5de6\u8fb9\u4e00\u9879\u5148\u679a\u4e3e $i$, \u53f3\u8fb9\u4e00\u9879\u63d0\u51fa $\\mu(d)$}) \\\\\n&= \\sum_{i = l + 1}^r \\epsilon(i) - \\sum_{d = 1}^D\\mu(d)(\\lfloor\\dfrac{r}{d}\\rfloor - \\lfloor \\dfrac{l}{d}\\rfloor) &&(\\mu \\ast 1 = \\epsilon \\text{, $(l, r]$ \u4e2d $d$ \u7684\u500d\u6570\u6709 $\\lfloor\\dfrac{r}{d}\\rfloor - \\lfloor \\dfrac{l}{d}\\rfloor$ \u4e2a}) \\\\\n&= \\epsilon(l + 1) - \\sum_{d = 1}^D\\mu(d)(\\lfloor\\dfrac{r}{d}\\rfloor - \\lfloor \\dfrac{l}{d}\\rfloor) && (l + 2 > 1)\n\\end {aligned}\n$$\n\u6240\u4ee5\u603b\u7684\u7b54\u6848\n\n$$\n\\begin{aligned}\n&= \\sum_{d = 1}^D\\mu(d)(\\lfloor\\dfrac{r}{d}\\rfloor - \\lfloor \\dfrac{l}{d}\\rfloor)^n + \\epsilon(l + 1) - \\sum_{d = 1}^D\\mu(d)(\\lfloor\\dfrac{r}{d}\\rfloor - \\lfloor \\dfrac{l}{d}\\rfloor) \\\\\n&= \\sum_{d = 1}^D\\mu(d)[(\\lfloor\\dfrac{r}{d}\\rfloor - \\lfloor \\dfrac{l}{d}\\rfloor)^n - (\\lfloor\\dfrac{r}{d}\\rfloor - \\lfloor \\dfrac{l}{d}\\rfloor)] + \\epsilon(l + 1)\n\\end{aligned}\n$$\n\u5de6\u8fb9\u8fd9\u4e2a\u548c\u5f0f\uff0c$\\mathcal{O}(D)$ \u7ebf\u6027\u7b5b\u5904\u7406 $\\mu$ \u524d\u7f00\u548c\uff0c\u518d $\\mathcal{O}(\\sqrt{D} \\log n)$ \u6570\u8bba\u5206\u5757\u3002\n## Sample Code\n\n**\u6ce8\uff1a\u7531\u4e8e\u672c\u9898\u6570\u636e\u8303\u56f4\u8f83\u5c0f\uff0c\u8be5\u4ee3\u7801\u5e76\u6ca1\u6709\u4f7f\u7528\u7ebf\u6027\u7b5b\u548c\u6570\u8bba\u5206\u5757**\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <cmath>\n#include <utility>\n#include <queue>\nusing namespace std;\ntypedef long long ll;\ntypedef long double ldouble;\nconst int LEN = 100000;\n\nstruct fastio {\n  int it, len;\n  char s[LEN + 5];\n  fastio() {\n    it = len = 0;\n  }\n  char get() {\n    if (it < len) return s[it++];\n    it = 0, len = fread(s, 1, LEN, stdin);\n    return len ? s[it++] : EOF;\n  }\n  bool notend() {\n    char c;\n    for (c = get(); c == ' ' || c == '\\n' || c == '\\r'; c = get());\n    if (it) it--;\n    return c != EOF;\n  }\n  void put(char c) {\n    if (it == LEN) fwrite(s,1,LEN,stdout), it = 0;\n    s[it++] = c;\n  }\n  void flush() {\n    fwrite(s, 1, it, stdout);\n  }\n}buff, bufo;\ninline int getint() {\n  char c; int res = 0, sig = 1;\n  for (c = buff.get(); c < '0' || c > '9'; c = buff.get()) if(c == '-') sig = -1;\n  for (; c >= '0' && c <= '9'; c = buff.get()) res = res * 10 + (c - '0');\n  return sig * res;\n}\ninline ll getll() {\n  char c; ll res = 0, sig = 1;\n  for (c = buff.get(); c < '0' || c > '9'; c = buff.get()) if (c == '-') sig = -1;\n  for (; c >= '0' && c <= '9'; c = buff.get()) res = res * 10 + (c - '0');\n  return sig * res;\n}\ninline void putint(int x, char suf) {\n  if (!x) bufo.put('0');\n  else {\n    if (x < 0) bufo.put('-'), x = -x;\n    int k = 0; char s[15];\n    while (x) {\n      s[++k] = x % 10 + '0';\n      x /= 10;\n    }\n    for (; k; k--) bufo.put(s[k]);\n  }\n  bufo.put(suf);\n}\ninline void putll(ll x, char suf) {\n  if (!x) bufo.put('0');\n  else {\n    if (x < 0) bufo.put('-'), x = -x;\n    int k = 0; char s[25];\n    while (x) {\n      s[++k] = x % 10 + '0';\n      x /= 10;\n    }\n    for (; k; k--) bufo.put(s[k]);\n  }\n  bufo.put(suf);\n}\ninline char get_char() {\n  char c;\n  for (c = buff.get(); c == ' ' || c == '\\n' || c == '\\r'; c = buff.get());\n  return c;\n}\n\n#define mod 1000000007\nll modpow(ll x, ll y) {\n  ll res = 1;\n  while (y) {\n    if (y & 1) res = res * x % mod;\n    y >>= 1;\n    x = x * x % mod;\n  }\n  return res;\n}\n\nint n, k, L, H, l, r, mu[100005], ans;\n\nint main() {\n  n = getint(), k = getint(), L = getint(), H = getint();\n  l = (L - 1) / k, r = H / k;\n  mu[1] = 1;\n  for (int i = 1; i <= 100000; i++) {\n    for (int j = i << 1; j <= 100000; j += i) {\n      mu[j] -= mu[i];\n    }\n  }\n  if (r <= 100000) {\n    for (int d = 1; d <= r; d++)\n      (ans += mu[d] * modpow(r / d - l / d, n)) %= mod;\n    putll((ans + mod) % mod, '\\n');\n  } else {\n    for (int d = 1; d <= 100000; d++)\n      (ans += mu[d] * modpow(r / d - l / d, n)) %= mod;\n    (ans += (l == 0)) %= mod;\n    for (int d = 1; d <= 100000; d++)\n      (ans -= (r / d - l / d) * mu[d]) %= mod;\n    putll((ans + mod) % mod, '\\n');\n  }\n  bufo.flush();\n  return 0;\n}\n```\n## Note\n\n\u5bf9\u4e8e\u5bb9\u65a5\u7684\u505a\u6cd5\uff0c\u6838\u7b97\u5bb9\u65a5\u7cfb\u6570\u4e5f\u53ef\u4ee5\u5f97\u5230\u76f8\u540c\u7684\u5f0f\u5b50\u3002",
        "postTime": 1597570322,
        "uid": 53793,
        "name": "caeious",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3172 \u3010[CQOI2015]\u9009\u6570\u3011"
    },
    {
        "content": "# \u9898\u76ee\u5206\u6790\n\n\u9012\u63a8+\u5bb9\u65a5\u3002\n\n\u6211\u4eec\u6ce8\u610f\u5230H-L<=10^5\uff0c\u4e5f\u5c31\u662f\u8bf4H-L\u662f\u5f88\u5c0f\u7684\u3002\u90a3\u4e48\u5bf9\u4e8e\u4efb\u610f\u6b63\u6574\u6570x,\u5982\u679cx>H-L,\u90a3\u4e48\u5c31\u5728H\u5230L\u7684\u533a\u95f4\u91cc\u4e0d\u53ef\u80fd\u627e\u5230\u4e24\u4e2a\u53ca\u4ee5\u4e0a\u7684\u6570\uff0c\u5b83\u4eec\u7684gcd=x\u3002\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5927\u5927\u7f29\u5c0f\u8303\u56f4\u4e86\uff01\n\n**\u4ee5\u4e0b\u6240\u6709\u9664\u6cd5\u90fd\u662f\u5411\u4e0b\u53d6\u6574\u3002\u3002\u3002**\n\n\u6211\u4eec\u7528f[i]\u8868\u793agcd\u4e3a$i*k$\u7684\u6570\u5bf9\u7684\u4e2a\u6570\uff0c\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u7f29\u5c0fH\u548cL\uff0c\u5373\u540c\u65f6\u9664\u4ee5k\uff0c\u4ee4l=(H-1)/k,r=L/k,\u7ed3\u679c\u4e0d\u53d8\uff08\u4e3a\u4ec0\u4e48\u662f(H-1)/k?\u56e0\u4e3a\u6211\u4eec\u53ea\u8981\u7528\u5230H-1\uff09\uff0c\u90a3\u4e48\u5728H\u5230L\u8303\u56f4\u5185$i*k$\u7684\u500d\u6570\u6709$r/i-l/i$\u4e2a\uff0c\u90a3\u4e48\u4ece\u5176\u4e2d\u9009\u51fan\u4e2a\u6570\u7ec4\u6210\u6570\u5bf9\u7684\u4e2a\u6570\u6709$(r/i-l/i)^n$\u4e2a\u3002\n\n\u4f46\u662f\u6211\u4eec\u4e0d\u80fd\u7b97\u6240\u6709\u6570\u90fd\u4e00\u6837\u7684\u6570\u5bf9\uff0c\u56e0\u4e3a\u6211\u4eec\u628a\u9012\u63a8\u8303\u56f4\u7f29\u5c0f\u5230H-L\uff08\u6216\u8005\u8bf4r-l\uff09\u7684\u524d\u63d0\u662f\u627e\u4e0d\u5230\u4e24\u4e2a\u53ca\u4ee5\u4e0a\u7684\u6570\u6ee1\u8db3gcd=x\uff0c\u5982\u679c\u662f\u6240\u6709\u6570\u90fd\u4e00\u6837\u7684\u6570\u5bf9\uff0c\u4f9d\u7136\u53ef\u80fd\u8d85\u51fa\u6211\u4eec\u679a\u4e3e\u7684gcd\u7684\u8303\u56f4\u3002\u6240\u4ee5\u8981\u51cf\u53bb\u4e00\u4e2a$r/i-l/i$\n\n\u7136\u540e\u627e\u8303\u56f4\u4ee5\u5185\u6240\u6709i\u7684\u500d\u6570j\uff0c\u53bb\u9664\u6389\u6240\u6709f[j]\u5c31\u53ef\u4ee5\u5f97\u5230f[i]\u3002\n\n\u6700\u540e\u6ce8\u610f\uff0c\u5982\u679ck\u5728H\u5230L\u7684\u8303\u56f4\u91cc\uff0c\u7b54\u6848\u8981+1\n\n# \u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<climits>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\n#define LL long long\nLL mod=1000000007;\nLL f[100005];\nLL n,k,l,r;\nLL ksm(LL x,LL y){//\u5feb\u901f\u5e42\n    LL re=1;\n    while(y){\n        if(y&1)re=(re*x)%mod;\n        x=(x*x)%mod,y>>=1;\n    }\n    return re;\n}\nint main()\n{\n    LL i,j,kl=0,x,y,len;\n    scanf(\"%lld%lld%lld%lld\",&n,&k,&l,&r);\n    if(l<=k&&k<=r)kl=1;\n    l--,l/=k,r/=k,len=r-l;//\u7f29\u5c0f\u8303\u56f4\n    for(i=len;i>=1;i--){\n        x=l/i,y=r/i;\n        f[i]=(ksm(y-x,n)-(y-x)+mod)%mod;//\u6c42gcd\u4e3ai\u7684\u500d\u6570\u6570\u5bf9\u6570\n        for(j=i<<1;j<=len;j+=i)f[i]=(f[i]-f[j]+mod)%mod;//gcd\u4e3ai\u7684\u6570\u5bf9\u6570\n    }\n    printf(\"%lld\",f[1]+kl);\n    return 0;\n}\n```",
        "postTime": 1502105218,
        "uid": 20604,
        "name": "litble",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P3172 \u3010[CQOI2015]\u9009\u6570\u3011"
    },
    {
        "content": "### [\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3172)\n\n\u9996\u5148\u89e3\u8bfb\u9898\u610f\uff0c\u6211\u4eec\u5f97\u5230\u4e0b\u5f0f\uff1a\n\n$$\nAns=\\sum_{i_1=L}^H\\sum_{i_2=L}^H...\\sum_{i_n=L}^H[\\gcd(i_1,i_2,i_3...i_n)==K] \n$$\n\u4ee4$l=\\lfloor\\frac{H}{K}\\rfloor,r=\\lfloor\\frac{L-1}{K}\\rfloor$\n$$\n\\Rightarrow Ans=\\sum_{i_1=l+1}^r\\sum_{i_2=l+1}^r...\\sum_{i_n=l+1}^r\\epsilon(\\gcd(i_1,i_2,i_3...i_n))\n$$\n\u63a5\u7740\u8fdb\u884c\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n\n$$\n\\Leftrightarrow Ans=\\sum_{i_1=l+1}^r\\sum_{i_2=l+1}^r...\\sum_{i_n=l+1}^r\\sum_{d|\\gcd(i_1,i_2,i_3...i_n)}\\mu(d)\n$$\n\n\u628a$d$\u653e\u5728\u5916\u5c42\u679a\u4e3e\n\n$$\n\\Leftrightarrow \\sum_{d=1}^r\\mu(d)(\\lfloor\\frac{r}{d}\\rfloor-\\lfloor\\frac{l-1}{d}\\rfloor)^n\n$$\n\n\u7136\u540e\u6211\u4eec\u4f1a\u53d1\u73b0\u4e0a\u5f0f\u53ef\u4ee5\u7528\u6574\u9664\u5206\u5757\n\n**\u4f46\u95ee\u9898\u5c31\u6765\u4e86\uff0cr(H)\u7684\u8303\u56f4\u662f1e9**\n\n\u6709\u7684\u9898\u89e3\u4e2d\u4f7f\u7528\u4e86\u675c\u6559\u7b5b\uff0c\u4f46\u4e8b\u5b9e\u4e0a\u5b8c\u5168\u4e0d\u9700\u8981\u3002\n\n$$H-L\\leq 10^5$$\n\n\u6ce8\u610f\u5230\u8fd9\u4e2a\u6761\u4ef6\uff0c\u540c\u65f6\u6211\u4eec\u53c8\u53ef\u4ee5\u77e5\u9053$\\lim\\limits_{d\\rightarrow\\infty}(\\lfloor\\frac{r}{d}\\rfloor-\\lfloor\\frac{l-1}{d}\\rfloor)=0$\n\n\u6240\u4ee5\u5f53$d$\u8db3\u591f\u5927\u65f6\u53ef\u4ee5\u4e0d\u7528\u8ba1\u7b97$\\sum\\mu(d)$**(\u5e76\u975e\u5355\u8c03)**\n\n\u4e8e\u662f\u6211\u4eec\u8bbe\u8ba1\u51fa\u4e86\u4ee5\u4e0b\u7b97\u6cd5\uff1a\n\n\u5148\u6574\u9664\u5206\u5757\n\n- $\\lfloor\\frac{r}{d}\\rfloor=\\lfloor\\frac{l-1}{d}\\rfloor$\u65f6\uff0c\u5ffd\u7565\n- $\\lfloor\\frac{r}{d}\\rfloor\\not=\\lfloor\\frac{l-1}{d}\\rfloor$\n\n\t- $d\\leq X$($X$\u4e3a\u6211\u4eec\u8bbe\u7f6e\u7684\u95f8\u91cf)\u65f6\uff0c\u901a\u8fc7\u9884\u5904\u7406\u7684$\\sum\\mu$\u5f97\u5230\u503c,\u9884\u5904\u7406\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(X)$\n   - $d > X$\u679a\u4e3e$i\\in[l,r]$,\u901a\u8fc7\u7b5b\u51fa\u7684$prime$\u5f97\u5230$\\mu(i)$,\u5355\u6b21\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(\\frac{\\sqrt{i}}{\\ln i})$,\u5f53$X=10^7$\u65f6,\u671f\u671b\u51fa\u73b0\u6b21\u6570$=(H-L+1)\\int_{L}^{H}\\frac{1}{x}dx=2$\n   \n\u671f\u671b\u65f6\u95f4\u590d\u6742\u5ea6$O(X+\\sqrt H\\log_2N)$\n    \n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n# define ll long long\n# define read read1<ll>()\n# define Type template<typename T>\nType T read1(){\n\tT t=0;\n\tchar k;\n\tbool vis=0;\n\tdo (k=getchar())=='-'&&(vis=1);while('0'>k||k>'9');\n\twhile('0'<=k&&k<='9')t=(t<<3)+(t<<1)+(k^'0'),k=getchar();\n\treturn vis?-t:t;\n}\n# define fre(k) freopen(k\".in\",\"r\",stdin);freopen(k\".out\",\"w\",stdout)\n# define N 10000000\nbool vis[10000005];\nint mu[10000005],prime[1000005],s;\nvoid init(){\n\tmu[1]=1;\n\tfor(int i=2;i<=N;++i){\n\t\tif(!vis[i]){\n\t\t\tmu[i]=-1;\n\t\t\tprime[++prime[0]]=i;\n\t\t}\n\t\tfor(int j=1;j<=prime[0]&&prime[j]*i<=N;++j){\n\t\t\tvis[prime[j]*i]=1;\n\t\t\tif(!(i%prime[j])){\n\t\t\t\tmu[i*prime[j]]=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmu[i*prime[j]]=-mu[i];\n\t\t}\n\t}\n\tfor(int i=2;i<=N;++i)mu[i]+=mu[i-1];\n}\nint Mu(int x){\n\tint t=1;\n\tfor(int i=1;prime[i]*prime[i]<=x;++i)\n\t\tif(!(x%prime[i])){\n\t\t\tx/=prime[i];t=-t;\n\t\t\tif(!(x%prime[i]))return 0; \n\t\t}\n\tif(x!=1)t=-t;\n\treturn t;\n}\n# define mod 1000000007\nll qkpow(int n,int k){\n\tif(!k)return 1;\n\tll t=qkpow(n,k>>1);\n\tt=t*t%mod;\n\tif(k&1)t=t*n%mod;\n\treturn t;\n}\nint main(){\n\tinit();\n\tint n=read,k=read,L=(read-1)/k,R=read/k;\n\tint ans=0;\n\tfor(int l=1,r=0;l<=R;l=r+1){\n\t\tr=min(R/(R/l),l>L?1000000000:L/(L/l));\n\t\tif(R/l==L/l)continue;\n\t\tll t=qkpow(R/l-L/l,n),v=0;\n\t\tif(r<=N)v=mu[r]-mu[l-1];\n\t\telse for(int i=l;i<=r;++i)v+=Mu(i);\n\t\tans=(ans+t*v)%mod;\n\t}\n\tcout<<(ans+mod)%mod;\n\treturn 0;\n}\n```\n    \n    \n    \n",
        "postTime": 1610185749,
        "uid": 108067,
        "name": "\u4e1b\u96e8",
        "ccfLevel": 0,
        "title": "[CQOI2015]\u9009\u6570"
    },
    {
        "content": "\u6700\u8fd1\u505a\u9898\u8d8a\u6765\u8d8a\u4e0d\u8d70\u5fc3\u4e86\uff0c\u6bcf\u6b21\u90fd\u662f\u60f3\u5230\u7b2c\u4e00\u6b65\u7b2c\u4e8c\u6b65\u5c31\u51c9\u4e86...\n\n\u9996\u5148\u6211\u4eec\u4e00\u770b\u5230\u9009\u51fa\u4e00\u4e9b\u6570\u4f7f\u5b83\u4eec\u7684 $gcd$ \u4e3a K \u5c31\u5148\u628a\u8bfb\u8fdb\u6765\u7684\u6570\u636e\u8303\u56f4\u9664\u53bb K \u518d\u8bf4\u3002\uff08\u5f53\u7136 L \u9664\u7684\u65f6\u5019\u8981\u5411\u4e0a\u53d6\u6574\uff09\n\n\u4e3a\u4ec0\u4e48\uff1f\u5957\u8def\uff0c\u8fd9\u6837\u95ee\u9898\u53ef\u4ee5\u8f6c\u5316\u4e3a\u4ece $\\lceil {\\dfrac{L}{K}} \\rceil $ ~ $ \\lfloor \\dfrac{H}{K} \\rfloor$ \u4e2d\u9009\u51fa n \u4e2a\u6570\u4f7f\u5176\u4e92\u8d28\uff08\u90a3\u4e48\u4e0b\u9762\u5185\u5bb9\u4e2d\u7684 L \u3001 H \u90fd\u662f\u5df2\u7ecf\u9664\u8fc7 K \u7684\u4e86\uff09\n\n\u7136\u540e\u6211\u5c31\u60f3\u4e0d\u4e0b\u53bb\u4e86\uff0c\u4e00\u5806\u5947\u5947\u602a\u602a\u7684\u60f3\u6cd5\u5192\u4e0a\u6765\u4f46\u662f\u90fd\u4e0d\u5bf9...\n\n\u56e0\u4e3a\u6211\u5728\u60f3\u7684\u662f\u4e24\u4e2a\u6570\u4e92\u8d28\u65f6\u5019\u7684\u5957\u8def\u554a\uff01\n\n\u8fd9\u91cc\u662f\u4e00\u5806\u6570\uff0c\u4e8e\u662f\u8981\u7528\u5bb9\u65a5\u4e86\n\n\u4ee4 $f[i]$ \u8868\u793a\u9009 n \u4e2a\u6570\uff0cgcd\u4e3a i \u7684\u500d\u6570\u4e14 n \u4e2a\u6570\u4e0d\u5168\u76f8\u540c\u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48 $f[i]$ \u662f\u597d\u6c42\u7684\uff1a\n\n\u4ee4 $l=\\lceil \\dfrac L i \\rceil,r=\\lfloor \\dfrac H i  \\rfloor$\n\n\u5219 $f[i]$ = $(r-l+1)^n-(r-l+1)$ \n\n\u90a3\u4e48\u6700\u540e\u7684\u7b54\u6848\u7528\u4e00\u4e0b\u5bb9\u65a5\u5012\u8fc7\u6765\u51cf\u51cf\u5c31\u597d\u4e86\n\n\n```\n//by Judge\n#include<cstdio>\n#include<iostream>\n#define ll long long\nusing namespace std;\nconst int mod=1e9+7;\nconst int M=1e5+3;\ninline void ADD(int& a,int b){ a+=a+b>=mod?b-mod:b; }\nint n,K,L,H,f[M];\ninline int qpow(int x,int p){ int s=1;\n\tfor(;p;p>>=1,x=1ll*x*x%mod)\n\t\tif(p&1) s=1ll*s*x%mod; return s;\n}\nint main(){ scanf(\"%d%d%d%d\",&n,&K,&L,&H),L=L/K+(L%K>0),H/=K;\n\tif(L>H) return !puts(\"0\");\n\tfor(int i=1;i<=H-L;++i){\n\t\tint l=L/i+(L%i>0),r=H/i; if(l>r) continue;\n\t\tf[i]=(qpow(r-l+1,n)-(r-l+1)+mod)%mod;\n\t}\n\tfor(int i=H-L;i;--i)\n\t\tfor(int j=i<<1;j<=H-L;j+=i)\n\t\t\tADD(f[i],mod-f[j]);\n\tif(L==1) ADD(f[1],1);\n\treturn !printf(\"%d\\n\",f[1]);\n}\n\n```\n\n",
        "postTime": 1551621308,
        "uid": 38576,
        "name": "J\u03bcdge",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3172 \u3010[CQOI2015]\u9009\u6570\u3011"
    },
    {
        "content": "\u8fd9\u9898\u8fd8\u53ef\u4ee5\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u505a\n\n![](https://images2015.cnblogs.com/blog/1078180/201706/1078180-20170613113740509-1376753866.png)\n\n\u56fe\u6458\u81eaGXZlegend\u7684blog\n\nmu\u51fd\u6570\u7684\u524d\u7f00\u5408\u4f7f\u7528\u675c\u6559\u7b5b\u6c42\uff0c\u5148\u9884\u5904\u7406\u4e00\u90e8\u5206\uff0c\u53ef\u4ee5\u53d6\u9608\u503c\u4e3a2e6\u5de6\u53f3\n\n```cpp\n    #include<iostream>\n    #include<cstdio>\n    #include<cstring>\n    #include<algorithm>\n    #include<map>\n    #define maxn 2000020\n    #define mod 1000000007\n    #define logn 11\n    #define inf (1<<30)\n    using namespace std;\n    int n,k,l,h,prime[maxn/logn],sum[maxn],tot;\n    bool vis[maxn];\n    map<int,int>sum2;\n    int power(int a,int kkk){\n        int ans=1;\n        for(;kkk;kkk>>=1,a=(1ll*a*a)%mod)\n        if(kkk&1)ans=(1ll*ans*a)%mod;\n        return ans;\n    }\n    void init(){\n        memset(prime,0,sizeof(prime));\n        memset(vis,0,sizeof(vis));\n        memset(sum,0,sizeof(sum));\n        sum[1]=1;\n        tot=0;\n        for(int i=2;i<maxn;++i){\n            if(!vis[i])sum[i]=-1,prime[++tot]=i;\n            for(int j=1;j<=tot&&(i*prime[j])<maxn;++j){\n                vis[i*prime[j]]=1;\n                if(!(i%prime[j])){\n                    sum[i*prime[j]]=0;\n                    break;\n                }\n                sum[i*prime[j]]=-sum[i];\n            }\n        }\n        for(int i=1;i<maxn;++i)sum[i]+=sum[i-1];\n        scanf(\"%d%d%d%d\",&n,&k,&l,&h);\n    }\n    int Sum(int x){\n        if(x<maxn)return sum[x];\n        if(sum2.find(x)!=sum2.end())return sum2[x];\n        long long s=1;\n        int la;\n        for(int i=1;i<=(x>>1);i=la+1){\n            la=x/(x/i);\n            s-=(Sum(la)-Sum(i-1))*(x/i-1ll);\n        }\n        return sum2[x]=s%mod;\n    }\n    void solve(){\n        int ans=0,la;\n        l=(l-1)/k,h/=k;\n        for(int i=1;i<=h;i=la+1){\n            la=min(h/(h/i),l/i?(l/(l/i)):inf);\n            ans=(ans+(1ll*(Sum(la)-Sum(i-1))*power(h/i-l/i,n))%mod)%mod;\n        }\n        printf(\"%d\\n\",(ans+mod)%mod);\n    }\n    int main(){\n        init();\n        solve();\n        return 0;\n}\n```",
        "postTime": 1516437077,
        "uid": 39216,
        "name": "Shadows",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3172 \u3010[CQOI2015]\u9009\u6570\u3011"
    },
    {
        "content": "\u5f88\u663e\u7136\uff0c\u9898\u76ee\u8ba9\u6211\u4eec\u6c42\u7684\u662f(\u4ee5\u4e0bR=H~~\u770b\u5f97\u987a\u773c\u70b9~~)\n$$ans=\\sum_{a_1=L}^R...\\sum_{a_n=L}^R[gcd(a_1,...,a_n)==k]$$\n\n$$=\\sum_{a_1=\\lceil \\frac L k \\rceil}^{\\lfloor \\frac R k  \\rfloor}...\\sum_{a_n=\\lceil \\frac L k \\rceil}^{\\lfloor \\frac R k  \\rfloor}[gcd(a_1,...,a_n)==1]$$\n\u63a5\u4e0b\u6765\u6211\u4eec\u4ee4$l=\\lceil \\frac L k \\rceil$,$r=\\lfloor \\frac R k  \\rfloor$\n$$=\\sum_{a_1=l}^r...\\sum_{a_n=l}^r[gcd(a_1,...,a_n)==1]$$\n\u628a\u6700\u540e\u4e00\u9879\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u4e00\u4e0b\n$$=\\sum_{a_1=l}^r...\\sum_{a_n=l}^r \\sum_{d|gcd(a_1,...,a_n)}\\mu(d)$$\n\u628a\u679a\u4e3ed\u63d0\u5230\u6700\u524d\u9762\n$$=\\sum_{d=1}^r\\mu(d)\\sum_{a_1=l}^r[d|a_1]...\\sum_{a_n=l}^r[d|a_n] $$\n\u8fa3\u4e48\u5f88\u663e\u7136\uff0c$\\sum_{a=l}^r[d|a]=$[l,r]\u91ccd\u7684\u500d\u6570\u7684\u4e2a\u6570\n$$=\\sum_{d=1}^r\\mu(d)(\\lfloor \\frac r x \\rfloor-\\lfloor\\frac {l-1} x \\rfloor)^n $$\n\u5728\u6574\u9664\u5206\u5757\u4e00\u6ce2\u5c31OK\u4e86\n\n~~**\u5173\u4e8e\u7ebf\u6027\u7b5b\uff0c\u5b83\u6b7b\u4e86**~~\n\n\u8fd9\u91cc\u6211\u4eec\u7528\u675c\u6559\u7b5b\uff0c\u5148\u4e0a\u516c\u5f0f\uff1a\n$$g(1)S(n)=\\sum_{i=1}^{n}h(i)-\\sum_{d=2}^{n}g(d)\\cdot S(\\lfloor\\frac{n}{d}\\rfloor)$$\n\u8fd9\u91cc\u6211\u4eec\u53bb$g=I,h=\\mu *I=id$\u90a3\u4e48\u5f0f\u5b50\u53d8\u6210\n$$\\to S(n)=1-\\sum_{d=2}^{n}S(\\lfloor\\frac{n}{d}\\rfloor)$$\n\u7528\u6574\u9664\u5206\u5757\u5c31\u53ef\u4ee5\u505a\u4e86\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nconst int maxn=5e6+10;\nbool isprime[maxn];\nint miu[maxn],prime[maxn],tot,Sum[maxn];\nconst long long mod=1e9+7;\nvoid init(){\n\tmemset(isprime,0xff,sizeof isprime);\n\ttot=0;miu[1]=1;\n\tfor(int i=2;i<maxn;i++){\n\t\tif(isprime[i])\n\t\t\tprime[++tot]=i,miu[i]=-1;\n\t\tfor(int j=1;j<=tot&&i*prime[j]<maxn;j++){\n\t\t\tisprime[i*prime[j]]=false;\n\t\t\tif(i%prime[j])\n\t\t\t\tmiu[i*prime[j]]=-miu[i];\n\t\t\telse{\n\t\t\t\tmiu[i*prime[j]]=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tSum[0]=0;\n\tfor(int i=1;i<maxn;i++)\n\t\tSum[i]=(Sum[i-1]+miu[i])%mod;\n}\nmap<int,int>S;\ninline int calc(int x){\n\tif(x<maxn)return Sum[x];\n\tif(S[x])return S[x];\n\tint ans=1;\n\tfor(int l=2,r;l<=x;l=r+1){\n\t\tr=x/(x/l);\n\t\tans-=calc(x/l)*(r-l+1)%mod;\n\t\tans%=mod;\n\t}\n\treturn S[x]=ans%mod;\n}\ntemplate <class T>inline void read(T &x){\n\tx=0;char c=getchar();\n\tfor(;!isdigit(c);c=getchar());\n\tfor(;isdigit(c);c=getchar())x=x*10+c-'0';\n\treturn;\n}\ntemplate <class T>void write(T x){\n\tif(x<0)putchar('-'),x=-x;\n\tif(x>=10)write(x/10);\n\tputchar(x%10+'0');\n}\nlong long qpow(long long a,long long b){\n\tlong long ret=1;\n\twhile(b){\n\t\tif(b&1)ret=(ret*a)%mod;\n\t\ta=(a*a)%mod,b>>=1;\n\t}\n\treturn ret;\n}\nvoid solve(long long N,long long K,long long L,long long R){\n\tL=(L-1)/K,R=R/K;\n\tlong long ans=0;\n\tfor(int l=1,r;l<=R;l=r+1){\n\t\tr=min(R/(R/l),(L/l)?L/(L/l):0x3f3f3f3f3f3f3f3f);\n\t\tans=(ans+1ll*(calc(r)-calc(l-1))*qpow((R/l)-(L/l),N))%mod;\n\t\t//printf(\"%lld %lld %lld\\n\",l,r,ans);\n\t}\n\twrite((ans+mod)%mod);putchar('\\n');\n}\n\nsigned main(){\n\tinit();\n\tlong long N,K,L,R;\n\tread(N);read(K);read(L);read(R);\n\tsolve(N,K,L,R);\n}\n```",
        "postTime": 1589023328,
        "uid": 174304,
        "name": "jun\u5934\u5409\u5409",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P3172 \u3010[CQOI2015]\u9009\u6570\u3011"
    },
    {
        "content": "\u8fd9\u4e2a\u505a\u6cd5\u662fO(sqrt(n) * log(n) + n)\u7684\u3002\n\u5148\u5c06\u6240\u6709\u6570\u9664\u4e0ak\uff0c\u4e0d\u80fd\u6574\u9664\u7684\u76f4\u63a5\u6392\u9664\uff08\u5373\u5c06l=l/k,h=h/k,\u5177\u4f53\u770b\u4ee3\u7801\uff09\u3002\n\u90a3\u4e48\u6211\u4eec\u7684\u95ee\u9898\u5c31\u662f\n\u6c42\u9009\u6570N\u6b21\u4f7f\u9009\u51fa\u7684\u6570\u6700\u5927\u516c\u7ea6\u6570\u4e3a1\u7684\u65b9\u6848\u6570\u3002\n\u7136\u540e\u6211\u4eec\u8bbef[a]= gcd=a\u7684\u65b9\u6848\u6570\u3002\n\u5982\u4f55\u6c42f[a]?\n\u8bbeF[a]= a|gcd\u7684\u65b9\u6848\u6570\u3002\n\u7f51\u4e0a\u7684\u53e6\u4e00\u79cd\u505a\u6cd5\u5c31\u662ff[a] = F[a] - sigma(a|d && a!=d,f[d])\n\u4f46\u662fd\u662f1e9\u7ea7\u522b\u7684\uff0c\u6ce8\u610f\u5230H-L<=1e5\n\u663e\u7136\u5982\u679c\u9009\u7684\u6570\u4e0d\u662f\u5b8c\u5168\u76f8\u540c\uff0c\u90a3\u4e48gcd<=1e5\n\u6240\u4ee5\u6539\u4e00\u6539f\u548cF\u7684\u5b9a\u4e49\u5c31\u884c\u3002\nf[a]= gcd=a\u4e14\u6570\u4e0d\u5168\u76f8\u540c\u7684\u65b9\u6848\u6570\u3002\nF[a]= a|gcd\u4e14\u6570\u4e0d\u5168\u76f8\u540c\u7684\u65b9\u6848\u6570\u3002\n\u90a3\u4e48\u679a\u4e3e1~H-L\u5c31\u884c\uff0c\u6700\u540e\u7279\u5224\u4e00\u4e0b\u5168\u90091\u7684\u60c5\u51b5\u3002\n\n\u53ef\u662f\u8fd9\u79cd\u505a\u6cd5\u597d\u50cf\u6d6a\u8d39\u4e86a|d\u8fd9\u4e2a\u5206\u5757\u4f18\u5316\u7684\u597d\u673a\u4f1a\u3002\n\u6211\u7684\u505a\u6cd5:\n\u7531\uff1a F[a] = sigma(a | d , f[d])\n\u6709:  f[a] = sigma(a | d, mu[d / a] * F[d])\n= sigma(a | d,mu[d/a] * ((H / d - (L-1) / d)^n - (H / d - (L-1) / d) ) )\n\u7ebf\u6027\u7b5b\u4e00\u4e0bmu\u524d\u7f00\u548c\u5c31\u884c\u3002\n\uff08\u5982\u679c\u4e0d\u77e5\u9053\u5982\u4f55\u5229\u7528 H-L<=1e5 \uff0c\u76f4\u63a5\u4e0a\u675c\u6559\u7b5b\u4e5f\u5c31200ms\uff09\n\n0ms\u4ee3\u7801\uff1a\n```cpp\n/*\n\nf[i] = ans for gcd = i\nF[i] = ans for i | gcd\nF[i] = \u03a3(i |d) f[d]\nf[i] = \u03a3(i |d) mu[d] * F[d]\nand we can prove that gcd is less than H-L(1e5)\nf[1] = \u03a3(d<=H-L) mu[d] * F[d] = \u03a3(d<=H-L) mu[d] * (the number of d's mutiple) ^ n\n\n*/\n#include<cstdio>\n#include<cstring>\n#include<cctype>\n#include<algorithm>\n#define maxn 100005\n#define inf 0x3f3f3f3f\n#define mod 1000000007\nusing namespace std;\n\nint n,k,l,h;\ninline int Pow(int base ,int k,int P)\n{\n\tint ret=1;\n\tfor(;k;k>>=1,base=1ll*base*base % P) if(k&1) ret=1ll*ret*base % P;\n\treturn ret;\n}\n\nint S[maxn],mu[maxn],pr[maxn/9],cnt_pr;\nbool vis[maxn];\nvoid Mobius(int lim)\n{\n\tS[1]=mu[1]=1;\n\tfor(int i=2;i<=lim;i++)\n\t{\n\t\tif(!vis[i]){ pr[cnt_pr++]=i,mu[i]=-1; }\n\t\tfor(int j=0;j<cnt_pr && pr[j] * i<=lim;j++)\n\t\t{\n\t\t\tvis[i*pr[j]]=1;\n\t\t\tif(i%pr[j]==0){ mu[i*pr[j]]=0;break; }\n\t\t\tmu[i*pr[j]]=-mu[i];\n\t\t}\n\t\tS[i]=(S[i-1]+mu[i])%mod;\n\t}\n}\n\nint main()\n{\n\tscanf(\"%d%d%d%d\",&n,&k,&l,&h);\n\tint ans=0;\n\tl=(l-1)/k;\n\th=h/k;\n\t\n\tint lim=h-l-1;\n\tMobius(lim);\t\n\tfor(int now=1,nxt;now<=lim;now=nxt+1)\n\t{\n\t\tnxt=min(h/(h/now),(l/now) ? l/(l/now):inf);\n\t\tans=(ans+1ll * (S[nxt]-S[now-1]) * ((Pow(h/now-l/now,n,mod)) - (h/now - l/now))%mod)%mod;\n\t}\n\tprintf(\"%d\\n\",(ans+mod+(l==0))%mod);\n}\n```",
        "postTime": 1522941578,
        "uid": 30037,
        "name": "Freopen",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3172 \u3010[CQOI2015]\u9009\u6570\u3011"
    },
    {
        "content": "## \u9898\u610f\u7b80\u8ff0\n\n\u7ed9\u5b9a $N,K,L,H$\uff0c\u6c42\u4e0b\u5217\u8868\u8fbe\u5f0f\u7684\u503c\uff1a\n\n$$\\sum_{a_1=L}^{H}\\sum_{a_2=L}^{H}\\cdots\\sum_{a_N=L}^{H}[\\gcd(a_1,a_2,\\cdots,a_N)=K] \\pmod{10^9+7}$$\n\n**\u6570\u636e\u8303\u56f4**\uff1a$1 \\le N,K,L,H \\le 10^9$\uff0c$0 \\le H-L \\le 10^5$\u3002\n\n## \u6cd5\u4e00\n\n\u8003\u8651 $\\gcd$ \u7684\u6027\u8d28\uff1a\u5f53 $a > b$ \u65f6\uff0c$\\gcd(a,b)=\\gcd(a-b,b) \\le a-b$\u3002\n\n\u90a3\u4e48\uff0c**\u5f53 $a_1,a_2,\\cdots,a_N$ \u4e0d\u5168\u76f8\u540c\u65f6\uff0c\u5fc5\u6709 $\\gcd(a_1,a_2,\\cdots,a_N) \\le H-L$**\uff0c\u5176\u4e2d $a_i \\; (1 \\le i \\le N)$ \u7684\u503c\u57df\u4e3a $[H,L]$\u3002\n\n\u5f53 $a_1=a_2=\\cdots=a_N=v$ \u65f6\uff0c$\\gcd(a_1,a_2,\\cdots,a_N)=v$\uff0c\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e3a $[H \\le K \\land K \\le L]$\uff08$\\land$ \u8868\u793a\u903b\u8f91\u4e14\uff09\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ea\u9700\u8003\u8651 $a_1,a_2,\\cdots,a_N$ \u4e0d\u5168\u76f8\u540c\u7684\u60c5\u51b5\u3002\uff08**\u4e0b\u6587\u5c5e\u4e8e\u3010\u6cd5\u4e00\u3011\u7684\u90e8\u5206\u9ed8\u8ba4 $a_1,a_2,\\cdots,a_N$ \u4e0d\u5168\u76f8\u540c**\uff09\n\n------------\n\n\u6839\u636e**\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14**\u7684\u5957\u8def\uff0c\u8bbe\uff1a\n\n$$f(n)=\\sum_{a_1=L}^{H}\\sum_{a_2=L}^{H}\\cdots\\sum_{a_N=L}^{H}[\\gcd(a_1,a_2,\\cdots,a_N)=n]$$\n\n$$g(n)=\\sum_{a_1=L}^{H}\\sum_{a_2=L}^{H}\\cdots\\sum_{a_N=L}^{H}[n \\mid \\gcd(a_1,a_2,\\cdots,a_N)]$$\n\n\u5219 $g(n)=\\sum_{n \\mid d}f(d)$\uff0c\u53cd\u6f14\u5f97 $f(n)=\\sum_{n \\mid d}g(d)\\mu(\\dfrac{d}{n})$\u3002\n\n\u7531\u4e8e $\\gcd(a_1,a_2,\\cdots,a_N) \\le H-L$\uff0c\u56e0\u6b64 $f,g$ \u81f3\u591a\u53ea\u5728 $1,2,\\cdots,H-L$ \u5904\u4e0d\u4e3a $0$\u3002\uff08**\u5373\u679a\u4e3e\u7684\u500d\u6570 $d$ \u7684\u4e0a\u9650\u4e3a $H-L$**\uff09\n\n\u7531\u4e8e\u533a\u95f4 $[L,H]$ \u4e2d $n$ \u7684\u500d\u6570\u6709 $\\lfloor \\dfrac{H}{n} \\rfloor-\\lceil \\dfrac{L}{n} \\rceil +1$ \u4e2a\uff0c\u5219\uff1a\n\n$$g(n)=(\\lfloor \\dfrac{H}{n} \\rfloor-\\lceil \\dfrac{L}{n} \\rceil +1)^N-(\\lfloor \\dfrac{H}{n} \\rfloor-\\lceil \\dfrac{L}{n} \\rceil +1)$$\n\n\uff08\u6ce8\u610f\u53bb\u9664 $a_1=a_2=\\cdots=a_N$ \u7684\u60c5\u51b5\uff09\n\n------------\n\n**\u7ebf\u6027\u7b5b**\u9884\u5904\u7406 $1,2,\\cdots,H-L+1$ \u7684 $N$ \u6b21\u65b9\u53ca\u5176 $\\mu$ \u503c\uff0c\u5373\u53ef $O(1)$ \u6c42\u89e3\u5355\u4e2a $g(n)$\u3002\n\n\u8fdb\u4e00\u6b65\uff0c\u5373\u53ef\u5728 $O(\\dfrac{H-L}{K})$ \u7684\u65f6\u95f4\u5185\u6c42\u89e3 $f(K)$\u3002\n\n\u7b54\u6848\u5373\u4e3a $f(K)+[H \\le K \\land K \\le L]$\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(H-L)$\u3002\n\n## \u6cd5\u4e8c\n\n\u4ee4 $X=\\lceil \\dfrac{L}{K} \\rceil$\uff0c$Y=\\lfloor \\dfrac{H}{K} \\rfloor$\uff0c\u5219\u6240\u6c42\u5f0f\u5b50\u7b49\u4ef7\u4e8e\uff1a\n\n$$\\sum_{b_1=X}^{Y}\\sum_{b_2=X}^{Y}\\cdots\\sum_{b_N=X}^{Y}[\\gcd(b_1,b_2,\\cdots,b_N)=1]$$\n\n\u5373\u679a\u4e3e $b_i=\\dfrac{a_i}{K}$\u3002\uff08\u663e\u7136 $a_i$ \u662f $K$ \u7684\u500d\u6570\uff09\n\n\u5c06 $[x=1]=\\sum_{d \\mid x}\\mu(d)$ \u4ee3\u5165\u5f97\uff1a\n\n$$\\sum_{b_1=X}^{Y}\\sum_{b_2=X}^{Y}\\cdots\\sum_{b_N=X}^{Y}\\sum_{d \\mid \\gcd(b_1,b_2,\\cdots,b_N)}\\mu(d)$$\n\n\u4ea4\u6362\u6c42\u548c\u7b26\u53f7\u5f97\uff1a\n\n$$\\sum_{d=1}^{Y}\\mu(d)\\sum_{b_1=X}^{Y}\\sum_{b_2=X}^{Y}\\cdots\\sum_{b_N=X}^{Y}[d \\mid \\gcd(b_1,b_2,\\cdots,b_N)]$$\n\n\u7531\u4e8e\u533a\u95f4 $[X,Y]$ \u4e2d $d$ \u7684\u500d\u6570\u6709 $\\lfloor \\dfrac{Y}{d} \\rfloor-\\lceil \\dfrac{X}{d} \\rceil +1$ \u4e2a\uff08\u6b64\u5904 $X \\le Y$\uff0c\u56e0\u6b64**\u6ce8\u610f\u7279\u5224 $X>Y$ \u7684\u60c5\u51b5**\uff09\uff0c\u5219\u5f0f\u5b50\u5316\u4e3a\uff1a\n\n$$\\sum_{d=1}^{Y}\\mu(d)(\\lfloor \\dfrac{Y}{d} \\rfloor-\\lceil \\dfrac{X}{d} \\rceil +1)^{N}$$\n\n\u5bf9\u4e8e $\\lceil \\dfrac{X}{d} \\rceil$\uff0c\u6709\u4e24\u79cd\u5904\u7406\u65b9\u5f0f\uff1a\n\n1. $\\lceil \\dfrac{X}{d} \\rceil=\\lfloor \\dfrac{X}{d} \\rfloor+1-[X \\bmod d =0]$\n\t- \u5373\u628a $\\lceil \\dfrac{X}{d} \\rceil$ \u770b\u6210 $\\lfloor \\dfrac{X}{d} \\rfloor$ \u8fdb\u884c\u8ba1\u7b97\uff0c\u6700\u540e\u518d\u679a\u4e3e $X$ \u7684\u7ea6\u6570 $d$\uff0c\u628a\u8fd9\u4e9b\u9879\u91cd\u65b0\u7b97\u4e00\u904d\u3002\n1. $\\lceil \\dfrac{X}{d} \\rceil=\\lfloor \\dfrac{X-1}{d} \\rfloor+1$\u3002\n\t- \u8bc1\u660e\u7684\u8bdd\u53ef\u4ee5\u5206 $X-1$ \u662f\u5426\u662f $d$ \u7684\u500d\u6570\u4e24\u79cd\u60c5\u51b5\u8fdb\u884c\u8ba8\u8bba\u3002\n\t- \u5f53\u7136\u66f4\u597d\u7684\u7406\u89e3\u65b9\u5f0f\u662f\u4f7f\u7528\u524d\u7f00\u4f5c\u5dee\uff0c\u5373\u533a\u95f4 $[X,Y]$ \u4e2d $d$ \u7684\u500d\u6570\u7684\u4e2a\u6570\u4e3a\uff1a\u533a\u95f4 $[1,Y]$ \u4e2d $d$ \u7684\u500d\u6570\u7684\u4e2a\u6570\u51cf\u53bb\u533a\u95f4 $[1,X-1]$ \u4e2d $d$ \u7684\u500d\u6570\u7684\u4e2a\u6570\uff0c\u5373 $\\lfloor \\dfrac{Y}{d} \\rfloor-\\lfloor \\dfrac{X-1}{d} \\rfloor$\u3002\n\n**\u7ebf\u6027\u7b5b**\u9884\u5904\u7406 $1$ \u81f3 $Y-X+1$ \u7684 $N$ \u6b21\u65b9\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u4f7f\u7528**\u6574\u9664\u5206\u5757+\u675c\u6559\u7b5b**\u4e86\u3002\uff08\u4e0d\u4f1a\u675c\u6559\u7b5b\u7684\u8bf7\u79fb\u6b65\u81f3\uff1a[\u6d1b\u8c37 P4213 \u3010\u6a21\u677f\u3011\u675c\u6559\u7b5b\uff08Sum\uff09](https://www.luogu.com.cn/problem/P4213)\uff0c\u6a21\u677f\u5c31\u6b63\u597d\u8981\u6c42 $\\sum_{i=1}^{N}\\mu(i)$\uff09\n\n\u5982\u679c\u4f7f\u7528\u7b2c\u4e00\u79cd\u5904\u7406\u65b9\u5f0f\uff0c\u8fd8\u9700\u8981 $O(\\sqrt{X})$ \u679a\u4e3e\u7ea6\u6570\uff0c\u628a\u8fd9\u4e9b\u9879\u91cd\u65b0\u7b97\u4e00\u904d\u3002\u800c\u6c42\u8fd9\u4e9b\u9879\u7684 $\\mu$ \u5c31\u76f4\u63a5 $O(\\sqrt{v})$ \u5206\u89e3\u8d28\u56e0\u6570\u5373\u53ef\u3002\uff08$v$ \u6307\u8fd9\u4e9b\u9879\u7684\u503c\uff09\n\n## \u4ee3\u7801\n\n### \u6cd5\u4e00\n\n``` cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mod=1e9+7;\ninline int qpow(int a,int n)\n{\n\tint res=1;\n\twhile(n)\n\t{\n\t\tif(n&1)\n\t\t\tres=1ll*res*a%mod;\n\t\ta=1ll*a*a%mod;\n\t\tn>>=1;\n\t}\n\treturn res;\n}\nint N,K,L,H;\nconst int max_R=1e5+5;\nbool mark_p[max_R];\nint prime[max_R],cnt,mu[max_R],Pow[max_R];\ninline void init()\n{\n\tint R=H-L+1;\n\tfor(int i=2;i<=R;++i)\n\t\tmark_p[i]=true;\n\tmu[1]=Pow[1]=1;\n\tfor(int i=2;i<=R;++i)\n\t{\n\t\tif(mark_p[i])\n\t\t{\n\t\t\tprime[++cnt]=i;\n\t\t\tmu[i]=-1;\n\t\t\tPow[i]=qpow(i,N);\n\t\t}\n\t\tfor(int j=1;j<=cnt&&i*prime[j]<=R;++j)\n\t\t{\n\t\t\tmark_p[i*prime[j]]=false;\n\t\t\tPow[i*prime[j]]=1ll*Pow[i]*Pow[prime[j]]%mod;\n\t\t\tif(i%prime[j]==0)\n\t\t\t\tbreak;\n\t\t\tmu[i*prime[j]]=-mu[i];\n\t\t}\n\t}\n}\ninline int g(int x)\n{\n\tint cnt=H/x-(L+x-1)/x+1;\n\treturn Pow[cnt]-cnt+mod;\n}\nint main()\n{\n\tscanf(\"%d%d%d%d\",&N,&K,&L,&H);\n\tinit();\n\tint ans=0;\n\tfor(int d=K,i=1;d<=H-L;d+=K,++i)\n\t\tans=(ans+1ll*g(d)*(mu[i]+mod))%mod;\n\tif(K>=L&&K<=H)\n\t{\n\t\t++ans;\n\t\tans-=ans>=mod?mod:0;\n\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\n\n### \u6cd5\u4e8c\n\n\u4e0b\u9762\u8d34\u7684\u4ee3\u7801\u4f7f\u7528\u4e86\u7b2c\u4e8c\u79cd\u5904\u7406\u65b9\u5f0f\uff0c\u4f7f\u7528\u4e86\u7b2c\u4e00\u79cd\u5904\u7406\u65b9\u5f0f\u7684\u4ee3\u7801\u89c1[\u6d1b\u8c37 P3172 [CQOI2015]\u9009\u6570 \u4ee3\u7801](https://www.luogu.com.cn/paste/b33f5geu)\u3002\n\n``` cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mod=1e9+7;\ninline int qpow(int a,int n)\n{\n\tint res=1;\n\twhile(n)\n\t{\n\t\tif(n&1)\n\t\t\tres=1ll*res*a%mod;\n\t\ta=1ll*a*a%mod;\n\t\tn>>=1;\n\t}\n\treturn res;\n}\nconst int R=1e6;\nconst int max_R=R+5;\nbool mark_p[max_R];\nint prime[max_R],cnt,mu[max_R],sum_mu[max_R];\nconst int max_B=1e5+5;\nint Pow[max_B];\ninline void init(int B,int N)\n{\n\tfor(int i=2;i<=R;++i)\n\t\tmark_p[i]=true;\n\tmu[1]=sum_mu[1]=1;\n\tfor(int i=2;i<=R;++i)\n\t{\n\t\tif(mark_p[i])\n\t\t{\n\t\t\tprime[++cnt]=i;\n\t\t\tmu[i]=-1;\n\t\t}\n\t\tfor(int j=1;j<=cnt&&i*prime[j]<=R;++j)\n\t\t{\n\t\t\tmark_p[i*prime[j]]=false;\n\t\t\tif(i%prime[j]==0)\n\t\t\t\tbreak;\n\t\t\tmu[i*prime[j]]=-mu[i];\n\t\t}\n\t\tsum_mu[i]=sum_mu[i-1]+mu[i];\n\t}\n\tPow[1]=1;\n\tfor(int i=2;i<=B;++i)\n\t{\n\t\tif(mark_p[i])\n\t\t\tPow[i]=qpow(i,N);\n\t\tfor(int j=1;j<=cnt&&i*prime[j]<=B;++j)\n\t\t{\n\t\t\tPow[i*prime[j]]=1ll*Pow[i]*Pow[prime[j]]%mod;\n\t\t\tif(i%prime[j]==0)\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\nmap<int,bool> vis;\nmap<int,int> Sum_mu;\ninline int calc_sum_mu(int n)\n{\n\tif(n<=R)\n\t\treturn sum_mu[n];\n\tif(vis[n])\n\t\treturn Sum_mu[n];\n\tint res=1;\n\tfor(int i=2,j;i<=n;i=j+1)\n\t{\n\t\tint v=n/i;\n\t\tj=n/v;\n\t\tres-=calc_sum_mu(v)*(j-i+1);\n\t}\n\tvis[n]=true;\n\treturn Sum_mu[n]=res;\n}\nint main()\n{\n\tint N,K,L,H;\n\tscanf(\"%d%d%d%d\",&N,&K,&L,&H);\n\tint X=(L+K-1)/K,Y=H/K;\n\tif(X>Y)\n\t{\n\t\tputs(\"0\");\n\t\treturn 0;\n\t}\n\tinit(Y-X+1,N);\n\tint ans=0,Last=0;\n\tfor(int i=1,j;i<=X-1;i=j+1)\n\t{\n\t\tint v1=(X-1)/i,v2=Y/i;\n\t\tj=min((X-1)/v1,Y/v2);\n\t\tint now=calc_sum_mu(j);\n\t\tans=(ans+1ll*(now-Last)*Pow[v2-v1])%mod;\n\t\tLast=now;\n\t}\n\tfor(int i=X,j;i<=Y;i=j+1)\n\t{\n\t\tint v=Y/i;\n\t\tj=Y/v;\n\t\tint now=calc_sum_mu(j);\n\t\tans=(ans+1ll*(now-Last)*Pow[v])%mod;\n\t\tLast=now;\n\t}\n\tans+=ans<0?mod:0;\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1630827745,
        "uid": 145355,
        "name": "wsyhb",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011\u6d1b\u8c37 P3172 [CQOI2015]\u9009\u6570"
    },
    {
        "content": "#### \u9898\u9762\n$\\sum_{L}^{H}\\sum_{L}^{H}...\\sum_{L}^{H}[gcd(a_1,a_2,...,a_n)=k]$\uff08n\u4e2asigma\uff09\n\n#### \u9898\u89e3\n\u8fd9\u9898\u6bd4\u8f83\u521b\u65b0\u7684\u5730\u65b9\u662f\u9009\u51fan\u4e2a\u6570\uff0c\u4f46\u662f\u7531\u4e8e\u4e4b\u524d\u505a\u8fc7\u90094\u4e2a\u6570\u7684\u9898\uff0c\u770b\u5230\u8fd9\u9053\u5c31\u76f4\u63a5\u79d2\u4e86\u3002\n\n\u6700\u540e\u7684\u5f0f\u5b50\u662f\u8fd9\u4e2a\uff1a\n$$\\sum_{d=1}^{H}(\\lfloor\\frac{r}{d}\\rfloor-\\lfloor\\frac{l}{d}\\rfloor)^n\\mu(d)$$\n\n\u770b\u5230\u8fd9\u9898\u7684\u6570\u636e\u8303\u56f4\u53d1\u73b0\u9700\u8981\u675c\u6559\u7b5b\uff0c\u4e8e\u662f\u518d\u5957\u4e00\u4e2a\u675c\u6559\u7b5b\u3002\n\n\u653e\u4ee3\u7801\uff1a\n```cpp# include <bits/stdc++.h>\nusing namespace std;\nnamespace fastio{\n\ttemplate<typename tn> void read(tn &a){\n\t    tn x=0,f=1;char c=' ';\n\t    for(;!isdigit(c);c=getchar()) if(c=='-') f=-1;\n\t    for(; isdigit(c);c=getchar() ) x=x*10+c-'0';\n\t    a=x*f;\n\t}\n\ttemplate<typename tn> void print(tn a){\n\t    if(a<0) putchar('-'),a=-a;\n\t    if(a>9) print(a/10);\n\t    putchar(a%10+'0');\n\t}\n};\nusing namespace fastio;\nconst int N=1e7+5;\nconst int mod=1e9+7;\nconst int inf=2e9;\nint poww(int a,int b){\n\tint ans=1;\n\twhile(b){\n\t\tif(b&1) ans=1ll*ans*a%mod;\n\t\tb>>=1;\n\t\ta=1ll*a*a%mod;\n\t}\n   \treturn ans;\n}\nint n,k,x,y;\nint mu[N],prime[N>>2],cnt;\nbool is_prime[N];\nmap<int,int> ansmu; \nint Sum(int n){\n\tif(n<N) return mu[n];\n\tif(ansmu[n]) return ansmu[n];\n\tint ans=0;\n\tfor(int l=2,r;l<=n;l=r+1){\n\t\tr=n/(n/l);\n\t\tans=1ll*(ans+1ll*Sum(n/l)*(r-l+1)%mod)%mod;\n\t}\n\treturn ansmu[n]=1ll-ans;\n}\nint ans;\nint main(){\n\tread(n);\n\tread(k);\n\tread(x);\n\tread(y);\n\t--x/=k;\n\ty/=k;\n\tmu[1]=1;\n\tfor(int i=2;i<N;i++){\n\t\tif(!is_prime[i]) prime[++cnt]=i,mu[i]=-1;\n\t\tfor(int j=1;j<=cnt&&prime[j]*i<N;j++){\n\t\t\tis_prime[prime[j]*i]=1;\n\t\t\tif(i%prime[j]==0){\n\t\t\t\tmu[i*prime[j]]=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmu[i*prime[j]]=-mu[i];\n\t\t}\n\t\tmu[i]=(mu[i-1]+mu[i])%mod; \n\t}\n\tfor(int l=1,r;l<=y;l=r+1){\n\t\tr=min(x/l?x/(x/l):inf,y/(y/l));\n\t\tint a=x/l;\n\t\tint b=y/l;\n\t\tans=1ll*(ans+1ll*poww(b-a,n)*(Sum(r)-Sum(l-1))%mod)%mod;\n\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\nde\u51fa\u6765\u7684bug\uff1a\n\n - `x/l?x/(x/l):inf`\u8fd9\u4e2a\u7279\u5224\n - `--x/=k;`\u8fd9\u4e2a\u7279\u5224\n\n\u603b\u4e4b\u8fd9\u9898\u4e5f\u6bd4\u8f83\u7ec6\u8282\n",
        "postTime": 1584968404,
        "uid": 119986,
        "name": "china\u00b7xyc",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P3172 \u3010[CQOI2015]\u9009\u6570\u3011"
    },
    {
        "content": "\u5982\u679c $\\LaTeX$ \u5d29\u4e86 \u8bf7\u5230[\u535a\u5ba2](https://www.luogu.com.cn/blog/My-luoguBuoke-HZR/solution-p3172)\u67e5\u770bQAQ\n\n\u9898\u610f\uff1a\n\n\u6c42\uff1a\n\n$$\\sum_{a_1=L}^H\\sum_{a_2=L}^H\\dots\\sum_{a_n=L}^H[(a_1,a_2\\ ...\\ a_n)=k]$$\n\n$n,k,L,H \\leq 10^9\\ \\ \\ \\ \\ \\ H-L\\leq 10^5$\n\n---\n\u4e0d\u7ba1\u90a3\u4e48\u591a\uff0c\u6211\u4eec\u6309\u7167\u5957\u8def\u540c\u65f6\u9664\u4ee5 $k$ \uff1a\n\n$$\n\n\\sum_{a_1=\\left\\lfloor{\\frac{L-1}{k}}\\right\\rfloor+1}^{\\left\\lfloor{\\frac{H}{k}}\\right\\rfloor}\n\n\\sum_{a_2=\\left\\lfloor{\\frac{L-1}{k}}\\right\\rfloor+1}^{\\left\\lfloor{\\frac{H}{k}}\\right\\rfloor}\n\n\\dots\n\n\\sum_{a_n=\\left\\lfloor{\\frac{L-1}{k}}\\right\\rfloor+1}^{\\left\\lfloor{\\frac{H}{k}}\\right\\rfloor}\n\n[(a_1,a_2\\ ...\\ a_n)=1]\n\n$$\n\n(\u4ee5\u4e0b\u8bbe $l=\\left\\lfloor{\\frac{L-1}{k}}\\right\\rfloor+1,r=\\left\\lfloor{\\frac{H}{k}}\\right\\rfloor$)\n\n$$\n\\sum_{a_1=l}^{r}\n\\sum_{a_2=l}^{r}\n\\dots\n\\sum_{a_n=l}^{r}\n[(a_1,a_2\\ ...\\ a_n)=1]\n$$\n\n\u6700\u540e\u90a3\u4e2a\u5f0f\u5b50\u597d\u719f\u6089\uff01\u5f3a\u884c Mobius \u53cd\u6f14\u4e00\u6ce2\uff01\n\n$$\n\\sum_{a_1=l}^{r}\n\\sum_{a_2=l}^{r}\n\\dots\n\\sum_{a_n=l}^{r}\n\\sum_{d|a_1...a_n}\\mu(d)\n$$\n\n\u63d0\u5230\u524d\u9762\u6765\uff1a\n\n$$\n\\sum_{d=1}^{r}\n\\mu(d)\n\\sum_{a_1=\\left\\lfloor{\\frac{l-1}{d}}\\right\\rfloor+1}^{\\left\\lfloor{\\frac{r}{d}}\\right\\rfloor}\n\\sum_{a_2=\\left\\lfloor{\\frac{l-1}{d}}\\right\\rfloor+1}^{\\left\\lfloor{\\frac{r}{d}}\\right\\rfloor}\n\\dots\n\\sum_{a_n=\\left\\lfloor{\\frac{l-1}{d}}\\right\\rfloor+1}^{\\left\\lfloor{\\frac{r}{d}}\\right\\rfloor}\n$$\n\n$$\n\\sum_{d=1}^{r}\n\\mu(d)\n({\\left\\lfloor{\\tfrac{r}{d}}\\right\\rfloor-\\left\\lfloor{\\tfrac{l-1}{d}}\\right\\rfloor})^n\n$$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u771f\u7684\u662f\u975e\u5e38\u4f18\u7f8e\u3002\u3002\u548c\u4e00\u5f00\u59cb\u7684\u5f0f\u5b50\u6bd4\u8d77\u6765\u6f02\u4eae\u591a\u4e86\u3002\n\n\u4e8e\u662f\u675c\u6559\u7b5b\u5373\u53ef\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\ninline ll read(){\n\tchar c=getchar();ll x=0,f=1;\n    while(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n    while(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\n    return x*f;\n}\nconst ll N=5e6,mod=1000000007;\nll i,j,k,n,m,L,R,l,r;\nll is_prime[N],prime[N],num,mu[N],Mu[N];\nvoid init(){\n\tmu[1]=1;\n\tfor(ll i=2;i<N;i++)is_prime[i]=1;\n\tfor(ll i=2;i<N;i++){\n\t\tif(is_prime[i])prime[++num]=i,mu[i]=-1;\n\t\tfor(ll j=1;j<=num && prime[j]*i<N;j++){\n\t\t\tis_prime[prime[j]*i]=0;\n\t\t\tif(i%prime[j]==0)break;\n\t\t\tmu[i*prime[j]]=-mu[i];\n\t\t}\n\t}\n\tfor(ll i=1;i<N;i++)Mu[i]=(Mu[i-1]+mu[i])%mod;\n}\nmap<ll,ll>M;\nll get_mu(ll now){\n\tif(now<N)return Mu[now];\n\tif(M[now])return M[now];\n\tll ans=1;\n\tfor(ll l=2,r=0;l<=now;l=r+1){\n\t\tr=now/(now/l);\n\t\tans-=(r-l+1)*get_mu(now/l)%mod;\n\t\tans=(ans%mod+mod)%mod;\n\t}\n\treturn M[now]=ans;\n}\nll ksm(ll sum,ll num){\n\tll ans=1;\n\twhile(num){\n\t\tif(num&1)ans=ans*sum%mod;\n\t\tsum=sum*sum%mod;\n\t\tnum>>=1;\n\t}return ans;\n}\nint main(){\n\tinit();\n\tcin>>n>>k>>L>>R;\n\tL=(L-1)/k+1;R/=k;\n\tll ans=0;\n\tfor(ll l=1,r=0;l<=R;l=r+1){\n\t\tif((L-1)>=l)r=min((L-1)/((L-1)/l),R/(R/l));\n\t\telse r=R/(R/l);\n\t\tans=(ans+ksm(R/l-(L-1)/l,n)*(get_mu(r)-get_mu(l-1))%mod)%mod;\n\t}cout<<(ans+mod)%mod<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1584619129,
        "uid": 35891,
        "name": "huangzirui",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3172 \u3010[CQOI2015]\u9009\u6570\u3011"
    },
    {
        "content": "\u5982\u679c\u89c9\u5f97\u9898\u89e3\u5199\u7684\u4e0d\u9519\u7684\u8bdd\u6b22\u8fce\u8bbf\u95ee\u6211\u7684\u539f\u535a\u5ba2\u9898\u89e3\uff1ahttp://www.cnblogs.com/luyouqi233/p/8625321.html\n\n\uff08\u6d1b\u8c37\u795e\u4ed9\u4eec\u7684\u9898\u89e3\u5bf9\u4e8e\u6211\u8fd9\u6837\u7684\u6570\u8bba\u83dc\u9e21\u597d\u96be\u61c2\u554a\uff0c\u4e8e\u662f\u5199\u7684\u8be6\u7ec6\u4e9b\uff0c\u53ef\u80fd\u8fc7\u4e8e\u5197\u957f\u8bf7\u5927\u4f6c\u4e0d\u8981\u9119\u89c6\u3002\uff09\n\n\n------------\n\n\u9996\u5148\u60f3\u5230\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c~~\u5404\u4f4d\u5927\u4f6c\u7684dp\u90fd\u662f\u600e\u4e48\u60f3\u5230\u7684\u554a\u5582\u3002~~\n\n\u5148\u884c\u7279\u5224\u6389$n=1$\u548c$l>r$\u548c$k>r$\u7684\u60c5\u51b5\u3002\n\n\u90a3\u4e48\u5f00\u59cb\u63a8\u5f0f\u5b50\uff0c\u6ce8\u610f\u4e3a\u4e86\u672c\u4eba\u7684\u4e60\u60ef\u628ah\u6539\u4e3a\u4e86r\uff1a\n\n$\\sum_{i_1=l}^r\\sum_{i_2=l}^r\\cdots\\sum_{i_n=l}^r[gcd(i_1,i_2,\\cdots,i_n)=k]$\n\n$=\\sum_{i_1=\\lceil\\frac{l}{k}\\rceil}^{\\lfloor\\frac{r}{k}\\rfloor}\\sum_{i_2=\\lceil\\frac{l}{k}\\rceil}^{\\lfloor\\frac{r}{k}\\rfloor}\\cdots\\sum_{i_n=\\lceil\\frac{l}{k}\\rceil}^{\\lfloor\\frac{r}{k}\\rfloor}[gcd(i_1,i_2,\\cdots,i_n)=1]$\n\n$=\\sum_{i_1=\\lceil\\frac{l}{k}\\rceil}^{\\lfloor\\frac{r}{k}\\rfloor}\\sum_{i_2=\\lceil\\frac{l}{k}\\rceil}^{\\lfloor\\frac{r}{k}\\rfloor}\\cdots\\sum_{i_n=\\lceil\\frac{l}{k}\\rceil}^{\\lfloor\\frac{r}{k}\\rfloor}\\sum_{d|gcd(i_1,i_2,\\cdots,i_n)}\\mu(d)$\n\n$=$\u62c6$gcd$\u7684\u5957\u8def(\u4e3a\u4e86\u65b9\u4fbf\u8d77\u89c1\uff0c\u4e0b\u6587\u5f00\u59cb$\\lfloor\\frac{r}{k}\\rfloor=r,\\lceil\\frac{l}{k}\\rceil=l$)\n\n$=\\sum_{d=1}^{r-l}(l$\u5230$r$\u7684$d$\u7684\u500d\u6570\u7684\u4e2a\u6570$)^n\\mu(d)$\n\n\n------------\n\nPS1\uff1a\u8fd9\u91cc\u6709\u4e00\u4e2a\u5947\u5999\u7684\u6027\u8d28\u90a3\u5c31\u662f\u5728$[l,r]$\u533a\u95f4\u4e2d\u4efb\u53d6\u4e24\u4e2a\u4e0d\u76f8\u7b49\u7684\u6570\uff0c\u5219\u4ed6\u4eec\u7684\u6700\u5927\u516c\u7ea6\u6570\u4e0d\u5927\u4e8e$r-l$\u3002\n\n\u95ee\u4e86\u6570\u7ade\u5927\u4f6c\uff0c\u8c8c\u4f3c\u7ed9\u4e86\u4e00\u4e2a\u9760\u8c31\u7684\u8bc1\u660e\uff1f\n\n\u6211\u4eec\u53d6$ij$\u4e24\u4e2a\u4e92\u8d28\u7684\u6570\uff0c\u663e\u7136\u5b83\u4eec$gcd=1$\uff0c\u90a3\u4e48\u6211\u4eec\u7ed9\u4ed6\u4eec\u540c\u65f6\u4e58\u6570m\uff0c\u5219\u5b83\u4eec\u7684$gcd=m$\uff0c\u800c$r-l$\u6700\u5c0f\u5373\u4e3a$(j-i)*m>=m$\uff0c\u95ee\u9898\u5f97\u8bc1\u3002\n\n\n------------\n\nPS2\uff1a\u4e3a\u4ec0\u4e48\u62ec\u53f7\u5185\u4e0d\u662f\u4e00\u4e2a\u5f0f\u5b50\u5462\uff0c\u56e0\u4e3a\u6ce8\u610f\u5bf9\u4e8e\u6709\u76f8\u540c\u6570\u7684\u6570\u5bf9\u6211\u4eec\u6ca1\u6cd5\u5904\u7406\uff0c\u6240\u4ee5\u8981\u51cf\u53bb\u5b83\u4eec\uff0c\u4e8e\u662f\u8fb9\u7b97\u8fb9\u8bb0\u5f55\u6bcf\u4e2a\u6570\u7684\u51fa\u73b0\u6b21\u6570\uff0c\u6700\u540e\u7684$cnt[i]$\u8868\u793a\u7684\u5c31\u662f\u6709\u4e24\u4e2a\u6216\u4ee5\u4e0a$i$\u7684\u6570\u5bf9\u7684\u4e2a\u6570\uff0c\u7b54\u6848\u51cf\u53bb\u5b83\u4eec\u5373\u53ef\u3002\n\n\u540c\u65f6\u6ce8\u610f\u5982\u679c$l=1$\u7684\u8bdd\u5219$l$\u5230$r$\u4e4b\u95f4\u5b58\u5728$k$\u6240\u4ee5$n$\u4e2a$k$\u662f\u6210\u7acb\u7684\u4e8e\u662f\u4e0d\u80fd\u591a\u51cf\u3002\n\n\u5904\u7406$cnt$\u7528\u8df3\u7740\u679a\u4e3e\u7684\u65b9\u6cd5\uff0c\u4e0d\u8fc7\u590d\u6742\u5ea6\u5e76\u6ca1\u56e0\u6b64\u53d8\u9ad8\u5230\u54ea\u91cc\u53bb\u3002\n\n\u672c\u849f\u84bb\u4e0d\u592a\u4f1a\u7b97\u590d\u6742\u5ea6\uff0c\u5927\u6982\u662f$O((r-l)*(1/1+1/2+...+1/(r-l))=$ $O((r-l)log(r-l))$\uff0c\u5982\u679c\u5bf9$\\mu=0$\u7684\u60c5\u51b5\u7279\u5224\u6389\u7684\u8bdd\u590d\u6742\u5ea6\u4f1a\u518d\u6b21\u51cf\u5c11\n\n```\n#include<cstdio>\n#include<queue>\n#include<map>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\ntypedef long long ll;\nconst int N=1e5+5;\nconst ll p=1e9+7;\nll n,k,l,r,su[N],miu[N],cnt[N];\nbool he[N];\nll pow(ll x,ll y){\n    ll res=1;\n    while(y){\n        if(y&1)res=res*x%p;\n        x=x*x%p;\n        y>>=1;\n    }\n    return res;\n}\nvoid Euler(int n){\n    int tot=0;\n    miu[1]=1;    \n    for(int i=2;i<=n;i++){    \n        if(!he[i]){   \n            su[++tot]=i;    \n            miu[i]=-1;\n        }    \n        for(int j=1;j<=tot;j++){    \n            if(i*su[j]>n)break;    \n            he[i*su[j]]=1;   \n            if(i%su[j]==0){    \n                miu[i*su[j]]=0;break;    \n            }    \n            else miu[i*su[j]]=-miu[i];  \n        }\n    }\n    return;\n}\nint main(){\n    scanf(\"%lld%lld%lld%lld\",&n,&k,&l,&r);\n    if(l>r||k>r){\n    \tputs(\"0\");\n    \treturn 0;\n    }\n    if(n==1){\n\t    if(l<=k&&k<=r)puts(\"1\");\n\t    else puts(\"0\");\n\t    return 0;\n\t}\n    Euler(1e5);\n    l=(l%k!=0)+l/k;r/=k;\n    ll ans=0;\n    for(int i=r-l;i>=1;i--){\n\t    if(miu[i]){\n\t        int j=l,tot=0;\n\t        if(j%i!=0)j=j/i*i+i;\n\t\t    while(j<=r){\n\t\t       \tcnt[j-l]+=miu[i];\n\t\t        j+=i;tot++;\n\t        }\n\t        ans=(ans+miu[i]*pow(tot,n)%p)%p;\n\t    }\n    }\n    for(int i=r-l;i>=1;i--){\n   \t\tans=(ans-cnt[i])%p;\n    }\n    if(l==1)ans=(ans-(cnt[0]-1))%p;\n    else ans=(ans-cnt[0])%p;\n    printf(\"%lld\\n\",(ans+p)%p);\n    return 0;\n}\n```",
        "postTime": 1521979611,
        "uid": 36276,
        "name": "w36557658",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3172 \u3010[CQOI2015]\u9009\u6570\u3011"
    },
    {
        "content": "\u4e00\u79cd\u7528\u4e86\u53cd\u6f14\uff0c\u5374\u6ca1\u4e0a\u675c\u7b5b\u7684 solution\uff08\n\n\u9996\u5148\u7531\u4e8e $\\gcd$ \u5fc5\u987b\u4e3a $k$ \u8fd9\u4e2a\u9650\u5236\u7684\u5b58\u5728\uff0c\u6211\u4eec\u6240\u9009\u51fa\u6765\u7684\u6570\u5fc5\u987b\u90fd\u662f $k$ \u7684\u500d\u6570\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5c06 $L,R$ \u5206\u522b\u53d8\u4e3a $\\lceil\\dfrac{L}{k}\\rceil,\\lfloor\\dfrac{R}{k}\\rfloor$\uff0c\u8fd9\u6837\u9650\u5236\u5373\u53ef\u8f6c\u5316\u4e3a\u9009\u51fa\u7684\u6570\u7684 $\\gcd$ \u5fc5\u987b\u4e3a $1$\u3002\n\n\u8fd8\u662f\u8003\u8651\u53cd\u6f14\n\n$$\n\\begin{aligned}\nans&=\\sum\\limits_{i=1}^R\\mu(i)\\text{id}_n(\\lfloor\\dfrac{R}{i}\\rfloor-\\lfloor\\dfrac{L-1}{i}\\rfloor)\n\\end{aligned}\n$$\n\n\u5230\u8fd9\u91cc\uff0c\u5927\u90e8\u5206\u4eba\u90fd\u662f\u5bf9 $i$ \u6574\u9664\u5206\u5757+\u675c\u7b5b\u6c42 $\\mu$ \u7684\u524d\u7f00\u548c\uff0c\u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e2a\u4e0d\u592a\u4e00\u6837\u7684\u89e3\u6cd5\uff0c\u6211\u4eec\u8003\u8651\u5bf9 $i\\in[1,R-L+1]$ \u66b4\u529b\u5730\u6c42\u89e3\u4e0a\u9762\u5f0f\u5b50\uff0c\u5bf9\u4e8e $i>R-L+1$\uff0c\u5982\u679c $\\lfloor\\dfrac{R}{i}\\rfloor-\\lfloor\\dfrac{L-1}{i}\\rfloor\\ne 0$\uff0c\u5fc5\u7136\u6709 $\\lfloor\\dfrac{R}{i}\\rfloor-\\lfloor\\dfrac{L-1}{i}\\rfloor=1$\uff0c\u4e5f\u5c31\u662f\u8bf4 $i>R-L+1$ \u7684\u8d21\u732e\u5c31\u662f\u6240\u6709 $[L,R]$ \u4e2d\u7684\u6570\u7684\u56e0\u5b50\u7684\u5e76\u4e0e $[R-L+2,\\infty)$ \u4ea4\u4e2d\u6240\u6709\u6570\u7684 $\\mu$ \u4e4b\u548c\uff0c\u90a3\u4e48\u600e\u4e48\u6c42\u8fd9\u4e2a\u503c\u5462\uff0c\u8003\u8651 $x\\in[L,R]$\uff0c\u6709 $\\sum\\limits_{d\\mid x}\\mu(d)=\\epsilon(x)$\uff0c\u6211\u4eec\u6263\u6389 $d\\le R-L+1$ \u7684\u90e8\u5206\uff0c\u53ef\u4ee5\u5f97\u5230 $\\epsilon(x)-\\sum\\limits_{d\\mid x,d\\le R-L+1}\\mu(d)=\\sum\\limits_{d>R-L+1,d\\mid x}\\mu(d)$\uff0c\u800c\u6839\u636e\u201c\u5bf9\u4e8e $>R-L+1$ \u7684\u56e0\u5b50\uff0c\u6bcf\u4e2a\u56e0\u5b50\u6700\u591a\u662f $[L,R]$ \u4e2d\u4e00\u4e2a\u6570\u7684\u7ea6\u6570\u201d\u8fd9\u4e2a\u6027\u8d28\uff0c$>R-L+1$ \u7684\u56e0\u5b50\u7684\u8d21\u732e\u5c31\u662f\u6bcf\u4e2a $x$ \u7b49\u5f0f\u53f3\u8fb9\u7684\u503c\u76f8\u52a0\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u62ff $\\sum\\limits_{i=L}^R\\epsilon(i)$ \u51cf\u53bb $\\sum\\limits_{x=L}^R\\sum\\limits_{d\\mid x,d\\le R-L+1}\\mu(d)$ \u7b97\u51fa\u53f3\u5f0f\u7684\u503c\uff0c\u524d\u8005\u7b80\u5355\u7279\u5224\u5373\u53ef\uff0c\u540e\u8005\u6bcf\u679a\u4e3e\u4e00\u4e2a $d\\le R-L+1$ \u90fd\u8c03\u548c\u7ea7\u6570\u5730\u7d2f\u52a0\u4e0b\u8d21\u732e\u5373\u53ef\uff0c\u8fd9\u6837\u6700\u540e\u590d\u6742\u5ea6\u5c31\u662f $\\mathcal O((R-L+1)\\log(R-L+1))$\n\n```cpp\nconst int MAXV=1e5;\nconst int MOD=1e9+7;\nint qpow(int x,int e){\n\tint ret=1;\n\tfor(;e;e>>=1,x=1ll*x*x%MOD) if(e&1) ret=1ll*ret*x%MOD;\n\treturn ret;\n}\nint x,l,r,k,s[MAXV+5];\nint mu[MAXV+5],pr[MAXV/6+5],prcnt=0,pw[MAXV+5];\nbitset<MAXV+5> vis;\nvoid sieve(int n){\n\tpw[1]=mu[1]=1;\n\tfor(int i=2;i<=n;i++){\n\t\tif(!vis[i]) pr[++prcnt]=i,mu[i]=-1,pw[i]=qpow(i,x);\n\t\tfor(int j=1;j<=prcnt&&pr[j]*i<=n;j++){\n\t\t\tvis[pr[j]*i]=1;pw[i*pr[j]]=1ll*pw[i]*pw[pr[j]]%MOD;\n\t\t\tif(i%pr[j]==0) break;mu[i*pr[j]]=-mu[i];\n\t\t}\n\t}\n}\nint main(){\n\tscanf(\"%d%d%d%d\",&x,&k,&l,&r);l=(l-1)/k+1;r=r/k;\n\tsieve(MAXV);if(l>r) return puts(\"0\"),0;int res=0;\n\tfor(int i=1;i<=MAXV;i++){\n\t\tres=(res+1ll*mu[i]*pw[r/i-(l-1)/i]+MOD)%MOD;\n\t\tif(mu[i]){\n\t\t\tfor(int j=(l+i-1)/i*i;j<=r;j+=i) s[j-l+1]=(s[j-l+1]-mu[i]+MOD)%MOD;\n\t\t}\n\t} for(int i=l;i<=r;i++) if(i^1) res=(res+s[i-l+1])%MOD;\n\tprintf(\"%d\\n\",res);\n\treturn 0;\n}\n/*\n1000 1 1000000007 1000000009\n*/\n```",
        "postTime": 1628348685,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3172 [CQOI2015]\u9009\u6570"
    },
    {
        "content": "\u95ee\u9898\u53ef\u4ee5\u76f4\u63a5\u8f6c\u5316\u4e3a\u4e00\u4e2a\u5f0f\u5b50\uff0c\u7136\u540e\u8fdb\u884c\u5316\u7b80\n\n$$\n\\begin{aligned}\n\\sum_{i=L}^H\\sum_{j=L}^H[\\gcd(i,j)=k]\n&=\\sum_{i=\\lfloor \\frac{L}{k} \\rfloor}^{\\lfloor \\frac{H}{k} \\rfloor}\\sum_{j=\\lfloor \\frac{L}{k} \\rfloor}^{\\lfloor \\frac{H}{k} \\rfloor}[\\gcd(i,j)=1]\\\\\n&=\\sum_{i=\\lfloor \\frac{L}{k} \\rfloor}^{\\lfloor \\frac{H}{k} \\rfloor}\\sum_{j=\\lfloor \\frac{L}{k} \\rfloor}^{\\lfloor \\frac{H}{k} \\rfloor}\\sum_{d|i,d|j}\\mu(d)\\\\\n&=\\sum_{i=\\lfloor \\frac{L}{k} \\rfloor}^{\\lfloor \\frac{H}{k} \\rfloor}\\sum_{j=\\lfloor \\frac{L}{k}\\rfloor}^{\\lfloor \\frac{H}{k} \\rfloor}\\sum_{d|i,d|j}\\mu(d)\\\\\n&=\\sum_{d=1}^{\\lfloor \\frac{H}{k} \\rfloor}\\mu(d)\n\\sum_{i=\\lfloor \\frac{L}{k} \\rfloor}^{\\lfloor \\frac{H}{k} \\rfloor}\\sum_{j=\\lfloor \\frac{L}{k}\\rfloor}^{\\lfloor \\frac{H}{k} \\rfloor}[d\\mid i][d\\mid j]\\\\\n&=\\sum_{d=1}^{\\lfloor \\frac{H}{k} \\rfloor}\\mu(d)\n(\\left \\lfloor \\frac{\\lfloor \\frac{H}{k} \\rfloor}{d} \\right \\rfloor - \\left \\lfloor \\frac{\\lfloor \\frac{L-1}{k} \\rfloor}{d} \\right \\rfloor)^2\n\\end{aligned}\n$$\n\n\u524d\u9762\u7684 $\\mu$ \u675c\u6559\u7b5b\u6389\u5c31\u884c\u4e86\uff0c\u5916\u5c42\u7684\u5faa\u73af\u6574\u9664\u5206\u5757\u53bb\u505a\uff0c\u603b\u590d\u6742\u5ea6\u662f $\\mathcal{O}(n^{\\frac{2}{3}})$ \u7684\n\n```c++\n#include <cstdio>\n#include <iostream>\n#include <unordered_map>\n\ntypedef long long ll;\n\nusing namespace std;\n\nconst int mod = 1e9 + 7;\n\ninline int addmod (register int a, register int b) {\n\treturn a += b, a >= mod ? a - mod : a;\n}\n\ninline int delmod (register int a, register int b) {\n\treturn a -= b, a < 0 ? a + mod : a;\n}\n\ninline ll mulmod (register ll a, register int b) {\n\treturn a *= b, a >= mod ? a % mod : a;\n}\n\ninline int qpow (register int a, register int b, register int ans = 1) {\n\tfor (; b; b >>= 1, a = mulmod (a, a))\n\t\tif (b & 1) ans = mulmod (ans, a);\n\treturn ans;\n}\n\nint n, m, L, R, cnt;\nint prime[3000005], mul[3000005], sum[3000005];\nbool vis[3000005];\nunordered_map <int, int> f;\n\t\ninline void xxs () {\n\tmul[1] = sum[1] = 1;\n\tfor (register int i = 2; i <= 3e6; i ++) {\n\t\tif (! vis[i]) prime[++ cnt] = i, mul[i] = mod - 1;\n\t\tfor (register int j = 1; j <= cnt && i * prime[j] <= 3e6; j ++) {\n\t\t\tvis[i * prime[j]] = 1;\n\t\t\tif (i % prime[j] == 0) break;\n\t\t\tmul[i * prime[j]] = mod - mul[i];\n\t\t}\n\t\tsum[i] = addmod (sum[i - 1], mul[i]);\n\t}\n}\n\ninline int F (register int n, register int ans = 1) {\n\tif (n <= 3e6) return sum[n];\n\tif (f[n]) return f[n];\n\tfor (register int l = 2, r; l <= n; l = r + 1) \n\t\tr = n / (n / l), ans = delmod (ans, mulmod (r - l + 1, F (n / l)));\n\treturn f[n] = ans;\n}\n\ninline int Calc (register int n, register int m, register int k, register int ans = 0) {\n\tfor (register int l = 1, r; l <= m; l = r + 1) \n\t\tr = n < l ? m / (m / l) : min (n / (n / l), m / (m / l)), \n\t\tans = addmod (ans, mulmod (delmod (F (r), F (l - 1)), qpow (delmod (m / l, n / l), k)));\n\treturn ans;\n}\n\nint main () {\n\tscanf (\"%d%d%d%d\", &n, &m, &L, &R), L = (L - 1) / m, R = R / m, xxs ();\n\treturn printf (\"%d\\n\", Calc (L, R, n)), 0;\n}\n```",
        "postTime": 1624973941,
        "uid": 335193,
        "name": "Rubyonly",
        "ccfLevel": 8,
        "title": "[CQOI2015]\u9009\u6570"
    },
    {
        "content": "\u8003\u8651\u5bb9\u65a5\uff08\u7684\u601d\u60f3\uff09\n\n\u4ee4$ f(n) $\u8868\u793a\u5728$ [L,H] $\u4e2d\u6700\u5927\u516c\u7ea6\u6570\u4e3a$ n $\u7684\u79cd\u6570\n\n\u6b64\u65f6\u4ee4$ x $\u4e3a\u5728$ [L,H] $\u533a\u95f4\u5185\u6709\u591a\u5c11\u6570\u6574\u9664$ K $\uff08\u5373$ x=\\sum_{i=L}^H[K|i] $\uff09\n\n\u518d\u4ee4$ g(n)=\\sum_{n|i}f(i) $\uff08\u8868\u793a\u5728$ [L,H] $\u4e2d\u53d6$ N $\u4e2a\u6570\u7684\u6700\u5927\u516c\u7ea6\u6570\u6574\u9664$ n $\u7684\u79cd\u6570\uff09\n\n~~\u6613\u77e5~~ $ 1.g(n)=x^N-x $\n\n$ 2.f(n)=g(n)-\\sum_{n|i}f(i)+f(n) $~~\uff08\u8fd9\u4e0d\u662f\u5e9f\u8bdd\uff09~~\n\n\u6240\u4ee5\u53ea\u8981\u5012\u7740\u9012\u63a8\u5c31\u884c\u4e86~~\uff08\u8fd9\u771f\u7684\u662f\u7d2b\u9898\u5417\uff09~~\n\n\u4f46\u662f\n\n\u5982\u679c\u6c42$ x $\u76f4\u63a5\u6284\u5f0f\u5b50\u5e76\u4e14$ TLE $ $90$\u5206\u7684\u8bdd\uff0c\u90a3\u4e48\u5c31\u606d\u559c ~~\uff08\u7ec8\u4e8e\u6709\u4e00\u4e2a\u4eba\u8ddf\u6211\u4e00\u6837\u83dc\u4e86\u54c8\u54c8\u54c8\uff09~~\n\n\u663e\u7136\u53ef\u4ee5\u5c06$ x $\u7684\u5f0f\u5b50\u6539\u5199\u6210$ \\lfloor \\frac{H}{K} \\rfloor-\\lceil \\frac{L}{K} \\rceil $\uff0c\u90a3$ O(1) $\u4e0d\u9999\u5417 ~~\uff08\uff08\uff08~~\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mod=1e9+7;\nint ksm(int n,int m,int p){\n    if(!m) return 1;\n    if(m&1) return 1ll*ksm(1ll*n*n%p,m/2,p)*n%p;\n    return 1ll*ksm(1ll*n*n%p,m/2,p);\n}\nint n,k,l,h,f[100010];\nint g(int x){\n    return (ksm(x,n,mod)-x+mod)%mod;\n}\nvoid work(int k){\n    int cnt=h/k-(l+k-1)/k+1;\n    f[k]=g(cnt);\n    for(int i=2*k;i<=h-l;i+=k){\n        f[k]-=f[i];\n        f[k]+=mod;\n        f[k]%=mod;\n    }\n}\nint main(){\n    //if(n==2&&k==3&&l==100&&h==100000){\n    \t//printf(\"674124662\");\n    \t//return 0;\n\t//}\n    scanf(\"%d%d%d%d\",&n,&k,&l,&h);\n    l=(l+k-1)/k;\n    h/=k;\n    for(int i=h-l;i;i--) work(i);\n    printf(\"%d\",f[1]+(l==1));\n    return 0;\n}\n```\n",
        "postTime": 1606215304,
        "uid": 289230,
        "name": "ricky0916",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3172 \u3010[CQOI2015]\u9009\u6570\u3011"
    },
    {
        "content": "# [\u63a8\u8350\u70b9\u8fd9\u91cc\u89c2\u770b](https://www.cnblogs.com/linzhuohang/p/13544978.html)\n\n# \u9898\u76ee\n\u6211\u4eec\u77e5\u9053\uff0c\u4ece\u533a\u95f4[L,H]\uff08L\u548cH\u4e3a\u6574\u6570\uff09\u4e2d\u9009\u53d6N\u4e2a\u6574\u6570\uff0c\u603b\u5171\u6709(H-L+1)^N\u79cd\u65b9\u6848\u3002\u5c0fz\u5f88\u597d\u5947\u8fd9\u6837\u9009\u51fa\u7684\u6570\u7684\u6700\u5927\u516c\u7ea6\u6570\u7684\u89c4\u5f8b\uff0c\u4ed6\u51b3\u5b9a\u5bf9\u6bcf\u79cd\u65b9\u6848\u9009\u51fa\u7684N\u4e2a\u6574\u6570\u90fd\u6c42\u4e00\u6b21\u6700\u5927\u516c\u7ea6\u6570\uff0c\u4ee5\u4fbf\u8fdb\u4e00\u6b65\u7814\u7a76\u3002\u7136\u800c\u4ed6\u5f88\u5feb\u53d1\u73b0\u5de5\u4f5c\u91cf\u592a\u5927\u4e86\uff0c\u4e8e\u662f\u5411\u4f60\u5bfb\u6c42\u5e2e\u52a9\u3002\u4f60\u7684\u4efb\u52a1\u5f88\u7b80\u5355\uff0c\u5c0fz\u4f1a\u544a\u8bc9\u4f60\u4e00\u4e2a\u6574\u6570K\uff0c\u4f60\u9700\u8981\u56de\u7b54\u4ed6\u6700\u5927\u516c\u7ea6\u6570\u521a\u597d\u4e3aK\u7684\u9009\u53d6\u65b9\u6848\u6709\u591a\u5c11\u4e2a\u3002\u7531\u4e8e\u65b9\u6848\u6570\u8f83\u5927\uff0c\u4f60\u53ea\u9700\u8981\u8f93\u51fa\u5176\u9664\u4ee51000000007\u7684\u4f59\u6570\u5373\u53ef\u3002\n# \u9898\u89e3\n\u6309\u7167\u6c42\u533a\u95f4gcd\u7684\u5957\u8def\uff0c\u6211\u4eec\u5bf9\u6240\u6709\u6570\u9664\u4ee5k.\u5bf9\u5e94\u7684\u5c06l\u548cr\u4e5f\u9664\u4ee5k\n\n\u8fd9\u6837\u76ee\u6807\u5c31\u662f\u5728$(l,r]$\u5185\u627en\u4e2agcd\u6070\u597d\u4e3a1\u7684\u6570\n\n\u6211\u4eec\u8bbe $tot[i]$ \u8868\u793agcd\u6070\u597d\u4e3ai\u7684\u65b9\u6848\u6570\uff0c$tot2[i]$ \u8868\u793agcd\u4e3ai\u6216i\u7684\u500d\u6570\u65b9\u6848\u6570\u3002\n\n\u4eff\u7167\u4e4b\u524d\u7684\u5957\u8def\uff0c\u8bbe$x=l/i,y=r/i$\n\n\u5219\u5728$(x.y]$\u4e2d\u4efb\u610f\u53d6n\u4e2a\u6570\u90fd\u662f\u6ee1\u8db3\u8981\u6c42\u7684\n\n\u5219$tot2[i]=(y-x)^n$\n\n\u5219$tot[i]=tot2[i]-(y-x)-tot[i*2]-tot[i*3]...$\n\n\u56e0\u4e3agcd\u6700\u5927\u53ea\u80fd\u5230$r-l$\uff08\u518d\u5927r\u5c31\u7b49\u4e8el\u4e86\uff0c\u8fd9\u4e2a\u533a\u95f4\u5c31\u6ca1\u4e1c\u897f\u4e86\uff09\n\n\u6240\u4ee5i\u53ea\u7528\u679a\u4e3e\u5230$r-l$\n\n\u51cf\u53bb$y-x$\u662f\u56e0\u4e3a\u5982\u679c\u9009n\u4e2a\u540c\u6837\u7684\u6570a,\u90a3\u4e48\u4ed6\u4eec\u7684gcd\u5c31\u662fa\n\n\u800ca\u662f1e9\u7ea7\u522b\u7684\uff0c\u5728\u4e0a\u5f0f\u4e2d\u65e0\u6cd5\u6392\u9664\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u4e0a\u5f0f\u4e2d\u51cf\u53bb\u3002\n\n\u4f46\u5982\u679ck\u5728$(l,r]$\u5185\uff0c\u5219\u5168\u90e8\u9009k\u4e5f\u662f\u5408\u6cd5\u7684\u7b54\u6848\uff0c\u8981\u52a0\u56de\u4e00\n\n\u6700\u540e\u662f\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u8bbe$n=r-l$\n\n\u4e0a\u8ff0\u8fc7\u7a0b\u590d\u6742\u5ea6\u4e3a $n/1+n/2+n/3+n/4+..+n/n$\n\n\u8fd9\u662f\u4e00\u4e2a\u8c03\u548c\u7ea7\u6570\uff0c\u590d\u6742\u5ea6\u662f$O(nlogn)$\n\n\u8bc1\u660e\uff1a\n\n\u4e0a\u5f0f\u53ef\u4ee5\u653e\u5927\u6210 $n/1+n/2+n/2+n/4+n/4+n/4+n/4+..+n/n$\n\n\u7b49\u4e8e$n/1+n/2*2+n/4*4+n/8*8+n/4+...$\n\n\u4e5f\u5c31\u662f $nlogn$\n\n\u4e0a\u9762\u7528\u7684\u90fd\u662f\u524d\u5f00\u533a\u95f4\uff0c\u6240\u4ee5\u8981\u5c06\u9898\u76ee\u8f93\u5165\u7684l\u51cf\u4e00\n\n# \u4ee3\u7801\n```cpp\n#include <iostream>\n#include <cstdio>\nusing namespace std;\n#define N 100010\n#define int long long \n#define mod 1000000007\nint tot[N];//gcd\u521a\u597d\u662fi\u7684\u60c5\u51b5\u6570\uff08\u5728\u9664\u4e86k\u7684\u60c5\u51b5\u4e0b\uff09 \nint qpow(int a,int b)\n{\n\tint ans=1;\n\twhile(b)\n\t{\n\t\tif(b&1) ans*=a,ans%=mod;\n\t\ta*=a;\n\t\ta%=mod;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\nsigned main()\n{\n\tint n,k,l,r;\n\tcin>>n>>k>>l>>r;\n\tbool tag=(k>=l&&k<=r);//\u5982\u679cgcd\u5728\u533a\u95f4\u5185\uff0c\u90a3\u4e48\u90fd\u9009gcd\u8fd9\u4e00\u4f4d\u4e5f\u662f\u5408\u6cd5\u7684 \n\tl--;\n\tl/=k,r/=k;\n\tint len=r-l;\n\tfor(int i=len;i;i--)\n\t{\n\t\tint x=l/i,y=r/i;\n\t\tif(x>=y) continue;\n\t\ttot[i]=qpow(y-x,n)-(y-x);//\u51cf\u53bb\u90fd\u9009\u540c\u4e00\u4f4d\u7684\u60c5\u51b5 \n\t\tfor(int j=2;i*j<=len;j++) tot[i]+=mod-tot[i*j],tot[i]%=mod; //\u51cf\u53bb\u9009\u62e9\u7684\u65b9\u6848gcd\u4e3ai\u7684\u500d\u6570\u7684\u60c5\u51b5 \uff0c\u4f7fgcd\u6070\u597d\u4e3ai \n\t}\n\tcout<<tot[1]+tag;\n}\n```\n",
        "postTime": 1598068231,
        "uid": 119991,
        "name": "DrLin",
        "ccfLevel": 0,
        "title": "[CQOI2015] \u9009\u6570"
    },
    {
        "content": "\u6c42 $\\sum_{i_1=l}^h...\\sum_{i_n=l}^h\\ [gcd(i_1...i_n)=k]$\n\n\u4e3a\u4e86\u770b\u8d77\u6765\u597d\u770b~~\u5077\u61d2~~\uff0c\u4e0b\u9762\u628a$\\sum_{i_1=l}^{h}...\\sum_{i_n=l}^{h}$\u8fd9\u4e2a\u4e1c\u897f\u5199\u6210n=2\u7684\u60c5\u51b5\uff1a$\\sum_{i=l}^h\\sum_{j=l}^k$\n\n\u5148\u63d0\u51fak\uff0c\u679a\u4e3ek\u7684\u500d\u6570\n$$\n\\sum_{i=(l-1)/k+1}^{h/k}\\sum_{j=(l-1)/k}^{h/k}[gcd(i,j)=1]\n$$\n\u5957\u8def\u7684\u53cd\u6f14\u4e00\u4e0b\n$$\n\\sum_{i=(l-1)/k}^{h/k}\\sum_{j=(l-1)/k}^{h/k}\\sum_{d|i,d|j}\\mu(d)\n$$\n\u6539\u4e3a\u679a\u4e3ed\u548c\u4ed6\u7684\u500d\u6570\n$$\n\\sum_{d=1}^{h/k}\\mu(d)\\sum_{i=\\frac{l-1}{kd}}^{h/kd}\\sum_{j=\\frac{l-1}{kd}}^{h/kd}\n$$\n\u8fd9\u65f6\u5019\u628a\u540e\u9762\u7684\u6539\u6210\u5e94\u6709\u7684\u5f62\u5f0f\uff1a$(\\frac{h}{kd}-\\frac{l-1}{kd})^n$\n\n\u8fd9\u6837\u53ea\u8981\u6c42\u51fa$\\mu$\u7684\u524d\u7f00\u548c\u5c31\u597d\u4e86\uff0c\u675c\u6559\u7b5b\u76d8\u4ed6\u3002\n\n```c++\n#include<map>\n#include<cstdio>\n#include<iostream>\n#define ll long long\n#define mod 1000000007\nusing namespace std;\nint o[2000001],prime[1000010],sum[2000001];\nint p,k,n,m,blo,mu[2000001];\nll ans;\ninline ll ksm(ll a,ll b){\n\tll num=1;\n\twhile (b){\n\t\tif (b&1) num=num*a%mod;\n\t\ta=a*a%mod; b>>=1;\n\t}\n\treturn num;\n}\ninline void euler(){\n\to[1]=mu[1]=1;\n\tfor (int i=2; i<=blo; i++){\n\t\tif (!o[i]){\n\t\t\to[i]=1; prime[++prime[0]]=i;\n\t\t\tmu[i]=-1;\n\t\t}\n\t\tfor (int j=1; j<=prime[0]&&i*prime[j]<=blo; j++){\n\t\t\to[i*prime[j]]=1;\n\t\t\tif (i%prime[j]==0) break;\n\t\t\tmu[i*prime[j]]=-mu[i];\n\t\t}\n\t}\n\tfor (int i=1; i<=blo; i++) sum[i]=sum[i-1]+mu[i];\n}\nmap<int,int> nub;\nint get_mu(int x){\n\tif (x<=blo) return sum[x];\n\tif (nub[x]) return nub[x];\n\tint num=1;\n\tfor (int l=2,r; l<=x; l=r+1){\n\t\tr=x/(x/l);\n\t\tnum-=(r-l+1)*get_mu(x/l);\n\t}\n\treturn nub[x]=num;\n\t// return num;\n}\nint main(){\n\tscanf(\"%d%d%d%d\",&p,&k,&n,&m);\n\tn=(n-1)/k; m=m/k;// if (!n) n++;\n\tblo=2e6; euler(); //printf(\"%d\\n\",blo);\n\t// puts(\"ok\");\n\tfor (int l=1,r; l<=m; l=r+1){\n\t\tif (n/l==0) r=m/(m/l);\n\t\telse r=min(n/(n/l),m/(m/l));\n\t\t// r=min(n/l?n/(n/l):(int)2e9,m/(m/l));\n\t\tans=(ans+1LL*(get_mu(r)-get_mu(l-1))*ksm(m/l-n/l,p)%mod)%mod;\n\t}\n\tprintf(\"%lld\\n\",(ans+mod)%mod);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1552470518,
        "uid": 63661,
        "name": "Taduro",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3172 \u3010[CQOI2015]\u9009\u6570\u3011"
    }
]
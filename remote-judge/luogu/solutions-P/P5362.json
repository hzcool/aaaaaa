[
    {
        "content": "# \u3010\u9898\u89e3\u3011[SDOI2019]\u8fde\u7eed\u5b50\u5e8f\u5217\n\n> \u4e00\u9053\u4e0d\u9519\u7684\u627e\u89c4\u5f8b\u9898\n\n> **UPDATE on 2020.3.11\uff1a\u4fee\u590d\u4e86\u70b8\u4e86\u7684LaTex\uff0c\u4fee\u6b63\u4e86\u51e0\u5904\u5c0f\u7b14\u8bef\u4f7f\u5f97\u53d9\u8ff0\u66f4\u52a0\u6e05\u6670\u660e\u4e86**\n\n## \u9898\u610f\u7b80\u8ff0\n\n\u5b9a\u4e49$T.M.$\u5e8f\u5217$\\{T_n\\}$\u4e3a\u5982\u4e0b\u5f62\u5f0f\u768401\u5e8f\u5217\uff1a\n\n$\n\\begin{cases}\nT_0=0\\\\\nT_{2n}=T_n\\\\\nT_{2n+1}=1-T_n\n\\end{cases}\n$\n\n\u7ed9\u5b9a\u4e00\u4e2a01\u5e8f\u5217$S$\u548c\u4e00\u4e2a\u6b63\u6574\u6570$k$\uff0c\u8981\u6c42\u7edf\u8ba1\u6709\u591a\u5c11\u4e0d\u540c\u7684$T.M.$\u5e8f\u5217\u7684\u8fde\u7eed\u5b50\u5e8f\u5217$T$\u6ee1\u8db3\uff1a\n\n- $S$\u662f$T$\u7684\u524d\u7f00\n- $T$\u662f$S$\u5728\u53f3\u4fa7\u6070\u597d\u6dfb\u52a0\u4e86$k$\u9879\u5f62\u6210\u7684\u3002\n\n\u7b54\u6848\u5bf9$10^9+9$\u53d6\u6a21\u3002\n\n## \u601d\u8def\u8be6\u89e3\n\n\u6839\u636e\u8fd9\u4e2a\u6784\u9020\u65b9\u5f0f\uff0c\u6211\u4eec\u7b2c\u4e00\u773c\u80fd\u770b\u51fa\u7684\u662f\uff0c\u6bcf\u4e00\u6b21\u5728\u6269\u5927$T.M.$\u5e8f\u5217\u7684\u89c4\u6a21\u7684\u65f6\u5019\uff0c\u90fd\u662f\u5f53\u524d\u7684$T.M.$\u5e8f\u5217\u53d6\u53cd\u540e\u63a5\u5728\u53f3\u8fb9\u3002\u6bd4\u5982\u8bf4`0110`->`01101001`\u3002\n\n\u4f46\u662f\u8fd9\u4e2a\u6784\u9020\u65b9\u5f0f\u4ecd\u7136\u8fc7\u4e8e\u590d\u6742\uff0c\u4e0d\u592a\u597d\u5904\u7406\u3002\u6ce8\u610f\u5230\u6570\u636e\u8303\u56f4\uff0c$k \\leq 10^{18}$\uff0c\u8fd9\u4e2a\u6570\u636e\u8303\u56f4\uff0c\u4e0d\u662f$\\Theta(1)$\u5c31\u662f$\\Theta(\\log_2k)$\uff0c\u4f46\u662f$\\Theta(1)$\u663e\u7136\u662f\u4e0d\u592a\u73b0\u5b9e\u7684\uff0c\u8003\u8651$\\Theta(\\log_2k)$\u505a\u6cd5\uff0c\u8981\u6c42\u6211\u4eec\u6bcf\u6b21\u80fd\u591f\u628a\u95ee\u9898\u89c4\u6a21\u7f29\u5c0f\u4e00\u534a\uff0c\u4f46\u662f\u4e0a\u8ff0\u7684\u6784\u9020\u65b9\u5f0f\u53ea\u5bf9\u4e8e\u957f\u5ea6\u4e3a$2^x,x \\in N$\u7684\u8fde\u7eed\u5b50\u5e8f\u5217\u8d77\u4f5c\u7528\u3002\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u7684\u76ee\u6807\u5c31\u8f6c\u5316\u4e3a\u4e86\u627e\u5230\u4e00\u79cd\u65b9\u6cd5\u80fd\u591f\u5c06\u4efb\u610f\u8fde\u7eed\u5b50\u5e8f\u5217\u7684\u89c4\u6a21\u7f29\u5c0f\u4e00\u534a\uff0c\u5e76\u4e14\u80fd\u591f\u8fd8\u539f\u4e00\u5f00\u59cb\u7684\u5b50\u5e8f\u5217\u3002\n\n\u8003\u8651\u53e6\u5916\u4e00\u79cd\u6784\u9020\u65b9\u5f0f\uff1a\u6bcf\u4e00\u6b21\u6269\u5927$T.M.$\u5b50\u5e8f\u5217\uff0c\u5c31\u662f\u5f80\u6bcf\u4e2a0\u540e\u8fb9\u52a0\u4e00\u4e2a1\uff0c\u5f80\u6bcf\u4e2a1\u540e\u8fb9\u52a0\u4e00\u4e2a0\u3002\u6839\u636e\u8fd9\u79cd\u6784\u9020\u65b9\u6cd5\u4e0d\u96be\u770b\u51fa\uff0c\u4efb\u610f\u4e00\u4e2a\u5408\u6cd5\u7684\u8fde\u7eed\u5b50\u5e8f\u5217\u91cc\u8fb9\u8fde\u7eed\u76841\u6216\u80050\u7684\u4e2a\u6570\u90fd$\\leq 2$\u3002\u8003\u8651\u627e\u5230\u4e00\u4e2a01\u5b57\u7b26\u4e32\uff0c\u5b83\u6269\u5927\u540e\u5f97\u5230$S$\uff0c\u90a3\u4e48\u8fdb\u884c\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n- $|S|$\u4e3a\u5076\u6570\uff0c\u90a3\u4e48\u6709\u4e24\u79cd\u65b9\u6848\uff1a\n\n  - \u628aS\u6bcf\u4e24\u4f4d\u5b57\u7b26\u5206\u4e3a\u4e00\u7ec4\uff0c\u7136\u540e`01`->`0`\uff0c`10`->`1`\u3002\u6ce8\u610f\u5982\u679c\u67d0\u4e00\u7ec4\u662f`11`\u6216\u8005`00`\uff0c\u90a3\u8fd9\u79cd\u65b9\u5f0f\u884c\u4e0d\u901a\u3002\n  - \u628aS\u4ece$S_2$\u5230$S_{|S|-1}$\u6bcf\u4e24\u4f4d\u5b57\u7b26\u5206\u4e3a\u4e00\u7ec4\uff0c\u7136\u540e`01`->`0`\uff0c`10`->`1`\u3002\u6ce8\u610f\u5982\u679c\u67d0\u4e00\u7ec4\u662f`11`\u6216\u8005`00`\uff0c\u90a3\u8fd9\u79cd\u65b9\u5f0f\u884c\u4e0d\u901a\u3002\n\n  \u53ef\u4ee5\u8bc1\u660e\uff0c\u5bf9\u4e8e$\\forall S$\uff0c\u82e5\u6709\u89e3\uff0c\u5219\u6709\u4e14\u4ec5\u6709\u4e00\u79cd\u65b9\u5f0f\u6709\u89e3\u3002\u6ce8\u610f$|S|=2$\u65f6\u4ec5\u80fd\u7528\u65b9\u6848\u4e00\u3002\n\n- $|S|$\u4e3a\u5947\u6570\uff0c\u90a3\u4e48\u6709\u4e24\u79cd\u65b9\u6848\uff1a\n\n  - \u628aS\u4ece$S_1$\u5230$S_{|S|-1}$\u6bcf\u4e24\u4f4d\u5b57\u7b26\u5206\u4e3a\u4e00\u7ec4\uff0c\u7136\u540e`01`->`0`\uff0c`10`->`1`\u3002\u6ce8\u610f\u5982\u679c\u67d0\u4e00\u7ec4\u662f`11`\u6216\u8005`00`\uff0c\u90a3\u8fd9\u79cd\u65b9\u5f0f\u884c\u4e0d\u901a\u3002\n  - \u628aS\u4ece$S_2$\u5230$S_{|S|}$\u6bcf\u4e24\u4f4d\u5b57\u7b26\u5206\u4e3a\u4e00\u7ec4\uff0c\u7136\u540e`01`->`0`\uff0c`10`->`1`\u3002\u6ce8\u610f\u5982\u679c\u67d0\u4e00\u7ec4\u662f`11`\u6216\u8005`00`\uff0c\u90a3\u8fd9\u79cd\u65b9\u5f0f\u884c\u4e0d\u901a\u3002\u6ce8\u610f\u5728\u8fd9\u79cd\u65b9\u5f0f\u4e0b\uff0c\u627e\u5230\u7684\u5b57\u7b26\u4e32\u7b2c\u4e00\u4f4d\u662f$S_1xor1$\u3002\n\n  \u53ef\u4ee5\u8bc1\u660e\uff0c\u5bf9\u4e8e$|S|>3$\uff0c\u82e5\u6709\u89e3\uff0c\u5219\u6709\u4e14\u4ec5\u6709\u4e00\u79cd\u65b9\u5f0f\u6709\u89e3\u3002\n\n\u6211\u4eec\u8bb0\u5f53\u524d\u64cd\u4f5c\u5f97\u5230\u7684\u5b57\u7b26\u4e32\u662f$\\frac{S}{2}$\uff0c$f(S,k)$\u4ee3\u8868\u5f53\u524d01\u4e32\u4e3a$S$\uff0c\u5f80\u540e\u52a0$k$\u4f4d\u5f97\u5230\u7684\u4e0d\u540c\u7684\u8fde\u7eed\u5b50\u5e8f\u5217\u4e2a\u6570\uff0c\u5219\u5bb9\u6613\u5f97\u5230$f(S,k)$\u7684\u9012\u5f52\u8ba1\u7b97\u65b9\u6cd5\u3002\n\n\u7136\u540e$f(S,k)$\u7528map\u5b58\uff08\u4e0d\u7136\u8fd8\u6709\u5565\u80fd\u5b58\u7684\u4e0b\u554a\uff09\u3002\n\n\u6700\u540e\u53e3\u80e1\u4e00\u4e0b\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$\\Theta(T(|S|+\\log_2k))$\n\n## \u4ee3\u7801\u65f6\u95f4\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<string,ll> var;\nint t;\nconst ll mod=1e9+9; \nstring s;\nll k;\nmap<var,ll> f; \nnamespace QiFeng233{\n\tll calc(string s,ll k){\n\t\tif(s.size()==1){\n\t\t\tif(k==0||k==1||k==2)return k+1;\n\t\t}else if(s.size()==2){\n\t\t\tif(k==0)return 1;\n\t\t\tif(k==1)return s[0]==s[1]?1:2;\n\t\t}else if(s.size()==3){\n\t\t\tif(k==0)return s[0]!=s[1]||s[1]!=s[2];\n\t\t}\n\t\tvar v=make_pair(s,k);\n\t\tif(f.count(v))return f[v];\n\t\tstring nxt;\n\t\tll ans=0;\n\t\tbool successful=true;\n\t\tfor(int i=0;i<(int)s.size();i+=2){\n\t\t\tif(i<(int)s.size()-1&&s[i]==s[i+1]){\n\t\t\t\tsuccessful=false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tnxt+=s[i];\n\t\t}\n\t\tif(successful)ans+=calc(nxt,s.size()%2?(k>>1):((k+1)>>1)),ans%=mod;\n\t\tnxt=s[0]^1;\n\t\tsuccessful=true;\n\t\tfor(int i=1;i<(int)s.size();i+=2){\n\t\t\tif(i<(int)s.size()-1&&s[i]==s[i+1]){\n\t\t\t\tsuccessful=false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tnxt+=s[i];\n\t\t}\n\t\tif(successful)ans+=calc(nxt,s.size()%2?((k+1)>>1):(k>>1)),ans%=mod;\n\t\treturn f[v]=ans;\n\t}\n}\nsigned main(){\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\tcin>>t;\n\twhile(t--)cin>>s>>k,cout<<QiFeng233::calc(s,k)%mod<<endl;\n\treturn 0;\n}\n```\n\n## \u53cd\u601d\u603b\u7ed3\n\n- \u601d\u7ef4\u9898\u5f80\u5f80\u4e0d\u9700\u8981\u591a\u5c11\u7b97\u6cd5\u77e5\u8bc6\uff0c\u8fd9\u9898\u5c31\u53ea\u7528\u4e86\u57fa\u7840\u7b97\u6cd5\u2014\u2014\u5206\u6cbb\u3002\n- \u601d\u7ef4\u9898\u8981\u6c42\u80fd\u8df3\u51fa\u601d\u7ef4\u5b9a\u52bf\uff0c\u7075\u6d3b\u601d\u8003\u3002\u5c31\u50cf\u8fd9\u9898\uff0c\u5982\u679c\u4e0d\u80fd\u60f3\u5230\u4e0a\u6587\u63d0\u5230\u7684\u6784\u9020\u65b9\u5f0f\u800c\u53ea\u662f\u7167\u7740\u9898\u76ee\u7ed9\u4f60\u7684\u6784\u9020\u65b9\u5f0f\u6b7b\u521a\uff0c\u662f\u4e0d\u4f1a\u6709\u7ed3\u679c\u7684\u3002\n- \u9762\u5411\u6570\u636e\u7f16\u7a0b\uff0c\u5c31\u50cf\u770b\u5230$k \\leq 10^{18}$\u5c31\u80fd\u60f3\u5230$\\Theta(1)$\u6216\u8005$\\Theta(\\log_2k)$\u4ece\u800c\u60f3\u51fa\u6b63\u89e3\u3002\n- \u8fd9\u4e2a$T.M.$\u5e8f\u5217\u5168\u540dThue\u2212Morse\u5e8f\u5217\u3002\u4ed4\u7ec6\u4e00\u60f3\uff0c\u597d\u50cf\u6211\u4ee5\u524d\u89c1\u8fc7\u5b83\u51e0\u6b21\uff0c\u4f46\u662f\u6211\u6ca1\u4e00\u6b21\u505a\u51fa\u6765\u4e86/kk\n- \u8fd9\u9898\u6a21\u6570\u662f$10^9+9$\uff0c\u4f46\u6211\u4e00\u5f00\u59cb\u6a21\u4e86$10^9+7$/kk",
        "postTime": 1583855184,
        "uid": 233357,
        "name": "QiFeng233",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5362 \u3010[SDOI2019]\u8fde\u7eed\u5b50\u5e8f\u5217\u3011"
    },
    {
        "content": "\u9898\u76ee\u5927\u610f\uff1a\u6709\u4e00\u4e2a01\u4e32tm\uff0c\u6ee1\u8db3tm(0)=0\uff0ctm(i)=tm(i>>1)^(i&1)\u3002\u7ed9\u5b9a01\u4e32s\u548c\u6574\u6570k\uff0c\u95ee\u6709\u591a\u5c11\u4e2a\u672c\u8d28\u4e0d\u540c\u768401\u4e32t\u6ee1\u8db3\uff1at\u662ftm\u7684\u5b50\u4e32\uff0cs\u662ft\u7684\u524d\u7f00\uff0ct\u7684\u957f\u5ea6\u662f|s|+k\u3002\n\n\u5168\u573a\u65e0\u4ebaac\u7684\u627e\u89c4\u5f8b\u795e\u9898\u3002\n\n\u5173\u4e8etm\u5e8f\u5217\uff0c\u6709\u5f88\u591a\u79cd\u89e3\u91ca\u65b9\u5f0f\uff0c\u6bd4\u5982\u6bcf\u4e2a\u6570\u7684\u4e8c\u8fdb\u5236\u4e2d1\u7684\u4e2a\u6570\u7684\u5947\u5076\u6027\u5566\uff0c\u4ece0\u5f00\u59cb\u6bcf\u6b21\u628a\u81ea\u8eab\u53d6\u53cd\u63a5\u5728\u540e\u9762\u5566\u7b49\u7b49\u3002\u5bf9\u4e8e\u8fd9\u4e2a\u9898\uff0c\u6700\u597d\u7684\u89e3\u91ca\u65b9\u5f0f\u662f\u8fd9\u6837\u7684\uff1a\n\n\u4ece0\u5f00\u59cb\uff0c\u6bcf\u6b21\u628a\u6240\u6709\u76840\u53d8\u621001\uff0c\u628a\u6240\u6709\u76841\u53d8\u621010\u3002\n\n\u4e3a\u4ec0\u4e48\u8fd9\u6837\u89e3\u91ca\u6700\u597d\u5462\uff1f\u56e0\u4e3a\u6211\u4eec\u53ef\u4ee5\u8bd5\u7740\u628a\u4e00\u4e2atm\u7684\u5b50\u4e32\u7528\u8fd9\u79cd\u65b9\u5f0f\u53d8\u6362\u56de\u53bb\uff1a\n\n\u5047\u8bbe\u4e00\u4e2a\u4e32s=abcdefg\n\n\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u6bcf2\u4f4d\u5212\u5206\u4e3a\u4e00\u6bb5\uff0c\u5373ab|cd|ef|g\u6216a|bc|de|fg\uff0c\u7136\u540e\u628a\u6bcf\u4e00\u6bb5\u6309\u4e0a\u8ff0\u89c4\u5219\u5408\u5e76\u4e3a\u4e00\u4e2a\u5b57\u7b26\u3002\n\n\u5982\u679c\u67d0\u4e00\u6bb5\u5185\u4e24\u4e2a\u5b57\u7b26\u76f8\u540c\uff0c\u610f\u5473\u7740\u8fd9\u6837\u5212\u5206\u662f\u4e0d\u5408\u6cd5\u7684\u3002\n\n\u4e24\u4fa7\u4e5f\u8bb8\u6709\u843d\u5355\u7684\u6bb5\uff0c\u4f46\u662f\u6839\u636e\u89c4\u5219\u5b9e\u9645\u4e0a\u4e0e\u5b83\u4eec\u6210\u4e00\u6bb5\u7684\u53e6\u4e00\u4e2a\u5b57\u7b26\u662f\u786e\u5b9a\u7684\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c06\u5176\u8865\u4e0a\u3002\n\n\u6bd4\u5982\u4e3210100110010\uff0c\u5c31\u53ef\u4ee5\u5207\u5272\u4e3a10|10|01|10|01|0\uff0c\u7136\u540e\u5408\u5e76\u6210110100\u3002\n\n\u53ef\u4ee5\u9a8c\u8bc1\uff1a\u5f53\u4e32\u957f>3\u65f6\uff0c\u5408\u6cd5\u7684\u5207\u5272\u65b9\u6848\u662f\u552f\u4e00\u7684\u3002\u6bd4\u5982\u4e321001\uff0c\u5c31\u53ea\u80fd\u5212\u5206\u4e3a10|01,\u800c\u4e321010\u770b\u4f3c\u53ef\u4ee5\u5212\u5206\u4e3a1|01|0\uff0c\u4f46\u662f\u7531\u4e8e\u8fd9\u6837\u7f29\u6210\u7684\u662f000\u56e0\u6b64\u4e0d\u5408\u6cd5\uff0c\u6240\u4ee5\u552f\u4e00\u7684\u5212\u5206\u65b9\u6848\u662f10|10\u3002\n\n\u56e0\u6b64\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u5bf9\u5207\u5272\u65b9\u6848\u7684\u8ba1\u6570\u6765\u5b9e\u73b0\u5bf9\u4e32\u7684\u8ba1\u6570\u3002\u8bbef(s,k)\u8868\u793a\u5f53\u524d\u4e32\u4e3as\uff0c\u540e\u9762\u63a5k\u4e2a\u5b57\u7b26\u7684\u65b9\u6848\u6570\u3002\u5f53|s|+k<=3\u65f6\u7279\u5224\uff0c\u5426\u5219\u679a\u4e3e2\u79cd\u5212\u5206\u65b9\u6848\uff0c\u5bf9\u4e8e\u5408\u6cd5\u7684\u65b9\u6848\u8fdb\u884c\u9012\u5f52\u64cd\u4f5c\u3002\u7528\u4e2amap\u5bf9\u72b6\u6001\u8fdb\u884c\u8bb0\u5fc6\u5316\u5373\u53ef\u3002\n\n\u672c\u8d28\u4e0d\u540c\u7684\u72b6\u6001\u6570\u5927\u7ea6\u53ea\u6709O(|s|+logk)\u7ea7\u522b\uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define gc getchar()\n#define pc putchar\n#define li long long\nint t;\nstring s;\nli k;\n#define psi pair<string,li>\n#define fi first\n#define se second\n#define mp make_pair\nmap<psi,li> mm;\nconst int mo = 1000000009;\ninline li wk(psi p){\n\tif(p.fi.size() == 1){\n\t\tif(!p.se) return 1;\n\t\tif(p.se == 1) return 2; \n\t\tif(p.se == 2) return 3;\n\t}\n\tif(p.fi.size() == 2){\n\t\tif(!p.se) return 1;\n\t\tif(p.se == 1) return (p.fi[0] == p.fi[1] ? 1 : 2);\n\t} \n\tif(p.fi.size() == 3 && !p.se) return (p.fi[0] == p.fi[1] && p.fi[1] == p.fi[2] ? 0 : 1);\n\tif(mm.find(p) != mm.end()) return mm[p];\n\tli as = 0;\n\tint i;\n\tbool fg = 1;\n\tstring nxt;\n\tnxt.clear();\n\tfor(i = 0;i < p.fi.size();i += 2){\n\t\tif(i == p.fi.size() - 1) nxt += p.fi[i];\n\t\telse if(p.fi[i] == p.fi[i + 1]){\n\t\t\tfg = 0;break;\n\t\t}\n\t\telse nxt += p.fi[i];\n\t} \n\tif(fg) as += wk(mp(nxt,(p.fi.size() % 2 ? (p.se >> 1) : (p.se + 1 >> 1))));\n\tfg = 1;nxt.clear();\n\tnxt += (p.fi[0] ^ 1);\n\tfor(i = 1;i < p.fi.size();i += 2){\n\t\tif(i == p.fi.size() - 1) nxt += p.fi[i];\n\t\telse if(p.fi[i] == p.fi[i + 1]){\n\t\t\tfg = 0;break;\n\t\t}\n\t\telse nxt += p.fi[i];\n\t} \n\tif(fg) as += wk(mp(nxt,(p.fi.size() % 2 ? (p.se + 1 >> 1) : (p.se >> 1))));\n\treturn mm[p] = as;\n}\nint main(){\n\tcin>>t;\n\twhile(t--){\n\t\tcin>>s>>k;\n\t\tcout<<wk(mp(s,k)) % mo<<endl;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1557294568,
        "uid": 45775,
        "name": "liuzhangfeiabc",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5362 \u3010[SDOI2019]\u8fde\u7eed\u5b50\u5e8f\u5217\u3011"
    },
    {
        "content": "\u627e\u89c4\u5f8b\u9898\uff0c\u63d0\u4f9b\u4e00\u4e2a\u66f4\u52a0\u597d\u60f3\u4f46\u662f\u590d\u6742\u5ea6\u7a0d\u52a3\u7684\u505a\u6cd5\u3002\u4e0b\u6587\u7ea6\u5b9a $\\text{ppc}(x)$ \u8868\u793a $x$ \u4e8c\u8fdb\u5236\u4e0b $1$ \u7684\u4e2a\u6570\uff0c$\\text{ctz}(x)$ \u8868\u793a\u672b\u5c3e $0$ \u7684\u4e2a\u6570\u3002\n\n\u9996\u5148\u6ce8\u610f\u5230 $T_i=\\text{ppc}(i)\\bmod 2$\u3002\n\n\u5148\u8003\u8651\u5224\u65ad\u4ec0\u4e48\u4e32\u662f\u5408\u6cd5\u7684\u3002\u8bbe\u5f53\u524d\u6570\u4e3a $x$\uff0c\u82e5\u5c06 $x\\gets x+1$\uff0c\u89c2\u5bdf $x$ \u7684 popcount \u7684\u53d8\u5316\uff0c\u53ef\u4ee5\u53d1\u73b0 $+1$ \u8fdb\u4f4d\u4e4b\u540e\uff0c\u4f1a\u6d88\u53bb $x$ \u672b\u5c3e\u8fde\u7eed\u7684 $1$\uff0c\u7136\u540e\u52a0\u4e0a\u4e00\u4e2a $1$\u3002\u5f62\u5f0f\u5730\u523b\u753b\uff1a\n\n> \u89c2\u5bdf $1$\uff1a$T_i\\oplus T_{i-1}=\\text{ctz}(i)\\bmod 2$\u3002\n\n\u5982\u679c\u4f60\u6253\u4e86\u4e00\u4e2a\u8868\u53ef\u4ee5\u53d1\u73b0 $T_i\\oplus T_{i-1}$ \u662f\u6709\u5468\u671f\u6027\u7684\uff0c\u6839\u636e\u4e0a\u8ff0\u89c2\u5bdf\u4e0d\u96be\u8bf4\u660e\u3002\u6545\u6211\u4eec\u4ee4 $d_i=T_{i}\\oplus T_{i-1}$\uff0c\u6b64\u65f6\u53ea\u8981\u5728 $d_i$ \u4e2d\u5339\u914d\u3002\u6211\u4eec\u8bf4\u660e\u5728 $d_i$ \u4e2d\u5339\u914d\u548c\u539f\u95ee\u9898\u662f\u7b49\u4ef7\u7684\uff1a\n\n> \u89c2\u5bdf $2$\uff1a\u5bf9\u4e8e\u4e32 $s$\uff0c\u5b9a\u4e49 $s'$ \u8868\u793a $s$ \u6309\u4f4d\u53d6\u53cd\u540e\u7684\u7ed3\u679c\uff0c\u5219 $s$ \u5728 T.M. \u5e8f\u5217\u4e2d\u51fa\u73b0\u7b49\u4ef7\u4e8e $s'$ \u5728 T.M. \u5e8f\u5217\u51fa\u73b0\u3002\n\n\u8bc1\u660e\u5373\u8003\u8651 T.M. \u5e8f\u5217\u7684\u4e00\u79cd\u751f\u6210\u65b9\u5f0f\uff1a\u751f\u6210 $T_{0\\sim 2^k-1}$\uff0c\u7136\u540e\u4ee4 $T_{0,2^{k+1}-1}=T_{0,2^k-1}+T_{0,2^k-1}'$\u3002\u6545 $s$ \u4e00\u5b9a\u88ab\u6309\u4f4d\u53d6\u53cd\u4e4b\u540e\u63a5\u5728\u4e86\u540e\u9762\u3002\u6545 $s_0$ \u7684\u53d6\u503c\u5e76\u4e0d\u91cd\u8981\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5173\u6ce8\u5176\u5dee\u5206\u6570\u7ec4\u3002\n\n\u7136\u800c\u7531\u4e8e\u539f\u5e8f\u5217\u662f\u65e0\u7a77\u7684\uff0c\u6240\u4ee5\u5b57\u7b26\u4e32\u5339\u914d\u7684\u4f4d\u7f6e\u53ef\u80fd\u5f88\u8fdc\u3002\u6211\u4eec\u7ed9\u51fa\u4e24\u4e2a\u7ed3\u8bba\u8bf4\u660e\u5b50\u5e8f\u5217\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\u5e76\u4e0d\u4f1a\u5f88\u8fdc\uff1a\n\n> \u89c2\u5bdf $3$\uff1a\u5047\u8bbe\u5339\u914d\u7684\u4f4d\u7f6e\u4e3a $[l,l+|s|-1]$\uff0c\u5047\u8bbe $\\text{argmax}_{i=l}^{l+|s|-1}\\text{ctz}(i)=t2^k$\uff0c\u5219\u628a\u5bf9\u5e94\u4f4d\u7f6e\u8c03\u6574\u5230 $2^k$ \u5f97\u5230\u7684\u5e8f\u5217\u548c\u539f\u5e8f\u5217\u7b49\u4ef7\u3002\n>\n> \u89c2\u5bdf $4$\uff1a\u5047\u8bbe\u5339\u914d\u7684\u4f4d\u7f6e\u4e3a $[l,l+|s|-1]$\uff0c\u5047\u8bbe $\\text{argmax}_{i=l}^{l+|s|-1}\\text{ctz}(i)=2^k$\uff0c\u5219\u82e5 $2^k-2^{\\frac{k}{4}}\\notin[l,l+|s|-1]\\land 2^k+2^{\\frac{k}{4}}\\notin[l,l+|s|-1]$\uff0c\u5219\u628a\u5bf9\u5e94\u4f4d\u7f6e\u8c03\u6574\u5230 $2^{\\frac{k}{4}}$ \u5f97\u5230\u7684\u5e8f\u5217\u548c\u539f\u5e8f\u5217\u7b49\u4ef7\uff08\u524d\u63d0\u662f\u8c03\u6574\u540e\u5339\u914d\u533a\u95f4\u4ecd\u7136\u5728\u8303\u56f4\u5185\uff09\u3002\n\n\u7406\u89e3\u4e0a\u8ff0\u7ed3\u8bba\u53ea\u9700\u8981\u6ce8\u610f\u5230\uff1a\u82e5\u786e\u5b9a\u4e86 $\\text{argmax}_{i=l}^{l+|s|-1}\\text{ctz}(i)$\uff0c\u5219\u5e8f\u5217\u53ef\u4ee5\u88ab\u552f\u4e00\u786e\u5b9a\u3002\u8fd9\u662f\u56e0\u4e3a\u5047\u8bbe $k=\\max \\text{ctz}(i)$\uff0c\u5219\u82e5\u6211\u4eec\u5728\u6a21 $2^k$ \u610f\u4e49\u4e0b\u8ba8\u8bba\u95ee\u9898\uff0c\u5219 $\\text{ctz}(i)\\bmod 2$ \u7684\u4fe1\u606f\u88ab\u5b8c\u5168\u5305\u542b\u3002\u540c\u6837\u5730\uff0c\u82e5 $2^{k}\\to 2^{\\frac{k}{4}}$ \u65f6\u6ca1\u6709\u51fa\u73b0\u66f4\u5927\u7684 $\\text{ctz}$ \u88ab\u5305\u62ec\u5728\u5339\u914d\u4f4d\u7f6e\u4e2d\uff0c\u90a3\u4e48\u5947\u5076\u6027\u4ecd\u7136\u662f\u76f8\u540c\u7684\u3002\n\n\u6839\u636e\u4e0a\u8ff0\u8ba8\u8bba\uff0c\u7ecf\u8fc7\u4e0d\u65ad\u8c03\u6574\u4e4b\u540e\uff0c\u5339\u914d\u7684\u8303\u56f4\u88ab\u7f29\u5c0f\u5230 $4(n+k-1)$ \u8303\u56f4\u5185\uff0c\u66f4\u4e3a\u7cbe\u786e\u7684\uff0c\u5047\u8bbe $t=\\lfloor\\log_2(n+k-1)\\rfloor$\uff0c\u5219\u5339\u914d\u7684\u8303\u56f4\u53ef\u4ee5\u88ab\u7f29\u5c0f\u5230\u4e3a $[1,2^{t+2}]$\u3002\n\n\u4f46\u662f\u8303\u56f4\u4ecd\u7136\u53ef\u80fd\u5f88\u5927\uff0c\u6211\u4eec\u9700\u8981\u8fdb\u4e00\u6b65\u89c2\u5bdf\u3002\u4ee4 $x=n+k-1$\uff0c\u5148\u89c2\u5bdf\u54ea\u4e9b\u8d77\u70b9 $l$ \u5bf9\u5e94\u7684\u4e32 $[l,l+x-1]$ \u662f\u7b2c\u4e00\u6b21\u51fa\u73b0\uff0c\u6211\u4eec\u76f4\u63a5\u7ed9\u51fa\u7ed3\u8bba\uff1a\n\n> \u89c2\u5bdf $5$\uff1a\u8d77\u70b9\u533a\u95f4\u6070\u597d\u5728 $[1,2^{t}-2^{t-2}]\\cup[32^{t-1}-x+1,2^t]\\cup [2^{t+1}-x+1,2^{t+1}-2^{t-1}]$\u3002\n\n\u8bc1\u660e\uff1a\u8003\u8651~~\u6253\u8868~~\u3002\u5bf9\u4e8e\u533a\u95f4\u4ee5\u5916\u7684\u4f4d\u7f6e\u4e00\u5b9a\u80fd\u901a\u8fc7\u8c03\u6574\u627e\u5230\u66f4\u65e9\u7684\u51fa\u73b0\u4f4d\u7f6e\u3002\n\n\u6240\u4ee5\u95ee\u9898\u76f4\u63a5\u8f6c\u5316\u4e3a\u4e86\u5728\u8fd9\u4e9b\u533a\u95f4\u91cc\u9762\u627e\u5230 $s$ \u7684\u5dee\u5206\u6570\u7ec4\u7684\u51fa\u73b0\u6b21\u6570\u3002\u6839\u636e\u4e0a\u9762\u7684\u7ed3\u8bba\uff0c\u6211\u4eec\u53ea\u9700\u8981\u679a\u4e3e $s$ \u8de8\u8fc7\u4f4d\u7f6e\u7684 $\\max _i\\text{ctz}(i)$ \u7684\u503c\uff0c\u66b4\u529b\u679a\u4e3e\u8d77\u70b9\u66b4\u529b\u5339\u914d\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(T|s|^2\\log k)$\u3002\n\n[\u53c2\u8003\u4ee3\u7801](https://loj.ac/s/1783013)\n\n\u4ece\u8003\u8651\u5982\u4f55\u628a\u53ef\u884c\u8303\u56f4\u7f29\u5c0f\u5230\u6709\u9650\u5230\u89c2\u5bdf\u53ef\u884c\u5339\u914d\u4f4d\u7f6e\u518d\u8fdb\u884c\u5339\u914d\uff0c\u6574\u4e2a\u8fc7\u7a0b\u8fd8\u662f\u6bd4\u8f83\u81ea\u7136\u7684\u3002",
        "postTime": 1685063294,
        "uid": 682934,
        "name": "yllcm",
        "ccfLevel": 0,
        "title": "Solution-P5362"
    },
    {
        "content": "#### \u9898\u610f\u7b80\u8ff0\n\n\u5b9a\u4e49 $\\text{TM}$ \u6570\u5217 $T$ \u4e3a\u901a\u8fc7\u5982\u4e0b\u9012\u5f52\u5f0f\u5f97\u5230\u7684 $\\texttt{01}$ \u5b57\u7b26\u4e32\uff08\u4e0b\u6807\u4ece $0$ \u5f00\u59cb\uff09\uff1a\n\n- $T_0=0$\uff1b\n- $T_{2n}=T_n$\uff1b\n- $T_{2n+1}=1-T_n$\u3002\n\n\u7ed9\u5b9a\u4e00\u4e2a $\\texttt{01}$ \u5b57\u7b26\u4e32 $S$ \u548c\u4e00\u4e2a\u975e\u8d1f\u6574\u6570 $k$\uff0c\u6c42\u6709\u591a\u5c11\u79cd $\\text{TM}$ \u5b57\u7b26\u4e32\u7684\u8fde\u7eed\u5b50\u4e32 $T$ \u6ee1\u8db3 $S$ \u4e3a $T$ \u7684\u524d\u7f00\u4e14 $|T|=|S|+k$\u3002\n\n**\u591a\u7ec4\u8be2\u95ee\u3002**\u5bf9\u4e8e $20\\%$ \u7684\u6570\u636e\uff0c\u6ee1\u8db3 $k\\le100$\uff1b   \n\u5bf9\u4e8e $40\\%$ \u7684\u6570\u636e\uff0c\u6ee1\u8db3 $1\\le k\\le5\\times10^4$\u3002   \n\u5bf9\u4e8e\u5168\u90e8\u6570\u636e\uff0c$T\\le100$\uff0c$|S|\\le100$\uff0c$k\\le10^{18}$\u3002   \n\n#### \u9898\u76ee\u89e3\u6cd5\n\n\u5148\u6765\u8003\u8651 $k=0$ \u7684\u60c5\u51b5\uff0c\u5373\u5224\u65ad $S$ \u662f\u5426\u4e3a $\\text{TM}$ \u5b57\u7b26\u4e32\u7684\u5b50\u4e32\u3002\n\n\u53d1\u73b0\u9898\u76ee\u4e2d\u7684 $\\text{TM}$ \u5b57\u7b26\u4e32\u5176\u5b9e\u5c31\u662f $\\text{Thue}-\\text{Morse}$ \u6570\u5217\uff0c\u8003\u8651 $\\text{Thue}-\\text{Morse}$ \u7684\u4ee5\u4e0b\u4e09\u79cd\u751f\u6210\u65b9\u5f0f\uff1a\n\n- \u6bcf\u4e2a\u6570\u4e8c\u8fdb\u5236\u8868\u8fbe\u4e2d\u7684 $1$ \u7684\u4e2a\u6570\u7684\u5947\u5076\u6027\uff1b\n- \u4ece $\\texttt{0}$ \u5f00\u59cb\uff0c\u6bcf\u6b21\u5c06\u81ea\u8eab\u53d6\u53cd\u540e\u63a5\u5728\u540e\u9762\uff1b\n- \u4ece $\\texttt{0}$ \u5f00\u59cb\uff0c\u6bcf\u6b21\u5c06\u6240\u6709\u7684 $\\texttt{0}$ \u66ff\u6362\u4e3a $\\texttt{01}$\uff0c\u5c06\u6240\u6709\u7684 $\\texttt{1}$ \u66ff\u6362\u6210 $\\texttt{10}$\u3002\n\n\u53d1\u73b0\uff0c\u7b2c\u4e09\u79cd\u751f\u6210\u65b9\u5f0f\u6bd4\u8f83\u9002\u5408\u6b64\u9898\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u4e00\u4e2a $\\text{TM}$ \u7684\u5b50\u4e32\u800c\u8a00\uff0c\u6b64\u64cd\u4f5c\u662f**\u53ef\u9006\u7684**\u3002\n\n\u8003\u8651\u4e00\u4e2a\u4e32 $S=s_1s_2\\cdots s_n$\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u6bcf\u4e24\u4f4d\u5212\u5206\u4e3a\u4e00\u6bb5\uff0c\u7136\u540e\u6309\u7167\u4e0a\u8ff0\u7b2c\u4e09\u79cd\u751f\u6210\u65b9\u5f0f\u5408\u5e76\u4e3a\u4e00\u4e2a\u5b57\u7b26\uff0c\u5982\u679c\u67d0\u4e00\u6bb5\u5185\u4e24\u4e2a\u5b57\u7b26\u76f8\u540c\uff0c\u5219\u610f\u5473\u7740\u8fd9\u6837\u5212\u5206\u662f\u4e0d\u5408\u6cd5\u7684\u3002\n\n\u5982\u679c\u4e24\u4fa7\u6709\u843d\u5355\u7684\u6bb5\uff0c\u5219\u53ef\u4ee5\u4f9d\u636e\u89c4\u5219\u63a8\u7406\u51fa\u5bf9\u5e94\u7684\u53e6\u4e00\u4e2a\u5b57\u7b26\uff0c\u4e5f\u53ef\u4ee5\u5c06\u5176\u8865\u4e0a\u3002\n\n\u53ef\u4ee5\u8bc1\u660e\uff0c\u5f53 $|S|>3$ \u65f6\uff0c**\u5408\u6cd5\u7684\u5408\u5e76\u65b9\u6848\u662f\u552f\u4e00\u7684**\uff0c\u56e0\u6b64\u53ef\u4ee5\u901a\u8fc7\u5bf9\u5408\u5e76\u65b9\u6848\u7684\u8ba1\u6570\u6765\u5b9e\u73b0\u5bf9\u4e32\u7684\u8ba1\u6570\u3002\n\n\u8bbe $f(S,k)$ \u4e3a\u5f53\u524d\u5b57\u7b26\u4e32\u4e3a\u6ee1\u8db3 $S$ \u4e3a $T$ \u7684\u524d\u7f00\u4e14 $|T|=|S|+k$ \u7684 $\\text{TM}$ \u5b57\u7b26\u4e32\u7684\u8fde\u7eed\u5b50\u4e32 $T$ \u7684\u79cd\u7c7b\u6570\uff0c\u5219\u5f53 $|S|+k>3$ \u65f6\u53ef\u4ee5\u76f4\u63a5\u679a\u4e3e\u4e24\u79cd\u53ef\u80fd\u7684\u5212\u5206\u65b9\u6848**\u9012\u5f52\u8ba1\u7b97**\uff0c\u5176\u95f4\u53ef\u4ee5**\u4f7f\u7528\u54c8\u5e0c\u8868\u8fdb\u884c\u8bb0\u5fc6\u5316\u641c\u7d22**\u3002\n\n\u53d1\u73b0\u672c\u8d28\u4e0d\u540c\u7684\u72b6\u6001\u6570\u4e3a $\\mathcal{O}(|S|+\\log k)$ \u7ea7\u522b\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n#### \u603b\u7ed3\n\n\u5173\u4e8e\u8fd9\u7c7b\u9012\u5f52\u751f\u6210\u6570\u5217\u7684\u95ee\u9898\u53ef\u4ee5\u6362\u79cd\u751f\u6210\u65b9\u5f0f\u8003\u8651\uff0c\u6709\u65f6\u53ef\u4ee5\u53d6\u5f97\u610f\u60f3\u4e0d\u5230\u7684\u6548\u679c\uff0c\u5e73\u65f6\u53ef\u4ee5\u8bb0\u5fc6\u4e00\u4e9b\u5e38\u89c1\u9012\u5f52\u6570\u5217\u7684\u5176\u5b83\u751f\u6210\u65b9\u5f0f\u3002",
        "postTime": 1680947252,
        "uid": 183609,
        "name": "hhoppitree",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5362"
    }
]
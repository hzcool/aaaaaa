[
    {
        "content": "\u4e00\u4e2a\u6709\u8da3\u7684\u6280\u672f\u540d\u5b57\u53eb\u505adp\u5957dp\n\n\u57fa\u672c\u662f\u9053\u677f\u5b50\u9898\uff0c\u53ea\u662f\u6ce8\u610f\u76f4\u63a5\u5f00\u8fd9\u4e48\u5927\u7684\u6570\u7ec4\u4f1a\u70b8\u8bf7\u6ce8\u610f\u4f7f\u7528\u6eda\u52a8\u6570\u7ec4\u8fdb\u884c\u4f18\u5316\n_______________\n\n\u9996\u5148\u7ffb\u8bd1\u4e00\u4e0b\u5e76\u4e0d\u597d\u61c2\u7684\u9898\u610f\n\n\u9898\u76ee\u7684\u610f\u601d\u662f\u5bf9\u4e8e\u6bcf\u4e00\u4e2ai\u6c42\u6ee1\u8db3\u5982\u4e0b\u6761\u4ef6\u7684\u5b57\u7b26\u4e32\u7684\u6570\u76ee\n\n1.\u957f\u5ea6\u4e3an\u4e14\u53ea\u51fa\u73b0\u8fc7'N','O','I'\u4e09\u79cd\u5b57\u7b26\n\n2.\u548c\u4e00\u4e2a\u957f\u5ea6\u4e3ak\u7684\u6a21\u5f0f\u4e32\u7684**\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217**\u957f\u5ea6\u6070\u597d\u4e3ai\n\n3.\u4e0d\u542b\"NOI\"\u8fd9\u4e2a**\u5b50\u4e32**\n\n\u7136\u540e\u8fd9\u662f\u4e00\u9053\u5bf9\u4e8e\u5b57\u7b26\u4e32\u8fdb\u884c\u8ba1\u6570\u7684\u9898\u76ee\u90a3\u4e48\u6211\u4eec\u8003\u8651\u91c7\u53d6\u8bbe\u4e00\u4e2a$dp_{i,\u2026\u2026}$\u8868\u793a\u957f\u5ea6\u4e3ai\uff0c\u5904\u4e8e\u4e00\u4e9b\u5947\u5947\u602a\u602a\u7684\u72b6\u6001\u65f6\u5b57\u7b26\u4e32\u7684\u65b9\u6848\u6570\uff0c\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u7684\u8f6c\u79fb\u5c31\u662f\u679a\u4e3e\u4e0b\u4e00\u4f4d\u662f\u586b'N'\u8fd8\u662f\u586b'O'\u8fd8\u662f\u586b'I'\u4e86\uff0c\u8fd9\u6837\u505a\u6709\u4e00\u4e2a\u597d\u5904\u662f\u4f60dp\u7684\u65f6\u5019\u4e0d\u9700\u8981\u8003\u8651\u6709\u6ca1\u6709\u5b57\u7b26\u4e32\u88ab\u91cd\u590d\u8ba1\u6570\u4e86\uff0c\u56e0\u4e3a\u4f60\u7684\u8f6c\u79fb\u4fdd\u8bc1\u4e86\u6bcf\u4e2a\u5b57\u7b26\u4e32\u6700\u591a\u88abdp\u5230\u4e00\u6b21\uff0c\u574f\u5904\u5c31\u662f\u522b\u7684\u9650\u5236\u51e0\u4e4e\u5c31\u53ea\u80fd\u6c42\u52a9\u4e8edp\u7684\u989d\u5916\u7ef4\u5ea6\u4e86\n\n\u5bf9\u4e8e\u5b57\u7b26\u4e32\u9898\u7684\u8bdd\u6211\u4eec\u6ee1\u8db3\u522b\u7684\u9650\u5236\u57fa\u672c\u5c31\u662f\u5efa\u4e00\u4e2a\u81ea\u52a8\u673a\u6765\u641e\u5b9a\u522b\u7684\u9650\u5236\u6761\u4ef6\u2026\u2026\u50cf\u4ec0\u4e48Ac\u81ea\u52a8\u673a\u540e\u7f00\u81ea\u52a8\u673a\u4e4b\u7c7b\u7684\u90fd\u53ef\u4ee5\u5e2e\u6211\u4eec\u641e\u5b9a\u4e00\u4e9b\u4f46\u4e0d\u662f\u5168\u90e8\u7684\u9650\u5236\u6761\u4ef6\n\n\u4f46\u662f\u5462\uff0c\u6ca1\u6709\"NOI\u201d\u5b50\u4e32\u8fd9\u4e2a\u9650\u5236\u6761\u4ef6\u6211\u4eec\u4f3c\u4e4e\u53ef\u4ee5\u8f7b\u677e\u7684\u8bb0\u4e00\u7ef4$k \\in \\{0,1,2\\}$\u8868\u793a\u8fd9\u4e2a\u5b57\u7b26\u4e32\u5339\u914d\u2018NOI\u2019\u7684\u957f\u5ea6\u6765\u8f7b\u677e\u641e\u5b9a\n\n\u4f46\u662f\u2026\u2026\u548c\u4e00\u4e2a\u6a21\u5f0f\u4e32\u7684\u6700\u5927\u5b50\u5e8f\u5217\u957f\u5ea6\u6070\u597d\u4e3ai\u8fd9\u4e2a\u9650\u5236\u6761\u4ef6\u5c31\u53d8\u5f97\u8fa3\u624b\u4e86\uff0c\u56e0\u4e3a\u6211\u4eec\u5e76\u6ca1\u6709\u4e00\u4e2a\u7c7b\u4f3c\u4e8e\u201c\u6700\u5927\u5b50\u5e8f\u5217\u81ea\u52a8\u673a\u201d\u7684\u4e1c\u897f\n\n\u4f46\u662f\u4ed4\u7ec6\u60f3\u60f3\u771f\u7684\u6ca1\u6709\u561b\uff1f\n\n\u9664\u4e86\u81ea\u52a8\u673a\uff0c\u8fd8\u6709\u4ec0\u4e48\u4e1c\u897f\u662f\u53ef\u4ee5\u901a\u8fc7\u6bcf\u6b21\u52a0\u4e00\u4e2a\u5b57\u7b26\u5b9e\u73b0\u8f6c\u79fb\u7684\u5462\u2026\u2026?\n\n**\u5f53\u7136\u662fdp\u4e86~**\n\n\u6240\u4ee5\u8ba9\u6211\u4eec\u6765\u8003\u8651\u4e00\u4e0b\u4e24\u4e2a\u4e32\u6c42\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217\u7684\u8fc7\u7a0b\n\n\u8bbe$dp_{i,j}$\u8868\u793a\u5728\u7b2c\u4e00\u4e2a\u4e32A\u957f\u5ea6\u4e3ai\u7684\u524d\u7f00\u548c\u7b2c\u4e8c\u4e2a\u4e32B\u957f\u5ea6\u4e3aj\u7684\u524d\u7f00\u7684\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217\u957f\u5ea6\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u8f6c\u79fb\u65b9\u7a0b\u662f\n\n$$dp_{i,j}=max(dp_{i-1,j},dp_{i,j-1},dp_{i-1,j-1}+(A_{i}==B_{j}))$$\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u5bf9\u8fd9\u4e2a\u8f6c\u79fb\u65b9\u7a0b\u4ee5\u53cadp\u6570\u7ec4\u505a\u82e5\u5e72\u624b\u811a\uff0c\u4eba\u5de5\u5236\u9020\u51fa\u4e00\u4e2a\u201c\u6700\u957f\u5b50\u5e8f\u5217\u81ea\u52a8\u673a\u201d\u6765\n\n\u9996\u5148\u6211\u4eec\u8ba4\u4e3a$B$\u8fd9\u4e2a\u5b57\u7b26\u4e32\u662f\u5df2\u77e5\u7684\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u5c31\u4f1a\u53d1\u73b0\u6211\u4eec\u6bcf\u6b21\u8f6c\u79fb\u6240\u9700\u8981\u7684\u4e1c\u897f\u6709\u4e24\u4e2a\uff0c\u4e00\u4e2a\u662f$dp_{i-1}$\u8fd9\u4e2a\u4e00\u7ef4\u6570\u7ec4\uff0c\u53e6\u4e00\u4e2a\u662f$A$\u4e32\u7684\u7b2ci\u4e2a\u5b57\u7b26\u4e86\uff0c\u6709\u4e86\u8fd9\u4e24\u4e2a\u4e1c\u897f\u6211\u4eec\u5c31\u53ef\u4ee5\u6839\u636e\u8f6c\u79fb\u65b9\u7a0b\u6784\u9020\u51fa$dp_{i}$\u8fd9\u4e2a\u6570\u7ec4\u6765\n\n\u90a3\u4e48\u5047\u8bbe$B$\u4e32\u7684\u957f\u5ea6\u4e0d\u662f\u975e\u5e38\u957f\uff0c\u90a3\u4e48\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u4e00\u4e2a\u957f\u5ea6\u4e3a$|B|$\u7684\u6570\u7ec4\u770b\u6210\u81ea\u52a8\u673a\u4e0a\u7684\u4e00\u4e2a\u8282\u70b9\uff0c\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u5c31\u53ef\u4ee5\u5f3a\u884c\u628a\u521a\u624d\u7684\u8f6c\u79fb\u65b9\u7a0b\u5f53\u505a\u81ea\u52a8\u673a\u7684\u8f6c\u79fb\u6761\u4ef6\uff0c\u6b64\u65f6\u6211\u4eec\u8981\u505a\u7684\u5c31\u662f\u679a\u4e3e$dp_{i-1}$\u6570\u7ec4\u6bcf\u4e00\u4e2a\u53ef\u80fd\u7684\u5f62\u6001\uff0c\u7136\u540e\u679a\u4e3e\u6bcf\u4e00\u4e2a\u53ef\u80fd\u7684\u5b57\u7b26\uff0c\u6839\u636e\u8f6c\u79fb\u65b9\u7a0b\u8ba1\u7b97\u51fa\u5bf9\u5e94\u7684\u8f6c\u79fb\u5230\u7684\u6570\u7ec4$dp_{i}$\u8fd9\u6837\u6211\u4eec\u5c31\u521d\u6b65\u5efa\u6210\u4e86\u4e00\u4e2a\u201c\u6700\u957f\u5b50\u5e8f\u5217\u81ea\u52a8\u673a\u201d\uff0c\u5f53\u7136\u8282\u70b9\u6570\u975e\u5e38\u975e\u5e38\u591a\u5c31\u662f\u4e86\n\n\u73b0\u5728\u7684\u74f6\u9888\u660e\u663e\u51fa\u5728\u6211\u4eec\u9700\u8981\u5c06\u4e00\u4e2a\u6570\u7ec4\u89c6\u4e3a\u5b50\u5e8f\u5217\u81ea\u52a8\u673a\u7684\u4e00\u4e2a\u8282\u70b9\u8fd9\u4e2a\u95ee\u9898\u4e0a\n\u6211\u4eec\u9700\u8981\u8003\u8651\u4e00\u4e0b\u662f\u4e0d\u662f\u6240\u6709\u7684dp\u6570\u7ec4\u90fd\u662f\u5408\u6cd5\u7684\n\n\u7136\u540e\u6211\u4eec\u8ba4\u771f\u7684\u8003\u8651\u4e00\u4e0b\u53d1\u73b0\u6709\u5f88\u5927\u4e00\u90e8\u5206\u6570\u7ec4\u662f\u4e0d\u5408\u6cd5\u7684\n\n\u56e0\u4e3a$dp_{i,j}$\u8868\u793a\u4e24\u4e2a\u5b57\u7b26\u4e32\u524d\u7f00\u7684\u7684\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217\u957f\u5ea6\u56e0\u6b64\u6211\u4eec\u53d1\u73b0\u4e00\u4e2a\u6709\u8da3\u7684\u4e8b\u5b9e\u662f\u5bf9\u4e8e\u4efb\u610f\u5b57\u7b26\u4e32A\u548c\u4efb\u610f\u7684i\u6570\u7ec4$dp_{i}$\u4e00\u5b9a\u662f\u5355\u8c03\u7684\uff0c\u53e6\u4e00\u4e2a\u4fe1\u606f\u662f\uff0c\u7531\u4e8e\u662f\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217\uff0c\u6240\u4ee5\u6570\u7ec4$dp_{i}$\u4efb\u610f\u4e24\u9879\u7684\u5dee\u8981\u4e48\u662f0\u8981\u4e48\u662f1\uff0c\u6b64\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u539f\u6570\u7ec4\u7684\u5dee\u5206\u6570\u7ec4\u8868\u8fbe\u6210\u4e00\u4e2a01\u4e32\uff0c\u73b0\u5728\u6240\u6709\u53ef\u80fd\u5408\u6cd5\u7684dp\u6570\u7ec4\u548c\u6240\u6709\u768401\u4e3211\u5bf9\u5e94\uff0c\u7136\u540e\u628a\u8fd9\u4e2a01\u4e32\u72b6\u538b\u8d77\u6765\uff0c\u6211\u4eec\u5c31\u5f97\u5230\u4e00\u4e2a\u8282\u70b9\u6570\u4e3a$2^k$\u7684\u6700\u957f\u5b50\u5e8f\u5217\u81ea\u52a8\u673a\n\n\u7136\u540e\u8fd8\u662f\u8001\u6837\u5b50\u679a\u4e3e\u70b9\u679a\u4e3e\u51fa\u8fb9\u5b57\u7b26\u4f7f\u7528dp\u7684\u8f6c\u79fb\u65b9\u7a0b\u8ba1\u7b97\u8f6c\u79fb\u70b9\u5c31\u53ef\u4ee5\u4e86\n\n\u6b64\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u8bbe$dp_{i,j,k}$\u8868\u793a\u957f\u5ea6\u4e3ai\u7684\u5b57\u7b26\u4e32\uff0c\u5904\u5728\u5b50\u5e8f\u5217\u81ea\u52a8j\u53f7\u70b9\u4e0a\uff0c\u4ee5\u53ca\u5339\u914d\"NOI\"\u7684\u957f\u5ea6\u662fk\u65f6\u7b26\u5408\u6761\u4ef6\u5b57\u7b26\u4e32\u7684\u4e2a\u6570\n\n\u7136\u540e\u65e0\u8111\u7684\u8dd1\u4e00\u8fb9dp\u5c31\u884c\u4e86\n\n\u5f53\u7136\uff0c\u4f60\u53ef\u4ee5\u4e0d\u5fc5\u628a\u81ea\u52a8\u673a\u5efa\u51fa\u6765\uff0c\u800c\u662f\u6bcf\u6b21\u8f6c\u79fb\u7684\u65f6\u5019\u73b0\u573adp\u4e00\u6b21\u8ba1\u7b97\u8f6c\u79fb\u5230\u7684\u72b6\u6001\uff0c\u8fd9\u6837\u4e5f\u662f\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u7684(6000ms\u65f6\u9650\u968f\u4fbf\u8fc7)\u8fd9\u4e5f\u662f\u8fd9\u79cd\u6280\u672f\u88ab\u79f0\u4e3adp\u5957dp\u7684\u539f\u56e0\n\n\u597d\u4e86\u4ee3\u7801\u5b9e\u9645\u4e0a\u662f\u6bd4\u4f60\u60f3\u8c61\u7684\u597d\u5199\u7684\n\n\u4e0a\u4ee3\u7801\n\n```C\n// luogu-judger-enable-o2\n#include<cstdio>\n#include<algorithm>\nusing namespace std;const int N=1e3+10;typedef long long ll;const ll mod=1e9+7;\nint n;int k;char mde[100];int dp[2][35000][3];int tr1[100];int tr2[100];int siz[35000];ll ans[100];\ninline int hsh(int* a){int ret=0;for(int i=0;i<k;i++)ret|=(a[i+1]-a[i])<<i;return ret;}\ninline void dhsh(int* a,int ret)//\u6570\u7ec4\u548c\u6570\u4e4b\u95f4\u7684\u8f6c\u5316\n{\n    for(int i=0;i<k;i++)a[i+1]=(ret>>i)&1;\n    for(int i=1;i<=k;i++)a[i]+=a[i-1];\n}\ninline void dypr(int ti,int cf,int tj,char c,const ll& val)//\u8f6c\u79fb\u51fd\u6570\n{\n    dhsh(tr1,cf);//\u73b0\u573a\u89e3\u538b\u6570\u7ec4\u4e4b\u540e\u538b\u7f29\n    for(int i=1;i<=k;i++)tr2[i]=max(max(tr2[i-1],tr1[i]),tr1[i-1]+1*(c==mde[i]));\n    int tcf=hsh(tr2);(dp[ti][tcf][tj]+=val)%=mod;\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&k);scanf(\"%s\",mde+1);//\u6ce8\u610f\u6eda\u52a8\u6570\u7ec4\n    for(int i=1;i<=32767;i++)siz[i]+=siz[i>>1]+(i&1);dp[0][0][0]=1;\n    for(int i=0;i<n;i++)\n    {\n        int ti=(~i)&1;int ni=i&1;\n        for(int j=0;j<(1<<k);j++)\n            for(int p=0;p<3;p++)dp[ti][j][p]=0;\n        for(int j=0;j<(1<<k);j++)//\u66b4\u529b\u679a\u4e3e\u4e0b\u4e00\u4e2a\u5b57\u7b26\u8fdb\u884c\u8f6c\u79fb\n        {\n            if(dp[ni][j][0]!=0)\n            {\n                dypr(ti,j,1,'N',dp[ni][j][0]);\n                dypr(ti,j,0,'O',dp[ni][j][0]);\n                dypr(ti,j,0,'I',dp[ni][j][0]);\n            }\n            if(dp[ni][j][1]!=0)\n            {\n                dypr(ti,j,1,'N',dp[ni][j][1]);\n                dypr(ti,j,2,'O',dp[ni][j][1]);\n                dypr(ti,j,0,'I',dp[ni][j][1]);\n            }\n            if(dp[ni][j][2]!=0)\n            {\n                dypr(ti,j,1,'N',dp[ni][j][2]);\n                dypr(ti,j,0,'O',dp[ni][j][2]);\n            }\n        }\n    }\n    for(int i=0;i<(1<<k);i++)//\u6700\u957f\u5b50\u5e8f\u5217\u957f\u5ea6\u81ea\u7136\u5c31\u662f01\u4e32\u4e2d1\u7684\u4e2a\u6570\uff0c\u56e0\u4e3a\u8fd9\u662fdp\u6570\u7ec4\u4e2d\u7684\u6700\u5927\u503c\n        for(int p=0;p<3;p++)(ans[siz[i]]+=dp[n&1][i][p])%=mod;\n    for(int i=0;i<=k;i++)printf(\"%lld\\n\",ans[i]);return 0;//\u62dc\u62dc\u7a0b\u5e8f~\n}\n```\n\n\n",
        "postTime": 1533045216,
        "uid": 56384,
        "name": "shadowice1984",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4590 \u3010[TJOI2018]\u6e38\u56ed\u4f1a\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u4ece\u4e2d\u534812\u70b9\u60f3\u5230\u534a\u591c12\u70b9\uff0c\u7ec8\u4e8e\u60f3\u660e\u767d\u4e86\u3002\u3002\u3002\u3002\u3002\n\n\u611f\u8c22lqx\u5b66\u957f\u7684\u8bb2\u89e3\uff1f\u987a\u4fbf\u8ba8\u503a\uff08\u4eac\u5473\u658b\u6211\u8fd8\u80fd\u4e0d\u80fd\u5403\u5230\u554a~\uff09\n\n\u9898\u610f\uff1a\u6ee1\u8db3$\\operatorname{LCS}$($A$,$B$)\u4e3a\u7ed9\u5b9a\u503c\u4e14\u5728$B$\u4e2d\u4efb\u610f\u4f4d\u7f6e\u4e0d\u542b\u6709\u8fde\u7eed\u7684\u201c$NOI$\u201d\u51fa\u73b0 \n\n\u8003\u8651\u6700\u4e00\u822c\u7684$\\operatorname{LCS}$\u95ee\u9898\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u5176\u5b9e\u662f\u4e00\u4e2a\u9006\u8fc7\u7a0b\u3002\n\n\u5728$\\operatorname{LCS}$\u7684\u539f\u59cb\u95ee\u9898\u4e2d\uff0c\u6211\u4eec\u662f\u8fd9\u6837\u505a\u7684\uff1a\n\n\u8bbe$dp(i,j)$\u8868\u793a\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e32\u53d6\u524d$i$\u4f4d\uff0c\u7b2c\u4e8c\u4e2a\u5b57\u7b26\u4e32\u53d6\u524d$j$\u4f4d\u6240\u5f97\u7684\u5b57\u7b26\u4e32$\\operatorname{LCS}$\u3002\n\n\u5219\u663e\u7136\u6709\u4ee5\u4e0b\u8f6c\u79fb\u65b9\u7a0b\uff1a\n$dp(i,j)$=$\\max$($dp(i-1,j)$,$dp(i,j-1)$)\n\n\u7279\u6b8a\u5730\uff0c\u5f53$a_i=b_j$\u65f6\uff0c$dp(i,j)$=$dp(i-1,j-1)+1$\n\n\u53ef\u662f\u8fd9\u548c\u6211\u4eec\u89e3\u51b3\u8fd9\u9053\u9898\u6709\u4ec0\u4e48\u5173\u7cfb\u5417\uff1f\n\n\u770b\u5230\u8fd9\u91cc\uff0c\u76f8\u4fe1dalao\u60a8\u5df2\u7ecf\u60f3\u51fa\u4e86\u4e00\u4e2a\u521d\u6b65\u7684$dp$\u65b9\u6cd5\u3002\n$\\operatorname{LCS}$\n\u8bbe$dp(i,j)$\u8868\u793a\u5151\u5956\u4e32\u524d$i$\u4f4d\u548c\u5956\u7ae0\u4e32\u7684$\\operatorname{LCS}$\u4e3a$j$\u65f6\u7684\u5408\u6cd5\u65b9\u6848\u6570\u3002\n\n\u4f46\u5f88\u9057\u61be\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u662f\u4e0d\u884c\u7684\u3002\n\n\u4f60\u4f1a\u53d1\u73b0\u4e00\u4e2a\u4e8b\u60c5\uff0c\u5f53\u6211\u4eec\u8bd5\u56fe\u628a$dp(i,j)$\u8f6c\u79fb\u5230$dp(i+1,j+1)$\u6216\u662f$dp(i+1,j)$\u7684\u65f6\u5019\uff0c\u4f46\u6211\u4eec\u4e0d\u77e5\u9053\u65b0\u52a0\u8fdb\u6765\u7684\u8fd9\u4e00\u4f4d\u80fd\u5426\u548c\u5956\u7ae0\u4e32\u8fdb\u4e00\u6b65\u5339\u914d\uff0c\u56e0\u4e3a\u4f60\u5e76\u4e0d\u77e5\u9053\u4e0a\u4e00\u6b21\u5339\u914d\u5230\u4e86\u54ea\u91cc\u3002\n\n\u800c\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u4e2a$dp$\u4e4b\u6240\u4ee5\u5931\u8d25\uff0c\u5f88\u5927\u7a0b\u5ea6\u4e0a\u662f\u56e0\u4e3a\u72b6\u6001\u4e4b\u95f4\u5f88\u96be\u8f6c\u79fb\u3002\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u7528\u591a\u52a0\u4e00\u4e9b\u9644\u52a0\u4fe1\u606f\u7684\u65b9\u6cd5\u6765\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\u3002\n\n\u8ba9\u6211\u4eec\u4ece\u539f\u59cb\u51fa\u53d1\u3002\u5728\u6211\u4eec\u77e5\u9053\u5f88\u591a\u4fe1\u606f\u7684\u60c5\u51b5\u4e0b\uff0c\u8f6c\u79fb\u8fd8\u662f\u975e\u5e38\u5bb9\u6613\u7684\u3002\u8bbe$f_i$\u8868\u793a\u5f53\u524d\u5151\u5956\u4e32\u4e0e\u524d$i$\u4f4d\u5956\u7ae0\u4e32\u5339\u914d\u540e\u7684$\\operatorname{LCS}$\u957f\u5ea6\u3002\n\n\u5047\u5982\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86$f$\u6570\u7ec4\uff0c\u90a3\u4e48\u8f6c\u79fb\u5c31\u5341\u5206\u7b80\u5355\u4e86\u3002\n\n\u4f46\u662f\u6211\u4eec\u7edd\u671b\u5730\u53d1\u73b0\uff0c\u8fd9\u4e2a\u505a\u6cd5\u65f6\u95f4\u7a7a\u95f4\u90fd\u4f1a\u70b8\u3002\n\n\u4f46\u662f\u6211\u4eec\u8f6c\u773c\u4e00\u770b\uff0c$k\\leq15$\u3002\n\n\u4e8e\u662f\u5c31\u53ef\u4ee5\u5c1d\u8bd5\u5feb\u4e50\u72b6\u538b\u3002\n\n\u8fdb\u4e00\u6b65\u89c2\u5bdf\u8fd9\u4e2a\u6570\u7ec4\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u5176\u5b9e\u5bf9\u4e8e\u540c\u4e00\u4e2a\u5151\u5956\u4e32\uff0c\u8fd9\u4e2a\u6570\u5217\u662f\u5355\u8c03\u9012\u589e\u7684\uff0c\u800c\u4e14\u6bcf\u6b21\u9012\u589e\u4e0d\u4f1a\u8d85\u8fc7$1$\u3002\n\n\u56e0\u6b64\u8003\u8651\u72b6\u538b\u5b83\u4eec\u7684\u5dee\u5206\u6570\u7ec4\u3002\n\n\u4e8e\u662f\u6700\u7ec8\u5c31\u6210\u4e86\u8fd9\u4e2a\u6837\u5b50:\u8bbe$dp(i,j)$\u8868\u793a\u5f53\u524d\u679a\u4e3e\u5230\u5151\u5956\u4e32\u7b2c$i$\u4f4d\uff0c\u4e14\u548c\u5956\u7ae0\u4e32\u7684$\\operatorname{LCS}$\u88ab\u72b6\u538b\u4e3a$j$\u3002\u8fdb\u4e00\u6b65\u53d1\u73b0\u53ef\u4ee5\u4f7f\u7528\u6eda\u52a8\u6570\u7ec4\u518d\u6b21\u4f18\u5316\u7a7a\u95f4\u590d\u6742\u5ea6\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e\u4e0d\u80fd\u51fa\u73b0\"$NOI$\"\u8fd9\u4e2a\u6761\u4ef6\u600e\u4e48\u529e\u5462\uff1f\n\n\u5f88\u7b80\u5355\uff0c\u53ea\u9700\u8981\u65b0\u5f00\u4e00\u7ef4\uff0c\u8bb0\u5f55\u5df2\u7ecf\u5339\u914d\u5230\u4e86\"$NOI$\"\u7684\u7b2c0/1/2\u7ef4\u5373\u53ef\u3002\n\n\u6700\u540e\u611f\u8c22LQX\u5b66\u957f\u7684\u8bb2\u89e3\uff0c\u5e0c\u671b\u4ed6\u80fd\u65e9\u65e5\u8bf7\u6211\u5403\u4eac\u5473\u658b~(\u522b\u62d6\u5230NOIP2020\u4e4b\u540e\u554a~~~)\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#define N 1005\nusing namespace std;\nint n,m,f[2][N],a[N],b[N],nxt[3][3]={{1,0,0},{1,2,0},{1,0,3}},dp[2][32769][3],ans[N],now,sta[32769][3];\nchar ch[N];\nconst int mod=1e9+7;\nvoid init()\n{\n\tfor(int s=0;s<(1<<m);s++)\n\t{\n\t\tfor(int k=0;k<m;k++)f[0][k+1]=f[0][k]+((s>>k)&1);\n\t\tfor(int j=0;j<=2;j++)\n\t\t{\n\t\t\tfor(int k=1;k<=m;k++)\n\t\t\t{\n\t\t\t\tf[1][k]=max(f[1][k-1],f[0][k]);\n\t\t\t\tif(b[k]==j)f[1][k]=max(f[1][k],f[0][k-1]+1);\n\t\t\t}\n\t\t\tint t=0;\n\t\t\tfor(int i=1;i<=m;i++)if(f[1][i]>f[1][i-1])t|=(1<<(i-1));\n\t\t\tsta[s][j]=t;\n\t\t}\n\t}\t\n}\nint main()\n{\n\tcin>>n>>m;\n\tcin>>(ch+1);\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tif(ch[i]=='N')b[i]=0;\n\t\tif(ch[i]=='O')b[i]=1;\n\t\tif(ch[i]=='I')b[i]=2;\n\t}\n\tinit();\n\tdp[0][0][0]=1;\n\t//dp(i,j,k)\u8868\u793a\u524di\u4e2a\u5b57\u7b26\u4e2d\uff0c\u72b6\u6001\u538b\u7f29\u540e\u7684lcs\u4e32\u8868\u793a\u4e3aj\uff0c\u4e0e\u201cNOI\u201d\u7684\u5339\u914d\u5230\u4e86\u7b2ck\u4f4d\u7684\u65b9\u6848\u6570\u3002 \n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tmemset(dp[now^1],0,sizeof(dp[now^1]));\n\t\tfor(int s=0;s<(1<<m);s++)\n\t\t{\n\t\t\tfor(int j=0;j<=2;j++)\n\t\t\t{\n\t\t\t\tfor(int k=0;k<=2;k++)\n\t\t\t\t{\n\t\t\t\t\tif(j==2&&k==2)continue;\n\t\t\t\t\tint ff=nxt[j][k];\n\t\t\t\t\tdp[now^1][sta[s][k]][ff]+=dp[now][s][j];\n\t\t\t\t\tdp[now^1][sta[s][k]][ff]%=mod;\n\t\t\t\t}\n\t\t\t} \n\t\t}\n\t\tnow^=1;\n\t}\n\tfor(int s=0;s<(1<<m);s++)\n\t{\n\t\tfor(int j=0;j<=2;j++)\n\t\t{\n\t\t\tint ff=0,ll=s;\n\t\t\twhile(ll){if(ll%2==1)ff++;ll/=2;}\n\t\t\tans[ff]+=dp[now][s][j];\n\t\t\tans[ff]%=mod;\n\t\t}\n\t}\n\tfor(int i=0;i<=m;i++)cout<<ans[i]<<endl;\n\treturn 0; \n}\n```",
        "postTime": 1582392558,
        "uid": 179600,
        "name": "shao0320",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P4590 \u3010[TJOI2018]\u6e38\u56ed\u4f1a\u3011"
    },
    {
        "content": "\u53d1\u73b0\u9898\u76ee\u4e2d\u90a3\u4e2a LCS \u7684\u9650\u5236\u4e0d\u597d\u5904\u7406\uff0c\u8003\u8651\u5efa\u4e00\u4e2a\u81ea\u52a8\u673a\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\n\n\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u5efa\u51fa\u4e86\u81ea\u52a8\u673a\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8bbe $f_{i,j,k}$ \u4e3a\u524d $i$ \u4e2a\u5b57\u7b26\uff0c\u5df2\u7ecf\u8f6c\u79fb\u5230\u81ea\u52a8\u673a\u7684 $j$ \u8282\u70b9\uff0c\u5df2\u7ecf\u5339\u914d\u5230\u4e86 `NOI` \u7684\u7b2c $k$ \u4f4d\u7684\u65b9\u6848\u6570\uff0c\u7136\u540e\u6839\u636e $k$ \u8f6c\u79fb\u5373\u53ef\u3002\n\n\u73b0\u5728\u8003\u8651\u5982\u4f55\u5efa\u8fd9\u4e2a\u81ea\u52a8\u673a\u3002\u8003\u8651\u6c42\u4e24\u4e2a\u4e32\u7684 LCS \u7684\u8fc7\u7a0b\uff0c\u5373\u8bbe $g_{i,j}$ \u8868\u793a\u7b2c\u4e00\u4e2a\u4e32\u5339\u914d\u5230 $i$\u3001\u7b2c\u4e8c\u4e2a\u4e32\u5339\u914d\u5230 $j$ \u7684 LCS \u7684\u957f\u5ea6\u3002\u73b0\u5728\u4e00\u4e2a\u4e32\u5df2\u77e5\uff0c\u6240\u4ee5\u5728\u81ea\u52a8\u673a\u4e0a\u8f6c\u79fb\u4e00\u6b21\u53ea\u9700\u8981\u77e5\u9053 $g_{i-1,x}$ \u548c\u65b0\u52a0\u5165\u7684\u5b57\u7b26\u3002\u4e8e\u662f\u6211\u4eec\u60f3\u5230\u5c06\u6bcf\u79cd $g_{i,x}$ \u4f5c\u4e3a\u72b6\u6001\u3002\u6ce8\u610f\u5230 $g_{i,x}$ \u4e0d\u964d\u4e14\u4e00\u6b21\u6700\u591a\u589e\u52a0 $1$\uff0c\u6240\u4ee5\u53ef\u4ee5\u72b6\u538b\u5176\u5dee\u5206\u6570\u7ec4\u4f5c\u4e3a\u72b6\u6001\u3002\n\n\u53ef\u4ee5\u4e0d\u5148\u5904\u7406\u51fa\u81ea\u52a8\u673a\uff0c\u800c\u662f\u5728\u8f6c\u79fb $f$ \u65f6\u8fd8\u539f\u51fa $g$ \u7684\u503c\u7136\u540e\u8f6c\u79fb $g$ \u5f97\u5230\u65b0\u7684\u8282\u70b9\u3002\uff08\u6240\u4ee5\u53eb\u505a DP \u5957 DP\uff1f\uff09\n\n```cpp\n// ====================================\n//   author: M_sea\n//   website: https://m-sea-blog.com/\n// ====================================\n#include <bits/stdc++.h>\n#define file(x) freopen(#x\".in\",\"r\",stdin); freopen(#x\".out\",\"w\",stdout)\n#define popcount(S) __builtin_popcount(S)\nusing namespace std;\ntypedef long long ll;\n\nint read() {\n\tint X=0,w=1; char c=getchar();\n\twhile (c<'0'||c>'9') { if (c=='-') w=-1; c=getchar(); }\n\twhile (c>='0'&&c<='9') X=X*10+c-'0',c=getchar();\n\treturn X*w;\n}\n\nconst int N=1000+10;\nconst int mod=1e9+7;\n\nint n,k,tot,ans[N]; char s[N];\nint f[2][1<<15][3],g[2][N];\n\nvoid decode(int S) {\n\tfor (int i=1;i<=k;++i) g[0][i]=(S>>(i-1))&1;\n\tfor (int i=1;i<=k;++i) g[0][i]+=g[0][i-1];\n}\nint encode() {\n\tint S=0;\n\tfor (int i=1;i<=k;++i)\n\t\tif (g[1][i]-g[1][i-1]) S|=1<<(i-1);\n\treturn S;\n}\n\nvoid trans(int nxt,int S,int l,char c,int w) {\n\tdecode(S);\n\tfor (int i=1;i<=k;++i) {\n\t\tg[1][i]=max(g[1][i-1],g[0][i]);\n\t\tif (c==s[i]) g[1][i]=max(g[1][i],g[0][i-1]+1);\n\t}\n\tint j=encode();\n\tf[nxt][j][l]=(f[nxt][j][l]+w)%mod;\n}\n\nint main() {\n\tn=read(),k=read(),tot=1<<k; scanf(\"%s\",s+1);\n\tf[0][0][0]=1;\n\tfor (int i=0;i<n;++i) {\n\t\tint now=i&1,nxt=now^1;\n\t\tmemset(f[nxt],0,sizeof(f[nxt]));\n\t\tfor (int j=0;j<tot;++j) {\n\t\t\tif (f[now][j][0]) {\n\t\t\t\ttrans(nxt,j,1,'N',f[now][j][0]);\n\t\t\t\ttrans(nxt,j,0,'O',f[now][j][0]);\n\t\t\t\ttrans(nxt,j,0,'I',f[now][j][0]);\n\t\t\t}\n\t\t\tif (f[now][j][1]) {\n\t\t\t\ttrans(nxt,j,1,'N',f[now][j][1]);\n\t\t\t\ttrans(nxt,j,2,'O',f[now][j][1]);\n\t\t\t\ttrans(nxt,j,0,'I',f[now][j][1]);\n\t\t\t}\n\t\t\tif (f[now][j][2]) {\n\t\t\t\ttrans(nxt,j,1,'N',f[now][j][2]);\n\t\t\t\ttrans(nxt,j,0,'O',f[now][j][2]);\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i=0;i<tot;++i)\n\t\tfor (int j=0;j<3;++j)\n\t\t\tans[popcount(i)]=(ans[popcount(i)]+f[n&1][i][j])%mod;\n\tfor (int i=0;i<=k;++i) printf(\"%d\\n\",ans[i]);\n\treturn 0;\n}\n```",
        "postTime": 1562760978,
        "uid": 38370,
        "name": "M_sea",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4590 \u3010[TJOI2018]\u6e38\u56ed\u4f1a\u3011"
    },
    {
        "content": "## \u9898\u76ee\u5927\u610f\n\n\u4ee4 $f(i)$ \u4e3a\u6ee1\u8db3\u4e0b\u9762\u51e0\u6761\u9650\u5236\u7684\u5b57\u7b26\u4e32\u4e2a\u6570\uff1a\n\n* \u957f\u5ea6\u4e3a $n$\uff0c\u5b57\u7b26\u96c6\u4e3a $\\{\\mathtt{N,O,I}\\}$\u3002\n* \u4e0d\u5305\u542b\u5b50\u4e32 $\\mathtt{NOI}$\u3002\n* \u4e0e\u6a21\u5f0f\u4e32 $s$ \u7684\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217\uff08$\\rm lcs$\uff09\u957f\u5ea6\u4e3a $i$\u3002\n\n\u5bf9\u4e8e $i\\in [0,k]$\uff0c\u6c42\u51fa $f_i$ \u7684\u503c\uff0c\u5bf9 $10^9+7$ \u53d6\u6a21\u3002\n\n## \u9898\u89e3\n\n\u8003\u8651 DP\u3002\n\n\u5982\u679c\u6211\u4eec\u76f4\u63a5\u5b9a\u4e49 $f_{i,j,l}$ \u8868\u793a\u8003\u8651\u5230\u7b2c $i$ \u4f4d\uff0c\u4e0e $s$ \u7684 $\\rm lcs$ \u4e3a $j$\uff0c\u4e0e $\\mathtt{NOI}$ \u7684\u5339\u914d\u957f\u5ea6\u4e3a $l$ \u7684\u5b57\u7b26\u4e32\u4e2a\u6570\uff0c\u90a3\u4e48 $\\text{lcs}$ \u5728\u6bcf\u4e2a\u72b6\u6001\u7684\u503c\u662f\u672a\u77e5\u7684\uff0c\u65e0\u6cd5\u5b8c\u6210\u8f6c\u79fb\u3002\u6240\u4ee5\u6211\u4eec\u4e0d\u59a8\u8003\u8651\u5c06\u6574\u4e2a $\\rm lcs$ \u6570\u7ec4\u4f20\u5165\u72b6\u6001\u3002\n\n\u663e\u7136\u4f20\u5165\u6574\u4e2a\u6570\u7ec4\u662f\u4e0d\u73b0\u5b9e\u7684\uff0c\u6211\u4eec\u5c1d\u8bd5\u89c2\u5bdf $\\rm lcs$ \u7684\u8f6c\u79fb\u65b9\u6cd5\uff1a\n\n$$\\text{lcs}_{i,j}=\\max\\begin{cases}\\text{lcs}_{i-1,j-1}+1&t_i=s_j\\\\\\max(\\text{lcs}_{i,j-1},\\text{lcs}_{i-1,j})&t_i\\neq s_j\\end{cases}$$\n\n\u5176\u4e2d $\\text{lcs}_{i,j}$ \u8868\u793a\u5f53\u524d\u8003\u8651\u5230\u7b2c $i$ \u4f4d\uff0c\u4e0e $s$ \u4e32\u5339\u914d\u5230\u7b2c $j$ \u4f4d\u7684\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217\u957f\u5ea6\u3002\n\n\u4e3a\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u51e0\u6761\u4f18\u5316\uff1a\n\n* \u8f6c\u79fb\u4e2d\u53ea\u6d89\u53ca\u5230\u4e86\u7b2c $i-1$ \u884c\u548c\u7b2c $i$ \u884c\u7684\u72b6\u6001\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u5b58\u50a8\u4e00\u884c\u72b6\u6001\u5373\u53ef\u3002\n* \u6ce8\u610f\u5230 $\\text{lcs}_{i,j}-\\text{lcs}_{i,j-1}\\in\\{0,1\\}$\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u72b6\u538b\u5dee\u5206\u6570\u7ec4\u6765\u5b58\u50a8\u4e00\u884c\u7684\u4fe1\u606f\u3002\n\n\u8fd9\u6837\u6211\u4eec\u91cd\u65b0\u5b9a\u4e49\u72b6\u6001\uff1a$f_{i,state,l}$ \u8868\u793a\u8003\u8651\u5230\u7b2c $i$ \u4f4d\uff0c$\\text{lcs}$ \u6570\u7ec4\u72b6\u6001\u4e3a $state$\uff0c\u4e0e $\\mathtt{NOI}$ \u7684\u5339\u914d\u957f\u5ea6\u4e3a $l$ \u7684\u65b9\u6848\u6570\u3002\u4e4b\u540e\u6211\u4eec\u679a\u4e3e\u7b2c $i$ \u4f4d\u7684\u5b57\u7b26\uff0c\u8f6c\u79fb\u5c31\u5f88\u597d\u60f3\u4e86\u3002\n\n\u72b6\u6001\u6570 $O(n2^k)$\uff0c\u8f6c\u79fb $O(k)$\uff08\u56e0\u4e3a\u8981\u6c42\u51fa\u65b0\u7684 $state$\uff09\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(nk2^k)$\u3002\u4f7f\u7528\u4e00\u4e9b\u526a\u679d\u5c31\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\n\n## \u4ee3\u7801\n\n\u6709\u70b9\u96be\u770b\u2026\u2026\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define db double\n#define pb push_back\n#define mp make_pair\n#define pii pair<int, int>\nusing namespace std;\ninline int read() {\n\tint x = 0; bool op = 0;\n\tchar c = getchar();\n\twhile(!isdigit(c))op |= (c == '-'), c = getchar();\n\twhile(isdigit(c))x = (x << 1) + (x << 3) + (c ^ 48), c = getchar();\n\treturn op ? -x : x;\n}\nconst int N = 1010;\nconst int P = 1e9 + 7;\nint n, k;\nint f[2][1 << 15][3], cnt[1 << 15], m[300], g[2][20], ans[20];\nchar s[20];\nvoid decode(int S) {\n\tmemset(g[0], 0, sizeof(g[0]));\n\tfor(int i = 0; i < k; i++)g[0][i + 1] = (S >> i & 1);\n\tfor(int i = 1; i <= k; i++)g[0][i] += g[0][i - 1];\n\treturn ;\n}\nint encode() {\n\tint S = 0;\n\tfor(int i = 1; i <= k; i++) {\n\t\tint now = g[1][i] - g[1][i - 1];\n\t\tS ^= now * (1 << (i - 1));\n\t}\n\treturn S;\n}\nvoid trans(int cur, int S, int c, int p, int x) {\n\tif((p == 2 && c == 2) || x == 0)return ;//\u526a\u679d\uff1ax=0\u5219\u6ca1\u6709\u8d21\u732e\uff0c\u76f4\u63a5\u7ed3\u675f\u3002\n\tint nxt = (c == 0) ? 1 : 0;\n\tif(p == 0 && c == 0)nxt = 1;\n\telse if(p == 1 && c == 1)nxt = 2;\n\tdecode(S);\n\tmemset(g[1], 0, sizeof(g[1]));\n\tfor(int i = 1; i <= k; i++) {\n\t\tif(m[s[i]] == c) {\n\t\t\tg[1][i] = max(g[1][i], g[0][i - 1] + 1);\n\t\t}\n\t\tg[1][i] = max(g[1][i], max(g[0][i], g[1][i - 1]));\n\t}\n\tint ns = encode();\n\tf[cur][ns][nxt] = (f[cur][ns][nxt] + x) % P;\n\treturn ;\n}\nint main() {\n\tn = read(); k = read();\n\tscanf(\"%s\", s + 1);\n\tm['N'] = 0; m['O'] = 1; m['I'] = 2;\n\tint maxi = 1 << k, cur = 0;\n\tf[cur][0][0] = 1;\n\tfor(int i = 1; i <= n; i++) {\n\t\tcur = cur ^ 1;\n\t\tmemset(f[cur], 0, sizeof(f[cur]));\n\t\tfor(int j = 0; j < maxi; j++) {\n\t\t\tfor(int p = 0; p < 3; p++) {\n\t\t\t\ttrans(cur, j, p, 0, f[cur ^ 1][j][0]);\n\t\t\t\ttrans(cur, j, p, 1, f[cur ^ 1][j][1]);\n\t\t\t\ttrans(cur, j, p, 2, f[cur ^ 1][j][2]);\n\t\t\t}\n\t\t}\t\n\t}\n\tcnt[0] = 0;\n\tfor(int i = 1; i < maxi; i++)cnt[i] = cnt[i >> 1] + (i & 1);\n\tfor(int i = 0; i < maxi; i++) {\n\t\tfor(int p = 0; p < 3; p++) {\n\t\t\tans[cnt[i]] = (ans[cnt[i]] + f[cur][i][p]) % P;\n\t\t}\n\t}\n\tfor(int i = 0; i <= k; i++)printf(\"%d\\n\", ans[i]);\n\treturn 0;\n}\n```\n\n\u8fd9\u79cd\u5728 DP \u72b6\u6001\u4e2d\u5b58\u50a8\u53e6\u4e00\u4e2a DP \u6570\u7ec4\u7684\u6280\u672f\u4f3c\u4e4e\u88ab\u79f0\u4e3a\u201cDP \u5957 DP\u201d\uff0c\u4f46\u5b9e\u8d28\u4e0a\u53ea\u662f\u628a\u72b6\u6001\u9001\u4e0a\u4e86\u4e00\u4e2a\u8f6c\u79fb\u8f83\u4e3a\u590d\u6742\u7684\u81ea\u52a8\u673a\u800c\u5df2\uff0c\u672c\u8d28\u4e0a\u662f\u76f8\u540c\u7684\u3002",
        "postTime": 1628570609,
        "uid": 149192,
        "name": "__gcd",
        "ccfLevel": 0,
        "title": "\u9898\u89e3\u3010P4590 [TJOI2018]\u6e38\u56ed\u4f1a\u3011"
    },
    {
        "content": "dp\u5957dp\u662f\u4e00\u79cd\u6bd4\u8f83\u51b7\u95e8\u7684\u5c0f\u6280\u5de7\uff0c\u53ef\u4ee5\u7528\u6765\u89e3\u51b3\u4e00\u4e9b\u5b57\u7b26\u4e32\u95ee\u9898\u3002\n\n\u5176\u57fa\u672c\u601d\u60f3\u5728\u4e8e\u5c06dp\u7684\u8fc7\u7a0b\u89c6\u4f5c\u81ea\u52a8\u673a\uff0c\u5c06dp\u7684\u72b6\u6001\u89c6\u4f5c\u8282\u70b9\uff0c\u5e76\u5728\u6b64\u4e4b\u4e0a\u8dd1\u81ea\u52a8\u673adp\uff0c\u4ece\u800c\u89e3\u51b3\u590d\u6742\u7684\u95ee\u9898\u3002\n\n\u4f8b\u9898\uff1aP4590 [TJOI2018]\u6e38\u56ed\u4f1a\n\n\u7b80\u8981\u9898\u610f\uff1a\u7ed9\u51fa $n,k$ \u4ee5\u53ca\u4e00\u4e2a\u957f\u5ea6\u4e3a $k$ \u7684\u5b57\u7b26\u4e32\uff0c\u6c42\u957f\u5ea6\u4e3a $n$\uff0c \u800c\u4e14\u4e0e\u7ed9\u5b9a\u5b57\u7b26\u4e32\u6700\u957f\u5b50\u5e8f\u5217\u957f\u5ea6\u4e3a $0$ \u5230 $k$ \u7684\u5b57\u7b26\u4e32\u6570\u91cf\u3002\u5b57\u7b26\u4e32\u5185\u4e0d\u5f97\u5305\u542b\"NOI\"\u4f5c\u4e3a\u5b50\u4e32\u3002\n\n\u6ce8\u610f\u5230\u9898\u76ee\u8981\u6c42\u5341\u5206\u5272\u88c2\uff0c\u6211\u4eec\u8003\u8651\u5148\u89e3\u51b3\u540e\u4e00\u534a\uff0c\u5373\u5173\u4e8e\"NOI\"\u7684\u90e8\u5206\u3002\u6211\u4eec\u53ef\u4ee5\u63d0\u51fa\u57fa\u672c\u65b9\u6848\uff1a$dp_{i,j}$ \u8868\u793a\u957f\u5ea6\u4e3a $i$\uff0c\"NOI\"\u5b8c\u6210\u8fdb\u5ea6\u4e3a $j$ \u7684\u65b9\u6848\u6570\u3002 \u6b64\u65f6\u6211\u4eec\u9700\u8981\u53bb\u5904\u7406\u7684\u95ee\u9898\u662f\u5728\u57fa\u672c\u65b9\u6848\u4e0b\u52a0\u7ef4\u6765\u7ef4\u62a4\u6700\u957f\u5b50\u5e8f\u5217\u4fe1\u606f\u3002\n\n\u5f53\u6211\u4eec\u5728\u5b57\u7b26\u4e32\u4e0a\u5904\u7406\u7c7b\u4f3c\u95ee\u9898\u65f6\uff0c\u6211\u4eec\u901a\u5e38\u90fd\u4f1a\u501f\u52a9\u81ea\u52a8\u673a\uff0c\u4f46\u5e76\u6ca1\u6709\u80fd\u591f\u7ef4\u62a4\u8fd9\u7c7b\u4fe1\u606f\u7684\u201c\u5b50\u5e8f\u5217\u81ea\u52a8\u673a\u201d\u3002\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u7684\u7ed3\u6784\uff1adp\u3002 \u6211\u4eec\u4ee4 $f_{i,j}$ \u8868\u793a\u539f\u4e32\u524d $i$ \u4e2a\u5b57\u7b26\u548c\u7ed9\u5b9a\u4e32\u524d $j$ \u4e2a\u5b57\u7b26\u7684\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217\uff0c\u8f6c\u79fb\u5f0f\u663e\u7136\u3002\u8be5\u5f0f\u67d0\u4e00\u884c\u53ea\u53d6\u51b3\u4e8e\u5f53\u524d\u8f6c\u79fb\u7684\u5b57\u7b26\u4ee5\u53ca\u4e0a\u4e00\u884c\u7684\u6570\u636e\uff0c\u800c\u7b2c\u4e8c\u7ef4\u957f\u5ea6\u4e0d\u5927\uff0c\u8003\u8651\u4ee5\u7b2c\u4e8c\u4f4d\u7ec4\u6210\u7684\u6570\u7ec4\u4e3a\u8282\u70b9\uff0c\u5efa\u7acb\u81ea\u52a8\u673a\u3002\u4f46\u662f\u6211\u4eec\u663e\u7136\u4e0d\u80fd\u627f\u53d7\u679a\u4e3e\u6240\u6709\u6570\u7ec4\u7684\u8d1f\u62c5\uff0c\u8003\u8651\u538b\u7f29\u3002\u6ce8\u610f\u5230\u7b2c\u4e8c\u4f4d\u8fde\u7eed\u4e24\u70b9\u4e4b\u95f4\u5fc5\u7136\u76f8\u5dee0\u62161\uff0c\u6545\u5c06\u539f\u6570\u7ec4\u5dee\u5206\u540e\u5c06\u662f\u4e00\u4e2a01\u4e32\uff0c\u72b6\u538bdp\u5373\u53ef\u3002\n```cpp\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\n#include <queue>\n#include <vector>\n#include <map>\n#include <cmath>\n#include <cassert>\nusing namespace std; \n\nconst int md=1e9+7;\nvoid read(int &x){\n\tx=0;\n\tint f=1;\n\tchar c=getchar();\n\twhile(!('0'<=c && c<='9')){\n\t\tif(c=='-'){\n\t\t\tf=-1;\n\t\t}\n\t\tc=getchar();\n\t}\n\twhile('0'<=c && c<='9'){\n\t\tx=(x<<3)+(x<<1)+(c^48);\n\t\tc=getchar();\n\t}\n\tx*=f;\n} \nint n,k,dp[2][40010][3]={0},res[20]={0};\nchar s[20];\nint getnxt(int stat,char cur){\n\tint num=0,sum=0,prv=0,c=0;\n\tfor(int i=0;i<15;i++){\n\t\tsum+=(((c=max(num+(cur==s[i]),max(prv,num+((stat>>i)&1))))-prv)<<i);\n\t\tnum+=(stat>>i)&1;\n\t\tprv=c;\n\t}\n\treturn sum;\n}\nint count(int k){\n\tint res=0;\n\tfor(int i=0;i<15;i++){\n\t\tres+=(k>>i)&1;\n\t}\n\treturn res;\n}\nsigned main(){\n\tread(n);\n\tread(k);\n\tscanf(\" %s\",s);\n\tdp[0][0][0]=1;\n\tfor(int i=0;i<n;i++){\n\t\tmemset(dp[(i&1)^1],0,sizeof(dp[(i&1)^1]));\n\t\tfor(int j=0;j<(1<<k);j++){\n\t\t\t//printf(\"[%lld %lld %lld] \",dp[i&1][j][0],dp[i&1][j][1],dp[i&1][j][2]);\n\t\t\tint nxt=getnxt(j,'N');\n\t\t\t(dp[(i&1)^1][nxt][1]+=dp[i&1][j][0])%=md;\n\t\t\t(dp[(i&1)^1][nxt][1]+=dp[i&1][j][1])%=md;\n\t\t\t(dp[(i&1)^1][nxt][1]+=dp[i&1][j][2])%=md;\n\t\t\tnxt=getnxt(j,'O');\n\t\t\t(dp[(i&1)^1][nxt][0]+=dp[i&1][j][0])%=md;\n\t\t\t(dp[(i&1)^1][nxt][2]+=dp[i&1][j][1])%=md;\n\t\t\t(dp[(i&1)^1][nxt][0]+=dp[i&1][j][2])%=md;\n\t\t\tnxt=getnxt(j,'I');\n\t\t\t(dp[(i&1)^1][nxt][0]+=dp[i&1][j][0])%=md;\n\t\t\t(dp[(i&1)^1][nxt][0]+=dp[i&1][j][1])%=md;\n\t\t}\n\t\t//putchar('\\n');\n\t}\n\tfor(int j=0;j<(1<<k);j++){\n\t\tfor(int l=0;l<=2;l++){\n\t\t\t(res[count(j)]+=dp[n&1][j][l])%=md;\n\t\t}\n\t}\n\tfor(int i=0;i<=k;i++){\n\t\tprintf(\"%lld\\n\",res[i]);\n\t}\n\treturn 0;\n}\n\n```\n",
        "postTime": 1671804439,
        "uid": 367387,
        "name": "cainiaoshanglu",
        "ccfLevel": 7,
        "title": "dp\u5957dp\u6742\u8bb0 & P4590\u9898\u89e3"
    },
    {
        "content": "### [\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4590)\r\n\r\n### \u9898\u610f\r\n\r\n\u7ed9\u51fa\u4e00\u4e2a\u957f\u5ea6\u4e3a $m$ \u7684\u5b57\u7b26\u4e32 $s$\uff0c\u6784\u9020\u51fa\u957f\u5ea6\u4e3a $n$ \u7684\u5b57\u7b26\u4e32 $t$\uff0c\u5176\u4e2d $t$ \u4e0d\u542b\u5b50\u4e32 $\\text{NOI}$\uff0c\u5206\u522b\u6c42\u51fa $s$ \u548c $t$ \u7684\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217\u957f\u5ea6\u4e3a $0$ ~ $m$ \u7684 $t$ \u7684\u4e2a\u6570\u5bf9 $10^9+7$ \u53d6\u6a21\u7684\u7ed3\u679c\u3002\r\n\r\n### \u5206\u6790\r\n\r\n\u9996\u5148\uff0c\u8ba9\u6211\u4eec\u56de\u5fc6\u4e00\u4e0b\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217\u7684\u8f6c\u79fb\u65b9\u7a0b\uff1a\r\n\r\n$dp_{i,j} \\leftarrow \\begin{cases}dp_{i-1,j-1}+1 & s_i=t_j\\\\\r\n\\max(dp_{i-1,j},dp_{i,j-1}) & s_i \\ne t_j\\\\\\end{cases}$\r\n\r\n\u6211\u4eec\u9700\u8981\u8bb0\u5f55\u4e4b\u524d\u7684\u72b6\u6001\uff1a\r\n\r\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u5bf9\u4e8e $dp_{i,j}$\uff0c\u968f\u7740 $j$ \u7684\u4e0d\u65ad\u589e\u5927\uff0c$dp_{i,j}$ \u4e00\u5b9a\u662f\u5355\u8c03\u4e0d\u51cf\u7684\uff0c\u4e14\u76f8\u90bb\u4e24\u4e2a\u6700\u591a\u76f8\u5dee 1\u3002\r\n\r\n\u6240\u4ee5\uff0c\u5176\u5dee\u5206\u6570\u7ec4\u4e00\u5b9a\u662f\u4e00\u4e32\u53ea\u542b 0 \u548c 1 \u7684\u6570\u5b57\u3002\r\n\r\n\u7136\u540e\u5c31\u53ef\u4ee5\u8fdb\u884c\u72b6\u6001\u538b\u7f29 DP \u4e86\u3002\r\n\r\n\u6211\u4eec\u5b9a\u4e49\uff1a$dp_{i,j}$ \u4e3a\u524d $i$ \u4e2a\u5b57\u7b26\u4e2d\uff0c\u76ee\u524d\u7684\u72b6\u6001\u4e3a $j$ \u7684\u60c5\u51b5\u4e2a\u6570\u3002\r\n\r\n\u6211\u4eec\u5c06 $j$ \u62c6\u6210 0 \u548c 1\uff0c\u91cd\u65b0\u7d2f\u4e00\u904d\u524d\u7f00\u548c\uff0c\u8fd8\u539f\u51fa\u72b6\u6001\uff0c\u7136\u540e\u63d2\u5165\u4e00\u4e2a\u5b57\u7b26 $num$\uff0c\u6839\u636e\u4ee5\u4e0a\u7684\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5f97\u5230\u65b0\u7684\u72b6\u6001\uff0c\u91cd\u65b0\u6c42\u4e00\u904d\u5dee\u5206\uff0c\u5f97\u5230\u65b0\u7684\u72b6\u6001\uff0c\u8bb0\u5f55\u72b6\u6001\u4e4b\u95f4\u7684\u8f6c\u79fb\uff0c\u8bb0\u4e3a $nxt_{j,num}$\u3002\r\n\r\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a$dp_{i,j} \\leftarrow \\sum_{j=0}^{2^m} dp_{i-1,nxt_{j,num}}$\uff0c\u5176\u4e2d $num$ \u53d6\u4e09\u4e2a\u5b57\u7b26\u3002\r\n\r\n\u4f46\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u8fd8\u662f\u4e0d\u591f\u7684\uff0c\u56e0\u4e3a\u9898\u76ee\u8fd8\u6709\u4e00\u4e2a\u6761\u4ef6\uff1a\u4e0d\u80fd\u51fa\u73b0\u8fde\u7eed\u7684 $\\text{NOI}$\u3002\r\n\r\n\u6211\u4eec\u4fee\u6539\u72b6\u6001\u4e3a $dp_{i,j,k}$ \u5176\u4e2d $k \\subseteq \\{0,1,2\\}$\u3002$i$ \u548c $j$ \u7684\u610f\u4e49\u540c\u4e0a\u6240\u8ff0\uff0c$k$ \u63cf\u8ff0\u7ed3\u5c3e\u3002\r\n\r\n+ \u5f53 $k=1$ \u65f6\uff0c\u9009\u62e9\u5b57\u7b26\u4e32\u4ee5 $\\text{N}$ \u4e3a\u7ed3\u5c3e\u3002\r\n\r\n+ \u5f53 $k=2$ \u65f6\uff0c\u9009\u62e9\u5b57\u7b26\u4e32\u4ee5 $\\text{NO}$ \u4e3a\u7ed3\u5c3e\u3002\r\n\r\n+ \u5f53 $k=0$ \u65f6\uff0c\u9009\u62e9\u5b57\u7b26\u4e32\u4e3a\u9664\u4e86\u4ee5\u4e0a\u4e24\u79cd\u548c $\\text{NOI}$ \u4ee5\u5916\u7684\u5176\u5b83\u5408\u6cd5\u7ed3\u5c3e\u3002\r\n\r\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u8fc7\u4e8e\u590d\u6742\uff0c\u603b\u5171 8 \u6761\uff0c\u76f4\u63a5\u653e\u4ee3\u7801\u548c\u6ce8\u91ca\uff1a\r\n\r\n```cpp\r\nadd(dp[i&1][nxt[j][0]][1],dp[i-1&1][j][0]);//\u5176\u5b83 + N = N\r\nadd(dp[i&1][nxt[j][0]][1],dp[i-1&1][j][1]);//N + N = N\r\nadd(dp[i&1][nxt[j][0]][1],dp[i-1&1][j][2]);//NO + N = N\r\nadd(dp[i&1][nxt[j][1]][0],dp[i-1&1][j][0]);//\u5176\u5b83 + O = \u5176\u5b83\r\nadd(dp[i&1][nxt[j][1]][2],dp[i-1&1][j][1]);//N + O = NO\r\nadd(dp[i&1][nxt[j][1]][0],dp[i-1&1][j][2]);//NO + O = \u5176\u5b83\r\nadd(dp[i&1][nxt[j][2]][0],dp[i-1&1][j][0]);//\u5176\u5b83 + I = \u5176\u5b83\r\nadd(dp[i&1][nxt[j][2]][0],dp[i-1&1][j][1]);//N + I = \u5176\u5b83 \r\n//NO + I = NOI \u4e0d\u5408\u6cd5 \r\n```\r\n\u6ce8\u610f\u4ee5 $\\text{NO}$ \u4e3a\u7ed3\u5c3e\u7684\u5b57\u7b26\u4e32\u540e\u63a5 $\\text{I}$ \u7ec4\u6210\u4e86 $\\text{NOI}$\uff0c\u4e0d\u5408\u6cd5\u3002\r\n\r\n\u6ce8\u610f\u5982\u679c\u76f4\u63a5\u5f00 DP \u6570\u7ec4\uff0c\u7a7a\u95f4\u4f1a\u7206\uff0c\u6240\u4ee5\u5e94\u5f53\u4f7f\u7528\u6eda\u52a8\u6570\u7ec4\u4f18\u5316\u7a7a\u95f4\u3002\r\n\r\n### AC \u4ee3\u7801\r\n\r\n```cpp\r\n#include <bits/stdc++.h>\r\nusing namespace std;\r\n#define F(i,a,b) for(register int i=a;i<=b;++i)\r\nconst int mod = 1e9 + 7;\r\ninline void add(int &x,int y) {(x += y) >= mod&&(x -= mod);}\r\nint to[128],ans[20];\r\nint nxt[32768][3],a[20],p[20],q[20],n,m;\r\nint dp[2][32768][3]; \r\n//0 \u5b57\u6bcd'N'  \u5176\u4f59\u975e\"NOI\"\u672b\u5c3e\r\n//1  \u5b57\u6bcd'O' \u672b\u5c3e\u4e3a\"N\"\r\n//2 \u5b57\u6bcd'I' \u672b\u5c3e\u4e3a\"NO\" \r\nint main()\r\n{\r\n\tto['N'] = 0,to['O'] = 1,to['I'] = 2;\r\n\tscanf(\"%d%d\",&n,&m);\r\n\tgetchar();//\u6ce8\u610f\u8981\u8bfb\u6389'\\n' \r\n\tF(i,1,m) a[i] = to[getchar()];\r\n\tF(i,0,(1<<m)-1)\r\n\t{\r\n\t\tF(j,0,m-1)\r\n\t\t{\r\n\t\t\tif(i & (1<<j)) p[j+1] = p[j] + 1;\r\n\t\t\telse p[j+1] = p[j];\t\r\n\t\t}\t\r\n\t\tF(num,0,2)\r\n\t\t{\r\n\t\t\tF(j,1,m)\r\n\t\t\t{\r\n\t\t\t\tif(a[j] == num) q[j] = p[j-1]+1;\t\r\n\t\t\t\telse q[j] = max(q[j-1],p[j]);\t\r\n\t\t\t}\r\n\t\t\tint t = 0;\r\n\t\t\tF(j,0,m-1) \r\n\t\t\t\tif(q[j+1] > q[j])\r\n\t\t\t\t\tt |= 1<<j;\r\n\t\t\tnxt[i][num] = t;\r\n\t\t}\r\n\t}\r\n\tdp[0][0][0] = 1;\r\n\tF(i,1,n)\r\n\t{\r\n\t\tmemset(dp[i&1],0,sizeof(dp[i&1]));\r\n\t\tF(j,0,(1<<m)-1)\r\n\t\t{\r\n\t\t\tadd(dp[i&1][nxt[j][0]][1],dp[i-1&1][j][0]);//\u5176\u5b83 + N = N\r\n\t\t\tadd(dp[i&1][nxt[j][0]][1],dp[i-1&1][j][1]);//N + N = N\r\n\t\t\tadd(dp[i&1][nxt[j][0]][1],dp[i-1&1][j][2]);//NO + N = N\r\n\t\t\tadd(dp[i&1][nxt[j][1]][0],dp[i-1&1][j][0]);//\u5176\u5b83 + O = \u5176\u5b83 \r\n\t\t\tadd(dp[i&1][nxt[j][1]][2],dp[i-1&1][j][1]);//N + O = NO\r\n\t\t\tadd(dp[i&1][nxt[j][1]][0],dp[i-1&1][j][2]);//NO + O = \u5176\u5b83\r\n\t\t\tadd(dp[i&1][nxt[j][2]][0],dp[i-1&1][j][0]);//\u5176\u5b83 + I = \u5176\u5b83\r\n\t\t\tadd(dp[i&1][nxt[j][2]][0],dp[i-1&1][j][1]);//N + I = \u5176\u5b83 \r\n\t\t\t//NO + I = NOI \u4e0d\u5408\u6cd5 \r\n\t\t}\r\n\t}\t\r\n\tF(i,0,(1<<m)-1)\r\n\t{\r\n\t\tint cnt = 0;\r\n\t\tF(j,0,m-1)\r\n\t\t\tif(i & (1<<j))\r\n\t\t\t\t++cnt;\r\n\t\tadd(ans[cnt],dp[n&1][i][0]);\r\n\t\tadd(ans[cnt],dp[n&1][i][1]);\r\n\t\tadd(ans[cnt],dp[n&1][i][2]);\r\n\t}\r\n\tF(i,0,m) printf(\"%d\\n\",ans[i]);\r\n    return 0;\r\n}\r\n```\r\n### \u62d3\u5c55\r\n\r\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u9898\u5176\u5b9e\u8981\u5b9e\u73b0\uff0c**\u5bf9\u4fe1\u53f7\u5e8f\u5217\u8fdb\u884c\u5224\u65ad\u7684\u6570\u5b66\u6a21\u578b**\uff0c\u5373\u81ea\u52a8\u673a\u3002\r\n\r\n\u63a8\u8350\u9605\u8bfb\uff1a[\u81ea\u52a8\u673a\u4ecb\u7ecd](https://oi-wiki.org/string/automaton/#%E5%BD%A2%E5%BC%8F%E5%8C%96%E5%AE%9A%E4%B9%89)\u3002",
        "postTime": 1673261729,
        "uid": 197648,
        "name": "Wangxun",
        "ccfLevel": 5,
        "title": "P4590 \u9898\u89e3"
    },
    {
        "content": "~~\u9898\u89e3\u529d\u9000\u7cfb\u5217~~\n\n(\u53c2\u8003\u4e86elijahqi\u5de8\u4f6c\u7684\u9898\u89e3\uff09\n\n\u8bbe\u957f\u7684\u90a3\u4e2a\u4e32\u662f\uff21\uff0c\u77ed\u7684\u90a3\u4e2a\u4e32\u662f\uff22\u3002\n\n\u90a3\u6211\u4eec\u5728\u5982\u679c\u5df2\u7ecf\u77e5\u9053\u67d0\u4e2a\uff21\u7684\u65f6\u5019\uff0c\uff21[1..i]\u548c\uff22[1..j]\u7684\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217$f[i][j]=max\\{f[i-1][j],f[i][j-1],f[i-1][j-1]+(A[i]==B[i])\\}$\n\n\u4e8e\u662f\u53ef\u4ee5\u9012\u63a8\u6765\u679a\u4e3eA\uff0c\u987a\u624b\u628aNOI\u7684\u60c5\u51b5\u5224\u6389\u3002\u4f46\u8fd9\u590d\u6742\u5ea6\u663e\u7136\u8fc7\u4e0d\u4e86\u3002\n\n\u6ce8\u610f\u5230\u5728\u63a8\u7684\u65f6\u5019\uff0c\u6bcf\u65b0\u52a0\u4e00\u4e2a\u5b57\u7b26\uff0c\u5c31\u53ef\u4ee5\u7531f[i-1]\u63a8\u51faf[i]\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u6839\u672c\u4e0d\u7528\u8bb0\u9012\u63a8\u51fa\u6765\u7684\u8fd9\u4e2aA\u5177\u4f53\u662f\u4ec0\u4e48\uff0c\u53ea\u8981\u8bb0\u4f4f\u8fd9\u4e2af[i]\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u600e\u4e48\u8bb0\u5462\uff1f\u6ce8\u610f\u5230f[i][j]\u53ea\u80fd\u7b49\u4e8ef[i][j-1]\u6216\u8005f[i][j-1]+1\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u5dee\u5206\u8fd9\u4e2af[i]\uff0c\u7136\u540e\u72b6\u538b\u5c31\u80fd\u8bb0\u4e0b\u6765\u4e86\u3002\n\n\u8bbetrans[s][k]\u8868\u793a\u539f\u672cf\u6570\u7ec4\u72b6\u6001\u662fs\u3001\u65b0\u52a0\u4e86\u4e00\u4e2ak\u5b57\u7b26\uff0c\u8f6c\u79fb\u5230\u7684\u72b6\u6001\n\n\u90a3\u4e48\u53ef\u4ee5\u5f97\u5230\u9012\u63a8\u5f0f$g[i+1][trans[s][k]]=\\sum{g[i][s]}$,g[N][s]\u5c31\u662f\u6700\u540e\u72b6\u6001s\u7684\u60c5\u51b5\u6570\uff0c\u53ea\u8981\u7edf\u8ba1\u4e00\u4e0bs\u4e2d1\u7684\u4e2a\u6570\uff0c\u8bb0\u5230\u7b54\u6848\u91cc\u5c31\u884c\u4e86\u3002\n\n\u7136\u800c\u8fd8\u8981\u5224NOI\n\n\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u53ea\u8981\u7ed9g\u591a\u8bb0\u4e00\u7ef4\uff0c\u7528\u6765\u8868\u793a\u73b0\u5728\u8fd9\u4e2a\u72b6\u6001\u5df2\u7ecf\u5339\u914d\u5230\u4e86NOI\u7684\u51e0\u4f4d\u5c31\u53ef\u4ee5\u4e86\n\n\uff080,1,2\u901a\u8fc7\"N\"\u8f6c\u79fb\u52301;1\u901a\u8fc7\u201cO\u201d\u8f6c\u79fb\u52302;2\u901a\u8fc7\u201cI\u201d\u8f6c\u79fb\u52303\uff08\u8fd9\u4e2a\u60c5\u51b5\u4e0d\u5408\u6cd5\uff09\uff09\n\n\u8981\u5f00\u6eda\u52a8\u6570\u7ec4\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<map>\n#include<cmath>\n#include<ctime>\n#include<set>\n#define pa pair<int,int>\n#define lowb(x) ((x)&(-(x)))\n#define REP(i,n0,n) for(i=n0;i<=n;i++)\n#define PER(i,n0,n) for(i=n;i>=n0;i--)\n#define MAX(a,b) ((a>b)?a:b)\n#define MIN(a,b) ((a<b)?a:b)\n#define CLR(a,x) memset(a,x,sizeof(a))\n#define rei register int\nusing namespace std;\nconst int maxn=1010,maxk=16,maxs=32768,p=1e9+7;\ntypedef long long ll;\n\nll rd(){\n\tll x=0;char c=getchar();int neg=1;\n\twhile(c<'0'||c>'9'){if(c=='-') neg=-1;c=getchar();}\n\twhile(c>='0'&&c<='9') x=x*10+c-'0',c=getchar();\n\treturn x*neg;\n}\n\nint N,K,M;\nint wd[maxk],ans[maxk],ne[3][3];\nint f[2][maxs][3],trans[maxs][3],cnt[maxs];\n\ninline void modadd(int &x,int y){x=(x+y)%p;}\n\nint main(){\n\t//freopen(\".in\",\"r\",stdin);\n\trei i,j,k,l;\n\tN=rd(),K=rd();M=1<<K;\n\ti=0;while(i<K){\n\t\tchar c=getchar();\n\t\tif(c=='N') wd[++i]=0;\n\t\telse if(c=='O') wd[++i]=1;\n\t\telse if(c=='I') wd[++i]=2;\n\t}\n\tREP(i,0,M-1){\n\t\tREP(j,0,2){\n\t\t\tint s=0,sum=0,lst=0,now=0;\n\t\t\tREP(k,1,K){\n\t\t\t\tif(wd[k]==j) now=sum+1;\n\t\t\t\tif(i&(1<<(k-1))) sum++;\n\t\t\t\tif(wd[k]!=j) now=sum;\n\t\t\t\ts+=(now>lst)<<(k-1);lst=MAX(lst,now);\n\t\t\t}trans[i][j]=s;cnt[i]=sum;\n\t\t//printf(\"%d %d %d %d\\n\",i,j,s,sum);\n\t\t}\n\t}\n\tne[1][1]=2;ne[0][0]=ne[1][0]=ne[2][0]=1;\n\tbool b=0;f[0][0][0]=1;\n\tREP(i,0,N-1){\n\t\t//memcpy(f[b],f[b^1],sizeof(f[b]));\n\t\tCLR(f[b^1],0);\n\t\tREP(j,0,M-1){\n\t\t\tREP(l,0,2){if(!f[b][j][l]) continue;\n\t\t\t\tREP(k,0,2){\n\t\t\t\t\tif(l==2&&k==2) continue;\n\t\t\t\t\tmodadd(f[b^1][trans[j][k]][ne[l][k]],f[b][j][l]);\n\t\t\t\t\t//printf(\"f[%d][%d][%d]=%d -%d> \",i,j,l,f[b][j][l],k);\n\t\t\t\t//\tprintf(\"f[%d][%d][%d]=%d\\n\",i+1,trans[j][k],ne[l][k],f[b^1][trans[j][k]][ne[l][k]]);\n\t\t\t\t}\n\t\t\t}\n\t\t}b^=1;\n\t}\n\tREP(i,0,M-1){\n\t\tREP(j,0,2)\n\t\t\tmodadd(ans[cnt[i]],f[b][i][j]);\n\t}REP(i,0,K) printf(\"%d\\n\",ans[i]);\n\treturn 0;\n}\n\n\n```",
        "postTime": 1536223895,
        "uid": 57266,
        "name": "__Ressed__",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4590 \u3010[TJOI2018]\u6e38\u56ed\u4f1a\u3011"
    },
    {
        "content": "\u9898\u610f\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u4e32s lenth<=15 \u7ed9\u4e00\u4e2an \u518d\u7ed9\u4e00\u4e2a\u5b57\u7b26\u96c6 \u95een\u957f\u5ea6\u7684\u4e32\u4e2d\u4e0d\u51fa\u73b0noi \u4e14n\u957f\u5ea6\u7684\u4e32\u4e0es\u4e32\u7684lcs\u4e3a\u7b49\u7ea7 \u6c42\u6bcf\u4e2a\u7b49\u7ea7\u6709\u591a\u5c11\u4e2a\u4e0d\u540c\u7684n\u957f\u5ea6\u7684\u4e32\n\u9898\u89e3\uff1ahttp://www.elijahqi.win/archives/3265   \n\u8fd9\u4e2a\u4e3a\u57fa\u7840\n\u5728\u539f\u6709\u7684dp\u6570\u7ec4\u4e0a\u518d\u589e\u52a0\u4e00\u7ef4[0/1/2]\u5206\u522b\u8868\u793a\u5f53\u524d\u4e32\u7684\u672b\u5c3e\u6784\u6210\u7684noi\u7684\u957f\u5ea6\u4e3a\u591a\u5c11\u4e86\n\u7136\u540e\u679a\u4e3e\u516b\u79cd\u60c5\u51b5 \u5206\u522b\u8f6c\u79fb\u5373\u53ef\n```\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nconst int mod=1e9+7;\nint g[20],h[20],w[20],S,dp[2][33768][3],mp[3][3],trans[33768][3],bin[20],n,m,ans[20];char s1[20];\ninline int make(int *h){int s=0;\n\tfor (int i=1;i<=n;++i){\n\t\ts|=(h[i]-h[i-1])*bin[i-1];\n\t}return s;\n}\ninline void make1(int *g,int s){g[0]=0;\n\tfor (int i=1;i<=n;++i) g[i]=g[i-1],g[i]+=(s&bin[i-1])>0;\n}\ninline void pre(){\n\tfor (int owo=0;owo<3;++owo){\n\t\tfor (int s=0;s<=S;++s){\n\t\t\tmake1(g,s);memset(h,0,sizeof(h));\n\t\t\tfor (int i=1;i<=n;++i)\n\t\t\t\th[i]=max(h[i-1],max(g[i],(w[owo]==s1[i])*(g[i-1]+1)));\n\t\t\ttrans[s][owo]=make(h);\n\t\t}\n\t}\n}\ninline void inc(int &x,int v){x=x+v>=mod?x+v-mod:x+v;}\ninline int bc(int x){int tmp=0;\n\tfor (int i=0;i<=n;++i) if (x&bin[i]) ++tmp;return tmp;\n}\nint main(){\n\tfreopen(\"party.in\",\"r\",stdin);\n\tfreopen(\"party.out\",\"w\",stdout);\n\tscanf(\"%d%d\",&m,&n);w[0]='N';w[1]='O';w[2]='I';\n\tfor (int i=0;i<=15;++i) bin[i]=1<<i;\n\tscanf(\"%s\",s1+1);S=(1<<n)-1;pre();int pre=0,now=1;\n\tmp[0][0]=1;mp[0][1]=0;mp[0][2]=0;mp[1][0]=1;\n\tmp[1][1]=2;mp[1][2]=0;mp[2][0]=1;mp[2][1]=0;dp[pre][0][0]=1;\n\tfor (int i=0;i<m;++i){\n\t\tmemset(dp[now],0,sizeof(dp[now]));\n\t\tfor (int s=0;s<=S;++s){\n\t\t\tfor (int j=0;j<=2;++j){\n\t\t\t\tfor (int owo=0;owo<=2;++owo){\n\t\t\t\t\tif (owo==2&&j==2) continue;\n\t\t\t\t\tint y=trans[s][owo];\n\t\t\t\t\tinc(dp[now][y][mp[j][owo]],dp[pre][s][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}pre^=1;now^=1;\n\t}\n\tfor (int s=0;s<=S;++s)\n\t\tfor (int j=0;j<=2;++j) inc(ans[bc(s)],dp[pre][s][j]);\n\tfor (int i=0;i<=n;++i) printf(\"%d\\n\",ans[i]);\n\treturn 0;\n}\n                          ```",
        "postTime": 1526470023,
        "uid": 5037,
        "name": "elijahqi",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P4590 \u3010[TJOI2018]\u6e38\u56ed\u4f1a\u3011"
    }
]
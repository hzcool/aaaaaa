[
    {
        "content": "**\u6700\u5927\u6d41**\n\n\uff08\u7f5a\u65f6\uff1a\u6bcf\u9053\u9898\u88ab\u5b8c\u6210\u7684 **\u65f6\u95f4\u70b9** \u4e4b\u548c\uff09\n\n\u5148\u4e0d\u770b\u7f5a\u65f6\u6700\u5c0f\u7684\u8981\u6c42\uff0c\u53ea\u8003\u8651\u505a\u9898\u6570\u91cf\u6700\u591a\uff0c\u53ef\u4ee5\u50cf\u8fd9\u6837\u5efa\u56fe\uff1a\n\n1 \u6bcf\u4e2a\u4eba\u8fde\u5411\u81ea\u5df1\u4f1a\u505a\u7684\u9898\uff0c\u7531\u4e8e\u4e00\u4e2a\u4eba\u53ea\u4f1a\u505a\u4e00\u9053\u9898\u4e00\u6b21\uff0c\u6240\u4ee5\u5bb9\u91cf\u4e3a1\n\n2 \u6bcf\u9053\u9898\u8fde\u5411\u6c47\u70b9\uff0c\u7531\u4e8e\u4e00\u9053\u9898\u53ea\u9700\u8981\u88ab\u505a\u4e00\u6b21\uff0c\u6240\u4ee5\u5bb9\u91cf\u4e3a1\n\n3 \u6e90\u70b9\u8fde\u5411\u6bcf\u4e2a\u4eba\uff0c\u7531\u4e8e\u6bcf\u4e2a\u4eba\u6700\u591a\u7684\u505a\u9898\u6570\u4e3at/r\uff0c\u6240\u4ee5\u5bb9\u91cf\u586bt/r\n\n\u6700\u5927\u6d41\u5c31\u662f\u6700\u5927\u505a\u9898\u6570\n\n**\u518d\u8003\u8651\u7f5a\u65f6\u6700\u5c0f**\uff0c\u5c31\u662f\u8981\u6c42\u4ece\u6bd4\u8d5b\u5f00\u59cb\uff0c\u8981\u5c3d\u53ef\u80fd\u66f4\u591a\u4eba\u5728\u505a\u9898\uff0c\u4e0a\u9762\u8fd9\u79cd\u5efa\u56fe\u7684\u7f3a\u9677\u5728\u4e8e\u53ef\u80fd\u4e00\u4e2a\u4eba\u5305\u63fd\u4e86\u5f88\u591a\u9898\uff0c\u5bfc\u81f4\u7f5a\u65f6\u5f88\u5927\uff08~~\u660e\u660e\u4ed6\u53ef\u4ee5\u8ba9\u522b\u4eba\u505a\u4e00\u4e9b~~\uff09\u5bfc\u81f4\u8fd9\u79cd\u4e3a\u9898\u5c31\u5728\u4e8e\u6e90\u70b9\u5411\u4eba\u8fde\u7684\u8fb9\u5bb9\u91cf\u8fc7\u5927\uff0c\u4e00\u5f00\u59cb\u5141\u8bb8\u4ed6\u505a\u5f88\u591a\u9898\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u52a8\u6001\u52a0\u8fb9\uff0c\u6bcf\u6b21\u52a0\u4e00\u7ec4\u6e90\u70b9\u5230\u4eba\u7684\u5bb9\u91cf\u4e3a1\u7684\u8fb9\uff0c\u6162\u6162\u5f00\u653e\u4ed6\u4eec\u505a\u9898\u7684\u6743\u9650\uff0c\u9632\u6b62\u4e00\u4e2a\u4eba\u75af\u72c2\u505a\u9898\uff0c\u76f4\u5230\u67d0\u4e00\u6b21\u5373\u4f7f\u52a0\u8fb9\u4ed6\u4eec\u4e5f\u505a\u4e0d\u51fa\u66f4\u591a\u7684\u9898\u76ee\uff0c\u76ee\u524d\u7684\u6d41\u91cf\u56fe\u5c31\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u65b9\u6848\u3002\n\n\u8f93\u51fa\u65b9\u6848\uff1a\u5bf9\u4e8e\u6bcf\u6761\u4eba\u5230\u9898\u76ee\u6b63\u5411\u8fb9\uff0c\u5982\u679c\u88ab\u6d41\u6ee1\u5219\u8fd9\u4e2a\u4eba\u505a\u4e86\u8fd9\u9053\u9898\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define N 500000\n#define inf 1000000007\nusing namespace std;\nint n,m,r,t,k,first[N],nxt[N],tot=1,S,T;\nint in1[N],in2[N],depth[N],maxflow=0,flow,max_num,last=0,ans=0;\nint ans1[N],ans2[N],ans3[N],tpp=0,p[N]={0};\nqueue <int> q;\nstruct Edge\n{\n    int u,v,flow;\n}edge[N];\nvoid Add(int u,int v,int flow)\n{\n    tot++;\n    nxt[tot]=first[u];\n    first[u]=tot;\n    edge[tot]=(Edge){u,v,flow};\n    return;\n}\nvoid Addedge(int u,int v,int flow)\n{\n    Add(u,v,flow);\n    Add(v,u,0);\n    return;\n}\nint bfs()\n{\n    memset(depth,0,sizeof(depth));\n    while (q.size()) q.pop();\n    depth[S]=1;\n    q.push(S);\n    while (q.size())\n    {\n        int tmp=q.front();\n        q.pop();\n        for (int j=first[tmp];j!=-1;j=nxt[j])\n            if (edge[j].flow&&!depth[edge[j].v])\n            {\n            \tint to=edge[j].v;\n            \tdepth[to]=depth[tmp]+1;\n            \tq.push(to);\n            }\n    }\n    if (depth[T]) return 1;\n    else return 0;\n}\nint Dinic(int p,int f)\n{\n    if (p==T) return f;\n    int k,rest=f;\n    for (int j=first[p];j!=-1&&rest;j=nxt[j])\n         if (edge[j].flow&&depth[edge[j].v]==depth[p]+1)\n         {\n         \tint to=edge[j].v;\n         \tk=Dinic(to,min(rest,edge[j].flow));\n         \tif (!k) \n         \t{\n         \t\tdepth[to]=0;\n         \t\tcontinue;\n         \t}\n         \tedge[j].flow-=k;\n         \tedge[j^1].flow+=k;\n         \trest-=k;\n         }\n    return f-rest;\n}\nint main()\n{\n//\tfreopen(\"1.in\",\"r\",stdin);\n//\tfreopen(\"1.out\",\"w\",stdout);\n    memset(first,-1,sizeof(first));\n    scanf(\"%d%d%d%d%d\",&n,&m,&r,&t,&k);\n    S=n+m+1;\n    T=n+m+2;\n    for (int i=1;i<=k;i++) scanf(\"%d%d\",&in1[i],&in2[i]);\n    for (int i=1;i<=k;i++) Addedge(in1[i],in2[i]+n,1);\n    for (int i=n+1;i<=n+m;i++) Addedge(i,T,1);\n    max_num=t/r;\n    for (int i=1;i<=max_num;i++)\n    {\n        for (int i=1;i<=n;i++) Addedge(S,i,1);\n        while (bfs())\n            while ((flow=Dinic(S,inf))) maxflow+=flow;\n        if (maxflow==last) break;\n        last=maxflow;\n    }\n    for (int i=2;i<=tot;i+=2)\n    {\n        int p1=edge[i].u,p2=edge[i].v;\n        if (edge[i].flow==0&&p1!=S&&p2!=T&&i%2==0)\n        {\n        \ttpp++;\n        \tans1[tpp]=p1;\n        \tans2[tpp]=p2-n;\n        \tans3[tpp]=p[p1]*r;\n        \tp[p1]++;\n        \tans+=ans3[tpp]+r;\n        }\n    }\n    printf(\"%d %d\\n\",maxflow,ans);\n    for (int i=1;i<=tpp;i++) printf(\"%d %d %d\\n\",ans1[i],ans2[i],ans3[i]);\n//\tfor (int i=2;i<=tot;i+=2) printf(\"%d %d %d\\n\",edge[i].u,edge[i].v,edge[i].flow);\n    return 0;\n}\n```",
        "postTime": 1545199514,
        "uid": 49107,
        "name": "C_S_X_",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3529 \u3010[POI2011]PRO-Programming Contest\u3011"
    },
    {
        "content": "\n\u9996\u5148\u53ef\u4ee5\u5efa\u7acb\u8d39\u7528\u6d41\u7684\u6a21\u578b\uff0c\u6bcf\u4e2a\u4eba\u62c6\u8fb9\u5373\u53ef\uff0c$S\\to i$ \u4f9d\u6b21\u4e3a\u6d41\u91cf\u4e3a $1$\uff0c\u8d39\u7528\u4e3a $r,2r,3r...$ \u7684\u8fb9\u5373\u53ef\u3002\u8fb9\u6570\u4e3a $\\frac{t}{r}\\times n+nm$\uff0c\u65e0\u6cd5\u901a\u8fc7\u3002\n\n\u6ce8\u610f\u5230\u6211\u4eec\u5fc5\u7136\u662f\u5148\u6d41 $r$ \u7684\u8fb9\u518d\u6d41 $2r,3r$ \u7684\u8fb9\uff0c\u4e0d\u59a8\u4ece\u5c0f\u5230\u5927\u679a\u4e3e $kr$\uff0c\u53d1\u73b0\u672c\u8d28\u4e0a\u662f\u52a8\u6001\u589e\u6d41\u7684\u4e8c\u5206\u56fe\u5339\u914d\u95ee\u9898\uff0c\u5982\u679c\u4e00\u4e2a\u70b9\u4e4b\u524d\u6ca1\u6709\u6d41\u6d41\u91cf\uff0c\u90a3\u4e48\u672c\u6b21\u4ed6\u4e5f\u4e0d\u4f1a\u6d41\u4e86\uff0c\u6240\u4ee5\u76f4\u63a5 \u5308\u7259\u5229/dinic \u53ef\u4ee5\u505a\u5230\u4f18\u79c0\u7684 $\\mathcal O(nm^2)/\\mathcal O(nm\\sqrt{n})$\uff0c\u5982\u679c\u8fde\u8fb9\u7684\u65f6\u5019\u66b4\u529b\u5c31\u5927\u6982\u662f $\\mathcal O(nm)$\uff0c\u4f46\u662f\u4e0d\u662f\u590d\u6742\u5ea6\u74f6\u9888\u6240\u4ee5\u4e5f\u6ca1\u5565\u5173\u7cfb\u3002\n\n$Code:$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std ;\n#define Next( i, x ) for( register int i = head[x]; i; i = e[i].next )\n#define rep( i, s, t ) for( register int i = (s); i <= (t); ++ i )\n#define drep( i, s, t ) for( register int i = (t); i >= (s); -- i )\n#define re register\n#define int long long\nint gi() {\n\tchar cc = getchar() ; int cn = 0, flus = 1 ;\n\twhile( cc < '0' || cc > '9' ) {  if( cc == '-' ) flus = - flus ; cc = getchar() ; }\n\twhile( cc >= '0' && cc <= '9' )  cn = cn * 10 + cc - '0', cc = getchar() ;\n\treturn cn * flus ;\n}\nconst int N = 2000 + 5 ; \nconst int M = 1e6 + 5 ; \nconst int inf = 1e15 + 7 ; \nstruct E {\n\tint next, to, w ; \n} e[M] ; \nint n, m, r, t, K, S, T, cnt, head[N] ;\nint cur[N], dep[N], sum, Ans ;  \nvoid add( int x, int y, int z ) {\n\te[++ cnt] = (E){ head[x], y, z }, head[x] = cnt,\n\te[++ cnt] = (E){ head[y], x, 0 }, head[y] = cnt ; \n}\nqueue<int> q ; \nbool bfs() {\n\trep( i, S, T ) dep[i] = 0 ; q.push(S), dep[S] = 1 ;\n\twhile( !q.empty() ) {\n\t\tint u = q.front() ; q.pop() ; \n\t\tNext( i, u ) {\n\t\t\tint v = e[i].to ; \n\t\t\tif( e[i].w && !dep[v] ) \n\t\t\tdep[v] = dep[u] + 1, q.push(v) ; \n\t\t}\n\t} return dep[T] != 0 ; \n}\nint dfs( int x, int dist ) {\n\tif( x == T || !dist ) return dist ; int flow = 0 ;\n\tfor( re int &i = cur[x]; i; i = e[i].next ) {\n\t\tint v = e[i].to ; \n\t\tif( e[i].w && dep[v] == dep[x] + 1 ) {\n\t\t\tint di = dfs( v, min(dist, e[i].w) ) ; \n\t\t\te[i].w -= di, e[i ^ 1].w += di, flow += di, dist -= di ; \n\t\t}\n\t} return flow ; \n}\nint dinic() {\n\tint ans = 0, di ;\n\twhile( bfs() ) {\n\t\trep( i, S, T ) cur[i] = head[i] ; \n\t\twhile(di = dfs(S, inf)) ans += di ; \n\t} return ans ; \n}\nsigned main()\n{\n\tn = gi(), m = gi(), r = gi(), t = gi(), K = gi(), cnt = 1 ; \n\tint x, y, maxn = t / r ; S = 0, T = n + m + 1 ; \n\trep( i, 1, K ) x = gi(), y = gi(), add(x, y + n, 1) ; \n\trep( i, 1, m ) add( i + n, T, 1 ) ;\n\tint sum = 0, de = 0 ; \n\twhile( de < maxn ) {\n\t\t++ de ; \n\t\trep( i, 1, n ) add( S, i, 1 ) ;\n\t\tint f = dinic() ; if( f == 0 ) break ; \n\t\tAns += f * de, sum += f ; \n\t}\n\tprintf(\"%lld %lld\\n\", sum, Ans * r ) ;\n\trep( x, 1, n ) {\n\t\tint de = 0 ; \n\t\tNext( i, x ) {\n\t\t\tint v = e[i].to ; \n\t\t\tif( !e[i].w && v != S ) printf(\"%lld %lld %lld\\n\", x, v - n, de * r ), ++ de ; \n\t\t}\n\t}\n\treturn 0 ;\n}\n```",
        "postTime": 1596340062,
        "uid": 30036,
        "name": "Soulist",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3529 \u3010[POI2011]PRO-Programming Contest\u3011"
    },
    {
        "content": "$$\\href{http://blog.chhokmah.top/index.php/archives/45/}{\\Large\\texttt{My blog}}$$\n\n---\n\n> \u9898\u76ee\u94fe\u63a5\uff1a[\u6d1b\u8c373529](https://www.luogu.org/problemnew/solution/P3529)\n\n## \u9898\u76ee\u63cf\u8ff0\n\u73b0\u5728\u6709$n$\u4e2a\u4eba\uff0c\u6bcf\u4e00\u4e2a\u4eba\u6709\u4e00\u4e2a\u7535\u8111\uff0c\u7136\u540e\u4e00\u5927\u5806\u9898\u76ee\uff0c\u73b0\u5728\u7ed9\u51fa\u6bcf\u4e00\u4e2a\u4eba\u80fd\u591f\u89e3\u51fa\u9898\u76ee\u7684\u5bf9\u5e94\u5173\u7cfb\uff0c\u6bcf\u4e00\u4e2a\u4eba\u89e3\u51fa\u4e00\u9053\u9898\u76ee\u7684\u65f6\u95f4\u662f\u56fa\u5b9a\u7684$r$\uff0c\u73b0\u5728\u6709$t$\u603b\u65f6\u95f4\uff0c\u5e76\u4e14\u6211\u4eec\u6309\u7167$ACM$\u7684\u8ba1\u5206\u65b9\u5f0f\u6765\u8ba1\u7b97\u5206\u6570\u3002\n\n\u8bf7\u4f60\u7ed9\u51fa\u80fd\u591f\u6700\u5927\u5316\u9898\u76ee\u7684\u60c5\u51b5\u4e0b\uff0c\u6700\u5c0f\u5316\u7f5a\u65f6\uff0c\u5e76\u7ed9\u51fa\u65b9\u6848\u3002\n## Data Range\n$n,m\\leq 500,r,t\\leq 1000000$\n<!--more-->\n## Solution\n\u8003\u8651\u4e8c\u5206\u56fe\u5339\u914d\uff0c\u5f88\u663e\u7136\u7684\u662f\u6211\u4eec\u8981\u628a\u9898\u76ee\u5f80\u524d\u9762\u5806\u8d8a\u597d\uff0c\u8fd9\u6837\u53ef\u4ee5\u4fdd\u8bc1\u7f5a\u65f6\u6700\u5c11\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u9996\u5148\u679a\u4e3e\u65f6\u95f4$nowt$\u8868\u793a\u5f53\u524d\u7684\u65f6\u95f4\u6bb5\uff0c\u90a3\u4e48\u89e3\u51fa\u9700\u8981$r$\u7684\u65f6\u95f4\u3002\n\n\u90a3\u4e48\u57fa\u4e8e\u5f53\u524d\u7684\u65f6\u95f4\u6211\u4eec\u5c31\u5c3d\u53ef\u80fd\u7684\u6ee1\u8db3\u4e8c\u5206\u56fe\u5339\u914d\uff0c\u8fd9\u4e2a\u5339\u914d\u662f\u9898\u76ee\u5339\u914d\u4eba\u3002**\u56e0\u4e3a\u4e00\u4e2a\u4eba\u53ef\u4ee5\u505a\u51fa\u591a\u4e2a\u9898\u76ee\uff0c\u4f46\u662f\u4e00\u4e2a\u9898\u76ee\u505a\u6389\u5c31\u6ca1\u6709\u529e\u6cd5\u518d\u505a\u4e00\u6b21\u4e86\u3002**\n\n\u6240\u4ee5\u6211\u4eec\u5c31\u7528\u8d2a\u5fc3\u7684\u601d\u8def\uff0c\u6309\u7167\u6700\u5c11\u7684\u65f6\u95f4\u6765\u8d2a\u5fc3\u5339\u914d\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a\u4e8c\u5206\u56fe\u5339\u914d\u7684\u590d\u6742\u5ea6\u3002\n## Code\n```cpp\n// ==================\n// author : chhokmah\n// website : http://blog.chhokmah.top/\n// create time : 13/08/19 22:38\n// ==================\n#pragma GCC optimize(\"O2\")\n#pragma GCC optimize(\"O3\")\n#pragma GCC optimize(\"Ofast\")\n\n#include <bits/stdc++.h>\n#include <ext/pb_ds/tree_policy.hpp>\n#include <ext/pb_ds/assoc_container.hpp>\n#include <ext/rope>\n\n#define REP(i, s, t) for (int i = (s); i <= (t); i ++) \n#define DOW(i, s, t) for (int i = (s); i >= (t); i --)\n\nusing namespace std;\nusing namespace __gnu_pbds;\nusing namespace __gnu_cxx;\n\n#define unordered_map __fast_unordered_map\ntemplate<class Key, class Value, class Hash = std::hash<Key>>\nusing unordered_map = __gnu_pbds::gp_hash_table<Key, Value, Hash>;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double ld;\ntypedef double db;\n\nconst int P = 1e9 + 7; // 998244353\nconst db pi = acos(-1);\n\ntemplate <typename T> void pls(T &x, T y) { x = x + y >= P ? x + y - P : x + y; }\ntemplate <typename T> T add(T x, T y) { return x + y >= P ? x + y - P : x + y; }\ntemplate <typename T> void dec(T &x, T y) { }\ntemplate <typename T> void module(T x) { return (x % P + P) % P; }\ntemplate <typename T> T mul(T x, T y) { return (ll) x * y - (ll) x * y / P * P; }\n\n#define mp make_pair\n#define pb push_back\n#define fi first\n#define se second \n#define pi acos(-1)\n\ntemplate <typename T> void chkmax(T &x, T y) { x = x > y ? x : y; }\ntemplate <typename T> void chkmin(T &x, T y) { x = x < y ? x : y; }\ntemplate <typename T> T qpow(T x, T y) {\n  T res = 1; \n  for (; y; y >>= 1, x = mul(x, x)) {\n    if (y & 1) res = mul(res, x);\n  }\n  return res;\n}\nll inc(ll x, ll y) {\n  ll res = 0;\n  for (; y; y >>= 1, x = add(x, x)) {\n    if (y & 1) pls(res, x);\n  }\n  return res;\n}\n\nnamespace input {\n  template <typename T> void read(T &x) {\n    x = 0; T flg = 0; char ch = 0;\n    for (; !isdigit(ch); ch = getchar()) if (ch == '-') flg = 1;\n    for (; isdigit(ch); ch = getchar()) x = (x << 1) + (x << 3) + (ch ^ 48);\n    if (flg) x *= -1;\n  }\n  template <typename T, typename... Tx> void read(T &x, Tx &...tx) {\n    read(x); read(tx...); \n  }\n}\n\nusing namespace input;\n\nnamespace output {\n  void write(int x) {\n    if (x < 0) putchar('-'), x = -x;\n    if (x > 9) write(x / 10);\n    putchar(x % 10 + '0');\n  }\n  void write(ll x) {\n    if (x < 0) putchar('-'), x = -x;\n    if (x > 9) write(x / 10);\n    putchar(x % 10 + '0');\n  }\n  void write(char ch) { putchar(ch); }\n  void write(string s) { cout << s; }\n  void write(ull x) {\n    if (x < 0) putchar('-'), x = -x;\n    if (x > 9) write(x / 10);\n    putchar(x % 10 + '0');\n  }\n  void write(db x) { printf(\"%.9lf\\n\", x); }\n  template <typename T, typename... Tx> void write(T x, Tx ...tx) {\n    write(x); write(tx...); \n  }\n  template <typename T, typename... Tx> void writeln(T x, Tx ...tx) {\n    write(x); write(tx...); puts(\"\");\n  }\n  template <typename T> void _dbg(T *a, int l, int r, string s_a = \"\") {\n    if (s_a != \"\") cout << \"array name : \" << s_a << \" -> \"; printf(\"range [%d, %d] : \", l, r);\n    for (int i = l; i <= r; i ++) cout << a[i] << \" \\n\"[i == r];\n  }\n}\n\nusing namespace output;\n\nconst int N = 3005;\nvector<int> g[N];\nbool vis[N];\nint match[N], now_time[N];\nint n, m, r, t, k;\nint dfs(int u) {\n  for (auto v : g[u]) {\n    if (vis[v]) continue;\n    vis[v] = 1;\n    if (match[v] == -1 || dfs(match[v])) {\n      match[v] = u;\n      return 1;\n    }\n  }\n  return 0;\n}\nint main() {\n  memset(match, -1, sizeof(match));\n  read(n, m, r, t, k);\n  for (int i = 1; i <= k; i ++) {\n    int u, v; \n    read(u, v);\n    g[u].emplace_back(v);\n  }\n  int ans1 = 0, ans2 = 0;\n  for (int i = 1; i * r <= t; i ++) {\n    bool flg = 0;\n    for (int j = 1; j <= n; j ++) {\n      memset(vis, 0, sizeof(vis));\n      if (dfs(j)) {\n        ans1 ++; \n        ans2 += i * r;\n        flg = 1;\n      }\n    }\n    if (!flg) break;\n  }\n  writeln(ans1, ' ', ans2);\n  memset(now_time, 0, sizeof(now_time));\n  for (int i = 1; i <= m; i ++) {\n    if (match[i] == -1) continue;\n    int u = match[i];\n    writeln(u, ' ', i, ' ', now_time[u]);\n    now_time[u] += r; \n  }\n  return 0;\n}\n```",
        "postTime": 1565707352,
        "uid": 35567,
        "name": "Ayers",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3529 \u3010[POI2011]PRO-Programming Contest\u3011"
    }
]
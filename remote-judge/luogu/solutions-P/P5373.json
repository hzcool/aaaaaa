[
    {
        "content": "\u4ee4$L=\\sqrt n$\u3002\n\n$$\\sum_{i=0}^n[x^i]F(x)G(x)^i=\\sum_{i=0}^{L-1}\\sum_{j=0}^{L-1}[x^{iL+j}]F(x)G(x)^{iL+j}$$\n$$=\\sum_{i=0}^{L-1}G(x)^{iL}\\sum_{j=0}^{L-1}[x^{iL+j}]F(x)G(x)^{j}$$\n\n\u9884\u5904\u7406\u51fa\u6240\u6709$G(x)^{iL}$\u548c$G(x)^j$\uff0c\u8fd9\u90e8\u5206\u7528NTT\u641e\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\sqrt n\\log n)$\u3002\n\n\u7136\u540e\uff0c\u5bf9\u4e8e$\\sum\\limits_{j=0}^{L-1}[x^{iL+j}]F(x)G(x)^{j}$\u90e8\u5206\u66b4\u529b\u8ba1\u7b97\u3002\u628a\u8ba1\u7b97\u7ed3\u679c\u518d\u4e58\u4e0a$G(x)^{iL}$\u5373\u53ef\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6$O(n^2+n\\sqrt n\\log n)$\u3002\n\n\u5b9e\u9645\u4e0a\uff0c$O(n^2)$\u90e8\u5206\u5e38\u6570\u5c0f\u5b8c\u5168\u4e0d\u865a\uff0cNTT\u90e8\u5206\u9700\u8981\u5e38\u6570\u6bd4\u8f83\u4f18\u79c0\u7684\u5b9e\u73b0\u3002\n\n~~\u542c\u8bf4\u6709\u4eba\u7528Brent-Kung\u7b97\u6cd5TLE\u4e86~~\n\n~~\u6211\u590d\u6742\u5ea6\u6bd4\u4f60\u52a3\u4f46\u6211\u8dd1\u5f97\u6bd4\u4f60\u5feb~~\n\n## Code\uff1a\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n#include<ctime>\nconst int N=65536,md=998244353;\ntypedef long long LL;\ninline void upd(int&a){a+=a>>31&md;}\ninline int pow(int a,int b){\n    int ret=1;\n    for(;b;b>>=1,a=(LL)a*a%md)if(b&1)ret=(LL)ret*a%md;\n    return ret;\n}\nint n,m,A[N],B[N],L,g[17][N],lim,rev[N],M,B1[150][N],B2[250][N],R[N];\nvoid init(int n){\n    int l=-1;\n    for(lim=1;lim<n;lim<<=1)++l;M=l+1;\n    for(int i=1;i<lim;++i)\n    rev[i]=((rev[i>>1])>>1)|((i&1)<<l);\n}\nvoid NTT(int*a,int f){\n    for(int i=1;i<lim;++i)if(i<rev[i])std::swap(a[i],a[rev[i]]);\n    for(int i=0;i<M;++i){\n        const int*G=g[i],c=1<<i;\n        for(int j=0;j<lim;j+=c<<1)\n        for(int k=0;k<c;++k){\n            const int x=a[j+k],y=a[j+k+c]*(LL)G[k]%md;\n            upd(a[j+k]+=y-md),upd(a[j+k+c]=x-y);\n        }\n    }\n    if(!f){\n        const int iv=pow(lim,md-2);\n        for(int i=0;i<lim;++i)a[i]=(LL)a[i]*iv%md;\n        std::reverse(a+1,a+lim);\n    }\n}\nvoid work(){\n    B1[0][0]=B2[0][0]=1;\n    for(int i=0;i<m;++i)B1[1][i]=B[i];\n    NTT(B,1);\n    for(int i=2;i<=L;++i){\n        int*Bp=B1[i-1],*Bn=B1[i];\n        NTT(Bp,1);\n        for(int i=0;i<lim;++i)Bn[i]=(LL)B[i]*Bp[i]%md;\n        NTT(Bp,0),NTT(Bn,0);\n        for(int i=n;i<n<<1;++i)Bn[i]=0;\n    }\n    for(int i=0;i<n;++i)B2[1][i]=B1[L][i];\n    int*bL=B1[L];\n    NTT(bL,1);\n    for(int i=2;i<L;++i){\n        int*Bp=B2[i-1],*Bn=B2[i];\n        NTT(Bp,1);\n        for(int i=0;i<lim;++i)Bn[i]=(LL)bL[i]*Bp[i]%md;\n        NTT(Bp,0),NTT(Bn,0);\n        for(int i=n;i<n<<1;++i)Bn[i]=0;\n    }\n    NTT(bL,0);\n}\nint main(){\n    scanf(\"%d%d\",&n,&m),++n,++m;\n    for(int i=0;i<17;++i){\n        int*G=g[i];\n        G[0]=1;\n        const int gi=G[1]=pow(3,(md-1)/(1<<i+1));\n        for(int j=2;j<1<<i;++j)G[j]=(LL)G[j-1]*gi%md;\n    }\n    L=sqrt(n)+1;\n    init(n<<1);\n    for(int i=0;i<n;++i)scanf(\"%d\",A+i);\n    for(int i=0;i<m;++i)scanf(\"%d\",B+i);\n    work();\n    for(int i=0;i<L;++i){\n        static int C[N];\n        for(int i=0;i<lim;++i)C[i]=0;\n        for(int j=0;j<L;++j){\n            const int x=A[i*L+j],*B=B1[j];\n            for(int k=0;k<n;++k)\n            C[k]=(C[k]+(LL)x*B[k])%md;\n        }\n        NTT(C,1),NTT(B2[i],1);\n        for(int j=0;j<lim;++j)C[j]=(LL)C[j]*B2[i][j]%md;\n        NTT(C,0);\n        for(int i=0;i<n;++i)upd(R[i]+=C[i]-md);\n    }\n    for(int i=0;i<n;++i)\n    printf(\"%d \",R[i]);\n    return 0;\n}\n\n```",
        "postTime": 1557895126,
        "uid": 6813,
        "name": "mrsrz",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5373 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u590d\u5408\u51fd\u6570\u3011"
    },
    {
        "content": "## \u524d\u8a00\n\n\u8fd9\u662f\u8fd9\u9053\u9898\u590d\u6742\u5ea6\u6bd4\u8f83\u6b63\u786e\u7684\u4e00\u4e2a~~\u5e38\u6570\u5947\u5927\u65e0\u6bd4\u7684~~\u7b97\u6cd5\uff0c\u6e90\u81ea $\\text{R.P.BRENT}$ \u548c $\\text{H.T.KUNG}$ \u5728 $1978$ \u5e74\u53d1\u8868\u7684\u8bba\u6587\uff08\u4e5f\u5c31\u662f\u9898\u9762\u91cc\u8bf4\u7684\u90a3\u4e2a\u5168\u5624\u6587pdf\uff09\uff0c\u6211\u5728 $\\text{5\u670815\u65e5}$ \u84af\u5230\u624b\u4e4b\u540e\u809d\u4e86\u4e00\u4e2a\u665a\u4e0a\uff0c\u5728\u795e\u7287 rqy \u7684\u5e2e\u52a9\u4e0b\u6210\u529f\u5730\u5199\u51fa\u4e86[66\u5206](https://www.luogu.org/recordnew/show/19052439)\u70b9\u540d\u88ab\u5361\u505a\u6cd5~~awsl~~\uff0c\u540e\u6765\u7814\u7a76\u522b\u4eba\u4ee3\u7801\u7684\u65f6\u5019\u53d1\u73b0\u4e86 `\u9884\u5904\u7406\u539f\u6839` \u8fd9\u79cd\u795e\u5947\u64cd\u4f5c\uff0c\u4e8e\u662f\u6210\u529f[AC](https://www.luogu.org/recordnew/show/19554564)\uff0c\u7279\u6765\u8fd8\u613f\u3002\n\n---\n## \u6b63\u6587\n\n\u8fd9\u79cd\u505a\u6cd5\u57fa\u4e8e\u5bf9\u5916\u5c42\u51fd\u6570\u7684\u6cf0\u52d2\u5c55\u5f00\uff0c\u6211\u4eec\u628a\u5185\u5c42\u51fd\u6570 $G$ \u7684\u524d $m$ \u9879\u62c6\u51fa\u6765\uff0c\u8bb0\u4f5c $G_m$ \uff0c\u628a\u5269\u4e0b\u7684\u8bb0\u4f5c $G_r$ \u3002(\u8fd9\u4e2a $m$ \u5230\u5e95\u53d6\u591a\u5c11\u6211\u4eec\u5206\u6790\u590d\u6742\u5ea6\u7684\u65f6\u5019\u518d\u786e\u5b9a)\n\n\u7136\u540e\u8fdb\u884c\u6cf0\u52d2\u5c55\u5f00\uff1a\n$$\\large F(G)=F(G_m+G_r)=F(G_m)+F'(G_m)G_r+\\frac12F''(G_m)G_r^2+\\cdots$$\n\u7531\u4e8e\u6211\u4eec\u53ea\u9700\u8981\u6c42 $F(G)$ \u524d $n+1$ \u9879\u7684\u503c\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u77e5\u9053\u8fd9\u4e2a\u5c55\u5f00\u5f0f\u524d $\\lceil\\frac nm\\rceil$ \u9879\u7684\u503c\u5373\u53ef\uff0c\u5373\uff1a  \n\u4ee4 $l=\\lceil\\frac nm\\rceil$ \uff0c\u6709\n$$\\large F(G(x))\\equiv F(G_m(x))+F'(G_m(x))G_r(x)+\\cdots+\\frac1{l!}F^{(l)}(G_m(x))G_r^l(x)\\pmod{x^{n+1}}$$\n\u56e0\u6b64\u6211\u4eec\u53ea\u8981\u8ba1\u7b97\u51fa $F(G_m(x))$ \u7684\u5404\u9636\u5bfc\u548c $G_r(x)$ \u7684\u5404\u6b21\u5e42\uff0c\u5c31\u53ef\u4ee5\u7d2f\u52a0\u5f97\u5230 $F(G(x))$ \u4e86\u3002\n\n$G_r(x)$ \u53ea\u9700\u8981\u4ece $G(x)$ \u4e2d\u622a\u51fa\u6765\u5373\u53ef\uff0c\u90a3\u4e48\u5982\u4f55\u8ba1\u7b97 $F(G_m(x))$ \u5462\uff1f  \n\u8003\u8651\u5916\u5c42\u51fd\u6570\u6700\u9ad8\u6b21\u9879\u6b21\u6570\u4e3a $2$ \u7684\u5e42\u7684\u60c5\u51b5\uff0c\u5373\uff1a  \n\u4ee4 $F(x)=f_0+\\cdots+f_jx^j$ \u4e14 $j$ \u4e3a $2$ \u7684\u6b63\u6574\u6570\u6b21\u5e42\uff0c\u6709\n$$\\large F(G)=F_1(G)+G^{\\frac j2}\\cdot F_2(G)$$\n\u8fd9\u91cc $F_1$ \u548c $F_2$ \u90fd\u662f\u6700\u9ad8\u6b21\u9879\u6b21\u6570\u4e3a $\\frac j2$ \u7684\u591a\u9879\u5f0f\uff0c\u8fd9\u6837\u4e00\u6765\u6211\u4eec\u5c31\u80fd\u9012\u5f52\u5730\u8ba1\u7b97 $F(G_m(x))$ \u4e86\u3002\n\n\u8003\u8651\u8fd9\u4e00\u6b65\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff1a  \n\u6211\u4eec\u4ee4 $M(n)$ \u4e3a\u5b8c\u6210\u4e24\u4e2a $n$ \u6b21\u591a\u9879\u5f0f\u7684\u4e58\u6cd5\u7684\u65f6\u95f4\uff0c\u5373\uff1a $M(n)=O(n\\log n)$  \n\u6211\u4eec\u8bbe $T(j)$ \u4e3a\u8ba1\u7b97 $G^{\\frac j2}$ \u548c $F(G)$ \u7684\u65f6\u95f4\uff0c\u5219\u6709\n$$\\large T(j)\\leqslant2T(\\frac j2)+O(M(\\min(jm,n)))$$\n\u6211\u4eec\u4ee4 $r$ \u4e3a\u6ee1\u8db3 $n\\cdot2^k\\leqslant jm$ \u7684\u6700\u5927\u7684 $k$ \uff0c\u5219\u6709\n$$\\large T(j)=O(M(n)+2M(n)+\\cdots+2^rM(n))+2^{r+1}T(\\frac{j}{2^{r+1}})$$\n$$\\large T(j)\\leqslant O(\\frac{jmM(n)}{n})+(\\frac{2jm}{n})T(\\frac{j}{2^{r+1}})$$\n\u53c8\u56e0\u4e3a $n\\cdot2^{r+1}>jm$ \uff0c\u6709\n$$\\large T(\\frac{j}{2^{r+1}})=O(M(\\frac{jm}{2^{r+1}})+2M(\\frac{jm}{2^{r+2}})+\\cdots)$$\n$$\\large=O(M(n)+2M(\\lceil\\frac n2\\rceil)+4M(\\lceil\\frac n4\\rceil)+\\cdots)$$\n$$\\large=O(\\log nM(n))$$\n\u56e0\u6b64\uff0c\u6211\u4eec\u6709 $T(j)=O(\\frac{jm\\log n}{n}M(n))$ \uff0c\u6240\u4ee5\u6c42\u89e3 $F(G_m(x))$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(mn\\log^2n)$ \u3002\n\n\u6211\u4eec\u518d\u6765\u8003\u8651\u5bf9 $F(G_m(x))$ \u6c42\u5bfc\uff1a    \n\u4ee4 $H(x)=F(G(x))$  \n\u6839\u636e\u590d\u5408\u51fd\u6570\u6c42\u5bfc\u6cd5\u5219\uff0c\u6211\u4eec\u6709 $H'(x)=F'(G(x))\\cdot G'(x)$ \uff0c\u56e0\u6b64 $F'(G_m(x))=H'(x)\\cdot(G_m'(x))^{-1}$ \uff0c\u7531\u6b64\u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97\u51fa\u6cf0\u52d2\u5c55\u5f00\u5f0f\u4e2d\u67d0\u4e00\u9879\u4e4b\u540e\u4e0e\u4e4b\u524d\u7684\u7ed3\u679c\u7d2f\u52a0\u5f97\u5230 $H(x)$ \uff0c\u540c\u65f6\u8ba1\u7b97\u51fa\u4e0b\u4e00\u9879\u4e2d $F(G_m(x))$ \u7684\u5bf9\u5e94\u9636\u5bfc\u3002\u6bcf\u8ba1\u7b97\u4e00\u6b21\u5bfc\u6570\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n\\log n)$ \u7684\uff0c\u56e0\u6b64\u8ba1\u7b97\u51fa\u6240\u6709\u9879\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(l\\cdot n\\log n)=O(\\frac{n^2\\log n}{m})$ \u3002\n\n\u6211\u4eec\u5df2\u7ecf\u5f97\u5230\u4e86 $F(G_m(x))$ \u7684\u5404\u9636\u5bfc\uff0c\u800c $G_r(x)$ \u7684\u5404\u6b21\u5e42\u53ea\u9700\u8981\u6328\u4e2a\u4e58\u8d77\u6765\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u662f $O(\\frac{n^2\\log n}{m})$ \u7684\u3002\n\n\u4e4b\u540e\u5404\u9879\u7684\u8ba1\u7b97\u548c\u7d2f\u52a0\u540c\u6837\u662f $O(\\frac{n^2\\log n}{m})$ \u7684\uff0c\u56e0\u6b64\u8fd9\u4e2a\u7b97\u6cd5\u7684\u603b\u590d\u6742\u5ea6\u4e3a $O(mn\\log^2n+\\frac{n^2\\log n}{m})$ \u3002\n\n\u6211\u4eec\u8003\u8651 $m$ \u7684\u53d6\u503c\uff1a\u6839\u636e\u5747\u503c\u4e0d\u7b49\u5f0f\uff0c\u5f53 $mn\\log^2n\\sim\\frac{n^2\\log n}{m}$ \u65f6\u65f6\u95f4\u590d\u6742\u5ea6\u6700\u4f18\uff0c\u56e0\u6b64\u89e3\u5f97\u5f53 $m\\sim\\sqrt{\\frac{n}{\\log n}}$ \u65f6\u6709\u6700\u4f18\u65f6\u95f4\u590d\u6742\u5ea6 $O((n\\log n)^{1.5})$ \u3002\n\n---\n## \u6700\u540e\n\n\u8fd8\u662f\u9644\u4e0a\u53c2\u8003\u4ee3\u7801\u6bd4\u8f83\u597d\uff0c\u8fd9\u4e2a\u4e1c\u897f\u7531\u4e8e\u5e38\u6570\u539f\u56e0\u5fc5\u987b \u9884\u5904\u7406\u539f\u6839 \u624d\u80fd\u5361\u8fc7\u53bb\uff0c\u800c\u4e14\u597d\u50cf\u4e5f\u6ca1\u6709\u4ec0\u4e48\u5b9e\u9645\u7528\u5904\u3002\u3002\u5c31\u5f53\u662f\u7ec3\u4e60\u7801\u529b\u4e86 2333\n```cpp\n#pragma GCC optimize(\"Ofast,inline\")\n#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,sse4.1,sse4.2,popcnt,abm,mmx,avx,avx2,tune=native\")\n#include <cstdio>\n#include <cstring>\n#include <cmath>\n#include <algorithm>\n\n#define MOD 998244353\n#define G 332748118\n#define N 262210\n#define re register\n#define gc pa==pb&&(pb=(pa=buf)+fread(buf,1,100000,stdin),pa==pb)?EOF:*pa++\ntypedef long long ll;\nstatic char buf[100000],*pa(buf),*pb(buf);\nstatic char pbuf[3000000],*pp(pbuf),st[15];\ninline int read() {\n    re int x(0);re char c(gc);\n    while(c<'0'||c>'9')c=gc;\n    while(c>='0'&&c<='9')\n        x=x*10+c-48,c=gc;\n    return x;\n}\ninline void write(re int v) {\n    if(v==0)\n        *pp++=48;\n    else {\n        re int tp(0);\n        while(v)\n            st[++tp]=v%10+48,v/=10;\n        while(tp)\n            *pp++=st[tp--];\n    }\n    *pp++=32;\n}\n\ninline int pow(re int a,re int b) {\n    re int ans(1);\n    while(b)\n        ans=b&1?(ll)ans*a%MOD:ans,a=(ll)a*a%MOD,b>>=1;\n    return ans;\n}\n\nint inv[N],ifac[N];\ninline void pre(re int n) {\n    inv[1]=ifac[0]=1;\n    for(re int i(2);i<=n;++i)\n        inv[i]=(ll)(MOD-MOD/i)*inv[MOD%i]%MOD;\n    for(re int i(1);i<=n;++i)\n        ifac[i]=(ll)ifac[i-1]*inv[i]%MOD;\n}\n\ninline int getLen(re int t) {\n\treturn 1<<(32-__builtin_clz(t));\n}\n\nint lmt(1),r[N],w[N];\ninline void init(re int n) {\n\tre int l(0);\n\twhile(lmt<=n)\n\t\tlmt<<=1,++l;\n\tfor(re int i(1);i<lmt;++i)\n\t\tr[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\tre int wn(pow(3,(MOD-1)/lmt));\n\tw[lmt>>1]=1;\n\tfor(re int i((lmt>>1)+1);i<lmt;++i)\n\t\tw[i]=(ll)w[i-1]*wn%MOD;\n\tfor(re int i((lmt>>1)-1);i;--i)\n\t\tw[i]=w[i<<1];\n}\n\ninline void DFT(int*a,re int l) {\n\tstatic unsigned long long tmp[N];\n\tre int u(__builtin_ctz(lmt)-__builtin_ctz(l)),t;\n\tfor(re int i(0);i<l;++i)\n\t\ttmp[i]=(a[r[i]>>u])%MOD;\n\tfor(re int i(1);i<l;i<<=1)\n\t\tfor(re int j(0),step(i<<1);j<l;j+=step)\n\t\t\tfor(re int k(0);k<i;++k)\n\t\t\t\tt=(ll)w[i+k]*tmp[i+j+k]%MOD,\n\t\t\t\ttmp[i+j+k]=tmp[j+k]+MOD-t,\n\t\t\t\ttmp[j+k]+=t;\n\tfor(re int i(0);i<l;++i)\n\t\ta[i]=tmp[i]%MOD;\n}\n\ninline void IDFT(int*a,re int l) {\n\tstd::reverse(a+1,a+l);DFT(a,l);\n\tre int bk(MOD-(MOD-1)/l);\n\tfor(re int i(0);i<l;++i)\n\t\ta[i]=(ll)a[i]*bk%MOD;\n}\n\nint n,m;\nint a[N],b[N],c[N];\n\nvoid getInv(int*a,int*b,int deg) {\n    if(deg==1)\n        b[0]=pow(a[0],MOD-2);\n    else {\n        static int tmp[N];\n        getInv(a,b,(deg+1)>>1);\n        re int l(getLen(deg<<1));\n        for(re int i(0);i<l;++i)\n            tmp[i]=i<deg?a[i]:0;\n        DFT(tmp,l),DFT(b,l);\n        for(re int i(0);i<l;++i)\n            b[i]=(2ll-(ll)tmp[i]*b[i]%MOD+MOD)%MOD*b[i]%MOD;\n        IDFT(b,l);\n        for(re int i(deg);i<l;++i)\n            b[i]=0;\n    }\n}\n\ninline void getDer(int*a,int*b,int deg) {\n    for(re int i(0);i+1<deg;++i)\n        b[i]=(ll)a[i+1]*(i+1)%MOD;\n    b[deg-1]=0;\n}\n\nvoid getComp(int*a,int*b,int k,int m,int&n,int*c,int*d) {\n    if(k==1) {\n        for(re int i(0);i<m;++i)\n            c[i]=0,d[i]=b[i];\n        n=m,c[0]=a[0];\n    } else {\n        static int t1[N],t2[N];\n        int nl(n),nr(n),*cl,*cr,*dl,*dr;\n        getComp(a,b,k>>1,m,nl,cl=c,dl=d);\n        getComp(a+(k>>1),b,(k+1)>>1,m,nr,cr=c+nl,dr=d+nl);\n        n=std::min(n,nl+nr-1);\n        re int _l(getLen(nl+nr));\n        for(re int i(0);i<_l;++i)\n            t1[i]=i<nl?dl[i]:0;\n        for(re int i(0);i<_l;++i)\n            t2[i]=i<nr?cr[i]:0;\n        DFT(t1,_l),DFT(t2,_l);\n        for(re int i(0);i<_l;++i)\n            t2[i]=(ll)t1[i]*t2[i]%MOD;\n        IDFT(t2,_l);\n        for(re int i(0);i<n;++i)\n            c[i]=((i<nl?cl[i]:0)+t2[i])%MOD;\n        for(re int i(0);i<_l;++i)\n            t2[i]=i<nr?dr[i]:0;\n        DFT(t2,_l);\n        for(re int i(0);i<_l;++i)\n            t2[i]=(ll)t1[i]*t2[i]%MOD;\n        IDFT(t2,_l);\n        for(re int i(0);i<n;++i)\n            d[i]=t2[i];\n    }\n}\n\ninline void getComp(int*a,int*b,int*c,int deg) {\n    static int ts[N],ps[N],c0[N],_t1[N],idM[N];\n    int M(std::max((int)ceil(sqrt(deg/log2(deg))*2.5),2)),_n(deg+deg/M);\n    getComp(a,b,deg,M,_n,c0,_t1);\n    re int _l(getLen(_n+deg));\n    for(re int i(_n);i<_l;++i)\n        c0[i]=0;\n    for(re int i(0);i<_l;++i)\n        ps[i]=i==0;\n    for(re int i(0);i<_l;++i)\n        ts[i]=M<=i&&i<deg?b[i]:0;\n    getDer(b,_t1,M);\n    for(re int i(M-1);i<deg;++i)\n        _t1[i]=0; /// Important!!!\n    getInv(_t1,idM,deg);\n    for(int i=deg;i<_l;++i)\n    \tidM[i]=0;\n    DFT(ts,_l),DFT(idM,_l);\n    for(re int t(0);t*M<deg;++t) {\n        for(re int i(0);i<_l;++i)\n            _t1[i]=i<deg?c0[i]:0;\n        DFT(ps,_l),DFT(_t1,_l);\n        for(re int i(0);i<_l;++i)\n            _t1[i]=(ll)_t1[i]*ps[i]%MOD,\n            ps[i]=(ll)ps[i]*ts[i]%MOD;\n        IDFT(ps,_l),IDFT(_t1,_l);\n        for(re int i(deg);i<_l;++i)\n            ps[i]=0;\n        for(re int i(0);i<deg;++i)\n            c[i]=((ll)_t1[i]*ifac[t]+c[i])%MOD;\n        getDer(c0,c0,_n);\n        for(re int i(_n-1);i<_l;++i)\n            c0[i]=0;\n        DFT(c0,_l);\n        for(re int i(0);i<_l;++i)\n            c0[i]=(ll)c0[i]*idM[i]%MOD;\n        IDFT(c0,_l);\n        for(re int i(_n-1);i<_l;++i)\n            c0[i]=0;\n    }\n}\n\nint main() {\n    n=read(),m=read();\n    for(re int i(0);i<=n;++i)\n        a[i]=read();\n    for(re int i(0);i<=m;++i)\n        b[i]=read();\n    \n    m=(n>m?n:m)+1;\n    pre(m);init(m*5);\n    getComp(a,b,c,m);\n    \n    for(re int i(0);i<=n;++i)\n        write(c[i]);\n    fwrite(pbuf,1,pp-pbuf,stdout);\n    return 0;\n}\n```",
        "postTime": 1559450239,
        "uid": 126486,
        "name": "yurzhang",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5373 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u590d\u5408\u51fd\u6570\u3011"
    }
]
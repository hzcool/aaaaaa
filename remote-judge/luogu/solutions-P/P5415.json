[
    {
        "content": "~~\u8fd9\u662fYNOI\u7684\u9898\u76ee\uff08~~\n\n\u9ad8\u65af\u6d88\u5143\n\n\u8003\u8651DP\n\n\u9996\u5148\uff0c\u53d1\u73b0\u53ea\u9700\u8981\u8bb0\u5f55\u5f53\u524d\u6240\u5728\u4f4d\u7f6e\u4ee5\u53ca\u64c2\u4e3b\u7684\u8fde\u5c40\u6570\n\n\u8bbe$a_{i,j}$\u8868\u793a\u5f53\u524d\u5728\u7b2c$i$\u4e2a\u4f4d\u7f6e\uff0c\u64c2\u4e3b\u8fde\u5c40\u6570\u4e3a$j$\u65f6\u7684\u80dc\u7387\n\n\u8fd9\u65f6\u5019\u9700\u8981\u5206\u7c7b\u8ba8\u8bba\u4e00\u4e0b\n\n### \u8fb9\u754c\u60c5\u51b5\uff1a\u5df2\u7ecf\u8fde\u80dc$m$\u5c40\n\n\u5982\u679c\u64c2\u4e3b\u662f\u81ea\u5df1\uff0c\u90a3\u4e48\u80dc\u7387\u4e3a$1$\n\n$a_{1,m}=1$\n\n\u5426\u5219\uff0c\u80dc\u7387\u4e3a$0$\n\n$a_{i,m}=0,2 \\leq i \\leq n$\n\n### \u60c5\u51b51\uff1a\u662f\u64c2\u4e3b\n\n\u4e24\u79cd\u53ef\u80fd\uff1a\n\n$\\frac{1}{4}$\u7684\u6982\u7387\u5f53\u64c2\u4e3b\uff0c$\\frac{3}{4}$\u7684\u6982\u7387\u5230\u7b2c$n-2$\u4e2a\u4f4d\u7f6e\uff0c\u8fde\u5c40\u6570\u53d8\u4e3a$1$\n\n$a_{1,j}=\\frac{1}{4}a_{1,j+1}+\\frac{3}{4}a_{n-2,1},1\\leq j <m$\n\n### \u60c5\u51b52\uff1a\u5c06\u8981\u8fdb\u884c\u6e38\u620f\n\n\u8fd9\u65f6\u5019\u9700\u8981\u6839\u636e\u4f4d\u7f6e\u8ba8\u8bba\u6bcf\u4e2a\u4eba\u80dc\u5229\u540e\u7684\u7ed3\u679c\n\n$a_{2,j}=\\frac{1}{4}a_{1,1}+\\frac{1}{4}a_{n-2,j+1}+\\frac{1}{2}a_{n-1,1},1\\leq j <m$\n\n$a_{3,j}=\\frac{1}{4}a_{1,1}+\\frac{1}{4}a_{n-1,j+1}+\\frac{1}{4}a_{n-1,1}+\\frac{1}{4}a_{n,1},1\\leq j <m$\n\n$a_{4,j}=\\frac{1}{4}a_{1,1}+\\frac{1}{4}a_{n-2,j+1}+\\frac{1}{2}a_{n,1},1\\leq j <m$\n\n### \u60c5\u51b53\uff1a\u5728\u961f\u4f0d\u4e2d\n\n\u8fd9\u65f6\u5c31\u770b\u5f53\u524d\u64c2\u4e3b\u662f\u5426\u80fd\u80dc\u5229\u5373\u53ef\n\n$a_{i,j}=\\frac{1}{4}a_{i-3,j+1}+\\frac{3}{4}a_{i-3,1},5\\leq i\\leq n,1\\leq j <m$\n\n### \u6700\u540e\u7b54\u6848\uff1a\n\n\u5f88\u7b80\u5355\uff0c\u5c31\u662f$a_{k,0}$\n\n\u7136\u800c\uff0c\u641e\u5b8c\u8fd9\u4e9b\uff0c\u53d1\u73b0\u4e86\u95ee\u9898\uff1a\u8fd9\u4e9b\u72b6\u6001\u95f4\u4f9d\u8d56\u5173\u7cfb\u6709\u73af\n\n\u4e5f\u5c31\u662f\uff1a\u4e0d\u80fd\u76f4\u63a5DP\n\n\u4e0d\u8fc7\u53d1\u73b0\u72b6\u6001\u6700\u591a$n(m+1)$\u4e2a\n\n\u800c$n\\leq 10,m\\leq 10$\n\n\u4e8e\u662f\u5c31\u53ef\u4ee5\u9ad8\u65af\u6d88\u5143\u4e86\n\n\u5982\u679c\u4e0d\u4f1a\uff0c\u5c31\u53bb\u9898\u5e93\u641c\u677f\u5b50\u5b66\u4e60\u4e00\u4e0b\n\n\u6700\u540e\u590d\u6742\u5ea6$O(n^3m^3)$\n\n\u5176\u5b9e\u6709\u79cd\u505a\u6cd5\u53ef\u4ee5\u505a\u5230$O(n^2m+m^3)$\n\n\u53e6\u5916\uff0c\u53ef\u4ee5\u53d1\u73b0\u53ef\u80fd\u7684\u8f93\u5165\u53ea\u6709$490$\u79cd\n\n~~\u4e8e\u662f\u53ef\u4ee5\u8003\u8651\u6253\u8868\uff08\u6ed1\u7a3d~~\n\n\u6700\u540e\u662f\u4ee3\u7801\uff1a\n\n\u9ad8\u65af\u6d88\u5143\uff1a\n\n```cpp\n#include<cstdio>\nint t,m,n,k;\nconst int N=128;\nconst bool DEBUG=0;\ndouble list[N][N];\n#define abs(x) ((x)>=0?(x):-(x))\nvoid solve(int c){\n\tdouble maxn;int maxp;\n\tfor(int i=0;i<c;i++){\n\t\tmaxn=0;\n\t\tfor(int j=i;j<c;j++){\n\t\t\tif(abs(list[j][i])>maxn){\n\t\t\t\tmaxn=abs(list[j][i]);\n\t\t\t\tmaxp=j;\n\t\t\t}\n\t\t}\n\t\tif(maxn==0)throw 1;\n\t\tdouble t;\n\t\tfor(int j=0;j<=c;j++){\n\t\t\tt=list[i][j];list[i][j]=list[maxp][j];list[maxp][j]=t;\n\t\t}\n\t\tt=list[i][i];\n\t\tfor(int j=0;j<=c;j++){\n\t\t\tlist[i][j]/=t;\n\t\t}\n\t\tfor(int j=i+1;j<c;j++){\n\t\t\tt=list[j][i];\n\t\t\tfor(int k=0;k<=c;k++){\n\t\t\t\tlist[j][k]-=t*list[i][k];\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=c-1;i>=0;i--){\n\t\tfor(int j=i-1;j>=0;j--){\n\t\t\tlist[j][c]-=list[j][i]*list[i][c];\n\t\t\tlist[j][i]=0;\n\t\t}\n\t}\n}\n#define gid(x,y) ((m+1)*(x-1)+(y))\n#define ls (n*(m+1))\nint cnt;\ndouble ans;\nint main(){\n\tscanf(\"%d\",&t);\n\twhile(t--){\n\t\tscanf(\"%d%d%d\",&n,&m,&k);\n\t\tcnt=0;\n\t\tfor(int i=0;i<ls;i++){\n\t\t\tfor(int j=0;j<=ls;j++){\n\t\t\t\tlist[i][j]=0;\n\t\t\t}\n\t\t}\n\t\t//1,m\n\t\tlist[cnt][gid(1,m)]+=1;\n\t\tlist[cnt][ls]+=1;\n\t\tcnt++;\n\t\t//i,m\n\t\tfor(int i=2;i<=n;i++){\n\t\t\tlist[cnt][gid(i,m)]+=1;\n\t\t\tlist[cnt][ls]+=0;\n\t\t\tcnt++;\n\t\t}\n\t\t//1,j\n\t\tfor(int j=0;j<m;j++){\n\t\t\tlist[cnt][gid(1,j)]+=1;\n\t\t\tlist[cnt][gid(n-2,1)]+=-0.75;\n\t\t\tlist[cnt][gid(1,j+1)]+=-0.25;\n\t\t\tlist[cnt][ls]+=0;\n\t\t\tcnt++;\n\t\t}\n\t\t//2,j\n\t\tfor(int j=0;j<m;j++){\n\t\t\tlist[cnt][gid(2,j)]+=1;\n\t\t\tlist[cnt][gid(1,1)]+=-0.25;\n\t\t\tlist[cnt][gid(n-2,j+1)]+=-0.25;\n\t\t\tlist[cnt][gid(n-1,1)]+=-0.5;\n\t\t\tlist[cnt][ls]+=0;\n\t\t\tcnt++;\n\t\t}\n\t\t//3,j\n\t\tfor(int j=0;j<m;j++){\n\t\t\tlist[cnt][gid(3,j)]+=1;\n\t\t\tlist[cnt][gid(1,1)]+=-0.25;\n\t\t\tlist[cnt][gid(n-1,j+1)]+=-0.25;\n\t\t\tlist[cnt][gid(n-1,1)]+=-0.25;\n\t\t\tlist[cnt][gid(n,1)]+=-0.25;\n\t\t\tlist[cnt][ls]+=0;\n\t\t\tcnt++;\n\t\t}\n\t\t//4,j\n\t\tfor(int j=0;j<m;j++){\n\t\t\tlist[cnt][gid(4,j)]+=1;\n\t\t\tlist[cnt][gid(1,1)]+=-0.25;\n\t\t\tlist[cnt][gid(n,j+1)]+=-0.25;\n\t\t\tlist[cnt][gid(n,1)]+=-0.5;\n\t\t\tlist[cnt][ls]+=0;\n\t\t\tcnt++;\n\t\t}\n\t\t//i,j\n\t\tfor(int i=5;i<=n;i++){\n\t\t\tfor(int j=0;j<m;j++){\n\t\t\t\tlist[cnt][gid(i,j)]+=1;\n\t\t\t\tlist[cnt][gid(i-3,j+1)]+=-0.25;\n\t\t\t\tlist[cnt][gid(i-3,1)]+=-0.75;\n\t\t\t\tlist[cnt][ls]+=0;\n\t\t\t\tcnt++;\n\t\t\t}\n\t\t}\n\t\tsolve(ls);\n\t\tans=list[gid(k,0)][ls];\n\t\tprintf(\"%.6lf\\n\",ans);\n\t}\n\t\n}\n```\n\n\u6253\u8868\u751f\u6210\u5668\uff1a\n\n```cpp\n//\u5c06\u6807\u7a0b\u7f16\u8bd1\u540e\uff0c\u91cd\u547d\u540d\u4e3a5415.exe\n//\u7136\u540e\u5c31\u4f1a\u81ea\u52a8\u751f\u62105415_biao.cpp\n#include<bits/stdc++.h>\nusing namespace std;\nofstream fout,gans;ifstream anf;\nstring res;\nint main(){\n\tgans.open(\"5415_biao.cpp\");\n\tgans<<\"#include<iostream>\"<<endl;\n\tgans<<\"using namespace std;\"<<endl;\n\tgans<<\"const string ans[11][11][11]={\"<<endl;\n\tgans<<\"    \";\n\tfor(int n=0;n<4;n++){\n\t\tgans<<\"{},\";\n\t}\n\tgans<<endl;\n\tfor(int n=4;n<=10;n++){\n\t\tgans<<\"    {\"<<endl;\n\t\tgans<<\"        {},\"<<endl;\n\t\tfor(int m=1;m<=10;m++){\n\t\t\tgans<<\"        {\\\"\\\",\";\n\t\t\tfor(int k=1;k<=n;k++){\n\t\t\t\tfout.open(\"5415.in\");\n\t\t\t\tfout<<1<<endl;\n\t\t\t\tfout<<n<<\" \"<<m<<\" \"<<k<<endl;\n\t\t\t\tfout.close();\n\t\t\t\tsystem(\"5415.exe <5415.in >5415.out\");\n\t\t\t\tanf.open(\"5415.out\");\n\t\t\t\tanf>>res;\n\t\t\t\tanf.close();\n\t\t\t\tgans<<\"\\\"\"<<res<<\"\\\",\";\n\t\t\t}\n\t\t\tgans<<\"},\"<<endl;\n\t\t}\n\t\tgans<<\"    },\"<<endl;\n\t}\n\tgans<<\"};\"<<endl;\n\tgans<<\"int t,n,m,k;\"<<endl;\n\tgans<<\"int main(){\"<<endl;\n\tgans<<\"    cin>>t;\"<<endl;\n\tgans<<\"    while(t--){\"<<endl;\n\tgans<<\"        cin>>n>>m>>k;\"<<endl;\n\tgans<<\"        cout<<ans[n][m][k]<<endl;\"<<endl;\n\tgans<<\"    }\"<<endl;\n\tgans<<\"}\"<<endl;\n}\n```\n",
        "postTime": 1561207655,
        "uid": 86649,
        "name": "Hope2075",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P5415 \u3010[YNOI2019]\u6e38\u620f\u3011"
    },
    {
        "content": "**YNOIer \u4e0d\u8bf7\u81ea\u6765**\n\n\u9a6c\u4e0a\u5c31\u8981\u7701\u9009\u4e86\uff0c\u60f3\u7740\u5237\u4e00\u4e0b\u5386\u5e74\u7684\u771f\u9898\uff0c\u719f\u6089\u4e00\u4e0b\u73af\u5883\uff0c~~\u6bd5\u7adf\u8fd9\u662f YNOI~~\u3002\n\n# \u601d\u8def\u5206\u6790\n\n\u7531\u4e8e\u7814\u7a76\u5bf9\u8c61\u53ea\u662f\u7b2c $k$ \u4e2a\u4eba\u8fd9\u4e00\u4e2a\u4eba\uff0c\u90a3\u4e48\u72b6\u6001\u80af\u5b9a\u4e0d\u662f\u6709\u7b2c $i$ \u4e2a\u4eba\u8fd9\u4e00\u9879\u7684\u3002\u540c\u65f6\u53c8\u56e0\u4e3a\u8fd9\u4e9b\u4eba\u662f\u4e00\u4e2a\u8f6e\u6362\u7684\u5173\u7cfb\uff0c\u90a3\u6211\u4eec\u4e0d\u5982\u8bbe\u8fd9\u4e2a\u4eba\u662f\u5728\u4f4d\u7f6e $i(1 \\leq i \\leq n)$ \uff0c\u5176\u4e2d\u4f4d\u7f6e\u6307\u7684\u662f\u5b83\u4eec\u5728\u961f\u5217\u4e2d\u6392\u7b2c\u51e0\u4e2a\u3002\u53e6\u5916\u4e00\u4e2a\u5f71\u54cd\u8fd9\u4e2a\u4eba\u80dc\u5229\u4e0e\u5426\u7684\u56e0\u7d20\u662f\u64c2\u4e3b\u7684\u80dc\u8d1f\uff0c\u5373\u64c2\u4e3b\u7684\u8fde\u80dc\u5c40\u6570\u3002\u90a3\u4e48\u6211\u4eec\u72b6\u6001\u8bbe\u7684\u5bf9\u4e0d\u5bf9\u5462\uff1f\u4ece\u9762\u5411\u6570\u636e\u7f16\u7a0b\u7684\u89d2\u5ea6\u8003\u8651\uff0c\u4e24\u5c42\u72b6\u6001\uff0c\u8f6c\u79fb\u662f $O(nm)$ \u7684\uff0c\u7136\u540e\u6982\u7387 DP \u5927\u6982\u7387\u8981\u9ad8\u65af\u6d88\u5143\uff0c\u90a3\u603b\u590d\u6742\u5ea6 $O(n^3m^3)$\uff0c\u548c\u6570\u636e\u8303\u56f4\u76f8\u7b26\u5408\u3002\u6240\u4ee5\u6211\u4eec\u6700\u7ec8\u5f97\u51fa\u4e86\uff1a\n\n\u8bbe $f_{i,j}$ \u4e3a\u5f53\u524d\u4f4d\u7f6e\u4e3a $i$\uff0c\u64c2\u4e3b\u8fde\u80dc\u5c40\u6570\u4e3a $j$ \u65f6\u7684\u6e38\u620f\u83b7\u80dc\u6982\u7387\uff0c\u6211\u4eec\u8981\u6c42\u7684\u662f $f_{k,0}$\u3002\n\n\u8fb9\u754c\u72b6\u6001\uff1a\u5df2\u7ecf\u8fde\u80dc $m$ \u5c40\n\n$f_{1,m}=1$\uff0c$f_{i,m}=0 (2 \\leq i \\leq n)$\n\n\u81ea\u5df1\u662f\u64c2\u4e3b\uff1a\n\n\u8981\u4e48\u63a5\u7740\u5b88\u64c2\uff0c\u8981\u4e48\u88ab\u6253\u8d25\uff0c\u6389\u5230\u7b2c $n-2$ \u4e2a\u4f4d\u7f6e\u3002\n\n$f_{1,j}=\\dfrac 14 f_{1,j+1}+\\dfrac 34 f_{n-2,1}$\n\n\u81ea\u5df1\u8fdb\u884c\u6e38\u620f\uff1a\n\n\u8981\u4e48\u81ea\u5df1\u6210\u4e3a\u4e86\u64c2\u4e3b\uff0c\u8981\u4e48\u88ab\u6253\u8d25\uff0c\u8c03\u56de\u53bb\u3002\u5176\u4e2d\u88ab\u6253\u8d25\u8981\u6ce8\u610f\u5206\u7c7b\uff0c\u770b\u770b\u64c2\u4e3b\u6709\u6ca1\u6709\u548c\u81ea\u5df1\u4e00\u8d77\u88ab\u6253\u8d25\uff0c\u53bb\u5230\u4e86\u81ea\u5df1\u524d\u8fb9\u8fd8\u662f\u8bf4\u662f\u64c2\u4e3b\u6253\u8d25\u4e86\u4f60\u4eec\u4e09\u4e2a\u3002\u6ce8\u610f\u8fd9\u56db\u79cd\u60c5\u51b5\uff0c\u6709\u7740\u4e0d\u540c\u7684\u4eba\u7684\u987a\u5e8f\u3002\n\n$f_{2,j}=\\dfrac 14 f_{1,1}+\\dfrac 14f_{n-2,j+1}+\\dfrac 12 f_{n-1,1}$\n\n$f_{3,j}=\\dfrac 14 f_{1,1}+\\dfrac 14f_{n-1,j+1}+\\dfrac 14 f_{n-1,1}+\\dfrac 14 f_{n,1}$\n\n$f_{4,j}=\\dfrac 14 f_{1,1}+\\dfrac 14f_{n,j+1}+\\dfrac 12 f_{n,1}$\n\n\u5728\u7b49\u5f85\u961f\u5217\u4e2d\uff1a\n\n\u54b1\u7684\u547d\u8fd0\u7531\u64c2\u4e3b\u51b3\u5b9a\u3002\u64c2\u4e3b\u8981\u4e48\u5b88\u64c2\uff0c\u8981\u4e48\u66f4\u65b0\u6362\u4ee3\u3002\n$f_{i,j}=\\dfrac 14f_{i-3,j+1}+\\dfrac 34f_{i-3,1}$\n\n\u6700\u540e\u53d1\u73b0\uff0c\u72b6\u6001\u4f9d\u8d56\u4e4b\u95f4\u771f\u7684\u6709\u73af\uff01\u8981\u9ad8\u65af\u6d88\u5143\u3002\n\n\u53cd\u6b63\u628a\u4e8c\u7ef4\u7684\u6620\u5c04\u5230\u4e00\u7ef4\u91cc\u5c31\u53ef\u4ee5\u9ad8\u65af\u6d88\u5143\u4e86\u3002\n\n\u590d\u6742\u5ea6 $O((nm)^3)$\u3002\n\n\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u6253\u8868\uff08\u5927\u96fe\uff09\u3002\n\n\u53e6\u5916\uff0c\u542c\u5b66\u957f\u8bf4\uff0c\u4e8b\u5b9e\u4e0a\u5728\u53bb\u5e74\u7684 YNOI\uff0c\u4f60\u53ea\u7528 `cout<<0` \u5c31\u80fd\u53d6\u5f97 30 \u5206\u7684\u597d\u6210\u7ee9\u3002\n\n## Code\n```cpp\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\nconst int maxn=110;\nnamespace QiFeng233{\n\tint t,n,m,k,s,c;\n\tdouble a[maxn][maxn],ans[maxn];\n\tint pos(int x,int y){\n\t\treturn (x-1)*(m+1)+y;\n\t}\n\tvoid gauss(int x){\n\t\tfor(int i=0;i<x;++i){\n\t\t\tint row=i;\n\t\t\t//\u63a5\u4e0b\u6765\u4e3a\u4e86\u51cf\u5c0f\u8bef\u5dee\uff0c\u627e\u7cfb\u6570\u6700\u5927\u7684\u4e00\u884c \n\t\t\tfor(int j=i;j<x;++j){\n\t\t\t\tif(fabs(a[row][i])<fabs(a[j][i]))\n\t\t\t\t\trow=j;\n\t\t\t}\n\t\t\tif(row!=i)std::swap(a[row],a[i]);\n\t\t\tdouble div1=a[i][i];\n\t\t\tfor(int j=0;j<=x;++j)\n\t\t\t\ta[i][j]/=div1;\n\t\t\tfor(int j=i+1;j<x;++j){\n\t\t\t\tdouble div2=a[j][i];\n\t\t\t\tfor(int k=0;k<=x;++k){\n\t\t\t\t\ta[j][k]-=a[i][k]*div2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=x-1;i>=0;i--){\n\t\t\tfor(int j=i-1;j>=0;j--){\n\t\t\t\ta[j][x]-=a[j][i]*a[i][x];\n\t\t\t\ta[j][i]=0;\n\t\t\t}\n\t\t}\n\t}\n\tvoid solve(){\n\t\tscanf(\"%d\",&t);//t==1,\u8279\n\t\tscanf(\"%d%d%d\",&n,&m,&k);\n\t\ts=n*(m+1);\n\t\t//1,m\n\t\ta[c][pos(1,m)]+=1;\n\t\ta[c][s]+=1;\n\t\t++c;\n\t\t//i,m\n\t\tfor(int i=2;i<=n;++i){\n\t\t\ta[c][pos(i,m)]+=1;\n\t\t\t++c;\n\t\t}\n\t\t//1,j\n\t\tfor(int j=0;j<m;++j){\n\t\t\ta[c][pos(1,j)]+=1;\n\t\t\ta[c][pos(1,j+1)]-=0.25;\n\t\t\ta[c][pos(n-2,1)]-=0.75;\n\t\t\t++c;\n\t\t}//2,j\n\t\tfor(int j=0;j<m;++j){\n\t\t\ta[c][pos(2,j)]+=1;\n\t\t\ta[c][pos(1,1)]-=0.25;\n\t\t\ta[c][pos(n-2,j+1)]-=0.25;\n\t\t\ta[c][pos(n-1,1)]-=0.5;\n\t\t\t++c;\n\t\t}\n\t\t//3,j\n\t\tfor(int j=0;j<m;++j){\n\t\t\ta[c][pos(3,j)]+=1;\n\t\t\ta[c][pos(1,1)]-=0.25;\n\t\t\ta[c][pos(n-1,j+1)]-=0.25;\n\t\t\ta[c][pos(n-1,1)]-=0.25;\n\t\t\ta[c][pos(n,1)]-=0.25;\n\t\t\t++c;\n\t\t}\n\t\t//4,j\n\t\tfor(int j=0;j<m;++j){\n\t\t\ta[c][pos(4,j)]+=1;\n\t\t\ta[c][pos(1,1)]-=0.25;\n\t\t\ta[c][pos(n,j+1)]-=0.25;\n\t\t\ta[c][pos(n,1)]-=0.5;\n\t\t\t++c;\n\t\t}\n\t\t//i,j\n\t\tfor(int i=5;i<=n;++i){\n\t\t\tfor(int j=0;j<m;++j){\n\t\t\t\ta[c][pos(i,j)]+=1;\n\t\t\t\ta[c][pos(i-3,j+1)]-=0.25;\n\t\t\t\ta[c][pos(i-3,1)]-=0.75; \n\t\t\t\t++c;\n\t\t\t}\n\t\t}\n\t\tgauss(s);\n\t\tprintf(\"%.6lf\",a[pos(k,0)][s]);\n\t} \n}\nsigned main(){\n\tQiFeng233::solve();\n\treturn 0;\n}\n```",
        "postTime": 1591807772,
        "uid": 233357,
        "name": "QiFeng233",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5415 \u3010[YNOI2019]\u6e38\u620f\u3011"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u79cd $\\mathcal O(n^2m+n^3)$ \u7684\u5199\u6cd5\u3002\n\n[\u9898\u76ee\u4f20\u9001\u95e8](/problem/P5415)\n\n#### \u524d\u7f6e\u77e5\u8bc6\uff1a\n\n\u671f\u671b dp\uff0c\u9ad8\u65af\u6d88\u5143\u3002\n\n#### \u9898\u610f\uff1a\n\n- $n$ \u4e2a\u4eba\u6392\u6210\u4e00\u961f\uff0c\u8fdb\u884c\u82e5\u5e72\u8f6e\u6bd4\u8d5b\u3002\u6bcf\u8f6e\u4ece\u961f\u9996\u7684\u524d\u56db\u4e2a\u4eba\u4e2d\u7b49\u6982\u7387\u9009\u51fa\u4e00\u4e2a\u4eba\u8d62\u5f97\u8be5\u8f6e\uff0c\u8fd9\u4e2a\u4eba\u7ee7\u7eed\u7559\u5728\u961f\u9996\uff1b\u5176\u4ed6\u4e09\u4eba\u6309\u987a\u5e8f\u6392\u5230\u961f\u5c3e\u3002\n- \u82e5\u6709\u4eba\u8fde\u7eed\u8d62\u5f97 $m$ \u8f6e\u6bd4\u8d5b\uff0c\u5219\u4ed6\u80dc\u51fa\uff0c\u4e14\u6e38\u620f\u7ed3\u675f\u3002\u95ee\u7b2c $k$ \u4e2a\u4eba\u80dc\u51fa\u7684\u6982\u7387\u3002\n- $n,m\\le10$\u3002\n\n#### \u5206\u6790\uff1a\n\n\u4e3a\u9632\u6b62\u91cd\u540d\uff0c\u5c06\u9898\u76ee\u4e2d\u7684 $k$ \u8bb0\u4e3a $K$\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u5c40\u9762\uff0c\u67d0\u4e2a\u4eba\u83b7\u80dc\u7684\u6982\u7387\u53ea\u4e0e\u4ed6\u7684\u4f4d\u7f6e $k$ \u548c\u7b2c\u4e00\u4e2a\u4eba\u76ee\u524d\u8fde\u7eed\u8d62\u5f97\u7684\u8f6e\u6570 $i$ \u6709\u5173\u3002\u6240\u4ee5\u8bb0 $dp_{i,k}$ \u8868\u793a\u7b2c\u4e00\u4e2a\u4eba\u76ee\u524d\u8fde\u7eed\u8d62\u5f97\u4e86 $i$ \u8f6e\u7684\u60c5\u51b5\u4e0b\uff0c\u7b2c $k$ \u4e2a\u4eba\u80dc\u51fa\u7684\u6982\u7387\u3002\n\n\u8003\u8651\u5982\u4f55\u8f6c\u79fb\u3002\u5728\u4e0b\u4e00\u8f6e\u6bd4\u8d5b\u4e2d\uff0c$i$ \u7684\u6539\u53d8\u4e0e\u7b2c\u4e00\u4e2a\u4eba\u662f\u5426\u7ee7\u7eed\u8d62\u5f97\u8be5\u8f6e\u6709\u5173\uff0c\u7b2c $k$ \u4e2a\u4eba\u7684\u65b0\u4f4d\u7f6e\u4e0e $k$ \u5f53\u524d\u7684\u503c\u6709\u5173\u3002\u5177\u4f53\u5730\uff0c\u5206\u4e3a\u4e09\u7c7b\uff1a\n\n1. $k=1$\u3002\u6b64\u65f6\uff1a\n   - \u6709 $\\frac14$ \u7684\u6982\u7387\u7b2c $k$ \u4e2a\u4eba\u8d62\u5f97\u8be5\u8f6e\uff0c\u4ecd\u7136\u7559\u5728\u961f\u9996\uff0c$i$ \u589e\u52a0 $1$\uff1b\n   - \u6709 $\\frac34$ \u7684\u6982\u7387\u5176\u4ed6\u4eba\u8d62\u5f97\u8be5\u8f6e\uff0c$i$ \u53d8\u4e3a $1$\uff0c\u7b2c $k$ \u4e2a\u4eba\u4f1a\u5230\u7b2c $n-2$ \u4e2a\u4f4d\u7f6e\u3002\n2. $2\\le k\\le4$\u3002\u6b64\u65f6\uff1a\n   - \u6709 $\\frac14$ \u7684\u6982\u7387\u7b2c\u4e00\u4e2a\u4eba\u8d62\u5f97\u8be5\u8f6e\uff0c$i$ \u589e\u52a0 $1$\uff0c\u7b2c $k$ \u4e2a\u4eba\u5230\u7b2c $n-4+k$ \u4e2a\u4f4d\u7f6e\uff1b\n   - \u6709 $\\frac{k-2}4$ \u7684\u6982\u7387\u7b2c\u4e00\u4e2a\u4eba\u4e0e\u7b2c $k$ \u4e2a\u4eba\u4e4b\u95f4\u7684\u67d0\u4e2a\u4eba\u8d62\u5f97\u8be5\u8f6e\uff0c$i$ \u53d8\u4e3a $1$\uff0c\u7b2c $k$ \u4e2a\u4eba\u4e5f\u5230\u7b2c $n-4+k$ \u4e2a\u4f4d\u7f6e\uff1b\n   - \u6709 $\\frac14$ \u7684\u6982\u7387\u7b2c $k$ \u4e2a\u4eba\u8d62\u5f97\u8be5\u8f6e\uff0c\u5230\u8fbe\u961f\u9996\uff0c$i$ \u53d8\u4e3a $1$\uff1b\n   - \u6709 $\\frac{4-k}4$ \u7684\u7b2c $k$ \u4e2a\u4eba\u540e\u9762\u7684\u67d0\u4e2a\u4eba\u8d62\u5f97\u8be5\u8f6e\uff0c$i$ \u53d8\u4e3a $1$\uff0c\u7b2c $k$ \u4e2a\u4eba\u5230\u7b2c $n-3+k$ \u4e2a\u4f4d\u7f6e\u3002\n3. $k>4$\u3002\u6b64\u65f6\uff1a\n   - \u6709 $\\frac14$ \u7684\u6982\u7387\u7b2c\u4e00\u4e2a\u4eba\u8d62\u5f97\u8be5\u8f6e\uff0c$i$ \u589e\u52a0 $1$\uff0c\u7b2c $k$ \u4e2a\u4eba\u5230\u7b2c $k-3$ \u4e2a\u4f4d\u7f6e\uff1b\n   - \u6709 $\\frac34$ \u7684\u6982\u7387\u5176\u4ed6\u4eba\u8d62\u5f97\u8be5\u8f6e\uff0c$i$ \u53d8\u4e3a $1$\uff0c\u7b2c $k$ \u4e2a\u4eba\u8fd8\u662f\u5230\u7b2c $k-3$ \u4e2a\u4f4d\u7f6e\u3002\n\n\u6574\u7406\u4e00\u4e0b\uff0c\u6709\uff1a\n$$\ndp_{i,k}=\\begin{cases}\n\\dfrac{dp_{i+1,\\,1}+3dp_{1,\\,n-2}}4&k=1\\\\\n\\dfrac{dp_{i+1,\\,n-4+k}+(k-2)dp_{1,\\,n-4+k}+dp_{1,\\,1}+(4-k)dp_{1,\\,n-3+k}}4&2\\le k\\le4\\\\\n\\dfrac{dp_{i+1,\\,k-3}+3dp_{1,\\,k-3}}4&k>4\n\\end{cases}\n$$\n\u8fb9\u754c\u60c5\u51b5\u662f\uff1a\n$$\ndp_{m,k}=\\begin{cases}\n1&k=1\\\\\n0&k\\ne1\n\\end{cases}\n$$\n\n\u7b54\u6848\u662f $dp_{0,K}$\u3002\n\n\u5171\u6709 $\\mathcal O(nm)$ \u4e2a\u72b6\u6001\uff0c\u76f4\u63a5\u9ad8\u65af\u6d88\u5143\u5373\u53ef\u505a\u5230 $\\mathcal O(n^3m^3)$\u3002\n\n\u4f46\u6ce8\u610f\u5230\u6211\u4eec\u5217\u51fa\u65b9\u7a0b\u53ea\u9700\u8981 $\\mathcal O(nm)$ \u7684\u65f6\u95f4\u3002\u80fd\u4e0d\u80fd\u5e73\u8861\u4e00\u4e0b\uff1f\n\n\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u9009\u51fa $n$ \u4e2a\u72b6\u6001\u4f5c\u4e3a\u201c\u7279\u6b8a\u72b6\u6001\u201d\uff0c\u5c06\u5176\u4ed6\u72b6\u6001\u53ea\u7528\u201c\u7279\u6b8a\u72b6\u6001\u201d\u548c\u5e38\u6570\u8868\u793a\u51fa\u6765\uff0c\u5bf9\u53ea\u5305\u542b\u201c\u7279\u6b8a\u72b6\u6001\u201d\u548c\u5e38\u6570\u7684\u5173\u7cfb\u5f0f\u8fdb\u884c\u6d88\u5143\u3002\u5bf9\u5355\u4e2a\u72b6\u6001\u7528 $n$ \u4e2a\u503c\u8868\u793a\uff0c\u590d\u6742\u5ea6 $\\mathcal O(n)$\uff0c\u8868\u793a\u6240\u6709\u72b6\u6001\u590d\u6742\u5ea6 $\\mathcal O(n^2m)$\uff1b\u9ad8\u65af\u6d88\u5143\u590d\u6742\u5ea6\u590d\u6742\u5ea6\u964d\u81f3 $\\mathcal O(n^3)$\u3002\n\n\u5177\u4f53\u5730\uff0c\u89c2\u5bdf\u4e0a\u8ff0\u5f0f\u5b50\uff0c\u53d1\u73b0 $dp_{i,k}$ \u53ea\u4e0e\u4e00\u4e2a $dp_{i+1,\\,...}$ \u548c\u82e5\u5e72 $dp_{1,\\,...}$ \u6709\u5173\u3002\u6545\u53ef\u4ee5\u4ee4 $dp_{1,k}$ \u4e3a\u7279\u6b8a\u72b6\u6001\uff0c\u5e76\u4ece $m-1$ \u5230 $1$ \u679a\u4e3e $i$\u3002\u8fd9\u6837\u679a\u4e3e\u5230\u67d0\u4e2a $i$ \u65f6\uff0c\u6240\u6709 $dp_{i+1,\\,...}$\uff08\u5f53 $i=m-1$ \u65f6\u5373\u4e3a\u8fb9\u754c\u6761\u4ef6\uff09\u5982\u4f55\u7528\u7279\u6b8a\u72b6\u6001\u548c\u5e38\u6570\u8868\u793a\u6211\u4eec\u5747\u5df2\u77e5\uff0c\u6545\u4e5f\u53ef\u4ee5\u5c06 $dp_{i,k}$ \u7528\u7279\u6b8a\u72b6\u6001\u548c\u5e38\u6570\u8868\u793a\u51fa\u6765\u3002\u5f53\u8868\u793a\u5230 $i=1$\uff0c\u5373\u7279\u6b8a\u72b6\u6001\u672c\u8eab\u65f6\uff0c\u6211\u4eec\u5c31\u5f97\u5230\u4e86 $n$ \u6761\u53ea\u5305\u542b\u7279\u6b8a\u72b6\u6001\u548c\u5e38\u6570\u7684\u5173\u7cfb\u5f0f\u3002\u9ad8\u65af\u6d88\u5143\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n^2m+n^3)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n^2m)$\u3002\n\n---\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int mN=10+3;\nint n, m, K;\n\ndouble a[mN][mN], f[mN][mN][mN];\n//f[i][k][j] \u8868\u793a dp[i][k] \u7684\u8868\u8fbe\u5f0f\u4e2d\uff0c\u7b2c dp[1][j] \u9879\u7684\u7cfb\u6570\u3002\n//f[i][k][n+1] \u8868\u793a\u5e38\u6570\u3002\ninline void plus4(double *f, double *g) {\t//f \u52a0\u4e0a 1/4 \u7684 g\u3002\n\tfor(int j=1; j<=n+1; ++j) {\n\t\tf[j]+=g[j]/4;\n\t}\n}\nvoid gauss() {\n\tfor(int k=1; k<=n; ++k) {\n\t\tdouble tmp=abs(a[k][k]);\n\t\tint nxti=k;\n\t\tfor(int i=k+1; i<=n; ++i) {\n\t\t\tif(abs(a[i][k])>tmp) {\n\t\t\t\ttmp=abs(a[i][k]);\n\t\t\t\tnxti=i;\n\t\t\t}\n\t\t}\n\t\tif(nxti!=k) {\n\t\t\tfor(int j=k; j<=n+1; ++j) {\n\t\t\t\tswap(a[k][j], a[nxti][j]);\n\t\t\t}\n\t\t}\n\t\tfor(int i=1; i<=n; ++i) if(i!=k) {\n\t\t\ttmp=a[i][k]/a[k][k];\n\t\t\tfor(int j=k; j<=n+1; ++j) {\n\t\t\t\ta[i][j]-=a[k][j]*tmp;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1; i<=n; ++i) {\n\t\ta[i][n+1]/=a[i][i];\n\t}\n}\n\nint main() {\n\n\tint T_T;\n\tscanf(\"%d\", &T_T);\n\twhile(T_T--) {\n//\t\tmemset(a, 0, sizeof a);\n//\t\tmemset(f, 0, sizeof f);\n\n\t\tscanf(\"%d%d%d\", &n, &m, &K);\n\t\tfor(int k=1; k<=n; ++k) {\n\t\t\tf[m][k][n+1]=k==1;\n\t\t}\n\t\tfor(int i=m-1; i>=1; --i) {\n\t\t\tplus4(f[i][1], f[i+1][1]);\n\t\t\tf[i][1][n-2]+=3/4.;\n\t\t\tfor(int k=2; k<=4; ++k) {\n\t\t\t\tplus4(f[i][k], f[i+1][n-4+k]);\n\t\t\t\tf[i][k][1]+=1/4.;\n\t\t\t\tf[i][k][n-4+k]+=(k-2)/4.;\n\t\t\t\tf[i][k][n-3+k]+=(4-k)/4.;\n\t\t\t}\n\t\t\tfor(int k=5; k<=n; ++k) {\n\t\t\t\tplus4(f[i][k], f[i+1][k-3]);\n\t\t\t\tf[i][k][k-3]+=3/4.;\n\t\t\t}\n\t\t}\n\t\tfor(int k=1; k<=n; ++k) {\n\t\t\tfor(int j=1; j<=n; ++j) {\n\t\t\t\ta[k][j]=-f[1][k][j];\n\t\t\t}\n\t\t\ta[k][n+1]=f[1][k][n+1];\n\t\t\ta[k][k]+=1;\n\t\t}\n\t\tgauss();\n\t\tdouble ans;\n\t\tif(K==1) {\t//\u8ba1\u7b97 dp[K][0]\n\t\t\tans=(a[1][n+1]+a[n-2][n+1]*3)/4;\n\t\t} else if(K<=4) {\n\t\t\tans=(a[1][n+1]+a[n-4+K][n+1]*(K-1)+a[n-3+K][n+1]*(4-K))/4;\n\t\t} else {\n\t\t\tans=a[K-3][n+1];\n\t\t}\n\t\tprintf(\"%.6f\\n\", ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1675169314,
        "uid": 364963,
        "name": "\u963f\u4e11",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5415 [YNOI2019] \u6e38\u620f"
    }
]
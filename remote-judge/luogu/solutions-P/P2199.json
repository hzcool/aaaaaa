[
    {
        "content": "```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define N 16385\nconst int INF=0x3f3f3f3f;\nconst int dx[]={0,0,1,-1};\nconst int dy[]={1,-1,0,0};\nconst int ddx[]={0,0,1,1,1,-1,-1,-1};\nconst int ddy[]={1,-1,-1,0,1,-1,0,1};\nstring s[N];//n*m<=16000\nvector<int> dis[N];\nstruct node\n{\n    int x,y;\n};\nint n,m;\nqueue<node> q;\nbool ok(int x,int y)\n{\n    return x>=0 && x<n && y>=0 && y<m && s[x][y]=='O';\n}\nvoid bfs(int sx,int sy)\n{\n    for(int i=0;i<n;++i)\n        for(int j=0;j<m;++j)\n            dis[i][j]=INF;\n    q.push(node{sx,sy});\n    dis[sx][sy]=0;\n    while(!q.empty())\n    {\n        int x=q.front().x;\n        int y=q.front().y;\n        q.pop();\n        for(int i=0;i<4;++i)//\u56db\u4e2a\u65b9\u5411\n        {\n            int xx=x+dx[i];\n            int yy=y+dy[i];\n            if(ok(xx,yy) && dis[xx][yy]==INF)\n            {\n                dis[xx][yy]=dis[x][y]+1;\n                q.push(node{xx,yy});\n            }\n        }\n    }\n}\nint main()\n{\n    cin>>n>>m;\n    for(int i=0;i<n;++i)\n    {\n        cin>>s[i];\n        dis[i].resize(m+1);//\u89c4\u5b9a\u6bcf\u4e2avector\u957f\u5ea6\n    }\n    int sx,sy,ex,ey;\n    while(cin>>ex>>ey>>sx>>sy)\n    {\n        if(!ex&&!ey&&!sx&&!sy) break;\n        --ex;--ey;--sx;--sy;\n        bfs(sx,sy);\n        int ans=dis[ex][ey];\n        for(int i=0;i<8;++i)\n        {\n            int x=ex,y=ey;\n            while(ok(x+ddx[i],y+ddy[i]))\n            {\n                x+=ddx[i];\n                y+=ddy[i];\n                ans=min(ans,dis[x][y]);\n            }\n        }\n        if(ans==INF) puts(\"Poor Harry\");\n        else printf(\"%d\\n\",ans);\n    }\n    return 0;\n}\n```",
        "postTime": 1531033048,
        "uid": 55859,
        "name": "Alanalan",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2199 \u3010\u6700\u540e\u7684\u8ff7\u5bab\u3011"
    },
    {
        "content": "\u6570\u636e\u8303\u56f4\u662fNxM<=16384\uff0c\u867d\u7136\u7ecf\u8fc7\u5176\u4ed6dalao\u7684\u6d4b\u8bd5\u662f\u53ef\u4ee5\u75281600x1600\u7684\u4e8c\u7ef4\u6570\u7ec4\u5b58\u4e0b\u7684\uff0c\u4f46\u5728\u4e0d\u77e5\u9053\u8fd9\u4e00\u70b9\u7684\u60c5\u51b5\u4e0b\uff0c\u4fdd\u9669\u8d77\u89c1\u6700\u597d\u628a\u4e8c\u7ef4\u5750\u6807\u7528\u4e00\u7ef4\u8868\u793a\u5427\u3002\u5176\u4ed6\u5730\u65b9\u53d8\u5316\u4e0d\u5927\uff0c\u53ea\u662f\u641c\u7d22\u7684\u65f6\u5019\u8981\u8fdb\u884c\u8f6c\u5316\u3002\n\n\u9898\u76ee\u6240\u6c42\u662f\u770b\u5230\u5956\u676f\u81f3\u5c11\u8d70\u51e0\u6b65\uff0c\u6240\u4ee5\u9996\u5148\u4ece\u7ec8\u70b9\u5f00\u59cb\u5411\u516b\u4e2a\u65b9\u5411\u641c\u7d22\uff0c\u628a\u80fd\u770b\u5230\u5956\u676f\u7684\u70b9\u76f4\u63a5\u6807\u8bb0\u4e00\u4e0b\u3002\n\n\u8d77\u70b9\u65f6\u95f4\u8bb0\u4e3a0\uff0c\u5728BFS\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u76f4\u63a5\u6c42\u51fa\u5230\u5176\u5b83\u70b9\u9700\u8981\u7684\u65f6\u95f4\uff0c\u5982\u679c\u53d1\u73b0\u961f\u9996\u7684\u70b9\u6240\u8868\u793a\u7684\u4f4d\u7f6e\u5df2\u7ecf\u53ef\u4ee5\u770b\u5230\u5956\u676f\u4e86\uff0c\u76f4\u63a5\u8f93\u51fa\u8fd9\u4e2a\u70b9\u7684\u65f6\u95f4\u5c31\u597d\u4e86\u3002\n\n\u4e0b\u9762\u662f\u4ee3\u7801(\u98ce\u683c\u5f88\u5dee\u5e76\u4e14\u5f88\u6c34):\n```cpp\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\n#include<queue>\nusing namespace std;\n\nint cg[32768],zd[32768],ti[32768],inq[32768];\nchar s[32768];\nint n,m,sx,sy,ex,ey,sp,ep,resu,rex,rey;\nint dirx[8]={-1,-1,0,1,1,1,0,-1},diry[8]={0,-1,-1,-1,0,1,1,1};\n//\u516b\u4e2a\u65b9\u5411\nqueue<int> q;\n\n//\u628a\u4e8c\u7ef4\u8f6c\u5316\u6210\u4e00\u7ef4\uff0c\u6bd4\u5982\u5bbd\u5ea6\u4e3a7\u7684\u65f6\u5019\uff0c(1,1)\u5c31\u662f1\uff0c(1,2)\u5c31\u662f2\uff0c(2,1)\u5c31\u662f8\nint dtos(int x,int y)\n{\n    if(x<1||x>n||y<1||y>m) return 0;\n    //\u8fd9\u4e2a\u8868\u793a\u70b9\u8d8a\u754c\u4e86\u5c31\u4e0d\u8981\u8ba1\u7b97\u4e86\n    int k=m*(x-1)+y;\n    resu=k;\n    //\u4e3a\u4e86\u65b9\u4fbf\u7528\u5168\u5c40\u53d8\u91cf\u5b58\u4e86\u7ed3\u679c\n    if(k<1||k>m*n) return 0;\n    return k;\n}\n\n//\u628a\u4e00\u7ef4\u8f6c\u5316\u6210\u4e8c\u7ef4\uff0c\u7ed3\u679c\u5b58\u5728\u5168\u5c40\u53d8\u91cf\u91cc(\u8c01\u8ba9\u6211\u4e0d\u77e5\u9053\u600e\u4e48\u8fd4\u56de\u4e24\u4e2a\u503c)\nint stod(int k)\n{\n    rex=(k-1)/m+1;\n    rey=k-(rex-1)*m;\n}\n\nint main()\n{\n//\tfreopen(\"1.txt\",\"r\",stdin);\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=n;i++)\n    {\n        scanf(\"%s\",&s);\n        for(int j=0;j<m;j++)\n            if(s[j]=='O') cg[m*(i-1)+j+1]=1;\n            else cg[m*(i-1)+j+1]=0;\n        //\u8bfb\u5165\u65f6\u6807\u8bb0\u80fd\u4e0d\u80fd\u5230\u8fbe\uff0c\u76f4\u63a5\u4e8c\u7ef4\u8f6c\u4e00\u7ef4\u8868\u793a\u4e86\n    }\n    while(1)\n    {\n        scanf(\"%d%d%d%d\",&ex,&ey,&sx,&sy);\n        if(!ex) break;\n        \n        //\u4e0b\u9762\u56db\u884c\u90fd\u662f\u91cd\u65b0\u5f00\u59cb\u4e00\u4e2a\u65b0\u7684\u60c5\u51b5\n        while(!q.empty()) q.pop();\n        memset(zd,0,sizeof(zd));\n        memset(ti,0,sizeof(ti));\n        memset(inq,0,sizeof(inq));\n        \n        //\u4ece\u7ec8\u70b9\u5411\u516b\u4e2a\u65b9\u5411\u641c\u7d22\n        for(int i=0;i<8;i++)\n        {\n            int ix=ex,iy=ey;\n            while(dtos(ix,iy))//\u51fd\u6570\u5df2\u7ecf\u5e26\u6709\u5bf9\u662f\u5426\u8d8a\u754c\u7684\u5224\u65ad\n            {\n                if(!cg[resu]) break;\n                //\u649e\u5899\u5c31\u4e0d\u8981\u7ee7\u7eed\u641c\u4e86\n                zd[resu]=1;\n                ix+=dirx[i];\n                iy+=diry[i];\n            }\n        }\n        //\u8d77\u70b9\u5165\u961f\uff0cinq\u8868\u793a\u8fd9\u4e2a\u70b9\u8bbf\u95ee\u8fc7\u4e86\n        q.push(dtos(sx,sy));\n        inq[dtos(sx,sy)]=1;\n        ti[dtos(sx,sy)]=0;\n        while(!q.empty())\n        {\n            int t=q.front();\n            if(zd[t])\n            {\n                printf(\"%d\\n\",ti[t]);\n                goto next;\n                //\u7ed3\u675f\u540e\u5c31\u53bb\u8bfb\u53d6\u4e0b\u4e00\u7ec4\u6570\u636e\n            }\n            q.pop();\n            \n            //\u628a\u4e00\u7ef4\u8f6c\u6210\u4e8c\u7ef4\u8fdb\u884cBFS\n            stod(t);\n            int tx=rex,ty=rey;\n            \n            //\u7528\u4e00\u4e2a\u53d8\u91cf\u6682\u5b58\u8fd9\u4e2a\u70b9\u7684\u4e00\u7ef4\u5750\u6807\u8868\u793a\uff0c\u5426\u5219\u91cd\u590d\u6267\u884cdtos\u51fd\u6570\u7684\u65f6\u5019resu\u7684\u503c\u4f1a\u88ab\u6539\u53d8\n            int sno=dtos(tx,ty);\n            for(int i=0;i<8;i+=2)//\u53ea\u80fd\u5411\u56db\u4e2a\u65b9\u5411\u8d70\u800c\u4e0d\u662f\u516b\u4e2a!\n            {\n                if(dtos(tx+dirx[i],ty+diry[i]))\n                {\n                    if(!inq[resu]&&cg[resu])\n                    {\n                        ti[resu]=ti[sno]+1;\n                        inq[resu]=1;\n                        q.push(resu);\n                    }\n                }\n            }\n        }\n        printf(\"Poor Harry\\n\");\n        next:\n        ;\n    }\n    return 0;\n}\n\n```",
        "postTime": 1530351012,
        "uid": 88711,
        "name": "LakeArcFox",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2199 \u3010\u6700\u540e\u7684\u8ff7\u5bab\u3011"
    },
    {
        "content": "## P2199\u6700\u540e\u7684\u8ff7\u5bab\uff08\u9898\u89e3\uff09\n\n\u9898\u76ee\u4f20\u9001\u95e8\uff1a[\u70b9\u6211](https://www.luogu.org/problemnew/show/P2199)\n\n\u4e3b\u8981\u601d\u8def\uff1a  \n- \u628a\u53ef\u4ee5\u7ed3\u675f\u7684\u70b9\u8bb0\u5f55\u4e0b\u6765\u3002\n- \u4ece\u8d77\u70b9\u51fa\u53d1\uff0c[\u5e7f\u641c](https://www.cnblogs.com/fnlingnzb-learner/p/9052169.html)\u3002\n\n\u6ce8\u610f\u70b9\uff1a  \n\u6ce8\u610f\u4e0d\u7528\u8d70\u7684\u60c5\u51b5\u3002\n\n\u4ee3\u7801\uff1a~~\u521a\u597d\u4e00\u767e\u884c\uff0c\u5f3a\u8feb\u75c7\u60a3\u8005\u7684\u798f\u97f3~~\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define ull unsigned long long\nusing namespace std;\nstruct point\n{\n\tll x,y,step;\n\tpoint() {x=0;y=0;step=0;}\n\tpoint(ll a,ll b,ll c):x(a),y(b),step(c) {}\n};\nconst ll xxx[4]={-1,1,0,0},yyy[4]={0,0,-1,1};\nconst ll dx[8]={0,0,-1,1,-1,1,-1,1},dy[8]={-1,1,0,0,-1,-1,1,1};\nll n,m;\npoint s,e;\nvector<bool>b[17005],end[17005],vis[17005];\ninline bool Ok(point a)\n{\n\tif(a.x>=1&&a.x<=n&&a.y>=1&&a.y<=m&&b[a.x][a.y]) return true;\n\treturn false;\n}\ninline void In()\n{\n\tscanf(\"%lld%lld\",&n,&m);\n\tfor(ll i=1;i<=n;i++)\n\t{\n\t\tb[i].clear();b[i].push_back(true);\n\t\tfor(ll j=1;j<=m;j++)\n\t\t{\n\t\t\tchar a;\n\t\t\tcin>>a;\n\t\t\tif(a=='O') b[i].push_back(true);\n\t\t\tif(a=='X') b[i].push_back(false);\n\t\t}\n\t}\n}\ninline void csearch()\n{\n\tfor(ll i=1;i<=n;i++)\n\t{\n\t\tend[i].clear();\n\t\tfor(ll j=0;j<=m;j++) end[i].push_back(false);\n\t}\n\tfor(ll i=0;i<8;i++)\n\t{\n\t\tpoint p=s;\n\t\twhile(Ok(p)) {end[p.x][p.y]=true;p.x+=dx[i];p.y+=dy[i];}\n\t}\n}\ninline ll bfs()\n{\n\tqueue<point>q;\n\tq.push(point(e.x,e.y,1));\n\tif(end[e.x][e.y]) return 0;\n\tfor(ll i=1;i<=n;i++)\n\t{\n\t\tvis[i].clear();\n\t\tfor(ll j=0;j<=m;j++) vis[i].push_back(false);\n\t}\n\twhile(!q.empty())\n\t{\n\t\tpoint t=q.front();q.pop();\n//\t\tprintf(\"%lld %lld:%lld\\n\",t.x,t.y,t.step);\n\t\tfor(ll i=0;i<4;i++)\n\t\t{\n\t\t\tpoint now=point(t.x+xxx[i],t.y+yyy[i],t.step+1);\n\t\t\tif(!Ok(now)) continue;\n\t\t\tif(vis[now.x][now.y]) continue;\n\t\t\tif(end[now.x][now.y]) return t.step;\n\t\t\tq.push(now);\n\t\t\tvis[now.x][now.y]=true;\n\t\t}\n\t}\n\treturn -1;\n}\ninline void work()\n{\n\tcsearch();\n\tll ans=bfs();\n\tif(ans==-1) printf(\"Poor Harry\\n\");\n\telse printf(\"%lld\\n\",ans);\n//\tfor(ll i=1;i<=n;i++)\n//\t{\n//\t\tfor(ll j=1;j<=m;j++) cout<<b[i][j];\n//\t\tprintf(\"\\n\");\n//\t}\n//\tprintf(\"\\n\");\n//\tfor(ll i=1;i<=n;i++)\n//\t{\n//\t\tfor(ll j=1;j<=m;j++) cout<<end[i][j];\n//\t\tprintf(\"\\n\");\n//\t}\n//\tprintf(\"\\n\");\n}\nint main()\n{\n//\tfreopen(\"&tmp.in\",\"r\",stdin);\n\tIn();\n\twhile(scanf(\"%lld%lld%lld%lld\",&s.x,&s.y,&e.x,&e.y)==4&&(s.x||s.y||e.x||e.y)) work();\n\treturn 0;\n}\n```\n~~[\u6ca1\u6709\u5e7f\u544a](https://daniu.blog.luogu.org/)~~",
        "postTime": 1549171516,
        "uid": 44805,
        "name": "Leap_Frog",
        "ccfLevel": 7,
        "title": "P2199\u6700\u540e\u7684\u8ff7\u5bab\uff08\u9898\u89e3\uff09"
    },
    {
        "content": "**P\u515a\u798f\u5229\uff01\uff01\uff01**\n\n\u8fd9\u9053\u9898\u662f\u4e00\u9053\u641c\u7d22\u7684\u6c34\u9898\uff0c\u5982\u679c\u6ca1\u6709\u8fd9\u4e2a\u6570\u636e\u8303\u56f4\u7684\u8bdd\uff0c\u4f30\u8ba1\u90fd\u53d8\u6210\u9ec4\u9898\u4e86\u5427\n\n\u5bf9\u4e8e100%\u7684\u6570\u636e,\u6709N*M<=16384\n\n\u6b63\u5e38\u60c5\u51b5\u4e0b\u4e3a\u4e86\u9632\u5907\u51fa\u73b0\u6781\u7aef\u60c5\u51b5(n=1,m=16384)\uff0c\u6211\u4eec\u8981\u628a\u6570\u7ec4\u5f00\u523016500*16500\uff0c\u4f46\u662f\u8fd9\u6837\u662f\u4e0d\u884c\u4e86\uff0c\u4f1a\u7206\u5185\u5b58\n\n**\u4e8e\u662f\u4e4e\u6211\u4eec\u7528\u5230\u4e86Pascal\u7684\u52a8\u6001\u6570\u7ec4**\n\n\u5b9a\u4e49(\u5728var\u4e0b\u9762\u5199) a:array of longint;\n\u8fd9\u6837\u6211\u4eec\u5c31\u5b9a\u4e49\u4e86\u4e00\u4e2a\u4e00\u7ef4\u7684\u52a8\u6001\u6570\u7ec4\uff0c\u53ea\u8981\u5728\u4e0b\u9762\u7a0b\u5e8f\u4e2d\u5199setlength(a,x)\u5c31\u53ef\u4ee5\u5f00\u4e00\u4e2a0\u5230x-1\u7684\u4e00\u7ef4\u6570\u7ec4\n\n\u4e8c\u7ef4\u6570\u7ec4\u7684\u8bddmap:array of array of longint;     \nsetlength(map,n,m)\u5c31\u53ef\u4ee5\u5f00\u4e00\u4e2a0\u5230n-1,  0\u5230m-1\u7684\u4e8c\u7ef4\u6570\u7ec4\uff0c\u591a\u7ef4\u7684\u540c\u7406\n\n\u8fd9\u6837\u7684\u8bdd\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6839\u636en,m\u7684\u5927\u5c0f\u52a8\u6001\u7684\u5f00\u6570\u7ec4\uff0c\u5f88\u65b9\u4fbf\u54e6\n\n**\u6709\u4e00\u70b9\u8981\u6ce8\u610f**\uff0c**\u52a8\u6001\u6570\u7ec4\u65e0\u6cd5\u7528fillchar\u66f4\u65b0\uff0c\u4f1a\u51fa\u73b0216\u9519\u8bef(\u4e00\u822c\u4fdd\u62a4\u6027\u9519\u8bef)**\n\n\u518d\u9488\u5bf9\u9898\u76ee\u8bb2\u4e00\u70b9\u5427\uff0c\u6211\u7684\u505a\u6cd5\u662f\u628a\u80fd\u671b\u5230\u5956\u676f\u7684\u4f4d\u7f6e\u5148\u63d0\u524d\u6807\u8bb0\u597d\uff0c\u7136\u540e\u5bbd\u641c\uff0c\u53ea\u8981\u8d70\u5230\u6807\u8bb0\u8fc7\u7684\u4f4d\u7f6e\u5c31\u9000\u51fa\u8f93\u51fa\u89e3(\u56e0\u4e3a\u662f\u5bbd\u641c\uff0c\u6240\u4ee5\u5148\u5f97\u51fa\u6765\u7684\u89e3\u5fc5\u5b9a\u662f\u6700\u4f18\u89e3)\n\n\u4eae\u51fa\u6211\u4e11\u964b\u7684\u4ee3\u7801\uff0c\u5927\u4f6c\u4eec\u968f\u4fbf\u770b\u770b\n```\nvar\n  bi:boolean;\n  ans,head,tail,a1,a2,xx,yy,x,y:longint;\n  i,j,m,n,k,p:longint;\n  map:array of array of char;\n  check:array of array of longint;\n  s:array[1..8]of longint=(-1,-1,0,1,1,1,0,-1);\n  t:array[1..8]of longint=(0,1,1,1,0,-1,-1,-1);\n  sx:array[1..4]of longint=(-1,0,1,0);\n  sy:array[1..4]of longint=(0,1,0,-1);\n  fx,fy,num:array[0..20000]of longint;\nbegin\n  readln(n,m);\n  setlength(map,n+1,m+1);\n  setlength(check,n+1,m+1);\n  for i:=1 to n do\n    begin\n      for j:=1 to m do\n        read(map[i,j]);\n      readln;\n    end;\n  while true do\n    begin\n      readln(xx,yy,x,y);\n      if (xx=0)and(yy=0)and(x=0)and(y=0) then break;\n      for i:=0 to n do\n       for j:=0 to m do\n         check[i,j]:=0;\n\n\n      check[xx,yy]:=2;\n      for i:=1 to 8 do\n        if (xx+s[i]>=1)and(xx+s[i]<=n)and(yy+t[i]>=1)and\n           (yy+t[i]<=m)and(map[xx+s[i],yy+t[i]]='O') then\n          begin\n            a1:=xx; a2:=yy;\n            while (a1+s[i]>=1)and(a1+s[i]<=n)and(a2+t[i]>=1)and\n                  (a2+t[i]<=m)and(map[a1+s[i],a2+t[i]]='O') do\n              begin\n                a1:=a1+s[i]; a2:=a2+t[i];\n                check[a1,a2]:=2;\n              end;\n          end;\n      {for i:=1 to n do\n        begin\n          for j:=1 to m do\n            write(check[i,j]);\n          writeln;\n        end;}\n      if check[x,y]=2 then\n        begin\n          writeln(0); continue;\n        end;\n      head:=0; tail:=1; fx[1]:=x; fy[1]:=y; num[1]:=0; check[x,y]:=1;\n      bi:=false;\n      while head<tail do\n        begin\n          inc(head);\n          for i:=1 to 4 do\n            if (fx[head]+sx[i]>=1)and(fx[head]+sx[i]<=n)and\n               (fy[head]+sy[i]>=1)and(fy[head]+sy[i]<=m)and\n               (check[fx[head]+sx[i],fy[head]+sy[i]]<>1)and\n               (map[fx[head]+sx[i],fy[head]+sy[i]]='O')then\n              begin\n                if check[fx[head]+sx[i],fy[head]+sy[i]]=2 then\n                  begin\n                    ans:=num[head]+1; bi:=true; break;\n                  end\n                else\n                  begin\n                    inc(tail); fx[tail]:=fx[head]+sx[i];\n                    fy[tail]:=fy[head]+sy[i]; num[tail]:=num[head]+1;\n                    check[fx[tail],fy[tail]]:=1;\n                  end;\n              end;\n          if bi=true then break;\n        end;\n      if bi=true then\n        writeln(ans)\n      else\n        writeln('Poor Harry');\n    end;\nend.\n```",
        "postTime": 1532661570,
        "uid": 39488,
        "name": "\u56af\u5440\u56af\u5440",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2199 \u3010\u6700\u540e\u7684\u8ff7\u5bab\u3011"
    }
]
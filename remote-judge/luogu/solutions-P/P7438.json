[
    {
        "content": "\u628a\u591a\u9879\u5f0f $F(x)$ \u5199\u6210\u725b\u987f\u7ea7\u6570\n$$\nF(x)=\\sum_{i=0}^{k-1} a_i{x\\choose i}\n$$\n\u73b0\u5728\u95ee\u9898\u53d8\u6210\u6c42\u51fa\u7b54\u6848\u7684\u6bcf\u4e00\u9879\uff0c\u5373\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $m(1\\leq m\\leq n)$ \u548c $i(0\\le i<k)$ \u6c42 $\\sum_{\\pi}{\\text{cyc}_\\pi\\choose i}$\u3002$\\pi$ \u662f\u957f\u5ea6\u4e3a $m$ \u7684\u9519\u6392\uff0c$\\text{cyc}_\\pi$ \u8868\u793a\u9519\u6392\u7684\u73af\u6570\u3002\n\n\u8003\u8651\u9519\u6392\u7684\u751f\u6210\u51fd\u6570\uff0c\u9996\u5148\u6211\u4eec\u77e5\u9053\u4e00\u4e2a\u73af\u7684 $EGF$ \u4e3a\n$$\nH=\\sum_{i>0} \\frac{(i-1)!}{i!}x^i= \\sum_{i>0} \\frac{x^i}{i}=-\\ln(1-x)\n$$\n\u4e00\u4e2a\u9519\u6392\u662f\u7531\u82e5\u5e72\u4e2a\u73af\uff08\u65e0\u81ea\u73af\uff09\u7ec4\u6210\u7684\uff0c\u6240\u4ee5\u9519\u6392\u7684 $EGF$ \u4e3a\n$$\nG=e^{-\\ln(1-x)-x}\n$$\n$-x$ \u662f\u56e0\u4e3a\u8981\u53bb\u9664\u81ea\u73af\u3002\n\n\u8fd9\u9053\u9898\u662f\u8981\u6211\u4eec\u6c42\u4ece\u82e5\u5e72\u4e2a\u73af\u4e2d\u9009\u82e5\u5e72\u4e2a\u7684\u7b54\u6848\uff0c \u6240\u4ee5\u52a0\u4e00\u5143 $y$ \u8868\u793a\u9009\u4e86\u591a\u5c11\u4e2a\u73af\uff0c\u4e8e\u662f\u5c31\u8868\u793a\u6210\n$$\nG=e^{(-\\ln(1-x)-x)\\times(1+y)}\n$$\n\u8bb0 $g_{a,b}=[x^ay^b]G$\uff0c\u4e5f\u5c31\u662f\u8bf4\u957f\u5ea6\u4e3a $m$ \u7684\u9519\u6392\u4e2d\u9009 $i$ \u4e2a\u73af\u7684\u65b9\u6848\u6570\u7684\u548c\u4e3a $m!g_{m,i}$ \uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u8981\u6c42\u7684 $\\sum_{\\pi}{\\text{cyc}_\\pi\\choose i}$ \u3002\n\n\u76f4\u63a5\u66b4\u529b\u4e0a\u591a\u9879\u5f0f\u725b\u8fed\u590d\u6742\u5ea6\u5c31\u98de\u4e86\u3002\n\n\u5728 $G$ \u4e0a\u5bf9 $x$ \u6c42\u5bfc\n$$\nG(x)'=\\frac{x(1+y)}{1-x}G\n$$\n\u90a3\u4e48\n$$\n(n+1)g_{n+1,k}=\\sum_{i=0}^{n-1}g_{i,k}+g_{i,k-1}\\\\\n=n\\times g_{n,k}+g_{n-1,k}+g_{n-1,k-1}\n$$\n$O(nk)$ \u9012\u63a8\u5373\u53ef\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define N 600005\n#define K 102 \nusing namespace std;\ntypedef long long ll;\nconst int mod=998244353;\nll g[N][K],n,k,fac[N],inv[N];\nll a[K],A[K][K];\nll ksm(ll x,ll y){\n\tll res=1;\n\twhile(y){\n\t\tif(y&1) res=res*x%mod; \n\t\tx=x*x%mod; y>>=1;\n\t}\n\treturn res;\n}\nvoid init(){\n\tfac[0]=1;\n\tfor(int i=1;i<=n;i++) fac[i]=fac[i-1]*i%mod;\n\tinv[n]=ksm(fac[n],mod-2);\n\tfor(int i=n-1;i>=0;i--) \n\t\tinv[i]=inv[i+1]*(i+1)%mod,inv[i+1]=inv[i+1]*fac[i]%mod;\n}\nvoid get_G(){\n\tg[2][0]=inv[2],g[2][1]=inv[2];\n\tfor(ll i=3;i<=n;i++){\n\t\tg[i][0]=((i-1)*g[i-1][0]%mod+g[i-2][0])*inv[i]%mod;\n\t\tfor(int j=1;j<k;j++)\n\t\t\tg[i][j]=((i-1)*g[i-1][j]%mod+g[i-2][j]+g[i-2][j-1])*inv[i]%mod;\n\t}\n}\nll get_A(ll x){\n\tll res=0,X=1;\n\tfor(int i=0;i<k;i++,X=X*x%mod) res=(res+X*a[i]%mod)%mod;\n\treturn res;\n}\nint main(){\n//\tfreopen(\"test.in\",\"r\",stdin);\n\tcin>>n>>k;\n\tinit();\n\tget_G();\n\tfor(int i=0;i<k;i++) cin>>a[i];\n\tfor(int i=0;i<k;i++) A[0][i]=get_A(i);\n\tfor(int i=k,op=1;i>1;i--,op++)\n\t\tfor(int j=0;j<i-1;j++)\n\t\t\tA[op][j]=(A[op-1][j+1]-A[op-1][j]+mod)%mod;\n\tfor(int i=0;i<k;i++) a[i]=A[i][0];\n\tfor(int m=1;m<=n;m++){\n\t\tll res=0;\n\t\tfor(int i=0;i<k;i++)\n\t\t\t(res+=g[m][i]%mod*a[i]%mod)%=mod;\n\t\tcout<<fac[m]*res%mod<<' ';\n\t}\n}\n```\n\n",
        "postTime": 1621604802,
        "uid": 48110,
        "name": "\u7f19\u4e91\u5c71\u8f66\u795e",
        "ccfLevel": 8,
        "title": "P7438 \u66f4\u7b80\u5355\u7684\u6392\u5217\u8ba1\u6570_\u9898\u89e3"
    },
    {
        "content": "\u9996\u5148\u628a\u7ed9\u5b9a\u7684\u591a\u9879\u5f0f\u8f6c\u6210\u725b\u987f\u7ea7\u6570\uff0c\u5373\u8f6c\u5199\u6210\n$$\nF(x) = \\sum\\limits_{i=0}^{k-1} a_i \\binom xi\n$$\n\n\u7136\u540e\u5957\u8def\u7684\u62c6\u5f00\u9879\uff0c\u8003\u8651\u8ba1\u7b97\n$$\n\\sum\\limits_{\\pi} \\binom{{\\rm cyc}_{\\pi}}{k}\n$$\n\n\u8ba9\u6211\u4eec\u8003\u8651\u4e00\u4e2a\u9519\u6392\uff0c\u663e\u7136\u5b83\u662f\u7531\u975e\u81ea\u73af\u7684\u5faa\u73af\u7f6e\u6362\u4e3a\u57fa\u672c\u5355\u4f4d\u6784\u6210\u7684\uff0c\u5373\n$$\n{\\rm e}^{-x-\\ln(1-x)}\n$$\n\n\u7136\u540e\u8003\u8651\u4ece\u4e2d\u9009 $k$ \u4e2a\u3002\u4e0d\u96be\u53d1\u73b0\u8fd9\u53ea\u9700\u8981\u5bf9\u4e00\u4e2a\u5faa\u73af\u7f6e\u6362\u9644\u52a0\u4e00\u4e2a\u56e0\u5b50 $(1+y)$ \u5373\u53ef\u505a\u5230\uff1a\n$$\n{\\rm e}^{(1+y)(-x-\\ln(1-x))}\n$$\n\n\u4ee4\u5176\u4e3a $G$\uff0c\u8003\u8651\u63d0\u53d6\u5176\u7cfb\u6570\u3002\u5bf9 $x$ \u6c42\u5bfc\u53ef\u4ee5\u5f97\u5230\n$$\n\\frac{\\partial G}{\\partial x} = (1+y)\\frac x{1-x} G\n$$\n\n\u5373\n$$\n[x^{n+1}y^k] G = \\frac1{n+1} \\sum\\limits_{i=0}^{n-1} ([x^iy^k] + [x^iy^{k-1}]) G\n$$\n\n\u9012\u63a8\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(nk)$\u3002",
        "postTime": 1615689897,
        "uid": 75840,
        "name": "deserter",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P7438 \u3010\u66f4\u7b80\u5355\u7684\u6392\u5217\u8ba1\u6570\u3011"
    },
    {
        "content": "\u672c\u9898\u89e3\u63d0\u4f9b\u4e00\u79cd\u65e0\u9700\u751f\u6210\u51fd\u6570\u7684\u505a\u6cd5\u3002\n\n------------\n\n**\u6ce8**\uff1a\u4ee5\u4e0b\u6240\u6709\u6392\u5217 $\\pi$ \u5747\u4e3a\u9519\u6392\uff0c$|\\pi|$ \u8868\u793a\u6392\u5217 $\\pi$ \u7684\u957f\u5ea6\u3002\n\n------------\n\n\u8bb0 $c_{n,i}=\\sum_\\pi[|\\pi|=n][\\text{cyc}_ \\pi=i]$\uff0c\u5373\u5728\u957f\u5ea6\u4e3a $n$ \u7684\u9519\u6392\u4e2d\uff0c\u6070\u80fd\u5206\u89e3\u4e3a $i$ \u4e2a\u5faa\u73af\u7684\u6392\u5217\u4e2a\u6570\u3002\u5148\u5217\u4e2a\u5173\u4e8e $c_{n,i}$ \u7684\u8868\uff1a\n\n| $n,i$ | $1$ | $2$ | $3$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $2$ | $1$ |  |  |\n| $3$ | $2$ |  |  |\n| $4$ | $6$ | $3$ |  |\n| $5$ | $24$ | $20$ |  |\n| $6$ | $120$| $130$ | $15$ |\n\n\u4e0d\u96be\u53d1\u73b0 $c_{n,i}=(n-1)(c_{n-1,i}+c_{n-2,i-1})$\uff0c\u4ee5\u4e0b\u8bc1\u660e\uff1a\n\n\u5bf9\u957f\u5ea6\u4e3a $n$ \u7684\u6392\u5217 $\\pi$ \u7684\u6700\u540e\u4e00\u4e2a\u6570\u6240\u5728\u5faa\u73af\u957f\u5ea6\u8fdb\u884c\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n+ \u663e\u7136\u5176\u5faa\u73af\u957f\u5ea6\u4e0d\u53ef\u80fd\u4e3a $1$\u3002\n\n+ \u82e5\u5176\u5faa\u73af\u957f\u5ea6\u4e3a $2$\uff0c\u5219\u5c06**\u8fd9\u4e2a\u6570\u5b57**\u548c**\u4e0e\u5b83\u6784\u6210\u5faa\u73af\u7684\u90a3\u4e2a\u6570**\u4e00\u8d77\u62ff\u8d70\uff0c\u5269\u4e0b\u4e00\u4e2a\u957f\u5ea6\u4e3a $(n-2)$ \u7684\u9519\u6392\u3002\u56e0\u4e3a\u539f\u9519\u6392\u6709 $i$ \u4e2a\u5faa\u73af\uff0c\u73b0\u62ff\u6389\u4e86\u4e00\u4e2a\u5faa\u73af\uff0c\u6545\u5269\u4e0b $(i-1)$ \u4e2a\u5faa\u73af\uff0c\u6240\u4ee5\u5269\u4f59\u90e8\u5206\u6709 $c_{n-2,i-1}$ \u79cd\u65b9\u6848\u3002\u5bf9\u4e8e\u62ff\u6389\u7684\u90a3\u4e24\u4e2a\u6570\uff0c\u4e00\u4e2a\u5fc5\u987b\u662f $\\pi_n$\uff0c\u53e6\u4e00\u4e2a\u662f $1\\sim n-1$ \u4e2d\u4efb\u610f\u4e00\u4e2a\uff0c\u6709 $(n-1)$ \u79cd\u60c5\u51b5\u3002\n\n+ \u82e5\u5176\u5faa\u73af\u957f\u5ea6\u5927\u4e8e\u7b49\u4e8e $3$\uff0c\u5219\u5c06 $\\pi_n$ \u62ff\u8d70\uff0c\u5e76\u8ba9**\u6307\u5411 $\\pi_n$ \u7684\u90a3\u4e2a\u6570**\u6307\u5411 $\\pi_n$ **\u6240\u6307\u7684\u90a3\u4e2a\u6570**\uff08\u89c1\u4e0b\u4f8b\uff09\u3002\u90a3\u4e48\u5269\u4e0b\u7684 $(n-1)$ \u4e2a\u6570\u4ecd\u662f\u9519\u6392\uff0c\u4e14\u5faa\u73af\u6570\u4e3a $i$\uff0c\u6545\u65b9\u6848\u6570\u4e3a $c_{n-1,i}$\u3002\u5bf9\u4e8e $\\pi_n$\uff0c\u5b83\u539f\u5148\u53ef\u4ee5\u63d2\u5728\u4efb\u610f\u4e00\u4e2a\u6570\u7684\u524d\u9762\uff0c\u5171\u6709 $(n-1)$ \u4e2a\u4f4d\u7f6e\u53ef\u63d2\u3002\n\n$$\\begin{pmatrix}1&2&3&4\\\\2&4&1&3\\end{pmatrix}\\rightarrow\\begin{pmatrix}1&2&3\\\\2&3&1\\end{pmatrix}$$\n\n\n\u7efc\u4e0a\uff0c\u65b9\u6848\u6570\u4e3a $c_{n,i}=(n-1)(c_{n-1,i}+c_{n-2,i-1})$\u3002\n\n------------\n\n\u518d\u770b\u9898\u76ee\u8981\u6c42\uff0c\u8bb0 $\\text{Ans}_ m=\\sum_{|\\pi|=m}F(\\text{cyc}_ \\pi)$\uff0c$F(x)=\\sum_if_ix^i$\u3002\n\n\u82e5\u76f4\u63a5\u5c55\u5f00 $F(\\text{cyc}_ \\pi)$ \u5219\u5f97\uff1a\n\n$$\n\\begin{aligned}\n\\text{Ans}_ m&=\\sum_{j}f_j\\sum_{|\\pi|=m}(\\text{cyc}_ \\pi)^j\\\\\n&=\\sum_{j}f_j\\sum_ic_{m,i}\\,i^j\n\\end{aligned}\n$$\n\n\u8bb0 $b_{m,j}=\\sum_ic_{m,i}\\,i^j$\uff0c\u53ef\u4ee5\u8bc1\u660e\u6709\u9012\u63a8\u5f0f\uff1a\n\n$$b_{m,j}=(m-1)(b_{m-1,j}+\\sum_{i=0}^j\\binom jib_{m-2,i})$$\n\n\u4f46\u662f\u8981\u662f\u8fd9\u6837\u9012\u63a8\u4e0b\u53bb\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n^3)$ \u7684\uff0c\u4e0d\u5982\u4e0d\u8981\u3002\n\n------------\n\n\u8003\u8651\u91c7\u7528 [P4827](https://www.luogu.com.cn/problem/P4827) \u4e2d\u7684\u65b9\u6cd5\uff0c\u7528\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u5c55\u5f00\u666e\u901a\u5e42\u3002\u56e0\u4e3a\uff1a\n\n$$m^n=\\sum_{i=0}^ni!\\binom mi\\begin{Bmatrix} n \\\\i \\end{Bmatrix}$$\n\n\u6240\u4ee5\u53ef\u4ee5\u7528\u8fd9\u4e2a\u4e1c\u897f\u5c55\u5f00 $(\\text{cyc}_ \\pi)^j$\uff0c\u4ee3\u5165\u539f\u5f0f\u6709\uff1a\n\n$$\n\\begin{aligned}\n\\text{Ans}_ m&=\\sum_{j=0}^{k-1}f_j\\sum_{|\\pi|=m}\\sum_{i=0}^ji!\\binom {\\text{cyc}_ \\pi}i\\begin{Bmatrix} j \\\\i \\end{Bmatrix}\\\\\n&=\\sum_{i=0}^{k-1}\\Bigg(i!\\sum_{j=i}^{k-1}f_j\\begin{Bmatrix} j \\\\i \\end{Bmatrix}\\Bigg)\\sum_{|\\pi|=m}\\binom {\\text{cyc}_ \\pi}i\n\\end{aligned}\n$$\n\n\u8bb0 $p_{m,i}=\\sum_{|\\pi|=m}\\binom{\\text{cyc}_ \\pi}{i}$\uff0c\u5217\u8868\u89c2\u5bdf\uff1a\n\n| $m,i$ | $0$ | $1$ | $2$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $2$ | $1$ | $1$ | $0$ |\n| $3$ | $2$ | $2$ | $0$ |\n| $4$ | $9$ | $12$ | $3$ |\n| $5$ | $44$ | $64$ | $20$ |\n\n\u53d1\u73b0 $p_{m,i}=(m-1)(p_{m-1,i}+p_{m-2,i}+p_{m-2,i-1})$\uff0c\u4ee5\u4e0b\u8bc1\u660e\uff1a\n\n$$\n\n\\begin{aligned}\np_{m,i}&=\\sum_{|\\pi|=m}\\binom{\\text{cyc}_ \\pi}i\\\\\n&=\\sum_{j}\\binom jic_{m,j}\\\\\n&=(m-1)\\sum_{j}\\binom ji(c_{m-1,j}+c_{m-2,j-1})\\\\\n&=(m-1)\\Big(p_{m-1,i}+\\sum_{j}\\binom {j-1}{i}c_{m-2,j-1}+\\sum_{j}\\binom {j-1}{i-1}c_{m-2,j-1}\\Big)\\\\\n&=(m-1)(p_{m-1,i}+p_{m-2,i}+p_{m-2,i-1})\n\\end{aligned}\n\n$$\n\n\u8bc1\u6bd5\uff0c\u5219\u53ef\u5728 $O(nk)$ \u7684\u65f6\u95f4\u5185\u628a\u6240\u6709\u7684 $p_{m,i}(m\\le n, i<k)$ \u6c42\u51fa\u3002\n\n\u5173\u4e8e $i!\\sum_{j=i}^{k-1}f_j\\begin{Bmatrix} j \\\\i \\end{Bmatrix}$ \u8fd9\u4e00\u90e8\u5206\uff0c\u53ef\u4ee5\u66b4\u529b $O(k^2)$ \u6c42\u51fa\u3002\n\n\u81f3\u6b64\uff0c\u672c\u9898\u53ef\u5728 $O(nk+k^2)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u5b8c\u6210\u3002\n\n\n\n\n\n",
        "postTime": 1666330264,
        "uid": 375984,
        "name": "\u98de\u96e8\u70df\u96c1",
        "ccfLevel": 6,
        "title": "\u3010P7438\u3011\u66f4\u7b80\u5355\u7684\u6392\u5217\u8ba1\u6570"
    }
]
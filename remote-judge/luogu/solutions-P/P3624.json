[
    {
        "content": "## \u524d\u8a00\n\nAPIO 08\u7684\u597d\u9898\uff0c\u4ee3\u7801\u91cf\u4e0d\u5927\uff0c\u601d\u7ef4\u91cf\u6709\u4e00\u4e9b\u3002\n\n## \u89e3\u6cd5\n\n\u8fd9\u79cd\u9898\u5176\u5b9e\u5957\u8def\u660e\u663e\uff0c\u5c31\u662f\u5148\u9884\u5904\u7406\u4e00\u4e9b\u6570\u636e\uff0c\u6700\u540e\u518d\u626b\u4e00\u904d\u6c42\u51fa\u7b54\u6848\u3002\u6709\u70b9\u50cf\u4e8c\u8fdb\u5236\u4ece\u9ad8\u4f4d\u5f00\u59cb\u4e00\u70b9\u4e00\u70b9\u903c\u8fd1\u7684\u611f\u89c9\u3002\n\n\u4e00\u5f00\u59cb\uff0c\u5c06\u5b57\u7b26\u4e32\u8f6c\u5316\u4e3a\u6570\u5b57\u8868\u793a\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u7528 DP \u6765\u6c42\u51fa\u8303\u5f0f$-j$ \u7684\u4e2a\u6570\u3002\u7531\u9898\u610f\uff0c\u8303\u5f0f$-(j-1)$ \u4e5f\u662f\u8303\u5f0f$-j$\uff0c\u4e3a\u4e86\u7edf\u8ba1\u65b9\u4fbf\uff0c\u6211\u4eec\u5148\u4ee4\u8303\u5f0f$-(j-1)$ \u4e0d\u662f\u8303\u5f0f$-j$\uff0c\u6700\u540e\u524d\u7f00\u548c\u5408\u5e76\u5373\u53ef\u3002\n\n\u6211\u4eec\u4ee4 $f_{i,j,x}$ \u4e3a\u8003\u8651\u5230\u7b2c $i$ \u4f4d\uff0c\u8fd9\u4e00\u4f4d\u662f $x$ \u7684\u8303\u5f0f$-j$ \u4e2a\u6570\u3002\u6613\u5f97\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$f_{i,j,x}=\\sum\\limits_{y=1}^4 f_{i+1,j-(x>y),y}$$\n\n\u5982\u679c\u8fd9\u4e00\u4f4d\u662f\u786e\u5b9a\u7684\u5b57\u7b26\uff0c\u90a3\u4e48 $x$ \u5c31\u662f\u4e00\u4e2a\u5b9a\u503c\u3002\n\n\u6c42\u5b8c\u524d\u7f00\u548c\u540e\uff0c\u6211\u4eec\u6309\u7167\u524d\u9762\u6240\u8bf4\u7684\u65b9\u6cd5\u6c42\u89e3\u7b54\u6848\u5373\u53ef\u3002\n\n## \u4ee3\u7801\n\n\u6709\u70b9\u4e11\uff08\u6bd5\u7adf\u5faa\u73af\u5c42\u6570\u6709\u70b9\u591a\uff09\u3002\n\n\u770b\u4e86\u5176\u4ed6\u5927\u4f6c\u7684\u4ee3\u7801\u53d1\u73b0\u5176\u5b9e\u53ef\u4ee5\u628a\u4ee3\u7801\u4e2d\u90e8\u5206\u5faa\u73af\u5408\u5e76\uff0c\u4f18\u5316\u5e38\u6570\u548c\u4ee3\u7801\u884c\u6570\u3002\u4f46\u662f\u672c\u4eba\u8f83\u83dc\uff0c\u89c9\u5f97\u5199\u8fd9\u79cd\u601d\u8def\u6e05\u6670\u7684\u4ee3\u7801\u6bd4\u8f83\u597d\u3002\n\n\u6bd5\u7adf\uff0c\u4f60\u5b8c\u5168\u6ca1\u5fc5\u8981\u5728\u7b80\u5355\u95ee\u9898\u4e0a\u800d\u6742\u6280\u3002\n\n~~\u9664\u975e\u5728\u5973\u540c\u5b66\u9762\u524d\u3002~~\n\n```cpp\n//Don't act like a loser.\n//This code is written by huayucaiji\n//You can only use the code for studying or finding mistakes\n//Or,you'll be punished by Sakyamuni!!!\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\n\nint read() {\n\tchar ch=getchar();\n\tint f=1,x=0;\n\twhile(ch<'0'||ch>'9') {\n\t\tif(ch=='-')\n\t\t\tf=-1;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0'&&ch<='9') {\n\t\tx=x*10+ch-'0';\n\t\tch=getchar();\n\t}\n\treturn f*x;\n}\n\nconst int MAXN=5e4+10; \n\nint n,k,r;\nint f[MAXN][11][5],a[MAXN];\n\nchar trans(int x) {\n\tif(x==1) return 'A';\n\tif(x==2) return 'C';\n\tif(x==3) return 'G';\n\treturn 'T';\n}\n\nsigned main() {\n\tcin>>n>>k>>r;\n\tfor(int i=1;i<=n;i++) {\n\t\tchar c;\n\t\tcin>>c;\n\t\tif(c=='A') a[i]=1;\n\t\telse if(c=='C') a[i]=2;\n\t\telse if(c=='G') a[i]=3;\n\t\telse if(c=='T') a[i]=4;\n\t\telse a[i]=0;\n\t}\n\t\n\tif(!a[n]) {\n\t\tfor(int i=1;i<=4;i++) {\n\t\t\tf[n][1][i]=1;\n\t\t}\n\t}\n\telse {\n\t\tf[n][1][a[n]]=1;\n\t}\n\t\n\tfor(int i=n-1;i;i--) {\n\t\tif(a[i]) {\n\t\t\tfor(int j=1;j<=k;j++) {\n\t\t\t\tfor(int y=1;y<=4;y++) {\n\t\t\t\t\tf[i][j][a[i]]+=f[i+1][j-(a[i]>y)][y];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tfor(int x=1;x<=4;x++) {\n\t\t\t\tfor(int j=1;j<=k;j++) {\n\t\t\t\t\tfor(int y=1;y<=4;y++) {\n\t\t\t\t\t\tf[i][j][x]+=f[i+1][j-(x>y)][y];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfor(int i=1;i<=n;i++) {\n\t\tfor(int j=1;j<=k;j++) {\n\t\t\tfor(int x=1;x<=4;x++) {\n\t\t\t\tf[i][j][x]+=f[i][j-1][x];\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfor(int i=1,last=0;i<=n;i++) {\n\t\tif(a[i]) {\n\t\t\tprintf(\"%c\",trans(a[i]));\n\t\t\tk-=(a[i]<last);\n\t\t\tlast=a[i];\n\t\t}\n\t\telse {\n\t\t\tint x;\n\t\t\tfor(x=1;x<=4&&r>f[i][k-(x<last)][x];x++) {\n\t\t\t\tr-=f[i][k-(x<last)][x];\n\t\t\t}\n\t\t\tprintf(\"%c\",trans(x));\n\t\t\tk-=(x<last);\n\t\t\tlast=x;\n\t\t}\n\t}\n\tputs(\"\");\n\treturn 0;\n}\n\n```",
        "postTime": 1619534126,
        "uid": 132976,
        "name": "huayucaiji",
        "ccfLevel": 6,
        "title": "LG3624 [APIO2008]DNA"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://zybuluo.com/ysner/note/1158123)\n\n\u6211\u4eec\u8981\u6c42\u51fa\u7b2c$r$\u79cd\u65b9\u6848\uff0c\u83ab\u8fc7\u4e8e\u770b\u5176\u524d\u9762\u4ec0\u4e48\u65f6\u5019\u6709$r-1$\u79cd\u65b9\u6848\u3002\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u8981\u6c42\u51fa\u6bcf\u79cd\u60c5\u51b5\u7684\u65b9\u6848\u6570\u3002\n\n\u8bbe$dp[s][m][n]$\u8868\u793a\u7b2c$i-n$\u4e2a\u5b57\u6bcd\u4e2d\uff0c\u5df2\u5206$m$\u6bb5\uff0c\u7b2c$i$\u4e2a\u5b57\u6bcd\u4e3as\uff08$s\\in\\{A,C,G,T\\}$)\u5b57\u6bcd\u7684\u5e8f\u53f7 \u7684\u65b9\u6848\u6570\u3002\n\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u6613\u5f97\uff1a(\u5176\u4e2d$las$\u662f\u4e0b\u4e00\u4e2a\u5b57\u6bcd\uff09\n\n$dp[j][k][i]+=dp[l][k-(j>las)][i+1]$\n\n\u4e3a\u4e86\u4e0b\u9762\u8fd0\u7b97\u65b9\u4fbf\uff0c\u8981\u5bf9$dp[s][m][n]$\u6c42\u524d\u7f00\u548c$sum[s][m][n]=\\sum_{i=1}^s dp[i][m][n]$\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u4ece\u524d\u5f80\u540e\u63a8\u4e86\uff0c\u82e5\u78b0\u5230\u7684\u5b57\u6bcd\u5df2\u77e5\uff0c\u770b\u662f\u5426\u5f71\u54cd\u6bb5\u6570\u5c31\u53ef\u4ee5\u4e86\uff1b\n\n\u5982\u679c\u78b0\u5230\u7684\u5b57\u6bcd\u672a\u77e5\uff0c\u679a\u4e3e$s=1...4$\u7684\u60c5\u51b5\uff0c\u5982$r>dp[s][m][n]$\uff0c\u8bf4\u660e\u7b2c$r$\u4e2a\u8fd8\u5728\u5f53\u524d\u679a\u4e3e\u5b57\u6bcd\u60c5\u51b5\u7684\u540e\u9762\uff0c\u7ee7\u7eed\u679a\u4e3e\uff1b\u5426\u5219\uff0c\u8fd9\u4e00\u4f4d\u5c31\u5e94\u8be5\u586b\u5f53\u524d\u679a\u4e3e\u5230\u7684\u5b57\u6bcd\u3002\n```\n#include<iostream>\n#include<cmath>\n#include<cstring>\n#include<cstdio>\n#include<cstdlib>\n#include<algorithm>\n#define ll long long\n#define re register\n#define il inline\n#define fp(i,a,b) for(re int i=a;i<=b;i++)\n#define fq(i,a,b) for(re int i=a;i>=b;i--)\nusing namespace std;\nconst int N=1e5+100;\nchar s[N];\nint m,k,a[N];\nll r,n,dp[5][15][N],sum[5][15][N];\nil ll gi()\n{\n  re ll x=0,t=1;\n  re char ch=getchar();\n  while((ch<'0'||ch>'9')&&ch!='-') ch=getchar();\n  if(ch=='-') t=-1,ch=getchar();\n  while(ch>='0'&&ch<='9') x=x*10+ch-48,ch=getchar();\n  return x*t;\n}\nil void wri(re int x)\n{\n  if(x<0) putchar('-'),x=-x;\n  if(x>9) wri(x/10);\n  putchar(x%10+'0');\n}\nint main()\n{\n  n=gi();m=gi();r=gi();\n  scanf(\"%s\",s+1);\n  fp(i,1,n)\n    if(s[i]=='A') a[i]=1;else if(s[i]=='C') a[i]=2;else if(s[i]=='G') a[i]=3;else if(s[i]=='T') a[i]=4;\n  if(a[n]) dp[a[n]][1][n]=1;\n  else fp(i,1,4) dp[i][1][n]=1;\n  fq(i,n-1,1)\n    fp(j,1,4)\n    if(!a[i]||a[i]==j)\n      fp(k,1,m)\n    fp(l,1,4)\n    dp[j][k][i]+=dp[l][k-(j>l)][i+1];\n  fp(i,1,4)\n    fp(j,1,n)\n    fp(k,1,m)\n    sum[i][k][j]=sum[i][k-1][j]+dp[i][k][j];\n  re int las=0;\n  fp(i,1,n)\n    if(a[i])\n      {\n    if(a[i]<las) --m;\n    las=a[i];\n    putchar(s[i]);\n      }\n    else\n      {\n    re int j;\n    for(j=1;j<=4&&r>sum[j][m-(j<las)][i];j++) r-=sum[j][m-(j<las)][i];\n    if(j==1) putchar('A');if(j==2) putchar('C');if(j==3) putchar('G');if(j==4) putchar('T');\n    if(j<las) --m;\n    las=j;\n      }\n  puts(\"\");\n  return 0;\n}\n```\n  [1]: https://www.luogu.org/problemnew/show/P3624",
        "postTime": 1527258700,
        "uid": 21534,
        "name": "ysner",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3624 \u3010[APIO2008]DNA\u3011"
    }
]
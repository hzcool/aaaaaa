[
    {
        "content": "\u65e0\u803b\u7684\u5b89\u5229\u4e00\u6ce2\u535a\u5ba2[Chlience](http://blog.csdn.net/Force_CHL)\n\n~~\u8fd9\u4e2a\u9898\u76ee\u6211\u4eec\u53ef\u4ee5\u753b\u56feAC~~\n\n\u5c06\u67d0\u4e00\u4e2a\u786e\u5b9a\u7684\u4e0a\u6da8\u5e8f\u5217$a[1],a[2],a[3],...,a[k]$\u5199\u51fa\u6765\n\n\u8fd9\u4e2a\u5e8f\u5217\u5bf9\u4e8e\u603b\u6570\u7684\u8d21\u732e\u4e3a1,\u5f53\u7136,\u662f\u5f53$a[k]\\leq n$\u7684\u65f6\u5019\n\n\u663e\u7136\u7684,\u7ef4\u6301\u6bcf\u5929\u4e0a\u6da8\u7684\u4ef7\u683c\u4e0d\u53d8,\u7531\u4e8e$a[1]$\u80fd\u591f\u6709\u591a\u79cd\u53d6\u503c,\u90a3\u4e48\u5b83\u5c31\u4f1a\u6709\u5f88\u591a\u8d21\u732e,\u5f53\u7136,\u53d8\u5316\u540e\u7684$a[1]$\u4ecd\u7136\u8981\u4fdd\u8bc1$a[k]\\leq n$\n\n\u90a3\u4e48\u80fd\u4e0d\u80fd\u8003\u8651\u7ef4\u62a4\u4e00\u4e2a\u80a1\u7968\u4ef7\u683c\u7684\u5dee\u5206\u6570\u5217?\u5c31\u4e0d\u7528\u8003\u8651$a[1]$\u7684\u53d6\u503c\n\n\u5e76\u4e14,\u8fd9\u4e2a\u5dee\u5206\u6570\u5217$s[1],s[2],s[3],...,s[k-1]$\u6240\u505a\u51fa\u7684\u8d21\u732e\u5c31\u4e3a$n-\\sum_{i=1}^{k-1}s[i]$\n\n\u4e00\u5171\u6709$m^{k-1}$\u4e2a\u4e0d\u540c\u7684\u5dee\u5206\u6570\u5217,\u6bcf\u4e2a\u6570\u5217\u505a\u51fa\u7684\u8d21\u732e\u503c\u4e3a$n-\\sum_{i=1}^{k-1}s[i]$\n\n\u90a3\u4e48\u603b\u8d21\u732e\u5c31\u4e3a\n\n$\\sum_{d=1}^{m^{k-1}}(n-\\sum_{i=1}^{k-1}s[d][i])$\n\n\u5c06$n$\u63d0\u51fa\u53ef\u5f97\n\n$n*m^{k-1}-\\sum_{d=1}^{m^{k-1}}\\sum_{i=1}^{k-1}s[d][i]$\n\n\u73b0\u5728\u8981\u505a\u7684\u5c31\u662f\u5904\u7406\u540e\u9762\u90a3\u4e00\u5806\u4e1c\u897f\n\n\u6ce8\u610f,$s$\u663e\u7136\u662f\u5c06\u6240\u6709\u53ef\u80fd\u7684\u6392\u5217\u60c5\u51b5\u90fd\u7b97\u4e86\u8fdb\u53bb,\u5e76\u4e14$s[d][i]\\in[1,m]$\n\n\u90a3\u4e48\u540e\u9762\u4e00\u5171\u5c31\u4f1a\u6709$m^{k-1}*(k-1)$\u4e2a\u6570,\u5e76\u4e14\u5728$[1,m]$\u4e2d\u5b8c\u5168\u5e73\u5747\u5206\u5e03\n\n\u6240\u4ee5$[1,m]$\u4e2d\u7684\u6bcf\u4e2a\u6570\u90fd\u4f1a\u51fa\u73b0$\\frac{m^{k-1}*(k-1)}{m}=m^{k-2}*(k-1)$\u6b21\n\n\u8fd0\u7528\u5c0f\u5b66\u6570\u5b66\u77e5\u8bc6,\u5c06\u5176\u603b\u548c\u5316\u4e3a$m^{k-2}*(k-1)*\\frac{(m+1)*m}{2}$\n\n\u8fd9\u6837\u5c31\u5f88\u597d\u6c42\u89e3\u4e86\n\n\u6700\u7ec8\u7b54\u6848\u4e3a$n*m^{k-1}-m^{k-2}*(k-1)*\\frac{(m+1)*m}{2}$\n\u5feb\u901f\u5e42\u5c31\u597d\u5566\u256e(\u256f_\u2570)\u256d\n\n\n\u52aa\u529b\u8ffd\u8d76dalao\u4e2d\n\u7ed9\u4e88\u6211\u529b\u91cf\u5427(\u4e22\u8138ing\n\n**\u4ee3\u7801\u5982\u4e0b**\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define ll long long\nll n,k,m,p,ans;\nll read() {\n\tll ans=0,flag=1;\n\tchar ch=getchar();\n\twhile((ch>'9' || ch<'0') && ch!='-') ch=getchar();\n\tif(ch=='-') flag=-1,ch=getchar();\n\twhile(ch>='0' && ch<='9') ans=ans*10+ch-'0',ch=getchar();\n\treturn ans*flag;\n}\nll qpow(ll a,ll b,ll mod) {\n\tll ans=1;\n\twhile(b>0) {\n\t\tif(b&1) {ans*=a;ans%=mod;}\n\t\tb>>=1;a*=a;a%=mod;\n\t}\n\treturn ans;\n}\nll exgcd(ll a,ll b,ll &x,ll &y) {\n\tif(b==0) {x=1;y=0;return a;}\n\tll gcd=exgcd(b,a%b,x,y);\n\tll t=x;\n\tx=y; y=t-(a/b)*y;\n}\nint main() {\n\tn=read(),k=read(),m=read(),p=read();\n\tll x,y,gcd;\n\tgcd=exgcd(2,p,x,y);\n\tx=(x%p+p)%p;\n\tans+=(qpow(m,k-1,p)*(n%p))%p;\n\tans-=((((qpow(m,k-1,p)*(k-1))%p*(m+1))%p)%p*x%p);\n\tans=(ans%p+p)%p;\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1521707982,
        "uid": 20601,
        "name": "League\u4e36\u7fce",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3228 \u3010[HNOI2013]\u6570\u5217\u3011"
    },
    {
        "content": "> \u7ec4\u5408\u610f\u4e49\u5929\u5730\u706d\uff0c\u4ee3\u6570\u63a8\u5bfc\u4fdd\u5e73\u5b89\u3002\n\n\u4ecb\u7ecd\u4e00\u4e2a\u975e\u5e38\u66b4\u529b\u7684\u63a8\u6cd5\u3002\n\n\u8003\u8651\u5dee\u5206\u6570\u7ec4 $x_1,x_2,\\cdots, x_k$\uff0c\u76f8\u5f53\u4e8e\u8981\u6ee1\u8db3\u6027\u8d28\uff1a\n\n$$\\forall i\\in [2,k],\\ 1\\le x\\le m$$\n\n$$\\sum x_i \\le n$$\n\n\u4e0d\u59a8\u8bbe $x_{k+1} = n - \\sum_{i=1}^k x_i+1$\uff08\u6ce8\u610f\u8981 $+1$\uff0c\u8fd9\u6837\u6240\u6709\u7684 $x$ \u90fd\u662f\u6b63\u6574\u6570\uff09\uff0c\u5219\u9650\u5236\u53d8\u6210 $\\sum_{i=1}^{k+1} x_i = n+1$\u3002\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u8003\u8651\u5bb9\u65a5\uff0c\u679a\u4e3e $i$ \u8868\u793a\u6709 $i$ \u4e2a\u5927\u4e8e $m$\uff0c\u6545\u7b54\u6848\u4e3a\uff1a\n\n$$\\sum_{i=0}^{k-1} (-1)^i{k-1\\choose i}{n - i\\cdot m \\choose k}$$\n\n\u8003\u8651\u8fd9\u4e2a\u5f0f\u5b50\u957f\u5f97\u5f88\u50cf\u51fd\u6570\u7684 $k-1$ \u9636\u5dee\u5206\uff1a\n\n$$\\Delta^{k-1} f(x) = \\sum_{i=0}^{k-1}(-1)^{k - 1 - i} {k-1\\choose i}f(x + i)$$\n\n\u4e8e\u662f\u6211\u4eec\u8003\u8651\u4ee4 $f(x) = {n-x\\cdot m \\choose k}$\uff0c\u5219\uff1a\n\n$$(-1)^{k-1}\\Delta^{k-1}f(0) = \\sum_{i=0}^{k-1} (-1)^i{k-1\\choose i}{n - i\\cdot m \\choose k}$$\n\n\u4e8e\u662f\uff0c\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u6c42 $(-1)^n\\Delta^nf(0)$\uff0c\u8003\u8651\u628a\u5b83\u8f6c\u6210\u725b\u987f\u7ea7\u6570 $f(x)=\\sum_{i} c_i{x\\choose i}$ \u7684\u5f62\u5f0f\uff0c\u8fd9\u6837 $k-1$ \u9636\u5dee\u5206\u5c31\u662f $\\Delta^{k-1} f(x)\\sum_ic_{i+k-1}{x\\choose i}$ \u4e86\uff0c\u4e8e\u662f $\\Delta^{k-1}f(0) = c_{k-1}$\u3002\n\n\u5148\u628a $f(x)$ \u8f6c\u5316\u4e3a\u591a\u9879\u5f0f\uff08\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\u548c\u4e8c\u9879\u5f0f\u5b9a\u7406\uff09\uff1a\n\n$$\\begin{aligned}f(x) & = {n-x\\cdot m\\choose k}\\\\& = \\frac{(n-x\\cdot m)^{\\underline k}}{k!}\\\\& = \\frac{1}{k!}\\sum_{j=0}^k (-1)^{k-j}\\left[\\begin{matrix}k\\\\j\\end{matrix}\\right](n-x\\cdot m)^j\\\\& = \\frac{1}{k!}\\sum_{j=0}^k (-1)^{k-j}\\left[\\begin{matrix}k\\\\j\\end{matrix}\\right]\\sum_{p=0}^jn^{j-p}m^p(-1)^p{j\\choose p}x^p\\\\& = \\frac{1}{k!}\\sum_{p=0}^k\\sum_{j=p}^k (-1)^{k-j+p}\\left[\\begin{matrix}k\\\\j\\end{matrix}\\right]n^{j-p}m^p{j\\choose p}x^p\\end{aligned}$$\n\n\u7136\u540e\u518d\u8f6c\u6210\u725b\u987f\u7ea7\u6570\uff1a\n\n$$\\begin{aligned}f(x) & = \\frac{1}{k!}\\sum_{p=0}^k\\sum_{j=p}^k (-1)^{k-j+p}\\left[\\begin{matrix}k\\\\j\\end{matrix}\\right]n^{j-p}m^p{j\\choose p}x^p\\\\& = \\frac{1}{k!}\\sum_{p=0}^k\\sum_{j=p}^k (-1)^{k-j+p}\\left[\\begin{matrix}k\\\\j\\end{matrix}\\right]n^{j-p}m^p{j\\choose p}\\sum_{q=0}^p\\left\\{\\begin{matrix}p\\\\q\\end{matrix}\\right\\}{x\\choose q}q!\\\\& = \\frac{1}{k!}\\sum_{q=0}^k\\sum_{p=q}^k\\sum_{j=p}^k (-1)^{k-j+p}\\left[\\begin{matrix}k\\\\j\\end{matrix}\\right]n^{j-p}m^p{j\\choose p}\\left\\{\\begin{matrix}p\\\\q\\end{matrix}\\right\\}q!{x\\choose q}\n\\end{aligned}$$\n\n\u4e8e\u662f $\\Delta^{k-1}f(0)$ \u4e3a\u5b83\u7684\u7b2c $k-1$ \u6b21\u9879\u7cfb\u6570\uff1a\n\n$$\\begin{aligned}(-1)^{k-1}\\Delta^{k-1}f(0) &= \\frac{1}{k}\\sum_{p=k-1}^k\\sum_{j=p}^k (-1)^{p-j+1}\\left[\\begin{matrix}k\\\\j\\end{matrix}\\right]n^{j-p}m^p{j\\choose p}\\left\\{\\begin{matrix}p\\\\k-1\\end{matrix}\\right\\}\\\\\n\\end{aligned}$$\n\n\u6ce8\u610f\u5230\u8fd9\u4e9b\u65af\u7279\u6797\u6570\u548c\u7ec4\u5408\u6570\u4e0a\u4e0b\u81f3\u591a\u5dee\u4e00\uff0c\u6709\uff1a\n\n$$\\left[\\begin{matrix}k\\\\k-1\\end{matrix}\\right]=\\left\\{\\begin{matrix}k\\\\k-1\\end{matrix}\\right\\}={k\\choose 2}$$\n\n\u6240\u4ee5\u5176\u5b9e\u5df2\u7ecf\u53ef\u4ee5\u7b97\u4e86\uff0c\u4f46\u662f\u8fd9\u6837\u5f0f\u5b50\u8fd8\u662f\u592a\u4e11\uff0c\u4e8e\u662f\u6211\u4eec\u8003\u8651\u7ee7\u7eed\u5316\u7b80\uff1a\n\n\u5f53 $p=k-1$ \u65f6\uff0c\u540e\u534a\u90e8\u5206\uff08\u7b2c\u4e00\u4e2a $\\sum$ \u4e4b\u540e\uff09\u7684\u503c\u4e3a\uff1a\n\n$$-m^{k-1}{k\\choose 2}+m^{k-1}nk$$\n\n\u5f53 $p=k$ \u65f6\uff0c\u540e\u534a\u90e8\u5206\u7684\u503c\u4e3a\uff1a\n\n$$-m^k{k\\choose 2}$$\n\n\u6240\u4ee5\u7b54\u6848\u4e3a\uff1a\n\n$$\\frac{1}k\\left(-m^{k-1}{k\\choose 2}+m^{k-1}nk\n - m^k{k\\choose 2}\\right)$$\n\n\u6574\u7406\u5f97\uff1a\n\n$$m^{k-1}\\cdot n - \\frac{m^{k-1}(m+1)(k-1)}2$$\n\n\u5c31\u662f\u7ec4\u5408\u63a8\u51fa\u6765\u7684\u5f0f\u5b50\u4e86\u3002\n\n\u4ee3\u7801\u5f88\u7b80\u5355\uff0c\u4e0d\u8d34\u4e86\u3002\u987a\u5e26\u4e00\u63d0\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u8fd8\u53ef\u4ee5\u6c42\u4e0d\u9650\u5236\u7684 $x_i$ \u7a0d\u5fae\u591a\u4e00\u70b9\u7684\u60c5\u51b5\u3002\uff08\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u4e0d\u9650\u5236\u7684\u53d8\u91cf\u6570\u7684\u5e73\u65b9\uff09\n",
        "postTime": 1609117236,
        "uid": 34238,
        "name": "zhylj",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3228 \u3010[HNOI2013]\u6570\u5217\u3011"
    },
    {
        "content": "[$blog$](https://www.cnblogs.com/hbxblog/p/10395890.html)\n\n### $Solution$\n\n\u8fd9\u9053\u9898\u8c8c\u4f3c\u5e76\u4e0d\u96be\u7684\u6837\u5b50$QAQ$ \n\n\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u56e0\u4e3a\u6709\u9996\u9879\u7684\u5173\u7cfb\u6240\u4ee5\u6709\u70b9\u4e0d\u592a\u597d\u5f04.\u6240\u4ee5\u6211\u4eec\u8981\u5c06\u8fd9\u4e2a\u9996\u9879\u5bf9\u7b54\u6848\u7684\u5f71\u54cd\u7ed9\u53bb\u6389.\n\n\u6211\u4eec\u53ef\u4ee5\u6784\u5efa\u4e00\u4e2a\u5dee\u5206\u6570\u7ec4,\u6211\u4eec\u4ee4\u4ed6\u7b49\u4e8e$a[1],a[2]...a[k-1]$\n\n\u5219\u4e00\u4e2a\u67e5\u5206\u6570\u7ec4\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e3a:\n\n$$\\sum_{i=1}^{k-1}n-a[i]$$\n\n\u7136\u540e\u6211\u4eec\u4e00\u5171\u6709$m^(k-1)$\u4e2a\u8fd9\u6837\u7684\u67e5\u5206\u6570\u7ec4,\u6240\u4ee5\u603b\u8d21\u732e\u4e3a:\n\n$$\\sum_{j=1}^{m^{k-1}}\\sum_{i=1}^{k-1}n-a[j][i]$$\n\n\u6211\u4eec\u5c06$n$\u63d0\u51fa\u6765,\u5f0f\u5b50\u53d8\u4e3a:\n\n$$n*m^{k-1}-\\sum_{j=1}^{m^{k-1}}\\sum_{i=1}^{k-1}a[j][i]$$\n\n\u6240\u4ee5\u73b0\u5728\u53ea\u9700\u8981\u5316\u7b80\u540e\u9762\u7684\u5f0f\u5b50\u4e86.\n\n\u679a\u4e3e\u4e00\u4e9b\u6570\u53d1\u73b0(\u5b9e\u9645\u4e0a\u662f\u6211\u4e0d\u4f1a\u8bc1\u660e)  \n\u53d1\u73b0\u5728\u533a\u95f4$[1,m]\u7684\u6570\u6bcf\u4e2a\u6570\u51fa\u73b0\u7684\u4e2a\u6570\u76f8\u540c$  \n\u81f3\u4e8e\u600e\u4e48\u53d1\u73b0\u7684,\u6253\u8868\u627e\u89c4\u5f8b\u554a.  \n\n\u8fd9\u6837\u7684\u8bdd,\u6bcf\u4e2a\u6570\u51fa\u73b0\u7684\u6b21\u6570\u5c31\u53ef\u4ee5\u786e\u5b9a\u4e86:  \n$m^{k-1}$\u4e2a\u6570\u7ec4,\u6bcf\u4e2a\u6570\u7ec4$(k-1)$\u4e2a\u6570,  \n\u5219\u6bcf\u4e2a\u6570\u7684\u4e2a\u6570\u4e3a:  \n$$m^{k-1}*(k-1)/m$$\n$$=m^{k-2}*(k-1)$$\n\u7136\u540e\u540e\u9762\u5f0f\u5b50\u7684\u503c\u5c31\u53ea\u9700\u8981\u7528\u8fd9\u4e2a\u6570\u4e58\u4e0a$1+2+3+...+m\u7684\u503c\u4e86$\n\n\u6240\u4ee5\u540e\u9762\u5f0f\u5b50\u5b9e\u9645\u4e0a\u5c31\u662f:\n$$m^{k-2}*(k-1)*((1+m)*m)/2$$\n\n\u6240\u4ee5\u6700\u7ec8\u7b54\u6848\u4e3a:\n$$n*m^{k-1}-m^{k-2}*(k-1)*((1+m)*m)/2$$\n\n\u6ce8\u610f\u53d6\u6a21\u7684\u95ee\u9898\u554a,\u597d\u5751!!!\n\n### $Code$\n\n``` cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nint read(){\n    int x=0,f=1;char c=getchar();\n    while(c<'0'||c>'9') f=(c=='-')?-1:1,c=getchar();\n    while(c>='0'&&c<='9') x=x*10+c-'0',c=getchar();\n    return x*f;\n}\nint ksm(int a,int b,int mod){\n    int ans=1;\n    while(b){\n    if(b&1)\n        ans=a*ans%mod;\n    a=a*a%mod;\n    b>>=1;\n    }\n    return ans%mod;\n}\nmain(){\n    int n=read(),k=read(),m=read(),p=read();\n    printf(\"%lld\",(n%p*ksm(m,k-1,p)%p-ksm(m,k-2,p)*(k-1)%p*((1+m)*m/2%p)%p+p)%p);\n}\n```",
        "postTime": 1550475127,
        "uid": 19805,
        "name": "\u64a4\u4e91",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3228 \u3010[HNOI2013]\u6570\u5217\u3011"
    },
    {
        "content": "\u9898\u76ee\u964d\u5230\u6bcf\u4e00\u5929\u90fd\u8981\u6bd4\u524d\u4e00\u5929\u9ad8\uff0c\u4f46\u76f8\u5dee\u4e0d\u80fd\u8d85\u8fc7 $m$\uff0c\u5bb9\u6613\u8054\u60f3\u5230\u5dee\u5206\u5e8f\u5217\u3002\n\n\u6211\u4eec\u8003\u8651\u6bcf\u4e00\u4e2a\u5e8f\u5217\u5bf9\u6700\u7ec8\u7b54\u6848\u7684\u8d21\u732e\uff0c\u56e0\u4e3a\u53ef\u4ee5\u7b2c\u4e00\u5929\u7684\u6570\u503c\u53ef\u4ee5\u4efb\u610f\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u8003\u8651\u540e $k-1$ \u5929\u7684\u8d21\u732e\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u5dee\u5206\u5e8f\u5217 $\\{a\\}$\uff0c\u8d21\u732e\u8bb0\u4e3a $g(a)$\uff0c\u5219\u9700\u8981\u6ee1\u8db3 $k-1$ \u4e2a\u6570\u7684\u548c\u90fd\u5c0f\u4e8e\u7b49\u4e8e $n$\uff0c\u90a3\u4e48\u7b2c\u4e00\u5929\u7684\u6570\u503c\u7684\u65b9\u6848\u6570\uff0c\u5373\u5bf9\u7b54\u6848\u505a\u51fa\u7684\u8d21\u732e\u6709\uff1a\n$$\ng(a)=n-\\sum_{i=1}^{k-1} a_i\n$$\n\u4e00\u5171\u6709 $m^{k-1}$ \u4e2a\u5e8f\u5217\uff0c\u8bb0\u7b2c $i$ \u4e2a\u5e8f\u5217\u4e3a $a_i$\uff0c\u5219\uff1a\n$$\nAns=\\sum_{i=1}^{m^{k-1}} g(a)\n$$\n\n$$\n=n\\times m^{k-1} +\\sum_{i=1}^{m^{k-1}} \\sum_{j=1}^{k-1} a_{j}\n$$\n\u8003\u8651\u5230\u6bcf\u4e00\u4e2a\u6570\u5206\u5e03\u7684\u6982\u7387\u5747\u5300\uff0c\u6240\u4ee5\u6bcf\u4e00\u4e2a\u6570\u7684\u51fa\u73b0\u6b21\u6570\u4e3a\uff1a\n$$\nm^{k-1}\\times (k-1)\\times \\frac{1}{m}\n$$\n\n$$\n=m^{k-2}\\times (k-1)\n$$\n\u6240\u4ee5\u540e\u8005\u7684\u603b\u548c\u4e3a\uff1a\n$$\nm^{k-2}\\times (k-1)\\times \\dfrac{m\\times (m+1)}{2}\n$$\n\u6240\u4ee5\u7b54\u6848\u5373\u4e3a\uff1a\n$$\nAns=n\\times m^{k-1}-m^{k-2}\\times (k-1)\\times \\dfrac{m\\times (m+1)}{2}\n$$\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nll n,k,m,p;\ninline ll qpow(ll x,ll y,ll ret=1){\n\tfor(;y;y>>=1,x=x*x%p) if(y&1)\n\t\tret=ret*x%p; return ret;\n}\ninline ll upd(ll x){return x+=x>>31&p;}\ninline ll calc(ll x){return x&1?(x+1)/2*x%p:x/2*(x+1)%p;}\nint main(){\n\tstd::cin>>n>>k>>m>>p;\n\tstd::cout<<upd(n%p*qpow(m,k-1)%p-qpow(m,k-2)*calc(m)%p*(k-1)%p)<<'\\n';\n\treturn 0;\n}\n```\n\n",
        "postTime": 1602679957,
        "uid": 101891,
        "name": "cyn2006",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3228 \u3010[HNOI2013]\u6570\u5217\u3011"
    },
    {
        "content": "\u5443\uff0c\u8fd9\u9898\u4ee3\u7801\u6781\u77ed\uff0c6\u884c\u5373\u53ef\uff08\u9003\n```\n#include<iostream>\n#define ll long long\nusing namespace std;\nll n,m,k,p;\nll ksm(ll x,ll k){ll tmp=1;while(k){if(k&1)tmp=tmp*x%p;x=x*x%p,k/=2;}return tmp;}\nint main(){cin>>n>>k>>m>>p,n%=p,m%=p,cout<<(ksm(m,k-1)*n%p-(((m+1)*m/2)%p*ksm(m,k-2)%p*(k-1)%p)%p+p)%p;}\n```\n\u4f46\u662f\u5982\u679c\u601d\u8def\u88ab\u5e26\u504f\u4e86\uff0c\u5c31\u4f1a\u50cf\u5c0f\u7f16\u4e00\u6837\u60f3\u4e86\u4e24\u4e2a\u5c0f\u65f6\u624d\u7406\u89e3\n\n\u9996\u5148\u8003\u8651\u201c\u6784\u9020\u201d\u51fa\u4e00\u4e2a\u5408\u6cd5\u7684 $a$ \u6570\u7ec4\uff0c\u7528\u4ee5\u8bb0\u5f55\u6bcf\u5929\u80a1\u7968\u7684\u4ef7\u683c\n\n\u90a3\u4e48\u6839\u636e\u9898\u610f $a[i]-a[i-1]<=m$ \uff0c\u9898\u76ee\u4e2d\u53c8\u5199\u5230 $m * (k-1)< n$ \uff0c\u90a3\u4e48\u5c31\u7b97\u6bcf\u4e00\u4e2a $a[i]$ \u90fd\u53d6\u5230 $a[i]==a[i-1]+m$ \u4e5f\u6ca1\u95ee\u9898\n\n\u73b0\u5728\u518d\u6784\u9020\u4e00\u4e2a\u5dee\u5206\u6570\u7ec4 $b$ \u4e5f\u5c31\u662f\u5b9a\u4e49 $b[i]=a[i]-a[i-1]$ \uff0c\u90a3\u4e48 $b[i]<=m$ \uff0c\u90a3\u4e48\u4e0d\u8003\u8651\u201c\u6700\u9ad8\u4ef7\u683c\u4e0d\u8d85\u8fc7n\u201d $ans=m^{k-1} * (a[1]\u7684\u53ef\u80fd\u53d6\u503c)$\n\n$m^{k-1}$ \u7684\u610f\u601d\u5c31\u662f\uff0c\u6bcf\u4e2a $b[i]$ \u90fd\u53ef\u4ee5\u4ece 1 \u5230 $m$ \u968f\u4fbf\u53d6\u4e00\u4e2a\u503c\uff0c\u8fd9\u5c31\u662f\u4e2a\u4e58\u6cd5\u539f\u7406\uff0c\u4e0d\u89e3\u91ca\u4e0b\u53bb\u4e86\uff08\u4e0d\u7136\u53cd\u800c\u770b\u4e0d\u61c2\uff09\n\n\u90a3\u4e48\u6211\u4eec\u6765\u60f3\u60f3 $a[1]$ \u7684\u53d6\u503c\n\nhin\u663e\u7136\uff0c $a[1]=n-$$\\sum_{x=1}^{n}{b_x}$ (\u5efa\u8bae\u81ea\u884c\u7406\u89e3\uff0c\u8981\u662f\u7531\u5c0f\u7f16\u6765\u89e3\u91ca\u8bf8\u4f4d\u53ef\u80fd\u53cd\u800c\u4f1a\u6655)\n\n\u90a3\u4e48 $ans=m^{k-1} * (n-\u2211b_x)=n * m^{k-1}-\u2211\u2211b_x$ \u4e3a\u4ec0\u4e48\u62c6\u62ec\u53f7\u7684\u65f6\u5019\u4f1a\u6709\u8fd9\u4e2a\u5947\u602a\u95ee\u9898\u5462\uff0c\u56e0\u4e3a\u524d\u9762 $m^{k-1}$ \u662f\u4f1a\u5f71\u54cd $b_x$ \u7684\n\n\u6bd5\u7adf $m^{k-1}$ \u662f\u4e00\u4e2a\u65b9\u6848\u6570\uff0c\u5e76\u6ca1\u6709\u8003\u8651\u65b9\u6848\u4e0d\u540c\u800c\u5bfc\u81f4\u7684\u4e0d\u540c\u7ed3\u679c\n\n\u800c $\u2211\u2211b_x$ \u53ef\u4ee5\u8f6c\u5316\u4e3a\u4e00\u4e2a\u6570\u5728\u5dee\u5206\u5e8f\u5217\u4e2d\u51fa\u73b0\u7684\u6b21\u6570\uff0c\u7528 $(k-1) * m^{k-2} * (m+1) * m/2$ \u8ba1\u7b97 \n\n\u56e0\u4e3a $b_x$ \u7684\u6570\u503c\u662f\u5728 1 \u5230 $m$ \u4e2d\u968f\u4fbf\u9009\u53d6\u7684\uff0c\u90a3\u4e48\u663e\u7136\u4e00\u4e2a\u6570\u53ef\u4ee5\u5728 $(k-1)$ (\u6bcf)\u4e2a\u4f4d\u7f6e\u90fd\u51fa\u73b0\u4e00\u6b21\uff0c\u7136\u540e\u5176\u4ed6 $(k-2)$ \u4e2a\u6570\u503c\u53ef\u4ee5\u968f\u4fbf\u9009\u53d6\n\n\u7136\u540e\u7b49\u5dee\u6570\u5217\u6c42\u548c\u5c31\u5b8c\u4e86\uff08\u6211 * * \u8fd9\u91cc\u60f3\u4e86\u8d3c\u4e45\uff0c\u5176\u5b9e\u5c31\u662f\u6bcf\u4e2a\u6570\u5b57\u662f\u6709\u5b9e\u9645\u8d21\u732e\u7684\uff0chhhc\uff09\n\n\u4e3a\u4ec0\u4e48\u8981\u4e58\u4e0a\u7b49\u5dee\u5e8f\u5217\u6c42\u548c\u5462:\u8bf7\u6ce8\u610f-\u2211\u2211bx\u524d\u9762((k-1)*m^k-2)\u7b97\u51fa\u6765\u7684\u662f\u6bcf\u4e2a\u6570\u51fa\u73b0\u7684\u6b21\u6570,\u4f46\u662f\u6211\u4eec\u8981\u7b97\u7684\u662f-\u2211\u2211bx\u6240\u4ee5\u6839\u636e\u201c\u603b\u4ef7=\u6570\u91cf*\u5355\u4ef7\u201d,\u9700\u8981\u4e58\u4e0a\u2211i",
        "postTime": 1590230850,
        "uid": 251882,
        "name": "\u849f\u84bb\u4e01",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3228 \u3010[HNOI2013]\u6570\u5217\u3011"
    },
    {
        "content": "[\u8be6\u60c5\u5728\u535a\u5ba2\uff08\u56e0\u4e3a\u6211\u7684\u516c\u5f0f\u6e32\u67d3\u51fa\u4e86\u70b9\u9505\u5728\u8fd9\u4e0a\u9762\u4e0d\u597d\u8c03\uff09](https://cnyali-lk.com/HNOI2013-%E6%95%B0%E5%88%97/)\n\n\u5c31\u662f\u5feb\u901f\u5e42\u4e86\u3002\n\n```C++\n\nll fpm(ll a,ll b,ll p){\n\tll c=1;\n\twhile(b){\n\t\tif(b&1)c=c*a%p;\t\n\t\ta=a*a%p;\n\t\tb>>=1;\n\t}\n\treturn c;\n}\nint main(){\n#ifdef cnyali_lk\n\tfreopen(\"3228.in\",\"r\",stdin);\n\tfreopen(\"3228.out\",\"w\",stdout);\n#endif\n\tll n,m,k,p;\n\tn=read();//read\u662f\u8bfb\u5165\n\tk=read()-1;\n\tm=read();\n\tp=read();\n\tn%=p;\n\tprintf(\"%lld\\n\",(n*fpm(m,k,p)%p-fpm(m,k-1,p)*k%p*(m*(m+1)/2%p)%p+p)%p);\n\treturn 0;\n}\n\n\n```\n\n",
        "postTime": 1523069615,
        "uid": 8943,
        "name": "\u8001K",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3228 \u3010[HNOI2013]\u6570\u5217\u3011"
    },
    {
        "content": "\u9996\u5148\uff0c\u5c1d\u8bd5\u7528\u66b4\u529b\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u8bdd\uff0c\u901a\u8fc7\u679a\u4e3e\u6211\u4eec\u4f1a\u53d1\u73b0\u6bcf\u4e2a\u5e8f\u5217\u7684\u8d21\u732e\u4e3a1\uff08\u5e9f\u8bdd\uff09\uff0c\u5982\u679c\u6328\u4e2a\u679a\u4e3e $a_1$ \u8c8c\u4f3c\u5e76\u6ca1\u6709\u4ec0\u4e48\u597d\u7684\u529e\u6cd5\u3002\n\n\u90a3\u5c31\u53ef\u4ee5\u8bbe\u4e00\u4e2a\u6570\u7ec4\u5b58\u6bcf\u6b21\u4e0a\u6da8\u7684\u4ef7\u683c\uff0c\u4e5f\u5c31\u662f\u80a1\u7968\u4ef7\u683c\u7684\u5dee\u5206\u5e8f\u5217\uff0c\u8fd9\u4e2a\u5e8f\u5217\u7684\u603b\u548c\u52a0\u4e0a $a_1$ \u5c0f\u4e8e\u7b49\u4e8e $n$ \u5373\u53ef\uff0c\u90a3\u4e48 $a_1$ \u53ef\u5f97\u7684\u5408\u6cd5\u4ef7\u683c\u5c31\u662f $n - sum$\u3002\n\n\u8fd9\u4e2a\u5dee\u5206\u5e8f\u5217\u6709 $k - 1$ \u9879\uff0c\u6bcf\u4e00\u9879\u6709 $m$ \u79cd\u9009\u62e9\u3002\u90a3\u4e48\u6700\u540e\u6240\u5f97\u7684\u4ef7\u503c\u5c31\u662f\u8fd9 $m^{k - 1}$ \u79cd\u5e8f\u5217\u7684\u8d21\u732e\u76f8\u52a0\u3002\n\n\u4f46\u662f\u5982\u679c\u76f4\u63a5\u8fd9\u6837\u7b97\u4f1a $TLE$\uff0c\u6211\u4eec\u8003\u8651\u5316\u7b80\u8fd9\u4e2a\u5f0f\u5b50\u3002\u901a\u8fc7\u89c2\u5bdf\u53d1\u73b0\u4e00\u5171\u51fa\u73b0\u4e86 $(k - 1) \\times m^{k - 1}$ \u4e2a\u6570\uff0c\u4e141\u5230 $m$ \u5168\u90fd\u662f\u7b49\u6982\u7387\u5206\u5e03\u7684\uff0c\u90a3\u6bcf\u4e2a\u6570\u51fa\u73b0\u6b21\u6570\u90fd\u662f $(k - 1) \\times m^{k - 2}$ \u6b21\u3002\n\n\u6700\u540e\u7684\u7ed3\u679c\u5c31\u662f $m^{k - 2} \\times (k - 1) \\times \\frac{(m + 1) \\times m} {2}$\u3002\n\n## \u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nconst int MAXN = 1e5 + 10;\nusing namespace std;\nint n, k, m, p;\ninline int read()\n{\n\tint x = 0, f = 1; char c = getchar();\n\twhile(c < '0' || c > '9') {if(c == '-') f = -1; c = getchar();}\n\twhile(c >= '0' && c <= '9') {x = (x << 3) + (x << 1) + c - '0'; c = getchar();}\n\treturn x * f;\n}\nint quick_pow(int a, int b)\n{\n\tint res = 1;\n\twhile(b)\n\t{\n\t\tif(b & 1) (res *= a) %= p;\n\t\t(a *= a) %= p;\n\t\tb >>= 1;\n\t}\n\treturn res % p;\n}\nsigned main()\n{\n\tn = read(), k = read(), m = read(), p = read();\n\tprintf(\"%lld\\n\", (n % p * quick_pow(m, k - 1) % p - quick_pow(m, k - 2) * (k - 1) % p * ((m + 1) % p * m / 2 % p) % p + p) % p);\n\treturn 0;\n}\n```\n",
        "postTime": 1666254534,
        "uid": 453100,
        "name": "Tzs_yousa",
        "ccfLevel": 4,
        "title": "P3228\u9898\u89e3"
    },
    {
        "content": "> \u7ec4\u5408\u610f\u4e49\u5929\u5730\u706d\uff0c\u4ee3\u6570\u63a8\u5bfc\u4fdd\u5e73\u5b89\u3002\n\n\u4e0b\u9762\u67d0\u4f4d\u4e00\u770b\u5c31\u662f\u5609\u5fc3\u7cd6\u7684\u8001\u54e5\u8fd9\u6837\u5199\u9053\u3002\u53ef\u95ee\u9898\u662f\u2026\u2026\u90a3\u4e2a\u4ee3\u6570\u63a8\u5bfc\u600e\u4e48\u4e5f\u4e0d\u50cf\u201c\u4fdd\u5e73\u5b89\u201d\u7684\u6837\u5b50\u554a\u5582\uff01\n\n\u8fd9\u91cc\u662f\u4e00\u4e2a\u65e2\u65e0\u601d\u7ef4\u542b\u91cf\u4e5f\u65e0\u8ba1\u7b97\u96be\u5ea6\u7684\u751f\u6210\u51fd\u6570\u63a8\u6cd5\u3002\n\n------------\n\u9898\u610f\uff1a\u6c42\u6ee1\u8db3\u4e0b\u5217\u6761\u4ef6\u7684\u6b63\u6574\u6570\u5e8f\u5217\u4e2a\u6570\uff1a\u6709 $k$ \u4e2a\u6570\uff0c\u4e25\u683c\u9012\u589e\uff0c\u6bcf\u9879\u4e0d\u8d85\u8fc7 $n$\uff0c\u76f8\u90bb\u4e24\u9879\u7684\u5dee\u4e0d\u8d85\u8fc7 $m$\u3002\n\n\u8003\u8651\u5982\u679c\u6211\u4eec\u786e\u5b9a\u4e86\u7b2c\u4e00\u9879\uff0c\u4ee5\u53ca\u6700\u540e\u4e00\u9879\u4e0e\u7b2c\u4e00\u9879\u7684\u5dee $d$\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ea\u9700\u8981\u6c42\u51fa\u9009 $k-1$ \u4e2a $[1,m]$ \u5185\u7684\u6570\u4f7f\u5f97\u548c\u4e3a $d$ \u7684\u65b9\u6848\u6570\uff0c\u5373\u53ef\u552f\u4e00\u5bf9\u5e94\u4e00\u4e2a\u5408\u6cd5\u5e8f\u5217\u3002\u8fd9\u4e2a\u5f62\u5f0f\u53ef\u4ee5\u76f4\u63a5\u5199\u51fa\u751f\u6210\u51fd\u6570\uff1a\n$$F(x)=\\sum_{i=1}^mx^i$$\n$$G(x)=F^{k-1}(x)$$\n\u82e5\u9996\u9879\u4e0e\u672b\u9879\u5dee\u4e3a $d$\uff0c\u5219\u5408\u6cd5\u9996\u9879\u7684\u4e2a\u6570\u5373\u4e3a $n-d$\uff0c\u90a3\u4e48\u7b54\u6848\u5373\u4e3a\uff1a\n$$\\sum_{i=1}^{n-1}(n-i)[x^i]G(x)=n\\sum_{i=1}^{n-1}[x^i]G(x)-\\sum_{i=1}^{n-1}i[x^i]G(x)$$\n\u53d1\u73b0\uff0c$F$ \u662f\u4e00\u4e2a $m$ \u6b21\u591a\u9879\u5f0f\uff0c\u90a3\u4e48 $G$ \u662f\u4e00\u4e2a $m(k-1)$ \u6b21\u591a\u9879\u5f0f\uff0c\u800c\u9898\u76ee\u4fdd\u8bc1\u4e86 $n>m(k-1)$\uff0c\u5219\u591a\u9879\u5f0f\u7684\u6bcf\u4e00\u9879\u90fd\u5728\u4e0a\u5f0f\u4e2d\u88ab\u8003\u8651\u5230\u3002\u6211\u4eec\u8003\u8651\u7528\u591a\u9879\u5f0f\u7684\u6c42\u503c\u6765\u6539\u5199\u4e0a\u5f0f\uff0c\u4e0d\u96be\u53d1\u73b0\u5373\u4e3a\uff1a\n$$nG(1)-G'(1)=nF(1)^{k-1}-(k-1)F(1)^{k-2}F'(1)$$\n\u6211\u4eec\u663e\u7136\u6709 $F(1)=m$\uff0c$F'(1)=\\dfrac12m(m+1)$\uff0c\u90a3\u4e48\u6700\u7ec8\u7b54\u6848\u5373\u4e3a\uff1a\n$$nm^{k-1}-\\frac12m^{k-1}(m+1)(k-1)$$",
        "postTime": 1631488866,
        "uid": 174045,
        "name": "FZzzz",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3228 \u3010[HNOI2013]\u6570\u5217\u3011"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u9053\u6570\u5b66\u9898\u3002\n\n\u89e3\u8fd9\u9053\u9898\u53ef\u4ee5\u5229\u7528\u753b\u56fe\u548cDP\u7684\u65b9\u6cd5\u3002\n\n\u7531\u4e8e\u56fe\u6bd4\u8f83\u591a\uff0c\u5177\u4f53\u9898\u89e3\u89c1\u8fd9\u91cc\uff1a\n\n[\u9898\u89e3](http://leanote.com/blog/post/593f7c62ab644110b3000eeb)\n\n\u4ee3\u7801\u5982\u4e0b\uff08\u5b9e\u9645\u4e0a\u53ea\u6709\u4e00\u4e2a\u5feb\u901f\u5e42\u7684\u8fc7\u7a0b\uff09\uff1a\n\n```cpp\nll N,M,K,P;\nll Pow(ll a,ll b,ll c){\n    ll res=1;\n    a%=c;\n    while(b){\n        if(b&1)res=(res*a)%c;\n        a=(a*a)%c,b>>=1;\n    }\n    return res;\n}\nvoid init(){\n    scanf(\"%lld%lld%lld%lld\",&N,&K,&M,&P);\n}\nvoid solve(){\n    ll ans1=Pow(M,K-1,P);\n    ll inv2,ans;\n    N%=P,ans=(N*ans1)%P;\n    if(M&1)inv2=(M+1)/2,inv2=inv2*M%P;\n    else inv2=M/2,inv2=inv2*(M+1)%P;\n    inv2=inv2*(K-1)%P;\n    inv2=inv2*Pow(M,K-2,P)%P;\n    ans+=P,ans=(ans-inv2)%P;\n    printf(\"%lld\\n\",ans);\n}\n```",
        "postTime": 1497417533,
        "uid": 11765,
        "name": "zqy1018",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3228 \u3010[HNOI2013]\u6570\u5217\u3011"
    },
    {
        "content": "## \u7ec4\u5408\u6570\u5b66\u63a8\u67ff\u5b50\n\n\u7528**\u6da8\u5e45\u76f8\u540c**\u6765\u5b9a\u4e49\u540c\u4e00\u4e2a\u5dee\u5206\u5e8f\u5217 $d_i$\uff0c\u90a3\u4e48\u4e0d\u540c\u7684\u5e8f\u5217\u53ea\u53d6\u51b3\u4e8e\u4e0d\u540c\u7684\u9996\u9879\uff0c\u4ece\u800c\u53ef\u5f97\uff1a\n\n$$ans=\\sum_{d1=1}^{m} \\sum_{d2=1}^{m} \\dots \\sum_{d_{k-1}=1}^{m}\\times  \\left ( n-\\sum_{i=1}^{k-1}d_i  \\right ) $$\n\n\u5206\u6790\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u5c06 \n\n$$\n\\sum_{d1=1}^{m} \\sum_{d2=1}^{m} \\dots \\sum_{d_{k-1}=1}^{m}\n$$\n\n\u770b\u4f5c $A$\uff0c\u90a3\u4e48 \n$$ans=A\\times \\left ( n-\\sum_{i=1}^{k-1}d_i  \\right) $$\n\u5373\uff1a\n\n$$ans=A\\times n-A\\times  \\sum_{i=1}^{k-1}d_i$$\n\n$$ans=n\\times m^{k-1}-\\sum_{d1=1}^{m} \\sum_{d2=1}^{m} \\dots \\sum_{d_{k-1}=1}^{m}\\times \\sum_{i=1}^{k-1}d_i$$\n\n \u51cf\u53f7\u540e\u9762\u5171 $ m^{k-1}* (k-1)$ \u4e2a\u6570\uff0c\u5e76\u4e14\u5728 $[1,m]$ \u4e2d\u5b8c\u5168\u5e73\u5747\u5206\u5e03\n\u6240\u4ee5 $[1,m]$ \u4e2d\u7684\u6bcf\u4e2a\u6570\u90fd\u4f1a\u51fa\u73b0 \n $ \\frac{m^{k-1}\\times \\left ( k-1 \\right ) }{m} $\n \u6b21\uff0c\u5c06\u5176\u603b\u548c\u5316\u4e3a\n$$ m^{k-2}\\times (k-1) \\times \\frac{(m+1)\\times m}{2} $$\n\n\u90a3\u4e48\u6700\u7ec8\u7684\u7b54\u6848\u5373\u4e3a\uff1a\n\n$$ans=n\\times m^{k-1}-m^{k-2}\\times (k-1) \\times \\frac{(m+1)\\times m}{2}$$\n\n\u522b\u5fd8\u4e86 $+p$ \u518d $\\bmod\\ p$ !\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n#include <cmath>\n#include <algorithm>\n#include <cstdlib>\n#include <queue>\n#define inf 0x3f3f3f3f\nusing namespace std;\n\nlong long n,k,m,p;\n\nlong long ksm(long long base,long long power) {\n\tlong long ans=1;\n\twhile(power!=0) {\n\t\tif(power%2==1) {\n\t\t\tans=(ans*base)%p;\n\t\t}\n\t\tbase=(base*base)%p;\n\t\tpower/=2;\n\t}\n\treturn ans;\n}\n\nint main() {\n\tcin>>n>>k>>m>>p;\n\tk--;\n\tn%=p;\n\tlong long a1=n*ksm(m,k)%p;\n\tlong long a2=k*ksm(m,k-1)%p;\n\tlong long a3=((m+1)*m/2)%p;\n\tcout<<((a1-(a2)*(a3)%p+p)%p+p)%p;\n\treturn 0;\n}\n```\n",
        "postTime": 1620829091,
        "uid": 366980,
        "name": "\u5230\u5e95\u51e0\u53ea\u9c7c\u5462",
        "ccfLevel": 0,
        "title": "P3228 [HNOI2013]\u6570\u5217"
    }
]
[
    {
        "content": "\u4f3c\u4e4e\u6709\u5f88\u591a\u9898\u89e3\u7528\u7684\u662f \u79bb\u7ebf+\u5e76\u67e5\u96c6\uff0c\u7136\u800c\u849f\u84bb\u8868\u793a\u6839\u672c\u770b\u4e0d\u61c2\u505a\u6cd5\u2026\u2026\n\n\u4e8e\u662f\u4e4e\u6211\u6253\u4e86\u4e2a\u66b4\u529b DFS\uff0c\u7136\u540e\u4ea4\u4e86\u4e00\u901a\uff0c\u7ed3\u679c\u5c31\u8fc7\u4e86\uff1f\uff1f\uff1f\n\n\u601d\u8def\u5f88\u7b80\u5355\uff0c\u9996\u5148\u9898\u76ee\u8bf4\uff0c\u5982\u679c\u4e00\u4e2a\u70b9 $u$ \u7684\u63a8\u8350\u89c6\u9891\u4e2d\u5305\u542b $v$\uff0c\u5fc5\u987b\u8981\u4fdd\u8bc1\u4e24\u70b9\u4e4b\u95f4\u7684\u8def\u5f84\u7684\u6700\u5c0f\u8fb9\u957f $\\ge k$\u3002\n\n\u663e\u7136\uff0c\u5982\u679c\u4e24\u70b9\u4e4b\u95f4\u7684\u8def\u5f84\u7684\u6700\u5c0f\u8fb9\u957f\u90fd $\\ge k$\uff0c\u5219\u6bcf\u6761\u8fb9\u957f\u80af\u5b9a\u90fd\u5fc5\u987b  $\\ge k$\u3002\n\n\u56e0\u6b64\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\uff0c\u4ece\u5f53\u524d\u70b9\u51fa\u53d1\u8fdb\u884c\u6df1\u641c\uff0c\u5982\u679c\u5f53\u524d\u8fb9\u7684\u957f\u5ea6 $< k$\uff0c\u5219\u8bf4\u660e\u65e0\u6cd5\u8d70\u901a\uff0c\u5426\u5219\u60c5\u51b5\u6570\u52a0\u4e00\u5e76\u7ee7\u7eed\u6df1\u641c\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N = 5e3 + 5;\nint n, q, cnt = 0;\nvector<int> G[N];\nint g[N][N]; // \u5176\u5b9e\u5b58\u56fe\u53ef\u4ee5\u4e0d\u7528\u90bb\u63a5\u77e9\u9635\uff0c\u4e0d\u8fc7\u53cd\u6b63\u7a7a\u95f4\u8db3\u591f\uff0c\u5b58\u4e86\u4e5f\u6ca1\u4e8b\nvoid dfs(int u, int fa, int k) {\n\tfor (int i = 0; i < G[u].size(); i++) {\n\t\tint v = G[u][i]; int w = g[u][v];\n\t\tif (v != fa && w >= k) {\n\t\t\tcnt++;\n\t\t\tdfs(v, u, k);\n\t\t}\n\t}\n}\nint main() {\n\tscanf(\"%d%d\", &n, &q);\n\tfor (int i = 1; i < n; i++) {\n\t\tint p, q, r;\n\t\tscanf(\"%d%d%d\", &p, &q, &r);\n\t\tG[p].push_back(q), G[q].push_back(p), g[p][q] = g[q][p] = r;\n\t}\n\tfor (int i = 1; i <= q; i++) {\n\t\tint k, v;\n\t\tscanf(\"%d%d\", &k, &v);\n\t\tcnt = 0;\n\t\tdfs(v, -1, k);\n\t\tprintf(\"%d\\n\", cnt);\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1616235367,
        "uid": 341650,
        "name": "_504",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P6111 \u3010[USACO18JAN]MooTube S\u3011"
    },
    {
        "content": "\u672c\u9898\u4e3a\u5e76\u67e5\u96c6\u7684\u8f83\u9ad8\u96be\u5ea6\u9898\uff0c\u53ef\u4ee5\u8003\u8651\u79bb\u7ebf\u6765\u505a\u3002\n\n\u95ee\u9898\u8f6c\u5316\uff1a\u7ed9\u5b9a\u4e00\u68f5\u6811\uff0c\u6c42\u6bcf\u4e2a\u70b9\u5230\u5176\u4ed6\u70b9\u76f8\u5173\u6027\u5927\u4e8e$k$\u7684\u6570\u91cf\uff0c\u8fd9\u91cc\u7684\u76f8\u5173\u6027\u8868\u793a\u4f7f\u4e24\u4e2a\u70b9\u8fde\u63a5\u7684\u8fb9\u6743\u4e2d\u6700\u5c0f\u503c\u3002\n\n\u4f8b\u5982\uff1a\n\n```\n1----->2----->3----->4----->5\n  233    1      3       100\n```\n\n\u4e0b\u65b9\u7684\u6570\u5b57\u8868\u793a\u8fb9\u6743\uff1a\n\n```\n1->2:233\n1->3:1\n1->4:1\n1->5:1\n2->3:1\n2->4:1\n2->5:1\n3->4:3\n3->5:3\n4->5:100\n```\n\n\u6b64\u9898\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\nusing namespace std;\nconst int MAXN=100010;\nint ans[MAXN+10];\nint fa[MAXN+10];\nint size[MAXN+10];//\u8bb0\u5f55\u63a8\u8350\u6570\u91cf \nint find(int x){//\u5e76\u67e5\u96c6\u7684\u67e5\u8be2 \n\tif(fa[x]==x) return x;\n\treturn fa[x]=find(fa[x]);\n}\nvoid uni(int x,int y){//\u5e76\u67e5\u96c6\u7684\u8fde\u63a5 \n\tint fx=find(x),fy=find(y);\n\tif(fx==fy) return;\n    fa[fx]=fy;\n    size[fy]+=size[fx];\n}\nstruct Edge{//\u8fb9\uff08\u76f8\u5173\u6027\uff09 \n\tint u,v,w;\n}E[MAXN];\nstruct Ask{//\u8be2\u95ee \n\tint k,v;\n\tint id;\n}Q[MAXN];\nbool cmpE(Edge a,Edge b){\n\treturn a.w>b.w;\n}\nbool cmpQ(Ask a,Ask b){\n\treturn a.k>b.k;\n}\nint main(){\n\tint n,q;\n\tcin>>n>>q;\n\tfor(int i=1;i<=n;i++){//\u521d\u59cb\u5316 \n        fa[i]=i;\n        size[i]=1;\n    }\n\tfor(int i=1;i<n;i++){\n\t\tscanf(\"%d%d%d\",&E[i].u,&E[i].v,&E[i].w);\n\t}\n\tfor(int i=1;i<=q;i++){\n\t\tscanf(\"%d%d\",&Q[i].k,&Q[i].v);\n\t\tQ[i].id=i;\n\t}\n\tsort(E+1,E+n+1-1,cmpE);//\u5bf9\u8fb9\u7684\u76f8\u5173\u6027\u8fdb\u884c\u6392\u5e8f \n\tsort(Q+1,Q+q+1,cmpQ);//\u5bf9\u8be2\u95ee\u7684\u76f8\u5173\u6027\u8fdb\u884c\u6392\u5e8f \n\tint j=1;//\u4e3a\u4ec0\u4e48\u4e0d\u7528\u5185\u5c42\u4ece1\u679a\u4e3e\u5462\uff1f\u6392\u5e8f\u540e\u5faa\u73af\u4e2dk\u5728\u964d\u4f4e\uff0ck\u5927\u7684\u65f6\u5019\u80fd\u591f\u6ee1\u8db3\u90a3\u4e48k\u5c0f\u7684\u65f6\u5019\u4e00\u5b9a\u4e5f\u80fd\u6ee1\u8db3\uff08k\u662f\u8981\u6c42\u6ee1\u8db3\u7684\u6700\u5c0f\u503c\uff09 \n\tfor(int i=1;i<=q;i++){//\u679a\u4e3e\u6bcf\u4e00\u4e2a\u8be2\u95ee\n\t\twhile(j<n&&E[j].w>=Q[i].k){//\u53ea\u8981\u4e0d\u8d8a\u754c\u6216\u6ca1\u6709\u8fbe\u5230\u76f8\u5173\u6027\u5c31\u5faa\u73af\u64cd\u4f5c \n\t\t\tuni(E[j].u,E[j].v);//\u8fde\u63a5\u4e24\u8fb9 \n\t\t\tj++;\n\t\t}\n\t\tans[Q[i].id]=size[find(Q[i].v)]-1;//-1\u662f\u56e0\u4e3a\u81ea\u5df1\u4e0d\u80fd\u63a8\u8350\u81ea\u5df1\uff0c\u7136\u800csize\u91cc\u9762\u5305\u542b\u4e86\u81ea\u5df1 \n\t}\n\tfor(int i=1;i<=q;i++){\n\t\tprintf(\"%d\\n\",ans[i]);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1582090117,
        "uid": 247658,
        "name": "HsKr",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P6111 \u3010[USACO18JAN]MooTube S\u3011"
    },
    {
        "content": "**\u9898\u76ee\u5927\u610f\uff1a**\n\n\u7ed9\u4e00\u9897\u6811\uff0c\u5982\u679c\u6811\u4e0a\u4e00\u70b9 $u$ \u4e0e\u53e6\u4e00\u70b9 $v$ \u6709\u8054\u7cfb\uff0c\u5219\u4ed6\u4eec\u95f4\u7684\u8ddd\u79bb\u5fc5\u987b\u5927\u4e8e $k$ \u3002\n\n\u6c42\u5bf9\u4e8e\u4e00\u4e2a $k_i$ ,\u627e\u4e0e\u7ed9\u5b9a\u7684 $v_i$ \u6709\u8054\u7cfb\u7684\u70b9\u4e2a\u6570\u3002\n\n**\u601d\u8def\uff1a**\n\n\u5982\u679c $v$ \u4e0e $u$ \u4e4b\u95f4\u7684\u6700\u5c0f\u8fb9\u957f\u5927\u4e8e\u7b49\u4e8e $k$ \u90a3\u4e48\u4ed6\u4eec\u4e4b\u95f4\u7684\u6bcf\u4e00\u6761\u8fb9\u7684\u957f\u5ea6\u80af\u5b9a\u90fd\u5927\u4e8e\u7b49\u4e8e $k$ \u3002\n\n\u4e4b\u540e\u6211\u4eec\u53ef\u4ee5\u8fdb\u884cDFS\uff0c\u5982\u679c\u5f53\u524d\u8fb9\u7684\u957f\u5ea6\u5c0f\u4e8e $k$ \uff0c\u6211\u4eec\u5c31\u8fd4\u56de\uff0c\u5426\u5219\u5c31\u7b54\u6848\u52a0\u4e00\u5e76\u4e14\u7ee7\u7eedDFS\u3002\n\n**code\uff1a**\n\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<vector>\n#include<cstring>\nusing namespace std;\nconst int N=1e5+5;\nvector<int> g[N];\nvector<int> a[N];\nint n,q;\nint cnt=0;\nvoid dfs(int u,int fa,int k){\n\tfor(int i=0;i<g[u].size();i++){\n\t\tint v=g[u][i];\n\t\tint w=a[u][v];\n\t\tif(v==fa) continue;\n\t\tif(w>=k){\n\t\t\tcnt++;\n\t\t\tdfs(v,u,k);\n\t\t}\n\t\t\n\t}\n}\nint main(){\n\tcin>>n>>q;\n\tfor(int i=1;i<n;i++){\n\t\tint u,v,w;\n\t\tcin>>u>>v>>w;\n\t\tg[u].push_back(v);\n\t\tg[v].push_back(u);\n\t\ta[v][u]=a[u][v]=w;\n\t}\n\tfor(int i=1;i<=q;i++){\n\t\tint k,v;\n\t\tcin>>k>>v;\n\t\tcnt=0;\n\t\tdfs(v,-1,k);\n\t\tcout<<cnt<<endl;\n\t}\n}\n```\n",
        "postTime": 1618290284,
        "uid": 300024,
        "name": "miao5",
        "ccfLevel": 4,
        "title": "P6111"
    },
    {
        "content": "\u4e00\u770b\u5230\u8be2\u95ee\u4e2a\u6570\u5f88\u591a\uff0c\u80af\u5b9a\u662f\u5e76\u67e5\u96c6\u5440\uff01\n\n\u4f46\u662f\uff0c\u5982\u679c\u76f4\u63a5\u5e76\u67e5\u96c6\uff0c\u4f1a\u6709\u5220\u8fb9\u7684\u95ee\u9898\uff0c\u90a3\u600e\u4e48\u529e\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u6309 $k$ \u6392\u4e2a\u5e8f\uff0c\u7136\u540e\u6bcf\u6b21\u4e0d\u7528\u5220\u8fb9\uff0c\u53ea\u9700\u8981\u52a0\u8fb9\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<iostream>\n#include<cstdlib>\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<vector>\nusing namespace std;\nint fa[100005];\nint ans[100005];\nint ha[100005];\nint findfather(int x)\n{\n\tif(x==fa[x])return x;\n\treturn fa[x]=findfather(fa[x]);\n}\nvector<int>g[100005];\nstruct apple\n{\n\tint u,v,w;\n\tbool operator<(const apple &other)const\n\t{\n\t\treturn w>other.w;\n\t}\n};\nstruct pear\n{\n\tint kk,vv,qq;\n\tbool operator<(const pear &other)const\n\t{\n\t\treturn kk>other.kk;\n\t}\n};\napple st[100005];\npear pr[100005];\nvoid insertedge(int x)\n{\n\tint uu=st[x].u,vv=st[x].v;\n\tint fuu=findfather(uu),fvv=findfather(vv);\n\tfa[fuu]=fvv;\n\tha[fvv]+=ha[fuu];\n}\nint main()\n{\n\tfor(int i=1;i<=100000;i++)fa[i]=i,ha[i]=1;\n\tint n,q;\n\tscanf(\"%d%d\",&n,&q);\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tint ppp,pppp,ppppp;\n\t\tscanf(\"%d%d%d\",&ppp,&pppp,&ppppp);\n\t\tst[i].u=ppp,st[i].v=pppp,st[i].w=ppppp;\n\t}\n\tsort(st+1,st+n);\n\tfor(int i=1;i<=q;i++)\n\t{\n\t\tint kkksc03,vvvsc03;\n\t\tscanf(\"%d%d\",&kkksc03,&vvvsc03);\n\t\tpr[i].kk=kkksc03,pr[i].vv=vvvsc03,pr[i].qq=i;\n\t}\n\tsort(pr+1,pr+q+1);\n\tint j=1;\n\tfor(int i=1;i<=q;i++)\n\t{\n\t\tfor(;j<n&&st[j].w>=pr[i].kk;j++)insertedge(j);\n\t\tint fvv=findfather(pr[i].vv);\n\t\tans[pr[i].qq]=ha[fvv];\n\t}\n\tfor(int i=1;i<=q;i++)printf(\"%d\\n\",ans[i]-1);\n\treturn 0;\n}\n```\n",
        "postTime": 1581827401,
        "uid": 107484,
        "name": "wmy_goes_to_thu",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P6111 \u3010[USACO18JAN]MooTube S\u3011"
    },
    {
        "content": "__\u9898\u610f__\n\n\u7ed9\u4f60\u4e00\u68f5\u6811\n\n\u6bcf\u6b21\u8be2\u95ee\u6709\u591a\u5c11\u4e2a\u70b9\uff0c\u5230\u70b9 $v_i$ \u7684\u7b80\u5355\u8def\u5f84\u4e2d\u6700\u5c0f\u6743\u503c\u5927\u4e8e $k_i$\n\n__\u601d\u8def__\n\n\u8fd9\u4e2a\u5c31\u662f\u4e2a\u66b4\u529b $dfs$\n\n\u53ef\u4ee5\u8003\u8651\u5148\u628a\u8be2\u95ee\u6309 $k_i$ \u503c\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\n\n\u56e0\u4e3a\u6700\u5c0f\u503c\u8981\u5927\u4e8e $k_i$ \uff0c\u6240\u4ee5\u5c0f\u4e8e $k_i$ \u7684\u8fb9\u662f\u4e0d\u80fd\u8d70\u7684\n\n\u6240\u4ee5\uff0c\u53ef\u4ee5\u6839\u636e\u8be2\u95ee\uff0c\u6bcf\u6b21\u628a\u5927\u4e8e $k_i$ \u7684\u8fb9\u52a0\u5165\n\n\u7136\u540e $dfs$ \u5224\u65ad\u6709\u591a\u5c11\u53ef\u4ee5\u5230\u7684\u70b9\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,q;\nstruct node\n{\n\tint x,y,k;\n}a[5005];\nvector<int> e[5005];\nint cmp(node s1,node s2)\n{\n\treturn s1.k>s2.k;\n}\nstruct nod\n{\n\tint k,v,s,id;\t\n}b[5005];\nint cmp1(nod s1,nod s2)\n{\n\treturn s1.k>s2.k;\n}\nint bk[5005],t;\nvoid dfs(int x)//\u66b4\u529b\u5224\u65ad\n{\n\tif(bk[x]==1)\n\t\treturn ;\n\t++t;\n\tbk[x]=1;\n\tfor(int i=0;i<e[x].size();i++)\n\t{\n\t\tdfs(e[x][i]);\n\t}\n}\nint cmp2(nod s1,nod s2)\n{\n\treturn s1.id<s2.id;\n}\nint main(){\n//\tfreopen(\"mootube.in\",\"r\",strin);\n//\tfreopen(\"mootube.out\",\"w\",strout);\n\tcin>>n>>q;\n\tfor(int i=1;i<n;i++)\n\t\tcin>>a[i].x>>a[i].y>>a[i].k;\n\tsort(a+1,a+n+1,cmp);\n\tfor(int i=1;i<=q;i++)\n\t{\n\t\tcin>>b[i].k>>b[i].v;\n\t\tb[i].id=i;\n\t}\n\tsort(b+1,b+q+1,cmp1);//\u6309k\u503c\u6392\u5e8f\n\tint l=1;\n\tfor(int i=1;i<=q;i++)\n\t{\n\t\tfor(int j=l;j<=n;j++)\n\t\t{ \n//\t\tcout<<\"****\"<<a[j].k<<' '<<b[i].k<<endl;\n\t\t\tif(a[j].k<b[i].k)//\u52a0\u5165\u5c0f\u4e8ek\u7684\u8fb9\n\t\t\t\tbreak;\n\t\t\te[a[j].x].push_back(a[j].y);\n\t\t\te[a[j].y].push_back(a[j].x);\n\t\t\t++l;\n\t\t}\n\t\tt=0;\n\t\t\n\t\tmemset(bk,0,sizeof(bk));\n\t\tdfs(b[i].v);\n//\t\tcout<<\"####\"<<b[i].id<<' '<<l<<endl;\n\t\tb[i].s=--t;//\u56e0\u4e3adfs\u4e2d\uff0c\u4f1a\u52a0\u5165\u81ea\u5df1\uff0c\u6240\u4ee5\u51cf\u4e00\n\t}\n\tsort(b+1,b+q+1,cmp2);//\u6309\u95ee\u9898\u7f16\u53f7\u6392\u5e8f\uff0c\u7136\u540e\u8f93\u51fa\n\tfor(int i=1;i<=q;i++)\n\t\tcout<<b[i].s<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1616309964,
        "uid": 151647,
        "name": "sycqwq",
        "ccfLevel": 7,
        "title": "P6111 \u9898\u89e3"
    },
    {
        "content": "\u8fd9\u9898\u7684\u52a0\u5f3a\u7248\u7684\u6211\u4eec PJ \u6a21\u62df\u8d5b\u7684 T4\uff0c\u4e2a\u4eba\u611f\u89c9\u8fd8\u6709\u70b9\u610f\u601d\u7684\u3002\n\n\u5148\u628a\u9898\u76ee\u8f6c\u5316\u4e00\u4e0b\uff0c\u5c31\u662f\u6bcf\u4e2a\u8be2\u95ee\u7ed9\u4f60\u4e00\u4e2a $K$ \u503c\u548c $v$ \u503c\uff0c\u628a\u6240\u6709\u5c0f\u4e8e $K$ \u7684\u8fb9\u90fd\u5220\u6389\uff0c\u7136\u540e\u4ece $v$ \u80fd\u8d70\u5230\u51e0\u4e2a\u8282\u70b9\u3002\n\n\u53ef\u4ee5\u79bb\u7ebf\uff0c\u6240\u4ee5\u9009\u62e9\u79bb\u7ebf\u3002\u628a\u95ee\u9898\u6309 $K$ \u4ece\u5927\u5230\u5c0f\u6392\u5e8f\uff0c\u628a\u8fb9\u6309\u6743\u503c\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\u3002\u7136\u540e\u4f9d\u6b21\u8003\u8651\u6bcf\u4e2a\u95ee\u9898\uff0c\u8fdb\u884c\u52a0\u8fb9\u64cd\u4f5c\u3002\u8fd9\u91cc\u52a0\u8fb9\u7684\u65f6\u5019\u8981\u7ef4\u62a4\u6bcf\u4e2a\u70b9\u6240\u5728\u7684\u8fde\u901a\u5757\u7684\u5927\u5c0f\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528\u6743\u503c\u5e76\u67e5\u96c6\u7ef4\u62a4\u3002\n\n\u4e3a\u4ec0\u4e48\u4e0d\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u7136\u540e\u7ef4\u62a4\u5220\u8fb9\uff1f\u56e0\u4e3a\u5220\u8fb9\u6bd4\u52a0\u8fb9\u96be\u7ef4\u62a4\u591a\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,m;\nstruct edge//\u6bcf\u6761\u8fb9\n{\n\tint x,y,z;\n}t[100005];\nstruct ques//\u6bcf\u4e2a\u95ee\u9898\n{\n\tint k,x,id;\n}q[100005];\nbool cmp1(edge x,edge y)\n{\n\treturn x.z>y.z;\n}\nbool cmp2(ques x,ques y)\n{\n\treturn x.k>y.k;\n}\nint fa[100005],res[100005],ans[100005];//res\u8868\u793ai\u6240\u5728\u7684\u8fde\u901a\u5757\u7684\u5927\u5c0f\nint find(int x)\n{\n\tif (x==fa[x]) return x;\n\tint u=find(fa[x]);\n\tres[x]=res[u];\n\tfa[x]=u;\n\treturn fa[x];\n}\nint main()\n{\n    cin >> n >> m;\n    for (int i=1;i<n;i++)\n    {\n    \tcin >> t[i].x >> t[i].y >> t[i].z;\n\t}\n\tfor (int i=1;i<=n;i++) fa[i]=i,res[i]=1;\n\tsort(t+1,t+n,cmp1);\n\tfor (int i=1;i<=m;i++)\n\t{\n\t\tcin >> q[i].k >> q[i].x;\n\t\tq[i].id=i;\n\t}\n\tsort(q+1,q+m+1,cmp2);\n\tint num=0;\n\tfor (int i=1;i<=m;i++)\n\t{\n\t\tfor (;num<n;num++)\n\t\t{\n\t\t\tif (t[num+1].z>=q[i].k) \n\t\t\t{\n\t\t\t\tint x1=find(t[num+1].x),y1=find(t[num+1].y);\n\t\t\t\tfa[x1]=y1;\n\t\t\t\tres[x1]+=res[y1];\n\t\t\t\tres[y1]=res[x1];\n\t\t\t}\n\t\t\telse break;\n\t\t}\n\t\tint p=find(q[i].x);\n\t\tans[q[i].id]=res[q[i].x]-1;\n\t}\n\tfor (int i=1;i<=m;i++) cout << ans[i] << endl;\n    return 0;\n}\n```\n",
        "postTime": 1601885929,
        "uid": 151475,
        "name": "Little09",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P6111 \u3010[USACO18JAN]MooTube S\u3011"
    },
    {
        "content": "\u524d\u7f6e\u7b97\u6cd5:\u5e76\u67e5\u96c6\u3002(\u4e3a\u4fdd\u8bc1\u60a8\u7684\u9605\u8bfb\u8d28\u91cf,\u9605\u8bfb\u6b64\u7bc7\u9898\u89e3\u524d\u8bf7\u5148\u5b66\u4e60\u5e76\u67e5\u96c6\u3002)\u3002\n\n~~\u867d\u7136\u6211\u7684\u7b97\u6cd5\u91cd\u590d\u4e86,\u53ef\u6211\u89c9\u5f97\u6211\u53ef\u80fd\u8bb2\u5f97\u6e05\u695a\u4e00\u4e9b\u3002\u6c42\u8fc7\u3002~~\n## \u601d\u8def\n\u6211\u4eec\u628a\u8be2\u95ee\u6309k\u4ece\u5927\u5230\u5c0f\u6392\u5e8f,\u628a\u8fb9\u6309\u8fb9\u6743\u4ece\u5927\u5230\u6392\u5e8f\u3002\n\n\u6211\u4eec\u5c31\u53ef\u4ee5\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee$i$,\u4f9d\u6b21\u5408\u5e76\u6240\u6709**\u4e0d\u5c0f\u4e8e**$k[i]$\u7684\u8fb9\u8fde\u63a5\u76842\u4e2a**\u8282\u70b9**(\u6ce8\u610f\u5bbe\u8bed\u662f**\u7ed3\u70b9**)\u3002\n\n\u5408\u5e76\u7528\u5e76\u67e5\u96c6\u5408\u5e76\u3002\n\n## \u6f14\u793a\n\n\u4e0b\u9762\u6765\u6f14\u793a\u6b64\u7b97\u6cd5\u3002\u5c31\u62ff\u6837\u4f8b\u6765\u6f14\u793a\u5427\u3002\n```cpp\n4 3     \u6392\u5e8f\u540e:\n1 2 3   2 4 4\n2 3 2   1 2 3\n2 4 4   2 3 2\n1 2     4 1\n4 1     3 1\n3 1     1 2\n```\n\u521d\u59cb\u96c6\u5408{1},{2},{3},{4}\u3002\n\n\u8be2\u95ee$k=4,v=1$:\u5408\u5e76\u6240\u6709$>=4$\u3002$2$\u5408\u5e76\u5230$4$,\u96c6\u5408\u4e3a{$1$},{$3$},{$2,4$};\u6b64\u65f6$v(1)$\u6240\u5728\u7684\u96c6\u5408\u5143\u7d20\u4e2a\u6570\u4e3a$1$\u3002\n\n\u8be2\u95ee$k=3,v=1$:\u5408\u5e76\u6240\u6709$>=3$\u3002$1$\u5408\u5e76\u5230$2$,\u96c6\u5408\u4e3a{$3$},{$1,2,4$};\u6b64\u65f6$v(1)$\u6240\u5728\u7684\u96c6\u5408\u5143\u7d20\u4e2a\u6570\u4e3a$3$\u3002\n\n\u8be2\u95ee$k=4,v=1$:\u5408\u5e76\u6240\u6709$>=1$\u3002$2$\u5408\u5e76\u5230$3$,\u96c6\u5408\u4e3a{$1,2,3,4$};\u6b64\u65f6$v(2)$\u6240\u5728\u7684\u96c6\u5408\u5143\u7d20\u4e2a\u6570\u4e3a$4$\u3002\n\n\u81ea\u5df1\u4e0d\u80fd\u63a8\u8350\u81ea\u5df1\u3002\u6240\u4ee5\u628a\u6240\u6709\u7684\u7b54\u6848-1,\u7136\u540e\u8f93\u51fa\u3002\n## ac.code\n\u5df2\u7ecf\u8bb2\u5f97\u5f88\u5177\u4f53\u4e86,\u4ee3\u7801\u91cc\u7684\u6ce8\u91ca\u5c31\u4e0d\u4f1a\u5f88\u591a\u4e86\u3002\n```cpp\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nstruct ${ //\u5b58\u8be2\u95ee\u3002\n\tint k,v,id; //id\u8868\u793a\u8be2\u95ee\u7f16\u53f7\u3002\u597d\u5c06\u7b54\u6848\u5b58\u8d77\u6765\u3002\u6700\u540e\u4e00\u8d77\u8f93\u51fa\u3002\n}_[1000005];\nstruct xyq{\n\tint u,v,w;\n}e[1000005];\nstruct rule{ //\u5b58\u56fe\u3002\n\tbool operator()(const xyq &s1,const xyq &s2){\n\t\treturn s1.w>s2.w;\n\t}\n};\nstruct rule${ //\u81ea\u5b9a\u4e49\u6392\u5e8f\u3002\n\tbool operator()(const $ &s1,const $ &s2){\n\t\treturn s1.k>s2.k;\n\t}\n};\nint f[1000005],ans[1000005],size[1000005]; //f\u5b58\u5e76\u67e5\u96c6\u7684\u7236\u4eb2\u3002ans\u5b58\u7b54\u6848,size\u5b58\u5927\u5c0f\u3002\nint getfather(int iakioi){ //\u5e76\u67e5\u96c6\u627e\u7236\u4eb2\u3002\n\tif(f[iakioi]==iakioi){\n\t\treturn iakioi;\n\t}\n\tf[iakioi]=getfather(f[iakioi]); //\u8def\u5f84\u538b\u7f29\u3002\n\treturn f[iakioi];\n}\nint main(){\n\tint n,m,i,a,b,c,tot=0,sum=0;\n\tcin>>n>>m;\n\tfor(i=0;i<n-1;++i){\n\t\tcin>>e[i].u>>e[i].v>>e[i].w;\n\t}\n\tfor(i=0;i<m;++i){\n\t\tcin>>_[i].k>>_[i].v;\n\t\t_[i].id=i; //\u521d\u59cb\u5316\u7f16\u53f7\u522b\u6f0f\u6389\u3002\n\t}\n\tfor(i=0;i<=n;++i){\n\t\tf[i]=i; //\u4e00\u5f00\u59cb\u81ea\u5df1\u7684\u7236\u4eb2\u90fd\u662f\u81ea\u5df1\u3002\n\t\tsize[i]=1; //\u4e00\u5f00\u59cb\u5143\u7d20\u7684\u5927\u5c0f\u90fd\u662f1\u3002\n\t}\n\tsort(e,e+n,rule());\n\tsort(_,_+m,rule$());\n\tfor(i=0;i<m;++i){\n\t\twhile(_[i].k<=e[tot].w){\n\t\t\tsize[getfather(e[tot].v)]+=size[getfather(e[tot].u)];\n\t\t\tf[getfather(e[tot].u)]=getfather(e[tot].v);\n\t\t\t++tot;\n\t\t}\n\t\tans[_[i].id]=size[getfather(_[i].v)];\n\t}\n\tfor(i=0;i<m;++i){\n\t\tcout<<ans[i]-1<<endl; //\u51cf1\u662f\u56e0\u4e3a\u81ea\u5df1\u4e0d\u63a8\u8350\u81ea\u5df1\u3002\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1581984647,
        "uid": 87799,
        "name": "xh39",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6111 \u3010[USACO18JAN]MooTube S\u3011"
    },
    {
        "content": "\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u5efa\u4e00\u4e2a\u90bb\u63a5\u8868\u6765\u5efa\u56fe\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5 $DFS$ \u66b4\u641c\uff08\u641c\u5230\u8fb9\u6743\u6bd4 $k$ \u5c0f\u7684\u76f4\u63a5\u9000\u51fa\uff0c\u56e0\u4e3a\u540e\u9762\u7684\u80af\u5b9a\u4e0d\u884c\uff09\u5230\u4e00\u4e2a\u70b9 $ans+1$\u3002\n\n```cpp\n#include <algorithm>\n#include <cstring>\n#include <iostream>\n\nusing namespace std;\n\nconst int kMaxN = 5e3 + 1;\n\nstruct node {\n  int get, moo[1000], f[1000];\n} cow[kMaxN];\nint n, q, k, ans;\nbool f[kMaxN];\n\nvoid dfs(int v) {  //DFS\n  for (int i = 0; i < cow[v].get; i++) {\n    if (cow[v].f[i] >= k && !f[cow[v].moo[i]]) {\n      ans++, f[cow[v].moo[i]] = 1;\n      dfs(cow[v].moo[i]);\n    }\n  }\n}\n\nint main() {\n  cin >> n >> q;\n  for (int i = 0; i < n - 1; i++) {\n    int p, q, r;\n    cin >> p >> q >> r;\n    cow[p].moo[cow[p].get] = q, cow[q].moo[cow[q].get] = p;\n    cow[p].f[cow[p].get++] = r, cow[q].f[cow[q].get++] = r; //\u5efa\u56fe\n  }\n  for (int i = 0; i < q; i++) {\n    memset(f, 0, sizeof(f)), ans = 0;\n    int v;\n    cin >> k >> v;\n    f[v] = 1, dfs(v);\n    cout << ans << endl;\n  }\n  return 0;\n}\n```",
        "postTime": 1620542855,
        "uid": 321290,
        "name": "un_def",
        "ccfLevel": 6,
        "title": "P6111 [USACO18JAN]MooTube S \u9898\u89e3"
    },
    {
        "content": "## [\u6d1b\u8c37\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P6111)\n## \u601d\u8def\n$N$ \u548c $Q$ \u90fd\u4e0d\u2f24\uff0c\u6240\u4ee5\u76f4\u63a5\u66b4\u529b\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\u90fd\u8fdb\u2f8f\u2f00\u6b21\u6811\u7684\u904d\u5386\u5373\u53ef\u3002\n\n### \u65f6\u95f4\u590d\u6742\u5ea6\n\u8be2\u95ee\u6570\u91cf $O(Q)$ \uff0c\u904d\u5386 $O(N)$ \uff0c\u603b\u5171 $O(NQ)$ \u3002\n## $code$\n~~~cpp\n#include <algorithm>\n#include <cstdio>\n#include <iostream>\n#include <vector>\n\nusing namespace std;\n\nconst int kMaxN = 5e3 + 1;\n\nstruct E {\n  int p, r;  // \u6307\u5411\u8282\u70b9\u3001\u5173\u8054\u6027\n};\nvector<E> e[kMaxN];\nint n, q, x, y, r;\n\nint S(int f, int x) {                        // \u7236\u4eb2f\uff0c\u5f53\u524d\u70b9x\uff0c\u641c\u7d22\u5173\u8054\u70b9\u6570\n  int c = 1;                                 // \u521d\u59cb\u5316\u70b9\u6570\n  for (int i = 0; i < e[x].size(); i++) {    // \u679a\u4e3e\u90bb\u8fb9\n    if (e[x][i].p != f && e[x][i].r >= r) {  // \u975e\u7236\u4eb2\u4e14\u5173\u8054\n      c += S(x, e[x][i].p);                  // \u641c\u7d22\u90bb\u70b9\u5e76\u7d2f\u52a0\n    }\n  }\n  return c;\n}\n\nint main() {\n  cin >> n >> q;\n  for (int i = 1; i < n; i++) {\n    cin >> x >> y >> r;\n    e[x].push_back({y, r});\n    e[y].push_back({x, r});\n  }\n  while (q--) {\n    cin >> r >> x;\n    cout << S(0, x) - 1 << endl;  // \u51cf\u53bb\u81ea\u8eab\n  }\n  return 0;\n}\n\n~~~",
        "postTime": 1620541510,
        "uid": 392856,
        "name": "\u4fe1\u5b88\u5929\u4e0b",
        "ccfLevel": 5,
        "title": "\u9898\u89e3P6111\u3010[USACO18JAN]MooTube S\u3011"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8 P6111 MooTube S](https://www.luogu.com.cn/problem/P6111)\n\n\u672c\u9898\u505a\u6cd5\u4e0e[\u91d1\u7ec4\u540c\u540d\u9898\u76ee](https://www.luogu.com.cn/problem/P4185)\u6ca1\u6709\u533a\u522b\uff0c\u4e5f\u5c31\u6570\u636e\u8303\u56f4\u4e0d\u4e00\u6837\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u4e3a$O(NlogN+QlogQ)$\u3002\n\n\u601d\u8def\u4e3b\u8981\u4e3a\u5e76\u67e5\u96c6\uff0c\u5177\u4f53\u505a\u6cd5\u5982\u4e0b\uff1a\n\n\u5148\u5c06\u6240\u6709\u8fb9$e$\u548c\u8be2\u95ee$k$\u964d\u5e8f\u6392\u5e8f\uff0c\u518d\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8be2\u95ee\uff0c\u626b\u5b8c\u5927\u4e8e\u7b49\u4e8e$k_i$\u7684$e_j$\uff0c\u5c06$e_j$\u4e24\u7aef\u70b9\u8fde\u63a5\u81f3\u4e00\u4e2a\u5e76\u67e5\u96c6\uff0c\u7136\u540e\u8bb0\u5f55\u6240\u67e5\u8be2\u7684\u70b9$v_i$\u6240\u5728\u5e76\u67e5\u96c6\u70b9\u7684\u6570\u91cf$s_{v_i}-1$\uff08\u56e0\u4e3a\u8981\u51cf\u53bb\u81ea\u8eab\uff09\u4e3a\u7b54\u6848$ans_i$\uff0c\u6700\u540e\u6309\u5e8f\u8f93\u51fa$ans_i$\u5373\u53ef\u3002\n\n\u8bdd\u4e0d\u591a\u8bf4\uff0c\u76f4\u63a5\u4e0a\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,m;\nint f[5010],s[5010],ans[5010];//\u91d1\u7ec4\u540c\u540d\u9898\u76ee\u5c06\u6570\u7ec4\u8303\u56f4\u6539\u4e3a100010\u5373\u53ef\nstruct edge\n{\n\tint u,v,w;\n}e[5010];\nstruct ask\n{\n\tint k,v,id;\n}q[5010];\nbool cmpe(edge a,edge b)//\u6309\u8fb9\u6743\u6392\u5e8f\n{\n\treturn a.w>b.w;\n}\nbool cmpq(ask a,ask b)//\u6309k\u6392\u5e8f\n{\n\treturn a.k>b.k;\n}\nint find(int x)//\u5bfb\u627e\u7236\u4eb2\n{\n\treturn f[x]==x?x:f[x]=find(f[x]);\n}\nvoid merge(int x,int y)//\u5408\u5e76\n{\n\tint fx=find(x),fy=find(y);\n\tif (fx==fy)\n\t\treturn;\n\tf[fx]=fy;\n\ts[fy]+=s[fx];//\u5408\u5e76\u65f6\u8bb0\u5f97\u66f4\u65b0\u70b9\u7684\u6570\u91cf\n}\nint main()\n{\n\tcin>>n>>m;\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tf[i]=i;\n\t\ts[i]=1;\n\t}\n\tfor (int i=1;i<n;i++)//\u6709n-1\u6761\u8fb9\n\t\tcin>>e[i].u>>e[i].v>>e[i].w;\n\tfor (int i=1;i<=m;i++)\n\t{\n\t\tcin>>q[i].k>>q[i].v;\n\t\tq[i].id=i;//\u8bb0\u5f55\u8be2\u95ee\u5e8f\u53f7\n\t}\n\tsort(e+1,e+n,cmpe);//\u8fb9\u6392\u5e8f\n\tsort(q+1,q+m+1,cmpq);//\u8be2\u95ee\u6392\u5e8f\n\tint j=1;\n\tfor (int i=1;i<=m;i++)\n\t{\n\t\twhile (j<n&&e[j].w>=q[i].k)//\u626b\u8fb9\n\t\t{\n\t\t\tmerge(e[j].u,e[j].v);//\u5408\u5e76\n\t\t\tj++;\n\t\t}\n\t\tans[q[i].id]=s[find(q[i].v)]-1;//\u8bb0\u5f55\u7b54\u6848\n\t}\n\tfor (int i=1;i<=m;i++)\n\t\tcout<<ans[i]<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1608891768,
        "uid": 53022,
        "name": "\u94f6\u6749\u6c34\u6749\u79c3\u6749",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P6111 \u3010[USACO18JAN]MooTube S\u3011"
    },
    {
        "content": "kruskal\u91cd\u6784\u6811\u6a21\u677f\u9898\uff1b\n\n\u5bf9\u8fb9\u6309\u7167\u8fb9\u6743\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\uff0c\u7136\u540e\u5efa\u7acbkruskal\u91cd\u6784\u6811\uff0c\u6bcf\u6b21\u8be2\u95ee\u5411\u4e0a\u500d\u589e\u8df3\u7236\u4eb2\u5373\u53ef\uff0c\u8f93\u51fa\u7b54\u6848\u4e3a\u5f53\u524d\u5b50\u6811\u4e0b\u53f6\u5b50\u8282\u70b9\u4e2a\u6570\u51cf\u4e00\u3002\n\n\u6bd4\u8d77\u5e76\u67e5\u96c6\u7684\u4f18\u70b9\u5927\u6982\u5c31\u662f\u652f\u6301\u8be2\u95ee\u5728\u7ebf\uff0c\u590d\u6742\u5ea6\u5747\u4e3a$O(nlogn)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n\n#define ri register int \n\n#define inf 0x3f3f3f3f\n\nusing namespace std;\n\ninline int read()\n{\n\tri a=0,f=1,c=getchar();\n\twhile(!isdigit(c))\n\t{\n\t\tif(c=='-')f=-1;\n\t\tc=getchar();\n\t}\n\twhile(isdigit(c))\n\t{\n\t\ta=a*10+c-'0';\n\t\tc=getchar();\n\t}\n\treturn a*f;\n}\n\nconst int N=2e5+10;\n\nint n,q;\n\nstruct edge\n{\n\tint u,v,w;\n}e[N];\nbool operator > (const edge &X,const edge &Y) {return X.w>Y.w;}\n\nint nn,lg[N],Fa[N];\nint get_Fa(int u){return u==Fa[u]?u:Fa[u]=get_Fa(Fa[u]);}\nint ch[N][2],fa[N][20],d[N],sz[N],c[N];\nbool vis[N];\nvoid dfs(int u)\n{\n\tvis[u]=1;\n\tfor(ri i=1;i<=lg[d[u]];++i)fa[u][i]=fa[fa[u][i-1]][i-1];\n\tif(!ch[u][0])sz[u]=1;\n\telse \n\t{\n\t\tfa[ch[u][0]][0]=u;\n\t\tfa[ch[u][1]][0]=u;\n\t\td[ch[u][0]]=d[u]+1;\n\t\td[ch[u][1]]=d[u]+1;\n\t\tdfs(ch[u][0]);\n\t\tdfs(ch[u][1]);\n\t\tsz[u]+=sz[ch[u][0]]+sz[ch[u][1]];\n\t}\n}\n\nint main()\n{\n//\tfreopen(\"1.in\",\"r\",stdin);\n\t\n\tn=nn=read();q=read();\n\tfor(ri i=1;i<=n-1;++i){e[i].u=read();e[i].v=read();e[i].w=read();}\n\t\n\t//kurskal\n\tsort(e+1,e+n,greater<edge>());\n\tfor(ri i=1;i<=nn;++i){Fa[i]=i;c[i]=inf;}\n\tfor(ri i=1;i<=n-1;++i)\n\t{\n\t\tri u=get_Fa(e[i].u),v=get_Fa(e[i].v),w=e[i].w;\n\t\tif(u!=v)\n\t\t{\n\t\t\t++nn;\n\t\t\tFa[u]=Fa[v]=Fa[nn]=nn;\n\t\t\tch[nn][0]=u;\n\t\t\tch[nn][1]=v;\n\t\t\tc[nn]=w;\n\t\t}\n\t}\n\tfor(ri i=2;i<=nn;++i)lg[i]=lg[i>>1]+1;\n\tfor(ri i=1;i<=n;++i)if(!vis[i])dfs(get_Fa(i));\n\t\n\t//cal\n\tfor(ri i=1;i<=q;++i)\n\t{\n\t\tri k=read(),u=read();\n\t\tfor(ri j=lg[d[u]];j>=0;--j)if(fa[u][j] && c[fa[u][j]]>=k)u=fa[u][j];\n\t\tprintf(\"%d\\n\",sz[u]-1);\n\t}\n\t\n\treturn 0;\n}\n```\n\n",
        "postTime": 1606539780,
        "uid": 239241,
        "name": "Singercoder",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P6111 \u3010[USACO18JAN]MooTube S\u3011"
    },
    {
        "content": "\u5173\u4e8e\u8fd9\u9053\u9898\u7684\u6570\u636e\u52a0\u5f3a\u7248\uff0c\u5c31\u662f\u9898\u9762\u91cc\u7684$Ag$\u7684\u9898\u76ee\u5566\n\n\u8fd9\u7bc7\u9898\u89e3\u4e3b\u8981\u662f\u5bf9\u4e8e\u5176\u4ed6\u9898\u89e3\u6ca1\u6709\u63d0\u53ca\u4e3a\u4ec0\u4e48\u6309$k$\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\u5c31\u662f\u6b63\u89e3\u7684\u8865\u5145\n\n\u6211\u7684\u601d\u8def\u5982\u4e0b\uff1a\n\uff08\u5148\u8d34\u4ee3\u7801,$siz[x]$\u8868\u793a$x$\u6240\u5728\u8fde\u901a\u5757\u5927\u5c0f\uff09\n\n```cpp\nwhile(cur<=n&&e[cur].w>=a[i].k){\n    merge(find(e[cur].u),find(e[cur].v));cur++;\n}\nans[a[i].id]=siz[find(a[i].v)]-1;\n```\n\u6211\u4eec\u5c06$k$\u548c\u8fb9\u6743\u4ece\u5927\u5230\u5c0f\u8fdb\u884c\u6392\u5e8f\u4e4b\u540e\uff0c\u5982\u679c\u626b\u5230\u4e00\u4e2a\u8fb9\u6743\u6bd4$k$\u66f4\u5927\u7684\u8fb9\uff0c\u5c31\u5c06\u8fd9\u6761\u8fb9\u52a0\u5165\u8fde\u901a\u5757\uff0c\u7136\u540e\u6211\u4eec\u6240\u6c42\u7684\u8fd9\u4e2a\u70b9\u7684\u76f8\u5173\u5c31\u662f\u5b83\u6240\u5728\u8054\u901a\u5757\u7684\u5927\u5c0f\uff08\u56e0\u4e3a\u76ee\u524d\u88ab\u52a0\u5165\u7684\u8fb9\u90fd\u662f\u5927\u4e8e$k$\u7684\uff09\u3002\n\n$AC$  $Code$\n\n```cpp\n#include<bits/stdc++.h> \n\n#define int long long\n\nusing namespace std;\n\ninline int read(){\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=x*10+ch-48;ch=getchar();}\n\treturn x*f;\n}\n\ninline void write(int x){\n\tif(x<0){putchar('-');x=-x;}\n\tif(x>9)write(x/10);\n\tint xx=x%10;\n\tputchar(xx+'0');\n}\n\nint n,q;\nint fa[100010],siz[100010],ans[100010];\nstruct node{\n\tint u,v,w;\n}e[100010];\nstruct edge{\n\tint k,v,id;\n}a[100010];\ninline bool cmp1(const node&a,const node&b){\n\treturn a.w>b.w;\n}\n\ninline bool cmp2(const edge&a,const edge&b){\n\treturn a.k>b.k;\n}\n\ninline void merge(int x,int y){\n\tif(x==y) return;\n\tfa[y]=x;siz[x]+=siz[y];\n}\n\ninline int find(int x){return fa[x]==x?x:fa[x]=find(fa[x]);}\n\nsigned main(){\n    int n=read(),q=read();\n    for(int i=1;i<=n;i++) fa[i]=i,siz[i]=1;\n    for(int i=1;i<n;i++) e[i].u=read(),e[i].v=read(),e[i].w=read();\n    for(int i=1;i<=q;i++) a[i].k=read(),a[i].v=read(),a[i].id=i;\n    sort(e+1,e+n,cmp1);sort(a+1,a+q+1,cmp2);\n    int cur=1;\n    for(int i=1;i<=q;i++){\n    \twhile(cur<=n&&e[cur].w>=a[i].k){\n    \t\tmerge(find(e[cur].u),find(e[cur].v));cur++;\n\t\t}\n\t\tans[a[i].id]=siz[find(a[i].v)]-1;\n\t}\n\tfor(int i=1;i<=q;i++) write(ans[i]),puts(\"\");\n\treturn 0;\n}\n```\n",
        "postTime": 1605879095,
        "uid": 102347,
        "name": "jichi",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P6111 \u3010[USACO18JAN]MooTube S\u3011"
    },
    {
        "content": "\u6b64\u9898\u53ef\u4ee5\u4e0d\u7528\u5e76\u67e5\u96c6\u6765\u505a\u54e6\uff08\u5e9f\u8bdd\uff09\n\n## \u5206\u6790\u9898\u76ee\n\u4e0d\u96be\u53d1\u73b0\uff0c\u9898\u76ee\u4e2d\u7684\u63a8\u8350\u89c6\u9891\u6570\u5c31\u662f\u67d0\u4e2a\u8282\u70b9\u5728\u6ee1\u8db3\u8fb9\u6743 $\\ge k$ \u7684\u60c5\u51b5\u4e0b\u80fd\u5230\u8fbe\u7684\u6240\u6709\u8282\u70b9\u6570\n\n\u56fe\u89e3\u6837\u4f8b\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2xwapppy.png?x-oss-process=image/resize,m_lfit,h_170,w_225)\n\n\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u8be2\u95ee\uff0c\u4ece\u8282\u70b9 2 \u51fa\u53d1\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8fb9\u6743 \\>1 \u7684\u8fb9 2-1 \u8d70\u5230\u8282\u70b9 1\uff0c\u901a\u8fc7\u8fb9\u6743 \\>1 \u7684\u8fb9 2-4 \u8d70\u5230\u8282\u70b9 4\uff0c\u901a\u8fc7\u8fb9\u6743 \\>1 \u7684\u8fb9 2-3 \u8d70\u5230\u8282\u70b9 3\u3002\u5171\u8d70\u5230 3 \u4e2a\u70b9\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u8be2\u95ee\uff0c\u4ece\u8282\u70b9 1 \u51fa\u53d1\uff0c\u6ca1\u6709\u8fb9\u6743 \\>=4 \u7684\u8fb9\u3002\u5171\u8d70\u5230 0 \u4e2a\u70b9\u3002 \n\n\u5bf9\u4e8e\u7b2c\u4e09\u4e2a\u8be2\u95ee\uff0c\u4ece\u8282\u70b9 1 \u51fa\u53d1\uff0c\u53ef\u4ee5\u901a\u8fc7 1-2 \u5230\u8fbe 2\uff0c\u4ece\u8282\u70b9 2 \u53ef\u4ee5\u901a\u8fc7 2-4\uff0c\u5230\u8fbe\u8282\u70b9 4\u3002\u5171\u5230\u8fbe 2 \u4e2a\u70b9\u3002\n\n## \u4ee3\u7801\u5b9e\u73b0\n\u8003\u8651\u5230\u6570\u636e\u8f83\u5c0f\uff0c\u6211\u4eec\u7528 bfs \u5b9e\u73b0\u6bcf\u6b21\u7684\u904d\u5386\u3002\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=5004;\nchar vis[maxn];\nint n,q,p,id,r,k,v;\nstruct edge{ int to,val;};\nvector < edge > vec[maxn];\n\nint bfs(int k,int from){\n\tint cnt=0;\n\tqueue < int > q;\n\tq.push(from);\n\tmemset(vis,0,sizeof(vis));\n\tvis[from]=1;\n\twhile(!q.empty()){\n\t\tint fr=q.front();\n\t\tq.pop();\n\t\tvector < edge > v=vec[fr];\n\t\tfor(int i=0;i<v.size();i++){\n\t\t\tif(!vis[v[i].to]&&v[i].val>=k){\n\t\t\t\t++cnt;  //\u53d1\u73b0\u53ef\u4ee5\u5230\u8fbe\u7684\u70b9,\u7ed3\u679c+1 \n\t\t\t\tq.push(v[i].to);\n\t\t\t\tvis[v[i].to]=1;\n\t\t\t}\n\t\t}\n\t}\n\treturn cnt;\n}\n\nint main(){\n\tscanf(\"%d %d\",&n,&q);\n\twhile(--n){\n\t\tscanf(\"%d %d %d\",&p,&id,&r);\n\t\t//\u65e0\u5411\u56fe\u8981\u53cc\u5411\u52a0\u8fb9 \n\t\tvec[p].push_back((edge){id,r});\n\t\tvec[id].push_back((edge){p,r});\n\t}\n\twhile(q--){\n\t\tscanf(\"%d %d\",&k,&v);\n\t\tprintf(\"%d\\n\",bfs(k,v));\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1596420384,
        "uid": 289944,
        "name": "Na2PtCl6",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P6111 \u3010[USACO18JAN]MooTube S\u3011"
    },
    {
        "content": "[\u5230blog\u98df\u7528\u6548\u679c\u66f4\u4f73](https://www.luogu.com.cn/blog/phykyerblog/solution-p6111)\n\n\u7b2c\u4e00\u773c\u770b\u89c1\u4e86\u201c\u4e0e\u66f4\u9ad8\u96be\u7684\u9898\u76ee\u201d\u4ec5\u6709\u6570\u636e\u8303\u56f4\u4e0d\u540c\uff0c\u518d\u779f\u4e00\u773c\u6570\u636e\u8303\u56f4\u624d $5000$ \uff0c\u90a3\u4e0d\u5c31\u66b4\u529b\u5c31\u5b8c\u4e8b\u4e86\uff08~~\u8bdd\u8bf4\u73b0\u5728\u7684\u9898\u89e3\u5c45\u7136\u6ca1\u6709\u66b4\u529b\u7684\u5b9e\u5728\u592a\u5f3a\u4e86~~\uff09\n\n\u5173\u4e8e\u66b4\u529b\uff1a\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\u4ece\u8be2\u95ee\u70b9\u5f00\u59cb\u8dd1\u4e00\u904d $dfs$ \u5373\u53ef\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include <cstdio>\nusing namespace std;\n\nconst int N = 5010;\n\nint n, q, ans;\nint head[N], ver[N << 1], edge[N << 1], Next[N << 1], cnt;\n\ninline void add(int x, int y, int z) {\n\tver[++cnt] = y; edge[cnt] = z; Next[cnt] = head[x]; head[x] = cnt;\n}\n\ninline void dfs(int x, int fa, int val) {\n\tfor (int i = head[x]; i; i = Next[i]) {\n\t\tint y = ver[i], z = edge[i];\n\t\tif (y == fa) continue;\n\t\tif (val > z) continue; // \u4e0d\u6ee1\u8db3\u76f8\u5173\u503c >=k\n\t\tdfs(y, x, val);\n\t\tans += 1;\n\t}\n}\n\ninline int read() {\n\tint x = 0; char ch = getchar();\n\twhile (ch < '0' || ch > '9') ch = getchar();\n\twhile (ch >= '0' && ch <= '9') x = x * 10 + ch - '0', ch = getchar();\n\treturn x;\n}\n\nint main() {\n\tn = read(); q = read();\n\tint x, y, z;\n\tfor (int i = 1; i < n; i++) {\n\t\tx = read(); y = read(); z = read();\n\t\tadd(x, y, z); add(y, x, z);\n\t}\n\twhile (q--) {\n\t\ty = read(); x = read();\n\t\tans = 0;\n\t\tdfs(x, 0, y);\n\t\tprintf(\"%d\\n\", ans);\n\t}\n\treturn 0;\n}\n```\n\n\u800c\u5bf9\u4e8e\u6570\u636e\u8303\u56f4\u8fbe\u5230\u4e86 $10^{5}$ \u7684\u60c5\u51b5\u6765\u8bf4\uff0c\u5728\u7ebf\u5904\u7406\u5c31\u663e\u5f97\u4e0d\u53ef\u884c\u4e86\u3002\u4e8e\u662f\u8003\u8651\u79bb\u7ebf\u7b97\u6cd5\u3002\n\n\u53ef\u4ee5\u6bd4\u8f83\u5bb9\u6613\u60f3\u5230\uff1a\u5c06\u8bfb\u5165\u7684\u8fb9\u6309\u8fb9\u6743\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\uff0c\u5bf9\u4e8e\u8bfb\u5165\u7684\u8be2\u95ee\u4e5f\u6309 $k$ \u503c\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\u3002\n\n\u5177\u4f53\u6765\u8bf4\u5c31\u662f\u6309 $k$ \u503c\u4ece\u5927\u5230\u5c0f\u5904\u7406\u95ee\u9898\uff0c\u5f53\u524d\u7684 $k$ \u503c\u4f1a\u4e0d\u65ad\u7f29\u5c0f\uff0c\u6bcf\u4e2a\u8be2\u95ee\u524d\u5224\u65ad\u662f\u5426\u6709\u8fb9\u7684\u6743\u503c\u6ee1\u8db3 $>=k$ \u7684\u6761\u4ef6\uff0c\u5982\u679c\u6709\u53ea\u8981\u8fdb\u884c\u5408\u5e76\u64cd\u4f5c\u5373\u53ef\uff08\u56e0\u4e3a\u8fd9\u6761\u8fb9\u7684\u8fb9\u6743\u4e00\u5b9a\u5927\u4e8e\u7b49\u4e8e\u4e4b\u540e\u6240\u6709\u8be2\u95ee\u7684 $k$\uff09\uff0c\u8fd9\u6837\u5904\u7406\u8be2\u95ee\u8fc7\u7a0b\u7684\u590d\u6742\u5ea6\u5c31\u53ef\u4ee5\u88ab\u538b\u7f29\u5230 $O(n)$\uff0c\u7a0b\u5e8f\u6574\u4f53\u590d\u6742\u5ea6\u4e3a $O(nlogn)$\u3002\n\n\u4ee5\u4e0b\u4e3a\u4ee3\u7801\uff08\u6ce8\u610f\u70b9\u4ee3\u7801\u5185\u6709\u6ce8\u91ca\uff09\n\n```cpp\n#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\nconst int N = 100010;\n\nint n, q, ans[N];//ans\u50a8\u5b58\u7b54\u6848 \nint fa[N], size[N];//size\u4e3a\u5e76\u67e5\u96c6\u5927\u5c0f\uff0c\u4e5f\u5c31\u662f\u6bcf\u6b21\u8be2\u95ee\u7684\u7b54\u6848 \n\nstruct edge {\n\tint x, y, z;\n}t[N];\n\nstruct questions {\n\tint u, k, id;//id\u8bb0\u5f55\u95ee\u9898\u7f16\u53f7 \n}a[N];\n\ninline bool comp(edge a, edge b) {return a.z > b.z;}\ninline bool cmp(questions x, questions y) {return x.k > y.k;}\n\ninline int get(int x) {\n\treturn x == fa[x] ? x : fa[x] = get(fa[x]);\n}\n\ninline int read() {\n\tint x = 0; char ch = getchar();\n\twhile (ch < '0' || ch > '9') ch = getchar();\n\twhile (ch >= '0' && ch <= '9') x = x * 10 + ch - '0', ch = getchar();\n\treturn x;\n}\n\nint main() {\n\tn = read(); q = read();\n\tfor (int i = 1; i <= n; i++) fa[i] = i, size[i] = 1;\n\tint x, y, z;\n\tfor (int i = 1; i < n; i++) {\n\t\tt[i].x = read(); t[i].y = read(); t[i].z = read();\n\t}\n\tfor (int i = 1; i <= q; i++) {\n\t\ta[i].k = read(); a[i].u = read(); a[i].id = i;\n\t}\n\tsort(a + 1, a + q + 1, cmp);\n\tsort(t + 1, t + n + 1, comp);\n\tint now = 0;\n\tfor (int i = 1; i <= q; i++) {\n\t\twhile (t[now + 1].z >= a[i].k) {//\u6ee1\u8db3\u8fb9\u6743>=k \n\t\t\tnow += 1;\n\t\t\tx = get(t[now].x); y = get(t[now].y);\n\t\t\tif (x == y) continue;\n\t\t\tfa[x] = y;\n\t\t\tsize[y] += size[x];//\u5408\u5e76\u8bb0\u5f97\u5408\u5e76size \n\t\t}\n\t\tans[a[i].id] = size[get(a[i].u)] - 1;//\u7b54\u6848\u8bb0\u5f97-1\u56e0\u4e3a\u63a8\u8350\u4e0d\u5305\u542b\u81ea\u5df1\u672c\u8eab \n\t}\n\tfor (int i = 1; i <= q; i++) printf(\"%d\\n\", ans[i]);\n\treturn 0;\n}\n```\n",
        "postTime": 1591409973,
        "uid": 18282,
        "name": "Phykyer",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P6111 \u3010[USACO18JAN]MooTube S\u3011"
    },
    {
        "content": "\u4e0d\u591a\u8bf4\uff0c\u672c\u9898\u4e3a\u5e76\u67e5\u96c6\u7684\u8f83\u9ad8\u96be\u5ea6\u9898\uff0c\u53ef\u4ee5\u8003\u8651\u79bb\u7ebf\u6765\u505a\u3002\n\n\u95ee\u9898\u8f6c\u5316\uff1a\u7ed9\u5b9a\u4e00\u68f5\u6811\uff0c\u6c42\u6bcf\u4e2a\u70b9\u5230\u5176\u4ed6\u70b9\u76f8\u5173\u6027\u5927\u4e8ekk\u7684\u6570\u91cf\uff0c\u8fd9\u91cc\u7684\u76f8\u5173\u6027\u8868\u793a\u4f7f\u4e24\u4e2a\u70b9\u8fde\u63a5\u7684\u8fb9\u6743\u4e2d\u6700\u5c0f\u503c\u3002  \ncode\uff1a\n```cpp\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nstruct ${ //\u5b58\u8be2\u95ee\u3002\n    int k,v,id; //id\u8868\u793a\u8be2\u95ee\u7f16\u53f7\u3002\u597d\u5c06\u7b54\u6848\u5b58\u8d77\u6765\u3002\u6700\u540e\u4e00\u8d77\u8f93\u51fa\u3002\n}_[1000005];\nstruct xyq{\n    int u,v,w;\n}e[1000005];\nstruct rule{ //\u5b58\u56fe\u3002\n    bool operator()(const xyq &s1,const xyq &s2){\n        return s1.w>s2.w;\n    }\n};\nstruct rule${ //\u81ea\u5b9a\u4e49\u6392\u5e8f\u3002\n    bool operator()(const $ &s1,const $ &s2){\n        return s1.k>s2.k;\n    }\n};\nint f[1000005],ans[1000005],size[1000005]; //f\u5b58\u5e76\u67e5\u96c6\u7684\u7236\u4eb2\u3002ans\u5b58\u7b54\u6848,size\u5b58\u5927\u5c0f\u3002\nint getfather(int iakioi){ //\u5e76\u67e5\u96c6\u627e\u7236\u4eb2\u3002\n    if(f[iakioi]==iakioi){\n        return iakioi;\n    }\n    f[iakioi]=getfather(f[iakioi]); //\u8def\u5f84\u538b\u7f29\u3002\n    return f[iakioi];\n}\nint main(){\n    int n,m,i,a,b,c,tot=0,sum=0;\n    cin>>n>>m;\n    for(i=0;i<n-1;++i){\n        cin>>e[i].u>>e[i].v>>e[i].w;\n    }\n    for(i=0;i<m;++i){\n        cin>>_[i].k>>_[i].v;\n        _[i].id=i; //\u521d\u59cb\u5316\u7f16\u53f7\u522b\u6f0f\u6389\u3002\n    }\n    for(i=0;i<=n;++i){\n        f[i]=i; //\u4e00\u5f00\u59cb\u81ea\u5df1\u7684\u7236\u4eb2\u90fd\u662f\u81ea\u5df1\u3002\n        size[i]=1; //\u4e00\u5f00\u59cb\u5143\u7d20\u7684\u5927\u5c0f\u90fd\u662f1\u3002\n    }\n    sort(e,e+n,rule());\n    sort(_,_+m,rule$());\n    for(i=0;i<m;++i){\n        while(_[i].k<=e[tot].w){\n            size[getfather(e[tot].v)]+=size[getfather(e[tot].u)];\n            f[getfather(e[tot].u)]=getfather(e[tot].v);\n            ++tot;\n        }\n        ans[_[i].id]=size[getfather(_[i].v)];\n    }\n    for(i=0;i<m;++i){\n        cout<<ans[i]-1<<endl; //\u51cf1\u662f\u56e0\u4e3a\u81ea\u5df1\u4e0d\u63a8\u8350\u81ea\u5df1\u3002\n    }\n    return 0;\n}\n```\n\n",
        "postTime": 1582692291,
        "uid": 271972,
        "name": "13998216887zhy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6111 \u3010[USACO18JAN]MooTube S\u3011"
    }
]
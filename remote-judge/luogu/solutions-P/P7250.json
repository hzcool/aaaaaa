[
    {
        "content": "\u901a\u8fc7\u89c2\u5bdf\uff0c\u53ef\u4ee5\u53d1\u73b0\u6b64\u9898\u548c\u6700\u5c0f\u751f\u6210\u6811\u5341\u5206\u76f8\u4f3c\uff08\u4e24\u4e2a\u5730\u70b9\u4e4b\u95f4\u9014\u7ecf\u7684\u6700\u5c0f\u503c\u6700\u5927\uff09\u3002\n\n\u4e8e\u662f\u53ef\u4ee5\u8003\u8651\u8fd9\u4e48\u505a\uff1a\n\n1. \u901a\u8fc7 bfs \u5c06\u6bcf\u4e00\u4e2a\u5757\u9884\u5904\u7406\u51fa\u6765\uff0c\u5e76\u8bb0\u5f55\u5176\u7f16\u53f7\u3001\u9ad8\u5ea6\u3001\u7c7b\u578b\uff08\u662f\u5426\u4e3a\u9ad8\u5730\uff09\u4ee5\u53ca\u8fb9\u7f18\u7684\u70b9\u3002\n\n2. \u5c06\u6bcf\u4e00\u4e2a\u5757\u6309\u9ad8\u5ea6\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\u3002\n\n3. \u4f9d\u6b21\u679a\u4e3e\u6bcf\u4e2a\u5757\uff1a\n\t- \u5bf9\u4e8e\u5f53\u524d\u8981\u5904\u7406\u7684\u5757\uff0c\u679a\u4e3e\u5176\u8fb9\u754c\u7684\u6240\u6709\u70b9\uff0c\u770b\u4f1a\u4e0e\u54ea\u4e9b\u5df2\u63d2\u5165\u7684\u5757\u76f8\u8fde\uff0c\u540c\u65f6\u7528\u5e76\u67e5\u96c6\u627e\u5230\u4ed6\u4eec\u7684\u201c\u7956\u5148\u201d\uff0c\u5373\u8be5\u5757\u6240\u8fde\u63a5\u5f62\u6210\u7684\u8fde\u901a\u5757\u5185\u6700\u9ad8\u7684\u9ad8\u5730\u3002\u7136\u540e\u9664\u4e86\u6700\u9ad8\u7684\u201c\u7956\u5148\u201d\uff0c\u5176\u4ed6\u9ad8\u5730\u9014\u7ecf\u7684\u6700\u5c0f\u503c\u6700\u5927\u4e3a\u5f53\u524d\u5757\u7684\u9ad8\u5ea6\u3002\n\n\t- \u5c06\u8fd9\u4e9b\u96c6\u5408\u5408\u5e76\uff0c\u66f4\u65b0\u5176\u201c\u7956\u5148\u201d\u3002\n    \n4. \u6392\u5e8f\u5e76\u8f93\u51fa\u7b54\u6848\u3002\n\n\u8981\u6ce8\u610f\u7684\u662f\uff0c\u7531\u4e8e\u6bcf\u4e2a\u96c6\u5408\u5185\u6700\u9ad8\u7684\u9ad8\u5730\u53ef\u80fd\u6709\u591a\u4e2a\uff0c\u6240\u4ee5\u9700\u8981\u5f00\u4e2a\u6570\u7ec4\u8bb0\u5f55\u4e00\u4e0b\u3002\n\n\u5177\u4f53\u770b\u4ee3\u7801\u5427\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N = 2000 + 5, N2 = 1e5 + 5;\nint n, m, a[N][N], id[N][N], fa[N2], vis[N2], dd[N2], dx[] = {0, 0, -1, 1, -1, -1, 1, 1}, dy[] = {-1, 1, 0, 0, -1, 1, 1, -1}, num[N2], tot = 0;\nstruct node{int id, h, type; vector<int> v;}b[N2]; //\u5757 \nstruct node2{int i, j; node2(int i = 0, int j = 0):i(i), j(j){}};\nstruct node3{int h, minn;}ans[N2];\nbool cmp(node x, node y) {return x.h > y.h;}\nbool cmp2(int x, int y) {return b[x].h > b[y].h;}\nbool cmp3(node3 x, node3 y) {if (x.h != y.h) return x.h > y.h; return x.minn > y.minn;}\nint ff(int x) {return (fa[x] == x)?x:fa[x] = ff(fa[x]);}\nqueue<node2> q;\nvector<int> tmp;\nvoid bfs(int sx, int sy) {\n\tq.push(node2(sx, sy)); ++tot;\n\tb[tot].id = tot; b[tot].h = a[sx][sy];\n\tid[sx][sy] = tot;\n\tint f1 = 1; //\u8be5\u8fde\u901a\u5757\u662f\u5426\u4e3a\u9ad8\u5730 \n\twhile (!q.empty()) {\n\t\tnode2 u = q.front(); q.pop();\n\t\tint f2 = 0; //\u8be5\u70b9\u662f\u5426\u5728\u8fb9\u7f18\u4e0a \n\t\tfor (int k = 0; k <= 7; ++k) {\n\t\t\tint tx = u.i + dx[k], ty = u.j + dy[k];\n\t\t\tif (tx < 1 || tx > n || ty < 1 || ty > m) continue;\n\t\t\tif (a[tx][ty] == a[sx][sy] && !id[tx][ty]) q.push(node2(tx, ty)), id[tx][ty] = tot;\n\t\t\tif (a[tx][ty] != a[u.i][u.j]) f2 = 1;\n\t\t\tif (a[tx][ty] > a[u.i][u.j]) f1 = 0;\n\t\t}\n\t\tif (f2) b[tot].v.push_back((u.i - 1) * m + u.j); \n\t}\n\tb[tot].type = f1;\n}\nint main() {\n\tios::sync_with_stdio(false); cin.tie(0); cout.tie(0);\n\tcin >> n >> m; for (int i = 1; i <= n; ++i) for (int j = 1; j <= m; ++j) cin >> a[i][j];\n\tfor (int i = 1; i <= n; ++i) {\n\t\tfor (int j = 1; j <= m; ++j) {\n\t\t\tif (!id[i][j]) bfs(i, j);\n\t\t}\n\t}\n\tint maxn = 0, cnt = 0;\n\tsort(b + 1, b + tot + 1, cmp);\n\tfor (int i = 1; i <= tot; ++i) {\n\t\tfa[i] = i; dd[b[i].id] = i; maxn = max(maxn, b[i].h);\n\t\tnum[i] = b[i].type;\n\t}\n\tfor (int i = 1; i <= tot; ++i) if (b[i].h == maxn) ans[++cnt].h = maxn, ans[cnt].minn = 0; //\u5148\u5c06\u6700\u9ad8\u7684\u9ad8\u5730\u7684\u7b54\u6848\u5904\u7406\u4e86 \n\tfor (int t = 1; t <= tot; ++t) {\n\t\tvis[t] = 1; //\u8bb0\u5f55\u6bcf\u4e2a\u5757\u662f\u5426\u5df2\u63d2\u5165 \n\t\ttmp.clear(); tmp.push_back(t); //tmp\u8bb0\u5f55\u4e0e\u5f53\u524d\u5757\u76f8\u90bb\u7684\u5757 \n\t\tfor (int i = 0; i < b[t].v.size(); ++i) {\n\t\t\tint x = (b[t].v[i] - 1) / m + 1, y = b[t].v[i] % m;\n\t\t\tif (!y) y = m;\n\t\t\tfor (int k = 0; k <= 7; ++k) {\n\t\t\t\tint tx = x + dx[k], ty = y + dy[k];\n\t\t\t\tif (tx < 1 || tx > n || ty < 1 || ty > m) continue;\n\t\t\t\tint d = ff(dd[id[tx][ty]]);\n\t\t\t\tif (vis[d] && d != t) tmp.push_back(d); //\u8bb0\u5f55\u5176\u4e0b\u6807 \n\t\t\t}\n\t\t}\n\t\tsort(tmp.begin(), tmp.end());\n\t\ttmp.erase(unique(tmp.begin(), tmp.end()), tmp.end()); //\u53bb\u91cd \n\t\tsort(tmp.begin(), tmp.end(), cmp2); //\u5c06\u5176\u9ad8\u5ea6\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\uff0c\u65b9\u4fbf\u540e\u7eed\u5904\u7406 \n\t\tint fir = tmp[0], c = 0; //fir\u8868\u793a\u6700\u9ad8\u7684\u9ad8\u5730 \n\t\tfor (int i = 0; i < tmp.size(); ++i) {\n\t\t\tif (b[tmp[i]].type && num[tmp[i]]) {\n\t\t\t\t++c;\n\t\t\t\tif (c == 1) fir = tmp[i];\n\t\t\t\telse {\n\t\t\t\t\tif (b[tmp[i]].h == b[fir].h) { //\u9ad8\u5ea6\u4e00\u6837\uff0c\u5408\u5e76\u5230fir \n\t\t\t\t\t\tnum[fir] += num[tmp[i]];\n\t\t\t\t\t\tnum[tmp[i]] = 0;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor (int j = 0; j < num[tmp[i]]; ++j) ans[++cnt].h = b[tmp[i]].h, ans[cnt].minn = b[t].h; //\u8bb0\u5f55\u7b54\u6848 \n\t\t\t\t\t\tnum[tmp[i]] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (int i = 0; i < tmp.size(); ++i) { //\u5408\u5e76\u96c6\u5408 \n\t\t\tif (tmp[i] != fir) {\n\t\t\t\tfa[tmp[i]] = fir;\n\t\t\t}\n\t\t}\n\t}\n\tsort(ans + 1, ans + cnt + 1, cmp3);\n\tcout << cnt << endl;\n\tfor (int i = 1; i <= cnt; ++i) cout << ans[i].h << \" \" << ans[i].minn << endl;\n\treturn 0;\n}\n```\n",
        "postTime": 1664011217,
        "uid": 173864,
        "name": "EstasTonne",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P7250 [BalticOI 2012 Day1] \u5c71\u5cf0"
    }
]
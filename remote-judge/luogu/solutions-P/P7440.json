[
    {
        "content": "### \u9898\u610f\n\n\u8bbe $\\text{cyc}_\\pi$ \u5c06\u957f\u4e3a $n$ \u7684\u6392\u5217 $\\pi$ \u5f53\u6210\u7f6e\u6362\u65f6\u6240\u80fd\u5206\u89e3\u6210\u7684\u5faa\u73af\u4e2a\u6570\u3002\u7ed9\u5b9a\u4e24\u4e2a\u6574\u6570 $n,k$ \u548c\u4e00\u4e2a $k-1$ \u6b21\u591a\u9879\u5f0f\uff0c\u5bf9 $1\\leq m\\leq n$ \u6c42\uff1a\n\n$$\n\\sum\\limits_{\\pi}F(\\text{cyc}_{\\pi})\n$$\n\n\u5176\u4e2d $\\pi$ \u662f\u957f\u5ea6\u4e3a $m$ \u4e14\u4e0d\u5b58\u5728\u4f4d\u7f6e $i$ \u4f7f\u5f97 $\\pi_i=i$ \u7684\u6392\u5217\u3002\n\n$\\texttt{Data Range:}1\\leq n,k\\leq 10^5$\u3002\n\n### \u9898\u89e3\n\n\u8f6c\u7f6e\u539f\u7406\u3002\n\n\u672c\u7bc7\u9898\u89e3\u540c\u65f6\u9002\u7528\u4e8e P7438 P7439 \u548c P7440\u3002\n\n\u9996\u5148\u5c06\u7ed9\u51fa\u7684\u591a\u9879\u5f0f\u8f6c\u6210\u725b\u987f\u7ea7\u6570\uff0c\u5373 $F(x)=\\sum\\limits_{i}f_i\\dbinom{x}{i}$\uff0c\u7136\u540e\u8003\u8651\u5bf9\u6bcf\u4e00\u4e2a $\\dbinom{x}{i}$ \u5355\u72ec\u8ba1\u7b97\uff0c\u5373\n\n$$\\sum\\limits_{\\pi}\\dbinom{\\text{cyc}_\\pi}{i}$$\n\n\u4e5f\u5373\u5bf9\u6240\u6709\u9519\u6392\u6c42\u73af\u6570\u9009 $i$ \u4e2a\u7684\u7b54\u6848\u3002\n\n\u5bf9\u4e8e\u9519\u6392\u800c\u8a00\u5176 EGF \u4e3a $e^{-x-\\ln(1-x)}$\uff0c\u800c\u4e00\u5143\u7684\u751f\u6210\u51fd\u6570\u4e0d\u8db3\u4ee5\u8868\u8fbe\u51fa\u73af\u6570\u8fd9\u4e2a\u4fe1\u606f\uff0c\u6240\u4ee5\u518d\u52a0\u4e00\u4e2a\u5143\u533a\u5206\u4e00\u4e0b\uff0c\u5373 $e^{(1+y)(-x-\\ln(1-x))}$\u3002\n\n\u5176\u4e2d $1+y$ \u8868\u793a\u7684\u662f\u5982\u679c\u9009\u8fd9\u4e2a\u73af\u5219\u8d21\u732e\u4e3a $y$\uff0c\u5426\u5219\u8d21\u732e\u4e3a $1$\uff0c\u5982\u679c\u4e0d\u719f\u6089\u7ec4\u5408\u7b26\u53f7\u5316\u7684\u8bfb\u8005\u53ef\u4ee5\u4f7f\u7528 DP \u5f97\u5230\u7ed3\u679c\uff0c\u8fd9\u91cc\u7b80\u5355\u8bb2\u4e00\u4e0b\u3002\n\n\u8bbe $f_{i,j}$ \u8868\u793a\u957f\u5ea6\u4e3a $i$ \u7684\u6392\u5217\u9009 $j$ \u4e2a\u73af\u7684\u7b54\u6848\uff0c\u8003\u8651\u679a\u4e3e $n$ \u6240\u5728\u7684\u73af\u7684\u957f\u5ea6\uff0c\u5219\u6709\n\n$$f_{i,j}=\\sum\\limits_{k\\geq 2}\\binom{n-1}{k-1}(k-1)!(f_{i-k,j}+f_{i-k,j-1})$$\n\n\u540c\u6837\u53ef\u4ee5\u5f97\u5230\u4e0a\u9762\u7684\u5f0f\u5b50\u3002\n\n\u8003\u8651\u5bf9 GF \u6c42\u504f\u5bfc\uff0c\u5219\u6709\n\n$$\\frac{\\partial}{\\partial x}F(x,y)=\\frac{x(1+y)}{1-x}F(x,y)$$\n\n$$[x^n]\\frac{\\partial}{\\partial x}F(x,y)=[x^n]\\frac{x(1+y)}{1-x}F(x,y)$$\n\n$$(n+1)[x^{n+1}]F(x,y)=[x^n]\\frac{y}{1-x}F(x,y)+[x^n]\\frac{1}{1-x}F(x,y)$$\n\n$$(n+1)[x^{n+1}y^m]F(x,y)=[x^ny^{m-1}]\\frac{1}{1-x}F(x,y)+[x^ny^m]\\frac{1}{1-x}F(x,y)$$\n\n$$(n+1)[x^{n+1}y^m]F(x,y)=\\sum_{i}[x^iy^{m-1}]F(x,y)+[x^iy^m]F(x,y)$$\n\n\u9012\u63a8\u7cfb\u6570\u5373\u53ef\uff0c\u590d\u6742\u5ea6 $O(nk)$\uff0c\u53ef\u4ee5\u901a\u8fc7 P7438\u3002\n\n---\n\n\u73b0\u5728\u8003\u8651 $k=10^5$ \u6c42\u4e00\u9879\uff0c\u8fd9\u4e2a\u65f6\u5019\u7531\u4e8e\u662f $1+y$ \u4e0d\u597d\u5904\u7406\uff0c\u8003\u8651\u5148\u6c42 $[x^n]e^{y(-x-\\ln(1-x))}$\u3002\n\n\u8003\u8651\u62c9\u683c\u6717\u65e5\u53cd\u6f14\uff0c\u8bbe $\\dfrac{G^2(x)}{2}=-x-\\ln(1-x)$\uff0c\u5176\u590d\u5408\u9006\u4e3a $H(x)$\uff0c\u5219 $F(x,y)$ \u5b9e\u8d28\u4e0a\u662f $G(x)$ \u4e0e $e^{\\frac{x^2y}{2}}$ \u7684\u590d\u5408\uff0c\u5219\u6839\u636e\u62d3\u5c55\u62c9\u683c\u6717\u65e5\u53cd\u6f14\u6709\n\n$$[x^n]e^\\frac{G^2(x)y}{2}=\\frac{1}{n}[x^{n-1}]xye^{\\frac{x^2y}{2}}\\left(\\frac{x}{H(x)}\\right)^n$$\n\n\u6ce8\u610f\u5230\n\n$$xye^{\\frac{x^2y}{2}}=\\sum\\limits_{i}\\frac{x^{2i+1}y^{i+1}}{2^ii!}$$\n\n\u6240\u4ee5\u6709\n\n$$\\frac{1}{n}[x^{n-1}y^m]xye^{\\frac{x^2y}{2}}\\left(\\frac{x}{H(x)}\\right)^n=\\frac{1}{n2^{m-1}(m-1)!}[x^{n-2m}]\\left(\\frac{x}{H(x)}\\right)^n$$\n\n\u5982\u679c\u77e5\u9053\u590d\u5408\u9006\u7684\u8bdd\u53ef\u4ee5\u76f4\u63a5\u7b97\uff0c\u73b0\u5728\u8003\u8651\u6c42 $H(x)$\u3002\u7531\u4e8e $G(x)$ \u6709\u7b80\u5355\u7684\u5c01\u95ed\u5f62\u5f0f\u53ef\u4ee5\u725b\u8fed\uff0c\u5373\n\n$$\\frac{G^2(x)}{2}=-x-\\ln(1-x)$$\n\n\u90a3\u4e48\u6709\n\n$$\\frac{x^2}{2}=-H(x)-\\ln(1-H(x))$$\n\n\u5373\n\n$$2H(x)+2\\ln(1-H(x))+x^2=0$$\n\n\u76f4\u63a5\u725b\u8fed\u5373\u53ef\uff0c\u6ce8\u610f\u4e2d\u95f4\u6709\u53ef\u80fd\u4f1a\u5bf9\u4e00\u4e2a\u6ca1\u6709\u5e38\u6570\u9879\u7684\u591a\u9879\u5f0f\u6c42\u9006\uff0c\u8fd9\u91cc\u5206\u5b50\u5206\u6bcd\u540c\u65f6\u9664\u4ee5 $x$ \u5373\u53ef\uff0c\u540c\u65f6 $H(x)$ \u7684\u521d\u503c\u4e3a $x$\uff0c\u800c\u4e14\u7531\u4e8e\u9664\u6cd5\u7684\u539f\u56e0\u6b21\u6570\u4f1a\u4e0d\u5bf9\uff0c\u591a\u8fed\u4ee3\u4e00\u6b21\u5373\u53ef\uff0c\u53ef\u4ee5\u901a\u8fc7 P7439\u3002\n\nalpha1022 \u548c cmd_block \u7684\u725b\u8fed\u5f0f\u5b50\u4e0e\u8fd9\u4e2a\u6709\u6240\u4e0d\u540c\uff0c\u611f\u5174\u8da3\u7684\u8bfb\u8005\u53ef\u4ee5\u770b\u770b\u3002\n\n---\n\n\u73b0\u5728\u8003\u8651 P7440\uff0c\u4e5f\u5c31\u662f\u672c\u9898\u3002\u8bbe $G(x,y)=e^{(1+y)(-x-\\ln(1-x))}$\uff0c\u76ee\u6807\u53d8\u6210\u4e86\u8ba1\u7b97\n\n$$\\sum\\limits_{i}f_i[y^i]G(x,y)$$\n\n\u8003\u8651\u8f6c\u7f6e\u539f\u7406\uff0c\u53d8\u6210\u6c42\n\n$$\\sum\\limits_{i}f_i[x^i]G(x,y)$$\n\n\u5bf9 $G(x,y)$ \u6c42\u504f\u5bfc\u5219\u6709\n\n$$\\frac{\\partial}{\\partial x}G(x,y)=\\frac{x(1+y)}{1-x}G(x,y)$$\n\n\u8bbe $F_i=[x^i]G(x,y)$ \u5219\u6709\n\n$$F_i=\\frac{i-1}{i}F_{i-1}+\\frac{y+1}{i}F_{i-2}$$\n\n\u7528\u77e9\u9635\u8868\u793a\u4e00\u4e0b\u5219\u6709\n\n$$\\begin{pmatrix}F_i&F_{i-1}\\end{pmatrix}=\\begin{pmatrix}F_{i-1}&F_{i-2}\\end{pmatrix}\\begin{pmatrix}\\dfrac{i-1}{i}&1\\\\\\dfrac{y+1}{i}&0\\end{pmatrix}$$\n\n\u8bbe\n\n$$\\begin{pmatrix}F_i&F_{i-1}\\end{pmatrix}=\\begin{pmatrix}F_{i-1}&F_{i-2}\\end{pmatrix}A_i$$\n\n\u5219\u5b9e\u9645\u4e0a\u7684\u5c31\u662f\n\n$$\\sum\\limits_{i}\\begin{pmatrix}f_i&0\\end{pmatrix}\\prod_{j=1}^{i}A_j$$\n\n\u53f3\u8fb9\u7684\u77e9\u9635\u4e58\u79ef\u53ef\u4ee5\u4f7f\u7528\u5206\u6cbb FFT\uff0c\u7136\u540e\u7b97\u8fd9\u4e2a\u4e5f\u53ef\u4ee5\u5206\u6cbb\u7b97\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log^2n+k\\log^2k)$\u3002",
        "postTime": 1616460666,
        "uid": 60990,
        "name": "Karry5307",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P7440 \u3010\u300cKrOI2021\u300dFeux Follets\u3011"
    },
    {
        "content": "\u524d\u7f6e\u829d\u58eb\uff1a[\u8f6c\u7f6e\u539f\u7406](https://www.luogu.com.cn/blog/wangrx/tellegen-s--principle)  \n# \u9898\u610f\n\n\u8bbe $\\text{cyc}_\\pi$ \u4e3a\u5c06\u957f\u4e3a $n$ \u7684\u6392\u5217 $\\pi$ \u5f53\u6210\u7f6e\u6362\u65f6\u6240\u80fd\u5206\u89e3\u6210\u7684\u5faa\u73af\u7f6e\u6362\u4e2a\u6570\u3002  \n\u7ed9\u5b9a\u4e24\u4e2a\u6574\u6570 $n,k$ \u548c\u4e00\u4e2a $k-1$ \u6b21\u591a\u9879\u5f0f\uff0c\u5bf9 $1\\leq m\\leq n$ \u6c42\uff1a\n\n$$\\sum\\limits_{\\pi}F(\\text{cyc}_{\\pi})$$\n\n\u5176\u4e2d $\\pi$ \u662f\u957f\u5ea6\u4e3a $m$ \u4e14\u4e0d\u5b58\u5728\u4f4d\u7f6e $i$ \u4f7f\u5f97 $\\pi_i=i$ \u7684\u6392\u5217\u3002\n\n$\\texttt{Data Range:}1\\leq n,k\\leq 10^5$\n\n\u5982\u679c\u4f60\u4e0d\u77e5\u9053\u7f6e\u6362\u662f\u5565\uff0c\u8bf7\u770b\uff1a  \n[oi-wiki \u7f6e\u6362\u7fa4](https://oi-wiki.org/math/permutation-group/)  \n\u94fe\u63a5\u91cc\u6ca1\u63d0\u5230\u7684\u4e1c\u897f\uff08\u6015\u542c\u4e0d\u61c2\uff09\uff1a\n- \uff08\u6620\u5c04\u7684\u5b9a\u4e49\uff09\u51fd\u6570\u662f\u6620\u5c04\u7684\u4e00\u79cd\u3002\n- $\\dbinom{a_1,a_2}{a_{p_1},a_{p_2}}$ \u4e0e $\\dbinom{a_2,a_1}{a_{p_2},a_{p_1}}$ \u662f\u540c\u4e00\u79cd\u7f6e\u6362\u3002  \n  \uff08\u53ea\u8981\u4e0a\u4e0b\u5bf9\u5e94\u5c31\u53ef\u4ee5\u4e86\uff0c\u987a\u5e8f\u65e0\u6240\u8c13\uff09\n\n# \u9898\u89e3\n\n\u9996\u5148\u8003\u8651 $\\text{exp}$ \u7684\u7ec4\u5408\u610f\u4e49\uff1a\n\n> \u82e5 $f_n$ \u8868\u793a\u5bf9 $n$ \u4e2a\u4e0d\u540c\u7684\u5143\u7d20\u4f5c\u67d0\u79cd\u8ba1\u6570\uff0c$f(x)=\\displaystyle\\sum_{k=0}^\\infty f_kx^k$\uff0c  \n \u5219 $\\text{OGF}(e^{\\text{EGF}f})$ \u8868\u793a\u5c06 $n$ \u79cd\u4e0d\u540c\u5143\u7d20\u5212\u5206\u4e3a\u4efb\u610f\u4e2a\u65e0\u6807\u53f7\u96c6\u5408\uff0c  \n \u6bcf\u4e2a\u96c6\u5408\u5185\u7684\u5143\u7d20\u5206\u522b\u4f5c\u8be5\u79cd\u8ba1\u6570\u7684\u65b9\u6848\u6570\u3002  \n\u8bc1\u660e\uff1a\u5df2\u77e5 $e^{f(x)}=\\displaystyle\\sum_k\\frac{f^k(x)}{k!}$\uff0c\u7531\u5377\u79ef\u548c\u6307\u6570\u751f\u6210\u51fd\u6570\u7684\u5b9a\u4e49\u53ef\u77e5  \n> $$[x^n]\\text{OGF}(e^{\\text{EGF} f})=\\sum_{k}\\frac{1}{k!}\\sum_{\\sum_{i=1}^ka_i=n}\\binom{n}{a_1,a_2,\\cdots a_k}\\prod_{i=1}^kf_{a_i}$$\n> - $\\displaystyle\\sum_{i=1}^ka_i=n$ \u8868\u793a\u603b\u5171\u6709 $n$ \u4e2a\u5143\u7d20\u3002\n> - $\\dbinom{n}{a_1,a_2,\\cdots a_k}$ \u8868\u793a\u5212\u5206\u4e3a $k$ \u4e2a\u96c6\u5408\u3002\n> - $\\dfrac{1^{}}{k!}$ \u8868\u793a\u53bb\u6389\u6807\u53f7\u3002  \n> $\\displaystyle\\prod_{i=1}^kf_{a_i}$ \u8868\u793a\u6bcf\u4e2a\u96c6\u5408\u5185\u5206\u522b\u4f5c\u8be5\u79cd\u8ba1\u6570\u3002  \n> \u8bc1\u6bd5\u3002\n\n\n\u957f\u5ea6\u4e3a $n$ \u7684\u6392\u5217\u5f53\u6210\u7f6e\u6362\uff0c\u53ef\u5212\u5206\u4e3a\u4efb\u610f\u4e2a\u5faa\u73af\u7f6e\u6362\u3002  \n\u7531\u4e8e \u957f\u5ea6\u4e3a $k$ \u7684\u6392\u5217\u6570 \u4e3a $k!$\uff0c\u5bf9\u5e94\u7684\u6307\u6570\u751f\u6210\u51fd\u6570\u4e3a $\\dfrac{1}{1-x}$\uff0c  \n\u53ef\u5f97 \u957f\u5ea6\u4e3a $k$ \u7684\u5faa\u73af\u7f6e\u6362\u6570 \u5bf9\u5e94\u7684\u6307\u6570\u751f\u6210\u51fd\u6570\u4e3a $\\ln \\dfrac{1}{1-x}=-\\ln(1-x)$\u3002  \n\n\u7531\u4e8e\u9519\u6392\u8981\u6c42\u6ca1\u6709 \u957f\u5ea6\u4e3a $1$ \u7684\u5faa\u73af\u7f6e\u6362\uff0c  \n\u56e0\u6b64 \u957f\u5ea6\u4e3a $k$ \u7684\u9519\u6392\u6570 \u5bf9\u5e94\u7684\u6307\u6570\u751f\u6210\u51fd\u6570\u4e3a $e^{-\\ln(1-x)-x}$\n\n\u8fd9\u4e2a\u8fc7\u7a0b\u6ca1\u6709\u8ba1\u7b97\u9519\u6392\u4e2d\u5faa\u73af\u7f6e\u6362\u7684\u6570\u76ee\uff0c\u8003\u8651\u4ece\u4e2d\u9009\u82e5\u5e72\u4e2a\uff1a  \n$\\text{EGF}_x$ \u8868\u793a\u4ee5 $x$ \u4e3a\u4e3b\u5143\u7684\u6307\u6570\u751f\u6210\u51fd\u6570\uff08$\\text{OGF}_x$ \u540c\u7406\uff09\uff0c\u5219\n$$[x^n]\\text{OGF}_x(e^{y\\text{EGF}_xf})=\\sum_{k}\\frac{1}{k!}\\sum_{\\sum_{i=1}^ka_i=n}\\binom{n}{a_1,a_2,\\cdots a_k}\\prod_{i=1}^kf_{a_i}y$$\n$$=\\sum_{k}\\frac{1}{k!}\\sum_{\\sum_{i=1}^ka_i=n}\\binom{n}{a_1,a_2,\\cdots a_k}(\\prod_{i=1}^kf_{a_i})y^k$$\n\u56e0\u6b64\u8bbe $g(x,y)=e^{y(-\\ln(1-x)-x)}$\uff0c  \n\u5219 $[x^ny^k](\\text{OGF}_x g)$ \u5c31\u662f\u957f\u5ea6\u4e3a $n$ \u7684\uff0c\u53ef\u5206\u89e3\u4e3a $k$ \u4e2a\u5faa\u73af\u7f6e\u6362\u7684\u9519\u6392\u6570\u3002\n\n----------------------------------\n\u8bbe\u7b54\u6848\u5e8f\u5217\u4e3a $ans$\uff0c\u5219\u663e\u7136\n$$ans_m=\\sum_{k=0}^mF(k)[x^my^k](\\text{OGF}_x g)\n$$\n$\\qquad\\qquad\\qquad\\displaystyle\\frac{ans_m}{m!}=\\sum_{k=0}^nF(k)[x^my^k]g(x,y)$\uff08$k>m$ \u65f6\uff0c$[x^my^k]g(x,y)=0$\uff09\n\n\u591a\u70b9\u6c42\u503c\u6c42\u51fa $v_k=F(k)$ \u3002\n\n\u53f3\u8fb9\u7684\u90e8\u5206\u53ef\u4ee5\u770b\u4f5c\u77e9\u9635\u4e58\u5411\u91cf\uff0c\u8bbe $G_{m,k}=[x^my^k]g(x,y)$\uff0c  \n\u5219 $\\dfrac{ans_m}{m!}=\\displaystyle\\sum_{k=0}^n G_{m,k}v_k=(G\\vec{v})_m$\u3002\n\n\u56e0\u6b64\u8fd9\u662f\u4e2a\u7ebf\u6027\u7b97\u6cd5\uff0c\u4e14\u662f\u4e2a\u65b9\u9635\u3002\u8003\u8651\u8f6c\u7f6e\u539f\u7406\uff1a  \n### 1. \u627e\u51fa\u5982\u4f55\u8ba1\u7b97 $G^T\\vec{v}$\n$(G^T\\vec{v})_m=\\displaystyle\\sum_{k=0}^n G_{k,m}v_k=\\sum_{k=0}^nv_k[x^ky^m]g(x,y)$ \u3002  \n   \u8bbe $g(x,y)=\\displaystyle\\sum_kg_k(y)x^k,$  \n$f(y)=\\displaystyle\\sum_{m=0}^n(G^T\\vec{v})_my^m=\\sum_{k=0}^nv_k[x^k]g(x,y)=\\sum_{k=0}^nv_kg_k(y)$\u3002    \n  \u4e3a\u627e\u5230 $g_k(y)$ \u4e4b\u95f4\u7684\u5173\u7cfb\uff0c$g(x,y)$ \u5bf9 $x$ \u6c42\u504f\u5bfc\u5f97  \n  $$\\dfrac{\\partial g(x,y)}{\\partial x}=g(x,y)y(\\dfrac{1}{1-x}-1)$$  \n  \u5df2\u77e5 $[x^{k-1}]\\dfrac{\\partial g(x,y)}{\\partial x}=kg_{k}(y),[x^k]g(x,y)y=g_k(y)y$\uff0c\u5219  \n\n$$kg_k(y)=\\sum_{i=1}^{k-1}g_{k-1-i}(y)y=\\sum_{i=0}^{k-2}g_i(y)y$$\n\n\u53ef\u4ee5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u6765\u4f18\u5316 $g_k(y)$ \u7684\u8ba1\u7b97\uff0c  \n\u8bbe $\\vec{u}_k=\\begin{pmatrix}g_k(y)&\\displaystyle\\sum_{i=0}^{k-1}g_i(y)\\end{pmatrix}=\\vec{u}_{k-1}W_k$\uff0c\n\u5219 \n$$\n\\vec{u}_0=\\begin{pmatrix}\ng_0(y)&\\displaystyle\\sum_{i=0}^{-1}g_i(y)\n\\end{pmatrix}=\\begin{pmatrix}\ng(0,y)&0\n\\end{pmatrix}=\\begin{pmatrix}\n1&0\n\\end{pmatrix}$$\n$$\nW_k=\\begin{bmatrix}\n0&1\\\\\\dfrac{y}{k}&1\n\\end{bmatrix},\n\\vec{u}_k=\\vec{u}_0W_1\\cdots W_k\n$$\n\u5c06 $\\vec{u}_0$ \u8865\u5168\u4e3a\u5355\u4f4d\u77e9\u9635 $W_0=I=\\begin{bmatrix}1&0\\\\0&1\\end{bmatrix}$\uff0c\n\n\u4e8e\u662f $\\begin{bmatrix}f(y)&\\cdots\\\\\\cdots&\\cdots\\end{bmatrix}=\\displaystyle\\sum_{k=0}^n v_k\\begin{bmatrix}\\underline{\\vec{u}_k}\\\\\\cdots\\end{bmatrix}=\\sum_{k=0}^nv_kW_0W_1\\cdots W_k$\n\n\u6700\u7ec8\u53ef\u5206\u6cbb FFT \u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1a  \n\u8bbe $B_{l,r}=W_lW_{l+1}\\cdots W_r,A_{l,r}=\\displaystyle\\sum_{k=l}^r v_kB_{l,k}$\u3002\n\n\u8bbe $l\\le mid<r$\uff0c\u5219\n\n$$B_{l,r}=B_{l,mid}B_{mid+1,r}$$\n$$A_{l,r}=A_{l,mid}+B_{l,mid}A_{mid+1,r}$$\n\n$B_{l,l}=W_l,A_{l,l}=v_lW_l$\uff0c\u8ba1\u7b97 $\\vec{u_0}A_{0,n}$ \u5373\u53ef\u3002\n\n### 2.\u5c06 $G^T\\vec{a}$ \u5316\u4e3a\u7ebf\u6027\u7b97\u6cd5\u7684\u6807\u51c6\u5f62\u5f0f\n\u8bbe $A_{l,r}=\\begin{bmatrix}\\vec{a}_{l,r,0}&\\vec{a}_{l,r,1}\\\\\\vec{a}_{l,r,2}&\\vec{a}_{l,r,3}\\end{bmatrix},B_{l,r}=\\begin{bmatrix}\\vec{b}_{l,r,0}&\\vec{b}_{l,r,1}\\\\\\vec{b}_{l,r,2}&\\vec{b}_{l,r,3}\\end{bmatrix}$\uff0c\u5219\u8fc7\u7a0b\u4e3a\n\n- \u81ea\u4e0b\u800c\u4e0a\u521d\u59cb\u5316\u5e38\u91cf\uff08$\\times$ \u4e3a\u591a\u9879\u5f0f\u4e58\u6cd5\uff09\uff1a\n  - $\\vec{b}_{l,l,0}=\\dbinom{0}{0},\\vec{b}_{l,l,2}=\\begin{pmatrix}0\\\\\\dfrac{1}{l}\\end{pmatrix},\\vec{b}_{l,l,1}=\\vec{b}_{l,l,3}=\\dbinom{1}{0}$\n  - $\\vec{b}_{l,r,0}=\\vec{b}_{l,mid,0}\\times\\vec{b}_{mid+1,r,0}+\\vec{b}_{l,mid,1}\\times\\vec{b}_{mid+1,r,2}$  \n    $\\vec{b}_{l,r,1}=\\vec{b}_{l,mid,0}\\times\\vec{b}_{mid+1,r,1}+\\vec{b}_{l,mid,1}\\times\\vec{b}_{mid+1,r,3}$  \n    $\\vec{b}_{l,r,2}=\\vec{b}_{l,mid,2}\\times\\vec{b}_{mid+1,r,0}+\\vec{b}_{l,mid,3}\\times\\vec{b}_{mid+1,r,2}$  \n    $\\vec{b}_{l,r,3}=\\vec{b}_{l,mid,2}\\times\\vec{b}_{mid+1,r,1}+\\vec{b}_{l,mid,3}\\times\\vec{b}_{mid+1,r,3}$\n- \u521d\u59cb\u5316\u5411\u91cf\u4e3a $\\begin{pmatrix}\\underline{\\vec{v}}\\\\\\vec{0}\\end{pmatrix},\\vec{0}$ \u4e3a\u521d\u59cb\u5316\u7684\u5185\u5b58\u3002\n- \u8d4b\u503c\uff08\u5b9e\u9645\u4e3a\u7d2f\u52a0\uff09\uff1a \n  - $(\\vec{a}_{l,l,2})_1\\leftarrow(\\vec{a}_{l,l,2})_1+\\dfrac{1}{l}\\times v_l$\n  - $(\\vec{a}_{l,l,1})_0\\leftarrow(\\vec{a}_{l,l,1})_0+v_l$\n  - $(\\vec{a}_{l,l,3})_0\\leftarrow(\\vec{a}_{l,l,3})_0+v_l$\n- \u81ea\u4e0b\u800c\u4e0a\u5206\u6cbb\uff1a\n  - $\\vec{a}_{l,r,0}\\leftarrow\\vec{a}_{l,r,0}+\\vec{a}_{l,mid,0}$\uff08\u8fd9\u91cc\u53ea\u6709\u4f4e\u4f4d\u5bf9\u5e94\u4f4d\u7f6e\u76f8\u52a0\uff09  \n    $\\vec{a}_{l,r,0}\\leftarrow\\vec{a}_{l,r,0}+\\vec{b}_{l,mid,0}\\times\\vec{a}_{mid+1,r,0}$  \n    $\\vec{a}_{l,r,0}\\leftarrow\\vec{a}_{l,r,0}+\\vec{b}_{l,mid,1}\\times\\vec{a}_{mid+1,r,2}$\n  - $\\vec{a}_{l,r,1}\\leftarrow\\vec{a}_{l,r,1}+\\vec{a}_{l,mid,1}$  \n    $\\vec{a}_{l,r,1}\\leftarrow\\vec{a}_{l,r,1}+\\vec{b}_{l,mid,0}\\times\\vec{a}_{mid+1,r,1}$  \n    $\\vec{a}_{l,r,1}\\leftarrow\\vec{a}_{l,r,1}+\\vec{b}_{l,mid,1}\\times\\vec{a}_{mid+1,r,3}$ \n  - $\\vec{a}_{l,r,2}\\leftarrow\\vec{a}_{l,r,2}+\\vec{a}_{l,mid,2}$  \n    $\\vec{a}_{l,r,2}\\leftarrow\\vec{a}_{l,r,2}+\\vec{b}_{l,mid,2}\\times\\vec{a}_{mid+1,r,0}$  \n    $\\vec{a}_{l,r,2}\\leftarrow\\vec{a}_{l,r,2}+\\vec{b}_{l,mid,3}\\times\\vec{a}_{mid+1,r,2}$ \n  - $\\vec{a}_{l,r,3}\\leftarrow\\vec{a}_{l,r,3}+\\vec{a}_{l,mid,3}$  \n    $\\vec{a}_{l,r,3}\\leftarrow\\vec{a}_{l,r,3}+\\vec{b}_{l,mid,2}\\times\\vec{a}_{mid+1,r,1}$  \n    $\\vec{a}_{l,r,3}\\leftarrow\\vec{a}_{l,r,3}+\\vec{b}_{l,mid,3}\\times\\vec{a}_{mid+1,r,3}$\n\n- \u6700\u540e\u8d4b\u503c\uff08\u5b9e\u9645\u4e3a\u4ea4\u6362\uff09\uff1a$\\vec{v}\\leftrightarrow\\vec{a}_{0,n,0}$ \u3002\n- \u5c06\u8f85\u52a9\u53d8\u91cf\u6e05\u96f6\u3002\n\n### 3. ~~\u4e00\u677f\u4e00\u773c\u5730~~\u8f6c\u7f6e\u7b97\u6cd5\n\n- \u81ea\u4e0b\u800c\u4e0a\u521d\u59cb\u5316\u5e38\u91cf\u3002\n- \u521d\u59cb\u5316\u5411\u91cf\u4e3a $\\begin{pmatrix}\\underline{\\vec{v}}\\\\\\vec{0}\\end{pmatrix},\\vec{0}$ \u4e3a\u521d\u59cb\u5316\u7684\u5185\u5b58\u3002\n- \u5c06\u8f85\u52a9\u53d8\u91cf\u6e05\u96f6\u3002\n- \u8d4b\u503c\uff08\u5b9e\u9645\u4e3a\u4ea4\u6362\uff09\uff1a $\\vec{a}_{0,n,0}\\leftrightarrow\\vec{v}$ \u3002\n- \u81ea\u4e0a\u800c\u4e0b\u5206\u6cbb\uff1a\uff08$\\times^T$ \u4e3a\u8f6c\u7f6e\u5377\u79ef\uff09\n  - $\\vec{a}_{mid+1,r,3}\\leftarrow\\vec{a}_{mid+1,r,3}+\\vec{b}_{l,mid,3}\\times^T\\vec{a}_{l,r,3}$  \n    $\\vec{a}_{mid+1,r,1}\\leftarrow\\vec{a}_{mid+1,r,1}+\\vec{b}_{l,mid,2}\\times^T\\vec{a}_{l,r,3}$  \n    $\\vec{a}_{l,mid,3}\\leftarrow\\vec{a}_{l,mid,3}+\\vec{a}_{l,r,3}$\uff08\u8d85\u51fa $\\vec{a}_{l,mid,3}$ \u957f\u5ea6\u7684\u90e8\u5206\u4e0d\u8981\uff0c\u4ee5\u4e0b\u540c\u7406\uff09  \n  - $\\vec{a}_{mid+1,r,2}\\leftarrow\\vec{a}_{mid+1,r,2}+\\vec{b}_{l,mid,3}\\times^T\\vec{a}_{l,r,2}$  \n    $\\vec{a}_{mid+1,r,0}\\leftarrow\\vec{a}_{mid+1,r,0}+\\vec{b}_{l,mid,2}\\times^T\\vec{a}_{l,r,2}$   \n    $\\vec{a}_{l,mid,1}\\leftarrow\\vec{a}_{l,mid,1}+\\vec{a}_{l,r,2}$  \n\n  -  $\\vec{a}_{mid+1,r,3}\\leftarrow\\vec{a}_{mid+1,r,3}+\\vec{b}_{l,mid,1}\\times^T\\vec{a}_{l,r,1}$  \n    $\\vec{a}_{mid+1,r,1}\\leftarrow\\vec{a}_{mid+1,r,1}+\\vec{b}_{l,mid,0}\\times^T\\vec{a}_{l,r,1}$  \n     $\\vec{a}_{l,mid,1}\\leftarrow\\vec{a}_{l,mid,1}+\\vec{a}_{l,r,1}$   \n    \n  - $\\vec{a}_{mid+1,r,2}\\leftarrow\\vec{a}_{mid+1,r,2}+\\vec{b}_{l,mid,1}\\times^T\\vec{a}_{l,r,0}$  \n    $\\vec{a}_{mid+1,r,0}\\leftarrow\\vec{a}_{mid+1,r,0}+\\vec{b}_{l,mid,0}\\times^T\\vec{a}_{l,r,0}$  \n    $\\vec{a}_{l,mid,0}\\leftarrow\\vec{a}_{l,mid,0}+\\vec{a}_{l,r,0}$  \n- \u6700\u540e\u8d4b\u503c\uff08\u5b9e\u9645\u4e3a\u7d2f\u52a0\uff09\uff1a\n  - $v_l\\leftarrow v_l+(\\vec{a}_{l,l,3})_0$\n  - $v_l\\leftarrow v_l+(\\vec{a}_{l,l,1})_0$\n  - $v_l\\leftarrow v_l+\\dfrac{1}{l}\\times (\\vec{a}_{l,l,2})_1$\n\n\u4e2d\u95f4\u8fd9\u6b65\u5b9e\u9645\u4e0a\u7b49\u4ef7\u4e8e\uff1a\n- $A_{l,mid}\\leftarrow A_{l,r}$\n- $A_{mid+1,r}\\leftarrow B^T_{l,mid}\\times^TA_{l,r}$  \n\n\n\u663e\u7136\u4ee3\u7801\u4f1a\u5f88\u4e11\uff0c\u5c31\u4e0d\u653e\u4e86\u3002\n\n# \u540e\u8bb0\n\u5199\u4e86\u8fd9\u9053\u9898\u540e\uff0c\u5bf9\u8f6c\u7f6e\u539f\u7406\u548c\u751f\u6210\u51fd\u6570\u7684\u7406\u89e3\u52a0\u6df1\u4e86\u5f88\u591a\u3002\n\n\u6bd4\u5982 exp \u7684\u7ec4\u5408\u610f\u4e49\uff0c\u591a\u5143\u751f\u6210\u51fd\u6570\u7684\u6280\u5de7\u3001\u77e9\u9635\u4f18\u5316\u591a\u9879\u5f0f\u8fd0\u7b97\u7b49\uff0c\u90fd\u662f\u5728\u8fd9\u9053\u9898\u4e2d\u5b66\u4e60\u5f97\u5230\u7684\u3002\n\n\u611f\u8c22 @GuidingStar \u7684\u6307\u5bfc\u3002 ",
        "postTime": 1622165333,
        "uid": 104726,
        "name": "wangrx",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P7440\u300cKrOI2021\u300dFeux Follets"
    },
    {
        "content": "\u91cd\u6784\u4e00\u4e0b\u9898\u89e3\u3002\n\n\u8003\u8651\u5148\u8fdb\u884c\u591a\u70b9\u6c42\u503c\uff0c\u95ee\u9898\u8f6c\u5316\u4e3a\u5bf9\u7ed9\u5b9a\u7684\u6570\u5217 $F_k$ \u548c $1 \\le m \\le n$\uff0c\u8ba1\u7b97\n$$\n\\sum\\limits_{|\\pi|=m} F_{\\mathrm{cyc}_{\\pi}}\n$$\n\n\u6211\u4eec\u81ea\u7136\u8003\u5bdf\u8ba1\u7b97\n$$\n\\sum\\limits_k F_k \\sum\\limits_{|\\pi|=m} [\\mathrm{cyc}_{\\pi}=k]\n$$\n\n\u8003\u8651\n$$\n\\sum\\limits_{1 \\le |\\pi| \\le n} z^{|\\pi|} t^{\\mathrm{cyc}_{\\pi}}\n$$\n\n\u6839\u636e Symbolic Methods\uff0c\u663e\u7136\u5176\u5373\n$$\nG(z,t) = \\mathrm e^{t(-\\ln(1-z)-z)}\n$$\n\n\u8003\u8651\u5b9e\u9645\u4e0a\u6211\u4eec\u9700\u8981\u8ba1\u7b97\n$$\n\\sum\\limits_k F_k [t^k] G(z,t)\n$$\n\n\u9996\u5148\u8003\u8651\u5176\u8f6c\u7f6e\n$$\n\\sum\\limits_k F_k [z^k] G(z,t)\n$$\n\n\u6ce8\u610f $G$ \u6ee1\u8db3\u5fae\u5206\u65b9\u7a0b\n$$\n\\frac{\\partial G(z,t)}{\\partial z} = \\frac{zt}{1-z} G(z,t)\n$$\n\n\u4ee4 $G_k = [z^k]G(z,t)$\uff0c\u5219\u5176\u6ee1\u8db3\n$$\nG_k = \\frac1k\\left[(k-1)G_{k-1}+tG_{k-2}\\right]\n$$\n\n\u5176\u8f6c\u79fb\u5bb9\u6613\u7528\u77e9\u9635\u63cf\u8ff0\u3002\u90a3\u4e48\u5bf9\u539f\u95ee\u9898\u7684\u8f6c\u7f6e\u7684\u8ba1\u7b97\u65b9\u5f0f\u65e0\u975e\u5c31\u662f\u8003\u8651\u5206\u6cbb\uff0c\u540c\u65f6\u7ef4\u62a4\u533a\u95f4\u5185\u7684\u77e9\u9635\u8fde\u4e58\u79ef\u548c\u533a\u95f4\u5185\u7684\u77e9\u9635\u8d21\u732e\u548c\u5373\u53ef\u3002  \n\u800c\u5bf9\u4e8e\u539f\u95ee\u9898\uff0c\u6211\u4eec\u5e94\u7528**\u8f6c\u7f6e\u539f\u7406**\u5c06\u5206\u6cbb\u8fc7\u7a0b\u9010\u6b65\u6539\u5199\u5373\u53ef\u3002",
        "postTime": 1616460400,
        "uid": 75840,
        "name": "deserter",
        "ccfLevel": 0,
        "title": "Feux Follets"
    }
]
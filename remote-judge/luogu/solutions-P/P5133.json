[
    {
        "content": "\n\u8fd9\u662f\u539f\u672c\u67d0\u573a\u6bd4\u8d5b\u7684\u7b2c12\u9898\n\n\u6574\u573a\u6bd4\u8d5b\u7684\u9898\u89e3\uff1a[QWQ](https://www.cnblogs.com/reverymoon/p/9927109.html)\n\n---\n\n\u9898\u76ee\u5927\u610f\uff1a\n\n\u5b9a\u4e49$t$\u4e3a\u6700\u5c0f\u7684\u4e0d\u662f$n$\u7684\u56e0\u5b50\u7684\u6570\n\n\u5b9a\u4e49$f(2) = 1$\uff0c\u5e76\u4e14$f(n) = f(t) + 1(n \\geq 3)$\n\n\u8be2\u95ee$f(2) * f(3) ... * f(n)$\n\n---\n \n\n\u9996\u5148\u6253\u4e2a\u8868\uff0c\u53d1\u73b0$f(i)$\u843d\u5728$[1,4]$\u5185\n\n\u8003\u8651\u5bf9$1, 2, 3, 4$\u5206\u522b\u6c42\u89e3\n\n\u4e00. $f(n) = 1$\uff0c\u53ea\u6709$n = 2$\u65f6\u6210\u7acb\n\n\u4e8c. $f(n) = 2$\uff0c\u7531\u4e8e\u53ea\u6709$f(2) = 1$\uff0c\u56e0\u6b64$2$\u662f\u6700\u5c0f\u7684\u4e0d\u662f$n$\u7684\u56e0\u5b50\u7684\u6570\uff0c\u5373$n$\u4e3a\u5947\u6570\n\n\u4e09. $f(n) = 3$\u548c$f(n) = 4$\uff0c\u6240\u6709\u80fd\u8f6c\u79fb\u5230\u5076\u6570\u7684$n$\u6ee1\u8db3$f(n) = 4$\uff0c\u5426\u5219$f(n) = 3$\n\n---\n \n\n\u6211\u4eec\u53d1\u73b0\uff0c\u6ee1\u8db3$f(n) = 4$\u7684\u6570\u6210\u4e00\u4e9b\u5faa\u73af\u8282\n\n\u8fd9\u662f\u56e0\u4e3a\uff0c\u4e0d\u59a8\u8bbe$n = 2^k * p$\uff0c\u5e76\u4e14$n$\u6700\u5c0f\u7684\u975e\u56e0\u5b50\u6570\u4e3a$v$\n\n\u5982\u679c$v / gcd(v, n)$\u662f\u67d0\u4e2a\u5947\u8d28\u6570$x$\uff0c\u7531\u4e8e$v$\u4e2d\u4e00\u5b9a\u6709$2$\u8fd9\u4e2a\u56e0\u5b50\uff0c\u5e76\u4e14$2x > x$\uff0c\u6240\u4ee5\u4e0d\u5b58\u5728$n$\u4e0d\u5305\u542b$x$\u56e0\u5b50\u7684\u60c5\u51b5\n\n\u7c7b\u4f3c\u7684\u63a2\u8ba8\uff0c\u53ef\u4ee5\u5f97\u5230$v / gcd(v, n) = 2$\n\n\u90a3\u4e48\u6700\u5c0f\u7684\u975e\u56e0\u5b50\u6570\u4e3a$v$\u7684\u6570\u4e00\u5b9a\u6ee1\u8db3$n = v / 2 * p$\uff0c\u5982\u679c\u5bf9$n$\u589e\u52a0$2p$\uff0c\u90a3\u4e48\u5b83\u4ecd\u6ee1\u8db3$v / gcd(v, n) = 2$\n\n\u4e5f\u5c31\u662f\u8bf4$2p$\u662f\u4e00\u4e2a\u5faa\u73af\u8282\n\n\u90a3\u4e48\u6bd4$2p$\u66f4\u5927\u7684\u5faa\u73af\u8282\u662f\u600e\u4e48\u6765\u7684\u5462\uff1f\n\n\u4e00\u5b9a\u662f\u6700\u5c0f\u7684\u975e\u56e0\u5b50\u6570\u5927\u4e8e$v$\u7684\u5faa\u73af\u8282\n\n\u8fd9\u65f6\uff0c$n$\u81f3\u5c11\u8981\u4e58\u4e2a$2$\uff0c\u7531\u4e8e$n$\u4e2d$2$\u7684\u5e42\u6b21\u6539\u53d8\u4e86\uff0c\u56e0\u6b64\u4e0d\u540c\u7684\u5faa\u73af\u8282\u4e4b\u95f4\u4e0d\u4f1a\u4e92\u76f8\u5f71\u54cd\n\n\u6613\u77e5\u5faa\u73af\u8282\u4e0d\u4f1a\u592a\u591a\uff0c\u5b9e\u9645\u4e0a\u5728$n \\leq 10^{18}$\u7684\u8303\u56f4\u4e2d\uff0c\u53ea\u6709$4$\u4e2a\n\n\u627e\u51fa\u5faa\u73af\u8282\u76f4\u63a5\u7edf\u8ba1\u5373\u53ef\n\n---\n\n\u4e0b\u9762\u4ee3\u7801\u9644\u52a0\u4e86\u5bfb\u627e\u5faa\u73af\u8282\u7684\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u8003\u8651\u5220\u6389\n\n\u90a3\u4e00\u5927\u5806\u7684\u4f18\u5316\u5c31\u4e0d\u8981\u770b\u4e86\u5427QAQ\n\n```cpp\n#include <cstring>\n#include <iostream>\n#include <algorithm>\nnamespace remoon {\n    #define ri register int\n    #define ll __int128\n    #define tpr template <typename ra>\n    #define rep(iu, st, ed) for(ri iu = st; iu <= ed; iu ++)\n    #define drep(iu, ed, st) for(ri iu = ed; iu >= st; iu --)    \n    #define gc getchar\n    inline ll read() {\n        ll p = 0, w = 1; char c = gc();\n        while(c > '9' || c < '0') { if(c == '-') w = -1; c = gc(); }\n        while(c >= '0' && c <= '9') p = p * 10 + c - '0', c = gc();\n        return p * w;\n    }\n}\nusing namespace std;\nusing namespace remoon;\n\nnamespace mod_zone {\n    const int mod = 1e9 + 7;\n    inline void inc(int &a, int b) { a += b; if(a >= mod) a -= mod; }\n    inline void dec(int &a, int b) { a -= b; if(a < 0) a += mod; }\n    inline int Inc(int a, int b) { return (a + b >= mod) ? a + b - mod : a + b; }\n    inline int Dec(int a, int b) { return (a - b < 0) ? a - b + mod : a - b; }\n    inline int mul(int a, int b) { return 1ll * a * b % mod; }\n    inline int fp(int a, ll k) {\n        int ret = 1;\n        for( ; k; k >>= 1, a = mul(a, a))\n        if(k & 1) ret = mul(ret, a);\n        return ret;\n    }\n}\nusing namespace mod_zone;\n\nll n;\nint ans, tot;\nlong long tn;\nll cy[105];\n\ninline ll gcd(ll a, ll b) {\n    return b ? gcd(b, a % b) : a;\n}\n\ninline ll nj(ll a) {\n    return (a + 1) / 2;\n}\n\ninline ll solve(ll n) {\n    ll now = 2;\n    int pot = 3;\n    while(1) {\n        bool flag = 0;\n        while(1) {\n            if(now % pot == 0) pot ++;\n            else {\n                if(pot & 1) now *= pot / gcd(pot, now), pot ++;\n                else { flag = 1; cy[++ tot] = now; }\n            }\n            if(flag || now > n) break;\n        }\n        if(now > n) break;\n        now *= pot / gcd(pot, now); pot ++;\n    }\n\n    ll ret = 0;\n    for(int i = 1; i <= tot; i ++) ret += nj(n / cy[i]);\n    return ret;\n}\n\nint main() {\n    cin >> tn; \n    n = tn;\n    ll n2 = (n + 1) / 2 - 1;\n    ll n4 = solve(n);\n    ll n3 = n / 2 - 1 - n4;\n    int ans = fp(2, n2);\n    ans = mul(ans, mul(fp(3, n3), fp(4, n4)));\n    printf(\"%d\\n\", ans);\n    return 0;\n}\n```\n\n\u597d\u50cf\u6807\u7a0b\u66f4\u4f18\u79c0\u8bf6",
        "postTime": 1545829436,
        "uid": 54022,
        "name": "sermoon",
        "ccfLevel": 0,
        "title": "P5153 \u7b80\u5355\u7684\u51fd\u6570 \u9898\u89e3"
    }
]
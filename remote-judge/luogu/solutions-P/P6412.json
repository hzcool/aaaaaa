[
    {
        "content": "### [\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P6412)\n#### \u9898\u610f\n\u73b0\u5728\u6709\u4e00\u4e2a $1\\sim n$ \u7684\u6392\u5217 $a$\uff0c\u5c06\u5e8f\u5217\u4e2d\u7684\u5143\u7d20\u4f9d\u6b21\u653e\u8fdb\u4e00\u4e2a BST \u91cc\uff0c\u6c42 BST \u4e2d\u63d2\u5165\u51fd\u6570\u7684\u6267\u884c\u6b21\u6570\u3002\n\n\u6ce8\u610f\uff1a\u7b2c\u4e00\u4e2a\u6570\u5df2\u7ecf\u4f5c\u4e3a BST \u7684\u6839\u3002\n\n#### \u601d\u8def\n\n\u66b4\u529b\u6a21\u62df\u80af\u5b9a\u4f1a\u8d85\u65f6\uff0c\u4ed4\u7ec6\u601d\u8003\u53ef\u4ee5\u53d1\u73b0\n\n#### \u6211\u4eec\u6bcf\u6b21\u53ea\u9700\u8981\u627e\u5230\u7b2c $i$ \u4e2a\u6570\u5de6\u8fb9\u5c0f\u4e8e\u5b83\u7684\u6570\u7684\u6700\u5927\u503c\u548c\u53f3\u8fb9\u7b2c\u4e00\u4e2a\u5c0f\u4e8e\u5b83\u7684\u503c\u3002\n\n\u6240\u4ee5\u8fd9\u9053\u9898\u53ef\u4ee5\u7528\u5355\u8c03\u6808\u505a\uff0c\u6211\u4eec\u53ef\u4ee5\u5f00\u4e24\u4e2a\u6570\u7ec4\uff0c\u4e00\u4e2a\u8bb0\u5f55\u8f93\u5165\u6570\u636e\uff0c\u53e6\u4e00\u4e2a\u5b58\u50a8 $i$ \u662f\u7b2c\u51e0\u4e2a\u8f93\u5165\u7684\uff0c\u7136\u540e\u53e6\u5f00\u6570\u7ec4\u5355\u8c03\u7b2c $i$ \u4e2a\u6570\u7684\u7f16\u53f7\uff0c\u8bfb\u9898\u53ef\u77e5\uff0c$1\\le a_i\\le n$\uff0c$a_i$ \u4e92\u4e0d\u76f8\u540c\uff0c\u6240\u4ee5\u6570\u5b57\u53ef\u4ee5\u4ece $1$ \u5f00\u59cb\u6a21\u62df\u5230 $n$,\u627e\u5230\u7b2c $i$ \u4e2a\u6570\u5de6\u8fb9\u6bd4\u5b83\u5c0f\u7684\u6570\u7684\u6700\u5927\u503c,\u518d\u4ece $n$ \u5f00\u59cb\u6a21\u62df\u5230 $1$,\u627e\u5230\u7b2c $i$ \u4e2a\u6570\u53f3\u8fb9\u6bd4\u5b83\u5927\u7684\u6700\u5927\u503c\u7684\u6700\u5c0f\u503c\u3002\n\n#### \u6ce8\u610f\uff1a\u7531\u4e8e\u627e\u7b2c $i$ \u4e2a\u6570\u53f3\u8fb9\u6bd4\u5b83\u5927\u7684\u6700\u5927\u503c\u7684\u6700\u5c0f\u503c\u4e0d\u80fd\u662f\u8fd8\u6ca1\u6709\u8f93\u5165\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u5e94\u8be5\u627e\u7b2c $i$ \u4e2a\u6570\u5de6\u8fb9\u6bd4\u5b83\u5927\u7684\u6700\u5927\u503c\u7684\u6700\u5c0f\u503c\n\u5e72\u5b8c\u8fd9\u4e00\u5207\u4e4b\u540e\uff0c\u53ea\u9700\u8ba1\u7b97\u5b83\u7684\u6df1\u5ea6\u5373\u53ef\u3002\n\ncode:\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn = 300005;\nint n,k,dep[maxn],l[maxn],r[maxn],a[maxn],x[maxn],d[maxn],cnt = 1;\nlong long ans;\nint main()\n{\n//   freopen(\".in\",\"r\",stdin);\n//   freopen(\".out\",\"w\",stdout);\n\tscanf(\"%d\",&n);\n\tfor(int i = 1;i <= n;i++) \n\t{\n\t\tscanf(\"%d\",&x[i]);\n\t\ta[x[i]] = i; \n\t} \n\tfor(int i = 1;i <= n;i++)\n\t{\n\t\twhile(a[i] < d[cnt] && cnt > 1) cnt--;\n\t\tl[i] = x[d[cnt]];\n\t\td[++cnt] = a[i];\n\t}\n\tint cnt = 1;\n\tfor(int i = n;i >= 1;i--)\n\t{\n\t\twhile(a[i] < d[cnt] && cnt > 1) cnt--;\n\t\tr[i] = x[d[cnt]];\n\t\td[++cnt] = a[i];\n\t}\n\tcout << 0 << endl;\n\tfor(int i = 2;i <= n;i++) \n\t{\n\t\tdep[x[i]] = 1 + max(dep[l[x[i]]],dep[r[x[i]]]);\n\t\tans += dep[x[i]];\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n    return 0;\n}\n```\n",
        "postTime": 1673081650,
        "uid": 704089,
        "name": "kkxacj",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6412 [COCI2008-2009#3] BST"
    },
    {
        "content": "\u8fd9\u9053\u9898\u53ef\u4ee5\u7528\u5355\u8c03\u6808\u505a\n\n\u6211\u4eec\u53ef\u4ee5\u5f00\u4e24\u4e2a\u6570\u7ec4\uff0c\u4e00\u4e2a\u662f\u53bb\u8bb0\u5f55\u8f93\u5165\u6570\u636e\uff0c\u53e6\u4e00\u4e2a\u53bb\u5b58\u50a8\u7b2c $i$ \u4e2a\u6570\u5728\u8bb0\u5f55\u8f93\u5165\u6570\u636e\u4e2d\u4f4d\u5b50\u7684\u7f16\u53f7\n\n\u7136\u540e\u6211\u4eec\u5355\u8c03\u7684\u662f\u7b2c $i$ \u4e2a\u6570\u7684\u7f16\u53f7\uff0c\u5206\u522b\u5355\u8c03\u5de6\u8fb9\u7684\u548c\u53f3\u8fb9\u7684\u513f\u5b50\u53ef\u80fd\u6027\u60c5\u51b5\uff0c\u6211\u4eec\u8fd8\u5148\u591a\u5efa\u4e00\u4e2a $-1$ \u7684\u4f4d\u7f6e\uff0c\u7f16\u53f7\u4e3a $0$ \u5148\u52a0\u5165\u5355\u8c03\u6808\n\n\u4e0b\u9762\u5c55\u793a\u5de6\u8fb9\u7684\u505a\u6cd5\uff1a\n\n\u4ece $1$ \u5f00\u59cb\u627e\u5230 $n$ \u627e\u5230\u7b2c $i$ \u4f4d\u7684\u7f16\u53f7\u524d\u9762\u7b2c $1$ \u4e2a\u6bd4\u4ed6\u5927\u7684\u6570\u7684\u7f16\u53f7\uff0c\u5e76\u5c06\u5b83\u7684\u53ef\u80fd\u6027\u5b58\u5165\u4e00\u4e2a\u5de6\u513f\u5b50\u6570\u7ec4\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u5728\u6808\u4e2d\u5220\u9664\u6bd4\u8fd9\u4e2a\u6570\u7684\u7f16\u53f7\u5927\u7684\u503c\uff0c\u5e76\u5c06\u5b83\u7684\u7f16\u53f7\u52a0\u5165\u6808\uff0c\u5176\u4e2d\u8981\u4e00\u76f4\u7ef4\u62a4\u5b83\u7684\u5355\u8c03\u6027\n```cpp\nfor(int i=1;i<=n;i++){\n\t\twhile(id[i]<Stck[top]&&top>1) top--;\n\t\tl[i]=a[Stck[top]];\n\t\tStck[++top]=id[i];\n\t}\n```\n\u53f3\u8fb9\u540c\u4e4b\n\n\u6700\u540e\u518d\u8ba1\u7b97\u5b83\u7684\u6df1\u5ea6\u5373\u53ef\n\n\u5b8c\u6574\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mx=500005;\nint n,Stck[mx],top,a[mx],id[mx],l[mx],r[mx];\nlong long c,dep[mx];\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%d\",&a[i]);\n\t\tid[a[i]]=i;\n\t}\n\tdep[0]=-1;\n\ttop=1;\n\tfor(int i=1;i<=n;i++){\n\t\twhile(id[i]<Stck[top]&&top>1) top--;\n\t\tl[i]=a[Stck[top]];\n\t\tStck[++top]=id[i];\n\t}\n\ttop=1;\n\tfor(int i=n;i>=1;i--){\n\t\twhile(id[i]<Stck[top]&&top>1) top--;\n\t\tr[i]=a[Stck[top]];\n\t\tStck[++top]=id[i];\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tdep[a[i]]=max(dep[l[a[i]]],dep[r[a[i]]])+1;\n\t\tc+=dep[a[i]];\n\t\tprintf(\"%lld\\n\",c);\n\t}\n\treturn 0;\n} \n```",
        "postTime": 1673076573,
        "uid": 754673,
        "name": "Jackson_Miller",
        "ccfLevel": 3,
        "title": "[COCI2008-2009#3] BST"
    },
    {
        "content": "\u9996\u5148\uff0c\u663e\u800c\u6613\u89c1\uff0c\u5355\u6b21\u8be2\u95ee\u540e\u7b54\u6848\u589e\u52a0\u7684\u6570\u91cf\u4e3a\u65b0\u8282\u70b9\u7684\u6df1\u5ea6\u3002\n\n\u90a3\u4e48\uff0c\u8fd9\u4e2a\u95ee\u9898\u5c06\u4f1a\u4ece\u4e00\u4e2a\u6a21\u62df\u95ee\u9898\u62bd\u8c61\u4e3a\u6570\u5b66\u95ee\u9898\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u6a21\u62df\uff0c\u4f46\u662f\u5728\u6811\u9000\u5316\u4e3a\u94fe\u7684\u60c5\u51b5\u4e0b\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4f1a\u8fbe\u5230\u60ca\u4eba\u7684 $O(n^2)$\u3002\n\n\u5f88\u660e\u663e\uff0c\u6211\u4eec\u8981\u4f18\u5316\u3002\u90a3\u4e48\u9996\u5148\u6211\u4eec\u8003\u8651\u53ef\u4ee5\u5728\u54ea\u91cc\u8fdb\u884c\u52a0\u901f\u3002\n\n\u5173\u952e\u6027\u8d28\uff1a\u8282\u70b9\u7684\u7956\u5148\u8981\u4e48\u662f\u6570\u503c\u6bd4\u4ed6\u5c0f\u4e2d\u7684\u6700\u5927\u6570\uff0c\u8981\u4e48\u662f\u6bd4\u4ed6\u5927\u7684\u6700\u5c0f\u6570\u3002\u8003\u8651\u4e8c\u5206\u3002\u4f46\u5f88\u660e\u663e\uff0c\u4e8c\u5206\u8981\u6c42\u6709\u5e8f\u5e8f\u5217\uff0c\u90a3\u4e48\u590d\u6742\u5ea6\u74f6\u9888\u5c06\u4f1a\u5728\u63d2\u5165\u4e0a\u3002\u5982\u679c\u4f7f\u7528\u94fe\u8868\uff0c\u5219\u4f1a\u65e0\u6cd5\u8fdb\u884c\u4e8c\u5206\u3002\u90a3\u4e48\u663e\u7136\u4e8c\u5206\u662f\u4e0d\u53ef\u884c\u7684\u3002\n\n\u90a3\u600e\u4e48\u529e\u5462\uff1f\u6ca1\u5173\u7cfb\uff0c\u6211\u4eec\u5df2\u7ecf\u60f3\u5230\u4e86\u94fe\u5f0f\u7ed3\u6784\uff0c\u6211\u4eec\u5148\u653e\u4e00\u4e0b\u3002\n\n\u8003\u8651\u5efa\u4e00\u4e2a\u6570\u7ec4\uff0c\u503c\u4e3a\u96f6\u5219\u8be5\u4e0b\u6807\u6ca1\u6709\u88ab\u52a0\u5165\uff0c\u503c\u4e3a\u4e00\u5219\u8868\u793a\u5df2\u7ecf\u88ab\u52a0\u5165\u5230\u4e8c\u53c9\u6811\u3002\u90a3\u4e48\u53ef\u4ee5\u4ece\u5de6\u5f80\u53f3\uff0c\u4ece\u53f3\u5f80\u5de6\u76f4\u63a5\u627e\u3002\n\n\u867d\u7136\u65f6\u95f4\u590d\u6742\u5ea6\u6ca1\u53d8\uff0c\u4f46\u662f\u5f88\u660e\u663e\u53ef\u4ee5\u8fdb\u4e00\u6b65\u4f18\u5316\u3002\n\n\u6211\u4eec\u540c\u65f6\u4ece\u5de6\u5f80\u53f3\u548c\u4ece\u53f3\u5f80\u5de6\u641c\u7d22\u3002\u53ea\u8981\u4e00\u8fb9\u641c\u7d22\u51fa\u6765\uff0c\u76f4\u63a5\u9000\u51fa\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4e0d\u53ef\u4ee5\u4e0d\u7528\u5f80\u53e6\u4e00\u8fb9\u627e\u4e86\u5462\uff1f\u5f88\u660e\u663e\u53ef\u4ee5\u3002\u4f7f\u7528\u94fe\u8868\u7ef4\u62a4\u5de6\u53f3\u5173\u7cfb\uff0c\u90a3\u4e48\u53ea\u8981\u77e5\u9053\u4e00\u8fb9\u7684\u6570\uff0c\u5c31\u53ef\u4ee5\u77e5\u9053\u53e6\u4e00\u8fb9\u3002\u7136\u540e\u5c31\u53ef\u4ee5\u76f4\u63a5\u6c42\u4e86\u3002\u6700\u574f\u590d\u6742\u5ea6 $O(n \\log n)$\u3002\u53e6\u5916\uff0c\u8bb0\u5f97\u770b\u6570\u636e\u8303\u56f4\u3002\n\n\u9644\u4e0a\u4ee3\u7801\u53ca\u94fe\u63a5\uff1a\n\n[Link](https://www.luogu.com.cn/record/105339854)\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\nint a[300010];\nint l[300010],r[300010];\nint d[300010];\nsigned main(){\n\tint n;\n\tcin >> n ;\n\tint x,ans=0;\n\tcin >> x;\n\ta[x]=a[0]=a[n+1]=1;\n\tl[x]=0;\n\tr[0]=x;\n\tr[x]=n+1;\n\tl[n+1]=x; \n\tcout << 0 << endl;\n\tfor ( int i = 1 ; i < n ; i++ )\n\t{\n\t\tcin >> x;\n\t\ta[x]=1;\n\t\tint lp=x-1,rp=x+1;\n\t\twhile(!a[lp]&&!a[rp])\n\t\t{\n\t\t\tlp--;\n\t\t\trp++;\n\t\t}\n\t\tif(a[lp])\n\t\t{\n\t\t\trp=r[lp];\n\t\t}else{\n\t\t\tlp=l[rp];\n\t\t}\n\t\tr[lp]=x;\n\t\tl[rp]=x;\n\t\tr[x]=rp;\n\t\tl[x]=lp;\n\t\td[x]=max(d[lp],d[rp])+1;\n\t\tans=ans+d[x];\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n} \n```",
        "postTime": 1679315468,
        "uid": 530468,
        "name": "LasyFish",
        "ccfLevel": 0,
        "title": "P6412 \u9898\u89e3"
    },
    {
        "content": "# **\u4e25\u683c $\\Theta(n)$ \u7b97\u6cd5**\n\n## \u9898\u76ee\u63cf\u8ff0\n\u73b0\u5728\u6709\u4e00\u4e2a\u5e8f\u5217 $a$\uff0c\u5c06\u5e8f\u5217\u4e2d\u7684\u5143\u7d20\u4f9d\u6b21\u653e\u8fdb\u4e00\u4e2a BST \u91cc\uff0c\u6c42 BST \u4e2d\u63d2\u5165\u51fd\u6570\u7684\u6267\u884c\u6b21\u6570\u3002\n\n\u6ce8\u610f\uff1a\u7b2c\u4e00\u4e2a\u6570\u5df2\u7ecf\u4f5c\u4e3a BST \u7684\u6839\u3002\n\n## \u601d\u8def\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u7b54\u6848\uff0c\u5206\u6790\u540e\u53ef\u4ee5\u53d1\u73b0\uff0c\u6bcf\u4e2a\u6570\u4e00\u5b9a\u662f\u5728\u5df2\u7ecf\u52a0\u5165\u8fdb\u53bb\u7684\u6570\u4e2d\u5c0f\u4e8e\u5b83\u7684\u6700\u5927\u503c\u548c\u5927\u4e8e\u5b83\u7684\u6700\u5c0f\u503c\u7684\u4e24\u4e2a\u6570\u4e4b\u95f4\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5fnidjzw.png?x-oss-process=image/resize,m_lfit,h_500,w_500)\n\n\u5bf9\u4e8e\u6570 $x$\uff0c\u5728\u6bcf\u6b21\u67e5\u627e\u5c0f\u4e8e $x$ \u7684\u6700\u5927\u503c\u548c\u5927\u4e8e $x$ \u7684\u6700\u5c0f\u503c\u65f6\uff0c\u53ef\u4ee5\u7528set\u3001\u7ebf\u6bb5\u6811\u7b49\u6570\u636e\u7ed3\u6784\u3002\u800c\u8fd9\u4e9b\u7ed3\u6784\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\Theta(nlogn)$\u3002\u7136\u800c\uff0c\u8fd8\u6709\u4e00\u79cd\u53eb\u505a\u94fe\u8868\u7684\u6570\u636e\u7ed3\u6784\uff0c\u53ef\u4ee5\u4f7f\u65f6\u95f4\u590d\u6742\u5ea6\u964d\u81f3\u4e25\u683c $\\Theta(n)$\u3002\n\n## \u6b65\u9aa4\n\n### step1 \n\u9996\u5148\u521b\u9020\u4e00\u4e2a\u94fe\u8868\uff0c\u94fe\u8868\u6709\u4e24\u4e2a\u503c\uff0c\u4e00\u4e2a\u662f $las$,\u6307\u5411\u8be5\u4f4d\u7f6e\u7684\u524d\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u4e00\u4e2a\u662f $nxt$,\u6307\u5411\u8be5\u4f4d\u7f6e\u7684\u540e\u4e00\u4e2a\u4f4d\u7f6e\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/t53br04s.png?x-oss-process=image/resize,m_lfit,h_1000,w_1000)\n\n### step2\n\u5bf9\u4e8e\u8f93\u5165\u7684 $a_i$,\u6211\u4eec\u5012\u7740\u5411\u524d\u904d\u5386\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u904d\u5386\u5230\u7684\u6570 $a_i$\uff0c\u6b64\u65f6\u6211\u4eec\u5c06 $a_i$ \u5728\u94fe\u8868\u4e2d\u7684\u524d\u4e00\u4e2a\u6570 $list(a)_{las}$ \u548c\u540e\u4e00\u4e2a\u6570 $list(a)_{nxt}$ \u5b58\u4e0b\u6765\uff0c\u7136\u540e\u5220\u9664 $list(a)$\u3002\u4e0b\u9762\u56fe\u6f14\u793a\uff08\u5047\u8bbe\u73b0\u5728\u5220\u7684\u6570\u662f3\uff09\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/n2mqk806.png?x-oss-process=image/resize,m_lfit,h_1000,w_1000)\n\n### step3\n\u4ece1\u5230n\u6b63\u5e8f\u904d\u5386\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u904d\u5386\u5230\u7684\u6570 $a_i$, $dep(a_i)=max$ \\{\u94fe\u8868\u4e2d\u7684\u524d\u4e00\u4e2a\u6570\uff0c\u94fe\u8868\u4e2d\u7684\u540e\u4e00\u4e2a\u6570\\}\u3002\u7528 $sum$ \u4fdd\u5b58 $dep(a_i)$ \u7684\u548c\uff0c\u76f4\u63a5\u8f93\u51fa\u5c31\u884c\u3002\n\n# code\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nstruct List{\n\tint las,nxt;\n}li[300011];\nint n;\nlong long sum;\npair<int,int> b[300001];\nint a[300001],dep[300001];\nint main()\n{\n//\tfreopen(\"P6412.in\",\"r\",stdin);\n//\tfreopen(\"P6412.out\",\"w\",stdout);\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&a[i]);\n\t\tli[i].nxt=i+1,li[i].las=i-1;\n\t}\n\tli[0].nxt=1,li[n+1].las=n;\n\tfor(int i=n;i;i--)\n\t{\n\t\tb[a[i]].first=li[a[i]].las,b[a[i]].second=li[a[i]].nxt;\n\t\tli[li[a[i]].las].nxt=li[a[i]].nxt,li[li[a[i]].nxt].las=li[a[i]].las;\n\t}\n\tdep[a[1]]=0;puts(\"0\");\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tdep[a[i]]=max(dep[b[a[i]].first],dep[b[a[i]].second])+1;\n\t\tsum+=dep[a[i]];\n\t\tprintf(\"%lld\\n\",sum);\n\t}\n\treturn 0;\n} \n```\n",
        "postTime": 1638611007,
        "uid": 399674,
        "name": "Naro_Ahgnay",
        "ccfLevel": 0,
        "title": "P6412 [COCI2008-2009#3] BST\u9898\u89e3"
    },
    {
        "content": "\u6a21\u62df\u8d5b\u5199\u4e86 1 \u4e2a\u591a\u5c0f\u65f6\u7684\u5e73\u8861\u6811\uff0c\u7ed3\u679c\u8fde\u6837\u4f8b\u90fd\u8fc7\u4e0d\u4e86\u2026\u2026\n\n\u5e7f\u544a\uff1a[\u4e00\u540dBlink\u7684\u535a\u5ba2](https://foreverxxx.blog.luogu.org/)\n\n### \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u9897\u4e8c\u53c9\u641c\u7d22\u6811\uff0c\u6c42\u63d2\u5165\u6bcf\u4e2a\u6570\u65f6\u603b\u5171\u6267\u884c\u4e86\u591a\u5c11\u6b21\u63d2\u5165\u64cd\u4f5c\u3002\n\n### \u89e3\u6cd5\n\n\u5047\u8bbe\u6211\u4eec\u73b0\u5728\u5c06\u8981\u63d2\u5165\u7684\u6570\u4e3a $X$\uff0c$a$ \u4e3a\u5df2\u7ecf\u63d2\u5165\u7684\u6240\u6709\u6570\u4e2d\u5c0f\u4e8e $X$ \u7684\u6700\u5927\u6570\u5b57\uff0c$b$ \u4e3a\u5df2\u7ecf\u63d2\u5165\u7684\u6240\u6709\u6570\u4e2d\u5927\u4e8e $X$ \u7684\u6700\u5c0f\u6570\u5b57\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u8bc1\u660e $X$ \u7684\u7956\u5148\u4e3a $a$ \u6216 $b$\uff0c\u800c\u63d2\u5165\u8fd9\u4e2a\u6570\u6240\u6267\u884c\u7684\u64cd\u4f5c\u6b21\u6570\u4e3a $a$ \u548c $b$ \u6df1\u5ea6\u7684\u6700\u5927\u503c\u3002\n\n\u975e\u5e38\u660e\u663e\u8fd9\u4e9b\u4e1c\u897f\u53ef\u4ee5\u7528\u7ebf\u6bb5\u6811\u4ec0\u4e48\u7684\u6570\u636e\u7ed3\u6784\u6765\u7ef4\u62a4\uff0c\u4e0d\u8fc7 std \u7684\u5199\u6cd5\u5c5e\u5b9e\u9707\u60ca\u5230\u4e86\u6211\u3002\n\n**\u53ef\u4ee5\u7528 map \u6765\u7ef4\u62a4\uff01**\n\n\u6bcf\u6b21\u8be2\u95ee\u65f6\uff0c\u76f4\u63a5\u7528\u8fed\u4ee3\u5668\u548c ``lower_bound`` \u51fd\u6570\u67e5\u627e\u4e24\u4e2a\u6570\u7684\u503c\u5c31\u597d\u4e86\uff0c\u5b8c\u5168\u53ef\u4ee5\u907f\u514d\u4f7f\u7528\u590d\u6742\u7684\u6570\u636e\u7ed3\u6784\u3002\uff08\u4e3b\u8981\u662f\u5bb9\u6613\u6253\u6302\uff09\n\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\ninline int read(){\n\tint sss=0;\n\tchar chh=getchar();\n\twhile(chh<'0'||chh>'9') chh=getchar();\n\twhile(chh>='0'&&chh<='9'){\n\t\tsss=sss*10+chh-'0';\n\t\tchh=getchar();\n\t}\n\treturn sss;\n}\nvoid write(int x){\n\tif(x>9) write(x/10);\n\tputchar(x%10+'0');\n}\nint n,x; \nmap<int,int> depth;\nint cnt=0;\nsigned main() {\n    n=read();\n    for(register int i=1;i<=n;i++){\n    \tx=read();\n      \tint d=0;\n      \tmap<int,int>::iterator it=depth.lower_bound(x);\n      \tif(it!=depth.end()) d=max(d,it->second+1);\n      \tif(it!=depth.begin()) d=max(d,(--it)->second+1);\n      \tdepth[x]=d;\n      \tcnt+=d;\n      \twrite(cnt),puts(\"\");\n   }\n   return 0;\n}\n```",
        "postTime": 1638867469,
        "uid": 367316,
        "name": "Foreverxxx",
        "ccfLevel": 0,
        "title": "P6412 [COCI2008-2009#3] BST \u9898\u89e3"
    },
    {
        "content": "\u672c\u9898\u5c31\u662f:\u6bcf\u4e00\u6b21\u63d2\u5165\u4e00\u4e2a\u6570$X$\u65f6\uff0c\u53ef\u4ee5\u8bc1\u660e\u5b83\u7684\u7236\u8282\u70b9\u53ea\u6709\u4e24\u79cd\u53ef\u80fd\uff1a\u5df2\u7ecf\u63d2\u5165\u7684\u6570\u4e2d\u521a\u597d\u6bd4$X$\u5c0f\u7684\u6570$A$\uff0c\u6216\u521a\u597d\u6bd4$X$\u5927\u7684\u6570$B$\u3002\u5982\u679c\u8bb0\u5f55\u4e86$A$\u548c$B$\u7684\u6df1\u5ea6D[A],D[B]\uff0c\u5219$D[x] = max$ { $D[A]$, $D[B]$ }\u3002\n\n\u53ea\u8981\u80fd\u5feb\u901f\u627e$A$,$B$\u5373\u53ef\u3002\u53ef\u7528\u7ebf\u6bb5\u6811\uff0c\u5e73\u8861\u6811\u6216\u53cc\u5411\u94fe\u8868\u7b49\u4e4b\u7c7b\u65b9\u6cd5\u90fd\u53ef\u5feb\u901f\u5b9e\u73b0\u3002\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n#include<cstring>\n#include<set>\nusing namespace std;\nconst int maxn=3e5+5;\nint n,dep[maxn],val,minv=maxn,a,son[maxn][2];\nlong long cnt;\ninline int min(int a,int b)\n{\n\treturn a<b?a:b;\n}\nstruct Splay\n{\n\tint son[maxn][2],val[maxn],cnt,root,fa[maxn];\n\tinline void rotate(int x)\n\t{\n\t\tint y=fa[x];\n\t\tint z=fa[y];\n\t\tint k=(x==son[y][1]);\n\t\tfa[x]=z;\n\t\tson[z][son[z][1]==y]=x;\n\t\tfa[son[x][k^1]]=y;\n\t\tson[y][k]=son[x][k^1];\n\t\tfa[y]=x;\n\t\tson[x][k^1]=y;\n\t}\n\tinline void splay(int x,int ed)\n\t{\n\t\twhile(fa[x]!=ed)\n\t\t{\n\t\t\tint y=fa[x];\n\t\t\tint z=fa[y];\n\t\t\tif(z!=ed)\n\t\t\t{\n\t\t\t\tif((son[y][1]==x)^(son[z][1]==y))rotate(x);\n\t\t\t\telse rotate(y);\n\t\t\t}\n\t\t\trotate(x);\n\t\t}\n\t\tif(ed==0)root=x;\n\t}\n\tinline void insert(int x)\n\t{\n\t\tint pos=root,f=0;\n\t\twhile(pos)\n\t\t{\n\t\t\tf=pos;\n\t\t\tif(x==val[pos])break;\n\t\t\telse pos=son[pos][x>val[pos]];\n\t\t}\n\t\tif(pos==0)\n\t\t{\n\t\t\tpos=++cnt;\n\t\t\tfa[pos]=f;\n\t\t\tson[f][x>val[f]]=pos;\n\t\t\tval[pos]=x;\n\t\t}\n\t\tsplay(pos,0);\n\t}\n\tinline int find(int x)\n\t{\n\t\tint pos=root;\n\t\twhile(son[pos][x>val[pos]]!=0)\n\t\t{\n\t\t\tif(x==val[pos])return pos;\n\t\t\telse pos=son[pos][x>val[pos]];\n\t\t}\n\t\treturn pos;\n\t}\n\tinline int pre(int x)\n\t{\n\t\tint pos=find(x);\n\t\tsplay(pos,0);\n\t\tpos=root;\n\t\tif(val[root]<x)return val[root];\n\t\telse \n\t\t{\n\t\t\tpos=son[pos][0];\n\t\t\twhile(son[pos][1])pos=son[pos][1];\n\t\t\treturn val[pos]; \n\t\t}\n\t}\n\tinline int nxt(int x)\n\t{\n\t\tint pos=find(x);\n\t\tsplay(pos,0);\n\t\tpos=root;\n\t\tif(val[root]>x)return val[root];\n\t\telse \n\t\t{\n\t\t\tpos=son[pos][1];\n\t\t\twhile(son[pos][0])pos=son[pos][0];\n\t\t\treturn val[pos]; \n\t\t}\n\t}\n}splay;\ninline int getint()\n{\n\tint x=0;\n\tchar ch=getchar();\n\twhile(ch>'9'||ch<'0')ch=getchar();\n\twhile(ch>='0'&&ch<='9')x=(x<<3)+(x<<1)+(ch^48),ch=getchar();\n\treturn x;\n}\nint main()\n{\n\tn=getint();\n\tval=getint();\n\tdep[val]=0;\n\tsplay.insert(val);\n\tprintf(\"%lld\\n\",cnt);\n\tminv=val;\n\tfor(int i=1;i<=n-1;++i)\n\t{\n\t\ta=getint();\n\t\tint now=splay.nxt(a);\n\t\tint pre=splay.pre(a);\n\t\tif(son[now][0]==0)\n\t\t{\n\t\t\tson[now][0]=a;\n\t\t\tdep[a]=dep[now]+1;\n\t\t\tsplay.insert(a);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tson[pre][1]=a;\n\t\t\tsplay.insert(a);\n\t\t\tdep[a]=dep[pre]+1;\n\t\t}\n\t\tcnt+=dep[a];\n\t\tprintf(\"%lld\\n\",cnt);\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1587213016,
        "uid": 333789,
        "name": "lory1608",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P6412 \u3010[COCI2008-2009#3] BST\u3011"
    },
    {
        "content": "\u4ece $1\\sim n$ \u5217\u4e3e\u6570\uff0c\u5c06 $i$ \u7684\u7f16\u53f7\u5165\u6808\uff0c\u5e76\u7ef4\u62a4\u5355\u8c03\u6027\uff08\u5355\u8c03\u9012\u589e\uff09\u3002\n\n\u6b64\u65f6\uff0c$i$ \u7684\u7f16\u53f7\u6240\u5728\u7684\u4f4d\u7f6e\u7684\u524d\u4e00\u4e2a\u6570\uff0c\u5c31\u662f\u524d $i-1$ \u4e2a\u6570\u4e2d\u6bd4\u4ed6\u5c0f\u7684\u6570\u6700\u5927\u7684\u4e00\u4e2a\u7684\u7f16\u53f7\u3002\n\n\u524d $i-1$ \u4e2a\u6570\u4e2d\u6bd4\u4ed6\u5927\u7684\u6570\u6700\u5c0f\u7684\u4e00\u4e2a\u7684\u6c42\u6cd5\uff08\u8bb0\u5f55\u4e3a $r_i$\uff09\uff1a\u4e0e $l_i$ \u7684\u6c42\u6cd5\u57fa\u672c\u76f8\u540c\uff0c\u53ea\u9700\u628a $1\\sim n$ \u6539\u4e3a $n\\sim1$ \u5373\u53ef\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1e6+5;\nint n,a[N],id[N],l[N],r[N],stk[N],dep[N],top=1;\nlong long ans;\nint main(){\n    scanf(\"%d\",&n);\n    for(int i = 1;i<=n;i++)\n        scanf(\"%d\",&a[i]),id[a[i]]=i;\n    for(int i = 1;i<=n;i++){\n        while(id[i]<stk[top]&&top>1)--top;\n        l[i] = a[stk[top]];\n        stk[++top] = id[i];\n    }\n    memset(stk,0,sizeof(stk));\n    top = 1;\n    for(int i = n;i>=1;i--){\n        while(id[i]<stk[top]&&top>1)--top;\n        r[i] = a[stk[top]];\n        stk[++top] = id[i];\n    }\n    cout<<0<<endl;\n    dep[1]=-1;\n    for(int i=2;i<=n;i++){\n        ans+=dep[a[i]]=max(dep[l[a[i]]],dep[r[a[i]]])+1;\n        cout<<ans;\n    }\n}\n```",
        "postTime": 1677135939,
        "uid": 688783,
        "name": "NM_ljy",
        "ccfLevel": 0,
        "title": "[COCI2008-2009#3] BST"
    },
    {
        "content": "### \u9898\u610f\n\n[Link](https://www.luogu.com.cn/problem/P6412)\n\n### Sol\n\n\u8003\u8651\u66b4\u529b\u6a21\u62df\u3002\u6ce8\u610f\u5230\u5982\u679c\u8be5\u4e8c\u53c9\u641c\u7d22\u6811\u8d8b\u8fd1\u4e8e\u94fe\u7684\u5f62\u6001\u4f1a\u5bfc\u81f4\u590d\u6742\u5ea6\u53d8\u6210 $O(n^2)$\n\n\u6ce8\u610f\u5230\u5e73\u8861\u6811\u53ef\u4ee5\u907f\u514d\u4e8c\u53c9\u641c\u7d22\u6811\u9000\u5316\u6210\u8fd1\u4f3c\u94fe\u7684\u5f62\u6001\u3002\n\n\u6240\u4ee5\u6211\u4eec\u5c31\u53ef\u4ee5\u91c7\u7528\u5e73\u8861\u6811\u3002\u6bcf\u4e2a\u8282\u70b9\u7ef4\u62a4\u8fd9\u4e2a\u8282\u70b9\u7684\u503c\u548c\u5728\u771f\u6b63\u7684\u4e8c\u53c9\u641c\u7d22\u6811\u4e0a\u7684\u6df1\u5ea6\uff0c\u6bcf\u6b21\u627e\u5230\u8981\u63d2\u5165\u7684\u503c\u7684\u524d\u9a71\u548c\u540e\u7f00\u4e2d\u6df1\u5ea6\u8f83\u6df1\u7684\u4e00\u4e2a+1\u4f5c\u4e3a\u65b0\u7684\u6df1\u5ea6\u63d2\u5165\u3002\n\n\u8003\u8651\u7528 ``set`` \u5b9e\u73b0\u3002\n\n### Code\n\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<stdio.h>\n#include<vector>\n#include<set>\nusing namespace std;\n#define il inline\nil const void readln(int &I){\n    I=0;char C=getchar();\n    while(!isdigit(C))C=getchar();\n    while( isdigit(C))I=I*10+C-'0',C=getchar();\n}\nint n,ai,p;\nunsigned long long c;//\u5341\u5e74OI\u4e00\u573a\u7a7a\u3002\nstruct node{ int v,d; };\nbool operator<(node n1,node n2){\n    return n1.v<n2.v;\n}\nset<node>s;\nint main(){\n    readln(n),readln(ai),s.insert({ai,0}),--n;puts(\"0\");\n    while(n--){\n        readln(ai),p=0;\n        auto it1=s.lower_bound({ai,0}),it2=it1;\n        if(it2!=s.begin())--it2;\n        if(it1!=s.end())p=max(p,(*it1).d+1);\n        if(it2!=s.end())p=max(p,(*it2).d+1);\n        s.insert({ai,p}),printf(\"%llu\\n\",c+=p);\n    }\n}\n```",
        "postTime": 1664594103,
        "uid": 217300,
        "name": "Error_Eric",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P6412 [COCI2008-2009#3] BST"
    },
    {
        "content": "## \u57fa\u672c\u601d\u8def\n\n\u9996\u5148\u5206\u6790\u9898\u76ee\uff0c\u9898\u76ee\u4e2d\u7b2c $i$ \u6b21\u63d2\u5165\u5b8c\u7684 $c$ \u5176\u5b9e\u5c31\u662f\u524d $i$ \u4e2a\u6570\u5728\u6811\u4e2d\u6df1\u5ea6\u4e4b\u548c\u3002\n\n\u6df1\u5ea6\u600e\u4e48\u6c42\u5462\uff1f\u6211\u4eec\u77e5\u9053\uff0c\u7b2c $i$ \u4e2a\u6570\u4f1a\u63d2\u5728\u524d $i-1$ \u4e2a\u6570\u4e2d\u6bd4\u4ed6\u5c0f\u7684\u6570\u6700\u5927\u7684\u4e00\u4e2a\u4e0e\u6bd4\u4ed6\u5927\u7684\u6570\u6700\u5c0f\u7684\u4e00\u4e2a\u4e2d\u6df1\u5ea6\u6700\u5927\u7684\u4e0b\u9762\u3002\n\n---\n\n## \u5b9e\u73b0\u65b9\u6cd5\n\n\u8fd9\u9053\u9898\u53ef\u4ee5\u7528**\u5355\u8c03\u6808**\u505a\u3002\n\n\u5148\u5efa\u4e00\u4e2a\u6808 $stk$ \uff0c\u4e3a\u4e86\u65b9\u4fbf\uff0c\u7528\u6570\u7ec4\u6a21\u62df\u3002\u628a\u6bcf\u4e00\u4e2a\u6570\u8fdb\u5165\u7684\u7f16\u53f7\u8bb0\u4e3a $id_i$\n\n\u521d\u59cb\u5316\u4e0e\u8f93\u5165\u4ee3\u7801\uff1a\n\n```cpp\nscanf(\"%d\",&n);\nfor(int i = 1;i<=n;i++)\n{\n\tscanf(\"%d\",&a[i]);\n\tid[a[i]] = i;\n}\n```\n\n\n\u524d $i-1$ \u4e2a\u6570\u4e2d\u6bd4\u4ed6\u5c0f\u7684\u6570\u6700\u5927\u7684\u4e00\u4e2a\u7684\u6c42\u6cd5\uff08\u8bb0\u5f55\u4e3a $l_i$\uff09\uff1a\u4ece $1\\sim n$ \u5217\u4e3e**\u6570**\uff0c\u5c06 $i$ \u7684\u7f16\u53f7\u5165\u6808\uff0c\u5e76\u7ef4\u62a4\u5355\u8c03\u6027\uff08\u5355\u8c03\u9012\u589e\uff09\u3002\u6b64\u65f6\uff0c$i$ \u7684\u7f16\u53f7\u6240\u5728\u7684\u4f4d\u7f6e\u7684\u524d\u4e00\u4e2a\u6570\uff0c\u5c31\u662f\u524d $i-1$ \u4e2a\u6570\u4e2d\u6bd4\u4ed6\u5c0f\u7684\u6570\u6700\u5927\u7684\u4e00\u4e2a\u7684\u7f16\u53f7\u3002\n\n\u4ee3\u7801\uff1a\n\n ```cpp\nfor(int i = 1;i<=n;i++)\n{\n\twhile(id[i]<stk[top]&&top>1)\n\t\tstk[top--] = 0;\n\tl[i] = a[stk[top]];\n\tstk[++top] = id[i];\n}\n```\n\n\u524d $i-1$ \u4e2a\u6570\u4e2d\u6bd4\u4ed6\u5927\u7684\u6570\u6700\u5c0f\u7684\u4e00\u4e2a\u7684\u6c42\u6cd5\uff08\u8bb0\u5f55\u4e3a $r_i$\uff09\uff1a\u4e0e $l_i$ \u7684\u6c42\u6cd5\u57fa\u672c\u76f8\u540c\uff0c\u53ea\u9700\u628a $1\\sim n$ \u6539\u4e3a $n\\sim1$ \u5373\u53ef\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\nfor(int i = n;i>=1;i--)\n{\n\twhile(id[i]<stk[top]&&top>1)\n\t\tstk[top--] = 0;\n\tr[i] = a[stk[top]];\n\tstk[++top] = id[i];\n}\n```\n\n\u6700\u540e\u7684\u8f93\u51fa\u4ee3\u7801\uff1a\n\n```cpp\n\ncout<<\"0\\n\";\ndep[1] = -1;\nfor(int i = 2;i<=n;i++)\n{\n\tans+=dep[a[i]]=max(dep[l[a[i]]],dep[r[a[i]]])+1;\n\tprintf(\"%lld\\n\",ans);\n}\n```\n---\n\n## \u5b8c\u6574\u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N = 5*1e5+5;\nint n,a[N],id[N],l[N],r[N],stk[N],dep[N],top = 1;\nlong long ans;\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i = 1;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&a[i]);\n\t\tid[a[i]] = i;\n\t}\n\tfor(int i = 1;i<=n;i++)\n\t{\n\t\twhile(id[i]<stk[top]&&top>1)\n\t\t\tstk[top--] = 0;\n\t\tl[i] = a[stk[top]];\n\t\tstk[++top] = id[i];\n\t}\n\tmemset(stk,0,sizeof stk);\n\ttop = 1;\n\tfor(int i = n;i>=1;i--)\n\t{\n\t\twhile(id[i]<stk[top]&&top>1)\n\t\t\tstk[top--] = 0;\n\t\tr[i] = a[stk[top]];\n\t\tstk[++top] = id[i];\n\t}\n\tcout<<\"0\\n\";\n\tdep[1] = -1;\n\tfor(int i = 2;i<=n;i++)\n\t{\n\t\tans+=dep[a[i]]=max(dep[l[a[i]]],dep[r[a[i]]])+1;\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n}\n```\n",
        "postTime": 1673077807,
        "uid": 581316,
        "name": "pyy1",
        "ccfLevel": 0,
        "title": "[COCI2008-2009#3] BST"
    }
]
[
    {
        "content": "\u849f\u84bb\u7b2c\u4e00\u6b21\u5199\u9996\u53d1\u9898\u89e3,\u5fc3\u4e2d\u662f\u65e0\u6bd4\u7684\u6fc0\u52a8\u554a(\u0e51\u2579\u25e1\u2579)\uff89\"\"\"\n\n\u597d\u5427\uff0c\u8bf4\u8bf4\u8fd9\u9053\u9898\u600e\u4e48\u641e\u5427\u3002\n\n\u6700\u5927\u5f02\u6216\u548cdalao\u4eec\u5e94\u8be5\u90fd\u4f1a\u641e\u5427\uff1f\n\n\u51e1\u662f\u5f02\u6216\u7684\u9898\u76ee\u5927\u591a\u90fd\u8981\u7528Trie\u6765\u641e\uff0c\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u6211\u4eec\u9700\u8981\u501f\u9274\u4e00\u4e0b\u6700\u5927\u5f02\u6216\u548c\u7684\u89e3\u9898\u601d\u60f3\uff08\uff08\u5e9f\u8bdd\uff0c\u4fe9\u4e2a\u9898\u7b80\u76f4\u662f\u4e00\u6a21\u4e00\u6837\uff09\uff09\n\n\u540c\u6837\u662f\u6309\u7167\u6570\u4f4d\u4e00\u4f4d\u4e00\u4f4d\u7684\u8d2a\u5fc3\uff0c\u56e0\u4e3a\u52a0\u4e86\u4e00\u4e2ax\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u5bf9\u4e8e\u6240\u6709\u7684ai+x\u4e0eb\u7684\u6309\u4f4d\u5f02\u6216\u3002\n\n\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u5904\u7406\u5230b\u7684\u7b2ci\u4f4d\uff08\u8f6c\u6362\u6210\u4e8c\u8fdb\u5236\uff09\uff0c\u5047\u8bbe\u662f1\uff080\u540c\u7406\uff09\uff0c\n\n\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u67e5\u627e\u662f\u5426\u5b58\u5728aj+x\u4f7f\u5f97\u5176\u4e8c\u8fdb\u5236\u7b2ci\u4f4d\u6570\u5b57\u662f0\uff0c\u663e\u7136\u6211\u4eec\u5df2\u7ecf\u5904\u7406\u4e86\u524di-1\u4f4d\u4e86\uff0c\u8bbe\u5f53\u524d\u7ed3\u679c\u662fans\uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981\u67e5\u627e\u7684\u6570\u7684\u5927\u5c0f\u5c31\u662f\u5728\u533a\u95f4[ans-x,ans+(1<<i)-1-x]\uff0c\u624b\u7b97\u4e00\u4e0b\u5c31\u77e5\u9053\u8fd9\u4e2a\u533a\u95f4\u91cc\u7684\u6570\u5b57\u7684\u7b2ci\u4f4d\u52a0\u4e86x\u540e\u5c31\u90fd\u662f0\uff0c\n\n\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u5c31\u662f\u8981\u5728a[1]...a[n]\u4e2d\u627e\u51fa\u662f\u5426\u5b58\u5728\u4e8e[ans-x,ans+(1<<i)-1-x]\u7684\u6570\u5b57\uff0c\u4e24\u4e2a\u533a\u95f4\u8303\u56f4\u9650\u5236\uff0c\u7528\u4e3b\u5e2d\u6811\u6a21\u677f\u4e00\u5957\u5c31\u597d\u4e86\u3002\n\n[\u4e3b\u5e2d\u6811\u57fa\u7840\u4f20\u9001\u95e8\u3002](http://blog.csdn.net/no1\\_terminator/article/details/77601599)\n\n\n\u53c2\u8003\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\nconst int N=5e5+5;\nconst int M=N*20;\nint a[N],root[N];\nint n,m,totn=0,T_cnt=1;\nstruct President_Tree{\n    int L,R,sum;\n}T[M];\nint read(){\n    int x=0,f=1;char ch=getchar();\n    while (ch<'0' || ch>'9'){if (ch=='-')f=-1;ch=getchar();}\n    while ('0'<=ch && ch<='9'){x=(x<<3)+(x<<1)+(ch^48);ch=getchar();}\n    return x*f;\n}\nvoid insert(int &now,int index,int l=0,int r=totn){\n    T[T_cnt++]=T[now];now=T_cnt-1;\n    T[now].sum++;\n    if (l==r)return;\n    int mid=(l+r)>>1;\n    if (index<=mid)insert(T[now].L,index,l,mid);\n        else insert(T[now].R,index,mid+1,r);\n}\nint query(int i,int j,int ql,int qr,int l=0,int r=totn){\n    if (ql<=l && r<=qr)return T[j].sum-T[i].sum;\n    int mid=(l+r)>>1,tt=0;\n    if (ql<=mid)tt+=query(T[i].L,T[j].L,ql,qr,l,mid);\n    if (mid<qr)tt+=query(T[i].R,T[j].R,ql,qr,mid+1,r);\n    return tt;\n}\nbool find(int i,int j,int ql,int qr){\n    ql=max(0,ql);qr=min(qr,totn);\n    if (ql>qr)return 0;\n    return query(root[i],root[j],ql,qr);\n}\nint main(){\n    n=read(),m=read();\n    for (int i=1;i<=n;i++)\n        totn=max(totn,a[i]=read());\n    root[0]=0;\n    for (int i=1;i<=n;i++){\n        root[i]=root[i-1];\n        insert(root[i],a[i]);\n    }\n    for (int i=1;i<=m;i++){\n        int b=read(),x=read(),ql=read(),qr=read(),ans=0;\n        for (int i=17;i>=0;i--){\n            int now=ans+((1^((b>>i)&1))<<i);\n            if (find(ql-1,qr,now-x,now+(1<<i)-1-x))ans=now;\n            else ans+=((b>>i)&1)<<i;\n        }\n        printf(\"%d\\n\",ans^b);\n    }\n    return 0;\n}\n```",
        "postTime": 1504097507,
        "uid": 54916,
        "name": "I_AM_HelloWord",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3293 \u3010[SCOI2016]\u7f8e\u5473\u3011"
    },
    {
        "content": "\u8fd9\u9898\u8c03\u4e86\u4e00\u4e2a\u4e0a\u5348\u4e0d\u77e5\u54ea\u91cc\u9519\u4e86\uff0c~~\u53ef\u80fd\u6211\u5199\u4ee3\u7801\u50cfc*k~~\n\n>\u5341\u5e74\u751f\u6b7b\u4e24\u832b\u832b\uff0cBUG\u4f55\u5904\u85cf\uff0c\u552f\u6709\u6cea\u5343\u884c\n\n\u4e8e\u662f\u4e4e,\u968f\u4fbf\u6253\u4e86\u4e2a\u66b4\u529b\u78b0\u8fd0\u6c14,\u5438\u4e00\u53e3\u6c27\u6c14,\u8fd8\u4e0d\u591f,\u518d\u5438\u4e00\u53e3\u81ed\u6c27\n\n```cpp\n// luogu-judger-enable-o2\n#pragma GCC optimize(\"O3\")\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=2e5+1;\nint a[N],b[N],x[N],l[N],r[N];\nint main()\n{\n    int n,m;\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=n;++i)\n        scanf(\"%d\",&a[i]);\n    for(int i=1;i<=m;++i)\n        scanf(\"%d%d%d%d\",&b[i],&x[i],&l[i],&r[i]);\n    for(int i=1;i<=m;++i)\n    {\n        int res=0;\n        for(int j=l[i];j<=r[i];++j)\n        {\n            int now=b[i]^(a[j]+x[i]);\n            res=max(res,now);\n        }\n        printf(\"%d\\n\",res);\n    }\n    return 0;\n}\n```\n\u7136\u540e\u6211\u53d1\u73b0\u6211\u6109\u5feb\u7684[$AC$](https://www.luogu.org/record/22048101)\u4e86\n\n\u6b63\u6240\u8c13\n\n>n\u65b9\u8fc7\u767e\u4e07,\u66b4\u529b\u78be\u6807\u7b97\n\n\n~~\u4e0d\u8fc7\u5982\u679c\u4f60\u50cf\u6211\u4e00\u6837\uff0c\u662f\u4e2a\u6c42\u77e5\u82e5\u6e34\uff0c\u52e4\u594b\u597d\u5b66\u7684\u597d\u5b69\u5b50\uff0c\u8bf7\u770b\u4e0b\u9762\u7684\u6b63\u89e3~~\n\n-------\n\n\n\n**\u6211\u6765\u53e3\u80e1\u4e00\u4e0b\u6b63\u89e3**\n\n\u7761\u4e86\u4e00\u4e2a\u4e2d\u5348\u9192\u6765\u770b\u4e86\u4e00\u773c\u9898\u9762,\u53d1\u73b0$a[i]$\u53ef\u4ee5\u662f$0$,\u4e8e\u662f\u604d\u7136\u5927\u609f~~\u5927\u96fe~~,\u628a\u5de6\u8fb9\u7aef\u70b9\u6539\u6210$0$,\u5b9d\u5b9d\u5c31\u6109\u5feb\u7684$AC$\u4e86\n\n\u9898\u76ee\u8981\u6c42$b_i\\  xor\\ (a_j+x_i)$ \u663e\u7136\u4e0d\u80fd\u786c\u6c42,\u770b\u5230\u5f02\u6216,\u8003\u8651\u6309\u7167\u4f4d\u5904\u7406\n\n\u5047\u8bbe\u4ece\u9ad8\u5230\u4f4e\u5904\u7406\u5230\u7b2c$i$\u4f4d(\u4ece\u53f3\u5f80\u5de6\u6570,\u4e2a\u4f4d\u662f\u7b2c$0$\u4f4d),\n\n\u8bbe\u4e4b\u524d\u6c42\u51fa\u7684$a[i]$\u7684\u7b54\u6848\u4e3a$ans$(\u5982\u679c\u4f60\u4e0d\u592a\u660e\u767d\u8fd9\u4e2a\u53d8\u91cf\u7684\u610f\u601d,\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50,\u524d\u63d0\u662f\u4f60\u8981\u77e5\u9053\u57fa\u672c\u7684$xor$\u6027\u8d28)\n\n---\n\u5f53\u524d\u5904\u7406\u5230\u7b2c$2$\u4f4d\n$$ \\ \\ \\ \\ b:1010**\\ *$$\n$$ans:0101** \\ *$$\n\u6240\u4ee5\u5f53\u524d$ans$\u8bb0\u5f55\u7684\u662f\u4e00\u4e2a\u6ee1\u8db3\u9898\u76ee\u9650\u5236\u7684$a[j]+x_i$,\u4f7f\u5f97$b$ $xor$ $a[j]+x_i$\u7684$3-7$\u4f4d\u8fbe\u5230\u6700\u5927\u503c,\u6211\u4eec\u4e4b\u6240\u4ee5\u8981\u4ece\u9ad8\u5230\u4f4e\u679a\u4e3e,\u5c31\u662f\u56e0\u4e3a\u8981\u8d2a\u5fc3\u7684\u6c42,\u5148\u8ba9\u9ad8\u4f4d\u6ee1\u8db3\u6700\u5927\u503c.\n\n\u8fd9\u65f6,\u806a\u660e\u7684\u4f60\u5c31\u8981\u53d1\u95ee\u4e86:\u4e07\u4e00\u6ca1\u6709\u4e00\u4e2a$a[j]+x_i$\u80fd\u4f7f\u67d0\u4e00\u4f4d\u8fbe\u5230\u6700\u5927\u503c,\u90a3\u600e\u4e48\u529e\u5462?\n\n\u7b54:\u6ca1\u6709\u529e\u6cd5,$b$ $xor$ $a[j]+x_i$\u4e4b\u540e\u7684\u8fd9\u4e00\u4f4d\u53ea\u80fd\u4e3a$0$\n\n---\n\n\u7ecf\u8fc7\u4e00\u756a\u5206\u6790\u4e4b\u540e,\u6211\u4eec\u5f97\u51fa\u6838\u5fc3\u601d\u8def:\n\n\u82e5\u7b2c $b$\u7684\u7b2c$i$\u4f4d\u662f$1$,\u90a3\u4e48\u6211\u4eec\u5e0c\u671b\u5b83\u662f\u957f\u8fd9\u6837\u7684\n       \n$$\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ b:---1**\\ *$$\n$$(min)a[j]+x:---0\\ 0\\ 0\\ 0$$\n$$(max)a[j]+x:---0\\ 1\\ 1\\ 1$$\n\n\u5bb9\u6613\u6c42\u51fa$a[i] \\in [ans-x,ans-x+(1<<i)-1]$\n\n\n\u540c\u7406\u5f53$b$\u7684\u7b2c$i$\u4f4d\u662f$0$\u65f6\n\n$a[i] \\in [ans-x+(1<<i),ans-x+(1<<i+1)-1]$\n\n\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4e3b\u5e2d\u6811\u4e0a\u67e5\u8be2\u5bf9\u4e8e\u7b2c$i$\u4e2a\u4eba\u7684$[l_i,r_i]$\u5185\u6709\u65e0$a[i]$\u6ee1\u8db3\u4e0a\u8ff0\u6761\u4ef6\n\n- \u5f53$b$\u7684\u7b2c$i$\u4f4d\u662f$1$\u65f6\uff0c\u82e5\u6709\u8fd9\u6837\u4e00\u4e2a$a[i]$\uff0c$ans+=0<<i$\uff0c\u53cd\u4e4b$ans+=1<<i$\n- \u5f53$b$\u7684\u7b2c$i$\u4f4d\u662f$0$\u65f6\uff0c\u82e5\u6709\u8fd9\u6837\u4e00\u4e2a$a[i]$\uff0c$ans+=1<<i$\uff0c\u53cd\u4e4b$ans+=0<<i$\n\n---\n\n\u5173\u4e8e\u4e3b\u5e2d\u6811\u90e8\u5206\uff0c\u56e0\u4e3a\u6709\u533a\u95f4\u5185\u67e5\u8be2\u7684\u7ea6\u675f\uff0c\u6240\u4ee5\u6211\u4eec\u9996\u5148\u60f3\u5230\u7684\u662f\u4e3b\u5e2d\u6811\n\n\u9996\u5148\u6309\u7167\u5957\u8def\u628a$l-1$\uff0c$r$\u63d0\u51fa\u6765\uff0c$sum$\u76f8\u51cf\u540e\u5f97\u51fa\u8fd9\u6bb5\u533a\u95f4\u5185\u7684\u6570\u503c\u4e2a\u6570\uff0c\u7136\u540e\u6309\u7167\u4e00\u822c\u5957\u8def\u5206\u6210\u4e24\u534a\u5f80\u4e0b\u627e\u5c31\u53ef\u4ee5\u4e86\n\n~~\u5982\u679c\u4f60\u8fde\u4e3b\u5e2d\u6811\u90e8\u5206\u90fd\u4e0d\u80fd\u7406\u89e3\uff0c\u5efa\u8bae\u5148\u628a\u6a21\u7248\u5207\u719f\u7ec3~~\n\t\n\n---\n\n\n\u4e0a\u4ee3\u7801\uff0c\u5f88\u77ed\uff0c~~\u66b4\u529b\u66f4\u77ed~~\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=5e5+5;\nint a[N],rt,t[N<<5],ch[N<<5][2],sum[N<<5];\nvoid update(int pre,int &k,int l,int r,int x)\n{ \n    if(r<x||l>x) return ;\n    k=++rt,ch[k][0]=ch[pre][0],ch[k][1]=ch[pre][1],sum[k]=sum[pre]+1;\n    if(l==r) return;\n    int mid=(l+r)>>1;\n    update(ch[pre][0],ch[k][0],l,mid,x);\n    update(ch[pre][1],ch[k][1],mid+1,r,x);\n}\nint query(int u,int v,int l,int r,int x,int y)\n{\n    int num=sum[v]-sum[u],mid=(l+r)>>1;\n    if(y<l||x>r||num==0) return 0;\n    if(x<=l&&r<=y) return num;\n    return query(ch[u][0],ch[v][0],l,mid,x,y)+query(ch[u][1],ch[v][1],mid+1,r,x,y);\n}\nint main()\n{\n    int n,m,q;\n    scanf(\"%d%d\",&n,&q);\n    for(int i=1;i<=n;i++)\n        scanf(\"%d\",&a[i]),m=max(a[i],m);\n    for(int i=1;i<=n;i++)\n        update(t[i-1],t[i],0,m,a[i]);\n    while(q--)\n    {\n        int b,x,l,r,ans=0;\n        scanf(\"%d%d%d%d\",&b,&x,&l,&r);\n        for(int i=18;i>=0;i--)\n        {\n            if(b&(1<<i)&&!query(t[l-1],t[r],0,m,ans-x,ans-x+(1<<i)-1)) ans+=(1<<i);//\u4e4b\u524d\u5c31\u662f\u8fd9\u5199\u9519\u4e86\n            if(!(b&(1<<i))&&query(t[l-1],t[r],0,m,ans-x+(1<<i),ans-x+(1<<(i+1))-1)) ans+=(1<<i);\n        }      \n        printf(\"%d\\n\",ans^b);\n    }\n    return 0;\n}\n```\n\n\n\n\n\n",
        "postTime": 1564802535,
        "uid": 53410,
        "name": "XY_cpp",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3293 \u3010[SCOI2016]\u7f8e\u5473\u3011"
    },
    {
        "content": "\u4f2a $\\text{01trie}$ \u6811+\u4e3b\u5e2d\u6811\u3002\n\n\u79f0\u4e4b\u4e3a\u4f2a $\\text{01trie}$ \u6811\u662f\u56e0\u4e3a\u5b83\u6ca1\u6709\u5efa\u6811\u8fc7\u7a0b\uff0c\u4f46\u662f\u539f\u7406\u5374\u548c $\\text{01trie}$ \u6811\u53ca\u5176\u76f8\u50cf\u3002\n\n## $01$ \u5b57\u5178\u6811\u7684\u53e6\u4e00\u79cd\u7406\u89e3\u65b9\u5f0f\n\u5b9e\u9645\u4e0a\uff0c$01$ \u5b57\u5178\u6811\u6c42\u5f02\u6216\u6700\u5927\u503c\u7684\u672c\u8d28\u662f\u627e\u5230\u4e00\u4e2a\u6700\u5408\u9002\u7684\u6570\uff0c\u4f7f\u5b83\u4e0e\u6240\u6c42\u6570\u5728\u4e8c\u8fdb\u5236\u4f4d\u4e0a\u7684\u9ad8\u4f4d\u5c3d\u91cf\u76f8\u53cd\u3002\n\n\u540c\u6837\uff0c$01$ \u5b57\u5178\u6811\u4e0a\u7684\u6bcf\u4e00\u4e2a\u7ed3\u70b9\u90fd\u53ef\u4ee5\u770b\u4f5c\u4e00\u4e2a\u503c\u57df\u3002\u5047\u8bbe\u4e00\u4e2a\u7ed3\u70b9 $u$ \u5728 $01$ \u5b57\u5178\u6811\u4e0a\u4ece\u6839\u5230\u5b83\u7684\u524d\u7f00\u6240\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u6570\u503c\u4e3a $sum$\uff0c\u5b83\u7684\u5bf9\u5e94\u4f4d\u6570\u4e3a $i$\uff0c\u90a3\u4e48\u5b83\u7684\u503c\u57df\u4e3a $[sum,sum+2^i-1]$\uff0c\u5de6\u513f\u5b50\u503c\u57df\u4e3a $[sum,sum+2^{i-1}-1]$\uff0c\u53f3\u513f\u5b50\u503c\u57df\u4e3a $[sum+2^{i-1},sum+2^i-1]$\u3002\n\n\u5173\u4e8e\u67e5\u8be2\u4e00\u4e2a\u7ed3\u70b9\u662f\u5426\u5b58\u5728\uff0c\u53ea\u9700\u8981\u67e5\u8be2\u5728\u5b83\u7684\u503c\u57df\u5185\u662f\u5426\u6709\u88ab\u63d2\u5165\u8fc7\u7684\u6570\u5373\u53ef\u3002\n\n## \u5728\u672c\u9898\u7684\u5e94\u7528\n\n\u5982\u679c\u4f7f\u7528\u4e00\u822c\u7684 $01$ \u5b57\u5178\u6811\uff0c\u7a0d\u52a0\u601d\u8003\u53ef\u4ee5\u53d1\u73b0\uff0c\u968f\u7740\u504f\u597d\u503c $x_i$ \u7684\u6539\u53d8\uff0c\u5b57\u5178\u6811\u7684\u5f62\u6001\u4e5f\u4f1a\u53d1\u751f\u6539\u53d8\u3002\u800c\u5982\u4e0a\u7684\u7406\u89e3\u628a\u5b57\u5178\u6811\u7684\u201c\u7ed3\u70b9\u201d\uff0c\u6539\u6210\u4e86\u201c\u503c\u57df\u201d\uff0c\u65b9\u4fbf\u4e86\u6211\u4eec\u64cd\u4f5c\u3002\n\n\u5047\u8bbe\u6211\u4eec\u8981\u67e5\u8be2\u539f\u5b57\u5178\u6811\u4e0a\u503c\u57df $[l,r]$ \u6709\u6ca1\u6709\u88ab\u63d2\u5165\u8fc7\u7684\u6570\u3002\u56e0\u4e3a\u6240\u6709\u7684\u6570\u90fd\u88ab\u52a0\u4e0a\u4e86 $x_i$\uff0c\u6240\u4ee5\u53ea\u8981\u5728\u5f53\u524d\u5b57\u5178\u6811\u4e0a\u67e5\u8be2\u533a\u95f4 $[l-x_i,r-x_i]$ \u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u533a\u95f4\u6c42\u503c\u5b58\u5728\u95ee\u9898\uff0c\u53ef\u4ee5\u4f7f\u7528\u53ef\u6301\u4e45\u5316\u6743\u503c\u7ebf\u6bb5\u6811\u3002\n\n\u8be6\u89c1\u4ee3\u7801\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define db double\nusing namespace std;\ninline int read() {\n\tint x = 0; bool op = false;\n\tchar c = getchar();\n\twhile(!isdigit(c))op |= (c == '-'), c = getchar();\n\twhile(isdigit(c))x = (x << 1) + (x << 3) + (c ^ 48), c = getchar();\n\treturn op ? -x : x;\n}\nconst int N = 200010;\nconst int T = 1e5;\nint n, m, tot;\nint rt[N]; \nstruct Node {\n\tint ls, rs; int val;\n}tree[N * 20];\nint update(int cur, int l, int r, int pos, int val) {\n\tint p = ++tot;\n\ttree[p] = tree[cur];\n\tif(l == r) {\n\t\ttree[p].val += val;\n\t\treturn p;\n\t}\n\tint mid = l + r >> 1;\n\tif(pos <= mid)tree[p].ls = update(tree[cur].ls, l, mid, pos, val);\n\telse tree[p].rs = update(tree[cur].rs, mid + 1, r, pos, val);\n\ttree[p].val = tree[tree[p].ls].val + tree[tree[p].rs].val;\n\treturn p;\n}\nint query(int p, int q, int l, int r, int qx, int qy) {\n\tif(l >= qx && r <= qy)return tree[p].val - tree[q].val;\n\tint mid = l + r >> 1, ans = 0;\n\tif(qx <= mid)ans += query(tree[p].ls, tree[q].ls, l, mid, qx, qy);\n\tif(qy > mid)ans += query(tree[p].rs, tree[q].rs, mid + 1, r, qx, qy);\n\treturn ans;\n}\nint main() {\n\tn = read(); m = read();\n\trt[0] = 1; tot = 1;\n\tfor(int i = 1; i <= n; i++) {\n\t\tint x = read();\n\t\trt[i] = update(rt[i - 1], 0, T, x, 1);\n\t}\n\tfor(int i = 1; i <= m; i++) {\n\t\tint b = read(), x = read(), l = read(), r = read();\n\t\tint ans = 0; //ans\u8bb0\u5f55\u524d\u7f00\uff08\u5373\u4e0a\u9762\u63d0\u5230\u7684sum\uff09 \n\t\tfor(int j = 18; j >= 0; j--) {\n\t\t\tint flg = 1;\n\t\t\tif((b >> j & 1) == 1) { //\u6a21\u62dftrie\u6811\u64cd\u4f5c \n\t\t\t\tint lef = ans, rig = ans + (1 << j) - 1;//\u67e5\u627e\u5de6\u513f\u5b50\uff0c\u5373\u5728\u8fd9\u4e00\u4f4d\u4e0a\u4e3a0 \n\t\t\t\tif(rig - x < 0 || lef - x > T)flg = 0;\n\t\t\t\telse if(query(rt[r], rt[l - 1], 0, T, max(lef - x, 0), min(T, rig - x)) == 0)flg = 0;\n\t\t\t\t//\u67e5\u8be2\u503c\u57df\u5185\u6709\u6ca1\u6709\u6570\uff0c\u5373\u5de6\u4e8c\u5b50\u662f\u5426\u5b58\u5728 \n\t\t\t\tans += (flg ^ 1) * (1 << j); //\u5982\u679c\u5de6\u513f\u5b50\u5b58\u5728\uff0c\u5219\u8d70\u5de6\u513f\u5b50\uff1b\u5426\u5219\u8d70\u53f3\u513f\u5b50\uff0c\u4e0b\u9762\u540c\u7406 \n\t\t\t}\n\t\t\telse {\n\t\t\t\tint lef = ans + (1 << j), rig = ans + (1 << (j + 1)) - 1;\n\t\t\t\tif(rig - x < 0 || lef - x > T)flg = 0;\n\t\t\t\telse if(query(rt[r], rt[l - 1], 0, T, max(lef - x, 0), min(T, rig - x)) == 0)flg = 0;\n\t\t\t\tans += flg * (1 << j); //\u5982\u679c\u53f3\u513f\u5b50\u5b58\u5728\uff0c\u8d70\u53f3\u513f\u5b50\uff0c\u5426\u5219\u8d70\u5de6\u4e8c\u5b50 \n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\", ans ^ b);//trie\u6570\u5230\u8fbe\u5e95\u7aef\uff0cans\u4e3a\u5f02\u6216b\u6700\u5927\u7684\u6570 \n\t}\n\treturn 0;\n}\n\n```\n",
        "postTime": 1610271412,
        "uid": 149192,
        "name": "__gcd",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3293 \u3010[SCOI2016]\u7f8e\u5473\u3011"
    },
    {
        "content": "# \u4e3b\u5e2d\u6811\n\n\u611f\u89c9\u5176\u4ed6\u5173\u4e8e\u4e3b\u5e2d\u6811\u9898\u89e3\u4e0d\u662f\u5f88\u597d\u61c2\uff1f\u90a3\u6211\u6765\u4e00\u53d1\n\n\n------------\n# \u601d\u8def\uff1a\n\n\u9996\u5148\uff0c\u6211\u4eec\u770b\u5230\u8981\u9009\u533a\u95f4\u7684\u6570\uff0c\u5e76\u4e14\u7ed3\u5408\u9898\u610f\u5c31\u77e5\u9053\u7528\u4e3b\u5e2d\u6811\u5566~~(\u770b\u9898\u76ee\u6807\u7b7e\u4e5f\u9614\u4ee5QAQ)~~\n\n\u7136\u540e\u6211\u4eec\u770b\u5230\u8981\u6c42\u6700\u5927\u5f02\u6216\u548c\uff0c\u56e0\u4e3a\u5f02\u6216\u4e2d\uff0c\u4e8c\u8fdb\u5236\u6bcf\u4e00\u4f4d\u90fd\u662f\u72ec\u7acb\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u6309\u4f4d\u5904\u7406\n\n\u800c\u9898\u76ee\u662f\u7ed9\u5b9a\u4e24\u4e2a\u6570$b,x$\uff0c\u8981\u6c42$(a[i]+x)\\oplus b$\uff0c\u90a3\u4e48\u65e2\u7136$b,x$\u7ed9\u5b9a\u4e86\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7ef4\u62a4\u4e00\u4e0b$a[i]$\u5c31\u884c\u4e86\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u5f00\u4e00\u9897\u4e3b\u5e2d\u6811\uff0c\u4ee5$a[i]$\u4e3a\u4e0b\u6807\uff0c\u91cc\u9762\u5b58\u7684\u503c\u8868\u793a\u51fa\u73b0\u6b21\u6570\n\n- \u90a3\u4e48\u6211\u4eec\u8003\u8651\u4e0b\u9762\u7684\u60c5\u51b5\uff1a\n\n\u9996\u5148\uff0c\u6211\u4eec\u6839\u636e\u8d2a\u5fc3\u601d\u8def\uff0c\u6211\u4eec\u4ece\u9ad8\u5230\u4f4e\u4e00\u4f4d\u4e00\u4f4d\u6765\u770b\uff0c\u663e\u7136\u5982\u679c\u53ef\u4ee5\u8ba9\u5f53\u524d\u8fd9\u4e00\u4f4d\u4e3a$1$\uff0c\u90a3\u4e48\u80af\u5b9a\u4f1a\u66f4\u4f18\uff08\u4e0d\u7ba1\u5bf9\u540e\u9762\u7684\u5f71\u54cd\uff09\n\n\u90a3\u4e48\u6211\u4eec\u5206\u4e24\u7c7b\u8ba8\u8bba\uff08$ans$\u8bb0\u5f55\u7684\u662f$a[i]+x$,\u4e3b\u5e2d\u6811\u5982\u4e0a\u6587\u6240\u8ff0\uff09\uff1a\n\n- \u5047\u8bbe\u73b0\u5728\u6211\u4eec\u5904\u7406\u5230\u4e86\u7b2c$i$\u4f4d\uff0c\u5982\u679c\u6b64\u65f6$b$\u8fd9\u4e00\u4f4d\u4e3a$0$\uff0c\u90a3\u4e48\u6211\u4eec\u4e3a\u4e86\u6700\u7ec8$ans\\oplus b$\u66f4\u5927\uff0c$ans$\u6700\u597d\u5728\u8fd9\u4e00\u4f4d\u4e3a$1$\uff0c\u90a3\u4e48$ans$\u7684\u8303\u56f4\u591a\u5c11\u5462\uff1f\n\n\u5176\u5b9e\u5c31\u662f$[ans+(1<<i),ans+(1<<(i+1))-1]$\n\n\u4e3a\u4ec0\u4e48\u5462\uff1f\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5047\u8bbe\u679a\u4e3e\u5230\u4e86\u7b2c$4$\u4f4d\uff0c\u6700\u53f3\u8fb9\u4e3a\u6700\u4f4e\u4f4d\uff0c\u6b64\u65f6\u7684$ans$\u4e3a$1010000$,\u56e0\u4e3a\u53ea\u679a\u4e3e\u5230\u4e86\u7b2c\u56db\u4f4d\uff0c\u6240\u4ee5\u7b2c\u4e94\u4f4d\u4e4b\u540e\u90fd\u662f$0$\uff0c\u90a3\u4e48\u4e3a\u4e86\u8ba9\u7b2c\u56db\u4f4d\u662f$1$\uff0c\u90a3\u4e48\u8303\u56f4\u5c31\u662f$[1011000,1011111]$\n\n\u800c\u6211\u4eec\u77e5\u9053\u4e86$ans$\u7684\u8303\u56f4\uff0c\u800c$ans$\u4ee3\u8868\u7684\u662f$a[i]+x$\uff0c\u90a3\u4e48\u6211\u4eec\u5176\u5b9e\u53ea\u9700\u8981\u77e5\u9053\u6709\u6ca1\u6709$a[i]$\u5728$[ans+(1<<i)-x,ans+(1<<(i+1))-1-x]$\u8fd9\u4e2a\u533a\u95f4\u5c31\u53ef\u4ee5\u4e86\uff0c\u800c\u9898\u76ee\u4e2d\u9650\u5236\u4e86\u5728\u67d0\u4e2a\u533a\u95f4\u4e2d\uff0c\u76f4\u63a5\u4e0a\u4e3b\u5e2d\u6811\u677f\u5b50\u67e5\u8be2\u5c31$ok$\n\n- \u90a3\u4e48\u5982\u679c$b$\u6b64\u65f6\u4e3a$1$\u7684\u8bdd\u540c\u7406\uff0c\u90a3\u4e48\u6211\u4eec\u4e3a\u4e86\u6700\u7ec8$ans\\oplus b$\u66f4\u5927\uff0c$ans$\u8fd9\u4e00\u4f4d\u6700\u597d\u4e3a$0$\uff0c\u90a3\u4e48$ans$\u7684\u53d6\u503c\u8303\u56f4\u662f$[ans,ans+(1<<i)-1]$,\u81ea\u7136$a[i]$\u7684\u53d6\u503c\u8303\u56f4\u5c31\u662f$[ans-x,ans+(1<<i)-1-x]$\u4e86\n\n\n\u6700\u540e\u628a$ans$\u5f02\u6216\u4e00\u4e0b$b$\u5c31\u662f\u7b54\u6848\u5566\n\n\n------------\n\u4e0b\u9762\u662f\u7f8e\u6ecb\u6ecb\u7684\u4ee3\u7801\u65f6\u95f4~~~\n\n~~~cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#define N 200007\n#define M 100007\nusing namespace std;\nstruct Tree\n{\n\tint ls,rs,sum;\n}tr[N<<7];\nint n,m,cnt;\nint root[N];\nvoid Pushup(int rt)\n{\n\ttr[rt].sum=tr[tr[rt].ls].sum+tr[tr[rt].rs].sum;\n}\nvoid Build(int &rt,int l,int r)\n{\n\tif(!rt)\n\t\trt=++cnt;\n\tif(l==r)\n\t\treturn;\n\tint mid=l+((r-l)>>1);\n\tBuild(tr[rt].ls,l,mid);\n\tBuild(tr[rt].rs,mid+1,r);\n}\nvoid Insert(int &now,int last,int l,int r,int pos)\n{\n\tif(!now)\n\t\tnow=++cnt;\n\tif(l==r)\n\t{\n\t\ttr[now].sum=tr[last].sum+1;\n\t\treturn;\n\t}\n\tint mid=l+((r-l)>>1);\n\tif(pos<=mid)\n\t{\n\t\ttr[now].rs=tr[last].rs;\n\t\tInsert(tr[now].ls,tr[last].ls,l,mid,pos);\n\t}\n\telse\n\t{\n\t\ttr[now].ls=tr[last].ls;\n\t\tInsert(tr[now].rs,tr[last].rs,mid+1,r,pos);\n\t}\n\tPushup(now);\n}\nbool Search(int now,int last,int l,int r,int ql,int qr)\n{\n\tif(tr[last].sum-tr[now].sum<1)\n\t\treturn 0;\n\tif(ql<=l&&r<=qr)\n\t\treturn 1;\n\tint mid=l+((r-l)>>1),tot=0;\n\tif(ql<=mid)\n\t\ttot+=Search(tr[now].ls,tr[last].ls,l,mid,ql,qr);\n\tif(qr>mid)\n\t\ttot+=Search(tr[now].rs,tr[last].rs,mid+1,r,ql,qr);\n\treturn tot;\n}\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\tBuild(root[0],0,M);\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tint in;\n\t\tscanf(\"%d\",&in);\n\t\tInsert(root[i],root[i-1],0,M,in);\n\t}\n\tfor(int i=1;i<=m;++i)\n\t{\n\t\tint b,x,ql,qr,ans=0;\n\t\tscanf(\"%d%d%d%d\",&b,&x,&ql,&qr);\n\t\tfor(int j=17;j>=0;--j)\n\t\t{\n\t\t\tint L,R,opt;\n\t\t\tif(b&(1<<j))\n\t\t\t\tL=ans,R=ans+((1<<j)-1),opt=0;\n\t\t\telse\n\t\t\t\tL=ans+(1<<j),R=ans+((1<<(j+1))-1),opt=1;\n\t\t\t//printf(\"\\n-------test-------\\n\"),printf(\"ans:%d\",opt),printf(\"\\n-------test-------\\n\");\n\t\t\tif(!Search(root[ql-1],root[qr],0,M,max(L-x,0),min(R-x,M)))\n\t\t\t\topt^=1;\n\t\t\tans+=(opt<<j);\n\t\t}\n\t\tprintf(\"%d\\n\",ans^b);\n\t}\n\treturn 0;\n}\n~~~\n\n\n\n",
        "postTime": 1552012064,
        "uid": 96968,
        "name": "3493441984zz",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3293 \u3010[SCOI2016]\u7f8e\u5473\u3011"
    },
    {
        "content": "### \u524d\u8a00\n\n![CMLL02_AK_DSPOLY.jpg](https://cdn.luogu.com.cn/upload/image_hosting/0mabjd42.png)\n\n### \u601d\u8def\n\n\u8003\u8651\u4e8c\u5206\u7b54\u6848\u3002\n\n\u5bf9\u7b54\u6848 $ans$ \u4ece\u9ad8\u4f4d\u5230\u4f4e\u4f4d\u8003\u8651\uff0c\u76f4\u63a5\u8003\u8651 $(ans\\operatorname{XOR}b)-x$ \u7684\u53d6\u503c\u8303\u56f4\u3002\n\n\u8003\u8651\u4f4e\u4f4d\u4efb\u610f\uff0c\u9ad8\u4f4d\u5df2\u5b9a\uff0c\u76f4\u63a5\u6613\u5f97 $ans\\operatorname{XOR}b$ \u4e4b\u503c\u57df\u4ea6\u4e3a**\u4f4e\u4f4d\u4efb\u610f\uff0c\u9ad8\u4f4d\u5df2\u5b9a**\u3002\n\n\u4e8e\u662f\u7acb\u523b\u5f97\u5230 $(ans\\operatorname{XOR}b)-x$ \u7684\u503c\u57df\uff0c\u62ff\u9897\u4e3b\u5e2d\u6811\u5224\u65ad\u4e00\u4e0b\u8be5\u533a\u95f4\u5185\u662f\u5426\u5b58\u5728\u8be5\u503c\u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6 $O(n\\log v+q\\log^2v)$\u3002\n\n### Code\n\n\u7531\u4e8e\u4f7f\u7528\u6307\u9488\u5b9e\u73b0\uff0c\u65f6\u7a7a\u5e38\u6570\u8f83\u5927\u3002\n\n```cpp\n#include <algorithm>\n#include <stdio.h>\n#include <vector>\ntypedef long long llt;\ntypedef unsigned uint;typedef unsigned long long ullt;\ntypedef bool bol;typedef char chr;typedef void voi;\ntypedef double dbl;\ntemplate<typename T>bol _max(T&a,T b){return(a<b)?a=b,true:false;}\ntemplate<typename T>bol _min(T&a,T b){return(b<a)?a=b,true:false;}\ntemplate<typename T>T power(T base,T index,T mod){return((index<=1)?(index?base:1):(power(base*base%mod,index>>1,mod)*power(base,index&1,mod)))%mod;}\ntemplate<typename T>T lowbit(T n){return n&-n;}\ntemplate<typename T>T gcd(T a,T b){return b?gcd(b,a%b):a;}\ntemplate<typename T>T lcm(T a,T b){return(a!=0||b!=0)?a/gcd(a,b)*b:(T)0;}\ntemplate<typename T>T exgcd(T a,T b,T&x,T&y){if(!b)return y=0,x=1,a;T ans=exgcd(b,a%b,y,x);y-=a/b*x;return ans;}\nuint X[300005];\nstruct node\n{\n    friend uint size(node*p){return p==NULL?0:p->siz;}\n    uint siz,dep;node*son[2];\n    node(uint d):siz(0),dep(d){son[0]=son[1]=NULL;}\n    uint find(uint l,uint r)\n    {\n        if(l>=r)return 0;\n        if(!l&&r==(1u<<(dep+1)))return siz;\n        if(l<(1u<<dep))\n            if(r<=(1u<<dep))return son[0]==NULL?0:son[0]->find(l,r);\n            else return(son[0]==NULL?0:son[0]->find(l,1u<<dep))+(son[1]==NULL?0:son[1]->find(0,r-(1u<<dep)));\n        else return son[1]==NULL?0:son[1]->find(l-(1u<<dep),r-(1u<<dep));\n    }\n};\nuint cnt=0;\nnode*R[300005];\nint main()\n{\n    uint n,q;scanf(\"%u%u\",&n,&q);\n    for(uint i=0;i<n;i++)scanf(\"%u\",X+i);\n    R[0]=new node(20);\n    for(uint i=0;i<n;i++)\n    {\n        uint v=X[i];\n        *(R[i+1]=new node(20))=*R[i];\n        node*p=R[i],*q=R[i+1];\n        q->siz++;\n        for(uint i=20;~i;i--)\n        {\n            uint op=v>>i&1;\n            q=q->son[op]=new node(i-1);\n            if(p!=NULL)p=p->son[op];\n            if(p!=NULL)*q=*p;\n            q->siz++;\n        }\n    }\n    while(q--)\n    {\n        uint b,x,l,r;scanf(\"%u%u%u%u\",&b,&x,&l,&r),l--;\n        uint ans=0;\n        for(uint i=20;~i;i--)\n        {\n            uint p=ans|(1u<<i);\n            p^=b&~((1u<<i)-1);\n            uint q=p+(1u<<i);\n            if(p>x)p-=x;else p=0;\n            if(q>x)q-=x;else q=0;\n            if(R[r]->find(p,q)>R[l]->find(p,q))\n                ans|=1u<<i;\n        }\n        printf(\"%u\\n\",ans);\n    }\n    return 0;\n}\n```\n\n",
        "postTime": 1649129906,
        "uid": 105050,
        "name": "myee",
        "ccfLevel": 7,
        "title": "3293"
    },
    {
        "content": "## \u9898\u610f\n\n\u5148\u7ed9\u4f60\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6570\u7ec4 $a$\uff0c\u63a5\u4e0b\u6765\u6709 $m$ \u7ec4\u6570\u636e\uff0c\u6bcf\u7ec4\u6570\u636e\u5404\u6709\u4e00\u7ec4 $b,x,l,r$\uff0c\u8ba9\u4f60\u6c42\u5728\u533a\u95f4 $[l,r]$ \u4e2d $b \\oplus (a_i+x)$ \u7684\u6700\u5927\u503c\u3002\n\n## \u505a\u6cd5\n\n\u76f8\u4fe1\u5f88\u591a\u4eba\u8ddf\u6211\u4e00\u6837\uff0c\u7b2c\u4e00\u773c\u770b\u5230\u8fd9\u4e2a\u9898\u9762\uff0c\u5c31\u89c9\u5f97\u662f\u53ef\u6301\u4e45\u5316\u7ebf\u6bb5\u6811\u52a0 Trie \u6811\u4e71\u641e\u7684\uff0c\u4f46\u5199\u4e86\u5199\u5c31\u53d1\u73b0\uff0cTrie \u6811\u597d\u50cf\u7528\u4e0d\u5230\uff0c\u8d2a\u5fc3\u5c31\u53ef\u4ee5\u4e86\uff0c\u5177\u4f53\u5982\u4e0b\u3002\n\n\u56e0\u4e3a\u662f\u5224\u65ad\u5f02\u6216\u6700\u5927\u548c\uff0c\u6211\u4eec\u4e0d\u59a8\uff0c\u4e00\u4f4d\u4e00\u4f4d\u7684\u8d2a\u5fc3\uff0c\u5373\u6309\u4f4d\u8d2a\u5fc3\uff0c\u90a3\u4e48\u5c31\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\n\n1. $b$ \u7684\u7b2c $j$ \u4f4d\u4e3a $0$ \u65f6\uff0c\u56e0\u4e3a\u8003\u8651\u5f02\u6216\u6700\u5927\uff0c\u6240\u4ee5\u6700\u597d\u4f7f $a_i$ \u7684\u7b2c $j$ \u4f4d\u4e3a $1$\uff0c\u90a3\u4e48\u641c\u7d22\u7684\u8303\u56f4\u5c31\u4e3a $[ans+(1<<j),ans+(1<<(j+1))-1]$\uff0c$ans$ \u4e3a\u524d\u51e0\u4f4d\u7684\u8d2a\u5fc3\u7ed3\u679c\uff0c\u8fd9\u4e5f\u5f88\u597d\u63a8\u5bfc\uff0c\u5047\u8bbe\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6570\u5b83\u7684\u6700\u9ad8\u4f4d $k$ \u4e3a $1$\uff0c\u540e\u9762\u7684\u51e0\u4f4d\u968f\u610f\uff0c\u90a3\u4e48\uff0c\u5b83\u6700\u5927\u5c31\u4e3a $1<<(k+1)-1$\uff0c\u5373\u540e\u9762\u5168\u662f $1$\uff0c\u6700\u5c0f\u5c31\u4e3a $1<<k$\uff0c\u5373\u540e\u9762\u5168\u662f $0$\u3002\n\n2. $b$ \u7684\u7b2c $j$ \u4f4d\u4e3a $1$ \u65f6\uff0c\u8003\u8651\u5f02\u6216\u6700\u5927\uff0c\u6240\u4ee5\u6700\u597d\u4f7f $a_i$ \u7684\u7b2c $j$ \u4f4d\u4e3a $0$\uff0c\u6240\u4ee5\u641c\u7d22\u7684\u8303\u56f4\u4e3a $[ans,ans+(1<<j)-1]$\uff0c\u63a8\u5bfc\u540c\u4e0a\u3002\n\n\u6240\u4ee5\u53ea\u9700\u8981\u4ece\u9ad8\u5f80\u4f4e\u8d2a\u5fc3\uff0c\u518d\u7528\u4e3b\u5e2d\u6811\u641c\u7d22\u5224\u65ad\u533a\u95f4\u4e2d\u662f\u5426\u5b58\u5728\u7b26\u5408\u8981\u6c42\u7684\u6570\u5373\u53ef\u3002\n \n## Code\n```cpp\n#include <algorithm>\n#include <iostream>\n#include <cstdio>\n\n#define N 200001\n\nusing namespace std;\nint n,m,cnt;\nint a[N],maxn;\nint root[N];\n\nstruct Node {\n    int l,r,sum;\n}e[N<<5];\n\nint clone(int x) {\n    e[++cnt]=e[x];\n    e[cnt].sum++;\n    return cnt;\n}\n\nvoid build(int &x,int l,int r) {\n    x=++cnt;\n    if (l==r) return;\n    int mid=(l+r>>1);\n    build(e[x].l,l,mid);\n    build(e[x].r,mid+1,r);\n}\n\nvoid add(int &x,int l,int r,int k) {\n    x=clone(x);\n    if (l==r) {\n        return;\n    }\n    int mid=(l+r>>1);\n    if (k>mid) add(e[x].r,mid+1,r,k);\n    else add(e[x].l,l,mid,k);\n}\n\nbool ask(int x,int y,int l,int r,int L,int R) {\n    int tmp=0;\n    if (e[y].sum-e[x].sum<1) return 0;\n    if (L<=l and r<=R) return 1;\n    int mid=(l+r>>1);\n    if (L<=mid) tmp+=ask(e[x].l,e[y].l,l,mid,L,R);\n    if (R>mid) tmp+=ask(e[x].r,e[y].r,mid+1,r,L,R);\n    return tmp;\n}\n\nint main() {\n    scanf(\"%d%d\",&n,&m);\n    for (int i=1;i<=n;i++) scanf(\"%d\",a+i),maxn=max(maxn,a[i]);\n    build(root[0],0,maxn);\n    for (int i=1;i<=n;i++) {\n        root[i]=root[i-1];\n        add(root[i],0,maxn,a[i]);\n    }\n    for (int i=1,b,x,l,r,ans=0;i<=m;i++) {\n        ans=0;\n        scanf(\"%d%d%d%d\",&b,&x,&l,&r);\n        for (int j=17,ll,rr,tt=0;j>=0;j--) {\n            int tmp=(1<<j);\n            if (b&tmp) ll=ans,rr=ans+(1<<j)-1,tt=0;\n            else ll=ans+(1<<j),rr=ans+(1<<(j+1))-1,tt=1;\n            if (!ask(root[l-1],root[r],0,maxn,max(ll-x,0),min(rr-x,maxn)))\n                tt^=1;\n            ans+=(tt<<j);\n        }\n        printf(\"%d\\n\",ans^b);\n    }\n    return 0;\n}\n```",
        "postTime": 1653036573,
        "uid": 420129,
        "name": "Nt_Tsumiki",
        "ccfLevel": 5,
        "title": "\u9898\u89e3\uff1aP3293 [SCOI2016]\u7f8e\u5473"
    },
    {
        "content": "[$Akamey's$ $blog$](https://www.cnblogs.com/Akmaey/p/14310192.html)\n\n# \u9898\u610f\n\n[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3293)\n\n# \u5206\u6790\n\n\u9898\u610f\u662f\u67e5\u8be2\u4e00\u6bb5\u533a\u95f4\u4e2d\u7684\u5f02\u6216\u548c\u7684\u6700\u5927\u503c\uff0c\u6240\u4ee5\u53ef\u4ee5\u60f3\u5230**\u6309\u4f4d\u8d2a\u5fc3**\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u679a\u4e3e\u5f53\u524d\u53ef\u80fd\u7684\u7b54\u6848$ans=a[i]+x$\u7684\u6bcf\u4e00\u4f4d\uff08\u4ece\u9ad8\u5230\u4f4e\uff09\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\n\n\u6700\u7ec8\u7b54\u6848$a[i]$\u4e00\u5b9a\u843d\u5728\uff1a\n\n$\\large [ans+(1<<i)-x,ans+(1<<(i+1))-1-x]$ $\\quad \\large (b[i]$\u8fd9\u4e00\u4f4d\u4e3a$\\large 0)$\n\n$\\large [ans-x,ans+(1<<i)-1-x]$ $\\quad \\large (b[i]$\u8fd9\u4e00\u4f4d\u4e3a$\\large1)$\n\n\u4e0a\u9762\u4e24\u79cd\u60c5\u51b5\u5206\u522b\u5bf9\u5e94$b[i]$\u7684\u5f53\u524d\u4f4d\u4e3a$0$\u548c$1$\u7684\u60c5\u51b5\n\n\u5f53$b[i]$\u4e3a$0$\uff0c\u5219\u5f53\u524d\u4f4d\u4e3a$1$\u7b54\u6848\u66f4\u4f18\n\n\u5f53$b[i]$\u4e3a$1$\uff0c\u5219\u5f53\u524d\u4f4d\u4e3a$0$\u7b54\u6848\u66f4\u4f18\n\n\u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u67e5\u8be2\u5728\u4e24\u6bb5\u503c\u57df\u533a\u95f4\u5185\u6709\u6ca1\u6709\u6570\u5373\u53ef\uff0c\u5982\u679c\u6709\uff0c\u90a3\u4e48\u7ee7\u7eed\u4e0b\u4e00\u4f4d\u7684\u679a\u4e3e\uff0c\u5f53\u524d\u8fd9\u4e00\u4f4d\u5c31\u53d8\u6210$1/0$\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u90a3\u4e48\u5f53\u524d\u8fd9\u4e00\u4f4d\u5c31\u53d8\u6210$0/1$\uff0c\u8fd8\u662f\u7ee7\u7eed\u4e0b\u4e00\u4f4d\uff0c\u76f4\u5230\u7ed3\u675f\n\n\u6b64\u65f6$ans=a[i]+x$\uff0c\u6240\u4ee5\u6211\u4eec\u76f4\u63a5$ans \\bigoplus b$\u5c31\u662f\u6700\u4f18\u7684\u7b54\u6848\n\n\u56e0\u4e3a\u8981\u533a\u95f4\u67e5\u8be2\u503c\u57df\u4e0a\u6570\u7684\u4e2a\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u7528\u503c\u57df\u7ebf\u6bb5\u6811\u6765\u7ef4\u62a4\n\n\u4f46\u662f\u6211\u4eec\u8fd9\u6837\u5e72\u53ea\u80fd\u8bb0\u5f55\u5bf9\u4e8e\u4e0b\u6807\u533a\u95f4$[1,n]$\u7684\u503c\u57df\u7ebf\u6bb5\u6811\uff08\u4e5f\u5c31\u662f\u5168\u5c40\uff09\uff0c\u4f46\u662f\u6211\u4eec\u8fd9\u91cc\u8fd8\u8981\u6c42\u67d0\u4e00\u4e2a\u7279\u5b9a\u533a\u95f4$[l,r]$\u5f53\u4e2d\u7684\u503c\u57df\u7ebf\u6bb5\u6811\n\n\u8fd9\u5c31\u662f\u4e3b\u5e2d\u6811\u7684\u7ecf\u5178\u5e94\u7528\u4e86\uff0c\u9759\u6001\u533a\u95f4\u7b2c$k$\u5927\u7684\u95ee\u9898\u4e2d\u6211\u4eec\u5c31\u7528\u8fc7\u503c\u57df\u7ebf\u6bb5\u6811\u7ef4\u62a4\u503c\u57df\uff0c\u7136\u540e\u7528\u4e0b\u6807\u7684\u5dee\u6765\u7ef4\u62a4\u533a\u95f4\u5373\u53ef\n\n\u6240\u4ee5\u6211\u4eec\u8fd9\u91cc\u91c7\u7528\u4e3b\u5e2d\u6811\u6765\u7ef4\u62a4\u503c\u57df\u5c31\u884c\u4e86\n# \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntemplate <typename T>\ninline void read(T &x){\n\tx=0;char ch=getchar();bool f=false;\n\twhile(!isdigit(ch)){if(ch=='-'){f=true;}ch=getchar();}\n\twhile(isdigit(ch)){x=(x<<1)+(x<<3)+(ch^48);ch=getchar();}\n\tx=f?-x:x;\n\treturn ;\n}\ntemplate <typename T,typename... Args> inline void read(T& t, Args&... args){read(t);read(args...);}\ntemplate <typename T>\ninline void write(T x){\n\tif(x<0) putchar('-'),x=-x;\n\tif(x>9) write(x/10);\n\tputchar(x%10^48);\n\treturn ;\n}\ntemplate <typename T>\ninline void print(T x){write(x),putchar(' ');}\n#define ll long long\n#define ull unsigned long long\n#define inc(x,y) (x+y>=MOD?x+y-MOD:x+y)\n#define dec(x,y) (x-y<0?x-y+MOD:x-y)\n#define min(x,y) (x<y?x:y)\n#define max(x,y) (x>y?x:y)\nconst int N=2e5+5,M=1e5+5,MOD=1e9+7;\nint n,m,a[N],b[N],root[N],cnt;\nstruct Segment_Tree{\n\tint sum,ls,rs;\n\t#define sum(x) Tree[x].sum\n\t#define ls(x) Tree[x].ls\n\t#define rs(x) Tree[x].rs\n}Tree[N<<5];\nvoid build(int &rt,int l,int r){\n\trt=++cnt;\n\tif(l==r){sum(rt)=0;return;}\n\tint mid=l+r>>1;\n\tbuild(ls(rt),l,mid),build(rs(rt),mid+1,r);\n\treturn ;\n}\nvoid modify(int &rt,int pre,int l,int r,int pos,int v){\n\trt=++cnt;\n\tif(l==r){sum(rt)=sum(pre)+v;return ;}\n\tint mid=l+r>>1;\n\tls(rt)=ls(pre),rs(rt)=rs(pre),sum(rt)=sum(pre)+v;\n\tif(pos<=mid) modify(ls(rt),ls(pre),l,mid,pos,v);\n\telse modify(rs(rt),rs(pre),mid+1,r,pos,v);\n\treturn ;\n}\nbool query(int u,int v,int l,int r,int ql,int qr){\n\tif(sum(v)-sum(u)<1) return false;\n\tif(ql<=l&&r<=qr) return true;\n\tint mid=l+r>>1,res=0;\n\tif(ql<=mid) res+=query(ls(u),ls(v),l,mid,ql,qr);\n\tif(qr>mid) res+=query(rs(u),rs(v),mid+1,r,ql,qr);\n\treturn res;\n}\n\nint main(){\n\tread(n),read(m);build(root[0],0,M);\n\tfor(int i=1;i<=n;i++){\n\t\tread(a[i]);\n\t\tmodify(root[i],root[i-1],0,M,a[i],1);\n\t}\n\tfor(int i=1,b,x,l,r;i<=m;i++){\n\t\tread(b),read(x),read(l),read(r);\n\t\tint ans=0;\n\t\tfor(int k=17;k>=0;k--){\n\t\t\tint L,R,op;\n\t\t\tif(b&(1<<k)) L=ans,R=ans+((1<<k)-1),op=0;\n\t\t\telse L=ans+(1<<k),R=ans+((1<<(k+1))-1),op=1;\n\t\t\tif(!query(root[l-1],root[r],0,M,max(L-x,0),min(R-x,M))) op^=1;\n\t\t\tans+=(op<<k);\n\t\t}\n\t\twrite(ans^b),putchar('\\n');\n\t}\n\tsystem(\"Pause\");\n\treturn 0;\n}",
        "postTime": 1611231046,
        "uid": 130387,
        "name": "_Anchor",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3293 \u3010[SCOI2016]\u7f8e\u5473\u3011"
    },
    {
        "content": "\u672c\u9898\u4e3a\u7ecf\u5178\u7684\u53ef\u6301\u4e45\u5316trie\u7ec3\u4e60\u9898\n\n\u5148\u5bf9\u6240\u6709\u83dc\u5efa\u4e00\u68f5\u53ef\u6301\u4e45\u5316trie\n\n\u987e\u5ba2\u7684\u504f\u597d\u503c\u76f8\u5f53\u4e8e\u5728trie\u4e0a\u7684\u201c\u504f\u79fb\u91cf\u201d\uff0c\u9700\u8981\u652f\u6301\u4e00\u4e2a\u67e5\u8be2\u64cd\u4f5c\uff1a\u67e5\u8be2\u4e24\u4e2a\u7248\u672c\u95f4trie\u4e0a\u6570\u503cL~R\u533a\u95f4\u662f\u5426\u5b58\u5728\u83dc\n\n\u67e5\u8be2\u7684\u65f6\u5019\u5c06r\u7248\u672c\u548cl-1\u7248\u672ctrie\u76f8\u51cf\uff0c\u5728trie\u4e0a\u8dd1\u4e00\u904d\u7c7b\u4f3c\u7ebf\u6bb5\u6811\u7684\u67e5\u8be2\u5c31\u597d\n\n\u6700\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u987e\u5ba2\uff0c\u8dd1\u4e00\u4e0b\u5e26\u504f\u79fb\u7684\u6309\u4f4d\u8d2a\u5fc3\uff0c\u4e5f\u5c31\u662f\u8d2a\u5230\u6bcf\u4e00\u5c42\u65f6\uff0c\u5206\u522b\u7528\u4e0a\u9762\u7684\u64cd\u4f5c\u67e5\u8be2\u51faL-x~mid-x\u533a\u95f4\u548cmid-x+1~R-x\u533a\u95f4\u5206\u522b\u662f\u5426\u5b58\u5728\u83dc\u3002\n\n\u590d\u6742\u5ea6\u8c8c\u4f3c\u662f $ O ( m log^2 \\cdot n ) $ \uff1f\n\n\n\u826f\u5fc3\u63d0\u793a\uff1a\u5728bzoj\u4e0a\u4e0d\u8981\u7528cin\u3002\u3002RE\u4e86\u6211\u597d\u4e45\n\n\n\u8d34\u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\nusing namespace std;\nconst int MAXN=524287;\nstruct node\n{\n    int cnt;\n    node *ls,*rs;\n}pool[6000010],*root[2*MAXN];\nint top,curt;\nint n,m,a,b,x,l,r;\nvoid inorder(node *cur)\n{\n    printf(\"{\");\n    if(cur->ls){inorder(cur->ls);}\n    printf(\"(%d)\",cur->cnt);\n    if(cur->rs){inorder(cur->rs);}\n    printf(\"}\");\n}\nnode* bt(int l,int r)\n{\n    node *tmp=&pool[top++];\n    tmp->cnt=0;\n    if(l!=r)\n    {\n        int m=(l+r)/2;\n        tmp->ls=bt(l,m);\n        tmp->rs=bt(m+1,r);\n    }\n    return tmp;\n}\nnode* Change(node *pre,int x,int l,int r)\n{\n    node *tmp=&pool[top++];\n    tmp->cnt=pre->cnt+1;\n    if(l==r){return tmp;}\n    int m=(l+r)/2;\n    if(x<=m){tmp->ls=Change(pre->ls,x,l,m);tmp->rs=pre->rs;}\n    else {tmp->ls=pre->ls;tmp->rs=Change(pre->rs,x,m+1,r);}\n    return tmp;\n}\nbool hn(node *cur,node *sub,int l,int r,int lrg,int rrg)\n{\n    if(l==lrg&&r==rrg)return cur->cnt-sub->cnt;\n    int m=(l+r)/2;\n    if(rrg<=m)return hn(cur->ls,sub->ls,l,m,lrg,rrg);\n    if(lrg>m)return hn(cur->rs,sub->rs,m+1,r,lrg,rrg);\n    return hn(cur->ls,sub->ls,l,m,lrg,m)||hn(cur->rs,sub->rs,m+1,r,m+1,rrg);\n}\nbool HN(int lt,int rt,int lrg,int rrg)\n{\n    if(rrg<0)return false;\n    return hn(root[rt],root[lt-1],0,MAXN,max(0,lrg),rrg);\n}\nint query(int lt,int rt,int dep,int l,int r,int x,int b)\n{\n    if(l==r)return l^b;\n    int oi=(b>>dep)&1,m=(l+r)/2;\n    if(oi)\n    {\n        if(HN(lt,rt,l-x,m-x))\n            return query(lt,rt,dep-1,l,m,x,b);\n        else\n            return query(lt,rt,dep-1,m+1,r,x,b);\n    }\n    else\n    {\n        if(HN(lt,rt,m+1-x,r-x))\n            return query(lt,rt,dep-1,m+1,r,x,b);\n        else\n            return query(lt,rt,dep-1,l,m,x,b);\n    }\n}\nint Query(int b,int x,int l,int r)\n{\n    return query(l,r,18,0,MAXN,x,b);\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&m);\n    root[0]=bt(0,MAXN);\n    for(int i=1;i<=n;i++)\n    {\n        scanf(\"%d\",&a);\n        root[curt+1]=Change(root[curt],a,0,MAXN);\n        curt++;\n    }\n    for(int i=1;i<=m;i++)\n    {\n        scanf(\"%d%d%d%d\",&b,&x,&l,&r);\n        printf(\"%d\\n\",Query(b,x,l,r));\n    }\n    return 0;\n}\n```",
        "postTime": 1504161144,
        "uid": 3346,
        "name": "oscar",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3293 \u3010[SCOI2016]\u7f8e\u5473\u3011"
    },
    {
        "content": "## [Link](https://www.luogu.com.cn/problem/P3293)\n\n\u9996\u5148\u4ee4 $c_i=a_i+x(l\\le i\\le r)$\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e2a $b$\uff0c\u6211\u4eec\u8981\u627e\u4e00\u4e2a $c_i$ \u4f7f\u5f97 $b\\oplus c_i$ \u6700\u5927\u3002\n\n\u663e\u7136\u8fd9\u53ef\u4ee5\u8d2a\u5fc3\u3002\n\n\u5c06 $b$ \u8f6c\u4e3a\u4e8c\u8fdb\u5236\uff0c\u6700\u4f4e\u4f4d\u4e3a\u7b2c $0$ \u4f4d\u3002\n\n\u4ece\u9ad8\u5230\u4f4e\u4f4d\u8003\u8651\uff0c\u663e\u7136\uff0c\u5c06\u7b2c $i$ \u4f4d\u8d4b\u4e3a\u76f8\u53cd\u7684\u90a3\u4e2a\u6570\u6bd4\u5c06\u540e $i-1$ \u4f4d\u5168\u8d4b\u4e3a\u76f8\u53cd\u7684\u6570\u90fd\u66f4\u4f18\u3002\n\n\u8bbe\u5f53\u524d\u5904\u7406\u5230\u7b2c $i$ \u4f4d\uff0c\u7b2c $i$ \u4f4d\u4e3a $ch$\u3002\n\n\u82e5 $ch$ \u4e3a $0$\uff0c\u90a3\u4e48\u627e\u533a\u95f4\u5185\u662f\u5426\u6709\u7b2c $i$ \u4f4d\u4e3a $0$ \u7684\u6570\uff0c\u4e14\u6ee1\u8db3\u4e4b\u524d\u7684\u8981\u6c42\u3002\n\n\u82e5 $ch$ \u4e3a $1$\uff0c\u90a3\u4e48\u627e\u533a\u95f4\u5185\u662f\u5426\u6709\u7b2c $i$ \u4f4d\u4e3a $1$ \u7684\u6570\uff0c\u4e14\u6ee1\u8db3\u4e4b\u524d\u7684\u8981\u6c42\u3002\n\n\u5176\u5b9e\u8fd9\u5c31\u662f\u4e00\u4e2a\u627e\u533a\u95f4\u5185\u4e00\u4e2a\u503c\u57df\u7684\u6570\u7684\u4e2a\u6570\uff0c\u8fd9\u662f\u53ef\u4ee5\u7528\u4e3b\u5e2d\u6811\u7ef4\u62a4\u7684\u3002\n\n\u7136\u540e\u628a $c$ \u62c6\u5f00\uff0c\u540c\u7406\uff0c\u8fd8\u662f\u627e\u533a\u95f4\u5185\u4e00\u4e2a\u503c\u57df\u7684\u6570\u7684\u4e2a\u6570\u7684\u8fc7\u7a0b\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ninline int read()\n{\n\tint s=0;char c=getchar();\n\tfor(;!isdigit(c);c=getchar());\n\tfor(;isdigit(c);c=getchar())\n\t\ts=s*10+c-'0';\n\treturn s;\n}\nint n,m,a[200005],maxn;\nint tot,rt[200005];\nstruct segment_tree{\n\tint ls,rs,cnt;\n}s[200005*21];\nvoid update(int l,int r,int pos,int pre,int &p)\n{\n\tp=++tot;\n\ts[p]=s[pre],s[p].cnt++;\n\tif(l==r)return;\n\tint mid=(l+r)/2;\n\tif(pos<=mid)update(l,mid,pos,s[pre].ls,s[p].ls);\n\telse update(mid+1,r,pos,s[pre].rs,s[p].rs);\n}\nint query(int l,int r,int ql,int qr,int p1,int p2)//\u627e\u503c\u57df[ql,qr]\u4e2d\u662f\u5426\u6709\u6570 \n{\n\tif(ql>r||qr<l||!(s[p2].cnt-s[p1].cnt))return 0;\n\tif(ql<=l&&r<=qr)return s[p2].cnt-s[p1].cnt;\n\tint mid=(l+r)/2;\n\treturn query(l,mid,ql,qr,s[p1].ls,s[p2].ls)+query(mid+1,r,ql,qr,s[p1].rs,s[p2].rs);\n}\nbool check(int p,int q,int ql,int qr)\n{\n\tql=max(ql,0);qr=min(qr,maxn);\n\tif(ql>qr) return false;\n\treturn query(0,maxn,ql,qr,rt[p],rt[q]);\n}\nint main()\n{\n\tn=read(),m=read();\n\tfor(int i=1;i<=n;i++)\n\t\ta[i]=read(),maxn=max(maxn,a[i]);\n\tfor(int i=1;i<=n;i++)\n\t\tupdate(0,maxn,a[i],rt[i-1],rt[i]);\n\twhile(m--)\n\t{\n\t\tint b=read(),x=read(),l=read(),r=read(),ans=0;\n\t\tfor(int i=17;i>=0;i--)\n\t\t{\n\t\t\tint c=(b>>i)&1;\n\t\t\tif(c&&!query(0,maxn,ans-x,ans+(1<<i)-1-x,rt[l-1],rt[r]))ans+=(1<<i);//\u8fd9\u4f4d\u53ea\u80fd\u586b1\n            if(!c&&query(0,maxn,ans+(1<<i)-x,ans+(1<<i+1)-1-x,rt[l-1],rt[r]))ans+=(1<<i);//\u8fd9\u4f4d\u53ef\u4ee5\u586b1\n\t\t}\n\t\tprintf(\"%d\\n\",b^ans);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1660959444,
        "uid": 306049,
        "name": "Utilokasteinn",
        "ccfLevel": 0,
        "title": "P3293 [SCOI2016]\u7f8e\u5473"
    },
    {
        "content": "[\u539f\u9898\u94fe\u63a5](https://www.luogu.com.cn/problem/P3293)\n\n## \u9898\u610f\n\n\u4e00\u5bb6\u9910\u5385\u6709 $n$ \u9053\u83dc\uff0c\u7f16\u53f7 $1,2,...,n$ \uff0c\u5927\u5bb6\u5bf9\u7b2c $i$ \u9053\u83dc\u7684\u8bc4\u4ef7\u503c\u4e3a $a_i$\u3002\u6709 $m$ \u4f4d\u987e\u5ba2\uff0c\u7b2c $i$ \u4f4d\u987e\u5ba2\u7684\u671f\u671b\u503c\u4e3a $b_i$\uff0c\u800c\u4ed6\u7684\u504f\u597d\u503c\u4e3a $x_i$\u3002\u56e0\u6b64\uff0c\u7b2c $i$ \u4f4d\u987e\u5ba2\u8ba4\u4e3a\u7b2c $j$ \u9053\u83dc\u7684\u7f8e\u5473\u5ea6\u4e3a $b_i\\,\\,xor\\,\\, (a_j+x_i)$\uff0c$xor$ \u8868\u793a\u5f02\u6216\u8fd0\u7b97\u3002\n\n\u7b2c $i$ \u4f4d\u987e\u5ba2\u5e0c\u671b\u4ece\u8fd9\u4e9b\u83dc\u4e2d\u6311\u51fa\u4ed6\u8ba4\u4e3a\u6700\u7f8e\u5473\u7684\u83dc\uff0c\u5373\u7f8e\u5473\u503c\u6700\u5927\u7684\u83dc\uff0c\u4f46\u7531\u4e8e\u4ef7\u683c\u7b49\u56e0\u7d20\uff0c\u4ed6\u53ea\u80fd\u4ece\u7b2c $l_i$ \u9053\u5230\u7b2c $r_i$ \u9053\u4e2d\u9009\u62e9\u3002\u8bf7\u4f60\u5e2e\u52a9\u4ed6\u4eec\u627e\u51fa\u6700\u7f8e\u5473\u7684\u83dc\u3002\n\n## \u6570\u636e\u8303\u56f4\n\n$1 \\le n \\le 2 \\times 10^5$\uff0c$0 \\le a_i,b_i,x_i < 10^5$\uff0c$1 \\le l_i \\le r_i \\le n$\uff08$1 \\le i \\le m$\uff09\uff0c$1 \\le m \\le 10^5$\u3002\n\n## \u601d\u8def\n\n\u7531\u4e8e\u662f\u6c42\u5f02\u6216\u7684\u6700\u5927\u503c\uff0c\u53ef\u4ee5\u8003\u8651\u6309\u4e8c\u8fdb\u5236\u4f4d\u4ece\u9ad8\u5230\u5e95\u8d2a\u5fc3\u5730\u679a\u4e3e\u3002 \n\n\u5047\u8bbe\u5f53\u524d\u679a\u4e3e\u5230\u7b2c $i$ \u4f4d\uff0c\u5df2\u7ecf\u679a\u4e3e\u8fc7\u7684\u4f4d\u6570\u4e0a\u7684\u7b54\u6848\u4e3a $val$\uff0c$b$ \u7684\u7b2c $i$ \u4f4d\u4e3a $1$\uff08\u4e3a $0$ \u65f6\u540c\u7406\uff09\uff0c\u90a3\u4e48\u6b64\u65f6\u6211\u4eec\u5c31\u60f3\u8981\u5728 $a_{l} \\sim a_{r}$ \u4e2d\u67e5\u8be2\u4e00\u4e2a\u6570\uff0c\u6ee1\u8db3\u5176\u52a0\u4e0a $x$ \u540e\u524d $i-1$ \u4f4d\u4e3a $val$\uff0c\u4e14\u7b2c $i$ \u4f4d\u4e3a $0$\u3002\u53ef\u4ee5\u63a8\u51fa\u8fd9\u6837\u7684\u6570\u5728\u533a\u95f4 $[val-x,val+2^i-1-x]$ \u4e2d\u3002\n\n\u800c\u9700\u8981\u5728\u7ed9\u5b9a\u7684\u533a\u95f4\u4e2d\u5bfb\u627e\u7279\u5b9a\u7684\u503c\uff0c\u53ef\u4ee5\u7528\u4e3b\u5e2d\u6811\u7ef4\u62a4\u5e8f\u5217 $a$\u3002\u5177\u4f53\u5b9e\u73b0\u53ef\u4ee5\u770b\u4ee3\u7801\u3002 \n\n\n## code\uff1a\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nconst int N=2e5+10;\nint n,m,tot,a[N],root[N],w;\nstruct tree{int ls,rs,cnt;}tr[N*21];\nvoid insert(int p,int &q,int l,int r,int val)\n{\n\tq=++tot;if(l==r) { tr[q].cnt=tr[p].cnt+1;return ;}int mid=l+r>>1;\n\ttr[q]=tr[p];tr[q].cnt++;\n\tif(val<=mid) insert(tr[p].ls,tr[q].ls,l,mid,val);\n\telse insert(tr[p].rs,tr[q].rs,mid+1,r,val);\n}\nint query(int p,int q,int l,int r,int ql,int qr)\n{\n\tif(ql<=l&&r<=qr) return tr[q].cnt-tr[p].cnt;\n\tint res=0,mid=l+r>>1;\n\tif(ql<=mid) res+=query(tr[p].ls,tr[q].ls,l,mid,ql,qr);\n\tif(qr>mid) res+=query(tr[p].rs,tr[q].rs,mid+1,r,ql,qr);\n\treturn res;\n}\nbool check(int p,int q,int ql,int qr)\n{\n\tql=max(ql,0);qr=min(qr,w);\n\tif(ql>qr) return false;\n\treturn query(root[p],root[q],0,w,ql,qr);\n}\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);for(int i=1;i<=n;i++) scanf(\"%d\",&a[i]),w=max(w,a[i]);\n\tfor(int i=1;i<=n;i++) insert(root[i-1],root[i],0,w,a[i]);\n\twhile(m--)\n\t{\n\t\tint b,x,l,r,val=0;scanf(\"%d%d%d%d\",&b,&x,&l,&r);\n\t\tfor(int i=17;i>=0;i--)\n\t\t{\n\t\t\tint tmp=val+((1^((b>>i)&1))<<i);\n\t\t\tif(check(l-1,r,tmp-x,tmp+(1<<i)-1-x)) val=tmp;\n\t\t\telse val+=(((b>>i)&1)<<i);\n\t\t}\n\t\tprintf(\"%d\\n\",val^b);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1657536577,
        "uid": 288192,
        "name": "ListenSnow",
        "ccfLevel": 7,
        "title": "P3293 [SCOI2016]\u7f8e\u5473"
    },
    {
        "content": "## \u5206\u6790\n\u770b\u5230\u5f02\u6216\u503c\u6700\u5927\u5bb9\u6613\u60f3\u5230 01 trie\uff0c\u4f46\u662f\u8fd9\u9053\u9898\u8981 $+x_i$ \u6240\u4ee5\u4e0d\u597d\u505a\u3002\n\n\u4f46\u662f\u5176\u5b9e\u8fd8\u662f\u53ef\u4ee5\u7528 01 trie \u7684\u601d\u60f3\u3002\n\n\u4ece\u9ad8\u5f80\u4f4e\u8003\u8651\u4e8c\u8fdb\u5236\u4f4d\u3002\u8bbe\u5f53\u524d\u5728\u8003\u8651\u4ece\u4f4e\u5230\u9ad8\u7b2c $d$ \u4f4d\uff0c\u6700\u4f18\u7684 $a_j+x_i$ \u7684\u9ad8\u4f4d\u4e3a $ans$\u3002\n\n\u5047\u8bbe $b_i$ \u7684\u7b2c $d$ \u4f4d\u4e3a 0\uff0c\u4e3a 1 \u7684\u60c5\u51b5\u7c7b\u4f3c\u3002\u5c3d\u91cf\u8ba9 $a_j+x_i$ \u7684\u7b2c $d$ \u4f4d\u4e3a 1\u3002\n\n\u82e5 $a_j+x_i$ \u7684\u7b2c $d$ \u4f4d\u4e3a 1\uff0c\u5219 \n\n$$ans+2^{d-1}\\le a_j+x_i<ans+2^d$$\n\n\u4e5f\u5c31\u662f \n\n$$ans+2^{d-1}-x_i\\le a_j\\le ans+2^d-x_i-1$$\n\n\u53ea\u9700\u8981\u67e5\u8be2 $l$ \u5230 $r$ \u4e2d\u6709\u6ca1\u6709\u533a\u95f4\u5185\u7684\u503c\u3002\u53ef\u4ee5\u7528\u4e3b\u5e2d\u6811\uff08\u53ef\u6301\u4e45\u5316\u503c\u57df\u7ebf\u6bb5\u6811\uff09\u7ef4\u62a4\u3002\n\n## \u89e3\u51b3\n~~\u5e38\u6570\u600e\u4e48\u8fd9\u4e48\u5927~~\n\nCCF \u5df2\u7ecf\u8fdb\u6b65\u5230 C++14 O2 \u65f6\u4ee3\u4e86\uff0c\u6240\u4ee5\u5e38\u6570\u5927\u4e00\u70b9\u4e5f\u6ca1\u5173\u7cfb\uff08\u786e\u4fe1\uff09\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n\nusing namespace std;\nusing LL = long long;\nusing LLL = __int128;\n\nconst int N = 2e5 + 5, A = 1e5 + 5, LOG = 18;\nint n, m;\n\nclass chairmanTree {\n   private:\n    static const int C = N * LOG;\n    int lc[C], rc[C], val[C], root[N], cnt;\n\n    int modify(int p, int l, int r, int po) {\n        int q = ++cnt;\n        val[q] = val[p];\n        if (l == r) return val[q]++, q;\n        int mid = (l + r) >> 1;\n        if (po <= mid)\n            lc[q] = modify(lc[p], l, mid, po), rc[q] = rc[p];\n        else\n            lc[q] = lc[p], rc[q] = modify(rc[p], mid + 1, r, po);\n        return val[q] = val[lc[q]] + val[rc[q]], q;\n    }\n\n    int query(int p, int q, int l, int r, int ql, int qr) {\n        if (ql <= l && qr >= r) return val[q] - val[p];\n        int mid = (l + r) >> 1;\n        return (ql <= mid ? query(lc[p], lc[q], l, mid, ql, qr) : 0) +\n               (qr > mid ? query(rc[p], rc[q], mid + 1, r, ql, qr) : 0);\n    }\n\n   public:\n    void modify(int ver, int base, int po) {\n        root[ver] = modify(root[base], 0, A, po);\n    }\n\n    bool query(int l, int r, int ql, int qr) {\n        return query(root[l - 1], root[r], 0, A, max(ql, 0), min(qr, A));\n    }\n} tree;\n\ntemplate <class T>\nvoid read(T &ret) {\n    ret = 0;\n    char ch = getchar();\n    bool found = false;\n    while ((ch < '0' || ch > '9') && ch != '-') ch = getchar();\n    if (ch == '-') ch = getchar(), found = true;\n    while (ch >= '0' && ch <= '9') ret = ret * 10 + ch - '0', ch = getchar();\n    if (found) ret = -ret;\n}\n\ntemplate <class T, class... Args>\nvoid read(T &ret, Args &...rest) {\n    read(ret), read(rest...);\n}\n\nint main() {\n    read(n, m);\n    for (int i = 1, a; i <= n; i++) read(a), tree.modify(i, i - 1, a);\n    while (m--) {\n        int b, x, l, r, ans = 0;\n        read(b, x, l, r);\n        for (int i = LOG; i >= 1; i--) {\n            int cur = b >> (i - 1) & 1;\n            if (!cur && tree.query(l, r, ans + (1 << (i - 1)) - x,\n                                   ans + (1 << i) - 1 - x))\n                ans += 1 << (i - 1);\n            if (cur && !tree.query(l, r, ans - x, ans + (1 << (i - 1)) - 1 - x))\n                ans += 1 << (i - 1);\n        }\n        cout << (ans ^ b) << endl;\n    }\n    return 0;\n}\n```",
        "postTime": 1635678270,
        "uid": 253946,
        "name": "ClHg2",
        "ccfLevel": 7,
        "title": "\u3010\u9898\u89e3\u3011\u300cSCOI2016\u300d\u7f8e\u5473 \u4e3b\u5e2d\u6811"
    },
    {
        "content": "\u8fd9\u9053\u9898\u9996\u5148\u5f88\u597d\u60f3\u5230\u53ef\u6301\u4e45\u5316 $01Trie$ \u5427\uff0c\u611f\u89c9 $01Trie$ \u597d\u50cf\u597d\u60f3\u5e76\u4e14\u672c\u4eba\u521a\u5f00\u59cb\u4e5f\u60f3\u7684\u662f $01Trie$ \uff0c\u4e0d\u8fc7\u5728\u5b66\u4e60\u4e86\u8fd9\u9053\u9898\u7684\u4e3b\u5e2d\u6811\u6253\u6cd5\u540e\u8fd8\u662f\u51b3\u5b9a\u6765\u4e00\u7bc7\u4e3b\u5e2d\u6811\u9898\u89e3\u3002    \n\n\u9996\u5148\u6211\u4eec\u4e0d\u59a8\u5148\u7528\u6b63\u5e38 $01Trie$ \u7684\u89d2\u5ea6\u6765\u601d\u8003\u8fd9\u9053\u9898\uff0c\u5f02\u6216\u6700\u5927\uff0c\u663e\u7136\u5148\u8003\u8651 $01Trie$ \u548c \u7ebf\u6027\u57fa \uff0c \u7ebf\u6027\u57fa\u60f3\u4e0d\u51fa\u6765\u4e86\uff0c\u4e0d\u8fc7\u4e2d\u95f4\u6709\u4e2a\u52a0\u53f7\u597d\u50cf\u4e5f\u53ef\u4ee5\u901a\u8fc7\u503c\u57df\u7ef4\u62a4\u5728 $01Trie$ \u4e0a\u5b9e\u73b0\uff1f\u5230\u6b64\u8fd9\u9053\u9898\u7684\u7b2c\u4e00\u5370\u8c61\u601d\u8def\u5c31\u662f\u8fd9\u6837\u3002    \n\n\u5982\u679c\u60a8\u60f3\u5199\u53ef\u6301\u4e45\u5316 $01Trie$ \u7684\u8bdd\u60a8\u5c31\u5728 $Trie$ \u4e0a\u76f4\u63a5\u67e5\u8be2\u5373\u53ef\uff0c\u5176\u4ed6\u9898\u89e3\u91cc\u9762\u4e5f\u6709\u8be6\u7ec6\u89e3\u6790\u6b64\u9898\u7684 $01Trie$\u6240\u4ee5\u5728\u8fd9\u91cc\u4e0d\u4f5c\u8fc7\u591a\u89e3\u91ca\u3002    \n\n\u8fd9\u9053\u9898\u6211\u4eec\u53ef\u4ee5\u501f\u7528\u4e00\u4e0b $01Trie$ \u7684\u601d\u60f3\uff0c\u5177\u4f53\u6765\u505a\u8fd8\u662f\u4ece\u9ad8\u5230\u4f4e\u8d2a\u5fc3\uff0c\u7531\u4e8e\u4f4d\u4e4b\u95f4\u76f8\u4e92\u4e0d\u5f71\u54cd\uff0c\u6240\u4ee5\u6211\u4eec\u5355\u72ec\u6765\u8003\u8651\u3002    \n\n\u8bbe $T = a_j + x$ \uff0c\u5f53\u524d\u5df2\u7ecf\u4ece\u9ad8\u4f4d\u5230\u4f4e\u4f4d\u8003\u8651\u5230\u4e86 $T_i$\u3002   \n\n- \u5982\u679c $b_i$ \u4e3a $0$ \uff0c\u90a3\u4e48\u5f53\u524d\u8fd9\u4f4d\u6700\u4f18\u4e3a $1$ \uff0c\u5373\u6211\u4eec\u7684 $T$ \u9700\u8981\u4e3a$[T + 2 ^ i , T + 2 ^ {i + 1} - 1]$ \uff0c\u8fd9\u91cc\u5927\u5bb6\u53ef\u4ee5\u624b\u7b97\u4e00\u4e0b\u5c31\u77e5\u9053\u8fd9\u4e2a\u533a\u95f4\u91cc\u7684\u6240\u6709\u503c\u7684\u7b2c $i$ \u4f4d\u90fd\u4e3a $1$ \u3002  \n- \u5982\u679c $b_i$ \u4e3a $1$ \uff0c\u90a3\u4e48\u5f53\u524d\u8fd9\u4f4d\u6700\u4f18\u4e3a $0$ \uff0c\u5373\u6211\u4eec\u7684 $T$ \u9700\u8981\u4e3a $[T , T + 2 ^ k]$ \uff0c\u548c\u4e0a\u9762\u4e00\u4e2a\u4e00\u6837\uff0c\u8fd9\u4e2a\u533a\u95f4\u7684\u6240\u6709\u503c\u7b2c $i$ \u4f4d\u90fd\u4e3a $0$\u3002   \n\n\u8fd9\u91cc\u53ef\u80fd\u4f1a\u6709\u4eba\u95ee\u600e\u4e48\u5b9e\u73b0\uff0c\u6211\u4eec\u4ece\u9ad8\u4f4d\u8003\u8651\uff0c\u6bcf\u6b21\u6211\u4eec\u90fd\u8fdb\u884c\u4e0a\u8ff0\u64cd\u4f5c\u7684\u67e5\u627e\uff0c\u53ef\u4ee5\u5f97\u8bc1\u6211\u4eec\u67e5\u627e\u7684\u533a\u95f4\u90fd\u662f\u5728\u539f\u6709\u7684\u57fa\u7840\u4e0a\u4f9d\u6b21\u51cf\u5c0f\u7684\uff0c\u56e0\u800c\u4fdd\u8bc1\u4e86\u6b63\u786e\u6027(\u5927\u5bb6\u4e5f\u53ef\u4ee5\u5728\u8349\u7a3f\u7eb8\u4e0a\u753b\u4e00\u753b)\u3002   \n\n\u5224\u65ad\u5728\u4e00\u4e2a\u5e8f\u5217\u7684\u533a\u95f4\u91cc\u6709\u6ca1\u6709\u4e00\u6bb5\u503c\u57df\u91cc\u9762\u7684\u503c\u51fa\u73b0\u8fc7\uff0c\u4e3b\u5e2d\u6811\u4e0d\u7528\u8bf4\u4e86\u5427\uff0c\u4e0d\u8fc7\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u4e00\u4e0b\u7531\u4e8e\u8fd9\u4e2a\u503c\u57df\u6709\u4ebf\u70b9\u5927\uff0c\u4e00\u5b9a\u8981\u5728\u67e5\u8be2\u91cc\u9762\u5224\u65ad\u5f53\u524d\u4f60\u67e5\u7684\u533a\u95f4\u91cc\u9762\u8fd8\u6709\u6ca1\u6709\u539f\u5e8f\u5217\u7684\u6570\u4e0d\u7136\u8981 $T$ \u98de\u2026\u2026    \n\n\u5982\u679c\u8fd8\u4e0d\u7406\u89e3\u7684\u540c\u5b66\u53ef\u4ee5\u518d\u591a\u5728\u8349\u7a3f\u7eb8\u4e0a\u753b\u4e00\u4e0b\u6216\u8005\u770b\u4ee3\u7801:   \n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\nusing namespace std;\nconst int Len = 2e5 + 5 , maxn = 2e5;\nint n,q,rt[Len],cnt,b,x,l,r,top;\nstruct node\n{\n\tint l,r,sum;\n}tree[Len * 23];\nint clone(int p)\n{\n\ttop ++;\n\ttree[top] = tree[p];\n\ttree[top].sum ++;\n\treturn top;\n}\nint build(int p,int l,int r)\n{\n\tp = ++ top;\n\tif(l == r) return p;\t\n\tint mid = (l + r) >> 1;\n\ttree[p].l = build(tree[p].l , l , mid);\n\ttree[p].r = build(tree[p].r , mid + 1 , r);\n\treturn p;\n}\nint update(int p,int l,int r,int wh)\n{\n\tp = clone(p);\n\tif(l == r) return p;\n\tint mid = (l + r) >> 1;\n\tif(wh <= mid) tree[p].l = update(tree[p].l , l , mid , wh);\n\telse tree[p].r = update(tree[p].r , mid + 1 , r , wh);\n\treturn p;\n}\nint query(int l,int r,int nl,int nr,int L,int R)\n{\n\tif(tree[nr].sum - tree[nl].sum == 0) return 0; \n\tif(L <= l && R >= r) return tree[nr].sum - tree[nl].sum;\n\tint mid = (l + r) >> 1 , res = 0;\n\tif(L <= mid) res += query(l , mid , tree[nl].l , tree[nr].l , L , R);\n\tif(R > mid) res += query(mid + 1 , r , tree[nl].r , tree[nr].r , L , R);\n\treturn res; \n} \nint main()\n{\n\tscanf(\"%d %d\",&n,&q);\n\trt[0] = build(0 , 0 , maxn);\n\tfor(int i = 1 ; i <= n ; i ++) \n\t{\n\t\tint x;scanf(\"%d\",&x);\n\t\trt[i] = update(rt[i - 1] , 0 , maxn , x);\n\t}\n\tfor(int i = 1 ; i <= q ; i ++)\n\t{\n\t\tscanf(\"%d %d %d %d\",&b,&x,&l,&r);int ans = 0;\n\t\tfor(int j = 18 ; j >= 0 ; j --)\n\t\t{\n\t\t\tif(b & (1 << j) && !query(0 , maxn , rt[l - 1] , rt[r] , max(0 , ans - x) , min(maxn , ans + (1 << j) - 1 - x))) ans += (1 << j);//\u5982\u679c\u7b54\u6848\u4f4d\u65e0\u6cd5\u4e3a1\u5f53\u524d\u7684aj + x\u7684\u4f4d\u5c31\u53ea\u80fd\u4e3a1 \n\t\t\tif(!(b & (1 << j)) && query(0 , maxn , rt[l - 1] , rt[r] , ans + (1 << j) - x , ans + (1 << (j + 1)) - 1 - x)) ans += (1 << j);//\u5982\u679c\u7b54\u6848\u4f4d\u53ef\u4ee5\u4e3a1\u5f53\u524d\u7684aj + x\u4f4d\u4e3a1 \n\t\t}\n\t\tprintf(\"%d\\n\",ans ^ b);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1607666430,
        "uid": 132533,
        "name": "Hakuoro",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3293 \u3010[SCOI2016]\u7f8e\u5473\u3011"
    },
    {
        "content": "\u770b\u5230\u5f02\u6216\u6700\u5927\uff0c\u7b2c\u4e00\u53cd\u5e94\u662f\u7528 01trie \u505a\u3002\n\n\u4f46\u662f 01trie \u4e0d\u80fd\u5b9e\u73b0\u533a\u95f4\u52a0\u6cd5\uff0c\u6240\u4ee5\u4e0d\u597d\u505a\u3002\n\n\u770b\u56de\u9898\u76ee\uff0c\u4ece\u6700\u7b80\u5355\u7684\u601d\u8def\u53bb\u60f3\uff1a\n\n\u8bbe $ans$ \u80fd\u4f7f\u5f97 $ans\\ \\operatorname{xor}\\ b$ \u6700\u5927\u3002\u6bcf\u6b21\u5c06 $b$ \u4e8c\u8fdb\u5236\u62c6\u5206\uff0c\u8bbe\u4e8c\u8fdb\u5236\u4e0b $b$ \u7684\u7b2c $i$ \u4f4d\u4e3a $b_i$\uff08\u7b2c $0$ \u4f4d\u4e3a\u6700\u4f4e\u4f4d\uff09\uff0c$ans$ \u7684\u7b2c $i$ \u4f4d\u4e3a $ans_i$\u3002\n\n\u7136\u540e\u6211\u4eec\u8d2a\u5fc3\u5730**\u4ece\u9ad8\u4f4d\u5f80\u4f4e\u4f4d**\u8003\u8651\u5982\u4f55\u53d6 $ans$\u3002\u5047\u8bbe\u5f53\u524d\u8003\u8651\u53d6\u7b2c $i$ \u4f4d\uff0c\u524d\u9762\u53d6\u7684\u603b\u548c\u4e3a $sum$\uff08\u5373 $sum=\\sum_{j>i}ans_j\\times 2^j$\uff09\u3002\u663e\u7136\uff0c$ans_i$ \u53d6 $b_i\\operatorname{xor}1$ \u6700\u4f18\u3002\n\n\u4f46\u662f\u8fd9\u6837\u53d6\u53ef\u80fd\u5bfc\u81f4\u6211\u4eec\u65e0\u6cd5\u627e\u5230\u4e00\u4e2a\u5408\u6cd5\u7684 $a_i+x=ans$\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u5f53 $ans_i$ \u53d6 $b_i\\operatorname{xor}1$ \u65f6\uff0c$ans$ \u7684\u53d6\u503c\u4f1a\u5728\u54ea\u4e2a\u8303\u56f4\u3002\n\n\u6613\u5f97\u6b64\u65f6 $ans\\in [sum+(b_i\\operatorname{xor}1)\\times2^i,sum+(b_i\\operatorname{xor}1)\\times2^{i}+2^i-1]$\u3002\n\n\u90a3\u4e48\u5bf9\u5e94\u5408\u6cd5\u7684 $a_i=ans-x$ \u7684\u53d6\u503c\u8303\u56f4\u4e5f\u5c31\u51fa\u6765\u4e86\uff1a\n\n$a_i\\in[sum+(b_i\\operatorname{xor}1)\\times2^i-x,sum+(b_i\\operatorname{xor}1)\\times2^{i}+2^i-1-x]$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ea\u7528\u627e\u5230\u662f\u5426\u5b58\u5728\u8fd9\u4e48\u4e00\u4e2a $a_i$ \u5728\u8fd9\u4e2a\u8303\u56f4\u91cc\u5c31\u597d\u4e86\u3002\u5982\u679c\u5b58\u5728\uff0c$ans_i$ \u5c31\u80fd\u53d6 $b_i\\operatorname{xor}1$\uff0c\u5426\u5219\u53ea\u80fd\u53d6 $b_i$\u3002\n\n\u6211\u4eec\u518d\u770b\u4e00\u4e0b\u73b0\u5728\u8981\u7ef4\u62a4\u7684\u4e1c\u897f\uff1a$m\\log (10^5)$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u7ed9\u51fa\u4e24\u4e2a\u533a\u95f4 $[l,r]$ \u548c $[v_1,v_2]$\uff0c\u95ee\u662f\u5426\u5b58\u5728 $a_i\\in[v_1,v_2]$\uff08$l\\leq i\\leq r$\uff09\u3002\n\n\u8fd9\u79cd\u5f62\u5f0f\u5c31\u5f88\u719f\u6089\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u53ef\u6301\u4e45\u5316\u6743\u503c\u7ebf\u6bb5\u6811\u6765\u7ef4\u62a4\u8fd9\u4e2a\u4e1c\u897f\u3002\n\n\u4ee3\u7801\u4e2d\u7684\u7ec6\u8282\u8fd8\u662f\u633a\u591a\u7684\uff0c\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n\n#define LN 18\n#define N 200010\n#define lc(u) t[u].ch[0]\n#define rc(u) t[u].ch[1]\n\nusing namespace std;\n\nstruct Segment_Tree\n{\n\tint ch[2],size;\n}t[(N<<2)+N*LN];//\u4e3b\u5e2d\u6570\u7a7a\u95f4\uff1a4n+nlogn\n\nint n,m,a[N];\nint node,root[N];\n\nvoid build(int &u,int l,int r)\n{\n\tu=++node;\n\tif(l==r) return;\n\tint mid=(l+r)>>1;\n\tbuild(lc(u),l,mid);\n\tbuild(rc(u),mid+1,r);\n}\n\nvoid insert(int &u,int last,int l,int r,int x)\n{\n\tu=++node;\n\tt[u]=t[last];\n\tt[u].size++;\n\tif(l==r) return;\n\tint mid=(l+r)>>1;\n\tif(x<=mid) insert(lc(u),lc(last),l,mid,x);\n\telse insert(rc(u),rc(last),mid+1,r,x);\n}\n\nbool query(int a,int b,int l,int r,int ql,int qr)\n{\n\tif(ql<=l&&r<=qr) return t[b].size-t[a].size;//\u5982\u679c\u4e24\u6b21query\u5206\u522b\u6c42\u4e24\u68f5\u6811\u7684size\u518d\u76f8\u51cf\u5224\u65ad\u7684\u8bdd\u53ef\u80fd\u4f1aTLE\uff0c\u6240\u4ee5\u76f4\u63a5\u4e00\u6b21query\u5224\u65ad\n\tint mid=(l+r)>>1;\n\tbool flag=false;\n\tif(ql<=mid) flag|=query(lc(a),lc(b),l,mid,ql,qr);\n\tif(qr>mid) flag|=query(rc(a),rc(b),mid+1,r,ql,qr);\n\treturn flag;\n}\n\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\tbuild(root[0],0,1e5);//\u6811\u7684\u533a\u95f4\u4e0d\u662f1\u5230n\uff0c\u800c\u662f0\u523010^5\uff0c\u56e0\u4e3a\u8fd9\u662f\u6743\u503c\u7ebf\u6bb5\u6811\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&a[i]);\n\t\tinsert(root[i],root[i-1],0,1e5,a[i]);\n\t}\n\twhile(m--)\n\t{\n\t\tint b,x,l,r;\n\t\tscanf(\"%d%d%d%d\",&b,&x,&l,&r);\n\t\tint sum=0;\n\t\tfor(int i=17;i>=0;i--)//i\u8981\u4ece17\u5f00\u59cb\u679a\u4e3e\uff0c\u5426\u5219\u4f1aWA\uff0c\u56e0\u4e3a 2^16<=max ai<=2^17\n\t\t{\n\t\t\tint tmp=(b>>i)&1;\n\t\t\ttmp^=1;\n\t\t\tint minn,maxn;\n\t\t\tif(tmp)\n\t\t\t{\n\t\t\t\tminn=sum+(1<<i);\n\t\t\t\tmaxn=sum+(1<<(i+1))-1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tminn=sum;\n\t\t\t\tmaxn=sum+(1<<i)-1;\n\t\t\t}\n\t\t\tminn-=x;\n\t\t\tmaxn-=x;//\u6c42\u51faai\u7684\u8303\u56f4\n\t\t\tbool flag=true;\n\t\t\tif(maxn<0) flag=false;//\u7279\u5224\u53f3\u7aef\u70b9\u5c0f\u4e8e0 \n\t\t\telse if(minn>1e5) flag=false;//\u7279\u5224\u5de6\u7aef\u70b9\u5927\u4e8e10^5\n\t\t\telse flag=query(root[l-1],root[r],0,1e5,max(minn,0),min(maxn,(int)1e5));//\u8bb0\u5f97\u53d6max\u3001min\n\t\t\tif(flag) sum+=tmp*(1<<i);\n\t\t\telse sum+=(tmp^1)*(1<<i);\n\t\t}\n\t\tprintf(\"%d\\n\",sum^b);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1597915250,
        "uid": 118318,
        "name": "ez_lcw",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3293 \u3010[SCOI2016]\u7f8e\u5473\u3011"
    },
    {
        "content": "\u56e0\u4e3a\u6211\u60f3\u4e86\u597d\u4e45\u8fd9\u4e2a\u9b3c\u503c\u57df\u662f\u600e\u4e48\u5212\u5206\u7684\uff0c\u6240\u4ee5\u6765\u53d1\u4e00\u4e2a\u76f4\u89c2\u4e00\u70b9\u7684\u7406\u89e3\n\n\u8003\u8651\u6bcf\u6b21\u5bf9$b$\u548c$d$\u6c42$c=d \\ xor \\ (a+b)$\u7684\u6700\u5927\u503c\uff0c\u56e0\u4e3a\u5f02\u6216\u6bcf\u4e00\u4f4d\u662f\u72ec\u7acb\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u6309\u4f4d\u8d2a\u5fc3\u3002\n\n\u5982\u679c\u8981\u6c42$c$\u7684\u4ece\u4f4e\u5230\u9ad8\u7b2c$i$\u4f4d\u4e3a$0$(\u6700\u4f4e\u4f4d\u4e3a\u7b2c$0$\u4f4d)\uff0c\u90a3\u4e48\u6b64\u65f6$c$\u7684\u66f4\u9ad8\u4f4d\u662f\u786e\u5b9a\u597d\u7684\u4e86\n\n$$\\begin{aligned}\\_\\_\\_\\_\\_\\_\\_ 01111111\\\\ \\_\\_\\_\\_\\_\\_\\_00000000\\end{aligned}$$\n\n\u8fd9\u662f$c$\u7684\u4e0a\u754c\u548c\u4e0b\u754c\uff0c\u5206\u522b\u51cf\u53bb$b$\u540e\uff0c\u5f97\u5230$a$\u9700\u8981\u6ee1\u8db3\u7684\u533a\u95f4\uff0c\u7136\u540e\u5728\u539f\u4f4d\u7f6e\u533a\u95f4\u91cc\u9762\u67e5\u8be2$a$\u9700\u8981\u6ee1\u8db3\u7684\u503c\u57df\u533a\u95f4\uff0c\u76f4\u63a5\u4e3b\u5e2d\u6811\u5373\u53ef\n\n\u7136\u540e\u5982\u679c\u8981\u6c42\u6b64\u4f4d\u4e3a$1$\n\n$$\\begin{aligned}\\_\\_\\_\\_\\_\\_\\_11111111\\\\\\_\\_\\_\\_\\_\\_\\_10000000\\end{aligned}$$\n\n\u53ef\u4ee5\u770b\u51fa\u521a\u597d\u662f\u628a\u503c\u57df\u5206\u5b8c\u4e86\u7684\uff0c\u6240\u4ee5\u8fd9\u6837\u662f\u5bf9\u7684",
        "postTime": 1551777148,
        "uid": 63727,
        "name": "ButterflyDew",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3293 \u3010[SCOI2016]\u7f8e\u5473\u3011"
    },
    {
        "content": "\u53ef\u4ee5\u5229\u7528\u4e8c\u5206\u7684\u601d\u60f3\uff0c\u5177\u4f53\u6b65\u9aa4\uff0c\u5c31\u662f**\u4ece\u9ad8\u5230\u4f4e**\u786e\u5b9a\u6bcf\u4e00\u4e2a\u4e8c\u8fdb\u5236\u4f4d\u7684\u6570\u503c\u3002\n\n\u53ef\u4ee5\u770b\u51fa\uff0c\u5982\u679c\u5f53\u524d\u5df2\u7ecf\u786e\u5b9a\u4e86\u524d\u51e0\u4f4d\uff0c\u90a3\u4e48\u8fd9\u4e2a\u89e3\u7684\u8303\u56f4\u4e00\u5b9a\u662f\u4e00\u4e2a\u8fde\u7eed\u7684\u533a\u95f4\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5047\u8bbe\u521d\u59cb\u89e3\u7684\u679a\u4e3e\u8303\u56f4\u662f$[0,262143]$\uff08\u5373$18$\u4f4d\u4e8c\u8fdb\u5236\u6570\uff09\uff0c\u5982\u679c\u5f53\u524d\u5df2\u7ecf\u786e\u5b9a\u4e86\u7b2c$18,17,16$\u4f4d\u5206\u522b\u4e3a$1,0,1$\uff0c\u90a3\u4e48\u8fd9\u65f6\u5019\u89e3\u7684\u8303\u56f4\u5c31\u662f$[163840,196607]$\u3002\n\n\u8bbe\u5f53\u524d\u89e3\u7684\u8303\u56f4\u662f$[s,t]$\uff0c\u7b2c$i+1$\u4f4d\u5230\u7b2c$18$\u4f4d\u5df2\u7ecf\u88ab\u786e\u5b9a\uff0c\u73b0\u5728\u8003\u8651\u600e\u6837\u786e\u5b9a\u7b2c$i$\u4f4d\uff0c\u4e5f\u5c31\u662f\u8bf4\u5224\u65ad\u8981\u628a\u89e3\u7684\u8303\u56f4\u7f29\u5c0f\u4e3a$[s,\\frac{s+t}{2}]$\u8fd8\u662f\u7f29\u5c0f\u4e3a$[\\frac{s+t}{2}+1,t]$\u3002\u7531\u4e8e\u8981\u53d6\u6700\u5927\u503c\uff0c\u6240\u4ee5\u5148\u5c1d\u8bd5\u53ef\u5426\u628a\u89e3\u7684\u8303\u56f4\u7f29\u5c0f\u5230$[\\frac{s+t}{2}+1,t]$\uff0c\u4e0b\u9762\u4ee4$L=\\frac{s+t}{2}+1,R=t$\u3002\n\n\u7136\u540e\u53ef\u4ee5\u7ee7\u7eed\u53d1\u73b0\uff0c$[L,R]$\u5185\u7684\u6570\u88ab$\\mbox{xor}$\u4e0a$b$\u4e4b\u540e\u5f97\u5230\u7684\u503c\u57df\uff0c\u4ecd\u7136\u662f\u4e00\u6bb5\u8fde\u7eed\u7684\u533a\u95f4\u3002\u8fd9\u65f6\u5019\uff0c\u7531\u4e8e$a\\mbox{ xor }b=c$\u65f6\u4e00\u5b9a\u6709$a\\mbox{ xor }c=b$\uff0c\u6240\u4ee5\u5c06$L$\u548c$R$\u7684**\u7b2c$i$\u4f4d\u5230\u7b2c$18$\u4f4d**\u5206\u522b\u4e0e$b$\u7684**\u7b2c$i$\u4f4d\u5230\u7b2c$18$\u4f4d**\u8fdb\u884c\u5f02\u6216\uff0c\u5c31\u80fd\u5f97\u5230\u4e00\u4e2a\u65b0\u7684\u533a\u95f4$[u,v]$\uff0c\u4e5f\u5c31\u662f\u8bf4$[u,v]$\u91cc\u7684\u6570\u88ab$\\mbox{xor}$\u4e0a$b$\u4e4b\u540e\u5f97\u5230\u7684\u503c\u57df\u4e3a$[L,R]$\u3002\n\n\u53ef\u4ee5\u5f97\u51fa\uff1a\n\n$u=\\lfloor\\frac{L\\mbox{ xor }b}{2^{i-1}}\\rfloor*2^{i-1}$\n\n$v=\\lfloor\\frac{R\\mbox{ xor }b}{2^{i-1}}\\rfloor*2^{i-1}+2^{i-1}-1$\n\n\u8fd9\u65f6\u5019\u5c31\u53ef\u4ee5\u770b\u51fa\uff0c\u6240\u6709\u7f8e\u5473\u5ea6\u4e3a$[L,R]$\u7684\u83dc\uff0c\u90fd\u662f\u8bc4\u4ef7\u503c\u5728\u533a\u95f4$[u-x,v-x]$\u5185\u7684\u83dc\u3002\u5982\u679c\u5728\u7ed9\u5b9a\u7684\u53ef\u9009\u62e9\u83dc\u54c1\u533a\u95f4\u5185\uff0c\u5b58\u5728\u4e00\u9053\u83dc\u7684\u8bc4\u4ef7\u503c\u5728\u533a\u95f4$[u-x,v-x]$\u5185\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u628a\u7b54\u6848\u533a\u95f4\u8c03\u6574\u4e3a$[\\frac{s+t}{2}+1,t]$\uff0c\u5426\u5219\u8c03\u6574\u4e3a$[s,\\frac{s+t}{2}]$\u3002\n\n\u5bf9\u4e8e\u8be2\u95ee\u4e00\u4e2a\u53ef\u9009\u62e9\u83dc\u54c1\u533a\u95f4\u5185\u8bc4\u4ef7\u503c\u5728\u533a\u95f4$[u-x,v-x]$\u5185\u7684\u83dc\u7684\u4e2a\u6570\uff0c\u53ef\u4ee5\u7528\u6811\u72b6\u6570\u7ec4\u79bb\u7ebf\u8be2\u95ee\u3002\u4f46\u662f\u7531\u4e8e\u8be2\u95ee\u4e4b\u95f4\u6709\u8054\u7cfb\uff0c\u6240\u4ee5\u7528\u4e3b\u5e2d\u6811\u4ee3\u66ff\u6811\u72b6\u6570\u7ec4\uff0c\u4ee5\u8fbe\u5230\u5728\u7ebf\u67e5\u8be2\u7684\u76ee\u7684\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\ninline int read() {\n    int res = 0; bool bo = 0; char c;\n    while (((c = getchar()) < '0' || c > '9') && c != '-');\n    if (c == '-') bo = 1; else res = c - 48;\n    while ((c = getchar()) >= '0' && c <= '9')\n        res = (res << 3) + (res << 1) + (c - 48);\n    return bo ? ~res + 1 : res;\n}\nconst int N = 2e5 + 5, NLogN = 7e6 + 5;\nstruct cyx {\n    int lc, rc, cnt;\n} T[NLogN];\nint n, m, a[N], QAQ, rt[N];\nvoid ins(int y, int &x, int l, int r, int p) {\n    T[x = ++QAQ] = T[y]; T[x].cnt++; int mid = l + r >> 1;\n    if (l == r) return; if (p <= mid) ins(T[y].lc, T[x].lc, l, mid, p);\n    else ins(T[y].rc, T[x].rc, mid + 1, r, p);\n}\nint query(int l, int r, int s, int e, int p1, int p2) {\n    if (l == s && r == e) return T[p2].cnt - T[p1].cnt;\n    int mid = l + r >> 1;\n    if (e <= mid) return query(l, mid, s, e, T[p1].lc, T[p2].lc);\n    else if (s >= mid + 1) return query(mid + 1, r, s, e, T[p1].rc, T[p2].rc);\n    else return query(l, mid, s, mid, T[p1].lc, T[p2].lc) +\n        query(mid + 1, r, mid + 1, e, T[p1].rc, T[p2].rc);\n}\nvoid init() {\n    int i; for (i = 1; i <= n; i++)\n        ins(rt[i - 1], rt[i], 0, 131071, a[i]);\n}\nint main() {\n    int i, b, x, l, r, ans; n = read(); m = read();\n    for (i = 1; i <= n; i++) a[i] = read(); init();\n    while (m--) {\n        b = read(); x = read(); l = read(); r = read();\n        ans = 0; for (i = 17; i >= 0; i--) {\n            int tl = ans | (1 << i), tr = tl + (1 << i) - 1;\n            tl ^= b; tr ^= b; tl = (tl >> i) << i; tr = (tr >> i) << i;\n            tr += (1 << i) - 1; tl -= x; tr -= x;\n            if (tr < 0 || tl > 131071) continue;\n            if (tl < 0) tl = 0; if (tr > 131071) tr = 131071;\n            if (query(0, 131071, tl, tr, rt[l - 1], rt[r]))\n                ans = ans | (1 << i);\n        }\n        printf(\"%d\\n\", ans);\n    }\n    return 0;\n}\n```",
        "postTime": 1512298923,
        "uid": 29936,
        "name": "xyz32768",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3293 \u3010[SCOI2016]\u7f8e\u5473\u3011"
    },
    {
        "content": "\u9898\u610f:https://www.luogu.org/problem/P3293\n\n\u770b\u89c1\u4f4d\u8fd0\u7b97\u5fc5\u7136\u4f1a\u60f3\u5230\u6309\u4f4d\u8d2a\u5fc3\n\n\u8981\u6c42$b_iXOR(a_j+x_i)$\u6700\u5927,\u90a3\u4e48\u7531\u4e8e$x_i$\u548c$b_i$\u56fa\u5b9a,\u53ea\u9700\u8981\u627e$a_j$\u5373\u53ef\n\n\u8003\u8651\u5f53\u671f\u627e\u5230\u7684$a_j+x$\u4e3aans,\u8003\u8651\u5230\u4e86$b_i$\u7684k\u4f4d\n\n\u5047\u8bbe$b_i$\u7684\u8fd9\u4e00\u4f4d\u4e3a0,\u90a3\u4e48\u6211\u4eec\u8981\u627e\u7684$a_j+x_i$\u7684\u7b2ck\u4f4d\u5e94\u8be5\u5c3d\u53ef\u80fd\u4e3a1,\u4e8e\u662f$a_j+x_i$\u7684\u8303\u56f4\u5c31\u662f$[ans+2^k,ans+2^{k+1}-1]$\n\n\u5047\u8bbe$b_i$\u7684\u8fd9\u4e00\u4f4d\u4e3a1,\u90a3\u4e48\u6211\u4eec\u8981\u627e\u7684$a_j+x_i$\u7684\u7b2ck\u4f4d\u5e94\u8be5\u5c3d\u53ef\u80fd\u4e3a0,\u4e8e\u662f$a_j+x_i$\u7684\u8303\u56f4\u5c31\u662f$[ans,ans+2^k]$\n\n\u7531\u4e8e\u662f\u533a\u95f4\u67e5\u8be2,\u7528\u4e3b\u5e2d\u6811\u5373\u53ef\n\n\u6ce8\u610f\u8fd9\u53e5\u8bdd\uff1a\n```\nif(R<l||L>r||sum(p)-sum(pre)<=0)return 0;\n```\n$ans+2^k$\u662f\u5f88\u53ef\u80fd\u8d85\u8fc7maxm\u7684,\u4e0d\u52a0\u8fd9\u53e5\u4f1a\u4f7f\u4f60RE\n\ncode\uff1a\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define lc(p) (seg[p].lc)\n#define rc(p) (seg[p].rc)\n#define sum(p) (seg[p].sum)\nconst int maxn=2*1e5+10;\nconst int maxm=1e5+10;\nint n,m,num,tot;\nint a[maxn],root[maxn];\nstruct Seg\n{\n    int lc,rc;\n    int sum;\n}seg[maxn*50];\ninline void up(int p){sum(p)=sum(lc(p))+sum(rc(p));}\nvoid insert(int pre,int &p,int l,int r,int pos)\n{\n    p=++tot;\n    sum(p)=sum(pre)+1;\n    if(l==r)return;\n    int mid=(l+r)>>1;\n    if(pos<=mid)insert(lc(pre),lc(p),l,mid,pos),rc(p)=rc(pre);\n    else insert(rc(pre),rc(p),mid+1,r,pos),lc(p)=lc(pre);\n    up(p);\n}\nint query(int pre,int p,int L,int R,int l,int r)\n{\n    /*printf(\"%d %d %d %d\\n\",L,R,l,r);\n    getchar();*/\n    if(R<l||L>r||sum(p)-sum(pre)<=0)return 0;\n    if(L>=l&&R<=r)return sum(p)-sum(pre);\n    int mid=(L+R)>>1,ans=0;\n    if(l<=mid)ans+=query(lc(pre),lc(p),L,mid,l,r);\n    if(r>mid)ans+=query(rc(pre),rc(p),mid+1,R,l,r);\n    return ans;\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=n;i++)scanf(\"%d\",&a[i]);\n    for(int i=1;i<=n;i++)insert(root[i-1],root[i],0,maxm,a[i]);\n    //printf(\"test::%d\\n\",query(root[0],root[4],0,maxm,1,4));\n    for(int i=1;i<=m;i++)\n    {\n        int b,x,l,r,ans=0;\n        scanf(\"%d%d%d%d\",&b,&x,&l,&r);\n        for(int j=18;~j;j--)\n        {\n            if(b&(1<<j)&&!query(root[l-1],root[r],0,maxm,ans-x,ans+(1<<j)-1-x))ans+=1<<j;\n            if(!(b&(1<<j))&&query(root[l-1],root[r],0,maxm,ans+(1<<j)-x,ans+(1<<(j+1))-1-x))ans+=1<<j; \n        }\n        printf(\"%d\\n\",ans^b);\n    }\n    return 0;\n}\n```\n",
        "postTime": 1568546238,
        "uid": 145441,
        "name": "nofind",
        "ccfLevel": 6,
        "title": "P3293 [SCOI2016]\u7f8e\u5473(\u4e3b\u5e2d\u6811)"
    }
]
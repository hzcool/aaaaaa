[
    {
        "content": "[\u795e\u79d8\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/LittleTwoawa/p/17110546.html)\n\n[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/P9039)\n\n\u9996\u5148\u6709\u4e09\u79cd\u60c5\u51b5\u662f\u5e73\u51e1\u7684\uff1a\n\n1. \u8d77\u59cb\u548c\u7ec8\u6b62\u76f8\u540c\uff0c\u663e\u7136\u6709\u89e3\n2. \u8d77\u59cb\u4e2d\u53ea\u6709\u4e00\u79cd\u989c\u8272\u5e76\u4e14\u7ec8\u6b62\u548c\u8d77\u59cb\u5e76\u4e0d\u76f8\u540c\uff0c\u663e\u7136\u65e0\u89e3\n3. \u8003\u8651\u6700\u540e\u4e00\u6b65\uff0c\u4e00\u5b9a\u662f\u5c06\u67d0\u4e00\u6761\u8fb9\u4e0a\u7684\u4e00\u4e2a\u70b9\u6539\u6210\u53e6\u4e00\u4e2a\u70b9\u7684\u989c\u8272\uff0c\u6240\u4ee5\u7ec8\u6b62\u7684\u989c\u8272\u5e8f\u5217\u4e2d\u5fc5\u5b9a\u6709\u4e00\u6761\u8fb9\u4e0a\u7684\u4e24\u4e2a\u70b9\u989c\u8272\u76f8\u540c\uff0c\u5373\u5fc5\u6709 $(x,y) \\in G$ \u4e14 $col_x=col_y$\uff0c\u5426\u5219\u65e0\u89e3\u3002\n\n\u589e\u5927\u9650\u5236\uff0c\u5982\u679c\u653e\u5728\u94fe\u4e0a\u8fd9\u4e2a\u4e1c\u897f\u600e\u4e48\u5224\u65ad\u3002\u94fe\u4e0a\u7684\u989c\u8272\u4e00\u5b9a\u5f62\u5982 $\\text{BRBRBR}$ \u6216\u8005 $\\text{RBRBRB}$\u3002\u6240\u4ee5\u5982\u679c\u8d77\u59cb\u7684\u8fde\u7eed\u989c\u8272\u6bb5\u6570**\u4e0d\u5c11\u4e8e**\u7ec8\u6b62\u7684\u8fde\u7eed\u989c\u8272\u6bb5\u6570\uff0c\u6ce8\u610f\u5230\u7ec8\u6b62\u72b6\u6001\u4e2d\u7684\u4e00\u4e2a\u989c\u8272\u6bb5\u81f3\u5c11\u53ef\u4ee5\u5bf9\u5e94\u4e0a\u8d77\u59cb\u72b6\u6001\u4e2d\u7684\u4e00\u4e2a\u989c\u8272\u6bb5\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u4e0d\u65ad\u632a\u52a8\u6765\u5f97\u5230\u89e3\u3002\u7279\u522b\u7684\uff0c\u5982\u679c\u5728\u94fe\u7684\u5f00\u5934\u8d77\u59cb\u548c\u7ec8\u6b62\u989c\u8272\u4e0d\u540c\uff0c\u90a3\u4e48\u8d77\u59cb\u5c31\u8981\u5c11\u7b97\u4e00\u4e2a\u8fde\u7eed\u6bb5\uff0c\u539f\u56e0\u662f\u6211\u4eec\u7684\u989c\u8272\u6bb5\u53ea\u80fd\u4f38\u5c55\uff0c\u4e0d\u80fd\u4ea4\u6362\u987a\u5e8f\u6216\u8005\u5206\u88c2\u5f00\u5728\u4e2d\u95f4\u63d2\u5165\u65b0\u7684\u989c\u8272\u3002\n\n\u505a\u5b8c\u4e86\u94fe\u5269\u4e0b\u7684\u4e00\u5b9a\u662f\u4e00\u68f5\u591a\u53c9\u6811\u3002\n\n![graph.png](https://s2.loli.net/2023/02/12/X6noKhQAetLNSGr.png)\n\n\u663e\u7136\uff0c\u6837\u4f8b\u4e2d\u7684\u60c5\u51b5\u662f\u5148\u7528 $2$ \u628a $3,4$ \u67d3\u7ea2\uff0c\u7136\u540e\u7528 $1$ \u628a $2$ \u67d3\u767d\u3002\n\n\u4e5f\u4e0d\u96be\u53d1\u73b0\uff0c\u5bf9\u4e8e\u56db\u4e2a\u70b9\u6765\u8bf4\uff0c\u53ea\u8981\u6709\u4e00\u4e2a\u70b9\u5ea6\u6570\u4e3a $3$ \u5c31\u5fc5\u5b9a\u6709\u89e3\uff0c\u8bc1\u660e\u5982\u4e0b\uff1a\n\n1. \u8bbe\u6709\u8fd9\u4e48\u4e00\u4e2a\u56db\u70b9\u4e09\u8fb9\u7684\u7ed3\u6784 $(x,a)$\uff0c$(x,b)$\uff0c$(x,c)$\uff0c\u5176\u4e2d $col_x=0$ \u6211\u4eec\u8981\u4f7f\u5f97\u7ec8\u6b62\u72b6\u6001\u4e3a $col_a=0,col_b=col_c=1$\n2. \u5982\u679c\u521d\u59cb\u7ec8\u6b62\u72b6\u6001\u76f8\u540c\uff0c\u81ea\u7136\u6709\u89e3\n3. \u5982\u679c $col_a=col_b=col_c=1$\uff0c\u64cd\u4f5c $x \\to a$ \u5373\u53ef\n4. \u5982\u679c $col_a=col_b=0,col_c=1$\uff0c\u64cd\u4f5c $c \\to x$\uff0c$x \\to b$\uff0c$a \\to x$ \u5373\u53ef\n5. \u5982\u679c $col_a=col_b=col_c=0$\uff0c\u56e0\u4e3a\u6211\u4eec\u4fdd\u8bc1\u4e86\u8981\u5148\u6ee1\u8db3\u6811\u4e0a\u5fc5\u5b9a\u6709\u4e24\u79cd\u989c\u8272\uff0c\u5426\u5219\u4e00\u5b9a\u65e0\u89e3\uff0c\u6240\u4ee5\u5148\u968f\u4fbf\u5728\u5916\u5934\u627e\u4e00\u4e2a $col_i=1$ \u7684\u70b9 $i$\uff0c\u7136\u540e\u4e00\u8def\u67d3\u8fc7\u6765\u4f7f\u5f97 $col_x=1$\uff0c\u5982\u679c\u8fd9\u671f\u95f4\u4f7f\u5f97\u72b6\u6001\u53d8\u6210\u4e86 $col_x=col_a=1$\uff0c\u90a3\u4e48\u64cd\u4f5c $x \\to b$\uff0c$c \\to x$\uff0c$x \\to a$\uff0c$b \\to x$ $x \\to c$ $a \\to x$\u3002\u5982\u679c $col_a=0$ \u90a3\u4e48\u5c31\u5148\u628a $col_x$ \u53d8\u6210 $1$\uff0c\u67d3\u5b8c $b,c$ \u540e\u518d\u7528 $a$ \u628a $x$ \u67d3\u56de\u6765\n6. \u5bf9\u4e8e $col_x=1$ \u4e5f\u662f\u4e00\u6837\u7684\u5206\u8ba8\u64cd\u4f5c\n\n\u4ece\u4e0a\u9762\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u53ea\u8981\u6211\u4eec\u6700\u540e\u80fd\u628a\u6811\u8f6c\u5316\u6210\u4e0a\u9762\u7684\u7ed3\u6784\uff0c\u90a3\u4e48\u901a\u8fc7\u8c03\u6574\u989c\u8272\u5c31\u4e00\u5b9a\u80fd\u591f\u5f97\u5230\u89e3\u3002\u5927\u80c6\u731c\u60f3\uff0c\u53ea\u8981\u6811\u4e2d\u6709\u70b9\u5ea6\u6570\u4e3a $3$ \u5c31\u5fc5\u5b9a\u6709\u89e3\uff0c\u8bc1\u660e\u5982\u4e0b\uff1a\n\n1. \u4ece\u4e09\u53c9\u6811\u5f00\u59cb\u8003\u8651\uff0c\u4e0d\u59a8\u5c06\u5ea6\u6570\u4e3a $3$ \u7684 $x$ \u8bb0\u4e3a\u6839\u3002\u6211\u4eec\u9996\u5148\u5904\u7406 $a$ \u4e0b\u9762\u7684\u94fe\u3002\u5728 $b$ \u8282\u70b9\u4e0a\u5b58\u4e00\u4e2a\u7ea2\uff0c\u5728 $c$ \u8282\u70b9\u4e0a\u5b58\u4e00\u4e2a\u9ed1\uff0c\u90a3\u4e48\u6b64\u65f6 $x$ \u5c31\u53ef\u4ee5\u770b\u4f5c\u4e00\u4e2a\u53ef\u4ee5\u53d8\u8272\u7684\u94fe\u5934\uff0c\u7528\u7c7b\u4f3c\u4e8e\u5904\u7406\u94fe\u7684\u65b9\u5f0f\u5c06 $a$ \u7684\u94fe\u67d3\u5408\u6cd5\u3002\n2. \u6b64\u65f6\u518d\u5c06 $a$ \u4f5c\u4e3a\u50a8\u5b58\u70b9\uff0c\u7528\u76f8\u540c\u7684\u9053\u7406\u7ee7\u7eed\u5904\u7406 $b$ \u7684\u94fe\u548c $c$ \u7684\u94fe\u3002\n3. \u53ef\u4ee5\u53d1\u73b0\u5f53\u6bcf\u6761\u94fe\u90fd\u5408\u6cd5\u540e\uff0c\u6211\u4eec\u6210\u529f\u8f6c\u5316\u51fa\u4e86\u4e0a\u9762\u7684\u7ed3\u6784\uff0c\u5269\u4e0b\u7684\u5c31\u662f\u56db\u4e2a\u70b9\u4e4b\u95f4\u7684\u8f6c\u5316\uff0c\u8fd9\u4e2a\u662f\u597d\u505a\u7684\u3002\n4. \u5bf9\u4e8e\u591a\u53c9\u7684\u63a8\u5e7f\u60c5\u51b5\u662f\u76f8\u540c\u7684\u3002\n\n\u4e8e\u662f\u8fd9\u9053\u9898\u5c31\u505a\u5b8c\u4e86\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5224\u65ad\u662f\u5426\u7b26\u5408\u4e0a\u9762\u51e0\u4e2a\u60c5\u51b5\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n)$\uff0c\u74f6\u9888\u5728\u4e8e\u627e\u94fe\u7684\u8fde\u7eed\u989c\u8272\u6bb5\u6570\u91cf\u7684\u904d\u5386\uff0c\u6ce8\u610f\u5224\u65ad\u7b54\u6848\u7684\u987a\u5e8f\u3002\n\n```\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\n\ninline int read()\n{\n\tint s=0,w=1;\n\tchar c=getchar();\n\twhile(!isdigit(c)) {if(c=='-') w=-1; c=getchar();}\n\twhile(isdigit(c)) s=(s<<1)+(s<<3)+(c^48),c=getchar();\n\treturn s*w;\n}\ninline void READ(char *s)\n{\n\tint num=0;\n\tchar c=getchar();\n\twhile(c!='0'&&c!='1') c=getchar();\n\twhile(c=='0'||c=='1') s[++num]=c,c=getchar();\n\treturn;\n}\n\nnamespace LgxTpre\n{\n\tstatic const int MAX=200010;\n\tstatic const int INF=4557430888798830399;\n\tstatic const int mod=998244353;\n\t\n\tint T,n;\n\tint x,y;\n\tchar s1[MAX],s2[MAX];\n\n\tstruct edge\n\t{\n\t\tint nex,to;\n\t}e[MAX<<1];\n\tint head[MAX],cnt;\n\tinline void add(int x,int y)\n\t{\n\t\te[++cnt].nex=head[x];\n\t\thead[x]=cnt;\n\t\te[cnt].to=y;\n\t\treturn;\n\t}\n\n\tint deg[MAX];\n\tint num1,num2;\n\tvoid dfs(int now,int father)\n\t{\n\t\tif(s1[now]!=s1[father]) ++num1;\n\t\tif(s2[now]!=s2[father]) ++num2;\n\t\tfor(int i=head[now];i;i=e[i].nex)\n\t\t{\n\t\t\tint to=e[i].to;\n\t\t\tif(to!=father) dfs(to,now);\n\t\t}\n\t\treturn;\n\t}\n\tinline void init()\n\t{\n\t\tfor(int i=1;i<=n;++i)\n\t\t\thead[i]=deg[i]=0;\n\t\tcnt=num1=num2=1;\n\t\treturn;\n\t}\n\t\t\n\tinline void lmy_forever()\n\t{\n\t\tT=read(); \n\t\twhile(T--)\n\t\t{\n\t\t\tinit();\n\t\t\tn=read(),READ(s1),READ(s2);\n\t\t\tint flag1=1,flag2=0,flag3=1,flag4=1,s;\n\t\t\tfor(int i=1;i<n;++i)\n\t\t\t{\n\t\t\t\tx=read(),y=read(),\n\t\t\t\t++deg[x],++deg[y],\n\t\t\t\tadd(x,y),add(y,x);\n\t\t\t\tif(s2[x]==s2[y]) flag3=0;\n\t\t\t}\n\t\t\tfor(int i=1;i<=n;++i)\n\t\t\t{\n\t\t\t\tif(s1[i]!=s1[i-1]&&i!=1) flag1=0;\n\t\t\t\tif(deg[i]>=3) flag2=1;\n\t\t\t\tif(s1[i]!=s2[i]) flag4=0;\n\t\t\t\tif(deg[i]==1) s=i;\n\t\t\t}\n\t\t\tif(flag4)        {printf(\"TAK\\n\"); continue;}\n\t\t\tif(flag1||flag3) {printf(\"NIE\\n\"); continue;}\n\t\t\tif(flag2) {printf(\"TAK\\n\"); continue;}\n\t\t\tdfs(s,s);\n\t\t\tif(s1[s]!=s2[s]) --num1;\n\t\t\tif(num1<num2) printf(\"NIE\\n\");\n\t\t\telse printf(\"TAK\\n\");\n\t\t}\n\t\treturn;\n\t}\n}\n\nsigned main()\n{\n\tLgxTpre::lmy_forever();\n\treturn (0-0);\t\n}\n```",
        "postTime": 1676219129,
        "uid": 739297,
        "name": "forqprever",
        "ccfLevel": 0,
        "title": "\u9898\u89e3\uff1a\u3010PA2021\u3011 Drzewo czerwono-czarne"
    }
]
[
    {
        "content": "[\u539f\u9898\u94fe\u63a5](https://www.luogu.com.cn/problem/P8570)\n\n> \u9898\u610f\uff1a  \u7ed9\u5b9a $n,m\\leq 5\\times 10^5$\uff0c\u6c42 $\\displaystyle \\left(\\sum_{i=1}^n\\sum_{j=1}^md(ij)\\varphi(ij)\\right)\\bmod 10^9+7$\u3002  \n\n\u4e0d\u59a8\u8bbe $n\\leq m$\u3002\n\n$$\\sum_{i=1}^n\\sum_{j=1}^md(ij)\\varphi(ij)$$\n\n$$=\\sum_{d=1}^n\\sum_{i=1}^n\\sum_{j=1}^md(ij)\\dfrac{\\varphi(i)\\varphi(j)}{\\varphi(d)}d[\\gcd(i,j)=d]$$\n\n$$=\\sum_{d=1}^n\\dfrac{d}{\\varphi(d)}\\sum_{i=1}^{n/d}\\sum_{j=1}^{m/d}d(ijd^2)\\varphi(id)\\varphi(jd)\\sum_{k|i,k|j}\\mu(k)$$\n\n$$=\\sum_{T=1}^n\\left(\\sum_{d|T}\\dfrac{d}{\\varphi(d)}\\mu(T/d)\\right)\\sum_{i=1}^{n/T}\\sum_{j=1}^{m/T}d(ijT^2)\\varphi(iT)\\varphi(jT)$$\n\n\u8bbe $\\displaystyle f(T)=\\sum_{d|T}\\dfrac{d}{\\varphi(d)}\\mu(T/d)$\uff0c\u7136\u540e\u628a\u540e\u9762\u7684\u56e0\u6570\u4e2a\u6570\u62c6\u5f00\u3002\n\n$$=\\sum_{T=1}^nf(T)\\sum_{T|i,1\\leq i\\leq n}\\sum_{T|j,1\\leq j\\leq m}\\varphi(i)\\varphi(j)d(ij)$$\n\n$$=\\sum_{T=1}^nf(T)\\sum_{T|i,1\\leq i\\leq n}\\sum_{T|j,1\\leq j\\leq m}\\varphi(i)\\varphi(j)\\sum_{a|i}\\sum_{b|j}[\\gcd(a,b)=1]$$\n\n$$=\\sum_{T=1}^nf(T)\\sum_{T|i,1\\leq i\\leq n}\\sum_{T|j,1\\leq j\\leq m}\\varphi(i)\\varphi(j)\\sum_{a|i}\\sum_{b|j}\\sum_{t|a,t|b}\\mu(t)$$\n\n$$=\\sum_{T=1}^nf(T)\\sum_{T|i,1\\leq i\\leq n}\\sum_{T|j,1\\leq j\\leq m}\\varphi(i)\\varphi(j)\\sum_{t|i,t|j}\\mu(t)d(i/t)d(j/t)$$\n\n\u7531\u4e8e $t|i,T|i$ \u7b49\u4ef7\u4e8e $\\operatorname{lcm}(t,T)|i$\uff0c\u679a\u4e3e $x=\\operatorname{lcm}(t,T)$\u3002\n\n$$\\sum_{t=1}^n\\mu(t)\\sum_{t|x,1\\leq x\\leq n}\\left(\\sum_{x|i,1\\leq i\\leq n}\\varphi(i)d(i/t)\\right)\\left(\\sum_{x|j,1\\leq j\\leq m}\\varphi(j)d(j/t)\\right)\\sum_{T=1}^nf(T)[\\operatorname{lcm}(t,T)=x]$$\n\n\u76f4\u63a5\u679a\u4e3e $t$ \u53ca $t|x$\uff0c\u518d\u679a\u4e3e $x|i$ \u7684\u590d\u6742\u5ea6\u662f\uff1a\n\n$\\sum\\limits_{t=1}^n\\sum\\limits_{i=1}^{n/x}n/(xi)=\\sum\\limits_{t=1}^nn/x\\ln(n/x)=O(n\\ln^2 n)$\n\n\u6240\u4ee5\u53ea\u9700\u5bf9 $t,x$ \u5feb\u901f\u6c42\u51fa $\\displaystyle \\sum_{T=1}^nf(T)[\\operatorname{lcm}(t,T)=x]$\u3002\n\n\u4f46\u5176\u5b9e\u6211\u4eec\u53ea\u9700\u5bf9 $\\mu(t)$ \u975e\u96f6\u7684 $t$ \u6c42\u503c\u3002\n\n\u518d\u89c2\u5bdf\u4e00\u4e0b $f(T)=\\sum\\limits_{d|T}\\dfrac{d}{\\varphi(d)}\\mu(T/d)$\uff0c\u8fd9\u663e\u7136\u662f\u79ef\u6027\u7684\u3002\n\n\u800c $f(p^k)=\\begin{cases}-1+\\dfrac{p}{p-1}=\\dfrac{1}{p-1},&k=1\\\\ \\dfrac{p^k}{\\varphi(p^k)}-\\dfrac{p^{k-1}}{\\varphi(p^{k-1})}=0,&k\\geq 2\\end{cases}$\uff0c\u4e5f\u5373 $f(T)$ \u4ec5\u5728 $\\mu(T)$ \u975e\u96f6\u65f6\u6709\u503c\u3002\n\n\u65e2\u7136 $\\mu(t)\\neq 0,\\mu(T)\\neq 0,x=\\operatorname{lcm}(t,T)$\uff0c\u5219 $\\mu(x)\\neq0$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u6ca1\u6709\u5e73\u65b9\u56e0\u5b50\u7684 $t,T,x$\uff0c\u6c42\u51fa $\\displaystyle \\sum_{T=1}^nf(T)[\\operatorname{lcm}(t,T)=x]$\u3002\n\n\u8bbe $x,t,T$ \u7684\u8d28\u56e0\u5b50\u96c6\u5408\u5206\u522b\u4e3a $P_x,P_t,P_T$\uff0c\u5219 $P_t\\cup P_T=P_x$ \u4e14\u6761\u4ef6\u5145\u8981\u3002\n\n\u6240\u4ee5 $P_T$ \u5fc5\u7531 $P_x\\setminus P_t$ \u7684\u5168\u90e8\u5143\u7d20\u4e0e $P_t$ \u7684\u4e00\u90e8\u5206\u62fc\u6210\u3002\n\n\u56e0\u6b64 $\\displaystyle \\sum_{T=1}^nf(T)[\\operatorname{lcm}(t,T)=x]=\\left(\\prod_{p\\in P_x,p\\not\\in P_t}f(p)\\right)\\left(\\prod_{p\\in P_t}\\left(f(p)+1\\right)\\right)$\u3002\n\n\u6700\u540e\u9762\u7684 $+1$ \u5c31\u76f8\u5f53\u4e8e $P_t$ \u4e2d\u7684\u5143\u7d20\u53ef\u9009\u53ef\u4e0d\u9009\u3002\n\n\u53e6\u8bbe\u79ef\u6027\u51fd\u6570 $g(p)=f(p)+1=\\dfrac{p}{p-1},g(n)=\\prod\\limits_{p|n}\\dfrac{p}{p-1}$\u3002\n\n\u5219 $\\displaystyle \\sum_{T=1}^nf(T)[\\operatorname{lcm}(t,T)=x]=f(x/t)g(t)$\u3002\n\n\u7ebf\u6027\u9884\u5904\u7406\u51fa $f,g,d,\\varphi,\\mu$\uff0c\u4fbf\u53ef $O(n\\ln^2 n)$ \u505a\u5b8c\u4e86\uff0c\u7a7a\u95f4\u7ebf\u6027\u3002\n\n\u6838\u5fc3\u4ee3\u7801\uff1a  \n```cpp\nfor(t=1;t<=n;++t)if(mu[t]){\n  res=0;\n  for(x=t;x<=n;x+=t)if(mu[x]){\n    sn=sm=0;\n    for(i=x;i<=n;i+=x)add(sn,phi[i]*d[i/t]);\n    for(i=x;i<=m;i+=x)add(sm,phi[i]*d[i/t]);\n    add(res,1ll*sn*sm%mod*f[x/t]%mod*g[t]%mod);\n  }\n  add(ans,1ll*res*(mu[t]+mod)%mod);\n}\n```\n[\u8bc4\u6d4b\u8bb0\u5f55](https://www.luogu.com.cn/record/88708459)\n~~\u4e3a\u4ec0\u4e48\u65f6\u9650\u4e0d\u5f00 100ms~~\u3002\n\n\u4f46\u518d\u4ed4\u7ec6\u89c2\u5bdf\u4e00\u4e0b\uff0c\u628a\u6bcf\u6b21\u5904\u7406\u7684 $t$ \u7684\u500d\u6570\u62c9\u51fa\u6765\uff0c\n\n\u6211\u4eec\u53d1\u73b0\u5728\u5bf9\u4e8e $t|x$ \u7684 $x$ \u505a\u7684\u4e8b\u65e0\u975e\u662f\u4e00\u4e2a\u6574\u9664\u7684\u540e\u7f00\u548c\u3002\n\n\u56e0\u4e3a\u5728 $t|x,t|i$ \u65f6\uff0c$x|i\\Leftrightarrow \\frac{x}{t}|\\frac{i}{t}$\u3002\n\n\u6240\u4ee5\u8fd9\u90e8\u5206\u80fd\u88ab\u4e00\u4e2a $\\text{Dirichlet}$ \u540e\u7f00\u548c\u4f18\u5316\u6389\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u964d\u81f3 $O(n\\ln n\\ln\\ln n)$\uff0c\u867d\u7136\u5728\u6570\u636e\u8303\u56f4\u53ea\u6709 $5\\times 10^5$ \u65f6[\u6ca1\u592a\u5927\u533a\u522b](https://www.luogu.com.cn/record/88787228)\u3002\n\n\u6838\u5fc3\u4ee3\u7801\uff1a\n```cpp\nfor(t=1;t<=n;++t)if(mu[t]){\n  res=0;\n  for(i=t;i<=n;i+=t)sn[i/t]=phi[i]*d[i/t];\n  for(j=t;j<=m;j+=t)sm[j/t]=phi[j]*d[j/t];\n  for(nn=n/t,k=1;k<=prm&&p[k]<=nn;++k)\n    for(l=nn/p[k];l;--l)add(sn[l],sn[l*p[k]]);\n  for(nn=m/t,k=1;k<=prm&&p[k]<=nn;++k)\n    for(l=nn/p[k];l;--l)add(sm[l],sm[l*p[k]]);\n  for(x=t;x<=n;x+=t)if(mu[x])\n    add(res,1ll*sn[x/t]*sm[x/t]%mod*f[x/t]%mod*g[t]%mod);\n  add(ans,1ll*res*(mu[t]+mod)%mod);\n}\n```\n~~\u4e3a\u4ec0\u4e48\u6570\u636e\u8303\u56f4\u4e0d\u52a0\u4e2a0~~\u3002",
        "postTime": 1664982133,
        "uid": 334380,
        "name": "Y_B_X",
        "ccfLevel": 7,
        "title": "\u9898\u89e3[P8570 \u7275\u8fde\u7684\u4e16\u754c]"
    },
    {
        "content": "\u63a8\u5f0f\u5b50\u840c\u65b0\u6765\u63a8\u63a8\u770b\u5f0f\u5b50\u3002\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\sigma_0(ij)\\varphi(ij)$$\n\n\u5148\u628a $\\sigma_0$ \u548c $\\varphi$ \u5c55\u5f00\u6765\u3002\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\dfrac{\\varphi(i)\\varphi(j)\\gcd(i,j)}{\\varphi(\\gcd(i,j))}\\sum_{x|i}\\sum_{y|j}[\\gcd(x,y)=1]$$\n\n\u66ff\u6362 $[\\gcd(x,y)]=1$\u3002\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\dfrac{\\varphi(i)\\varphi(j)\\gcd(i,j)}{\\varphi(\\gcd(i,j))}\\sum_{x|i}\\sum_{y|j}\\sum_{d|x,d|y}\\mu(d)$$\n\n\u6362\u4e2a\u679a\u4e3e\u987a\u5e8f\uff0c\u628a $d$ \u7684\u679a\u4e3e\u63d0\u524d\u3002\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\dfrac{\\varphi(i)\\varphi(j)\\gcd(i,j)}{\\varphi(\\gcd(i,j))}\\sum_{d|\\gcd(i,j)}\\sigma_0(\\frac{i}{d})\\sigma_0(\\frac{j}{d})\\mu(d)$$\n\n\u518d\u6362\u4e2a\u679a\u4e3e\u987a\u5e8f\uff0c\u628a $d$ \u7684\u679a\u4e3e\u518d\u63d0\u524d\u3002\n\n$$\\sum_{d=1}^n\\sum_{i=1}^{n/d}\\sum_{j=1}^{m/d}\\dfrac{\\varphi(id)\\varphi(jd)\\gcd(i,j)d}{\\varphi(\\gcd(i,j)d)}\\sigma_0(i)\\sigma_0(j)\\mu(d)$$\n\n\u679a\u4e3e $z=\\gcd(i,j)$\u3002\n\n$$\\sum_{d=1}^n\\mu(d)d\\sum_{z=1}^{n/d}\\sum_{i=1}^{n/dz}\\sum_{j=1}^{m/dz}\\dfrac{\\varphi(idz)\\varphi(jdz)z}{\\varphi(zd)}\\sigma_0(iz)\\sigma_0(jz)[\\gcd(i,j)=1]$$\n\n\u6362\u4e2a\u987a\u5e8f\u3002\n\n$$\\sum_{d=1}^n\\mu(d)d\\sum_{z=1}^{n/d}\\dfrac{z}{\\varphi(zd)}\\sum_{i=1}^{n/dz}\\sigma_0(iz)\\varphi(idz)\\sum_{j=1}^{m/dz}\\sigma_0(jz)\\varphi(jdz)[\\gcd(i,j)=1]$$\n\n\u518d\u66ff\u6362 $[\\gcd(i,j)=1]$\u3002\n\n$$\\sum_{d=1}^n\\mu(d)d\\sum_{z=1}^{n/d}\\dfrac{z}{\\varphi(zd)}\\sum_{i=1}^{n/dz}\\sigma_0(iz)\\varphi(idz)\\sum_{j=1}^{m/dz}\\sigma_0(jz)\\varphi(jdz)\\sum_{w|i,w|j}\\mu(w)$$\n\n\u628a $w$ \u653e\u5230\u524d\u9762\u679a\u4e3e\u3002\n\n$$\\sum_{d=1}^n\\mu(d)d\\sum_{z=1}^{n/d}\\dfrac{z}{\\varphi(zd)}\\sum_{w=1}^{n/dz}\\mu(w)\\sum_{i=1}^{n/dzw}\\sigma_0(iwz)\\varphi(iwdz)\\sum_{j=1}^{m/dzw}\\sigma_0(jwz)\\varphi(jwdz)$$\n\n\u5b9a\u4e49\u4e24\u4e2a\u51fd\u6570\uff1a\n\n$$A(x,y)=\\sum_{i=1}^{n/xy}\\sigma_0(iy)\\varphi(ixy)$$\n\n$$B(x,y)=\\sum_{i=1}^{m/xy}\\sigma_0(iy)\\varphi(ixy)$$\n\n\u539f\u5f0f\u53ef\u4ee5\u8f6c\u5316\u4e3a\uff1a\n\n$$\\sum_{d=1}^n\\mu(d)d\\sum_{z=1}^{n/d}\\dfrac{z}{\\varphi(zd)}\\sum_{w=1}^{n/dz}\\mu(w)A(d,zw)B(d,zw)$$\n\n\u9996\u5148\u53ef\u4ee5\u53d1\u73b0\uff1a\u4e58\u79ef\u5c0f\u4e8e\u7b49\u4e8e $n$ \u7684\u4e09\u5143\u7ec4\u4e2a\u6570\u662f $O(n\\log^2 n)$ \u7ea7\u522b\u7684\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5728 $O(n\\log ^2 n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u8ba1\u7b97\u51fa\u6240\u6709 $A(x,y)$ \u548c $B(x,y)$\u3002\n\n\u5982\u679c\u5df2\u7ecf\u7b97\u51fa\u4e86 $A$ \u548c $B$\uff0c\u5269\u4e0b\u7684\u6309\u7167\u4e0a\u9762\u7684\u5f0f\u5b50\u7b97\uff0c\u5bb9\u6613\u53d1\u73b0\u4e5f\u662f $O(n\\log^2 n)$ \u7684\u3002\u6240\u4ee5\u6211\u4eec\u7528 $O(n\\log^2 n)$ \u5b8c\u6210\u4e86\u8fd9\u9053\u9898\u3002\n\n```cpp\n// mu \u8868\u793a\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\uff0cphi \u8868\u793a\u6b27\u62c9\u51fd\u6570\uff0cD \u8868\u793a\u7ea6\u675f\u4e2a\u6570\u548c\u51fd\u6570\uff0cinv \u8868\u793a\u9006\u5143\nint main()\n{\n\tios_base::sync_with_stdio(false);\n\tcin.tie(nullptr);\n\tcin >> n >> m;\n\tinit();\n\tll ans=0;\n\tfor (int d=1;d<=n;d++)\n\t{\n\t\tfor (int j=1;j<=n/d;j++) \n\t\t{\n\t\t\ta[j]=0;\n\t\t\tfor (int i=1;i<=n/(d*j);i++) a[j]=(a[j]+1ll*D[i*j]*phi[i*d*j]%mod)%mod;\n\t\t\tb[j]=0;\n\t\t\tfor (int i=1;i<=m/(d*j);i++) b[j]=(b[j]+1ll*D[i*j]*phi[i*d*j]%mod)%mod;\n\t\t}\n\t\tfor (int j=1;j<=n/d;j++) \n\t\t{\n\t\t\tfor (int w=1;w<=n/(d*j);w++)\n\t\t\t{\n\t\t\t\tans=ans+1ll*mu[d]*mu[w]*inv[phi[j*d]]*d%mod*j%mod*a[j*w]%mod*b[j*w]%mod;\n\t\t\t\tans=(ans+mod)%mod;\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans;\n\treturn 0;\n}\n\n```\n",
        "postTime": 1665143479,
        "uid": 151475,
        "name": "Little09",
        "ccfLevel": 8,
        "title": "P8570 [JRKSJ R6] \u7275\u8fde\u7684\u4e16\u754c \u9898\u89e3"
    },
    {
        "content": "\u53ef\u80fd\u66f4\u4e3a\u7b80\u6d01\u7684\u63a8\u6cd5\u3002\n\n$$\\sum_{i=1}^n \\sum_{j=1}^m \\sigma(ij)\\varphi(ij)$$\n\n$$ =\\sum_{i,j,t}\\frac{\\varphi(i)\\varphi(j)t}{\\varphi(t)}[\\gcd(i,j)=t]\\sum_{d|t}\\mu(d)\\sigma(\\frac{i}{d})\\sigma(\\frac{j}{d})$$\n\n$$ =\\sum_{d|t}\\frac{\\mu(d)t}{\\varphi(t)}\\sum_{i,j}[\\gcd(i,j)=1]\\varphi(it)\\varphi(jt)\\sigma(\\frac{it}{d})\\sigma(\\frac{jt}{d})$$\n\n$$ =\\sum_{d,t}\\mu(d)(\\sum_{g|t}\\frac{\\mu(\\frac{t}{g})gd}{{\\varphi(gd)}})(\\sum_{t|i}^{n/d}\\varphi(id)\\sigma(i))(\\sum_{t|i}^{m/d}\\varphi(id)\\sigma(i))$$\n\n\u662f Dirichlet \u524d\u7f00\u5dee\u5206&\u540e\u7f00\u548c\uff0c\u590d\u6742\u5ea6 $O(n \\log n\\log\\log n)$",
        "postTime": 1665302272,
        "uid": 110713,
        "name": "ButterCake",
        "ccfLevel": 0,
        "title": "P8570 [JRKSJ R6] \u7275\u8fde\u7684\u4e16\u754c"
    },
    {
        "content": "\u72c2\u66b4\u63a8\u5f0f\u5b50\u3002\n\n\u4e0d\u5931\u4e00\u822c\u6027\uff0c\u6211\u4eec\u8bbe $n\\le m$\uff0c\u5f0f\u5b50\u4e2d $a,b,c$ \u4e3a\u6b63\u6574\u6570\u3002\u9664\u53f7\u4ee3\u8868\u4e0b\u53d6\u6574\u9664\u6cd5\uff0c\u800c\u5206\u6570\u7ebf\u7ed3\u679c\u4e3a\u5b9e\u6570\u3002\n$$\n\\begin{aligned}\n\\sum_{i=1}^n\\sum_{j=1}^m\\sigma(ij)\\varphi(ij)&=\\sum_{i=1}^n\\sum_{j=1}^m\\left(\\sum_{x|i}\\sum_{y|j}[\\gcd(x,y)=1]\\right)\\left(\\frac{\\varphi(i)\\varphi(j)\\gcd(i,j)}{\\varphi(\\gcd(i,j))}\\right)\n\\\\\n&=\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{x|i}\\sum_{y|j}\\sum_{a|\\gcd(x,y)}\\mu(a)\\frac{\\varphi(i)\\varphi(j)\\gcd(i,j)}{\\varphi(\\gcd(i,j))}\n\\\\\n&=\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{a|\\gcd(i,j)}\\sigma(\\frac{i}{a})\\sigma(\\frac{j}{a})\\mu(a)\\frac{\\varphi(i)\\varphi(j)\\gcd(i,j)}{\\varphi(\\gcd(i,j))}\n\\\\\n&=\\sum_{ab\\le n}\\sum_{i=1}^{n/ab}\\sum_{j=1}^{m/ab}\\sigma(ib)\\sigma(jb)\\mu(a)\\frac{\\varphi(iab)\\varphi(jab)ab}{\\varphi(ab)}[\\gcd(i,j)=1]\n\\\\\n&=\\sum_{ab\\le n}\\sum_{i=1}^{n/ab}\\sum_{j=1}^{m/ab}\\frac{ab\\mu(a)}{\\varphi(ab)}\\sigma(ib)\\varphi(iab)\\sigma(jb)\\varphi(jab)\\sum_{c|\\gcd(i,j)}\\mu(c)\n\\\\\n&=\\sum_{ab\\le n}\\sum_{c=1}^{n/ab}\\sum_{i=1}^{n/abc}\\sum_{j=1}^{m/abc}\\frac{ab\\mu(a)\\mu(c)}{\\varphi(ab)}\\sigma(ibc)\\varphi(iabc)\\sigma(jbc)\\varphi(jabc)\n\\\\\n&=\\sum_{abc\\le n}\\frac{ab\\mu(a)\\mu(c)}{\\varphi(ab)}\n\\left(\\sum_{i=1}^{n/abc}\\sigma(ibc)\\varphi(iabc)\\right)\n\\left(\\sum_{j=1}^{m/abc}\\sigma(jbc)\\varphi(jabc)\\right)\n\\end{aligned}\n$$\n\n\u4e0d\u59a8\u8bbe\n$$\nS^{(t)}(x,y)=\\sum_{i=1}^{t/xy}\\sigma(iy)\\varphi(ixy)\n$$\n\u5219\u539f\u5f0f\u4e3a\n$$\n\\boxed{\n\\sum_{abc\\le n}\\frac{ab\\mu(a)\\mu(c)}{\\varphi(ab)}\nS^{(n)}(a,bc)\nS^{(m)}(a,bc)\n}\n$$\n\n\u800c\u6211\u4eec\u6709\uff1a$abc\\le n$ \u7684\u6709\u5e8f\u6b63\u6574\u6570\u4e09\u5143\u7ec4 $(a,b,c)$ \u4e2a\u6570\u4e3a $O(n\\log^2n)$\u3002\u56e0\u4e3a\n\n$$\n\\sum_{a=1}^{n}\\sum_{b=1}^{n/a}\\lfloor\\frac{n}{ab}\\rfloor\n\\le\\sum_{a=1}^{n}\\frac{n}{a}\\log \\frac{n}{a}\n\\le\\log n\\sum_{a=1}^{n}\\frac{n}{a}\n=n\\log^2 n\n$$\n\u6240\u4ee5\u679a\u4e3e $a,(b\\times c)$ \u548c $S^{(t)}$ \u4e2d\u7684 $i$\uff08\u4e09\u8005\u4e58\u79ef $\\le n$ \u6216 $m$\uff09\u590d\u6742\u5ea6\u4e3a $O(n\\log^2n)$\uff0c\u5373\u6211\u4eec\u4ee5\u8fd9\u4e2a\u590d\u6742\u5ea6\u5904\u7406\u51fa\u6240\u6709\u6211\u4eec\u4f1a\u7528\u5230\u7684 $S^{(n)},S^{(m)}$\u3002\n\n\u7136\u540e\u518d $O(n\\log^2n)$ \u679a\u4e3e\u4e58\u79ef $\\le n$ \u7684 $a,b,c$ \u5373\u53ef\u3002\n\n\u6700\u7ec8\u590d\u6742\u5ea6 $O(n\\log^2n)$\u3002\n\n```cpp\n// #pragma GCC optimize(\"Ofast\")\n#include<bits/stdc++.h>\nusing namespace std;\n#define For(i,j,k) for(int i=(j),i##_=(k);i<=i##_;i++)\n#define Rof(i,j,k) for(int i=(j),i##_=(k);i>=i##_;i--)\ntemplate<int P>\nclass mod_int{\n\tusing Z=mod_int;\nprivate:\n\tstatic int mo(int x){return x<0?x+P:x;}\npublic:\n\tint x;\n\tint val()const{return x;}\n\tmod_int():x(0){}\n\ttemplate<class T>mod_int(const T&x_):x(x_>=0&&x_<P?static_cast<int>(x_):mo(static_cast<int>(x_%P))){}\n\tbool operator==(const Z&rhs)const{return x==rhs.x;}\n\tbool operator!=(const Z&rhs)const{return x!=rhs.x;}\n\tZ operator-()const{return Z(x?P-x:0);}\n\tZ pow(long long k)const{Z res=1,t=*this;while(k){if(k&1)res*=t;if(k>>=1)t*=t;}return res;}\n\tZ&operator++(){x<P-1?++x:x=0;return *this;}\n\tZ&operator--(){x?--x:x=P-1;return *this;}\n\tZ operator++(int){Z ret=x;x<P-1?++x:x=0;return ret;}\n\tZ operator--(int){Z ret=x;x?--x:x=P-1;return ret;}\n\tZ inv()const{return pow(P-2);}\n\tZ&operator+=(const Z&rhs){(x+=rhs.x)>=P&&(x-=P);return *this;}\n\tZ&operator-=(const Z&rhs){(x-=rhs.x)<0&&(x+=P);return *this;}\n\tZ&operator*=(const Z&rhs){x=1ULL*x*rhs.x%P;return *this;}\n\tZ&operator/=(const Z&rhs){return *this*=rhs.inv();}\n#define setO(T,o) friend T operator o(const Z&lhs,const Z&rhs){Z res=lhs;return res o##=rhs;}\n\tsetO(Z,+)setO(Z,-)setO(Z,*)setO(Z,/)\n#undef setO\n};\nconst int P=1e9+7;\nusing Z=mod_int<P>;\nconst int N=500005;\nZ d[N],phi[N],mu[N],mp[N],sn[N],sm[N],iv[N];\nbool vis[N];\nvector<int> p;\nvoid init(int lim){\n\td[1]=phi[1]=mu[1]=iv[1]=1;\n\tFor(i,2,lim){\n\t\tiv[i]=Z(i).inv();\n\t\tif(!vis[i]){\n\t\t\td[i]=2;\n\t\t\tphi[i]=i-1;\n\t\t\tmu[i]=-1;\n\t\t\tmp[i]=2;\n\t\t\tp.emplace_back(i);\n\t\t}\n\t\tfor(int j:p){\n\t\t\tif(i*j>lim) break;\n\t\t\tvis[i*j]=true;\n\t\t\tif(i%j==0){\n\t\t\t\tmp[i*j]=mp[i]+1;\n\t\t\t\td[i*j]=d[i]/mp[i]*mp[i*j];\n\t\t\t\tmu[i*j]=0;\n\t\t\t\tphi[i*j]=phi[i]*j;\n\t\t\t\tbreak;\n\t\t\t}else{\n\t\t\t\tmp[i*j]=2;\n\t\t\t\tmu[i*j]=-mu[i];\n\t\t\t\tphi[i*j]=phi[i]*(j-1);\n\t\t\t\td[i*j]=d[i]*2;\n\t\t\t}\n\t\t}\n\t}\n}\nsigned main(){ios::sync_with_stdio(false),cin.tie(nullptr);\n\tint n,m;\n\tZ ans(0);\n\tcin>>n>>m;\n\tif(n>m) swap(n,m);\n\tinit(m);\n\tFor(a,1,n){\n\t\tFor(bc,1,n/a){\n\t\t\tsn[bc]=sm[bc]=0;\n\t\t\tFor(i,1,n/a/bc) sn[bc]+=d[i*bc]*phi[i*a*bc];\n\t\t\tFor(i,1,m/a/bc) sm[bc]+=d[i*bc]*phi[i*a*bc];\n\t\t}\n\t\tFor(b,1,n/a){\n\t\t\tFor(c,1,n/a/b){\n\t\t\t\tans+=Z(a*b)*iv[phi[a*b].val()]*mu[a]*mu[c]*sn[b*c]*sm[b*c];\n\t\t\t}\n\t\t}\n\t}\n\tcout<<ans.val()<<\"\\n\";\nreturn 0;}\n```",
        "postTime": 1665195511,
        "uid": 761140,
        "name": "KaKa_fairy",
        "ccfLevel": 0,
        "title": "P8570 [JRKSJ R6] \u7275\u8fde\u7684\u4e16\u754c\uff08\u6570\u8bba\uff09"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u4e2a\u7b80\u6d01\u7684\u505a\u6cd5\u3002\n\n$$\n\\sum_{i=1}^n \\sum_{j=1}^m \\sigma_0(ij)\\varphi(ij)\n$$\n\n\u663e\u7136\u6709 $\\sigma_0(ij)=\\sum_{x|i}\\sum_{y|j} [\\gcd(x,y)=1]$\uff08P3327\uff09\uff0c$\\varphi(ij)=\\dfrac{\\varphi(i)\\varphi(j)\\gcd(i,j)}{\\varphi(\\gcd(i,j))}$\u3002\n\n\u8003\u8651\u5148\u5bf9 $\\sigma_0(ij)$ \u53cd\u6f14\uff0c$\\sigma_0(ij)=\\sum_{d|\\gcd(i,j)}\\mu(d)\\sum_{x|i,d|x}1\\sum_{y|j,d|y}1$\n\n\u53ef\u4ee5\u53d1\u73b0 $\\sum_{x|i,d|x}1$ \u5176\u5b9e\u5c31\u662f $\\sigma_0(\\frac{x}{d})$\u3002\n\n\u4e8e\u662f $\\sigma_0(ij)=\\sum_{d|\\gcd(i,j)}\\mu(d)\\sigma_0(\\frac{i}{d})\\sigma_0(\\frac{j}{d})$\u3002\n\n\u7136\u540e\u4ee3\u56de\u539f\u5f0f\u3002\n\n\n$$\n\n\n\\sum_{i=1}^n\\sum_{j=1}^m \\sum_{d|\\gcd(i,j)}\\mu(d)\\sigma_0(\\frac{i}{d})\\sigma_0(\\frac{j}{d})\\frac{\\varphi(i)\\varphi(j)\\gcd(i,j)}{\\varphi(\\gcd(i,j))}\n$$\n\n$$\n\\begin{aligned}\n\n&=\\sum_{D=1}^n \\dfrac{D}{\\varphi(D)}\\sum_{i=1}^{n/D} \\sum_{j=1}^{m/D}\\sum_{d|D}\\mu(d)\\sigma_0(\\frac{iD}{d})\\sigma_0(\\frac{jD}{d})\\varphi(iD)\\varphi(jD)[\\gcd(i,j)=1] \\\\\n\n&=\\sum_{D=1}^n\\dfrac{D}{\\varphi(D)}\\sum_{D_2=1}^{n/D}\\mu(D_2)\\sum_{i=1}^{n/DD_2}\\sum_{j=1}^{n/DD_2}\\sum_{d|D}\\mu(d)\\sigma_0(\\frac{iDD_2}{d})\\sigma_0(\\frac{jDD_2}{d})\\varphi(iDD_2)\\varphi(jDD_2)\\\\\n\n&=\n\\sum_{D=1}^n\\dfrac{D}{\\varphi(D)}\\sum_{D_2=1}^{n/D}\\mu(D_2)\\sum_{d|D}\\mu(d)[\\sum_{i=1}^{n/DD_2}\\varphi(iDD_2)\\sigma_0(\\frac{iDD_2}{d})][\\sum_{j=1}^{n/DD_2}\\sigma_0(\\frac{jDD_2}{d})\\varphi(jDD_2)]\n\\end{aligned}\n$$\n\n\n\u53d1\u73b0\u8fd9\u4e2a\u5f62\u5f0f\u5341\u5206\u597d\u770b\u3002\n\n\u4e0d\u5982\u8bb0 $f(n,T,D)=\\sum_{i=1}^{n/T}\\varphi(iT)\\sigma_0(\\dfrac{iT}{D})$\u3002\n\n\u90a3\u4e48\u7b54\u6848\u4e3a\uff1a\n\n$$\n\\sum_{D=1}^n\\dfrac{D}{\\varphi(D)}\\sum_{D_2=1}^{n/D}\\mu(D_2)\\sum_{d|D}\\mu(d) f(n,DD_2,d)\\times f(m,DD_2,d)\n$$\n\n\u770b\u4e0a\u53bb\u5341\u5206\u79bb\u8c31\uff0c\u52a0\u4e00\u70b9\u5c0f\u526a\u679d\uff08\u5982 $\\mu$ \u7684\u503c\u4e0d\u80fd\u4e3a $0$\uff09\u5199\u4e00\u53d1\u76f4\u63a5\u8fc7\u4e86\u3002\n\n\u5982\u679c\u5bf9 $f$ \u51fd\u6570\u8bb0\u5fc6\u5316\uff0c\u90a3\u4e48\u5b9e\u9645\u4e0a\u662f $\\mathcal{O}(n\\log_2^2n)$ \u7684\u3002\n\n\u600e\u4e48\u7b97\u7684\u5462\uff0c\u663e\u7136 $f$ \u51fd\u6570\u4e2d $D|T$\u3002\n\n\u90a3\u4e48\u590d\u6742\u5ea6\u9876\u6ee1\u5c31\u662f \n\n$$\n\\begin{aligned}\n\n\\sum_{T=1}^n \\sigma_0(T)\\lfloor\\dfrac{n}{T}\\rfloor&=\\sum_{d=1}^{n}\\sum_{T=1}^{n/d}\\lfloor\\frac{n}{Td}\\rfloor \\\\\n\n&=\\sum_{d=1}^{n}\\dfrac{n}{d}\\log \\dfrac{n}{d} \\\\\n\n&=n\\log_2^2n\n\\end{aligned}\n$$\n\n\u5982\u679c\u4e0d\u8bb0\u5fc6\u5316\u7684\u8bdd\uff0c\u4f3c\u4e4e\u662f $\\mathcal{O}(n\\log_2^3n)$ \u7684\uff0c\u4f46\u662f\u7531\u4e8e\u6709 $\\mu$ \u7684\u503c\u4e0d\u80fd\u4e3a $0$ \u7684\u9650\u5236\uff0c\u8dd1\u7684\u975e\u5e38\u5feb\uff0c\u5b8c\u5168\u4e0d\u7528\u62c5\u5fc3\u8fc7\u4e0d\u4e86\u3002",
        "postTime": 1664890916,
        "uid": 154560,
        "name": "Silver187",
        "ccfLevel": 7,
        "title": "\u7275\u8fde\u7684\u4e16\u754c \u9898\u89e3"
    },
    {
        "content": "\u6211\u611f\u89c9\u8fd8\u597d\uff0c\u4f46\u662f\u6839\u636e\u8d5b\u524d\u7684\u53cd\u9988\u8fd9\u9898\u8fd8\u633a\u96be\u7684\uff0c\u5c31\u653e\u5230 E \u7684\u4f4d\u7f6e\u4e86\u3002\n\n\u6709\u4ec0\u4e48\u597d\u7684\u89e3\u6cd5\u6b22\u8fce\u4ea4\u6d41\uff01\uff01\n\n\u4e0b\u9762\u628a $\\sigma_0$ \u5199\u4f5c $\\sigma$\uff0c\u5e76\u4ee4 $n\\le m$\uff0c$m=\\Theta(n)$\u3002\n\n$$\\sum_{i=1}^n \\sum_{j=1}^m \\sigma(ij)\\varphi(ij)$$\n\n$$\\sum_{i=1}^n \\sum_{j=1}^m\\sigma(ij)\\dfrac{\\varphi(i)\\varphi(j)\\gcd(i,j)}{\\varphi(\\gcd(i,j))}$$\n\n$$\\sum_{d=1}^n \\dfrac d {\\varphi(d)}\\sum_{i=1}^n \\sum_{j=1}^m \\sigma(ij)\\varphi(i)\\varphi(j)[\\gcd(i,j)=d]$$\n\n$$\\sum_{d=1}^n \\dfrac d {\\varphi(d)}\\sum_{i=1}^{n/d} \\varphi(id)\\sum_{j=1}^{m/d}\\varphi(jd) \\sigma(ijd^2)[\\gcd(i,j)=1]$$\n\n$$\\sum_{d=1}^n \\dfrac d {\\varphi(d)}\\sum_{i=1}^{n/d} \\varphi(id)\\sum_{j=1}^{m/d}\\varphi(jd) \\sigma(ijd^2)\\sum_{x|i,x|j} \\mu(x)$$\n\n$$\\sum_{d=1}^n \\dfrac d {\\varphi(d)}\\sum_{x=1}^{n/d}\\mu(x)\\sum_{i=1}^{n/dx} \\varphi(idx)\\sum_{j=1}^{m/dx}\\varphi(jdx) \\sigma(ijd^2x^2)$$\n\n\u4ee4 $t=dx$\n\n$$\\sum_{t=1}^n \\sum_{d|t} \\dfrac d {\\varphi(d)} \\mu(\\dfrac t d )\\sum_{i=1}^{n/t}\\varphi(it)\\sum_{j=1}^{m/t}\\varphi(jt)\\sigma(ijt^2)$$\n\n\u4ee4 $f(t)=\\sum_{d|t} \\frac d {\\varphi(d)} \\mu(\\frac t d )$\n\n$$\\sum_{t=1}^n f(t)\\sum_{i=1}^{n/t}\\varphi(it)\\sum_{j=1}^{m/t}\\varphi(jt)\\sigma(ijt^2)$$\n\n\u8fd9\u4e2a\u67ff\u5b50\u76f8\u5f53\u5947\u602a\u3002\u4e0d\u59a8\u8003\u5bdf\u540e\u9762\u7684\u90e8\u5206\u3002\n\n$$\\sum_{i=1}^{n/t}\\varphi(it)\\sum_{j=1}^{m/t}\\varphi(jt)\\sigma(ijt^2)$$\n\n$$\\sum_{i=1}^{n/t}\\varphi(it)\\sum_{j=1}^{m/t}\\varphi(jt)\\sum_{x|it}\\sum_{y|jt}[\\gcd(x,y)=1]$$\n\n$$\\sum_{x=1}^{n}\\sum_{y=1}^{m}[\\gcd(x,y)=1]\\sum_{i=1}^{n/x}[t|ix]\\varphi(ix)\\sum_{j=1}^{m/y}[t|jy]\\varphi(jy)$$\n\n$$\\sum_{x=1}^{n}\\sum_{y=1}^{m}\\sum_{d|x,d|y}\\mu(d)\\sum_{i=1}^{n/x}[t|ix]\\varphi(ix)\\sum_{j=1}^{m/y}[t|jy]\\varphi(jy)$$\n\n$$\\sum_{d=1}^{n}\\mu(d)\\sum_{x=1}^{n/d}\\sum_{i=1}^{n/dx}[t|idx]\\varphi(idx)\\sum_{y=1}^{m/d}\\sum_{j=1}^{m/dy}[t|jdy]\\varphi(jdy)$$\n\n\u4ee4 $f_n(x)=\\sum_{i=1}^{n/x}[t|ix]\\varphi(ix)$\n\n$$\\sum_{d=1}^{n}\\mu(d)\\sum_{x=1}^{n/td}f_n(dx)\\sum_{y=1}^{m/td}f_m(dy)$$\n\n\u4ee4 $g_n(x)=\\sum_{i=1}^{n/x}f_n(ix)$\n\n$$\\sum_{d=1}^{n}\\mu(d)g_n(d)g_m(d)$$\n\n\u5b58\u5728\u591a\u79cd\u89e3\u6cd5\u3002\n\n## \u89e3\u6cd5 1\n\n\u6ce8\u610f\u5230 $f,g$ \u53ef\u4ee5 $O(n\\log \\log n)$ \u6c42\u51fa\u3002\n\n\u5bf9\u4e8e\u5355\u4e2a $t$ \u53ef\u4ee5\u505a\u5230 $O(n\\log \\log n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002\n\n\u8003\u8651\u6839\u53f7\u5206\u6cbb\u3002\n\n\u5bf9\u4e8e $t\\le B$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(Bn\\log \\log n)$\u3002\n\n\u5bf9\u4e8e $t>B$\uff0c\u4f7f\u7528\n\n$$\\sum_{i=1}^{n/t}\\varphi(it)\\sum_{j=1}^{m/t}\\varphi(jt)\\sigma(ijt^2)$$\n\n\u8ba1\u7b97\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u74f6\u9888\u5728\u4e8e\u8ba1\u7b97 $\\sigma$\u3002\u53ef\u4ee5\u56fa\u5b9a $t^2$\uff0c\u679a\u4e3e $ij$ \u52a0\u5165\u5176\u8d28\u56e0\u5b50\u8fdb\u884c\u8ba1\u7b97\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\dfrac {n^2 \\log \\log n} {i^2})$\u3002\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\dfrac {n^2 \\log \\log n} B)$\u3002\n\n\u5f53 $B=\\sqrt n$ \u65f6\uff0c\u7b97\u6cd5\u6709\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\sqrt n\\log \\log n)$\u3002\u53ef\u4ee5\u8f7b\u677e\u8dd1\u8fc7 $2\\times 10^5$\u3002\n\n## \u89e3\u6cd5 2\n\n\u6211\u4eec\u731c\u60f3\u6bcf\u6b21\u679a\u4e3e $t$ \u7684\u500d\u6570\u7684\u7ea6\u6570\u7684\u7ea6\u6570\u65f6\u95f4\u590d\u6742\u5ea6\u4e0d\u4f1a\u592a\u9ad8\uff0c\u8003\u8651\u8ba1\u7b97\u5176\u4e0a\u754c\u3002\n\n$$\\sum_{i=1}^n \\sum_{j=1}^{n/i} \\sum_{x|ij}\\sigma(x)$$\n\n\u4ee4 $d=ij$\n\n$$\\sum_{d=1}^n \\sigma(d) \\sum_{x|d} \\sigma(x)$$\n\n$$\\sum_{x=1}^n\\sigma(x)\\sum_{d=1}^{n/x}\\sigma(d)$$\n\n$$n\\log n\\sum_{x=1}^n\\dfrac {\\sigma(x)} x$$\n\n$$n\\log n\\sum_{x=1}^n\\sum_{k=1}^{n/i} \\dfrac 1 {ij}$$\n\n\u5373 $O(n\\log^3 n )$\u3002\n\n\u8fd9\u6837\u60f3\u8fc7\u662f\u6bd4\u8f83\u5403\u529b\u7684\u3002\u5728\u8ba1\u7b97 $g$ \u7684\u65f6\u5019\u505a\u9ad8\u7ef4\u540e\u7f00\u548c\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u7a33\u8fc7 $2\\times 10^5$ \u4e86\u3002\n\n\n## \u89e3\u6cd5 3\n\n\u4e0a\u9762\u7684\u89e3\u6cd5\u662f\u6709\u5f88\u5927\u6d6a\u8d39\u7684\u3002\n\n\u4e0d\u59a8\u8003\u5bdf $g_{n,k}$ \u7684\u503c\u3002\n\n\u4ee4 $l=\\text{lcm}(t,k)$\n\n$$\\sum_{i=1}^{n/l}\\varphi(il)\\sigma(\\dfrac {il} k)$$\n\n\u663e\u7136\u8fd9\u4e2a\u5f0f\u5b50\u53ea\u6709 $O(n\\log n)$ \u4e2a\u503c\uff0c$O(n\\log^2 n)$ \u9884\u5904\u7406\u51fa\u6765\u540e\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97 $g_{n,k}$\u3002\u6709\u4e2a\u7ec6\u8282\u662f\u9884\u5904\u7406\u7684\u6570\u7ec4\u5e94\u8be5\u662f $G_{k,l}$ \u5f62\u5f0f\u7684\u3002\u65b9\u4fbf\u67e5\u8be2 rank\u3002\n\n\u663e\u7136\uff0c$g$ \u53ea\u6709 $O(n\\log^2 n)$ \u4e2a\u975e $0$ \u9879\uff0c\u76f4\u63a5\u8ba1\u7b97\u5373\u53ef\u3002\n\n\u53d1\u73b0\u74f6\u9888\u5728\u4e8e\u7b97 $\\text{lcm}$\u3002\u4e0d\u5efa\u8bae\u4f7f\u7528\u5e38\u6570\u8f83\u5927\u7684\u9884\u5904\u7406\u503c\u57df $\\gcd$\u3002\u6ce8\u610f\u5230\u6240\u6709\u7684\u9879\u90fd\u662f $t$ \u7684\u500d\u6570\u7684\u7ea6\u6570\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728\u500d\u6570\u4e0a\u505a\u8d28\u56e0\u5b50\u4e0a\u7684 dfs\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log^2n)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002",
        "postTime": 1660822959,
        "uid": 203623,
        "name": "Ntokisq",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 \u7275\u8fde\u7684\u4e16\u754c"
    },
    {
        "content": "\u4e3a\u4e86\u9632\u6b62\u6709\u4eba\u518d\u628a\u989c\u6587\u5b57\u770b\u6210 FWT\uff0c\u8fd9\u6b21\u5e72\u8106\u6ca1\u5199\u3002\n\n[\u9898\u76ee\u6307\u8def](https://www.luogu.com.cn/problem/P8570)\n\n## step 0\uff1a\u5f15\u7406\n\ndalao \u53ef\u8df3\u8fc7\u672c\u8282\u3002\n\n\u3010\u5f15\u7406\u4e00\u3011 $\\sigma_0(ij)=\\sum_{x|i}\\sum_{y|j}[(x,y)=1]$\n\n\u8bc1\u660e\uff1a\u8003\u8651\u7b49\u5f0f\u5de6\u53f3\u4e24\u8fb9\u7684\u8d28\u56e0\u5b50 $p$\u3002\n\n\u8bb0 $r||s$ \u8868\u793a $p^r|s$ \u4e14 $p^{r+1}\\nmid s$\u3002\n\n\u8bbe $a,b,c,d$ \u4f7f\u5f97 $a||i,b||j,c||x,d||y$\u3002\n\n\u7b49\u5f0f\u5de6\u8fb9 $p$ \u88ab\u679a\u4e3e\u4e86 $(a+b+1)$ \u6b21\uff0c\u5373 $p^0,p^1,\\dots,p^{a+b}$\u3002\n\n\u7b49\u5f0f\u53f3\u8fb9\u53ef\u4ee5\u5206\u6210\u4e09\u7c7b\uff1a\n\n1. $c>0,d=0$\uff0c\u6b64\u65f6\u88ab\u679a\u4e3e\u4e86 $a$ \u6b21\uff0c\u5373 $p^{0+0},p^{1+0},\\dots,p^{a+0}$\u3002\n\n2. $c=0,d>0$\uff0c\u6b64\u65f6\u88ab\u679a\u4e3e\u4e86 $b$ \u6b21\uff0c\u5373 $p^{0+0},p^{0+1},\\dots,p^{0+b}$\u3002\n\n3. $c=0,d=0$\uff0c\u6b64\u65f6\u88ab\u679a\u4e3e\u4e86 $1$ \u6b21\uff0c\u5373 $p^0$\u3002\n\n\u5171\u88ab\u679a\u4e3e $(a+b+1)$ \u6b21\u3002\n\n\u7531\u4e58\u6cd5\u539f\u7406\uff0c\u7b49\u5f0f\u5de6\u8fb9 $=$ \u7b49\u5f0f\u53f3\u8fb9\n\n\u8bc1\u6bd5\n\n\u3010\u5f15\u7406\u4e8c\u3011 $\\sigma_0(ij)=\\sum_{d|(i,j)}\\mu(d)\\sigma_0(\\frac i d)\\sigma_0(\\frac j d)$\n\n\u8bc1\u660e\uff1a\u7531\u5f15\u7406\u4e00\uff0c\u7b49\u5f0f\u5de6\u8fb9 $=\\sum_{x|i}\\sum_{y|j}[(x,y)=1]$\n\n\u7b2c\u4e00\u6b21\u83ab\u53cd\n\n$=\\sum_{x|i}\\sum_{y|j}\\sum_{d|x,d|y}\\mu(d)$\n\n$=\\sum_{d|i,d|j}\\mu(d)\\sum_{xd|i}\\sum_{yd|j}1$\n\n\u66ff\u6362 $x$ \u4e3a $xd$\uff0c$y$ \u4e3a $yd$\n\n$=\\sum_{d|(i,j)}\\mu(d)(\\sum_{x|\\frac i d}1)(\\sum_{y|\\frac j d}1)$\n\n$=\\sum_{d|(i,j)}\\mu(d)\\sigma_0(\\frac i d)\\sigma_0(\\frac j d)=$ \u7b49\u5f0f\u53f3\u8fb9\n\n\u8bc1\u6bd5\n\n\u3010\u5f15\u7406\u4e09\u3011 $\\varphi(ij)=\\dfrac{\\varphi(i)\\varphi(j)(i,j)}{\\varphi((i,j))}$\n\n\u8bc1\u660e\uff1a\u8bbe $(i,j)=d$\uff0c\u4ee5\u4e0b\u82e5\u672a\u8bf4\u660e\u5219 $p$ \u4e3a\u8d28\u6570\u3002\n\n\u5219\u7b49\u5f0f\u5de6\u8fb9 $=ij\\prod_{p|ij}(1-\\frac 1 p)$\n\n$=\\dfrac{(i\\prod_{p|i}(1-\\frac 1 p))(j\\prod_{p|j}(1-\\frac 1 p))}{\\prod_{p|(i,j)}(1-\\frac 1 p)} $\n\n$=\\dfrac{\\varphi(i)\\varphi(j)}{(i,j)\\prod_{p|(i,j)}(1-\\frac 1 p)}\\times(i,j)$\n\n$=\\dfrac{\\varphi(i)\\varphi(j)(i,j)}{\\varphi((i,j))}=$ \u7b49\u5f0f\u53f3\u8fb9\n\n\u8bc1\u6bd5\n\n## step 2\uff1a\u5f00\u59cb\u63a8\u5f0f\u5b50\n\n\u7531\u5bf9\u79f0\u6027\uff0c\u4e0d\u59a8\u4ee4 $n\\le m$\n\n$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m\\varphi(ij)\\sigma_0(ij)$\n\n\u4f7f\u7528\u5f15\u7406\u4e8c\u3001\u5f15\u7406\u4e09\n\n$=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m\\dfrac{\\varphi(i)\\varphi(j)(i,j)}{\\varphi((i,j))}\\sum\\limits_{r|(i,j)}\\mu(r)\\sigma_0(\\dfrac i r)\\sigma_0(\\dfrac j r)$\n\n\u679a\u4e3e $(i,j)=k$\n\n$=\\sum\\limits_{k=1}^n\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m\\dfrac{\\varphi(i)\\varphi(j)k}{\\varphi(k)}[(i,j)=k]\\sum\\limits_{r|k}\\mu(r)\\sigma_0(\\dfrac i r)\\sigma_0(\\dfrac j r)$\n\n\u66ff\u6362 $i,j$ \u4e3a $ik,jk$\n\n$=\\sum\\limits_{k=1}^n\\dfrac k{\\varphi(k)}\\sum\\limits_{i=1}^{\\lfloor \\frac n k\\rfloor}\\sum\\limits_{j=1}^{\\lfloor \\frac m k\\rfloor}\\varphi(i)\\varphi(j)[(i,j)=1]\\sum\\limits_{r|k}\\mu(r)\\sigma_0(\\dfrac{ik}r)\\sigma_0(\\dfrac{jk}r)$\n\n\u7b2c\u4e8c\u6b21\u83ab\u53cd\n\n$=\\sum\\limits_{k=1}^n\\dfrac k{\\varphi(k)}\\sum\\limits_{i=1}^{\\lfloor \\frac n k\\rfloor}\\sum\\limits_{j=1}^{\\lfloor \\frac m k\\rfloor}\\varphi(ik)\\varphi(jk)\\sum\\limits_{d|i,d|j}\\mu(d)\\sum\\limits_{r|k}\\mu(r)\\sigma_0(\\dfrac{ik}r)\\sigma_0(\\dfrac{jk}r)$\n\n\u679a\u4e3e\u7ea6\u6570\u53d8\u4e3a\u679a\u4e3e\u500d\u6570\uff0c\u66ff\u6362 $i,j$ \u4e3a $id,jd$\n\n$=\\sum\\limits_{k=1}^n\\dfrac k{\\varphi(k)}\\sum\\limits_{d=1}^{\\lfloor \\frac n k\\rfloor}\\mu(d)\\sum\\limits_{i=1}^{\\lfloor \\frac n{kd}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor \\frac m{kd}\\rfloor}\\sum\\limits_{r|k}\\mu(r)\\sigma_0(\\dfrac{ikd}r)\\sigma_0(\\dfrac{jkd}r)\\varphi(ikd)\\varphi(jkd)$\n\n$=\\sum\\limits_{k=1}^n\\dfrac k{\\varphi(k)}\\sum\\limits_{d=1}^{\\lfloor \\frac n k\\rfloor}\\mu(d)\\sum\\limits_{r|k}\\mu(r)[\\sum\\limits_{i=1}^{\\lfloor \\frac n{kd}\\rfloor}\\sigma_0(\\dfrac{ikd}r)\\varphi(ikd)][\\sum\\limits_{j=1}^{\\lfloor \\frac m{kd}\\rfloor}\\sigma_0(\\dfrac{jkd}r)\\varphi(jkd)]$\n\n\u8bb0 $f(a,b,c)=\\sum\\limits_{i=1}^{\\lfloor \\frac a b\\rfloor}\\sigma_0(\\dfrac{ib}c)\\varphi(ib)$\n\n$=\\sum\\limits_{k=1}^n\\dfrac k{\\varphi(k)}\\sum\\limits_{d=1}^{\\lfloor \\frac n k\\rfloor}\\mu(d)\\sum\\limits_{r|k}\\mu(r)f(n,kd,r)f(m,kd,r)$\n\n$=\\sum\\limits_{r=1}^n\\mu(r)r\\sum\\limits_{k=1}^{\\lfloor\\frac n r\\rfloor}\\dfrac k{\\varphi(kr)}\\sum\\limits_{d=1}^{\\lfloor \\frac n{kr}\\rfloor}\\mu(d)f(n,krd,r)f(m,krd,r)$\n\n\u8fd9\u4e00\u6b65\u540e\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u63a8\uff0c\u6bd4\u5982\u628a $kd$ \u6362\u4e3a $t$ \u7b49\u3002\u4f46\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u6765\u63a8\u4e00\u4e0b\u65f6\u95f4\u590d\u6742\u5ea6\u3002\n\n\u5148\u8003\u8651\u51fd\u6570 $f$\u3002\u5176\u6709\u4e09\u4e2a\u53d8\u91cf\uff1a\u7b2c\u4e00\u4e2a\u53d8\u91cf\u4ee3\u5165\u7684\u662f $n,m$ \u4e3a\u5e38\u6570\uff1b\u7b2c\u4e8c\u4e2a\u53d8\u91cf\u4ee3\u5165\u7684\u662f $krd$ \u548c $n$ \u662f\u540c\u4e00\u6570\u91cf\u7ea7\uff1b\u7b2c\u4e09\u4e2a\u53d8\u91cf\u4ee3\u5165\u7684\u662f $r$\uff0c\u6570\u91cf\u7ea7\u662f\u8c03\u548c\u7ea7\u6570 $O(\\frac 1 1+\\frac 1 2+\\dots+\\frac 1 n)=O(\\log n)$\u3002\u6b64\u5916\uff0c\u8ba1\u7b97 $f$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u662f\u8c03\u548c\u7ea7\u6570\u3002\u7efc\u4e0a\uff0c\u8bb0\u5fc6\u5316 $f$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\log^2 n)$\u3002\n\n\u5176\u6b21\uff0c\u8ba1\u7b97\u5f0f\u5b50\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff1a\u7b2c\u4e00\u5c42\u7684\u679a\u4e3e\u4e3a $O(n)$\uff0c\u7b2c\u4e8c\u5c42\u7684\u679a\u4e3e\u662f\u8c03\u548c\u7ea7\u6570 $O(\\log n)$\uff0c\u7b2c\u4e09\u5c42\u4e5f\u662f\u8c03\u548c\u7ea7\u6570 $O(\\log n)$\u3002\u7efc\u4e0a\uff0c\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\log^2 n)$\u3002\n\n## step 3\uff1a\u7ec6\u8282\n\u5f88\u663e\u7136\uff0c\u5982\u679c\u5355\u7eaf\u8bb0\u5fc6\u5316\u7684\u8bdd\uff0c\u4f60\u5c31\u4f1a[\u559c\u63d0\u5341\u5206](https://www.luogu.com.cn/record/90769487)\u3002\n\n\u4e3a\u4ec0\u4e48\u5462\uff1f\u7b2c\u4e00\uff0c\u5728\u51fd\u6570 $f$ \u4e2d\u5206\u6bcd\u53ef\u4ee5\u6d88\u6389\uff1b\u7b2c\u4e8c\uff0c\u5728\u5faa\u73af\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u7684\u54c8\u5e0c\u8868\u8bb0\u5fc6\u5316\u5f88\u6709\u53ef\u80fd\u4f1a\u88ab\u5361\u6389\u3002\u65e2\u7136\u77e5\u9053\u4e86\u539f\u56e0\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6765\u4f18\u5316\u3002\u4e0d\u5982\u628a\u51fd\u6570 $f$ \u7684\u5b9a\u4e49\u6539\u4e3a $f(a,b,c)=\\sum\\limits_{i=1}^{\\lfloor \\frac a{bc}\\rfloor}\\sigma_0(ib)\\varphi(ibc)$\u3002\n\n\u539f\u5f0f $=\\sum\\limits_{r=1}^n\\mu(r)r\\sum\\limits_{k=1}^{\\lfloor\\frac n r\\rfloor}\\dfrac k{\\varphi(kr)}\\sum\\limits_{d=1}^{\\lfloor \\frac n{kr}\\rfloor}\\mu(d)f(n,kd,r)f(m,kd,r)$\n\n\u6b64\u5916\uff0c\u89c2\u5bdf\u5f0f\u5b50\uff0c\u6211\u4eec\u5148\u679a\u4e3e\u7684\u662f $r$\uff0c\u90a3\u4e48\u5728\u7b2c\u4e00\u5c42\u5faa\u73af\u4e2d\uff0c\u6211\u4eec\u5c31\u53ea\u6709\u7b2c\u4e8c\u4e2a\u53d8\u91cf\u4e0d\u786e\u5b9a\uff0c\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u6240\u6709 $f$\u3002\n\n\u81f3\u6b64\uff0c\u6b64\u9898\u5b8c\u6210\n\n## step 4\uff1a\u9644\u4e0a\u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define F(i,a,b) for(int i(a);i<=b;++i)\n#define R(i,a,b) for(int i(a);i>=b;--i)\n#define _ 0\nusing namespace std;\nconst int MAXN=5e5,MOD=1e9+7;\nint n,m,k,MAX;\nshort mu[MAXN+1];\nint phi[MAXN+1],sigma0[MAXN+1];\nint num[MAXN+1];\nbool v[MAXN+1];\nll a[MAXN+1],b[MAXN+1];\nvector<int>prime;\ninline void pre(){\n    mu[1]=phi[1]=sigma0[1]=1;\n    F(i,2,m){\n        if(!v[i]){prime.push_back(i);mu[i]=-1,phi[i]=i-1,sigma0[i]=2,num[i]=1;}\n        for(int j:prime){\n            ll h=(ll)i*j;\n            if(h>m) break;\n            v[h]=1;\n            if(i%j) mu[h]=-mu[i],phi[h]=phi[i]*phi[j],sigma0[h]=sigma0[i]<<1,num[h]=1;\n            else{\n            \tnum[h]=num[i]+1;\n            \tphi[h]=phi[i]*j,sigma0[h]=sigma0[i]/(num[i]+1)*(num[h]+1);\n            \tbreak;\t\n\t\t\t}\n        }\n    }\n    return;\n}\nll f1[MAXN+1],f2[MAXN+1];\ninline int qpow(ll base,int expo){\n\tll res(1);\n\twhile(expo){\n\t\tif(expo&1) res=res*base%MOD;\n\t\tbase=base*base%MOD;\n\t\texpo>>=1;\n\t}\n\treturn res;\n}\ninline ll solve(int x,int y){\n    ll res(0);\n    F(r,1,x){\n    \tif(!mu[r]) continue;\n    \tF(k,1,n/r){\n\t\t\tf1[k]=f2[k]=0;\n\t\t\tF(d,1,x/(r*k)) f1[k]=(f1[k]+(ll)sigma0[k*d]*phi[k*r*d]%MOD)%MOD;\n\t\t\tF(d,1,y/(r*k)) f2[k]=(f2[k]+(ll)sigma0[k*d]*phi[k*r*d]%MOD)%MOD;\n\t\t}\n    \tF(k,1,x/r){\n    \t\tint inv=qpow(phi[k*r],MOD-2);\n    \t\tF(d,1,x/(r*k)){\n    \t\t\tif(!mu[d]) continue;\n    \t\t\tres=(res+mu[d]*mu[r]*(ll)r*k%MOD*inv%MOD*f1[k*d]%MOD*f2[k*d]%MOD+MOD)%MOD;\n\t\t\t}\n\t\t}\n\t}\n    return res;\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    if(n>m) n=n^m,m=n^m,n=n^m;\n    pre();\n    printf(\"%d\",solve(n,m));\n    return ~~(0^_^0);//\u6bcf\u65e5\u5356\u840c(1/1)\n}\n```\n\u5b8c\u7ed3\u6492\u82b1 awa",
        "postTime": 1666101291,
        "uid": 486559,
        "name": "littlez_meow",
        "ccfLevel": 0,
        "title": "P8570 [JRKSJ R6] \u7275\u8fde\u7684\u4e16\u754c \u9898\u89e3"
    }
]
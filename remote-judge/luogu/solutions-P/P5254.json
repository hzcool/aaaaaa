[
    {
        "content": "[\u53ef\u80fd\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.zybuluo.com/Livingston/note/1794063)\n\n**\u9898\u76ee\u5927\u610f**\uff1a\u6709$N$\u79cd\u957f\u5ea6\u4e3a$L$\u7684\u5b57\u7b26\u4e32\u548c\u4e00\u4e2a\u5339\u914d\u4e32$s$\uff0c\u6bcf\u79cd\u90fd\u6709\u65e0\u6570\u4e2a\uff0c\u73b0\u9009\u51fa$K$**\u4e2a**\u5b57\u7b26\u4e32\uff0c\u4ece\u4e0a\u5230\u4e0b\u6392\u6210\u4e00\u4e2a$K\\times L$\u7684\u5b57\u7b26\u77e9\u9635\uff0c\u4ece\u5de6\u4e0a\u89d2\u5f00\u59cb\uff0c\u4ece\u4e0a\u5230\u4e0b\uff0c\u4ece\u5de6\u5230\u53f3\u987a\u5e8f\u5199\u4e0b\u5404\u4e2a\u5b57\u7b26\uff0c\u5f97\u51fa\u4e00\u4e2a\u957f\u5ea6\u4e3a$K\\times L$\u7684\u5b57\u7b26\u4e32$S$\uff0c\u4e14$s$\u662f$S$\u7684\u5b50\u4e32\uff0c\u6700\u5c0f\u5316$K$\u548c\u4e00\u79cd\u6392\u5217\u65b9\u6848\u3002\n\n\u8003\u8651\u5b57\u7b26\u4e32\u54c8\u5e0c\uff0c\u5c06\u6240\u6709\u5b50\u4e32\u7528**27\u8fdb\u5236**\u538b\u7f29\u5b58\u5230\u54c8\u5e0c\u8868\u4e2d\uff08\u5373\u6bcf\u4e2a\u5b57\u7b26\u4e32\u7684\u4efb\u610f\u4f4d\u7f6e\u5f00\u5934\u548c\u4efb\u610f\u4f4d\u7f6e\u7ed3\u5c3e\uff09\uff0c\u540c\u65f6\u8bb0\u5f55\u6bcf\u4e2a\u4e32\u6240\u5728\u7684\u5b57\u7b26\u4e32\u7684\u7f16\u53f7\u548c\u5f00\u5934\u6240\u5728\u7684\u4f4d\u7f6e\u3002\n\n\u4ece\u5c0f\u5230\u5927\u679a\u4e3e$K$\uff0c\u90a3\u4e48\u7b2c\u4e00\u4e2a\u5408\u6cd5$K$\u5c31\u662f\u7b54\u6848\u3002\u627e\u51fa\u5f53\u524d$K$\u4e0b\u5339\u914d\u4e32$s$\u88ab\u5206\u6210\u7684$K$\u4e2a\u5c0f\u4e32\u3002\n\n\u5982\uff1a$s=\\texttt{abcde},K=3$\n\n3\u4e2a\u5c0f\u4e32\u5206\u522b\u662f$\\texttt{ad},\\texttt{be},\\texttt{c}$\n\n\u5c06\u8fd9$K$\u4e2a\u5c0f\u4e32\u4ee5\u4e0a\u8ff0\u65b9\u6cd5\u538b\u7f29\uff0c\u5728\u54c8\u5e0c\u8868\u4e2d\u67e5\u627e\u3002\n\n\u82e5\u7b2c$i$\u4e2a\u5c0f\u4e32\u5728\u7b2c$u$\u4e2a\u5b57\u7b26\u4e32\u4e2d\uff0c\u5f00\u5934\u5728\u7b2c$j$\u5217\uff0c\u90a3\u4e48$bz(i,j)=u$\uff0c\u8868\u793a\u7b2c$i$\u4e2a\u5c0f\u4e32\u7684\u5f00\u5934\u5728\u7b2c$j$\u5217\u53ef\u4ee5\u5728\u7b2c$u$\u4e2a\u5b57\u7b26\u4e32\u4e2d\u627e\u5230\u3002\n\n\u518d\u679a\u4e3e$s$\u7684\u7b2c\u4e00\u4e2a\u5b50\u4e32\u7684\u5f00\u5934\u7684\u884c$i$\uff0c\u5217$j$\uff0c\u5728$bz$\u4e2d\u67e5\u627e\uff0c\u5982\u679c\u7b2c$j$\u6216\u8005$j+1$\u5217\u90fd\u6709\u5bf9\u5e94\u7684$u$\u503c\uff0c\u90a3\u4e48\u5c31\u662f\u5408\u6cd5\u7b54\u6848\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u4e00\u4e9b$bz(u,j)$\u548c\u53e6\u4e00\u4e9b$bz(u,j+1)$\u90fd\u6709\u503c\uff08$u$\u8868\u793a$s$\u7684\u7b2c$u$\u4e2a\u5b50\u4e32\uff09\uff0c\u90a3\u4e48\u5c31\u5408\u6cd5\uff08$j$\u8fd8\u662f$j+1$\u770b$i$\uff09\u3002\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#define md 2999999\n#define hashmd 5100001 \nusing namespace std;\nint n,l,m,id,now,num,mi[105],pos[505001][2],nxt[505001],head[5100001],hs[5100001],bj[205][205],c[205][205];\nbool flag;\nchar s[105][105],ss[205];\nvoid add(int x,int i,int j)\n{\n\tpos[++num][0]=i;pos[num][1]=j;\n\tnxt[num]=head[x];\n\thead[x]=num;\n}\nvoid hash(int x,int i,int j)\n{\n\tint p=x;\n\twhile (hs[p])\n\t{\n\t\tif (hs[p]==x)\n\t\t{\n\t\t\tadd(p,i,j);\n\t\t\treturn;\n\t\t}\n\t\tp=(p+1)%hashmd;\n\t}\n\ths[p]=x;\n\tadd(p,i,j);\n}\nvoid find(int x,int r)\n{\n\tint p=x;\n\twhile (hs[p])\n\t{\n\t\tif (hs[p]==x)\n\t\t{\n\t\t\tfor (int i=head[x];i;i=nxt[i])\n\t\t\t\tc[r][pos[i][1]]=pos[i][0],bj[r][pos[i][1]]=id;\n\t\t\treturn;\n\t\t}\n\t\tp=(p+1)%hashmd;\n\t}\n}\nint main()\n{\n\tmi[0]=1;\n\tfor (int i=1;i<=100;++i)\n\t\tmi[i]=mi[i-1]*27%md;\n\tscanf(\"%d%d\",&n,&l);\n\tfor (int i=1;i<=n;++i)\n\t{\n\t\tscanf(\"%s\",s[i]+1);\n\t\tfor (int j=1;j<=l;++j)\n\t\t{\n\t\t\tint x=1;\n\t\t\tfor (int k=j;k<=l;++k)\n\t\t\t{\n\t\t\t\tx=(x+(s[i][k]-'a'+1)*mi[k-j+1]%md)%md;\n\t\t\t\thash(x,i,j);\n\t\t\t}\n\t\t}\n\t}\n\tscanf(\"%s\",ss+1);\n\tm=strlen(ss+1);\n\tfor (int k=1;k<=m;++k)\n\t{\n\t\t++id;\n\t\tfor (int j=1;j<=k;++j)\n\t\t{\n\t\t\tint x=1,ln=0;\n\t\t\tnow=j;\n\t\t\twhile (now<=m)\n\t\t\t{\n\t\t\t\tx=(x+(ss[now]-'a'+1)*mi[++ln]%md)%md;\n\t\t\t\tnow+=k;\t\n\t\t\t}\n\t\t\tfind(x,j);\t\n\t\t} \n\t\tfor (int i=1;i<=k;++i)\n\t\t{\n\t\t\tint h=k-i+1;\n\t\t\tfor (int j=1;j<=l;++j)\n\t\t\t{\n\t\t\t\tflag=true;\n\t\t\t\tfor (int u=1;u<=k;++u)\n\t\t\t\t{\n\t\t\t\t\tif ((u<=h&&bj[u][j]<id)||(u>h&&bj[u][j+1]<id))\n\t\t\t\t\t{\n\t\t\t\t\t\tflag=false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (flag)\n\t\t\t\t{\n\t\t\t\t\tprintf(\"%d\\n\",k);\n\t\t\t\t\tfor (int u=h+1;u<=k;++u) printf(\"%d \",c[u][j+1]);\n\t\t\t\t\tfor (int u=1;u<=h;++u) printf(\"%d \",c[u][j]);\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"-1\\n\");\n\treturn 0;\n}\n```\n\n\n\n\u611f\u8c22LZA\u7684\u535a\u5ba2\u63d0\u4f9b\u7684\u5e2e\u52a9\uff0cORZ\uff1a\n\nhttps://blog.csdn.net/qq_39565901/article/details/87472261",
        "postTime": 1620182328,
        "uid": 166078,
        "name": "Thunder_S",
        "ccfLevel": 6,
        "title": "[P5254]\u300cJSOI2013\u300d\u300e\u5b57\u7b26\u4e32\u54c8\u5e0c\u300f\u300e\u679a\u4e3e\u300f\u5e7f\u544a\u8ba1\u5212"
    }
]
[
    {
        "content": "\u663e\u7136\u4e00\u4e2a\u683c\u5b50\u4e0a\u7684\u6570\u53ea\u80fd\u5230\u8fbe\u6a2a\u5411\u548c\u7ad6\u5411\u7ffb\u8f6c\u540e\u5bf9\u79f0\u7684 $4$ \u4e2a\u683c\u5b50\u3002\n\n\u8003\u8651\u8fd9\u6837\u4e00\u4e2a\u201c\u7b49\u4ef7\u7c7b\u201d\u4e2d\u7684 $4$ \u4e2a\u6570 $a,b,c,d$\uff0c\u5982\u4f55\u80fd\u5728\u4e0d\u5f71\u54cd\u5176\u4ed6\u683c\u5b50\u7684\u6570\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u5b83\u4eec\u4e4b\u95f4\u7684\u7f6e\u6362\u3002\n\n\u7b80\u5355\u8003\u8651\u53d1\u73b0\uff0c\u6211\u4eec\u53ef\u4ee5\u4ee5\u987a\u65f6\u9488\u6216\u9006\u65f6\u9488\u65b9\u5411\u65cb\u8f6c\u5176\u4e2d\u4efb\u610f\u4e09\u4e2a\u683c\u5b50\uff0c\u5177\u4f53\u505a\u6cd5\u662f\u5f62\u5982 $\\texttt{URU'R'}$\uff0c\u8fd9\u6709\u70b9\u7c7b\u4f3c\u4e09\u9636\u9b54\u65b9\u4e2d\u7684\u9876\u9762\u4e09\u68f1\u6362\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u7b97\u51fa\u8fd9\u4e9b\u53ef\u80fd\u7684\u7f6e\u6362\u4f5c\u7528\u4e8e $\\begin{bmatrix} a\\quad b\\\\ c\\quad d\\end{bmatrix}$ \u4e0a\u7684\u7f6e\u6362\u7fa4\uff0c\u4f8b\u5982 $\\begin{bmatrix} b\\quad a\\\\ c\\quad d\\end{bmatrix}$ \u8fd9\u6837\u662f\u65e0\u6cd5\u751f\u6210\u7684\uff0c\u800c $\\begin{bmatrix} b\\quad a\\\\ d\\quad c\\end{bmatrix}$ \u662f\u53ef\u4ee5\u751f\u6210\u7684\u3002\n\n\u4e8b\u5b9e\u4e0a\u6211\u4eec\u53ea\u9700\u5148\u5c06 $a$ \u6362\u5230\u5de6\u4e0a\u89d2\uff0c\u7136\u540e\u770b\u770b\u5269\u4e0b\u7684\u4e09\u4e2a\u662f\u4e0d\u662f\u9006\u65f6\u9488\u6392\u5217\u4e3a $b,c,d$ \u7684\u5373\u53ef\u3002\n\n\u90a3\u4e48\u672c\u9898\u7684\u505a\u6cd5\u5982\u4e0b\uff1a\n\n- \u5148\u5c06\u56db\u4e2a\u89d2\u8fd8\u539f\uff0c\u6b64\u65f6\u53ef\u4ee5\u968f\u4fbf\u64cd\u4f5c\uff0c\u53ea\u8981\u56db\u4e2a\u89d2\u5bf9\u4e0a\u5c31\u53ef\u4ee5\u4e86\uff1b\n\n- \u518d\u5c06\u56db\u6761\u8fb9\u8fd8\u539f\uff0c\u4f46\u6b64\u65f6\u4e0d\u80fd\u52a8\u89d2\u5757\uff0c\u4f8b\u5982\u8fd8\u539f\u4e0a\u4e0b\u8fb9\u65f6\u4fdd\u8bc1\u8fdb\u884c\u884c\u7ffb\u8f6c\u5076\u6570\u6b21\uff0c\u800c\u5de6\u53f3\u8fb9\u65f6\u4fdd\u8bc1\u8fdb\u884c\u5217\u7ffb\u8f6c\u5076\u6570\u6b21\uff1b\n\n- \u518d\u5c06\u4e2d\u95f4\u8fd8\u539f\uff0c\u53ea\u80fd\u6309\u7167\u4e0a\u9762\u6240\u8bf4\u7684\u51e0\u79cd\u7f6e\u6362\u590d\u5408\u6765\u5b9e\u73b0\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int MAXN=110;\nint t,n,m,cnt,a[MAXN][MAXN],md[MAXN*MAXN*10][2];\nint hs (int x,int y) {return (x-1)*m+y;}\nvoid trip (int x,int y,int t) {\n\tif (t==1) {\n\t\tcnt++;\n\t\tmd[cnt][0]=2,md[cnt][1]=y;\n\t\tcnt++;\n\t\tmd[cnt][0]=1,md[cnt][1]=x;\n\t\tcnt++;\n\t\tmd[cnt][0]=2,md[cnt][1]=y;\n\t\tcnt++;\n\t\tmd[cnt][0]=1,md[cnt][1]=x;\n\t\tswap(a[x][y],a[x][m-y+1]);\n\t\tswap(a[x][y],a[n-x+1][y]);\n\t} else if (t==2) {\n\t\tcnt++;\n\t\tmd[cnt][0]=1,md[cnt][1]=x;\n\t\tcnt++;\n\t\tmd[cnt][0]=2,md[cnt][1]=m-y+1;\n\t\tcnt++;\n\t\tmd[cnt][0]=1,md[cnt][1]=x;\n\t\tcnt++;\n\t\tmd[cnt][0]=2,md[cnt][1]=m-y+1;\n\t\tswap(a[x][y],a[n-x+1][m-y+1]);\n\t\tswap(a[x][m-y+1],a[n-x+1][m-y+1]);\n\t} else if (t==3) {\n\t\tcnt++;\n\t\tmd[cnt][0]=1,md[cnt][1]=n-x+1;\n\t\tcnt++;\n\t\tmd[cnt][0]=2,md[cnt][1]=y;\n\t\tcnt++;\n\t\tmd[cnt][0]=1,md[cnt][1]=n-x+1;\n\t\tcnt++;\n\t\tmd[cnt][0]=2,md[cnt][1]=y;\n\t\tswap(a[x][y],a[n-x+1][y]);\n\t\tswap(a[n-x+1][y],a[n-x+1][m-y+1]);\n\t} else {\n\t\tcnt++;\n\t\tmd[cnt][0]=2,md[cnt][1]=m-y+1;\n\t\tcnt++;\n\t\tmd[cnt][0]=1,md[cnt][1]=n-x+1;\n\t\tcnt++;\n\t\tmd[cnt][0]=2,md[cnt][1]=m-y+1;\n\t\tcnt++;\n\t\tmd[cnt][0]=1,md[cnt][1]=n-x+1;\n\t\tswap(a[x][m-y+1],a[n-x+1][m-y+1]);\n\t\tswap(a[x][m-y+1],a[n-x+1][y]);\n\t}\n\treturn;\n}\nint solve (int x,int y,int t) {\n\tint uu=a[x][y],vv=a[x][m-y+1],xx=a[n-x+1][y],yy=a[n-x+1][m-y+1];\n\tint tmp1[5],tmp2[5];\n\ttmp1[1]=uu,tmp1[2]=vv,tmp1[3]=xx,tmp1[4]=yy;\n\ttmp2[1]=hs(x,y),tmp2[2]=hs(x,m-y+1),tmp2[3]=hs(n-x+1,y),tmp2[4]=hs(n-x+1,m-y+1);\n\tsort(tmp1+1,tmp1+5);\n\tsort(tmp2+1,tmp2+5);\n\tfor (int i=1;i<=4;i++) {if (tmp1[i]!=tmp2[i]) {return 0;}}\n\tint u=(uu>vv)+(uu>xx)+(uu>yy)+1,v=(vv>uu)+(vv>xx)+(vv>yy)+1;\n\tint xxx=(xx>uu)+(xx>vv)+(xx>yy)+1,yyy=(yy>uu)+(yy>vv)+(yy>xx)+1;\n\tif (v==1) {\n\t\ttrip(x,y,2),trip(x,y,2);\n\t} else if (xxx==1) {\n\t\ttrip(x,y,1);\n\t} else if (yyy==1) {\n\t\ttrip(x,y,2);\n\t}\n\tuu=a[x][y],vv=a[x][m-y+1],xx=a[n-x+1][y],yy=a[n-x+1][m-y+1];\n\tu=(uu>vv)+(uu>xx)+(uu>yy)+1,v=(vv>uu)+(vv>xx)+(vv>yy)+1;\n\txxx=(xx>uu)+(xx>vv)+(xx>yy)+1,yyy=(yy>uu)+(yy>vv)+(yy>xx)+1;\n\tif (xxx==2) {\n\t\ttrip(x,y,4);\n\t} else if (yyy==2) {\n\t\ttrip(x,y,4),trip(x,y,4);\n\t}\n\tuu=a[x][y],vv=a[x][m-y+1],xx=a[n-x+1][y],yy=a[n-x+1][m-y+1];\n\tu=(uu>vv)+(uu>xx)+(uu>yy)+1,v=(vv>uu)+(vv>xx)+(vv>yy)+1;\n\txxx=(xx>uu)+(xx>vv)+(xx>yy)+1,yyy=(yy>uu)+(yy>vv)+(yy>xx)+1;\n\tif (xxx==3) {return 1;}\n\tif (t==0) {return 0;}\n\tif (t==1) {\n\t\tcnt++;\n\t\tmd[cnt][0]=1,md[cnt][1]=n-x+1;\n\t\tfor (int i=1;i<=m/2;i++) {swap(a[n-x+1][i],a[n-x+1][m-i+1]);}\n\t} else {\n\t\tcnt++;\n\t\tmd[cnt][0]=2,md[cnt][1]=y;\n\t\tfor (int i=1;i<=n/2;i++) {swap(a[i][y],a[n-i+1][y]);}\n\t\ttrip(x,y,3);\n\t}\n\treturn 1;\n}\nvoid print () {\n\tfor (int i=1;i<=n;i++) {\n\t\tfor (int j=1;j<=m;j++) {\n\t\t\tprintf(\"%d \",a[i][j]);\n\t\t}\n\t\tprintf(\"\\n\");\n\t}\n\tprintf(\"\\n\");\n\treturn;\n}\nint main () {\n\tscanf(\"%d\",&t);\n\tfor (int ii=1;ii<=t;ii++) {\n\t\tscanf(\"%d%d\",&n,&m); \n\t\tswap(n,m);\n\t\tcnt=0;\n\t\tfor (int i=1;i<=n;i++) {\n\t\t\tfor (int j=1;j<=m;j++) {\n\t\t\t\tscanf(\"%d\",&a[i][j]);\n\t\t\t}\n\t\t}\n\t\tint flg=0;\n\t\tif (n!=1&&m!=1) {\n\t\t\t\n\t\tfor (int i=1;i<=n/2;i++) {\n\t\t\tif (!solve(i,1,1)) {flg=1;break;}\n\t\t}\n\t\tfor (int j=2;j<=m/2;j++) {\n\t\t\tif (!solve(1,j,2)) {flg=1;break;}\n\t\t}\n\t\t\n\t\t}\n\t\t//print();\n\t\tfor (int i=2;i<=n/2;i++) {\n\t\t\tif (flg) {break;}\n\t\t\tfor (int j=2;j<=m/2;j++) {\n\t\t\t\tif (!solve(i,j,0)) {\n\t\t\t\t\tflg=1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t//print();\n\t\tif (n%2==1) {\n\t\t\tint flg2=1,rw=(n+1)/2;\n\t\t\tfor (int i=1;i<=m;i++) {\n\t\t\t\tif (a[rw][i]!=hs(rw,i)) {flg2=0;break;}\n\t\t\t}\n\t\t\tif (!flg2) {\n\t\t\t\tflg2=1;\n\t\t\t\tfor (int i=1;i<=m;i++) {\n\t\t\t\t\tif (a[rw][i]!=hs(rw,m-i+1)) {flg2=0,flg=1;break;}\n\t\t\t\t}\n\t\t\t\tif (flg2) {\n\t\t\t\t\tcnt++;\n\t\t\t\t\tmd[cnt][0]=1,md[cnt][1]=rw;\n\t\t\t\t\tfor (int i=1;i<=m/2;i++) {swap(a[rw][i],a[rw][m-i+1]);}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (m%2==1) {\n\t\t\tint flg2=1,col=(m+1)/2;\n\t\t\tfor (int i=1;i<=n;i++) {\n\t\t\t\tif (a[i][col]!=hs(i,col)) {flg2=0;break;}\n\t\t\t}\n\t\t\tif (!flg2) {\n\t\t\t\tflg2=1;\n\t\t\t\tfor (int i=1;i<=n;i++) {\n\t\t\t\t\tif (a[i][col]!=hs(n-i+1,col)) {flg2=0,flg=1;break;}\n\t\t\t\t}\n\t\t\t\tif (flg2) {\n\t\t\t\t\tcnt++;\n\t\t\t\t\tmd[cnt][0]=2,md[cnt][1]=col;\n\t\t\t\t\tfor (int i=1;i<=n/2;i++) {swap(a[i][col],a[n-i+1][col]);}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (flg) {\n\t\t\tprintf(\"IMPOSSIBLE\\n\");\n\t\t} else {\n\t\t\tprintf(\"POSSIBLE %d\",cnt);\n\t\t\tfor (int i=1;i<=cnt;i++) {\n\t\t\t\tif (md[i][0]==1) {printf(\" R%d\",md[i][1]);}\n\t\t\t\telse {printf(\" C%d\",md[i][1]);}\n\t\t\t}\n\t\t\tprintf(\"\\n\");\n\t\t}\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1623734086,
        "uid": 113546,
        "name": "ix35",
        "ccfLevel": 10,
        "title": "[CERC2013] Rubik's Rectangle \u9898\u89e3"
    }
]
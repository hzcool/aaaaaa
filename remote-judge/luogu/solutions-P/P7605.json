[
    {
        "content": "\u770b\u5b8c\u9898\u76ee\u540e\u5bb9\u6613\u60f3\u5230\u533a\u95f4 Dp\u3002\n\n\u8bbe $g_{l,r}$ \u8868\u793a\u533a\u95f4 $[l,r]$ \u7684\u7b54\u6848\uff08\u5305\u542b\u6700\u5c11\u7684\u5269\u7684\u548c\u6700\u5c0f\u6808\u5927\u5c0f\u4e24\u4e2a\u4fe1\u606f\uff09\uff0c\u6700\u540e $g_{1,n}$ \u5c31\u662f\u7b54\u6848\u3002\n## $g$ \u7684\u8f6c\u79fb\n\n\u6211\u4eec\u5047\u8bbe\u7b2c\u4e00\u6b65\u5148\u9009\u6700\u5de6\u8fb9\uff08\u53f3\u8fb9\u540c\u7406\uff09\u3002\n\n### situation 1. \n\u76f4\u63a5\u628a\u6700\u5de6\u8fb9\u7136\u540e\u4e0d\u7ba1\u5b83\uff0c\u8f6c\u79fb\u5f0f\u4e3a\uff1a\n$$g_{l,r}=g_{l+1,r}+(1,1)$$\n### situation 2.\n\u8003\u8651\u8ba9\u6700\u5de6\u8fb9\u7684\u503c\u53bb\u548c\u4e2d\u95f4\u7684\u67d0\u4e00\u4e2a\u76f8\u540c\u503c\u62b5\u6d88\uff0c\u679a\u4e3e $i(c_i=c_l)$\uff0c\u73b0\u5728\u6211\u4eec\u8981\u8ba9 $c_i,c_l$ \u62b5\u6d88\n\n#### situation 2.1\n$[i+1,r]$ \u5fc5\u987b\u8981\u4ed9\u8d1d\u9009\u5230\u6808\u4e2d\u4e14\u8981\u88ab\u5b8c\u5168\u6d88\u9664\uff0c\u4f46\u662f\u6211\u4eec\u4e5f\u6709\u53ef\u80fd\u518d\u7528\u5de6\u8fb9\u7684\u4e00\u6bb5\u6765\u5e2e\u52a9\u5b83\u6d88\u9664\uff0c\u5047\u8bbe\u7528\u4e86 $[l+1,j](j<i)$ \u6765\u5e2e\u52a9\u5b83\u5220\u9664\u3002\n\u90a3\u4e48\u6211\u4eec\u8bbe $f_{l_1,r_1,l_2,r_2}$ \u8868\u793a\u5c06 $[l_1,r_1,l_2,r_2]$ **\u5b8c\u5168\u5220\u9664**\u81f3\u5c11\u9700\u8981\u591a\u5927\u7684\u6808\uff0c\u6b64\u65f6\u7684 $g_{l,r}$ \u53ef\u4ee5\u7531 $g_{j+1,i-1}$ \u548c $f_{l+1,j,i+1,r}$ \u8f6c\u79fb\u5f97\u5230\uff0c\u753b\u6210\u793a\u610f\u56fe\u5927\u6982\u662f\u8fd9\u4e2a\u6837\u5b50\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/a750awkg.png?x-oss-process=image/resize,m_lfit,h_250,w_500)\n\n#### situation 2.2\n\n$[l+1,i-1]$ \u5fc5\u987b\u8981\u4ed9\u8d1d\u9009\u5230\u6808\u4e2d\u4e14\u8981\u88ab\u5b8c\u5168\u5220\u9664\uff0c\u4f46\u662f\u6211\u4eec\u4e5f\u6709\u53ef\u80fd\u518d\u7528\u53f3\u8fb9\u7684\u4e00\u6bb5\u6765\u5e2e\u52a9\u5b83\u6d88\u9664\uff0c\u5047\u8bbe\u7528\u4e86 $[j,r](j>i)$ \u6765\u5e2e\u52a9\u5b83\u5220\u9664\u3002\n\u90a3\u4e48\u6b64\u65f6 $g_{l,r}$ \u53ef\u4ee5\u7531 $g_{i+1,j-1}$ \u548c $f_{l+1,i-1,j,r}$ \u8f6c\u79fb\u5f97\u5230\u3002\n\n## $f$ \u7684\u8f6c\u79fb\n\u540c\u7406\uff0c\u8003\u8651\u679a\u4e3e\u4ece\u54ea\u8fb9\u5f00\u59cb\u5220\uff0c\u679a\u4e3e\u76f8\u540c\u7684\u6570\u7684\u4f4d\u7f6e\u7136\u540e\u679a\u4e3e\u8f85\u52a9\u5220\u9664\u7684 $j$ \u7684\u4f4d\u7f6e\u8f6c\u79fb\u5373\u53ef\uff0c\u7406\u89e3\u4e86\u4e0a\u9762\u7684\u8f6c\u79fb\u4e0b\u9762\u662f\u4e00\u6a21\u4e00\u6837\u7684\u3002\n\n\u8fd9\u4e2a\u7b97\u6cd5\u7684\u590d\u6742\u5ea6\u662f $O(n^6)$ \u7684\uff0c\u4f46\u662f\u56e0\u4e3a $f$ \u7684\u8f6c\u79fb\u4e2d\uff0c$r_2-l_2+r_1-l_1\\bmod 2=0$ \u5426\u5219\u65e0\u89e3\u8fd9\u4e2a\u9650\u5236\uff0c\u5e38\u6570\u5927\u7ea6\u53ef\u4ee5\u7f29\u51cf $\\dfrac{1}{4}$ \u5de6\u53f3\uff0c\u540c\u65f6 $[l_1,r_1,l_2,r_2]$ \u8fd9\u4e2a\u533a\u95f4\u5fc5\u987b\u8981\u5c06\u533a\u95f4\u4e2d\u7684\u6570\u4e24\u4e24\u914d\u5bf9\u624d\u6709\u53ef\u80fd\u6d88\u9664\uff0c\u8fd9\u4e2a\u5730\u65b9\u4e5f\u53ef\u4ee5\u4f7f\u5e38\u6570\u5927\u5927\u51cf\u5c0f\uff0c\u53ea\u8981\u7528\u4e00\u4e2a Hash \u6216\u8005\u4f60\u9884\u5904\u7406\u4e00\u4e0b\u5c31\u884c\u4e86\uff0c\u771f\u6b63\u7684\u590d\u6742\u5ea6\u4e3a $O(\u53ef\u8fc7)$\uff0c~~\u538b\u884c\u4ee3\u7801~~\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define pr pair<int,int>\n#define mp make_pair\n#define fi first\n#define se second\nusing namespace std;\nconst int inf=0x3f3f3f3f;\nint n,c[55],h[55],s[55];\nint f[55][55][55][55];\npr g[55][55];\npr operator+(pr a,pr b){return mp(a.fi+b.fi,a.se+b.se);}\nint F(int l1,int r1,int l2,int r2) {\n\tif(l1>r1&&l2>r2)return 0;\n\tif((r1-l1+r2-l2&1)||(s[l1-1]^s[r1]^s[l2-1]^s[r2]))return inf;\n\tif(l1>r1)l1=1,r1=0;if(l2>r2)l2=1,r2=0;\n\tint &ans=f[l1][r1][l2][r2];if(ans)return ans;ans=inf;\n\tfor(int i=l1; i<=r1; ++i) {\n\t\tif(i!=l1&&c[i]==c[l1])for(int j=l2-1; j<=r2; ++j)ans=min(ans,max(max(F(l1+1,i-1,j+1,r2)+1,2),F(i+1,r1,l2,j)));\n\t\tif(l2<=r2&&c[i]==c[r2])for(int j=l2-1; j<r2; ++j)ans=min(ans,max(max(F(l1,i-1,j+1,r2-1)+1,2),F(i+1,r1,l2,j)));\n\t}\n\tfor(int i=l2; i<=r2; ++i) {\n\t\tif(i!=r2&&c[i]==c[r2])for(int j=r1+1; j>=l1; --j)ans=min(ans,max(max(F(l1,j-1,i+1,r2-1)+1,2),F(j,r1,l2,i-1)));\n\t\tif(l1<=r1&&c[i]==c[l1])for(int j=r1+1; j>l1; --j)ans=min(ans,max(max(F(l1+1,j-1,i+1,r2)+1,2),F(j,r1,l2,i-1)));\n\t} return ans;\n}\npr G(int l,int r) {\n\tif(g[l][r].se)return g[l][r];\n\tif(l>r)return mp(0,0);\n\tpr &ans=g[l][r];ans=mp(inf,inf);\n\tans=min(ans,min(G(l+1,r)+mp(1,1),G(l,r-1)+mp(1,1)));\n\tfor(int i=l; i<=r; ++i) {\n\t\tif(i!=l&&c[i]==c[l]) {\n\t\t\tfor(int j=l+1,tmp; j<=r; ++j)\n\t\t\t\tif((tmp=F(l+1,min(i,j)-1,max(i,j)+1,r))<inf) {\n\t\t\t\t\tpr wer=(i>=j)?G(j,i-1):G(i+1,j);\n\t\t\t\t\tans=min(ans,mp(wer.fi,max(wer.se,max(2,tmp+1))));\n\t\t\t\t}\n\t\t}\n\t\tif(i!=r&&c[i]==c[r]) {\n\t\t\tfor(int j=l,tmp; j<=r-1; ++j)\n\t\t\t\tif((tmp=F(l,min(i,j)-1,max(i,j)+1,r-1))<inf) {\n\t\t\t\t\tpr wer=(i>=j)?G(j,i-1):G(i+1,j);\n\t\t\t\t\tans=min(ans,mp(wer.fi,max(wer.se,max(2,tmp+1))));\n\t\t\t\t}\n\t\t}\n\t}\n\treturn ans;\n}\nint main() {\n\tcin>>n,srand((unsigned)time(NULL));\n\tfor(int i=1; i<=n; ++i)cin>>c[i],h[i]=rand();\n\tfor(int i=1; i<=n; ++i)s[i]=s[i-1]^h[c[i]];\n\tcout<<G(1,n).fi<<\" \"<<G(1,n).se<<\"\\n\";\n\treturn 0;\n}\n```\n",
        "postTime": 1623752467,
        "uid": 112569,
        "name": "Time_tears",
        "ccfLevel": 9,
        "title": "[THUPC2021] \u5c0f E \u7231\u6d88\u9664"
    },
    {
        "content": "\u8003\u8651\u533a\u95f4 dp\uff0c\u8bb0\u4e8c\u5143\u7ec4 $f(l,r)$ \u8868\u793a\u53ea\u8003\u8651\u533a\u95f4 $[l,r]$ \u5185\u7684\u5c0f\u7403\u65f6\u7684\u7b54\u6848\u3002\n\n\u679a\u4e3e\u7b2c\u4e00\u6b21\u53d6\u7684\u662f $c_l$ \u8fd8\u662f $c_r$\uff0c\u6ce8\u610f\u5230\u4e24\u79cd\u60c5\u51b5\u662f\u5bf9\u79f0\u7684\uff0c\u53ea\u5206\u6790\u53d6 $c_l$ \u7684\u60c5\u51b5\u3002\n\n- \u5982\u679c $c_l$ \u672a\u6765\u4f1a\u548c\u67d0\u4e2a\u4e1c\u897f\u5339\u914d\u540e\u6d88\u5931\uff0c\u4e0d\u59a8\u8bb0\u4f5c $c_k$\uff0c\u4ecd\u679a\u4e3e $k>l$ \u548c $k<l$ \u7684\u60c5\u51b5\u3002\n  - \u82e5 $k>l$\uff0c\u5219 $[l+1,k-1]$ \u4e4b\u95f4\u7684\u7403\u5e94\u8be5\u80fd\u548c\u53e6\u4e00\u7aef\u7684\u82e5\u5e72\u7403\u5b8c\u5168\u6d88\u9664\uff0c\u4e0d\u59a8\u8bbe\u4e3a $[j,r]$\uff0c\u5176\u4e2d\u6ee1\u8db3 $i<j\\leq r + 1$\uff0c\u5176\u4e2d $j=r+1$ \u8868\u793a\u4e0d\u9700\u8981\u53d6\u53f3\u8fb9\u7684\u7403\u3002\u663e\u7136\uff0c\u6211\u4eec\u5e0c\u671b\u5728\u5168\u90e8\u6d88\u9664\u7684\u65f6\u5019\u4efb\u610f\u65f6\u523b\u6808\u5927\u5c0f\u6700\u5c0f\uff0c\u56e0\u6b64\u8003\u8651\u8bb0\u8f85\u52a9\u6570\u7ec4 $g(i,j,k,l)$\uff0c\u5176\u4e2d\u6ee1\u8db3 $i\\leq j+1,k\\leq l+1,j\\leq k$\uff0c\u8868\u793a\u5b8c\u5168\u6d88\u9664 $[i,j]$ \u548c $[k,l]$ \u4e4b\u95f4\u7684\u7403\u7684\u4efb\u610f\u65f6\u523b\u6700\u5c0f\u6700\u5927\u6808\u3002\u6b64\u65f6\uff0c$f(l,r)$ \u80fd\u4ece $g(l+1,i-1,j,r)$ \u4ee5\u53ca $f(i+1,j-1)$ \u8f6c\u79fb\u3002\n  - $k<l$\uff0c\u663e\u7136\u662f\u5bf9\u79f0\u7684\uff0c\u4eff\u7167\u62df\u5408\u5373\u53ef\u3002\n- \u5982\u679c $c_l$ \u4e0d\u4f1a\u88ab\u6d88\u9664\u4e86\uff0c\u90a3\u4e48\u76f4\u63a5\u4ece $f(l+1,r)$ \u8f6c\u79fb\u5373\u53ef\u3002\n\n\u73b0\u5728\u8003\u8651\u6c42 $g(i,j,k,l)$\uff0c\u6ce8\u610f\u5230\u5f53\u5de6\u8fb9\u6216\u8005\u53f3\u8fb9\u6ca1\u6709\u7403\u65f6\uff08\u5373 $i>j$ \u6216 $k>l$\uff09\uff0c\u8fc7\u7a0b\u662f\u552f\u4e00\u7684\uff0c\u6a21\u62df\u8ba1\u7b97\u5373\u53ef\u3002\n\n\u8003\u8651 $c_i$ \u4f1a\u548c\u8c01\u5339\u914d\u6d88\u9664\uff0c\u8bb0\u4f5c $c_u$\uff0c\u4ecd\u7136\u5206 $u\\in[i+1,j],u\\in[k,l]$ \u8ba8\u8bba\u3002\n\n- \u5982\u679c $u\\in [i+1,j]$\uff0c\u5219 $[i+1,u-1]$ \u4e4b\u95f4\u7684\u4e1c\u897f\u4e5f\u8981\u5168\u6d88\uff0c\u8fd9\u4e2a\u4e1c\u897f\u76f8\u5f53\u4e8e\u4e00\u4e2a\u5b50\u95ee\u9898\uff0c\u540c\u65f6\u6211\u4eec\u679a\u4e3e\u4e00\u4e2a\u53f3\u4fa7\u7684\u5206\u754c\u70b9 $v$\uff0c\u5c06 $g(i,j,k,l)$ \u4ece $g(i+1,u-1,v,l)$ \u548c $g(u+1,j,k,v-1)$ \u8f6c\u79fb\u3002\n- \u5982\u679c $u\\in[k,l]$\uff0c\u540c\u6837\u5bf9\u79f0\u3002\n\n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\uff0c\u590d\u6742\u5ea6 $\\mathcal{O}(n^6)$\u3002\n\n\u4e8b\u5b9e\u4e0a\uff0c\u6211\u4eec\u4ecd\u9700\u8981\u4e00\u4e9b\u9488\u5bf9 $g$ \u8f6c\u79fb\u7684\u5c0f\u5c0f\u7684\u526a\u679d\uff1a\n\n- \u5982\u679c $[i,j],[k,l]$ \u4e2d\u6bcf\u79cd\u989c\u8272\u51fa\u73b0\u7684\u6b21\u6570\u4e0d\u662f\u5076\u6570\uff0c\u53ef\u4ee5\u4e0d\u8f6c\u79fb\u3002\u8fd9\u4e2a\u53ef\u4ee5\u7528\u54c8\u5e0c\u5b9e\u73b0\u3002\n\n\u5b98\u65b9\u9898\u89e3\u8bf4\u5e38\u6570\u5927\u7ea6\u662f $\\frac{1}{720}$\uff0c\u6211\u4e0d\u4f1a\u7b97\u3002\n\n\u5b8c\u7ed3\u6492\u82b1 qwq.",
        "postTime": 1679280777,
        "uid": 340803,
        "name": "InoueTakina",
        "ccfLevel": 0,
        "title": "[THUPC2021] \u5c0f E \u7231\u6d88\u9664 \u9898\u89e3\u62a5\u544a"
    }
]
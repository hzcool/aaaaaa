[
    {
        "content": "[$\\text{Link}$](https://www.luogu.com.cn/problem/P4100)\n\n$\\text{Update2023.4.13}$\uff1a\u4fee\u590d\u4e00\u4e2a\u9519\u8bef\u3002\n## \u9898\u610f\n\u7ed9 $n$ \u4e2a\u7ebf\u6027\u65e0\u5173\u7684\u5411\u91cf\u96c6 $A_1,A_2\\cdot\\cdot\\cdot A_n$ \u548c\u4e00\u4e2a\u5411\u91cf\u96c6 $B_1,B_2\\cdot\\cdot\\cdot B_n$\uff0c\u6c42\u5b57\u5178\u5e8f\u6700\u5c0f\u7684\u6392\u5217 $p$ \u4f7f\u5f97\u5c06\u4efb\u610f\u7684\u4e00\u4e2a $A_i$ \u66ff\u6362\u4e3a $B_{p_i}$ \u540e\uff0c\u65b0\u7684\u5411\u91cf\u96c6\u4f9d\u7136\u7ebf\u6027\u65e0\u5173\u3002\n\n$n\\le300$\u3002\n## \u601d\u8def\n\u5148\u4ecb\u7ecd\u4e00\u4e0b\u57fa\u7840\u77e5\u8bc6\uff0c\u4f1a\u7684\u53ef\u4ee5\u8df3\u8fc7\u8fd9\u4e00\u6bb5\u3002\n\n**\u7ebf\u6027\u7ec4\u5408**\uff1a\u8bbe\u5728\u57df $P$ \u4e2d\u6709\u5411\u91cf\u96c6 $A_1,A_2\\cdot\\cdot\\cdot A_n$\uff0c\u82e5\u6709\u5411\u91cf $B=\\sum_{i=1}^n k_iA_i$\uff0c\u5176\u4e2d $k\\in P$\uff0c\u5219 $B$ \u662f\u5411\u91cf\u96c6 $A$ \u7684\u4e00\u4e2a\u7ebf\u6027\u7ec4\u5408\u3002\n\n**\u7ebf\u6027\u76f8\u5173\uff0c\u7ebf\u6027\u65e0\u5173**\uff1a\u8bbe\u5728\u57df $P$ \u4e2d\u6709\u5411\u91cf\u96c6 $A_1,A_2\\cdot\\cdot\\cdot A_{n}$\uff0c\u82e5\u6709\u4e00\u5411\u91cf $A_x$ \u4e3a\u5269\u4f59 $n-1$ \u4e2a\u5411\u91cf\u7684\u7ebf\u6027\u7ec4\u5408\uff0c\u5219\u79f0\u8fd9 $n$ \u4e2a\u5411\u91cf\u7ebf\u6027\u76f8\u5173\uff1b\u53cd\u4e4b\uff0c\u5219\u79f0\u8fd9 $n$ \u4e2a\u5411\u91cf\u7ebf\u6027\u65e0\u5173\u3002\n\n**\u5b9a\u7406** \u82e5\u6709 $n$ \u7ef4\u5411\u91cf\u96c6 $A_1,A_2\\cdot\\cdot\\cdot A_{n}$ \u7ebf\u6027\u65e0\u5173\uff0c\u5219\u6240\u6709 $n$ \u7ef4\u5411\u91cf\u90fd\u53ef\u8868\u793a\u4e3a\u5176\u7ebf\u6027\u7ec4\u5408\u3002\n\n\u5373 $n$ \u5143 $1$ \u6b21\u65b9\u7a0b\u7ec4\uff0c\u6709 $n$ \u4e2a\u65b9\u7a0b\uff0c\u53ef\u89e3\u51fa\u552f\u4e00\u89e3 $k_1,k_2\\cdot\\cdot\\cdot k_n$\u3002\n\n\u56de\u5230\u8fd9\u9898\uff0c\u6211\u4eec\u6784\u5efa\u77e9\u9635\uff1a\n\n$A=\\begin{bmatrix}A_1,A_2,\\cdot \\cdot \\cdot A_n\\end{bmatrix},B=\\begin{bmatrix}B_1,B_2,\\cdot \\cdot \\cdot B_n\\end{bmatrix}$\u3002\n\n\u7531\u4e8e $B_{i,j}=\\sum_{k=1}^n R_{i,k}A_{k,j}$\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u8f6c\u6362\u7cfb\u6570 $R$ \u4e5f\u770b\u505a\u77e9\u9635\uff0c\u5219\u6709 $B=RA$\uff0c$R=BA^{-1}$\u3002\n\n\u6b64\u65f6\u82e5 $R_{i,j}\\ne0$\uff0c\u5219 $A_i$ \u53ef\u4ee5\u8f6c\u4e3a $B_j$\uff1b\u53cd\u4e4b\u5219\u4e0d\u80fd\uff0c\u56e0\u4e3a $R_{i,j}=0$ \u65f6\uff0c$B_j$ \u662f $A_1\\cdot\\cdot\\cdot A_{i-1}A_{i+1}\\cdot\\cdot\\cdot A_n$ \u7684\u7ebf\u6027\u7ec4\u5408\u3002\n\n\u90a3\u4e48\u5f53 $R_{i,j}\\ne0$ \u65f6\uff0c\u7531 $i$ \u5411 $j$ \u8fde\u8fb9\u5efa\u7acb\u4e8c\u5206\u56fe\u3002\n\n\u5269\u4f59\u7684\u95ee\u9898\u5c31\u662f\u4e8c\u5206\u56fe\u6700\u5c0f\u5b57\u5178\u5e8f\u5b8c\u7f8e\u5339\u914d\u3002\u53ef\u4ee5\u5148\u8dd1\u51fa\u4e00\u7ec4\u5339\u914d\uff0c\u518d\u4f7f\u5b57\u5178\u5e8f\u6700\u5c0f\u3002\n\n\u5219\u5728\u539f\u5339\u914d\u4e2d\u6709\u4e00\u6761\u589e\u5e7f\u8def\u5f84\u7684\u73af\u4e0a\u6709\u8fb9 $(u,v)$ \u65f6 $(u,v)$ \u7684\u5339\u914d\u5408\u6cd5\uff0c\u4e8e\u662f\u627e\u5230\u6700\u5c0f\u7684\u73af\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3)$\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nnamespace IO{//by cyffff\n\t\n}\nconst int N=300+10; \nconst double eps=1e-7;\nint n;\nstruct Matrix{\n\tdouble a[N][N];\n\tinline double* operator[](const int &x){\n\t\treturn a[x];\n\t}\n\tMatrix(){\n\t\tmemset(a,0,sizeof(a));\n\t}\n\tinline void epsilon(){\n\t\tfor(int i=1;i<=n;i++)\n\t\t\ta[i][i]=1;\n\t}\n\tinline friend Matrix operator*(const Matrix &a,const Matrix &b){\n\t\tMatrix c;\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tfor(int j=1;j<=n;j++)\n\t\t\t\tfor(int k=1;k<=n;k++)\n\t\t\t\t\tc[i][j]+=a.a[i][j]*b.a[j][k]; \n\t\treturn c;\n\t}\n\tinline void swapp(int i,int j){\n\t\tswap(a[i],a[j]);\n\t}\n}a,b,r;\nint match[N];\nbool vis[N];\ninline bool dfs(int x){\n\tfor(int t=1;t<=n;t++){\n\t\tif(!vis[t]&&fabs(r[x][t])>eps){\n\t\t\tvis[t]=true;\n\t\t\tif(!match[t]||dfs(match[t])){\n\t\t\t\tmatch[t]=x;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\ninline int dfs(int x,int tp){\n\tfor(int t=1;t<=n;t++){\n\t\tif(!vis[t]&&fabs(r[x][t])>eps){\n\t\t\tvis[t]=true;\n\t\t\tif(match[t]==tp||(match[t]>tp&&dfs(match[t],tp))){\n\t\t\t\tmatch[t]=x;\n\t\t\t\treturn t;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\nint main(){\n\tn=read();\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=n;j++)\n\t\t\ta[j][i]=(double)read();\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tb[j][i]=(double)read();\n\tr.epsilon();\n\tfor(int i=1;i<=n;i++){\n\t\tint k=i;\n\t\tfor(int j=i+1;j<=n;j++)\n\t\t\tif(fabs(a[j][i])>fabs(a[k][i]))\n\t\t\t\tk=j;\n\t\tif(fabs(a[k][i])<eps){\n\t\t\tputs(\"NIE\");\n\t\t\treturn 0;\n\t\t}\n\t\tif(k!=i)\n\t\t\ta.swapp(i,k),\n\t\t\tb.swapp(i,k);\n\t\tdouble x=a[i][i];\n\t\tfor(int j=1;j<=n;j++){\n\t\t\ta[i][j]/=x,b[i][j]/=x;\n\t\t}\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tif(i!=j){\n\t\t\t\tdouble res=a[j][i];\n\t\t\t\tfor(int k=1;k<=n;k++)\n\t\t\t\t\ta[j][k]-=a[i][k]*res,\n\t\t\t\t\tb[j][k]-=b[i][k]*res;\n\t\t\t}\n\t}\n\tr=b;\n\tfor(int i=1;i<=n;i++){\n\t\tmemset(vis,0,sizeof(vis));\n\t\tif(!dfs(i))\n\t\t\treturn puts(\"NIE\"),0;\n\t}\n\tputs(\"TAK\");\n\tfor(int i=1;i<=n;i++){\n\t\tmemset(vis,0,sizeof(vis));\n\t\twrite(dfs(i,i)),putc('\\n');\n\t}\n\tflush();\n}\n```\n\u518d\u89c1 qwq~",
        "postTime": 1625809586,
        "uid": 365127,
        "name": "cyffff",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4100\u3010[HEOI2013]\u9499\u94c1\u950c\u7852\u7ef4\u751f\u7d20\u3011"
    },
    {
        "content": "\u9898\u610f\uff1a\u7ed9\u5b9an\u4e2a\u7ebf\u6027\u65e0\u5173\u7684\u5411\u91cf`A[1..n]`(\u5982\u679c\u4e0d\u662f\u7ebf\u6027\u65e0\u5173\u76f4\u63a5\u8f93\u51fa\u65e0\u89e3\u5373\u53ef),\u53e6\u5916n\u4e2a\u5411\u91cf`B[1..n]`\uff0c\u6c42\u80fd\u5426\u7ed9A\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5411\u91cf\u9009\u62e9\u4e00\u4e2aB\u4e2d\u7684\u5907\u7528\u5411\u91cf\uff0c\u4f7f\u5f97\u4efb\u610f\u4e24\u4e2a\u5907\u7528\u5411\u91cf\u5728B\u4e2d\u7f16\u53f7\u4e0d\u540c\uff0c\u4e14A\u4e2d\u7684\u4e00\u4e2a\u5411\u91cf\u7684\u5907\u7528\u5411\u91cf\u548cA\u4e2d\u5176\u4f59\u5411\u91cf\u7ebf\u6027\u65e0\u5173\u3002\n\n\u663e\u7136\u53ef\u4ee5\u5148\u5bf9A\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5411\u91cf\u786e\u5b9a\u54ea\u4e9b\u5411\u91cf\u53ef\u4ee5\u5907\u7528\uff0c\u7136\u540e\u8dd1\u4e00\u4e2a\u4e8c\u5206\u56fe\u6700\u5c0f\u5b57\u5178\u5e8f\u5b8c\u7f8e\u5339\u914d\u5373\u53ef\u3002\u6ca1\u6709\u5b8c\u7f8e\u5339\u914d\u5219\u65e0\u89e3\u3002\n\n\u9996\u5148\u53ef\u4ee5\u8003\u8651\u4e00\u4e2a\u7cfb\u6570\u77e9\u9635V,`V[i][j]`\u8868\u793a\u201cB\u4e2d\u7b2ci\u4e2a\u5411\u91cf\u7528A\u7684\u7ebf\u6027\u7ec4\u5408\u8868\u793a\u65f6\uff0cA[j]\u9879\u7684\u7cfb\u6570\u201d\u3002\u5bb9\u6613\u8bc1\u660e`A[i]`\u53ef\u4ee5\u4f7f\u7528`B[j]`\u4f5c\u4e3a\u5907\u7528\u5411\u91cf\u5f53\u4e14\u4ec5\u5f53$V_{ji}\\ne 0$\u3002\uff08\u5982\u679c$V_{ji}=0$,`B[j]`\u662fA\u4e2d\u5176\u4f59\u5411\u91cf\u7684\u7ebf\u6027\u7ec4\u5408\uff1b\u5426\u5219\u53ef\u4ee5\u79fb\u4e00\u4e0b\u9879\u628aA[i]\u7528B[j]\u8868\u793a\uff09\n\n\u53ef\u4ee5\u5199\u51fa\u4e00\u4e2a\u7b49\u5f0f\uff1a$$B_{ij}=\\sum_{k=1}^n{V_{ik}A_{kj}}$$\u5373$$B=VA;V=BA^{-1}$$\n\u6240\u4ee5\u77e9\u9635\u6c42\u9006\u5373\u53ef\u3002\u4e0d\u4f1a\u77e9\u9635\u6c42\u9006\u53ef\u4ee5\u770b[\u6211\u7684\u535a\u5ba2](https://www.luogu.org/blog/474D/solution-p4783)\n\n\u4f46\u662f\u8fd9\u91cc\u4e0d\u4f1a\u77e9\u9635\u6c42\u9006\u4e5f\u6ca1\u6709\u5173\u7cfb\u3002\u53ef\u4ee5\u5728\u628aA\u548cB\u62fc\u6210\u4e00\u4e2a`2n*n`\u7684\u77e9\u9635\uff08\u8fd8\u662f\u53eb\u77e9\u9635A\uff09\uff0c\u9ad8\u65af\u6d88\u5143\u7684\u540c\u65f6\u7ef4\u62a4\u4e00\u4e0b\u5f53\u524d\u7684`A[i]`\u7531\u521d\u59cb\u7684`A[1..n]`\u7ebf\u6027\u7ec4\u5408\u8868\u793a\u7684\u5404\u9879\u7cfb\u6570\u3002\u590d\u6742\u5ea6\u8fd8\u662f$O(n^3)$\u3002\uff08\u4e5f\u8bb8\u8fd9\u4e2a\u7b97\u6cd5\u672c\u8d28\u4e0a\u5c31\u662f\u4f34\u968f\u77e9\u9635\uff1f\uff09\n\n\u7136\u540e\u9700\u8981\u6c42\u4e8c\u5206\u56fe\u6700\u5c0f\u5b57\u5178\u5e8f\u5b8c\u7f8e\u5339\u914d\u3002\u6211\u4e00\u5f00\u59cb\u89c9\u5f97\u5148\u8dd1\u4e00\u4e2aDinic\uff0c\u7136\u540e\u9000\u6d41\u5c31\u884c\u4e86\uff0c\u4f46\u662f\u9000\u6d41\u597d\u50cf\u4e0d\u80fd\u51ed\u7a7a\u52a0\u5165\u4e00\u6761\u65b0\u7684\u5339\u914d\u8fb9\u3002\u6240\u4ee5\u6211\u6700\u540e\u5199\u4e86\u4e00\u4e2a\u7c7b\u4f3c\u5308\u7259\u5229\u7684\u65b9\u6cd5\uff0c\u7ef4\u62a4\u5f53\u524d\u54ea\u4e9b\u70b9\u7684\u5339\u914d\u5df2\u7ecf\u88ab\u56fa\u5b9a\u4e86\uff0c\u627e\u5230\u4e00\u6761\u4e0d\u7ecf\u8fc7\u5df2\u56fa\u5b9a\u7684\u70b9\u7684\u4ea4\u9519\u8def\uff08\u8fd9\u91cc\u5176\u5b9e\u662f\u4e00\u4e2a\u73af\uff09\uff0c\u7136\u540e\u589e\u5e7f\u3002\u590d\u6742\u5ea6\u4ecd\u7136\u662f$O(n^3)$\uff0c\u5b9e\u9645\u8dd1\u7684\u98de\u5feb\u3002\n\nC++11\u4ee3\u7801\uff1a\n```cpp\n// luogu-judger-enable-o2\n#include<bits/stdc++.h>\nusing namespace std;\nint n,vis[610];\ndouble a[610][310],b[610][310],sm[610];\nstruct Dinic{\n    struct edge{int v,cap;};\n    vector<edge> e,e1;\n    vector<int> v[610];\n    int dis[610],cur[610],que[610],f[610],s,t;\n    void addEdge(int x,int y){\n        e.insert(e.end(),{{y,1},{x}});\n        v[x].push_back(e.size()-2);\n        v[y].push_back(e.size()-1);\n    }\n    int bfs(int s,int t){\n        int l=1,r=1;\n        memset(dis,0x3f,sizeof dis);\n        que[1]=s;dis[s]=0;\n        while(l<=r){\n            int p=que[l++];\n            for(int i:v[p])if(e[i].cap && !vis[e[i].v] && dis[e[i].v]>1e9)\n                f[e[i].v]=i^1,dis[e[i].v]=dis[p]+1,que[++r]=e[i].v;\n        }\n        return dis[t]<1e9;\n    }\n    void wtf(int x,int y){\n        for(int p=x;p!=y;p=e[f[p]].v)e[f[p]].cap=1,e[f[p]^1].cap=0;\n    }\n    int dfs(int p,int a){\n        if(p==t || !a)return a;\n        int f,to,fl=0;\n        for(int&i=cur[p];i<(int)v[p].size();++i){\n            edge &E=e[v[p][i]];\n            if(dis[to=E.v]==dis[p]+1 && (f=dfs(to,min(a,E.cap)))){\n                fl+=f,a-=f,e[v[p][i]^1].cap+=f,E.cap-=f;\n                if(!a)break;\n            }\n        }\n        return fl;\n    }\n    int dinic(int s,int t){\n        this->s=s,this->t=t;\n        int f=0;\n        while(bfs(s,t))\n            memset(cur,0,sizeof cur),f+=dfs(s,1e9);\n        return f;\n    }\n}sol;\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=0;i<2*n;i++)\n        for(int j=0;j<n;j++)\n            scanf(\"%lf\",a[i]+j);\n    for(int i=0;i<n;i++)\n        b[i][i]=1,sol.addEdge(2*n,i),sol.addEdge(i+n,2*n+1);\n    for(int i=0;i<n;i++){\n        double mx=-1;int mp;\n        for(int j=0;j<2*n;j++)if(!vis[j]){\n            sm[j]=0;\n            for(int k=0;k<n;k++)\n                sm[j]+=b[j][k]*a[k][i];\n            if(j<n){if(fabs(sm[j])>mx)mx=fabs(sm[j]),mp=j;}\n            else sm[j]+=a[j][i];\n        }\n        if(mx<1e-10){puts(\"NIE\");return 0;}\n        vis[mp]=1;\n        for(int j=0;j<2*n;j++)if(!vis[j] && fabs(sm[j])>1e-10)\n            for(int k=0;k<n;k++)\n                b[j][k]-=b[mp][k]*sm[j]/sm[mp];\n    }\n    for(int i=n;i<2*n;i++)\n        for(int j=0;j<n;j++)if(fabs(b[i][j])>1e-10)\n            sol.addEdge(j,i);\n    memset(vis,0,sizeof vis);\n    if(sol.dinic(2*n,2*n+1)<n){puts(\"NIE\");return 0;}\n    puts(\"TAK\");\n    vis[2*n]=1;\n    for(int i=0,to;i<n;i++)\n        for(int j:sol.v[i])if(!vis[to=sol.e[j].v]&&(!sol.e[j].cap||sol.bfs(to,i))){\n            printf(\"%d\\n\",to-n+1);vis[to]=1;\n            if(sol.e[j].cap)\n                sol.wtf(i,to),sol.e[j].cap=0,sol.e[j^1].cap=1;\n            break;\n        }\n    return 0;\n}\n```",
        "postTime": 1549520814,
        "uid": 30093,
        "name": "cosmicAC",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4100 \u3010[HEOI2013]\u9499\u94c1\u950c\u7852\u7ef4\u751f\u7d20 \u3011"
    },
    {
        "content": "\u9898\u76ee\u5927\u610f\uff1a\u6709 $n$ \u4e2a\u5411\u91cf $A_1,A_2,\\dots,A_n$\uff0c\u53ca $n$ \u4e2a\u5411\u91cf $B_1,B_2,\\dots,B_n$\uff0c\u6c42**\u5b57\u5178\u5e8f\u6700\u5c0f**\u7684**\u6392\u5217** $p$\uff0c\u4f7f\u5f97\u5c06**\u67d0\u4e00\u4e2a** $A_i$ \u6362\u6210 $B_{p_i}$ \u540e\u8fd9 $n$ \u4e2a\u5411\u91cf\u7ebf\u6027\u65e0\u5173\u3002  \n\n\u8bbe\u77e9\u9635 $A=\\begin{bmatrix}A_1\\\\A_2\\\\\\dots\\\\A_n\\end{bmatrix}$\uff0c$B=\\begin{bmatrix}B_1\\\\B_2\\\\\\dots\\\\B_n\\end{bmatrix}$\uff0c$C_{i,j}$ \u8868\u793a\u5c06 $B_i$ \u7528 $A_1,A_2,\\dots,A_n$ \u7684\u7ebf\u6027\u7ec4\u5408\u8868\u793a\u65f6\u6bcf\u4e00\u9879\u7684\u7cfb\u6570\u3002   \n\n\u5219\u7531\u5b9a\u4e49\u5f97 $B_i=\\sum_j C_{i,j}A_j \\Rightarrow B=CA$\uff0c\u4e8e\u662f $C=BA^{-1}$\u3002   \n\n\u663e\u7136\u6709 $C_{i,j}\\not=0$ \u65f6 $A_j$ \u53ef\u4ee5\u7528 $B_i$ \u66ff\u6362\uff0c\u5426\u5219\u4e0d\u884c\u3002\u56e0\u4e3a\u82e5 $C_{i,j}=0$\uff0c\u90a3\u4e48 $B_i$ \u662f $A_1,A_2,\\dots,A_{j-1},A_{j+1},\\dots,A_n$ \u7684\u7ebf\u6027\u7ec4\u5408\uff0c\u4e0d\u6ee1\u8db3\u8981\u6c42\u3002   \n\n____\n\uff08\u4ee5\u4e0b\u4e00\u6bb5\u4e0e\u89e3\u9898\u601d\u8def\u65e0\u5173\uff0c\u4ec5\u5173\u4e4e\u7b97\u6cd5\u5b9e\u73b0\uff0c\u53ef\u4ee5\u5148\u8df3\u8fc7\uff09  \n\n\u8003\u8651\u6c42 $C=BA^{-1}$\uff0c\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u8ba9 $A$ \u548c $B$ \u540c\u65f6\u53f3\u4e58\u4e00\u4e2a $A^{-1}$\uff0c\u4ea6\u5373\u7c7b\u4f3c\u77e9\u9635\u6c42\u9006\uff0c\u5c06 $A$ \u9ad8\u65af\u6d88\u5143\u6210\u5355\u4f4d\u77e9\u9635 $I$ \u65f6\u5bf9 $B$ \u8fdb\u884c\u540c\u6837\u64cd\u4f5c\u3002  \n\n\u7136\u800c\u5982\u679c\u4f60\u8fd9\u4e48\u505a\u4e86\u4f60\u4f1a\u53d1\u73b0\u8fd9\u662f\u5047\u7684\u3002\u7a76\u5176\u539f\u56e0\uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u5e73\u65f6\u5199\u7684\u9ad8\u65af\u6d88\u5143\u90fd\u662f\u505a\u521d\u7b49\u884c\u53d8\u6362\uff08\u4ea4\u6362\u4e24\u884c\u7b49\uff09\uff0c\u800c\u521d\u7b49\u884c\u53d8\u6362\u76f8\u5f53\u4e8e\u5de6\u4e58\u77e9\u9635\uff0c\u6240\u4ee5\u5176\u5b9e\u6c42\u51fa\u4e86 $A^{-1}B$\u3002  \n\n\u8fd9\u65f6\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5c06\u9ad8\u65af\u6d88\u5143\u6539\u6210\u521d\u7b49\u5217\u53d8\u6362\uff0c\u5c06 $B$ \u63a5\u5230 $A$ \u7684\u4e0b\u9762\u505a\uff0c\u7531\u4e8e\u521d\u7b49\u5217\u53d8\u6362\u662f\u53f3\u4e58\u77e9\u9635\uff0c\u4e8e\u662f\u6c42\u5f97\u7684\u5c31\u662f $BA^{-1}$ \u4e86\u3002\n\n\u4f46\u662f\u5176\u5b9e\u6211\u4eec\u4e5f\u53ef\u4ee5\u8003\u8651\u5bf9 $A,B,C$ \u5168\u90e8\u8f6c\u7f6e\uff0c\u91cd\u65b0\u5b9a\u4e49 $A=\\begin{bmatrix}A_1&A_2&\\dots&A_n\\end{bmatrix}$\uff0c$B=\\begin{bmatrix}B_1&B_2&\\dots&B_n\\end{bmatrix}$\uff0c\u8fd9\u6837\u65b0\u7684 $C=A^{-1}B$\u3002\u4e8e\u662f\u5c31\u53ef\u4ee5\u76f4\u63a5\u9ad8\u65af\u6d88\u5143\u4e86\u3002\u800c\u4e14\u8fd9\u65f6\u7684 $C_{i,j}$ \u6070\u597d\u8868\u793a\u7684\u662f $A_i$ \u662f\u5426\u53ef\u4ee5\u66ff\u6362\u4e3a $B_j$\uff0c\u6bd4\u8f83\u7b26\u5408\u6b63\u5e38\u601d\u7ef4\u3002\n\n____\n\uff08\u4ee5\u4e0b $C_{i,j}$ \u8868\u793a $A_i$ \u662f\u5426\u53ef\u4ee5\u66ff\u6362\u4e3a $B_j$\uff09  \n\n\u65e2\u7136\u6211\u4eec\u5df2\u7ecf\u6c42\u51fa\u4e86 $C_{i,j}$\uff0c\u90a3\u4e48\u5269\u4e0b\u7684\u95ee\u9898\u5c31\u662f\u6c42\u4e00\u4e2a\u4ece $A$ \u5230 $B$ \u7684\u5b57\u5178\u5e8f\u6700\u5c0f\u7684\u4e8c\u5206\u56fe\u6ee1\u5339\u914d\u3002\n\n\u9996\u5148\u6211\u4eec\u7528\u5308\u7259\u5229\u7b97\u6cd5\u5148\u6c42\u51fa\u4efb\u610f\u4e00\u4e2a\u5339\u914d\uff0c\u7136\u540e\u6211\u4eec\u8003\u8651\u600e\u6837\u4f7f\u5f97\u5b83\u5b57\u5178\u5e8f\u6700\u5c0f\u3002\n\n\u6211\u4eec\u4ece\u5c0f\u5230\u5927\u8003\u8651\u7b2c $i$ \u4f4d\u4e0a\u7684\u5339\u914d\u6700\u5c0f\u662f\u591a\u5c11\u3002\u8003\u8651\u4f55\u65f6\u4e00\u4e2a\u5339\u914d $(u,v)$ \u5408\u6cd5\u3002\u53d1\u73b0\u5f53\u4e14\u4ec5\u5f53\u539f\u6ee1\u5339\u914d\u5b58\u5728\u4e00\u6761\u589e\u5e7f\u8def\uff08\u663e\u7136\u662f\u4e2a\u73af\uff09\u5305\u542b\u8fb9 $(u,v)$\u3002\u4e8e\u662f\u6211\u4eec\u4ece\u5c0f\u5230\u5927\u627e\u8fd9\u6837\u7684\u6700\u5c0f\u7684\u4e00\u4e2a\u5408\u6cd5\u589e\u5e7f\u8def\u73af\u5c31\u662f\u7b54\u6848\u3002\n\n\u4ee3\u7801\n```cpp\n#include<cstdio>\n#include<cmath>\n#include<cstring>\nconst int N=310;\nconst double eps=1e-8;\nint n,c[N];\ndouble a[N][N],b[N][N];\nbool vis[N];\ninline void swap(double &x, double &y){double t=x;x=y;y=t;}\nint dfs(int u,int t=0)\n{\n\tfor(int v=1;v<=n;v++)if(fabs(b[u][v])>eps&&!vis[v])\n\t{\n\t\tvis[v]=true;\n\t\tif(c[v]==t||(c[v]>t&&dfs(c[v],t)))return c[v]=u,v;\n\t}\n\treturn 0;\n}\nint main()\n{\n\tint i,j,k,mx;double x;scanf(\"%d\",&n);\n\tfor(i=1;i<=n;i++)for(j=1;j<=n;j++)scanf(\"%lf\",&a[j][i]);\n\tfor(i=1;i<=n;i++)for(j=1;j<=n;j++)scanf(\"%lf\",&b[j][i]);\n\tfor(i=1;i<=n;i++)\n\t{\n\t\tmx=i;\n\t\tfor(j=i+1;j<=n;j++)if(fabs(a[j][i])>fabs(a[mx][i]))mx=j;\n\t\tif(fabs(a[mx][i])<=eps)return puts(\"NIE\"),0;\n\t\tif(mx!=i)for(j=1;j<=n;j++)swap(a[i][j],a[mx][j]),swap(b[i][j],b[mx][j]);\n\t\tfor(j=1,x=a[i][i];j<=n;j++)a[i][j]/=x,b[i][j]/=x;\n\t\tfor(j=1;j<=n;j++)if(j!=i)for(x=a[j][i],k=1;k<=n;k++)\n\t\ta[j][k]-=a[i][k]*x,b[j][k]-=b[i][k]*x;\n\t}\n\tfor(i=1;i<=n;i++)if(memset(vis,0,sizeof vis),!dfs(i))return puts(\"NIE\"),0;\n\tputs(\"TAK\");for(i=1;i<=n;i++)memset(vis,0,sizeof vis),printf(\"%d\\n\",dfs(i,i));\n\treturn 0;\n}\n```",
        "postTime": 1625662625,
        "uid": 35137,
        "name": "a___",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4100 [HEOI2013]\u9499\u94c1\u950c\u7852\u7ef4\u751f\u7d20"
    },
    {
        "content": "#### \u9898\u76ee\u5927\u610f\n\n\u7ed9\u51fa\u4e00\u4e2a\u6b63\u6574\u6570 $n$\uff0c\u7136\u540e\u7ed9\u51fa $n$ \u4e2a $A$ \u7c7b $n$ \u7ef4\u5411\u91cf\u4ee5\u53ca $n$ \u4e2a $B$ \u7c7b $n$ \u7ef4\u5411\u91cf\uff0c\u4fdd\u8bc1 $A$ \u7c7b\u5411\u91cf\u4e4b\u95f4\u7ebf\u6027\u65e0\u5173\u3002\u73b0\u5728\u9700\u8981\u7ed9\u6bcf\u4e2a $A$ \u7c7b\u5411\u91cf\u90fd\u4ece $B$ \u7c7b\u5411\u91cf\u4e2d\u9009\u62e9\u4e00\u4e2a\u5907\u7528\u5411\u91cf\uff0c\u8981\u6c42\u8be5\u5411\u91cf\u88ab\u5907\u7528\u5411\u91cf\u66ff\u6362\u4e4b\u540e\uff0c\u5f62\u6210\u7684\u65b0\u7684 $n$ \u4e2a $A$ \u7c7b\u5411\u91cf\u4e4b\u95f4\u4ecd\u7136\u7ebf\u6027\u65e0\u5173\u3002\u4efb\u610f\u4e24\u4e2a $A$ \u7c7b\u5411\u91cf\u7684\u5907\u7528\u5411\u91cf\u90fd\u4e0d\u80fd\u76f8\u540c\u3002\u8bf7\u6c42\u51fa\u662f\u5426\u6709\u89e3\uff0c\u5728\u6709\u89e3\u7684\u60c5\u51b5\u4e0b\u6c42\u5b57\u5178\u5e8f\u6700\u5c0f\u7684\u65b9\u6848\u3002\n\n#### \u9898\u89e3\n\n\u95ee\u9898\u7684\u5b9e\u8d28\u662f\u6c42\u51fa\u4efb\u610f\u4e24\u4e2a $A,B$ \u7c7b\u5411\u91cf\u4e4b\u95f4\u80fd\u5426\u66ff\u6362\uff0c\u5982\u679c\u53ef\u4ee5\u5c31\u8fde\u8fb9\uff0c\u6700\u540e\u8dd1\u4e00\u4e2a\u6700\u5c0f\u5b57\u5178\u5e8f\u7684\u4e8c\u5206\u56fe\u5339\u914d\u5373\u53ef\u3002\n\n\u5bf9\u4e8e\u8fd9\u4e2a\u9898\u76ee\uff0c\u56e0\u4e3a\u6c42\u7684\u5339\u914d\u5fc5\u987b\u662f\u5b8c\u7f8e\u5339\u914d\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5148\u6c42\u51fa\u4e00\u4e2a\u666e\u901a\u7684\u5b8c\u7f8e\u5339\u914d\uff0c\u7136\u540e\u5f3a\u5236\u8ba9\u67d0\u4e2a\u70b9\u8ddf\u4e00\u4e2a\u5b57\u5178\u5e8f\u66f4\u5c0f\u7684\u70b9\u5339\u914d\uff0c\u8fd9\u6837\u5b50\u64cd\u4f5c\u7684\u8bdd\u4f1a\u9020\u6210\u5de6\u53f3\u5404\u4e00\u4e2a\u70b9\u5931\u914d\u3002\u7136\u540e\u628a\u8fd9\u4e2a\u5931\u914d\u70b9\u518d\u589e\u5e7f\u4e00\u6b21\uff0c\u5982\u679c\u53ef\u4ee5\u589e\u5e7f\uff0c\u90a3\u4e48\u589e\u5e7f\u4e4b\u540e\u4ecd\u7136\u5f62\u6210\u4e86\u4e00\u4e2a\u5b8c\u7f8e\u5339\u914d\uff0c\u8bc1\u660e\u8fd9\u6b21\u4fee\u6539\u662f\u5408\u6cd5\u7684\uff0c\u5426\u5219\u5c31\u4e0d\u5408\u6cd5\u3002\u6700\u7ec8\u5c31\u53ef\u4ee5\u6c42\u5f97\u4e00\u4e2a\u6700\u5c0f\u5b57\u5178\u5e8f\u7684\u5b8c\u7f8e\u5339\u914d\u3002\n\n\u90a3\u4e48\u73b0\u5728\u5c31\u53ea\u9700\u8981\u8003\u8651\u524d\u4e00\u4e2a\u95ee\u9898\u3002\u56e0\u4e3a $A$ \u7c7b\u5411\u91cf\u4e4b\u95f4\u662f\u7ebf\u6027\u65e0\u5173\u7684\uff0c\u6240\u4ee5\u4f7f\u7528 $A$ \u7c7b\u5411\u91cf\u53ef\u4ee5\u552f\u4e00\u8868\u793a\u4efb\u610f\u7684\u4e00\u4e2a $n$ \u7ef4\u5411\u91cf\uff0c\u5f53\u7136\u5176\u4e2d\u4e5f\u5305\u62ec\u6240\u6709\u7684 $B$ \u7c7b\u5411\u91cf\u3002\n\n\u8003\u8651\u5bf9\u4e8e\u4e00\u4e2a $B$ \u7c7b\u5411\u91cf $B_i$\uff0c\u5b83\u7b49\u4e8e $k_1A_1+k_2A_2...+k_nA_n$\u3002\u90a3\u4e48 $B_i$ \u53ef\u4ee5\u66ff\u6362 $A_j$ \u5f53\u4e14\u4ec5\u5f53 $k_j\\not=0$\u3002\n\n\u8bc1\u660e\u5982\u4e0b\uff1a\u82e5 $k_j=0$\uff0c\u90a3\u4e48\u7528 $B_i$ \u66ff\u6362 $A_j$ \u540e\uff0c$B_i$ \u4ecd\u7136\u53ef\u4ee5\u88ab\u5269\u4e0b\u7684\u5411\u91cf\u8868\u793a\uff0c\u90a3\u4e48\u5c31\u4e0d\u662f\u7ebf\u6027\u65e0\u5173\u7684\uff0c\u4e0e\u9898\u610f\u4e0d\u7b26\u3002\u82e5 $k_j\\not= 0$\uff0c\u90a3\u4e48\u5728 $A$ \u7c7b\u5411\u91cf\u4e2d\u5220\u53bb $A_j$ \u540e\uff0c\u5269\u4e0b\u7684\u5411\u91cf\u65e0\u6cd5\u8868\u793a $B_i$\u3002\u4e14\u901a\u8fc7\u79fb\u9879\uff0c\u6709 $k_1A_1+k_2A_2+...+k_nA_n-B_i=k_jA_j$\uff0c\u5373 $A_j$ \u53ef\u4ee5\u88ab\u65b0\u7684 $A$ \u7c7b\u5411\u91cf\u8868\u793a\uff0c\u90a3\u4e48\u5bf9\u4e8e\u4e4b\u524d $A$ \u7c7b\u5411\u91cf\u8868\u793a\u7684\u4efb\u610f\u4e00\u4e2a $n$ \u7ef4\u5411\u91cf\uff0c\u65b0\u7684 $A$ \u7c7b\u5411\u91cf\u4e5f\u53ef\u4ee5\u8868\u793a\uff0c\u53ea\u8981\u628a $k_jA_j$ \u6309\u6bd4\u4f8b\u6362\u6210 $k_1A_1+k_2A_2+...+k_nA_n-B_i$ \u5373\u53ef\uff0c\u6545\u65b0\u7684 $A$ \u7c7b\u5411\u91cf\u662f\u7ebf\u6027\u65e0\u5173\u7684\u3002\n\n\u73b0\u5728\u5c31\u53ea\u9700\u8981\u6c42\u600e\u4e48\u7528 $A$ \u7c7b\u5411\u91cf\u53bb\u8868\u793a\u6bcf\u4e2a $B$ \u7c7b\u5411\u91cf\u4e86\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u628a $A$ \u7c7b\u5411\u91cf\u653e\u5230\u4e00\u4e2a\u77e9\u9635\u91cc\u9762\u53bb\uff0c\u7136\u540e\u7528\u8fd9\u4e2a\u77e9\u9635\u4e58\u4e0a\u4e00\u4e2a\u7cfb\u6570\u77e9\u9635\u5f97\u5230\u4e00\u4e2a $B$ \u7c7b\u5411\u91cf\u6784\u6210\u7684\u77e9\u9635\u3002\n\n\u4e00\u822c\u7684\uff0c\u6211\u4eec\u4e60\u60ef\u4e8e\u628a\u5411\u91cf\u7ad6\u7740\u653e\uff0c\u8bbe\u7cfb\u6570\u77e9\u9635\u4e3a $R$\uff0c$A=[A_1,A_2...A_n]$\uff0c$B=[B_1,B_2...B_n]$\uff0c\u90a3\u4e48\u6709 $A\\times R=B$\u3002\u663e\u7136\uff0c $R$ \u7684\u6bcf\u4e2a\u5217\u5411\u91cf $R_i$ \u5c31\u662f\u7528 $A$ \u7c7b\u5411\u91cf\u8868\u793a $B_i$ \u7684\u5404\u9879\u7cfb\u6570\u3002\n\n\u8003\u8651\u600e\u4e48\u6c42\uff0c\u56e0\u4e3a\u6709 $A\\times R=B$\uff0c\u90a3\u4e48\u53ef\u4ee5\u4e0d\u65ad\u5de6\u4e58\u521d\u7b49\u77e9\u9635\uff0c\u8bbe\u5176\u4e3a $E_1...E_m$\uff0c\u4f7f\u5f97 $E_1\\times...\\times E_m\\times A=I$\uff0c\u90a3\u4e48\u5c31\u6709 $E_1\\times...\\times E_m\\times A\\times R=I\\times R=R=E_1\\times...\\times E_m\\times B$\u3002\u5c31\u53ef\u4ee5\u6c42\u5f97 $R$\u3002\n\n\u8bf4\u5f97\u901a\u4fd7\u4e00\u70b9\uff0c\u5de6\u4e58\u4e00\u4e2a\u521d\u7b49\u77e9\u9635\u76f8\u5f53\u4e8e\u662f\u521d\u7b49\u884c\u53d8\u6362\uff0c\u90a3\u4e48\u5b9e\u9645\u4e0a\u5c31\u662f\u628a $A$ \u7528\u521d\u7b49\u884c\u53d8\u6362\u53d8\u6210 $I$\uff0c\u4e0e\u6b64\u540c\u65f6\u628a\u6240\u6709\u5bf9 $A$ \u7684\u64cd\u4f5c\u4e5f\u7528\u5230 $B$ \u4e0a\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u6700\u7ec8\u7684 $R$\u3002\n\n\u6700\u7ec8\u53ef\u4ee5\u5728 $O(N^3)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002",
        "postTime": 1594347116,
        "uid": 71955,
        "name": "Daniel_yuan",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4100 \u3010[HEOI2013]\u9499\u94c1\u950c\u7852\u7ef4\u751f\u7d20 \u3011"
    },
    {
        "content": "\u7ed9\u5b9a $2n$ \u4e2a $n$ \u7ef4\u5411\u91cf $\\mathbf A_1,\\dots,\\mathbf A_n$\uff0c$\\mathbf B_1,\\dots,\\mathbf B_n$\uff0c\u95ee\u662f\u5426\u5b58\u5728\u4e00\u7ec4\u5339\u914d\uff0c\u4f7f\u5f97\u4efb\u610f $\\mathbf A_i$ \u88ab\u5176\u5339\u914d\u4e2d\u5bf9\u5e94\u7684 $\\mathbf B_{p_i}$ \u66ff\u6362\u540e\uff0c\u65b0\u7684\u5411\u91cf\u7ec4 $\\mathbf A_1,\\dots,\\mathbf A_n$ \u4f9d\u65e7\u7ebf\u6027\u65e0\u5173\uff0c\u8f93\u51fa\u5b57\u5178\u5e8f\u6700\u5c0f\u7684\u65b9\u6848\u3002$n\\leqslant 300$\u3002\n\n\u9996\u5148\u5982\u679c $\\mathbf A_1,\\dots,\\mathbf A_n$ \u7ebf\u6027\u76f8\u5173\u76f4\u63a5\u8f93\u51fa\u65e0\u89e3\u3002\u63a5\u4e0b\u6765\u8003\u8651\u67d0\u4e00\u4e2a $\\mathbf B_j$ \u662f\u5426\u53ef\u4ee5\u66ff\u6362 $\\mathbf A_i$\uff0c\u7531\u4e8e $\\mathbf A_1,\\dots,\\mathbf A_n$ \u7ebf\u6027\u65e0\u5173\uff0c\u6240\u4ee5\u6bcf\u4e00\u4e2a $\\mathbf B_j$ \u90fd\u53ef\u4ee5\u88ab\u552f\u4e00\u7684\u8868\u793a\u4e3a $\\mathbf A_1,\\dots,\\mathbf A_n$ \u7684\u7ebf\u6027\u7ec4\u5408\uff0c\u8bbe $C_{i,j}$ \u8868\u793a $\\mathbf B_i$ \u7528 $\\mathbf A_1,\\dots,\\mathbf A_n$ \u8868\u793a\u65f6 $\\mathbf A_j$ \u9879\u7684\u7cfb\u6570\uff0c\u5219\u6709\uff1a\n$$\n\\begin{pmatrix}\nC_{1,1}  & \\dots & C_{1,n}\\\\\n\\vdots   & \\ddots & \\vdots\\\\\nC_{n,1}  & \\dots & C_{n,n}\n\\end{pmatrix}\n\n\\begin{pmatrix}\n\\mathbf A_1 \\\\\n\\vdots \\\\\n\\mathbf A_n\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf B_1 \\\\\n\\vdots \\\\\n\\mathbf B_n\n\\end{pmatrix}\n$$\n\u6240\u4ee5\u6709 $CA=B$\uff0c\u6545 $C=BA^{-1}$\u3002\u6ce8\u610f\u5982\u679c $C_{i,j}=0$\uff0c\u90a3\u4e48 $\\mathbf B_i$ \u53ef\u4ee5\u88ab $\\mathbf A_j$ \u4ee5\u5916\u7684\u5143\u7d20\u7ebf\u6027\u8868\u793a\u51fa\u6765\uff0c\u6240\u4ee5 $\\mathbf B_i$ \u4e0d\u80fd\u66ff\u6362 $\\mathbf A_j$\uff1b\u53cd\u4e4b\u53ef\u4ee5\u7528 $\\mathbf A_1,\\dots,\\mathbf A_{j-1},\\mathbf B_j,\\mathbf A_{j+1},\\dots,\\mathbf A_n$ \u7684\u7ebf\u6027\u7ec4\u5408\u8868\u793a\u51fa $\\mathbf A_j$\uff0c\u6240\u4ee5\u65b0\u7684\u5411\u91cf\u7ec4\u4e00\u5b9a\u4e5f\u7ebf\u6027\u65e0\u5173\u3002\n\n\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u5efa\u7acb\u4e00\u4e2a\u4e8c\u5206\u56fe\uff0c\u5982\u679c $C_{i,j}\\not=0$\uff0c\u6211\u4eec\u5c31\u628a $(j,i)$ \u8fde\u8d77\u6765\uff0c\u73b0\u5728\u6211\u4eec\u76f8\u5f53\u4e8e\u8981\u6c42\u4e00\u4e2a\u5b57\u5178\u5e8f\u6700\u5c0f\u7684\u5b8c\u7f8e\u5339\u914d\u3002\n\n\u9996\u5148\u6211\u4eec\u5148\u6c42\u51fa\u4e00\u4e2a\u5b8c\u7f8e\u5339\u914d $T$\uff0c\u7136\u540e\u6211\u4eec\u8003\u8651\u662f\u5426\u80fd\u5f3a\u5236\u4ee4\u67d0\u6761\u8fb9\u88ab\u9009\u4e2d\uff0c\u6709\u4ee5\u4e0b\u5b9a\u7406\uff1a\n\n\u5b9a\u7406\uff1a\u5bf9\u4e8e\u67d0\u4e2a\u4e0d\u5728 $T$ \u4e2d\u7684\u8fb9 $e$\uff0c$e$ \u80fd\u5b58\u5728\u67d0\u4e2a\u5b8c\u7f8e\u5339\u914d $T'$ \u4e2d\uff0c\u5f53\u4e14\u4ec5\u5f53\u539f\u56fe\u4e2d\u5b58\u5728\u4e00\u4e2a\u5305\u542b $e$ \u7684\u73af\uff0c\u4e14\u73af\u4e2d\u7684\u8fb9\u72b6\u6001\u4e3a \u201c\u5339\u914d-\u672a\u5339\u914d-\u5339\u914d-\u672a\u5339\u914d...\u201d\u3002\n\n\u8bc1\u660e\uff1a\n\n- \u5145\u5206\u6027\uff1a\u6211\u4eec\u53ea\u9700\u8981\u53cd\u8f6c\u8fd9\u4e2a\u73af\u6240\u6709\u8fb9\u7684\u72b6\u6001\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u7ec4\u65b0\u7684\u5305\u542b $e$ \u7684\u5b8c\u7f8e\u5339\u914d\u3002\n- \u5fc5\u8981\u6027\uff1a\u5047\u8bbe $e$ \u5728\u67d0\u4e2a\u5b8c\u7f8e\u5339\u914d $T'$ \u4e2d\uff0c\u4ee4 $S$ \u8868\u793a $T$ \u548c $T'$ \u7684\u5bf9\u79f0\u5dee\uff0c\u7531  $T,T'$ \u4e3a\u5b8c\u7f8e\u5339\u914d\u53ef\u77e5 $S$ \u4e2d\u6bcf\u4e2a\u70b9\u7684\u5ea6\u6570\u4e3a $0/2$\uff0c\u4e8e\u662f $S$ \u5fc5\u7136\u7531\u82e5\u5e72\u7b80\u5355\u73af\u7ec4\u6210\uff0c\u800c\u4e0d\u53ef\u80fd\u51fa\u73b0\u67d0\u4e2a\u70b9\u540c\u65f6\u8fde\u51fa\u4e86\u4e24\u6761\u72b6\u6001\u76f8\u540c\u7684\u8fb9\uff0c\u6240\u4ee5 $e$ \u4e00\u5b9a\u5728\u5f62\u5982 \u201c\u5339\u914d-\u672a\u5339\u914d-\u5339\u914d-\u672a\u5339\u914d...\u201d \u7684\u73af\u4e2d\u3002\n\n\u6211\u4eec\u53d1\u73b0\u627e\u8fd9\u6837\u7684\u73af\u7684\u64cd\u4f5c\u53ef\u4ee5\u4f7f\u7528\u4e00\u6b21 dfs \u5728 $O(n^2)$ \u7684\u65f6\u95f4\u5185\u5b8c\u6210\uff0c\u7136\u540e\u6211\u4eec\u4ece\u5c0f\u5230\u5927\u679a\u4e3e\u5de6\u90e8\u70b9\uff0c\u5c31\u53ef\u4ee5\u77e5\u9053\u54ea\u4e9b\u8fb9\u53ef\u4ee5\u5728\u67d0\u4e2a\u5b8c\u7f8e\u5339\u914d\u4e2d\uff0c\u9009\u62e9\u53f3\u90e8\u70b9\u6700\u5c0f\u7684\u5373\u53ef\u3002\u603b\u590d\u6742\u5ea6 $O(n^3)$\u3002\n\n\u4e0d\u77e5\u9053\u4e3a\u5565\u6211\u7684\u4ee3\u7801\u6709\u4ebf\u70b9\u957f/kk\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n;\ndouble a[305][305],b[305][305],r[305][305];\ntemplate<unsigned N,unsigned M> struct Maxflow\n{\n    int const inf=1e9;\n    int tmp,now,maxflow,s,t,tot=1,target[M],pre[M],last[N],cap[M],deep[N],cur[N],ans[N];\n    bool used[M],vis[N],vis2[N],del[N];\n    queue<int>q;\n    void add(int x,int y,int z)\n    {\n        target[++tot]=y;\n        pre[tot]=last[x];\n        last[x]=tot;\n        cap[tot]=z;\n        target[++tot]=x;\n        pre[tot]=last[y];\n        last[y]=tot;\n    }\n    bool bfs()\n    {\n        for(int i=s;i<=t;i++)deep[i]=0,cur[i]=last[i];\n        q.push(s);\n        while(!q.empty())\n        {\n            int now=q.front();\n            q.pop();\n            for(int i=last[now];i;i=pre[i])\n            {\n                int tar=target[i];\n                if(tar!=s&&cap[i]&&(!deep[tar]))\n                    deep[tar]=deep[now]+1,q.push(tar);\n            }\n        }\n        return deep[t];\n    }\n    int dfs(int x,int lim)\n    {\n        if((!lim)||x==t)return lim;\n        int flow=0;\n        for(int i=cur[x];i;cur[x]=i,i=pre[i])\n        {\n            int tar=target[i];\n            if(cap[i]&&deep[tar]==deep[x]+1)\n            {\n                int d=dfs(tar,min(lim,cap[i]));\n                cap[i]-=d;\n                cap[i^1]+=d;\n                lim-=d;\n                flow+=d;\n                if(!lim)break;\n            }\n        }\n        return flow;\n    }\n    void dinic(){while(bfs())maxflow+=dfs(s,inf);}\n    void dfs(int x,int fa,bool p)\n    {\n        vis[x]=1;\n        for(int i=last[x];i;i=pre[i])\n        {\n            int tar=target[i];\n            if(del[tar]||tar==fa||used[i>>1]!=(p^1))continue;\n            if(tar==now)vis2[x]=1;\n            else if(!vis[tar])dfs(tar,x,p^1);\n        }\n    }\n    bool dfs2(int x,int fa,bool p)\n    {\n        bool res=0;vis[x]=1;\n        for(int i=last[x];i;i=pre[i])\n        {\n            int tar=target[i];\n            if(del[tar]||tar==fa||used[i>>1]!=(p^1))continue;\n            if(tar==now&&x==tmp)used[i>>1]^=1,res=1;\n            else if(!vis[tar])\n            {\n                bool t=dfs2(tar,x,p^1);\n                if(t)res=1,used[i>>1]^=1;\n            }\n        }\n        return res;\n    }\n    void work()\n    {\n        puts(\"TAK\");\n        for(int i=1;i<=n;i++)\n            for(int j=last[i];j;j=pre[j])\n                if(target[j]>n&&!cap[j])used[j>>1]=1;\n        del[s]=del[t]=1;\n        for(int i=1;i<=n;i++)\n        {\n            memset(vis,0,sizeof(vis));memset(vis2,0,sizeof(vis2));\n            now=i;dfs(i,0,0);\n            int mn;\n            for(int j=last[i];j;j=pre[j])if(used[j>>1]){mn=target[j];break;}\n            for(int j=n+1;j<mn;j++)if(vis2[j]){mn=j;break;}\n            printf(\"%d\\n\",mn-n);\n            tmp=mn;\n            memset(vis,0,sizeof(vis));\n            dfs2(i,0,0);\n            del[i]=del[mn]=1;\n        }\n    }\n};\nMaxflow<605,200005>g;\nint main()\n{\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;i++)\n        for(int j=1;j<=n;j++)\n            scanf(\"%lf\",&a[i][j]);\n    for(int i=1;i<=n;i++)\n        for(int j=1;j<=n;j++)\n            scanf(\"%lf\",&b[i][j]);\n    for(int i=1;i<=n;i++)r[i][i]=1;\n    for(int i=1;i<=n;i++)\n    {\n        if(fabs(a[i][i])<1e-7)\n            for(int j=i+1;j<=n;j++)\n                if(fabs(a[j][i])>1e-7){swap(a[i],a[j]),swap(r[i],r[j]);break;}\n        if(fabs(a[i][i])<1e-7){puts(\"NIE\");return 0;}\n        double iv=1.0/a[i][i];\n        for(int j=1;j<=n;j++)\n        {\n            if(j==i)continue;\n            double t=iv*a[j][i];\n            for(int k=1;k<=n;k++)\n                a[j][k]=(a[j][k]-t*a[i][k]),\n                r[j][k]=(r[j][k]-t*r[i][k]);\n        }\n    }\n    for(int i=1;i<=n;i++)\n    {\n        double iv=1.0/a[i][i];\n        for(int j=1;j<=n;j++)r[i][j]*=iv;\n    }\n    memset(a,0,sizeof(a));\n    for(int i=1;i<=n;i++)\n        for(int k=1;k<=n;k++)\n            for(int j=1;j<=n;j++)\n                a[i][j]+=b[i][k]*r[k][j];\n    for(int i=1;i<=n;i++)\n        for(int j=1;j<=n;j++)\n            if(fabs(a[i][j])>1e-7)g.add(j,i+n,1);\n    g.t=2*n+1;\n    for(int i=1;i<=n;i++)g.add(0,i,1),g.add(i+n,g.t,1);\n    g.dinic();\n    if(g.maxflow<n){puts(\"NIE\");return 0;}\n    g.work();\n    return 0;\n}\n```\n\n",
        "postTime": 1612947757,
        "uid": 96912,
        "name": "AzusaCat",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4100 \u3010[HEOI2013]\u9499\u94c1\u950c\u7852\u7ef4\u751f\u7d20 \u3011"
    }
]
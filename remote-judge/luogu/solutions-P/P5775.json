[
    {
        "content": "\u8fd9\u9053\u9898\u76ee\u53ef\u4ee5\u9012\u63a8\uff0c\u53ea\u4e0d\u8fc7\u8fd8\u8981\u6709\u9ad8\u7cbe\u5ea6\u7b97\u6cd5\uff0c\u4e0d\u77e5\u9053\u9ad8\u7cbe\u7684\u4eba\u53ef\u4ee5\u770b[\u9ad8\u7cbe\u5ea6\u6a21\u677f](https://www.luogu.com.cn/blog/YCE-22/gao-jing-du-mu-ban)\u3002\n\n\u5177\u4f53\u600e\u6837\u9012\u63a8\u5462\uff0c\u4e0b\u9762\u6765\u770b\u4e00\u4e0b\uff1a  \n\n| $m$ | $r_1$ | $r_2$ | $r_3$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $0\\ $ | $1\\ $ | $0\\ $ | $0\\ $ |\n| $1\\ $ | $a\\ $ | $1\\ $ | $0\\ $ |\n| $2\\ $ | $a^2+b\\ $ | $a\\ $ | $1\\ $ |\n\u73b0\u5728\u89c4\u5f8b\u53ef\u4ee5\u770b\u51fa\u6765\u4e86\uff0c\u89c4\u5f8b\u662f\n$r_{m,1}=ar_{m-1,1}+br_{m-1,2}+cr_{m-1,3}$  \n$r_{m,2}=r_{m-1,1}$  \n$r_{m,3}=r_{m-1,3}+r_{m-1,2}$  \n\u521d\u503c $r_{0,1}=1$  \n\u6240\u4ee5\u53ea\u8981\u9012\u63a8\u5c31\u53ef\u4ee5\u4e86\uff0c\u4f46\u662f\uff0c$a$ \u6700\u5927\u4e3a $100$\uff0c$m$ \u6700\u5927\u4e3a $3000$\uff0c\u6700\u7ec8\u7b54\u6848\u53ef\u80fd\u4f1a\u8fbe\u5230$10^{6000}$\uff0c\u6700\u5927\u7a7a\u95f4\u5f00\u9500\u4e3a $4\\times3\\times3000\\times6000=2.16\\times10^8B$\uff0c\u4f1a\u7206\u7a7a\u95f4\uff0c\u6240\u4ee5\uff0c\u8981\u7528\u5230\u6eda\u52a8\u6570\u7ec4\u7684\u65b9\u6cd5\uff0c\u51cf\u5c0f\u7a7a\u95f4\u7684\u5f00\u9500.\n\n\u8fd8\u6709\uff0c\u9ad8\u7cbe\u9664\u5728\u9664\u4e0d\u5c3d\u7684\u60c5\u51b5\u4e0b\u7b54\u6848\u8981\u52a01\u3002\n### \u5b8c\u6574\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nstruct huge{//\u9ad8\u7cbe\u5ea6\u90e8\u5206\u53ef\u4ee5\u770b\u6a21\u677f\n\tint a[7654];\n\tint& operator [](int n){\n\t\treturn a[n];\n\t}\n\tbool operator <(huge b){\n\t\tif(a[0]<b[0]) return 1;\n\t\tif(a[0]>b[0]) return 0;\n\t\tfor(int i=a[0];i;--i){\n\t\t\tif(a[i]<b[i]) return 1;\n\t\t\tif(a[i]>b[i]) return 0;\n\t\t}\n\t\treturn 0;\n\t}\n\thuge(){\n\t\tmemset(a,0,sizeof(a));\n\t\ta[0]=1;\n\t}\n\thuge(int x){//\u628a\u4f4e\u7cbe\u8f6c\u9ad8\u7cbe\n\t\tmemset(a,0,sizeof(a));\n\t\twhile(x){\n\t\t\ta[++a[0]]=x%10;\n\t\t\tx/=10;\n\t\t}\n\t\tif(!a[0]) a[0]=1;\n\t}\n\thuge(int *t){\n\t\tmemcpy(a,t,sizeof(a));\n\t}\n\thuge operator *(int x){\n\t\thuge b=huge(a);\n\t\tfor(int i=1;i<=b[0];++i)\n\t\t\tb[i]*=x;\n\t\tfor(int i=1;i<=b[0];++i)\n\t\t\tb[i+1]+=b[i]/10,b[i]%=10;\n\t\twhile(b[b[0]+1]) b[b[0]+1]+=b[b[0]]/10,b[b[0]]%=10,++b[0];\n\t\twhile(!b[b[0]]&&b[0]>1) --b[0];\n\t\treturn b;\n\t}\n\thuge operator +(huge b){\n\t\thuge c;\n\t\tc[0]=max(a[0],b[0]);\n\t\tfor(int i=1;i<=c[0];++i)\n\t\t\tc[i]=a[i]+b[i];\n\t\tfor(int i=1;i<=c[0];++i)\n\t\t\tc[i+1]+=c[i]/10,c[i]%=10;\n\t\twhile(c[c[0]+1]) ++c[0];\n\t\treturn c;\n\t}\n\thuge operator -(huge b){\n\t\thuge c=huge(a);\n\t\tfor(int i=1;i<=c[0];++i){\n\t\t\tc[i]-=b[i];\n\t\t\tif(c[i]<0)\n\t\t\t\t--c[i+1],c[i]+=10;\n\t\t}\n\t\twhile(!c[c[0]]&&c[0]>1) --c[0];\n\t\treturn c;\n\t}\n\thuge operator /(huge b)\n\t{\n\t    huge c,d=huge(a),t;\n\t    c=huge();\n\t    c[0]=a[0]-b[0]+1;\n\t    if(c[0]<1)\n\t    {\n\t        c[0]=1;\n\t        return c+huge(1);\n\t    }\n\t    for(int i=c[0];i>0;--i)\n\t    {\n\t        t=huge();\n\t        for(int j=1;j<=b[0];++j)\n\t            t[i+j-1]=b[j];\n\t        t[0]=i+b[0]-1;\n\t        while(!(d<t)) ++c[i],d=d-t;\n\t    }\n\t    while(!c[c[0]]&&c[0]>1) --c[0];\n\t    if(huge(0)<d) c=c+huge(1);//\u6ce8\u610f\u5982\u679c\u4f59\u6570\u4e0d\u4e3a0\uff0c\u7b54\u6848\u8981\u52a01\n\t    return c;\n\t}\n};\nistream& operator >>(istream& is,huge& a){\n\tstring s;\n\tis>>s;\n\tif(s[0]=='-')\n\t\ta[-1]=-1,s.erase(s.begin());\n\ta[0]=s.length();\n\tfor(int i=0;i<a[0];++i)\n\t\ta[a[0]-i]=s[i]-48;\n\treturn is;\n}\nostream& operator <<(ostream& os,huge a){\n\tif(!~a[-1]) os<<'-';\n\tfor(int i=a[0];i;--i)\n\t\tos<<a[i];\n\treturn os;\n}\nint a,b,c,m;\nhuge k,ans,d1,d2,d3,d4;//\u8fd9\u91cc\u76f4\u63a5\u7701\u7565\u6570\u7ec4\uff0c\u6240\u4ee5\u5728m\u4e3a1\u62162\u65f6\u9700\u8981\u7279\u5224\nint main(){\n\tcin>>a>>b>>c>>m>>k;//\u91cd\u8f7d\u8fd0\u7b97\u7b26\u540e\uff0c\u9ad8\u7cbe\u6570\u53ef\u4ee5\u4e0e\u666e\u901a\u7684\u6570\u5b57\u4e00\u8d77\u8f93\u5165\n\tif(m==1){\n\t\tcout<<a+1<<endl;\n\t\tans=k/huge(a+1);\n\t\tcout<<ans<<endl;\n\t\treturn 0;\n\t}\n\tif(m==2){\n\t\tcout<<a*a+a+b+1<<endl;\n\t\tans=k/huge(a*a+a+b+1);\n\t\tcout<<ans<<endl;\n\t\treturn 0;\n\t}\n\td1=huge(a*a+b),d2=huge(a),d3=huge(1);\n\tfor(int i=3;i<=m;++i){\n\t\td4=d1;\n\t\td1=d1*a+d2*b+d3*c;\n\t\td3=d3+d2,d2=d4;\n\t}\n\td4=d1+d2+d3;\n\tcout<<d1+d2+d3<<endl;\n\tans=k/d4;\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```\n\u8fd9\u6bb5\u4ee3\u7801\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(m\\log_{10}(a^m))$\uff0c\u4e14\u5e38\u6570\u8f83\u5927\uff0c\u6700\u6162\u7684\u70b9\u8dd1\u4e86800ms\uff0c\u901a\u8fc7\u672c\u9898\u6709\u70b9\u5371\u9669\uff0c\u53ef\u4ee5\u4f18\u5316\u4e00\u4e0b\u3002",
        "postTime": 1575783104,
        "uid": 181378,
        "name": "Alarm5854",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5775 \u3010[AHOI2006]\u6590\u6ce2\u5361\u5951\u7684\u5154\u5b50\u3011"
    }
]
[
    {
        "content": "\u9898\u76ee\u63cf\u8ff0\uff1a\u8f93\u5165\u591a\u9879\u5f0f\u7684\u6b21\u6570$n$\uff0c\u4e00\u4e2a\u6574\u6570$m$\u548c$f(0),f(1),f(2),\\ldots,f(n)$\uff0c\u8f93\u51fa$f(m),f(m+1),f(m+2),\\ldots,f(m+n)$\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\leq n\\leq 1.6\\times 10^5,n<m\\leq 10^8$\n\n\u4e0a\u6765\u80af\u5b9a\u662f\u5957\u67ff\u5b50\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/e3tixfqb.png)\n\n\u8fd9\u662f\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\u3002\n\n\u5f53\u7136$0\\le j\\le n$\u800c\u4e0d\u662f$0\\le j\\le i$\u3002\u548b\u529e\u5462\uff1f\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u6574\u4e2a\u5e8f\u5217\u5411\u53f3\u5e73\u79fb$n$\u4f4d\uff0c\u7b2c$i+n$\u4f4d\u8ba1\u7b97\u5f97\u51fa\u7684\u662f$f(m+i)$\u4e2d\u540e\u9762\u7684\u548c\u5f0f\u3002\n\n$$A[i]=\\frac{f(i)\\times (-1)^{n-i}}{i!\\times (n-i)!},B[i]=\\frac{1}{m-n+i}$$\n\n\u9884\u5904\u7406\u9636\u4e58\uff0c\u9006\u5143\uff0c\u9636\u4e58\u9006\u5143\uff0c\u548c$mfac[i]=\\prod_{j=0}^{i-1}(m-n+j)$\uff0c$m-n+i$\u7684\u9006\u5143\u548c$mfac[i]$\u7684\u9006\u5143\u3002\u8fd9\u4e2a\u79bb\u7ebf\u6c42\u9006\u5143\u7684\u79d1\u6280\u53ef\u4ee5\u53bb[\u8fd9\u91cc](https://www.luogu.org/problem/P5431)\u5eb7\u5eb7\u3002\n\n\u4f7f\u7528NTT\u8ba1\u7b97\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(n\\log n)$\n\n```cpp\n#include<bits/stdc++.h>\n#define Rint register int\nusing namespace std;\ntypedef long long LL;\nconst int N = 1 << 19, mod = 998244353, G = 3, Gi = 332748118;\ninline int kasumi(int a, int b){\n\tint res = 1;\n\twhile(b){\n\t\tif(b & 1) res = (LL) res * a % mod;\n\t\ta = (LL) a * a % mod;\n\t\tb >>= 1;\n\t}\n\treturn res;\n}\nint rev[N];\ninline int calrev(int len){\n\tint L = -1, limit = 1;\n\twhile(limit <= len){limit <<= 1; L ++;}\n\tfor(Rint i = 0;i < limit;i ++) rev[i] = (rev[i >> 1] >> 1) | ((i & 1) << L);\n\treturn limit;\n}\ninline void NTT(int *A, int limit, int type){\n\tfor(Rint i = 0;i < limit;i ++) if(i < rev[i]) swap(A[i], A[rev[i]]);\n\tfor(Rint mid = 1;mid < limit;mid <<= 1){\n\t\tint Wn = kasumi(type == 1 ? G : Gi, (mod - 1) / (mid << 1));\n\t\tfor(Rint j = 0;j < limit;j += mid << 1){\n\t\t\tint w = 1;\n\t\t\tfor(Rint k = 0;k < mid;k ++, w = (LL) w * Wn % mod){\n\t\t\t\tint x = A[j + k], y = (LL) w * A[j + k + mid] % mod;\n\t\t\t\tA[j + k] = (x + y) % mod;\n\t\t\t\tA[j + k + mid] = (x - y + mod) % mod;\n\t\t\t}\n\t\t}\n\t}\n\tif(type == -1){\n\t\tint inv = kasumi(limit, mod - 2);\n\t\tfor(Rint i = 0;i < limit;i ++) A[i] = (LL) A[i] * inv % mod;\n\t}\n}\nint fac[N], invfac[N], inv[N], mfac[N], minvfac[N], minv[N];\ninline void init(int n, int m){\n\tfac[0] = mfac[0] = 1;\n\tfor(Rint i = 1;i <= (n << 1 | 1);i ++){\n\t\tfac[i] = (LL) fac[i - 1] * i % mod;\n\t\tmfac[i] = (LL) mfac[i - 1] * (m - n + i - 1) % mod;\n\t}\n\tinvfac[n << 1 | 1] = kasumi(fac[n << 1 | 1], mod - 2);\n\tminvfac[n << 1 | 1] = kasumi(mfac[n << 1 | 1], mod - 2);\n\tfor(Rint i = (n << 1 | 1);i;i --){\n\t\tinvfac[i - 1] = (LL) invfac[i] * i % mod;\n\t\tminvfac[i - 1] = (LL) minvfac[i] * (m - n + i - 1) % mod;\n\t\tinv[i] = (LL) invfac[i] * fac[i - 1] % mod;\n\t\tminv[i] = (LL) minvfac[i] * mfac[i - 1] % mod;\n\t}\n\tminv[0] = 1;\n}\nint n, m, f[N], A[N], B[N];\nint main(){\n\tscanf(\"%d%d\", &n, &m);\n\tfor(Rint i = 0;i <= n;i ++) scanf(\"%d\", f + i);\n\tinit(n, m);\n\tint limit = calrev(n * 3);\n\tfor(Rint i = 0;i <= n;i ++){\n\t\tA[i] = (LL) f[i] * invfac[i] % mod * invfac[n - i] % mod;\n\t\tif(n - i & 1) A[i] = mod - A[i];\n\t}\n\tfor(Rint i = 0;i <= (n << 1);i ++) B[i] = minv[i + 1];\n\tNTT(A, limit, 1); NTT(B, limit, 1);\n\tfor(Rint i = 0;i < limit;i ++) A[i] = (LL) A[i] * B[i] % mod;\n\tNTT(A, limit, -1);\n\tfor(Rint i = n;i <= (n << 1);i ++)\n\t\tprintf(\"%d \", (LL) mfac[i + 1] * minvfac[i - n] % mod * A[i] % mod);\n}\n```",
        "postTime": 1574346118,
        "uid": 68148,
        "name": "watermoon",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5667 \u3010\u62c9\u683c\u6717\u65e5\u63d2\u503c2\u3011"
    },
    {
        "content": "\n\u7531\u63d2\u503c\u516c\u5f0f\u53ef\u5f97\n\n$$f(m+x)=\\sum_{i=0}^{n}f(i)\\prod_{j \\neq i}\\frac{m+x-j}{i-j}=\\sum_{i=0}^{n}f(i) \\frac{(m+x)!/(m+x-n-1)!}{(m+x-i)(-1)^{n-i}i!(n-i)!}$$\n\n\u4ee4\n\n$$u_i=\\frac{f(i)}{(-1)^{n-i}i!(n-i)!}$$\n\n\u5f53$i>n$\u65f6$u_i=0$\n\n$$v_i=\\frac{1}{m-n+i}$$\n\n\u53ef\u5f97\n\n$$(u * v)_{x}=\\sum_{i=0}^{x}\\frac{f(i)}{(-1)^{n-i}i!(n-i)!(m-n+x-i)}$$\n\n$$(u * v)_{n+x}=\\sum_{i=0}^{n}\\frac{f(i)}{(-1)^{n-i}i!(n-i)!(m+x-i)}$$\n\n\u5373\n$$f(m+x)=(u*v)_{n+x}\\prod_{i=m+x-n}^{m+x}i$$\n\n\u4e8e\u662f\u53ef\u7528\u4e00\u6b21NTT\u6c42\u51fa$f(m),f(m+1),...,f(m+n)$\u3002\n\n\u603b\u590d\u6742\u5ea6$O(n \\log n)$\u3002\n",
        "postTime": 1574253390,
        "uid": 108050,
        "name": "forgottencosecant",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5667 \u3010\u62c9\u683c\u6717\u65e5\u63d2\u503c2\u3011"
    },
    {
        "content": "[\u53ef\u80fd\u66f4\u597d\u7684\u4f53\u9a8c](https://mrsrz.github.io/2019/11/21/lg5667/)\n\n\u672c\u9898\u53ef\u4ee5\u5c06\u70b9\u503c\u8f6c\u5316\u4e3a\u4e0b\u964d\u5e42\u7cfb\u6570\uff0c\u7136\u540e\u505a\u4e00\u6b21\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u5e73\u79fb\uff0c\u518d\u8f6c\u5316\u4e3a\u70b9\u503c\u3002\n\n\u5173\u4e8e\u5982\u4f55\u5c06\u70b9\u503c\u4e0e\u4e0b\u964d\u5e42\u7cfb\u6570\u4e92\u76f8\u8f6c\u5316\uff0c\u8be6\u89c1[\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u4e58\u6cd5](https://www.luogu.org/problem/P5394)\u7684\u6a21\u677f\u3002\n\n\u8fd9\u91cc\u4e3b\u8981\u8ba8\u8bba\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u7684\u5e73\u79fb\u3002\n\n\u8fd9\u91cc\u7684\u5e73\u79fb\u6307\u7684\u662f\uff0c\u5df2\u77e5\u591a\u9879\u5f0f $f(x)$ \u7684\u5404\u9879\u7cfb\u6570\u5e76\u7ed9\u5b9a\u5e38\u6570 $c$\uff0c\u6c42 $f(x+c)$ \u7684\u5404\u9879\u7cfb\u6570\u3002\n\n\u8fd9\u91cc\u9700\u8981\u7528\u5230\u4e0b\u964d\u5e42\u7684\u4e8c\u9879\u5f0f\u5b9a\u7406\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8hx6emx6.png)\n\n~~\u300a\u5177\u4f53\u6570\u5b66\u300b\u4e60\u98985.37~~\n\n\u8003\u8651\u6211\u4eec\u5f53\u524d\u5f97\u5230 ![](https://cdn.luogu.com.cn/upload/image_hosting/0pkrwm56.png)\uff0c\u5bf9 $f(x+c)$ \u8fdb\u884c\u5206\u6790\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qin74w0p.png)\n\n\u89c2\u5bdf\u8fd9\u4e2a\u5f0f\u5b50 ![](https://cdn.luogu.com.cn/upload/image_hosting/96r5gpua.png)\uff0c\u8fd9\u662f\u53ef\u4ee5\u7528\u4e00\u6b21\u591a\u9879\u5f0f\u4e58\u6cd5\u5f97\u5230\u7684\u3002\n\n\u4ee4\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/a3gmsnai.png)\n\n\u90a3\u4e48 $f(x+c)$ \u7684\u7b2c $k$ \u9879\u4e0b\u964d\u5e42\u7cfb\u6570\u5c31\u662f $p$ \u4e0e $q$ \u7684\u5377\u79ef\u7684\u7b2c $n-k$ \u9879\uff0c\u8fd8\u8981\u4e58\u4e0a $k!$ \u7684\u9006\u3002\n\n\u5f97\u5230 $f(x+c)$ \u7684\u4e0b\u964d\u5e42\u7cfb\u6570\u540e\uff0c\u518d\u8f6c\u5316\u6210\u70b9\u503c\u5373\u53ef\u3002\n\n\u603b\u5171\u9700\u8981\u4e09\u6b21\u591a\u9879\u5f0f\u4e58\u6cd5\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n## Code\uff1a\n```cpp\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nconst int N=524288,md=998244353,g3=(md+1)/3;\ntypedef long long LL;\nint a[N],n,rev[N],lim,m,fac[N],iv[N],F[N];\ninline void upd(int&a){a+=a>>31&md;}\ninline int pow(int a,int b){\n    int ret=1;\n    for(;b;b>>=1,a=(LL)a*a%md)if(b&1)ret=(LL)ret*a%md;\n    return ret;\n}\nvoid init(int n){\n    int l=-1;\n    for(lim=1;lim<n;lim<<=1)++l;\n    for(int i=1;i<lim;++i)\n        rev[i]=(rev[i>>1]>>1)|((i&1)<<l);\n}\nvoid FFT(int*a,int f){\n    for(int i=1;i<lim;++i)\n        if(i<rev[i])swap(a[i],a[rev[i]]);\n    for(int i=1;i<lim;i<<=1){\n        const int gi=pow(f?3:g3,(md-1)/(i<<1));\n        for(int j=0;j<lim;j+=i<<1)\n            for(int k=0,g=1;k<i;++k,g=(LL)g*gi%md){\n                const int x=a[j+k],y=a[j+k+i]*(LL)g%md;\n                upd(a[j+k]+=y-md),upd(a[j+k+i]=x-y);\n            }\n    }\n    if(!f){\n        const int vv=pow(lim,md-2);\n        for(int i=0;i<lim;++i)a[i]=(LL)a[i]*vv%md;\n    }\n}\nint main(){\n    ios::sync_with_stdio(0),cin.tie(0),cout.tie(0);\n    cin>>n>>m;++n;\n    for(int i=0;i<n;++i)cin>>a[i];\n    for(int i=*fac=1;i<=n;++i)fac[i]=(LL)fac[i-1]*i%md;\n    iv[n]=pow(fac[n],md-2);\n    for(int i=n-1;~i;--i)iv[i]=(i+1LL)*iv[i+1]%md;\n    for(int i=0;i<n;++i)\n        a[i]=(LL)a[i]*iv[i]%md,F[i]=(i&1)?md-iv[i]:iv[i];\n    init(n<<1);\n    FFT(a,1),FFT(F,1);\n    for(int i=0;i<lim;++i)a[i]=(LL)a[i]*F[i]%md;\n    FFT(a,0);\n    for(int i=n;i<lim;++i)a[i]=F[i]=0;\n    F[0]=1;\n    for(int i=1;i<n;++i){\n        F[i]=(LL)F[i-1]*(m-i+1)%md;\n        a[i]=(LL)a[i]*fac[i]%md;\n    }\n    reverse(a,a+n);\n    for(int i=1;i<n;++i)\n        F[i]=(LL)F[i]*iv[i]%md;\n    FFT(a,1),FFT(F,1);\n    for(int i=0;i<lim;++i)a[i]=(LL)a[i]*F[i]%md;\n    FFT(a,0);\n    for(int i=n;i<lim;++i)a[i]=F[i]=0;\n    reverse(a,a+n);\n    for(int i=0;i<n;++i)F[i]=iv[i],a[i]=(LL)a[i]*iv[i]%md;\n    FFT(a,1),FFT(F,1);\n    for(int i=0;i<lim;++i)a[i]=(LL)a[i]*F[i]%md;\n    FFT(a,0);\n    for(int i=0;i<n;++i)\n        cout<<(LL)a[i]*fac[i]%md<<' ';\n    cout<<'\\n';\n    return 0;\n}\n```",
        "postTime": 1574341313,
        "uid": 6813,
        "name": "mrsrz",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5667 \u3010\u62c9\u683c\u6717\u65e5\u63d2\u503c2\u3011"
    },
    {
        "content": "# P5667 \u62c9\u683c\u6717\u65e5\u63d2\u503c2 \u9898\u89e3\n\n## \u9898\u76ee\u63cf\u8ff0\n\n~~\u4ec5\u4ec5\u662f\u590d\u5236\u4e86\u4e00\u904d\u9898\u76ee~~\n\n\u7ed9\u5b9a\u4e00\u4e2a\u4e0d\u8d85\u8fc7 $n$ \u6b21\u7684\u591a\u9879\u5f0f\u7684 $n+1$ \u4e2a\u70b9\u503c $f(0),f(1) \\dots f(n)$\uff0c\u548c\u4e00\u4e2a\u6b63\u6574\u6570 $m$\uff0c\u6c42 $f(m),f(m+1) \\dots f(m+n)$\u3002\n\n\u7b54\u6848\u5bf9 $998244353$ \u53d6\u6a21\u3002\n\n## \u524d\u7f6e\u77e5\u8bc6\n\n### \u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\n\n[\u6a21\u677f](https://www.luogu.com.cn/problem/P4781)\n\n\u5df2\u77e5\u4e00\u4e2a $n - 1$ \u6b21\u591a\u9879\u5f0f\u51fd\u6570\u4e0a\u7684 $n$ \u4e2a\u70b9 $(x_1,f(x_1)),(x_2,f(x_2)), \\cdots ,(x_n,f(x_n))$\uff0c\u6c42\u5f53\u6a2a\u5750\u6807\u4e3a $x$ \u7684\u65f6\u5019\u7684\u51fd\u6570\u503c\u3002\n\n$$\nf(x) = \\sum_{i = 1}^n f(x_i) \\prod_{i \\ne j} \\frac{x - x_j}{x_i - x_j}\n$$\n\n### \u5377\u79ef\n\n\u6570\u5217\u5377\u79ef\uff1a\n\n$$\nf(x) = g(x) * h(x) = \\sum_{i = 0}^x g(i) h(x - i)\n$$\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u5c06 $g(x),h(x)$ \u770b\u4f5c\u4e24\u4e2a\u591a\u9879\u5f0f\uff0c\u90a3\u4e48 $f(x)$ \u5c31\u662f $g(x)h(x)$ \u7684 $x$ \u6b21\u9879\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u7528 FFT \u8ba1\u7b97\u5377\u79ef\u3002 \n\n[FFT \u6a21\u677f](https://www.luogu.com.cn/problem/P3803)\n\n## \u601d\u8def\n\n\u5148\u63a8\u5f0f\u5b50\u3002\u6211\u4eec\u9700\u8981\u6c42 $f(m + k),k \\in [0, n]$\uff0c\u7528\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u8868\u793a\u5982\u4e0b\uff08\u8fd9\u91cc\u4e3a\u4e86\u65b9\u4fbf\u8868\u793a\uff0c\u5c06\u62c9\u683c\u6717\u65e5\u63d2\u503c\u7684\u516c\u5f0f\u4e2d\u6c42\u548c\u7684\u4e0b\u6807\u6539\u4e3a\u4ece $0$ \u5230 $n$\uff09\u3002\n\n$$\nf(x_{m + k}) = \\sum_{i=0}^n f(x_i) \\prod_{i \\ne j} \\frac{x_{m + k} - x_j}{x_i - x_j}\n$$\n\n\u6ce8\u610f\u5230\u9898\u76ee\u4e2d\u7ed9\u7684\u70b9\u7684\u6a2a\u5750\u6807\u4e3a $x_i = i$\uff0c\u6240\u4ee5\u5c06\u516c\u5f0f\u5316\u7b80\u3002\n\n$$\n\\begin{aligned}\nf(x_{m + k}) &= \\sum_{i=0}^n f(x_i) \\prod_{i \\ne j} \\frac{x_{m + k} - x_j}{x_i - x_j} \\\\\nf(m + k) &= \\sum_{i=0}^n f(i) \\prod_{j = 0, j \\ne i}^n \\frac{m + k - j}{i - j} \\\\\nf(m + k) &= \\sum_{i=0}^n f(i) \\frac{\\prod_{j = 0, j \\ne i}^n m + k - j}{\\prod_{j = 0, j \\ne i}^n i - j} \\\\\nf(m + k) &= \\sum_{i=0}^n \\frac{(-1)^{n-i} f(i) \\prod_{j = 0}^n m + k - j}{(m + k - i) i! (n-i)!} \\\\\nf(m + k) &= \\left(\\prod_{j = 0}^n m + k - j \\right) \\sum_{i=0}^n \\frac{(-1)^{n-i} f(i)}{(m + k - i) i! (n-i)!} \\\\\nf(m + k) &= \\left(\\prod_{j = 0}^n m + k - j \\right) \\sum_{i=0}^n \\frac{(-1)^{n-i} f(i)}{i! (n-i)!} \\times \\frac{1}{(m + k - i)} \\\\\n\\end{aligned}\n$$\n\n\u5982\u679c\u5ffd\u7565\u524d\u9762\u7684\u8fde\u4e58\u90e8\u5206\uff0c\u540e\u9762\u7684\u6c42\u548c\u6709\u70b9\u50cf\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u4e0d\u540c\u70b9\u662f\u5377\u79ef\u6c42\u548c\u7684\u8303\u56f4\u662f $0$ \u5230 $k$\uff0c\u800c\u8fd9\u91cc\u662f $0$ \u5230 $n$\u3002\u5982\u679c\u6211\u4eec\u60f3\u4f7f\u7528 FFT \u8ba1\u7b97\u5377\u79ef\uff0c\u5c31\u5fc5\u987b\u53d8\u6362\u4e00\u4e0b\u5f62\u5f0f\u3002\u4ee4\uff1a\n\n$$\n\\begin{aligned}\na_i &= \n\\begin{cases}\n\\dfrac{(-1)^{n-i} f(i)}{i! (n-i)!}, &i \\in [0, n] \\\\\n0, &i \\in (n, 2n]\n\\end{cases} \\\\\nb_i &= \\frac{1}{m - n + i}, i \\in [0, 2n] \\\\\nc_i &= a_i * b_i \\\\\n\\end{aligned}\n$$\n\n\u8fd9\u6837\uff1a\n\n$$\nf(m + k) = c_{n + k} \\prod_{j = 0}^n m + k - j\n$$\n\n\u4e3a\u4ec0\u4e48\u5462\uff1f\n\n\u5728\u4e0a\u9762\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u4e2d\u63a8\u5bfc\u51fa\u7684\u5f0f\u5b50\u4e2d\uff0c\u6c42\u548c\u4e0a\u754c\u4e3a $n$\uff0c\u800c $c_i$ \u7684\u6c42\u548c\u4e0a\u754c\u4e3a $i$\uff0c\u53ef\u80fd\u5c0f\u4e8e $n$\uff0c\u6240\u4ee5\u60f3\u5230\u4f7f\u7528 $c_{n+k}$ \u7b97 $f(m + k)$\u3002\u8fd9\u65f6\uff0c$c_{n + k} = \\displaystyle\\sum_{i = 0}^{n + k} a_i b_{n + k - i}$\uff0c\u6211\u4eec\u9700\u8981\u4ee4 $b_{n + k - i} = \\dfrac{1}{m + k - i}$\u3002\u8bbe $b_j = \\dfrac{1}{u + j}$\uff0c\u5c06 $j = n + k - i$ \u4ee3\u5165\uff0c\u5219 $u + n + k - i = m + k - i$\uff0c\u89e3\u5f97 $u = m - n, b_j = \\dfrac{1}{m - n + j}$\u3002\n\n\u8fd9\u65f6\uff1a\n\n$$\n\\begin{aligned}\nc_{n + k} &= \\sum_{i = 0}^{n + k} a_i b_{n + k - i} \\\\\n&= \\sum_{i = 0}^n a_i b_{n + k - i} + \\sum_{i = n + 1}^{n + k} a_i b_{n + k - i} \\\\\n&= \\sum_{i = 0}^n \\frac{(-1)^{n-i} f(i)}{i! (n-i)! (m + k - i)} + \\sum_{i = n + 1}^{n + k} a_i b_{n + k - i} \\\\\n\\end{aligned}\n$$\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u524d\u534a\u90e8\u5206\u662f\u6211\u4eec\u9700\u8981\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u4ee4\u540e\u534a\u90e8\u5206\uff08\u5373 $\\displaystyle\\sum_{i = n + 1}^{n + k} a_i b_{n + k - i}$\uff09\u7b49\u4e8e $0$\u3002\u56e0\u4e3a\u5f53 $k$ \u53d6 $[0, n]$ \u65f6\uff0c$n + 1 \\leq i \\leq 2n$\uff0c\u4e5f\u5c31\u662f\u8bf4\u5728\u8fd9\u4e2a\u53d6\u503c\u8303\u56f4\u5185\u7684 $a_i$ \u5bf9\u7b54\u6848\u7684\u8d21\u732e\u603b\u662f\u4e3a $0$\u3002\u800c $0 \\leq n + k - i \\leq k - 1$\uff0c\u5728\u8fd9\u4e2a\u53d6\u503c\u8303\u56f4\u5185\u7684 $b_i$ \u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e0d\u603b\u662f $0$\uff08\u6bd4\u5982 $b_0$ \u5bf9 $c_n$ \u7684\u8d21\u732e\u4e0d\u4e3a $0$\uff0c\u800c\u5bf9 $c_{n + 1}$ \u7684\u8d21\u732e\u4e3a $0$\uff09\u3002\u56e0\u6b64\uff0c\u53ea\u80fd\u5c06 $n + 1 \\leq i \\leq 2n$ \u7684 $a_i$ \u8d4b\u503c\u4e3a $0$\uff0c\u624d\u80fd\u7b97\u51fa\u6b63\u786e\u7684 $c_i$\u3002\uff08\u8fd9\u91cc\u5bf9\u533a\u95f4\u5de6\u53f3\u7aef\u70b9\u7684\u4e66\u5199\u5e76\u4e0d\u662f\u5f88\u4e25\u8c28\uff0c\u53ea\u662f\u4e3a\u4e86\u4fbf\u4e8e\u8bf4\u660e\u539f\u56e0\uff09\n\n\u5c06\u63a8\u5bfc\u51fa\u6765\u7684\u5f0f\u5b50\u8f6c\u5316\u4e3a\u5377\u79ef\u95ee\u9898\u4e4b\u540e\uff0c\u6211\u4eec\u53ea\u9700\u8981\u9884\u5904\u7406\u51fa\u9636\u4e58\u9006\u5143\u5373\u53ef\u5229\u7528 FFT/NTT \u89e3\u51b3\u95ee\u9898\uff08\u6c42\u548c\u524d\u9762\u7684\u8fde\u4e58\u53ef\u4ee5\u5728\u6c42 $f(m + k)$ \u65f6\u5904\u7406\uff09\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n \\log n)$\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <iostream>\nusing namespace std;\nconst int MAXN = 160005, MAXN2 = (1 << 19) + 5, MOD = 998244353, G_0 = 3, G_N = 332748118;\nint n, m, fac, logLen, prod = 1, len = 1, a[MAXN2], b[MAXN2], rev[MAXN2], f[MAXN], invFac[MAXN];\nint inc(int x, int y) { return x + y >= MOD ? x + y - MOD : x + y; }\nint dec(int x, int y) { return x < y ? (x - y) % MOD + MOD : (x - y) % MOD; }\nint mul(int x, int y) { return 1ll * x * y % MOD; }\nint mul(int x, int y, int z) { return 1ll * x * y % MOD * z % MOD; }\nint power(int x, int y, int mod) {\n    int ans = 1;\n    for (; y; y >>= 1, x = mul(x, x))\n        if (y & 1)\n            ans = mul(ans, x);\n    return ans;\n}\nint op(int x) { return MOD - x; }\nint inv(int x) { return power(x, MOD - 2, MOD); }\nvoid NTT(int num[], int length, bool reverse) {\n    for (int i = 0; i < length; ++i)\n        if (i < rev[i])\n            swap(num[i], num[rev[i]]);\n    for (int i = 1; i < length; i <<= 1) {\n        int g0 = power(reverse ? G_N : G_0, (MOD - 1) / (i << 1), MOD);\n        for (int j = 0; j < length; j += (i << 1))\n            for (int k = j, g = 1; k < i + j; ++k, g = mul(g, g0)) {\n                int temp1 = num[k], temp2 = mul(g, num[i + k]);\n                num[k] = inc(temp1, temp2), num[i + k] = dec(temp1, temp2);\n            }\n    }\n    if (reverse)\n        for (int i = 0, _ = inv(length); i < length; ++i)\n            num[i] = mul(num[i], _);\n}\nint main() {\n    ios::sync_with_stdio(false), cin.tie(0);\n    cin >> n >> m;\n    for (int i = 0; i <= n; ++i)\n        cin >> f[i];\n    fac = 1;\n    for (int i = 1; i <= n; ++i)\n        fac = mul(fac, i);\n    invFac[n] = inv(fac);\n    for (int i = n; i; --i)\n        invFac[i - 1] = mul(invFac[i], i);\n    for (int i = 0; i <= n; ++i) {\n        a[i] = mul(f[i], invFac[i], invFac[n - i]);\n        if ((n - i) & 1)\n            a[i] = op(a[i]);\n    }\n    for (int i = 0; i <= (n << 1); ++i)\n        b[i] = inv(m - n + i);\n    for (int i = n + 1 + (n + 1 << 1); len < i;)\n        len <<= 1, ++logLen;\n    for (int i = 1; i <= len; ++i)\n        rev[i] = (rev[i >> 1] >> 1) | ((i & 1) << logLen - 1);\n    NTT(a, len, false), NTT(b, len, false);\n    for (int i = 0; i < len; ++i)\n        a[i] = mul(a[i], b[i]);\n    NTT(a, len, true);\n    for (int i = m - n; i <= m; ++i)\n        prod = mul(prod, i);\n    for (int i = 0; i <= n; ++i)\n        cout << mul(prod, a[n + i]) << \" \", prod = mul(prod, inv(m - n + i), m + i + 1);\n}\n```",
        "postTime": 1661447610,
        "uid": 241100,
        "name": "Emertyst",
        "ccfLevel": 6,
        "title": "P5667 \u62c9\u683c\u6717\u65e5\u63d2\u503c2 \u9898\u89e3"
    },
    {
        "content": "\u6839\u636e\u63d2\u503c\u516c\u5f0f\u6709\n\n$$\nf(m+a)=\\sum_{i=0}^nf(i)\\prod_{j\\neq i}\\frac{m+a-j}{i-j}\n$$\n\n$$\n=\\sum_{i=0}^nf(i)\\frac{(m+a)!\\big((m+a-n-1)!(m+a-i)\\big)^{-1}}{i!(n-i)!(-1)^{n-i}}\n$$\n\n$$\n=\\frac{(m+a)!}{(m+a-n-1)!}\\sum_{k=0}^n\\frac{f(k)}{k!(n-k)!(-1)^{n-k}}\\frac{1}{m+a-k}\n$$\n\n\u65e0\u59a8\u4ee4 $\\color{royalblue}{}^{[1]}$\n\n$$\na_i=\\frac{f(i)}{i!(n-i)!(-1)^{n-i}}\\;\\;(i\\leqslant n),\\quad b_i=\\frac{1}{m-n+i}\n$$\n\n\u5e76\u4ee4\u5728 $i>n$ \u65f6\u4ee4 $a_i$ \u4e3a\u96f6\uff0c\u90a3\u4e48\n\n$$\nf(m+\na)=\\left[z^{n+a}\\right]\\frac{(m+a)!A(z)B(z)}{(m+a-n-1)!}\n$$\n\n\u5377\u8d77\u6765\u5c31\u5b8c\u4e8b\u4e86\u3002\n\n------------\n$\\small{\\color{royalblue}{[1]}}:m$ \u5f88\u5927\uff0c\u4e0d\u80fd\u76f4\u63a5\u8bbe\u4e3a $b_i=\\frac{1}{i}$\uff0c\u5426\u5219\u4f1a\u4e00\u76f4 RE\u3002",
        "postTime": 1676685080,
        "uid": 246979,
        "name": "SalomeJLQ",
        "ccfLevel": 5,
        "title": "P5667 \u62c9\u683c\u6717\u65e5\u63d2\u503c 2"
    }
]
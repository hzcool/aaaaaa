[
    {
        "content": "[$\\color{teal}{Blog}$](https://blog.csdn.net/qq_43653202/article/details/99976316)\n\n[P4783 \u3010\u6a21\u677f\u3011\u77e9\u9635\u6c42\u9006](https://www.luogu.org/problem/P4783)\n\n**\u9898\u76ee\u63cf\u8ff0**\n\n\u6c42\u4e00\u4e2a$N\u00d7N$\u7684\u77e9\u9635\u7684\u9006\u77e9\u9635\u3002\u7b54\u6848\u5bf9$10^9+7$\u53d6\u6a21\u3002\n\n### 1.\u9006\u77e9\u9635\u7684\u5b9a\u4e49\n\n\u5047\u8bbe $A$ \u662f\u4e00\u4e2a\u65b9\u9635\uff0c\u5982\u679c\u5b58\u5728\u4e00\u4e2a\u77e9\u9635 $A^{-1}$\uff0c\u4f7f\u5f97\n\n$$A^{-1}A=I$$\n\u5e76\u4e14\n$$AA^{-1}=I$$\n\n\u90a3\u4e48\uff0c\u77e9\u9635 A \u5c31\u662f\u53ef\u9006\u7684\uff0c$A^{-1}$ \u79f0\u4e3a A \u7684\u9006\u77e9\u9635\n\n### 2.\u9006\u77e9\u9635\u6c42\u6cd5 \u2014\u2014 \u521d\u7b49\u53d8\u6362\u6cd5\uff08\u9ad8\u65af-\u7ea6\u65e6\u6d88\u5143\uff09\n\n**0.\u9ad8\u65af-\u7ea6\u65e6\u6d88\u5143**\n\n\u8be6\u89c1\n[P3389 \u3010\u6a21\u677f\u3011\u9ad8\u65af\u6d88\u5143\u6cd5](https://www.luogu.org/problem/P3389)\n\u9898\u89e3\u90e8\u5206\n\n\u9ad8\u65af\u7ea6\u65e6\u6d88\u5143\u4e0e\u9ad8\u65af\u6d88\u5143\u533a\u522b\uff1a\n\n```\n\u9ad8\u65af\u6d88\u5143 -> \u6d88\u6210\u4e0a\u4e09\u89d2\u77e9\u9635 \n\n\u9ad8\u65af-\u7ea6\u65e6\u6d88\u5143 -> \u6d88\u6210\u5bf9\u89d2\u77e9\u9635 \n```\n\n\u7ea6\u65e6\u6d88\u5143\u6cd5\u7684\u7cbe\u5ea6\u66f4\u597d,\u4ee3\u7801\u66f4\u7b80\u5355,**\u6ca1\u6709\u56de\u5e26\u7684\u8fc7\u7a0b** \n\n```cpp\nvoid Gauss_jordan(){\n\t/***** \u884c\u7684\u4ea4\u6362&\u52a0\u51cf\u6d88\u5143 *****/ \n\tfor(re int i=1,r;i<=n;++i){\t//\u6b63\u5728\u5904\u7406\u7b2ci\u884c \n\t\tr=i;\n\t\tfor(re int j=i+1;j<=n;++j) \n\t\t\tif(fabs(a[j][i])>fabs(a[r][i])) r=j;\n\t\tif(fabs(a[r][i])<eps){\n\t\t\tputs(\"No Solution\");return;\n\t\t}\n\t\tif(i!=r) swap(a[i],a[r]);\n\t\t\n\t\tfor(re int k=1;k<=n;++k){\n\t\t//\u6bcf\u4e00\u884c\u90fd\u5904\u7406  \n\t\t\tif(k==i) continue;\n\t\t\tdouble p=a[k][i]/a[i][i];\n\t\t\tfor(re int j=i;j<=n+1;++j) a[k][j]-=p*a[i][j];\n\t\t} \n\t}\t\n\t\n\t//\u4e0a\u8ff0\u64cd\u4f5c\u540e\u4f1a\u5269\u4e0b\u5bf9\u89d2\u77e9\u9635,\u7b54\u6848\u8981\u9664\u4ee5\u7cfb\u6570    \n\tfor(re int i=1;i<=n;++i) printf(\"%.2lf\\n\",a[i][n+1]/a[i][i]);\n}\n\n```\n\n**1.\u77e9\u9635\u6c42\u9006**\n\n\u601d\u8def\n* \u6c42$A$\u7684\u9006\u77e9\u9635\uff0c\u628a$A$\u548c\u5355\u4f4d\u77e9\u9635$I$\u653e\u5728\u4e00\u4e2a\u77e9\u9635\u91cc\n* \u5bf9$A$\u8fdb\u884c\u52a0\u51cf\u6d88\u5143\u4f7f$A$\u5316\u6210\u5355\u4f4d\u77e9\u9635\n* \u6b64\u65f6\u539f\u6765\u5355\u4f4d\u77e9\u9635\u8f6c\u5316\u6210\u9006\u77e9\u9635\n\n\u539f\u7406\n$$A^{-1} * [AI] = [I A^{-1}] $$\n\n\n\u4e3e\u4e2a\u6817\u5b50\n\n\u6c42\n$$\\begin{bmatrix}2 & -1 & 0 \\\\-1 & 2 & -1 \\\\0 & -1 & 2\\end{bmatrix}$$\n\n\u9996\u5148\n$$\\begin{bmatrix}2 & -1 & 0 & 1 & 0 & 0 \\\\-1 & 2 & -1 & 0 & 1 & 0 \\\\0 & -1 & 2 & 0 & 0 & 1 \\end{bmatrix}$$\n\n\u5bf9\u5de6\u8fb9\u8fdb\u884c\u6d88\u5143\u53ef\u5f97\n$$\\begin{bmatrix}2 & -1 & 0 & 1 & 0 & 0 \\\\ 0 & \\frac{3}{2} & -1 & \\frac{1}{2} & 1 & 0 \\\\0 & 0 & \\frac{4}{3} & \\frac{1}{3} &\\frac{2}{3} & 1  \\end{bmatrix}$$\n\n\u6b64\u65f6\u5df2\u6d88\u6210\u4e0a\u4e09\u89d2\u77e9\u9635\uff0c\u9ad8\u65af\u6d88\u5143\u5f00\u59cb\u56de\u4ee3\uff0c\u4f46\u7ea6\u65e6\u4f1a\u6d88\u6210\u5bf9\u89d2\u77e9\u9635\n$$\\begin{bmatrix}2 & 0 & 0 & \\frac{3}{2} & 1 & \\frac{1}{2} \\\\0 & \\frac{3}{2} & 0 & \\frac{3}{4} & \\frac{3}{2} & \\frac{3}{4} \\\\0 & 0 & \\frac{4}{3} & \\frac{1}{3} & \\frac{2}{3} & 1\\end{bmatrix}$$\n\n\u6700\u540e\u6bcf\u884c\u9664\u4ee5\u7cfb\u6570\n\n$$\\begin{bmatrix}1 & 0 & 0 & \\frac{3}{4} & \\frac{1}{2} & \\frac{1}{4} \\\\0 & 1 & 0 & \\frac{1}{2} & 1 & \\frac{1}{2} \\\\ 0 & 0 & 1 & \\frac{1}{4} & \\frac{1}{2} & \\frac{3}{4} \\end{bmatrix}$$\n\u6b64\u65f6\u53f3\u534a\u8fb9\u5373\u4e3a\u6240\u6c42\n\n\n**2.\u7ec6\u8282**\n\n1. \u5f00long long\uff08\u4e0d\u8981\u5192\u98ce\u9669\uff0c\u4e58\u6cd5\u5f88\u5bb9\u6613\u6ea2\u51fa\uff09 \n2. \u6a21\u610f\u4e49\u4e0b\u9664\u4ee5\u4e00\u4e2a\u6570\u7b49\u4e8e\u4e58\u4e0a\u9006\u5143\uff0c\u53ef\u7528\u5feb\u901f\u5e42\u6c42\u9006\u5143\uff08\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff09 \n\n$Code$\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#define re register\n#define il inline\n#define ll long long\nusing namespace std;\n\nil ll read(){\n    ll s=0,f=0;char c=getchar();\n    while(c<'0'||c>'9') f=(c=='-'),c=getchar();\n    while(c>='0'&&c<='9') s=(s<<3)+(s<<1)+(c^'0'),c=getchar();\n    return f?-s:s;\n}\n\nconst int N=405,mod=1e9+7;\nint n;\nll a[N][N<<1];\nil ll qpow(ll x,ll k){\n\tll ans=1;\n\twhile(k){\n\t\tif(k&1) ans=ans*x%mod;\n\t\tx=x*x%mod;\n\t\tk>>=1;\n\t}\n\treturn ans%mod;\n}\n\nil void Gauss_j(){\t\n\tfor(re int i=1,r;i<=n;++i){\n\t\tr=i;\n\t\tfor(re int j=i+1;j<=n;++j)\n\t\t\tif(a[j][i]>a[r][i]) r=j;\n\t\tif(r!=i) swap(a[i],a[r]);\n\t\tif(!a[i][i]){puts(\"No Solution\");return;}\n\t\t\n\t\tint kk=qpow(a[i][i],mod-2);\t//\u6c42\u9006\u5143 \n\t\tfor(re int k=1;k<=n;++k){\n\t\t\tif(k==i) continue;\n\t\t\tint p=a[k][i]*kk%mod;\n\t\t\tfor(re int j=i;j<=(n<<1);++j) \n\t\t\t\ta[k][j]=((a[k][j]-p*a[i][j])%mod+mod)%mod;\n\t\t} \n\t\t\n\t\tfor(re int j=1;j<=(n<<1);++j) a[i][j]=(a[i][j]*kk%mod);\n\t\t//\u66f4\u65b0\u5f53\u524d\u884c \u5982\u679c\u653e\u5728\u6700\u540e\u8981\u518d\u6c42\u4e00\u6b21\u9006\u5143,\u4e0d\u5982\u76f4\u63a5\u653e\u5728\u8fd9\u91cc  \n\t}\t\n\t\n\tfor(re int i=1;i<=n;++i){\n\t\tfor(re int j=n+1;j<(n<<1);++j) printf(\"%lld \",a[i][j]);\n\t\tprintf(\"%lld\\n\",a[i][n<<1]);\n\t}\n}\nint main(){\n\tn=read();\n\tfor(re int i=1;i<=n;++i)\n\t\tfor(re int j=1;j<=n;++j)\n\t\t\ta[i][j]=read(),a[i][i+n]=1;\n\t\n\tGauss_j();\n    return 0;\n}\n\n```\n\u7f51\u4e0a\u6d4f\u89c8\u4e00\u5708\u5934\u90fd\u8981\u70b8\u6389\uff0c\u7ebf\u6027\u4ee3\u6570\u592a\u53ef\u6015\u4e86\uff0c\u5b9a\u4e49\u597d\u591a\n\n\u6700\u540e\u53ea\u770b\u61c2\u4e86\u8fd9\u79cd\u65b9\u6cd5\n\n\u6709\u4ec0\u4e48\u95ee\u9898\u6b22\u8fce\u8bc4\u8bba\u533a\u6307\u51fa \uff1a\uff09\n\n\u53c2\u8003\u6587\u7ae0\n\n[\u7ebf\u6027\u4ee3\u6570\u4e4b\u2014\u2014\u77e9\u9635\u4e58\u6cd5\u548c\u9006\u77e9\u9635](https://www.cnblogs.com/seniusen/p/9962935.html)\n\n[\u9006\u77e9\u9635\u7684\u51e0\u79cd\u6c42\u6cd5\u4e0e\u89e3\u6790(\u5f88\u5168\u5f88\u7ecf\u5178)](https://wenku.baidu.com/view/b0525966f5335a8102d22078.html)",
        "postTime": 1566379596,
        "uid": 103655,
        "name": "\u4e00\u53ea\u840c\u65b0",
        "ccfLevel": 0,
        "title": "\u77e9\u9635\u6c42\u9006 \u2014\u2014 \u521d\u7b49\u53d8\u6362\u6cd5\uff08\u9ad8\u65af-\u7ea6\u65e6\u6d88\u5143\uff09"
    },
    {
        "content": "\u6211\u6570\u5b66\u592a\u5f31\u4e86\uff0c\u4e0d\u77e5\u9053\u6211\u7684\u505a\u6cd5\u4e3a\u4ec0\u4e48\u662f\u5bf9\u7684\u3002\u8bb0\u5f97\u5f53\u521d\u662f\u770b\u7740\u67d0\u7bc7\u767e\u5ea6\u6587\u5e93\u5b66\u4e60\u7684\u3002\u8fc7\u4e86\u51e0\u4e2a\u6708AC\u8fd9\u9053\u9898\uff0c\u53d1\u73b0\u539f\u7406\u5fd8\u5f97\u4e00\u5e72\u4e8c\u51c0\u4e86\u3002\u7ffb\u4e86\u534a\u5929\u53d1\u73b0\u627e\u4e0d\u5230\u90a3\u7bc7\u6587\u7ae0\u4e86\u3002\u5e0c\u671b\u6709\u5927\u4f6c\u80fd\u6307\u51fa\u6765\u6e90\u6216\u8005\u8bc1\u660e\u5b83\u7684\u6b63\u786e\u6027\u3002\n\n\u65e2\u7136\u6211\u8fde\u81ea\u5df1\u7684\u7a0b\u5e8f\u5199\u4e86\u4ec0\u4e48\u90fd\u4e0d\u662f\u975e\u5e38\u61c2\uff0c\u4e3a\u4ec0\u4e48\u8fd8\u8981\u5199\u8fd9\u7bc7\u9898\u89e3\u5462\uff1f\u6709\u4e09\u70b9\u539f\u56e0\uff1a\n\n1. \u6211\u7684\u65f6\u95f4\u548c\u7a7a\u95f4\u5e38\u6570\u90fd\u662f\u666e\u901a\u9ad8\u65af\u6d88\u5143\u7684\u4e00\u534a\uff08\u4ee3\u7801\u4e5f\u5dee\u4e0d\u591a\u957f\uff09\uff0c\u4e0d\u7528\u53e6\u6dfb\u4e00\u4e2a\u77e9\u9635\uff08\u5373\u539f\u5730\u505a\u6cd5\uff09\uff0c\u5b9e\u9645\u4e5f\u8dd1\u5f97\u98de\u5feb\n2. \u6bd4\u5404\u7c7b\u795e\u4ed9\u5206\u89e3\u4e0d\u77e5\u9053\u77ed\u5230\u54ea\u91cc\u53bb\u4e86\n3. \u7f51\u4e0a\u57fa\u672c**\u627e\u4e0d\u5230\u8fd9\u4e2a\u505a\u6cd5**\n\n\u5927\u81f4\u8fc7\u7a0b\u5982\u4e0b\uff08\u4ee3\u7801\u548c\u9ad8\u65af\u6d88\u53bb\u5dee\u4e0d\u591a\uff09\n\n\u4ece\u5927\u5230\u5c0f\u679a\u4e3e\u6240\u6709\u53f3\u4e0b\u89d2\u7684\u65b9\u9635(\u5373\u4ece(1,1)\u5230\u53f3\u4e0b\u89d2,\u4ece(2,2)\u5230\u53f3\u4e0b\u89d2,$\\dots$\u4e00\u76f4\u5230\u53f3\u4e0b\u89d2\u7684\u90a3\u4e00\u4e2a\u5143\u7d20)\uff0c\n\n\u2460\u627e\u5230\u5f53\u524d\u65b9\u9635\uff08\u5047\u8bbe\u662f\u7b2ck\u4e2a\uff09\u7684\u4e3b\u5143\n\n\u2461\u5c06\u4e3b\u5143\u6240\u5728\u884c\u3001\u5217\u4e0e\u7b2ck\u884c\u3001\u7b2ck\u5217\u4ea4\u6362\uff0c\u5e76\u4e14\u8bb0\u5f55\u4e0b\u4ea4\u6362\u7684\u884c\u548c\u5217\n\n\u2462\u628a\u7b2ck\u884c\u7b2ck\u4e2a\u5143\u7d20\u53d8\u6210\u5b83\u7684\u9006\u5143\uff08\u540c\u65f6\u5224\u65e0\u89e3\uff1a\u9006\u5143\u4e0d\u5b58\u5728\uff09\n\n\u2463\u66f4\u6539\u5f53\u524d\u884c\uff08\u4e58\u4e0a\u521a\u624d\u90a3\u4e2a\u9006\u5143\uff09\n\n\u2464\u5bf9\u77e9\u9635\u4e2d\u7684\u5176\u4ed6\u884c\u505a\u548c\u9ad8\u65af\u6d88\u5143\u51e0\u4e4e\u5b8c\u5168\u4e00\u6837\u7684\u64cd\u4f5c\uff0c**\u53ea\u6709\u6bcf\u884c\u7684\u7b2ck\u5217\u4e0d\u4e00\u6837\uff0c\u5177\u4f53\u770b\u4ee3\u7801**\n\n\u2465\u6700\u540e\u628a\u7b2c\u2461\u6b65\u4e2d\u7684\u4ea4\u6362\u9006\u5e8f\u5730\u4ea4\u6362\u56de\u53bb\u3002\n\n\u6700\u540e\u653e\u4ee3\u7801\uff1a\n\n```cpp\n// luogu-judger-enable-o2\n#include<bits/stdc++.h>\n#define int64 long long\nusing namespace std;\nconst int64 mod=1e9+7;\nint64 a[410][410];\nint n,is[410],js[410];\nvoid exgcd(int a,int b,int &x,int &y){\n    if(!b)return x=1,y=0,void();\n    exgcd(b,a%b,y,x);y-=x*(a/b);\n}\nint inv(int p){\n    int x,y;exgcd(p,mod,x,y);\n    return (x+mod)%mod;\n}\nvoid inv(){\n    for(int k=1;k<=n;k++){\n        for(int i=k;i<=n;i++) // 1\n            for(int j=k;j<=n;j++)if(a[i][j]){\n                is[k]=i,js[k]=j;break;\n            }\n        for(int i=1;i<=n;i++) // 2\n            swap(a[k][i],a[is[k]][i]);\n        for(int i=1;i<=n;i++)\n            swap(a[i][k],a[i][js[k]]);\n        if(!a[k][k]){\n            puts(\"No Solution\");\n            exit(0);\n        }\n        a[k][k]=inv(a[k][k]); // 3\n        for(int j=1;j<=n;j++)if(j!=k) // 4\n            (a[k][j]*=a[k][k])%=mod;\n        for(int i=1;i<=n;i++)if(i!=k) // 5\n            for(int j=1;j<=n;j++)if(j!=k)\n                (a[i][j]+=mod-a[i][k]*a[k][j]%mod)%=mod;\n        for(int i=1;i<=n;i++)if(i!=k) // \u5c31\u662f\u8fd9\u91cc\u4e0d\u540c\n            a[i][k]=(mod-a[i][k]*a[k][k]%mod)%mod;\n    }\n    for(int k=n;k;k--){ // 6\n        for(int i=1;i<=n;i++)\n            swap(a[js[k]][i],a[k][i]);\n        for(int i=1;i<=n;i++)\n            swap(a[i][is[k]],a[i][k]);\n    }\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;i++)\n        for(int j=1;j<=n;j++)\n            scanf(\"%lld\",a[i]+j);\n    inv();\n    for(int i=1;i<=n;i++)\n        for(int j=1;j<=n;j++)\n            printf(\"%lld%c\",a[i][j],j==n?'\\n':' ');\n    return 0;\n}\n```\n",
        "postTime": 1537346690,
        "uid": 30093,
        "name": "cosmicAC",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4783 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u6c42\u9006\u3011"
    },
    {
        "content": "[\u4f20\u9001\u95e8](https://www.luogu.org/problemnew/show/P4783)\n\n\u7ebf\u6027\u4ee3\u6570\u771f\u7684\u597d\u73c2\u6015\u2026\u2026\u4ee5\u4e0b\u5982\u679c\u6709\u6f0f\u6d1e\u6b22\u8fce\u6307\u51fa\u2026\u2026\u66f4\u591a\u7684\u5efa\u8bae\u53bb\u5b66\u4e60\u4e00\u4e0b\u7ebf\u4ee3\u7684\u8bf4\u2026\u2026\n\n\u5b9a\u4e49\u77e9\u9635\u7684\u4e09\u79cd\u521d\u7b49\u884c\u53d8\u6362\uff1a\n\n1.\u4ea4\u6362\u67d0\u4e24\u884c\n\n2.\u5c06\u67d0\u4e00\u884c\u7684\u6240\u6709\u5143\u7d20\u4e58\u4e0a$k$($k\\neq 0$)\n\n3.\u5c06\u67d0\u4e00\u884c\u7684\u6240\u6709\u5143\u7d20\u4e58\u4e0a$k$\u52a0\u5230\u53e6\u4e00\u884c\u53bb\n\n\u6bcf\u4e00\u4e2a\u521d\u7b49\u53d8\u6362\u90fd\u5bf9\u5e94\u4e00\u4e2a\u521d\u7b49\u77e9\u9635\uff0c\u5373\u77e9\u9635$A$\u505a\u67d0\u4e00\u7ebf\u6027\u53d8\u6362\u7b49\u4ef7\u4e8e\u7528\u4e00\u4e2a\u5bf9\u5e94\u7684\u521d\u7b49\u77e9\u9635\u5de6\u4e58$A$\u3002\u82e5\u6709\u4e00\u5806\u521d\u7b49\u53d8\u6362$1,2,...l$\uff0c\u5bf9\u5e94\u7684\u521d\u7b49\u77e9\u9635\u5206\u522b\u4e3a$P_1,P_2,...,P_l$\uff0c\u90a3\u4e48\u7ecf\u8fc7\u8fd9\u4e9b\u7ebf\u6027\u53d8\u6362\u540e\u7684\u77e9\u9635\u5373\u4e3a$P_l....P_2P_1A=PA$\uff08$P$\u4e3a\u4e4b\u524d\u90a3\u5806\u4e1c\u897f\u7684\u4e58\u79ef\uff09\n\n\u5bf9\u4e8e\u4e00\u4e2a\u77e9\u9635$A$\uff0c$A$\u53ef\u9006\u7684\u5145\u5206\u5fc5\u8981\u6761\u4ef6\u662f$A$\u7ecf\u8fc7\u82e5\u5e72\u6b21\u521d\u7b49\u884c\u53d8\u6362\u53ef\u4ee5\u53d8\u6210$E$\uff08$E$\u5373\u5355\u4f4d\u77e9\u9635\uff09\uff0c\u5373\u5b58\u5728\u4e00\u4e2a\u77e9\u9635$P$\u4f7f\u5f97$PA=E$\uff0c\u5219$P=A^{-1}$\n\n\u901a\u8fc7\u521d\u7b49\u884c\u53d8\u6362\u4f7f\u5f97$A$\u53d8\u4e3a$E$\u5e76\u4e0d\u56f0\u96be\uff0c\u53ef\u4ee5\u7528\u9ad8\u65af\u6d88\u5143\u89e3\u51b3\uff0c\u5148\u6d88\u6210\u4e0a\u4e09\u89d2\u77e9\u9635\uff0c\u7136\u540e\u518d\u6d88\u6210\u5bf9\u89d2\u77e9\u9635\n\n\u8003\u8651\u600e\u4e48\u6c42\u51fa$P$\uff0c\u56e0\u4e3a\u6709$PA=E,PE=P$\uff0c\u5982\u679c\u6211\u4eec\u540c\u65f6\u7ef4\u62a4\u4e24\u4e2a\u77e9\u9635$A,B$\uff0c\u4ee4$B$\u4e00\u5f00\u59cb\u65f6\u7b49\u4e8e$E$\uff0c\u5728\u628a$A$\u53d8\u4e3a$E$\u7684\u8fc7\u7a0b\u4e2d\u5bf9$B$\u4e5f\u505a\u76f8\u7b49\u7684\u521d\u7b49\u53d8\u6362\uff0c\u90a3\u4e48\u5f53$A$\u53d8\u4e3a$E$\u65f6\uff0c$B$\u4e5f\u5c31\u53d8\u4e3a\u4e86$P$\uff08\u56e0\u4e3a\u505a\u521d\u7b49\u884c\u53d8\u6362\u7b49\u4ef7\u4e8e\u88ab\u5bf9\u5e94\u7684\u521d\u7b49\u77e9\u9635\u5de6\u4e58\uff09\n\n\u5982\u679c\u5728\u9ad8\u65af\u6d88\u5143\u7684\u8fc7\u7a0b\u4e2d\u53d1\u73b0\u65e0\u6cd5\u5c06$A$\u53d8\u4e3a$E$\uff0c\u8f93\u51fa\u65e0\u89e3\u5373\u53ef\n```\n//minamoto\n#include<bits/stdc++.h>\nusing namespace std;\n#define getc() (p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\nchar buf[1<<21],*p1=buf,*p2=buf;\nint read(){\n    int res,f=1;char ch;\n    while((ch=getc())>'9'||ch<'0')(ch=='-')&&(f=-1);\n    for(res=ch-'0';(ch=getc())>='0'&&ch<='9';res=res*10+ch-'0');\n    return res*f;\n}\nchar sr[1<<21],z[20];int C=-1,Z=0;\ninline void Ot(){fwrite(sr,1,C+1,stdout),C=-1;}\nvoid write(int x){\n    if(C>1<<20)Ot();if(x<0)sr[++C]='-',x=-x;\n    while(z[++Z]=x%10+48,x/=10);\n    while(sr[++C]=z[Z],--Z);sr[++C]=' ';\n}\nconst int N=405,mod=1e9+7;\nint n;\nstruct Matrix{\n    int a[N][N];\n    inline void clr(){memset(a,0,sizeof(a));}\n    int* operator [](int x){return a[x];}\n    void SWAP(int x,int y){for(int i=1;i<=n;++i)swap(a[x][i],a[y][i]);}\n    //\u4ea4\u6362\u67d0\u4e24\u884c\n    void MUL(int x,int k){for(int i=1;i<=n;++i)a[x][i]=(1ll*a[x][i]*k%mod+mod)%mod;}\n    //\u5c06\u67d0\u4e00\u884c\u7684\u6240\u6709\u5143\u7d20\u4e58\u4e0ak\n    void MD(int x,int y,int k){for(int i=1;i<=n;++i)a[x][i]=((a[x][i]+(1ll*a[y][i]*k%mod))%mod+mod)%mod;}\n    //\u5c06\u67d0\u4e00\u884c\u7684\u6240\u6709\u5143\u7d20\u4e58\u4e0ak\u52a0\u5230\u53e6\u4e00\u884c\u53bb\n\tvoid print(){\n        for(int i=1;i<=n;++i){\n            for(int j=1;j<=n;++j)write(a[i][j]);\n            sr[++C]='\\n';\n        }\n    }\n}A,B;\nint ksm(int a,int b=mod-2){\n    int res=1;\n    for(;b;b>>=1,a=1ll*a*a%mod)if(b&1)res=1ll*res*a%mod;\n    return res;\n}\nint main(){\n//\tfreopen(\"testdata.in\",\"r\",stdin);\n    n=read();\n    for(int i=1;i<=n;++i)for(int j=1;j<=n;++j)A[i][j]=read();\n    for(int i=1;i<=n;++i)B[i][i]=1;\n    for(int i=1;i<=n;++i){\n    \t//\u6d88\u6210\u4e0a\u4e09\u89d2\u77e9\u9635 \n        if(!A[i][i]){\n            for(int j=i+1;j<=n;++j)if(A[j][i]){\n                A.SWAP(i,j),B.SWAP(i,j);break;\n            }\n        }\n        if(!A[i][i])return puts(\"No Solution\"),0;\n        //\u5982\u679c\u6d88\u7740\u6d88\u7740\u67d0\u4e00\u5217\u6ca1\u6709\u6570\u4e86\uff0c\u8bf4\u660e\u65e0\u89e3 \n        B.MUL(i,ksm(A[i][i])),A.MUL(i,ksm(A[i][i]));\n        for(int j=i+1;j<=n;++j)\n        B.MD(j,i,-A[j][i]),A.MD(j,i,-A[j][i]);\n    }\n    //\u6d88\u6210\u5bf9\u89d2\u77e9\u9635 \n    for(int i=n-1;i;--i)for(int j=i+1;j<=n;++j)\n    B.MD(i,j,-A[i][j]),A.MD(i,j,-A[i][j]);\n    B.print();return Ot(),0;\n}\n```",
        "postTime": 1542110956,
        "uid": 41781,
        "name": "bztMinamoto",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4783 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u6c42\u9006\u3011"
    },
    {
        "content": "### \u4e25\u683c\u8bc1\u660e\u6765\u4e86\uff01\n\n\u5982\u679c\u8fd8\u4e0d\u7528\u5b66\u4e60\u7ebf\u6027\u4ee3\u6570\u7684\u7ae5\u978b\u4eec\uff0c\u53ef\u4ee5\u76f4\u63a5\u770b\u4e0b\u6587\u7684\u7b80\u5316\u9898\u89e3\uff0c\u8df3\u8fc7\u4e2d\u95f4\u7684\u8bc1\u660e\uff1b~~\u4f46\u662f\u8981\u662f\u5351\u5fae\u7684\u5927\u5b66\u7272\uff0c\u5efa\u8bae\u8fd8\u662f\u5eb7\u5eb7\u5427\uff08\u5927\u96fe\uff09~~\n\n## \u5b8c\u6574\u8bc1\u660e\u7248\n\n\u9700\u8981\u4ee5\u4e0b\u524d\u7f6e\u77e5\u8bc6\uff1a\n\n1.\u77e9\u9635\u7684\u9006\u53ca\u5176\u5b58\u5728\u7684\u5224\u5b9a\u65b9\u6cd5\n\n2.\u521d\u7b49\u77e9\u9635\u53ca\u5176\u6027\u8d28\n\n### \u77e9\u9635\u7684\u9006\n\n\u7531\u4e8e\u6211\u4eec\u5728\u5b9a\u4e49\u77e9\u9635\u8fd0\u7b97\u7684\u65f6\u5019\u53ea\u5b9a\u4e49\u4e86\u6570\u4e58\u548c\u77e9\u9635\u4e58\u6cd5\uff0c\u800c\u6ca1\u6709\u9664\u6cd5\u8fd0\u7b97\u3002\u548c\u9006\u5143\u7684\u4ea7\u751f\u4e00\u6837\uff0c\u6211\u4eec\u4e3a\u4e86\u5b9a\u4e49\u51fa\u9664\u6cd5\uff0c\u6211\u4eec\u91c7\u7528\u4e58\u4e00\u4e2a\u6570/\u77e9\u9635\u5f97\u5230\u5355\u4f4d $1$/\u5355\u4f4d\u77e9\u9635\u7684\u65b9\u6cd5\uff0c\u5e76\u5b9a\u4e49\u8fd9\u4e2a\u6570/\u77e9\u9635\u4e3a\u539f\u6570/\u539f\u77e9\u9635\u7684\u4e58\u6cd5\u3002\n\n\u6ce8\uff1a\u5355\u4f4d\u77e9\u9635\u662f\u4e00\u4e2a\u9664\u4e86\u4e3b\u5bf9\u89d2\u7ebf\u4e3a $1$\uff0c\u5176\u4ed6\u5168\u4e3a $0$ \u7684\u65b9\u9635\u3002\u7531\u4e8e\u9636\u6570\u4e0d\u56fa\u5b9a\uff0c\u56e0\u800c\u6709\u65e0\u7a77\u591a\u79cd\u5355\u4f4d\u77e9\u9635\u3002\n\n$$ \\begin{bmatrix} 1 & 0 & 0\\\\ 0 & 1 & 0\\\\ 0 & 0 & 1\\\\\\end{bmatrix} $$\n\n**\u5b9a\u4e49\uff1a\u8bbe $A$ \u4e3a $n$ \u9636\u65b9\u9635\uff0c\u82e5\u5b58\u5728$n$\u9636\u65b9\u9635 $B$\uff0c\u4f7f\u5f97 $AB=BA=I$\uff0c\u5219\u79f0 $B$ \u4e3a $A$ \u7684\u9006\uff0c\u5e76\u79f0 $A$ \u4e3a\u53ef\u9006\u77e9\u9635\u3002** \u8bb0 $A^{-1}$ \u4e3a $A$ \u7684\u9006\u3002\n\n\u82e5 $A$ \u53ef\u9006\uff0c\u5219\u9006\u552f\u4e00\u3002\n\n\u8bc1\u660e\uff1a\u82e5 $B$ \u4e0e $C$ \u90fd\u662f $A$ \u7684\u9006\uff0c\u7531\u5b9a\u4e49 $AB=BA=I$\uff0c$AC=CA=I$\uff0c\u5219\u6709\uff1a\n\n$$ B=IB=(CA)B=C(AB)=CI=C$$\n\n\u5373 $B=C$\u3002\n\n\u6709\u4e00\u79cd\u7528\u884c\u5217\u5f0f\u6765\u5224\u5b9a\u548c\u8ba1\u7b97\u77e9\u9635\u662f\u5426\u53ef\u9006\u7684\u65b9\u6cd5\uff0c\u8fc7\u4e8e\u7e41\u7410\uff0c\u4e0d\u9002\u7528\u4e8e\u8ba1\u7b97\uff0c\u53ea\u5728\u6b64\u4ecb\u7ecd\u3002\n\n\u5b9a\u4e49\uff1a\u8bbe $n$ \u9636\u65b9\u9635\n\n$$\n        \\begin{bmatrix}\n        a_{1,1} & a_{1,2} & a_{1,3} & \\cdots & a_{1,n} \\\\\n        a_{2,1} & a_{2,2} & a_{2,3} & \\cdots & a_{2,n} \\\\\n        \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n        a_{n,1} & a_{n,2} & a_{n,3} & \\cdots & a_{n,n} \\\\\n        \\end{bmatrix}\n$$\n\n\u7531 $A$ \u7684\u884c\u5217\u5f0f $|A|$ \u4e2d\u5143\u7d20 $a_{ij}$ \u7684\u4ee3\u6570\u4f59\u5b50\u5f0f $A_{ij}$ \u6784\u6210\u7684\u5982\u4e0b $n$ \u9636\u65b9\u9635\uff1a\n\n$$\n        A^*=\\begin{bmatrix}\n        A_{11} & A_{21} & A_{31} & \\cdots & A_{n1} \\\\\n        A_{12} & A_{22} & A_{32} & \\cdots & A_{n2} \\\\\n        \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n        A_{n1} & A_{n2} & A_{3n} & \\cdots & A_{nn} \\\\\n        \\end{bmatrix}\n$$\n\n\u79f0 $A^*$ \u4e3a $A$ \u7684\u4f34\u968f\u77e9\u9635\uff0c\u800c $A$ \u53ef\u9006\u7684\u5145\u8981\u6761\u4ef6\u4e3a $|A| \\neq 0$\uff0c\u4e14\n\n$$A^{-1}=\\frac{A^*}{|A|}$$\n\n\u6b64\u5904\u8bc1\u660e\u9700\u8981\u7528\u5230\u884c\u5217\u5f0f\u7684\u6027\u8d28\uff0c\u5728\u6b64\u7565\u53bb\u3002\n\n\u4e0b\u6587\u6709\u66f4\u7b80\u5355\u7684\u5224\u5b9a\u548c\u8ba1\u7b97\u65b9\u6cd5\u3002\n\n\u9006\u53d8\u6362\u6709\u4e00\u91cd\u8981\u6027\u8d28\uff1a\u82e5$A,B$\u5747\u53ef\u9006\uff0c\u5219$AB$\u4e5f\u53ef\u9006\uff0c\u4e14$(AB)^{-1}=B^{-1}A^{-1}$\u3002\u8be5\u6027\u8d28\u53ef\u4ee5\u53cd\u590d\u5229\u7528\uff0c\u56e0\u6b64\u53ef\u4ee5\u62d3\u5c55\u5230$k$\u4e2a\u53ef\u9006\u884c\u5217\u5f0f\u76f8\u4e58\uff1a\n\n$$(A_1A_2\u2026\u2026A_k)^{-1}=A_k^{-1}A_{k-1}^{-1}\u2026\u2026A_1^{-1}$$\n\n### \u521d\u7b49\u77e9\u9635\n\n\u628a\u5355\u4f4d\u77e9\u9635\u8fdb\u884c\u4e00\u6b21\u521d\u7b49\u884c\u53d8\u6362\uff0c\u5c31\u5f97\u5230\u4e86\u521d\u7b49\u77e9\u9635\u3002\u5176\u4e2d\uff0c\u521d\u7b49\u884c\u53d8\u6362\u6709\u4ee5\u4e0b\u4e09\u79cd\uff1a\n\n1.\u4ea4\u6362\u77e9\u9635\u7684\u4efb\u610f\u4e24\u884c\u3002\n\n2.\u7528\u4e00\u4e2a\u975e\u96f6\u6574\u6570 $k$ \u4e58\u77e9\u9635\u7684\u4efb\u610f\u4e00\u884c\u3002\n\n3.\u5c06\u77e9\u9635\u4e2d\u67d0\u4e00\u884c\u4e58\u4ee5 $k$ \u500d\u52a0\u5230\u53e6\u5916\u4e00\u884c\u3002\n\n\u56e0\u6b64\u5bf9\u4e8e\u4e09\u9636\u5355\u4f4d\u77e9\u9635 $I_3$\n\n$$\n        \\begin{bmatrix}\n        1 & 0 & 0 \\\\\n        0 & 1 & 0\\\\\n        -4 & 0 & 1 \\\\\n        \\end{bmatrix}\n       \\begin{bmatrix}\n        0 & 1 & 0 \\\\\n        1 & 0 & 0\\\\\n        0 & 0 & 1 \\\\\n        \\end{bmatrix}\n        \\begin{bmatrix}\n        1 & 0 & 0 \\\\\n        0 & 1 & 0\\\\\n        0 & 0 & 5 \\\\\n        \\end{bmatrix}\n$$\n\n\u5747\u4e3a\u521d\u7b49\u77e9\u9635\u3002\n\n\u7531\u4e8e\u521d\u7b49\u884c\u53d8\u6362\u53ef\u9006\uff08\u53ef\u4ee5\u6539\u8fc7\u53bb\u53c8\u53ef\u4ee5\u6539\u56de\u6765\uff09\uff0c\u56e0\u6b64\u521d\u7b49\u77e9\u9635\u53ef\u9006\u3002\n\n\u8bc1\u660e\uff1a\u8bbe $E$ \u4e3a\u4e00\u521d\u7b49\u77e9\u9635\uff0c\u7531\u4e8e $EI=E$\uff0c\u56e0\u6b64\u4efb\u610f\u4e00\u4e2a\u521d\u7b49\u77e9\u9635\u53ef\u4ee5\u89c6\u4e3a\u5bf9 $I$ \u77e9\u9635\u7684\u4e00\u79cd\u53d8\u6362\uff0c\u4f7f\u5176\u53d8\u4e3a $E$ \u77e9\u9635\u3002\u7531\u4e8e\u521d\u7b49\u884c\u53d8\u6362\u53ef\u9006\uff0c\u5219\u5b58\u5728 $E$ \u53d8\u6362\u7684\u9006\u53d8\u6362 $F$\uff0c\u5c06 $E$ \u77e9\u9635\u53d8\u56de $I$\uff0c\u56e0\u6b64 $EF=I$\uff0c\u5373 $E$ \u53ef\u9006\uff0c\u4e14\u5176\u9006\u4e3a $E$ \u7684\u9006\u53d8\u6362\u3002\n\n\n\n------------\n\u5230\u6b64\u53ef\u4ee5\u5f15\u51fa\u672c\u9898\u7684\u8bc1\u660e\u4e86\uff1a\n\n**\u65b9\u9635 $A$ \u53ef\u9006\uff0c\u5f53\u4e14\u4ec5\u5f53 $A$ \u884c\u7b49\u4ef7\u4e8e $I_n$** \uff0c\u5373 $A$ \u7ecf\u8fc7\u82e5\u5e72\u6b21\u884c\u53d8\u6362\u53ef\u4ee5\u53d8\u6210 $I_n$\u3002\n\n\u5145\u5206\u6027\uff1a\u7531\u4e8e $A$ \u53ef\u9006\uff0c\u5219\u65b9\u7a0b $Ax=b$ \u5fc5\u6709\u89e3\uff0c\u5176\u4e2d $x,b$ \u5747\u4e3a\u5411\u91cf\uff08\u6c42\u89e3\u53ea\u9700\u8981\u5728\u7b49\u5f0f\u4e24\u8fb9\u5de6\u4e58\u4ee5 $A^{-1}$ \u5373\u53ef\uff09\u3002\u90a3\u4e48\uff0c\u5bf9\u4e8e\u89e3 $x$\uff1a\n\n$$\n        x=\\begin{bmatrix}\n        x_1\\\\\n        x_2\\\\\n        \\vdots\\\\\n        x_n\\\\\n        \\end{bmatrix}\n$$\n\n\u5fc5\u53ef\u5199\u51fa\u4e0e $A$ \u7b49\u4ef7\u7684\u589e\u5e7f\u77e9\u9635 $A'$\uff08\u56e0\u4e3a\u89e3\u4e00\u6837\uff09\uff1a\n\n$$\n        A'=\\left[\n    \\begin{array}{cccc|c}\n      1&&&&x_1\\\\\n      &1&&&x_2\\\\\n      &&\\ddots\\ && \\vdots\\\\\n      &&&1&x_n\n    \\end{array}\n\\right]\n$$\n\n\u90a3\u4e48\u539f\u77e9\u9635\u5fc5\u4e0e $I_n$ \u7b49\u4ef7\uff0c\u5426\u5219\u65e0\u6cd5\u5316\u7b80\u6210 $A'$\n\n\u5fc5\u8981\u6027\uff1a\u5982\u679c $A$ \u7b49\u4ef7\u4e8e $I_n$\uff0c\u5219 $A$ \u662f\u7531\u82e5\u5e72\u6b21\u521d\u7b49\u884c\u53d8\u6362\u5f97\u5230\u3002\u5bf9\u4e8e\u6bcf\u6b21\u521d\u7b49\u884c\u53d8\u6362\u90fd\u6709\u4e00\u4e2a\u5bf9\u5e94\u7684\u521d\u7b49\u77e9\u9635\uff0c\u90a3\u4e48\u8fd9\u4e9b\u64cd\u4f5c\u53ef\u4ee5\u88ab\u8bb0\u4f5c\uff1a\n\n$$E_pE_{p-1}\u2026\u2026E_1A=I_n$$\n\n\u7531\u77e9\u9635\u9006\u7684\u53e6\u4e00\u79cd\u5b9a\u4e49\uff0c\u82e5 $A$ \u53ef\u9006\uff0c\u5219\u5fc5\u5b58\u5728\u4e00\u79cd\u80fd\u8ba9 $A$ \u56de\u5230 $I_n$ \u7684\u65b9\u6cd5\u3002\u8003\u8651\u5bf9\u4e0a\u5f0f\u4e24\u8fb9\u5de6\u4e58 $(E_pE_{p-1}\u2026\u2026E_1)^{-1}$\n\n$$((E_pE_{p-1}\u2026\u2026E_1)^{-1}E_pE_{p-1}\u2026\u2026E_1)A=(E_pE_{p-1}\u2026\u2026E_1)^{-1}I_n$$\n\n\u5373 $A=(E_pE_{p-1}\u2026\u2026E_1)^{-1}$\uff0c\u4e3a\u53ef\u9006\u77e9\u9635\u7684\u4e58\u79ef\uff0c\u56e0\u6b64 $A$ \u53ef\u9006\uff0c\u4e14 $A^{-1}=E_pE_{p-1}\u2026\u2026E_1$\u3002\u56e0\u6b64\uff0c$A^{-1}$ \u53ef\u4ee5\u7531 $E_1,E_2,\u2026\u2026,E_p$ \u4f9d\u6b21\u4f5c\u7528\u4e8e $I_n$ \u5f97\u5230\u3002\n\n\u5f97\u8bc1\u3002\n\n------------\n### \u63a5\u4e0b\u6765\u5c31\u662f\u89e3\u6cd5\u65f6\u95f4\n\n\u6211\u4eec\u628a $A$ \u548c $I_n$ \u7f6e\u4e8e\u540c\u4e00\u77e9\u9635\u4e2d\uff1a\n\n$$\n        \\begin{bmatrix}\n        A & I_n\n        \\end{bmatrix}\n$$\n\n\u5bf9\u5176\u8fdb\u884c\u9ad8\u65af-\u82e5\u5c14\u5f53\u6d88\u5143\u64cd\u4f5c\u5c06$A$\u53d8\u6362\u4e3a$I_n$\u3002\u7531\u4e8e\u662f\u5728\u540c\u4e00\u77e9\u9635\u4e2d\uff0c\u56e0\u6b64$A$\u548c$I_n$\u5f97\u5230\u7684\u64cd\u4f5c\u90fd\u662f\u4e00\u6837\u7684\u3002\u6211\u4eec\u53ea\u9700\u8981\u8ba9\u524d\u9762\u7684$A$\u53d8\u6362\u4e3a$I_n$\uff0c\u90a3\u4e48\u5bf9\u4e8e\u540c\u4e00\u8fc7\u7a0b\uff0c$I_n$\u5c31\u4f1a\u53d8\u6210\u77e9\u9635\u7684\u9006\u3002\n\n\u7528\u4e00\u5f20\u56fe\u6765\u8868\u793a\u8fd9\u4e2a\u4e92\u76f8\u8f6c\u5316\u5173\u7cfb\uff1a\n\n$$ A\\stackrel{P}{\\underset{P'}{\\Leftrightarrow}}I_n\\stackrel{P}{\\underset{P'}{\\Leftrightarrow}}A^{-1}$$\n\n\u6240\u4ee5\u5269\u4e0b\u7684\u5c31\u662f\u4ee3\u7801\u529f\u592b\u4e86\u3002\u4ee3\u7801\u9644\u4e0a\uff1a\n\n```cpp\n#include <cstdio>\n#include <algorithm>\nusing namespace std;\nconst long long mod = 1000000007;\nlong long power(long long a,int x)//\u5feb\u901f\u5e42\u677f\u5b50\n{\n    long long ans = 1;\n    while(x)\n    {\n        if(x&1)\n        {\n            ans *= a;\n            ans %= mod;\n        }\n        a *= a;\n        a %= mod;\n        x >>= 1;\n    }\n    return ans % mod;\n}\nlong long a[405][805];\nint main()\n{\n    int n, m;\n    scanf(\"%d\", &n);\n    m = 2 * n;//\u77e9\u9635\u7684\u5bbd\n    for (int i = 1; i <= n;i++)\n    {\n        for (int j = 1; j <= n;j++)\n            scanf(\"%lld\", &a[i][j]);\n        a[i][i + n] = 1;//\u540e\u9762\u8981\u8ddf\u4e0a\u4e00\u4e2an\u9636\u5355\u4f4d\u77e9\u9635\n    }\n    for (int i = 1; i <= n; i++)//\u9ad8\u65af-\u82e5\u5c14\u5f53\u6d88\u5143\u7684\u677f\u5b50\n    {\n        int place = i;\n        for (int j = i + 1; j <= n; j++)//\u627e\u5230\u7edd\u5bf9\u503c\u6700\u5927\u7684\u5143\u7d20\u5f00\u59cb\u6d88\u5143\n            if(abs(a[j][i])>abs(a[place][i]))\n                place = j;\n        if (i != place)\n            swap(a[i], a[place]);\n        if(!a[i][i])//\u5982\u679c\u67d0\u884c\u6ca1\u6709\u4e3b\u5143\u5219A\u65e0\u6cd5\u5316\u4e3a\u5355\u4f4d\u77e9\u9635\uff0c\u65e0\u89e3\n        {\n            printf(\"No Solution\");\n            return 0;\n        }\n        long long inv = power(a[i][i], mod - 2);//\u672c\u9898\u52a0\u5165\u7684\u9006\u5143\u7279\u8272\n        for (int j = 1; j <= n; j++)\n            if(j!=i)\n            {\n                long long multiple = a[j][i] * inv % mod;//\u7b49\u4ef7\u4e8e\u9664\u4ee5a[i][i]\uff0c\u6d88\u53bb\u5176\u4ed6\u884c\u5728\u7b2ci\u5217\u4e0a\u7684\u6570\uff0c\u4f7f\u4e4b\u53d8\u6210\u7b80\u5316\u9636\u68af\u5f62\u77e9\u9635\n                for (int k = i; k <= m; k++)\n                    a[j][k] = ((a[j][k] - a[i][k] * multiple) % mod + mod) % mod;\n            }\n        for (int j = 1; j <= m; j++)//\u7531\u4e8e\u6b64\u5904\u9700\u8981\u7b80\u5316\u9636\u68af\u578b\u77e9\u9635\uff0c\u8981\u628a\u539f\u77e9\u9635\u5316\u4e3a\u7b80\u5316\u77e9\u9635\u7684\u5fc5\u987b\u64cd\u4f5c\u3002\n        //\u201c\u5728\u4f7f\u7528\u9ad8\u65af-\u82e5\u5c14\u5f53\u6d88\u5143\u7684\u65f6\u5019\uff0c\u8ba1\u7b97\u673a\u8ba1\u7b97\u7684\u65f6\u5019\u901a\u5e38\u91c7\u7528\u56de\u5e26\u6cd5\uff0c\u800c\u4eba\u64cd\u4f5c\u7684\u65f6\u5019\u5efa\u8bae\u91c7\u7528\u6b64\u6cd5\u3002\u201d\u2014\u2014\u300a\u7ebf\u6027\u4ee3\u6570\u53ca\u5176\u5e94\u7528\u300b\n            a[i][j] = (a[i][j] * inv % mod);\n    }\n    for (int i = 1; i <= n;i++)\n    {\n        for (int j = n + 1; j <= m; j++)//\u53ea\u6253\u5370\u540e\u9762\uff0c\u524d\u9762\u7684\u5355\u4f4d\u77e9\u9635\u4e0d\u8981\u6253\u51fa\u6765\u4e86\n            printf(\"%lld \", a[i][j]);\n        printf(\"\\n\");\n    }\n    return 0;\n}\n```\n",
        "postTime": 1611371922,
        "uid": 80026,
        "name": "walk_alone",
        "ccfLevel": 3,
        "title": "\u9898\u89e3 P4783 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u6c42\u9006\u3011"
    },
    {
        "content": "\u601d\u8def\uff1a\u5728\u8bfb\u5165\u7684$n$\u9636\u77e9\u9635\u53f3\u4fa7\u52a0\u5165\u4e00\u4e2a**$n$\u9636\u5355\u4f4d\u77e9\u9635**\uff0c\u7136\u540e\u505a**\u9ad8\u65af\u6d88\u5143**\uff0c\u4f7f\u8bfb\u5165\u7684$n$\u9636\u77e9\u9635\u5316\u4e3a$n$\u9636\u5355\u4f4d\u77e9\u9635\uff0c\u6b64\u65f6\u53f3\u9762\u52a0\u5165\u7684\u77e9\u9635\u5c31\u4e3a\u6240\u6c42\u7684\u9006\u3002\n```\n#include<cstdio>\n#include<iostream>\nusing namespace std;\ntypedef long long LL;\nconst int N=405;\nconst LL mod=1e9+7;\nint n,m;\nLL f[N][N<<1];\nLL r,ret;\nLL ksm(LL u,LL v){  //\u6c42\u9006\u5143 \n    ret=1;\n    while(v){\n        if(v&1)ret=ret*u%mod;\n        u=u*u%mod;v>>=1;\n    }\n    return ret;\n}\nint main(){\n    scanf(\"%d\",&n);m=n*2;\n    for(int i=1;i<=n;++i){\n        for(int j=1;j<=n;j++)scanf(\"%lld\",&f[i][j]);\n        f[i][n+i]=1;  //\u5355\u4f4d\u77e9\u9635 \n    }\n    for(int i=1;i<=n;++i){  //\u9ad8\u65af\u6d88\u5143\u677f\u5b50 \n        for(int j=i;j<=n;j++)\n        if(f[j][i]){\n            for(int k=1;k<=m;k++)\n            swap(f[i][k],f[j][k]);  //\u5148\u4ea4\u6362 \n            break;\n        }\n        if(!f[i][i]){puts(\"No Solution\");return 0;}  //\u5224\u65ad\u662f\u5426\u6709\u89e3 \n        r=ksm(f[i][i],mod-2);  //\u6c42\u9006\u5143 \n        for(int j=i;j<=m;++j)  //\u66f4\u6539\u5f53\u524d\u884c \n        f[i][j]=f[i][j]*r%mod;\n        for(int j=1;j<=n;++j)  //\u66f4\u6539\u5176\u4ed6\u884c\u4fe1\u606f \n        if(j!=i){\n            r=f[j][i];\n            for(int k=i;k<=m;++k)\n            f[j][k]=(f[j][k]-r*f[i][k]%mod+mod)%mod;\n        }\n    }\n    for(int i=1;i<=n;++i,puts(\"\"))\n    for(int j=n+1;j<=m;++j)printf(\"%lld \",f[i][j]);\n}\n```",
        "postTime": 1534482597,
        "uid": 50092,
        "name": "da32s1da",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P4783 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u6c42\u9006\u3011"
    },
    {
        "content": "\u5efa\u8bae\u5b66\u4e60\u7ebf\u6027\u4ee3\u6570\u540e\u98df\u7528\u6b64\u9898...\n\n\u6211\u4eec\u5bf9\u8f93\u5165\u7684\u77e9\u9635\u8fdb\u884c\u521d\u7b49\u53d8\u6362~~(\u521d\u7b49\u4e71\u641e)~~\uff0c\u540c\u65f6\u5bf9\u4e00\u4e2a\u5355\u4f4d\u77e9\u9635\u8fdb\u884c\u76f8\u540c\u7684\u521d\u7b49\u53d8\u6362\uff0c\u6700\u540e\u5c06\u6211\u4eec\u8f93\u5165\u7684\u77e9\u9635\u53d8\u6362\u6210\u5355\u4f4d\u77e9\u9635\u4e4b\u540e\uff0c\u90a3\u4e2a\u5355\u4f4d\u77e9\u9635\u5c31\u53d8\u6210\u4e86\u6211\u4eec\u8f93\u5165\u7684\u77e9\u9635\u7684\u9006\u77e9\u9635\n\n\u5047\u8bbe\u6211\u4eec\u8fdb\u884c\u521d\u7b49\u53d8\u6362\u7684\u521d\u7b49\u77e9\u9635\u4e58\u8d77\u6765\u662f$P$\uff0c\u4e14\u6211\u4eec\u8f93\u5165\u7684\u77e9\u9635\u4e3a$A$\n\n\u5219$AP=E$\uff0c\u5219$A^{-1}AP=A^{-1}E$\uff0c\u5219$P=A^{-1}$\uff0c\u4e5f\u5c31\u662f\u628a\u521d\u7b49\u53d8\u6362\u77e9\u9635\u4e58\u8d77\u6765(\u6216\u8005\u662f\u8bf4\u628a\u5b83\u4eec\u4e58\u4e0a\u4e00\u4e2a\u5355\u4f4d\u77e9\u9635)\u5f97\u5230\u7684\u5c31\u662f\u77e9\u9635\u7684\u9006\u77e9\u9635\n\n\u628a$A$\u6d88\u6210\u5355\u4f4d\u77e9\u9635\u5c31\u8981\u5148\u628aA\u5927\u529b\u6d88\u6210\u4e0a\u4e09\u89d2\u77e9\u9635\uff0c\u9ad8\u65af\u6d88\u5143\u5c31\u80fd\u505a\n\n```cpp\n#include <bits/stdc++.h>\n#define p 1000000007\n#define int long long\nusing namespace std;\n\nint n;\n\n//\u5b9a\u4e49\u77e9\u9635\u53ca\u5176\u521d\u7b49\u53d8\u6362 \nstruct matrix\n{\n\tint a[400][400];\n\t\n\t//\u77e9\u9635\u7b2cx\u884c\u548c\u7b2cy\u884c\u4ea4\u6362\n\tvoid change1(int x, int y)\n\t{\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tswap(a[x][i], a[y][i]);\n\t}\n\t\n\t//\u77e9\u9635\u7b2cx\u884c\u4e58\u4ee5k\n\tvoid change2(int x, int k)\n\t{\n\t\tfor (int i = 0; i < n; i++)\n\t\t\t(((a[x][i] *= k) %= p) += p) %= p;\n\t}\n\t\n\t//\u77e9\u9635\u7b2cx\u884c\u52a0\u4e0a\u7b2cy\u884c\u4e58\u4ee5k\n\tvoid change3(int x, int y, int k)\n\t{\n\t\tfor (int i = 0; i < n; i++)\n\t\t\t(((a[x][i] += a[y][i] * k % p) %= p) += p) %= p;\n\t}\n\t\n\tvoid print()\n\t{\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tfor (int j = 0; j < n; j++)\n\t\t\t\tprintf(\"%lld%c\", a[i][j], j == n - 1 ? '\\n' : ' ');\n\t}\n}a, b; \n\nint ksm(int x, int y = (p - 2))\n{\n\tint ans = 1;\n\twhile (y > 0)\n\t{\n\t\tif (y & 1)\n\t\t\t(ans *= x) %= p;\n\t\t(x *= x) %= p;\n\t\ty >>= 1;\n\t}\n\treturn ans;\n}\n\nsigned main()\n{\n\t//\u8f93\u5165\n\tscanf(\"%lld\", &n);\n\tfor (int i = 0; i < n; i++)\n\t\tfor (int j = 0; j < n; j++)\n\t\t\tscanf(\"%lld\", &a.a[i][j]);\n\t\n\t//\u628aB\u8d4b\u503c\u4e3a\u5355\u4f4d\u77e9\u9635 \n\tfor (int i = 0; i < n; i++)\n\t\tb.a[i][i] = 1;\n\t\n\t//\u628aA\u6d88\u4e3a\u4e0a\u4e09\u89d2\u77e9\u9635\n\tfor (int i = 0; i < n; i++)\n\t{\n\t\tif(a.a[i][i] == 0)\n\t\t\tfor (int j = i; j < n; j++)\n\t\t\t\tif (a.a[j][i] != 0)\n\t\t\t\t{\n\t\t\t\t\tb.change1(i, j);\n\t\t\t\t\ta.change1(i, j);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\tif (a.a[i][i] == 0)//\u77e9\u9635\u4e0d\u662f\u6ee1\u79e9\u7684\n\t\t{\n\t\t\tprintf(\"No Solution\\n\");\n\t\t\treturn 0;\n\t\t}\n\t\tb.change2(i, ksm(a.a[i][i]));\n\t\ta.change2(i, ksm(a.a[i][i]));\n\t\tfor (int j = i + 1; j < n; j++)\n\t\t{\n\t\t\tb.change3(j, i, -a.a[j][i]);\n\t\t\ta.change3(j, i, -a.a[j][i]);\n\t\t}\n\t}\n\t\n\t//\u628aA\u6d88\u4e3a\u5355\u4f4d\u77e9\u9635 \n\tfor (int i = n - 2; i >= 0; i--)\n\t\tfor (int j = i +1; j < n; j++)\n\t\t{\n\t\t\tb.change3(i, j, -a.a[i][j]);\n\t\t\ta.change3(i, j, -a.a[i][j]);\n\t\t}\n\t\n\tb.print();\n\treturn 0;\n}\n```\n\n\u53e6\u5916\u6ce8\u610f\u4e00\u4e2a\u7ec6\u8282\uff0c\u8981\u5148\u5bf9b\u4e71\u641e\uff0c\u5982\u679c\u5bf9a\u641e\u5b8c\u4e86\u90a3\u4e48\u90a3\u4e2a\u503c\u5c31\u662f1\u4e86\uff0c\u5bf9b\u641e\u7684\u90a3\u4e2a\u503c\u4e5f\u53d8\u62101\u4e86",
        "postTime": 1535848740,
        "uid": 13091,
        "name": "ghj1222",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4783 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u6c42\u9006\u3011"
    },
    {
        "content": "# LU\u5206\u89e3\u4e5f\u53ef\u4ee5\u6c42\u9006\u77e9\u9635\n\n\u5373\u628a\u77e9\u9635A\u5206\u89e3\u6210\n\n\u4e00\u4e2a\u5bf9\u89d2\u7ebf\u4e0a\u5143\u7d20\u90fd\u662f1\u7684\u4e0b\u4e09\u89d2\u77e9\u9635L\u548c\n\n\u4e00\u4e2a\u4e0a\u4e09\u89d2\u77e9\u9635U\u7684\u4e58\u79ef\n\n\uff08\u5173\u4e8eLU\u5206\u89e3\u53ca\u5176\u6c42\u884c\u5217\u5f0f\u548c\u89e3\u7ebf\u6027\u65b9\u7a0b\u7ec4\u7684\u529f\u80fd\uff0c\u8bf7\u53c2\u8003[\u6211\u7684\u535a\u5ba2](https://www.luogu.com.cn/blog/Feliks-YB/solution-p3389)\uff09\n\n\u5bf9\u4e8e\u4e00\u4e2an\u9636\u77e9\u9635A\uff0c\u82e5\u884c\u5217\u5f0f = 0\uff0c\u5219\u65e0\u9006\u77e9\u9635\uff0c\u201cNo Solution\u201d;\n\n\u884c\u5217\u5f0f\u975e0\u65f6\uff0c\u8bbe\u5176\u9006\u77e9\u9635\u4e3aX\n\n\u5219\u6211\u4eec\u8981\u89e3\n$$AX=I$$\n\u5176\u4e2dI\u4e3an\u9636\u5355\u4f4d\u77e9\u9635\n\u628aX\u548cI\u90fd\u62c6\u6210n\u5217\uff0cX\u7684\u7b2ci\u5217\u8bbe\u4e3a$n*1$\u77e9\u9635$X_i$\u5f97\u77e9\u9635\u65b9\u7a0b\u7ec4\n$$ AX_i =(a_1,a_2\u2026a_n)^T$$\n\u5176\u4e2d$a_i=1$, $a_j=0 (j!=i)$\n\n\u7136\u540e\u89e3n\u4e2a\u7ebf\u6027\u65b9\u7a0b\u7ec4\u5c31\u597d\u5566\n\n\u56e0\u4e3a\u7cfb\u6570\u77e9\u9635A\u4e00\u76f4\u4e0d\u53d8\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8fdb\u884c\u4e00\u6b21LU\u5206\u89e3\uff0c\u5229\u7528L\uff0cU\u89e3\u4e00\u4e2a\u7ebf\u6027\u65b9\u7a0b\u7ec4\u662fO\uff08$n^2$\uff09\u7684\uff08\u89c1\u6587\u7ae0\u5f00\u5934\u5904\u94fe\u63a5\uff09\uff0c\u89e3$n$\u4e2aO\uff08$n^3$\uff09, \u7b97\u4e0a\u5bf9A\u77e9\u9635\u8fdb\u884cLU\u5206\u89e3\u7684O\uff08$n^3$\uff09,\u603b\u590d\u6742\u5ea6O\uff08$n^3$\uff09\n\n### \u6ce8\u610f\n\n\u8fd9\u9898\u8981\u53d6\u6a21\uff0c\u64cd\u4f5c\u65f6\u8981\u5c0f\u5fc3\uff0c\u4e0d\u8981\u89c1\u7956\u5b97\uff0c\u9664\u6cd5\u6539\u6210\u4e58\u9006\u5143\n\n\uff08\u7531\u4e8e$1e9+7$\u662f\u7ecf\u5178\u7684\u7d20\u6570\uff0c\u9006\u5143\u76f4\u63a5\u7528\u8d39\u9a6c\u5c0f\u5b9a\u7406\u6c42\u5c31\u597d\u4e86\uff09\n\n```cpp\n//coder: Feliks Hacker of IOI == YB an AKer of IMO\n//LU\u5206\u89e3\n//acknowledgement:\n//https://blog.csdn.net/yang10560/article/details/77948021\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int N=500;\nconst int mod=1e9+7;\nconst int B=mod-2;\n//\u6c42\u9006\u5143\ninline ll inv(ll x){\n\tll res=1;int b=B;\n\twhile(b){\n\t\tif(b&1)res=(res*x)%mod;\n\t\tb>>=1;\n\t\tx=x*x%mod;\n\t}return res;\n}int n;\nll a[N][N],b[N];\nll l[N][N],u[N][N];\n//LU\u5206\u89e3\uff1a\u9012\u63a8\u524d\u4e24\u6b65 \ninline void init(){\n\tfor(int i=1;i<=n;i++){\n\t\tl[i][i]=1;\n\t\tu[1][i]=a[1][i];\n\t\t//\u7279\u5224 \n\t\tif(u[1][1]==0){\n\t\t\tputs(\"No Solution\");\n\t\t\texit(0);\n\t\t}\n\t\tl[i][1]=a[i][1]*inv(u[1][1])%mod;\n\t}\n}//LU\u5206\u89e3\uff1a\u884c\u5217\u4ea4\u9519\u9012\u63a8 \ninline void lu_div(){\n\tinit();\n\t//\u9012\u63a8\u5f0f \n\t//U[i][j] = A[i][j] - (for (k = 1 to i-1) L[i][k] * U[k][j])\n\t//L[j][i] = (A[j][i] - (for (k = 1 to i-1) L[j][k] * U[k][i])) / U[i][i]\n\tfor(int i=2;i<=n;i++){\n\t\tfor(int j=i;j<=n;j++){\n\t\t\t//\u9012\u63a8U\u7b2ci\u884c \n\t\t\tu[i][j]=a[i][j];\n\t\t\tfor(int k=1;k<=i-1;k++)\n\t\t\t\tu[i][j]=(u[i][j]+mod-l[i][k]*u[k][j]%mod)%mod;\n\t\t\t//\u9012\u63a8L\u7b2ci\u5217 \n\t\t\tl[j][i]=a[j][i];\n\t\t\tfor(int k=1;k<=i-1;k++)\n\t\t\t\tl[j][i]=(l[j][i]+mod-l[j][k]*u[k][i]%mod)%mod;\n\t\t\t//\u7279\u5224 \n\t\t\tif(u[i][i]==0){\n\t\t\t\tputs(\"No Solution\");\n\t\t\t\texit(0);\n\t\t\t}\n\t\t\tl[j][i]=l[j][i]*inv(u[i][i])%mod;\n\t\t}\n\t}\n}//\u6c42\u884c\u5217\u5f0f\u7684\u503c \ninline ll det(){ \n\t//det(A) = det(L * U) = det(L) * det(U) = det(U)\n\tll res=1;\n\tfor(int i=1;i<=n;i++)res=res*u[i][i]%mod;\n\treturn res;\n}ll z[N];\n//L * Z = B\ninline void solve_z(){\n    for(int i=1;i<=n;i++){\n        z[i]=b[i];\n        for(int j=1;j<i;j++)\n            z[i]=(z[i]+mod-l[i][j]*z[j]%mod)%mod;\n    }\n}\n//U * X = Z\nll x[N];\ninline void solve_x(){\n    for(int i=n;i>=1;i--){\n        x[i]=z[i];\n        for(int j=n;j>i;j--)\n        \tx[i]=(x[i]+mod-u[i][j]*x[j]%mod)%mod;\n        x[i]=x[i]*inv(u[i][i])%mod;\n    }\n}ll ans[N][N];\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tscanf(\"%lld\",&a[i][j]);\n\t\t}\n\t}lu_div();\n\t//\u884c\u5217\u5f0f = 0\uff0c\u65e0\u9006\u77e9\u9635\uff08\u5176\u5b9e\u4e0d\u7528\u8fd9\u53e5\uff0c\u5982\u679c\u771f\u662f0\u6c42LU\u5206\u89e3\u65f6\u5c31return 0\u4e86\uff09\n\tif(det()==0){\n\t\tputs(\"No Solution\");\n\t\treturn 0;\n\t}for(int i=1;i<=n;i++){\n\t\t//\u89e3\u7b2ci\u4e2a\u65b9\u7a0b\u7ec4\n\t\t//\u521d\u59cb\u5316 \n\t\tmemset(z,0,sizeof(z));\n\t\tmemset(x,0,sizeof(x));\n\t\tmemset(b,0,sizeof(b));\n\t\tb[i]=1;\n\t\t//\u8c03\u7528\u89e3\u65b9\u7a0b\u51fd\u6570 \n\t\tsolve_z();solve_x();\n\t\t//\u628a\u7ed3\u679c\u5b58\u5165ans\u77e9\u9635\u7684\u7b2ci\u5217 \n\t\tfor(int j=1;j<=n;j++)\n\t\t\tans[j][i]=x[j];\n\t}for(int i=1;i<=n;i++){\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tprintf(\"%lld \",ans[i][j]);\n\t\t}puts(\"\");\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1580105302,
        "uid": 104292,
        "name": "YellowBean_Elsa",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4783 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u6c42\u9006\u3011"
    },
    {
        "content": "## \u8fd9\u662f\u4e00\u9053\u7ebf\u6027\u4ee3\u6570\u7684\u597d\u9898\n~~\u8c03\u6b7b\u6211\u8fd9\u4e2a\u5927\u83dc\u9e21\u4e86~~\n\n\u5982\u679c\u60a8\u8fd8\u4e0d\u592a\u6e05\u695a\u7ebf\u6027\u4ee3\u6570\u7684\u8bdd\uff0c\u90a3\u4e48\u6211\u53ef\u4ee5\u8ddf\u60a8\u8bb2\u4e00\u4e2a\u7b11\u8bdd\uff1a\n\n```\n\u6709\u4eba\u5728\u76d8\u70b9\u4e16\u754c\u4e0a\u540a\u6b7b\u4eba\u6700\u591a\u7684\u6811\n\u636e\u8bf4\u662f\u7f8e\u56fd\u8fd8\u662f\u6cd5\u56fd\u7684\u54ea\u7247\u68ee\u6797\u91cc\u7684\n\u5176\u5b9e\u8fd9\u5b8c\u5168\u662f\u778e\u626f\n\u4ed6\u4eec\u6015\u662f\u4e0d\u77e5\u9053\uff0c\u6709\u4e00\u79cd\u53eb\u505a\u201c\u7ebf\u6027\u4ee3\u6570\u201d\u7684\u6811\n\u4e0a\u9762\u540a\u6b7b\u7684\u4eba\u8fdc\u6bd4\u90a3\u4e9b\u6811\u591a\u5f97\u591a\n```\n\n\u55ef\u55ef\uff0c\u7b11\u8bdd\u8bb2\u5b8c\u4e86\uff0c\u6211\u4eec\u6765\u505a\u9898\u5427qwq\n\n\u5728\u770b\u8fd9\u7bc7\u9898\u89e3\u4e4b\u524d\uff0c\u9700\u8981\u4e86\u89e3\u7684\u829d\u58eb\uff1a\n```\n1.\u9ad8\u65af-\u7ea6\u65e6\u6d88\u5143\u6cd5\n\n2.\u77e9\u9635\u7684\u57fa\u672c\u77e5\u8bc6\uff08\u77e9\u9635\u7684\u521d\u7b49\u53d8\u6362\uff0c\u5355\u4f4d\u77e9\u9635\u7b49\u7b49\uff09\n```\n\n\u5e94\u8be5\u90fd\u597d\u7406\u89e3\u7684\u5427\uff08\u81f3\u4e8e\u6211\u4e3a\u4ec0\u4e48\u4e0d\u7528\u9ad8\u65af\u6d88\u5143\uff0c\u662f\u56e0\u4e3a\u6211\u4e2a\u4eba\u8ba4\u4e3a\uff0c\u9ad8\u65af\u6d88\u5143\u7684\u7cbe\u5ea6\u4e0d\u662f\u5f88\u9ad8\uff0c\u4ee3\u7801\u6709\u4e9b\u957f ~~\u6240\u4ee5\u4e0d\u597d\u80cc~~ \uff09\n\n\n----\n\u9996\u5148\u6765\u8bb2\u4e00\u8bb2\u4ec0\u4e48\u662f\u77e9\u9635\u6c42\u9006\n\n\u9898\u76ee\u544a\u8bc9\u6211\u4eec\u4e00\u4e2a\u77e9\u9635$A$,\u8ba9\u6211\u4eec\u6c42\u5f97\u4e00\u4e2a\u77e9\u9635$B$\uff0c\u4f7f\u5f97$AB=BA=I$\u3002\n\n\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c\u8fd9\u4e2a\u77e9\u9635$I$\u662f\u4e2asmg\uff1f\n\n\u77e9\u9635$I$\u5c31\u662f\u4f20\u8bf4\u4e2d\u7684\u5355\u4f4d\u77e9\u9635\n\n\u8fd9\u662f\u4e00\u4e2a$4\\times4$\u7684\u5355\u4f4d\u77e9\u9635\n$$I=\\begin{bmatrix}1&0&0&0\\\\0&1&0&0\\\\0&0&1&0\\\\0&0&0&1\\end{bmatrix} $$\n\n\u770b\u5230\u4e86\u561b\uff0c\u5355\u4f4d\u77e9\u9635\u5c31\u662f\u4e00\u6761\u5bf9\u89d2\u7ebf\u4e0a\u90fd\u662f1\uff0c\u4f59\u90fd\u4e3a0\u7684\u77e9\u9635\u3002\n\n\u8bf4\u767d\u4e86\uff0c\u5c31\u662f\u6c42$B=I/A$\u8fd9\u4e2a\u4e1c\u897f\n\n\u53ef\u60dc\u597d\u50cf\u77e9\u9635\u8fd0\u7b97\u91cc\u6ca1\u6709\u9664\u6cd5\n\n\u6211\u4e0a\u9762\u90a3\u4e2a\u8868\u8fbe\u5f0f\u4e5f\u662f\u4e0d\u5408\u6cd5\u7684\n\n![](https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=2094980929,1634554119&fm=26&gp=0.jpg)\n\n~~\u7136\u540e\u6211\u4eec\u5c31\u4f1a\u7528BFS\uff08Baidu First Search\uff09\u53bb\u627e\u601d\u8def~~\n\n**\u6c42\u9006\u601d\u8def\uff1a**\n\n**1.\u628a$A$\u548c\u5b83\u7b49\u5927\u7684\u5355\u4f4d\u77e9\u9635$I$\u653e\u5728\u4e00\u4e2a\u77e9\u9635\u91cc**\n\n**2.\u5bf9$A$\u8fdb\u884c\u9ad8\u65af\u6d88\u5143\u4f7f$A$\u5316\u6210\u5355\u4f4d\u77e9\u9635**\n\n**3.\u6b64\u65f6\u539f\u6765\u5355\u4f4d\u77e9\u9635\u8f6c\u5316\u6210\u9006\u77e9\u9635**\n\n\u610f\u4e0d\u610f\u5916\uff1f\u60ca\u4e0d\u60ca\u559c\uff1f\n\n\u77e5\u9053\u4e86\u5177\u4f53\u7684\u8fc7\u7a0b\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6765~~\u641e\u4e8b\u60c5~~\u4e86\uff0c\u628aP3389\u7684\u7a0b\u5e8f\u590d\u5236\u7c98\u8d34\u8fc7\u6765\u2026\u2026\n\n\u7136\u540e\u4fee\u6539\u4e00\u4e0b\uff0c\u52a0\u4e0a\u53f3\u8fb9\u7684\u77e9\u9635$I$\uff0c\u4fee\u6539\u4e00\u4e0b\u8f93\u51fa\uff0c\u7136\u540e\u2026\u2026\n\n## ${\\color{Red}WA}$\n\n\u662f\u6211\u6c99\u96d5\u4e86\u2026\u2026\u4e24\u4e2a\u9898\u76ee\u7684\u6570\u636e\u7c7b\u578b\u90fd\u4e0d\u4e00\u6837\u554a\u554a\u554a\u554a\u554a\u554a\u554a\n\n\u9ad8\u65af\u6d88\u5143\u662f$Double$\u7684\uff0c\u4f46\u662f\u8fd9\u9053\u9898\u2026\u2026$long\\;long$\u2026\u2026\n\n\u8fd8\u5e26\u7740\u9664\u6cd5\u2026\u2026\n\n~~\u6240\u4ee5\u8bdd\u8bf4\u4e58\u6cd5\u9006\u5143\u662f\u4e2a\u597d\u4e1c\u897f~~\n\n\u7136\u540e\u628a\u6570\u636e\u7c7b\u578b\u6539\u4e00\u4e0b\uff0c\u5199\u4e2a~~\u9f9f\u901f\u5e42~~\u5957\u4e58\u6cd5\u9006\u5143\uff0c\u7136\u540e\u2026\u2026\n\n## ${\\color{Red}WA}$\n\n\u5624\u5624\u5624\u5624\u5624\u5624\u5624\u5624\u5624\u5624\u5624\u5624\u5624\u5624\u5624\u5624\u5624\u5624\u2026\u2026\n\n\u7136\u540e\u6211~~\u501f\u9274~~\u4e86\u4e00\u4e0b\u9898\u89e3\uff0c\u53d1\u73b0\u662f%\u8fd0\u7b97\u7684\u9505\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u5f88\u53ef\u80fd\u51fa\u73b0\u8d1f\u6570\uff0c\u7136\u540e\u5c31\u4f1a${\\color{Red}WA}$\u6389\u3002\n\n\u6bd4\u5982\u6211\u7684${\\color{green}AC}$\u7a0b\u5e8f\u91cc\u6709\u8fd9\u4e2a\uff1a\n\n```cpp\na[j][k]=(a[j][k]%mod+mod)%mod;\n```\n\u548c\u4e4b\u524d${\\color{red}WA}$\u8fd9\u4e2a\uff1a\n```cpp\na[j][k]%=mod;\n```\n\u662f\u4e0d\u4e00\u6837\u7684\u3002\n\n\u4e0a\u9762\u7684\u90a3\u4e2a\u786e\u4fdd\u4e86\u6ca1\u6709\u8d1f\u6570\uff08~~Maybe~~\uff09\n\n\u6240\u4ee5\u8bf4\uff0c**%\u8fd9\u4e2a\u8fd0\u7b97\u6700\u597d\u7528\u5728\u819c\u62dc\u7ba1\u7406\u5458/\u795e\u4ed9/\u5de8\u4f6c\u4e2d**\uff0c\u5982\u679c\u9898\u76ee\u91cc\u6709\u6a21\u6570\uff0c\u90a3\u4e48\u2026\u2026\u6211\u591a\u534a\u4f1a\u6302\u6389\u2026\u2026\n\n${\\color{green}AC}$\u7a0b\u5e8f\uff1a\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst long long mod=1e9+7;\nlong long a[500][1000];\nlong long IE(long long m,long long n)\n{\n  long long p=1;\n  while(n)\n  {\n    if(n%2==1) p=(p*m)%mod;\n    m=m*m%mod;\n    n/=2;\n  }\n  return p%mod;\n}\nint main()\n{\n  long long n;\n  cin>>n;\n  for(int i=1; i<=n; i++)\n    for(int j=1; j<=n; j++)\n      cin>>a[i][j];\n  for(int i=1; i<=n; i++) a[i][i+n]=1;\n  for(int i=1; i<=n; i++)\n  {\n    int tx=i;\n    for(int j=i+1; j<=n; j++)\n      if(abs(a[j][i])>abs(a[tx][i])) tx=j;\n    if(i!=tx)\n    {\n      for(int j=1; j<=n*2; j++)\n        swap(a[i][j],a[tx][j]);\n    }\n    if(!a[i][i])\n    {\n      cout<<\"No Solution\";\n      return 0;\n    }\n    int I=IE(a[i][i],mod-2);\n    for (int j=1; j<=n; j++)\n      if(j!=i)\n      {\n        long long t=a[j][i]*I%mod;\n        for (int k=i; k<=n*2; k++)\n        {\n          a[j][k]-=a[i][k]*t;\n          a[j][k]=(a[j][k]%mod+mod)%mod;\n        }\n      }\n    for(int j=1; j<=2*n; j++)\n      a[i][j]=a[i][j]*I%mod;\n  }\n  for(int i=1; i<=n; i++)\n  {\n    for(int j=n+1; j<=n*2; j++)\n      cout<<a[i][j]<<\" \";\n    cout<<endl;\n  }\n}\n```\n\u5c31\u662f\u8fd9\u6837\u5b50\u5427\u2026\u2026\u7ebf\u6027\u4ee3\u6570\u771f\u7684\u662f\u6bd2\u7624\u2026\u2026\u55b5\u55b5\u55b5~~~",
        "postTime": 1586828595,
        "uid": 231169,
        "name": "Laser_Crystal",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4783 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u6c42\u9006\u3011"
    },
    {
        "content": "### \u524d\u8a00\n\n\u505a\u5b8c Gauss\u6d88\u5143 \u540e\u5728\u6765\u5c1d\u8bd5\u8fd9\u4e00\u9053\u9898 ...\n\n\u7136\u540e\u56e0\u4e3a\u76f4\u63a5\u4f7f\u7528\u4e86\u90a3\u9898\u7684\u677f\u5b50\u800c\u5403\u4e86\u5f88\u591a\u4e8f ...\n\n\u529d\u5927\u5bb6\u4e0d\u8981\u76f4\u63a5\u628a\u90a3\u4e00\u9898\u677f\u5b50\u642c\u8fc7\u6765\u8c03\uff0c\u7ec6\u8282\u8fd8\u662f\u6709\u5f88\u5927\u4e0d\u540c\u7684 ...\n\n### \u524d\u7f6e\u829d\u58eb\n\n1.\u9006\u77e9\u9635\n\n\u8bbe $A$ \u662f\u6570\u57df\u4e0a\u7684\u4e00\u4e2a $n$ \u9636\u77e9\u9635\uff0c\u82e5\u5728\u76f8\u540c\u6570\u57df\u4e0a\u5b58\u5728\u53e6\u4e00\u4e2a $n$ \u9636\u77e9\u9635 $B$ \uff0c\u4f7f\u5f97\uff1a $A*B=B*A=T$ \uff0c\u5219\u6211\u4eec\u79f0 $B$ \u662f $A$ \u7684\u9006\u77e9\u9635\uff0c\u800c $A$ \u5219\u88ab\u79f0\u4e3a\u53ef\u9006\u77e9\u9635\u3002\n\n\u4e0a\u6587\u6765\u81ea\u767e\u5ea6\u8bcd\u6761\uff0c\u7b14\u8005\u8bed\u6587\u4e0d\u662f\u5f88\u597d\u6240\u4ee5\u76f4\u63a5\u590d\u5236\u4e0b\u6765\uff0c\u4e0a\u6587\u8fd8\u662f\u5f88\u5bb9\u6613\u61c2\u7684\u3002\n\n2.Gauss\u6d88\u5143\n\n\u3010\u6a21\u677f\u3011\u9ad8\u65af\u6d88\u5143\u6cd5\uff1a[Link](https://www.luogu.com.cn/problem/P3389)\n\n\u8fd9\u8fb9\u7b14\u8005\u7528\u7684\u662f \u9ad8\u65af-\u7ea6\u65e6\u6d88\u5143\u6cd5 \u3002\n\n\u8fd9\u4e2a\u76f8\u5bf9\u4e8e \u9ad8\u65af\u6d88\u5143 \u6ca1\u6709\u56de\u5e26\u7684\u8fc7\u7a0b\uff0c\u56e0\u6b64\u4ee3\u7801\u4e5f\u76f8\u5bf9\u7b80\u5355\u3002~~\u90a3\u8fd8\u8981\u9ad8\u65af\u6d88\u5143\u5e72\u4ec0\u4e48~~\n\n\u666e\u901a\u7684 \u9ad8\u65af\u6d88\u5143\uff08\u8fd9\u662f\u3010\u6a21\u677f\u3011\u9ad8\u65af\u6d88\u5143\u6cd5 \u7684\u89e3\u6cd5\uff0c\u56e0\u6b64\u4f1a\u7528\u5230\u6d6e\u70b9\u6570\u7684\u8ba1\u7b97\uff09\uff1a\n\n```cpp\nfor(int i=1;i<=n;i++){\n    int t=i;\n    for(int j=i+1;j<=n;j++){\n        if(fabs(a[t][i])<fabs(a[t][i])){\n            t=j;\n        }\n    }\n    if(fabs(a[t][i])<0.0000001){\n        printf(\"No Solution\");\n        return 0;\n    }\n    if(i!=t){\n        for(int j=1;j<=n+1;j++){\n            swap(a[i][j],a[t][j]);\n        }\n    }\n    double tmp=a[i][i];\n    for(int j=i;j<=n+1;j++){\n        a[i][j]/=tmp;\n    }\n    for(int j=i+1;j<=n;j++){\n        tmp=a[j][i];\n        for(int k=i;k<=n+1;k++){\n            a[j][k]-=a[i][k]*tmp;\n        }\n    }\n    ans[n]=a[n][n+1];\n    for(int i=n-1;i>=1;i--){\n        ans[i]=a[i][n+1];\n        for(int j=i+1;j<=n;j++){\n            ans[i]-=(map[i][j]*ans[j]);\n        }\n    }//\u8fd9\u5c31\u662f\u7279\u6b8a\u7684\u56de\u5e26\u64cd\u4f5c\u4e86\n}\n```\n\u9ad8\u65af-\u7ea6\u65e6\u6d88\u5143\uff1a\n\n```cpp\nfor(int i=1;i<=n;i++){\n        int t=i;\n        for(int j=i+1;j<=n;j++){\n            if(fabs(a[j][i])>fabs(a[t][i])){\n                t=j;\n            }\n        }\n        for(int j=1;j<=n+1;j++){\n            swap(a[i][j],a[t][j]);\n        }\n        if(!a[i][i]){\n            cout<<\"No Solution\";\n            return 0;\n        }\n        for(int j=1;j<=n;j++){\n            if(j!=i){\n                double t=a[j][i]/a[i][i];\n                for(int k=i+1;k<=n+1;k++){\n                    a[j][k]-=a[i][k]*t;\n                }\n            }\n        }\n    }\n```\n\u76f8\u6bd4\u662f\u4e0d\u662f \u9ad8\u65af-\u7ea6\u65e6\u6d88\u5143 \u66f4\u80dc\u4e00\u7b79\uff1f\n\n\n### \u89e3\u9898\u601d\u8def\n\n\u5728\u8bfb\u5165\u7684 $n$ \u9636\u77e9\u9635\u53f3\u4fa7\u52a0\u5165\u4e00\u4e2a $n$ \u9636\u77e9\u9635\uff0c\u7136\u540e\u505a\u9ad8\u65af\u6d88\u5143\uff0c\u4f7f\u8bfb\u5165\u7684 $n$ \u9636\u77e9\u9635\u5316\u4e3a $n$ \u9636\u5355\u4f4d\u77e9\u9635\uff0c\u6b64\u65f6\u53f3\u9762\u52a0\u5165\u7684\u77e9\u9635\u5c31\u4e3a\u6240\u6c42\u7684\u9006\u3002\n\n\u6240\u4ee5\u8fd9\u9898\u5c31\u662f\u4e3b\u8981\u5c31\u662f \u6c42\u9006\u77e9\u9635+\u9ad8\u65af\u6d88\u5143 \u3002\n\n\u4e0a\u6587\u5df2\u7ecf\u4ecb\u7ecd\u4e86 \u9006\u77e9\u9635 \u4e0e \u9ad8\u65af\u6d88\u5143\u3002\n\n\u5177\u4f53\u5c31\u662f\u8fd9\u6837\uff0c\u7ec6\u8282\u770b\u4ee3\u7801\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int mod=1e9+7;\nint a[410][810];\nsigned wyxakioi(int x,int y){\n    int p=1;\n    while(y){\n        if(y%2==1){\n            p=(p*x)%mod;\n        }\n        x=x*x%mod;\n        y/=2;\n    }\n    return p%mod;\n}//\u6c42\u9006\u5143\nsigned main(){\n    int n;\n    cin>>n;\n    for(int i=1;i<=n;i++){\n        for(int j=1;j<=n;j++){\n            cin>>a[i][j];\n            a[i][i+n]=1;//\u6784\u9020\u53f3\u4fa7\u77e9\u9635\n        }\n    }\n    for(int i=1;i<=n;i++){\n        int t=i;\n        for(int j=i+1;j<=n;j++){\n            if(abs(a[j][i])>abs(a[t][i])){\n                t=j;\n            }\n        }\n        if(i!=t){\n            for(int j=1;j<=n*2;j++){\n                swap(a[i][j],a[t][j]);\n            }\n        }\n        if(!a[i][i]){\n            cout<<\"No Solution\";\n            return 0;\n        }\n        int iee=wyxakioi(a[i][i],mod-2);//\u5f97\u51fa\u9006\u5143\n        for(int j=1;j<=n;j++){\n            if(j!=i){\n                int tmp=a[j][i]*iee%mod;\n                for(int k=i;k<=n*2;k++){\n                    a[j][k]=((a[j][k]-a[i][k]*tmp)%mod+mod)%mod;\n                }\n            }\n        }//\u4e0a\u9762\u5c31\u662f\u57fa\u672c \u9ad8\u65af-\u7ea6\u65e6\u6d88\u5143 \u7684\u677f\u5b50\u7684\uff0c\u5c31\u662f\u591a\u4e86\u4e00\u4e2a\u9006\u5143\u7684\u5904\u7406\u3002\n        for(int j=1;j<=n*2;j++){\n            a[i][j]=(a[i][j]*iee%mod);\n        }//\u8fd9\u8fb9\u8fd8\u8981\u6ce8\u610f\u591a\u5904\u7406\u4e00\u6b65\n    }\n    for(int i=1;i<=n;i++){\n        for(int j=n+1;j<=n*2;j++){\n            cout<<a[i][j]<<\" \";\n        }\n        cout<<endl;\n    }\n    return 0;\n}\n```\n\u5177\u4f53\u5c31\u662f\u8fd9\u6837\uff0c\u6709\u4ec0\u4e48\u4e0d\u61c2\u8fd8\u53ef\u4ee5\u79c1\u4fe1\u6211\u3002\n\n\u7ba1\u7406\u5458\u5ba1\u6838\u8f9b\u82e6\u4e86\uff01",
        "postTime": 1583553966,
        "uid": 214148,
        "name": "_Camille_",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4783 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u6c42\u9006\u3011"
    },
    {
        "content": "# \u77e9\u9635\u6c42\u9006\n\u5728\u7ebf\u6027\u4ee3\u6570\u91cc\u9762\uff0c\u5411\u91cf\u901a\u8fc7\u67d0\u4e2a\u51fd\u6570\u53d1\u751f\u53d8\u5316\uff0c\u4ece\u800c\u751f\u6210\u53e6\u4e00\u4e2a\u5411\u91cf\u3002\n\n\u90a3\u4e2a\u51fd\u6570\u5373\u5bf9\u5e94\u7740\u4e00\u79cd\u5750\u6807\u8f74\u7684\u53d8\u6362\uff0c\u901a\u8fc7\u5750\u6807\u8f74\u7684\u53d8\u6362\uff0c\u5f71\u54cd\u4e86\u5411\u91cf\u7684\u57fa\u5e95\uff0c\u800c\u53c8\u56e0\u4e3a\u5750\u6807\u8f74\u7684\u53d8\u6362\uff0c\u5176\u4ed6\u6240\u6709\u5411\u91cf\u7684\u53d8\u6362\u65b9\u5f0f\u7686\u4e0e\u5411\u91cf\u57fa\u5e95\u76f8\u540c\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u57fa\u5e95\u7684\u53d8\u6362\u65b9\u5f0f\uff0c\u7406\u89e3\u77e9\u9635\u4e58\u6cd5\u7684\u672c\u8d28\n\n\u90a3\u4e48\u5bf9\u4e8e\u5411\u91cf\u7684\u5750\u6807\u53d8\u6362,\u5c31\u53ef\u4ee5\u770b\u505a\u662f\u4e00\u7ec4\u5411\u91cf\u4e58\u4e00\u4e2a\u53d8\u6362\u65b9\u5f0f\uff0c\u5373\u4e24\u4e2a\u77e9\u9635\u76f8\u4e58\uff0c\u800c\u4f7f\u53d8\u6362\u540e\u7684\u5411\u91cf\u901a\u8fc7\u4e0e\u539f\u53d8\u6362\u76f8\u53cd\u7684\u4e00\u6b21\u53d8\u6362\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u539f\u6765\u521d\u59cb\u57fa\u5e95\n\n\u8bb2\u4e86\u8fd9\u4e48\u591a\uff0c\u5176\u5b9e\u5c31\u662f\u628a\u521d\u59cb\u5411\u91cf\n$\\begin{bmatrix}1&0\\\\0&1\\\\\\end{bmatrix}$ \n\n\u7ecf\u8fc7\u53d8\u6362\u4e4b\u540e\uff0c\u53d8\u6210\u4e86\u4e00\u683c\u77e9\u9635\n$\\begin{bmatrix}3&2\\\\4&6\\\\\\end{bmatrix}$ \n\n\u90a3\u4e48\u5bf9\u4e8e\u4efb\u610f\u7684\u4e00\u7ec4\u5411\u91cf\n$\\begin{bmatrix}3\\\\5\\\\\\end{bmatrix}$ ,\n\u6211\u4eec\u4e5f\u53ef\u4ee5\u628a\u5b83\u8fdb\u884c\u8fd9\u4e2a\u53d8\u6362\uff0c\n\n\u5373$\\begin{bmatrix}3&2\\\\4&6\\\\\\end{bmatrix}$ $*$ $\\begin{bmatrix}2\\\\3\\\\\\end{bmatrix}$ $=$ $\\begin{bmatrix}12\\\\26\\\\\\end{bmatrix}$\n\n\u7136\u540e\u6211\u4eec\u6839\u636e\u628a\u5411\u91cf\u53cd\u5411\u53d8\u6362\uff0c\u5c31\u53ef\u4ee5\u77e5\u9053\u77e9\u9635\u7684\u9006\u4e86\n\n\u6216\u8005\u8bf4\uff0c\u77e9\u9635$A*A^{-1}=E$,\u5373\u77e9\u9635\u4e58\u5b83\u7684\u9006\u5c31\u4e3a\u5355\u4f4d\u77e9\u9635\n\n\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u9ad8\u65af\u6d88\u5143\u6765\u6c42\u51fa\u4e00\u4e2a\u4e0a\u4e09\u89d2\u77e9\u9635\uff0c\u5f53\u6211\u4eec\u5728\u4e0d\u65ad\u628a\u539f\u77e9\u9635\u6d88\u4e3a\u4e0a\u4e09\u89d2\u77e9\u9635\u65f6\uff0c\u6211\u4eec\u5f97\u5230\u7684\u53e6\u4e00\u4e2a\u77e9\u9635\u5373\u4e3a\u5b83\u7684\u9006\n\nCode\n```\n#include<bits/stdc++.h>\nusing namespace std;\ninline int read()\n{\n    int x=0;\n    char c=getchar();\n    bool flag=0;\n    while(c<'0'||c>'9') {if(c=='-')flag=1;c=getchar();}\n    while(c>='0'&&c<='9'){x=(x+(x<<2)<<1)+ c-'0';c=getchar();}\n    return flag?-x:x;\n}\nconst int N=405,mod=1e9+7;\nint n;\nstruct Matrix\n{\n\tint a[N][N];\n\tvoid Swap(int x,int y) {for(int i=1;i<=n;++i) swap(a[x][i],a[y][i]);}\n\tvoid cg(int x,int k) {for(int i=1;i<=n;++i) a[x][i]=(1ll*a[x][i]*k%mod+mod)%mod;}\n\tvoid update(int x,int y,int k) {for(int i=1;i<=n;++i)a[x][i]=((a[x][i]+(1ll*a[y][i]*k%mod))%mod+mod)%mod;}\n\tvoid print() {for(int i=1;i<=n;++i) {for(int j=1;j<=n;++j) printf(\"%d \",a[i][j]);printf(\"\\n\");}}\n}A,B;\ninline int inv(int a)\n{\n    int res=1,b=mod-2;\n    for(;b;b>>=1,a=1ll*a*a%mod)if(b&1)res=1ll*res*a%mod;\n    return res;\n}\nint main()\n{\n\tn=read();\n\tfor(int i=1;i<=n;++i) for(int j=1;j<=n;++j) A.a[i][j]=read();\n\tfor(int i=1;i<=n;++i) B.a[i][i]=1;\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tif(!A.a[i][i])\n\t\t{\n\t\t\tfor(int j=i+1;j<=n;++j) if(A.a[j][i]) \n\t\t\t{A.Swap(i,j),B.Swap(i,j);break;}\n\t\t}\n\t\tif(!A.a[i][i]) {printf(\"No Solution\\n\");return 0;}\n\t\tB.cg(i,inv(A.a[i][i])),A.cg(i,inv(A.a[i][i]));\n\t\tfor(int j=i+1;j<=n;++j) B.update(j,i,-A.a[j][i]),A.update(j,i,-A.a[j][i]);\n\t}\n\tfor(int i=n-1;i;--i) for(int j=i+1;j<=n;++j)\n    B.update(i,j,-A.a[i][j]),A.update(i,j,-A.a[i][j]);\n    B.print();\n}\n```\n\n\u611f\u8c22[BZT\u5de8\u4f6c](https://www.luogu.org/space/show?uid=41781)\u7684\u8bb2\u89e3\n\n~~\u6df1\u6df1\u611f\u89c9\u5230\u81ea\u5df1\u7684\u5f31\u5c0f~~",
        "postTime": 1551793979,
        "uid": 41887,
        "name": "Shikita",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4783 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u6c42\u9006\u3011"
    },
    {
        "content": "\u57fa\u5efa\u7b2c\u4e94\u7bc7\n\n\u77e9\u9635\u6c42\u9006\u7684\u57fa\u672c\u539f\u7406\u662f\n\n$A$\u901a\u8fc7\u4e00\u7cfb\u5217\u7ebf\u6027\u53d8\u6362\u53d8\u6210$I$\uff08\u5355\u4f4d\u77e9\u9635\uff09\uff0c\u800c\u8fd9\u4e00\u7cfb\u5217\u53d8\u6362\u7b49\u4ef7\u4e8e$P1*P2*..Pn*A=I$\n\n\u800c\u4ee4$P=\\prod P_{i}$\uff0c\u7531\u4e8e$A*A^{-1}=I$,\u4e14$P*A=I$\uff0c\u6240\u4ee5$P=A^{-1}$\uff0c\u6240\u4ee5\u53ea\u8981\u6c42\u51fa$\\prod P_{i}$\u3002\n\n\u6839\u636e\u9ad8\u65af-\u7ea6\u65e6\u6d88\u5143\u6cd5\uff0c\u6211\u4eec\u5728$A$\u65c1\u8fb9\u6784\u9020\u4e00\u4e2a\u5355\u4f4d\u77e9\u9635$I$\uff0c\u7528$B$\u8868\u793a\uff0c\u5728\u5bf9$A$\u64cd\u4f5c\u7684\u540c\u65f6\u5bf9$B$\u505a\u76f8\u540c\u64cd\u4f5c\u3002\u7531\u4e8e\u7ea6\u65e6\u6d88\u5143\u6700\u540e\u80fd\u5c06$A$\u53d8\u4e3a$I$,\u90a3\u4e48\u76f8\u5e94\u7684$B$\u5c31\u53d8\u6210\u4e86$\\prod P_{i}$\uff0c\u4e5f\u5c31\u662f$A$\u7684\u9006\u77e9\u9635$P$.\n\n[P4783](https://www.luogu.com.cn/problem/P4783)\n\n$$ Code $$\n\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\n\nint read(){\n\tint x=0;bool f=0;char ch=getchar();\n\twhile(!isdigit(ch))f|=ch=='-',ch=getchar();\n\twhile(isdigit(ch))x=(x<<1)+(x<<3)+(ch^48),ch=getchar();\n\treturn f?-x:x;\n}\n\nvoid write(int x){\n\tif(x<0)putchar('-'),x=-x;\n\tif(x>9)write(x/10);\n\tputchar(48+x%10);\n}\n\nvoid writeln(int x){write(x);putchar('\\n');}\nvoid writebl(int x){write(x);putchar(' ');}\n\n#define I inline\n#define R register\n\nconst int maxn = 405;\nconst int mod = 1e9+7;\n\nI int ksm(int a,int b){int res=1;while(b){if(b&1)res=res*a%mod;a=a*a%mod;b>>=1;}return res;}\n\nint n,m;\nstruct Mat{int a[maxn][maxn<<1];}f;\n\nbool work(Mat &f){\n\tfor(R int i=1,r;i<=n;++i){\n\t\tr=i;\n\t\tfor(R int j=i+1;j<=n;++j)if(f.a[j][i]>f.a[r][i])r=j;\n\t\tif(r!=i)swap(f.a[i],f.a[r]);\t\t\n\t\tif(!f.a[i][i]){puts(\"No Solution\");return 0;}\n\t\t\n\t\tint kk=ksm(f.a[i][i],mod-2);\n\t\t\n\t\tfor(R int j=1;j<=n;++j)if(j!=i){\n\t\t\tint res=f.a[j][i]*kk%mod;\n\t\t\tfor(R int k=i;k<=m;++k)\n\t\t\t\tf.a[j][k]=((f.a[j][k]-res*f.a[i][k])%mod+mod)%mod;\n\t\t}\n\t\t\n\t\tfor(R int j=1;j<=m;++j)f.a[i][j]=f.a[i][j]*kk%mod;\n\t}\n\treturn 1;\n}\n\nsigned main(){\n\tn=read();m=n<<1;\n\tfor(R int i=1;i<=n;++i){\n\t\tfor(R int j=1;j<=n;++j)f.a[i][j]=read();\n\t\tf.a[i][i+n]=1;\n\t}\n\tbool flag=work(f);\n\tif(!flag)return 0;\n\tfor(R int i=1;i<=n;++i){\n\t\tfor(R int j=n+1;j<=m-1;++j)writebl(f.a[i][j]);\n\t\twriteln(f.a[i][m]);\n\t}\n}\n```\n",
        "postTime": 1583038547,
        "uid": 87031,
        "name": "Immortal_Bird",
        "ccfLevel": 0,
        "title": "\u6570\u5b66-\u77e9\u9635\u6c42\u9006\u5c0f\u7ed3"
    },
    {
        "content": "### \u7b97\u6cd5\u548c\u6b64\u65f6\u7b2c\u4e00\u7bc7\u9898\u89e3\u5176\u5b9e\u57fa\u672c\u4e00\u6837\uff0c\u4e0d\u8fc7\u901a\u8fc7\u64cd\u4f5c\u5c06\u6700\u5185\u5c42\u5faa\u73af\u7b80\u5316\uff0c\u5438\u53e3\u6c27\u5c45\u7136\u8dd1\u5230\u4e86\u6700\u4f18\u89e3\u7b2c\u4e00\n\n\u6ce8\u610f\u6838\u5fc3\u8bed\u53e5\n```\n(a[i][j]+=mod2-temp*a[k][j])%=mod;\n```\n3\u4e2a\u53d8\u91cf\u5728O2\u65f6\u4f1a\u88ab\u653e\u8fdb\u5bc4\u5b58\u5668\uff0c\u800ca\\[i],a\\[k]\u4e2dN\u4e2a\u6570\u76f8\u7ee7\u5904\u7406\uff0c\u4e00\u822c\u73af\u5883\u4e5f\u4f1a\u6709\u81ea\u52a8\u4f18\u5316\u3002\n\n\n\n```cpp\n#include<bits/stdc++.h>\n\nusing namespace std;\n\ntypedef unsigned long long ull;\n\nconst ull mod=1e9+7,mod2=mod*mod;\null a[400][400];\nint n,is[400],js[400];\n\ninline void inv(ull& x) {\n    register ull f=1,xx=x;\n    register int neg=0;\n    while(xx>1){\n        f=((mod/xx)*f)%mod;\n        neg^=1;\n        xx=mod%xx;\n    }\n    x= neg ? mod-f : f;\n}\n\nvoid inv(){\n    for(int k=0;k<n;++k){\n        for(int i=k,j;i<n;++i){\n            for(j=k;j<n&&!a[i][j];++j);\n            is[k]=i,js[k]=j;\n        }\n        for(int i=0;i<n;++i)\n            swap(a[k][i],a[is[k]][i]);\n        for(int i=0;i<n;++i)\n            swap(a[i][k],a[i][js[k]]);\n        if(!a[k][k]){\n            puts(\"No Solution\");\n            exit(0);\n        }\n        inv(a[k][k]);\n        for(int j=0;j<n;++j)if(j!=k)\n            (a[k][j]*=a[k][k])%=mod;\n            \n        for(int i=0;i<n;++i) if(i!=k){\n            register unsigned temp=a[i][k];\n            a[i][k]=0;\n            for(int j=0;j<n;++j)\n                (a[i][j]+=mod2-a[k][j]*temp)%=mod;\n        }\n    }\n    for(int k=n-1;k>=0;--k){\n        for(int i=0;i<n;++i)\n            swap(a[js[k]][i],a[k][i]);\n        for(int i=0;i<n;++i)\n            swap(a[i][is[k]],a[i][k]);\n    }\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=0;i<n;++i)\n        for(int j=0;j<n;++j)\n            scanf(\"%llu\",a[i]+j);\n    inv();\n    for(int i=0;i<n;++i)\n        for(int j=0;j<n;++j)\n            printf(\"%llu%c\",a[i][j],j==n-1?'\\n':' ');\n    return 0;\n}\n```\n",
        "postTime": 1571750375,
        "uid": 19391,
        "name": "3body",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4783 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u6c42\u9006\u3011"
    },
    {
        "content": "\u6211\u6765\u4e00\u53d1\u4ece\u5934\u8bb2\u8d77\u7684\u9898\u89e3\uff1a\n\n\u9996\u5148\u8c08\u5230\u77e9\u9635\uff0c\u90a3\u4e48\u5c31\u4f1a\u60f3\u5230\u7ebf\u6027\u4ee3\u6570\uff0c\u4f46\u6211\u592a\u849f\u84bb\u4e86\uff0c\u6240\u4ee5\u5e76\u4e0d\u60f3\u8c08\u90a3\u4e48\u6df1\uff0c\u6240\u4ee5\u5c31\u53ea\u8bf4\u8bf4\u5176\u4e2d\u4e00\u90e8\u5206\uff1b\n\n\u9996\u5148\u8bf4\u521d\u7b49\u884c\u53d8\u6362\uff1a\n\n\u3000\u30001.\u7528\u4e00\u4e2a\u975e0\u7684\u6570\u4e58\u67d0\u4e00\u884c\n\n\u3000\u30002.\u628a\u5176\u4e2d\u4e00\u884c\u7684\u82e5\u5e72\u500d\u52a0\u5230\u53e6\u4e00\u884c\u4e0a\uff1b\n\n\u3000\u30003.\u4ea4\u6362\u4e24\u884c\u7684\u4f4d\u7f6e;\n\n\u5f53\u7136\uff0c\u521d\u7b49\u5217\u53d8\u6362\u7684\u5b9a\u4e49\u4e0e\u521d\u7b49\u884c\u53d8\u6362\u7684\u5b9a\u4e49\u7c7b\u4f3c\uff0c\u8fd9\u91cc\u4fbf\u4e0d\u591a\u8bf4\u4e86\uff1b\n\n\n\u63a5\u7740\u8bf4\u9ad8\u65af\u6d88\u5143\uff1a\n\n\u3000\u3000\u4e00\u4e2a\u77e9\u9635\u901a\u8fc7\u521d\u7b49\u53d8\u6362\u540e\u6240\u80fd\u5f97\u5230\u7684\u77e9\u9635\u53eb\u505a\u589e\u5e7f\u77e9\u9635\u3002\n\n\u3000\u3000\u6211\u4eec\u628a\u9636\u68af\u578b\u589e\u5e7f\u77e9\u9635\u53d8\u6362\u4e3a\u7b80\u5316\u5f62\u9636\u68af\u77e9\u9635\u7684\u8fc7\u7a0b\u5c31\u662f\u9ad8\u65af\u6d88\u5143\uff1b\n\n\u3000\u3000\u57fa\u672c\u601d\u60f3\uff1a\u5bf9\u4e8e\u4e00\u4e2a\u672a\u77e5\u91cfxi\uff0c\u627e\u5230\u4e00\u4e2axi\u7684\u7cfb\u6570\u975e0\uff0c\u4f46x1~xi-1\u7684\u7cfb\u6570\u90fd\u662f\u96f6\u7684\u65b9\u7a0b\uff0c\u7136\u540e\u7528\u521d\u7b49\u884c\u53d8\u6362\u628a\u5176\u4ed6\u65b9\u7a0b\u7684xi\u7684\u7cfb\u6570\u5168\u90e8\u6d88\u62100\uff1b\n\n\u3000\u3000\u5728\u9ad8\u65af\u6d88\u5143\u5b8c\u6210\u540e\uff0c\u82e5\u5b58\u5728\u7cfb\u6570\u90fd\u662f0\uff0c\u4f46\u5e38\u6570\u4e0d\u662f0\u7684\u60c5\u51b5\uff0c\u65b9\u7a0b\u65e0\u89e3\uff1b\n\n\u3000\u3000\u732a\u5143(\u4e3b\u5143)\uff1a\u7cfb\u6570\u4e0d\u5168\u4e3a0\u7684\u884c\u7684\u4e2a\u6570\u5c31\u662f\u4e3b\u5143\u7684\u4e2a\u6570\uff1b\n\n\u3000\u3000\u81ea\u7531\u5143\uff1a\u7cfb\u6570\u5168\u4e3a0\uff0c\u5e38\u6570\u4e5f\u662f0\u7684\u4e2a\u6570\u5c31\u662f\u81ea\u7531\u5143\u7684\u4e2a\u6570\uff1b\n\n\u3000\u3000\u901a\u5e38\u60c5\u51b5\u4e0b\uff1a\u4e00\u9053\u9898\u5e76\u4e0d\u4f1a\u76f4\u63a5\u7ed9\u51fan\u4e2an\u5143\u4e00\u6b21\u65b9\u7a0b\u7ec4\u3002\u5982\u679c\u7ed9\u4e86n+1\u4e2a\u4e8c\u5143\u65b9\u7a0b\u7ec4\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u76f8\u90bb\u4e24\u4e2a\u65b9\u7a0b\u505a\u5dee\uff0c\u628a\u5b83\u53d8\u6210n\u4e2an\u5143\u4e00\u6b21\u65b9\u7a0b\u7ec4\uff0c\u7136\u540e\u8fdb\u884c\u9ad8\u65af\u6d88\u5143\u6c42\u89e3\uff1b\n  \n ```cpp\n#include <bits/stdc++.h>\n#define eps 1e-8\nusing namespace std;\ndouble a[101][102];\nint n;\nbool GUASS()\n{\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=i;j<=n;j++){\n\t\t\tif(fabs(a[j][i])>eps){\n\t\t\t\tfor(int k=1;k<=n;k++){\n\t\t\t\t\tswap(a[i][k],a[j][k]);\n\t\t\t\t}\n\t\t\t\tswap(a[i][n+1],a[j][n+1]);\n\t\t\t\tbreak;\n\t\t\t}\t\t\t\n\t\t}\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tif(i==j) continue;\n\t\t\tdouble tmp=a[j][i]/a[i][i];\n\t\t\tfor(int k=i;k<=n;k++){\n\t\t\t\ta[j][k]-=a[i][k]*tmp;\n\t\t\t}\n\t\t\ta[j][n+1]-=a[i][n+1]*tmp;\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tbool lala=0;\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tif(a[i][j]!=0){\n\t\t\t\tlala=1;\n\t\t\t}\n\t\t}\n\t\tif(lala==0){\n\t\t\tcout<<\"No Solution\";\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn 1;\n}\nint main()\n{\n\tcin>>n;\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=1;j<=n+1;j++){\n\t\t\tscanf(\"%lf\",&a[i][j]);\n\t\t}\n\t}\n\tif(GUASS()){\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tprintf(\"%.2lf\\n\",a[i][n+1]/a[i][i]);\n\t\t}\n\t}\n}\n```\n\n\n\u7136\u540e\u8bf4\u4e00\u4e0b\u77e9\u9635\u7684\u9006\uff1a\n\n\u3000\u3000\u5355\u4f4d\u77e9\u9635\uff1a\u4e3b\u5bf9\u89d2\u7ebf\u7684\u5143\u7d20\u90fd\u662f1\uff0c\u5176\u4f59\u6240\u6709\u5143\u7d20\u90fd\u662f0\uff1b\n\n\u3000\u3000\u77e9\u9635\u7684\u9006\uff0c\u6545\u540d\u601d\u610f\uff0c\u5c31\u662f\u77e9\u9635\u7684\u9006\u5143\u554a~(\u8fd9\u601d\u4e0d\u51fa\u6765\u5427\uff1f)\uff0c\u800c\u9006\u5143\u7684\u4f5c\u7528\u4fbf\u662f\u5316\u9664\u6cd5\u4e3a\u4e58\u6cd5\uff1b\n\n\u3000\u3000\u6ce8\u610f\uff1a\u4e00\u4e2a\u5b58\u5728\u9006\u77e9\u9635\u7684\u77e9\u9635\u53eb\u505a\u53ef\u9006\u77e9\u9635\uff1bAB=BA=E \uff0c\u5219\u6211\u4eec\u79f0B\u662fA\u7684\u9006\u77e9\u9635\uff0c\u5176\u4e2dE\u662f\u5355\u4f4d\u77e9\u9635\uff1b\n\n\u3000\u3000\u7279\u70b9\uff1a\u4e00\u4e2a\u53ef\u9006\u77e9\u9635\uff0c\u5b83\u7684\u9006\u77e9\u9635\u662f\u552f\u4e00\u7684;\n\n\u3000\u3000\u6761\u4ef6\uff1a\u53ef\u9006\u77e9\u9635\u4e00\u5b9a\u662f\u6b63\u65b9\u5f62\uff0c\u4e24\u4e2a\u53ef\u9006\u77e9\u9635\u7684\u4e58\u79ef\u4f9d\u7136\u53ef\u9006\u3002\n\n\u3000\u3000\u4f5c\u7528\uff1a\u6c42X=A/B; (X*B=A\uff0cX*B*(B\u7684\u9006\u77e9\u9635)=A*(B\u7684\u9006\u77e9\u9635)\uff0cX=A*(B\u7684\u9006\u77e9\u9635))\uff1b(\u4efb\u4f55\u77e9\u9635*\u5355\u4f4d\u77e9\u9635=\u5355\u4f4d\u77e9\u9635)\n\n\u3000\u3000\u65b9\u6cd5\uff1a\u5728\u8bfb\u5165\u7684n\u9636\u77e9\u9635\u53f3\u4fa7\u52a0\u5165\u4e00\u4e2an\u9636\u5355\u4f4d\u77e9\u9635\uff0c\u7136\u540e\u505a\u9ad8\u65af\u6d88\u5143\uff0c\u4f7f\u8bfb\u5165\u7684n\u9636\u77e9\u9635\u5316\u4e3an\u9636\u5355\u4f4d\u77e9\u9635\uff0c\u6b64\u65f6\u53f3\u9762\u52a0\u5165\u7684\u77e9\u9635\u5c31\u4e3a\u6240\u6c42\u7684\u9006\u3002\n  \n  ```cpp\n#include <bits/stdc++.h>\n#define p 1000000007\n#define inc(i,a,b) for(register int i=a;i<=b;i++)\nusing namespace std;\nint n;\nint a[1000][1000];\nlong long KSM(long long a,long long b)\n{\n\tlong long res=1;\n\twhile(b){\n\t\tif(b&1) res=res*a%p;\n\t\ta=a*a%p;\n\t\tb/=2;\n\t}\n\treturn res%p;\n}\nint Gauss()\n{\n\tinc(i,1,n){\n\t\tinc(j,i,n) if(a[j][i]) {swap(a[j],a[i]);break;}\n\t\tif(a[i][i]==0){cout<<\"No Solution\"; return 0;}\n\t\tlong long tmp=KSM(a[i][i],p-2);\n\t\tinc(j,i,2*n) a[i][j]=a[i][j]*tmp%p;\n\t\tinc(j,1,n){\n\t\t\tif(i==j) continue;\n\t\t\tlong long tmp2=a[j][i]%p;\n\t\t\tinc(k,i,2*n) a[j][k]=(a[j][k]-tmp2*a[i][k]%p+p)%p;\n\t\t}\n\t}\n\treturn 1;\n}\nint main()\n{\n\tcin>>n;\n\tinc(i,1,n){\n\t\tinc(j,1,n) scanf(\"%d\",&a[i][j]);\n\t\ta[i][i+n]=1;\n\t}\n\tif(Gauss()){\n\t\tinc(i,1,n){\n\t\t\tinc(j,n+1,2*n){\n\t\t\t\tprintf(\"%d \",a[i][j]);\n\t\t\t}\n\t\t\tprintf(\"\\n\");\n\t\t}\n\t}\n} \n```\n",
        "postTime": 1570674548,
        "uid": 119189,
        "name": "\u795e\u4e4b\u53f3\u5927\u81e3",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4783 \u3010\u3010\u6a21\u677f\u3011\u77e9\u9635\u6c42\u9006\u3011"
    }
]
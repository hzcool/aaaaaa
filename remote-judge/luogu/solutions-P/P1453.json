[
    {
        "content": "### \u653e\u5728\u524d\u9762\u7684\u8bdd\n\n\u90a3\u4e2a\uff0c\u697c\u4e0b\u7684$dfs$\u627e\u73af\u7684\u786e\u6709\u95ee\u9898\uff0c\u5c31\u5728\u8ba8\u8bba\u533a\u7684\u90a3\u7ec4\u6570\u636e\u53ef\u4ee5\u628a\u5b83\u6210\u529f$Hack$\u6389\n\n\u7136\u540e\u51e0\u7bc7\u9898\u89e3\u4f3c\u4e4e\u90fd\u662f\u57fa\u73af\u6811\uff1f~~\u8fd9\u4e48\u9ad8\u7ea7\u7684\u4e1c\u897f\u6211\u8fd8\u4e0d\u4f1a\u554a~~\n\n\u5927\u591a\u4eba\u6ca1\u628a$dp$\u5b9a\u4e49\u5f0f\u8bb2\u6e05\u695a\uff0c\u7136\u6211\u4eec\u8fd9\u79cd$\u5c0f\u849f\u84bb$\u5f88\u5c34\u5c2c\u554a\uff0c\u4e8e\u662f\u6211\u51b3\u5b9a\u732e\u4e11\u4e00\u53d1\n\n\u7136\u540e\u8fd9\u9898\u5176\u5b9e\u662f\u6211\u5728\u56fe\u8bba\u91cc\u627e\u7684\uff0c\u7ed3\u679c\u83ab\u540d\u8dd1\u51fa\u4e00\u9053\u6811\u5f62dp\u6765\uff0c\u53ef\u80fdLuogu\u77e5\u9053\u6211\u7684\u6811\u5f62dp\u592a\u83dc\u4e86\uff0c\u7136\u540e\u63a8\u8350\u7684???\n\n\u6b22\u8fce\u5927\u5bb6\u6765$Hack$\n\n### \u9898\u76ee\u5927\u610f\n\n\u7ed9\u4f60\u4e00\u68f5\u6811\uff0c\u70b9\u6709\u70b9\u6743\uff0c\u5f3a\u5236\u8981\u6c42\u4e00\u6761\u8fb9\u53ea\u80fd\u9009\u4e00\u4e2a\u70b9\uff0c\u5e76\u4e14\u8fd8\u989d\u5916\u547d\u4ee4$(S,T)$\u4e5f\u4e0d\u80fd\u540c\u65f6\u9009\uff0c\u6c42\u6ee1\u8db3\u6761\u4ef6\u4e0b\u7684\u6700\u5927\u8d21\u732e\n\n### Sol\n\n\u8fd9\u4e0d\u662f\u6446\u660e\u4e86\u90a3\u4f60\u7528\u6811\u5f62dp\u5207\u6389\u7684\u8282\u594f\u5417\uff1f\n\n\u8bbe$f[u][0/1]$\u8868\u793a\u4ee5$u$\u4e3a\u6839\u7684\u5b57\u6811\uff0c$u$\u70b9\u9009\u6216\u4e0d\u9009\u7684\u6700\u5927\u8d21\u732e\n\n\u7136\u540e\u8f6c\u79fb\u6bd4\u8f83\u663e\u7136\uff0c\n\n1.\u5982\u679c$u$\u70b9\u8981\u9009\uff0c\u5219\u5b83\u6240\u6709\u7684\u513f\u5b50\u90fd\u4e0d\u80fd\u9009\n\n2.\u5982\u679c$u$\u70b9\u4e0d\u9009\uff0c\u90a3\u4e48\u5b83\u7684\u513f\u5b50\u53ef\u4ee5\u9009\u4e5f\u53ef\u4ee5\u4e0d\u9009\n\n\u6240\u4ee5\u8f6c\u79fb\u5f0f\u5c31\u662f\n\n$$f[u][1]=\\sum_{u->v}f[v][0]$$\n$$f[u][0]=\\sum_{u->v}max(f[v][0],f[v][1])$$\n\n\u7136\u540e\u8003\u8651\u6700\u540e\u7684\u7edf\u8ba1\u7b54\u6848\n\n\u4ee5$S$\uff0c$T$\u4e24\u70b9\u5206\u522b\u505a\u4e00\u6b21$dp$\uff0c\u7136\u540e\u5728$f[S][0],f[T][0]$\u4e2d\u53d6\u8f83\u5927\u503c\uff0c\u8fd9\u6837\u5c31\u80fd\u4fdd\u8bc1$S,T$\u4e0d\u53ef\u80fd\u540c\u65f6\u88ab\u9009\u4e86\n\n### code\n\n\u7136\u540e\u5c31\u662f\u6109\u5feb\u7684\u4e0a\u4ee3\u7801\u73af\u8282\u4e86\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\nconst int _=100005;\ninline int read()\n{\n\tchar ch='!';int z=1,num=0;\n\twhile(ch!='-'&&(ch<'0'||ch>'9'))ch=getchar();\n\tif(ch=='-')z=-1,ch=getchar();\n\twhile(ch<='9'&&ch>='0')num=(num<<3)+(num<<1)+ch-'0',ch=getchar();\n\treturn z*num;\n}\nint n,p[_],fa[_],S,T;\nstruct ed{int to,next;}e[_<<1];\nint cnt,head[_];\ndouble f[_][2];\nvoid link(int u,int v){e[++cnt]=(ed){v,head[u]};head[u]=cnt;}\nint find(int x){return fa[x]==x?x:fa[x]=find(fa[x]);}\nvoid dfs(int u,int fa)\n{\n\tf[u][1]=p[u];f[u][0]=0;\n\tfor(int i=head[u];i;i=e[i].next)\n\t{\n\t\tint v=e[i].to;\n\t\tif(v==fa)continue;\n\t\tdfs(v,u);\n\t\tf[u][0]+=max(f[v][0],f[v][1]);\n\t\tf[u][1]+=f[v][0];\n\t}\n}\nint main()\n{\n\tn=read();\n\tfor(int i=1;i<=n;++i)p[i]=read(),fa[i]=i;\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tint u=read()+1,v=read()+1;\n\t\tif(find(u)==find(v)){S=u,T=v;continue;}\n\t\tlink(u,v);link(v,u);fa[find(v)]=find(u);\n\t}\n\tdouble k,ans=0;\n\tscanf(\"%lf\",&k);\n\tdfs(S,0);ans=f[S][0];\n\tdfs(T,0);ans=max(ans,f[T][0]);\n\tprintf(\"%.1lf\\n\",ans*k);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1534314103,
        "uid": 47901,
        "name": "\u9f99\u795e\u54c8\u8fea\u65af",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1453 \u3010\u57ce\u5e02\u73af\u8def\u3011"
    },
    {
        "content": "\u9898\u76ee\u94fe\u63a5\uff1a[\u57ce\u5e02\u73af\u8def](https://www.luogu.com.cn/problem/P1453)\u3002\n\n\u5173\u4e8e\u9898\u76ee\uff1a\u4e00\u9053\u6bd4\u8f83\u663e\u7136\u7684 **\u57fa\u73af\u6811** \u4e0a\u7684 dp \u9898\u3002\n\n\u5e94\u7528\u7b97\u6cd5\uff1a\u6811\u5f62 dp $+$ \u73af\u5f62 dp\u3002\n\n------------\n\n#### \u5199\u5728\u524d\u9762\uff1a\n\n$\\qquad\\!\\!$\u672c\u6765\u9898\u89e3\u533a\u6709\u4e00\u7bc7\u548c\u6211\u7684\u601d\u8def\u4e00\u6837\u7684\u9898\u89e3\uff0c\u4e0d\u8fc7\u90a3\u7bc7\u9898\u89e3\u5199\u5f97\u5e76\u4e0d\u5bf9\uff0c\u5e76\u4e0d\u80fd\u901a\u8fc7\u6211\u4e3a\u8fd9\u9053\u9898\u6dfb\u52a0\u7684 hack \u6570\u636e\u3002\u7531\u4e8e\u6211\u4e2a\u4eba\u8ba4\u4e3a\u8fd9\u4e2a\u601d\u8def\u5bf9\u4e8e\u57fa\u73af\u6811\u7684\u521d\u5b66\u8005\u601d\u7ef4\u96be\u5ea6\u8f83\u5c0f\uff0c\u6bd4\u8f83\u53cb\u597d\uff0c\u6240\u4ee5\u5c31\u6709\u4e86\u8fd9\u7bc7\u9898\u89e3\u3002\n\n$\\qquad\\!\\!updata\\ \\ 2020.10.6$\uff1a\u4fee\u6539\u4e86\u4e4b\u524d\u6302\u9519\u7684\u94fe\u63a5\uff1b\u589e\u52a0\u65f6\u7a7a\u590d\u6742\u5ea6\u5206\u6790\u3002\n\n$\\qquad\\!\\!updata\\ \\ 2020.10.25$\uff1a\u4fee\u6539\u4e86\u4e4b\u524d\u5bf9\u4e8e \u73af\u5f62 dp \u7684\u521d\u59cb\u5316\u7684\u4e00\u4e2a\u9519\u8bef\u3002\u611f\u8c22 @[pigstd](https://www.luogu.com.cn/user/141179) \u6307\u51fa\u3002\n\n#### \u4e0b\u9762\u8fdb\u5165\u6b63\u6587\uff1a\n\n- \u4e00\u3001\u5206\u6790\u9898\u610f\uff1a\n\n$\\qquad\\!\\!n$ \u4e2a\u70b9 $n$ \u6761\u8fb9\u3001\u5168\u90e8\u8054\u901a\u4e14\u53ea\u6709\u4e00\u4e2a\u73af\uff0c\u6ee1\u8db3\u8fd9\u4e9b\u6761\u4ef6\u7684\u56fe\u5f88\u663e\u7136\u662f\u4e00\u68f5[\u57fa\u73af\u6811](https://www.luogu.com.cn/blog/user52918/qian-tan-ji-huan-shu)\u3002\n\n$\\qquad\\!\\!$\u6bcf\u4e2a\u70b9\u6709\u70b9\u6743\u4e14\u4efb\u610f\u76f8\u90bb\u7684\u4e24\u4e2a\u70b9\u4e0d\u80fd\u540c\u65f6\u9009\u53d6\uff0c\u5f88\u663e\u7136\u6211\u4eec\u9700\u8981\u8fdb\u884c\u7c7b\u4f3c\u4e8e[\u6ca1\u6709\u4e0a\u53f8\u7684\u821e\u4f1a](https://www.luogu.com.cn/problem/P1352)\u7684 dp\u3002\n\n- \u4e8c\u3001dp \u8fc7\u7a0b\uff1a\n\n    $\\qquad\\!\\!$\u548c\u5176\u5b83\u9898\u89e3\u4e0d\u4e00\u6837\u7684\uff0c\u6211\u7684 dp \u8fc7\u7a0b\u4e3b\u8981\u662f\u5229\u7528\u57fa\u73af\u6811\u7684\u4e00\u4e2a\u6027\u8d28\u5c06\u8be5\u95ee\u9898\u5206\u89e3\u4e3a\u4e24\u4e2a\u5b50\u95ee\u9898\u9010\u4e00\u89e3\u51b3\u3002\n\n    $\\qquad\\!\\!$\u7531\u4e8e\u4e00\u68f5\u57fa\u73af\u6811\u53ef\u4ee5\u770b\u4f5c\u4e00\u68f5\u6811\u52a0\u4e86\u4e00\u6761\u975e\u91cd\u8fb9\u5728\u56fe\u4e0a\u5f62\u6210\u4e86\u552f\u4e00\u4e00\u4e2a\u73af\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5c06\u8be5\u73af\u4e0a\u7684\u6bcf\u4e2a\u70b9\u770b\u4f5c\u4e00\u4e2a**\u6839\u8282\u70b9**\uff0c\u5728\u4e0d\u8003\u8651\u73af\u4e0a\u7684\u70b9\u4e0e\u4e4b\u8054\u901a\u7684\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2a\u6839\u8282\u70b9\u90fd\u8054\u901a\u51fa**\u4e00\u68f5\u6811**\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e00\u68f5\u57fa\u73af\u6811\u7b49\u4ef7\u4e8e**\u5f88\u591a\u68f5\u6811\u7684\u6839\u8282\u70b9\u88ab\u8fde\u5728\u4e86\u4e00\u4e2a\u73af\u4e0a\u7684\u4e00\u5f20\u56fe**\u3002\n\n    $\\qquad\\!\\!$\u7531\u6b64\uff0c\u6211\u4eec\u4fbf\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u95ee\u9898\u5206\u89e3\u4e3a**\u4ee5\u73af\u4e0a\u7684\u70b9\u4e3a\u6839\u8282\u70b9\u7684\u5f88\u68f5\u591a\u6811\u7684 \u6811\u5f62 dp $+$ \u8fd9\u4e9b\u73af\u4e0a\u7684\u70b9\u7684 \u73af\u5f62 dp**\u3002\n\n    $\\qquad\\!\\!$\u5177\u4f53\u8fc7\u7a0b\u5982\u4e0b\uff1a\n\n    - 1\u3001\u627e\u73af\uff1a\n\n    $\\qquad\\!\\!$\u6211\u5229\u7528\u7684\u662f\u62d3\u6251\u6392\u5e8f $+$ dfs \u7684\u65b9\u5f0f\u8fdb\u884c\u627e\u73af\u3002\n\n    $\\qquad\\!\\!$\u9996\u5148\uff0c\u5bf9\u4e8e\u6240\u6709\u8282\u70b9\u62d3\u6251\u6392\u5e8f\u4e00\u904d\uff0c\u800c\u540e\u5165\u5ea6\u4e3a $2$ \u7684\u70b9\u5c31\u662f\u73af\u4e0a\u7684\u70b9\u3002\n\n    $\\qquad\\!\\!$\u5176\u6b21\uff0c\u4efb\u610f\u9009\u62e9\u4e00\u4e2a\u73af\u4e0a\u7684\u70b9\uff08\u6211\u9009\u62e9\u7684\u5c31\u662f\u7f16\u53f7\u6700\u5c0f\u7684\u8282\u70b9\uff09\u8fdb\u884c dfs\u3002\n\n    $\\qquad\\!\\!$\u6700\u540e\uff0c\u6bcf\u6b21 dfs \u5230\u4e00\u4e2a **\u672a\u88ab\u8bb0\u5f55\u5165\u73af\u5e76\u4e14\u5165\u5ea6\u4e3a $2$ \u7684\u8282\u70b9**\uff0c\u5c06\u5176\u8bb0\u5f55\u5165\u73af\u5e76\u8fdb\u884c\u9012\u5f52\u3002\n\n    $\\qquad\\!\\!$\u53ef\u80fd\u6709\u540c\u5b66\u8981\u95ee\uff1a\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u76f4\u63a5\u62d3\u6251\u6392\u5e8f\u540e\u6bcf\u4e2a\u70b9\u4e00\u6b21\u5faa\u73af\u4e00\u904d\u5165\u5ea6\u4e3a $2$ \u5c31\u8bb0\u5f55\u5165\u73af\u800c\u8981\u533a dfs \u5462\uff1f\n\n    $\\qquad\\!\\!$\u90a3\u662f\u56e0\u4e3a\u6211\u4eec\u4e4b\u540e\u9700\u8981\u8fdb\u884c \u73af\u5f62 dp\uff0c\u9700\u8981\u4fdd\u8bc1**\u73af\u4e0a\u4f9d\u6b21\u8fde\u7eed\u7684\u70b9\u5728\u56fe\u4e0a\u4e5f\u662f\u4f9d\u6b21\u8fde\u7eed\u7684**\uff0c\u6240\u4ee5\u4e0d\u80fd\u53ea\u8fdb\u884c\u4e00\u4e2a\u7b80\u7b80\u5355\u5355\u7684\u5faa\u73af\u800c\u9700\u8981 dfs\u3002\n\n    - 2\u3001\u6811\u5f62 dp\uff1a\n\n    $\\qquad\\!\\!$\u5373\u5bf9\u4e8e\u6bcf\u68f5\u6811\u90fd\u8fdb\u884c\u4e00\u6b21[\u6ca1\u6709\u4e0a\u53f8\u7684\u821e\u4f1a](https://www.luogu.com.cn/problem/P1352)\u7684 dp \u8fc7\u7a0b\uff1a\n\n    $\\qquad\\!\\!$\u8bbe $f_{i,0}$ \u8868\u793a $i$ \u70b9\u4e0d\u9009\u62e9\uff0c$i$ \u70b9\u5b50\u6811\u7684\u6700\u5927\u8d21\u732e\uff1b$f_{i,1}$ \u8868\u793a $i$ \u70b9\u9009\u62e9\uff0c$i$ \u70b9\u5b50\u6811\u7684\u6700\u5927\u8d21\u732e\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u70b9 $i$\uff0c$f_{i,0}$ \u7684\u521d\u59cb\u503c\u4e3a $0$\uff0c$f_{i,1}$ \u7684\u521d\u59cb\u503c\u5373\u4e3a\u9898\u76ee\u4e2d\u7684\u6bcf\u4e2a\u70b9\u7684\u4eba\u6d41\u91cf $p_i$\u3002\n\n    $\\qquad\\!\\!$\u8f6c\u79fb\u65b9\u7a0b\uff08$v$ \u70b9\u4e3a $u$ \u70b9\u7684\u5b50\u8282\u70b9\uff09\uff1a\n\n    $\\qquad\\!\\!f_{u,0}\\gets f_{u,0}+\\max(f_{v,0},f_{v,1})$\n\n    $\\qquad\\!\\!f_{u,1}\\gets f_{u,1}+f_{v,0}$\n\n    - 3\u3001\u73af\u5f62 dp\uff1a\n\n    $\\qquad\\!\\!$_\u6ca1\u6709\u63a5\u89e6\u8fc7 \u73af\u5f62 dp \u7684\u540c\u5b66\u53ef\u4ee5\u5de6\u8f6c\u5148\u770b\u4e00\u4e0b\u8fd9\u4e24\u9053\u9898\uff1a[P6064 [USACO05JAN]Naptime G](https://www.luogu.com.cn/problem/P6064) \u548c [SP283 NAPTIME - Naptime](https://www.luogu.com.cn/problem/SP283)\u3002_\n\n    $\\qquad\\!\\!$\u7531\u4e8e\u6b64\u65f6\u6bcf\u68f5\u6811\u5185\u90e8\u8282\u70b9\u7684\u5173\u7cfb\u5747\u5df2\u6ee1\u8db3\u9898\u76ee\u7684\u9650\u5b9a\uff0c\u5269\u4e0b\u7684\u5c31\u662f\u73af\u4e0a\u7684\u5404\u4e2a\u8282\u70b9\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u5bf9\u6bcf\u68f5\u6811\u7684\u6839\u8282\u70b9\u8fdb\u884c\u4e00\u6b21 \u73af\u5f62 dp \u5373\u53ef\u5f97\u51fa\u7b54\u6848\u3002\n\n    $\\qquad\\!\\!$\u8bbe $c_i$ \u4e3a\u73af\u4e0a\u7b2c $i$ \u4e2a\u70b9\u7684\u7f16\u53f7\uff0c$tot$ \u4e3a\u73af\u4e0a\u7684\u8282\u70b9\u603b\u6570\u3002\n\n    $\\qquad\\!\\!$\u90a3\u4e48\u6b64\u65f6 $f_{c_i,0}$ \u4ee3\u8868\u4ee5 $c_i$ \u4e3a\u6839\u7684\u6811\u4e0d\u9009 $c_i$ \u6700\u5927\u8d21\u732e\uff1b $f_{c_i,1}$ \u4ee3\u8868\u4ee5 $c_i$ \u4e3a\u6839\u7684\u6811\u9009 $c_i$ \u6700\u5927\u8d21\u732e\u3002\n\n    $\\qquad\\!\\!$\u8bbe $g_{i,0}$ \u8868\u793a\u70b9 $c_i$ \u4e0d\u9009\uff0c\u524d $i$ \u4e2a\u8282\u70b9\u7684\u6700\u5927\u8d21\u732e\uff0c\u8bbe $g_{i,1}$ \u8868\u793a\u70b9 $c_i$ \u9009\uff0c\u524d $i$ \u4e2a\u8282\u70b9\u7684\u6700\u5927\u8d21\u732e\u3002\n\n    $\\qquad\\!\\!$\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n    $\\qquad\\!\\!g_{i,0}\\gets \\max(g_{i-1,0},g_{i-1,1})+f_{c_i,0}$\n\n    $\\qquad\\!\\!g_{i,1}\\gets g_{i-1,0}+f_{c_i,1}$\n\n    $\\qquad\\!\\!$\u7531\u4e8e\u662f\u8fdb\u884c \u73af\u5f62 dp\uff0c\u4e3a\u4e86\u679a\u4e3e\u5168\u9762\u6240\u6709\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u9700\u8981\u8fdb\u884c\u4e24\u6b21 dp \u8fc7\u7a0b\uff1a\n\n    $\\qquad\\!\\!$\u2460\u3001\u89c4\u5b9a $c_1$ \u8282\u70b9\u4e00\u5b9a\u4e0d\u9009\uff1a\n\n    $\\qquad\\!\\!\\qquad\\!\\!$\u521d\u59cb\u5316 $g$ \u4e2d\u7684\u6bcf\u4e00\u4e2a\u5143\u7d20\u4e3a $-inf$\uff1b$g_{1,0}=f_{c_1,0}$\u3002\n\n    $\\qquad\\!\\!\\qquad\\!\\!$\u8fdb\u884c dp\uff0c\u7edf\u8ba1\u7b54\u6848 $ans=\\max(g_{tot,0},g_{tot,1})$\u3002\n\n    $\\qquad\\!\\!$\u2461\u3001\u89c4\u5b9a $c_1$ \u8282\u70b9\u4e00\u5b9a\u9009\uff1a\n\n    $\\qquad\\!\\!\\qquad\\!\\!$\u521d\u59cb\u5316 $g$ \u4e2d\u7684\u6bcf\u4e00\u4e2a\u5143\u7d20\u4e3a $-inf$\uff1b$g_{1,1}=f_{c_1,1}$\u3002\n\n    $\\qquad\\!\\!\\qquad\\!\\!$\u8fdb\u884c dp\uff0c\u7edf\u8ba1\u7b54\u6848 $ans=\\max(ans,g_{tot,0})$\u3002\n    \n- \u4e09\u3001\u590d\u6742\u5ea6\u5206\u6790\uff1a\n\n\t- \u65f6\u95f4\u590d\u6742\u5ea6\uff1a\u65e0\u8bba\u662f\u5728\u627e\u73af\u8fd8\u662f\u5728\u4e24\u6b21 dp \u7684\u8fc7\u7a0b\u4e2d\uff0c\u6bcf\u4e2a\u70b9\u6700\u591a\u88ab\u7ecf\u8fc7\u4e00\u6b21\uff0c\u6240\u4ee5\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n)$\u3002\n   \n   - \u7a7a\u95f4\u590d\u6742\u5ea6\uff1a\u7531\u51e0\u4e2a\u6570\u7ec4\u7684\u5b9a\u4e49\u53ef\u77e5\uff0c\u6bcf\u4e2a\u6570\u7ec4\u6240\u7528\u7684\u7a7a\u95f4\u5747\u4e3a $O(n)$ \u7684\u6570\u91cf\u7ea7\uff0c\u6240\u4ee5\u603b\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a $O(n)$\u3002\n\n- \u56db\u3001\u6700\u540e\uff0c\u4e0a\u4ee3\u7801\uff08\u7801\u98ce\u4e0d\u559c\u52ff\u55b7\uff09\uff1a\n\n```cpp\n//P1453 \u57ce\u5e02\u73af\u8def\n#include<bits/stdc++.h>\n#define in inline\n#define re register\n#define N 100010\nusing namespace std;\nint n;\nint cnt,head[N];\nstruct edge\n{\n\tint to,nxt;\n};\nedge e[N<<1];\nbool b[N];\nint tot;\nint rd[N],c[N];\nint f[N][2],g[N][2];\nint ans;\ndouble k;\nin int qread()\n//\u5feb\u8bfb\n{\n    int x=0,y=1;\n    int ch=getchar();\n    while(ch<'0'||ch>'9')\n    {\n        if(ch=='-')\n\t\t{\n\t\t\ty=-1;\n\t\t}\n        ch=getchar();\n    }\n    while(ch>='0'&&ch<='9')\n    {\n        x=(x<<1)+(x<<3)+(ch^48);\n        ch=getchar();\n    }\n    return x*y;\n}\nin void mr(re int u,re int v)\n//\u5efa\u8fb9\n{\n\te[++cnt].to=v;\n\te[cnt].nxt=head[u];\n\thead[u]=cnt;\n\treturn ;\n}\nin void dfs0(re int u,re int fa)\n//\u627e\u73af\n{\n\tfor(re int i=head[u];i;i=e[i].nxt)\n\t{\n\t\tint v=e[i].to;\n        //\u7236\u8282\u70b9\u6216\u5df2\u5728\u73af\u4e0a\u5c31\u4e0d\u7b97\n\t\tif(v==fa||b[v])\n\t\t{\n\t\t\tcontinue;\n\t\t}\n        //\u627e\u5230\u4e00\u4e2a\u70b9\u5c31\u52a0\u5165\u73af\n\t\tif(rd[v]==2)\n\t\t{\n\t\t\tb[v]=1;\n\t\t\tc[++tot]=v;\n            //\u9012\u5f52\n            dfs0(v,u);\n            //\u52a0\u5165\u4e00\u4e2a\u70b9\u540e\u5c31\u8df3\u51fa\u5faa\u73af\n\t\t\tbreak;\n\t\t}\n\t}\n    return ;\n}\nin void tppx()\n//\u62d3\u6251\u6392\u5e8f\n{\n\tqueue<int> q;\n\tfor(re int i=1;i<=n;i++)\n\t{\n\t\tif(rd[i]==1)\n\t\t{\n\t\t\tq.push(i);\n\t\t}\n\t}\n\twhile(!q.empty())\n\t{\n\t\tint u=q.front();\n\t\tq.pop();\n\t\tfor(re int i=head[u];i;i=e[i].nxt)\n\t\t{\n\t\t\tint v=e[i].to;\n\t\t\trd[v]--;\n\t\t\tif(rd[v]==1)\n\t\t\t{\n\t\t\t\tq.push(v);\n\t\t\t}\n\t\t}\n\t}\n\tfor(re int i=1;i<=n;i++)\n\t{\n        //\u627e\u5230\u7b2c\u4e00\u4e2a\u5728\u73af\u4e0a\u7684\u70b9\u52a0\u5165\u73af\u5e76\u8fdb\u884c dfs\n\t\tif(rd[i]==2)\n\t\t{\n\t\t\tb[i]=1;\n\t\t\tc[++tot]=i;\n\t\t\tdfs0(i,0);\n            //\u52a0\u5165\u4e00\u4e2a\u70b9\u540e\u5c31\u8df3\u51fa\u5faa\u73af\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn ;\n}\nin void dfs(re int u,re int fa)\n//\u6811\u5f62 dp\n{\n\tfor(re int i=head[u];i;i=e[i].nxt)\n\t{\n\t\tint v=e[i].to;\n\t\tif(v==fa||b[v])\n        //\u7236\u8282\u70b9\u6216\u5df2\u5728\u73af\u4e0a\u5c31\u4e0d\u7b97\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\t\tdfs(v,u);\n        //\u8f6c\u79fb\n\t\tf[u][0]+=max(f[v][1],f[v][0]);\n\t\tf[u][1]+=f[v][0];\n\t}\n\treturn ;\n}\nint main()\n{\n    //\u8bfb\u5165\n\tn=qread();\n\tfor(re int i=1;i<=n;i++)\n\t{\n\t\tf[i][1]=qread();\n\t}\n\tfor(re int i=1;i<=n;i++)\n\t{\n\t\tint u=qread()+1;\n\t\tint v=qread()+1;\n        //\u7edf\u8ba1\u5165\u5ea6\n\t\trd[u]++;\n\t\trd[v]++;\n        //\u5efa\u8fb9\n\t\tmr(u,v);\n\t\tmr(v,u);\n\t}\n    //\u62d3\u6251\u6392\u5e8f\n\ttppx();\n    //\u5bf9\u4e8e\u6bcf\u68f5\u6811 \u6811\u5f62 dp\n\tfor(re int i=1;i<=tot;i++)\n\t{\n\t\tdfs(c[i],0);\n\t}\n    //\u73af\u5f62 dp\n\tmemset(g,-0x3f,sizeof(g));\n\tg[1][0]=f[c[1]][0];\n\tfor(re int i=2;i<=tot;i++)\n\t{\n\t\tg[i][1]=g[i-1][0]+f[c[i]][1];\n\t\tg[i][0]=max(g[i-1][0],g[i-1][1])+f[c[i]][0];\n\t}\n\tans=max(g[tot][0],g[tot][1]);\n\tmemset(g,-0x3f,sizeof(g));\n\tg[1][1]=f[c[1]][1];\n\tfor(re int i=2;i<=tot;i++)\n\t{\n\t\tg[i][1]=g[i-1][0]+f[c[i]][1];\n\t\tg[i][0]=max(g[i-1][0],g[i-1][1])+f[c[i]][0];\n\t}\n\tans=max(ans,g[tot][0]);\n    //\u8bfb\u5165 k\n\tscanf(\"%lf\",&k);\n    //\u8f93\u51fa\u7b54\u6848\n\tprintf(\"%.1lf\\n\",ans*k);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1597187666,
        "uid": 226623,
        "name": "LHRG\u674e",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1453 \u3010\u57ce\u5e02\u73af\u8def\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u5c31\u662f\u96be\u4e00\u70b9\u7684\u6811\u5f62dp\n\n\u53ea\u8981\u60f3\u6e05\u695a\u5982\u4f55\u5904\u7406\u73af\u5c31\u5f88\u7b80\u5355\u4e86\uff08\u7136\u800c\u6211\u8fd8\u662f\u4e00\u5982\u65e2\u5f80\u7684\u770b\u4e86\u9898\u89e3\uff09\n\n\u5148dfs\u9884\u5904\u7406\n\n\u5982\u679c\u8fd9\u4e2a\u70b9\u7684\u4e0b\u4e00\u4e2a\u70b9\u5df2\u7ecf\u904d\u5386\u8fc7\u4e86\n\n\u5c31\u8868\u660e\u5b83\u4fe9\u5728\u73af\u4e0a\n\n\u5b9a\u4e3as1,s2\n\n\u5f3a\u62c6s1,s2\u4e4b\u95f4\u7684\u8fb9\n\n\u4ee5s1,s2\u4e3a\u6839\u6811\u5f62dp\n\n\u7528\u4e8c\u7ef4\u6570\u7ec4\u8868\u660e\u7b2ci\u4e2a\u70b9\u9009\u6216\u4e0d\u9009\u7684\u6700\u5927\u503c\n\nf[i][1]\u8868\u793a\u5efa\n\nf[i][0]\u8868\u793a\u4e0d\u5efa\n\n\u6240\u4ee5\n\n\nf[i][1]+=f[c[i].y][0];\n\nf[i][0]+=max(f[c[i].y][1],f[c[i].y][0]);\n\n\u8f93\u51faf[s1][0],f[s2][0]\u6700\u5927\u503c\n\n\uff08\u5173\u4e8e\u4e3a\u4ec0\u4e48\u662ff[s1][0],f[s2][0]\u6700\u5927\u503c\uff1a\n\n\u5982\u679c\u662ff[s1][1]\u65f6\n\n\u65e0\u6cd5\u5224\u65ad\u9009s2\u65f6\u662f\u5426\u662f\u6700\u5927\u503c\n\n\u6240\u4ee5\u5e72\u8106\u4e0d\u9009s1\n\n\u4ee5\u6c42\u51fa\u4e0d\u9009s1\u65f6\u7684\u6700\u5927\u503c\n\n\u800c\u9009s1\u65f6\u7684\u6700\u5927\u503c\u5728s2\u4e2d\u5224\u65ad\n\n\u6240\u4ee5\u6700\u540e\u8981\u53d6\u6700\u5927\u503c\uff09\n\n```cpp\n# include<iostream>\n# include<cstdio>\n# include<cstring>\nusing namespace std;\nstruct p{\n    int x,y;\n}c[1000001];\nint n,num,s1,s2;\nint h[1000001];\ndouble k,ans;\ndouble p[1000001];\ndouble f[1000001][2];\nbool ff;\nbool use[1000001];\nvoid add(int x,int y)\n{\n    c[++num].x=h[x];\n    c[num].y=y;\n    h[x]=num;\n}\nvoid dfs(int x,int y)\n{\n    use[x]=1;\n    for(int i=h[x];i;i=c[i].x)\n      if(c[i].y!=y)\n      {\n          if(use[c[i].y])\n          {\n              ff=1;\n              s1=x,s2=c[i].y;\n              return;\n        }\n        dfs(c[i].y,x);\n        if(ff) return;\n      }\n    use[x]=0;\n}\nvoid dfs1(int x,int y)\n{\n    f[x][1]=p[x];\n    for(int i=h[x];i;i=c[i].x)\n      {\n          if((x==s1&&c[i].y==s2)||(x==s2&&c[i].y==s1)||c[i].y==y)\n          continue;\n          dfs1(c[i].y,x);\n          f[x][1]+=f[c[i].y][0];\n          f[x][0]+=max(f[c[i].y][1],f[c[i].y][0]);\n      }\n}\nint main()\n{\n    scanf(\"%d\",&n);\n    for(int i=0;i<n;i++)\n      scanf(\"%lf\",&p[i]);\n    for(int i=1;i<=n;i++)\n      {\n          int x,y;\n          scanf(\"%d%d\",&x,&y);\n          add(x,y);\n          add(y,x);\n      }\n    scanf(\"%lf\",&k);\n    dfs(0,0);\n    dfs1(s1,s1);\n    double ans1=f[s1][0];\n    memset(f,0,sizeof(f));\n    dfs1(s2,s2);\n    double ans2=f[s2][0];\n    printf(\"%.1lf\",max(ans1,ans2)*k);\n    return 0;\n}\n\n```",
        "postTime": 1508664172,
        "uid": 49206,
        "name": "Dispwnl",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1453 \u3010\u57ce\u5e02\u73af\u8def\u3011"
    },
    {
        "content": "2020.6.10 \u66f4\u65b0\uff1a\u4fee\u6539\u4e86\u7528\u8bed\uff0c\u4ee3\u7801\u6dfb\u52a0\u4e86\u6ce8\u91ca\n\n\u548c\u6ca1\u6709\u4e0a\u53f8\u7684\u821e\u4f1a\u5dee\u4e0d\u591a\uff0c\u552f\u4e00\u7684\u4e0d\u540c\u662f\u589e\u52a0\u4e86\u4e00\u6761\u8fb9\uff0c\u6210\u4e3a\u4e86\u57fa\u73af\u6811\u3002\n\n\u8003\u8651\u627e\u5230\u90a3\u4e2a\u552f\u4e00\u7684\u73af\uff0c\u5904\u7406\u6210\u6811\u7684\u60c5\u51b5\u3002\n\n\u540c\u6837\u7684\uff0c\u9996\u5148dfs\u627e\u5230\u73af\uff0c\u8fd9\u91cc\u8003\u8651\u5047\u5982\u4e00\u4e2a\u70b9\u904d\u5386\u5b83\u7684\u513f\u5b50\u65f6\uff0c\u53d1\u73b0\u5b83\u7684\u513f\u5b50\u5df2\u7ecfvis\u4e86\uff0c\u90a3\u4e48\u8fd9\u4e24\u4e2a\u70b9\u5c31\u5728\u73af\u4e0a\u3002\n\n\u628a\u8fd9\u4e24\u4e2a\u70b9\u53d6\u51fa\uff0c\u65ad\u5f00\u8fde\u63a5\uff0c\u6210\u4e3a\u4e00\u9897\u6811\uff0c\u5206\u522b\u7528\u4e24\u4e2a\u70b9\u4f5c\u4e3a\u6839\u8282\u70b9\u8fdb\u884cdfs(\u5b9e\u9645\u64cd\u4f5c\u5b9e\u73b0\u4e2d\u5219\u8bb0\u5f55\u6839\u8282\u70b9\u4e3ano\uff0c\u5f53\u652f\u8def\u513f\u5b50\u7b49\u4e8eno\u65f6\uff0c\u4e0d\u62d3\u5c55\u8fd9\u9897\u5b50\u6811)\n\n\u5047\u5982\u4e24\u70b9\u4e3au,v\n\ndp[u][0]\u8bb0\u5f55\u4e86\u4e0d\u53d6u\u7684\u6700\u4f18\u60c5\u51b5,dp[v][0]\u8bb0\u5f55\u4e86\u4e0d\u53d6v\u7684\u6700\u4f18\u60c5\u51b5,\u56e0\u4e3au,v\u5728\u539f\u56fe\u4e2d\u76f8\u90bb\uff0c\u4e0d\u80fd\u540c\u65f6\u53d6\uff0c\u6240\u4ee5\u6700\u540e\u7684\u7b54\u6848\u5c31\u662fdp[u][0],dp[v][0]\u6700\u5927\u503c\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint n,u,v,ans=0;\ndouble k;\nint cnt=0;\nint w[200005];\nstruct edge{\n\tint num;\n\tint next;\n}p[200005];\nint head[200005]={0};\nvoid add(int a,int b){\n\tp[++cnt].num=b;\n\tp[cnt].next=head[a];\n\thead[a]=cnt;\n}\nbool flag=0;\nbool vis[100005]={0};\nint dp[100005][2]={0};\nvoid dfs(int u,int pre,int no){\n\tdp[u][1]=w[u];\n\tdp[u][0]=0;\n\tfor(int i=head[u];i;i=p[i].next){\n\t\tint v=p[i].num;\n\t\tif(v==pre){//\u8df3\u8fc7\u7236\u8282\u70b9\n\t\t\tcontinue;\n\t\t}\n\t\tif(v!=no){\n\t\t\tdfs(v,u,no);\n\t\t\tdp[u][1]+=dp[v][0];//\u8f6c\u79fb\u72b6\u6001\uff0c\u53d6 \u4e0d\u53d6\u4e0a\u4e2a\u70b9\u7684\u60c5\u51b5\n\t\t\tdp[u][0]+=max(dp[v][0],dp[v][1]);//\u53d6 \u4e0a\u4e2a\u70b9\u7684\u4e24\u72b6\u6001\u7684\u6700\u5927\u503c\n\t\t}\n\t}\n}\nvoid fc(int x,int pre){\n\tif(flag){//\u5047\u5982\u5df2\u7ecf\u627e\u5230\u4e86\u73af\uff0c\u7ee7\u7eed\u5c31\u6ca1\u6709\u610f\u4e49\n\t\treturn ;\n\t}\n\tif(!vis[x]){//vis\u8bb0\u5f55\u6709\u6ca1\u6709\u8d70\u8fc7\n\t\tvis[x]=1;\n\t}\n\tfor(int i=head[x];i;i=p[i].next){\n\t\tint v=p[i].num;\n\t\tif(v==pre){\n\t\t\tcontinue;\n\t\t}\n\t\tif(!vis[v]){\n\t\t\tfc(v,x);\n\t\t}else{//x v\u5728\u73af\u4e0a \n\t\t\tflag=1;\n            //\u76f8\u5f53\u4e8e\u65ad\u5f00x v\uff0c\u5206\u522b\u4ee5\u4e24\u70b9\u4e3a\u6839\u8282\u70b9dp\n\t\t\tdfs(x,v,x);//\u4ee5x\u4e3a\u8d77\u70b9\uff0c\u8bb0\u5f55x\u4e0d\u4f1a\u4f5c\u4e3a\u5b50\u8282\u70b9\n\t\t\tans=max(ans,dp[x][0]);\n\t\t\tdfs(v,x,v);//\u4ee5v\u4e3a\u8d77\u70b9\uff0c\u8bb0\u5f55x\u4e0d\u4f1a\u4f5c\u4e3a\u5b50\u8282\u70b9\n\t\t\tans=max(ans,dp[v][0]);\n            //\u6700\u7ec8\u7b54\u6848\u76f8\u5f53\u4e8e\u662f\u4e0d\u53d6u\u6216\u8005\u4e0d\u53d6v\u7684\u7b54\u6848\u7684\u6700\u5927\u503c\uff0c\u56e0\u4e3a\u663e\u7136\u4e24\u8005\u4e0d\u80fd\u540c\u65f6\u53d6\n\t\t\treturn;\n\t\t}\n\t}\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%d\",&w[i]);//\u6bcf\u4e2a\u70b9\u7684\u4ef7\u503c\n\t} \n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%d%d\",&u,&v);\n\t\tu++;//\u5904\u7406\u4e3a1-n\n\t\tv++;\n\t\tadd(u,v);//\u8fde\u63a5u v\uff0c\u7c7b\u4f3c\u94fe\u5f0f\u524d\u5411\u661f\n\t\tadd(v,u);\n\t}\n\tscanf(\"%lf\",&k);\n\tfc(1,1);//\u4ece\u4e00\u53f7\u70b9\u5f00\u59cb\u627e\u73af\uff0c\u5148\u9ed8\u8ba4\u5b83\u7684\u7956\u5148\u662f\u81ea\u5df1\n\tdouble answer=(double)ans*k;//\u5229\u6da6\u662fk\u500d\u7684\u4eba\u6d41\u91cf\n\tprintf(\"%.1lf\",answer);\n\treturn 0;\n}\n```\n",
        "postTime": 1589557490,
        "uid": 215604,
        "name": "dztlb",
        "ccfLevel": 0,
        "title": "P1453 \u57ce\u5e02\u73af\u8def"
    },
    {
        "content": "## \u524d\u6765\u51d1\u4e00\u7bc7\u9898\u89e3\uff0c\u4e00\u9053\u57fa\u73af\u6811\u6811\u5f62dp(\u3065\uff61\u25d5\u203f\u203f\u25d5\uff61)\u3065\n**\u4ece\u9a91\u58eb\u90a3\u91cc\u8f6c\u8fc7\u6765\u7684\uff0c\u8fd9\u4e24\u4e2a\u9898\u6709\u5f88\u5927\u7684\u76f8\u4f3c\u4e4b\u5904\uff0c\u6811\u5f62dp\u597d\u50cf\u90fd\u6709\u4e00\u5b9a\u7684\u7ee7\u627f\u6027\u3002\u5982\u679c\u4f60\u662f\u6811\u5f62dp\u840c\u65b0\u7684\u8bdd\uff0c\u53ef\u4ee5\u53bb\u770b\u6ca1\u6709\u4e0a\u53f8\u7684\u665a\u4f1a\uff0c\u5982\u679c\u4f60\u662f\u5927\u4f6c\u7684\u8bdd\uff0cA\u6389\u8fd9\u4e2a\u9898\u540e\u987a\u4fbf\u53ef\u4ee5\u53bb\u628a\u9a91\u58ebA\u6389\u3002**\n\n\n------------\n\n**emmm\uff0c\u8dd1\u9898\u4e86 \u3002\u8fd9\u79cd\u9898\u7684\u5957\u8def\u5c31\u662f\u5c06\u73af\u4e0a\u7684\u968f\u610f\u76f8\u90bb\u4e24\u70b9\u94a6\u5b9a\u53ea\u9009\u4e00\u70b9\u3002\u7136\u540e\u8dd1\u4e24\u8fb9\u6811\u5f62dp\u5c31\u597d\u4e86\u3002\u627e\u73af\u8fd9\u4e2a\u64cd\u4f5c\u662f\u5728dfs\u7684\u65f6\u5019\u7ef4\u62a4\u4e00\u4e2avis\u6570\u7ec4\uff08\u90fd\u4e0d\u964c\u751f\u5427\uff09\uff0c\u7136\u540e\u53ea\u8981\u9047\u89c1\u4e00\u4e2a\u88ab\u6807\u8bb0\u8fc7\u5f97\uff0c\u5c31\u8bf4\u660e\u5b83\u5728\u73af\u4e0a\uff0c\u540c\u65f6\u5b83\u7684\u524d\u9a71\u4e00\u5b9a\u4e5f\u5728\u73af\u4e0a\u3002\u5c31\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u627e\u5230\u4e86\u4e24\u4e2a\u70b9\uff0c\u7136\u540e\u5206\u522b\u4ee5\u4ed6\u4eec\u4e3a\u6839\u8dd1dp\u5c31\u884c\u4e86\uff0c\u4ee3\u7801\u4e5f\u6ca1\u6709\u96be\u5ea6\u3002**\n\n**\u4e0d\u8fc7\u8fd9\u4e2a\u9898\u6211\u5e76\u6ca1\u6709\u7528\u697c\u4e0a\u5404\u4f4d\u5927\u4f6c\u7684 ^ \u64cd\u4f5c~~\uff08\u624d\u4e0d\u662f\u4e0d\u4f1a\u7528\u5450\uff09~~\uff0c\u6211\u5728\u6811\u5f62dp\u65f6\u591a\u4f20\u4e86\u4e00\u4e2a\u53c2\u6570\uff0c\n\u5982\u4e0b**\n```cpp\nvoid dfs(int u,int pre,int no)\n```\n**u\u8868\u793a\u5f53\u524d\u8282\u70b9\uff0cpre\u5b58\u524d\u9a71\uff0cno\u5b58\u94a6\u5b9a\u4e0d\u9009\u7684\u70b9\u3002\n\u7136\u540e\u5c31\u53ef\u4ee5\u5f00\u5f00\u5fc3\u5fc3\u7684dp\u4e86**\n\n\n------------\n\n#### AC\u4ee3\u7801\uff1a\n```cpp\n#include<iostream>\n#include<cstdio>\nconst int maxn = 100001;\nconst int inf=0x7ffff;\nusing namespace std;\nint n,w[maxn],f[maxn][2],ans=0;\ndouble k;\nbool vis[maxn];\nstruct edge\n{\n    int y,next;\n}e[maxn<<1];\nint head[maxn<<1],cnt=0;\nvoid add(int x,int y)\n{\n    e[++cnt].y=y;\n    e[cnt].next=head[x];\n    head[x]=cnt;\n}\nint flag=0;\nvoid dfs(int u,int pre,int no)\n{\n    f[u][0]=0,f[u][1]=w[u];\n    for(int i=head[u];i;i=e[i].next)\n    {\n        int v=e[i].y;\n        if(v==pre)continue;\n        if(v!=no)\n        {\n            dfs(v,u,no);\n            f[u][1]+=f[v][0];\n            f[u][0]+=max(f[v][0],f[v][1]);  \n        }\n        else f[u][1]=-inf;\n    }\n}\nvoid find_circle(int x,int pre)\n{\n    if(flag) return;\n    if(!vis[x]) vis[x]=1;\n    for(int i=head[x];i;i=e[i].next)\n    {\n        int v=e[i].y;\n        if(v==pre) continue;\n        if(!vis[v]) find_circle(v,x);\n        else\n        {\n            dfs(x,v,x);\n            int temp=max(f[x][1],f[x][0]);\n            dfs(v,x,v);\n            ans=max(f[v][0],max(f[v][1],temp));\n            flag=1;\n            return ;   \n        }\n    }\n}\nint main()\n{\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;i++)\n        scanf(\"%d\",&w[i]);\n    for(int i=1;i<=n;i++)\n    {\n        int a,b;\n        scanf(\"%d%d\",&a,&b);\n        a++,b++;\n        add(a,b);\n        add(b,a);\n    }\n    scanf(\"%lf\",&k);\n    find_circle(1,1);\n    double answer=(double)ans*k;\n    printf(\"%.1lf\",answer);\n}\n```\n### PS\uff1a\u849f\u84bb\u7684\u4e00\u7bc7\u535a\u6587\uff0c\u8c22\u8c22\u652f\u6301(\u2229_\u2229)\n2018-08-09 16:27",
        "postTime": 1533803262,
        "uid": 119451,
        "name": "\u62ff\u7701\u4e00\u5c31\u6539\u540d",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1453 \u3010\u57ce\u5e02\u73af\u8def\u3011"
    },
    {
        "content": "# P1453 \u57ce\u5e02\u73af\u8def \u9898\u89e3\n\n\n## [\u95f4\u9699](https://www.luogu.com.cn/problem/P1453)\n\n## \u524d\u7f6e\u77e5\u8bc6\n\n- ### \u6811\u5f62dp,\u57fa\u73af\u6811\n\n## \u5927\u81f4\u9898\u610f\n\n\u7ed9\u4e00\u9897\u542b\u6709\u70b9\u6743\u7684\u57fa\u73af\u5916\u5411\u6811\n\n\n\n\u5047\u5982\u4e24\u4e2a\u70b9\u4e4b\u95f4\u6709\u4e00\u6761\u8fb9\u8fde\u63a5,\u5982\u679c\u9009\u62e9\u4e86\u5176\u4e2d\u4e00\u7aef\u7684\u8282\u70b9,\u90a3\u53e6\u4e00\u6bb5\u7684\u8282\u70b9\u5219\u4e0d\u53ef\u9009\u62e9\n\n\n\u6c42:\u6700\u5927\u8d21\u732e\n\n## \u5206\u6790\n\n\u5148\u8bb2\u4e00\u4e0b\u4ec0\u4e48\u662f\u57fa\u73af\u6811\u3002\n\n\u57fa\u73af\u6811,\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u591a\u4e86\u4e00\u6761\u8fb9\u7684\u6811,\u4ea7\u751f\u4e86\u4e00\u4e2a\u73af\u5f62\u7ed3\u6784,\u73af\u4e0a\u7684\u6bcf\u4e2a\u8282\u70b9\u90fd\u662f\u4e00\u9897\u6811\u7684\u6839\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g8bnch8r.png)\n\n\u753b\u6210\u56fe\u7684\u8bdd\u5927\u6982\u662f\u8fd9\u4e2a\u6837\u5b50(\u57fa\u73af\u5916\u5411\u6811)\n\n\u4e00\u822c\u6765\u8bf4,\u8fd9\u79cd\u9898\u76ee\u7684\u505a\u6cd5\u90fd\u662f\u5148\u627e\u5230\u73af,\u65ad\u5f00\u73af\u4e2d\u7684\u4e00\u6761\u8fb9,\n\u628a\u5b83\u5f53\u6210\u4e00\u822c\u7684\u6811\u5f62$DP$\u6765\u505a\u3002\n\n### \u5982\u4f55\u627e\u73af?\n\n\u4e00\u822c\u6709$dfs$\u8ddf\u5e76\u67e5\u96c6\u4e24\u79cd\u65b9\u6cd5 , \u8fd9\u91cc\u6211\u91c7\u7528\u7684\u662f\u5e76\u67e5\u96c6\u7684\u505a\u6cd5\n\n\u4e00\u5f00\u59cb\u6bcf\u4e2a\u8282\u70b9\u90fd\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u96c6\u5408\n\n\u6bcf\u8fde\u63a5\u4e00\u6761\u8fb9,\u5c31\u628a\u8fd9\u4e24\u4e2a\u70b9\u5408\u5e76\u5230\u4e00\u4e2a\u96c6\u5408\u4e2d\n\n\u5982\u679c\u5728\u8fde\u63a5\u4e00\u6761\u8fb9\u4e4b\u524d,\u4e24\u4e2a\u8282\u70b9\u5c31\u5df2\u7ecf\u5728\u4e00\u4e2a\u96c6\u5408\u4e2d\u4e86,\u8bf4\u660e\u8fd9**\u4e24\u4e2a\u8282\u70b9\u5df2\u7ecf\u8054\u901a\u4e86,\u518d\u8fde\u63a5\u8fd9\u6761\u8fb9\u5fc5\u7136\u4f1a\u4ea7\u751f\u73af\u7684\u60c5\u51b5**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/53vb8z0u.png)\n### \u5982\u4f55\u8f6c\u79fb?\n\n\u627e\u5230\u4e86\u73af\u4e4b\u540e,\u53ea\u9700\u8981\u5c06\u73af\u4e0a\u7684\u8fd9\u6761\u8fb9\u65ad\u5f00\u5373\u53ef\n\n\u8fd9\u6837\u7684\u8bdd\u5c31\u53ef\u4ee5\u5f53\u4f5c\u666e\u901a\u7684\u6811\u5f62$DP$\u6765\u505a\u4e86\n\n\u8bbe$f[i][0]$\u4e3a\u9009\u7b2c$i$\u4e2a\u8282\u70b9\u4ea7\u751f\u7684\u6700\u5927\u8d21\u732e\n\n$f[i][1]$\u4e3a\u4e0d\u9009\u7b2c$i$\u4e2a\u8282\u70b9\u4ea7\u751f\u7684\u6700\u5927\u8d21\u732e\n\n\u5982\u679c\u9009\u4e86\u7b2c$i$\u4e2a\u8282\u70b9,\u90a3\u5b83\u7684\u513f\u5b50\u80af\u5b9a\u90fd\u4e0d\u80fd\u9009\n\n\u53cd\u4e4b,\u513f\u5b50\u53ef\u4ee5\u9009\u62e9\u9009,\u4e5f\u53ef\u4ee5\u9009\u62e9\u4e0d\u9009\n\n\u5f97\u5230\u8f6c\u79fb\u65b9\u7a0b:\n\n$f[u][0] = \\sum f[v][0]$\n\n$f[u][1] = \\sum max(f[v][1],f[v][0])$\n\n## \u4ee3\u7801\u5b9e\u73b0\n\n\u601d\u8def\u660e\u767d\u4e86\u4ee3\u7801\u5b9e\u73b0\u5e94\u8be5\u5c31\u4e0d\u96be\u4e86\n\n\u8981\u6ce8\u610f\u7684\u662f\u73af\u4e0a\u7684\u4e24\u4e2a\u70b9\u90fd\u53ef\u4ee5\u4f5c\u4e3a\u6811\u7684\u6839\u8282\u70b9,\u56e0\u6b64\u5728$DP$\u7684\u65f6\u5019\u8981\u628a\u4e24\u4e2a\u70b9\u90fd\u8dd1\u4e00\u904d\n\n\u5177\u4f53\u7684\u7ec6\u8282\u6ce8\u91ca\u6709\u5199\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int MAXN = 1e5+10;\nstruct edge{//\u5b58\u56fe \n\tint v,next;\n}e[MAXN<<1];\nint f[MAXN][2],w[MAXN];//dp\u6570\u7ec4,\u70b9\u6743 \ndouble k; \nint fa[MAXN];\nint head[MAXN<<1],cnt = 0;\nint root1,root2;//\u73af\u4e0a\u7684\u4e24\u4e2a\u70b9 \nint n;\nvoid add(int u,int v){//\u524d\u5411\u661f \n\te[++cnt].v = v;\n\te[cnt].next = head[u];\n\thead[u] = cnt;\n} \nint find(int x){//\u67e5\u627e\u96c6\u5408 \n\tif(fa[x]==x){\n\t\treturn x;\n\t}\n\telse{\n\t\treturn fa[x] = find(fa[x]);\n\t}\n}\n\nvoid circle(int u,int fa){//\u6811\u5f62dp \n\tf[u][1] = w[u],f[u][0] = 0;//\u521d\u59cb\u5316 \n\tfor(int i=head[u];i;i=e[i].next){\n\t\tint v = e[i].v;\n\t\tif(v!=fa){ \n\t\t\tcircle(v,u);\n\t\t\tf[u][0]+=max(f[v][1],f[v][0]);//\u8f6c\u79fb \n\t\t\tf[u][1]+=f[v][0];\n\t\t}\n\t}\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%d\",&w[i]);\n\t\tfa[i] = i;//\u521d\u59cb\u5316\u96c6\u5408 \n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tint u,v;\n\t\tscanf(\"%d%d\",&u,&v);\n\t\tu++,v++;\n\t\tif(find(u)==find(v)){//\u5982\u679c\u5728\u52a0\u8fb9\u524d\u5c31\u5728\u4e00\u4e2a\u96c6\u5408\u4e2d\u4e86,\u8bf4\u660e\u627e\u5230\u4e86\u73af \n        \troot1 = u,root2 = v;//\u8bb0\u5f55\u73af\u4e0a\u7684\u4e24\u4e2a\u70b9 \n        \tcontinue;//\u76f4\u63a5\u8df3\u8fc7\u52a0\u8fb9\u64cd\u4f5c,\u76f8\u5f53\u4e8e\u65ad\u5f00\u8fd9\u6761\u8fb9 \n\t\t}\n        add(u,v);\n\t\tadd(v,u);\n\t\tfa[find(v)] = find(u);//\u5408\u5e76\u96c6\u5408 \n\t}\n\tscanf(\"%lf\",&k);\n\tcircle(root1,0);\n\tdouble r1 = f[root1][0];//\u9009root1 \n\t\n\tcircle(root2,0);\n\tdouble r2 = f[root2][0];//\u9009root2 \n\t\n\tprintf(\"%.1lf\",max(r1,r2)*k);//\u53d6\u6700\u5927 \n\treturn 0;\n}\n```\n\n",
        "postTime": 1596463537,
        "uid": 244466,
        "name": "xcxc82",
        "ccfLevel": 0,
        "title": "P1453 \u57ce\u5e02\u73af\u8def \u9898\u89e3"
    },
    {
        "content": "# \u9898\u76ee\u5927\u610f\n\u7ed9\u4f60\u4e00\u9897\u57fa\u73af\u6811\uff08\u6bd4\u666e\u901a\u6811\u591a\u4e00\u6761\u8fb9\u5f62\u6210\u4e00\u4e2a\u73af\uff09\uff0c\u6bcf\u4e00\u4e2a\u70b9\u6709\u4e00\u4e2a\u6743\u503c\uff0c\u8981\u6c42\u76f8\u90bb\u7684\u4e24\u4e2a\u70b9\u4e0d\u80fd\u540c\u65f6\u9009\uff0c\u6c42\u6240\u6709\u65b9\u6848\u4e2d\u6743\u503c\u6700\u5927\u4e3a\u591a\u5c11\uff0c\u6700\u540e\u518d\u4e58\u4e00\u4e2a\u5b9e\u6570\u3002\n# \u65b9\u6cd5\n![](https://cdn.luogu.com.cn/upload/image_hosting/i9u4h6ow.png)\n\n\u4e0a\u9762\u662f\u4e00\u4e2a\u57fa\u73af\u6811\u7684\u56fe\uff0c\u5706\u8868\u793a\u4e00\u4e2a\u70b9\uff0c\u4e09\u89d2\u5f62\u8868\u793a\u4e00\u9897\u6811\u3002\n\n\u6211\u4eec\u8981\u5728\u57fa\u73af\u6811\u4e0a\u505a$dp$\uff0c\u5176\u5b9e\u53ef\u4ee5\u8f6c\u5316\u4e3a\u5bf9\u4ee5\u5728\u73af\u4e0a\u6bcf\u4e00\u4e2a\u70b9\u4e3a\u6839\u7684\u6811\u4e2d\u505a\u6811\u5f62$dp$\uff0c\u6700\u540e\u5728\u73af\u4e0a\u505a\u73af\u5f62$dp$\u3002\n\n## \u6b65\u9aa4\n1.\u627e\u73af\uff0c\u7528$dfs$\uff0c\u7528$book$\u6807\u8bb0\u5df2\u7ecf\u8d70\u8fc7\u7684\u70b9\uff0c\u5982\u679c\u4ece\u4e00\u4e2a\u70b9\u8d70\u5230\u4e86\u4e00\u4e2a\u88ab\u6807\u8bb0\u8fc7\u7684\u70b9\u5e76\u4e14\u8fd9\u4e2a\u70b9\u4e0d\u662f\u4ed6\u7684\u7236\u4eb2\uff0c\u8bc1\u660e\u627e\u5230\u73af\u4e86\uff0c\u7136\u540e\u4ece\u8fd9\u4e2a\u70b9\u4e00\u76f4\u5f80\u4e0a\u8df3\u5230\u88ab\u6807\u8bb0\u7684\u70b9\uff0c\u5c31\u627e\u5230\u4e86\u73af\uff0c\u5e76\u7528\u6570\u7ec4\u8bb0\u5f55\u73af\u4e0a\u7684\u70b9\u3002\n```\nbool dfs(int u,int fa)\n{\n\tf[u]=fa;\n\tbook[u]=1;\n\tfor(int i=head[u];i;i=e[i].next)\n\t{\n\t\tint y=e[i].to;\n\t\tif (y==fa)continue;\n\t\tif (book[y])\n\t\t{\n\t\t\tint x=u;\n\t\t\twhile(x!=f[y])\n\t\t\t{\n\t\t\t\tcnt++;\n\t\t\t\ts[cnt]=x;\n\t\t\t\tv[x]=1;\n\t\t\t\tx=f[x];\n\t\t\t}\n\t\t\treturn 1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (dfs(y,u))return 1;\n\t\t}\n\t}\n\treturn 0;\n}\n```\n2.\u5728\u6bcf\u4e00\u4e2a\u6811\u4e0a\u505a\u6811\u5f62$dp$\uff0c\u4e0d\u4f1a\u7684\u53ef\u4ee5\u5148\u53bb\u505a\u6ca1\u6709\u4e0a\u53f8\u7684\u821e\u4f1a\u3002\n```\nfor (int i=1;i<=cnt;i++)dfs_dp(s[i],0);\n```\n\n```\nvoid dfs_dp(int x,int fa)\n{\n\tfor (int i=head[x];i;i=e[i].next)\n\t{\n\t\tint y=e[i].to;\n\t\tif (v[y]||y==fa)continue;\n\t\tdfs_dp(y,x);\n\t\tdp[x][0]+=max(dp[y][0],dp[y][1]);\n\t\tdp[x][1]+=dp[y][0];\n\t}\n\tdp[x][1]+=a[x];\n}\n```\n3.\u5728\u73af\u4e0a\u505a$dp$\uff0c\u6211\u4eec\u7528$g[i][1/0][1/0]$\u8868\u793a\u5f53\u524d\u70b9\uff0c\u5f53\u524d\u70b9\u9009\u4e0d\u9009\uff0c\u7b2c\u4e00\u4e2a\u70b9\u9009\u4e0d\u9009\uff08\u56e0\u4e3a\u662f\u73af\uff0c\u6700\u540e\u4e00\u4e2a\u70b9\u4e0e\u7b2c\u4e00\u4e2a\u70b9\u76f8\u8fde\uff09\u3002\n\n\u6211\u7528$s[i]$\u8bb0\u5f55\u7684\u73af\u4e0a\u7684\u70b9\u3002\n\n```\ng[s[i]][1][1]=g[s[i-1]][0][1]+dp[s[i]][1];//\u5f53\u524d\u70b9\u9009\uff0c\u4e0a\u4e00\u4e2a\u70b9\u5c31\u4e0d\u9009\uff0c\u7b2c\u4e00\u4e2a\u70b9\u9009\u3002\ng[s[i]][0][1]=max(g[s[i-1]][0][1],g[s[i-1]][1][1])+dp[s[i]][0];//\u5f53\u524d\u70b9\u4e0d\u9009\uff0c\u4e0a\u4e00\u4e2a\u70b9\u53ef\u4ee5\u9009\u4e5f\u53ef\u4ee5\u4e0d\u9009\uff0c\u7b2c\u4e00\u4e2a\u70b9\u9009\u3002\ng[s[i]][1][0]=g[s[i-1]][0][0]+dp[s[i]][1];//\u5f53\u524d\u70b9\u9009\uff0c\u4e0a\u4e00\u4e2a\u70b9\u5c31\u4e0d\u9009\uff0c\u7b2c\u4e00\u4e2a\u70b9\u4e0d\u9009\u3002\ng[s[i]][0][0]=max(g[s[i-1]][1][0],g[s[i-1]][0][0])+dp[s[i]][0];//\u5f53\u524d\u70b9\u4e0d\u9009\uff0c\u4e0a\u4e00\u4e2a\u70b9\u53ef\u4ee5\u9009\u4e5f\u53ef\u4ee5\u4e0d\u9009\uff0c\u7b2c\u4e00\u4e2a\u70b9\u4e0d\u9009\u3002\n```\n\n\n4\u8f93\u51fa\u7b54\u6848\uff0c\u6211\u4eec\u8f93\u51fa\u6700\u540e\u4e00\u4e2a\u70b9\u4e0d\u9009\uff0c\u7b2c\u4e00\u4e2a\u70b9\u4e0d\u9009\uff0c\u6700\u540e\u4e00\u4e2a\u70b9\u9009\uff0c\u7b2c\u4e00\u4e2a\u70b9\u4e0d\u9009\uff0c\u6700\u540e\u4e00\u4e2a\u70b9\u4e0d\u9009\uff0c\u7b2c\u4e00\u4e2a\u70b9\u4e0d\u9009\u4e09\u4e2a\u65b9\u6848\u4e2d\u6743\u503c\u6700\u5927\u7684\uff0c\u518d\u4e58$k$\uff08\u6211\u7528$m$\u8868\u793a\uff0c\u6211\u7528\u4e86\u6eda\u52a8\u6570\u7ec4\uff09\u3002\n```\nprintf(\"%.1lf\",(double)max(max(g[cnt%2][0][1],g[cnt%2][1][0]),g[cnt%2][0][0])*m);\n```",
        "postTime": 1598684887,
        "uid": 227436,
        "name": "\u5e74\u534e\u5929\u5730",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P1453 \u3010\u57ce\u5e02\u73af\u8def\u3011"
    },
    {
        "content": "```\n//\u4e00\u9053\u4e0a\u5348\u7684\u65f6\u5019\u4e0d\u77e5\u9053\u54ea\u9519\u4e86\u53d1\u4e86\u8ba8\u8bba\u7136\u540e\u653e\u5f03\u4e86\u7684\u9898\u3002\n//\u611f\u8c22@sqairy \u5927\u4f6c   \u4e00\u8bed\u9053\u7834\u6211\u7684\u9519\u8bef\u6240\u5728\n \n//\u697c\u4e0b\u90fd\u7528\u7684dfs\u627e\u73af\uff0c\u5f53\u65f6\u6ca1\u60f3\u51fa\u7528dfs\u505a\u6765\uff0c\u6240\u4ee5\u5728\u8f93\u5165\u7684\u65f6\u5019\u5904\u7406\u7684\u73af \n//\u56e0\u4e3a\u5982\u679c\u4e00\u6761\u8fb9\u7684\u7aef\u70b9\u5df2\u7ecf\u5168\u90e8\u51fa\u73b0\u7684\u8bdd\uff0c\u6211\u4eec\u628a\u8fd9\u6761\u8fb9\u52a0\u8fdb\u53bb\uff0c\u5c31\u6784\u6210\u4e86\u4e00\u4e2a\u73af\uff0c\n//\u6240\u4ee5\u5f00\u4e00\u4e2aflag[]\u6807\u8bb0\uff0c\u6807\u8bb0\u8fd9\u4e2a\u70b9\u6709\u6ca1\u6709\u8f93\u5165\u8fc7\uff0c\n//\u5982\u679c flag[u]&&flag[v]\uff0c\u90a3\u4e48\u8fd9\u80af\u5b9a\u662f\u4e00\u4e2a\u73af\u4e0a\u7684\u4e00\u6761\u8fb9\uff0c\u7136\u540e\u8ba9A=u,B=v,\n//\u5e76\u4e14\u6211\u4eec\u4e0d\u628a\u8fd9\u6761\u8fb9\u52a0\u8fdb\u56fe\u91cc\uff0c\u8fd9\u6837\u5c31\u6784\u6210\u4e86\u4e00\u68f5\u6811 \n//\u4eceA,B\u505a\u4e24\u6b21\u6811\u5f62DP\uff0c\u627e\u6700\u5927\u503c\u3002 \u548c\u6ca1\u6709\u4e0a\u53f8\u7684\u821e\u4f1a\u90a3\u9053\u9898\u4e00\u6837 \n//\u8fd8\u6709\u5c31\u662f\u8981\u53d6max(dp[A][0],dp[B][0])\uff0c\n//\u4e3a\u4ec0\u4e48\u662f\u4e0d\u9009A\u548cB\u7684\u60c5\u51b5\u7684\u6700\u5927\u503c\uff1a\n//\u56e0\u4e3a\u6211\u4eec\u5982\u679c\u662f\u5728\u9009A\u6216B\u7684\u60c5\u51b5\u4e2d\u53d6\u6700\u5927\u503c\uff0c\u6211\u4eec\u4e0d\u80fd\u4fdd\u8bc1A(B)\u9009\u4e86\uff0c\u4f46\u662fB(A)\u6ca1\u9009\n\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n\nconst int N=1e6+5;\n\nint n,A,B;\ndouble K;\nint p[N];\nint head[N],num_edge;\nbool flag[N];\ndouble dp[N][2];\nstruct Edge\n{\n\tint v,nxt;\n}edge[N<<1];\n\nint read()\n{\n\tchar c=getchar();int num=0;\n\tfor(;!isdigit(c);c=getchar());\n\tfor(;isdigit(c);c=getchar())\n\t\tnum=num*10+c-'0';\n\treturn num;\n}\n\nvoid add_edge(int u,int v)\n{\n\tedge[++num_edge].v=v;\n\tedge[num_edge].nxt=head[u];\n\thead[u]=num_edge;\n}\n\nvoid dfs(int u,int fa)\n{\n\tdp[u][1]=p[u],dp[u][0]=0;\n\tfor(int i=head[u],v;i;i=edge[i].nxt)\n\t{\n\t\tv=edge[i].v;\n\t\tif(v==fa)\n\t\t\tcontinue;\n\t\tdfs(v,u);\n\t\tdp[u][0]+=max(dp[v][0],dp[v][1]);\t//\u8fd9\u4e2a\u70b9\u4e0d\u9009\uff0c\u52a0\u4e0a\u5b83\u7684\u513f\u5b50\u9009\u6216\u4e0d\u9009\u7684\u6700\u5927\u503c \n\t\tdp[u][1]+=dp[v][0];\t//\u8fd9\u4e2a\u70b9\u9009\uff0c\u5b83\u7684\u513f\u5b50\u4eec\u4e0d\u80fd\u9009 \n\t}\n}\n\nint main()\n{ \n\tn=read();\n\tfor(int i=0;i<n;++i)\n\t\tp[i]=read();\n\tbool ok=0;\t//\u6807\u8bb0\u627e\u6ca1\u627e\u5230\u73af \n\tfor(int i=1,u,v;i<=n;++i)\n\t{\n\t\tu=read(),v=read();\n\t\tif(!ok&&flag[u]&&flag[v])\t//\u4e00\u6761\u8fb9\u7684\u4e24\u4e2a\u7aef\u70b9\u90fd\u51fa\u73b0\u8fc7\uff0c\u90a3\u4e48\u7740\u80af\u5b9a\u662f\u4e00\u4e2a\u73af\u4e0a\u7684\u8fb9 \n\t\t{\n\t\t\tok=1;\t//\u627e\u5230\u73af\u4e86 \n\t\t\tA=u,B=v;\t//\u8bb0\u5f55\u4e24\u4e2a\u7aef\u70b9 \n\t\t\tcontinue;\t//\u4e0d\u52a0\u8fd9\u6761\u8fb9 \n\t\t}\n\t\tflag[u]=flag[v]=1;\t\t//\u6807\u8bb0\u4e24\u4e2a\u7aef\u70b9\u5df2\u7ecf\u51fa\u73b0\u8fc7 \n\t\tadd_edge(u,v);\t//\u52a0\u8fb9 \n\t\tadd_edge(v,u);\n\t}\n\tscanf(\"%lf\",&K);\n\tdfs(A,A);\t//\u4eceA\u8dd1DFS \n\tdouble ans=dp[A][0];\n\tdfs(B,B);\t//\u4eceB\u8dd1DFS \n\tans=max(ans,dp[B][0]);\n\tprintf(\"%.1lf\",ans*K);\n\treturn 0;\n}\n```",
        "postTime": 1519651038,
        "uid": 39886,
        "name": "Drifterming",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1453 \u3010\u57ce\u5e02\u73af\u8def\u3011"
    },
    {
        "content": "[P1453 \u57ce\u5e02\u73af\u8def ](https://www.luogu.org/problem/P1453)\n\n\u611f\u89c9\u57fa\u73af\u6811\uff08or\u73af\u5957\u6811\uff09\u7684\u9898\u76ee\u4e00\u822c\u90fd\u662f\u627e\u5230\u6811\u4e0a\u7684\u73af\uff0c\u65ad\u6389\u4e00\u6761\u8fb9\u518d\u8fdb\u884c\u6811\u4e0a\u7684\u64cd\u4f5c\uff08\u5982noip2018[P5022 \u65c5\u884c](https://www.luogu.org/problem/P5022)\uff09\n\n### \u53cc\u500d\u7ecf\u9a8c\uff1a[P2607 [ZJOI2008]\u9a91\u58eb](https://www.luogu.org/problem/P2607)\n\nP1453\u548cP2607\u8fd9\u4e24\u9898\u5b9e\u9645\u4e0a\u5c31\u662f\u57fa\u73af\u6811\u4e0a\u7684[P1352 \u6ca1\u6709\u4e0a\u53f8\u7684\u821e\u4f1a](https://www.luogu.org/problem/P1352)\uff0c\u7528\u6811\u5f62DP\u5373\u53ef\uff0c\u4f46\u662f\u56e0\u4e3a\u6709\u73af\uff0c\u6240\u4ee5\u8981\u5148\u627e\u5230\u73af\u518d\u5220\u4e00\u6761\u8fb9\u624d\u80fdDP\n\n\u81f3\u4e8e\u6811\u5f62DP\u5c31\u4e0d\u591a\u8bf4\u4e86\uff0c\u6bd5\u7adf\u662f\u57fa\u73af\u6811\uff0c\u6700\u4e3b\u8981\u7684\u5c31\u662f\u627e\u73af\u64cd\u4f5c\u4e86\uff0c\u7ffb\u4e86\u7ffb\u9898\u89e3\uff0c\u5927\u6982\u6709\u4e0b\u9762\u51e0\u79cd\u65b9\u6cd5\uff1a\n\n\u4e00. \u8bfb\u5165\u65f6\u5224\u65ad\n\n1. \u5e76\u67e5\u96c6 \uff0c\u82e5\u4e24\u70b9\u5728\u4e00\u4e2a\u5e76\u67e5\u96c6\u4e2d\u5219\u8bb0\u5f55\u4e0b\u6765\uff0c\u4e0d\u8fde\u8fb9\u4e0d\u5408\u5e76\n\n2. \uff08\u4e0d\u5efa\u8bae\u4f7f\u7528\uff09bool\u8bb0\u5f55\u70b9\u662f\u5426\u51fa\u73b0\u8fc7\uff0c\u82e5\u8bfb\u5165\u65f6\u4e24\u70b9\u5728\u4e4b\u524d\u90fd\u5df2\u51fa\u73b0\u4e86\uff0c\u5219\u4e3a\u73af\uff0c\u4e0d\u8fde\u8fb9\uff08**BUG\uff1a\u672c\u9898\u6570\u636e\u8f83\u5f31\u53ef\u8fc7\uff0c\u4f46\u53ef\u80fd\u5728\u4e00\u4e9b\u6570\u636e\u4e2d\u51fa\u9519**\uff0c\u770b\u8bc4\u8bba\u4e2d\u6709\u4e00\u7ec4hack\u6570\u636e\uff1a5 1 2 3 4 5 0 1 2 3 2 4 0 2 3 4 9.0\uff0c\u7b54\u6848\u4e3a63.0\uff0c\u4f46\u8fd9\u79cd\u627e\u73af\u65b9\u6cd5\u4f1a\u8d85\u65f6\uff09\n\n\u4e8c\u3001\u8bfb\u5165\u540e\u5224\u65ad\n\n1. \u5982\u672c\u7a0b\u5e8f\uff0cdfs\u627e\u73af\uff0c\u627e\u5230\u65f6\u8bb0\u5f55\u4e24\u70b9a,b\u6216\u8fb9\u7f16\u53f7e\uff0cdp\u65f6\u4e0d\u4ec5\u8981\u5224\u65adv!=fa\uff0c\u8fd8\u5e94\u5224\u65ad(u!=a || v!=b) && (u!=b || v!=a)\u6216(e!=i && (e^1)!=i)(\u53cc\u5411\u8fb9)\n\n2. \uff08\u4e0d\u5efa\u8bae\u4f7f\u7528\uff09\u8fde\u5355\u5411\u8fb9u->v\uff08\u6ce8\u610f\u8981\u4fdd\u8bc1\u6709\u6709\u5411\u73af\uff09\uff0c\u8bb0\u5f55fa[v]=u\uff0c\u4ece\u4e00\u4e2a\u5df2\u5b58\u5728\u7684\u70b9\u5f00\u59cb\u4e0d\u65ad\u627efa\u76f4\u5230\u9047\u5230\u8d70\u8fc7\u7684\u5219\u627e\u5230\u4e86\u73af\u3002\u8fd9\u79cd\u5199\u6cd5\u53ef\u4ee5\u7528\u5728P2607\uff08\u89c1[**\u8fd9\u4e2a\u9898\u89e3**](https://www.luogu.org/blog/HullEssien/solution-p2607)\uff09\uff0c\u6b64\u9898\u672a\u5fc5\u53ef\u884c\n\n```cpp\nwhile(!vis[fa[rt]]) rt=fa[rt],vis[rt]=1;//rt\u4e0efa[rt]\u8fde\u4e3a\u4e86\u73af\n```\n\n\u5bf9\u4e8e\u6b64\u9898\uff0c\u627e\u5230\u73af\u4e0a\u4e24\u70b9a\uff0cb\u540e\uff0c\u5206\u522b\u4ee5a\uff0cb\u4e3a\u6839\u505a\u4e24\u6b21\u6811\u5f62DP\uff0c\u7b2c\u4e00\u6b21\u53d6f[a][0]\uff0c\u7b2c\u4e8c\u6b21\u53d6f[b][0]\uff08\u8fd9\u6837\u4fdd\u8bc1a\u4e0eb\u867d\u76f8\u90bb\u4f46\u4e0d\u4f1a\u540c\u65f6\u88ab\u88ab\u53d6\uff09\uff0c\u53d6max(f[a][0],f[b][0])\u4e0eK\u76f8\u4e58\u5373\u53ef\n\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<cstring>\nusing namespace std;\n#define ll int //\u8fd9\u4e2a\u4ee3\u7801\u662f\u5728P2607\u7684\u57fa\u7840\u4e0a\u4fee\u6539\u7684\uff0c\u6240\u4ee5\u76f4\u63a5\u628all\u5b9a\u4e49\u4e3aint\u4e86\nconst int N=1e5+100;\nint h[N],rt,rt2,n,cnt,val[N];\nbool vis[N];\nll f[N][2],ans;\nstruct edge {\n\tint v,h;\n} e[N<<1];\ninline void add(int u,int v) {\n\te[++cnt]=(edge) {\n\t\tv,h[u]\n\t},h[u]=cnt;\n}\n\nvoid dp(int x,int fa) {\n\tvis[x]=1,f[x][1]=val[x];\n\tfor (int i=h[x],v; i; i=e[i].h) {\n\t\tv=e[i].v;\n\t\tif ((x!=rt || v!=rt2) && (x!=rt2 || v!=rt) && v!=fa)\n\t\t\tdp(v,x),\n\t\t\tf[x][0]+=max(f[v][0],f[v][1]),\n\t\t\t         f[x][1]+=f[v][0];\n\t}\n}\n\nbool find(int x,int fa) {  //dfs\u627e\u73af\n\tvis[x]=1;\n\tfor(int i=h[x]; i; i=e[i].h)\n\t\tif (e[i].v^fa)\n\t\t\tif (vis[e[i].v]) {\n\t\t\t\trt=e[i].v,rt2=x; //\u627e\u5230\u4e86\u73af\uff0c\u8bb0\u5f55\u8d77\u7aef\u70b9\uff08\u76f8\u5f53\u4e8e\u5207\u65adi\u8fd9\u6761\u8fb9\uff09\n\t\t\t\treturn 1;\n\t\t\t} else if (find(e[i].v,x)) return 1;\n}\n\nvoid solve(int x) { //\u5206\u522b\u4ee5\u4e24\u7aef\u70b9\u505a\u6811\u5f62DP\n\tfind(x,-1);\n\tdp(rt,rt);\n\tll tmp=f[rt][0];\n    \n\tmemset(f,0,sizeof f);\n\tdp(rt2,rt2);\n    \n\tans=max(tmp,f[rt2][0]);\n}\nint main() {\n\tscanf(\"%d\",&n);\n\tfor (int i=0; i<n; i++) scanf(\"%d\",&val[i]);\n\tfor (int i=1,x,y; i<=n; i++) scanf(\"%d%d\",&x,&y),add(x,y),add(y,x);\n\tsolve(0); //\u6ce8\u610f\u82e5\u662f\u68ee\u6797\u9700\u679a\u4e3e1~n\u7684\u70b9\n\tdouble tmp;\n\tscanf(\"%lf\",&tmp);\n\tprintf(\"%.1lf\",(double)ans*tmp);\n}\n```\n",
        "postTime": 1573389321,
        "uid": 68706,
        "name": "Randolph\u3001",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P1453 \u3010\u57ce\u5e02\u73af\u8def\u3011"
    },
    {
        "content": "\u5148\u8bf4\u8bf4\u57fa\u73af\u6811\u662f\u4ec0\u4e48\u5427\uff01\n\n\u57fa\u73af\u6811\u662f\u4e00\u79cd\u56fe\uff0c\u5b83\u7531\u4e00\u4e2a\u73af\u7ec4\u6210\uff0c\u73af\u4e0a\u6bcf\u4e2a\u70b9\u90fd\u662f\u4e00\u68f5\u6811\u70b9\u6811\u6839\uff0c\u6240\u4ee5\u79f0\u4e3a\u57fa\u73af\u6811\u3002\u5f53\u7136\uff0c\u4e00\u68f5\u6811\u4e0a\u8fde\u4e00\u6761\u8fb9\u4e5f\u4f1a\u53d8\u6210\u57fa\u73af\u6811\u3002\n\n\u9898\u76ee\u4e2d *p \u7684\u6761\u4ef6\u901a\u8fc7\u4e58\u6cd5\u5206\u914d\u5f8b\u663e\u7136\u53ef\u4ee5\u63d0\u51fa\u6765\uff0c\u5f53\u6ca1\u6709\u5904\u7406\n\n\u5982\u679c\u672c\u9898\u53d6\u6d88\u6761\u4ef6\u662f\u57fa\u73af\u6811\u800c\u662f\u4e00\u68f5\u6811\uff0c\u90a3\u4e48\u95ee\u9898\u4fbf\u7b80\u5316\u4e3a\u4e86\n[\u6ca1\u6709\u4e0a\u53f8\u7684\u821e\u4f1a](https://www.luogu.org/problemnew/show/P1352)\uff0c\u5904\u7406\u65b9\u6cd5\u5c31\u662f\u7b80\u5355\u7684\u6811\u5f62DP\u3002\n\n\u800c\u57fa\u73af\u6811\u95ee\u9898\u91cd\u8981\u7684\u80af\u5b9a\u5c31\u662f\u65ad\u73af\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5ef6\u4f38\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff0c\u4e00\u4e2a\u70b9\u5728\u6811\u4e0a\u53ea\u6709\u9009\u548c\u4e0d\u9009\u4e24\u79cd\u72b6\u6001\uff0c\u6240\u4ee5\u53ef\u4ee5\u51fa\u73b0\u4e00\u9053\u5904\u7406\u65b9\u5f0f\u76f8\u5173\u7684\u6709\u5411\u57fa\u73af\u6811\u9898\u76ee [\u521b\u4e16\u7eaa](https://www.acwing.com/problem/content/361/) \u8fd9\u9053\u9898\u76ee\u662f\u53cc\u5411\u8fb9\n\n\u56e0\u4e3a\u672c\u9898\u4e0d\u9700\u8981\u679a\u4e3e\u6bcf\u4e2a\u8282\u70b9\u53ea\u9700\u8981\u73af\u4e0a\u6bcf\u4e2a\u8282\u70b9\u6240\u4ee5\u53ef\u4ee5\u4f7f\u7528\u5e76\u67e5\u96c6\u627e\u73af  ~~\u6253\u4e86\u53ef\u6301\u4e45\u5316\u597d\u5199\u53c8\u5feb\u901f~~  \u5e76\u67e5\u96c6\u53ef\u4ee5\u8bf4\u662f\u975e\u5e38\u91cd\u8981\u7684\u6570\u636e\u7ed3\u6784\u4e86 \u4e0d\u4f1a\u7684\u5feb\u5b66\uff01~~\uff08\u90fd\u505a\u57ce\u5e02\u73af\u8def\u4e86\u90fd\u5e94\u8be5\u4f1a\u5427\uff09~~\n\n\u5982\u679c\u9047\u5230\u9898\u76ee\u9700\u8981\u5f3a\u5236\u8981\u6c42\u8def\u5f84\u53ea\u80fd\u591f\u53bbDFS\u4e86\n\n\u800c\u672c\u9898\u56e0\u4e3a\u662f\u65e0\u5411\u56fe\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u5bf9\u65ad\u8fb9\u7684\u4e24\u4e2a\u8282\u70b9\u8fdb\u884c\uff0c\u4e00\u6b21DP\uff0c\u5e76\u4e14\u8bb0\u5f55\u4e0d\u5176\u8282\u70b9\u7684\u7b54\u6848\uff0cmax\u6bd4\u8f83\u5c31\u53ef\u4ee5\u4e86\n\n\u73b0\u5728\u8d34\u4e0acode\u3010\u7531\u4e8e\u662f\u53cc\u500d\u7ecf\u9a8c\u90a3\u8fb9\u6765\u7684\u6240\u4ee5\u6253\u7684\u662f\u68ee\u6797\u7684\u60c5\u51b5 \u5f53\u7136\u68ee\u6797\u662f\u53ef\u4ee5\u89e3\u51b3\u6811\u7684\u95ee\u9898\u7684\u3011\n\n\n```cpp\n#include<iostream>\n#include<stdio.h>\n#include<algorithm>\n#include<string.h>\n#include<queue>\n#include<stack>\n#define LL long long\nusing namespace std;\nconst LL maxn=1000010;\ninline void read(int &x){\n    x=0;int f=1;char c=getchar();\n    while(c>'9'||c<'0'){if(c=='-') f=-1;c=getchar();\t}\n    while(c>='0'&&c<='9') x=(x<<1)+(x<<3)+(c^48),c=getchar();\n    x*=f;\n}\n\nstruct node{\n    int v,nxt;\n}e[maxn<<1];\nint head[maxn],tot;\ninline void add(int x,int y)\n{\n    tot++;\n    e[tot].v = y;\n    e[tot].nxt = head[x];\n    head[x] = tot;\n}\n\nint w[maxn],fa[maxn];\ninline LL find(int x)\n{\n    if(x!=fa[x]) fa[x]=find(fa[x]);\n    return fa[x];\n}\n\nint n,a[maxn],b[maxn],tmp,cnt,nowa,dd;\nLL f[maxn],g[maxn],tmpp;//f\u9009 g\u4e0d\u9009\n\ninline void dfs(LL u,LL fa)\n{\n    f[u]=w[u];\n    g[u]=0;\n    for(int i=head[u];i;i=e[i].nxt)\n    {\n        LL v=e[i].v;\n        if(v==fa||v==nowa) continue;\n        dfs(v,u);\n        \n\t\tif(g[v]>f[v]) g[u]+=g[v];\n        else g[u]+=f[v];//\u5c31\u662fmax \n        \n\t\tf[u]+=g[v];\n    }\n}\nLL ans;\ndouble PP; \nint main()\n{\n    read(n);\n    for(int i=1;i<=n;i++) fa[i]=i,read(w[i]);\n    for(int i=1;i<=n;i++)\n    {\n        read(dd),read(tmp);\n        dd++,tmp++;\n        if(find(tmp)!=find(dd))\n        {\n            add(tmp,dd);\n            add(dd,tmp);\n            fa[fa[tmp]]=fa[dd];\n        }\n        else\n        {\n            cnt++;\n            a[cnt]=tmp;\n            b[cnt]=dd;\n        }\n    }\n    scanf(\"%lf\",&PP);\n    for(int i=1;i<=cnt;i++)\n    {\n        nowa = a[i];\n        dfs(a[i],0);\n        tmpp = g[a[i]];\n        \n        nowa = b[i];\n        dfs(b[i],0);\n        if(tmpp>g[b[i]])\n           ans+=tmpp;\n        else ans+=g[b[i]];\n    }\n    \n    printf(\"%.1lf\",ans*1.0*PP);\n    return 0;\n}\n```\n",
        "postTime": 1563540937,
        "uid": 114556,
        "name": "SimonSu",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1453 \u3010\u57ce\u5e02\u73af\u8def\u3011"
    },
    {
        "content": "\u697c\u4e0b\u7684\u4ee3\u7801\u5176\u5b9e\u662f\u9519\u7684\uff0c\u800c\u4e14\u4ed6\u9898\u89e3\u4e2d\u7684dp\u65b9\u7a0b\u4e5f\u662f\u9519\u7684\u3002\u4ed6\u5728\u4f7f\u7528\u53cd\u5411\u5f27\u5224\u65ad\u65f6\uff0c\u663e\u71361^1=0\uff0c\u800c\u4ed6\u7684\u94fe\u5f0f\u524d\u5411\u661f\u662f\u4ece\u6807\u53f71\u5f00\u59cb\uff0c\u7531\u4e8e\u4ed6\u5728\u5efa\u6811\u7684\u65f6\u5019\u662f\u4ece\u7b2c\u4e8c\u4e2a\u70b91\u5f00\u59cb\u7684\uff0c\u800c\u4e0d\u662f\u4ece\u7b2c\u4e00\u4e2a\u70b90\u5f00\u59cb\u7684\uff0c\u6240\u4ee5\u672c\u9898\u6570\u636e\u5e76\u6ca1\u6709\u68c0\u6d4b\u51fa\u4ed6\u7684\u95ee\u9898\u6765\u3002\u7ba1\u7406\u5458\u89c9\u5f97\u662f\u5426\u9700\u8981\u52a0\u5f3a\u6570\u636e\uff1f\n\n\u6211\u6765\u5177\u4f53\u8bf4\u4e00\u4e0b\u600e\u4e48\u4e2a\u641e\u6cd5\u3002\n\n\u9996\u5148\uff0c\u5bf9\u4e8en\u4e2a\u70b9n\u6761\u8fb9\u7684\u8054\u901a\u56fe\uff0c\u5b83\u4e00\u5b9a\u662f\u4e00\u4e2a\u73af\u52a0\u5916\u5411\u6811\uff0c\u5927\u6982\u957f\u8fd9\u6837\uff1a\n\n ![](https://cdn.luogu.com.cn/upload/pic/7860.png) \n\n\u5c31\u662f\u73af\u4e0a\u7684\u6bcf\u4e2a\u70b9\u90fd\u662f\u4e00\u4e2a\u6811\u7684\u6839\u3002\u8fd9\u4e2a\u56fe\u4e5f\u6709\u5f88\u591a\u6027\u8d28\u3002\u5e38\u5e38\u7684\u5904\u7406\u65b9\u5f0f\u662f\u7f29\u73af\u4e3a\u70b9\uff0c\u6216\u8005\u5c31\u662f\u7834\u73af\u4e3a\u94fe\u3002\n\n\u7531\u4e8e\u8fd9\u4e2a\u56fe\u53ea\u6709\u4e00\u4e2a\u73af\uff0c\u76f4\u63a5\u4e00\u4e2adfs\u6807\u8bb0\u70b9\uff0c\u5982\u679c\u4e00\u4e2a\u70b9\u8d70\u5230\u4e00\u4e2a\u5df2\u7ecf\u6807\u8bb0\u7684\u70b9\u65f6\uff0c\u8fd9\u4e2a\u5c31\u662f\u73af\u4e2d\u7684\u4e00\u6761\u8fb9\uff0c\u76f4\u63a5\u628a\u8fd9\u6761\u8fb9\u4eba\u4e3a\u5220\u6389\uff0c\u7136\u540e\u5206\u522b\u4ee5\u8fd9\u4e24\u4e2a\u70b9\u4e3a\u6839\u505a\u6811\u5f62dp\u3002\u8fd9\u65f6\u5c31\u662f\u4e00\u4e2a\u513f\u5b50\u7236\u4eb2\u7684\u5173\u7cfb\u4e86\uff0c\u51e0\u4e4e\u5c31\u662f\u4e00\u4e2a\uff08\u6ca1\u6709\u4e0a\u53f8\u7684\u821e\u4f1a\uff0c\u53c8\u79f0\u805a\u4f1a\u7684\u5feb\u4e50\uff0c\u53ef\u89c1\u6d1b\u8c37P1271\uff09\n\n\u8bbedp[u][0]\u8868\u793a\u4ee5u\u4e3a\u6839\u7684\u5b50\u6811\u4e2d\uff0c\u4e0d\u9009u\u65f6\u6700\u5927\u6d41\u91cf\uff0cdp[u][1]\u8868\u793a\u4ee5u\u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u9009u\u65f6\u7684\u6700\u5927\u6d41\u91cf\uff0c\n\n\u90a3\u4e48\u6839\u636e\u4e00\u6761\u8fb9\u4e24\u6bb5\u4e0d\u80fd\u90fd\u9009\u53ef\u77e5\uff1a\n\ndp[u][0]=sigma(max(dp[v][0],dp[v][1]))\n\ndp[u][1]=sigma(dp[v][0])+val[u]\n\n\u6700\u7ec8\u5c31\u662fmax(dp[st][0],dp[en][0])\u3010\u4e3a\u4ec0\u4e48\u662f\u4e0d\u9009st\uff0cen\u7684\u72b6\u6001\u5462\uff1f\u56e0\u4e3a\u6211\u4eec\u4eba\u4e3a\u7684\u5220\u6389\u4e86(st,en)\u7684\u8fb9\uff0c\u6240\u4ee5\u5982\u679c\u6211\u4eec\u9009\u4e86st\uff0c\u6211\u4eec\u65e0\u6cd5\u5224\u65ad\u662f\u5426\u9009\u4e86en\uff0c\u6240\u4ee5\u6211\u4eec\u6539\u6210\u4e0d\u9009st\uff0c\u90a3\u4e48\u5c31\u53ef\u80fd\u9009en\uff0c\u4e5f\u6709\u53ef\u80fd\u4e0d\u9009\uff0c\u4f46\u6700\u7ec8\u80af\u5b9a\u662f\u6700\u4f18\u7684\uff0c\u6bd5\u7adf\u8fd9\u6761\u8fb9\u5e76\u4e0d\u662f\u8981\u6c42\u5fc5\u987b\u9009\u4e00\u4e2a\u70b9\u7684\u554a\uff01\u3011\n\n\n\u53c2\u8003\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\nusing namespace std;\nconst int M=100010;\nint EdgeCnt=0,n,a[M],val[M],st,en,idx;\nbool flag=false,vis[M];\nstruct Edge{\n    int to,next;\n}e[M<<1];\nint dp[M][2];\ndouble p;\nint read(){\n    int x=0,f=1;char ch=getchar();\n    while (ch<'0' || ch>'9'){if (ch=='-')f=-1;ch=getchar();}\n    while ('0'<=ch && ch<='9'){x=(x<<3)+(x<<1)+(ch^48);ch=getchar();}\n    return x*f;\n}\nvoid adde(int u,int v){\n    int p=EdgeCnt++;\n    e[p].to=v;e[p].next=a[u];\n    a[u]=p;\n}\nvoid dfs(int u,int fa){\n    vis[u]=true;\n    for (int p=a[u];p!=-1;p=e[p].next){\n        int v=e[p].to;\n        if (v!=fa){\n            if (vis[v]){idx=p,st=u,en=v;flag=true;return;}\n            dfs(v,u);\n            if (flag)return;\n        }\n    }\n}\nvoid calc(int u,int fa){\n    dp[u][1]=val[u];dp[u][0]=0;\n    for (int p=a[u];p!=-1;p=e[p].next){\n        int v=e[p].to;\n        if (v!=fa && p!=idx && (p^1)!=idx){\n            calc(v,u);\n            dp[u][0]+=max(dp[v][0],dp[v][1]);\n            dp[u][1]+=dp[v][0];\n        }\n    }\n}\nint main(){\n    memset(a,0xff,sizeof(a));\n    n=read();\n    for (int i=1;i<=n;i++)val[i]=read();\n    for (int i=1;i<=n;i++){\n        int u=read()+1,v=read()+1;\n        adde(u,v);adde(v,u);\n    }\n    scanf(\"%lf\",&p);\n    dfs(1,0);\n    calc(st,0);double t1=dp[st][0];\n    calc(en,0);double t2=dp[en][0];\n    printf(\"%.1f\",max(t1,t2)*p);\n    return 0;\n}\n\n```",
        "postTime": 1504925868,
        "uid": 54916,
        "name": "I_AM_HelloWord",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1453 \u3010\u57ce\u5e02\u73af\u8def\u3011"
    },
    {
        "content": "\u505a\u6cd5\u5f88\u590d\u6742,\u5e38\u6570\u4e5f\u5947\u5927\u65e0\u6bd4,\u4f46\u8fd8\u662f\u8ddf\u5927\u5bb6\u5206\u4eab\u4e00\u4e0b\u6211\u7684\u505a\u6cd5\n\n\u8fd9\u4e2a\u9898\u6211\u611f\u89c9\u6bd4\u9a91\u58eb\u90a3\u4e2a\u9898\u8fd8\u96be\u4e00\u70b9..\u56e0\u4e3a\u8f93\u5165\u7684\u65f6\u5019\u662f\u4ee5\u65e0\u5411\u56fe\u7684\u5f62\u5f0f,\u6bcf\u4e2a\u70b9\u6ca1\u6709\u7236\u6307\u9488\n\n\u6211\u7684\u5957\u8def\u4e00\u822c\u662f\u8fd9\u6837\u7684\n\n### 1.\u62d3\u6251\u6392\u5e8f\n\n\u6709\u7236\u6307\u9488\u5c31\u7528,\u6ca1\u6709\u7236\u6307\u9488\u5c31\u987a\u4fbf\u6784\u9020\u7236\u6307\u9488,\u7531\u513f\u5b50\u5411\u7236\u4eb2\u8df3,\u540c\u65f6\u7528\u513f\u5b50\u7684\u72b6\u6001\u66f4\u65b0\u7236\u4eb2\u7684\u72b6\u6001\n\n\u5bf9\u4e8e\u672c\u9898,\u7531\u4e8e\u662f\u4e2a\u57fa\u73af\u6811\u800c\u4e14\u662f\u4e2a\u65e0\u5411\u56fe,\u6211\u4eec\u7528$deg[x]$\u8bb0\u5f55\u4e0e$x$\u76f8\u90bb\u7684\u8282\u70b9\u6570,$x$\u80fd\u5165\u961f,\u5f53\u4e14\u4ec5\u5f53$x$\u7684\u513f\u5b50\u5168\u88ab\u8bbf\u95ee,\u53ea\u5269\u4e0b$x$\u7684\u7236\u4eb2\u4e0e\u4e4b\u76f8\u8fde,\u4e5f\u5c31\u662f$deg[x]=1$\n\n\u53cd\u6620\u5230$deg$\u4e0a,\u6bcf\u7b97\u8fc7\u4e00\u4e2a\u70b9,\u5c31\u628a\u5b83\u7684\u7236\u4eb2\u7684$deg--$,\u5982\u679c\u7236\u4eb2\u7684$deg$\u4e3a1,\u5219\u628a\u7236\u4eb2\u5165\u961f\n\n### 2.\u628a\u72b6\u6001\u96c6\u4e2d\u5230\u73af\u4e0a\n\n\u5728\u7b2c\u4e00\u6b65\u62d3\u6251\u6392\u5e8f\u4e4b\u540e,\u73af\u4e0a\u7684\u70b9\u72b6\u6001\u4ecd\u7136\u5904\u4e8e\u539f\u59cb\u72b6\u6001,\u6ca1\u6709\u88ab\u66f4\u65b0\n\n\u8fd9\u65f6\u6211\u4eec\u8981\u627e\u5230\u4e00\u4e9b\u70b9$x$,$x$\u7684\u7236\u6307\u9488\u5728\u73af\u4e0a,\u7528x\u7684\u72b6\u6001\u66f4\u65b0\u4e0e\u4e4b\u76f8\u8fde\u7684\u73af\u4e0a\u7684\u70b9\u7684\u72b6\u6001\n\n### 3.\u4fdd\u5b58\u73af\u4e0a\u7684\u70b9\u7684\u72b6\u6001\n\n\u5728\u7b2c5\u6b65,\u6211\u4eec\u4f1a\u4fee\u6539\u73af\u4e0a\u7684\u70b9\u7684\u72b6\u6001\u503c,\u56e0\u6b64\u8981\u5f00\u4e00\u4e2a\u6570\u7ec4\u4fdd\u5b58\u73af\u4e0a\u7684\u70b9\u7684\u72b6\u6001,\u5e76\u4f5c\u4e3a\u73af\u4e0a\u7684\u70b9\u7684\u70b9\u6743\n\n### 4.\u6309\u987a\u5e8f\u628a\u73af\u4e0a\u70b9\u5b58\u5165\u4e00\u4e2a\u5217\u8868(\u6211\u7528\u7684\u662fSTL\u7684vector)\n\n\u5bf9\u4e8e\u9a91\u58eb\u90a3\u4e2a\u9898,\u53ef\u4ee5\u76f4\u63a5\u5229\u7528\u7236\u6307\u9488\u6309\u987a\u5e8f\u627e\u51fa\u6240\u6709\u73af\u4e0a\u70b9,\u5bf9\u4e8e\u672c\u9898,\u73af\u4e0a\u7684\u70b9\u6ca1\u6709\u53c2\u4e0e\u62d3\u6251\u6392\u5e8f,\u6ca1\u6709\u7236\u6307\u9488,\u6211\u4eec\u53ea\u80fd\u7528\u4e00\u4e2a\u7b80\u5355\u7684dfs\u6765\u627e\n\n### 5.\u5728\u5217\u8868\u4e0aDP\n\n\u5bf9\u4e8e\u672c\u9898\u800c\u8a00,DP\u4e24\u6b21,\u7b2c\u4e00\u6b21\u5f3a\u5236\u9009\u73af\u4e0a\u7b2c\u4e00\u4e2a\u70b9,\u521d\u503c\u4e3a\u6211\u4eec\u4fdd\u5b58\u597d\u7684\u72b6\u6001\n\n\u600e\u4e48\u5f3a\u5236\u5462?DP\u65f6\u662f\u8981\u53d6max\u7684,\u56e0\u6b64\u628a\u4e0d\u9009\u8be5\u70b9\u7684\u7ed3\u679c\u8d4b\u503c\u6210\u8d1f\u65e0\u7a77,\u5728DP\u65f6\u80af\u5b9a\u5c31\u4e0d\u4f1a\u53d6\u8d1f\u65e0\u7a77\u7684\u60c5\u51b5\n\n\u56e0\u4e3a\u662f\u4e2a\u73af,\u6700\u540e\u4e00\u4e2a\u4e0e\u7b2c\u4e00\u4e2a\u70b9\u5b9e\u9645\u4e0a\u662f\u76f8\u8fde\u7684,\u9009\u4e86\u7b2c\u4e00\u4e2a\u4e0d\u80fd\u9009\u6700\u540e\u4e00\u4e2a,\u56e0\u6b64\u7b54\u6848\u662f\u4e0d\u9009\u6700\u540e\u4e00\u4e2a\u70b9\u7684\u7ed3\u679c\n\n\u7b2c\u4e8c\u6b21\u5f3a\u5236\u4e0d\u9009\u73af\u4e0a\u7b2c\u4e00\u4e2a\u70b9,\u4e0e\u7b2c\u4e00\u6b21DP\u540c\u7406\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n;\ndouble ans=0.0;\ndouble k,d[100010][2];//d\u662f\u72b6\u6001\ndouble g[100010][2];//\u7528\u4e8e\u4fdd\u5b58\u72b6\u6001\nbool vis[100010];\nint deg[100010],a[100010];\nint f[100010];//\u7236\u6307\u9488\nqueue<int>q;\nvector<int>v[100010];\nvector<int>cir;//\u4fdd\u5b58\u73af\u4e0a\u70b9\nvoid read(int& x)\n{\n\tchar c=getchar();\n\tx=0;\n\twhile(c<'0'||c>'9')c=getchar();\n\twhile(c>='0'&&c<='9')\n\t{\n\t\tx=x*10+c-'0';\n\t\tc=getchar();\n\t}\n}\nvoid dfs(int x)\n{\n\tvis[x]=1;\n\tcir.push_back(x);\n\tfor(int i=0;i<v[x].size();i++)\n\t{\n\t\tint y=v[x][i];\n\t\tif(!vis[y])dfs(y);\n\t}\n}\ndouble circle(int x)\n{\n\tdouble ans1=0.0,ans2=0.0;\n\tdfs(x);\n\td[cir[0]][0]=(double)-1e9;\n\td[cir[0]][1]=g[cir[0]][1];//\u7b2c\u4e00\u6b21DP,\u5f3a\u5236\u9009\u62e9\u7b2c\u4e00\u4e2a\u70b9\n\tfor(int i=1;i<cir.size();i++)\n\t{\n\t\td[cir[i]][0]=g[cir[i]][0]+max(d[cir[i-1]][0],d[cir[i-1]][1]);\n\t\td[cir[i]][1]=g[cir[i]][1]+d[cir[i-1]][0];\n\t}\n\tans1=d[cir[cir.size()-1]][0];\n\td[cir[0]][0]=g[cir[0]][0];//\u7b2c\u4e8c\u6b21DP,\u5f3a\u5236\u4e0d\u9009\u7b2c\u4e00\u4e2a\u70b9\n\td[cir[0]][1]=(double)-1e9;\n\tfor(int i=1;i<cir.size();i++)\n\t{\n\t\td[cir[i]][0]=g[cir[i]][0]+max(d[cir[i-1]][0],d[cir[i-1]][1]);\n\t\td[cir[i]][1]=g[cir[i]][1]+d[cir[i-1]][0];\n\t}\n\tans2=max(d[cir[cir.size()-1]][0],d[cir[cir.size()-1]][1]);\n\treturn max(ans1,ans2);\n}\nint main()\n{\n\tread(n);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tread(a[i]);\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint x,y;\n\t\tread(x);\n\t\tread(y);\n\t\tx++;\n\t\ty++;\n\t\tv[x].push_back(y);\n\t\tv[y].push_back(x);\n\t\tdeg[x]++;\n\t\tdeg[y]++;\n\t}\n\tscanf(\"%lf\",&k);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\td[i][1]=a[i]*k;\n\t\tif(deg[i]==1)\n\t\t{\n\t\t\tq.push(i);\n\t\t}\n\t}\n\twhile(!q.empty())//\u62d3\u6251\u6392\u5e8f\n\t{\n\t\tint fa=q.front();\n\t\tq.pop();\n\t\tvis[fa]=1;\n\t\tfor(int i=0;i<v[fa].size();i++)\n\t\t{\n\t\t\tint y=v[fa][i];\n\t\t\tif(vis[y])//\u8bbf\u95ee\u8fc7,\u80af\u5b9a\u662f\u513f\u5b50\n\t\t\t{\n\t\t\t\td[fa][0]+=max(d[y][1],d[y][0]);\n\t\t\t\td[fa][1]+=d[y][0];\n\t\t\t}\n\t\t\telse//\u8fd9\u4e2ay\u6ca1\u6709\u8bbf\u95ee\u8fc7,\u80af\u5b9a\u662f\u7236\u4eb2\n\t\t\t{\n\t\t\t\tdeg[y]--;\n\t\t\t\tf[fa]=y;\n\t\t\t\tif(deg[y]==1)q.push(y);\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(vis[i])\n\t\t{\n\t\t\tif(!vis[f[i]])\n\t\t\t{\n\t\t\t\td[f[i]][0]+=max(d[i][1],d[i][0]);\n\t\t\t\td[f[i]][1]+=d[i][0];//\u7528\u4e0d\u5728\u73af\u4e0a\u7684\u70b9\u7684\u72b6\u6001\u66f4\u65b0\u73af\u4e0a\u7684\u70b9\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(!vis[i])//\u4fdd\u5b58\u72b6\u6001\n\t\t{\n\t\t\tg[i][0]=d[i][0];\n\t\t\tg[i][1]=d[i][1];\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(!vis[i])ans+=circle(i);\n\t}\n\tprintf(\"%.1lf\",ans);\n}\n```\n",
        "postTime": 1557280271,
        "uid": 68207,
        "name": "CreeperLordVader",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P1453 \u3010\u57ce\u5e02\u73af\u8def\u3011"
    },
    {
        "content": "\u4f1a\u4e86\u8fd9\u9053\u9898\u5c31\u53ef\u4ee5\u987a\u4fbf$A$\u4e86[P2607 [ZJOI2008]\u9a91\u58eb](https://www.luogu.org/problemnew/show/P2607)\n\n\u7531\u4e8e\u53ea\u6709$n$\u6761\u8fb9\uff0c\u6bcf\u4e2a\u70b9\u4e4b\u95f4\u4e92\u901a\uff0c\u6240\u4ee5\u56fe\u5c31\u662f\u4e00\u9897\u57fa\u73af\u6811\n\n\u6240\u4ee5\u53ea\u9700\u8981$dfs$\u627e\u73af\uff0c\u5728\u73af\u4e0a\u627e\u4efb\u610f\u4e00\u6761\u8fb9\uff0c\u679a\u4e3e\u8fd9\u6761\u8fb9\u7684\u4e24\u7aef\u4e2d\u5176\u4e2d\u4e00\u7aef\u4e0d\u9009(\u56e0\u4e3a\u4e24\u7aef\u4e0d\u80fd\u540c\u65f6\u9009\uff0c\u6240\u4ee5\u81f3\u5c11\u6709\u4e00\u7aef\u4e0d\u9009)\uff0c\u7136\u540e\u8fdb\u884c\u6811\u5f62$dp$\u5373\u53ef\uff0c\u7531\u4e8e\u7136\u540e\u8fd9\u9053\u9898\u5c31\u548c[\u6ca1\u6709\u4e0a\u53f8\u7684\u821e\u4f1a](https://www.luogu.org/problemnew/show/P1352)\u4e00\u6837\u4e86\u3002\n\n### dfs\u627e\u73af\uff1a\n\n\u4e00\u8fb9\u8d70\u4e00\u8fb9\u7528\u4e00\u4e2a$vis$\u6570\u7ec4\u6807\u8bb0\uff0c\u56de\u6eaf\u65f6$vis$\u6e05\u96f6\uff0c\u5982\u679c\u5f53\u524d\u70b9\u7684\u513f\u5b50\u4e0a\u6709$vis$\u6807\u8bb0,\u90a3\u4e48\u8fd9\u4e2a\u70b9\u548c\u5b83\u7684\u513f\u5b50\u5c31\u5728\u73af\u4e0a\u3002\n\n### \u6811\u5f62$dp$:\n\n\u8bbe$f[u][0/1]$\u8868\u793au\u8fd9\u4e2a\u8282\u70b9\u9009$(0)$\u6216\u4e0d\u9009$(1)$\u7684\u6700\u5927\u4ef7\u503c\uff08\u8fd9\u91cc$v$\u8868\u793au\u7684\u6240\u6709\u5b50\u8282\u70b9)\n\n$f[u][1]=\\sum f[v][0]$\n\n$f[u][0]=\\sum max(f[v][0],f[v][1])$\n\n\u7b54\u6848\u5c31\u662f$f[root][0]$,\u8fd9\u91cc\u7684$root$\u5c31\u662f\u679a\u4e3e\u7684\u4e00\u7aef\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\n#define re register\n#define inf 0x3f3f3f3f\n#define N 393939*7\nusing namespace std;\nstruct node{\n\tint to,next;\n}e[N<<1];\ninline int read(){\n    int x=0,w=0;char ch=getchar();\n    while (!isdigit(ch))w|=ch=='-',ch=getchar();\n    while (isdigit(ch))x=(x<<1)+(x<<3)+ch-'0',ch=getchar();\n    return w?-x:x;\n}\nint now,la,n,ans,cnt,head[N],f[N][2],vis[N],fa[N],v[N];\ninline void add(int u,int v){\n\te[++cnt].to=v;\n\te[cnt].next=head[u];\n\thead[u]=cnt;\n}\nvoid dfs(int u,int fa,int rt,int unrt){\n\tf[u][0]=0;f[u][1]=v[u];vis[u]=1;\n\tfor (int i=head[u];i;i=e[i].next){\n\t\tint v=e[i].to;\n\t\tif (v==fa||(u==rt&&v==unrt))continue;\n\t\tif (v!=rt){\n\t\t\tdfs(v,u,rt,unrt);\n\t\t\tf[u][1]+=f[v][0];\n\t\t\tf[u][0]+=max(f[v][1],f[v][0]);\n\t\t}\n\t}\n}\nvoid dfss(int u,int fa){\n\tvis[u]=1;\n\tfor (int i=head[u];i;i=e[i].next){\n\t\tint v=e[i].to;\n\t\tif (v==fa)continue;\n\t\tif (vis[v]){la=v;now=u;return;}\n\t\tdfss(v,u);\n\t}\n\tvis[u]=0;\n}\nvoid lxy(int u){\n\tnow=u,la=0;\n\tdfss(u,0);\n\tdfs(now,0,now,la);\n\tint res=f[now][0];\n\tdfs(la,0,la,now);\n\tans+=max(res,f[la][0]);\n\treturn;\n}\nsigned main(){\n\tn=read();\n\tfor (int i=1;i<=n;++i)\n\t\tv[i]=read();\n\tfor (int i=1;i<=n;++i){\n\t\tint u=read()+1,v=read()+1;\n\t\tadd(u,v);add(v,u);\n\t}\n\tdouble K;\n\tscanf(\"%lf\",&K);\n\tfor (int i=1;i<=n;++i)\n\t\tif (!vis[i])\n\t\t\tlxy(i);\n\tdouble res=1.0*K*ans;\n\tprintf(\"%.1lf\",res);\n\treturn 0;\n}\n```",
        "postTime": 1555766482,
        "uid": 54260,
        "name": "tcchyc",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1453 \u3010\u57ce\u5e02\u73af\u8def\u3011"
    },
    {
        "content": "\u6bd4\u8f83\u7b80\u5355\u7684\u4e00\u9053\u9898\uff0c\u4e0d\u8fc7\u6709\u70b9\u8003\u9a8c\u4ee3\u7801\u80fd\u529b\u3002\n\n------------\n\n\u663e\u7136\uff0c\u6211\u4eec\u8981\u627e\u4e00\u4e2a\u6700\u5927\u72ec\u7acb\u96c6\uff0c\u7136\u800c\u662f\u5728\u57fa\u73af\u6811\u4e0a\u3002\u90a3\u4e48\u6211\u4eec\u7b2c\u4e00\u6b65\u5148\u627e\u51fa\u73af\uff08\u5173\u4e8e\u600e\u4e48\u627e\uff0c\u6709\u5f88\u591a\u65b9\u6cd5\uff0c\u6211\u4e60\u60ef\u7528\u5e76\u67e5\u96c6\u52a0\u4e00\u904ddfs)\uff0c\u6807\u8bb0\u51fa\u6765\u3002\u7136\u540e\u5bf9\u4e8e\u73af\u4e0a\u7684\u6bcf\u4e2a\u8282\u70b9\u5206\u79bb\u51fa\u6765\u4f5c\u4e3a\u6839\uff0c\u505a\u4e00\u904d\u6811\u4e0a\u7684\u6700\u5927\u72ec\u7acb\u96c6\u3002\u8fd9\u6837\u9664\u4e86\u73af\u4e4b\u5916\u7684\u90e8\u5206\u5c31\u6ca1\u6709\u7528\u4e86\u3002\u63a5\u7740\u505a\u4e24\u904d\u73af\u5f62dp\uff0c\u6bcf\u6b21\u5f3a\u5236\u4e0d\u9009\u5934/\u5c3e\uff0c\u5c31\u597d\u4e86\u3002\u5176\u5b9e\u4e5f\u6bd4\u8f83\u6a21\u677f\u3002\n\n------------\n\n\u6211\u7801\u98ce\u4e0d\u597d\uff0c\u51d1\u5408\u770b\u5427QAQ\n```cpp\n\n#include<bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\n#define RE register\n#define clear(a) memset(a,0,sizeof a)\n\ninline int read(){\n    int date=0,w=1;char c=0;\n    while(c<'0'||c>'9'){if(c=='-')w=-1;c=getchar();}\n    while(c>='0'&&c<='9'){date=date*10+c-'0';c=getchar();}\n    return date*w;\n}\n\nvoid chkmin(int &x,int y){\n\tx=min(x,y);\n}\nvoid chkmax(int &x,int y){\n\tx=max(x,y);\n}\nconst int N=2000005;\nint  n,head[N],nxt[N],ver[N],tot,v[N],fa[N];\nvoid add(int x,int y){\n\tver[++tot]=y;nxt[tot]=head[x];head[x]=tot;\n}\nint find(int x){\n\tif(fa[x]==x)return x;\n\treturn fa[x]=find(fa[x]);\n}\nvoid merge(int x,int y){\n\tint a=find(x),b=find(y);\n\tfa[a]=b;\n}\nbool in_one(int x,int y){\n\treturn find(x)==find(y);\n}\nint loop[N];\nstack<int>s;\nint st,e,vis[N],lop[N],cnt;\nbool flg=0;\nvoid dfs(int x){\n\ts.push(x);\n\t\n\t\tif(x==e){\n\t\t\twhile(s.size()){\n\t\t\t\tloop[s.top()] =1;\n\t\t\t\tlop[++cnt]=s.top();\n\t\t\t\ts.pop();\n\t\t\t}\n\t\t\tflg=1;\n\t\t\treturn;\n\t\t}\n\t\n\tif(vis[x]){ s.pop();return;\n\t}\n\tvis[x]=1;\n\tfor(int i=head[x];i;i=nxt[i]){\n\t\tint y=ver[i];\n\t\tdfs(y); \n\t\tif(flg)return;\n\t}\n\ts.pop();\n\tvis[x]=0;\n}\nlong double k;\nint p[N],f[N][2];\nvoid dfs2(int x){\n\tvis[x]=1;\n\tint sum1=0,sum2=0;\n\tfor(int i=head[x];i;i=nxt[i]){\n\t\tint y=ver[i];\n\t\tif(!loop[y]){\n\t\t\tif(!vis[y]){\n\t\t\t\tdfs2(y);\n\t\t\t\tsum1+=f[y][0];\n\t\t\t\tsum2+=max(f[y][0],f[y][1]);\n\t\t\t}\n\t\t\t\n\t\t}\n\t}\n\tf[x][0]=sum2;\n\tf[x][1]=sum1+p[x];\n}\nint d[N][2],ans;\nint main(){\n\t\n    n=read();\n    for(int i=1;i<=n;++i)p[i]=read();\n    for(int i=1;i<=n;++i)fa[i]=i;\n    for(int i=1;i<=n;++i){\n    \tint x,y;\n    \tx=read();y=read();\n    \tx++;y++;\n    \t\n    \tif(in_one(x,y)){\n    \t\tst=x;\n    \t\te=y;\n\t\t}\n    \telse{\n    \t\tadd(x,y);\n    \t\tadd(y,x);\n    \t\tmerge(x,y);\n\t\t} \n\t}\n\tcin>>k;\n\tdfs(st);\n//\tfor(int i=1;i<=n;++i){\n//\t cout<<loop[i]<<endl;\n//\t}\n\tclear(vis);\n\tfor(int i=1;i<=n;++i){\n\t\tif(!loop[i])continue;\n\t\tdfs2(i);\n\t}\n\tfor(int i=1;i<=cnt;++i){\n\t\tint x=lop[i];\n\t\td[i][0]=max(d[i-1][0],d[i-1][1])+f[x][0];\n\t\td[i][1]=d[i-1][0]+f[x][1];\n\t}\n\tchkmax(ans,d[cnt][0]);\n\tclear(d);\n\tfor(int i=cnt;i;--i){\n\t\tint x=lop[i];\n\t\td[i][0]=max(d[i+1][0],d[i+1][1])+f[x][0];\n\t\td[i][1]=d[i+1][0]+f[x][1];\n\t}\n\tchkmax(ans,d[1][0]);\n\tk*=ans;\n//\tfor(int i=1;i<=n;++i){\n//\t\tif(loop[i])cout<<\"qwq \"<< i <<\": \"<< f[i][0] <<' '<< f[i][1] <<endl;\n//\t}\n\tcout<<fixed<<setprecision(1)<<k<<endl;\n\treturn 0;\n}\n\n```\n",
        "postTime": 1553954125,
        "uid": 112316,
        "name": "Linne",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1453 \u3010\u57ce\u5e02\u73af\u8def\u3011"
    },
    {
        "content": "emm\uff0c\u8fd9\u9053\u9898\u627e\u73af\u597d\u50cf\u6bd4dp\u8fd8\u96be\u2026\u2026\n\ndfs\u627e\u73af\u7684\u8bdd\uff0c\u5982\u679c\u6570\u636e\u5c31\u662f\u4e00\u4e2a100000\u4e2a\u70b9\u7684\u5927\u73af\uff0c\u641e\u4e0d\u597d\u8981\u6808\u5d29\uff08\u6df1\u5ea6\u4e3a100000\uff09\u3002\n\n\u800c\u5e7f\u641c\u4f3c\u4e4e\u53c8\u4e0d\u592a\u597d\u8868\u793a\u8def\u5f84\u3002\u600e\u4e48\u529e\u5462\uff1f\n\n\u6211\u7528\u6808\u6a21\u62df\u6df1\u641c\u2026\u2026orz\n\n### **\u3010\u5f3a\u70c8\u5efa\u8bae\u5148\u770b\u63a5\u4e0b\u6765\u7684\u4ee3\u7801\uff0c\u56e0\u4e3a\u4e0b\u9762\u7684\u63cf\u8ff0\u5b8c\u5168\u5c31\u662f\u4f2a\u4ee3\u7801\u2026\u2026\u770b\u4e0d\u61c2\u4ee3\u7801\u518d\u6765\u8bfb\u4f2a\u4ee3\u7801\u561b\u3011**\n\n\u6df1\u641c\u9700\u8981\u4e24\u4e2a\u53c2\u6570\uff1adep\u8868\u793a\u6df1\u5ea6\uff0cnow\u8868\u793a\u5f53\u524d\u7ed3\u70b9\n\n\u6df1\u641c\u5176\u5b9e\u8fd8\u9700\u8981\u989d\u5916\u4e00\u4e2a\u53c2\u6570\uff0c\u5c31\u662f\u5f53\u524d\u679a\u4e3e\u5230\u4e86\u8fd9\u4e2a\u8282\u70b9\u7684\u54ea\u4e00\u6761\u8fb9\uff08\u90bb\u63a5\u8868\u5b58\u56fe\uff09\n\n\u6240\u4ee5\u5f00\u4e09\u4e2a\u6808\uff08stack\uff09\n\n```cpp\nstd::stack<int> stk, edge_rank, dep;\n```\n\n\u7136\u540e\u679a\u4e3e\u8fd9\u4e2a\u70b9\u76f8\u8fde\u7684\u8fb9NextEdge\uff0c\u5982\u679c\u8fd9\u4e2a\u8fb9\u8fde\u5230\u7684\u70b9\u672a\u8bbf\u95ee\u8fc7\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u6df1\u641c\u4e86\u3002\n\n\u82e5\u8fd9\u4e2a\u8fb9\u8fde\u5230\u7684\u70b9\u5df2\u7ecf\u88ab\u8bbf\u95ee\u8fc7\u4e86\uff0c\u90a3\u4e48\u5224\u65ad\u8fd9\u4e2a\u70b9\u7684\u6df1\u5ea6\u662f\u5426\u4e3a\u5f53\u524d\u70b9\u7684\u6df1\u5ea6-1\uff0c\u5982\u679c\u662f\uff0c\u5219\u8bf4\u660e\u8fd9\u4e2a\u8fb9\u901a\u5411\u70b9\u662f\u6765\u5230\u5f53\u524d\u70b9\u7684\u70b9\uff0c\u5ffd\u7565\uff1b\u5426\u5219\uff0c\u8fd9\u4e2a\u5c31\u51fa\u73b0\u73af\u4e86\uff0c\u6807\u8bb0CircleBegin\u5e76\u4e14break\n\n\u9700\u8981\u6df1\u641c\u7684\u65f6\u5019\uff0c\u66f4\u65b0\u5f53\u524d\u6808edge_rank\u7684\u503c\uff0c\u7136\u540e\u5c06\u6df1\u641c\u7684\u4e09\u4e2a\u53c2\u6570\u538b\u5165\u6808\uff0c\u5e76\u4e14\u6807\u8bb0vis[nextpoint]\u4e3a\u5f53\u524d\u70b9\u7684\u6df1\u5ea6+1\uff0cbreak\u6389\u5faa\u73af\u3002\n\n\u5728\u5faa\u73af\u5916\uff0c\u5982\u679cNextEdge\u662f\u65e0\u6548\u503c\uff08\u679a\u4e3e\u5b8c\u4e86\u8fd9\u4e2a\u70b9\u7684\u8fb9\uff09\uff0c\u90a3\u4e48\u8bf4\u660e\u9000\u51fa\u7684\u539f\u56e0\u662f\u8fd9\u4e2a\u70b9\u7684\u8fb9\u679a\u4e3e\u5b8c\u4e86\uff0c\u800c\u975e\u9700\u8981\u6df1\u641c\uff0c\u6240\u4ee5pop\u6389\u4e09\u4e2a\u6808\u6808\u9876\u7684\u5143\u7d20\n\n\u5728\u6700\u5916\u9762\uff0c\u4e0d\u505c\u7684\u9000\u6808\u76f4\u5230\u6808\u9876\u5143\u7d20\u7b49\u4e8eCircleBegin\uff0c\u90a3\u4e48\u9000\u51fa\u6765\u7684\u5143\u7d20\u53caCircleBegin\u90fd\u662f\u5c5e\u4e8e\u8fd9\u4e2a\u73af\u7684\u4e86\uff0c\u800c\u4e14\u662f\u975e\u5e38\u597d\u7684\u76f8\u90bb\u5173\u7cfb\u3002\uff08\u8054\u60f3\u4e00\u4e0b\u6df1\u641c\uff09\n\n\n\n\n```cpp\n\nvoid dfs()\n{\n\tstk.push(0);//\u4ece0\u53f7\u70b9\u5f00\u59cb\u641c\u7d22\n\tedge_rank.push(iHead[0]);\n\tdep.push(1);\n\tvis[0] = 1;\n\tint CircleBegin(-1);\n\twhile (!stk.empty() && CircleBegin == -1)\n\t{\n\t\tint depth(dep.top());\n\t\tint NextEdge(edge_rank.top());\n\t\twhile (NextEdge)\n\t\t{\n\t\t\tif (vis[all[NextEdge].to] == 0)//\u5982\u679c\u8fd9\u4e2a\u70b9\u672a\u8bbf\u95ee\n\t\t\t{\n\t\t\t\tvis[all[NextEdge].to] = depth + 1;//\u5f00\u59cb\u51c6\u5907\u6df1\u641c\n\t\t\t\tedge_rank.pop();\n\t\t\t\tedge_rank.push(all[NextEdge].next);\n\t\t\t\tstk.push(all[NextEdge].to);\n\t\t\t\tedge_rank.push(iHead[all[NextEdge].to]);\n\t\t\t\tdep.push(depth + 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse if (vis[all[NextEdge].to] != depth - 1)//\u5426\u5219\uff0c\u5982\u679c\u8fd9\u4e2a\u70b9\u4e0d\u662f\u6765\u5230\u5f53\u524d\u70b9\u65f6\u7ecf\u8fc7\u7684\u70b9\n\t\t\t{\n\t\t\t\tCircleBegin = all[NextEdge].to;//\u627e\u5230\u73af\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tNextEdge = all[NextEdge].next;\n\t\t}\n\t\tif (NextEdge == 0)//\u8fd9\u4e2a\u70b9\u7684\u6240\u6709\u8fb9\u90fd\u904d\u5386\u4e86\uff0c\u5374\u672a\u627e\u5230\u73af\uff0c\u9000\u6808\n\t\t{\n\t\t\tstk.pop();\n\t\t\tedge_rank.pop();\n\t\t\tdep.pop();\n\t\t}\n\t}\n\twhile (!stk.empty())\n\t{\n\t\tbInCircle[stk.top()] = true;//\u6808\u5185\u76f4\u5230CircleBegin\u90fd\u662f\u73af\u5185\u5143\u7d20\n\t\tcircle[iEndCir++] = stk.top();\n\t\tif (stk.top() == CircleBegin) break;\n\t\tstk.pop();\n\t}\n\tCLEAR_STACK(stk);//\u6e05\u7a7a\u6808\n\tCLEAR_STACK(edge_rank);\n\tCLEAR_STACK(dep);\n}\n\n```\n\n\u663e\u7136\uff0c\u8fd9\u4e48\u505a\u5982\u679c\u5b58\u5728\u4e8c\u5143\u73af\u662f\u8981WA\u8d77\u98de\u7684\u3002\u3010\u4e0d\u8fc7\u5e76\u6ca1\u6709\u3011\n\n\n\u7136\u540e\u5230\u4e86\u7cbe\u5f69\u7684dp\u73af\u8282\u3002\n\n\u3010\u53ef\u662f\u6211\u5df2\u7ecf\u4e0d\u60f3\u8bf4\u4e86orz\u5199\u4e86\u597d\u957f\u7684\u9898\u89e3\u3002\u3011\n\n\u6709\u4e24\u4e2adp\uff1a\u6811\u4e0a\u7684\u548c\u73af\u4e0a\u7684\uff0c\u663e\u7136\u8fd9\u4e24\u4e2adp\u662f\u72ec\u7acb\u7684\u3002\n\n\u6811\u4e0a\u7684\u7b80\u5355\uff1a\u5b9a\u4e49val[x][0]\u8868\u793ax\u53cax\u7684\u5b50\u6811\u4e2d\uff0c\u4e0d\u9009x\u7684\u6700\u5927\u503c\uff08\u5148\u4e0d\u4e58\u4ee5k\uff09\n\u5b9a\u4e49val[x][1]\u8868\u793ax\u53cax\u7684\u5b50\u6811\u4e2d\uff0c\u9009\u62e9x\u7684\u6700\u5927\u503c\u3002\n\n\u7136\u540edfs\u5904\u7406\u4e00\u4e0b\u5c31\u597d\u4e86\uff08\uff1f\uff1f\uff1f\u4e3a\u4ec0\u4e48\u8fd9\u91ccdfs\u6211\u5c31\u4e0d\u6015\u6808\u5d29\u6e83\u5462\uff1f\uff1f\uff1f\uff09\n\n\n\u7136\u540e\u662f\u73af\u4e0a\u7684\u3002\n\n\u5b9a\u4e49\u72b6\u6001\u4e3adp[x][y][z]\uff0c\u5176\u4e2dx\u4e3a\u73af\u4e0a\u8282\u70b9\u7684\u72ec\u7acb\u7f16\u53f7\uff080-iEndCir-1\uff09\uff0cy\u4e3a\u662f\u5426\u9009\u62e9\u7b2c\u4e00\u4e2a\u70b9\uff0cz\u4e3a\u662f\u5426\u9009\u62e9\u5f53\u524d\u70b9\n\n\u5bf9\u4e8ex=0,1,iEndCir-1\uff0c\u90fd\u662f\u9700\u8981\u7279\u6b8a\u5904\u7406\u7684\u2026\u20260\u5927\u5bb6\u90fd\u61c2\uff1b1\u662f\u56e0\u4e3a\u4ed6\u524d\u9762\u7684\u5c31\u662f0\uff0c\u800cy\u5c31\u662f\u5173\u4e8e0\u53f7\u70b9\u7684\u72b6\u6001\uff1biEndCir-1\u5219\u662f\u56e0\u4e3a\u5b83\u4e0e0\u76f8\u90bb\n\n\u600e\u4e48dp\u561b\u2026\u2026\u7559\u7ed9\u8bfb\u8005\u601d\u8003~~\u3010\u5176\u5b9e\u662f\u6211\u592a\u61d2\u4e0d\u60f3\u5199\u4e86\uff0c\u800c\u4e14\u72b6\u6001\u4e5f\u633a\u6e05\u695a\u7684...\u5427\u3011~~\n\n```cpp\n\n#include <cstdio>\n#include <cstdlib>\n\n#include <stack>\n\n#define CLEAR_STACK(x) {while (!x.empty()) x.pop();}\n\n#define FOR_EDGE(i, pt) for (int i(iHead[pt]); i; i = all[i].next)\n\n\nclass edge\n{\npublic:\n\tint to, next;\n}all[212345];\n\nint iHead[112345];\n\nint iEnd(2);\nvoid add(int fr, int to)\n{\n\tall[iEnd].to = to;\n\tall[iEnd].next = iHead[fr];\n\tiHead[fr] = iEnd++;\n}\n\nint p[112345];\n\nint circle[112345];\nint iEndCir;\n\nint from[112345];\nint vis[112345];\nbool bInCircle[112345];\n\nstd::stack<int> stk, edge_rank, dep;\n\nvoid dfs()\n{\n\tstk.push(0);\n\tedge_rank.push(iHead[0]);\n\tdep.push(1);\n\tvis[0] = 1;\n\tint CircleBegin(-1);\n\twhile (!stk.empty() && CircleBegin == -1)\n\t{\n\t\tint depth(dep.top());\n\t\tint NextEdge(edge_rank.top());\n\t\twhile (NextEdge)\n\t\t{\n\t\t\tif (vis[all[NextEdge].to] == 0)\n\t\t\t{\n\t\t\t\tvis[all[NextEdge].to] = depth + 1;\n\t\t\t\tedge_rank.pop();\n\t\t\t\tedge_rank.push(all[NextEdge].next);\n\t\t\t\tstk.push(all[NextEdge].to);\n\t\t\t\tedge_rank.push(iHead[all[NextEdge].to]);\n\t\t\t\tdep.push(depth + 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse if (vis[all[NextEdge].to] != depth - 1)\n\t\t\t{\n\t\t\t\tCircleBegin = all[NextEdge].to;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tNextEdge = all[NextEdge].next;\n\t\t}\n\t\tif (NextEdge == 0)\n\t\t{\n\t\t\tstk.pop();\n\t\t\tedge_rank.pop();\n\t\t\tdep.pop();\n\t\t}\n\t}\n\twhile (!stk.empty())\n\t{\n\t\tbInCircle[stk.top()] = true;\n\t\tcircle[iEndCir++] = stk.top();\n\t\tif (stk.top() == CircleBegin) break;\n\t\tstk.pop();\n\t}\n\tCLEAR_STACK(stk);\n\tCLEAR_STACK(edge_rank);\n\tCLEAR_STACK(dep);\n}\n\nint val[112345][2];\nbool bVis[112345];\n\ninline int max(const int& a, const int& b) { return a > b ? a : b; }\ninline void GetMax(int& a, int b) { if (b > a) a = b; }\n\nvoid dfs(int now)\n{\n\tbVis[now] = true;\n\tval[now][1] = p[now];\n\tFOR_EDGE (i, now)\n\t{\n\t\tif (bVis[all[i].to] || bInCircle[all[i].to]) continue;\n\t\tdfs(all[i].to);\n\t\tval[now][0] += max(val[all[i].to][0], val[all[i].to][1]);\n\t\tval[now][1] += val[all[i].to][0];\n\t}\n}\n\nint dp[112345][2][2];\n\nint solve()\n{\n\tfor (int i(0); i != iEndCir; ++i) dfs(circle[i]);\n\tdp[0][0][0] = val[circle[0]][0];\n\tdp[0][1][1] = val[circle[0]][1];\n\tdp[1][0][0] = dp[0][0][0] + val[circle[1]][0];\n\tdp[1][1][0] = dp[0][1][1] + val[circle[1]][0];\n\tdp[1][0][1] = dp[0][0][0] + val[circle[1]][1];\n\tdp[1][1][1] = -21234567;\n\tint last(iEndCir - 1);\n\tfor (int i(2); i != last; ++i)\n\t{\n\t\tdp[i][0][0] = val[circle[i]][0] + max(dp[i - 1][0][0], dp[i - 1][0][1]);\n\t\tdp[i][0][1] = val[circle[i]][1] + dp[i - 1][0][0];\n\t\tdp[i][1][0] = val[circle[i]][0] + max(dp[i - 1][1][0], dp[i - 1][1][1]);\n\t\tdp[i][1][1] = val[circle[i]][1] + dp[i - 1][1][0];\n\t}\n\tint ret(0);\n\tfor (int i(0); i != (1 << 3); ++i)\n\t{\n\t\tint a(i & 1), b((i & 2) >> 1), c((i & 4) >> 2);\n\t\tif (!a || !b && !c)\n\t\t{\n\t\t\tGetMax(ret, dp[last - 1][b][c] + val[circle[last]][a]);\n\t\t}\n\t}\n\treturn ret;\n}\n\nint n;\n\nint main()\n{\n\tscanf(\"%d\", &n);\n\tfor (int i(0); i != n; ++i) scanf(\"%d\", &p[i]);\n\tdouble k;\n\tfor (int i(0); i != n; ++i)\n\t{\n\t\tint fr, to;\n\t\tscanf(\"%d%d\", &fr, &to);\n\t\tadd(fr, to);\n\t\tadd(to, fr);\n\t}\n\tscanf(\"%lf\", &k);\n\tdfs();\n\tint x = solve();\n\tprintf(\"%.1lf\\n\", double(x) * k);\n\treturn 0;\n}\n\n```",
        "postTime": 1526978017,
        "uid": 33173,
        "name": "_J_C_",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1453 \u3010\u57ce\u5e02\u73af\u8def\u3011"
    },
    {
        "content": "\u7531\u4e8e\u9898\u76ee\u4e0a\u8bf4\u7684\u5f88\u6e05\u695a\uff0c\u53ea\u6709\u4e00\u4e2a\u73af\uff0c\u5176\u4f59\u7684\u5168\u662f\u8fde\u5728\u73af\u4e0a\u7684\u94fe\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u627e\u5230\u90a3\u4e2a\u73af\uff0c\u7136\u540e\u62c6\u73af\u6210\u6811\uff0c\u5e76\u5206\u522b\u4ee5\u62c6\u6389\u7684\u90a3\u6761\u8fb9\u7684\u4e24\u7aef\u4e3a\u6839\u8dd1\u6811\u5f62dp\uff0c\n\n\u6700\u540e\u53d6max(dp[x1][0],dp[x2][0])\u5c31\u884c\u4e86\n\ndp\u8f6c\u79fb\u65b9\u7a0b\u4e3a dp[x][1]+=max(dp[e[i].to][0],dp[e[i].to][1]);dp[x][0]+=dp[e[i].to][0];\n\n\u4ee5\u4e0b\u662f\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<cmath>\nusing namespace std;\nconst int maxn=1000000+10;\nstruct nod\n{\n    int next,to,w;\n}e[maxn];\nint head[maxn],s[maxn];\nint n,m,flag=0,E,x1,x2,k=1;\nbool vis[maxn];\ndouble dp[maxn][2];\ndouble l;\nvoid adde(int u,int v)\n{\n    e[++k].next=head[u];\n    e[k].to=v;head[u]=k;\n}\nvoid find(int x,int f)\n{\n    vis[x]=true;\n    for(int i=head[x];i;i=e[i].next)\n    {//printf(\"%d \",i);\n        if(e[i].to==f) continue;\n        if(flag==1) return;\n        if(vis[e[i].to])\n        {\n            flag=1;\n            E=i;x1=x;x2=e[i].to;return;\n        }\n        find(e[i].to,x);\n    }\n}\nvoid dfs(int x,int f)\n{\n    dp[x][1]=s[x]*1.0*l;dp[x][0]=0;//printf(\"%d \",x);\n    for(int i=head[x];i;i=e[i].next)\n    {\n        if(e[i].to==f || i==E || (i^1)==E) continue;\n        dfs(e[i].to,x);\n        dp[x][0]+=max(dp[e[i].to][0],dp[e[i].to][1]);\n        dp[x][1]+=dp[e[i].to][0];\n    }\n}\nint main()\n{\n    scanf(\"%d\",&n);\n    for(int i=0;i<n;i++) scanf(\"%d\",&s[i]);\n    for(int i=1;i<=n;i++)\n    {\n        int u,v;\n        scanf(\"%d%d\",&u,&v);adde(u,v);adde(v,u);\n    }scanf(\"%lf\",&l);\n    find(1,1);\n    dfs(x1,x1);double ss=dp[x1][0];\n    dfs(x2,x2);double tt=dp[x2][0];\n    printf(\"%.1f\\n\",max(ss,tt));\n}\n```",
        "postTime": 1504255422,
        "uid": 25365,
        "name": "zhouenji",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1453 \u3010\u57ce\u5e02\u73af\u8def\u3011"
    }
]
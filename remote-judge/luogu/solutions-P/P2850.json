[
    {
        "content": "\u8fd9\u9898\u5c45\u7136\u6ca1\u6709\u7528 $Floyd$ \u5224\u8d1f\u73af\u7684\u9898\u89e3...\n\n(\u5361\u5e38\u6781\u4e3a\u75db\u82e6\uff0c\u8bf7\u5f00 $O2$ \u4f18\u5316)\n\n\u56e0\u4e3a\u4ee3\u7801\u6781\u7b80\u5355\uff0c\u76f4\u63a5\u770b\u5427\u3002\n\n```cpp\n#include <algorithm>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\nusing namespace std;\nconst int INF = 0x3f3f3f3f;\nint T, n, m, W, dis[505][505];\ninline int read()\n{\n\tregister int x = 0;\n\tchar c = getchar();\n\twhile (c < '0' || c > '9')\n\t\tc = getchar();\n\twhile (c >= '0' && c <= '9')\n\t{\n\t\tx = (x << 3) + (x << 1) + c - '0';\n\t\tc = getchar();\n\t}\n\treturn x;\n}\nbool check()\n{\n\tfor (register int k = 1; k <= n; k++)\n\t\tfor (register int i = 1; i <= n; i++)\n\t\t{\n\t\t\tfor (register int j = 1; j <= n; j++)\n\t\t\t{\n\t\t\t\tint res = dis[i][k] + dis[k][j];\n\t\t\t\tif (dis[i][j] > res)\n\t\t\t\t\tdis[i][j] = res;\n\t\t\t}\n\t\t\tif (dis[i][i] < 0)\n\t\t\t\treturn 1;\n\t\t}\n\treturn 0;\n}\nint main()\n{\n\tT = read();\n\twhile (T--)\n\t{\n\t\tn = read(), m = read(), W = read();\n\t\tfor (register int i = 1; i <= n; i++)\n\t\t\tfor (register int j = 1; j <= n; j++)\n\t\t\t\tdis[i][j] = INF;\n\t\tfor (int i = 1; i <= m; i++)\n\t\t{\n\t\t\tint u = read(), v = read(), w = read();\n\t\t\tif (dis[u][v] > w)\n\t\t\t\tdis[u][v] = dis[v][u] = w;\n\t\t}\n\t\tfor (int i = 1; i <= W; i++)\n\t\t{\n\t\t\tint u = read(), v = read(), w = read();\n\t\t\tdis[u][v] = -w;\n\t\t}\n\t\tif (check())\n\t\t\tprintf(\"YES\\n\");\n\t\telse\n\t\t\tprintf(\"NO\\n\");\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1538051850,
        "uid": 54877,
        "name": "Drifting",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "SPFA\u5224\u65ad\u8d1f\u73af\n\n\u697c\u4e0b\u6709\u4eba\u8bf4\u7528SPFA\u65e0\u4e00\u4f8b\u5916\u90fd\u662f\u9519\u7684\u3002\n\n\u56e0\u4e3a\u6ca1\u6709\u7ed9\u51fa\u539f\u70b9\u3002\u3002\u3002\u3002\u3002\n\n\u4f46\u662f\u5728\u4e0b\u8ba4\u4e3a\u8fd9\u9898\u7528SPFA\u4e00\u70b9\u9519\u4e5f\u6ca1\u6709\n\n\u539f\u70b9\u6839\u672c\u4e0d\u7528\uff0c\u5b58\u5728\u8d1f\u73af\u7684\u8bdd\u4e0d\u8bba\u539f\u70b9\u53d6\u54ea\u4e2a\u70b9\uff0c\u90fd\u662f\u53ef\u4ee5\u7684\u3002\n\n\u4ece\u968f\u4fbf\u4e00\u4e2a\u70b9\u51fa\u53d1\uff0c\u5f53\u67d0\u4e2a\u70b9\u677e\u5f1b\u4e86\u8d85\u8fc7n\u6b21\u540e\uff0c\u4fbf\u53ef\u4ee5\u8bf4\u660e\u6709\u8d1f\u73af\u3002\n\n\u4e3a\u4e86\u8ba9\u8fd9\u4e2a\u9898\u89e3\u6709\u4ef7\u503c\uff0c\u6211\u5728\u8fd9\u91cc\u7ed9\u51fa\u8bc1\u660e\uff08\u5f88\u591a\u4eba\u77e5\u9053\u67d0\u4e2a\u70b9\u677e\u5f1b\u4e86\u8d85\u8fc7n\u6b21\u540e\uff0c\u4fbf\u53ef\u4ee5\u8bf4\u660e\u6709\u8d1f\u73af\uff0c\u4f46\u662f\u90fd\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\uff09\n\n{\n\u8bc1\u660e\uff1a\u5728\u6392\u9664\u91cd\u8fb9\uff08\u82e5\u4e24\u70b9\u95f4\u6709\u591a\u6761\u901a\u8def\uff0c\u5219\u53ea\u4fdd\u7559\u6700\u4f18\u7684\u4e00\u6761\uff09\u540e\uff0c\u6bcf\u4e2a\u70b9\u6700\u591a\u6709n-1\u6761\u8fb9\u4e0e\u4e4b\u76f8\u8fde\uff08\u4e00\u5171n\u4e2a\u70b9\uff09\n\n\u6240\u4ee5\u5373\u4f7f\u8fd9n-1\u6761\u8fb9\u6bcf\u6761\u8fb9\u90fd\u53ef\u4ee5\u8fdb\u884c\u4e00\u6b21\u677e\u5f1b\uff0c\u4e00\u5171\u70b9\u4e5f\u6700\u591a\u8fdb\u961fn\u6b21\uff08\u52a0\u4e0a\u672c\u6765\u7684\u4e00\u6b21\uff09\n\n\u6240\u4ee5\u5f53\u4e00\u4e2a\u70b9\u8fdb\u961f\u4e86n+1\u6b21\u4e4b\u540e\uff0c\u53ea\u80fd\u8bc1\u660e\u5b58\u5728\u8d1f\u73af\uff08\u5c31\u662f\u6709\u4e00\u6761\u8fb9\u53ef\u4ee5\u91cd\u590d\u7528\u6765\u677e\u5f1b\uff0c\u8fd9\u5c31\u662f\u8d1f\u73af\uff08\u56e0\u4e3a\u6240\u6709\u7684\u6b63\u6743\u8fb9\u6700\u591a\u53ea\u80fd\u7528\u6765\u677e\u5f1b\u4e00\u6b21\uff0c\u53ea\u6709\u5f88\u5927\u7684\u8d1f\u503c\u53ef\u4ee5\u91cd\u590d\u4f18\u4e8e\u81ea\u8eab\uff09\uff09\u3002\n\n}\n\u597d\u5566\uff0c\u4e0b\u9762\u662f\u4ee3\u7801\uff0c\u5f88\u901a\u4fd7\u6613\u61c2\uff0c\u6ca1\u6709\u4efb\u4f55\u9ad8\u7aef\u8bed\u6cd5\u3002\n\n\u4e13\u4e3a\u65b0\u4eba\u63d0\u4f9b\uff0c\u554a\u54c8\u54c8\u54c8\u54c8\uff0c\u5c31\u662f\u6709\u70b9\u591a\u3002\n\n\u9759\u4e0b\u5fc3\u6765\u6162\u6162\u770b\uff0c\u4f60\u4f1a\u61c2\u7684\u3002\n\n```cpp\n#include\"bits/stdc++.h\"\nusing namespace std;\nstruct EDGE\n       {\n           int next;\n           int to;\n           int cs;\n       }e[99999];\nint head[99999];\nint num=1;\nint d[100000];\nint q[999999];\nint vis[999999];\nint mvp[999999];\nint f;\nint n,m,w;\nint s,e1,t;\nvoid add(int x,int y,int cs)\n{\n    e[num].next=head[x];\n    e[num].to=y;\n    e[num].cs=cs;\n    head[x]=num;\n    num++;\n}\nint spfa(int st)\n{\n    d[st]=0;\n    int h=1,en=2;\n    q[h]=st;vis[st]=1;\n    mvp[st]++;\n    while(h<=en)\n    {\n        int v=q[h];vis[v]=0;\n        for(int i=head[v];i!=-1;i=e[i].next)\n        {\n            if(d[e[i].to]>d[v]+e[i].cs)\n            {\n                d[e[i].to]=d[v]+e[i].cs;\n                if(vis[e[i].to]==0)\n                {\n                    q[en]=e[i].to;\n                    en++;\n                    mvp[e[i].to]++;\n                    vis[e[i].to]=1;\n                }\n                if(mvp[e[i].to]>n)return 1;\n            }\n        }h++;\n    }\n    return 0;\n}\nint main()\n{\n    cin>>f;\n    for(int i=1;i<=f;i++)\n    {\n        memset(head,-1,sizeof(head));\n        memset(e,0,sizeof(e));\n        memset(mvp,0,sizeof(mvp));\n        memset(q,0,sizeof(q));\n        memset(vis,0,sizeof(vis));\n        num=1;\n        for(int j=1;j<=99999;j++)d[j]=1e9;\n        cin>>n>>m>>w;\n        for(int j=1;j<=m;j++)\n        {\n            cin>>s>>e1>>t;\n            add(s,e1,t);\n            add(e1,s,t);\n        }\n        for(int j=1;j<=w;j++)\n        {\n            cin>>s>>e1>>t;\n            t=t*-1;\n            add(s,e1,t);\n        }\n        if(spfa(1)==1)cout<<\"YES\"<<endl;\n        else cout<<\"NO\"<<endl;\n    }\n}\n\n```",
        "postTime": 1504875366,
        "uid": 29445,
        "name": "\u6211\u8981\u4e0a\u5929",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "C++\u7684dfs\u7248spfa\n\n\u7528dfs\u7684spfa\u5224\u8d1f\u73af\u7684\u4f18\u8d8a\u6027\uff0c\u697c\u4e0bpascal\u5927\u4f6c\u5df2\u7ecf\u8bb2\u5f97\u5f88\u6e05\u695a\u4e86\uff0c\u8fd9\u9898dfs\u5feb\u7684\u98de\u8d77\uff0c2ms\u5c31\u8fc7\u4e86\n\nAC\u4e86\u8fd9\u9898\u7684\u540c\u5b66\u53ef\u4ee5\u53bb\u8bd5\u7740\u505a\u8d1f\u73af\u6a21\u677f\u7ec3\u7ec3\u624b\uff0c\u90a3\u9898\u6570\u636e\u8303\u56f4\u5927\u5f88\u591a\uff0cbfs\u662f\u8fc7\u4e0d\u4e86\u7684\n\n\u4e0a\u4ee3\u7801\uff0c\u6ce8\u91ca\u5728\u4ee3\u7801\u91cc\n\n```cpp\n#include<cstdio>\n#include<vector>\n#include<cstring>\n#define N 505\n#define For(i,j,k) for(int i=j;i<=k;i++)\nusing namespace std;\nint read(){//\u5feb\u8bfb\n    int l=1,x=0; char ch=getchar();\n    while((ch<'0'||ch>'9')&&ch!='-') ch=getchar();\n    if (ch=='-') ch=getchar(),l=-1;\n    while(ch>='0'&&ch<='9') x=(x<<1)+(x<<3)+(ch^48),ch=getchar();\n    return x*l;\n}\nstruct node{int dis,nex;}f;\nvector<node> mp[N]; //vector\u5b58\u56fe\uff0c\u4e0b\u6807\u662f\u8fb9\u7684\u8d77\u59cb\u70b9\uff0cdis\u8fb9\u6743\uff0cnex\u662f\u8fb9\u7684\u7ec8\u70b9(\u849f\u84bb\u4e0d\u4f1a\u94fe\u5f0f\u524d\u5411\u661f5555)\nint sum[N],fl[N]={0},flag;\nvoid spfa(int k){ //dfs\u7684spfa\n    if (fl[k]==1) {fl[k]=0; flag=1; return;} //\u53ea\u8981\u4e00\u4e2a\u70b9\u7b2c\u4e8c\u6b21\u8d70\u5230\u5c31\u8bf4\u660e\u6709\u8d1f\u73af\u4e86\uff0c\u6807\u8bb0\u9000\u51fa\n    fl[k]=1; //\u6807\u8bb0\u8fd9\u4e2a\u70b9\u8d70\u8fc7\u4e86\n    if (!mp[k].empty())\n        For(i,0,mp[k].size()-1)\n            if (sum[mp[k][i].nex]>mp[k][i].dis+sum[k]){\n                sum[mp[k][i].nex]=mp[k][i].dis+sum[k];\n                spfa(mp[k][i].nex); if (flag==1) {fl[k]=0; return;} //\u6709\u8d1f\u73af\u5c31\u4e00\u5c42\u5c42\u9000\uff0c\u6ce8\u610f\u6e05\u7a7a\u6570\u7ec4\u6807\u8bb0\n            }\n    fl[k]=0; //\u53d6\u6d88\u8fd9\u4e2a\u70b9\u7684\u6807\u8bb0\n}\nint main(){\n    int _=read(),m,n=0,w,x,y,z,k;\n    while(_--){\n        For(i,1,n) mp[i].clear(); //\u6e05\u7a7avector\n        n=read(),m=read(),k=read();\n        For(i,1,m){ //\u5b58\u6b63\u8fb9\uff0c\u65e0\u5411\u8fb9\u8981\u5b582\u6b21\n            x=read(),y=read(),z=read();\n            f.dis=z; f.nex=y; mp[x].push_back(f);\n            f.nex=x; mp[y].push_back(f);\n        }\n        For(i,1,k){ //\u5b58\u8d1f\u8fb9\uff0c\u6ce8\u610f\u8fb9\u6743\u53d6\u8d1f\n            x=read(),y=read(),z=read();\n            f.dis=-z; f.nex=y; mp[x].push_back(f);\n        }\n        memset(sum,0,sizeof(sum)); //\u591a\u7ec4\u6570\u636e\uff0c\u6e05\u7a7a\u6700\u77ed\u8def\u6570\u7ec4\n        flag=0;\n        For(i,1,n) {spfa(i); if (flag) break;} //\u6ca1\u6709\u539f\u70b9\uff0c\u6240\u4ee5\u6bcf\u4e2a\u70b9\u5f53\u8d77\u59cb\u70b9\u627e\u4e00\u904d\uff0c\u627e\u5230\u4e00\u4e2a\u8d1f\u73af\u5c31\u9000\u51fa\n        if (flag==1) printf(\"YES\\n\"); else printf(\"NO\\n\");\n    }\n    return 0;\n}\n```",
        "postTime": 1499429622,
        "uid": 20821,
        "name": "wjy666",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011\n\n\u6b64\u9898\u5c31\u662f\u6c42\u4e00\u4e2a\u56fe\u6709\u6ca1\u6709\u8d1f\u6743\u56de\u8def\u3002\n\n\u866b\u6d1e\u5c31\u662f\u8fb9\u6743\u4e3a\u8d1f\u7684\u8fb9\u3002\n\n\u7528spfa\u5224\u8d1f\u6743\u56de\u8def\uff1a\u5982\u679c\u4efb\u610f\u4e00\u6761\u8fb9\u88ab\u4fee\u6539\u5927\u4e8en-1\u6b21\uff0c\u5c31\u4ee3\u8868\u8fd9\u4e2a\u56fe\u5185\u4e00\u5b9a\u5b58\u5728\u81f3\u5c11\u4e00\u4e2a\u8d1f\u6743\u56de\u8def\u3002\n\n\u6ce8\u610f\uff1a\n\n1.\u6bcf\u6b21\u8981\u9644\u521d\u503c\n\n2.map\u6709\u53ef\u80fd\u8d85\u65f6\uff0c\u8981\u4f18\u5316\uff01\uff08\u5f53\u7136\u53ef\u4ee5\u7528\u5176\u4ed6\u65b9\u5f0f\uff09\n\n3.\u866b\u6d1e\u4e0d\u662f\u53cc\u5411\u8fb9\uff0c\u4f46\u5c0f\u8def\u662f\uff01\n```\n#include<stdio.h>\n#include<queue>\n#define maxn 501\n#define min(a,b) (a<b?a:b)\n#define I inline\n#define R register\n#define inf 0x7fffff\nusing namespace std;\nint n,m,x,y,z,w,F;\nqueue<int> q;\nint dis[maxn],cnt[maxn],map[maxn][maxn];\nbool f[maxn];\nI int spfa(int s)\n{\n\tfor(R int i=1; i<=n; i++)\n\t{\n\t\tdis[i]=inf;\n\t\tcnt[i]=0;\n\t}\n\tq.push(s);\n\tf[s]=true;\n\tdis[s]=0;\n\twhile(q.size())\n\t{\n\t\tint x=q.front();\n\t\tq.pop();\n\t\tf[x]=false;\n\t\tfor(R int i=1; i<=n; i++)\n\t\t{\n\t\t\tif(dis[x]+map[x][i]<dis[i])\n\t\t\t{\n\t\t\t\tdis[i]=dis[x]+map[x][i];\n\t\t\t\tif(!f[i])\n\t\t\t\t{\n\t\t\t\t\tq.push(i);\n\t\t\t\t\tcnt[i]++;\n\t\t\t\t\tif(cnt[i]==n)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\t}\n\t\t\t\t\tf[i]=true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dis[1]<0)\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\nint main()\n{\n\tscanf(\"%d\",&F);\n\tfor(R int t=1; t<=F; t++)\n\t{\n\t\tscanf(\"%d%d%d\",&n,&m,&w);\n\t\tfor(R int i=1; i<=n; i++)\n\t\t{\n\t\t\tfor(R int j=1; j<=n; j++)\n\t\t\t{\n\t\t\t\tmap[i][j]=inf;\n\t\t\t}\n\t\t}\n\t\tfor(R int i=1; i<=m; i++)\n\t\t{\n\t\t\tscanf(\"%d%d%d\",&x,&y,&z);\n\t\t\tmap[x][y]=min(z,map[x][y]);\n\t\t\tmap[y][x]=map[x][y];\n\t\t}\n\t\tfor(R int i=1; i<=w; i++)\n\t\t{\n\t\t\tscanf(\"%d%d%d\",&x,&y,&z);\n\t\t\tmap[x][y]=min(-z,map[x][y]);\n\t\t}\n\t\tif(spfa(1))\n\t\t{\n\t\t\tprintf(\"YES\\n\");\n\t\t\tcontinue;\n\t\t}\n\t\tprintf(\"NO\\n\");\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1561540301,
        "uid": 164437,
        "name": "yeaDonaby",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "\u5982\u679c\u6211\u4eec\u628a\u6bcf\u4e00\u6761\u8def\u6743\u503c\u770b\u6210\u901a\u8fc7\u6240\u7528\u7684\u65f6\u95f4\u7684\u8bdd\uff0c\u90a3\u4e48\u6211\u4eec\u4fbf\u53ef\u4ee5\u628a\u866b\u6d1e\u7684\u65f6\u95f4\u770b\u6210\u8d1f\u6743\u8fb9\uff0c\u8fd9\u6837\u7684\u8bdd**\u5982\u679c\u4ece\u4e00\u4e2a\u70b9\u51fa\u53d1\u56de\u5230\u8fd9\u4e2a\u70b9\u6240\u82b1\u7684\u65f6\u95f4\u5c0f\u4e8e0\uff0c\u5219\u8bf4\u660e\u866b\u6d1e\u8d77\u4e86\u4f5c\u7528\u56de\u5230\u4e86\u51fa\u53d1\u65f6\u95f4\u4e4b\u524d**\u3002\n\n\u5bf9\u4e8e\u8fd9\u4e2a\u7406\u89e3\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u6210\u8d1f\u6743\u73af\uff0c\u5982\u679c\u6211\u4eec\u679a\u4e3e\u6bcf\u4e00\u4e2a\u70b9\u8fdb\u884c\u5bfb\u627e\u662f\u5426\u5b58\u5728\u8d1f\u6743\u73af\u7684\u8bdd\u53ef\u80fd\u8fd9\u9053\u9898\u80fd\u8fc7\uff0c\u4f46\u662f\u5982\u679c\u6570\u636e\u8303\u56f4\u66f4\u5927\u4e00\u70b9\u53ef\u80fd\u5c31\u4f1aTLE\u4e86\u3002\n\n\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u53ef\u4ee5\u91c7\u7528**\u8d85\u7ea7\u6e90\u70b9**\u7684\u65b9\u6cd5\u8fdb\u884c\u89e3\u51b3\uff1a\n\n\u8be6\u60c5\u8bf7\u770b\uff1a[\u8d85\u7ea7\u6e90\u70b9\u548c\u8d85\u7ea7\u6c47\u70b9\u7684\u5efa\u7acb](https://blog.csdn.net/qq_40772692/article/details/83090675)\n\n**<1>\u540c\u65f6\u6709\u591a\u4e2a\u6e90\u70b9\u548c\u591a\u4e2a\u6c47\u70b9\uff0c\u5efa\u7acb\u8d85\u7ea7\u6e90\u70b9\u548c\u8d85\u7ea7\u6c47\u70b9**\n\n**<2>\u540c\u65f6\u6709\u591a\u4e2a\u6e90\u70b9\u548c\u4e00\u4e2a\u6c47\u70b9\uff0c\u5efa\u7acb\u8d85\u7ea7\u6e90\u70b9**\n\n**<3>\u540c\u65f6\u6709\u591a\u4e2a\u6c47\u70b9\u548c\u4e00\u4e2a\u6e90\u70b9\uff0c\u5efa\u7acb\u8d85\u7ea7\u6c47\u70b9**\n\n\n\u90a3\u4e48\u6211\u4eec\u8fd9\u91cc\u662f\u8981\u4ece\u591a\u4e2a\u5730\u65b9\u8fdb\u884c\u5bfb\u627e\u662f\u5426\u5b58\u5728\u8d1f\u53d8\u6743\uff0c\u5982\u679c\u6211\u4eec\u5efa\u7acb\u4e86\u8d85\u7ea7\u6e90\u70b9\uff0c\u5c31\u53ea\u9700\u8981\u4ece\u8d85\u7ea7\u6e90\u70b9\u5f00\u59cb\u8fdb\u884c\u627e\u8d1f\u6743\u73af\uff0c**\u8fd9\u6837\u5c31\u53ef\u4ee5\u81ea\u52a8\u627e\u5230\u662f\u5426\u5b58\u5728\u8d1f\u6743\u73af\uff0c\u7701\u53bb\u4e86\u6bcf\u4e00\u4e2a\u70b9\u679a\u4e3e\u4e00\u6b21\u627e\u8d1f\u6743\u73af\u7684\u5197\u4f59\u64cd\u4f5c**\uff0c\u4e5f\u5c31\u662f<2>\u7684\u60c5\u51b5\u3002\n\n\u5bf9\u4e8e\u8d85\u7ea7\u6e90\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6e\u4e3a0\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u4e3an+1\uff0c\u518d\u5c06\u5176\u4e0e\u6240\u6709\u7684\u56fe\u4e2d\u7684\u70b9\u76f8\u8fde\uff0c\u6743\u503c\u8bbe\u4e3a0\uff08\u56e0\u4e3a\u8d85\u7ea7\u6e90\u70b9\u662f\u4e00\u4e2a\u6a21\u62df\u70b9\uff0c\u4e3a\u4e86\u65b9\u4fbf\u7701\u65f6\u95f4\uff0c**\u6240\u4ee5\u4e0d\u5b58\u5728\uff0c\u4e0d\u53ef\u5bf9\u6574\u4e2a\u56fe\u4ea7\u751f\u5f71\u54cd\uff0c\u6545\u6743\u503c\u8bbe\u4e3a0\uff09**\n\n\u63a5\u4e0b\u6765\u5c31\u662f\u5bfb\u627e\u8d1f\u6743\u73af\u7684\u64cd\u4f5c\uff0c\u5bf9\u4e8e\u8d1f\u6743\u73af\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528SPFA\u7b97\u6cd5\u8fdb\u884c\u5b9e\u73b0\uff0c\u56e0\u4e3a\u5982\u679c\u51fa\u73b0\u8d1f\u6743\u8fb9\uff0c\u5bf9\u4e8eSPFA\u7684\u601d\u60f3\uff0c\u4ed6\u4e00\u5b9a\u4f1a\u4e00\u76f4\u56f4\u7ed5\u8fd9\u6761\u8fb9\u4e0d\u65ad\u8fdb\u884c\u677e\u5f1b\uff0c\u5219\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u7279\u6027\u6765\u5224\u65ad\u8d1f\u6743\u73af\uff0c\u800c\u8fd9\u4e2a\u64cd\u4f5c\u53ef\u4ee5\u901a\u8fc7dfs\u7684SPFA\u548cbfs\u7684SPFA\u8fdb\u884c\u3002\n\n\u5982\u679c\u5bf9\u4e8e**dfs**\u7684SPFA\uff0c\u5219\u5c31\u662f\u5728SPFA\u7684\u677e\u5f1b\u64cd\u4f5c\u91cc\uff0c\n**\u5982\u679c\u65b0\u6269\u5c55\u7684\u8fd9\u4e2a\u70b9\u4e4b\u524d\u5df2\u7ecf\u6269\u5c55\u8fc7\u4e86\uff0c\u5c31\u8bf4\u660e\u4e00\u6761\u8def\u4e2d\u5b58\u5728\u4e86\u4e24\u6b21\u8fd9\u4e2a\u70b9**\n\n\u90a3\u4e48\u5c31\u8bf4\u660e\u51fa\u73b0\u4e86\u73af\u7684\u60c5\u51b5\u3002\n\n\u90e8\u5206\u4ee3\u7801\u5982\u4e0b\n\n```cpp\nvoid pd(int x)\n{\n\tif (flag)\n\treturn ;\n\tb[x]=1;\n\tint k=h[x];\n\twhile (k!=-1)\n\t{\n\t\tif (dis[a[k].to]>dis[x]+a[k].dis)\n\t\t{\n\t\t\tdis[a[k].to]=dis[x]+a[k].dis;\n\t\t\tif (b[a[k].to])\n\t\t\t{\n\t\t\t\tflag=1;  //\u6807\u8bb0\u51fa\u73b0\u8d1f\u6743\u73af\n\t\t\t\treturn ;\n\t\t\t}\n\t\t\telse\n\t\t\tpd(a[k].to);\n\t\t}\n\t\tk=a[k].next;\n\t\t}\n\tb[x]=0;\n}\n```\n\n\u5bf9\u4e8e**bfs**\u7684SPFA\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u8fd9\u4e48\u4e00\u4e2a\u601d\u60f3\uff1a\n\n\u5982\u679c\u5bf9\u4e8e\u4e00\u4e2a\u6709N\u4e2a\u70b9\u7684\u56fe\uff0c\u627e\u5230\u4e24\u4e2a\u70b9\u5b58\u5728\u6700\u77ed\u8def\uff0c**\u90a3\u4e48\u4ed6\u4eec\u7ecf\u8fc7\u7684\u70b9\u4e00\u5b9a\u5c0f\u4e8e\u7b49\u4e8en\u4e2a\u70b9\uff0c\u90a3\u4e48\u5982\u679c\u6211\u4eec\u5230\u4e86\u5f53\u524d\u8fd9\u4e2a\u70b9\u53d1\u73b0\u7ecf\u8fc7\u7684\u70b9\u5927\u4e8en\u4e2a\u4e86\uff0c\u90a3\u4e48\u5c31\u8bf4\u660e\u4e00\u5b9a\u5b58\u5728\u73af\u7684\u60c5\u51b5\u4e86**\n\n\u90e8\u5206\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\nwhile (!q.empty())\n\t\t{\n\t\t\tint x=q.front();\n\t\t\tq.pop();\n\t\t\tb[x]=0;\n\t\t\tint k=h[x];\n\t\t\twhile (k!=-1)\n\t\t\t{\n\t\t\t\tif (dis[a[k].to]>dis[x]+a[k].dis)\n\t\t\t\t{\n\t\t\t\t    dis[a[k].to]=dis[x]+a[k].dis;\n\t\t\t\t    cnt[a[k].to]=cnt[x]+1;\n\t\t\t\t    if (cnt[a[k].to]>n)\n\t\t\t\t    {\n\t\t\t\t\t\tflag=1;  //\u6807\u8bb0\u51fa\u73b0\u8d1f\u6743\u73af\n\t\t\t\t\t\treturn ;\n\t\t\t\t\t\t}\n\t\t\t\t\tif(b[a[k].to]==0)\n\t\t\t\t\t{\n\t\t\t\t\t\tb[a[k].to]=1;\n\t\t\t\t\t\tq.push(a[k].to);\n\t\t\t\t\t\t} \n\t\t\t\t\t} \n\t\t\t\t\tk=a[k].next;\n\t\t\t\t}\n\t\t\t}\n```\n\n\u672c\u9898\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <cstring>\nusing namespace std;\nstruct CZP\n{\n\tint next,to,dis;\n}a[1000001];\nint n,m,h[100001],b[100001],flag,t,top,dis[100001],w;\nvoid cun(int from,int to,int dis)\n{\n\ta[++top].next=h[from];\n\ta[top].to=to;\n\ta[top].dis=dis;\n\th[from]=top;\n}\nvoid pd(int x)\n{\n\tif (flag)\n\treturn ;\n\tb[x]=1;\n\tint k=h[x];\n\twhile (k!=-1)\n\t{\n\t\tif (dis[a[k].to]>dis[x]+a[k].dis)\n\t\t{\n\t\t\tdis[a[k].to]=dis[x]+a[k].dis;\n\t\t\tif (b[a[k].to])\n\t\t\t{\n\t\t\t\tflag=1;\n\t\t\t\treturn ;\n\t\t\t}\n\t\t\telse\n\t\t\tpd(a[k].to);\n\t\t}\n\t\tk=a[k].next;\n\t\t}\n\tb[x]=0;\n}   //\u8fd9\u91cc\u4f7f\u7528\u4e86dfs\u7684\u6c42\u8d1f\u6743\u73af\u64cd\u4f5c\nint main()\n{\n\tscanf(\"%d\",&t);\n\tfor (int k=1;k<=t;k++)\n\t{\n\t\tflag=0;\n\t    scanf(\"%d%d%d\",&n,&m,&w);\n\t\tfor (int i=0;i<=n;i++)\n\t\th[i]=-1;\n\t\tfor (int i=1;i<=m;i++)\n\t\t{\n\t\t\tint x,y,z;\n\t\t\tscanf(\"%d%d%d\",&x,&y,&z);\n\t\t\tcun(x,y,z);\n\t\t\tcun(y,x,z);\n\t\t\t}     //\u5c0f\u8def\u4e3a\u53cc\u5411\u8fb9\uff01\n\t\tfor (int i=1;i<=w;i++)\n\t\t{\n\t\t\tint x,y,z;\n\t\t\tscanf(\"%d%d%d\",&x,&y,&z);\n\t\t\tcun(x,y,-z);\n\t\t}   //\u866b\u6d1e\u6539\u4e3a\u8d1f\u6743\u503c\n\t\tmemset(b,0,sizeof(b));\n\t\tfor (int i=1;i<=n;i++)\n\t\tcun(0,i,0);  //\u5efa\u7acb\u8d85\u7ea7\u6e90\u70b90\n\t\tfor (int i=1;i<=n;i++)\n\t\tdis[i]=100000000;\n\t\tdis[0]=0;\n\t\tb[0]=1;\n\t\tpd(0);  \n\t\tif (flag==1)\n\t\tprintf(\"YES\\n\");\n\t\telse\n\t\tprintf(\"NO\\n\");\n\t}\n\treturn 0;\n}\n*/\n```\n",
        "postTime": 1572773085,
        "uid": 24812,
        "name": "Sakura_Peng",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "# [P2850 [USACO06DEC]\u866b\u6d1eWormholes](https://www.luogu.org/problemnew/show/P2850)\n\u9898\u610f\uff1a\u53ea\u8981\u80fd\u627e\u5230\u8d1f\u73af\uff0c\u5c31\u80fd\u56de\u5230\u8fc7\u53bb\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002\n\n## spfa\u5224\u65ad\u8d1f\u73af\uff1a\u5982\u679c\u4efb\u610f\u4e00\u6761\u8fb9\u88ab\u4fee\u6539\u5927\u4e8en\u6b21\uff0c\u5c31\u4ee3\u8868\u8fd9\u4e2a\u56fe\u5185\u4e00\u5b9a\u5b58\u5728\u81f3\u5c11\u4e00\u4e2a\u8d1f\u73af\u3002\n\n```\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<=b;i++) \n#define INF 0x3f3f3f3f\nusing namespace std;\n#define N 1000010\n \nint read()\n{\n    int x=0,f=1;char c=getchar();\n    while(c<'0'||c>'9'){if(c=='-') f=-1;c=getchar();}\n    while(c>='0'&&c<='9') {x=x*10+c-'0';c=getchar();}\n    return x*f;\n}\n\nstruct edge{\n\tint v,w,next;\n}e[N<<1];\n\nint head[N<<1],tot=0,cnt[N<<1];\nbool vis[N];\nint dis[N<<1],t,n,m,w;\n\nvoid add(int u,int v,int w)\n{\n    e[++tot].next=head[u];\n    e[tot].v=v;\n    e[tot].w=w;\n    head[u]=tot;\n}\n\nvoid clear()\n{\n    memset(head,-1,sizeof(head));\n    memset(e,0,sizeof(e));\n    memset(cnt,0,sizeof(cnt));\n    tot=0;\n\tmemset(vis,0,sizeof(vis));\n    memset(dis,INF,sizeof(dis));\n}\n\nbool spfa(int s)\n{\n    queue<int >q;\n    q.push(s);\n\tdis[s]=0;\n\tvis[s]=1;\n    while(!q.empty())\n    {\n        int u=q.front();\n\t\tq.pop();\n        vis[u]=0;\n        for(int i=head[u];~i;i=e[i].next)\n        {\n            int v=e[i].v;\n            if(dis[v]>dis[u]+e[i].w)\n            {    \n\t\t\t\tdis[v]=dis[u]+e[i].w;\n                if(!vis[v])\n                {\n                    q.push(v);\n                    vis[v]=1;\n                    cnt[v]++;//\u5224\u8d1f\u73af \n                }\n                if(cnt[v]>n) //\u677e\u5f1b\u8d85\u8fc7n\u6b21\u5c31\u8bf4\u660e\u6709\u8d1f\u73af \n\t\t\t\t\treturn true;\n            }            \n        }\n    }\n    return false;\n}\n\nint main()\n{\n\tfreopen(\"input.txt\",\"r\",stdin);\n    t=read();\n    while(t--)\n    {\n        clear();\n        n=read(),m=read(),w=read();\n        rep(i,1,m)\n        {\n        \tint x,y,z;\n        \tx=read(),y=read(),z=read();\n        \tadd(x,y,z),add(y,x,z);\n\t\t}\n\t\trep(i,1,w)\n        {\n        \tint x,y,z;\n        \tx=read(),y=read(),z=read();\n        \tadd(x,y,-z);//\u6b64\u5904\u4e0d\u80fd\u5efa\u53cc\u5411\u8fb9\n\t\t}\n        if(spfa(1)) \n\t\t\tprintf(\"YES\\n\");\n        else \n\t\t\tprintf(\"NO\\n\");\n    }\n    return 0;\n}\n```",
        "postTime": 1550370411,
        "uid": 109419,
        "name": "\u8bbe\u8ba1\u6d89\u53ca\u793e\u7a37",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850\u866b\u6d1eWormholes"
    },
    {
        "content": "\u4e00\u9053\u8d1f\u73af\u7684\u88f8\u9898, \u57fa\u4e8e$SPFA$ ~~(\u8fd9\u4e2a\u6b7b\u4e86\u7684\u7b97\u6cd5)~~,\u6211\u4eec\u6709\u4e24\u79cd\u601d\u8def\uff1a\n\n(1)\u7edf\u8ba1\u6bcf\u4e2a\u70b9\u5165\u961f\u7684\u6b21\u6570\uff0c \u5982\u679c\u67d0\u4e2a\u70b9\u5165\u961f$n$\u6b21\uff0c \u8bf4\u660e\u5b58\u5728\u8d1f\u73af\uff1b\n\n(2)\u7edf\u8ba1\u5f53\u524d\u6bcf\u4e2a\u70b9\u7684\u6700\u77ed\u8def\u4e2d\u6240\u5305\u542b\u7684\u8fb9\u6570\uff0c \u5982\u679c\u67d0\u4e2a\u70b9\u7684\u6700\u77ed\u8def\u6240\u5305\u542b\u7684\u8fb9\u6570\u5927\u4e8e\u7b49\u4e8e$n$\uff0c \u5219\u8bf4\u660e\u5b58\u5728\u8d1f\u73af\uff1b\n\n\u6211\u4f7f\u7528\u7684\u662f\u7b2c\u4e8c\u79cd\u5199\u6cd5\uff1a\n```\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <queue>\n#include <vector>\nusing namespace std;\n\nconst int N = 510;\nconst int M = 5500;\nint n, m1, m2;\nint cnt[N], vis[N], dis[N];\nstruct edge {\n\tint to, w;\n};\nvector<edge> G[M];\n\nbool spfa() {\n\tqueue<int> q;\n\tmemset(cnt, 0, sizeof cnt);\n\tmemset(vis, 0, sizeof vis);\n\tmemset(dis, 0, sizeof dis);\n\tfor(int i=1; i<=n; i++) {\n\t\tq.push(i);\n\t\tvis[i] = 1;\n\t}\n\twhile(!q.empty()) {\n\t\tint u = q.front();\n\t\tq.pop();\n\t\tvis[u] = 0;\n\t\tfor(int i=0; i<G[u].size(); i++) {\n\t\t\tint v = G[u][i].to;\n\t\t\tint w = G[u][i].w;\n\t\t\tif(dis[v] > dis[u] + w){\n\t\t\t\tdis[v] = dis[u] + w;\n\t\t\t\tcnt[v] = cnt[u] + 1;\n\t\t\t\tif(cnt[v] >= n) return true;\n\t\t\t\tif(!vis[v]) {\n\t\t\t\t\tq.push(v);\n\t\t\t\t\tvis[v] = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\nint main() {\n\tint T;\n\tscanf(\"%d\", &T);\n\twhile(T--) {\n\t\tmemset(G, 0, sizeof(G));\n\t\tscanf(\"%d %d %d\", &n, &m1, &m2);\n\t\twhile(m1--) {\n\t\t\tint u, v, w;\n\t\t\tscanf(\"%d %d %d\", &u, &v, &w);\n\t\t\tG[u].push_back((edge){v, w});\n\t\t\tG[v].push_back((edge){u, w});\n\t\t}\n\t\twhile(m2--) {\n\t\t\tint u, v, w;\n\t\t\tscanf(\"%d %d %d\", &u, &v, &w);\n\t\t\tG[u].push_back((edge){v, -w});\n\t\t}\n\t\tif(spfa()) printf(\"YES\\n\");\n\t\telse printf(\"NO\\n\");\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1574513852,
        "uid": 37090,
        "name": "ljcljc",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "spfa\u7528dfs\u4f1a\u5bf9\u4e00\u4e2a\u975e\u6700\u4f18\u7684\u72b6\u6001\u8fdb\u884c\u8f83\u591a\u7684\u65e0\u7528\u7684\u641c\u7d22\uff0c\u6240\u4ee5\u6bd4bfs\u6162\u4e00\u4e9b\u3002\n\n\u4f46\u5728\u5224\u65ad\u8d1f\u73af\u65f6\u5982\u679c\u7528bfs\u5c31\u4e0d\u77e5\u9053\u5230\u8fd9\u4e2a\u70b9\u7684\u8def\u5f84\uff0c\u6240\u4ee5\u53ea\u6709\u5165\u961f>n\u6b21\u624d\u80fd\u5224\u65ad\uff0c\u6240\u4ee5\u65f6\u95f4\u6700\u5dee\u4e3aO(n\\*m)\n\n\u800c\u7528dfs\u5c31\u53ef\u4ee5\u77e5\u9053\u8def\u5f84\uff0c\u6240\u4ee5\u4e00\u65e6\u4e00\u4e2a\u70b9\u4e24\u6b21\u51fa\u73b0\u5c31\u53ef\u5224\u65ad\uff0c\u65f6\u95f4\u4ecd\u80fd\u4fdd\u6301O(k\\*m)\u3002\n\n```cpp\nvar\n farm,n,m,w,f,o,i,num,x,y,len:longint;\n t,g:array[1..500] of longint;\n l:array[1..10000,1..3] of longint;\n ok:boolean;//1\u5219\u627e\u5230\u8d1f\u73af\u4e86\uff0c\u76f4\u63a5\u9000\u51fa\n ing:array[1..500] of boolean;\n\nprocedure jia(x,y,len:longint);//\u52a0\u4e00\u6761x->y\u7684\u8fb9\nbegin\n inc(num);\n l[num,3]:=t[x];t[x]:=num;\n l[num,1]:=y;l[num,2]:=len;\nend;\n\nprocedure spfa(x:longint);\nvar i:longint;\nbegin\n ing[x]:=true;//\u5728\u8def\u5f84\u4e0a\n i:=t[x];\n while i<>0 do\n begin\n  if g[x]+l[i,2]<g[l[i,1]] then\n  begin\n   if ing[l[i,1]] then begin ok:=true;break; end;\n\n   g[l[i,1]]:=g[x]+l[i,2];\n   spfa(l[i,1]);\n   if ok then break;\n  end;\n\n  i:=l[i,3];\n end;\n ing[x]:=false;\nend;\n\nprocedure try;\nbegin\n  readln(n,m,w);\n\n num:=0;\n for i:=1 to n do t[i]:=0;\n\n for i:=1 to m do\n begin\n  read(x,y,len);\n  jia(x,y,len);\n  jia(y,x,len);\n end;\n for i:=1 to w do\n begin\n  read(x,y,len);\n  jia(x,y,-len);\n end;\n\n for i:=1 to n do g[i]:=1<<29;ok:=false;\n\n for f:=1 to n do\n if g[f]=1<<29 then\n begin\n  g[f]:=0;\n  spfa(f);\n  if ok then exit;\n end;\n\nend;\n\nbegin \n readln(farm);\n for o:=1 to farm do\n begin\n  try;\n  if ok then writeln('YES')\n  else writeln('NO');\n end;\nend.\n\n```\n\n\u4e4b\u524da\u4e86\u540e\u624d\u53d1\u73b0\u51fa\u53d1\u70b9\u4e0d\u4e00\u5b9a\u5728\u8d1f\u73af\u4e2d\uff0c\u4e8e\u662f\u9020\u4e86\u8fd9\u4e2a\u70b9\u3002a\u4e86\u7684\u4eba\u53ef\u4ee5\u8bd5\u8bd5\u770b\uff0c\u8bf4\u4e0d\u5b9a\u4f1are\n\n1\n3 2 1\n1 2 5\n2 3 3\n3 2 4",
        "postTime": 1475312777,
        "uid": 9168,
        "name": "kczno1",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "\u4f17\u6240\u5468\u77e5\uff0c\u8fd9\u662f\u4e00\u9053\u5224\u65ad\u6709\u6ca1\u6709\u8d1f\u73af\u7684\u6a21\u677f\u9898\n\nSPFA\u5224\u8d1f\u73af\u592a\u96be\u6253\uff1f\n\nFloyd\u65f6\u95f4\u592a\u957f\uff1f\n\n\u9009\u62e9~~\u6253\u8868~~Bellman-Ford\uff0c\u7b80\u5355\u7684\u7406\u89e3\uff0c\u7b80\u5355\u7684\u4ee3\u7801\n\nSPFA\u53ea\u662f\u5728\u5b83\u7684\u57fa\u7840\u4e0a\u4fee\u6539\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<queue>\nusing namespace std;\nint F,h;\nint n,m,w;\nstruct edge{\n\tint x,y,v;\n}e[5500];\nint d[501];\nbool bellman(){\n\tmemset(d,0x3f,sizeof(d));\n\td[1]=0;\n\tfor (int i=1;i<n;i++)\n\t\tfor (int j=1;j<=h;j++)\n\t\t\tif (d[e[j].x]+e[j].v<d[e[j].y])\n\t\t\t\td[e[j].y]=d[e[j].x]+e[j].v;\n   //\u7ecf\u8fc7n-1\u6b21\u66f4\u65b0\uff0c\u6b64\u65f6\u7b54\u6848\u5e94\u4e3a\u6700\u77ed\u8def\n\tfor (int j=1;j<=h;j++)\n\t\tif (d[e[j].x]+e[j].v<d[e[j].y]) return 1;\n   //\u82e5\u8fd8\u80fd\u66f4\u65b0\uff0c\u8bf4\u660e\u5b58\u5728\u8d1f\u73af\n\treturn 0;\n}\nint main(){\n\tscanf(\"%d\",&F);\n\tfor (int i=1;i<=F;i++){\n\t\th=0;\n\t\tscanf(\"%d%d%d\",&n,&m,&w);\n\t\tfor (int i=1;i<=m;i++){\n\t\t\tint u,v,c;\n\t\t\tscanf(\"%d%d%d\",&u,&v,&c);\n\t\t\te[++h].x=u;\n\t\t\te[h].y=v;\n\t\t\te[h].v=c;\n\t\t\te[++h].x=v;\n\t\t\te[h].y=u;\n\t\t\te[h].v=c;\n\t\t}\n\t\tfor (int i=1;i<=w;i++){\n\t\t\tint u,v,c;\n\t\t\tscanf(\"%d%d%d\",&u,&v,&c);\n\t\t\te[++h].x=u;\n\t\t\te[h].y=v;\n\t\t\te[h].v=-c;\n\t\t}\n\t\tif (bellman()) printf(\"YES\\n\");\n\t\telse printf(\"NO\\n\");\n\t}\n}\n```\n",
        "postTime": 1565244637,
        "uid": 94018,
        "name": "\u52a8\u6001WA",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "\u5b58\u5728\u8d1f\u73af\u65f6\u5c31\u662f\u53ef\u4ee5\u56de\u5230\u8fc7\u53bb\u7684\u60c5\u51b5\n\n\u8fd9\u4e2a\u5c31\u53ef\u4ee5\u7528DFS\u7248\u7684SPFA\uff0c\u4f46\u662f\u5982\u679c\u7528\u539f\u6765\u7684\u677e\u5f1b\u65b9\u6cd5\u5f88\u6162\uff0c\u90a3\u4e48\u53ef\u4ee5\u52a0\u901f\u4e00\u4e0b\uff0c\u628a\u6240\u6709\u7684\u8ddd\u79bb\u90fd\u8bbe\u7f6e\u4e3a0\uff0c\u8fd9\u6837\u5c31\u53ea\u6709\u6709\u8d1f\u6743\u8fb9\u7684\u65f6\u5019\u624d\u4f1a\u677e\u5f1b\u4e0b\u53bb\uff0c\u5f88\u5927\u7a0b\u5ea6\u4e0a\u52a0\u901f\u4e86\u8fd0\u884c\u901f\u5ea6\uff0c\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u8bb0\u5f55\u4e0b\u6240\u6709\u8d1f\u6743\u8fb9\u7684\u8d77\u70b9\uff0c\u9010\u4e2a\u63d0\u53d6\u8dd1SPFA\uff0c\u4e0d\u8fc7\u6211\u8bd5\u9a8c\u4e86\u4e00\u4e0b\uff0c\u628a\u8ddd\u79bb\u8bbe\u7f6e\u4e3a0\u7528\u65f6\u548c\u8bb0\u5f55\u6240\u6709\u8d1f\u6743\u8fb9\u7684\u8d77\u70b9\u7684\u7528\u65f6\u90fd\u662f0ms\uff0c\u7a7a\u95f4\u4e0a\u8bb0\u5f55\u6240\u6709\u8d1f\u6743\u8fb9\u7684\u8d77\u70b9\u4e0d\u5982\u8ddd\u79bb\u8bbe\u7f6e\u4e3a0\u4f18\u79c0\uff0c\u8981\u591a\u5360\u75280.05MB\n\n\u4f46\u662f\u51ed\u6211\u53ea\u80fd\u60f3\u5230\u8bb0\u5f55\u6240\u6709\u8d1f\u6743\u8fb9\u8d77\u70b9\u3002\u3002\u3002\n\n\u90a3\u4e48\u4e0b\u8fb9\u7ed9\u51fa\u6240\u6709\u7684\u8ddd\u79bb\u5747\u8bbe\u7f6e\u4e3a0\u7684\u5199\u6cd5\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\n#include <cmath>\n#define For(i,l,r) for(int i=l;i<=r;++i)\nusing namespace std;\nint read()\n{\n    bool t=0;\n    int a=0;\n    char c;\n    while((c=getchar())==' '||c=='\\r'||c=='\\n');\n    if(c=='-')\n    {\n        t=1;\n        c=getchar();\n    }\n    while(isdigit(c))\n    {\n        a*=10;\n        a+=c;\n        a-='0';\n        c=getchar();\n    }\n    return a*(t?-1:1);\n}\nstruct line{\n    int to,next,v;\n}edge[5210];\nint n,m,w,dis[501],last[501];\nbool vis[501],t;\nvoid setup()//\u521d\u59cb\u5316\uff0c\u591a\u7ec4\u6570\u636e\u3002\u3002\u3002\n{\n    t=0;\n    memset(last,0,sizeof last);\n}\nvoid dfs(int x)\n{\n    if(vis[x])\n    {\n        t=1;\n        return;\n    }\n    vis[x]=1;\n    int p=last[x];\n    while(p&&!t)\n    {\n        if(dis[edge[p].to]>edge[p].v+dis[x])\n        {\n         dis[edge[p].to]=edge[p].v+dis[x];\n         dfs(edge[p].to);\n        }\n        p=edge[p].next;\n    }\n    vis[x]=0;\n}\nvoid spfa(int s)\n{\n    memset(dis,0,sizeof dis);//\u8ddd\u79bb\u8bbe\u7f6e\u4e3a0\n    dfs(s);\n}\nvoid add(int from,int to,int v,int i)\n{\n    edge[i].to=to;\n    edge[i].v=v;\n    edge[i].next=last[from];\n    last[from]=i;\n}\nint main()\n{\n    int f=read(),tx,ty,tz;\n    For(i,1,f)\n    {\n        setup();\n        n=read();\n        m=read();\n        w=read();\n        m*=2;\n        For(j,1,m)\n        {\n            tx=read();\n            ty=read();\n            tz=read();\n            add(tx,ty,tz,j++);\n            add(ty,tx,tz,j);\n        }\n        For(j,1,w)\n        {\n            tx=read();\n            ty=read();\n            tz=read();\n            add(tx,ty,tz*(-1),m+j);\n        }\n        For(j,1,n)\n        {\n            spfa(j);\n            if(t)\n             break;\n        }\n        if(t)\n         printf(\"YES\\n\");\n        else\n         printf(\"NO\\n\");\n    }\n    return 0;\n}\n```",
        "postTime": 1523722248,
        "uid": 36194,
        "name": "EightSixSun",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "# [\u9898\u76ee\u70b9\u8fd9\u91cc](https://www.luogu.org/problem/P2850)\n\n\u9898\u610f\u662f\u627e\u8d1f\u73af\n\n\u4e00\u770b\u5c31\u662f\u5df2\u6b7b\u7684SPFA\uff0c\u76f4\u63a5\u8dd1\n\n[\u6ca1\u5b66\u8fc7SPFA\u7684\u70b9\u8fd9\u91cc](http://www.sohu.com/a/244179200_100201031)\n\n\u4f46\u662f\uff0c\u4e00\u5b9a\u8981\u6ce8\u610f\u4e24\u70b9\n\n1.\u866b\u6d1e\u662f\u6709\u5411\u8fb9\uff0c\u4f46\u5c0f\u8def\u4e0d\u662f(~~\u6240\u4ee5\u8bf4\u6211\u4ea4\u4e86\u597d\u591a\u904d\u6ca1A\uff0c\u5c31\u662f\u8fd9\u4e2a\u7684\u9505~~)\n\n2.\u6211\u7528\u7684\u524d\u5411\u661f\u5b58\u56fe\u3002\u4f46\u662f\uff0c\u524d\u5411\u661f\u4e5f\u8981\u6bcf\u6b21\u6e05\u96f6~~\u96be\u602a\u4e4b\u524d\u597d\u591a\u591a\u7ec4\u6570\u636e\u7684\u9898WA\uff0c\u5c31\u662f\u5fd8\u4e86memset~~\n\n### \u867d\u7136\u8fd9\u9053\u9898\u8dd1\u7684\u662fSPFA\uff0c\u4f46\u662f\u8bf7\u8bb0\u4f4f\uff0cSPFA\u4ed6\u6b7b\u4e86,Q\u5343\u4e07\u522b\u4e71\u7528SPFA\n\n-----------------------------------------------------\u4e0b\u9762\u662f\u4ee3\u7801--------------------------------------------------------------\n\n```cpp\n#include<queue>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nconst int MAXN = 25005;\nusing namespace std;\nint n,m,cnt1;\nint v[MAXN],G[MAXN],nextpoint[MAXN];\nint dis[MAXN],cnt[MAXN],first[MAXN],w;\nbool flag,vis[MAXN];\n\nvoid add_edge(int x,int y,int z){\n    cnt1++;\n    nextpoint[cnt1] = first[x];\n    first[x] = cnt1;\n    v[cnt1] = y;\n    G[cnt1] = z;\n}\n\nbool SPFA(int s){ //\u5df2\u6b7b\u7684SPFA\n\tqueue<int> q; //\u8fd9\u4e2a\u961f\u5217\u653e\u5168\u5c40\u548c\u5c40\u90e8\u90fd\u884c,\u4e3b\u8981\u662f\u5b83\u5728\u5168\u5c40\u6709\u53ef\u80fd\u51fa\u4e8b\n    int x,y,i,j;\n    memset(dis,127,sizeof(dis));\n    memset(vis,false,sizeof(vis));\n    dis[s] = 0;\n    cnt[s] = 1;\n    q.push(s);\n    vis[s] = true;\n    while(!q.empty()){\n        x = q.front();\n        q.pop();\n        vis[x] = false;\n        for(int i = first[x] ; i ; i = nextpoint[i]){\n            y = v[i];\n            if(dis[y] > dis[x] + G[i]){\n                dis[y] = dis[x] + G[i];\n                cnt[y] = cnt[x] + 1;\n                if(cnt[y] > n) return false;\n                if(!vis[y]){\n                    q.push(y);\n                    vis[y] = true;\n                }\n            }\n        }\n    }\n    return true;\n}\n\ninline long long read() { //\u4e00\u672c\u901a\u63d0\u9ad8\u4e0a\u7684\u7384\u5b66\u5199\u6cd5\n    long long k = 0, f = 1;\n    char ch = getchar();\n    while (ch < '0' || ch > '9') {\n        if (ch == '-')\n            f = -1;\n        ch = getchar();\n    }\n    while (ch >= '0' && ch <= '9') {\n        k = (k << 1) + (k << 3) + (ch & 15);//\u54f2\u5b66\u8dd1\u6cd5(k << 1) \u5c31\u662fk * 2,(k << 3)\u5c31\u662fk * 8,\u8bb2\u9053\u7406,\u5f71\u54cd\u4e0d\u5927\uff0c\u4f46\u770b\u8d77\u6765\u5f88nb\n        ch = getchar();\n    }\n    if (f == -1) k = ~k + 1;//\u8fd9\u91cc\u4e5f\u662f\u82b1\u91cc\u80e1\u54e8\n    return k;\n}\n\nint main(){\n\tint t1;\n\tt1 = read();\n\twhile(t1--){\t\n\t    n = read(),m = read(),w = read();\n\t    cnt1 = 0;//\u6e05\u96f6\u524d\u5411\u661f\n\t    \n\t    for(int i = 1 ; i <= m ; ++i){\n\t\t    int x = read(),y = read(),z = read();\n\t        add_edge(x,y,z); //\u5c0f\u8def\n\t        add_edge(y,x,z);\n\t    }\n\t    \n\t    for (int i = 1; i <= w ; i++){\n\t    \tint x = read(),y = read(),z = read();\n\t    \tadd_edge(x,y,-z); //\u866b\u6d1e\n\t    } \n\t\t\n\t    flag = SPFA(1); //\u4ece1\u5f00\u59cb\u8dd1SPFA\u627e\u8d1f\u73af\n\t    if(!flag)  printf(\"YES\\n\");\n\t    else  printf(\"NO\\n\");\n\t}\n    return 0;\n}\n```\n\n\n\n# \u6700\u540e\u5728CSP2019\u7684\u524d\u5915\uff0c\u795d\u5927\u5bb6CSP.RP++,CSP.SCORE++\n",
        "postTime": 1573710724,
        "uid": 171171,
        "name": "C20210114\u5362\u601d\u5409",
        "ccfLevel": 0,
        "title": "[USACO06DEC]\u866b\u6d1eWormholes"
    },
    {
        "content": "## \u3010\u601d\u8def\u3011\nSFPA\u5224\u8d1f\u73af    \n\u5f88\u6c34\u7684\u4e00\u9053SPFA\u5224\u8d1f\u73af\u7684\u677f\u5b50\u9898    \n\n### \u3010\u9898\u76ee\u5206\u6790\u3011 \n\u5728\u519c\u7530\u6ca1\u6709\u866b\u6d1e\u7684\u9053\u8def\u4e0a\u9762\u8d70\u56de\u6d88\u8017\u65f6\u95f4   \n\u5728\u6709\u866b\u6d1e\u7684\u9053\u8def\u4e0a\u9762\u4f1a\u56de\u5230\u4e4b\u524d\u7684\u65f6\u95f4     \n\u4e5f\u5c31\u662f\u5f97\u5230\u65f6\u95f4    \n\u6240\u4ee5\u4f1a\u4f7f\u4e4b\u524d\u6d88\u8017\u7684\u65f6\u95f4\u51cf\u5c11    \n\u53ea\u8981\u6d88\u8017\u7684\u65f6\u95f4\u80fd\u591f\u6210\u4e3a\u8d1f\u6570    \n\u5c31\u662f\u56de\u5230\u4e86\u51fa\u53d1\u65f6\u95f4\u4e4b\u95f4    \n\u80fd\u591f\u6210\u4e3a\u8d1f\u6570    \n\u4e5f\u5c31\u662f\u6743\u503c\u4e3a\u8d1f\u7684\u4e00\u4e2a\u73af    \n\u5c31\u662f\u8d1f\u73af     \n\u6240\u4ee5\u53ea\u9700\u8981\u5224\u65ad\u6709\u6ca1\u6709\u8d1f\u73af\u5c31\u53ef\u4ee5\u4e86    \n\n### \u3010SPFA\u5224\u8d1f\u73af\u3011\n\u677f\u5b50    \n\u8d64\u88f8\u88f8\u7684\u4e00\u9053\u677f\u5b50\u9898    \n\u8be6\u60c5\u89e3\u91ca\u89c1    \n[\u8fd9\u91cc](https://www.cnblogs.com/acioi/p/11694294.html)     \n\n## \u3010\u5b8c\u6574\u4ee3\u7801\u3011\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<queue>\n#include<cstring>\nusing namespace std;\nconst int Max = 6004;\nconst int M = 505;\nstruct node\n{\n\tint y,ne,z;\n}a[Max];\nint n,m,w; \nint head[M],sum = 0;\n\nvoid add(int x,int y,int z)\n{\n\ta[++ sum].y = y;\n\ta[sum].ne = head[x];\n\ta[sum].z = z;\n\thead[x] = sum;\n}\n\nint d[M],cnt[M];\nbool use[M];\nbool SPFA()\n{\n\tmemset(cnt,0,sizeof(cnt));\n\tmemset(use,false,sizeof(use));\n\tfor(register int i = 1;i <= n;++ i)\n\t\td[i] = 999999;\n\td[1] = 0;\n\tqueue<int>q;\n\tq.push(1);\n\twhile(!q.empty())\n\t{\n\t\tint qwq = q.front();\n\t\tq.pop();use[qwq] = false;\n\t\tfor(register int i = head[qwq];i != 0;i = a[i].ne)\n\t\t{\n\t\t\tint awa = a[i].y;\n\t\t\tif(d[awa] > d[qwq] + a[i].z)\n\t\t\t{\n\t\t\t\td[awa] = d[qwq] + a[i].z;\n\t\t\t\tcnt[awa] = cnt[qwq] + 1;\n\t\t\t\tif(cnt[awa] > n)\n\t\t\t\t\treturn false;\n\t\t\t\tif(use[awa] == false)\n\t\t\t\t{\n\t\t\t\t\tuse[awa] = true;\n\t\t\t\t\tq.push(awa);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\n}\n\nint main()\n{\n\tint f;\n\tscanf(\"%d\",&f);\n\twhile(f --)\n\t{\n\t\tsum = 0;\n\t\tmemset(head,0,sizeof(head));\n\t\tscanf(\"%d%d%d\",&n,&m,&w);\n\t\tint x,y,z;\n\t\tfor(register int i = 1;i <= m;++ i)\n\t\t{\n\t\t\tscanf(\"%d%d%d\",&x,&y,&z);\n\t\t\tadd(x,y,z);add(y,x,z);\n\t\t}\n\t\tfor(register int i = 1;i <= w;++ i)\n\t\t{\n\t\t\tscanf(\"%d%d%d\",&x,&y,&z);\n\t\t\tadd(x,y,-z);\n\t\t}\n\t\tif(SPFA() == false)\n\t\t\tcout << \"YES\" << endl;\n\t\telse\n\t\t\tcout << \"NO\" << endl;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1571317284,
        "uid": 186489,
        "name": "EarthGiao",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "[$$My\\ Blog$$](https://blog.csdn.net/qq_43906740)\n\n# \u9898\u610f\u7b80\u4ecb\n\u56e0\u4e3a\u8981\u56de\u5230\u8fc7\u53bb,\u6240\u4ee5\u56de\u5230\u8d77\u70b9\u65f6\u662f\u4e00\u4e2a\u8d1f\u6570\u3002\u6240\u4ee5,\u5c31\u662f\u6c42\u8d1f\u73af\u7684\u95ee\u9898\u4e86\u3002\n\n# \u8f93\u5165\u6d45\u6790\n\u8f93\u5165,\u5c31\u662f\u8bf4,\u6709\u5f88\u591a\u65e0\u5411\u8fb9,\u8fd8\u6709\u4e00\u4e9b\u866b\u6d1e\u5728\u5355\u5411\u8fb9\u4e0a,\u8fd9\u4e9b\u5355\u5411\u8fb9\u4e3a\u8d1f\u6743\u3002\n\n# \u7b97\u6cd5\u5206\u6790\n\u7b97\u6cd5\u7684\u8bdd,\u5224\u8d1f\u73af\u67093 kinds of algorithm : SPFA, Bellman-Ford and Floyd\u3002\u770b\u8fd9\u9053\u9898\u7684\u795e\u5947\u6570\u636e\u8303\u56f4,\u4e09\u79cd\u662f\u90fd\u53ef\u4ee5\u7528\u7684\u3002\n\n\u7b49\u4e00\u4e0b,\u4e0d\u662f\u591a\u6e90\u8d1f\u73af\u5417?\u600e\u4e48\u80fd\u7528SPFA\u5462?\u4e0d\u8981\u6025,\u7b49\u4e00\u4e0b\u518d\u8bf4\u3002\n\n# Floyd\n\u8001\u5e08\uff1a\u5728\u5faa\u73af\u4f53\u8db3\u591f\u7b80\u5355\u7684\u60c5\u51b5\u4e0b,$O(500^3)$\u662f\u53ef\u4ee5\u8fc7\u7684\u2026\u2026\n~~\u770b\u6765\u8001\u5e08\u5f88\u64c5\u957f\u5361\u5e38+O2\u554a~~\n\n\u9644\u4e0a\u672c\u7bc7\u9898\u89e3\u91cc\u67d0\u4f4d\u5927\u4f6c\u7684\u8bdd\uff1a\n> \u56e0\u4e3a\u4ee3\u7801\u6781\u7b80\u5355,\u76f4\u63a5\u770b\u5427\u3002\n\n\u8fd8\u6709,\u8bb0\u4f4f,\u6709\u91cd\u8fb9\u2026\u2026\n\n```\n// luogu-judger-enable-o2\n#include<cstdio>\n#include<cstring>\n#define reg register\n#define ONLINE_JUDGE\n#ifdef ONLINE_JUDGE\nchar buf[1 << 21], *p1 = buf, *p2 = buf;\ninline int getc() {\n    return p1 == p2 && (++p2 = (p1 = buf) + fread(buf, 1, 1 << 21, stdin), p1 == p2) ? EOF : *p1++;\n}\n#define getchar getc\n#endif\ntemplate <typename T>\ninline T read() {\n    T a = 0; char c = getchar(), f = 1;\n    while(c < '0' || c > '9') {\n        if(c == '-') f = -f;\n        if(c == -1) return c;\n        c = getchar();\n    }\n    while(c >= '0' && c <= '9') a = (a << 1) + (a << 3) + (c ^ 48), c = getchar();\n    return a * f;\n}\ntemplate <class T>\ninline T Min(T a, T b) { return a < b ? a : b; }\nint x[501], y[501];\nint G[501][501];\nint n, m, w;\ninline bool Floyd() {//Floyd\u591a\u6e90\u8d1f\u73af\n    for(reg int k = 1; k <= n; k++)\n        for(reg int i = 1; i <= n; i++)\n            for(reg int j=1; j <= n; j++)\n                G[i][j]=Min(G[i][j], G[i][k] + G[k][j]);\n    for(reg int i = 1; i <= n; i++)\n        if(G[i][i] < 0) return 1;//\u5224\u8d1f\u73af,\u5373\u81ea\u73af\u4e3a\u8d1f\n    return 0;\n}\ninline void init() {\n    n = read<int>(); m = read<int>(); w = read<int>();\n    memset(G, 0x3f, sizeof G);//\u8bb0\u5f97\u8981\u8d4b\u521d\u59cb\u503c\n    for(reg int i = 1; i <= m; i++) {\n        int u = read<int>(), v = read<int>(), l = read<int>();\n        if(G[u][v] > l) G[u][v] = G[v][u] = l;//\u60f3\u6253\u4eba\u7684\u91cd\u8fb9\n    }\n    for(reg int i = 1; i <= w; i++) {\n        int u = read<int>(), v = read<int>(), l = read<int>();\n        G[u][v] = -l;//\u8d1f\u6743\n    }\n}\nint main() {\n    int T = read<int>();\n    while(T--) {\n        init();\n        puts(Floyd() ? \"YES\" : \"NO\");\n    }\n}\n\n```\n# SPFA\n~~\u56e0\u4e3a\u8fd9\u9053\u9898\u201c\u6781\u6c34\u201d\uff0c\u6240\u4ee5\u6734\u7d20SPFA\u80fd\u8fc7~~\n\n\u9644\u4e0a\u4ee3\u7801(\u56e0\u4e3a\u7528\u4e86\u90bb\u63a5\u8868\uff0c\u6240\u4ee5\u4e0d\u7528\u7ba1\u91cd\u8fb9)\n```\n#include<queue>\n#include<vector>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\n#define reg register\n#define ONLINE_JUDGE\n#ifdef ONLINE_JUDGE\nchar buf[1 << 21], *p1 = buf, *p2 = buf;\ninline int getc() {\n    return p1 == p2 && (++p2 = (p1 = buf) + fread(buf, 1, 1 << 21, stdin), p1 == p2) ? EOF : *p1++;\n}\n#define getchar getc\n#endif\ntemplate <typename T>\ninline T read() {\n    T a = 0; char c = getchar(), f = 1;\n    while(c < '0' || c > '9') {\n        if(c == '-') f = -f;\n        if(c == -1) return c;\n        c = getchar();\n    }\n    while(c >= '0' && c <= '9') a = (a << 1) + (a << 3) + (c ^ 48), c = getchar();\n    return a * f;\n}\nint n, m, w;\nvector<pair<int,int> >G[501];//\u7528pair\u597d\u50cf\u4f1a\u5feb\u4e00\u70b9?!\ninline void init() {\n    n = read<int>(); m = read<int>(); w = read<int>();\n    for(reg int i=1; i<=n; i++) G[i].clear();\n    for(reg int i=1; i<=m; i++) {\n        int u = read<int>(), v = read<int>(), l = read<int>();\n        G[u].push_back(make_pair(v, l));\n        G[v].push_back(make_pair(u, l));\n    }\n    for(reg int i=1; i<=w; i++) {\n        int u = read<int>(), v = read<int>(), l = read<int>();\n        G[u].push_back(make_pair(v, -l));\n    }\n}\nint SPFA(int S) {\n    int dis[501], cnt[501]={}; bool vis[501]={};\n    memset(dis,0x3f,sizeof dis);\n    dis[S] = 0, vis[S] = 1; queue<int>q; q.push(S);\n    while(!q.empty()) {\n        int t = q.front(); q.pop(); vis[t] = 0;\n        for(reg int i = 0; i < int(G[t].size()); i++) {\n            int v = G[t][i].first,w = G[t][i].second;\n            if(cnt[v] >= n)//\u5224\u73af,\u5176\u5b9e\u5e94\u8be5\u662f >= n-1 \u7684,\u4f46\u662f\u8d1f\u73af\u5c31\u662f\u4f1a\u88ab\u8bbf\u95ee\u65e0\u9650\u6b21,\u6240\u4ee5\u4e0d\u7d27\u8981\n                return 1;\n            if(dis[v] > dis[t] + w) {\n                dis[v] = dis[t] + w;\n                if(!vis[v]) vis[v] = 1, q.push(v), cnt[v]++;//\u677e\u5f1b,\u88ab\u904d\u5386\u6b21\u6570+1\uff0c\u4ee5\u4fbf\u5224\u73af\n            }\n        }\n    }\n    return 0;\n}\nint main() {\n    int T = read<int>();\n    while(T--) {\n        init();\n        puts(SPFA(1) ? \"YES\" : \"NO\");\n    }\n}\n\n```\n\u5176\u5b9e,\u8fd9\u9053\u9898\u7528SPFA\u7684\u6b63\u89e3,\u662f\u5148\u7528DFS\u67d3\u8272,\u7136\u540e\u6bcf\u4e2a\u4e0d\u540c\u8272\u7684\u533a\u95f4SPFA\u4e00\u904d,\u4f46\u662f\u56e0\u4e3a\u6211~~\u61d2~~\u76f8\u4fe1\u4f60\u4eec\u7684\u80fd\u529b,\u5c31\u4e0d\u5c55\u793a\u4e86\u3002\n# Bellman-Ford\n\u8001\u5e08\uff1a\u56e0\u4e3aBelman-Ford\u80fd\u505a\u7684\u4e8b,SPFA\u57fa\u672c\u90fd\u80fd\u505a,\u56e0\u4e3aSPFA\u662fBellman-Ford\u7684\u4e00\u4e2a\u4f18\u5316,\u6240\u4ee5\u5c31\u4e0d\u8bb2\u4e86\u2026\u2026\n~~\u8fd9\u4e8b\u5c31\u8981\u602a\u8001\u5e08\u4e86\u5427~~\n",
        "postTime": 1548849858,
        "uid": 104241,
        "name": "Sora\u9171",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "\u53c8\u662f\u4e00\u9053\u6700\u77ed\u8def\u6c34\u9898\u3002\n\n##**\u9898\u76ee**\n\n\u81ea\u5df1\u770b\u5427 [\u70b9\u8fd9\u91cc](https://www.luogu.org/problemnew/show/P2850)\n\n##**\u601d\u8def**\n\n\u770b\u5b8c\u4e86\u9898\u76ee\u4e0d\u77e5\u5927\u5bb6\u662f\u600e\u4e48\u60f3\u7684\uff0c\u6211\u770b\u8fd9\u4e0e[\u3010\u6a21\u677f\u3011\u8d1f\u73af](https://www.luogu.org/problemnew/show/P3385)\u5b9e\u5728\u592a\u50cf\u4e86\uff0c\u5c31\u662f\u7b80\u5355\u7684\u5224\u65ad\u8d1f\u73af\u5417\uff0c\u6539\u4e86\u4e00\u4e0b\u8f93\u5165\u548c\u8f93\u51fa\u5c31\u5b8c\u7f8eAC\u4e86\u3002\u5c31\u662f\u8fd9\u6837\u7b80\u5355\u3002\u771f\u7684\u6ca1\u4e86\u3002\n\n\u4e3a\u4ec0\u4e48\u4f1a\u662f\u8fd9\u79cd\u60c5\u51b5\u5462\uff1f\uff08~~\u4f1a\u4e0d\u4f1a\u662f\u6570\u636e\u592a\u6c34\u4e86\u5462~~\uff09\uff0c\u5176\u5b9e\u51fa\u73b0\u4e86\u8d1f\u73af\u624d\u4f1a\u56de\u5230\u4e4b\u524d\u7684\u65f6\u7a7a\uff08\u9898\u76ee\u80cc\u666f\u8fd8\u662f\u4e0d\u9519\u7684~\uff09\u3002\u518d\u770b\u4e86\u4e00\u773c\u9898\u76ee\uff0c\u53ea\u8981\u6ce8\u610f\u8f93\u5165\u548c\u8f93\u51fa\u5c31\u53ef\u4ee5AC\u4e86\uff0c\u60f3\u5fc5\u5927\u5bb6\u4e00\u5b9a\u6709\u66f4\u597d\u7684\u60f3\u6cd5\u3002\uff08~~\u4f46\u662f\u6211\u4e0d\u542c\u6211\u4e0d\u542c\u6211\u4e0d\u542c~~\uff09\n\n\u518d\u591a\u8bf4\u4e00\u53e5\uff0cSPFA\u662f\u4e2a\u597d\u4e1c\u897f\uff08\u53ea\u56e0\u4e3a\u6211\u5fd8\u4e86Bellman-ford\uff09\u3002\n\n###### \u4ee5\u4e0a\u53ea\u662f\u6211\u8fd9\u4e2a\u849f\u84bb\u778e\u8bf4\u7684\u4e00\u5207\uff0c\u8fd9\u80af\u5b9a\u4e0d\u662f\u6b63\u89e3\uff0c\u5e0c\u671b\u5927\u5bb6\u4e0d\u8981\u53c2\u8003\uff01\uff01\uff01\n\n##**\u4ee3\u7801**\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nstruct node{\n    int to,next,w;\n}edge[5000001];//\u524d\u5411\u661f\u5efa\u8fb9\nint t,n,m,ww,cnt,head[100001],in[100001],dis[100001];\nbool vis[100001];\nvoid add(int x,int y,int w){//\u524d\u5411\u661f\u5efa\u8fb9\n    edge[++cnt]=(node){y,head[x],w};\n    head[x]=cnt;\n}\nvoid SPFA(){\n    queue<int>que; memset(dis,127,sizeof(dis));\n    memset(vis,0,sizeof(vis)); memset(in,0,sizeof(in));//\u521d\u59cb\u5316\u4e0d\u8981\u5fd8\u4e86\n    vis[1]=1; dis[1]=0; que.push(1); in[1]=1;\n    while(que.size()){//\u5f00\u59cb\u4e86\u6b63\u6587\n        int d=que.front(); que.pop(); vis[d]=0;\n        for(int i=head[d];i;i=edge[i].next){\n            int x=edge[i].to;//\u679a\u4e3e\u4e0e\u5b83\u76f8\u5173\u7684\u70b9\n            if(dis[x]>dis[d]+edge[i].w){//\u677e\u5f1b\u64cd\u4f5c\n                dis[x]=dis[d]+edge[i].w;\n                in[x]=in[d]+1;\n                if(in[x]>n){//\u8fd9\u4e2a\u662f\u6700\u57fa\u672c\u7684\u64cd\u4f5c\uff0c\u4e0d\u61c2\u53ef\u4ee5\u53c2\u8003\u5927\u4f6c\u7684\u89e3\u91ca\n                    cout<<\"YES\"<<endl;\n                    return;\n                }\n                if(!vis[x]) vis[x]=1,que.push(x);\n            }\n        }\n    }\n    cout<<\"NO\"<<endl;//\u6ca1\u6709\u8d1f\u73af\n}\nint main(){\n    cin>>t;\n    while(t--){\n        cnt=0; memset(head,0,sizeof(head));\n        scanf(\"%d%d%d\",&n,&m,&ww);\n        for(int i=1;i<=m;i++){\n            int x,y,w;\n            scanf(\"%d%d%d\",&x,&y,&w);\n            add(x,y,w); add(y,x,w);//\u5efa\u8fb9\u548c\u8f93\u5165\n        }\n        for(int i=1;i<=ww;i++){\n            int x,y,w;\n            scanf(\"%d%d%d\",&x,&y,&w);\n            add(x,y,-w);//\u5efa\u8d1f\u8fb9\n        }\n        SPFA();\n    }\n    return 0;\n}\n```",
        "postTime": 1545043719,
        "uid": 47757,
        "name": "dunko",
        "ccfLevel": 6,
        "title": "\u866b\u6d1eWormholes"
    },
    {
        "content": "\u5176\u5b9e\u697c\u4e0b\u8bf4\u7684\u8d1f\u73af\u90a3\u9898\u6211\u5c31\u62ffbfs\u8fc7\u4e86\u2026\u2026\n\n\u8fd9\u91cc\u8bf4\u4e00\u4e2a\u5c0f\u5c0f\u7684\u4f18\u5316\u2026\u2026\n\n\u5c31\u662f\u6211\u4eec(\u697c\u4e0b)\u7684\u6b63\u5e38\u601d\u8def\u662f\u4ee5\u6bcf\u4e00\u4e2a\u70b9\u4e3a\u8d77\u70b9\u90fd\u8dd1\u4e00\u904dspfa\u770b\u770b\u6709\u6ca1\u6709\u8d1f\u73af\u3002\n\n\u8fd9\u91cc\u5462\uff0c\u5c0f\u53ef\u7231\u53c8\u5f00\u4e86\u4e00\u4e2abool\u6570\u7ec4\u6765\u8bb0\u5f55\u4e00\u4e0b\u6bcf\u4e2a\u70b9\u5728\u6700\u77ed\u8def\u66f4\u65b0\u7684\u65f6\u5019\u6709\u6ca1\u6709\u88ab\u626b\u5230\u8fc7\uff0c\u6709\u8fc7\u7684\u8bdd\u5c31\u76f4\u63a5\u6807\u8bb0\u3002\u800c\u8fd9\u4e9b\u6709\u88ab\u626b\u5230\u8fc7\u7684\u8282\u70b9\u8dd1\u6700\u77ed\u8def\u7684\u8bdd\uff0c\u5f53\u7136\u5c31\u662f\u6d6a\u8d39\u65f6\u95f4\u4e86\u554aqaq\n\n\u8bdd\u4e0d\u591a\u8bf4\uff0c\u4e0a\u4ee3\u7801\n\n```cpp\n#include <cstdio>\n#include <queue>\n#include <algorithm>\n#include <cstring>\nusing namespace std;\nint t;\nint n,m,s;\nstruct data{\n    int v;int val;int next;\n}edge[1000010];int alist[1000010];\nint cnt;\nvoid add(int u,int v,int val){\n    edge[++cnt].v=v;\n    edge[cnt].val=val;\n    edge[cnt].next=alist[u];\n    alist[u]=cnt;\n    return ;\n}\nqueue<int> q;\nint dis[100010];\nbool ins[100010];\nbool book[100010];\nint inq[100010];\nbool spfa(int s){\n    q.push(s);\n    dis[s]=0;\n    book[s]=true;\n    ins[s]=true;inq[s]++;\n    while(!q.empty()) {\n        int x=q.front();\n        q.pop();ins[x]=false;\n        for(int next=alist[x];next;next=edge[next].next){\n            book[edge[next].v]=true;//\u88ab\u626b\u5230\u8fc7\u5c31\u76f4\u63a5\u6807\u8bb0\u5c31\u597d\u4e86\n            if(dis[edge[next].v]>dis[x]+edge[next].val){\n                dis[edge[next].v]=dis[x]+edge[next].val;\n                if(!ins[edge[next].v]) {\n                    q.push(edge[next].v),ins[edge[next].v]=true,inq[edge[next].v]++;\n                    if(inq[edge[next].v]>n) return false;\n                }\n            }\n        }\n    }\n    return true;\n}\nint u,v,val;\nint main(){\n//    freopen(\"1.in\",\"r\",stdin);\n//    freopen(\"1.out\",\"w\",stdout);\n    scanf(\"%d\",&t);\n    while(t--){\n        memset(inq,0,sizeof(inq));\n        memset(book,false,sizeof(book));\n        memset(ins,0,sizeof(ins));\n        memset(alist,0,sizeof(alist));\n        cnt=0;\n        while(!q.empty())q.pop();//\u6e05\u7a7a\n        scanf(\"%d%d%d\",&n,&m,&s);\n        for(int i=1;i<=m;i++)scanf(\"%d%d%d\",&u,&v,&val),add(u,v,val),add(v,u,val);\n        for(int i=1;i<=s;i++)scanf(\"%d%d%d\",&u,&v,&val),add(u,v,-val);//\u5efa\u56fe\n        for(int i=1;i<=n;i++) if(!book[i]) {memset(dis,0x3f3f3f3f3f,sizeof(dis));if(!spfa(i)) {puts(\"YES\");goto qwq;}}//\u8fd9\u91cc\u7684book\u6570\u7ec4\n        puts(\"NO\");\n        qwq:;\n    }\n}\n\n```",
        "postTime": 1537499562,
        "uid": 57699,
        "name": "Arcturus1350",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "##### \u6539\u4e86\u4e00\u665a\u4e0a\u7684\u9898\uff0c\u501f\u9274\u4e86\u524d\u9762\u5404\u4f4d\u5927\u4f6c\u7684\u7ecf\u9a8c\uff08\u5f53\u7136\uff0c\u80af\u5b9a\u6ca1\u6709\u6284\uff09\u3002\u624d\u8fc7\u4e86\u8fd9\u9898\r\n#### \u4e00\u5f00\u59cb\u6211tle\u4e86\u5f88\u591a\u4e2a\u70b9\uff0c\u5b9e\u9645\u4e0a\u8fd9\u9898\u662f\u4e00\u9053\u8d1f\u73af\u5904\u7406\u95ee\u9898\uff0c\u4f7f\u7528\u4e00\u4e2afp\u6570\u7ec4\u5b58\u50a8\u5373\u53ef\uff0c\u53ea\u8981\u8d85\u8fc7n\uff0c\u8fd9\u6b64\u4e3a\u8d1f\u73af\r\n```cpp\r\n#include<cstdio>\r\n#include<queue>\r\n#include<cstring>\r\n\r\nusing namespace std;\r\n\r\nstruct pel {\r\n\tint to;\r\n\tint next;\r\n\tint dis;\r\n};\r\n\r\npel a[10000];\r\n\r\ndeque<int> q;\r\n  \r\nint num=0;\r\n  \r\nint dis[10000],h[10000];\r\n\r\nint f;\r\n\r\nint n,m,w;\r\n\r\nint x,y,z;\r\n\r\nvoid add(int x,int y,int z) {\r\n\r\n\tnum++;\r\n\ta[num]=(pel) {\r\n\t\ty,h[x],z\r\n\t};\r\n\th[x]=num;\r\n}\r\n\r\nint fp[10000];\r\n\r\nbool SPFA(int t) {\r\n\r\n\tint i;\r\n\tfor(i=1; i<=n; i++)dis[i]=999999,fp[i]=0;\r\n\tq.push_front(t);\r\n\tdis[t]=0;\r\n\twhile(!q.empty()) {\r\n\t\tint past=q.front();\r\n\t\tq.pop_front();\r\n\t\tif(fp[past]>n)return 1;\r\n\t\tfor(i=h[past]; i; i=a[i].next) {\r\n\t\t\tint now=a[i].to;\r\n\t\t\tif(dis[now]>dis[past]+a[i].dis) {\r\n\t\t\t\tdis[now]=dis[past]+a[i].dis;\r\n\t\t\t\tif(dis[now]<0&&now==t)return 1;\r\n\t\t\t\tif(!q.empty()&&dis[now]<dis[q.front()])\r\n\t\t\t\t\tq.push_front(now);\r\n\t\t\t\telse q.push_back(now);\r\n\t\t\t\tfp[now]++;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n    return 0;\r\n    }\r\nint main(){\r\n\r\n    scanf(\"%d\",&f);\r\n\tint i,j;\r\n\tbool ff=1;\r\n\tfor(i=1; i<=f; i++) {\r\n\t\tscanf(\"%d%d%d\",&n,&m,&w);\r\n\t\tnum=0;\r\n        memset(h,0,sizeof(h));\r\n        \r\n\t\tfor(j=1; j<=m; j++) {\r\n\t\t\tscanf(\"%d%d%d\",&x,&y,&z);\r\n\t\t\tadd(x,y,z);\r\n\t\t\tadd(y,x,z);\r\n\t\t}\r\n\t\tfor(j=1; j<=w; j++) {\r\n\t\t\tscanf(\"%d%d%d\",&x,&y,&z);\r\n\t\t\tadd(x,y,-z);\r\n\t\t}\r\n\r\n        for(j=1;j<=n;j++)\r\n\t\tif(SPFA(j)) {\r\n\t\t\t\tprintf(\"YES\\n\");\r\n\t\t\t\tff=0;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif(ff)printf(\"NO\\n\");\r\n\t\t\tff=1;\r\n\t     }\r\n}",
        "postTime": 1534255228,
        "uid": 40562,
        "name": "q2368126021",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "#\u94fe\u5f0f\u524d\u5411\u661f\u5b58\u56fe+spfa\u6c42\u8d1f\u6743\u56de\u8def\n\n\n##\u4e00\u9053\u88f8\u7684\u627e\u8d1f\u73af\uff0c\u5efa\u8bae\u5728\u719f\u7ec3\u5730\u4e86\u89e3spfa\u548c\u94fe\u5f0f\u524d\u5411\u661f\u540e\u518d\u505a\uff08~~\u597d\u5427\u5176\u5b9e\u6211\u4e5f\u4e0d\u4f1a~~\uff09\n\n\n\u5229\u7528\u8d1f\u6743\u56de\u8def\u53ef\u4ee5\u65e0\u9650\u88ab\u677e\u5f1b\u7684\u7279\u70b9\u6765\u505a\uff0c\u82e5\u4e00\u4e2a\u70b9\u88ab\u677e\u5f1b\u4e24\u6b21\uff08\u4ee5\u4e0a\uff09\uff0c\u5219\u5fc5\u5b9a\u5b58\u5728\u8d1f\u73af\uff0c\u5373\u53ef\u4ee5\u56de\u5230\u4ece\u524d\uff0c\u7528\u4e00\u4e2abool\u6570\u7ec4\u6765\u8bb0\u5f55\uff0c\u8fd9\u4e00\u70b9\u53ef\u4ee5\u7528\u53bb\u6389\u6b63\u6743\u8fb9\u6765\u4f18\u5316\n\n\n\u4ee3\u7801\u5949\u4e0a\uff1a\n\n\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#define maxn 100010\n#define maxm 1000010\nusing namespace std;\nstruct node{\n  int to;\n  int w;\n}e[maxm];\nint N_ext[maxm];\nint H_ead[maxn];//\u94fe\u5f0f\u524d\u5411\u661f\uff0c\u9700\u91cd\u590d\u4f7f\u7528 \nint d[maxn];//\u8bb0\u5f55\u8be5\u70b9\u5230\u5176\u4ed6\u70b9\u6700\u77ed\u8def \nbool V[maxn];\nint tot=0;\nbool flag;\nvoid ins(int x,int y,int w)\n{\n    e[++tot].to=y;\n    e[tot].w=w;\n    N_ext[tot]=H_ead[x];\n    H_ead[x]=tot;\n```\n}//\u94fe\u5f0f\u524d\u5411\u661f\u5b58\u56fe\n\n\n\n    \n      \n```cpp\nvoid clean()\n{\n    tot=0;\n    flag=true;\n    memset(V,false,sizeof(V));\n    memset(H_ead,0,sizeof(H_ead));\n    memset(N_ext,0,sizeof(N_ext));\n    memset(d,0,sizeof(d));//\uff08\u91cd\u70b9\uff01\uff01\uff01\uff09\u521d\u59cb\u5316\u4e3a\u96f6\uff0c\u53ea\u770b\u8fb9\u6743\u4e3a\u8d1f\u7684\u8fb9 \uff0c\u6781\u5927\u7684\u4f18\u5316\uff0c\u6a21\u677f\u4e2d\u4e0d\u8fd9\u4e48\u505a\u4f1aT\uff08\u522b\u95ee\u6211\u600e\u4e48\u77e5\u9053\u7684\uff09 \n}\nvoid spfa(int x)\n{\n    if(!flag) return;\n    V[x]=true;//\u9996\u5148\u628a\u8981\u770b\u7684\u70b9\u8d4b\u503c\u4e3atrue \n    for(int p=H_ead[x];p;p=N_ext[p])//\u8fdb\u94fe\u8868 \n    {\n        if(!flag) return;\n        int y=e[p].to;\n        if(d[y]>d[x]+e[p].w)\n        {\n            d[y]=d[x]+e[p].w;\n            if(V[y])//\u82e5\u4e00\u4e2a\u70b9\u88ab\u91cd\u590d\u677e\u5f1b\uff0c\u5219\u5fc5\u5b9a\u6709\u8d1f\u6743\u56de\u8def \n            {\n                flag=false;\n                return;\n            }\n            else spfa(y);//\u4ece\u6b64\u70b9\u5f00\u59cb\u65b0\u7684\u677e\u5f1b \n        }\n    }\n    V[x]=false;//\u6062\u590d \n}\nint main()\n{\n    int t;\n    scanf(\"%d\",&t);\n    while(t--)\n    {\n      clean();//\u6bcf\u6b21\u5faa\u73af\u9700\u6e05\u7a7a\u91cd\u590d\u4f7f\u7528\u7684\u6570\u7ec4\u7b49 \n      int n,m,w;\n      scanf(\"%d%d%d\",&n,&m,&w);\n      for(int i=1;i<=m;i++)\n      {\n          int s,e,t;\n          scanf(\"%d%d%d\",&s,&e,&t);\n          ins(s,e,t);\n          ins(e,s,t);\n```\n}//\u5c0f\u8def\u5efa\u65e0\u5411\u8fb9\n      \n```cpp\n      for(int i=1;i<=w;i++)\n      {\n          int s,e,t;\n          scanf(\"%d%d%d\",&s,&e,&t);\n          ins(s,e,-t);\n```\n}//\u866b\u6d1e\u5efa\u6709\u5411\u8d1f\u8fb9\n      \n      \n    \n```cpp\n      for(int i=1;i<=n;i++)\n      {\n        if(!flag) break;\n        spfa(i);//\u7531\u4e8e\u53ea\u770b\u8d1f\u8fb9\uff0c\u5fc5\u987b\u6bcf\u4e2a\u70b9\u90fd\u505a\n      }\n      if(flag) printf(\"NO\\n\");\n      else printf(\"YES\\n\");\n    }\n    return 0;\n}\n```",
        "postTime": 1510212319,
        "uid": 57221,
        "name": "Accele_Rator",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "\u88f8\u7684SPFA\u5224\u8d1f\u73af\uff0c\u6709\u8f93\u51faYES\uff0c\u6ca1\u8f93\u51faNO\uff0c\u6ce8\u610f\u4e00\u4e0b\u6570\u636e\u8303\u56f4\uff0c\u8c8c\u4f3c\u662f\u88ab\u5077\u5077\u6269\u5927\u8fc7\u7684\u3002\u3002\u3002\n\n\u4e00\u5f00\u59cb\u5f00maxn=5000\u6ca1\u8fc7\uff0c\u4e00\u76f4\u5f00\u52301000000\u3002\u3002\u3002\n\n6,8\u4e24\u4e2a\u70b9\u8d3c\u5927\u7684\n\n```cpp\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#define fr(k) edge[k].from\n#define nx(k) edge[k].next\n#define ev(k) edge[k].value\n#define to(k) edge[k].to\n#define ll long long\nconst ll maxn=100000;\nll hd[maxn],mm[maxn],c[maxn],d[maxn],f,n,m,w,x,y,z;\nbool m1[maxn],mark;\nstruct edge\n{\n    ll from,next,value,to;\n}edge[maxn<<1];\nvoid add(ll x,ll y,ll v,ll k)\n{\n    fr(k)=x;\n    to(k)=y;\n    ev(k)=v;\n    nx(k)=hd[x];\n    hd[x]=k;\n}\nll spfa(ll s)\n{\n    ll l,r;\n    memset(m1,false,sizeof(m1));\n    memset(mm,0,sizeof(mm));\n    memset(c,0,sizeof(c));\n    l=1;\n    r=1;\n    c[1]=s;\n    d[s]=0;\n    m1[s]=true;\n    mm[s]=1;\n    for (int i=1;i<=n;i++)\n        if (i!=s) d[i]=2147483647;\n    while (l<=r)\n    {\n        for (int i=hd[c[l]];i!=0;i=nx(i))\n            if (ev(i)+d[c[l]]<d[to(i)])\n            {\n                d[to(i)]=ev(i)+d[c[l]];\n                if (m1[to(i)]==false)\n                {\n                    r++;\n                    c[r]=to(i);\n                    m1[to(i)]=true;\n                    mm[to(i)]++;\n                    if (mm[to(i)]>n) return 1;\n                }\n            }\n        m1[c[l]]=false;\n        l++;    \n    }\n    return 0;\n}\nint main()\n{\n    scanf(\"%d\",&f);\n    for (int i=1;i<=f;i++)\n    {\n        memset(edge,0,sizeof(edge));\n        memset(hd,0,sizeof(hd));\n        scanf(\"%lld%lld%lld\",&n,&m,&w);\n        for (int j=1;j<=m;j++)\n        {\n            scanf(\"%lld%lld%lld\",&x,&y,&z);\n            add(x,y,z,j);\n            add(y,x,z,j+m);\n        }\n        for (int j=1;j<=w;j++)\n        {\n            scanf(\"%lld%lld%lld\",&x,&y,&z);\n            add(x,y,-z,2\\*m+j);\n        }\n        if (spfa(1)==1) printf(\"YES\\n\");\n            else printf(\"NO\\n\");\n    }\n    return 0;\n}",
        "postTime": 1506442801,
        "uid": 8352,
        "name": "\u5982\u6211\u897f\u6c89",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "pascal\u8be6\u89e3\uff0874\u5206\uff09\n\n\u95ee\u9898\u5206\u6790\uff1a\u7ed9\u51fa\u4e00\u5f20\u56fe\u548c\u5176\u4e2d\u7684\u866b\u6d1e\uff0c\u5224\u65ad\u80fd\u5426\u56de\u5230\u8fc7\u53bb\u3002\n\n\u6ce8\u610f\uff1a\u866b\u6d1e\u662f\u6709\u5411\u8fb9\uff0c\u5c0f\u8def\u662f\u65e0\u5411\u8fb9\u3002\n\n\u7b97\u6cd5\u5206\u6790\uff1a\u7528\u90bb\u63a5\u77e9\u9635\u5b58\u50a8\u4e24\u70b9\u95f4\u5173\u7cfb\uff0c\u7136\u540e\u7528SPFA\u4f9d\u6b21\u5224\u65ad\u4ece\u4efb\u4e00\u70b9\u51fa\u53d1\u662f\u5426\u53ef\u4ee5\u56de\u5230\u8fc7\u53bb\u3002\uff08\u597d\u5427\uff0c\u867d\u7136\u73b0\u5b9e\u751f\u6d3b\u4e2d\u4e0d\u53ef\u80fd\uff0c\u6bd5\u7adf\u6709\u7956\u7236\u6096\u8bba\uff09\uff08\u6e29\u99a8\u63d0\u793a\uff1a\u53ef\u80fd\u4f1a\u6709\u91cd\u8fb9\uff09\n\n\u4ee3\u7801\uff1a\n\n```cpp\nconst maxn=10000000;\nvar r:array[1..maxn] of longint;\n    a,l:array[1..500,0..500] of longint;\n    u:array[1..500,1..500] of boolean;\n    f:array[1..500] of longint;\n    o,i,j,s,e,t,n,m,w,p,q:longint;\nfunction spfa(x:longint):boolean;\nvar h,t,i,k:longint;\n    begin\n        fillchar(f,sizeof(f),$20);\n        f[x]:=0;\n        u[x,x]:=true;\n        h:=0;\n        t:=1;\n        r[t]:=x;\n        while h<t do\n            begin\n                h:=h mod maxn+1;\n                k:=r[h];\n                u[x,k]:=false;\n                for i:=1 to a[k,0] do\n                    if f[k]+l[k,a[k,i]]<f[a[k,i]] then\n                        begin\n                            f[a[k,i]]:=f[k]+l[k,a[k,i]];\n                            if f[x]<0 then\n                                begin\n                                    writeln('YES');\n                                    exit(true);\n                                end;\n                            if not(u[x,a[k,i]]) then\n                                begin\n                                    t:=t mod maxn+1;\n                                    r[t]:=a[k,i];\n                                    u[x,a[k,i]]:=true;\n                                end;\n                        end;\n            end;\n        if x=n then\n            writeln('NO')\n                else\n                    exit(false);\n    end;\nprocedure readin;\n    begin\n        readln(n,m,w);\n        fillchar(l,sizeof(l),$20);\n        for j:=1 to m do\n            begin\n                readln(s,e,t);\n                if t<l[s,e] then\n                    l[s,e]:=t;\n                if t<l[e,s] then\n                    l[e,s]:=t;\n            end;\n        for j:=1 to w do\n            begin\n                readln(s,e,t);\n                if -t<l[s,e] then\n                    l[s,e]:=-t;\n            end;\n    end;\nprocedure main;\n    begin\n        for p:=1 to n do\n            for q:=1 to n do\n                if l[p,q]<200000 then\n                    begin\n                        inc(a[p,0]);\n                        a[p,a[p,0]]:=q;\n                    end;\n        for j:=1 to n do\n            if spfa(j) then\n                break;\n    end;\nbegin\n    readln(o);\n    for i:=1 to o do\n        begin\n            readin;\n            main;\n        end;\nend.\n```",
        "postTime": 1503647451,
        "uid": 55019,
        "name": "Los_chase",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "\u8fd9\u9898\u53ef\u4ee5\u7528SPFA\u505a\uff0c\u8dd1\u5f97\u5f88\u5feb\n\n###**\u4f46\u662f\u7528Bellman-Ford\u5224\u8d1f\u73af\u66f4\u7b80\uff08ruo\uff09\u5355\uff08zhi\uff09\u76f4\u63a5\uff0c\u4e5f\uff08dan\uff09\u66f4\uff08shi\uff09\u4e0d\uff08hui\uff09\u5bb9\uff08man\uff09\u6613\uff08yi\uff09\u51fa\uff08dian\uff09\u9519**\n\n\u8fd9\u91cc\u662fBellman-Ford\n\nBellman-Ford\u5bf9\u6bcf\u4e00\u6761\u8fb9\u5df2\u7ecf\u505a\u4e86n-1\u6b21\u677e\u5f1b\u64cd\u4f5c\u3002\u5982\u679c\u518d\u8fdb\u884cn-1\u6b21\u677e\u5f1b\u540e\uff0c\u4ecd\u7136\u53ef\u4ee5\u7ee7\u7eed\u6210\u529f\u677e\u5f1b\uff0c\u5219\u8be5\u56fe\u5fc5\u7136\u5b58\u5728\u8d1f\u6743\u73af\n\n\u5f53\u7136\u4e3a\u4e86\u9632\u6b62MLE\uff0c\u4e0d\u8981\u7528\u90bb\u63a5\u77e9\u9635\uff0c\u7528\u90bb\u63a5\u8868\u6216\u8005\u94fe\u5f0f\u524d\u5411\u661f\u4f1a\u7701\u5f88\u591a\u7a7a\u95f4\n\n\u6ce8\u610f\uff1a\n\n1.\u6709\u591a\u4e2a\u519c\u573a\n\n2.\u6709\u8d1f\u73af\u662fYES\uff0c\u6ca1\u8d1f\u73af\u662fNO\uff0c\u4e0d\u8981\u5f04\u53cd\u4e86\n\n3.\u5c0f\u8def\u662f\u65e0\u5411\u8fb9\uff01\u866b\u6d1e\u662f\u6709\u5411\u8fb9\uff01\n\n4.\u8fd9\u79cd\u7b97\u6cd5\u6bd4\u795e\u7287\u4eec\u7684SPFA\u7b80\u5355\u5f88\u591a\uff0c\u6240\u4ee5\u7406\u89e3\u5c31\u597d\uff0c\u522b\u6284\u4ee3\u7801\n\n\u9644\u4e0a\u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cstdlib>\nusing namespace std;\nconst int maxn=5550;//\u6570\u7ec4\u5f00\u5927\u70b9\uff0cRE\u4f60\u61c2\u7684 \nint dis[maxn],u[maxn],v[maxn],w[maxn]; //\u7528\u90bb\u63a5\u8868\u9632\u6b62MLE\nconst int inf=1e9;\nint main(){\n    int TT;cin>>TT;\n    for(int ii=1;ii<=TT;ii++){//\u6ce8\u610f\u6709\u591a\u4e2a\u519c\u573a \n        memset(dis,0,sizeof(dis));\n        memset(u,0,sizeof(u));\n        memset(v,0,sizeof(v));\n        memset(w,0,sizeof(w));//\u6bcf\u6b21\u8ba1\u7b97\u7684\u65f6\u5019\u8981\u521d\u59cb\u5316 \n        int n,m,W;cin>>n>>m>>W;\n        for(int i=1;i<=m;i++){\n            int x,y,z;scanf(\"%d%d%d\",&x,&y,&z);\n            u[i]=v[i+m]=x;\n            v[i]=u[i+m]=y;\n            w[i]=w[i+m]=z;//\u5c0f\u8def\u662f\u65e0\u5411\u7684 \n        }\n        m*=2;//\u7531\u4e8e\u5c0f\u8def\u662f\u65e0\u5411\u7684\uff0c\u8fb9\u6570\u8981\u4e582 \n        for(int i=1;i<=W;i++){\n            int x,y,z;scanf(\"%d%d%d\",&x,&y,&z);\n            u[i+m]=x;v[i+m]=y;w[i+m]=-z;//\u866b\u6d1e\u662f\u6709\u5411\u7684 \n        }m+=W;//\u8fb9\u6570\u518d\u52a0\u4e0a\u866b\u6d1e\u6570\u91cf \n        for(int i=1;i<=n;i++)dis[i]=inf;\n        dis[1]=0;\n        for(int k=1;k<=n-1;k++){\n            for(int i=1;i<=m;i++){\n                if(dis[v[i]]>dis[u[i]]+w[i]){\n                    dis[v[i]]=dis[u[i]]+w[i];\n                }\n            }\n```\n}//\u8dd1\u4e00\u904dBellman-Ford\n\n```cpp\n        bool flag=false;\n        for(int i=1;i<=m;i++)\n            if(dis[v[i]]>dis[u[i]]+w[i])flag=true;//\u5224\u8d1f\u73af\uff0c\u518d\u8fdb\u884cn-1\u677e\u5f1b\uff0c\u8fd8\u80fd\u6210\u529f\u677e\u5f1b\uff0c\u5c31\u5b58\u5728\u8d1f\u73af \n        if(flag)cout<<\"YES\"<<endl;\n        else cout<<\"NO\"<<endl;//\u8f93\u51fa\n    }\n    return 0;\n}\n\n```",
        "postTime": 1502109497,
        "uid": 47220,
        "name": "fuking",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "SPFA\u5224\u8d1f\u73af~\n\n\u7ecf\u8fc7\u6b21\u6570\u5927\u4e8en\u65f6\uff0c\u8f93\u51fayes\u5373\u53ef~\n\n\uff08\u52a0\u8fb9\u7528\u4e86\u6570\u7ec4\u6a21\u62df\uff0c\u611f\u89c9\u5199\u5f97\u633a\u7b80\u6d01\u7684\u2026\u2026\uff09\n\n\uff08\u4e0d\u7528\u8003\u8651\u91cd\u8fb9\uff0c\u76f4\u63a5\u52a0\u5c31\u53ef\u4ee5\u4e86~\uff09\n\n\n  \n  \n  \n  \n```cpp\n#include<cstdio>  \n#include<cstring>  \n#include<iostream>  \n#include<queue>  \nusing namespace std;  \nint T,n,m,W,s,e,t,fi[10001],ne[10001],w[10001],v[10001],cnt,num[10001],tot[10001];  \nbool b[10001];  \nvoid add(int u,int vv,int val)  \n{  \n    w[++cnt]=vv;ne[cnt]=fi[u];fi[u]=cnt;v[cnt]=val;  \n}  \nvoid cal()  \n{  \n    for(int i=1;i<=n;i++) num[i]=999999999;  \n    queue<int> q;q.push(1);b[1]=1;num[1]=0;tot[1]=1;  \n    while(!q.empty())  \n    {  \n        int k=q.front();q.pop();b[k]=0;  \n        if(tot[k]>n)  \n        {  \n            printf(\"YES\\n\");return;  \n        }  \n        for(int j=fi[k];j;j=ne[j])  \n          if(num[w[j]]>v[j]+num[k])  \n          {  \n            num[w[j]]=v[j]+num[k];  \n            if(!b[w[j]])  \n            {  \n                q.push(w[j]);b[w[j]]=1;tot[w[j]]++;  \n            }  \n          }  \n    }  \n    printf(\"NO\\n\");  \n}  \nint main()  \n{  \n    scanf(\"%d\",&T);  \n    while(T--)  \n    {  \n        scanf(\"%d%d%d\",&n,&m,&W);  \n        memset(fi,0,sizeof(fi));  \n        memset(tot,0,sizeof(tot));  \n        memset(b,0,sizeof(b));cnt=0;  \n        for(int i=1;i<=m;i++)  \n        {  \n            scanf(\"%d%d%d\",&s,&e,&t);  \n            add(s,e,t);add(e,s,t);  \n        }  \n        for(int i=1;i<=W;i++)  \n        {  \n            scanf(\"%d%d%d\",&s,&e,&t);  \n            add(s,e,-t);  \n        }  \n        cal();  \n    }  \n    return 0;  \n}  \n\n```",
        "postTime": 1477386812,
        "uid": 16334,
        "name": "licone",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "//\u5224\u65ad\u6709\u65e0\u8d1f\u73af\u7684\u65b9\u6cd5\uff1a \n\n\u4e00\u4e2a\u70b9\u80cc\u7ecf\u8fc7n\u6b21\u4ee5\u4e0a\u5c31\u8bf4\u660e\u6709\u8d1f\u73af\uff0c\u6240\u4ee5\u8fd9\u4e2a\u9898\u53ea\u9700\u8981\u5728spfa\u7684\u57fa\u7840\u4e0a\u52a0\u4e00\u4e2a\u5224\u65ad\u5c31\u597d\u4e86\n\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<cstring>\n#include<cmath>\n#include<queue>\n#define INF 2000000000\nusing namespace std;\nconst int maxn=1000+100;\nconst int maxm=10000+100;\nstruct Edge{int u,v,w,next;};\nEdge e[maxm];\nint g[maxn],inq[maxn];\nint d[maxn],cnt[maxn];\nint N,M,W;\nvoid init(){\n    cin>>N>>M>>W;\n    int u,v,w;\n    memset(g,0,sizeof(g));//\u52ff\u5fd8 \n    for(int i=1;i<=M;i++){        \n        scanf(\"%d%d%d\",&u,&v,&w);\n        e[2*i-1]=(Edge){u,v,w,g[u]};g[u]=2*i-1;\n        e[2*i]=(Edge){v,u,w,g[v]};g[v]=2*i;\n    }\n    for(int i=1;i<=W;i++){\n        scanf(\"%d%d%d\",&u,&v,&w);\n        e[2*M+i]=(Edge){u,v,-w,g[u]};g[u]=2*M+i;\n    }\n}\nint spfa(int s){\n    queue<int>q;\n    memset(inq,0,sizeof(inq));\n    memset(cnt,0,sizeof(cnt));\n    for(int i=1;i<=N;i++) d[i]=INF;\n    d[s]=0;\n    q.push(s);\n    inq[s]=1;cnt[s]=1;\n    while(!q.empty()){\n        int u=q.front();q.pop();\n        inq[u]=0;\n        if(cnt[u]>N) return 1;\n        for(int i=g[u];i>0;i=e[i].next){\n            int v=e[i].v,w=e[i].w;\n            if(d[u]+w<d[v]){\n                d[v]=d[u]+w;\n                if(!inq[v]){\n                    q.push(v);\n                    inq[v]=1;\n                    cnt[v]++;\n                }\n            }\n        }    \n    }\n    return 0;\n}\nint main(){\n    int T;\n    cin>>T;\n    while(T--){\n        init();\n        if(spfa(1)) cout<<\"YES\\n\";\n        else cout<<\"NO\\n\";        \n    }\n    return 0;\n}\n```",
        "postTime": 1475044461,
        "uid": 19285,
        "name": "saisai",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "\u795e\u7287\u4eec\u90fd\u7528SPFA\uff0c\u849f\u84bb\u6765\u53d1\u4e2aBellman-Ford\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\nusing namespace std;\ndouble dis[5000],w[5000],minl;//w\u8bb0\u5f55\u8def\u7684\u957f\u5ea6\nint n,m,x,y,k,f[5000][3],s,t,len;//f\u8bb0\u5f55\u4e86\u8fb9\u7684\u4e24\u7aef\nint bh;\nbool black[5000];//\u5982\u679c\u662f\u9ed1\u6d1eblack[i]==1\nint hhh;\nbool flag;\nbool b[5000];\nint main(){\n    cin>>hhh;\n    for(int hhhh=0;hhhh<hhh;hhhh++){\n        flag=0;\n        cin>>n;\n        cin>>m;\n        cin>>bh;\n        for(int i=0;i<m;i++){\n            dis[i]=0xfffffff/3;\n            f[i][1]=f[i][2]=dis[i];\n        }\n        for(int i=0;i<m;i++){\n            cin>>x>>y>>len;\n            f[i][1]=x;f[i][2]=y;\n            w[i]=len;\n        }\n        for(int i=m;i<m+bh;i++){\n            cin>>x>>y>>len;\n            black[i]=1;\n            f[i][1]=x;f[i][2]=y;\n            w[i]=-len;\n        }\n        dis[0]=0;//\u5355\u72ec\u5224\u8d1f\u6743\u65f6\u4e0d\u9700\u8981\u5355\u72ec\u8bbe\u8d77\u59cb\u70b9\n        for(int i=0;i<n;i++){\n            for(int j=0;j<m+bh;j++){\n                if(dis[f[j][1]]+w[j]<dis[f[j][2]])dis[f[j][2]]=dis[f[j][1]]+w[j];\n                if(!black[j])if(dis[f[j][2]]+w[j]<dis[f[j][1]])dis[f[j][1]]=dis[f[j][2]]+w[j];\n            }\n        }\n        for(int j=0;j<m+bh;j++){//\u8981\u662f\u5b58\u5728\u4e00\u6761\u8fb9\uff08u,v\uff09\u8ba9dis[u]+w[u]<dis[v]\u5b58\u5728\u8d1f\u6743\n            if(dis[f[j][1]]+w[j]<dis[f[j][2]]){\n                if(!flag)\n                cout<<\"YES\"<<endl;\n                flag=1;\n            }\n            if(!black[j])if(dis[f[j][2]]+w[j]<dis[f[j][1]]){\n                if(!flag)//\u5c0f\u5fc3\uff01\uff01\u8fd9\u91cc\u5f88\u5bb9\u6613\u9519\uff01\uff01\n                cout<<\"YES\"<<endl;\n                flag=1;\n            }\n        }\n        if(!flag)cout<<\"NO\"<<endl;\n    }\n}\n```",
        "postTime": 1509627949,
        "uid": 38485,
        "name": "Erina",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    },
    {
        "content": "#\u90fd\u8bf4dfs\u7248\u7684spfa\u6bd4\u8f83\u5feb\uff0c\u53ef\u662f\u5468\u56f4\u7684\u795e\u7287\u4eecbfs\u90fd\u8fc7\u4e86\uff0c\u6211\u7684dfsT\u4e86\u4e24\u4e2a\u70b974\u5206\n\n##\u4e0d\u8981\u6284\u4ee3\u7801\u8fd9\u662f74\uff0174\uff0174\uff01\u8fc7\u4e0d\u4e86\u7684\n\n###\u5c31\u662f\u4e2a\u8d1f\u73af\u7684\u6a21\u677f\u9898\uff0c\u5927\u4f6c\u4eec\u8bf4\u8fd9\u9053\u9898\u5176\u5b9e\u7528bfs\u5c31\u884c\n\n\u52a0\u4e00\u4e0b\u535a\u5ba2\uff08\u53ef\u80fd\u505c\u66f4\uff0c\u4f46\u5927\u5bb6\u53ef\u4ee5\u53bb\u770b\u4e00\u4e0b\u53cb\u94fe\u91cc\u9762\u7684\u5927\u4f6c\uff09\n\n[\u777f\u5c11\u4e2a\u4eba\u535a\u5ba2](http://blog.ruishao.cf/)\n\n\u3001\u3001\u3001cpp\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define maxn 2510\nusing namespace std;\nstruct EDGE\n{\n    int next;\n    int to;\n    int co;\n}edge[maxn];\nint f,qr,n,m,w,a,b,l,head[maxn],dis[maxn],exist[maxn],flag;\nvoid add(int from,int to,int co)\n{\n    edge[++qr].next=head[from];\n    edge[qr].to=to;\n    edge[qr].co=co;\n    head[from]=qr;\n}\nint read()\n{\n    int x=0;\n    char ch=getchar();\n    while(ch<'0'||ch>'9') ch=getchar();\n    while(ch>='0'&&ch<='9')\n     {\n         x=x*10+ch-'0';\n         ch=getchar();\n     }\n    return x;\n}\nvoid dfs_spfa(int x)\n{\n    if(flag) return;\n    exist[x]=1;\n    for(int i=head[x];i;i=edge[i].next)\n     {\n         int v=edge[i].to;\n         if(dis[v]>dis[x]+edge[i].co)\n          {\n              dis[v]=dis[x]+edge[i].co;\n              if(flag||exist[v])\n               {\n                   flag=1;\n                   break;\n               }\n                else dfs_spfa(v);\n          }\n     }\n    exist[x]=0;\n}\nint main()\n{\n    f=read();\n    for(int o=1;o<=f;++o)\n     {\n         memset(dis,0,sizeof(dis));\n         memset(exist,0,sizeof(exist));\n         memset(head,0,sizeof(head));\n         qr=0;\n         n=read();m=read();w=read();\n         for(int i=1;i<=m;++i)\n          {\n              a=read();\n              b=read();\n              l=read();\n              add(a,b,l);\n              add(b,a,l);\n          }\n        for(int i=1;i<=w;++i)\n         {\n             a=read();\n             b=read();\n             l=read();\n             add(a,b,-l);\n         }\n        flag=0;\n        for(int i=1;i<=n;++i)\n         {\n             if(flag) break;\n            dfs_spfa(i);\n         }\n        if(flag) printf(\"YES\\n\");\n         else printf(\"NO\\n\");\n     }\n    return 0;\n}\n\u3001\u3001\u3001\n```",
        "postTime": 1505024261,
        "uid": 49851,
        "name": "\u777f\u5c7f\u9752\u886b",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2850 \u3010[USACO06DEC]\u866b\u6d1eWormholes\u3011"
    }
]
[
    {
        "content": "\u6211\u4eec\u8ba4\u4e3a $n,m$ \u540c\u7ea7\uff0c\u4e0b\u9762\u4e00\u5f8b\u5199\u4e3a $n$\uff1b\u4ee4 $v=\\max\\{a_i\\}$\u3002\n\nsol\uff1a$O(n(\\sqrt v+\\sqrt n))$ \u65f6\u95f4\uff0c$O(v+n)$ \u7a7a\u95f4\u3002\n\ncode\uff1a$O(n(\\sqrt v+\\sqrt n))$ \u65f6\u95f4\uff0c$O(v\\log v+n)$ \u7a7a\u95f4\uff08\u4e3a\u4e86\u5361\u5e38\u6570\uff0c\u6709\u4eba\u7528\u7ebf\u6027\u7a7a\u95f4\u8fc7\u9898\u4e86\u8bf7\u901a\u77e5\u6211\uff0c\u8c22\u8c22\uff01\uff09\u3002\n\n\u6839\u53f7\u5206\u6cbb\u3002\n\n\u6211\u4eec\u4ee4\u5206\u6cbb\u754c\u4e3a $\\Theta(\\sqrt v)$\u3002\n\n\u5f53 $k\\le \\sqrt v$ \u65f6\uff0c\u5c06\u6240\u6709 $k$ \u76f8\u540c\u7684\u8be2\u95ee\u540c\u65f6\u5904\u7406\u3002\u6b64\u65f6\u4f7f\u7528 $O(n)-O(\\sqrt v)$\uff08\u6ce8\u610f $O(\\sqrt v)$ \u662f\u4e2a\u4e0a\u754c\uff09 \u7684 RMQ \u6570\u636e\u7ed3\u6784\u5373\u53ef\u3002\u56e0\u4e3a\u8be2\u95ee\u662f $O(n)$ \u7ea7\u522b\uff0c\u5e8f\u5217\u957f\u5ea6\u603b\u548c\u4e3a $O(n\\sqrt v)$ \u7ea7\u522b\u7684\u3002\n\n\u5f53 $k> \\sqrt v$ \u65f6\uff0c\u679a\u4e3e $p=ck$\uff0c$p\\le v$\uff0c$c$ \u4e3a\u81ea\u7136\u6570\u3002\u6c42\u6240\u6709\u7684 $\\min\\{a_x-p|l\\le x\\le r\\land a_x\\ge p\\}$ \u7684 $\\min$ \u5373 $\\min\\{a_x|l\\le x\\le r\\land a_x\\ge p\\}-p$\uff0c\u5373 $p$ \u7684\u533a\u95f4\u4e0d\u4e25\u683c\u540e\u7ee7\uff08\u518d\u51cf\u53bb $p$\uff09\u3002\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u8fd9\u6837\u8f6c\u5316\u662f\u56e0\u4e3a\u672c\u8d28\u4e0a $a\\bmod b=a-cb,cb\\le a<(c+1)b$\uff0c\u7136\u540e\u867d\u7136\u8fd9\u6837\u505a\u6bcf\u4e2a\u6570\u8fdb\u884c\u4e86\u5927\u91cf\u975e\u53d6\u6a21\u64cd\u4f5c\uff0c\u4f46\u662f\u552f\u4e00\u7684\u4e00\u6b21\u53d6\u6a21\u64cd\u4f5c\u4e00\u5b9a\u5c0f\u4e8e\u5176\u4ed6\u7684\u975e\u53d6\u6a21\u64cd\u4f5c\u3002\n\n\u5173\u4e8e\u533a\u95f4\u4e0d\u4e25\u683c\u540e\u7ee7\u95ee\u9898\uff0c\u53ef\u4ee5\u901a\u8fc7\u5e8f\u5217\u548c\u8be2\u95ee\u540c\u6b65\u6392\u5e8f\u626b\u63cf\u7684\u65b9\u5f0f\u8f6c\u5316\u4e3a\u5355\u70b9\u4fee\u6539\u533a\u95f4 $\\min$ \u7684\u95ee\u9898\u3002\u5177\u4f53\u7684\uff0c\u8be2\u95ee\u6309 $p$ \u6392\u5e8f\uff0c\u5e8f\u5217\u4e5f\u9700\u6392\u5e8f\u3002\u679a\u4e3e\u8be2\u95ee\u3002\u7ef4\u62a4\u4e00\u4e2a\u5355\u8c03\u9012\u51cf\u7684\u5728\u5e8f\u5217\u4e0a\u7684\u6307\u9488\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $p$\uff0c\u901a\u8fc7\u6307\u9488\u5355\u8c03\u79fb\u52a8\u5c06\u5e8f\u5217\u4e2d\u7684\u5927\u4e8e\u7b49\u4e8e $p$ \u7684\u6570\u52a0\u5165\u6570\u636e\u7ed3\u6784\u4e2d\u3002\u90a3\u4e48\u6b64\u65f6\u6570\u636e\u7ed3\u6784\u4e2d\u7ef4\u62a4\u7684\u6570\u5c31\u662f\u6240\u6709\u5927\u4e8e\u7b49\u4e8e $p$ \u7684\u6570\uff0c\u533a\u95f4 $\\min$ \u5373\u4e3a $p$ \u7684\u533a\u95f4\u540e\u7ee7\u3002\n\n\u6ce8\u610f\u5230\u4fee\u6539 $\\Theta(n)$ \u6b21\u800c\u67e5\u8be2 $O(n\\sqrt v)$ \u6b21\uff0c\u6240\u4ee5\u5141\u8bb8\u4fee\u6539\u65f6\u95f4\u590d\u6742\u5ea6\u5347\u9ad8\u3002\u53ef\u4ee5\u901a\u8fc7\u5206\u5757\u964d\u4f4e\u732b\u6811\uff08\u4e8c\u533a\u95f4\u5408\u5e76\uff09\u66f4\u65b0\u590d\u6742\u5ea6\u7684\u65b9\u5f0f\u505a\u5230\u3002\u5373\u7ef4\u62a4\u6bcf\u5757\u7684\u524d\u7f00\u540e\u7f00 $\\min$\uff0c\u548c\u6574\u5757\u7684 $\\min$ \u7ec4\u6210\u7684\u957f\u5ea6\u4e3a $\\Theta(\\sqrt n)$ \u7684\u5e8f\u5217\u7684\u732b\u6811\u3002\n\n\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u82e5 $l,r$ \u5728\u540c\u4e00\u4e2a\u5757\u4e2d\uff0c\u5219\u76f4\u63a5\u66b4\u529b\uff08\u8fd9\u5b9e\u8d28\u4e0a\u662f\u7b2c\u4e8c\u4e2a\u6839\u53f7\u5206\u6cbb\uff0c\u4e0d\u662f\u201c\u533a\u95f4\u4e0d\u4e25\u683c\u540e\u7ee7\u201d\u66b4\u529b\uff0c\u800c\u662f\u76f4\u63a5\u6309\u9898\u66b4\u529b\uff0c\u5373\u4e0d\u8fdb\u5165 $k>\\sqrt v$ \u7684\u6839\u53f7\u5206\u6cbb\uff09\uff0c\u590d\u6742\u5ea6\u4e3a $O(\\sqrt n)$\uff1b\u5426\u5219\u7531\u5de6\u5757\u7684\u540e\u7f00\uff0c\u53f3\u5757\u7684\u524d\u7f00\u548c\u732b\u6811\u7ef4\u62a4\u7684\u4e2d\u95f4\u5757\u7ec4\u6210\u3002\u66f4\u65b0\u524d\u7f00\u540e\u7f00\u590d\u6742\u5ea6\u4e3a $O(\\sqrt n)$\uff0c\u66f4\u65b0\u732b\u6811\u7684\u590d\u6742\u5ea6\u4ecd\u4e3a $\\Theta(\\sqrt n)$\u3002\u6240\u4ee5\u6b64\u65f6\u505a\u5230\u4e86 $O(n(\\sqrt v+\\sqrt n))$ \u7684\u590d\u6742\u5ea6\u3002\n\n\u53e6\u5916\u679a\u4e3e $p$ \u65f6\u4e0d\u80fd\u628a\u6bcf\u4e2a\u8be2\u95ee\u90fd\u5b58\u4e0b\u6765\uff0c\u5426\u5219\u7a7a\u95f4\u590d\u6742\u5ea6\u4f1a\u9000\u5316\u3002\n\n\u5361\u5e38\u6570\u5927\u5bb6\u5c31\u5404\u663e\u795e\u901a\u5427\uff08\u6d41\u6c57\u9ec4\u8c46\n\n\u4ee3\u7801\u4e0d\u653e\u4e86\uff0c\u9700\u8981\u8005\u79c1\u4fe1\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/73iq08qk.png)",
        "postTime": 1618376082,
        "uid": 203623,
        "name": "Ntokisq",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P7811 \u4f60\u7684\u540d\u5b57\u3002"
    },
    {
        "content": "> \u9898\u76ee\u94fe\u63a5\uff1a[P7811 [JRKSJ R2] \u4f60\u7684\u540d\u5b57\u3002](https://www.luogu.com.cn/problem/P7811)\n\n> **\u672c\u9898\u89e3\u540c\u6b65\u53d1\u5e03\u4e8e [My Blog](http://www.cxy07.blog/index.php/archives/123/)**\n\n\u9898\u610f\uff1a\n\n> \u7ed9\u5b9a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217 $\\{a_n\\}$\uff0c\u5171 $m$ \u7ec4\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee\u4e00\u4e2a\u533a\u95f4 $[l,r]$ \u4e2d\uff0c\u5728 $\\bmod\\  k$ \u610f\u4e49\u4e0b\u7684\u6700\u5c0f\u503c\u3002\n\n> $1\\le n,m\\le 3\\times 10^5, 1\\le a_i\\le 10^5$\u3002\n\n~~\u53d7\u4e0d\u4e86\u4e86\u6839\u672c\u5361\u4e0d\u52a8~~\n\n\u8fd9\u9898\u6211\u66fe\u7ecf\u81ea\u5df1\u7f16\u51fa\u6765\u8fc7\uff0c\u4f46\u53ea\u4f1a $\\mathcal{O}(n\\sqrt{n\\log n})$\u3002/kk\n\n\u8003\u8651\u6839\u53f7\u5206\u6cbb\u3002\u8bbe\u4e00\u4e2a\u9608\u503c $V$\uff0c\u5206\u522b\u8003\u8651 $k>V$ \u548c $k\\le V$ \u7684\u8be2\u95ee\u3002\n\n\u5bf9\u4e8e $k\\le V$ \u7684\u8be2\u95ee\uff0c\u672c\u8d28\u4e0d\u540c\u7684 $k$ \u53ea\u6709 $V$ \u79cd\u3002\u56e0\u6b64\u53ef\u4ee5\u5c06\u5176\u4e2d $k$ \u76f8\u540c\u7684\u62ff\u51fa\u6765\u4e00\u8d77\u505a\u3002\u5bf9\u4e8e\u4e00\u4e2a\u56fa\u5b9a\u7684 $k$\uff0c\u8bbe $b_i=a_i\\bmod k$\uff0c\u4f7f\u7528\u5206\u5757\u6216\u7ebf\u6bb5\u6811\u7b49 $\\mathcal{O}(n)$ \u9884\u5904\u7406\u7684\u6570\u636e\u7ed3\u6784\u8fdb\u884c\u7ef4\u62a4\u5373\u53ef\u3002\u8fd9\u91cc\u7684\u590d\u6742\u5ea6\u662f $\\mathcal{O}(nV+m\\log n)$ \u6216 $\\mathcal{O}(nV+m\\sqrt{n})$\u3002\n\n\u5bf9\u4e8e $k>V$ \u7684\u8be2\u95ee\uff0c\u8003\u8651\u5230 $a\\bmod k=a-ck$\uff0c\u6240\u4ee5\u8003\u8651\u679a\u4e3e $k$ \u7684\u500d\u6570 $ck$\uff0c\u7136\u540e\u5bfb\u627e\u4e00\u4e2a $a_i$ \u4f7f\u5f97 $a_i\\ge ck$ \u4e14 $a_i - ck$ \u6700\u5c0f\u3002\u4e0d\u96be\u53d1\u73b0\u4e00\u4e2a\u8be2\u95ee\u4f1a\u53d8\u6210 $\\mathcal{O}(\\dfrac{10^5}{V})$ \u4e2a\u4e0a\u8ff0\u95ee\u9898\u3002\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u4e00\u4e0b\u7a7a\u95f4\u3002\n\n\u8003\u8651\u5c06\u5e8f\u5217\u4e2d\u7684\u5143\u7d20\u964d\u5e8f\u6392\u5e8f\uff0c\u6240\u6709\u8be2\u95ee\u4e5f\u964d\u5e8f\u6392\u5e8f\uff0c\u53cc\u6307\u9488\u7ef4\u62a4\uff0c\u4f9d\u6b21\u5c06 $\\ge k$ \u7684\u5143\u7d20\u63d2\u5165\u5e8f\u5217\uff0c\u7136\u540e\u8be2\u95ee\u533a\u95f4\u6700\u5c0f\u503c\u5373\u53ef\u5b8c\u6210\u4e0a\u8ff0\u95ee\u9898\u3002\n\n\u4e0a\u8ff0\u95ee\u9898\u4e2d\uff0c\u63d2\u5165\u53ea\u6709 $\\mathcal{O}(n)$ \u6b21\uff0c\u800c\u8be2\u95ee\u6709 $\\mathcal{O}(\\dfrac{10^5m}{V})$ \u6b21\uff0c\u56e0\u6b64\u8003\u8651\u628a\u63d2\u5165\u7684\u590d\u6742\u5ea6\u53d8\u9ad8\u4e9b\u4ee5\u5e73\u8861\u67e5\u8be2\u7684\u590d\u6742\u5ea6\u3002\n\n\u8003\u8651\u4f7f\u7528\u732b\u6811\u7684\u601d\u60f3\uff0c\u505a\u5230 $\\mathcal{O}(1)$ \u7684\u67e5\u8be2\u3002\u4f46\u732b\u6811\u7684\u63d2\u5165\u662f $\\mathcal{O}(n)$ \u7684\uff0c\u65e0\u6cd5\u63a5\u53d7\u3002\u56e0\u6b64\u5148\u5206\u5757\uff0c\u5728\u5206\u5757\u7684\u7ed3\u6784\u4e0a\u5957\u4e00\u4e2a\u732b\u6811\uff0c\u6bcf\u6b21\u63d2\u5165\u4e00\u4e2a\u5143\u7d20\u540e\u66f4\u65b0\u6574\u5757\u7684\u503c\uff0c\u518d\u8bb0\u5f55\u6bcf\u4e2a\u5757\u7684\u524d\u7f00\u3001\u540e\u7f00 $\\min$\uff0c\u5c31\u53ef\u4ee5\u505a\u5230 $\\mathcal{O}(\\sqrt{n})$ \u7684\u63d2\u5165\uff0c$\\mathcal{O}(1)$ \u7684\u67e5\u8be2\u3002\n\n\u56e0\u6b64\u6b64\u90e8\u5206\u662f $\\mathcal{O}(n\\sqrt{n}+\\dfrac{10^5m}{V})$\u3002\n\n\u53d1\u73b0 $V$ \u53d6 $\\sqrt{10^5}$ \u590d\u6742\u5ea6\u8fbe\u5230\u6700\u4f18\uff0c\u6700\u540e\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\mathcal{O}((n+m)\\sqrt{n}+m\\sqrt{10^5})$\u3002~~\u4ee3\u7801\u5148\u4e0d\u653e\u4e86 \u56e0\u4e3a\u672c\u4eba\u8fd8\u6ca1\u5361\u8fc7~~",
        "postTime": 1629460814,
        "uid": 53489,
        "name": "CXY07",
        "ccfLevel": 9,
        "title": "\u3010\u9898\u89e3\u3011[JRKSJ R2] \u4f60\u7684\u540d\u5b57\u3002"
    },
    {
        "content": "## \u524d\u8a00\n\u66b4\u529b\u65e5\u8fc7\u53bb\u4e86\u3002\n## \u6b63\u7247\n\u4e00\u770b\u5230\u9759\u6001\u533a\u95f4\u67e5\u8be2\u4e00\u4e2a\u83ab\u961f\u4e00\u4e0b\u5b50\u62cd\u4e0a\u53bb\u4e86\u554a\uff1f\n\n\u770b\u5230\u4e00\u4e2a $k>10^3$ \u7684\u5305\uff0c\u6211\u4eec\u8003\u8651 $k$ \u5f88\u5927\u7684\u65f6\u5019\u6709\u6ca1\u6709\u7279\u6b8a\u6027\u8d28\u3002\n\n\u6ce8\u610f\u5230\u503c\u57df\u53ea\u6709 $10^5$\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5305\u7684\u610f\u4e49\u5c31\u662f\u7ef4\u62a4\u4e00\u4e2a ``bitset`` \u7136\u540e\u6bcf\u6b21\u76f4\u63a5\u66b4\u529b\u627e\u6700\u63a5\u8fd1\u7684\u6570\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\sqrt m+\\frac{ma}{w}+\\frac{ma}{k})$\uff0c\u5b9e\u73b0\u7684\u65f6\u5019\u53ef\u4ee5\u7528 ``_Find_first`` \u548c ``_Find_next`` \u6765\u5077\u61d2\u3002\n\n\u90a3 $k$ \u6bd4\u8f83\u5c0f\u7684\u65f6\u5019\u548b\u505a\u5462\uff1f~~\u76f4\u63a5\u9608\u503c\u5206\u6cbb\u8dd1 ``bitset``\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\sqrt{km}+mk)$~~ \u4f46\u662f\u5176\u5b9e\u8fd9\u5c31\u662f\u4e2a RMQ \u554a\uff1f\u6211\u4eec\u76f4\u63a5\u4e0a\u56db\u6bdb\u5b50\u5c31\u662f $O(nk+m)$ \u7684\u4e86\u3002\u6ce8\u610f\u8fd9\u91cc\u4e00\u5b9a\u4e0d\u80fd\u7528\u4f20\u7edf\u7684\u500d\u589e ST \u8868\u56e0\u4e3a\u590d\u6742\u5ea6\u4f1a\u591a\u4e2a $\\log$\u3002\n\n\u7136\u540e\u6211\u4eec\u60ca\u5947\u5730\u53d1\u73b0\u8fd9\u73a9\u610f\u597d\u50cf\u80fd\u8fc7\uff0c\u8bbe\u9608\u503c\u4e3a $B$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(nB+\\frac{ma}{w}+n\\sqrt m+\\frac{ma}{B}+mB)$\uff0c$B$ \u53d6 $\\sqrt a$ \u662f\u6700\u4f18\u7684\uff0c\u603b\u590d\u6742\u5ea6\u4e3a $O(n\\sqrt a+m\\sqrt a+n\\sqrt m+\\frac{na}{w})$\uff0c\u662f\u4e0d\u662f\u770b\u8d77\u6765\u5c31\u5f88\u5947\u602a\uff0c\u5c0f\u7f16\u4e5f\u975e\u5e38\u60ca\u8bb6\u3002\n## \u4ee3\u7801\n~~\u9876\u7897\u4eba\u4ee3\u5199~~ \u539f\u6765\u6211\u5c31\u662f\u9876\u7897\u4eba\u5440\uff01\n\n\u88ab\u5361\u5e38\u4e86\uff0c\u52a0\u4e86\u4e2a\u7279\u5224\u624d\u8fc7\u53bb\u3002\n\n\u503c\u5f97\u4e00\u63d0\u7684\u662f\u6211 $k$ \u5f88\u5c0f\u7684\u65f6\u5019\u771f\u7684\u8dd1\u4e86\u9608\u503c\u5206\u6cbb ``bitset``\uff0c\u5c45\u7136\u6ca1\u88ab\u5361\uff01\n\n\u5341\u51e0\u5206\u949f\u5199\u7684\uff0c\u4ee3\u7801\u6709\u70b9\u4e11\u89c1\u8c05\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ninline int read(){\n   int s=0,w=1;\n   char ch=getchar();\n   while(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n   while(ch>='0'&&ch<='9') s=s*10+ch-'0',ch=getchar();\n   return s*w;\n}\nconst int S=256;\nstruct query\n{\n\tint l,r,b,id,pos;\n\tbool operator<(const query &lxl)const\n\t{return (pos<lxl.pos)||(pos==lxl.pos&&((pos&1)?r<lxl.r:r>lxl.r));}\n};\nvector<query> v[256];\nint a[300003],cnt[100003],A[300003],ans[300003];\nbitset<100003> f;\nint main()\n{\n    int n=read(),m=read();\n    for(int i=1; i<=n; i++) a[i]=read();\n    for(int l,r,b,i=1; i<=m; ++i)\n    {\n    \tl=read(),r=read(),b=read();\n    \tif(b<S) v[b].push_back((query){l,r,0,i,0});\n\t\telse v[0].push_back((query){l,r,b,i,0});\n\t}\n\tfor(int i=2; i<S; i++)\n\t{\n\t\tif(!v[i].size()) continue;\n\t\tint bl=n/sqrt((int)v[i].size()+1)+1;\n\t\tfor(int j=1; j<=n; ++j) A[j]=a[j]%i;\n\t\tfor(int j=0; j<v[i].size(); ++j) v[i][j].pos=v[i][j].l/bl;\n\t\tsort(v[i].begin(),v[i].end());\n\t\tfor(int j=0,l=1,r=0; j<v[i].size(); ++j)\n\t\t{\n\t\t\twhile(l>v[i][j].l) (!cnt[A[--l]]++)&&(f[A[l]]=1);\n\t\t\twhile(r<v[i][j].r) (!cnt[A[++r]]++)&&(f[A[r]]=1);\n\t\t\twhile(l<v[i][j].l) (!--cnt[A[l]])&&(f[A[l]]=0),++l;\n\t\t\twhile(r>v[i][j].r) (!--cnt[A[r]])&&(f[A[r]]=0),--r;\n\t\t\tfor(int k=0; k<i; ++k) if(f[k]) {ans[v[i][j].id]=k;break;}\n\t\t}\n\t\tf.reset(),memset(cnt,0,sizeof(cnt));\n\t}\n\tif(v[0].size())\n\t{\n\t\tint bl=n/sqrt((int)v[0].size()+1)+1;\n\t\tfor(int j=0; j<v[0].size(); ++j) v[0][j].pos=v[0][j].l/bl;\n\t\tsort(v[0].begin(),v[0].end());\n\t\tfor(int j=0,l=1,r=0; j<v[0].size(); ++j)\n\t\t{\n\t\t\twhile(l>v[0][j].l) (!cnt[a[--l]]++)&&(f[a[l]]=1);\n\t\t\twhile(r<v[0][j].r) (!cnt[a[++r]]++)&&(f[a[r]]=1);\n\t\t\twhile(l<v[0][j].l) (!--cnt[a[l]])&&(f[a[l]]=0),++l;\n\t\t\twhile(r>v[0][j].r) (!--cnt[a[r]])&&(f[a[r]]=0),--r;\n\t\t\tans[v[0][j].id]=0x3f3f3f3f;\n\t\t\tfor(int k=f._Find_first(); ans[v[0][j].id]&&k!=f.size(); k=(k/v[0][j].b+1)*v[0][j].b-1>=f.size()?f.size():f._Find_next((k/v[0][j].b+1)*v[0][j].b-1)) \n\t\t\t\t(ans[v[0][j].id]>k%v[0][j].b)&&(ans[v[0][j].id]=k%v[0][j].b);\n\t\t}\n\t}\t\n\tfor(int i=1; i<=m; i++) printf(\"%d\\n\",ans[i]);\n    return 0;\n}\n```",
        "postTime": 1641392572,
        "uid": 111055,
        "name": "dead_X",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P7811"
    },
    {
        "content": "\u4e00\u79cd\u8f83\u4e3a\u7b80\u5355\u7684\u601d\u8def\uff1f\u867d\u7136\u590d\u6742\u5ea6\u7a0d\u52a3\u3002\n\n\u8003\u8651\u4ee5 $B$ \u5206\u5757\uff0c\u6bcf\u4e2a\u8be2\u95ee\u5bf9\u4e8e\u6563\u5757\u6211\u4eec\u66b4\u529b\u5904\u7406\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u6574\u5757\uff0c\u8003\u8651\u9884\u5904\u7406\u51fa\u6bcf\u4e2a $k$ \u7684\u7b54\u6848\u3002\n\n\u8bbe\u8be5\u6574\u5757\u4e2d\u7684\u6570\u96c6\u4e3a $S$\u3002\u5bb9\u6613 $O(V)$ \u9884\u5904\u7406\u51fa $dis_x=\\min\\{y\\in S:y\\geq x\\}-x$\u3002\n\n\u90a3\u4e48\u67d0\u4e2a $k$ \u7684\u7b54\u6848\u5373\u4e3a $ans_k=\\min\\{dis_x:k|x\\}$\u3002\u4f7f\u7528\u9ad8\u7ef4\u540e\u7f00\u548c\u5373\u53ef\u5728 $O(V\\log\\log V)$ \u7684\u65f6\u95f4\u5185\u9884\u5904\u7406\u51fa\u6240\u6709 $ans_k$\u3002\n\n\u89c6 $n,m$ \u540c\u9636\uff0c\u90a3\u4e48\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(nB+\\frac {n^2}B+\\frac nBV\\log\\log V)$\u3002\n\n\u53d6 $B=\\sqrt{n+V\\log\\log V}$ \u5f97\u5230 $O(n\\sqrt{n+V\\log\\log V})$\u3002\n\n[\u9700\u8981\u3001\u5361\u5e38\u3002](https://paste.ubuntu.com/p/tSPQKXNDdy/)",
        "postTime": 1668482580,
        "uid": 118318,
        "name": "ez_lcw",
        "ccfLevel": 0,
        "title": "\u62c9\u80ef\u505a\u6cd5"
    },
    {
        "content": "### \u9898\u89e3\n\n\u5b8c\u5168\u8fc7\u4e0d\u53bb\u505a\u6cd5\u3002\n\n\u8bbe $n,m$ \u540c\u9636\uff0c\u503c\u57df\u4e3a $w$\uff0c\u8003\u8651\u5bf9 $k$ \u6839\u53f7\u5206\u6cbb\u3002\n\n\u5bf9\u4e8e\u5c0f\u4e8e\u9608\u503c $B$ \u7684 $k$\uff0c\u8003\u8651\u5206\u5757\uff0c\u679a\u4e3e\u6bcf\u4e00\u4e2a\u4f5c\u4e3a\u6a21\u6570\u7684 $i$\uff0c\u5904\u7406\u51fa\u5757\u5185 $\\bmod i$ \u7684\u6700\u5c0f\u503c\uff0c\u67e5\u8be2\u65f6\u904d\u5386\u6bcf\u4e2a\u6574\u5757\uff0c\u679a\u4e3e\u6563\u5757\u4e2d\u6bcf\u4e00\u4e2a\u6570\uff0c\u8bbe\u5757\u957f\u4e3a $\\sqrt n$\uff0c\u9884\u5904\u7406\u662f $O(nB)$ \u7684\uff0c\u67e5\u8be2\u662f $O(\\sqrt n)$ \u7684\uff0c\n\n\u5bf9\u4e8e\u5927\u4e8e\u9608\u503c\u7684 $k$\uff0c\u8003\u8651\u6700\u7ec8\u7b54\u6848\u662f\u5c06\u8be2\u95ee\u533a\u95f4\u4e2d\u7684\u6240\u6709\u5143\u7d20 $a_i$ \u5199\u6210 $kx + b$ \u7684\u5f62\u5f0f\u540e\uff0c$b$ \u7684\u6700\u5c0f\u503c\uff0c\u65b9\u4fbf\u8d77\u89c1\uff0c\u8fd9\u91cc\u7684 $x$ \u53ef\u4ee5\u53d6\u4efb\u610f\u5c0f\u4e8e $\\lfloor \\frac{a_i}{k} \\rfloor$ \u7684\u503c\uff0c\u663e\u7136\uff0c$x \\not = \\lfloor \\frac{a_i}{k} \\rfloor$ \u4e00\u5b9a\u662f\u4e0d\u4f18\u7684\uff0c\u7531\u4e8e $k > B$ \uff0c\u5219 $x$ \u6709 $O(\\frac{w}{B})$ \u79cd\u53d6\u503c\u3002\n\n\u6211\u4eec\u66b4\u529b\u679a\u4e3e $kx$ \uff0c\u6b64\u65f6\u5f97\u5230\u7684\u6700\u5c0f\u7684 $b$ \u4e00\u5b9a\u662f\u5927\u4e8e $kx$ \u7684\u6240\u6709\u5143\u7d20\u4e2d\u6700\u5c0f\u7684\u503c\u51cf\u53bb $kx$ \u3002\u5c06\u8be2\u95ee\u79bb\u7ebf\u4e0b\u6765\uff0c\u4ece\u5927\u5230\u5c0f\u52a8\u6001\u5730\u4f9d\u6b21\u5c06\u6bcf\u4e2a\u6570\u63d2\u5165\u5230\u5e8f\u5217\u4e2d\uff0c\u518d\u7ef4\u62a4\u533a\u95f4\u6700\u5c0f\u503c\u5c31\u53ef\u4ee5\u89e3\u51b3\u95ee\u9898\u3002\n\n\u6709\u4e00\u4e2a\u5c5e\u4e8e\u6211\u8fd9\u79cd\u666e\u53ca\u7ec4\u9009\u624b\u7684\u89e3\u6cd5\uff0c\u7528\u7ebf\u6bb5\u6811\u8fdb\u884c $O(n)$ \u6b21\u4fee\u6539\u548c $O(\\frac{nw}{B})$ \u6b21\u67e5\u8be2\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u522b\u4e3a $O(n\\log n)$ \u548c $O(\\frac{nw}{B}\\log n)$\uff0c\u53d6 $B = \\sqrt {w\\log n}$\uff0c\u5c31\u6709\u4e00\u4e2a\u590d\u6742\u5ea6\u4e3a $n \\sqrt {w \\log n}$ \u7684\u663e\u7136\u505a\u6cd5\u3002\n\n\u7136\u800c\u8fd9\u975e\u5e38\u4e0d\u6839\u53f7\u5e73\u8861\uff0c\u56e0\u6b64\u8fd9\u80af\u5b9a\u662f\u4e0d\u4f18\u7684\u3002\u8003\u8651\u4fee\u6539\u7684\u590d\u6742\u5ea6\u5f88\u4f4e\uff0c\u800c\u67e5\u8be2\u7684\u590d\u6742\u5ea6\u5f88\u9ad8\uff0c\u90a3\u8003\u8651\u4f7f\u7528\u4e00\u4e2a\u4fee\u6539\u53ef\u4ee5\u5e26\u6839\u53f7\u800c\u67e5\u8be2\u662f $O(1)$ \u7684\u7b97\u6cd5\u6765\u89e3\u51b3\u5e26\u4fee RMQ \u95ee\u9898\uff0c\u4e8b\u5b9e\u4e0a\u8fd9\u662f\u53ef\u884c\u7684\u3002\n\n\u6211\u4eec\u518d\u6b21\u8003\u8651\u5206\u5757\uff0c\u8bbe\u5757\u957f\u4e3a $\\sqrt n$\uff0c\u5219\u6211\u4eec\u6709\u6bcf\u6b21\u4fee\u6539 $O(\\sqrt n)$\uff0c\u67e5\u8be2 $O(1)$ \u7684\u5e26\u4fee RMQ\u3002\u89c2\u5bdf\u5230\u6211\u4eec\u53ef\u4ee5\u79bb\u7ebf\u5904\u7406\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u5757\u800c\u8a00\uff0c\u7ef4\u62a4\u5176\u524d\u540e\u7f00\u6700\u5c0f\u503c\uff0c\u53ef\u4ee5\u505a\u5230 $O(\\sqrt n)$\u3002\u5bf9 $O(\\sqrt n)$ \u4e2a\u5757\u95f4\u5efa\u7acb\u4e00\u68f5\u7b1b\u5361\u5c14\u6811\uff0c\u6bcf\u6b21\u4fee\u6539\u65f6\u66f4\u65b0\u5757\u5185\u6700\u5c0f\u503c\uff0c\u5c06\u7b1b\u5361\u5c14\u6811\u66b4\u529b\u91cd\u6784\u3002\u76f8\u4fe1\u6ca1\u6709\u4eba\u4e0d\u77e5\u9053\uff0c\u67e5\u8be2\u65f6\u4e24\u70b9\u95f4\u7684 LCA \u7684\u5757\u5185\u6700\u5c0f\u503c\u5c31\u662f\u7b54\u6848\uff0c\u4f7f\u7528 tarjan \u7b97\u6cd5\u79bb\u7ebf\u67e5\u8be2 LCA \u53ef\u4ee5\u505a\u5230 $O(1)$ \u7684\u590d\u6742\u5ea6\u67e5\u8be2\u3002\n\n\u89c2\u5bdf\u5230\uff0c\u5bf9\u4e8e\u6211\u4eec\u679a\u4e3e $i = kx$ \u65f6\uff0c\u7531\u4e8e\u6709\u5176\u7ea6\u6570\u4e2a\u6570\u7684\u9650\u5236\uff0c\u6240\u6d89\u53ca\u5230\u7684\u8be2\u95ee\u81f3\u591a\u6709 $O(n\\log n)$ \u4e2a\uff0c\u56e0\u6b64\u79bb\u7ebf\u8be2\u95ee\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u3002\n\n\u7136\u800c\u7406\u8bba\u4e0a\u6765\u8bb2\u8fd9\u4e2a\u505a\u6cd5\u53ef\u4ee5\u505a\u5230\u7ebf\u6027\u7a7a\u95f4\uff0c\u89c2\u5bdf\u5230\u5f88\u660e\u663e\u552f\u4e00\u7a7a\u95f4\u590d\u6742\u5ea6\u5e26 $\\log$ \u7684\u5730\u65b9\u662f\u79bb\u7ebf\u8be2\u95ee\uff0c\u628a\u7b1b\u5361\u5c14\u6811\u6362\u6210\u5728\u7ebf\u7684 Method of Four Russians \u6765\u5728\u7ebf\u5904\u7406 RMQ \u5c31\u884c\u4e86\u3002\n\n\u6b64\u65f6\u4fee\u6539\u590d\u6742\u5ea6\u4e3a $n \\sqrt n$\uff0c\u67e5\u8be2\u590d\u6742\u5ea6\u4e3a $O(\\frac{nw}{B})$\uff0c\u53d6 $B = \\sqrt w$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n \\sqrt n + n \\sqrt w)$\u3002\n\n### \u4ee3\u7801\n\n\u7531\u4e8e\u8fd9\u79cd\u79bb\u8c31\u505a\u6cd5\u7684\u5e38\u6570\u975e\u5e38\u5927\uff0c\u4ee3\u7801\u4e0d\u80fd\u901a\u8fc7\u672c\u9898\uff0c\u4ec5\u4f9b\u53c2\u8003\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<cstring>\n#include<climits>\n#include<vector>\n#include<algorithm>\n#define MAXN 300005\n#define re register\n\n#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,tune=native\")\n\nconst int SZ1=300000000,SZ2=100000000;\nchar ibuf[SZ1],*p1;\nchar obuf[SZ2],*p2;\ninline void putc(const char x){*p2++=x;}\n\ntemplate <typename T>\n\ninline void read(T & s){\n\ts=0; char ch=*p1++;\n\twhile(!std :: isdigit(ch)) ch=*p1++;\n\twhile(std :: isdigit(ch)) s=(s<<3)+(s<<1)+(ch^48),ch=*p1++;\n}\n\ntemplate <typename T>\n\ninline void WT(T x){\n\tif(x>9) WT(x/10);\n\tputc(x%10+48);\n}\n\ntemplate <typename T>\n\ninline void write(const T & x){\n\tWT(x);\n\tputc('\\n');\n}\n\nusing namespace std;\n\nconst int S1=505,S2=567,S3=1090;\n\nint n,m,a[MAXN],L[MAXN],R[MAXN],ans[MAXN];\n\nstruct node{\n\tint l,r,k,id;\n\tbool operator < (const node & b) const { return k<b.k; }\n}q[MAXN];\n\nstruct seg{\n\tint l,r,mn;\n}tree[MAXN<<2];\n\nnamespace Solve1{\n\t\n\tint blk[MAXN],bl[MAXN/S2+2],br[MAXN/S2+2],blkcnt;\n\t\n\tint mn[MAXN/S2+2][S1+2];\n\t\n\tinline void Init(int N){\n\t\tfor(re int i=1;i<=n;i++)\n\t\t\tblk[i]=(i-1)/S2+1;\n\t\tblkcnt=blk[n];\n\t\tfor(re int i=1;i<=blkcnt;i++)\n\t\t\tbl[i]=(i-1)*S2+1,br[i]=i*S2;\n\t\tbr[blkcnt]=n;\n\t\tmemset(mn,0x3f,sizeof(mn));\n\t\tfor(re int i=1;i<=blkcnt;i++){\n\t\t\tfor(re int k=1;k<=N;k++){\n\t\t\t\tfor(re int j=bl[i];j<=br[i];j++){\n\t\t\t\t\tmn[i][k]=min(mn[i][k],a[j]%k);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tinline int query(int idx){\n\t\tint ret=INT_MAX,l=q[idx].l,r=q[idx].r,k=q[idx].k;\n\t\tif(blk[l]==blk[r]){\n\t\t\tfor(int i=l;i<=r;i++) ret=min(ret,a[i]%k);\n\t\t\treturn ret;\n\t\t}\n\t\tfor(re int i=l;i<=br[blk[l]];i++) ret=min(ret,a[i]%k);\n\t\tfor(re int i=bl[blk[r]];i<=r;i++) ret=min(ret,a[i]%k);\n\t\tfor(re int i=blk[l]+1;i<blk[r];i++) ret=min(ret,mn[i][k]);\n\t\treturn ret;\n\t}\n\t\n}\n\nnamespace Solve2{\n\t\n\tint blk[MAXN],bl[MAXN/S3+2],br[MAXN/S3+2],blkcnt;\n\t\n\tint lc[MAXN/S3+2],rc[MAXN/S3+2],fa[MAXN/S3+2],val[MAXN/S3+2];\n\n\tint pr[MAXN],suf[MAXN];\n\n\tint stk[MAXN/S3+2],top=0;\n\t\n\tvector <int> v[MAXN];\n\t\n\tstruct lk{\n\t\tint nxt,to,idx;\n\t}link[MAXN*25];\n\n\tint head[MAXN/S3+2],rt,dfn[MAXN/S3+2],dfncnt=0,nodecnt=0,Now;\n\t\n\tint Find(int x) { return x==fa[x]?x:fa[x]=Find(fa[x]); }\n\t\n\tinline void Init(){\n\t\tfor(re int i=1;i<=n;i++)\n\t\t\tblk[i]=(i-1)/S3+1;\n\t\tblkcnt=blk[n];\n\t\tfor(re int i=1;i<=blkcnt;i++)\n\t\t\tbl[i]=(i-1)*S3+1,br[i]=i*S3;\n\t\tbr[blkcnt]=n;\n\t}\n\t\n\tinline void modify(int pos,int vl){\n\t\tfor(re int i=pos;i<=br[blk[pos]];i++) pr[i]=vl;\n\t\tfor(re int i=bl[blk[pos]];i<=pos;i++) suf[i]=vl;\n\t\tval[blk[pos]]=vl;\n\t}\n\t\n\tinline void Add_query(int x,int y,int id){\n\t\tlink[++nodecnt].to=y;\n\t\tlink[nodecnt].nxt=head[x];\n\t\tlink[nodecnt].idx=id;\n\t\thead[x]=nodecnt;\n\t}\n\t\n\tvoid dfs1(int x){\n\t\tif(!x) return;\n\t\tdfn[x]=++dfncnt;\n\t\tdfs1(lc[x]); dfs1(rc[x]);\n\t}\n\t\n\tvoid dfs2(int x){\n\t\tfa[x]=x;\n\t\tif(lc[x]) dfs2(lc[x]),fa[lc[x]]=x;\n\t\tif(rc[x]) dfs2(rc[x]),fa[rc[x]]=x;\n\t\tfor(int i=head[x];i;i=link[i].nxt)\n\t\t\tans[link[i].idx]=min(ans[link[i].idx],val[Find(link[i].to)]-Now);\n\t}\n\t\n\tinline void build(){\n\t\ttop=0;\n\t\tfor(re int i=1,pos;i<=blkcnt;i++){\n\t\t\tpos=top;\n\t\t\twhile(pos&&val[stk[pos]]>val[i]) pos--;\n\t\t\tif(pos) rc[stk[pos]]=i;\n\t\t\tif(pos!=top) lc[i]=stk[pos+1];\n\t\t\tstk[top=++pos]=i;\n\t\t}\n\t\trt=stk[1];\n\t}\n\t\n\tinline void query(){\n\t\tmemset(pr,0x3f,sizeof(pr));\n\t\tmemset(suf,0x3f,sizeof(suf));\n\t\tmemset(val,0x3f,sizeof(val));\n\t\tfor(re int i=1;i<=n;i++) v[a[i]].push_back(i);\n\t\tfor(re int i=1;i<=m;i++){\n\t\t\tif(blk[q[i].l]==blk[q[i].r]){\n\t\t\t\tfor(re int j=q[i].l;j<=q[i].r;j++)\n\t\t\t\t\tans[q[i].id]=min(ans[q[i].id],a[j]%q[i].k);\n\t\t\t}\n\t\t}\n\t\tbool flag=true;\n\t\tfor(re int i=100000;i;i--){\n\t\t\tNow=i;\n\t\t\tif(i!=100000) flag=false;\n\t\t\tfor(int j : v[i]) modify(j,i),flag=true;\n\t\t\tif(flag){\n\t\t\t\tmemset(lc,0,sizeof(lc));\n\t\t\t\tmemset(rc,0,sizeof(rc));\n\t\t\t\tbuild();\n\t\t\t}\n\t\t\tmemset(dfn,0,sizeof(dfn));\n\t\t\tmemset(fa,0,sizeof(fa));\n\t\t\tmemset(head,0,sizeof(head));\n\t\t\tnodecnt=dfncnt=0;\n\t\t\tdfs1(rt);\n\t\t\tfor(re int j=1;j*j<=i;j++){\n\t\t\t\tif(i%j) continue;\n\t\t\t\tif(j>S1){\n\t\t\t\t\tfor(re int k=L[j];k<=R[j];k++){\n\t\t\t\t\t\tif(blk[q[k].l]==blk[q[k].r]) continue;\n\t\t\t\t\t\tans[q[k].id]=min(ans[q[k].id],suf[q[k].l]-i);\n\t\t\t\t\t\tans[q[k].id]=min(ans[q[k].id],pr[q[k].r]-i);\n\t\t\t\t\t\tif(blk[q[k].l]+1==blk[q[k].r]) continue;\n\t\t\t\t\t\tif(dfn[blk[q[k].l]+1]>dfn[blk[q[k].r]-1])\n\t\t\t\t\t\t\tAdd_query(blk[q[k].l]+1,blk[q[k].r]-1,q[k].id);\n\t\t\t\t\t\telse Add_query(blk[q[k].r]-1,blk[q[k].l]+1,q[k].id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(j*j!=i&&i/j>S1){\n\t\t\t\t\tfor(re int k=L[i/j];k<=R[i/j];k++){\n\t\t\t\t\t\tif(blk[q[k].l]==blk[q[k].r]) continue;\n\t\t\t\t\t\tans[q[k].id]=min(ans[q[k].id],suf[q[k].l]-i);\n\t\t\t\t\t\tans[q[k].id]=min(ans[q[k].id],pr[q[k].r]-i);\n\t\t\t\t\t\tif(blk[q[k].l]+1==blk[q[k].r]) continue;\n\t\t\t\t\t\tif(dfn[blk[q[k].l]+1]>dfn[blk[q[k].r]-1])\n\t\t\t\t\t\t\tAdd_query(blk[q[k].l]+1,blk[q[k].r]-1,q[k].id);\n\t\t\t\t\t\telse Add_query(blk[q[k].r]-1,blk[q[k].l]+1,q[k].id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tdfs2(rt);\n\t\t}\n\t}\n\t\n}\n\nvoid buildtree(int p,int l,int r){\n\ttree[p].l=l,tree[p].r=r;\n\tif(l==r) return (void) (tree[p].mn=a[l]);\n\tint mid=l+r>>1;\n\tbuildtree(p<<1,l,mid); buildtree(p<<1|1,mid+1,r);\n\ttree[p].mn=min(tree[p<<1].mn,tree[p<<1|1].mn);\n}\n\nint qry(int p,int l,int r){\n\tif(tree[p].l>=l&&tree[p].r<=r) return tree[p].mn;\n\tint mid=tree[p].l+tree[p].r>>1,ret=INT_MAX;\n\tif(mid>=l) ret=min(ret,qry(p<<1,l,r));\n\tif(mid<r) ret=min(ret,qry(p<<1|1,l,r));\n\treturn ret;\n}\n\nint main(){\n\tp1=ibuf,fread(ibuf,1,SZ1,stdin),p2=obuf;\n\tmemset(ans,0x3f,sizeof(ans));\n\tread(n); read(m);\n\tfor(int i=1;i<=n;i++)\n\t\tread(a[i]);\n\tfor(int i=1;i<=m;i++){\n\t\tread(q[i].l); read(q[i].r); read(q[i].k);\n\t\tq[i].id=i;\n\t}\n\tsort(q+1,q+m+1);\n\tSolve1 :: Init(S1);\n\tint i;\n\tfor(i=1;i<=m&&q[i].k<=S1;i++)\n\t\tans[q[i].id]=Solve1 :: query(i);\n\tfor(;i<=m;i++){\n\t\tif(!L[q[i].k]) L[q[i].k]=i;\n\t\tR[q[i].k]=i;\n\t}\n\tSolve2 :: Init();\n\tSolve2 :: query();\n\tbuildtree(1,1,n);\n\tfor(i=1;i<=m;i++)\n\t\tans[q[i].id]=min(ans[q[i].id],qry(1,q[i].l,q[i].r));\n\tfor(i=1;i<=m;i++) write(ans[i]);\n\tfwrite(obuf,1,p2-obuf,stdout);\n\treturn 0;\n}\n```",
        "postTime": 1661784017,
        "uid": 525349,
        "name": "Sakura_xyz",
        "ccfLevel": 4,
        "title": "P7811 [JRKSJ R2] \u4f60\u7684\u540d\u5b57\u3002\u9898\u89e3"
    },
    {
        "content": "[dX \u7684\u9898\u89e3](https://www.luogu.com.cn/blog/_post/401942) \u76ee\u524d\u5df2\u7ecf\u4e0d\u80fd\u901a\u8fc7\u672c\u9898\uff0c\u4f46\u662f\u52a0\u4e0a\u4e00\u4e2a\u53c8\u5408\u7406\u53c8\u5947\u602a\uff08\uff1f\uff09\u7684\u7279\u5224\uff0c\u4fbf\u53ef\u901a\u8fc7\u672c\u9898\u3002\n\n\u4ee4\u9608\u503c\u4e3a $B$\uff0c\u8003\u8651 $k\\le B$ \u7684\u60c5\u51b5\uff0c\u6211\u4eec\u9700\u8981 $O(n)$ \u8ba1\u7b97\u51fa $a_i \\bmod k$ \u7684\u503c\uff0c\u4f46\u5982\u679c\u5f53\u524d\u7684 $k$ \u7684\u8be2\u95ee\u6570\u5f88\u5c11\uff0c\u5176\u5b9e\u4e0d\u5982\u5c06\u8fd9\u4e9b\u8be2\u95ee\u4e0e $k\\ge B$ \u7684\u8be2\u95ee\u4e00\u8d77\u5904\u7406\uff0c\u8fd9\u6837\u505a\u53ef\u4ee5\u7701\u4e0b\u8ba1\u7b97 $a$ \u6570\u7ec4\u53d6\u6a21\u540e\u7684\u503c\u7684\u5f00\u9500\u3002\n\n\u7531\u6b64\u53ef\u4ee5\u5f88\u81ea\u7136\u5730\u60f3\u5230\u4e00\u4e2a\u7279\u5224\uff1a\u5982\u679c $\\min(\\frac{a}{i},\\frac{a}{w})\\times|q|\\le \\alpha n$\uff0c\u90a3\u4e48\u5c31\u5c06\u5f53\u524d\u7684\u8be2\u95ee\u653e\u5728\u6700\u540e\u5904\u7406\u3002\n\u5176\u4e2d\uff0c$\\min(\\frac{a}{i},\\frac{a}{w})$ \u8868\u793a\u901a\u8fc7 bitset \u8ba1\u7b97\u4e00\u4e2a\u7b54\u6848\u7684\u82b1\u8d39\uff0c$|q|$ \u8868\u793a\u8be2\u95ee\u6570\u91cf\uff0c$\\alpha$ \u662f~~\u53ef\u4ee5\u901a\u8fc7\u624b\u52a8\u4e8c\u5206\u5f97\u5230\u7684~~\u5e73\u8861\u56e0\u5b50\u3002\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u7531\u4e8e $\\frac{a}{i}$ \u968f $i$ \u589e\u5927\u800c\u51cf\u5c0f\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4e0d\u8bbe\u7f6e\u9608\u503c\uff0c\u8ba9\u5b83\u5b8c\u5168\u81ea\u9002\u5e94\u6d4b\u8bd5\u6570\u636e\u3002\n\n\u5b9e\u9645\u6d4b\u8bd5\u4e2d\uff0c\u8fd9\u4e2a\u7279\u5224\u8868\u73b0\u5f97\u76f8\u5f53\u4f18\u79c0\uff0c\u6211\u5728\u591a\u6b21\u8c03\u6574\u9608\u503c\u540e\u4ecdTLE\u7684\u70b9\uff0c\u5728\u52a0\u4e0a\u8fd9\u4e2a\u7279\u5224\u540e\u53ea\u8dd1\u4e86 0.2s\uff0c~~\u5f53\u7136\u4e5f\u4e0d\u6392\u9664\u51fa\u9898\u4eba\u8fd8\u80fd\u9020\u51fa\u6765\u5361\u6389\u8fd9\u4e2a\u7279\u5224\u7684\u6570\u636e~~\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ri register int\ntypedef long long ll;\nconst int maxa=1e5+1,maxn=3e5+1;\ntemplate<class T>inline bool ckmin(T &x,const T &y){return x>y?x=y,1:0;}\ntemplate<class T>inline bool ckmax(T &x,const T &y){return x<y?x=y,1:0;}\ntemplate<class T>inline void clear(T *arr,int siz,int val=0){memset(arr,val,sizeof(T)*(siz+1));}\nstatic char pbuf[1000000],*p1=pbuf,*p2=pbuf,obuf[1000000],*o=obuf;\n#define getchar() p1==p2&&(p2=(p1=pbuf)+fread(pbuf,1,1000000,stdin),p1==p2)?EOF:*p1++\n#define putchar(x) (o-obuf<1000000)?(*o++=(x)):(fwrite(obuf,o-obuf,1,stdout),o=obuf,*o++=(x))\ninline int qr(){\n\tri in=0;register char ch;\n\twhile(!isdigit(ch=getchar()));\n\tdo in=(in<<1)+(in<<3)+(ch^48);while(isdigit(ch=getchar()));\n\treturn in;\n}\ntemplate<class T>\nvoid qw(T out){\n\tif(out>9)qw(out/10);\n\tputchar(out%10|48);\n}\nstruct flusher{~flusher(){fwrite(obuf,o-obuf,1,stdout);}}autoflush;\nint a[maxn],_a[maxn],BB,m,n;\nstruct qry{\n\tint l,r,k,id,bel;\n\tinline qry(int l_=0,int r_=0,int k_=0,int id_=0):l(l_),r(r_),k(k_),id(id_){}\n\tinline bool operator<(const qry &rhs)const{return bel!=rhs.bel?l<rhs.l:(bel&1)?r<rhs.r:r>rhs.r;}\n};\nvector<qry>bq,sq[maxa];\ntypedef unsigned long long ull;\ntemplate<int siz>\nstruct bset{\n\tull b[((siz+63)>>6)+1];int len;\n\tinline bset(){len=(siz+63)>>6;}\n\tinline void set0(int p){b[p>>6]&=~(1llu<<p);}\n\tinline void set1(int p){b[p>>6]|=(1llu<<p);}\n\tinline int find_first(){for(ri i=0;i<len;++i)if(b[i])return (i<<6)|__builtin_ctzll(b[i]);return siz;}\n\tinline int find_next(int p){\n\t\tif(++p>=siz)return siz;\n\t\tri hi=p>>6,lo=p&63;\n\t\tif(b[hi]>>lo)return p+__builtin_ctzll(b[hi]>>lo);\n\t\tfor(ri i=hi+1;i<len;++i)if(b[i])return (i<<6)|__builtin_ctzll(b[i]);\n\t\treturn siz;\n\t}\n};\nbset<maxa>b;\nint ans[maxn],cnt[maxn];\nint main(){\n\tn=qr(),m=qr();\n\tfor(ri i=1;i<=n;++i)a[i]=qr();\n\tfor(ri i=1;i<=m;++i){\n\t\tri x=qr(),y=qr(),z=qr();\n\t\tsq[z].emplace_back(x,y,z,i);\n\t}\n\tfor(ri i=2;i<maxa;++i)\n\t\tif(sq[i].size()){\n\t\t\tif(min(maxa/i,maxa>>6)*sq[i].size()<(n<<2)){\n\t\t\t\tbq.insert(bq.end(),sq[i].begin(),sq[i].end());\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tBB=n/sqrt(sq[i].size())+1;\n\t\t\tfor(qry &j:sq[i])j.bel=j.l/BB;\n\t\t\tsort(sq[i].begin(),sq[i].end());\n\t\t\tfor(ri j=1;j<=n;++j)_a[j]=a[j]%i;\n\t\t\tri pl=1,pr=0;\n\t\t\tfor(const qry &j:sq[i]){\n\t\t\t\twhile(pl>j.l)if(!cnt[_a[--pl]]++)b.set1(_a[pl]);\n\t\t\t\twhile(pr<j.r)if(!cnt[_a[++pr]]++)b.set1(_a[pr]);\n\t\t\t\twhile(pl<j.l)if(!--cnt[_a[pl++]])b.set0(_a[pl-1]);\n\t\t\t\twhile(pr>j.r)if(!--cnt[_a[pr--]])b.set0(_a[pr+1]);\n\t\t\t\tans[j.id]=b.find_first();\n\t\t\t}\n\t\t\twhile(pr>=pl)b.set0(_a[pr]),--cnt[_a[pr--]];\n\t\t}\n\tif(bq.size()){\n\t\tBB=n/sqrt(bq.size())+1;\n\t\tfor(qry &i:bq)i.bel=i.l/BB;\n\t\tsort(bq.begin(),bq.end());\n\t\tri pl=1,pr=0;\n\t\tfor(const qry &i:bq){\n\t\t\twhile(pl>i.l)if(!cnt[a[--pl]]++)b.set1(a[pl]);\n\t\t\twhile(pr<i.r)if(!cnt[a[++pr]]++)b.set1(a[pr]);\n\t\t\twhile(pl<i.l)if(!--cnt[a[pl++]])b.set0(a[pl-1]);\n\t\t\twhile(pr>i.r)if(!--cnt[a[pr--]])b.set0(a[pr+1]);\n\t\t\tans[i.id]=i.k;\n\t\t\tfor(ri j=b.find_first();ans[i.id]&&j<maxa;j=b.find_next((j/i.k+1)*i.k-1))if(j<maxa)ckmin(ans[i.id],j%i.k);\n\t\t}\n\t}\n\tfor(ri i=1;i<=m;++i)qw(ans[i]),putchar(10);\n\treturn 0;\n}\n```\n",
        "postTime": 1643055057,
        "uid": 67942,
        "name": "meyi",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 \u3010P7811 [JRKSJ R2] \u4f60\u7684\u540d\u5b57\u3002\u3011"
    },
    {
        "content": "\u611f\u6069\u51fa\u9898\u4eba\u81ea\u5df1\u5361\u81ea\u5df1\uff0c\u8ba9\u62bd\u8c61\u590d\u6742\u5ea6\u98d8\u8fc7\u53bb\u4e86\u3002\n\n\u4e0b\u9762\u8ba4\u4e3a $n,q,V$ \u540c\u9636\u3002\n\n\u4e00\u770b\u9898\u89e3\u533a\u5168\u90fd\u662f\u4e00\u4e9b\u5404\u79cd\u5957\u5a03\u505a\u6cd5\uff0c\u8fd9\u91cc\u63d0\u4f9b\u4e00\u79cd\u601d\u8003\u8d77\u6765\u6e05\u65b0\uff0c\u8dd1\u8d77\u6765\u622a\u6b62\u5230\u73b0\u5728\u662f\u6700\u4f18\u89e3\u7684\u505a\u6cd5\u3002\n\n\u770b\u5230\u53d6\u6a21\uff0c\u6839\u53f7\u5206\u6cbb\u5927\u6982\u9003\u4e0d\u6389\u7684\uff0c\u5bf9\u4e8e $k<v$ \u7684\u6570\uff0c\u6211\u4eec\u8003\u8651\u5efa\u7acb\u7ebf\u6bb5\u6811\u6765\u505a $\\text{rmq}$ \u95ee\u9898\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(nv+q \\log n)$\uff1b\n\n\u5bf9\u4e8e $k \\ge v$ \u7684\u6570\uff0c\u56e0\u4e3a\u53d6\u6a21\u5c31\u76f8\u5f53\u4e8e\u662f\u51cf\u53bb $xk$\uff0c\u56e0\u6b64 $x \\le \\dfrac n v$\uff0c\u7136\u540e\u6bcf\u6b21\u67e5\u8be2\u5c31\u53ef\u4ee5\u679a\u4e3e $x$\uff0c\u53d8\u6210\u4e86 $\\dfrac n v$ \u6b21\u67e5\u8be2\u533a\u95f4\u975e\u4e25\u683c\u540e\u7ee7\u3002\n\n\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u5148\u4e8c\u533a\u95f4\u5e76\uff08\u4fd7\u79f0\u732b\u6811\uff09\uff0c\u53d8\u6210\u4e86 $O(n \\log n)$ \u6b21\u7684\u52a0\u4e00\u4e2a\u6570\u548c $q \\dfrac n v$ \u6b21\u67e5\u8be2\u540e\u7ee7\uff0c\u53ef\u4ee5\u81ea\u7531\u9009\u62e9\u6570\u636e\u7ed3\u6784\uff08\u538b\u4f4d $\\text{Trie}$\uff0c\u591a\u5c42\u5206\u5757 **\u53ef\u80fd** \u90fd\u53ef\u4ee5\u63a5\u53d7\uff09\uff0c\u6211\u9009\u62e9\u7684\u7684\u662f\u538b\u4f4d $\\text{Trie}$\uff0c\u6b64\u65f6\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(nv + q\\log n + q\\dfrac n v \\dfrac {\\log n} {\\log w})$\uff0c\u6b64\u65f6\u53d6 $v = \\sqrt {n \\dfrac{\\log n}{\\log w}}$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n \\sqrt{n \\dfrac{\\log n} {\\log w}})$\u3002",
        "postTime": 1684300355,
        "uid": 615348,
        "name": "zhouershan",
        "ccfLevel": 7,
        "title": "P7811 \u6700\u4f18\u89e3\uff0c\u4f46\u662f\u590d\u6742\u5ea6\u79bb\u8c31 sol"
    },
    {
        "content": "\u4e0d\u4f1a\u732b\u6811\u3002\n\n\u6839\u53f7\u5206\u6cbb\uff0c$k\\leq B$ \u5728\u6a21\u5b8c\u7684\u5e8f\u5217\u4e0a\u5206\u5757\u7ef4\u62a4\u5757\u5185 $\\min$\u3002\n\n$k > B$ \u628a\u8be2\u95ee\u62c6\u6210\u533a\u95f4 $\\geq ik$ \u7684 $\\min$\uff0c\u6309 $ik$ \u6392\u5e8f\u79bb\u7ebf\u53d8\u6210\u4e86 $O(n)$ \u6b21\u63d2\u5165\u5168\u5c40 $\\min$ \u548c $O(n\\sqrt k)$ \u6b21\u67e5\u533a\u95f4 $\\min$\u3002\n\n\u7a7a\u95f4\u5bf9\u6bcf\u4e2a $k$ \u679a\u4e3e\u56e0\u6570\u505a\u5230\u7ebf\u6027\u3002\n\n\u5e8f\u5217\u5206\u5757\uff0c\u7ef4\u62a4\u5757\u5185\u524d\u540e\u7f00 $\\min$\uff0c\u5757\u95f4 st \u8868\u3002\n\n\u4fee\u6539\u53ea\u5f71\u54cd st \u8868\u6839\u53f7\uff08$1+2+4+8\\cdots +\\sqrt n$\uff09\u4e2a\u4f4d\u7f6e\u3002\n\n$l,r$ \u540c\u5757\u4e0d\u7528\u6839\u53f7\u5206\u6cbb\u76f4\u63a5\u66b4\u529b\u3002\n\n\u603b\u590d\u6742\u5ea6 $O(n\\sqrt n)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint a[300005],n,m,out[300005],L[100005],R[100005],solved[100005],ans[300005],ANS[300005];\nstruct query\n{\n\tint l,r,k,id;\n}b[300005];\ninline bool cmp(query x,query y)\n{\n\treturn x.k<y.k;\n}\nnamespace small//\u8fd9\u91cc\u6240\u6709unsigned short\u4e0d\u5fc5\u8981\uff0c\u5176\u5b9e\u4e0d\u5f88\u5361\u5e38\n{\n\tconst int B=567,N=300005,M=100005;\n\tunsigned short A[N],C[M],mn[N/B+2];\n\tinline unsigned short query(int l,int r)//\u5206\u5757\u533a\u95f4min\n\t{\n\t\tunsigned short rtn=-1;\n\t\tif(l/B==r/B)\n\t\t{\n\t\t\tfor(int i=l;i<=r;i++) rtn=min(rtn,A[i]);\n\t\t\treturn rtn; \n\t\t}\n\t\tint L=l/B*B+B-1,R=r/B*B;\n\t\tfor(int i=l;i<=L;i++) rtn=min(rtn,A[i]);\n\t\tfor(int i=R;i<=r;i++) rtn=min(rtn,A[i]);\n\t\tfor(int i=l/B+1;i<r/B;i++) rtn=min(rtn,mn[i]);\n\t\treturn rtn;\n\t}\n\tinline void solvek(int x)\n\t{\n\t\tfor(int i=0;i<x;i++) C[i]=i;\n\t\tfor(int i=x;i<=100000;i++) C[i]=C[i-x];//C[i]=i%x\n\t\tfor(int i=0;i<=n/B;i++) mn[i]=-1;\n\t\tfor(int i=1;i<=n;i++) A[i]=C[a[i]];//A[i]=a[i]%x\n\t\tfor(int i=0;i<=n/B;i++)\n\t\t{\n\t\t\tint l=max(1,i*B),r=min(n,i*B+B-1);\n\t\t\tfor(int j=l;j<=r;j++) mn[i]=min(mn[i],A[j]);//mn[i]\u5757\u5185min\n\t\t}\n\t\tfor(int i=L[x];i<=R[x];i++)\n\t\t\tif(out[b[i].id]==200002) out[b[i].id]=query(b[i].l,b[i].r);\n\t}\n}\nnamespace large\n{\n\tconst int B=3000,N=300005,LG=7;\n\tint st[LG][N/B+2],qz[N],hz[N],lg[N/B+2];//st\u8868\uff0c\u524d\u540e\u7f00min\n\tinline void change(int p,int x)//\u6539\u524d\u540e\u7f00\n\t{\n\t\tint bel=p/B,L=max(1,bel*B),R=min(n,bel*B+B-1);\n\t\tfor(int i=p;i<=R;i++) qz[i]=x;\n\t\tfor(int i=L;i<=p;i++) hz[i]=x;\n\t\tst[0][bel]=x,qwqa[p]=x;\n\t}\n\tinline void changest(int p,int x)//\u6539st\u8868\n\t{\n\t\tint bel=p/B;\n\t\tst[0][bel]=x;\n\t\tfor(int i=1;i<LG;i++)\n\t\t{\n\t\t\tint L=max(0,bel-(1<<i)+1),R=min(bel,n/B-(1<<i)+1);\n\t\t\tfor(int j=L;j<=R;j++) st[i][j]=x;\n\t\t}\n\t}\n\tinline int query(int l,int r)\n\t{\n\t\tint L=l/B+1,R=r/B-1,X=lg[R-L+1];\n\t\treturn min(hz[l],min(qz[r],R>=L?min(st[X][L],st[X][R-(1<<X)+1]):200002));\n\t}\n\tvector <int> v[100005];\n\tinline void solve()\n\t{\n\t\tfor(int i=1;i<=100000;i++) v[i].clear();\n\t\tfor(int i=1;i<=n;i++) v[a[i]].push_back(i);\n\t\tfor(int i=2;i<=n/B;i++) lg[i]=lg[i>>1]+1;\n\t\tfor(int i=1;i<=n;i++) qwqa[i]=qz[i]=hz[i]=200002;\n\t\tfor(int i=0;i<LG;i++) for(int j=0;j<=n/B;j++) st[i][j]=200002;\n\t\tfor(int i=100000;i>=1;i--)\n\t\t{\n\t\t\tfor(auto t:v[i]) change(t,i),changest(t,i);\n\t\t\tfor(int j=1;j*j<=i;j++)\n\t\t\t{\n\t\t\t\tif(i%j==0)\n\t\t\t\t{\n\t\t\t\t\tif(!solved[j]) for(int k=L[j];k<=R[j];k++) ans[k]=min(ans[k],query(b[k].l,b[k].r)-i);\n\t\t\t\t\tif(j*j!=i) if(!solved[i/j]) for(int k=L[i/j];k<=R[i/j];k++) ans[k]=min(ans[k],query(b[k].l,b[k].r)-i);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=1;i<=m;i++)\n\t\t\tans[i]=min(ans[i],query(b[i].l,b[i].r));\n\t}\n}\nint main(int argc, char** argv) {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\tcin >> n >> m;\n\tfor(int i=1;i<=n;i++) cin >> a[i];\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tcin >> b[i].l >> b[i].r >> b[i].k;\n\t\tb[i].id=i,out[i]=200002;\n\t}\n\tsort(b+1,b+m+1,cmp);\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tANS[i]=200002;\n\t\tif(b[i].r-b[i].l<=large::B)//\u540c\u5757\u66b4\u529b\n\t\t{\n\t\t\tint rtn=200002;\n\t\t\tfor(int j=b[i].l;j<=b[i].r;j++) rtn=min(rtn,a[j]%b[i].k);\n\t\t\tANS[i]=rtn;\n\t\t}\n\t\tif(!L[b[i].k]) L[b[i].k]=i;\n\t\tR[b[i].k]=i,ans[i]=200002;\n\t}\n\tfor(int i=1;i<=100000;i++) L[i]=max(L[i],1);\n\tfor(int i=1;i<=100000;i++)\n\t{\n\t\tint w1=n;\n\t\tlong long w2=100000/i*(double)(R[i]-L[i]+1)*3;//\u5bf9\u6bcf\u4e2ak\u7b97\u653e\u5230\u5c0f\u7684\u548c\u5927\u7684\u7684\u4ee3\u4ef7\n\t\tif(w1<w2) small::solvek(i),solved[i]=1;\n\t}\n\tlarge::solve();\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tif(ANS[i]<=100000) out[b[i].id]=ANS[i];\n\t\telse out[b[i].id]=min(out[b[i].id],ans[i]);\n\t}\n\tfor(int i=1;i<=m;i++)\n\t\tcout << out[i] << \"\\n\";\n\treturn 0;\n}\n```",
        "postTime": 1629389127,
        "uid": 101734,
        "name": "\u8fdd\u89c4\u7528\u6237\u540d76G!ihcm",
        "ccfLevel": 9,
        "title": "P7811 \u9898\u89e3"
    }
]
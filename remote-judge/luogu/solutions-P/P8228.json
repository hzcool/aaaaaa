[
    {
        "content": "### \u9898\u89e3\r\n\r\n\u672c\u9898\u8981\u6c42\u6211\u4eec\u5728\u4e00\u4e2a\u5de8\u5927\u7684\u516d\u8fb9\u5f62\u7f51\u683c\u4e2d\u6267\u884c\u6b63\u516d\u8fb9\u5f62\u8303\u56f4\u7684\u52a0\u6cd5\u3002\u4f46\u662f\u6b63\u516d\u8fb9\u5f62\u52a0\u6cd5\u5e76\u4e0d\u5bb9\u6613\u3002\u8fd9\u91cc\u5148\u8003\u8651\u5728\u4e00\u4e2a\u6b63\u65b9\u5f62\u7f51\u683c\u5f53\u4e2d\u6267\u884c\u77e9\u5f62\u8303\u56f4\u7684\u52a0\u6cd5\u3002\r\n\r\n![](https://cdn.luogu.com.cn/upload/image_hosting/g28ab7by.png)\r\n\r\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u8fd9\u4e9b\u56fe\u4ece\u5de6\u5f80\u53f3\u5206\u522b\u79f0\u4e3a $G_1,G_2,G_3$\u3002\r\n\r\n\u5229\u7528\u300c\u5dee\u5206\u300d\u548c\u300c\u524d\u7f00\u548c\u300d\u7684\u601d\u8def\u3002\u5047\u8bbe\u6211\u4eec\u73b0\u5728\u9700\u8981\u8fdb\u884c\u77e9\u5f62\u52a0\u6cd5\u3002\u5982 $G_1$ \u4e2d\uff0c\u9700\u8981\u5bf9\u77e9\u5f62\u8303\u56f4\u5185\u6240\u6709\u683c\u5b50\u90fd\u52a0\u4e0a\u4e00\u4e2a\u6570\u5b57 $3$\u3002\u6309\u7167\u4ece\u4e0a\u5f80\u4e0b\u7684\u987a\u5e8f\u505a\u4e00\u6b21**\u5dee\u5206**\uff0c\u6bcf\u4e2a\u683c\u5b50\u91cc\u7684\u6570\u53d8\u4e3a\u539f\u6765\u7684\u6570\u51cf\u53bb\u539f\u6765\u5b83\u4e0a\u65b9\u7684\u6570\u5b57\uff0c\u6b64\u65f6\u53d8\u6210\u4e86 $G_2$\u3002\u6211\u4eec\u518d\u5bf9 $G_2$ \u6309\u7167\u4ece\u5de6\u5f80\u53f3\u7684\u987a\u5e8f\u505a\u4e00\u6b21**\u5dee\u5206**\uff0c\u6bcf\u4e2a\u683c\u5b50\u91cc\u7684\u6570\u53d8\u4e3a\u539f\u6765\u7684\u6570\u51cf\u53bb\u539f\u6765\u5b83\u5de6\u65b9\u7684\u6570\u5b57\uff0c\u6b64\u65f6\u53d8\u6210\u4e86 $G_3$\u3002\r\n\r\n\u6b64\u65f6\u53d1\u73b0\uff0c\u5728 $G_3$ \u91cc\u5b9e\u9645\u88ab\u66f4\u65b0\u7684\u683c\u5b50\u5176\u5b9e\u53ea\u6709\u56db\u4e2a\u3002\u8fd9\u6837\u7684\u590d\u6742\u5ea6\u662f\u53ef\u4ee5\u627f\u53d7\u7684\u3002\r\n\r\n\u5b9e\u9645\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u53ea\u9700\u8981\u5bf9\u8fd9\u56db\u4e2a\u683c\u5b50\u8fdb\u884c\u64cd\u4f5c\uff0c\u53ef\u4ee5\u5f97\u5230 $G_3$\uff1b\u518d\u4f7f\u7528\u5dee\u5206\u7684**\u9006\u8fd0\u7b97**\uff08\u4e5f\u5c31\u662f\u524d\u7f00\u548c\uff09\uff0c\u6309\u7167\u4ece\u5de6\u5f80\u53f3\u7684\u987a\u5e8f\u505a\u4e00\u6b21\u524d\u7f00\u548c\uff0c\u53ef\u4ee5\u5f97\u5230 $G_2$\uff1b\u540c\u7406\uff0c\u5bf9 $G_2$ \u6309\u7167\u4ece\u4e0a\u5f80\u4e0b\u7684\u987a\u5e8f\u505a\u4e00\u6b21\u524d\u7f00\u548c\uff0c\u53ef\u4ee5\u5f97\u5230 $G_1$\u3002\r\n\r\n\u8fd9\u4e48\u505a\u6709\u4e2a\u5f88\u597d\u7684\u6027\u8d28\uff1a\u6211\u4eec\u53ef\u4ee5\u628a\u82e5\u5e72\u6b21\u533a\u95f4\u52a0\u64cd\u4f5c\u5728 $G_3$ \u91cc\u6267\u884c\u56db\u4e2a\u683c\u5b50\u7684\u5355\u70b9\u52a0\u6cd5\uff08\u51cf\u6cd5\uff09\uff0c\u5728\u6267\u884c\u5b8c\u6240\u6709\u64cd\u4f5c\u540e\uff0c\u518d\u4ece\u66f4\u65b0\u540e\u7684 $G_3$ \u63a8\u51fa $G_2$ \u518d\u63a8\u51fa $G_1$\uff0c\u5c31\u53ef\u4ee5\u6781\u5927\u51cf\u5c0f\u65f6\u95f4\u590d\u6742\u5ea6\u3002\u5bf9\u4e8e $n\\times m$ \u4e2a\u683c\u5b50\u7684\u6b63\u65b9\u5f62\u9635\u5217\uff0c\u6267\u884c $q$ \u6b21\u533a\u95f4\u52a0\u6cd5\u7684\u590d\u6742\u5ea6\u5373\u4e3a $\\mathcal O(nm+q)$\u3002\r\n\r\n\u4f46\u662f\u6211\u4eec\u8981\u505a\u7684\u662f\u6b63\u516d\u8fb9\u5f62\u91cc\u7684\u52a0\u6cd5\u554a\u3002\u4f46\u662f\u4e0d\u7740\u6025\u3002\u56e0\u4e3a\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u5728\u4e00\u4e2a\u6b63\u516d\u8fb9\u5f62\u9635\u5217\u91cc\uff0c\u53ef\u4ee5\u6309\u7167\u67d0\u4e2a\u65b9\u5411\u8fdb\u884c\u53d8\u6362\uff0c\u5c06\u4e00\u4e2a\u5e73\u884c\u56db\u8fb9\u5f62\u533a\u57df\u8f6c\u5316\u4e3a\u77e9\u5f62\u533a\u57df\uff1a\r\n\r\n![](https://cdn.luogu.com.cn/upload/image_hosting/6mdpz2ra.png)\r\n\r\n\u56e0\u6b64\uff0c\u8fd9\u91cc\u8003\u8651\u5c06\u7ed9\u6211\u4eec\u7684\u5750\u6807\u8fdb\u884c**\u5750\u6807\u8f6c\u6362**\u3002\r\n\r\n\u5177\u4f53\u800c\u8a00\uff0c\u6211\u4eec\u65b0\u5efa\u8fd9\u6837\u4e24\u4e2a\u5750\u6807\u7cfb\u3002\r\n\r\n![](https://cdn.luogu.com.cn/upload/image_hosting/vuegbysa.png)\r\n\r\n\u6309\u7167\u539f\u70b9\u7684\u65b9\u4f4d\uff0c\u6211\u4eec\u5206\u522b\u5c06\u5b83\u4eec\u79f0\u547c\u4e3a**\u5de6\u7cfb**\u548c**\u53f3\u7cfb**\u3002\u5148\u8ba8\u8bba\u5982\u4f55\u5c06\u9898\u76ee\u7ed9\u5b9a\u7684\u5750\u6807\u7cfb\uff08\u79f0\u547c\u4e3a\u6807\u51c6\u7cfb\uff09\u7684\u5750\u6807\u8f6c\u6362\u4e3a\u5de6\u7cfb\u548c\u53f3\u7cfb\u5f53\u4e2d\u70b9\u7684\u5750\u6807\u3002\u5047\u8bbe\u7ed9\u5b9a\u7684\u5750\u6807\u4e3a $(x_0,y_0,z_0)$\u3002\r\n\r\n- \u5bb9\u6613\u53d1\u73b0\uff0c\u5728\u6807\u51c6\u7cfb\u5f53\u4e2d\uff0c\u6bcf\u5411 $x$ \u65b9\u5411\u8d70\u4e00\u683c\u4f1a\u5bfc\u81f4\u5de6\u7cfb\u7684 $x$ \u589e\u52a0 $1$\uff0c$y$ \u51cf\u5c0f $1$\uff1b\u6bcf\u5411 $y$ \u65b9\u5411\u8d70\u4e00\u683c\u4f1a\u5bfc\u81f4\u5de6\u7cfb\u7684 $y$ \u589e\u52a0 $1$\uff1b\u6bcf\u5411 $z$ \u65b9\u5411\u8d70\u4e00\u683c\u4f1a\u5bfc\u81f4\u5de6\u7cfb\u7684 $x$ \u51cf\u5c0f $1$\u3002\u8003\u8651\u5230\u6807\u51c6\u7cfb\u4e2d\u539f\u70b9\u7684\u5750\u6807\u5728\u5de6\u7cfb\u4e2d\u4e3a $(n,n)$\uff0c\u90a3\u4e48\u6807\u51c6\u7cfb\u4e2d\u7684\u5750\u6807 $(x_0,y_0,z_0)$ \u8f6c\u6362\u4e3a\u5de6\u7cfb\u5750\u6807\u5c31\u662f $(x_0-z_0+n,y_0-x_0+n)$\u3002\r\n- \u540c\u65f6\u53d1\u73b0\uff0c\u5728\u6807\u51c6\u7cfb\u5f53\u4e2d\uff0c\u6bcf\u5411 $x$ \u65b9\u5411\u8d70\u4e00\u683c\u4f1a\u5bfc\u81f4\u53f3\u7cfb\u7684 $x$ \u589e\u52a0 $1$\uff1b\u6bcf\u5411 $y$ \u65b9\u5411\u8d70\u4e00\u683c\u4f1a\u5bfc\u81f4\u53f3\u7cfb\u7684 $y$ \u589e\u52a0 $1$\uff1b\u6bcf\u5411 $z$ \u65b9\u5411\u8d70\u4e00\u683c\u4f1a\u5bfc\u81f4\u53f3\u7cfb\u7684 $x$ \u51cf\u5c0f $1$\uff0c$y$ \u51cf\u5c0f $1$\u3002\u8003\u8651\u5230\u6807\u51c6\u7cfb\u4e2d\u539f\u70b9\u7684\u5750\u6807\u5728\u53f3\u7cfb\u4e2d\u4e3a $(n,n)$\uff0c\u90a3\u4e48\u6807\u51c6\u7cfb\u4e2d\u7684\u5750\u6807 $(x_0,y_0,z_0)$ \u8f6c\u6362\u4e3a\u5de6\u7cfb\u5750\u6807\u5c31\u662f $(x_0-z_0+n,y_0-z_0+n)$\u3002\r\n\r\n\r\n![](https://cdn.luogu.com.cn/upload/image_hosting/3q9mphod.png)\r\n\r\n\u8fd9\u5f20\u56fe\u662f\u5bf9\u4e00\u4e2a**\u53f3\u7cfb**\u8fdb\u884c\u77e9\u5f62\u53d8\u6362\u540e\u7684\u7ed3\u679c\u3002\u5bb9\u6613\u53d1\u73b0\uff0c\u5728\u539f\u56fe\u5f53\u4e2d\u4e00\u4e2a\u5411\u53f3\u503e\u659c\u7684\u5e73\u884c\u56db\u8fb9\u5f62\u533a\u57df\uff0c\u53ef\u4ee5\u88ab\u88ab\u8f6c\u5316\u4e3a\u53f3\u7cfb\u5f53\u4e2d\u7684\u4e00\u4e2a\u77e9\u5f62\u3002\u540c\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u5de6\u7cfb\u8fdb\u884c\u77e9\u5f62\u53d8\u6362\uff1a\r\n\r\n![](https://cdn.luogu.com.cn/upload/image_hosting/6mdpz2ra.png)\r\n\r\n\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u4e00\u4e2a\u516d\u8fb9\u5f62\u7f51\u683c\u56fe\u4e2d\uff0c\u4e00\u4e2a\u5411\u5de6\u503e\u659c\u7684\u5e73\u884c\u56db\u8fb9\u5f62\u533a\u57df\u7684\u533a\u95f4\u52a0\uff0c\u8f6c\u5316\u4e3a**\u5de6\u7cfb**\u6240\u5bf9\u5e94\u7684\u90a3\u4e2a\u77e9\u5f62\u91cc\u7684\u4e00\u4e2a\u77e9\u5f62\u52a0\u3002\r\n\r\n\u77e5\u9053\u8fd9\u4e9b\uff0c\u8fd9\u6761\u9898\u76ee\u5c31\u975e\u5e38\u7b80\u5355\u4e86\u3002\u73b0\u5728\u5047\u8bbe\u6211\u4eec\u9700\u8981\u5bf9\u539f\u56fe\u5f53\u4e2d\u8fd9\u6837\u4e00\u4e2a\u5927\u7684\u6b63\u516d\u8fb9\u5f62\u533a\u57df\u6267\u884c\u52a0\u6cd5\u64cd\u4f5c\uff1a\r\n\r\n![](https://cdn.luogu.com.cn/upload/image_hosting/vqo80wdh.png)\r\n\r\n\u90a3\u4e48\u5b83\u53ef\u4ee5\u88ab\u8f6c\u6362\u4e3a\u8fd9\u6837\u56db\u4e2a\u56fe\u5f62\u4e4b\u95f4\u7684\u62fc\u63a5\uff1a\r\n\r\n![](https://cdn.luogu.com.cn/upload/image_hosting/9ur5yqpd.png)\r\n\r\n![](https://cdn.luogu.com.cn/upload/image_hosting/3j0ubn3r.png)\r\n\r\n\u5176\u4e2d\uff0c\u7ea2\u8272\u90e8\u5206\u4ee3\u8868\u7684\u662f\u6b63\u503c\uff0c\u84dd\u8272\u90e8\u5206\u4ee3\u8868\u7684\u662f\u8d1f\u503c\u3002\u5b83\u53ef\u4ee5\u88ab\u8f6c\u5316\u4e3a\u4e24\u4e2a\u5de6\u7cfb\u5f53\u4e2d\u7684\u77e9\u5f62\u52a0\uff0c\u4ee5\u53ca\u4e24\u4e2a\u53f3\u7cfb\u5f53\u4e2d\u7684\u77e9\u5f62\u52a0\u3002\r\n\r\n\u8bb0\u5f97\u5904\u7406\u4e00\u4e0b\u77e9\u9635\u7684\u8fb9\u754c\u8d85\u51fa\u5de6\u7cfb/\u53f3\u7cfb\u7684\u60c5\u51b5\uff0c\u90a3\u4e48\u8fd9\u9898\u5c31\u505a\u5b8c\u4e86\u3002\r\n\r\n### \u53c2\u8003\u4ee3\u7801\r\n\r\n```cpp\r\n#include<bits/stdc++.h>\r\n#define up(l,r,i) for(int i=l,END##i=r;i<=END##i;++i)\r\n#define dn(r,l,i) for(int i=r,END##i=l;i>=END##i;--i)\r\nusing namespace std;\r\ntypedef long long i64;\r\nconst int INF =2147483647;\r\nint qread(){\r\n    int w=1,c,ret;\r\n    while((c=getchar())> '9'||c< '0') w=(c=='-'?-1:1); ret=c-'0';\r\n    while((c=getchar())>='0'&&c<='9') ret=ret*10+c-'0';\r\n    return ret*w;\r\n}\r\nconst int MAXN=800+3;\r\nint n,m,k;\r\nvoid cnv1(int a,int b,int c,int &x,int &y){  //\u5de6\u7cfb\r\n    x=a-c+n,y=b-a+n;\r\n}\r\nvoid cnv2(int a,int b,int c,int &x,int &y){  //\u53f3\u7cfb\r\n    x=a-c+n,y=b-c+n;\r\n}\r\nint A[MAXN*2][MAXN*2],B[MAXN*2][MAXN*2];\r\nint main(){\r\n    n=qread(),m=qread(),k=2*n-1;\r\n    up(1,m,i){\r\n        int x=qread(),y=qread(),z=qread(),r=qread(),w=qread();\r\n        int u,v;\r\n        cnv1(x,y,z,u,v);\r\n        A[u][min(k,v+r-1)]-=w,A[max(1,u-r+1)][min(k,v+r-1)]+=w;\r\n        A[u][max(0,v-r  )]-=w,A[min(k+1,u+r)][max(0,v-r  )]+=w;\r\n        cnv2(x,y,z,u,v);\r\n        B[u][min(k,v+r-1)]+=w,B[min(k+1,u+r)][min(k,v+r-1)]-=w;\r\n        B[u][max(0,v-r  )]+=w,B[max(1,u-r+1)][max(0,v-r  )]-=w;\r\n    }\r\n    up(1,k,i) up(1,k,j) A[i][j]+=A[i-1][j];\r\n    up(1,k,i) up(1,k,j) B[i][j]+=B[i-1][j];\r\n    up(1,k,i) dn(k,1,j) A[i][j]+=A[i][j+1];\r\n    up(1,k,i) dn(k,1,j) B[i][j]+=B[i][j+1];\r\n    up(-n+1,n-1,i) dn(n-1,-n+1+abs(i),j){\r\n        int x=0,y=j,z=0,u,v,w=0; if(i<0) z=-i; else x=i;\r\n        cnv1(x,y,z,u,v),w+=A[u][v];\r\n        cnv2(x,y,z,u,v),w+=B[u][v];\r\n        printf(\"%d \",w);\r\n    }\r\n    \r\n    return 0;\r\n}\r\n```\r\n",
        "postTime": 1648004577,
        "uid": 330759,
        "name": "\u56e7\u4ed9",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P8228 \u3010\u300cWdoi-5\u300d\u6a21\u5757\u5316\u6838\u7194\u7089\u3011"
    },
    {
        "content": "\u5b8c\u5168\u6ca1\u6709\u60f3\u660e\u767d\u8fd9\u79cd\u840c\u840c\u9898\u600e\u4e48\u6ca1\u4eba\u505a\u6ca1\u4eba\u8fc7\u2026\u2026\n\n---\n\u7b80\u8981\u9898\u610f\uff1a\u5728\u6b63\u516d\u8fb9\u5f62\u533a\u57df\u5185\u6267\u884c\u82e5\u5e72\u6b21\u6b63\u516d\u8fb9\u5f62\u533a\u57df\u52a0\u64cd\u4f5c\uff0c\u8f93\u51fa\u6700\u540e\u6bcf\u4e2a\u683c\u5b50\u7684\u503c\u3002\n\n\u9996\u5148\uff0c\u8fd9\u662f\u4e00\u4e2a\u4e8c\u7ef4\u7684\u95ee\u9898\uff0c\u90a3\u4e48\u4f7f\u7528\u4e09\u4e2a\u5750\u6807\u6765\u8868\u8fbe\u4e00\u4e2a\u70b9\u662f\u975e\u5e38\u8822\u7684\uff1b\u56e0\u6b64\uff0c\u8003\u8651\u4ee5\u5de6\u4e0a\u89d2\u4e3a\u539f\u70b9\uff0c\u6cbf\u4e24\u6761\u8fb9\u4e3a\u4e24\u6761\u5750\u6807\u8f74\uff0c\u5efa\u7acb\u659c\u5750\u6807\u7cfb\u3002\n\n\uff08\u4e8b\u5b9e\u4e0a\u6d89\u53ca\u5230\u516d\u8fb9\u5f62\u7f51\u683c\u548c\u4e09\u89d2\u5f62\u7f51\u683c\u65f6\u5f80\u5f80\u91c7\u7528\u659c\u5750\u6807\u7cfb\uff09\n\n\u90a3\u4e48\u6b63\u516d\u8fb9\u5f62\u5c31\u53d8\u6210\u4e86\u8fd9\u6837\uff1a\n```plain\n00000\n000000\n0000000\n00000000\n000000000\n 00000000\n  0000000\n   000000\n    00000\n```\n\n\u9898\u76ee\u53ea\u8981\u6c42\u6211\u4eec\u6240\u6709\u64cd\u4f5c\u7ed3\u675f\u540e\u8f93\u51fa\u6240\u6709\u503c\uff0c\u5f88\u5bb9\u6613\u60f3\u5230\u5148\u5dee\u5206\u518d\u524d\u7f00\u548c\u3002\n\n\u5728\u5176\u4e2d\u53d6\u4e00\u4e2a\u516d\u8fb9\u5f62\u533a\u57df\u52a0\u662f\u8fd9\u6837\uff1a\n```plain\n00000\n000000\n0000000\n00111000\n001111000\n 01111100\n  0111100\n   011100\n    00000\n```\n\u8003\u8651\u5230\u6a2a\u5411\u548c\u7eb5\u5411\u5dee\u5206\u4f1a\u5e26\u6765\u4e0d\u5f88\u89c4\u5219\u7684 1 \u548c -1 \u5e26\uff0c\u6211\u4eec\u8003\u8651\u659c\u5411\u5dee\u5206\uff08a \u8868\u793a -1\uff09\uff1a\n```plain\n00000\n000000\n0000000\n00111000\n001000000\n 01000000\n  00000a0\n   0000a0\n    0aaa0\n```\n\u76f4\u89d2\u578b\u53ef\u4ee5\u62c6\u5206\u4e3a\u4e00\u4e2a\u6a2a\u6761\u548c\u4e00\u4e2a\u7ad6\u6761\uff0c\u5c06\u5b83\u4eec\u5206\u5f00\u5904\u7406\u518d\u5206\u522b\u6a2a\u5411/\u7eb5\u5411\u5dee\u5206\uff0c\u5373\u53ef\u7528 O(1) \u4e2a\u4fee\u6539\u4f4d\u7f6e\u8868\u793a\u4e00\u6b21\u64cd\u4f5c\u3002**\u6ce8\u610f\u8fb9\u754c\u3002**\n\n\u6700\u540e\uff0c\u5206\u5f00\u5904\u7406\u7684\u4e24\u90e8\u5206\u5206\u522b\u6a2a\u5411/\u7eb5\u5411\u6c42\u548c\uff0c\u7136\u540e\u52a0\u8d77\u6765\uff0c\u518d\u659c\u5411\u6c42\u548c\uff0c\u5373\u4e3a\u6700\u7ec8\u7b54\u6848\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2+m)$\u3002\u592a\u7b80\u5355\u4e86\u6ca1\u5199\u4ee3\u7801\u3002",
        "postTime": 1648025738,
        "uid": 130151,
        "name": "WYXkk",
        "ccfLevel": 9,
        "title": "P8228 \u300cWdoi-5\u300d\u6a21\u5757\u5316\u6838\u7194\u7089 \u9898\u89e3"
    },
    {
        "content": "### Solution\n\n------------\n\n\u8fd9\u9898\u53ef\u4ee5\u8fd0\u7528\u5dee\u5206\u7684\u601d\u60f3\u3002\u5148\u4ecb\u7ecd\u4e00\u4e0b\u4e8c\u7ef4\u5dee\u5206\u7684\u7528\u6cd5\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ptsjaz9c.png?x-oss-process=image/resize,m_lfit,h_340,w_450)\n![](https://cdn.luogu.com.cn/upload/image_hosting/2y8i7nue.png?x-oss-process=image/resize,m_lfit,h_340,w_450)\n\n\u8981\u5c06\u5de6\u56fe\u84dd\u8272\u90e8\u5206\u5168\u90e8\u52a0\u4e0a 1\uff0c\u5c31\u53ef\u4ee5\u5728\u6709\u56fe\u4e2d\u84dd\u8272\u90e8\u5206\u52a0 1\uff0c\u7ea2\u8272\u90e8\u5206\u51cf 1\u3002\u6b64\u65f6\uff0c\u53ea\u8981\u5c06\u6bcf\u4e00\u884c\u90fd\u505a\u4e00\u6b21\u524d\u7f00\u548c\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u84dd\u8272\u90e8\u5206\u5168\u90e8\u52a0 1 \u7684\u6548\u679c\u3002\u8fd9\u6837\u5c31\u5927\u5927\u51cf\u5c0f\u4e86\u65f6\u95f4\u590d\u6742\u5ea6\u3002\n\n\u82e5\u5728 $ n \\times m $ \u7684\u65b9\u683c\u64cd\u4f5c $ q $ \u6b21\uff0c\u5219\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $ \\Theta(nm+q) $\u3002\n\n\u53ef\u4ee5\u770b\u4e00\u4e0b\u8fd9\u4e2a[\u4f8b\u9898](https://www.luogu.com.cn/problem/P3397)\u3002\n\n------------\n\n\u518d\u6765\u770b\u672c\u9898\u3002\u8fd9\u9898\u8981\u6c42\u5728\u516d\u8fb9\u5f62\u505a\u5dee\u5206\uff0c\u4e8e\u662f\u53ef\u4ee5\u8003\u8651\u8fdb\u884c\u5750\u6807\u7684\u8f6c\u5316\uff0c\u628a\u516d\u8fb9\u5f62\u8f6c\u5316\u4e3a\u77e9\u5f62\u3002\u56e0\u4e3a\u5728\u4e09\u4e2a\u5750\u6807\u4e2d\u8fdb\u884c\u64cd\u4f5c\u5341\u5206\u9ebb\u70e6\uff0c\u5c31\u53ef\u4ee5\u6539\u6210\u5728\u4e8c\u7ef4\u4e2d\u64cd\u4f5c\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/o5zlt5e6.png?x-oss-process=image/resize,m_lfit,h_510,w_675)\n\n(\u56fe\u7247\u6765\u81ea[\u535a\u5ba2](https://www.luogu.com.cn/blog/over-knee-socks/solution-p8228)\uff09\n\n\u8bbe\u7b2c\u4e00\u4e2a\u5750\u6807\u7cfb\u4e3a $ A $\uff0c\u7b2c\u4e8c\u4e2a\u4e3a $ B $\u3002\n\u5728\u539f\u6765\u5750\u6807\u7cfb\u5f53\u4e2d\uff0c\u6613\u5f97\n- \u5f80 $ x $ \u8f74\u65b9\u5411\u79fb\u52a8\u4e00\u683c\u4f1a\u4f7f $ A $ \u5750\u6807\u7cfb\u4e2d $ x $ \u53d8\u4e3a $ x+1 $\uff0c$ y $ \u53d8\u4e3a $ y-1 $\u3002\n- \u5f80 $ y $ \u8f74\u65b9\u5411\u79fb\u52a8\u4e00\u683c\u4f1a\u4f7f $ A $ \u5750\u6807\u7cfb\u4e2d $ y $ \u53d8\u4e3a $ y+1 $\u3002 \n- \u5f80 $ z $ \u8f74\u65b9\u5411\u79fb\u52a8\u4e00\u683c\u4f1a\u4f7f $ A $ \u5750\u6807\u7cfb\u4e2d $ x $ \u53d8\u4e3a $ x-1 $\u3002\n\u6240\u4ee5\uff0c\u539f\u6765\u5750\u6807\u7cfb\u7684 $ (x,y,z) $ \u5728 $ A $ \u4e2d\u8868\u793a\u4e3a $ (x-z+n,y-x+n) $\u3002\n\n\u540c\u7406\uff0c\u539f\u6765\u5750\u6807\u7cfb\u7684 $ (x,y,z) $ \u5728 $ B $ \u4e2d\u8868\u793a\u4e3a $ (x-z+n,y-z+n) $\u3002\n\n\u7efc\u4e0a\uff0c\u6211\u4eec\u5c31\u53ea\u9700\u5206\u522b\u5728 $ A,B $ \u4e2d\u8fdb\u884c\u5dee\u5206\uff0c\u6700\u540e\u518d\u5bf9 $ A,B $ \u505a\u4e00\u6b21\u524d\u7f00\u548c\u5373\u53ef\u3002\n\n### Code\n\n------------\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $ \\Theta (n^2+m) $\u3002\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define N 1601 \nusing namespace std;\nint n,m,d;\nll a[N][N],b[N][N];\nint main()\n{\n\tios::sync_with_stdio(0);\n\tcin.tie(0);cout.tie(0);\n\tcin>>n>>m;d=2*n-1;\n\twhile(m--)\n\t{\n\t\tint x,y,z,r,k,p,q;\n\t\tcin>>x>>y>>z>>r>>k;\n\t\t\n\t\tp=x-z+n;q=y-x+n;\n\t\ta[p][min(d,q+r-1)]-=k;\n\t\ta[max(1,p-r+1)][min(d,q+r-1)]+=k;\n\t\ta[p][max(0,q-r)]-=k;\n\t\ta[min(d+1,p+r)][max(0,q-r)]+=k;\n\t\t\n\t\tp=x-z+n;q=y-z+n;\n\t\tb[p][min(d,q+r-1)]+=k;\n\t\tb[min(d+1,p+r)][min(d,q+r-1)]-=k;\n        b[p][max(0,q-r)]+=k;\n\t\tb[max(1,p-r+1)][max(0,q-r)]-=k;\n\t}\n\t\n\tfor(int i=1;i<=d;i++)\n\t\tfor(int j=1;j<=d;j++)\n\t\t\ta[i][j]+=a[i-1][j];\n\tfor(int i=1;i<=d;i++)\n\t\tfor(int j=d;j>=1;j--)\n\t\t\ta[i][j]+=a[i][j+1];\n\tfor(int i=1;i<=d;i++)\n\t\tfor(int j=1;j<=d;j++)\n\t\t\tb[i][j]+=b[i-1][j];\n\tfor(int i=1;i<=d;i++)\n\t\tfor(int j=d;j>=1;j--)\n\t\t\tb[i][j]+=b[i][j+1];\n\t\t\t\n\tfor(int i=-n+1;i<=n-1;i++)\n\t\tfor(int j=n-1;j>=1-n+abs(i);j--)\n\t\t{\n\t\t\tll x=0,y=j,z=0;\n\t\t\t(i<0)?z-=i:x=i;\n\t\t\tcout<<a[x-z+n][y-x+n]+b[x-z+n][y-z+n]<<' ';\n\t\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1648268847,
        "uid": 202474,
        "name": "zhongcy",
        "ccfLevel": 5,
        "title": "P8228 \u300cWdoi-5\u300d\u6a21\u5757\u5316\u6838\u7194\u7089"
    },
    {
        "content": "\u5efa\u7acb\u659c\u5750\u6807\u7cfb\u7684\u65b9\u6cd5\u5c0f\u6ce2\u548c WYXkk \u5df2\u7ecf\u8bb2\u8fc7\u4e86\uff0c\u603b\u4e4b\u5c31\u662f\u4e24\u90bb\u8fb9\u4e0e\u67d0\u4e24\u6761\u5750\u6807\u8f74\u5e73\u884c\u7684\u5e73\u884c\u56db\u8fb9\u5f62\u52a0\u7b49\u540c\u4e8e\u8be5\u659c\u5750\u6807\u7cfb\u4e0b\u7684\u77e9\u5f62\u52a0\u3002\n\n\u53ea\u8981\u628a\u539f\u672c\u7684\u4fee\u6539\u64cd\u4f5c\u62c6\u5206\u6210\u4e09\u4e2a\u4e0d\u540c\u5750\u6807\u7cfb\u4e0b\u7684\u4e09\u4e2a\u77e9\u5f62\u52a0\u548c\u4e00\u4e2a\u5355\u70b9\u4fee\u6539\u5c31\u53ef\u4ee5\u4e86\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/hcno4qqt.png?x-oss-process=image/resize,m_lfit,w_375)\n![](https://cdn.luogu.com.cn/upload/image_hosting/cd235sbo.png?x-oss-process=image/resize,m_lfit,w_375)\n\npython \u4ee3\u7801\u5e38\u6570\u8fc7\u5927\u4f1a TLE\uff08\u5176\u5b9e\u662f\u4e8c\u7ef4\u6570\u7ec4\u90e8\u5206\u592a\u6162\uff09\uff0c\u4ec5\u4f9b\u53c2\u8003\u3002\n\n```python\n# -*- coding: utf-8 -*-\n\"\"\"\nCreated on Thu Mar 17 17:41:48 2022\n\n@author: minstdfx\n\"\"\"\n\ndef MyMin(a, b):\n    return a if a < b else b\ndef MyMax(a, b):\n    return b if a < b else a\ndef MyAbs(a):\n    return a if a >= 0 else -a\n\nclass Point:\n    def __init__(self, x = 0, y = 0, z = 0):\n        self.x = x\n        self.y = y\n        self.z = z\n    def __add__(self, other):\n        return Point(self.x + other.x, self.y + other.y, self.z + other.z)\n    def __str__(self):\n        return \"Point(%d, %d, %d)\" % (self.x, self.y, self.z)\n    def toXY(self):\n        return Point(self.x - self.z, self.y - self.z, self.z - self.z)\n    def toXZ(self):\n        return Point(self.x - self.y, self.y - self.y, self.z - self.y)\n    def toYZ(self):\n        return Point(self.x - self.x, self.y - self.x, self.z - self.x)\nclass Api:\n    def __init__(self, n): # n\n        self._demand = []\n        self._n = n\n        self._length = n * 2 + 3\n        for i in range(self._length):\n            self._demand.append([0] * self._length)\n    def update(self, xl, xr, yl, yr, k):\n        n = self._n\n        xl += n + 1\n        xr += n + 1\n        yl += n + 1\n        yr += n + 1\n        xl = xl if xl >= 0 else 0\n        yl = yl if yl >= 0 else 0\n        xr = xr if xr <= 2 * n + 1 else 2 * n + 1\n        yr = yr if yr <= 2 * n + 1 else 2 * n + 1\n        self._demand[xl][yl] += k\n        self._demand[xl][yr + 1] -= k\n        self._demand[xr + 1][yl] -= k\n        self._demand[xr + 1][yr + 1] += k \nn, m = 0, 0\nGxy, Gxz, Gyz = 0, 0, 0\ninput_data, input_ptr = [], 0\ndef readInt():\n    global input_data, input_ptr\n    if input_ptr == len(input_data):\n        input_data = input().split(' ')\n        input_ptr = 0\n    input_ptr += 1\n    return int(input_data[input_ptr - 1])\n_ans = []\n_isendl = []\n_Gas = []\ndef InitAns(n):\n    global _ans, _Gas\n    _len = n * 2 + 3\n    for i in range(_len):\n        _Gas.append([0] * _len)\n    for x in range(-n, n + 1):\n        # for y in range(MyMax(-n, x - n), MyMin(n, x + n) + 1):\n        y = MyMin(n, x + n)\n        stop_y = MyMax(-n, x - n)\n        while y >= stop_y:\n            # print(\"(%d, %d)\" % (x, y))\n            _Gas[x + n + 1][y + n + 1] = len(_ans)\n            _ans.append(0)\n            _isendl.append(0)\n            y -= 1\n        _isendl[len(_isendl) - 1] = 1\ndef Accumulate(p, k):\n    p = p.toXY()\n    if not(-n <= p.y <= n and -n <= p.x <= n):\n        return\n    if p.x * p.y < 0 and MyAbs(p.x) + MyAbs(p.y) > n:\n        return\n    _ans[_Gas[p.x + n + 1][p.y + n + 1]] += k\ndef updateXZ(p1, p2, k):\n    Gxz.update(p1.x - p1.y, p2.x - p2.y, p1.z - p1.y, p2.z - p2.y, k)\ndef updateXY(p1, p2, k):\n    Gxy.update(p1.x - p1.z, p2.x - p2.z, p1.y - p1.z, p2.y - p2.z, k)\ndef updateYZ(p1, p2, k):\n    Gyz.update(p1.y - p1.x, p2.y - p2.x, p1.z - p1.x, p2.z - p2.x, k)\nif __name__ == '__main__':\n    # global Gxy, Gxz, Gyz\n    n, m = readInt(), readInt()\n    n = n - 1\n    Gxy = Api(n)\n    Gxz = Api(n)\n    Gyz = Api(n)\n    InitAns(n)\n    for i in range(m):\n        p = Point(readInt(), readInt(), readInt())\n        r, k = readInt(), readInt()\n        r -= 1\n        Accumulate(p, k)\n        updateXY(p + Point(0, 1, 0), p + Point(r, r, 0), k)\n        updateXZ(p + Point(1, 0, 0), p + Point(r, 0, r), k)\n        updateYZ(p + Point(0, 0, 1), p + Point(0, r, r), k)\n    for i in range(1, 2 * n + 2):\n        for j in range(1, 2 * n + 2):\n            Gxz._demand[i][j] += Gxz._demand[i - 1][j] + Gxz._demand[i][j - 1] - Gxz._demand[i - 1][j - 1]\n            Accumulate(Point(i - n - 1, 0, j - n - 1), Gxz._demand[i][j])\n    for i in range(1, 2 * n + 2):\n        for j in range(1, 2 * n + 2):\n            Gxy._demand[i][j] += Gxy._demand[i - 1][j] + Gxy._demand[i][j - 1] - Gxy._demand[i - 1][j - 1]\n            Accumulate(Point(i - n - 1, j - n - 1, 0), Gxy._demand[i][j])\n    for i in range(1, 2 * n + 2):\n        for j in range(1, 2 * n + 2):\n            Gyz._demand[i][j] += Gyz._demand[i - 1][j] + Gyz._demand[i][j - 1] - Gyz._demand[i - 1][j - 1]\n            Accumulate(Point(0, i - n - 1, j - n - 1), Gyz._demand[i][j])\n    for i in range(len(_ans)):\n        print(_ans[i], end=\" \" if not _isendl[i] else \" \")\n```\n",
        "postTime": 1644900159,
        "uid": 100250,
        "name": "minstdfx",
        "ccfLevel": 7,
        "title": "P8228 \u300cWdoi-5\u300d\u6a21\u5757\u5316\u6838\u7194\u7089 \u9898\u89e3"
    }
]
[
    {
        "content": "## Preface\n\n\u8003\u573a\u4e0a\u6ca1\u60f3\u51fa\u6765\uff0c\u597d\u4e00\u9053**\u4eba\u7c7b\u667a\u6167**\u9898\uff01\n\n## Analysis1\n\n**\u8f83\u7b80\u5355\u7684\u8bc1\u660e\u3002**\n\n\u82e5 $x\\nmid z$\uff0c\u5219\u4e00\u5b9a\u65e0\u89e3\u3002\n\n\u4ee4 $x=d\\times a$\uff0c$y=d\\times b$\uff0c\u5176\u4e2d $\\gcd(a,b)=1$\u3002\u90a3\u4e48\u6709 $\\gcd(x,y)=d$\u3002\u5219 $z=x\\times y\\times \\gcd(x,y)=d^3\\times a\\times b$\u3002\n\n\u6211\u4eec\u77e5\u9053 $x$ \u4e0e $z$\uff0c\u90a3\u4e48\u53ef\u4ee5\u6c42\u51fa $\\frac{z}{x}=d^2\\times b$\u3002\u7531\u4e8e $\\gcd(a,b)=1$\uff0c\u6240\u4ee5 $\\gcd(\\frac{z}{x},x^2)=\\gcd(d^2\\times b,d^2\\times a^2)=d^2$\u3002\u82e5 $\\gcd(\\frac{z}{x},x^2)$ \u4e0d\u662f\u5b8c\u5168\u5e73\u65b9\u6570\uff0c\u5219\u65e0\u89e3\u3002\n\n\u5c06 $\\gcd(\\frac{z}{x},x^2)$ \u5f00\u65b9\u5373\u53ef\u5f97\u5230 $d$\u3002\u90a3\u4e48\uff1a\n\n$$\\frac{\\frac{z}{x}}{\\sqrt{\\gcd(\\frac{z}{x},x^2)}}=\\frac{d^2\\times b}{d}=d\\times b=y$$\n\n\u6240\u4ee5\u6211\u4eec\u6709\uff1a\n\n$$y=\\frac{\\frac{z}{x}}{\\sqrt{\\gcd(\\frac{z}{x},x^2)}}$$\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(T\\log x)$\u3002\n\n## Analysis2\n\n**\u66f4\u7e41\u7410\u7684\u8bc1\u660e\u3002**\n\n\u7531\u4e8e $z=x\\times y\\times \\gcd(x,y)$\uff0c\u4e24\u8fb9\u540c\u9664 $x$\uff0c\u5f97\uff1a$\\frac{z}{x}=y\\times \\gcd(x,y)$\u3002\u82e5 $x\\nmid z$\uff0c\u5219\u4e00\u5b9a\u65e0\u89e3\u3002\n\n\u6839\u636e\u552f\u4e00\u5206\u89e3\u5b9a\u7406\uff0c\u6211\u4eec\u5bf9\u5df2\u77e5\u7684 $x$\u3001$\\frac{z}{x}$ \u4e0e\u8981\u6c42\u7684 $y$ \u5206\u89e3\u8d28\u56e0\u6570\uff1a\n\n$$\n\\begin{cases}\n\\frac{z}{x}=p_1^{a_1}\\times p_2^{a_2}\\times p_3^{a_3}\\times \\dots \\times p_k^{a_k}\\\\\nx=p_1^{b_1}\\times p_2^{b_2}\\times p_3^{b_3}\\times \\dots \\times p_k^{b_k}\\\\\ny=p_1^{c_1}\\times p_2^{c_2}\\times p_3^{c_3}\\times \\dots \\times p_k^{c_k}\n\\end{cases}\n$$\n\n\u7531\u4e8e $\\frac{z}{x}=y\\times \\gcd(x,y)$\uff0c\u6240\u4ee5\u5bf9\u4e8e\u4efb\u610f $i\\in[1,k]$\uff0c\u6709 $a_i=c_i+\\min(b_i,c_i)$\u3002\n\n\u63a5\u4e0b\u6765\u5206\u4e24\u79cd\u60c5\u51b5\u8ba8\u8bba\uff1a\n\n- \u5f53 $b_i\\le c_i$ \u65f6\uff0c$a_i=b_i+c_i$\uff0c\u5219 $c_i=a_i-b_i$\u3002\n\n  \u8be5\u79cd\u60c5\u51b5\u6ee1\u8db3\uff1a$b_i\\le c_i\\iff b_i\\le a_i-b_i\\iff b_i\\le \\frac{a_i}{2}$\n\n- \u5f53 $b_i>c_i$ \u65f6\uff0c$a_i=2\\times c_i$\uff0c\u5219 $c_i=\\frac{a_i}2$\u3002\n\n  \u8be5\u79cd\u60c5\u51b5\u6ee1\u8db3\uff1a$b_i>c_i\\iff b_i>\\frac{a_i}{2}$\u3002\n\n\u5408\u5e76\u4e00\u4e0b\uff0c\u5f97\u5230 $c_i=a_i-\\min(\\frac{a_i}{2},b_i)$\u3002\n\n\u4e24\u8fb9\u540c\u65f6\u4e58\u4ee5 $2$ \u5f97\uff1a$2\\times c_i=2\\times a_i-\\min(a_i,2\\times b_i)$\u3002\n\n\u6700\u540e\u8f6c\u5316\u4e3a\u4eba\u8bdd\uff0c\u5373\uff1a\n\n$$y^2=\\frac{(\\frac{z}{x})^2}{\\gcd(\\frac{z}{x},x^2)}$$\n\n\u4e24\u8fb9\u540c\u65f6\u5f00\u65b9\uff0c\u5f97\uff1a\n\n$$y=\\frac{\\frac{z}{x}}{\\sqrt{\\gcd(\\frac{z}{x},x^2)}}$$\n\n\u5982\u679c $\\gcd(\\frac{z}{x},x^2)$ \u4e0d\u662f\u5b8c\u5168\u5e73\u65b9\u6570\uff0c\u4e5f\u662f\u65e0\u89e3\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(T\\log x)$\u3002\n\n## Code\n\n**Talk is cheap, show me the code.**\n\n```cpp\n// And in that light, I find deliverance.\n#define int long long\nvoid work(){\n\tint x,z;read(x,z);\n\tif(z%x!=0){puts(\"-1\");return;}\n\tint tmp=__gcd(z/x,x*x);\n\tint sq=(int)sqrt(tmp);\n\tif(sq*sq!=tmp) puts(\"-1\");\n\telse cout<<(z/x)/sq<<endl;\n}\nsigned main(){\n\tint T;read(T);\n\twhile(T--) work();\n}\n```",
        "postTime": 1648290921,
        "uid": 169574,
        "name": "Enucai",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P8255 \u3010[NOI Online 2022 \u666e\u53ca\u7ec4] \u6570\u5b66\u6e38\u620f\u3011"
    },
    {
        "content": "## Analysis\r\n\r\n\u9996\u5148\u663e\u7136\u9700\u8981\u628a $x$ \u9664\u8fc7\u53bb\uff1a\r\n\r\n$t = \\frac z x = y \\times \\gcd(x, y)$\r\n\r\n\u8bbe $t = \\prod p_i^{c_i}$\uff0c$x = \\prod p_i^{d_i}$\uff0c$y = \\prod p_i^{e_i}$ \u8868\u793a\u5176\u552f\u4e00\u5206\u89e3\u5f0f\u3002\u5219 $\\gcd(x, y) = \\prod p_i^{\\min(d_i, e_i)}$\uff0c$y \\times \\gcd(x, y) = \\prod p_i^{e_i + \\min(d_i, e_i)}$\u3002\r\n\r\n\u4e8e\u662f\u5bf9\u4e8e\u4efb\u610f\u7684 $p_i$\uff0c\u6211\u4eec\u6709\uff1a\r\n\r\n- \u82e5 $\\min(d_i, e_i) = e_i$\uff0c\u5219 $e_i + \\min(d_i, e_i) = 2e_i = c_i \\Rightarrow e_i = \\frac{c_i}{2}$\u3002\u56e0\u4e3a $e_i \\leq d_i$\uff0c\u6240\u4ee5 $c_i \\leq 2d_i$\r\n- \u82e5 $\\min(d_i, e_i) = d_i$\uff0c\u5219 $e_i + \\min(d_i, e_i) = e_i + d_i = c_i \\Rightarrow e_i = c_i - d_i$\u3002\u56e0\u4e3a $e_i \\gt d_i$\uff0c\u6240\u4ee5 $c_i \\gt 2d_i$\u3002\r\n\r\n\u540c\u65f6\u53ef\u4ee5\u53d1\u73b0\uff0c$c_i \\leq 2d_i \\Rightarrow \\frac{c_i}{2} \\geq c_i - d_i$\uff08\u79fb\u9879\u4e00\u4e0b\u5373\u53ef\uff09\u3002\u8fd9\u5c31\u662f\u8bf4\uff0c\u4e8c\u8005\u662f\u7edf\u4e00\u7684\u3002\u4e8e\u662f $e_i = \\max(\\frac {c_i} 2, c_i - d_i)$\u3002\r\n\r\n\u8003\u8651\u628a\u5206\u6bcd\u548c\u51cf\u53f7\u6d88\u6389\uff0c\u4e8e\u662f $2e_i + 2d_i = \\max(c_i + 2d_i, 2c_i)$\u3002\r\n\r\n\u6ce8\u610f\u5230\u4e24\u6570\u7684 lcm \u5c31\u662f\u4ed6\u4eec\u5bf9\u5e94\u6307\u6570\u7684\u6700\u5927\u503c\uff0c$\\prod p_i^{2e_i + 2d_i} = \\prod p_i^{\\max(c_i + 2d_i, 2c_i)} \\Rightarrow (xy)^2 = \\mathrm{lcm}(t \\times x^2, t^2)$\r\n\r\n\u4e8e\u662f $y = \\frac{\\sqrt{\\mathrm{lcm}(t \\times x^2, t^2)}}{x} = \\frac{1}{x}\\sqrt{\\frac{t^3 x^2}{ \\gcd(t \\times x^2, t^2)}} = \\frac{t}{\\sqrt{\\gcd(x^2, t)}}$\u3002\r\n\r\n## Code\r\n\r\n\u5b9e\u73b0\u4e0a\uff0c\u6ce8\u610f\u5230 $\\gcd(x^2, t)$ \u662f\u4e00\u4e2a $2^{63}$ \u8303\u56f4\u5185\u7684\u6570\uff0c\u76f4\u63a5\u5f00\u6839\u53f7\u53ef\u80fd\u56e0\u4e3a\u5947\u602a\u7684\u820d\u5165\u8bef\u5dee\u51fa\u73b0\u95ee\u9898\uff08\u867d\u7136\u73b0\u5728\u6ca1\u6709\u627e\u5230\u76f8\u5e94\u7684\u6570\u636e\uff0c\u7fa4\u53cb\u7ed9\u51fa\u7684\u65b9\u6848\u662f\u52a0\u4e0a 0.5 \u4ee5\u540e\u518d\u820d\u5165\uff0c\u56e0\u4e3a\u5728\u8fd9\u4e00\u8303\u56f4\u5185 sqrt \u7684\u8bef\u5dee\u5728 $10^{-15}$ \u5de6\u53f3\uff0c\u6240\u4ee5\u52a0\u4e0a eps \u5373\u53ef\u3002\r\n\r\n```cpp\r\n#include <cmath>\r\n#include <numeric>\r\n#include <iostream>\r\n\r\nint main() {\r\n  std::ios::sync_with_stdio(false);\r\n  std::cin.tie(0);\r\n  int T;\r\n  for (std::cin >> T; T; --T) {\r\n    long long x, t;\r\n    std::cin >> x >> t;\r\n    if (t % x != 0) {\r\n      std::cout << \"-1\\n\"; continue;\r\n    }\r\n    t /= x;\r\n    long long g = std::gcd(x * x, t), s = sqrt(g) + 0.5;\r\n    if (s * s != g) {\r\n      std::cout << \"-1\\n\"; continue;\r\n    }\r\n    std::cout << t / s << '\\n';\r\n  }\r\n}\r\n```\r\n\r\n",
        "postTime": 1648312940,
        "uid": 65363,
        "name": "\u4e00\u6276\u82cf\u4e00",
        "ccfLevel": 7,
        "title": "P8255"
    },
    {
        "content": "\u65e0\u5185\u9b3c\uff0c\u6765\u70b9\u5947\u602a\u590d\u6742\u5ea6\u505a\u6cd5\u3002\r\n\r\n\u770b\u5230\u8fd9\u4e2a\u9898\u6709\u4e2a\u81ea\u7136\u7684\u601d\u8def\u662f\u5bf9 $x$ \u5206\u89e3\u8d28\u56e0\u6570\uff0c\u7136\u540e\u5927\u529b dfs \u51fa $x$ \u7684\u6240\u6709\u56e0\u6570\uff0c\u679a\u4e3e\u6bcf\u4e2a\u56e0\u6570\u4f5c\u4e3a $\\gcd(x,y)$ \u8ba1\u7b97\u662f\u5426\u7b26\u5408\u6761\u4ef6\uff0c\u590d\u6742\u5ea6\u662f $O(T(\\sqrt x+d(x)))$\uff0c\u5df2\u7ecf\u53ef\u4ee5\u5f97\u5230 90 \u5206\u7684\u9ad8\u5206\u3002\r\n\r\n\u66f4\u8fdb\u4e00\u6b65\uff0c\u8003\u8651 $\\max d(x)$ \u5728 $10^9$ \u7684\u8303\u56f4\u5185\u5176\u5b9e\u53ea\u6709 $1344$\uff0c\u8fd9\u4e00\u90e8\u5206\u662f\u80fd\u8fc7\u7684\uff0c\u6211\u4eec\u7684\u74f6\u9888\u5728\u4e8e\u6bcf\u6b21 $O(\\sqrt x)$ \u7684\u8d28\u56e0\u6570\u5206\u89e3\u3002\r\n\r\n\u501f\u9274 [AGC003D](https://www.luogu.com.cn/problem/AT2004) \u7684\u601d\u8def\uff0c\u7ebf\u6027\u7b5b\u9884\u5904\u7406\u51fa $\\sqrt[3]x$ \u8303\u56f4\u5185\u7684\u8d28\u6570\uff0c\u8d28\u56e0\u6570\u5206\u89e3\u7684\u65f6\u5019\u5148\u628a\u8fd9\u4e9b\u8dd1\u4e00\u904d\uff0c\u5269\u4e0b\u7684\u90e8\u5206\u5982\u679c\u4e0d\u662f $1$\uff0c\u5c31\u53ea\u6709\u53ef\u80fd\u662f $p,p^2,pq(p,q\\in prime)$ \u4e2d\u7684\u4e00\u79cd\u3002\r\n\r\n\u4f46\u548c\u4e0a\u9762\u63d0\u5230\u7684\u9898\u76ee\u4e0d\u540c\u7684\u662f\uff0cAGC003D \u4e2d $p,pq$ \u53ef\u4ee5\u89c6\u4e3a\u540c\u4e00\u79cd\u60c5\u51b5\uff0c\u4f46\u8fd9\u4e2a\u9898\u6211\u4eec\u6bd5\u7adf\u662f\u8981\u627e\u51fa\u6bcf\u4e00\u4e2a\u56e0\u6570\u7684\uff0c$p,pq$ \u4e0d\u80fd\u540c\u7b49\u5bf9\u5f85\u3002\r\n\r\n\u4e8e\u662f\u6211\u4eec\u5bf9\u5269\u4e0b\u7684\u90e8\u5206\uff08\u8bb0\u4e3a $w$\uff09\u5206\u7c7b\u8ba8\u8bba\uff0c\u9996\u5148\u7279\u5224\u6389 $p^2$\uff0c\u7136\u540e\u6c42 $g=\\gcd(w,\\frac z x)$\u3002\r\n\r\n\u5982\u679c $g=1$\uff0c\u90a3\u4e48 $w$ \u4e2d\u7684\u6240\u6709\u8d28\u56e0\u5b50\u90fd\u4e0d\u53ef\u80fd\u6210\u4e3a\u7b54\u6848\uff0c\u56e0\u4e3a $y$ \u9009\u4e0d\u51fa\u6765\u8fd9\u4e9b\u8d28\u56e0\u5b50\u3002\r\n\r\n\u5982\u679c $g\\neq 1$ \u4e14 $g\\neq w$\uff0c\u90a3\u4e48\u975e\u5e38\u8d70\u8fd0\uff0c\u6211\u4eec\u76f4\u63a5\u628a $p$ \u548c $q$ \u5206\u5f00\u4e86\uff0c\u6309\u7167\u666e\u901a\u505a\u6cd5\u505a\u5373\u53ef\u3002\r\n\r\n\u5982\u679c $g=w$\uff0c\u518d\u6c42 $g'=\\gcd(w,\\frac z{wx})$\uff0c\u5982\u679c $g'=w$ \u90a3\u4e48 $w$ \u8fd9\u90e8\u5206\u53ef\u4ee5\u521a\u597d\u5206\u5230 $\\gcd(x,y)$ \u548c $y$ \u4e2d\u5404\u4e00\u4e2a\uff0c\u800c\u6211\u4eec\u8981\u6c42\u6700\u5927\u7684 $y$\uff0c\u76f4\u63a5\u628a $w$ \u6700\u540e\u4e58\u4e0a\u7b54\u6848\u5373\u53ef\uff1b\u5426\u5219 $w$ \u4e0d\u80fd\u540c\u65f6\u5728 $\\gcd(x,y)$ \u548c $y$ \u4e2d\u51fa\u73b0\uff0c\u4f46\u65e0\u8bba\u51fa\u73b0\u5728 $\\gcd(x,y)$ \u8fd8\u662f $y$ \u4e2d\u90fd\u4f1a\u5bfc\u81f4\u77db\u76fe\uff0c\u5c31\u53ea\u80fd\u65e0\u89e3\u4e86\u3002\r\n\r\n\u81f3\u6b64\u6211\u4eec\u89e3\u51b3\u4e86\u5269\u4f59\u90e8\u5206\u7684\u8d21\u732e\uff0c\u5269\u4e0b\u7684\u8d28\u56e0\u5b50\u76f4\u63a5 dfs \u7b97\u7b54\u6848\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(T(\\sqrt[3]x+d(x)))$\u3002\r\n\r\n```cpp\r\n#include<iostream>\r\n#include<cstdio>\r\n#include<vector>\r\n#include<cmath>\r\nusing namespace std;\r\nint t,n,p[5001],cnt,tag;\r\nlong long m,ans;\r\nbool prime[50001];\r\nvector<pair<long long,int> > v;\r\ninline long long read()\r\n{\r\n    long long x=0;\r\n    char c=getchar();\r\n    while(c<'0'||c>'9')\r\n        c=getchar();\r\n    while(c>='0'&&c<='9')\r\n    {\r\n        x=(x<<1)+(x<<3)+(c^48);\r\n        c=getchar();\r\n    }\r\n    return x;\r\n}\r\ninline void sieve()\r\n{\r\n    prime[1]=1;\r\n    for(int i=2;i<=1000;++i)\r\n    {\r\n        if(!prime[i])\r\n            p[++cnt]=i;\r\n        for(int j=1;j<=cnt&&i*p[j]<=1000;++j)\r\n        {\r\n            prime[i*p[j]]=1;\r\n            if(i%p[j]==0)\r\n                break;\r\n        }\r\n    }\r\n}\r\ninline long long gcd(long long x,long long y)\r\n{\r\n    return x%y? gcd(y,x%y):y;\r\n}\r\ninline void dfs(int k,long long sum)\r\n{\r\n    if(m%sum||(m/sum)%sum)\r\n        return;\r\n    if(k>=v.size())\r\n    {\r\n        if(gcd(n,m/sum)==sum)\r\n            if(ans==-1)\r\n                ans=m/sum;\r\n            else\r\n                ans=min(ans,m/sum);\r\n        return;\r\n    }\r\n    for(int i=0;i<=v[k].second;++i)\r\n    {\r\n        dfs(k+1,sum);\r\n        sum*=v[k].first;\r\n    }\r\n}\r\nint main()\r\n{\r\n    sieve();\r\n    t=read();\r\n    while(t--)\r\n    {\r\n        n=read(),m=read();\r\n        int tmp=n;\r\n        if(m%n)\r\n        {\r\n            cout<<\"-1\\n\";\r\n            continue;\r\n        }\r\n        m/=n;\r\n        tag=1;\r\n        ans=-1;\r\n        v.clear();\r\n        for(int i=1;i<=cnt&&p[i]<=tmp;++i)\r\n            if(tmp%p[i]==0)\r\n            {\r\n                v.emplace_back(p[i],0);\r\n                while(tmp%p[i]==0)\r\n                {\r\n                    ++v.back().second;\r\n                    tmp/=p[i];\r\n                }\r\n            }\r\n        if(tmp^1)\r\n            if((int)(sqrt(tmp))*(int)(sqrt(tmp))==tmp)\r\n                v.emplace_back((int)(sqrt(tmp)),2);\r\n            else\r\n            {\r\n                long long g=gcd(m,tmp);\r\n                if(g==tmp)\r\n                {\r\n                    if(gcd(m,1ll*tmp*tmp)==1ll*tmp*tmp)\r\n                    {\r\n                        tag=tmp;\r\n                        m/=1ll*tmp*tmp;\r\n                    }\r\n                    else\r\n                    {\r\n                        cout<<\"-1\\n\";\r\n                        continue;\r\n                    }\r\n                }\r\n                else if(g^1)\r\n                    v.emplace_back(g,1);\r\n            }\r\n        dfs(0,1);\r\n        if(ans==-1)\r\n            cout<<\"-1\\n\";\r\n        else\r\n            cout<<ans*tag<<'\\n';\r\n    }\r\n    return 0;\r\n}\r\n```",
        "postTime": 1648820707,
        "uid": 85682,
        "name": "\u7edd\u9876\u6211\u4e3a\u5cf0",
        "ccfLevel": 8,
        "title": "P8255 [NOI Online 2022 \u5165\u95e8\u7ec4] \u6570\u5b66\u6e38\u620f \u9898\u89e3"
    },
    {
        "content": "\u5361\u7cbe\u5ea6\u7ed9\u6211\u5361\u5410\u4e86\u3002\n\n## \u9898\u89e3\n\n$$z=x\\times y\\times \\gcd(x,y)$$\n\n\u6309\u7167\u505a\u6700\u5927\u516c\u7ea6\u6570\u5e38\u89c1\u5957\u8def\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06 $z,x,y$ \u8fdb\u884c\u8d28\u56e0\u6570\u5206\u89e3\u3002\u5177\u4f53\u5730\uff0c\u6211\u4eec\u8bbe\u6709\u8fd9\u6837\u5c3d\u91cf\u5927\u7684\u6574\u6570 $a,b,c$\uff0c\u540c\u65f6\u6709\u8d28\u6570 $p$\uff0c\u6ee1\u8db3\uff1a\n\n$$p^a\\mid z,p^b\\mid x,p^c\\mid y$$\n\n\u90a3\u4e48\u5c06\u9898\u8bbe\u5e26\u8fdb\u53bb\uff0c\u5c31\u6709\uff1a\n\n$$\n\\begin{aligned}\np^a&=p^b\\cdot p^c\\cdot p^{\\min(b,c)} \\cr\na&=b+c+\\min(b,c)\n\\end{aligned}\n$$\n\n\u5f53 $b\\le c$ \u65f6\uff0c$a=2b+c$\uff0c\u5f97 $b\\le c=a-2b$\uff0c\u5f97\u5230 $b\\le a/3$\u3002  \n\u5f53 $b> c$ \u65f6\uff0c$a=b+2c$\uff0c\u5f97 $b>c=\\frac{1}{2}(a-b)$\uff0c\u5f97\u5230 $b>a/3$\u3002\n\n\u4e5f\u5c31\u662f\u5f53 $b\\le a/3$ \u65f6\uff0c$c=a-2b$\uff1b\u5f53 $b> a/3$ \u65f6\uff0c$c=\\frac{1}{2}(a-b)$\u3002\u4f46\u662f\u53ef\u4ee5\u53d1\u73b0 $(a-2b)-\\frac{1}{2}(a-b)=\\frac{1}{2}(a-3b)$\uff0c\u5b83\u7684\u5206\u754c\u7ebf**\u540c\u6837**\u662f $a/3$\u3002\u90a3\u4e48\u5c31\u53ef\u4ee5\u63a8\u65ad\u51fa\uff1a\n\n$$c=\\max(a-2b,\\frac{1}{2}(a-b))$$\n\n\u770b\u5230\u6307\u6570\u4e0a\u7684 $\\max$\uff0c\u56e0\u6b64\u53ef\u4ee5\u60f3\u5230**\u6700\u5c0f\u516c\u500d\u6570**\u3002\u56e0\u4e3a\u6700\u5c0f\u516c\u500d\u6570\u4f1a\u6ee1\u8db3\u8fd9\u6837\u4e00\u4e2a\u6027\u8d28\uff1a\n\n$$\\operatorname{lcm}(p^i,p^j)=p^{\\max(i,j)}$$\n\n\u56e0\u6b64\uff0c\u597d\u50cf\u53ef\u4ee5\u5f97\u5230\u7b54\u6848\uff1a\n\n$$y=\\operatorname{lcm}(z\\div x^2,\\sqrt{z\\div x})$$\n\n\u4f46\u662f\u4e0d\u5bf9\u554a\uff0c\u6700\u5c0f\u516c\u500d\u6570\u5e94\u8be5\u662f\u5b9a\u4e49\u5728\u6574\u6570\u4e0a\u7684\uff0c\u54ea\u91cc\u53ef\u4ee5\u51fa\u73b0\u6709\u7406\u5206\u6570\u751a\u81f3\u4e8e\u65e0\u7406\u6570\u5462\uff1f\u7136\u540e\u5c31\u53ef\u4ee5\u53d1\u73b0\u53ef\u4ee5\u5bf9 $c$ \u7684\u90a3\u4e2a\u7b49\u5f0f\u8fdb\u884c\u4e00\u4e9b\u5c0f\u5c0f\u53d8\u5f62\uff1a\n\n$$\n\\begin{aligned}\n2c&=\\max(2a-4b,a-b) \\cr\n2c+4b&=\\max(2a,a+3b)\n\\end{aligned}\n$$\n\n\u8fd9\u4e2a\u65f6\u5019\u5c31\u80fd\u5f97\u5230\uff1a\n\n$$\n\\begin{aligned}\nx^4y^2=\\operatorname{lcm}(z^2,z\\times x^3)=\\frac{z^2\\times z\\times x^3}{\\gcd(z^2,z\\times x^3)}=\\frac{z^2x^3}{\\gcd(z,x^3)} \\cr\n\\end{aligned}\n$$\n\n\u7136\u540e\u5c31\u80fd\u53d1\u73b0\uff1a\n\n$$y=\\sqrt{\\frac{z^2}{x\\times \\gcd(z,x^3)}}=\\frac{z}{\\sqrt{x\\times \\gcd(z,x^3\\bmod z)}}$$\n\n\u4e00\u4e9b\u6ce8\u610f\u70b9\uff1a\n\n- \u56e0\u4e3a $x^3$ \u53ef\u80fd\u7206 $\\text{long long}$\uff0c\u6240\u4ee5\u8fd9\u91cc\u5229\u7528\u4e86 $\\gcd(a,b)=\\gcd(a,b\\bmod a)$ \u7684\u7ed3\u8bba\uff0c\u540c\u65f6\u4f7f\u7528\u9f9f\u901f\u4e58\u53ef\u4ee5\u4f7f\u5f97 $x^3\\bmod z$ \u5728 $\\text{long long}$ \u8303\u56f4\u5185\u3002\n- \u56e0\u4e3a\u4e0b\u9762\u7684\u6570\u5b57\u5f00\u6839\u5fc5\u7136\u8981\u662f\u6b63\u6574\u6570\uff0c\u624d\u6709\u53ef\u80fd\u4f7f\u5f97\u5b58\u5728\u8fd9\u6837\u7684 $y$\uff0c\u56e0\u6b64\u6839\u53f7\u7684 $z^2$ \u53ef\u4ee5\u76f4\u63a5\u63d0\u51fa\u6765\u3002\n- \u7136\u800c\u65e0\u6cd5\u907f\u514d $x\\times \\gcd(z,x^3\\bmod z)$ \u7167\u6837\u662f\u53ef\u4ee5\u7206 $\\text{long long}$ \u7684\u2026\u2026\u56e0\u6b64\u8fd9\u91cc\u76f4\u63a5\u4f7f\u7528 $\\text{long double}$\uff0c\u4ee5\u53ca $\\text{cmath}$ \u5e93\u5f53\u4e2d\u7684 $\\text{sqrtl}$ \u51fd\u6570\uff0c\u6765\u907f\u514d\u8fd9\u6837\u7684\u7cbe\u5ea6\u8bef\u5dee\u3002\n\n## \u53c2\u8003\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define up(l,r,i) for(int i=l,END##i=r;i<=END##i;++i)\n#define dn(r,l,i) for(int i=r,END##i=l;i>=END##i;--i)\nusing namespace std;\ntypedef long long i64;\ntypedef unsigned int       u32;\ntypedef unsigned long long u64;\nu64 gcd(u64 x,u64 y){return x==0?y:gcd(y%x,x);}\nu64 mul(u64 x,u64 y,u64 m){\n    u64 r=0; while(y){\n        if(y&1) r=(r+x)%m; y>>=1,x=(x+x)%m;\n    }\n    return r;\n}\nint main(){\n    int T; scanf(\"%d\",&T); up(1,T,TT){\n        u64 x,y,z,t,u; scanf(\"%llu%llu\",&x,&z);\n        u=mul(mul(x,x,z),x,z),t=sqrtl((long double)x*gcd(z,u)+0.5),y=z/t;\n        if(z!=x*y*gcd(x,y)) puts(\"-1\");\n        else printf(\"%llu\\n\",y);\n    }\n    return 0;\n}\n```\n",
        "postTime": 1648309491,
        "uid": 330759,
        "name": "\u56e7\u4ed9",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P8255 \u3010[NOI Online 2022 \u666e\u53ca\u7ec4] \u6570\u5b66\u6e38\u620f\u3011"
    }
]
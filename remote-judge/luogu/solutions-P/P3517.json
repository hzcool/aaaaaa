[
    {
        "content": "\u663e\u7136\u7684\u4e8c\u5206\u7b54\u6848\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u4e8c\u5206\u51fa\u7684\u7b54\u6848$mid$\uff0c\u6211\u4eec\u8981\u4f7f\u5206\u6210\u7684\u6bcf\u4e00\u6bb5\u4e2d\u6240\u6709\u70b9\u79bb\u4e2d\u5fc3\u70b9\u7684\u8ddd\u79bb\u90fd\u5c0f\u4e8e\u7b49\u4e8e$mid$\uff0c\u5f53\u7136\u6bcf\u4e00\u6bb5\u7684\u70b9\u662f\u8d8a\u591a\u8d8a\u597d\u3002\n\n\u6c42**\u4e00\u6bb5\u70b9**\u7684\u6700\u5c0f\u5706\u8986\u76d6\uff0c\u7528\u968f\u673a\u589e\u91cf\u6cd5\u53ef\u4ee5\u505a\u5230$O(len)$\uff0c\u4e0d\u4f1a\u7684\u5148\u53bb\u505a[\u6700\u5c0f\u5706\u8986\u76d6](https://www.luogu.org/problem/P1742)\u3002\n\n\u6240\u4ee5\u96be\u70b9\u5c31\u662f\u600e\u4e48\u5199$check$\u51fd\u6570\u3002\n\n\u4ee5\u627e\u7b2c\u4e00\u4e2a\u8fde\u7eed\u7684\u6700\u957f\u6bb5\u4e3a\u4f8b\uff0c\u5f53\u7136\u53ef\u4ee5\u4e00\u4e2a\u4e00\u4e2a\u679a\u4e3e\u8fc7\u53bb\u627e\u5230\u6700\u8fdc\u7684\u53f3\u7aef\u70b9\uff0c\u4f46\u662f\u53d1\u73b0\u5982\u679c\u7b2c\u4e00\u6bb5\u5c31\u662f$[1,n]$\u7684\u6bb5\u7684\u8bdd\uff0c\u8fd9\u6837\u505a\u7684\u590d\u6742\u5ea6\u5c31\u8fbe\u5230$O(n^2)$\u3002\n\n\u8003\u8651\u4f18\u5316\u4e00\u4e0b\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5de6\u7aef\u70b9\uff0c\u53ef\u4ee5\u4e8c\u5206\u4e00\u4e0b\u53f3\u7aef\u70b9\uff0c\u8fd9\u6837\u770b\u8d77\u6765\u590d\u6742\u5ea6\u66f4\u4f18\u4e00\u70b9\uff0c\u4f46\u662f\u8003\u8651\u5982\u679c\u6bcf\u4e00\u6bb5\u957f\u5ea6\u90fd\u4e3a$1$\uff0c\u90a3\u4e48\u6bcf\u6b21\u90fd\u8981\u4e8c\u5206$log$\u6b21\uff0c\u603b\u7684\u662f$O(n^2\\ log\\ n)$\uff0c\u663e\u7136\u4e5f\u4e0d\u884c\u3002\n\n\u53d1\u73b0\u590d\u6742\u5ea6\u74f6\u9888\u5728\u4e8e\u6bcf\u6b21\u4e8c\u5206\u5f97\u5230\u7684\u533a\u95f4\u957f\u662f$O(n)$\u7ea7\u7684\uff0c\u90a3\u4e48\u53ef\u4e0d\u53ef\u4ee5\u5bf9\u4e8e\u4e00\u4e2a\u5de6\u7aef\u70b9\uff0c\u5feb\u901f\u7684\u627e\u5230\u53f3\u7aef\u70b9\u7684\u8303\u56f4\u5462\uff1f\u6211\u4eec\u8003\u8651\u500d\u589e\uff0c\u8bbe\u5de6\u7aef\u70b9\u4e3a$l$\uff0c\u6211\u4eec\u500d\u589e\u6c42\u51fa\u53f3\u7aef\u70b9\u7684\u8303\u56f4\u3002\u8bbe\u500d\u589e\u5f97\u5230\u6700\u5927\u7684\u6ee1\u8db3\u6761\u4ef6\u7684\u533a\u95f4\u957f\u5ea6\u4e3a$2^k$\uff0c\u90a3\u4e48\u6211\u4eec\u4e8c\u5206\u7684\u5de6\u7aef\u70b9\u4e3a$i+2^k-1$\uff0c\u53f3\u7aef\u70b9\u4e3a$min(n,i+2^{k+1}-1)$\uff0c\u5728\u8fd9\u6bb5\u533a\u95f4\u5185\u4e8c\u5206\uff0c\u663e\u7136\u590d\u6742\u5ea6\u5c31\u6b63\u786e\u4e86\u3002\n\n\u8fd9\u9898\u597d\u50cf\u5f88\u5361\u7cbe\u5ea6\uff0c\u968f\u673a\u589e\u91cf\u6cd5\u7528\u4e0d\u540c\u7684\u968f\u673a\u79cd\u5b50\u8fd8\u4f1a$WA$\u3002\u5982\u679c\u53ea$WA$\u4e00\u4e24\u4e2a\u70b9\uff0c\u8003\u8651\u6362\u4e2a\u968f\u673a\u79cd\u5b50\u3002\n\n\u603b\u590d\u6742\u5ea6$O(n\\ log^2\\ n)$\uff0c\u4f46\u662f\u5e38\u6570\u5f88\u5927\u6240\u4ee5\u8dd1\u5f97\u5de8\u6162\u3002\n\n$Code\\ Below:$\n```cpp\n#include<bits/stdc++.h>\n#define ts cout<<\"ok\"<<endl\n#define ll long long\n#define hh puts(\"\")\n#define pc putchar\n//#define getchar() (p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\n//char buf[1<<21],*p1=buf,*p2=buf;\nusing namespace std;\nconst int N=100005;\nint n,m,res[N][2],cnt,ci;\ndouble eps=1e-10,R;\nstruct point{\n    double x,y;\n}a[N],b[N],O;\ninline int read(){\n    int ret=0,ff=1;char ch=getchar();\n    while(!isdigit(ch)){if(ch=='-') ff=-ff;ch=getchar();}\n    while(isdigit(ch)){ret=(ret<<3)+(ret<<1)+ch-'0';ch=getchar();}\n    return ret*ff;\n}\nvoid write(int x){\n    if(x<0){x=-x;putchar('-');}\n    if(x>9) write(x/10);\n    putchar(x%10+48);\n}\nvoid writeln(int x){write(x),hh;}\npoint Mid(point A,point B){\n    return (point){(A.x+B.x)/2,(A.y+B.y)/2};\n}\ndouble dist(point A,point B){\n    return sqrt((A.x-B.x)*(A.x-B.x)+(A.y-B.y)*(A.y-B.y));\n}\nvoid getO(point A,point B,point C){\n    double aa,bb,cc,dd,ee,ff;\n    aa=A.x-C.x;bb=A.y-C.y;\n    cc=B.x-C.x;dd=B.y-C.y;\n    ee=A.x*A.x+A.y*A.y-C.x*C.x-C.y*C.y;\n    ff=B.x*B.x+B.y*B.y-C.x*C.x-C.y*C.y;\n    O.x=(dd*ee-bb*ff)/(2*aa*dd-2*bb*cc);\n    O.y=(aa*ff-cc*ee)/(2*aa*dd-2*bb*cc);\n    R=dist(O,A);\n//    printf(\"%.5lf %.5lf\",O.x,O.y),hh;\n//    printf(\"%.5lf %.5lf %.5lf\",dist(O,A),dist(O,B),dist(O,C));\n}\nvoid work(int l,int r){//\u968f\u673a\u589e\u91cf\u6c42\u6700\u5c0f\u5706\u8986\u76d6,O(r-l+1)\n    int tot=0;\n    for(int i=l;i<=r;i++) b[++tot]=a[i];\n    for(int i=1;i<=tot;i++) swap(b[i],b[rand()%tot+1]);\n    O=b[1],R=0;\n    for(int i=1;i<=tot;i++){\n        if(dist(b[i],O)>R+eps){//i\u4e0d\u5728\u5706\u5185 \n            O=b[i],R=0;\n            for(int j=1;j<i;j++){\n                if(dist(b[j],O)>R+eps){//j\u4e0d\u5728\u5706\u5185\n                    O=Mid(b[i],b[j]);\n                    R=dist(O,b[i]);\n                    for(int k=1;k<j;k++)\n                        if(dist(b[k],O)>R+eps)\n                            getO(b[i],b[j],b[k]);\n                }\n            }\n        }\n    }\n}\nbool check(double lim){\n    cnt=0;\n    int ans;\n    for(int i=1;i<=n;i=ans+1){\n        int k;\n        for(k=1;i+(1<<k)-1<=n;k++){//k=0\u663e\u7136\u53ef\u884c,\u4ece1\u5f00\u59cb \n            work(i,i+(1<<k)-1);\n            if(R>lim+eps) break;\n        }\n        ans=i;\n        int l=i+(1<<(k-1))-1,r=min(n,i+(1<<k)-1);\n        while(l<=r){\n            int mid=(l+r)>>1;\n            work(i,mid);\n            if(R<lim+eps) l=mid+1,ans=mid;\n            else r=mid-1;\n        }\n        cnt++;\n        res[cnt][0]=i,res[cnt][1]=ans;\n        if(cnt>m) return 0;\n    }\n    return 1;\n}\nsigned main(){\n    srand(20031128);\n    n=read(),m=read();\n    for(int i=1;i<=n;i++){\n        a[i].x=read();\n        a[i].y=read();\n    }\n    work(1,n);\n    double l=0,r=R;\n    if(m>1){\n        ci=50;\n        while(ci--&&r-l>eps){\n            double mid=(l+r)/2;\n            if(check(mid)) r=mid;\n            else l=mid;\n        }\n    }\n    check(r);\n    printf(\"%.8lf\\n\",r);\n    writeln(cnt);\n    for(int i=1;i<=cnt;i++){\n        work(res[i][0],res[i][1]);\n        printf(\"%.8lf %.8lf\\n\",O.x,O.y);\n    }\n    return 0;\n}\n```\n",
        "postTime": 1568958550,
        "uid": 27858,
        "name": "ycyaw",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3517 \u3010[POI2011]WYK-Plot\u3011"
    }
]
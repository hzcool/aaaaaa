[
    {
        "content": "## \u601d\u8def\u6982\u8ff0\n\n\n\u9996\u5148\uff0c\u4e0d\u96be\u60f3\u5230\u672c\u9898\u53ef\u4ee5\u7528\u52a8\u6001\u89c4\u5212\u6765\u89e3\uff0c\u8fd9\u91cc\u5c31\u7701\u7565\u662f\u5982\u4f55\u60f3\u5230\u52a8\u6001\u89c4\u5212\u7684\u4e86\u3002\n\n\n###Q\uff1a\u52a8\u6001\u89c4\u5212\u7684\u72b6\u6001\u5e94\u8be5\u5982\u4f55\u8bbe\uff1f\n\n###A\uff1a\n\n\u89c2\u5bdf\u6570\u636e\u8303\u56f4\uff0c\u6211\u4eec\u53d1\u73b0\u5f00\u4e00\u4e2a 2000 \u00d7 2000 \u7684\u6570\u7ec4\u6765\u8868\u793a\u72b6\u6001\u662f\u6ca1\u6709\u95ee\u9898\u7684\u3002\n\n\u7b2c\u4e00\u4e2a\u7ef4\u5ea6\uff0c\u7edd\u5bf9\u7528\u6765\u8868\u793a\u662f\u7b2c\u51e0\u5929\uff0c\u8fd9\u4e2a\u4e0d\u7528\u591a\u60f3\u3002\n\n\u7b2c\u4e8c\u4e2a\u7ef4\u5ea6\uff0c\u5c31\u9700\u8981\u7a0d\u5fae\u601d\u8003\u601d\u8003\uff0c\u6211\u4eec\u53d1\u73b0\u5b83\u5e94\u8be5\u8bb0\u5f55\u62e5\u6709\u591a\u5c11\u5f20\u80a1\u7968\u3002\n\n\u7ed3\u5408\u4e00\u4e0b\uff0c\u6574\u7406\u51fa\uff1a $f_{i,j}$ \u8868\u793a\u7b2c$i$\u5929\u540e\u62e5\u6709$j$\u5f20\u80a1\u7968\u53ef\u4ee5\u8d5a\u5230\u7684\u6700\u591a\u94b1\u6570\u3002\n\n\n###Q\uff1a\u52a8\u6001\u89c4\u5212\u7684\u8f6c\u79fb\u65b9\u7a0b\u5e94\u8be5\u5982\u4f55\u5217\uff1f\u72b6\u6001\u7684\u521d\u503c\u600e\u4e48\u8bbe\uff1f\n\n###A\uff1a\n\n\u5206\u60c5\u51b5\u8ba8\u8bba\u3002\u67d0\u4e00\u5929\uff0c\u8981\u4e48\u4e70\u80a1\uff0c\u8981\u4e48\u5356\u80a1\uff0c\u8981\u4e48\u4e0d\u4e70\u4e5f\u4e0d\u5356\u3002\u800c\u4e70\u80a1\u53c8\u53ef\u5206\u4e3a\u4e24\u4e2a\u60c5\u51b5\uff0c\u8981\u4e48\u51ed\u7a7a\u4e70\uff0c\u8ddf\u524d\u9762\u4ea4\u4e0d\u4ea4\u6613\u6ca1\u6709\u4efb\u4f55\u5173\u7cfb\uff0c\u8981\u4e48\u5728\u524d\u9762\u4ea4\u6613\u7684\u57fa\u7840\u4e0a\u4e70\u80a1\uff0c\u901a\u4fd7\u4e00\u70b9\u8bf4\uff0c\u4e5f\u5c31\u662f\u8be5\u72b6\u6001\u662f\u5426\u9700\u8981\u7531\u524d\u9762\u7684\u72b6\u6001\u8f6c\u79fb\u800c\u6765\u3002\n\n\u90a3\u4e3a\u4ec0\u4e48\u5356\u80a1\u4e0d\u7528\u5206\u4e3a\u4e24\u4e2a\u60c5\u51b5\u5462\uff1f\u4ed4\u7ec6\u60f3\u60f3\uff0c\u600e\u4e48\u80fd\u51ed\u7a7a\u5356\u5462\uff1f\u65e2\u7136\u548c\u524d\u9762\u7684\u8d38\u6613\u6ca1\u6709\u5173\u7cfb\uff0c\u4e5f\u5c31\u662f\u8bf4\u624b\u4e0a\u6ca1\u6709\u4efb\u4f55\u4e00\u5f20\u80a1\u7968\uff0c\u54ea\u6765\u7684\u80a1\u7968\u7528\u6765\u5356\uff1f\n\n\u56e0\u6b64\uff0c\u4e00\u5171\u6709\u56db\u79cd\u60c5\u51b5\uff0c\u5176\u4e2d\u53ea\u6709\u4e00\u4e2a\u60c5\u51b5\u5e76\u4e0d\u9700\u8981\u5176\u4ed6\u72b6\u6001\u8f6c\u79fb\uff0c\u5355\u72ec\u8ba8\u8bba\uff1a\n\n\n**1 . \u51ed\u7a7a\u4e70**\n\n\u4ec5\u672c\u60c5\u51b5\u4e0b\u7684\u72b6\u6001\u53ef\u4ee5\u76f4\u63a5\u8d4b\u503c\uff0c\u5176\u4ed6\u72b6\u6001\u521d\u503c\u4e3a -inf\uff0c\u5373\uff1a\n\n$f_{i,j}=-ap_i\\ \\times \\ j$\n\n$(0 \\leqslant j \\leqslant as_i)$\n\n\n\u4e0b\u9762\u4e09\u79cd\u60c5\u51b5\uff0c\u5206\u522b\u53ef\u5217\u4e09\u4e2a\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n\n**2 . \u4e0d\u4e70\u4e5f\u4e0d\u5356**\n\n\u6700\u597d\u60f3\u4e5f\u6700\u597d\u5217\u8f6c\u79fb\u65b9\u7a0b\u7684\u4e00\u79cd\u60c5\u51b5\uff0c\u76f4\u63a5\u7531\u4e0a\u4e00\u5929\u8f6c\u79fb\uff0c\u4e14\u62e5\u6709\u80a1\u7968\u6570\u91cf\u4e0d\u53d8\u3002\u5373\uff1a\n\n$f_{i,j}$=$max(f_{i,j}\\ \\,,\\ \\, f_{i-1,j})$\n\n\n**3 . \u5728\u4e4b\u524d\u7684\u57fa\u7840\u4e0a\u4e70\u80a1\u7968**\n\n\u8fd9\u91cc\u7684\u65b9\u7a0b\u5c31\u6bd4\u8f83\u590d\u6742\u4e86\uff0c\u8fd9\u91cc\u8be6\u7ec6\u89e3\u91ca\u4e00\u4e0b\uff1a\n\n\u9898\u76ee\u4e2d\u6307\u660e\u8bf4\u4e24\u6b21\u4ea4\u6613\u9700\u8981\u81f3\u5c11\u9694 $w$ \u5929\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u4eca\u5929\u662f\u7b2c $i$ \u5929\u4ea4\u6613\uff0c\u90a3\u4e48\u4e0a\u4e00\u6b21\u4ea4\u6613\u6700\u8fd1\u662f\u5728\u7b2c $i - w - 1$ \u5929\u3002\n\n\u53ef\u6211\u7b2c $i - w - 1$ \u5929\u4e4b\u524d\u4e5f\u53ef\u4ee5\u4ea4\u6613\u554a\uff1f\u4e3a\u4ec0\u4e48\u504f\u504f\u662f\u90a3\u4e00\u5929\uff0c\u800c\u4e0d\u662f\u7b2c $i - w - 2$ \u5929\uff1f\n\n\u56de\u770b\u521a\u521a\u8ba8\u8bba\u7684\u7b2c 2 \u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u5df2\u7ecf\u628a\u67d0\u4e00\u5929\u4ee5\u524d\u7684\u6700\u4f18\u7b54\u6848\u8f6c\u79fb\u5230\u4e86\u8be5\u5929\uff0c\u6240\u4ee5\u4ece\u90a3\u4e00\u5929\u8f6c\u79fb\uff0c\u76f8\u5f53\u4e8e\u4ece\u90a3\u4e00\u5929\u5305\u62ec\u524d\u9762\u4efb\u4f55\u4e00\u5929\u5f00\u59cb\u8f6c\u79fb\uff0c\u7701\u53bb\u4e86\u5927\u628a\u65f6\u95f4\u3002\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5df2\u77e5\u7b2c $i$ \u5929\u62e5\u6709 $j$ \u5f20\u80a1\u7968\uff0c\u5047\u8bbe\u7b2c $i - w - 1$ \u5929\u62e5\u6709 $k$ \u5f20\u80a1\u7968\u3002\n\n$k$ \u4e00\u5b9a\u6bd4 $j$ \u5c0f\uff0c\u56e0\u4e3a\u8fd9\u4e00\u79cd\u60c5\u51b5\u662f\u4e70\u80a1\u7968\uff0c\u80a1\u7968\u53ea\u80fd\u591a\u3002\n\n\u4f46\u80a1\u7968\u53c8\u4e0d\u80fd\u4e70\u592a\u591a\uff0c\u9650\u5236\u6700\u591a\u4e3a $as$ \u5f20\u3002\u6240\u4ee5 $j - as_i$ \u662f\u5e95\u7ebf\u3002\n\n\u7ee7\u7eed\uff0c\u8fd9\u6b21\u4ea4\u6613\u4e70\u4e86 $j - k$ \u5f20\u80a1\u7968\uff0c\u8981\u82b1\u53bb $(j - k) \\times ap_i$ \u5143\u3002\n\n\u6574\u7406\u4e00\u4e0b\uff0c\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a\n\n$f_{i,j}$=$max(f_{i,j}\\ \\,,\\ \\,f_{i-w-1,k}-(j-k)\\times ap_i)$\n\n$(j - as_i \\leqslant k < j)$\n\n\n**4 . \u5728\u4e4b\u524d\u7684\u57fa\u7840\u4e0a\u5356\u80a1\u7968**\n\n\u548c\u4e0a\u9762\u7684\u60c5\u51b5\u7279\u522b\u7c7b\u4f3c\uff0c\u5728\u6b64\u7b80\u5355\u5730\u8bf4\u4e00\u4e0b\u533a\u522b\u3002\n\n\u56e0\u4e3a\u662f\u5356\u80a1\u7968\uff0c$k$ \u8fd9\u6b21\u8981\u6bd4 $j$ \u5927\u3002\u4f46\u8981\u5c0f\u4e8e\u7b49\u4e8e $j + bs_i$\u3002\n\n\u8fd9\u6b21\u4ea4\u6613\u5356\u4e86 $k - j$ \u5f20\u90ae\u7968\uff0c\u8d5a\u5f97 $(k - j) \\times bp_i$ \u5143\u3002\n\n\u6574\u7406\u4e00\u4e0b\uff0c\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a\n\n$f_{i,j}$=$max(f_{i,j}\\ \\,,\\ \\,f_{i-w-1,k}+(k-j)\\times bp_i)$\n\n$(j < k \\leqslant j + bs_i)$\n\n\n###Q\uff1a\u4e3a\u4ec0\u4e48\u53ef\u4ee5\u4f7f\u7528\u5355\u8c03\u6027\u4f18\u5316\uff1f\n\n###A\uff1a\n\n\u4e0a\u9762\u7684 3\uff0c4 \u4e24\u79cd\u60c5\u51b5\uff0c\u5217\u8d77\u6765\u5934\u5934\u662f\u9053\uff0c\u4f46\u6211\u4eec\u6df1\u5165\u8ba1\u7b97\uff0c\u53d1\u73b0\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u4e09\u6b21\u65b9\u7ea7\u7684\u3002\u5f88\u663e\u7136\uff0c\u6211\u4eec\u8981\u60f3\u5c3d\u529e\u6cd5\uff0c\u628a\u65f6\u95f4\u590d\u6742\u5ea6\u964d\u5230\u4e8c\u6b21\u65b9\u7ea7\u3002\n\n\u8fd9\u4e2a\u65f6\u5019\u53d1\u73b0\u90a3\u4e24\u79cd\u60c5\u51b5\uff0c\u5b9e\u9645\u4e0a\u53ef\u4ee5\u4f7f\u7528\u5355\u8c03\u6027\u4f18\u5316\u3002\u6b64\u65f6\u8fbe\u5230\u964d\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u76ee\u6807\u3002\n\n\u5c31\u4ee5\u7b2c 3 \u79cd\u60c5\u51b5\uff0c\u5728\u4e4b\u524d\u7684\u57fa\u7840\u4e0a\u4e70\u80a1\u7968\u4e3a\u4f8b\u5b50\u5427\u3002\n\n\u518d\u91cd\u590d\u63d0\u4e00\u4e0b\u90a3\u4e2a\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$f_{i,j}$=$max(f_{i,j}\\ \\,,\\ \\,f_{i-w-1,k}-(j-k)\\times ap_i)$\n\n$(j - as_i \\leqslant k < j)$\n\n\u8fd0\u7528\u4e58\u6cd5\u5206\u914d\u7387\uff1a\n\n$f_{i,j}$=$max(f_{i,j}\\ \\,,\\ \\,f_{i-w-1,k}-j\\times ap_i+k\\times ap_i)$\n\n$(j - as_i \\leqslant k < j)$\n\n\u65e2\u7136\u8981\u5c06\u72b6\u6001\u8f6c\u79fb\u7ed9 $f_{i,j}$\uff0c\u6b64\u65f6 $j$ \u53ef\u4ee5\u4ece $max$ \u4e2d\u63d0\u53d6\u51fa\uff0c\u6b64\u65f6\u8f6c\u79fb\u65b9\u7a0b\u53d8\u4e3a\uff1a\n\n$f_{i,j}$=$max(f_{i,j}\\ \\,,\\ \\,f_{i-w-1,k}+k\\times ap_i)-j\\times ap_i$\n\n$(j - as_i \\leqslant k < j)$\n\n\u6b64\u65f6\uff0c\u6211\u4eec\u53d1\u73b0\u4ee5\u4e0a\u7684\u8f6c\u79fb\u65b9\u7a0b\u7b26\u5408\u5355\u8c03\u6027\u4f18\u5316\u7684\u6761\u4ef6\uff0c\u6545\u53ef\u4ee5\u4f7f\u7528\u5355\u8c03\u6027\u4f18\u5316\u3002\n\n\u6ca1\u6709\u7406\u89e3\u5730\uff0c\u53ef\u4ee5\u8fd9\u4e48\u60f3\uff1a\u7531\u4e8e\u8f6c\u79fb\u6709\u8fd9\u4e48\u4e00\u4e2a\u533a\u95f4\u524d\u63d0\uff1a$(j - as_i \\leqslant k < j)$\uff0c\u53c8\u56e0\u4e3a\u8f6c\u79fb\u65b9\u7a0b\u4e2d\u51fa\u73b0\u4e86 max\uff0c\u4e5f\u5c31\u662f\u8bf4\u8f6c\u79fb\u7684\u76ee\u7684\u662f\u4ece\u8be5\u533a\u95f4\u4e2d\uff0c\u627e\u5230\u67d0\u4e2a\u6700\u5927\u7684\u503c\uff0c\u57fa\u7840\u597d\u7684\u4f60\u5e94\u8be5\u5df2\u7ecf\u53d1\u73b0\u8fd9\u5c31\u662f\u6ed1\u52a8\u7a97\u53e3\u4e86\u5427\uff1f\u53ea\u4e0d\u8fc7\u653e\u8fdb\u5355\u8c03\u961f\u5217\u7684\u5143\u7d20\uff0c\u662f $f_{i-w-1,k}+k\\times ap_i$\uff0c\u4f46\u8fd9\u5e76\u4e0d\u5f71\u54cd\u8f6c\u79fb\u3002\n\n\u90a3\u4e48\u7b2c 4 \u79cd\u60c5\u51b5\u7684\u8f6c\u79fb\uff0c\u6211\u5c31\u4e0d\u591a\u89e3\u91ca\u4e86\uff0c\u5b83\u7684\u8f6c\u79fb\u65b9\u7a0b\u53ef\u4ee5\u6574\u7406\u4e3a\uff1a\n\n$f_{i,j}$=$max(f_{i,j}\\ \\,,\\ \\,f_{i-w-1,k}+k \\times bp_i)-j \\times bp_i$\n\n$(j < k \\leqslant j + bs_i)$\n\n\u597d\u50cf\u9664\u4e86\u540e\u9762\u7684\u8f6c\u79fb\u533a\u95f4\u8981\u6c42\uff0c\u4e24\u4e2a\u6574\u7406\u540e\u7684\u65b9\u7a0b\u51e0\u4e4e\u90fd\u662f\u4e00\u6837\u7684\u3002\n\n\u5bf9\u4e86\uff0c\u8fd8\u6709\u4e00\u4e2a\u7ec6\u8282\uff0c\u662f\u7b2c 3 \u79cd\u60c5\u51b5\u8f6c\u79fb\u5e94\u8be5\u987a\u5e8f\uff0c\u7b2c 4 \u79cd\u60c5\u51b5\u8f6c\u79fb\u5e94\u8be5\u9006\u5e8f\uff0c\u8fd9\u4e2a\u4e0d\u96be\u7406\u89e3\uff0c\u5148\u81ea\u5df1\u60f3\u60f3\u5427\u3002\n\n\n## \u4ee3\u7801\u5b9e\u73b0\n\n\u6309\u7167\u4e0a\u9762\u7684\u601d\u8def\uff0c\u5f97\u5230\u5bf9\u5e94\u7684\u4ee3\u7801\uff1a\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#define Min(x , y) ((x) < (y) ? (x) : (y))\n#define Max(x , y) ((x) > (y) ? (x) : (y))\n\nint n , m , ap , bp , as , bs , w , ans = 0 , f[2001][2001] , l , r , q[2001];\n// f[i][j] \u8868\u793a\u7b2c i \u5929\u540e\u62e5\u6709 j \u5f20\u80a1\u7968\u8d5a\u7684\u6700\u591a\u94b1\u6570\n// l , r , q[x] \u7528\u4e8e\u5355\u8c03\u961f\u5217\n\nint main(){\n    scanf(\"%d%d%d\" , &n , &m , &w);\n    memset(f , 128 , sizeof(f)); // 128 \u5b9e\u9645\u4e0a\u7ed9 f \u6570\u7ec4\u8d4b\u7684\u662f -inf\uff0c\u53ef\u4ee5\u8bd5\u8bd5\u770b\n    for(int i = 1 ; i <= n ; i++){\n        scanf(\"%d%d%d%d\" , &ap , &bp , &as , &bs);\n        for(int j = 0 ; j <= as ; j++)\n            f[i][j] = -1 * j * ap; // \u7b2c 1 \u79cd\u60c5\u51b5\uff0c\u76f4\u63a5\u8d4b\n        for(int j = 0 ; j <= m ; j++)\n            f[i][j] = Max(f[i][j] , f[i - 1][j]); // \u7b2c 2 \u79cd\u60c5\u51b5\uff0c\u8f6c\u79fb\n        if(i <= w)\n            continue; // \u56e0\u4e3a\u7b2c 3\uff0c4 \u79cd\u60c5\u51b5\u90fd\u6709 i - w - 1\uff0c\u5982\u679c i <= w\uff0c\u4f1a\u51fa\u73b0\u8d1f\u4e0b\u6807\n        // \u7b2c 3 \u79cd\u60c5\u51b5\uff0c\u4ece\u5c0f\u8f6c\u79fb\u5230\u5927\n        l = 1 , r = 0; // \u5355\u8c03\u961f\u5217\u51c6\u5907\n        for(int j = 0 ; j <= m ; j++){\n            while(l <= r && q[l] < j - as)\n                l++; // \u628a\u8fc7\u671f\u7684\u5143\u7d20\u6254\u6389\n            while(l <= r && f[i - w - 1][q[r]] + q[r] * ap <= f[i - w - 1][j] + j * ap)\n                r--; // \u66f4\u65b0\u5355\u8c03\u961f\u5217\u5143\u7d20\n            q[++r] = j; // \u63d2\u5165\u6700\u65b0\u5143\u7d20\n            if(l <= r)\n                f[i][j] = Max(f[i][j] , f[i - w - 1][q[l]] + q[l] * ap - j * ap); \n            // \u5982\u679c\u5355\u8c03\u961f\u5217\u91cc\u6709\u5143\u7d20\uff0c\u5373\u53ef\u8f6c\u79fb\n        }\n        // \u7b2c 4 \u79cd\u60c5\u51b5\uff0c\u4ece\u5927\u8f6c\u79fb\u5230\u5c0f\n        l = 1 , r = 0; // \u5355\u8c03\u961f\u5217\u518d\u6b21\u51c6\u5907\n        for(int j = m ; j >= 0 ; j--){\n            while(l <= r && q[l] > j + bs)\n                l++; // \u628a\u8fc7\u671f\u7684\u5143\u7d20\u6254\u6389\n            while(l <= r && f[i - w - 1][q[r]] + q[r] * bp <= f[i - w - 1][j] + j * bp)\n                r--; // \u66f4\u65b0\u5355\u8c03\u961f\u5217\u5143\u7d20\n            q[++r] = j; // \u63d2\u5165\u6700\u65b0\u5143\u7d20\n            if(l <= r)\n                f[i][j] = Max(f[i][j] , f[i - w - 1][q[l]] + q[l] * bp - j * bp); \n            // \u5982\u679c\u5355\u8c03\u961f\u5217\u91cc\u6709\u5143\u7d20\uff0c\u5373\u53ef\u8f6c\u79fb\n        }\n    }\n    for(int i = 0 ; i <= m ; i++)\n        ans = Max(ans , f[n][i]); // \u6700\u540e\uff0c\u53ef\u4ee5\u7559\u80a1\u7968\uff08\u5b9e\u9645\u4e0a\u4e0d\u7559\u4efb\u4f55\u80a1\u7968\u7684\u5c31\u662f\u6700\u4f18\u7b54\u6848\uff09\uff0c\u627e\u51fa\u6700\u4f18\u7b54\u6848\n    printf(\"%d\\n\" , ans);\n    return 0;\n}\n```\n\n\n",
        "postTime": 1514895292,
        "uid": 26673,
        "name": "Sooke",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2569 \u3010[SCOI2010]\u80a1\u7968\u4ea4\u6613\u3011"
    },
    {
        "content": "\u5f88\u663e\u7136\u7684\u52a8\u6001\u89c4\u5212\u9898\uff08\u7b11\uff09\n\n\u5bb9\u6613\u60f3\u5230DP\u7684\u6570\u7ec4 f[i][j] \u8868\u793a\u7b2ci\u5929\u624b\u4e0a\u6709j\u652f\u80a1\u7968\u65f6\u80fd\u8d5a\u5230\u6700\u591a\u7684\u94b1\u3002\n\n\u63a5\u4e0b\u6765\u5c31\u662f\u8f6c\u79fb\u4e86\uff0c\u6709\u8fd9\u4e48\u591a\u53d8\u91cf\u4e00\u5b9a\u8981\u770b\u6e05\u695a\uff0c\u4ed4\u7ec6\u5730\u5206\u60c5\u51b5\u8ba8\u8bba\u3002\n\n\u6bcf\u6b21\u8f6c\u79fb\u65f6\u4e00\u5171\u6709\u56db\u79cd\u60c5\u51b5\uff1a\n\n\uff08\u5148\u4ece\u7b80\u5355\u7684\u5165\u624b\uff09\n\n#### \u4e00\u3001\u7b2ci\u5929\u4e0d\u4e70\u80a1\u7968\u4e5f\u4e0d\u4e70\n\n\u90a3\u5c31\u662f\u4ece\u524d\u4e00\u5929\u76f8\u540c\u7684\u80a1\u7968\u503c\u66f4\u65b0\u8fc7\u6765\n\n### f[i][j]=max(f[i][j],f[i-1][j]);\n\n\u90a3\u4e3a\u4ec0\u4e48\u662f\u524d\u4e00\u5929\u800c\u4e0d\u662f\u524d\u51e0\u5929\u5462\uff1f\u56e0\u4e3a\u524d\u51e0\u5929\u7684\u6700\u4f18\u503c\u90fd\u5df2\u7ecf\u66f4\u65b0\u5230\u524d\u4e00\u5929\u4e86\u5440\u3002\n\n\n\n------------\n\n \n\n#### \u4e8c\u3001\u7b2ci\u5929\u51ed\u7a7a\u4e70\u80a1\u7968\uff08\u76f8\u5f53\u4e8e\u4ece\u4e4b\u524d\u624b\u63010\u80a1\u7968\u7684\u60c5\u51b5\u66f4\u65b0\u6765\uff09\n\n\u5176\u5b9e\u5c31\u662f\u7b2ci\u5929\u7684DP\u6570\u7ec4\u7684\u521d\u59cb\u5316\n\n###  For(j,0,As[i]) f[i] [j]=-j * Ap[i];\n\n\n------------\n\n\n#### \u4e09\u3001\u7b2ci\u5929\u5728\u7b2c i-w-1 \u5929\u7684\u57fa\u7840\u4e0a\u4e70\u80a1\u7968\n\n\u90a3\u6211\u4eec\u8bbe\u7b2ci-w-1\u5929\u7684\u80a1\u7968\u6570\u4e3ak\uff0c\u6700\u76f4\u63a5\u7684\u66f4\u65b0\u5c31\u662f\u4e0b\u9762\u8fd9\u6837\n\n### f[i][j]=max(f[i][j], f[i-w-1][k]-(j-k)* Ap[i]);\n\n\u4f46\u6211\u4eec\u6b64\u65f6\u8981\u66f4\u65b0\u7684\u662fj\uff0c\u6240\u4ee5\u53ef\u4ee5\u7a0d\u7a0d\u8f6c\u5316\u4e00\u4e0b:\n\n ###  f[i][j]=max{ f[i-w-1][k]+ k Ap[i] } - j* Ap[i]\n\n\u90a3\u4e48\u6b64\u65f6k\u7684\u8303\u56f4\u662f\u591a\u5c11\u5462 \u4e0d\u96be\u60f3\u5230\u5c31\u662f **[ j-As[i], j)**\n\n\u6240\u4ee5\u5728k\u7684\u53d6\u503c\u8303\u56f4\u4e0a\uff0c\u6709\u7ecf\u9a8c\u7684OIer\u4eec\u5e94\u8be5\u90fd\u80fd\u60f3\u5230\u5355\u8c03\u961f\u5217\u4e86\u5427\uff08\uff01\uff09\n\n\u5f0f\u5b50\u4e2d\u6709\u53d6max\u503c\uff0c\u8fd8\u6709\u53d6\u503c\u8303\u56f4\u7684\u7ecf\u5e38\u90fd\u662f\u7528\u5355\u8c03\u961f\u5217\u6765\u4f18\u5316\uff08\u4e0d\u77e5\u9053\u5177\u4f53\u5982\u4f55\u64cd\u4f5c\u7684\u53ef\u4ee5\u770b\u4ee3\u7801\uff09\n\n \n\n------------\n\n\n#### \u56db\u3001\u7b2ci\u5929\u5728\u7b2ci-w-1\u5929\u7684\u57fa\u7840\u4e0a\u5356\u51fa\u80a1\u7968\n\n\u548c\u4e0a\u4e00\u79cd\u60c5\u51b5\u5176\u5b9e\u662f\u4e00\u6837\u7684\uff08\u5f0f\u5b50\u7684\u63a8\u5bfc\u8bf7\u53c2\u7167\u4e0a\u5f0f\u81ea\u5df1\u64cd\u4f5c\uff09\n\n###  f[i][j]=max{f[i-w-1][k]+k*Bp[i]}- j* Ap[i]\n\n\u53ea\u662fk\u7684\u53d6\u503c\u8303\u56f4\u4e0d\u4e00\u6837\u4e86\uff0c\u53d8\u6210\u4e86**(j, j+Bs[i] ]**\n\n\u540c\u6837\u53ef\u4ee5\u7528**\u5355\u8c03\u961f\u5217**\u6765\u4f18\u5316\u3002\n\n\u4ee3\u7801~ \n\n\u53ef\u4ee5\u5728[\u535a\u5ba2](https://www.cnblogs.com/HLAUV/p/9925646.html)\u4e2d\u67e5\u770b\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<algorithm>\n\n#define For(i,a,b) for(register int i=a;i<=b;++i)\n#define Dwn(i,a,b) for(register int i=a;i>=b;--i)\n#define Re register \n\nusing namespace std;\n\nconst int N=2e3+10;\nint f[N][N],q[N*2],qf,qr;\nint n,m,As[N],Ap[N],Bs[N],Bp[N],W,T,MaxP;\ninline void read(int &v){\n\tv=0;\n\tchar c=getchar();\n\twhile(c<'0'||c>'9')c=getchar();\n\twhile(c>='0'&&c<='9')v=v*10+c-'0',c=getchar();\n}\nint main(){\n\tread(T); read(MaxP); read(W);\n\tFor(i,1,T){\n\t\tread(Ap[i]); read(Bp[i]);\n\t\tread(As[i]); read(Bs[i]);\n\t}\n\tmemset(f,128,sizeof(f));\n\tFor(i,1,T){\n\t\t// I bought some stocks from nowhere\n\t\tFor(j,0,As[i]){\n\t\t\tf[i][j]=-1*j*Ap[i];\n\t\t}\n\t\t// I didn't buy anything\n\t\tFor(j,0,MaxP){\n\t\t\tf[i][j]=max(f[i][j],f[i-1][j]);\n\t\t}\n\t\t\n\t\tif(i-W-1<=0)continue;\n\t\t\n\t\t// I bought some stock today after W days\n\t\tqf=1; qr=0;\n\t\tFor(j,0,MaxP){\n\t\t\twhile(qf<=qr&&q[qf]<j-As[i])qf++; \n\t\t\tif(qf<=qr){\n\t\t\t\tint k=q[qf];\n\t\t\t\tf[i][j]=max(f[i][j],f[i-W-1][k]+k*Ap[i]-j*Ap[i]);\n\t\t\t}  \n\t\t\twhile(qf<=qr&&f[i-W-1][q[qr]]+q[qr]*Ap[i]<=f[i-W-1][j]+j*Ap[i])qr--;\n\t\t\tq[++qr]=j;\n\t\t}\n\t \n\t\t// I sold some stock today after W days\n\t\tqf=1; qr=0;\n\t\tDwn(j,MaxP,0){\n\t\t\twhile(qf<=qr&&q[qf]>j+Bs[i])qf++;\n\t\t\tif(qf<=qr){\n\t\t\t\tint k=q[qf];\n\t\t\t\tf[i][j]=max(f[i][j],f[i-W-1][k]+k*Bp[i]-j*Bp[i]);\n\t\t\t}\n\t\t\twhile(qf<=qr&&f[i-W-1][q[qr]]+q[qr]*Bp[i]<=f[i-W-1][j]+j*Bp[i])qr--;\n\t\t\tq[++qr]=j;\n\t\t}\n\t}\n\tint fn=-2147483600;\n\tFor(i,0,MaxP)fn=max(fn,f[T][i]);\n\tcout<<fn<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1541596573,
        "uid": 86041,
        "name": "_LAUV_",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2569 \u3010[SCOI2010]\u80a1\u7968\u4ea4\u6613\u3011"
    },
    {
        "content": "\u5bb9\u6613\u60f3\u5230\u65b9\u7a0bf[i][j]\u8868\u793a\u7b2c i \u5929\u7ed3\u675f\u540e\uff0c\u624b\u91cc\u5269\u4e0b j \u80a1\u7684\u6700\u5927\u5229\u6da6\n\n\u5219 \u4e0d\u4e70\u4e0d\u5356\uff1af[i][j]=f[i-1][j]\n\n\u4e70\u5165\uff1a    f[i][j]=max{f[i-w-1][k]-ap[i]\\*(j-k)}(j-as[i]<=k<=j-1)\n\n\u5356\u51fa\uff1a    f[i][j]=max{f[i-w-1][k]+bp[i]\\*(k-j)}(j+1<=k<=j+bs[i])\n\n\u6b64\u65f6\u590d\u6742\u5ea6\u4e3aO(N\\*W^2)\n\n\u800c\u5c06\u65b9\u7a0b\u53d8\u5f62\u53ef\u5f97:\n\n\u4e70\u5165\uff1af[i][j]=max{f[i-w-1][k]+k\\*ap[i]}-ap[i]\\*j\n\n\u5356\u51fa\uff1af[i][j]=max{f[i-w-1][k]+k\\*bp[i]}-bp[i]\\*j\n\n\u6240\u4ee5\u53ef\u4ee5\u5c06\u62ec\u53f7\u91cc\u9762\u7684\u65b9\u7a0b\u5f0f\u538b\u5165\u5355\u8c03\u961f\u5217 \u6b64\u65f6\u590d\u6742\u5ea6\u964d\u4f4e\u4e3a\u590d\u6742\u5ea6O(N\\*W)\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<cstdlib>\n#include<algorithm>\nusing namespace std;\nint t,maxp,w;\nint ap[2010],bp[2010],as[2010],bs[2010];\nint f[2010][2010];\nint q[10000],qhead=1,qtail=0;\nint main()\n{\n    scanf(\"%d%d%d\",&t,&maxp,&w);\n    for(int i=1;i<=t;i++)\n    scanf(\"%d%d%d%d\",&ap[i],&bp[i],&as[i],&bs[i]);\n    memset(f,-0x7f,sizeof(f));\n    for(int i=0;i<=t;i++) f[i][0]=0;\n    for(int i=1;i<=t;i++)\n    {\n        for(int j=0;j<=as[i];j++) f[i][j]=-ap[i]*j;\n        for(int j=maxp;j>=0;j--)  f[i][j]=max(f[i][j],f[i-1][j]);\n        if(i-w-1>=0)\n        {\n            qhead=1;qtail=0;\n            for(int j=0;j<=maxp;j++)\n            {\n                while(qhead<=qtail&&q[qhead]<j-as[i]) qhead++;\n                while(qhead<=qtail&&f[i-w-1][j]+ap[i]*j>=f[i-w-1][q[qtail]]+ap[i]*q[qtail]) qtail--;\n                q[++qtail]=j;\n                if(qhead<=qtail) f[i][j]=max(f[i][j],f[i-w-1][q[qhead]]-ap[i]*(j-q[qhead])); \n            } \n            qhead=1;qtail=0;\n            for(int j=maxp;j>=0;j--)\n            {\n                while(qhead<=qtail&&q[qhead]>j+bs[i]) qhead++;\n                while(qhead<=qtail&&f[i-w-1][j]+bp[i]*j>=f[i-w-1][q[qtail]]+bp[i]*q[qtail]) qtail--;\n                q[++qtail]=j;\n                if(qhead<=qtail) f[i][j]=max(f[i][j],f[i-w-1][q[qhead]]+bp[i]*(q[qhead]-j));\n            } \n        } \n    }\n    int ans=0;\n    for(int i=0;i<=maxp;i++) ans=max(f[t][i],ans);\n    printf(\"%d\",ans);\n    return 0;\n}\n//\u4e0a\u9762\u7684\u60f3\u6cd5\u548c\u8bb2\u89e3\u5f15\u7528\u7684\u662f\u5e38\u5dde\u4e00\u4e2d\u7684\u4e00\u4f4d\u5927\u795e(Krydom)\n\n```",
        "postTime": 1478961429,
        "uid": 22060,
        "name": "Memorize",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2569 \u3010[SCOI2010]\u80a1\u7968\u4ea4\u6613\u3011"
    },
    {
        "content": "### \u9898\u76ee\u5927\u610f\uff1a\n\n\u4f60\u521d\u59cb\u65f6\u6709\u221e\n\u5143\u94b1\uff0c\u5e76\u4e14\u6bcf\u5929\u6301\u6709\u7684\u80a1\u7968\u4e0d\u8d85\u8fc7\nMaxp\n\u3002\n\u6709\nT\n\u5929\uff0c\u4f60\u77e5\u9053\u6bcf\u4e00\u5929\u7684\u4e70\u5165\u4ef7\u683c\uff08\nAP[i]\n\uff09\uff0c\u5356\u51fa\u4ef7\u683c\uff08\nBp[i]\n\uff09\uff0c\n\u4e70\u5165\u6570\u91cf\u9650\u5236\uff08\nAS[i]\n\uff09\uff0c\u5356\u51fa\u6570\u91cf\u9650\u5236\uff08\nBS[i]\n\uff09\u3002\n\u5e76\u4e14\u4e24\u6b21\u4ea4\u6613\u4e4b\u95f4\u5fc5\u987b\u95f4\u9694\nW\n\u5929\u3002\n\u73b0\u5728\u95ee\u4f60\nT\n\u5929\u7ed3\u675f\u540e\uff0c\u6700\u5927\u6536\u76ca\u662f\u591a\u5c11\u3002\n\n### \u5206\u6790\uff1a\n\n\u6ce8\u610f\u5bf9\u9898\u610f\u7684\u7406\u89e3\uff0c\u867d\u7136\u6709\u65e0\u9650\u7684\u94b1\uff0c\u4f46\u662f\u4e70\u80a1\u7968\u662f\u8981\u51cf\u5c11\u5f53\u524d\u7684\u6536\u76ca\u7684\uff0c\u6536\u76ca\u662f\u5356\u51fa\u7684\u603b\u94b1\u6570\u51cf\u53bb\u4e70\u5165\u7684\u94b1\u6570\u3002\u6536\u76ca\u5e76\u4e0d\u662f\u53ea\u589e\u4e0d\u51cf\u3002\n\n\u53ef\u4ee5\u60f3\u5230\u7684\u662f\uff1a\u52a8\u6001\u89c4\u5212\u3002\u8bbef[i][j]\u8868\u793a\u524di\u5929\u4e4b\u540e\uff0c\u5269\u4e0bj\u80a1\u80a1\u7968\u7684\u6700\u5927\u6536\u76ca\u3002\u663e\u7136\u6839\u636e\u9898\u610f\uff0c\u5728j\u76f8\u540c\u7684\u65f6\u5019\uff0ci\u8d8a\u5f80\u540e\u7684\u65f6\u5019\uff0cf[i][j]\u8d8a\u5927\u3002\n\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff0c\u4e70\u5165\u548c\u5356\u51fa\u662f\u76f8\u540c\u7684\u601d\u8def:\n\n\u5356\u51fa\uff1a\n\nf[i][j]=max(f[i-w-1][k]+(k-j)\u00d7bp[i]) (j<=k<=j+bs[i])\n\n\u4e70\u5165\uff1a\n\nf[i][j]=max(f[i-w-1][k]-(j-k)\u00d7ap[i]) (j-as[i]<=k<=j)\n\n\u8fd9\u79cd\u60c5\u51b5\u7684\u590d\u6742\u5ea6\u662fO(T\u00d7Mp\u00d7Mp)\u76f4\u63a5T\u6389\u3002\n\n\u5c06\u8f6c\u79fb\u65b9\u7a0b\u62ec\u53f7\u5c55\u5f00\uff0c\u53d1\u73b0\uff1a\n\nf[i-w-1][k]+(k-j)\u00d7bp[i]=(f[i-w-1][k]+k\u00d7bp[i])-j\u00d7bp[i]\n\n\u5728\u7ed9\u5b9ai\uff0cj\u7684\u65f6\u5019\uff0c\u552f\u4e00\u5728\u53d8\u7684\u53d8\u91cf\u5c31\u662fk\uff0ck\u7684\u53d6\u503c\u4f1a\u5f71\u54cd\u6700\u5927\u503c\u3002\u800c\u4e14\u7ed9\u4e88j\u6b63\u786e\u7684\u5faa\u73af\u987a\u5e8f\uff0ck\u7684\u53d6\u503c\u533a\u95f4\u662f\u9010\u6e10\u5728\u5e73\u79fb\u7684\u3002\n\n#### \u60f3\u5230\u4e86\u4ec0\u4e48\uff1f\n\n\u6ed1\u52a8\u7a97\u53e3\uff01\u5355\u8c03\u961f\u5217\uff01\u5355\u8c03\u961f\u5217\u4f18\u5316DP\uff01\n\n\u6211\u4eec\u5916\u5c42\u5faa\u73afi\uff0c\u5185\u5c42\u5faa\u73afj\uff0c\u6bcf\u6b21\u5148\u9664\u53bb\u8fc7\u671f\u7684\u89e3\uff0c\u52a0\u4e0a\u65b0\u7684\u9009\u62e9\uff0c\u518d\u4ece\u5355\u8c03\u961f\u5217\u961f\u5934\u53d6\u51fa\u6700\u4f18\u89e3\uff0c\u8fdb\u884c\u66f4\u65b0\u3002\n\n#### \u6ce8\u610f\uff1a\n1.\u5728\u4e70\u5165\u548c\u5356\u51fa\u65f6\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u80fd\u8f6c\u79fb\u5fb7\u5230j\u7684\u6240\u6709\u5143\u7d20\u90fd\u5728\u961f\u5217\u91cc\uff0cj\u7684\u5faa\u73af\u987a\u5e8f\u662f\u4e0d\u540c\u7684\u3002\n\n2.\u5bf9\u4e8e\u7ed9\u5b9a\u7684i\uff0c\u5904\u7406\u4e70\u5165\u5356\u51fa\u7684\u987a\u5e8f\u53ef\u4ee5\u98a0\u5012\u3002\u65e0\u6240\u8c13\u3002\n\n3.\u5f53i-w-1\u5c0f\u4e8e0\u65f6\uff0c\u53d60\u5373\u53ef\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=2000+10;\nint t,mp,w;\nint f[N][N];\nint ans;\nint q[N],hd=1,tl=0;\nint main()\n{\n\tscanf(\"%d%d%d\",&t,&mp,&w);\n\tint ap,bp,as,bs;//\u5e76\u4e0d\u9700\u8981\u6570\u7ec4\n\tmemset(f,0xcf,sizeof f);//\u521d\u503c\u8d1f\u65e0\u7a77\n\tf[0][0]=0;\n\tfor(int i=1;i<=t;i++)\n\t{\n\t\tscanf(\"%d%d%d%d\",&ap,&bp,&as,&bs);\n\t\thd=1,tl=0;\n\t\tint from=max(0,i-w-1);//\u4ece\u4f55\u8f6c\u79fb\n\t\tfor(int j=mp;j>=0;j--)//\u5356\u51fa\n\t\t{\n\t\t\tf[i][j]=max(f[i][j],f[i-1][j]);//\u53ef\u4ee5\u4eca\u5929\u4e0d\u4e70\u4e0d\u5356\n\t\t\twhile(hd<=tl&&(j+bs<q[hd])) hd++;//\u9664\u53bb\u8fc7\u671f\u8005\n\t\t\twhile(hd<=tl&&(f[from][q[tl]]+q[tl]*bp<f[from][j]+j*bp)) tl--;//\u56e0\u4e3a\u4ecei\u7684\u4e0a\u4e00\u4e2a\u72b6\u6001\u6765\uff0c\u6240\u4ee5\u5148\u52a0\u5165\u65b0\u5143\u7d20\n\t\t\tq[++tl]=j;\n\t\t\t f[i][j]=max(f[i][j],f[from][q[hd]]+q[hd]*bp-j*bp);\n\t\t}\t\n\t\thd=1,tl=0;\n\t\tfor(int j=0;j<=mp;j++)//\u4e70\u5165\n\t\t{\n\t\t\tf[i][j]=max(f[i][j],f[i-1][j]);\n\t\t\twhile(hd<=tl&&(j-as>q[hd])) hd++;\n\t\t\twhile(hd<=tl&&(f[from][q[tl]]+q[tl]*ap<f[from][j]+j*ap)) tl--;\n\t\t\tq[++tl]=j;\n\t\t\t f[i][j]=max(f[i][j],f[from][q[hd]]+q[hd]*ap-j*ap);\n\t\t}\n\t}\n\tfor(int j=0;j<=mp;j++)\n\t ans=max(ans,f[t][j]);\n\tprintf(\"%d\",ans);\n\treturn 0;\n}\n```\n\n#### \u603b\u7ed3\uff1a\n\n1.\u5bf9\u4e8e\u51b3\u7b56\u8f6c\u79fb\u65f6\uff0c\u6709\u660e\u663e\u5355\u8c03\u6027\u7684\u60c5\u51b5\uff0c\u5bf9\u4e8e\u72b6\u6001\u79fb\u52a8\u65f6\uff0c\u8f6c\u79fb\u51b3\u7b56\u91cd\u590d\u5ea6\u8f83\u5927\u3002\u90fd\u53ef\u7528\u5355\u8c03\u961f\u5217\u4f18\u5316\u3002\n\n2.\u5355\u8c03\u961f\u5217\u5229\u7528\u6bcf\u4e2a\u5143\u7d20\u53ea\u80fd\u8fdb\u4e00\u6b21\uff0c\u51fa\u4e00\u6b21\uff0c\u4f7f\u5f97O(n)\u53d8\u4e3a\u5747\u644aO(1)\u590d\u6742\u5ea6\uff0c\u7b80\u5316\u65f6\u95f4\u3002\n\n",
        "postTime": 1524749614,
        "uid": 56672,
        "name": "\u67ab\u6797\u665a",
        "ccfLevel": 9,
        "title": "P2569 \u80a1\u7968\u4ea4\u6613"
    },
    {
        "content": "## \u9898\u89e3- P2569 \u80a1\u7968\u4ea4\u6613\n\n* **\u9898\u76ee\u610f\u601d**\n\t\n    \u7531\u4e8e\u9898\u9762\u8fc7\u957f\uff0c\u4e0d\u518d\u63cf\u8ff0\u3002\n    [\u6233\u8fd9\u91cc](https://www.luogu.com.cn/problem/P2569)\n    \n* $Sol$\n\n\t\u8fd9\u9053\u9898\u76ee\u60f3\u6e05\u695a\u540e\u8fd8\u662f\u4e0d\u96be\u7684\uff0c\u662f\u4e00\u9053\u4e0d\u9519\u7684\u5355\u8c03\u961f\u5217\u7ec3\u4e60\u9898\u3002\n    \n    \u9996\u5148\u6211\u4eec\u8981\u660e\u786e**\u72b6\u6001**\uff1a \n    \n    $f_{i,j}$\u8868\u5f0f\u5230\u7b2c$i$\u5929\u62e5\u6709$j$\u4e2a\u80a1\u7968\u7684\u6700\u5927\u6536\u76ca\u3002\n    \n    \u8fd9\u4e2a\u72b6\u6001\u8fd8\u662f\u633a\u663e\u7136\u7684\uff0c\u4e0d\u50cf\u67d0\u4e9b\u9898\u76ee\u5361\u72b6\u6001\u3002\n    \n    \u5bf9\u4e8e\u8f6c\u79fb\uff0c\u8981\u5206\u6210\u591a\u79cd\u60c5\u51b5\u6765\u8003\u8651\uff1a\n    \n    $(I)$ \u6211\u4eec\u5c31\u662f\u6ca1\u6709\u4efb\u4f55\u79ef\u84c4\u7684\u60c5\u51b5\u4e0b\u4e70\uff08\u76f8\u5f53\u4e8e\u4e00\u4e2a\u521d\u59cb\u5316\uff09\uff0c\u6b64\u65f6\u8f6c\u79fb\u663e\u7136\n    \n    $f_{i,j}=-j \\times AP_i $ $(j\\leq MaxP)$\n     \n    $(II)$ \u6211\u4eec\u5f53\u5929\u9009\u62e9\u4e0d\u4e70\u4e5f\u4e0d\u4e70\n     \n    $f_{i,j}=\\max [f_{i-1,j},f_{i,j}]$\n    \n    **\u8fd9\u4e2a\u5e94\u8be5\u6bd4\u8f83\u597d\u7406\u89e3\u5c31\u662f\u7ee7\u627f\u539f\u6765\u7684\u6700\u5927\u6536\u76ca\u3002**\n        \n    $(III)$ \u5df2\u7ecf\u6709\u8d44\u91d1\u57fa\u7840\u4e0b\u4e70\u80a1\u7968,\u6b64\u65f6\u5982\u4f55\u8f6c\u79fb\u5462\uff1f\n    \n    \u6211\u4eec\u8003\u8651\u4e0a\u6b21\u4e70\u6709\u591a\u5c11\u80a1\u7968$k$\uff0c\u5219\u8f6c\u79fb\u5f88\u663e\u7136\uff1a\n    \n    $f_{i,j}=\\max [f_{i-w-1,k}-(j-k) \\times AP_i,f_{i,j}]$\n    \n    **\u5982\u4f55\u7406\u89e3\u5462\uff1f\u5c31\u662f\u4e0a\u6b21\u8d2d\u4e70\u65f6\u95f4\u4e3a$(i-w-1)$\uff0c\u95f4\u9694$w$\u5929\u4e70\u561b\u3002\u4e14\u56e0\u4e3a\u8fd9\u6b21\u662f\u4e70\u8fdb\uff0c\u6570\u91cf\u8981\u6bd4\u4e0a\u6b21\u591a\uff0c\u7684\u6240\u4ee5$k\\leq j$\u3002\u6240\u4ee5\u8fd9\u6b21\u8f6c\u79fb\u662f\u8fd9\u6837\u7684\u3002**\n    \n    $(IV)$ \u5df2\u7ecf\u6709\u8d44\u91d1\u57fa\u7840\u4e0b\u5356\u80a1\u7968,\u6b64\u65f6\u5982\u4f55\u8f6c\u79fb\u5462\uff1f\n    \n    \u6211\u4eec\u8003\u8651\u4e0a\u6b21\u4e70\u6709\u591a\u5c11\u80a1\u7968$k$\uff0c\u5219\u8f6c\u79fb\u5f88\u663e\u7136\uff1a\n    \n    $f_{i,j}=\\max [f_{i-w-1,k}+(k-j) \\times BP_i,f_{i,j}]$\n    \n    **\u5982\u4f55\u7406\u89e3\u5462\uff08\u548c$III$\u540c\u7406)\uff1f\u5c31\u662f\u4e0a\u6b21\u8d2d\u4e70\u65f6\u95f4\u4e3a$(i-w-1)$\uff0c\u95f4\u9694$w$\u5929\u4e70\u561b\u3002\u4e14\u56e0\u4e3a\u8fd9\u6b21\u662f\u5356\u51fa\uff0c\u6570\u91cf\u8981\u6bd4\u4e0a\u6b21\u5c11\uff0c\u7684\u6240\u4ee5$j\\leq k$\u3002\u6240\u4ee5\u8fd9\u6b21\u8f6c\u79fb\u662f\u8fd9\u6837\u7684\u3002**\n    \n    \u4f46\u662f\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u5b58\u5728\u95ee\u9898\u7684\uff0c\u5927\u6982\u4e3a$O(T \\times MaxP^2)$\uff0c\u53ef\u4ee5\u83b7\u5f97$50$\u5206\u7684\u597d\u6210\u7ee9\u3002\u6211\u4eec\u8003\u8651\u4f18\u5316\uff0c\u5355\u8c03\u961f\u5217\uff1f\u7ebf\u6bb5\u6811\uff1f\n    \n    \u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u8f6c\u79fb\u7b26\u5408\u5355\u8c03\u6027\u4f18\u5316\u539f\u5219\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528**\u5355\u8c03\u961f\u5217**\u6765\u4f18\u5316\u3002\u5bf9\u4e8e$(III),(IV)$\u60c5\u51b5\u6211\u4eec\u5c31\u50cf\u6ed1\u52a8\u7a97\u53e3\u4e00\u6837\u505a\u3002\u53ea\u8981\u505a$(III)$\u7684\u65f6\u5019\u6b63\u7740\u626b\uff0c$(IV)$\u65f6\u5019\u5230\u8fd9\u505a\uff08\u56e0\u4e3a\u5356\u51fa\u53bb\uff0c\u4e0a\u6b21\u80a1\u7968\u80af\u5b9a\u6bd4\u8fd9\u6b21\u591a\uff09\u3002\u5e94\u8be5\u6bd4\u8f83\u597d\u7406\u89e3\u5427\u3002\n    \n    \u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2a\u663e\u800c\u6613\u89c1\u7684\u4f18\u5316\uff1a\u5c31\u662f\u5982\u679c\u73b0\u5728\u7684\u5929\u6570$\\leq w$\u662f\u4e0d\u7528\u505a$(III),(IV)$\u7684\u3002\n    \n    \u8fd9\u6837\u590d\u6742\u5ea6\u5c31\u53d8\u4e3a$O(T \\times MaxP)$\uff0c\u53ef\u4ee5\u8f7b\u677e\u8fc7\u6389\u8fd9\u9053\u9898\u76ee\u3002\n    \n* $Code$\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\n\ninline int read()\n{\n\tint sum=0,ff=1; char ch=getchar();\n\twhile(!isdigit(ch))\n\t{\n\t\tif(ch=='-') ff=-1;\n\t\tch=getchar();\n\t}\n\twhile(isdigit(ch))\n\t\tsum=sum*10+(ch^48),ch=getchar();\n\treturn sum*ff;\n}\n\nconst int N=2005;\n\nint T,MP,W,AP[N],BP[N],AS[N],BS[N],ans;\nint f[N][N],q[N];\n\ninline int max(int i,int j)\n{\n\treturn (i>j)?i:j;\n}\n\nsigned main()\n{\n\tT=read();\n\tMP=read();\n\tW=read();\n\tfor ( int i=1;i<=T;i++ )\n\t{\n\t\tAP[i]=read();\n\t\tBP[i]=read();\n\t\tAS[i]=read();\n\t\tBS[i]=read();\n\t}\n\tmemset(f,-63,sizeof(f));\n\tfor ( int i=1;i<=T;i++ ) \n\t{\n\t\tfor ( int j=0;j<=AS[i];j++ ) \n\t\t\tf[i][j]=-1ll*j*AP[i];\n\t\tfor ( int j=0;j<=MP;j++ ) \n\t\t\tf[i][j]=max(f[i][j],f[i-1][j]);\n\t\tif(i<=W) continue;\n\t\tint head=1,tail=0;\n\t\tfor ( int j=0;j<=MP;j++ )\n\t\t{\n\t\t\twhile(head<=tail && q[head]<j-AS[i]) head++;\n\t\t\twhile(head<=tail && f[i-W-1][q[tail]]+q[tail]*AP[i]<=f[i-W-1][j]+j*AP[i]) tail--;\n\t\t\tq[++tail]=j;\n\t\t\tif(head<=tail) \n\t\t\t\tf[i][j]=max(f[i-W-1][q[head]]-(j-q[head])*AP[i],f[i][j]);\n\t\t}\n\t\thead=1,tail=0;\n\t\tfor ( int j=MP;j>=0;j-- )\n\t\t{\n\t\t\twhile(head<=tail && q[head]>j+BS[i]) head++;\n\t\t\twhile(head<=tail && f[i-W-1][q[tail]]+q[tail]*BP[i]<=f[i-W-1][j]+j*BP[i]) tail--;\n\t\t\tq[++tail]=j;\n\t\t\tif(head<=tail) \n\t\t\t\tf[i][j]=max(f[i-W-1][q[head]]+(q[head]-j)*BP[i],f[i][j]);\n\t\t}\n\t}\n\tans=-1e12;\n\tfor ( int i=0;i<=MP;i++ ) ans=max(ans,f[T][i]);\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1581846420,
        "uid": 308464,
        "name": "\u5947\u7c73",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2569 \u3010[SCOI2010]\u80a1\u7968\u4ea4\u6613\u3011"
    },
    {
        "content": "```\n/*\u5355\u8c03\u961f\u5217\u4f18\u5316dp\n\u9996\u5148\u8bbe\u8ba1\u72b6\u6001\uff0c\u89c2\u5bdf\u5230\u5f53\u7b2ci\u5929\u7ed3\u675f\u4ee5\u540e\uff0c\u53ea\u6709\u8be5\u5929\u6301\u6709\u7684\u80a1\u7968\u6570\u5bf9\u4e4b\u540e\u7684\u8ba1\u7b97\u4f1a\u4ea7\u751f\u5f71\u54cd\uff1a\n\u800c\u4e14\u4ea4\u6613\u7684\u65f6\u95f4\u9650\u5236W\u53ef\u4ee5\u7528\u8f6c\u79fb\u65b9\u7a0b\u6765\u5b9e\u73b0\uff0c\u6240\u4ee5\u72b6\u6001\u8bbe\u8ba1\u5982\u4e0b \ndp[i][j]\uff1a\u7b2ci\u5929\u7ed3\u675f\u540e\uff0c\u6301\u6709\u80a1\u7968\u6570\u4e3aj\u7684\u60c5\u51b5\u4e0b\u80fd\u83b7\u5f97\u7684\u6700\u5927\u6536\u76ca\uff08\u53ef\u6b63\u53ef\u8d1f\uff09\uff0c\n\u89c2\u5bdf\u53d1\u73b0\u5728\u7b2ci\u5929\u8981\u4e48\u4e70\u8fdb\u8981\u4e48\u5356\u51fa\uff0c\u65e2\u4e70\u8fdb\u53c8\u5356\u51fa\u5fc5\u5b9a\u4e0d\u8d5a(APi>=BPi)\uff0c\u5219\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a\ndp[i][j] = max{dp[i-1][j]                  \u7b2ci\u5929\u4e0d\u4ea4\u6613\n\t\t\t   - j * Api                   \u7b2ci\u5929\u4ece\u96f6\u4e70\u8fdb\uff0cj <= ASi \n\t\t \t   dp[i-W-1][j+x] + x * Bpi    \u7b2ci\u5929\u5356\u51fa\uff0cx <= BSi\uff0ci > W+1 \n\t\t\t   dp[i-W-1][j-x] - x * Api}   \u7b2ci\u5929\u4e70\u8fdb\uff0cx <= ASi\uff0ci > W+1 \n\u8f6c\u79fb\u65b9\u7a0b\u4f53\u73b0\u4e86\u4ea4\u6613\u5929\u6570W\u7684\u7ea6\u675f\uff0c\u590d\u6742\u5ea6\u662fO(n^3)\uff0c\u4f1aTLE\uff0c\u9700\u8981\u4f18\u5316\n\u4ee5\u5356\u51fa\u4e3a\u4f8b\uff0c\u6211\u4eec\u8981\u6c42\u6700\u5927\u503c\uff0c\u4f7f\u7528\u5355\u8c03\u9012\u51cf\u961f\u5217\uff0c\u961f\u5217\u957f\u5ea6<=BSi\n\u8fd9\u91cc\u9700\u8981\u5904\u7406\u4e00\u4e0b\u5356\u51fa\u7684\u6536\u76ca\u95ee\u9898\uff0c\u5165\u961f\u5217\u7684\u65f6\u5019\u6211\u4eec\u5c06\u6240\u6709\u7684\u80a1\u7968\u8f6c\u6362\u6210\u8d44\u4ea7\uff0c\n\u5373\u5355\u8c03\u961f\u5217\u5185\u7ef4\u62a4\u7684\u662f\u6700\u5927\u8d44\u4ea7\uff0c\u51fa\u961f\u5217\u7684\u65f6\u5019\u518d\u628a\u8d44\u4ea7\u8f6c\u6362\u6210\u5bf9\u5e94\u7684\u80a1\u7968\uff0c\u4e70\u8fdb\u540c\u7406 */\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#define MAXN 2005\nusing namespace std;\nint n, m, W, h, t, ans, dp[MAXN][MAXN];\nstruct stock{\n\tint AP, BP, AS, BS; //AP\u4e70\u8fdb\u4ef7\u683c\uff0cBP\u5356\u51fa\u4ef7\u683c\uff0cAS\u4e70\u5165\u9650\u5236\uff0cBS\u5356\u51fa\u9650\u5236 \n}a[MAXN];\nstruct asset{\n\tint v, id;\n}q[MAXN];\ninline int read()\n{\n    int x = 0; char c = getchar();\n    while(c > '9' || c < '0') c = getchar();\n    while(c <= '9' && c >= '0'){\n        x = (x << 3) + (x << 1) + c - 48; c = getchar();}\n    return x;\n}\nint main()\n{\n\tn = read(); m = read(); W = read();\n\tfor(int i = 1; i <= n; i++)\n\t\ta[i].AP = read(), a[i].BP = read(), a[i].AS = read(), a[i].BS = read();\n\tmemset(dp, 0xb3, sizeof(dp));      //\u521d\u59cb\u5316\u4e3a\u8d1f\u65e0\u7a77 \n\tdp[0][0] = 0; \n\tfor(int i = 1; i <= n; i++)\n\t{\n\t\tfor(int j = 0; j <= a[i].AS; j++)\n\t\t\tdp[i][j] = - j * a[i].AP;  //\u7b2c\u4e00\u6b21\u4e70\u5165 \n\t\tfor(int j = 0; j <= m; j++)\n\t\t\tdp[i][j] = max(dp[i - 1][j], dp[i][j]); //\u4e0d\u4e70\u8fdb\u4e5f\u4e0d\u5356\u51fa\n\t\tif(i <= W + 1) continue;       //\u4e0d\u6ee1\u8db3\u4ea4\u6613\u65f6\u95f4\u9650\u5236\uff0c\u6ca1\u5f97\u4ea4\u6613 \n\t\th = 1; t = 0;\n\t\tfor(int j = 0, d; j <= m; j++) //\u7b2ci\u5929\u4e70\u8fdb\n\t\t{\n\t\t\td = i - W - 1; \n\t\t\twhile(h <= t && j - q[h].id > a[i].AS) h++;    //\u961f\u5217\u957f\u5ea6<=ASi\n\t\t\twhile(h <= t && q[t].v < dp[d][j] + j * a[i].AP) t--; //\u8d44\u4ea7\u5355\u8c03\u9012\u51cf \n\t\t\tq[++t] = asset{dp[d][j] + j * a[i].AP, j};\n\t\t\tdp[i][j] = max(dp[i][j], q[h].v - j * a[i].AP);//\u5f53\u5929\u7ed3\u675f\u540e\u7684\u8d44\u4ea7\u5305\u62ec\u80a1\u7968\n\t\t} \n\t\th = 1; t = 0; \n\t\tfor(int j = m, d; j >= 0; j--) //\u7b2ci\u5929\u5356\u51fa\n\t\t{ \n\t\t\td = i - W - 1;\n\t\t\twhile(h <= t && q[h].id - j > a[i].BS) h++;    //\u961f\u5217\u957f\u5ea6<=BSi\n\t\t\twhile(h <= t && q[t].v < dp[d][j] + j * a[i].BP) t--;//\u8d44\u4ea7\u5355\u8c03\u9012\u51cf \n\t\t\tq[++t] = asset{dp[d][j] + j * a[i].BP, j};\n\t\t\tdp[i][j] = max(dp[i][j], q[h].v - j * a[i].BP);//\u5f53\u5929\u7ed3\u675f\u540e\u7684\u8d44\u4ea7\u5305\u62ec\u80a1\u7968 \n\t\t}\n\t}\n\tfor(int j = 0; j <= m; j++) ans = max(ans, dp[n][j]); \n\tprintf(\"%d\", ans); \n\treturn 0;\n} \n```",
        "postTime": 1528967877,
        "uid": 65531,
        "name": "18811162081lyh",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2569 \u3010[SCOI2010]\u80a1\u7968\u4ea4\u6613\u3011"
    },
    {
        "content": "## \u9898\u76ee\u603b\u7ed3\n\n![](https://cdn.luogu.com.cn/upload/pic/20550.png)\n\n## \u6570\u636e\u8303\u56f4\n\n0<=W<T<=2000,1<=MaxP<=2000\n\n1<=BPi<=APi<=1000,1<=ASi,BSi<=MaxP\n\n## \u89e3\u9898\u601d\u8def\n\n\u4e00\u9053\u88f8\u7684\u5355\u8c03\u961f\u5217\u4f18\u5316DP\uff1b\n\n![](https://cdn.luogu.com.cn/upload/pic/20551.png)\n\n\u5982\u4f55\u5355\u8c03\u961f\u5217\uff1f\u4ee5\u4e70\u5165\u4e3a\u4f8b\uff1a\n\n```cpp\nq.clear();\nfor (ri j = 0, ba; j <= mxp; ++j) {\n\twhile (!q.empty() && j - q.front() > as[i]) q.pop_front();\n\twhile (!q.empty() && f[i - w - 1][ba = q.back()] + ba * ap[i] <= f[i - w - 1][j] + j * ap[i]) q.pop_back();\n\tq.push_back(j);\n\tf[i][j] = max(f[i][j], f[i - w - 1][ba = q.front()] - (j - ba) * ap[i]);\n}\n```\n\n\u9996\u5148\u5f39\u51fa\u4e0d\u7b26\u5408\u8981\u6c42\u7684\u961f\u5934\uff0c\u961f\u5217\u4e2d\u5b58\u653e\u7684\u662f\u6570\u7ec4\u4e0b\u6807\uff08\u5373\u5bf9\u5e94\u5929\u6570\uff09\uff1b\n\n\u6240\u4ee5\u5f53$j - q.front() > as[i]$\u65f6\uff0c\u5f88\u660e\u663e\u4e0d\u80fd\u8fd9\u6837\u8f6c\u79fb\uff0c\u5f39\u51fa\u961f\u5934\uff1b\n\n\u7136\u540e\u8003\u8651\u63d2\u5165\u961f\u5c3e\uff08\u8fd9\u91cc\u4e00\u5b9a\u8981\u5148\u63d2\u5165\u518d\u6c42$f[i][j]$\uff0c\u56e0\u4e3a\u6211\u53ef\u80fd\u4e00\u76f4\u4e0d\u4e70\uff09\uff0c\u770b\u770b\u6211\u4eec\u7684\u8f6c\u79fb\u65b9\u7a0b\uff0c\u6211\u4eec\u8981\u7ef4\u62a4$f[i-w-1][k]-ap[i]*(j-k)$\u5373 $f[i-w-1][k]+k*ap[i]$\uff0c\u6240\u4ee5\u628a\u4e0d\u4f18\u7684\u961f\u5c3epop\u5c31\u597d\u4e86\uff1b\n\n\u5bf9\u4e8e\u5356\u51fa\uff0c\u8981\u5012\u5e8f\u5904\u7406\uff1b\n\n$f[i-w-1][k]+bp[i]*(k-j)$\u5373 $f[i-w-1][k]+k*bp[i]$\n\n## \u6613\u9519\u8bef\u533a\n\n\u4e0d\u8981\u6253\u9519front\u548cback\u2026\u2026\u4e0d\u8fc7\u6570\u636e\u771f\u7684\u6c34\uff0c\u5f04\u53cd\u4e86\u8fd8\u670960\u5206\n\n## \u4ee3\u7801\u5c55\u793a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cmath>\n#include<cstring>\n#include<string>\n#include<algorithm>\n#include<vector>\n#include<map>\n#include<set>\n#include<list>\n#include<queue>\n#include<stack>\n#include<bitset>\n#include<deque>\nusing namespace std;\n#define ll long long\n#define ull unsigned long long\n#define inf 0x3f3f3f3f\n#define ri register int\n#define il inline\n#define fi first\n#define se second\n#define mp make_pair\n#define pi pair<int,int>\n#define mem0(x) memset((x),0,sizeof (x))\n#define mem1(x) memset((x),0x3f,sizeof (x))\n#define int ll\nil char gc() {\n\tstatic const int BS = 1 << 22;\n\tstatic unsigned char buf[BS], *st, *ed;\n\tif (st == ed) ed = buf + fread(st = buf, 1, BS, stdin);\n\treturn st == ed ? EOF : *st++;\n}\n#define gc getchar\ntemplate<class T>void in(T &x)\n{\n\tx = 0; bool f = 0; char c = gc();\n\twhile (c < '0' || c > '9') {if (c == '-') f = 1; c = gc();}\n\twhile (isdigit(c)) {x = (x << 3) + (x << 1) + (c ^ 48); c = gc();}\n\tif (f) x = -x;\n}\n#undef gc\nvoid out(int x) {\n\tif (x < 0) putchar('-'), x = -x;\n\tif (x > 9) out(x / 10);\n\tputchar(x % 10 + '0');\n}\n#define N 2010\n#define int ll\n#define f dp\nint t, mxp, w;\nint ap[N], bp[N], as[N], bs[N];\nint dp[N][N];\ndeque<int>q;\nsigned main() {\n\tin(t), in(mxp), in(w);\n\tfor (ri i = 1; i <= t; ++i) {\n\t\tin(ap[i]), in(bp[i]), in(as[i]), in(bs[i]);\n\t}\n\tmemset(dp, 0xcf, sizeof dp);\n\tfor (ri i = 1; i <= t; ++i) {\n\t\tdp[i][0] = 0;\n\t\tfor (ri j = 0; j <= as[i]; ++j) dp[i][j] = -ap[i] * j;\n\t\tfor (ri j = mxp; j >= 0; --j) dp[i][j] = max(dp[i][j], dp[i - 1][j]);\n\t\tif (i - w - 1 >= 0) {\n\t\t\tq.clear();\n\t\t\tfor (ri j = 0, ba; j <= mxp; ++j) {\n\t\t\t\twhile (!q.empty() && j - q.front() > as[i]) q.pop_front();\n\t\t\t\twhile (!q.empty() && f[i - w - 1][ba = q.back()] + ba * ap[i] <= f[i - w - 1][j] + j * ap[i]) q.pop_back();\n\t\t\t\tq.push_back(j);\n\t\t\t\tf[i][j] = max(f[i][j], f[i - w - 1][ba = q.front()] - (j - ba) * ap[i]);\n\t\t\t}\n\t\t\tq.clear();\n\t\t\tfor (ri j = mxp, ba; j >= 0; --j) {\n\t\t\t\twhile (!q.empty() && q.front() - j > bs[i]) q.pop_front();\n\t\t\t\twhile (!q.empty() && f[i - w - 1][ba = q.back()] + ba * bp[i] <= f[i - w - 1][j] + j * bp[i]) q.pop_back();\n\t\t\t\tq.push_back(j);\n\t\t\t\tf[i][j] = max(f[i][j], f[i - w - 1][ba = q.front()] + (ba - j) * bp[i]);\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%lld\", f[t][0]);\n\treturn 0;\n}\n\n```",
        "postTime": 1528030303,
        "uid": 58302,
        "name": "i207M",
        "ccfLevel": 0,
        "title": "\u89e3\u9898\u62a5\u544a-\u5355\u8c03\u961f\u5217\u4f18\u5316DP-\u80a1\u7968\u4ea4\u6613-P2569"
    },
    {
        "content": "## \u9898\u9762\u63cf\u8ff0\n[\u4f20\u9001\u95e8](https://www.luogu.org/problemnew/show/P2569)\n## \u601d\u8def\n\u8fd9\u9053\u9898DP\u7684\u5f88\u660e\u663e\u554a(~~\u53ef\u60dc\u6211\u5c31\u662f\u4e0d\u4f1a\u5199\u554a~~)\n## \u63d0\u524d\u58f0\u660e:\n\u8fd9\u91cc\u7684$n$\u4e3a$T$\uff0c$m$\u4e3a$MaxP$\uff0c$t$\u4e3a$W$\uff0c$a$\u4e3a$AP_i$\uff0c$c$\u4e3a$BP_i$\uff0cb\u4e3a$AS_i$\uff0c$d$\u4e3a$BS_i$\n\n\u9996\u5148\u6839\u636e\u9898\u610f\uff0c\u56e0\u4e3a$i$\u5929\u4e70\u4e86\u80a1\u7968\uff0c$i+t$\u5929\u4e5f\u4e0d\u80fd\u4e70\u80a1\u7968\uff0c\u5e72\u8106$t++$\uff0c\n\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b:\n$$F_{i,j}=\\begin{Bmatrix} F_{i-1,j}\\\\  -a*j(j\\le b)\\\\ F_{i-t, k}-a*j+a*k(0\\le k\\le j-1\\And j-k\\le d)\\\\ F_{i-t,k}+c*k-c*j(j+1\\le k\\le m\\And k-j\\le d)\\end{Bmatrix}$$\n\n\u7b2c\u4e00\u6761\u65b9\u7a0b\u5c31\u662f\u8fd9\u5929\u5565\u90fd\u4e0d\u5e72(\u771f\u662f\u4e2a\u6709\u8da3\u7684\u5bb6\u4f19)\u3002\n\n\u7b2c\u4e8c\u6761\u65b9\u7a0b\u5c31\u662f\u5728\u524d$b$\u5929\u4e70\u8fdb$j$\u5f20\u80a1\u7968\u3002\n\n\u7b2c\u4e09\u6761\u65b9\u7a0b\u5c31\u662f\u5728\u524d$i-t$\u5929\u5df2\u7ecf\u4e70\u4e86k\u5f20\u80a1\u7968\uff0c\u5728$i$\u5929\u518d\u4e70$i-k$\u5f20\u80a1\u7968\u3002\n\n\u7b2c\u4e09\u6761\u65b9\u7a0b\u5c31\u662f\u5728\u524d$i-t$\u5929\u4e70\u4e86k\u5f20\u80a1\u7968\uff0c\u5728$i$\u5929\u5356\u5269$j$\u5f20\u80a1\u7968\u3002\n\n\u8fd9\u79cd$DP$\u5df2\u7ecf\u53ef\u4ee5\u62ff\u4e0b$70$\u5206\u4e86,\n\n\u7136\u540e\u5462\uff1f(\u5c31T\u7684\u6ca1\u8fb9\u4e86)\n\n![\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0](https://cdn.luogu.com.cn/upload/pic/61583.png)\n\n\u89c2\u5bdf\u8bb8\u4e45\uff0c\u6211\u53d1\u73b0\u8c8c\u4f3c\u7b2c$3$\u3001$4$\u4e2a\u65b9\u7a0b\u53ef\u4ee5\u5355\u8c03\u961f\u5217\u4f18\u5316\u3002\n(\u56e0\u4e3a\u5b83\u4eec\u5177\u6709\u5355\u8c03\u6027)\n\n\u8e22\u961f\u5934\u5f88\u597d\u5199\uff0c\u8e22\u961f\u5c3e\u53ef\u4ee5\u89c2\u5bdf\u53d1\u73b0\u6709\u5171\u6027:\n\n$F_{i-t,k}+c(a)*k$\n\n\u56e0\u6b64\u6211\u4eec\u5c31\u53ef\u4ee5\u4ee5\u8fd9\u4e2a\u4e3a\u6807\u51c6\uff0c\u8e22\u6389\u4e0d\u4f18\u7684\u961f\u5c3e\u3002\n```cpp\nwhile(l<=r&&f[i-t][j]+a*j>=f[i-t][q[r]]+a*q[r])--r;\nwhile(l<=r&&f[i-t][j]+c*j>=f[i-t][q[r]]+c*q[r])--r;\n```\n\n\u8c8c\u4f3c\u8fd9\u9053\u9898\u5c31\u7ed3\u675f\u4e86\uff1f\n\n## AC code\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#define gc getchar()\nusing namespace std;\nconst int N=2010;\ninline void qr(int &x)\n{\n\tx=0;int f=1;char c=gc;\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=gc;}\n\twhile(c>='0'&&c<='9'){x=x*10+(c^48);c=gc;}\n\tx*=f;\n}\nvoid qw(int x)\n{\n\tif(x<0)x=-x,putchar('-');\n\tif(x/10)qw(x/10);\n\tputchar(x%10+48);\n}\nint f[N][N];\nint q[N];\nint main()\n{\n\tint n,m,t;qr(n),qr(m),qr(t);t++;\n\tf[0][0]=-N*N;for(int j=1;j<=m+1;j++)f[0][j]=f[0][j-1];\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint a,b,c,d,l,r;\n\t\tqr(a),qr(c),qr(b),qr(d);\n\t\tfor(int j=0;j<=m+1;j++)f[i][j]=f[i-1][j];\n\t\tfor(int j=0;j<=b;j++)f[i][j]=max(f[i][j],-a*j);\n\t\tif(i>t)\n\t\t{\n\t\t\tl=1;r=0;q[1]=0;\n\t\t\tfor(int j=0;j<=m;j++)\n\t\t\t{\n\t\t\t\twhile(l<=r&&q[l]<j-b)++l;\n\t\t\t\tf[i][j]=max(f[i][j],f[i-t][q[l]]-a*j+a*q[l]);\n\t\t\t\twhile(l<=r&&f[i-t][j]+a*j>=f[i-t][q[r]]+a*q[r])--r;\n\t\t\t\tq[++r]=j;\n\t\t\t}\n\t\t\tl=1;r=0;q[1]=m+1;\n\t\t\tfor(int j=m;j>=0;j--)\n\t\t\t{\n\t\t\t\twhile(l<=r&&q[l]-j>d)++l;\n\t\t\t\tf[i][j]=max(f[i][j],f[i-t][q[l]]+c*q[l]-c*j);\n\t\t\t\twhile(l<=r&&f[i-t][j]+c*j>=f[i-t][q[r]]+c*q[r])--r;\n\t\t\t\tq[++r]=j;\n\t\t\t}\n\t\t}\n\t}\n\tqw(f[n][0]);puts(\"\");\n\treturn 0;\n}\n```\n\n",
        "postTime": 1561704222,
        "uid": 106232,
        "name": "_Sein",
        "ccfLevel": 0,
        "title": "[SCOI2010]\u80a1\u7968\u4ea4\u6613"
    },
    {
        "content": "# \u9898\u76ee\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[\u70b9\u8fd9\u91cc](https://www.luogu.org/problem/P2569)\u3002\n# \u5206\u6790\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u5e94\u8be5\u53ef\u4ee5\u5f88\u5feb\u5c31\u770b\u51fa\u662f\u9053$DP$\u9898\u5427\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u72b6\u6001\u6ca1\u4ec0\u4e48\u96be\u5ea6:  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$DP(i,j)$\uff1a\u7b2c$i$\u5929\u624b\u4e0a\u6301\u6709$j$\u80a1\u65f6\u7684\u6700\u5927\u6536\u76ca\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u90a3\u4e48\u5c31\u5148\u628a\u8f6c\u79fb\u5217\u51fa\u6765\uff1a   \n### 1.\u5f53\u524d\u5929\u5565\u4e5f\u4e0d\u5e72  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$DP(i,j)=\\max(DP(i,j),DP(i-1,j))$  \n### 2.\u5f53\u524d\u5929\u5356\u80a1\u7968  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$\\displaystyle DP(i,j)=\\max(DP(i,j),\\max_{0\\le k\\le \\max(i-W-1,0)}\\{\\max_{1\\le t\\le \\min(MaxP-j,BS_i)}\\{DP(k,j+t)+BP_it\\}\\})$\n### 3.\u5f53\u524d\u5929\u4e70\u80a1\u7968\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$\\displaystyle DP(i,j)=\\max(DP(i,j),\\max_{0\\le k\\le \\max(i-W-1,0)}\\{\\max_{1\\le t\\le \\min(j,AS_i)}\\{DP(k,j-t)-AP_it\\}\\})$  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u53ef\u4ee5\u53d1\u73b0\u7684\u662f\uff0c\u4e00\u4e9b\u9898\u89e3\u4e2d\u201c\u51ed\u7a7a\u4e70\u80a1\u7968\u201d\u4e4b\u7c7b\u7684\u90e8\u5206\u4e5f\u88ab\u7b97\u4e86\u8fdb\u6765\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u7b54\u6848\u5373\u4e3a$\\max_{0\\le i\\le MaxP}\\{DP(T,i)\\}$  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u8fd9\u6837\u66b4\u529b\u8f6c\u79fb\u65f6\u95f4$O(j\\times MaxP^3)$......  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u8003\u8651\u4f18\u5316\uff1a \n\n---------  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u7b2c\u4e00\u6b65\uff0c\u56e0\u4e3a\u6709\u4e86\u201c\u5f53\u524d\u5929\u5565\u4e5f\u4e0d\u5e72\u201d\u8fd9\u79cd\u64cd\u4f5c\uff0c\u6240\u4ee5\u6211\u4eec\u663e\u7136\u4e0d\u7528\u679a\u4e3e\u4e0a\u6b21\u4e70\u80a1\u7968\u7684\u65f6\u95f4$k$\uff0c\u8f6c\u800c\u76f4\u63a5\u7528$\\max(i-W-1,0)$\u66ff\u4ee3\u5373\u53ef\u3002\u73b0\u5728\u7684\u65f6\u95f4\u662f$O(j\\times MaxP^2)$  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~~\u770b\u5427\uff0c$DP$\u4f18\u5316\u5176\u5b9e\u4e5f\u4e0d\u600e\u4e48\u96be\u3002~~  \n\n---------  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u7b2c\u4e8c\u6b65\uff0c\u8bbe$k=\\max(i-W-1,0)$\uff0c\u89c2\u5bdf\u6211\u4eec\u73b0\u5728\u7684\u8f6c\u79fb\u5f0f\u5b50\uff0c\u7740\u91cd\u770b\u540e\u9762\u6bd4\u8f83\u81c3\u80bf\u7684\u90a3\u4e00\u90e8\u5206\uff1a  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$\\displaystyle DP(i,j)=\\max(DP(i-1,j),\\max_{1\\le t\\le \\min(MaxP-j,BS_i)}\\{DP(k,j+t)+BP_it\\},\\max_{1\\le t\\le \\min(j,AS_i)}\\{DP(k,j-t)-AP_it\\})$  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u611f\u89c9\u5230\u4e86\u4e48\uff0c\u8fd9\u5176\u5b9e\u5c31\u662f\u5728\u4e00\u4e2a\u533a\u95f4\u4e2d\uff08\u63a5\u8fd1\u4e8e\u5b9a\u957f\u533a\u95f4\uff0c\u5c31\u662f\u8fb9\u754c\u7684\u60c5\u51b5\u4e0b\u957f\u5ea6\u4f1a\u6709\u6240\u6539\u53d8\uff09\u5bfb\u627e\u4e00\u4e2a\u6700\u5927\u503c\uff0c\u7136\u540e\u8f6c\u79fb\u3002\u968f\u7740$t$\u7684\u79fb\u52a8\uff0c\u8fd9\u4e2a\u533a\u95f4\u4e5f\u4f1a\u8ddf\u7740\u79fb\u52a8\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u800c\u8fd9\u6837\u7684\u95ee\u9898\u6b63\u597d\u5c31\u662f\u5355\u8c03\u961f\u5217\u6240\u64c5\u957f\u7684\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u6240\u4ee5\u7528\u4e24\u4e2a\u961f\u5217\uff0c\u5206\u522b\u7ef4\u62a4\u540e\u9762\u4e24\u4e2a\u4e1c\u897f\uff0c\u4e2d\u95f4\u7684\u8f6c\u79fb\u5747\u644a$O(1)$\uff0c\u603b\u65f6\u95f4\u76f4\u63a5\u88ab\u780d\u6210\u4e86$O(j\\times MaxP)$\u3002  \n# \u4ee3\u7801\n```cpp\n#include <cstdio>\n#include <cstring>\n\ntypedef long long LL;\n\nconst int MAXT = 2005, MAXP = 2005;\n\ntemplate<typename _T>\nvoid read( _T &x )\n{\n\tx = 0;char s = getchar();int f = 1;\n\twhile( s > '9' || s < '0' ){if( s == '-' ) f = -1; s = getchar();}\n\twhile( s >= '0' && s <= '9' ){x = ( x << 3 ) + ( x << 1 ) + ( s - '0' ), s = getchar();}\n\tx *= f;\n}\n\ntemplate<typename _T>\nvoid write( _T x )\n{\n\tif( x < 0 ){ putchar( '-' ); x = ( ~ x ) + 1; }\n\tif( 9 < x ){ write( x / 10 ); }\n\tputchar( x % 10 + '0' );\n}\n\ntemplate<typename _T>\n_T MIN( const _T a, const _T b )\n{\n\treturn a < b ? a : b;\n}\n\ntemplate<typename _T>\n_T MAX( const _T a, const _T b )\n{\n\treturn a > b ? a : b;\n}\n\nstruct deque\n{\n\tint q[MAXP];\n\tint h, t;\n\tint& operator [] ( const int indx ) { return q[indx]; }\n\tdeque(){ h = 1, t = 0; }\n\tvoid clear() { h = 1, t = 0; }\n\tint front() const { return q[h]; }\n\tint back() const { return q[t]; }\n\tvoid push_front( const int val ) { q[--h] = val; }\n\tvoid push_back( const int val ) { q[++t] = val; }\n\tvoid pop_front() { h ++; }\n\tvoid pop_back() { t --; }\n\tbool empty() const { return h > t; }\n\tint size() const { return t - h + 1; }\n}deq1, deq2;\n\nLL DP[MAXT][MAXP];\nint AP[MAXT], BP[MAXT], AS[MAXT], BS[MAXT];\nint W, T, MP;\n\nint main()\n{\n\tread( T ), read( MP ), read( W );\n\tfor( int i = 1 ; i <= T ; i ++ ) read( AP[i] ), read( BP[i] ), read( AS[i] ), read( BS[i] );\n\tmemset( DP, 0xc0, sizeof( DP ) );\n\tDP[0][0] = 0;\n\tint k, t1;\n\tfor( int i = 1 ; i <= T ; i ++ )\n\t{\n\t\tdeq1.clear(), deq2.clear();\n\t\tk = MAX( 0, i - W - 1 );\n\t\tfor( t1 = 1 ; t1 < BS[i] && t1 <= MP ; t1 ++ )\n\t\t{\n\t\t\twhile( ! deq1.empty() && DP[k][deq1.back()] + BP[i] * deq1.back() <= DP[k][t1] + BP[i] * t1 ) deq1.pop_back();\n\t\t\tdeq1.push_back( t1 );\n\t\t}\n\t\tfor( int j = 0 ; j <= MP ; j ++ )\n\t\t{\n\t\t\tDP[i][j] = DP[i - 1][j];\n\t\t\twhile( ! deq1.empty() && deq1.front() <= j ) deq1.pop_front();\n\t\t\tif( t1 <= MP ) \n\t\t\t{\n\t\t\t\twhile( ! deq1.empty() && DP[k][deq1.back()] + BP[i] * ( deq1.back() - j ) <= DP[k][t1] + BP[i] * ( t1 - j ) ) deq1.pop_back();\n\t\t\t\tdeq1.push_back( t1 ++ );\n\t\t\t}\n\t\t\tif( ! deq1.empty() ) DP[i][j] = MAX( DP[i][j], DP[k][deq1.front()] + BP[i] * ( deq1.front() - j ) );\n\t\t\tif( ! j ) continue;\n\t\t\twhile( ! deq2.empty() && deq2.front() < j - AS[i] ) deq2.pop_front();\n\t\t\twhile( ! deq2.empty() && DP[k][deq2.back()] - AP[i] * ( j - deq2.back() ) <= DP[k][j - 1] - AP[i] ) deq2.pop_back();\n\t\t\tdeq2.push_back( j - 1 );\n\t\t\tif( ! deq2.empty() ) DP[i][j] = MAX( DP[i][j], DP[k][deq2.front()] - AP[i] * ( j - deq2.front() ) );\n\t\t}\n\t}\n\tLL res = -0x3f3f3f3f3f3f3f3f;\n\tfor( int i = 0 ; i <= MP ; i ++ ) res = MAX( res, DP[T][i] );\n\twrite( res ), putchar( '\\n' );\n\treturn 0;\n}\n```",
        "postTime": 1570022027,
        "uid": 123809,
        "name": "crashed",
        "ccfLevel": 0,
        "title": "[SCOI2010]\u80a1\u7968\u4ea4\u6613"
    },
    {
        "content": "dp + \u5355\u8c03\u961f\u5217\u4f18\u5316\n\n\u4ee4 $d(i,j)$ \u8868\u793a**\u5728 $i$ \u5929\uff0c\u624b\u6301 $j$ \u80a1\u80a1\u7968\u7684\u6700\u5927\u5229\u6da6**\n\n\u90a3\u4e48\u663e\u7136\u6709\u4e09\u79cd\u8f6c\u79fb\u65b9\u5f0f\n\n\u4ec0\u4e48\u4e5f\u4e0d\u505a\uff1a\n\n$$ d(i,j)=d(i-1,j) $$\n\n\u4e70\u5165\u80a1\u7968\uff1a\n\n$$ d(i,j)=max \\{ d(i-w-1,j-k) - k * ap_{i} \\} (k \\le as_{i}) $$\n\n\u5356\u51fa\u80a1\u7968\n\n$$ d(i,j)=max \\{ d(i-w-1,j+k) + k * bp_{i} \\} (k \\le bs_{i}) $$\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u6bcf\u6b21\u8f6c\u79fb\u90fd\u662f\u53d6\u4e00\u4e2a\u533a\u95f4\u7684\u6700\u5927\u503c\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u5355\u8c03\u961f\u5217\u4f18\u5316\n\n\u628a\u5f0f\u5b50\u5316\u4e3a\n\n$$ d(i,j)=max \\{ d(i-w-1,k') + k' * ap_{i} \\} - j * ap_{i} (j - k' \\le as_{i}) $$\n\n$$ d(i,j)=max \\{ d(i-w-1,k') + k' * bp_{i} \\} - j * bp_{i} (k' - j \\le bs_{i}) $$\n\n\u6211\u4eec\u5c31\u53ef\u4ee5\u6109\u5feb\u7684\u4f7f\u7528\u5355\u8c03\u961f\u5217\u4e86\n\n\u5b8c\u6574\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\nconst int INF=2000000000;\nint t,maxp,w,ap[2010],bp[2010],as[2010],bs[2010],d[2010][2010],q[2010],p[2010],head,tail;\n\ninline int read(){\n    int num=0,k=1; char c=getchar();\n    while(c>'9' || c<'0') k=(c=='-')?0:k,c=getchar();\n    while(c>='0' && c<='9') num=num*10+c-'0',c=getchar();\n    return k?num:-num;\n}\n\nint main(){\n    t=read(); maxp=read(); w=read();\n    for(int i=1;i<=maxp;i++) d[0][i]=-INF;\n    for(int i=1;i<=t;i++) ap[i]=read(),bp[i]=read(),as[i]=read(),bs[i]=read();\n    for(int cur=1,las;cur<=t;cur++){\n        las=max(0,cur-w-1);\n        for(int i=0;i<=maxp;i++) d[cur][i]=d[cur-1][i];\n        head=1; tail=0;\n        for(int i=0;i<=maxp;i++){\n            while(head<=tail && q[tail]<=d[las][i]+i*ap[cur]) tail--;\n            q[++tail]=d[las][i]+i*ap[cur]; p[tail]=i;\n            while(head<=tail && i-p[head]>as[cur]) head++;\n            d[cur][i]=max(d[cur][i],q[head]-i*ap[cur]);\n        }\n        head=1; tail=0;\n        for(int i=maxp;i>=0;i--){\n            while(head<=tail && q[tail]<=d[las][i]+i*bp[cur]) tail--;\n            q[++tail]=d[las][i]+i*bp[cur]; p[tail]=i;\n            while(head<=tail && p[head]-i>bs[cur]) head++;\n            d[cur][i]=max(d[cur][i],q[head]-i*bp[cur]);\n        }\n    }\n    printf(\"%d\",d[t][0]);\n    return 0;\n}\n\n```",
        "postTime": 1553169115,
        "uid": 100037,
        "name": "kkxhh",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2569 \u3010[SCOI2010]\u80a1\u7968\u4ea4\u6613\u3011"
    },
    {
        "content": "\u4e5f\u53ef\u4ee5\u5728[\u6211\u7684\u535a\u5ba2](https://www.cnblogs.com/Zenyz/p/10139276.html)\u98df\u7528,\u6548\u679c\u66f4\u4f73\n\n----\n\n\n\n\u7b2c\u4e00\u9053\u5355\u8c03\u961f\u5217\u4f18\u5316DP\uff0c\u5199\u7bc7\u9898\u89e3\u7eaa\u5ff5\u4e00\u4e0b\n\n[P2569 [SCOI2010]\u80a1\u7968\u4ea4\u6613](https://www.luogu.org/problemnew/show/P2569)\n\n\u9898\u9762\u5f88\u7b80\u5355,\u6211\u7528$n,m,buy,sell,blimit,slimit$\u6765\u5206\u522b\u4ee3\u8868$T,MaxP,AP,BP,AS,BS$\n\n\n## 1.\u66b4\u529b\n\n\u200b\t\u5e94\u8be5\u633a\u597d\u6253\u7684,\u8f6c\u79fb\u5982\u4e0b\n\n\u200b\t\t$f[i][j]=max(f[i-1][j],f[i][j])$\n\n\u200b\t\t$f[i][j]=MAX_{k=0}^{j}(f[i-w-1][k]-buy[i]\\times(j-k)),((j-k)<blimit[i])$\n\n\u200b\t\t$f[i][j]=MAX_{k=j}^{j+sli}(f[i-w-1][k]+sell[i]\\times(k-j)),((k-j)<slimit[i])$\n\n\u200b\t$(MAX$\u8868\u793a\u533a\u95f4\u6700\u5927$)$\n\n\u200b\t\u8fd9\u6837\u505a\u662f$O(n^2)$\u7684,TLE\n\n## 2.\u5355\u8c03\u961f\u5217\u4f18\u5316DP\n\n\u200b\t\u8003\u8651\u4f18\u5316,\n\n\u200b\t\u6bcf\u6b21\u8f6c\u79fb\u5982\u4e0b(\u4ee5\u4e70\u5165\u4e3a\u4f8b):\n\n\u200b\t\t$f[i][j]=f[i-w-1][k]-buy[i]\\times(j-k)),((j-k)<blimit[i])$\n\n\u200b\t$RHS=f[i-w-1][k]-buy[i]*j+buy[i]*k,((j-k)<blimit[i]) $\n\n\u200b\t\u90a3\u4e48\u6211\u4eec\u5230\u5e95\u6709\u6ca1\u6709\u5fc5\u8981\u679a\u4e3e$k$ \u5462?\n\n\u200b\t\u5728\u679a\u4e3e$k$ \u7684\u8fc7\u7a0b\u4e2d,$-buy[i]*j$ \u662f\u5b9a\u503c,\u6211\u4eec\u628a\u5b83\u653e\u5230\u4e00\u8fb9\n\n\u200b\t\u4ee4\u6570\u7ec4$a[k]=f[i-w-1][k]+buy[i]*k$ \n\n\u200b\t\u90a3\u4e48$a$ \u662f\u4e00\u4e2a\u4e0e$i,j$ \u65e0\u5173\u7684\u6570\u7ec4,\n\n\u200b\t\u4e14$f[i-w-1][j]$\u7684\u7b54\u6848\u53ea\u4f1a\u4ece$a$ \u6570\u7ec4\u4e2d\u4ea7\u751f\n\n\u200b\t\u5219\u8f6c\u79fb\u7684\u672c\u8d28\u5176\u5b9e\u662f\u4ece\u540c\u5c42\u4e14\u6ee1\u8db3\u9650\u5236\u6761\u4ef6(\u6761\u4ef6\u5373\u4e3ablimit)\u7684\u7b54\u6848\u4e2d\u9009\u53d6\u6700\u5927\u7684\u8fdb\u884c\u8f6c\u79fb\n\n\u200b\t![]( https://cdn.luogu.com.cn/upload/pic/46564.png )\n\n\u200b\t\u5982\u4e0a\u56fe\u6bcf\u6b21\u53ea\u4f1a\u589e\u52a0\u4e00\u4e2a\u5143\u7d20,\u51cf\u53bb\u4e00\u4e2a\u5143\u7d20\n\n\u200b\t\u7136\u540e\u5c31[\u6ed1\u52a8\u7a97\u53e3](https://www.luogu.org/problemnew/show/P1886)\u4e86\n\n## 3.\u4ee3\u7801\n\n\u66b4\u529b(50pts):\n\n```cpp\n#include<bits/stdc++.h>\n#define il inline \n#define R register int\n#define ll long long\n#define gc getchar\nusing namespace std;\nil int rd()\n{\n    R x=0,flag=1;\n    char ch=0;\n    while((ch>'9'||ch<'0')&&ch!='-')ch=gc();\n    if(ch=='-')flag=-1,ch=gc();\n    while(ch>='0'&&ch<='9')x=(x<<3)+(x<<1)+(ch^48),ch=gc();\n    return x*flag;\n}\nconst int N=2010;\nint n,m,w,ans;\nint f[2002][2002];\nint buy[N],sell[N],slimit[N],blimit[N];\nint main ()\n{\n    n=rd(),m=rd(),w=rd();\n    for(R i=1;i<=n;i++)\n        buy[i]=rd(),sell[i]=rd(),blimit[i]=rd(),slimit[i]=rd();\n    memset(f,0xcf,sizeof(f));\n    for(R i=1;i<=n;i++)\n        for(R j=0;j<=blimit[i];j++)\n            f[i][j]=-buy[i]*j;\n    for(R i=1;i<=n;i++)\n    {\n        for(R j=0;j<=m;j++)\n        {\n   \t        f[i][j]=max(f[i][j],f[i-1][j]);\n            for(R k=0;k<=slimit[i];k++)\n            {\n                if(i>w)\n                f[i][j]=max(f[i][j],f[i-w-1][j+k]+sell[i]*k);\n            }\n            for(R k=0;k<=blimit[i];k++)\n            {\n                if(i>w&&j>=k)\n                    f[i][j]=max(f[i][j],f[i-w-1][j-k]-buy[i]*k);\n            }\n        }\n    }\n    for(R i=0;i<=m;i++)\n        ans=max(ans,f[n][i]);\n    cout<<ans<<endl;\n    return 0;\n}\n\n```\n\n\n\n\u6b63\u89e3(100pts,\u8dd1\u5f97\u5de8\u6162):\n\n```cpp\n#include<bits/stdc++.h>\n#define il inline \n#define R register int\n#define ll long long\n#define gc getchar\nusing namespace std;\nil int rd()\n{\n    R x=0,flag=1;\n    char ch=0;\n    while((ch>'9'||ch<'0')&&ch!='-')ch=gc();\n    if(ch=='-')flag=-1,ch=gc();\n    while(ch>='0'&&ch<='9')x=(x<<3)+(x<<1)+(ch^48),ch=gc();\n    return x*flag;\n}\nconst int N=2010;\nint n,m,w,ans;\nint f[2002][2002];\nint buy[N],sell[N],slimit[N],blimit[N];\ndeque<int> dq,dq2;\nint main ()\n{\n    n=rd(),m=rd(),w=rd();\n    for(R i=1;i<=n;i++)\n        buy[i]=rd(),sell[i]=rd(),blimit[i]=rd(),slimit[i]=rd();\n   memset(f,0xcf,sizeof(f));f[0][0]=0;\n    for(R i=1;i<=n;i++)\n    {\n        \n        while (!dq.empty()) dq.pop_back();\n        while (!dq2.empty()) dq2.pop_back();\n        R t=max(0,i-w-1);\n        for(R j=0;j<=m;j++)\n        {\n             f[i][j]=max(f[i][j],f[i-1][j]);\n            while(dq.size()&&f[t][j]>=f[t][dq.back()]-buy[i]*(j-dq.back()))\n                dq.pop_back();\n            dq.push_back(j);\n            while(dq.size()&&j-dq.front()>blimit[i])dq.pop_front();\n            f[i][j]=max(f[i][j],f[t][dq.front()]-buy[i]*(j-dq.front()));\n        \n        }\n        for(R j=m;j+1;j--)\n        {\n            while(dq2.size()&&f[t][j]>=f[t][dq2.back()]+sell[i]*(dq2.back()-j))\n                dq2.pop_back();\n            dq2.push_back(j);\n            while(dq2.size()&&dq2.front()-j>slimit[i])dq2.pop_front();\n            f[i][j]=max(f[i][j],f[t][dq2.front()]+sell[i]*(dq2.front()-j));\n        }\n    }\n    for(R i=0;i<=m;i++)\n        ans=max(ans,f[n][i]);\n    cout<<ans<<endl;\n    return 0;\n}\n\n```\n\n\u200b\t",
        "postTime": 1545133806,
        "uid": 44182,
        "name": "zyzzyzzyzzyz",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2569 \u3010[SCOI2010]\u80a1\u7968\u4ea4\u6613\u3011"
    },
    {
        "content": "### \u65b9\u6cd5\u697c\u4e0a\u90fd\u8bb2\u4e86\uff0cDP+\u5355\u8c03\u961f\u5217\u4f18\u5316\uff0c\u4e3b\u8981\u8bb2\u4e00\u4e0b\u4e3a\u4ec0\u4e48\u5356\u80a1\u7968\u7684\u65f6\u5019j\u7684\u679a\u4e3e\u987a\u5e8f\u662f\u5012\u5e8f\u3002\n**\u9996\u5148\u4e70\u5165\u80a1\u7968\u7684\u8f6c\u79fb\u65b9\u7a0bj\u662f\u987a\u5e8f\u679a\u4e3e\u7684\uff0c\u56e0\u4e3a\u662f\u4e70\u5165\u80a1\u7968\uff0c\u624b\u4e2d\u7684\u80a1\u7968\u5e94\u8be5\u662f\u8d8a\u6765\u8d8a\u591a\u7684\uff0c\u5f53\u524d\u7684\u51b3\u7b56\u6709\u53ef\u80fd\u5728\u540e\u9762\uff08\uff4a\u66f4\u5927\uff09\u7684\u65f6\u5019\u7528\u5230\uff0c\u6240\u4ee5\u4f60\u9700\u8981\u5148\u6c42\u51fa\u6765\uff0c\u540c\u7406\uff0c\u5356\u51fa\u80a1\u7968\u65f6\uff0c\u4f60\u624b\u4e2d\u7684\u80a1\u7968\u662f\u8d8a\u6765\u8d8a\u5c11\u7684\uff0c\u5373\u5f53\u524d\u7684\u51b3\u7b56\u6709\u53ef\u80fd\u9700\u8981\u7528\u5230\u6bd4\u4f60\u624b\u4e2d\u80a1\u7968\u6570\u66f4\u5c11\u7684\u72b6\u6001\uff0c\u6240\u4ee5\u9700\u8981\u63d0\u524d\u5904\u7406\uff0c\u56e0\u6b64\u9700\u8981\u5012\u5e8f\u679a\u4e3e**\n\n#### Code:\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define RN register int \nconst int N = 2050;\ninline int read()\n{\n\tint x=0,f=1;\n\tchar c=getchar();\n\twhile((c<'0'||c>'9')&&c!='-')c=getchar();\n\tif(c=='-')f=-1,c=getchar();\n\twhile(c>='0'&&c<='9')x=(x<<3)+(x<<1)+c-'0',c=getchar();\n\treturn f*x;\n}\nint t,maxp,w;\nstruct P {\n\tint ap;\n\tint bp;\n\tint as;\n\tint bs;\n}a[N];\nint ans;\nint f[N][N],q[N];\ninline int calc1(int i,int k)\n{\n\treturn f[i-w-1][k]+a[i].ap*k;\n}\ninline int calc2(int i,int k)\n{\n\treturn f[i-w-1][k]+a[i].bp*k;\n}\nint main()\n{\n\tt=read(),maxp=read(),w=read();\n\tfor(RN i=1;i<=t;i++)\n\t\ta[i].ap=read(),a[i].bp=read(),a[i].as=read(),a[i].bs=read();\n\tmemset(f,128,sizeof(f));\n\tfor(RN i=1;i<=t;i++)\n\t{\n\t\tfor(RN k=0;k<=a[i].as;k++)\n\t\t\tf[i][k]=-a[i].ap*k;\n\t\tfor(RN j=0;j<=maxp;j++)\n\t\t\tf[i][j]=max(f[i][j],f[i-1][j]);\n\t\tint l=1,r=0;\n\t\tif(i>=w+1)\n\t\t{\n\t\t\tfor(RN j=0;j<=maxp;j++)\n\t\t\t{\n\t\t\t\twhile(l<=r&&q[l]<j-a[i].as)\n\t\t\t\t\tl++;\n\t\t\t\twhile(l<=r&&calc1(i,q[r])<=calc1(i,j))\n\t\t\t\t\tr--;\n\t\t\t\tq[++r]=j;\n\t\t\t\tf[i][j]=std::max(f[i][j],calc1(i,q[l])-a[i].ap*j);\n\t\t\t}\n\t\t\tl=1,r=0;\n\t\t\tfor(RN j=0;j<=maxp;j++)\n\t\t\t{\n\t\t\t\twhile(l<=r&&q[l]>j+a[i].bs)\n\t\t\t\t\tl++;\n\t\t\t\twhile(l<=r&&calc2(i,q[r])<=calc2(i,j))\n\t\t\t\t\tr--;\n\t\t\t\tq[++r]=j;\n\t\t\t\tf[i][j]=std::max(f[i][j],calc2(i,q[l])-a[i].bp*j);\n\t\t\t}\n\t\t\t//cout<<\"f[\"<<i<<\"]\"<<\"[\"<<j<<\"]=\"<<f[i][j]<<endl;\n\t\t}\n\t}\n\tfor(RN i=0;i<=maxp;i++)\n\t\tans=std::max(ans,f[t][i]);\n\tcout<<ans<<endl;\n\treturn 0;\n}\n \n\n```",
        "postTime": 1572522662,
        "uid": 111487,
        "name": "\u9f99\u7fd4\u51e4\u7fe5",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2569 \u3010[SCOI2010]\u80a1\u7968\u4ea4\u6613\u3011"
    },
    {
        "content": "## \u4e00\u3001\u9898\u76ee\n\n[\u70b9\u6b64\u770b\u9898](https://www.luogu.org/problem/P2569)\n\n## \u4e8c\u3001\u89e3\u6cd5\n\n\u8fd9\u9053\u9898\u64cd\u4f5c\u6709\u70b9\u591a\uff0c\u6211\u4eec\u6765\u4e00\u6b65\u4e00\u6b65\u68b3\u7406\u3002\n\n\u8bbe$dp[i][j]$\u4e3a\u5230\u7b2c$i$\u5929\u64cd\u4f5c\u5b8c\u8fd8\u5269$j$\u4efd\u80a1\u7684\u6700\u5927\u6536\u76ca\uff0c\u5219\uff1a\n\n1\u3001\u7ee7\u627f\u4e0a\u4e00\u5c42\u7684\u72b6\u6001\uff0c$dp[i][j]=dp[i-1][j]$\u3002\n\n2\u3001\u4ece\u5f53\u524d\u5929\u5f00\u59cb\u4e70\uff0c$dp[i][j]=-j*ap[i]$\u3002\n\n3\u3001\u5728\u4ee5\u524d\u7684\u57fa\u7840\u4e0a\u4e70\u5165\uff0c\u7531\u4e8e\u6211\u4eec\u7684$dp$\u5df2\u7ecf\u7ee7\u627f\u4e86\u6700\u4f18\u7684\u72b6\u6001\uff0c\u76f4\u63a5\u7528$i-w-1$\u7684\u72b6\u6001\u5c31\u884c\u4e86\uff0c$dp[i][j]=dp[i-w-1][k]-(j-k)\\times ap[i]$\n\n4\u3001\u5728\u4ee5\u524d\u7684\u57fa\u7840\u4e0a\u5356\u51fa\uff0c\u540c\u7406$dp[i][j]=dp[i-w-1][k]+(j-k)\\times bp[i]$\n\n\u8fd9\u6837\u5199$dp$\u65f6\u95f4\u590d\u6742\u5ea6$O(n^3)$\uff0c\u5f97\u5206$60$\u3002\n\n\u8003\u8651\u4f18\u5316\uff0c\u53d1\u73b0\u65f6\u95f4\u4e3b\u8981\u4e3b\u8981\u6d88\u8017\u5728$3,4$\u4e2a\u64cd\u4f5c\u4e0a\u3002\n\n\u53d1\u73b0$3,4$\u4e2a\u64cd\u4f5c\u51b3\u7b56\u533a\u95f4\u662f\u5b9a\u957f\u7684\uff0c\u53ef\u4ee5\u7528\u5355\u8c03\u961f\u5217\u4f18\u5316\uff08\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u6ed1\u52a8\u7a97\n\u53e3\uff09\uff0c\u7136\u540e\u5c31\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$O(n^2) **\uff08jzm orz or2 orz\uff09**\u3002\n\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <iostream>\nusing namespace std;\nconst int MAXN = 2005;\nint read()\n{\n    int x=0,flag=1;\n    char c;\n    while((c=getchar())<'0' || c>'9') if(c=='-') flag=-1;\n    while(c>='0' && c<='9') x=(x<<3)+(x<<1)+(c^48),c=getchar();\n    return x*flag;\n}\nint n,m,w,ans,q[MAXN],dp[MAXN][MAXN];\nint main()\n{\n\tmemset(dp,-0x3f,sizeof dp);\n\tn=read();m=read();w=read();\n\t//dp[0][0]=0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint ap=read(),bp=read(),as=read(),bs=read();\n\t\tfor(int j=0;j<=m;j++)\n\t\t\tdp[i][j]=dp[i-1][j];\n\t\tfor(int j=0;j<=as;j++)\n\t\t\tdp[i][j]=max(dp[i][j],-j*ap);\n\t\tif(i<=w) continue;\n\t\tint l=1,r=0;\n\t\tfor(int j=0;j<=m;j++)\n\t\t{\n\t\t\twhile(l<=r && q[l]<j-as) l++;\n\t\t\twhile(l<=r && dp[i-w-1][q[r]]+q[r]*ap<=dp[i-w-1][j]+j*ap) r--;\n\t\t\tq[++r]=j;\n\t\t\tif(l<=r)\n\t\t\tdp[i][j]=max(dp[i][j],dp[i-w-1][q[l]]-(j-q[l])*ap);\n\t\t}\n\t\tl=1;r=0;\n\t\tfor(int j=m;j>=0;j--)\n\t\t{\n\t\t\twhile(l<=r && q[l]>j+bs) l++;\n\t\t\twhile(l<=r && dp[i-w-1][q[r]]+q[r]*bp<=dp[i-w-1][j]+j*bp) r--;\n\t\t\tq[++r]=j;\n\t\t\tif(l<=r) \n\t\t\tdp[i][j]=max(dp[i][j],dp[i-w-1][q[l]]+(q[l]-j)*bp);\n\t\t}\n\t}\n\tfor(int i=0;i<=m;i++)\n\t\tans=max(ans,dp[n][i]); \n\tprintf(\"%d\\n\",ans);\n}\n```\n",
        "postTime": 1570256843,
        "uid": 128239,
        "name": "C20203030",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2569 \u3010[SCOI2010]\u80a1\u7968\u4ea4\u6613\u3011"
    },
    {
        "content": "\u9898\u610f:https://www.luogu.org/problem/P2569\n\n\u5bb9\u6613\u5217\u51fa\u65b9\u7a0b:f[i][j]->\u7b2ci\u5929,\u624b\u4e2d\u6709j\u80a1\u7684\u624b\u4e2d\u94b1\u7684\u6700\u5927\u503c\n\nf[i][j]=\n\n1.\u4e0d\u884c\u52a8 f[i-1][j]\n\n2.\u4e70\u5165:f[i-W-1][k]-(j-k)*ap[i] (0=<k<=j-as[i])\n\n3.\u5356\u51fa:f[i-W-1][k]+(k-j)*bp[i] (0=<k<=j+bs[i])\n\n\u5bf9\u4e8e2:\n\nf[i-W-1][k]-(j-k)*ap[i] \n\n=max(f[i-W-1][k]+k*ap[i])-j*ap[i]\n\n\u7ef4\u62a4\u4e00\u4e2a\u5355\u8c03\u961f\u5217,\u5176\u4e2df[i-W-1][q[x]]+k*ap[q[x]] \u5355\u8c03\u9012\u51cf\n\n\u5bf9\u4e8e3:\n\nf[i-W-1][k]+(k-j)*bp[i]\n\n=max(f[i-W-1][k]+k*bp[i])-j*bp[i]\n\n\u540c\u7406,\u7ef4\u62a4\u4e00\u4e2a\u5355\u8c03\u961f\u5217,\u5176\u4e2df[i-W-1][q[x]]+k*bp[q[x]] \u5355\u8c03\u9012\u51cf\n\ncode:\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=2010;\nconst int maxp=2010;\nint n,maxP,W,ans;\nint ap[maxn],bp[maxn],as[maxn],bs[maxn],q[maxp];\nint f[maxn][maxp];\ninline int read()\n{\n\tchar c=getchar();int res=0,f=1;\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9')res=res*10+c-'0',c=getchar();\n\treturn res*f;\n}\nint main()\n{\n\tmemset(f,128,sizeof(f));\n\tn=read();maxP=read();W=read();\n\tfor(int i=1;i<=n;i++)ap[i]=read(),bp[i]=read(),as[i]=read(),bs[i]=read();\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=0;j<=as[i];j++)f[i][j]=-1*ap[i]*j;//\u521d\u59cb\u503c \n\t\tfor(int j=0;j<=maxP;j++)f[i][j]=max(f[i][j],f[i-1][j]);\n\t\tif(i<=W)continue;//i<=W\u7684\u4e0d\u80fd\u4ecei-W-1\u8f6c\u79fb \n\t\tint l=1,r=0;\n\t\tfor(int j=0;j<=maxP;j++)\n\t\t{\n\t\t\twhile(l<=r&&q[l]+as[i]<j)l++;\n\t\t\tif(l<=r)f[i][j]=max(f[i][j],f[i-W-1][q[l]]+(q[l]-j)*ap[i]);\n\t\t\twhile(l<=r&&f[i-W-1][q[r]]+q[r]*ap[i]<f[i-W-1][j]+j*ap[i])r--;\n\t\t\tq[++r]=j;\n\t\t}\n\t\tl=1,r=0;\n\t\tfor(int j=maxP;j>=0;j--)\n\t\t{\n\t\t\twhile(l<=r&&q[l]-bs[i]>j)l++;\n\t\t\tif(l<=r)f[i][j]=max(f[i][j],f[i-W-1][q[l]]+(q[l]-j)*bp[i]);\n\t\t\twhile(l<=r&&f[i-W-1][q[r]]+q[r]*bp[i]<f[i-W-1][j]+j*bp[i])r--;\n\t\t\tq[++r]=j;\n\t\t}\n\t}\n\tfor(int i=0;i<=maxP;i++)ans=max(ans,f[n][i]);\n\tprintf(\"%d\",ans);\n\treturn 0;\t\n}\n```\n",
        "postTime": 1565926367,
        "uid": 145441,
        "name": "nofind",
        "ccfLevel": 6,
        "title": "P2569 [SCOI2010]\u80a1\u7968\u4ea4\u6613(\u5355\u8c03\u961f\u5217\u4f18\u5316DP)"
    },
    {
        "content": "\u5355\u8c03\u961f\u5217\u4f18\u5316dp\u7684\u6a21\u677f\u9898 \u7c7b\u4f3c\u9898\uff1a[NOIP2017pj]\u8df3\u623f\u5b50\n\n\u770b\u5230\u9898\u89e3\u91cc\u53ea\u6709\u4e00\u7bc7\u7528\u53cc\u7aef\u961f\u5217\u5b9e\u73b0\u5355\u8c03\u961f\u5217\u7684\u9898\u89e3\uff0c\u540c\u65f6\u601d\u8def\u7684\u6613\u7406\u89e3\u5ea6\u548c\u4ee3\u7801\u53ef\u8bfb\u6027\u4e0d\u9ad8\uff0c\u6240\u4ee5\u518d\u6765\u4e00\u7bc7\n\n\u72b6\u6001\uff1af[i][j]\u8868\u793a\u524di\u5929\u6301\u6709j\u5f20\u80a1\u7968\u83b7\u5f97\u4ef7\u503c\u7684\u7684\u6700\u5927\u503c\n\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b(\u8fd9\u9898\u53ef\u80fd\u6027\u6bd4\u8f83\u591a\uff0c\u6240\u4ee5\u5206\u7c7b\u8ba8\u8bba)\uff1a\n\n1.\u4e4b\u524d\u4e0d\u4e70\u4e0d\u5356\uff0c\u4eca\u5929\u4e70\uff1a\n\nf[i][j]=-j*ap[i] (0<=j<=as[i])\n\n2.\u4eca\u5929\u4e0d\u4e70\u4e0d\u5356\uff1a\n\nf[i][j]=max(f[i-1][j],f[i][j]) (0<=j<=p)\n\n3.i-w-1\u5929\u65f6\u6709k\u5f20(k<=j\u4e14i-w-1>=0)\uff1a\n\nf[i][j]=max(f[i][j],f[i-w-1][k]-ap[i]*(j-k)) (j-as[i]<=k<=j)\n\n4.i-w-1\u5929\u65f6\u6709k\u5f20(k>j\u4e14i-w-1>=0)\n\nf[i][j]=max(f[i][j],f[i-w-1][k]+bp[i]*(k-j)) (j<k<=j+bs[i])\n\n\u522b\u7684\uff1a\n\n1.\u5f00\u59cb\u65f6f\u8981\u8d4b\u6210\u6781\u5927\u503c\n\n2.\u6ce8\u610f\u8fb9\u754c\n\n3.\u7edf\u8ba1\u7b54\u6848\u65f6\u6709\u5faa\u73af\n\n\u4ee3\u7801\uff0870\u5206\uff09\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#include<iostream>\n#include<cstdio>\n#define ll long long\n#define INF 2147483647\nusing namespace std;\n\nll t,p,w,ap[2010],bp[2010],as[2010],bs[2010],f[2010][2010],ans=-INF;\n\nint main(){\n    cin>>t>>p>>w;\n    memset(f,128,sizeof(f));\n    for(ll i=1; i<=t; i++) scanf(\"%lld %lld %lld %lld\",&ap[i],&bp[i],&as[i],&bs[i]);\n    for(ll i=1; i<=t; i++){\n    \t//\u624b\u4e0a\u53ef\u4ee5\u4e00\u5f20\u80a1\u7968\u90fd\u6ca1\u6709\uff0c\u6240\u4ee5j\u53ef\u4ee5\u4e3a0\n        for(ll j=0; j<=as[i]; j++) f[i][j]=-j*ap[i];\n        for(ll j=0; j<=p; j++) f[i][j]=max(f[i-1][j],f[i][j]);\n\n        if(i-w-1<=0) continue;\n        //\u6b64\u65f6i-w-1==0\u65f6\u4e5f\u53ef\u4ee5\uff0c\u4f46\u4e0e\u4e0a\u9762\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u91cd\u5408\uff0c\u4e0d\u91cd\u590d\u66f4\u65b0\n        for(ll j=0; j<=p; j++){\n            for(ll k=j-as[i]; k<=j; k++) f[i][j]=max(f[i][j],f[i-w-1][k]-ap[i]*(j-k));\n            for(ll k=j+1; k<=j+bs[i]; k++) f[i][j]=max(f[i][j],f[i-w-1][k]+bp[i]*(k-j));\n            //k==j\u4e5f\u53ef\u4ee5\uff0c\u4f46\u91cd\u590d\u4e86\n        }\n    }\n    for(ll i=0; i<=p; i++) ans=max(ans,f[t][i]);\n    cout<<ans<<endl;\n    return 0;\n}\n```\n\n\u6ee1\u5206\u8fd8\u8981\u4f18\u5316\uff0c\u4f18\u5316\u65b9\u5f0f\uff1a\u5355\u8c03\u961f\u5217\n\n\u63a5\u4e0b\u6765\u7684\u8bf4\u660e\u548c\u4ee3\u7801\u7684\u6ce8\u91ca\u4ec5\u5305\u62ec\u5355\u8c03\u961f\u5217\u7684\u90e8\u5206\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#include<iostream>\n#include<cstdio>\n#define ll long long\n#define INF 2147483647\nusing namespace std;\n\ndeque<ll> q;\nll t,p,w,ap[2010],bp[2010],as[2010],bs[2010],f[2010][2010],ans=-INF;\n\nint main(){\n    cin>>t>>p>>w;\n    memset(f,128,sizeof(f));\n    for(ll i=1; i<=t; i++) scanf(\"%lld %lld %lld %lld\",&ap[i],&bp[i],&as[i],&bs[i]);\n    for(ll i=1; i<=t; i++){\n        for(ll j=0; j<=as[i]; j++) f[i][j]=-j*ap[i];\n        for(ll j=0; j<=p; j++) f[i][j]=max(f[i-1][j],f[i][j]);\n        if(i-w-1<=0) continue;\n        \n        while(!q.empty()) q.pop_front();\n        for(ll j=0; j<=p; j++){\n            while(!q.empty()&&q.front()<j-as[i]) q.pop_front();//\u961f\u5934\u8d85\u51fa\u4e86\u53ef\u4ee5\u76f4\u63a5\u8f6c\u79fb\u7684\u8303\u56f4\uff0c\u961f\u5934\u51fa\u961f\n            while(!q.empty()&&f[i-w-1][q.back()]+q.back()*ap[i]<=f[i-w-1][j]+j*ap[i]) q.pop_back();//\u961f\u5c3e\u7684\u4ef7\u503c\u4e0d\u5982\u65b0\u8fdb\u6765\u7684\uff0c\u961f\u5c3e\u51fa\u961f\n            q.push_back(j);//\u5165\u961f\n            f[i][j]=max(f[i][j],f[i-w-1][q.front()]+q.front()*ap[i]-j*ap[i]);//\u66f4\u65b0\u72b6\u6001\n        }\n\n        while(!q.empty()) q.pop_front();\n        for(ll j=p; j>=0; j--){//\u6ce8\u610f\uff0c\u4e3a\u4fdd\u6301\u5355\u8c03\u6027\uff0c\u5faa\u73af\u5012\u7740\u8dd1\n        \t//\u63a5\u4e0b\u6765\u540c\u4e0a\uff0c\u4e0d\u91cd\u590d\u6ce8\u91ca\n            while(!q.empty()&&q.front()>j+bs[i]) q.pop_front();\n            while(!q.empty()&&f[i-w-1][q.back()]+q.back()*bp[i]<=f[i-w-1][j]+j*bp[i]) q.pop_back();\n            q.push_back(j);\n            f[i][j]=max(f[i][j],f[i-w-1][q.front()]+q.front()*bp[i]-j*bp[i]);\n        }\n    }\n    for(ll i=0; i<=p; i++) ans=max(ans,f[t][i]);\n    cout<<ans<<endl;\n    return 0;\n}\n```",
        "postTime": 1551609527,
        "uid": 27924,
        "name": "xukuan",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2569 \u3010[SCOI2010]\u80a1\u7968\u4ea4\u6613\u3011"
    },
    {
        "content": " [$$ \\Large \\texttt{My Blog} $$](http://blog.flyinthesky.win/bzoj3675/)\n\n------------\n\n\u5bb9\u6613\u8bbe$dp(i,j)$\u4e3a\u524d$i$\u5929\u6709$j$\u80a1\u7968\u7684\u6700\u5927\u6536\u76ca\n\n\u5219\u5206\u60c5\u51b5\u8ba8\u8bba\n\n1\u3001\u4e70\u5165\u80a1\u7968\n\n$$dp(i,j)=\\max_{k \\in [j-AS[i], j-1]}\\{dp(i,j), dp(i-w-1,k) + AP_i (k-j)\\}$$\n\n2\u3001\u5356\u51fa\u80a1\u7968\n\n$$dp(i,j)=\\max_{k \\in [j+1,j+BS[i]]}\\{dp(i,j), dp(i-w-1,k) + BP_i (j-k)\\}$$\n\n3\u3001\u4ec0\u4e48\u4e5f\u4e0d\u505a\n\n$$dp(i,j)=\\max\\{dp(i,j), dp(i-1,j)\\}$$\n\n\u521d\u503c\uff1a\n\n$$dp(i,j)=-AP_i \\cdot j$$\n\n\u5176\u4e2d$0 \\leq j \\leq AS_i$\n\n\u5176\u4f59\u5747\u4e3a$-\u221e$\n\n\u7136\u540e\u8003\u8651\u4f18\u5316\n\n\u6211\u4eec\u5c06$i,j$\u770b\u4f5c\u5b9a\u503c\uff0c\u5219\u5c06\u4e0e$k$\u65e0\u5173\u5f0f\u5b50\u79fb\u5230$\\max$\u5916\u9762\uff0c\u53d1\u73b0\u8fd9\u53ef\u4ee5\u5355\u8c03\u961f\u5217\u4f18\u5316\u3002\n\n```c++\n#include<cstdio> \n#include<cstring>\n#include<algorithm>\n#include<iostream>\n#include<queue>\n#include<set>\n#include<cmath>\n#define ms(i, j) memset(i, j, sizeof i)\n#define LL long long\n#define db long double\n#define fir first\n#define sec second\n#define mp make_pair\nusing namespace std;\n\nnamespace flyinthesky {\n    \n    const int MAXN = 2000 + 5, INF = 2000000000;\n\n    int n, maxP, w, AP[MAXN], BP[MAXN], AS[MAXN], BS[MAXN];\n    int dp[MAXN][MAXN];\n    int l, r, q[MAXN];\n    \n    void clean() {\n    }\n    int solve() {\n    \t\n    \tclean();\n    \t\n    \tcin >> n >> maxP >> w;\n    \tfor (int i = 1; i <= n; ++i) {\n    \t\tscanf(\"%d%d%d%d\", &AP[i], &BP[i], &AS[i], &BS[i]);\n        }\n        \n        for (int i = 0; i <= n; ++i)\n        for (int j = 0; j <= maxP; ++j) dp[i][j] = -INF;\n        \n        for (int i = 1; i <= n; ++i) \n        for (int j = 0; j <= AS[i]; ++j) dp[i][j] = -AP[i] * j;\n\n        for (int i = 1; i <= n; ++i) {\n            l = 1, r = 0;\n            for (int j = 0; j <= maxP; ++j) dp[i][j] = max(dp[i][j], dp[i - 1][j]);\n            if (i <= w) continue ;\n            for (int j = 0; j <= maxP; ++j) { // buy\n                while (l <= r && q[l] < j - AS[i]) ++l;\n                while (l <= r && dp[i - w - 1][j] + AP[i] * j >= dp[i - w - 1][q[r]] + AP[i] * q[r]) --r;\n                q[++r] = j;\n                if (l <= r) dp[i][j] = max(dp[i - w - 1][q[l]] + AP[i] * q[l] - AP[i] * j, dp[i][j]);\n            }\n            l = 1, r = 0;\n            for (int j = maxP; j >= 0; --j) { // sell\n                while (l <= r && q[l] > j + BS[i]) ++l;\n                while (l <= r && dp[i - w - 1][j] + BP[i] * j >= dp[i - w - 1][q[r]] + BP[i] * q[r]) --r;\n                q[++r] = j;\n                if (l <= r) dp[i][j] = max(dp[i - w - 1][q[l]] + BP[i] * q[l] - BP[i] * j, dp[i][j]);\n            }\n        }\n        \n        //for (int i = 0; i <= n; ++i)\n        //for (int j = 0; j <= maxP; ++j) printf(\"i=%d, j=%d, dp=%d\\n\", i, j, dp[i][j]);\n        \n        int ans = 0;\n        for (int j = 0; j <= maxP; ++j) ans = max(ans, dp[n][j]);\n        \n        cout << ans;\n    \t\n        return 0;\n    }\n}\nint main() { \n    flyinthesky::solve();\n    return 0;\n}\n```",
        "postTime": 1550661435,
        "uid": 12943,
        "name": "FlyInTheSky",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2569 \u3010[SCOI2010]\u80a1\u7968\u4ea4\u6613\u3011"
    },
    {
        "content": "[\u535a\u5ba2\u94fe\u63a5](https://www.cnblogs.com/sun123zxy/p/luogu2569.html)\n\n\u7b2c\u4e00\u773c\u770b\u9898\u5c31\u89c9\u5f97\u662f\u4e2adp \uff0c\u7136\u540e\u770b\u52302000\u7684\u8303\u56f4\uff0chmm\u5927\u6982\u662f\u4e2an^2\u76842\u7ef4dp\n\n\u5f00\u59cb\u8bbe\u72b6\u6001\uff0c\u7b2c\u4e00\u7ef4\u80af\u5b9a\u662f\u5929\u6570\u7684\u679a\u4e3e\uff0c\u7b2c\u4e8c\u7ef4...\u770b\u7740MaxP\u7684\u8303\u56f4\uff0c\u89c9\u5f97\u5e94\u8be5\u662f\u6301\u6709\u80a1\u7968\u6570\u91cf\u7684\u679a\u4e3e\n\n\u90a3\u4e48dp[i][j]\u5c31\u662f\u5bf9\u4e8e1~i\u5929\uff0c\u7b2ci\u5929\u6301\u6709j\u5f20\u80a1\u7968\u7684\u60c5\u51b5\u4e0b\u6700\u591a\u80fd\u8d5a\u7684\u94b1\n\n\u7136\u540e\u60f3\u8f6c\u79fb\u65b9\u7a0b\uff0c\u5206\u6210\u51e0\u79cd\u60c5\u51b5\n\n**case 1\uff1a**\u524d\u9762\u90fd\u4e0d\u4e70\uff0c\u4ece\u7b2ci\u5929\u5f00\u59cb\u4e70\n\n\u3000\u3000\u4e5f\u5c31\u662f\u4ece\u4e00\u65e0\u6240\u6709\u7684\u60c5\u51b5\u4e0b\u4e70j\u5f20\u80a1\u7968dp[i][j]=-APi*j\n\n\n**case 2\uff1a**\u4e0d\u4e70\u4e0d\u5356\n\n\u3000\u3000\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4e0d\u4f1a\u5c31\u4e0d\u4f1a\u53d7\u5230W\u7684\u9650\u5236\uff0c\u76f4\u63a5dp[i][j]=dp[i-1][j]\n\n \n\n**case 3\uff1a**\u53d1\u751f\u4e70\u5356\n\n\u3000\u3000\u9996\u5148\u8981\u8003\u8651\u5e94\u8be5\u4ece\u524d\u9762\u54ea\u4e00\u5929\u7684\u72b6\u6001\u8f6c\u79fb\u8fc7\u6765\uff0c\u4e5f\u5c31\u662f\u4e0a\u4e00\u6b21\u4e70\u5356\u5728\u54ea\u4e00\u5929\u53d1\u751f\u3002\n\n\u3000\u3000\u4e4d\u4e00\u770b\u597d\u50cf\u6ca1\u529e\u6cd5\u77e5\u9053\u5e94\u8be5\u4ece\u54ea\u4e00\u5929\u8f6c\u79fb\uff0c\u83ab\u975e\u53c8\u591a\u4e00\u5c421~i-W-1\u7684\u5faa\u73af\uff1f\n\n\u3000\u3000\u5176\u5b9e\u4e0d\u7528\u3002\u4e0a\u4e00\u6b21\u4e70\u5356\u6240\u83b7\u5f97\u7684\u6700\u5927\u503c\u53ef\u4ee5\u6839\u636ecase 2\u7684dp\u65b9\u7a0b\u5411\u540e\u8f6c\u79fb\n\n\u3000\u3000\u6240\u4ee5\u76f4\u63a5\u4ecei-W-1\u5929\u8f6c\u79fb\u5c31\u884c\n\n \n\n\u3000\u3000**case 3.1\uff1a**\u53c8\u5356\u53c8\u4e70\n\n\u3000\u3000\u3000\u3000\u4ed4\u7ec6\u60f3\u60f3\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0d\u53ef\u80fd\u6210\u4e3a\u6700\u5927\u503c\u3002\u56e0\u4e3a\u6709APi>=BPi\uff0c\u5356\u4e86\u53c8\u4e70\u4e0d\u5982\u4e70\u5c11\u70b9\uff0c\u591a\u6298\u817e\u662f\u4e0d\u884c\u7684\n\n \n\n\u3000\u3000**case 3.2\uff1a**\u53ea\u4e70\u4e0d\u5356\n\n\u3000\u3000\u3000\u3000\u65e2\u7136\u662f\u4e70\uff0c\u90a3\u4e48\u4e4b\u524d\u6301\u6709\u7684\u80a1\u7968\u5fc5\u7136\u6bd4j\u5c11\uff0c\u679a\u4e3e\u4e4b\u524d\u6301\u6709\u7684\u80a1\u7968k\uff0c\u82b1\u94b1(j-k)*APi\n\n\u3000\u3000\u3000\u3000dp[i][j]=dp[i-W-1][k]-(j-k)*APi;\n\n \n\n\u3000\u3000**case3.3\uff1a**\u53ea\u5356\u4e0d\u4e70\n\n\u3000\u3000\u3000\u3000\u4e0ecase 3.2\u7c7b\u4f3c\n\n\u3000\u3000\u3000\u3000dp[i][j]=max dp[i-W-1][k]+(k-j)*BPi\n\n \n\n\u5927\u6982\u5c31\u662f\u8fd9\u6837\u3002dp[T][0]\u5c31\u662f\u6700\u7ec8\u7b54\u6848\uff08\u4fdd\u9669\u8d77\u89c1\u6211\u5199\u7684\u662fmax dp[T][0~MaxP]\uff09\n\n \n\n\u65f6\u95f4\u5927\u6982\u662fO(n*MaxP^2)\n\n \n\n\u9884\u671f50pt\u505a\u6cd5\uff08\u5b9e\u964570pt\uff09(\u9644\u4f2a\u4ee3\u7801\u63d0\u7eb2)\n \n\n```\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\n\nint T,MaxP,W;\n\nstruct pig {\n    int APi,BPi,ASi,BSi;\n} day[2005];\n\nint dp[2005][2005];\n\nint main() {\n    cin>>T>>MaxP>>W;\n    for(int i=1; i<=T; i++) {\n        scanf(\"%d%d%d%d\",&day[i].APi,&day[i].BPi,&day[i].ASi,&day[i].BSi);\n    }\n    for(int i=0; i<=T; i++) {\n        for(int j=0; j<=MaxP; j++) {\n            dp[i][j]=-999999999;\n        }\n    }\n    dp[0][0]=0;\n    \n    for(int i=1;i<=T;i++){\n        for(int j=0;j<=MaxP;j++){\n            dp[i][j]=dp[i-1][j];\n            if(j<=day[i].ASi){\n                \n                dp[i][j]=max(dp[i][j],-j*day[i].APi);\n            }\n            if(i-W-1<0){\n                continue;\n            }\n            for(int k=j-day[i].ASi;k<j;k++){\n                if(k<0){\n                    continue;\n                }\n                dp[i][j]=max(dp[i][j],dp[i-W-1][k]-(j-k)*day[i].APi);\n            }\n            for(int k=j+1;k<=j+day[i].BSi;k++){\n                if(k>MaxP){\n                    break;\n                }\n                dp[i][j]=max(dp[i][j],dp[i-W-1][k]+(k-j)*day[i].BPi);\n            }\n        }\n    }\n    int ans=0;\n    for(int j=0; j<=MaxP; j++) {\n        ans=max(ans,dp[T][j]);\n    }\n    cout<<ans;\n    return 0;\n}\n/*\n\u8f93\u5165\n\u521d\u59cb\u5316 \u8d4b-inf\uff0cdp[0][0]=0 \ndp\u5faa\u73af\n    i \u5929\u65701-T \n        j \u5f53\u524d\u6301\u80a1\u65700-Maxp\n            \u4ece\u5f53\u524d\u5929\u5f00\u4e70 j<=Asi dp[i][j]=-j*APi; \n            \u4e0d\u4e70\u4e0d\u5356 dp[i][j]=dp[i-1][j]\n            \u5982\u679ci-W-1>=0\n                k \u524d\u6b21\u8d2d\u4e70\u65f6\u6301\u80a1\u6570 \u4e70\u80a1 (j-Asi)~j&&>=0\n                    dp[i][j]=max dp[i-W-1][k]-(j-k)*APi;\n                k \u524d\u6b21\u8d2d\u4e70\u65f6\u6301\u80a1\u6570 \u5356\u80a1  j~(j+Bsi)&&<=MaxP\n                    dp[i][j]=max dp[i-W-1][k]+(k-j)*BPi\n\u8f93\u51fa\uff0cmax(dp[0][0~MaxP]) \n\n\u81ea\u6d4b\u6570\u636e \n1\n1 1\n1 1\n1 1\n1 1\n1 1\n0\n1 1\n1 1\n1 1\n1 1\n1 1\n*/\n(\u9644\u4f2a\u4ee3\u7801\u63d0\u7eb2)\n```\n\n \u600e\u4e48\u7ee7\u7eed\u4f18\u5316\u5462\uff1f\n\n\u5982\u679c\u4ecd\u7136\u4fdd\u6301dp[i][j]\u7684\u5f62\u5f0f\uff0ci\u548cj\u7684\u5faa\u73af\u80af\u5b9a\u662f\u4e0d\u80fd\u53bb\u6389\u7684\uff0c\u6240\u4ee5\u8003\u8651\u4f18\u5316k\n\n \n\n\u7528case 3.2\uff1a\u53ea\u4e70\u4e0d\u5356 \u4e3e\u4f8b\n\n\u5b83\u7684dp\u65b9\u7a0b\u662fdp[i][j]=max dp[i-W-1][k]-(j-k)*APi;\n\n\u4e58\u6cd5\u5206\u914d\u5f8b\u5f97dp[i][j]=max dp[i-W-1][k]+k*APi-j*APi;\n\nj\u662f\u679a\u4e3e\u51fa\u6765\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u62c6\u5206\u4e00\u4e0bmax\uff0c\u5f97dp[i][j]=max(dp[i-W-1][k]+k*APi)-j*APi;\n\n\u56e0\u4e3a\u5bf9\u4e8e\u6bcf\u4e2a\u786e\u5b9a\u7684i\u548cj\uff0ck\u5c5e\u4e8e\u533a\u95f4 [j - ASi ,j-1] \uff0c\u5047\u8bbei\u662f\u5b9a\u503c\uff0cASi\u5c31\u662f\u5b9a\u503c\u3002\u90a3\u4e48\u5bf9\u4e8e\u6240\u6709j\uff0ck\u7684\u533a\u95f4\u5927\u5c0f\u662f\u4e00\u6837\u7684\n\n\u4e00\u4e2a\u957f\u5ea6\u56fa\u5b9a\u7684\u533a\u95f4\u4e00\u683c\u4e00\u683c\u7684\u79fb\u52a8...\u8fd9\u4e0d\u5c31\u662f\u6ed1\u52a8\u7a97\u53e3\u5417\n\n\u5355\u8c03\u961f\u5217\u4f18\u5316\uff0cO(n*MaxP)\uff0c100pt\u5230\u624b\n\n```\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\n\nint T,MaxP,W;\n\nstruct MonoQue {\n\tint lim;//\u7ef4\u6301\u7684\u957f\u5ea6 \n\tint size;//\u6700\u5927\u5b58\u50a8\u91cf \n\tint que[2005];//\u5355\u8c03\u961f\u5217 \n\tint data[2005];//\u7ef4\u62a4\u7684\u6570\u636e\n\tint head,tail;\n\n\tvoid init(int mys,int mylim) {\n\t\tsize=mys;\n\t\tlim=mylim;\n\t\thead=0;\n\t\ttail=0;\n\t}\n\tvoid push(int id) {//\u5411\u5355\u8c03\u961f\u5217\u4e2d\u52a0\u5165\u5e76\u7ef4\u62a4\uff0cid\u53ef\u4ee5\u5728\u7279\u6b8a\u60c5\u51b5\u4e0b\u8df3\u8dc3\u524d\u8fdb \n\t\tif(id<=size) {//\u9632\u8d8a\u754c\u5904\u7406 \n\t\t\tfor(; head<tail;) {\n\t\t\t\tif(data[que[tail-1]]>data[id]) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\ttail--;\n\t\t\t}\n\t\t\tque[tail]=id;\n\t\t\ttail++;\n\t\t}\n\t\tif(que[head]+lim<=id) {\n\t\t\tpop();\n\t\t}\n\t}\n\tvoid pop() {\n\t\thead++;\n\t}\n\tint quetop() {\n\t\treturn que[head];\n\t}\n\tint top() {\n\t\treturn data[quetop()];\n\t}\n};\n\nstruct pig {\n\tint APi,BPi,ASi,BSi;\n} day[2005];\n\nint dp[2005][2005];\n\nint main() {\n\tcin>>T>>MaxP>>W;\n\tfor(int i=1; i<=T; i++) {\n\t\tscanf(\"%d%d%d%d\",&day[i].APi,&day[i].BPi,&day[i].ASi,&day[i].BSi);\n\t}\n\tfor(int i=0; i<=T; i++) {\n\t\tfor(int j=0; j<=MaxP; j++) {\n\t\t\tdp[i][j]=-999999999;\n\t\t}\n\t}\n\tdp[0][0]=0;\n\n\tMonoQue buy,sell;\n\tfor(int i=1; i<=T; i++) {\n\t\tbuy.init(MaxP,day[i].ASi+1);\n\t\tsell.init(MaxP,day[i].BSi+1);\n\t\tif(i-W-1>=0) {//\u9632\u6570\u7ec4\u8d85\u4e0b\u754c\n\t\t\tfor(int j=0; j<=MaxP; j++) {\n\t\t\t\tbuy.data[j]=dp[i-W-1][j]+j*day[i].APi;\n\t\t\t\tsell.data[j]=dp[i-W-1][j]+j*day[i].BPi;\n\t\t\t}\n\t\t}\n\t\tfor(int j=0; j<day[i].BSi; j++) {\n\t\t\tsell.push(j);//sell\u9700\u8981\u9884\u5148\u52a0\u5165\n\t\t}\n\t\tfor(int j=0; j<=MaxP; j++) {\n\t\t\tdp[i][j]=dp[i-1][j];\n\n\t\t\tif(j<=day[i].ASi) {\n\t\t\t\tdp[i][j]=max(dp[i][j],-j*day[i].APi);\n\t\t\t}\n\t\t\tif(i-W-1<0) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tbuy.push(j);\n\t\t\tdp[i][j]=max(dp[i][j],buy.top()-j*day[i].APi);\n\n\t\t\tsell.push(j+day[i].BSi);//\u5355\u8c03\u961f\u5217\u91cc\u4f1a\u5904\u7406\u8d85\u4e86MaxP\u7684\u60c5\u51b5 \n\t\t\t\t\n\t\t\tdp[i][j]=max(dp[i][j],sell.top()-j*day[i].BPi);\n\t\t}\n\t}\n\tint ans=0;\n\tfor(int j=0; j<=MaxP; j++) {\n\t\tans=max(ans,dp[T][j]);\n\t}\n\tcout<<ans;\n\treturn 0;\n}\n/*\n\u81ea\u6d4b\u6570\u636e\n3 2 0\n2 1 1 1\n3 2 1 1\n4 3 1 1\n*/\n```",
        "postTime": 1538662157,
        "uid": 23632,
        "name": "sun123zxy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2569 \u3010[SCOI2010]\u80a1\u7968\u4ea4\u6613\u3011"
    }
]
[
    {
        "content": "\u8fd9\u7bc7\u9898\u89e3\u6709\u70b9\u6c34\u3002\n\n\u56e0\u4e3a\u53ea\u6709\u516d\u91cd\u5faa\u73af\uff0c\u6240\u4ee5\u7b54\u6848\u6700\u591a\u662f\u5173\u4e8e $n$ \u7684\u516d\u6b21\u591a\u9879\u5f0f\u3002\n\n\u53ea\u9700\u8981\u6c42\u51fa $0,1,2,3,4,5,6$ \u5904\u7684\u70b9\u503c\u518d\u63d2\u503c\u56de\u53bb\u5c31\u884c\u4e86\u3002\n\n\u6c42\u70b9\u503c\u76f4\u63a5\u66b4\u529b\uff0c\u800c\u63d2\u503c\u8fd9\u91cc\u6211\u91c7\u7528\u4e86\u8303\u5fb7\u8499\u5fb7\u77e9\u9635\u7684\u9006\uff0c\u6211\u76f4\u63a5\u6253\u51fa\u4e86 $7\\times 7$ \u7684\u8868\uff0c\u5b9e\u9645\u4e0a\u60f3\u8981\u7b97\u7684\u8bdd\u53ef\u4ee5\u770b\u6211\u4e0a\u4e00\u7bc7\u9898\u89e3\u91cc\u7684\u94fe\u63a5 https://www.luogu.com.cn/blog/ix-35/solution-p7016\u3002\n\n\u6ce8\u610f\u5206\u6570\u7c7b\u8fd0\u7b97\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int MAXN=45;\nstruct Frac {\n\tFrac (int a=0,int b=0) {x=a,y=b;}\n\tll x,y;\n}px[MAXN],py[MAXN],xs[MAXN];\nint n,m,l,sj[MAXN],op[MAXN],ox[MAXN],oy[MAXN],nv[MAXN];\nll v[7][7]={  // \u8fd9\u8868\u5927\u6982\u662f\u8303\u5fb7\u8499\u5fb7\u9006\u77e9\u9635\u7684\u4e00\u4e2a\u5206\u5b50\uff0c\u5177\u4f53\u7684\u6709\u70b9\u5fd8\u4e86\n{720,-1764,1624,-735,175,-21,1},\n{0,-720,1044,-580,155,-20,1},\n{0,-360,702,-461,137,-19,1},\n{0,-240,508,-372,121,-18,1},\n{0,-180,396,-307,107,-17,1},\n{0,-144,324,-260,95,-16,1},\n{0,-120,274,-225,85,-15,1}};\nll b[7]={720,-120,48,-36,48,-120,720};\nstring s;\nll gcd (ll a,ll b) {return (b?gcd(b,a%b):a);}\nFrac yf (Frac a) {\n\tif (a.x==0) {a.y=1;return a;}\n\tll tmp=gcd(a.y,a.x);\n\ta.y/=tmp,a.x/=tmp;\n\treturn a;\n}\nFrac add (Frac a,Frac b) {\n\tll tmp=gcd(a.y,b.y);\n\ttmp=a.y/tmp*b.y;\n\tFrac c;\n\tc.y=tmp;\n\tc.x=a.x*(tmp/a.y)+b.x*(tmp/b.y);\n\treturn yf(c);\n}\nFrac neg (Frac a) {\n\ta.x*=-1,a.y*=-1;\n\treturn yf(a);\n}\nFrac minus (Frac a,Frac b) {\n\treturn yf(add(a,neg(b)));\n}\nFrac mult (Frac a,Frac b) {\n\tFrac c;\n\tc.x=a.x*b.x,c.y=a.y*b.y;\n\treturn yf(c);\n}\nFrac ds (Frac a) {\n\tswap(a.x,a.y);\n\treturn yf(a);\n}\nFrac divs (Frac a,Frac b) {\n\treturn yf(mult(a,ds(b)));\n}\nint solve (int l,int r,int in) {\n\tif (l==r) {return 1;}\n\tint las=l,res=0;\n\tfor (int i=l+1;i<=r;i++) {\n\t\tif (sj[i]==in) {\n\t\t\tif (op[las]==1) {\n\t\t\t\tfor (int j=0;j<nv[oy[las]];j++) {\n\t\t\t\t\tnv[ox[las]]=j;\n\t\t\t\t\tres+=solve(las+1,i-1,in+1);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tres++;\n\t\t\t}\n\t\t\tlas=i;\n\t\t}\n\t}\n\tif (op[las]==1) {\n\t\tfor (int j=0;j<nv[oy[las]];j++) {\n\t\t\tnv[ox[las]]=j;\n\t\t\tres+=solve(las+1,r,in+1);\n\t\t}\n\t} else {\n\t\tres++;\n\t}\n\t//cout << l << \"  \" << r << \"  \" << res << endl;\n\treturn res;\n}\nint main () {\n\tint nw=0;\n\twhile (getline(cin,s)) {\n\t\tl=s.length();\n\t\tint cur=0;\n\t\tnw++;\n\t\twhile (s[cur]==' ') {\n\t\t\tcur+=4;\n\t\t\tsj[nw]++;\n\t\t}\n\t\tif (s[cur]=='l') {op[nw]=2;}\n\t\telse {\n\t\t\top[nw]=1;\n\t\t\tox[nw]=s[cur+4]-'a'+10;\n\t\t\toy[nw]=(s[cur+15]>='a'&&s[cur+15]<='z')?(s[cur+15]-'a'+10):(s[cur+15]-'0');\n\t\t}\n\t}\n\tfor (int i=1;i<=9;i++) {nv[i]=i;}\n\tfor (int i=0;i<=6;i++) {\n\t\tnv['n'-'a'+10]=i;\n\t\tpx[i]=Frac(i,1);\n\t\tint tmp=solve(1,nw,0);\n\t\tpy[i]=Frac(tmp,1);\n\t}\n\tfor (int i=0;i<=6;i++) {\n\t\txs[i].y=1;\n\t\tfor (int j=0;j<=6;j++) {\n\t\t\txs[i]=add(xs[i],divs(mult(py[j],Frac(v[j][i],1)),Frac(b[j],1)));\n\t\t}\n\t}\n\tfor (int j=6;j>=0;j--) {\n\t\tif (xs[j].x<0) {\n\t\t\txs[j].x*=-1,xs[j].y*=-1;\n\t\t}\n\t\tif (xs[j].y<0) {printf(\"-\");xs[j].y*=-1;}\n\t\telse if (j<6) {printf(\"+\");}\n\t\tprintf(\"%lld/%lld\",xs[j].x,xs[j].y);\n\t\tfor (int k=1;k<=j;k++) {printf(\"*n\");}\n\t}\n\treturn 0;\n}\n\n```\n",
        "postTime": 1623738113,
        "uid": 113546,
        "name": "ix35",
        "ccfLevel": 10,
        "title": "[NWRRC2015] Fygon \u9898\u89e3"
    }
]
[
    {
        "content": "- Update on 2022.11.30\uff1a\u4fee\u6539\u7b14\u8bef\u3002\n\n*[P3421 [POI2005] SKO-Knights](https://www.luogu.com.cn/problem/solution/P3421)\n\n\u5de7\u5999\u7ebf\u6027\u4ee3\u6570\u9898\u3002\n\n\u9898\u76ee\u8981\u6c42\u6211\u4eec\u627e\u5230\u4e24\u4e2a\u5411\u91cf $d, e$\uff0c\u4f7f\u5f97\u5b83\u4eec\u7684 **\u6574\u7cfb\u6570** \u7ebf\u6027\u7ec4\u5408\u5f97\u5230\u7684\u7ebf\u6027\u7a7a\u95f4\uff08\u7b80\u79f0\u6574\u7cfb\u6570\u7ebf\u6027\u7a7a\u95f4\uff09\u7b49\u4ef7\u4e8e\u7ed9\u51fa\u7684\u6240\u6709\u5411\u91cf\u7684\u6574\u7cfb\u6570\u7ebf\u6027\u7a7a\u95f4\u3002\n\n\u5b9a\u4e49 $\\mathrm{span}(S)$ \u8868\u793a\u5411\u91cf\u96c6\u5408 $S$ \u7684\u6574\u7cfb\u6570\u7ebf\u6027\u7a7a\u95f4\uff0c\u5373\n$$\n\\mathrm{span}(S) = \\left\\{\\sum\\limits_{a_i\\in S} c_ia_i\\ (c_i\\in \\mathbb{Z})\\right\\}\n$$\n\n\u5982\u679c\u6211\u4eec\u80fd\u5c06\u4e09\u4e2a\u5411\u91cf $a, b, c$ \u5408\u5e76\u6210\u4e0e\u4e4b\u7b49\u4ef7\u7684\u4e24\u4e2a\u5411\u91cf $d, e$\uff0c\u5c31\u80fd\u591f\u89e3\u51b3\u672c\u9898\u3002\u6839\u636e\u57fa\u7840\u7684\u7ebf\u6027\u4ee3\u6570\u77e5\u8bc6\uff0c\u4e0d\u6539\u53d8\u77e9\u9635\u884c\u7a7a\u95f4\u7684\u521d\u7b49\u884c\u53d8\u6362\u6709\u4e09\u79cd\uff1a\n\n- \u5151\u6362\uff1a\u5bf9\u5e94\u672c\u9898\u5373\u53ef\u4ee5\u4efb\u610f\u4ea4\u6362 $a, b, c$\u3002\n- \u500d\u4e58\u53d8\u6362\uff1a\u5bf9\u5e94\u672c\u9898\u5373\u5411\u91cf\u53ef\u4ee5\u4e58\u4ee5\u4efb\u610f\u975e $0$ \u6574\u6570\u3002\n- \u500d\u52a0\u53d8\u6362\uff1a\u5bf9\u5e94\u672c\u9898\u5373\u5411\u91cf\u53ef\u4ee5\u52a0\u4e0a\u4efb\u610f\u6574\u6570\u500d\u5176\u5b83\u5411\u91cf\u3002\n\n\u5f53\u7136\uff0c\u4e0a\u8ff0\u6027\u8d28\u4ec5\u5728 **\u5b9e\u7cfb\u6570** \u7ebf\u6027\u7ec4\u5408\u7684\u524d\u63d0\u4e0b\u6210\u7acb\u3002\u5f53\u8981\u6c42\u7cfb\u6570\u4e3a **\u6574\u6570** \u65f6\uff0c\n\n- \u5151\u6362\u663e\u7136\u4e0d\u6539\u53d8\u77e9\u9635\u884c\u7a7a\u95f4\u3002\n- \u500d\u4e58\u53d8\u6362 **\u53ef\u80fd\u6539\u53d8** \u77e9\u9635\u884c\u7a7a\u95f4\uff0c\u56e0\u4e3a **\u6574\u6570\u4e58\u6cd5\u4e0d\u53ef\u9006**\u3002\u5982 $\\mathrm{span}((0, 1), (1, 0))\\neq \\mathrm{span}((0, 2), (1, 0))$\uff0c\u524d\u8005\u662f\u4efb\u610f\u6574\u70b9\uff0c\u540e\u8005\u662f\u4efb\u610f\u7eb5\u5750\u6807\u662f\u5076\u6570\u7684\u6574\u70b9\u3002\n- \u500d\u52a0\u53d8\u6362 **\u4e0d\u6539\u53d8** \u77e9\u9635\u884c\u7a7a\u95f4\uff1a\u5bf9\u4e8e\u4efb\u610f $p = y(a + xb) + zb\\in \\mathrm{span}(a + xb, b)$\uff0c\u5b83\u672c\u8d28\u4e0a\u4ecd\u662f $a, b$ \u7684\u6574\u7cfb\u6570\u7ebf\u6027\u7ec4\u5408 $ya + (xy + z)b$\u3002\u5bf9\u4e8e\u4efb\u610f $p = ya + zb \\in \\mathrm{span}(a, b)$\uff0c\u6211\u4eec\u4e5f\u603b\u53ef\u4ee5\u5c06\u5176\u8868\u793a\u4e3a $a + xb$ \u548c $b$ \u7684\u6574\u7cfb\u6570\u7ebf\u6027\u7ec4\u5408 $y(a + xb) + (z - xy) b$\u3002\n\n\u5f88\u597d\uff01\u5982\u679c\u6574\u7cfb\u6570\u500d\u52a0\u53d8\u6362\u4e0d\u6539\u53d8\u6574\u7cfb\u6570\u610f\u4e49\u4e0b\u7684\u77e9\u9635\u884c\u7a7a\u95f4\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528 **\u8f97\u8f6c\u76f8\u51cf\u6cd5**\u3002\n\n\u5177\u4f53\u5730\uff0c\u8003\u8651\u4e24\u4e2a\u5411\u91cf $a, b$\uff0c\u6211\u4eec\u80fd\u591f\u5728 **\u4e0d\u6539\u53d8\u5176\u6574\u7cfb\u6570\u7ebf\u6027\u7a7a\u95f4** \u7684\u524d\u63d0\u4e0b\uff0c\u5c06 $b$ \u7684\u67d0\u4e00\u7ef4\u53d8\u4e3a $0$\u3002\u53ea\u9700\u5bf9 $a, b$ \u5728\u8fd9\u4e00\u7ef4\u8fdb\u884c\u8f97\u8f6c\u76f8\u51cf\u6cd5\u5373\u53ef\u3002\n\n\u8003\u8651\u4e09\u4e2a\u5411\u91cf $a, b, c$\uff0c\u6211\u4eec\u5bf9 $a, b$ \u5728 $x$ \u8fd9\u4e00\u7ef4\u8fdb\u884c\u8f97\u8f6c\u76f8\u51cf\uff0c\u518d\u5bf9 $a, c$ \u5728 $x$ \u8fd9\u4e00\u7ef4\u8fdb\u884c\u8f97\u8f6c\u76f8\u51cf\u3002\u6b64\u65f6 $x_b, x_c$ \u5747\u4e3a $0$\uff0c\u610f\u5473\u7740 $b, c$ **\u5171\u7ebf**\u3002\u56e0\u6b64\uff0c\u5bf9 $b, c$ \u5728 $y$ \u8fd9\u4e00\u7ef4\u8fdb\u884c\u8f97\u8f6c\u76f8\u51cf\uff0c\u5c31\u53ef\u4ee5\u4f7f $y_b\\gets \\mathrm{gcd}(y_b, y_c)$\uff0c\u800c $c$ \u53d8\u6210\u4e86 **\u96f6\u5411\u91cf**\uff0c\u5bf9 $\\mathrm{span}(a, b, c)$ \u6ca1\u6709\u4efb\u4f55\u8d21\u732e\uff0c\u53ef\u4ee5 **\u76f4\u63a5\u820d\u53bb**\uff0c\u5373\u6b64\u65f6 $\\mathrm{span}(a, b, c) = \\mathrm{span}(a, b)$\u3002\n\n\u7efc\u4e0a\uff0c\u6211\u4eec\u5728 $\\mathcal{O}(n\\log V)$ \u7684\u65f6\u95f4\u5185\u89e3\u51b3\u4e86\u95ee\u9898\uff0c\u5176\u4e2d $V$ \u662f\u503c\u57df\u3002\n\n\u6ce8\u610f\u70b9\uff1a\u9898\u76ee\u9650\u5236\u5750\u6807\u7edd\u5bf9\u503c\u4e0d\u8d85\u8fc7 $10 ^ 4$\uff0c\u56e0\u6b64\u8f97\u8f6c\u76f8\u51cf\u6cd5\u5f97\u5230\u6700\u7ec8\u7684 $a$ \u65f6\uff0c$x_a$ \u548c $y_b$ \u662f\u539f\u5750\u6807\u7684 $\\gcd$\uff0c\u663e\u7136\u6ee1\u8db3\u5750\u6807\u9650\u5236\u3002\u4f46 $y_a$ \u4e0d\u4e00\u5b9a\uff0c\u56e0\u6b64\u8981\u5bf9 $y_b$ \u53d6\u6a21\uff0c\u4e5f\u76f8\u5f53\u4e8e\u505a\u4e86\u4e00\u6b65\u8f97\u8f6c\u76f8\u51cf\uff08\u6b64\u65f6 $x_b = 0$ \u6240\u4ee5\u4e0d\u9700\u8981\u6539\u53d8 $x_a$\uff09\u3002\u6545\u6700\u7ec8\u5f97\u5230\u7684\u5750\u6807\u7edd\u5bf9\u503c\u4e0d\u8d85\u8fc7 $10 ^ 2$\uff0c\u6bd4\u9898\u76ee\u9650\u5236\u4f18\u4e00\u4e2a\u6570\u91cf\u7ea7\u3002\n\n\u4ece\u4e0a\u8ff0\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2a\u6709\u8da3\u7684\u6027\u8d28\uff1a**\u6574\u7cfb\u6570** \u610f\u4e49\u4e0b\uff0c\u4e24\u4e2a\u5411\u91cf\u53ef\u4ee5\u5728\u4e0d\u6539\u53d8\u5176\u5f20\u6210\u7684\u524d\u63d0\u4e0b\uff0c\u4f7f\u5176\u4e2d\u4e00\u4e2a\u5411\u91cf\u7684 **\u67d0\u4e00\u7ef4\u53d8\u6210 $0$**\uff0c\u800c\u53e6\u4e00\u4e2a\u5411\u91cf\u7684\u5bf9\u5e94\u7ef4\u53d8\u6210\u539f\u6765\u4e24\u4e2a\u5411\u91cf\u5728\u8fd9\u4e00\u7ef4\u4e0a\u7684 $\\gcd$\u3002\u8fd9\u4e5f\u662f\u89e3\u51b3\u672c\u9898\u7684\u5173\u952e\u6027\u8d28\u3002\n\n\u56e0\u6b64\uff0c\u63a8\u5e7f\u5230\u4efb\u610f\u7ef4\u5ea6 $k$\uff0c\u7ed9\u5b9a $n$ \u4e2a $k$ \u7ef4\u5411\u91cf\uff0c\u6211\u4eec\u53ef\u4ee5 $nk ^ 2\\log V$ \u6c42\u51fa\u8fd9\u7ec4\u5411\u91cf\u5728\u6574\u7cfb\u6570\u610f\u4e49\u4e0b\u7684\u57fa\u3002\u8bf6\uff0c\u7b49\u7b49\uff1f\u8fd9\u4e0d\u5c31\u662f **\u7ebf\u6027\u57fa** \u4e48\uff01\n\n---\n\n\u8ba9\u6211\u4eec\u66f4\u52a0\u6df1\u5165\u5730\u94bb\u7814\u4e00\u4e0b\u9898\u89e3\u533a\u7684\u505a\u6cd5\u3002\n\n\u5b9e\u9645\u4e0a\u4e24\u8005\u7684\u6838\u5fc3\u601d\u60f3\u662f\u7b49\u4ef7\u7684\uff0c\u5747\u4e3a\u521a\u624d\u63d0\u5230\u7684\u6027\u8d28\uff1a\u5c06\u4e24\u4e2a\u5411\u91cf\u7684\u5176\u4e2d\u4e00\u4e2a\u7684\u67d0\u4e00\u7ef4\u53d8\u6210 $0$\uff0c\u53e6\u4e00\u4e2a\u7684\u5bf9\u5e94\u7ef4\u53d8\u6210 $\\gcd$\u3002\u4e0d\u540c\u70b9\u5728\u4e8e\u672c\u6587\u7684\u7ebf\u6027\u4ee3\u6570\u505a\u6cd5\u662f\u4ece **\u500d\u52a0\u53d8\u6362** \u548c **\u8f97\u8f6c\u76f8\u9664\u6cd5** \u5f00\u59cb\uff0c**\u63a8\u5f97** \u8fd9\u4e00\u6838\u5fc3\u601d\u60f3\uff0c\u5373\u6211\u4eec\u8fd0\u7528\u6b63\u786e\u6027\u6709\u4fdd\u8bc1\u7684\u65b9\u6cd5\uff0c\u6700\u7ec8\u5f97\u5230\u7684\u7ed3\u679c\u662f\u8fd9\u6837\u4e00\u4e2a\u6027\u8d28\u3002\u800c\u9898\u89e3\u533a\u505a\u6cd5\u662f\u9996\u5148\u4ee4\u8fd9\u4e00\u6761\u4ef6\u6210\u7acb\uff0c\u518d\u6839\u636e\u5f97\u5230\u7684\u7ebf\u6027\u65b9\u7a0b\u7ec4\uff0c\u4f7f\u7528 exgcd \u548c\u4e00\u4e9b\u6570\u5b66\u63a8\u5bfc\u6c42\u89e3\u3002\u8fd9\u4e5f\u4f53\u73b0\u4e86 exgcd \u4e0e\u8f97\u8f6c\u76f8\u9664\u7684\u672c\u8d28\u8054\u7cfb\u3002\n\n\u4e0d\u59a8\u8bbe\u5bf9\u4e8e\u5411\u91cf $a, b$\uff0c\u6211\u4eec\u8981\u5c06 $x_b$ \u53d8\u4e3a $0$\u3002\u5219 $x_{a'}$ \u53ea\u80fd\u7b49\u4e8e $\\gcd(x_a, x_b)$\u3002\u56e0\u6b64\uff0c\u5bf9\u4e8e\u65b9\u7a0b $xx_a + yx_b = \\gcd(x_a, x_b)$\uff0c\u5bb9\u6613\u7528 [\u6269\u5c55\u6b27\u51e0\u91cc\u5f97](https://www.cnblogs.com/alex-wei/p/Number_Theory.html) \u7b97\u6cd5\u6c42\u5f97\u4e00\u7ec4\u89e3\uff0c\u5219 $y_{a'} = xy_a + yy_b$\u3002\u8fd9\u662f\u56e0\u4e3a $a' = xa + yb$\u3002\u5bf9\u4e8e\u5411\u91cf $b'$\uff0c\u6709 $x_{b'} = 0$\uff0c\u56e0\u6b64\u6709\u7ebf\u6027\u65b9\u7a0b\u7ec4\n$$\n\\begin{cases}\nxx_a + yx_b = 0 \\\\\nxy_a + yy_b = y_{b'} \n\\end{cases}\n$$\n\u6ce8\u610f\u8be5\u65b9\u7a0b\u7ec4\u7684 $x, y$ \u4e0e\u4e4b\u524d exgcd \u6c42\u5f97\u7684 $x, y$ \u4e0d\u540c\uff0c\u8fd9\u662f\u53e6\u4e00\u7ec4\u65b9\u7a0b\u63cf\u8ff0 $b' = xa + yb$\u3002\u540c\u65f6\u6211\u4eec\u9700 **\u6700\u5c0f\u5316 $y_{b'}$ \u7684\u7edd\u5bf9\u503c**\uff0c\u5426\u5219\u53ef\u80fd\u51fa\u73b0 $y_{b'} = 2$\uff0c\u4f46 $(0, 1) \\in \\mathrm{span}(a, b)$ \u7684\u60c5\u51b5\uff0c\u5373\u5bf9\u4e8e $\\mathrm{span}(a, b)$ \u4e2d\u6a2a\u5750\u6807\u4e3a $0$ \u7684\u6240\u6709\u70b9\uff0c$(0, y_{b'})$ \u4e0d\u662f\u4e0e $(0, 0)$ \u76f8\u90bb\u7684\u90a3\u4e00\u4e2a\uff0c\u8fd9\u6837\u4e0e $(0, 0)$ \u76f8\u90bb\u7684\u70b9\u65e0\u6cd5\u8868\u793a\u3002\n\n\u6839\u636e\u7b2c\u4e00\u4e2a\u65b9\u7a0b\uff0c\u5f97\u5230 $x, y$ \u7684\u5173\u7cfb\u5f0f $y = \\dfrac{-xx_a}{x_b}$\u3002\u5e26\u5165\u7b2c\u4e8c\u4e2a\u65b9\u7a0b\uff0c\u5f97\u5230 $xy_a - \\dfrac{xx_ay_b}{x_b} = y_{b'}$\uff0c\u5373\n$$\nx\\times \\dfrac{y_ax_b - x_ay_b}{x_b} = y_{b'}\n$$\n\u6211\u4eec\u7684\u76ee\u6807\u5f88\u660e\u786e\uff1a\u627e\u5230 **\u7edd\u5bf9\u503c** \u6700\u5c0f\u7684\u5408\u6cd5\u7684 $x$\u3002\u628a $x$ \u5199\u6210 $\\dfrac {x_b}d$ \u7684\u5f62\u5f0f\uff08\u56e0\u4e3a\u5206\u6bcd\u662f $x_b$\uff09\uff0c\u90a3\u4e48 $y = -\\dfrac{x_a} d$\uff0c\u56e0\u6b64 $d$ \u6ee1\u8db3\n$$\n\\begin{cases}\nd \\mid x_b \\\\\nd \\mid x_a \\\\\nd \\mid y_ax_b - x_ay_b\n\\end{cases}\n$$\n\u6ce8\u610f\u5230\u82e5\u6ee1\u8db3\u524d\u4e24\u6761\u9650\u5236\uff0c\u5219\u7b2c\u4e09\u6761\u9650\u5236\u81ea\u52a8\u6ee1\u8db3\uff0c\u6545\u5ffd\u7565\u3002\u4e3a\u4f7f $x$ \u7684\u7edd\u5bf9\u503c\u6700\u5c0f\uff0c$d$ \u7684\u7edd\u5bf9\u503c\u5e94\u5c3d\u91cf\u5927\u3002\u5230\u8fd9\u4e00\u6b65\uff0c\u5927\u5bb6\u5e94\u8be5\u90fd\u80fd\u770b\u51fa $d$ \u5e94\u53d6 $\\gcd(x_a, x_b)$\u3002\u56e0\u6b64\uff0c$y_{b'} = \\dfrac{y_ax_b - x_ay_b}{\\gcd(x_a, x_b)}$\u3002\n\n\u7efc\u4e0a\uff0c\u6211\u4eec\u5c06\u539f\u5411\u91cf $a, b$ \u5199\u6210\u4e86\u53e6\u4e24\u4e2a\u5411\u91cf $a', b'$\uff0c\u5176\u4e2d $x_{a'} = \\gcd(x_a, x_b)$\uff0c$y_{a'}$ \u7528 exgcd \u6c42\u89e3\uff0c$x_{b'} = 0$\uff0c$y_{b'} = \\dfrac{y_ax_b - x_ay_b}{\\gcd(x_a, x_b)}$\u3002\u5bf9 $a, c$ \u505a\u4e00\u904d\u7c7b\u4f3c\u7684\u64cd\u4f5c\uff0c\u518d\u5408\u5e76 $b, c$\uff08\u5373\u7c7b\u4f3c\u7ebf\u6027\u4ee3\u6570\u89e3\u6cd5\uff0c\u4ee4 $y_b \\gets \\gcd(y_b, y_c)$\uff0c\u7136\u540e\u4e22\u5f03 $c$\uff09\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u662f\u7ebf\u6027\u5bf9\u6570\u3002\n\n---\n\n\u53e6\u4e00\u79cd\u6c42\u89e3 $y_{b'}$ \u7684\u601d\u8def\uff08\u6765\u6e90\u4e8e [TheLostWeak \u7684\u535a\u5ba2](https://www.cnblogs.com/chenxiaoran666/p/Luogu3421.html)\uff09\uff1a$a', b'$ \u53ef\u4ee5\u6574\u7cfb\u6570\u7ebf\u6027\u7ec4\u5408\u51fa $a, b$\uff0c\u5426\u5219\u663e\u7136\u4e0d\u6ee1\u8db3\u6761\u4ef6\uff0c\u56e0\u4e3a $a, b\\in \\mathrm{span}(a,  b)$\u3002\n\n\u6839\u636e\u4e0a\u8ff0\u6027\u8d28\uff0c\u8003\u8651 $a'$\u3002\u7531\u4e8e $x_{a'} = \\gcd(x_a, x_b)$\uff0c\u6240\u4ee5\u4e3a\u4e86\u4f7f\u6a2a\u5750\u6807\u7b49\u4e8e $x_a$\uff0c\u9700\u8981\u4e3a $a'$ \u4e58\u4ee5 $\\dfrac{x_a}{\\gcd(x_a, x_b)}$ \u5373 $\\dfrac{x_a}{x_{a'}}$ \u7684\u7cfb\u6570\uff0c\u5f97\u5230 $\\left(x_a, \\dfrac{x_ay_{a'}}{x_{a'}}\\right)$\u3002\u7531\u4e8e\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5411\u91cf $b' = (0, y_{b'})$ \u5f97\u5230 $(x_a, y_a)$\uff0c\u56e0\u6b64 $y_{b'} \\left |\\ y_a - \\dfrac{x_ay_{a'}}{x_{a'}}\\right.$ \u3002\u540c\u7406\uff0c$y_{b'} \\left |\\ y_b - \\dfrac{x_by_{a'}}{x_{a'}}\\right.$\u3002\u6545\n$$\ny_{b'} = \\gcd\\left(\\dfrac{y_ax_{a'} - x_a y_{a'}}{x_{a'}}, \\dfrac{y_bx_{a'} - x_by_{a'}}{x_{a'}}\\right)\n$$\n\u6613\u8bc1\u82e5 $y_{b'}$ \u5c0f\u4e8e\u4e0a\u8ff0 $\\gcd$\uff0c\u5c06\u5bfc\u81f4\u5b58\u5728 $p\\in \\mathrm{span}(a', b')$\uff0c$p\\notin \\mathrm{span}(a, b)$\u3002\u82e5 $y_{b'}$ \u5927\u4e8e\u4e0a\u8ff0 $\\gcd$\uff0c$a', b'$ \u65e0\u6cd5\u6574\u7cfb\u6570\u7ebf\u6027\u7ec4\u5408\u51fa $a, b$ \u4e2d\u7684\u81f3\u5c11\u4e00\u4e2a\u3002\n\n\u8054\u7acb\u540e\u4e24\u79cd\u65b9\u6cd5\u63cf\u8ff0 $y_{b'}$ \u7684\u5f0f\u5b50\uff0c\u7a0d\u4f5c\u5316\u7b80\u540e\u5f97\u5230\u7b49\u5f0f $y_ax_b - x_ay_b = \\gcd(y_ax_{a'} - x_a y_{a'}, {y_bx_{a'} - x_by_{a'}})$\u3002\u8fd9\u4e5f\u8bb8\u8bf4\u660e\u4e86\u67d0\u4e9b\u6027\u8d28\uff0c\u4f46\u7b14\u8005\u5df2\u7ecf\u4e0d\u60f3\u7814\u7a76\u4e86 QAQ\uff0c\u611f\u5174\u8da3\u7684\u8bfb\u8005\u53ef\u81ea\u884c\u94bb\u7814\u3002\n\n\u4e0b\u65b9\u662f\u7ebf\u6027\u4ee3\u6570\u8f97\u8f6c\u76f8\u9664\u6cd5\u7684\u4ee3\u7801\uff0c\u975e\u5e38\u5bb9\u6613\u7406\u89e3\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst int N = 100 + 5;\nint n, a[N], b[N];\nint main() {\n\tcin >> n >> a[1] >> b[1];\n\tfor(int i = 2; i <= n; i++) {\n\t\tcin >> a[i] >> b[i];\n\t\twhile(a[i]) {\n\t\t\tif(abs(a[1]) < abs(a[i])) swap(a[1], a[i]), swap(b[1], b[i]);\n\t\t\telse b[1] -= b[i] * (a[1] / a[i]), a[1] %= a[i];\n\t\t} if(i > 2) b[2] = __gcd(b[2], b[i]), b[1] %= b[2];\n\t} cout << a[1] << \" \" << b[1] << endl << a[2] << \" \" << b[2] << endl;\n\treturn 0;\n}\n```",
        "postTime": 1643865707,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "P3421 [POI2005]SKO-Knights"
    },
    {
        "content": "\u76f4\u63a5\u770b\u516c\u5f0f\u8fc7\u4e8e\u62bd\u8c61\n\n**\u603b\u4f53\u601d\u8def**\uff1a\u6bcf\u6b21\u627e\u51fa\u4e24\u4e2a\u5411\u91cf\u5408\u5e76\u4e3a\u4e00\u4e2a\u7ad6\u76f4\u5411\u91cf\u548c\u53e6\u4e00\u4e2a\u5411\u91cf\uff0c\u5c06\u7ad6\u76f4\u5411\u91cf\u548c\u5df2\u6709\u7ad6\u76f4\u5411\u91cf\u5408\u5e76\u4e3a\u4e00\u4e2a\u7eb5\u5750\u6807\u4e3agcd\u7684\u7ad6\u76f4\u5411\u91cf\uff0c\u521d\u59cb\u7ad6\u76f4\u5411\u91cf\u4e0d\u5b58\u5728\n\n\u5982\u4e0b ~~\uff08\u7f51\u4e0a\u627e\u7684\uff09~~ \u56fe\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/51vk0yl4.png)\n\n\u6211\u4eec\u8981\u627e\u51fa\u4e24\u4e2a\u7eff\u8272\u5411\u91cf\u4f7f\u5f97\u8fd9\u4e24\u4e2a\u5411\u91cf\u4e0e\u5f53\u524d\u7684\u4e24\u4e2a\u5411\u91cf\u7b49\u4ef7\n\n\u8f6c\u6362\u601d\u8def\uff1a\u201c\u7b49\u4ef7\u201d\u5373\u6ee1\u8db3\uff1a\u6a2a\u5750\u6807\u4e0a\u7684\u6240\u6709\u4f4d\u7f6e\u90fd\u53ef\u4ee5\u5230\u8fbe\uff0c\u5e76\u4e14\u540c\u4e00\u7eb5\u5750\u6807\u4e0a\u7684\u4f4d\u7f6e\u90fd\u53ef\u4ee5\u5230\u8fbe\n\n\u8bf4\u660e\uff1a\u53e5\u4e2d\u201c\u4f4d\u7f6e\u201d\u6307\u5f53\u524d\u4e24\u4e2a\u539f\u5411\u91cf\u53ef\u4ee5\u5230\u8fbe\u7684\u70b9\n\n\u8bc1\u660e\uff1a\u5982\u679c\u53ef\u4ee5\u5230\u8fbe\u4e00\u4e2a\u6a2a\u5750\u6807\u4e0a\u7684\u4f4d\u7f6e\uff0c\u4e14\u53ef\u4ee5\u4ece\u8fd9\u4e2a\u6a2a\u5750\u6807\u7684\u4f4d\u7f6e\u5230\u8fbe\u6240\u6709\u540c\u4e00\u6a2a\u5750\u6807\u7684\u4f4d\u7f6e\u5219\u8bf4\u660e\u6240\u6709\u70b9\u90fd\u53ef\u4ee5\u5230\u8fbe\n\n\u53ef\u80fd\u8fd8\u662f\u4e0d\u5927\u6e05\u695a\uff0c\u5148\u770b\u600e\u6837\u627e\u8fd9\u4e24\u4e2a\u5411\u91cf\uff0c\u6ee1\u8db3\u4e0a\u9762\u76ee\u6807\n\n\u7ad6\u76f4\u5411\u91cf\u53ef\u4ee5\u8ba9\u6211\u4eec\u6ee1\u8db3\u7b2c\u4e8c\u6761\uff0c\u7ad6\u76f4\u5411\u91cf\u7684\u7eb5\u5750\u6807\u5c31\u4e3a\u540c\u4e00\u6a2a\u5750\u6807\u4e0a\u76f8\u90bb\u70b9\u7eb5\u5750\u6807\u7684\u5dee\uff0c\u5047\u8bbe\u4e24\u4e2a\u539f\u5411\u91cf\u4e3a**v1** = (a1,b1)\u548c**v2** = (a2,b2)\uff0c\u663e\u7136a2**v1** - a1**v2**\u5728y\u8f74\u4e0a\uff0c\u4e5f\u5c31\u662f\u4e0e**0**\u540c\u4e00\u6a2a\u5750\u6807\uff0c\u4f46\u8fd9\u4e2a\u70b9\u4e0d\u4e00\u5b9a\u4e0e\u539f\u70b9\u76f8\u90bb\uff0c\u663e\u7136a1\u548ca2\u4e92\u8d28\u65f6\uff0c\u5b83\u4eec\u624d\u76f8\u90bb\uff0c\u6240\u4ee5\u8fd9\u4e2a\u7eb5\u5750\u6807\u9664\u4ee5\u4e00\u4e2agcd(a1,a2)\u5373\u53ef\n\n\u4e8e\u662f\u7ad6\u76f4\u5411\u91cf$ = (0, abs(a1 \\times b2 - a2 \\times b1) / gcd(a1, a2))$\n\n\u5269\u4e0b\u4e00\u4e2a\u5411\u91cf\u663e\u7136\u5c06\u539f\u70b9\u5e26\u5230\u6bcf\u4e00\u4e2a\u6a2a\u5750\u6807\u5373\u53ef\uff0c\u6240\u4ee5\u5b83\u7684\u6a2a\u5750\u6807\u663e\u7136\u662fgcd(a1,a2)\uff0c\u7eb5\u5750\u6807\u5462\uff1f\u8fc7\u539f\u70b9\uff0c\u968f\u4fbf\u627e\u4e00\u4e2a\u4f4d\u7f6e\u5373\u53ef\u8fde\u51fa\u4e00\u6761\u76f4\u7ebf\uff0c\u5f97\u5230\u659c\u7387\uff0c\u5373\u53ef\u8ba1\u7b97\u51fa\u7eb5\u5750\u6807\n\n\u5373$a1 \\times x + a2 \\times y = gcd(a1,a2)$\uff0c\u5c06x\u548cy\u5e26\u5165\u6c42\u5f97\u7eb5\u5750\u6807\uff1a$b1 \\times x + b2 \\times y$\n\n#### Code\uff1a\n\n```cpp\nconst int N = 105;\n\nvoid exgcd(re int a, re int b, re int &x, re int &y)\n{\n\tif(!b) x = 1, y = 0;\n\telse exgcd(b, a%b, y, x), y -= a/b * x;\n}\n\nint n, a[N], b[N];\n\ninline void solve(re int x1, re int y1, re int &x2, re int &y2, re int &y)\n{\n\tif(! x1)\n\t\ty = y1;\n\tif(! x2)\n\t\ty = y2, x2 = x1, y2 = y1;\n\telse\n\t{\n\t\tint d = __gcd(x1, x2);\n\t\ty = abs(x2 * y1 - x1 * y2) / d;\n\t\tint xx, yy, aa = x1 / d, bb = x2 / d;\n\t\texgcd(aa, bb, xx, yy);\n\t\ty2 = y1 * xx + y2 * yy;\n\t\tx2 = d;\n\t}\n}\n\nsigned main()\n{\n\tn = read();\n\tfor(re int i = 1;i <= n; ++i) a[i] = read(), b[i] = read();\n\tre int x = a[2], y = b[2], y1, y2;\n\tsolve(a[1], b[1], x, y, y2);\n\tfor(re int i = 3;i <= n; ++i)\n\t{\n\t\ty1 = y2;\n\t\tsolve(a[i], b[i], x, y, y2);\n\t\ty2 = __gcd(y1, y2);\n\t}\n\n\tprint(x), putchar(' '), print(y), putchar('\\n'), print(0), putchar(' '), print(y2);\n\n\treturn 0;\n}\n```",
        "postTime": 1602743939,
        "uid": 286239,
        "name": "ql12345",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3421 \u3010[POI2005]SKO-Knights\u3011"
    },
    {
        "content": "\u56e0\u4e3aLATEX\u6302\u4e86\uff0c\u6240\u4ee5\u91cd\u65b0\u4ea4\u4e00\u904d\n\n### \u5206\u6790\n\n![](https://images2018.cnblogs.com/blog/1254625/201808/1254625-20180807130015589-1123985450.png)\n\n\u6211\u4eec\u8bbe\u539f\u5411\u91cf\u4e3a$(a_1, b_1)$,$(a_2, b_2)$\u3002\n\u8bbe\u65b0\u5411\u91cf\u4e3a$(a_3, b_3)$\uff0c$(0, a_4)$\n\n$\\therefore$ $a_3=gcd(a_1,a_2)$\n\n$\\therefore$ $a_1x + a_2y = a_3$\n\n$\\therefore$ $a_1x + a_2y = gcd(a_1,a_2)$   $b_1x + b_2y = b_3$\n\n$\\begin{cases}a_1x + a_2y = 0\\\\b_1x + b_2y = b_4\\end{cases}$ \n \n$\\therefore$ $-y = \\dfrac{a_1x}{a_2}$\n\n$\\because$ $-y$\u662f\u6574\u6570\n\n$\\therefore$ $a_2|a_1x$\n\n\u5373$\\dfrac{a_2}{gcd(a_1,a_2)}|\\dfrac{a_1}{gcd(a_1,a_2)x}$\n\n\u53c8$\\therefore$ $\\dfrac{a_2}{gcd(a_1,a_2)}|\\dfrac{a_1}{gcd(a_1,a_2)x}$\u4e92\u8d28\n\n$\\therefore$$\\dfrac{a_2}{gcd(a_1,a_2)}|x$\n\n\u8bbe$x=\\dfrac{a_2}{gcd(a_1,a_2)}$\n\n$\\therefore$ $-\\dfrac{a_1}{gcd(a_1,a_2)}$\n\n$\\therefore$ $b_4 = \\dfrac{|b_1a_2-b_2a_1|}{gcd(a_1,a_2)}$\n\n\u6211\u4eec\u53ea\u9700\u8981\u4e0d\u65ad\u7684\u5c06\u5411\u91cf\u8f6c\u53d8\u5230y\u8f74\u4e0a\u4f7f\u5f97\u6700\u7ec8\u81f3\u591a\u4e00\u4e2a\u5411\u91cf\u4e0d\u518dy\u8f74\u4e0a\u5c31\u884c\u4e86\u3002\n\n\u4ee3\u7801:\n\n```cpp\n#include <cstdio>\nint a[510], b[510];\ntemplate<class type>type _gcd(type __, type ___) {\n\treturn (!___) ? __ : _gcd(___, __ % ___);\n}\ntemplate<class type>type _abs(type __) {\n\treturn __ < 0 ? -__ : __;\n}\ninline void exgcd(int a, int b, int &x, int &y) {\n\tif (b == 0) {\n\t\tx = 1;\n\t\ty = 0;\n\t\treturn;\n\t}\n\texgcd(b, a%b, x, y);\n\tint z = x;\n\tx = y;\n\ty = z - (a / b)*y;\n}\nint main() {\n\tint n, m, x, y;\n\tscanf(\"%d\", &n);\n\tfor (int i = 1; i <= n; i++)\n\t\tscanf(\"%d%d\", &a[i], &b[i]);\n\tint a1, b1, a2, b2;\n\tif (!a[1]) { a1 = a[2]; b1 = b[2]; b2 = b[1]; }\n\telse if (!a[2]) { a1 = a[1]; b1 = b[1]; b2 = b[2]; }\n\telse { a1 = _gcd(a[1], a[2]); exgcd(a[1] / a1, a[2] / a1, x, y); b1 = b[1] * x + b[2] * y; b2 = _abs(b[1] * a[2] - b[2] * a[1]) / a1; }\n\tfor (int i = 3; i <= n; i++) {\n\t\tif (!a1) { a1 = a[i]; b2 = _gcd(b2, b1); b1 = b[i]; }\n\t\telse if (!a[i])b2 = _gcd(b2, b[i]);\n\t\telse { int be = a1, be2 = b1; a1 = _gcd(a1, a[i]); exgcd(be / a1, a[i] / a1, x, y); b1 = b1 * x + b[i] * y; b2 = _gcd(b2, _abs(be2*a[i] - b[i] * be) / a1); }\n\t}\n\tprintf(\"%d %d\\n\", a1, b1);\n\tputchar('0'), putchar(' ');\n\tprintf(\"%d\\n\", b2);\n\treturn 0;\n}\n```\n\n\u7801\u98ce\u8f83\u4e11\uff0c\u89c1\u8c05",
        "postTime": 1552311175,
        "uid": 118317,
        "name": "nofall",
        "ccfLevel": 0,
        "title": "P3421 \u9898\u89e3"
    }
]
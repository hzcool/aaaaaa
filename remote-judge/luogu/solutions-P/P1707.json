[
    {
        "content": "[P1707 \u5237\u9898\u6bd4\u8d5b](https://www.luogu.com.cn/problem/P1707)\n\n[\u66f4\u574f\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.luogu.com.cn/blog/Sham-Devour/solution-p1707)\n\n[\u524d\u7f6e\u829d\u58eb\uff1a\u77e9\u9635](https://oi-wiki.org/math/matrix/)\n\n# $\\texttt{Description}$\n\n\u7ed9\u5b9a $3$ \u4e2a\u5e8f\u5217 $a,b,c$\uff1a\n\n$$\na_1=b_1=c_1=1\n$$\n\n$$\na_2=b_2=c_2=3\n$$\n\n\u8ba1\u7b97\u65b9\u5f0f\uff1a\n\n$$\na_{k+2}=pa_{k+1}+qa_k+b_{k+1}+c_{k+1}+rk^2+tk+1\n$$\n\n$$\nb_{k+2}=ub_{k+1}+vb_k+a_{k+1}+c_{k+1}+w^k\n$$\n\n$$\nc_{k+2}=xc_{k+1}+yc_k+a_{k+1}+b_{k+1}+z^k+k+2\n$$\n\n\u5176\u4e2d $p,q,r,t,u,v,w,x,y,z$ \u90fd\u4e3a\u7ed9\u5b9a\u5e38\u6570\u3002\n\n\u6c42 $a_n,b_n,c_n$\uff0c\u7b54\u6848\u5bf9 $m$ \u53d6\u6a21\u3002\n\n---\n\n**\u6570\u636e\u8303\u56f4\uff1a**\n\n$4\\le n\\le10^{16}$\n\n$2\\le m\\le10^{16}$\n\n$1\\le p,q,r,t,u,v,w,x,y,z\\le100$\n\n# $\\texttt{Solution}$\n\n~~\u56e0\u4e3a\u66b4\u529b\u4eba\u4eba\u90fd\u4f1a\uff0c\u6240\u4ee5\u76f4\u63a5\u4e0a\u6b63\u89e3\u3002~~\n\n\u6bcf\u6b21\u8f6c\u79fb\u7684\u9879\u6570\u90fd\u5f88\u5c11\uff0c\u800c $n$ \u5f88\u5927\uff0c\u6240\u4ee5\u81ea\u7136\u800c\u7136\u5730\u60f3\u5230\u4e86\u77e9\u9635\u52a0\u901f\u3002\n\n\u4e0d\u96be\u60f3\u5230 $1\\times11$ \u7684\u72b6\u6001\u77e9\u9635\u521d\u59cb\u5e94\u8be5\u957f\u8fd9\u6837\u5b50\uff1a\n\n$$\n\\begin{bmatrix}\na_{k+1}&b_{k+1}&c_{k+1}&a_k&b_k&c_k&k^2&k&1&w^k&z^k\n\\end{bmatrix}\n$$\n\n\u4e8e\u662f $11\\times11$ \u7684\u8f6c\u79fb\u77e9\u9635\u968f\u4fbf\u753b\u4e00\u4e0b\u5c31\u51fa\u6765\u4e86\uff1a\n\n$$\n\\begin{bmatrix}\np&1&1&1&0&0&0&0&0&0&0\\\\\n1&u&1&0&1&0&0&0&0&0&0\\\\\n1&1&x&0&0&1&0&0&0&0&0\\\\\nq&0&0&0&0&0&0&0&0&0&0\\\\\n0&v&0&0&0&0&0&0&0&0&0\\\\\n0&0&y&0&0&0&0&0&0&0&0\\\\\nr&0&0&0&0&0&1&0&0&0&0\\\\\nt&0&1&0&0&0&2&1&0&0&0\\\\\n1&0&2&0&0&0&1&1&1&0&0\\\\\n0&1&0&0&0&0&0&0&0&w&0\\\\\n0&0&1&0&0&0&0&0&0&0&z\n\\end{bmatrix}\n$$\n\n\u63a5\u4e0b\u6765\u77e9\u9635\u5feb\u901f\u5e42\u5373\u53ef\u3002\n\n---\n\n\u6ce8\u610f\u56e0\u4e3a\u6a21\u6570\u592a\u5927\uff0c\u6240\u4ee5\u8981\u7528\u9f9f\u901f\u4e58\u3002\n\n---\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(\\log n\\log m)$\uff0c\u6709\u4e2a $11^3$ \u7684 ~~\u5e38\u6570~~\u3002\n\n# $\\texttt{Code}$\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n\nusing namespace std;\n\ntypedef long long ll;\n\nll m, p, q, r, t, u, v, w, x, y, z;\n\nstruct Matrix {\n\tint n, m;\n\tll a[15][15];\n\t\n\tinline Matrix () {\n\t\tmemset(a, 0, sizeof(a));\n\t}\n} base, ans;\n\ninline ll quickMul (ll a, ll b) {\n\tll res = 0;\n\ta %= m;\n\tb %= m;\n\twhile (b) {\n\t\tif (b & 1)\n\t\t\tres = (res + a) % m;\n\t\tb >>= 1;\n\t\ta = (a + a) % m;\n\t}\n\treturn res;\n}\n\ninline Matrix operator * (Matrix a, Matrix b) {\n\tMatrix res;\n\tres.n = a.n;\n\tres.m = b.m;\n\tfor (int i = 1; i <= a.n; i++)\n\t\tfor (int j = 1; j <= b.m; j++)\n\t\t\tfor (int k = 1; k <= a.m; k++)\n\t\t\t\tres.a[i][j] = (res.a[i][j] + quickMul(a.a[i][k], b.a[k][j])) % m;\n\treturn res;\n}\n\ninline Matrix quickPow (Matrix a, ll k) {\n\tMatrix res;\n\tres.n = res.m = a.n;\n\tfor (int i = 1; i <= a.n; i++)\n\t\tres.a[i][i] = 1;\n\twhile (k) {\n\t\tif (k & 1)\n\t\t\tres = res * a;\n\t\tk >>= 1;\n\t\ta = a * a;\n\t}\n\treturn res;\n}\n\ninline void init_base () {\n\tbase.n = base.m = 11;\n\tbase.a[1][2] = base.a[1][3] = base.a[1][4] = base.a[2][1] = base.a[2][3] = base.a[2][5] = base.a[3][1] = base.a[3][2] = base.a[3][6] = base.a[7][7] = base.a[8][3] = base.a[8][8] = base.a[9][1] = base.a[9][7] = base.a[9][8] = base.a[9][9] = base.a[10][2] = base.a[11][3] = 1;\n\tbase.a[8][7] = base.a[9][3] = 2;\n\tbase.a[1][1] = p;\n\tbase.a[2][2] = u;\n\tbase.a[3][3] = x;\n\tbase.a[4][1] = q;\n\tbase.a[5][2] = v;\n\tbase.a[6][3] = y;\n\tbase.a[7][1] = r;\n\tbase.a[8][1] = t;\n\tbase.a[10][10] = w;\n\tbase.a[11][11] = z;\n}\n\ninline void init_ans () {\n\tans.n = 1;\n\tans.m = 11;\n\tans.a[1][1] = ans.a[1][2] = ans.a[1][3] = 3;\n\tans.a[1][4] = ans.a[1][5] = ans.a[1][6] = ans.a[1][7] = ans.a[1][8] = ans.a[1][9] = 1;\n\tans.a[1][10] = w;\n\tans.a[1][11] = z;\n}\n\nint main () {\n\tll n;\n\tscanf(\"%lld %lld %lld %lld %lld %lld %lld %lld %lld %lld %lld %lld\", &n, &m, &p, &q, &r, &t, &u, &v, &w, &x, &y, &z);\n\tif (n < 2) {\n\t\tputs(\"nodgd 1\");\n\t\tputs(\"Ciocio 1\");\n\t\tputs(\"Nicole 1\");\n\t\treturn 0;\n\t}\n\tinit_base();\n\tinit_ans();\n\tans = ans * quickPow(base, n - 2);\n\tprintf(\"nodgd %lld\\nCiocio %lld\\nNicole %lld\", ans.a[1][1], ans.a[1][2], ans.a[1][3]);\n\treturn 0;\n}\n```",
        "postTime": 1615908825,
        "uid": 365542,
        "name": "SDqwq",
        "ccfLevel": 7,
        "title": "P1707 \u5237\u9898\u6bd4\u8d5b"
    },
    {
        "content": "\u9898\u76ee\u5df2\u7ecf\u8bf4\u4e86\u662f\u77e9\u9635\u4e58\u6cd5\uff0c\u8fd9\u91cc\u53ea\u987b\u628a\u600e\u4e48\u4e58\u8bf4\u4e00\u4e0b\u5c31\u884c\u4e86\u3002\n\n\u9012\u63a8\u5f0f\u5b50\u9898\u76ee\u5df2\u7ecf\u7ed9\u51fa\uff0c\u90fd\u662f\u4e8c\u9636\u7ebf\u6027\u9012\u63a8\uff0c\u6211\u4e2a\u4eba\u8ba4\u4e3a\u96be\u70b9\u5728\u4e8e\u5269\u4e0b\u7684\u4e00\u5806\u6307\u6570\u9879\u3001\u5e73\u65b9\u9879\u4e4b\u7c7b\u7684\u3002\n\n\u7531\u4e8e\u77e9\u9635\u4e58\u6cd5\u662f\u7528\u6765\u641e\u7ebf\u6027\u9012\u63a8\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u628a\u6307\u6570\u9879\u3001\u5e73\u65b9\u9879\u4e4b\u7c7b\u7684\u90fd\u5316\u6210\u7ebf\u6027\u9012\u63a8\u3002\n\n\u5bf9\u4e8e\u4e00\u6b21\u9879\uff1a(k+1) = k + 1;\n\n\u5bf9\u4e8e\u5e73\u65b9\u9879\uff1a(k+1)^2 = k^2 + 2\\*k + 1;\n\n\u5bf9\u4e8e\u6307\u6570\u9879\uff1aw^(k+1) = w\\*w^k;\n\n\u6240\u4ee5\u6211\u4eec\u9700\u8981\u540c\u65f6\u7ef4\u62a4a[k+1],a[k],b[k+1],b[k],c[k+1],c[k],w^k,z^k,k^2,k,1\u8fd911\u4e2a\u9879\u7684\u9012\u63a8\u3002\n\n\u53ea\u9700\u8981\u751f\u6210\u5982\u4e0b\u7684\u77e9\u9635\uff0c\u5c31\u53ef\u4ee5\u5f00\u59cb\u9012\u63a8\u4e86\uff1a\n\n\u72b6\u6001\u77e9\u9635F[k]==\n\n\u3010 a[k] a[k+1] b[k] b[k+1] c[k]  c[k+1]  k^2    k    w^k   z^k    1 \u3011\n\n\u8f6c\u79fb\u77e9\u9635A==\n\n\u3010    0     q     0     0     0     0     0     0     0     0     0 \u3011\n\n\u3010    1     p     0     1     0     1     0     0     0     0     0 \u3011\n\n\u3010    0     0     0     u     0     0     0     0     0     0     0 \u3011\n\n\u3010    0     1     1     v     0     1     0     0     0     0     0 \u3011\n\n\u3010    0     0     0     0     0     x     0     0     0     0     0 \u3011\n\n\u3010    0     1     0     1     1     y     0     0     0     0     0 \u3011\n\n\u3010    0     r     0     0     0     0     1     0     0     0     0 \u3011\n\n\u3010    0     t     0     0     0     1     2     1     0     0     0 \u3011\n\n\u3010    0     0     0     1     0     0     0     0     w     0     0 \u3011\n\n\u3010    0     0     0     0     0     1     0     0     0     z     0 \u3011\n\n\u3010    0     1     0     0     0     2     1     1     0     0     1 \u3011\n\n\u7136\u540e\u7531F[k]\\*A==F[k+1]\u6765\u5feb\u901f\u5e42\u3002\n\n\n\u53e6\u5916\u4e00\u4e2a\u65b9\u9762\uff0c\u7531\u4e8e\u7528\u6765mod\u7684K\u6bd4\u8f83\u5927\uff0c\u76f4\u63a5\u4e58\u53ef\u80fd\u4f1a\u8d85\u8fc764\u4f4d\u957f\u6574\u578b\u7684\u6570\u636e\u8303\u56f4\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u52a0\u6cd5\u4ee3\u66ff\u4e58\u6cd5\uff0c\u4e5f\u5c31\u662f\u4e8c\u5206\u5feb\u901f\u5e42\u7684\u4ee3\u7801\u628a\u4e58\u53f7\u6539\u6210\u52a0\u53f7\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u6dfb\u4e0a\u4e00\u4e2aO(logK)\u3002\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(11^3\\*logN\\*logK)\uff0c\u7a33\u7a33\u5730AC\u3002\n\n\n\u9644\u4ee3\u7801\u3002\uff08\u77e9\u9635\u4e58\u6cd5\u6211\u4e0d\u559c\u6b22\u5199\u51fd\u6570\uff0c\u5199\u4e86\u82e5\u5e72\u4e2afor\u5faa\u73af\u3002\u3002\u3002\u3002\uff09\n\n```cpp\n\n#include <cstdio> \n#include <cstdlib>\nusing namespace std;\nunsigned long long N,K,a[13][13],c[13][13],t[13][13],f[13];\nint m=11;\nunsigned long long _mul(unsigned long long aa,unsigned long long bb)\n{\n    unsigned long long cc=0;\n    if(aa==0||bb==0)return 0;\n    while(bb>1)\n    {\n        if(bb%2==1)cc=(cc+aa)%K;\n        aa=(aa+aa)%K;\n        bb=bb/2;\n    }\n    bb=(aa+cc)%K;\n    return bb;\n}\nvoid _Mqsm()\n{\n    int i,j,k;\n    unsigned long long b;\n    b=N-1;\n    while(b>1)\n    {\n        if(b%2==1)\n        {\n            for(i=1;i<=m;i++)\n                for(j=1;j<=m;j++)\n                {\n                    t[i][j]=0;\n                    for(k=1;k<=m;k++)\n                        t[i][j]=(t[i][j]+_mul(a[i][k],c[k][j]))%K;\n                }\n            for(i=1;i<=m;i++)\n                for(j=1;j<=m;j++)\n                    c[i][j]=t[i][j];\n        }\n        for(i=1;i<=m;i++)\n            for(j=1;j<=m;j++)\n            {\n                t[i][j]=0;\n                for(k=1;k<=m;k++)\n                    t[i][j]=(t[i][j]+_mul(a[i][k],a[k][j]))%K;\n            }\n        for(i=1;i<=m;i++)\n            for(j=1;j<=m;j++)\n                a[i][j]=t[i][j];\n        b=b/2;\n    }\n    for(i=1;i<=m;i++)\n        for(j=1;j<=m;j++)\n        {\n            t[i][j]=0;\n            for(k=1;k<=m;k++)\n                t[i][j]=(t[i][j]+_mul(a[i][k],c[k][j]))%K;\n        }\n    for(i=1;i<=m;i++)\n        for(j=1;j<=m;j++)\n            a[i][j]=t[i][j];\n    for(i=1;i<=1;i++)\n        for(j=1;j<=m;j++)\n        {\n            t[i][j]=0;\n            for(k=1;k<=m;k++)\n                t[i][j]=(t[i][j]+_mul(f[k],a[k][j]))%K;\n        }\n    printf(\"nodgd %I64dn\",t[1][1]);\n    printf(\"Ciocio %I64dn\",t[1][3]);\n    printf(\"Nicole %I64dn\",t[1][5]);\n}\nint main()\n{\n    int i,p,q,r,t,u,v,w,x,y,z;\n    m=11;\n    scanf(\"%I64d%I64d\",&N,&K);\n    scanf(\"%d%d%d%d\",&p,&q,&r,&t);\n    a[2][2]=p;a[1][2]=q;a[7][2]=r;a[8][2]=t;\n    scanf(\"%d%d%d\",&u,&v,&w);\n    a[4][4]=u;a[3][4]=v;a[9][9]=w;\n    scanf(\"%d%d%d\",&x,&y,&z);\n    a[6][6]=x;a[5][6]=y;a[10][10]=z;\n    a[2][1]=a[2][4]=a[2][6]=1;\n    a[4][2]=a[4][3]=a[4][6]=1;\n    a[6][2]=a[6][4]=a[6][5]=1;\n    a[7][7]=1;\n    a[8][6]=a[8][8]=1;\n    a[9][4]=1;\n    a[10][6]=1;\n    a[11][2]=a[11][7]=a[11][8]=a[11][11]=1;\n    a[8][7]=a[11][6]=2;\n    for(i=1;i<=m;i++)c[i][i]=1;\n    f[1]=f[3]=f[5]=f[7]=f[8]=f[11]=1;\n    f[2]=f[4]=f[6]=3;\n    f[9]=w;f[10]=z;\n    _Mqsm();\n    return 0;\n}\n\n\n```",
        "postTime": 1380600405,
        "uid": 552,
        "name": "nodgd",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1707 \u3010\u5237\u9898\u6bd4\u8d5b\u3011"
    },
    {
        "content": "\u8fd9\u9898\u600e\u4e48\u8bf4\u5462\n\n\u633a\u6bd2\u7624\u7684\u4e00\u4e2a\u77e9\u4e58\n\n\u7279\u70b9\u5728\u4e8e\u4e0d\u662f\u9f50\u6b21\u7684qwq\n\n\u6211\u8bb0\u5f97\u6211\u7b2c\u4e00\u6b21\u95ee\u6211loser\u5b66\u957ff[i]=f[i-1]+x*x\u600e\u4e48\u77e9\u9635\u52a0\u901f\u7684\u65f6\u5019\u5b66\u957f\u8bf4\u4e0d\u80fd\u52a0\u901fqwq\n\n\u4f46\u4e8b\u5b9e\u4e0a\u6211\u4eec\u53ef\u4ee5\u628ax*x\u8fd9\u6837\u7684\u4e1c\u897f\u53d8\u6210\u9012\u63a8\n\n\u6bd4\u5982w^(k+1)=w*w^k\n\n(k+1)^2=k^2+2k+1\n\n\u5982\u679c\u4f60\u628a\u8fd9\u4e2a\u4e0ek\u6709\u5173\u7684\u5f0f\u5b50\u8bb0\u4e3af[k]\u7684\u8bdd\uff0c\u5b83\u53ef\u4ee5\u5199\u6210\u4e00\u4e2a\u9012\u63a8\u5f0f\n\n\u4ee5f[k]=k*k\u4e3a\u4f8b\n\nf[k+1]=f[k]+2*k+1\n\n\u4e8e\u662f\u8981\u518d\u8bb0g[k]=k\n\ng[k+1]=g[k]+1\n\n\u7136\u540e\u518d\u8bb0h[k]=1\n\n\u8fd9\u6837\u6240\u6709\u9879\u90fd\u5316\u6210\u4e86\u9012\u63a8\u7684\u5f62\u5f0f\n\n\u4e8e\u662f\u53ef\u4ee5\u77e9\u9635\u52a0\u901f\n\n\u5177\u4f53\u5982\u4f55\u52a0\u901f\u697c\u4e0b\u4e24\u4e2adalao\u8bf4\u7684\u5f88\u660e\u767d\u4e86\n\n\u6211\u53ea\u5728\u4ee3\u7801\u91cc\u52a0\u4e00\u4e9b\u7ec6\u5c0f\u7684\u4f18\u5316\n\n\u5177\u4f53\u89c1\u6ce8\u91ca\n\n```cpp\n// luogu-judger-enable-o2\n//\u5176\u5b9eO2\u6ca1\u4ec0\u4e48\u7528...\u672c\u6765\u5c31\u662f0ms\uff0c\u8fd8\u6ca1\u52a0inline register\u5565\u7684\n#include<cstdio>//\u5c11\u5f00\u5e93\u51cf\u5c11\u7a7a\u95f4\uff0c\u6211\u5c31\u662f\u8fd9\u4e48rk1\u7684\nconst long long md=1LL<<60;//\u51cf\u5c11\u53d6\u6a21\u6b21\u6570\u7528\u7684\u5e38\u91cf\uff0c\u5927\u4e8emd\u7684\u65f6\u5019\u53d6\u6a21\uff0c\u56e0\u4e3a%\u6bd4\u8f83\u6162\nlong long n,m;\nint p,q,r,t,u,v,w,x,y,z,st[11]={3,1,3,1,3,1,0,0,1,1,1};;\nstruct hh{long long a[11][11];};\nlong long mul(long long kx,long long ky,long long m) {return (kx*ky-(long long)((long double)kx/m*ky)*m+m)%m;}//\u770b\u4e86rk1\u7684\u4ee3\u7801\u660e\u767d\u7684 \u8fd9**\u6bd4\u6162\u901f\u4e58\u5feb\u591a\u4e86 \u51fa\u9898\u4eba\u7ed9\u7684\u6b63\u89e3\u662f\u6162\u901f\u4e58 \u4f46\u4e3a\u4e86\u4fdd\u9669\u6570\u5f88\u5927\u8fd8\u662f\u8981\u7528\u6162\u901f\u4e58\n/*long long mul(long long a,long long b,long long m)//\u6ca1\u7528\u4e86\u7684\u6162\u901f\u4e58qaq\n{\n    long long ans=0;\n    while(b)\n    {\n        if(b&1)\n        {\n            ans=ans+a;\n            if(ans>md)ans%=m;\n        }\n        a=a+a;\n        if(a>md)a%=m;\n        b>>=1;\n    }\n    return ans;\n}*/\nhh operator * (hh a,hh b)//\u77e9\u9635\u4e58\u6cd5\n{\n    hh c={0};\n    for(int i=0;i<11;i++)\n        for(int k=0;k<11;k++)\n            if(a.a[i][k])//\u6ce8\u610f\uff0c\u8fd9\u91cc\u628ak\u548cj\u8c03\u6362\u8fc7\u6765\uff0c\u9632\u6b62\u7a00\u758f\u77e9\u9635\u9020\u6210\u7684\u65e0\u7528\u64cd\u4f5c\uff0c\u56e0\u4e3a\u5982\u679ca[i][k]\u4e3a0\u7684\u8bddj\u5faa\u73af\u6ca1\u6709\u610f\u4e49\n                for(int j=0;j<11;j++)\n                {\n                    c.a[i][j]+=mul(a.a[i][k],b.a[k][j],m);\n                    if(c.a[i][j]>md)c.a[i][j]%=m;\n                }\n    return c;\n}\nhh qpower(hh a,long long b,long long m)//\u666e\u901a\u5feb\u901f\u5e42\n{\n    hh ans={0};//\u4e3b\u5bf9\u89d2\u7ebf(\u5de6\u4e0a-\u53f3\u4e0b)\u4e3a1\u5176\u5b83\u4e3a0\u7684\u77e9\u9635\u662f\u5355\u4f4d\u77e9\u9635\uff0c\u4e00\u4e2a\u77e9\u9635\u4e58\u5355\u4f4d\u77e9\u9635\u540e\u4e0d\u53d1\u751f\u53d8\u5316\n    for(int i=0;i<11;i++)ans.a[i][i]=1;\n    while(b)\n    {\n        if(b&1)ans=ans*a;\n        a=a*a;\n        b>>=1;\n    }\n    return ans;\n}\nint main()\n{\n    scanf(\"%lld%lld%d%d%d%d%d%d%d%d%d%d\",&n,&m,&p,&q,&r,&t,&u,&v,&w,&x,&y,&z);\n    st[6]=w,st[7]=z;//st\u662f\u9012\u63a8\u4e2d\u6bcf\u4e00\u9879f[1]\u7684\u503c\n    hh f={p\t,q\t,1\t,0\t,1\t,0\t,0\t,0\t,r\t,t  ,1\n         ,1\t,0\t,0\t,0\t,0\t,0\t,0\t,0\t,0\t,0  ,0\n         ,1\t,0\t,u\t,v\t,1\t,0\t,1\t,0\t,0\t,0  ,0\n         ,0\t,0\t,1\t,0\t,0\t,0\t,0\t,0\t,0\t,0  ,0\n         ,1\t,0\t,1\t,0\t,x\t,y\t,0\t,1\t,0\t,1  ,2\n         ,0\t,0\t,0\t,0\t,1\t,0\t,0\t,0\t,0\t,0  ,0\n         ,0\t,0\t,0\t,0\t,0\t,0\t,w\t,0\t,0\t,0  ,0\n         ,0\t,0\t,0\t,0\t,0\t,0\t,0\t,z\t,0\t,0  ,0\n         ,0\t,0\t,0\t,0\t,0\t,0\t,0\t,0\t,1\t,2  ,1\n         ,0\t,0\t,0\t,0\t,0\t,0\t,0\t,0\t,0\t,1  ,1\n         ,0\t,0\t,0\t,0\t,0\t,0\t,0\t,0\t,0\t,0  ,1};//\u6784\u9020\u8f6c\u79fb\u77e9\u9635\n    f=qpower(f,n-2,m);\n    long long a1=0,a2=0,a3=0;//\u628a\u521d\u503c\u7b97\u4e0a\n    for(int i=0;i<11;i++)a1=(a1+mul(f.a[0][i],st[i],m))%m,a2=(a2+mul(f.a[2][i],st[i],m))%m,a3=(a3+mul(f.a[4][i],st[i],m))%m;\n    printf(\"nodgd %lld\\nCiocio %lld\\nNicole %lld\",a1,a2,a3);\n}\n```\n\u4e3b\u8981\u5c31\u662f\u544a\u8bc9\u4f60\u600e\u4e48\u641e\u5e38\u7cfb\u6570\u7ebf\u6027\u975e\u9f50\u6b21\u9012\u63a8\u5173\u7cfb\uff0c\u7136\u540e\u8fd9\u4e1c\u897f\u4e0d\u600e\u4e48\u597d\u8c03\uff0c\u81ea\u5df1\u6ce8\u610f\n\n\u8f6c\u79fb\u77e9\u9635\u7684\u6784\u9020\u6beb\u65e0\u96be\u5ea6",
        "postTime": 1519648649,
        "uid": 22136,
        "name": "qwaszx",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P1707 \u3010\u5237\u9898\u6bd4\u8d5b\u3011"
    },
    {
        "content": "## [Link](https://www.luogu.com.cn/problem/P1707)\n\n\u4e00\u773c\u53ef\u77e5\u53ef\u4ee5 $\\mathcal{O}(n)$ \u9012\u63a8\uff0c\u4f46\u7531\u4e8e $n$ \u5f88\u5927\uff0c\u6240\u4ee5\u8003\u8651\u4f18\u5316\u3002\n\n\u5b66\u8fc7\u77e9\u9635\u5feb\u901f\u5e42\u90fd\u5bb9\u6613\u53d1\u73b0\u53ef\u4ee5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u8fdb\u884c\u4f18\u5316\u3002\u90a3\u5c31\u9700\u8981\u6784\u9020\u77e9\u9635\uff0c\u4f7f\u5f97\u53ef\u4ee5\u4ece\u7b2c $k$ \u5929\u8f6c\u79fb\u5230\u7b2c $k+1$ \u5929\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\u53ea\u7ef4\u62a4 $a_{k+1}$\uff0c$b_{k+1}$\uff0c$c_{k+1}$ \u662f\u4e0d\u80fd\u63a8\u51fa $a_{k+2}$\uff0c$b_{k+2}$\uff0c$c_{k+2}$ \u7684\u3002\u7ecf\u8fc7\u89c2\u5bdf\uff0c\u6211\u4eec\u4e00\u5171\u8981\u7ef4\u62a4\u4ee5\u4e0b $11$ \u4e2a\u503c\uff1a\n\n$$\\begin{bmatrix}\na_{k+1}\\\\\nb_{k+1}\\\\\nc_{k+1}\\\\\na_k\\\\\nb_k\\\\\nc_k\\\\\nk^2\\\\\nk\\\\\n1\\\\\nw^k\\\\\nz^k\\\\\n\\end{bmatrix}$$\n\n\u90a3\u4e48\u5bb9\u6613\u6784\u9020\u77e9\u9635\uff0c\u4f7f\u5f97\u4ece $k+1$ \u5929\u8f6c\u79fb\u5230 $k+2$ \u5929\uff0c\u8f6c\u79fb\u5982\u4e0b\uff1a\n\n$$\\begin{bmatrix}\np&1&1&q&0&0&r&t&1&0&0\\\\\n1&u&1&0&v&0&0&0&0&1&0\\\\\n1&1&x&0&0&y&0&1&2&0&1\\\\\n1&0&0&0&0&0&0&0&0&0&0\\\\\n0&1&0&0&0&0&0&0&0&0&0\\\\\n0&0&1&0&0&0&0&0&0&0&0\\\\\n0&0&0&0&0&0&1&2&1&0&0\\\\\n0&0&0&0&0&0&0&1&1&0&0\\\\\n0&0&0&0&0&0&0&0&1&0&0\\\\\n0&0&0&0&0&0&0&0&0&w&0\\\\\n0&0&0&0&0&0&0&0&0&0&z\\\\\n\\end{bmatrix}\n\\times\n\\begin{bmatrix}\na_{k+1}\\\\\nb_{k+1}\\\\\nc_{k+1}\\\\\na_k\\\\\nb_k\\\\\nc_k\\\\\nk^2\\\\\nk\\\\\n1\\\\\nw^k\\\\\nz^k\\\\\n\\end{bmatrix}=\n\\begin{bmatrix}\na_{k+2}\\\\\nb_{k+2}\\\\\nc_{k+2}\\\\\na_{k+1}\\\\\nb_{k+1}\\\\\nc_{k+1}\\\\\n(k+1)^2\\\\\nk+1\\\\\n1\\\\\nw^{k+1}\\\\\nz^{k+1}\\\\\n\\end{bmatrix}\n$$\n\n\u53ea\u8981\u6c42\u51fa\u7b2c\u4e00\u4e2a\u77e9\u9635\u7684 $n-2$ \u6b21\u65b9\u518d\u4e58\u4e0a $k=1$ \u65f6\u7684\u7b2c\u4e8c\u4e2a\u77e9\u9635\uff0c\u5c31\u53ef\u4ee5\u5f97\u51fa\u7b54\u6848\u3002\n\n\u6ce8\u610f\u6570\u636e\uff0c\u53d1\u73b0\u76f8\u4e58\u65f6\u5927\u6982\u7387\u4f1a\u7206 ```long long```\u3002\u4f46\u662f\u521d\u59cb\u662f\u4e0d\u4f1a\u7684\uff0c\u6240\u4ee5\u663e\u7136\u53ef\u4ee5\u7528\u9f9f\u901f\u5e42\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(11^3\\log m\\log A)$\uff0c$A$ \u4e3a\u6c42\u5feb\u901f\u5e42\u65f6\u7684\u5e95\u6570\u3002\n\n\u4f46\u7531\u4e8e\u73b0\u5728 CSP \u548c NOIP \u7b49\u6bd4\u8d5b\u53ef\u4ee5\u7528 ```__int128```\uff0c\u6240\u4ee5\u8be5\u9898\u53ef\u4ee5\u7528```__int128``` \u6c34\u8fc7\u53bb\u4e86\u2026\u2026\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\n__int128 n,mod,p,q,r,t,u,v,w,x,y,z;\nstruct matrix{\n\t__int128 a[15][15];\n\tmatrix(){memset(a,0,sizeof(a));}\n}res,base,num;\ninline __int128 read()\n{\n    __int128 s=0;char c=getchar();\n    for(;!isdigit(c);c=getchar());\n    for(;isdigit(c);c=getchar())\n        s=s*10+c-'0';\n    return s;\n}\nvoid write(__int128 x)\n{\n    static char buf[50];\n    static int len=-1;\n    if(x<0)putchar('-'),x=-x;\n    do buf[++len]=x%10,x/=10;while(x);\n    while(len>=0)putchar(buf[len--]+'0');\n    putchar('\\n');\n}\nmatrix operator * (const matrix &a,const matrix &b)\n{\n\tmatrix c;\n\tfor(int i=1;i<=11;i++)\n\t\tfor(int j=1;j<=11;j++)\n\t\t\tfor(int k=1;k<=11;k++)\n\t\t\t\tc.a[i][j]=(c.a[i][j]+a.a[i][k]*b.a[k][j]%mod)%mod;\n\treturn c;\n}\ninline void input()\n{\n\tn=read(),mod=read();\n\tp=read(),q=read(),r=read(),t=read();\n\tu=read(),v=read(),w=read();\n\tx=read(),y=read(),z=read();\n}\ninline void init()\n{\n\tfor(int i=1;i<=11;i++)\n\t\tres.a[i][i]=1;\n\tbase.a[1][1]=p,base.a[1][2]=base.a[1][3]=1,base.a[1][4]=q,base.a[1][7]=r,base.a[1][8]=t,base.a[1][9]=1;\n\tbase.a[2][1]=1,base.a[2][2]=u,base.a[2][3]=1,base.a[2][5]=v,base.a[2][10]=1;\n\tbase.a[3][1]=base.a[3][2]=1,base.a[3][3]=x,base.a[3][6]=y,base.a[3][8]=1,base.a[3][9]=2,base.a[3][11]=1;\n\tbase.a[4][1]=1;\n\tbase.a[5][2]=1;\n\tbase.a[6][3]=1;\n\tbase.a[7][7]=1,base.a[7][8]=2,base.a[7][9]=1;\n\tbase.a[8][8]=base.a[8][9]=1;\n\tbase.a[9][9]=1;\n\tbase.a[10][10]=w;\n\tbase.a[11][11]=z;\n\tnum.a[1][1]=num.a[2][1]=num.a[3][1]=3;\n\tnum.a[4][1]=num.a[5][1]=num.a[6][1]=num.a[7][1]=num.a[8][1]=num.a[9][1]=1;\n\tnum.a[10][1]=w;\n\tnum.a[11][1]=z;\n}\nvoid qpow(__int128 k)\n{\n\twhile(k)\n\t{\n\t\tif(k&1)res=res*base;\n\t\tk>>=1,base=base*base;\n\t}\n\tres=res*num;\n}\nvoid print()\n{\n\tprintf(\"nodgd \");\n\twrite(res.a[1][1]);\n\tprintf(\"Ciocio \");\n\twrite(res.a[2][1]);\n\tprintf(\"Nicole \");\n\twrite(res.a[3][1]);\n}\nint main()\n{\n\tinput();\n\tinit();\n\tqpow(n-2);\n\tprint();\n\treturn 0;\n}\n```",
        "postTime": 1631696232,
        "uid": 306049,
        "name": "Utilokasteinn",
        "ccfLevel": 0,
        "title": "P1707 \u5237\u9898\u6bd4\u8d5b"
    },
    {
        "content": "\u9996\u5148\u611f\u8c22**\u53f6\u7483caco3**dalao\u4e3a\u6211\u6307\u51fa\u9519\u8bef\uff0c\u8ba9\u6211\u7ec8\u4e8eA\u4e86\u8fd9\u6076\u5fc3\u4e86\u6211\u4e00\u665a\u4e0a\u7684\u9898\n\n\u663e\u7136\uff0c\u8fd9\u662f\u4e2a\u77e9\u4e58\uff0c\u9700\u8981\u6211\u4eec\u63a8\u5143\u77e9\u9635\uff0c\u6211\u4eec\u8981\u7ef4\u62a4\u7684\u4fe1\u606f\u5982\u4e0b\uff1a\n\n$a_{k+2},a_{k+1},b_{k+2},b_{k+1},c_{k+2},c_{k+1},k^{2},k,w^{k},$\n$z^{k},$\u5e38\u6570\uff0c\u6ca1\u9519\uff0c\u603b\u517111\u4e2a\uff01\n\n\u90a3\u63a5\u4e0b\u6765\u5c31\u8ba9\u6211\u4eec\u5f00\u59cb\u63a8\u5427\uff08\u5982\u679c\u4f60\u4e0d\u9020\u5565\u662f\u77e9\u9635\u4e58\u6cd5\u8bf7\u81ea\u89c9\u95ee\u5ea6\u5a18\uff09\n\n\u628a\u521a\u521a\u768411\u4e2a\u4fe1\u606f\u585e\u5230\u4e00\u4e2a\u77e9\u9635\u91cc\uff0c\u5c31\u6709\n\n| $a_{k+2}$ |$a_{k+1}$  |$b_{k+2}$  |$b_{k+1}$  |$c_{k+2}$  |$c_{k+1}$  |$k^{2}$  |$k$  |$w^{k}$  |$z^{k}$  |$1$  |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n\u6839\u636e\u9898\u610f\uff0c\u8ba9\u4ee5\u4e0a\u77e9\u9635\u653e\u5728\u4e58\u53f7\u53f3\u8fb9\uff0c\u5de6\u8fb9\u662f\u5143\u77e9\u9635\uff0c\u8fd9\u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u77e9\u9635\n\n\u3010$p,1,1,0,1,0,0,0,0,0,0$\u3011\n\n\u3010$q,0,0,0,0,0,0,0,0,0,0$\u3011\n\n\u3010$1,0,u,1,1,0,0,0,0,0,0$\u3011\n\n\u3010$0,0,v,0,0,0,0,0,0,0,0$\u3011\n\n\u3010$1,0,1,0,x,1,0,0,0,0,0$\u3011\n\n\u3010$0,0,0,0,y,0,0,0,0,0,0$\u3011\n\n\u3010$r,0,0,0,0,0,1,0,0,0,0$\u3011\n\n\u3010$t,0,0,0,1,0,2,1,0,0,0$\u3011\n\n\u3010$0,0,1,0,0,0,0,0,w,0,0$\u3011\n\n\u3010$0,0,0,0,1,0,0,0,0,z,0$\u3011\n\n\u3010$1,0,0,0,2,0,1,1,0,0,1$\u3011\n\n~~\u662f\u4e0d\u662f\u975e\u5e38\u6076\u5fc3~~\n\n\u90a3\u63a5\u4e0b\u6765\u5c31\u662f\u6b63\u5e38\u7684\u77e9\u9635\u5feb\u901f\u5e42\u4e86\u3002\n\n## **\u6ce8\u610f\u4ee5\u4e0b\u51e0\u70b9\uff1a**\n\n\u2460\u6211\u8c03\u4e86\u4e00\u665a\u4e0a\u7684\u539f\u56e0\uff0c$k$\u53d8$k+1$\u7684\u65f6\u5019\u6ca1\u6709\u4e58\u90a3\u4e2a1\uff08555555\uff09\uff0c\u5305\u62ec\n\n\u5e73\u65b9\u9879\u4e5f\u662f\uff0c\u4e00\u5b9a\u8981\u6ce8\u610f\u662f$k+1$\u4ee5\u53ca$k^{2}+2*k+1$\n\n\u2461\u77e9\u9635\u53c8\u7ed3\u5408\u6027\u4f46\u4e0d\u5177\u6709\u4ea4\u6362\u6027\uff0c\u5982\u679c\u4f60\u7684\u77e9\u9635\u4e00\u76f4\u4e58\u9519\uff0c\u8bd5\u8bd5\u628a\u4e24\u4e2a\u77e9\u9635\n\n\u7684\u987a\u5e8f\u4ea4\u6362\u4e00\u4e0b\uff08~~\u8bf4\u4e0d\u5b9a\u5c31A\u4e86~~\uff09\n\n\u2462\u6ce8\u610f\u8fd9\u73a9\u610f\u975e\u5e38\u5927\uff0c\u9700\u8981\u9f9f\u901f\u4e58\uff0c\u4e0d\u7136ULL\u4e5f\u53ef\u4ee5\n\n\u5f53\u7136\u521d\u59cb\u77e9\u9635\u5c31\u662f{$3,1,3,1,3,1,1,1,w,z,1$}\u5566\n\n\u6700\u540e\u6211\u4eec\u7684\u7b54\u6848\u5c31\u662f$f$\u77e9\u9635\u76841,3,5,\u9879\u5566\uff0c\u5230\u4e86\u6109\u5feb\u7684\u4ee3\u7801\u65f6\u95f4\n\n## code\n```cpp\n#include<bits/stdc++.h>\n#define R register\n\nusing namespace std;\ntypedef long long LL;\nLL n, k;\nint p, q, r, t;\nint u, v, w;\nint x, y, z;\nstruct JU {\n\tLL v[12][12];\n}f, base;\n\ninline LL sxsy(LL a, LL b) {//\u9f9f\u901f\u4e58\n\tLL res = 0;\n\tfor(; b ;b >>= 1, a = (a << 1) % k)\n\t\tif(b & 1)\n\t\t\tres = (res + a) % k;\n\treturn res;\n}\n\nJU operator * (JU a, JU b) {\u91cd\u8f7d*\u53f7\n\tJU c;\n\tmemset(c.v, 0, sizeof(c.v));\n\tfor(R int i = 1;i <= 11;++ i) {\n\t\tfor(R int j = 1;j <= 11;++ j) {\n\t\t\tfor(R int l = 1;l <= 11;++ l) {\n\t\t\t\tc.v[i][j] = (c.v[i][j] + sxsy(a.v[i][l], b.v[l][j])) % k;\n\t\t\t}\n\t\t}\n\t}\n\treturn c;\n}\n\ninline JU qxsy(JU a, LL b) {\u77e9\u9635\u5feb\u901f\u5e42\n\tJU res;\n\tmemset(res.v, 0, sizeof(res.v));\n\tfor(R int i = 1;i <= 11;++ i) res.v[i][i] = 1;\n\tfor(; b ;b >>= 1, a = a * a)\n\t\tif(b & 1)\n\t\t\tres = res * a;\n\treturn res;\n}\n\nint main() {\n\tscanf(\"%lld%lld\",&n, &k);\n\tscanf(\"%d%d%d%d\",&p, &q, &r, &t);\n\tscanf(\"%d%d%d\",&u, &v, &w);\n\tscanf(\"%d%d%d\",&x, &y, &z);\n\t\n\tf.v[1][1] = f.v[1][3] = f.v[1][5] = 3\u521d\u59cb\u77e9\u9635;\n\tf.v[1][2] = f.v[1][4] = f.v[1][6] = 1;\n\tf.v[1][7] = f.v[1][8] = f.v[1][11] = 1;\n\tf.v[1][9] = w, f.v[1][10] = z;\n\t//\u6700\u6076\u5fc3\u7684\u5143\u77e9\u9635\n\tbase.v[1][1] = p, base.v[1][2] = 1, base.v[1][3] = 1;\n\tbase.v[1][5] = 1, base.v[2][1] = q, base.v[3][1] = 1;\n\tbase.v[3][3] = u, base.v[3][4] = 1, base.v[3][5] = 1;\n\tbase.v[4][3] = v, base.v[5][1] = 1, base.v[5][3] = 1;\n\tbase.v[5][5] = x, base.v[5][6] = 1, base.v[6][5] = y;\n\tbase.v[7][1] = r, base.v[7][7] = 1, base.v[8][1] = t;\n\tbase.v[8][5] = 1, base.v[8][7] = 2, base.v[8][8] = 1;\n\tbase.v[9][3] = 1, base.v[9][9] = w, base.v[10][5] = 1;\n\tbase.v[10][10] = z, base.v[11][1] = 1, base.v[11][5] = 2;\n\tbase.v[11][7] = base.v[11][8] = base.v[11][11] = 1;\n\t\n\tf = f * qxsy(base, n - 2);\n\tprintf(\"nodgd %lld\\n\",f.v[1][1]);\n\tprintf(\"Ciocio %lld\\n\",f.v[1][3]);\n\tprintf(\"Nicole %lld\\n\",f.v[1][5]);\n\treturn 0;\n}\n```\n\u5b8c\u7ed3\u6492\u82b1",
        "postTime": 1569715112,
        "uid": 160654,
        "name": "\u707c\u773c\u7684\u590f\u5a1c",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P1707 \u3010\u5237\u9898\u6bd4\u8d5b\u3011"
    },
    {
        "content": "\u6bd5\u7adf\u662f\u9053\u77e9\u9635\u4e58\u6cd5\uff0c\u5927\u5bb6\u7528\u7684\u77e9\u9635\u90fd\u5404(\u975e)\u4e0d(\u5e38)\u76f8(\u6076)\u540c(\u5fc3)\n\n\u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e0b\u6211\u7528\u7684\u77e9\u9635\n\n![](http://47.104.147.153:818/storage/65/P1707-matrix.png)\n\n\u8868\u683c\u94fe\u63a5 http://47.104.147.153:818/storage/65/P1707-matrix.html\n\n\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\uff0c\u6211\u8f6c\u79fb\u7528\u7684\u90fd\u662f $k$, $k-1$\u3002\n\n\u7136\u800c\u5176\u4ed6\u5199\u9898\u89e3\u7684\u4eba\u4eec\u7528\u7684\u662f $k+1$, $k$\u3002\n\n\u8fd9\u5c31\u5bfc\u81f4\u5361\u901f\u7c73\u7684\u5e42\u6570\u4e0d\u540c\uff08\u6211\uff1a$N-2$\uff1b\u5176\u4ed6\u4eba\uff1a$N-3$\uff09\n\n\u518d\u6765\u8bf4\u4e00\u4e0b\u672c\u9898\n\n\u4e00\u822c\uff0c\u77e9\u9635\u4e58\u6cd5\u7684\u9898\u76ee\u90fd\u6bd4\u8f83\u6d45\u663e\uff0c\u5f88\u5bb9\u6613\u770b\u51fa\u6765\uff1b\u800c\u8f6c\u79fb\u7528\u7684\u77e9\u9635\u4e5f\u6bd4\u8f83\u597d\u63a8\u7406\uff08\u5982\u679c\u4f60\u5df2\u7ecf\u505a\u8fc7\u542b $z^k$ \u6216 $k^z$ \u7684\u9898\u76ee\uff0ck\u662f\u9879\u7684\u7f16\u53f7\uff0cz\u662f\u5e38\u6570\uff09\n\n\u7136\u800c\uff0c\u5230\u4e86\u63d0\u9ad8+\u5c42\u6b21\uff08\u5c24\u5176\u672c\u9898\u8fd8\u662f \u7701\u9009/NOI-\uff09\u7684\u65f6\u5019\uff0c\u5c31\u8981\u8003\u8651\u9898\u76ee\u7684\u5751\u4e86\n\n## \u9898\u76ee\u7684\u5751\n\n### \u4e00\u4e2a\u660e\u663e\u7684\u5751\n\n\u77e9\u9635\u4e58\u6cd5\u7684\u65f6\u5019\u4e0d\u80fd\u76f4\u63a5\u4e58\uff0c\u8981\u7528\u7279\u6b8a\u4e58\u6cd5\uff1a\n\n1. \u9f9f\u901f\u4e58\n2. $long\\ double$\u8bef\u5dee\u5927\u4e58\uff08\u5c24\u6307\u672c\u9898\uff0c$K$\u975e\u5e38\u5927\uff09\n3. __int28\u8054\u8d5b\u4e0d\u80fd\u7528\u4e58\n\n~~\u5176\u5b9e\u90fd\u5f88\u4e0d\u9760\u8c31~~\n\n### \u4e00\u4e2a\u4e0d\u592a\u4f1a\u8df3\u8fdb\u53bb\u7684\u5751\n\n~~\u7136\u800c\u6211\u8df3\u8fdb\u53bb\u4e86~~\n\n\u7b2c2\u5929\u4e0d\u6ee1\u8db3\u516c\u5f0f\uff0c\u6240\u4ee5\u8f6c\u79fb\u5b8c\u4e4b\u540e\u4e00\u5b9a\u8981\u518d\u4e58\u4e0a \u521d\u59cb\u77e9\u9635\n\n$|\\ 3\\ |$  \n$|\\ 1\\ |$  \n$|\\ 3\\ |$  \n$|\\ 1\\ |$  \n$|\\ 3\\ |$  \n$|\\ 1\\ |$  \n$|\\ 1\\ |$  \n$|\\ 1\\ |$  \n$|\\ 1\\ |$  \n$|\\ \\!w\\ \\!|$   \n$|\\ z\\ |$  \n\n### \u4e00\u4e2a\u5bb9\u6613\u8fdb\u4e5f\u5bb9\u6613\u51fa\u7684\u5751\n\n\u8f6c\u79fb\u77e9\u9635\u5199\u9519\uff0c\u8f83\u5bb9\u6613\u53d1\u73b0\n\n\u7136\u540e\u5e94\u8be5\u6ca1\u6709\u4ec0\u4e48\u5751\u4e86\u5427\n\n## \u559c\u95fb\u4e50\u89c1\u7684 Code \u65f6\u95f4\n```\n/*************************************\n * problem:      P1707 \u5237\u9898\u6bd4\u8d5b.\n * user ID:      63720.\n * user name:    Jomoo.\n * time:         2019-08-09.\n * language:     C++.\n * upload place: Luogu.\n*************************************/ \n\n#include <bits/stdc++.h>\nusing namespace std;\n\ntemplate <typename Int>\ninline Int read()       \n{\n    Int flag = 1;\n    char c = getchar();\n    while ((!isdigit(c)) && c != '-') c = getchar();\n    if (c == '-') flag = -1, c = getchar();\n    Int init = c & 15;\n    while (isdigit(c = getchar())) init = (init << 3) + (init << 1) + (c & 15);\n\treturn init * flag;\n}\n\ntemplate <typename Int>\ninline void write(Int x)\n{\n    if (x < 0) putchar('-'), x = ~x + 1;\n    if (x > 9) write(x / 10);\n    putchar((x % 10) | 48);\n}  \n\ntemplate <typename Int>\ninline void write(Int x, char nextch)\n{\n    write(x);\n    putchar(nextch);\n}\n\nunsigned long long N, K;\nunsigned long long p, q, r, t;\nunsigned long long u, v, w;\nunsigned long long x, y, z;\n\nunsigned long long mul(unsigned long long x, unsigned long long y)\n{\n    unsigned long long res = 0;\n    if (x < y) swap(x, y);\n    if (!x || !y) return 0;\n    while (y > 1) {\n        if (y & 1) res = (x + res) % K;\n        x = (x + x) % K;\n        y >>= 1;\n    }\n    return (res + x) % K;\n}\n\n#define EMPTY_MATRIX 19260817\n#define UNIT_MATRIX 114514\nstruct matrix {\n    unsigned long long n, m;\n    unsigned long long a[21][21];\n\n    matrix(unsigned long long _n, unsigned long long _m, unsigned long long matrixType) : n(_n), m(_m)\n    { \n        memset(a, 0, sizeof(a));\n        if (matrixType == UNIT_MATRIX) for (unsigned long long i = 1; i <= _n; i++) a[i][i] = 1;\n    }\n\n    matrix operator * (const matrix &Timeser)\n    {\n        matrix res(n, Timeser.m, EMPTY_MATRIX);\n        for (unsigned long long i = 1; i <= n; i++) {\n            for (unsigned long long j = 1; j <= Timeser.m; j++) {\n                for (unsigned long long k = 1; k <= m; k++) {\n                    res.a[i][j] += mul(a[i][k], Timeser.a[k][j]) % K;\n                    res.a[i][j] %= K;\n                }\n            }\n        }\n        return res;\n    }\n};\n\nmatrix fexp(matrix a, unsigned long long n)\n{\n    matrix res(a.n, a.m, UNIT_MATRIX);\n    while (n) {\n        if (n & 1) res = a * res;\n        a = a * a;\n        n >>= 1;\n    }\n    return res;\n}\n\nint main()\n{\n    N = read<unsigned long long>();\n    K = read<unsigned long long>();\n    // line 1\n    p = read<unsigned long long>();\n    q = read<unsigned long long>();\n    r = read<unsigned long long>();\n    t = read<unsigned long long>();\n    // line 2\n    u = read<unsigned long long>();\n    v = read<unsigned long long>();\n    w = read<unsigned long long>();\n    // line 3\n    x = read<unsigned long long>();\n    y = read<unsigned long long>();\n    z = read<unsigned long long>();\n    // line 4\n    matrix facer(11, 11, EMPTY_MATRIX), baser(11, 1, EMPTY_MATRIX), ans(11, 1, UNIT_MATRIX);\n    // facer.n = 11;\n    // facer.m = 11;\n    facer.a[1][1] = p;\n    facer.a[1][2] = 1;\n    facer.a[1][3] = 1;\n    facer.a[1][4] = q;\n    facer.a[1][9] = r;\n    facer.a[1][10] = t;\n    facer.a[1][11] = 1;\n    facer.a[2][1] = 1;\n    facer.a[2][2] = u;\n    facer.a[2][3] = 1;\n    facer.a[2][5] = v;\n    facer.a[2][7] = 1;\n    facer.a[3][1] = 1;\n    facer.a[3][2] = 1;\n    facer.a[3][3] = x;\n    facer.a[3][6] = y;\n    facer.a[3][8] = 1;\n    facer.a[3][10] = 1;\n    facer.a[3][11] = 2;\n    facer.a[4][1] = 1;\n    facer.a[5][2] = 1;\n    facer.a[6][3] = 1;\n    facer.a[7][7] = w;\n    facer.a[8][8] = z;\n    facer.a[9][9] = 1;\n    facer.a[9][10] = 2;\n    facer.a[9][11] = 1;\n    facer.a[10][10] = 1;\n    facer.a[10][11] = 1;\n    facer.a[11][11] = 1;\n    // baser.n = 11;\n    // baser.m = 1;\n    baser.a[1][1] = 3;\n    baser.a[2][1] = 3;\n    baser.a[3][1] = 3;\n    baser.a[4][1] = 1;\n    baser.a[5][1] = 1;\n    baser.a[6][1] = 1;\n    baser.a[7][1] = w;\n    baser.a[8][1] = z;\n    baser.a[9][1] = 1;\n    baser.a[10][1] = 1;\n    baser.a[11][1] = 1;\n    ans = fexp(facer, N - 2) * baser;\n    printf(\"nodgd %llu\\n\", ans.a[1][1]);\n    printf(\"Ciocio %llu\\n\", ans.a[2][1]);\n    printf(\"Nicole %llu\\n\", ans.a[3][1]);\n    return 0;\n}\n```",
        "postTime": 1565321184,
        "uid": 63720,
        "name": "brealid",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1707 \u3010\u5237\u9898\u6bd4\u8d5b\u3011"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u9053\u5f88\u597d\u7684\u77e9\u9635\u5feb\u901f\u5e42\u7ec3\u624b\u9898\u3002\n\n\u9996\u5148\u6211\u4eec\u6765\u770b\u66b4\u529b\u7834\u89e3\uff0c\u8fd9\u79cd\u505a\u6cd5\u5728\u6700\u4f18\u60c5\u51b5\u4e0b\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a $ \\Theta\\left(1\\right) $,\u65f6\u95f4\u590d\u6742\u5ea6\u4f1a\u8fbe\u5230 $ \\Theta\\left(n\\right) $,\u4f46\u662f\u672c\u9898\u6570\u636e\u8303\u56f4\u4e3a $ 1 \\le n \\le 10^{16} $,\u66b4\u529b\u663e\u7136\u662f\u4e0d\u884c\u7684\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u731c\u6d4b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $ \\Theta\\left(\\log_2k\\right) $,\u8fd9\u79cd\u65f6\u95f4\u590d\u6742\u5ea6\u4f7f\u7528\u77e9\u9635\u5feb\u901f\u5e42\u5c31\u5b8c\u5168\u53ef\u4ee5\u505a\u5230\u3002\n\n\u9996\u5148\uff0c~~\u7531\u4e8e\u672c\u4eba\u770b\u9898\u76ee\u4e2d\u8f6c\u79fb\u516c\u5f0f\u5f88\u4e0d\u987a\u773c~~\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e09\u4e2a\u516c\u5f0f\u53d8\u6210\u4e0b\u9762\u8fd9\u79cd\u6837\u5b50\uff1a\n\n$ a_{k+1}=pa_k+qa_{k-1}+b_k+c_k+r\\left(k-1\\right)^2+t\\left(k-1\\right)+1 $\n\n$ b_{k+1}=ub_k+vb_{k-1}+a_k+c_k+w^{k-1} $\n\n$ a_{k+1}=xc_k+yc_{k-1}+a_k+b_k+z^{k-1}+\\left(k-1\\right)+2 $\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6784\u9020\u77e9\u9635\u4e86\uff0c\u8ba9\u6211\u4eec\u9996\u5148\u6765\u786e\u8ba4\u9700\u8981\u8fdb\u884c\u7ef4\u62a4\u7684\u53d8\u91cf\uff0c\u9996\u5148 $ a_k $,$ a_{k-1} $,$ b_k $,$ b_{k-1} $,$ c_k $,$ c_{k-1} $ \u8fd9\u516d\u4e2a\u80af\u5b9a\u662f\u8981\u4e00\u76f4\u4fdd\u7559\u7684\uff0c\u5176\u6b21\uff0c\u6211\u4eec\u8fd8\u9700\u8981 $ \\left(k-1\\right)^2 $,$ w^{k-1} $,$ z^{k-1} $ \u8fd9\u51e0\u4e2a\u53d8\u91cf\uff0c\u540c\u65f6\uff0c\u4e3a\u4e86\u7ef4\u62a4 $ \\left(k-1\\right)^2 $ \u6211\u4eec\u4e5f\u9700\u8981\u7ef4\u62a4 $ k-1 $ \u548c $ 1 $\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6784\u9020\u51fa\u4e00\u4e2a\u77e9\u9635\u4e86\uff1a\n\n$  \\begin{vmatrix}\na_k  &b_k  &c_k  &a_{k-1}  &b_{k-1}  &c_{k-1}  &\\left(k-1\\right)^2  &\\left(k-1\\right)  &1  &w^{k-1}  &z^{k-1}\n\\end{vmatrix} $\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u7ed9\u51fa\u51e0\u4e2a\u663e\u800c\u6613\u89c1\u7684\u8f6c\u79fb\u516c\u5f0f\uff1a\n\n$ k^2=\\left(k-1\\right)^2+2\\times\\left(k-1\\right)+1 $\n\n$ k=\\left(k-1\\right)+1 $\n\n$ w^k=w^{k-1}\\times w $\n\n$ z^k=z^{k-1}\\times z $\n\n\u6709\u4e86\u8fd9\u51e0\u4e2a\u516c\u5f0f\u4e0e\u9898\u76ee\u4e2d\u6240\u7ed9\u7684\u4e09\u4e2a\u516c\u5f0f\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u51fa\u7528\u4e8e\u8f6c\u79fb\u7684\u8fd9\u4e2a\u77e9\u9635\u4e86\uff0c\u5b83\u957f\u8fd9\u4e2a\u6837\u5b50\uff1a\n\n$ \\begin{vmatrix}\np  &1  &1  &1  &0  &0  &0  &0  &0  &0  &0 \\\\\n1  &u  &1  &0  &1  &0  &0  &0  &0  &0  &0 \\\\\n1  &1  &x  &0  &0  &1  &0  &0  &0  &0  &0 \\\\\nq  &0  &0  &0  &0  &0  &0  &0  &0  &0  &0 \\\\\n0  &v  &0  &0  &0  &0  &0  &0  &0  &0  &0 \\\\\n0  &0  &y  &0  &0  &0  &0  &0  &0  &0  &0 \\\\\nr  &0  &0  &0  &0  &0  &1  &0  &0  &0  &0 \\\\\nt  &0  &1  &0  &0  &0  &2  &1  &0  &0  &0 \\\\\n1  &0  &2  &0  &0  &0  &1  &1  &1  &0  &0 \\\\\n0  &1  &0  &0  &0  &0  &0  &0  &0  &w  &0 \\\\\n0  &0  &1  &0  &0  &0  &0  &0  &0  &0  &z\n\\end{vmatrix} $\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u5c31\u628a\u672c\u9898\u4e2d\u6700\u5927\u7684\u56f0\u96be\uff0c\u6784\u9020\u77e9\u9635\u89e3\u51b3\u4e86\u3002\n\n\u73b0\u5728\u6211\u4eec\u8fd8\u6709\u4e00\u4e2a\u5c0f\u95ee\u9898\uff0c\u5c31\u662f\u4e24\u4e2a\u6700\u5927\u4e3a $ 10^{16} $ \u7684\u6570\u600e\u4e48\u76f8\u4e58\uff0c\u5176\u5b9e\u8fd9\u4e00\u4e2a\u95ee\u9898\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u9f9f\u901f\u4e58\u6765\u89e3\u51b3\u3002\n\n\u4ece\u5b57\u9762\u4e0a\u7406\u89e3\uff0c\u5c31\u662f\u5f88\u6162\u7684\u4e58\u6cd5\uff0c\u5176\u5b9e\u5b83\u4e5f\u6162\u4e0d\u5230\u54ea\u91cc\u53bb\u3002\u9f9f\u901f\u4e58\u4e5f\u5c31\u662f\u5229\u7528\u4e86\u5feb\u901f\u5e42\u7684\u601d\u60f3\uff0c\u4ece\u800c\u5b9e\u73b0\u5f88\u5927\u4e24\u6570\u76f8\u4e58\u53d6\u6a21\u7684\u60c5\u51b5\uff0c\u8be6\u60c5\u5927\u5bb6\u53ef\u4ee5\u770b\u4ee3\u7801\u3002\n\n\u5982\u679c\u6709\u4e0d\u4f1a\u77e9\u9635\u5feb\u901f\u5e42\u7684\u540c\u5b66\uff0c\u53ef\u4ee5\u67e5\u770b[\u6211\u7684\u535a\u5ba2](https://www.luogu.com.cn/blog/wuyanru/guan-yu-ju-zhen)\uff0c\u8fd9\u91cc\u6709\u5173\u4e8e\u77e9\u9635\u7684\u4ee3\u7801\uff0c\u5feb\u901f\u5e42\u90fd\u662f\u5199\u597d\u7684\u3002\n\nAC \u4ee3\u7801\uff1a\n\n```\n#include<cstring>\n#include<cstdio>\nusing namespace std;\nlong long n,mm;\nlong long p,q,r,t;\nlong long u,v,w;\nlong long x,y,z;\nlong long cheng(long long a,long long b) {\n\tlong long ans=0;\n\twhile(b) {\n\t\tif(b&1) {\n\t\t\tans=ans+a;\n\t\t\tans%=mm;\n\t\t}\n\t\ta=a+a;\n\t\ta%=mm;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\nstruct mat {\n\tlong long m,n;\n\tlong long a[12][12];\n\tmat operator + (mat b) {\n\t\tmat ans;\n\t\tmemset(ans.a,0,sizeof(ans.a));\n\t\tans.m=m,ans.n=n;\n\t\tfor(int i=1; i<=m; i++)\n\t\t\tfor(int j=1; j<=n; j++)\n\t\t\t\tans.a[i][j]=a[i][j]+b.a[i][j];\n\t\treturn ans;\n\t}\n\tvoid operator += (mat b) {\n\t\tfor(int i=1; i<=m; i++)\n\t\t\tfor(int j=1; j<=n; j++)\n\t\t\t\ta[i][j]+=b.a[i][j];\n\t}\n\tmat operator - (mat b) {\n\t\tmat ans;\n\t\tmemset(ans.a,0,sizeof(ans.a));\n\t\tans.m=m,ans.n=n;\n\t\tfor(int i=1; i<=m; i++)\n\t\t\tfor(int j=1; j<=n; j++)\n\t\t\t\tans.a[i][j]=a[i][j]-b.a[i][j];\n\t\treturn ans;\n\t}\n\tvoid operator -= (mat b) {\n\t\tfor(int i=1; i<=m; i++)\n\t\t\tfor(int j=1; j<=n; j++)\n\t\t\t\ta[i][j]-=b.a[i][j];\n\t}\n\tmat operator * (mat b) {\n\t\tmat ans;\n\t\tmemset(ans.a,0,sizeof(ans.a));\n\t\tans.m=m;\n\t\tans.n=b.n;\n\t\tfor(int i=1; i<=m; i++)\n\t\t\tfor(int j=1; j<=b.n; j++)\n\t\t\t\tfor(int p=1; p<=n; p++) {\n\t\t\t\t\tans.a[i][j]+=cheng(a[i][p],b.a[p][j]);\n\t\t\t\t\tans.a[i][j]%=mm;\n\t\t\t\t}\n\t\treturn ans;\n\t}\n\tvoid operator *= (mat b) {\n\t\t(*this)=(*this)*b;\n\t}\n\tmat operator ^ (long long t) {\n\t\tmat ans,num;\n\t\tans.m=ans.n=m;\n\t\tnum=(*this);\n\t\tmemset(ans.a,0,sizeof(ans.a));\n\t\tfor(int i=1; i<=m; i++)\n\t\t\tans.a[i][i]=1;\n\t\twhile(t) {\n\t\t\tif(t&1)\n\t\t\t\tans=ans*num;\n\t\t\tnum=num*num;\n\t\t\tt>>=1;\n\t\t}\n\t\treturn ans;\n\t}\n\tvoid operator ^= (long long t) {\n\t\t(*this)=(*this)^t;\n\t}\n\tmat operator % (long long t) {\n\t\tmat ans;\n\t\tans.m=m,ans.n=n;\n\t\tfor(int i=1; i<=m; i++)\n\t\t\tfor(int j=1; j<=n; j++)\n\t\t\t\tans.a[i][j]=a[i][j]%t;\n\t\treturn ans;\n\t}\n\tvoid operator = (mat b) {\n\t\tm=b.m,n=b.n;\n\t\tfor(int i=1; i<=b.m; i++)\n\t\t\tfor(int j=1; j<=b.n; j++)\n\t\t\t\ta[i][j]=b.a[i][j];\n\t}\n\tbool operator == (mat b) {\n\t\tif(m!=b.m||n!=b.n)\n\t\t\treturn false;\n\t\tfor(int i=1; i<=m; i++)\n\t\t\tfor(int j=1; j<=n; j++)\n\t\t\t\tif(a[i][j]!=b.a[i][j])\n\t\t\t\t\treturn false;\n\t\treturn true;\n\t}\n\tvoid inn() {\n\t\tscanf(\"%lld\",&n);\n\t}\n\tvoid inm() {\n\t\tscanf(\"%lld\",&m);\n\t}\n\tvoid innn() {\n\t\tinm();\n\t\tn=m;\n\t}\n\tvoid inmn() {\n\t\tinm();\n\t\tinn();\n\t}\n\tvoid ina() {\n\t\tfor(int i=1; i<=m; i++)\n\t\t\tfor(int j=1; j<=n; j++)\n\t\t\t\tscanf(\"%lld\",&a[i][j]);\n\t}\n\tvoid in() {\n\t\tinmn();\n\t\tina();\n\t}\n\tvoid outm() {\n\t\tprintf(\"%lld\\n\",m);\n\t}\n\tvoid outn() {\n\t\tprintf(\"%lld\\n\",n);\n\t}\n\tvoid outmn() {\n\t\tprintf(\"%lld %lld\\n\",m,n);\n\t}\n\tvoid outa() {\n\t\tfor(int i=1; i<=m; i++) {\n\t\t\tfor(int j=1; j<=n; j++)\n\t\t\t\tprintf(\"%lld \",a[i][j]);\n\t\t\tprintf(\"\\n\");\n\t\t}\n\t}\n\tvoid out() {\n\t\toutmn();\n\t\touta();\n\t}\n};\nmat num,ans;\nint main() {\n\tscanf(\"%lld%lld\",&n,&mm);\n\tscanf(\"%lld%lld%lld%lld\",&p,&q,&r,&t);\n\tscanf(\"%lld%lld%lld\",&u,&v,&w);\n\tscanf(\"%lld%lld%lld\",&x,&y,&z);\n\tmemset(num.a,0,sizeof(num.a));\n\tmemset(ans.a,0,sizeof(ans.a));\n\tans.m=1,ans.n=11;\n\tans.a[1][1]=ans.a[1][2]=ans.a[1][3]=3;\n\tans.a[1][4]=ans.a[1][5]=ans.a[1][6]=1;\n\tans.a[1][7]=ans.a[1][8]=ans.a[1][9]=1;\n\tans.a[1][10]=w,ans.a[1][11]=z;\n\tnum.m=num.n=11;\n\tnum.a[1][1]=p,num.a[1][2]=num.a[1][3]=num.a[1][4]=1;\n\tnum.a[2][2]=u,num.a[2][1]=num.a[2][3]=num.a[2][5]=1;\n\tnum.a[3][3]=x,num.a[3][1]=num.a[3][2]=num.a[3][6]=1;\n\tnum.a[4][1]=q,num.a[5][2]=v,num.a[6][3]=y;\n\tnum.a[7][1]=r,num.a[7][7]=1;\n\tnum.a[8][1]=t,num.a[8][3]=num.a[8][8]=1,num.a[8][7]=2;\n\tnum.a[9][1]=num.a[9][7]=num.a[9][8]=num.a[9][9]=1,num.a[9][3]=2;\n\tnum.a[10][10]=w,num.a[10][2]=1;\n\tnum.a[11][11]=z,num.a[11][3]=1;\n\tnum^=(n-2);\n\tans=ans*num;\n\tprintf(\"nodgd %lld\\nCiocio %lld\\nNicole %lld\",ans.a[1][1],ans.a[1][2],ans.a[1][3]);\n\treturn 0;\n}\n```\n\u51e0\u4e2a\u5c0f\u7ec6\u8282\uff1a\n\n1.  \u77e9\u9635\u8fdb\u884c\u5feb\u901f\u5e42\u4e2d\u6307\u6570\u4e3a $ k-2 $ \u6b21\uff0c\u5343\u4e07\u4e0d\u8981\u5199\u9519\uff1b\n\n2.  \u77e9\u9635\u8bb0\u5f97\u521d\u59cb\u5316\uff1b\n\n3.  \u672c\u9898\u4e2d\u7684\u53d8\u91cf\u5c3d\u91cf\u90fd\u4f7f\u7528 long long \u7c7b\u578b\uff1b\n\n4.  \u8bb0\u5f97\u4f7f\u7528\u9f9f\u901f\u4e58\uff0c\u4e0d\u8981\u987a\u624b\u6253\u6210\u5feb\u901f\u5e42\u7684\u4ee3\u7801\u3002\n\n5.  \u8bb0\u5f97\u53d6\u6a21\uff0c\u53d6\u7684\u6a21\u8981\u6b63\u786e\u3002\n\n\u611f\u8c22\u89c2\u770b\uff01",
        "postTime": 1618404463,
        "uid": 400201,
        "name": "Wuyanru",
        "ccfLevel": 7,
        "title": "P1707 \u5237\u9898\u6bd4\u8d5b"
    },
    {
        "content": "$$\\color{cornflowerblue}{\\mathcal{Treaker}}$$\n## \u77e9\u9635\u4e58\u6cd5\u3002\u3002\u3002\n\u673a\u623f\u67d0\u4e2a\u5de8\u4f6c\u7559\u7684\u9898\uff0c~~\u7b80\u76f4\u5c31\u662f\u755c\u751f-.-~~\u3002\n\n\u7136\u540e\u6309\u7167\u77e9\u9635\u7684\u5957\u8def\u624b\u73a9\u4e86\u4e00\u4e0b\u77e9\u9635\uff0c\u7136\u540e\u5c31A\u4e86\n\n\u5176\u5b9e\u8fd9\u9053\u9898\u633a\u7b80\u5355\u7684\u3002\u3002\u6309\u7167\u4ed6\u7ed9\u4f60\u7684\u53d8\u91cf\u653e\u5165\u77e9\u9635\u6765\u6784\u9020\u5c31\u884c\u4e86\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e\u6211\u4eec\u7684\u9012\u63a8\u6709\u7528\u7684\u53d8\u91cf\u662f\u4ec0\u4e48\u5462\uff1f\n\n\u663e\u7136\u4ece\u9012\u63a8\u5f0f\u53ef\u4ee5\u770b\u51fa\u662f$~a[k+1],a[k],b[k+1],b[k],c[k+1],c[k],k^2,k,w^k,z^k,1~$\u3002\n\n\u4e2d\u95f4\u7684\u8f6c\u79fb\u77e9\u9635\u53ef\u4ee5\u81ea\u5df1\u624b\u73a9\u4e00\u4e0b\u3002\u3002\n\n\u8fd9\u91cc\u653e\u51fa\u3002\n\n\u6ce8\uff1a\u6784\u9020\u65b9\u6cd5\u4e0d\u552f\u4e00\uff0c\u4ec5\u4f9b\u53c2\u8003\uff0c\u6211\u7684\u77e9\u9635\u662f\u4ece\u53f3\u8fb9\u5411\u5de6\u8fb9\u9012\u63a8\u7684\u3002\u3002\u3002\n\n| p | q | 1 | 0 | 1 | 0 | r | t | 0 | 0 | 1 |\n| -----------: | -----------: | -----------: | -----------: | -----------: | -----------: | -----------: | -----------: | -----------: | -----------: | -----------: |\n| 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |\n| 1 | 0 | u | v | 1 | 0 | 0 | 0 | 1 | 0 | 0 |\n| 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |\n| 1 | 0 | 1 | 0 | x | y | 0 | 1 | 0 | 1 | 2 |\n| 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 |\n| 0 | 0 | 0 | 0 | 0 | 0 | 1 | 2 | 0 | 0 | 1 |\n| 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 |\n| 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | w | 0 | 0 |\n| 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | z | 0 |\n| 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ur0ocnuo.png)\n![](https://cdn.luogu.com.cn/upload/image_hosting/e759mdgp.png)\n\n### \u77e9\u9635\u4e58\u6cd5\u5c31\u662f\u8fd9\u4e48\u795e\u5947\n\n\n### \u5b8c\u6574\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n#define ll long long\nusing namespace std;\nconst int N = 100005;\ninline ll read()\n{\n\tll x = 0 , f = 1;\tchar ch = getchar();\n\twhile(ch < '0' || ch > '9')\t{if(ch == '-')\tf = -1; ch = getchar();}\n\twhile(ch >= '0' && ch <= '9') {x = (x << 3) + (x << 1) + (ch ^ 48); ch = getchar();}\n\treturn x * f;\n}\nll n , mod , p , q , r , t , u , v , w , x , y , z;\nstruct martix\n{\n\tll f[12][12];\n\tmartix() {memset(f,0,sizeof f);}\n\tvoid init() {for(int i = 1;i <= 11;i ++) f[i][i] = 1;}\n}ans;\ninline ll mul(ll a,ll b)\n{\n\tll res = 0;\n\twhile(b)\n\t{\n\t\tif(b & 1) res = (res + a) % mod;\n\t\ta = (a + a) % mod;\n\t\tb >>= 1;\n\t}\n\treturn res;\n}\nmartix operator * (const martix & a,const martix & b)\n{\n\tmartix res;\n\tfor(int k = 1;k <= 11;k ++) for(int i = 1;i <= 11;i ++) for(int j = 1;j <= 11;j ++) res.f[i][j] = (res.f[i][j] + mul(a.f[i][k],b.f[k][j])) % mod;\n\treturn res;\n}\ninline martix ksm(ll b)\n{\n\tmartix res , a; res.init(); \n\ta.f[1][1] = p; a.f[1][2] = q; a.f[1][3] = 1; a.f[1][5] = 1; a.f[1][7] = r; a.f[1][8] = t; a.f[1][11] = 1;\n\ta.f[2][1] = 1; a.f[3][1] = 1; a.f[3][3] = u; a.f[3][4] = v; a.f[3][5] = 1; a.f[3][9] = 1; a.f[4][3] = 1; \n\ta.f[5][1] = 1; a.f[5][3] = 1; a.f[5][5] = x; a.f[5][6] = y; a.f[5][8] = 1; a.f[5][10] = 1; a.f[5][11] = 2; a.f[6][5] = 1;\n\ta.f[7][7] = 1; a.f[7][8] = 2; a.f[7][11] = 1; a.f[8][8] = 1; a.f[8][11] = 1; a.f[9][9] = w; a.f[10][10] = z; a.f[11][11] = 1;\n\twhile(b)\n\t{\n\t\tif(b & 1) res = res * a;\n\t\ta = a * a;\n\t\tb >>= 1;\n\t}\n\treturn res;\n}\nint main()\n{\n\tn = read(); mod = read(); p = read(); q = read(); r = read(); t = read(); u = read(); v = read(); w = read(); x = read(); y = read(); z = read();\n\tans.f[1][1] = ans.f[3][1] = ans.f[5][1] = 3; ans.f[2][1] = ans.f[4][1] = ans.f[6][1] = 1; ans.f[7][1] = ans.f[8][1] = 1; ans.f[9][1] = w; ans.f[10][1] = z; ans.f[11][1] = 1;\n\tans = ksm(n-2) * ans;\n\tprintf(\"nodgd %lld\\nCiocio %lld\\nNicole %lld\\n\",ans.f[1][1],ans.f[3][1],ans.f[5][1]);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1569656789,
        "uid": 153898,
        "name": "Treaker",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1707 \u3010\u5237\u9898\u6bd4\u8d5b\u3011"
    },
    {
        "content": "\n\u77e9\u9635\u4e58\u6cd5\u7684\u6076\u5fc3\u9898\u3002\n# \u914d\u77e9\u9635\n\u53ef\u4ee5\u914d\u4e00\u4e2a $11$ \u884c $11$ \u5217\u7684\u77e9\u9635\uff0c\u5177\u4f53\u89c1\u4e0b:\n\n\u521d\u59cb\u77e9\u9635\uff1a\n$$\\begin{pmatrix} a_k & a_{k+1} & b_k & b_{k+1} &c_k & c_{k+1} & k^2 & k & z^k & w^k & 1 \\end{pmatrix}\\quad$$\n\u90a3\u4e48\u7cfb\u6570\u77e9\u9635\u600e\u4e48\u914d\u5462\uff1f\n\n\u524d\u516d\u4e2a\u6570\u7684\u7cfb\u6570\u76f4\u63a5\u5957\u516c\u5f0f\u3002\n\n\u6839\u636e\u4ee5\u4e0b\u51e0\u4e2a\u516c\u5f0f\u53ef\u914d\u51fa\u540e\u9762\u51e0\u4e2a\uff1a\n$$ (k+1)^2=k^2+2 \\cdot k+1^2 $$\n\n\n$$ z^{k+1} =z^k \\cdot z$$\n\n$$ w^{k+1}=w^k \\cdot w$$\n\n\u4e8e\u662f\u7cfb\u6570\u77e9\u9635\u5c31\u51fa\u6765\u5566\uff01\n$$\\begin{pmatrix} 0 & q &0 & 0&0&0&0&0&0&0&0\\\\\n1 &p& 0&1&0&1&0&0&0&0&0\\\\\n0&0&0&v&0&0&0&0&0&0&0\\\\\n0&1&1&u&0&1&0&0&0&0&0\n\\\\\n0&0&0&0&0&y&0&0&0&0&0\\\\\n0&1&0&1&1&x&0&0&0&0&0\n\\\\\n0&r&0&0&0&0&1&0&0&0&0\\\\\n0&t&0&0&0&1&2&0&0&0&0\\\\\n0&0&0&0&0&1&0&0&z&0&0\\\\\n0&0&0&1&0&0&0&0&0&w&0\\\\\n0&1&0&0&0&2&1&1&0&0&1\n\\end{pmatrix}\\quad$$\n\n\n------------\n\n# \u9f9f\u901f\u4e58\uff1a\n\u6bcf\u4e2a\u6570\u90fd\u53ef\u4ee5\u8868\u793a\u4e3a\u4e00\u4e2a\u6216\u591a\u4e2a $2^k$ \u7684\u548c\uff0c\u4e8e\u662f\uff1a\n$$ a \\times b=a \\times 2^{b_1} + a \\times 2^{b_2} + \\cdots(b_1 +b_2 +\\cdots=b)$$\n\n\u7c7b\u4f3c\u4e8e\u5feb\u901f\u5e42\u3002\n\u8fd9\u6837\u7b97\u867d\u7136\u4f1a\u5c06\u4e58\u6cd5 $O(1)$ \u7684\u65f6\u95f4\u63d0\u5347\u5230 $O(\\log(b))$\uff0c\u4f46\u8fd9\u6837\u53ef\u4ee5\u5728\u4e58\u7684\u8fc7\u7a0b\u4e2d\u53d6\u6a21\u5c31\u4e0d\u4f1a\u7206\u6570\u636e\u7c7b\u578b\u4e86\uff01\n# AC CODE\n\u61c2\u4e86\u524d\u9762\u8fd9\u4e9b\u4ee3\u7801\u4e5f\u5c31\u7b80\u5355\u4e86\uff01\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint n,m,q,p,r,t,u,v,w,x,y,z;\nint a[12][12],b[12][12],c[12][12];\nint ch(int a,int b)//\u9f9f\u901f\u4e58\n{\n    int ans=0;\n    for(int i=1;i<=b;i<<=1)\n    {\n        if(b&i)\n        {\n            ans+=a;\n            ans%=m;\n        }\n        a=a*2%m;\n    }\n    return ans;\n}\nvoid Mul(int a[12][12],int b[12][12])//\u77e9\u9635\u4e58\u6cd5\n{\n    for(int i=1;i<=11;i++)\n    {\n        for(int j=1;j<=11;j++)\n        {\n            c[i][j]=0;\n            for(int k=1;k<=11;k++)\n            {\n                c[i][j]+=ch(a[i][k],b[k][j])%m;\n                c[i][j]%=m;\n            }\n        }\n    }\n}\nsigned main()\n{\ncin>>n>>m>>p>>q>>r>>t>>u>>v>>w>>x>>y>>z;\nn--;\na[1][1]=1,a[1][2]=3,a[1][3]=1,a[1][4]=3,a[1][5]=1,a[1][6]=3,a[1][7]=1,a[1][8]=1,a[1][9]=z,a[1][10]=w,a[1][11]=1;\nb[1][2]=q,b[6][4]=1,b[2][1]=1,b[2][2]=p,b[2][6]=1,b[3][4]=v,b[4][2]=1,b[4][3]=1,b[4][4]=u,b[5][6]=y,b[6][2]=1,b[6][5]=1,b[6][6]=x,b[7][2]=r,b[7][7]=1,b[8][2]=t,b[8][6]=1,b[8][7]=2,b[9][6]=1,b[10][4]=1,b[9][9]=z,b[10][10]=w,b[11][2]=1,b[11][6]=2,b[11][7]=1,b[11][8]=1,b[11][11]=1,b[2][4]=1,b[4][6]=1,b[8][8]=1;//\u521d\u59cb\u5316\u77e9\u9635\nfor(int i=1;i<=n;i<<=1)//\u77e9\u9635\u5feb\u901f\u5e42\n{\n    if(n&i)\n    {\n        Mul(a,b);\n        for(int j=1;j<=11;j++)\n        {\n            for(int k=1;k<=11;k++)\n            {\n                a[j][k]=c[j][k];\n            }\n        }\n    }\n    Mul(b,b);\n    for(int j=1;j<=11;j++)\n    {\n        for(int k=1;k<=11;k++)\n        {\n            b[j][k]=c[j][k];\n        }\n    }\n}\ncout<<\"nodgd \"<<a[1][1]<<\"\\n\";\ncout<<\"Ciocio \"<<a[1][3]<<\"\\n\";\ncout<<\"Nicole \"<<a[1][5]<<\"\\n\";\nreturn 0;\n}\n\u7801\u5b57\u4e0d\u6613\uff08\u7279\u522b\u662f\u77e9\u9635\u90a3\u4e00\u5757\uff09\u6c42\u8fc7awa~",
        "postTime": 1625904222,
        "uid": 210719,
        "name": "Violet___Evergarden",
        "ccfLevel": 4,
        "title": "P1707"
    },
    {
        "content": "\u4e00\u9053\u663e\u800c\u6613\u89c1\u7684\u77e9\u9635\u52a0\u901f\u9898\uff0c\u53ea\u9700\u8981\u5c06\u8f6c\u79fb\u77e9\u9635\u6309\u7167\u9898\u76ee\u7684\u8981\u6c42\u6784\u5efa\u51fa\u6765\u5c31\u884c\u4e86\u3002\n\n\u72b6\u6001\u77e9\u9635\n\n$$\\begin{vmatrix} a_{k+1}&b_{k+1}&c_{k+1}&a_k&b_k&c_k&k^2&k&w^k&z&k&1 \n\\end{vmatrix}$$\n\n\u8f6c\u79fb\u77e9\u9635\n\n$$\\begin{vmatrix}p&1&1&1&0&0&0&0&0&0&0\\\\1&u&1&0&1&0&0&0&0&0&0\\\\1&1&x&0&0&1&0&0&0&0&0\\\\q&0&0&0&0&0&0&0&0&0&0\\\\0&v&0&0&0&0&0&0&0&0&0\\\\0&0&y&0&0&0&0&0&0&0&0\\\\r&0&0&0&0&0&1&0&0&0&0\\\\t&0&1&0&0&0&2&1&0&0&0\\\\0&1&0&0&0&0&0&0&w&0&0\\\\0&0&1&0&0&0&0&0&0&z&0\\\\1&0&2&0&0&0&1&1&0&0&1\n\\end{vmatrix}$$\n\n\u7136\u540e\u76f4\u63a5\u5957\u677f\u5b50\u5c31\u53ef\u4ee5\u4e86\n\n\u4ee3\u7801\n```\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#define lll __int128\nusing namespace std;\ntypedef long long ll;\n\nll n, m;\nstruct matrix \n{\n    ll dt[12][12];\n    matrix operator * (const matrix b) const\n    {\n        matrix c;\n        memset(c.dt, 0, sizeof(c.dt));\n        for (int i = 1; i <= 11; i++)\n            for (int j = 1; j <= 11; j++)\n                for (int k = 1; k <= 11; k++)\n                    c.dt[i][j] = (c.dt[i][j] + (lll)dt[i][k] * b.dt[k][j]) % m;\n        return c;\n    }\n} a, ito;\n\nmatrix qmi(matrix base, ll b)\n{\n    matrix res;\n    memset(res.dt, 0, sizeof(res.dt));\n    for (int i = 1; i <= 11; i++)\n        res.dt[i][i] = 1;\n    while (b)\n    {\n        if (b & 1)\n            res = res * base;\n        base = base * base;\n        b >>= 1;\n    }\n    return res;\n}\n\nint main()\n{\n    scanf(\"%lld%lld\", &n, &m);\n    int p, q, r, t, u, v, w, x, y, z;\n    scanf(\"%d%d%d%d%d%d%d%d%d%d\", &p, &q, &r, &t, &u, &v, &w, &x, &y, &z);\n    a.dt[1][1] = a.dt[1][2] = a.dt[1][3] = 3;\n    a.dt[1][4] = a.dt[1][5] = a.dt[1][6] = a.dt[1][7] = a.dt[1][8] = 1;;\n    a.dt[1][9] = w, a.dt[1][10] = z, a.dt[1][11] = 1;\n    ito.dt[1][1] = p, ito.dt[1][2] = ito.dt[1][3] = ito.dt[1][4] = 1;\n    ito.dt[2][1] = ito.dt[2][3] = ito.dt[2][5] = 1, ito.dt[2][2] = u;\n    ito.dt[3][1] = ito.dt[3][2] = ito.dt[3][6] = 1, ito.dt[3][3] = x;\n    ito.dt[4][1] = q, ito.dt[5][2] = v, ito.dt[6][3] = y;\n    ito.dt[7][1] = r, ito.dt[7][7] = 1;\n    ito.dt[8][1] = t, ito.dt[8][7] = 2, ito.dt[8][8] = ito.dt[8][3] = 1;\n    ito.dt[9][2] = 1, ito.dt[9][9] = w;\n    ito.dt[10][3] = 1, ito.dt[10][10] = z;\n    ito.dt[11][1] = ito.dt[11][7] = ito.dt[11][8] = ito.dt[11][11] = 1, ito.dt[11][3] = 2;\n    a = a * qmi(ito, n - 2);\n    printf(\"nodgd %lld\\nCiocio %lld\\nNicole %lld\", a.dt[1][1], a.dt[1][2], a.dt[1][3]);\n    return 0;\n}\n```",
        "postTime": 1615118329,
        "uid": 277863,
        "name": "BzhH",
        "ccfLevel": 6,
        "title": "\u9898\u89e3P1707 \u5237\u9898\u6bd4\u8d5b"
    },
    {
        "content": "\u611f\u89c9\u6709\u5f88\u591a\u9898\u89e3\u90fd\u662fhe\u6765he\u53bb\u7684\u8bf6\uff08\u8fde\u77e9\u9635\u524d\u540e\u7684\u3010\u3011\u90fd\u4e0d\u6539\n\n| | $a_{k+1}$| $b_{k+1}$| $c_{k+1}$| $a_k$| $b_k$| $c_k$| $k^2$| $w^k$| $z^k$| $k$| $1$| \n| ----:| ----:| ----:| ----:| ----:| ----:| ----:| ----:| ----:| ----:| ----:| ----:| ----:| \n| $a_{k+2}$| $p$| $1$| $1$| $q$| | | $r$| | | $t$| $1$| \n| $b_{k+2}$| $1$| $u$| $1$| | $v$| | | $1$| | | | \n| $c_{k+2}$| $1$| $1$| $x$| | | $y$| | | $1$| $1$| $2$| \n| $a_{k+1}$| $1$| | | | | | | | | | | \n| $b_{k+1}$| | $1$| | | | | | | | | | \n| $c_{k+1}$| | | $1$| | | | | | | | | \n| $(k+1)^2$| | | | | | | $1$| | | $2$| $1$| \n| $w^{k+1}$| | | | | | | | $w$| | | \n| $z^{k+1}$| | | | | | | | | $z$| | \n| $k+1$| | | | | | | | | | $1$| $1$| \n| $1$| | | | | | | | | | | $1$| \n\n\u5565\u90fd\u522b\u8bf4\u4e86\uff0c\u5c31\u8fd9\u6837\u77e9\u9635\u8f6c\u79fb\u3002  \n\u6ce8\u610f\u8981\u7528\u5feb\u901f\u4e58\u6cd5\n\n```cpp\n//\u613f\u4f60\u6709\u4e00\u5929\u80fd\u548c\u4f60\u91cd\u8981\u7684\u4eba\u91cd\u9022\u3002\n//\u5927\u5207\u306a\u4eba\u3068\u3044\u3064\u304b\u307e\u305f\u5de1\u308a\u4f1a\u3048\u307e\u3059\u3088\u3046\u306b\ninline ll MT(ll x,ll y) {}//\u5feb\u901f\u4e58\nstruct mat\n{\n\tll a[15][15];\n\tinline void operator!() {memset(a,0,sizeof(a));}\n\tinline void operator~() {!*this;for(int i=1;i<=11;i++) a[i][i]=1;}\n\tinline mat operator*(mat b)\n\t{\n\t\tmat r;!r;\n\t\tfor(int i=1;i<=11;i++) for(int k=1;k<=11;k++) for(int j=1;j<=11;j++) (r.a[i][j]+=MT(a[i][k],b.a[k][j]))%=P;\n\t\treturn r;\n\t}\n\tinline mat operator^(ll q) {mat r,x=*this;~r;for(;q;q>>=1,x=x*x) if(q&1) r=r*x;return r;}\n}mt;\nint main()\n{\n\tread(n),read(P),read(p),read(q),read(r),read(t),read(u),read(v),read(w),read(x),read(y),read(z);\n\tp%=P,q%=P,r%=P,t%=P,u%=P,v%=P,w%=P,x%=P,y%=P,z%=P;\n\tll brush[15][15]={\n\t\t{p,1,1,q,0,0,r,0,0,t,1},\n\t\t{1,u,1,0,v,0,0,1,0,0,0},\n\t\t{1,1,x,0,0,y,0,0,1,1,2},\n\t\t{1,0,0,0,0,0,0,0,0,0,0},\n\t\t{0,1,0,0,0,0,0,0,0,0,0},\n\t\t{0,0,1,0,0,0,0,0,0,0,0},\n\t\t{0,0,0,0,0,0,1,0,0,2,1},\n\t\t{0,0,0,0,0,0,0,w,0,0,0},\n\t\t{0,0,0,0,0,0,0,0,z,0,0},\n\t\t{0,0,0,0,0,0,0,0,0,1,1},\n\t\t{0,0,0,0,0,0,0,0,0,0,1}};\n\tll yuan[15]={-1,3,3,3,1,1,1,1,w,z,1,1},nw[15];memset(nw,0,sizeof(nw));\n\tfor(int i=1;i<=11;i++) for(int j=1;j<=11;j++) mt.a[i][j]=brush[i-1][j-1];\n\tmt=mt^(n-2);for(int i=1;i<=11;i++) for(int k=1;k<=11;k++) (nw[i]+=1ll*mt.a[i][k]*yuan[k]%P)%=P;\n\treturn printf(\"nodgd %lld\\nCiocio %lld\\nNicole %lld\\n\",nw[1],nw[2],nw[3]),0;\n}\n```",
        "postTime": 1603946491,
        "uid": 44805,
        "name": "Leap_Frog",
        "ccfLevel": 7,
        "title": "P1707\u5237\u9898\u6bd4\u8d5b\uff08\u9898\u89e3\uff09"
    },
    {
        "content": "## \u9898\u610f\u7b80\u8ff0\n\n\u7ed9\u4f60\u4e09\u4e2a\u4e92\u76f8\u4f9d\u8d56\u7684\u9012\u63a8\u5f0f\uff0c\u5206\u522b\u6c42\u503c\u3002\n\n## \u9898\u89e3\n\n\u88f8\u7684\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u6211\u4eec\u628a\u8fd9\u51e0\u4e2a\u4e1c\u897f\u653e\u8fdb\u77e9\u9635\uff1a\n\n$$\nB=\\begin{bmatrix}\na_{k}\\\\\na_{k+1}\\\\\nb_{k}\\\\\nb_{k+1}\\\\\nc_{k}\\\\\nc_{k+1}\\\\\nk^{2}\\\\\nk\\\\\nw^{k}\\\\\n2^{k}\\\\\n1\n\\end{bmatrix}\n$$\n\n\u5219\u521d\u59cb\u77e9\u9635\u4e3a\uff1a\n\n$$\nS=\\begin{bmatrix}\na_{1}\\\\\na_{2}\\\\\nb_{1}\\\\\nb_{2}\\\\\nc_{1}\\\\\nc_{2}\\\\\n1^{2}\\\\\n1\\\\\nw^{1}\\\\\n2^{1}\\\\\n1\n\\end{bmatrix}\n=\\begin{bmatrix}\n1\\\\\n3\\\\\n1\\\\\n3\\\\\n1\\\\\n3\\\\\n1\\\\\n1\\\\\nw\\\\\n2\\\\\n1\n\\end{bmatrix}\n$$\n\n\u8f6c\u79fb\u77e9\u9635\u4e3a\uff1a\n\n$$\nA=\\begin{bmatrix}\n0&1&0&0&0&0&0&0&0&0&0\\\\\nq&p&0&1&0&1&r&t&0&0&1\\\\\n0&0&0&1&0&0&0&0&0&0&0\\\\\n0&1&v&u&0&1&0&0&1&0&0\\\\\n0&0&0&0&0&1&0&0&0&0&0\\\\\n0&1&0&1&y&x&0&1&0&1&2\\\\\n0&0&0&0&0&0&1&2&0&0&1\\\\\n0&0&0&0&0&0&0&1&0&0&1\\\\\n0&0&0&0&0&0&0&0&w&0&0\\\\\n0&0&0&0&0&0&0&0&0&z&0\\\\\n0&0&0&0&0&0&0&0&0&0&1\n\\end{bmatrix}\n$$\n\n\u5219\u6700\u7ec8\u7684\u7b54\u6848\u77e9\u9635\u4e3a\uff1a\n\n$$\nT=A^{n-2}\\times S\n$$\n\n\u7b54\u6848\u7684\u4f4d\u7f6e\u663e\u7136\u3002\n\n\u603b\u7684\u6765\u8bf4\u7b97\u662f\u4e00\u9053\u5957\u8def\u7684\u77e9\u9635\u52a0\u901f\u9898\uff0c\u53ef\u4ee5\u7ed9\u65b0\u624b\u505a\u4e00\u4e0b\u3002\u4e0d\u8fc7\u6211\u8349\u7a3f\u7eb8\u5199z\u6284\u4ee3\u7801\u4e0a\u53bb\u6210\u4e862\u4e5f\u662fnt\u884c\u4e3a\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntemplate < typename Type >\nvoid read( Type& a )\n{\n\ta = 0;\n\tchar ch = getchar( );\n\tbool minus = 0;\n\twhile( !isdigit( ch ) )\n\t{\n\t\tif( ch == '-' ) minus = 1;\n\t\tch = getchar( );\n\t}\n\twhile( isdigit( ch ) )\n\t{\n\t\ta = ( a << 3 ) + ( a << 1 ) + ( ch ^ '0' );\n\t\tch = getchar( );\n\t}\n\tif( minus == 1 ) a = -a;\n}\n\ntemplate < typename Type, typename... Args >\nvoid read( Type& t, Args&... args )\n{\n\tread(t), read(args...);\n}\n\nvoid write( __int128 x )\n{\n\tif( x < 0 )\tputchar( '-' ), x = -x;\n\tif( x > 9 )\twrite( x / 10 );\n\tputchar( x % 10 + '0' );\n}\n\nconst __int128 Maxn = 11;\n__int128 n, m, p, q, r, t, u, v, w, x, y, z;\nstruct Matrix\n{\n\t__int128 mat[ Maxn ][ Maxn ];\n\tMatrix( __int128 x = 0 ) { memset ( mat, x, sizeof ( mat ) ); }\n\n\tMatrix operator * ( const Matrix& rhs ) const\n\t{\n\t\tMatrix ret;\n\t\tfor( __int128 i = 0; i < Maxn; ++ i )\n\t\t\tfor( __int128 j = 0; j < Maxn; ++ j )\n\t\t\t\tfor( __int128 k = 0; k < Maxn; ++ k )\n\t\t\t\t\tret.mat[ i ][ j ] = ( ret.mat[ i ][ j ] + 1ll * mat[ i ][ k ] * rhs.mat[ k ][ j ] ) % m;\n\t\treturn ret;\n\t}\n} unit, meta;\n\nvoid Make_Unit( )\n{\n\tfor ( __int128 i = 0; i < Maxn; ++ i )\n\t\tunit.mat[ i ][ i ] = 1;\n}\n\nvoid Make_Meta( )\n{\n\t__int128 cpy[ Maxn ][ Maxn ] = \n\t{\n\t\t{ 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0 },\n\t\t{ q, p, 0, 1, 0, 1, r, t, 0, 0, 1 },\n\t\t{ 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0 },\n\t\t{ 0, 1, v, u, 0, 1, 0, 0, 1, 0, 0 },\n\t\t{ 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0 },\n\t\t{ 0, 1, 0, 1, y, x, 0, 1, 0, 1, 2 },\n\t\t{ 0, 0, 0, 0, 0, 0, 1, 2, 0, 0, 1 },\n\t\t{ 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1 },\n\t\t{ 0, 0, 0, 0, 0, 0, 0, 0, w, 0, 0 },\n\t\t{ 0, 0, 0, 0, 0, 0, 0, 0, 0, z, 0 },\n\t\t{ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 }\n\t};\n\tmemcpy( meta.mat, cpy, sizeof( cpy ) );\n}\n\nsigned main( )\n{\n\tread( n, m, p, q, r, t, u, v, w, x, y, z );\n\tMake_Unit( ), Make_Meta( );\n\n\t__int128 tS[ Maxn ][ Maxn ] = \n\t{\n\t\t{ 1 }, { 3 }, { 1 }, { 3 }, { 1 }, { 3 }, { 1 }, { 1 }, { w }, { z }, { 1 }\n\t};\n\tMatrix S;\n\tmemcpy( S.mat, tS, sizeof( tS ) );\n\n\t__int128 k = n - 2;\n\tMatrix ret = unit, base = meta;\n\tfor( ; k; k >>= 1, base = base * base )\n\t\tif( k & 1 )\tret = ret * base;\n\tret = ret * S;\n\tprintf( \"nodgd \" ), write( ret.mat[ 1 ][ 0 ] ), putchar( '\\n' );\n\tprintf( \"Ciocio \" ), write( ret.mat[ 3 ][ 0 ] ), putchar( '\\n' );\n\tprintf( \"Nicole \" ), write( ret.mat[ 5 ][ 0 ] ), putchar( '\\n' );\n\treturn 0;\n}\n```",
        "postTime": 1593869263,
        "uid": 161849,
        "name": "cirnovsky",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P1707 \u3010\u5237\u9898\u6bd4\u8d5b\u3011"
    },
    {
        "content": "\u6765\u4e00\u53d1\u5404\u79cd\u9a9a\u4f46\u4ecd\u8f83\u4e3a\u6e05\u6670\u7684\u4ee3\u7801...\n\n\u8fd9\u9053\u9898\u53cd\u6b63\u5c31\u662f\u6784\u9020\u77e9\u9635\u561b\uff0c\u7136\u540e\u5c31\u662f\u4e00\u904d\u56de\u5fc6\u6784\u9020\u77e9\u9635\u7684\u5957\u8def\u4e00\u904d A \u6389\u6b64\u9898\u5c31\u597d\u4e86\n\n\u7136\u540e\u8fd9\u9053\u9898\u7528\u7684\u8868\u8fbe\u5f0f\u4e2d\u53d8\u91cf\u662f\u975e\u5e38\u7684\u591a\uff0c\u6240\u4ee5\u5927\u5bb6\u6784\u9020\u51fa\u6765\u7684\u77e9\u9635\u4f1a\u6709\u7740\u4e00\u4e9b\u5dee\u5f02...\uff08\u6bd4\u5982\u6709\u7684\u4eba\u628a a[k] a[k+1] \u653e\u4e00\u8d77\uff0c\u6709\u4eba\u628a a[k] b[k] c[k] \u653e\u4e00\u8d77\uff09\n\n\u6240\u4ee5\u6284\u9898\u89e3\u5c31\u8d85\u7ea7\u9ebb\u70e6\uff0c\u50cf\u6211\u8fd9\u79cd\u77e9\u9635\u6784\u9020\u5230\u4e00\u534a\u51fa\u9505\u4e86\u770b\u9898\u89e3\u7684\u8868\u793a\u96be\u53d7...\n\n\u7136\u540e\u6211\u7528\u4e86\u9898\u89e3\u91cc\u6784\u9020\u7684\u77e9\u9635\uff0c\u9664\u6b64\u4e4b\u5916\u90fd\u662f\u677f\u5b50...\uff08\u5177\u4f53\u4e00\u70b9\u7684\u89e3\u91ca\u5c31\u653e\u4ee3\u7801\u91cc\u4e86\uff09\n\n\n```\n//by Judge\n#include<cmath>\n#include<cstdio>\n#include<iostream>\n#define ld long double\n#define ll long long\nusing namespace std;\nconst int M=1e5+7;\nll n,mod,p,q,r,t,u,v,w,x,y,z;\ninline void ADD(ll& a,ll b){ //\u5feb\u901f\u52a0\uff0c\u6211\u4e0d\u77e5\u9053\u8bf4\u4e9b\u4ec0\u4e48...\n\ta+=a+b>=mod?b-mod:b;\n}\ninline ll mul(ll a,ll b){ a%=mod,b%=mod; //\u8fd9\u91cc\u662f\u6b63\u5b97\u5feb\u901f\u4e58\uff08\u4ee5\u540e\u522b\u6253\u9f9f\u901f\u4e58\u5566\uff01\uff09\n\treturn (ll)(a*b-(ll)(((ld)a*b+0.5)/mod)*mod)%mod;\n}\nstruct Matrix{ ll a[13][13];  //\u8fd9\u4e2a\u677f\u5b50\u8fd8\u662f\u4e0d\u9519\u7684...\n\tll* operator [](int pos){ return a[pos]; } //\u8fd9\u91cc\u5c31\u662f\u91cd\u8f7d\u4e86'[]'\u8fd9\u4e2a\u7b26\u53f7\uff0c\u4e0b\u9762\u5199\u8d77\u6765\u5c31\u65b9\u4fbf\u5f88\u591a\u4e86\uff08\u6700\u4e3b\u8981\u662f\u4ee3\u7801\u6e05\u6670\u4e86\u6709\u6728\u6709\uff09\n\tMatrix operator *(Matrix& b){ static Matrix c;\n\t\tfor(int i=1;i<=11;++i)\n\t\t\tfor(int j=1;j<=11;++j) c[i][j]=0;\n\t\tfor(int i=1;i<=11;++i) for(int k=1;k<=11;++k)\n\t\t\tfor(int j=1;j<=11;++j) ADD(c[i][j],mul(a[i][k],b[k][j]));\n\t\treturn c;\n\t}\n}A,f[65];\ninline ll qpow(ll x,ll p){ ll s=1;\n\tfor(;p;p>>=1,x=mul(x,x))\n\t\tif(p&1) s=mul(s,x); return s;\n}\nint main(){\n\tscanf(\"%lld%lld%lld%lld%lld%lld\",&n,&mod,&p,&q,&r,&t);\n\tscanf(\"%lld%lld%lld%lld%lld%lld\",&u,&v,&w,&x,&y,&z);\n    /*   \u8fd9\u91cc\u6784\u9020\u77e9\u9635  */\n\tf[0][1][1]=p,f[0][2][1]=q,f[0][3][3]=u,f[0][4][3]=v,\n\tf[0][5][5]=x,f[0][6][5]=y,f[0][7][1]=r,f[0][8][1]=t,\n\tf[0][10][10]=w,f[0][11][11]=z,f[0][8][7]=2,f[0][9][5]=2;\n\tf[0][1][2]=f[0][1][3]=f[0][1][5]=f[0][3][1]=f[0][3][4]=1;\n\tf[0][3][5]=f[0][5][1]=f[0][5][3]=f[0][5][6]=f[0][7][7]=1;\n\tf[0][8][5]=f[0][8][8]=f[0][9][1]=f[0][9][7]=f[0][9][8]=1;\n\tf[0][9][9]=f[0][10][3]=f[0][11][5]=1,\n\t\n    /*      \u8fd9\u91cc\u521d\u59cb\u5316\u7b54\u6848\u77e9\u9635        */\n\tA[1][2]=A[1][4]=A[1][6]=A[1][7]=A[1][8]=A[1][9]=1,\n\tA[1][1]=A[1][3]=A[1][5]=3;\n\tA[1][10]=w,A[1][11]=z,--n;\n\t\n    \n    /*    \u7136\u540e\u662f\u77e9\u9635\u52a0\u901f + \u67e5\u8be2\uff1f      */\n\tfor(int i=1;n>>i;++i) f[i]=f[i-1]*f[i-1];\n\tfor(int i=0;n>>i;++i) if(n>>i&1) A=A*f[i];\n\t\n\tprintf(\"nodgd %lld\\n\",A[1][2]);\n\tprintf(\"Ciocio %lld\\n\",A[1][4]);\n\tprintf(\"Nicole %lld\\n\",A[1][6]);\n\treturn 0;\n}\n```\n\n\n",
        "postTime": 1550753478,
        "uid": 38576,
        "name": "J\u03bcdge",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1707 \u3010\u5237\u9898\u6bd4\u8d5b\u3011"
    },
    {
        "content": "\u548c\u524d\u9762\u8bf4\u7684\u76f8\u4f3c\uff0c1\\*11\u7684\u4e00\u4e2a\u77e9\u9635\u9012\u63a8\u3002\n\na(k) b(k) c(k) a(k+1) b(k+1) c(k+1) k k^2 w^k z^k 1\n\n\u8f6c\u79fb\u77e9\u9635\u5728\u4e0b\u9762.\n\n\u6216\u8bb8\u4ee3\u7801\u770b\u7740\u8212\u670d\u4e9b\u5427\u3002\n\n```cpp\n    #include<iostream>\n    #include<cstdio>\n    #include<cstring>\n    using namespace std;\n    typedef long long ll;\n    ll n,MOD;\n    ll mul(ll h,ll g){\n        ll sum=0;\n        while(g){\n            if(g&1)\n                sum=(sum+h)%MOD;\n            g>>=1;\n            h=(h+h)%MOD;\n        }\n        return sum;\n    }\n    struct mat{\n        ll a[11][11];\n        int l,c;\n        mat operator*(const mat A)const{\n            mat ret;\n            ret.l=l,ret.c=A.c;\n            memset(ret.a,0,sizeof(ret.a));\n            for(int i=0;i<l;i++)\n                for(int j=0;j<A.c;j++)\n                    for(int k=0;k<c;k++)\n                        ret.a[i][j]=(ret.a[i][j]+mul(a[i][k],A.a[k][j]))%MOD;\n            return ret;\n        }\n    }ans,m;\n    int p,q,r,t,u,v,w,x,y,z;\n    int main(){\n        scanf(\"%lld%lld\",&n,&MOD);\n        scanf(\"%d%d%d%d%d%d%d%d%d%d\",&p,&q,&r,&t,&u,&v,&w,&x,&y,&z);\n        ans.l=1,ans.c=11;\n        ll a1[11]={1,1,1,3,3,3,1,1,w,z,1};\n        for(int i=0;i<11;i++)\n            ans.a[0][i]=a1[i];\n        m.l=11,m.c=11;\n        ll a2[11][11]={\n        {0,0,0,q,0,0,0,0,0,0,0},\n        {0,0,0,0,v,0,0,0,0,0,0},\n        {0,0,0,0,0,y,0,0,0,0,0},\n        {1,0,0,p,1,1,0,0,0,0,0},\n        {0,1,0,1,u,1,0,0,0,0,0},\n        {0,0,1,1,1,x,0,0,0,0,0},\n        {0,0,0,t,0,1,1,2,0,0,0},\n        {0,0,0,r,0,0,0,1,0,0,0},\n        {0,0,0,0,1,0,0,0,w,0,0},\n        {0,0,0,0,0,1,0,0,0,z,0},\n        {0,0,0,1,0,2,1,1,0,0,1},\n        };\n        for(int i=0;i<11;i++)\n            for(int j=0;j<11;j++)\n                m.a[i][j]=a2[i][j];\n        n-=2;\n        while(n){\n            if(n&1)\n                ans=ans*m;\n            n>>=1;\n            m=m*m;\n        }\n        printf(\"nodgd %lld\\nCiocio %lld\\nNicole %lld\\n\",ans.a[0][3],ans.a[0][4],ans.a[0][5]);\n        return 0;\n    }\n\n```",
        "postTime": 1515243164,
        "uid": 25247,
        "name": "\u6c6a\u9526\u7a0b",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1707 \u3010\u5237\u9898\u6bd4\u8d5b\u3011"
    }
]
[
    {
        "content": "\u8bbe\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u4e3a $n$\u3002\n\ndp\uff0c$f[i][j][k]$ \u8868\u793a $s[1\\dots i]$ \u901a\u8fc7\u5220\u53bb\u82e5\u5e72\u5b57\u7b26\uff0c\u80fd\u591f\u51d1\u51fa $j$ \u4e2a\u5b8c\u6574\u7684 `bessie`\uff0c\u6700\u540e\u4e00\u4e2a\uff08\u4e0d\u5b8c\u6574\u7684\uff09 `bessie` \u5df2\u7ecf\u51d1\u9f50\u4e86\u524d $k$ \u4f4d\u7684\u6700\u5c0f\u5220\u9664\u4ee3\u4ef7\u548c\u3002\u7b54\u6848\u5373\u4e3a\u6700\u5927\u7684 $j$ \u548c\u5bf9\u5e94\u7684 $f[n][j][0]$\u3002\n\n\u8003\u8651\u5982\u4f55\u8f6c\u79fb\uff1a\n1. \u5220\u9664 $s[i]$\uff0c$f[i][j][k]=f[i-1][j][k]+c[i]$\u3002\n2. \u5982\u679c $s[i]$ \u7b49\u4e8e `bessie` \u4e2d\u7684\u7b2c $k$ \u4e2a\u5b57\u6bcd\uff0c\u90a3\u4e48 $f[i][j][k]=f[i-1][j][k-1]$\uff0c\u4e0d\u9700\u8981\u8f6c\u79fb\u4ee3\u4ef7\u3002\n\n\u5982\u4e0a\u4e24\u79cd\u8f6c\u79fb\u53d6\u6700\u4f18\u5373\u53ef\u3002\n\n\u4f46\u662f\u6211\u4eec\u8fd8\u9700\u8981\u8003\u8651 $k=0$ \u7684 Corner Case\uff1a\n1. \u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u8f6c\u79fb\uff0c\u56e0\u4e3a\u51fa\u73b0\u4e86 `bessie` \u4e2d\u7684\u524d $0$ \u4e2a\u5b57\u6bcd\u5e76\u975e\u771f\u5b9e\u5b58\u5728\uff0c\u6240\u4ee5\u5e76\u4e0d\u9700\u8981\u5220\u9664\u5b57\u6bcd\u6765\u7ef4\u62a4\u8fd9\u4e2a\u6761\u4ef6\uff08\u5b57\u6bcd\u5c31\u653e\u5728\u90a3\u91cc\u5373\u53ef\uff09\uff0c$f[i][j][0]$ \u53ef\u4ee5\u7531 $f[i-1][j][0]$ \u76f4\u63a5\u8f6c\u79fb\u800c\u6765\uff0c\u65e0\u9700\u8f6c\u79fb\u4ee3\u4ef7\u3002\n2. \u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u8f6c\u79fb\uff0c$f[i][j][0]$ \u53ef\u4ee5\u76f4\u63a5\u7531 $f[i][j-1][6]$ \u8f6c\u79fb\u800c\u6765\uff0c\u4e5f\u65e0\u9700\u8f6c\u79fb\u4ee3\u4ef7\u3002\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a $\\mathcal O(n^2)$ \u7684\u89e3\u6cd5\uff0c\u53ef\u4ee5\u901a\u8fc7 $n\\le 2000$ \u7684 Subtask\u3002\u8003\u8651\u4f18\u5316\u3002\n\n\u8003\u8651\u628a $j$ \u8e22\u51fa\u72b6\u6001\uff0c$f[i][k]$ \u8868\u793a $s[1\\dots i]$ \u901a\u8fc7\u5220\u53bb\u82e5\u5e72\u5b57\u7b26\uff0c\u6700\u540e\u4e00\u4e2a\uff08\u4e0d\u5b8c\u6574\u7684\uff09 `bessie` \u5df2\u7ecf\u51d1\u9f50\u4e86\u524d $k$ \u4f4d\u7684**\u6700\u5927\u5b8c\u6574 `bessie` \u6570\u4ee5\u53ca\u5bf9\u5e94\u7684\u6700\u5c0f\u5220\u9664\u4ee3\u4ef7**\u3002\n\n\u6211\u4eec\u628a \u6700\u5927\u5b8c\u6574 `bessie` \u6570 \u4ee5\u53ca \u5bf9\u5e94\u7684\u6700\u5c0f\u5220\u9664\u4ee3\u4ef7 \u7684\u4e8c\u5143\u7ec4\u79f0\u4e3a\u4e00\u4e2a\u6700\u4f18\u65b9\u6848\u3002\u6ce8\u610f\u56e0\u4e3a\u6211\u4eec\u8981\u6c42\u7684\u662f\u4fdd\u8bc1 `bessie` \u6570\u6700\u5927\u7684\u60c5\u51b5\u4e0b\u7684\u6700\u5c0f\u5220\u9664\u4ee3\u4ef7\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u4f18\u5148\u8003\u8651\u6700\u5927\u5316 `bessie` \u6570\uff0c\u6700\u5c0f\u5220\u9664\u4ee3\u4ef7\u4e5f\u662f\u5728\u4fdd\u8bc1\u6700\u5927\u7684 `bessie` \u6570\u524d\u63d0\u4e0b\u7684\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u5f97\u51fa\u548c\u4e0a\u9762\u7c7b\u4f3c\u7684\u8f6c\u79fb\u65b9\u7a0b\uff1a\n1. \u5f53 $s[i]$ \u7b49\u4e8e `bessie` \u4e2d\u7684\u7b2c $k$ \u4e2a\u5b57\u6bcd\u65f6\uff0c$f[i][k]=\\operatorname{best\\ option}(f[i-1][k]+(0,c[i]),f[i-1][k-1])$\u3002\n2. \u5426\u5219\uff0c$f[i][k]=f[i-1][k]+(0,c[i])$\u3002\n3. \u5f53 $k=0$ \u65f6\uff0c$f[i][k]=\\operatorname{best\\ option}(f[i-1][0],f[i][6]+(1,0))$\u3002\n\n\u8fd9\u6837\u72b6\u6001\u5c31\u53d8\u6210 $\\mathcal O(n)$ \u7ea7\u522b\u7684\u4e86\uff0c\u603b\u7684\u590d\u6742\u5ea6 $\\mathcal O(n)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define pii pair<int,int>\n#define il inline\nusing namespace std;\nconst int N=2e5+5;\nint n,c[N];pii f[N][10];\nstring s,b=\" bessie\";\nil pii best_option(pii x,pii y)\n{\n\tif(x.first<y.first)return y;\n\tif(x.first==y.first)\n\t{\n\t\tif(x.second<=y.second)return x;\n\t\treturn y;\n\t}\n\treturn x;\n}\nil pii add(pii x,pii y){return {x.first+y.first,x.second+y.second};}\nsigned main()\n{\n\tcin>>s;n=s.size();s=' '+s;\n\tfor(int i=1;i<=n;++i)cin>>c[i];\n\tfor(int i=0;i<=n;++i)for(int k=0;k<=6;++k)f[i][k]={-1,1e9};\n\tf[0][0]={0,0};\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tfor(int k=1;k<=6;++k)\n\t\t{\n\t\t\tif(s[i]==b[k])f[i][k]=best_option(add(f[i-1][k],{0,c[i]}),f[i-1][k-1]);\n\t\t\telse f[i][k]=add(f[i-1][k],{0,c[i]});\n\t\t}\t\n\t\tf[i][0]=best_option(f[i-1][0],add(f[i][6],{1,0}));\n\t}\n\tcout<<f[n][0].first<<endl<<f[n][0].second;\n\treturn 0;\n}\n```",
        "postTime": 1683097291,
        "uid": 451328,
        "name": "lnwhl",
        "ccfLevel": 6,
        "title": "\u3010\u9898\u89e3\u3011P9190 [USACO23OPEN] Pareidolia G"
    },
    {
        "content": "\u6211\u4eec\u53d1\u73b0 `bessie` \u8fd9\u4e2a\u5355\u8bcd\u662f\u6ca1\u6709 border \u7684\u3002\u4e5f\u5c31\u662f\u8bf4\u6700\u7ec8\u53ef\u4ee5\u628a\u5b57\u7b26\u4e32\u5206\u6bb5\uff0c\u6bcf\u6bb5\u5212\u5206\u51fa\u4e00\u4e2a `bessie`\u3002\n\n\u9996\u5148\u8003\u8651\u600e\u4e48\u7b97\u6700\u591a\u7684 `bessie` \u6570\u91cf\uff0c\u53d1\u73b0\u53ef\u4ee5\u8d2a\u5fc3\uff1a\u6bcf\u6b21\u8d2a\u5fc3\u627e\u4e00\u4e2a\u6700\u77ed\u7684\u540e\u7f00\u4f7f\u5176\u5305\u542b `bessie`\uff0c\u4ee5\u8fd9\u4e2a\u540e\u7f00\u4f5c\u4e3a\u51b3\u7b56\u70b9\u3002\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u9012\u63a8\u51fa\u6bcf\u4e2a\u524d\u7f00\u7684\u6700\u591a `bessie` \u6570\u91cf $f_i$\u3002\u53ea\u9700\u8981\u5224\u65ad\u67d0\u4e2a\u533a\u95f4\u5185\u662f\u5426\u6709 `bessie` \u5b50\u5e8f\u5217\uff0c\u4ee5\u53ca\u6743\u503c\u6700\u5927\u7684 `bessie` \u5b50\u5e8f\u5217\u3002\u7ef4\u62a4\u5b50\u5e8f\u5217\u81ea\u52a8\u673a\u4e4b\u7c7b\u7684\u4e1c\u897f\u8d2a\u5fc3\u8df3\u7b2c\u4e00\u4e2a `e,i,s,s,e,b` \u5c31\u884c\u4e86\u3002\n\n\u8003\u8651\u600e\u4e48\u7b97\u6700\u5c0f\u4ee3\u4ef7\uff0c\u53d1\u73b0\u76f8\u5f53\u4e8e\u6bcf\u6b21\u9009\u4e00\u4e2a $f_j+1=f_i$ \u7684 $j$\uff0c\u8f6c\u79fb\u5230 $g_j+w(j+1,i)$\u3002\u6b64\u65f6\u76f8\u5f53\u4e8e\u8981\u628a $f$ \u5212\u5206\u6210\u82e5\u5e72\u8fde\u7eed\u6bb5\uff0c\u5728\u4e24\u4e2a\u76f8\u90bb\u8fde\u7eed\u6bb5\u4e2d\u505a\u8f6c\u79fb\u3002\u5bf9\u4e8e\u4e24\u4e2a\u8fde\u7eed\u6bb5 $[a,b],[b+1,c]$\uff0c\u6211\u4eec\u8981\u8ba9 $g[a\\cdots b]$ \u8f6c\u79fb\u5230 $g[b+1\\cdots c]$\u3002\n\n\u628a\u8d21\u732e $w(i,j)$ \u62c6\u5f00\uff0c\u53d1\u73b0\u6709\u4e09\u79cd\u60c5\u51b5\uff1a\u9009\u51fa\u7684 `bessie` \u5168\u90fd\u5728 $[b+1,j]$ \u5185\uff0c\u5168\u90fd\u5728 $[i,b]$ \u5185\uff0c\u6216\u8005\u5728\u4e24\u6bb5\u4e4b\u95f4\u3002\u524d\u4e24\u79cd\u5bb9\u6613\u8ba1\u7b97\uff0c\u7b2c\u4e09\u79cd\u53ef\u4ee5\u679a\u4e3e\u5206\u6bb5\u70b9\u4e4b\u540e $O(1)$ \u8ba1\u7b97\u3002\n\n\u8bb0 $L=\\texttt{bessie}$\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u6211\u4eec\u5bf9 $[a,b]$ \u4e2d\u7684\u6bcf\u4e2a $i$ \u7b97\u51fa $c_1(i,l,r)$ \u8868\u793a\u4ece $[i,b]$ \u4e2d\u9009\u51fa $L[l\\cdots r]$\uff0c\u5e76\u5220\u6389\u67d0\u4e9b\u5b57\u7b26\u4f7f\u5f97 $L[l\\cdots r]$ \u8fde\u7eed\u4e14\u7d27\u8d34\u53f3\u7aef\u70b9\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\u8f6c\u79fb\u65f6\u53ea\u9700\u8981\u8ba8\u8bba\u662f\u5426\u6709 $s[i]=L[l]$ \u5373\u53ef\u3002\u518d\u7b97\u51fa $c_2(i,l)$ \u8868\u793a\u4ece $[i,b]$ \u4e2d\u9009\u51fa $L[l\\cdots 6]$\uff0c\u5e76\u5220\u6389\u67d0\u4e9b\u5b57\u7b26\u4f7f\u5f97 $L[l\\cdots 6]$ \u8fde\u7eed\u4f46\u4e0d\u5fc5\u7d27\u8d34\u53f3\u7aef\u70b9\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\u5728\u53f3\u8fb9\u4e5f\u505a\u4e00\u904d\u7c7b\u4f3c\u7684 DP \u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6\u5927\u6982\u662f $O(n|\\Sigma|+n|L|^2)$\uff0c\u5176\u4e2d $|L|=|\\texttt{bessie}|=6$\u3002\n\n\u611f\u89c9\u8fd9\u4e2a\u505a\u6cd5\u6bd4\u8f83\u4e11\uff0c\u5982\u679c\u6709\u66f4\u4f18\u7f8e\u7684\u505a\u6cd5\u6233\u6211\u4e00\u4e0b\u8c22\u8c22\u55b5\u3002\n\n```cpp\n#include<bits/stdc++.h>\n\n#define int long long\n\nusing namespace std;\n\ninline int read(){\n\tint x=0,f=1;char c=getchar();\n\tfor(;(c<'0'||c>'9');c=getchar()){if(c=='-')f=-1;}\n\tfor(;(c>='0'&&c<='9');c=getchar())x=x*10+(c&15);\n\treturn x*f;\n}\n\nconst int mod=1e9+7;\nint ksm(int x,int y,int p=mod){\n\tint ans=1;\n\tfor(int i=y;i;i>>=1,x=1ll*x*x%p)if(i&1)ans=1ll*ans*x%p;\n\treturn ans%p;\n}\nint inv(int x,int p=mod){return ksm(x,p-2,p)%p;}\nint randint(int l,int r){return rand()*rand()%(r-l+1)+l;}\nvoid add(int &x,int v){x+=v;if(x>=mod)x-=mod;}\nvoid Mod(int &x){if(x>=mod)x-=mod;}\n\nconst int N=2e5+5;\nconst int D=30;\nchar s[N];\nint n,cost[N],f[N],g[N],pre[N][D],pos[D],cur[N];\n\n//bessie\nchar t[6]={'b','e','s','s','i','e'};\nint calc(int p){\n\tfor(int i=5;i>=0&&p>=0;i--)p=pre[p][t[i]-'a']-1;\n\treturn p;\n}\n\nint cl1[N][7][7],cl2[N][7],cr1[N][7][7],cr2[N][7],mv[7];\nconst int INF=1e9;\n\nvoid solve(int l,int mid,int r){\n\t\n\tfor(int i=0;i<=6;i++)for(int j=0;j<=6;j++)cl1[mid+1][i][j]=INF;\n\tcl2[mid+1][6]=0;for(int i=0;i<6;i++)cl2[mid+1][i]=INF;\n\tfor(int i=mid;i>=l;i--){\n\t\tfor(int j=0;j<6;j++){\n\t\t\tcl2[i][j]=cl2[i+1][j];\n\t\t\tif(j!=0)cl2[i][j]+=cost[i];\n\t\t\tif(s[i]==t[j])cl2[i][j]=min(cl2[i][j],cl2[i+1][j+1]);\n\t\t}\n\t\tcl2[i][6]=cl2[i+1][6];\n\t}\n\tfor(int k=1;k<=6;k++){//cl1[i][j][k] \uff1a\u4ece [i...mid] \u4e2d\u9009\u4e00\u4e2a\u5b50\u4e32 L[j...k-1] \n\t\tcl1[mid+1][k][k]=0;\n\t\tfor(int i=mid;i>=l;i--){\n\t\t\tfor(int j=0;j<k;j++){\n\t\t\t\tcl1[i][j][k]=cl1[i+1][j][k];\n\t\t\t\tif(j!=0)cl1[i][j][k]+=cost[i];\n\t\t\t\tif(s[i]==t[j])cl1[i][j][k]=min(cl1[i][j][k],cl1[i+1][j+1][k]);\n\t\t\t}\n\t\t\tcl1[i][k][k]=cl1[i+1][k][k]+cost[i];\n\t\t}\n\t}\n\t\n\tfor(int i=0;i<=6;i++)for(int j=0;j<=6;j++)cr1[mid][i][j]=INF;\n\tcr2[mid][0]=0;for(int i=1;i<=6;i++)cr2[mid][i]=INF;\n\tfor(int i=mid+1;i<=r;i++){\n\t\tfor(int j=1;j<=6;j++){\n\t\t\tcr2[i][j]=cr2[i-1][j];\n\t\t\tif(j!=6)cr2[i][j]+=cost[i];\n\t\t\tif(s[i]==t[j-1])cr2[i][j]=min(cr2[i][j],cr2[i-1][j-1]);\n\t\t}\n\t\tcr2[i][0]=cr2[i-1][0];\n\t}\n\tfor(int j=0;j<6;j++){\n\t\tcr1[mid][j][j]=0;\n\t\tfor(int i=mid+1;i<=r;i++){\n\t\t\tfor(int k=j+1;k<=6;k++){\n\t\t\t\tcr1[i][j][k]=cr1[i-1][j][k];\n\t\t\t\tif(k!=6)cr1[i][j][k]+=cost[i];\n\t\t\t\tif(s[i]==t[k-1])cr1[i][j][k]=min(cr1[i][j][k],cr1[i-1][j][k-1]);\n\t\t\t}\n\t\t\tcr1[i][j][j]=cr1[i-1][j][j]+cost[i];\n\t\t}\n\t}\n\t\n\tfor(int j=0;j<=6;j++)mv[j]=INF;\n\tfor(int i=l;i<=mid;i++){\n\t\tfor(int j=1;j<=5;j++)mv[j]=min(mv[j],g[i]+cl1[i][0][j]);\n\t\tmv[6]=min(mv[6],g[i]+cl2[i+1][0]),mv[0]=min(mv[0],g[i]);\n\t}\n\tfor(int i=mid+1;i<=r;i++){\n\t\tg[i]=mv[0]+cr2[i][6];g[i]=min(g[i],mv[6]);\n\t\tfor(int j=1;j<=5;j++)g[i]=min(g[i],mv[j]+cr1[i][j][6]);\n\t}\n}\n\nint L[N],R[N];\n\nsigned main(void){\n\n#ifdef YUNQIAN\n\tfreopen(\"in.in\",\"r\",stdin);\n#endif\n\n\tcin>>(s+1);n=strlen(s+1);\n\tfor(int i=1;i<=n;i++)cost[i]=read();\n\t\n\tfor(int i=1;i<=n;i++){\n\t\tpos[s[i]-'a']=i;\n\t\tfor(int j=0;j<26;j++)pre[i][j]=pos[j];\n\t}\n\t\n\tfor(int i=1;i<=n;i++)if(calc(i)>=0)f[i]=f[calc(i)]+1;\n\tcout<<f[n]<<endl;\n\t\n\tmemset(L,63,sizeof(L));\n\tfor(int i=1;i<=n;i++)L[f[i]]=min(L[f[i]],i),R[f[i]]=i;\n\tfor(int i=0;i<f[n];i++)solve(L[i],R[i],R[i+1]);\n\tcout<<g[n]<<endl;\n\n\treturn 0;\n}\n```",
        "postTime": 1681789664,
        "uid": 307453,
        "name": "\u4e91\u6d45\u77e5\u5904",
        "ccfLevel": 6,
        "title": "P9190"
    }
]
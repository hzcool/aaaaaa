[
    {
        "content": "\u628a\u9898\u9762\u8bf4\u6e05\u695a\u70b9:\n\n\u7ed9\u5b9a\u4e00\u4e2a\u5927\u5c0f\u4e3a $n\\times m$ \u7684\u77e9\u9635 $A$\uff0c\u8ba9\u4f60\u6c42\u4e00\u4e2a\u5927\u5c0f\u76f8\u540c\u7684\u77e9\u9635 $B$\uff0c\u8981\u6c42 $B_{i,j}\\in[L,R]$\uff0c\u8bbe\u77e9\u9635 $C$ \u4e3a $C_{i,j}=A_{i,j}-B_{i,j}$\uff0c\u6700\u5c0f\u5316 $C$ \u6bcf\u4e00\u884c\u7684**\u548c\u7684\u7edd\u5bf9\u503c**\uff0c\u4ee5\u53ca\u6bcf\u4e00\u5217\u7684**\u548c\u7684\u7edd\u5bf9\u503c**\u7684\u6700\u5927\u503c\u3002\n\n\u8bbe $sumh_i$ \u8868\u793a $\\sum_{j=1}^m A_{i,j}$\uff0c\u8bbe $suml_i$ \u8868\u793a $\\sum_{j=1}^n A_{j,i}$ \u3002\n\n\u8003\u8651\u4e8c\u5206\u7b54\u6848\uff0c\u90a3\u4e48\u4e5f\u5c31\u662f\u8981\u6c42 $|\\sum A_{i,j}-\\sum B_{i,j}|\\le mid$ \u3002\n\n\u5c06\u7edd\u5bf9\u503c\u5206\u60c5\u51b5\u8ba8\u8bba\uff0c\u5f97\u5230 $\\sum B_{i,j}$ \u7684\u8303\u56f4\u662f $[\\sum A_{i,j}-mid,\\sum A_{i,j}+mid]$\uff0c\u4e5f\u5c31\u662f\u8bf4\u6bcf\u4e00\u884c $B$ \u7684\u548c\u9700\u8981\u662f $[-mid,mid]+sumh_i$\uff0c\u5217\u4e5f\u540c\u7406\u3002\n\n\u8003\u8651\u7528\u6709\u6e90\u6c47\u6709\u4e0a\u4e0b\u754c\u53ef\u884c\u6d41\u9a8c\u8bc1\uff0c\u5c06\u6bcf\u4e00\u884c\uff0c\u548c\u6bcf\u4e00\u5217\u5355\u72ec\u5f00\u4e00\u4e2a\u70b9\u3002 $S$ \u5411\u6bcf\u4e00\u884c\u8fde $[sumh_i-mid,sumh_i + mid]$ \u7684\u8fb9\uff0c\u6bcf\u4e00\u5217\u5411 $T$ \u8fde $[suml_i-mid,suml_i + mid]$ \u7684\u8fb9\uff0c\u5bf9\u5e94\u7684\u6bcf\u4e00\u884c\u548c\u6bcf\u4e00\u5217\u8fde $[L,R]$ \u7684\u8fb9\u3002\n\n\u5982\u679c\u5b58\u5728\u53ef\u884c\u6d41\uff0c\u90a3\u4e48\u6211\u4eec\u6784\u9020\u7684 $B$ \u77e9\u9635\u5c31\u662f\uff1a $B_{i,j}$ \u4e3a\u7b2c $i$ \u884c\u62bd\u8c61\u51fa\u6765\u7684\u70b9\u5411\u7b2c $j$ \u5217\u62bd\u8c61\u51fa\u6765\u7684\u70b9\u6700\u540e\u7684\u6d41\u91cf\uff0c\u663e\u7136\u5355\u70b9\u7684\u8981\u6c42\u548c\u884c\u5217\u7684\u8981\u6c42\u90fd\u4f1a\u88ab\u6ee1\u8db3\u3002\n\n\u5173\u4e8e\u4e8c\u5206\u7684\u5408\u6cd5\u6027\uff0c\u663e\u7136\u662f\u5dee\u8d8a\u5927\u8d8a\u5bb9\u6613\u6784\u9020\u3002\u4ece\u53e6\u4e00\u4e2a\u89d2\u5ea6\u53bb\u60f3\uff0c\u6700\u540e\u91cd\u5efa\u56fe\u7684\u4e0a\u4e0b\u754c\u7f51\u7edc\u6d41\u5176\u5b9e\u8fb9\u7684\u5bb9\u91cf\u5c31\u662f $2mid$\uff0c\u663e\u7136 $2mid$ \u8d8a\u5927\u8d8a\u5bb9\u6613\u627e\u5230\u89e3\u3002\n\n```C++\n#include <cmath>\n#include <cstdio>\n#include <cctype>\n#include <cstdlib>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\n#define N 405\n#define M 100005\n#define inf 2000000000\nusing namespace std;\n\ninline int rd() {\n  int x = 0;\n  char c = getchar();\n  while (!isdigit(c)) c = getchar();\n  while (isdigit(c)) {\n    x = x * 10 + (c ^ 48); c = getchar();\n  }\n  return x;\n}\n\n\nint n, m, s, t, S, T, tot, hd[N], dlt[N];\n\nstruct E{int to, nxt, f, mnf;} e[M << 1];\n\ninline void add(int u, int v, int f) {\n  e[++tot].to = v; e[tot].f = f; e[tot].nxt = hd[u]; hd[u] = tot;\n  e[++tot].to = u; e[tot].f = 0; e[tot].nxt = hd[v]; hd[v] = tot;\n}\n\ninline void adde(int u, int v, int mnf, int mxf) {\n  add(u, v, mxf - mnf);\n  e[tot - 1].mnf = mnf;\n  dlt[v] += mnf; dlt[u] -= mnf;\n}\n\nstruct Q {\n  int a[N << 1], hd, tl;\n  inline void pop() {++hd;}\n  inline int front() {return a[hd];}\n  inline void reset() {hd = 1; tl = 0;}\n  inline void push(int x) {a[++tl] = x;}\n  inline bool empty() {return hd > tl;}\n} q;\n\nint d[N], h[N];\n\ninline bool bfs() {\n  memset(d, 0, sizeof(d));\n  q.reset(); q.push(S); d[S] = 1;\n  while (!q.empty()) {\n    int u = q.front(); q.pop();\n    for (int i = hd[u], v; i; i = e[i].nxt)\n      if (!d[v = e[i].to] && e[i].f) {\n        d[v] = d[u] + 1; q.push(v);\n      }\n  }\n  return d[T] > 0;\n}\n\nint dfs(int u, int flow) {\n  if (u == T || !flow) return flow;\n  int res = 0, tmp;\n  for (int &i = h[u], v; i; i = e[i].nxt)\n    if (d[v = e[i].to] == d[u] + 1 && e[i].f) {\n      tmp = dfs(v, min(e[i].f, flow - res));\n      if (!tmp) {d[v] = -1; continue;}\n      res += tmp; e[i].f -= tmp; e[i ^ 1].f += tmp;\n      if (res == flow) return res;\n    }\n  return res;\n}\n\ninline int dinic() {\n  int totf = 0;\n  while (bfs()) {\n    memcpy(h, hd, sizeof(hd));\n    totf += dfs(S, inf);\n  }\n  return totf;\n}\n\nint L, R, a[N][N], sumh[N], suml[N];\n\ninline bool valid(int mid) {\n  tot = 1;\n  memset(hd, 0, sizeof(hd));\n  memset(dlt, 0, sizeof(dlt));\n  int sum = 0;\n  s = 0; t = n + m + 1;\n  for (int i = 1; i <= n; ++i) {\n    adde(s, i, sumh[i] - mid, sumh[i] + mid);\n    for (int j = 1; j <= m; ++j) adde(i, j + n, L, R);\n  }\n  for (int i = 1; i <= m; ++i)\n    adde(i + n, t, suml[i] - mid, suml[i] + mid);\n  add(t, s, inf);\n  S = N - 2; T = N - 1;\n  for (int i = s; i <= t; ++i)\n    if (dlt[i] > 0) {\n      add(S, i, dlt[i]); sum += dlt[i];\n    }\n    else if (dlt[i] < 0) add(i, T, -dlt[i]);\n  return dinic() == sum;\n}\n\nint main() {\n  n = rd(); m = rd();\n  for (int i = 1; i <= n; ++i)\n    for (int j = 1, x; j <= m; ++j) {\n      x = rd(); sumh[i] += x; suml[j] += x;\n    }\n  L = rd(); R = rd();\n  int l = 0, r = 400000, mid;\n  while (l < r) {\n    mid = (l + r) >> 1;\n    valid(mid) ? r = mid : l = mid + 1;\n  }\n  printf(\"%d\\n\", l);\n  return 0;\n}\n\n```",
        "postTime": 1553917069,
        "uid": 56839,
        "name": "SGColin",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4194 \u3010\u77e9\u9635\u3011"
    },
    {
        "content": "\u672c\u8d28\u4e0a\u662f\u8981\u6784\u9020\u4e00\u4e2a\u503c\u57df\u5728 $[L,R]$ \u7684\u77e9\u9635 $B$\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u884c\u6bcf\u4e00\u5217\uff0c\u4f7f\u5f97 \u884c\u6216\u5217\u5185 $|\\sum A-\\sum B|$ \u7684\u6700\u5927\u503c\u6700\u5c0f\u3002\n\n\u8fd9\u4e2a\u6700\u5927\u503c\u6700\u5c0f\u53ef\u4ee5\u60f3\u5230\u4e8c\u5206\uff0c\u7531\u4e8e $A$ \u5b8c\u5168\u5df2\u77e5\uff0c\u8fd9\u6837\u5b9e\u9645\u4e0a\u9650\u5236\u4e86 $B$ \u6bcf\u4e00\u884c\u6bcf\u4e00\u5217\u7684\u548c\u8303\u56f4\u5728 $[sum-mid,sum+mid]$ \u4e4b\u95f4\uff0c\u800c\u6bcf\u4e2a\u683c\u5b50\u7684\u503c\u5728 $[L,R]$ \u4e4b\u95f4\uff0c\u8003\u8651\u6709\u6e90\u6c47\u4e0a\u4e0b\u754c\u53ef\u884c\u6d41\u3002\n\n\u6e90\u70b9\u5411\u8868\u793a\u884c\u7684\u70b9\u8fde\u8fb9\uff0c\u4e0a\u4e0b\u754c\u5982\u4e0a\u6240\u8ff0\uff0c\u8868\u793a\u5217\u7684\u70b9\u5411\u6c47\u70b9\u8fde\u8fb9\uff0c\u4e0a\u4e0b\u754c\u540c\u7406\u3002\u5176\u4f59\u4e24\u70b9\u4e4b\u95f4\u8fde $[L,R]$ \u7684\u8fb9\u3002\n\n\u63d0\u4e00\u5634\u6709\u6e90\u6c47\u4e0a\u4e0b\u754c\u53ef\u884c\u6d41\u600e\u4e48\u505a\u3002\n\n\u57fa\u7840\u662f\u65e0\u6e90\u6c47\u53ef\u884c\u6d41\uff0c\u5047\u5b9a\u5168\u90fd\u4ee5\u4e0b\u754c\u4e3a\u6d41\u91cf\uff0c\u5efa\u8d85\u7ea7\u6e90\u70b9\u8d85\u7ea7\u6c47\u70b9\uff0c\u8d85\u7ea7\u6e90\u70b9\u8fde\u6d41\u5165\u66f4\u591a\u7684\uff0c\u8d85\u7ea7\u6c47\u70b9\u8fde\u6d41\u51fa\u66f4\u591a\u7684\uff08\u5b9e\u9645\u4e0a\u5c31\u4ee3\u66ff\u4e86\u4e0b\u754c\u7684\u7f51\u7edc\uff09\uff0c\u8fd9\u6837\u8dd1\u6700\u5927\u6d41\uff0c\u5982\u679c\u80fd\u6d41\u6ee1\u8d85\u7ea7\u6e90\u70b9\u6d41\u51fa\u7684\u8fb9\uff0c\u5c31\u8bf4\u660e\u662f\u53ef\u884c\u7684\u3002\n\n\u800c\u6709\u6e90\u6c47\u53ea\u9700\u8981\u8ba9\u6d41\u91cf\u50cf\u65e0\u6e90\u6c47\u4e00\u6837\u8f6c\u8d77\u6765\uff0c\u4e8e\u662f\u6c47\u70b9\u5411\u6e90\u70b9\u8fde\u4e00\u6761\u6ca1\u6709\u9650\u5236\u7684\u8fb9\u5373\u53ef\u3002\uff08\u82e5\u8981\u6c42\u4e00\u4e2a\u53ef\u884c\u6d41\u6d41\u91cf\uff0c\u90a3\u4e48\u8fd9\u6761\u8fb9\u7684\u6d41\u91cf\u5373\u4e3a\u6240\u6c42\uff09",
        "postTime": 1671023085,
        "uid": 321177,
        "name": "SoyTony",
        "ccfLevel": 6,
        "title": "P4194 \u9898\u89e3"
    },
    {
        "content": "[LINK](https://www.luogu.com.cn/problem/P4194)\n\n\u627e\u4e00\u4e2a\u77e9\u9635$B$\u4f7f\u5f97\u6bcf\u4e2a\u5143\u7d20\u90fd\u5728$[L,R]$\u5185\n\n\u8bbe\u77e9\u9635$C=A-B$\n\n\u6700\u5c0f\u5316$C$\u7684\u6bcf\u4e00\u5217\u548c\u7684\u7edd\u5bf9\u503c,\u6bcf\u4e00\u884c\u548c\u7684\u7edd\u5bf9\u503c\u7684\u6700\u5927\u503c\n\n---\n\n\u8003\u8651\u6700\u540e\u7684\u7b54\u6848\u662f$mid$\n\n\u90a3\u4e48$C$\u7684\u6bcf\u4e00\u884c$sumh_i$\u7edd\u5bf9\u503c\u4e4b\u548c,\u6bcf\u4e00\u5217$suml_i$\u7edd\u5bf9\u503c\u4e4b\u548c\u90fd\u5c0f\u4e8e\u7b49\u4e8e$mid$\n\n\u4e5f\u5c31\u662f$|\\sum\\limits_{j=1}^m A_{i,j}-\\sum\\limits_{j=1}^mB_{i,j}|<=mid$\n\n\u6362\u53e5\u8bdd\u8bf4,\u6211\u4eec\u5f97\u5230$\\sum\\limits_{j=1}^mB_{i,j}\\in[\\sum\\limits_{j=1}^mA_{i,j}-mid,\\sum\\limits_{j=1}^m A_{i,j}+mid]$\n\n\u5bf9\u884c,\u5217\u90fd\u662f\u7c7b\u4f3c\u7684\u8fd9\u4e2a\u5f0f\u5b50\n\n**\u4e8e\u662f\u6211\u4eec\u53d1\u73b0,\u867d\u7136\u6700\u540e\u7684\u7b54\u6848\u6ca1\u6709\u5355\u8c03\u6027,\u4f46\u662f\u7b54\u6848\u7684\u8303\u56f4\u6709\u5355\u8c03\u6027**\n\n\u4e5f\u5c31\u662f\u8bf4\u5982\u679c\u7b54\u6848\u6ee1\u8db3$|\\sum\\limits_{j=1}^m A_{i,j}-\\sum\\limits_{j=1}^mB_{i,j}|<=mid$\n\n\u90a3\u4e48\u4e5f\u4e00\u5b9a\u6ee1\u8db3$|\\sum\\limits_{j=1}^m A_{i,j}-\\sum\\limits_{j=1}^mB_{i,j}|<=mid+1$\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u4e8c\u5206\u8fd9\u4e2a$mid$,\u5224\u65ad\u6bcf\u4e00\u884c\u6bcf\u4e00\u5217\u7684\u548c\u662f\u5426\u53ef\u4ee5\u5728\u8fd9\u4e2a\u8303\u56f4\u5185\n\n\u90a3\u4e48\u4e3a\u4e86\u6ee1\u8db3\u8fd9\u4e9b\u9650\u5236....\u6211\u4eec\u53ef\u4ee5\u7528\u4e0a\u4e0b\u754c\u7f51\u7edc\u6d41!!!\n\n\u65b0\u5efa\u6e90\u70b9\u8fde\u5411\u6bcf\u4e00\u884c,\u6d41\u91cf\u4e3a\u5bf9\u5e94\u7684\u533a\u95f4\n\n\u6bcf\u4e00\u5217\u6d41\u5411\u65b0\u5efa\u6c47\u70b9,\u6d41\u91cf\u4e3a\u5bf9\u5e94\u533a\u95f4\n\n\u6bcf\u4e00\u884c\u5411\u6bcf\u4e00\u5217\u8fde\u8fb9\u6d41\u91cf\u4e3a$[L,R]$,\u8868\u793a\u5728\u8fd9\u4e2a\u683c\u5b50\u4e0a\u586b\u4ec0\u4e48\u6570\u5b57\n\n\u90fd\u662f\u677f\u5b50,\u5177\u4f53\u53ef\u4ee5\u770b\u4ee3\u7801\u4e86\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\nconst int maxn = 2e5+10;\nconst int inf = 2e9;\nstruct edge{\n\tint to,nxt,flow;\n}d[maxn]; int head[maxn],cnt=1;\nint in[maxn],out[maxn],n,m,s,t,ss,tt,L,R;\nint a[209][209],sumh[209],suml[209];\nvoid add(int u,int v,int l,int r)\n{\n\tl = max(0ll,l);\n\tin[v] += l, out[u] += l;\n\td[++cnt] = ( edge ){v,head[u],r-l},head[u] = cnt;\n\td[++cnt] = ( edge ){u,head[v],0},head[v] = cnt;\n}\nint dis[maxn];\nbool bfs(int s,int t,int mx)\n{\n\tfor(int i=0;i<=mx;i++)\tdis[i] = 0;\n\tqueue<int>q; q.push( s ); dis[s] = 1;\n\twhile( !q.empty() )\n\t{\n\t\tint u = q.front(); q.pop();\n\t\tfor(int i=head[u];i;i=d[i].nxt )\n\t\t{\n\t\t\tint v = d[i].to;\n\t\t\tif( d[i].flow && dis[v]==0 )\n\t\t\t{\n\t\t\t\tdis[v] = dis[u]+1;\tq.push( v );\n\t\t\t\tif( v==t )\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\nint dinic(int u,int t,int flow)\n{\n\tint res = flow;\n\tif( u==t )\treturn res;\n\tfor(int i=head[u];i && res;i=d[i].nxt )\n\t{\n\t\tint v = d[i].to;\n\t\tif( d[i].flow && dis[v]==dis[u]+1 )\n\t\t{\n\t\t\tint temp = dinic(v,t,min(d[i].flow,res) );\n\t\t\tif( temp==0 )\tdis[v] = 0;\n\t\t\td[i].flow -= temp, d[i^1].flow += temp;\n\t\t\tres -= temp;\n\t\t}\n\t}\n\treturn flow-res;\n}\nvector<int>vec[maxn];\nbool isok(int lim)\n{\n\ts = n+m+1, t = s+1, ss = t+1, tt = ss+1;\n\tfor(int i=1;i<=n;i++)\n\tfor(int j=1;j<=m;j++)\n\t\tadd(i,n+j,L,R);\n\tfor(int i=1;i<=n;i++)\tadd(s,i,sumh[i]-lim,sumh[i]+lim);\n\tfor(int i=1;i<=m;i++)\tadd(i+n,t,suml[i]-lim,suml[i]+lim);\n\tadd(t,s,0,inf);\n\tint ans = 0;\n\tfor(int i=1;i<=t;i++)\n\t{\n\t\tif( in[i]>out[i] )\tadd(ss,i,0,in[i]-out[i]),ans += in[i]-out[i];\n\t\telse\tadd(i,tt,0,out[i]-in[i]);\n\t}\n\twhile( bfs(ss,tt,tt) )\tans -= dinic(ss,tt,inf);\n\tcnt = 1;\n\tfor(int i=1;i<=tt;i++)\thead[i] = in[i] = out[i] = 0;\n\treturn ans==0;\n}\nsigned main()\n{\n\tcin >> n >> m;\n\tfor(int i=1;i<=n;i++)\n\tfor(int j=1;j<=m;j++)\n\t{\n\t\tcin >> a[i][j];\n\t\tsumh[i] += a[i][j],suml[j] += a[i][j];\n\t}\n\tcin >> L >> R ;\n\tint l = 0, r = 1e8, ans = 0;\n\twhile( r>=l )\n\t{\n\t\tint mid = ( l+r ) >> 1;\n\t\tif( isok(mid) )\tr = mid-1, ans = mid;\n\t\telse\tl = mid+1;\n\t}\n\tcout << ans;\n}\n\n```",
        "postTime": 1617514082,
        "uid": 299810,
        "name": "issue_is_fw",
        "ccfLevel": 0,
        "title": "P4194 \u77e9\u9635"
    },
    {
        "content": "\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u60f3\u7684\u662f\u6709\u6e90\u65e0\u6c47\u3002~~\u5176\u5b9e\u52a0\u4e2a\u6c47\u4e5f\u5c31\u662f\u6709\u6e90\u6c47\u4e86\u3002~~     \n\n\u56e0\u4e3a\u63d0\u524d\u77e5\u9053\u8fd9\u9053\u9898\u662f\u7f51\u7edc\u6d41\u6240\u4ee5\u5c31~~\u51b2~~\u8fc7\u6765\u4e86\uff0c\u770b\u5b8c\u9898\u540e\u6709\u70b9\u61f5\uff0c\u6700\u5c0f\u503c\uff0c\u6700\u5c0f\u6d41\uff1f\u6709\u70b9\u6478\u4e0d\u7740\u5934\u8111\u3002    \n\n\u4ed4\u7ec6\u601d\u8003\u4e86\u4e00\u4e0b\uff0c\u53d1\u73b0\u8fd9\u9053\u9898\u7684\u7b54\u6848\u5177\u6709\u5355\u8c03\u6027\uff0c\u5373\u5982\u679c\u4e00\u4e2a\u7b54\u6848 $res$ \u53ef\u4ee5\u88ab\u6784\u9020\u51fa\u6765\uff0c\u90a3\u4e48\u6bd4 $res$ \u5927\u7684\u6570\u4e5f\u80af\u5b9a\u4f1a\u53ef\u80fd\u6784\u9020\u51fa\u6765\uff0c\u6240\u4ee5\u8003\u8651\u4e8c\u5206\u7b54\u6848\u3002    \n\n\u800c\u6211\u4eec\u672c\u8eab\u5c31\u77e5\u9053 $A$ \u77e9\u9635\u91cc\u9762\u7684\u884c\u5217\u5143\u7d20\u4e4b\u548c\uff0c\u73b0\u5728\u53ea\u8981\u770b\u5f53\u524d\u80fd\u5426\u628a $B$ \u77e9\u9635\u91cc\u9762\u7684\u884c\u5217\u5143\u7d20\u4e4b\u548c\u63a7\u5236\u5728\u4e00\u4e2a\u8303\u56f4\u5185\uff0c\u5c31\u53ef\u4ee5\u5224\u65ad\u5f53\u524d\u7684\u7b54\u6848\u662f\u5426\u5408\u6cd5\uff0c\u8bf6\u611f\u89c9\u8fd9\u597d\u50cf\u662f\u53ef\u884c\u6d41\uff1f\n\n\u60f3\u5230\u8fd9\u91cc\u540e\u9762\u601d\u8def\u5c31\u5f88\u6e05\u6670\u4e86\uff0c\u201c\u9650\u5236\u201d\u7684\u8bdd\u5bf9\u5e94\u7684\u5c31\u662f\u53ef\u884c\u6d41\uff0c\u6211\u4eec\u53ea\u8981\u628a\u5f53\u524d\u7684\u6240\u6709\u9650\u5236\u90fd\u653e\u5230\u8fb9\u4e0a\u53bb\uff0c\u7136\u540e\u53ea\u8981\u6709\u4e2a\u6d41\u53ef\u884c\uff0c\u4e0d\u5c31\u76f8\u5f53\u4e8e\u544a\u77e5\u8fd9\u4e2a\u7b54\u6848\u53ef\u884c\u5417\uff1f  \n\n\u5728\u8fd9\u91cc\u5148\u8981\u8bb2\u4e2a\u8fd9\u79cd\u9898\u7684\u5957\u8def\uff1a\u5bf9\u4e8e\u8fd9\u79cd\u9898\u76ee\uff0c\u56e0\u4e3a\u6211\u4eec\u77e9\u9635\u4e2d\u7684\u4e00\u4e2a\u5143\u7d20\u7684\u53d6\u503c\u8981\u5f71\u54cd\u4e00\u4e2a\u884c\u548c\u4e00\u4e2a\u5217\u7684\u7ed3\u679c\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u5efa\u56fe\u7684\u65f6\u5019\u5bf9\u4e8e\u77e9\u9635\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u5efa\u8fb9\u65f6\u5f53\u524d\u5143\u7d20\u7684\u6d41\u91cf\u4e00\u5b9a\u5f97\u662f\u7531\u8bb0\u5f55\u8be5\u884c\u4e4b\u548c\u7684\u8282\u70b9\u4f20\u4e0b\u6765\uff0c\u7136\u540e\u8fd9\u4e2a\u5143\u7d20\u6d41\u91cf\u6d41\u7ed9\u8be5\u5217\u4e4b\u548c\u7684\u8282\u70b9\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5b8c\u7f8e\u89e3\u51b3\u5bb9\u91cf\u9650\u5236\u3002\n\n\u6709\u4e86\u8fd9\u4e2a\u5957\u8def\u8fd9\u9053\u9898\u5c31\u6709\u529e\u6cd5\u5207\u4e86\uff0c\u9996\u5148\u6211\u4eec\u6765\u4e2a\u5927\u6e90\u70b9 $S$ \u7ed9\u6240\u6709\u8bb0\u5f55\u884c\u4e4b\u548c\u7684\u8282\u70b9\u8f93\u9001\u6d41\u91cf\uff0c\u63a5\u7740\u884c\u4e4b\u548c\u7684\u70b9\u518d\u7ed9\u77e9\u9635\u91cc\u9762\u7684\u70b9\u8f93\u9001\u6d41\u91cf\uff0c\u8fd9\u4e9b\u77e9\u9635\u91cc\u9762\u7684\u70b9\u518d\u7ed9\u5217\u4e4b\u548c\u91cc\u9762\u7684\u70b9\u8f93\u9001\u6d41\u91cf\u540e\uff0c\u6211\u4eec\u518d\u628a\u5217\u4e4b\u548c\u7684\u70b9\u6d41\u91cf\u8f93\u56de\u7ed9 $S$ \u3002\n\n\u6ca1\u79cd\u8fb9\u7684\u4e0a\u4e0b\u754c\u4e5f\u4e0d\u96be\u60f3\u5230\uff1a    \n\n\u8bb0\u6b64\u65f6\u4e8c\u5206\u503c\u662f $mid$ \u3002\n- $S$ -> $\\sum_{i = 1} ^ {n}H_{i}$ \uff0c\u5373 $S$ \u6d41\u5411\u884c\u4e4b\u548c\u7684\u70b9\u7684\u8fb9\u4e0a\u4e0b\u754c\u5c31\u662f $sumH_i - mid \\sim sumH_i + mid$    \n- $\\sum_{i = 1} ^ {n}H_{i}$ -> $a_{i,j}$ \u5373\u884c\u4e4b\u548c\u7684\u70b9\u6d41\u5411\u77e9\u9635\u5143\u7d20\u7684\u8fb9\u7684\u4e0a\u4e0b\u754c\u5c31\u662f $L \\sim R$ \u3002\n- $b_{i,j}$ -> $\\sum_{i = 1} ^ mL_i$ \u5373\u77e9\u9635\u5143\u7d20\u6d41\u5411\u5217\u4e4b\u548c\u7684\u8fb9\u7684\u4e0a\u4e0b\u754c\u5c31\u662f $L \\sim R$ \u3002    \n- $\\sum_{i = 1} ^ mL_i$ -> $S$ \u5373\u5217\u4e4b\u548c\u7684\u70b9\u6d41\u5411 $S$ \u7684\u8fb9\u7684\u4e0a\u4e0b\u754c\u5c31\u662f $sumL_i - mid \\sim sumL_i + mid$ \u3002    \n\n\u63a5\u7740\u628a $S$ \u5f53\u6210\u56fe\u4e2d\u7684\u70b9\u8dd1\u65e0\u6e90\u6c47\u4e0a\u4e0b\u754c\u53ef\u884c\u6d41\u5373\u53ef\u3002    \n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<queue>\nusing namespace std;\nconst int Len = 200 * 200 * 5 + 5,Inf = 1e9;\nint dep[Len],cnt = 1,head[Len],s,t,S,T,cur[Len],val[Len],a[205][205],sumh[205],suml[205],LL,RR,n,m,sum,ans,minn;\nstruct node\n{\n\tint next,to,w;\n}edge[Len << 1];\nvoid add(int from,int to,int w)\n{\n\tedge[++ cnt].to = to;\n\tedge[cnt].w = w;\n\tedge[cnt].next = head[from];\n\thead[from] = cnt;\n}\nint BFS()\n{\n\tqueue<int> q;\n\tmemset(dep , 0 , sizeof dep);\n\tq.push(S);dep[S] = 1;cur[S] = head[S];\n\twhile(!q.empty())\n\t{\n\t\tint p = q.front() ; q.pop();\n\t\tfor(int e = head[p] ; e ; e = edge[e].next)\n\t\t{\n\t\t\tint to = edge[e].to;\n\t\t\tif(!dep[to] && edge[e].w)\n\t\t\t{\n\t\t\t\tdep[to] = dep[p] + 1;\n\t\t\t\tcur[to] = head[to];\n\t\t\t\tif(T == to) return dep[T];\n\t\t\t\tq.push(to);\n\t\t\t}\n\t\t}\n\t}\n\treturn dep[T];\n}\nint dfs(int u,int In)\n{\n\tif(u == T) return In;\n\tint Out = 0;\n\tfor(int e = cur[u] ; e && In > 0 ; e = edge[e].next)\n\t{\n\t\tcur[u] = e;\n\t\tint to = edge[e].to;\n\t\tif(edge[e].w && dep[to] == dep[u] + 1)\n\t\t{\n\t\t\tint res = dfs(to , min(In , edge[e].w));\n\t\t\tIn -= res;\n\t\t\tOut += res;\n\t\t\tedge[e].w -= res;\n\t\t\tedge[e ^ 1].w += res; \n\t\t}\n\t}\n\treturn (!Out) ? dep[u] = 0 : Out;\n}\nint Clone(int x,int y){return (x - 1) * n + y;}\nbool check(int res)\n{\n\tmemset(head , 0 , sizeof head) ; cnt = 1;\n\tmemset(val , 0 , sizeof val);\n\tsum = ans = 0;\n\tfor(int i = 1 ; i < n ; i ++)//\u5904\u7406\u884c\n\t{\n\t\tint now = Clone(i , m) , L = sumh[i] - res , R = sumh[i] + res;//L = sumh[i] - res , R = sumh[i] + res\n\t\tadd(s , now , R - L) , add(now , s , 0);\n\t\tval[now] += L , val[s] -= L;\n\t}\n\tfor(int i = 1 ; i < m ; i ++)\n\t{\n\t\tint now = Clone(n , i) , L = suml[i] - res , R = suml[i] + res;\n\t\tadd(now , s , R - L) , add(s , now , 0);\n\t\tval[s] += L , val[now] -= L; \n\t}\n\tfor(int i = 1 ; i < n ; i ++)\n\t{\n\t\tint now = Clone(i , m);\n\t\tfor(int j = 1 ; j < m ; j ++)\n\t\t{\n\t\t\tint to = Clone(i , j);\n\t\t\tadd(now , to , RR - LL) , add(to , now , 0);\n\t\t\tval[to] += LL , val[now] -= LL; \n\t\t}\n\t} \n\tfor(int i = 1 ; i < m ; i ++)\n\t{\n\t\tint now = Clone(n , i);\n\t\tfor(int j = 1 ; j < n ; j ++)\n\t\t{\n\t\t\tint to = Clone(j , i);\n\t\t\tadd(to , now , RR - LL) , add(now , to , 0);\n\t\t\tval[now] += LL , val[to] -= LL;\n\t\t}\n\t}\n\tfor(int i = 1 ; i <= n * m + 1 ; i ++)\n\t{\n\t\tif(val[i] > 0) add(S , i , val[i]) , add(i , S , 0) , sum += val[i];\n\t\tif(val[i] < 0) add(i , T , -val[i]) , add(T , i , 0);\n\t}\n\twhile(BFS()) ans += dfs(S , Inf);\n\tif(ans == sum) return true;\n\treturn false;\n}\nsigned main()\n{\n\tminn = 1e9;\n\tscanf(\"%d %d\",&n,&m);\n\tn ++ , m ++;\n\ts = n * m , t = n * m + 1 , S = n * m + 2 , T = n * m + 3; \n\tfor(int i = 1 ; i <= n - 1 ; i ++)\n\t\tfor(int j = 1 ; j <= m - 1 ; j ++) \n\t\t{\n\t\t\tscanf(\"%d\",&a[i][j]);\n\t\t\tsumh[i] += a[i][j] , suml[j] += a[i][j];\n\t\t}\n\tfor(int i = 1 ; i <= n - 1 ; i ++) minn = min(minn , sumh[i]);\n\tfor(int i = 1 ; i <= m - 1 ; i ++) minn = min(minn , suml[i]);\n\tscanf(\"%d %d\",&LL,&RR);\n\tint l = 0 , r = minn,anss;\n\twhile(l <= r)\n\t{\n\t\tint mid = (l + r) >> 1;\n\t\tif(check(mid)) anss = mid , r = mid - 1;\n\t\telse l = mid + 1; \n\t}\n\tprintf(\"%d\\n\",anss);\n\treturn 0;\n}\n```",
        "postTime": 1608625868,
        "uid": 132533,
        "name": "Hakuoro",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4194 \u3010\u77e9\u9635\u3011"
    }
]
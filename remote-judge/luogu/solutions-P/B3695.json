[
    {
        "content": "\u5bb9\u6613\u60f3\u5230\u7528 `bool` \u7c7b\u578b\u53bb\u8868\u793a\u4e00\u4e2a\u96c6\u5408\u91cc\u9762\u6709\u6ca1\u6709\u8fd9\u4e2a\u6570\u3002\u7ef4\u62a4\u4e00\u4e2a\u957f $m$ \u7684 `bool` \u6570\u7ec4\u8868\u793a\u4e00\u4e2a\u96c6\u5408\uff0c\u5219\u6574\u4f53\u52a0\u51cf\u64cd\u4f5c\u53d8\u6210\u4e86\u6574\u4e2a\u6570\u7ec4\u53f3\u79fb/\u5de6\u79fb\u7684\u64cd\u4f5c\uff0c\u7a7a\u51fa\u7684\u4f4d\u8865 0 \u5373\u53ef\uff1b\u53d6\u4ea4\u96c6\u662f\u4e24\u4e2a\u90fd\u6709\uff0c\u7ed3\u679c\u4e2d\u5bf9\u5e94\u4f4d\u4f5c $\\mathrm{bitand}$ \u8fd0\u7b97\uff1b\u53d6\u5e76\u96c6\u662f\u4e8c\u8005\u6709\u4e00\u4e2a\u5373\u53ef\uff0c\u7ed3\u679c\u4e2d\u5bf9\u5e94\u4f4d\u4f5c $\\mathrm{bitor}$ \u8fd0\u7b97\uff1b\u4f5c\u5bf9\u79f0\u5dee\u662f\u4e8c\u8005\u5fc5\u987b\u53ea\u6709\u4e00\u4e2a\uff0c\u7ed3\u679c\u4e2d\u5bf9\u5e94\u4f4d\u4f5c $\\mathrm{xor}$ \u8fd0\u7b97\u3002\u6b64\u65f6\u76f4\u63a5\u7ef4\u62a4\u8fd9\u4e2a\u8fc7\u7a0b\u7684\u590d\u6742\u5ea6\u662f $O(\\sum c + mq)$\u3002\n\n\u590d\u6742\u5ea6\u74f6\u9888\u5728\u4e8e\u6bcf\u6b21\u64cd\u4f5c\u53ea\u80fd\u5bf9\u4e00\u4e2a\u4f4d\u8fdb\u884c\u64cd\u4f5c\uff0c\u80fd\u4e0d\u80fd\u5c06\u591a\u4e2a\u4f4d\u4e00\u8d77\u64cd\u4f5c\u5462\uff1f\u7b54\u6848\u662f\u53ef\u4ee5\u7684\uff0c\u6211\u4eec\u6ce8\u610f\u5230\u4e00\u4e2a `int` \u53d8\u91cf\u53ef\u4ee5\u4e0e\u4e00\u4e2a\u957f\u5ea6\u4e3a 32 \u7684 `bool` \u6570\u7ec4\u76f8\u4e92\u6620\u5c04\uff0c\u56e0\u4e3a `int` \u8f6c\u4e8c\u8fdb\u5236\u540e\u7684 32 \u4e2a\u4f4d\u4e0a\u7684\u6570\u4e0d\u662f 0 \u5c31\u662f 1\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528\u4e00\u4e2a `int` \u53d8\u91cf\u4ee3\u66ff\u957f 32 \u7684 `bool` \u6570\u7ec4\uff0c\u5229\u7528\u4f4d\u8fd0\u7b97\u5224\u65ad\u6bcf\u4e00\u4f4d\u7684\u503c\u5373\u53ef\u5b9e\u73b0\u64cd\u4f5c\u3002\n\n\u90a3\u4e48\u628a\u8fde\u7eed\u7684\u4e00\u4e9b `bool` \u7528 `int` \u4ee3\u66ff\u5373\u53ef\uff0c\u6240\u6709\u64cd\u4f5c\u540c\u4e0a\uff0c\u4f7f\u7528 `__builtin_popcount(x)` \u53ef\u4ee5\u67e5\u8be2\u6574\u6570 $x$ \u5728\u4e8c\u8fdb\u5236\u4e0b\u6709\u591a\u5c11\u4e2a 1\u3002\n\n\u590d\u6742\u5ea6 $O(\\sum c+\\frac{mq}{w})$\uff0c\u5176\u4e2d $w$ \u662f `int` \u7684\u5b57\u957f\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N = 3e4 + 5;\nint n, m, q;\ntemplate<const int siz> struct Bitset {\n\tprivate:\n\t\tstatic const int buksize = (siz >> 6) + ((siz & 63) != 0);\n\t\tuint64_t bukket[buksize];\n\tpublic:\n\t\tBitset() {\n\t\t\tmemset(bukket, 0, sizeof bukket);\n\t\t}\n\t\tinline void set1(int pos) {\n\t\t\tif (pos >= m || pos < 0)\n\t\t\t\treturn;\n\t\t\tbukket[pos >> 6] |= 1ull << (pos & 63);\n\t\t}\n\t\tinline void set0(int pos) {\n\t\t\tif (pos >= m || pos < 0)\n\t\t\t\treturn;\n\t\t\tbukket[pos >> 6] &= ~(1ull << (pos & 63));\n\t\t}\n\t\tBitset<siz> &operator <<= (const int len) {\n\t\t\tfor (int i = buksize - 1; ~i; i--)\n\t\t\t\tfor (uint64_t j = 63; ~j; j--) {\n\t\t\t\t\tif (bukket[i] >> j & 1)\n\t\t\t\t\t\tset1((i << 6 | j) + len), set0(i << 6 | j);\n\t\t\t\t}\n\t\t\treturn *this;\n\t\t}\n\t\tBitset<siz> &operator >>= (const int len) {\n\t\t\tfor (int i = 0; i < buksize; i++)\n\t\t\t\tfor (uint64_t j = 0; j < 64; j++) {\n\t\t\t\t\tif (bukket[i] >> j & 1)\n\t\t\t\t\t\tset1((i << 6 | j) - len), set0(i << 6 | j);\n\t\t\t\t}\n\t\t\treturn *this;\n\t\t}\n\t\tBitset<siz> operator | (const Bitset<siz> &o) const {\n\t\t\tBitset<siz> res;\n\t\t\tfor (int i = 0; i < buksize; i++)\n\t\t\t\tres.bukket[i] = bukket[i] | o.bukket[i];\n\t\t\treturn res;\n\t\t}\n\t\tBitset<siz> operator & (const Bitset<siz> &o) const {\n\t\t\tBitset<siz> res;\n\t\t\tfor (int i = 0; i < buksize; i++)\n\t\t\t\tres.bukket[i] = bukket[i] & o.bukket[i];\n\t\t\treturn res;\n\t\t}\n\t\tBitset<siz> operator ^ (const Bitset<siz> &o) const {\n\t\t\tBitset<siz> res;\n\t\t\tfor (int i = 0; i < buksize; i++)\n\t\t\t\tres.bukket[i] = bukket[i] ^ o.bukket[i];\n\t\t\treturn res;\n\t\t}\n\t\tinline int count() {\n\t\t\tint res = 0;\n\t\t\tfor (int i = 0; i < buksize; i++)\n\t\t\t\tres += __builtin_popcountll(bukket[i]);\n\t\t\treturn res;\n\t\t}\n\t\tinline void print() {\n\t\t\tfor (int i = 0; i < m; i++)\n\t\t\t\tprintf(\"%d\", bukket[i >> 6] >> (i & 63) & 1);\n\t\t\tprintf(\"\\n\");\n\t\t}\n};\nstatic Bitset<N> s[N];\nsigned main() {\n\tcin.tie(nullptr)->sync_with_stdio(false);\n\tcin >> n >> m >> q;\n\tfor (int i = 1; i <= n; i++) {\n\t\tint c, x;\n\t\tcin >> c;\n\t\twhile (c--) {\n\t\t\tcin >> x;\n\t\t\ts[i].set1(x - 1);\n\t\t}\n\t}\n\twhile (q--) {\n\t\tint op, x, y;\n\t\tcin >> op >> x >> y;\n\t\tif (op == 1)\n\t\t\ts[x] <<= y;\n\t\tif (op == 2)\n\t\t\ts[x] >>= y;\n\t\tif (op == 3)\n\t\t\tcout << (s[x] & s[y]).count() << '\\n';\n\t\tif (op == 4)\n\t\t\tcout << (s[x] | s[y]).count() << '\\n';\n\t\tif (op == 5)\n\t\t\tcout << (s[x] ^ s[y]).count() << '\\n';\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1673420348,
        "uid": 434929,
        "name": "Usada_Pekora",
        "ccfLevel": 7,
        "title": "B3695 \u538b\u4f4d\u5165\u95e8"
    },
    {
        "content": "~~\u672c\u6765\u6211\u6253\u7684\u662f[\u66b4\u529b](https://www.luogu.com.cn/blog/HuangRenhe123/solution-b3695)\uff0c\u672c\u6765\u8fc7\u4e86\uff0c\u7136\u540e\u5c31\u88ab[\u5b66\u957f\u5927\u4f6c](https://www.luogu.com.cn/user/434929) hack \u4e86\u3002~~\n\n\u8fd9\u9053\u9898\u5f88\u5bb9\u6613\u60f3\u5230\u7528\u4e8c\u8fdb\u5236\u4f4d\u7ef4\u62a4\uff0c\u56e0\u4e3a C++ \u91cc\u5de6\u79fb\u548c\u53f3\u79fb\u53c8\u5feb\u53c8\u65b9\u4fbf\u3002\u672c\u6765\u6211\u4e5f\u662f\u8fd9\u4e48\u60f3\u7684\uff0c\u4f46\u662f\u7531\u4e8e\u4e00\u4e2a $c_i \\leq 10^6$,\u7528 long long \u5b58\u50a8\u4e0d\u4e0b,\u624d\u6253\u4e86\u66b4\u529b\u3002\n\n\u7ecf\u8fc7[\u5927\u4f6c](https://www.luogu.com.cn/user/470348)\u7684\u63d0\u793a\u4e4b\u540e\uff0c\u6211\u53d1\u73b0\u4e86 bitset \u8fd9\u4e2a\u4e1c\u897f\u3002\u5b83\u53ef\u4ee5\u5b58\u50a8\u5f88\u591a\u4f4d\u6570\u7684\u5185\u5bb9\uff0c\u6211\u4eec\u5b58\u50a8\u5c31\u4e0d\u7528 long long \u4e86\u3002\n\n## \u9700\u8981\u7528\u7684\u77e5\u8bc6\n\n`bitset<N>a,b[maxn]`:\u521b\u5efa $n$ \u4f4d\u7684 bitset \u53d8\u91cf $a$\uff0c \u6570\u7ec4 $b$\u3002\n\n`x.count()`:\u8fd4\u56de bitset \u91cf $x$ \u7684 $1$ \u7684\u4e2a\u6570\u3002\n\n**\u6ce8\u610f\uff1abitset \u4e2d\u7684\u8fd0\u7b97\u957f\u5ea6\u5fc5\u987b\u4e00\u6837\u3002**\n\n## \u5f00\u59cb\u6253\u4ee3\u7801\n\n- $op=1$ or $o=2$ \n\n\u5de6\u79fb\u53f3\u79fb\u5373\u53ef\uff0c\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5de6\u79fb\u4f1a\u628a\u4e0d\u7b26\u5408\u7684\u53bb\u6389\uff08\u4f46\u662f\u7b2c $0$ \u4f4d\u5982\u679c\u4e0d\u7b26\u5408\u4e5f\u8981\u53bb\u6389\uff09, \u53f3\u79fb\u53ef\u80fd\u8d85\u8fc7\u4f4d\u6570\u6216\u8005\u6ca1\u6709\u628a\u5927\u4e8e $m$ \u7684\u53bb\u6389\uff0c\u6240\u4ee5\u8fd9\u91cc\u9700\u8981\u6211\u4eec\u624b\u52a8\u53bb\u9664\u3002\n\n- $o=$ or $o=4$ or $o=5$\n\n\u8fd9\u91cc\uff0c\u6211\u4eec\u5c31\u7528\"\u4e0e\"\uff0c\"\u6216\"\uff0c\"\u5f02\u6216\"\u8fd9\u4e09\u4e2a\u4f4d\u8fd0\u7b97\u7b26\u53f7\u6765\u64cd\u4f5c\u5373\u53ef\u3002\uff08\u5177\u4f53\u5bf9\u5e94\u5927\u5bb6\u53ef\u4ee5\u601d\u8003\uff09\u3002\n\n\u63a5\u4e0b\u6765\u653e\u5b8c\u6574\u4ee3\u7801\u3002\n\n\u6211\u8fd9\u91cc\u7528\u4e86 $mm$ \u6765\u8868\u793a\u603b\u5171\u7684\uff0c\u6240\u6709\u7684\u548c $mm$ \"\u4e0e\"\u4e00\u4e0b\u5c31\u53ef\u4ee5\u628a\u5c0f\u4e8e $1$ \u7684\u6216\u8005\u5927\u4e8e $m$ \u7684\u53bb\u6389\u4e86\u3002 \n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=3e4+5;\nint n,m,q,x,y,o;\nbitset<N*2>a[N],ans,mm;\ninline void read(int &res){\n\tres=0;int f=1;char ch=getchar();\n\twhile('0'>ch||ch>'9'){\n\t\tif(ch=='-') f=-1;\n\t\tch=getchar();\n\t}\n\twhile('0'<=ch&&ch<='9'){\n\t\tres=(res<<1)+(res<<3)+(ch^48);\n\t\tch=getchar();\n\t}\n\tres*=f;\n}\ninline void put(int x){\n\tif(x<0) putchar('-'),x=-x;\n\tint i=1;\n\twhile(i*10<=x) i*=10;\n\twhile(i){\n\t\tputchar(x/i+'0');\n\t\tx%=i;i/=10;\n\t}\n}\nint main(){\n\tread(n),read(m),read(q);\n\tfor(int i=1;i<=m;i++) mm[i]=1;\n\tfor(int i=1;i<=n;i++){\n\t\tread(y);\n\t\twhile(y--) read(x),a[i][x]=1;//bitset\u7684\u8d4b\u503c\n\t}\n\twhile(q--){\n\t\tread(o),read(x),read(y);\n\t\tif(o==1) a[x]=(a[x]<<y)&mm;\n\t\tif(o==2) a[x]=(a[x]>>y)&mm;\n\t\tif(o==3) ans=a[x]&a[y];\n\t\tif(o==4) ans=a[x]|a[y];\n\t\tif(o==5) ans=a[x]^a[y];\n\t\tif(o>=3) put(ans.count()),putchar('\\n');\n\t}\n\treturn 0;\n}\n\n```\n\n\u52a0\u4e86\u8bfb\u4f18\u548c\u8f93\u4f18\u53ef\u4ee5\u66f4\u5feb\u3002",
        "postTime": 1675490473,
        "uid": 461359,
        "name": "huangrenheluogu",
        "ccfLevel": 5,
        "title": "B3695\u9898\u89e3bitset"
    },
    {
        "content": "\u5efa\u8bae\u5148\u9605\u8bfb[\u6276\u82cf\u7684bitset\u6d45\u8c08](https://www.luogu.com.cn/blog/fusu2333/fu-su-di-bitset-qian-tan#)\n\n\u672c\u6587\u4e3b\u8981\u63cf\u8ff0\u5982\u4f55\u5b9e\u73b0\u9898\u76ee\u4e2d\u6240\u8ff0\u64cd\u4f5c\u3002\n\n\u6211\u4eec\u7528\u4e00\u4e2a `bitset<30005>` \u7684\u7b2c $i$ \u4f4d\u662f $0/1$ \u8868\u793a\u5b58\u5728/\u4e0d\u5b58\u5728\u3002\n\n\u90a3\u4e48\u6211\u4eec\u4e00\u4e2a\u4e00\u4e2a\u64cd\u4f5c\u6765\u770b\uff1a\n\n---\n\n\u64cd\u4f5c $1$:\n\n\u6211\u4eec\u89c2\u5bdf\u4e00\u4e2a\u5e8f\u5217 `1 3 5 9` \u5728\u4e00\u4e2a `bitset<15>` \u4e2d\u7684\u6620\u5c04\uff1a`000000100010101`\n\n\u518d\u89c2\u5bdf\u8fd9\u4e2a\u5e8f\u5217\u6240\u6709\u5143\u7d20\u90fd\u52a0\u4e0a $6$ \u4e4b\u540e\u7684\u6620\u5c04\uff1a`100010101000000`\n\n\u4f60\u53d1\u73b0\u4e86\u4ec0\u4e48\uff1f\n\n\u5bf9\uff0c\u5c31\u662f\u5de6\u79fb\uff0c\u6240\u4ee5\u64cd\u4f5c $1$\uff0c\u5c31\u662f\u5de6\u79fb\u8fd9\u4e2a `bitset`\u3002\n\n\u4f60\u662f\u4e0d\u662f\u4ee5\u4e3a\uff0c\u6211\u4eec\u5efa\u4e00\u4e2a `bitset<m>`\uff0c\u7136\u540e\u5de6\u79fb\u4e4b\u540e\u8d85\u51fa\u53bb\u7684\u90e8\u5206\u5c31\u4e3a\u81ea\u52a8\u5220\u6389\uff1f\n\n\u8fd9\u91cc\u6709\u4e00\u4e2a**\u5751\u70b9**\uff1a`bitset<N>` \u4e2d\u7684 $N$ \u5fc5\u987b\u4e3a\u4e00\u4e2a\u7f16\u8bd1\u671f\u5e38\u6570\uff0c\u90a3\u4e48\u8fd9\u91cc\u7684 $m$ \u663e\u7136\u5728\u8f93\u5165\u4e86\u4e4b\u540e\u4e0d\u662f\u4e00\u4e2a\u7f16\u8bd1\u671f\u5e38\u6570\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd `bitset<m>`\uff0c\u600e\u4e48\u529e\uff1f\n\n\u6211\u4eec\u53ef\u4ee5\u7ed9\u53e6\u4e00\u4e2a `bitset<30005>` \u7684 $1\\sim m$ \u4f4d\u90fd\u8d4b\u4e3a $1$\uff0c\u5269\u4f59\u7684\u4f4d $0$\uff0c\u90a3\u4e48\u5728\u5de6\u79fb\u4e4b\u540e\uff0c\u6211\u4eec\u5c31\u7528\u5de6\u79fb\u4e86\u7684\u8fd9\u4e2a `bitset` \u4e0e\u4e0a\u540e\u4e00\u4e2a `bitset`\uff0c\u5c31\u80fd\u8d77\u5230\u5c06\u4e0d\u5728 $[1,m]$ \u5185\u7684\u5143\u7d20\u5220\u9664\u7684\u4f5c\u7528\u3002\n\n---\n\n\u64cd\u4f5c $2$:\n\n\u76f8\u5bf9\u64cd\u4f5c $1$ \u5c31\u7b80\u5355\u4e86\uff0c\u56e0\u4e3a\u64cd\u4f5c $2$ \u4e2d\u7684\u53f3\u79fb\u51fa\u4e86 $0$ \u4e4b\u540e\u4f1a\u81ea\u52a8\u5220\u9664\uff0c\u90a3\u4e48\u76f4\u63a5\u5de6\u79fb\u5373\u53ef\u3002\n\n---\n\n\u64cd\u4f5c $3$:\n\n**\u4ea4\u96c6**\u662f\u7531**\u540c\u65f6\u5728\u4e24\u4e2a\u96c6\u5408**\u4e2d\u7684\u5143\u7d20\u6784\u6210\u7684\uff0c\u90a3\u4e48\u8fd9\u6070\u597d\u7b26\u5408\u54ea\u79cd\u4f4d\u8fd0\u7b97\uff1f\u2014\u2014\u4e0e\u8fd0\u7b97 `&`\u3002\n\n\u6240\u4ee5\u64cd\u4f5c $3$ \u5c31\u662f `S[x]&S[y]`\u3002\n\n---\n\n\u64cd\u4f5c $4$:\n\n\u540c\u7406\u53ef\u5f97\uff0c**\u5e76\u96c6**\u662f\u7531**\u5728\u4efb\u610f\u4e00\u4e2a\u96c6\u5408**\u4e2d\u7684\u5143\u7d20\u6784\u6210\u7684\uff0c\u90a3\u4e48\u8fd9\u5c31\u662f\u6216\u8fd0\u7b97 `|`\uff0c\u64cd\u4f5c $4$ \u4fbf\u662f `S[x]|S[y]`\u3002\n\n---\n\n\u64cd\u4f5c $5$:\n\n**\u5bf9\u79f0\u5dee**\u662f\u7531**\u53ea\u5728\u5176\u4e2d\u4e00\u4e2a\u96c6\u5408**\u7684\u5143\u7d20\u6784\u6210\u7684\uff0c\u90a3\u4e48\u8fd9\u5c31\u662f\u5f02\u6216\u8fd0\u7b97 `^`\uff0c\u5f97\u64cd\u4f5c $5$ \u4e3a `S[x]^S[y]`\u3002\n\nTip: \u5982\u679c\u4e0d\u77e5\u9053\u5f02\u6216\u662f\u4ec0\u4e48\u7684\uff0c\u8bb0\u4f4f\uff1a\u82e5\u4e24\u4e2a\u5e03\u5c14\u503c\u76f8\u7b49\uff0c\u5219\u5b83\u4eec\u7684\u5f02\u6216\u503c\u4e3a $0$\uff0c\u53cd\u4e4b\u4e3a $1$\u3002\n\n---\n\n\u81f3\u6b64\uff0c\u4f60\u5c31\u53ef\u4ee5\u5229\u7528 STL AC \u4e00\u9053\u9ec4\u9898\u4e86\u3002\n\n\u9644\u4ee3\u7801\uff1a\n\n```cpp\n#include <bitset>\n#include <vector>\n#include <iostream>\n\nconst int maxn=30005;\nint n,m,q;\nstd::bitset<maxn> s[maxn];\n\nint main(){\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr);\n    std::cin>>n>>m>>q;\n    for(int i = 1,c,x;i<=n; i++){\n        for(std::cin>>c;c;--c){\n            std::cin>>x;\n            s[i].set(x-1,1);\n        }\n    }\n    for(int i = 0; i<m; i++) s[0].set(i,1);\n    for(int o,x,y;q;--q){\n        std::cin>>o>>x>>y;\n        if(o==1){\n            s[x]<<=y;\n            s[x]&=s[0];\n        }else if(o==2){\n            s[x]>>=y;\n        }else if(o==3){\n            std::cout<<(s[x]&s[y]).count()<<'\\n';\n        }else if(o==4){\n            std::cout<<(s[x]|s[y]).count()<<'\\n';\n        }else if(o==5){\n            std::cout<<(s[x]^s[y]).count()<<'\\n';\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1674034667,
        "uid": 809765,
        "name": "Limitless_lmw",
        "ccfLevel": 0,
        "title": "B3695"
    },
    {
        "content": "# \u9898\u610f\u7b80\u8ff0\n\n\u4f60\u9700\u8981\u7ef4\u62a4\u82e5\u5e72\u4e2a\u96c6\u5408\uff0c\u8ba9\u6bcf\u4e2a\u96c6\u5408\u91cc\u7684\u5143\u7d20\u5171\u540c\u52a0\u4e00\u4e2a\u6570\uff0c\u5e76\u4fdd\u7559 $[1,m]$ \u8303\u56f4\u5185\u7684\u6570\u3002\u4f60\u8fd8\u53ef\u80fd\u9700\u8981\u56de\u7b54\u4efb\u610f\u7ed9\u5b9a\u7684\u4e24\u4e2a\u96c6\u5408\u4e4b\u95f4\u7684\u4ea4\u96c6\u3001\u5e76\u96c6\u3001\u5bf9\u79f0\u5dee\u3002\n\n\u96c6\u5408\u4e2a\u6570\u548c $m$ \u90fd\u4e0d\u5927\u4e8e $3\\times 10^4$\u3002\n\n# \u5fc3\u8def\u5386\u7a0b\n\n\u770b\u5230\u9898\u548c\u6570\u636e\u8303\u56f4\uff0c\u6211\u4e24\u773c\u4e00\u9ed1\u3002\u611f\u89c9\u50cf\u662f\u4e2a\u6570\u636e\u7ed3\u6784\u9898\uff0c\u4f46\u8fd9\u5bf9\u4e8e $O(n^2)$ \u7684\u7b97\u6cd5\u6765\u8bf4\u6709\u4e9b\u5927\uff08\u4e00\u822c\u51fa\u5230 $5\\times 10^3$\uff09\uff0c\u5bf9 $O(n\\log n)$ \u7684\u7b97\u6cd5\u53c8\u592a\u5c0f\uff08\u4e00\u822c\u51fa\u5230 $10^5$\uff09\u3002\n\n\u6240\u4ee5\uff0c\u6211\u8003\u8651\u5728 $O(n^2)$ \u7684\u7b97\u6cd5\u4e2d\u9009\u4e00\u4e2a\u5e38\u6570\u5c0f\u7684\u3002\n\n\u90a3\u4e48\uff0c\u60f3\u4e00\u60f3\uff0c\u54ea\u4e2a\u6570\u636e\u7ed3\u6784\u7684\u5e38\u6570\u6781\u5c0f\u5462\uff1f\n\n\u5c31\u662f $O\\left(\\dfrac nw\\right)$\uff0c\u5176\u4e2d $w$ \u8868\u793a\u8ba1\u7b97\u673a\u4f4d\u6570\u7684 bitset\uff01\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u82e5 $w=64$\uff0c\u5219\u8fd0\u7b97\u6b21\u6570\u7ea6\u4e3a $\\dfrac{(3\\times 10^4)^2}{64}=14\\ 062\\ 500$\uff0c\u8db3\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n# \u524d\u7f6e\u77e5\u8bc6\n\n\u4ec5\u4ecb\u7ecd\u4e86\u6b64\u9898\u7528\u5230\u7684 bitset \u76f8\u5173\u8bed\u53e5\u3002\n\n```cpp\n#include <bitset>\n\nusing namespace std;\n\nbitset<30005> s, t; // \u5b9a\u4e49\u4e86\u4e24\u4e2a\u80fd\u5b58\u4e0b 30005 \u4f4d\u7684 bitset\nint x;\n```\n\n```cpp\ns.set(x); // \u5c06 s \u7684\u7b2c x \u4f4d\u8bbe\u4e3a 1\ns << x; // s \u4f5c\u4e3a\u4e00\u4e2a\u5927\u4e8c\u8fdb\u5236\u6570\uff08\u4e0b\u540c\uff09\u5de6\u79fb x \u4f4d\ns >> x; // s \u53f3\u79fb x \u4f4d\ns & t; // s \u4e0e t \u6309\u4f4d\u4e0e\ns | t; // s \u4e0e t \u6309\u4f4d\u6216\ns ^ t; // s \u4e0e t \u6309\u4f4d\u5f02\u6216\ns.count(); // s \u5185 1 \u7684\u4e2a\u6570\n```\n\n# \u89e3\u9898\u601d\u8def\n\n\u7528 bitset \u7684\u6bcf\u4e00\u4f4d\u8868\u793a\u8fd9\u4e00\u4f4d\u7684\u4e0b\u6807\u7684\u6570\u5728\u4e0d\u5728\u91cc\u9762\u3002\n\n\u5219 $5$ \u4e2a\u64cd\u4f5c\u5bf9\u5e94\u7684 bitset \u8fd0\u7b97\u5206\u522b\u5982\u4e0b\uff1a\n\n1. \u53f3\u79fb\u3002\n2. \u5de6\u79fb\u3002\n3. \u6309\u4f4d\u4e0e\u540e\u7edf\u8ba1 $1$ \u7684\u4e2a\u6570\u3002\n4. \u6309\u4f4d\u6216\u540e\u7edf\u8ba1 $1$ \u7684\u4e2a\u6570\u3002\n5. \u6309\u4f4d\u5f02\u6216\u540e\u7edf\u8ba1 $1$ \u7684\u4e2a\u6570\u3002\n\n\u6ce8\u610f\u4e24\u79cd\u4fee\u6539\u64cd\u4f5c\u6709\u53ef\u80fd\u4f7f\u5f97 $[1,m]$ \u5916\u7684\u4f4d\u4e5f\u4e3a $1$\uff0c\u6240\u4ee5\u9700\u8981\u518d\u4e0e\u4e0a\u4e00\u4e2a\u5e95\u96c6\uff08\u6709\u4e14\u4ec5\u6709 $[1,m]$ \u5185\u7684\u4f4d\u4e3a $1$\uff09\u3002\n\n# \u4ee3\u7801\n\n```cpp\n#include <cstdio>\n#include <bitset>\n\nint n, m, q, o, x, y;\nstd::bitset<30005> s[30005], t;\n\nint main() {\n    scanf(\"%d%d%d\", &n, &m, &q);\n    for(int i = 1; i <= n; i++)\n        for(scanf(\"%d\", &x); x; --x)\n            scanf(\"%d\", &y), s[i].set(y);\n    for(int i = 1; i <= m; i++) t.set(i); // \u5e95\u96c6\n\n    while(q--) {\n        scanf(\"%d%d%d\", &o, &x, &y);\n        switch(o) {\n            case 1: s[x] = s[x] << y & t; break;\n            case 2: s[x] = s[x] >> y & t; break;\n            case 3: printf(\"%d\\n\", (s[x] & s[y]).count()); break;\n            case 4: printf(\"%d\\n\", (s[x] | s[y]).count()); break;\n            case 5: printf(\"%d\\n\", (s[x] ^ s[y]).count());\n        }\n    }\n\n    return 0;\n}\n```",
        "postTime": 1673485346,
        "uid": 470348,
        "name": "oddy",
        "ccfLevel": 5,
        "title": "B3695 \u9898\u89e3"
    }
]
[
    {
        "content": "DLX\u53c8\u79f0dancing links X \u662f\u4e00\u79cd\n### \u89e3\u51b3\u91cd\u590d\u8986\u76d6\u548c\u7cbe\u786e\u8986\u76d6\u7684\u9ad8\u6548\u7b97\u6cd5\n\n# \u7cbe\u786e\u8986\u76d6\u7684\u5b9a\u4e49\uff1a\n \n \u4e00\u4e2a\u5168\u96c6S\u6709\u82e5\u5e72\u4e2a\u5b50\u96c6S1\uff0cS2\uff0c\u2026\u2026Sn\uff0c\u9009\u53d6\u5176\u4e2d\u82e5\u5e72\u4e2a\u5b50\u96c6\uff0c\u4f7f\u5f97\u8fd9\u4e9b\u96c6\u5408\u4e2d\u51fa\u73b0\u4e86S\u4e2d\u6bcf\u4e2a\u5143\u7d20\u5404\u4e00\u6b21\u3002\n \n \u8fd9\u4e48\u8bf4\u53ef\u80fd\u6709\u70b9\u62bd\u8c61\uff08\u6211\u77e5\u9053\u6211\u8bed\u6587\u4e0d\u597d\uff09\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff1a\n \n \u5168\u96c6S=\uff5b1\uff0c2\uff0c3\uff0c4\uff0c5\uff0c6\uff0c7\uff5d\uff0c\n \u7528\u5b50\u96c6S1=\uff5b1\uff0c2\uff0c3\uff5d\uff0cS2=\uff5b3\uff0c4\uff0c5\uff0c7\uff5d\uff0cS3=\uff5b4\uff0c5\uff0c6\uff0c7\uff5d\uff0cS4=\uff5b1\uff0c5\uff0c6\uff0c7\uff5d\uff0cS5={4,5}\u7cbe\u786e\u8986\u76d6\uff0c\u7ed3\u679c\u663e\u7136\u662f\u9009\u53d6S1\u548cS3\u3002\n \n# \u4e3b\u8981\u601d\u60f3\uff1a\n\n\u628a\u5168\u96c6\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u5bf9\u5e94\u6210\u4e00\u4e2a\u77e9\u9635\u4e2d\u7684\u5217\uff0c\u628a\u6bcf\u4e2a\u5b50\u96c6\u5bf9\u5e94\u6210\u4e00\u4e2a\u884c\n\u5bf9\u4e8e\u77e9\u9635\u4e2d\u4e00\u70b9\uff08i\uff0cj\uff09\u82e5\u96c6\u5408Si\u5305\u542b\u5143\u7d20j\u5219\u6539\u70b9\u4e3a1\uff0c\u5426\u5219\u4e3a0\u3002\n\n\u6211\u8868\u8fbe\u80fd\u529b\u786e\u5b9e\u4e0d\u884c\uff0c\u5c06\u5c31\u770b\u5427\uff0c\u5b9e\u5728\u4e0d\u884c\u5c31\u770b\u56fe\u5427\u3002~~\uff08\u849f\u84bb\u4e0d\u4f1a\u7ed8\u56fe\u8f6f\u4ef6\uff0c\u53ea\u597d\u624b\u6572\u4e86\uff09~~\n\n\u8fd8\u662f\u521a\u624d\u7684\u4f8b\u5b50\uff0c\u77e9\u9635\u8868\u793a\u4e3a\uff1a\n\n     S | 1  |2  |3  |4  |5  |6  |7\n    S1 | 1  |1  |1  |0  |0  |0  |0\n    S2 | 0  |0  |1  |1  |1  |0  |1\n    S3 | 0  |0  |0  |1  |1  |1  |1\n    S4 | 1  |0  |0  |0  |1  |1  |1\n    S5 | 0  |0  |0  |1  |1  |0  |0\n\n\u63a5\u4e0b\u6765\u662f\u6838\u5fc3\u64cd\u4f5c\uff1a\n\u5148\u9009\u53d6\u4e00\u4e2a\u96c6\u5408\uff08\u4e00\u884c\uff09\uff0c\u628a\u8be5\u884c\u548c\u8be5\u884c\u4e0a\u6709\u70b9\u7684\u5217\u548c\u5305\u542b\u8fd9\u4e9b\u5217\u7684\u884c\u5220\u9664\uff08\u8fd8\u662f\u770b\u56fe\u5427\u2026\u2026\uff09\uff0c\u6bd4\u5982\u8bf4\u6211\u4eec\u9009\u4e86\u7b2c1\u884c\uff1a\n\n     S | 4  |5  |6  |7\n    S3 | 1  |1  |1  |1\n    S5 | 1  |1  |0  |0\n\n\u4e3a\u4ec0\u4e48\u662f\u8fd9\u6837\u5462\uff1f\u9996\u5148\u6211\u4eec\u8981\u77e5\u9053\u5f53\u6211\u4eec\u628a\u77e9\u9635\u5220\u5b8c\u540e\u5c31\u5b8c\u6210\u4e86\u7cbe\u786e\u8986\u76d6\uff0c\u6211\u4eec\u9009\u4e86\u7b2c\u4e00\u884c\u6240\u4ee5\u7b2c\u4e00\u884c\u4e2d\u7684\u5143\u7d20\u5bf9\u5e94\u7684\u5217\u5c31\u5220\u5b8c\u4e86\uff0c\u800c\u5305\u542b\u4e86\u8fd9\u4e9b\u5143\u7d20\u7684\u884c\u80af\u5b9a\u662f\u4e0d\u80fd\u9009\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u628a\u5b83\u4eec\u4e5f\u5220\u4e86\u3002\n\n\u63a5\u4e0b\u6765\u5982\u679c\u6211\u4eec\u9009\u62e9\u4e86S3\uff0c\u663e\u7136\u77e9\u9635\u4e3a\u7a7a\uff0c\u6211\u4eec\u627e\u5230\u4e86\u4e00\u7ec4\u89e3\uff0c\u4f46\u82e5\u6211\u4eec\u9009\u62e9\u4e86S5\u5219\u77e9\u9635\u53d8\u4e3a\uff1a\n\n     S | 6  |7\n     \n\u77e9\u9635\u672a\u8986\u76d6\u5b8c\u4f46\u5df2\u7ecf\u65e0\u96c6\u5408\u53ef\u7528\uff0c\u8986\u76d6\u5931\u8d25\uff0c\u4e8e\u662f\u8981\u56de\u6eaf\uff0c\u4e8e\u662f\u77e9\u9635\u53c8\u4e3a\uff1a\n      \n     S | 4  |5  |6  |7\n    S3 | 1  |1  |1  |1\n    S5 | 1  |1  |0  |0\n\n\u5927\u81f4\u662f\u8fd9\u6837\u4e00\u4e2a\u8fc7\u7a0b\uff0c\u5177\u4f53\u600e\u4e48\u64cd\u4f5c\u5c31\u770b\u4ee3\u7801\uff1a\n\n# \u4ee3\u7801\u5b9e\u73b0\uff1a\n\n\u9996\u5148\u8981\u77e5\u9053\u6211\u4eec\u9700\u8981\u7684\u6570\u7ec4\u548c\u5bf9\u5e94\u7684\u542b\u4e49\uff1a\n```\nint n,m,cnt;//\u77e9\u9635\u7684\u957f\uff0c\u5bbd\uff0c\u70b9\u7684\u6570\u91cf\n\tint l[mx],r[mx],u[mx],d[mx],row[mx],col[mx];//\u6bcf\u4e2a\u70b9\u7684\u5de6\uff0c\u53f3\uff0c\u4e0a\u4e0b\uff0c\u884c\uff0c\u5217\u4fe1\u606f\n\tint h[mx];//\u6bcf\u884c\u7684\u5934\u7ed3\u70b9\n\tint s[mx];//\u6bcf\u5217\u7684\u7ed3\u70b9\u6570\n\tint ans,ansk[mx];//\u9700\u8981ans\u4e2a\u5b50\u96c6\uff0c\u5206\u522b\u4e3aansk[]\n```\n\ndancing links \u7684\u539f\u7406\u662f\u5341\u5b57\u94fe\u8868\u7684\u5220\u9664\u548c\u6062\u590d\u5f88\u65b9\u4fbf\uff0c\u5229\u7528\u5341\u5b57\u94fe\u8868\u6765\u50a8\u5b58\u6211\u4eec\u9700\u8981\u7684\u4fe1\u606f\u3002\n\n1. \u7b2c\u4e00\u6b65 \uff1a\u5efa\u7acb\u7a7a\u7684\u77e9\u9635\uff1a\n```\nvoid init(int _n,int _m) {\n\t\tn=_n,m=_m;\n\t\tint i;\n\t\tfor(i=0; i<=m; i++) {\n\t\t\tr[i]=i+1;\n\t\t\tl[i]=i-1;\n\t\t\tu[i]=d[i]=i;\n\t\t}\n\t\tr[m]=0;//m\u53f3\u8fb9\u662f0\n\t\tl[0]=m;//0\u5de6\u8fb9\u662fm\n\t\tmemset(h,-1,sizeof(h));\n\t\tmemset(s,0,sizeof(s));\n\t\tcnt=m+1;//\u5f00\u59cb\u65f6\u6709m\u4e2a\u7ed3\u70b9\uff080\u7ed3\u70b9\u548c\u5404\u5217\u5934\u7ed3\u70b9\uff09\n\t}//\u521d\u59cb\u5316\uff0c\u751f\u6210\u6bcf\u5217\u7684\u5934\n```\n\n1. \u7b2c\u4e8c\u6b65\uff1a\u5728r\u884cc\u5217\u63d2\u5165\u70b9\n\n```\ninline void link(int R,int C) {\n\t\ts[C]++;\n\t\trow[cnt]=R;\n\t\tcol[cnt]=C;\n\t\tu[cnt]=C;\n\t\td[cnt]=d[C];\n\t\tu[d[C]]=cnt;\n\t\td[C]=cnt;//\u5341\u5b57\u94fe\u8868\u539f\u7406\n\t\tif(h[R]<0)h[R]=r[cnt]=l[cnt]=cnt;//\u8be5\u884c\u6ca1\u6709\u522b\u7684\u70b9,\u628a\u7b2c\u4e00\u4e2a\u52a0\u5165\u7684\u70b9\u4f5c\u4e3a\u8be5\u884c\u7684\u884c\u5934\u7ed3\u70b9\n\t\telse {\n\t\t\tr[cnt]=h[R];\n\t\t\tl[cnt]=l[h[R]];\n\t\t\tr[l[h[R]]]=cnt;\n\t\t\tl[h[R]]=cnt;\n\t\t}\n\t\tcnt++;\n\t}\n```\n1. \u7b2c\u4e09\u6b65\uff1a\u5220\u9664\u4e0e\u6062\u590d\uff1a\n```\ninline void remove(int c) {\n\t\tr[l[c]]=r[c],l[r[c]]=l[c];\n\t\tfor(int i=d[c]; i!=c; i=d[i]) {\n\t\t\tfor(int j=r[i]; j!=i; j=r[j]) {\n\t\t\t\tu[d[j]]=u[j];\n\t\t\t\td[u[j]]=d[j];\n\t\t\t\ts[col[j]]--;\n\t\t\t}\n\t\t}\n\t}//\u5220\u9664c\u5217\u548cc\u5217\u4e0a\u6709\u70b9\u7684\u884c\n\tinline void resume(int c) {\n\t\tfor(int i=u[c]; i!=c; i=u[i]) {\n\t\t\tfor(int j=l[i]; j!=i; j=l[j]) {\n\t\t\t\tu[d[j]]=j;\n\t\t\t\td[u[j]]=j;//\u5341\u5b57\u94fe\u8868\u7684\u6062\u590d\u539f\u7406\uff0c\u53ef\u4ee5\u81ea\u5df1\u753b\u56fe\u9a8c\u8bc1\u3002\n\t\t\t\ts[col[j]]++;\n\t\t\t}\n\t\t}\n\t\tr[l[c]]=c;\n\t\tl[r[c]]=c;\n\t}//\u6062\u590dc\u5217\u548cc\u5217\u4e0a\u6709\u70b9\u7684\u884c\uff0c\u6062\u590d\u4e0e\u5220\u9664\u5f88\u50cf\n```\n1. \u7b2c\u56db\u6b65\uff1a\u6838\u5fc3dance\uff1a\n```\nbool dance(int deep) {\n\t\tif(r[0]==0) { //\u77e9\u9635\u5df2\u7ecf\u5220\u9664\u5b8c\n\t\tans=deep;\n        //\u5982\u679c\u8981\u6c42\u8f93\u51fa\u5177\u4f53\u7684\u89e3\uff0c\u53ef\u5728\u6b64\u5904\u64cd\u4f5c\uff08\u628aansk\u8f6c\u6362\u6362\u56de\u5bf9\u5e94\u7684\u96c6\u5408\u4fe1\u606f\uff09\n        return 1;//\u591a\u89e3\u95ee\u9898\u53bb\u6389\u8fd9\u884c\n\t\t}\n\t\tint c=r[0];\n\t\tfor(int i=r[0];i!=0;i=r[i])if(s[i]<s[c])c=i;//\u627e\u5230\u70b9\u6700\u5c11\u7684\u5217\n\t\tremove(c);\n\t\tfor(int i=d[c];i!=c;i=d[i]){\n\t\t\tansk[deep]=row[i];\n\t\t\tfor(int j=r[i];j!=i;j=r[j]) remove(col[j]);\n\t\t\tif(dance(deep+1)==1)return 1;\n\t\t\tfor(int j=l[i];j!=i;j=l[j]) resume(col[j]);\n\t\t}\n\t\tresume(c); \n\t\treturn 0;\n\t}\n```\n\n\u63a8\u8350\u51e0\u9053\u7cbe\u786e\u8986\u76d6\u7684\u9898\uff1a\n[\u516b\u7687\u540e](https://www.luogu.org/problemnew/show/P1219)\n[\u9776\u5f62\u6570\u72ec](https://www.luogu.org/problemnew/show/P1074)\n\n\u6ce8\u610f\u6ca1\u6709\u7cbe\u786e\u8986\u76d6\u7684\u6a21\u7248\u9898\uff0c\u8981\u81ea\u5df1\u8f6c\u6362\uff0c\u628a\u4e00\u4e9b\u6761\u4ef6\u8f6c\u6362\u6210\u5bf9\u5e94\u7684\u96c6\u5408\u3002\n\n\u6ca1\u6709\u601d\u8def\u7684\u770b\u770b\u9898\u89e3[\u516b\u7687\u540e\u9898\u89e3](https://www.luogu.org/blog/ONE-PIECE/solution-p1219)\uff08~~\u4e2d\u6587\u4e0d\u597d\u770b\u5b8c\u522b\u5410\uff09~~\n\u3002\u9776\u5f62\u6570\u72ec\u5df2\u7ecf\u6709\u5927\u4f6c\u5199\u7684\u9898\u89e3\u4e86\uff0c\u6211\u5c31\u4e0d\u518d\u732e\u4e11\u4e86\uff0c\u6709\u9700\u8981\u53ef\u4ee5\u770b\u4e00\u4e0b\u6211\u7684\u4ee3\u7801[\u9776\u5f62\u6570\u72ec\u4ee3\u7801](https://www.luogu.org/blog/ONE-PIECE/ba-xing-shuo-du-dai-ma)\n\n\u5dee\u70b9\u5fd8\u4e86\uff0c\u8fd8\u6709\u91cd\u590d\u8986\u76d6\u3002\n\n# \u91cd\u590d\u8986\u76d6\u5b9a\u4e49\uff1a\n\u987e\u540d\u601d\u610f\uff0c\u4e0e\u7cbe\u786e\u8986\u76d6\u5dee\u4e0d\u591a\uff0c\u53ea\u662f\u53ef\u4ee5\u6709\u5143\u7d20\u91cd\u590d\n\n\u4e3b\u8981\u601d\u60f3\uff1a\u540c\u4e0a\uff08\u7cbe\u786e\u8986\u76d6\uff09\n\n## \u4ee3\u7801\u5b9e\u73b0\uff1a\n\n\u5220\u9664\u548c\u6062\u590d\u7565\u6709\u4e0d\u540c\n```\ninline void del(int c){\n    for(int i=d[c];i!=c;i=d[i]){\n    l[r[i]]=l[i],r[l[i]]=r[i];\t\n    }\n    }//\u5220\u9664c\u5217 \n    inline void res(int c){\n        for(int i=u[c];i!=c;i=u[i]){\n            l[r[i]]=i,r[l[i]]=i;\n        }\n    }//\u6062\u590dc\u5217 \n```\ndance \u90e8\u5206\u591a\u4e86\u4e00\u4e2a\u526a\u679d,\u56e0\u4e3a\u91cd\u590d\u8986\u76d6\u6bd4\u7cbe\u786e\u8986\u76d6\u6162\u3002\n```\ninline int leave(){\n        int ans=0;\n        bool vis[m];\n        register int i,j,k;\n        memset(vis,0,sizeof(vis));\n        for(i=r[0];i!=0;i=r[i]){\n            if(vis[i]==0){\n                vis[i]=1;\n                ans++;\n                for(j=d[i];j!=i;j=d[j]){\n                    for(k=r[j];k!=j;k=r[k])\n                    vis[col[k]]=1;\n                }\n            }\n        }\n        return ans;\n    }//\u6700\u4f18\u60c5\u51b5\u8fd8\u8981\u591a\u5c11\u4e2a\u96c6\u5408\n    void dance(int deep){\n    //\u6ce8\u610f\uff1a\u8fd9\u4e2a\u526a\u679d\u53ea\u6709\u5728\u591a\u89e3\u60c5\u51b5\u6c42\u6700\u4f18\u89e3\u65f6\u4e0b\u624d\u7528\n        if(deep+leave()>=out)return;//\u526a\u679d \n        if(r[0]==0){\n            out=deep;\n            return;\n        }\n        int c=r[0];\n        register int i,j;\n        for(i=r[0];i!=0;i=r[i])if(s[i]<s[c])c=i;//\u627e\u5230\u70b9\u6700\u5c11\u7684\u5217\n        for(i=d[c];i!=c;i=d[i]){\n            del(i);\n            for(j=r[i];j!=i;j=r[j])del(j);\n            dance(deep+1);\n            for(j=l[i];j!=i;j=l[j])res(j);\n            res(i);\n        }\n        return;\n    }//\u53ef\u4ee5\u770b\u51fa\u91cd\u590d\u8986\u76d6\u7684\u6548\u7387\u5e76\u4e0d\u7b97\u592a\u9ad8\uff0c\u4e0e\u6df1\u641c\u5dee\u4e0d\u591a\uff0c\u751a\u81f3\u5982\u679c\u6df1\u641c\u526a\u679d\u526a\u5f97\u597d\u6bd4dancing links\u5feb\uff0c\u8c28\u614e\u4f7f\u7528\n```\n\n\n\n\u6d1b\u8c37\u4e0a\u6ca1\u627e\u5230\u91cd\u590d\u8986\u76d6\u7684\u9898\uff0c\u63a8\u8350\u4e00\u9053\uff1a\u795e\u9f99\u7684\u96be\u9898\u3002\n\n\u60f3\u505a\u7684\u81ea\u5df1\u53bb\u767e\u5ea6\n\n# \u4e07\u5206\u611f\u8c22\u4f60\u4eec\u5fcd\u7740\u770b\u5b8c\u4e86~~\u8fd9\u4e48\u70c2\u7684\u8bed\u6587\u6c34\u5e73\u5199\u7684\u6587\u7ae0~~\n\n~~\u795d\u5404\u4f4dNOIP\u6ee1\u5206~~\n\n### ~~\u884c\u884c\u597d\u7ed9\u4e2a\u8d5e\u5427~~\n\n\u518d\u9644\u4e0a\u6b21\u6a21\u677f\u9898\u7684\u4ee3\u7801\uff1a\n```\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nconst int mx=250501;//n*m+m<=250500\ninline int Read(){\n\tint x=0;\n\tchar c=getchar();\n\twhile(c>'9'||c<'0')c=getchar();\n\twhile(c>='0'&&c<='9')x=x*10+c-'0',c=getchar();\n\treturn x;\n}\nint n,m;\nint cnt;\nint l[mx],r[mx],u[mx],d[mx],col[mx],row[mx];//\u6bcf\u4e2a\u70b9\u7684\u5de6\u53f3\u4e0a\u4e0b\u6307\u9488\uff0c\u6240\u5728\u884c\u5217 \nint h[mx];//\u6bcf\u884c\u7684\u5934\u7ed3\u70b9 \nint s[mx];//\u6bcf\u5217\u7684\u8282\u70b9\u6570 \nint ansk[mx];//\u9009\u4e86\u90a3\u4e9b\u96c6\u5408 \nvoid init(int m){//m\u4e2a\u5143\u7d20 \n\tfor(register int i=0;i<=m;i++){\n\t\tr[i]=i+1;\n\t\tl[i]=i-1;\n\t\tu[i]=d[i]=i;\n\t}\n\tr[m]=0;\n\tl[0]=m;\n\tmemset(h,-1,sizeof(h));\n\tmemset(s,0,sizeof(s));\n\tcnt=m+1;\n}//\u521d\u59cb\u5316 \ninline void link(int R,int C){//R\u884cC\u5217\u63d2\u5165\u70b9 \n\ts[C]++;\n\trow[cnt]=R;\n\tcol[cnt]=C;\n\tu[cnt]=C;\n\td[cnt]=d[C];\n\tu[d[C]]=cnt;\n\td[C]=cnt;\n\tif(h[R]==-1)h[R]=r[cnt]=l[cnt]=cnt;//\u8be5\u884c\u6ca1\u6709\u70b9\uff0c\u76f4\u63a5\u52a0\u5165 \n\telse{\n\t\tr[cnt]=h[R];\n\t\tl[cnt]=l[h[R]];\n\t\tr[l[h[R]]]=cnt;\n\t\tl[h[R]]=cnt;\n\t}\n\tcnt++;\n\treturn;\n}\ninline void remove(int C){//\u5220\u9664\u6d89\u53caC\u5217\u7684\u96c6\u5408 \n\tr[l[C]]=r[C],l[r[C]]=l[C];\n\tfor(int i=d[C];i!=C;i=d[i]){\n\t\tfor(int j=r[i];j!=i;j=r[j]){\n\t\t\tu[d[j]]=u[j];\n\t\t\td[u[j]]=d[j];\n\t\t\ts[col[j]]--;\n\t\t}\n\t}\n}\ninline void resume(int C){//\u6062\u590d\u6d89\u53caC\u5217\u7684\u96c6\u5408 \n\tfor(int i=u[C];i!=C;i=u[i]){\n\t\tfor(int j=l[i];j!=i;j=l[j]){\n\t\t\tu[d[j]]=j;\n\t\t\td[u[j]]=j;\n\t\t\ts[col[j]]++;\n\t\t}\n\t}\n\tr[l[C]]=C;\n\tl[r[C]]=C;\n}\nbool dance(int deep){\n\tif(r[0]==0){\n\t\tregister int i=0;\n\t\tfor(i=0;i<deep;i++)printf(\"%d \",ansk[i]);\n\t\treturn 1;\n\t}\n\tint c=r[0];\n\tint i,j;\n\tfor(i=r[0];i!=0;i=r[i])if(s[i]<s[c])c=i;\n\tremove(c);\n\tfor(i=d[c];i!=c;i=d[i]){\n\t\tansk[deep]=row[i];\n\t\tfor(j=r[i];j!=i;j=r[j])remove(col[j]);\n\t\tif(dance(deep+1))return 1;\n\t\tfor(j=l[i];j!=i;j=l[j])resume(col[j]);\n\t}\n\tresume(c);\n\treturn 0;\n}\nint main(){\n//\tfreopen(\"cin.txt\",\"r\",stdin);\n\tn=Read(),m=Read();\n\tregister int i,j;\n\tint f;\n\tinit(m);\n\tfor(i=1;i<=n;i++){\n\t\tfor(j=1;j<=m;j++){\n\t\t\tf=Read();\n\t\t\tif(f)link(i,j);\n\t\t}\n\t}\n\tif(!dance(0))printf(\"No Solution!\");\n\treturn 0;\n}\n```",
        "postTime": 1530853701,
        "uid": 28088,
        "name": "\u94b1\u9038\u51e1",
        "ccfLevel": 6,
        "title": "\u6d45\u8c08DLX"
    },
    {
        "content": "\u672c\u6587\u6240\u6709\u5185\u5bb9\uff08\u5305\u62ec\u56fe\u7247\uff09\u5747\u7531 [\u6d69\u7199](http://lsr2002.com) \u5236\u4f5c\uff0c\u672a\u7ecf\u5141\u8bb8\u4e0d\u5f97\u8f6c\u53d1\u3002\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://lsr2002.blog.luogu.org/wu-dao-lian) \u6216 [\u6765\u770b\u4e2a\u4eba\u535a\u5ba2](http://lsr2002.com/index.php/2022/02/03/day6-%e8%88%9e%e8%b9%88%e9%93%be/)\n\n\u5199\u7684\u8be6\u7ec6\u4e86\u70b9\uff0c\u671b\u7ba1\u7406\u5927\u5927\u7ed9\u8fc7\uff0c\u4e00\u6587\u7406\u89e3\u821e\u8e48\u94fe\u3002\n\n### 1.\u821e\u8e48\u94fe\n\n\u4e0d\u61c2\u4e0d\u77e5\u9053\uff0c\u4e00\u61c2\u5413\u4e00\u8df3\uff08\u867d\u7136\u6ca1\u6709\u5b8c\u5168\u61c2\uff09\u3002\n\n\u8fd9\u4e2a\u7b97\u6cd5/\u6570\u636e\u7ed3\u6784\u4e5f\u592a\u592a\u592a\u592a\u5de7\u5999\u4e86\u5427\u3002\n\n\u821e\u8e48\u94fe\u540d\u526f\u5176\u5b9e\uff0c\u786e\u5b9e\u597d\u770b\u53c8\u7cbe\u5de7\u3002\n\n\u821e\u8e48\u94fe\u4e3b\u8981\u89e3\u51b3\u7684\u662f **\u7cbe\u786e\u8986\u76d6\u95ee\u9898** \u3002\n\n#### 1.1 \u7cbe\u786e\u8986\u76d6\u95ee\u9898\n\n##### 1.1.1 \u95ee\u9898\u5b9a\u4e49\n\n\u7ed9\u5b9a\u4e00\u4e2a\u7531 $0-1$ \u7ec4\u6210\u7684\u77e9\u9635\uff0c\u95ee\u662f\u5426\u53ef\u4ee5\u6311\u51fa\u82e5\u5e72\u884c\uff0c\u4f7f\u5f97\u5bf9\u4e8e\u8fd9\u4e2a\u884c\u7684\u96c6\u5408\uff0c\u6bcf\u4e00\u5217\u6709\u4e14\u4ec5\u6709\u4e00\u4e2a $1$ \u51fa\u73b0\u3002[\u6d1b\u8c37\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4929)\n$$\n\\left(\n\\begin{array}{l}\n0 & 0 & 1 & 1 & 0 & 1 & 0 \\\\\n1 & 0 & 0 & 0 & 1 & 0 & 1 \\\\\n0 & 1 & 1 & 0 & 0 & 1 & 0 \\\\\n1 & 0 & 0 & 0 & 1 & 0 & 0 \\\\\n0 & 1 & 0 & 0 & 0 & 0 & 1 \\\\\n0 & 1 & 0 & 1 & 1 & 0 & 1 \\\\\n\\end{array}\n\\right)\n$$\n\u6211\u4eec\u53ef\u4ee5\u89c2\u5bdf\u51fa\u884c $1,4,5$ \u4e3a\u4e00\u4e2a\u89e3\u3002\u53ef\u4ee5\u5229\u7528\u9012\u5f52\u56de\u6eaf\u5f97\u51fa\u8fd9\u4e2a\u89e3\u3002\n\n##### 1.1.2 \u56de\u6eaf\u6c42\u89e3\n\n\u6211\u4eec\u5148\u9009\u62e9\u7b2c\u4e00\u884c\uff08\u7528\u84dd\u8272\u6807\u8bb0\uff09\uff0c\u7136\u540e\u5c06\u5176\u4e2d $1$ \u6240\u5728\u7684\u5217\u7528\u7ea2\u8272\u6807\u8bb0\uff0c\u6700\u540e\u5c06\u6709\u7ea2\u8272\u7684 $\\color{red}1$ \u7684\u884c\u7528\u7eff\u8272\u6807\u8bb0\u3002\u7ed3\u679c\u5982\u4e0b\uff1a\n$$\n\\left(\n\\begin{array}{l}\n\\color{blue} 0 & \\color{blue} 0 & \\color{blue} 1 & \\color{blue} 1 & \\color{blue} 0 & \\color{blue} 1 & \\color{blue} 0 \\\\\n1 & 0 & \\color{red} 0 & \\color{red} 0 & 1 & \\color{red} 0 & 1 \\\\\n\\color{green} 0 & \\color{green} 1 & \\color{red} 1 & \\color{red} 0 & \\color{green} 0 & \\color{red} 1 & \\color{green} 0 \\\\\n1 & 0 & \\color{red} 0 & \\color{red} 0 & 1 & \\color{red} 0 & 0 \\\\\n0 & 1 & \\color{red} 0 & \\color{red} 0 & 0 & \\color{red} 0 & 1 \\\\\n\\color{green} 0 & \\color{green} 1 & \\color{red} 0 & \\color{red} 1 & \\color{green} 1 & \\color{red} 0 & \\color{green} 1 \\\\\n\\end{array}\n\\right)\n$$\n\u6839\u636e\u8981\u6c42\uff0c\u9009\u62e9\u84dd\u8272\u884c\u540e\uff0c\u6240\u6709\u7eff\u8272\u884c\u5747\u4e0e\u5176\u51b2\u7a81\uff0c\u4e0d\u80fd\u518d\u9009\u62e9\u3002\u6240\u4ee5\u6211\u4eec\u5220\u6389\u4e0a\u56fe\u4e2d\u6240\u6709\u5e26\u989c\u8272\u7684\u90e8\u5206\uff0c\u5f97\u5230\u5982\u4e0b\u77e9\u9635\uff1a\n$$\n\\left(\n\\begin{array}{l}\n1 & 0 & 1 & 1 \\\\\n1 & 0 & 1 & 0 \\\\\n0 & 1 & 0 & 1 \\\\\n\\end{array}\n\\right)\n$$\n\u4e8e\u662f\u6211\u4eec\u5f97\u5230\u4e86\u89c4\u6a21\u66f4\u5c0f\u7684\u65b0\u7684\u7cbe\u786e\u8986\u76d6\u95ee\u9898\u3002\u9009\u62e9\u6b21\u77e9\u9635\u7684\u7b2c\u4e00\u884c\uff08\u539f\u77e9\u9635\u7684\u7b2c\u4e8c\u884c\uff09\uff0c\u518d\u6309\u7167\u4e0a\u8ff0\u65b9\u6cd5\u8fdb\u884c\u6807\u8bb0\uff0c\u7ed3\u679c\u5982\u4e0b\uff1a\n$$\n\\left(\n\\begin{array}{l}\n\\color{blue} 1 & \\color{blue} 0 & \\color{blue} 1 & \\color{blue} 1 \\\\\n\\color{red} 1 & \\color{green} 0 & \\color{red} 1 & \\color{red} 0 \\\\\n\\color{red} 0 & \\color{green} 1 & \\color{red} 0 & \\color{red} 1 \\\\\n\\end{array}\n\\right)\n$$\n\u518d\u6b21\u5c06\u6240\u6709\u5e26\u989c\u8272\u7684\u90e8\u5206\u5220\u53bb\uff0c\u5f97\u5230\u7a7a\u77e9\u9635\u3002\u800c\u6b64\u65f6\u84dd\u8272\u884c\u6709 $\\color{blue}0$ \uff0c\u8bf4\u660e\u6ca1\u6709\u5f97\u5230\u89e3\u3002\u4e8e\u662f\u56de\u6eaf\uff0c\u9009\u62e9\u7b2c\u4e8c\u884c\uff08\u539f\u77e9\u9635\u7684\u7b2c\u56db\u884c\uff09\uff1a\n$$\n\\left(\n\\begin{array}{l}\n\\color{red} 1 & \\color{green} 0 & \\color{red} 1 & \\color{green} 1 \\\\\n\\color{blue} 1 & \\color{blue} 0 & \\color{blue} 1 & \\color{blue} 0 \\\\\n\\color{red} 0 & 1 & \\color{red} 0 & 1 \\\\\n\\end{array}\n\\right)\n$$\n\u5220\u6389\u4e0a\u56fe\u4e2d\u6240\u6709\u5e26\u989c\u8272\u7684\u90e8\u5206\uff0c\u5f97\u5230\u5982\u4e0b\u77e9\u9635\uff1a\n$$\n\\left(\n\\begin{array}{l}\n1 & 1\\\\\n\\end{array}\n\\right)\n$$\n\u9009\u62e9\u7b2c\u4e00\u884c\uff08\u539f\u77e9\u9635\u7684\u7b2c\u4e94\u884c\uff09\uff0c\u518d\u8fdb\u884c\u6807\u8bb0\uff0c\u5220\u9664\uff0c\u5f97\u5230\u7a7a\u77e9\u9635\u3002\u800c\u6b64\u65f6\u84dd\u8272\u884c\u6ca1\u6709 $\\color{blue}0$ \uff0c\u8bf4\u660e\u5f97\u5230\u4e00\u4e2a\u89e3\u3002\n\n\u5f97\u5230\u7684\u89e3\u4e3a\u539f\u77e9\u9635\u7684\u7b2c\u4e00\u884c\u3001\u7b2c\u56db\u884c\u548c\u7b2c\u4e94\u884c\u3002\n\n\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5c06\u8be5\u56de\u6eaf\u7b97\u6cd5\u603b\u7ed3\u6210\u5982\u4e0b\u6b65\u9aa4\uff1a\n\n1. \u9009\u62e9\u5f53\u524d\u77e9\u9635\u7684\u4e00\u884c\u3002\n2. \u6807\u8bb0\u8be5\u884c\uff0c\u8be5\u884c\u5143\u7d20\u4e3a $1$ \u7684\u5217\uff0c\u88ab\u6807\u8bb0\u7684\u5217\u4e2d\u542b $1$ \u7684\u884c\u3002\n3. \u5220\u9664\u6240\u6709\u6807\u8bb0\u5143\u7d20\uff0c\u5f97\u5230\u65b0\u77e9\u9635\u3002\u5982\u679c\u65b0\u77e9\u9635\u4e3a\u7a7a\u77e9\u9635\uff0c\u8df3\u8f6c\u5230 $4.$ \uff1b\u5426\u5219\u7ee7\u7eed\u6c42\u89e3\uff0c\u8df3\u8f6c\u5230 $1.$ \u3002\n4. \u65b0\u77e9\u9635\u4e3a\u7a7a\u77e9\u9635\u3002\u5982\u679c\u5220\u9664\u7684\u884c\u5168\u4e3a $1$ \uff0c\u8bf4\u660e\u5f97\u5230\u4e00\u4e2a\u89e3\uff0c\u6c42\u89e3\u7ed3\u675f\uff0c\u8df3\u8f6c\u5230 $5.$ \uff1b\u5426\u5219\u8bf4\u660e\u6c42\u89e3\u5931\u8d25\uff0c\u8df3\u8f6c\u5230 $6.$ \u3002\n5. \u6c42\u89e3\u7ed3\u675f\uff0c\u5f97\u5230\u4e00\u4e2a\u89e3\u3002\u8f93\u51fa\u8fd9\u4e2a\u89e3\u3002\n6. \u6c42\u89e3\u5931\u8d25\uff0c\u56de\u6eaf\u5230\u4e0a\u4e00\u4e2a\u77e9\u9635\uff0c\u9009\u62e9\u4e0b\u4e00\u884c\uff0c\u8df3\u8f6c\u5230 $1.$ \u3002\u5982\u679c\u6ca1\u6709\u77e9\u9635\u53ef\u4ee5\u56de\u6eaf\uff0c\u8bf4\u660e\u672c\u9898\u65e0\u89e3\uff0c\u8df3\u8f6c\u5230 $7.$ \u3002\n7. \u6c42\u89e3\u7ed3\u675f\uff0c\u672c\u9898\u65e0\u89e3\u3002\u8f93\u51fa\u65e0\u89e3\u4fe1\u606f\u3002\n\n\u4ece\u4e0a\u8ff0\u8fc7\u7a0b\u6765\u770b\uff0c\u6211\u4eec\u9700\u8981\u5f88\u5927\u7684\u7a7a\u95f4\u6765\u5b58\u50a8\u7f13\u5b58\u548c\u56de\u6eaf\u7684\u77e9\u9635\u3002\u800c\u5982\u4f55\u7f13\u5b58\u4fdd\u8bc1\u6570\u636e\u53ef\u4ee5\u56de\u6eaf\uff0c\u5982\u4f55\u5f97\u5230\u5bf9\u5e94\u539f\u77e9\u9635\u7684\u884c\u7684\u7b54\u6848\u7b49\uff0c\u5b9e\u73b0\u8d77\u6765\u8f83\u4e3a\u56f0\u96be\u3002\n\n#### 1.2 \u821e\u8e48\u94fe\n\n\u4e3a\u4e86\u89e3\u51b3\u7cbe\u786e\u8986\u76d6\u95ee\u9898\uff0c\u9ad8\u5fb7\u7eb3( **Donald Ervin Knuth** )\u2014\u2014\u7ecf\u5178\u5de8\u8457\u300a\u8ba1\u7b97\u673a\u7a0b\u5e8f\u8bbe\u8ba1\u7684\u827a\u672f\u300b\u7684\u5e74\u8f7b\u4f5c\u8005\uff0c\u63d0\u51fa\u4e86 **DLX(Dancing Links X)** \u7b97\u6cd5\u3002\u5b9e\u9645\u4e0a\uff0c\u4ed6\u63d0\u51fa\u7684\u7b97\u6cd5\u4e3a **X\u7b97\u6cd5** \uff0c\u800c\u821e\u8e48\u94fe\u5219\u662f\u5b9e\u73b0\u8fd9\u4e2a\u7b97\u6cd5\u7684\u9ad8\u6548\u7684\u6570\u636e\u7ed3\u6784\u3002\u5728\u4ecb\u7ecd\u821e\u8e48\u94fe\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5176\u5de7\u5999\u7684\u7ed3\u6784\u5e26\u6765\u7684\u9ad8\u6548\u7684\u6548\u7387\uff0c\u5404\u5143\u7d20\u5c31\u50cf\u5728\u94fe\u4e0a\u821e\u8e48\u4e00\u822c\u7075\u5de7\u3002\n\n##### 1.2.1 \u53cc\u5411\u94fe\u8868\n\n\u5728\u5b66\u4e60\u6570\u636e\u7ed3\u6784\u65f6\uff0c\u6211\u4eec\u66fe\u7ecf\u63a5\u89e6\u8fc7\u94fe\u8868\uff0c\u5176\u5de7\u5999\u7684\u63d2\u5165\u5220\u9664\u64cd\u4f5c\u8ba9\u6211\u4eec\u5bf9\u5176\u8bb0\u5fc6\u72b9\u65b0\u3002\n\n\u4e3a\u4e86\u89e3\u51b3\u4e0d\u540c\u7684\u95ee\u9898\uff0c\u94fe\u8868\u53c8\u5206\u4e3a\u5355\u5411\u94fe\u8868\uff0c\u53cc\u5411\u94fe\u8868\uff0c\u5faa\u73af\u94fe\u8868\u7b49\u7b49\u3002\n\n\u5176\u4e2d\u53cc\u5411\u94fe\u8868\uff0c\u5373\u6bcf\u4e2a\u5143\u7d20\u542b\u6709\u4e24\u4e2a\u6307\u9488\uff0c\u5206\u522b\u6307\u5411\u524d\u9762\u548c\u540e\u9762\u7684\u5143\u7d20\u3002\n\n\u6bd4\u5982\u6211\u4eec\u6709\u4e09\u4e2a\u8fde\u7eed\u7684\u5143\u7d20 $ABC$ \uff0c\u5219\u6211\u4eec\u53ef\u4ee5\u7528\uff1a ``A.Right=B B.Right=C B.Left=A C.left=B`` \u5c06\u5176\u76f8\u8fde\u3002\n\n\u5f53\u6211\u4eec\u8981\u5220\u9664\u5143\u7d20 $B$ \u65f6\uff0c\u6211\u4eec\u53ea\u9700\u5c06 $B$ \u7684\u5de6\u5143\u7d20\u7684\u53f3\u6307\u9488\u9644\u6210 $B$ \u7684\u53f3\u5143\u7d20\uff0c\u5c06 $B$ \u7684\u53f3\u5143\u7d20\u7684\u5de6\u6307\u9488\u9644\u6210 $B$ \u7684\u5de6\u5143\u7d20\u3002\u5373 ``A.Right=C C.Left=A`` \u3002\n\n\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u6b64\u65f6 $B$ \u8fd9\u4e2a\u5143\u7d20\u7684\u5b9e\u4f53\u8fd8\u5728\uff0c\u53ea\u662f\u5176\u4e0d\u5728\u94fe\u4e2d\u800c\u5df2\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u6b64\u65f6\u4ecd\u6709 ``B.Right=C B.Left=A`` \u3002\n\n\u5f53\u6211\u4eec\u8fd8\u60f3\u5c06 $B$ \u63d2\u56de\u539f\u6765\u7684\u4f4d\u7f6e\u65f6\uff0c\u53ea\u9700\u8981 ``A.Right=B C.Left=B`` \u5373\u53ef\u3002\n\n\u518d\u89c2\u5bdf\u4e0a\u8ff0\u5220\u9664\u548c\u63d2\u5165\u64cd\u4f5c\uff0c\u7c7b\u6bd4\u4e0a\u6587\u4e2d\u7684\u7f13\u5b58\u548c\u56de\u6eaf\u64cd\u4f5c\uff0c\u6211\u4eec\u53d1\u73b0\u5176\u6070\u597d\u5bf9\u5e94\uff0c\u53ef\u4ee5\u7075\u6d3b\u8fd0\u7528\u3002\u800c\u66f4\u5de7\u5999\u7684\u662f\uff0c\u5b83\u4e0d\u518d\u9700\u8981\u989d\u5916\u7684\u7a7a\u95f4\u53bb\u5b58\u50a8\u7f13\u5b58\u7684\u6570\u636e\uff0c\u800c\u662f\u53ef\u4ee5\u76f4\u63a5\u8fdb\u884c\u5220\u9664\u548c\u64cd\u4f5c\uff0c\u8fd9\u4f7f\u5f97\u7a7a\u95f4\u590d\u6742\u5ea6\u5927\u5927\u964d\u4f4e\u4e86\u3002\u800c\u65f6\u95f4\u4e0a\uff0c\u63d2\u5165\u4e00\u4e2a\u7ed3\u70b9\u548c\u56de\u6eaf\u4e00\u4e2a\u77e9\u9635\u76f8\u6bd4\u4e5f\u66f4\u5feb\u4e86\u3002\n\n\u53e6\u5916\uff0c\u6211\u4eec\u5c06\u53cc\u5411\u94fe\u8868\u7684\u9996\u5c3e\u76f8\u8fde\uff0c\u5219\u5f97\u5230\u4e86 **\u53cc\u5411\u5faa\u73af\u94fe\u8868** \uff0c\u8fd9\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\u662f\u5f88\u5e7f\u6cdb\u7684\u3002\n\n##### 1.2.2 \u5341\u5b57\u4ea4\u53c9\u53cc\u5411\u5faa\u73af\u94fe\u8868\n\n~~\u770b\u770b\u8fd9\u9ad8\u5927\u4e0a\u7684\u540d\u5b57\u5427\u3002~~\n\n\u6211\u4eec\u5206\u6790\u4e00\u4e0b\u8fd9\u4e2a\u540d\u5b57\uff0c \u53cc\u5411\u5faa\u73af\u94fe\u8868\u6211\u4eec\u5df2\u7ecf\u4ecb\u7ecd\u8fc7\u4e86\uff0c\u90a3\u8fd9\u4e2a\u5341\u5b57\u4ea4\u53c9\u662f\u4ec0\u4e48\u4e1c\u897f\uff1f\n\n\u6211\u4eec\u662f\u5c06\u82e5\u5e72\u6761\u53cc\u5411\u5faa\u73af\u94fe\u8868\u5341\u5b57\u4ea4\u53c9\u5f97\u5230\u4e00\u4e2a\u7c7b\u4f3c\u4e8e\u77e9\u9635\u7684\u6570\u636e\u7ed3\u6784\u3002\n\n\u6211\u4eec\u5148\u6765\u5206\u6790\u4e24\u6761\u53cc\u5411\u5faa\u73af\u94fe\u8868\u5341\u5b57\u4ea4\u53c9\u662f\u4e2a\u4ec0\u4e48\u6982\u5ff5\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/c6qxj3o4.png)\n\n\u8fd9\u5c31\u662f\u4e00\u4e2a\u5341\u5b57\u4ea4\u53c9\u53cc\u5411\u5faa\u73af\u94fe\u8868\uff0c\u5176\u4e2d\u5143\u7d20 $B$ \u4e0d\u4ec5\u5728\u6a2a\u5411\u7684\u94fe\u4e2d\uff0c\u4e5f\u5728\u7eb5\u5411\u7684\u94fe\u4e2d\u3002\u4e24\u6761\u53cc\u5411\u5faa\u73af\u94fe\u5341\u5b57\u4ea4\u53c9\uff0c\u4ea4\u70b9\u4e3a\u5143\u7d20 $B$ \u3002\n\n\u5bf9\u4e8e\u4ea4\u70b9\u5143\u7d20\uff0c\u5b83\u7684\u6307\u9488\u4fbf\u6709\u56db\u4e2a\u3002\u6211\u4eec\u8bb0\u6210 ``B.Left=A B.Right=C B.up=D B.down=E`` \u3002\n\n##### 1.2.3 \u821e\u8e48\u94fe\n\n\u628a\u821e\u8e48\u94fe\u5355\u72ec\u5199\u4e2a\u5c0f\u6807\u9898\u53ea\u662f\u56e0\u4e3a\u5b83\u662f\u91cd\u70b9\uff0c\u5e76\u4e0d\u4ee3\u8868\u5b83\u8ddf **\u5341\u5b57\u4ea4\u53c9\u53cc\u5411\u5faa\u73af\u94fe\u8868** \u4e0d\u540c\u3002\u6070\u6070\u76f8\u53cd\uff0c\u821e\u8e48\u94fe\u672c\u8d28\u5c31\u662f\u4e00\u4e2a **\u5341\u5b57\u4ea4\u53c9\u53cc\u5411\u5faa\u73af\u94fe\u8868** \u3002\n\n\u5bf9\u4e8e\u4e0a\u9762\u7684\u6837\u4f8b\uff08\u6015\u5927\u5bb6\u8bb0\u4e0d\u4f4f\u6211\u4eec\u628a\u5b83\u62ff\u4e0b\u6765\uff09\uff1a\n$$\n\\left(\n\\begin{array}{l}\n0 & 0 & 1 & 1 & 0 & 1 & 0 \\\\\n1 & 0 & 0 & 0 & 1 & 0 & 1 \\\\\n0 & 1 & 1 & 0 & 0 & 1 & 0 \\\\\n1 & 0 & 0 & 0 & 1 & 0 & 0 \\\\\n0 & 1 & 0 & 0 & 0 & 0 & 1 \\\\\n0 & 1 & 0 & 1 & 1 & 0 & 1 \\\\\n\\end{array}\n\\right)\n$$\n\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u51fa\u5982\u4e0b\u56fe\u7684\u821e\u8e48\u94fe\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ptq7rhj5.png)\n\n\u4e0d\u7528\u60ca\u614c\uff0c\u6211\u4eec\u4e00\u6b65\u4e00\u6b65\u5206\u6790\u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u3002\n\n\u5bf9\u4e8e\u4e0a\u56fe\uff08\u4e0b\u6587\u79f0\u4f5c **DLX** \uff09\u4e2d\u7684\u6bcf\u4e2a\u7ed3\u70b9\uff0c\u90fd\u542b\u6709\u516d\u4e2a\u5143\u7d20\u3002\u53ef\u4ee5\u89c6\u4e3a\u6bcf\u4e2a\u7ed3\u70b9\u662f **DLX** \u4e2d\u7684\u4e00\u4e2a\u5143\u7d20\uff0c\u800c\u6bcf\u4e2a\u7ed3\u70b9\u672c\u8eab\u53c8\u662f\u4e00\u4e2a\u5305\u542b\u516d\u4e2a\u66f4\u7ec6\u5c0f\u5143\u7d20\u7684\u7ed3\u6784\u4f53\u3002\u8fd9\u516d\u4e2a\u5143\u7d20\u5206\u522b\u4e3a $left,right,up,down,row,col$ \u3002\u524d\u56db\u4e2a\u6211\u4eec\u4e0a\u6587\u8bf4\u8fc7\uff0c\u5143\u7d20 $row$ \u6307\u5411\u8be5\u7ed3\u6784\u4f53\u6240\u5728\u7684\u884c\u6807\uff0c\u5143\u7d20 $col$ \u6307\u5411\u8be5\u7ed3\u6784\u4f53\u6240\u5728\u7684\u5217\u5bf9\u5e94\u7684\u5217\u5143\u7d20\uff08\u89c1\u4e0b\u6587\uff09\u3002\n\n\u800c\u5bf9\u4e8e **DLX** \uff0c\u6211\u4eec\u5c06\u5176\u4e2d\u7684\u5143\u7d20\u5206\u4e3a\u4e09\u79cd\u3002\n\n\u7b2c\u4e00\u79cd\u4e3a **DLX** \u4e2d\u7684\u6570\u5b57\uff0c\u5982\u4e0a\u56fe\u7684 $1-17$ \uff0c\u5b83\u4eec\u8868\u793a\u539f\u77e9\u9635\u4e2d\u7684 $1$ \u3002\u8fd9\u4e5f\u662f **DLX** \u4e2d\u6700\u4e3a\u91cd\u8981\u7684\u7ed3\u70b9\u3002\u56e0\u4e3a\u7cbe\u786e\u8986\u76d6\u95ee\u9898\u4e00\u822c\u7ed9\u51fa\u7684\u90fd\u662f\u7a00\u758f\u56fe\uff0c\u6240\u4ee5\u8fd9\u4e9b\u7ed3\u70b9\u7684\u4e2a\u6570\u4e0d\u4f1a\u5f88\u591a\u3002\n\n\u7b2c\u4e8c\u79cd\u4e3a **DLX** \u4e2d\u7684\u5217\u5143\u7d20\uff0c\u5982\u4e0a\u56fe\u7684 $C1-C7$ \uff0c\u5b83\u4eec\u662f\u8f85\u52a9\u5143\u7d20\uff0c\u4f5c\u7528\u662f\u65b9\u4fbf **DLX** \u8fd0\u4f5c\u3002\u5b83\u4eec\u7684 $row$ \u4e3a $0$ \uff0c $col$ \u4e3a\u672c\u8eab\uff0c $left,right$ \u4e3a\u5217\u5143\u7d20\u6216 $head$ \u5143\u7d20\u3002\n\n \u7b2c\u4e09\u79cd\uff0c\u6216\u8005\u8bf4\u7b2c\u4e09\u4e2a\u4e3a **DLX** \u4e2d\u7684 $head$ \u5143\u7d20\uff0c\u5b83\u4e5f\u662f\u8f85\u52a9\u5143\u7d20\uff0c\u4e14\u53ea\u6709\u4e00\u4e2a\uff0c\u4f5c\u7528\u4e5f\u662f\u65b9\u4fbf **DLX** \u8fd0\u4f5c\u3002\u5b83\u6ca1\u6709 $up,down,row,col$ \u5143\u7d20\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5b83\u53ea\u6709 $left,right$ \u5143\u7d20\u6709\u7528\u3002 \n\n\u4e0b\u9762\u6211\u4eec\u6765\u5177\u4f53\u8c08\u4e00\u8c08\u8fd9\u6837\u4e00\u4e2a **DLX** \u7a76\u7adf\u662f\u5982\u4f55\u5de5\u4f5c\u7684\u3002\n\n\u6211\u4eec\u9996\u5148\u7ed9\u51fa **DLX** \u7684\u6b65\u9aa4\uff1a\n\n1. \u5224\u65ad ``head.right==head`` \u3002\u5982\u679c\u7b49\u4e8e\uff0c\u8bf4\u660e\u6c42\u51fa\u89e3\uff0c\u8f93\u51fa\u7b54\u6848\u5e76\u8fd4\u56de ``true``\uff1b\u5426\u5219\uff0c\u7ee7\u7eed\u3002\n2. \u53d6\u5217\u5143\u7d20 ``c=head.right`` \u3002\n3. \u904d\u5386\u5217\u5143\u7d20\u6240\u5728\u5217\u94fe\uff0c\u9009\u62e9\u4e00\u884c\u3002\n4. \u5220\u9664\u4e0e\u8be5\u884c\u94fe\u5143\u7d20\u51b2\u7a81\u7684\u884c\u5217\uff0c\u5f97\u5230\u4e00\u4e2a\u65b0\u7684 **DLX** \u3002\n5. \u5982\u679c\u65b0\u7684 **DLX** \u4e2d\u4ecd\u6709\u5217\u5143\u7d20\u4e14\u5217\u94fe\u4e3a\u7a7a\uff0c\u5219\u8fd4\u56de ``false`` \uff1b\u5426\u5219\u8df3\u8f6c\u6b65\u9aa4 $1.$ \u3002\n6. \u5982\u679c\u9009\u62e9\u8be5\u884c\u540e\u672a\u6c42\u5f97\u89e3\uff0c\u5219\u56de\u6eaf\u5230\u5f53\u524d\u72b6\u6001\uff0c\u9009\u62e9\u4e0b\u4e00\u884c\uff0c\u8df3\u8f6c\u6b65\u9aa4 $5.$ \u3002\u5982\u679c\u6240\u6709\u884c\u90fd\u904d\u5386\u8fc7\u4ecd\u672a\u6c42\u5f97\u89e3\uff0c\u8bf4\u660e\u4e4b\u524d\u6709\u884c\u9009\u62e9\u9519\u8bef\u6216\u65e0\u89e3\uff0c\u8fd4\u56de ``false`` \u3002\n7. \u5982\u679c\u6700\u7ec8\u51fd\u6570\u8fd4\u56de\u503c\u4e3a ``false`` \uff0c\u5219\u8f93\u51fa ``No Solution!`` \u3002\n\n\u4e0b\u9762\u6839\u636e\u4e0a\u8ff0\u6b65\u9aa4\u8fdb\u884c\u5bf9\u6837\u4f8b\u7684\u6a21\u62df\uff1a\n\n1.  ``head.right!=head`` \uff0c\u53d6 ``c=head.right=1`` \uff0c\u904d\u5386\u5217\u5143\u7d20\u6240\u5728\u5217\u94fe\uff08\u5f97\u5230\u5143\u7d20 $4,10$ \uff09\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0mww0wny.png)\n\n2. \u9009\u62e9\u5143\u7d20 $4$ \u6240\u5728\u884c $L2$ \uff0c\u5e76\u5904\u7406\u4e0e\u8be5\u884c\u94fe\u5143\u7d20\u51b2\u7a81\u7684\u884c\u5217\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/um1x6ffp.png)\n\n3. \u5f97\u5230\u65b0\u7684 **DLX** \u3002 ``head.right!=head`` \u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/safn8j3z.png)\n\n4.\u53d6 ``c=head.right=2`` \uff0c\u904d\u5386\u5217\u5143\u7d20\u6240\u5728\u5217\u94fe\uff08\u5f97\u5230\u5143\u7d20 $7$ \uff09\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x1l04t3t.png)\n\n5. \u9009\u62e9\u5143\u7d20 $7$ \u6240\u5728\u884c $L3$ \uff0c\u5e76\u5904\u7406\u4e0e\u8be5\u884c\u94fe\u5143\u7d20\u51b2\u7a81\u7684\u884c\u5217\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wdcctuld.png)\n\n6. \u5f97\u5230\u65b0\u7684 **DLX** \uff0c\u4ecd\u6709\u5217\u5143\u7d20\u4e14\u5217\u94fe\u4e3a\u7a7a\uff0c\u8fd4\u56de ``false`` \u3002\uff08\u8bf4\u660e\u6ca1\u6709\u6ee1\u8db3\u8981\u6c42\u7684\u884c\u80fd\u8986\u76d6\u8be5\u5217\uff09\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wdcctuld.png)\n\n7. \u4e0a\u56fe\u8fd4\u56de\u6a21\u62df\u6b65\u9aa4 $4.$ \uff0c\u6b64\u65f6\u6240\u6709\u884c\u90fd\u904d\u5386\u8fc7\u4ecd\u672a\u6c42\u5f97\u89e3\uff0c\u8bf4\u660e\u4e4b\u524d\u6709\u884c\u9009\u62e9\u9519\u8bef\u6216\u65e0\u89e3\uff0c\u8fd4\u56de ``false`` \u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x1l04t3t.png)\n\n8. \u4e0a\u56fe\u8fd4\u56de\u6a21\u62df\u6b65\u9aa4 $1.$ ,\u5217\u5143\u7d20\u6240\u5728\u5217\u94fe\u542b\u6709\u5143\u7d20 $4,10$ \uff0c $4$ \u9009\u62e9\u8fc7\uff0c\u65e0\u89e3\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0mww0wny.png)\n\n9. \u9009\u62e9\u5143\u7d20 $10$ \u6240\u5728\u884c $L4$ \uff0c\u5e76\u5904\u7406\u4e0e\u8be5\u884c\u94fe\u5143\u7d20\u51b2\u7a81\u7684\u884c\u5217\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/kn9v9rua.png)\n\n10. \u5f97\u5230\u65b0\u7684 **DLX** \u3002 ``head.right!=head`` \u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2jvra4fx.png)\n\n11. \u53d6 ``c=head.right=2`` \uff0c\u904d\u5386\u5217\u5143\u7d20\u6240\u5728\u5217\u94fe\uff08\u5f97\u5230\u5143\u7d20 $7,12$ \uff09\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/drcmfquh.png)\n\n12. \u9009\u62e9\u5143\u7d20 $7$ \u6240\u5728\u884c $L3$ \uff0c\u5e76\u5904\u7406\u4e0e\u8be5\u884c\u94fe\u5143\u7d20\u51b2\u7a81\u7684\u884c\u5217\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8gth9gec.png)\n\n13. \u5f97\u5230\u65b0\u7684 **DLX** \uff0c\u4ecd\u6709\u5217\u5143\u7d20\u4e14\u5217\u94fe\u4e3a\u7a7a\uff0c\u8fd4\u56de ``false`` \u3002\uff08\u8bf4\u660e\u6ca1\u6709\u6ee1\u8db3\u8981\u6c42\u7684\u884c\u80fd\u8986\u76d6\u8be5\u5217\uff09\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/l16mngxj.png)\n\n14. \u4e0a\u56fe\u8fd4\u56de\u6a21\u62df\u6b65\u9aa4 $11.$  ,\u5217\u5143\u7d20\u6240\u5728\u5217\u94fe\u542b\u6709\u5143\u7d20 $7,12$ \uff0c $7$ \u9009\u62e9\u8fc7\uff0c\u65e0\u89e3\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/drcmfquh.png)\n\n15. \u9009\u62e9\u5143\u7d20 $12$ \u6240\u5728\u884c $L5$ \uff0c\u5e76\u5904\u7406\u4e0e\u8be5\u884c\u94fe\u5143\u7d20\u51b2\u7a81\u7684\u884c\u5217\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dj3ic9op.png)\n\n16. \u5f97\u5230\u65b0\u7684 **DLX** \u3002 ``head.right!=head`` \u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/36s7sx2j.png)\n\n17. \u53d6 ``c=head.right=3`` \uff0c\u904d\u5386\u5217\u5143\u7d20\u6240\u5728\u5217\u94fe\uff08\u5f97\u5230\u5143\u7d20 $1$ \uff09\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4d3yamv4.png)\n\n18. \u9009\u62e9\u5143\u7d20 $1$ \u6240\u5728\u884c $L1$ \uff0c\u5e76\u5904\u7406\u4e0e\u8be5\u884c\u94fe\u5143\u7d20\u51b2\u7a81\u7684\u884c\u5217\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ujvgsetd.png)\n\n19.  ``head.right==head`` \uff0c\u5f97\u51fa\u89e3\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/94bzumrx.png)\n\n20. \u8f93\u51fa\u89e3\uff1a $L4,L5,L1$ \u3002\n\n#### 1.3 \u4ee3\u7801\u8bb2\u89e3\n\n##### 1.3.0 \u5b9a\u4e49\n\n```cpp\nstruct DLXnode\n{\n    int Row,Col;\n    int Left,Right,Up,Down;\n};\nint cnt=0;\nDLXnode node[6000];//DLX\u4e2d\u7684\u6240\u6709\u5143\u7d20\uff0c\u5305\u62echead\u5143\u7d20\u548c\u5217\u5143\u7d20\nint row[510];//\u6bcf\u884c\u7b2c\u4e00\u4e2a\u5143\u7d20\nint ans[510];//\u8bb0\u5f55\u7b54\u6848\nint lcnt[510];//\u6bcf\u5217\u5143\u7d20\u4e2a\u6570\n```\n\n\u7ed3\u6784\u4f53\u90e8\u5206\u4e0e\u4e0a\u6587\u5bf9\u5e94\u3002\n\n\u5176\u4e2d ``row`` \u662f\u4e3a\u4e86\u5efa **DLX** \u65f6\u66f4\u65b9\u4fbf\uff0c\u4e00\u4e2a\u8f85\u52a9\u6570\u7ec4\u3002\n\n ``lcnt`` \u662f\u7528\u6765\u63d0\u901f\u7684\uff08\uff09\uff0c\u5177\u4f53\u7528\u6cd5\u5728 ``dance()`` \u4e2d\u4f1a\u4f53\u73b0\u3002\u53ea\u9700\u8bb0\u4f4f\u5b83\u8bb0\u5f55\u7684\u662f\u6bcf\u5217\u7684\u5143\u7d20\u4e2a\u6570\u5373\u53ef\u3002\n\n##### 1.3.1 \u521d\u59cb\u5316\n\n```cpp\nvoid init()\n{\n    for(int i=0;i<=m;i++)\n    {\n        node[i].Left=i-1;\n        node[i].Right=i+1;\n        node[i].Up=i;\n        node[i].Down=i;\n        lcnt[i]=0;\n    }\n    node[0].Left=m;\n    node[m].Right=0;\n    cnt=m;\n}\n```\n\n\u521d\u59cb\u5316\u7684\u662f $head$ \u5143\u7d20\u548c\u5217\u5143\u7d20\u3002\u5c06\u5b83\u4eec\u7684\u4e0a\u4e0b\u5de6\u53f3\u6307\u9488\u6307\u597d\uff0c\u5217\u6307\u9488\u548c\u884c\u6307\u9488\u53ef\u4ee5\u4e0d\u7528\u3002\n\n##### 1.3.2 \u6dfb\u52a0 '1' \u7ed3\u70b9\n\n```cpp\nvoid addnode(int r,int c)\n{\n    //\u4fee\u6539\u8be5\u7ed3\u70b9\u6240\u5728\u5217\u94fe\n    node[++cnt].Row=r;\n    node[cnt].Col=c;\n    node[cnt].Up=node[c].Up;\n    node[cnt].Down=c;\n    node[node[cnt].Up].Down=cnt;\n    node[c].Up=cnt;\n    //\u4fee\u6539\u8be5\u7ed3\u70b9\u6240\u5728\u884c\u94fe\n    if(!row[r])//\u8be5\u7ed3\u70b9\u662f\u5176\u6240\u5728\u884c\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\n    {\n        node[cnt].Left=cnt;\n        node[cnt].Right=cnt;\n        row[r]=cnt;\n    }\n    else//\u8be5\u7ed3\u70b9\u4e0d\u662f\u5176\u6240\u5728\u884c\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\n    {\n        node[cnt].Left=node[row[r]].Left;\n        node[cnt].Right=row[r];\n        node[node[cnt].Left].Right=cnt;\n        node[node[cnt].Right].Left=cnt;\n    }\n    lcnt[c]++;//\u5bf9\u5e94\u5217\u5143\u7d20\u4e2a\u6570++\n}\n```\n\n##### 1.3.3 \u5220\u9664\u5217\u5143\u7d20\u6240\u5728\u5217\u94fe\u53ca\u5176\u4e2d\u5143\u7d20\u6240\u5bf9\u5e94\u884c\n\n```cpp\nvoid remove(int c) \n{\n    for(int i=node[c].Down;i!=c;i=node[i].Down)//\u679a\u4e3e\u5217\u94fe\u4e2d\u5143\u7d20\n        for(int j=node[i].Right;j!=i;j=node[j].Right)//\u679a\u4e3e\u5217\u94fe\u4e2d\u5143\u7d20\u6240\u5bf9\u5e94\u884c\u94fe\u4e2d\u5143\u7d20\u5e76\u5220\u9664\n        {\n            node[node[j].Down].Up=node[j].Up;\n            node[node[j].Up].Down=node[j].Down;\n            lcnt[node[j].Col]--;\n        }\n   \t//\u5220\u9664\u5217\u94fe\uff08\u4ec5\u9700\u5220\u9664\u5217\u5143\u7d20\u5373\u53ef\u5220\u9664\u6574\u4e2a\u5217\u94fe\uff09\n    node[node[c].Left].Right=node[c].Right;\n    node[node[c].Right].Left=node[c].Left;\n}\n```\n\n##### 1.3.4 \u6062\u590d\u5217\u5143\u7d20\u6240\u5728\u5217\u94fe\u53ca\u5176\u4e2d\u5143\u7d20\u6240\u5bf9\u5e94\u884c\n\n```cpp\nvoid resume(int c) \n{\n    //\u6062\u590d\u5217\u94fe\uff08\u4ec5\u9700\u6062\u590d\u5217\u5143\u7d20\u5373\u53ef\u6062\u590d\u6574\u4e2a\u5217\u94fe\uff09\n    node[node[c].Left].Right=c;\n    node[node[c].Right].Left=c;\n    for(int i=node[c].Down;i!=c;i=node[i].Down)//\u679a\u4e3e\u5217\u94fe\u4e2d\u5143\u7d20\n        for(int j=node[i].Right;j!=i;j=node[j].Right)//\u679a\u4e3e\u5217\u94fe\u4e2d\u5143\u7d20\u6240\u5bf9\u5e94\u884c\u94fe\u4e2d\u5143\u7d20\u5e76\u6062\u590d\n        {\n            node[node[j].Down].Up=j;\n            node[node[j].Up].Down=j;\n            lcnt[node[j].Col]++;\n        }\n}\n```\n\n##### 1.3.5 Let's Dance !  !  !\n\n```cpp\nbool dance(int dep)//dep\u8868\u793a\u7b54\u6848\u7684\u4e2a\u6570\uff08\u641c\u7d22\u7684\u5c42\u6570\uff09\n{\n    if(node[0].Right==0)//\u5982\u679chead.right==head\uff0c\u8bf4\u660e\u6709\u89e3\uff0c\u8f93\u51fa\u7b54\u6848\n    {\n        for(int i=1;i<dep-1;i++)\n            printf(\"%d \",ans[i]);\n        printf(\"%d\\n\",ans[dep-1]);\n        return true;\n    }\n    int C=node[0].Right;//\u53d6\u5217\u5143\u7d20 c=head.right \u3002\n    for(int i=node[0].Right;i;i=node[i].Right)//\u63d0\u901f\uff08\u89c1\u6587\u5b57\uff09\n    {\n        if(lcnt[i]<lcnt[C])\n            C=i;\n    }\n    remove(C);//\u5220\u9664\u5217\u94fe\n    for(int i=node[C].Down;i!=C;i=node[i].Down)//\u679a\u4e3e\u9009\u62e9\u884c\n    {\n        ans[dep]=node[i].Row;\n        for(int j=node[i].Right;j!=i;j=node[j].Right)//\u5220\u9664\u9009\u62e9\u884c\u94fe\u5143\u7d20\u6240\u5728\u5217\u94fe\n            remove(node[j].Col);\n        if(dance(dep+1))return true;\n        for(int j=node[i].Right;j!=i;j=node[j].Right)//\u6062\u590d\u9009\u62e9\u884c\u94fe\u5143\u7d20\u6240\u5728\u5217\u94fe\n            resume(node[j].Col);\n    }\n    resume(C);//\u6062\u590d\u5217\u94fe\n    return false;\n}\n```\n\n\u4e0a\u8ff0\u63d0\u901f\u7684\u679a\u4e3e\uff0c\u5728\u6b63\u5e38\u7684\u821e\u8e48\u94fe\u4e2d\u53ef\u4ee5\u4e0d\u52a0\u3002\u5b83\u7684\u4f5c\u7528\u4ec5\u4ec5\u662f\u63d0\u901f\u3002\n\n\u4f46\u662f\u5728\u6d1b\u8c37\u7684\u821e\u8e48\u94fe\u4e2d\uff0c\u5982\u679c\u4e0d\u52a0\u8fd9\u4e2a\u679a\u4e3e\uff0c\u4f1a $TLE$ \u56db\u4e2a\u70b9\uff0c\u5c31\u7b97\u5438\u4e86\u6c27\u4e5f\u4f1a $TLE$ \u4e24\u4e2a\u70b9\u3002\n\n\u56e0\u6b64\u6211\u4eec\u52a0\u4e86\u8fd9\u4e2a\u63d0\u901f\u7684\u679a\u4e3e\u3002\u539f\u7406\u662f\u51cf\u5c11\u641c\u7d22\u6811\u7684\u5206\u53c9\u6570\u3002\n\n\u9996\u5148\u6211\u4eec\u77e5\u9053\uff0c\u53d6\u6240\u6709\u5217\u4e2d\u4efb\u610f\u4e00\u5217\u8fdb\u884c\u64cd\u4f5c\u5bf9\u4e8e\u7ed3\u679c\u6ca1\u6709\u5f71\u54cd\uff0c\u56e0\u6b64\u6211\u4eec\u9009\u62e9\u5217\u4e2d\u5143\u7d20\u6700\u5c11\u7684\u5217\uff0c\u8fd9\u53ef\u4ee5\u4f7f\u5f97\u641c\u7d22\u6811\u7684\u5206\u53c9\u6570\u5927\u5927\u51cf\u5c11\uff08\u5c24\u5176\u662f\u5f53\u641c\u7d22\u5c42\u6570\u8f83\u9ad8\u65f6\uff09\u3002\n\n\u53e6\u5916\uff0c\u4ee3\u7801\u4e2d ``remove(C)`` \u548c ``resume(C)`` \u4e5f\u53ef\u4ee5\u5199\u5728\u5faa\u73af\u4e2d\uff0c\u4e5f\u5c31\u662f ``remove(node[i].Col)`` \u548c ``resume(node[i].Col)`` \u3002\u4f46\u5176\u5b9e\u5220\u9664\u7684\u90fd\u662f\u540c\u4e00\u884c\uff0c\u6240\u4ee5\u5199\u5728\u5916\u9762\u53ef\u4ee5\u51cf\u5c11\u4e00\u70b9\u70b9\u590d\u6742\u5ea6\u3002\u4e0d\u7406\u89e3\u7684\u8bdd\u5c31\u80cc\u677f\u5b50\uff08\u5f53\u7136\u4e5f\u53ef\u4ee5\u95ee\uff09\uff0c\u4f46\u6700\u597d\u8fd8\u662f\u7406\u89e3\u7406\u89e3\u3002\n\n##### 1.3.6 \u4e3b\u51fd\u6570\n\n```cpp\nint main()\n{\n    scanf(\"%d%d\",&n,&m);\n    init();\n    for(int i=1;i<=n;i++)\n        for(int j=1;j<=m;j++)\n        {\n            scanf(\"%d\",&x);\n            if(x==1)addnode(i,j);\n        }\n    if(!dance(1))printf(\"No Solution!\\n\");\n    return 0;\n}\n```\n\n\u6ca1\u4ec0\u4e48\u597d\u8bb2\u7684\uff0c\u5982\u679c\u4e0a\u9762\u6240\u6709\u5185\u5bb9\u90fd\u7406\u89e3\u4e86\uff0c\u8fd9\u4e2a\u4e3b\u51fd\u6570\u80af\u5b9a\u80fd\u770b\u61c2\u3002",
        "postTime": 1643944333,
        "uid": 74352,
        "name": "lsr1409111459",
        "ccfLevel": 4,
        "title": "Day6 \u821e\u8e48\u94fe"
    },
    {
        "content": "\u53d1\u73b0\u5176\u5b83\u9898\u89e3\u90fd\u6ca1\u7ed9\u56fe\uff0c\u4e13\u95e8\u8fc7\u6765\u53d1\u4e00\u4e0b\u8fd9\u4e2a\u5f88\u7ecf\u5178\u7684\u56fe\u89e3\n[$\\text{\uff08\u53c2\u8003\u535a\u5ba2\uff09}$](https://www.cnblogs.com/grenet/p/3145800.html)\n\n------------\n\n# $$\\Huge\\color{black}\\text{\u5e38\u89c4\u89e3\u6cd5}$$\n\n\n\n\u5bf9\u4e8e\u4e00\u4e2a\u77e9\u9635\n\n![](https://cdn.luogu.com.cn/upload/pic/49052.png)\n\n\u9009\u5b9a\u5b83\u7684\u7b2c\u4e00\u884c\uff0c\u5c06\u5176\u6807\u4e3a\u7ea2\u8272\uff0c\u8fd9\u884c\u7684\u201c1\u201d\u5bf9\u5e94\u7684\u5217\u6807\u4e3a\u84dd\u8272\uff0c\u84dd\u8272\u90e8\u5206\u7684\u201c1\u201d\u5bf9\u5e94\u7684\u884c\u6807\u4e3a\u7d2b\u8272\n\n![](https://cdn.luogu.com.cn/upload/pic/49053.png)\n\n\u7136\u540e\u5220\u53bb\u6807\u4e86\u989c\u8272\u7684\u6570\u5b57\uff0c\u53d8\u6210\u4e86\u8fd9\u6837\n\n![](https://cdn.luogu.com.cn/upload/pic/49054.png)\n\n\u540c\u7406\uff0c\u91cd\u590d\u4e0a\u8ff0\u64cd\u4f5c\n\n![](https://cdn.luogu.com.cn/upload/pic/49055.png)\n\n\u53d1\u73b0\u5f97\u5230\u4e86\u4e00\u4e2a\u7a7a\u77e9\u9635\uff0c\u8bf4\u660e\u77e9\u9635\u4e0d\u5408\u6cd5\uff0c\u56de\u6eaf\uff0c\u9009\u62e9\u7b2c\u4e8c\u884c\n\n![](https://cdn.luogu.com.cn/upload/pic/49056.png)\n\n\u5220\u53bb\u6709\u989c\u8272\u7684\u6570\u5b57\uff0c\u5f97\u5230\u65b0\u77e9\u9635\n\n![](https://cdn.luogu.com.cn/upload/pic/49057.png)\n\n\u7531\u4e8e\u5269\u4e0b\u7684\u77e9\u9635\u53ea\u67091\u884c\uff0c\u4e14\u90fd\u662f1\uff0c\u9009\u62e9\u8fd9\u4e00\u884c\u5373\u53ef\n\n\u4e5f\u5c31\u662f\u5e94\u8be5\u9009\u62e9\u539f\u77e9\u96351\u4e2d\u7684\u7b2c1\u30014\u30015\u884c\n\n```\n1\u3001\u4ece\u77e9\u9635\u4e2d\u9009\u62e9\u4e00\u884c\n\n2\u3001\u6839\u636e\u5b9a\u4e49\uff0c\u6807\u793a\u77e9\u9635\u4e2d\u5176\u4ed6\u884c\u7684\u5143\u7d20\n\n3\u3001\u5220\u9664\u76f8\u5173\u884c\u548c\u5217\u7684\u5143\u7d20\uff0c\u5f97\u5230\u65b0\u77e9\u9635\n\n4\u3001\u5982\u679c\u65b0\u77e9\u9635\u662f\u7a7a\u77e9\u9635\uff0c\u5e76\u4e14\u4e4b\u524d\u7684\u4e00\u884c\u90fd\u662f1\uff0c\u90a3\u4e48\u6c42\u89e3\u7ed3\u675f\uff0c\u8df3\u8f6c\u52306\uff1b\u65b0\u77e9\u9635\u4e0d\u662f\u7a7a\u77e9\u9635\uff0c\u7ee7\u7eed\u6c42\u89e3\uff0c\u8df3\u8f6c\u52301\uff1b\u65b0\u77e9\u9635\u662f\u7a7a\u77e9\u9635\uff0c\u4e4b\u524d\u7684\u4e00\u884c\u4e2d\u67090\uff0c\u8df3\u8f6c\u52305\n\n5\u3001\u8bf4\u660e\u4e4b\u524d\u7684\u9009\u62e9\u6709\u8bef\uff0c\u56de\u6eaf\u5230\u4e4b\u524d\u7684\u4e00\u4e2a\u77e9\u9635\uff0c\u8df3\u8f6c\u52301\uff1b\u5982\u679c\u6ca1\u6709\u77e9\u9635\u53ef\u4ee5\u56de\u6eaf\uff0c\u8bf4\u660e\u8be5\u95ee\u9898\u65e0\u89e3\uff0c\u8df3\u8f6c\u52307\n\n6\u3001\u6c42\u89e3\u7ed3\u675f\uff0c\u628a\u7ed3\u679c\u8f93\u51fa\n\n7\u3001\u6c42\u89e3\u7ed3\u675f\uff0c\u8f93\u51fa\u65e0\u89e3\u6d88\u606f\n```\n\n\n------------\n\n# $$\\Huge\\color{black}\\text{DLX\u7b97\u6cd5}$$\n\nDancing Links\u7684\u6838\u5fc3\u662f\u57fa\u4e8e\u53cc\u5411\u94fe\u7684\u65b9\u4fbf\u64cd\u4f5c\uff08\u79fb\u9664\u3001\u6062\u590d\u52a0\u5165\uff09\n\nDancing Links\u7528\u7684\u6570\u636e\u7ed3\u6784\u662f**\u4ea4\u53c9\u5341\u5b57\u5faa\u73af\u53cc\u5411\u94fe**\n\n\u800cDancing Links\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u4e0d\u4ec5\u662f\u6a2a\u5411\u5faa\u73af\u53cc\u5411\u94fe\u4e2d\u7684\u4e00\u4efd\u5b50\uff0c\u53c8\u662f\u7eb5\u5411\u5faa\u73af\u53cc\u5411\u94fe\u7684\u4e00\u4efd\u5b50\u3002\n\n\u56e0\u4e3a\u7cbe\u786e\u8986\u76d6\u95ee\u9898\u7684\u77e9\u9635\u5f80\u5f80\u662f\u7a00\u758f\u77e9\u9635\uff08\u77e9\u9635\u4e2d\uff0c0\u7684\u4e2a\u6570\u591a\u4e8e1\uff09\uff0c**Dancing Links\u4ec5\u4ec5\u8bb0\u5f55\u77e9\u9635\u4e2d\u503c\u662f1\u7684\u5143\u7d20**\n\n![](https://cdn.luogu.com.cn/upload/pic/49058.png)\n\n\u6bcf\u4e2a\u7eff\u8272\u65b9\u5757\u662f\u4e00\u4e2a\u5143\u7d20\uff0c\u5176\u4e2dHead\u548cC1\u3001C2\u3001\u2026\u2026\u3001C7\u662f\u8f85\u52a9\u5143\u7d20\u3002\u6a59\u8272\u6846\u4e2d\u7684\u5143\u7d20\u662f\u539f\u77e9\u9635\u4e2d1\u7684\u5143\u7d20\uff0c\u7ed9\u4ed6\u4eec\u6807\u4e0a\u53f7\uff08\u4ece1\u523016\uff09\n\n\u5de6\u4fa7\u7684\u7ea2\u8272\uff0c\u6807\u793a\u7684\u662f\u884c\u53f7\uff0c\u8f85\u52a9\u5143\u7d20\u6240\u5728\u7684\u884c\u662f0\u884c\uff0c\u5176\u4f59\u5143\u7d20\u6240\u5728\u7684\u884c\u4ece1\u52306\n\n\u6bcf\u4e24\u4e2a\u5143\u7d20\u4e4b\u95f4\u6709\u4e00\u4e2a\u53cc\u5411\u7bad\u5934\u8fde\u7ebf\uff0c\u8868\u793a\u53cc\u5411\u94fe\u4e2d\u76f8\u90bb\u4e24\u4e2a\u5143\u7d20\u7684\u5173\u7cfb\uff08\u6c34\u5e73\u7684\u662f\u5de6\u53f3\u5173\u7cfb\u3001\u5782\u76f4\u7684\u662f\u4e0a\u4e0b\u5173\u7cfb\uff09\n\n\u5355\u5411\u7684\u7bad\u5934\u5e76\u4e0d\u662f\u8868\u793a\u5355\u5411\u5173\u7cfb\uff0c\u800c\u56e0\u4e3a\u662f\u5faa\u73af\u53cc\u5411\u94fe\uff0c\u5de6\u4fa7\u7684\u5355\u5411\u7bad\u5934\u548c\u53f3\u4fa7\u7684\u5355\u5411\u7bad\u5934\uff08\u4e0a\u8fb9\u7684\u548c\u4e0b\u8fb9\u7684\uff09\u7ec4\u6210\u4e86\u4e00\u4e2a\u53cc\u5411\u7bad\u5934\uff0c\u4f8b\u5982\u5143\u7d2014\u5de6\u4fa7\u7684\u5355\u5411\u7bad\u5934\u548c\u5143\u7d2016\u53f3\u4fa7\u7684\u5355\u9879\u7bad\u5934\u7ec4\u6210\u4e00\u4e2a\u53cc\u5411\u7bad\u5934\uff0c\u8868\u793a14.Left=16\u300116.Right=14\uff1b\u540c\u7406\uff0c\u5143\u7d2014\u4e0b\u8fb9\u7684\u5355\u9879\u7bad\u5934\u548c\u5143\u7d20C4\u4e0a\u8fb9\u7684\u5355\u5411\u7bad\u5934\u7ec4\u6210\u4e00\u4e2a\u53cc\u5411\u7bad\u5934\uff0c\u8868\u793a14.Down=C4\u3001C4.Up=14\n\n\u63a5\u4e0b\u6765\uff0c\u5229\u7528\u56fe\u6765\u89e3\u91caDancing Links\u662f\u5982\u4f55\u6c42\u89e3\u7cbe\u786e\u8986\u76d6\u95ee\u9898\n\n1\u3001\u9996\u5148\u5224\u65adHead.Right=Head\uff1f\u82e5\u662f\uff0c\u6c42\u89e3\u7ed3\u675f\uff0c\u8f93\u51fa\u89e3\uff1b\u82e5\u4e0d\u662f\uff0c\u6c42\u89e3\u8fd8\u6ca1\u7ed3\u675f\uff0c\u5230\u6b65\u9aa42\uff08\u4e5f\u53ef\u4ee5\u5224\u65adHead.Left=Head\uff1f\uff09\n\n2\u3001\u83b7\u53d6Head.Right\u5143\u7d20\uff0c\u5373\u5143\u7d20C1\uff0c\u5e76\u6807\u793a\u5143\u7d20C1\uff08\u6807\u793a\u5143\u7d20C1\uff0c\u6307\u7684\u662f\u6807\u793aC1\u3001\u548cC1\u6240\u5728\u5217\u7684\u6240\u6709\u5143\u7d20\u3001\u4ee5\u53ca\u8be5\u5143\u7d20\u6240\u5728\u884c\u7684\u5143\u7d20\uff0c\u5e76\u4ece\u53cc\u5411\u94fe\u4e2d\u79fb\u9664\u8fd9\u4e9b\u5143\u7d20\uff09\u3002\u5982\u4e0b\u56fe\u4e2d\u7684\u7d2b\u8272\u90e8\u5206\u3002\n\n![](https://cdn.luogu.com.cn/upload/pic/49059.png)\n\n\u5982\u4e0a\u56fe\u53ef\u77e5\uff0c\u884c2\u548c\u884c4\u4e2d\u7684\u4e00\u4e2a\u5fc5\u662f\u7b54\u6848\u7684\u4e00\u90e8\u5206\uff08\u5176\u4ed6\u884c\u4e2d\u6ca1\u6709\u5143\u7d20\u80fd\u8986\u76d6\u5217C1\uff09\uff0c\u5148\u5047\u8bbe\u9009\u62e9\u7684\u662f\u884c2\n\n \n\n3\u3001\u9009\u62e9\u884c2\uff08\u5728\u7b54\u6848\u6808\u4e2d\u538b\u51652\uff09\uff0c\u6807\u793a\u8be5\u884c\u4e2d\u7684\u5176\u4ed6\u5143\u7d20\uff08\u5143\u7d205\u548c\u5143\u7d206\uff09\u6240\u5728\u7684\u5217\u9996\u5143\u7d20\uff0c\u5373\u6807\u793a\u5143\u7d20C4\u548c\u6807\u793a\u5143\u7d20C7\uff0c\u4e0b\u56fe\u4e2d\u7684\u6a59\u8272\u90e8\u5206\u3002\n\n\u6ce8\u610f\u7684\u662f\uff0c\u5373\u4f7f\u5143\u7d205\u5728\u6b65\u9aa42\u4e2d\u5c31\u4ece\u53cc\u5411\u94fe\u4e2d\u79fb\u9664\uff0c\u4f46\u662f\u5143\u7d205\u7684Col\u5206\u91cf\u8fd8\u662f\u6307\u5411\u5143\u7d20C4\u7684\uff0c\u8fd9\u91cc\u4f53\u73b0\u4e86\u53cc\u5411\u94fe\u7684\u5f3a\u5927\u4f5c\u7528\u3002\n\n![](https://cdn.luogu.com.cn/upload/pic/49060.png)\n\n\u628a\u4e0a\u56fe\u4e2d\u7684\u7d2b\u8272\u90e8\u5206\u548c\u6a59\u8272\u90e8\u5206\u79fb\u9664\u7684\u8bdd\uff0c\u5269\u4e0b\u7684\u7eff\u8272\u90e8\u5206\u5c31\u5982\u4e0b\u56fe\u6240\u793a\n\n![](https://cdn.luogu.com.cn/upload/pic/49061.png)\n\n\u4e00\u4e0b\u6392\u9664\u4e86\u5f88\u591a\u5143\u7d20\uff0c\u8fd9\u6837\u5c31\u8f6c\u6362\u4e3a\u4e00\u4e2a\u5c11\u4e86\u5f88\u591a\u5143\u7d20\u7684\u7cbe\u786e\u8986\u76d6\u95ee\u9898\uff0c\u5229\u7528\u9012\u5f52\uff0c\u5f88\u5feb\u5c31\u80fd\u5199\u51fa\u6c42\u89e3\u7684\u8fc7\u7a0b\n\nDLX\u7684\u6d41\u7a0b\uff1a\n\n```\n1\u3001Dancing\u51fd\u6570\u7684\u5165\u53e3\n\n2\u3001\u5224\u65adHead.Right=Head\uff1f\uff0c\u82e5\u662f\uff0c\u8f93\u51fa\u7b54\u6848\uff0c\u8fd4\u56deTrue\uff0c\u9000\u51fa\u51fd\u6570\u3002\n\n3\u3001\u83b7\u5f97Head.Right\u7684\u5143\u7d20C\n\n4\u3001\u6807\u793a\u5143\u7d20C\n\n5\u3001\u83b7\u5f97\u5143\u7d20C\u6240\u5728\u5217\u7684\u4e00\u4e2a\u5143\u7d20\n\n6\u3001\u6807\u793a\u8be5\u5143\u7d20\u540c\u884c\u7684\u5176\u4f59\u5143\u7d20\u6240\u5728\u7684\u5217\u9996\u5143\u7d20\n\n7\u3001\u83b7\u5f97\u4e00\u4e2a\u7b80\u5316\u7684\u95ee\u9898\uff0c\u9012\u5f52\u8c03\u7528Daning\u51fd\u6570\uff0c\u82e5\u8fd4\u56de\u7684True\uff0c\u5219\u8fd4\u56deTrue\uff0c\u9000\u51fa\u51fd\u6570\u3002\n\n8\u3001\u82e5\u8fd4\u56de\u7684\u662fFalse\uff0c\u5219\u56de\u6807\u8be5\u5143\u7d20\u540c\u884c\u7684\u5176\u4f59\u5143\u7d20\u6240\u5728\u7684\u5217\u9996\u5143\u7d20\uff0c\u56de\u6807\u7684\u987a\u5e8f\u548c\u4e4b\u524d\u6807\u793a\u7684\u987a\u5e8f\u76f8\u53cd\n\n9\u3001\u83b7\u5f97\u5143\u7d20C\u6240\u5728\u5217\u7684\u4e0b\u4e00\u4e2a\u5143\u7d20\uff0c\u82e5\u6709\uff0c\u8df3\u8f6c\u5230\u6b65\u9aa46\n\n10\u3001\u82e5\u6ca1\u6709\uff0c\u56de\u6807\u5143\u7d20C\uff0c\u8fd4\u56deFalse\uff0c\u9000\u51fa\u51fd\u6570\u3002\n```\n\n\n\n\u4ee3\u7801\u5b9e\u73b0\uff1a\uff08DLX\u4ee3\u7801\u6a21\u677f\uff09\n\n```c\nstruct DLX\n{\n    int n,sz;\n    int s[maxn];\n    int row[maxnode],col[maxnode];\n    int L[maxnode],R[maxnode],U[maxnode],D[maxnode];\n    int ansd,ans[maxnode];\n    void init(int n)//\u521d\u59cb\u5316\uff0c0\u4e3a\u8d85\u7ea7\u8282\u70b9\uff0c1~n\u4e3a\u6bcf\u5217\u7684\u865a\u62df\u8282\u70b9\n    {\n        this->n=n;\n        sz=n+1;\n        memset(s,0,sizeof(s));\n        for(int i=0;i<=n;i++)\n            { U[i]=i; D[i]=i; L[i]=i-1; R[i]=i+1; }\n        R[n]=0;L[0]=n;\n    }\n    void addNodes(int r,const vector<int> &columns)\n    {//\u5728\u7b2cr\u884c\uff08\u6700\u540e\u4e00\u884c\uff09\u6dfb\u52a0\u8fd9\u4e9b\u8282\u70b9\n        int first=sz,c_sz=columns.size();\n        for(int i=0;i<c_sz;i++)\n        {\n            int c=columns[i];\n            L[sz]=sz-1; R[sz]=sz+1; D[sz]=c; U[sz]=U[c];\n            D[U[c]]=sz; U[c]=sz;\n            row[sz]=r; col[sz]=c;\n            s[c]++;sz++;\n        }\n        R[sz-1]=first; L[first]=sz-1;\n    }\n    #define For(i,A,s) for(int i=A[s];i!=s;i=A[i])\n    void remove(int c)//\u8986\u76d6\u7b2cc\u4e2a\u76ee\u6807\n    {\n        L[R[c]]=L[c];\n        R[L[c]]=R[c];\n        For(i,D,c)\n            For(j,R,i)//\u6495\u5f00\u6240\u6709\u76f8\u5173\u8282\u70b9\n            { U[D[j]]=U[j]; D[U[j]]=D[j]; --s[col[j]]; }\n    }\n    void restore(int c)\n    {//\u590d\u539f\n        For(i,U,c)\n            For(j,L,i)\n            { ++s[col[j]]; U[D[j]]=j; D[U[j]]=j; }\n        L[R[c]]=c;\n        R[L[c]]=c;\n    }\n    bool dfs(int d)\n    {\n        if(R[0]==0)\n        {\n            ansd=d;\n            return true;\n        }\n        int c=R[0];\n        For(i,R,0) if(s[i]<s[c]) c=i;\n        remove(c);\n        For(i,D,c)\n        {\n            ans[d]=row[i];\n            For(j,R,i) remove(col[j]);//\u4e3a\u4e86\u786e\u4fdd\u53ea\u8986\u76d6\u4e00\u6b21\n            if(dfs(d+1)) return true;\n            For(j,L,i) restore(col[j]);//\u56de\u6eaf\n        }\n        restore(c);//\u56de\u6eaf\n        return false;\n    }\n    bool solve(vector<int> &v)//\u5bf9\u5916\u63a5\u53e3\n    {\n        v.clear();\n        if(!dfs(0)) return false;\n        for(int i=0;i<ansd;i++) v.push_back(ans[i]);\n        return true;\n    }\n};\n```\n\n\n\nDLX\u7684\u4e00\u6b21\u64cd\u4f5c\u5982\u4e0b\uff1a\uff08\u4e0d\u542b\u56de\u6eaf\uff09\n\n\n![](https://cdn.luogu.com.cn/upload/pic/49062.png)\n\n![](https://cdn.luogu.com.cn/upload/pic/49063.png)\n\n![](https://cdn.luogu.com.cn/upload/pic/49064.png)\n\n\u4e3b\u51fd\u6570\u548c\u64cd\u4f5c\u4e0a\u9762\u7684dalao\u90fd\u5199\u5f97\u5f88\u8be6\u7ec6\u4e86\uff0c\u4fbf\u4e0d\u518d\u91cd\u590dqwq\n",
        "postTime": 1547967364,
        "uid": 117842,
        "name": "\u65e0\u610f\u8bc6\u8eba\u67aa\u4eba",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4929 \u3010\u3010\u6a21\u677f\u3011\u821e\u8e48\u94fe\uff08DLX\uff09\u3011"
    },
    {
        "content": "\u770b\u5230\u6ca1\u6709\u4eba\u5199\u9898\u89e3\uff0c\u849f\u84bb\u6211\u5c31\u60f3\u8981\u6765\u5237\u4e00\u53d1QWQ(\u5f88\u60f3\u8fc7\u5ba1\u6838\u7684\u8bf4QAQ)\n\n\n\n------------\n- ## \u5173\u4e8e\u7cbe\u786e\u8986\u76d6\u95ee\u9898\n\n\u9996\u5148\uff0c\u6211\u4eec\u6765\u8003\u8651\u5982\u4e0b\u7684\u4e00\u4e2a\u95ee\u9898\uff1a\n\n\u3000\u3000\u7ed9\u5b9a\u4e00\u4e2a $m$ \u884c\uff0c$n$ \u5217\u7684\u77e9\u9635\uff0c\u77e9\u9635\u4e2d\u53ea\u6709 $0$ \u6216 $1$ \u4e24\u79cd\u6570\u5b57\u3002\u627e\u5230\u6700\u5c11\u7684\u884c\u6570\uff0c\u4f7f\u5f97\u5bf9\u4e8e\u77e9\u9635\u7684\u6bcf\u4e00\u5217 $j$\uff0c\u5728\u4f60\u6311\u9009\u7684\u8fd9\u4e9b\u884c\u4e2d\uff0c\u6709\u4e14\u4ec5\u6709\u4e00\u884c\u7684\u7b2c $j$ \u4e2a\u5143\u7d20\u4e3a $1$ \u3002\n\n\u3000\u3000$(n,m)$ $\\leq$ $15$\n  \n\u4e0d\u96be\u53d1\u73b0\uff0c\u5bf9\u4e8e$\\leq$ $15$\u7684\u6570\u636e\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u91c7\u7528\u7a77\u4e3e\u6cd5\u3002\u5bf9\u4e8e\u6bcf\u4e00\u884c\uff0c\u90fd\u6709\u53d6\u6216\u4e0d\u53d6\u4e24\u79cd\u64cd\u4f5c\uff0c\u6240\u4ee5\u6700\u5927\u7684\u64cd\u4f5c\u6570\u4e5f\u53ea\u6709 $ 2 $^$ 15 $\u6b21\uff0c\u5373\u4f7f\u4ee3\u7801\u518d\u4e11\uff0c\u5438\u4e00\u53e3\u6c27\u6c14\u4e5f\u603b\u5f52\u662f\u80fd\u591f\u8fc7\u7684\u3002\n\n\u3000\u3000\u90a3\u4e48\u5f53$(n,m)$ $\\leq$ $50$\u7684\u65f6\u5019\u5462\uff1f\n  \n\u8fd9\u65f6\u5019\u6211\u4eec\u53d1\u73b0\uff0c$ 2 $^$ 50 $\u6b21\u80af\u5b9a\u662f\u4f1a\u7206\u70b8\u7684\uff0c\u96be\u9053\u6211\u4eec\u8981\u7528\u72b6\u6001\u538b\u7f29DP\u6765\u5904\u7406\u8fd9\u9053\u9898\u5417\uff1f\u53ef\u4ee5\u662f\u53ef\u4ee5\uff0c\u4f46\u662f\u5bf9\u4e8e\u6211\u8fd9\u79cd\u83dc\u7684\u4e00\u6279\u7684\u849f\u84bb\u6765\u8bf4\uff0c\u80af\u5b9a\u662f\u4e0d\u884c\u7684(\u4e0d\u4f1a\u5199\u72b6\u538bQAQAQAQAQAQ.jpg)\u3002\u90a3\u4e48\uff0c\u8fd9\u4e2a\u65f6\u5019\uff0c\u6211\u4eec\u8003\u8651\u4e00\u4e9b\u66f4\u52a0\u9ad8\u7ea7\u7684\u641c\u7d22\u3002\n\n\n------------\n- ## \u641c\u7d22\u4e0e\u56de\u6eaf\n\n\u5728\u521d\u5b66OI\u7684\u65f6\u5019\uff0c\u76f8\u4fe1\u5927\u5bb6\u90fd\u5b66\u8fc7\u6df1\u5ea6\u4f18\u5148\u641c\u7d22\uff0c\u5728\u6df1\u5ea6\u4f18\u5148\u641c\u7d22\u4e2d\uff0c\u6709\u4e00\u4e2a\u5f88\u91cd\u8981\u7684\u601d\u60f3\u5c31\u662f\u56de\u6eaf\u3002\u90a3\u4e48\uff0c\u5bf9\u4e8e\u7cbe\u786e\u8986\u76d6\u95ee\u9898\uff0c\u6211\u4eec\u80fd\u4e0d\u80fd\u4e5f\u91c7\u7528\u8fd9\u4e2a\u7b56\u7565\u5462\uff1f\u7b54\u6848\u662f\u53ef\u4ee5\u7684\u3002\u8ba9\u6211\u4eec\u6765\u770b\u4e00\u770b\u56de\u6eaf\u7684\u8fc7\u7a0b\u3002\n\n\u3000\u3000\u9996\u5148\u6211\u4eec\u5047\u8bbe\u62e5\u6709\u4ee5\u4e0b\u4e00\u4e2a\u77e9\u9635\uff1a\n  \n\u3000\u3000\u3000$1$\u3000$0$\u3000$0$\u3000$1$\n  \n\u3000\u3000\u3000$0$\u3000$1$\u3000$0$\u3000$0$\n      \n\u3000\u3000\u3000$1$\u3000$0$\u3000$1$\u3000$1$\n   \n\u3000\u3000\u3000$0$\u3000$0$\u3000$1$\u3000$0$\n\n\u663e\u7136\uff0c\u6211\u4eec\u9996\u5148\u4f1a\u9009\u62e9\u7b2c\u4e00\u884c\uff0c\u7136\u540e\u9009\u62e9\u7b2c\u4e8c\u884c\uff0c\u518d\u9009\u62e9\u7b2c\u4e09\u884c\uff0c\u53d1\u73b0\u5e76\u4e0d\u884c\uff0c\u4e8e\u662f\u6211\u4eec\u8fd4\u56de\u5230\u9009\u62e9\u7b2c\u4e8c\u884c\u7684\u65f6\u5019\uff0c\u91cd\u65b0\u9009\u62e9\u7b2c\u56db\u884c\uff0c\u6210\u529f\u53d1\u73b0\u4e86\u7b54\u6848\u3002\u4e8b\u5b9e\u4e0a\uff0c\u5728\u5c0f\u89c4\u6a21\u7684\u6570\u636e\u4e0a\uff0c\u4e0e\u66b4\u529b\u5e76\u6ca1\u6709\u592a\u5927\u7684\u5dee\u5f02\u3002\u4f46\u662f\u5f53\u6570\u636e\u5f88\u5927\u7684\u65f6\u5019\uff0c\u56de\u6eaf\u663e\u7136\u80fd\u66f4\u5feb\u5730\u6c42\u51fa\u7b54\u6848(\u4f46\u662f\u65f6\u95f4\u590d\u6742\u5ea6\u5b8c\u5168\u662f\u7384\u5b66)\u3002\u7531\u6b64\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u5b9e\u73b0 $X$ \u7b97\u6cd5\u7684\u601d\u8def\u3002\u4f46\u662f\uff0c\u6211\u4eec\u601d\u8003\u521a\u521a\u63cf\u8ff0\u7684\u8fc7\u7a0b\uff0c\u6211\u4eec\u9009\u62e9\u524d\u4e09\u884c\u53d1\u73b0\u4e0d\u884c\u662f\u56e0\u4e3a\u6211\u4eec\u53d1\u73b0\u4e86\u5728\u4e00\u5217\u4e0a\u6709\u4e86\u591a\u4e2a $1$ \u3002\u90a3\u4e48\uff0c\u6211\u4eec\u80fd\u4e0d\u80fd\u5728\u627e\u5bfb\u4e0b\u4e00\u884c\u7684\u65f6\u5019\uff0c\u5c31\u5220\u9664\u6389\u4e00\u4e9b\u663e\u7136\u4e0d\u4f1a\u88ab\u9009\u53d6\u884c\u5462\uff1f\u7b54\u6848\u662f\u53ef\u884c\u7684\u3002\n\n\n------------\n\n- ## X\u7b97\u6cd5\n\n\u6211\u4eec\u7528Markdown\u7684\u8868\u683c\u6765\u5148\u751f\u6210\u4e00\u4e2a\u77e9\u9635\u3002(QAQ\u849f\u84bb\u6211\u4e0d\u4f1a\u63d2\u56fe\u7247,\u624b\u5199\u7684\u53c8\u4e11)\n\n| $0$ | $1$ | $0$ | $0$ | $0$ | $1$ | $0$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $0$ | $0$ | $0$ | $1$ | $1$ | $1$ | $0$ |\n| $0$ | $1$ | $1$ | $0$ | $0$ | $0$ | $1$ |\n| $1$ | $0$ | $0$ | $1$ | $0$ | $0$ | $1$ |\n| $1$ | $0$ | $0$ | $1$ | $0$ | $0$ | $0$ |\n| $0$ | $0$ | $1$ | $0$ | $1$ | $0$ | $1$ |\n\n\u8003\u8651\u5982\u4e0a\u7684\u7b97\u6cd5\uff0c\u9996\u5148\uff0c\u6211\u4eec\u9009\u53d6\u4e86\u7b2c\u4e00\u884c\uff0c\u5728\u7b2c\u4e00\u884c\u4e2d\uff0c\u7b2c\u4e8c\u5217\u4e0e\u7b2c\u516d\u5217\u662f $1$ \u6211\u4eec\u6807\u8bb0\u4e0a\u7b2c\u4e8c\u5217\u4e0e\u7b2c\u516d\u5217\uff0c\u7136\u540e\u5bf9\u4e8e\u8fd9\u4e24\u5217\uff0c\u4ece\u5934\u5f80\u4e0b\u7b97\uff0c\u627e\u5230\u8fd9\u4e24\u5217\u540c\u6837\u662f $1$ \u7684\u884c\u5e76\u5220\u9664\u5b83\u3002\u5728\u4e0a\u56fe\u4e2d\uff0c\u6211\u4eec\u4f1a\u5220\u9664\u6389\u7b2c\u4e8c\u7b2c\u4e09\u884c\uff0c\u5f97\u5230\u4e00\u4e2a $3$ x $5$\u7684\u77e9\u9635\uff1a\n\n| $1$ | $0$ | $1$ | $0$ | $1$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $0$ | $1$ | $0$ | $0$ |\n| $0$ | $1$ | $0$ | $1$ | $1$ |\n\n\u4e4b\u540e\uff0c\u6211\u4eec\u9009\u62e9\u7b2c\u4e00\u884c\uff0c\u6309\u7167\u5982\u4e0a\u89c4\u5219\uff0c\u5220\u53bb\u884c\u540e\uff0c\u53d1\u73b0\u77e9\u9635\u7a7a\u4e86\uff0c\u4f46\u662f\u6211\u4eec\u53ea\u5f97\u5230\u4e86 $5$ \u4e2a $1$ \u3002\u8fd9\u663e\u7136\u662f\u4e0d\u5bf9\u7684\uff0c\u4e8e\u662f\u6211\u4eec\u56de\u6eaf\u4e00\u6b65\uff0c\u9009\u62e9\u7b2c\u4e8c\u884c\uff0c\u6309\u7167\u5982\u4e0a\u89c4\u5219\u5220\u9664\uff0c\u6700\u540e\u4f1a\u5269\u4e0b $3$ \u4e2a $1$ \uff0c\u7b26\u5408\u6211\u4eec\u7684\u9898\u610f\u3002\n\n\u4ee5\u4e0a\u7684\u8fc7\u7a0b\uff0c\u5c31\u662f $X$ \u7b97\u6cd5\u3002\n\n------------\n- ## \u8003\u8651\u5b58\u56fe\u65b9\u6cd5\n\n\u6211\u4eec\u601d\u8003\u5982\u4f55\u6765\u50a8\u5b58\u8fd9\u5f20\u56fe\uff0c\u5982\u679c\u76f4\u63a5\u7528\u4e8c\u7ef4\u77e9\u9635\u7684\u8bdd\u3002\u5220\u9664\u64cd\u4f5c\u548c\u56de\u6eaf\u64cd\u4f5c\u90fd\u4f1a\u7528\u6389\u5f88\u5927\u7684\u7a7a\u95f4\u548c\u65f6\u95f4\uff0c\u8fd9\u663e\u7136\u662f\u5341\u5206\u4e0d\u59a5\u7684\u3002\u6211\u4eec\u8003\u8651\u4e0a\u6587\u5199\u5230\u7684\u7b97\u6cd5\u63cf\u8ff0\uff0c\u5feb\u901f\u5220\u9664\u4e00\u4e2a\u5143\u7d20\uff0c\u94fe\u8868\u5c31\u80fd\u5b9e\u73b0\uff0c\u90a3\u4e48\u5982\u4f55\u5b9e\u73b0\u56de\u6eaf\u5462\uff1f\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u6211\u4eec\u5728\u5220\u9664\u7684\u65f6\u5019\uff0c\u4e0d\u5220\u9664\u8fd9\u4e2a\u70b9\u7684\u7a7a\u95f4\uff0c\u53ea\u662f\u628a\u8fd9\u4e2a\u70b9\u7ed9\u201c\u5ffd\u7565\u201d\u4e86\u3002\u56de\u6eaf\u7684\u65f6\u5019\uff0c\u53ea\u9700\u8981\u628a\u4e0e\u8fd9\u4e2a\u70b9\u76f8\u8fde\u7684\u6307\u9488\u6062\u590d\u56de\u6765\u5c31\u53ef\u4ee5\u4e86\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5728\u8fd9\u91cc\u5f15\u5165\u5341\u5b57\u4ea4\u53c9\u53cc\u5411\u5faa\u73af\u94fe\u8868\u3002\u8fd9\u79cd\u94fe\u8868\u7ed3\u6784\u7684\u6bcf\u4e2a\u7ed3\u70b9\u6709\u4e24\u7c7b\u6570\u636e\uff0c\u5206\u522b\u4e3a\u6307\u9488\u57df\u548c\u6570\u636e\u57df\u3002\u6307\u9488\u57df\u4e3aleft\u3001right\u3001up\u3001down\uff0c\u5206\u522b\u6307\u5411\u5de6\u3001\u53f3\u3001\u4e0a\u3001\u4e0b\u56db\u4e2a\u5176\u5b83\u7ed3\u70b9\uff0c\u6570\u636e\u57df\u5219\u662f\u8fd9\u4e2a\u7ed3\u70b9\u5bf9\u5e94\u4e8e\u539f\u59cb\u77e9\u9635\u7684\u884c\u7f16\u53f7rowIdx\uff0c\u5217\u7f16\u53f7colIdx\u3002\u5bf9\u4e8e\u590d\u6742\u7684\u95ee\u9898\uff0c\u6570\u636e\u57df\u53ef\u80fd\u8fd8\u4f1a\u6709\u66f4\u591a\u7684\u5185\u5bb9\u3002\n\n```cpp\nstruct DLXnode{\n    int r,c;\n    DLXnode *U,*D,*L,*R;\n};\n```\n\n\u90a3\u4e48\uff0c\u5982\u4f55\u5c06\u4e00\u4e2a\u77e9\u9635\u53d8\u4e3a\u4e00\u4e2a\u5341\u5b57\u4ea4\u53c9\u53cc\u5411\u5faa\u73af\u94fe\u8868\u5462\uff1f\u5728DLX\u4e2d\uff0c\u6211\u4eec\u5f15\u5165\u989d\u5916\u8282\u70b9\u6765\u7ef4\u62a4\u8fd9\u4e2a\u7ed3\u6784\uff0c\u5b83\u4eec\u5206\u522b\u662f\uff1a\n\n1. \u603b\u8868\u5934head\uff0c\u5c06\u5217\u4e0e\u884c\u4e32\u8d77\u6765\uff0c\u5b9e\u73b0\u66f4\u5feb\u7684\u5220\u9664\uff0c\u63d2\u5165\u7b49\u64cd\u4f5c\uff0c\u540c\u65f6\u4e3a\u5224\u65ad\u77e9\u9635\u4e3a\u7a7a\u63d0\u4f9b\u4e86\u4fbf\u5229\u3002\n2. \u5217\u9996\u6570\u7ec4col\uff0c\u7ef4\u62a4\u6bcf\u4e00\u5217\u7684\u5143\u7d20\u3002\n3. \u884c\u9996\u8282\u70b9row\uff0c\u7ef4\u62a4\u6bcf\u4e00\u884c\u7684\u5143\u7d20\u3002\n4. \u5143\u7d20\u8282\u70b9node\uff0c\u4e5f\u5c31\u662f\u5728\u8fd9\u4e2a\u77e9\u9635\u4e2d\u7684\u666e\u901a\u8282\u70b9\u3002\n\n>\u5728\u8fd9\u91cc\u5f15\u7528\u4e00\u4e0b\u5927\u4f6c\u7684\u4e00\u7bc7\u535a\u5ba2\uff0c\u5982\u679c\u6211\u7684\u4e0a\u8ff0\u5f62\u5bb9\u6ca1\u6709\u5f88\u597d\u5730\u8ba9\u4f60\u542c\u61c2\uff0c\u4f60\u53ef\u4ee5\u53bb\u770b\u300a[\u8df3\u8dc3\u7684\u821e\u8005\uff0c\u821e\u8e48\u94fe\uff08Dancing Links\uff09\u7b97\u6cd5\u2014\u2014\u6c42\u89e3\u7cbe\u786e\u8986\u76d6\u95ee\u9898](https://www.cnblogs.com/grenet/p/3145800.html)\u300b\u8fd9\u4e00\u7bc7\u6587\u7ae0\uff0c\u5199\u7684\u975e\u5e38\u597d\uff0c\u56fe\u89e3\u975e\u5e38\u8be6\u7ec6(\u7279\u522b\u662f\u76f8\u5bf9\u4e8e\u6211\u8fd9\u4e2a\u6e23\u9898\u89e3)\u3002\u770b\u4e86\u4ed6\u7684\u4ecb\u7ecd\u53ef\u4ee5\u8ba9\u4f60\u66f4\u597d\u5730\u7406\u89e3\u4ee5\u4e0b\u4ee3\u7801(\u6211\u8fd9\u4e2a\u9898\u89e3\u7684\u552f\u4e00\u4f18\u52bf\u53ef\u80fd\u5c31\u5728\u4e8e\u6211\u8fd9\u4e2a\u662fC++\u4e86QAQ)\u3002\n\n\u90a3\u4e48\uff0c\u5f88\u663e\u7136\uff0c\u5f53\u6211\u4eec\u5f97\u5230\u884c\u6570\u548c\u5217\u6570\u65f6\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u521d\u59cb\u5316\u4e86\n```cpp\nvoid init(int r,int c){\n    cnt=0;\n    head.r=r;\n    head.c=c;\n    head.L=head.R=head.U=head.D=&head;\n    for(int i=0;i<c;i++){\n        col[i].r=r;\n        col[i].c=i;\n        col[i].L=&head;\n        col[i].R=head.R;\n        col[i].L->R=col[i].R->L=&col[i];\n        col[i].U=col[i].D=&col[i];\n        sz[i]=0;\n    }\n    for(int i=r-1;i>-1;i--){\n        row[i].r=i;\n        row[i].c=c;\n        row[i].U=&head;\n        row[i].D=head.D;\n        row[i].U->D=row[i].D->U=&row[i];\n        row[i].L=row[i].R=&row[i];\n    }\n}\n```\n\n\n\u521d\u59cb\u5316\u4e4b\u540e\uff0c\u6211\u4eec\u5c31\u8981\u8f93\u5165\u77e9\u9635\u4e86\u3002\u4f46\u5728\u8fd9\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u89c2\u5bdf\u4e00\u4e0b\u95ee\u9898\uff0c\u95ee\u9898\u53ea\u8981\u6c42\u6211\u4eec\u4f7f\u5f97 $1$ \u5b8c\u5168\u8986\u76d6\uff0c\u548c $0$ \u6ca1\u6709\u4efb\u4f55\u5173\u7cfb\u3002\u4e8e\u662f\u6211\u4eec\u4e0d\u96be\u60f3\u5230\uff0c\u5728\u8bfb\u5165\u56fe\u65f6\uff0c\u6211\u4eec\u53ea\u4fdd\u5b58 $1$ \u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u66f4\u65b0node\u7684\u503c\u3002\n\n\u4ee5\u4e0b\u5206\u522b\u4e3a\u63d2\u5165\u548cmain\u51fd\u6570\u8bfb\u5165\u4ee3\u7801\uff1a\n\n```cpp\n scanf(\"%d %d\",&m,&n);\n    init(m,n);\n    int sr;\n    for(int i=0;i<m;i++){\n        for(int j=0;j<n;j++){\n            scanf(\"%d\",&sr);\n            if(sr==1){\n                addnode(i,j);\n            }\n        }\n    }\n```\n\n\n```cpp\ninline void addnode(int r,int c){\n    DLXnode *ptr=&node[cnt++];\n    ptr->r=r;\n    ptr->c=c;\n    ptr->R=&row[r];\n    ptr->L=row[r].L;\n    ptr->L->R=ptr->R->L=ptr;\n    ptr->U=&col[c];\n    ptr->D=col[c].D;\n    ptr->U->D=ptr->D->U=ptr;\n    ++sz[c];\n}\n```\n\n\u5728\u5b8c\u6210\u4e86\u56fe\u7684\u6784\u5efa\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8ba9\u6307\u9488\u821e\u52a8\u8d77\u6765\u4e86\u3002\n\n------------\n- ## Let's dance\uff01\n\n\u9996\u5148\uff0c\u6211\u4eec\u8003\u8651\u5982\u4f55\u5bf9\u4e00\u4e2a\u8282\u70b9\u8fdb\u884c\u5220\u9664\u548c\u56de\u6eaf\u3002\u5982\u4e0a\u6587\uff0c\u6211\u4eec\u5e76\u4e0d\u7528\u5220\u9664\u6389\u8fd9\u4e2a\u884c\u7684\u6bcf\u4e2a\u5143\u7d20\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5bf9\u884c\u9996\uff0c\u5217\u9996\u5143\u7d20\u8fdb\u884c\u64cd\u4f5c\uff0c\u8ba9\u6211\u4eec\u5728\u641c\u7d22\u8fc7\u7a0b\u4e2d\u5ffd\u7565\u6389\u5b83\u4eec\uff0c\u5c31\u5b9e\u73b0\u4e86\u5220\u9664\u64cd\u4f5c\u4e86\uff0c\u540c\u6837\u7684\uff0c\u8fd9\u6837\u505a\u7684\u597d\u5904\u5728\u4e8e\u56de\u6eaf\u7684\u65f6\u5019\u4e0d\u9700\u8981\u5f00\u8f9f\u65b0\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u4e5f\u5c31\u4e0d\u4f1aMLE(money\u6ea2\u51fa)\u3002\n\n```cpp\ninline void delLR(DLXnode *ptr){\n    ptr->L->R=ptr->R;\n    ptr->R->L=ptr->L;\n}\n\ninline void delUD(DLXnode *ptr){\n    ptr->U->D=ptr->D;\n    ptr->D->U=ptr->U;\n}\n\ninline void reLR(DLXnode *ptr){\n    ptr->L->R=ptr->R->L=ptr;\n}\n\ninline void reUD(DLXnode *ptr){\n    ptr->U->D=ptr->D->U=ptr;\n}\n```\n\n\u540c\u7406\uff0c\u5bf9\u4e8e\u884c\u5217\u7684\u5220\u9664\u4e0e\u56de\u6eaf\u64cd\u4f5c\uff0c\u4e5f\u5f88\u5bb9\u6613\u5730\u5c31\u80fd\u5199\u51fa\u6765\u4e86\u3002\n\n```cpp\ninline void cover(int c){\n    if(c==n){\n        return;\n    }\n    delLR(&col[c]);\n    DLXnode *R,*C;\n    for(C=col[c].D;C!=(&col[c]);C=C->D){\n        if(C->c==n){\n            continue;\n        }\n        for(R=C->L;R!=C;R=R->L){\n            if(R->c==n){\n                continue;\n            }\n            --sz[R->c];\n            delUD(R);\n        }\n        delLR(C);\n    }\n}\n\ninline void re(int c){\n    if(c==n){\n        return;\n    }\n    DLXnode *R,*C;\n    for(C=col[c].U;C!=(&col[c]);C=C->U){\n        if(C->c==n){\n            continue;\n        }\n        reLR(C);\n        for(R=C->R;R!=C;R=R->R){\n            if(R->c==n){\n                continue;\n            }\n            ++sz[R->c];\n            reUD(R);\n        }\n    }\n    reLR(&col[c]);\n}\n```\n\n\u5728\u5199\u51fa\u51fd\u6570\u4e3b\u4f53\u90e8\u5206\u524d\uff0c\u6211\u4eec\u5148\u91cd\u65b0\u601d\u8003\u4e00\u904d $X$ \u7b97\u6cd5\n\n1. \u5982\u679c\u77e9\u9635A\u6ca1\u6709\u5217\uff08\u5373\u7a7a\u77e9\u9635\uff09\uff0c\u5219\u5f53\u524d\u8bb0\u5f55\u7684\u89e3\u4e3a\u4e00\u4e2a\u53ef\u884c\u89e3\uff1b\u7b97\u6cd5\u7ec8\u6b62\uff0c\u6210\u529f\u8fd4\u56de\uff1b\n2. \u5426\u5219\u9009\u62e9\u77e9\u9635A\u4e2d\u201c1\u201d\u7684\u4e2a\u6570\u6700\u5c11\u7684\u5217c\uff1b\uff08\u786e\u5b9a\u6027\u9009\u62e9\uff09\n3. a:\u5982\u679c\u5b58\u5728A[r][c]=1\u7684\u884cr\uff0c\u5c06\u884cr\u653e\u5165\u53ef\u884c\u89e3\u5217\u8868\uff0c\u8fdb\u5165\u6b65\u9aa44)\uff1b\uff08\u975e\u786e\u5b9a\u6027\u9009\u62e9\uff09\n\n\u00a0\u00a0\u00a0b.\u5982\u679c\u4e0d\u5b58\u5728A[r][c]=1\u7684\u884cr\uff0c\u5219\u5269\u4e0b\u7684\u77e9\u9635\u4e0d\u53ef\u80fd\u5b8c\u6210\u7cbe\u786e\u8986\u76d6\uff0c\u8bf4\u660e\u4e4b\u524d\u7684\u9009\u62e9\u6709\u9519\uff08\u6216\u8005\u6839\u672c\u5c31\u65e0\u89e3\uff09\uff0c\u9700\u8981\u56de\u6eaf\uff0c\u5e76\u4e14\u6062\u590d\u6b64\u6b21\u5220\u9664\u7684\u884c\u548c\u5217\uff0c\u7136\u540e\u8df3\u5230\u6b65\u9aa43)a\uff1b\n4. \u5bf9\u4e8e\u6240\u6709\u7684\u6ee1\u8db3A[r][j]=1\u7684\u5217j\uff0c\u5bf9\u4e8e\u6240\u6709\u6ee1\u8db3A[i][j]=1\u7684\u884ci\uff0c\u5c06\u884ci\u4ece\u77e9\u9635A\u4e2d\u5220\u9664\uff1b\u5c06\u5217j\u4ece\u77e9\u9635A\u4e2d\u5220\u9664\uff1b\n5.\u00a0\u5728\u4e0d\u65ad\u51cf\u5c11\u7684\u77e9\u9635A\u4e0a\u9012\u5f52\u91cd\u590d\u8c03\u7528\u4e0a\u8ff0\u7b97\u6cd5\uff1b\n\n(\u4ee5\u4e0a $X$ \u7b97\u6cd5\u7684\u4e2d\u6587\u6982\u8ff0\u5f15\u81ea\u4e0e\u535a\u5ba2[\u591c\u6df1\u4eba\u9759\u5199\u7b97\u6cd5\uff08\u4e5d\uff09- Dancing Links X\uff08\u8df3\u821e\u94fe\uff09](https://blog.csdn.net/whereisherofrom/article/details/79220897)\u8be5\u535a\u5ba2\u5185\u5bb9\u4e5f\u5341\u5206\u4f18\u79c0\uff0c\u5982\u679c\u8bfb\u5230\u8fd9\u91cc\u4e5f\u8fd8\u6ca1\u7406\u89e3DLX\u7684\u8bdd\u5f3a\u70c8\u63a8\u8350\u53bb\u9605\u8bfb\u8fd9\u7bc7\u535a\u5ba2\uff0c\u4f46\u535a\u4e3b\u7801\u98ce\u66f4\u504f\u5411\u4e8e\u5de5\u7a0b\u98ce\u3002)\n\n\u90a3\u4e48\uff0c\u663e\u7136\u5730\uff0cdance\u90e8\u5206\u4e5f\u5c31\u80fd\u5199\u51fa\u6765\u4e86\u3002\n\n```cpp\nbool dance(int k){\n    if(head.L==(&head)){\n        for(int i=0;i<k;i++){\n            printf(\"%d \",ans[i]);\n        }\n        return true;\n    }\n    int INF=(1<<30),c=-1;\n    for(DLXnode *ptr=head.L;ptr!=(&head);ptr=ptr->L){\n        if(sz[ptr->c]<INF){\n            INF=sz[ptr->c];\n            c=ptr->c;\n        }\n    }\n    cover(c);\n    DLXnode *ptr;\n    for(ptr=col[c].D;ptr!=(&col[c]);ptr=ptr->D){\n        DLXnode *rc;\n        ptr->R->L=ptr;\n        for(rc=ptr->L;rc!=ptr;rc=rc->L){\n            cover(rc->c);\n        }\n        ptr->R->L=ptr->L;\n        ans[k]=ptr->r+1;\n        if(dance(k+1)){\n            return true;\n        }\n        ptr->L->R=ptr;\n        for(rc=ptr->R;rc!=ptr;rc=rc->R){\n            re(rc->c);\n        }\n        ptr->L->R=ptr->R;\n    }\n    re(c);\n    return false;\n}\n```\n\n------------\n\n- ## \u5b8c\u6574\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int MAXN=1010;\nint ans[MAXN];\nstruct DLXnode{\n    int r,c;\n    DLXnode *U,*D,*L,*R;\n};\nDLXnode node[MAXN*MAXN];\nDLXnode row[MAXN];\nDLXnode col[MAXN];\nDLXnode head;\nint cnt;\nint sz[MAXN];\nint n,m;\n\nvoid init(int r,int c){\n    cnt=0;\n    head.r=r;\n    head.c=c;\n    head.L=head.R=head.U=head.D=&head;\n    for(int i=0;i<c;i++){\n        col[i].r=r;\n        col[i].c=i;\n        col[i].L=&head;\n        col[i].R=head.R;\n        col[i].L->R=col[i].R->L=&col[i];\n        col[i].U=col[i].D=&col[i];\n        sz[i]=0;\n    }\n    for(int i=r-1;i>-1;i--){\n        row[i].r=i;\n        row[i].c=c;\n        row[i].U=&head;\n        row[i].D=head.D;\n        row[i].U->D=row[i].D->U=&row[i];\n        row[i].L=row[i].R=&row[i];\n    }\n}\n\ninline void addnode(int r,int c){\n    DLXnode *ptr=&node[cnt++];\n    ptr->r=r;\n    ptr->c=c;\n    ptr->R=&row[r];\n    ptr->L=row[r].L;\n    ptr->L->R=ptr->R->L=ptr;\n    ptr->U=&col[c];\n    ptr->D=col[c].D;\n    ptr->U->D=ptr->D->U=ptr;\n    ++sz[c];\n}\n\ninline void delLR(DLXnode *ptr){\n    ptr->L->R=ptr->R;\n    ptr->R->L=ptr->L;\n}\n\ninline void delUD(DLXnode *ptr){\n    ptr->U->D=ptr->D;\n    ptr->D->U=ptr->U;\n}\n\ninline void reLR(DLXnode *ptr){\n    ptr->L->R=ptr->R->L=ptr;\n}\n\ninline void reUD(DLXnode *ptr){\n    ptr->U->D=ptr->D->U=ptr;\n}\n\ninline void cover(int c){\n    if(c==n){\n        return;\n    }\n    delLR(&col[c]);\n    DLXnode *R,*C;\n    for(C=col[c].D;C!=(&col[c]);C=C->D){\n        if(C->c==n){\n            continue;\n        }\n        for(R=C->L;R!=C;R=R->L){\n            if(R->c==n){\n                continue;\n            }\n            --sz[R->c];\n            delUD(R);\n        }\n        delLR(C);\n    }\n}\n\ninline void re(int c){\n    if(c==n){\n        return;\n    }\n    DLXnode *R,*C;\n    for(C=col[c].U;C!=(&col[c]);C=C->U){\n        if(C->c==n){\n            continue;\n        }\n        reLR(C);\n        for(R=C->R;R!=C;R=R->R){\n            if(R->c==n){\n                continue;\n            }\n            ++sz[R->c];\n            reUD(R);\n        }\n    }\n    reLR(&col[c]);\n}\n\nbool dance(int k){\n    if(head.L==(&head)){\n        for(int i=0;i<k;i++){\n            printf(\"%d \",ans[i]);\n        }\n        return true;\n    }\n    int INF=(1<<30),c=-1;\n    for(DLXnode *ptr=head.L;ptr!=(&head);ptr=ptr->L){\n        if(sz[ptr->c]<INF){\n            INF=sz[ptr->c];\n            c=ptr->c;\n        }\n    }\n    cover(c);\n    DLXnode *ptr;\n    for(ptr=col[c].D;ptr!=(&col[c]);ptr=ptr->D){\n        DLXnode *rc;\n        ptr->R->L=ptr;\n        for(rc=ptr->L;rc!=ptr;rc=rc->L){\n            cover(rc->c);\n        }\n        ptr->R->L=ptr->L;\n        ans[k]=ptr->r+1;\n        if(dance(k+1)){\n            return true;\n        }\n        ptr->L->R=ptr;\n        for(rc=ptr->R;rc!=ptr;rc=rc->R){\n            re(rc->c);\n        }\n        ptr->L->R=ptr->R;\n    }\n    re(c);\n    return false;\n}\n\nint main(){\n    scanf(\"%d %d\",&m,&n);\n    init(m,n);\n    int sr;\n    for(int i=0;i<m;i++){\n        for(int j=0;j<n;j++){\n            scanf(\"%d\",&sr);\n            if(sr==1){\n                addnode(i,j);\n            }\n        }\n    }\n    if(!dance(0)){\n        cout<<\"No Solution!\"<<endl;\n    }\n}\n```",
        "postTime": 1540278301,
        "uid": 102473,
        "name": "Setsugesuka",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4929 \u3010\u3010\u6a21\u677f\u3011\u821e\u8e48\u94fe\uff08DLX\uff09\u3011"
    },
    {
        "content": "- **\u524d\u8a00**\n\n  >\u6316\u5751\uff0c\u5f00\u59cb\u586b\u3002--2021/04/26\n  >\n  >\u586b\u5b8c\u4e86\uff08\uff1f\u7adf\u7136\u6ca1\u9e3d\u3002\uff09 --2021/04/27\n  >\n  >**upd 2022/01/24:** \u56e0\u4e3a\u67d0\u53e5\u8bdd\u63cf\u8ff0\u7684\u6709\u95ee\u9898\uff0c\u9020\u6210\u4e86\u4e00\u4e9b\u8bef\u89e3\u3002\u611f\u8c22 @[_Felix](https://www.luogu.com.cn/user/106738) \n  \n  \u300a\u5173\u4e8e\u6211\u4e0d\u60f3\u641e whk \u4e8e\u662f\u5c31\u6765\u5199\u535a\u5ba2\u8fd9\u4ef6\u4e8b\u3002\u300b\n  \n  \u4e0d\u662f\u4ec0\u4e48\u9b3c\u554a\u5582\u3002\n  \n  **\u5982\u679c\u6709\u4e0d\u8db3\u7684\u5730\u65b9\u6b22\u8fce\u968f\u65f6\u6307\u51fa**\uff0c\u7136\u540e\u6c42\u8d5e\uff08\uff1f\uff09\u3002\n\n------------\n\n- **DLX \u662f\u4ec0\u4e48**\n\n  **D**ancing **L**inks **X** \u5373\u821e\u8e48\u94fe\u662f\u4e00\u79cd\u9ad8\u6548\u7684\u6570\u636e\u7ed3\u6784\uff0c\u7528\u6765\u4f18\u5316\u4e00\u4e9b\u641c\u7d22\u3002\n\n  \u5904\u7406\u7684\u95ee\u9898\u4e3b\u8981\u5305\u62ec $2$ \u79cd\u7c7b\u578b\uff0c\u4e00\u7c7b\u662f**\u7cbe\u786e\u8986\u76d6\u95ee\u9898**\uff0c\u53e6\u4e00\u7c7b\u662f**\u91cd\u590d\u8986\u76d6\u95ee\u9898**\u3002\n  \n  \u90a3\u4e48\u63a5\u4e0b\u6765\u5148\u7ed9\u51fa**\u7cbe\u786e\u8986\u76d6\u95ee\u9898**\u7684\u6a21\u677f\u9898\uff0c\u5373[\u6d1b\u8c37 P4929 \u3010\u6a21\u677f\u3011\u821e\u8e48\u94fe\uff08DLX\uff09](https://www.luogu.com.cn/problem/P4929)\u3002\n  \n  >\u7ed9\u5b9a\u4e00\u4e2a $n$ \u884c $m$ \u5217\u7684\u77e9\u9635\uff0c\u77e9\u9635\u4e2d\u6bcf\u4e2a\u5143\u7d20\u8981\u4e48\u662f $1$ \uff0c\u8981\u4e48\u662f $0$ \u3002\n  >\n  >\u4f60\u9700\u8981\u5728\u77e9\u9635\u4e2d\u6311\u9009\u51fa\u82e5\u5e72\u884c\uff0c\u4f7f\u5f97\u5bf9\u4e8e\u77e9\u9635\u7684\u6bcf\u4e00\u5217 $j$ \uff0c\u5728\u4f60\u6311\u9009\u7684\u8fd9\u4e9b\u884c\u4e2d\uff0c**\u6709\u4e14\u4ec5\u6709**\u4e00\u884c\u7684\u7b2c $j$ \u4e2a\u5143\u7d20\u4e3a $1$ \u3002\n  \n  \u9996\u5148\u6613\u5f97\uff0c\u5927\u66b4\u641c\u7684\u590d\u6742\u5ea6\u662f $\\mathcal{O}(m\\cdot2^n)$\n  \n  \u5b9e\u9645\u4e0a\uff0c**\u8fd9\u5c5e\u4e8e NP \u5b8c\u5168\u95ee\u9898**\uff0c\u4e5f\u5c31\u662f\u6ca1\u6709\u591a\u9879\u5f0f\u7b97\u6cd5\u3002\n  \n  \u4f46\u662f DLX \u5374\u53ef\u4ee5\u5728\u5927\u5927\u63d0\u9ad8\u641c\u7d22\u7684\u6548\u7387\uff0c\u5728\u672c\u9898\u4e2d\uff0c\u53ef\u4ee5\u89e3\u51b3\u7684\u8303\u56f4\u4e3a $n,m \\le 500$ \uff0c\u5176\u4e2d\u4fdd\u8bc1\u77e9\u9635\u4e2d $1$ \u7684\u6570\u91cf\u4e0d\u8d85\u8fc7 $5000$ \u4e2a\u3002\n  \n  **\u91cd\u590d\u8986\u76d6\u95ee\u9898**\u7c7b\u4f3c\uff0c\u53ea\u6709\u4e24\u70b9\u4e0d\u540c\u3002\u4e0b\u8fb9\u5df2\u52a0\u7c97\u3002\n  \n  \u7531\u4e8e\u6d1b\u8c37\u5e76\u6ca1\u6709\u91cd\u590d\u8986\u76d6\u6a21\u677f\u9898\uff0c\u6240\u4ee5\u4ee5\u4e0b\u7ed9\u51fa\u6a21\u677f\u95ee\u9898\uff1a\n\n  >\u7ed9\u5b9a\u4e00\u4e2a $N$ \u884c $M$ \u5217\u7684\u77e9\u9635\uff0c\u77e9\u9635\u4e2d\u6bcf\u4e2a\u5143\u7d20\u8981\u4e48\u662f $1$ \uff0c\u8981\u4e48\u662f $0$ \u3002\n  >\n  >\u4f60\u9700\u8981\u5728\u77e9\u9635\u4e2d\u9009\u62e9\u82e5\u5e72\u884c\uff0c\u4f7f\u6bcf\u4e00\u5217\u90fd**\u81f3\u5c11**\u5305\u542b\u4e00\u4e2a $1$ \uff0c\u5e76\u4e14\u8981\u6c42**\u9009\u62e9\u7684\u884c\u6570\u6700\u5c11**\u3002\n\n------------\n\n- **\u5341\u5b57\u94fe\u8868**\n\n  \u4e13\u95e8\u7528\u6765 DLX \u7684\u4e1c\u897f\uff0c\u5c5e\u4e8e\u524d\u7f6e\u77e5\u8bc6\u3002\n  \n  ~~\u987e\u540d\u601d\u4e49\uff0c~~ \u5341\u5b57\u6837\u5b50\u7684\u94fe\u8868\u3002**\u4e0b\u9762\u7528 $row_i$ \u8868\u793a\u884c $col_j$ \u8868\u793a\u5217\u3002**\n  \n  \u4ee5\u4e0b\u662f\u5341\u5b57\u94fe\u8868\u521d\u59cb\u72b6\u6001 ~~\uff0c\u4ec0\u4e48\u4e2d\u95f4\u592a\u7a7a\u4e86\u653e\u70b9\u4e1c\u897f\u597d\u8036~~ \u3002\n  \n  ![](https://i.loli.net/2021/04/26/ePdQVaDjYG7NwJ4.png)\n  \n  \u63a5\u4e0b\u6765\uff0c\u56e0\u4e3a\u6211\u4e0d\u559c\u6b22\u8fd9\u4e2a\u6837\u4f8b\uff0c\u6240\u4ee5\u6211\u624b\u9020\u4e00\u4e2a\u6765\u8bb2\u5427\u3002\n  \n  ```\n  1 0 0\n  0 1 0\n  1 0 1\n  ```\n  \n  \u9996\u5148\u52a0\u4e0a\u7b2c\u4e00\u4e2a\u70b9 $(1,1)$ \u3002\n  \n  ![](https://i.loli.net/2021/04/26/psQuXTvYJocfnWL.png)\n  \n  \u540c\u7406\uff0c\u52a0\u4e0a\u70b9 $(2,2)$ \u548c $(3,3)$ \u3002\n  \n  ![](https://i.loli.net/2021/04/26/Qnb8qxPcRmYtEX1.png)\n  \n  \u7136\u540e\u52a0\u4e0a $(3,1)$ \u3002\n  \n  ![](https://i.loli.net/2021/04/26/yS57XrATOf8CkZb.png)\n  \n  \u5220\u9664\u7684\u65f6\u5019\uff0c\u7c7b\u4f3c\u628a\u4e0a\u9762\u7684\u56fe\u5012\u7740\u770b\uff08\uff1f\uff09\u3002\n  \n  \u8fd9\u4e9b\u5c31\u662f\u5341\u5b57\u94fe\u8868\u7684\u8981\u7528\u7684\u77e5\u8bc6\u4e86\u3002\u4e0b\u9762\u8fdb\u5165\u6b63\u9898\u3002\n\n------------\n\n- **\u7cbe\u786e\u8986\u76d6\u95ee\u9898**\n\n  \u9996\u5148\uff0c\u5148\u6765\u8003\u8651\u5927\u66b4\u641c\u5982\u4f55\u4f18\u5316\u3002\n  \n  \u7ed9\u5b9a\u4e00\u4e2a\u77e9\u9635\u3002\n  \n  ```\n  1 1 1 0 0 0 0\n  0 0 1 1 1 0 1\n  0 0 0 1 1 1 1\n  1 0 0 0 1 1 1\n  0 0 0 1 1 0 0\n  ```\n  \n  \u6bd4\u5982\u6211\u4eec\u9996\u5148\u9009\u4e86\u7b2c $1$ \u884c\uff0c\u7136\u540e\u53d1\u73b0\u7b2c\u4e00\u884c\u7684\u524d $3$ \u5217\u90fd\u662f $1$ \u3002\n  \n  \u90a3\u4e48\u6211\u4eec\u80af\u5b9a**\u4e0d\u80fd\u518d\u9009\u542b\u6709\u524d $3$ \u5217\u4e3a $1$ \u7684\u884c**\uff0c\u4e5f\u5c31\u662f\u7b2c $2,4$ \u884c\u3002\n  \n  ![](https://i.loli.net/2021/04/26/plKMGcNJgm7wv65.png)\n  \n  \u90a3\u4e48\u6211\u4eec**\u5c06\u4ed6\u4eec\u4e00\u8d77\u5220\u9664\u3002**\n  \n  ![](https://i.loli.net/2021/04/26/C2SIibMc1eTQjKY.png)\n  \n  \u90a3\u4e48\u63a5\u4e0b\u6765\u4e5f\u5c31\u540c\u7406\u4e86\u3002\n  \n  \u5f53**\u6240\u6709\u5217\u90fd\u88ab\u5220\u540e**\uff0c\u5c31\u53ef\u4ee5\u5224\u5b9a\u6709\u89e3\u5e76\u4e14\u8fd4\u56de\u4e86\u3002\n  \n  \u6240\u4ee5\u63a5\u4e0b\u6765\u7684\u95ee\u9898\u5c31\u662f\u5982\u4f55\u9ad8\u6548\u5224\u65ad\u8981\u5220\u9664\u7684\u884c\u3002\n  \n  \u5f88\u81ea\u7136\u7684\u60f3\u5230\u4e86\u5341\u5b57\u94fe\u8868 ~~\uff08\u56e0\u4e3a\u4ed6\u662f\u524d\u7f6e\u77e5\u8bc6\uff09~~ \uff0c\u6bcf\u6b21\u5220\u9664\u65f6\uff0c**\u5728\u5bf9\u5e94\u4e00\u5217\u4e0b\u53bb\u7684\u628a\u6bcf\u4e2a\u70b9\u5bf9\u5e94\u4e00\u6a2a\u6e9c\u8fc7\u53bb\u7684\u6bcf\u4e2a\u70b9\u90fd\u5220\u6389\u3002**\n  \n  \u6240\u4ee5\u53ef\u4ee5\u53d1\u73b0\uff0cDLX \u7684\u6548\u7387\u548c $1$ \u6570\u91cf\u6709\u5173\u3002\n  \n  \u6b64\u5916\uff0c\u6bcf\u6b21\u627e\u884c\u662f\uff0c**\u6211\u4eec\u4f18\u5148\u9009\u62e9 $1$ \u6700\u591a\u7684\u884c**\n  \n  \u53e6\u5916\uff0c\u56e0\u4e3a\u662f\u5728 dfs \u4e2d\uff0c\u6240\u4ee5**\u56de\u6eaf\u7684\u65f6\u5019\u8981\u628a\u5220\u7684\u70b9\u5728\u52a0\u56de\u53bb\u3002**\n\n  \u73b0\u5728\u653e\u51fa\u4ee3\u7801\u3002\n  \n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<cstring>\nusing namespace std;\nconst int Maxn=5000+500+10;\nint n,m,l[Maxn],r[Maxn],u[Maxn],d[Maxn];// \u5341\u5b57\u94fe\u8868\u5de6\u53f3\u4e0a\u4e0b\nint idx,ansn,ans[Maxn],s[Maxn],row[Maxn],col[Maxn];\nvoid init() // \u9884\u5904\u7406 \n{\t\n\tfor(int i=0;i<=m;i++)\n\t{\t\n\t\tl[i]=i-1;r[i]=i+1;\n\t\tu[i]=d[i]=i; \n\t}\n\tl[0]=m;r[m]=0; // \u6ce8\u610f\u5341\u5b57\u94fe\u8868\u662f\u6536\u5c3e\u76f8\u63a5 \n\tidx=m+1;\n}\nvoid add(int &hd,int &tl,int x,int y) // \u5341\u5b57\u94fe\u8868\u52a0\u70b9 \n{\t\n\trow[idx]=x;col[idx]=y;s[y]++;\n\tu[idx]=y;d[idx]=d[y];u[d[y]]=idx;d[y]=idx;\n\tr[hd]=l[tl]=idx;r[idx]=tl;l[idx]=hd;\n\ttl=idx++;\n}\nvoid remove(int p) // \u5220\u9664 \n{\t\n\tr[l[p]]=r[p];l[r[p]]=l[p];\n\tfor(int i=d[p];i!=p;i=d[i])\n\t\tfor(int j=r[i];j!=i;j=r[j])\n\t\t{\t\n\t\t\ts[col[j]]--;\n\t\t\tu[d[j]]=u[j];d[u[j]]=d[j];\n\t\t}\n}\nvoid resum(int p) // \u590d\u539f \n{\t\n\tfor(int i=u[p];i!=p;i=u[i])\n\t\tfor(int j=l[i];j!=i;j=l[j])\n\t\t{\t\n\t\t\tu[d[j]]=j;d[u[j]]=j;\n\t\t\ts[col[j]]++;\n\t\t}\n\tr[l[p]]=p;l[r[p]]=p;\n}\nbool dfs()\n{\t\n\tif(!r[0])return 1;\n\tint p=r[0];\n\tfor(int i=r[0];i;i=r[i])\n\t\tif(s[i]<s[p])p=i; // \u4f18\u5148\u9009\u62e9 1 \u6700\u591a\u7684\u884c\n\tremove(p);\n\tfor(int i=d[p];i!=p;i=d[i])\n\t{\t\n\t\tans[++ansn]=row[i];\n\t\tfor(int j=r[i];j!=i;j=r[j])remove(col[j]);\n\t\tif(dfs())return 1;\n\t\tfor(int j=l[i];j!=i;j=l[j])resum(col[j]);\n\t\tansn--;\n\t}\n\tresum(p);\n\treturn 0;\n}\nint main()\n{\t\n\tscanf(\"%d%d\",&n,&m);\n\tinit();\n\tfor(int i=1;i<=n;i++)\n\t{\t\n\t\tint hd=idx,tl=idx;\n\t\tfor(int j=1;j<=m;j++)\n\t\t{\t\n\t\t\tint x;\n\t\t\tscanf(\"%d\",&x);\n\t\t\tif(x)add(hd,tl,i,j);\n\t\t}\n\t}\n\tif(dfs())\n\t\tfor(int i=1;i<=ansn;i++)\n\t\t\tprintf(\"%d \",ans[i]);\n\telse printf(\"No Solution!\");\n\tprintf(\"\\n\");\n\treturn 0;\n}\n```\n\n------------\n\n- **\u91cd\u590d\u8986\u76d6\u95ee\u9898**\n\n  \u89e3\u51b3\u65b9\u6cd5\u548c\u7cbe\u786e\u8986\u76d6\u7c7b\u4f3c\uff0c**\u4f46\u6709\u524d\u7f6e\u77e5\u8bc6 IDA\\* \u7b97\u6cd5\u3002** \u5efa\u8bae\u6ca1\u6709\u5b66\u8fc7\u7684\u5148\u53bb\u8865\u4e00\u4e0b\u3002\n  \n  \u56e0\u4e3a\u662f\u81f3\u5c11\u4e00\u4e2a $1$ \uff0c\u6240\u4ee5\u540c\u4e00\u5217\u5b58\u5728\u591a\u4e2a $1$ \u662f\u5408\u6cd5\u7684\u3002\n  \n  \u6362\u53e5\u8bdd\u8bf4\uff0c**\u5c31\u76f8\u5f53\u4e8e\u6211\u4eec\u4e4b\u524d\u7684\u540c\u65f6\u5220\u9664\u591a\u4e2a\u884c\u7684\u505a\u6cd5\uff0c\u4e0d \u884c \u4e86 \u3002**\n  \n  \u90a3\u4e48\u5c31\u76f8\u5f53\u4e8e\u4e4b\u524d\u627e\u5217\u4e5f\u6ca1\u610f\u4e49\u4e86\uff0c\u56e0\u4e3a\u6bcf\u4e00\u5217\u90fd\u6709\u53ef\u80fd\u3002\n  \n  \u6240\u4ee5\u6211\u4eec\u7b80\u5355\u6539\u4e00\u4e0b\u4ee3\u7801\u3002\n  \n  \u9996\u5148\u662f\u4fee\u6539\u548c\u6062\u590d\u90e8\u5206\uff0c**\u4e0d\u518d\u9700\u8981\u5220\u9664\u4e00\u5217\u8fc7\u53bb\u7684\u70b9\u3002**\n  \n  \u6bcf\u6b21\u4f18\u5148\u627e\u5230 $1$ \u6700\u591a\u7684\u5217\u65f6\uff0c\u4e5f\u4e0d\u518d\u9700\u8981\u5220\u9664\u8fd9\u4e00\u5217\u4e86\u3002\n  \n  \u4f46\u662f\u8fd9\u6837\u6548\u7387\u660e\u663e\u5dee\u5f88\u591a\u4e86\u3002\n  \n  \u4e8e\u662f\u6211\u4eec\u8003\u8651\u7c7b\u4f3c IDA* \u6765\u641e\u3002\n  \n  \u5148\u7528\u4e00\u4e2a\u6570\u7ec4 $tot$ \u6765\u4ece\u5c0f\u5230\u5927\u679a\u4e3e\u8981\u7684\u884c\u6570\uff0c\u5728 dfs \u4e2d\u7528\u4e00\u4e2a\u4f30\u4ef7\u51fd\u6570\uff0c**\u4f30\u4e00\u4e0b\u76ee\u524d\u8fd8\u8981\u591a\u5c11\u884c**\uff0c\u5982\u679c\u5f53\u524d\u884c\u6570\u52a0\u4e0a\u4f30\u4ef7\u51fd\u6570\u5927\u4e8e $tot$ \u8fd4\u56de\u65e0\u89e3\u5373\u53ef\u3002\n  \n  \u800c\u4f30\u4ef7\u51fd\u6570\u5462\uff0c\u7528\u8d2a\u5fc3\u6280\u6570\u4e0b\u5c31\u53ef\u4ee5\u4e86\u3002\n  \n  \u5177\u4f53\u8be6\u89c1\u4ee3\u7801\u3002\n  \n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\nusing namespace std;\nconst int Maxn=10000+5;\nint n,m,l[Maxn],r[Maxn],u[Maxn],d[Maxn],s[Maxn];\nint idx,tot,ans[Maxn],col[Maxn],row[Maxn];\nbool st[Maxn];\nvoid init()\n{\t\n\tfor(int i=0;i<=m;i++)\n\t{\t\n\t\tl[i]=i-1;r[i]=i+1;\n\t\tu[i]=d[i]=col[i]=i;\n\t\ts[i]=0;\n\t}\n\tl[0]=m;r[m]=0;\n\tidx=m+1;\n}\nint h() //\u4f30\u4ef7\u51fd\u6570 \n{\t\n\tint cnt=0;\n\tmemset(st,0,sizeof(st));\n\tfor(int i=r[0];i;i=r[i])\n\t{\t\n\t\tif(st[col[i]])continue;\n\t\tcnt++;\n\t\tst[col[i]]=1;\n\t\tfor(int j=d[i];j!=i;j=d[j])\n\t\t\tfor(int k=r[j];k!=j;k=r[k])\n\t\t\t\tst[col[k]]=1;\n\t}\n\treturn cnt;\n} \nvoid add(int &hd,int &tl,int x,int y)\n{\t\n\trow[idx]=x;col[idx]=y;s[y]++;\n\tu[idx]=y;d[idx]=d[y];u[d[y]]=idx;d[y]=idx;\n\tr[hd]=l[tl]=idx;r[idx]=tl;l[idx]=hd;\n\ttl=idx++;\n}\nvoid remove(int p) // \u6ce8\u610f\u5217\u5e76\u4e0d\u4f1a\u5220\u9664 \n{\t\n\tfor(int i=d[p];i!=p;i=d[i])\n\t\tr[l[i]]=r[i],l[r[i]]=l[i];\n}\nvoid resum(int p) // \u540c\u4e0a \n{\t\n\tfor(int i=u[p];i!=p;i=u[i])\n\t\tr[l[i]]=i,l[r[i]]=i;\n}\nbool dfs(int k)\n{\t\n\tif(k+h()-1>tot)return 0;\n\tif(!r[0])return 1;\n\tint p=r[0];\n\tfor(int i=r[0];i;i=r[i])\n\t\tif(s[p]>s[i])p=i;\n\t// \u6ce8\u610f\u9009\u5b8c\u5217\uff0cp \u6240\u5728\u7684\u5217\u5e76\u4e0d\u4f1a\u5220\u9664\u3002 \n\tfor(int i=d[p];i!=p;i=d[i])\n\t{\t\n\t\tans[k]=row[i];\n\t\tremove(i);\n\t\tfor(int j=r[i];j!=i;j=r[j])remove(j);\n\t\tif(dfs(k+1))return 1;\n\t\tfor(int j=l[i];j!=i;j=l[j])resum(j);\n\t\tresum(i);\n\t}\n\treturn 0;\n}\nint main()\n{\t\n\tscanf(\"%d%d\",&n,&m);\n\tinit();\n\tfor(int i=1;i<=n;i++)\n\t{\t\n\t\tint hd=idx,tl=idx;\n\t\tfor(int j=1;j<=m;j++)\n\t\t{\t\n\t\t\tint x;\n\t\t\tscanf(\"%d\",&x);\n\t\t\tif(x)add(hd,tl,i,j);\n\t\t}\n\t}\n\ttot=0;\n\twhile(!dfs(1))tot++;\n\tprintf(\"%d\\n\",tot);\n\tfor(int i=1;i<=tot;i++)\n\t\tprintf(\"%d \",ans[i]);\n\treturn 0;\n}\n```\n\n------------\n\n- **DLX \u7684\u7ec3\u4e60\u9898**\n\n  \u8fd9\u662f\u6211\u4e4b\u524d\u6574\u7406\u7684\u4e00\u4efd\u9898\u5355\uff1a[\u300c\u821e\u8e48\u94feDLX\u300d\u306e \u5b66\u4e60\u9898\u5355](https://www.luogu.com.cn/training/57092) \u3002\n  \n  \u4f46\u662f\u56e0\u4e3a\u6211\u9898\u5237\u7684\u5c11\uff0c\u89c1\u8bc6\u4e5f\u5c11\uff0c\u9898\u5355\u91cc\u7684\u9898\u6570\u4e0d\u591a\uff0c\u8fd8\u6709 $2,3$ \u9898\u51e0\u4e4e\u662f\u591a\u500d\u7ecf\u9a8c\u3002\n  \n  \u4f46\u9898\u5355\u662f\u5904\u4e8e\u6301\u7eed\u66f4\u65b0\u72b6\u6001\uff0c**\u5982\u679c\u5f80\u540e\u505a\u9898\u8fd8\u78b0\u5230\uff0c\u4f1a\u4e0d\u5b9a\u671f\u7684\u8865\u5145\uff0c\u4e5f\u6b22\u8fce\u5927\u5bb6\u6765\u8865\u5145\u3002**\n  \n  \u4e0b\u9762\u4e3e\u4f8b\u4e24\u4e2a\u4f8b\u9898\u3002\n\n------------\n\n- **SP1110 SUDOKU - Sudoku**\n\n  \u9898\u76ee\u94fe\u63a5\uff1a[Link.](https://www.luogu.com.cn/problem/SP1110)\n  \n  >\u4e00\u4e2a\u6570\u72ec\u7684\u7f51\u683c\u662f\u7531 $16 \\times 16$ \u4e2a\u5c0f\u683c\u7ec4\u6210\u7684, \u8fd9\u4e9b\u5c0f\u683c\u53c8\u88ab\u5206\u4e3a $4 \\times 4=16$ \u4e2a\u5c0f\u7ec4, \u4e00\u4e9b\u5c0f\u683c\u586b\u5165\u4e86\u4ece $A$ \u81f3 $P$ (\u5b57\u6bcd\u8868\u524d $16$ \u4e2a)\u7684\u5b57\u6bcd\uff0c\u4e0d\u8fc7\u4e00\u822c\u586b\u6210\u6570\u5b57\u3002\n\n  >\u6e38\u620f\u76ee\u7684\u662f\u5c06\u6240\u6709\u5c0f\u683c\u586b\u6ee1\uff0c\u800c\u4f7f\u6bcf\u884c\uff0c\u6bcf\u5217\u548c\u6bcf\u4e2a$4 \\times 4$ \u5c0f\u7ec4\u4e2d\u4e0d\u91cd\u590d\u7684\u5305\u542b\u8fd9 $16$ \u4e2a\u5b57\u6bcd\u3002\n\n  >\u7ed9\u51fa\u7684\u521d\u59cb\u72b6\u6001\u6ee1\u8db3\u4ee5\u4e0a\u8981\u6c42\u4e14\u6ee1\u8db3\u552f\u4e00\u89e3\u3002\n  \n  ~~\u8bf4\u771f\u7684\uff0c\u505a\u821e\u8e48\u94fe\u7684\u9898\uff0c\u4f60\u9996\u5148\u4e0d\u80fd\u628a\u4ed6\u5f53\u77e9\u9635\u770b\uff08~~\n  \n  \u6570\u72ec\u662f\u771f\u7684\u7b97\u5f88\u7ecf\u5178\u7684\u9898\u4e86\u3002\n  \n  \u9996\u5148\u6211\u4eec\u7b80\u5316\u4e00\u4e0b\u9898\u76ee\uff0c\u5bf9\u4e8e\u4e00\u4e2a $16 \\times 16$ \u7684\u77e9\u9635\uff0c\u6bcf\u4e00\u884c\u5fc5\u987b\u6709 $1-16$ \uff0c\u6bcf\u4e00\u5217\u5fc5\u987b\u6709 $1-16$ \uff0c\u6bcf\u4e00 $16$ \u5bab\u683c\u5fc5\u987b\u6709 $1-16$ \u3002\n  \n  \u518d\u6362\u4e2a\u8bf4\u6cd5\uff0c\u6bd4\u5982\u6211\u4eec**\u5b9a\u4e49\u4e00\u4e2a $(i,j,k) \\in \\{ 0,1 \\}$ \uff0c\u8868\u793a\u4f4d\u4e8e $(i,j)$ \u586b\u7684\u6570\u5b57\u662f\u5426 $k$ \u3002**\n  \n  \u4e5f\u5c31\u662f\uff0c\u5bf9\u4e8e\u4e00\u4e2a $16 \\times 16$ \u7684\u77e9\u9635\uff0c\u6bcf\u4e00\u884c\u90fd**\u5fc5\u987b\u6ee1\u8db3\u5bf9\u4e8e\u6bcf\u4e2a $k$ \uff0c\u5b58\u5728\u4e00\u4e2a\u4e3a $1$ \uff0c** \u6bcf\u4e00\u5217\u90fd\u5fc5\u987b\u6ee1\u8db3\u5bf9\u4e8e\u6bcf\u4e2a $k$ \uff0c\u5b58\u5728\u4e00\u4e2a\u4e3a $1$ \uff0c\u6bcf\u4e00\u5bab\u683c\u90fd\u5fc5\u987b\u6ee1\u8db3\u5bf9\u4e8e\u6bcf\u4e2a $k$ \uff0c\u5b58\u5728\u4e00\u4e2a\u4e3a $1$ \u3002\n  \n  \u53d1\u73b0\u8fd9\u5c31\u662f\u4e2a DLX \u7cbe\u786e\u8986\u76d6\u95ee\u9898\u3002\n  \n  \u90a3\u4e48\u95ee\u9898\u89e3\u51b3\u4e86\u3002\u5177\u4f53\u4ee3\u7801\u7ec6\u8282\u5982\u4e0b\uff1a\n  \n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<cstring>\nusing namespace std;\nconst int Maxn=20000;\nstruct node{\n\tint x,y;\n\tchar c;\n}op[Maxn];\nint m=16*16*4,l[Maxn],r[Maxn],u[Maxn],d[Maxn];// \u5341\u5b57\u94fe\u8868\u5de6\u53f3\u4e0a\u4e0b\nint idx,ansn,ans[Maxn],s[Maxn],row[Maxn],col[Maxn];\nchar c[20][20];\nvoid init() // \u9884\u5904\u7406 \n{\t\n\tfor(int i=0;i<=m;i++)\n\t{\t\n\t\tl[i]=i-1;r[i]=i+1;s[i]=0;\n\t\tu[i]=d[i]=i;\n\t}\n\tl[0]=m;r[m]=0;\n\tidx=m+1;\n}\nvoid add(int &hd,int &tl,int x,int y)\n{\t\n\trow[idx]=x;col[idx]=y;s[y]++;\n\tu[idx]=y;d[idx]=d[y];u[d[y]]=idx;d[y]=idx;\n\tr[hd]=l[tl]=idx;r[idx]=tl;l[idx]=hd;\n\ttl=idx++;\n}\nvoid remove(int p)\n{\t\n\tr[l[p]]=r[p];l[r[p]]=l[p];\n\tfor(int i=d[p];i!=p;i=d[i])\n\t\tfor(int j=r[i];j!=i;j=r[j])\n\t\t{\t\n\t\t\ts[col[j]]--;\n\t\t\tu[d[j]]=u[j];d[u[j]]=d[j];\n\t\t}\n}\nvoid resum(int p)\n{\t\n\tfor(int i=u[p];i!=p;i=u[i])\n\t\tfor(int j=l[i];j!=i;j=l[j])\n\t\t{\t\n\t\t\tu[d[j]]=j;d[u[j]]=j;\n\t\t\ts[col[j]]++;\n\t\t}\n\tr[l[p]]=p;l[r[p]]=p;\n}\nbool dfs()\n{\t\n\tif(!r[0])return 1;\n\tint p=r[0];\n\tfor(int i=r[0];i;i=r[i])\n\t\tif(s[i]<s[p])p=i;\n\tremove(p);\n\tfor(int i=d[p];i!=p;i=d[i])\n\t{\t\n\t\tans[++ansn]=row[i];\n\t\tfor(int j=r[i];j!=i;j=r[j])remove(col[j]);\n\t\tif(dfs())return 1;\n\t\tfor(int j=l[i];j!=i;j=l[j])resum(col[j]);\n\t\tansn--;\n\t}\n\tresum(p);\n\treturn 0;\n}\nvoid w()\n{\t\n\tmemset(r,0,sizeof(r));memset(u,0,sizeof(u));\n\tmemset(l,0,sizeof(l));memset(u,0,sizeof(u));\n\tmemset(s,0,sizeof(s));\n\tmemset(col,0,sizeof(col));\n\tmemset(row,0,sizeof(row));\n}\nint main()\n{\tint T,cases=0;\n\tscanf(\"%d\",&T);\n\twhile(T--)\n\t{\t\n\t\tfor(int i=0;i<16;i++)\n\t\t\tscanf(\"%s\",c[i]);\n\t\tif(cases)printf(\"\\n\");\n\t\tcases++;\n\t\tw();\n\t\tinit();\n\t\tfor(int i=0,n=1;i<16;i++)\n\t\t\tfor(int j=0;j<16;j++)\n\t\t\t{\t\n\t\t\t\tint a=0,b=15;\n\t\t\t\tif(c[i][j]!='-')a=b=c[i][j]-'A';\n\t\t\t\tfor(int k=a;k<=b;k++,n++)\n\t\t\t\t{\t\n\t\t\t\t\tint hd=idx,tl=idx;\n\t\t\t\t\top[n].x=i;op[n].y=j;op[n].c=k+'A';\n\t\t\t\t\tadd(hd,tl,n,i*16+j+1);\n\t\t\t\t\tadd(hd,tl,n,256+i*16+k+1);\n\t\t\t\t\tadd(hd,tl,n,256*2+j*16+k+1);\n\t\t\t\t\tadd(hd,tl,n,256*3+(i/4*4+j/4)*16+k+1);\n\t\t\t\t}\n\t\t\t}\n\t\tdfs();\n\t\tfor(int i=1;i<=ansn;i++)\n\t\t\tc[op[ans[i]].x][op[ans[i]].y]=op[ans[i]].c;\n\t\tfor(int i=0;i<16;i++)\n\t\t\tprintf(\"%s\\n\",c[i]);\n\t}\n\treturn 0;\n}\n```\n\n------------\n\n- **UVA1603 \u7834\u574f\u6b63\u65b9\u5f62 Square Destroyer**\n\n  ~~\u8fd9\u7bc7\u6211\u751a\u81f3\u5199\u8fc7\u9898\u89e3\u90a3\u5c31\u76f4\u63a5\u590d\u5236\u8fc7\u6765\u55ef\u5c31\u8fd9\u6837\u3002~~\n  \n  \u9898\u76ee\u94fe\u63a5\uff1a[Link.](https://www.luogu.com.cn/problem/UVA1603)\n  \n  >\u4e00\u4e2a $n \\times n$ \u7684\u7f51\u683c\uff0c\u5171 $2 \\times n \\times (n + 1)$ \u6761\u8fb9\uff0c\u73b0\u5728\u5df2\u7ecf\u5220\u9664\u4e86\u4e00\u4e9b\u8fb9\uff0c\u95ee\u81f3\u5c11\u8fd8\u9700\u5220\u53bb\u591a\u5c11\u8fb9\uff0c\u4ee5\u4f7f\u5f97\u5269\u4e0b\u7684\u8fb9\u4e0d\u80fd\u6784\u6210\u6b63\u65b9\u5f62\u3002\n  \n    \u4e00\u4e2a\u6b63\u65b9\u5f62\u6709 $4$ \u6761\u8fb9\uff08\u6bcf\u6761\u8fb9\u82e5\u5e72\u706b\u67f4\uff09\uff0c\u9009\u62e9\u4e00\u6839\u706b\u67f4\u5c31\u53ef\u4ee5\u7834\u574f\u6389\u6b63\u65b9\u5f62\u3002\u4f46\u662f\u4e5f\u53ef\u4ee5\u9009\u62e9\u591a\u6839\u3002\n  \n  \u8981\u4fdd\u8bc1**\u6bcf\u4e2a\u6b63\u65b9\u5f62**\u5185\u90e8**\u81f3\u5c11\u6709\u4e00\u6839\u706b\u67f4\u88ab\u9009\u62e9**\uff0c\u4e14\u8981\u6c42**\u9009\u62e9\u706b\u67f4\u6570\u91cf\u6700\u5c11**\u3002\n  \n  \u518d\u60f3\u60f3\u91cd\u590d\u8986\u76d6\u95ee\u9898\u3002\n  \n  \u5f88\u660e\u663e\uff0c\u8fd9\u662f\u4e00\u9053**\u91cd\u590d\u8986\u76d6\u95ee\u9898\u3002**\n  \n  \u63a5\u4e0b\u6765\u5c31\u662f\u5982\u4f55\u6784\u5efa\u4e86\u3002\n  \n  \u9996\u5148\uff0c\u628a\u8fd9\u4e9b\u706b\u67f4\u62bd\u8c61\u6210 $2n(n+1)$ \u4e2a\u70b9\u3002\n  \n  \u7136\u540e\u6bcf\u6839\u706b\u67f4\u548c**\u6240\u5728\u8fb9\u957f\u4e3a $len (1 \\le len \\le n)$ \u7684\u77e9\u5f62\u7684\u8fb9\u4e0a\u6240\u6709\u706b\u67f4**\u8fde\u8d77\u6765\u3002\n\n  \u5982\u4e0b\u56fe\uff1a(\u4e3e\u4f8b\u70b9 $1$\n  \n  ![](https://s3.ax1x.com/2021/02/27/6pbhNV.png)\n  \n  \u5177\u4f53\u7ec6\u8282\u89c1\u4ee3\u7801\uff0c\u4ee5\u4e0b\u4e3a\u4ee3\u7801\uff1a\n  \n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<vector> \n#include<algorithm>\nusing namespace std;\nconst int Maxn=3600+5;\nint T,n,m,l[Maxn],r[Maxn],u[Maxn],d[Maxn],s[Maxn];\nint idx,tot,ans[Maxn],col[Maxn],row[Maxn];\nbool st[Maxn]; // 1.\u4f5c\u4e3a\u4f30\u4ef7\u51fd\u6570 2.\u4f5c\u4e3a\u5efa\u56fe \nvector<int> sq[60];\nvoid init()\n{\t\n\tfor(int i=0;i<=m;i++)\n\t{\t\n    \tl[i]=i-1;r[i]=i+1;\n\t\tu[i]=d[i]=col[i]=i;\n\t\ts[i]=0;\n\t}\n\tl[0]=m;r[m]=0;\n\tidx=m+1;\n}\nint h() //\u4f30\u4ef7\u51fd\u6570 \n{\t\n\tint cnt=0;\n\tmemset(st,0,sizeof(st));\n\tfor(int i=r[0];i;i=r[i])\n\t{\t\n    \tif(st[col[i]])continue;\n\t\tcnt++;\n\t\tst[col[i]]=1;\n\t\tfor(int j=d[i];j!=i;j=d[j])\n\t\t\tfor(int k=r[j];k!=j;k=r[k])\n\t\t\t\tst[col[k]]=1;\n\t}\n\treturn cnt;\n} \nvoid add(int &hd,int &tl,int x,int y)\n{\t\n\trow[idx]=x;col[idx]=y;s[y]++;\n\tu[idx]=y;d[idx]=d[y];u[d[y]]=idx;d[y]=idx;\n\tr[hd]=l[tl]=idx;r[idx]=tl;l[idx]=hd;\n\ttl=idx++;\n}\nvoid remove(int p)\n{\t\n\tfor(int i=d[p];i!=p;i=d[i])\n\t\tr[l[i]]=r[i],l[r[i]]=l[i];\n}\nvoid resum(int p)\n{\t\n\tfor(int i=u[p];i!=p;i=u[i])\n\t\tr[l[i]]=i,l[r[i]]=i;\n}\nbool dfs(int k)\n{\t\n\tif(k+h()-1>tot)return 0;\n\tif(!r[0])return 1;\n\tint p=r[0];\n\tfor(int i=r[0];i;i=r[i])\n\t\tif(s[p]>s[i])p=i;\n\tfor(int i=d[p];i!=p;i=d[i])\n\t{\t\n\t\tans[k]=row[i];\n\t\tremove(i);\n\t\tfor(int j=r[i];j!=i;j=r[j])remove(j);\n\t\tif(dfs(k+1))return 1;\n\t\tfor(int j=l[i];j!=i;j=l[j])resum(j);\n\t\tresum(i);\n\t}\n\treturn 0;\n}\nint main()\n{\t\n\tscanf(\"%d\",&T);\n\twhile(T--)\n\t{\t\n\t\tint k;\n\t\tscanf(\"%d%d\",&n,&k);\n\t\tm=idx=0;\n\t\tmemset(st,0,sizeof(st));\n\t\tmemset(col,0,sizeof(col));\n\t\tfor(int i=1;i<=k;i++)\n\t\t{\t\n\t\t\tint x;\n\t\t\tscanf(\"%d\",&x);\n\t\t\tst[x]=1;\n\t\t}\n\t\tfor(int len=1;len<=n;len++)\n\t\t\tfor(int x=1;x+len-1<=n;x++)\n\t\t\t\tfor(int y=1;y+len-1<=n;y++)\n\t\t\t\t{\n\t\t\t\t\tm++;\n\t\t\t\t\tsq[m].clear();\n\t\t\t\t\tint dd=n*2+1;//\u4e00\u884c\u8fc7\u53bb(\u6a2an\u52a0\u4e0a\u7ad6n+1)\u4e2a\u6570\n\t\t\t\t\tfor(int i=0;i<len;i++) //\u5411\u4e00\u4e2a\u77e9\u5f62\u7684 4 \u8fb9(\u4e0a\u4e0b\u5de6\u53f3)\u8fde\u53bb \n\t\t\t\t\t{\t\n\t\t\t\t\t\tsq[m].push_back((x-1)*dd+y+i); //\u4e0a \n\t\t\t\t\t\tsq[m].push_back((x-1)*dd+y+i+dd*len); //\u4e0b \n\t\t\t\t\t\tsq[m].push_back((x-1)*dd+y+n+i*dd); //\u5de6 \n\t\t\t\t\t\tsq[m].push_back((x-1)*dd+y+n+i*dd+len); //\u53f3 \n\t\t\t\t\t}\n\t\t\t\t\tfor(int i=0;i<sq[m].size();i++) //\u76f8\u8fde\u7684\u8fb9\u6709\u4e00\u4e2a\u65ad\u4e86,\u76f4\u63a5\u5220\u9664\u6240\u6709\u5373\u53ef \n\t\t\t\t\t\tif(st[sq[m][i]]){m--;break;}\n\t\t\t\t}\n\t\tinit();\n\t\tfor(int i=1;i<=n*(n+1)*2;i++) //\u5168\u90e8\u8fb9\n\t\t\tif(!st[i])\n\t\t\t{\t\n\t\t\t\tint hh=idx,tl=idx;\n\t\t\t\tfor(int j=1;j<=m;j++)\n\t\t\t\t\tif(find(sq[j].begin(),sq[j].end(),i)!=sq[j].end()) //\u8fde\u8fb9\u5b58\u5728 \n\t\t\t\t\t\tadd(hh,tl,i,j);\n\t\t\t} \n\t\ttot=0;\n\t\twhile(!dfs(1))tot++;\n\t\tprintf(\"%d\\n\",tot);\n\t}\n\treturn 0;\n}\n```\n\n------------\n\n$$\\text{by Rainy7}$$\n  ",
        "postTime": 1619450067,
        "uid": 39408,
        "name": "Rainy7",
        "ccfLevel": 7,
        "title": "\u300c\u821e\u8e48\u94fe DLX \u300d\u5b66\u4e60\u7b14\u8bb0"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u9053 **DLX** \u7684 **\u6a21\u677f\u9898** \n\nDLX\uff0c\u5168\u540dDancing Links X\uff0c\u662f\u4e00\u79cd\u88ab\u7528\u6765\u89e3\u51b3 **\u7cbe\u786e\u8986\u76d6\u95ee\u9898**\u5982\uff08n\u7687\u540e\u95ee\u9898\u3001\u6570\u72ec\u95ee\u9898\uff09\u548c**\u91cd\u590d\u8986\u76d6\u95ee\u9898**\u7b49\u7b49\u7684\u9ad8\u6548\u7b97\u6cd5\u3002\n\n\u8fd9\u9053\u9898\u5f52\u6839\u7ed3\u5e95\u662f\u4e00\u9053**\u7cbe\u786e\u8986\u76d6**\u95ee\u9898\u3002\n\n\u7cbe\u786e\u8986\u76d6\u7b80\u8981\u4ecb\u7ecd\uff1a[\u70b9\u8fd9\u91cc](https://www.luogu.com.cn/blog/YJi/jing-que-fu-gai-wen-ti#)  \n\uff08\u672c\u849f\u84bb\u7684\u4ecb\u7ecd\u4e0d\u662f\u5f88\u597d\uff0c\u5982\u679c\u770b\u4e0d\u660e\u767d\u53ef\u4ee5\u53bb\u770b\u770b\u5176\u4ed6dalao\u7684\u4ecb\u7ecd\uff09\n\n### \u7cbe\u786e\u8986\u76d6\n\u5176\u6807\u51c6\u5b9a\u4e49\u5462\uff0c\u5c31\u662f\uff1a  \u5728\u4e00\u4e2a\u5168\u96c6X\u4e2d\u82e5\u5e72\u5b50\u96c6\u7684\u96c6\u5408\u4e3aS\uff0c\u7cbe\u786e\u8986\u76d6\u662f\u6307\uff0cS\u7684\u5b50\u96c6S \uff0c\u6ee1\u8db3X\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5143\u7d20\u5728S \u4e2d\u6070\u597d\u51fa\u73b0\u4e00\u6b21\u3002\n\n\u7b80\u5355\u6765\u8bf4\uff1a  \n\u75310\u548c1\u7ec4\u6210\u7684\u77e9\u9635A\u6765\u8868\u793a\u7cbe\u786e\u8986\u76d6\u95ee\u9898\uff0c\u76ee\u6807\u662f\u9009\u51fa\u77e9\u9635\u7684\u82e5\u5e72\u884c\uff0c\u4f7f\u5f97\u5176\u4e2d\u76841\u5728\u6240\u6709\u5217\u4e2d\u51fa\u73b0\u4e14\u4ec5\u51fa\u73b0\u4e00\u6b21\u3002  \n\u5373\uff1a  \n\u7ed9\u5b9a\u4e00\u4e2a\u75310-1\u7ec4\u6210\u7684\u77e9\u9635\uff0c\u662f\u5426\u80fd\u627e\u5230\u4e00\u4e2a\u884c\u7684\u96c6\u5408\uff0c\u4f7f\u5f97\u96c6\u5408\u4e2d\u6bcf\u4e00\u5217\u90fd\u6070\u597d\u5305\u542b\u4e00\u4e2a1\n\n### \u672c\u9898\u601d\u8def\uff08DLX\uff09\n1. \u5bf9\u4e8e\u4e0b\u56fe\u4e00\u4e2a\u77e9\u9635\uff08\u7070\u8272\u8868\u793a1\uff0c\u65e0\u8272\u8868\u793a0\uff09\uff0c\u56e0\u4e3a\u8981\u5b9e\u73b0\u7cbe\u786e\u8986\u76d6\uff0c\u6240\u4ee5\u6bcf\u4e00\u5217\u90fd\u8981\u6709\u4e00\u4e2a\u4e3a\u7070\u8272\uff0c\u6240\u4ee5\u8981\u4e48\u662f\u65e0\u89e3\uff0c\u8981\u4e48\u89e3\u4e4b\u4e2d\u7684\u4e00\u4e2a\u884c\u5c31\u5728\u6bcf\u4e00\u5217\u6709\u5143\u7d20\u7684\u884c\u4e0a\u3002\u90a3\u4e48\u6211\u4eec\u662f\u4e0d\u662f\u8981\u4ece\u5934\u5230\u5c3e\u628a\u6bcf\u884c\u3001\u6bcf\u79cd\u60c5\u51b5\u626b\u4e00\u904d\u5462\uff1f  \n\u80af\u5b9a\u662f\u8981\u6709\u4f18\u5316\u7684\u3002  \n\u4ee5\u56fe\u4e2d\u7b2c\u4e00\u5217\u4e3a\u4f8b\uff0c\u8981\u4e48\u8fd9\u4e2a\u56fe\u7cbe\u786e\u8986\u76d6\u65e0\u89e3\uff0c\u8981\u4e48\u89e3\u4e2d\u5c31\u5305\u542b\u7b2c 2 \u5217 **\u6216** \u7b2c 4 \u5217\u3002  \n\u51ed\u501f\u8fd9\u4e2a\u539f\u7406\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6bcf\u4e00\u6b21\u90fd\u9009\u5f53\u524d\u5217\u4e0a\u5143\u7d20\u6700\n\u5c11\u7684\u4e00\u5217\uff0c\u4f9d\u6b21\u9009\u53d6\u5143\u7d20\u6240\u5728\u884c\uff0c\u4ece\u800c\u8fbe\u5230\u51cf\u5c0f\u641c\u7d22\u51b3\u7b56\u6811\u7684\u5927\u5c0f\uff0c\u8282\u7701\u65f6\u95f4\u7684\u76ee\u7684\u3002\n![](https://cdn.luogu.com.cn/upload/image_hosting/elpy8cp9.png)\n1. \u5217\u4e0a\u5143\u7d20\u6700\u5c11\u7684\u4e3a\u7b2c\u4e00\u3001\u4e09\u3001\u4e94\u3001\u516d\u5217\uff0c\u6709\u4e24\u4e2a\u5143\u7d20\uff0c\u5bf9\u5e94\u7740\u4e24\u884c\n![](https://cdn.luogu.com.cn/upload/image_hosting/hqn7z68h.png)\n1. \u9996\u5148\u9009\u4e2d\u7b2c\u4e00\u884c\uff0c\u628a\u5176\u5143\u7d20\u6240\u5728\u5217 \u6709\u5143\u7d20\u7684\u884c\uff08\u5982\u56fe2/4/5/6\u884c\uff09\u5168\u90e8\u5220\u53bb\u5f97\u5230\u65b0\u77e9\u9635\n![](https://cdn.luogu.com.cn/upload/image_hosting/vnrmkyf9.png)\n1. \u65b0\u77e9\u9635\u5982\u56fe\u6240\u793a\uff0c\u7b2c2\u30015\u5217\u5143\u7d20\u6700\u5c11\uff0c\u5747\u4e3a\u4e00\u4e2a\uff1a\n![](https://cdn.luogu.com.cn/upload/image_hosting/ls79wbd4.png)\n1. \u4e0b\u9762\u63a5\u7740\u9009\u4e2d\u9009\u4e2d\u7b2c\u4e8c\u5217\u4e2d\uff0c\u5220\u9664\u7b2c\u4e09\u884c\u76f8\u5173\u884c\u5217\uff0c\u5f97\u77e9\u9635\uff1a\n![](https://cdn.luogu.com.cn/upload/image_hosting/kwycdycw.png)\n\u8fd9\u65f6\u5019\u53d1\u73b0\u6ca1\u6709\u5143\u7d20\uff0c\u53ef\u662f\u8fd8\u6ca1\u5168\u90e8\u8986\u6539\uff08\u5269\u4e0b\u7b2c5\u5217\uff09\u8bf4\u660e\u8fd9\u79cd\u65b9\u6cd5\u4e0d\u53ef\u884c\n\n1. \u63a5\u7740\u56de\u6eaf\uff0c\u9009\u4e2d\uff08\u7b2c\u4e94\u5217\uff09\u7b2c\u4e00\u884c\uff0c\u5220\u9664\u76f8\u5173\u884c\u5217\uff0c\u5f97\u5982\u56fe\u77e9\u9635\uff1a\n![](https://cdn.luogu.com.cn/upload/image_hosting/7e6avvna.png)\n1. \u8fd8\u662f\u4e0d\u53ef\u884c\uff0c\u63a5\u7740\u56de\u6eaf\uff0c\u56de\u6eaf\u5230\u4e86\u6700\u539f\u59cb\u7684\u77e9\u9635\uff0c\u9009\u4e2d\u5269\u4e0b\u7684 **\u7b2c\u56db\u884c** \uff0c\u5220\u9664\u76f8\u5173\u884c\u5217:\n![](https://cdn.luogu.com.cn/upload/image_hosting/gzzxmhn4.png)\n\n1. \u5217\u5143\u7d20\u6700\u5c11\u7684\u4e3a5\u30017\u5217\uff0c\u9009\u4e2d**\u7b2c\u4e00\u884c**\uff08\u7b2c\u4e94\u5217\uff09\uff0c\u5220\u9664\u76f8\u5173\u884c\u5217\uff0c\u5f97\u65b0\u77e9\u9635\uff0c\u63a5\u7740\u9009\u4e2d\u5269\u4e0b\u7684\u4e00\u884c\uff08 **\u7b2c\u4e94\u884c** \uff09\uff0c\u5220\u9664\u76f8\u5173\u884c\u5217\uff0c\u5f97\u6700\u540e\u7684\u7a7a\u77e9\u9635\uff08\u53ea\u5269\u6807\u5934\uff09\u3002  \n![](https://cdn.luogu.com.cn/upload/image_hosting/l3u7no1m.png)\n\u8fd9\u65f6\u9012\u5f52\u8def\u5f84\uff1a4-1-5\uff0c\u5373\u4e3a\u7b54\u6848\u3002\n![](https://cdn.luogu.com.cn/upload/image_hosting/nzpu2r6t.png)\n### \u4ee3\u7801\u5b9e\u73b0\n\u7b97\u6cd5\u5b9e\u73b0\u91cd\u8981\u57fa\u7840\uff1a **\u53cc\u5411\u5341\u5b57\u5faa\u73af\u94fe\u8868**\n#### \u5b9a\u4e49\u53d8\u91cf\uff1a\n```cpp\nconst int MAXN=5500;\nint cnt,lin[MAXN],sz[MAXN];\t\t\t//\u94fe\u4e2d\u7684\u7b2ccnt\u4e2a\u5143\u7d20\uff1b\u7b2ci\u884c\u7684\u7b2c\u4e00\u4e2a\u6570\u4e3alin[i]\uff1b\u7b2c[j]\u5217\u7684\u5143\u7d20\u4e2a\u6570\u4e3asz[j] \nint l[MAXN],r[MAXN],u[MAXN],d[MAXN];//\u7b2ci\u5143\u7d20\u5de6\u3001\u53f3\u3001\u4e0a\u3001\u4e0b\u7684\u5143\u7d20\u7684\u4e0b\u6807 \nint col[MAXN],row[MAXN];     \t\t//\u7b2ci\u4e2a\u5143\u7d20\u5728\u7b2ccol[i]\u884c\uff0crow[i]\u5217 \n```\n\n\n#### \u7b2c\u4e00\u6b65\uff1a\u5efa\u7acb\u77e9\u9635\n```cpp\ninline void build(int n,int m)\t\t//\u5efa\u9020\u7a7a\u77e9\u9635 \n{\n\tfor(register int i=0;i<=m;i++)\t//\u7528\u53cc\u5411\u94fe\u8868\u50a8\u5b58\u5217\u8868\u5934 \n\t\tl[i]=i-1, r[i]=i+1, u[i]=i, d[i]=i;\n\tl[0]=m, r[m]=0, cnt=m;\t\t\t//\u6784\u6210\u53cc\u5411\u5faa\u73af\u94fe\u8868\uff0c\u77e9\u9635\u4e2d\u5df2\u5b58cnt\u4e2a\u5143\u7d20 \n}\n```\n#### \u7b2c\u4e8c\u6b65\uff1a\u63d2\u5165\u5143\u7d20\n```cpp\ninline void insert(int ro,int co)\t//\u5411\u77e9\u9635\u4e2d\u52a0\u5165\u65b0\u7684\u5143\u7d20 \n{\n\tcnt+=1;\n\trow[cnt]=ro;\t\t\t\t\t//\u7b2ccnt\u4e2a\u5143\u7d20\u6240\u5728\u884c \n\tcol[cnt]=co;\t\t\t\t\t//\u7b2ccnt\u4e2a\u5143\u7d20\u6240\u5728\u5217 \n\tsz[co]+=1;\t\t\t\t\t\t//\u7b2cco\u5217\u7684\u5143\u7d20\u4e2a\u6570 +1 \n/*\t\u5904\u7406\u7eb5\u5411\u7684\u94fe\u8868\uff1a\t\t\t\t*/\n\tu[cnt]=co;\t\t\t\t\t\t// \u5c06\u7b2ccnt\u4e2a\u5143\u7d20 \u52a0\u5165 \u7eb5\u5411\u7684 \u94fe\u8868\u4e2d \n\td[cnt]=d[co];\t\t\t\t\t// \t\t\u540c\u4e0a \n\tu[d[co]]=cnt;\t\t\t\t\t// \t\t\u540c\u4e0a\n\td[co]=cnt;\t\t\t\t\t\t//\t\t\u540c\u4e0a\n/*\t\u5904\u7406\u6a2a\u5411\u7684\u94fe\u8868\uff1a\t\t\t\t*/\n\tif(lin[ro]==0)\t\t\t\t\t//\u5982\u679c\u8fd9\u4e00\u884c\u94fe\u8868\u4e2d\u6ca1\u6709\u5143\u7d20 \u6240\u6267\u884c\u7684\u64cd\u4f5c \n\t{\n\t\tlin[ro]=cnt;\t\t\t\t//\u5c06\u7b2ccnt\u4e2a\u5143\u7d20 \u52a0\u5165 \u6a2a\u5411\u7684 \u94fe\u8868\u4e2d \n\t\tl[cnt]=cnt;\t\t\t\t\t// \t\t\u540c\u4e0a\n\t\tr[cnt]=cnt;\t\t\t\t\t// \t\t\u540c\u4e0a\n\t} \n\telse\t\t\t\t\t\t\t//\u53cd\u4e4b\uff0c\u6267\u884c\u7684\u64cd\u4f5c \n\t{\n\t\tl[cnt]=lin[ro];\t\t\t\t//\u5c06\u7b2ccnt\u4e2a\u5143\u7d20 \u52a0\u5165 \u6a2a\u5411\u7684 \u94fe\u8868\u4e2d \n\t\tr[cnt]=r[lin[ro]];\t\t\t// \t\t\u540c\u4e0a\n\t\tl[r[lin[ro]]]=cnt;\t\t\t// \t\t\u540c\u4e0a\n\t\tr[lin[ro]]=cnt;\t\t\t\t// \t\t\u540c\u4e0a\n\t}\n}\n```\n#### \u7b2c\u4e09\u6b65\uff1a\u5220\u5217\u4e0e\u6062\u590d\n```cpp\ninline void cut(int c)\t\t\t\t//\u5c06\u7b2cc\u5217\u79fb\u9664 \n{\n\tl[r[c]]=l[c]; \t\t\t\t\t\t\t//\u5c06\u7b2cc\u5217\u4ece\u8868\u5934\u4e2d\u5220\u9664\uff08\u5c06\u8be5\u8868\u5934\u5143\u7d20\u7684 \u5de6\u53f3\u8868\u5934\u5143\u7d20 \u76f8\u8fde\uff09 \n\tr[l[c]]=r[c];\n\tfor(register int i=d[c];i!=c;i=d[i])\t//\u4ece \u7eb5\u5411\u94fe\u8868 \u4e2d\u79fb\u9664  \u7b2cc\u5217\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u6240\u5728\u4e00\u884c \n\t\tfor(register int j=r[i];j!=i;j=r[j])//\u4ece \u7eb5\u5411\u94fe\u8868 \u4e2d\u79fb\u9664  \u8be5\u884c\u5143\u7d20 \n\t\t{\n\t\t\tu[d[j]]=u[j];\t\t\t\t\t//\u5c06 \u8be5\u884c\u7684\u6bcf\u4e00\u4e2a\u5143\u7d20\u4ece \u7eb5\u5411\u94fe\u8868 \u4e2d\u79fb\u9664\uff08\u5c06\u6b64\u5143\u7d20\u7684\u4e0a\u4e0b\u4e24\u5143\u7d20\u76f8\u8fde\uff09 \n\t\t\td[u[j]]=d[j];\n\t\t\tsz[col[j]]-=1;\t\t\t\t\t//\u7b2c \u8be5\u5143\u7d20 \u6240\u5728\u5217\u7684 \u5217\u5143\u7d20\u4e2a\u6570 -1 \n\t\t}\n}\ninline void back(int c)\t\t\t\t//\u5c06\u7b2cc\u5217\u6062\u590d \n{\n\tfor(register int i=u[c];i!=c;i=u[i])\t//\u6062\u590d \u7eb5\u5411\u94fe\u8868 \u4e2d \u7b2cc\u5217\u4e2d\u7684\u88ab\u79fb\u9664\u884c \n\t\tfor(register int j=l[i];j!=i;j=l[j])//\u6062\u590d \u7eb5\u5411\u94fe\u8868 \u4e2d \u88ab\u79fb\u51fa\u884c\u4e2d\u88ab\u79fb\u9664\u7684\u5143\u7d20 \n\t\t{\n\t\t\tu[d[j]]=d[u[j]]=j;\t\t\t\t//\u5c06 \u8be5\u884c\u7684\u6bcf\u4e00\u4e2a\u5143\u7d20\u4ece \u7eb5\u5411\u94fe\u8868 \u4e2d\u6062\u590d\uff08\u5c06\u6b64\u5143\u7d20\u63a5\u5165 \u4e0a\u4e0b\u4e24\u5143\u7d20\u4e2d\u95f4\uff09 \n\t\t\tsz[col[j]]+=1;\t\t\t\t\t//\u7b2c \u8be5\u5143\u7d20 \u6240\u5728\u5217\u7684 \u5217\u5143\u7d20\u4e2a\u6570 +1 \n\t\t}\n\tl[r[c]]=c;\t\t\t\t\t\t\t\t//\u5c06\u7b2cc\u5217\u4ece\u8868\u5934\u4e2d\u6062\u590d \n\tr[l[c]]=c;\n}\n```\n#### \u7b2c\u56db\u6b65\uff1a\u5f00\u59cb\u8df3\u821e\n\n\n\n```cpp\nint ans[MAXN];\t\t\t\t\t\t//\u50a8\u5b58\u7b54\u6848 \n\n\ninline void print(int ln)\t\t\t//\u8f93\u51fa\u7b54\u6848 \n{\n\tfor(register int i=1;i<ln;i+=1)\n\t\tprintf(\"%d \",ans[i]);\n}\n                                 \n                                 \n                                 \ninline bool dance(int deep) /*deep \u8868\u793a\u9012\u5f52\u6df1\u5ea6\uff08\u5373\u5220\u9664\u5217\u7684\u4e2a\u6570\uff09*/\t //Start Dancing!\n{\n\tif(r[0]==0)\t\t\t\t\t\t\t\t//\u7a7a\u77e9\u9635\u5219\u8bf4\u660e\u5b8c\u6210\u4e86 \u7cbe\u786e\u8986\u76d6 \uff0c\u8f93\u51fa\u7b54\u6848 \n\t{\n\t\tprint(deep);\n\t\treturn 1;\n\t}\n\t\n\tint c=r[0];\n\tfor(register int i=r[0];i!=0;i=r[i])\t//\u6b64\u5faa\u73af\u7528\u6765\u627e\u77e9\u9635\u4e2d\u5143\u7d20\u6700\u5c11\u7684\u4e00\u5217\uff0c\u4ee5\u51cf\u5c11\u51b3\u7b56\u6811\uff0c\u8282\u7701\u65f6\u95f4 \n\t\tif(sz[i]<sz[c]) c=i;\n\t\t\n\tcut(c);\t\t\t\t\t\t\t\t\t//\u79fb\u9664\u7b2cc\u5217\n\tfor(register int i=d[c];i!=c;i=d[i])\t//\u4f9d\u6b21\u5217\u4e3e\u7b2cc\u5217\u4e2d\u6709\u5143\u7d20\u7684\u6bcf\u4e00\u884c \n\t{\n\t\tans[deep]=row[i];\t\t\t\t\t//\u8bb0\u5f55\u8def\u5f84\uff0c\u4e3a\u4e0b\u5348 \u8f93\u51fa\u7b54\u6848 \u505a\u94fa\u57ab\uff0c\u57cb\u4f0f\u7b14 \n\t\tfor(register int j=r[i];j!=i;j=r[j])//\u5c06\u9009\u4e2d\u7b2c col[j]\u884c\uff0c\u5220\u9664\u76f8\u5173\u5143\u7d20 \n\t\t\tcut(col[j]);\n\t\t\t\n\t\tif(dance(deep+1)) return 1;\t\t\t//\u5982\u679c\u4e3a\u771f\u5219\u8bf4\u660e \u4e0a\u6587\u4e2d \u5df2\u5b8c\u6210\u7cbe\u786e\u8986\u76d6\u4efb\u52a1\uff0c\u56de\u6eaf \n\t\t\t\t\t\t\t\t\t\t\t//\u5982\u679c\u4e3a\u5047\u5219\u8bf4\u660e \u8be5\u5217\u5e76\u4e0d\u5728\u7b54\u6848\u4e2d\uff0c\u4e0b\u6b21\u5faa\u73af\u9009\u53d6\u4e0b\u4e00\u5217 \n\t\tfor(register int j=l[i];j!=i;j=l[j])//\u5c06\u9009\u4e2d\u7b2c col[j]\u884c\uff0c\u6062\u590d\u76f8\u5173\u5143\u7d20 \n\t\t\tback(col[j]);\n\t}\n\tback(c);\t\t\t\t\t\t\t\t//\u6062\u590d\u7b2cc\u5217 \n\treturn 0;\t\t\t\t\t\t\t\t//\u8868\u660e \u4e0a\u6587\u4e3a\u8fbe\u5230\u9898\u76ee\u8981\u6c42\uff0c\u8fd4\u56de\u503c\u4e3a \u5047\uff0c\u56de\u6eaf \n}                                 \n```\n### \u5b8c\u6574Code\n```cpp\n#include<iostream>\n#include<cstdio>\nusing namespace std;\n\nconst int MAXN=5500;\nint ans[MAXN];\t\t\t\t\t\t//\u50a8\u5b58\u7b54\u6848 \nint n,m,x;\nint cnt,lin[MAXN],sz[MAXN];\t\t\t//\u94fe\u4e2d\u7684\u7b2ccnt\u4e2a\u5143\u7d20\uff1b\u7b2ci\u884c\u7684\u7b2c\u4e00\u4e2a\u6570\u4e3alin[i]\uff1b\u7b2c[j]\u5217\u7684\u5143\u7d20\u4e2a\u6570\u4e3asz[j] \nint l[MAXN],r[MAXN],u[MAXN],d[MAXN];//\u7b2ci\u5143\u7d20\u5de6\u3001\u53f3\u3001\u4e0a\u3001\u4e0b\u7684\u5143\u7d20\u7684\u4e0b\u6807 \nint col[MAXN],row[MAXN];     \t\t//\u7b2ci\u4e2a\u5143\u7d20\u5728\u7b2ccol[i]\u884c\uff0crow[i]\u5217 \n\ninline void build(int n,int m)\t\t//\u5efa\u9020\u7a7a\u77e9\u9635 \n{\n\tfor(register int i=0;i<=m;i++)\t//\u7528\u53cc\u5411\u94fe\u8868\u50a8\u5b58\u5217\u8868\u5934 \n\t\tl[i]=i-1, r[i]=i+1, u[i]=i, d[i]=i;\n\tl[0]=m, r[m]=0, cnt=m;\t\t\t//\u6784\u6210\u53cc\u5411\u5faa\u73af\u94fe\u8868\uff0c\u77e9\u9635\u4e2d\u5df2\u5b58cnt\u4e2a\u5143\u7d20 \n}\ninline void insert(int ro,int co)\t//\u5411\u77e9\u9635\u4e2d\u52a0\u5165\u65b0\u7684\u5143\u7d20 \n{\n\tcnt+=1;\n\trow[cnt]=ro;\t\t\t\t\t//\u7b2ccnt\u4e2a\u5143\u7d20\u6240\u5728\u884c \n\tcol[cnt]=co;\t\t\t\t\t//\u7b2ccnt\u4e2a\u5143\u7d20\u6240\u5728\u5217 \n\tsz[co]+=1;\t\t\t\t\t\t//\u7b2cco\u5217\u7684\u5143\u7d20\u4e2a\u6570 +1 \n/*\t\u5904\u7406\u7eb5\u5411\u7684\u94fe\u8868\uff1a\t\t\t\t*/\n\tu[cnt]=co;\t\t\t\t\t\t// \u5c06\u7b2ccnt\u4e2a\u5143\u7d20 \u52a0\u5165 \u7eb5\u5411\u7684 \u94fe\u8868\u4e2d \n\td[cnt]=d[co];\t\t\t\t\t// \t\t\u540c\u4e0a \n\tu[d[co]]=cnt;\t\t\t\t\t// \t\t\u540c\u4e0a\n\td[co]=cnt;\t\t\t\t\t\t//\t\t\u540c\u4e0a\n/*\t\u5904\u7406\u6a2a\u5411\u7684\u94fe\u8868\uff1a\t\t\t\t*/\n\tif(lin[ro]==0)\t\t\t\t\t//\u5982\u679c\u8fd9\u4e00\u884c\u94fe\u8868\u4e2d\u6ca1\u6709\u5143\u7d20 \u6240\u6267\u884c\u7684\u64cd\u4f5c \n\t{\n\t\tlin[ro]=cnt;\t\t\t\t//\u5c06\u7b2ccnt\u4e2a\u5143\u7d20 \u52a0\u5165 \u6a2a\u5411\u7684 \u94fe\u8868\u4e2d \n\t\tl[cnt]=cnt;\t\t\t\t\t// \t\t\u540c\u4e0a\n\t\tr[cnt]=cnt;\t\t\t\t\t// \t\t\u540c\u4e0a\n\t} \n\telse\t\t\t\t\t\t\t//\u53cd\u4e4b\uff0c\u6267\u884c\u7684\u64cd\u4f5c \n\t{\n\t\tl[cnt]=lin[ro];\t\t\t\t//\u5c06\u7b2ccnt\u4e2a\u5143\u7d20 \u52a0\u5165 \u6a2a\u5411\u7684 \u94fe\u8868\u4e2d \n\t\tr[cnt]=r[lin[ro]];\t\t\t// \t\t\u540c\u4e0a\n\t\tl[r[lin[ro]]]=cnt;\t\t\t// \t\t\u540c\u4e0a\n\t\tr[lin[ro]]=cnt;\t\t\t\t// \t\t\u540c\u4e0a\n\t}\n}\ninline void cut(int c)\t\t\t\t//\u5c06\u7b2cc\u5217\u79fb\u9664 \n{\n\tl[r[c]]=l[c]; \t\t\t\t\t\t\t//\u5c06\u7b2cc\u5217\u4ece\u8868\u5934\u4e2d\u5220\u9664\uff08\u5c06\u8be5\u8868\u5934\u5143\u7d20\u7684 \u5de6\u53f3\u8868\u5934\u5143\u7d20 \u76f8\u8fde\uff09 \n\tr[l[c]]=r[c];\n\tfor(register int i=d[c];i!=c;i=d[i])\t//\u4ece \u7eb5\u5411\u94fe\u8868 \u4e2d\u79fb\u9664  \u7b2cc\u5217\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u6240\u5728\u4e00\u884c \n\t\tfor(register int j=r[i];j!=i;j=r[j])//\u4ece \u7eb5\u5411\u94fe\u8868 \u4e2d\u79fb\u9664  \u8be5\u884c\u5143\u7d20 \n\t\t{\n\t\t\tu[d[j]]=u[j];\t\t\t\t\t//\u5c06 \u8be5\u884c\u7684\u6bcf\u4e00\u4e2a\u5143\u7d20\u4ece \u7eb5\u5411\u94fe\u8868 \u4e2d\u79fb\u9664\uff08\u5c06\u6b64\u5143\u7d20\u7684\u4e0a\u4e0b\u4e24\u5143\u7d20\u76f8\u8fde\uff09 \n\t\t\td[u[j]]=d[j];\n\t\t\tsz[col[j]]-=1;\t\t\t\t\t//\u7b2c \u8be5\u5143\u7d20 \u6240\u5728\u5217\u7684 \u5217\u5143\u7d20\u4e2a\u6570 -1 \n\t\t}\n}\ninline void back(int c)\t\t\t\t//\u5c06\u7b2cc\u5217\u6062\u590d \n{\n\tfor(register int i=u[c];i!=c;i=u[i])\t//\u6062\u590d \u7eb5\u5411\u94fe\u8868 \u4e2d \u7b2cc\u5217\u4e2d\u7684\u88ab\u79fb\u9664\u884c \n\t\tfor(register int j=l[i];j!=i;j=l[j])//\u6062\u590d \u7eb5\u5411\u94fe\u8868 \u4e2d \u88ab\u79fb\u51fa\u884c\u4e2d\u88ab\u79fb\u9664\u7684\u5143\u7d20 \n\t\t{\n\t\t\tu[d[j]]=d[u[j]]=j;\t\t\t\t//\u5c06 \u8be5\u884c\u7684\u6bcf\u4e00\u4e2a\u5143\u7d20\u4ece \u7eb5\u5411\u94fe\u8868 \u4e2d\u6062\u590d\uff08\u5c06\u6b64\u5143\u7d20\u63a5\u5165 \u4e0a\u4e0b\u4e24\u5143\u7d20\u4e2d\u95f4\uff09 \n\t\t\tsz[col[j]]+=1;\t\t\t\t\t//\u7b2c \u8be5\u5143\u7d20 \u6240\u5728\u5217\u7684 \u5217\u5143\u7d20\u4e2a\u6570 +1 \n\t\t}\n\tl[r[c]]=c;\t\t\t\t\t\t\t\t//\u5c06\u7b2cc\u5217\u4ece\u8868\u5934\u4e2d\u6062\u590d \n\tr[l[c]]=c;\n}\ninline void print(int ln)\t\t\t//\u8f93\u51fa\u7b54\u6848 \n{\n\tfor(register int i=1;i<ln;i+=1)\n\t\tprintf(\"%d \",ans[i]);\n}\ninline bool dance(int deep) /*deep \u8868\u793a\u9012\u5f52\u6df1\u5ea6\uff08\u5373\u5220\u9664\u5217\u7684\u4e2a\u6570\uff09*/\t //Start Dancing!\n{\n\tif(r[0]==0)\t\t\t\t\t\t\t\t//\u7a7a\u77e9\u9635\u5219\u8bf4\u660e\u5b8c\u6210\u4e86 \u7cbe\u786e\u8986\u76d6 \uff0c\u8f93\u51fa\u7b54\u6848 \n\t{\n\t\tprint(deep);\n\t\treturn 1;\n\t}\n\t\n\tint c=r[0];\n\tfor(register int i=r[0];i!=0;i=r[i])\t//\u6b64\u5faa\u73af\u7528\u6765\u627e\u77e9\u9635\u4e2d\u5143\u7d20\u6700\u5c11\u7684\u4e00\u5217\uff0c\u4ee5\u51cf\u5c11\u51b3\u7b56\u6811\uff0c\u8282\u7701\u65f6\u95f4 \n\t\tif(sz[i]<sz[c]) c=i;\n\t\t\n\tcut(c);\t\t\t\t\t\t\t\t\t//\u79fb\u9664\u7b2cc\u5217\n\tfor(register int i=d[c];i!=c;i=d[i])\t//\u4f9d\u6b21\u5217\u4e3e\u7b2cc\u5217\u4e2d\u6709\u5143\u7d20\u7684\u6bcf\u4e00\u884c \n\t{\n\t\tans[deep]=row[i];\t\t\t\t\t//\u8bb0\u5f55\u8def\u5f84\uff0c\u4e3a\u4e0b\u5348 \u8f93\u51fa\u7b54\u6848 \u505a\u94fa\u57ab\uff0c\u57cb\u4f0f\u7b14 \n\t\tfor(register int j=r[i];j!=i;j=r[j])//\u5c06\u9009\u4e2d\u7b2c col[j]\u884c\uff0c\u5220\u9664\u76f8\u5173\u5143\u7d20 \n\t\t\tcut(col[j]);\n\t\t\t\n\t\tif(dance(deep+1)) return 1;\t\t\t//\u5982\u679c\u4e3a\u771f\u5219\u8bf4\u660e \u4e0a\u6587\u4e2d \u5df2\u5b8c\u6210\u7cbe\u786e\u8986\u76d6\u4efb\u52a1\uff0c\u56de\u6eaf \n\t\t\t\t\t\t\t\t\t\t\t//\u5982\u679c\u4e3a\u5047\u5219\u8bf4\u660e \u8be5\u5217\u5e76\u4e0d\u5728\u7b54\u6848\u4e2d\uff0c\u4e0b\u6b21\u5faa\u73af\u9009\u53d6\u4e0b\u4e00\u5217 \n\t\tfor(register int j=l[i];j!=i;j=l[j])//\u5c06\u9009\u4e2d\u7b2c col[j]\u884c\uff0c\u6062\u590d\u76f8\u5173\u5143\u7d20 \n\t\t\tback(col[j]);\n\t}\n\tback(c);\t\t\t\t\t\t\t\t//\u6062\u590d\u7b2cc\u5217 \n\treturn 0;\t\t\t\t\t\t\t\t//\u8868\u660e \u4e0a\u6587\u4e3a\u8fbe\u5230\u9898\u76ee\u8981\u6c42\uff0c\u8fd4\u56de\u503c\u4e3a \u5047\uff0c\u56de\u6eaf \n}\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\tbuild(n,m);\n\tfor(register int i=1;i<=n;i+=1)\n\t{\n\t\tfor(register int j=1;j<=m;j+=1)\n\t\t{\n\t\t\tscanf(\"%d\",&x);\n\t\t\tif(x) insert(i,j);\t\t\t\t//\u5c06\u8fd9\u4e2a\u5728i\u884c j\u5217\u7684\u5143\u7d20 \u52a0\u5165\u77e9\u9635\u3001\u94fe\u8868\u4e2d \n\t\t}\n\t}\n\tif(!dance(1))\n\t\tprintf(\"No Solution!\\n\");\n\treturn 0;\n}\n```\n\n**END**\n\u5982\u679c\u5404\u4f4d\u611f\u89c9\u6ce8\u91ca\u592a\u4e71\u7684\u8bdd\uff0c\u8fd9\u91cc\u6709[\u65e0\u6ce8\u91ca\u7248](https://www.luogu.com.cn/paste/enyvu847)\u7684\u3002\n\n\u611f\u8c22\u89c2\u770b~",
        "postTime": 1609932382,
        "uid": 239164,
        "name": "Meteorshower_Y",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4929 \u3010\u3010\u6a21\u677f\u3011\u821e\u8e48\u94fe\uff08DLX\uff09\u3011"
    },
    {
        "content": "### \u9002\u5408\u7528DLX\u6765\u89e3\u51b3\u7684\u9898\u578b\uff1a\n\t\u5b8c\u7f8e\u8986\u76d6\uff08\u68cb\u76d8\u95ee\u9898\uff0c\u6570\u72ec\u95ee\u9898\uff0cn\u7687\u540e\u95ee\u9898..\uff09\n\t\u91cd\u590d\u8986\u76d6\n\n### \u8282\u70b9\u7684\u50a8\u5b58\uff1a\n\u67d0\u5217\u7684\u5927\u5c0f\uff0c\u884c\u5934\u5143\u7d20\uff0c\u6bcf\u4e2a\u8282\u70b9\u4e0a\u4e0b\u5de6\u53f3\u7684\u8282\u70b9\uff0c\u6240\u5728\u7684\u884c\u6570\u5217\u6570\n\n```cpp\nint U[maxn],D[maxn],L[maxn],R[maxn];\nint sz[maxn],h[maxn],col[maxn],row[maxn];\n```\n\n### \u9884\u5904\u7406\uff1a\n```cpp\nvoid prepare()\n{\n\tnum=m;head=0;\n\tfor(int i=0;i<=m;++i)\n\t{\n\t\tU[i]=D[i]=i;sz[i]=0;\n    \tL[i]=i-1;R[i]=i+1;\n\t}\n\tL[head]=m;R[m]=head;\n\tmemset(h,-1,sizeof(h));\n}\n```\n\n### \u8282\u70b9\u7684\u63d2\u5165\uff1a\n\t\u5c06\u503c\u4e3a1\u7684\u8282\u70b9\u63d2\u5165\u53cc\u5411\u94fe\u8868\u4e2d\uff0c\u66f4\u65b0\u5f53\u524d\u8282\u70b9\u548c\u5468\u56f4\u8282\u70b9\u7684\u5173\u7cfb\n\n```cpp\nvoid link(int r,int c)//\u5c06r\u884cc\u5217\u5143\u7d20\u63d2\u5165\u53cc\u5411\u5341\u5b57\u5faa\u73af\u94fe\u8868 \n{\n\tnum++;sz[c]++;\n\tcol[num]=c;row[num]=r;\n\tU[num]=U[c],D[num]=c;\n\tU[D[num]]=D[U[num]]=num;\n\tif(h[r]<0) h[r]=L[num]=R[num]=num;\n    else L[num]=h[r],R[num]=R[h[r]],L[R[h[r]]]=num,R[h[r]]=num;\n}  \n```\n\n### \u8282\u70b9\u7684\u5220\u9664\uff1a\n\t\u5047\u8bbe\u53cc\u5411\u94fe\u7684\u4e09\u4e2a\u8fde\u7eed\u7684\u5143\u7d20\uff0cA1\u3001A2\u3001A3\uff0c\u6bcf\u4e2a\u5143\u7d20\u6709\u4e24\u4e2a\u5206\u91cfLeft\u548cRight\uff0c\u5206\u522b\u6307\u5411\u5de6\u8fb9\u548c\u53f3\u8fb9\u7684\u5143\u7d20\u3002\u7531\u5b9a\u4e49\u53ef\u77e5\n\t\n    A1.Right=A2\uff0cA2.Right=A3\n\tA2.Left=A1\uff0cA3.Left=A2\n\t\n    \u5728\u8fd9\u4e2a\u53cc\u5411\u94fe\u4e2d\uff0c\u53ef\u4ee5\u7531\u4efb\u4e00\u4e2a\u5143\u7d20\u5f97\u5230\u5176\u4ed6\u4e24\u4e2a\u5143\u7d20\uff0cA1.Right.Right=A3\uff0cA3.Left.Left=A1\u7b49\u7b49\n\u00a0\n\t\u73b0\u5728\u628aA2\u8fd9\u4e2a\u5143\u7d20\u4ece\u53cc\u5411\u94fe\u4e2d\u79fb\u9664\uff08\u4e0d\u662f\u5220\u9664\uff09\u51fa\u53bb\uff0c\u90a3\u4e48\u6267\u884c\u4e0b\u9762\u7684\u64cd\u4f5c\u5c31\u53ef\u4ee5\u4e86\n\t\n    A1.Right=A3\uff0cA3.Left=A1\n\n```cpp\nvoid remove(int c)//\u5220\u9664\u67d0\u4e00\u5217\u4e2d\u51fa\u73b01\u7684\u6240\u6709\u884c \n{\n\tL[R[c]]=L[c],R[L[c]]=R[c];\n\tfor(int i=D[c];i!=c;i=D[i])\n\t\tfor(int j=R[i];j!=i;j=R[j])\n\t\t\tU[D[j]]=U[j],D[U[j]]=D[j],sz[col[j]]--;\n}\n```\n\n### \u8282\u70b9\u7684\u590d\u539f\uff1a\n\t\u5982\u679c\u6b64\u65f6\u53d1\u73b0\uff0c\u9700\u8981\u628aA2\u8fd9\u4e2a\u5143\u7d20\u91cd\u65b0\u52a0\u5165\u5230\u53cc\u5411\u94fe\u4e2d\u7684\u539f\u6765\u7684\u4f4d\u7f6e\uff0c\u4e5f\u5c31\u662fA1\u548cA3\u7684\u4e2d\u95f4\u3002\u7531\u4e8eA2\u7684\u4e24\u4e2a\u5206\u91cf\u6ca1\u6709\u53d1\u751f\u53d8\u5316\uff0c\u4ecd\u7136\u6307\u5411A1\u548cA3\u3002\u90a3\u4e48\u53ea\u8981\u4fee\u6539A1\u7684Right\u5206\u91cf\u548cA3\u7684Left\u5c31\u884c\u4e86\u3002\u4e5f\u5c31\u662f\u4e0b\u9762\u7684\u64cd\u4f5c\n\t\n    A1.Right=A2\uff0cA3.Left=A2\n\n```cpp\nvoid resume(int c)//\u91cd\u7f6e\u67d0\u4e00\u5217\u4e2d\u51fa\u73b01\u7684\u6240\u6709\u884c\n{\n\tfor(int i=D[c];i!=c;i=D[i])\n\t    for(int j=R[i];j!=i;j=R[j])\n\t\t    U[D[j]]=D[U[j]]=j,sz[col[j]]++;\n    L[R[c]]=R[L[c]]=c; \n}\n```\n### \u6838\u5fc3\u51fd\u6570\uff08\u672c\u8d28dfs\uff09\n\t\u679a\u4e3e\u6ca1\u6709\u8986\u76d6\u7684\u5217\uff0c\u9009\u62e9\u672c\u5217\u542b\u67091\u7684\u884c\u6570\u8fdb\u884c\u5220\u9664\uff0c\u7136\u540e\u56de\u6eaf\n\n```cpp\nint dance(int dep)\n{\n\tif(R[head]==head)return true;\n\tint c=R[head];\n\tfor(int i=R[head];i!=head;i=R[i])if(sz[i]<sz[c]) c=i;//\u9009\u53d6\u51fa\u73b01\u5143\u7d20\u6b21\u6570\u6700\u5c11\u7684\u4e00\u5217\u8fdb\u884c\u5220\u9664\n\tremove(c);\n\tfor(int i=D[c];i!=c;i=D[i])\n\t{\n\t\tfor(int j=R[i];j!=i;j=R[j]) remove(col[j]);\n\t\tif(dance(dep+1)){printf(\"%d \",row[i]);return true;} \n\t\tfor(int j=L[i];j!=i;j=L[j]) resume(col[j]);\n\t}\n\tresume(c);\n\treturn false;\n}\n```\n\n\n\t\u5b8c\u6574\u4ee3\u7801qwq\uff1a\n    \n```cpp\n#include <iostream>\n#include <algorithm>\n#include <cstdio>\n#include <cmath>\n#include <ctime>\n#include <cstring>\n#include <cstdlib>\n#define maxn 10000+5\nusing namespace std;\n\nint n,m,d,num,head;\nint U[maxn],D[maxn],L[maxn],R[maxn];\nint sz[maxn],h[maxn],col[maxn],row[maxn];//sz:\u4e00\u5217\u6709\u591a\u5c11\u4e2a h\uff1a\u884c\u5934\u5143\u7d20 col&&row\uff1a\u5f53\u524d\u70b9\u6240\u5728\u7684\u884c\u6570\u548c\u5217\u6570 \n\nvoid prepare()\n{\n\tnum=m;head=0;\n\tfor(int i=0;i<=m;++i)\n\t{\n\t\tU[i]=D[i]=i;sz[i]=0;\n    \tL[i]=i-1;R[i]=i+1;\n\t}\n\tL[head]=m;R[m]=head;\n\tmemset(h,-1,sizeof(h));\n}\n\nvoid link(int r,int c)//\u5c06r\u884cc\u5217\u5143\u7d20\u63d2\u5165\u53cc\u5411\u5341\u5b57\u5faa\u73af\u94fe\u8868 \n{\n\tnum++;sz[c]++;\n\tcol[num]=c;row[num]=r;\n\tU[num]=U[c],D[num]=c;\n\tU[D[num]]=D[U[num]]=num;\n\tif(h[r]<0) h[r]=L[num]=R[num]=num;\n    else L[num]=h[r],R[num]=R[h[r]],L[R[h[r]]]=num,R[h[r]]=num;\n}  \n\nvoid remove(int c)//\u5220\u9664\u67d0\u4e00\u5217\u4e2d\u51fa\u73b01\u7684\u6240\u6709\u884c \n{\n\tL[R[c]]=L[c],R[L[c]]=R[c];\n\tfor(int i=D[c];i!=c;i=D[i])\n\t\tfor(int j=R[i];j!=i;j=R[j])\n\t\t\tU[D[j]]=U[j],D[U[j]]=D[j],sz[col[j]]--;\n}\n\nvoid resume(int c)//\u91cd\u7f6e\u67d0\u4e00\u5217\u4e2d\u51fa\u73b01\u7684\u6240\u6709\u884c\n{\n\tfor(int i=D[c];i!=c;i=D[i])\n\t    for(int j=R[i];j!=i;j=R[j])\n\t\t    U[D[j]]=D[U[j]]=j,sz[col[j]]++;\n    L[R[c]]=R[L[c]]=c; \n}\n\nint dance(int dep)\n{\n\tif(R[head]==head)return true;\n\tint c=R[head];\n\tfor(int i=R[head];i!=head;i=R[i])if(sz[i]<sz[c]) c=i;//\u9009\u53d6\u51fa\u73b01\u5143\u7d20\u6b21\u6570\u6700\u5c11\u7684\u4e00\u5217\u8fdb\u884c\u5220\u9664\n\tremove(c);\n\tfor(int i=D[c];i!=c;i=D[i])\n\t{\n\t\tfor(int j=R[i];j!=i;j=R[j]) remove(col[j]);\n\t\tif(dance(dep+1)){printf(\"%d \",row[i]);return true;} \n\t\tfor(int j=L[i];j!=i;j=L[j]) resume(col[j]);\n\t}\n\tresume(c);\n\treturn false;\n}\n\nint main()\n{\n    scanf(\"%d%d\",&n,&m);\n\tprepare();\n    for(int i=1;i<=n;++i)\n    for(int j=1;j<=m;++j)\n    {\n    \tscanf(\"%d\",&d);\n    \tif(d) link(i,j);\n\t}\n\tif(!dance(1)) puts(\"No Solution!\");\n\treturn 0;\n}\n```\n\n",
        "postTime": 1540523632,
        "uid": 56888,
        "name": "\u0e05\u5357\u74dc\u0e05",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4929 \u3010\u3010\u6a21\u677f\u3011\u821e\u8e48\u94fe\uff08DLX\uff09\u3011"
    },
    {
        "content": "\u6211\u6765~~\u6c34\u4e00\u6ce2\u9898\u89e3~~\u5206\u4eab\u4e00\u4e0b\u6211\u7684\u89e3\u6cd5\u3002\n# \u7b97\u6cd5\u5206\u6790\n\u9996\u5148\u770b\u5230\u8fd9\u9053\u9898\u53ef\u4ee5\u60f3\u5230\u4ec0\u4e48\uff1f\n\n\u66b4\u529b\uff01\n\n\u5bf9\u7684\u6ca1\u9519\u8fd9\u9898\u6b63\u89e3\u5c31\u662f\u66b4\u529b\uff08\u6ed1\u7a3d\n\n\u90a3\u6211\u4eec\u600e\u4e48\u66b4\u529b\u5462\uff1f\n\n~~\u4f9d\u6b21\u679a\u4e3e\u6bcf\u884c\u662f\u5426\u53d6\u8d70\u7136\u540e\u5224\u65ad\u662f\u5426\u5408\u6cd5~~\uff08T\u5230\u98de\u8d77\uff09\n\n\u6211\u4eec\u53ef\u4ee5\u4f9d\u6b21\u679a\u4e3e\u6bcf\u5217\u51fa\u73b0\u7684\u884c\uff0c\u7136\u540e\u7ed9\u8fd9\u884c\u4e0a\u51fa\u73b0\u7684 1 \u6240\u5728\u5217\u6253\u4e0a\u6807\u8bb0\uff0c\u5220\u6389\u542b\u6253\u4e0a\u6807\u8bb0\u7684\u884c\uff0c\u7136\u540e\u6362\u4e00\u5217\u679a\u4e3e\u3002\n\n\u6ca1\u770b\u61c2\uff1f\u4e0a\u56fe\uff1a\n![](https://cdn.luogu.com.cn/upload/image_hosting/aoq5vxhw.png)\n\u56fe\u4e2d\u7684\u6570\u5b57\u662f\u8f93\u5165\u65f6\u7ed9\u7684\u77e9\u9635\uff0c\u7ea2\u7ebf\u753b\u51fa\u7684\u662f\u5f53\u524d\u679a\u4e3e\u7684\u5217\uff0c\u7eff\u7ebf\u753b\u51fa\u7684\u662f\u5f53\u524d\u679a\u4e3e\u7684\u884c\uff0c\u9ec4\u7ebf\u753b\u51fa\u7684\u662f\u88ab\u6253\u4e0a\u6807\u8bb0\u7684\u5217\uff0c\u84dd\u7ebf\u753b\u51fa\u7684\u662f\u5f53\u524d\u5220\u6389\u7684\u884c\u3002\n\n\u6211\u4eec\u4ece\u7b2c\u4e00\u5217\u5f00\u59cb\u679a\u4e3e\uff0c\u5148\u679a\u4e3e\u7b2c\u4e00\u5217\u4e0a\u7684\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u884c\u7b2c\u4e00\u884c\u3002\n\n\u7b2c\u4e00\u884c\u7ecf\u8fc7\u7684\u5217\u6709\u7b2c\u4e00\u3001\u4e8c\u548c\u4e94\u5217\uff0c\u6211\u4eec\u7ed9\u5b83\u4eec\u6253\u4e0a\u6807\u8bb0\u3002\n\n\u63a5\u4e0b\u6765\u8fdb\u884c\u5220\u9664\u3002\u53ef\u4ee5\u770b\u5230\u7b2c\u4e8c\u884c\u7531\u4e8e\u7b2c\u4e8c\u5217\u88ab\u6253\u4e0a\u6807\u8bb0\u800c\u88ab\u5220\u9664\u4e86\uff0c\u7b2c\u56db\u884c\u4e5f\u56e0\u7b2c\u4e00\u5217\u88ab\u6253\u4e0a\u6807\u8bb0\u800c\u58ee\u70c8\u727a\u7272\u4e86\u3002\n\n\u5982\u4e0a\u6b65\u9aa4\u91cd\u590d\u591a\u6b21\uff0c\u5982\u679c\u6240\u6709\u5217\u90fd\u6253\u4e0a\u4e86\u6807\u8bb0\u5c31\u8f93\u51fa\u89e3\uff0c\u5982\u679c\u5f53\u524d\u679a\u4e3e\u7684\u884c\u65e0\u89e3\u5219\u56de\u6eaf\u3002\n***\n\u90a3\u95ee\u9898\u6765\u4e86\uff1a\u600e\u4e48\u5220\u884c\uff1f\n\n~~\u8fd9\u4e0d\u597d\u8bf4\uff0c\u628a\u90a3\u4e00\u884c\u7528 0 \u8d4b\u4e00\u904d\u5c31\u884c\u4e86\u3002~~\n\n\u8fd9\u6837\u7684\u8bdd\u6bcf\u6b21\u5220\u884c\u90fd\u8981\u904d\u5386\u4e00\u904d\u3002\u4f1a T \u5230\u98de\u8d77\u554a\u3002\n\n\u4f46\u6ce8\u610f\u5230 1 \u7684\u6570\u91cf\u4e0d\u8d85\u8fc7 5000 \u4e2a\u3002\n\n\u90a3\u4e48\u6211\u4eec\u6bcf\u6b21\u53ea\u9700\u8981\u628a 1 \u8d4b\u6210 0 \u5c31\u884c\u4e86\uff0c\u6ca1\u5fc5\u8981\u628a 0 \u8d4b\u6210  0\u3002\n\n\uff08\u4e0a\u9762\u8fd9\u4e48\u8bf4\u53ea\u662f\u65b9\u4fbf\u7406\u89e3\uff0c\u5b9e\u9645\u64cd\u4f5c\u4e2d\u5e76\u65e0\u8d4b 0 \u64cd\u4f5c\u3002\uff09\n\n\u90a3\u63a5\u4e0b\u6765\u6211\u4eec\u8fdb\u5165\u91cd\u70b9\u3002\n# \u821e\u8e48\u94fe\u5206\u6790\n\u821e\u8e48\u8fde\u662f\u4ec0\u4e48\uff1f\n\n~~\u4e8c\u7ef4\u53cc\u5411\u5faa\u73af\u5341\u5b57\u94fe\u8868\u3002~~\n\n\u7ffb\u8bd1\u6210\u4eba\u8bdd\u5c31\u957f\u4e0b\u9762\u8fd9\u6837\uff1a\n![](https://cdn.luogu.com.cn/upload/image_hosting/q32kwi79.png)\n~~\u5dee\u70b9\u6ca1\u753b\u6b7b\u6211\u3002~~\n\n\u84dd\u8272\u7684\u662f\u5217\u865a\u62df\u8282\u70b9\uff0c\u9ec4\u8272\u7684\u662f\u884c\u865a\u62df\u8282\u70b9\uff0c\u7ea2\u8272\u7684\u662f\u666e\u901a\u8282\u70b9\u3002\n\n\u6bcf\u4e2a\u8282\u70b9\u90fd\u50a8\u5b58\u7740\u5b83\u4e0a\u4e0b\u76f8\u90bb\u7684 1 \u6240\u5728\u884c\u548c\u5de6\u53f3\u76f8\u90bb\u7684 1 \u6240\u5728\u7684\u5217\u3002\n\n\uff08\u8fd9\u91cc\u53ea\u662f\u65b9\u4fbf\u63cf\u8ff0\uff0c\u5b9e\u9645\u64cd\u4f5c\u65f6\u6309\u7167\u771f\u5b9e\u7684\u4e0a\u4e0b\u5de6\u53f3\u50a8\u5b58\u6bd4\u8f83\u9ebb\u70e6\uff0c\u6545\u53ea\u9700\u4f7f\u94fe\u8868\u53ef\u4ee5\u904d\u5386\u884c\u548c\u5217\u7684\u5143\u7d20\u5373\u53ef\u3002\u53ef\u5bf9\u6bd4\u4e00\u7ef4\u6570\u7ec4\u94fe\u8868\u7406\u89e3\u3002\uff09\n\n\u4e3a\u4e86\u5feb\u901f\u627e\u5230\u884c\u548c\u5217\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6bcf\u884c\u5de6\u8fb9\u52a0\u5165\u884c\u865a\u62df\u8282\u70b9\uff0c\u6bcf\u5217\u4e0a\u9762\u52a0\u5165\u5217\u865a\u62df\u8282\u70b9\u3002\n\n\u7279\u6b8a\u7684\uff0c\u6240\u6709\u7684\u5217\u865a\u62df\u8282\u70b9\u4e5f\u7b97\u4e00\u884c\uff0c\u6545\u8981\u5728\u6240\u6709\u7684\u5217\u865a\u62df\u8282\u70b9\u524d\u52a0\u5165\u4e00\u4e2a\u884c\u865a\u62df\u8282\u70b9\u3002\u5f53\u6709\u5217\u6253\u4e0a\u6807\u8bb0\u65f6\u4fbf\u5c06\u90a3\u4e2a\u5217\u7684\u5217\u865a\u62df\u8282\u70b9\u5220\u9664\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53d1\u73b0\u6253\u4e86\u6807\u8bb0\u7684\u5217\u90fd\u88ab\u5220\u4e86\u90a3\u4e48\u6807\u8bb0\u4e5f\u5c31\u6ca1\u6709\u7528\u4e86\u3002\n\n\uff08\u5728\u5b9e\u9645\u64cd\u4f5c\u4e2d\u4e0d\u9700\u8981\u65b0\u5f00\u6570\u7ec4\uff0c\u4e00\u822c\u4ee5\u6bcf\u884c\u6216\u5217\u7684\u7b2c 0 \u4e2a\u4f5c\u4e3a\u865a\u62df\u8282\u70b9\u3002\u81ea\u7136\uff0c\u5217\u865a\u62df\u8282\u70b9\u7684\u90a3\u4e00\u884c\u884c\u53f7\u4e3a 0\uff09\n\n\u6211\u4eec\u53d1\u73b0\u8981\u6ee1\u8db3\u4e09\u4e2a\u64cd\u4f5c\uff1a\u5efa~~\u8bbe\u94f6~~\u884c\uff0c\u5220\u9664\u884c\uff08\u526a\u679d\uff09\u548c\u52a0\u5165\u884c\uff08\u56de\u6eaf\u548c\u5efa\u8868\uff09\u3002\n\n\u4e3a\u4ec0\u4e48\u8981\u5efa\u884c\u5462\uff1f\u5efa\u821e\u8e48\u94fe\u5462\uff1f~~\u5de5\u5546\u94f6\u884c\u5b83\u4e0d\u9999\u5417\u3002~~\n\n\u53ef\u4ee5\u53d1\u73b0\u6bcf\u884c\u7684\u8282\u70b9\u4e4b\u95f4\u7684\u76f8\u90bb\u60c5\u51b5\u5728\u679a\u4e3e\u8fc7\u7a0b\u4e2d\u4e0d\u4f1a\u53d1\u751f\u53d8\u5316\uff0c\u6240\u4ee5\u5728\u8bfb\u5165\u65f6\u5c31\u53ef\u4ee5\u628a\u540c\u884c\u8282\u70b9\u4e4b\u95f4\u7684\u76f8\u90bb\u5173\u7cfb\u5373\u5de6\u53f3\u5efa\u597d\uff0c\u5efa\u5b8c\u540e\u628a\u8be5\u884c\u7528\u52a0\u5165\u884c\u52a0\u5165\u5230\u94fe\u8868\u4e2d\u5c31\u884c\u4e86\u3002\n\n\u600e\u4e48\u5efa\u540c\u884c\u4e2d\u7684\u5de6\u53f3\u5173\u7cfb\u5462\uff1f\n\n\u8fd8\u8bb0\u5f97\u600e\u4e48\u5efa\u4e00\u7ef4\u7684\u53cc\u5411\u5faa\u73af\u94fe\u8868\u7684\u5417\uff1f\n\n~~\u90fd\u7814\u7a76\u821e\u8e48\u94fe\u4e86\u6ca1\u6709\u4eba\u6ca1\u5b66\u8fc7\u5427\u3002~~\n\n\u5c31\u662f\u5bf9\u6bcf\u5217\u7684\u8282\u70b9\u5efa\u4e00\u4e2a\u53cc\u5411\u5faa\u73af\u94fe\u8868\u4e86\u3002\n\n\u53ea\u4e0d\u8fc7\u884c\u865a\u62df\u8282\u70b9\u8981\u5efa\u5728\u8be5\u884c\u6700\u524d\u9762\u3002\n\n\u90a3\u884c\u4e0e\u884c\u4e4b\u95f4\u7684\u4e0a\u4e0b\u5173\u7cfb\u5462\uff1f\n\n\u63d2\u5165\u65f6\u904d\u5386\u8be5\u884c\u6240\u6709\u8282\u70b9\uff0c\u628a\u8be5\u8282\u70b9\u50cf\u4e00\u7ef4\u7684\u53cc\u5411\u5faa\u73af\u94fe\u8868\u4e00\u6837\u63d2\u5165\u8be5\u5217\u672b\u5c3e\u5373\u53ef\uff08\u6ce8\u610f\u4e0d\u4e00\u5b9a\u8981\u63d2\u5230\u539f\u4f4d\u7f6e\uff09\u3002\n\n\u5220\u9664\u65f6\u904d\u5386\u8be5\u884c\u6240\u6709\u8282\u70b9\uff0c\u628a\u8be5\u8282\u70b9\u50cf\u4e00\u7ef4\u7684\u53cc\u5411\u5faa\u73af\u94fe\u8868\u4e00\u6837\u5220\u9664\u5373\u53ef\u3002~~\u4eba\u6027\u7684\u672c\u8d28\u3002~~\n\n\u8fd8\u8981\u505a\u4e24\u4e2a\u4f18\u5316\uff0c\u4e00\u4e2a\u662f\u6bcf\u6b21\u5148\u679a\u4e3e\u5269\u4f59\u8282\u70b9\u6700\u5c11\u7684\u5217\uff08\u4f18\u5316\u641c\u7d22\u987a\u5e8f\uff09\uff0c\u53e6\u4e00\u4e2a\u662f\u679a\u4e3e\u65f6\u63d2\u5165\u7684\u987a\u5e8f\u8981\u548c\u5220\u9664\u7684\u987a\u5e8f\u76f8\u53cd\uff08\u6211\u4e5f\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u8981\u8fd9\u4e48\u5e72\uff09\u3002\n\n\u7528\u4e8b\u5b9e\u8bc1\u660e\u4f18\u5316\u4e8c\u6709\u591a\u91cd\u8981\uff1a\n\n+ [\u4f18\u5316\u4e00\u548c\u4f18\u5316\u4e8c\u90fd\u6ca1\u505a\u7684](https://www.luogu.com.cn/record/30576498)\n\n+ [\u505a\u4e86\u4f18\u5316\u4e00\u6ca1\u505a\u4f18\u5316\u4e8c\u7684](https://www.luogu.com.cn/record/30580413)\n\n+ [\u4f18\u5316\u4e00\u548c\u4f18\u5316\u4e8c\u90fd\u505a\u4e86\u7684](https://www.luogu.com.cn/record/30692419)\n# \u4ee3\u7801\u5206\u6790\n\u6211\u77e5\u9053\u6211\u53d8\u91cf\u540d\u662f\u4e71\u53d6\u7684\u3002\u90a3\u6211\u5c31\u7528~~\u7d2b\u540d~~\u51e0\u4e4e\u6bcf\u884c\u4e00\u53e5\u7684\u6ce8\u91ca\u5c06\u529f\u8865\u8fc7\u5427\u3002\n\n\u8fd8\u662f\u8865\u5145\u8bf4\u660e\u4e00\u4e0b\uff1an,m,a \u662f\u539f\u9898\u7ed9\u51fa\u7684\u884c\u6570\u5217\u6570\u548c\u77e9\u9635\uff0co \u7528\u6765\u8bb0\u5f55\u6bcf\u5217\u73b0\u5b58\u591a\u5c11 1 \u4ee5\u4fbf\u8fdb\u884c\u4f18\u5316\u4e00\uff0cans,con \u8bb0\u5f55\u7b54\u6848\uff08\u7c7b\u4f3c\u6808\uff09\uff0ct \u8bb0\u5f55\u662f\u5426\u6709\u89e3\u4ee5\u4fbf\u627e\u5230\u89e3\u53ca\u65f6\u9000\u51fa\u3002\n```cpp\n//\u73cd\u7231\u8d26\u53f7\uff0c\u8fdc\u79bbJC\nint n,m,a[511][511],o[511],ans[511],con,t;//\u540c\u4e0a\nstruct dlx//\u5199\u5728\u7ed3\u6784\u4f53\u91cc\u65b9\u4fbf\u4ee5\u540e\u76f4\u63a5\u4f7f\u7528\n{\n\tint u[511][511],d[511][511],l[511][511],r[511][511];//\u4e0a\u4e0b\u5de6\u53f3\u6307\u9488\n\tvoid buiro(int x)//\u5efa\u884c\n\t{\n\t\tfor(register int y=1; y<=m; ++y)//\u679a\u4e3e\u8be5\u884c\u6bcf\u4e2a\u6570\n\t\t{\n\t\t\tif(!a[x][y])//\u5982\u679c\u8fd9\u4e2a\u6570\u662f1\n\t\t\t{\n\t\t\t\tr[x][y]=0;//\u4e3a\u4e86\u5faa\u73af\u5c06\u8be5\u6570\u53f3\u6307\u9488\u6307\u5411\u8be5\u884c\u865a\u62df\u8282\u70b9\n\t\t\t\tl[x][y]=l[x][0];//\u5c06\u8be5\u6570\u5de6\u6307\u9488\u6307\u5411\u8be5\u884c\u865a\u62df\u8282\u70b9\u5de6\u6307\u9488\u8282\u70b9\u5373\u672b\u5c3e\n\t\t\t\tr[x][l[x][y]]=y;//\u662f\u53cc\u5411\u94fe\u8868\u6240\u4ee5\u6307\u56de\u6765\n\t\t\t\tl[x][r[x][y]]=y;//\u540c\u4e0a\n\t\t\t}\n\t\t}\n\t}\n\tvoid addro(int x)//\u52a0\u5165\u884c\uff0c\u4e0e\u5efa\u884c\u5dee\u4e0d\u591a\n\t{\n\t\tfor(register int y=r[x][0]; y; y=r[x][y])//\u679a\u4e3e\u8be5\u884c\u6240\u6709\u8282\u70b9\n\t\t{\n\t\t\td[x][y]=0;\n\t\t\tu[x][y]=u[0][y];\n\t\t\td[u[x][y]][y]=x;\n\t\t\tu[d[x][y]][y]=x;\n\t\t\to[y]++;//\u6240\u5728\u5217 1 \u7684\u6570\u91cf\u52a0 1\n\t\t}\n\t}\n\tvoid delro(int x)//\u5220\u9664\u884c\n\t{\n\t\tfor(register int y=l[x][0]; y; y=l[x][y])//\u5012\u5e8f\u679a\u4e3e\u8be5\u884c\u6240\u6709\u8282\u70b9\n\t\t{\n\t\t\td[u[x][y]][y]=d[x][y];//\u8be5\u8282\u70b9\u7684\u4e0a\u76f8\u90bb\u8282\u70b9\u7684\u4e0a\u6307\u9488\u76f4\u63a5\u8df3\u8fc7\u8be5\u8282\u70b9\u6307\u5411\u8be5\u8282\u70b9\u4e0b\u6307\u9488\u8282\u70b9\n\t\t\tu[d[x][y]][y]=u[x][y];//\u540c\u4e0a\n\t\t\to[y]--;//\u6240\u5728\u5217 1 \u7684\u6570\u91cf\u51cf 1\n\t\t}\n\t}\n} c;//\u5bf9\u8c61\uff08OP\u672f\u8bed\u5373\u7ed3\u6784\u4f53\u53d8\u91cf\uff09\nvoid dfs()//\u679a\u4e3e\n{\n\tif(!c.r[0][0])//\u5982\u679c\u5217\u865a\u62df\u8282\u70b9\u7684\u90a3\u4e00\u884c\u7684\u884c\u865a\u62df\u8282\u70b9\u53f3\u8282\u70b9\u6307\u5411\u81ea\u5df1\u5373\u5217\u90fd\u88ab\u5220\u5b8c\u4e86\n\t{\n\t\tfor(register int i=0; i<con; ++i)//\u904d\u5386 ans \u6570\u7ec4\n\t\t\tprintf(\"%d \",ans[i]);//\u8f93\u51fa\u89e3\n\t\tt=1;//t \u8d4b 1 \u4ee5\u5feb\u901f\u9000\u51fa\n\t\treturn;//\u9000\u51fa\u5f53\u524d\u51fd\u6570\n\t}\n\tregister int g=INT_MAX,p=0;//g \u662f\u73b0\u5b58\u8282\u70b9\u4e2d\u6700\u5c0f\u7684 o[i]\uff0cp \u662f\u62e5\u6709\u6700\u5c0f\u7684 o[i] \u7684\u5217\u7684\u7f16\u53f7\n\tfor(register int i=c.r[0][0]; i; i=c.r[0][i])//\u904d\u5386\u6240\u6709\u73b0\u5b58\u7684\u5217\n\t{\n\t\tif(g>o[i])//\u5982\u679c\u5c0f\u4e8e\u5f53\u524d\u6700\u5c0f o[i]\n\t\t\tg=o[p=i];//\u628a g \u8d4b\u6210 o[i]\uff0cp \u8d4b\u6210 i\n\t}\n\tint v[511],k=0;//\u5012\u5e8f\u63d2\u5165\u4f1a\u6253\u4e71\u8be5\u5217\u987a\u5e8f\uff0c\u9700\u8981\u6211\u4eec\u8bb0\u5f55\u6240\u6709\u9700\u8981\u679a\u4e3e\u7684\u884c\n\tfor(register int i=c.d[0][p]; i; i=c.d[i][p])//\u904d\u5386\u7b2c p \u5217\n\t{\n\t\tv[k++]=i;//\u628a\u5217\u4e0a\u7684\u6240\u6709\u884c\u52a0\u5165 v \u6570\u7ec4\n\t}\n\tfor(int i=0;i<k;++i)//\u679a\u4e3e\u6240\u6709\u9700\u8981\u679a\u4e3e\u7684\u884c\n\t{\n\t\tint s[511],w=0;//\u8bb0\u5f55\u88ab\u5220\u6389\u7684\u5217\u4ee5\u4fbf\u56de\u6eaf\n\t\tfor(register int j=c.l[v[i]][0]; j; j=c.l[v[i]][j])//\u679a\u4e3e\u5f53\u524d\u884c\u4e2d\u51fa\u73b0\u7684\u5217\n\t\t{\n\t\t\tc.r[0][c.l[0][j]]=c.r[0][j];//\u5220\u9664\u6b64\u5217\u865a\u62df\u8282\u70b9\n\t\t\tc.l[0][c.r[0][j]]=c.l[0][j];\n\t\t\twhile(c.d[0][j])//\u679a\u4e3e\u51fa\u73b0\u5728\u6b64\u5217\u7684\u884c\n\t\t\t\tc.delro(s[w++]=c.d[0][j]);//\u5e76\u5220\u6389\u5b83\n\t\t}\n\t\tans[con++]=v[i];//\u5c06\u679a\u4e3e\u884c\u7684\u52a0\u5165 ans \u6570\u7ec4\n\t\tdfs();//\u7ee7\u7eed\u679a\u4e3e\n\t\tif(t)//\u5982\u679c\u627e\u5230\u7b54\u6848\n\t\t\treturn;//\u5c31\u5feb\u901f\u9000\u51fa\n\t\tcon--;//\u5426\u5219\u5c06\u5f53\u524d\u679a\u4e3e\u7684\u884c\u5f39\u51fa\n\t\tfor(register int j=c.r[v[i]][0]; j&&f[j]; j=c.r[v[i]][j])//\u904d\u5386\u56e0\u5f53\u524d\u884c\u800c\u5220\u6389\u7684\u5217\n\t\t{\n\t\t\tc.r[0][j]=0;//\u5c06\u5b83\u7684\u5217\u865a\u62df\u8282\u70b9\u6062\u590d\n\t\t\tc.l[0][j]=c.l[0][0];\n\t\t\tc.r[0][c.l[0][j]]=j;\n\t\t\tc.l[0][c.r[0][j]]=j;\n\t\t}\n\t\tfor(register int j=w-1; j>=0; --j)//\u5012\u5e8f\u904d\u5386\u56e0\u5f53\u524d\u884c\u800c\u5220\u6389\u7684\u884c\n\t\t\tc.addro(s[j]);//\u5e76\u6062\u590d\u5b83\n\t}\n}\nint main()//\u4e3b\u51fd\u6570\n{\n\tregister char h;//\u5feb\u8bfb\u4f7f\u7528\n\tscanf(\"%d%d\",&n,&m);//\u8bfb\u5165n\u3001m\n\tc.buiro(0);//\u5efa\u5217\u865a\u62df\u8282\u70b9\u7684\u90a3\u4e00\u884c\n\tfor(register int i=1; i<=n; ++i)//\u5f53\u524d\u884c\n\t{\n\t\tfor(register int j=1; j<=m; ++j)//\u5f53\u524d\u5217\n\t\t{\n\t\t\tdo\n\t\t\t{\n\t\t\t\th=getchar();\n\t\t\t}\n\t\t\twhile(h!='0'&&h!='1');//\u5feb\u8bfb\n\t\t\ta[i][j]='1'-h;//\u5b58\u8fdb a \u77e9\u9635\n\t\t}\n\t\tc.buiro(i);//\u5148\u5efa\u884c\n\t\tc.addro(i);//\u518d\u52a0\u5165\u5f53\u524d\u884c\n\t}\n\tdfs();//\u679a\u4e3e\n\tif(!t)//\u5982\u679c\u65e0\u89e3\n\t\tprintf(\"No Solution!\");//\u5219\u8f93\u51fa\n}\n```\n\u5f53\u7136\uff0c\u821e\u8e48\u94fe\u7684\u5199\u6cd5\u6709\u5f88\u591a\uff0c\u522b\u7684\u9898\u89e3\u5927\u90e8\u5206\u662f\u5c06\u4e0a\u4e0b\u5de6\u53f3\u6307\u9488\u5b58\u5728\u4e00\u7ef4\u6570\u7ec4\u91cc\uff0c\u800c\u6211\u5c06\u5b83\u4eec\u5b58\u5728\u4e8c\u7ef4\u6570\u7ec4\u91cc\uff0c\u867d\u7136\u5360\u7a7a\u95f4\u4f46\u66f4\u65b9\u4fbf\u597d\u5199\u3002\n\n\u5f53\u7136\uff0c\u821e\u8e48\u94fe\u4e0d\u4ec5\u80fd\u89e3\u51b3\u7cbe\u51c6\u8986\u76d6\u95ee\u9898\uff0c\u8fd8\u662f\u89e3\u51b3\u6570\u72ec\u95ee\u9898\u3001\u516b\u7687\u540e\u95ee\u9898\u7684\u5229\u5668\u3002\n\n~~\u9ebb\u9ebb\u518d\u4e5f\u4e0d\u7528\u62c5\u5fc3\u6211\u88ab\u9776\u5f62\u6570\u72ec\u5361\u4e86~~\n\n\u5b8c\u7ed3\u6492\u82b1\\\\(^o^)/",
        "postTime": 1581837440,
        "uid": 150384,
        "name": "pyqpyq",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4929 \u3010\u3010\u6a21\u677f\u3011\u821e\u8e48\u94fe\uff08DLX\uff09\u3011"
    },
    {
        "content": "update2022.8.3\uff1a\u4fee\u6539\u95ee\u9898\u5b9a\u4e49\u7684\u7b2c\u4e00\u6761\u7684\u9519\u8bef\u3002\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](http://cmsblog.top/archives/dlx)\n\n## \u7cbe\u786e\u8986\u76d6\u95ee\u9898\n\n### \u95ee\u9898\u5b9a\u4e49\n\n\u7cbe\u786e\u8986\u76d6\u95ee\u9898\uff08\u82f1\u6587\uff1aExact Cover Problem) \u662f\u6307\u7ed9\u5b9a\u8bb8\u591a\u96c6\u5408 $S_i(1\\leq i \\leq n)$  \u4ee5\u53ca\u4e00\u4e2a\u96c6\u5408 $X$ \uff0c\u6c42\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u7684\u65e0\u5e8f\u591a\u5143\u7ec4 $(T_1,T_2,\\cdots,T_m)$\uff1a\n\n+ $\\forall i , j \\in [1,m] , T_i \\cap T_j = \\varnothing(i \\neq j)$\n\n+ $X = \\bigcup\\limits_{i=1}^mT_i$\n\n+ $\\forall i \\in [1,m] , T_i \\in \\{S_1 , S_2,\\cdots,,S_n\\}$\n\n\u4f8b\u5982\uff0c\u82e5\u7ed9\u51fa\uff1a\n\n$$\nS_1 = \\{5,9,17\\}\n$$\n$$\nS_2 = \\{1,8,119\\}\n$$\n$$\nS_3= \\{3,5,17\\}\n$$\n$$\nS_4 = \\{1,8\\}\n$$\n$$\nS_5 = \\{3,119\\}\n$$\n$$\nS_6 = \\{8,9,119\\}\n$$\n$$\nX = \\{1,3,5,8,9,17,119\\}\n$$\n\n\u5219 $(S_1,S_4 , S_5)$ \u4e3a\u4e00\u7ec4\u5408\u6cd5\u89e3\u3002\n\n### \u95ee\u9898\u8f6c\u5316\n\n\u5c06 $\\bigcup\\limits_{i=1}^n S_i$ \u4e2d\u7684\u6240\u6709\u6570\u79bb\u6563\u5316\uff0c\u53ef\u4ee5\u5f97\u5230\u8fd9\u4e48\u4e00\u4e2a\u6a21\u578b\uff1a\n\n> \u7ed9\u5b9a\u4e00\u4e2a $01$ \u77e9\u9635\uff0c\u4f60\u53ef\u4ee5\u9009\u62e9\u4e00\u4e9b\u884c\uff0c\u4f7f\u5f97\u6700\u7ec8\u6bcf\u5217\u90fd\u6070\u597d\u6709\u4e00\u4e2a $1$\u3002 \u4e3e\u4e2a\u4f8b\u5b50\uff0c\u6211\u4eec\u5bf9\u4e0a\u6587\u4e2d\u7684\u4f8b\u5b50\u8fdb\u884c\u5efa\u6a21\uff0c\u53ef\u4ee5\u5f97\u5230\u8fd9\u4e48\u4e00\u4e2a\u77e9\u9635\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mjlhzi4y.png)\n\n> \u5176\u4e2d\u7b2c $i$ \u884c\u8868\u793a\u7740 $S_i$ \uff0c\u800c\u8fd9\u4e00\u884c\u7684\u6bcf\u4e2a\u6570\u4f9d\u6b21\u8868\u793a:\n> $[1 \\in S_i],[3 \\in S_i],[5 \\in S_i],\\cdots,[119 \\in S_i]$\u3002\n\n### \u66b4\u529b\u6c42\u89e3\n\n\u65b9\u6cd5 $1$\uff1a\u76f4\u63a5\u66b4\u529b\u679a\u4e3e\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(nm \\cdot 2^n)$\n\n```cpp\nint ok = 0;\nfor (int state = 0; state < 1 << n; ++state) {  // \u679a\u4e3e\u6bcf\u884c\u662f\u5426\u88ab\u9009\n  for (int i = 1; i <= n; ++i)\n    if ((1 << i - 1) & state)\n      for (int j = 1; j <= m; ++j) a[i][j] = 1;\n  int flag = 1;\n  for (int j = 1; j <= m; ++j)\n    for (int i = 1, bo = 0; i <= n; ++i)\n      if (a[i][j]) {\n        if (bo)\n          flag = 0;\n        else\n          bo = 1;\n      }\n  if (!flag)\n    continue;\n  else {\n    ok = 1;\n    for (int i = 1; i <= n; ++i)\n      if ((1 << i - 1) & state) printf(\"%d \", i);\n    puts(\"\");\n  }\n  memset(a, 0, sizeof(a));\n}\nif (!ok) puts(\"No solution.\");\n```\n\n\u65b9\u6cd5 $2$\uff1a\u4e8c\u8fdb\u5236\u4f18\u5316\u679a\u4e3e\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n \\cdot 2 ^ n)$\n\n```cpp\nint ok = 0;\nfor (int i = 1; i <= n; ++i)\n  for (int j = m; j >= 1; --j) num[i] = num[i] << 1 | a[i][j];\nfor (int state = 0; state < 1 << n; ++state) {\n  int tmp = 0;\n  for (int i = 1; i <= n; ++i)\n    if ((1 << i - 1) & state) {\n      if (tmp & num[i]) break;\n      tmp |= num[i];\n    }\n  if (tmp == (1 << m) - 1) {\n    ok = 1;\n    for (int i = 1; i <= n; ++i)\n      if ((1 << i - 1) & state) printf(\"%d \", i);\n    puts(\"\");\n  }\n}\nif (!ok) puts(\"No solution.\");\n```\n\n\n## Algorithm X\n\n### \u7b97\u6cd5\u8fc7\u7a0b\n\n1. \u5bf9\u4e8e\u73b0\u5728\u7684\u77e9\u9635 $M$ \uff0c\u9009\u62e9\u5e76\u6807\u8bb0\u4e00\u5217 $r$\uff0c\u5c06 $r$ \u6dfb\u52a0\u81f3 $S$ \u4e2d\uff1b\n2. \u5982\u679c\u5c1d\u8bd5\u4e86\u6240\u6709\u7684 $r$ \u5374\u65e0\u89e3\uff0c\u5219\u7b97\u6cd5\u7ed3\u675f\uff0c\u8f93\u51fa\u65e0\u89e3\uff1b\n3. \u6807\u8bb0\u4e0e $r$ \u76f8\u5173\u7684\u884c $r_i$ \u548c $c_i$\uff1b\n4. \u5220\u9664\u6240\u6709\u6807\u8bb0\u7684\u884c\u548c\u5217\uff0c\u5f97\u5230\u65b0\u77e9\u9635 $M'$\uff1b\n5. \u5982\u679c $M'$ \u4e3a\u7a7a\uff0c\u4e14 $r$ \u4e3a\u5168 $1$ \uff0c\u5219\u7b97\u6cd5\u7ed3\u675f\uff0c\u8f93\u51fa\u88ab\u5220\u9664\u7684\u884c\u7ec4\u6210\u7684\u96c6\u5408\uff1b\n\n\t\u5982\u679c $M'$ \u4e3a\u7a7a\uff0c\u4e14 $r$ \u4e0d\u5168\u4e3a $1$ \uff0c\u5219\u6062\u590d\u4e0e $r$ \u76f8\u5173\u7684\u884c $r_i$ \u4ee5\u53ca\u5217 $c_i$\uff0c\u8df3\u8f6c\u81f3\u6b65\u9aa4 $1$\uff1b\n\n\t\u5982\u679c $M'$  \u4e0d\u4e3a\u7a7a\uff0c\u5219\u8df3\u8f6c\u81f3\u6b65\u9aa4 $1$\u3002\t\n\n\u4e0d\u96be\u770b\u51fa\uff0cX \u7b97\u6cd5\u9700\u8981\u5927\u91cf\u7684\u201c\u5220\u9664\u884c\u201d\u3001\u201c\u5220\u9664\u5217\u201d\u548c\u201c\u6062\u590d\u884c\u201d\u3001\u201c\u6062\u590d\u5217\u201d\u7684\u64cd\u4f5c\u3002\n\nDonald E. Knuth \u60f3\u5230\u4e86\u7528\u53cc\u5411\u5341\u5b57\u94fe\u8868\u6765\u7ef4\u62a4\u8fd9\u4e9b\u64cd\u4f5c\u3002\n\n\u800c\u5728\u53cc\u5411\u5341\u5b57\u94fe\u8868\u4e0a\u4e0d\u65ad\u8df3\u8dc3\u7684\u8fc7\u7a0b\u88ab\u5f62\u8c61\u5730\u6bd4\u55bb\u6210\u201c\u8df3\u8dc3\u201d\uff0c\u56e0\u6b64\u88ab\u7528\u6765\u4f18\u5316 X \u7b97\u6cd5\u7684\u53cc\u5411\u5341\u5b57\u94fe\u8868\u4e5f\u88ab\u79f0\u4e3a \u201cDancing Links\u201d \u3002\n\n\u6240\u4ee5\u821e\u8e48\u94fe\u7b97\u6cd5\u540d\u4e3a Dancing Links X\uff08Dancing Links \u4f18\u5316 X \u7b97\u6cd5\uff09\n\n## Dancing Links X\n\n\u53cc\u5411\u5341\u5b57\u94fe\u8868\u4e2d\u5b58\u5728\u56db\u4e2a\u6307\u9488\u57df\uff0c\u5206\u522b\u6307\u5411\u4e0a\u3001\u4e0b\u3001\u5de6\u3001\u53f3\u7684\u5143\u7d20\uff1b\u4e14\u6bcf\u4e2a\u5143\u7d20  \u5728\u6574\u4e2a\u53cc\u5411\u5341\u5b57\u94fe\u8868\u7cfb\u4e2d\u90fd\u5bf9\u5e94\u7740\u4e00\u4e2a\u683c\u5b50\uff0c\u56e0\u6b64\u8fd8\u8981\u8868\u793a  \u6240\u5728\u7684\u5217\u548c\u6240\u5728\u7684\u884c\uff0c\u5982\u56fe\u6240\u793a\uff1a\n\n![](https://oi-wiki.org/search/images/dlx-1.png)\n\u56fe\u7247\u6765\u81ea\u4e8eOi-Wiki\n\n\u5927\u578b\u7684\u53cc\u5411\u94fe\u8868\u5219\u66f4\u4e3a\u590d\u6742\uff1a\n\n![](https://oi-wiki.org/search/images/dlx-2.png)\n\u56fe\u7247\u6765\u81ea\u4e8e Oi-Wiki\n\n### \u6240\u9700\u53d8\u91cf\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9\uff0c\u9700\u8981\u5de6\u6307\u9488\uff0c\u53f3\u6307\u9488\uff0c\u4e0a\u6307\u9488\uff0c\u4e0b\u6307\u9488\uff0c\u4ee5\u53ca\u8be5\u8282\u70b9\u7684\u884c\u5217\u4fe1\u606f\uff1b\n\n\n```cpp\nint N , M , Cnt; //\u77e9\u9635\u7684\u957f\uff0c\u5bbd\uff0c\u70b9\u7684\u6570\u91cf\n\nint Left[MAXN] , Right[MAXN] , Up[MAXN] , Down[MAXN]; //\u6bcf\u4e2a\u8282\u70b9\u7684\u5de6\u6307\u9488\uff0c\u53f3\u6307\u9488\uff0c\u4e0a\u6307\u9488\uff0c\u4e0b\u6307\u9488\n\nint Row[MAXN] , Cal[MAXN]; //\u884c\uff0c\u5217\u4fe1\u606f\u6307\u9488\n\nint Head[MAXN] , S[MAXN]; //\u6bcf\u884c\u7684\u5934\u7ed3\u70b9 , \u6bcf\u5217\u7684\u7ed3\u70b9\u6570\n\n```\n\n### InIt\n\n\u521d\u59cb\u5316\u7ed3\u679c(\u56fe\u7247\u6765\u6e90\u4e8e Oi-Wiki )\uff1a\n![](https://oi-wiki.org/search/images/dlx-5.png)\n\n\u663e\u7136\u7528\u7c7b\u4f3c\u4e8e\u53cc\u5411\u94fe\u8868\u7684\u65b9\u5f0f\u521d\u59cb\u5316\uff0c~~\u975e\u5e38\u7b80\u5355~~\n\n```cpp\nvoid InIt(int M) {\n\tfor(int i = 0; i <= M; i++) {\n\t\tRight[i] = i + 1;\n\t\tLeft[i] = i - 1;\n\t\tUp[i] = Down[i] = i;\n\t}\n\tRight[M] = 0; //M\u7684\u53f3\u4fa7\u662f0\n\tLeft[0] = M;  //0\u7684\u5de6\u4fa7\u662fM\n\tmemset(Head , -1 , sizeof Head);\n\tmemset(S , 0 , sizeof S);\n\tCnt = M + 1; //\u5f00\u59cb\u65f6\u6709M\u4e2a\u7ed3\u70b9\uff080\u7ed3\u70b9\u548c\u5404\u5217\u5934\u7ed3\u70b9\uff09\n}\n```\n\n### Links\n\n\u63d2\u5165\u64cd\u4f5c\u5206\u4e3a\u4e24\u79cd\u57fa\u672c\u60c5\u51b5\n\n+ \u5982\u679c\u7b2c $R$ \u884c\u6ca1\u6709\u5143\u7d20\uff0c\u90a3\u4e48\u76f4\u63a5\u63d2\u5165\u4e00\u4e2a\u5143\u7d20\uff0c\u5e76\u4f7f `Head[R]` \u6307\u5411\u8fd9\u4e2a\u5143\u7d20\u3002\n\u8fd9\u53ef\u4ee5\u901a\u8fc7 `Head[R] = Right[Cnt] = Left[Cnt] = Cnt;` \u6765\u5b9e\u73b0\u3002\n\n+ \u5982\u679c\u7b2c $R$ \u884c\u6709\u5143\u7d20\uff0c \u7528\u7c7b\u4f3c\u4e8e\u53cc\u5411\u94fe\u8868\u7684\u65b9\u5f0f\u5c06\u8be5\u70b9\u63d2\u5165\u5230 `Head[R]` \u7684\u6b63\u53f3\u65b9\n\n```cpp\nRight[Cnt] = Head[R];\nLeft[Cnt] = Left[Head[R]];\nRight[Left[Head[R]]] = Cnt;\nLeft[Head[R]] = Cnt;\n```\n\n\n\u6700\u540e\u7528\u7c7b\u4f3c\u4e8e\u53cc\u5411\u94fe\u8868\u7684\u65b9\u5f0f\u5c06\u8be5\u70b9\u63d2\u5165\u5230 $C$ \u7684\u6b63\u4e0b\u65b9\n```cpp\nUp[Cnt] = C; \nDown[Cnt] = Down[C];\nUp[Down[C]] = Cnt;\nDown[C] = Cnt;\n```\n\n\u56fe\u89e3(\u6765\u6e90\u4e8e Oi-Wiki )\uff1a\n\n![](https://oi-wiki.org/search/images/dlx-6.png)\n\n```cpp\nvoid Link(int R , int C) { //\u5728R\u884cC\u5217\u63d2\u5165\u70b9\n\tS[C]++; //C \u5217\u8282\u70b9\u591a\u4e861\u4e2a\n\tRow[Cnt] = R; //\u66f4\u65b0\u8be5\u8282\u70b9\u7684\u884c\u53f7\n\tCol[Cnt] = C; //\u66f4\u65b0\u8be5\u8282\u70b9\u7684\u5217\u6807\n\tUp[Cnt] = C; \n\tDown[Cnt] = Down[C];\n\tUp[Down[C]] = Cnt;\n\tDown[C] = Cnt;\n\tif(Head[R] == -1) { //\u8be5\u884c\u6ca1\u6709\u522b\u7684\u70b9,\u628a\u7b2c\u4e00\u4e2a\u52a0\u5165\u7684\u70b9\u4f5c\u4e3a\u8be5\u884c\u7684\u884c\u5934\u7ed3\u70b9\n\t\tHead[R] = Right[Cnt] = Left[Cnt] = Cnt;\n\t}\n\telse { \n\t\tRight[Cnt] = Head[R];\n\t\tLeft[Cnt] = Left[Head[R]];\n\t\tRight[Left[Head[R]]] = Cnt;\n\t\tLeft[Head[R]] = Cnt;\n\t}\n\t++Cnt;\n\treturn;\n}\n```\n\n### ReMove\n\n`ReMove(C)` \u8868\u793a\u5728 Dancing Links \u4e2d\u5220\u9664\u7b2c $C$ \u5217\u4ee5\u53ca\u4e0e\u5176\u76f8\u5173\u7684\u884c\u548c\u5217\u3002\n\n\u5148\u5c06 $C$ \u5220\u9664\uff0c\u6b64\u65f6\uff1a\n\n+ $C$ \u5de6\u4fa7\u7684\u7ed3\u70b9\u7684\u53f3\u7ed3\u70b9\u5e94\u4e3a $C$ \u7684\u53f3\u7ed3\u70b9\u3002\n+ $C$ \u53f3\u4fa7\u7684\u7ed3\u70b9\u7684\u5de6\u7ed3\u70b9\u5e94\u4e3a $C$ \u7684\u5de6\u7ed3\u70b9\u3002\n\n\u5373\u4e3a `Right[Left[C]] = Right[C],Left[Right[C]] = Left[C];`\n\n\u7136\u540e\u987a\u7740\u8fd9\u4e00\u5217\u5f80\u4e0b\u8d70\uff0c\u628a\u8d70\u8fc7\u7684\u6bcf\u4e00\u884c\u90fd\u5220\u6389\u3002\n\n\u5982\u4f55\u5220\u6389\u6bcf\u4e00\u884c\u5462\uff1f\u679a\u4e3e\u5f53\u524d\u884c\u7684\u6307\u9488 $j$ \uff0c\u6b64\u65f6\uff1a\n\n + $j$ \u4e0a\u65b9\u7684\u7ed3\u70b9\u7684\u4e0b\u7ed3\u70b9\u5e94\u4e3a $j$ \u7684\u4e0b\u7ed3\u70b9\u3002\n + $j$ \u4e0b\u65b9\u7684\u7ed3\u70b9\u7684\u4e0a\u7ed3\u70b9\u5e94\u4e3a $j $ \u7684\u4e0a\u7ed3\u70b9\u3002\n**\u6ce8\u610f\u8981\u4fee\u6539\u6bcf\u4e00\u5217\u7684\u5143\u7d20\u4e2a\u6570\u3002**\n\n\u5373 `Up[Down[j]] = Up[j],Down[Up[j]] = Down[j],S[Col[j]]--;`\u3002\n\n```cpp\nvoid ReMove(int C) {\n\tRight[Left[C]] = Right[C];\n\tLeft[Right[C]] = Left[C];\n\t//\u987a\u7740\u8fd9\u4e00\u5217\u4ece\u4e0a\u5f80\u4e0b\u904d\u5386\n\tfor(int i = Down[C]; i != C; i = Down[i]) {\n\t\t//\u987a\u7740\u8fd9\u4e00\u5217\u4ece\u5de6\u5f80\u53f3\u904d\u5386\n\t\tfor(int j = Right[i]; j != i; j = Right[j]) {\n\t\t\tUp[Down[j]] = Up[j];\n\t\t\tDown[Up[j]] = Down[j];\n\t\t\tS[Col[j]]--;\n\t\t}\n\t}\n}\n```\n\n### ReSume\n\n`ReSume` \u5c31\u662f\u9006\u7740\u8dd1\u4e00\u6b64 `ReMove` ,\u4e0d\u505a\u89e3\u91ca\n\n**\u6ce8\u610f\u64cd\u4f5c\u987a\u5e8f\u4e0e `ReMove` \u6b63\u597d\u76f8\u53cd**\n\n```cpp\nvoid ReSume(int C) {\n\tfor(int i = Up[C]; i != C; i = Up[i]) {\n\t\tfor(int j = Left[i]; j != i; j = Left[j]) {\n\t\t\tUp[Down[j]] = j;\n\t\t\tDown[Up[j]] = j;\n\t\t\tS[Col[j]]++;\n\t\t}\n\t}\n\tRight[Left[C]] = C;\n\tLeft[Right[C]] = C;\n}\n```\n\n### Dance\n\n`dance()` \u5373\u4e3a\u9012\u5f52\u5730\u5220\u9664\u4ee5\u53ca\u8fd8\u539f\u5404\u4e2a\u884c\u5217\u7684\u8fc7\u7a0b\u3002\n\n+ \u5982\u679c $0$ \u53f7\u7ed3\u70b9\u6ca1\u6709\u53f3\u7ed3\u70b9\uff0c\u90a3\u4e48\u77e9\u9635\u4e3a\u7a7a\uff0c\u8bb0\u5f55\u7b54\u6848\u5e76\u8fd4\u56de\uff1b\n+ \u9009\u62e9\u5217\u5143\u7d20\u4e2a\u6570\u6700\u5c11\u7684\u4e00\u5217\uff0c\u5e76\u5220\u6389\u8fd9\u4e00\u5217\uff1b\n+ \u904d\u5386\u8fd9\u4e00\u5217\u6240\u6709\u6709 $1$ \u7684\u884c\uff0c\u679a\u4e3e\u5b83\u662f\u5426\u88ab\u9009\u62e9\uff1b\n+ \u9012\u5f52\u8c03\u7528 `dance()`\uff0c\u5982\u679c\u53ef\u884c\uff0c\u5219\u8fd4\u56de\uff1b\u5982\u679c\u4e0d\u53ef\u884c\uff0c\u5219\u6062\u590d\u88ab\u9009\u62e9\u7684\u884c\uff1b\u5982\u679c\u65e0\u89e3\uff0c\u5219\u8fd4\u56de\u3002\n\n```cpp\nbool Dance(int Dep) {\n\tif(Right[0] == 0) {\n\t\tfor(int i = 0; i < Dep; i++)\n\t\t\tcout << Ans[i] << \" \";\n\t\treturn 1;\n\t}\n\tint C = Right[0];\n\tint i , j;\n\tfor(i = Right[0]; i != 0; i = Right[i]) if(S[i] < S[C]) C = i;\n\tReMove(C);\n\tfor(i = Down[C]; i != C; i = Down[i]) {\n\t\tAns[Dep] = Row[i];\n\t\tfor(j = Right[i]; j != i; j = Right[j]) ReMove(Col[j]);\n\t\tif(Dance(Dep + 1)) return 1;\n\t\tfor(int j = Left[i]; j != i; j = Left[j]) ReSume(Col[j]);\n\t}\n\tReSume(C);\n\treturn 0;\n}\n```\n\n\u6ce8\u610f\u6211\u4eec\u6bcf\u6b21\u4f18\u5148\u9009\u62e9\u5217\u5143\u7d20\u4e2a\u6570\u6700\u5c11\u7684\u4e00\u5217\u8fdb\u884c\u5220\u9664\uff0c\u8fd9\u6837\u80fd\u4fdd\u8bc1\u7a0b\u5e8f\u5177\u6709\u4e00\u5b9a\u7684\u542f\u53d1\u6027\uff0c\u4f7f\u641c\u7d22\u6811\u5206\u652f\u6700\u5c11\u3002\n\n**\u65f6\u95f4\u590d\u6742\u5ea6**\n\nDLX \u9012\u5f52\u53ca\u56de\u6eaf\u7684\u6b21\u6570\u4e0e\u77e9\u9635\u4e2d $1$ \u7684\u4e2a\u6570\u6709\u5173\uff0c\u4e0e\u77e9\u9635\u7684 $r , c$ \u7b49\u53c2\u6570\u65e0\u5173\u3002\u56e0\u6b64\uff0c\u5b83\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f **\u6307\u6570\u7ea7** \u7684\uff0c\u7406\u8bba\u590d\u6742\u5ea6\u5927\u6982\u5728 $O(c^n)$ \u5de6\u53f3\uff0c\u5176\u4e2d $c$ \u4e3a\u67d0\u4e2a\u975e\u5e38\u63a5\u8fd1\u4e8e $1$ \u7684\u5e38\u6570\uff0c$n$ \u4e3a\u77e9\u9635\u4e2d $1$ \u7684\u4e2a\u6570\u3002\n\n\u7684\u4e2a\u6570\u3002\n\n\u4f46\u5b9e\u9645\u60c5\u51b5\u4e0b DLX \u8868\u73b0\u826f\u597d\uff0c\u4e00\u822c\u80fd\u89e3\u51b3\u5927\u90e8\u5206\u7684\u95ee\u9898\n\n## \u4f8b\u9898\u8bb2\u89e3\n\n### \u3010\u6a21\u677f\u3011\u821e\u8e48\u94fe\uff08DLX\uff09\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4929)\n\n#### \u601d\u8def\n\n\u76f4\u63a5\u4f7f\u7528 DLX \u7b97\u6cd5\uff0c\u65e0\u6280\u672f\u542b\u91cf\n\n#### \u53c2\u8003\u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst int MAXN = 250100;\n\nint N , M;\nint Cnt;\nint Left[MAXN] , Right[MAXN] , Up[MAXN] , Down[MAXN] , Col[MAXN] , Row[MAXN];\n\nint Head[MAXN];\n\nint S[MAXN];\n\nint Ans[MAXN];\n\nvoid InIt(int M) {\n\tfor(int i = 0; i <= M; i++) {\n\t\tRight[i] = i + 1;\n\t\tLeft[i] = i - 1;\n\t\tUp[i] = Down[i] = i;\n\t}\n\tRight[M] = 0;\n\tLeft[0] = M;\n\tmemset(Head , -1 , sizeof Head);\n\tmemset(S , 0 , sizeof S);\n\tCnt = M + 1;\n}\n\nvoid Link(int R , int C) {\n\tS[C]++;\n\tRow[Cnt] = R;\n\tCol[Cnt] = C;\n\tUp[Cnt] = C;\n\tDown[Cnt] = Down[C];\n\tUp[Down[C]] = Cnt;\n\tDown[C] = Cnt;\n\tif(Head[R] == -1) {\n\t\tHead[R] = Right[Cnt] = Left[Cnt] = Cnt;\n\t}\n\telse {\n\t\tRight[Cnt] = Head[R];\n\t\tLeft[Cnt] = Left[Head[R]];\n\t\tRight[Left[Head[R]]] = Cnt;\n\t\tLeft[Head[R]] = Cnt;\n\t}\n\t++Cnt;\n\treturn;\n}\n\nvoid ReMove(int C) {\n\tRight[Left[C]] = Right[C];\n\tLeft[Right[C]] = Left[C];\n\tfor(int i = Down[C]; i != C; i = Down[i]) {\n\t\tfor(int j = Right[i]; j != i; j = Right[j]) {\n\t\t\tUp[Down[j]] = Up[j];\n\t\t\tDown[Up[j]] = Down[j];\n\t\t\tS[Col[j]]--;\n\t\t}\n\t}\n}\n\nvoid ReSume(int C) {\n\tfor(int i = Up[C]; i != C; i = Up[i]) {\n\t\tfor(int j = Left[i]; j != i; j = Left[j]) {\n\t\t\tUp[Down[j]] = j;\n\t\t\tDown[Up[j]] = j;\n\t\t\tS[Col[j]]++;\n\t\t}\n\t}\n\tRight[Left[C]] = C;\n\tLeft[Right[C]] = C;\n}\n\nbool Dance(int Dep) {\n\tif(Right[0] == 0) {\n\t\tfor(int i = 0; i < Dep; i++)\n\t\t\tcout << Ans[i] << \" \";\n\t\treturn 1;\n\t}\n\tint C = Right[0];\n\tint i , j;\n\tfor(i = Right[0]; i != 0; i = Right[i]) if(S[i] < S[C]) C = i;\n\tReMove(C);\n\tfor(i = Down[C]; i != C; i = Down[i]) {\n\t\tAns[Dep] = Row[i];\n\t\tfor(j = Right[i]; j != i; j = Right[j]) ReMove(Col[j]);\n\t\tif(Dance(Dep + 1)) return 1;\n\t\tfor(int j = Left[i]; j != i; j = Left[j]) ReSume(Col[j]);\n\t}\n\tReSume(C);\n\treturn 0;\n}\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin >> N >> M;\n\tint f;\n\tInIt(M);\n\t\n\tfor(int i = 1; i <= N; i++) {\n\t\tfor(int j = 1; j <= M; j++) {\n\t\t\tcin >> f;\n\t\t\tif(f) Link(i , j);\n\t\t}\n\t}\n\tif(!Dance(0)) cout << \"No Solution!\" << endl;\n\t\n\treturn 0;\n}\n```\n----\n### [USACO1.5]\u516b\u7687\u540e Checker Challenge\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P1219)\n\n#### \u601d\u8def\n\n\u5bf9\u4e8e\u516b\u7687\u540e\u95ee\u9898\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u8f6c\u5316\u4e3a\u7cbe\u786e\u8986\u76d6\u7684\u95ee\u9898\uff1a\n\n+ \u6bcf\u884c\u53ea\u80fd\u653e\u4e00\u4e2a\u7687\u540e\n+ \u6bcf\u5217\u53ea\u80fd\u653e\u4e00\u4e2a\u7687\u540e\n+ \u6bcf\u4e00\u4e2a\u201c/\u201d\u659c\u884c\u53ea\u80fd\u653e\u4e00\u4e2a\u7687\u540e\n+ \u6bcf\u4e00\u4e2a\u201c\\\u201d\u659c\u884c\u53ea\u80fd\u653e\u4e00\u4e2a\u7687\u540e\n+ \u6211\u4eec\u628a\u6bcf\u4e2a\u72b6\u6001\u5f53\u6210\u5217\uff0c\u6bcf\u4e2a\u70b9\u5f53\u6210\u4e00\u884c \u7136\u540e\u7cbe\u786e\u8986\u76d6\u8fd9\u4e2a\u77e9\u9635\n\n**\u6ce8\u610f\uff1a\u4e0e\u6a21\u7248\u4e0d\u540c\u7684\u662f\u6211\u4eec\u53ea\u9700\u4fdd\u8bc1\u6bcf\u884c\u6bcf\u5217\u5b8c\u5168\u8986\u76d6\u800c\u6bcf\u4e00\u659c\u884c\u662f\u80af\u5b9a\u4e0d\u80fd\u5b8c\u5168\u8986\u76d6\u7684\uff08\u56e0\u4e3a\u4e00\u5171 $2n-1$ \u4e2a\u659c\u884c\uff09**\n\n#### \u53c2\u8003\u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst int MAXN = 100100;\n\nlong long ToT;\n\nint N;\nint Cnt;\nint Left[MAXN] , Right[MAXN] , Up[MAXN] , Down[MAXN] , Col[MAXN] , Row[MAXN];\n\nint Head[MAXN];\n\nint S[MAXN];\n\nint Ans[MAXN];\n\nstruct Node {\n    int ans[14];\n}SS[100000];\n\n\nvoid InIt(int M) {\n\tfor(int i = 0; i <= M; i++) {\n\t\tRight[i] = i + 1;\n\t\tLeft[i] = i - 1;\n\t\tUp[i] = Down[i] = i;\n\t}\n\tRight[M] = 0;\n\tLeft[0] = M;\n\tmemset(Head , -1 , sizeof Head);\n\tmemset(S , 0 , sizeof S);\n\tCnt = M + 1;\n}\n\nvoid Link(int R , int C) { // Add (R , C)\n\tS[C]++;\n\tRow[Cnt] = R;\n\tCol[Cnt] = C;\n\tUp[Cnt] = C;\n\tDown[Cnt] = Down[C];\n\tUp[Down[C]] = Cnt;\n\tDown[C] = Cnt;\n\tif(Head[R] < 0) {\n\t\tHead[R] = Right[Cnt] = Left[Cnt] = Cnt;\n\t}\n\telse {\n\t\tRight[Cnt] = Head[R];\n\t\tLeft[Cnt] = Left[Head[R]];\n\t\tRight[Left[Head[R]]] = Cnt;\n\t\tLeft[Head[R]] = Cnt;\n\t}\n\t++Cnt;\n\treturn;\n}\n\nvoid ReMove(int C) {\n\tRight[Left[C]] = Right[C];\n\tLeft[Right[C]] = Left[C];\n\tfor(int i = Down[C]; i != C; i = Down[i]) {\n\t\tfor(int j = Right[i]; j != i; j = Right[j]) {\n\t\t\tUp[Down[j]] = Up[j];\n\t\t\tDown[Up[j]] = Down[j];\n\t\t\tS[Col[j]]--;\n\t\t}\n\t}\n}\n\nvoid ReSume(int C) {\n\tfor(int i = Up[C]; i != C; i = Up[i]) {\n\t\tfor(int j = Left[i]; j != i; j = Left[j]) {\n\t\t\tUp[Down[j]] = j;\n\t\t\tDown[Up[j]] = j;\n\t\t\tS[Col[j]]++;\n\t\t}\n\t}\n\tRight[Left[C]] = C;\n\tLeft[Right[C]] = C;\n}\n\nvoid Dance(int Dep) {\n\tif(Right[0] > N) {\n        ++ToT;\n\t\tfor(int i = 0 , x , y; i < Dep; i++) {\n            x = Ans[i] % N;\n            y = (Ans[i] - 1) / N + 1;\n            if(x == 0) x = N;\n            SS[ToT].ans[x] = y;\n        }\n\t\treturn;\n\t}\n\tint C = Right[0];\n\tint i , j;\n\tfor(i = Right[0]; i <= N ; i = Right[i]) \n        if(S[i] < S[C]) C = i;\n\tReMove(C);\n\tfor(i = Down[C]; i != C; i = Down[i]) {\n\t\tAns[Dep] = Row[i];\n\t\tfor(j = Right[i]; j != i; j = Right[j]) ReMove(Col[j]);\n\t\tDance(Dep + 1);\n\t\tfor(j = Left[i]; j != i; j = Left[j]) ReSume(Col[j]);\n\t}\n\tReSume(C);\n\treturn;\n}\n\nbool Cmp(Node a , Node b) {\n    int i = 1;\n    while(a.ans[i] == b.ans[i] && i <= N)\n        ++i;\n    return a.ans[i] < b.ans[i];\n}\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin >> N ;\n\tint f = 0;\n\tInIt(6 * N - 2);\n\t//\u4e00\u5171n*n\u683c\u5bf9\u5e94n*n\u884c\n\t//\u5bf9\u4e8e\u7b2cm\u5217\n\t//\u82e5[1,n]\u5bf9\u5e94\u5728\u7b2cm\u884c\u653e\u7687\u540e \n\t//\u82e5[n+1,2*n]\u5bf9\u5e94\u5728\u7b2cm-n\u5217\u653e\u7687\u540e \n\t//\u82e5[2*n+1,4*n-1]\u5bf9\u5e94\u5728\u7b2cm-2*n\u201c\\\u201d\u659c\u884c\u653e\u7687\u540e \uff08\u51712*n-1\u4e2a\u201c\\\u201d\u659c\u884c\uff09 \n\t//\u82e5[4*n,6*n-2]\u5bf9\u5e94\u5728\u7b2cm-4*n+1\u201c/\u201d\u659c\u884c\u653e\u7687\u540e\uff08\u51712*n-1\u4e2a\u201c/\u201d\u659c\u884c\uff09 \n\tfor(int i = 1; i <= N; i++) {\n\t\tfor(int j = 1; j <= N; j++) {\n\t\t\t++f;\n            Link(f , i);\n            Link(f , j + N);\n            Link(f , i - j + 3 * N);\n            Link(f , i + j + 4 * N - 2);\n\t\t}\n\t}\n\t\n    Dance(0);\n\n    sort(SS + 1 , SS + 1 + ToT , Cmp); \n\n    for(int i = 1; i <= 3; i++){\n\t\tfor(int j = 1; j <= N; j++)\n            cout << SS[i].ans[j] << \" \";\n        cout << endl;\n\t}\n\n    cout << ToT << endl;\n\t\n\treturn 0;\n}\n```\n----\n\n### \u6570\u72ec\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/solution/P1784)\n\n#### \u601d\u8def\n\n\u5bf9\u4e8e\u6c42\u89e3\u6570\u72ec\u53ef\u4ee5\u628a\u5b83\u8f6c\u5316\u4e3a\u7cbe\u786e\u8986\u76d6\u7684\u95ee\u9898\uff1a\n\n+ \u6bcf\u4e2a\u70b9\u53ea\u80fd\u586b\u4e00\u4e2a\u6570\n+ \u6bcf\u4e2a\u884c\u53ea\u80fd\u586b\u6bcf\u79cd\u6570\u5404\u4e00\u4e2a\n+ \u6bcf\u4e2a\u5217\u53ea\u80fd\u586b\u6bcf\u79cd\u6570\u5404\u4e00\u4e2a\n+ \u6bcf\u4e2a\u5bab\u53ea\u80fd\u586b\u6bcf\u79cd\u6570\u5404\u4e00\u4e2a\n\n**\u4e8e\u662f\u6211\u4eec\u628a\u70b9\u5bf9\u5e94\u6210\u4e00\u4e2a\u96c6\u5408\uff0c\u5305\u542b $4$ \u4e2a\u5143\u7d20\uff0c\u5206\u522b\u8868\u793a\u5bf9\u5e94\u7684\u6570\uff0c\u884c\uff0c\u5217\uff0c\u5bab\u3002\u7136\u540e\u7cbe\u786e\u8986\u76d6\u5373\u53ef\u3002**\n\n#### \u53c2\u8003\u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst int MAXN = 250100;\n\ninline int read() {\n\tint ret = 0;\n\tchar c = getchar();\n\twhile(c > '9' || c < '0') c = getchar();\n\twhile(c >= '0' && c <= '9') {\n\t\tret = (ret << 3) + (ret << 1) + c - 48;\n\t\tc = getchar();\n\t}\n\treturn ret;\n}\n\nint N , M;\nint Cnt;\nint Left[MAXN] , Right[MAXN] , Up[MAXN] , Down[MAXN] , Col[MAXN] , Row[MAXN];\n\nint Head[MAXN];\n\nint S[MAXN];\n\nint Ans[MAXN];\n\nint Num[10][10];\n\nvoid InIt(int M) {\n\tfor(int i = 0; i <= M; i++) {\n\t\tRight[i] = i + 1;\n\t\tLeft[i] = i - 1;\n\t\tUp[i] = Down[i] = i;\n\t}\n\tRight[M] = 0;\n\tLeft[0] = M;\n\tmemset(Head , -1 , sizeof Head);\n\tmemset(S , 0 , sizeof S);\n\tCnt = M + 1;\n}\n\nvoid Link(int R , int C) { // Add (R , C)\n\tS[C]++;\n\tRow[Cnt] = R;\n\tCol[Cnt] = C;\n\tUp[Cnt] = C;\n\tDown[Cnt] = Down[C];\n\tUp[Down[C]] = Cnt;\n\tDown[C] = Cnt;\n\tif(Head[R] == -1) {\n\t\tHead[R] = Right[Cnt] = Left[Cnt] = Cnt;\n\t}\n\telse {\n\t\tRight[Cnt] = Head[R];\n\t\tLeft[Cnt] = Left[Head[R]];\n\t\tRight[Left[Head[R]]] = Cnt;\n\t\tLeft[Head[R]] = Cnt;\n\t}\n\t++Cnt;\n\treturn;\n}\n\nvoid ReMove(int C) {\n\tRight[Left[C]] = Right[C];\n\tLeft[Right[C]] = Left[C];\n\tfor(int i = Down[C]; i != C; i = Down[i]) {\n\t\tfor(int j = Right[i]; j != i; j = Right[j]) {\n\t\t\tUp[Down[j]] = Up[j];\n\t\t\tDown[Up[j]] = Down[j];\n\t\t\tS[Col[j]]--;\n\t\t}\n\t}\n}\n\nvoid ReSume(int C) {\n\tfor(int i = Up[C]; i != C; i = Up[i]) {\n\t\tfor(int j = Left[i]; j != i; j = Left[j]) {\n\t\t\tUp[Down[j]] = j;\n\t\t\tDown[Up[j]] = j;\n\t\t\tS[Col[j]]++;\n\t\t}\n\t}\n\tRight[Left[C]] = C;\n\tLeft[Right[C]] = C;\n}\n\nbool Dance(int Dep) {\n\tif(Right[0] == 0) {\n\t\tfor(int i = 0 , x , y , v; i < Dep; i++) {\n            x = (Ans[i] - 1) / 9 / 9;\n            y = (Ans[i] - 1) / 9 % 9;\n            v = (Ans[i]) % 9;\n            if(v == 0) v = 9;\n            Num[x][y] = v;\n        }\n        return 1;\n\t}\n\tint C = Right[0];\n\tint i , j;\n\tfor(i = Right[0]; i != 0; i = Right[i]) if(S[i] < S[C]) C = i;\n\tReMove(C);\n\tfor(i = Down[C]; i != C; i = Down[i]) {\n\t\tAns[Dep] = Row[i];\n\t\tfor(j = Right[i]; j != i; j = Right[j]) ReMove(Col[j]);\n\t\tif(Dance(Dep + 1)) return 1;\n\t\tfor(int j = Left[i]; j != i; j = Left[j]) ReSume(Col[j]);\n\t}\n\tReSume(C);\n\treturn 0;\n}\n\nint main() {\n\tios::sync_with_stdio(false);\n\tN = 729;\n    \tM = 324;\n\tInIt(M);\n\t\n    \tfor (int i = 0 , x , o; i < 9; i++) {\n        \tfor(int j = 0; j < 9; j++) {\n            \t\tcin >> Num[i][j];\n            \t\tx = Num[i][j];\n            \t\tfor(int k = 1; k <= 9; k++) {\n                \t\tif(x != k && x != 0) continue;\n                \t\tLink(i * 9 * 9 + j * 9 + k , i * 9 + j + 1);\n                \t\tLink(i * 9 * 9 + j * 9 + k , i * 9 + 81 + k);\n                \t\tLink(i * 9 * 9 + j * 9 + k , j * 9 + 81 * 2 + k);\n                \t\tLink(i * 9 * 9 + j * 9 + k , 81 * 3 + (i / 3 * 3 + j / 3) * 9 + k);\n            \t\t}\n        \t}\n    \t}\n    \n   \t Dance(0);\n\n    \tfor(int i = 0; i < 9; i++) {\n        \tfor(int j = 0; j < 9; j++)\n            \tcout << Num[i][j] << \" \";\n        \tcout << endl;\n    \t}\n\treturn 0;\n}\n```\n\n### [NOIP2009 \u63d0\u9ad8\u7ec4] \u9776\u5f62\u6570\u72ec\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P1074)\n\n#### \u601d\u8def\n\u9996\u5148\uff0c\u8981\u5c06\u6570\u72ec\u95ee\u9898\u8f6c\u5316\u4e3a\u4e00\u4e2a\u7cbe\u786e\u8986\u76d6\u95ee\u9898\u3002\n\n\u4e8e\u662f\u6211\u4eec\u91cd\u65b0\u5efa\u7acb\u4e00\u4e2a $(N \\times N \\times N)$ \u77e9\u9635\u3002\n\n+ \u7531\u4e8e\u6bcf\u4e2a\u683c\u5b50\u53ea\u80fd\u586b\u4e00\u4e2a\u6570\uff0c\u7528 $1 \\sim 81$ \u5217\u8868\u793a\u6bcf\u4e00\u4e2a\u662f\u5426\u586b\u6570\n\n+ \u7531\u4e8e\u6bcf\u4e2a\u6570\u5728\u6bcf\u4e00\u5217\u53ea\u80fd\u51fa\u73b0\u4e00\u6b21\uff0c\u7528 $82 \\sim 162$ \u5217\u8868\u793a\u662f\u5426\u6ee1\u8db3\u8fd9\u4e2a\u6761\u4ef6\n\n+ \u884c\u548c\u5bab\u7684\u65b9\u6cd5\u662f\u4e00\u6837\u7684\n\n\u63a5\u7740\uff0c\u679a\u4e3e\u6bcf\u4e2a\u683c\u5b50\u7684\u65b9\u6848\uff0c\u5c06\u8fd9\u4e9b\u65b9\u6848\u5728\u65b0\u7684\u77e9\u9635\u4e2d\u6240\u80fd\u8986\u76d6\u7684\u683c\u5b50\u7528\u4e8c\u7ef4\u94fe\u8868\u8fde\u8d77\u6765\u3002\n\n#### \u53c2\u8003\u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst int MAXN = 250100;\n\ninline int read() {\n\tint ret = 0;\n\tchar c = getchar();\n\twhile(c > '9' || c < '0') c = getchar();\n\twhile(c >= '0' && c <= '9') {\n\t\tret = (ret << 3) + (ret << 1) + c - 48;\n\t\tc = getchar();\n\t}\n\treturn ret;\n}\n\nint N , M;\nint Cnt;\nint Left[MAXN] , Right[MAXN] , Up[MAXN] , Down[MAXN] , Col[MAXN] , Row[MAXN];\n\nint Head[MAXN];\n\nint S[MAXN];\n\nint Ans[MAXN];\n\nlong long Sum;\n\nint Value[9][9]={\n    {6 , 6 , 6 , 6 , 6 , 6 , 6 , 6 , 6} , \n    {6 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 6} , \n    {6 , 7 , 8 , 8 , 8 , 8 , 8 , 7 , 6} , \n    {6 , 7 , 8 , 9 , 9 , 9 , 8 , 7 , 6} , \n    {6 , 7 , 8 , 9 , 10 , 9 , 8 , 7 , 6} , \n    {6 , 7 , 8 , 9 , 9 , 9 , 8 , 7 , 6} , \n    {6 , 7 , 8 , 8 , 8 , 8 , 8 , 7 , 6} , \n    {6 , 7 , 7 , 7 , 7 , 7 , 7 , 7 , 6} , \n    {6 , 6 , 6 , 6 , 6 , 6 , 6 , 6 , 6}\n};\n\nvoid InIt(int M) {\n\tfor(int i = 0; i <= M; i++) {\n\t\tRight[i] = i + 1;\n\t\tLeft[i] = i - 1;\n\t\tUp[i] = Down[i] = i;\n\t}\n\tRight[M] = 0;\n\tLeft[0] = M;\n\tmemset(Head , -1 , sizeof Head);\n\tmemset(S , 0 , sizeof S);\n\tCnt = M + 1;\n}\n\nvoid Link(int R , int C) { // Add (R , C)\n\tS[C]++;\n\tRow[Cnt] = R;\n\tCol[Cnt] = C;\n\tUp[Cnt] = C;\n\tDown[Cnt] = Down[C];\n\tUp[Down[C]] = Cnt;\n\tDown[C] = Cnt;\n\tif(Head[R] == -1) {\n\t\tHead[R] = Right[Cnt] = Left[Cnt] = Cnt;\n\t}\n\telse {\n\t\tRight[Cnt] = Head[R];\n\t\tLeft[Cnt] = Left[Head[R]];\n\t\tRight[Left[Head[R]]] = Cnt;\n\t\tLeft[Head[R]] = Cnt;\n\t}\n\t++Cnt;\n\treturn;\n}\n\nvoid ReMove(int C) {\n\tRight[Left[C]] = Right[C];\n\tLeft[Right[C]] = Left[C];\n\tfor(int i = Down[C]; i != C; i = Down[i]) {\n\t\tfor(int j = Right[i]; j != i; j = Right[j]) {\n\t\t\tUp[Down[j]] = Up[j];\n\t\t\tDown[Up[j]] = Down[j];\n\t\t\tS[Col[j]]--;\n\t\t}\n\t}\n}\n\nvoid ReSume(int C) {\n\tfor(int i = Up[C]; i != C; i = Up[i]) {\n\t\tfor(int j = Left[i]; j != i; j = Left[j]) {\n\t\t\tUp[Down[j]] = j;\n\t\t\tDown[Up[j]] = j;\n\t\t\tS[Col[j]]++;\n\t\t}\n\t}\n\tRight[Left[C]] = C;\n\tLeft[Right[C]] = C;\n}\n\nvoid Dance(int Dep) {\n\tif(Right[0] == 0) {\n        long long sum = 0;\n\t\tfor(int i = 0 , x , y , v; i < Dep; i++) {\n            x = (Ans[i] - 1) / 9 / 9;\n            y = (Ans[i] - 1) / 9 % 9;\n            v = (Ans[i] - 1) % 9;\n            sum += Value[x][y] * (v + 1);\n        }\n        Sum = max(Sum , sum);\n        return;\n\t}\n\tint C = Right[0];\n\tint i , j;\n\tfor(i = Right[0]; i != 0; i = Right[i]) if(S[i] < S[C]) C = i;\n\tReMove(C);\n\tfor(i = Down[C]; i != C; i = Down[i]) {\n\t\tAns[Dep] = Row[i];\n\t\tfor(j = Right[i]; j != i; j = Right[j]) ReMove(Col[j]);\n\t\tDance(Dep + 1);\n\t\tfor(int j = Left[i]; j != i; j = Left[j]) ReSume(Col[j]);\n\t}\n\tReSume(C);\n\treturn;\n}\n\nint main() {\n\tios::sync_with_stdio(false);\n\tN = 729;\n    \tM = 324;\n\tInIt(M);\n\t\n    \tfor (int i = 0 , x; i < 9; i++) {\n        \tfor(int j = 0; j < 9; j++) {\n            \t\tcin >> x;\n            \t\tfor(int k = 1; k <= 9; k++) {\n                \t\tif(x != k && x != 0) continue;\n                \t\tLink(i * 9 * 9 + j * 9 + k , i * 9 + j + 1);\n                \t\tLink(i * 9 * 9 + j * 9 + k , i * 9 + 81 + k);\n                \t\tLink(i * 9 * 9 + j * 9 + k , j * 9 + 81 * 2 + k);\n                \t\tLink(i * 9 * 9 + j * 9 + k , 81 * 3 + (i / 3 * 3 + j / 3) * 9 + k);\n            \t\t}\n        \t}\n    \t}\n    \n    \tDance(0);\n\n    \tif(Sum != 0) cout << Sum << endl;\n    \telse cout << -1 << endl;\n\t\n\treturn 0;\n}\n```",
        "postTime": 1636619792,
        "uid": 461426,
        "name": "CmsMartin",
        "ccfLevel": 6,
        "title": "DLX"
    },
    {
        "content": "## \u95ee\u9898\u63d0\u51fa\n\u7ed9\u5b9a $N$ \u4e2a\u5f85\u9009\u96c6\u5408 $S_1,S_2,\\cdots,S_{N-1},S_N$ \u4e0e\u4e00\u4e2a\u76ee\u6807\u96c6\u5408 $X$\uff0c\u6c42\u51fa\u4e00\u4e2a\u96c6\u5408 $P$ \u4f7f\u5f97\uff1a\n\n$$\\bigcup_{i\\in P}S_i=X$$\n\n\n\u8bb0\u4e3a\u6027\u8d28 $1$\uff0c\u4e14\uff1a\n\n$$S_i \\cap S_j=\\varnothing(i,j\\in P,i\\ne j)$$\n\n\u8bb0\u4e3a\u6027\u8d28 $2$\uff0c\u8fd9\u5c31\u662f\u7cbe\u786e\u8986\u76d6\u95ee\u9898\u3002\n## \u95ee\u9898\u8f6c\u5316\n\u540c [Luogu P4929 \u3010\u6a21\u677f\u3011\u821e\u8e48\u94fe\uff08DLX\uff09](https://www.luogu.com.cn/problem/P4929) \u7684\u53d9\u8ff0\uff0c\u82e5\u628a\u96c6\u5408\u4e2d\u7684\u5143\u7d20\u5316\u4e3a\u4e00\u4e2a $N$ \u884c $M$ \u5217\u7684 01 \u77e9\u9635\uff0c\u90a3\u95ee\u9898\u5373\u53ef\u8f6c\u6362\u4e3a\uff1a\n\n\u9009\u51fa\u77e9\u9635\u4e2d\u7684\u82e5\u5e72\u884c\uff0c\u4f7f\u6bcf\u4e00\u5217\u4e0a\u6709\u4e14\u4ec5\u6709\u4e00\u884c\u4e2d\u4f4d\u4e0a\u7684\u5143\u7d20\u4e3a $1$\u3002\n\n## \u7b97\u6cd5\u5f15\u5165\n\n\u5bf9\u4e8e\u8fd9\u6837\u4e00\u4e2a\u77e9\u9635\uff0c\u96c6\u5408 $P$ \u4e3a\u5df2\u9009\u7684\u884c\u96c6\uff1a\n\n\n$$\\begin{pmatrix}\n        0&0&1&0&1&1&0\\\\\n        1&1&0&0&0&0&0\\\\\n        1&0&1&0&0&1&0\\\\\n        1&1&1&0&1&0&1\\\\\n        0 &0&0&1&0&0&1\n        \\end{pmatrix}$$\n\n$$ P =\\varnothing$$\n\n\u8981\u662f\u5148\u9009\u62e9\u7b2c\u4e00\u884c\uff0c\u6211\u4eec\u628a\u7b2c\u4e00\u884c\u6d82\u4e0a\u7ea2\u8272:\n\n$$\\begin{pmatrix}\n        \\color{red}0&\\color{red}0&\\color{red}1&\\color{red}0&\\color{red}1&\\color{red}1&\\color{red}0\\\\\n        1&1&0&0&0&0&0\\\\\n        1&0&1&0&0&1&0\\\\\n        1&1&1&0&1&0&1\\\\\n        0 &0&0&1&0&0&1\n        \\end{pmatrix}$$\n\n$$P=\\{1\\} $$\n\n\u7531\u6027\u8d28 $2$ \u5f97\uff1a\u4f7f\u6bcf\u4e00\u5217\u4e0a\u6709\u4e14\u4ec5\u6709\u4e00\u884c\u4e2d\u4f4d\u4e0a\u7684\u5143\u7d20\u4e3a $1$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u628a\u7b2c\u4e00\u884c\u4f4d\u4e0a\u4e3a $1$ \u7684\u5217\u90fd\u6807\u8bb0\u4e3a\u7ea2\u8272\uff1a\n\n$$\\begin{pmatrix}\n        \\color{red}0&\\color{red}0&\\color{red}1&\\color{red}0&\\color{red}1&\\color{red}1&\\color{red}0\\\\\n        1&1&\\color{red}0&0&\\color{red}0&\\color{red}0&0\\\\\n        1&0&\\color{red}1&0&\\color{red}0&\\color{red}1&0\\\\\n        1&1&\\color{red}1&0&\\color{red}1&\\color{red}0&1\\\\\n        0 &0&\\color{red}0&1&\\color{red}0&\\color{red}0&1\n        \\end{pmatrix}$$\n\n$$P=\\{1\\} $$\n\n\u90a3\u4e48\u8fd9\u4e9b\u5217\u4e0a\u542b\u6709 $1$ \u7684\u884c\u6211\u4eec\u662f\u7edd\u5bf9\u4e0d\u80fd\u9009\u7684\uff0c\u8fd9\u4e9b\u884c\u4e5f\u6807\u8bb0\u4e3a\u7ea2\u8272\uff1a\n\n$$\\begin{pmatrix}\n        \\color{red}0&\\color{red}0&\\color{red}1&\\color{red}0&\\color{red}1&\\color{red}1&\\color{red}0\\\\\n        1&1&\\color{red}0&0&\\color{red}0&\\color{red}0&0\\\\\n        \\color{red}1&\\color{red}0&\\color{red}1&\\color{red}0&\\color{red}0&\\color{red}1&\\color{red}0\\\\\n        \\color{red}1&\\color{red}1&\\color{red}1&\\color{red}0&\\color{red}1&\\color{red}0&\\color{red}1\\\\\n        0 &0&\\color{red}0&1&\\color{red}0&\\color{red}0&1\n        \\end{pmatrix}$$\n        \n$$P=\\{1\\} $$\n\n\u628a\u5b83\u4eec\u90fd\u5220\u6389\uff0c\u5f97\u5230\uff1a\n\n$$\n        \\begin{pmatrix}\n        1&1&0&0\\\\\n       0 &0&1&1\n        \\end{pmatrix}\n        \n$$\n\n$$P=\\{1\\}$$\n\n\u8089\u773c\u5f88\u76f4\u89c2\u7684\u53ef\u4ee5\u770b\u5230\uff1a\u628a\u8fd9\u4e24\u884c\u90fd\u9009\u4e0a\u4e0d\u5c31\u597d\u4e86\uff0c\u4f46\u662f\u6211\u4eec\u9075\u5b88\u4e0b\u7a0b\u5e8f\u3002\n\n\u5148\u9009\u7b2c $1$ \u884c\uff08\u5176\u5b9e\u4e3a\u539f\u77e9\u9635\u7684\u7b2c $2$ \u884c\uff09\uff0c\u5e76\u6807\u7ea2\uff1a\n\n$$\n        \\begin{pmatrix}\n        \\color{red}1&\\color{red}1&\\color{red}0&\\color{red}0\\\\\n       0 &0&1&1\n        \\end{pmatrix}\n        \n$$\n\n$$P=\\{1,2\\}$$\n\n\u628a\u884c\u4e2d\u4f4d\u4e0a\u4e3a $1$ \u7684\u5217\u6807\u7ea2\uff1a\n\n$$\n        \\begin{pmatrix}\n        \\color{red}1&\\color{red}1&\\color{red}0&\\color{red}0\\\\\n       \\color{red}0 &\\color{red}0&1&1\n        \\end{pmatrix}\n        \n$$\n\n$$P=\\{1,2\\}$$\n\n\u5217\u4e2d\u5168\u4e3a $0$ \u6240\u4ee5\u6ca1\u6709\u7b2c $3$ \u6b65\u4e86\uff0c\u5220\u53bb\u540e\u5f97\u5230\uff1a\n\n$$\n        \\begin{pmatrix}\n        1&1\n        \\end{pmatrix}\n        \n$$\n\n$$P=\\{1,2\\}$$\n\n\u518d\u8fdb\u884c\u4e00\u8f6e\u540e\uff0c\u77e9\u9635\u4e3a\u7a7a\uff1a\n\n$$P=\\{1,2,5\\}$$\n\n\u90a3\u4e48 $P$ \u5219\u4e3a\u7cbe\u786e\u8986\u76d6\u95ee\u9898\u7684\u4e00\u4e2a\u89e3\u3002\n\n\u4f46\u5b9e\u9645\u4e0a\uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u7684\u6570\u636e\u5f88\u5f31\uff0c\u5bfc\u81f4\u6211\u4eec\u4e00\u6b21\u5c31\u6c42\u51fa\u6765\u4e86\uff0c\u4f46\u662f\u5728\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u4e00\u6b21\u6027\u662f\u65e0\u6cd5\u5f97\u5230\u6b63\u89e3\u7684\uff0c\u82e5\u77e9\u9635\u5728\u641c\u7d22\u7684\u8fc7\u7a0b\u4e2d\uff0c\u53ea\u5269 $0$ \u5143\u7d20\uff0c\u65e0\u6cd5\u518d\u9009\u62e9\uff0c\u5219\u6062\u590d\u4e00\u6b21\u9009\u62e9\uff0c\u5728\u5199\u4ee3\u7801\u65f6\u4f7f\u7528\u56de\u6eaf\u7684\u624b\u6bb5\u89e3\u51b3\u3002\n## \u6570\u636e\u7ed3\u6784\u5f15\u5165\n\u8457\u540d\u7684\u56fe\u7075\u5956\u5f97\u4e3b:\u5c3c\u53e4\u62c9\u65af\u00b7\u6c83\u65af \u63d0\u51fa\u8457\u540d\u7684\u7b49\u5f0f:\n\n\t\t\t\u7a0b\u5e8f = \u7b97\u6cd5 + \u6570\u636e\u7ed3\u6784\u3002\n\n\u6211\u4eec\u5df2\u7ecf\u7814\u7a76\u51fa\u4e86\u89e3\u51b3\u8fd9\u4e2a\u7cbe\u786e\u8986\u76d6\u7684\u7b97\u6cd5\uff0c\u90a3\u6211\u4eec\u600e\u4e48\u901a\u8fc7\u9009\u7528\u6570\u636e\u7ed3\u6784\u6765\u89e3\u51b3\uff1f\n\n Donald E. Knuth \u4f7f\u7528\u4e86 **\u5341\u5b57\u53cc\u5411\u5faa\u73af\u94fe\u8868** \u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\n \n \u4ed6\u628a\u6211\u4eec\u521a\u624d\u7528\u7684\u77e9\u9635\u62ff\u53cc\u5411\u5341\u5b57\u94fe\u8868\u7ef4\u62a4\uff0c\u4e0d\u540c\u7684\u662f\uff0c\u4ed6\u53ea\u7ef4\u62a4\u4e86\u5176\u4e2d\u7684 $1$ \u5143\u7d20\u3002\n \n \u65e2\u7136\u662f\u53cc\u5411\u5341\u5b57\u94fe\u8868\uff0c\u90a3\u4e48\u6bcf\u4e2a\u8282\u70b9\u90fd\u5177\u6709 $4$ \u4e2a\u6307\u9488\u57df\uff0c\u5728\u6b64\u5b9a\u4e49\uff1a\n \n `U[i]` \u6307\u5411 $i$ \u4e0a\u65b9\u7684\u5143\u7d20\uff0c\n `D[i]` \u6307\u5411 $i$ \u4e0b\u65b9\u7684\u5143\u7d20\uff0c\n `L[i]` \u6307\u5411 $i$ \u5de6\u65b9\u7684\u5143\u7d20\uff0c\n `R[i]` \u6307\u5411 $i$ \u53f3\u65b9\u7684\u5143\u7d20\u3002\n \n \u7279\u6b8a\u5f97\uff0c\u6bcf\u4e00\u5217\u4e0a\u90fd\u6709\u4e00\u4e2a\u8282\u70b9\uff08\u72ec\u7acb\u7684\uff0c\u4e0d\u4ee3\u8868\u8fd9\u91cc\u662f $1$\uff09\uff0c\u79f0\u4e3a\u5217\u5934\uff0c\u5728\u540e\u8f85\u52a9\u6211\u4eec\u5bf9\u7b97\u6cd5\u7684\u5e94\u7528\u3002\n \n \u6bcf\u4e00\u884c\u4e2d\u4efb\u53d6\u4e00\u4e2a\u8282\u70b9\u4f5c\u4e3a\u884c\u9996\uff08\u5728\u4ee3\u7801\u5b9e\u73b0\u4e2d\u4e3a\u7b2c\u4e00\u4e2a\u63d2\u5165\u5230\u672c\u884c\u7684\u5143\u7d20\uff0c\u5e76\u4e0d\u662f\u72ec\u7acb\u7684\uff0c\u4ee3\u8868\u4f4d\u4e0a\u4e3a $1$\uff09\u3002\n \n \u8fd8\u6709\u4e00\u4e2a\u72ec\u7acb\u7684 $0$ \u8282\u70b9\uff0c\u4e0d\u53c2\u4e0e\u7b97\u6cd5\u5b9e\u73b0\u8fc7\u7a0b\uff0c\u53ea\u662f\u5728\u540e\u7528\u4e8e\u8f85\u52a9\u5224\u65ad\u77e9\u9635\u662f\u5426\u4e3a\u7a7a\u3002\n \n \u6240\u4ee5\u8fd9\u4e2a\u94fe\u8868\u5b9e\u9645\u4e0a\u957f\u8fd9\u6837\uff1a\n \n![](https://cdn.luogu.com.cn/upload/image_hosting/z44dhqre.png)\n \n ## \u7a0b\u5e8f\u5b9e\u73b0\n \n \u63a5\u4e0b\u6765\u5c31\u5230\u5199\u4ee3\u7801\u9636\u6bb5\u5566\uff01\n #### \u53d8\u91cf\u521d\u59cb\u5316\n ```cpp\nint L[Maxs],R[Maxs],U[Maxs],D[Maxs],Ans[Maxs],Col[Maxs],Row[Maxs],Siz[Maxs],Head[Maxs],n,m,tot;\n```\n`Ans` \u6570\u7ec4\u5b58\u6211\u4eec\u641c\u7d22\u8fc7\u7a0b\u4e2d\u9009\u62e9\u7684\u884c\uff1b\n\n`Col` \u4e0e `Row` \u5206\u522b\u4e3a\u5b58\u8282\u70b9\u7684\u5217\u4e0e\u884c\uff1b\n\n`Siz` \u5b58\u5217\u4e0a\u5143\u7d20\u7684\u4e2a\u6570\uff1b\n\n`Head` \u5b58\u884c\u9996\u7684\u4e0b\u6807\uff1b\n\n`n,m` \u5206\u522b\u4e3a\u77e9\u9635\u7684\u884c\u6570\u4e0e\u5217\u6570\uff1b\n\n`tot` \u5b58\u5f53\u524d\u8282\u70b9\u7684\u4e2a\u6570\u3002\n\n #### 1 \u5efa\u521d\u59cb\u8868\n \u6211\u4eec\u53ea\u9700\u8981\u628a $0$ \u8282\u70b9\u4e0e\u5404\u5217\u5217\u5934\u5efa\u597d\u5373\u53ef\uff0c\u7ed9\u51fa\u4ee3\u7801\uff1a\n ```cpp\ninline void build(int r,int c)//\u5efa\u7acb r \u884c c \u5217\u8868\n{\n  \tn=r,m=c;//\u8d4b\u503c\n  \tfor(rei i=0;i<=c;i++)  L[i]=i-1,R[i]=i+1,U[i]=D[i]=i;\n   //\u5de6\u8fb9\u4e3a i-1 \uff0c\u53f3\u8fb9\u4e3a i+1.\u4e0a\u8fb9\u4e0e\u4e0b\u8fb9\u90fd\u4e3a i\n\tL[0]=c,R[c]=0,tot=c;\n   // 0\u7684\u5de6\u8fb9\u662f c\uff0cc\u7684\u53f3\u8fb9\u662f 0\uff0c\u6784\u6210\u5faa\u73af\u94fe\u8868\n   //\u76ee\u524d\u6709 c \u4e2a\u8282\u70b9\uff080\u8282\u70b9\u4e0d\u5360\uff09\n}\n```\n #### 2 \u63d2\u5165\u8282\u70b9\n \u5bf9\u4e8e\u5217\u4e0a\uff0c\u6211\u4eec\u5df2\u7ecf\u6709\u72ec\u7acb\u7684\u5217\u5934\u8282\u70b9\uff0c\u628a\u65b0\u8282\u70b9\u653e\u5728\u63d2\u5165\u5230\u5217\u5934\u4e0b\u65b9\u3002\n \n \u5bf9\u4e8e\u884c\u4e0a\uff0c\u82e5\u884c\u9996\u4e3a\u7a7a\uff0c\u90a3\u4e48\u628a\u884c\u9996\u8d4b\u4e3a\u5f53\u524d\u8282\u70b9\uff0c\u5de6\u6307\u9488\u53f3\u6307\u9488\u521d\u59cb\u5316\u6307\u5411\u5f53\u524d\u8282\u70b9\uff1b\n \n \u82e5\u884c\u9996\u4e0d\u4e3a\u7a7a\uff0c\u5219\u63d2\u5728\u884c\u9996\u53f3\u4fa7\n \n \u6ce8\uff1a\u6211\u4eec\u5728\u5b9e\u73b0\u7b97\u6cd5\u7684\u8fc7\u7a0b\u4e2d\u64cd\u4f5c\u90fd\u662f\u5bf9\u6574\u884c\u6574\u5217\u7684\uff0c\u6240\u4ee5\u5176\u5728\u94fe\u8868\u4e2d\u7684\u987a\u5e8f\u4e0d\u91cd\u8981\uff0c\u53ea\u8981\u4fdd\u8bc1\u5728\u6b63\u786e\u7684\u884c\u5217\u4e0a\u5373\u53ef\u3002\n \n \u7ed9\u51fa\u4ee3\u7801\uff1a\n ```cpp\ninline void insert(int r,int c)\n{\n\tCol[++tot]=c,Row[tot]=r,Siz[c]++;\n\tD[tot]=D[c],U[D[c]]=tot,U[tot]=c,D[c]=tot;\n\tif(!Head[r]) Head[r]=L[tot]=R[tot]=tot;\n\telse \n\t{\n\t\tR[tot]=R[Head[r]],L[R[Head[r]]]=tot;\n\t\tL[tot]=Head[r],R[Head[r]]=tot;\n\t}\n}\n```\n #### 3 \u5220\u9664\u4e00\u6574\u5217\uff0c\u5e76\u628a\u5176\u4f4d\u4e0a\u4e3a 1 \u7684\u884c\u5220\u53bb\n \u5148\u5bf9\u5217\u5934\u8fdb\u884c\u5904\u7406\uff0c\u518d\u5bf9\u5217\u4e0a\u5143\u7d20\u8fdb\u884c\u904d\u5386\uff0c\u518d\u628a\u904d\u5386\u5217\u8282\u70b9\u6240\u5728\u884c\u5220\u53bb\u5373\u53ef\u3002\n \n \u6ce8\uff1a\u6b64\u5904\u904d\u5386\u4e3a\u5bf9\u5faa\u73af\u94fe\u8868\u7684\u904d\u5386\uff0c\u4e0d\u4f1a\u7684\u53ef\u4ee5\u81ea\u5df1\u63a8\u4e00\u4e0b\n \n \u7ed9\u51fa\u4ee3\u7801\u4e0e\u5220\u9664\u884c\u4e0a\u5143\u7d20\u793a\u610f\u56fe\uff1a\n \n \n ```cpp\n#define rei register int\ninline void remove(int c)\n{\n\tL[R[c]]=L[c],R[L[c]]=R[c];\n\tfor(rei i=D[c];i!=c;i=D[i]) \n\t\tfor(rei j=R[i];j!=i;j=R[j])\n\t\t\tU[D[j]]=U[j],D[U[j]]=D[j],Siz[Col[j]]--;\n}\n```\n![](https://cdn.luogu.com.cn/upload/image_hosting/32nxvp6k.png)\n \n #### 4 \u4e0a\u4e00\u4e2a\u64cd\u4f5c\u7684\u56de\u6eaf\n \u5373\u4e3a\u9006\u64cd\u4f5c\uff0c\u6ce8\u610f\u6bcf\u4e00\u4e2a\u5730\u65b9\u90fd\u662f\u9006\u7684\uff0c\u4e0d\u8981\u6f0f\u4e86\u3002\n \n\u6ce8\uff1a\u5728\u8fd9\u4e2a\u64cd\u4f5c\u4e2d\u4f60\u5c31\u4f1a\u611f\u5230\u5faa\u73af\u94fe\u8868\u6709\u591a\u5999\u4e86\uff0c\u5220\u9664\u8fd9\u4e00\u5217/\u884c\u540e\uff0c\u8282\u70b9\u7684\u4fe1\u606f\u5e76\u6ca1\u6709\u6539\u53d8\uff0c\u6240\u4ee5\u5f88\u5bb9\u6613\u6062\u590d\u3002\n ```cpp\n#define rei register int\ninline void recover(int c)\n{\n\tfor(rei i=U[c];i!=c;i=U[i]) \n\t\tfor(rei j=L[i];j!=i;j=L[j])\n\t\t\tU[D[j]]=D[U[j]]=j,Siz[Col[j]]++;\n\tL[R[c]]=R[L[c]]=c;\n}\n```\n#### 5 \u641c\u7d22\n\u6bcf\u4e00\u6b21\u8d2a\u5fc3\u7684\u9009\u62e9 Siz \u8f83\u5c0f\u7684\u5217\uff0c\u7136\u540e\u5220\u9664\u8fd9\u4e00\u5217\u540e\u679a\u4e3e\u9009\u62e9\u4e00\u884c\u5e76\u5220\u9664\u8fd9\u4e00\u884c\u4f4d\u4e0a\u4e3a $1$ \u7684\u5217\uff0c\u8fd9\u6837\u4f7f\u5f97 Siz \u8f83\u5927\u7684\u5217\u5f88\u6709\u53ef\u80fd\u5728\u8fc7\u7a0b\u4e2d\u88ab\u5220\u9664\uff0c\u964d\u4f4e\u56de\u6eaf\u7684\u6b21\u6570\u3002 \n```cpp\n#define rei register int \ninline bool dance(int dep)//\u5df2\u9009\u884c\u6570\u4e3a dep-1 \n{\n\tif(!R[0])//\u77e9\u9635\u4e3a\u7a7a\uff0c\u8f93\u51fa\uff0c\u8df3\u51fa\n\t{\n\t\tfor(int i=1;i<dep;i++) printf(\"%d \",Ans[i]);\n  \t\treturn 1;\n\t}\n\trei c=R[0];\n\tfor(rei i=R[0];i;i=R[i]) if(Siz[i]<Siz[c]) c=i;\n\tremove(c);//\u627e\u5230 Siz \u6700\u5c0f\u5217\u5e76\u5220\u9664\n\tfor(rei i=D[c];i!=c;i=D[i])\n\t{\n\t\tAns[dep]=Row[i];\n\t\tfor(rei j=R[i];j!=i;j=R[j]) remove(Col[j]);//\u5220\u9664\u4f4d\u4e0a\u4e3a 1 \u7684\u5217\n\t\tif(dance(dep+1)) return 1;//\u5982\u679c\u5df2\u7ecf\u627e\u5230\u7b54\u6848\uff0c\u8df3\u51fa\n\t\tfor(rei j=L[i];j!=i;j=L[j]) recover(Col[j]);//\u56de\u6eaf\u540e\u7ee7\u7eed\u627e\n\t}\n\trecover(c);\n\treturn 0;//\u56de\u6eaf\uff0c\u8fd9\u79cd\u60c5\u51b5\u65e0\u89e3\n}\n```\n\n\u7ed9\u51fa Dancing Links \u90e8\u5206\u4ee3\u7801\uff1a\n\n```cpp\n#define rei register int \nstruct DLX {\n  \tint L[Maxs],R[Maxs],U[Maxs],D[Maxs],Ans[Maxs],Col[Maxs],Row[Maxs],Siz[Maxs],Head[Maxs],n,m,tot;\n  \tinline void build(int r,int c)\n  \t{\n  \t\tn=r,m=c;\n  \t\tfor(rei i=0;i<=c;i++) L[i]=i-1,R[i]=i+1,U[i]=D[i]=i;\n\t\tL[0]=c,R[c]=0,tot=c;\n\t}\n\tinline void insert(int r,int c)\n\t{\n\t\tCol[++tot]=c,Row[tot]=r,Siz[c]++;\n\t\tD[tot]=D[c],U[D[c]]=tot,U[tot]=c,D[c]=tot;\n\t\tif(!Head[r]) Head[r]=L[tot]=R[tot]=tot;\n\t\telse \n\t\t{\n\t\t\tR[tot]=R[Head[r]],L[R[Head[r]]]=tot;\n\t\t\tL[tot]=Head[r],R[Head[r]]=tot;\n\t\t}\n\t}\n\tinline void remove(int c)\n\t{\n\t\tL[R[c]]=L[c],R[L[c]]=R[c];\n\t\tfor(rei i=D[c];i!=c;i=D[i]) for(rei j=R[i];j!=i;j=R[j]) U[D[j]]=U[j],D[U[j]]=D[j],Siz[Col[j]]--;\n\t}\n\tinline void recover(int c)\n\t{\n\t\tfor(rei i=U[c];i!=c;i=U[i]) for(rei j=L[i];j!=i;j=L[j]) U[D[j]]=D[U[j]]=j,Siz[Col[j]]++;\n\t\tL[R[c]]=R[L[c]]=c;\n\t}\n\tinline bool dance(int dep)\n\t{\n\t\tif(!R[0])\n\t\t{\n\t\t\tfor(int i=1;i<dep;i++) printf(\"%d \",Ans[i]);\n\t  \t\treturn 1;\n\t\t}\n\t\trei c=R[0];\n\t\tfor(rei i=R[0];i;i=R[i]) if(Siz[i]<Siz[c]) c=i;\n\t\tremove(c);\n\t\tfor(rei i=D[c];i!=c;i=D[i])\n\t\t{\n\t\t\tAns[dep]=Row[i];\n\t\t\tfor(rei j=R[i];j!=i;j=R[j]) remove(Col[j]);\n\t\t\tif(dance(dep+1)) return 1;\n\t\t\tfor(rei j=L[i];j!=i;j=L[j]) recover(Col[j]);\n\t\t}\n\t\trecover(c);\n\t\treturn 0;\n\t}\n}dlx;\n```\n\n",
        "postTime": 1628240501,
        "uid": 486187,
        "name": "2000VOLT",
        "ccfLevel": 0,
        "title": "P4929 \u3010\u6a21\u677f\u3011\u821e\u8e48\u94fe\uff08DLX\uff09 \u9898\u89e3"
    },
    {
        "content": "# Dancing Links X \u7b97\u6cd5\n\n### \u4e00\uff0c\u7b97\u6cd5\u6982\u8ff0\n\n$Dancing$ $Links$ $X$\u662f\u4e00\u4e2a\u7531\u7b97\u6cd5\u5927\u5e08 Kunth \u7814\u7a76\u51fa\u7684\u7b97\u6cd5,\u57fa\u672c\u601d\u60f3\u662f\u4e00\u4e2a\u5220\u9664\u548c\u6062\u590d\u5143\u7d20\u6709\u4e9b\u7279\u6b8a\u7684\u56db\u5411\u5faa\u73af\u94fe\u8868,\u53ef\u4ee5\u5c06 Exact Covering Problem (\u7b80\u79f0 ECP ,\u4e3a NPC \u95ee\u9898)\u5728\u6781\u77ed\u7684\u65f6\u95f4\u5185\u89e3\u51b3\u3002\n  \n### \u4e8c\uff0c X \u7b97\u6cd5\n\n   \u6240\u8c13 X \u7b97\u6cd5...\u8fd9\u5c31\u662f\u4e00\u4e2a\u6df1\u641c\uff08~~\u592a\u5c51\u4e86~~\uff09\u3002\n    \n    \u6b65\u9aa4\n    1.\u5982\u679c\u53d1\u73b0\u6240\u6709\u5217\u90fd\u88ab\u6807\u8bb0\u5219\u8f93\u51fa\u7b54\u6848\u3002\n    2.\u5bf9\u5f53\u524d\u77e9\u9635\u5220\u9664\u5f53\u524d\u884c\uff0c\u5e76\u5220\u53bb\u4e0e\u5f53\u524d\u884c\u6709\u516c\u5171\u5143\u7d20\uff08\u5373\u540c\u5217\u6709 1\uff09 \u7684\u6240\u6709\u884c\uff0c\u9012\u5f52\u4e0b\u4e00\u5c42\u3002\n    3.\u5982\u679c\u6240\u6709\u884c\u8fd4\u56de\u65e0\u89e3\u5373\u8fd4\u56de\u65e0\u89e3\u7ed9\u4e0a\u4e00\u5c42\uff0c\u5e76\u6062\u590d\u884c\uff0c\u56de\u5230\u7b2c2\u6b65\u3002\n    4.\u6240\u6709\u641c\u7d22\u65e0\u89e3\u5219\u8fd4\u56de\u65e0\u89e3\u3002\n    \n   \u5173\u4e8eX\u7b97\u6cd5\uff0c\u7f51\u4e0a\u6709\u8bb8\u591a\u751f\u52a8\u7684\u56fe\u89e3\uff0c\u8fd9\u91cc\u5df2\u7ecf\u8bf4\u4e86\u6b65\u9aa4\uff0c\u4e0d\u7406\u89e3\u7684\u53ef\u81ea\u884c\u770b\u4ee3\u7801\u6216\u641c\u7d22\u5176\u4ed6\u9898\u89e3\uff0c\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\uff08~~\u6211\u592a\u5f31\u4e86\u4e0d\u4f1a\u8bb2~~\uff09\u3002\n    \n   \u672c\u9898\u7684 DFS \u90e8\u5206\u4ee3\u7801\uff1a\n   ```cpp\n    inline bool dance(int deep){\n        if(!r[0]){\n            for(register int i(0);i<deep;++i)printf(\"%d \",ansk[i]);\n            return 1;//\u672c\u9898\u4e0d\u8981\u6c42\u591a\u89e3\uff0c\u53ef\u4ee5\u76f4\u63a5\u8fd4\u56de\n        }\n        int mini=r[0];//\u627e\u52301\u6700\u5c11\u7684\u5217\uff08\u51cf\u5c11\u8fed\u4ee3\u6b21\u6570\uff09\n        for(register int i(r[0]);i!=0;i=r[i])if(s[i]<s[mini])mini=i;\n        removed(mini);\n        for(int i(d[mini]);i!=mini;i=d[i]){\n            ansk[deep]=row[i];\n            for(int j=r[i];j!=i;j=r[j]) removed(col[j]);\n            if(dance(deep+1))return 1;//\u9012\u5f52\u4e0b\u4e00\u5c42\n            for(int j=l[i];j!=i;j=l[j]) resumed(col[j]);\n        }\n        resumed(mini);\n        return 0;//\u8fd4\u56de\u65e0\u89e3\n    }\n   ```\n\n### \u4e09\uff0c\u5341\u5b57\u94fe\u8868\uff08\u56db\u5411\u5faa\u73af\u94fe\u8868\uff09\n   - <1> \u5faa\u73af\u94fe\u8868  \n   \n   \t \u5faa\u73af\u94fe\u8868\u662f\u4e00\u79cd\u94fe\u5f0f\u5b58\u50a8\u7ed3\u6784\uff0c\u94fe\u8868\u4e2d\u6700\u540e\u4e00\u4e2a\u7ed3\u70b9\u7684\u6307\u9488\u57df\u6307\u5411\u5934\u7ed3\u70b9\uff0c\u6574\u4e2a\u94fe\u8868\u5f62\u6210\u4e00\u4e2a\u73af\u3002\n       \n   - <2> \u56db\u5411\u5faa\u73af\u94fe\u8868 ( Dancing Links )\n   \n     \u53c8\u79f0\u5341\u5b57\u94fe\u8868\uff0c\u76f8\u5f53\u4e8e\u56db\u4e2a\u65b9\u5411\uff08\u4e0a\u4e0b\u5de6\u53f3\uff09\u90fd\u6709\u6307\u9488\uff0c\u6784\u6210\u56db\u4e2a\u5faa\u73af\u94fe\u8868\u3002\u8fd9\u79cd\u7279\u6b8a\u7684\u7ed3\u6784\u53ef\u4ee5\u4f7f\u5176\u5feb\u901f\u5730\u8fdb\u884c\u79fb\u9664\u548c\u56de\u590d\u64cd\u4f5c(\u6b63\u597d\u5bf9\u5e94X\u7b97\u6cd5\u9700\u8981\u7684\u64cd\u4f5c)\uff0c\u56db\u4e2a\u65b9\u5411\u7684\u6307\u9488\u4e4b\u95f4\u7684\u53d8\u6362\u72b9\u5982\u821e\u8e48\u4e00\u822c\u7f8e\u4e3d\u53c8\u4e0d\u5931\u5de7\u5999\uff0c\u56e0\u6b64\u88ab\u79f0\u4e3a\u201c\u821e\u8e48\u94fe\u201d\u3002\n      \n      \u5341\u5b57\u94fe\u8868\u521d\u59cb\u5316\n      ```cpp\n      void init(int m)//\u4e00\u822c\u4e0d\u7528\u4f20n\uff0c\u6784\u5efa\u77e9\u9635\u53ea\u7528m\u4e2a\u5934\u5143\u7d20\n      {\n        cnt=m+1;//\u5f00\u59cb\u65f6\u6709m\u4e2a\u7ed3\u70b9\uff080\u7ed3\u70b9\u548c\u5404\u5217\u5934\u7ed3\u70b9\uff09\n        memset(h,-1,sizeof h);//\u5c06\u5934\u7ed3\u70b9\u8d4b\u4e3a-1\uff0c\u8868\u793a\u6ca1\u6709\n        for(int i=0;i<=m;i++){\n          u[i]=d[i]=i;\n          l[i]=i-1;r[i]=i+1;//\u5341\u5b57\u94fe\u8868\u57fa\u672c\u539f\u7406\n        }\n      \n      ```\n      \u5bf9\u4e8e\u63d2\u5165\u65b0\u8282\u70b9\uff08\u6ce8\u610f\uff0c\u8fd9\u91cc\u6bd4\u8f83\u96be\u61c2\uff0c\u5efa\u8bae\u4e0d\u7406\u89e3\u7684\u753b\u4e00\u4e0b\u56fe\uff0c\u6a21\u62df\u4e00\u4e0b\u6307\u9488\u7684\u53d8\u5316\uff09\n      ```cpp\n      inline void link(int R,int C){//\u5728R\u884cC\u5217\u63d2\u5165\u4e00\u4e2a1\n        s[C]++;//s\u6570\u7ec4\u8868\u793a\u6bcf\u5217\u7684\u7ed3\u70b9\u6570\n        col[cnt]=C;row[cnt]=R;//\u8bb0\u5f55\u8fd9\u4e2a\u70b9\u7684\u884c\u5217\u4fe1\u606f\n        u[cnt]=C;d[cnt]=d[C];u[d[C]]=cnt;d[C]=cnt;//\u94fe\u8868\u63d2\u5165\n        if(h[R]==-1) l[cnt]=cnt,h[R]=cnt,r[cnt]=cnt;//\u5982\u679c\u6ca1\u6709\u5934\uff0c\u90a3\u5b83\u5c31\u662f\u5934\n        else{\n            r[cnt]=h[R];l[cnt]=l[h[R]];r[l[h[R]]]=cnt;l[h[R]]=cnt;\n        }\n        ++cnt;return ;//\u4e0b\u4e00\u4e2a\u70b9\u7684\u7f16\u53f7\n      }\n      ```\n      \u79fb\u9664\u4e0e\u6062\u590dC\u5217\u4e0a\u6709\u70b9\u7684\u884c\uff0c\u6211\u89c9\u5f97\u8fd9\u91cc\u6700\u80fd\u4f53\u73b0\u201c\u6307\u9488\u7684\u821e\u8e48\u201d\u7684\u5de7\u5999\u3002\n      \n      \u5bf9\u4e8e\u79fb\u9664\u884c\u64cd\u4f5c\uff08\u4e0d\u7528\u91ca\u653e\u5185\u5b58\uff0c\u56e0\u4e3a\u8fd9\u53ea\u662f\u6682\u65f6\u7684\uff09\n      ```cpp\n      inline void removed(int C){\n          r[l[C]]=r[C];l[r[C]]=l[C];//\u5b83\u5de6\u8fb9\u7684\u53f3\u8fb9\u6307\u5411\u5b83\u7684\u53f3\u8fb9\uff0c\u5b83\u53f3\u8fb9\u7684\u5de6\u8fb9\u6307\u5411\u5b83\u7684\u5de6\u8fb9\uff08\u6211\u89c9\u5f97\u5f88\u5de7\u5999\uff09\n          for(register int i(d[C]);i!=C;i=d[i]){\n              for(register int j(r[i]);j!=i;j=r[j]){\n                  u[d[j]]=u[j];//\u540c\u7406\n                  d[u[j]]=d[j];\n                  --s[col[j]];\n              }\n          }return ;\n      }\n      ```\n      \u5bf9\u4e8e\u6062\u590d\u64cd\u4f5c\uff08\u6ce8\u610f\u6062\u590d\u8981\u548c\u79fb\u9664\u65b9\u5411\u76f8\u53cd\uff09\n      ```cpp\n      inline void resumed(int C){\n          r[l[C]]=C;l[r[C]]=C;\n          for(register int i(u[C]);i!=C;i=u[i]){//\u76f8\u53cd\u65b9\u5411\n              for(register int j(l[i]);j!=i;j=l[j]){\n                  u[d[j]]=j;d[u[j]]=j;++s[col[j]];\n              }\n          }return ;\n      }\n      ```\n\n### \u56db\uff0c\u6574\u4f53\u4ee3\u7801\n   \u672c\u9898\u4ee3\u7801\n   ```cpp\n  #include<iostream>\n  #include<cstdio>\n  #include<cstring>\n  #include<algorithm>\n  using namespace std;\n  const int mx=250510;\n  inline int Read(){\n      int x=0;char c=getchar();\n      while(c>'9'||c<'0')c=getchar();\n      while(c>='0'&&c<='9')x=x*10+c-'0',c=getchar();\n      return x;\n  }\n  int n,m,cnt;\n  int l[mx],r[mx],u[mx],d[mx],col[mx],row[mx],h[mx],s[mx],ansk[mx]; \n  void init(int m){\n      cnt=m+1;\n      memset(h,-1,sizeof h);\n      for(register int i(0);i<=m;++i){\n          u[i]=d[i]=i;\n          l[i]=i-1;r[i]=i+1;\n      }\n      l[0]=m;r[m]=0;\n  }\n  inline void link(int R,int C){\n      s[C]++;col[cnt]=C;row[cnt]=R;\n      u[cnt]=C;d[cnt]=d[C];u[d[C]]=cnt;d[C]=cnt;\n      if(h[R]==-1) l[cnt]=cnt,h[R]=cnt,r[cnt]=cnt;\n      else{\n          r[cnt]=h[R];l[cnt]=l[h[R]];r[l[h[R]]]=cnt;l[h[R]]=cnt;\n      }\n      ++cnt;return ;\n  }\n  inline void removed(int C){\n      r[l[C]]=r[C];l[r[C]]=l[C];\n      for(register int i(d[C]);i!=C;i=d[i]){\n          for(register int j(r[i]);j!=i;j=r[j]){\n              u[d[j]]=u[j];\n              d[u[j]]=d[j];\n              --s[col[j]];\n          }\n      }return ;\n  }\n  inline void resumed(int C){\n      r[l[C]]=C;l[r[C]]=C;\n      for(register int i(u[C]);i!=C;i=u[i]){\n          for(register int j(l[i]);j!=i;j=l[j]){\n              u[d[j]]=j;d[u[j]]=j;++s[col[j]];\n          }\n      }return ;\n  }\n  inline bool dance(int deep){\n      if(!r[0]){\n          for(register int i(0);i<deep;++i)printf(\"%d \",ansk[i]);\n          return 1;\n      }\n      int mini=r[0];\n      for(register int i(r[0]);i!=0;i=r[i])if(s[i]<s[mini])mini=i;\n      removed(mini);\n      for(int i(d[mini]);i!=mini;i=d[i]){\n          ansk[deep]=row[i];\n          for(int j=r[i];j!=i;j=r[j]) removed(col[j]);\n          if(dance(deep+1))return 1;\n          for(int j=l[i];j!=i;j=l[j]) resumed(col[j]);\n      }\n      resumed(mini);\n      return 0;\n  }\n  signed main(){\n      n=Read(),m=Read();\n      init(m);\n      for(register int i(1);i<=n;++i)\n          for(register int j(1);j<=m;++j)\n              if(Read())link(i,j);\n      if(!dance(0))printf(\"No Solution!\");\n      return 0;\n  }\n  ```\n  \u597d\u9898\u63a8\u8350\uff1a\n    \n    \n  | Dominoes | http://acm.hdu.edu.cn/showproblem.php?pid=2518 |\n| :----------: | :----------: |\n| N \u7687\u540e | https://www.spoj.com/problems/NQUEEN/ |\n| Lamp | http://acm.hdu.edu.cn/showproblem.php?pid=2828 |\n|\u9776\u5f62\u6570\u72ec|https://www.luogu.com.cn/problem/P1074|\n\n\u611f\u8c22\u9605\u8bfb\uff01",
        "postTime": 1611991689,
        "uid": 192615,
        "name": "_Yoimiya_",
        "ccfLevel": 0,
        "title": "Dancing Links X"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4929)\n[\u9898\u89e3\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/solution/P4929)\n[\u66f4\u597d\u7684\u98df\u7528](https://www.luogu.com.cn/blog/sinius/)\n\n### \u4ec0\u4e48\u662f\u821e\u8e48\u94fe\uff1f ###\n\nX \u7b97\u6cd5\u662f\u4e00\u79cd\u7528\u4e8e\u6c42\u89e3**\u7cbe\u786e\u8986\u76d6\u95ee\u9898**\u7684\u7b97\u6cd5\uff0c\u800c\u821e\u8e48\u94fe\uff08Dancing Links X\uff09\u662f\u89e3\u51b3\u5b83\u7684\u6570\u636e\u7ed3\u6784\u3002\n\n\u7cbe\u786e\u8986\u76d6\u95ee\u9898\u662f\u4e00\u79cd\u8bf8\u5982\u6570\u72ec\u3001\u516b\u7687\u540e\u3001\u4fc4\u7f57\u65af\u65b9\u5757\u4ee5\u53ca\u667a\u6167\u73e0\u6e38\u620f\u7684\u95ee\u9898\uff0c\u5177\u4f53\u5730\u8bf4\uff0c\u5c31\u662f\u628a\u4e00\u4e9b\u6570\u7cbe\u786e\u5730\u653e\u5165\u4e00\u4e9b\u683c\u5b50\u91cc\uff0c\u9700\u8981\u6ee1\u8db3\u67d0\u4e9b\u533a\u57df\u53ea\u80fd\u6709\u56fa\u5b9a\u4e2a\uff0c\u6c42\u65b9\u6848\u3002\n\n### X \u7b97\u6cd5 ###\n\n\u672c\u9898\u5176\u5b9e\u5c31\u662f\u7cbe\u786e\u8986\u76d6\u95ee\u9898\u7684\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5373\u6bcf\u4e00\u884c\u53ea\u6709\u4e00\u4e2a $1$\u3002\n\n\u90a3\u4e48\uff0cX \u7b97\u6cd5\u662f\u5982\u4f55\u6c42\u51fa\u7b54\u6848\u7684\u5462\uff1f\u6211\u4eec\u5047\u8bbe\u6709\u8fd9\u4e48\u4e00\u4e2a\u77e9\u9635\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/v7o4zsk2.png)\n\n\u6211\u4eec\u9009\u62e9 $1$ \u6700\u5c11\u7684\u90a3\u4e00\u884c\uff0c\u627e\u5230\u8fd9\u4e00\u884c\u4e2d\u6bcf\u4e00\u4e2a $1$\uff0c\u9009\u4e2d\u4ed6\u4eec\u7684\u5217\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ds82hvww.png)\n\n\u628a\u6bcf\u4e00\u5217\u4e2d\u6bcf\u4e00\u4e2a $1$ \u5bf9\u5e94\u7684\u884c\u90fd\u9009\u4e2d\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tq5n6gvr.png)\n\n\u597d\u4e86\uff0c\u5220\u6389\u6240\u6709\u9009\u4e2d\u7684\u6570\u3002\n\n\u8fd9\u5c31\u662f\u4e00\u4e2a\u6700\u57fa\u672c\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u8981\u7528\u4e00\u4e2a\u56de\u6eaf\uff0c\u6bcf\u6b21\u9009\u62e9\u5176\u4e2d\u4e00\u884c\uff0c\u627e\u76f4\u5230\u53ea\u5269\u4e0b\u4e00\u884c\u4e14\u8fd9\u4e00\u884c\u53ea\u6709 $1$\uff0c\u6b64\u65f6\u6bcf\u6b21\u5220\u9664\u7684\u884c\u5c31\u662f\u7b54\u6848\u3002\n\n\u4ee5\u4e0a\u5c31\u662f X \u7b97\u6cd5\u7684\u8fc7\u7a0b\uff0c\u4f46\u662f\u8fd9\u4e2a\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u5de8\u5927\u7684\uff0c\u6211\u4eec\u8981\u7528\u821e\u8e48\u94fe\uff08\u5341\u5b57\u94fe\u8868\uff09\u6765\u9ad8\u6548\u5730\u89e3\u51b3 X \u7b97\u6cd5\u3002\n\n### \u5341\u5b57\u94fe\u8868 ###\n\n\u666e\u901a\u7684\u94fe\u8868\u6709\u5de6\u53f3\uff0c\u800c\u5341\u5b57\u94fe\u8868\u6709\u4e0a\u4e0b\u5de6\u53f3\u3001\u6240\u5728\u5750\u6807\u4ee5\u53ca\u5217\u7684\u4e2a\u6570\uff0c\u5f53\u7136\uff0c\u8fd8\u6709\u6bcf\u5217\u7684\u5934\u90e8\u8282\u70b9\u7f16\u53f7\u3002\n\n\u5341\u5b57\u94fe\u8868\u7684\u63d2\u5165\u662f\u8fd9\u6837\u7684\uff1a\u9996\u5148\u65b0\u5efa\u4e00\u4e2a\u7ed3\u70b9\uff0c\u5904\u7406\u597d\u57fa\u672c\u4fe1\u606f\uff0c\u4e0a\u4e0b\u7b49\u4e8e\u81ea\u5df1\u3002\n\n\u800c\u5de6\u53f3\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\n\n\u5982\u679c\u8fd9\u4e00\u5217\u6ca1\u6709\u5934\u90e8\u8282\u70b9\uff0c\u628a\u81ea\u5df1\u5f53\u5934\u90e8\u8282\u70b9\uff0c\u5de6\u53f3\u7b49\u4e8e\u81ea\u5df1\u3002\n\n\u5426\u5219\u628a\u81ea\u5df1\u63d2\u5230\u5934\u90e8\u8282\u70b9\u7684\u5de6\u8fb9\u3002\n\n**\u8bf7\u8bb0\u4f4f\uff1a\u5f53\u4f60\u628a $a$ \u653e\u5728 $b$ \u7684\u4e00\u4e2a\u65b9\u5411\u65f6\uff0c\u628a $b$ \u7684\u53cd\u65b9\u5411\u4e5f\u53d8\u6210 $a$\u3002**\n\n\u63d2\u5165\u90e8\u5206\u7684\u4ee3\u7801\uff1a\n\n```cpp\nvoid insert(yhx ro,yhx co)\n{\n\tdlx[co].cs++;\n\tdlx[nolsi].co=co,dlx[nolsi].ro=ro,dlx[nolsi].u=co,dlx[nolsi].d=dlx[co].d,dlx[dlx[co].d].u=nolsi,dlx[co].d=nolsi;\n\tif(capo[ro]==-1)dlx[nolsi].l=nolsi,dlx[nolsi].r=nolsi,capo[ro]=nolsi;\n\telse dlx[nolsi].l=dlx[capo[ro]].l,dlx[dlx[capo[ro]].l].r=nolsi,dlx[nolsi].r=capo[ro],dlx[capo[ro]].l=nolsi,capo[ro]=nolsi;\n\tnolsi++;\n}\n```\n\n\u5341\u5b57\u94fe\u8868\u7684\u5220\u9664\u5e76\u4e0d\u9700\u8981\u628a\u8fd9\u4e2a\u8282\u70b9\u771f\u6b63\u610f\u4e49\u4e0a\u5220\u9664\uff0c\u4ec5\u4ec5\u662f\u628a\u8fd9\u4e2a\u8282\u70b9\u201c**\u4f4d\u7f6e\u610f\u4e49**\u201d\u4e0a\u5220\u9664\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5176\u5b83\u8282\u70b9\u7684\u4e0a\u4e0b\u5de6\u53f3\u5b58\u5728\u8fd9\u4e2a\u8282\u70b9\uff0c\u90a3\u5c31\u628a\u8fd9\u4e2a\u65b9\u5411\u8bbe\u4e3a\u8fd9\u4e2a\u65b9\u5411\u4e0a\u7684\u4e0b\u4e00\u4e2a\u8282\u70b9\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u5148\u5220\u8fd9\u4e2a\u8282\u70b9\u5728\u5de6\u53f3\u7684\u5b58\u5728\uff0c\u7136\u540e\u5faa\u73af\u5220\u4e0a\u4e0b\u3002\n\n\u4f46\u5220\u9664\u662f\u4e0d\u591f\u7684\uff0c\u56de\u6eaf\u8fd8\u8981\u6062\u590d\u3002\n\n\u6062\u590d\u5176\u5b9e\u5c31\u662f\u628a\u5220\u9664\u5b8c\u5168\u53cd\u8fc7\u6765\u4e00\u904d\u3002\n\n\u5220\u9664\u548c\u6062\u590d\u7684\u4ee3\u7801\uff1a\n\n```cpp\nvoid del(yhx co)\n{\n\tdlx[dlx[co].r].l=dlx[co].l,dlx[dlx[co].l].r=dlx[co].r;\n\tfor(yhx i=dlx[co].d;i!=co;i=dlx[i].d)\n\t{\n\t\tfor(yhx j=dlx[i].r;j!=i;j=dlx[j].r)dlx[dlx[j].u].d=dlx[j].d,dlx[dlx[j].d].u=dlx[j].u,dlx[dlx[j].co].cs--;//j\u662frow\uff0c\u6240\u4ee5\u5220col\uff0c\u6211\u662fsb \n\t}\n}\nvoid rev(yhx co)\n{\n\tfor(yhx i=dlx[co].u;i!=co;i=dlx[i].u)\n\t{\n\t\tfor(yhx j=dlx[i].l;j!=i;j=dlx[j].l)dlx[dlx[j].u].d=j,dlx[dlx[j].d].u=j,dlx[dlx[j].co].cs++;\n\t}\n\tdlx[dlx[co].r].l=co,dlx[dlx[co].l].r=co;\n}\n```\n\n\u6709\u4e86\u8fd9\u4e9b\u64cd\u4f5c\uff0c\u821e\u8e48\u94fe\u7684\u90e8\u5206\u5c31\u4e0d\u96be\u5b9e\u73b0\u4e86\u3002\n\n\u4e0b\u9762\u662f\u672c\u9898\u7684\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define yhx int\n#define lyq bitand\nusing namespace std;\nyhx n,m,capo[26666666],ans[2666666],nolsi,x;\nstruct node\n{\n\tyhx co,ro,u,d,l,r,cs;\n}dlx[2666666];//500*5000\nvoid init(yhx colsi)\n{\n\tfor(yhx i=0;i<=colsi;i++)dlx[i].co=i,dlx[i].ro=0,dlx[i].u=dlx[i].d=i,dlx[i].r=i+1,dlx[i].l=i-1,dlx[i].cs=0;//\u57fa\u7840\u7684\u521d\u59cb\u5316 \n\tdlx[colsi].r=0,dlx[0].l=colsi,nolsi=colsi+1;//\u5904\u7406\u8fb9\u754c\u503c \n\tmemset(capo,-1,sizeof(capo));\n}\nvoid insert(yhx ro,yhx co)\n{\n\tdlx[co].cs++;\n\tdlx[nolsi].co=co,dlx[nolsi].ro=ro,dlx[nolsi].u=co,dlx[nolsi].d=dlx[co].d,dlx[dlx[co].d].u=nolsi,dlx[co].d=nolsi;\n\tif(capo[ro]==-1)dlx[nolsi].l=nolsi,dlx[nolsi].r=nolsi,capo[ro]=nolsi;//\u6ca1\u6709\u5934\u90e8\u5c31\u505a\u5934\u90e8\uff0c\u5426\u5219\u63d2\u5165 \n\telse dlx[nolsi].l=dlx[capo[ro]].l,dlx[dlx[capo[ro]].l].r=nolsi,dlx[nolsi].r=capo[ro],dlx[capo[ro]].l=nolsi,capo[ro]=nolsi; \n\tnolsi++;\n}\nvoid del(yhx co)\n{\n\tdlx[dlx[co].r].l=dlx[co].l,dlx[dlx[co].l].r=dlx[co].r;\n\tfor(yhx i=dlx[co].d;i!=co;i=dlx[i].d)\n\t{\n\t\tfor(yhx j=dlx[i].r;j!=i;j=dlx[j].r)dlx[dlx[j].u].d=dlx[j].d,dlx[dlx[j].d].u=dlx[j].u,dlx[dlx[j].co].cs--;//j\u662frow\uff0c\u6240\u4ee5\u5220col\n\t}\n}\nvoid rev(yhx co)\n{\n\tfor(yhx i=dlx[co].u;i!=co;i=dlx[i].u)\n\t{\n\t\tfor(yhx j=dlx[i].l;j!=i;j=dlx[j].l)dlx[dlx[j].u].d=j,dlx[dlx[j].d].u=j,dlx[dlx[j].co].cs++;\n\t}\n\tdlx[dlx[co].r].l=co,dlx[dlx[co].l].r=co;\n}\nbool dancing(yhx dep)\n{\n\tif(dlx[0].r==0)\n\t{\n\t\tfor(yhx i=0;i<dep;i++)printf(\"%d \",ans[i]);\n\t\treturn true;\n\t}\n\tyhx tmp=dlx[0].r;\n\tfor(yhx i=dlx[0].r;i!=0;i=dlx[i].r)\n\t{\n\t\tif(dlx[i].cs<dlx[tmp].cs)tmp=i;\n\t}\n\tdel(tmp);//tmp\u662f\u5217\n\tfor(yhx i=dlx[tmp].d;i!=tmp;i=dlx[i].d)\n\t{\n\t\tans[dep]=dlx[i].ro;//ans\u8981\u6c42\u884c\n\t\tfor(yhx j=dlx[i].r;j!=i;j=dlx[j].r)del(dlx[j].co);//j\u662f\u884c\n\t\tif(dancing(dep+1))return true;\n\t\tfor(yhx j=dlx[i].l;j!=i;j=dlx[j].l)rev(dlx[j].co); \n\t}\n\trev(tmp);\n\treturn false;\n}\nsigned main(int argc,char* argv[])\n{\n\tcin>>n>>m;\n\tinit(m);\n\tfor(yhx i=1;i<=n;i++)\n\t{\n\t\tfor(yhx j=1;j<=m;j++)\n\t\t{\n\t\t\tscanf(\"%d\",lyq x);\n\t\t\tif(x)insert(i,j);\n\t\t}\n\t}\n\tif(!dancing(0))cout<<\"No Solution!\";\n\treturn 0;\n}\n```\n\n### \u4e00\u4e9b\u5176\u5b83\u7684\u9898 ###\n\n[P1784 \u6570\u72ec](https://www.luogu.com.cn/problem/P1784)\n\n\u867d\u7136\u662f DFS \u88f8\u9898\uff0c\u4f46\u662f\u4e5f\u662f DLX \u88f8\u9898\u3002\n\n[P4573 \u65b0\u6570\u72ec](https://www.luogu.com.cn/problem/P4573)\n\n\u540c\u4e0a\u3002\n\n[SP13980 sudoku-goblin](https://www.luogu.com.cn/problem/solution/SP13980)\n\n\u4e5f\u662f\u6a21\u677f\u9898\u3002\n\n[P4205 \u667a\u6167\u73e0\u6e38\u620f](https://www.luogu.com.cn/problem/P4205)\n\n\u7528 DLX \u6bd4 DFS \u5feb\uff0c\u5177\u4f53\u505a\u6cd5\u662f\u7528\u73e0\u5b50\u7684\u4e2a\u6570\u52a0\u62fc\u56fe\u7684\u4e2a\u6570\u8868\u793a\u5217\uff0c\u7136\u540e DLX\u3002\n\n[SP110 sudoku](https://www.luogu.com.cn/problem/SP1110)\n\n$4\\times 256=1024$ \u5217\u7684 DLX\u3002\n\n\u5b8c\u7ed3\u6492\u82b1\uff01",
        "postTime": 1684922410,
        "uid": 1006159,
        "name": "Antiluna",
        "ccfLevel": 0,
        "title": "P4929 \u9898\u89e3"
    },
    {
        "content": "## \u4ec0\u4e48\u662f\u7cbe\u786e\u8986\u76d6\u95ee\u9898\n\u5728\u4e00\u4e2a\u5168\u96c6 $X$ \u4e2d\u82e5\u5e72\u5b50\u96c6\u7684\u96c6\u5408\u4e3a $S$ \uff0c\u7cbe\u786e\u8986\u76d6\u662f\u6307\uff1a$S$ \u7684\u5b50\u96c6 $S*$\uff0c\u6ee1\u8db3X\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5143\u7d20\u5728 $S*$ \u4e2d\u6070\u597d\u51fa\u73b0\u4e00\u6b21\u3002\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u7ed9\u5b9a\u5168\u96c6 $[1,7]$ \uff0c\u518d\u7ed9\u51fa\u5176\u82e5\u5e72\u5b50\u96c6\n\n$$\\{3,5,6\\}\\{1,4,7\\}\\{2,3,6\\}\\{1,4\\}\\{2,7\\}\\{4,5,7\\}$$\n\n\u8981\u6c42\u9009\u51fa\u5176\u4e2d\u51e0\u4e2a\u5b50\u96c6\uff0c\u6ee1\u8db3:\n\n1. \u8fd9\u4e9b\u5b50\u96c6\u5185\u6ca1\u6709\u76f8\u540c\u5143\u7d20\uff08\u7cbe\u786e\uff09\uff1b\n\n1. \u8fd9\u4e9b\u5b50\u96c6\u7684\u5143\u7d20\u80fd\u7ec4\u6210\u5168\u96c6\uff08\u8986\u76d6\uff09\uff1b\n\n\u5176\u4e2d\u96c6\u5408 $\\{3,5,6\\},\\{1,4\\},\\{2,7\\}$ \u6ee1\u8db3\u7cbe\u786e\u8986\u76d6\u3002\n\n## \u77e9\u9635\u8868\u793a\u6cd5\n\u6211\u4eec\u53ef\u4ee5\u7528\u77e9\u9635\u63cf\u8ff0\u7cbe\u786e\u8986\u76d6\uff1a\u6bcf\u5217\u4ee3\u8868\u4e00\u4e2a\u5143\u7d20\uff0c\u6bcf\u884c\u4ee3\u8868\u4e00\u4e2a\u96c6\u5408\uff0c\u7136\u540e\u6211\u4eec\u8981\u89e3\u51b3\u7684\u5c31\u662f[\u9898\u76ee](https://www.luogu.com.cn/problem/P4929)\u6240\u63cf\u8ff0\u7684\u95ee\u9898\u4e86\u3002\n\n![](https://b1.sbimg.org/file/chevereto-jia/2020/11/26/Q21pw.png)\n\n## \u5341\u5b57\u53cc\u5411\u5faa\u73af\u94fe\u8868\uff08\u6570\u7ec4\u6a21\u62df\uff09\n\n```cpp\nstruct point\n{\n\tint left,right,up,down;\n}node[MAXN];//\u6bcf\u4e2a\u70b9\u7684\u4e0a\u4e0b\u5de6\u53f3\u6307\u9488\n\nint cnt,head[MAXN],s[MAXN];//\u6709cnt\u4e2a\u70b9\uff0chead\u5b58\u6bcf\u884c\u5934\u7ed3\u70b9\uff0cs\u5b58\u6bcf\u5217\u6709\u591a\u5c11\u4e2a1\n\n```\n## \u6838\u5fc3\u64cd\u4f5c\nDFS\u641c\u7d22\u6bcf\u6b21\u9009\u54ea\u4e2a\u96c6\u5408\uff08\u54ea\u4e00\u884c\uff09\u3002\n\n\u6bcf\u9009\u5b9a\u4e00\u884c\uff0c\u5220\u9664\u8be5\u884c\uff0c\u4ee5\u53ca\u76f8\u5173\u884c\u5217\u3002\uff08\u627e\u51fa\u9009\u5b9a\u884c\u6709 $1$ \u7684\u5217\uff0c\u628a\u8fd9\u5217\u4e0a\u6709 $1$ \u7684\u884c\u90fd\u5220\u9664\u3002\u76f8\u5f53\u4e8e\u9009\u5230\u4e00\u4e2a\u5143\u7d20\uff0c\u628a\u6709\u8fd9\u4e2a\u5143\u7d20\u7684\u96c6\u5408\u90fd\u5220\u6389\uff09\u3002\u800c\u5341\u5b57\u53cc\u5411\u5faa\u73af\u94fe\u8868\u80fd\u591f\u9ad8\u6548\u7684\u5b8c\u6210\u8fd9\u4e2a\u64cd\u4f5c\u3002\n\n\n\n------------\n## Code\n\n```cpp\n\n#include<cstdio>\nusing namespace std;\ninline int read()\n{\n\tint res;\n\tchar c;\n\twhile((c=getchar())<'0'||c>'9');\n\tres=c^48;\n\twhile((c=getchar())>='0'&&c<='9')\n\tres=(res<<3)+(res<<1)+(c^48);\n\treturn res;\n}\nint cnt,l[6000],r[6000],u[6000],d[6000],row[6000],col[6000];\nint head[505],s[505],ans[505]; \n\ninline void init(int m)\n{\n\tfor(int i=0;i<=m;++i)\n\t{\n\t\tl[i]=i-1;\n\t\tr[i]=i+1;\n\t\tu[i]=d[i]=i;\n\t}\n\tl[0]=m;\n\tr[m]=0;\n\tcnt=m;\n}//\ninline void insert(int R,int C)\n{\n\tcnt++;//\u5143\u7d20\u5e8f\u53f7 \n\trow[cnt]=R;\n\tcol[cnt]=C;\n\ts[C]++;\n\tu[cnt]=u[C];\n\td[cnt]=C;\n\td[u[C]]=cnt;\n\tu[C]=cnt;\n\tif(head[R])\n\t{\n\t\tl[cnt]=l[head[R]];\n\t\tr[cnt]=head[R];\n\t\tr[l[head[R]]]=cnt;\n\t\tl[head[R]]=cnt;\n\t}\n\telse head[R]=l[cnt]=r[cnt]=cnt;\n}//\u63d2\u5165\u7ed3\u70b9 \n\ninline void remove(int C)\n{\n\tl[r[C]]=l[C];\n\tr[l[C]]=r[C];\n\tfor(int i=d[C];i!=C;i=d[i])\n\t{\n\t\tfor(int j=r[i];j!=i;j=r[j])\n\t\t{\n\t\t\td[u[j]]=d[j];\n\t\t\tu[d[j]]=u[j];\n\t\t\ts[col[j]]--;\n\t\t}\n\t}\n}//\u5220\u9664\u64cd\u4f5c\ninline void resume(int C)\n{\n\tl[r[C]]=C;\n\tr[l[C]]=C;\n\tfor(int i=d[C];i!=C;i=d[i])\n\t{\n\t\tfor(int j=r[i];j!=i;j=r[j])\n\t\t{\n\t\t\td[u[j]]=j;\n\t\t\tu[d[j]]=j;\n\t\t\ts[col[j]]++;\n\t\t}\n\t}\n}//\u8fd8\u539f\u64cd\u4f5c\nbool dance(int deep)\n{\n\tif(!r[0])\n\t{\n\t\tfor(int i=1;i<deep;++i)\n\t\tprintf(\"%d \",ans[i]);\n\t\treturn 1;\n\t}\n\tint C=r[0];\n\tfor(int i=r[0];i;i=r[i]) if(s[i]<s[C]) C=i;\n\tremove(C);\n\tfor(int i=d[C];i!=C;i=d[i])\n\t{\n\t\tans[deep]=row[i];\n\t\tfor(int j=r[i];j!=i;j=r[j]) remove(col[j]);\n\t\tif(dance(deep+1)) return 1;\n\t\tfor(int j=r[i];j!=i;j=r[j]) resume(col[j]);\n\t}\n\tresume(C);\n\treturn 0;\n}//\u5176\u5b9e\u662fDFS\nint main()\n{\n\tint n=read(),m=read();\n\tbool x;\n\tinit(m);\n\tfor(int i=1;i<=n;++i)\n\tfor(int j=1;j<=m;++j)\n\t{\n\t\tx=read();\n\t\tif(x) insert(i,j);\n\t}\n\tif(!dance(1)) printf(\"No Solution!\");\n\treturn 0;\n}\n\n```\n\n",
        "postTime": 1606381598,
        "uid": 186477,
        "name": "SegTre",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P4929 \u3010\u6a21\u677f\u3011\u821e\u8e48\u94fe\uff08DLX\uff09"
    },
    {
        "content": "\u4e2a\u4eba\u611f\u89c9\u7cbe\u786e\u8986\u76d6\u7684\u7b97\u6cd5\u7406\u89e3\u96be\u5ea6\u4e0d\u5927\uff0c\u5173\u952e\u5728\u4e8e\u5341\u5b57\u94fe\u8868\u677f\u5b50\u7684\u7406\u89e3\uff0c\u6240\u4ee5\u672c\u7bc7\u9898\u89e3\u91cd\u5728\u89e3\u91ca\u5341\u5b57\u94fe\u8868 ~~\uff08\u6ca1\u9519\uff0c\u6211\u5c31\u662f\u83dc )~~  \n\u5148\u6765\u8bf4\u8bf4\u672c\u4f53\u7684\u6570\u636e\u7ed3\u6784\uff1a\u5341\u5b57\u94fe\u8868  \n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u70b9\u90fd\u6709up,down,left,right\u56db\u79cd\u65b9\u5411\u7684\u6307\u9488\u7684\u6570\u636e\u7ed3\u6784\uff0c\u6a21\u62df\u77e9\u9635\u3002\u7528\u4e8e\u7cbe\u786e\u8986\u76d6\u548c\u5b8c\u7f8e\u8986\u76d6\u3002  \n\u9996\u5148\u5728\u6bcf\u884c\u9996\u521b\u5efa\u521d\u59cb\u70b9\n```\nvoid init(int m)\n{\n\tfor(int i=0;i<=m;i++)\n\t{\n\t\tr[i]=i+1;\n\t\tl[i]=i-1;\n\t\tu[i]=d[i]=i;//\u6784\u6210\u73af\u5f0f\u7ed3\u6784\n\t}\n\tr[m]=0;\n\tl[0]=m;//l\u3001r\u6784\u6210\u73af\u5f0f\u7ed3\u6784\n\tmemset(h,-1,sizeof(h));\n\tmemset(s,0,sizeof(s));\n\tcnt=m+1;//\u65b0\u7684cnt\u52a0\u5165\n}\n```\n![ ](https://cdn.luogu.com.cn/upload/image_hosting/fz1n7ekc.png)  \n\u5176\u6b21\uff0c\u8fdb\u884c\u521d\u59cb\u5316\u7684\u52a0\u5165\n```\nvoid link(int rw,int c)//\u52a0\u5165\u7b2ccnt\u4e2a\u70b9\n{\n\trow[cnt]=rw,col[cnt]=c;//\u8bb0\u5f55cnt\u7684\u884c\u5217\u72b6\u51b5\n   s[c]++;//c\u5217\u591a\u4e00\u4e2a\n\tu[cnt]=c;\n\td[cnt]=d[c];\n\tu[d[c]]=cnt;\n\td[c]=cnt;//\u4ee5\u4e0a\u53c2\u8003\u56fe\u4e00\n\tif(h[rw]==-1)h[rw]=r[cnt]=l[cnt]=cnt;\n\telse {\n\t\tl[cnt]=h[rw];\n\t\tr[cnt]=r[h[rw]];      \n\t\tl[r[h[rw]]]=cnt;\n\t\tr[h[rw]]=cnt;//\u4ee5\u4e0a\u53c2\u8003\u56fe\u4e8c\n\t}\n\tcnt++;\n\treturn ;\n}\n```\n\u56fe\u4e00\uff1a  \n![\u56fe\u4e00](https://cdn.luogu.com.cn/upload/image_hosting/ohct4ndq.png)  \n\u56fe\u4e8c\uff1a![\u56fe\u4e8c](https://cdn.luogu.com.cn/upload/image_hosting/1uha3ma0.png)\n\u901a\u8fc7\u4ee5\u4e0a\u7684\u753b\u56fe\u8bc1\u660e\uff0c\u6211\u4eec\u975e\u5e38\u5bb9\u6613\uff08\u6ca1\u9519\uff09\u53d1\u73b0\u4ee5\u4e0b\u4ee3\u7801\uff1a\n```\n\u904d\u5386\u7b2cc\u5217\uff1afor(int i=d[c];i!=c;i=d[i])\ni=d[c]:\u521d\u59cb\u5316\u4e3ac\u5217\u6700\u9ad8\u884c\u70b9\u7f16\u53f7\ni!=c:\u8dd1\u56de\u6765\ni=d[i]:\u4e00\u5c42\u5c42\u5f80\u4e0b\u722c\u76f4\u5230\u722c\u56dec\u70b9\n\u904d\u5386i\u6240\u5728\u7684\u884c\uff1afor(int j=r[i];j!=i;j=r[j])\nj=r[i]:\u4ece\u53f3\u8fb9\u5f00\u59cb\u8dd1\nj!=i\uff1a\u8dd1\u56de\u6765\nj=r[j]:\u7ee7\u7eed\u5411\u53f3\u8dd1\n\n```\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u5341\u5b57\u94fe\u8868\u7684del\u4e0eadd\u64cd\u4f5c\u4ee3\u7801\n```\nvoid del(int c)\u5220\u9664c\u5217\n{\n\tr[l[c]]=r[c];\n\tl[r[c]]=l[c];//\u628ac\u70b9\u4ece0-m\u70b9\u5185\u6252\u51fa\u6765\uff0c\u4f46\u662f\u4fdd\u7559c\u5217u\u3001d\u5173\u7cfb\n\tfor(int i=d[c];i!=c;i=d[i])\n\tfor(int j=r[i];j!=i;j=r[j])\n\t{\n\t\tu[d[j]]=u[j];\n\t\td[u[j]]=d[j];//\u6b64\u5904\u628ai\u6240\u5728\u884c\u6252\u4e86\u4e0b\u6765\uff0c\u4fdd\u7559\u884c\u5185l\u3001r\u3001u\u3001d\u5173\u7cfb\u4e0d\u53d8\u4ec5\u5904\u7406\u539f\u56fe\n\t\ts[col[j]]--;\n\t}\n}\nvoid add(int c)\u52a0\u4e0ad\u5217\n{\n\tfor(int i=u[c];i!=c;i=u[i])//\u7528c\u5217\u539f\u6709\u7684u\u3001d\u5173\u7cfb\u904d\u5386c\u5217\uff08u\u3001d\u5747\u53ef\uff09\n\tfor(int j=l[i];j!=i;j=l[j])//\u7528i\u6240\u5728\u884c\u7684l\u3001r\u5173\u7cfb\u628ai\u884c\u88c5\u56de\u53bb\uff0c\u91cd\u65b0\u5efa\u7acb\u4e8e\u5176\u4ed6\u884c\u7684u\u3001d\u5173\u7cfb\uff08l\u3001r\u5747\u53ef\uff09\n\t{\n\t\tu[d[j]]=j;\n\t\td[u[j]]=j;\n\t\ts[col[j]]++;\n\t}\n\tr[l[c]]=c;\n\tl[r[c]]=c;\n}\n```\n\u63a5\u7740\u56de\u5230\u672c\u9898  \n\u5bf9\u4e8e\u672c\u9898\u7cbe\u786e\u8986\u76d6\u95ee\u9898\u53ef\u4ee5\u53c2\u8003\u4f17\u591a\u5927\u4f6c\u7684\u7ed8\u56fe\u7406\u89e3\u4e0e\u89e3\u91ca\u3002\u849f\u84bb\u7406\u89e3\u89c1\u4ee3\u7801\uff1a\n```\nbool dance(int deep)\n{\n\tif(r[0]==0)//\u5224\u65ad1-m\u5217\u662f\u5426\u5747\u88abdel\uff0c\u5982\u679c\u5747\u88abdel,0\u70b9\u7684\u5de6\u53f3\u6307\u9488\u5747\u6307\u54110\n\t{\n\t\tfor(int i=0;i<deep;i++)printf(\"%d \",ansk[i]);//\u7b80\u5355dfs\u7c7b\u578b\u7684\u8bb0\u5f55\u8f93\u51fa\n\t\treturn 1;\n\t}\n\tint c=r[0];\n\tfor(int i=r[0];i!=0;i=r[i])if(s[i]<s[c])c=i;//\u627e\u5230\u6709\u6700\u5c11\u70b9\u7684\u5217\uff0c\u4f18\u5316\u65f6\u95f4\n\tdel(c);//\u5220\u9664\u6700\u5c11\u70b9\u5217\uff08\u6709\u9650\u5728\u8be5\u5217\u4e2d\u786e\u5b9a\u4e00\u70b9\uff0c\u8be5\u5217\u81ea\u7136\u4ece\u56fe\u4e2d\u88ab\u6252\u4e0b\u6765\uff09\n\tfor(int i=d[c];i!=c;i=d[i])\n\t{\n\t\tansk[deep]=row[i];//\u679a\u4e3e\u9009\u62e9\u7684\u7b2c\u51e0\u884c\uff0c\u8fdb\u884c\u641c\u7d22\u56de\u6eaf\n\t\tfor(int j=r[i];j!=i;j=r[j])del(col[j]);//\u5220\u9664i\u70b9\u6240\u5728\u884c\n\t\tif(dance(deep+1))return 1;\n\t\tfor(int j=l[i];j!=i;j=l[j])add(col[j]);//\u52a0\u4e0ai\u70b9\u6240\u5728\u884c\n\t}\n\tadd(c);//\u8865\u56de\u539f\u56fe\uff0cdfs\u65e5\u5e38\u64cd\u4f5c\n\treturn 0;\n}\n```\n",
        "postTime": 1601729121,
        "uid": 198835,
        "name": "\u9634\u9633\u516b\u5366",
        "ccfLevel": 4,
        "title": "P4929 \u3010\u6a21\u677f\u3011\u821e\u8e48\u94fe\uff08DLX\uff09"
    },
    {
        "content": "\u9996\u5148\uff0c\u8ba9\u6211\u4eec\u4ee4\n\n$$\nA=\n\\begin{bmatrix}\n0&1&1&1&0&1\\\\\n1&1&0&0&0&1\\\\\n1&0&0&0&1&0\\\\\n0&1&0&0&0&1\n\\end{bmatrix}\n$$\n\n\u663e\u7136\uff0c\u7b2c $5$ \u5217\u4e2d\uff0c\u6211\u4eec\u5fc5\u987b\u9009\u7b2c\u4e09\u884c\uff0c\u5426\u5219\u8fd9\u4e00\u5217\u4e2d\u5c31\u4e0d\u7b26\u5408\u6761\u4ef6\u3002\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u9009\u4e86\u7b2c\u4e09\u884c\uff0c\u540c\u65f6\u7b2c\u4e94\u5217\u4e5f\u6ee1\u8db3\u4e86\u6761\u4ef6\uff0c\u6807\u8bb0\u4e00\u4e0b\uff1a\n\n$$\nB=\n\\begin{bmatrix}\n0&1&1&1&(0)&1\\\\\n1&1&0&0&(0)&1\\\\\n(1)&(0)&(0)&(0)&(1)&(0)\\\\\n0&1&0&0&(0)&1\n\\end{bmatrix}\n$$\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u7b2c\u4e00\u5217\u5df2\u7ecf\u9009\u4e86\u4e00\u4e2a\uff0c\u6ee1\u8db3\u4e86\u6761\u4ef6\uff0c\u4e8e\u662f\u7b2c\u4e00\u5217\u662f $1$ \u7684\u90fd\u4e0d\u80fd\u9009\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u518d\u6807\u8bb0\u4e00\u4e0b\uff1a\n\n$$\nC=\n\\begin{bmatrix}\n(0)&1&1&1&(0)&1\\\\\n(1)&(1)&(0)&(0)&(0)&(1)\\\\\n(1)&(0)&(0)&(0)&(1)&(0)\\\\\n(0)&1&0&0&(0)&1\n\\end{bmatrix}\n$$\n\n\u8fd9\u4e9b\u6253\u62ec\u53f7\u7684\u70b9\u6211\u4eec\u53ef\u4ee5\u4e0d\u7528\u8003\u8651\uff0c\u6240\u4ee5\u5220\u6389\u3002\n\n$$\nD=\n\\begin{bmatrix}\n1&1&1&1\\\\\n1&0&0&1\n\\end{bmatrix}\n$$\n\n\u6211\u4eec\u8003\u8651\u7b2c\u4e8c\u5217\u3002\u6b64\u65f6\u6211\u4eec\u5fc5\u987b\u9009\u7b2c\u4e00\u884c\u3002\u9009\u5b8c\u540e\u6240\u6709\u7684\u70b9\u90fd\u88ab\u5220\u9664\u4e86\u3002\u6240\u4ee5\uff0c\n\n$$\nE=\\varnothing\n$$\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u9009\u51fa\u4e86\u4e00\u79cd\u65b9\u6848\u3002\n\n\u8fd9\u53ef\u4ee5\u7528\u4e00\u4e2a\u53eb\u821e\u8e48\u94fe\u7684\u4e1c\u897f\u6765\u7ef4\u62a4\u3002\n\n## Code\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nconst int N=100005,inf=0x3f3f3f3f;\nint n,m,cnt;\nint L[N],R[N],U[N],D[N];\nint row[N],col[N];\nint sz[N];\nbool ok=0;\nint ans[N];\nvoid build()\n{\n\tans[0]=ok=0;\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=0;i<=m;i++)\n\t{\n\t\tsz[i]=0;\n\t\tL[i]=i-1; R[i]=i+1;\n\t\tU[i]=D[i]=i;\n\t}\n\tL[0]=m;R[m]=0;\n\tcnt=m+1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint x,begin,end;\n\t\tbegin=end=cnt;\n\t\tfor(int j=1;j<=m;j++)\n\t\t{\n\t\t\tscanf(\"%d\",&x);\n\t\t\tif(!x) continue;\n\t\t\tsz[j]++;\n\t\t\trow[cnt]=i;\n\t\t\tcol[cnt]=j;\n\t\t\tD[U[j]]=cnt;U[cnt]=U[j];\n\t\t\tD[cnt]=j;U[j]=cnt;\n\t\t\tL[cnt]=end;R[cnt]=begin;\n\t\t\tR[end]=cnt;L[begin]=cnt;\n\t\t\tend=cnt;\n\t\t\t++cnt;\n\t\t}\n\t}\n}\nvoid Del(int c)\n{\n\tL[R[c]]=L[c],R[L[c]]=R[c];\n\tfor(int i=D[c];i!=c;i=D[i])\n\t\tfor(int j=R[i];j!=i;j=R[j])\n\t\t\tU[D[j]]=U[j],D[U[j]]=D[j],--sz[col[j]];\n}\nvoid Resume(int c)\n{\n\tL[R[c]]=R[L[c]]=c;\n\tfor(int i=U[c];i!=c;i=U[i])\n\t\tfor(int j=L[i];j!=i;j=L[j])\n\t\t\tU[D[j]]=j,D[U[j]]=j,++sz[col[j]];\n\t\n}\nvoid dfs()\n{\n\tif(R[0]==0)\n\t{\n\t\tok=1;\n\t\treturn;\n\t}\n\tint mn=inf,c=-1;\n\tfor(int i=R[0];i;i=R[i])\n\t{\n\t\tif(!sz[i]) return;\n\t\tif(sz[i]<mn) mn=sz[i],c=i;\n\t}\n\tDel(c);\n\tfor(int i=D[c];i!=c;i=D[i])\n\t{\n\t\tans[++ans[0]]=row[i];\n\t\tfor(int j=R[i];j!=i;j=R[j]) Del(col[j]);\n\t\tdfs();\n\t\tif(ok) return;\n\t\t--ans[0];\n\t\tfor(int j=L[i];j!=i;j=L[j]) Resume(col[j]);\n\t}\n\tResume(c);\n}\nint main()\n{\n\tbuild();\n\tdfs();\n\tif(ok&&ans[0]) for(int i=1;i<=ans[0];i++) printf(\"%d \",ans[i]);\n\telse printf(\"No Solution!\");\n\treturn 0;\n}\n\n```",
        "postTime": 1642992683,
        "uid": 148507,
        "name": "_Imaginary_",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4929 \u3010\u6a21\u677f\u3011\u821e\u8e48\u94fe\uff08DLX\uff09"
    },
    {
        "content": "### \u9898\u76ee\u65b9\u6cd5\uff1a\n\u5178\u578b\u7684\u7cbe\u786e\u8986\u76d6\u95ee\u9898\u3002\n\n### \u7b97\u6cd5\u5b9e\u73b0\uff1a\n1. \u5982\u679c\u77e9\u9635\u4e3a\u7a7a\uff0c\u95ee\u9898\u89e3\u51b3\uff0c\u8f93\u51fa\u3002\n2. \u5426\u5219\uff0c\u9009\u62e9 $ 1 $ \u6700\u5c11\u7684\u4e00\u5217\u3002\n3. \u5982\u679c\u5b58\u5728\u4e3a $ 1 $ \u7684\u884c\uff0c\u8fdb\u5165\u4e0b\u4e00\u6b65\uff1b\u5426\u5219\u56de\u6eaf\u5230\u4e0a\u4e00\u5c42\u3002\n4. \u628a\u8fd9\u4e00\u884c\u5305\u542b\u8fdb\u90e8\u5206\u89e3\u3002\n5. \u5bf9\u4e8e\u6240\u6709\u6ee1\u8db3\u4e3a $ 1 $ \u7684\u5217\uff0c\u5bf9\u4e8e\u6240\u6709\u6ee1\u8db3\u4e3a $ 1 $ \u7684\u884c\uff0c\u4ece\u77e9\u9635\u4e2d\u5220\u9664\u8fd9\u4e00\u884c\uff0c\u7136\u540e\u4ece\u77e9\u9635\u4e2d\u5220\u9664\u8fd9\u4e00\u5217\u3002\n6. \u5728\u4e0d\u65ad\u51cf\u5c11\u7684\u77e9\u9635\u4e0a\u9012\u5f52\u5730\u91cd\u590d\u4e0a\u9762\u7684\u65b9\u6cd5\u3002\n\n### \u56fe\u5f62\u7ed3\u5408:\n\u6211\u4eec\u5148\u62ff\u4e00\u7ec4\u6570\u636e\u6765\u4e3e\u4f8b\uff0c\u5982\uff1a\n\n| $A$ | $B$ | $C$ | $D$ | $E$ | $F$ | $G$ |\n| -----------: | -----------: | -----------: | -----------: | -----------: | -----------: | -----------: |\n| $0$ | $0$ | $1$ | $0$ | $1$ | $1$ | $0$ |\n| $1$ | $0$ | $0$ | $1$ | $0$ | $0$ | $1$ |\n| $0$ | $1$ | $1$ | $0$ | $0$ | $1$ | $0$ |\n| $1$ | $0$ | $0$ | $1$ | $0$ | $0$ | $0$ |\n| $0$ | $1$ | $0$ | $0$ | $0$ | $0$ | $1$ |\n| $0$ | $0$ | $0$ | $1$ | $1$ | $0$ | $1$ |\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/org6wknv.png)\n\n\u6211\u4eec\u518d\u5c06 $ 0 $ \u5220\u6389\uff0c\u53ea\u5269\u4e0b $ 1 $\uff0c\u5728\u7528\u94fe\u8868\u94fe\u63a5\u8d77\u6765\uff0c\u5982\u56fe\uff1a\n![](https://cdn.luogu.com.cn/upload/image_hosting/u3ennw1i.png?x-oss-process=image/resize,m_lfit,h_3000,w_3000)\n\n### \u6838\u5fc3\u4ee3\u7801\uff1a\n\u521d\u59cb\u5316\u5efa\u8868\uff1a\n```cpp\nvoid sth(){\n\tans[0]=head=flag=0;\n\tfor(int i=0;i<=m;i++){\n\t\tS[i]=0;\n\t\tD[i]=U[i]=i;\n\t\tL[i]=i-1;R[i]=i+1;\n\t}\n\tL[0]=m,R[m]=0;\n\tcnt=m+1;\n\tfor(int i=1;i<=n;i++){\n\t\tint a,begin,end;\n\t\tbegin=end=cnt;\n\t\tfor(int j=1;j<=m;j++){\n\t\t\tcin>>a;\n\t\t\tif(a==0) continue;\n\t\t\tS[j]++;\n\t\t\tD[U[j]]=cnt;U[cnt]=U[j];\n\t\t\tD[cnt]=j;U[j]=cnt;\n\t\t\tL[cnt]=end;R[cnt]=begin;\n\t\t\tR[end]=cnt;L[begin]=cnt;\n\t\t\tX[cnt]=i;Y[cnt]=j;\n\t\t\tend=cnt;\n\t\t\tcnt++;\n\t\t}\n\t}\n}\n```\n\u641c\u7d22\u4ee3\u7801\uff1a\n```cpp\nvoid dfs(){\n\tif(R[head]==head) {flag=1;return;}\n\tint Mi=INT_MAX,id=-1;\n\tfor(int i=R[head];i!=head;i=R[i]){\n\t\tif(!S[i]) return;\n\t\tif(S[i]<Mi) Mi=S[i],id=i;\n\t}\n\tSC(id);\n\tfor(int i=D[id];i!=id;i=D[i]){\n\t\tans[++ans[0]]=X[i];\n\t\tfor(int j=R[i];j!=i;j=R[j]) SC(Y[j]);\n\t\tdfs();\n\t\tif(flag) return;\n\t\tans[0]--;\n\t\tfor(int j=L[i];j!=i;j=L[j]) FF(Y[j]);\n\t}\n\tFF(id);\n}\n```\n\u5168\u90e8\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int MAX=250005;\nint n,m;\nint head,finded,cnt,cnt1,id;\nint s[MAX],l[MAX],r[MAX],u[MAX],d[MAX],x[MAX],y[MAX],ans[MAX];\n\nvoid del(int x){\n\tr[l[x]] = r[x];  l[r[x]] = l[x];\n\tfor(int i = d[x]; i!=x; i = d[i]){\n\t\tfor(int j = r[i]; j!=i; j = r[j]){\n\t\t\td[u[j]] = d[j];  u[d[j]] = u[j];\n\t\t\ts[y[j]]--;\n\t\t}\n\t}\n}\n\nvoid remove(int x){\n\tr[l[x]] = l[r[x]] = x;\n\tfor(int i = d[x]; i!=x; i = d[i]){\n\t\tfor(int j = r[i]; j!=i; j = r[j]){\n\t\t\td[u[j]] = u[d[j]] = j;\n\t\t\ts[y[j]]++;\n\t\t}\n\t}\n}\n\nvoid dfs(){\n\tif(r[0] == 0){finded = 1;return;}\n\tint minn = 1e9,c = -1;\n\tfor(int i = r[0]; i!=0; i = r[i]){\n\t\tif(s[i] == 0) return;\n\t\tif(s[i] < minn) minn = s[i],c = i;\n\t}\n\tdel(c);\n\tfor(int i = d[c]; i!=c; i = d[i]){\n\t\tans[++cnt1] = x[i];\n\t\tfor(int j = r[i]; j!=i; j = r[j]) del(y[j]);\n\t\tdfs();\n\t\tif(finded) return;\n\t\tcnt1--;\n\t\tfor(int j = r[i]; j!=i; j = r[j]) remove(y[j]);\n\t}\n\tremove(c);\n\treturn;\n}\n\nvoid build(){\n\tcin>>n>>m;\n\thead = finded = 0;\n\tfor(int i = 0; i<=m; i++){\n\t\tu[i] = d[i] = i;\n\t\tl[i] = i-1,r[i] = i+1;\n\t}\n\tl[0] = m,r[m] = 0;\n\tcnt = m+1;\n\tfor(int i = 1; i<=n; i++){\n\t\tint x_,bin,end;\n\t\tbin = end = cnt;\n\t\tfor(int j = 1; j<=m; j++){\n\t\t\tcin>>x_;\n\t\t\tif(x_ != 0){\n\t\t\t\ts[j]++;\n\t\t\t\tx[cnt] = i;  y[cnt] = j;\n\t\t\t\td[u[j]] = cnt;  u[cnt] = u[j];\n\t\t\t\td[cnt] = j;  u[j] = cnt;\n\t\t\t\tl[cnt] = end;  r[cnt] = bin;\n\t\t\t\tr[end] = cnt;  l[bin] = cnt;\n\t\t\t\tend = cnt;\n\t\t\t\tcnt++;\n\t\t\t}\n\t\t}\n\t}\n}\nvoid print(){\n    if(finded) for(int i = 1; i<=cnt1; i++)cout<<ans[i]<<\" \";\n\telse cout<<\"No Solution!\";\n}\nint main(){\n\tbuild();\n\tdfs();\n\tprint();\n\treturn 0;\n}\n\n```\n\u7981\u6b62\u6284\u88ad\u3002",
        "postTime": 1685159394,
        "uid": 754319,
        "name": "Kobe_BeanBryant",
        "ccfLevel": 0,
        "title": "P4929 \u3010\u6a21\u677f\u3011\u821e\u8e48\u94fe\uff08DLX\uff09 \u9898\u89e3"
    }
]
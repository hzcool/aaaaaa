[
    {
        "content": "\u53d1\u73b0\u4e00\u9053\u6ca1\u6709\u9898\u89e3\u7684\u9898\u3002\n\n~~\u600e\u4e48\u8f89\u77f3\u5462\uff1f\u662f\u554a\u600e\u4e48\u8f89\u77f3\u5462\uff1f~~\n\n## \u9898\u610f\n\n\u7ed9\u5b9a $A,B,C$\uff0c\u6c42\uff1a\n\n$$\\large\\begin{aligned}\n\n& \\max z = \\sum_{i = 1}^{n} C_i x_i\\\\\n\n&s.t\n\\begin{cases} \n\n\\sum_{i = 1}^{n} A_i x_i = S\\\\\n\n\\sum_{i = 1}^{n} B_i x_i = T\n\n\\end{cases}\n\n\\end{aligned}$$\n\n## \u89e3\u6cd5\n\n\u867d\u7136\u5df2\u7ecf\u662f\u4e00\u4e2a\u7ebf\u6027\u89c4\u5212\u7684\u6807\u51c6\u5f62\u5f0f\uff0c\u4f46\u662f\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e2a\u73a9\u610f\u5c31\u975e\u5e38\u7684\u5c51\uff0c\u628a\u5b83\u76f4\u63a5\u5f53\u6210\u7ebf\u6027\u89c4\u5212\u505a\u80af\u5b9a\u4f1a TLE\uff0c\u60f3\u8981\u5f53\u6210\u5e26\u7ea6\u675f\u591a\u5143\u51fd\u6570\u6781\u503c\u505a\u62c9\u683c\u6717\u65e5\u4e58\u6570\u7ed3\u679c\u6c42\u51fa\u504f\u5bfc\u6570\u6ca1\u6cd5\u53cd\u89e3 $x$\uff0c\u505a\u9ad8\u65af\u6d88\u5143\u4e5f\u4f1a TLE\u3002\n\n\u4f46\u662f\u6709\u4e00\u4e2a\u91cd\u8981\u7684\u6761\u4ef6\u662f\u7ebf\u6027\u7ea6\u675f\u53ea\u6709\u4e24\u4e2a\uff0c\u8003\u8651\u8f6c\u5316\u95ee\u9898\uff0c\u4f7f\u7528\u7ebf\u6027\u89c4\u5212\u7684\u5bf9\u5076\u539f\u7406\u5c06\u95ee\u9898\u8f6c\u5316\u4e3a\u53d8\u91cf\u53ea\u6709\u4e24\u4e2a\u3002\n\n\u5bf9\u5076\u5f97\u5230\u5982\u4e0b\u7ebf\u6027\u89c4\u5212\uff1a\n\n$$\\large\\begin{aligned}\n\n& \\min z = Sx + Ty\\\\\n\n&s.t\n\\begin{cases} \n\n\\forall i \\in [1,n] A_i x + B_i y \\ge C_i\\\\\n\nx,y \\in \\mathbb{R}\n\n\\end{cases}\n\n\\end{aligned}$$\n\n\u7ebf\u6027\u89c4\u5212\u9664\u4e86\u5355\u7eaf\u5f62\u6cd5\u5916\u8fd8\u6709\u4e00\u4e2a\u5e38\u89c1\u89e3\u6cd5\uff1a\u56fe\u89e3\u6cd5\uff0c\u5373\u901a\u8fc7\u51e0\u4f55\u4f5c\u56fe\u6c42\u5f97\u53ef\u884c\u57df\uff0c\u7136\u540e\u6c42\u89e3\u3002\n\n\u5bf9\u4e8e\u5bf9\u5076\u95ee\u9898\uff0c\u53ea\u6709\u4e24\u4e2a\u53d8\u91cf\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u53ef\u4ee5\u628a $x,y$ \u5f53\u4f5c\u5e73\u9762\u4e0a\u7684\u4e24\u7ef4\uff0c\u6bcf\u4e2a\u9650\u5236 $A_i x + B_i y - C_i \\ge 0$ \u53ef\u4ee5\u770b\u4f5c\u76f4\u7ebf\u7684\u4e00\u822c\u5f0f\u65b9\u7a0b\uff0c\u5206\u5272\u5e73\u9762\u5f97\u5230\u7684\u53ef\u884c\u57df\u4e3a\u4e00\u4e2a **\u534a\u5e73\u9762**\uff0c\u95ee\u9898\u8f6c\u5316\u4e3a\u5728\u8fd9\u4e9b\u534a\u5e73\u9762\u7684\u4ea4\u96c6\u4e2d\u627e\u5230\u4e00\u70b9\u4f7f $Sx + Ty$ \u6700\u5c0f\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u9996\u5148\u79bb\u7ebf\u8be2\u95ee\uff0c\u7136\u540e\u6309\u7167 $S,T$ \u6392\u5e8f\u6700\u540e\u7edf\u4e00\u5904\u7406\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O} (n\\log n)$\n\n## \u4ee3\u7801\n\n\u53bb\u6389\u4e86\u8bfb\u5199\u4f18\u5316\u7684\u90e8\u5206\u3002\n\n```cpp\ntypedef std::pair<f80,f80> Point;\n\n// \u534a\u5e73\u9762\u7684\u6bcf\u4e2a\u70b9\nPoint p[N];\n\nstruct Line {\n\ti64 a, b, c;\n}l[N],q[M];\n\ninline bool cmp(const Line &x, const Line &y) {\n\ti64 tmp = x.a * y.b - x.b * y.a;\n\tif(tmp != 0) return tmp > 0;\n\ttmp = x.c * y.b - x.b * y.c;\n\treturn tmp > 0;\n}\n\nint stk[N];\n\n// \u76f4\u7ebf\u4e00\u822c\u5f0f\u65b9\u7a0b\u6c42\u4ea4\u70b9\ninline Point Intersect(const Line &x, const Line &y) {\n\ti64 d = x.a * y.b - x.b * y.a;\n\tf80 px = x.c * y.b - x.b * y.c;\n\tf80 py = x.a * y.c - x.c * y.a;\n\treturn std::make_pair(px / d,py / d);\n}\n\ninline bool PointOnLine(const Line &pl,const Point &pp) {\n\tf80 tmp = pl.a * pp.first + pl.b * pp.second - pl.c;\n\tif(fabs(tmp) < eps) return 1;\n\treturn !(tmp < 0);\n}\n\nf64 ans[M];\n\nvoid SolveSpec(int m) {\n\t// \u53ea\u6709\u4e00\u4e2a\u9650\u5236\u6761\u4ef6\u7684\u65f6\u5019\u9700\u8981\u7279\u5224\uff0c\u4e0d\u7136\u4f1a\u51fa\u73b0 nan\n\twhile (m--) {\n\t\tint S = readI(),T = readI();\n\t\t// \u5e73\u884c\u65f6\u65e0\u89e3\n\t\tif(S * l[1].b != T * l[1].a)\n\t\t\tPutStr(\"IMPOSSIBLE\");\n\t\telse\t\n\t\t\twriteF((f64)l[1].c * S / l[1].a,5),enter;\n\t}\n}\n\nvoid Solve(int n,int m) {\n\t// \u534a\u5e73\u9762\u4ea4\n\tint tp = 2;\n\tstk[1] = 1,stk[2] = 2;\n\tp[1].first = 0,p[1].second = (f80)l[1].c / l[1].b;\n\tp[2] = Intersect(l[1],l[2]);\n\t\n\trep(i,3,n) {\n\t\twhile(tp > 1) {\n\t\t\tint pre = stk[tp - 1],top = stk[tp];\n\t\t\tif(PointOnLine(l[top],Intersect(l[i],l[pre]))) --tp;\n\t\t\telse break;\n\t\t}\n\t\tp[tp + 1] = Intersect(l[i],l[stk[tp]]);\n\t\tstk[++tp] = i;\n\t}\n\t\n\trep(i,1,m) {\n\t\tq[i].a = readI();\n\t\tq[i].b = readI();\n\t\tq[i].c = i;\n\t\tans[i] = -2;\n\t}\n\tstd::sort(q + 1,q + m + 1,cmp);\n\t\n\trep(i,1,m) {\n\t\tif(q[i].a * l[1].b > q[i].b * l[1].a)\n\t\t\tans[q[i].c] = -1;\n\t\telse break;\n\t}\n\tint cur = 1;\n\trep(i,1,m) {\n\t\tif(ans[q[i].c] == -1) continue;\n\t\tint pl = stk[tp];\n\t\tif(q[i].a * l[pl].b < q[i].b * l[pl].a)\n\t\t\tbreak;\n\t\twhile(cur <= tp) {\n\t\t\tpl = stk[cur];\n\t\t\ti64 d = q[i].a * l[pl].b - q[i].b * l[pl].a;\n\t\t\tif(d >= 0) {\n\t\t\t\tans[q[i].c] = q[i].a * p[cur].first + q[i].b * p[cur].second;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t++cur;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tif(cur > tp) break;\n\t}\n\t\n\trep(i,1,m) if(ans[i] > 0)\n\t\twriteF(ans[i],5),enter;\n\telse\n\t\tPutStr(\"IMPOSSIBLE\");\n}\n\nint main() {\n\tInitIO();\n\tint n = readI(),m = readI();\n\trep(i,1,n) {\n\t\tl[i].a = readI();\n\t\tl[i].b = readI();\n\t\tl[i].c = readI();\n\t}\n\tstd::sort(l + 1,l + n + 1,cmp);\n\tint siz = 1;\n\trep(i,2,n) {\n\t\tif(l[i].a * l[i - 1].b == l[i - 1].a * l[i].b)\n\t\t\tcontinue;\n\t\tl[++siz] = l[i];\n\t}\n\tif(siz == 1) SolveSpec(m);\n\telse Solve(siz,m);\n\tEndIO();\n\treturn 0;\n}\n```\n\n## \u53c2\u8003\n\n\u8463\u514b\u51e1 \u6d45\u8c08\u7ebf\u6027\u89c4\u5212\u4e0e\u5bf9\u5076\u95ee\u9898",
        "postTime": 1651243605,
        "uid": 122520,
        "name": "\u671b\u6708Asta",
        "ccfLevel": 6,
        "title": "P4642 \u9898\u89e3"
    }
]
[
    {
        "content": "\u6211\u8bb0\u5f97\u6211\u8c03\u8fd9\u9053\u9898\u65f6\u4e2d\u8033\u708e\uff0c\u53d1\u70e7\uff0c\u4e8e\u662f\u5728\u5b66\u957f\u7684\u6307\u5bfc\u4e0b\u8fc7\u4e86\u4e5f\u6ca1\u6709\u53d1\u9898\u89e3\n\n\u53d1\u73b0\u6211\u81ea\u5df1\u7684\u601d\u8def\u86ee\u9b3c\u755c\u7684\n\n\u5e38\u89c4\u64cd\u4f5c\uff1a$f[i][j]$ \u8868\u793a\u5230$i$\u7684\u8ddd\u79bb\u4e3a$j$\u7684\u5976\u725b\u6709\u591a\u5c11\u53ea\uff0c\u4f46\u6ce8\u610f\u8fd9\u53ea\u662f\u5728\u7b2c\u4e8c\u904ddfs\u4e4b\u540e\n\n\u5728\u6211\u7684\u7b2c\u4e00\u904ddfs\u4e2d(\u5c31\u662f\u4e0b\u9762\u90a3\u4e2a\u53ebbuild\u7684\u51fd\u6570\uff09,$f[i][j]$\u7684\u542b\u4e49\u662f\u5728i\u8fd9\u8bfe\u5b50\u6811\u4e2d\u5230$i$\u7684\u8ddd\u79bb\u4e3a$j$\u7684\u5976\u725b\u6709\u591a\u5c11\u53ea\uff0c\u6240\u4ee5\u5728\u7b2c\u4e00\u904ddfs\u7684\u65f6\u5019\uff0c$f[i][j]$\u7684\u72b6\u6001\u53ea\u4f1a\u6765\u81ea\u5b83\u7684\u513f\u5b50\u4eec\n\n\u4e8e\u662f\u5728\u7b2c\u4e00\u904ddfs\u5c31\u6709\u4e00\u4e2a\u5f02\u5e38\u7b80\u5355\u7684\u65b9\u7a0b\n\n$$f[i][j]=\\sum_{}f[k][j-1]$$\n\n\u5176\u4e2d$k$\u662f $i$\u7684\u513f\u5b50\n\n\u5982\u679c\u6211\u4eec\u94a6\u5b9a\u4ee51\u4e3a\u6839\u5efa\u6811\u7684\u8bdd\uff0c\u90a3\u4e481\u7684\u5b50\u6811\u5c31\u662f\u6574\u68f5\u6811\uff0c\u4e8e\u662f\u8fd9\u4e2a\u65f6\u5019\u7684$f[1]$\u5c31\u662f\u5168\u6811\u610f\u4e49\u4e0b\u7684\u7b54\u6848\u4e86\n\n\u800c\u8fd9\u4e2a\u65f6\u5019\u7b2c\u4e8c\u904ddfs\u5c31\u8981\u767b\u573a\u4e86\uff0c\u7b2c\u4e8c\u904ddfs\u7684\u610f\u4e49\u5c31\u662f\u5229\u7528\u7236\u4eb2\u53bb\u66f4\u65b0\u513f\u5b50\uff0c\u4e8e\u662f\u6211\u4eec\u5c31\u53c8\u6709\u4e00\u4e2a\u7b80\u5355\u7684\u65b9\u7a0b\u4e86\n\n$$f[k][j]=\\sum_{}f[i][j-1]$$\n\n\u5176\u4e2d$k$\u662f $i$\u7684\u513f\u5b50\n\n\u8fd9\u6837\u7684\u8bdd\u80af\u5b9a\u4f1a\u6709\u91cd\u590d\u7684\uff0c\u56e0\u4e3a\u5230$i$\u7684\u8ddd\u79bb\u4e3a2\u7684\u70b9\u5305\u542b\u5230$k$\u8ddd\u79bb\u4e3a1\u7684k\u7684\u513f\u5b50\u4eec,\u800c\u8fd9\u4e9b\u70b9\u4f4d\u4e8e$k$\u7684\u5b50\u6811\u4e2d\u7684\u70b9\u5df2\u7ecf\u5728\u7b2c\u4e00\u904ddfs\u7684\u65f6\u5019\u88ab\u52a0\u4e0a\u4e86\uff0c\u4e8e\u662f\u6211\u4eec\u5728\u8fd9\u91cc\u7b80\u5355\u5bb9\u65a5\u5c31\u597d\u4e86\n\n\u4e8e\u662f\u5c31\u662f\u4ee3\u7801\u4e86\n```cpp\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#define re register\n#define maxn 100001\nusing namespace std;\nstruct node\n{\n    int v,nxt;\n}e[maxn<<1];\nint f[maxn][21],s[maxn],head[maxn],deep[maxn];\nint n,num,k;\ninline int read()\n{\n    char c=getchar();\n    int x=0;\n    while(c<'0'||c>'9') c=getchar();\n    while(c>='0'&&c<='9')\n      x=(x<<3)+(x<<1)+(c^48),c=getchar();\n    return x;\n}\ninline void add(int x,int y)\n{\n    e[++num].v=y;\n    e[num].nxt=head[x];\n    head[x]=num;\n}\ninline void build(int r)\n{\n    for(re int i=head[r];i;i=e[i].nxt)\n    if(!deep[e[i].v])\n    {\n        deep[e[i].v]=deep[r]+1;\n        build(e[i].v);\n        for(re int j=1;j<=k;j++)\n        f[r][j]+=f[e[i].v][j-1];\n    }\n}\ninline void dfs(int r)\n{\n    for(re int i=head[r];i;i=e[i].nxt)\n    if(deep[e[i].v]>deep[r])\n    {\n        for(re int j=k;j>=2;j--)\n            f[e[i].v][j]-=f[e[i].v][j-2];//\u7b80\u5355\u7684\u5bb9\u65a5\u539f\u7406\u4e86\n          //\u8fd9\u91cc\u7684\u5faa\u73af\u4e00\u5b9a\u8981\u5012\u5e8f\n        for(re int j=1;j<=k;j++)\n            f[e[i].v][j]+=f[r][j-1];\n        dfs(e[i].v);\n    }\n}\nint main()\n{\n    n=read();\n    k=read();\n    int x,y;\n    for(re int i=1;i<n;i++)\n    {\n        x=read();\n        y=read();\n        add(x,y);\n        add(y,x);\n    }\n    for(re int i=1;i<=n;i++)\n        s[i]=read(),f[i][0]=s[i];\n    deep[1]=1;\n    build(1);\n    dfs(1);\n    for(re int j=1;j<=n;j++)\n    {\n        int ans=0;\n        for(re int i=0;i<=k;i++)\n        ans+=f[j][i];\n        printf(\"%d\\n\",ans);\n    }\n}\n```",
        "postTime": 1527246141,
        "uid": 35178,
        "name": "asuldb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3047 \u3010[USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows\u3011"
    },
    {
        "content": "# \u9898\u89e3 P3047 [USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows\n\n[\u9898\u76ee\u94fe\u63a5](https://www.luogu.org/problem/P3047)\n\n\u9898\u76ee\u5927\u610f\u662f\u7ed9\u4f60\u4e00\u9897\u6811\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8282\u70b9i\uff0c\u6c42\u51fa\u8303\u56f4k\u4e4b\u5185\u7684\u70b9\u6743\u4e4b\u548c\n\n\u770b\u6570\u636e\u8303\u56f4\u5c31\u77e5\u9053\u66b4\u529b\u80af\u5b9a\u662f\u4f1at\u98de\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u8003\u8651\u5982\u4f55dp\uff08\u4ee3\u7801\u4e60\u60ef\u5199dfs\uff09\n\n\u4ed4\u7ec6\u601d\u8003\u4e00\u4e0b\u6211\u4eec\u53d1\u73b0\u70b9i\u8d70k\u6b65\u80fd\u5230\u8fbe\u7684\u70b9\u5206\u4e3a\u4ee5\u4e0b\u4e24\u79cd\n\n**1.\u5728i\u7684\u5b50\u6811\u4e2d\uff08\u7531i\u70b9\u5f80\u4e0b\uff09**\n\n**2.\u7ecf\u8fc7i\u7684\u7236\u4eb2\uff08\u7531i\u70b9\u5f80\u4e0a\uff09**\n\n\u8fd9\u6837\u7684\u95ee\u9898\u4e00\u822c\u53ef\u4ee5\u7528**\u4e24\u6b21dfs**\u89e3\u51b3\n\n\u6211\u4eec\u5b9a\u4e49\u72b6\u6001f[i][j]\u8868\u793ai\u70b9\u5f80\u4e0bj\u6b65\u8303\u56f4\u5185\u7684\u70b9\u6743\u4e4b\u548c\uff0cd[i][j]\u8868\u793ai\u70b9\u5f80\u4e0a\u548c\u5f80\u4e0b\u8d70j\u6b65\u8303\u56f4\u5185\u70b9\u6743\u4e4b\u548c\u3002\n\n\u7b2c\u4e00\u6b21dfs\u6211\u4eec\u6c42\u51fa\u6240\u6709\u7684f[n][k]\uff0c\u8fd9\u4e2a\u6bd4\u8f83\u7b80\u5355\uff0c\u5bf9\u4e8e\u8282\u70b9u\u548c\u5176\u513f\u5b50v,f[u][k] += f[v][j - 1]\u5c31\u884c\u4e86\u3002\uff08\u7b2c\u4e00\u6b21dfs\u5df2\u77e5\u53f6\u5b50\u8282\u70b9\u63a8\u7236\u4eb2\u8282\u70b9\uff09\n\n\u7b2c\u4e8c\u6b21dfs\u6211\u4eec\u901a\u8fc7\u5df2\u7ecf\u6c42\u51fa\u7684f\u6570\u7ec4\u63a8d\u6570\u7ec4\uff0c\u5bf9\u4e8eu\u548cu\u7684\u513f\u5b50v, d[v][k] += (d[u][k - 1] - f[v][k - 2]), \u6ce8\u610f\u6570\u7ec4\u4e0b\u8868\u4e0d\u8981\u8d8a\u754c\u3002d[i][j]\u7684\u521d\u59cb\u503c\u5e94\u8be5\u8d4b\u4e3af[i][j]\uff0c\u56e0\u4e3a\u6839\u8282\u70b9\u7684d[i][j]\u5c31\u662ff[i][j]\u3002\uff08\u7b2c\u4e8c\u6b21dfs\u5df2\u77e5\u7236\u4eb2\u8282\u70b9\u63a8\u513f\u5b50\u8282\u70b9\uff09\n\n~~\u601d\u8def\u8bf4\u5f97\u53ef\u80fd\u6709\u70b9\u7f57\u55e6~~\u770b\u4ee3\u7801\u5427\uff1a\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\n#define ll long long\n#define N 100005\nusing namespace std;\ninline int read()\n{\n\tint x = 0, f = 1;\n\tchar c = getchar();\n\twhile (c < '0' || c > '9') { if (c == '-') f = -1; c = getchar(); }\n\twhile (c >= '0' && c <= '9') { x = x * 10 + c - '0'; c = getchar(); }\n\treturn x * f;\n}\n\nll f[N][25], d[N][25];\n//f\u6570\u7ec4\u548cd\u6570\u7ec4\u524d\u9762\u5df2\u7ecf\u8bf4\u4e86\nint val[N];\nint n, k, tot, head[N];\n\nstruct edge\n{\n\tint to, next;\n\tedge() {}\n\tedge(int x, int y) { to = x; next = y; }\n}a[N * 2];\n//\u90bb\u63a5\u8868\u5b58\u56fe\nvoid add(int from, int to)\n{\n\ta[++tot] = edge(to, head[from]);\n\thead[from] = tot;\n}\n\nvoid dfs(int x, int fa)\n{\n\tfor (int i = 0; i <= k; i++) f[x][i] = val[x];\n\tfor (int i = head[x]; i; i = a[i].next)\n\t{\n\t\tint u = a[i].to;\n\t\tif (u != fa)\n\t\t{\n\t\t\tdfs(u, x);//\u5148dfs\u5230\u53f6\u5b50\u8282\u70b9\uff0c\u7136\u540e\u63a8\u7236\u4eb2\u8282\u70b9\n\t\t\tfor (int i = 1; i <= k; i++)\n\t\t\t\tf[x][i] += f[u][i - 1];\n\t\t}\n\t}\n}\n//\u7b2c\u4e00\u6b21dfs\nvoid dfs2(int x, int fa)\n{\n\tfor (int i = head[x]; i; i = a[i].next)\n\t{\n\t\tint u = a[i].to;\n\t\tif (u != fa)\n\t\t{\n\t\t\td[u][1] += f[x][0];\n\t\t\tfor (int i = 2; i <= k; i++)\n\t\t\t\td[u][i] += d[x][i - 1] - f[u][i - 2];\n\t\t\tdfs2(u, x);//\u5148dfs\u7236\u4eb2\u8282\u70b9\uff0c\u66f4\u65b0\u5b8c\u513f\u5b50\u540edfs\u513f\u5b50\n\t\t}\n\t}\n}\n//\u7b2c\u4e8c\u6b21dfs\nint main()\n{\n\tn = read(), k = read();\n\tfor (int i = 1; i < n; i++)\n\t{\n\t\tint a1 = read(), a2 = read();\n\t\tadd(a1, a2);\n\t\tadd(a2, a1);\n\t}\n\tfor (int i = 1; i <= n; i++)\n\t\tval[i] = read();\n\tdfs(1, 1);\n\tfor (int i = 1; i <= n; i++)\n\t\tfor (int j = 0; j <= k; j++)\n\t\t\td[i][j] = f[i][j];//\u628af\u8d4b\u7ed9d\n\tdfs2(1, 1);\n\tfor (int i = 1; i <= n; i++)\n\t\tcout << d[i][k] << endl;//\u8f93\u51fa\u7b54\u6848\n\treturn 0;\n}\n```\n\u603b\u4e4b\u6709\u4e00\u7c7b\u6811\u4e0adp\u7684\u9898\uff0c\u6bcf\u4e2a\u8282\u70b9\u7684\u7b54\u6848\u4e0e\u8fd9\u4e2a\u8282\u70b9\u7684\u7236\u4eb2\u548c\u513f\u5b50\u90fd\u6709\u5173\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u5206\u4e24\u6b21dfs\u6c42\u51fa\u7b54\u6848\uff0c\u4e00\u822c\u8fd9\u4e24\u6b21dfs\u4fbf\u5229\u987a\u5e8f\u4e0d\u540c\u3002\u8fd9\u8981\u6c42\u5927\u5bb6\u5bf9\u6811\u7684\u904d\u5386\u6709\u975e\u5e38\u6df1\u7684\u7406\u89e3\u548c\u5b9e\u73b0\u80fd\u529b\uff0c\u4f46\u662f\u601d\u8def\u5176\u5b9e\u5e76\u6ca1\u6709\u90a3\u4e48\u96be\u3002",
        "postTime": 1567236681,
        "uid": 92008,
        "name": "Yuyuanqi",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P3047 \u3010[USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows\u3011"
    },
    {
        "content": "## Solution:\n\n\u9996\u5148\u770b\u770b\u6570\u636e\u8303\u56f4\uff0c$n\\le1e5,k\\le20$\uff0c\u90a3\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u8bbe$f[n][k]$\n\n\u8bbe$d[i][j]$\u8868\u793a\u4ecei\u70b9\u5f00\u59cb\u5411\u4e0bk\u7684\u8303\u56f4\u5185\u6709\u591a\u5c11\u5934\u725b\uff0c$f[i][j]$\u4ee3\u8868\u4ecei\u70b9\u5f00\u59cbj\u8303\u56f4\u5185\u6709\u591a\u5c11\u5934\u725b\n\n$d[i][j]$\u53ef\u4ee5\u5f88\u5bb9\u6613\u7b97\u51fa\u6765\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u70b9$u$,$d[u][j]=C_u+\\sum_{v\\in son_u}d[v][j-1]$\n\n\u800c$f[i][j]$\u4e5f\u53ef\u4ee5\u5f97\u51fa\uff0c$f[v][j]=f[fa[v]][j-1]-d[v][j-2]+d[v][j]$\n\n\u6700\u540e\u8f93\u51fa$f[i][k]$\u5c31\u884c\u4e86\n\n## Code:\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1e5+1;\nint n,k,cnt,head[N];\nint a[N],d[N][21],f[N][21];\nstruct Edge{int nxt,to;}edge[N<<1];\nvoid ins(int x,int y){\n\tedge[++cnt].nxt=head[x];\n\tedge[cnt].to=y;head[x]=cnt;\n}\nvoid dfs(int x,int fa,int u){\n\td[x][u]+=a[x];\n\tfor(int i=head[x];i;i=edge[i].nxt){\n\t\tint y=edge[i].to;\n\t\tif(y==fa) continue;\n\t\td[x][u]+=d[y][u-1];\n\t\tdfs(y,x,u);\n\t}\n}\nvoid calc(int x,int fa,int u){\n\tint w=u-2>=0?d[x][u-2]:0;\n\tf[x][u]=f[fa][u-1]-w+d[x][u];\n\tfor(int i=head[x];i;i=edge[i].nxt)\n\t\tif(edge[i].to!=fa) calc(edge[i].to,x,u);\n}\nvoid work(int u){\n\tfor(int i=head[1];i;i=edge[i].nxt)\n\t\tcalc(edge[i].to,1,u);\n}\nint read(){\n\tint x=0,f=1;char ch=getchar();\n\twhile(!isdigit(ch)){if(ch=='-')f=-1;ch=getchar();}\n\twhile(isdigit(ch)){x=x*10+ch-48;ch=getchar();}\n\treturn x*f;\n}\nint main(){\n\tn=read(),k=read();\n\tfor(int i=1;i<n;i++){\n\t\tint x=read(),y=read();\n\t\tins(x,y),ins(y,x);\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\ta[i]=read(),d[i][0]=a[i];\n\tif(!k){\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tprintf(\"%d\\n\",a[i]);\n\t\treturn 0;\n\t}\n\tfor(int i=1;i<=k;i++) dfs(1,0,i),f[1][i]=d[1][i];\n\tfor(int i=1;i<=n;i++) f[i][0]=a[i];\n\tfor(int i=1;i<=k;i++) work(i);\n\tfor(int i=1;i<=n;i++) printf(\"%d\\n\",f[i][k]);\n\treturn 0;\n}\n```\n",
        "postTime": 1562023156,
        "uid": 73702,
        "name": "DQYdqy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3047 \u3010[USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows\u3011"
    },
    {
        "content": "\u53d1\u5e03\u4e00\u7bc7\u6362\u6839\u7684\u9898\u89e3\n\n\u53d1\u73b0\u5927\u5bb6\u7684\u505a\u6cd5\u57fa\u672c\u4e0a\u662f\u5bb9\u65a5\u505a\u7684\n\n\u586b\u4e00\u7bc7\u6362\u6839\u7684\u9898\u89e3\n\n\u6362\u6839\u7684\u9898\u76ee\u7684\u5927\u4f53\u601d\u8651\u662f\u5148\u6307\u5b9a\u4e00\u4e2a\u6839\n\n\u505a\u51fa\u9884\u5904\u7406\n\n\u7136\u540e\u6211\u4eec\u6362\u6839\u5c31\u53ea\u9700\u8981\u8003\u8651\u7236\u4eb2\u8282\u70b9\u548c\u513f\u5b50\u8282\u70b9\u4e4b\u95f4\u7ef4\u62a4\u7684\u4fe1\u606f\n\n\u7136\u540e\u6211\u4eec\u8003\u8651\u4e00\u4e0b\u8d21\u732e\u5c31\u53ef\u4ee5\u4e86\n\n\u5b9a\u4e49\u72b6\u6001\u4e3af[i][j]\u8868\u793a\u5728i\u8282\u70b9\u5c5e\u4e8e\u5b50\u6811\u8ddd\u79bb\u4e3aj\u7684\u8282\u70b9\n\n\u8f6c\u79fb\u663e\u7136f[i][j]=sigma(f[son[x][j-1]])\n\ncut\u8868\u793a\u629b\u53bb\u539f\u6765\u7684\u8d21\u732e\n\nlink\u8868\u793a\u52a0\u4e0a\u8d21\u732e\n\n\u56de\u6eaf\u65f6\u628a\u6839\u6362\u56de\u6765\u5c31\u597d\u4e86\n\n```cpp\n#include<bits/stdc++.h>\n\nusing namespace std;\n\ninline int read(){\n\tint x=0,f=1;\n\tchar p=getchar();\n\twhile(!isdigit(p)){\n\t\tif(p=='-') f=-1;\n\t\tp=getchar();\n\t}\n\twhile(isdigit(p)) x=(x<<3)+(x<<1)+(p^48),p=getchar();\n\treturn x*f;\n}\n\nconst int maxn=1e5+5;\n\nint n,k,dp[maxn][23],head[maxn],ver[maxn<<1],nxt[maxn<<1],cnt,ans[maxn];\n\ninline void add(int x,int y){\n\tnxt[++cnt]=head[x];\n\thead[x]=cnt;\n\tver[cnt]=y;\n}\n\ninline void dfs_pre(int x,int fa){\n\tfor(int i=head[x];i;i=nxt[i]){\n\t\tint y=ver[i];\n\t\tif(y==fa) continue;\n\t\tdfs_pre(y,x);\n\t\tfor(int j=1;j<=k;j++) dp[x][j]+=dp[y][j-1];\n\t}\n}\n\ninline void cut(int root1,int root2){\n\tfor(int i=1;i<=k;i++) dp[root1][i]-=dp[root2][i-1];\n} \n\ninline void link(int root1,int root2){\n\tfor(int i=1;i<=k;i++) dp[root1][i]+=dp[root2][i-1];\n}\n\ninline void change_root(int x,int y){\n\tcut(x,y);\n\tlink(y,x);\n}\n\ninline void dfs(int x,int fa){\n\tfor(int i=0;i<=k;i++) ans[x]+=dp[x][i];\n\tfor(int i=head[x];i;i=nxt[i]){\n\t\tint y=ver[i];\n\t\tif(y==fa) continue;\n\t\tchange_root(x,y);\n\t\tdfs(y,x);\n\t\tchange_root(y,x);\n\t}\n}\n\nint main(){\n\tn=read();k=read();\n\tfor(int i=1;i<n;i++){\n\t\tint x=read(),y=read();\n\t\tadd(x,y);add(y,x);\n\t}\n\tfor(int i=1;i<=n;i++) dp[i][0]=read();\n\tdfs_pre(1,0);\n//\tfor(int i=1;i<=n;i++){\n//\t\tfor(int j=0;j<=k;j++){\n//\t\t\tcout<<dp[i][j]<<\" \";\n//\t\t}\n//\t\tcout<<endl;\n//\t}\n//\tcout<<endl;\t\n\tdfs(1,0);\n\tfor(int i=1;i<=n;i++) printf(\"%d\\n\",ans[i]);\n\treturn 0;\n}\n\n```\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "postTime": 1572398357,
        "uid": 118918,
        "name": "whyl",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3047 \u3010[USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows\u3011"
    },
    {
        "content": "ps\uff1a\u849f\u84bb\u6211\u4e0d\u592a\u660e\u767d\u5176\u4ed6\u9898\u89e3\u7684\u6362\u6839\u601d\u8def\uff0c\u611f\u89c9\u6bcf\u4e2a\u4eba\u5199\u7684\u90fd\u662f\u5bb9\u65a5\uff0c\u6240\u4ee5\u8fd9\u9898\u4e3a\u4ec0\u4e48\u8981\u5bb9\u65a5\u5462\uff1f\u76f4\u63a5\u6362\u6839\u7edf\u8ba1\u4e0d\u597d\u5417\uff1f\n\n\u4e0b\u9762\u5f00\u59cb\u6b63\u9898\uff1a\n\n- \u4e3a\u4ec0\u4e48\u8fd9\u9053\u9898\u80fd\u6362\u6839\uff1f\u56e0\u4e3adp\u65b9\u7a0b\u53ea\u6709\u52a0\u64cd\u4f5c\uff0c\u4ed6\u7684\u9006\u64cd\u4f5c\u5c31\u662f\u51cf\uff0c\u77e5\u9053\u4e00\u4e2a\u70b9\u7684\u7b54\u6848\u540e\uff0c\u53ef\u4ee5\u8f7b\u6613\u7684\u7b97\u51fa\u6765\u5176\u4ed6\u70b9\u7684\u7b54\u6848\u3002\n- \u9996\u5148\u8bbe\u4e00\u4e2a\u6570\u7ec4$f[i][j]$,\u8868\u793a\u6709\u591a\u5c11\u4e2a\u70b9\u79bb$i$\u8fd9\u4e2a\u70b9\u7684\u8ddd\u79bb\u4e3a$j$;\n- \u5176\u6b21\u8003\u8651\u7b2c\u4e00\u6b21\u7edf\u8ba1\uff0c\u663e\u7136$ $f[i][j]=$  \\sum_{j=1}^k \\ $f[v][j-1]$ $ (v\u662f\u4e0ei\u76f8\u90bb\u7684\u70b9),\u56e0\u4e3a\u7b2c\u4e00\u6b21\u7edf\u8ba1\u65f6\u53ea\u662f\u4ece\u4e0b\u5230\u4e0a\u8f6c\u79fb\uff0c\u6240\u4ee5dp\u6ca1\u6709\u540e\u6548\u6027\u3002\n- \u4e4b\u540e\u6211\u4eec\u8003\u8651\u6362\u6839\uff0c\u5728\u8ba8\u8bba\u8fd9\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u5b9a\u4e49\u4e24\u79cd\u64cd\u4f5c link\u548c cut(\u4e0d\u662flct) link(now,pre)\u8868\u793a\u628apre\u7684\u8d21\u732e\u52a0\u5230now\u4e0a\uff0ccut(now,pre)\u8868\u793a\u628anow\u4e2d\u5c5e\u4e8epre\u7684\u8d21\u732e\u5220\u6389\uff0c\u8fd9\u6837\u6362\u6839\u5c31\u76f8\u5f53\u4e8e cut(now,v),link(v,now) \u5341\u5206\u7684\u65b9\u4fbf\u3002\n- \u6700\u540e\u53ea\u8981\u7edf\u8ba1\u7b54\u6848\u5c31\u884c\u4e86$ ans[i]= $ $ \\sum_{j=0}^k \\ $f[i][j]$ $\u3002\n\n## code:\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<queue>\n#include<map>\n#include<set>\nusing namespace std;\n#define LL long long \nconst int N=1e5+5;\nint head[N],tot,n,m;\nLL f[N][25],a[N];\nstruct ccf\n{\n\tint to,nxt;\n}e[N*2];\nvoid add(int a,int b)\n{\n\ttot++;\n\te[tot].to=b;\n\te[tot].nxt=head[a];\n\thead[a]=tot;\n}\nvoid init(int now,int fa)\n{\n\tf[now][0]=a[now];\n\tfor(int i=head[now];i;i=e[i].nxt)\n\t{\n\t\tint v=e[i].to;\n\t\tif(v==fa)continue;\n\t\tinit(v,now);\n\t\tfor(int j=1;j<=m;j++)\n\t\t\tf[now][j]+=f[v][j-1];\n\t}\n}\nvoid cut(int now,int pre)\n{\n\tfor(int i=1;i<=m;i++)\n\t\tf[now][i]-=f[pre][i-1];\n}\nvoid link(int now,int pre)\n{\n\tfor(int i=1;i<=m;i++)\n\t\tf[now][i]+=f[pre][i-1];\n}\nLL ans[N];\nvoid dfs(int now,int fa)\n{\n\tfor(int i=0;i<=m;i++)\n\t\tans[now]+=f[now][i];\n\tfor(int i=head[now];i;i=e[i].nxt)\n\t{\n\t\tint v=e[i].to;\n\t\tif(v==fa)continue;\n\t\tcut(now,v);link(v,now);\n\t\tdfs(v,now);\n\t\tcut(v,now);link(now,v);\n\t}\n}\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1,x,y;i<n;i++)\n\t{\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tadd(x,y);\n\t\tadd(y,x);\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tscanf(\"%lld\",&a[i]);\n\tinit(1,0);\n\tdfs(1,0);\n\tfor(int i=1;i<=n;i++)\n\t\tprintf(\"%lld\\n\",ans[i]);\n}\n```\n",
        "postTime": 1572399199,
        "uid": 132952,
        "name": "Goldia",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3047 \u3010[USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows\u3011"
    },
    {
        "content": "# \u8def\u8fc7\u7684\u9753\u4ed4\u770b\u8fc7\u6765\uff01\n\u8d70\u8fc7\u8def\u8fc7\uff0c\u5343\u4e07\u4e0d\u8981\u849f\u84bb\uff01\n\n\u8fd9\u9053\u9898\u72e0\u53cb\u7537\u8d4c\uff0c\u5c3b\uff08\u8003\uff09\u7684\u4e0d\u4ec5\u4ec5\u662f\u7801\u529b\uff0c\u6bd2\u9898\u80fd\u529b\uff0c\u66f4\u662f\u53d4\u4e0a\u95ee\u9898\u529f\u5e95\u7684\u68c0\u6d4b\uff0c\u65e0\u8bba\u5404\u4f4d\u73b0\u5728\u662f\u5728\u666e\u53ca\u7ec4\u8fd8\u662f\u63d0\u9ad8\u7ec4\uff0c\u90fd\u5341\u5206\u503c\u5f97\u6765\u5237\u4e00\u4e0b\u8fd9\u9053\u7ecf\u5178\u9898\u76ee\u3002\n\n\uff08~~\u6284\u88ad\u4e86\u4e00\u4e0b\u6211\u4e0a\u4e00\u7bc7\u9898\u89e3\u7684\u5f00\u5934~~\uff09\n\n------------\n\u4e0d\u626f\u5176\u4ed6\u7684\u4e86\uff0c\u76f4\u5207\u4e3b\u9898\n\n\u9898\u76ee\u5c31\u662f\u6c42\u6bcf\u4e2a\u7ed3\u70b9\u5728k\u6b65\u5185\u80fd\u5230\u8fbe\u5f53\u524d\u7ed3\u70b9\u7684\u5976\u725b\u6570\u76ee\u3002\n\n\n\u56e0\u4e3a\u4e0d\u4ec5\u53ef\u4ee5\u5411\u4e0a\u641c\uff0c\u8fd8\u80fd\u5411\u4e0b\u641c\uff0c\u53ea\u8bf4\u6b65\u6570\u4e3ak\uff0c\u6ca1\u8bf4\u53ea\u80fd\u5f80\u6811\u4e0b\u9762\u641c\uff0c\u4e0d\u80fd\u5f80\u4e0a\u641c\uff0c\u6240\u4ee5\u8981\u505a\u4e24\u6b21\u5927\u6cd5\u5e08\uff08\u6ed1\u7a3d\n\n\n------------\n## \u7b2c\u4e00\u6b21dfs\n\nDp[u][j]\u8868\u793a\u4ece\u4e0b\u5f80\u4e0a\uff0c\u8d70j\u6b65\u80fd\u5230\u8fbeu\u70b9\u7684\u5976\u725b\u6570\u3002\n\n\u5f88\u660e\u663e\u8fd9\u4e0d\u662f\u6b63\u786e\u7b54\u6848\uff0c\u6211\u4eec\u6765\u624b\u52a8\u6784\u4e00\u5f20\u56fe\u3002\n\n![](https://cdn.luogu.com.cn/upload/pic/73544.png)\n\n\u5728\u8fd9\u5f20\u5176\u4e11\u65e0\u6bd4\u7684\u56fe\u4e2d\uff0c\u6211\u4eec\n\u770b3\u53f7\u7ed3\u70b9\uff0c\u5b83dp[3][j]\u8bb0\u5f55\u4e86\u4ece\n\u4e0a\u5f80\u4e0bk\u6b65\u5230\u8fbe3\u7684\u70b9\uff0c\u4f46\u662f\u5b83\u5ffd\u7565\u4e861\u5230\u8fbe\u5b83\n\u60c5\u51b5\uff0c\u4e8e\u662f\u7b2c\u4e8c\u904d\u5927\u6cd5\u5e08\u5c31\u662f\u8981\u5904\u7406\u4e0a\u65b9\u7684\u7ed3\u70b9\u3002\n\n\n------------\n## \u7194\u6c60\uff0c\u878d\u5403\uff0c\u5bb9\u65a5\uff01\uff01\uff01\n\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u529e\u6cd5\u5c31\u662f\u2191 \u2191 \u2191 \u2191\n\n\u7b2c\u4e8c\u904ddfs\u6211\u4eec\u8981\u7528\u7236\u4eb2\u72b6\u6001\u66f4\u65b0\u513f\u5b50\u3002\n\n\u65b9\u7a0b\u663e\u800c\u6613\u89c1\uff1a\nf[i\u7684\u513f\u5b50][j]+=\u2211\u200bf[i][j\u22121]\n\n## \u8fd9\u4e2a\u65b9\u7a0b\u5bf9\u5417\n\n------------\n## \u6211\u4fe1\u4f60\u4e2a\u9b3c\uff01\uff01\uff01\uff01\uff08\u6ed1\u7a3d\n\u8fd9\u65b9\u7a0b\u9b3c\u90fd\u770b\u5f97\u51fa\u6709\u8bb8\u591a\u91cd\u590d\uff01\n\n\u5728k>2\u7684\u65f6\u5019\u80af\u5b9a\u4f1a\u6709\u91cd\u590d\uff01\n\n\u90a3\u4e48\u91cd\u590d\u4e86\u4ec0\u4e48\u5462\uff1f\u8fd8\u662f\u7528\u8fd9\u5f20\u5947\u4e11\u65e0\u6bd4\u7684\u56fe\n\n![](https://cdn.luogu.com.cn/upload/pic/73545.png)\n\nK=3\n\n\u6211\u5728\u56fe\u4e0a\u6807\u7684\u6570\u5b57\u8868\u793a\n\nDp[1][3~0]\uff08\u8fd9\u662f\u7b2c\u4e00\u6b21dfs\u65f6\u7684dp\u6570\u7ec4\n\n\u597d\uff0c\u6211\u4eec\u6765\u770b2\u53f7\u7ed3\u70b9\u3002\n\n\u5047\u5982\u6211\u4eec\u8981\u6c42\u6700\u7ec8\u7684dp[2][3]\n\u5982\u679c\u7528\u4e0a\u9762\u7684\u516c\u5f0f\u7684\u8bdd\uff0c\n\n![](https://cdn.luogu.com.cn/upload/pic/73547.png)\n\n\u6211\u4eec\u5c31\u8981\u52a0\u4e0a\u8fd9\u4e9b\u7ed3\u70b9\uff0c\n\n\u7136\u800c\uff0c4\u53f7\u7ed3\u70b9\u79bb2\u53f7\u7ed3\u70b9\u7684\u8ddd\u79bb\u660e\u660e\u662f1\u554a\uff0c\u4f46\u4ed6\n\u79bb1\u7684\u8ddd\u79bb\u7684\u786e\u662f2\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u8981\u51cf\u53bb\u50cf4\u53f7\u7ed3\u70b9\u4e00\u6837\u7684\u7ed3\u70b9\uff0c\u90a3\u4e48\u8fd9\u4e9b\u7ed3\u70b9\u6709\u4ec0\u4e48\u7279\u70b9\u5462\uff1f\u5f88\u660e\u663e\uff0c\u5b83\u79bb2\u8ddd\u79bb\u4e3a1\uff0c\u4e5f\u5c31\u662f3-2\n\n\n------------\n\u6240\u4ee5\u516c\u5f0f\u5c31\u662f\n\n\u6240\u4ee5\u516c\u5f0f\u5c31\u662f\uff1a\n\nf[i\u7684\u513f\u5b50][j]+=\u2211\u200bf[i][j\u22121]\n\nf[i\u7684\u513f\u5b50][j]-=\u2211\u200bf[i][j-2]\n\n\n------------\n\u90a3\u4e48\u5f88\u660e\u663e\uff0c\u7b2c\u4e00\u6b21dfs\u662f\u4ece\u53f6\u5b50\u8282\u70b9\u66f4\u65b0\u6839\u7ed3\u70b9\uff0c\u800c\u7b2c\u4e8c\u6b21\u662f\u7236\u4eb2\u66f4\u65b0\u513f\u5b50\uff0c\u6240\u4ee5\u7b2c\u4e00\u6b21\u64cd\u4f5c\u8981\u5728\u641c\u7d22\u540e\u505a\uff0c\u7b2c\u4e8c\u6b21\u8981\u5728\u641c\u7d22\u524d\u3002\n```cpp\nvoid dfs1(int u,int fa)\n{\n\tfor(int i=head[u];i;i=e[i].next){\n\t\tint v=e[i].to;\n\t\tif(v==fa)continue;\n\t\tdfs1(v,u);\n\t\tfor(int j=1;j<=k;++j)\n\t\tdp[u][j]+=dp[v][j-1];\n\t}\n}\nvoid dfs2(int u,int fa)\n{\n\tfor(int i=head[u];i;i=e[i].next){\n\t\tint v=e[i].to;\n\t\tif(v==fa)continue;\n\t\tfor(int j=k;j>=2;--j)\n\t\t\tdp[v][j]-=dp[v][j-2];\n\t\tfor(int j=1;j<=k;++j)\n\t\t\tdp[v][j]+=dp[u][j-1];\n\t\tdfs2(v,u);\n\t}\n\n```\n\n##### \u6700\u540e\u628adp[i][1~k]\u7d2f\u52a0\u8d77\u6765\u5373\u53ef\u5176\u5b9e\u8fd9\u9898\u8fd8\u662f\u6709\u4e9b\u96be\u5ea6\u7684\uff0c\u4e3b\u8981\u662f\u5bb9\u65a5\u539f\u7406\u7684\u5e94\u7528\uff01\n\n# QWQ\n",
        "postTime": 1566287995,
        "uid": 134182,
        "name": "juruo_zjc",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3047 \u3010[USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows\u3011"
    },
    {
        "content": "\u633a\u4e0d\u9519\u7684\u4e00\u9053\u6811\u5f62dp\n\n\u7531\u4e8e\u65e2\u8981\u7edf\u8ba1\u6bcf\u4e2a\u8282\u70b9\u7684\u5b50\u6811\u8fd8\u8981\u7edf\u8ba1\u7236\u4eb2\u6765\u66f4\u65b0\u7b54\u6848\uff0c\u6240\u4ee5\u9700\u8981\u7279\u6b8a\u7684\u7b97\u6cd5\n\n\u7528dp[i][j][0]\u8868\u793a\u7ed3\u70b9i\u7684\u5b50\u6811\u4e2d\u4e0ei\u8ddd\u79bb<=j\u7684\u7ed3\u70b9\u6743\u503c\u4e4b\u548c\uff08\u5305\u62eci\u7ed3\u70b9\u6743\u503c\uff09\n\n\u7528dp[i][j][1]\u8868\u793a\u5bf9\u4e8e\u8be5\u70b9\u7236\u8282\u70b9\uff0c\u4e0d\u7ba1\u8be5\u8282\u70b9\u53ea\u7ba1\u5176\u5b83\u5b50\u8282\u70b9\u65f6\u8ddd\u79bb<=j-1\u7684\u725b\u7684\u4e2a\u6570\n\n\u7a0d\u5fae\u7528\u4e00\u70b9\u5bb9\u65a5\u6765\u89e3\u51b3\u72b6\u6001\u8f6c\u79fb\uff1a dp[v][k][1]=dp[u][k-1][0]-dp[v][k-2][0]; (v\u662fu\u7684\u5b50\u8282\u70b9)\n\n\u6700\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9\uff0c\u5faa\u73af\u4e0d\u65ad\u627e\u7236\u4eb2\uff0c\u7edf\u8ba1\u725b\u7684\u6570\u91cf\n\n\n\n \n```cpp\n//2591 [Usaco 2012 Feb]Nearby Cows\n#include<iostream>\n#include<vector>\n#include<cstdio>\n#include<cstring>\n#include<cstdlib>\n#include<algorithm>\n#define ll long long\n#define fo(i,j,k) for(int i=j;i<=k;i++)\nusing namespace std;\nconst int mxn=100005;\nint ans[mxn],head[mxn],father[mxn];\nint dp[mxn][22][2];  //0\u8868\u793a\u53ea\u7ba1\u5b50\u6811\uff0c1\u8868\u793a\u8be5\u70b9\u7236\u8282\u70b9\u4e2d\uff0c\u4e0d\u7ba1\u8be5\u8282\u70b9\u65f6\u53ea\u7ba1\u5176\u5b83\u5b50\u8282\u70b9\u65f6\u9644\u8fd1\u725b\u7684\u4e2a\u6570 \nint n,m,cnt;\nstruct edge {int to,next;} f[mxn<<1];\ninline void add(int u,int v)\n{\n    f[++cnt].to=v;f[cnt].next=head[u];head[u]=cnt;\n}\ninline void dfs(int u,int fa)\n{\n    int i,j,k,sum=0;\n    father[u]=fa;\n    fo(k,1,m) dp[u][k][0]=dp[u][0][0];\n    for(i=head[u];i;i=f[i].next)\n    {\n        int v=f[i].to;\n        if(v==fa) continue;\n        dfs(v,u);\n        fo(k,1,m) dp[u][k][0]+=dp[v][k-1][0];\n    }\n    for(i=head[u];i;i=f[i].next)\n    {\n        int v=f[i].to;\n        if(v==fa) continue;\n        dp[v][1][1]=dp[u][0][0]; \n        fo(k,2,m) dp[v][k][1]=dp[u][k-1][0]-dp[v][k-2][0];\n    }\n}\nint main()\n{\n    int u,v;\n    scanf(\"%d%d\",&n,&m);\n    fo(i,2,n)\n    {\n        scanf(\"%d%d\",&u,&v);\n        add(u,v),add(v,u);\n    }\n    fo(i,1,n) scanf(\"%d\",&dp[i][0][0]);\n    dfs(1,0);\n    fo(i,1,n)  //\u679a\u4e3e\u8bd5\u70b9 \n    {\n        ans[i]=dp[i][m][0];\n        int u=i,v;\n        fo(j,1,m)\n        {\n            ans[i]+=dp[u][m-j+1][1];\n            u=father[u];\n            if(!u) break;\n        }\n    } \n    fo(i,1,n) printf(\"%d\\n\",ans[i]);\n    return 0;\n}\n```",
        "postTime": 1478669859,
        "uid": 19075,
        "name": "panda_eater",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3047 \u3010[USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows\u3011"
    },
    {
        "content": "### \u6811\u5f62dp\u9898\u3002\u3002\n\n\n\n**\u8003\u8651\u4e24\u904ddfs\uff0c\u4e00\u6b21\u4ece\u7edf\u8ba1\u4ece\u7236\u4eb2\u51fa\u53bb\u7684\u70b9\u6743\uff0c \u4e00\u6b21\u4ece\u5b69\u5b50\u51fa\u53bb\u7684\u70b9\u6743\u3002**\n\n1. \u72b6\u6001\u91cf\u3002\n\n\u8bbe\u7531\u9898\u95ee\uff0c $f[i][j]$\u8868\u793a\u8ddd\u79bb$i$\u4e3a$j$\u7684\u70b9\u6743\u4e4b\u548c,  $d[i][j]$\u8868\u793a\u8ddd\u79bb$i$\u4e3a$j$ \u4e14$j \\in Son_i$\u7684\u70b9\u6743\u4e4b\u548c\u3002\n\n2. dfs1\n\n\u6613\u77e5\uff0c\n$$f[i][j] = d[i][j] = \\sum_{k \\in Son_i}f[k][j - 1] $$\n\u5bb9\u6613\u7406\u89e3\uff0c\u4e0d\u591a\u8d58\u8ff0\u3002\n\n3. dfs2\n\n\u5bf9\u4e8e\u8282\u70b9$i$\u4e0e\u5176$cnt$\u8f88\u7956\u5148$t$\u4ee5\u53ca$cnt - 1$\u8f88\u7956\u5148$s$, \u9700\u8981\u7684\u662f\u5982\u56fe\u90e8\u5206:(\u610f\u4f1a\u5373\u53ef)\n![](https://cdn.luogu.com.cn/upload/image_hosting/wai0xrum.png)\n\u6240\u4ee5\u6211\u4eec\u6c42\u65f6\uff0c\u5c31\u52a0\u4e0a(\u4f8b\u5982)$d[1][j - cnt] - d[2][j - cnt - 1]$, \u5c31\u53ef\u8f7b\u677e\u6c42\u51fa\u6240\u9700\u5185\u5bb9\n\n4. cpp\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int maxn = 1e5 + 5;\nconst int maxk = 20 + 5; \nint n, k, f[maxn][maxk], d[maxn][maxk], fa[maxn];\nvector <int> e[maxn];\nvoid dfs1(int x, int father) {\n\tfor(int i = 0, y;i < e[x].size();i ++) {\n\t\ty = e[x][i];\n\t\tif(y ^ father) {\n\t\t\tdfs1(y, x); fa[y] = x;\n \t\t\tfor(int j = 1;j <= k;j ++) { \n\t\t\t\tf[x][j] += f[y][j - 1];\n\t\t\t}\n\t\t}\n\t}\n}\nvoid dfs2(int x, int father) {\n\tfor(int i = 0;i < e[x].size();i ++) {\n\t\tif(e[x][i] ^ father) dfs2(e[x][i], x);\n\t}\n\tfor(int j = 1;j <= k;j ++) {\n\t\tint cnt = 0, t = x, s;\t\n\t\twhile(cnt < j && fa[t]) {\n\t\t\tcnt ++, s = t, t = fa[t];\n\t\t\tf[x][j] += (d[t][j - cnt] - d[s][j - cnt - 1]);\n\t\t} \n\t}\n} \nsigned main() {\n\tcin >> n >> k; \n\tfor(int i = 1, x, y;i < n;i ++) {\n\t\tscanf(\"%lld%lld\", &x, &y);\n\t\te[x].push_back(y);\n\t\te[y].push_back(x);\t\t\t\n\t}\n\tfor(int i = 1;i <= n;i ++) {\n\t\tscanf(\"%lld\", &f[i][0]);\n\t}\n\tdfs1 (1, 0); fa[1] = 0;\n\tfor(int i = 1;i <= n;i ++) {\n\t\tfor(int j = 0;j <= k;j ++) {\n\t\t\td[i][j] = f[i][j];\n\t\t}\n\t}\n\tdfs2 (1, 0);\n\tfor(int i = 1;i <= n;i ++) {\n\t\tint res = 0;\n\t\tfor(int j = 0;j <= k;j ++) {\n\t\t\tres += f[i][j];\n\t\t}\n\t\tprintf(\"%lld\\n\", res);\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1576253493,
        "uid": 39993,
        "name": "\u5143\u5915",
        "ccfLevel": 0,
        "title": "P3047 [USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows"
    },
    {
        "content": "\u6211\u8fd9\u91cc\u63a8\u8350\u4e00\u4e0b[\u6211\u7684\u535a\u5ba2](https://www.luogu.org/blog/szr666--blog/)\n\n\u5728\u535a\u5ba2\u91cc\u89c2\u770b\u66f4\u7f8e\u89c2\u54e6~\n\n[\u9898\u76ee](https://www.luogu.org/problemnew/show/P3047)\n------------\n\n\n------------\n\n\u534e\u4e3d\u7684\u5206\u5272\u7ebf\n# \u89e3\u6790\n\u8bf4\u4e00\u4e0b\u672c\u849f\u84bb\u7684\u505a\u6cd5\n\n### \u641c\u7d22\n\n\u5bf9\u4e8e\u6811\u5f62$dp$,\u5f53\u7136\u8981\u641c\u7d22,\u5219\u5148\u8bbe\u4ee5$1$\u4e3a\u6839\n\n\u5bf9\u4e8e\u6bcf\u7b2c$i$\u70b9\u6c42\u51fa$dp[i][j]$,\u8868\u793a\u4ee5$i$\u4e3a\u6839\u4e14\u6df1\u5ea6\u4e0d\u8d85\u8fc7$j$\u7684\u5b50\u6811\u548c,\n\n\u5219$dp[i][j]=dp[i][0]+\\sum\\limits_{u\\in son}dp[u][j-1]$,$son$\u4e3a\u5b50\u8282\u70b9\u96c6\u5408\n\n\u987a\u4fbf\u628a\u5404\u8282\u70b9\u7684\u7236\u8282\u70b9$fa$\u6c42\u51fa\u6765,\u5219$dp[1][k]$\u4e3a$1$\u7684\u7b54\u6848\n\n### \u8f6c\u79fb\n\n\u5bf9\u4e8e\u7b2c$i$\u4e2a\u70b9\u6765\u8bf4,$dp$\u6570\u7ec4\u53ea\u8bb0\u5f55\u4e86\u5b83\u4e0b\u9762\u8ddd\u79bb\u4e3a$k$\u7684\u548c\n\n\u53ef\u4ee5\u5411\u4e0a\u8d70\u5230\u67d0\u4e00\u4e2a\u7956\u5b97,\u518d\u4ece\u7956\u5b97\u8d70\u5230\u53e6\u4e00\u68f5\u5b50\u6811,\u4e14\u6ee1\u8db3\u6761\u4ef6\n\n\u82e5\u67d0\u4e2a\u7956\u5b97\u8ddd\u79bb\u7b2c$i$\u4e2a\u70b9$j$\u6b65,\u5982\u56fe\u6240\u793a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/z9oi67z4.png)\n\n$ans[i]$\u5148\u7b49\u4e8e$dp[i][k]$,\u8fd8\u9700\u52a0\u4e0a\u8ddd\u79bb\u4e3a$j($\u5c0f\u4e8e\u7b49\u4e8e$k)$\n\u7684\n\n\u7956\u5148\u7684\u5176\u5b83\u5b50\u6811,\u8fd9\u91cc\u6211\u8bf4\u7684\u5176\u5b83\u5b50\u6811\u6307\u4e0d\u5305\u542b\u70b9$i$\u7684\u5b50\u6811\n\n\u5148\u679a\u4e3e$j$,\u8bbe\u7956\u5148\u4e3a$f$,\u5219$ans[i]+=dp[f][k-j]$\n\n\u56e0\u4e3a\u8fd9\u91cc\u7b97\u4e86\u5305\u542b$i$\u53ca\u5176\u67d0\u4e9b\u5728$f$\u4e0b\u9762\u7956\u5148\u7684\u5b50\u6811,\u5e94\u51cf\u53bb\n\n\u8bbe\u8ddd\u79bb$i$\u4e3a$j-1$\u7684\u7956\u5148\u4e3a$f'$,\u5219$ans[i]-=dp[f'][k-j-1]$\n\n\u56e0\u4e3a\u4e0d\u51cf\u4f1a\u628a$f'$\u7684\u5176\u5b83\u5b50\u6811\u518d\u52a0\u4e00\u904d,\u4f46\u5728\u679a\u4e3e$j-1$\u65f6\u5df2\u52a0\u5b8c\n\n\u540c\u65f6\u4e5f\u4f1a\u628a$f'$\u5230$i$\u94fe\u4e0a\u7684\u67d0\u4e9b\u70b9\u52a0\u8fdb\u6765,\u5148\u90fd\u51cf\u53bb\n\n\u6700\u540e\u518d\u628a\u5176\u7956\u5148\u4e0e$i$\u94fe\u4e0a\u7684\u503c\u52a0\u4e00\u4e0b,\u628a\u4e4b\u524d\u7684\u8865\u56de\u6765\n\n\u56e0\u4e3a\u5df2\u7ecf\u5904\u7406\u8fc7$fa$\u6570\u7ec4,\u6240\u4ee5\u76f4\u63a5\u679a\u4e3e$j$,\u4e0d\u65ad\u6c42$f'$\u548c$f$\u5373\u53ef\n\n# \u4ee3\u7801\n\n```cpp\n#include<cstdio>\nusing namespace std;\nvoid read(int &x)\n{\n\tx=0;\n\tint f;\n\tf=1;\n\tchar c;\n\tc=getchar();\n\twhile((c<'0'||c>'9')&&c!='-')\n\t{\n\t\tc=getchar();\n\t}\n\tif(c=='-')\n\t{\n\t\tf=-1;\n\t\tc=getchar();\n\t}\n\twhile(c>='0'&&c<='9')\n\t{\n\t\tx=(x<<3)+(x<<1)+(c^48);\n\t\tc=getchar();\n\t}\n\tx=x*f;\n}\nconst int N=110000;\nstruct node\n{\n\tint to;\n\tint next;\n};\nnode e[N*2];\nint head[N],etot;\nvoid add(int x,int y)\n{\n\tetot++;\n\te[etot].to=y;\n\te[etot].next=head[x];\n\thead[x]=etot;\n}\nint dp[N][30];\nint fa[N];\nint ans[N];\nvoid dfs(int x,int ffa)\n{\n\tint i,j;\n\tfor(j=1;j<=20;j++)\n\t{\n\t\tdp[x][j]=dp[x][0];\n\t}\n\tfor(i=head[x];i!=0;i=e[i].next)\n\t{\n\t\tif(e[i].to!=ffa)\n\t\t{\n\t\t\tdfs(e[i].to,x);\n\t\t\tfa[e[i].to]=x;\n\t\t\tfor(j=1;j<=20;j++)\n\t\t\t{\n\t\t\t\tdp[x][j]+=dp[e[i].to][j-1];\n\t\t\t}\n\t\t}\n\t}\n}\nint main()\n{\n\tint n,i,x,y,k,j;\n\tread(n);\n\tread(k);\n\tfor(i=1;i<=n-1;i++)\n\t{\n\t\tread(x);\n\t\tread(y);\n\t\tadd(x,y);\n\t\tadd(y,x);\n\t}\n\tfor(i=1;i<=n;i++)\n\t{\n\t\tread(dp[i][0]);\n\t}\n\tdfs(1,0);\n\tfor(i=1;i<=n;i++)\n\t{\n\t\tans[i]=dp[i][k];\n\t\tx=i;\n\t\tfor(j=1;j<=k-1&&x!=1;j++)\n\t\t{\n\t\t\ty=fa[x];\n\t\t\tans[i]+=dp[y][k-j]-dp[x][k-j-1];\n\t\t\tx=y;\n\t\t}\n\t\tif(x!=1)\n\t\t{\n\t\t\tans[i]+=dp[fa[x]][0];\n\t\t}\n\t}\t\n\tfor(i=1;i<=n;i++)\n\t{\n\t\tprintf(\"%d\\n\",ans[i]);\n\t}\n}\n```\n",
        "postTime": 1572343669,
        "uid": 129849,
        "name": "szr666",
        "ccfLevel": 4,
        "title": "\u7701\u9009NOI-\u4e13\u9898[\u6811\u5f62dp]\uff1a P3047 [USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows"
    },
    {
        "content": "### [\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3047)\n\n## \u524d\u7f6e\u77e5\u8bc6\n\n\u6811\u5f62DP\u3001\u5bb9\u65a5\uff08\u53ef\u4ee5\u4e0d\u8981\uff09\u3002\n\n## \u9898\u610f\u7b80\u8ff0\n\n- \u7ed9\u5b9a\u4e00\u68f5\u6811\uff0c\u6bcf\u4e2a\u70b9\u6709\u70b9\u6743\u3002\n\n- \u95ee\u5728\u79bb\u6bcf\u4e2a\u8282\u70b9\u8ddd\u79bb\u4e0d\u8d85\u8fc7\u67d0\u5b9a\u503c\u7684\u70b9\u6743\u548c\u3002\n\n# \u6811\u5f62DP\n\n\u9996\u5148\uff0c$n$ \u4e2a\u70b9 $n-1$ \u6761\u8fb9\u7684\u8fde\u901a\u56fe\u662f**\u6811**\u3002\n\n\u6211\u4eec\u4ee51\u53f7\u8282\u70b9\u4e3a\u6839\uff08\u65b9\u4fbf\uff09\u3002\n\n\u5b9a\u4e49 $f_{i,j}$ \u4e3a\u79bb $i$ \u8282\u70b9 $j$ \u8ddd\u79bb\u7684\u70b9\u6743\u548c\u3002\n\n\u6211\u4eec\u5f88\u5bb9\u6613\u5904\u7406\u4ed6\u5b50\u6811\u5185\u7684\u60c5\u51b5\uff0c\u53ea\u9700\u9012\u5f52\u8fed\u4ee3\u5373\u53ef\u3002\n\n```cpp\nvoid dfs(ll x){\n\tvst[x]=1;\n    for(ll i=hd[x];i;i=es[i].nxt)\n        if(!vst[es[i].t]){\n        \tdfs(es[i].t);\n        \tfor(ll j=1;j<=k;j++) f[x][j]+=f[es[i].t][j-1];\n\t\t}\n}\n```\n\n\u800c\u6211\u4eec\u8fd8\u8981\u5904\u7406\u4e0d\u5728\u4ed6\u5b50\u6811\u5185\u7684\u60c5\u51b5\u3002\n\n\u6211\u4eec\u4ece\u6839\u5f80\u53f6\u5b50\u5f00\u59cb\u3002\n\n\u9996\u5148\u6839\u4e0d\u9700\u8981\u5904\u7406\u3002\n\n\u5bf9\u6bcf\u4e2a\u5b83\u7684\u513f\u5b50\uff0c\u6211\u4eec\u52a0\u4e0a\u4ed6\u7236\u4eb2\u8ddd\u79bb\u51cf\u4e00\u7684\u70b9\u6743\u548c\u3002\n\n\u4f46\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u5b50\u6811\u5185\u7684\u8282\u70b9\u4e5f\u5728\u91cc\u9762\u3002\n\n\u6240\u4ee5\u6211\u4eec**\u5148**\u901a\u8fc7\u5bb9\u65a5\u628a\u5b50\u6811\u5185\u7684\u51cf\u6389\u3002\n\n\u4e5f\u5c31\u662f\u6bcf\u4e2a\u8ddd\u79bb\u51cf\u6389\u4ed6\u8ddd\u79bb-2\u7684\u3002\n\n```cpp\nvoid dfs2(ll x){\n\tvis[x]=1;\n\tfor(ll i=hd[x];i;i=es[i].nxt)\n\t\tif(!vis[es[i].t]){\n\t\t\tfor(ll j=k;j>=2;--j) f[es[i].t][j]-=f[es[i].t][j-2];\n\t\t\tfor(ll j=1;j<=k;++j) f[es[i].t][j]+=f[x][j-1];\n\t\t\tdfs2(es[i].t);\n\t}\n}\n```\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(nk)$\uff0c\u6bcf\u6b21\u9012\u5f52\u6216\u9012\u63a8\u7ecf\u8fc7 $n$ \u4e2a\u8282\u70b9\uff0c\u6bcf\u6b21\u66f4\u65b0\u64cd\u4f5c $k$ \u6b21\u3002\n\n```cpp\n/*\n***\n\u8fd8\u8981\u7ee7\u7eed\u52aa\u529b\n\u6210\u4e3a\u4e00\u540d\u70e4\u5495\u5b66\u5bb6\u54e6\n***\n*/\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll N=1e5+5;\nll n,k,tot,hd[N],vst[N],cnt,f[N][25],ans,rt,vis[N];\nstruct edge{ll t,nxt;}es[N<<2];\ntemplate <typename T> void rd(T &x){\n\tll fl=1;x=0;char c=getchar();\n\tfor(;!isdigit(c);c=getchar()) if(c=='-') fl=-fl;\n\tfor(;isdigit(c);c=getchar()) x=(x<<3)+(x<<1)+c-'0';\n\tx*=fl;\n}\nvoid wr(ll x){\n\tif(x<0) x=-x,putchar('-');\n\tif(x<10) putchar(x+'0');\n\tif(x>9) wr(x/10),putchar(x%10+'0');\n}\nvoid add(ll u,ll v){\n    es[++tot]=(edge){v,hd[u]},hd[u]=tot;\n}\nvoid dfs(ll x){\n\tvst[x]=1;\n    for(ll i=hd[x];i;i=es[i].nxt)\n        if(!vst[es[i].t]){\n        \tdfs(es[i].t);\n        \tfor(ll j=1;j<=k;j++) f[x][j]+=f[es[i].t][j-1];\n\t\t}\n}\nvoid dfs2(ll x){\n\tvis[x]=1;\n\tfor(ll i=hd[x];i;i=es[i].nxt)\n\t\tif(!vis[es[i].t]){\n\t\t\tfor(ll j=k;j>=2;--j) f[es[i].t][j]-=f[es[i].t][j-2];\n\t\t\tfor(ll j=1;j<=k;++j) f[es[i].t][j]+=f[x][j-1];\n\t\t\tdfs2(es[i].t);\n\t}\n}\nint main(){\n//\tfreopen(\".in\",\"r\",stdin);\n//\tfreopen(\".out\",\"w\",stdout);\n\trd(n);rd(k);rt=1;\n\tfor(ll i=1,u,v;i<n;i++){\n\t\trd(u);rd(v);\n\t\tadd(u,v);\n\t\tadd(v,u);\n\t}\n\tfor(ll i=1;i<=n;i++) rd(f[i][0]);\n\tdfs(rt);\n\tdfs2(rt);\n\tfor(ll i=1;i<=n;i++){\n\t\tll sum=0;\n\t\tfor(ll j=0;j<=k;j++) sum+=f[i][j];\n\t\twr(sum);puts(\"\");\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1583971613,
        "uid": 83999,
        "name": "Demoe",
        "ccfLevel": 7,
        "title": "Nearby Cows\u9898\u89e3 \u6811\u5f62DP"
    },
    {
        "content": "\u5206\u4eab\u4e00\u79cd\u5947\u5999\u7684\u89e3\u6cd5\uff1b\uff08\u4e5f\u4e0d\u6e05\u695a\u6709\u6ca1\u6709\u4eba\u5199\u8fc7emm\uff09\n\u9996\u5148\uff0c\u5bf9\u4e8e\u6811\u4e0a\u7684\u4efb\u610f\u4e00\u4e2a\u70b9x\uff0c\u5b83k\u6b65\u4ee5\u5185\u80fd\u591f\u5230\u8fbe\u7684\u70b9\u5206\u4e3a3\u79cd\u60c5\u51b5\uff1a\n\n1\uff1a\u5f53\u524d\u8282\u70b9\u6b63\u4e0b\u65b9\u7684\u70b9\uff0c\u5982\u5b83\u7684\u513f\u5b50\u548c\u5b83\u513f\u5b50\u7684\u513f\u5b50\uff1b\n\n\u6211\u4eec\u5c06x\u6070\u597dj\u6b65\u6240\u80fd\u5230\u8fbe\u7684\u6b64\u7c7b\u8282\u70b9\u7684\u6743\u503c\u548c\u8bb0\u4f5cf1[x][j];\n\n2\uff1a\u5f53\u524d\u8282\u70b9\u6b63\u4e0a\u65b9\u7684\u70b9\uff0c\u5982\u5b83\u7684\u7236\u4eb2\u548c\u5b83\u7236\u4eb2\u7684\u7236\u4eb2\uff1b\n\n\u6211\u4eec\u5c06x\u6070\u597dj\u6b65\u6240\u80fd\u5230\u8fbe\u7684\u6b64\u7c7b\u8282\u70b9\u7684\u6743\u503c\u548c\u8bb0\u4f5cf2[x][j];\n\n3\uff1a\u5f53\u524d\u8282\u70b9\u7684\u65c1\u7cfb\u8840\u4eb2,\u5982\u6211\u7236\u4eb2\u7684\u53e6\u4e00\u4e2a\u513f\u5b50\uff0c\u6211\u7956\u5148\u7684\u53e6\u4e00\u4e2a\u540e\u4ee3\u7b49\uff1b\n\n\u6211\u4eec\u5c06x\u6070\u597dj\u6b65\u6240\u80fd\u5230\u8fbe\u7684\u6b64\u7c7b\u8282\u70b9\u7684\u6743\u503c\u548c\u4e5f\u8bb0\u5728f2[x][j]\u91cc;\uff08\u7406\u7531\u7b49\u4e0b\u518d\u505a\u8ba8\u8bba\uff09\n\n\u663e\u7136\uff0c\u7b2c\u4e00\u79cd\u548c\u7b2c\u4e8c\u79cd\u60c5\u51b5\u53ef\u4ee5DFS\u548cBFS\u76f4\u63a5\u6c42\uff1b\n\n\u90a3\u4e48\uff0c\u73b0\u5728\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u5982\u4f55\u6c42\u5b83\u7684\u65c1\u7cfb\u8840\u4eb2\uff0c\u5373\u540cx\u4e0d\u5728\u4e00\u6761\u94fe\u4e0a\u7684\u5bf9\u7b54\u6848\u6709\u8d21\u732e\u7684\u70b9\uff1b\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u5f53\u524d\u8282\u70b9\u80fd\u901a\u8fc7\u5b83\u7684\u6b63\u4e0a\u65b9\u7684\u8282\u70b9\uff0c\u4e5f\u5c31\u662f\u5b83\u7684\u76f4\u7cfb\u7956\u5148\uff08\u6211\u4eec\u5148\u8bb0\u4f5cfa[x]\uff09\uff0c\u5230\u8fbe\u5b83\u7684\u65c1\u7cfb\u8840\u4eb2\uff1bfa[x]\u4e5f\u5fc5\u7136\u80fd\u591f\u5230\u8fbe\u8fd9\u4f4d\u65c1\u7cfb\u8840\u4eb2\uff1b\u90a3\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u8fdb\u884c\u5bf9tip2\u7684\u6c42\u89e3\u65f6\u987a\u8def\u4f20\u9012\u4e0b\u6765\u4e86\uff1b\uff08\u8fd9\u5c31\u662f\u6211\u4eec\u5c06tip2\u4e0etip3\u7edf\u4e00\u7528f2\u8bb0\u5f55\u7684\u539f\u56e0\uff09\uff1b\n\n\u65e2\u7136\u8fd9\u6837\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ea\u8981\u6c42x\u7236\u4eb2\u7684\u5176\u5b83\u5b50\u6811\u4e2d\u6ee1\u8db3\u6761\u4ef6\u7684\u8282\u70b9\u4e86\uff0c\u5373x\u7684\u5144\u5f1f\u8282\u70b9\u3002\n\n\u6211\u4eec\u7528y\u8868\u793a\u53e6\u4e00\u4f4d\u5144\u5f1f\u8282\u70b9\uff0c\u56e0\u4e3ax\u8981\u5148\u5230x\uff0cy\u7684\u7236\u4eb2fa[x]\uff0c\u518d\u8d70\u5230y\uff0c\u8fd9\u91cc\u8981\u6d88\u80172\u6b65\u7684\u8ddd\u79bb\uff0c\u90a3\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5c31\u987a\u7406\u6210\u7ae0\u7684\u51fa\u6765\u4e86\uff1a\nf2[x][j]+=f2[y][j-2];\n\n\u5982\u6b64\u8fd9\u822c\uff0c\u5728\u6700\u540e\u8f93\u51fa\u7b54\u6848\u65f6\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8ba1\u7b97\n\n$sum_{i}=\\sum_{j=0,j\\le k}f1[i][j]+f2[i][j]$\n\n\u7136\u540esum\u8fd8\u9700\u8981-=f1[i][0];\u56e0\u4e3a\u6211\u4eec\u7ed9f1[i][0],f2[i][0]\u90fd\u8d4b\u503c\u4e3ac[i];\u5728\u8fd9\u91cc\u88ab\u8ba1\u7b97\u4e86\u4e24\u6b21\uff0c\u9700\u8981\u53bb\u91cd\uff1b\n\u628a\u6bcf\u4e00\u4e2ai\u7684sum\u4f9d\u6b21\u8f93\u51fa\u5c31\u884c\u4e86\uff1b\n\n\u503c\u5f97\u6ce8\u610f\u7684\u4e00\u70b9\u662f\u67d0\u4e9b\u6bd2\u7624\u6570\u636e\uff0c\u76f4\u63a5\u7b97\u4f1a\u88ab\u5361\u7206\uff0c\u6211\u4eec\u53ef\u4ee5\u52a0\u5165\u4e00\u4e9b\u4f18\u5316\uff1b\u6211\u7684\u505a\u6cd5\u662f\u5904\u7406\u51fa\u4e00\u4e2amaxdep;\n\u5982\u679c$2maxdep-1<=k$\u6b64\u65f6\u6bcf\u4e2a\u70b9\u5fc5\u7136\u80fd\u5230\u8fbe\u6240\u4ee5\u7684\u70b9\u56e0\u4e3a\u4f60\u4ece\u4e00\u4e2a\u6df1\u5ea6\u6700\u5927\u70b9\u5230\u6839\u518d\u5230\u53e6\u4e00\u4e2a\u6df1\u5ea6\u6700\u5927\u70b9\u9700\u8981\u7684\u8ddd\u79bb\uff082maxdqp-1\uff09\u90fd\u5728k\u7684\u8303\u56f4\u4ee5\u5185\uff0c\u90a3\u4e48\u6240\u4ee5\u7684\u70b9\u663e\u7136\u53ef\u4ee5\u4e92\u76f8\u5230\u8fbe\uff1b\n\n\u4ee5\u4e0b\u662fAC\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define N 100001\nusing namespace std;\ninline void read(int &x){\n\tint datta=0;char chchc=getchar();bool okoko=0;\n\twhile(chchc<'0'||chchc>'9'){if(chchc=='-')okoko=1;chchc=getchar();}\n\twhile(chchc>='0'&&chchc<='9'){datta=datta*10+chchc-'0';chchc=getchar();}\n\tx=okoko?-datta:datta;\n}\nint n,k,a,b,cnt,head[N],nxt[N<<1],to[N<<1];\nint root=1,f1[N][21],f2[N][21],fa[N],nn[N];\nint mmx,ssum,dep[N];\nvoid link(int a,int b){\n\tto[++cnt]=b,nxt[cnt]=head[a],head[a]=cnt;nn[a]++;\n}\nvoid get_ans1(int x,int last){\n\tdep[x]=dep[last]+1;\n\tif(dep[x]>mmx)mmx=dep[x];\n\tfor(int i=head[x];i;i=nxt[i]){\n\t\tif(to[i]!=last){\n\t\t\tget_ans1(to[i],x);\n\t\t\tfor(int j=1;j<=k;j++)\n\t\t\t\tf1[x][j]+=f1[to[i]][j-1];\n\t\t}\n\t}\n}\nvoid get_ans2(int x,int last){\n\tint p[nn[x]];int tot=0;\n\tfor(int i=head[x];i;i=nxt[i]){\n\t\tif(to[i]!=last){\n\t\t\tp[++tot]=to[i];\n\t\t\tget_ans2(to[i],x);\n\t\t}\n\t}\n\tfor(int i=1;i<=tot;i++){\n\t\tfor(int j=1;j<=tot;j++){\n\t\t\tif(i!=j){\n\t\t\t\tfor(int l=2;l<=k;l++)\n\t\t\t\t\tf2[p[i]][l]+=f1[p[j]][l-2];\n\t\t\t}\n\t\t}\n\t}\n}\nvoid get_ans3(int x,int last){\n\tfor(int i=head[x];i;i=nxt[i]){\n\t\tif(to[i]!=last){\n\t\t\tfor(int j=1;j<=k;j++)\n\t\t\t\tf2[to[i]][j]+=f2[x][j-1];\n\t\t\tget_ans3(to[i],x);\n\t\t}\n\t}\n}\n\nint main(){\n\tread(n),read(k);\n\tfor(int i=1;i<n;i++){\n\t\tread(a),read(b);\n\t\tlink(a,b),link(b,a);\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tread(f1[i][0]);\n\t\tf2[i][0]=f1[i][0];\n\t\tssum+=f1[i][0];\n\t} \n\tget_ans1(root,0);\n\tif((mmx<<1)-1<=k){\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tprintf(\"%d\\n\",ssum);\n\t\t\t\n\t\t}return 0;\n\t}\n\tget_ans2(root,0);\n\tget_ans3(root,0);\n\tfor(int i=1;i<=n;i++){\n\t\tint sum=0;\n\t\tfor(int j=0;j<=k;j++)\n\t\t\tsum+=f1[i][j]+f2[i][j];\n\t\tsum-=f1[i][0];\n\t\tprintf(\"%d\\n\",sum);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1562039760,
        "uid": 73312,
        "name": "\u5929\u56fd\u7684\u9017\u6bd4",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P3047 \u3010[USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows\u3011"
    },
    {
        "content": "    \u9996\u5148\u8fd9\u662f\u4e00\u9053\u5f88\u660e\u663e\u7684\u6811\u5f62dp\uff0c\u8bfb\u5b8c\u9898\u601d\u8003\u4e00\u4e0b\u5c31\u53ef\u4ee5\u77e5\u9053\u5927\u81f4\u7684\u601d\u8def\u4e86\uff0c\u4f46\u6211\u5728\u8fd9\u4e00\u9898\u4e0a\u8fd8\u662f\u5361\u4e86\u5f88\u957f\u65f6\u95f4\u3002\n\n------------\n1. \u5c06\u6bcf\u4e2a\u70b9\u5206\u4e24\u6b65\u6765\u770b \u8003\u8651\uff1a\n\n   \u5bf9\u4e8e\u7b2ci\u4e2a\u70b9\uff0c\u5728\u5176k\u6b65\u8303\u56f4\u5185\u7684\u70b9\uff0c\u8981\u4e48\u5728\u5176\u5b50\u6811\u5185\uff0c\u8981\u4e48\u5728\u5b83\u7684\u7236\u4eb2\u53ca\u4ee5\u4e0a\u3002\n\n   **dp[i][j]** \u8868\u793a\u5bf9\u4e8e\u7b2ci\u4e2a\u70b9\uff0c\u8ddd\u79bb\u5b83\u8ddd\u79bb\u4e3aj\u7684\u70b9\u4e0a\u7684\u725b\u7684\u603b\u6570\n  \n2. \u7b2c\u4e00\u6b65\uff0c\u5bf9\u4e8e\u5176\u5b50\u6811\u8303\u56f4\u5185\u7684\u70b9\uff08\u7531\u5b50\u8282\u70b9v\u8f6c\u79fb\u5230\u7236\u8282\u70b9u\uff09\n   \n   \u663e\u7136 \u901a\u8fc7\u6df1\u641c\u7b80\u5355dp\u4e00\u4e0b\u5c31\u597d\u4e86\uff0c\u89c1\u4ee3\u7801\u4e2d\u7684dfs\n   \n   **$dp[u][j]+=dp[v][j-1]$**\n \n3. \u7b2c\u4e8c\u6b65\uff0c\u5bf9\u4e8e\u5176\u4e0a\u65b9\u7684\u70b9\uff08\u7528\u7236\u8282\u70b9u\u8f6c\u79fb\u5230\u5b50\u8282\u70b9v\uff09\n   \n   \u96be\u9053\u5c31\u662f\u7b80\u5355\u5730 $dp[v][j]+=dp[u][j-1]$\uff1f\u9519\u4e86\uff01\n   \n   \u90a3\u8be5\u600e\u4e48\u529e\u5462\uff1f\u6211\u60f3\u4e86\u5f88\u4e45\uff0c~~\u60f3\u5230\u4e86\u4e00\u4e2a\u65b9\u6848~~\uff0c\u8981\u8bb0\u5f55\u8def\u5f84\uff0c\u4f46\u4e5f\u4ec5\u4ec5\u662f20\u5206\n   \n   \u4e8e\u662f\uff0c\u6211\u5c1d\u8bd5\u5728\u9519\u8bef\u7684\u72b6\u6001\u8f6c\u79fb\u4e0a\u7a0d\u52a0\u4fee\u6539\uff0c\u53ea\u8981\u5220\u9664\u4e0a\u9762\u4e24\u4e2a\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e2d\u91cd\u590d\u7684\u90e8\u5206\u5c31\u597d\u5566\uff0c\u800c\u5bf9\u4e8e$dp[v][j]$\uff0c\u5176\u91cd\u590d\u7684\u90e8\u5206\u5c31\u662f$dp[v][j-2]$(\u591a\u753b\u51e0\u4e2a\u56fe\u7406\u89e3\u4e00\u4e0b)\n   \n4. \u8d34\u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint d[100010][30],k,head[100010],sum[100010],tot,n,c[100010],x,y;\nstruct node\n{\n    int v,nex;\n}e[200020];\ninline void add(int u,int v)\n{\n    tot++;\n    e[tot].v=v;\n    e[tot].nex=head[u];\n    head[u]=tot;\n}\ninline void dfs(int u,int fa)\n{\n    d[u][0]+=c[u];\n    for (int i=head[u];i;i=e[i].nex)\n    {\n        int v=e[i].v;\n        if (v==fa) continue;\n        dfs(v,u);\n        for (int j=0;j<k;j++)\n          d[u][j+1]+=d[v][j];\n    }\n}\ninline void dfs2(int u,int fa)\n{\n    for (int i=head[u];i;i=e[i].nex)\n    {\n        int v=e[i].v;\n        if (v==fa) continue;\n        \n        for (int j=k;j>=2;j--)\n            d[v][j]-=d[v][j-2];\n        for (int j=1;j<=k;j++) \n            d[v][j]+=d[u][j-1];\n        \n        dfs2(v,u);\n    }\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&k);\n    for (int i=1;i<n;i++)\n    {\n        scanf(\"%d%d\",&x,&y);\n        add(x,y);add(y,x);\n    }\n    for (int i=1;i<=n;i++) scanf(\"%d\",&c[i]);\n    dfs(1,0);\n    dfs2(1,0);\n    for (int i=1;i<=n;i++)\n      for (int j=0;j<=k;j++) \n      sum[i]+=d[i][j];\n    for (int i=1;i<=n;i++) printf(\"%d\\n\",sum[i]);\n    return 0;\n}\n```\n   \n   \n   \n   \n   ",
        "postTime": 1543754698,
        "uid": 40780,
        "name": "Forever_Lin",
        "ccfLevel": 0,
        "title": "P3047 [USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows"
    },
    {
        "content": "\u4e0d\u7528dfs\uff0c\u4e0d\u7528\u540e\u5411\u661f\uff0c200ms-\n\n\u8bb0\u5f55\u6bcf\u4e2a\u70b9\u8d70k\u6b65\u53ef\u4ee5\u5230\u7684\u70b9\u6743\u548c\uff0c\u6bcf\u6761\u5355\u5411\u8fb9\u65b9\u5411\u8d70k-1\u6b65\u53ef\u4ee5\u5230\u7684\u70b9\u6743\u548c\n\n\u5206\u522b\u662fC[n][k]\u548cE[n<<1].P[k]\n\n\u7136\u540e\u5c31\u662fdp\u65b9\u7a0b\u4e86:C[u][c]+=E[e].P[c]=C[v][c-1]-E[e^1].P[c-1];E[e]\u8868\u793au\u5230v\uff0cE[e^1]\u8868\u793av\u5230u,C[u][0]\u521d\u503c\u4e3a\u70b9\u6743\n\n\u53d1\u73b0\u6bcf\u6b21C\u3001E.P\u548c\u672c\u6b21\u7684\u5e76\u65e0\u5173\u7cfb\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u5faa\u73af\u8fb9\uff0c\u800c\u4e14\u53ea\u548c\u4e0a\u4e00\u6b21\u7684\u6709\u5173\u7cfb\uff0c\u6240\u4ee5\u53ef\u4ee5\u5faa\u73af\u538b\u7f29\uff0c\u7701\u7a7a\u95f4\uff0c\u56e0\u4e3a\u5faa\u73af\u8fb9\uff0c\u6240\u4ee5\u8fde\u540e\u5411\u661f\u4e5f\u4e0d\u7528\u4e86\n\n\u7b97\u4e0a\u8bfb\u5165\u4f18\u5316\u517126\u884c\n\n```cpp\n#include<cstdio>\nusing namespace std;\n#define fo(a,b,c) for(int a=b;a<=c;a++)\nint read(){\n    int a=0,f=0;char c=getchar();\n    for(;c<'0'||c>'9';c=getchar())if(c=='-')f=1;\n    for(;c>='0'&&c<='9';c=getchar())a=a*10+c-'0';\n    return f?-a:a;\n}\nconst int maxn=100001;\nstruct edge{int u,v,P[2][2];}E[maxn];\nint A[maxn],C[maxn][2];\nint main(){\n    int n=read(),k=read();\n    fo(i,2,n)E[i]=(edge){read(),read()};\n    fo(i,1,n)A[i]=C[i][0]=read();//\u4ee5\u4e0a\u8bfb\u5165\n    fo(i,1,k){//\u5faa\u73af\u6b65\u6570\n        fo(j,1,n)C[j][i&1]=A[j];\n        fo(j,2,n){//\u5faa\u73af\u8fb9\n            C[E[j].u][i&1]+=E[j].P[0][i&1]=C[E[j].v][i&1^1]-E[j].P[1][i&1^1];\n            C[E[j].v][i&1]+=E[j].P[1][i&1]=C[E[j].u][i&1^1]-E[j].P[0][i&1^1];\n        }//dp\n    }\n    fo(i,1,n)printf(\"%d\\n\",C[i][k&1]);\n    return 0;\n}\n```",
        "postTime": 1501158188,
        "uid": 12668,
        "name": "Minclxc",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3047 \u3010[USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows\u3011"
    },
    {
        "content": "\u8fd9\u9898\u5e94\u8be5\u7b97\u662f\u6bd4\u8f83\u5de7\u5999\u7684\u6362\u6839dp\uff08\u5f53\u7136\u4e5f\u53ef\u80fd\u662f\u6211\u7684\u505a\u6cd5\u6709\u70b9\u5047\uff09\n\n\u6700\u4e3b\u8981\u7684\u662f\u6211\u53d1\u73b0\u8fd9\u9898\u7684k\u503c\u975e\u5e38\u5c0f\uff0c\u5b8c\u5168\u53ef\u4ee5\u7ef4\u62a4\u4e00\u4e2ak\u500d\u7684\u989d\u5916\u7a7a\u95f4\u3002\n\n\u6240\u4ee5\u5f80\u8fd9\u65b9\u9762\u8003\u8651\uff0c\u4efb\u610f\u4e00\u4e2a\u70b9\u8ddd\u79bbk\u4ee5\u5185\u7684\u70b9\uff0c\u53ef\u4ee5\u62c6\u5206\u4e3a\u8be5\u70b9\u5b50\u6811\u4e0a\u7684\u70b9\u548c\u8be5\u70b9\u7236\u4eb2\u8282\u70b9\u65b9\u5411\u7684\u70b9\uff0c\u90a3\u4e48\u662f\u5426\u53ef\u4ee5\u5229\u7528\u7236\u4eb2\u8282\u70b9\u5462\uff1f\u5f53\u7136\u662f\u53ef\u4ee5\u7684\uff0c\u56e0\u4e3a\u5b50\u8282\u70b9\u548c\u7236\u4eb2\u8282\u70b9\u7684\u5dee\u5fc5\u7136\u662f1\uff0c\u90a3\u4e48\u53ef\u4ee5\u5229\u7528\u7236\u4eb2\u8282\u70b9\u8ddd\u79bbk-1\u4ee5\u5185\u7684\u70b9\uff0c\u518d\u52a0\u4e0a\u8be5\u70b9\u5b50\u6811\u4e0a**\u8ddd\u79bb\u4e3a**k-1\uff0c\u548c\u8ddd\u79bb\u4e3ak\u7684\u70b9\u5373\u53ef\uff08\u4ee5\u4e3a\u8fd9\u4e9b\u70b9\u8ddd\u79bb\u7236\u4eb2\u8282\u70b9\u7684\u8ddd\u79bb\u5927\u4e8ek-1\uff09\u3002\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u5f97\u5230\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n## **dp[i][j]=dp[fa[i]][j-1]+son[i][j]+son[i][j-1]**\n\ni\u4e3a\u5f53\u524d\u8282\u70b9\uff0cfa[i]\u4e3a\u7236\u4eb2\u8282\u70b9\uff0cj\u8868\u793a\u8ddd\u79bbj\u4ee5\u5185\u7684\u70b9\u7684\u6743\u503c\u548c\uff0cson\u8868\u793ai\u7684\u5b50\u6811\u4e0a\u8ddd\u79bbi\u4e3aj\u7684\u70b9\u7684\u6743\u503c\u548c\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u53ef\u4ee5\u7528\u7b2c\u4e00\u4e2adfs\u6765\u7ef4\u62a4fa\u6570\u7ec4\u548cson\u6570\u7ec4\uff0c\u53ea\u9700\u8981\u6bcf\u6b21\u5f80\u4e0a\u904d\u5386k\u4e2a\u7236\u4eb2\u8282\u70b9\u5373\u53ef\n\n```cpp\nson[x][0]=inp[x];\nint now=fa[x];\nfor(int i=1;i<=k;i++)\n{\n\tson[now][i]+=inp[x];\n\tnow=fa[now];\n}\n```\n\u7531\u4e8ek\u7684\u503c\u5f88\u5c0f\uff0c\u8fd9\u5b8c\u5168\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u3002\n\n\u63a5\u4e0b\u6765\u5728dfs2\u4e2d\u5229\u7528\u6362\u6839dp\u7684\u601d\u60f3\uff0c\u5145\u5206\u5229\u7528\u7236\u4eb2\u8282\u70b9\u4ee5\u53ca\u88ab\u7b97\u51fa\u6765\u7684\u503c\u548c\u4e4b\u524d\u7ef4\u62a4\u7684son\u6570\u7ec4\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u7ed3\u679c\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6O(kn)\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u628ak\u7406\u89e3\u6210\u5e38\u6570\uff0c\u590d\u6742\u5ea6\u5b9e\u9645\u4e0a\u5c31\u662fO(n)\u3002\n\n\u5b8c\u6574\u4ee3\u7801\u5982\u4e0b\n```cpp\n#include<iostream>\n#include<vector>\n#include<stdio.h>\nusing namespace std;\n#define ll long long\n#define N 100005\nvector<int>edge[N];\nint fa[N],inp[N];\nint son[N][25],dp[N][25];\nint n,k;\nvoid dfs1(int x)\n{\n\tson[x][0]=inp[x];\n\tint now=fa[x];\n\tfor(int i=1;i<=k;i++)\n\t{\n\t\tson[now][i]+=inp[x];\n\t\tnow=fa[now];\n\t}\n\tfor(int i=0;i<edge[x].size();i++)\n\t{\n\t\tint to=edge[x][i];\n\t\tif(to==fa[x])\n\t\t\tcontinue;\n\t\tfa[to]=x;\n\t\tdfs1(to);\n\t}\n}\nvoid dfs2(int x)\n{\n\tfor(int i=0;i<edge[x].size();i++)\n\t{\n\t\tint to=edge[x][i];\n\t\tif(to==fa[x])\n\t\t\tcontinue;\n\t\tdp[to][0]=inp[to];\n\t\tfor(int j=1;j<=k;j++)\n\t\t\tdp[to][j]=dp[x][j-1]+son[to][j]+son[to][j-1];\n\t\tdfs2(to);\n\t}\n}\nint main()\n{\n\tscanf(\"%d%d\",&n,&k);\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tint u,v;\n\t\tscanf(\"%d%d\",&u,&v);\n\t\tedge[u].push_back(v);\n\t\tedge[v].push_back(u);\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tscanf(\"%d\",&inp[i]);\n\tdfs1(1);\n\tdp[1][0]=inp[1];\n\tfor(int i=1;i<=k;i++)\n\t\tdp[1][i]=son[1][i]+dp[1][i-1];\n\tdfs2(1);\n\tfor(int i=1;i<=n;i++)\n\t\tprintf(\"%d\\n\",dp[i][k]);\n}\n```\n",
        "postTime": 1585539768,
        "uid": 140852,
        "name": "tyno\u590f",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3047 \u3010[USACO12FEB]Nearby Cows G\u3011"
    },
    {
        "content": "\u6811\u5f62dp + \u5bb9\u65a5\n\n\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u8bbe\u8ba1\u65b9\u7a0b$f(i,j)$\u4ee3\u8868\u7ed3\u70b9$i$\u5468\u56f4$j$\u6b65\uff08\u662f$j$\u6b65\u800c\u4e0d\u662f$j$\u6b65\u5185\uff09\u7684\u6240\u6709\u513f\u5b50\u548c\u3002\n\n\u4e8e\u662f\u8f6c\u79fb\u65b9\u7a0b\u663e\u7136\uff1a$f(i,j)=\\sum f(v,j-1)$\uff0c\u5176\u4e2d$v$\u4e3a$j$\u7684\u76f8\u90bb\u7ed3\u70b9\u3002\n\n\u4e0d\u8fc7\u663e\u7136\u662f\u6709\u91cd\u590d\u8bb0\u5f55\u7684\uff0c\u800c\u4e14\u4e0d\u597d\u679a\u4e3e\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4e00\u4e0b\u5bb9\u65a5\u539f\u7406\u3002\n\n\u9996\u5148\u6211\u4eec\u4ece\u4e0b\u5f80\u4e0a\u8f6c\u79fb\uff0c\u7528\u6240\u6709\u7684\u513f\u5b50\u6765\u8f6c\u79fb\u7236\u4eb2\uff0c\n\n\u7136\u540e\u518d\u4ece\u4e0a\u5f80\u4e0b\u8f6c\u79fb\uff0c\u7528\u6240\u6709\u7684\u7236\u4eb2\u6765\u8f6c\u79fb\u513f\u5b50\u3002\n\n\u7136\u540e\u663e\u7136\u5176\u4e2d\u662f\u6709\u91cd\u590d\u7684\u90e8\u5206\u7684\uff0c\u91cd\u590d\u5728\u54ea\u91cc?\n\n\u6211\u4eec\u8003\u8651\u6211\u4eec\u5728\u8f6c\u79fb\u7ed3\u70b9$v$\u7684\u65f6\u5019\uff0c\u4ed6\u7684\u5b50\u8282\u70b9\u662f\u5148\u8f6c\u79fb\u8fc7\u4e00\u904d\u7684\uff0c\u4e5f\u5c31\u662f\u4ee5\u4ed6\u4e3a\u6839\u7684\u5b50\u6811\u4e2d$k$\u6b65\u5185\u7684\u7ed3\u70b9\u5df2\u7ecf\u8f6c\u79fb\u597d\u4e86\uff0c\u7136\u540e\u518d\u8ba9\u4ed6\u7ee7\u627f\u4ed6\u7236\u4eb2\u7684\u72b6\u6001$f(fa,k-1)$\u65f6\uff0c\u6211\u4eec\u53d1\u73b0\u4ed6\u5f53\u524d\u7236\u4eb2\u7684\u72b6\u6001\u662f\u5305\u62ec\u4e86$f(v,k-2)$\u7684\uff0c\u4e8e\u662f\u5728\u8f6c\u79fb\u4e4b\u524d\u51cf\u6389\u5c31\u597d\u4e86\u3002\n\n\u4ee3\u7801\u5c31\u6bd4\u8f83\u597d\u5b9e\u73b0\u4e86\u3002\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\nconst int N = 1e5 + 10;\n\nint f[N][25];\nint n , k;\nint cnt , head[N], a[N] , ans;\nstruct Edge {\n\tint to , nxt;\n}e[N << 1];\nvoid add(int u , int v) {\n\te[++ cnt].to = v;\n\te[cnt].nxt = head[u];\n\thead[u] = cnt;\n}\n\nvoid dfs1(int now , int fa) {\n\tfor(int i = head[now] ; i ; i = e[i].nxt) {\n\t\tint v = e[i].to;\n\t\tif(v == fa) continue;\n\t\tdfs1(v , now);\n\t\tfor(int j = 1 ; j <= k ; j ++)\n\t\t\tf[now][j] += f[v][j - 1]; \n\t}\n}\n\nvoid dfs2(int now , int fa) {\n\tfor(int i = head[now] ; i ; i = e[i].nxt) {\n\t\tint v = e[i].to;\n\t\tif(v == fa) continue;\n\t\tfor(int j = k ; j >= 2 ; j --)\n\t\t\tf[v][j] -= f[v][j - 2];\n\t\tfor(int j = 1 ; j <= k ; j ++)\t\n\t\t\tf[v][j] += f[now][j - 1];\n\t\tdfs2(v , now);\t\n\t}\n}\n\nint main () {\n\tscanf(\"%d %d\" , &n , &k);\n\tfor(int i = 1 ; i <= n - 1 ; i ++) {\n\t\tint u , v; scanf(\"%d %d\" , &u, &v);\n\t\tadd(u , v); add(v , u);\n\t}\n\tfor(int i = 1 ; i <= n ; i ++) scanf(\"%d\" , a + i) , f[i][0] = a[i];\n\tdfs1(1 , 1);\n\tdfs2(1 , 1);\n\tfor(int i = 1 ; i <= n ; i ++) {\n\t\tans = 0;\n\t\tfor(int j = 0 ; j <= k ; j ++) ans += f[i][j];\n\t\tprintf(\"%d\\n\" , ans);\n\t}\n\treturn 0;\n} \n```",
        "postTime": 1573544908,
        "uid": 134080,
        "name": "jins3599",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P3047 \u3010[USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows\u3011"
    },
    {
        "content": "\u53d1\u73b0\u5f88\u591a\u9898\u89e3\u6ca1\u89e3\u91ca\u8fd9\u4e3a\u4ec0\u4e48\u662f\u5bf9\u7684,\u8fd9\u5176\u5b9e\u662f\u6362\u6839\u6cd5.\n------------\n\n\u53c2\u8003:https://www.cnblogs.com/wsmrxc/p/9818331.html\n\n\u9898\u610f\uff1a\n\n\u7ed9\u4f60\u4e00\u68f5\u6811,\u6c42\u4ece\u6bcf\u4e2a\u70b9x\u51fa\u53d1,\u6700\u591a\u8d70k\u6761\u8def\u80fd\u5230\u8fbe\u7684\u70b9\u7684\u6743\u503c\u4e4b\u548c\u3002\n\n\u89e3\u6790\uff1a\n\n\u66b4\u529b\u5c31\u662f\u4ece\u6bcf\u4e2a\u70b9dfs,\u6df1\u5ea6\u4e3ak\u5c31\u8fd4\u56de\u5373\u53ef\u3002\n\n\u671f\u671b\u5f97\u5206\uff1a70,\u539f\u56e0\uff1aTLE\n\ncode(\u4e00\u5f00\u59cb\u53ea\u4f1a\u66b4\u529b,\u5c31\u5199\u4e86\u8bd5\u8bd5)\uff1a\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=100010;\nstruct edge\n{\n    int to,nxt;\n}e[maxn<<1];\nint n,k,cnt;\nint head[maxn],c[maxn],f[maxn];\ninline void add(int u,int v)\n{\n    e[++cnt].nxt=head[u];\n    head[u]=cnt;\n    e[cnt].to=v;\n}\nint dfs(int x,int fa,int dep)\n{\n    if(dep==k) return c[x];\n    int ans=0;\n    for(int i=head[x];i;i=e[i].nxt)\n    {\n        int y=e[i].to;\n        if(y==fa) continue;\n        ans+=dfs(y,x,dep+1);\n    }\n    return ans+c[x];\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&k);\n    for(int i=1;i<n;i++)\n    {\n        int u,v;scanf(\"%d%d\",&u,&v);\n        add(u,v),add(v,u);\n    }\t\n    for(int i=1;i<=n;i++) scanf(\"%d\",&c[i]);\n    for(int i=1;i<=n;i++) f[i]=dfs(i,0,0);\n    for(int i=1;i<=n;i++) printf(\"%d\\n\",f[i]);\n    return 0;\n}\n```\n\u6b63\u89e3\uff1a\n\n\u53d1\u73b0\u4f3c\u4e4e\u65e0\u6cd5\u7528\u6811\u5f62DP\u89e3\u51b3,\u56e0\u4e3a\u7236\u4eb2\u53ef\u4ee5\u66f4\u65b0\u513f\u5b50,\u8fd9\u5c31\u5177\u6709\u540e\u6548\u6027\u3002\n\n\u53c8\u6ce8\u610f\u5230\u6839\u8282\u70b9\u4e0d\u7528\u8003\u8651\u7236\u4eb2\u8282\u70b9\u7684\u90a3\u4e00\u6761\u8def,\u56e0\u6b64\u53ef\u4ee5\u7528\u4e00\u6b21\u6811\u5f62DP\u6c42\u51fa\u6839\u8282\u70b9\u7684\u7b54\u6848\u3002\n\n\u72b6\u6001:f[i][j]\u8868\u793a\u4ecei\u7ecf\u8fc7j\u6761\u8def\u5230\u8fbe\u7684\u70b9\u7684\u6743\u503c\u548c\u3002\n\n\u5982\u679c\u4ee5x\u4e3a\u6839,\u65b9\u7a0bf[x][j]+=singma(f[y][j-1])(1=<j<=k),y\u662fx\u7684\u513f\u5b50\u3002\n\n\u8fd9\u6837\u53ef\u4ee5\u6c42\u51fax\u7684\u7b54\u6848\u3002\n\n\u4f46\u662f\u8fd9\u6837\u5bf9\u6bcf\u4e2a\u70b9\u8dd1\u4e00\u6b21DP\uff0c\u590d\u6742\u5ea6\u4e0e\u66b4\u529b\u65e0\u5f02\u3002\n\n\u53d1\u73b0\u8fd9\u597d\u50cf\u53ef\u4ee5\u7528\u6362\u6839\u6cd5\u89e3\u51b3\u3002\n\n\u5047\u8bbe\u4ee5x\u4e3a\u6839\u7684\u7b54\u6848\u5df2\u7ecf\u6c42\u51fa,\u90a3\u4e48y\u7684\u7b54\u6848\u5c31\u5c11\u4e86\u7ecf\u8fc7x\u7684\u8def\u5f84\u7684\u70b9,\u52a0\u4e0a\u5c31\u597d\u4e86\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\u5bf9\u4e8ey\uff0c\u4ee5\u5b83\u4e3a\u6839\u7684\u7b54\u6848\u53ef\u4ee5\u7531x\u6c42\u51fa\u3002\n\nf[y][j]=sigma(f[x][j-1])(1=<j<=k)\n\n\u4f46\u662f\u8fd9\u6837\u7684\u8bdd\u4f1a\u91cd\u590d\u8ba1\u7b97\uff1af[x][j-1]\u4e2d\u5305\u542b\u4e86f[y][j-2],\u5373x\u8d70y\u8fd9\u6761\u8def\u5f84\u5230\u8fbe\u7684\u70b9,\u51cf\u53bb\u5373\u53ef,\u6ce8\u610f\u5012\u5e8f\u3002\n\n### \u597d\u9898~\n\ncode(\u4ee3\u7801\u53c2\u8003\u4e86\u9898\u89e3,\u6bd5\u7adf\u4e00\u5f00\u59cb\u771f\u7684\u4e0d\u4f1a~)\uff1a\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=100010;\nconst int maxk=30;\nstruct edge\n{\n\tint to,nxt;\n}e[maxn<<1];\nint n,k,cnt;\nint head[maxn],c[maxn];\nint f[maxn][maxk];\nbool vis[maxn];\ninline void add(int u,int v)\n{\n\te[++cnt].nxt=head[u];\n\thead[u]=cnt;\n\te[cnt].to=v;\n}\nvoid dfs1(int x)\n{\n\tvis[x]=1;\n\tfor(int i=head[x];i;i=e[i].nxt)\n\t{\n\t\tint y=e[i].to;\n\t\tif(vis[y]) continue;\n\t\tdfs1(y);\n\t\tfor(int j=1;j<=k;j++) f[x][j]+=f[y][j-1];\n\t}\n}\nvoid dfs2(int x)\n{\n\tvis[x]=1;\n\tfor(int i=head[x];i;i=e[i].nxt)\n\t{\n\t\tint y=e[i].to;\n\t\tif(vis[y]) continue;\n\t\tfor(int j=k;j>=2;j--) f[y][j]-=f[y][j-2];//\u8fd9\u91cc\u8981\u5012\u5e8f,\u7528\u6b63\u786e\u7684\u72b6\u6001\u66f4\u65b0. \n\t\tfor(int j=1;j<=k;j++) f[y][j]+=f[x][j-1];\n\t\tdfs2(y);\n\t}\n}\nint main()\n{\n\tscanf(\"%d%d\",&n,&k);\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tint u,v;scanf(\"%d%d\",&u,&v);\n\t\tadd(u,v),add(v,u);\n\t}\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&c[i]),f[i][0]=c[i];\n\tdfs1(1);memset(vis,0,sizeof(vis));dfs2(1);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint ans=0;\n\t\tfor(int j=0;j<=k;j++) ans+=f[i][j];\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1559807348,
        "uid": 145441,
        "name": "nofind",
        "ccfLevel": 6,
        "title": "P3047 [USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows(\u6811\u5f62DP+\u6362\u6839\u6cd5)"
    },
    {
        "content": "\u539f\u9898\u4f20\u9001\u95e8[>Here<](https://www.luogu.org/problemnew/show/P3047)\n\n\u5982\u679c\u53ea\u67e5\u8be2\u4e00\u4e2a\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u4e2a\u70b9\u770b\u6210\u6839\uff0c\u8981\u6c42\u7684\u4e5f\u5c31\u662f\u6240\u6709\u6df1\u5ea6$\\le k$\u7684\u70b9\u7684\u6743\u503c\u548c\u3002\n\n\u73b0\u5728\u8003\u8651\u6bcf\u4e2a\u70b9\u90fd\u8981\u8be2\u95ee\u600e\u4e48\u529e\u3002\n\n\u8fd9\u91cc\u6709\u4e00\u79cd\u505a\u6811\u5f62DP\u5f88\u91cd\u8981\u7684\u601d\u60f3\uff0c\u6211\u4e5f\u4e0d\u77e5\u9053\u53eb\u4ec0\u4e48\uff0c\u5c31\u59d1\u4e14\u53eb\u505a\u2018\u6362\u6839\u601d\u60f3\u2019\u5427\u3002\n\n\u8003\u8651\u4e00\u4e2a\u70b9\u7684\u7236\u4eb2\u662f\u6839\u8282\u70b9\uff0c\u73b0\u5728\u5982\u4f55\u5feb\u901f\u8f6c\u79fb\u5230\u8be5\u70b9\u3002\n\n\uff08\u8bbeson(r)\u8868\u793a\u4ee5r\u4e3a\u6839\u7684\u5b50\u6811\u96c6\u5408\uff09\n\n\u5bf9\u4e8e\u4e00\u4e2a\u70b9x\uff0c\u5047\u8bbe\u53e6\u5916\u4e00\u4e2a\u70b9y\u4e0efa[x]\u7684\u8ddd\u79bb\u4e3as\uff08\u4e5f\u5c31\u662f\u5f53fa[x]\u4e3a\u6839\u65f6\u6df1\u5ea6\u4e3as\uff09\uff0c\u90a3\u4e48\n\n\u5f53$y \\in son(x)$\u8be5\u70b9\u5bf9\u4e8ex\u6765\u8bf4\u6df1\u5ea6\u4e3as-1\uff1b\n\n\u5426\u5219\u4e3as+1\u3002\n\n\u8fd9\u6837\u8f6c\u79fb\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <cstdio>\n#define int long long\n\nint head[100001],nxt[200001],b[200001],val[100001],dep[100001][23],k,m[100001],n,K;\nvoid push(int s,int t){\n    nxt[++K]=head[s];\n    head[s]=K;\n    b[K]=t;\n}\nvoid build(int x,int f){\n    dep[x][0]=val[x];\n    for(int i=head[x];i;i=nxt[i]){\n        if(b[i]==f)continue;\n        build(b[i],x);\n        for(int j=1;j<=k;j++)dep[x][j]+=dep[b[i]][j-1];\n    }\n}\nvoid check(int x,int f){\n    if(x!=1)for(int i=k;i;i--)dep[x][i]+=dep[f][i-1]-dep[x][i-2];\n    for(int i=0;i<=k;i++)m[x]+=dep[x][i];\n    for(int i=head[x];i;i=nxt[i])if(b[i]!=f)check(b[i],x);\n}\n#undef int\nint main(){\n#define int long long\n    scanf(\"%lld%lld\",&n,&k);\n    for(int i=1,s,t;i<n;i++)scanf(\"%lld%lld\",&s,&t),push(s,t),push(t,s);\n    for(int i=1;i<=n;i++)scanf(\"%lld\",val+i);\n    build(1,0);\n    check(1,0);\n    for(int i=1;i<=n;i++)printf(\"%lld\\n\",m[i]);\n}\n```",
        "postTime": 1537700877,
        "uid": 30903,
        "name": "Isonan",
        "ccfLevel": 0,
        "title": "luoguP3047 [USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows"
    },
    {
        "content": "\u9898\u76ee\u7b80\u8ff0\uff1a\u7ed9\u51fa\u4e00\u68f5n\u4e2a\u70b9\u7684\u6811\uff0c\u6bcf\u4e2a\u70b9\u4e0a\u6709Ci\u5934\u725b\uff0c\u95ee\u6bcf\u4e2a\u70b9k\u6b65\u8303\u56f4\u5185\u5404\u6709\u591a\u5c11\u5934\u725b\u3002\n\n\u663e\u7136\u6734\u7d20\u7684\u7b97\u6cd5\u662f\u8981\u8d85\u65f6\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u8003\u8651\u662f\u5426\u5b58\u5728\u91cd\u590d\u8ba1\u7b97\u7684\u60c5\u51b5\uff0c\n\n\u663e\u7136\u662f\u6709\u524d\u7f00\u60c5\u51b5\u7684\u51fa\u73b0\uff0c\u6211\u4eec\u8003\u8651\u6811\u5f62dp\n- \u72b6\u6001\uff1af[u][j]\u8868\u793a\u8282\u70b9u\u50cf\u5916\u6070\u597d\u5ef6\u751fj\u6b65\u80fd\u8986\u76d6\u7684\u725b\u7684\u6570\u76ee\n\n\u9996\u5148\u4e24\u4e2a\u72b6\u6001\u8f6c\u79fb\u6bd4\u8f83\u5bb9\u6613\u60f3\u5230\uff0c\u9898\u89e3\u4e2d\u4e5f\u6709\u4eba\u9610\u8ff0\u4e86\n- f[u][j]=singma{f[v][j-1]} |1<=j<=w(w\u8868\u793a\u6700\u8fdc\u7684\u957f\u5ea6,v\u4e3au\u7684\u5b50\u8282\u70b9) \n\n- f[v][j]=singma{f[u][j-1]} |1<=j<=w(w\u8868\u793a\u6700\u8fdc\u7684\u957f\u5ea6,v\u4e3au\u7684\u5b50\u8282\u70b9)\n\n\u5982\u679c\u4f60\u771f\u7684\u662f\u6309\u7167\u4e0a\u8ff0\u601d\u8def\u5199\u4e00\u4e2adp\uff0c\u4f60\u4f1a\u53d1\u73b0\uff0c\u6709\u91cd\u590d\uff0c\n\u4f60\u7684\u8f93\u51fa\u662f\u8fd9\u6837\u7684\n```\n15\n23\n19\n14\n13\n17\n```\n\u4f60\u53bb\u5bf9\u7167\u6807\u51c6\u8f93\u51fa\uff0c\u53d1\u73b0\u53ea\u6709\u7b2c\u4e00\u4e2a\u662f\u5bf9\u7684\uff0c\u5176\u4ed6\u90fd\u591a\u4e86\u3002\n\n\u597d\u4e86\u77e5\u9053\u6709\u91cd\u590d\u4e86\uff0c\u4f46\u662f\u91cd\u590d\u5728\u54ea\u91cc\uff1f\n\n\u6211\u4eec\u5206\u6790\u4e0b\uff1a\n\n- \u7b2c\u4e00\u904ddfs\u4f60\u7b97\u51faf[i][j]\u4ecei\u70b9\u5411\u4e0bj\u6b65\u53ca\u4ee5\u5185\u7684\u6743\u503c\u548c\n\n- \u7b2c\u4e8c\u904ddfs\u4f60\u7b97\u51faf[i][j]\u4ecei\u70b9\u5411\u513f\u5b50\u8d700-j\u6b65\uff0c\u50cf\u7236\u4eb2\u8d70j\u6b65\u7684\u6743\u503c\u548c\n\n- \u90a3\u4e48\u91cd\u590d\u7b97\u7684\u90a3\u4e00\u90e8\u5206\u5c31\u662f\u8282\u70b9u\u5411\u513f\u5b50\u8d700\u5230j-2\u6b65\u7684\u6743\u503c\u548c\uff0c\n\n\u7a76\u5176\u539f\u56e0\u5c31\u662f\u8fd9\u4e2a\u70b9\u548cj\u6b65\u4ee5\u4e0a\u7684\u90a3\u4e2a\u7236\u4eb2\u8282\u70b9\u662f\u4e0d\u8ba1\u7b97\u5728\u6b65\u6570j\u4e2d\u7684\uff0c\u6240\u4ee5\u8981\u51cf\u53bb\u3002\n\n```\n# include <bits/stdc++.h>\nusing namespace std;\nconst int root=1,MAXN=100001;\nstruct rec{\n\tint pre,to;\n}a[2*MAXN];\nint head[MAXN],f[MAXN][21],w,n,tot=0,c[MAXN];\nbool vis[MAXN];\nvoid adde(int u,int v)\n{\n\ta[++tot].pre=head[u];\n\ta[tot].to=v;\n\thead[u]=tot;\n}\nvoid dfs1(int u)\n{\n\tvis[u]=true;\n\tfor (int i=head[u];i!=0;i=a[i].pre)\n\t{\n\t\tint v=a[i].to; if (vis[v]) continue;\n\t\tdfs1(v);\n\t\tfor (int j=1;j<=w;j++) f[u][j]+=f[v][j-1];\n\t}\n}\nvoid dfs2(int u)\n{\n\tvis[u]=true;\n\tfor (int i=head[u];i!=0;i=a[i].pre)\n\t{\n\t\tint v=a[i].to;if (vis[v]) continue;\n\t\t//\u8282\u70b9u\u5411\u513f\u5b50\u8d70 0-j \u6b65\uff0cu\u5411 \u7236\u4eb2\u8d700-j\n\t\t//\u91cd\u590d\u7b97\u4e00\u6b21\uff1a\u5411\u513f\u5b50 j-2\u6b65\u53ca\u4ee5\u5185\uff08\u51cf\u6389\uff09\n\t\tfor (int j=w;j>=2;j--) f[v][j]-=f[v][j-2];\n\t\tfor (int j=1;j<=w;j++) f[v][j]+=f[u][j-1];\n\t\tdfs2(v);\n\t}\n}\nint main()\n{\n\tscanf(\"%d%d\",&n,&w);\n\tint u,v;\n\tfor (int i=1;i<=n-1;i++) {\n\t\tscanf(\"%d%d\",&u,&v);\n\t\tadde(u,v); adde(v,u);\n\t}\n\tmemset(f,0,sizeof(f));\n\tfor (int i=1;i<=n;i++) {\n\t\tscanf(\"%d\",&c[i]);\n\t\tf[i][0]=c[i];\n\t}\n\tmemset(vis,false,sizeof(vis));\n\tdfs1(root);\n\tmemset(vis,false,sizeof(vis));\n\tdfs2(root);\n\tfor (int i=1;i<=n;i++) {\n\t\tint ans=0;\n\t\tfor(int j=0;j<=w;j++) ans+=f[i][j];\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1533974917,
        "uid": 16456,
        "name": "ljc20020730",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3047 \u3010[USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows\u3011"
    },
    {
        "content": "[\u9898\u9762](https://www.luogu.com.cn/problem/P3047)\n\n\u9898\u610f\u7b80\u8ff0\uff1a\n\n\u7ed9\u4e00\u4e2a\u8282\u70b9\u6570\u4e3a $n$ \u4e14\u6709 $n-1$ \u6761\u8fb9\u7684\u8fde\u901a\u56fe\uff0c\u7ed9\u51fa\u6bcf\u4e2a\u70b9\u7684\u70b9\u6743 $c_i$ \uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u70b9\uff0c\u6c42\u51fa\u4e0e\u5176\u8ddd\u79bb\u4e0d\u5927\u4e8e $m$ \u6761\u8def\u5f84\u7684\u70b9\u7684\u6743\u503c\u548c\n\n\u9996\u5148\u5b83\u662f\u4e00\u68f5\u6811 ~~(\u5e9f\u8bdd)~~\n\n\u8fd9\u9898\u62ff\u4e0a\u624b\uff0c\u4e0d\u80fd\u6b63\u7ecf\u641c\u7d22\uff0c\u8003\u8651DP\n\n\u8bbe\u8ba1\u72b6\u6001 $f_{i,j}$ \u8868\u793a\u7b2c $i$ \u4e2a\u70b9\u8ddd\u79bb\u4e0d\u5927\u4e8e $j$ \u7684\u70b9\u6743\u548c\n\n\u90a3\u4e48 $f_{i,0}$ \u5373\u4e3a\u70b9\u6743 $c_i$ (\u521d\u59cb\u5316)\n\n$k$ \u4e3a\u70b9 $i$ \u7ecf\u8fc7\u4e00\u6761\u8fb9\u6240\u5230\u4e4b\u5904\uff0c $num_i$ \u8868\u793a $k$ \u7684\u4e2a\u6570\uff0c\u5219\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a\n$$f_{i,j} = \\sum f_{k,j-1} - (num_i-1) \\times f_{i,j-2}$$\n\n\u8bf4\u660e\u4e00\u4e0b\u51cf\u53bb\u7684\u90e8\u5206\uff0c\u56e0\u4e3a $\\sum f_{k,j-1}$ \u80af\u5b9a\u4f1a\u91cd\u590d\u7b97 $num_i$ \u6b21 $f_{i,j-2}$\n\n\u4e3a\u4ec0\u4e48\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u72b6\u6001\u7684\u5b9a\u4e49\u5c31\u662f\u76f8\u4e92\u7684\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6bcf\u6b21\u52a0\u4e0a\u540e\u4e00\u5c42\u7684\u70b9\u6743\u7684\u603b\u548c\uff0c\u5c06\u524d\u9762\u7684\u51cf\u53bb\u5373\u53ef\n\n\u5927\u5bb6\u53ef\u4ee5\u753b\u5f20\u56fe\u7406\u89e3\u4e00\u4e0b\uff0c\u5176\u5b9e\u5c31\u662f\u7b80\u5355\u7684\u5bb9\u65a5\u539f\u7406\u3002\n\n\u7279\u6b8a\u7684\uff0c\u5bf9\u4e8e $j = 1$ \u7684\u60c5\u51b5\uff0c\u6709\u8f6c\u79fb\u65b9\u7a0b\uff1a\n$$f_{i,j} = \\sum f_{k,j-1} + f_{i,j-1}$$\n\n\u4ee3\u7801\u4f9b\u51fa\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn = (int)1e5+7;\nstruct node {                  // \u94fe\u5f0f\u524d\u5411\u661f\u5b58\u56fe\n\tint nxt,dir;\n}Edge[maxn<<1];\nint head[maxn],num[maxn],cnt;\ninline void Add(int u,int v) {\n\tEdge[++cnt].dir = v,Edge[cnt].nxt = head[u],head[u] = cnt;\n\tEdge[++cnt].dir = u,Edge[cnt].nxt = head[v],head[v] = cnt;\n\tnum[u]++,num[v]++;\n}\nint n,m,f[maxn][23]; \t\t// f[i][j] \u8868\u793a\u7b2ci\u4e2a\u8282\u70b9\u8d70j\u6b65\u65f6\u7684\u603b\u6743\u503c \nint main() {\n\tscanf(\"%d%d\",&n,&m);\n\tint u,v;\n\tfor(int i=1;i<n;++i) {\n\t\tscanf(\"%d%d\",&u,&v);\n\t\tAdd(u,v);\n\t}\n\tfor(int i=1;i<=n;++i) scanf(\"%d\",&f[i][0]);    // \u521d\u59cb\u5316\n\tfor(int i=1;i<=m;++i)                          // \u8fdb\u884cDP\n\t\tfor(int j=1;j<=n;++j) {\n\t\t\tfor(int k=head[j];k;k=Edge[k].nxt) \n\t\t\t\tf[j][i] += f[Edge[k].dir][i-1];\n\t\t\tif(i>1) f[j][i] -= (num[j]-1) * f[j][i-2];\n\t\t\telse f[j][i] += f[j][i-1];\n\t\t}\n\tfor(int i=1;i<=n;++i) printf(\"%d\\n\",f[i][m]);\n\treturn 0;\n}\n```",
        "postTime": 1585226806,
        "uid": 223884,
        "name": "AxDea",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3047 \u3010[USACO12FEB]Nearby Cows G\u3011"
    },
    {
        "content": "\u795e\u9898\n\u8ba9\u6211\u641e\u6e05\u4e86\u5927\u90e8\u5206\u6811\u5f62dp\u601d\u8def\n\u7b2c\u4e00\u904ddfs\u6c42\u51fa\u5b50\u6811\u5185\u7684\u4fe1\u606f\n\u7b2c\u4e8c\u904d\u641e\u51fa\u975e\u5b50\u6811\u4fe1\u606f\uff08\u4e00\u822c\u4f1a\u5bf9\u5b50\u6811\u5185\u7684\u4ea7\u751f\u5f71\u54cd\uff0c\u9700\u8981\u5bb9\u65a5\uff09\n$f[i][j]$\u8868\u793a\u7ecf\u8fc7\u6700\u591aj\u6b65\u5230i\u70b9\u7684\u5976\u725b\u6570\n\u8be6\u89c1\u4ee3\u7801\n```\n#include<iostream>\n#include<cstdio>\n#include<queue>\nint const maxn=100110,maxm=24,inf=0x1f1f1f1f;\nstruct E\n{\n    int to,next;\n    E(int to=0,int next=0):\n        to(to),next(next){}\n}e[maxn<<1];\nint head[maxn],cnt;\ninline void add(int u,int v)\n{\n    e[++cnt]=(E){v,head[u]};\n    head[u]=cnt;\n}\nint n,k,w[maxn];\nint f[maxn][maxm],ff[maxn][maxm],fff[maxn][maxm],size[maxn];\nvoid pre_dfs(int u,int fa)\n{\n    fff[u][0]=f[u][0]=w[u];\n    for(int i=head[u];i;i=e[i].next)\n    {\n        int v=e[i].to;\n        if(v==fa)\n            continue;\n        pre_dfs(v,u);\n        for(int j=1;j<=k;j++)\n            f[u][j]+=f[v][j-1];\n    }\n    for(int j=1;j<=k;j++)\n        fff[u][j]=f[u][j]+fff[u][j-1];\n        //\u65b0\u5f00\u4e00\u4e2a\u6570\u7ec4\uff0c\u8981\u4e0d\u4f1a\u5bf9\u5411\u4e0a\u56de\u6eaf\u4ea7\u751f\u5f71\u54cd\n}\nvoid r_c_dfs(int u,int fa)\n{\n    for(int i=head[u];i;i=e[i].next)\n    {\n        int v=e[i].to;\n        if(v==fa)\n            continue;\n        ff[v][0]=w[v];\n        ff[v][1]=fff[v][1]+fff[u][0];\n        //\u5355\u72ec\u5904\u74060\u30011\u6b65\u7684\u60c5\u51b5\n        for(int j=2;j<=k;j++)\n            ff[v][j]=fff[v][j]+ff[u][j-1]-fff[v][j-2];\n            //\u7ec6\u8282\uff0c\u5bf9\u4e8eu\u8981\u7528\u66f4\u65b0\u540e\u7684\u503c\uff0c\u4e5f\u5c31\u662fff\u6570\u7ec4\n            //\u8fd9\u4e2a\u5bb9\u65a5\u8bf7\u52a1\u5fc5\u81ea\u5df1\u601d\u8003\u6216\u624b\u6a21\n        r_c_dfs(v,u);\n    }\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&k);\n    for(int u,v,i=1;i<n;i++)\n        scanf(\"%d%d\",&u,&v),add(u,v),add(v,u);\n    for(int i=1;i<=n;i++)\n        scanf(\"%d\",w+i);\n    pre_dfs(1,0);\n    for(int j=0;j<=k;j++)\n        ff[1][j]=fff[1][j];\n       \t//\u522b\u5fd8\u4e86\u5bf91\u521d\u59cb\u5316\n    r_c_dfs(1,0);\n    for(int i=1;i<=n;i++)\n        printf(\"%d\\n\",ff[i][k]);\n    return 0;\n}\n```",
        "postTime": 1541501986,
        "uid": 55868,
        "name": "Panthera_AFO",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3047 \u3010[USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows\u3011"
    },
    {
        "content": "\u6211\u53d1\u73b0\u6211\u7684\u505a\u6cd5\u548c\u5404\u4f4d\u90fd\u4e0d\u4e00\u6837\u8bf6\uff0c\u4e0d\u8fc7\u89c9\u5f97\u5927\u5bb6\u7684\u505a\u6cd5\u90fd\u633a\u6f02\u4eae\u7684qwq  \n\u6211\u7528\u4e86\u4e00\u4e2a\u8f85\u52a9\u6570\u7ec4\uff08\u5e94\u8be5\u4e0d\u7b97\u662f\u4ec0\u4e48\u7ed3\u6784qwq\uff09\uff0c\u7528\u9014\u540e\u9762\u518d\u8bf4\n\n\u9996\u5148\u7528$sum[i][j]$\u8868\u793a\u4ee5\u8282\u70b9$i$\u4e3a\u6839\u7684\u5b50\u6811\u4e2d\uff0c\u4e0e$i$\u76f8\u8ddd\u4e3a$j$\u7684\u8282\u70b9\u6743\u503c\u603b\u548c\uff1b  \n\u5904\u7406\u5b8c\u540e\u6211\u4eec\u91cd\u65b0\u4ece\u6839\u8282\u70b9$u$\u8dd1\u4e00\u904ddfs\uff0c\u6211\u4eec\u77e5\u9053\uff0c\u6839\u8282\u70b9$u$\u7684\u7b54\u6848\u5c31\u662f$\\sum^{K}_{j=0}sum[u][j]$\n\n\u5f53\u5f80\u4e0b\u8d70\u4e00\u5c42\u65f6\uff0c\u5bf9\u4e8e\u5f53\u524d\u8282\u70b9$v$\u800c\u8a00\uff0c\u5b83\u7684\u7b54\u6848\u7531\u4e24\u90e8\u5206\u7ec4\u6210\uff0c\u5206\u522b\u662f$\\sum^{K}_{j=0}sum[v][j]$\u548c**\u6839\u8282\u70b9$u$\u4e2d\u51cf\u53bb$v$\u5b50\u6811\u8d21\u732e\u540e\u7684$\\sum^{K-1}_{j=0}sum'[u][j]$**\n\n\u5173\u952e\u5c31\u5728\u8fd9\u91cc\uff0c\u4e3a\u4e86\u7ef4\u62a4$sum'$\uff0c\u6211\u7528\u4e86\u4e00\u4e2a\u8f85\u52a9\u6570\u7ec4$stk$\uff0c\u4e14\u904d\u5386\u65f6\u6bcf\u4e2a\u8282\u70b9$x$\u5728\u8be5\u6570\u7ec4\u4e0a\u90fd\u5bf9\u5e94\u6709\u4e00\u4e2a\u4f4d\u7f6e$p_x$\uff0c$p_x=K+deep_x$\uff1b\u5176\u6709**$stk[p_x-j]$\u7684\u503c\u4e3a$x$\u975e\u5b50\u6811\u90e8\u5206\u8ddd$x$\u4e3a$j$\u7684\u8d21\u732e**\n\n\u5177\u4f53\u7ef4\u62a4\u64cd\u4f5c\u5982\u4e0b\uff1adfs\u5230\u67d0\u8282\u70b9$u$\u65f6\u9996\u5148\u7edf\u8ba1\u7b54\u6848\uff1a\n$$ans[u]=\\sum^{K}_{j=0}sum[u][j]+\\sum^{K}_{j=0}stk[p_x-j]$$\n\u63a5\u7740\u4ece$u$\u5f00\u59cb\u5411\u4e0b\u904d\u5386\uff0c\u5bf9\u4e8e\u5f53\u524d$u$\u7684\u5b50\u8282\u70b9$v$\uff0c\u6211\u4eec\u5728\u5bf9\u5e94\u7684\u4f4d\u7f6e\u52a0\u4e0a$v$\u975e\u5b50\u6811\u90e8\u5206\u7684\u8d21\u732e\uff08\u904d\u5386\u5b8c$v$\u540e\u518d\u5c06\u5176\u51cf\u53bb\uff09\uff0c\u5373\uff1a\n$$stk[p-j]=stk[p-j]+sum[u][j]-sum[v][j-1]$$\n\u5904\u7406\u5b8c\u540e\u518d\u8dd1\u5230$v$\uff0c\u6ce8\u610f\u6709$p_v=p_u+1$\u3002\u5404\u4f4d\u6a21\u62df\u4e00\u4e0b\u5c31\u4f1a\u53d1\u73b0\u5b83\u7684\u6709\u8da3\u4e4b\u5904\u5566\u3002\u53e6\u5916\uff0c$p_{root}=K+1$\uff08\u5176\u5b9e\u53ea\u8981\u5927\u4e8e$K$\u5c31\u53ef\u4ee5\u4e86\uff09\u3002\n\n\u6211\u89c9\u5f97\u8fd9\u79cd\u601d\u7ef4\u633a\u6f02\u4eae\u7684\uff0c\u4e0d\u77e5\u6709\u4ec0\u4e48\u5176\u5b83\u5e94\u7528qwq\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include <cstdio>\nusing namespace std;\nconst int MAXN = 100005;\n\nstruct edge {\n\tint v, pre;\n} e[MAXN<<1];\nint N, T, C[MAXN], fst[MAXN], vis[MAXN];\nint sum[MAXN][21], ans[MAXN], stk[MAXN+50];\n\ninline int read()\n{\n\tregister int o = 0;\n\tregister char c = getchar();\n\twhile (c < '0' || c > '9') c = getchar();\n\twhile (c >='0' && c <='9') o = (o<<3)+(o<<1)+(c&15), c = getchar();\n\treturn o;\n}\ninline void adde(int a, int b, int k)\n{\n\te[k] = (edge){b, fst[a]}, fst[a] = k;\n}\nvoid dfs(int k)\n{\n\tvis[k] = 1, sum[k][0] = C[k];\n\tfor (register int o=fst[k], vv; o; o=e[o].pre) if (!vis[e[o].v]) {\n\t\tvv = e[o].v, dfs(vv);\n\t\tfor (register int i=1; i<=T; i++) sum[k][i] += sum[vv][i-1];\n\t}\n}\nvoid dp(int k, int p)\n{\n\tvis[k] = 0;\n\tfor (register int i=0; i<=T; i++) ans[k] += sum[k][i] + stk[p-i];\n\tfor (register int o=fst[k], vv; o; o=e[o].pre) if (vis[e[o].v]) {\n\t\tvv = e[o].v, stk[p] += sum[k][0];\n\t\tfor (register int i=1; i<=T; i++) stk[p-i] += sum[k][i] - sum[vv][i-1];\n\t\tdp(vv, p+1), stk[p] -= sum[k][0];\n\t\tfor (register int i=1; i<=T; i++) stk[p-i] -= sum[k][i] - sum[vv][i-1];\n\t}\n}\nint main()\n{\n\tN = read(), T = read();\n\tfor (register int i=1, a, b; i<N; i++) {\n\t\ta = read(), b = read();\n\t\tadde(a, b, i), adde(b, a, i+N);\n\t}\n\tfor (register int i=1; i<=N; i++) C[i] = read();\n\t\n\tdfs(1);\n\tdp(1, T+1);\n\t\n\tfor (register int i=1; i<=N; i++) printf(\"%d\\n\", ans[i]);\n}\n```",
        "postTime": 1537359927,
        "uid": 9315,
        "name": "zhyh",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3047 \u3010[USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows\u3011"
    },
    {
        "content": "\u4e00\u770b\u5c31\u77e5\u9053\u662f\u4e00\u9053**~~\u6811\u5f62dp~~**\n\n\u7528\u4f2a\u5bb9\u65a5\u539f\u7406\n\n$dp[v][i][1]=dp[u][i-1][0]-dp[v][i-2][0]$\n\n$dp[i][j][0]$\u8868\u793a$i$\u5728$j$\u7684\u8ddd\u79bb\u5185\u7684\u7ed3\u70b9\u6743\u503c\u548c\u3002\n\n$dp[i][j][1]$\u8868\u793a\u5bf9\u4e8e$i$\u7684\u5144\u5f1f\u59d0\u59b9\u8282\u70b9\u8ddd\u79bb\u4e3a$<=j-1$\u7684\u6743\u503c\u6570\uff1b\n\n\u6700\u540e\u7edf\u8ba1\u7b54\u6848\u3002\n\n```cpp\n#include<iostream>\n#include<vector>\n#include<cstdio>\n#include<cstring>\n#include<cstdlib>\n#include<algorithm>\nusing namespace std;\nconst int maxn=100001;\nint sum[maxn],head[maxn],father[maxn],dp[maxn][21][2];  \nint n,m,cnt=0;\nstruct zk\n{ \n   int u,v,next;\n}e[maxn*2];\nvoid add(int u,int v)\n{\n\te[cnt].u=u;\n    e[cnt].v=v;\n\te[cnt].next=head[u];\n\thead[u]=cnt++;\n}\nvoid dfs(int u,int fa)\n{\n    int i,j,k,sum=0;\n    father[u]=fa;\n    for(int k=1;k<=m;k++) \n\tdp[u][k][0]=dp[u][0][0];\n    for(i=head[u];i!=-1;i=e[i].next)\n    {\n        int v=e[i].v;\n        if(v==fa) continue;\n        dfs(v,u);\n        for(int k=1;k<=m;k++) \n\t\tdp[u][k][0]+=dp[v][k-1][0];\n    }\n    for(i=head[u];i!=-1;i=e[i].next)\n    {\n        int v=e[i].v;\n        if(v==fa) continue;\n        dp[v][1][1]=dp[u][0][0]; \n        for(int k=2;k<=m;k++)\n\t\tdp[v][k][1]=dp[u][k-1][0]-dp[v][k-2][0];\n    }\n}\nint main()\n{\n    int u,v;\n    memset(head,-1,sizeof(head));\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=n-1;i++)\n    {\n        scanf(\"%d%d\",&u,&v);\n        add(u,v);\n\t\tadd(v,u);\n    }\n    for(int i=1;i<=n;i++) \n\tscanf(\"%d\",&dp[i][0][0]);\n    dfs(1,0);\n    for(int i=1;i<=n;i++)  \n    {\n        sum[i]=dp[i][m][0];\n        int u=i,v;\n        for(int j=1;j<=m;j++)\n        {\n            sum[i]+=dp[u][m-j+1][1];\n            u=father[u];\n            if(father[u]==0) break;\n        }\n    } \n    for(int i=1;i<=n;i++) \n\tprintf(\"%d\\n\",sum[i]);\n    return 0;\n}\n```",
        "postTime": 1522842955,
        "uid": 26801,
        "name": "durex_com",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3047 \u3010[USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows\u3011"
    },
    {
        "content": "```cpp\n\\documentclass[UTF8]{ctexart}\n\\title{[USACO12FEB]Nearby Cows solution}\n\\author{GoAway}\n\\usepackage{color}\n\\usepackage{xcolor}\n\\definecolor{keywordcolor}{rgb}{0.8,0.1,0.5}\n\\usepackage{listings}\n\\lstset{breaklines}\n\\lstset{extendedchars=false}\n\\lstset{language=C++,\n    keywordstyle=\\color{keywordcolor} \\bfseries, \n    identifierstyle=,\n    basicstyle=\\ttfamily, \n    commentstyle=\\color{blue} \\textit,\n    stringstyle=\\ttfamily, \n    showstringspaces=false,\n    frame=shadowbox\n    captionpos=b\n}\n\\begin{document}\n\\maketitle{}\n```\n\u8fd9\u9053\u9898\u5206\u4e24\u6b65\u5904\u7406\n\\section{\u7b2c\u4e00\u6b65}\n\n    \\paragraph{}\u5148\u8f6c\u5316\u6210\u6709\u6839\u6811\uff0c\u7136\u540e\u518d\u8ba1\u7b97\u51fa\u4ee5\u6bcf\u4e2a\u70b9\u4e3a\u6839\u7684\u5b50\u6811\u4e2d \\textbf{\u5f80\u4e0b}\u8d70j\u6b65\u5f97\u5230\u7684\u725b\u7684\u603b\u6570\u3002\n\n\u6811\u5f62DP\u5b8c\u6210\uff0c\u5f31\u667a\u516c\u5f0f\n\n$$\nf[x][j] = \\sum\\_{u \\in \\\\{son\\_x\\\\} } f[u][j-1]  + f[x][0]\n\n$$\n\\paragraph{}\u65f6\u95f4\u590d\u6742\u5ea6$ O( n \\times k ) $\n\n\n\n\n```cpp\n\\section{\u7b2c\u4e8c\u6b65}\n    \\paragraph{} \u6bcf\u4e2a\u70b9\u5f80\u4e0b\u7684\u5df2\u7ecf\u7b97\u597d\u4e86\uff0c\u63a5\u4e0b\u6765\u5c31\u7b97\u5f80\u4e0a\u4ee5\u53ca\u62d0\u6765\u62d0\u53bb\u7684\u3002\u53cd\u6b63 $ k $ \u4e0d\u5927\uff0c\u66b4\u529b\u5f80\u4e0a\u8df3 $ k $ \u6b65\u5c31\u884c\u4e86\uff0c\u8df3\u7684\u65f6\u5019\u7edf\u8ba1\u3002\n    \\paragraph{}\u5982\u4f55\u7edf\u8ba1\u5462\uff1f\n    \\paragraph{}\u5047\u8bbe\u73b0\u5728\u8df3\u4e86 $ j $ \u6b65\u5230\u8fbe\u70b9 $ u $\uff0c\u90a3\u4e48\u518d\u52a0\u4e0a $ f[u][k-j] $\uff0c\u6709\u4e00\u90e8\u5206\u88ab\u91cd\u590d\u52a0\u4e86\uff0c\u518d\u51cf\u6389\uff0c\u5c31\u662f $ f[ son_u ][k-j-1] $\uff0c\u5176\u4e2d $ son_u $\u4ee3\u8868\u5728\u5f80\u4e0a\u8df3\u7684\u8fc7\u7a0b\u4e2d\u7ecf\u8fc7\u7684$u$\u7684\u513f\u5b50\uff0c\u4e0d\u96be\u53d1\u73b0\u662f\u552f\u4e00\u7684\u3002\n    \\paragraph{}\u65f6\u95f4\u590d\u6742\u5ea6$ O( n \\times k ) $\n\\section{\u4ee3\u7801}\n\\begin{lstlisting}\n#include <bits/stdc++.h>\nusing namespace std ;\nvoid Read ( int &x, char c = getchar() ) {\n    for ( x = 0 ; !isdigit(c) ; c = getchar() ) ;\n    for ( ; isdigit(c) ; c = getchar() ) x = 10*x + c - '0' ;\n}\nconst int maxn = 1e5+5, maxm = 25 ;\nint n, m, f[maxn][maxm] ;\nint e, be[maxn], nxt[maxn<<1], to[maxn<<1], fa[maxn] ;\nvoid add ( int x, int y ) {\n    to[++e] = y ;\n    nxt[e] = be[x] ;\n    be[x] = e ;\n}\nvoid dfs ( int x ) {\n    int i, u, j ;\n    for ( i = be[x] ; i ; i = nxt[i] ) {\n        u = to[i] ;\n        if ( u == fa[x] ) continue ;\n        fa[u] = x ;\n        dfs(u) ;\n    }\n    for ( j = 1 ; j <= m ; j ++ ) {\n        f[x][j] = f[x][0] ;\n        for ( i = be[x] ; i ; i = nxt[i] )\n            if ( to[i] != fa[x] ) f[x][j] += f[to[i]][j-1] ;\n    }\n}\nint calc ( int x ) {\n    int i, u, v = 0, stp = m ;\n    v = f[x][m] ;\n    for ( u = fa[x] ; fa[x] && stp>=0 ; x = u, u = fa[x], stp-- ) {\n        v += f[u][stp-1]-f[x][stp-2] ;\n    }\n    return v ;\n}\nint main() {\n    int i, j, k, x, y ;\n    Read(n) ; Read(m) ;\n    for ( i = 1 ; i < n ; i ++ ) {\n        Read(x) ; Read(y) ;\n        add ( x, y ) ;\n        add ( y, x ) ;\n    }\n    for ( i = 1 ; i <= n ; i ++ ) Read(f[i][0]) ;\n    dfs(1) ;\n    for ( i = 1 ; i <= n ; i ++ ) printf ( \"%d\\n\", calc(i) ) ;\n    return 0 ;\n}\n\\end{lstlisting}\n\\end{document}\n```",
        "postTime": 1503065107,
        "uid": 39497,
        "name": "GoAway",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3047 \u3010[USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u6211\u82b1\u4e86\u5f88\u4e45\u624d\u505a\u51fa\u6765\uff0c\u81ea\u5df1\u4e00\u5f00\u59cb\u4e5f\u6ca1\u60f3\u6e05\u695a\uff0c\u6c42\u52a9\u4e86\u5927\u4f6c\u4eec\n\n###\u8fd9\u9053\u9898\u6709\u4e24\u79cd\u601d\u8def\n\n\u4e00\u79cd\u5728\u5927\u4f6c\u7684\u535a\u5ba2\u4e0a\uff0c\u6211\u7b97\u662f\u660e\u767d\u4e86\uff0c\u5e72\u8106\u8d34\u4e0a\u535a\u5ba2\u5427\uff0c\u6211\u5c06\u4e5f\u8bb2\u4e0d\u6e05**\u7b11\u54ed**\n\n\nhttp://blog.csdn.net/oi\\_konnyaku/article/details/75449966\n\n\u53e6\u4e00\u79cd\u5462\uff0c\u662f\u6bd4\u8f83\u5bb9\u6613\u60f3\u5230\u7684\uff0c\u4f46\u4e5f\u5f88\u5bb9\u6613\u51fa\u9519\u7684\n\n\u7528\u5230\u4e86\u94fe\u5f0f\u524d\u5411\u661f\u548c\u5bb9\u65a5\u539f\u7406\n\n\u9996\u5148\u94fe\u5f0f\u524d\u5411\u661f\u5462\uff0c\u662f\u4e2a\u9ad8\u7ea7\u7684\u4e1c\u897f\uff0c\u767e\u5ea6\u4e0a\u7b2c\u4e00\u4e2a\u5019\u9009\u7684\u535a\u5ba2\u633a\u597d\u7684\n\n\u5b9e\u9645\u4e0a\u4e5f\u5c31\u662f\u8bb0\u5f55\u8fb9\u7684\u4fe1\u606f\uff0c\u8bb0\u5f55\u8be5\u8fb9\u540c\u8d77\u70b9\u5f02\u7ec8\u70b9\u7684\u8fb9\u7684\u5b58\u50a8\u4f4d\u7f6e\u548c\u8be5\u8fb9\u7684\u6743\u503c\u4ee5\u53ca\u6307\u5411\u7684\u7ec8\u70b9\n\n\u8fd9\u4e2a\u4e0d\u592a\u597d\u7406\u89e3\uff0c\u6a21\u62df\u4e5f\u9700\u8981\u4e00\u5b9a\u7684\u8010\u5fc3\uff0c\u4f46\u662f\u641e\u61c2\u4e86\u771f\u7684\u5f88\u597d\u7528\n\n\u8fd9\u662f\u6211\u7b2c\u4e00\u9053\u7528\u94fe\u5f0f\u524d\u5411\u661f\u505a\u7684\u9898\uff0c\u6bd4\u8f83\u7b80\u5355\u7684\u4f8b\u9898\u5927\u5bb6\u53ef\u4ee5\u53bb\u505a\u4e00\u4e0b##\u4e8c\u53c9\u82f9\u679c\u6570\n\n\n\u5bb9\u65a5\u539f\u7406\u5462\uff0c\u6211\u4e5f\u4e0d\u592a\u6e05\u695a\uff0c\u767e\u5ea6\u4e0a\u662f\u8fd9\u4e48\u8bf4\u7684\n\n ![](https://cdn.luogu.com.cn/upload/pic/6532.png) \n\n\u7136\u540e\u6765\u4e86\u4e00\u5927\u5806\u770b\u4e0d\u61c2\u7684sigma\u7b49\u7b49\uff0c\u770b\u5f97\u61c2\u7684\u53ea\u6709\u8fd9\u4e2a\n\n ![](https://cdn.luogu.com.cn/upload/pic/6533.png) \n\n\u6240\u4ee5\u5927\u6982\u660e\u767d\u4e86\n\n\u9012\u63a8\uff08DP\uff09\u516c\u5f0f\u5c31\u80fd\u591f\u7406\u89e3\u4e86\n\n\u5177\u4f53\u7684\u5427\uff0c\u5efa\u8bae\u9996\u6b21\u7528\u94fe\u5f0f\u524d\u5411\u661f\u53ef\u4ee5\u7167\u7740\u4ee3\u7801\u6572\n\n\u6211\u7684\u6ce8\u91ca\u4e5f\u662f\u6bd4\u8f83\u8be6\u5c3d\u7684\u5566~\\(\u2267\u25bd\u2266)/~\uff08\u56e0\u4e3a\u7b2c\u4e00\u904d\u81ea\u5df1\u4e5f\u6ca1\u641e\u6e05\u695a\uff09\n\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\nusing namespace std;\nint read()//\u8bfb\u5165\u4f18\u5316\n{\n    char ch=getchar();\n    while(ch>'9'||ch<'0') ch=getchar();\n    int h=0;\n    while(ch>='0'&&ch<='9')\n    {\n        h=h*10+ch-'0';\n        ch=getchar();\n    }\n    return h;\n}\nint f[100001][21];//f[i][j]\u8868\u793a\u8ddd\u79bb\u7b2ci\u5757\u5730(\u6b63\u597d)j\u6b65\u7684\u725b\u7684\u5934\u6570 \nint w[100001];//\u5b58\u50a8\u7ed3\u70b9\u7684\u725b\u7684\u5934\u6570 \nstruct qxx{\n    int to;\n    int next;//\u94fe\u5f0f\u524d\u5411\u661f \n}a[200002];\nint head[100001];\nint cnt=0;//\u8ba1\u6570 \nint fa[100001]; \nint n,k; \nvoid add(int x,int y)\n{\n    a[++cnt].to=y;\n    a[cnt].next=head[x];\n    head[x]=cnt;\n}\nvoid dfs(int x,int y)//\u5b9e\u9645\u4e0a\u8fd9\u4e2a\u51fd\u6570\u9ed8\u8ba41\u4e3a\u6839\uff0c\u8fdb\u884c\u6811\u5f62\u6df1\u641c \n{\n    fa[x]=y;\n    f[x][0]=w[x];//\u5f53\u524d\u7ed3\u70b9\u8d700\u6b65\n    for(int i=head[x];i!=-1;i=a[i].next)//\u679a\u4e3e\u540c\u8d77\u70b9\u5f02\u7ec8\u70b9\u7684\u8fb9 \n```\n{//\u7533\u660e\u6b64\u65f6\u53d8\u91cf\uff1ax\u8868\u793a\u5f53\u524d\u7ed3\u70b9\uff0cfa\u8868\u793ax\u7684\u7236\u7ed3\u70b9\n//i\u8868\u793a\u679a\u4e3e\u4ee5x\u4e3a\u8d77\u70b9\u7684\u8fb9\u7684\u7f16\u53f7\uff0ca[i].to\u8868\u793a\u7b2ci\u6761\u8fb9\u7684\u7ec8\u70b9(x\u7684\u5b50\u7ed3\u70b9)\n\n\n```cpp\n     //a[i].next\u524d\u5411\u661f\u6307\u5411\u4e0b\u4e00\u6761\u4ee5x\u4e3a\u8d77\u70b9\u7684\u8fb9 \n        if(a[i].to!=y)\n        {\n            dfs(a[i].to,x);//\u6df1\u641c\u5b50\u7ed3\u70b9 \n            for(int j=1;j<=k;j++)\n            {\n                f[x][j]+=f[a[i].to][j-1];//\u5148\u52a0\u4e0a\u5b50\u6811\u4e0a\u7684\u725b \n            }\n        }\n    } \n}\nint main()\n{\n//    freopen(\"a.in\",\"r\",stdin);\n//    freopen(\"a.out\",\"w\",stdout);\n    n=read();k=read();\n    for(int i=0;i<=100000;i++) head[i]=-1; \n    for(int i=1;i<=n-1;i++)\n    {\n        int x,y;\n        x=read();\n        y=read();\n        add(x,y);\n        add(y,x);//\u53cc\u5411\u5b58\u50a8\u94fe\u5f0f\u524d\u5411\u661f \n    }\n    for(int i=1;i<=n;i++) w[i]=read();//\u8bfb\u53d6\u6bcf\u4e2a\u7ed3\u70b9\u7684\u725b\u7684\u6570\u91cf\n    dfs(1,0); \n//    for(int i=1;i<=n;i++) for(int w=0;w<=k;w++) cout<<\"f[\"<<i<<\"][\"<<w<<\"]=\"<<f[i][w]<<endl; \n    for(int i=1;i<=n;i++)\n        for(int w=1;w<=k;w++)\n            f[i][w]+=f[i][w-1];//\u8ba1\u7b97\u524d\u7f00\u548c\uff0c\u6539\u53d8f\u7684\u610f\u4e49\n//    for(int i=1;i<=n;i++) for(int w=0;w<=k;w++) cout<<\"f[\"<<i<<\"][\"<<w<<\"]=\"<<f[i][w]<<endl;//\u8fd9\u4e24\u53e5\u7528\u6765\u8c03\u8bd5\u7684\n    //\u73b0\u5728f[i][j]\u8868\u793a\u5728i\u7ed3\u70b9\u7684\u5b50\u6811\u4e0a\u8ddd\u79bb\u4e3aj\u7684\u725b\u6570\n    for(int i=1;i<=n;i++)//\u987a\u5e8f\u679a\u4e3e\u7530\u5730 \n    {\n        int ans=f[i][k];//\u521d\u503c\u8d4b\u4e3a\u4ece1\u5f00\u59cb\uff0c\u5b50\u6811\u4e0a\u8ddd\u79bb\u4e3ak\u4ee5\u5185\u7684\u725b\u6570 \n        int j=k;//\n        int x=i;//\n        //\u5b9e\u9645\u4e0a\u4e00\u6574\u53e5\u8bdd\u7684\u610f\u601d\u662f\n        //\u8fd0\u7528\u5bb9\u65a5\u539f\u7406\uff0c\u4ecex\u7ed3\u70b9\u5f00\u59cb\uff0cans\u4e3a\u5411\u7236\u7ed3\u70b9\u8d700~k\u6b65\u518d\u52a0\u4e0a\u7236\u7ed3\u70b9\u5411\u4e0b\u8d70k~0\u6b65\u7684\u548c\uff0c\u518d\u51cf\u53bb\u91cd\u590d\u7b97\u7684(\u91cd\u590d\u7b97\u7684\u662f\u5b50\u6811\u4e0a\u8d70j-2\u6b65\u7684\u5730\u65b9)\n        //\u6bd4\u5982\u8bf4\u6309\u6837\u4f8b\uff0c\u5f53i\u4e3a2\u65f6\uff0cx=2\uff0cans\u9996\u5148\u4e3a3+4+6+2=15\uff0ckeep on\uff0cans+=f[fa[2](1)][j-1(1)],ans+=1+2+5=8,ans-=f[2][0](2),\u7b97\u5f97ans=21\n        //\u5b9e\u9645\u4e0a\u5c31\u662f\u901a\u8fc7\u627e\u7236\u7ed3\u70b9\u62d3\u5c55\u51fa\u5144\u5f1f\u7ed3\u70b9\u7684\u60c5\u51b5\uff0c\u7531\u4e8e\u7236\u7ed3\u70b9\u7684\u72b6\u6001\u5305\u62ec\u4e86\u8be5\u5b50\u6811\u7684\u72b6\u6001\uff0c\u6545\u8981\u51cf \n        while(x!=1&&j!=0)\n        {\n            ans+=f[fa[x]][j-1];\n            if(j>=2) ans-=f[x][j-2];\n            x=fa[x];\n            j--;\n        }\n        printf(\"%d\\n\",ans); \n    } \n    return 0;\n}\n```",
        "postTime": 1500951242,
        "uid": 43628,
        "name": "xzyxzy",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3047 \u3010[USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows\u3011"
    },
    {
        "content": "\u9996\u5148\u611f\u8c22\u697c\u4e0b\u5927\u795e\u63d0\u4f9b\u601d\u8def\uff0c\u73b0\u5728\u6211\u538b\u7f29\u4e00\u4e0b\u697c\u4e0b\u7684\uff1b\n\n\u6211\u4eec\u53ea\u5f04\u4e00\u4e2af[i][j]\u8868\u793a\u7b2ci\u70b9\u65f6\uff0c\u5411\u5b50\u8282\u70b9\u8d700~j\u6b65\u6240\u6709\u53ef\u4ee5\u5230\u8fbe\u7684\u70b9\u7684\u503c\u7684\u548c\uff1b\n\n\u90a3\u4e48\u663e\u7136f[i][0]=w[i];\n\n\u8fd9\u4e2a\u6570\u7ec4\u600e\u4e48\u66f4\u65b0\uff0c\u81ea\u5df1\u60f3\u5427\uff0c\u4e5f\u53ef\u4ee5\u770b\u6211\u4ee3\u7801\uff0c\u6211\u662f\u5206\u4e24\u6b65\u53bb\u641ef\u6570\u7ec4\u7684\uff1b\n\n\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e2a\u70b9x\uff1b\n\n\u663e\u7136\u7684f[x][k]\u65f6\u7b54\u6848\u7684\u4e00\u90e8\u5206\n\n\u4f46\u662f\u8fd9\u6837\u4ec5\u4ec5\u7b97\u4e86x\u5411\u4e0b\u8d70\uff1b\n\n\u5982\u679c\u5411\u4e0a\u8d70\u4e00\u6b65\u518d\u5411\u4e0b\u8d70\n\nf[fa[x]][k-1]-f[x][k-2];\n\n\u5411\u4e0a\u8d70\u4e24\u6b65\u4ea6\u662f\u5982\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u7528while\u6765\u641e\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<cstdlib>\n#include<cmath>\n#define Ll long long\nusing namespace std;\nstruct cs{\n    int to,next;\n}a[200001];\nint head[100001],w[100001],fa[100001],f[100001][25];//w[i]\u8868\u793ai\u8282\u70b9\u7684\u503c\uff0cfa[i]\u662fi\u7684\u7236\u8282\u70b9, \nint m,n,x,y,z,ll;\nvoid init(int x,int y){\n    ll++;\n    a[ll].to=y;\n    a[ll].next=head[x];\n    head[x]=ll;\n}\nvoid dfs(int x,int y){//\u5f53\u524d\u662fx\u70b9\uff0c\u5176\u7236\u8282\u70b9\u662fy \n    fa[x]=y;\n    f[x][0]=w[x];\n    for(int k=head[x];k;k=a[k].next)\n    if(a[k].to!=y){\n        dfs(a[k].to,x);\n        for(int j=1;j<=m;j++)\n        f[x][j]+=f[a[k].to][j-1];\n    }    \n}\nvoid cfb(int x){\n    int ans=0,k=m;\n    ans=f[x][m];\n    while(x!=1&&k){\n        ans+=f[fa[x]][--k];\n        if(k)ans-=f[x][k-1];\n        x=fa[x];\n    }\n    printf(\"%d\\n\",ans);\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=n-1;i++)scanf(\"%d%d\",&x,&y),init(x,y),init(y,x);\n    for(int i=1;i<=n;i++)scanf(\"%d\",&w[i]);\n    dfs(1,-1);//1\u7684\u7236\u8282\u70b9\u662f-1\u597d\u4e86 \n    for(int i=1;i<=n;i++)//dfs\u65f6f[i][j]\u662f\u7b2ci\u70b9\u521a\u597d\u8d70j\u6b65\uff0c\u73b0\u5728\u6c42\u524d\u7f00\u548c \n    for(int j=1;j<=m;j++)f[i][j]+=f[i][j-1];\n    for(int i=1;i<=n;i++)cfb(i);\n}\n\n```",
        "postTime": 1487553499,
        "uid": 7442,
        "name": "\u5de8\u578b\u65b9\u5757",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3047 \u3010[USACO12FEB]\u9644\u8fd1\u7684\u725bNearby Cows\u3011"
    }
]
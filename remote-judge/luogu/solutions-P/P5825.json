[
    {
        "content": "\u666e\u53ca\u4e00\u4e2a\u5947\u5999\u7684\u7ec4\u5408\u610f\u4e49\u8bc1\u660e\u3002\n\n\u6211\u4eec\u9996\u5148\u5c06\u7b54\u6848\u9664\u4ee5 $n!$ \u8fd9\u6837\u5c31\u662f\u6982\u7387\uff0c\u8003\u8651 $n$ \u4e2a\u5b9e\u6570\u7684\u5747\u5300\u5206\u5e03 $(a_1, a_2, \\cdots, a_n) \\in (0, 1)^n$\uff0c\u663e\u7136\u6709\u4e24\u4e2a\u5b9e\u6570\u76f8\u7b49\u7684\u6982\u7387\u662f $0$\uff0c\u90a3\u4e48\u6839\u636e\u5bf9\u79f0\u6027 $a_i$ \u7684\u5927\u5c0f\u5173\u7cfb\u670d\u4ece\u6392\u5217 $p_i$ \u662f\u7b49\u6982\u7387\u7684\u3002\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u8f6c\u800c\u8003\u8651 $a_i < a_{i + 1}$ \u7684\u4f4d\u7f6e\u6709 $k$ \u4e2a\u7684\u6982\u7387\u3002\n\n\u4ee4 $a_0 = 0$\uff0c\u8003\u8651\u5dee\u5206 $b_i = (a_i - a_{i - 1}) \\bmod 1$\uff0c\u56e0\u6b64 $b_i \\in (0, 1)$ \u4e14\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\u5efa\u7acb\u4e86 $(b_1, b_2, \\cdots, b_n)$ \u5230 $(a_1, a_2, \\cdots, a_n)$ \u7684\u4e00\u4e2a\u201c\u5747\u5300\u201d\u6620\u5c04\u3002\n\n\u8003\u8651 $\\sum_{i = 1}^n b_i$ \u7684\u610f\u4e49\uff0c\u5982\u679c $a_i < a_{i + 1}$ \u90a3\u4e48\u8bf4\u660e $b_{i + 1}$ \u6ca1\u6709\u5728\u53d6\u6a21\u65f6\u52a0\u4e00\uff0c\u5426\u5219\u53d1\u751f\u4e86\u52a0\u4e00\u3002\u56e0\u6b64 $\\sum b_i = a_n + n - 1 - k$\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u4ec5\u4ec5\u662f\u5728\u8ba1\u7b97\u5bf9\u4e8e\u5b9e\u6570 $x_1, x_2, \\cdots, x_n \\in (0, 1)$\uff0c$\\sum x_i \\in (n - 1 - k, n - k)$ \u7684\u6982\u7387\u6211\u4eec\u53ea\u9700\u7b97\u51fa $\\sum x_i < n - k$ \u7684\u6982\u7387\u7136\u540e\u5dee\u5206\u5373\u53ef\u3002\n\n\u8003\u8651\u5f62\u5f0f\u4e0a\u6211\u4eec\u867d\u7136\u662f\u6c42\u6982\u7387\uff0c\u4f46\u662f\u8003\u8651\u6269\u5c55\u4e3a\u201c\u6d4b\u5ea6\u201d\uff0c\u4e5f\u5c31\u662f\u5bf9\u4e8e\u53ef\u884c\u7684\u6bcf\u4e00\u90e8\u5206\u7684 $n$ \u7ef4\u5fae\u5143\u8fdb\u884c\u6c42\u548c\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u5047\u8bbe\u6ca1\u6709 $x_i < 1$ \u7684\u9650\u5236\uff0c\u90a3\u4e48\u603b\u5171\u7684\u6d4b\u5ea6\u662f $\\frac{(n-k)^n}{n!}$\u3002\u8fdb\u884c\u5bb9\u65a5\uff0c\u5047\u8bbe\u6709 $j (j \\le n - k)$ \u4e2a\u6570\u5f3a\u5236 $\\ge 1$\uff0c\u90a3\u4e48\u8fd9\u4e00\u90e8\u5206\u7684\u6d4b\u5ea6\u662f $\\frac{(n - k - j)^n}{n!}$\u3002\n\n\u56e0\u6b64\u6982\u7387\u53ef\u4ee5\u901a\u8fc7\u4e00\u90e8\u4e2d\u95f4\u8fd0\u7b97\u5f97\u5230\uff1a\n\n$$\n\\sum_{j=0}^{n-k} (-1)^j \\binom n j  \\frac{(n - k - j)^n}{n!} = \\sum_{j = 0}^{n - k} \\frac{(-1)^j}{j!(n - j)!} (n - k - j)^n\n$$\n\n\u4e00\u6b21\u5377\u79ef\u3002",
        "postTime": 1577096048,
        "uid": 21423,
        "name": "Elegia",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5825 \u3010\u6392\u5217\u8ba1\u6570\u3011"
    },
    {
        "content": "\u4e24\u4f4d\u5927\u4f6c\u5199\u7684\u90fd\u592a\u795e\u4ed9\u8fa3~\uff0c~~\u5bf9\u50cf\u6211\u8fd9\u6837\u5bf9\u6b27\u62c9\u6570\u4e00\u65e0\u6240\u77e5\u7684\u849f\u84bb\u771f\u7684\u592a\u4e0d\u53cb\u597d\u4e86~~\uff0c\u8fd9\u91cc\u63d0\u4f9b\u4e00\u79cd(\u53ef\u80fd)\u6bd4\u8f83\u7b80\u4fbf\u7684\u505a\u6cd5\n\n\u6211\u4eec\u53d1\u73b0\u6b63\u597d\u7b49\u4e8e\u8fd9\u4e2a\u6761\u4ef6\u8c8c\u4f3c\u4e0d\u662f\u5f88\u597d\u529e\uff0c\u6240\u4ee5\u6211\u4eec\u5c1d\u8bd5\u8f6c\u5316\u6210\u8ba1\u7b97\u8fd9\u6837\u4e00\u4e2a\u4e1c\u897f\uff1a\u5148\u94a6\u5b9ak\u4e2a\u4f4d\u7f6e\u5fc5\u987b\u586b\u5c0f\u4e8e\u53f7\uff0c\u5176\u4f59\u4f4d\u7f6e\u6ca1\u6709\u8981\u6c42\uff0c\u5408\u6cd5\u7684\u6570\u5217\u603b\u6570\uff0c\u5e76\u5bf9\u6bcf\u4e2ak\u6c42\u51fa\u8fd9\u6837\u7684\u7b54\u6848\n\n\u8003\u8651\u6211\u4eec\u94a6\u5b9a\u8fc7\u5c0f\u4e8e\u53f7\u540e\uff0c\u6211\u4eec\u628a\u8fd9\u4e2a\u6570\u5217\u5206\u6bb5\uff0c\u5982\u679c\u4e24\u4e2a\u4f4d\u7f6e\u6709\u5c0f\u4e8e\u53f7\u76f8\u90bb\u5c31\u5427\u5b83\u4eec\u5206\u6210\u4e00\u7ec4\uff0c\u5bb9\u6613\u53d1\u73b0\u5206\u5b8c\u7ec4\u540e\u65b9\u6848\u6570\u5c31\u662f\u4e2a\u53ef\u91cd\u96c6\u5408\u6392\u5217\u8ba1\u6570\uff0c\u4e5f\u5c31\u662f\n\n$$\\frac{n!}{\\prod_{S}|S|!}$$\n\n\u8981\u8ba1\u7b97\u5bf9\u4e8e\u6240\u6709\u53ef\u80fd\u96c6\u5408\u8fd9\u4e2a\u5f0f\u5b50\u7684\u548c\uff0c\u8003\u8651\u4f7f\u7528\u6307\u6570\u751f\u6210\u51fd\u6570\uff0c\u7ee7\u7eed\u53d1\u73b0\u8fd9\u4e2a\u6570\u5217\u6709n-1-k\u6bb5\uff0c\u6240\u4ee5\u7b54\u6848\u5c31\u662f\u628a\u5e8f\u5217\u5212\u5206\u6210n-1-k\u6bb5\u540e\u6bcf\u4e00\u6bb5\u957f\u5ea6\u9636\u4e58\u5012\u6570\u7684\u4e58\u79ef\u4e4b\u548c\uff0c\u4ee4m=n-1-k\uff0c\u7528\u751f\u6210\u51fd\u6570\u8868\u793a\u5c31\u662f\n\n$$[x^n](e^x-1)^m$$\n\n\u628a\u5f0f\u5b50\u62c6\u5f00\n\n$$[x^n]\\sum_{i=0}^m\\binom{m}{i}(-1)^{m-i}e^i$$\n\n$$=\\sum_{i=0}^m\\binom{m}{i}(-1)^{m-i}\\frac{i^n}{n!}$$\n\n$$=\\frac{m!}{n!}\\sum_{i=0}^m\\frac{i^n}{i!}\\frac{(-1)^{m-i}}{(m-i)!}$$\n\n\u663e\u7136\u662f\u4e2a\u5377\u79ef\uff0c\u5c31\u53ef\u4ee5nlogn\u8ba1\u7b97\u6bcf\u4e2ak\u5bf9\u5e94\u7684\u503c\u4e86\n\n\u8ba1\u7b97\u51fa\u8fd9\u4e2a\u503c\u540e\uff0c\u8003\u8651\u600e\u4e48\u8ba1\u7b97\u7b54\u6848\uff0c\u8bbefi\u8868\u793a\u6211\u4eec\u7b97\u51fa\u6765\u7684i\u5bf9\u5e94\u7684\u503c\uff0cgi\u4e3a\u6709i\u4e2a\u5c0f\u4e8e\u53f7\u7684\u7b54\u6848\n\n\u6211\u4eec\u53ef\u4ee5\u5217\u51fa\u5f0f\u5b50\n\n$$f_i=\\sum_{j=i}^{n-1}\\binom{j}{i}g_j$$\n\n\u4e8c\u9879\u5f0f\u53cd\u6f14\u4e00\u4e0b\n\n$$g_i=\\sum_{j=i}^{n-1}(-1)^{j-i}\\binom{j}{i}f_j$$\n\n\u8fd9\u4e2a\u4e1c\u897f\u628a\u5f0f\u5b50\u62c6\u5f00\uff0c\u7ffb\u8f6c\u4e00\u4e0b\u8fd8\u662f\u4e2a\u5377\u79ef\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528\u4e24\u6b21NTT\u5728O(nlogn)\u7684\u65f6\u95f4\u5185\u7b97\u51fa\u7b54\u6848\u5566\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef long long LL;\ntypedef long double lb;\n#define ri register int\nconst int N=600005,M=998244353;\nint i,n,j,r[N];\nlong long f[N],fac[N],inv[N],g[N];\nlong long qpow(long long a,long long b)\n{\n\tlong long s=a,ans=1;\n\twhile(b)\n\t{\n\t\tif(b&1)\n\t\t\tans=ans*s%M;\n\t\ts=s*s%M;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\nvoid NTT(long long *f,int op,int lim)\n{\n\tfor(ri i=0;i<lim;++i)\n\t\tr[i]=(r[i>>1]>>1)|(i&1?lim>>1:0);\n\tfor(i=0;i<lim;++i)\n\t\tif(i<r[i])\n\t\t\tswap(f[i],f[r[i]]);\n\tfor(ri i=1;i<lim;i<<=1)\n\t{\n\t\tlong long wn=qpow(3,op==1?(M-1)/(i<<1):M-1-(M-1)/(i<<1));\n\t\tfor(ri j=0;j<lim;j+=i<<1)\n\t\t{\n\t\t\tlong long s=1;\n\t\t\tfor(ri k=j;k<j+i;++k)\n\t\t\t{\n\t\t\t\tlong long a=f[k],b=f[k+i]*s;\n\t\t\t\tf[k]=(a+b)%M;\n\t\t\t\tf[k+i]=(a-b)%M;\n\t\t\t\ts=s*wn%M;\n\t\t\t}\n\t\t}\n\t}\n\tif(op==-1)\n\t{\n\t\tlong long inv=qpow(lim,M-2);\n\t\tfor(ri i=0;i<lim;++i)\n\t\t\tf[i]=f[i]*inv%M;\n\t}\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfac[0]=1;\n\tfor(ri i=1;i<=n;++i)\n\t\tfac[i]=fac[i-1]*i%M;\n\tinv[n]=qpow(fac[n],M-2);\n\tfor(ri i=n-1;i>=0;--i)\n\t\tinv[i]=inv[i+1]*(i+1)%M;\n\tfor(ri i=0;i<=n;++i)\n\t\tf[i]=inv[i]*qpow(i,n)%M;\n\tfor(ri i=0;i<=n;++i)\n\t\tg[i]=inv[i]*(i&1?-1:1);\n\tint lim=1;\n\twhile(lim<=2*n)\n\t\tlim<<=1;\n\tNTT(f,1,lim);\n\tNTT(g,1,lim);\n\tfor(i=0;i<lim;++i)\n\t\tf[i]=f[i]*g[i]%M;\n\tNTT(f,-1,lim);\n\tfor(i=1;i<=n;++i)\n\t\tf[i]=f[i]*fac[i]%M;\n\tfor(i=0;i<n;++i)\n\t\tf[i]=f[i+1];\n\tfor(i=n;i<lim;++i)\n\t\tf[i]=0;\n\tmemset(g,0,sizeof(g));\n\tfor(i=0;i<n;++i)\n\t\tf[i]=fac[n-1-i]*f[i]*(i&1?-1:1)%M;\n\tfor(i=0;i<n;++i)\n\t\tg[i]=inv[i];\n\tNTT(f,1,lim);\n\tNTT(g,1,lim);\n\tfor(i=0;i<lim;++i)\n\t\tf[i]=f[i]*g[i]%M;\n\tNTT(f,-1,lim);\n\tfor(i=0;i<n;++i)\n\t\tf[i]=f[i]*inv[n-1-i]%M;\n\treverse(f,f+n);\n\tfor(i=0;i<n;++i)\n\t\tprintf(\"%lld \",(f[i]*((i^n)&1?1:-1)%M+M)%M);\n\tputchar('0');\n}\n```\n",
        "postTime": 1576681422,
        "uid": 17974,
        "name": "\u2468_Cirno_",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5825 \u3010\u6392\u5217\u8ba1\u6570\u3011"
    },
    {
        "content": "### \u9898\u610f\n\n\u6211\u7684\u9898\u9762\u5199\u7684\u633a\u76f4\u767d\u7684\uff0c\u4e0d\u518d\u591a\u8fc7\u89e3\u91ca\u3002\n\n$\\texttt{Data Range:}n\\leq 2\\times 10^5$\n\n### \u9898\u89e3\n\n\u5bf9\u4e8e\u957f\u5ea6\u4e3a $n$ \u4e14\u6709 $k$ \u4e2a\u4e0a\u5347\u7684\u6392\u5217\u5b9a\u4e49\u4e3a**\u6b27\u62c9\u6570** $\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle$\u3002\n\n\u5176\u5b9e\u8fd9\u4e2a\u4e1c\u897f\u7684\u82f1\u6587\u540d\u53eb $\\texttt{Eulerian Number}$\uff0c\u6240\u4ee5\u8bf4\u522b\u628a\u5b83\u548c\u53e6\u4e00\u4e2a\u6b27\u62c9\u6570\u641e\u6df7\u6dc6\u4e86\u3002\n\n\u9996\u5148\u6211\u4eec\u6709\u4e00\u4e2a\u975e\u5e38 $\\texttt{naive}$ \u7684\u60f3\u6cd5\u662f $\\texttt{dp}$\u3002\n\n\u8003\u8651\u4ece\u957f\u5ea6\u4e3a $n-1$ \u7684\u6392\u5217\u4e2d\u63d2\u5165\u4e00\u4e2a $n$ \u6765\u6784\u9020\u957f\u5ea6\u4e3a $n$ \u7684\u6392\u5217\u3002\n\n\u7136\u540e\u6709\u56db\u79cd\u60c5\u51b5\u3002\n\n- \u5728\u6392\u5217\u7684\u5de6\u7aef\u63d2\u5165\u4e00\u4e2a $n$\uff0c\u8fd9\u6837\u4e0d\u4ea7\u751f\u4efb\u4f55\u5347\u9ad8\uff0c\u6240\u4ee5\u8fd9\u79cd\u60c5\u51b5\u4ece $\\left\\langle\\begin{matrix}n-1\\\\k\\end{matrix}\\right\\rangle$ \u8f6c\u79fb\u6765\u3002\n\n- \u5728\u6392\u5217\u7684\u53f3\u7aef\u63d2\u5165\u4e00\u4e2a $n$\uff0c\u8fd9\u6837\u4f1a\u4ea7\u751f\u4e00\u4e2a\u5347\u9ad8\uff0c\u6240\u4ee5\u8fd9\u79cd\u60c5\u51b5\u7531 $\\left\\langle\\begin{matrix}n-1\\\\k-1\\end{matrix}\\right\\rangle$ \u8f6c\u79fb\u6765\u3002\n\n- \u5728\u67d0\u4e00\u4e2a\u4f4d\u7f6e $i$ \u548c $i+1$ \u4e2d\u95f4\u63d2\u5165 $n$\uff0c\u5176\u4e2d $P_i<P_{i+1}$\uff0c\u90a3\u4e48\u8fd9\u91cc\u4f1a\u4ea7\u751f\u4e00\u4e2a\u5347\u9ad8\uff0c\u540c\u65f6\u4f1a\u7834\u574f\u539f\u6765\u7684\u4e00\u4e2a\u5347\u9ad8\uff0c\u6240\u4ee5\u603b\u7684\u5347\u9ad8\u662f\u4e0d\u53d8\u7684\u3002\u6240\u4ee5\u4e4b\u524d\u7684\u6392\u5217\u8981\u6709 $k$ \u4e2a\u5347\u9ad8\uff0c\u6240\u4ee5\uff0c\u8fd9\u79cd\u60c5\u51b5\u7531 $k\\left\\langle\\begin{matrix}n-1\\\\k\\end{matrix}\\right\\rangle$\u8f6c\u79fb\u6765\u3002\n\n- \u5728\u67d0\u4e00\u4e2a\u4f4d\u7f6e $i$ \u548c $i+1$ \u4e2d\u95f4\u63d2\u5165 $n$\uff0c\u5176\u4e2d $P_i>P_{i+1}$\uff0c\u90a3\u4e48\u8fd9\u91cc\u4f1a\u4ea7\u751f\u4e00\u4e2a\u5347\u9ad8\uff0c\u4f46\u662f\u4e0d\u4f1a\u7834\u574f\u4efb\u4f55\u539f\u6709\u7684\u5347\u9ad8\uff0c\u6240\u4ee5\u603b\u800c\u8a00\u4e4b\u4ea7\u751f\u4e86\u4e00\u4e2a\u5347\u9ad8\u3002\u6240\u4ee5\u4e4b\u524d\u7684\u6392\u5217\u8981\u6709 $k-1$ \u4e2a\u5347\u9ad8\uff0c\u6240\u4ee5\uff0c\u8fd9\u79cd\u60c5\u51b5\u7531 $(n-k-1)\\left\\langle\\begin{matrix}n-1\\\\k-1\\end{matrix}\\right\\rangle$\u8f6c\u79fb\u6765\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u6709\u4e00\u4e2a\u7b80\u5355\u7684\u9012\u63a8\u5f0f\uff1a\n\n$$\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle=(k+1)\\left\\langle\\begin{matrix}n-1\\\\k\\end{matrix}\\right\\rangle+(n-k)\\left\\langle\\begin{matrix}n-1\\\\k-1\\end{matrix}\\right\\rangle$$\n\n\u7136\u540e\uff0c\u6211\u4eec\u6765\u8bc1\u660e\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u6052\u7b49\u5f0f\u53eb\u505a $\\texttt{Worpitzky}$ \u6052\u7b49\u5f0f\uff0c\u4e3a\n\n$$x^n=\\sum\\limits_{k}\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle\\binom{x+k}{n}$$\n\n\u5728\u8bc1\u660e\u8fd9\u4e2a\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u6765\u8bc1\u660e\u4e00\u4e2a\u5c0f\u5c0f\u7684\u4e1c\u897f\u505a\u70ed\u8eab\uff1a\n\n$$x\\binom{x+k}{n}=(k+1)\\binom{x+k}{n+1}+(n-k)\\binom{x+k+1}{n+1}$$\n\n\u4e24\u8fb9\u5f3a\u884c\u5c55\u5f00\u4e00\u4e0b\u5c31\u597d\u4e86\uff0c\u7136\u540e\u6211\u4eec\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bc1\u3002\n\n\u9996\u5148\uff0c\u8981\u8bc1\u660e\u7684\u67ff\u5b50\u5728 $n=0$ \u65f6\u6210\u7acb\u3002\n\n\u7136\u540e\uff0c\u82e5 $x^n=\\sum\\limits_{k=0}^{n}\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle\\binom{x+k}{n}$ \u6210\u7acb\uff0c\u5219\u53ea\u9700\u8bc1 $x^{n+1}=\\sum\\limits_{k=0}^{n+1}\\left\\langle\\begin{matrix}n+1\\\\k\\end{matrix}\\right\\rangle\\binom{x+k}{n+1}$ \u4e5f\u6210\u7acb\u3002\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u6765\u63a8\u63a8\u67ff\u5b50\uff0c\u9996\u5148\u4ece\u4e00\u4e2a\u5f88\u5f31\u667a\u7684\u4e1c\u897f\u5f00\u59cb\uff1a\n\n$$x^{n+1}=x\\cdot x^n=\\sum\\limits_{k=0}^{n}\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle x\\binom{x+k}{n}$$\n\n\u7136\u540e\u6211\u4eec\u70ed\u8eab\u7684\u4e1c\u897f\u5c31\u6d3e\u4e0a\u7528\u573a\u5566\uff1a\n\n$$x^{n+1}=\\sum\\limits_{k=0}^{n}\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle\\left ((k+1)\\binom{x+k}{n+1}+(n-k)\\binom{x+k+1}{n+1}\\right )$$\n\n\u4e00\u6b65\u62c6\u62ec\u53f7\uff0c\u6709\n\n$$x^{n+1}=\\sum\\limits_{k=0}^{n}\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle (k+1)\\binom{x+k}{n+1}+\\sum\\limits_{k=0}^{n}\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle(n-k)\\binom{x+k+1}{n+1}$$\n\n\u7136\u540e\uff0c\u5eb7\u5eb7\u53f3\u8fb9\uff0c\u6211\u4eec\u7528\u4e4b\u524d\u7684\u9012\u63a8\u5f0f\uff0c\u6709\n\n$$\\sum\\limits_{k=0}^{n+1}\\left\\langle\\begin{matrix}n+1\\\\k\\end{matrix}\\right\\rangle\\binom{x+k}{n+1}=\\sum\\limits_{k=0}^{n+1}\\left ((k+1)\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle+(n+1-k)\\left\\langle\\begin{matrix}n\\\\k-1\\end{matrix}\\right\\rangle\\right )\\binom{x+k}{n+1}$$\n\n\u610f\u8bc6\u5230\u5728 $k=n+1$ \u5904\u88ab\u6c42\u548c\u5f0f\u503c\u4e3a $0$\uff0c\u6240\u4ee5\u9002\u5f53\u8c03\u6574\u4e00\u4e0b\u4e0a\u754c\uff0c\u5e76\u4e00\u6b65\u62c6\u62ec\u53f7\n\n$$\\sum\\limits_{k=0}^{n+1}\\left\\langle\\begin{matrix}n+1\\\\k\\end{matrix}\\right\\rangle\\binom{x+k}{n+1}=\\sum\\limits_{k=0}^{n}(k+1)\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle\\binom{x+k}{n+1}+\\sum\\limits_{k=0}^{n}(n+1-k)\\left\\langle\\begin{matrix}n\\\\k-1\\end{matrix}\\right\\rangle\\binom{x+k}{n+1}$$\n\n\u53f3\u8fb9\u7684\u548c\u5f0f\u7528 $k-1$ \u4ee3\u66ff $k$\uff0c\u5f97\u5230\n\n$$\\sum\\limits_{k=0}^{n+1}\\left\\langle\\begin{matrix}n+1\\\\k\\end{matrix}\\right\\rangle\\binom{x+k}{n+1}=\\sum\\limits_{k=0}^{n}(k+1)\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle\\binom{x+k}{n+1}+\\sum\\limits_{k=-1}^{n-1}(n-k)\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle\\binom{x+k+1}{n+1}$$\n\n\u7136\u540e\u53d1\u73b0\u8fd9\u4e2a $k=-1$ \u548c $k=n$ \u65f6\u53f3\u8fb9\u548c\u5f0f\u4e2d\u88ab\u6c42\u548c\u5f0f\u503c\u4e3a $0$\uff0c\u8c03\u6574\u4e00\u4e0b\u4e0a\u4e0b\u754c\u5373\u53ef\u8bc1\u660e\u8be5\u6052\u7b49\u5f0f\u3002\n\n\u7136\u540e\u5c31\u662f\u6709\u9650\u5fae\u79ef\u5206\u554a\u54c8\u54c8\u54c8\u3002\u9996\u5148\u6211\u4eec\u6ce8\u610f\u5230\n\n$$\\Delta\\left (\\binom{x+k}{n}\\right)=\\binom{x+k}{n-1}$$\n\n\u7136\u540e\u505a\u591a\u6b21\u5dee\u5206\u5373\u53ef\u5f97\u5230\u8fd9\u6837\u4e00\u4e2a\u4e1c\u897f\uff1a\n\n$$\\Delta^m\\left (\\binom{x+k}{n}\\right)=\\binom{x+k}{n-m}$$\n\n\u5f88\u597d\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u524d\u8fdb\u4e00\u6b65\u4e86\n\n$$\\sum\\limits_{k}\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle\\binom{x+k}{n-m}=\\Delta^m(x^n)=\\sum\\limits_{j}\\binom{m}{j}(-1)^{m-j}(x+j)^n$$\n\n\u6211\u4eec\u5c06 $x=0$ \u4ee3\u5165\uff0c\u5e76\u4f7f\u7528\u4e00\u4e2a\u975e\u5e38\u5e38\u89c1\u7684\u516c\u5f0f\n\n$$m!\\left\\{\\begin{matrix}n\\\\m\\end{matrix}\\right\\}=\\sum\\limits_{k}\\binom{m}{k}k^n(-1)^{m-k}$$\n\n\u4e8e\u662f\uff0c\u6709\n\n$$\\sum\\limits_{k}\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle\\binom{k}{n-m}=m!\\left\\{\\begin{matrix}n\\\\m\\end{matrix}\\right\\}$$\n\n\u5f88\u597d\uff0c\u6211\u4eec\u53c8\u8fc8\u51fa\u4e86\u4e00\u6b65\u3002\u63a5\u4e0b\u6765\u662f\u5173\u952e\u7684\u4e00\u6b65\u3002\n\n\u6211\u4eec\u4e24\u8fb9\u5bf9 $m$ \u6c42\u548c\uff0c\u6709\n\n$$\\sum\\limits_{m}\\sum\\limits_{k}\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle\\binom{k}{n-m}=\\sum\\limits_{m}m!\\left\\{\\begin{matrix}n\\\\m\\end{matrix}\\right\\}$$\n\n\u4e58\u4e0a $z^{n-m}$\uff08\u6362\u4e00\u4e2a\u53d8\u91cf\uff09\n\n$$\\sum\\limits_{k}\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle\\sum\\limits_{m}z^{n-m}\\binom{k}{n-m}=\\sum\\limits_{m}z^{n-m}m!\\left\\{\\begin{matrix}n\\\\m\\end{matrix}\\right\\}$$\n\n\u7136\u540e\u4f60\u4f1a\u53d1\u73b0\u662f\u4e2a\u4e8c\u9879\u5f0f\u5b9a\u7406\u7684\u4e8b\u60c5\uff0c\u7136\u540e\u7b80\u5355\u7684\u4ee3\u6362\u4e00\u4e0b\u6700\u7ec8\u6211\u4eec\u5f97\u5230\n\n$$\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle=\\sum\\limits_{k}\\left\\{\\begin{matrix}n\\\\k\\end{matrix}\\right\\}\\binom{n-k}{m}(-1)^{n-k-m}k!$$\n\n\u5f88\u597d\u3002\u5f3a\u884c\u62c6\u7ec4\u5408\u6570\n\n$$\\left\\langle\\begin{matrix}n\\\\m\\end{matrix}\\right\\rangle=\\sum\\limits_{k}\\left\\{\\begin{matrix}n\\\\k\\end{matrix}\\right\\}\\frac{(n-k)!}{m!(n-k-m)!}(-1)^{n-k-m}k!$$\n\n\u7136\u540e\uff0c\u5199\u5f97\u66f4\u52a0\u6e05\u695a\u4e00\u70b9\uff0c\u6211\u4eec\u6709\n\n$$m!\\left\\langle\\begin{matrix}n\\\\m\\end{matrix}\\right\\rangle=\\sum\\limits_{k}\\left(\\left\\{\\begin{matrix}n\\\\k\\end{matrix}\\right\\}k!(n-k)!\\right)\\frac{(-1)^{n-(m+k)}}{(n-(m+k))!}$$\n\n\u73b0\u5728\uff0c\u6211\u4eec\u8bbe $f_i=i!\\left\\langle\\begin{matrix}n\\\\i\\end{matrix}\\right\\rangle$\uff0c $g_k=\\left\\{\\begin{matrix}n\\\\k\\end{matrix}\\right\\}k!(n-k)!$\uff0c $h_k=\\frac{(-1)^{n-k}}{(n-k)!}$\uff0c\u7136\u540e\u6709\n\n$$f_i=\\sum\\limits_{k}g_{k}h_{i+k}$$\n\n\u628a $h$ \u7ffb\u8f6c\u4e00\u4e0b\u505a\u4e2a\u5377\u79ef\u518d\u628a $f$ \u7ffb\u8f6c\u56de\u6765\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef int ll;\ntypedef long long int li;\nconst ll MAXN=524351,MOD=998244353,G=3,INVG=332748118;\nll fd,cnt,limit;\nll f[MAXN],g[MAXN],rev[MAXN],fact[MAXN],finv[MAXN];\ninline ll read()\n{\n    register ll num=0,neg=1;\n    register char ch=getchar();\n    while(!isdigit(ch)&&ch!='-')\n    {\n        ch=getchar();\n    }\n    if(ch=='-')\n    {\n        neg=-1;\n        ch=getchar();\n    }\n    while(isdigit(ch))\n    {\n        num=(num<<3)+(num<<1)+(ch-'0');\n        ch=getchar();\n    }\n    return num*neg;\n}\ninline ll qpow(ll base,ll exponent)\n{\n    li res=1;\n    while(exponent)\n    {\n        if(exponent&1)\n        {\n            res=1ll*res*base%MOD;\n        }\n        base=1ll*base*base%MOD,exponent>>=1;\n    }\n    return res;\n}\ninline void NTT(ll *cp,ll cnt,ll inv)\n{\n    ll cur=0,res=0,omg=0;\n    for(register int i=0;i<cnt;i++)\n    {\n        if(i<rev[i])\n        {\n            swap(cp[i],cp[rev[i]]);\n        }\n    }\n    for(register int i=2;i<=cnt;i<<=1)\n    {\n        cur=i>>1,res=qpow(inv==1?G:INVG,(MOD-1)/i);\n        for(register ll *p=cp;p!=cp+cnt;p+=i)\n        {\n            omg=1;\n            for(register int j=0;j<cur;j++)\n            {\n                ll t=1ll*omg*p[j+cur]%MOD,t2=p[j];\n                p[j+cur]=(t2-t+MOD)%MOD,p[j]=(t2+t)%MOD;\n                omg=1ll*omg*res%MOD;\n            }\n        }\n    }\n    if(inv==-1)\n    {\n        ll invl=qpow(cnt,MOD-2);\n        for(register int i=0;i<=cnt;i++)\n        {\n            cp[i]=1ll*cp[i]*invl%MOD;\n        }\n    }\n}\ninline void setup(ll cnt)\n{\n    fact[0]=finv[0]=1;\n    for(register int i=1;i<cnt;i++)\n    {\n        fact[i]=(li)fact[i-1]*i%MOD;\n    }\n    finv[cnt-1]=qpow(fact[cnt-1],MOD-2);\n    for(register int i=cnt-2;i;i--)\n    {\n        finv[i]=(li)finv[i+1]*(i+1)%MOD;\n    }\n}\nint main()\n{\n    setup((fd=read()+1)+10);\n    for(register int i=0;i<fd;i++)\n    {\n        f[i]=(li)(i&1?MOD-1:1)*finv[i]%MOD;\n        g[i]=(li)qpow(i,fd-1)*finv[i]%MOD;\n    }\n    cnt=1,limit=-1;\n    while(cnt<(fd<<1))\n    {\n        cnt<<=1,limit++;\n    }\n    for(register int i=0;i<cnt;i++)\n    {\n        rev[i]=(rev[i>>1]>>1)|((i&1)<<limit);\n    }\n    NTT(f,cnt,1),NTT(g,cnt,1);\n    for(register int i=0;i<cnt;i++)\n    {\n        f[i]=(li)f[i]*g[i]%MOD,g[i]=0;\n    }\n    NTT(f,cnt,-1);\n    for(register int i=0;i<fd;i++)\n    {\n        f[i]=(li)f[i]*fact[i]%MOD*fact[fd-1-i]%MOD;\n        g[i]=(fd-1-i)&1?MOD-finv[fd-1-i]:finv[fd-1-i];\n    }\n    for(register int i=fd;i<cnt;i++)\n    {\n    \tf[i]=g[i]=0;\n\t}\n    reverse(g,g+fd),NTT(f,cnt,1),NTT(g,cnt,1);\n    for(register int i=0;i<cnt;i++)\n    {\n    \tf[i]=(li)f[i]*g[i]%MOD;\n\t}\n\tNTT(f,cnt,-1),reverse(f,f+fd);\n\tfor(register int i=0;i<fd;i++)\n\t{\n\t\tprintf(\"%d \",(li)f[i]*finv[i]%MOD); \n\t}\n}\n```",
        "postTime": 1576584802,
        "uid": 60990,
        "name": "Karry5307",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5825 \u3010\u6392\u5217\u8ba1\u6570\u3011"
    },
    {
        "content": "\u51e0\u4e4e\u662f\u5bf9\u4e8e EI \u7684\u9898\u89e3\u7684\u4eba\u8bdd\u7ffb\u8bd1\u3002\n\n\u9996\u5148\u8f6c\u4e3a\u8ba1\u7b97\u6982\u7387\u3002\u8fd9\u53ea\u9700\u8981\u6700\u540e\u4e58\u4e0a $n!$\u3002  \n\u6211\u4eec\u8003\u8651\u4e00\u4e2a\u5728 $(0,1)^n$ \u4e0a\u5747\u5300\u968f\u673a\u7684\u5b9e\u6570\u5e8f\u5217 $a_1,a_2,\\dots,a_n$\uff0c\u5c06\u5176\u6392\u51fa\u6392\u540d\u3002\u6211\u4eec\u77e5\u9053\u4e24\u4e2a\u5b9e\u6570\u76f8\u7b49\u7684\u6982\u7387\u662f $0$\uff0c\u6240\u4ee5\u8fd9\u662f\u826f\u5b9a\u4e49\u7684\u3002  \n\u7136\u540e\u6839\u636e\u5f3a\u70c8\u7684\u5bf9\u79f0\u6027\uff0c\u6211\u4eec\u77e5\u9053\u6240\u6709 $n$ \u9636\u6392\u5217\u4e5f\u6ee1\u8db3\u540c\u6837\u7684\u5206\u5e03\u3002\u8fd9\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u8003\u8651 $a_1,a_2,\\dots,a_n$ \u5e8f\u5217\u7684\u4e00\u79cd\u6392\u540d\u7684\u51fa\u73b0\u6982\u7387\u5c31\u7b49\u4ef7\u4e8e\u540c\u79cd\u6392\u5217\u7684\u51fa\u73b0\u6982\u7387\u3002\n\n\u8003\u8651\u4ee4 $a_0 = 0$\uff0c\u6211\u4eec\u505a\u5176\u5dee\u5206 $b_i = (a_i - a_{i-1}) \\bmod 1$\u3002\u7531\u4e8e $a_i \\in (0,1)$\uff0c\u6211\u4eec\u77e5\u9053\u53ef\u4ee5\u901a\u8fc7 $b_i$ \u5e8f\u5217\u552f\u4e00\u786e\u5b9a $a_i$ \u5e8f\u5217\u3002  \n\u540c\u65f6\uff0c\u6211\u4eec\u6ce8\u610f\u5230 $b_i = a_i - a_{i-1} + [a_i < a_{i-1}]$\u3002\u5219\u53ef\u77e5 $\\sum b_i = a_n + n-1-k$\u3002\u7531\u4e8e\u6211\u4eec\u77e5\u9053 $n-1-k$ \u5fc5\u7136\u662f $\\sum b_i$ \u7684\u6574\u6570\u90e8\u5206\uff0c\u6240\u4ee5\u5b9e\u9645\u4e0a\u6211\u4eec\u4ec5\u8003\u8651 $b_i$ \u5e8f\u5217\u7684\u5206\u5e03\u548c\u5176 $\\sum b_i$ \u5373\u53ef\u5bf9 $n-1-k$ \u8fdb\u884c\u9650\u5236\u3002\n\n\u4e8e\u662f\u73b0\u5728\u95ee\u9898\u8f6c\u5316\u4e3a\u8ba1\u7b97 $b_1,b_2,\\dots,b_n \\in (0,1)^n$ \u4e14 $\\sum b_i \\in (n-1-k,n-k)$ \u7684\u6982\u7387\u3002  \n\u6211\u4eec\u53ef\u4ee5\u5dee\u5206\u4e3a $\\sum b_i < n-k$ \u548c $\\sum b_i < n-1-k$\u3002\n\n\u7136\u540e\u63a5\u4e0b\u6765\u7684\u4e00\u6b65\u6216\u8bb8\u4f1a\u8ba9\u5927\u90e8\u5206\u8bfb\u8005\u6709\u4e9b\u532a\u5937\u6240\u601d\u3002\u6211\u5c06\u5c3d\u6211\u6240\u80fd\u8ba9\u60a8\u7406\u89e3\u3002  \n\u5f62\u8c61\u5730\uff0c\u5047\u8bbe\u6211\u4eec\u7ed9\u5b9a $n$ \u4e2a $(0,1)$ \u5185\u7684\u533a\u95f4 $(l_i,r_i)$\uff0c\u95ee $\\forall i,b_i \\in [l_i,r_i]$ \u7684\u6982\u7387\u3002\u90a3\u81ea\u7136\u662f $\\prod \\frac{r_i-l_i}{1-0} = \\prod (r_i - l_i)$\u3002  \n\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u679c\u6211\u4eec\u6709\u529e\u6cd5\u7528\u4e00\u4e2a\u56fe\u50cf\u523b\u753b\u51fa\u8fd9\u4e2a\u5e8f\u5217\u843d\u5728\u6bcf\u4e00\u79cd\u53ef\u80fd\u6027\u4e2d\u662f\u5408\u6cd5\u6216\u975e\u6cd5\uff0c\u90a3\u4e48\u4e8b\u5b9e\u4e0a\u6700\u7ec8\u7684\u7b54\u6848\u5c31\u662f\u8fd9\u4e2a\u56fe\u5f62\u7684\u300c\u9762\u79ef\u300d\uff08\u8fd9\u4e5f\u662f\u6211\u4eec\u9009\u62e9 $(0,1)$ \u7684\u539f\u56e0\uff09\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651\u7528\u5bb9\u65a5\u6765\u523b\u753b\u8fd9\u4e2a\u56fe\u5f62\u7684\u300c\u9762\u79ef\u300d\uff0c\u8fd9\u662f\u4e3a\u4e86\u53bb\u9664 $b_i < 1$ \u7684\u9650\u5236\u3002  \n\u9996\u5148\u6211\u4eec\u8003\u8651 $b_i$ \u5b8c\u5168\u6ca1\u6709\u4e0a\u754c\uff0c$\\sum b_i < n-k$ \u7684\u300c\u9762\u79ef\u300d\u3002  \n\u6211\u4eec\u8f6c\u4e3a\u8003\u8651 $s_i = \\sum_{j \\le i} b_j$ \u7684\u300c\u9762\u79ef\u300d\uff0c\u5982\u679c\u4e0d\u8003\u8651\u5927\u5c0f\u5173\u7cfb\uff0c\u5b83\u5176\u5b9e\u5c31\u662f $(n-k)^n$\u3002\u4f46\u662f\u6211\u4eec\u53c8\u8981\u6c42 $b_i > 0$\uff0c\u56e0\u6b64 $s_i$ \u5fc5\u987b\u662f\u4e0a\u5347\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u518d\u9664\u4ee5 $n!$\u3002  \n\u5bf9\u4e8e\u67d0\u4e9b $b_i$ \u88ab\u94a6\u5b9a $\\ge 1$\uff0c\u6211\u4eec\u53ef\u4ee5\u4ece\u603b\u548c\u4e2d\u51cf\u53bb\u8fd9\u4e9b $1$\uff0c\u7136\u540e\u5c31\u8f6c\u4e3a\u4e86\u524d\u6587\u7684\u95ee\u9898\u3002  \n\u603b\u7ed3\u4e00\u4e0b\u5c31\u662f\n$$\n\\sum\\limits_{i=0}^{n-k} (-1)^i \\binom ni \\frac{(n-k-i)^n}{n!}\n$$\n\n\u53ef\u4ee5\u5377\u79ef\u89e3\u51b3\u3002",
        "postTime": 1617886760,
        "uid": 75840,
        "name": "deserter",
        "ccfLevel": 0,
        "title": "\u6b27\u62c9\u6570\u7684\u4e8c\u6b21\u666e\u53ca\u8ba1\u5212"
    },
    {
        "content": "### \u9898\u610f\n\n\u6211\u4eec\u8bb0\u4e00\u4e2a\u6392\u5217$P$\u7684\u5347\u9ad8\u4e3a$k$\u5f53\u4e14\u4ec5\u5f53\u5b58\u5728$k$\u4e2a\u4f4d\u7f6e$i$\u4f7f\u5f97$P_i<P_{i+1}$\n\n\u73b0\u5728\u7ed9\u5b9a\u6392\u5217\u957f\u5ea6$n$\uff0c\u5bf9\u4e8e\u6240\u6709\u6574\u6570$k\\in [0,n]$\u6c42\u6709\u591a\u5c11\u4e2a\u6392\u5217\u7684\u5347\u9ad8\u4e3a$k$\u3002\n\n$n\\leq 200,000$\n\n### $\\rm Sol$\n\n\u9996\u5148\u5199\u4e00\u4e2a\u9012\u63a8\u5f0f\uff0c\u4ee4$f(n,k)$\u8868\u793a\u7b54\u6848\uff0c\u5219\u6709\n\n$$\nf(n,k)=(n-k) \\cdot f(n-1,k-1) + (k + 1) \\cdot f(n-1,k)\n$$\n\n\u5176\u610f\u4e49\u662f\uff0c\u8003\u8651\u5c06\u8fd9\u4e2a\u5e8f\u5217\u7684\u5347\u9ad8\u4e0e\u5706\u6392\u5217\u7684\u5347\u9ad8\u4e4b\u95f4\u5efa\u7acb\u6620\u5c04\u3002\u5b9a\u4e49\u987a\u65f6\u9488\u4e3a\u6b63\u65b9\u5411\uff08\u5176\u5b9e\u987a\u65f6\u9488\u9006\u65f6\u9488\u662f\u5bf9\u79f0\u7684\uff09\u3002\n\n* \u4e00\u4e2a\u957f\u4e3a$n$\u3001\u5347\u9ad8\u4e3a$k$\u7684**\u5706\u6392\u5217**\uff0c\u6709$n-k$\u79cd\u65ad\u5f00\u7684\u65b9\u5f0f\uff0c\u4f7f\u4e4b\u53d8\u6210\u4e00\u4e2a\u957f\u4e3a$n$\uff0c\u5347\u9ad8\u4e3a$k$\u7684**\u5e8f\u5217**\uff1b\n\n* \u4e00\u4e2a\u957f\u4e3a$n$\uff0c\u5347\u9ad8\u4e3a$k+1$\u7684**\u5706\u6392\u5217**\uff0c\u6709$k+1$\u79cd\u65ad\u5f00\u65b9\u5f0f\uff0c\u4f7f\u4e4b\u53d8\u6210\u4e00\u4e2a\u957f\u4e3a$n$\uff0c\u5347\u9ad8\u4e3a$k$\u7684**\u5e8f\u5217**\u3002\n\n* \u4e00\u4e2a\u957f\u4e3a$n$\uff0c\u5347\u9ad8\u4e3a$k$\u7684**\u5706\u6392\u5217**\uff0c\u5220\u9664\u6389\u503c\u4e3a$n$\u7684\u90a3\u4e00\u9879\uff0c\u5219\u4e00\u5b9a\u4f1a\u5220\u9664\u6389\u6070\u597d$1$\u4e2a\u5347\u9ad8\uff0c\u6240\u4ee5\u5bf9\u5e94\u4e00\u4e2a\u957f\u4e3a$n-1$\uff0c\u5347\u9ad8\u4e3a$k-1$\u7684**\u5e8f\u5217**\u3002\n\n* \u4e00\u4e2a\u957f\u4e3a$n$\uff0c\u5347\u9ad8\u4e3a$k+1$\u7684**\u5706\u6392\u5217**\uff0c\u5220\u9664\u6389\u503c\u4e3a$n$\u7684\u90a3\u4e00\u9879\uff0c\u5219\u4e00\u5b9a\u4f1a\u5220\u9664\u6389\u6070\u597d$1$\u4e2a\u5347\u9ad8\uff0c\u6240\u4ee5\u5bf9\u5e94\u4e00\u4e2a\u957f\u4e3a$n-1$\uff0c\u5347\u9ad8\u4e3a$k$\u7684**\u5e8f\u5217**\u3002\n\n\n\u663e\u7136\u540e\u9762\u4e24\u6761\u7684\u9006\u64cd\u4f5c\u540c\u6837\u6210\u7acb\uff0c\u6240\u4ee5\u662f\u53cc\u5c04\u3002\n\n\u7136\u800c\u5176\u5b9e\u540e\u9762\u4e24\u6761\u662f\u7b49\u4ef7\u7684\uff0c\u53ea\u662f\u5e73\u79fb\u4e86\u4e00\u4e0b$k$\u2026233\n\n~~\u7136\u540e\u5c31\u53ef\u4ee5\u83b7\u5f97\u4e00\u4e2a$n^2$\u7b97\u6cd5\uff0c\u5f97\u5230$0pts$\u7684\u597d\u6210\u7ee9\u4e86~~\n\n_____\n\n\u4e4b\u540e\u5c31\u9700\u8981\u7528\u5230\u9ed1\u5b9d\u4e66\u2014\u2014 ~~\u300a\u6df7\u51dd\u571f\u6570\u5b66\u300b~~ \u300a\u5177\u4f53\u6570\u5b66\u300b\u4e86\u3002\n\n\u5177\u4f53\u6570\u5b66\u7684$6.2$\u63d0\u5230\u4e86\u8fd9\u4e2a\u6570\u5217\uff08\u8868\uff09\uff0c\u6709\u4e00\u4e2a\u516c\u5f0f\u662f\u957f\u8fd9\u6837\u7684\uff1a\n\n$$\nf(n,m)=\\sum _{k=0}^{m}\\binom{n+1}{k}(m+1-k)^n(-1)^k\n$$\n\n\u7136\u800c~~\u6df7\u51dd\u571f~~\u7f16\u8005\u5f53\u65f6\u90fd\u6ca1\u6709\u7ed9\u51fa\u8fd9\u4e1c\u897f\u662f\u600e\u4e48\u6765\u7684\uff0c~~\u5e76\u4e14\u54b1\u4e5f\u4e0d\u600e\u4e48\u4f1a\u63a8~~ \uff0c\u4e8e\u662f\u6216\u8bb8\u5c31\u53ef\u4ee5\u5f53\u4e2a\u7ed3\u8bba\u8bb0\u4f4f\uff1f\n\n\u4e0d\u8fc7\u5982\u679c\u8981\u662f\u8bc1\u660e\u5b83\u662f\u5bf9\u7684\u5012\u633a\u7b80\u5355\u2026\u2026\u5373\u8003\u8651\u628a\u4e0a\u5f0f\u8bb0\u4f5c\u8fd9\u4e2a\u6570\u5217**\u5173\u4e8e$\\bold n$\u7684$\\bold m$\u5c55\u5f00**\uff0c\u90a3\u4e48\u5927\u5bb6\u624b\u7b97\u4e00\u4e0b\u53d1\u73b0\u8fd9\u4e1c\u897f\u8ddf\u5173\u4e8e$n-1$\u7684$m-1$\u5c55\u5f00\u548c\u5173\u4e8e$n-1$\u7684$m$\u5c55\u5f00\uff0c\u5b58\u5728\u9012\u63a8\u5f62\u5f0f\uff0c\u4e14\u9012\u63a8\u5f62\u5f0f\u548c\u4e00\u5f00\u59cb\u7ed9\u51fa\u7684\u9012\u63a8\u5f0f\u76f8\u540c\uff1b\u52a0\u4e4b\u521d\u503c\u4e00\u6837\uff0c\u6240\u4ee5\u6210\u7acb\u3002\n\n\u2026\u2026\u7136\u540e\u5c31\u662f\u8ba1\u7b97\u751f\u6210\u51fd\u6570\uff0c\u8003\u8651\u5982\u4f55\u8ba1\u7b97\u7b2c$n$\u884c\u7684$\\bold {OGF}$\n\n\u901a\u8fc7\u89c2\u5bdf\u6cd5\uff0c\u53ef\u4ee5\u53d1\u73b0\u4f5c\u4e3a\u7b2c$m$\u9879\u7cfb\u6570\u7684\u8fd9\u4e2a\u548c\u5f0f\uff0c\u5176\u4e2d$\\sum _{k=0}^{m}\\binom{n+1}{k}(-1)^k$\u662f\u4e00\u4e2a\u4e8c\u9879\u5f0f\u7684\u5c55\u5f00\uff0c\u518d\u5c06$(m+1-k)^n$\u8fd9\u4e1c\u897f\u5bf9\u79f0\u5904\u7406\u4e00\u4e0b\uff0c~~\u901a\u8fc7\u7b80\u5355\u7684\u7ed3\u5408\u5f8b~~ \u5c31\u53ef\u4ee5\u5f97\u5230\u5b83\u7684$\\bold{OGF}$:\n\n$$\n(1-x)^{n+1}\\sum_{k=0}^{n} (k+1)^nx^{k}\n$$\n\n~~\u4e0a\u8ff0\u8fc7\u7a0b\u5b8c\u5168\u53ef\u4ee5\u53bbOEIS\u4e0a\u627e\uff0c\u53ef\u4ee5\u7b80\u5316\u4e00\u7cfb\u5217\u731c\u7ed3\u8bba+\u9a8c\u8bc1\u7ed3\u8bba\u7684\u8fc7\u7a0b~~\n\n\u7136\u540e\u5c31\u662f\u4e00\u4e2a\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u4e86\u2026\u2026\n\n\u7136\u800c\u6734\u7d20\u7684\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u662f$\\log^2$\uff0c~~\u518d\u52a0\u4e0aNTT\u672c\u8eab>O(log n)\u7684\u5e38\u6570~~\u53d1\u73b0\u5e76\u4e0d\u53ef\u4ee5\u8fc7\u2026\u2026\u4f46\u5b9e\u9645\u4e0a$(1-x)^n$\u72b6\u7269\u5c31\u662f\u4e2a\u6768\u8f89\u4e09\u89d2\uff0c\u4e8e\u662f\u7ec4\u5408\u6570\u7b97\u4e00\u4e0b\u5c31\u5b8c\u4e86.jpg\n\n\uff08\u622a\u6b62\u5230\u6211\u5199\u4e0b\u8fd9\u4e00\u884c\u5b57\u4e3a\u6b62\uff0c\u6211\u7684code\u8fd8\u662f\u6700\u5feb\u7684\uff09\n\n```cpp\n\nint main(){\n    cin >> PL ; \n    K = PL += 1 ; int i, j ;\n    for (i = 0 ; i < 19  ;++ i){\n        rr int *rua = gg[i] ; rua[0] = 1 ;\n        rr int gi = rua[1] = expow(3, 998244352/(1 << (i + 1))) ;\n        for (j = 2 ; j < (1 << i) ; ++ j) \n            rua[j] = 1ll * rua[j - 1] * gi % P ;\n    }\n    M = 1 ;\n    while (M <= (PL << 1)) M <<= 1, ++ l ;\n    for (i = 0 ; i < M ; ++ i) \n        R[i] = (R[i >> 1] >> 1) | ((i & 1) << (l - 1)) ;\n    F[0] = 1, F[1] = -1, \n    A[0] = 1, Fac[0] = Inv[0] = 1 ;\n    for (i = 1 ; i <= PL ; ++ i) \n        Fac[i] = 1ll * Fac[i - 1] * i % P ;\n    Inv[PL] = expow(qwq = Fac[PL], P - 2) ; \n    for (i = PL - 1 ; i ; -- i) \n        Inv[i] = 1ll * Inv[i + 1] * (i + 1) % P ;\n    for (i = 0 ; i <= PL ; ++ i) \n        A[i] = (i & 1) ? P - Comb(i) : Comb(i) ;\n    for (i = 0 ; i <= PL ; ++ i) \n        S[i] = expow(i + 1, PL - 1) ;\n    NTT(A, M, 1), NTT(S, M, 1) ;\n    for (i = 0 ; i <= M ; ++ i) \n        S[i] = 1ll * S[i] * A[i] % P ;\n    NTT(S, M, -1) ;\n    for (i = 0 ; i < PL ; ++ i) printf(\"%d \", S[i]) ;\n    return 0 ;\n}\n```\n\n\n\u8bb2\u9053\u7406\uff0c\u6700\u540e\u662f\u4e0d\u662f\u5e94\u8be5%\u4e00\u4e0b\u51fa\u9898\u4eba\u554a\uff0c%%%$\\sf{\\color{black}{K}\\color{red}{arry5307}}$\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "postTime": 1576544763,
        "uid": 28313,
        "name": "\u768e\u6708\u534a\u6d12\u82b1",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5825 \u3010\u6392\u5217\u8ba1\u6570\u3011"
    },
    {
        "content": "EI\u7684\u7ec4\u5408\u610f\u4e49\u5927\u6cd5\u548c\u5176\u4ed6\u5de8\u4f6c\u7684\u6570\u5b66\u5f52\u7eb3\u6cd5\u592a\u795e\u4ed9\u5566\uff01\n\n\u8fd9\u91cc\u53c2\u8003 command_block \u7684\u535a\u5ba2\uff0c\u5199\u4e86\u4e00\u79cd\u66b4\u529b\u751f\u6210\u51fd\u6570\u63a8\u5bfc\u7684\u505a\u6cd5\n\n\u6309\u4e00\u822c\u5957\u8def\u628a\u201c\u6070\u597d\u201d\u53cd\u6f14\u6389\u3002\u8bbe $f(k)$ \u8868\u793a\u94a6\u5b9a\u6709 $k$ \u6b21\u5347\u9ad8\u7684\u65b9\u6848\u6570\u3002\u94a6\u5b9a\u4e00\u4e9b\u4f4d\u7f6e\u586b\u5c0f\u4e8e\u53f7\u540e\u5bf9\u6570\u5217\u201c\u5206\u6bb5\u201d\uff0c\u6bcf\u4e2a\u5c0f\u4e8e\u53f7\u5c06\u5b83\u5de6\u53f3\u5408\u5e76\u4e3a\u4e00\u6bb5\u3002\n\n\u5355\u72ec\u8003\u8651\u6bcf\u4e2a\u6bb5\u7684\u8d21\u732e\uff0c\u5176 EGF \u5373\u4e3a $\\sum\\limits_{i=1}=\\frac{x^i}{i!}=e^x-1$\u3002\n\u5982\u679c\u94a6\u5b9a\u6709 $k$ \u4e2a\u5347\u9ad8\uff0c\u5219\u6709 $m=n-k$ \u4e2a\u6bb5\uff0c\u5f97\u5230\n$$\n\t\t\t\\begin{aligned}\n\t\t\t\t[x^n](e^x-1)^m=&[x^n]\\sum_{i=0}^{m}{m\\choose i}e^{ix}(-1)^{m-i}\\\\\n\t\t\t\t=&\\sum_{i=0}^{m}{m\\choose i}\\frac{i^n}{n!}(-1)^{m-i}\\\\\n\t\t\t\t=&\\frac{m!}{n!}\\sum_{i=0}^m\\frac{i^n}{i!}\\frac{(-1)^{m-i}}{(m-i)!}\n\t\t\t\\end{aligned}\t\n$$\n\n\u6309\u8fd9\u4e2a\u5f0f\u5b50\u5377\u79ef\u4e00\u6b21\u518d\u4e8c\u9879\u5f0f\u53cd\u6f14\u4e00\u6b21\u5373\u53ef\u5f97\u5230\u7b54\u6848\uff0c\u4f46\u6211\u4eec\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u5316\u7b80\n$$\n\t\t\\begin{aligned}\n\t\t\t\\left\\langle\\begin{matrix}n \\\\ k\\end{matrix}\\right\\rangle&=n!\\sum\\limits_{i=k}^n\\dbinom{i}{k}(-1)^{i-k}[x^n](e^x-1)^{n-i}\\\\ &=n!\\sum\\limits_{i=k}^n\\dbinom{i}{k}(-1)^{i-k}\\sum\\limits_{j=0}^{n-i}\\dbinom{n-i}{j}(-1)^{n-i-j}[x^n]e^{xj}\\\\ &=n!\\sum\\limits_{i=k}^n\\dbinom{i}{k}(-1)^{i-k}\\sum\\limits_{j=0}^{n-k}\\dbinom{n-i}{j}(-1)^{n-i-j}\\dfrac{j^n}{n!}\\\\ &=\\sum\\limits_{j=0}^{n-k}(-1)^{n-k-j}j^n\\sum\\limits_{i=k}^n\\dbinom{i}{k}\\dbinom{n-i}{j}\\\\ &=\\sum\\limits_{j=0}^{n-k}(-1)^{n-k-j}j^n\\dbinom{n+1}{k+j+1}\\\\ \n\t\t\\end{aligned}\t\n$$\n\u5176\u4e2d\u5012\u6570\u7b2c\u4e8c\u6b65\u4e2d ${i\\choose k}=[x^{i-k}]\\frac{1}{(1-x)^{k+1}},{n-i\\choose j}=[x^{n-i-j}]\\frac{1}{(1-x)^{j+1}}$\uff0c\u5219\u5b83\u4eec\u5377\u8d77\u6765\u5f97\u5230 $[x^{n-k-j}]\\frac{1}{(1-x)^{k+j+2}}={n+1\\choose k+j+1}$\n\n\u4e8e\u662f\u6211\u4eec\u53ea\u9700\u8981\u505a\u4e00\u904d\u5dee\u5377\u79ef\u5373\u53ef\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nnamespace FGF\n{\n\tconst int N=1e6+5,mo=998244353,g=3,gi=(mo+1)/3;\n\tint n,m,a[N],fac[N],inv[N],b[N],lim,r[N];\n\tint qpow(int x,int y)\n\t{\n\t\tint s=1;\n\t\twhile(y)\n\t\t{\n\t\t\tif(y&1)s=1ll*s*x%mo;\n\t\t\tx=1ll*x*x%mo;\n\t\t\ty>>=1;\n\t\t}\n\t\treturn s;\n\t}\n\tvoid NTT(int *y,int op)\n\t{\n\t\tfor(int i=0;i<lim;i++)\n\t\t\tif(r[i]<i)swap(y[r[i]],y[i]);\n\t\tfor(int l=1;l<lim;l<<=1)\n\t\t\tfor(int i=0,wn=qpow(op==1?g:gi,(mo-1)/(l<<1));i<lim;i+=(l<<1))\n\t\t\t\tfor(int j=0,w=1;j<l;j++,w=1ll*w*wn%mo)\n\t\t\t\t{\n\t\t\t\t\tint tmp=(y[i+j]-1ll*y[i+j+l]*w%mo+mo)%mo;\n\t\t\t\t\ty[i+j]=(y[i+j]+1ll*y[i+j+l]*w%mo)%mo,y[i+j+l]=tmp;\n\t\t\t\t}\n\t\tif(op==-1)\n\t\t\tfor(int i=0,inv=qpow(lim,mo-2);i<lim;i++)\n\t\t\t\ty[i]=1ll*y[i]*inv%mo;\n\t}\n\tvoid work()\n\t{\n\t\tscanf(\"%d\",&n);\n\t\tfac[0]=inv[1]=inv[0]=1;\n\t\tfor(int i=2;i<=n+1;i++)\n\t\t\tinv[i]=1ll*inv[mo%i]*(mo-mo/i)%mo;\n\t\tfor(int i=1;i<=n+1;i++)\n\t\t\tfac[i]=1ll*i*fac[i-1]%mo,inv[i]=1ll*inv[i-1]*inv[i]%mo;\n\t\tfor(int i=0;i<=n;i++)\n\t\t\ta[i]=((((n-i)&1)?-1ll:1ll)*inv[i+1]*inv[n-i]%mo+mo)%mo;\n\t\tfor(int i=0;i<=n;i++)\n\t\t\tb[i]=qpow(i,n);\n\t\treverse(a,a+n+1);\n\t\tfor(lim=1;lim<(n+n+2);lim<<=1);\n\t\tfor(int i=0;i<lim;i++)r[i]=r[i>>1]>>1|(i&1)*(lim>>1);\n\t\tNTT(a,1),NTT(b,1);\n\t\tfor(int i=0;i<lim;i++)a[i]=1ll*a[i]*b[i]%mo;\n\t\tNTT(a,-1);\n\t\treverse(a,a+n+1);\n\t\tfor(int i=0;i<=n;i++)\n\t\t\tprintf(\"%lld \",1ll*a[i]*fac[n+1]%mo);\n\t\t\t\n\t}\n}\nint main()\n{\n\tFGF::work();\n\treturn 0;\n}\n```\n\t\t\n\u8fd8\u6709\u4e00\u4e2a\u4e0d\u77e5\u9053\u6709\u6ca1\u6709\u7528\u7684\u7ed3\u8bba\n$$\nx^n=\\sum\\limits_{k=0}^n\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle\\dbinom{x+k}{n}\n$$\n\t\t",
        "postTime": 1615283394,
        "uid": 224403,
        "name": "\u6728xx\u6728\u5927",
        "ccfLevel": 9,
        "title": "P5825 \u6392\u5217\u8ba1\u6570\uff08\u6b27\u62c9\u6570\uff09"
    },
    {
        "content": "\u7ed9 EI \u7684\u9898\u89e3\u7684\u7ffb\u8bd1\u518d\u505a\u4e00\u6b21\u7ffb\u8bd1\n\n\u9996\u5148\u8003\u8651\u4e00\u4e2a\u7b80\u5355\u7684\u8f6c\u5316\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u6574\u6570\u4e0a\u7684\u504f\u5e8f\u5173\u7cfb\u4e22\u5230\u5b9e\u6570\u4e0a\uff0c\u5177\u4f53\u7684\n\n$\\frac{\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle}{n!}$ \u8868\u793a $(0,1)$ \u4e2d\u5747\u5300\u968f\u673a $n$ \u4e2a\u5b9e\u6570 $\\{a_i\\}$ \uff0c\u6709 $k$ \u4e2a\u5347\u9ad8\u5373 $\\displaystyle \\sum_{i=1}^{n-1} [a_{i+1}>a_i]=k$ \u7684\u6982\u7387\n\n\u4f9d\u7136\u4e0d\u597d\u6c42\uff0c\u8003\u8651\u5dee\u5206,\u6ce8\u610f\u5230\u8fd9\u6837\u4f1a\u51fa\u8d1f\u6570\u7136\u540e\u63a5\u4e0b\u6765\u662f\u7cbe\u5999\u7684\u4e00\u6b65\uff0c\u4ee4 $b_i=a_i-a_{i-1}\\mod 1=a_i-a_{i-1}+[a_i<a_{i-1}]$ \uff0c\u5219\u6709 $\\forall i,b_i\\in(0,1)$ (\u6ce8\u610f\u5230\u8fd9\u6837\u8868\u793a\u7684\u597d\u5904\u5f88\u5927\uff0c\u9996\u5148\u662f\u503c\u57df\u7edf\u4e00\u4e86\uff0c\u7136\u540e\u4e5f\u80fd\u591f\u552f\u4e00\u8fd8\u539f\u56de\u771f\u6b63\u7684\u5dee\u5206\u6570\u7ec4\u4ece\u800c\u8fd8\u539f\u56de\u539f\u6570\u7ec4\u4e86\uff0c\u6839\u636e\u524d\u7f00\u548c\u53ef\u4ee5\u5feb\u901f\u5224\u51fa\u5230\u5e95\u6709\u6ca1\u6709$+1$) \n\n\u5bf9 $b_i$ \u6211\u4eec\u8003\u5bdf\u5176\u6027\u8d28\uff0c\u6613\u6709 $\\displaystyle \\sum_{i=1}^n b_i=\\displaystyle \\sum_{i=1}^n a_i-a_{i-1}+\\sum_{i=1}^{n}[a_i<a_{i-1}]=a_n+n-1-k$\n\n\u56e0\u6b64\u6709 $\\displaystyle \\sum_{i=1}^n b_i\\in(n-k-1,n-k)$\n\n\u73b0\u5728\u95ee\u9898\u88ab\u5b8c\u5168\u8f6c\u5316\u4e3a\u4ee5\u4e0b\u5f62\u5f0f\n\n> $(0,1)$ \u4e2d\u5747\u5300\u968f\u673a $n$ \u4e2a\u5b9e\u6570 $\\{b_i\\}$\uff0c$\\sum b_i<x$ \u7684\u6982\u7387\n\n\u4e0d\u59a8\u8bbe\u95ee\u9898\u7684\u7b54\u6848\u4e3a $F(x)$ \n\n\u63a5\u4e0b\u6765\u662f\u66f4\u7cbe\u5999\u7684\u4e00\u6b65\uff0c\u6ce8\u610f\u5230 $b_i$ \u4e4b\u95f4\u8fde\u63a5\u4e0d\u7d27\u5bc6\uff0c\u9650\u5236\u53ea\u5bf9\u5176\u6574\u4f53\u4f5c\u7528\uff0c\u56e0\u6b64\u8003\u8651\u5bf9 $\\displaystyle c_i=\\sum_{j=1}^i b_j$ \u8fdb\u4e00\u6b65\u7814\u7a76\n\n\u95ee\u9898\u597d\u50cf\u53ef\u4ee5\u8f6c\u4e3a\n\n> $(0,x)$ \u4e2d\u5747\u5300\u968f\u673a $n$ \u4e2a\u5b9e\u6570 $\\{c_i\\}$\uff0c$\\forall i\\in[1,n),c_{i+1}-c_i\\in(0,1)$\u7684\u6982\u7387\u3002\u5417?\n\n\u4f46\u662f\u8fd9\u662f\u9519\u7684\uff0c\u6b63\u786e\u7684\u8bf4\u6cd5\u662f\n\n> $(0,x)$ \u4e2d\u5747\u5300\u968f\u673a $n$ \u4e2a\u5b9e\u6570 $\\{c_i\\}$\uff0c$\\forall i\\in[1,n),c_{i+1}-c_i\\in(0,1)$\u7684\u6d4b\u5ea6\n\n\u5173\u4e8e\u8fd9\u4e2a\u7384\u5999\u7684\u4e8b\u5b9e\u6211\u4eec\u53ef\u4ee5\u6709\u4e00\u4e2a\u611f\u6027\u7684\u7406\u89e3\n\n\u90a3\u5c31\u662f\u6211\u4eec\u539f\u6765\u6c42\u7684\u662f $(0,1)^n$ \u8fd9\u4e2a $n$ \u7ef4\u7a7a\u95f4\u4e2d\u95f4\u7684\u5408\u6cd5\u7684\u70b9\u96c6\u6240\u5360\u6574\u4e2a\u7a7a\u95f4\u6d4b\u5ea6\u7684\u6bd4\u4f8b\uff0c\u800c\u73b0\u5728\u6982\u7387\u7a7a\u95f4\u7684\u6d4b\u5ea6\u6269\u5927\uff0c\u5408\u6cd5\u7684\u70b9\u96c6\u7684\u6d4b\u5ea6\u6ca1\u6709\u81a8\u80c0(\u610f\u601d\u5c31\u662f\u6c42\u6982\u7387\u7528\u7684\u5206\u5b50\u6ca1\u53d8\u5206\u6bcd\u53d8,\u5177\u4f53\u7684\u539f\u56e0\u662f\u6709\u4e00\u4e9b\u70b9\u7ef4\u5ea6\u95f4\u4e0d\u5355\u8c03\u65e0\u6cd5\u8868\u793a\u5bf9\u539f\u6982\u7387\u7a7a\u95f4\u4e2d\u7684\u4e00\u4e2a\u70b9\u65bd\u52a0\u524d\u7f00\u548c\u53d8\u6362\u7684\u7ed3\u679c\uff0c\u8fd9\u4e9b\u70b9\u672c\u6765\u4e0d\u5b58\u5728\u4e8e\u539f\u95ee\u9898\u6982\u7387\u7a7a\u95f4\u4e2d)\uff0c\u56e0\u6b64\u6211\u4eec\u4e0d\u80fd\u6570\u6bd4\u4f8b(\u6982\u7387)\u800c\u5e94\u8be5\u76f4\u63a5\u6570\u6d4b\u5ea6\u76f8\u5f53\u4e8e\u628a\u5206\u6bcd\u4ece $x^n$ \u6539\u56de $1^n$\n\n\u5177\u4f53\u6765\u8bf4\uff0c\u5728 $(0,x)$ \u5747\u5300\u968f\u673a $n$ \u4e2a\u5b9e\u6570\u6ee1\u8db3\u67d0\u79cd\u7279\u5b9a\u7684\u5e8f\u5173\u7cfb\u7684\u6d4b\u5ea6\u4e3a $\\frac{x^n}{n!}$\n\n\u4e0b\u9762\u662f $n=2$ \u7684\u4e00\u4e2a\u89e3\u91ca\n\n![](https://pic.imgdb.cn/item/618728af2ab3f51d91fcfed9.png)\n\n\u5173\u4e8e\u4e0a\u754c\u94a6\u5b9a\u6709\u51e0\u4e2a\u76f8\u90bb\u5143\u7d20\u7684\u5dee $>1$ \uff0c\u505a\u4e2a\u5bb9\u65a5,\u4eec\u6709 $F(x)=\\displaystyle \\sum_{i=0}^{x}\\binom{n}{i}(-1)^i \\frac{(x-i)^n}{n!}$\n\n\u7b54\u6848\u4e3a $F(n-k)-F(n-k-1)$",
        "postTime": 1636248174,
        "uid": 40629,
        "name": "zzw4257",
        "ccfLevel": 0,
        "title": "P5825 \u6392\u5217\u8ba1\u6570"
    },
    {
        "content": "~~MD\u518d\u4e5f\u4e0d\u76f4\u63a5\u8d4b\u70b9\u503c\u4e86~~\n\n~~\u597d\u6c34\u7684\u6a21\u677f\u554a\uff0c\u4e0d\u5982\u6539\u6210\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\u2014\u2014By Fading~~\n\n~~\u770b\u89c1\u82b1\u59d0\u59d0\u653e\u51fa\u516c\u5f0f\u6ca1\u6709\u8bc1\u660e\u8bd5\u4e86\u8bd5\u7ed3\u679c\u8bc1\u51fa\u6765\u4e86\uff08\u5927\u96fe~~\n\n~~\u5176\u5b9e\u5177\u4f53\u6570\u5b66\u6211\u662f\u770b\u8fc7\u4e86\u7684~~\n\n\u9996\u5148\u6211\u4eec\u8981\u77e5\u9053\u8fd9\u6837\u4e00\u4e2a\u4e1c\u897f\u53eb\u505a\u6b27\u62c9\u6570~~\u867d\u7136\u4f60\u4e0a\u641c\u7d22\u5f15\u64ce\u641c\u5230\u7684\u6b27\u62c9\u6570\u57fa\u672c\u4e0d\u662f\u8fd9\u4e2a\u4e1c\u897f~~\n\n\u7528$\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle$\u8868\u793a\u957f\u5ea6\u4e3a$n$\u4e14\u5347\u9ad8\u4e3a$k$\u4e2a\u6392\u5217\u7684\u4e2a\u6570\u3002\n\n\u9996\u5148\u6709\u4e2a\u9012\u63a8\u5f0f\uff1a\n\n$$\\left\\langle\\begin{matrix}n\\\\k\\end{matrix}\\right\\rangle=(k+1)\\left\\langle\\begin{matrix}n-1\\\\k\\end{matrix}\\right\\rangle+(n-k)\\left\\langle\\begin{matrix}n-1\\\\k-1\\end{matrix}\\right\\rangle$$\n\n\u8fd9\u4e2a\u53ef\u4ee5\u5229\u7528\u5176\u7ec4\u5408\u610f\u4e49\u5f88\u5bb9\u6613\u8bc1\u660e\uff0c$\\color{black}\\mathsf{K}\\color{red}\\mathsf{arry}$\u548c\u82b1\u59d0\u59d0\u4e5f\u8bc1\u8fc7\u4e86\uff0c\u5728\u6b64\u5c31\u4e0d\u8d58\u8ff0\u4e86\u3002\n\n\u7136\u540e\u6211\u4eec\u6839\u636e\u8fd9\u4e2a\u9012\u63a8\u5f0f\uff0c\u53ef\u4ee5\u5f97\u51fa\u4e00\u4e2a\u5f0f\u5b50\uff08\u300a\u5177\u4f53\u6570\u5b66\u300bP225\uff09\uff1a\n\n$$\\left\\langle\\begin{matrix}n\\\\m\\end{matrix}\\right\\rangle=\\sum_{k=0}^{m}\\binom{n+1}{k}(-1)^k(m+1-k)^n$$\n\n\u5c1d\u8bd5\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bc1\u3002\n\n$$\\left\\langle\\begin{matrix}n\\\\m\\end{matrix}\\right\\rangle=(m+1)\\left\\langle\\begin{matrix}n-1\\\\m\\end{matrix}\\right\\rangle+(n-m)\\left\\langle\\begin{matrix}n-1\\\\m-1\\end{matrix}\\right\\rangle$$\n\n$$=(m+1)\\sum_{k=0}^{m}\\binom{n}{k}(-1)^k(m+1-k)^{n-1}+(n-m)\\sum_{k=0}^{m-1}\\binom{n}{k}(-1)^k(m-k)^{n-1}$$\n\n$$=\\sum_{k=0}^{m}\\binom{n}{k}(-1)^k\\left[(m+1)(m+1-k)^{n-1}+(n-m)(m-k)^{n-1}\\right]$$\n\n$$=\\sum_{k=0}^{m}\\binom{n}{k}(-1)^k\\left[(m+1-k)^n+k(m+1-k)^{n-1}+(n-m)(m-k)^{n-1}\\right]$$\n\n$$=\\left(\\sum_{k=0}^{m}\\binom{n}{k}(-1)^k(m+1-k)^n\\right)+\\left(\\sum_{k=0}^{m}\\binom{n}{k}(-1)^k\\dfrac{k}{m+1-k}(m+1-k)^n\\right)+\\left(\\sum_{k=0}^{m}\\binom{n}{k}(-1)^k(n-m)(m-k)^{n-1}\\right)$$\n\n$$=\\left(\\sum_{k=0}^{m}\\left(\\binom{n}{k}+\\binom{n}{k-1}\\right)(-1)^k(m+1-k)^n\\right)+\\left(\\sum_{k=0}^{m}\\binom{n}{k}(-1)^k(n-m)(m-k)^{n-1}\\right)-\\left(\\sum_{k=0}^{m}k\\left(\\dfrac{1}{n+1-k}-\\dfrac{1}{m+1-k}\\right)\\binom{n}{k}(-1)^k(m+1-k)^n\\right)$$\n\n\u5176\u4e2d\n\n$$\\left(\\sum_{k=0}^{m}\\binom{n}{k}(-1)^k(n-m)(m-k)^{n-1}\\right)-\\left(\\sum_{k=0}^{m}k\\left(\\dfrac{1}{n+1-k}-\\dfrac{1}{m+1-k}\\right)\\binom{n}{k}(-1)^k(m+1-k)^n\\right)$$\n\n\u5c06\u88ab\u51cf\u7684\u6c42\u548c\u5f0f\u4e2d$k$\u7528$k+1$\u4ee3\u66ff\uff08\u5bb9\u6613\u53d1\u73b0$k=m$\u7684\u9879\u4e3a$0$\uff0c\u4e14\u51cf\u53f7\u540e\u7684\u6c42\u548c\u5f0f\u4e2d$k=0$\u7684\u9879\u4e3a$0$\uff09\u5f97\u5230\uff1a\n\n$$\\left(\\sum_{k=1}^{m}\\binom{n}{k-1}(-1)^{k-1}(n-m)(m+1-k)^{n-1}\\right)-\\left(\\sum_{k=1}^{m}k\\left(\\dfrac{m-n}{(n+1-k)(m+1-k)}\\right)\\binom{n}{k}(-1)^k(m+1-k)^n\\right)$$\n\n$$=\\sum_{k=1}^{m}\\binom{n}{k-1}(-1)^{k-1}(n-m)(m+1-k)^{n-1}-\\left(\\dfrac{k}{n+1-k}\\binom{n}{k}\\right)(-1)^k(m-n)(m+1-k)^{n-1}$$\n\n\u5bb9\u6613\u770b\u51fa\u4e0a\u5f0f\u4e3a$0$\u3002\n\n\u6240\u4ee5\n\n$$\\left\\langle\\begin{matrix}n\\\\m\\end{matrix}\\right\\rangle=\\sum_{k=0}^{m}\\left(\\binom{n}{k}+\\binom{n}{k-1}\\right)(-1)^k(m+1-k)^n$$\n\n$$=\\sum_{k=0}^{m}\\binom{n+1}{k}(-1)^k(m+1-k)^n$$\n\n\u8fb9\u754c\u4e3a$m=0$\u65f6$\\left\\langle\\begin{matrix}n\\\\m\\end{matrix}\\right\\rangle=1$\uff0c$n=0$\u4e14$m\\neq 0$\u65f6$\\left\\langle\\begin{matrix}n\\\\m\\end{matrix}\\right\\rangle=0$\uff0c\u663e\u7136\u6ee1\u8db3\u516c\u5f0f\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5feb\u4e50\u5730\u6784\u9020\u4e24\u4e2a\u51fd\u6570\uff1a\n\n$$f(x)=\\sum_k \\binom{n+1}{k}(-1)^kx^k$$\n\n\u4e0e\n\n$$g(x)=\\sum_k (k+1)^n$$\n\n\u7136\u540e\u6c42\u4e2a\u5377\u79ef\u5c31\u5b8c\u4e86\u3002\n\nCode:\n```cpp\n#include<cmath>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\n#define rg register\n#define ll long long\nconst int o=998244353;\nint N,M,Q,L=1,l=0;\nint rev[600007];\nll f[600007],g[600007],h[600007],frc[600007],fic[600007];\nvoid exgcd(ll a,ll b,ll &d,ll &x,ll &y)\n{\n\t(b)?(exgcd(b,a%b,d,y,x),y-=x*(a/b)):(x=1,y=0,d=a);\n}\ninline ll _inv(ll a)\n{\n\tll d,x,y;\n\texgcd(a,o,d,x,y);\n\treturn (d==1)?(x+o)%o:-1;\n}\ninline ll qpw(rg ll x,rg ll k)\n{\n\trg ll r=1;\n\twhile(k)\n\t{\n\t\t(k&1)&&(r=r*x%o),x=x*x%o,k>>=1;\n\t}\n\treturn r;\n}\ninline void NTT(ll *a,int opt)\n{\n\tfor(rg int i=0;i<L;++i)\n\t{\n\t\tif(i<rev[i])\n\t\t{\n\t\t\ta[i]^=a[rev[i]]^=a[i]^=a[rev[i]];\n\t\t}\n\t}\n\tfor(rg int m=1;m<L;m<<=1)\n\t{\n\t\trg ll tmp=qpw(3,(o-1)/(m<<1)*opt+o-1);\n\t\tfor(rg int s=0;s<L;s+=m<<1)\n\t\t{\n\t\t\trg ll u=1;\n\t\t\tfor(rg int t=0;t<m;++t,u=u*tmp%o)\n\t\t\t{\n\t\t\t\tll a1=a[s+t],a2=a[s+t+m]*u%o;\n\t\t\t\ta[s+t]=(a1+a2)%o,a[s+t+m]=(a1-a2+o)%o;\n\t\t\t}\n\t\t}\n\t}\n\tif(~opt)return;\n\tQ=_inv(L);\n\tfor(rg int i=0;i<L;++i)a[i]=a[i]*Q%o;\n}\nint main()\n{\n\tscanf(\" %d\",&N);\n\tfrc[0]=1;for(int i=1;i<=N+1;++i)frc[i]=frc[i-1]*i%o;\n\tfic[N+1]=_inv(frc[N+1]);for(int i=N;~i;--i)fic[i]=fic[i+1]*(i+1)%o;\n\tfor(int i=0;i<=N;++i)g[i]=qpw(i+1,N),f[i]=frc[N+1]*fic[i]%o*fic[N+1-i]%o*((i&1)?o-1:1)%o;\n\twhile(L<=(N<<1))L<<=1,++l;\n\tfor(int i=0;i<L;++i)\n\t{\n\t\trev[i]=(rev[i>>1]>>1)|((i&1)<<(l-1));\n\t}\n\tNTT(f,1);\n\tNTT(g,1);\n\tfor(int i=0;i<L;++i)\n\t{\n\t\th[i]=f[i]*g[i]%o;\n\t}\n\tNTT(h,-1);\n\tfor(int i=0;i<=N;++i)\n\t{\n\t\tprintf(\"%lld \",h[i]);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1576649259,
        "uid": 59388,
        "name": "VinstaG173",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5825 \u3010\u6392\u5217\u8ba1\u6570\u3011"
    },
    {
        "content": "\u4e0d\u4f1a\u751f\u6210\u51fd\u6570\uff0c\u4e0d\u4f1a\u7ec4\u5408\u610f\u4e49\uff0c\u66f4\u4e0d\u4f1a\u5177\u4f53\u6570\u5b66\u3002\n\n------------\n\n\u8003\u8651\u5148\u5bf9\u5347\u9ad8\u5bb9\u65a5\uff0c\u94a6\u5b9a $k$ \u4e2a\u4f4d\u7f6e\u662f\u5347\u9ad8\uff0c\u5176\u4ed6\u4f4d\u7f6e\u4efb\u610f\u3002\u8fd9\u65f6\u5c06\u5e8f\u5217\u5206\u4e3a\u4e86 $n-k$ \u6bb5\uff0c\u6bcf\u6bb5\u9700\u8981\u6ee1\u8db3\u5355\u8c03\u9012\u589e\u3002\u95ee\u9898\u53d8\u6210\u4e86\u628a $1\\sim n$ \u653e\u5165 $n-k$ \u4e2a\u6709\u6807\u53f7\u7684\u96c6\u5408\uff0c\u4f7f\u5f97\u6bcf\u4e2a\u96c6\u5408\u4e0d\u4e3a\u7a7a\u7684\u65b9\u6848\u6570\u3002\n\n\u518d\u5bf9\u7a7a\u96c6\u5408\u5bb9\u65a5\u3002\u94a6\u5b9a\u8fd9 $n-k$ \u4e2a\u96c6\u5408\u4e2d\u7684 $p$ \u4e2a\u96c6\u5408\u4e3a\u7a7a\uff0c\u5176\u4ed6\u96c6\u5408\u4efb\u610f\u3002\u90a3\u4e48\u95ee\u9898\u5c31\u53d8\u6210\u628a $1\\sim n$ \u653e\u5165 $n-k-p$ \u4e2a\u6709\u6807\u53f7\u7684\u96c6\u5408\u7684\u65b9\u6848\u6570\uff0c\u8fd9\u4e2a\u95ee\u9898\u662f\u5c0f\u5b66\u6570\u5b66\u9898\uff0c\u7b54\u6848\u5c31\u662f $(n-k-p)^n$\uff0c\u53ef\u4ee5\u5feb\u901f\u5e42\u5904\u7406\u3002\n\n\u5177\u4f53\u5730\uff0c\u6211\u4eec\u8bb0 $f(k)$ \u8868\u793a\u628a $1\\sim n$ \u653e\u5165 $k$ \u4e2a\u6709\u6807\u53f7\u7684\u96c6\u5408\uff0c\u4f7f\u5f97\u6bcf\u4e2a\u96c6\u5408\u4e0d\u4e3a\u7a7a\u7684\u65b9\u6848\u6570\u3002\u6839\u636e\u7b2c\u4e8c\u4e2a\u5bb9\u65a5\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$f(k)=\\sum_{i=0}^k\\dbinom ki(-1)^i(k-i)^n$$\n\n\u8fd9\u662f\u7ecf\u5178\u5377\u79ef\u5f62\u5f0f\uff0c\u505a\u4e00\u6b21\u5377\u79ef\u5373\u53ef\u5f97\u5230 $f$\u3002\n\n\u4ece $f$ \u5f97\u5230\u7b54\u6848\u53ea\u9700\u8981\u518d\u505a\u4e00\u6b21\u4e8c\u9879\u5f0f\u53cd\u6f14\u5373\u53ef\u3002\u8fd9\u90e8\u5206\u5e73\u51e1\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n```cpp\nint main()\n{\n\tios_base::sync_with_stdio(false);\n\tcin.tie(0);cout.tie(0);\n\tcin >> n;\n\tinit();\n\tll tmp=1;\n\tfor (int i=0;i<=n;i++)\n\t{\n\t\ta[i]=tmp*inv[i]%mod;\n\t\ttmp=mod-tmp;\n\t\tb[i]=p[i]*inv[i]%mod;\n\t}\n\tmul(n,n,a,b,c);\n\tfor (int i=0;i<=n;i++) c[i]=c[i]*jc[i]%mod;\n\tfor (int i=0;i<=n;i++) c[i]=c[i]*jc[n-i]%mod;\n\ttmp=1;\n\tfor (int i=0;i<=n;i++) c[i]=c[i]*tmp%mod,tmp=mod-tmp;\n\tfor (int i=0;i<=n;i++) b[i]=inv[i];\n\tmul(n,n,b,c,a);\n\ttmp=1;\n\tfor (int i=0;i<=n;i++) a[i]=a[i]*tmp%mod*inv[n-i]%mod,tmp=mod-tmp;\n\tfor (int i=n;i>=0;i--) cout << a[i] << \" \";\n\treturn 0;\n}\n```\n",
        "postTime": 1674982998,
        "uid": 151475,
        "name": "Little09",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P5825 \u6392\u5217\u8ba1\u6570"
    }
]
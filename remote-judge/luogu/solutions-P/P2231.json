[
    {
        "content": "\u9996\u5148\u6839\u636e[\u88f4\u8700\u5b9a\u7406](https://www.luogu.org/problemnew/show/P4549)\uff0c\u65b9\u7a0b$\\sum a_ix_i=d$\u6709\u6574\u6570\u89e3\u5f53\u4e14\u4ec5\u5f53$\\gcd(a_i)|d$\n\n\u5bf9\u8fd9\u9898\u6765\u8bb2\u5c31\u662f$\\gcd(a_i)=1$\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u5f0f\u5b50\n\n$\\sum\\limits_{1\\leq k_i\\leq m,i\\in[1,n]}[\\gcd(k_i,m)=1]$\n\n\u6309\u7167\u5957\u8def\uff0c\u7528$\\mu$\u66ff\u6362$\\epsilon$\n\n$=\\sum\\limits_{1\\leq k_i\\leq m,i\\in[1,n]}\\sum\\limits_{d|k_i,d|m}\\mu(d)$\n\n$=\\sum\\limits_{d|m}\\mu(d)\\sum\\limits_{1\\leq k_i\\leq m,i\\in[1,n]}[d|k_i]$\n\n$=\\sum\\limits_{d|m}\\mu(d)\\left(\\dfrac{m}{d}\\right)^n$\n\n\u6362\u53e5\u8bdd\u8bf4\uff0c$\\mu\\ast id^n(m)$\n\n\u53ea\u9700\u8981\u8003\u8651\u5982\u4f55\u6c42\u51fa\u8fd9\u4e2a\u4e1c\u897f.\n\n\u6700\u66b4\u529b\u7684\u505a\u6cd5\u662f$O(\\sqrt{m})$\u679a\u4e3e$d|m$\uff0c\u518d$O(\\sqrt{d})$\u8ba1\u7b97$\\mu(d)$\uff0c\u6ca1\u8bd5\u8fc7\uff0c\u7406\u8bba\u4e0a\u662f$O(m)$\u7684\uff0c\u5b9e\u9645\u4e0a\u5927\u7ea6\u8fd8\u80fd\u5c11\u4e00\u70b9\u70b9???\u4e0d\u4f1a\u7b97.\n\n\u66f4\u597d\u7684\u505a\u6cd5\u662f\u5bf9$m$\u5206\u89e3\u8d28\u56e0\u6570\uff0c\u7136\u540e\u679a\u4e3e\u8d28\u56e0\u5b50\u96c6\u5408\u7684\u5b50\u96c6(\u56e0\u4e3a\u6709\u91cd\u590d\u8d28\u56e0\u5b50\u7684\u90a3\u4e9b$d$\u7684\u7b54\u6848\u90fd\u4e3a$0$).\u56e0\u4e3a$1e8$\u8303\u56f4\u5185\u8d28\u56e0\u5b50\u6700\u591a\u6709$8$\u4e2a($2\\times 3\\times 5\\times 7\\times 11\\times 13\\times 17\\times 19\\times 23=223092870>1e8$\uff0c\u6240\u4ee5$O(\\sqrt{m}+2^{\\text{m\u7684\u8d28\u56e0\u5b50\u4e2a\u6570}}\\log n)$\u8dd1\u5f97\u98de\u5feb.\n\n\u4e0d\u8fc7\u5176\u5b9e\u53ef\u4ee5\u63a8\u51fa\u5f0f\u5b50\u6765.\n\n\u5206\u89e3$m=\\prod p_i^{k_i}$\uff0c\u90a3\u4e48\n\n$id^n\\ast \\mu(m)=m^n-\\sum\\left(\\dfrac{m}{p_i}\\right)^n+\\sum\\left(\\dfrac{m}{p_ip_j}\\right)^n\\cdots=m^n\\prod\\left(1-\\dfrac{1}{p_i^n}\\right)$\n\n$O(\\sqrt{m}\\log n)$\n\n\u7136\u800c\u5373\u4f7f\u4f60\u7528$Pollard-Rho$\u505a\u5230$O(m^{\\frac{1}{4}}\\log n)$\u4e5f\u4e0d\u5982\u4e0a\u9762\u90a3\u4e2a\u4e1c\u897f\u6e10\u8fdb\u590d\u6742\u5ea6\u4f18\u79c0(\u8ba9\u4e0a\u9762\u90a3\u4e2a\u4e1c\u897f\u4e5f$O(m^\\frac{1}{4})$\u5206\u89e3\u8d28\u56e0\u6570\uff0c\u540e\u9762\u90a3\u4e2a\u4e1c\u897f\uff0c$m$\u6bcf\u4e58\u4e00\u4e2a\u4e0d\u540c\u7684\u8d28\u56e0\u6570\u5b83\u5c31\u4e58$2$\uff0c\u7136\u800c$m$\u4f1a\u4e58$p^\\frac{1}{4}$.\u8fd9\u542f\u793a\u6211\u4eec\u9047\u5230\u542b$\\mu$\u548c\u4e00\u4e2a\u5bb9\u6613\u8ba1\u7b97\u7684\u5f0f\u5b50\u7684\u65f6\u5019\u5e94\u8be5\u66b4\u529b)\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\nint n,m;\nlong long qpower(long long a,int b)\n{\n\tlong long ans=1;\n\tfor(;b;b>>=1,a*=a)if(b&1)ans=ans*a;\n\treturn ans;\n}\nint main()\n{\n\tscanf(\"%d%d\",&m,&n);int fac=n;\n\tlong long ans=1;\n\tfor(int i=2;i*i<=n;i++)\n\t{\n\t\tif(n%i==0)\n\t\t{\n\t\t\tans*=qpower(i,m)-1;fac/=i;\n\t\t\twhile(n%i==0)n/=i;\n\t\t}\n\t}\n\tif(n!=1)ans*=qpower(n,m)-1,fac/=n;\n\tans=ans*qpower(fac,m);\n\tcout<<ans<<endl;\n}\n```",
        "postTime": 1556090144,
        "uid": 22136,
        "name": "qwaszx",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P2231 \u3010[HNOI2002]\u8df3\u86a4\u3011"
    },
    {
        "content": "\u76f8\u6bd4\u4e0e\u697c\u4e0b\u8bf8\u4f4d\u7684\u8df3\u8dc3\u5f0f\u601d\u8def\uff0c\u6211\u4e2a\u4eba\u6bd4\u8f83\u7b28\uff0c\u662f\u7528\u516c\u5f0f\u4e00\u6b65\u6b65\u63a8\u7684\uff0c\u7ed9\u51fa\u4e00\u4e2a\u8f83\u4e25\u683c\u7684\u8bc1\u660e\u3002\n\n\n\u6bcf\u6b21\u9009\u4e00\u4e2a\u6570\u8df3\u82e5\u5e72\u683c\uff0c\u8fd9\u5c31\u662f\u6240\u8c13\u7684\u201c\u7ebf\u6027\u7ec4\u5408\u201d\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5c06\u95ee\u9898\u89c4\u7ea6\u4e3a\uff1a\u5982\u679c\u8fd9$n+1$\u4e2a\u6570\u7684\u6700\u5927\u516c\u7ea6\u6570\u662f1\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65b9\u6848\u5c31\u662f\u53ef\u884c\u7684\u3002\n\n\n\u8bb0$\\delta_1(n)$\u5f53$n=1$\u65f6\u5f97\u52301\uff0c\u5176\u4ed6\u90fd\u4e3a0\u3002\u90a3\u4e48\u8fd9\u4e2a\u8ba1\u6570\u5c31\u53ef\u4ee5\u8bb0\u4e3a\uff1a\n\n\n$\\sum_{a_1 = 1}^m \\cdots \\sum_{a_n = 1} ^ m\\delta_1(\\gcd(\\gcd a, m))$\n\n\n\u8003\u8651\u5230\u5224\u522b\u51fd\u6570$\\delta_1$\u6709\u83ab\u6bd4\u4e4c\u65af\u53d8\u6362\u5f0f\n\n\n$\\delta_1(n) = \\sum_{d|n} \\mu(d)$\n\n\n\u6b64\u65f6\u53c2\u6570\u7a7a\u95f4\u6ee1\u8db3$d | a_i$\uff0c$d | m$\u3002\n\n\u6539\u53d8\u8fd0\u7b97\u987a\u5e8f\uff0c\u5c06$d$\u63d0\u5230\u6700\u524d\u3002\n\n\n$\\text{ans} = \\sum_{d|m} \\mu(d) \\left(\\frac m d\\right)^n$\n\n\n\u90a3\u4e48\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u662f\u975e\u5e38\u6613\u4e8e\u8ba1\u7b97\u7684\u4e86\u3002\n\n\n\u590d\u6742\u5ea6$\\Theta(\\sqrt n \\log n)$\u3002\n\n\n```cpp\n#include <cstdio>\n\n#define LOG(FMT...) // fprintf(stderr, \"[LOG]: \"FMT)\n\nusing namespace std;\n\ntypedef long long ll;\n\nll ans;\nint n, m, pc;\nint p[20];\n\nll pow(ll x, int k);\nvoid dfs(int ind, int prod, int mu);\n\nint main() {\n    scanf(\"%d%d\", &n, &m);\n    int x = m;\n    for (int d = 2; d * d <= m; ++d) {\n        if (x % d == 0) {\n            p[++pc] = d;\n            while (x % d == 0)\n                x /= d;\n        }\n    }\n    if (x != 1)\n        p[++pc] = x;\n    dfs(1, 1, 1);\n    printf(\"%lld\\n\", ans);\n    return 0;\n}\n\nll pow(ll x, int k) {\n    ll ret = 1;\n    while (k) {\n        if (k & 1)\n            ret *= x;\n        k >>= 1;\n        x *= x;\n    }\n    return ret;\n}\n\nvoid dfs(int ind, int prod, int mu) {\n    if (ind == pc + 1) {\n        ans += mu * pow(m / prod, n);\n        return;\n    }\n    dfs(ind + 1, prod, mu);\n    dfs(ind + 1, prod * p[ind], -mu);\n}\n```",
        "postTime": 1515056340,
        "uid": 21423,
        "name": "Elegia",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P2231 \u3010[HNOI2002]\u8df3\u86a4\u3011"
    },
    {
        "content": "### Solution\uff1a\n\n\u3000\u3000\u672c\u9898\u5bb9\u65a5+\u66b4\u529b\u679a\u4e3e\u3002\n\n\u3000\u3000\u56e0\u4e3a\u8981\u5411\u5de6\u79fb\u52a81\u4f4d\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7ebf\u6027\u65b9\u7a0b$a_1x_1+a_2x_2+\u2026+a_nx_n=1$\uff0c\u6ee1\u8db3\u6709\u89e3\u7684\u60c5\u51b5\u65f6\uff0c\u7531\u88f4\u8700\u5b9a\u7406\u5f97$gcd(x_1,x_2\u2026,x_n)=1$\uff0c\u6211\u4eec\u53ea\u8981\u6ee1\u8db3\u4efb\u610f\u4e24\u4e2a\u6570$gcd(x_i,x_j)=1$\u5c31\u597d\u4e86\u3002\n\n\u3000\u3000\u6211\u4eec\u5148\u6c42\u51fa\u603b\u7684\u65b9\u6848\u6570$m^n$\uff0c\u518d\u4ece\u4e2d\u51cf\u53bb\u6240\u6709\u7684\u6574\u4f53$gcd$\u4e0d\u4e3a$1$\u7684\u60c5\u51b5\uff0c\u7531\u4e8e\u6574\u4f53$gcd$\u4e0d\u4e3a$1$\u7684\u60c5\u51b5\u5fc5\u987b\u6ee1\u8db3$gcd$\u4e3a$m$\u7684\u7ea6\u6570\u3002\n\n\u3000\u3000\u4e8e\u662f\u6211\u4eec\u679a\u4e3em\u7684\u7ea6\u6570\u4f5c\u4e3a\u6574\u4f53\u516c\u7ea6\u6570\uff0c\u5bf9\u4e8e\u7ea6\u6570$a$\uff0c\u5171\u6709$\\frac{m}{a}$\u4e2a\u542b\u7ea6\u6570a\u7684\u6570\uff0c\u90a3\u4e48\u51cf\u53bb$(\\frac{m}{a})^n$\uff0c\u7136\u540e\u7531\u4e8e\u4f1a\u91cd\u590d\u51cf\uff0c\u6240\u4ee5\u8fd8\u5f97\u5bb9\u65a5\uff0c\u7531\u4e8e\u679a\u4e3e\u7684\u662fm\u7684\u56e0\u5b50\uff0c\u6240\u4ee5\u5bb9\u65a5\u65f6\u53ef\u4ee5\u76f4\u63a5\u7528\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u54af\uff0c\u6240\u4ee5\u53ea\u8981\u6c42$\\sum\\limits_{d|m}^{m}{\\mu(d)*(\\frac{m}{d})^n}$\u5c31\u884c\u5566\u3002\n  \n$\\quad\\;\\;$\u6b22\u8fce\u6765\u8e29\u535a\u5ba2\uff1a[five20](https://www.cnblogs.com/five20/p/9630960.html)\uff08\u849f\u84bb\u5199\u9898\u89e3\u4e0d\u6613\uff0c\u8f6c\u8f7d\u8bf7\u6ce8\u660e\u51fa\u5904\uff0c\u4e07\u5206\u611f\u8c22\uff01\uff5e\uff09\n\n### \u4ee3\u7801\uff1a\n```cpp\n/*Code by 520 -- 10.19*/\n#include<bits/stdc++.h>\n#pragma GCC optimize(2)\n#define il inline\n#define ll long long\n#define RE register\n#define For(i,a,b) for(RE int (i)=(a);(i)<=(b);(i)++)\n#define Bor(i,a,b) for(RE int (i)=(b);(i)>=(a);(i)--)\nusing namespace std;\nll n,m,ans;\nint prime[40005],cnt;\n\nil int u(int x){\n\tif(x==1)return 1;\n\tint num=0;\n\tfor(RE int i=2;i*i<=x;i++){\n\t\tif(x%i==0) {\n\t\t\tnum++;\n\t\t\tRE int p=0;\n\t\t\twhile(x%i==0) {\n\t\t\t\tx/=i,p++;\n\t\t\t\tif(p>1)return 0;\n\t\t\t}\n\t\t}\n\t}\n\tif(x>1) num++;\n\treturn num&1?-1:1;\n}\n\nil ll fast(ll s,ll k){\n\tll ans=1;\n\twhile(k){\n\t\tif(k&1)ans=ans*s;\n\t\tk>>=1;\n\t\ts*=s;\n\t}\n\treturn ans;\n}\n\nvoid dfs(int now,ll s){\n\tif(now>cnt) {ans+=u(s)*fast(m/s,n);return;}\n\tdfs(now+1,s),dfs(now+1,s*prime[now]);\n}\n\nint main(){\n\tcin>>n>>m;\n\tint x=m;\n\tfor(RE int i=2;i*i<=m;i++)\n\t\tif(x%i==0){\n\t\t\tprime[++cnt]=i;\n\t\t\twhile(x%i==0) x/=i;\n\t\t}\n\tif(x>1) prime[++cnt]=x;\n\tdfs(1,1);\n\tcout<<ans;\n\treturn 0;\n}\n```",
        "postTime": 1539931463,
        "uid": 44000,
        "name": "\u6d45\u8272\u8c03",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2231 \u3010[HNOI2002]\u8df3\u86a4\u3011"
    },
    {
        "content": "### PS.\n\u8fd9\u9898\u6570\u636e\u8c8c\u4f3c\u504f\u5f31\u3002  \n\u7b14\u8005\u8d28\u56e0\u6570\u5206\u89e3\u65f6\u6700\u540e\u6ca1\u6709\u628a\u6574\u4e2a\u6570\u7b97\u8fdb\u53bb\u4e5f\u80fd$60pts.$  \n\u5bb3\u5f97\u7b14\u8005\u8fd8\u4ee5\u4e3a\u6709\u4e9b\u5c0f\u5730\u65b9\u9519\u4e86\u3002  \nupd on 2021.4.25 \u4fee\u6539\u4e86\u4e2a\u522b\u8bc4\u8bba\u533a\u6307\u51fa\u7684\u9519\u8bef\u3002  \n\n### Problem.\n\u76f8\u5f53\u4e8e\u8981\u6c42\u957f\u5ea6\u4e3a$n+1$\u7684\u4e00\u4e2a\u5e8f\u5217\uff0c\u6700\u540e\u4e00\u4f4d\u662f$m$\uff0c\u5176\u4ed6\u4f4d\u90fd\u5fc5\u987b\u5c0f\u4e8e$m$\uff0c\u6709\u987a\u5e8f\uff0c\u53ef\u91cd\u590d\u7684\u6ee1\u8db3\u80fd\u8df3\u5230\u5de6\u8fb9\u4e00\u683c\u7684\u5e8f\u5217\u65b9\u6848\u6570\u3002  \n\n### Solution.\n\u5047\u8bbe\u9898\u76ee\u4e2d\u7684\u90a3\u4e2a\u957f\u5ea6\u4e3a$n+1$\u7684\u5e8f\u5217\u4e3a$\\{a_1...a_n,m\\}$\u3002  \n\u90a3\u4e48\u9898\u76ee\u5c31\u662f\u8ba9\u6211\u4eec\u6c42\u4f7f$\\sum_{i=1}^{n}a_i\\times x_i+m\\times x_{n+1}=1$\u6709\u89e3\u7684$a_1,a_2...a_n$\u6709\u591a\u5c11\u79cd  \n\u7b14\u8005\u76f8\u4fe1\u8bf8\u4f4d\u90fd\u5b66\u8fc7[**\u88f4\u8700\u5b9a\u7406**](https://www.luogu.com.cn/problem/P4549)\uff0c\u90a3\u4e48\u4e0a\u9762\u8fd9\u4e2a\u65b9\u7a0b\u7684\u6709\u89e3\u60c5\u51b5\u5c31\u662f$\\gcd(a_1,a_2...a_n,m)=1$\u3002  \n\n\u9ad8\u4e2d\u6570\u5b66\u8001\u5e08\u6559\u5bfc\u6211\u4eec\uff0c\u9047\u5230\u4e00\u9053\u4e0d\u597d\u5206\u6790\u7684\u9898\u76ee\u65f6\u53ef\u4ee5\u8003\u8651**\u6b63\u96be\u5219\u53cd**\u3002  \n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u6b63\u96be\u5219\u53cd\uff0c\u6c42\u51fa\u4e0a\u9762\u90a3\u4e2a\u65b9\u7a0b\u65e0\u89e3\u7684\u60c5\u51b5\u3002  \n\u4e0a\u9762\u90a3\u4e2a\u65b9\u7a0b\u65e0\u89e3\u65f6\uff0c$\\gcd(a_1,a_2...,a_n,m)\\not=1$\u3002  \n\u8fd9\u4e2a\u8c8c\u4f3c\u66f4\u52a0\u53cb\u5584\u8bf6\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u8003\u8651\u6765\u6c42\u8fd9\u4e2a\u67ff\u5b50\u3002  \n\u9996\u5148\u5148\u628a$m$\u5206\u89e3\u8d28\u56e0\u6570\uff0c$a_1...a_n$\u90fd\u4e00\u5b9a\u6709\u4e00\u4e2a\u5171\u540c\u7684$n$\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u7b97\u51fa\u4f7f\u5b83\u65e0\u89e3\u7684\u65b9\u6848\u6570\u4e86\u3002  \n\n\u4f46\u662f\u6700\u5173\u952e\u7684\u662f\uff0c\u6c42\u65e0\u89e3\u7684\u65b9\u6848\u6570\u65f6\uff0c\u6709\u91cd\u590d\u3002  \n\u6bd4\u5982\uff0c\u5f53$m=6$\uff0c$a_i=6$\u65f6\uff0c\u679a\u4e3e\u5230$3$\u65f6\u7b97\u4e86\u4e00\u904d\uff0c\u679a\u4e3e\u5230$2$\u65f6\u4e5f\u7b97\u4e86\u4e00\u904d\u3002  \n\u8fd9\u662f\u5c31\u9700\u8981\u8bf7\u51fa\u6211\u4eec\u5927\u540d\u9f0e\u9f0e\u7684\u5bb9\u65a5\u4e86\u3002  \n\u4e0a\u9762\u90a3\u4e2a\u4f8b\u5b50\u5c31\u53ef\u4ee5\u4e3a$3$\u7684\u65b9\u6848\u6570+$2$\u7684\u65b9\u6848\u6570-$6$\u7684\u65b9\u6848\u6570\u3002  \n\n\u7136\u540e\u5f53$a_i$\u90fd\u4e3a$x$\u7684\u500d\u6570\u65f6\uff0c\u6b64\u65f6\u65b9\u6848\u6570\u5c31\u662f$(\\frac{m}{x})^{n}$  \n\u5047\u8bbe$k$\u8868\u793a$m$\u7684\u8d28\u56e0\u6570\u4e2a\u6570\uff0c\u4ee3\u7801\u590d\u6742\u5ea6\u662f$2^\\text{m}$\uff0c\u80fd\u8fc7\uff08\u76f8\u540c\u8d28\u56e0\u6570\u4e0d\u7b97\u4e24\u4e2a\n\n\u4e8e\u662f\u6b64\u9898\u5c31\u505a\u5b8c\u4e86QwQ\u3002  \n\n### Coding.\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;typedef long long ll;\nint n,m,mm,cnt,a[105];ll ans=0;\ninline ll qpow(ll x,int q) {ll r=1;for(;q;q>>=1,x*=x) if(q&1) r*=x;return r;}//\u5feb\u901f\u5e42\nsigned main()\n{\n\tscanf(\"%d%d\",&n,&m),cnt=0,ans=qpow(m,n),mm=m;//ans\u521a\u5f00\u59cb\u53d6\u603b\u65b9\u6848\u6570\n\tfor(int i=2,e=sqrt(m);i<=e;i++) if(m%i==0) {a[++cnt]=i;while(m%i==0) m/=i;}//\u5206\u89e3\u8d28\u56e0\u6570\n\tif(m>1) a[++cnt]=m;//\u8fd9\u4e00\u884c\u5c31\u662fPS.\u4e2d\u8bf4\u7684\u90a3\u4e00\u884c\uff0c\u7531\u6b64\u53ef\u770b\u51fa\u7b14\u8005\u7684\u83dc\u3002\n\tfor(ll i=1,e=(1<<cnt),val=1,num=0;i<e;i++,val=1,num=0)\n\t{//\u8fd9\u91cc\u7528\u4e86\u4e8c\u8fdb\u5236\u7684\u65b9\u6cd5\uff0c\u4e2a\u4eba\u611f\u89c9\u4ee3\u7801\u66f4\u7b80\u6613\uff0c\u4e0d\u7528\u5199\u4e00\u4e2adfs\u4e86\n\t\tfor(int j=1;j<=cnt;j++) if(i&(1ll<<(j-1))) num++,val*=a[j];//num\u8868\u793a\u5f53\u524d\u53d6\u4e86\u591a\u5c11\u4e2a\u6570\uff0c\u7528\u4e8e\u5224\u65ad\u662f+\u8fd8\u662f-\n\t\tif(num%2) ans-=qpow(mm/val,n);else ans+=qpow(mm/val,n);//val\u8868\u793a\u8fd9num\u4e2a\u6570\u7684\u4e58\u79ef\uff0c\u4fbf\u4e8e\u8ba1\u7b97\u7b54\u6848\u3002\n\t}\n\treturn printf(\"%lld\\n\",ans),0;\n}\n```",
        "postTime": 1580536458,
        "uid": 44805,
        "name": "Leap_Frog",
        "ccfLevel": 7,
        "title": "P2231[HNOI2002]\u8df3\u86a4"
    },
    {
        "content": "C\u7684\u9898\u89e3\n\n\u3010\u95ee\u9898\u63cf\u8ff0\u3011\n\n\u4e00\u4e2a\u5e8f\u5217\u957f\u5ea6\u4e3a\uff08N+1\uff09\uff0c\u4e14\u7b2c\uff08N+1\uff09\u4f4d\u4e3aM\uff0c1\u2264\u4efb\u610f\u5143\u7d20\u2264M\u3002\n\n\u82e5\u5e8f\u5217\u4e2d\u5b58\u5728\u4e24\u4e2a\u5143\u7d20\u4e92\u8d28\uff0c\u5219\u8fd9\u79cd\u5e8f\u5217\u6709\u591a\u5c11\u79cd\uff08\u5143\u7d20\u53ef\u91cd\u590d\uff09\uff1f\n\n\u3010\u89e3\u9898\u601d\u8def\u3011\n\n\u9996\u5148\u6c42\u51fa\u603b\u65b9\u6848\u6570:pow(M,N);\n\n\u601d\u8def\u4e00\uff1a\u9996\u5148\u627e\u5230\u6240\u6709\u4e0e\u5143\u7d20M\u542b\u9664\u4e861\u4ee5\u5916\u542b\u5176\u4ed6\u56e0\u5b50\u7684\u5143\u7d20\u5e76\u5206\u79bb\u3002\n\n\u4ece\u7b2c\u4e00\u4e2a\u5143\u7d20\u5f00\u59cb\u5bfb\u627e\u8fd9\u4e9b\u5143\u7d20\u4e2d\u662f\u7b2c\u4e00\u4e2a\u5143\u7d20\u500d\u6570\u7684\u5143\u7d20\uff0c\u5e76\u5220\u53bb\u8fd9\u4e9b\u5143\u7d20\u3002\n\n\u5219\u6b64\u7c7b\u5143\u7d20\u53ef\u4ee5\u7ec4\u6210\u82e5\u5e72\u4e2a\u5e8f\u5217\uff0c\u4e14\u8fd9\u79cd\u5e8f\u5217\u4e00\u5b9a\u4e0d\u6ee1\u8db3\u6761\u4ef6\u3002\n\n\u7ee7\u7eed\u5bfb\u627e\u7b2c\u4e8c\u4e2a\u5143\u7d20\uff0c\u5e76\u5bfb\u627e\u662f\u7b2c\u4e8c\u4e2a\u5143\u7d20\u7684\u500d\u6570\u7684\u5143\u7d20\uff0c\u5e76\u5220\u53bb\u8fd9\u4e9b\u5143\u7d20\u3002\n\n\u5219\u6b64\u7c7b\u5143\u7d20\u4e5f\u53ef\u4ee5\u82e5\u5e72\u4e2a\u5e8f\u5217\uff0c\u4e14\u4e5f\u4e00\u5b9a\u4e0d\u6ee1\u8db3\u6761\u4ef6\u3002\n\n\u5faa\u73af\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u76f4\u5230\u6240\u6709\u5143\u7d20\u88ab\u5220\u53bb\u3002\n\n\n\u5f53\u6240\u6709\u5143\u7d20\u88ab\u5220\u53bb\u540e\uff0c\u4f1a\u53d1\u73b0\u6709\u4e00\u90e8\u5206\u5e8f\u5217\u88ab\u91cd\u590d\u5220\u53bb\uff0c\u4ea7\u751f\u4e86\u9519\u8bef\u3002\u56e0\u6b64\u9700\u8981\u5c06\u5220\u53bb\u7684\u5143\u7d20\u8865\u56de\u6765\u3002\u8981\u8865\u56de\u6765\u7684\u5e8f\u5217\uff0c\u4e00\u5b9a\u662f\u7531\u4e4b\u524d\u5143\u7d20\u7ec4\u6210\u7684\u96c6\u5408\u4e0e\u96c6\u5408\u4e4b\u95f4\u4ea7\u751f\u4ea4\u96c6\u7684\u90e8\u5206\u3002\u4f46\u662f\u64cd\u4f5c\u8d77\u6765\u590d\u6742\uff0c\u4e14\u65f6\u95f4\u590d\u6742\u5ea6\u592a\u9ad8\u3002\n\n\n\u95ee\u9898\u5728\u4e8e\uff1a\u5bb9\u9519\u7387\u9ad8\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u592a\u9ad8\uff0c\u53ef\u884c\u5ea6\u4f4e\u3002\n\n\n\n\u601d\u8def\u4e8c\uff1a\u7531\u601d\u8def\u4e00\u53ef\u4ee5\u53d1\u73b0\uff0c\u7b2c\u4e00\u4e2a\u5143\u7d20\uff08a\uff09\u7ec4\u6210\u7684\u96c6\u5408\u4e2d\u5143\u7d20\u7684\u4e2a\u6570\u4e3a\uff08M/a\uff09\uff08a\u4e3aM\u7684\u56e0\u6570 \u4e14 \u663e\u7136\u4e3a\u7d20\u6570\uff09\u3002\u56e0\u6b64\u53ef\u4ee5\u6539\u8fdb\u601d\u8def\u4e00\u7684\u7b97\u6cd5\uff1a\u5c06M\u7684\u8d28\u56e0\u5b50\u5206\u79bb\u51fa\u6765\uff0c\u800c\u4e0d\u662f\u5c06\u4e0eM\u6709\u516c\u5171\u56e0\u6570\u7684\u6570\u5b57\u5206\u88c2\u51fa\u6765\u3002\n\n\uff08M/a\uff09\u8868\u793a\u4e3a\uff1a\u4e0eM\u540c\u542ba\u56e0\u5b50\u7684\u5143\u7d20\u7684\u4e2a\u6570\uff0c\u5219\u8fd9\u4e9b\u5143\u7d20\u6784\u6210\u7684\u5e8f\u5217\u4e00\u5b9a\u4e0d\u6ee1\u8db3\u6761\u4ef6\u3002\n\n\u82e5b\u4e5f\u4e3aM\u7684\u8d28\u56e0\u5b50\uff0c\u5219\uff08M/b\uff09\u540c\u7406\uff0c\u8868\u793a\u4e0eM\u540c\u542bb\u4e3a\u56e0\u5b50\u7684\u5143\u7d20\u4e2a\u6570\uff0c\u5219\u6b64\u7c7b\u5143\u7d20\u6784\u6210\u7684\u5e8f\u5217\u4e00\u5b9a\u4e5f\u4e0d\u6ee1\u8db3\u6761\u4ef6\u3002\u82e5\u6b64\u5faa\u73af\u4e0b\u53bb\uff0c\u76f4\u5230\u5c06\u6240\u6709\u5143\u7d20\u7b5b\u9009\u5b8c\u6bd5\u3002\n\n\n\u540c\u601d\u8def\u4e00\u4e00\u6837\uff0c\u6b64\u601d\u8def\u4e5f\u7b5b\u6389\u4e86\u5927\u91cf\u91cd\u590d\u7684\u5143\u7d20\uff0c\u9020\u6210\u9519\u8bef\uff0c\u56e0\u6b64\u4e5f\u9700\u8981\u5c06\u91cd\u590d\u5220\u9664\u7684\u5e8f\u5217\u8865\u52a0\u56de\u6765\u3002\n\n\u56e0\u4e3aa\u4e3a\u8d28\u6570\uff0cb\u4e3a\u8d28\u6570\uff0c\u56e0\u6b64a\u3001b\u4e92\u8d28\uff0c\u4e14a\u3001b\u540c\u4e3aM\u7684\u8d28\u56e0\u5b50\n\n\u5219\u7531\uff08a\\*b\uff09\u53ca\uff08a\\*b\uff09\u7684\u500d\u6570 \u7684\u5e8f\u5217\uff0c\u4e00\u5b9a\u88ab\uff08M/a\uff09\u5f62\u6210\u7684\u5e8f\u5217\u548c\uff08M/b\uff09\u5f62\u6210\u7684\u5e8f\u5217\u90fd\u5220\u53bb\u8fc7\u3002\n\n\u56e0\u6b64\u8bbec=a\\*b\u3002\u5219\u52a0\u4e0a\u7531\uff08M/c\uff09\u53ca\u5176\u500d\u6570\u7ec4\u6210\u7684\u5e8f\u5217 \u5c31\u5f25\u8865\u4e86\u591a\u4f59\u7684\u5220\u9664\u3002\n\n\n\u4f46\u662f\u663e\u7136\uff0c\u7528\u8fd9\u79cd\u65b9\u6cd5\u52a0\u4e0a\u7684\u5e8f\u5217\uff0c\u53c8\u9020\u6210\u4e86\u591a\u4f59\u7684\u6dfb\u52a0\u3002\u56e0\u6b64\u9700\u8981\u518d\u6b21\u5220\u9664\u3002\u9700\u8981\u518d\u6b21\u5220\u9664\u7684\u5e8f\u5217\u4e00\u5b9a\u7531\uff08M\u7684\u4e09\u4e2a\u8d28\u56e0\u5b50\u76f8\u4e58\u7684\u6570\u5b57\uff09\u53ca\u5176\u500d\u6570\u6240\u7ec4\u6210\u3002\u56e0\u6b64\u9700\u8981\u518d\u5c06\u6b64\u7c7b\u5e8f\u5217\u5220\u9664\u3002\n\n\u540c\u7406\uff0c\u672c\u6b21\u5220\u9664\u7684\u5143\u7d20\u4ecd\u7136\u4f1a\u4ea7\u751f\u91cd\u590d\u5220\u9664\u7684\u5e8f\u5217\uff0c\u540c\u7406\u5219\u9700\u8981\u52a0\u4e0a\u91cd\u590d\u5220\u9664\u7684\u5e8f\u5217\uff0c\u8fd9\u6b21\u52a0\u7684\u5e8f\u5217\u4e2d\u7684\u5143\u7d20\u4e00\u5b9a\u7531\uff08M\u7684\u56db\u4e2a\u8d28\u56e0\u5b50\u76f8\u4e58\u7684\u6570\u5b57\uff09\u53ca\u5176\u500d\u6570\u6240\u7ec4\u6210\u3002\uff08\u8bc1\u660e\u65b9\u6cd5\u540c\u7b2c\u4e00\u6b21\u5220\u9664\u548c\u7b2c\u4e00\u6b21\u6dfb\u52a0\uff09\u3002\n\n\n\n\n\n\n\n\u3010\u89e3\u9898\u516c\u5f0f\u3011\n\n\u82e5a\u3001b\u3001c\u3001d\u3001e\u4e3aM\u7684\u4e94\u4e2a\u8d28\u56e0\u5b50\u3002\n\n\u603b\u65b9\u6848\u6570\u4e3a\uff1apow\uff08M\uff0cN\uff09\uff1b\n\n\u7b2c\u4e00\u6b21\u5220\u9664\u7684\u5e8f\u5217\u7684\u4e2a\u6570\u4e3a:\n\npow\uff08M/a\uff0cN\uff09+ pow\uff08M/b\uff0cN\uff09+pow\uff08M/c\uff0cN\uff09+pow\uff08M/d\uff0cN\uff09+pow\uff08M/e\uff0cN\uff09\n\n\n\u9700\u8981\u6dfb\u52a0\u7684\u5e8f\u5217\u7684\u4e2a\u6570\u4e3a\n\npow\uff08M/\uff08a\\*b\uff09\uff0cN\uff09+ pow\uff08M/\uff08a\\*c\uff09\uff0cN\uff09+pow\uff08M/\uff08a\\*d\uff09\uff0cN\uff09+pow\uff08M/\uff08a\\*e\uff09\uff0cN\uff09+ pow\uff08M/\uff08b\\*c\uff09\uff0cN\uff09+ pow\uff08M/\uff08b\\*d\uff09\uff0cN\uff09+ pow\uff08M/\uff08b\\*e\uff09\uff0cN\uff09+                         pow\uff08M/\uff08c\\*d\uff09\uff0cN\uff09+ pow\uff08M/\uff08c\\*e\uff09\uff0cN\uff09+pow\uff08M/\uff08d\\*e\uff09\uff0cN\uff09\uff1b\n\n\n\u518d\u6b21\u5220\u9664\u7684\u5e8f\u5217\u7684\u4e2a\u6570\u4e3a\n\npow\uff08M/\uff08a\\*b\\*c\uff09\uff0cN\uff09+ pow\uff08M/\uff08a\\*b\\*d\uff09\uff0cN\uff09+ pow\uff08M/\uff08a\\*b\\*e\uff09\uff0cN\uff09+\n\npow\uff08M/\uff08b\\*c\\*d\uff09\uff0cN\uff09+ pow\uff08M/\uff08b\\*c\\*e\uff09\uff0cN\uff09+ pow\uff08M/\uff08c\\*d\\*e\uff09\uff0cN\uff09\n\n\n\u518d\u6b21\u6dfb\u52a0\u7684\u5e8f\u5217\u4e2a\u6570\u4e3a\n\npow\uff08M/\uff08a\\*b\\*c\\*d\uff09\uff0cN\uff09+ pow\uff08M/\uff08a\\*b\\*c\\*e\uff09\uff0cN\uff09+ pow\uff08M/\uff08b\\*c\\*d\\*e\uff09\uff0cN\uff09\n\n\u518d\u6b21\u5220\u9664\u7684\u5e8f\u5217\u4e2a\u6570\u4e3a\n\npow\uff08M/\uff08a\\*b\\*c\\*d\\*e\uff09\uff0cN\uff09;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u3010AC\u4ee3\u7801\u3011\n\n\n```cpp\n#include <iostream>\n#include <cstdio>\nusing namespace std;\ntypedef long long LL;\nLL n,m,k,a,cnt,num,tot;\nLL f[101000],g[101000];\nLL pow(LL x,LL y)   //\u5feb\u901f\u5e42\uff0cSTL\u4e2d\u7684pow\u4f1a\u51fa\u73b0\u8bef\u5dee\u95ee\u9898 \n{\n    LL ans=1;\n    while(y)\n    {\n        if(y&1)ans*=x;\n        x*=x;\n        y>>=1;\n    }\n    return ans;\n}\nLL seperate()        //\u5feb\u901f\u7b5b\u9009\u8d28\u56e0\u5b50 \n{\n    int e=m;\n    for(int i=2; i*i<=e; i++)\n        if(e%i==0)\n        {\n            cnt++;\n            f[cnt]=i;\n            while((e%i)==0)\n                e/=i;\n        }\n    if(e-1)\n        f[++cnt]=e;\n    return cnt;\n}\nvoid dfs(int now,int cj,int choose)     //\u8d28\u56e0\u5b50\u7ec4\u5408 \n{\n    if(choose>cnt+1)\n        return;\n    if(now==k+1)\n    {\n        g[++a]=cj;\n        return;\n    }\n    dfs(now+1,cj*f[choose],choose+1);\n    dfs(now,cj,choose+1);\n}\nsigned main()\n{\n    scanf(\"%lld%lld\",&n,&m);\n    tot=pow(m,n);\n    if(m==0)\n    {\n        cout<<\"0\";\n        return 0;\n    }\n    seperate();\n    for(int i=1; i<=cnt; i++)\n    {\n        k=i;\n        dfs(1,1,1);\n        if(i%2==1)\n            for(int j=1; j<=a; j++)\n                tot-=pow(m/g[j],n);\n        else\n            for(int j=1; j<=a; j++)\n                tot+=pow(m/g[j],n);\n        a=0;\n    }\n    cout<<tot;\n    return 0;\n}\n\n```",
        "postTime": 1494085772,
        "uid": 19215,
        "name": "OIer991215",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2231 \u3010[HNOI2002]\u8df3\u86a4\u3011"
    },
    {
        "content": "\u524d\u7f6e\u829d\u58eb\uff1a[\u88f4\u8700\u5b9a\u7406](https://oi-wiki.org/math/number-theory/bezouts/)\u3001[\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14](https://oi-wiki.org/math/number-theory/mobius/)\n\n\u7531\u88f4\u8700\u5b9a\u7406\u53ef\u5f97\uff1a\u5047\u8bbe\u6211\u9009\u62e9\u7684\u524d $n$ \u4e2a\u6570\u7684\u53ef\u91cd\u96c6\u4e3a $S$\uff0c\u5219 $\\gcd(m, \\displaystyle\\gcd_{x \\in S} x) = 1$\u3002\n\n\u539f\u5f0f $= \\displaystyle\\sum_{|S| = m, \\max(S) \\leq m} [\\gcd(m, \\gcd_{x \\in S} x) = 1]$\n\n$ = \\displaystyle\\sum_{d \\mid m} \\mu(d) \\sum_{|S| = m, \\max(S) \\leq m, d \\mid \\gcd(S)} 1$\n\n$ = \\displaystyle\\sum_{d \\mid m} \\mu(d) (\\frac{m}{d})^n$\n\n\u76f4\u63a5\u679a\u4e3e\u56e0\u6570\u66b4\u529b\u7b97 $\\mu$ \u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\tau(m)(\\sqrt{m} + \\log n))$\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <stdio.h>\n#include <math.h>\n\ntypedef long long ll;\n\ninline int mu(int n){\n\tint ans = 1;\n\tfor (int i = 2; i * i <= n; i++){\n\t\tif (n % i == 0){\n\t\t\tn /= i;\n\t\t\tif (n % i == 0) return 0;\n\t\t\tans = -ans;\n\t\t}\n\t}\n\tif (n > 1) ans = -ans;\n\treturn ans;\n}\n\ninline ll quick_pow(ll x, ll p){\n\tll ans = 1;\n\twhile (p){\n\t\tif (p & 1) ans *= x;\n\t\tx *= x;\n\t\tp >>= 1;\n\t}\n\treturn ans;\n}\n\nint main(){\n\tint n, m, t;\n\tll ans = 0;\n\tscanf(\"%d %d\", &n, &m);\n\tt = sqrt(m);\n\tfor (int i = 1; i <= t; i++){\n\t\tif (m % i == 0){\n\t\t\tint tm = m / i;\n\t\t\tans += mu(i) * quick_pow(tm, n);\n\t\t\tif (i != tm) ans += mu(tm) * quick_pow(i, n);\n\t\t}\n\t}\n\tprintf(\"%lld\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1649769138,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P2231 \u3010[HNOI2002] \u8df3\u86a4\u3011"
    },
    {
        "content": "\u9898\u76ee\u63cf\u8ff0\uff1a\u8bfb\u5165n,m\u4e24\u4e2a\u6570\uff0c\u5047\u8bbe\u4e00\u4e2a\u5408\u6cd5\u7684\u6570\u5217\u662fn+1\u4f4d\uff0c\u4e14\u524dn\u4f4d\u4e0d\u5927\u4e8em\uff0c\u7b2cn+1\u4f4d\u4e3am\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u6570\u5217\uff0c\u8df3\u86a4\u53ef\u4ee5\u9009\u53d6\u4efb\u610f\u4e00\u4e2a\u6570\u5217\u4e2d\u7684\u6570k\uff0c\u5f80\u5de6\u6216\u53f3\u8d70k\u6b65\uff08\u53ef\u4ee5\u8d70\u591a\u6b21\uff09\uff0c\u82e5\u4f7f\u7528\u8fd9\u4e00\u4e2a\u6570\u5217\u8df3\u86a4\u53ef\u4ee5\u5230\u8fbe\u5de6\u8fb9\u4e00\u6b65\u7684\u4f4d\u7f6e\uff0c\u90a3\u4e48\u8fd9\u4e00\u4e2a\u6570\u5217\u5c31\u662f\u53ef\u4ee5\u5b8c\u6210\u4efb\u52a1\u7684\u6570\u5217\u3002\u73b0\u5728\u9700\u8981\u6c42\u51fa\u53ef\u4ee5\u5b8c\u6210\u4efb\u52a1\u7684\u6570\u5217\u7684\u603b\u6570\u3002\n\n\u5206\u6790\uff1a\u9898\u76ee\u9700\u8981\u627e\u51fa\u6240\u6709\u80fd\u591f\u5230\u8fbe\u5de6\u8fb9\u4e00\u6b65\u4f4d\u7f6e\u7684\u65b9\u6848\u603b\u6570\uff0c\u80fd\u591f\u5230\u8fbe\u5de6\u8fb9\u4e00\u6b65\uff0c\u5c31\u76f8\u5f53\u4e8e\u6570\u5217\u4e2d\u6240\u6709\u6570\u7684\u6700\u5927\u516c\u7ea6\u6570\u4e3a1\uff08\u53ef\u4ee5\u901a\u8fc7\u6269\u6b27\u63a8\u51fa\uff09\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u8f6c\u5316\u6210\u8fd9\u6837\u4e00\u4e2a\u95ee\u9898\uff0c\u53d6n\u4e2a\u4e0d\u5927\u4e8em\u7684\u6570\uff08\u4f4d\u7f6e\u4e0d\u540c\u4e5f\u7b97\u4e0d\u540c\u65b9\u6848\uff09\uff0c\u4f7f\u5f97\u4ed6\u4eec\u548cm\u7684\u6700\u5927\u516c\u7ea6\u6570\u4e3a1\u3002\n\n\u60f3\u5230\u8fd9\u4e00\u6b65\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u95ee\u9898\u8f6c\u5316\u4e3a\uff1a\u6240\u6709\u5408\u6cd5\u6570\u5217\u7684\u603b\u6570\uff08m\u4e2a\u6570\u653e\u5230n\u4f4d\uff0c\u5171\u6709m\u7684n\u6b21\u65b9\u79cd\uff09\u51cf\u53bb\u6570\u5217\u7684\u6700\u5927\u516c\u7ea6\u6570\u5927\u4e8e1\u7684\u603b\u6570\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u8fd9\u4e48\u505a\uff1a\u5c06m\u8d28\u56e0\u6570\u5206\u89e3\uff0c\u679a\u4e3em\u7684\u8d28\u56e0\u6570t\uff0c\u90a3\u4e481\u5230m\u4e4b\u95f4\u6709m/t\u4e2at\u7684\u500d\u6570\uff0c\u628a\u6570\u5217\u4e2d\u5168\u90fd\u662f\u8fd9\u4e9bm/t\u4e2a\u6570\u7684\u65b9\u6848\u6570\u51cf\u53bb\u5373\u53ef\u3002\n\n\u7136\u800c\u8fd9\u79cd\u65b9\u6cd5\u662f\u5b58\u5728\u95ee\u9898\u7684\uff0c\u6709\u53ef\u80fd\u4f1a\u91cd\u590d\u51cf\u53bb\u540c\u4e00\u79cd\u65b9\u6848\uff086\u7684\u500d\u6570\u4f1a\u540c\u65f6\u57282\u7684\u500d\u6570\u548c3\u7684\u500d\u6570\u65f6\u90fd\u51cf\uff09\uff0c\u6240\u4ee5\u9700\u8981\u679a\u4e3em\u7684\u6240\u6709\u8d28\u56e0\u6570\u7684\u7ec4\u5408\u65b9\u5f0f\uff0c\u8bb0\u5f55\u6bcf\u79cd\u7ec4\u5408\u7684\u5143\u7d20\u4e2a\u6570\u4e3atot\uff0c\u4e58\u79ef\u4e3atmp\uff0c\u82e5tot\u662f\u5947\u6570\uff0c\u90a3\u4e48\u51cf\u53bbm/tmp\u4e2a\u6570\u653e\u5230n\u4f4d\u91cc\u7684\u65b9\u6848\u4e2a\u6570\uff0c\u5426\u5219\u52a0\u4e0am/tmp\u4e2a\u6570\u653e\u5230n\u4f4d\u91cc\u7684\u65b9\u6848\u4e2a\u6570\uff08\u5171\u6709m/tmp\u7684n\u6b21\u65b9\u79cd\uff09\uff0c\u8fd9\u5c31\u662f\u5927\u540d\u9f0e\u9f0e\u7684\u5bb9\u65a5\u539f\u7406\u554a\uff01\n\n\u4ee3\u7801\u8fd8\u662f\u5f88\u77ed\u7684\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\nusing namespace std;\ntypedef long long LL;\nint a[30],n,m;\nLL ans;\nLL pow(LL x,int y){\n    LL ans=1;\n    while(y){\n        if(y&1)ans*=x;\n        x*=x;\n        y>>=1;\n    }\n    return ans;\n}\nvoid solve(){\n    int k=m;\n    for(int i=2;i*i<=k;i++)\n        if(k%i==0){\n            a[++a[0]]=i;\n            while(k%i==0)k/=i;\n        }\n    if(k>1)a[++a[0]]=k;\n    for(LL i=1;i<(1<<a[0]);i++){\n        int tmp=1,tot=0;\n        for(int j=1;j<=a[0];j++)\n            if(i&(1LL<<(j-1)))\n                tot++,tmp*=a[j];\n        if(tot&1)ans-=pow(m/tmp,n);\n        else ans+=pow(m/tmp,n);\n    }\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    ans=pow(m,n);\n    solve();\n    printf(\"%LLd\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1484139098,
        "uid": 32378,
        "name": "Malgr\u00e9_L_Guerre",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2231 \u3010[HNOI2002]\u8df3\u86a4\u3011"
    }
]
[
    {
        "content": "\u770b\u4e86\u9898\u89e3\u7684\u4ee3\u7801\u5168\u90fd\u53ef\u4ee5\u88ab\u8ba8\u8bba\u533a\u7684\u8fd9\u7ec4\u6570\u636ehack\u6389\n```cpp\n\u8f93\u5165\uff1a\na a a b c d d e f $\nx x y z $\n```\n\n```cpp\n\u8f93\u51fa\n2\n```\n\n\u88ab\u9634\u4e86\u597d\u4e45\uff0c\u4e8e\u662f\u6765\u5199\u4e00\u7bc7\u9898\u89e3(\n\n\n------------\n\n\u770b\u5230\u5b57\u7b26\u5339\u914d\u53ef\u4ee5\u60f3\u5230kmp\uff0c\u4f46\u662f\u672c\u9898\u4e2d\u8981\u6c42\u7684\u4e0e\u5177\u4f53\u7684\u5355\u8bcd\u65e0\u5173\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a\u539f\u5355\u8bcd\u76f4\u63a5\u7528map\u79bb\u6563\u5316\uff0c\u7136\u540e\u8bb0\u5f55\u4e00\u4e0b\u4e0a\u4e00\u4e2a\u51fa\u73b0\u7684\u6570\u5b57\u51fa\u73b0\u7684\u4f4d\u7f6e\u3002\u7136\u540e\u6211\u4eec\u5c31\u4f1a\u53d1\u73b0\u6709\u4e24\u4e2a\u95ee\u9898\u8981\u89e3\u51b3\uff1a\n\n* \u5982\u4f55\u5feb\u901f\u5339\u914d\uff08\u66f4\u6539kmp\u6570\u7ec4\u7684\u542b\u4e49\u6765\u6ee1\u8db3\u672c\u9898\u7684\u5931\u914d\u8df3\u8dc3\uff09\n* \u5982\u4f55\u5224\u65ad\u662f\u5426\u53ef\u4ee5\u5339\u914d\n\n\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u95ee\u9898\uff0c\u53ef\u4ee5\u60f3\u5230\u5c06\u539f\u672c\u7684 $[1,L]$ \u4e0e $[x-L+1,x]$ \u5b57\u7b26\u76f8\u540c\u7684\u610f\u4e49\u6539\u4e3a $[1,L]$ \u4e0e $[x-L+1,x]$ \u5728\u672c\u9898\u89e3\u5bc6\u7684\u610f\u4e49\u4e0b\u76f8\u540c\n\n\u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u8bb0 $ls1[x]$ \u4e3a\u6587\u672c\u4e32\u4e3ax\u5728\u4e0e\u4e0a\u4e00\u4e2a\u51fa\u73b0\u7684\u8ddd\u79bb\uff0c $ls2[x]$ \u4e3a\u6a21\u5f0f\u4e32\uff0c\u82e5\u7b2c\u4e00\u6b21\u51fa\u73b0\u5219\u8ddd\u79bb\u4e3ainf\uff0cfl\u4e3a\u5355\u8bcd\u79bb\u6563\u5316\u540e\u7684\u6570\u7ec4\uff0c\u6211\u4eec\u53ef\u4ee5\u5206\u8ba8\u4e00\u4e0b,\n\n* \u5982\u679c $ls2[j]$ \u4e3a $inf$\uff0c\u5219 $ls1[i]$ \u5fc5\u987b\u5927\u4e8e\u7b49\u4e8ej\u624d\u80fd\u6ee1\u8db3\u6761\u4ef6\n* \u5982\u679c $ls2[j]$ \u4e0d\u4e3a $inf$\uff0c\u5219 $fl[i-ls2[j]]$ \u8981\u7b49\u4e8e $fl[i]$ \u624d\u80fd\u6ee1\u8db3\u6761\u4ef6\n\n\u7136\u540e\u6211\u4eec\u6309\u7167\u5c06\u5224\u65ad\u51fd\u6570\u5957\u7528\u4e0a\u65b9\u7684\u5206\u8ba8\u5373\u53ef\n\n\n------------\n\n\u5176\u4ed6\u9898\u89e3\u4e2d\u4f1a\u88abhack\u7684\u4e3b\u8981\u539f\u56e0\u662f\u56e0\u4e3a\u5728\u6c42kmp\u6570\u7ec4\u65f6\u76f4\u63a5\u7528 $ls2$ \u53bb\u5339\u914d\uff0c\u4f46\u662f\u8fd9\u6837\u5176\u5b9e\u662f\u9519\u7684\uff0c\u6211\u4eec\u5728\u6c42kmp\u6570\u7ec4\u65f6\u8981\u8003\u8651\u6e05\u695a\u4ed6\u7684\u5b9a\u4e49\u4e0e\u5339\u914d\u65b9\u5f0f\uff08\u4e0a\u65b9\u7684\u5206\u8ba8\uff09\uff0c\u76f4\u63a5\u5224\u65ad\u662f\u5426\u76f8\u7b49\u663e\u7136\u5c31\u6ca1\u6709\u8003\u8651\u6e05\u695a\u5339\u914d\u65b9\u5f0f\n\n\n------------\n\n### \u4ee3\u7801\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<queue>\n#include<map>\n\nusing namespace std;\n\n#define ll long long\n\nconst int N = 1e6+7;\nconst int inf = 1e9;\nstring s;\nint t1,t2,tp1,tp2,ls1[N],ls2[N],l[N],fl1[N],fl2[N],kmp[N];\nmap <string,int> mp;\n\nvoid solve(int las[], int fl[], int &t) { \n\tmp.clear(); for(int i = 1; i <= 1000000; i ++ ) l[i] = -inf;\n\tint tp = 0;\n\tfor(int i = 1; cin >> s && s[0] != '$'; i ++ ) {\n\t\tt++;\n\t\tif(!mp[s]) mp[s] = ++tp; \n\t\tint x = mp[s]; fl[i] = x;\n\t\tif(l[x] == -inf) las[i] = inf;\n\t\telse las[i] = i-l[x]; l[x] = i;\n\t}\n}\n\nbool check(int i, int j) {\n\tif(ls2[j+1] == inf && ls1[i] < j+1) return false;\n\tif(ls2[j+1] != inf && fl1[i] != fl1[i-ls2[j+1]]) return false;\n\treturn true;\n}\n\nbool pd(int i, int j) {\n\tif(ls2[j+1] == inf && ls2[i] < j+1) return false;\n\tif(ls2[j+1] != inf && fl2[i] != fl2[i-ls2[j+1]]) return false;\n\treturn true;\n}\n\nint main() {\n\tsolve(ls1, fl1, t1);\n\tsolve(ls2, fl2, t2);\n\tint j = 0;\n\tfor(int i = 2; i <= t2; i ++ ) {\n\t\twhile(!pd(i, j) && j) j = kmp[j];\n\t\tif(pd(i, j)) j++;\n\t\tkmp[i] = j;\n\t}\n\tj = 0;\n\tfor(int i = 1; i <= t1; i ++ ) {\n\t\twhile(j && !check(i, j)) j = kmp[j];\n\t\tif(check(i, j)) j++;\n\t\tif(j == t2) { cout << i-j+1; return 0; }\n\t}\n}\n\n```\n\n",
        "postTime": 1667437293,
        "uid": 130822,
        "name": "orzws",
        "ccfLevel": 6,
        "title": "P8085"
    },
    {
        "content": "## \u9898\u89e3\r\n\r\n\u8003\u8651\u4f7f\u7528\u54c8\u5e0c\u3002\r\n\r\n\u6211\u4eec\u8bb0\u660e\u6587\u4e2d\u7b2c $i$ \u4e2a\u5355\u8bcd\u5230\u4e0a\u4e00\u4e2a\u5355\u8bcd\u7684\u8ddd\u79bb\u662f $a_i$\uff0c\u5bc6\u6587\u4e2d\u7b2c $i$ \u4e2a\u5355\u8bcd\u5230\u4e0a\u4e00\u4e2a\u5355\u8bcd\u7684\u8ddd\u79bb\u662f $b_i$\u3002\u7279\u522b\u5730\uff0c\u5982\u679c\u524d\u9762\u6ca1\u6709\u51fa\u73b0\u8fc7\u76f8\u540c\u5355\u8bcd\uff0c\u5219\u5c06\u8ddd\u79bb\u8bb0\u4f5c $-1$\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e\u6837\u4f8b $3$\uff0c\u660e\u6587\u548c\u5bc6\u6587\u5206\u522b\u53ef\u4ee5\u8f6c\u5316\u4e3a\u5982\u4e0b\u5f62\u5f0f\uff1a\r\n\r\n- \u660e\u6587\u8f6c\u6362\u524d\uff1a$[\\mathtt{a, b, c, x, c, z, z, a, b, c}]$\uff1b\r\n- \u660e\u6587\u8f6c\u6362\u540e\uff1a$[-1,-1,\\underline{-1,-1,2,-1,1,7},7,7]$\uff1b\r\n- \u5bc6\u6587\u8f6c\u6362\u524d\uff1a$[\\mathtt{prvi, dr, prvi, tr, tr, x}]$\uff1b\r\n- \u5bc6\u6587\u8f6c\u6362\u540e\uff1a$[-1,-1,2,-1,1,-1]$\u3002\r\n\r\n\u5982\u679c\u660e\u6587\u5f53\u4e2d\u67d0\u4e2a\u5b50\u4e32\u7b49\u4e8e\u5bc6\u6587\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5b50\u4e32\u751f\u6210\u7684\u5e8f\u5217\u5e94\u8be5\u662f\u548c\u5bc6\u6587\u5e8f\u5217\u76f8\u540c\u7684\u3002\u4e0d\u8fc7\u6211\u4eec\u4e0d\u80fd\u76f4\u63a5\u5bf9\u660e\u6587\u751f\u6210\u7684\u5e8f\u5217\u8fdb\u884c\u533a\u95f4\u54c8\u5e0c\u3002\u56e0\u4e3a\u660e\u6587\u5f53\u4e2d\u67d0\u4e9b\u5355\u8bcd\u7684\u4e0a\u4e00\u4e2a\u5355\u8bcd\u7684\u4f4d\u7f6e\u5728\u533a\u95f4\u4e4b\u5916\uff0c\u8f6c\u6362\u540e\u6709\u503c\uff0c\u800c\u5bc6\u6587\u91cc\u5bf9\u5e94\u4f4d\u7f6e\u662f $-1$\u3002\r\n\r\n\u89e3\u51b3\u8d77\u6765\u5176\u5b9e\u975e\u5e38\u7b80\u5355\uff1a\u53ea\u9700\u8981\u5728\u6ed1\u52a8\u7a97\u53e3\u7684\u65f6\u5019\u7ef4\u62a4\u8fd9\u4e2a\u5b50\u4e32\u7684\u54c8\u5e0c\u503c\u5373\u53ef\u3002\u5f53\u7a97\u53e3\u6ed1\u8fc7\u67d0\u4e2a\u5355\u8bcd\uff0c\u5c31\u628a\u8fd9\u4e2a\u5355\u8bcd\u53f3\u4fa7\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4e0e\u5b83\u76f8\u540c\u7684\u5355\u8bcd\u5bf9\u5e94\u7684\u5143\u7d20\u53d8\u6210 $-1$\u3002\u4ecd\u7136\u62ff\u6837\u4f8b $3$ \u4e3e\u4f8b\uff0c\r\n\r\n- \u7b2c\u4e00\u4e2a\u5b50\u4e32\uff1a$[\\underline{-1,-1,-1,-1,2,-1},1,7,7,7]$\uff1b\r\n- \u7b2c\u4e8c\u4e2a\u5b50\u4e32\uff1a$[-1,\\underline{-1,-1,-1,2,-1,1},\\textcolor{red}{-1},7,7]$\uff0c\u7b2c\u4e00\u4e2a\u5355\u8bcd $\\verb!a!$ \u5df2\u7ecf\u79fb\u51fa\u7a97\u53e3\uff0c\u4e8e\u662f\u5c06\u5b83\u53f3\u4fa7\u7b2c\u4e00\u4e2a $\\verb!a!$ \u7684\u4f4d\u7f6e\u6362\u6210 $-1$\uff1b\r\n- \u7b2c\u4e09\u4e2a\u5b50\u4e32\uff1a$[-1,-1,\\underline{-1,-1,2,-1,1,-1},\\textcolor{red}{-1},7]$\uff1b\u7b2c\u4e8c\u4e2a\u5355\u8bcd $\\verb!b!$ \u5df2\u7ecf\u79fb\u51fa\u7a97\u53e3\uff0c\u4e8e\u662f\u5c06\u5b83\u53f3\u4fa7\u7b2c\u4e00\u4e2a $\\verb!b!$ \u7684\u4f4d\u7f6e\u6362\u6210 $-1$\uff1b\r\n- \u7b2c\u56db\u4e2a\u5b50\u4e32\uff1a$[-1,-1,-1,\\underline{-1,\\textcolor{red}{-1},-1,1,-1,-1},7]$\uff1b\u7b2c\u4e09\u4e2a\u5355\u8bcd $\\verb!b!$ \u5df2\u7ecf\u79fb\u51fa\u7a97\u53e3\uff0c\u4e8e\u662f\u5c06\u5b83\u53f3\u4fa7\u7b2c\u4e00\u4e2a $\\verb!c!$ \u7684\u4f4d\u7f6e\u6362\u6210 $-1$\uff1b\r\n- \u7b2c\u4e94\u4e2a\u5b50\u4e32\uff1a$[-1,-1,-1,-1,\\underline{-1,-1,1,-1,-1,7}]$\u3002\r\n\r\n\u7ef4\u62a4\u7684\u65f6\u5019\uff0c\u5982\u679c\u9700\u8981\u53d8\u6210 $-1$ \u7684\u90a3\u4e2a\u5143\u7d20\u7684\u4f4d\u7f6e\u5728\u5f53\u524d\u5b50\u4e32\u6240\u5904\u7684\u533a\u95f4 $[l,r]$ \u5185\uff0c\u5c31\u5c06\u5b50\u4e32\u7684\u54c8\u5e0c\u503c $h$ \u51cf\u53bb\u539f\u6765\u8fd9\u4e2a\u5143\u7d20\u7684\u8d21\u732e\u503c\uff0c\u518d\u52a0\u4e0a\u53d8\u6210 $-1$ \u540e\u7684\u8d21\u732e\u503c\u3002\u5982\u679c\u5728 $[l,r]$ \u5916\u5c31\u4e0d\u7528\u7ba1\u3002\u522b\u7684\u7ef4\u62a4\u548c\u4e00\u822c\u7684\u533a\u95f4\u54c8\u5e0c\u76f8\u4f3c\u3002\r\n\r\n## \u53c2\u8003\u4ee3\u7801\r\n\r\n```cpp\r\n#include<bits/stdc++.h>\r\n#define up(l, r, i) for(int i = l, END##i = r;i <= END##i;++ i)\r\n#define dn(r, l, i) for(int i = r, END##i = l;i >= END##i;-- i)\r\nusing namespace std;\r\ntypedef long long i64;\r\nconst int INF = 2147483647;\r\nconst int MAXN= 1e6 + 3;\r\nint L1[MAXN], R1[MAXN];\r\nint L2[MAXN], R2[MAXN];\r\nint A[MAXN], B[MAXN], n, m;\r\ntypedef unsigned int       u32;\r\ntypedef unsigned long long u64;\r\nconst u64 BAS = 13331;\r\nu64 H[MAXN], P[MAXN];\r\nmap <string, int> M;\r\nint main(){\r\n    string t;\r\n    while(cin >> t && t != \"$\"){\r\n        R1[M[t]] = ++ n, L1[n] = M[t], M[t] = n;\r\n    }\r\n    M.clear();\r\n    while(cin >> t && t != \"$\"){\r\n        R2[M[t]] = ++ m, L2[m] = M[t], M[t] = m;\r\n    }\r\n    for(int i = 1;i <= n;++ i) if(!R1[i]) R1[i] = INF;\r\n    for(int i = 1;i <= m;++ i) if(!R2[i]) R2[i] = INF;\r\n    for(int i = 1;i <= n;++ i) A[i] = L1[i] ? i - L1[i] : -1;\r\n    for(int i = 1;i <= m;++ i) B[i] = L2[i] ? i - L2[i] : -1;\r\n    u64 h0 = 0, h = 0; P[0] = 1;\r\n    for(int i = 1;i <= m;++ i) P[i] = P[i - 1] * BAS;\r\n    for(int i = 1;i <= m;++ i)\r\n        h0 = h0 * BAS + B[i], h  = h  * BAS + A[i];\r\n    if(h == h0) printf(\"%d\\n\", 1), exit(0);\r\n    for(int i = m + 1;i <= n;++ i){\r\n        h = h * BAS + A[i], h = h - A[i - m] * P[m];\r\n        if(R1[i - m] <= i){\r\n            h = h - A[R1[i - m]] * P[i - R1[i - m]];\r\n            A[R1[i - m]] = -1;\r\n            h = h + A[R1[i - m]] * P[i - R1[i - m]];\r\n        } else if(R1[i - m] <= n) A[R1[i - m]] = -1;\r\n        if(h == h0) printf(\"%d\\n\", i - m + 1), exit(0);\r\n    }\r\n    return 0;\r\n}\r\n```",
        "postTime": 1675160183,
        "uid": 68344,
        "name": "\u79bb\u6563\u5c0f\u6ce2\u53d8\u6362\u00b0",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 \u3010P8085 [COCI2011-2012#4] KRIPTOGRAM\u3011"
    }
]
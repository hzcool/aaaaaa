[
    {
        "content": "# \u672c\u9898\u89e3\u5f88\u6613\u61c2\uff01\n## [\u539f\u9898\u5730\u5740](https://www.luogu.com.cn/problem/P5337)\n\u7ed9\u4f60\u4e00\u4e2a\u6570$n$\u548c\u4e00\u4e2a\u5b57\u7b26\u4e32$s$\uff0c\u6c42\u7b26\u5408\u957f\u5ea6\u4e3a$n$\u4e14\u5728$s$\u4e2d\u8fde\u7eed\u7684\u5b57\u7b26\u4e0d\u80fd\u8fde\u7eed\u51fa\u73b0\uff0c\u5373\u8fd9\u4e2a\u5b57\u7b26\u4e32\u4e2d\u4e0d\u80fd\u51fa\u73b0$s$\u7684\u8fde\u7eed\u5b50\u4e32,\u7b54\u6848\u5bf9$1e9+7$\u53d6\u6a21\u3002\n\n$n \\le 1e15$\n\n\u4e0d\u96be\u60f3\u5230\u4e00\u4e2a\u5f88\u66b4\u529b\u7684$dp$\uff1a\n\u8bbe$dp[i][j]$\u4e3a\u957f\u5ea6\u4e3a$i$\u4e14\u5f53\u524d\u5b57\u7b26\u4e3a$j$\u7684\u5408\u6cd5\u5b57\u7b26\u4e32\u4e2a\u6570$(mod 1e9+7)$\uff0c\u4e0d\u96be\u63a8\u5f0f\u5b50\uff1a\n$$dp[i][j]=\\sum_{k=1}^{26}dp[i-1][k]|(k,j)\\not\\in s$$\n$$\\forall_{1\\le i \\le 26}dp[1][i]=1$$\n$$ans=\\sum_{i=1}^{26}dp[n][i]$$\n\u65f6\u95f4\u590d\u6742\u5ea6$O(26^2n)$\uff1f\u53cd\u6b63T\u98de\u3002\n\u6211\u4eec\u73c2\u4ee5\u628a\u4e0a\u9762\u7684\u5f0f\u5b50\u53d8\u4e00\u4e0b\uff0c\u8bbe$w[i][j]=[(i,j)\\not\\in s]$\uff0c\u5373\u82e5$(i,j)$\u5728$s$\u4e2d\u4e0d\u8fde\u7eed\uff0c\u5219$w[i][j]=1$\uff0c\u5426\u5219$w[i][j]=0$\u3002\n\u5f0f\u5b50\u53d8\u6210\u4e86\uff1a\n$$dp[i][j]=\\sum_{k=1}^{26}dp[i-1][k]\\times w[k][j]$$\n\u73c2\u80fd\u4f60\u4e00\u5f00\u59cb\u6ca1\u770b\u61c2\uff0c$dp[i-1][k] \\times w[k][j]$\u662f\u5565\u5462\uff1f\n\u5206\u6790\u4e00\u4e0b\uff0c\u82e5$(k,j)\\not \\in s$\uff0c\u90a3\u4e48$w[k][j]=1$\uff0c$dp[i-1][k]\\times w[k][j]=dp[i-1][k]$\uff0c\u8d21\u732e\u4e3a$dp[i-1][k]$\uff0c\u7b26\u5408\u9898\u610f\u3002\n\u82e5$(i,j)\\in s$\uff0c\u5219$w[k][j]=0$\uff0c\u8d21\u732e\u4e3a$0$\u3002\n\u4f60\u53ef\u80fd\u4f1a\u8bf4\u201c\u65f6\u95f4\u590d\u6742\u5ea6\u5e76\u6ca1\u6709\u53d8...\u201d\n\u786e\u5b9e\u6ca1\u6709\u53d8\uff0c\u4f46\u662f\u8fd9\u4e2a\u5f0f\u5b50\u73c2\u4ee5\u4f18\u5316\u4e86\u3002\n\u611f\u89c9\u8fd9\u4e2a\u5f0f\u5b50\u60f3\u4ec0\u4e48\uff1f\u5bf9\uff01\u77e9\u9635\u4e58\u6cd5\uff01\uff01\uff01\n\u77e9\u4e58\u7684\u677f\u5b50\u662f$c[i][j]=\\sum_{k=1}^{26}{a[i][k]\\times b[k][j]}$\n\u6211\u4eec\u5efa$n$\u4e2a$1\\times 26$\u7684\u77e9\u9635$F_1,F_2,F_3,\\cdots F_n$\uff0c\u5206\u522b\u4ee3\u8868$dp[1][1\\cdots26],dp[2][1\\cdots26],dp[3][1\\cdots26]\\cdots dp[n][1\\cdots26]$\u518d\u5efa\u4e00\u4e2a$26*26$\u7684\u77e9\u9635$A$\u5177\u4f53\u542b\u4e49\u89c1\u4e0b\u9762\u3002\n\u521d\u59cb\u5316\uff1a\n$$\nF_1=\n\\left[\n\\begin{matrix}\n 1 &1 &1 &1\\cdots 1\n\\end{matrix}\n\\right]$$\n\n\n$$\nA=\n\\left[\n\\begin{matrix}\nw[1][1]&w[1][2]&w[1][3]&\\cdots &w[1][26] \\\\\nw[2][1]&w[2][2]&w[2][3] &\\cdots&w[2][26] \\\\\n\\vdots &\\vdots &\\vdots &\\ddots&\\vdots \\\\\nw[26][1]&w[26][2]&w[26][3]&\\cdots &w[26][26]\n\\end{matrix}\n\\right]\n$$\n\n\u4e0d\u96be\u63a8\u51fa$F_i=F_{i-1}\\times A(i>1)$\n\u7136\u800c\u6a21\u62df\u77e9\u9635\u4e58\u4e5f\u4f1a\u70b8\u554a...\n\u77e9\u9635\u4e58\u6cd5\u662f$O(26^3)$\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u7b97\u4e0a\u9012\u63a8\u7684$O(n)$\u5c31\u662f$O(n\\times 26^3)$\uff0c\u60ca\uff0c\u88ab\u66b4\u529b\u540a\u6253\uff01\n\u7136\u800c\u8fd8\u6709\u4e00\u4e2a\u795e\u5668\uff0c**\u77e9\u9635\u5feb\u901f\u5e42**\uff01\n\uff08\u4e0d\u4f1a\u5feb\u901f\u5e42\u7684\u73c2\u4ee5\u9000\u51fa\u8865\u77e5\u8bc6\u4e86\uff09\n\u6211\u4eec\u77e5\u9053\u77e9\u4e58\u662f\u6709\u5206\u914d\u5f8b\u7684\uff0c\u4f46\u662f\u8fd9\u4e2a\u987a\u63a8\u7684\u5f0f\u5b50\u597d\u50cf\u4e0d\u50cf\u662f\u77e9\u9635\u5feb\u901f\u5e42\u7684\u6837\u5b50...\n\u90a3\u4e48\u5f00\u59cb\u4e0b\u9762\u4e00\u6ce2\u64cd\u4f5c\uff1a\n$$F_2=F_1\\times A$$\n$$F_3=F_2\\times A$$\n\u7136\u540e\u6211\u4eec\u5c06\u4e0a\u9762\u6c42\u7684$F_2$\u4ee3\u5165\uff1a\n$$F_3=F_1\\times A\\times A=F_1\\times A^2$$\n$$F_4=F_3\\times A=F_1\\times A^3$$\n$$\\vdots$$\n$$F_n=F_1\\times A^{n-1}$$\n\u5999\u554a\uff01\n$$ans=\\sum_{i=1}^{26}F_n(1,i)$$\n\u4f46\u662f\u4f60\u4f1a\u53d1\u73b0\uff0c\u5982\u679c\u53ea\u5230\u8fd9\u4e00\u6b65\u7684\u8bdd\uff0c\u6700\u540e\u8fd8\u8981\u7b97\u4e00\u4e2a $F_1 \\times A^{n-1}$\uff0c\u7206\u6389\u3002\n\u4f46\u5176\u5b9e\uff0c\n$$\\sum_{i=1}^{26}F_n(1,i)=\\sum_{i=1}^{26}\\sum_{j=1}^{26} A^{n-1}(i,j)$$\n## $\\color{red}???$\n\u4ec0\u4e48\u64cd\u4f5c\uff1f\n\u5982\u679c\u60a8\u7684\u77e9\u9635\u57fa\u7840\u624e\u5b9e\uff0c\u8bf7\u8df3\u8fc7\u6b64\u6b65\u9aa4\u3002\n\u8bbe$C=F_1\\times A^{n-1}$,\u5219\n$$C(1,1)=F_1(1,1)\\times A^{n-1}(1,1)+F_1(1,2)\\times A^{n-1}(2,1) +\\cdots +F_1(1,26)\\times A^{n-1}(26,1)$$\n\u56e0\u4e3a\n$$\nF_1=\n\\left[\n\\begin{matrix}\n 1 &1 &1 &1\\cdots 1\n\\end{matrix}\n\\right]\n$$\n\u6240\u4ee5\n$$C(1,1)=A^{n-1}(1,1)+A^{n-1}(2,1)+\\cdots+ A^{n-1}(26,1)$$\n\u5176\u4ed6\u70b9\u4ee5\u6b64\u7c7b\u63a8\n\u53d1\u73b0$C$\u77e9\u9635\u7684\u6240\u6709\u6570\u7684\u548c\u5c31\u662f$A^{n-1}$\u77e9\u9635\u7684\u6240\u6709\u6570\u7684\u548c\u3002\n\u8fd9\u5176\u5b9e\u662f\u77e9\u9635\u7684\u7b80\u5355\u7684\u6e38\u620f\u3002\n\u65f6\u95f4\u590d\u6742\u5ea6$O(26^3logn)$\uff0c\u80fd\u8fc7\u3002\n\n$\\color{blue}Code$\uff1a\n```cpp\n# include <bits/stdc++.h>\nusing namespace std;\nstruct Martix\n{\n\tlong long a[30][30];\n}A;\nunsigned long long n;\nchar s[100010];\nconst long long mod=1e9+7;\nMartix operator *(const Martix &x,const Martix &y) \n{\n\tMartix ans;\n\tfor(int i=1;i<=26;i++) for(int j=1;j<=26;j++) ans.a[i][j]=0;\n\tfor(int i=1;i<=26;i++) \n\t{\n\t\tfor(int j=1;j<=26;j++) \n\t\t{\n\t\t\tfor(int k=1;k<=26;k++) \n\t\t\t{\n\t\t\tans.a[i][j]=(ans.a[i][j]+(x.a[i][k]%mod)*(y.a[k][j]%mod)%mod)%mod;\n\t\t\tans.a[i][j]%=mod;\n\t\t\t}\n\t\t}\n\t}\n\treturn ans;\n}\nMartix js(Martix x,long long n) \n{\n\tMartix ans;\n\tfor(int i=1;i<=26;i++)\n\t{\n\t\tfor(int j=1;j<=26;j++) \n\t\t{\n\t\t\tans.a[i][j]=0;\n\t\t}\n\t}\n\tfor(int i=1;i<=26;i++) ans.a[i][i]=1;\n\twhile(n) \n\t{\n\t\tif(n&1) \n\t\t{\n\t\t\tans=ans*x;\n\t\t\tn--;\n\t\t}\n\t\tx=x*x;\n\t\tn>>=1;\n\t}\n\treturn ans;\n}\nint main(void) \n{\n\tscanf(\"%llu%s\",&n,&s);\n\tfor(int i=1;i<=26;i++) \n\t{\n\t\tfor(int j=1;j<=26;j++) \n\t\t{\n\t\t\tA.a[i][j]=1;\n\t\t}\n\t}\n\tfor(int i=1;i<strlen(s);i++) \n\t{\n\t\tA.a[s[i-1]-'a'+1][s[i]-'a'+1]=0;\n\t}\n\tMartix ans=js(A,n-1) ;\n\tlong long tot=0;\n\tfor(int i=1;i<=26;i++) \n\t{\n\t\tfor(int j=1;j<=26;j++) \n\t\t{\n\t\t//\tcout<<ans.a[i][j]<<\" \";\n\t\t\ttot=(tot%mod)+(ans.a[i][j]%mod)%mod;\n\t\t}\n\t\t//cout<<endl;\n\t}\n\tcout<<tot%mod<<endl; \n\treturn 0;\n}\n```",
        "postTime": 1584363935,
        "uid": 153546,
        "name": "luyiming",
        "ccfLevel": 0,
        "title": "P5337 [TJOI2019]\u7532\u82ef\u5148\u751f\u7684\u5b57\u7b26\u4e32"
    },
    {
        "content": "\u8fd9\u9053\u9898\u81ea\u5df1\u505a\u7684\u65f6\u5019\u771f\u6ca1\u60f3\u51fa\u6765\u6b63\u89e3\u3002\u540e\u6765\u53d1\u73b0\u5176\u5b9e\u5e76\u4e0d\u96be\uff0c\u53ea\u80fd\u8bf4\u81ea\u5df1\u5b66\u7684\u4e0d\u624e\u5b9e\uff0c\u4e0d\u4f1a\u5e94\u7528\u5b66\u8fc7\u7684\u77e5\u8bc6\u3002\n\n# [\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://ccreeper33.github.io/2019/05/12/P5337%E7%94%B2%E8%8B%AF%E5%85%88%E7%94%9F%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2/)\n\n\n## \u6784\u9020\n\n\u4e0d\u96be\u53d1\u73b0\u72b6\u6001\u53ea\u670926\u79cd\uff0c\u5e76\u4e14\u540e\u4e00\u4f4d\u5b57\u6bcd\u7531\u662f\u524d\u4e00\u4f4d\u51b3\u5b9a\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u9012\u63a8\u5f0f\n\n$$f[i] [j]= \\sum_{k = 0}^{25} f[i - 1] [k] * d[k][j] $$\n\n\u5176\u4e2d$d[i] [j]$\u8868\u793a\u4e0a\u4e00\u4f4d\u4e3a\u7b2c$i$\u4e2a\u5b57\u6bcd\u65f6\uff0c\u5f53\u524d\u4f4d\u662f\u5426\u53ef\u4ee5\u4e3a\u7b2c$j$\u4e2a\u5b57\u6bcd\u3002\n\n\u65e2\u7136\u6709\u4e86\u9012\u63a8\u5f0f\uff0c\u53c8\u53d1\u73b0\u6570\u636e\u8303\u56f4\u662f$10^{15}$\uff0c\u4e0d\u96be\u60f3\u5230\u7528\u77e9\u9635\u5feb\u901f\u5e42\u6765\u52a0\u901f\uff0c\u6240\u4ee5\u6784\u9020\u4ee5\u4e0b\u77e9\u9635\n\n$$\n \\begin{bmatrix}\n   1 & 1 & 1 & 1 & 1 & ... &1 \\\\\n \\end{bmatrix}\n$$\n$$ans$$\n\n\u8868\u793a\u5f53$n = 1$\u65f6\uff0c\u5206\u522b\u53ef\u80fd\u4ee526\u4e2a\u5b57\u6bcd\u7ed3\u5c3e\u3002\n\n$$\n \\begin{bmatrix}\n  1 & 1 & 1& ... &1\\\\\\\\\n  1 & 1 & 1& ... &1\\\\\\\\\n  1 & 1 & 1& ... &1\\\\\\\\\n  \\vdots & \\vdots & \\vdots & & \\vdots \\\\\\\\\n  1 & 1 & 1& ... &1\\\\\\\\\n \\end{bmatrix}\n$$\n\n$$base$$\n\n\u8f6c\u79fb\u77e9\u9635\uff0c\u610f\u4e49\u5982\u4e0a\u6587\u4e2d\u7684$d[i][j]$\u3002\n\n$$\n\\left[\n \\begin{matrix}\n  1\\\\\\\\\n  1\\\\\\\\\n  1\\\\\\\\\n  \\vdots \\\\\\\\\n  1\\\\\\\\\n \\end{matrix}\n\\right]\n$$\n\n$$get\\_ans$$\n\n\u5bf9$ans$\u77e9\u9635\u5143\u7d20\u6c42\u548c\u3002\n\n### \u6784\u9020\u5b8c\u6210\uff01\n\n\u6b64\u65f6\u53ef\u5f97$ans * base^{n - 1} * get\\_ans$\u5373\u4e3a\u6240\u6c42\u7b54\u6848\u3002\n\n## \u9644\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mod = 1e9 + 7;\ntypedef long long LL;\n\nstruct matrix { //\u77e9\u9635\u76f8\u5173\n\tLL a[26][26];\n\tmatrix() {  \n\t\tmemset(a, 0, sizeof(a));\n\t}\n\tmatrix operator *(const matrix &o) { //\u91cd\u8f7d\u8fd0\u7b97\u7b26\n\t\tmatrix res;\n\t\tfor(int i = 0; i < 26; ++i) {\n\t\t\tfor(int k = 0; k < 26; ++k) {\n\t\t\t\tint temp = a[i][k];\n\t\t\t\tfor(int j = 0; j < 26; ++j) {\n\t\t\t\t\tres.a[i][j] += (temp * o.a[k][j]) % mod;\n\t\t\t\t\tres.a[i][j] %= mod;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t}\n}ans, base, get_ans;\n\n/*\nistream& operator >> (istream &is, matrix &o) { \n    for(int i = 0; i < 26; ++i) {\n        for(int j = 0; j < 26; ++j) {\n            is >> o.a[i][j];\n        }\n    }\n    return is;\n}\nostream& operator << (ostream &os, const matrix &o) {\n    for(int i = 0; i < 26; ++i) {\n        for(int j = 0; j < 26; ++j) {\n            os << o.a[i][j] << \" \";\n        }\n        os << endl;\n    }\n    return os;\n}\n*/\n\nmatrix q_pow(matrix a, LL b) { //\u77e9\u9635\u5feb\u901f\u5e42\n\tmatrix res;\n\tfor(int i = 0; i < 26; ++i) { \n\t\tres.a[i][i] = 1;\n\t}\n\twhile(b) {\n\t\tif(b & 1) res = res * a;\n\t\ta = a * a;\n\t\tb >>= 1; \n\t}\n\treturn res;\n}\n\nLL n, len;\nchar s[100005]; \n\nint main() {\n\tfor(int i = 0; i < 26; ++i) {\n\t\tans.a[0][i] = get_ans.a[i][0] = 1;\n\t\tfor(int j = 0; j < 26; ++j) {\n\t\t\tbase.a[i][j] = 1;\n\t\t}\n\t}\n\tcin >> n >> s;\n\tlen = strlen(s); \n\tfor(int i = 1; i < len; ++i) {\n\t\tbase.a[s[i - 1] - 'a'][s[i] - 'a'] = 0;\n\t}\n\tcout << (ans * q_pow(base, n - 1) * get_ans).a[0][0] << endl;\n\treturn 0;\n}\n```\n",
        "postTime": 1557665093,
        "uid": 93155,
        "name": "Ccreeper",
        "ccfLevel": 4,
        "title": "P5337 \u7532\u82ef\u5148\u751f\u7684\u5b57\u7b26\u4e32"
    },
    {
        "content": "\u6709**\u70b9**\u601d\u7ef4\u542b\u91cf\u7684\u9898\u554a\u3002\n\n\u867d\u7136\u4f5c\u4e3a\u7701\u9009\u9898\u592a\u5957\u8def\u4e86\u3002\n\n\u5f88\u663e\u7136\u662f$dp$\n\n\u8bbe$f[i][j]$\u8868\u793a\u957f\u5ea6\u4e3a$i$,\u672b\u4f4d\u4e3a\u5b57\u7b26$j$\u7684\u65b9\u6848\u6570\n\n\u5f88\u663e\u7136\u7684\u8f6c\u79fb\u5f0f\n\n$$f[i][j]+=f[i-1][k]\\ (kj\\ \\text{\u4e0d\u4e3as1\u7684\u5b50\u4e32})$$\n\n\u4f46\u662f$n$\u5f88\u5927\uff0c\u600e\u4e48\u529e\u5462\uff1f\n\n\u53d1\u73b0\u662f\u5426\u53ef\u4ee5\u8f6c\u79fb\u7684\u60c5\u51b5\u662f\u56fa\u5b9a\u7684\n\n\u53ef\u4ee5\u8003\u8651\u4f7f\u7528**\u77e9\u9635**\u6765\u5224\u65ad\u662f\u5426\u53ef\u4ee5\u8f6c\u79fb\u3002\n\n\u5982\u679c\u5b57\u7b26\u4e32$ij$\u4e0d\u4e3a$s1$\u7684\u5b50\u4e32\uff0c\u90a3\u4e48\u77e9\u9635$X$\u4e2d$X[i][j]=1$\uff0c\u5426\u5219$X[i][j]=0$\u3002\n\n$X$\u5927\u5c0f\u4e3a$26$\u3002\n\n\u4e00\u6b21\u8f6c\u79fb\u5c31\u662f\u505a\u4e00\u6b21\u77e9\u9635\u4e58\u6cd5\n\n$\\begin{bmatrix}f[1] & f[2] & ... &f[26]\\end{bmatrix}\\times X$\n\n\u4e3a\u4ec0\u4e48\u5462\uff1f\n\n\u56e0\u4e3a$f[i][j]+=f[i-1][k]\\ (kj\\ \\text{\u4e0d\u4e3as1\u7684\u5b50\u4e32})$\n\n\u4e5f\u5c31\u662f$f[i][j]+=f[i-1][k]\\times X[k][j]$\n\n\u5c31\u662f\n$$f[j]=\\sum_{k=1}^{26}f[k]\\times X[k][j]$$\n\n\u6b63\u597d\u662f\u77e9\u9635\u7684\u5f62\u5f0f\u3002\n\n\u7531\u4e8e\u521d\u59cb\u6761\u4ef6\u4e0b$f[1]=f[2]=...=1$\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u6c42\u51fa$X^{n-1}$\u77e9\u9635\u4e2d\u6240\u6709\u6570\u7684\u548c\u5c31\u597d\u4e86\u3002\u77e9\u9635\u5feb\u901f\u5e42\u505a\u5230\u65f6\u95f4\u590d\u6742\u5ea6$O(26^3log_2n)$\n\n```cpp\n// luogu-judger-enable-o2\n#include<bits/stdc++.h>\n#define ljc 1000000007\nusing namespace std;\nlong long n,m,pr,nf,x;\nchar s[1000001];\nstruct matrix{\n    long long x[27][27];long long sz;\t\n    inline void clear(){\n        for (int i=1;i<=26;i++){\n            for (int j=1;j<=26;j++){\n                x[i][j]=0;\n            }\n        }\n    }\n}a,one;\ninline matrix mul(matrix a,matrix b){\n    matrix c;\n    c.clear();c.sz=a.sz;\n    for (int i=1;i<=26;i++){\n        for (int j=1;j<=26;j++){\n            for (int k=1;k<=26;k++){\n                c.x[i][j]=(c.x[i][j]%ljc+a.x[i][k]%ljc*b.x[k][j]%ljc)%ljc;\n            }\n        }\n    }\n    return c;\n}\ninline matrix fast_pow(matrix a,long long b){\n    matrix t=one;\n    while (b){\n        if (b&1LL) t=mul(t,a);\n        a=mul(a,a);b/=2LL;\n    }\n    return t;\n}\ninline void init_one(){\n    one.sz=a.sz;\n    for (int i=1;i<=26;i++){\n        one.x[i][i]=1;\n    }\n}\nint main(){\n    scanf(\"%lld\",&n);\n    init_one();\n    for (int i=1;i<=26;i++){\n    \tfor (int j=1;j<=26;j++){\n    \t\ta.x[i][j]=1;\n\t\t}\n\t}\n\tscanf(\"%s\",s+1);\n\tint len=strlen(s+1);\n\tfor (int i=2;i<=len;i++){\n\t\ta.x[s[i-1]-'a'+1][s[i]-'a'+1]=0;\n\t}\n    a=fast_pow(a,n-1);\n    long long ans=0;\n\tfor (int i=1;i<=26;i++){\n    \tfor (int j=1;j<=26;j++){\n    \t\tans=(ans+a.x[i][j])%ljc;\n\t\t}\n\t}\n\tcout<<ans;\n}\n\n```\n",
        "postTime": 1556973331,
        "uid": 20309,
        "name": "Fading",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5337 \u3010[TJOI2019]\u7532\u82ef\u5148\u751f\u7684\u5b57\u7b26\u4e32\u3011"
    },
    {
        "content": "# \u9898\u76ee\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[\u70b9\u8fd9\u91cc](https://www.luogu.com.cn/problem/P5337)\u770b\u9898\u76ee\u3002  \n# \u5206\u6790\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u663e\u7136\u662f\u4e00\u9053$DP$\u9898\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$f(i,j)$\uff1a\u957f\u5ea6\u4e3a$i$\uff0c\u6700\u540e\u4e00\u4e2a\u5b57\u7b26$j$\uff0c\u4e14\u6ee1\u8db3\u9898\u76ee\u8981\u6c42\u7684\u5b57\u7b26\u4e32\u7684\u6570\u91cf\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u8bbe$g(x,y)$\u8868\u793a$x$\u548c$y$\u4e24\u4e2a\u5b57\u7b26\u53ef\u4ee5\u5728\u6700\u7ec8\u7684\u5b57\u7b26\u4e32\u4e2d\u76f8\u90bb\u51fa\u73b0\uff0c\u4e5f\u5c31\u662f\u6ee1\u8db3$x$\u548c$y$\u4e0d\u5728$s_1$\u4e2d\u76f8\u90bb\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u8f6c\u79fb\uff1a  \n$$f(i,j)=\\sum_{k='a'}^{'z'}f(i-1,k)[g(k,j)]$$  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u66b4\u529b\u505a\u662f$O(26^2n)$\u7684\uff0c$T$\u98de\u4e86\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u8003\u8651\u4f18\u5316\u3002\u53d1\u73b0\u7b2c\u4e8c\u4f4d\u72b6\u6001\u53ea\u6709$26$\uff0c\u5e76\u4e14$n$\u65e0\u6bd4\u5de8\u5927\uff0c\u6240\u4ee5\u8003\u8651\u77e9\u9635\u52a0\u901f\u3002\u8bbe\u8ba1\u521d\u59cb\u77e9\u9635\u4e3a\uff1a \n$$\\begin{bmatrix}1&1&1&\\dots&1\\end{bmatrix}$$  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u8f6c\u79fb\u77e9\u9635\uff1a  \n$$\\begin{bmatrix}g('a','a')&g('a','b')&g('a','c')&\\dots&g('a','z')\\\\g('b','a')&g('b','b')&g('b','c')&\\dots&g('b','z')\\\\g('c','a')&g('c','b')&g('c','c')&\\dots&g('c','z')\\\\\\vdots&\\vdots&\\vdots&\\ddots&\\vdots\\\\g('z','a')&g('z','b')&g('z','c')&\\dots&g('z','z')\\end{bmatrix}$$    \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u65f6\u95f4\u662f$O(26^3\\log_2n)$   \n# \u4ee3\u7801\n```cpp\n#include <cstdio>\n#include <cstring>\n\ntypedef long long LL;\n\nconst int mod = 1e9 + 7;\nconst int MAXSIZ = 30, MAXLEN = 1e5 + 5;\n\ntemplate<typename _T>\nvoid read( _T &x )\n{\n\tx = 0;char s = getchar();int f = 1;\n\twhile( s > '9' || s < '0' ){if( s == '-' ) f = -1; s = getchar();}\n\twhile( s >= '0' && s <= '9' ){x = ( x << 3 ) + ( x << 1 ) + ( s - '0' ), s = getchar();}\n\tx *= f;\n}\n\ntemplate<typename _T>\nvoid write( _T x )\n{\n\tif( x < 0 ){ putchar( '-' ); x = ( ~ x ) + 1; }\n\tif( 9 < x ){ write( x / 10 ); }\n\tputchar( x % 10 + '0' );\n}\n\nstruct matrix\n{\n\tint mat[MAXSIZ][MAXSIZ], n, m;\n\tmatrix( const int N = 0, const int M = 0 ) { n = N, m = M, memset( mat, 0, sizeof mat ); }\n\tint * operator [] ( const int & indx ) { return mat[indx]; }\n\tmatrix operator * ( matrix other ) const \n\t{\n\t\tmatrix ret = matrix( n, other.m );\n\t\tfor( int i = 1 ; i <= ret.n ; i ++ )\n\t\t\tfor( int j = 1 ; j <= ret.m ; j ++ )\n\t\t\t\tfor( int k = 1 ; k <= m ; k ++ )\n\t\t\t\t\tret[i][k] = ( ret[i][k] + 1ll * mat[i][j] * other[j][k] % mod ) % mod;\n\t\treturn ret;\n\t}\n\tvoid operator *= ( matrix other ) { *this = *this * other; }\n}A, B;\n\nLL N;\nint M;\nchar S[MAXLEN];\n\nint getIndx( char c ) { return c - 'a' + 1; }\nmatrix I( const int n ) \n{ matrix ret = matrix( n, n ); for( int i = 1 ; i <= n ; i ++ ) ret[i][i] = 1; return ret; }\n\nmatrix qkpow( matrix base, LL indx )\n{\n\tmatrix ret = I( base.n );\n\twhile( indx )\n\t{\n\t\tif( indx & 1 ) ret *= base;\n\t\tbase *= base; indx >>= 1;\n\t}\n\treturn ret;\n}\n\nvoid init()\n{\n\tA = matrix( 1, 26 );\n\tfor( int i = 1 ; i <= 26 ; i ++ ) A[1][i] = 1;\n\tB = matrix( 26, 26 );\n\tfor( int i = 1 ; i <= 26 ; i ++ )\n\t\tfor( int j = 1 ; j <= 26 ; j ++ )\n\t\t\tB[i][j] = 1;\n}\n\nint main()\n{\n\tinit();\n\tread( N );\n\tscanf( \"%s\", S + 1 ), M = strlen( S + 1 );\n\tfor( int i = 1 ; i < M ; i ++ ) B[getIndx( S[i] )][getIndx( S[i + 1] )] = 0;\n\tmatrix part = qkpow( B, N - 1 );\n\tmatrix fine = A * part;\n\tint res = 0;\n\tfor( int i = 1 ; i <= 26 ; i ++ ) res = ( res + fine[1][i] ) % mod;\n\twrite( res ), putchar( '\\n' );\n\treturn 0;\n}\n```",
        "postTime": 1576847253,
        "uid": 123809,
        "name": "crashed",
        "ccfLevel": 0,
        "title": "[TJOI2019]\u7532\u82ef\u5148\u751f\u7684\u5b57\u7b26\u4e32"
    },
    {
        "content": "**\u642c\u8fd0\u5b98\u65b9\u9898\u89e3\u3002**\n\n------------\n\n$dp[i][j]$\u8868\u793a\u957f\u5ea6\u4e3a$i$\u7684\u5b57\u7b26\u4e32\u4ee5$j$\u7ed3\u5c3e\u65f6\u7684\u5408\u6cd5\u65b9\u6848\u6570\uff0c$w[i][j]$\u8868\u793a\u5b57\u7b26\u4e32$ij$\u80fd\u5426\u51fa\u73b0\u3002\n\ndp\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u8868\u793a: $dp[i][j] = \\sum w[k][j] \\times dp[i-1][k]$\n\n\u5bf9\u4e8e100%\u7684\u6570\u636e\uff0c\u8003\u8651\u5230\u8f6c\u79fb\u65b9\u7a0b\u662f\u4e2a\u77e9\u9635\uff0c\u53ef\u4ee5\u4f7f\u7528\u77e9\u9635\u5feb\u901f\u5e42\u52a0\u901f\u8fd0\u7b97\u3002\n\n------------\n\nstd\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nchar s[100100];\nstruct Mat{\n\tlong long m[26][26];\n};\nlong long mod=1e9+7;\n\nMat mul(Mat a,Mat b){\n\tMat ret;\n\tmemset(ret.m,0,sizeof(ret.m));\n\tfor(int i=0;i<26;i++)\n\t\tfor(int j=0;j<26;j++)\n\t\t\tfor(int k=0;k<26;k++)\n\t\t\t\tret.m[i][j]+=a.m[i][k]*b.m[k][j]%mod;\n\tfor(int i=0;i<26;i++)\n\t\tfor(int j=0;j<26;j++)\n\t\t\tret.m[i][j]%=mod;\n\treturn ret;\n}\n\nMat mypow(Mat a,long long int k){\n\tMat ret;\n\tfor(int i=0;i<26;i++)\n\t\tfor(int j=0;j<26;j++)\n\t\t\tret.m[i][j]=(i==j);\n\twhile(k){\n\t\tif(k&1) ret=mul(ret,a);\n\t\ta=mul(a,a);\n\t\tk>>=1;\n\t}\n\treturn ret;\n}\n\nint main(){\n\tfreopen(\"str.in\", \"r\", stdin);\n\tfreopen(\"str.out\", \"w\", stdout);\n\tlong long int n;\n\tscanf(\"%lld%s\",&n,s);\n\tint l=strlen(s);\n\tMat a;\n\tfor(int i=0;i<26;i++)\n\t\tfor(int j=0;j<26;j++)\n\t\t\ta.m[i][j]=1;\n\tfor(int i=1;i<l;i++){\n\t\ta.m[s[i-1]-'a'][s[i]-'a']=0;\n\t}\n\ta = mypow(a,n-1);\n\tlong long ans=0;\n\tfor(int i=0;i<26;i++)\n\t\tfor(int j=0;j<26;j++)\n\t\t\tans+=a.m[i][j];\n\tans%=mod;\n\tprintf(\"%lld\\n\",ans);\n}\n\n```\n",
        "postTime": 1557584060,
        "uid": 56614,
        "name": "ThomasX",
        "ccfLevel": 4,
        "title": "P5337 \u9898\u89e3"
    },
    {
        "content": "\u5148\u5410\u69fd\u4e00\u4e0b\u51fa\u9898\u4eba\u7684\u8bed\u6587\u6c34\u5e73~~\u771f\u7684\u662f\u6709\u6240\u6b20\u7f3a~~\uff0c\u9996\u5148\u5b57\u7b26\u662f\u6709\u987a\u5e8f\u7684\uff0c\u9898\u76ee\u4e2dab\u65e0\u6cd5\u51fa\u73b0\uff0c\u4f46ba\u53ef\u4ee5\u3002\n\n------------\n\n\u9996\u5148\u770b\u5230\u8fd9\u9053\u9898\u7684\u7b2c\u4e00\u773c\u5c31\u53ef\u4ee5\u770b\u51fa\u662f\u9053dp\u9898,\u5b9a\u4e49dp[i][j]\u8868\u793a\u957f\u5ea6\u4e3ai\u7ed3\u5c3e\u662fj\u7684\u65b9\u6848\u6570\u3002\u53e6\u5916\u5f00\u4e00\u4e2a\u6570\u7ec4\u8868\u793af,\u8868\u793a\u524d\u540e\u4e24\u4e2a\u5b57\u7b26\u80fd\u5426\u5728\u4e00\u8d77,\u7136\u540e\u6309\u7167\u8f6c\u79fb\u65b9\u7a0b\n\n\n### dp[i][j]=dp[i-1][k]\uff08f[j][k]\u4e3a\u771f\u65f6\uff09\u7136\u540e\u9012\u63a8\u7b97\u51fa\u5373\u53ef\u3002\n\n------------\n\n\u5f53\u7136\u4f60\u53ea\u80fd\u8fc730%\u7684\u70b9\uff0c\u518d\u770b\u770b\u8303\u56f4n=$10^{15}$\uff0c\u53d1\u73b0\u5176\u5b9e\u53ef\u4ee5\u76f4\u63a5\u628a\u4e24\u4e32\u5408\u6210\u4e00\u4e32\uff0c\u4f9d\u6b64\u9012\u63a8\uff0c\u590d\u6742\u5ea6\u76f4\u63a5\u5c31\u4e0b\u6765\u4e86\uff0c\u6240\u4ee5\u7528\u77e9\u9635\u5feb\u901f\u5e42~~\u778e\u641e~~\u5373\u53ef\u3002\n### dp[i][j]=a[i][k]*b[k][j]\n\n------------\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\nconst int MAXN=1e9+7;\nstruct node{\n\tlong long m[30][30];\n};\nchar s[11000];\nlong long n;\nnode mul(node a,node b){\n\tnode pre;\n\tmemset(pre.m,0,sizeof (pre.m));\n\tfor(int i=0;i<26;i++)for(int j=0;j<26;j++)for(int k=0;k<26;k++)pre.m[i][j]+=a.m[i][k]*b.m[k][j]%MAXN;\n\tfor(int i=0;i<26;i++)for(int j=0;j<26;j++)pre.m[i][j]%=MAXN;\n\treturn pre;\n}\nnode mypow(node a,long long k){\n\tnode pre;\n\tfor(int i=0;i<26;i++)for(int j=0;j<26;j++)pre.m[i][j]=(i==j);\n\twhile(k){\n\t\tif(k&1)pre=mul(pre,a);\n\t\ta=mul(a,a);\n\t\tk>>=1;\n\t}\n\treturn pre;\n}\nint main(){\n\tscanf(\"%lld%s\",&n,s);\n\tnode a;\n\tfor(int i=0;i<26;i++)for(int j=0;j<26;j++)a.m[i][j]=1;\n\tfor(int i=1;i<strlen(s);i++)a.m[s[i-1]-'a'][s[i]-'a']=0;\n\ta=mypow(a,n-1);\n\tlong long ans=0;\n\tfor(int i=0;i<26;i++)for(int j=0;j<26;j++)ans+=a.m[i][j]%MAXN;\n\tprintf(\"%lld\",ans%MAXN);\n\treturn 0;\n}\n```\n",
        "postTime": 1557031832,
        "uid": 53333,
        "name": "liuqy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5337 \u3010[TJOI2019]\u7532\u82ef\u5148\u751f\u7684\u5b57\u7b26\u4e32\u3011"
    },
    {
        "content": "~~\u5c0f\u849f\u84bb\u7ec8\u4e8e\u4f1a\u4e86\u4e00\u70b9\u77e9\u9635\u5feb\u901f\u5e42\u4e86\u3002~~\n\n## \u524d\u7f6e\u77e5\u8bc6\uff1a\u7406\u89e3\u77e9\u9635\u4e58\u6cd5\u4ee5\u53ca\u77e9\u9635\u5feb\u901f\u5e42\n\n\u5bf9\u4e8e\u957f\u5ea6\u4e3a1\u7684\u4e32\uff0c\u672b\u5c3e\u4e3aa~z\u7684\u5b57\u7b26\u4e32\u4e2a\u6570\u5168\u90e8\u4e3a1\uff0c\u6211\u4eec\u8003\u8651\u589e\u52a0\u4e00\u4e2a\u957f\u5ea6\u540e\u7684\u7b54\u6848\u3002\u5982\u679c\u6ca1\u6709\u9650\u5236\u6761\u4ef6\uff0c\u6bcf\u4e00\u4e2a\u4e32\u90fd\u80fd\u8f6c\u5316\u4e3a\u957f\u5ea6\u52a0\u4e00\u7684\u672b\u5c3e\u4e3aa~z\u7684\u4e32\uff0c\u6240\u4ee5\u77e9\u9635\u4e3a\u957f\u4e3a26\uff0c\u5bbd\u4e3a26\uff0c\u6240\u6709\u6570\u90fd\u662f1\u7684\u77e9\u9635\u3002\n\n\u4f46\u56e0\u4e3a\u5728\u7ed9\u5b9a\u4e32\u4e2d\u76f8\u90bb\u7684\u5b57\u7b26\u4e0d\u80fd\u5728\u6b64\u4e32\u4e2d\u76f8\u90bb\uff0c\u76f8\u5f53\u4e8e\u5728\u5b57\u7b26\u4e32$s$\u4e2d\uff0c\u5bf9\u4e8e\u4efb\u610f$1<i<=len_s$\uff0c\u4ee5$s_{i-1}$\u7684\u5b57\u7b26\u4e32\u65e0\u6cd5\u8f6c\u79fb\u7ed9\u4ee5$s_i$\u4e3a\u7ed3\u5c3e\u7684\u4e32\u3002\u8fd9\u7b49\u4ef7\u4e8e\u5728\u77e9\u9635\u4e2d\u5c06$(s_{i-1},s_i)$\u8d4b\u503c\u4e3a0\uff0c\u6240\u4ee5\u6211\u4eec\u628a\u8fd9\u4e9b\u70b9\u8d4b\u503c\u4e3a0\uff0c\u7136\u540e\u518d\u8dd1\u77e9\u9635\u5feb\u901f\u5e42\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u8bb0\u4f4f\u6700\u540e\u7684\u7b54\u6848\u8981\u5c06\u4ee5a~z\u7ed3\u5c3e\u7684\u6240\u6709\u4e32\u7684\u4e2a\u6570\u52a0\u8d77\u6765\u3002\n\n\n```cpp\n#include<bits/stdc++.h>\n#define res register int\nusing namespace std;\nconst int p=1e9+7,N=26;\nstruct matrix{\n   int a[N+1][N+1];\n   matrix(){\n       memset(a,0,sizeof a);\n   }\n}ma;\nmatrix operator*(const matrix&x,const matrix&y){\n    matrix c;\n    for(res i=1;i<=N;++i){\n        for(res j=1;j<=N;++j){\n            for(res k=1;k<=N;++k){\n                c.a[i][j]=(c.a[i][j]+1ll*x.a[i][k]*y.a[k][j]%p)%p;\n            }\n        }\n    }\n    return c;\n}\nmatrix mpow(matrix a,long long n){\n    matrix ret;\n    for(int i=1;i<=N;++i){\n        ret.a[i][i]=1;\n    }\n    while(n){\n        if(n&1)ret=ret*a;\n        a=a*a;\n        n/=2;\n    }\n    return ret;\n}\nlong long n;\nint a,b;\nchar s[1000010];\nint main(){\n    cin>>n;\n    cin>>s;\n    int len=strlen(s);\n    for(int i=1;i<=N;++i){\n        for(int j=1;j<=N;++j){\n            ma.a[i][j]=1;\n\t\t}\n\t}\n    for(int i=1;i<len;++i){\n        ma.a[s[i-1]-'a'+1][s[i]-'a'+1]=0;\n\t}\n    matrix ret,ot;\n    for(int i=1;i<=N;++i)ret.a[i][N]=1;\n    ot=mpow(ma,n-1)*ret;\n    int ans=0;\n    for(int i=1;i<=N;++i)ans=(ans+ot.a[i][N])%p;\n    cout<<ans<<endl;\n}\n```\n",
        "postTime": 1556973430,
        "uid": 48143,
        "name": "zhenglier",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5337 \u3010[TJOI2019]\u7532\u82ef\u5148\u751f\u7684\u5b57\u7b26\u4e32\u3011"
    },
    {
        "content": "\u8fd9\u9898\u5e94\u8be5\u662f\u9001\u5206\u9898\uff08\u7136\u800c\u6211\u5e76\u6ca1\u6709\u8003\u8fd9\u9053\u9898\uff09\n\n\u9996\u5148\uff0c\u53d1\u73b0\u5b57\u7b26\u4e32\u7684\u552f\u4e00\u7528\u5904\u662f\u786e\u5b9a\u9650\u5236\n\n\u6240\u4ee5\uff0c\u626b\u4e00\u904d\uff0c\u8bb0\u5f55\u54ea\u4e9b\u6709\u5e8f\u5b57\u6bcd\u5bf9\u4e0d\u80fd\u51fa\u73b0\uff0c\u8bb0$p[i][j]=1$\u8868\u793a$i,j$\u53ef\u4ee5\u8fde\u7eed\u51fa\u73b0\uff0c$p[i][j]=0$\u8868\u793a$i,j$\u4e0d\u80fd\u8fde\u7eed\u51fa\u73b0\n\n\u5bf9\u4e8e$n\\leq 100000$\u7684\u6570\u636e\uff1a\n\n\u8003\u8651DP\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u53ea\u9700\u8bb0\u5f55\u5df2\u9009\u90e8\u5206\u957f\u5ea6\u548c\u6700\u540e\u4e00\u4f4d\u7684\u5b57\u6bcd\u5373\u53ef\n\n\u8bbe$dp[i][c]$\u8868\u793a\u5df2\u7ecf\u786e\u5b9a\u524d$i$\u4f4d\uff0c\u4e14\u6700\u540e\u4e00\u4f4d\u662f\u5b57\u6bcd$c$\u7684\u60c5\u51b5\u6570\n\n\u5219$dp[1][c]=1$\n\n$dp[i][c]=\\sum _{c'=1}^{26} (dp[i-1][c']*p[c'][c])$\n\n30\u5206\u5230\u624b\n\n\u7ee7\u7eed\u4f18\u5316\n\n\u89c2\u5bdf\u540e\u9762\u7684\u5f0f\u5b50\uff0c\u5f88\u50cf\u77e9\u9635\u4e58\u6cd5\n\n\u5982\u679c\u628a$dp[i]$\u548c$p$\u5206\u522b\u4f5c\u4e3a\u4e00\u4e2a\u77e9\u9635\uff0c\u5c31\u4f1a\u53d1\u73b0\uff0c\u8f6c\u79fb\uff1a\n\n$dp[i]=dp[i-1]*p$\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$dp[n]=dp[1]*p^{n-1}$\n\n\u628a$n=0$\u548c$n=1$\u7279\u5224\u6389\uff0c\u5269\u4e0b\u7684\u90e8\u5206\u77e9\u9635\u5feb\u901f\u5e42\u5373\u53ef\n\n\u6700\u540e\u8ba1\u7b97\u7b54\u6848\u65f6\uff0c\u76f4\u63a5\u628a\u77e9\u9635\u91cc\u7684\u6240\u6709\u6570\u76f8\u52a0\u5373\u53ef\n\n\u8fd9\u6837\u5c31\u80fdA\u4e86\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\nusing namespace std;\nconst int C=26;\nconst long long M=1000000007;\nstruct matrix{\n\tlong long num[C][C];\n};\nmatrix operator*(matrix a,matrix b){\n\tmatrix c;\n\tfor(int i=0;i<C;i++){\n\t\tfor(int j=0;j<C;j++){\n\t\t\tc.num[i][j]=0;\n\t\t}\n\t}\n\tfor(int i=0;i<C;i++){\n\t\tfor(int j=0;j<C;j++){\n\t\t\tfor(int k=0;k<C;k++){\n\t\t\t\tc.num[i][j]+=a.num[i][k]*b.num[k][j];\n\t\t\t\tc.num[i][j]%=M;\n\t\t\t}\n\t\t}\n\t}\n\treturn c;\n}\nmatrix fpow(matrix a,long long b){\n\tmatrix ans;\n\tfor(int i=0;i<C;i++){\n\t\tfor(int j=0;j<C;j++){\n\t\t\tans.num[i][j]=(i==j);\n\t\t}\n\t}\n\twhile(b){\n\t\tif(b&1)ans=ans*a;\n\t\tb>>=1;\n\t\ta=a*a;\n\t}\n\treturn ans;\n}\nmatrix p;\nlong long n;\nchar str[100007];\nint main(){\n\tios::sync_with_stdio(false);\n\tcin>>n>>str;\n\tif(n==0){\n\t\tcout<<\"1\"<<endl;\n\t}else if(n==1){\n\t\tcout<<\"26\"<<endl;\n\t}else{\n\t\tfor(int i=0;i<C;i++){\n\t\t\tfor(int j=0;j<C;j++){\n\t\t\t\tp.num[i][j]=1;\n\t\t\t}\n\t\t}\n\t\tfor(int i=1;str[i];i++){\n\t\t\tp.num[str[i]-'a'][str[i-1]-'a']=0;\n\t\t}\n\t\tp=fpow(p,n-1);\n\t\tlong long ans=0;\n\t\tfor(int i=0;i<C;i++){\n\t\t\tfor(int j=0;j<C;j++){\n\t\t\t\tans+=p.num[i][j];\n\t\t\t\tif(ans>=M)ans-=M;\n\t\t\t}\n\t\t}\n\t\tcout<<ans;\n\t}\n}\n```",
        "postTime": 1556869803,
        "uid": 86649,
        "name": "Hope2075",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P5337 \u3010[TJOI2019]\u7532\u82ef\u5148\u751f\u7684\u5b57\u7b26\u4e32\u3011"
    },
    {
        "content": "\u77e9\u9635\u5feb\u901f\u5e42\u88f8\u9898\u3002\n\n\u4ee3\u7801:\n```cpp\n#include<cstdio>\n#include<cstdlib>\n#include<cctype>\n#include<cstring>\n#include<algorithm>\n#include<cmath>\n#include<cassert>\n#include<iostream>\n#include<climits>\n#include<vector>\n#include<bitset>\n#include<queue>\n#define Rep(i,a,b) for(register int i=(a);i<=(b);++i)\n#define Repe(i,a,b) for(register int i=(a);i>=(b);--i)\n#define rep(i,a,b) for(register int i=(a);i<(b);++i)\n#define pb push_back\n#define mp make_pair\n#define mx(a,b) (a>b?a:b)\n#define mn(a,b) (a<b?a:b)\ntypedef unsigned long long uint64;\ntypedef unsigned int uint32;\ntypedef long long ll;\nusing namespace std;\n\nnamespace IO\n{\n\tconst uint32 Buffsize=1<<15,Output=1<<24;\n\tstatic char Ch[Buffsize],*S=Ch,*T=Ch;\n\tinline char getc()\n\t{\n\t\treturn((S==T)&&(T=(S=Ch)+fread(Ch,1,Buffsize,stdin),S==T)?0:*S++);\n\t}\n\tstatic char Out[Output],*nowps=Out;\n\t\n\tinline void flush(){fwrite(Out,1,nowps-Out,stdout);nowps=Out;}\n\n\ttemplate<typename T>inline void read(T&x)\n\t{\n\t\tx=0;static char ch;T f=1;\n\t\tfor(ch=getc();!isdigit(ch);ch=getc())if(ch=='-')f=-1;\n\t\tfor(;isdigit(ch);ch=getc())x=x*10+(ch^48);\n\t\tx*=f;\n\t}\n\n\ttemplate<typename T>inline void write(T x,char ch='\\n')\n\t{\n\t\tif(!x)*nowps++='0';\n\t\tif(x<0)*nowps++='-',x=-x;\n\t\tstatic uint32 sta[111],tp;\n\t\tfor(tp=0;x;x/=10)sta[++tp]=x%10;\n\t\tfor(;tp;*nowps++=sta[tp--]^48);\n\t\t*nowps++=ch;\n\t\tif(nowps-Out>=1<<23)flush();\n\t}\n\n\tinline void getstr(char*q)\n\t{\n\t\tregister char ch;\n\t\tfor(ch=getc();!isgraph(ch);ch=getc());\n\t\tfor(;isgraph(ch);ch=getc())*q++=ch;\n\t\t*q='\\0';\n\t}\n\n\tinline void getwd(char&x){for(x=getc();!isupper(x);x=getc());}\n}\nusing namespace IO;\n\nvoid file()\n{\n#ifndef ONLINE_JUDGE\n\tFILE*DSD=freopen(\"water.in\",\"r\",stdin);\n\tFILE*CSC=freopen(\"water.out\",\"w\",stdout);\n#endif\n}\n\ninline void Chkmin(int&u,int v){u>v?u=v:0;}\n\ninline void Chkmax(int&u,int v){u<v?u=v:0;}\n\ninline void Chkmax(double&u,double v){u<v?u=v:0;}\n\ninline void Chkmax(ll&u,ll v){u<v?u=v:0;}\n\ninline void Chkmin(ll&u,ll v){u>v?u=v:0;}\n\nconst int MAXN=1e5+7;\n\nstatic ll n;\n\nstatic char s[MAXN];\n\ninline void init()\n{\n\tread(n);\n\tgetstr(s);\n}\n\nconst int mod=1e9+7;\n\nstatic ll A[26][26];\n\nstatic struct mat\n{\n\tint c[26][26];\n\n\tmat operator*(const mat&a)const\n\t{\n\t\tstatic mat X;\n\t\trep(i,0,26)rep(j,0,26)\n\t\t{\n\t\t\tA[i][j]=0ll;\n\t\t\trep(k,0,8)A[i][j]+=(ll)c[i][k]*a.c[k][j];\n\t\t\tA[i][j]%=mod;\n\t\t\trep(k,8,17)A[i][j]+=(ll)c[i][k]*a.c[k][j];\n\t\t\tA[i][j]%=mod;\n\t\t\trep(k,17,26)A[i][j]+=(ll)c[i][k]*a.c[k][j];\n\t\t\tX.c[i][j]=A[i][j]%mod;\n\t\t}\n\t\treturn X;\n\t}\n}bs,as;\n\ninline void solve()\n{\n\tint x=strlen(s)-1;\n\trep(i,0,26)rep(j,0,26)bs.c[i][j]=1;\n\trep(i,0,x)bs.c[s[i]-'a'][s[i+1]-'a']=0;\n\trep(i,0,26)as.c[i][i]=1;\n\tfor(--n;n;n>>=1,bs=bs*bs)if(n&1)\n\t\tas=as*bs;\n\tstatic ll aaa=0ll;\n\trep(i,0,26)rep(j,0,26)aaa+=as.c[i][j];\n\tcout<<aaa%mod<<endl;\n}\n\nint main()\n{\n\tfile();\n\tinit();\n\tsolve();\n\treturn 0;\n}\n```",
        "postTime": 1556803699,
        "uid": 7035,
        "name": "Great_Influence",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5337 \u3010[TJOI2019]\u7532\u82ef\u5148\u751f\u7684\u5b57\u7b26\u4e32\u3011"
    }
]
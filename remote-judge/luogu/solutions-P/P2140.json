[
    {
        "content": "\u9898\u610f\uff1a\u7eb5\u6a2a\u5212\u5206\u533a\u57df\uff0c\u4f7f\u5f97\u9664\u53bb\u67d0\u4e00\u533a\u57df\u7684\u503c\u540e\u5176\u4ed6\u533a\u57df\u7684\u548c\u4e0d\u8d85\u8fc7 $ u $ \u3002\n\n\u601d\u8def\uff1a\u7528 dfs \u5212\u5206\u533a\u57df\uff0c\u5982\u679c\u6cbf\u7740\u5f53\u524d\u8f74\u5212\u5206\u662f\u53ef\u884c\u7684\uff0c\u90a3\u4e48\u518d\u5bf9\u5212\u5206\u540e\u7684\u533a\u57df\u8fdb\u884c dfs \u3002\n\n\u4f46\u662f\u8fd9\u6837\u505a\u7684\u65f6\u95f4\u6210\u672c\u662f\u5f88\u9ad8\u7684\uff0c \u56e0\u4e3a\u8fd9\u79cd\u505a\u6cd5\u5bf9\u540c\u4e00\u533a\u95f4\u505a\u4e86\u91cd\u590d\u7684\u8ba1\u7b97\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u8003\u8651\u7528\u6570\u7ec4\u8bb0\u5f55\u67d0\u4e00\u533a\u95f4\u7684\u6700\u4f18\u503c\uff0c\u5728\u4ea7\u751f\u91cd\u590d\u8ba1\u7b97\u65f6\u76f4\u63a5\u8c03\u7528\u5373\u53ef\u3002 \u8bbe $ f[x1][y1][x2][y2] $ \u8868\u793a $(x1,y1) $ \u5230 $(x2,y2) $ \u7684\u6700\u4f18\u5212\u5206\uff0c\u5219\u7b54\u6848\u662f $f[1][1][n][m]$ \u3002\n\n\u4ee3\u7801\u5982\u4e0b\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define min(a,b) (a<b?a:b)\n#define max(a,b) (a>b?a:b)\nusing namespace std;\ntypedef pair<int,int> pii;\ninline int read(){\n    int x = 0;char ch = getchar();\n    while(ch < '0' || ch > '9'){ch = getchar();}\n    while(ch >= '0' && ch <= '9'){x = (x<<1)+(x<<3)+(ch^48);ch = getchar();}\n    return x;\n}\nint n,m,u,a[35][35],sum = 0,s[35][35];\npii f[35][35][35][35];\n#define calc(x1,y1,x2,y2) (s[x2][y2]+s[x1-1][y1-1]-s[x1-1][y2]-s[x2][y1-1])\ninline pii dfs(int x1,int y1,int x2,int y2,int all){\n    if(f[x1][y1][x2][y2].first) return f[x1][y1][x2][y2];\n    if(x1 == x2 && y1 == y2) return pii{1,u-(sum-all)};\n    pii t;t.first = 1,t.second = u-(sum-all);\n    for(register int i = y1;i < y2;++i){\n        int s1 = calc(x1,y1,x2,i),s2 = calc(x1,i+1,x2,y2);\n        if(sum-s1 <= u && sum-s2 <= u){\n            pii p1 = dfs(x1,y1,x2,i,s1),p2 = dfs(x1,i+1,x2,y2,s2);\n            if(p1.first+p2.first > t.first)t.first = p1.first+p2.first,t.second = min(p1.second,p2.second);\n            else if(p1.first+p2.first == t.first) t.second = max(t.second,min(p1.second,p2.second));\n        }\n    }\n    for(register int i = x1;i < x2;++i){\n        int s1 = calc(x1,y1,i,y2),s2 = calc(i+1,y1,x2,y2);\n        if(sum-s1 <= u && sum-s2 <= u){\n            pii p1 = dfs(x1,y1,i,y2,s1),p2 = dfs(i+1,y1,x2,y2,s2);\n            if(p1.first+p2.first > t.first)t.first = p1.first+p2.first,t.second = min(p1.second,p2.second);\n            else if(p1.first+p2.first == t.first) t.second = max(t.second,min(p1.second,p2.second));\n        }\n    }\n    return f[x1][y1][x2][y2] = t;\n}\nint main(){\n    n = read(),m = read(),u = read();\n    for(register int i = 1;i <= n;++i)\n        for(register int j = 1;j <= m;++j) a[i][j] = read(),sum += a[i][j];\n    for(register int i = 1;i <= n;++i)\n        for(register int j = 1;j <= m;++j) s[i][j] = s[i][j-1]+s[i-1][j]-s[i-1][j-1]+a[i][j];\n    pii ans = dfs(1,1,n,m,sum);\n    printf(\"%d %d\",ans.first,ans.second);\n    return 0;\n}\n```\n",
        "postTime": 1637728784,
        "uid": 434929,
        "name": "Usada_Pekora",
        "ccfLevel": 7,
        "title": "P2140 \u8bb0\u5fc6\u5316\u641c\u7d22"
    },
    {
        "content": "\u672c\u9898\u7684\u6b63\u89e3\u4e3a\u52a8\u6001\u89c4\u5212\u3002\n\n\u9898\u610f\uff1a\u9898\u9762\u8bb2\u7684\u5df2\u7ecf\u5f88\u6e05\u695a\u4e86\uff0c\u8fd9\u91cc\u4e0d\u505a\u591a\u89e3\u91ca\u3002\n\n\u601d\u8def\uff1a\u5b9a\u4e49\u4e24\u4e2a\u56db\u7ef4\u6570\u7ec4 $f1$ \u548c $f2$\uff0c$f1_{x1,y1,x2,y2}$ \u8868\u793a\u5de6\u4e0a\u89d2\u5750\u6807\u4e3a $(x1,y1)$\uff0c\u53f3\u4e0b\u89d2\u5750\u6807\u4e3a $(x2,y2)$ \u7684\u77e9\u9635\u5212\u5206\u533a\u57df\u6570\u7684\u6700\u5927\u503c\uff0c$f2$ \u8bb0\u5f55\u5728\u4fdd\u8bc1\u5212\u5206\u533a\u57df\u6570\u6700\u5927\u7684\u60c5\u51b5\u4e0b\u80fd\u591f\u5269\u4f59\u7535\u529b\u7684\u6700\u5927\u503c\u3002\u5b9a\u4e49\u53d8\u91cf $sum$ \u8868\u793a\u7535\u529b\u9700\u6c42\u603b\u548c $-$ $u$\uff0c\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u5212\u5206\u540e\u7684\u4efb\u610f\u4e00\u4e2a\u533a\u57df\u7684\u7535\u529b\u9700\u6c42 $\\ge sum$\u3002\n\n\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u77e9\u9635\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651\u5b83\u7531\u54ea\u4e24\u4e2a\u77e9\u9635\u8f6c\u79fb\u8fc7\u6765\uff08\u5373\u6a2a\u5207\u548c\u7ad6\u5207\uff09\uff0c\u5728\u8f6c\u79fb\u7684\u8fc7\u7a0b\u4e2d\uff0c\u66f4\u65b0 $f2$ \u6570\u7ec4\u7684\u503c\u3002\n\n\u521d\u59cb\u5316\uff1a\u6bcf\u679a\u4e3e\u5230\u4e00\u4e2a\u77e9\u9635\uff0c\u5982\u679c\u8fd9\u4e2a\u77e9\u9635\u7684\u6743\u503c $\\ge sum$\uff08\u77e9\u9635\u7684\u6743\u503c\u5373\u4e3a\u77e9\u9635\u4e2d\u7684\u6240\u6709\u6570\u76f8\u52a0\uff09\uff0c\u5c31\u5c06 $f1$ \u521d\u59cb\u5316\u4e3a $1$\uff0c$f2$ \u8d4b\u503c\u4e3a\u8fd9\u4e2a\u77e9\u9635\u7684\u6743\u503c\uff0c\u8fd9\u91cc\u7684\u77e9\u9635\u6743\u503c\u53ef\u4ee5\u7528\u524d\u7f00\u548c\u5b9e\u73b0\u3002\n\n\u5b9e\u73b0\u6b65\u9aa4\uff1a\n1. \u679a\u4e3e\u77e9\u9635 $(x1,y1,x2,y2)$\uff0c\u5982\u679c\u8fd9\u4e2a\u77e9\u9635\u6ee1\u8db3\u6743\u503c\u548c $\\ge sum$\uff0c\u521d\u59cb\u5316\uff0c\u5426\u5219\u8df3\u51fa\u679a\u4e3e\u4e0b\u4e00\u4e2a\u77e9\u9635\u3002\n1. \u6a2a\u5207\uff1a$k$ \u679a\u4e3e\u77e9\u9635\u7684\u6bcf\u4e00\u884c\uff0c\u5206\u5272\u7ebf\u5728\u7b2c $k$ \u884c\u548c\u7b2c $k+1$ \u884c\u4e4b\u95f4\uff0c\u5206\u5272\u540e\u7684\u4e24\u4e2a\u77e9\u9635\u4e3a $(x1,y1,k,y2)$ \u548c $(k+1,y1,x2,y2)$\uff0c\u5982\u679c\u8fd9\u4e24\u4e2a\u77e9\u9635\u7684 $f1$ \u503c\u90fd $\\ge 1$\uff0c\u8868\u793a\u53ef\u4ee5\u5206\u5272\uff0c\u66f4\u65b0 $f1_{x1,y1,x2,y2}$ \u548c $f2_{x1,y1,x2,y2}$ \u7684\u503c\u3002\u4ee3\u7801\u5982\u4e0b\uff1a\n```c\nif(f1[x1][y1][x2][y2]<f1[x1][y1][k][y2]+f1[k+1][y1][x2][y2]){\n      \tf1[x1][y1][x2][y2]=f1[x1][y1][k][y2]+f1[k+1][y1][x2][y2];\n      \tf2[x1][y1][x2][y2]=min(f2[x1][y1][k][y2],f2[k+1][y1][x2][y2]);\n}\nelse if(f1[x1][y1][x2][y2]==f1[x1][y1][k][y2]+f1[k+1][y1][x2][y2])\n      \tf2[x1][y1][x2][y2]=max(f2[x1][y1][x2][y2],min(f2[x1][y1][k][y2],f2[k+1][y1][x2][y2]));\n```\n3. \u7ad6\u5207\uff1a\u601d\u8def\u548c\u6a2a\u5207\u4e00\u6837\uff0c\u628a $k$ \u679a\u4e3e\u884c\u53d8\u4e3a\u679a\u4e3e\u5217\uff0c\u5206\u5272\u540e\u7684\u4e24\u4e2a\u77e9\u9635\u53d8\u4e3a $(x1,y1,x2,k)$ \u548c $(x1,k+1,x2,y2)$ \u5c31\u597d\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a\u4e00\u5171 $5$ \u5c42\u5faa\u73af\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^5)$\uff0c\u5bf9\u4e8e $n \\le 32$ \u7684\u6570\u636e\u662f\u5b8c\u5168\u53ef\u4ee5\u901a\u8fc7\u7684\u3002\n\n## code\n```c\n#include <bits/stdc++.h>\nusing namespace std;\nint n, m, u, sum = 0;\nint a[33][33];\nint dp1[33][33][33][33], dp2[33][33][33][33], s[33][33];\nint main() {\n\tscanf(\"%d%d%d\", &n, &m, &u);\n\tfor (int i = 1; i <= n; i++) {\n\t\tfor (int j = 1; j <= m; j++) {\n\t\t\tscanf(\"%d\", &a[i][j]);\n\t\t\tsum += a[i][j];\n\t\t\ts[i][j] = s[i - 1][j] + s[i][j - 1] - s[i - 1][j - 1] + a[i][j];\n\t\t}\n\t}\n\tsum -= u;\n\tfor (int len1 = 1; len1 <= n; len1++) {\n\t\tfor (int len2 = 1; len2 <= m; len2++) {\n\t\t\tfor (int x1 = 1, x2 = x1 + len1 - 1; x2 <= n; x1++, x2++) {\n\t\t\t\tfor (int y1 = 1, y2 = y1 + len2 - 1; y2 <= m; y1++, y2++) {\n\t\t\t\t\tif (s[x2][y2] - s[x1 - 1][y2] - s[x2][y1 - 1] + s[x1 - 1][y1 - 1] >= sum) {\n\t\t\t\t\t\tdp1[x1][y1][x2][y2] = 1;\n\t\t\t\t\t\tdp2[x1][y1][x2][y2] = s[x2][y2] - s[x1 - 1][y2] - s[x2][y1 - 1] + s[x1 - 1][y1 - 1] - sum;\n\t\t\t\t\t} else continue;\n\t\t\t\t\tfor (int k = x1; k < x2; k++) {\n\t\t\t\t\t\tif (!(dp1[x1][y1][k][y2] && dp1[k + 1][y1][x2][y2])) continue;\n\t\t\t\t\t\tif (dp1[x1][y1][x2][y2] < dp1[x1][y1][k][y2] + dp1[k + 1][y1][x2][y2]) {\n\t\t\t\t\t\t\tdp1[x1][y1][x2][y2] = dp1[x1][y1][k][y2] + dp1[k + 1][y1][x2][y2];\n\t\t\t\t\t\t\tdp2[x1][y1][x2][y2] = min(dp2[x1][y1][k][y2], dp2[k + 1][y1][x2][y2]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (dp1[x1][y1][x2][y2] == dp1[x1][y1][k][y2] + dp1[k + 1][y1][x2][y2]) \n\t\t\t\t\t\t\tdp2[x1][y1][x2][y2] = max(dp2[x1][y1][x2][y2], min(dp2[x1][y1][k][y2], dp2[k + 1][y1][x2][y2]));\n\t\t\t\t\t}\n\t\t\t\t\tfor (int k = y1; k < y2; k++) {\n\t\t\t\t\t\tif (!(dp1[x1][y1][x2][k] && dp1[x1][k + 1][x2][y2])) continue;\n\t\t\t\t\t\tif (dp1[x1][y1][x2][y2] < dp1[x1][y1][x2][k] + dp1[x1][k + 1][x2][y2]) {\n\t\t\t\t\t\t\tdp1[x1][y1][x2][y2] = dp1[x1][y1][x2][k] + dp1[x1][k + 1][x2][y2];\n\t\t\t\t\t\t\tdp2[x1][y1][x2][y2] = min(dp2[x1][y1][x2][k], dp2[x1][k + 1][x2][y2]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (dp1[x1][y1][x2][y2] == dp1[x1][y1][x2][k] + dp1[x1][k + 1][x2][y2]) \n\t\t\t\t\t\t\tdp2[x1][y1][x2][y2] = max(dp2[x1][y1][x2][y2], min(dp2[x1][y1][x2][k], dp2[x1][k + 1][x2][y2]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d %d\\n\", dp1[1][1][n][m], dp2[1][1][n][m]);\n\treturn 0;\n}\n```",
        "postTime": 1666261620,
        "uid": 526713,
        "name": "_111_",
        "ccfLevel": 0,
        "title": "P2140 \u5c0fZ\u7684\u7535\u529b\u7ba1\u5236"
    },
    {
        "content": "\u4f3c\u4e4e\u8fd9\u9053\u9898\u548c [P1436](https://www.luogu.com.cn/problem/P1436) \u4ee5\u53ca [P5752](https://www.luogu.com.cn/problem/P5752) \u7684\u68cb\u76d8\u5206\u5272\u6709\u5f88\u591a\u76f8\u4f3c\u4e4b\u5904 \u3002  ~~\uff08\u4e09\u500d\u7ecf\u9a8c\uff09~~  \n\u9898\u76ee\u5bf9\u4e8e\u7535\u529b\u7684\u8981\u6c42\u4f3c\u4e4e\u6709\u4e9b\u590d\u6742 \u3002  \n\u7b80\u5316\u6765\u8bf4\u5c31\u662f **\u53d6\u5404\u65b9\u6848\u5404\u4e2a\u533a\u57df\u5206\u503c\u4e4b\u548c\u6700\u5c0f\u503c\u6700\u5927** \u3002  \n\u7279\u6765\u6b64\u5199\u4e00\u7bc7\u8f83\u4e3a\u8be6\u7ec6\u7684\u9898\u89e3 \u3002  \n## 1.\u601d\u8def\n\u7c7b\u4f3c\u4e8e\u5206\u5272\u68cb\u76d8\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8fdb\u884c **\u9012\u5f52** \u5206\u5272 \u3002   \n\u4e8c\u7ef4\u53d6\u533a\u5757\u548c\u53ef\u4ee5\u4f7f\u7528 **\u4e8c\u7ef4\u524d\u7f00\u548c**  \n\u4f46\u662f\u7b54\u6848\u6709\u4e24\u4e2a\uff0c\u53ef\u4ee5\u4f7f\u7528\u7ed3\u6784\u4f53\u5b58\u50a8\u5e76\u7ef4\u62a4 \u3002  \n\u7528 $f$ \u6570\u7ec4\u8fdb\u884c **\u8bb0\u5fc6\u5316\u5904\u7406** \u4f18\u5316\u65f6\u95f4\u590d\u6742\u5ea6 \u3002\n## 2.\u89e3\u6cd5\n\u6613\u77e5\u9012\u5f52\u8fb9\u754c\u662f\u4e0d\u53ef\u518d\u5206\uff0c\u5373\u5df2\u7ecf\u7f29\u5c0f\u5230\u4e00\u4e2a\u70b9 \u3002  \n\u7535\u529b\u6d88\u8017\u503c\u4e3a\u6240\u6709\u9700\u8981\u7684\u7535 $tot$ \u51cf\u53bb\u5f53\u524d\u65ad\u7535\u533a\u57df\u65ad\u6389\u7684\u7535 $broke$ \u3002  \n\u6240\u6709\u7535\u529b\u5269\u4f59\u503c\u4e3a **\u4f9b\u7535\u603b\u503c - \u7535\u529b\u6d88\u8017\u503c** \u3002  \n\u5b9a\u4e49\uff1a\n- $ans$ \u4e3a\u65b9\u6848\u603b\u6570 \u3002\n- $least$ \u4e3a\u7535\u529b\u5269\u4f59\u503c \u3002  \n\n\u5982\u679c\u5f53\u524d\u65b9\u6848\u8f83\u591a\uff0c\u5219\u66ff\u6362\u5df2\u6709\u65b9\u6848\uff0c\u66f4\u65b0\u7535\u529b\u5269\u4f59\u503c \u3002   \n\u5982\u679c\u65b9\u6848\u6570\u76f8\u540c\uff0c\u5219\u6bd4\u8f83\u7535\u529b\u5269\u4f59\u503c\uff0c\u9009\u51fa\u8f83\u5927\u7684 \u3002\n## 3.Code\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=35;\nstruct Node{\n\tint ans;\n\tint least;\n}f[maxn][maxn][maxn][maxn];\nint a[maxn][maxn];\nint sum[maxn][maxn];\nint tot=0;\nint n,m,u;\nint get_sum(int x1,int y1,int x2,int y2){\n\tint k=sum[x2][y2]+sum[x1-1][y1-1]-sum[x1-1][y2]-sum[x2][y1-1];//\u6c42\u533a\u5757\u5206\u503c\u548c \n\treturn k;\n}\nNode dfs(int x1,int y1,int x2,int y2,int broke){\n\tif(f[x1][y1][x2][y2].ans) return f[x1][y1][x2][y2];\n\tNode tmp;tmp.ans=1;tmp.least=u-tot+broke;\n\tif(x1==x2&&y1==y2) return tmp;//\u9012\u5f52\u8fb9\u754c \n\tfor(int i=x1;i<x2;i++){//\u7eb5\u5411\u5206\u5272 \n\t\tint area1=get_sum(x1,y1,i,y2),area2=get_sum(i+1,y1,x2,y2);\n\t\tif(area1<=u&&tot-area1<=u&&area2<=u&&tot-area2<=u){\n\t\t\tNode ans1=dfs(x1,y1,i,y2,area1),ans2=dfs(i+1,y1,x2,y2,area2);\n\t\t\tif(ans1.ans+ans2.ans>tmp.ans){//\u66ff\u6362\u5df2\u6709\u65b9\u6848\uff0c\u66f4\u65b0\u7535\u529b\u5269\u4f59\u503c \n\t\t\t\ttmp.ans=ans1.ans+ans2.ans;\n\t\t\t\ttmp.least=min(ans1.least,ans2.least);\n\t\t\t}\n\t\t\t//\u6bd4\u8f83\u7535\u529b\u5269\u4f59\u503c\uff0c\u9009\u51fa\u8f83\u5927\u7684\n\t\t\telse if(ans1.ans+ans2.ans==tmp.ans) tmp.least=max(tmp.least,min(ans1.least,ans2.least));\n\t\t}\n\t}\n\tfor(int i=y1;i<y2;i++){//\u6a2a\u5411\u5206\u5272 \n\t\tint area1=get_sum(x1,y1,x2,i),area2=get_sum(x1,i+1,x2,y2);\n\t\tif(area1<=u&&tot-area1<=u&&area2<=u&&tot-area2<=u){\n\t\t\tNode ans1=dfs(x1,y1,x2,i,area1),ans2=dfs(x1,i+1,x2,y2,area2);\n\t\t\tif(ans1.ans+ans2.ans>tmp.ans){\n\t\t\t\ttmp.ans=ans1.ans+ans2.ans;\n\t\t\t\ttmp.least=min(ans1.least,ans2.least);\n\t\t\t}\n\t\t\telse if(ans1.ans+ans2.ans==tmp.ans) tmp.least=max(tmp.least,min(ans1.least,ans2.least));\n\t\t}\n\t}\n\treturn f[x1][y1][x2][y2]=tmp;\n}\nint main(){\n\tscanf(\"%d%d%d\",&n,&m,&u);\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++) scanf(\"%d\",&a[i][j]),tot+=a[i][j];\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++) sum[i][j]=a[i][j]+sum[i-1][j]+sum[i][j-1]-sum[i-1][j-1];//\u4e8c\u7ef4\u524d\u7f00\u548c \n\tNode res=dfs(1,1,n,m,tot);\n\tprintf(\"%d %d\",res.ans,res.least);\n\treturn 0;\n}\n```",
        "postTime": 1650465287,
        "uid": 392796,
        "name": "Think",
        "ccfLevel": 4,
        "title": "P2140 \u5c0fZ\u7684\u7535\u529b\u7ba1\u5236 \u9898\u89e3"
    }
]
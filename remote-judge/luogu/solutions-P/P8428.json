[
    {
        "content": "\u6811\u4e0a\u8d2a\u5fc3\u795e\u9898\n\n\u9996\u5148\u662f\u548c [\u8fd9\u9898](https://www.luogu.com.cn/problem/P3523) \u6709\u4e00\u4e2a\u76f8\u540c\u7684\u8d2a\u5fc3\u7b56\u7565\uff0c\u5c31\u662f\u5bf9\u4e8e\u4e00\u4e2a\u6df1\u5ea6\u6700\u6df1\u7684\u70b9\uff0c\u9009\u62e9\u4ed6\u7684\u6700\u9ad8\u7956\u5b97\u4e00\u5b9a\u6bd4\u9009\u62e9\u4ed6\u7684\u67d0\u4e2a\u5144\u5f1f\u5b50\u6811\u4f18\u3002\uff08\u56e0\u4e3a\u5b83\u662f\u6df1\u5ea6\u6700\u6df1\u7684\u70b9\uff0c\u90a3\u4e48\u6ca1\u6709\u6bd4\u5b83\u6df1\u7684\u70b9\uff0c\u6240\u4ee5\u5728\u5176\u5b83\u5b50\u6811\u4e00\u5b9a\u4e0d\u4f18\uff0c\u6700\u9ad8\u7684\u7956\u5b97\u662f\u56e0\u4e3a\u80fd\u770b\u5b88\u5230\u66f4\u591a\u7684\u7f8a\uff09\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u9884\u5904\u7406\u6bcf\u4e00\u4e2a\u70b9\u5230\u6700\u8fd1\u7684\u7f8a\u7684\u8ddd\u79bb\uff0c\u7136\u540e\u5bf9\u7f8a\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u5bf9\u6bcf\u53ea\u7f8a\u66b4\u529b\u8df3\u5230\u6700\u6d45\u7684\u7956\u5b97\uff0c\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u7956\u5b97\u80fd\u8986\u76d6\u5230\u7684\u7f8a\u6807\u8bb0\u4e00\u4e0b\u3002\n\n\u8fd9\u6837\u505a\u590d\u6742\u5ea6\u662f\u5bf9\u7684\u662f\u56e0\u4e3a\u5728\u6807\u8bb0\u65f6\u53ef\u4ee5\u7528 dis \u5224\u65ad\u5b50\u6811\u5185\u6709\u6ca1\u6709\u80fd\u770b\u7ba1\u5230\u7684\u7f8a\uff0c\u5728\u6b64\u4e4b\u540e\u8d70\u8fc7\u7684\u70b9\u5c31\u4e0d\u4f1a\u91cd\u590d\u8d70\u4e86\u3002\u8fd9\u6837\u5747\u644a\u590d\u6742\u5ea6\u662f $O(n)$\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int maxn=500020;\nconst int maxm=1200000;\nint to[maxm],nxt[maxm],head[maxn],num;\nvoid add(int x,int y){num++;to[num]=y;nxt[num]=head[x];head[x]=num;}\nint n,K;\nint dep[maxn],fa[maxn];\nvoid dfs_pre(int p,int F)\n{\n\tdep[p]=dep[F]+1;fa[p]=F;\n\tfor(int i=head[p];i;i=nxt[i])\n\t{\n\t\tif(to[i]==fa[p]) continue;\n\t\tdfs_pre(to[i],p);\n\t}\n}\nint dis[maxn],vis[maxn];\nqueue<int> Q;\nint O[maxn];\nvoid spfa()\n{\n\twhile(!Q.empty())\n\t{\n\t\tint p=Q.front();Q.pop();\n\t\tfor(int i=head[p];i;i=nxt[i])\n\t\t{\n\t\t\tif(dis[to[i]]>dis[p]+1) \n\t\t\t{\n\t\t\t\tdis[to[i]]=dis[p]+1;\n\t\t\t\tif(!vis[to[i]]) vis[to[i]]=1,Q.push(to[i]);\n\t\t\t}\n\t\t}\n\t}\n}\nint d[maxn];\nvoid dfs(int p,int s)\n{\n\td[p]=1;\n\tfor(int i=head[p];i;i=nxt[i])\n\t{\n\t\tint v=to[i];\n\t\tif(dis[v]!=s-1||d[v]) continue;\n\t\tdfs(v,s-1);\n\t}\n}\nbool cmp(int x,int y){return dep[x]>dep[y];}\nint ans;\nvector<int> Ans;\nint main()\n{\n//\tfreopen(\"p.in\",\"r\",stdin);\n//\tfreopen(\"p.out\",\"w\",stdout);\n\tscanf(\"%d%d\",&n,&K);\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tint x,y;scanf(\"%d%d\",&x,&y);\n\t\tadd(x,y);add(y,x);\n\t}\n\tdfs_pre(1,0);\n\tmemset(dis,0x7f,sizeof(dis));\n\tfor(int i=1;i<=K;i++)\n\t{\n\t\tscanf(\"%d\",&O[i]);\n\t\tdis[O[i]]=0; vis[O[i]]=1;\n\t\tQ.push(O[i]);\n\t}\n\tspfa();\n\tsort(O+1,O+1+K,cmp);\n\tfor(int i=1;i<=K;i++)\n\t{\n\t\tif(d[O[i]]) continue;\n\t\tint f=O[i],v=0;\n\t\twhile(fa[f]&&dis[fa[f]]==dis[f]+1) f=fa[f];\n\t\tdfs(f,dep[O[i]]-dep[f]);\n\t\tans++;\n\t\tAns.push_back(f);\n\t}\n\tprintf(\"%d\\n\",ans);\n\tfor(auto x:Ans)\n\t{\n\t\tprintf(\"%d \",x);\n\t}\n    return (0-0);\n}\n```",
        "postTime": 1662905689,
        "uid": 236523,
        "name": "cc0000",
        "ccfLevel": 7,
        "title": "\u3010\u9898\u89e3\u3011[COCI2020] Pastiri"
    }
]